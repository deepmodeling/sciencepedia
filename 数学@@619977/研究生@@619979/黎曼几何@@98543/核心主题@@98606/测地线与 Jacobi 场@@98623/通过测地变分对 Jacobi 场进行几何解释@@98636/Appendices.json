{"hands_on_practices": [{"introduction": "这个首个练习是理解雅可比场的一个基本基准。我们的探索始于最熟悉的环境：欧几里得空间 $\\mathbb{R}^n$。通过在一个曲率为零的空间中求解雅可比方程，你将直接验证相邻测地线（即直线）之间的分离向量随时间线性演化。这个结果提供了一个重要的基线，展示了在没有引力聚焦或散焦效应（我们将在后续练习中引入）的情况下雅可比场的行为 [@problem_id:2981933]。", "problem": "设 $(\\mathbb{R}^{n}, g)$ 是具有标准黎曼度量 $g$ 的 $n$ 维欧几里得空间，并设 $\\gamma : I \\to \\mathbb{R}^{n}$ 是一条由 $\\gamma(t) = x_{0} + t v$ 给出的测地线，其中 $x_{0} \\in \\mathbb{R}^{n}$ 且 $v \\in \\mathbb{R}^{n}$ 是一个非零常向量。一个沿 $\\gamma$ 的向量场 $J$ 若产生于一个通过测地线的光滑单参数变分，则称之为雅可比场。仅使用 Levi-Civita 联络、黎曼曲率张量和雅可比方程的基本定义和性质，确定沿 $\\gamma$ 的 $J(t)$ 的、用 $\\mathbb{R}^{n}$ 中的常向量表示的通用闭式表达式。你的最终答案必须是 $J(t)$ 的单个解析表达式。", "solution": "用户提供的问题经评估有效。这是一个适定、有科学依据的微分几何问题。\n\n该问题要求解出 $n$ 维欧几里得空间 $(\\mathbb{R}^{n}, g)$ 中沿测地线 $\\gamma(t)$ 的雅可比场 $J(t)$ 的一般表达式。控制雅可比场的基本方程是雅可比方程：\n$$D_t D_t J + R(J, \\dot{\\gamma})\\dot{\\gamma} = 0$$\n其中 $D_t$ 是沿测地线 $\\gamma$ 的协变导数，$\\dot{\\gamma}$ 是测地线的切向量，$R$ 是黎曼曲率张量。为了在给定背景下求解此方程，我们必须首先描述欧几里得空间中这些分量的特征。\n\n1.  **流形及其联络：**\n    流形是配备了标准度量 $g$ 的欧几里得空间 $\\mathbb{R}^{n}$。在标准笛卡尔坐标系 $(x^1, x^2, \\ldots, x^n)$ 中，度量张量的分量由克罗内克 δ 给出，$g_{ij} = \\delta_{ij}$。Levi-Civita 联络由克里斯托费尔符号定义，该符号由度量张量的导数计算得出：\n    $$\\Gamma^k_{ij} = \\frac{1}{2} g^{kl} \\left( \\frac{\\partial g_{jl}}{\\partial x^i} + \\frac{\\partial g_{il}}{\\partial x^j} - \\frac{\\partial g_{ij}}{\\partial x^l} \\right)$$\n    由于分量 $g_{ij} = \\delta_{ij}$ 在整个 $\\mathbb{R}^n$ 中是常数，它们的所有偏导数均为零。因此，所有克里斯托费尔符号均为零：$\\Gamma^k_{ij} = 0$。\n\n2.  **协变导数：**\n    沿曲线 $\\gamma(t)$ 的向量场 $J(t)$（其分量为 $J^k(t)$）的协变导数由下式给出：\n    $$(D_t J)^k = \\frac{dJ^k}{dt} + \\sum_{i,j=1}^{n} \\Gamma^k_{ij}(\\gamma(t)) \\frac{d\\gamma^i}{dt} J^j(t)$$\n    由于在欧几里得空间中所有 $\\Gamma^k_{ij}$ 均为零，协变导数简化为向量分量的普通时间导数。用向量表示法，即为：\n    $$D_t J = \\frac{dJ}{dt}$$\n    将该算子作用两次，得到二阶协变导数：\n    $$D_t D_t J = D_t \\left(\\frac{dJ}{dt}\\right) = \\frac{d^2J}{dt^2}$$\n\n3.  **黎曼曲率张量：**\n    黎曼曲率张量衡量二阶协变导数的非对易性，并用克里斯托费尔符号及其导数来定义。黎曼曲率张量恒为零的空间称为平坦空间。由于 $\\mathbb{R}^n$ 上标准度量的所有克里斯托费尔符号均为零，它们的导数也为零，这意味着黎曼曲率张量恒为零：$R=0$。\n    因此，雅可比方程中的曲率项为零：\n    $$R(J, \\dot{\\gamma})\\dot{\\gamma} = 0$$\n\n4.  **求解雅可比方程：**\n    将二阶协变导数和曲率项的简化表达式代入雅可比方程，我们得到关于向量场 $J(t)$ 的一个简单的二阶常微分方程：\n    $$\\frac{d^2J}{dt^2} + 0 = 0$$\n    $$\\frac{d^2J}{dt^2} = 0$$\n    这是关于向量 $J(t)$ 每个分量的方程。我们可以通过对参数 $t$ 积分两次来求解。\n    积分一次得到：\n    $$\\frac{dJ}{dt} = A$$\n    其中 $A$ 是 $\\mathbb{R}^n$ 中的一个积分常向量。\n    再次积分得到 $J(t)$ 的通解：\n    $$J(t) = At + B$$\n    其中 $B$ 是 $\\mathbb{R}^n$ 中的第二个积分常向量。\n\n    这个结果与雅可比场的几何解释是一致的。雅可比场衡量了邻近测地线之间的无穷小偏离。在欧几里得空间中，测地线是直线。一个单参数测地线族可以由 $\\gamma_s(t) = \\gamma(t) + s(At+B)$ 来描述。那么，沿 $\\gamma_0(t) = \\gamma(t)$ 的雅可比场就是 $J(t) = \\frac{\\partial \\gamma_s(t)}{\\partial s}|_{s=0} = At+B$。\n    表达式 $J(t) = At+B$ 是沿 $\\mathbb{R}^n$ 中一条测地线的雅可比场的通用闭式解，用常向量 $A, B \\in \\mathbb{R}^n$ 表示。", "answer": "$$\n\\boxed{At + B}\n$$", "id": "2981933"}, {"introduction": "在平坦空间中建立了基准之后，我们现在引入非零曲率这一关键要素。本练习将探讨常截面曲率为 $K$ 的流形上的雅可比场，这些流形可以模拟球面 ($K>0$) 和双曲平面 ($K<0$) 等空间。通过分析径向测地线的特定变分，你将推导出一个著名的函数，它明确地将曲率 $K$ 与测地线汇聚或发散的速率联系起来。这个练习提供了深刻的几何洞察：正曲率导致测地线重新聚焦，而负曲率则导致它们发散 [@problem_id:2977508]。", "problem": "设 $(M,g)$ 是一个完备的 $n$ 维常截面曲率 $K \\in \\mathbb{R}$ 的黎曼流形。固定一点 $p \\in M$ 和一个单位向量 $v \\in T_{p}M$。对于一个固定的半径 $r>0$，考虑定义在 $t \\in [0,1]$ 上的基测地线 $\\gamma(t)=\\exp_{p}(t\\,r\\,v)$，使得 $\\gamma(1)=\\exp_{p}(r v)$ 位于以 $p$ 为中心、半径为 $r$ 的测地球面上。\n\n设 $Z \\in v^{\\perp} \\subset T_{p}M$ 是一个与 $v$ 正交的非零向量。考虑 $T_{p}M$ 单位球面中的一条光滑曲线 $v(s)$，满足 $v(0)=v$ 和 $v'(0)=\\frac{1}{r}Z$，并构造测地变分 $F(s,t)=\\exp_{p}(t\\,r\\,v(s))$。此变分由径向测地线构成，其端点 $F(s,1)$ 保持在测地球面 $S_{r}(p)$ 上。\n\n令 $J(t)=\\left.\\frac{\\partial}{\\partial s}\\right|_{s=0}F(s,t)$ 表示沿 $\\gamma$ 的相应变分场。仅使用测地变分和雅可比场的定义、雅可比方程以及常截面曲率下黎曼曲率张量的形式，推导唯一的标量函数 $f(K,r)$，使得\n$$\nJ(1)=f(K,r)\\,P_{1}(Z),\n$$\n其中 $P_{1}:T_{p}M \\to T_{\\gamma(1)}M$ 表示沿 $\\gamma$ 从 $t=0$ 到 $t=1$ 的平行移动。\n\n你的最终答案必须是 $f(K,r)$ 的闭式解析表达式，且仅用 $K$ 和 $r$ 表示。无需提供中间步骤。不需要数值近似。", "solution": "该问题要求一个标量函数 $f(K,r)$，它将 $t=1$ 处的特定雅可比场 $J(t)$ 与一个初始向量 $Z$ 的平行移动联系起来。我们必须从第一性原理出发推导这个函数。\n\n设 $(M,g)$ 是一个完备的 $n$ 维常截面曲率 $K \\in \\mathbb{R}$ 的黎曼流形。基测地线为 $\\gamma(t) = \\exp_{p}(t\\,r\\,v)$，$t \\in [0,1]$，其中 $p \\in M$ 且 $v \\in T_{p}M$ 是一个单位向量。该测地线的切向量为 $\\dot{\\gamma}(t)$，其速率是常数：$\\|\\dot{\\gamma}(t)\\| = \\|d(\\exp_p)_{trv}(rv)\\| = \\|rv\\| = r\\|v\\| = r$。令 $T(t) = \\dot{\\gamma}(t)$。\n\n雅可比场 $J(t)$ 是测地变分 $F(s,t)=\\exp_{p}(t\\,r\\,v(s))$ 的变分场，其中 $v(s)$ 是 $T_p M$ 单位球面中的一条曲线，满足 $v(0)=v$ 和 $v'(0)=\\frac{1}{r}Z$（对于非零向量 $Z \\in v^\\perp$）。\n雅可比场定义为 $J(t) = \\left.\\frac{\\partial}{\\partial s}\\right|_{s=0}F(s,t)$。\n\n首先，我们建立 $J(t)$ 在 $t=0$ 处的初始条件。\n在 $t=0$ 时，对所有 $s$ 都有 $F(s,0) = \\exp_p(0) = p$。因此，$t=0$ 处的雅可比场为\n$$J(0) = \\left.\\frac{\\partial}{\\partial s}\\right|_{s=0} p = 0.$$\n雅可比场的初始速度是 $J'(0) = \\nabla_t J(t)|_{t=0}$，其中 $\\nabla_t$ 表示沿 $\\gamma$ 的协变导数。根据联络的对称性，我们可以交换微分的次序：\n$$J'(0) = \\nabla_t \\left(\\left.\\frac{\\partial F}{\\partial s}\\right|_{s=0}\\right)\\!\\bigg|_{t=0} = \\nabla_s \\left(\\left.\\frac{\\partial F}{\\partial t}\\right|_{s=0}\\right)\\!\\bigg|_{t=0}.$$\n向量场 $\\frac{\\partial F}{\\partial t}(s,t)$ 是测地线族 $t \\mapsto F(s,t)$ 的切向量场。在 $t=0$ 时，其值为 $d(\\exp_p)_0(r v(s)) = r v(s)$，这是 $T_p M$ 中的一个向量。我们对流形 $T_p M$（一个向量空间）中的曲线 $s \\mapsto r v(s)$ 求协变导数 $\\nabla_s$，这即是普通导数。\n$$J'(0) = \\left.\\frac{d}{ds}\\right|_{s=0} (r v(s)) = r v'(0) = r \\left(\\frac{1}{r}Z\\right) = Z.$$\n所以，雅可比场 $J(t)$ 是满足初始条件 $J(0)=0$ 和 $J'(0)=Z$ 的雅可比方程的唯一解。\n\n由于 $Z \\in v^\\perp$，我们有 $g(J'(0), \\dot{\\gamma}(0)) = g(Z, rv) = r g(Z,v) = 0$。因为 $J(0)=0$，这意味着 $J(t)$ 是一个法雅可比场，即对所有 $t$ 都有 $g(J(t), \\dot{\\gamma}(t))=0$。\n\n雅可比方程为 $\\nabla_T \\nabla_T J + R(J,T)T = 0$，其中 $T = \\dot{\\gamma}$。\n对于常截面曲率 $K$ 的流形，黎曼曲率张量由 $R(X,Y)W = K(g(Y,W)X - g(X,W)Y)$ 给出。\n将此代入雅可比方程，得到\n$$R(J,T)T = K(g(T,T)J - g(J,T)T).$$\n我们有 $\\|T(t)\\|^2 = r^2$，所以 $g(T,T) = r^2$。由于 $J(t)$ 是法向量场，故 $g(J(t),T(t))=0$。\n因此，雅可比方程化简为\n$$\\nabla_T \\nabla_T J(t) + K r^2 J(t) = 0.$$\n\n为求解此向量微分方程，我们引入一个沿 $\\gamma(t)$ 的平行向量场 $E(t)$。令 $E(t)$ 是单位向量 $E(0) = Z/\\|Z\\|$ 沿 $\\gamma$ 的平行移动。由于 $g(J'(0), \\dot{\\gamma}(0)) = 0$，所以对所有 $t$，$E(t)$ 都与 $\\dot{\\gamma}(t)$ 保持正交。雅可比场 $J(t)$ 必具有形式 $J(t) = a(t) E(t)$，其中 $a(t)$ 是某个标量函数，因为它的初始速度 $J'(0)=Z$ 在 $E(0)$ 的方向上。\n\n我们计算 $J(t) = a(t)E(t)$ 的协变导数。由于曲线的参数是 $t$，算子 $\\nabla_T$ 即为 $\\nabla_{\\dot{\\gamma}} = \\nabla_t$。\n$$\\nabla_T J(t) = \\nabla_t (a(t)E(t)) = a'(t)E(t) + a(t)\\nabla_t E(t).$$\n由于 $E(t)$ 是一个平行向量场，所以 $\\nabla_t E(t) = 0$。因此，$\\nabla_T J(t) = a'(t)E(t)$。\n求二阶协变导数：\n$$\\nabla_T \\nabla_T J(t) = \\nabla_t(a'(t)E(t)) = a''(t)E(t) + a'(t)\\nabla_t E(t) = a''(t)E(t).$$\n将这些代入化简后的雅可比方程中：\n$$a''(t)E(t) + K r^2 a(t)E(t) = 0.$$\n因为 $E(t)$ 是非零向量场，所以标量函数 $a(t)$ 必须满足二阶线性常微分方程：\n$$a''(t) + K r^2 a(t) = 0.$$\n\n函数 $a(t)$ 的初始条件由 $J(t)$ 的初始条件导出。\n$J(0) = a(0)E(0) = 0 \\implies a(0)=0$。\n$J'(0) = a'(0)E(0)$。我们知道 $J'(0)=Z$ 和 $E(0)=Z/\\|Z\\|$。所以，$Z = a'(0) (Z/\\|Z\\|)$，这意味着 $a'(0) = \\|Z\\|$。\n\n现在我们根据 $K$ 的符号来解 $a(t)$ 的常微分方程。\n\n情况1：$K>0$。\n方程为 $a''(t) + (r\\sqrt{K})^2 a(t) = 0$。通解为 $a(t) = C_1 \\cos(r t\\sqrt{K}) + C_2 \\sin(r t\\sqrt{K})$。\n$a(0)=0 \\implies C_1 = 0$。\n$a'(t) = C_2 r\\sqrt{K} \\cos(r t\\sqrt{K})$。\n$a'(0)=\\|Z\\| \\implies C_2 r\\sqrt{K} = \\|Z\\| \\implies C_2 = \\frac{\\|Z\\|}{r\\sqrt{K}}$。\n解为 $a(t) = \\frac{\\|Z\\|}{r\\sqrt{K}} \\sin(r t\\sqrt{K})$。\n\n情况2：$K=0$。\n方程为 $a''(t)=0$。通解为 $a(t) = C_1 t + C_2$。\n$a(0)=0 \\implies C_2=0$。\n$a'(t)=C_1$。\n$a'(0)=\\|Z\\| \\implies C_1=\\|Z\\|$。\n解为 $a(t) = \\|Z\\|t$。\n\n情况3：$K<0$。令 $k = \\sqrt{-K} > 0$。\n方程为 $a''(t) - (rk)^2 a(t) = 0$。通解为 $a(t) = C_1 \\cosh(r t k) + C_2 \\sinh(r t k)$。\n$a(0)=0 \\implies C_1=0$。\n$a'(t) = C_2 rk \\cosh(r t k)$。\n$a'(0)=\\|Z\\| \\implies C_2 rk = \\|Z\\| \\implies C_2 = \\frac{\\|Z\\|}{rk} = \\frac{\\|Z\\|}{r\\sqrt{-K}}$。\n解为 $a(t) = \\frac{\\|Z\\|}{r\\sqrt{-K}} \\sinh(r t\\sqrt{-K})$。\n\n问题要求的是 $J(1)$。我们在 $t=1$ 处计算 $J(t)=a(t)E(t)$ 的值：\n$$J(1) = a(1)E(1).$$\n根据定义，$E(1)$ 是将 $E(0)=Z/\\|Z\\|$ 沿 $\\gamma$ 从 $t=0$ 到 $t=1$ 平行移动的结果。这恰好是 $P_1(Z/\\|Z\\|) = P_1(Z)/\\|Z\\|$。\n所以，$J(1) = a(1) \\frac{P_1(Z)}{\\|Z\\|} = \\frac{a(1)}{\\|Z\\|} P_1(Z)$。\n因此函数 $f(K,r)$ 就是 $\\frac{a(1)}{\\|Z\\|}$。\n\n我们根据 $a(t)$ 的解来计算这个函数：\n对于 $K>0$：$f(K,r) = \\frac{a(1)}{\\|Z\\|} = \\frac{1}{\\|Z\\|} \\left(\\frac{\\|Z\\|}{r\\sqrt{K}} \\sin(r\\sqrt{K})\\right) = \\frac{\\sin(r\\sqrt{K})}{r\\sqrt{K}}$。\n对于 $K=0$：$f(K,r) = \\frac{a(1)}{\\|Z\\|} = \\frac{1}{\\|Z\\|} (\\|Z\\|\\cdot 1) = 1$。\n对于 $K<0$：$f(K,r) = \\frac{a(1)}{\\|Z\\|} = \\frac{1}{\\|Z\\|} \\left(\\frac{\\|Z\\|}{r\\sqrt{-K}} \\sinh(r\\sqrt{-K})\\right) = \\frac{\\sinh(r\\sqrt{-K})}{r\\sqrt{-K}}$。\n\n这三个表达式为任意固定的 $r>0$ 定义了一个关于 $K$ 的实解析函数。我们可以用分段形式来表示这个函数。", "answer": "$$\n\\boxed{\nf(K,r) = \\begin{cases} \\frac{\\sin(r\\sqrt{K})}{r\\sqrt{K}} & \\text{若 } K>0 \\\\ 1 & \\text{若 } K=0 \\\\ \\frac{\\sinh(r\\sqrt{-K})}{r\\sqrt{-K}} & \\text{若 } K<0 \\end{cases}\n}\n$$", "id": "2977508"}, {"introduction": "虽然解析解功能强大，但它们通常仅限于具有恒定曲率的高度对称空间。这最后一个练习通过引入一种求解雅可比方程的数值方法，弥合了理想化理论与实际应用之间的差距。你将学习如何将雅可比方程分解为常微分方程组，并使用数值积分来追踪沿可变曲率路径的测地线偏离演化。这项技能在广义相对论等领域是不可或缺的，因为在这些领域中，人们必须经常计算复杂、非均匀时空几何的效应 [@problem_id:2977476]。", "problem": "考虑一个光滑黎曼流形 $(M,g)$ 和一条单位速率测地线 $\\gamma:[0,T]\\to M$，其满足 $\\lVert \\dot{\\gamma}(t)\\rVert_g=1$。$\\gamma$ 的一个由测地线组成的光滑变分，沿 $\\gamma$ 确定了一个作为变分向量场的雅可比场 $J(t)$。雅可比场由一个通过曲率张量和 Levi-Civita 联络得到的二阶线性常微分方程所刻画，其几何意义在于它编码了变分中邻近测地线的无穷小分离。令 $\\{E_1(t),\\dots,E_{m}(t)\\}$ 为沿 $\\gamma$ 的一个平行标准正交标架，该标架处处正交于 $\\dot{\\gamma}(t)$，其中 $m=\\dim(M)-1$。假设在每个 $t$ 时，沿 $\\gamma$ 的雅可比算子（该算子将一个正交于 $\\dot{\\gamma}(t)$ 的向量 $V$ 映射到向量 $R(V,\\dot{\\gamma}(t))\\dot{\\gamma}(t)$）在所选标架下是可对角化的，且其沿 $\\gamma$ 的特征值 $\\kappa_i(t)$ 已知。其几何解释是，每个 $\\kappa_i(t)$ 是在 $E_i(t)$ 方向上无穷小偏离所经受的曲率，并且对于一个正交测地线变分，雅可比场可以写为 $J(t)=\\sum_{i=1}^{m} j_i(t)\\,E_i(t)$，其中 $j_i(t)$ 是标量分量函数。\n\n任务：\n1. 从使用 Levi-Civita 协变导数和黎曼曲率张量表示的雅可比方程出发，结合沿测地线的平行标架的性质以及上述的逐点对角化假设，推导出决定函数 $j_i(t)$ 的、沿 $\\gamma$ 的标量分量方程组，并使其成为一个解耦系统。除基本定义外，不应假设或断言任何预设公式；请仔细推导，并证明解耦的合理性以及已知 $\\kappa_i(t)$ 的作用。\n2. 概述一个有原则的数值方案，用于在给定 $t\\mapsto \\kappa_i(t)$、单位速率参数 $t$（任何三角函数的角度都必须以弧度为单位）以及初始条件 $j_i(0)$ 和 $\\frac{d}{dt}j_i(0)$ 的情况下，对关于 $j_i(t)$ 的解耦二阶标量方程进行积分。将该二阶系统降为适用于稳健 Runge-Kutta 方法的一阶系统，讨论稳定性方面的考量，并解释如何从积分后的分量和平行标架重构雅可比场 $J(t)$。\n3. 在一个程序中实现所述数值方案，该程序需对以下测试套件中的每个测试用例，在 $[0,T]$ 上积分其分量方程，重构 $J(T)$，并返回在所选平行标架中的欧几里得范数 $\\lVert J(T)\\rVert$。为简化和计算确定性，假设沿 $\\gamma$ 使用费米法坐标，从而使得平行标架在所选坐标中是常数；特别地，取 $E_i(t)$ 为坐标单位向量，这样重构就简化为连接各分量值。\n\n角度单位说明：当使用关于 $t$ 的三角函数时，应将 $t$ 的单位视为弧度。\n\n测试套件：\n- 案例 A（边界/振荡，单分量）：$m=1$, $\\kappa_1(t)=1$, $j_1(0)=0$, $\\frac{d}{dt}j_1(0)=1$, $T=\\pi$。\n- 案例 B（平坦，单分量）：$m=1$, $\\kappa_1(t)=0$, $j_1(0)=2$, $\\frac{d}{dt}j_1(0)=-1$, $T=3$。\n- 案例 C（混合曲率，双分量）：$m=2$, $\\kappa_1(t)=0.5+0.3\\sin(t)$, $\\kappa_2(t)=-1.0$, $(j_1(0),j_2(0))=(0.1,0.0)$, $\\left(\\frac{d}{dt}j_1(0),\\frac{d}{dt}j_2(0)\\right)=(0.0,1.0)$, $T=2.5$。\n- 案例 D（变曲率，三分量）：$m=3$, $\\kappa_1(t)=0.2$, $\\kappa_2(t)=0.2\\cos(2t)$, $\\kappa_3(t)=1.5+0.1\\sin(3t)$, $(j_1(0),j_2(0),j_3(0))=(0.0,0.2,-0.05)$, $\\left(\\frac{d}{dt}j_1(0),\\frac{d}{dt}j_2(0),\\frac{d}{dt}j_3(0)\\right)=(1.0,0.0,0.0)$, $T=1.0$。\n\n最终输出格式要求：\n您的程序应生成单行输出，其中包含四个案例的 $J(T)$ 的欧几里得范数，形式为一个用方括号括起来的逗号分隔列表（例如，“[r_A,r_B,r_C,r_D]”），其中每个条目都是一个浮点数。不允许有其他输出。", "solution": "此问题被评估为有效。这是一个黎曼几何和数值分析领域中的适定问题，其基础是已确立的科学原理。问题内容完整，提供了所有必要的数据和条件，并且没有矛盾、歧义或伪科学主张。\n\n该问题结构化为一项包含三部分的任务。第一部分要求从基本的雅可比方程推导出一个常微分方程组。第二部分要求为该系统构建一个数值积分方案。第三部分要求实现此方案以解决一组具体的测试用例。\n\n**第一部分：标量分量方程的推导**\n\n起点是沿测地线 $\\gamma(t)$ 的雅可比方程，它描述了雅可比场 $J(t)$ 的演化：\n$$\n\\nabla_{\\dot{\\gamma}}\\nabla_{\\dot{\\gamma}}J + R(J, \\dot{\\gamma})\\dot{\\gamma} = 0\n$$\n此处，$\\nabla$ 是 Levi-Civita 联络，$\\dot{\\gamma}$ 是测地线 $\\gamma$ 的速度向量，$R$ 是黎曼曲率张量。雅可比场 $J(t)$ 表示在变分中 $\\gamma$ 与邻近测地线之间的无穷小分离向量。如果场 $J(t)$ 初始时正交于 $\\dot{\\gamma}(t)$，那么它将始终保持正交。我们考虑此类正交雅可比场。\n\n给定一个沿 $\\gamma(t)$ 且正交于 $\\dot{\\gamma}(t)$ 的平行标准正交标架 $\\{E_1(t), \\dots, E_m(t)\\}$。“平行”一词意味着每个标架向量沿 $\\gamma$ 的协变导数为零：\n$$\n\\nabla_{\\dot{\\gamma}}E_i(t) = 0 \\quad \\text{for } i=1, \\dots, m\n$$\n雅可比场 $J(t)$ 可以在此标架下用标量分量函数 $j_i(t)$ 表示：\n$$\nJ(t) = \\sum_{i=1}^{m} j_i(t) E_i(t)\n$$\n我们现在计算雅可比方程的第一项 $\\nabla_{\\dot{\\gamma}}\\nabla_{\\dot{\\gamma}}J$。首先，计算一阶协变导数 $\\nabla_{\\dot{\\gamma}}J$。利用协变微分的乘法法则（莱布尼茨法则）以及标架是平行的事实：\n$$\n\\nabla_{\\dot{\\gamma}}J = \\nabla_{\\dot{\\gamma}}\\left(\\sum_{i=1}^{m} j_i(t) E_i(t)\\right) = \\sum_{i=1}^{m} \\left( (\\nabla_{\\dot{\\gamma}}j_i) E_i + j_i (\\nabla_{\\dot{\\gamma}}E_i) \\right)\n$$\n由于 $j_i(t)$ 是标量函数，它们沿 $\\gamma$ 的协变导数就是它们关于参数 $t$ 的普通导数，即 $\\nabla_{\\dot{\\gamma}}j_i = \\frac{d j_i}{dt}$。和式中的第二项因为 $\\nabla_{\\dot{\\gamma}}E_i = 0$ 而消失。因此，\n$$\n\\nabla_{\\dot{\\gamma}}J = \\sum_{i=1}^{m} \\frac{d j_i}{dt} E_i(t)\n$$\n接着，我们再次应用 $\\nabla_{\\dot{\\gamma}}$ 并重复相同的步骤来计算二阶协变导数：\n$$\n\\nabla_{\\dot{\\gamma}}\\nabla_{\\dot{\\gamma}}J = \\nabla_{\\dot{\\gamma}}\\left(\\sum_{i=1}^{m} \\frac{d j_i}{dt} E_i(t)\\right) = \\sum_{i=1}^{m} \\left( (\\nabla_{\\dot{\\gamma}}\\frac{d j_i}{dt}) E_i + \\frac{d j_i}{dt} (\\nabla_{\\dot{\\gamma}}E_i) \\right) = \\sum_{i=1}^{m} \\frac{d^2 j_i}{dt^2} E_i(t)\n$$\n现在我们分析雅可比方程的第二项，即曲率项 $R(J, \\dot{\\gamma})\\dot{\\gamma}$。代入 $J(t)$ 的展开式，并利用黎曼张量在其第一变量上的线性性：\n$$\nR(J, \\dot{\\gamma})\\dot{\\gamma} = R\\left(\\sum_{i=1}^{m} j_i(t) E_i(t), \\dot{\\gamma}\\right)\\dot{\\gamma} = \\sum_{i=1}^{m} j_i(t) R(E_i(t), \\dot{\\gamma})\\dot{\\gamma}\n$$\n问题陈述中说明，雅可比算子（它将一个向量 $V \\perp \\dot{\\gamma}$ 映射到 $R(V, \\dot{\\gamma})\\dot{\\gamma}$）可由标架 $\\{E_i(t)\\}$ 对角化，其特征值为 $\\kappa_i(t)$。这意味着：\n$$\nR(E_i(t), \\dot{\\gamma}(t))\\dot{\\gamma}(t) = \\kappa_i(t) E_i(t)\n$$\n特征值 $\\kappa_i(t)$ 是由 $E_i(t)$ 和 $\\dot{\\gamma}(t)$ 张成的二维平面的截面曲率。将此代入曲率项的表达式中：\n$$\nR(J, \\dot{\\gamma})\\dot{\\gamma} = \\sum_{i=1}^{m} j_i(t) (\\kappa_i(t) E_i(t)) = \\sum_{i=1}^{m} \\kappa_i(t) j_i(t) E_i(t)\n$$\n最后，我们将计算出的两项代回雅可比方程：\n$$\n\\sum_{i=1}^{m} \\frac{d^2 j_i}{dt^2} E_i(t) + \\sum_{i=1}^{m} \\kappa_i(t) j_i(t) E_i(t) = 0\n$$\n合并求和项得到：\n$$\n\\sum_{i=1}^{m} \\left( \\frac{d^2 j_i}{dt^2} + \\kappa_i(t) j_i(t) \\right) E_i(t) = 0\n$$\n由于向量 $\\{E_1(t), \\dots, E_m(t)\\}$ 构成 $\\dot{\\gamma}(t)$ 正交补空间的一个标准正交基，它们是线性无关的。因此，要使和为零向量，每个系数必须为零。这就得到了所期望的解耦二阶线性常微分方程组：\n$$\n\\frac{d^2 j_i}{dt^2} + \\kappa_i(t) j_i(t) = 0, \\quad \\text{for } i=1, \\dots, m.\n$$\n这种解耦是以下关键假设的直接结果：平行标架 $\\{E_i\\}$ 在沿测地线 $\\gamma$ 的所有点上同时对角化雅可比算子 $V \\mapsto R(V, \\dot{\\gamma})\\dot{\\gamma}$。\n\n**第二部分：数值积分方案**\n\n为了数值求解这个由 $m$ 个二阶常微分方程组成的系统，我们首先将其转换为一个由 $2m$ 个一阶常微分方程组成的系统。对于每个分量 $i \\in \\{1, \\dots, m\\}$，我们定义一个包含两个分量的状态向量：\n令 $y_{i,1}(t) = j_i(t)$ 且 $y_{i,2}(t) = \\frac{d j_i}{dt}(t)$。\n关于 $j_i$ 的二阶方程可以重写为关于 $y_{i,1}$ 和 $y_{i,2}$ 的一阶系统：\n$$\n\\frac{d y_{i,1}}{dt} = y_{i,2}\n$$\n$$\n\\frac{d y_{i,2}}{dt} = \\frac{d^2 j_i}{dt^2} = -\\kappa_i(t) j_i(t) = -\\kappa_i(t) y_{i,1}\n$$\n我们可以将所有 $m$ 个分量的这些变量连接成一个维度为 $2m$ 的单一状态向量 $\\mathbf{y}(t)$：\n$$\n\\mathbf{y}(t) = [y_{1,1}(t), y_{1,2}(t), y_{2,1}(t), y_{2,2}(t), \\dots, y_{m,1}(t), y_{m,2}(t)]^T\n$$\n整个系统于是可以表示为标准形式 $\\frac{d\\mathbf{y}}{dt} = \\mathbf{f}(t, \\mathbf{y})$，其中函数 $\\mathbf{f}$ 为：\n$$\n\\mathbf{f}(t, \\mathbf{y}) = [y_{1,2}, -\\kappa_1(t) y_{1,1}, y_{2,2}, -\\kappa_2(t) y_{2,1}, \\dots, y_{m,2}, -\\kappa_m(t) y_{m,1}]^T\n$$\n初始条件 $j_i(0)$ 和 $\\frac{d j_i}{dt}(0)$ 直接确定了初始状态向量 $\\mathbf{y}(0)$。\n\n对于数值积分，一个稳健的选择是自适应步长 Runge-Kutta 方法，例如 Dormand-Prince 方法对 (RK45)。这类方法在标准的科学计算库中已有实现，如 Python 中的 `scipy.integrate.solve_ivp`。它们会自动调整步长以控制局部误差，从而确保准确性和效率。\n\n关于稳定性，第 $i$ 个分量的解的行为取决于 $\\kappa_i(t)$ 的符号。\n- 如果 $\\kappa_i(t) > 0$，方程 $j_i'' + \\kappa_i j_i = 0$ 类似于一个谐振子。其解是振荡的并保持有界。这代表稳定行为，对应于测地线在正曲率方向上的再聚焦。\n- 如果 $\\kappa_i(t) < 0$，方程 $j_i'' - |\\kappa_i| j_i = 0$ 的解会指数增长。这代表不稳定行为，对应于测地线在负曲率方向上的发散。\n- 如果 $\\kappa_i(t) = 0$，方程为 $j_i''=0$，这导致分离呈线性增长。\n给定的常微分方程是线性和非刚性的，这使得显式 Runge-Kutta 方法非常适用。\n\n将系统从 $t=0$ 积分到最终时间 $t=T$ 后，数值求解器会提供最终状态向量 $\\mathbf{y}(T)$。雅可比场 $J(T)$ 的分量是值 $j_i(T)$，它们对应于 $\\mathbf{y}(T)$ 的奇数索引元素：$j_i(T) = y_{2i-1}(T)$。\n问题通过假设存在一个坐标系，其中平行标架向量 $E_i(t)$ 是常数的坐标单位向量，从而简化了重构过程。在此基底下，向量 $J(T)$ 就是其分量构成的向量：\n$$\nJ(T) = (j_1(T), j_2(T), \\dots, j_m(T))\n$$\n所要求的输出，即欧几里得范数 $\\lVert J(T) \\rVert$，则计算如下：\n$$\n\\lVert J(T) \\rVert = \\sqrt{\\sum_{i=1}^{m} (j_i(T))^2}\n$$\n\n**第三部分：实现**\n\n实现将遵循上述方案。对于每个测试用例，将根据所提供的 $\\kappa_i(t)$ 函数来为常微分方程系统 $\\mathbf{f}(t, \\mathbf{y})$ 定义一个函数。将使用 `scipy.integrate.solve_ivp` 函数来积分该系统。最终的状态向量将用于计算在 $t=T$ 时刻重构的雅可比场的范数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves for the Euclidean norm of the Jacobi field J(T) for four test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A\n        {\n            \"m\": 1,\n            \"kappas_func\": [lambda t: 1.0],\n            \"j0\": [0.0],\n            \"dj0\": [1.0],\n            \"T\": np.pi,\n        },\n        # Case B\n        {\n            \"m\": 1,\n            \"kappas_func\": [lambda t: 0.0],\n            \"j0\": [2.0],\n            \"dj0\": [-1.0],\n            \"T\": 3.0,\n        },\n        # Case C\n        {\n            \"m\": 2,\n            \"kappas_func\": [\n                lambda t: 0.5 + 0.3 * np.sin(t),\n                lambda t: -1.0\n            ],\n            \"j0\": [0.1, 0.0],\n            \"dj0\": [0.0, 1.0],\n            \"T\": 2.5,\n        },\n        # Case D\n        {\n            \"m\": 3,\n            \"kappas_func\": [\n                lambda t: 0.2,\n                lambda t: 0.2 * np.cos(2 * t),\n                lambda t: 1.5 + 0.1 * np.sin(3 * t)\n            ],\n            \"j0\": [0.0, 0.2, -0.05],\n            \"dj0\": [1.0, 0.0, 0.0],\n            \"T\": 1.0,\n        },\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        m = case[\"m\"]\n        kappas_func = case[\"kappas_func\"]\n        T = case[\"T\"]\n        \n        # Define the system of first-order ODEs dy/dt = f(t, y)\n        def dydt(t, y):\n            \"\"\"\n            Computes the derivative of the state vector y at time t.\n            The state vector y is a flat array of size 2m:\n            [j_1, j'_1, j_2, j'_2, ..., j_m, j'_m]\n            \"\"\"\n            dydt_array = np.zeros_like(y)\n            for i in range(m):\n                j_i = y[2 * i]\n                dj_i_dt = y[2 * i + 1]\n                \n                # Equation 1: d(j_i)/dt = j'_i\n                dydt_array[2 * i] = dj_i_dt\n                \n                # Equation 2: d(j'_i)/dt = -kappa_i(t) * j_i\n                kappa_i_t = kappas_func[i](t)\n                dydt_array[2 * i + 1] = -kappa_i_t * j_i\n            \n            return dydt_array\n\n        # Set up the initial conditions vector y0\n        y0 = np.zeros(2 * m)\n        y0[0::2] = case[\"j0\"]\n        y0[1::2] = case[\"dj0\"]\n        \n        # Define the time span for integration\n        t_span = [0, T]\n        \n        # Use a high-quality ODE solver (RK45 is the default)\n        # Set rtol and atol for high precision\n        sol = solve_ivp(\n            dydt, \n            t_span, \n            y0, \n            method='RK45', \n            dense_output=False,\n            rtol=1e-12, \n            atol=1e-12\n        )\n        \n        # The solution at the final time T is the last column of sol.y\n        y_final = sol.y[:, -1]\n        \n        # The components of the Jacobi field J(T) are the even-indexed elements\n        # (0, 2, 4, ...) of the final state vector.\n        j_components_at_T = y_final[0::2]\n        \n        # Calculate the Euclidean norm of the vector J(T)\n        norm_J_T = np.linalg.norm(j_components_at_T)\n        results.append(norm_J_T)\n\n    # Format and print the final results\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\n# Execute the main function\nsolve()\n```", "id": "2977476"}]}