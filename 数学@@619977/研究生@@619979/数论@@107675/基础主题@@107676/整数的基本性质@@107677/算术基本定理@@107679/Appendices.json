{"hands_on_practices": [{"introduction": "让我们从一个有趣的数字构造谜题开始。这个练习要求我们利用关于一个整数 $n$ 的因数的线索，从零开始构建这个数。算术基本定理是解决这个问题的核心工具，它允许我们独立地思考 $n$ 的质因数分解中每个质数（在这里是 $2$、$3$ 和 $5$）的指数。这个练习将锻炼你运用质因数分解解决具体问题的基本技能。[@problem_id:1831862]", "problem": "如果一个整数是某个整数的平方，则称其为完全平方数。类似地，如果一个整数是某个整数的立方，则称其为完全立方数；如果是一个整数的五次方，则称其为完全五次方数。求满足以下所有条件的最小正整数 $n$：\n1. 整数商 $n/2$ 是一个完全平方数。\n2. 整数商 $n/3$ 是一个完全立方数。\n3. 整数商 $n/5$ 是一个完全五次方数。\n\n将答案表示为质因数幂的乘积形式 $p_1^{e_1} p_2^{e_2} \\cdots p_k^{e_k}$。", "solution": "设 $n$ 的质因数分解为 $n=\\prod_{p} p^{v_{p}(n)}$。给定的条件如下：\n- $n/2$ 是一个完全平方数，所以对于每个质数 $p$：\n  - 如果 $p=2$，那么 $v_{2}(n)-1$ 是偶数。\n  - 如果 $p\\neq 2$，那么 $v_{p}(n)$ 是偶数。\n- $n/3$ 是一个完全立方数，所以：\n  - 如果 $p=3$，那么 $v_{3}(n)-1$ 是 $3$ 的倍数。\n  - 如果 $p\\neq 3$，那么 $v_{p}(n)$ 是 $3$ 的倍数。\n- $n/5$ 是一个完全五次方数，所以：\n  - 如果 $p=5$，那么 $v_{5}(n)-1$ 是 $5$ 的倍数。\n  - 如果 $p\\neq 5$，那么 $v_{p}(n)$ 是 $5$ 的倍数。\n\n对于 $p\\notin\\{2,3,5\\}$，指数必须同时是偶数、3的倍数和5的倍数，因此是 $\\operatorname{lcm}(2,3,5)=30$ 的倍数。为了使 $n$ 最小，将这些指数设为 $0$。\n\n设 $a=v_{2}(n)$，$b=v_{3}(n)$，$c=v_{5}(n)$。同余条件变为\n$$\n\\begin{aligned}\n&\\text{由 }n/2\\text{ 为完全平方数：} && a\\equiv 1 \\pmod{2},\\quad b\\equiv 0 \\pmod{2},\\quad c\\equiv 0 \\pmod{2}, \\\\\n&\\text{由 }n/3\\text{ 为完全立方数：} && a\\equiv 0 \\pmod{3},\\quad b\\equiv 1 \\pmod{3},\\quad c\\equiv 0 \\pmod{3}, \\\\\n&\\text{由 }n/5\\text{ 为完全五次方数：} && a\\equiv 0 \\pmod{5},\\quad b\\equiv 0 \\pmod{5},\\quad c\\equiv 1 \\pmod{5}。\n\\end{aligned}\n$$\n\n对每个变量独立求解：\n- 对于 $a$：$a\\equiv 0 \\pmod{3}$ 且 $a\\equiv 0 \\pmod{5}$ 意味着 $a\\equiv 0 \\pmod{15}$；结合 $a\\equiv 1 \\pmod{2}$，最小解是 $a=15$。\n- 对于 $b$：$b\\equiv 0 \\pmod{2}$ 且 $b\\equiv 0 \\pmod{5}$ 意味着 $b\\equiv 0 \\pmod{10}$。设 $b=10k$，条件 $b\\equiv 1 \\pmod{3}$ 给出 $10k\\equiv 1 \\pmod{3}$，即 $k\\equiv 1 \\pmod{3}$。最小解是 $k=1$，因此 $b=10$。\n- 对于 $c$：$c\\equiv 0 \\pmod{2}$ 且 $c\\equiv 0 \\pmod{3}$ 意味着 $c\\equiv 0 \\pmod{6}$。设 $c=6k$，条件 $c\\equiv 1 \\pmod{5}$ 给出 $6k\\equiv 1 \\pmod{5}$，即 $k\\equiv 1 \\pmod{5}$。最小解是 $k=1$，因此 $c=6$。\n\n因此，最小的 $n$ 是\n$$\nn=2^{15}\\cdot 3^{10}\\cdot 5^{6}.\n$$\n验证：\n- $n/2$ 的指数为 $14,10,6$，都是偶数，所以它是一个完全平方数。\n- $n/3$ 的指数为 $15,9,6$，都是 $3$ 的倍数，所以它是一个完全立方数。\n- $n/5$ 的指数为 $15,10,5$，都是 $5$ 的倍数，所以它是一个完全五次方数。\n\n因此，$n=2^{15}3^{10}5^{6}$ 是满足所有条件的最小值。", "answer": "$$\\boxed{2^{15}\\cdot 3^{10}\\cdot 5^{6}}$$", "id": "1831862"}, {"introduction": "在掌握了如何构造一个整数后，我们现在转向一个更具挑战性的任务：计数。许多数论中的计数问题，如果能按每个质因数进行独立分析，就会变得异常清晰。这个关于最小公倍数（LCM）的问题，正是这种强大的“分而治之”策略的经典范例，而算术基本定理是实现这一策略的基石。[@problem_id:1831874]", "problem": "设 $N$ 是一个正整数，其唯一的素因数分解为 $N = p_1^{k_1} p_2^{k_2} \\cdots p_m^{k_m}$，其中 $p_1, p_2, \\ldots, p_m$ 是不同的素数，而 $k_1, k_2, \\ldots, k_m$ 是正整数指数。\n\n求出一个公式，用以计算满足最小公倍数等于 $N$ 的正整数有序对 $(a, b)$ 的数量。请将您的答案表示为一个用指数 $k_1, k_2, \\ldots, k_m$ 表示的公式。", "solution": "设 $N$ 的素因数分解为 $N=\\prod_{i=1}^{m} p_{i}^{k_{i}}$，其中 $p_i$ 为不同的素数，$k_i$ 为正整数。对于任意正整数 $a$ 和 $b$，可写作\n$$\na=\\prod_{i=1}^{m} p_{i}^{x_{i}},\\quad b=\\prod_{i=1}^{m} p_{i}^{y_{i}},\n$$\n其中 $x_{i}=v_{p_{i}}(a)$ 和 $y_{i}=v_{p_{i}}(b)$ 分别是 $a$ 和 $b$ 的 $p_{i}$-adic 赋值。如果 $q$ 是任意一个不在 $\\{p_{1},\\ldots,p_{m}\\}$ 中的素数，那么 $v_{q}(N)=0$，并且条件 $\\operatorname{lcm}(a,b)=N$ 强制要求 $v_{q}(a)=v_{q}(b)=0$，因为否则 $\\operatorname{lcm}(a,b)$ 将能被 $q$ 整除。\n\n对于每个 $i$，最小公倍数满足\n$$\nv_{p_{i}}(\\operatorname{lcm}(a,b))=\\max\\{v_{p_{i}}(a),v_{p_{i}}(b)\\}=\\max\\{x_{i},y_{i}\\}.\n$$\n因此，条件 $\\operatorname{lcm}(a,b)=N$ 等价于对于每个 $i$ 的以下约束条件组：\n$$\n\\max\\{x_{i},y_{i}\\}=k_{i},\\quad 0\\leq x_{i}\\leq k_{i},\\quad 0\\leq y_{i}\\leq k_{i}.\n$$\n\n对于一个固定的 $i$，满足 $0\\leq x_{i},y_{i}\\leq k_{i}$ 和 $\\max\\{x_{i},y_{i}\\}=k_{i}$ 的有序对 $(x_{i},y_{i})$ 的数量，等于在 $(k_{i}+1)\\times(k_{i}+1)$ 网格中的总对数减去那些两个坐标都至多为 $k_{i}-1$ 的对数，即\n$$\n(k_{i}+1)^{2}-k_{i}^{2}=2k_{i}+1.\n$$\n等价地，我们可以直接计数：当 $x_{i}=k_{i}$ 且 $y_{i}\\in\\{0,\\ldots,k_{i}\\}$ 时，有 $k_{i}+1$ 种选择；以及当 $y_{i}=k_{i}$ 且 $x_{i}\\in\\{0,\\ldots,k_{i}-1\\}$ 时的另外 $k_{i}$ 种选择，总计 $2k_{i}+1$ 种。\n\n由于对于不同的素数 $p_{i}$，其选择是相互独立的，并且在这些约束下，从 $(a,b)$ 到元组 $\\bigl((x_{1},y_{1}),\\ldots,(x_{m},y_{m})\\bigr)$ 的映射是双射的，因此满足 $\\operatorname{lcm}(a,b)=N$ 的有序对 $(a,b)$ 的总数是这些计数的乘积（对所有 $i$ 求积）：\n$$\n\\prod_{i=1}^{m} (2k_{i}+1).\n$$", "answer": "$$\\boxed{\\prod_{i=1}^{m} \\left(2k_{i}+1\\right)}$$", "id": "1831874"}, {"introduction": "为了进行更深入的探索，我们引入 $p$-adic 赋值（$p$-adic valuation）的概念，它是一种精确测量一个数中质数 $p$ “含量”的工具。这个练习将引导你推导一个著名的公式（与勒让德公式相关），并将其与库默尔定理联系起来。通过这个过程，你将揭示质因数分解、p 进制算术和组合学之间一个惊人而深刻的联系。[@problem_id:3026201]", "problem": "设 $p$ 是一个素数，$a$ 和 $b$ 是正整数。根据算术基本定理，每个正整数都有唯一的素数幂乘积分解。对于一个固定的素数 $p$，这定义了 $p$-adic 赋值 $v_p(n)$，其值为 $n$ 的素数分解中 $p$ 的指数。设 $s_p(n)$ 表示 $n$ 在 $p$ 进制下各位数字之和。\n\n仅从这些定义和素数分解的唯一性出发，推导\n$$\nv_p\\!\\left(\\frac{(ab)!}{a!\\,b!}\\right)\n$$\n的一个闭式表达式，该表达式用 $p$、$a$、$b$ 以及 $p$ 进制各位数字之和 $s_p(ab)$、$s_p(a)$ 和 $s_p(b)$ 表示。然后，使用 Kummer 定理，解释 $p$ 进制加法中的进位与二项式系数的 $p$-adic 赋值相关的组合意义，并指出在 $\\frac{(ab)!}{a!\\,b!}$ 内的二项式因子所产生的进位贡献。\n\n你的最终答案必须是仅用 $p$、$a$、$b$、$s_p(ab)$、$s_p(a)$ 和 $s_p(b)$ 表示的 $v_p\\!\\left(\\frac{(ab)!}{a!\\,b!}\\right)$ 的单个闭式表达式。不需要近似或四舍五入。", "solution": "首先，我们建立一个阶乘的 $p$-adic 赋值的公式，即 $v_p(n!)$。根据定义，$n! = 1 \\cdot 2 \\cdots n$。$n!$ 的 $p$-adic 赋值是从 1 到 $n$ 的所有整数的 $p$-adic 赋值之和：\n$$v_p(n!) = v_p\\left(\\prod_{k=1}^n k\\right) = \\sum_{k=1}^n v_p(k)$$\n这个和中的项仅当 $k$ 是 $p$ 的倍数时才非零。不大於 $n$ 的 $p$ 的倍数的数量是 $\\lfloor \\frac{n}{p} \\rfloor$。每个这样的数都至少贡献一个因子 $p$。不大於 $n$ 的 $p^2$ 的倍数的数量是 $\\lfloor \\frac{n}{p^2} \\rfloor$。这些数贡献了额外的一个因子 $p$。对 $p$ 的所有次幂继续这个过程，我们得到勒让德公式 (Legendre's formula)：\n$$v_p(n!) = \\sum_{k=1}^{\\infty} \\left\\lfloor \\frac{n}{p^k} \\right\\rfloor$$\n为了将其与各位数字之和 $s_p(n)$ 联系起来，我们将 $n$ 表示为 $p$ 进制：$n = \\sum_{i=0}^m d_i p^i$，其中 $0 \\le d_i < p$。各位数字之和为 $s_p(n) = \\sum_{i=0}^m d_i$。\n使用 $n$ 的 $p$ 进制展开式，我们可以写出：\n$$\n\\left\\lfloor \\frac{n}{p^k} \\right\\rfloor = \\left\\lfloor \\sum_{i=0}^m d_i p^{i-k} \\right\\rfloor = \\sum_{i=k}^m d_i p^{i-k}\n$$\n将此代入勒让德公式：\n$$\nv_p(n!) = \\sum_{k=1}^m \\sum_{i=k}^m d_i p^{i-k}\n$$\n改变求和顺序：\n$$\nv_p(n!) = \\sum_{i=1}^m d_i \\sum_{k=1}^i p^{i-k} = \\sum_{i=1}^m d_i (1 + p + \\dots + p^{i-1}) = \\sum_{i=1}^m d_i \\frac{p^i - 1}{p-1}\n$$\n注意，求和可以从 $i=0$ 开始，因为 $i=0$ 时的项为零。\n$$\nv_p(n!) = \\frac{1}{p-1} \\sum_{i=0}^m d_i(p^i - 1) = \\frac{1}{p-1} \\left( \\sum_{i=0}^m d_i p^i - \\sum_{i=0}^m d_i \\right) = \\frac{n - s_p(n)}{p-1}\n$$\n这就是连接 $v_p(n!)$ 与 $s_p(n)$ 的所求公式。\n\n现在，我们可以计算给定表达式的 $p$-adic 赋值：\n$$\nv_p\\left(\\frac{(ab)!}{a!\\,b!}\\right) = v_p((ab)!) - v_p(a!) - v_p(b!)\n$$\n将公式 $v_p(n!) = \\frac{n - s_p(n)}{p-1}$ 应用于每一项：\n$$\nv_p((ab)!) = \\frac{ab - s_p(ab)}{p-1}\n$$\n$$\nv_p(a!) = \\frac{a - s_p(a)}{p-1}\n$$\n$$\nv_p(b!) = \\frac{b - s_p(b)}{p-1}\n$$\n将这些代回 $v_p\\left(\\frac{(ab)!}{a!\\,b!}\\right)$ 的表达式中：\n$$\nv_p\\left(\\frac{(ab)!}{a!\\,b!}\\right) = \\frac{ab - s_p(ab)}{p-1} - \\frac{a - s_p(a)}{p-1} - \\frac{b - s_p(b)}{p-1}\n$$\n$$\nv_p\\left(\\frac{(ab)!}{a!\\,b!}\\right) = \\frac{1}{p-1} \\left( (ab - s_p(ab)) - (a - s_p(a)) - (b - s_p(b)) \\right)\n$$\n$$\nv_p\\left(\\frac{(ab)!}{a!\\,b!}\\right) = \\frac{ab - a - b - s_p(ab) + s_p(a) + s_p(b)}{p-1}\n$$\n这就是所求的闭式表达式。\n\n接下来，我们解释 Kummer 定理。Kummer 定理指出，对于一个素数 $p$ 和整数 $n \\ge k \\ge 0$，二项式系数 $\\binom{n}{k}$ 的 $p$-adic 赋值等于在 $p$ 进制下计算 $k$ 与 $n-k$ 相加时产生的进位数。\n$\\binom{n}{k} = \\frac{n!}{k!(n-k)!}$ 的 $p$-adic 赋值由以下公式给出：\n$$\nv_p\\left(\\binom{n}{k}\\right) = v_p(n!) - v_p(k!) - v_p((n-k)!) = \\frac{n - s_p(n)}{p-1} - \\frac{k - s_p(k)}{p-1} - \\frac{n-k - s_p(n-k)}{p-1}\n$$\n$$\nv_p\\left(\\binom{n}{k}\\right) = \\frac{s_p(k) + s_p(n-k) - s_p(n)}{p-1}\n$$\n为了证明这等于进位数，设 $k = \\sum k_i p^i$ 和 $n-k = \\sum j_i p^i$ 为其 $p$ 进制表示。$p$ 进制加法 $k + (n-k) = n$ 可以通过逐位的等式 $k_i + j_i + c_i = n_i + c_{i+1}p$ 来描述，其中 $c_i$ 是从第 $i-1$ 位产生的进位（$c_0=0$）。对所有位置 $i$ 求和：\n$$\n\\sum_i k_i + \\sum_i j_i + \\sum_i c_i = \\sum_i n_i + p \\sum_i c_{i+1}\n$$\n这得到 $s_p(k) + s_p(n-k) + \\sum_{i \\ge 0} c_i = s_p(n) + p \\sum_{i \\ge 1} c_i$。\n设 $C = \\sum_{i \\ge 1} c_i$ 为总进位数。因为 $c_0=0$，所以 $\\sum_{i \\ge 0} c_i = C$。因此：\n$$\ns_p(k) + s_p(n-k) + C = s_p(n) + pC\n$$\n$$\ns_p(k) + s_p(n-k) - s_p(n) = (p-1)C\n$$\n$$\nC = \\frac{s_p(k) + s_p(n-k) - s_p(n)}{p-1} = v_p\\left(\\binom{n}{k}\\right)\n$$\n这证实了二项式系数的 $p$-adic 赋值就是相应 $p$ 进制加法中的进位数。\n\n最后，我们确定表达式 $v_p\\left(\\frac{(ab)!}{a!\\,b!}\\right)$ 中的进位贡献。给定的表达式不是一个标准的二项式系数。但是，我们可以对其进行因式分解以揭示一个二项式系数：\n$$\n\\frac{(ab)!}{a!\\,b!} = \\frac{(ab)!}{a!(ab-a)!} \\cdot \\frac{(ab-a)!}{b!} = \\binom{ab}{a} \\frac{(ab-a)!}{b!}\n$$\n因此，$p$-adic 赋值是可加的：\n$$\nv_p\\left(\\frac{(ab)!}{a!\\,b!}\\right) = v_p\\left(\\binom{ab}{a}\\right) + v_p\\left(\\frac{(ab-a)!}{b!}\\right)\n$$\n问题中提到“$\\frac{(ab)!}{a!\\,b!}$ 内的二项式因子”。这自然地被解释为 $\\binom{ab}{a}$（或等价地，$\\binom{ab}{b}$）。“进位贡献”就是这个因子的 $p$-adic 赋值，即 $v_p\\left(\\binom{ab}{a}\\right)$。\n根据 Kummer 定理，这个贡献 $v_p\\left(\\binom{ab}{a}\\right)$ 正是在 $p$ 进制下将 $a$ 和 $ab-a$ 相加时的进位数。另一项 $v_p\\left(\\frac{(ab-a)!}{b!}\\right)$ 是总赋值的一个附加部分，可以表示为 $\\frac{ab-a-b - s_p(ab-a) + s_p(b)}{p-1}$，但通常不具有作为进位数的简单解释。", "answer": "$$\n\\boxed{\\frac{ab - a - b + s_p(a) + s_p(b) - s_p(ab)}{p-1}}\n$$", "id": "3026201"}]}