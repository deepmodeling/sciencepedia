{"hands_on_practices": [{"introduction": "求解线性同余方程 $ax \\equiv 1 \\pmod{n}$ 是数论中的一个基本问题，其核心在于找到 $a$ 在模 $n$ 下的乘法逆元。这个过程与求解丢番图方程 $ax+ny=\\gcd(a,n)$ 紧密相关。本练习将引导你使用扩展欧几里得算法，这是解决此类问题的关键工具，并从第一性原理证明解的存在性和唯一性。[@problem_id:3009032]", "problem": "考虑模$256$的整数环。仅使用最大公约数（Greatest Common Divisor (gcd)）的定义、贝祖等式（Bézout identity）以及构造性扩展欧几里得算法，确定满足$97x \\equiv 1 \\pmod{256}$的最小非负整数$x$。通过推导$97$和$256$的贝祖系数来证明此$x$的存在性，通过扩展欧几里得算法从这些系数中显式计算$x$，然后基于整除性和最大公约数的第一性原理论证来验证解类在模$256$意义下是唯一的。你的最终答案必须是最小非负代表元$x$。无需舍入。", "solution": "给定问题是要求解满足线性同余方程$97x \\equiv 1 \\pmod{256}$的最小非负整数$x$。求解过程必须证明此$x$的存在性，使用扩展欧几里得算法显式计算它，并验证解类在模$256$意义下的唯一性。\n\n首先，我们建立给定同余方程与一个线性丢番图方程之间的关系。根据定义，同余方程$97x \\equiv 1 \\pmod{256}$等价于$256$整除$97x - 1$这一陈述。这意味着存在一个整数，我们称之为$y'$，使得$97x - 1 = 256y'$。整理该方程得到$97x - 256y' = 1$。通过令$y = -y'$，我们可以将其表示为线性丢番图方程的标准形式：\n$$97x + 256y = 1$$\n因此，解此同余方程等价于求该方程的一个整数解$(x, y)$。\n\n形如$ax + by = c$的方程是否存在整数解由贝祖等式（Bézout's identity）确定。该等式指出，这类方程有整数解$x$和$y$的充要条件是$a$和$b$的最大公约数（记为$\\gcd(a, b)$）是$c$的约数。在我们的问题中，$a=97$，$b=256$，$c=1$。因此，解存在的充要条件是$\\gcd(97, 256)$整除$1$。由于$\\gcd(97, 256)$必须是一个正整数，这个条件等价于$\\gcd(97, 256) = 1$。\n\n我们使用欧几里得算法来计算$97$和$256$的最大公约数。\n$$256 = 2 \\cdot 97 + 62$$\n$$97 = 1 \\cdot 62 + 35$$\n$$62 = 1 \\cdot 35 + 27$$\n$$35 = 1 \\cdot 27 + 8$$\n$$27 = 3 \\cdot 8 + 3$$\n$$8 = 2 \\cdot 3 + 2$$\n$$3 = 1 \\cdot 2 + 1$$\n$$2 = 2 \\cdot 1 + 0$$\n序列中最后一个非零余数是$1$。因此，我们明确地证明了$\\gcd(97, 256) = 1$。根据贝祖等式，这保证了存在整数$x$和$y$满足$97x + 256y = 1$。将此方程对$256$取模，得到$97x \\equiv 1 \\pmod{256}$，这证实了模逆元$x$的存在性。\n\n接下来，我们运用构造性扩展欧几里得算法来求出$x$的一个特解。这是通过回溯欧几里得算法的步骤，将最大公约数$1$表示为$97$和$256$的线性组合来实现的。\n\n从算法的倒数第二步，我们有$1 = 3 - 1 \\cdot 2$。\n我们将前一步的余数$2 = 8 - 2 \\cdot 3$代入此表达式中：\n$$1 = 3 - 1 \\cdot (8 - 2 \\cdot 3) = 3 - 8 + 2 \\cdot 3 = 3 \\cdot 3 - 1 \\cdot 8$$\n接着，我们代入$3 = 27 - 3 \\cdot 8$：\n$$1 = 3 \\cdot (27 - 3 \\cdot 8) - 1 \\cdot 8 = 3 \\cdot 27 - 9 \\cdot 8 - 1 \\cdot 8 = 3 \\cdot 27 - 10 \\cdot 8$$\n接着，我们代入$8 = 35 - 1 \\cdot 27$：\n$$1 = 3 \\cdot 27 - 10 \\cdot (35 - 1 \\cdot 27) = 3 \\cdot 27 - 10 \\cdot 35 + 10 \\cdot 27 = 13 \\cdot 27 - 10 \\cdot 35$$\n接着，我们代入$27 = 62 - 1 \\cdot 35$：\n$$1 = 13 \\cdot (62 - 1 \\cdot 35) - 10 \\cdot 35 = 13 \\cdot 62 - 13 \\cdot 35 - 10 \\cdot 35 = 13 \\cdot 62 - 23 \\cdot 35$$\n接着，我们代入$35 = 97 - 1 \\cdot 62$：\n$$1 = 13 \\cdot 62 - 23 \\cdot (97 - 1 \\cdot 62) = 13 \\cdot 62 - 23 \\cdot 97 + 23 \\cdot 62 = 36 \\cdot 62 - 23 \\cdot 97$$\n最后，我们代入$62 = 256 - 2 \\cdot 97$：\n$$1 = 36 \\cdot (256 - 2 \\cdot 97) - 23 \\cdot 97 = 36 \\cdot 256 - 72 \\cdot 97 - 23 \\cdot 97$$\n化简后得到所需形式：\n$$1 = 36 \\cdot 256 - 95 \\cdot 97$$\n重新整理以匹配$97x + 256y = 1$的形式，我们得到：\n$$97(-95) + 256(36) = 1$$\n从此方程中，我们确定$x$的一个特解为$x_0 = -95$。这个值满足同余方程$97 \\cdot (-95) \\equiv 1 \\pmod{256}$。问题要求的是最小非负整数$x$。我们通过计算$x_0$模$256$的值来求得此数：\n$$x \\equiv -95 \\pmod{256}$$\n$$x \\equiv -95 + 256 \\pmod{256}$$\n$$x \\equiv 161 \\pmod{256}$$\n因此，最小非负整数解是$x = 161$。\n\n最后，我们必须为解类在模$256$意义下的唯一性提供一个第一性原理的论证。我们假设$x_1$和$x_2$都是该同余方程的整数解。那么我们有：\n$$97x_1 \\equiv 1 \\pmod{256}$$\n$$97x_2 \\equiv 1 \\pmod{256}$$\n将这两个同余式相减，可得 $97x_1 - 97x_2 \\equiv 1 - 1 \\pmod{256}$，即：\n$$97(x_1 - x_2) \\equiv 0 \\pmod{256}$$\n根据模同余的定义，这意味着$256$整除乘积$97(x_1 - x_2)$，我们记为$256 | 97(x_1 - x_2)$。\n我们已经证明了$\\gcd(97, 256) = 1$。数论中的一个基本引理（贝祖等式的一个推论，常被称为欧几里得引理 (Euclid's lemma)）指出，如果一个整数$n$整除乘积$ab$且与$a$互质（即$\\gcd(n, a) = 1$），那么$n$必定整除$b$。在我们的情景中，$n=256$，$a=97$，$b=(x_1 - x_2)$。\n由于$256 | 97(x_1 - x_2)$且$\\gcd(256, 97) = 1$，我们必须得出结论：$256 | (x_1 - x_2)$。\n根据定义，这个整除条件等价于陈述$x_1 \\equiv x_2 \\pmod{256}$。\n这证明了原同余方程的任意两个解在模$256$意义下必然是同余的。因此，尽管存在无限多个整数解，但它们都属于模$256$的同一个唯一的同余类。该类的最小非负代表元是在模$256$整数环中的唯一解，也就是我们求得的值$x=161$。\n我们可以验证这个结果：$97 \\times 161 = 15617$。除以$256$，我们发现$15617 = 61 \\times 256 + 1$，这证实了$97 \\times 161 \\equiv 1 \\pmod{256}$。", "answer": "$$\\boxed{161}$$", "id": "3009032"}, {"introduction": "在我们能够找到丢番图方程的一个特解后，便可以刻画出其所有整数解的集合，这个集合构成一个仿射格。本练习探讨如何利用这种解的完整参数化形式来解决带有附加约束（例如非负性）的问题。通过这个实践，你将把代数解集与一个具体的几何问题——寻找第一象限内线段上的整数点——联系起来。[@problem_id:3009031]", "problem": "设 $a$ 和 $b$ 为互质正整数；即，它们的最大公约数 (gcd) 满足 $\\gcd(a,b)=1$。根据 Bézout 恒等式，存在整数 $u$ 和 $v$ 使得 $au+bv=1$。仅使用以下基本事实：线性丢番图方程 $au+bv=c$ 的整数解集非空当且仅当 $\\gcd(a,b)$ 整除 $c$，且当解集非空时，它构成由一个从 Bézout 对获得的方向向量生成的一维整格的仿射平移。请基于此分析方程 $5x+7y=100$。\n\n具体来说，通过明确刻画解格并考察其与第一象限内连接 $(0,100/7)$ 和 $(20,0)$ 的线段的交集，来确定满足 $5x+7y=100$ 且 $x\\geq 0$ 和 $y\\geq 0$ 的整数对 $(x,y)\\in\\mathbb{Z}^{2}$ 的数量。你的最终答案必须是此类非负整数解的数量。", "solution": "我们的任务是找到线性丢番图方程\n$$5x + 7y = 100$$\n的非负整数解 $(x, y)$ 的数量，其中 $x \\ge 0$ 且 $y \\ge 0$。\n\n首先，我们必须确认整数解是存在的。根据线性丢番图方程的性质，形如 $ax+by=c$ 的方程有整数解，当且仅当系数的最大公约数 $\\gcd(a,b)$ 能整除常数项 $c$。在本例中，$a=5$，$b=7$，$c=100$。最大公约数为 $\\gcd(5, 7)=1$。因为 $1$ 能整除任何整数，所以它当然能整除 $100$。因此，整数解存在。\n\n下一步是找到方程的一个特解 $(x_0, y_0)$。我们首先找到相关的 Bézout 恒等式 $5u + 7v = 1$ 的一个特解 $(u_0, v_0)$。这可以通过扩展欧几里得算法或通过观察来完成。通过观察，我们可以看到\n$$5(3) + 7(-2) = 15 - 14 = 1$$\n所以，$5u+7v=1$ 的一个特解是 $(u_0, v_0) = (3, -2)$。\n\n为了找到原方程 $5x+7y=100$ 的一个特解，我们可以将恒等式 $5(3) + 7(-2) = 1$ 两边乘以 $100$：\n$$100 \\times (5(3) + 7(-2)) = 100 \\times 1$$\n$$5(3 \\times 100) + 7(-2 \\times 100) = 100$$\n$$5(300) + 7(-200) = 100$$\n这就给出了一个特解 $(x_0, y_0) = (300, -200)$。\n\n问题陈述要求我们刻画整个整数解格。$ax+by=c$ 的通解由以下公式给出：\n$$x = x_0 + k \\frac{b}{\\gcd(a,b)}$$\n$$y = y_0 - k \\frac{a}{\\gcd(a,b)}$$\n其中 $k$ 是任意整数。\n对于我们的方程，其中 $a=5, b=7, \\gcd(5,7)=1$ 且 $(x_0, y_0) = (300, -200)$，通解为：\n$$x(k) = 300 + 7k$$\n$$y(k) = -200 - 5k$$\n对于任意整数 $k \\in \\mathbb{Z}$。这组点 $(x(k), y(k))$ 构成了该方程解的一维整格。\n\n我们必须找到满足非负约束 $x \\ge 0$ 和 $y \\ge 0$ 的解的数量。这些约束定义了问题陈述中提到的第一象限内的线段，其端点为 $(0, 100/7)$ 和 $(20, 0)$。我们将这些约束应用于我们的通解：\n\n1.  约束 $x \\ge 0$ 意味着：\n    $$300 + 7k \\ge 0$$\n    $$7k \\ge -300$$\n    $$k \\ge -\\frac{300}{7}$$\n    由于 $300/7 \\approx 42.857$，且 $k$ 必须是整数，这个不等式变为 $k \\ge -42$。\n\n2.  约束 $y \\ge 0$ 意味着：\n    $$-200 - 5k \\ge 0$$\n    $$-200 \\ge 5k$$\n    $$k \\le -40$$\n\n对整数 $k$ 合并这两个不等式，我们得到 $-42 \\le k \\le -40$。满足此条件的整数 $k$ 是 $-42, -41$ 和 $-40$。\n\n恰好有三个这样的整数 $k$ 值。每个 $k$ 值都对应一个唯一的非负整数解 $(x,y)$。因此，解的数量就是 $k$ 的可能取值的数量，即 $3$。\n\n这三个解是：\n\\begin{itemize}\n    \\item 当 $k=-42$ 时：$x = 300 + 7(-42) = 300 - 294 = 6$，$y = -200 - 5(-42) = -200 + 210 = 10$。解为：$(6,10)$。\n    \\item 当 $k=-41$ 时：$x = 300 + 7(-41) = 300 - 287 = 13$，$y = -200 - 5(-41) = -200 + 205 = 5$。解为：$(13,5)$。\n    \\item 当 $k=-40$ 时：$x = 300 + 7(-40) = 300 - 280 = 20$，$y = -200 - 5(-40) = -200 + 200 = 0$。解为：$(20,0)$。\n\\end{itemize}\n这三个整点是位于第一象限指定线段上的解格点。满足条件的 $(x,y)$ 对的数量是 $3$。", "answer": "$$\\boxed{3}$$", "id": "3009031"}, {"introduction": "为了获得更深刻的结构性理解，我们可以从线性代数的视角审视线性丢番图方程。本练习将展示贝祖等式及其系数如何从一个整数矩阵的史密斯标准型 (Smith Normal Form) 分解中自然地产生。这种强大的观点将一个数论问题重新表述为关于整数环上模的结构性论断，揭示了其背后更深层次的代数原理。[@problem_id:3009021]", "problem": "设 $A$ 是 $1\\times 2$ 的整数矩阵 $A=\\begin{pmatrix}14 & 21\\end{pmatrix}$。回顾一下，一个矩阵 $U\\in \\mathrm{GL}_{m}(\\mathbb{Z})$ 或 $V\\in \\mathrm{GL}_{n}(\\mathbb{Z})$ 如果其元素均为整数且行列式为 $\\pm 1$，则称其为幺模矩阵。一个整数矩阵 $M$ 的史密斯标准型 (Smith normal form) 是一个对角矩阵 $D$，其对角元为非负数，且存在幺模矩阵 $U$ 和 $V$ 使得 $UMV=D$。\n\n从最大公约数、裴蜀恒等式和幺模整数矩阵的概念出发，确定 $A$ 的史密斯标准型，并构造幺模矩阵 $U\\in \\mathrm{GL}_{1}(\\mathbb{Z})$ 和 $V\\in \\mathrm{GL}_{2}(\\mathbb{Z})$ 使得 $UAV$ 是一个对角矩阵。从您的构造中，提取满足 $14x+21y=\\gcd(14,21)$ 的裴蜀系数 $(x,y)\\in \\mathbb{Z}^{2}$，并选择其中 $y$ 是最小非负数的数对。\n\n请将您的最终答案以行矩阵 $\\begin{pmatrix}d & x & y\\end{pmatrix}$ 的形式给出，其中 $d$ 是 $A$ 的史密斯标准型的严格正对角元，而 $(x,y)$ 是指定的裴蜀系数对。无需四舍五入。", "solution": "该问题要求计算整数矩阵 $A=\\begin{pmatrix}14 & 21\\end{pmatrix}$ 的史密斯标准型 (SNF)，构造相关的幺模矩阵，并确定一对特定的裴蜀系数。\n\n设给定矩阵为 $A = \\begin{pmatrix}14 & 21\\end{pmatrix}$。这是一个 $1 \\times 2$ 的整数矩阵。其史密斯标准型 $D$ 也将是一个 $1 \\times 2$ 的矩阵，形式为 $D = \\begin{pmatrix}d_1 & 0\\end{pmatrix}$，其中 $d_1$ 是一个非负整数。一个矩阵的史密斯标准型的对角元是其初等因子。对于一个 $1 \\times n$ 的矩阵 $M = \\begin{pmatrix}a_1 & a_2 & \\dots & a_n\\end{pmatrix}$，其唯一的非零初等因子是其所有元素的最大公约数 (GCD)。\n因此，对于矩阵 $A$，其严格正对角元 $d$ 由 $d = \\gcd(14, 21)$ 给出。\n我们使用欧几里得算法来计算最大公约数：\n$$21 = 1 \\cdot 14 + 7$$\n$$14 = 2 \\cdot 7 + 0$$\n最后一个非零余数即为最大公约数，所以 $d = \\gcd(14, 21) = 7$。\n$A$ 的史密斯标准型是 $D = \\begin{pmatrix}7 & 0\\end{pmatrix}$。\n\n接下来，我们必须找到幺模矩阵 $U \\in \\mathrm{GL}_{1}(\\mathbb{Z})$ 和 $V \\in \\mathrm{GL}_{2}(\\mathbb{Z})$ 使得 $UAV = D$。\n$U$ 是一个 $1 \\times 1$ 的矩阵，其元素为整数且行列式为 $\\pm 1$。设 $U=\\begin{pmatrix}u\\end{pmatrix}$。那么 $\\det(U) = u = \\pm 1$。我们可以选择 $u=1$，因此 $U = \\begin{pmatrix}1\\end{pmatrix}$，这是一个幺模矩阵。\n$V$ 是一个 $2 \\times 2$ 的矩阵，其元素为整数且行列式为 $\\pm 1$。设 $V = \\begin{pmatrix}v_{11} & v_{12} \\\\ v_{21} & v_{22}\\end{pmatrix}$。条件 $UAV=D$ 变为：\n$$\\begin{pmatrix}1\\end{pmatrix} \\begin{pmatrix}14 & 21\\end{pmatrix} \\begin{pmatrix}v_{11} & v_{12} \\\\ v_{21} & v_{22}\\end{pmatrix} = \\begin{pmatrix}7 & 0\\end{pmatrix}$$\n$$\\begin{pmatrix}14v_{11} + 21v_{21} & 14v_{12} + 21v_{22}\\end{pmatrix} = \\begin{pmatrix}7 & 0\\end{pmatrix}$$\n这就得出了一个由两个线性丢番图方程组成的方程组：\n$1.$ $14v_{11} + 21v_{21} = 7$\n$2.$ $14v_{12} + 21v_{22} = 0$\n\n问题要求我们提取满足 $14x+21y=\\gcd(14,21)$ 的裴蜀系数 $(x,y)$。这正是方程 $(1)$，其中 $x=v_{11}$ 且 $y=v_{21}$。矩阵 $V$ 的第一列提供了一对裴蜀系数。\n我们来求解 $14x+21y=7$ 的通解。\n首先，我们求一个特解 $(x_0, y_0)$。根据欧几里得算法，我们可以使用回代法：\n$$7 = 21 - 1 \\cdot 14 = 14(-1) + 21(1)$$\n所以，一个特解是 $(x_0, y_0) = (-1, 1)$。\n线性丢番图方程 $ax+by=c$ 的通解由 $x = x_0 + (b/d)k$ 和 $y = y_0 - (a/d)k$ 给出，其中 $d=\\gcd(a,b)$ 且 $k$ 是任意整数。\n此处，$a=14$，$b=21$，且 $d=\\gcd(14,21)=7$。通解是：\n$$x = -1 + \\frac{21}{7}k = -1 + 3k$$\n$$y = 1 - \\frac{14}{7}k = 1 - 2k$$\n其中 $k \\in \\mathbb{Z}$。\n\n问题指定我们必须选择 $y$ 为最小非负数的那一对 $(x,y)$。\n条件 $y \\geq 0$ 意味着 $1 - 2k \\geq 0$，化简后得 $1 \\geq 2k$，即 $k \\leq 1/2$。\n为了找到 $y = 1 - 2k$ 的最小值，我们必须选择满足 $k \\leq 1/2$ 的最大可能整数 $k$。这个值是 $k=0$。\n对于 $k=0$，我们得到特定的数对 $(x,y)$：\n$$x = -1 + 3(0) = -1$$\n$$y = 1 - 2(0) = 1$$\n这对 $(x,y) = (-1,1)$ 产生了 $y$ 的最小非负值，即 $y=1$。\n\n我们可以完成矩阵 $V$ 的构造来验证这个过程，尽管最终答案并不需要它。我们设 $v_{11}=x=-1$ 和 $v_{21}=y=1$。对于第二列，我们必须求解 $14v_{12} + 21v_{22} = 0$。两边除以 $7$ 得到 $2v_{12} + 3v_{22} = 0$。通解为 $v_{12}=3j$ 和 $v_{22}=-2j$，其中 $j$ 是某个整数。\n所以，$V = \\begin{pmatrix}-1 & 3j \\\\ 1 & -2j\\end{pmatrix}$。\n要使 $V$ 是幺模矩阵，其行列式必须为 $\\pm 1$：\n$$\\det(V) = (-1)(-2j) - (3j)(1) = 2j - 3j = -j$$\n我们需要 $-j = \\pm 1$，所以 $j = \\pm 1$。选择 $j=-1$，我们得到 $V = \\begin{pmatrix}-1 & -3 \\\\ 1 & 2\\end{pmatrix}$，其行列式 $\\det(V)=1$。这个矩阵是幺模矩阵且满足 $AV = D$。\n\n所需的值是：\n史密斯标准型的严格正对角元：$d=7$。\n指定的裴蜀系数：$x=-1$ 和 $y=1$。\n\n最终答案需要以行矩阵 $\\begin{pmatrix}d & x & y\\end{pmatrix}$ 的形式给出。\n代入这些值，我们得到 $\\begin{pmatrix}7 & -1 & 1\\end{pmatrix}$。", "answer": "$$\\boxed{\\begin{pmatrix}7 & -1 & 1\\end{pmatrix}}$$", "id": "3009021"}]}