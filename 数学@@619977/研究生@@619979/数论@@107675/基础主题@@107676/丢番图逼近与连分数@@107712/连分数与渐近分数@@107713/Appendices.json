{"hands_on_practices": [{"introduction": "掌握连分数理论的第一步是熟练计算其渐近分数。本练习提供了一个基础但至关重要的实践，要求您运用递推关系式来计算二次无理数 $\\sqrt{3}$ 的连分数的最初几个渐近分数。通过这个计算过程，您将熟悉渐近分数是如何一步步生成的，并为后续更深入的应用打下坚实的计算基础 [@problem_id:405370]。", "problem": "$\\sqrt{3}$ 的连分数展开式为 $[1; \\overline{1, 2}]$，其部分商序列从 $a_1 = 1$ 开始，每两项重复一次。该连分数的渐近分数是 $\\sqrt{3}$ 的有理逼近，由递推生成。设 $p_n$ 和 $q_n$ 分别表示第 $n$ 个渐近分数的分子和分母，其中索引从 $n=0$ 开始。递推关系为：\n$$ p_n = a_n p_{n-1} + p_{n-2}, \\quad q_n = a_n q_{n-1} + q_{n-2}, $$\n初始条件为 $p_{-2} = 0$, $p_{-1} = 1$, $q_{-2} = 1$, $q_{-1} = 0$。\n\n第一个渐近分数（$n=0$）是 $p_0/q_0 = a_0/1$，第二个（$n=1$）是 $p_1/q_1$，第三个（$n=2$）是 $p_2/q_2$。计算在实数轴上，第二个和第三个渐近分数之间基于通常度量（绝对差）的距离。", "solution": "$\\sqrt{3}$ 的部分商为 $a_0 = 1$，$a_1 = 1$，$a_2 = 2$，然后以 2 为周期重复：$a_3 = 1$，$a_4 = 2$，以此类推。\n\n**步骤 1：使用递推关系计算渐近分数。**\n- 对于 $n = 0$：\n  $p_0 = a_0 p_{-1} + p_{-2} = 1 \\cdot 1 + 0 = 1$,\n  $q_0 = a_0 q_{-1} + q_{-2} = 1 \\cdot 0 + 1 = 1$。\n  因此，第 0 个渐近分数为 $\\frac{p_0}{q_0} = \\frac{1}{1}$。\n\n- 对于 $n = 1$：\n  $p_1 = a_1 p_0 + p_{-1} = 1 \\cdot 1 + 1 = 2$,\n  $q_1 = a_1 q_0 + q_{-1} = 1 \\cdot 1 + 0 = 1$。\n  因此，第 1 个渐近分数（第二个渐近分数）为 $\\frac{p_1}{q_1} = \\frac{2}{1}$。\n\n- 对于 $n = 2$：\n  $p_2 = a_2 p_1 + p_0 = 2 \\cdot 2 + 1 = 5$,\n  $q_2 = a_2 q_1 + q_0 = 2 \\cdot 1 + 1 = 3$。\n  因此，第 2 个渐近分数（第三个渐近分数）为 $\\frac{p_2}{q_2} = \\frac{5}{3}$。\n\n**步骤 2：计算第二个和第三个渐近分数之间的绝对差。**\n距离由下式给出：\n$$\n\\left| \\frac{2}{1} - \\frac{5}{3} \\right| = \\left| \\frac{6}{3} - \\frac{5}{3} \\right| = \\left| \\frac{1}{3} \\right| = \\frac{1}{3}\n$$", "answer": "$$ \\boxed{\\dfrac{1}{3}} $$", "id": "405370"}, {"introduction": "连分数最经典的应用之一是高效地求解线性丢番图方程 $ax+by=\\gcd(a,b)$。本练习将引导您运用连分数理论，特别是利用倒数第二个渐近分数的性质，来找到方程 $ax+by=1$ 的一个整数解。通过将此方法与传统的扩展欧几里得算法进行比较，您将深刻理解这两个看似不同的算法之间内在的深刻联系 [@problem_id:3009045]。", "problem": "设 $a$ 和 $b$ 是互质的正整数，且 $a/b$ 的简单连分数展开式具有一致较小的部分商。考虑整数 $a=577$ 和 $b=408$，它们互质，并且是 $\\sqrt{2}$ 的连续渐近分数，因此它们的比值 $a/b$ 具有小的部分商。仅使用欧几里得算法、贝祖恒等式和简单连分数理论的基本原理，完成以下任务：\n\n1. 从最大公约数（GCD）的定义、贝祖恒等式以及 $a/b$ 的简单连分数的构造性定义出发，推导一种方法，用于生成方程 $ax + by = 1$ 的一个解 $(x,y) \\in \\mathbb{Z}^2$，当部分商保持较小时，该解的系数大小是渐近最小的。你的推导必须引用渐近分数的最佳逼近性质，但不得预设任何捷径公式。\n\n2. 将你的方法应用于 $a=577$ 和 $b=408$，明确计算出 $a/b$ 的连分数及其渐近分数，并展示方程 $ax + by = 1$ 的一个具体解 $(x,y)$，该解在所有整数解中具有最小的 $\\ell^{\\infty}$-范数，即最小化 $\\max\\{|x|, |y|\\}$。\n\n3. 通过直接的扩展欧几里得算法独立地计算 $a$ 和 $b$ 的贝祖系数，并解释为什么该算法的输出与从渐近分数得到的解一致，以及为什么它对于 $\\ell^{\\infty}$-范数确实是最小的。最后给出实现此最小值的唯一数对 $(x,y)$。\n\n你的最终答案必须是写成行矩阵形式的有序对 $(x,y)$。无需进行四舍五入。", "solution": "该问题要求一个涉及整数 $a=577$ 和 $b=408$ 的多部分解答。我们需要推导一种使用连分数求解丢番图方程 $ax + by = 1$ 的方法，应用该方法，然后将结果与扩展欧几里得算法进行比较，最终找到使 $\\ell^{\\infty}$-范数（定义为 $\\max\\{|x|, |y|\\}$）最小化的整数解 $(x,y)$。\n\n首先，我们验证给定信息。整数 $a=577$ 和 $b=408$ 被叙述为互质。我们可以通过欧几里得算法计算它们的最大公约数（GCD）来证实这一点：\n$577 = 1 \\cdot 408 + 169$\n$408 = 2 \\cdot 169 + 70$\n$169 = 2 \\cdot 70 + 29$\n$70 = 2 \\cdot 29 + 12$\n$29 = 2 \\cdot 12 + 5$\n$12 = 2 \\cdot 5 + 2$\n$5 = 2 \\cdot 2 + 1$\n$2 = 2 \\cdot 1 + 0$\n最后的非零余数是 $1$，所以 $\\gcd(577, 408) = 1$。这两个整数确实互质，根据贝祖恒等式，方程 $577x + 408y = 1$ 保证有整数解。\n\n### 第1部分：从基本原理推导方法\n\n设 $a$ 和 $b$ 是互质的正整数。我们寻求线性丢番图方程 $a x + b y = 1$ 的一个解 $(x,y) \\in \\mathbb{Z}^2$。该方法将从简单连分数的性质中推导出来。\n\n设有理数 $a/b$ 的简单连分数展开式为 $[a_0; a_1, a_2, \\dots, a_n]$。数 $a_k$ 被称为部分商。它们由应用于 $(a,b)$ 的欧几里得算法生成，其中 $a_0 = \\lfloor a/b \\rfloor$，后续的 $a_k$ 是商。\n\n该连分数的渐近分数，记为 $p_k/q_k$，是一些有理数，它们为 $a/b$ 提供了越来越好的近似。它们由以下递推关系定义：\n$p_k = a_k p_{k-1} + p_{k-2}$\n$q_k = a_k q_{k-1} + q_{k-2}$\n初始值为 $p_{-2}=0, p_{-1}=1$ 和 $q_{-2}=1, q_{-1}=0$。\n对于 $k \\ge 0$，这会得到 $p_0=a_0, q_0=1$，$p_1=a_1 a_0+1, q_1=a_1$，依此类推。\n\n一个连接任意两个连续渐近分数的基本恒等式是连分数的 Cassini 恒等式：\n$$p_k q_{k-1} - p_{k-1} q_k = (-1)^{k-1}$$\n这可以通过对 $k$ 进行数学归纳法来证明。\n对于 $k=0$：使用一个常见的约定，$p_{-1}=1, q_{-1}=0, p_{-2}=0, q_{-2}=1$，我们有 $p_0q_{-1} - p_{-1}q_0 = a_0(0) - 1(1) = -1 = (-1)^{0-1}$。这是一种变体。从 $k=1$ 开始的标准形式更容易证明。让我们使用矩阵形式：\n$$\n\\begin{pmatrix} p_k \\\\ q_k \\end{pmatrix} = \\begin{pmatrix} a_k & 1 \\\\ 1 & 0 \\end{pmatrix} \\begin{pmatrix} p_{k-1} \\\\ p_{k-2} \\end{pmatrix}\n$$\n这导致：\n$$\n\\begin{pmatrix} p_k & p_{k-1} \\\\ q_k & q_{k-1} \\end{pmatrix} = \\begin{pmatrix} p_{k-1} & p_{k-2} \\\\ q_{k-1} & q_{k-2} \\end{pmatrix} \\begin{pmatrix} a_k & 1 \\\\ 1 & 0 \\end{pmatrix}\n$$\n取行列式，我们得到 $p_k q_{k-1} - p_{k-1} q_k = -(p_{k-1}q_{k-2} - p_{k-2}q_{k-1})$。\n基础情形为 $p_1q_0 - p_0q_1 = (a_1a_0+1)(1) - a_0(a_1) = 1 = (-1)^{1-1}$，一般恒等式变为 $p_k q_{k-1} - p_{k-1} q_k = (-1)^{k-1}$（对于 $k \\ge 1$）。\n\n最后一个渐近分数 $p_n/q_n$ 等于 $a/b$。由于 $a$ 和 $b$ 互质，并且根据构造，$p_n$ 和 $q_n$ 也互质（作为上述恒等式的一个推论），我们必须有 $a = p_n$ 和 $b = q_n$。\n\n我们对最后两个渐近分数应用恒等式，即 $k=n$：\n$a q_{n-1} - p_{n-1} b = (-1)^{n-1}$\n这个方程几乎是 $ax+by=1$ 的形式。我们可以将其写为：\n$a(q_{n-1}) + b(-p_{n-1}) = (-1)^{n-1}$\n为了得到 $ax+by=1$ 的一个解，我们将整个方程乘以 $(-1)^{n-1}$：\n$a\\left( (-1)^{n-1} q_{n-1} \\right) + b\\left( -(-1)^{n-1} p_{n-1} \\right) = 1$\n因此，$ax+by=1$ 的一个特解 $(x_0, y_0)$ 是：\n$$x_0 = (-1)^{n-1} q_{n-1} \\quad \\text{和} \\quad y_0 = (-1)^n p_{n-1}$$\n\n渐近分数的最佳逼近性质指出，对于给定的分母大小，渐近分数 $p_k/q_k$ 是对一个数的最佳有理数逼近。这一性质与系数 $x_0, y_0$ 的小性有着内在的联系。我们有 $|x_0| = q_{n-1}$ 和 $|y_0| = p_{n-1}$。由于序列 $(q_k)$ 和 $(p_k)$ 对 $k\\ge 1$ 是严格递增的，我们有 $q_{n-1} < q_n = b$ 和 $p_{n-1} < p_n = a$。因此，该方法提供了一个解 $(x_0, y_0)$，其中 $|x_0| < b$ 和 $|y_0| < a$。这个特定的解是已知的两个具有最小 $\\ell^{\\infty}$-范数的解的候选者之一。另一个候选者是 $(x_0 \\mp b, y_0 \\pm a)$。\n\n### 第2部分：应用于 $a=577, b=408$\n\n我们求 $a/b = 577/408$ 的连分数。欧几里得算法步骤中的商是 $1, 2, 2, 2, 2, 2, 2, 2$。\n所以，$577/408 = [1; 2, 2, 2, 2, 2, 2, 2]$。连分数的长度是 $n=7$（最后一个部分商的索引）。\n\n接下来，我们使用递推关系计算渐近分数 $p_k/q_k$：\n$k=-2$: $p_{-2}=0, q_{-2}=1$\n$k=-1$: $p_{-1}=1, q_{-1}=0$\n$k=0$: $a_0=1 \\implies p_0=1, q_0=1$\n$k=1$: $a_1=2 \\implies p_1=2(1)+1=3, q_1=2(1)+0=2$\n$k=2$: $a_2=2 \\implies p_2=2(3)+1=7, q_2=2(2)+1=5$\n$k=3$: $a_3=2 \\implies p_3=2(7)+3=17, q_3=2(5)+2=12$\n$k=4$: $a_4=2 \\implies p_4=2(17)+7=41, q_4=2(12)+5=29$\n$k=5$: $a_5=2 \\implies p_5=2(41)+17=99, q_5=2(29)+12=70$\n$k=6$: $a_6=2 \\implies p_6=2(99)+41=239, q_6=2(70)+29=169$\n$k=7$: $a_7=2 \\implies p_7=2(239)+99=577, q_7=2(169)+70=408$\n\n最后一个渐近分数是 $p_7/q_7 = 577/408 = a/b$。倒数第二个渐近分数是 $p_6/q_6 = 239/169$。\n我们有 $n=7$，$p_6=239$，和 $q_6=169$。\n使用第1部分推导出的公式，$577x + 408y = 1$ 的一个解 $(x_0, y_0)$ 是：\n$x_0 = (-1)^{7-1} q_6 = (-1)^6 \\cdot 169 = 169$\n$y_0 = (-1)^7 p_6 = (-1)^7 \\cdot 239 = -239$\n所以，一个解是 $(x_0, y_0) = (169, -239)$。\n我们来验证一下：$577(169) + 408(-239) = 97513 - 97512 = 1$。该解是正确的。\n\n为了找到具有最小 $\\ell^{\\infty}$-范数的解，我们必须将此解与其他可能的解进行比较。通解是 $(x_k, y_k) = (x_0 + k b, y_0 - k a) = (169 + k \\cdot 408, -239 - k \\cdot 577)$，其中 $k \\in \\mathbb{Z}$。\n对于 $k=0$：$(169, -239)$。$\\max\\{|169|, |-239|\\} = 239$。\n对于 $k=-1$：$(169 - 408, -239 + 577) = (-239, 338)$。$\\max\\{|-239|, |338|\\} = 338$。\n对于 $k=1$：$(169 + 408, -239 - 577) = (577, -816)$。$\\max\\{|577|, |-816|\\} = 816$。\n其他 $k$ 的整数值将产生具有更大范数的解。比较 $k=0$ 和 $k=-1$ 时的范数，我们发现 $239 < 338$。\n因此，解 $(169, -239)$ 具有最小的 $\\ell^{\\infty}$-范数。\n\n### 第3部分：与扩展欧几里得算法的比较\n\n扩展欧几里得算法 (EEA) 提供了一种系统化的方法来寻找贝祖系数。我们将其应用于 $a=577$ 和 $b=408$。设 $r_{-2}=a, r_{-1}=b$。我们计算序列 $r_k, q_k, x_k, y_k$，使得在每一步都有 $a x_k + b y_k = r_k$。\n递推关系为 $q_k = \\lfloor r_{k-2}/r_{k-1} \\rfloor$, $r_k = r_{k-2} - q_k r_{k-1}$, $x_k = x_{k-2} - q_k x_{k-1}$, 以及 $y_k = y_{k-2} - q_k y_{k-1}$。\n初始化：\n$k=-2: r_{-2}=577, x_{-2}=1, y_{-2}=0$\n$k=-1: r_{-1}=408, x_{-1}=0, y_{-1}=1$\n\n算法过程如下：\n$k=0: q_0=\\lfloor 577/408 \\rfloor=1 \\implies r_0=169, x_0=1-1(0)=1, y_0=0-1(1)=-1$\n$k=1: q_1=\\lfloor 408/169 \\rfloor=2 \\implies r_1=70,  x_1=0-2(1)=-2, y_1=1-2(-1)=3$\n$k=2: q_2=\\lfloor 169/70 \\rfloor=2  \\implies r_2=29,  x_2=1-2(-2)=5, y_2=-1-2(3)=-7$\n$k=3: q_3=\\lfloor 70/29 \\rfloor=2   \\implies r_3=12,  x_3=-2-2(5)=-12, y_3=3-2(-7)=17$\n$k=4: q_4=\\lfloor 29/12 \\rfloor=2   \\implies r_4=5,   x_4=5-2(-12)=29, y_4=-7-2(17)=-41$\n$k=5: q_5=\\lfloor 12/5 \\rfloor=2    \\implies r_5=2,   x_5=-12-2(29)=-70, y_5=17-2(-41)=99$\n$k=6: q_6=\\lfloor 5/2 \\rfloor=2     \\implies r_6=1,   x_6=29-2(-70)=169, y_6=-41-2(99)=-239$\n\n当余数 $r_k=1$ 时，算法终止。这发生在步骤 $k=6$。对应的系数是 $(x_6, y_6) = (169, -239)$。这给出了恒等式 $577(169) + 408(-239) = 1$。\n\n这个输出与从连分数方法推导出的解完全相同。这种巧合的原因是，EEA 和连分数算法本质上是同一个过程。EEA 生成的商 $q_k$ 正是 $a/b$ 的连分数的部分商 $a_k$。可以证明，EEA 生成的系数 $x_k, y_k$ 与渐近分数 $p_k, q_k$ 相关。事实上，对于我们的问题，最终解 $(x_6, y_6)$ 精确对应于 $(q_6, -p_6)$。\n\n这个解 $(169, -239)$ 由一个与 EEA 相关的数论定理保证是满足 $|x| \\leq b/2$ 和 $|y| \\leq a/2$ 的唯一解 $(x,y)$，前提是这样的解存在。我们来检验一下：\n$|x| = 169$，而 $b/2 = 408/2 = 204$。我们有 $169 \\le 204$。\n$|y| = 239$，而 $a/2 = 577/2 = 288.5$。我们有 $239 \\le 288.5$。\n由于两个条件都满足，任何其他解 $(x_k, y_k) = (x+kb, y-ka)$（对于 $k \\ne 0$）将至少有一个分量具有更大的绝对值。例如，如果 $k=-1$，则 $x_{-1} = 169-408=-239$ 且 $y_{-1}=-239+577=338$。那么 $\\max\\{|-239|,|338|\\} = 338$，这比 $\\max\\{|169|,|-239|\\}=239$ 要大。\n因此，解 $(169, -239)$ 确实是实现最小 $\\ell^{\\infty}$-范数的唯一数对。\n\n求解 $577x + 408y=1$ 并最小化 $\\max\\{|x|,|y|\\}$ 的唯一数对 $(x,y)$ 是 $(169, -239)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n169 & -239\n\\end{pmatrix}\n}\n$$", "id": "3009045"}, {"introduction": "除了线性方程，连分数在解决二次丢番图方程方面也显示出其强大的威力，最著名的例子就是佩尔方程 $x^2 - Dy^2 = 1$。本练习将带您探索如何通过计算二次无理数 $\\sqrt{19}$ 的连分数展开来找到佩尔方程 $p^2 - 19q^2 = \\pm 1$ 的解。这个过程不仅展示了连分数周期性与佩尔方程解之间的直接关联，还涉及了对渐近分数的误差界进行分析，这是理解连分数作为“最佳有理逼近”核心性质的关键一步 [@problem_id:3020883]。", "problem": "设 $\\alpha=\\sqrt{19}$，其单连分数写作 $\\alpha=[a_{0};a_{1},a_{2},\\dots]$，其渐近分数 $p_{n}/q_{n}$ 由部分商通过标准递推关系定义。仅从单连分数和渐近分数的定义出发，以及二次无理数的单连分数最终是周期的这一事实，完成以下任务：\n\n1. 计算 $\\sqrt{19}$ 的单连分数，直至一个完整周期，并由此计算当 $n=0,1,2,3,4,5$ 时的渐近分数 $p_{n}/q_{n}$。\n2. 推导 $|\\alpha - p_{n}/q_{n}|$ 的双边显式误差界，该误差界仅依赖于 $a_{n+1}$ 和 $q_{n}$，然后对 $n=0,1,2,3,4,5$ 的情况，数值计算这些界的范围。\n3. 使用以上结果和第一性原理，确定满足 $|p_{n}^{2}-19q_{n}^{2}|=1$ 的最小索引 $n_{0} \\in \\mathbb{N}$。\n\n在你的最终答案中，只报告索引 $n_{0}$ 的整数值，无需推导过程。无需四舍五入。", "solution": "按题干要求，本问题的分析分为三个部分。\n\n### 第 1 部分：$\\sqrt{19}$ 的连分数和渐近分数\n设 $\\alpha = \\sqrt{19}$。我们使用标准算法计算其单连分数，其中 $\\alpha_0 = \\alpha$，$a_n = \\lfloor \\alpha_n \\rfloor$，且 $\\alpha_{n+1} = 1/(\\alpha_n - a_n)$。\n\n$a_0 = \\lfloor\\sqrt{19}\\rfloor = 4$。\n$\\alpha_1 = \\frac{1}{\\sqrt{19}-4} = \\frac{\\sqrt{19}+4}{19-16} = \\frac{\\sqrt{19}+4}{3}$。\n$a_1 = \\lfloor\\frac{\\sqrt{19}+4}{3}\\rfloor = \\lfloor\\frac{4.358\\dots+4}{3}\\rfloor = \\lfloor 2.786\\dots \\rfloor = 2$。\n\n$\\alpha_2 = \\frac{1}{\\frac{\\sqrt{19}+4}{3}-2} = \\frac{3}{\\sqrt{19}-2} = \\frac{3(\\sqrt{19}+2)}{19-4} = \\frac{\\sqrt{19}+2}{5}$。\n$a_2 = \\lfloor\\frac{\\sqrt{19}+2}{5}\\rfloor = \\lfloor\\frac{4.358\\dots+2}{5}\\rfloor = \\lfloor 1.271\\dots \\rfloor = 1$。\n\n$\\alpha_3 = \\frac{1}{\\frac{\\sqrt{19}+2}{5}-1} = \\frac{5}{\\sqrt{19}-3} = \\frac{5(\\sqrt{19}+3)}{19-9} = \\frac{\\sqrt{19}+3}{2}$。\n$a_3 = \\lfloor\\frac{\\sqrt{19}+3}{2}\\rfloor = \\lfloor\\frac{4.358\\dots+3}{2}\\rfloor = \\lfloor 3.679\\dots \\rfloor = 3$。\n\n$\\alpha_4 = \\frac{1}{\\frac{\\sqrt{19}+3}{2}-3} = \\frac{2}{\\sqrt{19}-3} = \\frac{2(\\sqrt{19}+3)}{19-9} = \\frac{\\sqrt{19}+3}{5}$。\n$a_4 = \\lfloor\\frac{\\sqrt{19}+3}{5}\\rfloor = \\lfloor\\frac{4.358\\dots+3}{5}\\rfloor = \\lfloor 1.471\\dots \\rfloor = 1$。\n\n$\\alpha_5 = \\frac{1}{\\frac{\\sqrt{19}+3}{5}-1} = \\frac{5}{\\sqrt{19}-2} = \\frac{5(\\sqrt{19}+2)}{19-4} = \\frac{\\sqrt{19}+2}{3}$。\n$a_5 = \\lfloor\\frac{\\sqrt{19}+2}{3}\\rfloor = \\lfloor\\frac{4.358\\dots+2}{3}\\rfloor = \\lfloor 2.119\\dots \\rfloor = 2$。\n\n$\\alpha_6 = \\frac{1}{\\frac{\\sqrt{19}+2}{3}-2} = \\frac{3}{\\sqrt{19}-4} = \\frac{3(\\sqrt{19}+4)}{19-16} = \\sqrt{19}+4$。\n$a_6 = \\lfloor\\sqrt{19}+4\\rfloor = \\lfloor 4.358\\dots+4 \\rfloor = 8$。\n\n$\\alpha_7 = \\frac{1}{(\\sqrt{19}+4)-8} = \\frac{1}{\\sqrt{19}-4} = \\alpha_1$。\n部分商序列从 $a_1$ 开始是周期的。单连分数为 $\\sqrt{19} = [4; \\overline{2, 1, 3, 1, 2, 8}]$。周期长度为 $6$。\n\n渐近分数 $p_n/q_n$ 使用递推关系计算：\n$p_n = a_n p_{n-1} + p_{n-2}$ 和 $q_n = a_n q_{n-1} + q_{n-2}$，初始值为 $p_{-2}=0, p_{-1}=1$ 和 $q_{-2}=1, q_{-1}=0$。\n当 $n=0$ 时：$a_0=4$。$p_0=4(1)+0=4$，$q_0=4(0)+1=1$。渐近分数：$4/1$。\n当 $n=1$ 时：$a_1=2$。$p_1=2(4)+1=9$，$q_1=2(1)+0=2$。渐近分数：$9/2$。\n当 $n=2$ 时：$a_2=1$。$p_2=1(9)+4=13$，$q_2=1(2)+1=3$。渐近分数：$13/3$。\n当 $n=3$ 时：$a_3=3$。$p_3=3(13)+9=48$，$q_3=3(3)+2=11$。渐近分数：$48/11$。\n当 $n=4$ 时：$a_4=1$。$p_4=1(48)+13=61$，$q_4=1(11)+3=14$。渐近分数：$61/14$。\n当 $n=5$ 时：$a_5=2$。$p_5=2(61)+48=170$，$q_5=2(14)+11=39$。渐近分数：$170/39$。\n\n### 第 2 部分：误差界\n设 $\\alpha = [a_0; a_1, \\dots, a_n, \\alpha_{n+1}]$，其中 $\\alpha_{n+1}$ 是第 $(n+1)$ 个完全商。$\\alpha$ 和其渐近分数之间的关系是 $\\alpha = \\frac{\\alpha_{n+1} p_n + p_{n-1}}{\\alpha_{n+1} q_n + q_{n-1}}$。\n误差由下式给出：\n$$ \\alpha - \\frac{p_n}{q_n} = \\frac{\\alpha_{n+1} p_n + p_{n-1}}{\\alpha_{n+1} q_n + q_{n-1}} - \\frac{p_n}{q_n} = \\frac{p_{n-1}q_n - p_n q_{n-1}}{q_n(\\alpha_{n+1} q_n + q_{n-1})} = \\frac{(-1)^n}{q_n(\\alpha_{n+1} q_n + q_{n-1})} $$\n取绝对值，我们得到精确误差：\n$$ \\left|\\alpha - \\frac{p_n}{q_n}\\right| = \\frac{1}{q_n(\\alpha_{n+1} q_n + q_{n-1})} = \\frac{1}{q_n^2(\\alpha_{n+1} + q_{n-1}/q_n)} $$\n为找到仅依赖于 $a_{n+1}$ 和 $q_n$ 的界，我们需要对 $\\alpha_{n+1} + q_{n-1}/q_n$ 这一项进行定界。\n根据定义，$a_{n+1} = \\lfloor \\alpha_{n+1} \\rfloor$，由于 $\\alpha_{n+1}$ 是无理数，所以 $a_{n+1} < \\alpha_{n+1} < a_{n+1}+1$。\n分母序列 $q_n$ 对于 $n \\ge 1$ 是严格递增的，且 $q_0=1, q_{-1}=0$。因此，对于 $n \\ge 0$，我们有 $0 \\le q_{n-1} < q_n$，这意味着 $0 \\le q_{n-1}/q_n < 1$。\n\n为了得到误差的上限，我们需要找到分母的下限：\n$\\alpha_{n+1} + q_{n-1}/q_n > a_{n+1} + 0 = a_{n+1}$。\n这给出 $\\left|\\alpha - \\frac{p_n}{q_n}\\right| < \\frac{1}{q_n^2 a_{n+1}}$。\n\n为了得到误差的下限，我们需要找到分母的上限：\n$\\alpha_{n+1} + q_{n-1}/q_n < (a_{n+1}+1) + 1 = a_{n+1}+2$。\n这给出 $\\left|\\alpha - \\frac{p_n}{q_n}\\right| > \\frac{1}{q_n^2 (a_{n+1}+2)}$。\n\n综合以上两点，我们得到双边界：\n$$ \\frac{1}{(a_{n+1}+2)q_n^2} < \\left|\\alpha - \\frac{p_n}{q_n}\\right| < \\frac{1}{a_{n+1}q_n^2} $$\n现在我们使用第 1 部分得到的 $a_n$ 和 $q_n$ 的值，对 $n=0, \\dots, 5$ 的情况数值计算这些界。注意 $\\alpha=\\sqrt{19}\\approx4.3588989$。\n$n=0$：$a_1=2, q_0=1$。$\\frac{1}{(2+2)1^2} < |\\sqrt{19}-4| < \\frac{1}{2 \\cdot 1^2} \\implies 0.25 < 0.3589 < 0.5$。\n$n=1$：$a_2=1, q_1=2$。$\\frac{1}{(1+2)2^2} < |\\sqrt{19}-9/2| < \\frac{1}{1 \\cdot 2^2} \\implies 1/12 < 0.1411 < 1/4 \\implies 0.0833 < 0.1411 < 0.25$。\n$n=2$：$a_3=3, q_2=3$。$\\frac{1}{(3+2)3^2} < |\\sqrt{19}-13/3| < \\frac{1}{3 \\cdot 3^2} \\implies 1/45 < 0.0256 < 1/27 \\implies 0.0222 < 0.0256 < 0.0370$。\n$n=3$：$a_4=1, q_3=11$。$\\frac{1}{(1+2)11^2} < |\\sqrt{19}-48/11| < \\frac{1}{1 \\cdot 11^2} \\implies 1/363 < 0.0047 < 1/121 \\implies 0.0027 < 0.0047 < 0.0083$。\n$n=4$：$a_5=2, q_4=14$。$\\frac{1}{(2+2)14^2} < |\\sqrt{19}-61/14| < \\frac{1}{2 \\cdot 14^2} \\implies 1/784 < 0.0018 < 1/392 \\implies 0.0012 < 0.0018 < 0.0026$。\n$n=5$：$a_6=8, q_5=39$。$\\frac{1}{(8+2)39^2} < |\\sqrt{19}-170/39| < \\frac{1}{8 \\cdot 39^2} \\implies 1/15210 < 0.000073 < 1/12168 \\implies 0.000066 < 0.000073 < 0.000082$。\n\n### 第 3 部分：确定索引 $n_0$\n我们要寻找满足 $|p_{n_0}^2 - 19 q_{n_0}^2|=1$ 的最小索引 $n_0 \\in \\mathbb{N}$。这是一个佩尔型方程。我们可以使用第一性原理将此表达式与连分数展开联系起来。\n该式可以因式分解为 $|(p_n - \\sqrt{19}q_n)(p_n + \\sqrt{19}q_n)| = 1$。\n根据第 2 部分推导的误差表达式，我们有：\n$$ \\sqrt{19}q_n - p_n = \\frac{(-1)^n}{\\alpha_{n+1}q_n + q_{n-1}} $$\n或者等价地，\n$$ p_n - \\sqrt{19}q_n = -\\frac{(-1)^n}{\\alpha_{n+1}q_n + q_{n-1}} $$\n将此代入因式分解后的方程中：\n$$ \\left|-\\frac{(-1)^n}{\\alpha_{n+1}q_n + q_{n-1}}\\right| \\cdot |p_n + \\sqrt{19}q_n| = 1 $$\n$$ \\frac{p_n + \\sqrt{19}q_n}{\\alpha_{n+1}q_n + q_{n-1}} = 1 $$\n由于所有项都是正的，我们可以去掉绝对值符号。这导出了条件：\n$$ p_n + \\sqrt{19}q_n = \\alpha_{n+1}q_n + q_{n-1} $$\n重新整理以分离出 $\\alpha_{n+1}$：\n$$ \\alpha_{n+1}q_n = p_n - q_{n-1} + \\sqrt{19}q_n \\implies \\alpha_{n+1} = \\frac{p_n-q_{n-1}}{q_n} + \\sqrt{19} $$\n这个方程要求 $\\alpha_{n+1} - \\sqrt{19}$ 是一个有理数。\n根据第 1 部分的算法，完全商的形式为 $\\alpha_k = \\frac{P_k + \\sqrt{19}}{Q_k}$，其中 $P_k, Q_k$ 是整数。因此，$\\alpha_{n+1} - \\sqrt{19} = \\frac{P_{n+1} + (1-Q_{n+1})\\sqrt{19}}{Q_{n+1}}$。要使这个表达式为有理数，带有 $\\sqrt{19}$ 的项必须消失，这意味着 $1-Q_{n+1}=0$，或 $Q_{n+1}=1$。\n\n我们需要找到使得 $Q_{n+1}=1$ 的最小索引 $n \\in \\mathbb{N}$。第 1 部分中的算法隐式地生成了序列 $Q_k$。初始值为 $Q_0=1$。从 $\\alpha_k$ 的计算中：\n$\\alpha_0 = \\frac{0+\\sqrt{19}}{1} \\implies Q_0=1$。\n$\\alpha_1 = \\frac{4+\\sqrt{19}}{3} \\implies Q_1=3$。\n$\\alpha_2 = \\frac{2+\\sqrt{19}}{5} \\implies Q_2=5$。\n$\\alpha_3 = \\frac{3+\\sqrt{19}}{2} \\implies Q_3=2$。\n$\\alpha_4 = \\frac{3+\\sqrt{19}}{5} \\implies Q_4=5$。\n$\\alpha_5 = \\frac{2+\\sqrt{19}}{3} \\implies Q_5=3$。\n$\\alpha_6 = 4+\\sqrt{19} = \\frac{4+\\sqrt{19}}{1} \\implies Q_6=1$。\n\n我们检查序列 $Q_{n+1}$，其中 $n \\in \\{0, 1, 2, ... \\}$。\n当 $n=0$ 时，$Q_1=3 \\neq 1$。\n当 $n=1$ 时，$Q_2=5 \\neq 1$。\n当 $n=2$ 时，$Q_3=2 \\neq 1$。\n当 $n=3$ 时，$Q_4=5 \\neq 1$。\n当 $n=4$ 时，$Q_5=3 \\neq 1$。\n当 $n=5$ 时，$Q_6=1$。这是第一次满足该条件。\n因此，最小索引是 $n_0 = 5$。\n\n让我们通过检验等式 $\\alpha_6 = \\frac{p_5-q_4}{q_5} + \\sqrt{19}$ 来验证这一点。\n我们有 $p_5=170$，$q_5=39$，$q_4=14$，以及 $\\alpha_6=4+\\sqrt{19}$。\n左式：$\\alpha_6 = 4+\\sqrt{19}$。\n右式：$\\frac{170-14}{39} + \\sqrt{19} = \\frac{156}{39} + \\sqrt{19} = 4 + \\sqrt{19}$。\n等式成立。因此，$|p_5^2 - 19 q_5^2| = 1$。\n让我们显式地计算它：$170^2 - 19 \\cdot 39^2 = 28900 - 19 \\cdot 1521 = 28900 - 28899 = 1$。\n最小的自然数索引确实是 $5$。", "answer": "$$\n\\boxed{5}\n$$", "id": "3020883"}]}