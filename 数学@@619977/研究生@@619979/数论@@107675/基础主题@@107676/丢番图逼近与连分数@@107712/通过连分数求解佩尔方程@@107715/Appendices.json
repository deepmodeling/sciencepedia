{"hands_on_practices": [{"introduction": "我们从一个基础练习开始，这个练习将带你走过利用连分数求解佩尔方程的全过程。通过处理 $D=7$ 这一简单情况，你将亲手计算 $\\sqrt{7}$ 的连分数展开，找到最小正整数解，并探索如何通过基本单位的幂来生成方程的所有其他解。这项实践是掌握该算法并理解解的代数结构的第一步。[@problem_id:3020881]", "problem": "令 $D=7$ 为一无平方因子数，考虑佩尔方程 $x^{2} - 7 y^{2} = 1$。使用 $\\sqrt{7}$ 的周期连分数展开和渐近分数理论，来确定 $x^{2} - 7 y^{2} = 1$ 的最小正整数解 $(x_{1}, y_{1})$。然后，在二次域 $\\mathbb{Q}(\\sqrt{7})$（其整数环为 $\\mathbb{Z}[\\sqrt{7}]$）中，将解集解释为范数为 $1$ 的基本单位的幂的集合，并明确计算由单位的幂产生的接下来两个解 $(x_{2}, y_{2})$ 和 $(x_{3}, y_{3})$。将您的最终答案表示为包含六个整数 $\\left(x_{1}, y_{1}, x_{2}, y_{2}, x_{3}, y_{3}\\right)$ 的单个行矩阵。无需四舍五入。", "solution": "该问题在数学上是适定的，并且其科学基础建立在成熟的丢番图方程和代数数论理论之上。它提供了确定唯一解所需的所有信息。我们开始求解。\n\n问题要求佩尔方程 $x^2 - Dy^2 = 1$ 对于 $D=7$ 的前三个正整数解。因此，方程为 $x^2 - 7y^2 = 1$。佩尔方程的理论将其解与 $\\sqrt{D}$ 的连分数展开联系起来。\n\n首先，我们计算 $\\sqrt{7}$ 的连分数展开。我们使用标准算法：\n令 $\\alpha_0 = \\sqrt{7}$。其整数部分为 $a_0 = \\lfloor\\sqrt{7}\\rfloor = 2$，因为 $2^2 = 4  7  3^2 = 9$。\n余项为 $\\xi_0 = \\sqrt{7} - 2$。\n令 $\\alpha_1 = \\frac{1}{\\xi_0} = \\frac{1}{\\sqrt{7}-2} = \\frac{\\sqrt{7}+2}{7-4} = \\frac{\\sqrt{7}+2}{3}$。\n其整数部分为 $a_1 = \\lfloor\\frac{\\sqrt{7}+2}{3}\\rfloor = \\lfloor\\frac{2.\\dots+2}{3}\\rfloor = \\lfloor\\frac{4.\\dots}{3}\\rfloor = 1$。\n余项为 $\\xi_1 = \\frac{\\sqrt{7}+2}{3} - 1 = \\frac{\\sqrt{7}-1}{3}$。\n令 $\\alpha_2 = \\frac{1}{\\xi_1} = \\frac{3}{\\sqrt{7}-1} = \\frac{3(\\sqrt{7}+1)}{7-1} = \\frac{3(\\sqrt{7}+1)}{6} = \\frac{\\sqrt{7}+1}{2}$。\n其整数部分为 $a_2 = \\lfloor\\frac{\\sqrt{7}+1}{2}\\rfloor = \\lfloor\\frac{2.\\dots+1}{2}\\rfloor = \\lfloor\\frac{3.\\dots}{2}\\rfloor = 1$。\n余项为 $\\xi_2 = \\frac{\\sqrt{7}+1}{2} - 1 = \\frac{\\sqrt{7}-1}{2}$。\n令 $\\alpha_3 = \\frac{1}{\\xi_2} = \\frac{2}{\\sqrt{7}-1} = \\frac{2(\\sqrt{7}+1)}{7-1} = \\frac{2(\\sqrt{7}+1)}{6} = \\frac{\\sqrt{7}+1}{3}$。\n其整数部分为 $a_3 = \\lfloor\\frac{\\sqrt{7}+1}{3}\\rfloor = \\lfloor\\frac{2.\\dots+1}{3}\\rfloor = \\lfloor\\frac{3.\\dots}{3}\\rfloor = 1$。\n余项为 $\\xi_3 = \\frac{\\sqrt{7}+1}{3} - 1 = \\frac{\\sqrt{7}-2}{3}$。\n令 $\\alpha_4 = \\frac{1}{\\xi_3} = \\frac{3}{\\sqrt{7}-2} = \\frac{3(\\sqrt{7}+2)}{7-4} = \\sqrt{7}+2$。\n其整数部分为 $a_4 = \\lfloor\\sqrt{7}+2\\rfloor = 2+2=4$。\n余项为 $\\xi_4 = (\\sqrt{7}+2) - 4 = \\sqrt{7}-2 = \\xi_0$。\n由于余项 $\\xi_4$ 等于 $\\xi_0$，系数序列 $a_i$ 开始进入周期。$\\sqrt{7}$ 的连分数展开为 $[a_0; \\overline{a_1, a_2, a_3, a_4}] = [2; \\overline{1, 1, 1, 4}]$。连分数的周期为 $r=4$。\n\n对于 $x^2 - Dy^2 = 1$，其最小正整数解 $(x_1, y_1)$ 由 $\\sqrt{D}$ 的连分数展开的第 $(r-1)$ 个渐近分数的分子 $p_{r-1}$ 和分母 $q_{r-1}$ 给出，前提是周期 $r$ 为偶数。在我们的例子中，$D=7$ 且周期 $r=4$，是偶数。因此，最小解 $(x_1, y_1)$ 是 $(p_3, q_3)$。\n我们使用递推关系 $p_n = a_n p_{n-1} + p_{n-2}$ 和 $q_n = a_n q_{n-1} + q_{n-2}$，以及初始值 $p_{-2}=0, p_{-1}=1$ 和 $q_{-2}=1, q_{-1}=0$ 来计算前几个渐近分数 $p_n/q_n$。\n$a_0 = 2$：$p_0 = 2(1)+0 = 2$，$q_0 = 2(0)+1 = 1$。\n$a_1 = 1$：$p_1 = 1(2)+1 = 3$，$q_1 = 1(1)+0 = 1$。\n$a_2 = 1$：$p_2 = 1(3)+2 = 5$，$q_2 = 1(1)+1 = 2$。\n$a_3 = 1$：$p_3 = 1(5)+3 = 8$，$q_3 = 1(2)+1 = 3$。\n渐近分数为 $p_3/q_3 = 8/3$。因此，最小正整数解为 $(x_1, y_1) = (8, 3)$。\n我们可以验证这一点：$8^2 - 7(3^2) = 64 - 7(9) = 64 - 63 = 1$。\n\n问题指出要将解在二次域 $\\mathbb{Q}(\\sqrt{7})$ 的整数环中进行解释。由于 $7 \\equiv 3 \\pmod 4$，整数环为 $\\mathbb{Z}[\\sqrt{7}]$。$x^2 - 7y^2 = 1$ 的解 $(x, y)$ 对应于 $\\mathbb{Z}[\\sqrt{7}]$ 中范数为 $N(u) = x^2 - 7y^2 = 1$ 的元素 $u = x+y\\sqrt{7}$。这些是范数为 $1$ 的单位。\n最小正解 $(x_1, y_1) = (8, 3)$ 给出基本单位 $\\epsilon = 8+3\\sqrt{7}$。\n所有其他正整数解 $(x_k, y_k)$ 都是通过取这个基本单位的幂生成的：$x_k + y_k\\sqrt{7} = \\epsilon^k$，其中 $k=1, 2, 3, \\dots$。\n\n对于 $k=1$，我们已经有了第一个解 $(x_1, y_1) = (8, 3)$。\n\n为了找到 $k=2$ 时的第二个解 $(x_2, y_2)$，我们计算 $\\epsilon^2$：\n$x_2 + y_2\\sqrt{7} = (8+3\\sqrt{7})^2 = 8^2 + 2(8)(3)\\sqrt{7} + (3\\sqrt{7})^2$\n$= 64 + 48\\sqrt{7} + 9(7)$\n$= 64 + 48\\sqrt{7} + 63$\n$= 127 + 48\\sqrt{7}$。\n所以，第二个解是 $(x_2, y_2) = (127, 48)$。\n我们可以验证这一点：$127^2 - 7(48^2) = 16129 - 7(2304) = 16129 - 16128 = 1$。\n\n为了找到 $k=3$ 时的第三个解 $(x_3, y_3)$，我们计算 $\\epsilon^3$：\n$x_3 + y_3\\sqrt{7} = \\epsilon^3 = \\epsilon \\cdot \\epsilon^2 = (8+3\\sqrt{7})(127+48\\sqrt{7})$\n$= 8(127) + 8(48)\\sqrt{7} + 3\\sqrt{7}(127) + (3\\sqrt{7})(48\\sqrt{7})$\n$= 1016 + 384\\sqrt{7} + 381\\sqrt{7} + 144(7)$\n$= 1016 + (384+381)\\sqrt{7} + 1008$\n$= (1016+1008) + 765\\sqrt{7}$\n$= 2024 + 765\\sqrt{7}$。\n所以，第三个解是 $(x_3, y_3) = (2024, 765)$。\n我们可以验证这一点：$2024^2 - 7(765^2) = 4096576 - 7(585225) = 4096576 - 4096575 = 1$。\n\n前三个解是 $(x_1, y_1) = (8, 3)$，$(x_2, y_2) = (127, 48)$ 和 $(x_3, y_3) = (2024, 765)$。最终答案要求将这六个整数放在一个单行矩阵中。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n8  3  127  48  2024  765\n\\end{pmatrix}\n}\n$$", "id": "3020881"}, {"introduction": "在掌握了基本流程后，我们来探讨一个更深层次的理论问题。虽然佩尔方程 $x^2 - Dy^2 = 1$ 总是有非平凡解，但“负”佩尔方程 $x^2 - Dy^2 = -1$ 的可解性则取决于 $D$ 的性质。这个练习将通过 $D=29$ 的例子，向你展示如何利用 $\\sqrt{D}$ 连分数周期的奇偶性来判断负佩尔方程的可解性，并找到其最小解。[@problem_id:3021004]", "problem": "设 $D$ 是一个固定的非平方正整数，并设 $\\sqrt{D}$ 的简单连分数展开为 $\\sqrt{D} = [a_{0}; a_{1}, a_{2}, \\dots]$，其中 $a_{0} = \\lfloor \\sqrt{D} \\rfloor$ 且该展开是最终周期的。回顾通过三元组 $(m_{k}, d_{k}, a_{k})$ 生成 $\\sqrt{D}$ 连分数的标准递推关系，定义如下\n$$\nm_{0} = 0,\\quad d_{0} = 1,\\quad a_{0} = \\lfloor \\sqrt{D} \\rfloor,\n$$\n且对于 $k \\geq 0$，\n$$\nm_{k+1} = d_{k} a_{k} - m_{k},\\quad d_{k+1} = \\frac{D - m_{k+1}^{2}}{d_{k}},\\quad a_{k+1} = \\left\\lfloor \\frac{a_{0} + m_{k+1}}{d_{k+1}} \\right\\rfloor.\n$$\n一个公认的事实是，对于无平方因子的 $D$，连分数在 $a_{0}$ 之后是纯周期的，并且周期在首次返回 $d_{k} = 1$ 且 $a_{k} = 2 a_{0}$ 时结束。设 $L$ 表示这个最小周期的长度。\n\n另一个基本事实是，负佩尔方程 $x^{2} - D y^{2} = -1$ 有整数解，当且仅当 $L$ 是奇数，在这种情况下，最小正整数解由 $\\sqrt{D}$ 的渐进分数 $p_{L-1}/q_{L-1}$ 给出。\n\n对于特定情况 $D = 29$：\n1. 使用上述递推关系计算 $\\sqrt{29}$ 的连分数，并确定最小周期长度 $L$。\n2. 根据 $L$ 的奇偶性，判断负佩尔方程 $x^{2} - 29 y^{2} = -1$ 是否有整数解。\n3. 如果可解，通过显式地构造出求解所需的指标之前的渐进分数，并检验方程 $x^{2} - 29 y^{2} = -1$ 来验证其可解性。\n\n将你的最终答案以行矩阵 $\\begin{pmatrix} L  s  x  y \\end{pmatrix}$ 的形式报告，其中 $L$ 是 $\\sqrt{29}$ 的周期长度，$s \\in \\{0,1\\}$，如果 $x^{2} - 29 y^{2} = -1$ 可解则等于 $1$，否则为 $0$，并且当 $s=1$ 时 $(x,y)$ 是 $x^{2} - 29 y^{2} = -1$ 的最小正整数解（当 $s=0$ 时使用 $(0,0)$）。最终答案必须是精确整数。", "solution": "该问题提法明确，并基于已建立的关于连分数及其与佩尔方程联系的数学理论。我们将按照针对整数 $D=29$ 的指定任务进行操作。\n\n首先，我们使用给定的递推关系计算 $\\sqrt{29}$ 的连分数展开。\n设 $D = 29$。第一项是 $a_{0} = \\lfloor \\sqrt{29} \\rfloor$。因为 $5^2 = 25$ 且 $6^2 = 36$，所以我们有 $a_{0} = 5$。\n递推的初始值为 $m_{0} = 0$ 和 $d_{0} = 1$。我们计算相继的项 $(m_{k}, d_{k}, a_{k})$。\n\n对于 $k=0$：\n$m_{1} = d_{0} a_{0} - m_{0} = 1 \\cdot 5 - 0 = 5$。\n$d_{1} = \\frac{D - m_{1}^{2}}{d_{0}} = \\frac{29 - 5^{2}}{1} = \\frac{29 - 25}{1} = 4$。\n$a_{1} = \\left\\lfloor \\frac{a_{0} + m_{1}}{d_{1}} \\right\\rfloor = \\left\\lfloor \\frac{5 + 5}{4} \\right\\rfloor = \\lfloor 2.5 \\rfloor = 2$。\n\n对于 $k=1$：\n$m_{2} = d_{1} a_{1} - m_{1} = 4 \\cdot 2 - 5 = 3$。\n$d_{2} = \\frac{D - m_{2}^{2}}{d_{1}} = \\frac{29 - 3^{2}}{4} = \\frac{29 - 9}{4} = \\frac{20}{4} = 5$。\n$a_{2} = \\left\\lfloor \\frac{a_{0} + m_{2}}{d_{2}} \\right\\rfloor = \\left\\lfloor \\frac{5 + 3}{5} \\right\\rfloor = \\lfloor 1.6 \\rfloor = 1$。\n\n对于 $k=2$：\n$m_{3} = d_{2} a_{2} - m_{2} = 5 \\cdot 1 - 3 = 2$。\n$d_{3} = \\frac{D - m_{3}^{2}}{d_{2}} = \\frac{29 - 2^{2}}{5} = \\frac{29 - 4}{5} = \\frac{25}{5} = 5$。\n$a_{3} = \\left\\lfloor \\frac{a_{0} + m_{3}}{d_{3}} \\right\\rfloor = \\left\\lfloor \\frac{5 + 2}{5} \\right\\rfloor = \\lfloor 1.4 \\rfloor = 1$。\n\n对于 $k=3$：\n$m_{4} = d_{3} a_{3} - m_{3} = 5 \\cdot 1 - 2 = 3$。\n$d_{4} = \\frac{D - m_{4}^{2}}{d_{3}} = \\frac{29 - 3^{2}}{5} = \\frac{29 - 9}{5} = \\frac{20}{5} = 4$。\n$a_{4} = \\left\\lfloor \\frac{a_{0} + m_{4}}{d_{4}} \\right\\rfloor = \\left\\lfloor \\frac{5 + 3}{4} \\right\\rfloor = \\lfloor 2 \\rfloor = 2$。\n\n对于 $k=4$：\n$m_{5} = d_{4} a_{4} - m_{4} = 4 \\cdot 2 - 3 = 5$。\n$d_{5} = \\frac{D - m_{5}^{2}}{d_{4}} = \\frac{29 - 5^{2}}{4} = \\frac{29 - 25}{4} = \\frac{4}{4} = 1$。\n$a_{5} = \\left\\lfloor \\frac{a_{0} + m_{5}}{d_{5}} \\right\\rfloor = \\left\\lfloor \\frac{5 + 5}{1} \\right\\rfloor = 10$。\n\n在 $k=5$ 时，我们得到 $d_{5}=1$。连分数的周期部分从 $a_1$ 开始，到这一模式重复之前结束。关于 $\\sqrt{D}$ 的连分数理论指出，当 $k>0$ 且 $d_k=1$ 首次出现时周期结束，并且周期的最后一项是 $a_k = 2a_0$。此处，$a_{5} = 10$ 且 $2a_0 = 2 \\cdot 5 = 10$。这确认了第一个周期的结束。\n部分商序列为 $a_{1}, a_{2}, a_{3}, a_{4}, a_{5}$。最小周期的长度是 $L=5$。\n连分数展开为 $\\sqrt{29} = [5; \\overline{2, 1, 1, 2, 10}]$。\n\n接下来，我们判断负佩尔方程 $x^{2} - 29y^{2} = -1$ 是否可解。问题中引用的定理指出，该方程有整数解当且仅当 $\\sqrt{D}$ 的连分数周期长度 $L$ 为奇数。由于我们求得 $L=5$，是一个奇数，因此该方程可解。因此，我们设置指示变量 $s=1$。\n\n最后，我们找出最小正整数解 $(x,y)$。同一定理指出，该解由渐进分数 $p_{L-1}/q_{L-1}$ 的分子和分母给出。对于 $L=5$，这就是渐进分数 $p_{4}/q_{4}$。我们使用递推关系计算渐进分数：\n$p_{k} = a_{k} p_{k-1} + p_{k-2}$\n$q_{k} = a_{k} q_{k-1} + q_{k-2}$\n初始值为 $p_{-1}=1$, $p_{-2}=0$, $q_{-1}=0$, $q_{-2}=1$。部分商为 $a_{0}=5, a_{1}=2, a_{2}=1, a_{3}=1, a_{4}=2, \\dots$。\n\n对于 $k=0$：\n$p_{0} = a_{0}p_{-1} + p_{-2} = 5(1) + 0 = 5$\n$q_{0} = a_{0}q_{-1} + q_{-2} = 5(0) + 1 = 1$\n\n对于 $k=1$：\n$p_{1} = a_{1}p_{0} + p_{-1} = 2(5) + 1 = 11$\n$q_{1} = a_{1}q_{0} + q_{-1} = 2(1) + 0 = 2$\n\n对于 $k=2$：\n$p_{2} = a_{2}p_{1} + p_{0} = 1(11) + 5 = 16$\n$q_{2} = a_{2}q_{1} + q_{0} = 1(2) + 1 = 3$\n\n对于 $k=3$：\n$p_{3} = a_{3}p_{2} + p_{1} = 1(16) + 11 = 27$\n$q_{3} = a_{3}q_{2} + q_{1} = 1(3) + 2 = 5$\n\n对于 $k=4$：\n$p_{4} = a_{4}p_{3} + p_{2} = 2(27) + 16 = 54 + 16 = 70$\n$q_{4} = a_{4}q_{3} + q_{2} = 2(5) + 3 = 10 + 3 = 13$\n\n最小正整数解是 $(x,y) = (p_{4}, q_{4}) = (70, 13)$。\n我们将此解代入方程进行验证：\n$x^{2} - 29y^{2} = 70^{2} - 29(13^{2}) = 4900 - 29(169)$。\n$29 \\times 169 = 4901$。\n所以，$4900 - 4901 = -1$。该解是正确的。\n\n最终答案所需的值是：\n周期长度 $L=5$。\n可解性指示符 $s=1$。\n最小正整数解 $(x,y) = (70, 13)$。\n如果方程不可解 ($s=0$)，解则为 $(0,0)$。\n\n最终答案由这四个整数组成一个行矩阵。", "answer": "$$\\boxed{\\begin{pmatrix} 5  1  70  13 \\end{pmatrix}}$$", "id": "3021004"}, {"introduction": "最后的这个练习是一个挑战，它展示了连分数方法的惊人力量。虽然前面的例子解都相对较小，但佩尔方程的最小解有时会大得惊人，而 $D=61$ 就是一个经典案例。这项练习要求你处理一个周期较长的连分数，并计算其巨大的最小解，从而深刻体会到该算法如何有效地“驯服”这类看似棘手的丢番图方程。[@problem_id:3020869]", "problem": "设 $D$ 为一个固定的无平方因子整数，考虑佩尔方程 $x^{2} - D y^{2} = 1$。关于 $\\sqrt{D}$ 的简单连分数 (SCF) 理论表明，SCF 的周期通过渐近分数与佩尔方程的解密切相关。令 $K(a_{0},a_{1},\\dots,a_{n})$ 表示与 SCF 数字 $(a_{0},a_{1},\\dots,a_{n})$ 相关联的连分式 (continuant)，即渐近分数 $[a_{0};a_{1},\\dots,a_{n}]$ 的分子。对于 $D=61$：\n- 通过显式计算一个完整的预周期和主周期的部分商，确定 $\\sqrt{61}$ 的 SCF 周期。\n- 仅使用连分式分子的递归定义及其在每个参数上的单调性，推导出与您找到的 SCF 数字相关的连分式分子 $K(a_{0},a_{1},\\dots,a_{n})$ 的初等乘积界，并由此获得一个必须包含 $x^{2}-61y^{2}=1$ 的最小佩尔分子 $x_{1}$ 的数值区间。\n- 根据周期长度的奇偶性，确定产生最小正整数解 $(x_{1},y_{1})$ 的正确渐近分数索引，显式计算相应的分子，并验证它确实是 $x^{2}-61y^{2}=1$ 的解。\n\n以单个整数的形式，报告 $D=61$ 时最小佩尔分子 $x_{1}$ 的精确值作为您的最终答案。", "solution": "该问题要求解出当 $D=61$ 时佩尔方程 $x^2 - Dy^2 = 1$ 的最小正整数解 $x_1$。需使用简单连分数 (SCF) 的方法求解。\n\n问题分为三个主要任务：\n1.  计算 $\\sqrt{61}$ 的 SCF 以找到其周期。\n2.  使用连分式分子的性质建立最小分子 $x_1$ 的界。\n3.  计算 $x_1$ 的精确值并进行验证。\n\n### 第 1 部分：$\\sqrt{61}$ 的简单连分数\n\n我们使用标准算法计算 $\\sqrt{61}$ 的 SCF。设 $\\xi_0 = \\sqrt{61}$。递归算法定义为 $a_n = \\lfloor \\xi_n \\rfloor$ 和 $\\xi_{n+1} = \\frac{1}{\\xi_n - a_n}$。\n\n$a_0 = \\lfloor \\sqrt{61} \\rfloor = 7$，因为 $7^2 = 49$ 且 $8^2 = 64$。\n$\\xi_1 = \\frac{1}{\\sqrt{61}-7} = \\frac{\\sqrt{61}+7}{61-49} = \\frac{\\sqrt{61}+7}{12}$。所以，$a_1 = \\lfloor \\frac{7+\\sqrt{61}}{12} \\rfloor = \\lfloor \\frac{7+7.81...}{12} \\rfloor=1$。\n$\\xi_2 = \\frac{1}{\\frac{\\sqrt{61}+7}{12}-1} = \\frac{12}{\\sqrt{61}-5} = \\frac{12(\\sqrt{61}+5)}{61-25} = \\frac{\\sqrt{61}+5}{3}$。所以，$a_2 = \\lfloor \\frac{5+\\sqrt{61}}{3} \\rfloor = \\lfloor \\frac{5+7.81...}{3} \\rfloor=4$。\n$\\xi_3 = \\frac{1}{\\frac{\\sqrt{61}+5}{3}-4} = \\frac{3}{\\sqrt{61}-7} = \\frac{3(\\sqrt{61}+7)}{61-49} = \\frac{\\sqrt{61}+7}{4}$。所以，$a_3 = \\lfloor \\frac{7+\\sqrt{61}}{4} \\rfloor = \\lfloor \\frac{7+7.81...}{4} \\rfloor=3$。\n$\\xi_4 = \\frac{1}{\\frac{\\sqrt{61}+7}{4}-3} = \\frac{4}{\\sqrt{61}-5} = \\frac{4(\\sqrt{61}+5)}{61-25} = \\frac{\\sqrt{61}+5}{9}$。所以，$a_4 = \\lfloor \\frac{5+\\sqrt{61}}{9} \\rfloor = \\lfloor \\frac{5+7.81...}{9} \\rfloor=1$。\n$\\xi_5 = \\frac{1}{\\frac{\\sqrt{61}+5}{9}-1} = \\frac{9}{\\sqrt{61}-4} = \\frac{9(\\sqrt{61}+4)}{61-16} = \\frac{\\sqrt{61}+4}{5}$。所以，$a_5 = \\lfloor \\frac{4+\\sqrt{61}}{5} \\rfloor = \\lfloor \\frac{4+7.81...}{5} \\rfloor=2$。\n$\\xi_6 = \\frac{1}{\\frac{\\sqrt{61}+4}{5}-2} = \\frac{5}{\\sqrt{61}-6} = \\frac{5(\\sqrt{61}+6)}{61-36} = \\frac{\\sqrt{61}+6}{5}$。所以，$a_6 = \\lfloor \\frac{6+\\sqrt{61}}{5} \\rfloor = \\lfloor \\frac{6+7.81...}{5} \\rfloor=2$。\n$\\xi_7 = \\frac{1}{\\frac{\\sqrt{61}+6}{5}-2} = \\frac{5}{\\sqrt{61}-4} = \\frac{5(\\sqrt{61}+4)}{61-16} = \\frac{\\sqrt{61}+4}{9}$。所以，$a_7 = \\lfloor \\frac{4+\\sqrt{61}}{9} \\rfloor = \\lfloor \\frac{4+7.81...}{9} \\rfloor=1$。\n$\\xi_8 = \\frac{1}{\\frac{\\sqrt{61}+4}{9}-1} = \\frac{9}{\\sqrt{61}-5} = \\frac{9(\\sqrt{61}+5)}{61-25} = \\frac{\\sqrt{61}+5}{4}$。所以，$a_8 = \\lfloor \\frac{5+\\sqrt{61}}{4} \\rfloor = \\lfloor \\frac{5+7.81...}{4} \\rfloor=3$。\n$\\xi_9 = \\frac{1}{\\frac{\\sqrt{61}+5}{4}-3} = \\frac{4}{\\sqrt{61}-7} = \\frac{4(\\sqrt{61}+7)}{61-49} = \\frac{\\sqrt{61}+7}{3}$。所以，$a_9 = \\lfloor \\frac{7+\\sqrt{61}}{3} \\rfloor = \\lfloor \\frac{7+7.81...}{3} \\rfloor=4$。\n$\\xi_{10} = \\frac{1}{\\frac{\\sqrt{61}+7}{3}-4} = \\frac{3}{\\sqrt{61}-5} = \\frac{3(\\sqrt{61}+5)}{61-25} = \\frac{\\sqrt{61}+5}{12}$。所以，$a_{10} = \\lfloor \\frac{5+\\sqrt{61}}{12} \\rfloor = \\lfloor \\frac{5+7.81...}{12} \\rfloor=1$。\n$\\xi_{11} = \\frac{1}{\\frac{\\sqrt{61}+5}{12}-1} = \\frac{12}{\\sqrt{61}-7} = \\frac{12(\\sqrt{61}+7)}{61-49} = \\sqrt{61}+7$。所以，$a_{11} = \\lfloor 7+\\sqrt{61} \\rfloor = 7+7=14$。\n$\\xi_{12} = \\frac{1}{(\\sqrt{61}+7)-14} = \\frac{1}{\\sqrt{61}-7} = \\xi_1$。\n\n部分商序列从 $\\xi_1$ 开始重复。SCF 为：\n$$ \\sqrt{61} = [7; \\overline{1, 4, 3, 1, 2, 2, 1, 3, 4, 1, 14}] $$\n预周期为 $(a_0) = (7)$。主周期为 $(a_1, \\dots, a_{11}) = (1, 4, 3, 1, 2, 2, 1, 3, 4, 1, 14)$。周期长度为 $r=11$。\n\n### 第 2 部分：为分子 $x_1$ 定界\n\n根据佩尔方程的理论，如果 $\\sqrt{D}$ 的 SCF 周期长度 $r$ 为奇数，则 $x^2-Dy^2=1$ 的基本正整数解 $(x_1, y_1)$ 由第 $(2r-1)$ 个渐近分数的分子和分母给出。对于 $D=61$，$r=11$ 是奇数，所以解为 $(x_1, y_1) = (p_{2r-1}, q_{2r-1}) = (p_{21}, q_{21})$。分子是 $x_1=p_{21}$。\n\n第 $n$ 个渐近分数的分子 $p_n$，也记为连分式分子 $K(a_0, \\dots, a_n)$，由以下递推关系给出：\n$p_n = a_n p_{n-1} + p_{n-2}$，初始值为 $p_{-1}=1$ 和 $p_0=a_0$。\n由于当 $i \\ge 1$ 时 $a_i \\ge 1$ 且 $D > 1$，序列 $p_n$ 在 $n \\ge 0$ 时是严格递增的。此外，当 $n \\ge 1$ 时 $p_{n-2} > 0$。\n这给出了一个下界：$p_n > a_n p_{n-1}$。\n此外，对于 $n \\ge 2$，$p_{n-2}  p_{n-1}$ 因为 $p_{n-1} = a_{n-1}p_{n-2}+p_{n-3} > p_{n-2}$。\n这给出了一个上界：$p_n = a_n p_{n-1} + p_{n-2}  a_n p_{n-1} + p_{n-1} = (a_n+1)p_{n-1}$。\n这些不等式对 $n=1$ 也成立，因为 $p_1 = a_1 a_0+1$，所以 $p_1 > a_1 a_0$ 且 $p_1  (a_1+1)a_0$ 等价于 $1  a_0$，而 $a_0=7$，这是成立的。\n\n通过递归地应用这些不等式，我们得到 $p_n$ 的乘积界：\n$$ a_0 \\prod_{i=1}^{n} a_i  p_n  a_0 \\prod_{i=1}^{n} (a_i+1) $$\n我们需要为 $p_{21}$ 定界。系数序列是 $a_0, \\dots, a_{21}$：\n$a_0=7$; $(a_1, \\dots, a_{11}) = (1,4,3,1,2,2,1,3,4,1,14)$; $(a_{12}, \\dots, a_{21}) = (1,4,3,1,2,2,1,3,4,1)$。\n\n下界 $L$：\n$L = a_0 \\left(\\prod_{i=1}^{11} a_i\\right) \\left(\\prod_{i=12}^{21} a_i\\right) = 7 \\times (1 \\cdot 4 \\cdot 3 \\cdot 1 \\cdot 2 \\cdot 2 \\cdot 1 \\cdot 3 \\cdot 4 \\cdot 1 \\cdot 14) \\times (1 \\cdot 4 \\cdot 3 \\cdot 1 \\cdot 2 \\cdot 2 \\cdot 1 \\cdot 3 \\cdot 4 \\cdot 1)$\n$L = 7 \\times (576 \\cdot 14) \\times (576) = 7 \\times 8064 \\times 576 = 32,514,048$.\n\n上界 $U$：\n$U = a_0 \\left(\\prod_{i=1}^{11} (a_i+1)\\right) \\left(\\prod_{i=12}^{21} (a_i+1)\\right)$\n$\\prod_{i=1}^{10} (a_i+1) = 2 \\cdot 5 \\cdot 4 \\cdot 2 \\cdot 3 \\cdot 3 \\cdot 2 \\cdot 4 \\cdot 5 \\cdot 2 = 57600$。\n$\\prod_{i=1}^{11} (a_i+1) = 57600 \\cdot (14+1) = 57600 \\cdot 15 = 864000$。\n$\\prod_{i=12}^{21} (a_i+1) = \\prod_{i=1}^{10} (a_i+1) = 57600$。\n$U = 7 \\times 864000 \\times 57600 = 7 \\times 49,766,400,000 = 348,364,800,000$。\n\n$x_1=p_{21}$ 的数值区间为 $[32,514,048, \\ 348,364,800,000]$。\n\n### 第 3 部分：计算最小分子 $x_1$\n\n直接计算 $p_{21}$ 很繁琐。我们可以使用理论中的另一个结果。当周期长度 $r$ 为奇数时，第 $(r-1)$ 个渐近分数 $p_{r-1}/q_{r-1}$ 提供了“负”佩尔方程 $x^2 - Dy^2 = -1$ 的基本解。对于 $D=61$，这个解是 $(u_1, v_1) = (p_{10}, q_{10})$。我们来计算这些值。\n$p_{-1}=1, p_0=7, \\quad q_{-1}=0, q_0=1$。\n$a_1=1: \\quad p_1=1 \\cdot 7+1 = 8, \\quad q_1=1 \\cdot 1+0=1$\n$a_2=4: \\quad p_2=4 \\cdot 8+7 = 39, \\quad q_2=4 \\cdot 1+1=5$\n$a_3=3: \\quad p_3=3 \\cdot 39+8 = 125, \\quad q_3=3 \\cdot 5+1=16$\n$a_4=1: \\quad p_4=1 \\cdot 125+39 = 164, \\quad q_4=1 \\cdot 16+5=21$\n$a_5=2: \\quad p_5=2 \\cdot 164+125 = 453, \\quad q_5=2 \\cdot 21+16=58$\n$a_6=2: \\quad p_6=2 \\cdot 453+164 = 1070, \\quad q_6=2 \\cdot 58+21=137$\n$a_7=1: \\quad p_7=1 \\cdot 1070+453 = 1523, \\quad q_7=1 \\cdot 137+58=195$\n$a_8=3: \\quad p_8=3 \\cdot 1523+1070 = 5639, \\quad q_8=3 \\cdot 195+137=722$\n$a_9=4: \\quad p_9=4 \\cdot 5639+1523 = 24079, \\quad q_9=4 \\cdot 722+195=3083$\n$a_{10}=1: \\quad p_{10}=1 \\cdot 24079+5639 = 29718, \\quad q_{10}=1 \\cdot 3083+722=3805$\n\n我们来验证 $(p_{10}, q_{10}) = (29718, 3805)$ 是否满足 $x^2 - 61y^2 = -1$：\n$29718^2 - 61 \\cdot 3805^2 = 883159524 - 61 \\cdot 14478025 = 883159524 - 883159525 = -1$。\n验证成立。\n\n$x^2-Dy^2=1$ 的基本解 $(x_1, y_1)$ 可以通过 $u^2-Dv^2=-1$ 的基本解 $(u_1, v_1)$ 由以下恒等式生成：\n$x_1 + y_1\\sqrt{D} = (u_1+v_1\\sqrt{D})^2 = (u_1^2+Dv_1^2) + (2u_1v_1)\\sqrt{D}$。\n因此，$x_1 = u_1^2 + Dv_1^2$ 且 $y_1 = 2u_1v_1$。\n此处，$(u_1, v_1) = (p_{10}, q_{10}) = (29718, 3805)$。\n$x_1 = p_{10}^2 + 61 q_{10}^2$。\n使用关系式 $p_{10}^2 - 61q_{10}^2 = -1 \\implies 61q_{10}^2 = p_{10}^2+1$，我们可以写出：\n$x_1 = p_{10}^2 + (p_{10}^2+1) = 2p_{10}^2+1$。\n$x_1 = 2 \\cdot (29718)^2 + 1 = 2 \\cdot 883159524 + 1 = 1766319048 + 1 = 1,766,319,049$。\n\n$x_1 = 1,766,319,049$ 这个值位于计算出的区间 $[32,514,048, \\ 348,364,800,000]$ 内。\n最小佩尔分子是 $x_1 = 1,766,319,049$。\n推导过程 $x_1 = u_1^2 + D v_1^2$ 和 $y_1 = 2u_1v_1$ 保证了 $(x_1, y_1)$ 是 $x^2-Dy^2=1$ 的解：\n$$ (u_1^2+Dv_1^2)^2 - D(2u_1v_1)^2 = u_1^4 + 2Du_1^2v_1^2 + D^2v_1^4 - 4Du_1^2v_1^2 = u_1^4 - 2Du_1^2v_1^2 + D^2v_1^4 = (u_1^2-Dv_1^2)^2 = (-1)^2 = 1 $$\n计算因此得到验证。", "answer": "$$\\boxed{1766319049}$$", "id": "3020869"}]}