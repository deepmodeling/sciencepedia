{"hands_on_practices": [{"introduction": "确定一个元素在模素数下的阶是数论中的一项基本技能。本练习旨在通过系统地测试群阶的所有因子来确定一个元素的精确阶，从而直接应用阶的定义和拉格朗日定理[@problem_id:3013924]。通过这个具体的计算过程，你将加深对阶的概念以及它为何必须整除 $\\phi(p) = p-1$ 的理解。", "problem": "设 $p$ 为素数，考虑模 $p$ 的乘法单位群，记为 $\\left(\\mathbb{Z}/p\\mathbb{Z}\\right)^{\\times}$。元素 $a \\in \\left(\\mathbb{Z}/p\\mathbb{Z}\\right)^{\\times}$ 的乘法阶定义为满足 $a^{k} \\equiv 1 \\pmod{p}$ 的最小正整数 $k$。请仅使用以下核心事实：$\\left(\\mathbb{Z}/p\\mathbb{Z}\\right)^{\\times}$ 是一个阶为 $\\varphi(p)=p-1$ 的有限群（其中 $\\varphi$ 是 Euler's totient function），且任何元素的阶都整除群的阶。通过检验 $p-1$ 的真因子并为每次检验提供明确的模运算，来确定 $2$ 模 $p=29$ 的乘法阶。根据您的阶计算，判断 $2$ 是否是模 $29$ 的原根，并仅通过对 $p-1$ 的因子分析来证明您的结论。将您的最终答案表示为 $2$ 模 $29$ 的乘法阶的精确值。", "solution": "该问题陈述经形式化验证，是自洽的，具有既定的数论科学基础，并且是适定的。所有给出的定义和条件都是标准的，没有矛盾或歧义。因此，我们可以着手进行形式化的解答。\n\n目标是确定元素 $2$ 在模 $29$ 的单位群 $\\left(\\mathbb{Z}/29\\mathbb{Z}\\right)^{\\times}$ 中的乘法阶。素数为 $p=29$。该群的阶由 Euler's totient function $\\varphi(p)$ 给出，对于素数 $p$，$\\varphi(p) = p-1$。因此，群 $\\left(\\mathbb{Z}/29\\mathbb{Z}\\right)^{\\times}$ 的阶为 $\\varphi(29) = 29-1 = 28$。\n\n设 $2$ 模 $29$ 的乘法阶记为 $k$。根据定义，$k$ 是满足 $2^k \\equiv 1 \\pmod{29}$ 的最小正整数。有限群的一个基本性质（在问题中被明确引述为核心事实）是，任何元素的阶都必须整除群的阶。因此，$k$ 必须是 $28$ 的一个因子。\n\n首先，我们找出 $28$ 的所有正因子。整数 $28$ 可以分解为其素因子，即 $28 = 2^2 \\times 7^1$。因此，其因子为 $\\{1, 2, 4, 7, 14, 28\\}$。为了找到阶 $k$，即满足条件的*最小*正整数，我们必须按升序检验 $28$ 的真因子。如果对于某个真因子 $d$ 有 $2^d \\equiv 1 \\pmod{29}$，那么 $k$ 就是满足条件的最小的 $d$。如果对于所有真因子 $d$ 都有 $2^d \\not\\equiv 1 \\pmod{29}$，那么阶 $k$ 必定是 $28$ 本身，因为这是唯一剩下的可能性。\n\n$28$ 的真因子集合是 $\\{1, 2, 4, 7, 14\\}$。我们现在对这些因子逐一进行模幂运算。\n\n1.  检验 $k=1$：\n    $$2^1 \\equiv 2 \\pmod{29}$$\n    由于 $2 \\not\\equiv 1 \\pmod{29}$，所以阶不为 $1$。\n\n2.  检验 $k=2$：\n    $$2^2 \\equiv 4 \\pmod{29}$$\n    由于 $4 \\not\\equiv 1 \\pmod{29}$，所以阶不为 $2$。\n\n3.  检验 $k=4$：\n    我们可以使用前一个结果：\n    $$2^4 = (2^2)^2 \\equiv 4^2 \\equiv 16 \\pmod{29}$$\n    由于 $16 \\not\\equiv 1 \\pmod{29}$，所以阶不为 $4$。\n\n4.  检验 $k=7$：\n    我们可以按顺序计算：\n    $2^5 = 2 \\times 2^4 \\equiv 2 \\times 16 = 32 \\equiv 3 \\pmod{29}$。\n    $2^7 = 2^2 \\times 2^5 \\equiv 4 \\times 3 = 12 \\pmod{29}$。\n    由于 $12 \\not\\equiv 1 \\pmod{29}$，所以阶不为 $7$。\n\n5.  检验 $k=14$：\n    使用 $k=7$ 的结果：\n    $$2^{14} = (2^7)^2 \\equiv 12^2 = 144 \\pmod{29}$$\n    为了将 $144$ 化简模 $29$，我们注意到 $29 \\times 5 = 145$。因此，$144 \\equiv 145 - 1 \\equiv -1 \\equiv 28 \\pmod{29}$。\n    由于 $28 \\not\\equiv 1 \\pmod{29}$，所以阶不为 $14$。\n\n模运算已表明，对于 $28$ 的所有真因子 $d$，都有 $2^d \\not\\equiv 1 \\pmod{29}$。由于阶 $k$ 必须整除 $28$，剩下的唯一可能性就是阶为 $28$。我们可以用最后的计算来验证这一点：$2^{28} = (2^{14})^2 \\equiv (-1)^2 \\equiv 1 \\pmod{29}$。这证实了我们的结论。\n\n因此，$2$ 模 $29$ 的乘法阶为 $k=28$。\n\n问题还要求判断 $2$ 是否是模 $29$ 的原根。如果一个元素 $a$ 的乘法阶等于 $\\varphi(p) = p-1$，那么它就是模素数 $p$ 的一个原根。在本例中，$2$ 的阶为 $28$，而 $\\varphi(29)$ 也为 $28$。由于元素 $2$ 的阶等于群 $\\left(\\mathbb{Z}/29\\mathbb{Z}\\right)^{\\times}$ 的阶，我们得出结论：$2$ 确实是模 $29$ 的原根。正如题目所要求的，此结论完全基于因子分析。\n\n要求的最终答案是 $2$ 模 $29$ 的乘法阶的精确值。", "answer": "$$\\boxed{28}$$", "id": "3013924"}, {"introduction": "在掌握了计算元素阶的基本方法后，我们可以探索一种更高效的策略来寻找本原根。尽管逐一测试 $p-1$ 的所有因子是可行的，但存在一个更强大的判别法，它仅需利用 $p-1$ 的*素因子*[@problem_id:3013938]。本练习将指导你应用这一关键判别法，这不仅是理论证明的基石，也是实际计算中不可或缺的工具。", "problem": "设 $p=97$ 是一个奇素数。在模 $p$ 的乘法单位群 $(\\mathbb{Z}/p\\mathbb{Z})^{\\times}$ 中进行运算。使用以下标准基础事实作为出发点：\n\n- 根据费马小定理 (Fermat's little theorem, FLT)，对于任意满足 $\\gcd(a,p)=1$ 的整数 $a$，有 $a^{p-1} \\equiv 1 \\pmod{p}$，因此 $a$ 在 $(\\mathbb{Z}/p\\mathbb{Z})^{\\times}$ 中的阶整除 $p-1$。\n- 根据有限群的拉格朗日定理 (Lagrange's theorem)，元素的阶整除群的阶。\n\n根据这些事实和关于有限群中阶的第一性原理，推导并证明一个元素 $g \\in (\\mathbb{Z}/p\\mathbb{Z})^{\\times}$ 的阶恰好为 $p-1$ 的一个充分必要判据，该判据用 $p-1$ 的素因子来表示。然后，通过分解 $p-1=96$，将此判据具体应用于 $p=97$ 的情况，并通过使用该判据测试小的候选数来计算一个模 $97$ 的原根。一旦找到一个原根 $g$，用 $g$ 的幂和指数中出现的整数 $k$ 来刻画并枚举模 $97$ 的所有原根。\n\n最后，将模 $97$ 的最小原根报告为一个介于 $2$ 和 $96$ 之间的整数。无需四舍五入，也无需单位。", "solution": "该问题陈述清晰，科学上基于已建立的数论，并包含唯一解所需的所有信息。因此，我们可以继续进行推导和计算。\n\n问题要求一个判据，用于在模素数 $p$ 的乘法单位群 $(\\mathbb{Z}/p\\mathbb{Z})^{\\times}$ 中识别原根。如果一个元素 $g \\in (\\mathbb{Z}/p\\mathbb{Z})^{\\times}$ 的阶等于该群的阶，即 $|\\left(\\mathbb{Z}/p\\mathbb{Z}\\right)^{\\times}| = \\phi(p) = p-1$，则该元素是一个原根。\n\n设 $G = (\\mathbb{Z}/p\\mathbb{Z})^{\\times}$ 且 $n = |G| = p-1$。根据费马小定理或拉格朗日定理，对于任何元素 $a \\in G$，$a$ 的阶（记作 $\\text{ord}_p(a)$）必整除 $n$。原根 $g$ 是一个满足 $\\text{ord}_p(g) = n$ 的元素。\n\n为了推导一个元素 $g$ 是原根的判据，我们考虑其反面：$g$ *不是* 原根意味着什么？如果 $g$ 不是原根，其阶 $d = \\text{ord}_p(g)$ 必为 $n=p-1$ 的一个真因子。也就是说，$d < n$ 且 $d|n$。\n\n设 $n=p-1$ 的素因子分解为 $n = q_1^{e_1} q_2^{e_2} \\cdots q_k^{e_k}$，其中 $q_1, q_2, \\dots, q_k$ 是 $n$ 的不同素因子。如果 $d$ 是 $n$ 的一个真因子，那么必定存在 $n$ 的某个素因子 $q_i$，使得整除 $d$ 的 $q_i$ 的幂次小于整除 $n$ 的 $q_i$ 的幂次。这意味着对于至少一个 $i \\in \\{1, 2, \\dots, k\\}$，$d$ 必定整除整数 $\\frac{n}{q_i}$。\n\n“$\\text{ord}_p(g)$ 整除 $m$”这一陈述等价于条件 $g^m \\equiv 1 \\pmod{p}$。\n因此，$g$ 不是原根的充要条件是，其阶 $\\text{ord}_p(g)$ 整除 $\\frac{p-1}{q_i}$，其中 $q_i$ 是 $p-1$ 的至少一个不同素因子。这等价于陈述，对于至少一个 $i \\in \\{1, 2, \\dots, k\\}$，有 $g^{(p-1)/q_i} \\equiv 1 \\pmod{p}$。\n\n通过取该陈述的逻辑逆否命题，我们得到 $g$ 是原根的充分必要判据：\n一个元素 $g \\in (\\mathbb{Z}/p\\mathbb{Z})^{\\times}$ 是模 $p$ 的原根，当且仅当对于 $p-1$ 的每一个不同素因子 $q$，都有 $g^{(p-1)/q} \\not\\equiv 1 \\pmod{p}$。\n\n我们现在将此判据应用于 $p=97$ 的具体情况。首先，我们必须分解 $p-1$：\n$p-1 = 97-1 = 96$。\n$96$ 的素因子分解是 $96 = 32 \\times 3 = 2^5 \\times 3^1$。\n$96$ 的不同素因子是 $q_1 = 2$ 和 $q_2 = 3$。\n\n根据我们推导出的判据，一个整数 $g$ 是模 $97$ 的原根，当且仅当它满足以下两个条件：\n1. $g^{96/2} \\not\\equiv 1 \\pmod{97} \\implies g^{48} \\not\\equiv 1 \\pmod{97}$\n2. $g^{96/3} \\not\\equiv 1 \\pmod{97} \\implies g^{32} \\not\\equiv 1 \\pmod{97}$\n\n我们从小整数开始测试 $g$ 的候选值，从 $g=2$ 开始。所有计算都在模 $97$ 下进行。\n\n测试 $g=2$：\n我们需要计算 $2^{32} \\pmod{97}$ 和 $2^{48} \\pmod{97}$。\n$2^5 = 32$\n$2^6 = 64$\n$2^7 = 128 \\equiv 31 \\pmod{97}$\n$2^8 = 256 \\equiv 62 \\pmod{97}$\n$2^{16} \\equiv 62^2 = 3844 = 39 \\times 97 + 61 \\equiv 61 \\pmod{97}$\n$2^{32} \\equiv 61^2 = 3721 = 38 \\times 97 + 35 \\equiv 35 \\pmod{97}$。\n由于 $35 \\not\\equiv 1 \\pmod{97}$，第二个条件满足。\n现在我们检查第一个条件：\n$2^{48} = 2^{32} \\times 2^{16} \\equiv 35 \\times 61 = 2135 = 22 \\times 97 + 1 \\equiv 1 \\pmod{97}$。\n第一个条件 $g^{48} \\not\\equiv 1 \\pmod{97}$ 不成立。因此，$2$ 不是模 $97$ 的原根。它的阶是 $48$。\n\n测试 $g=3$：\n我们计算 $3^{32} \\pmod{97}$ 和 $3^{48} \\pmod{97}$。\n$3^4 = 81 \\equiv -16 \\pmod{97}$\n$3^8 \\equiv (-16)^2 = 256 \\equiv 62 \\pmod{97}$\n$3^{16} \\equiv 62^2 = 3844 \\equiv 61 \\pmod{97}$\n$3^{32} \\equiv 61^2 = 3721 \\equiv 35 \\pmod{97}$。\n由于 $35 \\not\\equiv 1 \\pmod{97}$，第二个条件满足。\n现在我们检查第一个条件：\n$3^{48} = 3^{32} \\times 3^{16} \\equiv 35 \\times 61 = 2135 \\equiv 1 \\pmod{97}$。\n第一个条件不成立。因此，$3$ 不是模 $97$ 的原根。它的阶是 $48$。\n\n测试 $g=5$：\n我们计算 $5^{32} \\pmod{97}$ 和 $5^{48} \\pmod{97}$。\n$5^2 = 25$\n$5^4 = 625 = 6 \\times 97 + 43 \\equiv 43 \\pmod{97}$\n$5^8 \\equiv 43^2 = 1849 = 19 \\times 97 + 6 \\equiv 6 \\pmod{97}$\n$5^{16} \\equiv 6^2 = 36 \\pmod{97}$\n$5^{32} \\equiv 36^2 = 1296 = 13 \\times 97 + 35 \\equiv 35 \\pmod{97}$。\n由于 $35 \\not\\equiv 1 \\pmod{97}$，第二个条件满足。\n现在我们检查第一个条件：\n$5^{48} = 5^{32} \\times 5^{16} \\equiv 35 \\times 36 = 1260 = 12 \\times 97 + 96 \\equiv 96 \\equiv -1 \\pmod{97}$。\n由于 $-1 \\not\\equiv 1 \\pmod{97}$，第一个条件也满足。\n对于 $g=5$，两个条件都成立，所以 $5$ 是模 $97$ 的一个原根。由于这是我们按递增顺序测试找到的第一个原根，所以 $5$ 是模 $97$ 的最小原根。\n\n最后，我们刻画并枚举模 $97$ 的所有原根。由于 $g=5$ 是一个原根，群 $(\\mathbb{Z}/97\\mathbb{Z})^{\\times}$ 是循环群，由 $5$ 生成。其元素为 $\\{5^1, 5^2, \\dots, 5^{96}\\}$。元素 $g^k$ 的阶由 $\\text{ord}(g^k) = \\frac{\\text{ord}(g)}{\\gcd(k, \\text{ord}(g))}$ 给出。\n在我们的例子中，$\\text{ord}(5) = 96$。要使 $5^k$ 成为原根，它的阶也必须是 $96$。这要求：\n$\\frac{96}{\\gcd(k, 96)} = 96 \\implies \\gcd(k, 96) = 1$。\n整数 $k$ 必须在 $1 \\leq k \\leq 96$ 的范围内。因此，所有原根的形式为 $5^k \\pmod{97}$，其中 $k$ 是与 $96$ 互素的整数。\n这样的整数 $k$ 的数量由欧拉函数 $\\phi(96)$ 给出。\n$\\phi(96) = \\phi(2^5 \\times 3) = \\phi(2^5) \\phi(3) = (2^5 - 2^4)(3-1) = (32 - 16)(2) = 16 \\times 2 = 32$。\n模 $97$ 共有 $32$ 个原根。它们是形如 $5^k \\pmod{97}$ 的元素，其中所有的 $k \\in \\{1, 5, 7, 11, 13, 17, 19, 23, \\dots, 95\\}$ 满足 $\\gcd(k, 96)=1$。\n\n问题要求模 $97$ 的最小原根，我们已计算出其为 $5$。", "answer": "$$\\boxed{5}$$", "id": "3013938"}, {"introduction": "本章的最后一个实践将我们对本原根的理解从模素数 $p$ 推广到模素数幂 $p^k$ 的情况，这是该理论的一个核心拓展。一个重要的事实是，并非所有模 $p$ 的本原根都能“提升”为模 $p^2$ 的本原根[@problem_id:3013911]。这个练习将探讨这种提升所需的特定条件，并演示如何验证它，从而为你理解更一般模数下本原根的存在性奠定基础。", "problem": "设 $p$ 为一个奇素数，考虑模 $p^{2}$ 的乘法单位群，记为 $(\\mathbb{Z}/p^{2}\\mathbb{Z})^{\\times}$。回顾以下基本事实：$(\\mathbb{Z}/p\\mathbb{Z})^{\\times}$ 是一个阶为 $p-1$ 的循环群，$(\\mathbb{Z}/p^{2}\\mathbb{Z})^{\\times}$ 是一个阶为 $p(p-1)$ 的循环群，且一个元素 $a$ 对模 $m$ 的阶是满足 $a^{t} \\equiv 1 \\pmod{m}$ 的最小正整数 $t$。如果一个元素 $g$ 的阶等于 $\\varphi(m)$，则称其为模 $m$ 的原根，其中 $\\varphi$ 是欧拉函数。仅使用这些基本定义和事实，按如下方式分析 $p=19$ 和 $a=2$ 的情况：\n\n1. 通过检验 $18$ 的所有真因子，确定 $2$ 在 $(\\mathbb{Z}/19\\mathbb{Z})^{\\times}$ 中的阶。\n2. 使用一个基于上述事实的自洽论证，通过不假定除循环性陈述外的任何专门定理的显式计算，来验证同余式 $2^{18} \\not\\equiv 1 \\pmod{19^{2}}$。\n3. 根据你的分析，得出 $2$ 在 $(\\mathbb{Z}/19^{2}\\mathbb{Z})^{\\times}$ 中的确切阶数。\n\n将你的最终答案表示为单个整数，即 $2$ 对模 $19^{2}$ 的阶。无需四舍五入。", "solution": "该问题要求确定元素 $2$ 在模 $19^2$ 的整数乘法群 $(\\mathbb{Z}/19^2\\mathbb{Z})^{\\times}$ 中的阶。分析将按指定的三步进行。素数为 $p=19$，元素为 $a=2$。\n\n首先，我们确定 $2$ 在群 $(\\mathbb{Z}/19\\mathbb{Z})^{\\times}$ 中的阶。问题陈述，对于素数 $p$，该群是阶为 $p-1$ 的循环群。对于素数 $p=19$，群 $(\\mathbb{Z}/19\\mathbb{Z})^{\\times}$ 的阶为 $\\varphi(19) = 19-1 = 18$。根据拉格朗日定理，该群中任何元素的阶都必须是群阶的因子。$18$ 的因子有 $1, 2, 3, 6, 9$ 和 $18$。为了找到 $2$ 的阶，我们必须从此集合中找到满足 $2^t \\equiv 1 \\pmod{19}$ 的最小正整数 $t$。我们检验 $18$ 的真因子：\n- $2^1 \\equiv 2 \\pmod{19}$\n- $2^2 \\equiv 4 \\pmod{19}$\n- $2^3 \\equiv 8 \\pmod{19}$\n- $2^6 = (2^3)^2 \\equiv 8^2 = 64 \\equiv 64 - 3 \\times 19 = 57 \\equiv 7 \\pmod{19}$\n- $2^9 = 2^3 \\times 2^6 \\equiv 8 \\times 7 = 56 \\equiv 56 - 2 \\times 19 = 38 \\equiv 18 \\equiv -1 \\pmod{19}$\n\n由于对于 $18$ 的任何真因子 $k$ 都有 $2^k \\not\\equiv 1 \\pmod{19}$，所以 $2$ 对模 $19$ 的阶必为 $18$。这证明了 $2$ 是模 $19$ 的一个原根。\n\n其次，我们需要通过显式计算验证 $2^{18} \\not\\equiv 1 \\pmod{19^2}$。模为 $m = 19^2 = 361$。我们使用快速幂法计算 $2^{18} \\pmod{361}$。\n- $2^1 \\equiv 2 \\pmod{361}$\n- $2^2 \\equiv 4 \\pmod{361}$\n- $2^4 = (2^2)^2 \\equiv 4^2 = 16 \\pmod{361}$\n- $2^8 = (2^4)^2 \\equiv 16^2 = 256 \\pmod{361}$\n- $2^{16} = (2^8)^2 \\equiv 256^2 = 65536 \\pmod{361}$。为了简化此数，我们做带余除法：$65536 = 181 \\times 361 + 195$。因此，$2^{16} \\equiv 195 \\pmod{361}$。\n指数 $18$ 可以写成 $18 = 16+2$。因此，我们可以将 $2^{18}$ 计算为 $2^{16} \\times 2^2$。\n- $2^{18} = 2^{16} \\times 2^2 \\equiv 195 \\times 4 \\pmod{361}$\n- $195 \\times 4 = 780$。为了简化此数，我们再次做带余除法：$780 = 2 \\times 361 + 58$。\n- 所以，$2^{18} \\equiv 58 \\pmod{361}$。\n由于 $58 \\not\\equiv 1 \\pmod{361}$，所需的验证完成。\n\n第三，我们得出 $2$ 在 $(\\mathbb{Z}/19^2\\mathbb{Z})^{\\times}$ 中的确切阶数。设此阶为 $t$。问题陈述，对于奇素数 $p$，群 $(\\mathbb{Z}/p^2\\mathbb{Z})^{\\times}$ 是阶为 $\\varphi(p^2)$ 的循环群。对于 $p=19$，此阶为 $\\varphi(19^2) = 19^2 - 19^1 = 19(19-1) = 19 \\times 18 = 342$。\n根据拉格朗日定理，元素 $2$ 的阶 $t$ 必须整除群的阶，所以 $t$ 必须是 $342$ 的一个因子。\n根据阶的定义，我们有 $2^t \\equiv 1 \\pmod{19^2}$。这个同余式蕴含了较弱的同余式 $2^t \\equiv 1 \\pmod{19}$。\n从我们分析的第一部分可知，$2$ 对模 $19$ 的阶是 $18$。阶的一个基本性质指出，如果 $a^n \\equiv 1 \\pmod{m}$，那么 $a$ 对模 $m$ 的阶必须整除 $n$。将此性质应用于我们的情况，$18$ 必须整除 $t$。\n所以，$t$ 必须是 $18$ 的倍数，且是 $342$ 的因子。由于 $342 = 18 \\times 19$，满足这两个条件的整数是 $18$ 和 $18 \\times 19 = 342$。\n在第二部分，我们已经明确证明了 $2^{18} \\not\\equiv 1 \\pmod{19^2}$。因此，阶 $t$ 不可能是 $18$。\n唯一剩下的可能性是 $t=342$。\n因此，$2$ 在群 $(\\mathbb{Z}/19^2\\mathbb{Z})^{\\times}$ 中的阶为 $342$。这也意味着 $2$ 是模 $19^2$ 的一个原根。", "answer": "$$\\boxed{342}$$", "id": "3013911"}]}