{"hands_on_practices": [{"introduction": "理解指数和离散对数的最好方法是通过亲手计算。这个练习将指导你完成最基础的任务：为一个小的素数模数构建一个完整的指数表。通过这个过程 [@problem_id:1364688]，你将直观地体验到指数（离散对数）与群元素之间的一一对应关系，这是离散对数理论的核心。", "problem": "在模算术的背景下，离散对数（或称指标）的概念提供了一种处理模素数的整数乘法群的方法。设$p$是一个素数，$g$是模$p$的一个原根。对于任何不能被$p$整除的整数$a$，其以$g$为底、模为$p$的离散对数或指标，记为$\\text{ind}_g(a)$，是满足$1 \\le k \\le p-1$和$g^k \\equiv a \\pmod{p}$的唯一整数$k$。\n\n给定素数$p=13$和原根$g=2$，确定以下两个值：\n1. $11$的指标，即$k = \\text{ind}_2(11)$的值。\n2. 满足$\\text{ind}_2(x) = 9$的整数$x$，其中$1 \\le x < 13$。\n\n以整数对$(k, x)$的形式给出你的最终答案。", "solution": "问题要求两个与以2为底、模为13的离散对数相关的值：$11$的指标，以及指标为$9$的数。要解决这个问题，我们必须首先建立原根$g=2$的幂与模13的整数乘法群元素（即$\\{1, 2, \\dots, 12\\}$）之间的对应关系。\n\n我们将计算$g=2$模$p=13$的连续幂。\n$2^1 \\equiv 2 \\pmod{13}$\n$2^2 \\equiv 4 \\pmod{13}$\n$2^3 \\equiv 8 \\pmod{13}$\n$2^4 \\equiv 2 \\times 8 = 16 \\equiv 3 \\pmod{13}$\n$2^5 \\equiv 2 \\times 3 = 6 \\pmod{13}$\n$2^6 \\equiv 2 \\times 6 = 12 \\equiv -1 \\pmod{13}$\n$2^7 \\equiv 2 \\times 12 = 24 \\equiv 11 \\pmod{13}$\n$2^8 \\equiv 2 \\times 11 = 22 \\equiv 9 \\pmod{13}$\n$2^9 \\equiv 2 \\times 9 = 18 \\equiv 5 \\pmod{13}$\n$2^{10} \\equiv 2 \\times 5 = 10 \\pmod{13}$\n$2^{11} \\equiv 2 \\times 10 = 20 \\equiv 7 \\pmod{13}$\n$2^{12} \\equiv 2 \\times 7 = 14 \\equiv 1 \\pmod{13}$\n\n根据这些计算，我们可以创建一个表格，将指数$k$（即指标）映射到结果数$a=2^k \\pmod{13}$。\n\n| 指数 $k$ ($\\text{ind}_2(a)$) | 结果 $a = 2^k \\pmod{13}$ |\n|-----------------------------------|-------------------------------|\n| 1                                 | 2                             |\n| 2                                 | 4                             |\n| 3                                 | 8                             |\n| 4                                 | 3                             |\n| 5                                 | 6                             |\n| 6                                 | 12                            |\n| 7                                 | 11                            |\n| 8                                 | 9                             |\n| 9                                 | 5                             |\n| 10                                | 10                            |\n| 11                                | 7                             |\n| 12                                | 1                             |\n\n现在我们可以回答问题的两个部分。\n\n1.  为了求出$k = \\text{ind}_2(11)$，我们需要找到指数$k$使得$2^k \\equiv 11 \\pmod{13}$。查看我们的表格，在“结果 $a$”列中寻找值$11$。我们在指数为$7$的行中找到了它。因此，$k = \\text{ind}_2(11) = 7$。\n\n2.  为了求出满足$\\text{ind}_2(x) = 9$的整数$x$，我们已知指标，需要找到对应的数。这意味着我们在寻找$x$使得$x \\equiv 2^9 \\pmod{13}$。查看我们的表格，我们找到指数$k$为$9$的行。对应的结果是$5$。因此，$x=5$。\n\n所求的整数对是 $(k, x) = (7, 5)$。", "answer": "$$\\boxed{\\begin{pmatrix} 7 & 5 \\end{pmatrix}}$$", "id": "1364688"}, {"introduction": "当模数变大时，通过构建完整的指数表来求解离散对数变得不切实际。Pohlig-Hellman算法提供了一种更巧妙、更高效的策略，尤其是在群的阶是光滑数（即其素因子都很小）的情况下。这个练习将带你逐步执行该算法，通过将一个大问题分解为多个在子群中的小问题，并利用中国剩余定理重构解，从而深入理解“分而治之”这一强大的数学思想 [@problem_id:3015900]。", "problem": "设素数 $p = 241$ 且 $m = p - 1$。考虑阶为 $m$ 的循环乘法群 $\\left(\\mathbb{Z}/p\\mathbb{Z}\\right)^{\\times}$ 以及离散对数问题：给定 $g = 7$ 和 $h = 104$，确定指数 $x \\in \\{0,1,\\dots,m-1\\}$ 使得 $g^{x} \\equiv h \\pmod{p}$。整数 $m$ 分解为 $m = 240 = 2^{4} \\cdot 3 \\cdot 5$，这是一个光滑数。从群阶、离散对数和 $m$ 的素数幂次分解等基本定义出发，应用 Pohlig–Hellman 算法通过以下步骤计算 $x$：\n1. 验证 $g$ 在 $\\left(\\mathbb{Z}/p\\mathbb{Z}\\right)^{\\times}$ 中的阶为 $m$。\n2. 在相应的素数幂次子群中使用指数运算法计算 $x \\bmod 2^{4}$、$x \\bmod 3$ 和 $x \\bmod 5$。\n3. 通过中国剩余定理（CRT；Chinese Remainder Theorem）重构 $x \\bmod m$。\n最后，验证重构的 $x$ 满足 $g^{x} \\equiv h \\pmod{p}$。将最终答案表示为精确整数 $x$（无舍入）。", "solution": "问题陈述是一个定义明确的求解离散对数问题的实例，该问题所在的有限循环群的阶是一个光滑数。所有必要的已知条件均已给出：素数模 $p=241$、生成元 $g=7$、目标元素 $h=104$ 以及群阶的因式分解 $m = p-1 = 240 = 2^4 \\cdot 3 \\cdot 5$。使用 Pohlig-Hellman 算法并验证结果的指令清晰且数学上合理。因此，该问题是有效的。\n\n我们需要求解一个整数 $x \\in \\{0, 1, \\dots, 239\\}$，使得 $7^x \\equiv 104 \\pmod{241}$。\n\n\\textbf{步骤 1：验证 $g=7$ 的阶}\n\n群 $(\\mathbb{Z}/241\\mathbb{Z})^{\\times}$ 的阶为 $m = 240$。为确认 $g=7$ 是一个生成元，它的阶必须是 $240$。这需要证明对于 $m$ 的每个不同素因子 $q$，都有 $g^{m/q} \\not\\equiv 1 \\pmod{p}$。$m=240$ 的素因子是 $2$、$3$ 和 $5$。\n\n对于 $q=2$，指数为 $m/2 = 120$。我们计算 $7^{120} \\pmod{241}$：\n$7^2 = 49$\n$7^4 \\equiv (49)^2 = 2401 = 10(241)-9 \\equiv -9 \\pmod{241}$\n$7^8 \\equiv (-9)^2 = 81 \\pmod{241}$\n$7^{16} \\equiv 81^2 = 6561 = 27(241)+54 \\equiv 54 \\pmod{241}$\n$7^{32} \\equiv 54^2 = 2916 = 12(241)+24 \\equiv 24 \\pmod{241}$\n$7^{40} = 7^{32} \\cdot 7^8 \\equiv 24 \\cdot 81 = 1944 = 8(241)+16 \\equiv 16 \\pmod{241}$\n$7^{80} = (7^{40})^2 \\equiv 16^2 = 256 \\equiv 15 \\pmod{241}$。由于 $15 \\not\\equiv 1$，这涵盖了 $q=3$ 的情况（$m/3=80$）。\n$7^{120} = 7^{80} \\cdot 7^{40} \\equiv 15 \\cdot 16 = 240 \\equiv -1 \\pmod{241}$。由于 $-1 \\not\\equiv 1$，这涵盖了 $q=2$ 的情况。\n\n对于 $q=5$，指数为 $m/5 = 48$。我们计算 $7^{48} \\pmod{241}$：\n$7^{48} = 7^{32} \\cdot 7^{16} \\equiv 24 \\cdot 54 = 1296 = 5(241)+91 \\equiv 91 \\pmod{241}$。由于 $91 \\not\\equiv 1$，这涵盖了 $q=5$ 的情况。\n\n由于对于 $q \\in \\{2,3,5\\}$，都有 $g^{m/q} \\not\\equiv 1 \\pmod{p}$，所以 $g=7$ 的阶为 $m=240$。\n\n\\textbf{步骤 2：计算 $x$ 模 $m$ 的素数幂次因子}\n\nPohlig-Hellman 算法将问题简化为求解 $x$ 模 $m$ 的每个素数幂次因子的同余方程；在本例中，即模 $2^4=16$、$3$ 和 $5$。\n\n\\textbf{2a. 计算 $x \\pmod{16}$}\n我们需要求 $x \\pmod{16}$。我们定义 $g_1 = g^{m/16} = 7^{240/16} = 7^{15}$ 和 $h_1 = h^{m/16} = 104^{15}$。原始同余式 $g^x \\equiv h$ 意味着 $g_1^x \\equiv h_1$。\n$g_1 = 7^{15} = 7^{8+4+2+1} \\equiv 81 \\cdot (-9) \\cdot 49 \\cdot 7 \\pmod{241}$。\n$81 \\cdot (-9) = -729 = -3(241)-6 \\equiv -6 \\pmod{241}$。\n$49 \\cdot 7 = 343 = 1(241)+102 \\equiv 102 \\pmod{241}$。\n$g_1 \\equiv -6 \\cdot 102 = -612 = -3(241)+111 \\equiv 111 \\pmod{241}$。\n\n$h_1 = 104^{15} \\pmod{241}$。我们需要计算 $104$ 的幂：\n$104^2 \\equiv (104)^2 = 10816 = 44(241)+212 \\equiv -29 \\pmod{241}$。\n$104^4 \\equiv (-29)^2 = 841 = 3(241)+118 \\equiv 118 \\pmod{241}$。\n$104^8 \\equiv 118^2 = 13924 = 57(241)+187 \\equiv -54 \\pmod{241}$。\n$h_1 = 104^{8+4+2+1} \\equiv (-54) \\cdot 118 \\cdot (-29) \\cdot 104 \\pmod{241}$。\n$(-54) \\cdot 118 = -6372 = -26(241)-106 \\equiv -106 \\pmod{241}$。\n$(-29) \\cdot 104 = -3016 = -12(241)-124 \\equiv -124 \\pmod{241}$。\n$h_1 \\equiv (-106) \\cdot (-124) = 13144 = 54(241)+130 \\equiv 130 \\pmod{241}$。\n\n我们需要求解 $111^x \\equiv 130 \\pmod{241}$。$g_1=111$ 的阶是 16。我们检查 $111$ 的幂：$111^8 \\equiv (111^4)^2 \\equiv (177)^2 = 31329 = 130(241)-1 \\equiv -1 \\pmod{241}$。\n由于 $130 = 241-111 \\equiv -111 \\pmod{241}$，同余式变为 $111^x \\equiv -111 \\pmod{241}$。\n这意味着 $111^{x-1} \\equiv -1 \\equiv 111^8 \\pmod{241}$。由于 $111$ 的阶是 $16$，我们有 $x-1 \\equiv 8 \\pmod{16}$，即 $x \\equiv 9 \\pmod{16}$。\n\n\\textbf{2b. 计算 $x \\pmod 3$}\n我们定义 $g_2 = g^{m/3} = 7^{80}$ 和 $h_2 = h^{m/3} = 104^{80}$。\n根据步骤 1，$g_2 = 7^{80} \\equiv 15 \\pmod{241}$。\n对于 $h_2$，我们需要计算 $104$ 的幂：\n$104^{16} \\equiv 24 \\pmod{241}$。\n$104^{32} \\equiv 24^2 = 576 = 2(241)+94 \\equiv 94 \\pmod{241}$。\n$104^{64} \\equiv 94^2 = 8836 = 36(241)+160 \\equiv 160 \\pmod{241}$。\n$h_2 = 104^{64+16} \\equiv 160 \\cdot 24 = 3840 = 15(241)+225 \\equiv 225 \\pmod{241}$。\n我们求解 $15^x \\equiv 225 \\pmod{241}$。通过观察可知，$15^2 = 225$，所以 $x \\equiv 2 \\pmod 3$。\n\n\\textbf{2c. 计算 $x \\pmod 5$}\n我们定义 $g_3 = g^{m/5} = 7^{48}$ 和 $h_3 = h^{m/5} = 104^{48}$。\n根据步骤 1，$g_3 = 7^{48} \\equiv 91 \\pmod{241}$。\n$h_3 = 104^{48} = 104^{32+16} \\equiv 94 \\cdot 24 = 2256 = 9(241)+87 \\equiv 87 \\pmod{241}$。\n我们求解 $91^x \\equiv 87 \\pmod{241}$。我们测试 $91$ 的幂：\n$91^1 \\equiv 91 \\pmod{241}$。\n$91^2 = 8281 = 34(241)+87 \\equiv 87 \\pmod{241}$。\n因此，$x \\equiv 2 \\pmod 5$。\n\n\\textbf{步骤 3：通过中国剩余定理重构 $x$}\n我们得到以下同余方程组：\n1) $x \\equiv 9 \\pmod{16}$\n2) $x \\equiv 2 \\pmod 3$\n3) $x \\equiv 2 \\pmod 5$\n\n由 (2) 和 (3) 可知，由于 $3$ 和 $5$ 互素，$x \\equiv 2 \\pmod{3 \\cdot 5}$，即 $x \\equiv 2 \\pmod{15}$。\n我们可以写出 $x = 15k + 2$，其中 $k$ 是某个整数。将此代入 (1)：\n$15k + 2 \\equiv 9 \\pmod{16}$\n$15k \\equiv 7 \\pmod{16}$\n由于 $15 \\equiv -1 \\pmod{16}$，上式变为：\n$-k \\equiv 7 \\pmod{16}$\n$k \\equiv -7 \\equiv 9 \\pmod{16}$\n所以，$k = 16j + 9$，其中 $j$ 是某个整数。将此代回 $x$ 的表达式：\n$x = 15(16j + 9) + 2 = 240j + 135 + 2 = 240j + 137$。\n在范围 $\\{0, 1, \\dots, 239\\}$ 内的唯一解是 $x = 137$。\n\n\\textbf{步骤 4：验证}\n我们必须验证 $7^{137} \\equiv 104 \\pmod{241}$。\n指数 $137$ 的二进制展开是 $137_{10} = 10001001_2 = 128 + 8 + 1$。\n我们通过平方运算计算所需的 $7$ 的幂：\n$7^1 \\equiv 7$\n$7^2 \\equiv 49$\n$7^4 \\equiv -9$\n$7^8 \\equiv 81$\n$7^{16} \\equiv 54$\n$7^{32} \\equiv 24$\n$7^{64} \\equiv 94$\n$7^{128} \\equiv 94^2 = 8836 = 36(241)+160 \\equiv 160 \\pmod{241}$。\n\n现在我们计算最终的乘积：\n$7^{137} = 7^{128} \\cdot 7^8 \\cdot 7^1 \\pmod{241}$\n$7^{137} \\equiv 160 \\cdot 81 \\cdot 7 \\pmod{241}$\n$160 \\cdot 81 = 12960 = 53(241)+187 \\equiv 187 \\pmod{241}$。\n$7^{137} \\equiv 187 \\cdot 7 = 1309 = 5(241)+104 \\equiv 104 \\pmod{241}$。\n结果得到验证。$x$ 的值为 $137$。", "answer": "$$\\boxed{137}$$", "id": "3015900"}, {"introduction": "指数演算（Index Calculus）是求解大素数域上离散对数问题的最重要算法之一，其思路与Pohlig-Hellman算法截然不同。该方法的核心思想是，通过寻找幂次与一个预先选定的“因子基”（由小素数组成）之间的关系，将非线性的离散对数问题转化为一个可以求解的线性方程组问题。通过这个练习 [@problem_id:3015903]，你将实践这一包含预计算和求解两个阶段的强大方法，领会现代计算数论中的权衡思想。", "problem": "考虑素数模 $p=101$ 的有限域 $\\mathbb{F}_{p}$。令 $G=\\mathbb{F}_{p}^{\\times}$ 表示模 $p$ 的非零剩余类乘法群，已知该群是阶为 $p-1=100$ 的循环群。令 $g=2\\in G$ 且 $h=29\\in G$。在本题中，您将执行一个指数运算法的小规模实例，以确定离散对数 $x\\in\\{0,1,\\dots,99\\}$，使得 $g^{x}\\equiv h\\pmod{p}$。\n\n仅使用以下基础要素：\n- 循环群和模素数原根的定义。\n- 循环群中离散对数 $\\log_{g}(y)$ 的定义，其特征为 $g^{\\log_{g}(y)}\\equiv y\\pmod{p}$。\n- 乘法群 $G$ 的阶为 $p-1$ 这一事实，意味着指数运算在模 $p-1$ 下进行。\n- 对于 $a,b\\in G$，同态性質 $\\log_{g}(ab)\\equiv\\log_{g}(a)+\\log_{g}(b)\\pmod{p-1}$（由群结构和离散对数的定义导出）。\n\n执行以下步骤计算离散对数 $\\log_{g}(h)$：\n\n1. 根据群阶的第一性原理，通过检验排除 $p-1$ 的真因子的必要阶条件，来证明 $g=2$ 是否是 $G$ 的一个生成元（原根）。\n2. 固定因子基 $B=\\{2,3,5,7\\}$。构造形如 $g^{k}\\equiv\\prod_{q\\in B}q^{e_{q}}\\pmod{p}$ 的明確关系，其中右侧是 $B$-光滑的（即其素因子都在 $B$ 中）。每个这样的关系都会产生一个关于未知数 $\\{\\log_{g}(q)\\}_{q\\in B}$ 的模 $p-1$ 的线性同余方程。\n3. 使用您构造的关系求解至少 $q\\in\\{3,5,7\\}$ 的 $\\log_{g}(q)$（注意，根据底的定义，$\\log_{g}(2)=1$）。\n4. 找到一个小的指数 $t$ 使得 $h\\cdot g^{t}$ 是 $B$-光滑的。利用群同态性質将 $\\log_{g}(h)$ 与已知的 $\\log_{g}(q)$ 值和 $t$ 关联起来。\n5. 以精确形式给出整数 $x=\\log_{g}(h)$。不需要四舍五入。\n\n您的最终答案必须是一个精确形式的单个整数。不涉及单位。", "solution": "该问题是计算数论中一个定义明确的练习，具体涉及离散对数问题。所有给定条件一致，且问题在科学上成立、客观且适定。因此，该问题被视为有效，并将提供解答。\n\n问题要求在乘法群 $G = \\mathbb{F}_{101}^{\\times}$ 中求出 $g=2$ 且 $h=29$ 时的离散对数 $x = \\log_{g}(h)$ 。模为素数 $p=101$，因此该群是阶为 $p-1=100$ 的循环群。$x$ 的值必须是集合 $\\{0, 1, \\dots, 99\\}$ 中的一个整数。我们遵循问题中概述的步骤。\n\n**步骤 1：证明 $g=2$ 是一个生成元**\n\n要证明 $g=2$ 是 $G=\\mathbb{F}_{101}^{\\times}$ 的一个生成元（原根），我们必须证明它的阶是 $|G|=p-1=100$。根据拉格朗日定理，任何元素的阶必须整除群的阶。要证明阶恰好是 $100$，只需證明对于 $100$ 的每個素因數 $q$，都有 $g^{100/q} \\not\\equiv 1 \\pmod{101}$。\n\n$100$ 的素因子分解是 $100 = 2^2 \\cdot 5^2$。不同的素因子是 $q=2$ 和 $q=5$。我们必须检查两个条件：\n1. $2^{100/2} \\equiv 2^{50} \\not\\equiv 1 \\pmod{101}$\n2. $2^{100/5} \\equiv 2^{20} \\not\\equiv 1 \\pmod{101}$\n\n我们计算 $2$ 的这些次幂模 $101$ 的值：\n$2^1 = 2$\n$2^2 = 4$\n$2^3 = 8$\n$2^4 = 16$\n$2^5 = 32$\n$2^6 = 64$\n$2^7 = 128 \\equiv 27 \\pmod{101}$\n$2^{10} = 2^3 \\cdot 2^7 \\equiv 8 \\cdot 27 = 216 = 2 \\cdot 101 + 14 \\equiv 14 \\pmod{101}$\n\n利用这个结果，我们计算 $2^{20}$：\n$2^{20} = (2^{10})^2 \\equiv 14^2 = 196 = 196 - 101 = 95 \\pmod{101}$。\n由于 $95 \\not\\equiv 1 \\pmod{101}$，第二个条件满足。\n\n接下来，我們計算 $2^{50}$：\n$2^{50} = (2^{20})^2 \\cdot 2^{10} \\equiv 95^2 \\cdot 14 \\pmod{101}$。\n$95 \\equiv -6 \\pmod{101}$，所以 $95^2 \\equiv (-6)^2 = 36 \\pmod{101}$。\n$2^{50} \\equiv 36 \\cdot 14 = 504 \\pmod{101}$。\n$504 = 4 \\cdot 101 + 100$，所以 $504 \\equiv 100 \\pmod{101}$。\n由于 $100 \\not\\equiv 1 \\pmod{101}$，第一个条件也满足。\n\n两个条件都成立，所以 $g=2$ 的阶是 $100$。因此，$g=2$ 是 $\\mathbb{F}_{101}^{\\times}$ 的一个生成元。\n\n**步骤 2：构造线性关系**\n\n我们使用因子基 $B=\\{2,3,5,7\\}$ 来寻找关系。我们搜索 $g=2$ 的次幂中模 $101$ 是 $B$-光滑的数。设 $\\log_2(q)$ 表示以 $2$ 为底 $q$ 的离散对数。\n每个关系 $g^k \\equiv \\prod_{q \\in B} q^{e_q} \\pmod{101}$ 都会产生一个线性同余方程 $k \\equiv \\sum_{q \\in B} e_q \\log_2(q) \\pmod{100}$。\n\n根据定义，$\\log_2(2) = 1$。\n我们通过计算 $2$ 的次幂来搜索关系：\n- $2^7 \\equiv 27 = 3^3 \\pmod{101}$。取以 2 为底的对数，得到：\n$7 \\equiv 3 \\log_2(3) \\pmod{100}$。（关系 1）\n- $2^9 \\equiv 108 \\equiv 7 \\pmod{101}$。取以 2 为底的对数，得到：\n$9 \\equiv \\log_2(7) \\pmod{100}$。（关系 2）\n- $2^{17} = 2^{10} \\cdot 2^7 \\equiv 14 \\cdot 27 = 378 = 3 \\cdot 101 + 75 \\equiv 75 = 3 \\cdot 5^2 \\pmod{101}$。取以 2 为底的对数，得到：\n$17 \\equiv \\log_2(3) + 2 \\log_2(5) \\pmod{100}$。（关系 3）\n- 为了得到另一个关系，我们寻找一个与 $5$ 的次幂同余的 $2$ 的次幂。从我们之前的计算 $2^{20} \\equiv 95 \\pmod{101}$，我们可以找到 $2^{24}$：\n$2^{24} = 2^{20} \\cdot 2^4 \\equiv 95 \\cdot 16 \\equiv (-6) \\cdot 16 = -96 \\equiv 5 \\pmod{101}$。取以 2 为底的对数，得到：\n$24 \\equiv \\log_2(5) \\pmod{100}$。（关系 4）\n\n**步骤 3：求解因子基的离散对数**\n\n我们有一个关于未知数 $\\log_2(3)$、$\\log_2(5)$ 和 $\\log_2(7)$ 的线性同余方程组。\n从关系 2：\n$\\log_2(7) \\equiv 9 \\pmod{100}$。\n\n从关系 4：\n$\\log_2(5) \\equiv 24 \\pmod{100}$。\n\n现在我们使用关系 1 來求 $\\log_2(3)$：\n$3 \\log_2(3) \\equiv 7 \\pmod{100}$。\n为了解出 $\\log_2(3)$，我们需要找到 $3$ 模 $100$ 的乘法逆元。使用扩展欧几里得算法：\n$100 = 33 \\cdot 3 + 1 \\implies 1 = 100 - 33 \\cdot 3$。\n这表示 $-33 \\cdot 3 \\equiv 1 \\pmod{100}$。由于 $-33 \\equiv 67 \\pmod{100}$，所以 $3$ 的逆元是 $67$。\n將同餘方程兩邊乘以 $67$：\n$\\log_2(3) \\equiv 7 \\cdot 67 \\pmod{100}$。\n$7 \\cdot 67 = 469$。\n$469 = 4 \\cdot 100 + 69$，所以 $\\log_2(3) \\equiv 69 \\pmod{100}$。\n\n我们可以使用关系 3 来验证這些值：\n$\\log_2(3) + 2 \\log_2(5) \\equiv 69 + 2(24) = 69 + 48 = 117 \\equiv 17 \\pmod{100}$。\n这与关系 $17 \\equiv \\log_2(3) + 2 \\log_2(5) \\pmod{100}$ 一致。\n\n因子基元素的离散对数是：\n$\\log_2(2) = 1$\n$\\log_2(3) = 69$\n$\\log_2(5) = 24$\n$\\log_2(7) = 9$\n\n**步骤 4：求解 $h=29$ 的离散对数**\n\n我们现在寻找一个小的整数指数 $t$，使得 $h \\cdot g^t = 29 \\cdot 2^t$ 模 $101$ 是 $B$-光滑的。\n- 对于 $t=0$：$29 \\cdot 2^0 = 29$。不是 $B$-光滑的。\n- 对于 $t=1$：$29 \\cdot 2^1 = 58$。不是 $B$-光滑的。\n- 对于 $t=2$：$29 \\cdot 2^2 = 29 \\cdot 4 = 116$。模 $101$，这是 $116 - 101 = 15$。\n$15 = 3 \\cdot 5$。这是 $B$-光滑的。\n\n所以我们有关系 $29 \\cdot 2^2 \\equiv 3 \\cdot 5 \\pmod{101}$。\n应用对数同态性质 $\\log_g(ab) \\equiv \\log_g(a) + \\log_g(b) \\pmod{p-1}$：\n$\\log_2(29 \\cdot 2^2) \\equiv \\log_2(3 \\cdot 5) \\pmod{100}$\n$\\log_2(29) + \\log_2(2^2) \\equiv \\log_2(3) + \\log_2(5) \\pmod{100}$\n令 $x = \\log_2(29)$。该同余方程变为：\n$x + 2 \\equiv \\log_2(3) + \\log_2(5) \\pmod{100}$\n\n**步骤 5：计算 $x$ 的最终值**\n\n代入我们在步骤 3 中找到的值：\n$x + 2 \\equiv 69 + 24 \\pmod{100}$\n$x + 2 \\equiv 93 \\pmod{100}$\n$x \\equiv 93 - 2 \\pmod{100}$\n$x \\equiv 91 \\pmod{100}$\n\n所求的离散对数是 $x=91$。我们可以验证这个结果：我们必须检查是否 $2^{91} \\equiv 29 \\pmod{101}$。根据费马小定理，$2^{100} \\equiv 1 \\pmod{101}$。\n$2^{91} \\equiv 2^{-9} \\pmod{101}$。我们之前计算过 $2^9 \\equiv 7 \\pmod{101}$。所以我们需要计算 $7^{-1} \\pmod{101}$。再次对 $101$ 和 $7$ 使用扩展欧几里得算法：\n$101 = 14 \\cdot 7 + 3$\n$7 = 2 \\cdot 3 + 1$\n$1 = 7 - 2 \\cdot 3 = 7 - 2(101 - 14 \\cdot 7) = 7 - 2 \\cdot 101 + 28 \\cdot 7 = 29 \\cdot 7 - 2 \\cdot 101$。\n因此，$29 \\cdot 7 \\equiv 1 \\pmod{101}$，这意味着 $7^{-1} \\equiv 29 \\pmod{101}$。\n因此，$2^{91} \\equiv 2^{-9} \\equiv (2^9)^{-1} \\equiv 7^{-1} \\equiv 29 \\pmod{101}$。解答正确。", "answer": "$$\\boxed{91}$$", "id": "3015903"}]}