{"hands_on_practices": [{"introduction": "在解析数论中，理论与实践密不可分。第一个练习将带领我们解决一个经典问题：狄利克雷除数问题。这个练习不仅是应用狄利克雷双曲线方法来计算除数函数 $\\tau(n)$ 平均阶的绝佳范例 [@problem_id:3008370]，它还将几何计数问题（双曲线下的格点）与数论求和联系起来，并揭示了欧拉-马斯刻若尼常数 $\\gamma$ 在渐近公式中的自然出现。", "problem": "令 $\\tau(n)$ 表示除数函数，对于每个正整数 $n$ 定义为 $\\tau(n) = \\sum_{d \\mid n} 1$。对于实数参数 $x \\geq 2$，考虑求和函数 $T(x) = \\sum_{n \\leq x} \\tau(n)$。仅从狄利克雷卷积恒等式 $\\tau = 1 * 1$ 和将 $T(x)$ 表示为双曲线下整格点计数的表示法出发，使用对称分割参数的双曲线法推导 $T(x)$ 的渐近展开式。该展开式应包含一个与 $x \\ln x$ 成正比的主项，一个与 $x$ 成正比的附加项（其常数必须明确确定），以及一个阶为 $O(\\sqrt{x})$ 的误差项。在您的推导中，精确指出欧拉-马斯刻若尼常数 $\\gamma$（由极限 $\\gamma = \\lim_{N \\to \\infty} \\left(\\sum_{n=1}^{N} \\frac{1}{n} - \\ln N\\right)$ 定义）是如何通过调和级数的渐近性质引入的。您的最终答案必须是关于 $x$、$ \\ln x$ 和 $\\gamma$ 的单个闭式解析表达式，其误差项的阶为 $O(\\sqrt{x})$。", "solution": "首先对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n- 除数函数定义为 $\\tau(n) = \\sum_{d \\mid n} 1$，其中 $n$ 是正整数。\n- 求和函数为 $T(x) = \\sum_{n \\leq x} \\tau(n)$，其中 $x \\geq 2$ 是实数参数。\n- 推导必须从狄利克雷卷积恒等式 $\\tau = 1 * 1$ 开始。\n- 使用的方法是带有对称分割参数的双曲线法。\n- 期望结果是 $T(x)$ 的一个渐近展开式，包含一个与 $x \\ln x$ 成正比的主项，一个与 $x$ 成正比的附加项，以及一个阶为 $O(\\sqrt{x})$ 的误差项。\n- 必须明确指出欧拉-马斯刻若尼常数 $\\gamma = \\lim_{N \\to \\infty} \\left(\\sum_{n=1}^{N} \\frac{1}{n} - \\ln N\\right)$ 在推导中的作用。\n\n### 步骤2：使用提取的已知条件进行验证\n这是一个解析数论中的经典练习题，称为狄利克雷除数问题。\n- **科学性基础：** $\\tau(n)$、$T(x)$ 和 $\\gamma$ 的定义是标准的且数学上是正确的。双曲线法是该领域的一项基本技术。所要求的渐近公式是一个公认的结果。该问题牢固地建立在数学原理之上。\n- **适定性：** 问题陈述清晰，为唯一且有意义的推导提供了所有必要的定义和约束。它要求通过特定路径得出一个已知结果，这是一项适定的任务。\n- **客观性：** 语言正式、精确，没有任何主观或模棱两可的术语。\n\n### 步骤3：结论与行动\n问题是有效的，因为它在数学上是合理的、适定的和客观的。我们可以继续进行求解。\n\n### 推导过程\n问题是求 $T(x) = \\sum_{n \\leq x} \\tau(n)$ 的渐近公式。\n我们首先使用 $\\tau(n)$ 的定义来重新表达 $T(x)$。条件 $d \\mid n$ 可以写成 $n=dk$，其中 $k$ 为某个整数。\n$$T(x) = \\sum_{n=1}^{\\lfloor x \\rfloor} \\tau(n) = \\sum_{n=1}^{\\lfloor x \\rfloor} \\sum_{d|n} 1 = \\sum_{dk \\leq x, d\\geq 1, k\\geq 1} 1$$\n这个和式表示在 $dk$ 平面第一象限中，位于双曲线 $dk = x$ 上或其下方的整格点 $(d,k)$ 的数量。这种解释引出了“双曲线法”。\n\n狄利克雷双曲线法通过分割求和区域来计算这个和。问题指定了对称分割参数，这意味着我们应该在 $d = k = \\sqrt{x}$ 处分割区域。\n满足 $dk \\leq x$ 的点集 $(d,k)$ 可以被两个重叠区域的并集所覆盖：\n1. $d \\leq \\sqrt{x}$ 的区域，即 $1 \\leq d \\leq \\lfloor\\sqrt{x}\\rfloor$。对于每个这样的 $d$，$k$ 的取值范围是从 $1$ 到 $\\lfloor x/d \\rfloor$。\n2. $k \\leq \\sqrt{x}$ 的区域，即 $1 \\leq k \\leq \\lfloor\\sqrt{x}\\rfloor$。对于每个这样的 $k$，$d$ 的取值范围是从 $1$ 到 $\\lfloor x/k \\rfloor$。\n\n根据容斥原理，总点数是这两个区域中点数的总和减去它们交集中点数。交集是 $d \\leq \\sqrt{x}$ 和 $k \\leq \\sqrt{x}$ 同时成立的正方形区域，即 $1 \\leq d,k \\leq \\lfloor\\sqrt{x}\\rfloor$。\n因此，$T(x)$可以写成：\n$$T(x) = \\sum_{d=1}^{\\lfloor\\sqrt{x}\\rfloor} \\sum_{k=1}^{\\lfloor x/d \\rfloor} 1 + \\sum_{k=1}^{\\lfloor\\sqrt{x}\\rfloor} \\sum_{d=1}^{\\lfloor x/k \\rfloor} 1 - \\sum_{d=1}^{\\lfloor\\sqrt{x}\\rfloor} \\sum_{k=1}^{\\lfloor\\sqrt{x}\\rfloor} 1$$\n前两个和是相同的，因为我们可以简单地将求和指标 $k$ 重新标记为 $d$。第三个和是正方形的面积。\n$$T(x) = 2 \\sum_{d=1}^{\\lfloor\\sqrt{x}\\rfloor} \\left\\lfloor\\frac{x}{d}\\right\\rfloor - \\left(\\lfloor\\sqrt{x}\\rfloor\\right)^2$$\n我们来分析每一项。令 $N = \\lfloor\\sqrt{x}\\rfloor$。\n\n首先，我们分析和式 $\\sum_{d=1}^{N} \\lfloor x/d \\rfloor$。我们使用性质 $\\lfloor z \\rfloor = z - \\{z\\}$，其中 $\\{z\\}$ 是 $z$ 的小数部分，且 $0 \\leq \\{z\\} < 1$。\n$$\\sum_{d=1}^{N} \\left\\lfloor\\frac{x}{d}\\right\\rfloor = \\sum_{d=1}^{N} \\left(\\frac{x}{d} - \\left\\{\\frac{x}{d}\\right\\}\\right) = x \\sum_{d=1}^{N} \\frac{1}{d} - \\sum_{d=1}^{N} \\left\\{\\frac{x}{d}\\right\\}$$\n该表达式的第二部分 $\\sum_{d=1}^{N} \\{x/d\\}$ 是一个误差项。由于 $0 \\leq \\{x/d\\} < 1$，其和是有界的：\n$$0 \\leq \\sum_{d=1}^{N} \\left\\{\\frac{x}{d}\\right\\} < \\sum_{d=1}^{N} 1 = N = \\lfloor\\sqrt{x}\\rfloor \\leq \\sqrt{x}$$\n因此，$\\sum_{d=1}^{N} \\{x/d\\} = O(\\sqrt{x})$。\n\n现在我们关注主项 $x \\sum_{d=1}^{N} \\frac{1}{d}$。调和级数的渐近行为由下式给出：\n$$\\sum_{d=1}^{N} \\frac{1}{d} = \\ln N + \\gamma + O\\left(\\frac{1}{N}\\right)$$\n这正是欧拉-马斯刻若尼常数 $\\gamma$ 进入推导的地方，符合题目要求。\n我们有 $N = \\lfloor\\sqrt{x}\\rfloor = \\sqrt{x} - \\{\\sqrt{x}\\}$。$N$ 的对数为：\n$$\\ln N = \\ln\\left(\\sqrt{x} - \\{\\sqrt{x}\\}\\right) = \\ln\\left(\\sqrt{x}\\left(1 - \\frac{\\{\\sqrt{x}\\}}{\\sqrt{x}}\\right)\\right) = \\ln(\\sqrt{x}) + \\ln\\left(1 - \\frac{\\{\\sqrt{x}\\}}{\\sqrt{x}}\\right)$$\n由于 $0 \\leq \\{\\sqrt{x}\\} < 1$，项 $\\{\\sqrt{x}\\}/\\sqrt{x}$ 是 $O(1/\\sqrt{x})$。使用泰勒展开 $\\ln(1-u) = -u + O(u^2)$，我们得到：\n$$\\ln\\left(1 - \\frac{\\{\\sqrt{x}\\}}{\\sqrt{x}}\\right) = O\\left(\\frac{1}{\\sqrt{x}}\\right)$$\n因此，$\\ln N = \\ln(\\sqrt{x}) + O(1/\\sqrt{x}) = \\frac{1}{2}\\ln x + O(1/\\sqrt{x})$。\n\n将此代入调和级数近似式：\n$$\\sum_{d=1}^{N} \\frac{1}{d} = \\left(\\frac{1}{2}\\ln x + O\\left(\\frac{1}{\\sqrt{x}}\\right)\\right) + \\gamma + O\\left(\\frac{1}{\\lfloor\\sqrt{x}\\rfloor}\\right) = \\frac{1}{2}\\ln x + \\gamma + O\\left(\\frac{1}{\\sqrt{x}}\\right)$$\n现在我们可以计算我们主项的第一部分：\n$$x \\sum_{d=1}^{N} \\frac{1}{d} = x\\left(\\frac{1}{2}\\ln x + \\gamma + O\\left(\\frac{1}{\\sqrt{x}}\\right)\\right) = \\frac{1}{2}x\\ln x + \\gamma x + O(\\sqrt{x})$$\n将其与小数部分的误差结合起来，我们有：\n$$\\sum_{d=1}^{N} \\left\\lfloor\\frac{x}{d}\\right\\rfloor = \\left(\\frac{1}{2}x\\ln x + \\gamma x + O(\\sqrt{x})\\right) - O(\\sqrt{x}) = \\frac{1}{2}x\\ln x + \\gamma x + O(\\sqrt{x})$$\n因此，$T(x)$ 表达式中第一项的总贡献为：\n$$2 \\sum_{d=1}^{\\lfloor\\sqrt{x}\\rfloor} \\left\\lfloor\\frac{x}{d}\\right\\rfloor = 2\\left(\\frac{1}{2}x\\ln x + \\gamma x + O(\\sqrt{x})\\right) = x\\ln x + 2\\gamma x + O(\\sqrt{x})$$\n接下来，我们分析 $T(x)$ 表达式中的第二项，即 $(\\lfloor\\sqrt{x}\\rfloor)^2$。\n$$\\left(\\lfloor\\sqrt{x}\\rfloor\\right)^2 = \\left(\\sqrt{x} - \\{\\sqrt{x}\\}\\right)^2 = (\\sqrt{x})^2 - 2\\sqrt{x}\\{\\sqrt{x}\\} + (\\{\\sqrt{x}\\})^2$$\n$$= x - 2\\sqrt{x}\\{\\sqrt{x}\\} + \\{\\sqrt{x}\\}^2$$\n由于 $0 \\leq \\{\\sqrt{x}\\} < 1$，项 $2\\sqrt{x}\\{\\sqrt{x}\\}$ 是 $O(\\sqrt{x})$，而 $(\\{\\sqrt{x}\\})^2$ 是 $O(1)$。因此：\n$$\\left(\\lfloor\\sqrt{x}\\rfloor\\right)^2 = x + O(\\sqrt{x})$$\n最后，我们将这两项的渐近形式代回到 $T(x)$ 的方程中：\n$$T(x) = \\left(x \\ln x + 2\\gamma x + O(\\sqrt{x})\\right) - \\left(x + O(\\sqrt{x})\\right)$$\n合并主项和误差项，得到最终的渐近展开式：\n$$T(x) = x \\ln x + (2\\gamma)x - x + O(\\sqrt{x})$$\n$$T(x) = x \\ln x + (2\\gamma - 1)x + O(\\sqrt{x})$$\n该表达式有一个与 $x \\ln x$ 成正比的主项，一个与 $x$ 成正比且常数为 $(2\\gamma - 1)$ 的第二项，以及一个阶为 $O(\\sqrt{x})$ 的误差项，符合要求。", "answer": "$$\\boxed{x \\ln x + (2\\gamma - 1)x + O(\\sqrt{x})}$$", "id": "3008370"}, {"introduction": "上一个练习展示了对称分割的双曲线方法的威力，但理解其为何有效至关重要。本练习将深入探讨双曲线方法的核心机制，通过引入一个可变参数 $y$ 来分割求和区域 [@problem_id:3008401]。你的任务是通过最小化误差项来确定 $y$ 的最优选择，从而从根本上理解对称分割（即取 $y = \\sqrt{x}$）的合理性。", "problem": "令 $\\tau(n)$ 表示整数 $n$ 的正因数个数，并定义求和函数 $S(x) = \\sum_{n \\leq x} \\tau(n)$，其中实数 $x \\geq 1$。从 $\\tau(n)$ 的核心定义、恒等式 $\\tau(n) = \\sum_{d \\mid n} 1$ 以及表达式 $S(x) = \\sum_{ab \\leq x} 1$ 出发，应用狄利克雷双曲线法，并使用一个满足 $1 \\leq y \\leq x$ 的分割参数 $y$。仅使用取整函数的性质和欧拉-麦克劳林求和公式（EMS）等基本工具，推导出一个用 $y$ 表示的关于 $S(x)$ 的精确双曲线恒等式，然后用连续近似代替离散和，以获得一个显式的主项和一个误差项，该误差项的界用 $y$ 和 $x$ 表示。证明该误差项界的主要贡献可取 $y + x/y$ 的形式，并确定使此界最小化的 $y$ 的选择（允许 $y$ 依赖于 $x$）。你的最终答案必须是作为 $x$ 的函数的最优 $y$ 的表达式。不需要舍入。", "solution": "问题陈述已经过严格验证，并被认定为有效。这是一个解析数论中定义明确的问题，没有科学或逻辑上的缺陷。\n\n令 $\\tau(n)$ 为整数 $n$ 的正因数个数。求和函数定义为 $S(x) = \\sum_{1 \\le n \\le x} \\tau(n)$，其中实数 $x \\ge 1$。\n\n$\\tau(n)$ 的定义可以写成 $\\tau(n) = \\sum_{d|n} 1$，其中求和遍历 $n$ 的所有正因数 $d$。将此代入 $S(x)$ 的定义中得到：\n$$S(x) = \\sum_{1 \\le n \\le x} \\sum_{d|n} 1$$\n我们可以改变求和顺序。如果 $d|n$ 且 $n \\le x$，则整数对 $(d, k)$ 对和有贡献。记 $n=dk$，这等价于条件 $dk \\le x$。因此，我们是在计算乘积小于或等于 $x$ 的正整数对 $(d, k)$ 的数量。\n$$S(x) = \\sum_{dk \\le x} 1$$\n这等于第一象限中双曲线 $uv = x$ 下方的整数格点数。\n\n狄利克雷双曲线法提供了一种计算这些点的方法。我们引入一个实数参数 $y$，满足 $1 \\le y \\le x$。将满足 $dk \\le x$ 的点 $(d, k)$ 所在的区域进行分割。这组点可以描述为两个重叠集合的并集：\n1.  集合A：点 $(d, k)$ 满足 $d \\le y$ 且 $dk \\le x$。\n2.  集合B：点 $(d, k)$ 满足 $k \\le y$ 且 $dk \\le x$。\n这不是最直接的方法。一个更清晰的划分是分割一个变量的定义域。为清楚起见，我们将求和变量重命名为 $a$ 和 $b$：$S(x) = \\sum_{ab \\le x} 1$。我们将 $a > 0, b > 0$ 的区域 $ab \\le x$ 分割成两个不相交的区域：\n1.  区域1：$a \\le y$ 且 $ab \\le x$。\n2.  区域2：$a > y$ 且 $ab \\le x$。\n\n区域1中的点数为 $\\sum_{a=1}^{\\lfloor y \\rfloor} \\sum_{b=1}^{\\lfloor x/a \\rfloor} 1 = \\sum_{a=1}^{\\lfloor y \\rfloor} \\lfloor \\frac{x}{a} \\rfloor$。\n对于区域2，因为 $a>y$，所以有 $b \\le x/a < x/y$。因此，我们可以先对 $b$ 求和。区域2中的点数为 $\\sum_{b=1}^{\\lfloor x/y \\rfloor} \\sum_{a=\\lfloor y \\rfloor+1}^{\\lfloor x/b \\rfloor} 1 = \\sum_{b=1}^{\\lfloor x/y \\rfloor} (\\lfloor \\frac{x}{b} \\rfloor - \\lfloor y \\rfloor)$。\n将这两个不相交区域的点数相加，得到总数 $S(x)$：\n$$S(x) = \\sum_{a=1}^{\\lfloor y \\rfloor} \\left\\lfloor \\frac{x}{a} \\right\\rfloor + \\sum_{b=1}^{\\lfloor x/y \\rfloor} \\left( \\left\\lfloor \\frac{x}{b} \\right\\rfloor - \\lfloor y \\rfloor \\right)$$\n在第二个和式中将虚设变量 $b$ 改为 $k$，并展开和式：\n$$S(x) = \\sum_{k=1}^{\\lfloor y \\rfloor} \\left\\lfloor \\frac{x}{k} \\right\\rfloor + \\sum_{k=1}^{\\lfloor x/y \\rfloor} \\left\\lfloor \\frac{x}{k} \\right\\rfloor - \\sum_{k=1}^{\\lfloor x/y \\rfloor} \\lfloor y \\rfloor$$\n$$S(x) = \\sum_{k=1}^{\\lfloor y \\rfloor} \\left\\lfloor \\frac{x}{k} \\right\\rfloor + \\sum_{k=1}^{\\lfloor x/y \\rfloor} \\left\\lfloor \\frac{x}{k} \\right\\rfloor - \\lfloor y \\rfloor \\left\\lfloor \\frac{x}{y} \\right\\rfloor$$\n这就是用参数 $y$ 表示的关于 $S(x)$ 的精确双曲线恒等式。\n\n接下来，我们使用连续模拟来近似离散和。我们使用取整函数的性质 $\\lfloor z \\rfloor = z - \\{z\\}$，其中 $\\{z\\}$ 是 $z$ 的小数部分，$0 \\le \\{z\\} < 1$。\n每一项 $\\lfloor x/k \\rfloor$ 变为 $x/k - \\{x/k\\}$。将此应用于我们的恒等式：\n$$S(x) = \\sum_{k=1}^{\\lfloor y \\rfloor} \\left(\\frac{x}{k} - \\left\\{\\frac{x}{k}\\right\\}\\right) + \\sum_{k=1}^{\\lfloor x/y \\rfloor} \\left(\\frac{x}{k} - \\left\\{\\frac{x}{k}\\right\\}\\right) - (\\,y - \\{y\\}\\,)\\left(\\frac{x}{y} - \\left\\{\\frac{x}{y}\\right\\}\\right)$$\n我们将主项和误差项分组。\n$$S(x) = \\left( x \\sum_{k=1}^{\\lfloor y \\rfloor} \\frac{1}{k} + x \\sum_{k=1}^{\\lfloor x/y \\rfloor} \\frac{1}{k} - y\\frac{x}{y} \\right) + \\text{Error}$$\n误差由几个部分组成：\n$$ \\text{Error} = - \\sum_{k=1}^{\\lfloor y \\rfloor} \\left\\{\\frac{x}{k}\\right\\} - \\sum_{k=1}^{\\lfloor x/y \\rfloor} \\left\\{\\frac{x}{k}\\right\\} + y\\left\\{\\frac{x}{y}\\right\\} + \\frac{x}{y}\\{y\\} - \\{y\\}\\left\\{\\frac{x}{y}\\right\\} $$\n我们可以对这些误差项定界。由于 $0 \\le \\{z\\} < 1$：\n和式 $\\sum_{k=1}^{\\lfloor y \\rfloor} \\{x/k\\}$ 的上界为 $\\lfloor y \\rfloor$，所以它是 $O(y)$。\n和式 $\\sum_{k=1}^{\\lfloor x/y \\rfloor} \\{x/k\\}$ 的上界为 $\\lfloor x/y \\rfloor$，所以它是 $O(x/y)$。\n项 $y\\{x/y\\}$、$(x/y)\\{y\\}$ 和 $\\{y\\}\\{x/y\\}$ 分别是 $O(y)$、$O(x/y)$ 和 $O(1)$。\n因此，总误差的阶为 $O(y) + O(x/y)$。\n\n现在我们使用欧拉-麦克劳林公式对调和级数的推论来分析主项：\n$$ \\sum_{k=1}^{N} \\frac{1}{k} = \\ln(N) + \\gamma + O\\left(\\frac{1}{N}\\right) $$\n其中 $\\gamma$ 是欧拉-马斯刻若尼常数。\n令 $N_1 = \\lfloor y \\rfloor = y - \\{y\\} = y+O(1)$ 且 $N_2 = \\lfloor x/y \\rfloor = x/y - \\{x/y\\} = x/y + O(1)$。\n对于第一个和式：\n$$ \\sum_{k=1}^{\\lfloor y \\rfloor} \\frac{1}{k} = \\ln(\\lfloor y \\rfloor) + \\gamma + O\\left(\\frac{1}{y}\\right) = \\ln(y - \\{y\\}) + \\gamma + O\\left(\\frac{1}{y}\\right) = \\ln(y) + \\ln\\left(1-\\frac{\\{y\\}}{y}\\right) + \\gamma + O\\left(\\frac{1}{y}\\right) $$\n由于 $\\ln(1-u) = -u + O(u^2)$，所以 $\\ln(1-\\{y\\}/y) = O(1/y)$。因此，\n$$ \\sum_{k=1}^{\\lfloor y \\rfloor} \\frac{1}{k} = \\ln(y) + \\gamma + O\\left(\\frac{1}{y}\\right) $$\n对于第二个和式同理：\n$$ \\sum_{k=1}^{\\lfloor x/y \\rfloor} \\frac{1}{k} = \\ln\\left(\\frac{x}{y}\\right) + \\gamma + O\\left(\\frac{y}{x}\\right) $$\n将这些近似代入 $S(x)$ 的主项部分：\n$$ \\text{Main Part} = x\\left(\\ln(y) + \\gamma + O\\left(\\frac{1}{y}\\right)\\right) + x\\left(\\ln\\left(\\frac{x}{y}\\right) + \\gamma + O\\left(\\frac{y}{x}\\right)\\right) - x $$\n$$ = x\\ln(y) + \\gamma x + O\\left(\\frac{x}{y}\\right) + x(\\ln(x)-\\ln(y)) + \\gamma x + O(y) - x $$\n$$ = x\\ln(y) + \\gamma x + x\\ln(x) - x\\ln(y) + \\gamma x - x + O\\left(\\frac{x}{y}\\right) + O(y) $$\n$$ = x\\ln(x) + (2\\gamma - 1)x + O\\left(\\frac{x}{y}\\right) + O(y) $$\n将此结果与也被发现是 $O(y) + O(x/y)$ 的其他误差项合并，我们发现总误差项 $\\Delta(x)$ 的大小由一个与 $y + x/y$ 成正比的量界定。\n$$ S(x) = x\\ln(x) + (2\\gamma - 1)x + \\Delta(x) $$\n其中对于某个正常数 $C$，有 $|\\Delta(x)| \\le C \\left(y + \\frac{x}{y}\\right)$。问题指出误差界的主要贡献可以取 $y + x/y$ 的形式，我们的推导证实了这一点。\n\n最后的任务是找到使该误差界最小的 $y$ 值。设误差界函数为 $E(y) = y + \\frac{x}{y}$。我们想要找到当 $y \\in [1, x]$ 时 $E(y)$ 的最小值。我们将 $y$ 视为连续变量并使用微积分。\n我们计算 $E(y)$ 关于 $y$ 的导数：\n$$ \\frac{dE}{dy} = \\frac{d}{dy}\\left(y + \\frac{x}{y}\\right) = 1 - \\frac{x}{y^2} $$\n为找到临界点，我们将导数设为零：\n$$ 1 - \\frac{x}{y^2} = 0 \\implies y^2 = x $$\n由于 $y$ 必须为正，唯一的临界点是 $y = \\sqrt{x}$。\n为确认这是一个最小值，我们检查二阶导数：\n$$ \\frac{d^2E}{dy^2} = \\frac{d}{dy}\\left(1 - xy^{-2}\\right) = -x(-2y^{-3}) = \\frac{2x}{y^3} $$\n对于 $x \\ge 1$ 和 $y > 0$，二阶导数为正，这表明 $y = \\sqrt{x}$ 对应一个局部最小值。\n为 $y$ 指定的范围是 $1 \\le y \\le x$。由于 $x \\ge 1$，我们有 $1 \\le \\sqrt{x} \\le x$，因此我们的最优选择 $y = \\sqrt{x}$ 位于有效定义域内。这个选择平衡了误差项的两个分量，使它们的大小相等：$y = x/y = \\sqrt{x}$。\n\n作为 $x$ 的函数，使误差界最小化的最优 $y$ 选择是 $y=\\sqrt{x}$。", "answer": "$$\\boxed{\\sqrt{x}}$$", "id": "3008401"}, {"introduction": "除了双曲线方法，阿贝尔求和（或称分部求和）是解析数论中另一个基石性的工具。这个练习将展示其强大的分析能力：如何利用一个已知和函数 $A(x) = \\sum_{n \\leq x} a_n$ 的渐近行为，来推导一个相关加权和的渐近公式 [@problem_id:3008371]。这体现了渐近分析的“微积分”思想，即将一个结果转化为另一个结果，是处理数论函数求和时不可或缺的技巧。", "problem": "设 $\\{a_{n}\\}_{n\\geq 1}$ 为一个算术函数，其求和函数定义为 $A(x)=\\sum_{n\\leq x}a_{n}$，其中实数 $x\\geq 1$。假设存在实常数 $B$ 和实指数 $\\theta$（其中 $0<\\theta<1$），使得当 $x\\to\\infty$ 时，渐近关系式\n$$\nA(x)=x\\,\\ln x + B\\,x + O\\!\\left(x^{\\theta}\\right)\n$$\n成立，其中朗道符号 $O(\\cdot)$ 满足其通常的含义：$F(x)=O(G(x))$ 意味着存在常数 $C>0$ 和 $x_{0}\\geq 1$，使得对于所有 $x\\geq x_{0}$，都有 $|F(x)|\\leq C\\,|G(x)|$。使用 Abel 求和法，确定加权和\n$$\nS(x)=\\sum_{n\\leq x}\\frac{a_{n}}{n}\n$$\n的渐近行为，精确到当 $x\\to\\infty$ 时消失的项，并将有限常数项完全用 $A(x)$ 表示。你的最终表达式必须是单个闭式解析表达式，仅依赖于 $x$、$B$ 和 $A$，且不得包含大O符号。不需要进行数值舍入。", "solution": "用户希望找到加权和 $S(x)=\\sum_{n\\leq x}\\frac{a_{n}}{n}$ 的渐近行为。\n\n### 第 1 步：问题验证\n\n该问题是解析数论中的一个标准练习，具体涉及应用 Abel 求和公式来推导渐近估计。\n\n**已知条件：**\n1.  一个算术函数 $\\{a_{n}\\}_{n\\geq 1}$。\n2.  其求和函数 $A(x)=\\sum_{n\\leq x}a_{n}$，其中 $x\\geq 1$。\n3.  当 $x\\to\\infty$ 时，渐近关系式 $A(x)=x\\,\\ln x + B\\,x + O(x^{\\theta})$ 成立，其中 $B$ 是一个实常数且 $0<\\theta<1$。\n4.  需要分析的加权和是 $S(x)=\\sum_{n\\leq x}\\frac{a_{n}}{n}$。\n5.  要求使用的方法是 Abel 求和法。\n6.  结果必须是 $S(x)$ 的一个渐近表达式，精确到当 $x\\to\\infty$ 时消失的项。\n7.  渐近表达式中的有限常数项必须用函数 $A$ 表示。\n8.  最终表达式必须是只依赖于 $x$、$B$ 和 $A$ 的单个闭式表达式，且不含大O符号。\n\n**验证：**\n1.  **科学依据：** 该问题牢固地植根于解析数论的原理。Abel 求和公式是一个基本工具，而 $A(x)$ 的渐近形式代表了许多常见的算术函数（例如，与除数函数 $d(n)$ 或 von Mangoldt 函数 $\\Lambda(n)$ 相关）。该问题的设定在科学上是合理的。\n2.  **适定性：** 题目陈述提供了推导 $S(x)$ 唯一渐近公式所需的所有信息。目标明确，对答案形式的约束也很具体。\n3.  **客观性：** 该问题使用精确的数学语言陈述，没有任何主观或模棱两可的术语。短语“将有限常数项完全用 $A(x)$ 表示”被解释为要求通过一个涉及函数 $A$ 的表达式来定义该常数，这是该领域的标准做法。\n\n**结论：**\n该问题是有效的。这是一个解析数论中定义明确的问题，可以进行严格求解。\n\n### 第 2 步：推导渐近公式\n\n我们需要找到 $S(x) = \\sum_{n \\leq x} \\frac{a_n}{n}$ 的渐近行为。我们将使用 Abel 求和公式（也称为分部求和法）。对于一个算术函数 $a_n$，其求和函数为 $A(x) = \\sum_{n \\leq x} a_n$，以及一个连续可微函数 $f(t)$，该公式为：\n$$\n\\sum_{n \\leq x} a_n f(n) = A(x)f(x) - \\int_1^x A(t)f'(t)dt\n$$\n在我们的情况下，函数是 $f(t) = \\frac{1}{t}$。其导数为 $f'(t) = -\\frac{1}{t^2}$。函数 $f(t)$ 在 $t \\geq 1$ 上是连续可微的。将该公式应用于 $S(x)$：\n$$\nS(x) = \\sum_{n \\leq x} a_n \\frac{1}{n} = A(x) \\cdot \\frac{1}{x} - \\int_1^x A(t) \\left(-\\frac{1}{t^2}\\right) dt\n$$\n$$\nS(x) = \\frac{A(x)}{x} + \\int_1^x \\frac{A(t)}{t^2} dt \\quad (*).\n$$\n这是一个精确的恒等式。现在，我们使用给定的 $A(x)$ 的渐近公式：\n$$\nA(x) = x \\ln x + Bx + R(x),\n$$\n其中余项 $R(x)$ 的阶为 $O(x^{\\theta})$，对于某个常数 $\\theta$ 满足 $0 < \\theta < 1$。\n\n让我们分别分析方程 $(*)$ 中的两项。\n\n**第一项：** $\\frac{A(x)}{x}$\n$$\n\\frac{A(x)}{x} = \\frac{x \\ln x + Bx + R(x)}{x} = \\ln x + B + \\frac{R(x)}{x}.\n$$\n由于 $R(x) = O(x^{\\theta})$，我们有 $\\frac{R(x)}{x} = O(x^{\\theta-1})$。给定 $0 < \\theta < 1$，指数 $\\theta-1$ 是负数，因此当 $x \\to \\infty$ 时，该项消失。\n$$\n\\frac{A(x)}{x} = \\ln x + B + O(x^{\\theta-1}).\n$$\n\n**第二项：** $\\int_1^x \\frac{A(t)}{t^2} dt$\n我们将 $A(t)$ 的渐近形式代入积分中：\n$$\n\\int_1^x \\frac{A(t)}{t^2} dt = \\int_1^x \\frac{t \\ln t + Bt + R(t)}{t^2} dt = \\int_1^x \\left(\\frac{\\ln t}{t} + \\frac{B}{t}\\right) dt + \\int_1^x \\frac{R(t)}{t^2} dt.\n$$\n该积分的第一部分是初等的：\n$$\n\\int_1^x \\left(\\frac{\\ln t}{t} + \\frac{B}{t}\\right) dt = \\left[\\frac{1}{2}(\\ln t)^2\\right]_1^x + [B \\ln t]_1^x = \\frac{1}{2}(\\ln x)^2 + B \\ln x.\n$$\n现在，考虑余项的积分 $\\int_1^x \\frac{R(t)}{t^2} dt$。我们分析相应的瑕积分 $\\int_1^\\infty \\frac{R(t)}{t^2} dt$ 的收敛性。由于 $R(t) = O(t^{\\theta})$，存在常数 $C > 0$ 和 $t_0 \\geq 1$，使得对于所有 $t \\geq t_0$，都有 $|R(t)| \\leq C t^{\\theta}$。那么，对于 $T > t_0$：\n$$\n\\int_{t_0}^T \\left|\\frac{R(t)}{t^2}\\right| dt \\leq \\int_{t_0}^T \\frac{C t^{\\theta}}{t^2} dt = C \\int_{t_0}^T t^{\\theta-2} dt.\n$$\n指数是 $\\theta-2$。由于 $0 < \\theta < 1$，我们有 $-2 < \\theta-2 < -1$。因为该指数小于 $-1$，瑕积分是收敛的：\n$$\n\\int_{t_0}^\\infty t^{\\theta-2} dt = \\left[\\frac{t^{\\theta-1}}{\\theta-1}\\right]_{t_0}^\\infty = 0 - \\frac{t_0^{\\theta-1}}{\\theta-1} < \\infty.\n$$\n因此，积分 $\\int_1^\\infty \\frac{R(t)}{t^2} dt$ 收敛到一个有限常数。我们把这个常数定义为：\n$$\n\\mathcal{C}_R = \\int_1^\\infty \\frac{R(t)}{t^2} dt = \\int_1^\\infty \\frac{A(t) - t \\ln t - Bt}{t^2} dt.\n$$\n我们现在可以将积分到 $x$ 的部分写成：\n$$\n\\int_1^x \\frac{R(t)}{t^2} dt = \\int_1^\\infty \\frac{R(t)}{t^2} dt - \\int_x^\\infty \\frac{R(t)}{t^2} dt = \\mathcal{C}_R - \\int_x^\\infty \\frac{R(t)}{t^2} dt.\n$$\n尾部积分 $\\int_x^\\infty \\frac{R(t)}{t^2} dt$ 是一个消失项。对于 $x \\geq t_0$：\n$$\n\\left|\\int_x^\\infty \\frac{R(t)}{t^2} dt\\right| \\leq \\int_x^\\infty \\frac{|R(t)|}{t^2} dt \\leq C \\int_x^\\infty t^{\\theta-2} dt = C \\left[\\frac{t^{\\theta-1}}{\\theta-1}\\right]_x^\\infty = \\frac{-C}{\\theta-1}x^{\\theta-1} = O(x^{\\theta-1}).\n$$\n所以，$\\int_1^x \\frac{R(t)}{t^2} dt = \\mathcal{C}_R + O(x^{\\theta-1})$。\n\n**合并结果：**\n我们将两项的渐近展开式代回 $S(x)$ 的表达式中：\n$$\nS(x) = \\left(\\ln x + B + O(x^{\\theta-1})\\right) + \\left(\\frac{1}{2}(\\ln x)^2 + B \\ln x + \\mathcal{C}_R + O(x^{\\theta-1})\\right).\n$$\n按增长阶数递减的顺序收集各项：\n$$\nS(x) = \\frac{1}{2}(\\ln x)^2 + (B+1)\\ln x + (B + \\mathcal{C}_R) + O(x^{\\theta-1}).\n$$\n问题要求的是渐近行为，精确到当 $x\\to\\infty$ 时消失的项。由于 $\\theta-1 < 0$，项 $O(x^{\\theta-1})$ 会消失。因此，所求的表达式是：\n$$\nS(x) = \\frac{1}{2}(\\ln x)^2 + (B+1)\\ln x + B + \\mathcal{C}_R + o(1).\n$$\n常数项是 $B + \\mathcal{C}_R$。代入 $\\mathcal{C}_R$ 的定义：\n$$\n\\text{常数项} = B + \\int_1^\\infty \\frac{A(t) - t \\ln t - Bt}{t^2} dt.\n$$\n该常数用 $B$ 和一个包含函数 $A$ 的积分表示，符合要求。渐近行为的完整表达式是：\n$$\n\\frac{1}{2}(\\ln x)^2 + (B+1)\\ln x + B + \\int_1^\\infty \\frac{A(t) - t \\ln t - Bt}{t^2} dt.\n$$\n这是一个仅依赖于 $x$、$B$ 和函数 $A$ 的单个闭式解析表达式，不含大O符号，满足了问题的所有条件。", "answer": "$$\n\\boxed{\\frac{1}{2}(\\ln x)^2 + (B+1)\\ln x + B + \\int_1^\\infty \\frac{A(t) - t \\ln t - Bt}{t^2} dt}\n$$", "id": "3008371"}]}