{"hands_on_practices": [{"introduction": "希尔伯特类域扩张 $[H_K:K]$ 的次数是一个基本不变量，类域论将其等同于类数 $h_K$。本练习将引导你亲手完整地计算虚二次域 $K = \\mathbb{Q}(\\sqrt{-15})$ 的类数。通过运用闵可夫斯基界、分析素理想的分解，并求解一个范数方程，你将实践确定理想类群结构所必需的核心计算技巧。[@problem_id:3026825]", "problem": "设 $K = \\mathbb{Q}(\\sqrt{-15})$，并令 $\\mathcal{O}_{K}$ 表示 $K$ 的整数环。$K$ 的希尔伯特类域 (HCF)，记作 $H_{K}$，是 $K$ 的最大无分支阿贝尔扩张。请仅使用代数数论中的基本事实和定义，包括类群的定义、伽罗瓦群与类群的同构关系 $\\operatorname{Gal}(H_{K}/K) \\cong \\operatorname{Cl}_{K}$、二次域的判别式和整数环的概念、二次域的闵可夫斯基界，以及有理素数在二次扩张中的基本分裂定律，来确定扩张次数 $[H_{K}:K]$。\n\n你的推导过程应包括：\n- 确定判别式 $D_{K}$ 和 $\\mathcal{O}_{K}$ 的一个方便的 $\\mathbb{Z}$-基。\n- 应用针对虚二次域的闵可夫斯基界，为表示理想类所需的范数设定一个上界。\n- 确定有理素数 $2$ 在 $K$ 中的分裂行为。\n- 在 $\\mathcal{O}_{K}$ 中进行范数计算，以判断是否存在范数为 $2$ 的主理想。\n\n将你的最终答案表示为一个整数。", "solution": "问题要求计算数域 $K = \\mathbb{Q}(\\sqrt{-15})$ 的希尔伯特类域扩张的次数 $[H_{K}:K]$。\n根据类域论的基本定理，希尔伯特类域扩张的伽罗瓦群同构于数域 $K$ 的理想类群。题目中已给出此关系为 $\\operatorname{Gal}(H_{K}/K) \\cong \\operatorname{Cl}_{K}$。\n因此，扩张的次数等于伽罗瓦群的阶，而伽罗瓦群的阶又等于类群的阶，即类数 $h_{K}$。\n$$[H_{K}:K] = |\\operatorname{Gal}(H_{K}/K)| = |\\operatorname{Cl}_{K}| = h_{K}$$\n我们的任务是计算 $K = \\mathbb{Q}(\\sqrt{-15})$ 的类数 $h_{K}$。\n\n首先，我们确定二次域 $K = \\mathbb{Q}(\\sqrt{d})$（其中 $d = -15$）的判别式 $D_{K}$ 和整数环 $\\mathcal{O}_{K}$。因为 $d$ 是无平方因子数且 $d = -15 \\equiv 1 \\pmod 4$，所以判别式为 $D_{K} = d = -15$。整数环 $\\mathcal{O}_{K}$ 由 $\\mathcal{O}_{K} = \\mathbb{Z}[\\frac{1+\\sqrt{-15}}{2}]$ 给出，$\\mathcal{O}_{K}$ 的一个 $\\mathbb{Z}$-基是 $\\{1, \\frac{1+\\sqrt{-15}}{2}\\}$。\n\n接下来，我们应用闵可夫斯基界来确定生成类群所需的素理想集合。对于虚二次域，闵可夫斯基界 $M_{K}$ 指出，$\\operatorname{Cl}_{K}$ 中的每个理想类都包含一个整理想 $\\mathfrak{a}$，其范数满足 $N(\\mathfrak{a}) \\leq M_{K}$，其中\n$$M_{K} = \\frac{2}{\\pi}\\sqrt{|D_{K}|}$$\n代入判别式的值 $D_{K} = -15$：\n$$M_{K} = \\frac{2}{\\pi}\\sqrt{|-15|} = \\frac{2\\sqrt{15}}{\\pi}$$\n为了估计该值，我们使用近似值 $\\sqrt{15} \\approx 3.87$ 和 $\\pi \\approx 3.14$：\n$$M_{K} \\approx \\frac{2 \\times 3.87}{3.14} = \\frac{7.74}{3.14} \\approx 2.46$$\n由于 $M_{K} < 3$，每个理想类都由一个范数为 $1$ 或 $2$ 的整理想所代表。范数为 $1$ 的理想是平凡的（即环 $\\mathcal{O}_{K}$ 本身），代表单位类。因此，类群 $\\operatorname{Cl}_{K}$ 由范数为 $2$ 的素理想的类生成。范数为 $2$ 的素理想必然位于有理素数 $p=2$ 之上。\n\n现在我们确定有理素数 $p=2$ 在 $\\mathcal{O}_{K}$ 中的分裂行为。对于不整除判别式的奇素数 $p$，其分裂行为由勒让德符号 $(\\frac{D_K}{p})$ 决定。对于 $p=2$，其分裂行为取决于判别式模 $8$ 的值。由于 $D_K = -15 = 1 - 16 \\equiv 1 \\pmod 8$，素理想 $(2)$ 在 $\\mathcal{O}_{K}$ 中分裂成两个不同的素理想。我们用 $\\mathfrak{p}_{2}$ 和 $\\mathfrak{p}_{2}'$ 表示这两个素理想。\n$$(2) = \\mathfrak{p}_{2} \\mathfrak{p}_{2}'$$\n这些理想的范数是 $N(\\mathfrak{p}_{2}) = N(\\mathfrak{p}_{2}') = 2$。\n由于 $(2)$ 是主理想，在类群中，我们有 $[\\mathfrak{p}_{2}][\\mathfrak{p}_{2}'] = [(2)] = [1]$，其中 $[1]$ 是单位类。这意味着 $[\\mathfrak{p}_{2}'] = [\\mathfrak{p}_{2}]^{-1}$。因此，类群 $\\operatorname{Cl}_{K}$ 由单个素理想的类（例如 $[\\mathfrak{p}_{2}]$）生成。\n\n为了求出类群的阶，我们必须找到元素 $[\\mathfrak{p}_{2}]$ 的阶。这需要从判断 $\\mathfrak{p}_{2}$ 是否为主理想开始。如果一个理想由单个元素生成，则它是一个主理想。若 $\\mathfrak{p}_{2} = (\\alpha)$ 对某个 $\\alpha \\in \\mathcal{O}_{K}$ 成立，则其范数必须为 $N(\\mathfrak{p}_{2}) = |N_{K/\\mathbb{Q}}(\\alpha)| = 2$。\n$\\mathcal{O}_{K}$ 中的任意元素 $\\alpha$ 可写作 $\\alpha = \\frac{x+y\\sqrt{-15}}{2}$，其中 $x, y \\in \\mathbb{Z}$ 且 $x \\equiv y \\pmod 2$。该元素的范数为：\n$$N(\\alpha) = \\left(\\frac{x+y\\sqrt{-15}}{2}\\right)\\left(\\frac{x-y\\sqrt{-15}}{2}\\right) = \\frac{x^2 + 15y^2}{4}$$\n我们寻找方程 $N(\\alpha) = 2$ 的整数解 $(x, y)$：\n$$\\frac{x^2 + 15y^2}{4} = 2 \\implies x^2 + 15y^2 = 8$$\n我们检验 $y$ 可能的整数值：\n- 若 $y = 0$，则 $x^2 = 8$，此方程没有整数解 $x$。\n- 若 $|y| = 1$，则 $x^2 + 15 = 8$，这意味着 $x^2 = -7$，此方程没有实数解 $x$。\n- 若 $|y| \\geq 2$，则 $15y^2 \\geq 15(4) = 60 > 8$，因此没有解。\n方程 $x^2 + 15y^2 = 8$ 没有整数解。因此，在 $\\mathcal{O}_{K}$ 中不存在范数为 $2$ 的元素 $\\alpha$。这意味着理想 $\\mathfrak{p}_{2}$ 不是主理想。\n因此，它的类 $[\\mathfrak{p}_{2}]$ 在 $\\operatorname{Cl}_{K}$ 中不是单位元，这意味着 $h_{K} > 1$。\n\n元素 $[\\mathfrak{p}_{2}]$ 的阶是使得 $\\mathfrak{p}_{2}^n$ 为主理想的最小正整数 $n$。我们来检验 $n=2$ 的情况。我们需要确定 $\\mathfrak{p}_{2}^2$ 是否为主理想。如果是，比如说 $\\mathfrak{p}_{2}^2 = (\\beta)$，那么我们必须有 $N((\\beta)) = N(\\mathfrak{p}_{2}^2) = (N(\\mathfrak{p}_{2}))^2 = 2^2 = 4$。所以我们在 $\\mathcal{O}_{K}$ 中寻找范数为 $4$ 的元素。\n这需要解丢番图方程：\n$$\\frac{x^2 + 15y^2}{4} = 4 \\implies x^2 + 15y^2 = 16$$\n其中 $x, y \\in \\mathbb{Z}$ 且 $x \\equiv y \\pmod 2$。\n- 若 $y=0$，则 $x^2=16 \\implies x=\\pm 4$。数对 $(4, 0)$ 满足 $4 \\equiv 0 \\pmod 2$。这对应于元素 $\\alpha = \\frac{4+0\\sqrt{-15}}{2} = 2$。主理想 $(2)$ 的范数为 $4$，但我们知道 $(2) = \\mathfrak{p}_2 \\mathfrak{p}_2'$，而不是 $\\mathfrak{p}_2^2$，因为 $\\mathfrak{p}_2 \\ne \\mathfrak{p}_2'$。\n- 若 $|y|=1$，则 $x^2+15 = 16 \\implies x^2=1 \\implies x=\\pm 1$。数对 $(1, 1)$、$(1, -1)$、$(-1, 1)$、$(-1, -1)$ 都满足同余式 $x \\equiv y \\pmod 2$。例如，$(x, y)=(1, 1)$ 给出元素 $\\beta = \\frac{1+\\sqrt{-15}}{2} \\in \\mathcal{O}_{K}$，其范数为 $4$。\n- 若 $|y| \\ge 2$，则 $15y^2 \\ge 60 > 16$。\n\n我们找到了一个元素 $\\beta = \\frac{1+\\sqrt{-15}}{2}$，它生成一个范数为 $4$ 的主理想 $(\\beta)$。我们来确定这个理想的素理想分解。$2$ 之上的一个素理想是 $\\mathfrak{p}_{2} = (2, \\frac{1+\\sqrt{-15}}{2})$。由于 $\\beta = \\frac{1+\\sqrt{-15}}{2}$ 是 $\\mathfrak{p}_{2}$ 的生成元之一，主理想 $(\\beta)$ 包含于 $\\mathfrak{p}_{2}$ 中。这意味着 $\\mathfrak{p}_{2}$ 整除 $(\\beta)$。\n根据理想的唯一分解定理，$(\\beta) = \\mathfrak{p}_{2} \\mathfrak{q}$，其中 $\\mathfrak{q}$ 是某个理想。取范数，我们得到 $N((\\beta)) = N(\\mathfrak{p}_{2}) N(\\mathfrak{q})$，所以 $4 = 2 \\cdot N(\\mathfrak{q})$，这意味着 $N(\\mathfrak{q})=2$。范数为 $2$ 的理想只有 $\\mathfrak{p}_2$ 和 $\\mathfrak{p}_2'$。\n所以，我们有两种可能性：$(\\beta) = \\mathfrak{p}_{2}^2$ 或 $(\\beta) = \\mathfrak{p}_{2}\\mathfrak{p}_{2}' = (2)$。\n理想 $(\\beta) = (\\frac{1+\\sqrt{-15}}{2})$ 不可能等于理想 $(2)$，因为元素 $2$ 不能写成 $\\beta$ 与 $\\mathcal{O}_{K}$ 中某个元素的乘积。实际上，如果 $2 = \\beta \\cdot \\gamma$ 对某个 $\\gamma \\in \\mathcal{O}_K$ 成立，则 $\\gamma = \\frac{2}{\\beta} = \\frac{2}{(1+\\sqrt{-15})/2} = \\frac{4}{1+\\sqrt{-15}} = \\frac{4(1-\\sqrt{-15})}{16} = \\frac{1-\\sqrt{-15}}{4}$。这个元素 $\\gamma$ 不在 $\\mathcal{O}_{K}$ 中，因为它的最小多项式是 $x^2 - \\frac{1}{2}x + 1 = 0$，其系数不是整数。\n因此，等式 $(\\beta) = (2)$ 是不成立的。\n\n唯一剩下的可能性是 $(\\beta) = \\mathfrak{p}_{2}^2$。这表明 $\\mathfrak{p}_{2}^2$ 是一个主理想。\n在类群 $\\operatorname{Cl}_{K}$ 中，这意味着 $[\\mathfrak{p}_{2}]^2 = [1]$。由于我们已经确定 $[\\mathfrak{p}_{2}] \\neq [1]$，元素 $[\\mathfrak{p}_{2}]$ 的阶恰好是 $2$。\n由于类群 $\\operatorname{Cl}_{K}$ 由 $[\\mathfrak{p}_{2}]$ 生成，它的阶是 $h_{K} = 2$。\n\n最后，希尔伯特类域扩张的次数是 $[H_{K}:K] = h_{K} = 2$。", "answer": "$$\\boxed{2}$$", "id": "3026825"}, {"introduction": "类域论的核心原理，例如使用闵可夫斯基界来约束类数，是超越二次域范畴的强大工具。本练习旨在挑战你将这些方法应用于一个新情境：一个非二次的三次代数数域。通过计算由 $\\theta^3 - \\theta - 1 = 0$ 定义的数域 $K = \\mathbb{Q}(\\theta)$ 的类数，你不仅能巩固对一般流程的理解，还将发现一个类群平凡的实例，意味着其希尔伯特类域就是其自身。[@problem_id:3026794]", "problem": "设 $K$ 是非二次数域 $K = \\mathbb{Q}(\\theta)$，其中 $\\theta$ 是不可约多项式 $f(x) = x^{3} - x - 1 \\in \\mathbb{Z}[x]$ 的一个根。请基于代数数论中的基本定义和公认事实进行推导：整数环、判别式、嵌入与记号、理想范数以及用于理想类的 Minkowski 几何数论界。确定扩张次数 $[H_{K} : K]$ 的确切值，其中 $H_{K}$ 表示 $K$ 的 Hilbert 类域 (HCF)，定义为 $K$ 的最大非分歧阿贝尔扩张。你的答案必须是一个整数，无需四舍五入。", "solution": "问题要求确定扩张次数 $[H_{K} : K]$，其中 $H_{K}$ 是数域 $K = \\mathbb{Q}(\\theta)$ 的 Hilbert 类域，而 $\\theta$ 是多项式 $f(x) = x^{3} - x - 1$ 的一个根。\n\n根据类域论的一个基本结果，Hilbert 类域扩张的伽罗瓦群同构于基域的理想类群。具体来说，Artin 映射给出了一个同构关系 $\\operatorname{Gal}(H_{K}/K) \\cong \\operatorname{Cl}(K)$。因此，扩张的次数等于伽罗瓦群的阶，而伽罗瓦群的阶又等于理想类群的阶，后者被称为类数 $h_{K}$。\n$$[H_{K} : K] = |\\operatorname{Gal}(H_{K}/K)| = |\\operatorname{Cl}(K)| = h_{K}$$\n因此，我们的任务简化为计算数域 $K = \\mathbb{Q}(\\theta)$ 的类数 $h_{K}$。\n\n首先，我们确定数域 $K$ 的基本性质。该多项式为 $f(x) = x^{3} - x - 1$，它是一个整系数多项式，即 $f(x) \\in \\mathbb{Z}[x]$。为了检验其在 $\\mathbb{Q}$ 上的不可约性，我们使用有理根定理。任何有理根都必须是常数项 $-1$ 的整数因子，因此唯一可能的有理根是 $\\pm 1$。我们在这两点计算多项式的值：\n$f(1) = 1^{3} - 1 - 1 = -1 \\neq 0$\n$f(-1) = (-1)^{3} - (-1) - 1 = -1 + 1 - 1 = -1 \\neq 0$\n由于不存在有理根，这个三次多项式 $f(x)$ 在 $\\mathbb{Q}$ 上是不可约的。域扩张 $K/\\mathbb{Q}$ 的次数等于最小多项式的次数，所以 $n = [K:\\mathbb{Q}] = 3$。\n\n接下来，我们确定域 $K$ 的记号 (signature)，即数对 $(r_{1}, r_{2})$，其中 $r_{1}$ 是实嵌入的数量，$2r_{2}$ 是复嵌入的数量。实嵌入的数量等于最小多项式 $f(x)$ 的实根数量。我们可以使用微积分来分析实根。$f(x)$ 的导数是 $f'(x) = 3x^{2} - 1$。临界点在 $f'(x) = 0$ 处，即 $x = \\pm \\frac{1}{\\sqrt{3}}$。我们计算 $f(x)$ 在这些临界点的值：\n$f\\left(\\frac{1}{\\sqrt{3}}\\right) = \\left(\\frac{1}{\\sqrt{3}}\\right)^{3} - \\frac{1}{\\sqrt{3}} - 1 = \\frac{1}{3\\sqrt{3}} - \\frac{1}{\\sqrt{3}} - 1 = -\\frac{2}{3\\sqrt{3}} - 1 < 0$\n$f\\left(-\\frac{1}{\\sqrt{3}}\\right) = \\left(-\\frac{1}{\\sqrt{3}}\\right)^{3} - \\left(-\\frac{1}{\\sqrt{3}}\\right) - 1 = -\\frac{1}{3\\sqrt{3}} + \\frac{1}{\\sqrt{3}} - 1 = \\frac{2}{3\\sqrt{3}} - 1$。由于 $4 < 27$，我们有 $2 < 3\\sqrt{3}$，这意味着 $\\frac{2}{3\\sqrt{3}} < 1$。因此，$f\\left(-\\frac{1}{\\sqrt{3}}\\right)$ 也为负。\n$f(x)$ 的局部极大值和局部极小值均为负数。当 $x \\to \\infty$ 时，$f(x) \\to \\infty$；当 $x \\to -\\infty$ 时，$f(x) \\to -\\infty$。这种形态意味着 $f(x)$ 的图像与 x 轴只相交一次。因此，$f(x)$ 有一个实根和一对共轭复根。这给出了 $r_{1} = 1$ 个实嵌入和 $2r_{2} = 2$ 个复嵌入，所以 $r_{2} = 1$。记号为 $(1, 1)$，我们验证 $n = r_{1} + 2r_{2} = 1 + 2(1) = 3$。\n\n现在我们计算数域的判别式 $d_{K}$。对于形如 $x^{3} + px + q$ 的三次多项式，其判别式由公式 $\\Delta = -4p^{3} - 27q^{2}$ 给出。对于 $f(x) = x^{3} - x - 1$，我们有 $p = -1$ 和 $q = -1$。该多项式的判别式是：\n$\\Delta_{f} = -4(-1)^{3} - 27(-1)^{2} = -4(-1) - 27(1) = 4 - 27 = -23$。\n域判别式 $d_{K}$ 与多项式判别式通过公式 $\\Delta_{f} = [\\mathcal{O}_{K} : \\mathbb{Z}[\\theta]]^{2} d_{K}$ 相关联，其中 $\\mathcal{O}_{K}$ 是 $K$ 的整数环。由于 $-23$ 是一个素数，它是无平方因子的。这意味着指数 $[\\mathcal{O}_{K} : \\mathbb{Z}[\\theta]]^{2}$ 必须为 $1$，所以 $[\\mathcal{O}_{K} : \\mathbb{Z}[\\theta]] = 1$。这意味着 $\\mathcal{O}_{K} = \\mathbb{Z}[\\theta]$，且域判别式等于多项式判别式：$d_{K} = -23$。\n\n为了求出类数 $h_{K}$，我们使用 Minkowski 界。$\\operatorname{Cl}(K)$ 中的每个理想类都包含一个整理想 $\\mathfrak{a}$，其范数 $N(\\mathfrak{a})$ 满足：\n$N(\\mathfrak{a}) \\leq M_{K} = \\left(\\frac{4}{\\pi}\\right)^{r_{2}} \\frac{n!}{n^{n}} |d_{K}|^{1/2}$。\n代入我们求得的值：$n=3$，$r_{2}=1$ 和 $d_{K}=-23$。\n$M_{K} = \\left(\\frac{4}{\\pi}\\right)^{1} \\frac{3!}{3^{3}} |-23|^{1/2} = \\frac{4}{\\pi} \\frac{6}{27} \\sqrt{23} = \\frac{4}{\\pi} \\frac{2}{9} \\sqrt{23} = \\frac{8\\sqrt{23}}{9\\pi}$。\n我们需要确定这个界是否小于 $2$。我们可以估算其值：\n$\\sqrt{23} \\approx 4.796$ 且 $\\pi \\approx 3.1416$。\n$M_{K} \\approx \\frac{8 \\times 4.796}{9 \\times 3.1416} = \\frac{38.368}{28.2744} \\approx 1.357$。\n由于 $M_{K} < 2$，这意味着每个理想类都必须包含一个范数 $N(\\mathfrak{a}) < 2$ 的整理想。范数唯一可能的整数值是 $N(\\mathfrak{a}) = 1$。\n范数为 $1$ 的唯一整理想是整数环 $\\mathcal{O}_{K}$ 本身，也就是主理想 $(1)$。\n这意味着 $\\operatorname{Cl}(K)$ 中的每个理想类都是主理想类。因此，理想类群是平凡群，$\\operatorname{Cl}(K) = \\{[\\mathcal{O}_{K}]\\}$。类群的阶，即类数，为 $h_{K} = 1$。\n\n最后，我们可以确定 Hilbert 类域扩张的次数：\n$[H_{K} : K] = h_{K} = 1$。\n这表明 $K$ 的 Hilbert 类域就是 $K$ 本身，意味着 $K$ 不存在非平凡的非分歧阿贝尔扩张。", "answer": "$$\\boxed{1}$$", "id": "3026794"}, {"introduction": "数论的核心主题之一是理解素数在域扩张中的行为。希尔伯特类域为此提供了一个优美的答案：它根据素理想所属的理想类来支配其分裂行为。本练习将这一深刻的理论关联转化为一个具体的算法 [@problem_id:3026789]。你将开发一个计算方法，用于检验一个有理素数 $p$ 是否在希尔伯特类域 $H_K$ 中完全分裂，从而将理想类群的抽象概念与求解丢番图方程的具体问题联系起来。", "problem": "给定负基本判别式 $D$ 和有理素数 $p$。令 $K = \\mathbb{Q}(\\sqrt{D})$ 为一个判别式为 $D$ 的虚二次域，并令 $H_K$ 表示其希尔伯特类域。请仅使用以下基础事实和定义来设计您的算法。\n\n1. 希尔伯特类域的定义：$H_K$ 是 $K$ 的最大无分支阿贝尔扩张。\n2. 针对希尔伯特类域的阿廷互反律：对于 $\\mathcal{O}_K$ 中位于有理素数 $p \\nmid D$ 之上的素理想 $\\mathfrak{p}$，$\\mathfrak{p}$ 在 $H_K$ 中完全分裂当且仅当 $\\mathfrak{p}$ 的理想类在类群 $\\operatorname{Cl}(\\mathcal{O}_K)$ 中是平凡的，即当且仅当 $\\mathfrak{p}$ 是主理想。\n3. 虚二次域中的二元二次型与主理想：对于判别式为 $D<0$ 的虚二次域 $K$，其理想类对应于判别式为 $D$ 的正定本原二元二次型的等价类。主理想类对应于主型\n   - 如果 $D \\equiv 0 \\pmod{4}$：$f(x,y) = x^2 + \\left(-\\frac{D}{4}\\right) y^2$。\n   - 如果 $D \\equiv 1 \\pmod{4}$：$f(x,y) = x^2 + x y + \\left(\\frac{1-D}{4}\\right) y^2$。\n   一个有理素数 $p \\nmid D$ 在 $H_K$ 中完全分裂，当且仅当 $p$ 在 $K$ 中分裂且能被判别式为 $D$ 的主型表示，即存在整数 $x,y$ 使得 $f(x,y) = p$。\n4. 在 $K$ 中的分裂情况：对于任意不整除 $D$ 的奇素数 $p$，$p$ 在 $K$ 中分裂当且仅当克罗内克符号 $\\left(\\frac{D}{p}\\right) = 1$。对于 $p=2$，应使用克罗内克符号 $\\left(\\frac{D}{2}\\right)$。\n\n任务。编写一个完整的、可运行的程序，对每个给定的数对 $(D,p)$，判断 $p$ 是否在 $H_K$ 中完全分裂。您的程序必须实现以下逻辑，不得依赖预先计算的类群或表格：\n- 如果 $p \\mid D$，输出 $\\mathrm{False}$（因为 $p$ 在 $K$ 中分歧，因此不能在 $H_K$ 中完全分裂）。\n- 计算克罗内克符号 $\\left(\\frac{D}{p}\\right)$。如果结果不为 $1$，输出 $\\mathrm{False}$。\n- 根据上述 $D \\bmod 4$ 的情况构造主型 $f(x,y)$。判断是否存在整数 $x,y$ 使得 $f(x,y)=p$。您必须利用主型的正定性，实现一个有数学依据的有界搜索。具体来说，令 $f(x,y) = x^2 + b x y + c y^2$，其中 $b \\in \\{0,1\\}$ 且 $c \\in \\mathbb{Z}_{>0}$。由于 $f$ 是正定的，对于任何解，必须有 $c y^2 \\le p$，这给出了一个界限 $|y| \\le \\left\\lfloor \\sqrt{\\frac{p}{c}} \\right\\rfloor$。对于每个这样的整数 $y$，通过求解关于 $x$ 的二次方程并检查判别式和整数解条件，来确定是否存在满足 $f(x,y)=p$ 的整数 $x$。\n\n测试套件。您的程序必须按以下确切顺序计算输入对 $(D,p)$ 的结果：\n- $(-4,5)$\n- $(-4,3)$\n- $(-20,29)$\n- $(-20,3)$\n- $(-20,5)$\n- $(-15,19)$\n- $(-15,11)$\n\n答案规格与最终输出格式：\n- 对于每个测试用例，输出必须是布尔值 $\\mathrm{True}$ 或 $\\mathrm{False}$，以指示 $p$ 是否在 $H_K$ 中完全分裂。\n- 您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表，例如 $\\mathtt{[True,False,True]}$。", "solution": "该问题要求设计一个算法，用以判断给定的有理素数 $p$ 是否在虚二次域 $K = \\mathbb{Q}(\\sqrt{D})$（其中 $D$ 是给定的负基本判别式）的希尔伯特类域 $H_K$ 中完全分裂。此解决方案必须基于一组给定的特定数论原理来构建。\n\n如问题陈述中所概述，其核心理论结果是希尔伯特类域的阿廷互反律的一个推论。该推论指出，一个不整除判别式 $D$（即 $p \\nmid D$）的有理素数 $p$ 在 $H_K$ 中完全分裂，当且仅当满足两个条件：\n1. 素数 $p$ 在基域 $K = \\mathbb{Q}(\\sqrt{D})$ 中分裂。\n2. 整数环 $\\mathcal{O}_K$ 中位于 $p$ 之上的素理想 $\\mathfrak{p}$ 是主理想。\n\n这两个条件可以转化为涉及二元二次型和克罗内克符号的、可通过计算验证的准则。该算法被设计为这些准则的直接实现。\n\n首先，我们考虑素数 $p$ 在 $K$ 中分歧的情况。这种情况发生当且仅当 $p$ 整除判别式 $D$。根据定义，无分支扩张是指没有素数在其中分歧的扩张。由于 $H_K$ 是 $K$ 的最大*无分支*阿贝尔扩张，任何在 $K$ 中分歧的素数都不可能在 $H_K$ 中完全分裂。因此，如果 $p \\mid D$，则不满足条件，算法返回 `False`。\n\n其次，对于不分歧的素数 $p$（$p \\nmid D$），我们测试它是否在 $K$ 中分裂。一个素数 $p$ 在二次域 $\\mathbb{Q}(\\sqrt{D})$ 中分裂，当且仅当克罗内克符号 $\\left(\\frac{D}{p}\\right) = 1$。如果 $\\left(\\frac{D}{p}\\right) = -1$，$p$ 在 $K$ 中是惰性的；如果 $\\left(\\frac{D}{p}\\right) = 0$，$p$ 则分歧（这种情况已处理）。如果 $p$ 不在 $K$ 中分裂，它就不可能在 $K$ 的任何扩张（包括 $H_K$）中完全分裂。因此，如果 $\\left(\\frac{D}{p}\\right) \\neq 1$，算法返回 `False`。克罗内克符号的计算方法如下：\n- 如果 $p=2$，我们使用定义：当 $D \\equiv 1, 7 \\pmod{8}$ 时 $\\left(\\frac{D}{2}\\right) = 1$，当 $D \\equiv 3, 5 \\pmod{8}$ 时 $\\left(\\frac{D}{2}\\right) = -1$。由于 $D$ 是一个基本判别式，（当 $p=2$ 且 $p \\nmid D$ 时）$D$ 必须是奇数，从而 $D \\equiv 1 \\pmod{4}$。因此，$D \\pmod 8$ 的值必为 $1$ 或 $5$。此条件简化为：若 $D \\equiv 1 \\pmod{8}$，返回 $1$；若 $D \\equiv 5 \\pmod{8}$，返回 $-1$。\n- 如果 $p$ 是奇素数，克罗内克符号 $\\left(\\frac{D}{p}\\right)$ 即为勒让德符号，可以使用欧拉准则高效计算：$\\left(\\frac{D}{p}\\right) \\equiv D^{(p-1)/2} \\pmod{p}$。如果幂次模 $p$ 等于 $1$，结果为 $1$；如果幂次模 $p$ 等于 $p-1$，结果为 $-1$。\n\n第三，如果 $p$ 在 $K$ 中分裂，我们检查主理想条件。对于虚二次域，二元二次型理论提供了一个等价准则：$p$ 上方的素理想是主理想，当且仅当 $p$ 能被判别式为 $D$ 的*主型*所表示。主型 $f(x,y)$ 是一个由 $D \\pmod{4}$ 决定的特定正定二元二次型：\n- 如果 $D \\equiv 0 \\pmod{4}$，主型为 $f(x,y) = x^2 + \\left(-\\frac{D}{4}\\right)y^2$。\n- 如果 $D \\equiv 1 \\pmod{4}$，主型为 $f(x,y) = x^2 + xy + \\left(\\frac{1-D}{4}\\right)y^2$。\n\n该型可一般地写为 $f(x,y) = ax^2 + bxy + cy^2$，其中 $a=1$。我们的任务简化为判断丢番图方程 $f(x,y) = p$ 是否有整数解 $x$ 和 $y$。由于 $D < 0$，该型是正定的，意味着对于任何非零整数对 $(x,y)$，都有 $f(x,y) > 0$。此性质允许我们进行有界搜索。为使方程 $x^2 + bxy + cy^2 = p$ 成立，必须有 $cy^2 \\le p$，这意味着 $|y| \\le \\sqrt{p/c}$。这为 $y$ 的大小提供了一个上界，因此我们只需测试 $0 \\le y \\le \\lfloor\\sqrt{p/c}\\rfloor$ 范围内的整数 $y$ 值。\n\n对于每个这样的整数 $y$，我们将方程重排为关于 $x$ 的二次方程：\n$$x^2 + (by)x + (cy^2 - p) = 0$$\n为了使 $x$ 存在整数解，该二次方程的判别式 $\\Delta_x$ 必须是一个非负的完全平方数。其判别式为：\n$$\\Delta_x = (by)^2 - 4(1)(cy^2 - p) = (b^2 - 4c)y^2 + 4p$$\n根据定义，项 $b^2 - 4c$ 是该二次型（因为 $a=1$）的判别式 $D$。因此：\n$$\\Delta_x = Dy^2 + 4p$$\n算法通过迭代 $y$ 的有效范围来执行。对于每个 $y$，计算 $v = Dy^2 + 4p$。如果 $v$ 是一个非负完全平方数，比如说 $v = k^2$（其中 $k \\ge 0$ 是某个整数），那么 $x$ 的可能解由 $x = \\frac{-by \\pm k}{2}$ 给出。为使 $x$ 为整数，分子 $(-by \\pm k)$ 必须是偶数。由于 $-by+k$ 和 $-by-k$ 的奇偶性相同，我们只需检查其中一个。如果在此搜索过程中的任何一点找到了整数解 $(x,y)$，则意味着 $p$ 可被主型表示，算法返回 `True`。\n\n如果在对所有可能的 $y$ 值进行搜索后仍未找到任何整数解 $(x,y)$，则意味着 $p$ 不能被主型表示。在这种情况下，$p$ 上方的素理想不是主理想，算法返回 `False`。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef kronecker_symbol(a, p):\n    \"\"\"\n    Computes the Kronecker symbol (a/p) where p is a prime.\n    \"\"\"\n    # The problem logic handles the p|D case separately, so we could assume a % p != 0.\n    # However, for robustness, we handle it.\n    if a % p == 0:\n        return 0\n\n    if p == 2:\n        # Since a % p != 0, a must be odd.\n        # D is a fundamental discriminant, so if odd, D must be 1 (mod 4).\n        # Therefore, D mod 8 is either 1 or 5.\n        a_mod_8 = a % 8\n        if a_mod_8 == 1 or a_mod_8 == 7:\n            return 1\n        # a_mod_8 == 3 or a_mod_8 == 5\n        return -1\n\n    # For an odd prime p, the Kronecker symbol is the Legendre symbol.\n    # We use Euler's criterion: a^((p-1)/2) mod p.\n    legendre = pow(a, (p - 1) // 2, p)\n    if legendre == p - 1:\n        return -1\n    else:\n        # Since a is not a multiple of p, the result must be 1.\n        return 1\n\ndef check_split_in_H_K(D, p):\n    \"\"\"\n    Determines if prime p splits completely in the Hilbert class field of Q(sqrt(D)).\n\n    Args:\n        D (int): A negative fundamental discriminant.\n        p (int): A rational prime.\n\n    Returns:\n        bool: True if p splits completely, False otherwise.\n    \"\"\"\n    # Step 1: Handle ramification. If p divides D, p ramifies in K.\n    # An unramified extension like H_K cannot have a prime split completely\n    # if it ramifies in the base field.\n    if D % p == 0:\n        return False\n\n    # Step 2: Check if p splits in K. This is true iff the Kronecker symbol (D/p) is 1.\n    if kronecker_symbol(D, p) != 1:\n        return False\n\n    # Step 3: If p splits in K, check if it's represented by the principal form.\n    # Construct the principal form f(x,y) = x^2 + bxy + cy^2.\n    if D % 4 == 0:\n        b = 0\n        c = -D // 4\n    elif D % 4 == 1:\n        b = 1\n        c = (1 - D) // 4\n    else:\n        # Fundamental discriminants are always 0 or 1 mod 4.\n        # This case should not be reached with valid inputs.\n        raise ValueError(\"Invalid discriminant D: must be 0 or 1 mod 4.\")\n\n    # Step 4: Perform a bounded search for integer solutions to f(x,y) = p.\n    # The form is positive definite, so cy^2 <= p, which implies |y| <= sqrt(p/c).\n    # We only need to search non-negative y.\n    y_max = int(np.sqrt(p / c))\n\n    for y in range(y_max + 1):\n        # We need to solve x^2 + (b*y)*x + (c*y^2 - p) = 0 for an integer x.\n        # The discriminant of this quadratic in x is Delta_x = D*y^2 + 4p.\n        delta_x = D * y**2 + 4 * p\n\n        if delta_x < 0:\n            continue\n        \n        # For x to be an integer, Delta_x must be a perfect square.\n        sqrt_delta_x = int(np.sqrt(delta_x))\n        if sqrt_delta_x**2 != delta_x:\n            continue\n        \n        # If it's a perfect square (k^2), solutions for x are x = (-by +/- k) / 2.\n        # Check if x is an integer. This is true if (-b*y + k) is even.\n        numerator = -b * y + sqrt_delta_x\n        if numerator % 2 == 0:\n            # An integer solution for x exists. Thus, p is represented.\n            return True\n        \n        # The two potential solutions for x have the same parity check,\n        # so checking one numerator is sufficient.\n        \n    # If the loop finishes without finding a solution, p is not represented.\n    return False\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        (-4, 5),\n        (-4, 3),\n        (-20, 29),\n        (-20, 3),\n        (-20, 5),\n        (-15, 19),\n        (-15, 11),\n    ]\n\n    results = []\n    for D, p in test_cases:\n        result = check_split_in_H_K(D, p)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # str(True) -> 'True', str(False) -> 'False'\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3026789"}]}