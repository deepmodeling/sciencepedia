{"hands_on_practices": [{"introduction": "模曲线的紧化涉及添加被称为“尖点”的无穷远点。这些尖点并非完全相同；它们通过同余子群 $\\Gamma_0(N)$ 的作用进行分类，并且每个尖点都有一个决定其局部坐标的特定“宽度”。本练习 [@problem_id:3018127] 提供了一种对 $X_0(N)$ 的尖点进行分类和计数的具体方法，这是分析这些曲线的几何结构以及模形式的 $q$-展开式的一项基本技能。", "problem": "设 $N$ 为一个正整数，令 $\\Gamma_{0}(N)$ 表示整数上二阶特殊线性群 (SL$_{2}(\\mathbb{Z})$) 的同余子群，该子群由所有满足 $c \\equiv 0 \\pmod{N}$ 的矩阵 $\\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix}$ 构成。模曲线 $X_{0}(N)$ 的尖点对应于有理射影直线 $\\mathbb{P}^{1}(\\mathbb{Q})$ 在通常分式线性作用下由 $\\Gamma_{0}(N)$ 产生的轨道集合。尖点 $\\kappa$ 的宽度定义为最小的正整数 $w$，使得对于任意满足 $\\sigma \\cdot \\infty = \\kappa$ 的矩阵 $\\sigma \\in \\mathrm{SL}_{2}(\\mathbb{Z})$，平移矩阵 $T^{w} = \\begin{pmatrix} 1 & w \\\\ 0 & 1 \\end{pmatrix}$ 位于 $\\sigma^{-1} \\Gamma_{0}(N) \\sigma$ 中。\n\n从上述基本定义以及将尖点解释为双陪集空间 $\\Gamma_{0}(N) \\backslash \\mathbb{P}^{1}(\\mathbb{Q})$ 中元素的观点出发，推导 $X_{0}(N)$ 尖点的分类方法及其宽度的计算公式。然后，对于特定水平 $N = 60$ 的情况，计算尖点的总数及其宽度的多重集。将最终答案表示为一个单行矩阵，其第一个元素是尖点的总数，其余元素是按非递减顺序排列的所有尖点的宽度。提供精确整数，无需四舍五入。", "solution": "该问题要求推导模曲线 $X_{0}(N)$ 的尖点的分类和宽度，然后对 $N = 60$ 的情况进行具体计算。\n\n### 第一部分：$\\Gamma_0(N)$ 尖点的一般理论\n\n**1. 尖点的分类**\n\n模曲线 $X_{0}(N)$ 的尖点是在同余子群 $\\Gamma_{0}(N)$ 作用下，有理射影直线 $\\mathbb{P}^{1}(\\mathbb{Q}) = \\mathbb{Q} \\cup \\{\\infty\\}$ 的等价类。该作用是分式线性变换。\n\n$\\mathbb{P}^{1}(\\mathbb{Q})$ 中的任意元素都可以写成最简分数 $\\frac{a}{c}$ 的形式，即 $\\gcd(a,c)=1$。无穷远点 $\\infty$ 被视为 $\\frac{1}{0}$。\n\n设 $\\kappa_{1} = \\frac{a_{1}}{c_{1}}$ 和 $\\kappa_{2} = \\frac{a_{2}}{c_{2}}$ 是两个尖点，且 $\\gcd(a_{1},c_{1})=1$、$\\gcd(a_{2},c_{2})=1$。如果存在一个矩阵 $\\gamma = \\begin{pmatrix} \\alpha & \\beta \\\\ \\delta_N & \\epsilon \\end{pmatrix} \\in \\Gamma_{0}(N)$ 使得 $\\gamma(\\kappa_{1}) = \\kappa_{2}$，则它们是 $\\Gamma_{0}(N)$-等价的。处于 $\\Gamma_{0}(N)$ 中的条件是 $\\delta_N \\equiv 0 \\pmod{N}$。\n\n该作用给出：\n$$ \\frac{a_{2}}{c_{2}} = \\frac{\\alpha a_{1} + \\beta c_{1}}{\\delta_N a_{1} + \\epsilon c_{1}} $$\n由于分数 $\\frac{a_{2}}{c_{2}}$ 是最简分数，分母 $c_{2}$ 必须是 $\\delta_N a_{1} + \\epsilon c_{1}$ 的一个因子。因此，在不考虑符号的情况下，我们可以写出 $c_{2} = \\delta_N a_{1} + \\epsilon c_{1}$。\n\n让我们分析尖点代表 $\\frac{a}{c}$ 的量 $\\gcd(c, N)$。对于两个等价的尖点，我们有：\n$$ \\gcd(c_{2}, N) = \\gcd(\\delta_N a_{1} + \\epsilon c_{1}, N) = \\gcd(\\epsilon c_{1}, N) $$\n由于 $\\alpha\\epsilon - \\beta\\delta_N = 1$，我们有 $\\gcd(\\epsilon, \\delta_N)=1$，这意味着 $\\gcd(\\epsilon, N) = 1$。因此：\n$$ \\gcd(c_{2}, N) = \\gcd(c_{1}, N) $$\n这表明对于任意尖点 $\\frac{a}{c}$， $d = \\gcd(c, N)$ 是其 $\\Gamma_{0}(N)$-轨道的一个不变量。这意味着具有不同 $\\gcd(c,N)$ 值的尖点属于不同的等价类。\n\n从此观察可以推导出的标准分类指出，$X_{0}(N)$ 的尖点与数对 $(d, u)$ 一一对应，其中 $d$ 是 $N$ 的一个正因数，$u$ 是一个在模 $\\gcd(d, N/d)$ 意义下定义且满足 $\\gcd(u,d)=1$ 的整数。这样一个尖点的代表分数为 $\\frac{u}{d}$。\n\n对于 $N$ 的每个正因数 $d$，与其关联的不同尖点的数目由 $u$ 的选择数目给出。满足 $1 \\le u \\le \\gcd(d, N/d)$ 和 $\\gcd(u, \\gcd(d,N/d))=1$ 的整数 $u$ 的数量是 $\\phi(\\gcd(d, N/d))$，其中 $\\phi$ 是欧拉函数。\n\n$X_{0}(N)$ 的尖点总数是 $N$ 的所有正因数的求和：\n$$ \\text{尖点数} = \\sum_{d|N, d>0} \\phi(\\gcd(d, N/d)) $$\n\n**2. 尖点的宽度**\n\n尖点 $\\kappa$ 的宽度 $w$ 是最小的正整数，使得平移矩阵 $T^{w} = \\begin{pmatrix} 1 & w \\\\ 0 & 1 \\end{pmatrix}$ 位于群 $\\sigma^{-1} \\Gamma_{0}(N) \\sigma$ 中，其中 $\\sigma \\in \\mathrm{SL}_{2}(\\mathbb{Z})$ 是任何将 $\\infty$ 映射到 $\\kappa$ 的矩阵。这等价于找到最小的 $w>0$ 使得 $\\sigma T^w \\sigma^{-1} \\in \\Gamma_0(N)$。\n\n设尖点由 $\\kappa = \\frac{a}{c}$ 表示，其中 $\\gcd(a,c)=1$。我们可以选择一个矩阵 $\\sigma \\in \\mathrm{SL}_{2}(\\mathbb{Z})$ 使得 $\\sigma(\\infty) = \\frac{a}{c}$。根据 $\\mathrm{SL}_{2}(\\mathbb{Z})$ 的性质，存在整数 $b, d'$ 使得 $ad' - bc = 1$。因此我们可以取 $\\sigma = \\begin{pmatrix} a & b \\\\ c & d' \\end{pmatrix}$。注意到 $\\sigma$ 的左下角元素是 $c$。\n\n让我们计算矩阵乘积 $\\sigma T^w \\sigma^{-1}$：\n$$ \\sigma T^w \\sigma^{-1} = \\begin{pmatrix} a & b \\\\ c & d' \\end{pmatrix} \\begin{pmatrix} 1 & w \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} d' & -b \\\\ -c & a \\end{pmatrix} $$\n$$ = \\begin{pmatrix} a & aw+b \\\\ c & cw+d' \\end{pmatrix} \\begin{pmatrix} d' & -b \\\\ -c & a \\end{pmatrix} = \\begin{pmatrix} a d' - c(aw+b) & -ab + a(aw+b) \\\\ c d' - c(cw+d') & -cb + a(cw+d') \\end{pmatrix} $$\n使用 $ad' - bc = 1$：\n$$ = \\begin{pmatrix} (ad'-bc) - acw & a^2 w \\\\ -c^2 w & (ad'-bc) + acw \\end{pmatrix} = \\begin{pmatrix} 1 - acw & a^2 w \\\\ -c^2 w & 1 + acw \\end{pmatrix} $$\n为使该矩阵位于 $\\Gamma_{0}(N)$ 中，其左下角元素必须模 $N$ 同余于 $0$。\n$$ -c^2 w \\equiv 0 \\pmod{N} \\quad \\text{或} \\quad c^2 w \\equiv 0 \\pmod{N} $$\n我们寻求满足此同余式的最小正整数 $w$。它由以下公式给出：\n$$ w = \\frac{\\operatorname{lcm}(c^2, N)}{c^2} = \\frac{c^2 N}{c^2 \\gcd(c^2, N)} = \\frac{N}{\\gcd(c^2, N)} $$\n这个公式给出了由 $\\frac{a}{c}$ 表示的尖点的宽度。如前所示，$\\gcd(c,N)$ 是 $\\Gamma_0(N)$-轨道的一个不变量，因此宽度是良定义的。\n对于对应于 $N$ 的一个因数 $d$ 的尖点类，我们可以使用代表元 $\\frac{1}{d}$（因为 $\\gcd(1,d)=1$）。在此情况下，$c=d$，宽度为：\n$$ w_d = \\frac{N}{\\gcd(d^2, N)} $$\n\n### 第二部分：应用于 $N = 60$ 的情况\n\n我们将推导出的公式应用于 $N = 60 = 2^2 \\cdot 3 \\cdot 5$ 的具体情况。\n\n$60$ 的正因数是 $1, 2, 3, 4, 5, 6, 10, 12, 15, 20, 30, 60$。总共有 $12$ 个因数。对于每个因数 $d$，我们将计算相关联的尖点数 $\\phi(\\gcd(d, 60/d))$ 及其共同宽度 $w_d = 60/\\gcd(d^2, 60)$。\n\n- $d=1$:\n  - 尖点数: $\\phi(\\gcd(1, 60)) = \\phi(1) = 1$.\n  - 宽度: $w_1 = 60/\\gcd(1^2, 60) = 60/1 = 60$.\n- $d=2$:\n  - 尖点数: $\\phi(\\gcd(2, 30)) = \\phi(2) = 1$.\n  - 宽度: $w_2 = 60/\\gcd(2^2, 60) = 60/\\gcd(4, 60) = 60/4 = 15$.\n- $d=3$:\n  - 尖点数: $\\phi(\\gcd(3, 20)) = \\phi(1) = 1$.\n  - 宽度: $w_3 = 60/\\gcd(3^2, 60) = 60/\\gcd(9, 60) = 60/3 = 20$.\n- $d=4$:\n  - 尖点数: $\\phi(\\gcd(4, 15)) = \\phi(1) = 1$.\n  - 宽度: $w_4 = 60/\\gcd(4^2, 60) = 60/\\gcd(16, 60) = 60/4 = 15$.\n- $d=5$:\n  - 尖点数: $\\phi(\\gcd(5, 12)) = \\phi(1) = 1$.\n  - 宽度: $w_5 = 60/\\gcd(5^2, 60) = 60/\\gcd(25, 60) = 60/5 = 12$.\n- $d=6$:\n  - 尖点数: $\\phi(\\gcd(6, 10)) = \\phi(2) = 1$.\n  - 宽度: $w_6 = 60/\\gcd(6^2, 60) = 60/\\gcd(36, 60) = 60/12 = 5$.\n- $d=10$:\n  - 尖点数: $\\phi(\\gcd(10, 6)) = \\phi(2) = 1$.\n  - 宽度: $w_{10} = 60/\\gcd(10^2, 60) = 60/\\gcd(100, 60) = 60/20 = 3$.\n- $d=12$:\n  - 尖点数: $\\phi(\\gcd(12, 5)) = \\phi(1) = 1$.\n  - 宽度: $w_{12} = 60/\\gcd(12^2, 60) = 60/\\gcd(144, 60) = 60/12 = 5$.\n- $d=15$:\n  - 尖点数: $\\phi(\\gcd(15, 4)) = \\phi(1) = 1$.\n  - 宽度: $w_{15} = 60/\\gcd(15^2, 60) = 60/\\gcd(225, 60) = 60/15 = 4$.\n- $d=20$:\n  - 尖点数: $\\phi(\\gcd(20, 3)) = \\phi(1) = 1$.\n  - 宽度: $w_{20} = 60/\\gcd(20^2, 60) = 60/\\gcd(400, 60) = 60/20 = 3$.\n- $d=30$:\n  - 尖点数: $\\phi(\\gcd(30, 2)) = \\phi(2) = 1$.\n  - 宽度: $w_{30} = 60/\\gcd(30^2, 60) = 60/\\gcd(900, 60) = 60/60 = 1$.\n- $d=60$:\n  - 尖点数: $\\phi(\\gcd(60, 1)) = \\phi(1) = 1$.\n  - 宽度: $w_{60} = 60/\\gcd(60^2, 60) = 60/60 = 1$.\n\n**N=60 的总结：**\n\n尖点的总数是每个因数类的尖点数之和：$1 \\times 12 = 12$。\n\n宽度的多重集是通过收集所有计算出的宽度得到的：\n$\\{60, 15, 20, 15, 12, 5, 3, 5, 4, 3, 1, 1\\}$.\n\n将这些宽度按非递减顺序排列，我们得到：\n$\\{1, 1, 3, 3, 4, 5, 5, 12, 15, 15, 20, 60\\}$.\n\n最终答案是一个行矩阵，其第一个元素是尖点总数（$12$），其余元素是排序后的宽度。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n12 & 1 & 1 & 3 & 3 & 4 & 5 & 5 & 12 & 15 & 15 & 20 & 60\n\\end{pmatrix}\n}\n$$", "id": "3018127"}, {"introduction": "Hecke 对应 $T_p$ 是该理论的核心，它在模曲线和模形式上定义了算子。这种对应不是一个简单的函数，而是一个多值映射，最好通过从一个对应空间出发的两个射影映射来理解。通过从模解释出发计算这些射影映射的次数，你将直接量化 $T_p$ 的一个基本性质：它将单个点（或椭圆曲线）映射到一个由 $p+1$ 个新点组成的集合 [@problem_id:3018113]。", "problem": "设 $N \\geq 1$ 为一个整数，并设 $p$ 是一个素数且 $p \\nmid N$。考虑复模曲线 $X_{0}(N)$，它被看作是参数化配对 $(E,C)$ 的同构类的粗模空间，其中 $E$ 是 $\\mathbb{C}$ 上的椭圆曲线，$C \\subset E$ 是一个 $N$ 阶循环子群。在 $X_{0}(N)$ 上定义 Hecke 对应 $T_{p}$，通过一个模问题，该问题对一个点 $(E,C)$ 赋予所有次数为 $p$ 的同源 $\\phi \\colon E \\to E'$ 的集合，使得 $\\phi(C)$ 是 $E'$ 的一个 $N$ 阶循环子群。等价地，$T_{p}$ 可以被描述为三元组 $(E,C,G)$ 的集合，其中 $G \\subset E$ 是一个 $p$ 阶循环子群，连同在商椭圆曲线 $E/G$ 上的诱导配对 $(E/G,(C+G)/G)$。注意到 $p \\nmid N$ 确保了 $C \\cap G = \\{0\\}$ 并且像 $(C+G)/G$ 在 $E/G$ 中是 $N$ 阶循环的。对应 $T_{p}$ 配备了两个有限态射（投影映射）：\n- $p_{1} \\colon T_{p} \\to X_{0}(N)$，将 $(E,C,G)$ 映射到 $(E,C)$，以及\n- $p_{2} \\colon T_{p} \\to X_{0}(N)$，将 $(E,C,G)$ 映射到 $(E/G,(C+G)/G)$。\n\n从 $X_{0}(N)$ 的模解释和 Hecke 对应 $T_{p}$ 出发，并仅使用诸如椭圆曲线的 $p$-挠子群 $E[p]$ 的结构和对偶同源的存在性等基本事实，从第一性原理推导当 $p \\nmid N$ 时有限映射 $p_{1}$ 和 $p_{2}$ 的次数的计算，并证明为什么这些次数相等。将你的最终答案表示为一个关于 $p$ 的单一精确符号表达式；无需四舍五入。", "solution": "问题要求我们计算与模曲线 $X_{0}(N)$ 上的 Hecke 对应 $T_{p}$ 相关联的两个投影映射 $p_{1}$ 和 $p_{2}$ 的次数，其中 $p$ 是一个不整除 $N$ 的素数。我们需要从第一性原理推导此结果，并证明为什么这两个次数相等。\n\n设 $f: X \\to Y$ 是 $\\mathbb{C}$ 上代数曲线之间的一个有限满态射。$f$ 的次数，记为 $\\deg(f)$，是对于 $Y$ 中一个泛有点 $y \\in Y$ 其纤维 $f^{-1}(y)$ 中的点的数量。映射 $p_{1}$ 和 $p_{2}$ 是有限态射，因此我们可以通过计算一个泛有纤维中的元素数量来计算它们的次数。\n\n首先，我们计算 $p_{1} \\colon T_{p} \\to X_{0}(N)$ 的次数。映射 $p_{1}$ 的定义是将三元组 $(E,C,G)$ 的同构类映射到配对 $(E,C)$ 的同构类。为了求出 $p_{1}$ 的次数，我们必须确定对于 $X_{0}(N)$ 中的一个泛有点 $x$ 其纤维 $p_{1}^{-1}(x)$ 的大小。\n\n设 $x = [(E,C)]$ 是一个配对的同构类，其中 $E$ 是 $\\mathbb{C}$ 上的椭圆曲线，$C$ 是一个 $N$ 阶循环子群。纤维 $p_{1}^{-1}(x)$ 中的一个点是满足 $[(E',C')] = x$ 的三元组 $(E',C',G')$ 的同构类。我们可以为类 $x$ 选择一个代表元 $(E,C)$。那么该纤维就由形如 $(E,C,G)$ 的三元组的同构类组成，其中 $G$ 是 $E$ 的一个 $p$ 阶循环子群。对于一个泛有椭圆曲线 $E$，其自同构群仅为 $\\{\\pm 1\\}$，并且这些自同构保持任何子群 $G$ 不变。因此，计算非同构三元组的数量本质上归结为计算不同子群 $G$ 的数量。\n\n因此，任务是计算椭圆曲线 $E$ 中 $p$ 阶的不同循环子群的数量。这些子群由 $p$ 阶元素生成。$E$ 上阶数整除 $p$ 的点的集合是 $p$-挠子群，记作 $E[p]$。对于复数 $\\mathbb{C}$ 上的椭圆曲线（或任何特征不为 $p$ 的域），$p$-挠子群是一个与 $(\\mathbb{Z}/p\\mathbb{Z}) \\times (\\mathbb{Z}/p\\mathbb{Z})$ 同构的阿贝尔群。\n$$E[p] \\cong (\\mathbb{Z}/p\\mathbb{Z})^{2}$$\n这个群有 $p^{2}$ 个元素。它可以被看作是有限域 $\\mathbb{F}_{p}$ 上的一个二维向量空间。一个 $p$ 阶循环子群是这个向量空间的一个一维子空间。\n\n$E[p]$ 中非零向量的数量是 $p^{2}-1$。每个一维子空间都由其任何非零向量生成。由于 $\\mathbb{F}_{p}$ 上的一个一维子空间包含 $p$ 个元素，它有 $p-1$ 个非零元素（生成元）。因此，$p$ 阶的不同循环子群的数量是非零元素的数量除以每个子群的生成元数量：\n$$ \\text{子群 } G \\text{ 的数量} = \\frac{p^{2}-1}{p-1} = p+1 $$\n对于一个泛有点 $[(E,C)]$，在 $E$ 中恰好有 $p+1$ 个不同的 $p$ 阶循环子群 $G_i$，这导致在 $p_1$ 的纤维中有 $p+1$ 个不同的点 $[(E,C,G_i)]$。因此，$p_{1}$ 的次数是 $p+1$。\n$$ \\deg(p_{1}) = p+1 $$\n\n接下来，我们计算 $p_{2} \\colon T_{p} \\to X_{0}(N)$ 的次数。映射 $p_{2}$ 的定义是将三元组 $(E,C,G)$ 的同构类映射到配对 $(E/G, (C+G)/G)$ 的同构类。为了求出 $p_{2}$ 的次数，我们确定对于 $X_{0}(N)$ 中的一个泛有点 $y$ 其纤维 $p_{2}^{-1}(y)$ 的大小。\n\n设 $y = [(E',C')]$ 是一个配对的同构类，其中 $E'$ 是一个椭圆曲线，$C'$ 是一个 $N$ 阶循环子群。纤维 $p_{2}^{-1}(y)$ 中的一个点对应于一个三元组 $(E,C,G)$ 的同构类，使得 $[(E/G, (C+G)/G)] = y$。这意味着存在一个配对的同构 $i: (E/G, (C+G)/G) \\to (E', C')$。\n设 $\\pi:E \\to E/G$ 是典范投影同源，其次数为 $p$。复合映射 $\\phi = i \\circ \\pi: E \\to E'$ 是一个次数为 $p$ 的同源。$(C+G)/G$ 映射到 $C'$ 的条件意味着 $\\phi(C)=C'$。所以，在 $[(E',C')]$ 上的纤维中的一个点对应于一个配对 $(E,C)$ 和一个 $p$ 次同源 $\\phi:E \\to E'$，使得 $\\phi(C)=C'$。问题是计算有多少个这样的配对 $(E,C)$（在同构意义下）能产生相同的 $(E',C')$。\n\n我们可以使用对偶同源理论。对于任何次数为 $p$ 的同源 $\\phi: E \\to E'$，都存在一个唯一的次数也为 $p$ 的对偶同源 $\\hat{\\phi}: E' \\to E$。因此，这样一个 $\\phi$ 的存在性等价于其对偶 $\\hat{\\phi}$ 的存在性。同源 $\\hat{\\phi}:E' \\to E$ 由其核 $\\ker(\\hat{\\phi})$ 唯一确定（在与 $E$ 的一个自同构复合的意义下），而其核必须是 $E'$ 的一个 $p$ 阶循环子群。如前所述，$E'$ 中有 $p+1$ 个这样的子群。\n\n让我们固定泛有配对 $(E',C')$，并枚举在 $[(E',C')]$ 上 $p_2$ 的纤维中的点。每个点对应于 $E'$ 中一个 $p$ 阶循环子群 $K \\subset E'$ 的选择。\n1. 对于 $E'$ 中 $p+1$ 个 $p$ 阶循环子群中的每一个 $K \\subset E'$，令 $\\psi_K: E' \\to E'/K$ 为商同源。\n2. 定义椭圆曲线 $E_K := E'/K$。对于泛有 $E'$，不同的 $K$ 的选择会导致非同构的椭圆曲线 $E_K$。\n3. 令 $\\phi_K = \\hat{\\psi}_K: E_K \\to E'$ 为 $\\psi_K$ 的对偶同源。这是一个次数为 $p$ 的同源。\n4. $\\phi_K$ 的核，我们称之为 $G_K$，是 $E_K$ 的一个 $p$ 阶循环子群。根据构造，$(E_K)/G_K \\cong E'$。\n5. 我们需要找到一个子群 $C_K \\subset E_K$ 使得 $\\phi_K(C_K) = C'$。由于 $\\phi_K$ 的次数是 $p$ 且 $p \\nmid N$，同源 $\\phi_K$ 在 $N$ 阶子群上作为同构作用。因此，存在一个唯一的 $N$ 阶循环子群 $C_K \\subset E_K$，由 $C_K = \\phi_K^{-1}(C')$ 给出。\n6. 根据这些定义，三元组 $(E_K, C_K, G_K)$ 在 $p_2$ 的作用下映射到 $[(E_K/G_K, (C_K+G_K)/G_K)]$。同源 $\\phi_K$ 提供了同构 $E_K/G_K \\cong E'$。在此同构下，子群 $(C_K+G_K)/G_K \\cong \\phi_K(C_K)$ 被映射到 $C'$。因此，我们构造了 $p_2$ 纤维中的一个点。\n\n这个构造在 $E'$ 中 $p$ 阶的循环子群 $K$ 与 $[(E',C')]$ 上 $p_2$ 的纤维中的点之间建立了一一对应关系。因为有 $p+1$ 个这样的子群，所以纤维的大小是 $p+1$。\n$$ \\deg(p_{2}) = p+1 $$\n\n有限映射 $p_1$ 和 $p_2$ 的次数之所以相等，是因为从第一性原理出发，它们的计算都归结为同一个组合问题：计算一个椭圆曲线内 $p$ 阶循环子群的数量。$p_1$ 的次数是源曲线 $E$ 中这类子群的数量。$p_2$ 的次数，通过对偶同源的视角来看，是目标曲线 $E'$ 中这类子群的数量。在这两种情况下，$p$-挠子群 $E[p] \\cong (\\mathbb{Z}/p\\mathbb{Z})^2$ 的结构决定了这个数量是 $p+1$。\n\n次数是相等的：$\\deg(p_1) = \\deg(p_2) = p+1$。最终答案就是这个值。", "answer": "$$\\boxed{p+1}$$", "id": "3018113"}, {"introduction": "在理解了 Hecke 对应的结构之后，下一步是理解其在与模曲线相关的对象（例如除子）上的作用。$T_p$ 在尖点上的作用可以使用 Hecke 算子的双陪集描述来明确计算。本练习 [@problem_id:3018133] 演示了如何计算 Hecke 在无穷远尖点上的作用，揭示了该尖点是 $T_p$ 的一个本征向量，这一结果是理解 Hecke 在整个 Eisenstein 级数空间上作用的关键基石。", "problem": "设 $N \\geq 1$ 是一个固定的整数，令 $X_0(N)$ 表示紧化模曲线，其上的点分类配对 $(E,C)$，其中 $E$ 是一个椭圆曲线，$C \\subset E$ 是一个 $N$ 阶循环子群。设 $p$ 是一个素数且 $p \\nmid N$。考虑 $X_0(N)$ 上的 Hecke 对应 $T_p$，它在除子上的定义为 $T_p(D) = p_{2*}(p_1^{*}D)$，其中 $p_1, p_2 : \\mathcal{C}_p \\to X_0(N)$ 是从对应空间 $\\mathcal{C}_p$ 出发的自然投影，该空间参数化了与 $\\Gamma_0(N)$-结构相容的循环 $p$-同源 $(E,C) \\to (E',C')$，而 $p_{2*}$ 表示在 $p_2$ 下的除子推前。Hecke 对应 $T_p$ 源于双陪集 $\\Gamma_0(N)\\alpha\\Gamma_0(N)$，其中 $\\alpha = \\begin{pmatrix}1 & 0 \\\\ 0 & p\\end{pmatrix}$，并在 $X_0(N)$ 的尖点集合上导出一个多值映射，这些尖点等同于 $\\mathbb{P}^1(\\mathbb{Q})$ 中的 $\\Gamma_0(N)$-等价类。\n\n仅使用关于模曲线和 Hecke 对应的基础定义和广为接受的标准事实（包括 $X_0(N)$ 的模解释、尖点作为 $\\mathbb{P}^1(\\mathbb{Q})$ 中 $\\Gamma_0(N)$-等价类的描述，以及当 $p \\nmid N$ 时 $T_p$ 的双陪集描述），计算 Hecke 作用 $T_p$ 在无穷远处尖点的除子上的结果，即，将 $T_p([\\infty])$ 确定为 $X_0(N)$ 上尖点除子的一个形式线性组合。将你的最终答案表示为除子 $T_p([\\infty])$ 的一个单一闭式符号表达式，并明确给出所有系数。", "solution": "问题要求计算 Hecke 算子 $T_p$ 在模曲线 $X_0(N)$ 的无穷远处尖点的除子 $[\\infty]$ 上的作用，其中 $p$ 是一个满足 $p \\nmid N$ 的素数。\n\nHecke 对应 $T_p$ 可以通过其在模曲线点集上的作用来描述。$X_0(N)$ 上的点集由商空间 $\\Gamma_0(N) \\setminus \\mathbb{H}^*$ 给出，其中 $\\mathbb{H}^* = \\mathbb{H} \\cup \\mathbb{P}^1(\\mathbb{Q})$ 是扩展上半平面，$\\Gamma_0(N)$ 是模群\n$$ \\Gamma_0(N) = \\left\\{ \\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix} \\in \\mathrm{SL}_2(\\mathbb{Z}) \\;\\middle|\\; c \\equiv 0 \\pmod{N} \\right\\} $$\n$X_0(N)$ 的尖点是 $\\mathbb{P}^1(\\mathbb{Q})$ 在 $\\Gamma_0(N)$ 作用下的等价类。无穷远处的尖点 $[\\infty]$ 是点 $\\infty \\in \\mathbb{P}^1(\\mathbb{Q})$ 的等价类。\n\nHecke 算子 $T_p$ 在尖点 $[s]$ 的除子上的作用由下式给出\n$$ T_p([s]) = \\sum_{\\gamma \\in \\Gamma_0(N) \\setminus \\Delta_p} [\\gamma(s)] $$\n其中 $\\Delta_p$ 是行列式为 $p$ 的 $2 \\times 2$ 整数矩阵的集合，而 $\\Gamma_0(N) \\setminus \\Delta_p$ 表示 $\\Delta_p$ 中 $\\Gamma_0(N)$ 的右陪集的一个完备代表元集。矩阵 $\\gamma=\\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix}$ 在点 $z \\in \\mathbb{H}^*$ 上的作用是线性分式变换 $\\gamma(z) = \\frac{az+b}{cz+d}$。\n\n我们的第一步是确定 $\\Gamma_0(N) \\setminus \\Delta_p$ 的一个代表元集。模形式理论中的一个标准结果表明，对于不整除水平 $N$ 的素数 $p$（即 $p \\nmid N$），矩阵集合 $\\Delta_p$ 是一个单一的双陪集 $\\Gamma_0(N) \\begin{pmatrix} 1 & 0 \\\\ 0 & p \\end{pmatrix} \\Gamma_0(N)$。右陪集 $\\Gamma_0(N) \\setminus \\Delta_p$ 的一个代表元集由以下 $p+1$ 个矩阵给出：\n1. $\\gamma_j = \\begin{pmatrix} 1 & j \\\\ 0 & p \\end{pmatrix}$，对于 $j=0, 1, \\dots, p-1$。\n2. $\\gamma_\\infty = \\begin{pmatrix} p & 0 \\\\ 0 & 1 \\end{pmatrix}$。\n\n我们验证这些矩阵确实代表了不同的右陪集。已知这样的陪集数量为 $p+1$。\n假设集合中的两个代表元 $\\gamma, \\gamma'$ 位于同一个右陪集中，即对于某个 $g \\in \\Gamma_0(N)$ 有 $\\gamma = g \\gamma'$。这等价于 $g = \\gamma (\\gamma')^{-1} \\in \\Gamma_0(N)$。\n\n情况 1：$\\gamma = \\gamma_j$ 且 $\\gamma' = \\gamma_k$，其中 $j,k \\in \\{0, \\dots, p-1\\}$。\n$$ g = \\gamma_j (\\gamma_k)^{-1} = \\begin{pmatrix} 1 & j \\\\ 0 & p \\end{pmatrix} \\left( \\frac{1}{p} \\begin{pmatrix} p & -k \\\\ 0 & 1 \\end{pmatrix} \\right) = \\begin{pmatrix} 1 & \\frac{j-k}{p} \\\\ 0 & 1 \\end{pmatrix} $$\n为了使 $g$ 的元素为整数，$p$ 必须整除 $j-k$。由于 $0 \\le j, k \\le p-1$，这只在 $j=k$ 时才可能。因此，这 $p$ 个矩阵 $\\gamma_j$ 位于不同的陪集中。\n\n情况 2：$\\gamma = \\gamma_\\infty$ 且 $\\gamma' = \\gamma_j$。\n$$ g = \\gamma_\\infty (\\gamma_j)^{-1} = \\begin{pmatrix} p & 0 \\\\ 0 & 1 \\end{pmatrix} \\left( \\frac{1}{p} \\begin{pmatrix} p & -j \\\\ 0 & 1 \\end{pmatrix} \\right) = \\begin{pmatrix} p & -j \\\\ 0 & \\frac{1}{p} \\end{pmatrix} $$\n该矩阵不具有整数项，因此它不能在 $\\Gamma_0(N)$ 中。因此，$\\gamma_\\infty$ 与任何 $\\gamma_j$ 都不在同一个陪集中。\n\n因此，集合 $\\{\\gamma_0, \\dots, \\gamma_{p-1}, \\gamma_\\infty\\}$ 是 $\\Gamma_0(N) \\setminus \\Delta_p$ 的一个完备的 $p+1$ 个右陪集代表元集。\n\n现在，我们计算这些代表元在点 $\\infty \\in \\mathbb{P}^1(\\mathbb{Q})$ 上的作用。$\\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix}$ 在 $\\infty$ 上的作用是 $a/c$（当 $c \\neq 0$ 时）或 $\\infty$ （当 $c=0$ 时）。\n\n1. 对于 $\\gamma_j = \\begin{pmatrix} 1 & j \\\\ 0 & p \\end{pmatrix}$，其中 $j \\in \\{0, 1, \\dots, p-1\\}$：\n由于 $c=0$，我们有 $\\gamma_j(\\infty) = \\infty$。\n这 $p$ 个代表元中的每一个都将 $\\infty$ 映射到自身。这对总和贡献了 $p$ 份尖点 $[\\infty]$。\n\n2. 对于 $\\gamma_\\infty = \\begin{pmatrix} p & 0 \\\\ 0 & 1 \\end{pmatrix}$：\n由于 $c=0$，我们有 $\\gamma_\\infty(\\infty) = \\infty$。\n这个代表元也将 $\\infty$ 映射到自身，对总和贡献了另外一份尖点 $[\\infty]$。\n\n结合这些结果，$T_p$ 在无穷远处尖点的除子上的作用是：\n$$ T_p([\\infty]) = \\sum_{j=0}^{p-1} [\\gamma_j(\\infty)] + [\\gamma_\\infty(\\infty)] = \\sum_{j=0}^{p-1} [\\infty] + [\\infty] = p[\\infty] + [\\infty] = (p+1)[\\infty] $$\n结果是一个尖点除子的形式线性组合，符合要求。得到这个简单结果的关键条件是 $p \\nmid N$，这确保了所使用的代表元集是有效的，并且其结构不会混合不同类型的尖点。", "answer": "$$\\boxed{(p+1)[\\infty]}$$", "id": "3018133"}]}