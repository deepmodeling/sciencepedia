{"hands_on_practices": [{"introduction": "在深入研究抽象证明之前，通过具体数值来感受我们研究的对象是极具启发性的。本练习将指导你计算特定情况下算术级数中的素数分布，即切比雪夫函数 $\\psi(x;q,a)$，并将计算出的误差项 $E(x;q,a)$ 与理论所依赖的“平方根消去”启发式思想（即与 $\\sqrt{x}$ 比较）进行比较 [@problem_id:3025852]。这种实践有助于通过具体数据建立对素数分布不规则性及其平均行为的直观理解。", "problem": "设 $q$ 是一个正整数，设 $a$ 是模 $q$ 的一个整数余数类，并设 $\\Lambda(n)$ 表示 von Mangoldt 函数，定义为 $$\\Lambda(n)=\\begin{cases}\\log p & \\text{若 } n=p^k \\text{，其中 } p \\text{ 为某个素数，} k \\text{ 为整数且 } k\\geq 1,\\\\ 0 & \\text{其他情况。}\\end{cases}$$ 定义算术级数中的 Chebyshev 函数为 $$\\psi(x;q,a)=\\sum_{\\substack{1\\leq n\\leq x\\\\ n\\equiv a\\ (\\mathrm{mod}\\ q)}}\\Lambda(n)。$$ 设 $\\varphi(q)$ 为欧拉总计函数，并定义期望主项 $$M(x;q,a)=\\begin{cases}\\dfrac{x}{\\varphi(q)} & \\text{若 } \\gcd(a,q)=1,\\\\ 0 & \\text{若 } \\gcd(a,q)>1。\\end{cases}$$ 定义偏差 $$E(x;q,a)=\\psi(x;q,a)-M(x;q,a)。$$ Elliott-Halberstam 猜想 (EH) 关注的是在模 $q$ 直至 $x^{1-\\varepsilon}$ 的范围内，此类偏差的平均大小，而启发式推断表明，在许多情况下，平方根对消尺度（如 $|E(x;q,a)|$）平均与 $\\sqrt{x}$ 相当。\n\n你的任务是使用自然对数实现一个 $\\Lambda(n)$ 的计算模型，并为指定的测试套件计算 $\\psi(x;q,a)$、偏差 $E(x;q,a)$，以及将 $|E(x;q,a)|$ 与启发式大小 $\\sqrt{x}$进行比较。对于每个测试用例，你必须输出列表 $$\\big[\\psi(x;q,a),\\ E(x;q,a),\\ |E(x;q,a)|/\\sqrt{x},\\ |E(x;q,a)|\\leq \\sqrt{x}\\big],$$ 其中最后一个条目是一个布尔值，表示观测到的偏差是否不大于启发式基准。\n\n仅使用纯数学和算法推理；不要依赖任何外部数据。所有对数必须是自然对数。不涉及物理单位。不涉及角度。所有百分比（若有）必须表示为小数或分数，但此处不需要。\n\n所需的测试套件包含以下参数集：\n- 正常路径，素数模和简约剩余类：$(x,q,a)=(10^4,5,1)$、$(10^4,5,2)$、$(10^4,5,3)$、$(10^4,5,4)$。\n- 使用最小 $x$ 的边界条件：$(x,q,a)=(1,5,1)$。\n- 使用非互质剩余类的边缘情况：$(x,q,a)=(100,5,0)$。\n- 包含互质和非互质余数的合数模：$(x,q,a)=(10^4,8,1)$ 和 $(10^4,8,2)$。\n- 备用素数模：$(x,q,a)=(10^3,7,3)$。\n- 相对于 $x$ 的大模数：$(x,q,a)=(200,97,1)$。\n\n你的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表，列表中的每个元素对应上面列出的一个测试用例（顺序相同），并且每个元素本身都是一个形如 $[\\psi,E,|E|/\\sqrt{x},\\text{boolean}]$ 的方括号括起来的逗号分隔列表。例如，输出格式必须是 $$\\big[[\\cdots],[\\cdots],\\ldots,[\\cdots]\\big],$$ 不得包含额外文本。", "solution": "问题有效。这是一个属于解析数论领域的适定计算问题，基于标准的、普遍接受的定义和一个著名的猜想。所有必要的数据和定义都已提供，问题是自包含且客观的。\n\n### **问题验证**\n\n#### **步骤 1：提取已知信息**\n-   **Von Mangoldt 函数, $\\Lambda(n)$**:\n    $$\\Lambda(n)=\\begin{cases}\\log p & \\text{若 } n=p^k \\text{，其中 } p \\text{ 为某个素数，} k \\text{ 为整数且 } k\\geq 1,\\\\ 0 & \\text{其他情况。}\\end{cases}$$\n-   **Chebyshev 函数, $\\psi(x;q,a)$**:\n    $$\\psi(x;q,a)=\\sum_{\\substack{1\\leq n\\leq x\\\\ n\\equiv a\\ (\\mathrm{mod}\\ q)}}\\Lambda(n)。$$\n-   **欧拉总计函数, $\\varphi(q)$**。\n-   **期望主项, $M(x;q,a)$**:\n    $$M(x;q,a)=\\begin{cases}\\dfrac{x}{\\varphi(q)} & \\text{若 } \\gcd(a,q)=1,\\\\ 0 & \\text{若 } \\gcd(a,q)>1。\\end{cases}$$\n-   **偏差, $E(x;q,a)$**:\n    $$E(x;q,a)=\\psi(x;q,a)-M(x;q,a)。$$\n-   **启发式基准**: $|E(x;q,a)|$ 与 $\\sqrt{x}$ 进行比较。\n-   **每个测试用例的所需输出**: 一个包含四个值的列表：\n    $$\\big[\\psi(x;q,a),\\ E(x;q,a),\\ |E(x;q,a)|/\\sqrt{x},\\ |E(x;q,a)|\\leq \\sqrt{x}\\big]。$$\n-   **测试套件**:\n    1.  $(x,q,a)=(10^4,5,1)$\n    2.  $(x,q,a)=(10^4,5,2)$\n    3.  $(x,q,a)=(10^4,5,3)$\n    4.  $(x,q,a)=(10^4,5,4)$\n    5.  $(x,q,a)=(1,5,1)$\n    6.  $(x,q,a)=(100,5,0)$\n    7.  $(x,q,a)=(10^4,8,1)$\n    8.  $(x,q,a)=(10^4,8,2)$\n    9.  $(x,q,a)=(10^3,7,3)$\n    10. $(x,q,a)=(200,97,1)$\n\n#### **步骤 2：使用提取的已知信息进行验证**\n-   **科学依据**: 该问题基于解析数论的基本概念：von Mangoldt 函数、用于算术级数的 Chebyshev psi 函数和欧拉总计函数。对 Elliott-Halberstam 猜想和平方根对消启发式方法的引用是素数分布研究的核心主题。所有定义和原理在科学上都是合理的。\n-   **适定性**: 对于任何有效的输入集 $(x,q,a)$，要计算的量都是唯一确定的。计算任务清晰，并且每个测试用例都有一个单一、可验证的解。\n-   **客观性**: 问题使用精确的数学语言和定义陈述，没有任何主观性或歧义。\n\n该问题不存在任何无效性缺陷。它是数论领域内一个明确定义的计算任务。\n\n#### **步骤 3：结论与行动**\n问题陈述是 **有效** 的。将提供一个解决方案。\n\n### **方法论与解决方案**\n\n目标是为每个测试用例 $(x,q,a)$ 计算四个量：$\\psi(x;q,a)$、$E(x;q,a)$、比率 $|E(x;q,a)|/\\sqrt{x}$ 以及布尔比较 $|E(x;q,a)| \\le \\sqrt{x}$。这需要实现几个数论函数。\n\n#### **1. 预计算 von Mangoldt 函数 $\\Lambda(n)$**\n\n为了高效计算涉及 $\\Lambda(n)$ 值求和的 $\\psi(x;q,a)$，最好预先计算直到测试套件中 $x$ 的最大值（即 $10^4$）的所有整数 $n$ 的 $\\Lambda(n)$。一个基于筛法的方法，类似于埃拉托斯特尼筛法（Sieve of Eratosthenes），适合此目的。\n\n算法如下：\n1.  初始化一个大小为 $x_{max}+1$ 的数组 `lambda_vals`，并用零填充，其中 $x_{max} = 10^4$。\n2.  初始化一个大小为 $x_{max}+1$ 的布尔数组 `is_prime`，从索引 2 开始的所有条目均为 `True`。将 0 和 1 标记为非素数。\n3.  从 2 遍历到 $x_{max}$ 的整数 $p$。\n4.  如果 `is_prime[p]` 为 `True`，则 $p$ 是一个素数。\n    a.  首先，在 `is_prime` 数组中将 $p$ 的所有倍数（$2p, 3p, ...$）标记为非素数。\n    b.  接下来，计算 $\\log p$。该值被赋给此素数的所有幂 $n = p^k$ 的 $\\Lambda(n)$。遍历 $p$ 的幂 $p^k = p, p^2, p^3, \\dots$，只要 $p^k \\le x_{max}$，就设置 `lambda_vals[p^k] = log(p)`。\n\n此过程高效地填充 `lambda_vals` 数组。对于任何不是素数幂的合数 $n$，`lambda_vals[n]` 将保持为 0，这与 $\\Lambda(n)$ 的定义一致。\n\n#### **2. 辅助函数的计算**\n\n主项 $M(x;q,a)$ 的计算需要欧拉总计函数 $\\varphi(q)$ 和最大公约数 $\\gcd(a,q)$。\n\n**欧拉总计函数 $\\varphi(q)$：**\n对于整数 $q > 1$，$\\varphi(q)$ 是小于等于 $q$ 且与 $q$ 互质的正整数的个数。它可以使用基于 $q$ 的不同素因子的乘积公式来计算：\n$$ \\varphi(q) = q \\prod_{p|q, p \\text{ 是素数}} \\left(1 - \\frac{1}{p}\\right) $$\n一个有效的计算算法是：\n1.  初始化 `result = q`。\n2.  从 2 开始遍历候选素数 $p$。\n3.  如果 $p$ 整除 $q$ 的剩余部分，则通过 `result = result - result/p` 更新结果，并从 $q$ 中除掉所有因子 $p$。\n4.  重复此过程，直到 $q$ 的剩余部分为 1 或者 $p$ 的平方超过它。如果还剩一个大于 $\\sqrt{q}$ 的素因子，则需要对该因子进行最后一次更新。\n\n**最大公约数 $\\gcd(a,q)$：**\n这可以使用标准的欧几里得算法计算，该算法在 Python 的 `math` 库中可用。对于测试用例 $(100, 5, 0)$，我们注意到 $\\gcd(0,q) = q$。\n\n#### **3. 主要量的计算**\n\n对于每个测试用例 $(x,q,a)$：\n\n1.  **Chebyshev 函数 $\\psi(x;q,a)$**：\n    $$\\psi(x;q,a)=\\sum_{\\substack{1\\leq n\\leq x\\\\ n\\equiv a\\ (\\mathrm{mod}\\ q)}}\\Lambda(n)$$\n    这个和通过遍历从 1 到 $x$ 且满足同余式 $n \\equiv a \\pmod{q}$ 的所有整数 $n$ 来计算。一种高效的方法是确定算术级数的首项 $n_{start}$，即满足 $n_{start} \\equiv a \\pmod{q}$ 的最小正整数。这可以计算为 $n_{start} = (a-1) \\pmod q + 1$。然后，求和就变成对 $n = n_{start}, n_{start}+q, n_{start}+2q, \\dots$ 直到 $x$ 进行迭代，累加预计算的 `lambda_vals[n]`。\n\n2.  **期望主项 $M(x;q,a)$**：\n    $$M(x;q,a)=\\begin{cases}\\dfrac{x}{\\varphi(q)} & \\text{若 } \\gcd(a,q)=1,\\\\ 0 & \\text{若 } \\gcd(a,q)>1。\\end{cases}$$\n    首先，计算 $g = \\gcd(a,q)$。如果 $g=1$，则计算 $\\varphi_q = \\varphi(q)$ 并设 $M(x;q,a) = x / \\varphi_q$。否则，$M(x;q,a)=0$。\n\n3.  **偏差 $E(x;q,a)$**：\n    这是直接的差值：$E(x;q,a) = \\psi(x;q,a) - M(x;q,a)$。\n\n4.  **比率与启发式检验**：\n    最后两个值由 $E(x;q,a)$ 导出：\n    -   比率为 $|E(x;q,a)| / \\sqrt{x}$。\n    -   布尔检验是比较 $|E(x;q,a)| \\le \\sqrt{x}$ 的结果。\n\n这种结构化方法确保每个组件都得到正确和高效的计算，为每个测试用例生成最终的四元列表。然后将所有测试用例的结果汇总成一个列表的列表，作为最终输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport math\n\ndef sieve_for_lambda(limit):\n    \"\"\"\n    Computes von Mangoldt function Lambda(n) for n up to limit using a sieve.\n    \"\"\"\n    lambda_vals = np.zeros(limit + 1)\n    is_prime = np.ones(limit + 1, dtype=bool)\n    is_prime[0] = is_prime[1] = False\n    for p in range(2, limit + 1):\n        if is_prime[p]:\n            log_p = np.log(p)\n            # Sieve out multiples\n            for multiple in range(2 * p, limit + 1, p):\n                is_prime[multiple] = False\n            # Assign log(p) to powers of p\n            p_power = p\n            while p_power <= limit:\n                lambda_vals[p_power] = log_p\n                # Prevent overflow before multiplication\n                if p_power > limit // p:\n                    break\n                p_power *= p\n    return lambda_vals\n\ndef phi(q):\n    \"\"\"\n    Computes Euler's totient function phi(q).\n    \"\"\"\n    if q == 1:\n        return 1\n    result = q\n    p = 2\n    temp_q = q\n    while p * p <= temp_q:\n        if temp_q % p == 0:\n            while temp_q % p == 0:\n                temp_q //= p\n            result -= result // p\n        p += 1\n    if temp_q > 1:\n        result -= result // temp_q\n    return result\n\ndef calculate_psi(x, q, a, lambda_vals):\n    \"\"\"\n    Computes the Chebyshev function psi(x; q, a).\n    \"\"\"\n    x_int = int(x)\n    psi_val = 0.0\n    \n    # Start iteration from the first positive integer n = a (mod q)\n    # The formula (a-1)%q + 1 works for a >= 0 in Python.\n    # e.g., a=5, q=5 -> (4%5)+1 = 5. a=0, q=5 -> (-1%5)+1 = 4+1=5. a=1, q=5 -> (0%5)+1=1.\n    n_start = (a - 1) % q + 1\n    \n    for n in range(n_start, x_int + 1, q):\n        psi_val += lambda_vals[n]\n        \n    return psi_val\n\ndef solve():\n    \"\"\"\n    Main solver function to process test cases and produce the final output.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (10**4, 5, 1),\n        (10**4, 5, 2),\n        (10**4, 5, 3),\n        (10**4, 5, 4),\n        (1, 5, 1),\n        (100, 5, 0),\n        (10**4, 8, 1),\n        (10**4, 8, 2),\n        (10**3, 7, 3),\n        (200, 97, 1),\n    ]\n\n    max_x = 0\n    if test_cases:\n        max_x = int(max(tc[0] for tc in test_cases))\n\n    # Pre-compute Lambda values\n    lambda_vals = sieve_for_lambda(max_x)\n    \n    results = []\n    for x, q, a in test_cases:\n        # 1. Compute psi(x; q, a)\n        psi = calculate_psi(x, q, a, lambda_vals)\n        \n        # 2. Compute M(x; q, a)\n        g = math.gcd(a, q)\n        if g == 1:\n            phi_q = phi(q)\n            m_xaq = x / phi_q\n        else:\n            m_xaq = 0.0\n            \n        # 3. Compute E(x; q, a)\n        e_xaq = psi - m_xaq\n        \n        # 4. Compute ratio and boolean check\n        sqrt_x = np.sqrt(x)\n        ratio = np.abs(e_xaq) / sqrt_x if sqrt_x > 0 else 0.0\n        is_le_heuristic = np.abs(e_xaq) <= sqrt_x\n        \n        results.append([psi, e_xaq, ratio, is_le_heuristic])\n\n    # Final print statement in the exact required format without spaces.\n    inner_strings = []\n    for r in results:\n        # Convert boolean to lowercase 'true'/'false' if required, but str(bool) gives 'True'/'False'\n        # The example format [...,boolean] suggests str(bool) is fine.\n        inner_strings.append(f\"[{r[0]},{r[1]},{r[2]},{r[3]}]\")\n    \n    print(f\"[{','.join(inner_strings)}]\")\n\nsolve()\n```", "id": "3025852"}, {"introduction": "解析数论中的一个核心技术是使用狄利克雷特征来分析算术级数上的和，这是一种傅里叶分析思想的体现。这个练习将引导你推导一个关键恒等式，它将算术级数素数定理中的误差项与涉及特征的和联系起来 [@problem_id:3025892]。掌握这种从物理空间（算术级数）到频率空间（特征）的转换对于理解庞贝里-维诺格拉多夫定理等结果的证明至关重要。", "problem": "设 $q \\geq 1$ 为一个整数，并令 $\\varphi(q)$ 表示欧拉总计函数。对于一个模 $q$ 的狄利克雷特征，记作 $\\chi \\pmod q$，并用 $\\chi_{0}$ 表示主特征。定义由特征扭曲的切比雪夫函数为\n$$\n\\psi(x,\\chi) \\;=\\; \\sum_{n \\leq x} \\Lambda(n)\\,\\chi(n),\n$$\n以及在简化剩余类 $a \\pmod q$ (其中 $(a,q)=1$) 中的切比雪夫函数为\n$$\n\\psi(x;q,a) \\;=\\; \\sum_{\\substack{n \\leq x \\\\ n \\equiv a \\,(\\bmod q)}} \\Lambda(n).\n$$\n定义算术级数中的素数定理的误差项为\n$$\nE(x;q,a) \\;=\\; \\psi(x;q,a) \\;-\\; \\frac{x}{\\varphi(q)}.\n$$\n\n假设狄利克雷特征的正交性：\n$$\n\\frac{1}{\\varphi(q)} \\sum_{\\chi \\,(\\bmod q)} \\overline{\\chi}(a)\\,\\chi(n)\n\\;=\\;\n\\begin{cases}\n1, & \\text{若 } n \\equiv a \\pmod q \\text{ 且 } (n,q)=1, \\\\\n0, & \\text{其他情况},\n\\end{cases}\n$$\n并假设对于某个函数 $\\mathcal{B}(x,Q)$ 和所有模 $q \\leq Q$，我们有以下一致界\n$$\n\\sum_{\\chi \\,(\\bmod q)} \\big|\\psi(x,\\chi)\\big| \\;\\leq\\; \\mathcal{B}(x,Q).\n$$\n\n仅使用这些输入以及狄利克雷特征和冯·曼戈尔特函数的基本性质，推导误差项的一个平均界，其形式如下\n$$\n\\frac{1}{\\varphi(q)} \\sum_{\\substack{a \\,(\\bmod q) \\\\ (a,q)=1}} \\big|E(x;q,a)\\big|\n\\;\\leq\\; C(q)\\, \\sum_{\\substack{\\chi \\,(\\bmod q) \\\\ \\chi \\neq \\chi_{0}}} \\big|\\psi(x,\\chi)\\big| \\;+\\; \\text{(显式主特征修正项)},\n$$\n并确定在剩余类求和与特征求和之间的转换中确定性地出现的精确乘法常数 $C(q)$。以 $q$ 的闭式表达式明确计算 $C(q)$。\n\n你的最终答案必须仅为 $C(q)$ 的表达式，不带单位。如果你选择化简，请提供一个精确的符号表达式（非数值近似）。", "solution": "问题旨在为算术级数素数定理中误差项的平均值推导一个界，并确定所产生的乘法常数 $C(q)$。\n\n首先，我们将算术级数的切比雪夫函数 $\\psi(x;q,a)$ 用扭曲的切比雪夫函数 $\\psi(x,\\chi)$ 来表示。问题给出了模 $q$ 的狄利克雷特征的正交关系：对于 $(a,q)=1$，\n$$\n\\frac{1}{\\varphi(q)} \\sum_{\\chi \\,(\\bmod q)} \\overline{\\chi}(a)\\,\\chi(n)\n\\;=\\;\n\\begin{cases}\n1, & \\text{若 } n \\equiv a \\pmod q,\\\\\n0, & \\text{其他情况}。\n\\end{cases}\n$$\n注意，对于 $n \\equiv a \\pmod q$ 且 $(a,q)=1$，必然有 $(n,q)=1$。冯·曼戈尔特函数 $\\Lambda(n)$ 仅在 $n$ 是素数幂 $n=p^k$ 时非零。对于一个模 $q$ 的特征 $\\chi$，标准定义是当 $(n,q)>1$ 时 $\\chi(n)=0$。因此，求和 $\\sum_{n \\leq x} \\Lambda(n)\\chi(n)$ 中的任何非零项都隐含了条件 $(n,q)=1$，除非 $q$ 是一个素数幂且 $n$ 是该素数的幂。然而，根据由本原特征诱导的特征的标准定义，对于所有模 $q$ 的特征 $\\chi$（可能当 $q=1$ 时除外），当 $(n,q)>1$ 时 $\\chi(n)=0$。问题陈述意味着我们正在以这种标准方式使用定义在 $\\mathbb{Z}$ 上的特征。\n\n使用正交关系，我们可以将 $\\psi(x;q,a)$ 写作：\n$$\n\\psi(x;q,a) \\;=\\; \\sum_{\\substack{n \\leq x \\\\ n \\equiv a \\,(\\bmod q)}} \\Lambda(n) \\;=\\; \\sum_{n \\leq x} \\Lambda(n) \\left( \\frac{1}{\\varphi(q)} \\sum_{\\chi \\,(\\bmod q)} \\overline{\\chi}(a)\\chi(n) \\right).\n$$\n我们可以交换求和顺序：\n$$\n\\psi(x;q,a) \\;=\\; \\frac{1}{\\varphi(q)} \\sum_{\\chi \\,(\\bmod q)} \\overline{\\chi}(a) \\sum_{n \\leq x} \\Lambda(n)\\chi(n) \\;=\\; \\frac{1}{\\varphi(q)} \\sum_{\\chi \\,(\\bmod q)} \\overline{\\chi}(a) \\psi(x,\\chi).\n$$\n\n接下来，我们构造误差项 $E(x;q,a)$：\n$$\nE(x;q,a) \\;=\\; \\psi(x;q,a) \\;-\\; \\frac{x}{\\varphi(q)} \\;=\\; \\frac{1}{\\varphi(q)} \\sum_{\\chi \\,(\\bmod q)} \\overline{\\chi}(a) \\psi(x,\\chi) \\;-\\; \\frac{x}{\\varphi(q)}.\n$$\n我们分离出来自于主特征 $\\chi_0$ 的贡献。因为 $(a,q)=1$，我们有 $\\overline{\\chi_0}(a)=1$。\n$$\nE(x;q,a) \\;=\\; \\frac{1}{\\varphi(q)} \\left( \\overline{\\chi_0}(a)\\psi(x,\\chi_0) + \\sum_{\\substack{\\chi \\,(\\bmod q) \\\\ \\chi \\neq \\chi_0}} \\overline{\\chi}(a)\\psi(x,\\chi) \\right) \\;-\\; \\frac{x}{\\varphi(q)}\n$$\n$$\nE(x;q,a) \\;=\\; \\frac{1}{\\varphi(q)} \\sum_{\\substack{\\chi \\,(\\bmod q) \\\\ \\chi \\neq \\chi_0}} \\overline{\\chi}(a)\\psi(x,\\chi) \\;+\\; \\frac{\\psi(x,\\chi_0) - x}{\\varphi(q)}.\n$$\n问题要求为 $|E(x;q,a)|$ 在所有模 $q$ 的简化剩余类 $a$ 上的平均值推导一个界。所要求的界的形式是两项之和，这提示我们使用三角不等式 $|A+B| \\leq |A|+|B|$。\n$$\n|E(x;q,a)| \\;\\leq\\; \\left| \\frac{1}{\\varphi(q)} \\sum_{\\substack{\\chi \\,(\\bmod q) \\\\ \\chi \\neq \\chi_0}} \\overline{\\chi}(a)\\psi(x,\\chi) \\right| \\;+\\; \\left| \\frac{\\psi(x,\\chi_0) - x}{\\varphi(q)} \\right|.\n$$\n现在，我们对这个不等式在满足 $(a,q)=1$ 的 $\\varphi(q)$ 个 $a$ 值上取平均：\n$$\n\\frac{1}{\\varphi(q)} \\sum_{\\substack{a \\,(\\bmod q) \\\\ (a,q)=1}} |E(x;q,a)| \\;\\leq\\; \\frac{1}{\\varphi(q)} \\sum_{\\substack{a \\,(\\bmod q) \\\\ (a,q)=1}} \\left| \\frac{1}{\\varphi(q)} \\sum_{\\substack{\\chi \\,(\\bmod q) \\\\ \\chi \\neq \\chi_0}} \\overline{\\chi}(a)\\psi(x,\\chi) \\right| \\;+\\; \\frac{|\\psi(x,\\chi_0) - x|}{\\varphi(q)}.\n$$\n第二项 $\\frac{|\\psi(x,\\chi_0) - x|}{\\varphi(q)}$ 就是问题陈述中提到的“显式主特征修正项”，因为它对 $a$ 的平均值就是其本身。\n\n我们现在关注第一项的上界，它必须具有 $C(q) \\sum_{\\chi \\neq \\chi_0} |\\psi(x,\\chi)|$ 的形式。令该项记为 $M$：\n$$\nM \\;=\\; \\frac{1}{\\varphi(q)} \\sum_{\\substack{a \\,(\\bmod q) \\\\ (a,q)=1}} \\left| \\frac{1}{\\varphi(q)} \\sum_{\\substack{\\chi \\,(\\bmod q) \\\\ \\chi \\neq \\chi_0}} \\overline{\\chi}(a)\\psi(x,\\chi) \\right| \\;=\\; \\frac{1}{\\varphi(q)^2} \\sum_{\\substack{a \\,(\\bmod q) \\\\ (a,q)=1}} \\left| \\sum_{\\substack{\\chi \\,(\\bmod q) \\\\ \\chi \\neq \\chi_0}} \\overline{\\chi}(a)\\psi(x,\\chi) \\right|.\n$$\n为了得到以 $\\sum |\\psi(x,\\chi)|$ 表示的界，我们对内部关于特征的求和应用三角不等式：\n$$\n\\left| \\sum_{\\substack{\\chi \\,(\\bmod q) \\\\ \\chi \\neq \\chi_0}} \\overline{\\chi}(a)\\psi(x,\\chi) \\right| \\;\\leq\\; \\sum_{\\substack{\\chi \\,(\\bmod q) \\\\ \\chi \\neq \\chi_0}} |\\overline{\\chi}(a)\\psi(x,\\chi)|.\n$$\n因为对于任何特征 $\\chi$ 和任何满足 $(a,q)=1$ 的 $a$，都有 $|\\overline{\\chi}(a)| = 1$，这可以简化为：\n$$\n\\left| \\sum_{\\substack{\\chi \\,(\\bmod q) \\\\ \\chi \\neq \\chi_0}} \\overline{\\chi}(a)\\psi(x,\\chi) \\right| \\;\\leq\\; \\sum_{\\substack{\\chi \\,(\\bmod q) \\\\ \\chi \\neq \\chi_0}} |\\psi(x,\\chi)|.\n$$\n将此代回 $M$ 的表达式中：\n$$\nM \\;\\leq\\; \\frac{1}{\\varphi(q)^2} \\sum_{\\substack{a \\,(\\bmod q) \\\\ (a,q)=1}} \\left( \\sum_{\\substack{\\chi \\,(\\bmod q) \\\\ \\chi \\neq \\chi_0}} |\\psi(x,\\chi)| \\right).\n$$\n内部关于 $\\chi \\neq \\chi_0$ 的求和不依赖于 $a$。外部关于 $a$ 的求和包含 $\\varphi(q)$ 个相同的项。\n$$\nM \\;\\leq\\; \\frac{1}{\\varphi(q)^2} \\cdot \\varphi(q) \\left( \\sum_{\\substack{\\chi \\,(\\bmod q) \\\\ \\chi \\neq \\chi_0}} |\\psi(x,\\chi)| \\right) \\;=\\; \\frac{1}{\\varphi(q)} \\sum_{\\substack{\\chi \\,(\\bmod q) \\\\ \\chi \\neq \\chi_0}} |\\psi(x,\\chi)|.\n$$\n这个推导得出了所需形式的界。通过将此结果与目标表达式\n$$\nM \\leq C(q)\\, \\sum_{\\substack{\\chi \\,(\\bmod q) \\\\ \\chi \\neq \\chi_{0}}} \\big|\\psi(x,\\chi)\\big|,\n$$\n进行比较，我们可以确定从这一系列标准步骤中“确定性地”产生的常数 $C(q)$。\n该常数为：\n$$\nC(q) \\;=\\; \\frac{1}{\\varphi(q)}.\n$$\n推导出的完整不等式是：\n$$\n\\frac{1}{\\varphi(q)} \\sum_{\\substack{a \\,(\\bmod q) \\\\ (a,q)=1}} |E(x;q,a)| \\;\\leq\\; \\frac{1}{\\varphi(q)} \\sum_{\\substack{\\chi \\,(\\bmod q) \\\\ \\chi \\neq \\chi_0}} |\\psi(x,\\chi)| \\;+\\; \\frac{|\\psi(x,\\chi_0) - x|}{\\varphi(q)}.\n$$\n问题要求 $C(q)$ 的显式闭式表达式，我们已经找到了它。", "answer": "$$\\boxed{\\frac{1}{\\varphi(q)}}$$", "id": "3025892"}, {"introduction": "通向埃利奥特-哈伯斯坦猜想的现代方法，例如张益唐用以证明素数间存在有界距离的方法，其核心在于对复杂的“双线性和”（或第二类和）进行精细估计。本练习提供了一个理想化的模型，用以理解这些估计是如何运作的，以及它们如何与“分布水平”这一关键概念相关联 [@problem_id:3025896]。通过这个练习，你将能定量地衡量一项突破性成果与完整猜想之间的差距，从而对该领域的研究前沿有一个具体的认识。", "problem": "设 $x$ 为一个大的实参数，并设 $\\rho \\in (0,1)$ 和 $\\theta \\in \\left[\\tfrac{1}{2},1\\right]$ 为固定的常数。定义 $y := x^{\\rho}$，并设 $\\mathcal{Q} := \\{q \\le x^{\\theta} : \\text{$q$ 是 $y$-光滑的}\\}$。考虑一个带光滑性约束的II型双线性色散和的平衡模型：选择整数 $M, N$ 满足 $MN = x$ 和 $M = N = x^{1/2}$，以及复权 $\\{\\alpha_{m}\\}_{m \\le M}$ 和 $\\{\\beta_{n}\\}_{n \\le N}$ 满足归一化条件\n$$\n\\sum_{m \\le M} |\\alpha_{m}|^{2} \\le M\n\\quad\\text{和}\\quad\n\\sum_{n \\le N} |\\beta_{n}|^{2} \\le N.\n$$\n对于 $q \\in \\mathcal{Q}$ 和 $(a,q)=1$，令\n$$\n\\Delta(q,a) \\;:=\\; \\sum_{m \\le M} \\alpha_{m} \\sum_{n \\le N} \\beta_{n}\\,\\mathbf{1}_{mn \\equiv a \\, (\\bmod\\, q)} \\;-\\; \\frac{1}{\\varphi(q)} \\sum_{\\substack{m \\le M,\\, n \\le N\\\\ (mn,q)=1}} \\alpha_{m}\\beta_{n},\n$$\n并定义在光滑模上的 $L^{1}$-平均双线性离差\n$$\n\\mathcal{B}(\\theta,\\rho;\\alpha,\\beta) \\;:=\\; \\sum_{q \\in \\mathcal{Q}} \\sum_{\\substack{a \\,(\\bmod\\, q)\\\\ (a,q)=1}} \\bigl|\\Delta(q,a)\\bigr|.\n$$\n\n你可以使用一个基本事实，即乘性大筛法不等式：对于任意支集在 $k \\le X$ 上的复序列 $\\{c_{k}\\}$，\n$$\n\\sum_{q \\le Q} \\frac{q}{\\varphi(q)} \\sum_{\\substack{\\chi \\,(\\bmod\\, q)\\\\ \\chi \\text{ primitive}}} \\left|\\sum_{k \\le X} c_{k}\\,\\chi(k)\\right|^{2} \\;\\ll\\; \\bigl(Q^{2}+X\\bigr)\\sum_{k \\le X} |c_{k}|^{2},\n$$\n其中隐含常数为绝对常数。你也可以使用 de Bruijn–Dickman 密度陈述，即小于等于 $Q=x^{\\theta}$ 的 $y$-光滑整数的比例为 $\\rho\\!\\left(\\frac{\\log Q}{\\log y}\\right)$，其中 $\\rho(\\cdot)$ 是 Dickman–de Bruijn 函数，它是一个仅依赖于 $\\theta/\\rho$ 的正常数，且不影响 $x$ 的幂次。\n\n(a) 使用大筛法和 Cauchy–Schwarz 不等式，证明在不计 $x^{o(1)}$ 因子和仅依赖于 $\\rho$、$\\theta$ 的常数的情况下，有如下模型界\n$$\n\\mathcal{B}(\\theta,\\rho;\\alpha,\\beta) \\;\\ll\\; Q\\,\\bigl(Q^{2}+X\\bigr)^{1/2}\\,X^{1/2},\n$$\n其中 $Q := x^{\\theta}$ 且 $X := MN = x$。由此断定，当 $M = N = x^{1/2}$ 时，能够期望 $\\mathcal{B}(\\theta,\\rho;\\alpha,\\beta) = o\\!\\bigl(QX\\bigr)$ 的阈值是 $Q \\asymp X^{1/2}$，即 $\\theta = \\tfrac{1}{2}$。\n\n(b) 在此模型中，定义与水平 $\\theta$ 相关联的节省指数为\n$$\n\\Delta(\\theta) \\;:=\\; \\theta - \\tfrac{1}{2},\n$$\n也即，可容许水平超过障碍 $\\tfrac{1}{2}$ 的量。假设 Zhang 的光滑模方法对于某个小的 $\\eta>0$ 提供了可容许水平 $\\theta_{Z} = \\tfrac{1}{2}+\\eta$ (对于 $q \\in \\mathcal{Q}$)，而 Elliott–Halberstam 猜想 (EH) 则假定可容许水平为 $\\theta_{\\mathrm{EH}} = 1$。令 $\\Delta_{Z} := \\Delta(\\theta_{Z})$ 和 $\\Delta_{\\mathrm{EH}} := \\Delta(\\theta_{\\mathrm{EH}})$。\n\n计算定量比较\n$$\n\\mathcal{R}(\\eta) \\;:=\\; \\frac{\\Delta_{Z}}{\\Delta_{\\mathrm{EH}}}\n$$\n结果用 $\\eta$ 的闭式表达式表示。请以简化的解析表达式给出你的最终答案。不需要四舍五入，也不涉及物理单位。", "solution": "该问题经评估有效，因为它科学地基于解析数论的既定原理，是适定、客观的，并包含足够的信息以获得唯一解。\n\n### (a)部分\n\n我们被要求为双线性离差和 $\\mathcal{B}(\\theta,\\rho;\\alpha,\\beta)$ 建立一个模型界，并确定获得非平凡估计的阈值。\n\n首先，我们使用 Dirichlet 特征来表示离差 $\\Delta(q,a)$。对于 $(a,q)=1$，条件 $mn \\equiv a \\pmod q$ 可以使用特征正交关系写成：\n$$\n\\mathbf{1}_{mn \\equiv a \\, (\\bmod\\, q)} = \\frac{1}{\\varphi(q)} \\sum_{\\chi \\,(\\bmod\\, q)} \\chi(mn)\\overline{\\chi(a)}.\n$$\n将此代入 $\\Delta(q,a)$ 的定义中，我们得到\n$$\n\\Delta(q,a) = \\frac{1}{\\varphi(q)} \\sum_{\\chi \\,(\\bmod\\, q)} \\overline{\\chi(a)} \\left(\\sum_{m \\le M} \\alpha_m \\chi(m)\\right) \\left(\\sum_{n \\le N} \\beta_n \\chi(n)\\right) - \\frac{1}{\\varphi(q)} \\sum_{\\substack{m \\le M,\\, n \\le N\\\\ (mn,q)=1}} \\alpha_{m}\\beta_{n}.\n$$\n第二项对应于模 $q$ 的主特征 $\\chi_0$ 的贡献。如果我们记 $A(\\chi) = \\sum_{m \\le M} \\alpha_m \\chi(m)$ 和 $B(\\chi) = \\sum_{n \\le N} \\beta_n \\chi(n)$，则 $\\Delta(q,a)$ 的表达式变为（不计关于互素条件 $(mn,q)=1$ 的细节，这些细节通常被吸收到 $x^{o(1)}$ 因子中）\n$$\n\\Delta(q,a) = \\frac{1}{\\varphi(q)} \\sum_{\\substack{\\chi \\,(\\bmod\\, q) \\\\ \\chi \\ne \\chi_0}} \\overline{\\chi(a)} A(\\chi) B(\\chi).\n$$\n需要界定的量是 $\\mathcal{B} = \\sum_{q \\in \\mathcal{Q}} \\sum_{a \\,(\\bmod\\, q), (a,q)=1} |\\Delta(q,a)|$。\n我们应用 Cauchy-Schwarz 不等式，首先对关于 $a$ 的和应用，然后对关于 $q$ 的和应用。\n$$\n\\mathcal{B} \\le \\sum_{q \\in \\mathcal{Q}} \\left( \\sum_{a \\,(\\bmod\\, q), (a,q)=1} 1 \\right)^{1/2} \\left( \\sum_{a \\,(\\bmod\\, q), (a,q)=1} |\\Delta(q,a)|^2 \\right)^{1/2} = \\sum_{q \\in \\mathcal{Q}} (\\varphi(q))^{1/2} \\left( \\sum_{a}^* |\\Delta(q,a)|^2 \\right)^{1/2}.\n$$\n关于 $a$ 的和可以使用特征正交性来计算：\n$$\n\\sum_{a}^* |\\Delta(q,a)|^2 = \\sum_a^* \\frac{1}{\\varphi(q)^2} \\left| \\sum_{\\chi \\ne \\chi_0} \\overline{\\chi(a)} A(\\chi)B(\\chi) \\right|^2 = \\frac{1}{\\varphi(q)} \\sum_{\\chi \\ne \\chi_0} |A(\\chi)B(\\chi)|^2.\n$$\n所以，$\\mathcal{B} \\le \\sum_{q \\in \\mathcal{Q}} \\left(\\sum_{\\chi \\ne \\chi_0} |A(\\chi)B(\\chi)|^2\\right)^{1/2}$。对关于 $q$ 的和应用 Cauchy-Schwarz 不等式得到\n$$\n\\mathcal{B}^2 \\le \\left(\\sum_{q \\in \\mathcal{Q}} 1 \\right) \\left(\\sum_{q \\in \\mathcal{Q}} \\sum_{\\chi \\ne \\chi_0} |A(\\chi)B(\\chi)|^2 \\right) \\le |\\mathcal{Q}| \\sum_{q \\in \\mathcal{Q}} \\left( \\max_{\\psi \\ne \\psi_0 \\pmod q} |A(\\psi)|^2 \\right) \\left( \\sum_{\\chi \\ne \\chi_0} |B(\\chi)|^2 \\right).\n$$\n这条路径比较复杂。一个更直接的途径是首先对 $\\mathcal{B}$ 表达式内的特征和使用 Cauchy-Schwarz 不等式。\n$$\n|\\Delta(q,a)| \\le \\frac{1}{\\varphi(q)} \\sum_{\\chi \\ne \\chi_0} |A(\\chi)B(\\chi)| \\le \\frac{1}{\\varphi(q)} \\left(\\sum_{\\chi \\ne \\chi_0} |A(\\chi)|^2\\right)^{1/2} \\left(\\sum_{\\chi \\ne \\chi_0} |B(\\chi)|^2\\right)^{1/2}.\n$$\n这个界与 $a$ 无关，所以对 $a$ 求和会给出一个因子 $\\varphi(q)$：\n$$\n\\mathcal{B} \\le \\sum_{q \\in \\mathcal{Q}} \\left(\\sum_{\\chi \\ne \\chi_0} |A(\\chi)|^2\\right)^{1/2} \\left(\\sum_{\\chi \\ne \\chi_0} |B(\\chi)|^2\\right)^{1/2}.\n$$\n再次应用 Cauchy-Schwarz 不等式，这次是对关于 $q$ 的和：\n$$\n\\mathcal{B} \\le \\left(\\sum_{q \\in \\mathcal{Q}} \\sum_{\\chi \\ne \\chi_0} |A(\\chi)|^2\\right)^{1/2} \\left(\\sum_{q \\in \\mathcal{Q}} \\sum_{\\chi \\ne \\chi_0} |B(\\chi)|^2\\right)^{1/2}.\n$$\n我们来分析第一个因子 $\\mathcal{S}_A = \\sum_{q \\in \\mathcal{Q}} \\sum_{\\chi \\ne \\chi_0} |A(\\chi)|^2$。我们可以去掉对 $q$ 的光滑性约束来得到一个上界。\n$$\n\\mathcal{S}_A \\le \\sum_{q \\le Q} \\sum_{\\chi \\ne \\chi_0} |A(\\chi)|^2 = \\sum_{q \\le Q} \\sum_{\\chi \\ne \\chi_0} \\left|\\sum_{m \\le M} \\alpha_m \\chi(m)\\right|^2.\n$$\n大筛法不等式的一个标准版本表明（在不计 $x^{o(1)}$ 因子的情况下）\n$$\n\\sum_{q \\le Q} \\sum_{\\chi \\pmod q, \\chi \\ne \\chi_0} \\left|\\sum_{m \\le M} c_m \\chi(m)\\right|^2 \\ll (Q^2 + M) \\sum_{m \\le M} |c_m|^2 \\quad (\\text{up to } x^{o(1)} \\text{ factors}).\n$$\n使用这个不等式（可以从给定的本原特征大筛法结合分部求和推导出来），以及归一化条件 $\\sum |\\alpha_m|^2 \\le M$，我们得到：\n$$\n\\mathcal{S}_A \\ll (Q^2+M)M.\n$$\n类似地，对于序列 $\\beta_n$，\n$$\n\\mathcal{S}_B = \\sum_{q \\in \\mathcal{Q}} \\sum_{\\chi \\ne \\chi_0} |B(\\chi)|^2 \\ll (Q^2+N)N.\n$$\n将这些代回到 $\\mathcal{B}$ 的界中，我们得到\n$$\n\\mathcal{B} \\ll \\left( (Q^2+M)M \\right)^{1/2} \\left( (Q^2+N)N \\right)^{1/2}.\n$$\n给定 $M=N=x^{1/2}$，$X=x$，以及 $Q=x^\\theta$：\n$$\n\\mathcal{B} \\ll \\left( (x^{2\\theta}+x^{1/2})x^{1/2} \\right)^{1/2} \\left( (x^{2\\theta}+x^{1/2})x^{1/2} \\right)^{1/2} = (x^{2\\theta}+x^{1/2})x^{1/2}.\n$$\n问题要求证明 $\\mathcal{B} \\ll Q(Q^2+X)^{1/2}X^{1/2} = x^\\theta(x^{2\\theta}+x)^{1/2}x^{1/2}$。对于给定的范围 $\\theta \\in [\\frac{1}{2}, 1]$，我们有 $x^\\theta \\ge x^{1/2}$，所以 $x^{2\\theta} \\ge x$。\n我们推导出的界约等于 $(x^{2\\theta})x^{1/2} = x^{2\\theta+1/2}$。\n模型界约等于 $x^\\theta(x^{2\\theta})^{1/2}x^{1/2} = x^\\theta x^\\theta x^{1/2} = x^{2\\theta+1/2}$。\n对于 $\\theta \\ge 1/2$，这两个界在 $x$ 的幂次方面具有相同的数量级。所陈述的模型界是一个标准变体，我们采纳它继续进行。\n\n$\\mathcal{B}$ 的一个非平凡界意味着它比主项有节省，即 $\\mathcal{B} = o(QX)$。$Q=x^\\theta$ 且 $X=x$。我们检验模型界在何时满足此条件。\n$$\nQ(Q^2+X)^{1/2}X^{1/2} = o(QX).\n$$\n除以 $QX^{1/2}$（它是正的），我们得到\n$$\n(Q^2+X)^{1/2} = o(X^{1/2}).\n$$\n两边平方，\n$$\nQ^2+X = o(X),\n$$\n由于 $X$ 是正的，这简化为 $Q^2 = o(X)$。代入 $Q=x^\\theta$ 和 $X=x$：\n$$\nx^{2\\theta} = o(x).\n$$\n此条件当且仅当 $2\\theta < 1$，即 $\\theta < \\frac{1}{2}$ 时成立。因此，对于 $\\theta < \\frac{1}{2}$ 可以实现节省。$\\theta = \\frac{1}{2}$ 这个值代表了阈值或“障碍”，在该点上，界与主项具有相同的数量级，并且此方法不能保证有任何幂次的节省。这与类似问题（如 Bombieri-Vinogradov 定理）中已知的“平方根障碍”相符。\n\n### (b)部分\n\n我们被要求计算比率 $\\mathcal{R}(\\eta) = \\frac{\\Delta_Z}{\\Delta_{EH}}$。\n节省指数定义为 $\\Delta(\\theta) := \\theta - \\frac{1}{2}$。\n\n首先，我们计算与 Zhang 方法的水平 $\\theta_Z = \\frac{1}{2} + \\eta$ 对应的节省指数 $\\Delta_Z$。\n$$\n\\Delta_Z = \\Delta(\\theta_Z) = \\theta_Z - \\frac{1}{2} = \\left(\\frac{1}{2} + \\eta\\right) - \\frac{1}{2} = \\eta.\n$$\n接着，我们计算与 Elliott-Halberstam 猜想的水平 $\\theta_{EH} = 1$ 对应的节省指数 $\\Delta_{EH}$。\n$$\n\\Delta_{EH} = \\Delta(\\theta_{EH}) = \\theta_{EH} - \\frac{1}{2} = 1 - \\frac{1}{2} = \\frac{1}{2}.\n$$\n最后，我们计算比率 $\\mathcal{R}(\\eta)$：\n$$\n\\mathcal{R}(\\eta) = \\frac{\\Delta_Z}{\\Delta_{EH}} = \\frac{\\eta}{\\frac{1}{2}} = 2\\eta.\n$$\n这提供了 Zhang 的结果相对于完整的 Elliott-Halberstam 猜想的“强度”的定量比较，该比较是基于超过 $\\theta=\\frac{1}{2}$ 障碍的可容许分布水平。", "answer": "$$\\boxed{2\\eta}$$", "id": "3025896"}]}