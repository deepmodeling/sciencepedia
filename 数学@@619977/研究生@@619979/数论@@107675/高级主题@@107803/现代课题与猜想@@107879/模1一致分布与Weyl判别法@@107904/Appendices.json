{"hands_on_practices": [{"introduction": "理论的生命力在于实践。本章的第一个练习旨在通过直接应用等分布的定义来加深理解。我们将分析两个序列，一个是经典的等分布序列，另一个则不是。通过计算它们在特定区间内的渐进频率，你将亲身体会到一个序列的“均匀性”是如何通过其项在单位区间 $[0,1)$ 中分布的比例来精确刻画的。这个练习是建立对等分布概念直观认识的基石。[@problem_id:3030171]", "problem": "设 $\\{x\\}$ 表示实数 $x$ 的小数部分。考虑由下式定义的两个序列 $(u_{n})_{n \\geq 1}$ 和 $(v_{n})_{n \\geq 1}$\n$$u_{n} = \\{n \\sqrt{3}\\}, \\qquad v_{n} = \\left\\{\\frac{n}{2}\\right\\}.$$\n对于区间 $I = [0, \\frac{1}{3})$ 和 $J = [\\frac{1}{4}, \\frac{3}{4})$，求以下四个极限\n$$L_{u}(I) = \\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{n=1}^{N} \\mathbf{1}_{I}(u_{n}), \\quad L_{u}(J) = \\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{n=1}^{N} \\mathbf{1}_{J}(u_{n}),$$\n$$L_{v}(I) = \\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{n=1}^{N} \\mathbf{1}_{I}(v_{n}), \\quad L_{v}(J) = \\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{n=1}^{N} \\mathbf{1}_{J}(v_{n}).$$\n然后，使用模1均匀分布的区间频率定义，说明 $(u_{n})$ 和 $(v_{n})$ 中哪一个是模1均匀分布的，哪一个不是。\n\n你的最终答案必须以一个单行矩阵的形式精确给出，矩阵包含按 $L_{u}(I)$、$L_{u}(J)$、$L_{v}(I)$、$L_{v}(J)$ 顺序排列的四个极限值，不得四舍五入。", "solution": "该问题要求计算与序列 $(u_{n})_{n \\geq 1}$ 和 $(v_{n})_{n \\geq 1}$ 相关的四个极限，并随后判断这些序列是否是模1均匀分布的。该分析基于均匀分布的定义。\n\n一个实数序列 $(x_n)_{n \\geq 1}$ 被称为模1均匀分布的，如果对于任意子区间 $[a, b) \\subseteq [0, 1)$，其小数部分 $\\{x_n\\}$ 落入 $[a, b)$ 的比例收敛于该区间的长度。形式上，这表示为：\n$$ \\lim_{N \\to \\infty} \\frac{1}{N} \\left| \\{ n \\in \\{1, 2, \\dots, N\\} : \\{x_n\\} \\in [a, b) \\} \\right| = b - a $$\n问题中的表达式 $\\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{n=1}^{N} \\mathbf{1}_{I}(x_{n})$ 是一个等价的表述，其中 $\\mathbf{1}_{I}$ 是区间 $I$ 的示性函数，这里的 $x_n$ 表示小数部分。该极限如果存在，表示序列的项在区间 $I$ 中的渐近频率。对于一个均匀分布的序列，这个极限必须等于区间的长度，即 $\\text{length}(I)$。\n\n首先，我们来分析由 $u_{n} = \\{n \\sqrt{3}\\}$ 定义的序列 $(u_{n})_{n \\geq 1}$。\n该序列的形式为 $\\{n\\alpha\\}$，其中 $\\alpha = \\sqrt{3}$。均匀分布理论中的一个基本结果是 Weyl 判据，其一个特例，即等分布定理，指出序列 $(\\{n\\alpha\\})_{n \\geq 1}$ 是模1均匀分布的当且仅当 $\\alpha$ 是一个无理数。\n由于 $\\sqrt{3}$ 是一个无理数，所以序列 $(u_n)$ 是模1均匀分布的。\n根据均匀分布的定义，对于任何区间 $[a, b) \\subseteq [0, 1)$，落入该区间的项的频率极限等于其长度 $b-a$。\n\n第一个区间是 $I = [0, \\frac{1}{3})$。其长度为 $\\text{length}(I) = \\frac{1}{3} - 0 = \\frac{1}{3}$。\n因此，对于序列 $(u_n)$，极限为：\n$$L_{u}(I) = \\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{n=1}^{N} \\mathbf{1}_{I}(u_{n}) = \\text{length}(I) = \\frac{1}{3}$$\n\n第二个区间是 $J = [\\frac{1}{4}, \\frac{3}{4})$。其长度为 $\\text{length}(J) = \\frac{3}{4} - \\frac{1}{4} = \\frac{2}{4} = \\frac{1}{2}$。\n因此，对于序列 $(u_n)$，极限为：\n$$L_{u}(J) = \\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{n=1}^{N} \\mathbf{1}_{J}(u_{n}) = \\text{length}(J) = \\frac{1}{2}$$\n序列 $(u_n)$ 确实是模1均匀分布的，因为这些极限与区间长度相匹配，这个性质对 $[0, 1)$ 的所有子区间都成立。\n\n接下来，我们分析由 $v_{n} = \\left\\{\\frac{n}{2}\\right\\}$ 定义的序列 $(v_{n})_{n \\geq 1}$。\n该序列的形式为 $\\{n\\alpha\\}$，其中 $\\alpha = \\frac{1}{2}$ 是一个有理数。等分布定理意味着这个序列不是模1均匀分布的。为了计算极限，我们必须直接考察序列的各项。\n当 $n=1$ 时，$v_1 = \\{\\frac{1}{2}\\} = \\frac{1}{2}$。\n当 $n=2$ 时，$v_2 = \\{\\frac{2}{2}\\} = \\{1\\} = 0$。\n当 $n=3$ 时，$v_3 = \\{\\frac{3}{2}\\} = \\{1 + \\frac{1}{2}\\} = \\frac{1}{2}$。\n当 $n=4$ 时，$v_4 = \\{\\frac{4}{2}\\} = \\{2\\} = 0$。\n该序列是周期为2的周期序列，在值 $\\frac{1}{2}$ 和 $0$ 之间交替。该序列取到的值的集合是 $\\{0, \\frac{1}{2}\\}$。\n\n我们现在计算区间 $I = [0, \\frac{1}{3})$ 的极限 $L_v(I)$。\n我们需要确定对于哪些 $n$ 值，项 $v_n$ 位于 $I$ 中。\n如果 $n$ 是偶数，即 $n=2k$ (对于某个整数 $k \\geq 1$)，那么 $v_n = v_{2k} = \\{k\\} = 0$。由于 $0 \\in [0, \\frac{1}{3})$，所以序列中每个偶数项都落入 $I$ 中。\n如果 $n$ 是奇数，即 $n=2k-1$ (对于某个整数 $k \\geq 1$)，那么 $v_n = v_{2k-1} = \\{\\frac{2k-1}{2}\\} = \\{k - \\frac{1}{2}\\} = \\frac{1}{2}$。由于 $\\frac{1}{2} \\notin [0, \\frac{1}{3})$，所以没有奇数项落入 $I$ 中。\n对于 $n \\in \\{1, 2, \\dots, N\\}$，落入 $I$ 中的项 $v_n$ 的数量是直到 $N$ 的偶数的数量，即 $\\lfloor \\frac{N}{2} \\rfloor$。\n因此，极限为：\n$$L_{v}(I) = \\lim_{N \\to \\infty} \\frac{1}{N} \\lfloor \\frac{N}{2} \\rfloor$$\n由于 $\\frac{N}{2} - 1 < \\lfloor \\frac{N}{2} \\rfloor \\leq \\frac{N}{2}$，我们可以写出 $\\frac{1}{2} - \\frac{1}{N} < \\frac{1}{N} \\lfloor \\frac{N}{2} \\rfloor \\leq \\frac{1}{2}$。根据夹逼定理，当 $N \\to \\infty$ 时，极限是 $\\frac{1}{2}$。\n$$L_{v}(I) = \\frac{1}{2}$$\n\n最后，我们计算区间 $J = [\\frac{1}{4}, \\frac{3}{4})$ 的极限 $L_v(J)$。\n再次，我们确定对于哪些 $n$ 值，项 $v_n$ 位于 $J$ 中。\n如果 $n$ 是偶数，$v_n = 0$。由于 $0 \\notin [\\frac{1}{4}, \\frac{3}{4})$，没有偶数项落入 $J$ 中。\n如果 $n$ 是奇数，$v_n = \\frac{1}{2}$。由于 $\\frac{1}{4} \\leq \\frac{1}{2} < \\frac{3}{4}$，我们有 $\\frac{1}{2} \\in [\\frac{1}{4}, \\frac{3}{4})$。因此，序列中的每个奇数项都落入 $J$ 中。\n对于 $n \\in \\{1, 2, \\dots, N\\}$，落入 $J$ 中的项 $v_n$ 的数量是直到 $N$ 的奇数的数量，即 $\\lceil \\frac{N}{2} \\rceil$。\n因此，极限为：\n$$L_{v}(J) = \\lim_{N \\to \\infty} \\frac{1}{N} \\lceil \\frac{N}{2} \\rceil$$\n由于 $\\frac{N}{2} \\leq \\lceil \\frac{N}{2} \\rceil < \\frac{N}{2} + 1$，我们可以写出 $\\frac{1}{2} \\leq \\frac{1}{N} \\lceil \\frac{N}{2} \\rceil < \\frac{1}{2} + \\frac{1}{N}$。根据夹逼定理，当 $N \\to \\infty$ 时，极限是 $\\frac{1}{2}$。\n$$L_{v}(J) = \\frac{1}{2}$$\n\n总而言之，序列 $(v_n)$ 不是模1均匀分布的。一个明确的理由是，对于区间 $I$，极限频率为 $L_v(I)=\\frac{1}{2}$，而区间的长度为 $\\text{length}(I) = \\frac{1}{3}$。由于 $\\frac{1}{2} \\neq \\frac{1}{3}$，均匀分布的条件没有被满足。\n\n计算出的四个极限是：\n$L_{u}(I) = \\frac{1}{3}$\n$L_{u}(J) = \\frac{1}{2}$\n$L_{v}(I) = \\frac{1}{2}$\n$L_{v}(J) = \\frac{1}{2}$", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{3} & \\frac{1}{2} & \\frac{1}{2} & \\frac{1}{2} \\end{pmatrix}}$$", "id": "3030171"}, {"introduction": "虽然等分布的定义在直观上很清晰，但在实际应用中逐一检验所有子区间是不可行的。幸运的是，Weyl 判据提供了一个强大得多的分析工具。这个练习将引导你深入 Weyl 判据的核心机制：通过推导和界定一个关键的指数和，来证明 Kronecker 序列的等分布性。完成这项练习将不仅提升你处理有限几何级数和三角恒等式的技巧，更重要的是，它将揭示为何指数和的振荡抵消是序列均匀性的根本保证。[@problem_id:3030179]", "problem": "设 $\\alpha \\in \\mathbb{R}$ 为一无理数，且 $k \\in \\mathbb{Z} \\setminus \\{0\\}$。考虑指数和\n$$S_{N}(k) \\coloneqq \\sum_{n=1}^{N} \\exp(2\\pi i k n \\alpha),$$\n该和出现在通过 Weyl 判据研究模 1 均匀分布的过程中。仅从关于复指数的基本恒等式，即 $\\exp(i\\theta) = \\cos(\\theta) + i \\sin(\\theta)$ 以及当 $r \\neq 1$ 时的有限几何级数恒等式\n$$\\sum_{n=1}^{N} r^{n} = r \\,\\frac{1 - r^{N}}{1 - r},$$\n出发，推导 $S_{N}(k)$ 的一个用三角函数表示的闭式表达式。然后，使用你推导出的表达式，对无理数 $\\alpha$ 的情况下的模 $|S_{N}(k)|$ 进行定界，并确定其上极限\n$$\\limsup_{N \\to \\infty} |S_{N}(k)|.$$\n你可以引用当 $\\beta$ 为无理数时序列 $\\{n\\beta \\bmod 1\\}_{n \\geq 1}$ 的稠密性的标准结论，并且你应该解释你的界限如何与模 1 均匀分布和 Weyl 判据相关联，而不依赖于任何超出其陈述本身的现成定理。\n\n请将你的最终答案表示为\n$$\\limsup_{N \\to \\infty} |S_{N}(k)|$$\n的单个闭式解析表达式，用 $k$ 和 $\\alpha$ 表示。无需四舍五入。", "solution": "问题陈述经核实具有科学依据、问题适定且客观。这是均匀分布理论中的一个标准问题。我们开始解题。\n\n问题要求分析指数和 $S_{N}(k) = \\sum_{n=1}^{N} \\exp(2\\pi i k n \\alpha)$，其中 $\\alpha \\in \\mathbb{R}$ 是一个无理数， $k \\in \\mathbb{Z} \\setminus \\{0\\}$。\n\n首先，我们推导 $S_{N}(k)$ 的闭式表达式。这个和是一个有限几何级数，其首项和公比均为 $r = \\exp(2\\pi i k \\alpha)$。该级数求和公式为 $\\sum_{n=1}^{N} r^{n} = r \\frac{1 - r^{N}}{1 - r}$，条件是 $r \\neq 1$。\n我们必须验证 $r \\neq 1$。公比为 $r = \\exp(2\\pi i k \\alpha)$。要使 $r=1$，指数 $2\\pi k \\alpha$ 必须是 $2\\pi$ 的整数倍，这意味着 $k\\alpha$ 必须是整数。然而，已知 $\\alpha$ 是一个无理数，而 $k$ 是一个非零整数。一个非零整数与一个无理数的乘积总是一个无理数。无理数不可能是整数。因此，$k\\alpha \\notin \\mathbb{Z}$，这意味着 $r \\neq 1$。所以，几何级数公式适用。\n\n$S_{N}(k) = \\exp(2\\pi i k \\alpha) \\frac{1 - \\exp(2\\pi i k N \\alpha)}{1 - \\exp(2\\pi i k \\alpha)}$。\n\n为将其用三角函数表示，我们使用恒等式 $1 - \\exp(i\\theta) = \\exp(i\\theta/2)(\\exp(-i\\theta/2) - \\exp(i\\theta/2))$。根据给定的恒等式 $\\exp(i\\phi) = \\cos(\\phi) + i\\sin(\\phi)$，我们有 $\\exp(-i\\phi) = \\cos(\\phi) - i\\sin(\\phi)$。因此，$\\exp(-i\\phi) - \\exp(i\\phi) = -2i\\sin(\\phi)$。设 $\\phi=\\theta/2$，我们得到 $1 - \\exp(i\\theta) = \\exp(i\\theta/2)(-2i \\sin(\\theta/2))$。\n\n将此恒等式应用于我们分数式的分子和分母：\n分子为 $1 - \\exp(2\\pi i k N \\alpha)$。这里，$\\theta = 2\\pi k N \\alpha$，所以 $\\theta/2 = \\pi k N \\alpha$。\n$1 - \\exp(2\\pi i k N \\alpha) = \\exp(i \\pi k N \\alpha)(-2i \\sin(\\pi k N \\alpha))$。\n分母为 $1 - \\exp(2\\pi i k \\alpha)$。这里，$\\theta = 2\\pi k \\alpha$，所以 $\\theta/2 = \\pi k \\alpha$。\n$1 - \\exp(2\\pi i k \\alpha) = \\exp(i \\pi k \\alpha)(-2i \\sin(\\pi k \\alpha))$。\n\n将这些代入 $S_N(k)$ 的表达式中：\n$$S_{N}(k) = \\exp(2\\pi i k \\alpha) \\frac{\\exp(i \\pi k N \\alpha)(-2i \\sin(\\pi k N \\alpha))}{\\exp(i \\pi k \\alpha)(-2i \\sin(\\pi k \\alpha))}$$\n$$S_{N}(k) = \\exp(2\\pi i k \\alpha) \\exp(i \\pi k (N-1) \\alpha) \\frac{\\sin(\\pi k N \\alpha)}{\\sin(\\pi k \\alpha)}$$\n合并指数项：\n$$S_{N}(k) = \\exp(i(2\\pi k \\alpha + \\pi k N \\alpha - \\pi k \\alpha)) \\frac{\\sin(\\pi k N \\alpha)}{\\sin(\\pi k \\alpha)}$$\n$$S_{N}(k) = \\exp(i\\pi k (N+1) \\alpha) \\frac{\\sin(\\pi k N \\alpha)}{\\sin(\\pi k \\alpha)}$$\n这就是所求的闭式表达式。使用 $\\exp(i\\theta)=\\cos(\\theta)+i\\sin(\\theta)$, 它可以完全用三角函数写成：\n$$S_{N}(k) = \\left(\\cos(\\pi k (N+1)\\alpha) + i\\sin(\\pi k (N+1) \\alpha)\\right) \\frac{\\sin(\\pi k N \\alpha)}{\\sin(\\pi k \\alpha)}$$\n\n接着，我们对模 $|S_{N}(k)|$ 进行定界。积的模等于模的积。\n$$|S_{N}(k)| = \\left| \\exp(i\\pi k (N+1) \\alpha) \\frac{\\sin(\\pi k N \\alpha)}{\\sin(\\pi k \\alpha)} \\right|$$\n由于对任意实数 $\\theta$ 都有 $|\\exp(i\\theta)|=1$，我们有 $|\\exp(i\\pi k (N+1) \\alpha)| = 1$。\n$$|S_{N}(k)| = \\left| \\frac{\\sin(\\pi k N \\alpha)}{\\sin(\\pi k \\alpha)} \\right| = \\frac{|\\sin(\\pi k N \\alpha)|}{|\\sin(\\pi k \\alpha)|}$$\n正弦函数以 1 为界，所以 $|\\sin(\\pi k N \\alpha)| \\leq 1$。这给出了界：\n$$|S_{N}(k)| \\leq \\frac{1}{|\\sin(\\pi k \\alpha)|}$$\n由于 $k\\alpha$ 是无理数，$\\pi k \\alpha$ 不是 $\\pi$ 的整数倍，所以 $\\sin(\\pi k \\alpha) \\neq 0$。这个界是有限的，并且与 $N$ 无关。\n\n现在我们确定上极限 $\\limsup_{N \\to \\infty} |S_{N}(k)|$。\n$$\\limsup_{N \\to \\infty} |S_{N}(k)| = \\limsup_{N \\to \\infty} \\frac{|\\sin(\\pi k N \\alpha)|}{|\\sin(\\pi k \\alpha)|} = \\frac{1}{|\\sin(\\pi k \\alpha)|} \\limsup_{N \\to \\infty} |\\sin(\\pi k N \\alpha)|$$\n设 $\\beta = k\\alpha$。由于 $k \\in \\mathbb{Z} \\setminus \\{0\\}$ 且 $\\alpha$ 是无理数，$\\beta$ 也是无理数。我们需要求 $\\limsup_{N \\to \\infty} |\\sin(\\pi N \\beta)|$。\n问题允许我们使用这样一个事实：小数部分序列 $\\{N\\beta \\pmod 1\\}_{N \\geq 1}$ 在区间 $[0,1)$ 中是稠密的。设 $x_N = N\\beta \\pmod 1 = N\\beta - \\lfloor N\\beta \\rfloor$。值集合 $\\{x_N\\}_{N \\geq 1}$ 是 $[0,1)$ 的一个稠密子集。\n我们可以写出 $\\sin(\\pi N \\beta) = \\sin(\\pi(x_N + \\lfloor N\\beta \\rfloor)) = \\sin(\\pi x_N)\\cos(\\pi\\lfloor N\\beta \\rfloor) + \\cos(\\pi x_N)\\sin(\\pi\\lfloor N\\beta \\rfloor)$。由于 $\\lfloor N\\beta \\rfloor$ 是一个整数, $\\sin(\\pi\\lfloor N\\beta \\rfloor) = 0$ 且 $\\cos(\\pi\\lfloor N\\beta \\rfloor) = (-1)^{\\lfloor N\\beta \\rfloor}$。\n因此，$\\sin(\\pi N \\beta) = (-1)^{\\lfloor N\\beta \\rfloor}\\sin(\\pi x_N)$，这意味着 $|\\sin(\\pi N \\beta)| = |\\sin(\\pi x_N)|$。\n我们要求的是 $\\limsup_{N \\to \\infty} |\\sin(\\pi x_N)|$。因为集合 $\\{x_N\\}$ 在 $[0,1)$ 中是稠密的，所以集合 $\\{\\pi x_N\\}$ 在 $[0,\\pi)$ 中是稠密的。函数 $f(z) = |\\sin(z)|$ 在 $[0,\\pi)$ 上是连续的。对于一个其值在某区间内稠密的序列，函数在这些点上的值的上极限等于函数在该区间上的上确界。\n$$\\limsup_{N \\to \\infty} |\\sin(\\pi x_N)| = \\sup_{y \\in [0,1)} |\\sin(\\pi y)|$$\n在 $[0,1)$ 上，$\\pi y \\in [0,\\pi)$，所以 $\\sin(\\pi y) \\geq 0$，这意味着 $|\\sin(\\pi y)| = \\sin(\\pi y)$。当 $y \\in [0,1)$ 时，$\\sin(\\pi y)$ 的上确界是 1，在 $y$ 趋近于 $1/2$ 时达到。\n因此，$\\limsup_{N \\to \\infty} |\\sin(\\pi k N \\alpha)| = 1$。\n将此结果代回到 $|S_N(k)|$ 的上极限表达式中：\n$$\\limsup_{N \\to \\infty} |S_{N}(k)| = \\frac{1}{|\\sin(\\pi k \\alpha)|} \\cdot 1 = \\frac{1}{|\\sin(\\pi k \\alpha)|}$$\n这个结果表明，虽然和 $S_N(k)$ 是有界的，但它们的模会周期性地任意接近于界 $\\frac{1}{|\\sin(\\pi k \\alpha)|}$。\n\n最后，我们解释我们推导出的界与 Weyl 均匀分布判据之间的联系。Weyl 判据指出，序列 $\\{x_n\\}_{n \\geq 1}$ 是模 1 均匀分布的，当且仅当对于每个非零整数 $k$，都有\n$$\\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{n=1}^{N} \\exp(2\\pi i k x_n) = 0$$\n对于我们的序列 $x_n = n\\alpha$，此条件变为 $\\lim_{N \\to \\infty} \\frac{1}{N} S_N(k) = 0$ 对所有 $k \\in \\mathbb{Z} \\setminus \\{0\\}$ 成立。\n让我们来考察平均值的模：\n$$\\left| \\frac{1}{N} S_N(k) \\right| = \\frac{1}{N} |S_N(k)|$$\n使用我们推导出的界 $|S_N(k)| \\leq \\frac{1}{|\\sin(\\pi k \\alpha)|}$，我们得到关于平均值的一个不等式：\n$$0 \\leq \\left| \\frac{1}{N} S_N(k) \\right| \\leq \\frac{1}{N} \\frac{1}{|\\sin(\\pi k \\alpha)|}$$\n当 $N \\to \\infty$时，不等式的右侧趋近于 0，因为 $|\\sin(\\pi k \\alpha)|$ 是一个正常数。根据夹逼定理，可以得出 $\\lim_{N \\to \\infty} \\left| \\frac{1}{N} S_N(k) \\right| = 0$。如果一个复数序列的模的极限为 0，那么该序列本身的极限也为 0。\n因此，$\\lim_{N \\to \\infty} \\frac{1}{N} S_N(k) = 0$。\n关键的联系在于，和 $|S_N(k)|$ 的有界性（它不随 $N$ 增长）确保了当它被 $N$ 除时，得到的平均值在 $N \\to \\infty$ 时会趋于零。这对所有非零整数 $k$ 都成立，从而证明了序列 $\\{n\\alpha \\pmod 1\\}$ 是均匀分布的。", "answer": "$$\n\\boxed{\\frac{1}{|\\sin(\\pi k \\alpha)|}}\n$$", "id": "3030179"}, {"introduction": "等分布序列的世界远不止于 $\\{n\\alpha\\}$ 这类的 Kronecker 序列。本练习将介绍另一类基石性的例子——van der Corput 序列，它是一种通过“数字翻转”构造的低偏差序列。你将通过一系列步骤，证明其初始分段的完美均匀性，利用 Weyl 判据验证其整体的等分布性质，并最终证明它在结构上与任何线性递推序列有本质区别。这项实践不仅能让你掌握一个在拟蒙特卡罗方法中至关重要的新序列，还能加深你对序列“均匀性”质量的更精细理解。[@problem_id:3030160]", "problem": "令 $\\{x_{n}\\}_{n \\geq 0}$ 表示以 $2$ 为基的 van der Corput 序列，其定义通过以下数字反转构造得出：对于每个具有二进制展开式 $n = \\sum_{j=0}^{J} a_{j}(n)\\,2^{j}$ 的整数 $n \\geq 0$，其中 $a_{j}(n) \\in \\{0,1\\}$ 且只有有限个 $a_{j}(n)$ 非零，设\n$$\nx_{n} \\coloneqq \\sum_{j=0}^{\\infty} \\frac{a_{j}(n)}{2^{j+1}},\n$$\n这是一个有限和，因为对于所有足够大的 $j$，$a_{j}(n) = 0$。考虑以下基本概念：\n- 如果对于 $[0,1)$ 中的每个区间 $[a,b) \\subset [0,1)$，一个在 $[0,1)$ 中的序列 $\\{y_{n}\\}_{n \\geq 0}$ 满足\n$$\n\\lim_{N \\to \\infty} \\frac{1}{N} \\left| \\left\\{ 0 \\leq n < N : y_{n} \\in [a,b) \\right\\} \\right| - (b-a) = 0,\n$$\n则称其为模一均匀分布。\n- Weyl 判据指出，一个在 $[0,1)$ 中的序列 $\\{y_{n}\\}$ 是模一均匀分布的，当且仅当对于每个非零整数 $k$，\n$$\n\\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{n=0}^{N-1} \\exp\\!\\big(2\\pi i k y_{n}\\big) = 0.\n$$\n- 序列 $\\{y_{n}\\}$ 的前 $N$ 个点的星偏差定义为\n$$\nD_{N}^{\\ast} \\coloneqq \\sup_{t \\in [0,1]} \\left| \\frac{1}{N} \\left| \\left\\{ 0 \\leq n < N : y_{n} \\in [0,t) \\right\\} \\right| - t \\right|.\n$$\n\n从这些定义出发，不使用任何简便公式，对以 $2$ 为基的 van der Corput 序列 $\\{x_{n}\\}$ 执行以下步骤：\n\n1. 从第一性原理出发，证明对于每个整数 $m \\geq 1$，集合 $\\{x_{0},x_{1},\\dots,x_{2^{m}-1}\\}$ 等于集合 $\\left\\{ \\frac{j}{2^{m}} : 0 \\leq j < 2^{m} \\right\\}$。\n\n2. 仅使用星偏差的定义，确定初始段 $\\{x_{0},\\dots,x_{2^{m}-1}\\}$ 的 $D_{2^{m}}^{\\ast}$ 的精确值。\n\n3. 对于任意整数 $k$，计算指数和\n$$\nS_{k}(2^{m}) \\coloneqq \\frac{1}{2^{m}} \\sum_{n=0}^{2^{m}-1} \\exp\\!\\big(2\\pi i k x_{n}\\big),\n$$\n并解释 Weyl 判据如何蕴含 $\\{x_{n}\\}$ 是模一均匀分布的。\n\n4. 给出一个严格的论证，说明不存在固定的实数 $\\alpha$ 和 $\\beta$ 使得对于所有 $n \\geq 0$ 都有 $x_{n} = \\{ n\\alpha + \\beta \\}$，其中 $\\{ \\cdot \\}$ 表示小数部分。\n\n您最终报告的量必须是您在步骤 $2$ 中得到的精确闭式表达式。请用精确形式表达您的最终答案，无需四舍五入。", "solution": "问题陈述是数论中的一个有效练习，具体涉及 van der Corput 序列的性质。所有定义都是标准的，任务是明确定义的数学问题，基于所提供的框架有唯一解。该问题具有科学性、客观性和自洽性。因此，需要一个完整的解答。\n\n解答将按顺序处理问题的四个部分。\n\n**1. 证明 $\\{x_{0},x_{1},\\dots,x_{2^{m}-1}\\} = \\left\\{ \\frac{j}{2^{m}} : 0 \\leq j < 2^{m} \\right\\}$**\n\n令 $m \\geq 1$ 为一个整数。考虑一个整数 $n$，使得 $0 \\leq n < 2^{m}$。$n$ 的二进制展开式可以用 $m$ 位来写：$n = \\sum_{j=0}^{m-1} a_{j}(n) 2^{j}$，其中 $a_j(n) \\in \\{0,1\\}$。对于此范围内的 $n$，任何对于 $j \\geq m$ 的系数 $a_j(n)$ 都为零。\n\nvan der Corput 序列元素 $x_n$ 的定义是 $x_{n} = \\sum_{j=0}^{\\infty} \\frac{a_{j}(n)}{2^{j+1}}$。由于当 $j \\geq m$ 时 $a_j(n)=0$，因此这个和是有限的：\n$$\nx_{n} = \\sum_{j=0}^{m-1} \\frac{a_{j}(n)}{2^{j+1}}\n$$\n为了建立所期望的集合相等关系，我们可以定义一个从整数集合 $I_m = \\{0, 1, \\dots, 2^m-1\\}$ 到有理数集合 $Q_m = \\left\\{ \\frac{j}{2^{m}} : 0 \\leq j < 2^{m} \\right\\}$ 的映射 $\\phi$，并证明这个映射是一个双射。设该映射为 $\\phi(n) = x_n$。\n\n让我们处理一下 $x_n$ 的表达式：\n$$\nx_n = \\frac{1}{2^m} \\sum_{j=0}^{m-1} a_j(n) 2^{m-j-1}\n$$\n让我们定义一个新整数 $k_n$，作为 $2^m x_n$ 的值：\n$$\nk_n = 2^m x_n = \\sum_{j=0}^{m-1} a_j(n) 2^{m-1-j}\n$$\n$n$ 的二进制表示是 $(a_{m-1}(n) a_{m-2}(n) \\dots a_1(n) a_0(n))_2$。\n让我们看一下 $k_n$ 的二进制表示。设求和指数为 $l = m-1-j$。当 $j$ 从 $0$ 变到 $m-1$ 时，$l$ 从 $m-1$ 变到 $0$。\n$$\nk_n = \\sum_{l=0}^{m-1} a_{m-1-l}(n) 2^l\n$$\n$k_n$ 的二进制表示是 $(a_0(n) a_1(n) \\dots a_{m-2}(n) a_{m-1}(n))_2$。这表明 $k_n$ 的二进制数字是 $n$ 的二进制数字的反转序列。\n\n映射 $n \\mapsto k_n$ 是整数集合 $\\{0, 1, \\dots, 2^m-1\\}$ 的一个置换。要理解这一点，请注意将一个数的位映射到其反转顺序是一个对合，因此是从 $m$ 位二进制字符串集合到其自身的双射。由于 $\\{0, 1, \\dots, 2^m-1\\}$ 中的每个整数都对应一个唯一的 $m$ 位二进制字符串，因此映射 $n \\mapsto k_n$ 是从这个整数集合到其自身的双射。\n\n因此，当 $n$ 取遍 $\\{0, 1, \\dots, 2^m-1\\}$ 中的所有值时，整数 $k_n = 2^m x_n$ 也取遍 $\\{0, 1, \\dots, 2^m-1\\}$ 中的所有值，每个值恰好一次。\n这意味着值集合 $\\{x_n : n \\in \\{0, 1, \\dots, 2^m-1\\}\\}$ 与值集合 $\\{\\frac{k_n}{2^m} : n \\in \\{0, 1, \\dots, 2^m-1\\}\\}$ 相同，而后者恰好是集合 $\\left\\{ \\frac{j}{2^{m}} : 0 \\leq j < 2^{m} \\right\\}$。证明完毕。\n\n**2. 确定星偏差 $D_{2^{m}}^{\\ast}$**\n\n前 $N$ 个点的星偏差定义为：\n$$\nD_{N}^{\\ast} = \\sup_{t \\in [0,1]} \\left| \\frac{1}{N} \\left| \\left\\{ 0 \\leq n < N : y_{n} \\in [0,t) \\right\\} \\right| - t \\right|\n$$\n在我们的例子中，$N=2^m$，点集为 $\\{x_0, \\dots, x_{2^m-1}\\} = \\{\\frac{j}{2^m} : 0 \\le j < 2^m\\}$。让我们定义偏差函数 $E(t)$：\n$$\nE(t) = \\frac{1}{2^m} \\left| \\left\\{ 0 \\leq n < 2^m : x_n \\in [0,t) \\right\\} \\right| - t\n$$\n使用第 1 部分的结果，计数函数为：\n$$\n\\left| \\left\\{ 0 \\leq n < 2^m : x_n \\in [0,t) \\right\\} \\right| = \\left| \\left\\{ 0 \\leq j < 2^m : \\frac{j}{2^m} \\in [0,t) \\right\\} \\right| = \\left| \\left\\{ j \\in \\mathbb{Z} : 0 \\leq j < 2^m t \\right\\} \\right|\n$$\n让我们分析 $t \\in [0,1]$ 时的 $E(t)$。我们可以将 $[0,1]$ 分割成 $2^m$ 个形如 $[\\frac{k}{2^m}, \\frac{k+1}{2^m})$ 的子区间，其中 $k \\in \\{0, 1, \\dots, 2^m-1\\}$。\n\n对于区间 $[\\frac{k}{2^m}, \\frac{k+1}{2^m})$ 中的任何 $t$，条件 $0 \\leq j < 2^m t$ 由整数 $j=0, 1, \\dots, k-1$ 满足。恰好有 $k$ 个这样的整数。\n所以，对于 $t \\in [\\frac{k}{2^m}, \\frac{k+1}{2^m})$，计数函数为 $k$。\n在此区间内的偏差函数为：\n$$\nE(t) = \\frac{k}{2^m} - t\n$$\n我们需要找到 $|E(t)|$ 在 $t \\in [0,1]$ 上的上确界。在区间 $[\\frac{k}{2^m}, \\frac{k+1}{2^m})$ 上，函数 $f(t) = \\frac{k}{2^m} - t$ 是 $t$ 的线性递减函数。\n在左端点 $t=\\frac{k}{2^m}$，我们有 $E(\\frac{k}{2^m}) = \\frac{k}{2^m} - \\frac{k}{2^m} = 0$。\n在右端点，当 $t$ 从下方趋近于 $\\frac{k+1}{2^m}$ 时，$E(t)$ 趋近于 $\\frac{k}{2^m} - \\frac{k+1}{2^m} = -\\frac{1}{2^m}$。\n在 $[\\frac{k}{2^m}, \\frac{k+1}{2^m})$ 上，$E(t)$ 的值从 $0$ 向下变化到（但不包括）$-\\frac{1}{2^m}$。\n因此，在此区间上 $|E(t)|$ 的上确界是 $\\sup_{t \\in [\\frac{k}{2^m}, \\frac{k+1}{2^m})} \\left|\\frac{k}{2^m} - t \\right| = \\left| -\\frac{1}{2^m} \\right| = \\frac{1}{2^m}$。\n\n这对于每个 $k \\in \\{0, 1, \\dots, 2^m-1\\}$ 都成立。因此，在 $[0,1)$ 上的总上确界是 $\\frac{1}{2^m}$。\n最后，我们必须检查点 $t=1$。在 $t=1$ 处，计数函数包含所有 $2^m$ 个点，所以 $|\\{ \\dots \\}|=2^m$。\n$E(1) = \\frac{2^m}{2^m} - 1 = 0$。\n因此，上确界不受此端点的影响。\n$$\nD_{2^{m}}^{\\ast} = \\sup_{t \\in [0,1]} |E(t)| = \\frac{1}{2^m}\n$$\n\n**3. 指数和 $S_k(2^m)$ 的计算与 Weyl 判据**\n\n指数和由下式给出：\n$$\nS_{k}(2^{m}) = \\frac{1}{2^{m}} \\sum_{n=0}^{2^{m}-1} \\exp\\!\\big(2\\pi i k x_{n}\\big)\n$$\n使用第 1 部分的结果，对 $\\{x_n\\}_{n=0}^{2^m-1}$ 的求和与对 $\\{\\frac{j}{2^m}\\}_{j=0}^{2^m-1}$ 的求和是相同的，因为和与其项的顺序无关。\n$$\nS_{k}(2^{m}) = \\frac{1}{2^{m}} \\sum_{j=0}^{2^{m}-1} \\exp\\!\\left(2\\pi i k \\frac{j}{2^m}\\right)\n$$\n这是一个公比为 $r = \\exp\\!\\left(\\frac{2\\pi i k}{2^m}\\right)$ 的几何级数。\n和的值有两种情况：\n情况 1：$r=1$。这发生在 $\\frac{k}{2^m}$ 是一个整数时，即 $k$ 是 $2^m$ 的倍数。在这种情况下，和中的每一项都是 $1$。\n$$\nS_{k}(2^{m}) = \\frac{1}{2^{m}} \\sum_{j=0}^{2^{m}-1} 1 = \\frac{1}{2^{m}} \\cdot 2^m = 1\n$$\n情况 2：$r \\neq 1$。这发生在 $k$ 不是 $2^m$ 的倍数时。几何级数的和为 $\\sum_{j=0}^{2^m-1} r^j = \\frac{r^{2^m}-1}{r-1}$。\n分子是 $r^{2^m} = \\left(\\exp\\!\\left(\\frac{2\\pi i k}{2^m}\\right)\\right)^{2^m} = \\exp(2\\pi i k) = 1$。\n所以和是 $\\frac{1-1}{r-1} = 0$。\n$$\nS_{k}(2^{m}) = \\frac{1}{2^{m}} \\cdot 0 = 0\n$$\n总结如下：\n$$\nS_{k}(2^{m}) = \\begin{cases} 1 & \\text{若 } 2^m | k \\\\ 0 & \\text{若 } 2^m \\nmid k \\end{cases}\n$$\n为了使用 Weyl 判据证明均匀分布，我们必须证明对于任何非零整数 $k$，$\\lim_{N \\to \\infty} \\frac{1}{N} \\sum_{n=0}^{N-1} \\exp(2\\pi i k x_n) = 0$。令 $W_N(k) = \\sum_{n=0}^{N-1} \\exp(2\\pi i k x_n)$。\n令 $N$ 为任何正整数，其二进制展开式为 $N = \\sum_{j=0}^{J} b_j 2^j$，其中 $b_j \\in \\{0,1\\}$。整数集 $\\{0, \\dots, N-1\\}$ 可以被划分为二进区间的互斥并集。对于每个 $b_j=1$ 的 $j$，我们有一个区间 $[M_j, M_j+2^j-1]$，其中 $M_j = \\sum_{l=j+1}^J b_l 2^l$。\n$W_N(k) = \\sum_{j=0, b_j=1}^{J} \\sum_{l=0}^{2^j-1} \\exp(2\\pi i k x_{M_j+l})$。\n由于 $M_j$ 的二进制表示仅在位 $j$ 及更高位有非零项，而 $l<2^j$ 的二进制表示仅在低于 $j$ 的位有非零项，所以 $a_p(M_j+l) = a_p(M_j)+a_p(l)$，因此 $x_{M_j+l} = x_{M_j} + x_l$。\n内层和为 $\\sum_{l=0}^{2^j-1} \\exp(2\\pi i k (x_{M_j} + x_l)) = \\exp(2\\pi i k x_{M_j}) \\sum_{l=0}^{2^j-1} \\exp(2\\pi i k x_l)$。\n此内层和为 $\\sum_{p=0}^{2^j-1} \\exp(2\\pi i k \\frac{p}{2^j})$，如果 $k$ 是 $2^j$ 的倍数，则其值为 $2^j$，否则为 $0$。\n固定 $k \\neq 0$。令 $v_2(k)$ 为整除 $k$ 的 2 的最高次幂的指数。那么对于所有 $j > v_2(k)$，内层和为零。\n$|W_N(k)| = \\left| \\sum_{j=0, b_j=1}^{J} \\exp(2\\pi i k x_{M_j}) \\cdot (\\text{对 } l \\text{ 的和}) \\right| \\leq \\sum_{j=0, b_j=1}^{J} |\\text{对 } l \\text{ 的和}|$。\n$|W_N(k)| \\leq \\sum_{j=0, b_j=1, j \\le v_2(k)}^{v_2(k)} 2^j \\leq \\sum_{j=0}^{v_2(k)} 2^j = 2^{v_2(k)+1} - 1$。\n这给出了 $|W_N(k)|$ 的一个上界，该上界仅依赖于 $k$，而不依赖于 $N$。设此上界为 $C_k = 2^{v_2(k)+1} - 1$ 。\n那么，对于任何 $N$，$|\\frac{1}{N} W_N(k)| \\leq \\frac{C_k}{N}$。\n当 $N \\to \\infty$ 时，$\\frac{C_k}{N} \\to 0$。根据夹逼定理，$\\lim_{N \\to \\infty} \\frac{1}{N} W_N(k) = 0$。这对所有 $k \\neq 0$ 都成立，所以 Weyl 判据得到满足。\n\n**4. 证明 $x_n$ 不是 Kronecker 序列**\n\n我们要证明不存在固定的实数 $\\alpha$ 和 $\\beta$，使得对于所有 $n \\ge 0$，都有 $x_n = \\{ n\\alpha + \\beta \\}$，其中 $\\{y\\} = y - \\lfloor y \\rfloor$ 是小数部分。\n为了进行反证，假设存在这样的 $\\alpha$ 和 $\\beta$。\n考虑序列 $y_n = \\{n\\alpha+\\beta\\}$ 中连续项之间的差：\n$y_{n+1} - y_n = \\{(n+1)\\alpha + \\beta\\} - \\{n\\alpha + \\beta\\}$。\n$y_{n+1} - y_n = ((n+1)\\alpha + \\beta - \\lfloor(n+1)\\alpha+\\beta\\rfloor) - (n\\alpha + \\beta - \\lfloor n\\alpha+\\beta\\rfloor)$。\n$y_{n+1} - y_n = \\alpha - (\\lfloor (n+1)\\alpha+\\beta \\rfloor - \\lfloor n\\alpha+\\beta \\rfloor)$。\n令 $K_n = \\lfloor(n+1)\\alpha+\\beta\\rfloor - \\lfloor n\\alpha+\\beta\\rfloor = \\lfloor n\\alpha+\\beta+\\alpha\\rfloor - \\lfloor n\\alpha+\\beta\\rfloor$。\n由于对于任何实数 $z, w$，$\\lfloor z+w \\rfloor - \\lfloor z \\rfloor$ 只能是 $\\lfloor w \\rfloor$ 或 $\\lfloor w \\rfloor+1$，所以整数 $K_n$ 最多只能取两个不同的值，即 $\\lfloor \\alpha \\rfloor$ 和 $\\lfloor \\alpha \\rfloor+1$。\n这意味着差值 $y_{n+1}-y_n = \\alpha - K_n$ 最多只能取两个不同的值。\n\n现在我们来考察 van der Corput 序列 $\\{x_n\\}$ 的差值。\n设 $n=2^k-1$，其中 $k \\ge 1$ 是某个整数。$n$ 的二进制表示由 $k$ 个 1 组成：$n=(11\\dots1)_2$。\n所以当 $0 \\le j < k$ 时，$a_j(n)=1$；当 $j \\ge k$ 时，$a_j(n)=0$。\n$x_{2^k-1} = \\sum_{j=0}^{k-1} \\frac{1}{2^{j+1}} = \\frac{1}{2} \\cdot \\frac{1-(1/2)^k}{1-1/2} = 1 - \\frac{1}{2^k}$。\n下一个整数是 $n+1=2^k$。其二进制表示是 1 后跟 $k$ 个零：$2^k=(100\\dots0)_2$。\n所以 $a_k(2^k)=1$ 且所有其他的 $a_j(2^k)=0$。\n$x_{2^k} = \\frac{1}{2^{k+1}}$。\n差值为：\n$x_{2^k} - x_{2^k-1} = \\frac{1}{2^{k+1}} - \\left(1-\\frac{1}{2^k}\\right) = \\frac{1}{2^{k+1}} - 1 + \\frac{2}{2^{k+1}} = \\frac{3}{2^{k+1}} - 1$.\n让我们为几个 $k$ 值计算这个差值：\n对于 $k=1$，$n=1$。$x_2-x_1 = \\frac{3}{4}-1 = -\\frac{1}{4}$。\n对于 $k=2$，$n=3$。$x_4-x_3 = \\frac{3}{8}-1 = -\\frac{5}{8}$。\n对于 $k=3$，$n=7$。$x_8-x_7 = \\frac{3}{16}-1 = -\\frac{13}{16}$。\n差值序列 $\\{\\frac{3}{2^{k+1}} - 1\\}_{k \\ge 1}$ 包含无限多个不同的值。这与 Kronecker 序列 $\\{n\\alpha+\\beta\\}$ 的性质相矛盾，后者的连续项差值最多只能有两个不同的值。\n因此，最初的假设必定是错误的。不存在固定的实数 $\\alpha$ 和 $\\beta$ 使得对于所有 $n \\geq 0$ 都有 $x_n = \\{ n\\alpha + \\beta \\}$。\n\n要求提供的最终答案是步骤 2 中得到的表达式。", "answer": "$$\n\\boxed{\\frac{1}{2^{m}}}\n$$", "id": "3030160"}]}