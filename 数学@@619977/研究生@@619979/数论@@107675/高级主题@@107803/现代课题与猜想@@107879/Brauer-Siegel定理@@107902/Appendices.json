{"hands_on_practices": [{"introduction": "在深入研究 Brauer-Siegel 定理的深奥之处前，首先回顾其核心构件——解析类数公式——是至关重要的。这个练习将我们带回到最熟悉的数域 $\\mathbb{Q}$，通过为这个最简单的情形具体计算公式中的每一项不变量，并验证其结果与黎曼 $\\zeta$ 函数的已知性质相符，从而为更复杂的理论建立一个坚实而直观的基础 [@problem_id:3025182]。", "problem": "设 $K=\\mathbb{Q}$，并令 $\\zeta_{K}(s)$ 表示 $K$ 的戴德金zeta函数。从 $K=\\mathbb{Q}$ 的基本定义和标准性质出发。\n\n(a) 使用戴德金zeta函数作为 $\\mathcal{O}_{K}$ 的非零理想上的狄利克雷级数的定义，以及 $\\mathcal{O}_{\\mathbb{Q}}=\\mathbb{Z}$ 这一等同关系，明确地用经典的黎曼zeta函数表示 $\\zeta_{K}(s)$，并计算其留数 $\\operatorname{Res}_{s=1}\\zeta_{K}(s)$。\n\n(b) 确定 $K=\\mathbb{Q}$ 的各项标准算术不变量：实嵌入的个数 $r_{1}$，复共轭嵌入对的个数 $r_{2}$，判别式 $D_{K}$，类数 $h_{K}$，调节子 $R_{K}$，以及 $\\mathcal{O}_{K}$ 中单位根的个数 $w_{K}$。只使用关于 $\\mathbb{Q}$ 的定义和熟知的事实。\n\n(c) 不引用任何未经证明的论断，解释为何(a)部分得到的值与一般数域的解析类数公式在特殊化到 $K=\\mathbb{Q}$ 的情况下所预测的值一致，从而验证这个与 Brauer–Siegel 框架相关的基本情形。\n\n请将 $\\operatorname{Res}_{s=1}\\zeta_{K}(s)$ 的最终答案以单个精确实数的形式给出。", "solution": "该问题被确认为自洽、有科学依据且表述清晰。我们可以开始解答。\n\n(a) 我们的任务是确定数域 $K=\\mathbb{Q}$ 的戴德金zeta函数 $\\zeta_{K}(s)$，并求其在 $s=1$ 处的留数。\n\n一个数域 $K$ 的戴德金zeta函数在 $\\operatorname{Re}(s) > 1$ 时定义为其整数环 $\\mathcal{O}_{K}$ 的非零理想上的狄利克雷级数：\n$$ \\zeta_{K}(s) = \\sum_{0 \\neq \\mathfrak{a} \\subseteq \\mathcal{O}_{K}} \\frac{1}{(N(\\mathfrak{a}))^s} $$\n其中 $N(\\mathfrak{a}) = |\\mathcal{O}_{K}/\\mathfrak{a}|$ 是理想 $\\mathfrak{a}$ 的范数。\n\n对于数域 $K=\\mathbb{Q}$，其整数环是 $\\mathcal{O}_{\\mathbb{Q}} = \\mathbb{Z}$。由于 $\\mathbb{Z}$ 是主理想整环 (PID)，每个非零理想 $\\mathfrak{a}$ 都具有形式 $(n) = n\\mathbb{Z}$，其中 $n \\neq 0$ 是某个整数。理想 $(n)$ 和 $(-n)$ 是相同的，因此我们可以用一个正整数 $n \\in \\mathbb{Z}_{>0}$ 来唯一地表示每个非零理想。也就是说，$\\mathbb{Z}$ 的非零理想与正整数 $n=1, 2, 3, \\ldots$ 之间存在一一对应关系。\n\n$\\mathbb{Z}$ 中一个非零主理想 $(n)$ 的范数由商环的基数给出：\n$$ N((n)) = |\\mathbb{Z}/n\\mathbb{Z}| = |n| $$\n由于我们使用正整数 $n$ 来表示理想，范数就是 $N((n))=n$。\n\n将这些结果代入 $K=\\mathbb{Q}$ 的戴德金zeta函数的定义，我们得到：\n$$ \\zeta_{\\mathbb{Q}}(s) = \\sum_{n=1}^{\\infty} \\frac{1}{(N((n)))^s} = \\sum_{n=1}^{\\infty} \\frac{1}{n^s} $$\n这个级数是经典的黎曼zeta函数 $\\zeta(s)$ 的定义。因此，我们有恒等式 $\\zeta_{\\mathbb{Q}}(s) = \\zeta(s)$。\n\n问题要求计算 $\\zeta_{K}(s)$ 在点 $s=1$ 处的留数。这等价于求黎曼zeta函数在 $s=1$ 处的留数。黎曼zeta函数理论中的一个基本结果是，$\\zeta(s)$ 可以解析延拓到复平面 $\\mathbb{C} \\setminus \\{1\\}$，并且在 $s=1$ 处有一个留数为 $1$ 的简单极点。\n$$ \\operatorname{Res}_{s=1}\\zeta_{K}(s) = \\operatorname{Res}_{s=1}\\zeta_{\\mathbb{Q}}(s) = \\operatorname{Res}_{s=1}\\zeta(s) = 1 $$\n\n(b) 现在我们来确定 $K=\\mathbb{Q}$ 的标准算术不变量。\n\n$r_{1}$, $r_{2}$：一个从 $\\mathbb{Q}$ 到 $\\mathbb{C}$ 的嵌入是一个单射域同态 $\\sigma: \\mathbb{Q} \\to \\mathbb{C}$。由于任何此类同态都必须将 $1$ 映射到 $1$，因此它在子域 $\\mathbb{Q}$ 上是恒等映射。因此，只存在一个嵌入，即对所有 $x \\in \\mathbb{Q}$ 有 $\\sigma(x)=x$。此嵌入的像是 $\\mathbb{Q}$，它是实数集 $\\mathbb{R}$ 的一个子集。因此，这是一个实嵌入。我们有 $r_1=1$ 个实嵌入。复共轭嵌入对的个数是 $r_2$。扩张次数为 $[K:\\mathbb{Q}] = n = r_1+2r_2$。对于 $K=\\mathbb{Q}$，我们有 $n=1$，所以 $1 = 1 + 2r_2$，这意味着 $r_2=0$。\n\n$D_{K}$：数域 $K$ 的判别式是 $\\mathcal{O}_{K}$ 的一组整基的判别式。对于 $K=\\mathbb{Q}$，$\\mathcal{O}_{K}=\\mathbb{Z}$，一组整基是 $\\{1\\}$。判别式定义为 $D_K = \\det( (\\sigma_i(b_j)) )^2$，其中 $\\{\\sigma_i\\}$ 是嵌入，$\\{b_j\\}$ 是整基。这里我们有一个嵌入 $\\sigma_1 = \\text{id}$ 和一个基元素 $b_1=1$。矩阵是 $1 \\times 1$ 矩阵 $(\\sigma_1(b_1)) = (1)$。因此，判别式是 $D_{\\mathbb{Q}} = \\det((1))^2 = 1^2 = 1$。\n\n$h_{K}$：类数 $h_{K}$ 是 $K$ 的理想类群的阶。理想类群衡量了一个整数环不是主理想整环的程度。正如在(a)部分所确定的，$\\mathcal{O}_{\\mathbb{Q}} = \\mathbb{Z}$ 是一个主理想整环。这意味着每个理想都是主理想，所以理想类群是平凡群。平凡群的阶是 $1$。因此，类数是 $h_{\\mathbb{Q}} = 1$。\n\n$w_{K}$：数字 $w_{K}$ 是整数环 $\\mathcal{O}_{K}$ 中所包含的单位根的个数。对于 $K=\\mathbb{Q}$，我们在 $\\mathbb{Z}$ 中寻找元素 $\\zeta$，使得对于某个整数 $m \\ge 1$ 有 $\\zeta^m = 1$。仅有的此类整数是 $1$ 和 $-1$。因此，$\\mathbb{Q}$ 中的单位根群是 $\\{1, -1\\}$，其个数为 $w_{\\mathbb{Q}}=2$。\n\n$R_{K}$：调节子 $R_{K}$ 与单位群 $\\mathcal{O}_{K}^{\\times}$ 相关。根据狄利克雷单位定理，单位群的秩是 $r = r_1 + r_2 - 1$。对于 $K=\\mathbb{Q}$，秩为 $r = 1 + 0 - 1 = 0$。秩为 $0$ 意味着单位群是有限的，仅由单位根组成。确实，$\\mathcal{O}_{\\mathbb{Q}}^{\\times} = \\mathbb{Z}^{\\times} = \\{1, -1\\}$。对于单位群的秩为 $0$ 的数域，按照惯例，调节子定义为 $R_{K}=1$。这对应于一个 $0 \\times 0$ 矩阵的行列式。\n\n(c) 现在我们验证(a)部分的结果与解析类数公式一致。该公式指出，对于一个数域 $K$，$\\zeta_{K}(s)$ 在 $s=1$ 处的留数由以下公式给出：\n$$ \\operatorname{Res}_{s=1}\\zeta_{K}(s) = \\frac{2^{r_1}(2\\pi)^{r_2}h_K R_K}{w_K \\sqrt{|D_K|}} $$\n我们将(b)部分确定的 $K=\\mathbb{Q}$ 的不变量代入：\n- $r_1=1$\n- $r_2=0$\n- $h_K=1$\n- $R_K=1$\n- $w_K=2$\n- $D_K=1$\n\n将这些值代入公式得到：\n$$ \\operatorname{Res}_{s=1}\\zeta_{\\mathbb{Q}}(s) = \\frac{2^{1}(2\\pi)^{0} \\cdot 1 \\cdot 1}{2 \\cdot \\sqrt{|1|}} = \\frac{2 \\cdot 1 \\cdot 1 \\cdot 1}{2 \\cdot 1} = \\frac{2}{2} = 1 $$\n这个值 $1$ 与(a)部分通过直接计算得到的值 $\\operatorname{Res}_{s=1}\\zeta_{\\mathbb{Q}}(s)=1$ 完全吻合。这表明 $K=\\mathbb{Q}$ 的情况是广义解析类数公式的一个基本的、起验证作用的基础情形。这个公式将一个数域的深刻的算术不变量与其zeta函数的解析行为联系起来，对于这个最简单的数域，该公式是成立的。\n所要求的最终答案是这个留数的值。", "answer": "$$\\boxed{1}$$", "id": "3025182"}, {"introduction": "在为基础情形 $K=\\mathbb{Q}$ 验证了公式之后，我们将目光投向一个无限的数域序列，以揭示 Brauer-Siegel 定理的真正威力。此练习聚焦于虚二次域这一经典族，引导你推导出当判别式趋向于无穷时，类数 $h_K$ 的对数增长与 $\\ln(\\sqrt{|d_{K}|})$ 之间的渐近关系 [@problem_id:3025206]。这不仅是一个理论证明，更是理解定理如何刻画数域算术不变量宏观行为的关键一步。", "problem": "设 $K$ 为一个虚二次数域，其绝对判别式为 $|d_{K}|$，符号差为 $(r_{1}(K),r_{2}(K))$，类数为 $h_{K}$，调节子为 $R_{K}$，$\\mathcal{O}_{K}$ 中单位根的个数为 $w_{K}$。\n\n(a) 计算此种 $K$ 的 $r_{1}(K)$、$r_{2}(K)$、$R_{K}$ 和 $w_{K}$，并指出特殊域 $K$ 出现的任何例外情况。\n\n(b) 考虑任意满足 $|d_{K_{j}}|\\to \\infty$ 的虚二次数域序列 $(K_{j})_{j\\geq 1}$。定义\n$$\nL \\;=\\; \\lim_{j\\to\\infty}\\frac{\\ln\\!\\big(h_{K_{j}}\\,R_{K_{j}}\\big)}{\\ln\\!\\big(\\sqrt{|d_{K_{j}}|}\\big)},\n$$\n假定该极限存在。确定 $L$ 的精确值。最终答案必须是一个精确的数字；无需四舍五入。", "solution": "这个问题包含两部分。部分(a)要求计算虚二次数域 $K$ 的基本不变量。部分(b)要求计算与这类数域序列相关的一个特定极限的值，这是 Brauer-Siegel 定理的一个应用。\n\n(a) 设 $K$ 是一个虚二次数域。这意味着对某个无平方因子的整数 $m  0$，有 $K = \\mathbb{Q}(\\sqrt{m})$。扩张次数为 $[K:\\mathbb{Q}] = 2$。\n\n符号差 $(r_{1}(K), r_{2}(K))$ 由 $K$ 到 $\\mathbb{C}$ 的实嵌入和复嵌入的数量决定。$\\sqrt{m}$ 在 $\\mathbb{Q}$ 上的极小多项式是 $x^2 - m = 0$，其根为 $\\pm\\sqrt{m} = \\pm i\\sqrt{|m|}$。由于 $m  0$，两个根都是纯虚数。因此，没有实嵌入，即 $r_{1}(K) = 0$。有两个复嵌入，它们成共轭对：$\\sigma_1: \\sqrt{m} \\mapsto i\\sqrt{|m|}$ 和 $\\sigma_2 = \\overline{\\sigma_1}: \\sqrt{m} \\mapsto -i\\sqrt{|m|}$。共轭复嵌入的对数为 $r_{2}(K) = 1$。扩张次数为 $n = r_1(K) + 2r_2(K) = 0 + 2(1) = 2$，这是吻合的。\n因此，对任意虚二次数域 $K$，我们有 $r_{1}(K) = 0$ 和 $r_{2}(K) = 1$。\n\n调节子 $R_K$ 与整数环 $\\mathcal{O}_K$ 的单位群 $\\mathcal{O}_K^\\times$ 的结构有关。根据 Dirichlet 单位定理，$\\mathcal{O}_K^\\times$ 的自由部分的秩为 $r = r_1(K) + r_2(K) - 1$。对于虚二次数域，此秩为 $r = 0 + 1 - 1 = 0$。这意味着单位群是有限的，并且仅由 $K$ 中包含的单位根组成。调节子 $R_K$ 定义为由一组基本单位的绝对值的对数所构成的 $r \\times r$ 矩阵的行列式的绝对值。由于 $r=0$，这是一个 $0 \\times 0$ 矩阵。按照惯例，一个 $0 \\times 0$ 矩阵的行列式为 $1$。\n因此，对于任意虚二次数域 $K$，其调节子为 $R_K = 1$。\n\n数字 $w_K$ 是 $\\mathcal{O}_K$ 中单位根的个数。这些是 $\\mathcal{O}_K^\\times$ 的挠子群的元素。对于一般的数域，唯一的单位根是 $\\pm 1$，所以 $w_K = 2$。然而，某些虚二次数域包含额外的单位根。一个 $n$ 次单位根 $\\zeta_n$ 在 $\\mathbb{Q}$ 上的次数为 $\\phi(n)$，其中 $\\phi$ 是 Euler 欧拉函数。为了使 $\\mathbb{Q}(\\zeta_n)$ 成为二次域 $K$ 的子域，必须有 $\\phi(n) \\le 2$。满足 $\\phi(n) \\le 2$ 的 $n$ 的值为 $n \\in \\{1, 2, 3, 4, 6\\}$。\n- $n=1, 2$：$\\mathbb{Q}(\\zeta_1) = \\mathbb{Q}(\\zeta_2) = \\mathbb{Q}$。这给出了根 $\\pm 1$。\n- $n=4$：$\\mathbb{Q}(\\zeta_4) = \\mathbb{Q}(i) = \\mathbb{Q}(\\sqrt{-1})$。判别式为 $d_K = -4$。对于此域，单位根为 $\\{\\pm 1, \\pm i\\}$，因此 $w_K = 4$。\n- $n=3, 6$：$\\mathbb{Q}(\\zeta_3) = \\mathbb{Q}(\\zeta_6) = \\mathbb{Q}(\\sqrt{-3})$。判别式为 $d_K = -3$。对于此域，单位根是6次单位根，即 $\\{\\pm 1, \\frac{\\pm 1 \\pm \\sqrt{-3}}{2}\\}$，因此 $w_K = 6$。\n对于所有其他虚二次数域 $K$，唯一的单位根是 $\\{\\pm 1\\}$。\n总结一下，对于 $w_K$，存在两种例外情况：\n- 若 $K = \\mathbb{Q}(\\sqrt{-1})$，则 $w_K = 4$。\n- 若 $K = \\mathbb{Q}(\\sqrt{-3})$，则 $w_K = 6$。\n- 对于所有其他虚二次数域 $K$，则 $w_K = 2$。\n\n(b) 我们被要求确定极限\n$$ L = \\lim_{j\\to\\infty}\\frac{\\ln(h_{K_j} R_{K_j})}{\\ln(\\sqrt{|d_{K_j}|})} $$\n的值，对于一个满足 $|d_{K_j}|\\to \\infty$ 的虚二次数域序列 $(K_j)_{j\\geq 1}$。\n\n从部分(a)我们知道，对于任意虚二次数域 $K_j$，其调节子为 $R_{K_j} = 1$。将此代入 $L$ 的表达式中可得：\n$$ L = \\lim_{j\\to\\infty}\\frac{\\ln(h_{K_j} \\cdot 1)}{\\ln(\\sqrt{|d_{K_j}|})} = \\lim_{j\\to\\infty}\\frac{\\ln(h_{K_j})}{\\frac{1}{2}\\ln(|d_{K_j}|)} = 2 \\lim_{j\\to\\infty}\\frac{\\ln(h_{K_j})}{\\ln(|d_{K_j}|)} $$\n这个极限是数论中一个著名的结果，是 Brauer-Siegel 定理的一个特例。我们可以使用解析类数公式来推导它的值。对于虚二次数域 $K$，此公式将其 Dedekind zeta 函数 $\\zeta_K(s)$ 在 $s=1$ 处的留数与该域的不变量联系起来：\n$$ \\lim_{s\\to 1} (s-1)\\zeta_K(s) = \\frac{2^{r_1}(2\\pi)^{r_2}h_K R_K}{w_K \\sqrt{|d_K|}} $$\n对 $K=K_j$ 使用 $r_1=0$、$r_2=1$ 和 $R_K=1$，公式变为：\n$$ \\lim_{s\\to 1} (s-1)\\zeta_{K_j}(s) = \\frac{2\\pi h_{K_j}}{w_{K_j} \\sqrt{|d_{K_j}|}} $$\nDedekind zeta 函数可分解为 $\\zeta_{K_j}(s) = \\zeta(s)L(s, \\chi_{K_j})$，其中 $\\zeta(s)$ 是 Riemann zeta 函数，$L(s, \\chi_{K_j})$ 是与域 $K_j$ 对应的二次特征 $\\chi_{K_j}$ 相关联的 Dirichlet L-函数。由于 $\\lim_{s\\to 1} (s-1)\\zeta(s) = 1$，我们有：\n$$ \\lim_{s\\to 1} (s-1)\\zeta_{K_j}(s) = L(1, \\chi_{K_j}) $$\n令这两个留数的表达式相等，我们得到：\n$$ L(1, \\chi_{K_j}) = \\frac{2\\pi h_{K_j}}{w_{K_j} \\sqrt{|d_{K_j}|}} $$\n我们可以解出类数 $h_{K_j}$：\n$$ h_{K_j} = \\frac{w_{K_j} \\sqrt{|d_{K_j}|}}{2\\pi} L(1, \\chi_{K_j}) $$\n我们现在对这个表达式取自然对数。条件 $|d_{K_j}| \\to \\infty$ 确保了对于所有足够大的 $j$，$K_j$既不是 $\\mathbb{Q}(\\sqrt{-1})$ (其中 $|d_K|=4$) 也不是 $\\mathbb{Q}(\\sqrt{-3})$ (其中 $|d_K|=3$)。因此，对于大的 $j$，我们有 $w_{K_j} = 2$。\n$$ h_{K_j} = \\frac{2 \\sqrt{|d_{K_j}|}}{2\\pi} L(1, \\chi_{K_j}) = \\frac{\\sqrt{|d_{K_j}|}}{\\pi} L(1, \\chi_{K_j}) $$\n取对数：\n$$ \\ln(h_{K_j}) = \\ln\\left(\\frac{|d_{K_j}|^{1/2}}{\\pi} L(1, \\chi_{K_j})\\right) = \\frac{1}{2}\\ln(|d_{K_j}|) - \\ln(\\pi) + \\ln(L(1, \\chi_{K_j})) $$\n现在我们将它代入 $L$ 的表达式中：\n$$ L = \\lim_{j\\to\\infty}\\frac{2 \\left( \\frac{1}{2}\\ln(|d_{K_j}|) - \\ln(\\pi) + \\ln(L(1, \\chi_{K_j})) \\right)}{\\ln(|d_{K_j}|)} $$\n$$ L = \\lim_{j\\to\\infty}\\left( 1 - \\frac{2\\ln(\\pi)}{\\ln(|d_{K_j}|)} + \\frac{2\\ln(L(1, \\chi_{K_j}))}{\\ln(|d_{K_j}|)} \\right) $$\n当 $j \\to \\infty$ 时，我们有 $|d_{K_j}| \\to \\infty$，因此 $\\ln(|d_{K_j}|) \\to \\infty$。第二项趋于零：\n$$ \\lim_{j\\to\\infty} \\frac{-2\\ln(\\pi)}{\\ln(|d_{K_j}|)} = 0 $$\n对于第三项，我们使用关于 Dirichlet L-函数的 Siegel 定理。该定理指出，对于任意 $\\epsilon  0$，存在常数 $C_1(\\epsilon)  0$ 和 $C_2  0$ 使得对于任意判别式为 $d$ 的本原二次特征 $\\chi_d$：\n$$ C_1(\\epsilon)|d|^{-\\epsilon}  L(1, \\chi_d)  C_2 \\ln|d| $$\n取对数，我们得到：\n$$ \\ln(C_1(\\epsilon)) - \\epsilon\\ln|d|  \\ln(L(1, \\chi_d))  \\ln(C_2) + \\ln(\\ln|d|) $$\n除以 $\\ln|d|$：\n$$ \\frac{\\ln(C_1(\\epsilon))}{\\ln|d|} - \\epsilon  \\frac{\\ln(L(1, \\chi_d))}{\\ln|d|}  \\frac{\\ln(C_2)}{\\ln|d|} + \\frac{\\ln(\\ln|d|)}{\\ln|d|} $$\n当 $|d| \\to \\infty$, $\\frac{\\ln(C_1(\\epsilon))}{\\ln|d|}$、$\\frac{\\ln(C_2)}{\\ln|d|}$ 和 $\\frac{\\ln(\\ln|d|)}{\\ln|d|}$ 这些项都趋近于0。这使得我们得到：\n$$ -\\epsilon \\le \\liminf_{|d|\\to\\infty} \\frac{\\ln(L(1, \\chi_d))}{\\ln|d|} \\le \\limsup_{|d|\\to\\infty} \\frac{\\ln(L(1, \\chi_d))}{\\ln|d|} \\le 0 $$\n因为这对于任意小的 $\\epsilon  0$ 都必须成立，我们得出结论，该极限存在且等于 $0$：\n$$ \\lim_{|d|\\to\\infty} \\frac{\\ln(L(1, \\chi_d))}{\\ln|d|} = 0 $$\n将此应用于我们的序列 $(K_j)$：\n$$ \\lim_{j\\to\\infty} \\frac{2\\ln(L(1, \\chi_{K_j}))}{\\ln(|d_{K_j}|)} = 2 \\cdot 0 = 0 $$\n将各单项的极限代回 $L$ 的表达式：\n$$ L = 1 - 0 + 0 = 1 $$\n这个结果就是 Brauer-Siegel 定理对于虚二次数域族的陈述。", "answer": "$$ \\boxed{1} $$", "id": "3025206"}, {"introduction": "理论的证明为我们提供了逻辑上的确定性，而计算实验则能给予我们直观的洞察和经验上的确证。这个动手实践旨在连接理论与实践，要求你编写一个程序来为一系列虚二次域数值计算 Brauer-Siegel 比率 [@problem_id:3025202]。通过从第一性原理（即对二次型进行计数）计算类数并观察比率如何随着判别式的增大而趋近于1，你将亲眼见证前一个练习中证明的渐近行为。", "problem": "设 $K = \\mathbb{Q}(\\sqrt{d})$ 是一个虚二次域，其中 $d  0$ 是一个无平方因子数。$K$ 的判别式 $D_K$ 由标准规则定义：如果 $d \\equiv 1 \\pmod{4}$，则 $D_K = d$，否则 $D_K = 4d$。理想类数 $h_K$ 是 $\\mathcal{O}_K$ 的理想类群的基数，而调节子 $R_K$ 是通过单位群的对数嵌入定义的；对于虚二次域，其单位群是有限的，因此根据定义 $R_K = 1$。Brauer-Siegel 定理断言，对于一列固定次数的数域 $K$，当 $|D_K| \\to \\infty$时，我们有\n$$\n\\frac{\\log\\left(h_K R_K\\right)}{\\log\\sqrt{|D_K|}} \\to 1.\n$$\n\n您的任务是编写一个程序，对于一组虚二次域，计算：\n- 乘积 $h_K R_K$，\n- $\\log|D_K|$，\n- 以及比率 $\\frac{\\log(h_K R_K)}{\\log\\sqrt{|D_K|}}$，\n\n并数值上检验当 $|D_K|$ 增大时该比率的趋势。$h_K$ 的计算必须从第一性原理出发，通过对判别式为 $D_K$ 的既约本原正定二元二次型进行计数来执行；更精确地说，对于 $D_K  0$，$h_K$ 等于判别式为 $D_K$ 的既约本原二元二次型 $[a,b,c]$ 的数量，其中 $b^2 - 4ac = D_K$，$\\gcd(a,b,c) = 1$，滿足 $|b| \\le a \\le c$，并且当 $|b| = a$ 或 $a = c$ 时，额外要求 $b \\ge 0$。除了这些核心定义之外，不要使用任何快捷公式。\n\n请使用以下由无平方因子根数 $d$（均为整数，均为严格负数）组成的测试套件，其设计旨在覆盖以下情况：\n- 典型的较小域，\n- 已知的类数为 $1$ 的边缘情况（其比率为 $0$），\n- 以及逐渐增大的判别式，以观察渐进行为。\n\n测试套件中 $d$ 的值：\n- $-1$, $-2$, $-5$, $-6$, $-7$, $-10$, $-13$, $-37$, $-61$, $-101$, $-1009$, $-5003$, $-9973$, $-100003$。\n\n对于测试套件中的每个 $d$：\n1. 计算 $D_K$。\n2. 通过对判别式为 $D_K$ 的既约本原正定二元二次型进行计数来计算 $h_K$。\n3. 设 $R_K = 1$。\n4. 使用自然对数计算比率 $\\frac{\\log(h_K R_K)}{\\log\\sqrt{|D_K|}}$。\n\n所有对数必须是自然对数，且不涉及角度。不涉及任何物理单位。最终输出应为一行，包含测试套件的比率，按相同顺序，以逗号分隔的列表形式，并用方括号括起，每个比率四舍五入到六位小数（例如，“[0.000000,0.463210,...]”）。如果在任何阶段 $h_K R_K = 1$，则四舍五入后的比率必须恰好为 $0.000000$。\n\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，“[result1,result2,...]”）。", "solution": "该问题是有效的。这是一个代数数论中定义明确的计算任务，基于已确立且无争议的原则。所有必需的定义、常数和数据均已提供且相互一致。任务是针对一组指定的虚二次域，数值上研究 Brauer-Siegel 定理预测的趋势。\n\n该解决方案通过对测试套件中每个给定的无平方因子整数 $d  0$ 实施一个分步过程来构建。\n\n**1. 判别式计算**\n\n第一步是计算虚二次域 $K = \\mathbb{Q}(\\sqrt{d})$ 的判别式 $D_K$。如所述，该规则基于 $d$ 模 $4$ 的同余关系：\n- 如果 $d \\equiv 1 \\pmod{4}$，判别式为 $D_K = d$。\n- 如果 $d \\equiv 2 \\pmod{4}$ 或 $d \\equiv 3 \\pmod{4}$，判别式为 $D_K = 4d$。\n因为 $d$ 是无平方因子的，所以 $d$ 不可能同余于 $0 \\pmod{4}$。这个基本不变量 $D_K$ 总是同余于 $0$ 或 $1 \\pmod{4}$。\n\n**2. 类数计算**\n\n计算中最密集的部分是确定类数 $h_K$。问题要求从第一性原理进行计算，具体方法是计算判别式为 $D_K$ 的既约本原正定二元二次型的数量。\n\n一个二元二次型，记作 $[a,b,c]$，对应于多项式 $ax^2 + bxy + cy^2$。为了使该型与我们的问题相关，它必须满足一组特定条件：\n- **判别式**：该型的判别式必须是 $D_K$，即 $b^2 - 4ac = D_K$。\n- **正定**：由于 $D_K  0$，这等价于要求 $a > 0$。鉴于 $4ac = b^2 - D_K > 0$，如果 $a > 0$，则 $c$ 也必须为正。\n- **本原**：系数必须互质，即 $\\gcd(a,b,c) = 1$。\n- **既约**：该型必须满足既约条件 $|b| \\le a \\le c$。此外，如果等式成立，即 $|b| = a$ 或 $a = c$，则要求 $b \\ge 0$。\n\n$h_K$ 的值恰好是满足所有这些条件的唯一三元组 $[a,b,c]$ 的数量。为了找到这个数，我们开发了一个算法，通过利用从这些条件本身推导出的约束来枚举这些三元组。\n\n由 $|b| \\le a$ 和 $a \\le c$，我们有 $a^2 \\le c \\cdot a$。因此，$4a^2 \\le 4ac = b^2 - D_K$。\n由相同条件，$b^2 \\le a^2$。\n将这些不等式结合起来得到 $4b^2 \\le 4a^2 \\le b^2 - D_K$，整理后为 $3b^2 \\le -D_K = |D_K|$。这为系数 $b$ 提供了一个关键的搜索界限：\n$$|b| \\le \\sqrt{\\frac{|D_K|}{3}}$$\n此外，判别式方程 $b^2 - 4ac = D_K$ 意味着 $b^2 \\equiv D_K \\pmod 4$。由于 $D_K \\equiv 0$ 或 $1 \\pmod 4$，这意味着 $b$ 必须与 $D_K$ 具有相同的奇偶性。\n\n计算 $h_K$ 的算法如下：\n1. 将 $h_K$ 的计数器初始化为 $0$。\n2. 遍历从 $0$ 到 $\\lfloor\\sqrt{|D_K|/3}\\rfloor$ 的整数值 $b$，确保 $b$ 与 $D_K$ 具有相同的奇偶性。\n3. 对于每个 $b$ 值，计算乘积 $ac = (b^2 - D_K)/4$。这个量必须是一个整数。\n4. 遍历 $a$ 可能的整数值。既约条件对 $a$ 进行了约束。由于在我们的循环中 $b \\ge 0$，$|b| \\le a$ 变为 $b \\le a$。条件 $a \\le c$ 意味着 $a^2 \\le ac$，因此 $a \\le \\sqrt{ac}$。因此，我们在范围 $[\\max(1, b), \\lfloor\\sqrt{ac}\\rfloor]$ 内搜索乘积 $ac$ 的因子 $a$。\n5. 对每个这样的因子 $a$，我们找到 $c = ac/a$。现在我们有了一个候选三元组 $[a,b,c]$。\n6. 我们通过检查 $\\gcd(a,b,c)=1$ 来验证该型是否为本原的。\n7. 如果该型是本原的，我们根据既约条件应用计数规则。我们的搜索策略只考虑 $b \\ge 0$：\n   - 如果该型位于基本域的边界上，即 $b=0$, $b=a$ 或 $a=c$，则计数一次。$h_K$ 的总数增加 $1$。\n   - 如果该型位于内部，即 $0  b  a  c$，它代表一对既约型，$[a,b,c]$ 和 $[a,-b,c]$。$h_K$ 的总数增加 $2$。\n\n**3. 比率计算**\n\n最后一步是计算由 Brauer-Siegel 定理指定的比率。对于虚二次域，调节子 $R_K$ 定义为 $1$。比率为：\n$$ L = \\frac{\\log(h_K R_K)}{\\log\\sqrt{|D_K|}} $$\n代入 $R_K=1$ 并使用对数性质 $\\log(x^y) = y \\log(x)$，表达式简化为：\n$$ L = \\frac{\\log(h_K)}{\\frac{1}{2}\\log|D_K|} = \\frac{2\\log(h_K)}{\\log|D_K|} $$\n所使用的对数是自然对数（以 $e$ 为底）。在类数 $h_K=1$ 的特殊情况下，分子 $\\log(1)=0$，使得比率为 $0$。分母总是不为零，因为对于所有虚二次域，都有 $|D_K| \\ge 3$。\n\n所提供的 Python 程序实现了这一完整方法。它遍历给定的 $d$ 值列表，为每个值执行这些计算，将得到的比率格式化为六位小数，并以单个逗号分隔列表的形式生成最终输出。", "answer": "```python\nimport math\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to compute and print the Brauer-Siegel ratio for a test suite.\n    \"\"\"\n\n    def compute_discriminant(d: int) - int:\n        \"\"\"\n        Computes the discriminant D_K for K = Q(sqrt(d)).\n        d must be a squarefree integer.\n        \"\"\"\n        # In Python, for negative d, d % 4 gives a result in {0, 1, 2, 3}.\n        # d = 4k+r, r = d % 4. e.g., -7 = 4*(-2)+1, so -7 % 4 = 1.\n        if d % 4 == 1:\n            return d\n        else:\n            return 4 * d\n\n    def compute_class_number(d_k: int) - int:\n        \"\"\"\n        Computes the class number h_K for a given negative discriminant d_k.\n        This is done by counting reduced primitive binary quadratic forms.\n        \"\"\"\n        h_k = 0\n        abs_dk = abs(d_k)\n        limit_b = int(math.sqrt(abs_dk / 3.0))\n\n        # b must have same parity as d_k since b^2 = d_k (mod 4) is impossible\n        # if they have different parity, and b^2-d_k must be divisible by 4.\n        # d_k % 2 is 0 for even, 1 for odd. range() starts at d_k%2 and steps by 2.\n        for b in range(d_k % 2, limit_b + 1, 2):\n            val = b * b - d_k\n            # This check is technically redundant due to the parity step, but safe.\n            if val % 4 != 0:\n                continue\n            \n            ac_prod = val // 4\n            limit_a = int(math.sqrt(ac_prod))\n            \n            # Per reduction conditions |b| = a. Since b = 0, b = a.\n            # Start a from max(1, b) to ensure a  0.\n            start_a = max(1, b)\n\n            for a in range(start_a, limit_a + 1):\n                if ac_prod % a == 0:\n                    c = ac_prod // a\n                    \n                    # We have a candidate form [a, b, c].\n                    # Conditions |b| = a and a = c are guaranteed by loop bounds.\n                    # We need to check for primitivity: gcd(a,b,c) = 1.\n                    if math.gcd(math.gcd(a, b), c) == 1:\n                        # The form is primitive and reduced (with b = 0).\n                        # Now apply the counting logic.\n                        if b == a or a == c or b == 0:\n                            # Boundary forms are counted once.\n                            h_k += 1\n                        else: # 0  b  a  c\n                            # Interior forms correspond to two reduced forms: [a,b,c] and [a,-b,c].\n                            h_k += 2\n        return h_k\n\n    # Test suite of squarefree radicands d  0\n    test_cases_d = [\n        -1, -2, -5, -6, -7, -10, -13, -37, -61, -101, -1009, -5003, -9973, -100003\n    ]\n\n    results = []\n    for d in test_cases_d:\n        # Step 1: Compute discriminant\n        d_k = compute_discriminant(d)\n        \n        # Step 2: Compute class number\n        h_k = compute_class_number(d_k)\n        \n        # Step 3: Compute the ratio\n        r_k = 1\n        h_r_prod = h_k * r_k\n\n        if h_r_prod == 1:\n            ratio = 0.0\n        else:\n            log_hr = math.log(h_r_prod)\n            # The ratio is log(h_k*R_k) / log(sqrt(|D_k|))\n            # which simplifies to 2 * log(h_k) / log(|D_k|)\n            log_abs_dk = math.log(abs(d_k))\n            ratio = 2 * log_hr / log_abs_dk\n            \n        results.append(f\"{ratio:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3025202"}]}