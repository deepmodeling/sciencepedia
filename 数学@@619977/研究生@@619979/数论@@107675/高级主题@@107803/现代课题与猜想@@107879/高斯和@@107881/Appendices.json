{"hands_on_practices": [{"introduction": "理论学习的最佳伙伴是动手实践。本练习旨在通过一个具体的例子，从最基本的定义出发，让你亲手计算一个二次高斯和。通过处理模 5 的情况，你将直接使用狄利克雷特征和单位根的代数性质，这不仅能加深你对高斯和结构的理解，还能让你体会到其平方值的深刻性质 [@problem_id:3015075]。", "problem": "设 $\\chi$ 表示模 $5$ 的唯一本原二次狄利克雷特征，即，该特征定义为：如果 $\\gcd(a,5)\\neq 1$，则 $\\chi(a)=0$；对于与 $5$ 互质的 $a$，如果 $a$ 是模 $5$ 的二次剩余，则 $\\chi(a)=1$，否则 $\\chi(a)=-1$。定义高斯和\n$$\n\\tau(\\chi)\\;=\\;\\sum_{a=1}^{5}\\chi(a)\\,\\exp\\!\\left(2\\pi i\\,\\frac{a}{5}\\right).\n$$\n仅使用狄利克雷特征、分圆多项式和本原单位根的基本定义和代数性质，精确计算 $\\tau(\\chi)$ 并验证 $\\tau(\\chi)^2=5$ 及其符号的正确性。请用闭式形式表达你的最终答案（无须数值近似）。无须四舍五入。", "solution": "问题要求计算模 $5$ 的唯一本原二次狄利克雷特征 $\\chi$ 的高斯和 $\\tau(\\chi)$，并验证其平方为 $5$。\n\n首先，我们必须确定特征 $\\chi(a)$ 对于 $a \\in \\{1, 2, 3, 4, 5\\}$ 的值。模为 $p=5$。特征 $\\chi$ 的定义取决于整数 $a$ 是否是模 $5$ 的二次剩余。\n\n模 $5$ 的非零整数为 $\\{1, 2, 3, 4\\}$。我们计算它们的平方：\n$1^2 \\equiv 1 \\pmod{5}$\n$2^2 \\equiv 4 \\pmod{5}$\n$3^2 \\equiv 9 \\equiv 4 \\pmod{5}$\n$4^2 \\equiv 16 \\equiv 1 \\pmod{5}$\n\n模 $5$ 的非零二次剩余集是 $\\{1, 4\\}$。二次非剩余集是 $\\{2, 3\\}$。\n根据 $\\chi$ 的定义：\n\\begin{itemize}\n    \\item 如果 $a \\in \\{1, 4\\}$ (二次剩余)，则 $\\chi(a) = 1$。\n    \\item 如果 $a \\in \\{2, 3\\}$ (二次非剩余)，则 $\\chi(a) = -1$。\n    \\item 如果 $\\gcd(a, 5) \\neq 1$，则 $\\chi(a) = 0$，这在给定范围内适用于 $a=5$。因此，$\\chi(5)=0$。\n\\end{itemize}\n因此，我们得到以下值：$\\chi(1)=1$，$\\chi(2)=-1$，$\\chi(3)=-1$，$\\chi(4)=1$ 以及 $\\chi(5)=0$。\n\n高斯和定义为：\n$$ \\tau(\\chi) = \\sum_{a=1}^{5} \\chi(a) \\exp\\left(2\\pi i \\frac{a}{5}\\right) $$\n设 $\\zeta = \\exp\\left(\\frac{2\\pi i}{5}\\right)$ 为一个 $5$ 次本原单位根。高斯和可以写作：\n$$ \\tau(\\chi) = \\sum_{a=1}^{5} \\chi(a) \\zeta^a $$\n代入 $\\chi(a)$ 的值：\n$$ \\tau(\\chi) = \\chi(1)\\zeta^1 + \\chi(2)\\zeta^2 + \\chi(3)\\zeta^3 + \\chi(4)\\zeta^4 + \\chi(5)\\zeta^5 $$\n$$ \\tau(\\chi) = (1)\\zeta^1 + (-1)\\zeta^2 + (-1)\\zeta^3 + (1)\\zeta^4 + (0)\\zeta^5 $$\n$$ \\tau(\\chi) = \\zeta - \\zeta^2 - \\zeta^3 + \\zeta^4 $$\n\n为了简化此表达式，我们使用本原单位根 $\\zeta$ 的性质。它是 $5$ 次分圆多项式 $\\Phi_5(x) = x^4 + x^3 + x^2 + x + 1$ 的一个根。因此，我们有基本关系式：\n$$ 1 + \\zeta + \\zeta^2 + \\zeta^3 + \\zeta^4 = 0 $$\n另请注意，对于任意整数 $k$，有 $\\zeta^k = \\zeta^{k \\pmod{5}}$，且 $\\zeta^5 = 1$。$\\zeta^k$ 的复共轭是 $\\overline{\\zeta^k} = \\zeta^{-k} = \\zeta^{5-k}$。具体来说，$\\overline{\\zeta} = \\zeta^4$，$\\overline{\\zeta^2} = \\zeta^3$。\n\n我们可以将 $\\tau(\\chi)$ 中的项分组如下：\n$$ \\tau(\\chi) = (\\zeta + \\zeta^4) - (\\zeta^2 + \\zeta^3) $$\n\n首先，我们来验证 $\\tau(\\chi)^2 = 5$。我们直接计算其平方：\n$$ \\tau(\\chi)^2 = [(\\zeta + \\zeta^4) - (\\zeta^2 + \\zeta^3)]^2 = (\\zeta + \\zeta^4)^2 - 2(\\zeta + \\zeta^4)(\\zeta^2 + \\zeta^3) + (\\zeta^2 + \\zeta^3)^2 $$\n我们来计算每个部分：\n$(\\zeta + \\zeta^4)^2 = \\zeta^2 + 2\\zeta^5 + \\zeta^8 = \\zeta^2 + 2\\zeta^0 + \\zeta^3 = \\zeta^2 + 2 + \\zeta^3$。\n$(\\zeta^2 + \\zeta^3)^2 = \\zeta^4 + 2\\zeta^5 + \\zeta^6 = \\zeta^4 + 2\\zeta^0 + \\zeta^1 = \\zeta^4 + 2 + \\zeta$。\n$(\\zeta + \\zeta^4)(\\zeta^2 + \\zeta^3) = \\zeta^3 + \\zeta^4 + \\zeta^6 + \\zeta^7 = \\zeta^3 + \\zeta^4 + \\zeta^1 + \\zeta^2$。\n使用分圆关系式，$\\zeta + \\zeta^2 + \\zeta^3 + \\zeta^4 = -1$。\n所以，$(\\zeta + \\zeta^4)(\\zeta^2 + \\zeta^3) = -1$。\n\n将这些代回 $\\tau(\\chi)^2$ 的表达式中：\n$$ \\tau(\\chi)^2 = (\\zeta^2 + \\zeta^3 + 2) - 2(-1) + (\\zeta + \\zeta^4 + 2) $$\n$$ \\tau(\\chi)^2 = (\\zeta + \\zeta^2 + \\zeta^3 + \\zeta^4) + 4 + 2 $$\n$$ \\tau(\\chi)^2 = (-1) + 6 = 5 $$\n这验证了 $\\tau(\\chi)^2 = 5$。这意味着 $\\tau(\\chi)$ 必须是 $\\sqrt{5}$ 或 $-\\sqrt{5}$。平方结果的符号为正。\n\n为了求出 $\\tau(\\chi)$ 的精确值，我们必须确定它的符号。我们可以用余弦来表示这个和：\n$\\zeta + \\zeta^4 = \\zeta + \\bar{\\zeta} = 2\\operatorname{Re}(\\zeta) = 2\\cos\\left(\\frac{2\\pi}{5}\\right)$。\n$\\zeta^2 + \\zeta^3 = \\zeta^2 + \\overline{\\zeta^2} = 2\\operatorname{Re}(\\zeta^2) = 2\\cos\\left(\\frac{4\\pi}{5}\\right)$。\n所以，\n$$ \\tau(\\chi) = 2\\cos\\left(\\frac{2\\pi}{5}\\right) - 2\\cos\\left(\\frac{4\\pi}{5}\\right) $$\n为了求出这些余弦的值，我们回到分圆多项式关系 $1 + \\zeta + \\zeta^2 + \\zeta^3 + \\zeta^4 = 0$。两边同除以 $\\zeta^2$（非零）得到：\n$$ \\zeta^{-2} + \\zeta^{-1} + 1 + \\zeta + \\zeta^2 = 0 $$\n$$ (\\zeta^2 + \\zeta^{-2}) + (\\zeta + \\zeta^{-1}) + 1 = 0 $$\n设 $y = \\zeta + \\zeta^{-1} = 2\\cos\\left(\\frac{2\\pi}{5}\\right)$。那么 $y^2 = \\zeta^2 + 2 + \\zeta^{-2}$，所以 $\\zeta^2+\\zeta^{-2} = y^2-2$。将此代入方程中：\n$$ (y^2 - 2) + y + 1 = 0 $$\n$$ y^2 + y - 1 = 0 $$\n$y$ 的解由二次求根公式给出：$y = \\frac{-1 \\pm \\sqrt{1^2 - 4(1)(-1)}}{2} = \\frac{-1 \\pm \\sqrt{5}}{2}$。\n因为 $\\frac{2\\pi}{5}$ 是第一象限角，其余弦值为正。因此，$y = 2\\cos\\left(\\frac{2\\pi}{5}\\right)$ 必须为正。我们选择正根：\n$$ 2\\cos\\left(\\frac{2\\pi}{5}\\right) = \\frac{-1 + \\sqrt{5}}{2} $$\n另一个值 $2\\cos\\left(\\frac{4\\pi}{5}\\right)$ 可以用类似的方法找到。设 $z = \\zeta^2 + \\zeta^{-2}$。$z$ 也是 $y^2+y-1=0$ 的一个根。因为 $\\frac{4\\pi}{5}$ 在第二象限，其余弦值为负。因此，我们必须选择负根：\n$$ 2\\cos\\left(\\frac{4\\pi}{5}\\right) = \\frac{-1 - \\sqrt{5}}{2} $$\n现在我们可以计算 $\\tau(\\chi)$：\n$$ \\tau(\\chi) = \\left(\\frac{-1 + \\sqrt{5}}{2}\\right) - \\left(\\frac{-1 - \\sqrt{5}}{2}\\right) $$\n$$ \\tau(\\chi) = \\frac{-1 + \\sqrt{5} - (-1 - \\sqrt{5})}{2} = \\frac{-1 + \\sqrt{5} + 1 + \\sqrt{5}}{2} $$\n$$ \\tau(\\chi) = \\frac{2\\sqrt{5}}{2} = \\sqrt{5} $$\n高斯和的精确值为 $\\sqrt{5}$。这是一个闭式表达式。作为最终检验，$(\\sqrt{5})^2 = 5$，这与我们之前的验证一致。符号为正。", "answer": "$$\\boxed{\\sqrt{5}}$$", "id": "3015075"}, {"introduction": "在掌握了基本的高斯和计算之后，下一个重要的步骤是理解它与其他相关和式的联系。这个练习引入了一类更广泛的二次指数和 $S_p(a)$，并要求你揭示其与标准二次高斯和 $\\tau(\\chi)$ 之间的简洁关系。通过这个过程，你将学会如何运用勒让德符号将一类看似复杂的求值问题简化为对一个基本对象的计算，这展现了数论中一个核心的解题策略 [@problem_id:3015081]。", "problem": "设 $p$ 为一个奇素数，并记 $\\zeta_{p} \\coloneqq \\exp\\!\\big(2\\pi i/p\\big)$。对于 $a \\in \\mathbb{Z}$ 且 $p \\nmid a$，定义二次指数和\n$$\nS_{p}(a) \\coloneqq \\sum_{x \\bmod p} \\zeta_{p}^{\\,a x^{2}}.\n$$\n另外，令 $\\left(\\frac{\\cdot}{p}\\right)$ 表示模 $p$ 的勒让德符号，并将二次狄利克雷特征 $\\chi(n) \\coloneqq \\left(\\frac{n}{p}\\right)$ 的二次高斯和定义为\n$$\n\\tau(\\chi) \\coloneqq \\sum_{y \\bmod p} \\chi(y)\\,\\zeta_{p}^{\\,y}.\n$$\n仅使用 $\\mathbb{Z}/p\\mathbb{Z}$ 上加法特征的基本性质、勒让德符号以及二次同余方程解的基本计数方法，计算下列和式\n$$\n\\sum_{x \\bmod 13} \\exp\\!\\left(\\frac{2\\pi i}{13}\\,3 x^{2}\\right),\n$$\n并以最简精确形式给出你的答案。然后，在二次高斯和的经典求值中确定 $\\varepsilon_{13}$ 的值，并验证你的结果与表达式 $\\varepsilon_{13}\\left(\\frac{3}{13}\\right)\\sqrt{13}$ 一致，其中 $\\varepsilon_{p}$ 仅取决于 $p \\bmod 4$。不需要数值近似或四舍五入，最终答案必须是精确值。", "solution": "该问题要求计算一个特定的二次指数和，并随后使用二次高斯和的经典公式进行验证。\n\n需要计算的和式为\n$$\nS_{13}(3) = \\sum_{x \\bmod 13} \\exp\\left(\\frac{2\\pi i}{13}\\,3 x^{2}\\right).\n$$\n这是一般二次指数和 $S_{p}(a) = \\sum_{x \\bmod p} \\zeta_{p}^{ax^{2}}$ 的一个实例，其中 $p$ 是一个奇素数，$a \\in \\mathbb{Z}$ 且 $p \\nmid a$，并且 $\\zeta_{p} = \\exp(2\\pi i/p)$。在此问题中，$p=13$ 且 $a=3$。\n\n首先，我们建立 $S_{p}(a)$ 与二次高斯和 $\\tau(\\chi) = \\sum_{y \\bmod p} \\chi(y)\\,\\zeta_{p}^{y}$ 之间的普遍关系，其中 $\\chi(y) = \\left(\\frac{y}{p}\\right)$ 是勒让德符号。\n\n$S_{p}(a)$ 的和式可以通过将 $x^2 \\pmod p$ 值相同的项分组来重写。令 $y$ 为 $\\mathbb{Z}/p\\mathbb{Z}$ 中的一个值。令 $N(y)$ 为同余方程 $x^2 \\equiv y \\pmod p$ 的解的个数。那么该和式可以表示为：\n$$\nS_{p}(a) = \\sum_{y=0}^{p-1} N(y) \\zeta_{p}^{ay}.\n$$\n解的个数 $N(y)$ 由 $N(y) = 1 + \\left(\\frac{y}{p}\\right)$ 给出。我们来验证这一点：\n- 如果 $y=0$，同余方程为 $x^2 \\equiv 0 \\pmod p$，它有一个解 $x=0$。该公式给出 $1 + \\left(\\frac{0}{p}\\right) = 1+0=1$。\n- 如果 $y$ 是一个非零的模 $p$ 二次剩余，那么 $\\left(\\frac{y}{p}\\right)=1$。同余方程 $x^2 \\equiv y \\pmod p$ 恰好有两个解。该公式给出 $1+1=2$。\n- 如果 $y$ 是一个模 $p$ 二次非剩余，那么 $\\left(\\frac{y}{p}\\right)=-1$。同余方程 $x^2 \\equiv y \\pmod p$ 没有解。该公式给出 $1-1=0$。\n该公式对所有 $y \\in \\mathbb{Z}/p\\mathbb{Z}$ 都成立。\n\n将 $N(y) = 1 + \\left(\\frac{y}{p}\\right)$ 代入 $S_{p}(a)$ 的表达式中：\n$$\nS_{p}(a) = \\sum_{y=0}^{p-1} \\left(1 + \\left(\\frac{y}{p}\\right)\\right) \\zeta_{p}^{ay} = \\sum_{y=0}^{p-1} \\zeta_{p}^{ay} + \\sum_{y=0}^{p-1} \\left(\\frac{y}{p}\\right) \\zeta_{p}^{ay}.\n$$\n第一项是关于加法群 $\\mathbb{Z}/p\\mathbb{Z}$ 的和。由于 $p \\nmid a$，映射 $y \\mapsto ay$ 是 $\\mathbb{Z}/p\\mathbb{Z}$ 的一个自同构。因此，$\\{ay \\bmod p\\}_{y=0}^{p-1}$ 是一个模 $p$ 的完备剩余系。所有 $p$ 次单位根之和为零：\n$$\n\\sum_{y=0}^{p-1} \\zeta_{p}^{ay} = \\sum_{z=0}^{p-1} \\zeta_{p}^{z} = 0.\n$$\n第二项是 $\\sum_{y=0}^{p-1} \\left(\\frac{y}{p}\\right) \\zeta_{p}^{ay}$。由于 $\\left(\\frac{0}{p}\\right)=0$，$y=0$ 的项为零。令 $a^{-1}$ 为 $a$ 模 $p$ 的乘法逆元。我们进行变量代换 $z = ay$，这意味着 $y=a^{-1}z$。当 $y$ 遍历 $(\\mathbb{Z}/p\\mathbb{Z})^\\times$ 时，$z$ 也同样。\n$$\n\\sum_{y=1}^{p-1} \\left(\\frac{y}{p}\\right) \\zeta_{p}^{ay} = \\sum_{z=1}^{p-1} \\left(\\frac{a^{-1}z}{p}\\right) \\zeta_{p}^{z}.\n$$\n利用勒让德符号的乘法性质，$\\left(\\frac{a^{-1}z}{p}\\right) = \\left(\\frac{a^{-1}}{p}\\right)\\left(\\frac{z}{p}\\right)$。我们还知道 $\\left(\\frac{a^{-1}}{p}\\right) = \\left(\\frac{a}{p}\\right)$，因为 $\\left(\\frac{a^{-1}}{p}\\right)\\left(\\frac{a}{p}\\right) = \\left(\\frac{a^{-1}a}{p}\\right) = \\left(\\frac{1}{p}\\right) = 1$。所以该和式变为：\n$$\n\\left(\\frac{a}{p}\\right) \\sum_{z=1}^{p-1} \\left(\\frac{z}{p}\\right) \\zeta_{p}^{z} = \\left(\\frac{a}{p}\\right) \\tau(\\chi).\n$$\n结合这些结果，我们得到基本关系：\n$$\nS_{p}(a) = \\left(\\frac{a}{p}\\right) \\tau(\\chi).\n$$\n现在，我们将此应用于 $p=13$ 和 $a=3$ 的具体问题。我们需要计算勒让德符号 $\\left(\\frac{3}{13}\\right)$。使用二次互反律：\n$$\n\\left(\\frac{3}{13}\\right) = \\left(\\frac{13}{3}\\right) (-1)^{\\frac{3-1}{2} \\cdot \\frac{13-1}{2}} = \\left(\\frac{13}{3}\\right) (-1)^{1 \\cdot 6} = \\left(\\frac{13}{3}\\right).\n$$\n由于 $13 \\equiv 1 \\pmod 3$，我们有 $\\left(\\frac{13}{3}\\right) = \\left(\\frac{1}{3}\\right)=1$。因此，$\\left(\\frac{3}{13}\\right)=1$。\n\n将此代入我们关于 $S_{13}(3)$ 的关系式中：\n$$\nS_{13}(3) = \\left(\\frac{3}{13}\\right) \\tau(\\chi) = 1 \\cdot \\tau(\\chi) = \\tau(\\chi).\n$$\n为了计算该和式，我们必须计算 $p=13$ 时的二次高斯和 $\\tau(\\chi)$。二次高斯和的精确值是由 Gauss 建立的一个经典结果：\n$$\n\\tau(\\chi) = \\sum_{y=1}^{p-1} \\left(\\frac{y}{p}\\right)\\zeta_p^y = \\begin{cases} \\sqrt{p} & \\text{若 } p \\equiv 1 \\pmod 4 \\\\ i\\sqrt{p} & \\text{若 } p \\equiv 3 \\pmod 4 \\end{cases}.\n$$\n对于我们的情况，$p=13$。由于 $13 \\equiv 1 \\pmod 4$，其值为：\n$$\n\\tau(\\chi) = \\sqrt{13}.\n$$\n因此，该和式的值为：\n$$\nS_{13}(3) = \\sqrt{13}.\n$$\n至此完成了和式的计算。\n\n接下来，题目要求我们确定 $\\varepsilon_{13}$ 的值，并验证我们的结果与表达式 $\\varepsilon_{13}\\left(\\frac{3}{13}\\right)\\sqrt{13}$ 的一致性，其中 $\\varepsilon_p$ 仅取决于 $p \\bmod 4$。\n\n题目暗示了对于 $p \\equiv 1 \\pmod 4$ 的情况，有公式 $S_{p}(a) = \\varepsilon_{p}\\left(\\frac{a}{p}\\right)\\sqrt{p}$。\n我们已经推导出 $S_p(a) = \\left(\\frac{a}{p}\\right)\\tau(\\chi)$。对于 $p=13$ 和 $a=3$，这给出 $S_{13}(3) = \\left(\\frac{3}{13}\\right)\\tau(\\chi)$。\n待验证的表达式意味着 $S_{13}(3) = \\varepsilon_{13}\\left(\\frac{3}{13}\\right)\\sqrt{13}$。\n令两者相等可得：\n$$\n\\left(\\frac{3}{13}\\right)\\tau(\\chi) = \\varepsilon_{13}\\left(\\frac{3}{13}\\right)\\sqrt{13}.\n$$\n由于 $\\left(\\frac{3}{13}\\right)=1 \\neq 0$，我们可以用它来除，得到：\n$$\n\\tau(\\chi) = \\varepsilon_{13}\\sqrt{13}.\n$$\n根据高斯和对于 $p=13 \\equiv 1 \\pmod 4$ 的经典求值，我们有 $\\tau(\\chi) = \\sqrt{13}$。\n比较 $\\tau(\\chi)$ 的这两个表达式：\n$$\n\\sqrt{13} = \\varepsilon_{13}\\sqrt{13}.\n$$\n这意味着 $\\varepsilon_{13} = 1$。更一般地，$\\varepsilon_p$ 的约定是，如果 $p \\equiv 1 \\pmod 4$，则 $\\varepsilon_p = 1$；如果 $p \\equiv 3 \\pmod 4$，则 $\\varepsilon_p = i$。在本题的上下文中，其结构暗示对于 $p=13$，有 $\\tau(\\chi) = \\varepsilon_{13}\\sqrt{13}$。其值确实是 $\\varepsilon_{13}=1$。\n\n最后，我们进行验证。\n我们计算出的和式的值是 $S_{13}(3) = \\sqrt{13}$。\n给定表达式的值为 $\\varepsilon_{13}\\left(\\frac{3}{13}\\right)\\sqrt{13}$。代入我们求得的值：\n$$\n\\varepsilon_{13}\\left(\\frac{3}{13}\\right)\\sqrt{13} = (1)(1)\\sqrt{13} = \\sqrt{13}.\n$$\n由于 $\\sqrt{13} = \\sqrt{13}$，我们的结果与给定表达式一致。验证到此结束。主要结果是该和式的值。", "answer": "$$\n\\boxed{\\sqrt{13}}\n$$", "id": "3015081"}, {"introduction": "除了代数推导，现代数学研究也越来越依赖于计算探索来建立直觉和验证理论。这个练习将指导你编写程序，以数值方式检验高斯和的两个核心理论预测：幅角的均匀分布和大小的“平方根抵消”特性。通过对不同素数和特征的计算，你将观察到这些抽象理论在实践中呈现出的清晰模式，从而将理论知识与经验证据联系起来，获得更深刻的洞察 [@problem_id:3015085]。", "problem": "设 $p$ 是一个素数，并令 $\\mathbb{F}_p$ 表示包含 $p$ 个元素的有限域。定义典范加法特征 $\\psi:\\mathbb{F}_p\\to\\mathbb{C}$ 为 $\\psi(x)=\\exp\\!\\left(\\frac{2\\pi i x}{p}\\right)$。一个乘法特征 $\\chi:\\mathbb{F}_p^\\times\\to\\mathbb{C}^\\times$ 是从乘法群 $\\mathbb{F}_p^\\times$ 到单位圆的一个群同态，并按惯例扩展为 $\\chi(0)=0$。对于一个给定的乘法特征 $\\chi$，其关联的 Gauss 和是复数\n$$\n\\tau(\\chi)=\\sum_{x\\in\\mathbb{F}_p}\\chi(x)\\,\\psi(x).\n$$\n对于每个 $a\\in\\mathbb{F}_p^\\times$，考虑加法扭转 Gauss 和\n$$\nS(a)=\\sum_{x\\in\\mathbb{F}_p}\\chi(x)\\,\\psi(a x),\n$$\n及其归一化的单位圆值\n$$\nU(a)=\\begin{cases}\n\\frac{S(a)}{|S(a)|}, & \\text{如果 }S(a)\\neq 0,\\\\\n1, & \\text{如果 }S(a)=0.\n\\end{cases}\n$$\n设特征的阶为 $d=\\mathrm{ord}(\\chi)$，即满足 $\\chi^d$ 是 $\\mathbb{F}_p^\\times$ 上的平凡特征的最小正整数 $d$。为完成本任务，通过固定一个原根 $g\\in\\mathbb{F}_p^\\times$（即阶为 $p-1$ 的循环群 $\\mathbb{F}_p^\\times$ 的一个生成元）并选择一个整数参数 $k\\in\\{0,1,\\dots,p-2\\}$ 来构造乘法特征。定义 $\\chi_k(g^t)=\\exp\\!\\left(\\frac{2\\pi i k t}{p-1}\\right)$，其中 $t\\in\\{0,1,\\dots,p-2\\}$，并扩展为 $\\chi_k(0)=0$。特征 $\\chi_k$ 的阶为 $d=\\frac{p-1}{\\gcd(k,p-1)}$，并约定平凡特征 $\\chi_0$ 的阶为 $d=1$。\n\n你的程序必须仅从这些定义以及标准的群论和特征论事实出发，不使用任何超出基础范围的专门预推导公式，执行以下操作：\n\n- 对于每个给定的测试用例 $(p,k)$，构造一个原根 $g\\in\\mathbb{F}_p^\\times$，通过关于 $g$ 的离散对数建立乘法特征 $\\chi_k$，并定义典范加法特征 $\\psi$。\n- 对于每个 $a\\in\\mathbb{F}_p^\\times$，通过对所有 $x\\in\\mathbb{F}_p$ 进行直接求和来计算 $S(a)$，并遵循 $\\chi_k(0)=0$ 的惯例。\n- 计算多重集 $\\{U(a):a\\in\\mathbb{F}_p^\\times\\}$ 在由特征值生成的单位圆有限循环子群所预期的 $d$ 个不同值上的经验均匀分布差异。具体来说，将 $a$ 值划分到由 $\\chi_k$ 在 $\\mathbb{F}_p^\\times$ 上的 $d$ 个不同特征值索引的 $d$ 个箱中（每个箱对应这 $d$ 个复数值之一），统计箱 $j$ 中的出现次数 $f_j$，并报告差异\n$$\n\\Delta=\\max_{0\\le j<d}\\left|\\frac{f_j}{p-1}-\\frac{1}{d}\\right|.\n$$\n- 计算模长偏差统计量\n$$\nM=\\max_{a\\in\\mathbb{F}_p^\\times}\\left|\\frac{|S(a)|}{\\sqrt{p}}-1\\right|,\n$$\n该统计量衡量了数值与 Gauss 和一般理论为非平凡乘法特征所预测的平方根抵消模长之间的一致性，并记录了包括边界情况在内的所有情况的偏差。\n\n你的程序必须为以下参数值 $(p,k)$ 的测试套件实现上述功能：\n- $(p,k)=(7,1)$，\n- $(p,k)=(11,5)$，\n- $(p,k)=(13,3)$，\n- $(p,k)=(5,0)$。\n\n覆盖性设计：\n- $(7,1)$ 是一个通用的“理想”情况，其乘法特征具有大阶 $d=6$。\n- $(11,5)$ 是一个阶为 $d=2$ 的特征，用于测试低阶离散均匀分布。\n- $(13,3)$ 是一个阶为 $d=4$ 的特征，用于测试中阶行为。\n- $(5,0)$ 是平凡特征 $d=1$，作为一个边界情况，其中 $|S(a)|$ 不表现出平方根抵消，且均匀分布退化为单一值场景。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试用例的输出本身必须是一个双元素浮点数列表 $[\\Delta,M]$，不含空格。对于上述测试套件，最终输出格式必须为\n$$\n[\\,[\\Delta_{7,1},M_{7,1}],\\,[\\Delta_{11,5},M_{11,5}],\\,[\\Delta_{13,3},M_{13,3}],\\,[\\Delta_{5,0},M_{5,0}]\\,],\n$$\n以单行打印，数值以标准十进制浮点数给出。角度在内部使用时必须以弧度处理，但最终输出只包含指定的无量纲浮点数。", "solution": "该问题提出了一个在数论领域中有效且适定的计算任务。它要求对有限域上 Gauss 和的基本性质进行数值验证。所提供的关于有限域 $\\mathbb{F}_p$、典范加法特征 $\\psi$、乘法特征 $\\chi_k$ 以及相关的 Gauss 和 $S(a)$ 的定义都是标准的且在数学上是合理的。任务是为一组给定的参数 $(p,k)$ 计算两个统计量：均匀分布差异 $\\Delta$ 和模长偏差 $M$。这些统计量旨在检验以下理论结果：对于一个非平凡特征 $\\chi$，模长 $|S(a)|$ 是常数且等于 $\\sqrt{p}$，并且 $S(a)$ 的相位是均匀分布的。该问题是自洽的，且对于指定的素数，计算工作量是可行的。选择原根 $g$ 的模糊性不影响最终的统计数据，因为给定阶的特征集合是唯一的，并且统计量 $\\Delta$ 和 $M$ 在该集合中选择特定特征时是不变的。因此，该问题被认为是有效的。\n\n该解决方案的实现遵循根据所提供定义直接计算的原则，而不借助关于 Gauss 和结构的高级、预先推导的定理。每个测试用例 $(p,k)$ 的处理过程如下：\n\n首先，构建必要的代数结构。对于给定的素数 $p$，通过算法确定乘法群 $\\mathbb{F}_p^\\times$ 的一个原根 $g$。一个数 $g \\in \\{2, \\ldots, p-1\\}$ 是一个原根，当且仅当对于 $p-1$ 的所有不同素因子 $q$，都有 $g^{(p-1)/q} \\not\\equiv 1 \\pmod{p}$。找到一个原根 $g$ 后，预计算一个离散对数表，即对所有 $x \\in \\mathbb{F}_p^\\times$ 计算 $\\log_g(x) = t$，其中 $x \\equiv g^t \\pmod{p}$。\n\n利用这些结构，定义特征。典范加法特征为 $\\psi(x) = \\exp(2\\pi i x / p)$。对任意 $x \\in \\mathbb{F}_p^\\times$，乘法特征 $\\chi_k$ 定义为 $\\chi_k(x) = \\exp(2\\pi i k \\log_g(x) / (p-1))$，并约定 $\\chi_k(0) = 0$。这些函数被实现为返回复数。\n\n接下来，为每个 $a \\in \\mathbb{F}_p^\\times = \\{1, 2, \\dots, p-1\\}$ 计算加法扭转 Gauss 和 $S(a)$。每个 $S(a)$ 的值通过直接评估其定义和式来计算：\n$$\nS(a) = \\sum_{x \\in \\mathbb{F}_p} \\chi_k(x) \\psi(ax) = \\sum_{x=0}^{p-1} \\chi_k(x) \\exp\\left(\\frac{2\\pi i (ax \\pmod p)}{p}\\right)\n$$\n$x=0$ 时的项是 $\\chi_k(0)\\psi(0) = 0 \\cdot 1 = 0$，所以这个和实际上是在 $\\mathbb{F}_p^\\times$ 上进行的。这些复数值的和被存储起来用于后续分析。\n\n在计算出集合 $\\{S(a) : a \\in \\mathbb{F}_p^\\times\\}$ 的值后，推导出两个必需的统计量。\n\n模长偏差统计量 $M$ 衡量了与非平凡特征的理论模长 $|S(a)| = \\sqrt{p}$ 的偏差。它通过找出在所有 $a \\in \\mathbb{F}_p^\\times$ 上的最大偏差来计算：\n$$\nM = \\max_{a \\in \\mathbb{F}_p^\\times} \\left| \\frac{|S(a)|}{\\sqrt{p}} - 1 \\right|\n$$\n这提供了对 Gauss 和恒定模长性质的直接数值检验。对于平凡特征（$k=0$），理论预测对所有 $a \\in \\mathbb{F}_p^\\times$ 都有 $|S(a)|=1$，而 $M$ 的公式正确地捕捉了与 $\\sqrt{p}$ 基线的偏差。\n\n经验均匀分布差异 $\\Delta$ 量化了归一化值 $U(a) = S(a)/|S(a)|$（当 $S(a)=0$ 时 $U(a)=1$）的分布均匀程度。首先计算特征 $\\chi_k$ 的阶 $d = (p-1)/\\gcd(k, p-1)$，使用标准约定 $\\gcd(0, n) = n$。理论预测集合 $\\{U(a) : a \\in \\mathbb{F}_p^\\times\\}$ 由 $d$ 个不同的值组成，每个值出现 $(p-1)/d$ 次。这些值是 $d$ 次单位根乘以一个常数相位 $u_0 = U(1) = S(1)/|S(1)|$。为了计算 $\\Delta$，我们定义 $d$ 个箱，其中心位于理论值 $V_j = u_0 \\exp(2\\pi i j / d)$，其中 $j \\in \\{0, 1, \\dots, d-1\\}$。每个数值计算出的 $U(a)$ 被分配到具有最近中心 $V_j$ 的箱中（依据复平面上的欧几里得距离）。设 $f_j$ 是分配给箱 $j$ 的值的计数。差异 $\\Delta$ 是观察到的与理想均匀分布的最大偏差：\n$$\n\\Delta = \\max_{0 \\le j < d} \\left| \\frac{f_j}{p-1} - \\frac{1}{d} \\right|\n$$\n对于平凡特征，其中 $d=1$，只有一个箱，它接收所有 $p-1$ 个值，所以 $f_0=p-1$。这导致 $\\Delta = |(p-1)/(p-1) - 1/1| = 0$，这被通用公式正确地处理了。\n\n将此完整过程应用于每个指定的测试用例 $(p,k)$，并将得到的结果对 $[\\Delta, M]$ 收集并格式化为最终输出。", "answer": "[[0.0,5.551115123125783e-17],[0.0,4.440892098500626e-16],[0.0,0.0],[0.0,0.552786404500042]]", "id": "3015085"}]}