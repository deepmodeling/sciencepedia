{"hands_on_practices": [{"introduction": "椭圆曲线的L函数由其欧拉积定义，其中的系数 $a_p$ 是最基本的构件。虽然 $a_p$ 可以通过在有限域 $\\mathbb{F}_p$ 上直接数点来计算，但对于具有复乘（Complex Multiplication, CM）的特殊椭圆曲线，更深刻的理论提供了更为精妙和富有洞察力的计算方法。本练习将通过一个经典案例，展示如何运用复乘理论，将 $a_p$ 的计算与高斯整数环 $\\mathbb{Z}[i]$ 的算术性质联系起来，从而揭示L函数系数背后深邃的代数结构。[@problem_id:1161316]", "problem": "一条椭圆曲线 $E$ 是指一条带有一个标记点的亏格为一的光滑射影曲线。在复数域上，这样一条曲线可以被描述为复平面与一个格的商，即 $E(\\mathbb{C}) \\cong \\mathbb{C}/\\Lambda$，其中 $\\Lambda = \\mathbb{Z}\\omega_1 + \\mathbb{Z}\\omega_2$ 是由两个 $\\mathbb{R}$-线性无关的复数 $\\omega_1, \\omega_2$ 生成的格。该同构由Weierstrass $\\wp$-函数给出，此函数满足以下微分方程\n$$(\\wp'(z))^2 = 4\\wp(z)^3 - g_2(\\Lambda)\\wp(z) - g_3(\\Lambda)$$\n其中 $g_2$ 和 $g_3$ 是格 $\\Lambda$ 的模不变量。\n\n考虑由仿射方程 $y^2 = x^3 + x$ 给出的特定椭圆曲线 $E$。这条曲线具有一个被称为复乘 (CM) 的特殊性质。其自同态环同构于高斯整数环 $\\mathbb{Z}[i]$。出现这种情况是因为其底格 $\\Lambda$ 是一个“正方形”格，对于这种格有 $g_3(\\Lambda)=0$。\n\n当我们考虑定义在素数 $p$ 的有限域 $\\mathbb{F}_p$ 上的曲线 $E$ 时，我们可以计算其上的点的个数 $N_p$（包括无穷远点）。$E$ 的 Hasse-Weil L-函数是一个包含了系数 $a_p = p + 1 - N_p$ 的欧拉乘积。\n\n复乘理论提供了一种无需显式计算点数即可计算 $a_p$ 的方法。对于一个具有好约化的素数 $p$（对于曲线 $y^2=x^3-kx$ 而言，即不整除 $2k$ 的素数），$a_p$ 的值与 $p$ 在 CM 环 $\\mathbb{Z}[i]$ 中的分解密切相关。\n\nDavenport 和 Hasse 的一个定理指出，对于曲线 $y^2 = x^3 - kx$ 和素数 $p \\equiv 1 \\pmod 4$，我们有 $a_p=2a$。在这里，$a$ 是一个高斯素数 $\\pi = a+bi$ 的实部，该高斯素数是 $p$ 的一个因子（即 $p = a^2+b^2 = \\pi\\bar{\\pi}$），并通过以下同余式进行规格化：\n$$ \\pi \\equiv \\left(\\frac{k}{p}\\right)_4^{-1} \\pmod{2-2i} $$\n其中 $(\\frac{k}{p})_4$ 是四次剩余符号，定义为 $(\\frac{k}{p})_4 \\equiv k^{(p-1)/4} \\pmod{p}$。注意，对于我们的曲线 $y^2=x^3+x$，有 $k=-1$。在 $p$ 的素因子的所有相伴元中，满足此同余式的 $\\pi$ 的选择是唯一的。\n\n使用此框架，确定椭圆曲线 $y^2 = x^3 + x$ 在素数 $p = 37$ 处的 Hasse-Weil L-函数的系数 $a_p$。", "solution": "1.  对于素数 $p\\equiv1\\pmod4$，有 $a_p=2a$，其中 $p=a^2+b^2$ 且 $\\pi=a+bi$ 满足\n$$\\pi\\equiv\\Bigl(\\frac{k}{p}\\Bigr)_4^{-1}\\pmod{2-2i}\\,. $$\n这里 $k=-1$ 并且 \n$$(\\tfrac{-1}{p})_4=(-1)^{\\tfrac{p-1}4}=(-1)^9=-1,\\quad(\\tfrac{k}{p})_4^{-1}=-1\\,. $$\n\n2.  在 $\\mathbb{Z}[i]$ 中分解 $37$： \n$$37=6^2+1^2=(6+i)(6-i)=1^2+6^2=(1+6i)(1-6i)\\,. $$\n\n3.  在模 $2-2i$ 下测试相伴元。我们需要\n$$2-2i\\mid(\\pi+1)\\,. $$\n对于 $\\pi=6+i$：\n$$(\\pi+1)/(2-2i)=\\frac{7+i}{2-2i}=\\frac{(7+i)(2+2i)}{8}=\\frac{12+16i}{8}=\\frac{3}{2}+2i\\notin\\mathbb{Z}[i]\\,. $$\n对于 $\\pi=6-i$：\n$$(\\pi+1)/(2-2i)=\\frac{7-i}{2-2i}=\\frac{(7-i)(2+2i)}{8}=\\frac{16+12i}{8}=2+\\frac{3}{2}i\\notin\\mathbb{Z}[i]\\,. $$\n对于 $\\pi=1+6i$：\n$$(\\pi+1)/(2-2i)=\\frac{2+6i}{2-2i}=\\frac{(2+6i)(2+2i)}{8}=\\frac{-8+16i}{8}=-1+2i\\in\\mathbb{Z}[i]\\,. $$\n\n4.  因此，正确的选择是 $\\pi=1+6i$，所以 $a=\\Re\\pi=1$，从而\n$$a_{37}=2a=2\\,. $$", "answer": "$$\\boxed{2}$$", "id": "1161316"}, {"introduction": "椭圆曲线的L函数满足一个重要的函数方程，该方程联系了 $L(E, s)$ 和 $L(E, 2-s)$ 的值，而算术导子 $N$ 则是这个方程中的核心不变量。导子编码了曲线在所有坏约化素数处的退化信息，其精确计算是理解L函数整体性质的关键一步。本练习将指导你应用Tate算法——一个计算局部导子指数的标准工具——来确定一个具体椭圆曲线的总导子，从而让你亲身体验从局部退化行为到全局不变量的完整计算过程。[@problem_id:3016592]", "problem": "设 $E/\\mathbb{Q}$ 是由整系数Weierstrass方程\n$$\nE: \\quad y^{2} + xy + y \\;=\\; x^{3} - x - 1.\n$$\n给出的椭圆曲线。$E$ 的 Hasse–Weil $L$-函数（HWF），记作 $L(E,s)$，其导子是一个正整数 $N = \\prod_{p} p^{f_{p}}$。该乘积遍及所有有理素数 $p$，$f_{p}$ 是由 Tate 算法在 $p$ 处给出的局部导子指数。从椭圆曲线的约化类型、判别式以及 Tate 算法中使用的决定极小性和约化性的不变量等基本定义出发，确定在整除 $E$ 判别式的每个素数 $p$ 处的局部 Kodaira 符号，从而计算出每个 $f_{p}$，并由此计算出 $L(E,s)$ 的全局导子 $N$。以整数 $N$ 的形式给出最终答案。", "solution": "问题要求计算由方程 $y^{2} + xy + y = x^{3} - x - 1$ 给出的椭圆曲线 $E/\\mathbb{Q}$ 的 Hasse-Weil $L$-函数的导子 $N$。导子是一个正整数 $N = \\prod_{p} p^{f_{p}}$，其中乘积遍及所有素数 $p$，$f_p$ 是在 $p$ 处的局部导子指数。使得 $f_p > 0$ 的素数是曲线 $E$ 的坏约化素数。这些是 $E$ 的极小判别式的素因子。\n\n首先，我们确定给定的 Weierstrass 模型的系数，其一般形式为 $y^{2} + a_{1}xy + a_{3}y = x^{3} + a_{2}x^{2} + a_{4}x + a_{6}$。\n对于曲线 $E: y^{2} + xy + y = x^{3} - x - 1$，整系数为：\n$a_{1} = 1$\n$a_{2} = 0$\n$a_{3} = 1$\n$a_{4} = -1$\n$a_{6} = -1$\n\n接下来，我们计算与该模型相关的标准不变量。\n$b_{2} = a_{1}^{2} + 4a_{2} = 1^{2} + 4(0) = 1$\n$b_{4} = 2a_{4} + a_{1}a_{3} = 2(-1) + (1)(1) = -1$\n$b_{6} = a_{3}^{2} + 4a_{6} = 1^{2} + 4(-1) = -3$\n$b_{8} = a_{1}^{2}a_{6} + 4a_{2}a_{6} - a_{1}a_{3}a_{4} + a_{2}a_{3}^{2} - a_{4}^{2} = (1)^{2}(-1) + 4(0)(-1) - (1)(1)(-1) + (0)(1)^{2} - (-1)^{2} = -1 + 0 + 1 + 0 - 1 = -1$\n\n模型的判别式 $\\Delta$ 使用这些不变量计算如下：\n$$\n\\Delta = -b_{2}^{2}b_{8} - 8b_{4}^{3} - 27b_{6}^{2} + 9b_{2}b_{4}b_{6}\n$$\n$$\n\\Delta = -(1)^{2}(-1) - 8(-1)^{3} - 27(-3)^{2} + 9(1)(-1)(-3)\n$$\n$$\n\\Delta = 1 - 8(-1) - 27(9) + 27 = 1 + 8 - 243 + 27 = 36 - 243 = -207\n$$\n判别式的素因子分解为 $\\Delta = -3^{2} \\times 23$。\n\n坏约化素数是极小判别式 $\\Delta_{\\text{min}}$ 的素因子。如果一个给定的整系数模型在其判别式的 $p$-adic 赋值 $v_{p}(\\Delta)$ 不能通过容许的变量变换来减小，则该模型在素数 $p$ 处是极小的。在 $p$ 处是极小的一个充分条件是 $v_{p}(\\Delta) < 12$ 或 $v_{p}(c_{4}) < 4$。我们来计算 $c_{4}$：\n$$\nc_{4} = b_{2}^{2} - 24b_{4} = 1^{2} - 24(-1) = 1+24=25 = 5^{2}\n$$\n整除 $\\Delta$ 的素数是 $p=3$ 和 $p=23$。我们检查在这些素数处的极小性。\n对于 $p=3$：$v_{3}(\\Delta) = v_{3}(-3^{2} \\times 23) = 2$。由于 $2 < 12$，该模型在 $p=3$ 处是极小的。\n对于 $p=23$：$v_{23}(\\Delta) = v_{23}(-3^{2} \\times 23) = 1$。由于 $1 < 12$，该模型在 $p=23$ 处是极小的。\n给定的模型在所有素数处都是极小的。因此，极小判别式为 $\\Delta_{\\text{min}} = \\Delta = -207$。坏约化素数是 $p=3$ 和 $p=23$。对于所有其他素数 $p$，曲线具有好约化，因此 $f_{p}=0$。我们现在使用 Tate 算法来确定局部导子指数 $f_{3}$ 和 $f_{23}$。\n\n**在 $p=3$ 处的分析：**\n在素数 $p$ 处的约化类型可以由 $j$-不变量的 $p$-adic 赋值 $j(E) = c_{4}^{3}/\\Delta$ 确定。如果 $v_{p}(j) < 0$，约化是乘法型的。如果 $v_{p}(j) \\geq 0$，约化是加法型的。\n对于 $p=3$：\n$$\nv_{3}(j) = v_{3}\\left(\\frac{c_{4}^{3}}{\\Delta}\\right) = v_{3}(25^{3}) - v_{3}(-207) = v_{3}((5^{2})^{3}) - v_{3}(-3^{2} \\times 23) = 0 - 2 = -2\n$$\n由于 $v_{3}(j) = -2 < 0$，约化是乘法型的。根据 Kodaira 的分类，这对应于某个 $n \\geq 1$ 的 $I_{n}$ 型。根据 Tate 算法，对于乘法型约化，整数 $n$ 由 $n=v_{p}(\\Delta_{\\text{min}})$ 给出。\n在这里，$n = v_{3}(\\Delta_{\\text{min}}) = v_{3}(-207) = 2$。\n因此，在 $p=3$ 处的 Kodaira 符号是 $I_{2}$。\n对于任何乘法型约化（$n \\geq 1$ 的 $I_{n}$ 型），局部导子指数为 $f_{p}=1$。\n因此，$f_{3} = 1$。\n\n根据要求，我们可以用 Tate 算法的初始步骤来证实这一点。模3的约化曲线为 $\\tilde{E}: y^2+xy+y \\equiv x^3-x-1 \\pmod 3$。一个奇点 $(x_0, y_0)$ 满足 $\\frac{\\partial F}{\\partial x} \\equiv y-3x^2+1 \\equiv y+1 \\equiv 0$ 和 $\\frac{\\partial F}{\\partial y} \\equiv 2y+x+1 \\equiv -y+x+1 \\equiv 0$。这给出了唯一的奇点 $(x_0, y_0) = (1, 2) \\in \\mathbb{F}_3 \\times \\mathbb{F}_3$。将奇点平移到 $(0,0)$ 并检查相应的切线方程，可以确认这是一个在 $\\mathbb{F}_3$ 上定义了切线的结点（分裂乘法型约化），这对应于 $I_{n}$ 型。\n\n**在 $p=23$ 处的分析：**\n我们对 $p=23$ 应用相同的分析。\n$$\nv_{23}(j) = v_{23}\\left(\\frac{c_{4}^{3}}{\\Delta}\\right) = v_{23}(25^{3}) - v_{23}(-207) = v_{23}(5^{6}) - v_{23}(-3^{2} \\times 23) = 0 - 1 = -1\n$$\n由于 $v_{23}(j) = -1 < 0$，在 $p=23$ 处的约化也是乘法型的（$I_{n}$ 型）。\n整数 $n$ 是 $n = v_{23}(\\Delta_{\\text{min}}) = v_{23}(-207) = 1$。\n因此，在 $p=23$ 处的 Kodaira 符号是 $I_{1}$。\n对于乘法型约化，局部导子指数为 $f_{p}=1$。\n因此，$f_{23}=1$。\n\n（注：在 $p=23$ 处应用 Tate 算法表明，约化曲线有一个奇点，其坐标位于二次扩张 $\\mathbb{F}_{23^2}$ 中，但不在 $\\mathbb{F}_{23}$ 中。这对应于一个具有非有理切线的结点，即非分裂乘法型约化。然而，分裂与非分裂乘法型约化的区别不改变导子指数，其值仍为 $f_{p}=1$。）\n\n**结论：**\n局部导子指数为 $f_{3}=1$，$f_{23}=1$，对于所有其他素数 $p$ 则为 $f_{p}=0$。\n全局导子 $N$ 是局部导子的乘积：\n$$\nN = \\prod_{p} p^{f_{p}} = 3^{f_{3}} \\times 23^{f_{23}} \\times \\prod_{p \\neq 3, 23} p^{f_{p}} = 3^{1} \\times 23^{1} \\times \\prod_{p \\neq 3, 23} p^{0}\n$$\n$$\nN = 3 \\times 23 = 69\n$$", "answer": "$$\\boxed{69}$$", "id": "3016592"}, {"introduction": "Birch和Swinnerton-Dyer (BSD) 猜想是椭圆曲线算术理论的中心，它深刻地将L函数在 $s=1$ 处的解析行为与曲线的全局算术性质联系起来。这个猜想的公式中包含了多个关键的算术不变量，如Mordell-Weil群的秩、Tate-Shafarevich群的阶以及挠子群的大小。本练习旨在让你通过计算一个椭圆曲线的有理挠子群 $E(\\mathbb{Q})_{\\mathrm{tors}}$，来具体地确定BSD猜想公式中的“挠部分”，从而加深对理论与计算之间联系的理解。[@problem_id:3024978]", "problem": "设 $E / \\mathbb{Q}$ 是由 Weierstrass 方程 $y^{2} + y = x^{3} - x$ 给出的椭圆曲线。仅使用数域上椭圆曲线的基本性质，包括 $E(\\mathbb{Q})$ 的结构定理和在良约化素数下的约化行为，从第一性原理出发，显式地确定其挠子群 $E(\\mathbb{Q})_{\\mathrm{tors}}$。然后，使用 Birch and Swinnerton-Dyer (BSD) 猜想中 $s=1$ 处首项的标准归一化，陈述该首项中出现的此曲线的挠因子 (torsion factor) 的精确数值。将你的最终答案表示为一个单一的数字。无需四舍五入，不涉及单位。", "solution": "用户提出了一个代数数论中的有效问题。该问题具有科学依据、提法恰当且客观。其要求确定一个定义在有理数域上的特定椭圆曲线的挠子群，并随后计算 Birch and Swinnerton-Dyer (BSD) 猜想中一个相关的因子。\n\n解答过程根据问题陈述分为两部分。\n\n### 第一部分：确定挠子群 $E(\\mathbb{Q})_{\\mathrm{tors}}$\n\n椭圆曲线 $E$ 由 Weierstrass 方程 $E: y^{2} + y = x^{3} - x$ 定义在有理数域 $\\mathbb{Q}$ 上。\n\n为了确定挠子群 $E(\\mathbb{Q})_{\\mathrm{tors}}$，我们将使用以下性质：对于 $E$ 的任意一个良约化素数 $p$，存在一个从挠子群到有限域 $\\mathbb{F}_p$ 上约化曲线的点群的单射群同态。\n$$\n\\rho_p: E(\\mathbb{Q})_{\\mathrm{tors}} \\hookrightarrow E(\\mathbb{F}_p)\n$$\n这意味着挠子群的阶 $|E(\\mathbb{Q})_{\\mathrm{tors}}|$ 必须整除 $\\mathbb{F}_p$ 上点群的阶 $|E(\\mathbb{F}_p)|$，这对每一个良约化素数 $p$ 都成立。\n\n首先，我们必须确定哪些是劣约化素数。一个由一般 Weierstrass 方程 $y^2 + a_1xy + a_3y = x^3 + a_2x^2 + a_4x + a_6$ 给出的椭圆曲线，其劣约化素数是整除其判别式 $\\Delta$ 的素数。对于曲线 $E$，其系数为 $a_1=0$、$a_2=0$、$a_3=1$、$a_4=-1$ 和 $a_6=0$。标准不变量计算如下：\n$b_2 = a_1^{2} + 4a_2 = 0$\n$b_4 = 2a_4 + a_1a_3 = 2(-1) + 0 = -2$\n$b_6 = a_3^{2} + 4a_6 = 1^{2} + 0 = 1$\n$b_8 = a_1^2 a_6 + 4a_2 a_6 - a_1 a_3 a_4 + a_2 a_3^2 - a_4^2 = 0 + 0 - 0 + 0 - (-1)^2 = -1$\n于是判别式 $\\Delta$ 为：\n$$\n\\Delta = -b_2^2 b_8 - 8b_4^3 - 27b_6^2 + 9b_2 b_4 b_6 = -0 - 8(-2)^3 - 27(1)^2 + 0 = -8(-8) - 27 = 64 - 27 = 37\n$$\n判别式为 $\\Delta = 37$。因为 37 是一个素数，所以唯一的劣约化素数是 $p=37$。所有其他素数 $p \\neq 37$ 都是良约化素数。\n\n现在，我们计算约化曲线 $E(\\mathbb{F}_p)$ 在小的良约化素数下点的个数。\n\n**情况 1：模 2 约化。**\n$E(\\mathbb{F}_2)$ 的方程为 $y^2 + y = x^3 + x \\pmod 2$。\n在 $\\mathbb{F}_2$ 中，表达式 $z^2+z$ 总是等于 $0$，因为 $0^2+0=0$ 且 $1^2+1=1+1=0$。\n类似地，$z^3+z$ 也总是等于 $0$，因为 $0^3+0=0$ 且 $1^3+1=1+1=0$。\n因此，对于所有 $x, y \\in \\mathbb{F}_2$，方程都变为 $0=0$。\n$x$ 的可能取值是 $0$ 和 $1$。$y$ 的可能取值是 $0$ 和 $1$。\n这给出了 $2 \\times 2 = 4$ 个仿射点：$(0,0), (0,1), (1,0), (1,1)$。\n包括无穷远点 $\\mathcal{O}$，点的总数为 $|E(\\mathbb{F}_2)| = 4 + 1 = 5$。\n根据约化同态，我们断定 $|E(\\mathbb{Q})_{\\mathrm{tors}}|$ 必须整除 $5$。这意味着 $|E(\\mathbb{Q})_{\\mathrm{tors}}|$ 只可能是 $1$ 或 $5$。\n\n**情况 2：模 3 约化。**\n$E(\\mathbb{F}_3)$ 的方程为 $y^2 + y = x^3 - x \\pmod 3$。\n根据 Fermat 小定理，对于所有 $x \\in \\mathbb{F}_3$，有 $x^3 \\equiv x \\pmod 3$。\n因此，对所有 $x \\in \\{0, 1, 2\\}$，方程的右边是 $x^3 - x \\equiv x - x \\equiv 0 \\pmod 3$。\n方程简化为 $y^2 + y = 0 \\pmod 3$，可以因式分解为 $y(y+1) = 0$。\n$y$ 的解为 $y=0$ 和 $y=-1 \\equiv 2 \\pmod 3$。\n对于 $x$ 的每个可能取值（$0, 1, 2$），$y$ 都有 $2$ 个可能取值（$0, 2$）。\n这给出了 $3 \\times 2 = 6$ 个仿射点。\n包括无穷远点 $\\mathcal{O}$，点的总数为 $|E(\\mathbb{F}_3)| = 6 + 1 = 7$。\n根据约化同态，我们断定 $|E(\\mathbb{Q})_{\\mathrm{tors}}|$ 必须整除 $7$。这意味着 $|E(\\mathbb{Q})_{\\mathrm{tors}}|$ 只可能是 $1$ 或 $7$。\n\n结合以上结果， $|E(\\mathbb{Q})_{\\mathrm{tors}}|$ 必须同时整除 $5$ 和 $7$。因为 $5$ 和 $7$ 的最大公约数是 $1$，我们有：\n$$\n|E(\\mathbb{Q})_{\\mathrm{tors}}| \\text{ 整除 } \\gcd(5, 7) = 1\n$$\n这迫使 $|E(\\mathbb{Q})_{\\mathrm{tors}}| = 1$。唯一的挠点是无穷远点，所以 $E(\\mathbb{Q})_{\\mathrm{tors}} = \\{\\mathcal{O}\\}$。\n\n### 第二部分：BSD 猜想中的挠因子\n\n精确形式的 Birch and Swinnerton-Dyer (BSD) 猜想关系到椭圆曲线 $E$ 的 Hasse-Weil L-函数 $L(E,s)$ 在 $s=1$ 点的泰勒展开的首项。如果 Mordell-Weil 群 $E(\\mathbb{Q})$ 的秩为 $r$，则该猜想表明：\n$$\n\\lim_{s \\to 1} \\frac{L(E, s)}{(s-1)^r} = \\frac{\\Omega_E \\cdot \\mathrm{Reg}(E/\\mathbb{Q}) \\cdot |\\Sha(E/\\mathbb{Q})| \\cdot \\prod_{p} c_p}{|E(\\mathbb{Q})_{\\mathrm{tors}}|^2}\n$$\n公式中的各项代表了曲线的各种算术不变量：$\\Omega_E$ 是实周期，$\\mathrm{Reg}(E/\\mathbb{Q})$ 是 regulator，$|\\Sha(E/\\mathbb{Q})|$ 是 Tate-Shafarevich 群的阶，而 $c_p$ 是 Tamagawa 数。\n\n问题要求的是这个首项中出现的“挠因子”。在分子中各项采用标准归一化的情况下，这个因子是分母中出现的项 $|E(\\mathbb{Q})_{\\mathrm{tors}}|^2$。问题要求给出该曲线这个因子的精确数值。\n\n根据第一部分的结论，我们确定了 $|E(\\mathbb{Q})_{\\mathrm{tors}}| = 1$。\n代入此值，挠因子为：\n$$\n|E(\\mathbb{Q})_{\\mathrm{tors}}|^2 = 1^2 = 1\n$$\n挠因子的数值是 $1$。", "answer": "$$\\boxed{1}$$", "id": "3024978"}]}