{"hands_on_practices": [{"introduction": "泰特-沙法列维奇群（Tate-Shafarevich group）$\\Sha(E/\\mathbb{Q})$ 从根本上衡量了哈斯原则（Hasse principle）的失效程度，即一个代数簇在所有局部域（$\\mathbb{Q}_v$）上都有点，是否保证其在全局域（$\\mathbb{Q}$）上也有点。这项实践通过一个计算实验，让我们直接见证这种失效。通过编写程序来检验亏格为1的曲线是否处处局部可解，并与寻找全局有理点的结果进行对比，你将对那些代表$\\Sha$的非平凡元的曲线建立起直观的认识——它们正是在每个$\\mathbb{Q}$的完备化上都有点，但却不存在有理点的“反例”。", "problem": "设 $E/\\mathbb{Q}$ 为一条椭圆曲线，Tate-Shafarevich 群（通常用希腊字母 $\\Sha$ 表示）是由 $E$ 上的主齐性空间的同构类组成的群，这些主齐性空间在 $\\mathbb{Q}$ 的所有完备化上都是局部平凡的。$E$ 的一个主齐性空间 $C$ 是定义在 $\\mathbb{Q}$ 上的一条光滑、射影、几何整的曲线，其上有一个定义在 $\\mathbb{Q}$ 上的 $E$ 的单正则作用。根据定义，$\\Sha(E/\\mathbb{Q})$ 中的一个元素 $[C]$ 由一条曲线 $C$ 代表，该曲线在 $\\mathbb{Q}$ 的每个完备化 $\\mathbb{Q}_v$ 上都有点（即对所有位 $v$都有 $C(\\mathbb{Q}_v) \\neq \\emptyset$），但在 $\\mathbb{Q}$ 上没有有理点。\n\n此问题要求您通过实验和数值方法，研究一个在下降计算中自然出现的小型亏格为 1 曲线族，探讨其局部可解性和有理可解性：\n- 形如 $a x^3 + b y^3 + c z^3 = 0$ 的对角三次挠子，当 $a,b,c \\in \\mathbb{Z}$ 为非零且经适当选择时，它们是光滑平面三次曲线。\n- 形如 $u^2 = d x^4 + e x^2 + f$ 的二元四次挠子，当右侧的四次多项式在 $\\overline{\\mathbb{Q}}$ 上有不同的根时，它们是光滑射影亏格为 1 的曲线。\n\n您的程序必须实现以下基于原理的实验流程：\n1. 基本定义和准则：\n   - 局部域和局部点：对于 $\\mathbb{Q}$ 的一个位 $v$，如果 $C(\\mathbb{Q}_v) \\neq \\emptyset$，则称曲线 $C$ 在 $v$ 处是局部可解的。其中 $\\mathbb{Q}_\\infty = \\mathbb{R}$，对于素数 $p$，$\\mathbb{Q}_p$ 是 $p$-进数域。\n   - 通过同余检验局部可解性：$C(\\mathbb{Q}_p) \\neq \\emptyset$ 的一个必要条件是，对于所有 $n$，都存在模 $p^n$ 的解；一个充分条件是，存在一个模 $p$ 的非奇异解，该解可通过 Hensel 引理提升为 $\\mathbb{Q}_p$ 上的解。在数值实验中，检验在有限素数集上模 $p$ 和 $p^2$ 的解，可为局部可解性提供有力证据。\n   - 实数域上的可解性：对于对角三次曲线 $a x^3 + b y^3 + c z^3 = 0$，当至少有两个系数非零时，利用立方的奇次幂性质，通过符号抵消来展示实数解。对于二元四次曲线 $u^2 = d x^4 + e x^2 + f$，分析实多项式 $g(x) = d x^4 + e x^2 + f$。如果 $d > 0$，则当 $|x| \\to \\infty$ 时 $g(x) \\to +\\infty$，因此 $g$ 可以取到任意大的正值，从而 $C(\\mathbb{R}) \\neq \\emptyset$。如果 $d < 0$，则 $g$ 有一个有限的上确界；通过 $g'(x) = 4 d x^3 + 2 e x$ 计算 $g(x)$ 的临界点来求得上确界。如果 $\\sup_{x \\in \\mathbb{R}} g(x) < 0$，则 $C(\\mathbb{R}) = \\emptyset$。\n   - 有理可解性：$a x^3 + b y^3 + c z^3 = 0$ 上的一个有理点在缩放意义下对应于一个非平凡整数解 $(x,y,z) \\in \\mathbb{Z}^3 \\setminus \\{(0,0,0)\\}$。对于 $u^2 = d x^4 + e x^2 + f$，一个有理点对应于满足 $u^2 = d x^4 + e x^2 + f$ 的整数对 $(x,u)$。\n\n2. 对每个输入曲线 $C$ 的算法任务：\n   - 实位测试：实现上述 $C(\\mathbb{R}) \\neq \\emptyset$ 的准则。如果 $C(\\mathbb{R}) = \\emptyset$，则 $C$ 不是处处局部可解的；立即将这种情况归类为不在 $\\Sha$ 中。\n   - 有限位测试：对于指定有限集中的每个素数 $p$，测试是否存在模 $p$ 和模 $p^2$ 的解。\n     - 对于模 $p^n$ 的 $a x^3 + b y^3 + c z^3 = 0$，通过枚举 $x,y$ 来构建余数集 $a x^3 + b y^3 \\pmod{p^n}$，并检查对于某个 $z$，$-c z^3$ 是否属于该集合。记录任何解，并通过验证梯度 $$(3 a x^2, 3 b y^2, 3 c z^2) \\not\\equiv (0,0,0) \\pmod{p}$$ 来检查解在模 $p$ 意义下的非奇异性。如果存在模 $p$ 的非奇异解，则可推断在 $\\mathbb{Q}_p$ 上是局部可解的；否则，在实践中，也接受存在模 $p^2$ 的解作为支持局部可解性的证据。\n     - 对于模 $p^n$ 的 $u^2 = d x^4 + e x^2 + f$，枚举 $x$ 并检查 $d x^4 + e x^2 + f$ 是否是模 $p^n$ 的平方数。为检验模 $p$ 的非奇异性，验证 $$(2 u, - (4 d x^3 + 2 e x)) \\not\\equiv (0,0) \\pmod{p}$$。同上，接受模 $p^2$ 的解作为局部可解性的实验证据。\n   - 有理点搜索：对小的整数解进行有界穷举搜索：\n     - 对于对角三次曲线，在 $|x|,|y|,|z| \\leq B$ 的范围内搜索 $(x,y,z)$（排除 $(0,0,0)$），并检查 $a x^3 + b y^3 + c z^3 = 0$ 是否成立。\n     - 对于四次曲线，在 $|x|,|u| \\leq B$ 的范围内搜索 $(x,u)$，并检查 $u^2 = d x^4 + e x^2 + f$ 是否成立。\n     - 如果找到这样的解，则记录为有理可解。\n\n3. 分类规则：\n   - 如果在任何被测试的位（包括实位）上局部可解性失败，则输出 $0$。\n   - 如果（在给定边界内）找到一个有理点，证明其是全局可解的，则输出 $1$。\n   - 如果曲线在所有被测试的位上都是局部可解的，但在给定边界内未找到有理点，则输出 $2$。这个结果将曲线标识为实验性的 $\\Sha$ “候选”元素，并承认这只是数值证据而非证明。\n\n您必须为以下旨在检验不同行为的测试套件实现此算法：\n- 测试用例 1 (对角三次曲线，易于找到有理点)：$a=1$, $b=1$, $c=-1$；搜索边界 $B=60$；素数集 $\\{2,3,5,7,11\\}$。\n- 测试用例 2 (对角三次曲线，经典的局部可解挠子)：$a=3$, $b=4$, $c=5$ (Selmer 三次曲线)；搜索边界 $B=120$；素数集 $\\{2,3,5,7,11\\}$。\n- 测试用例 3 (二元四次曲线，实数域上的障碍)：$d=-1$, $e=0$, $f=-1$；搜索边界 $B=80$；素数集 $\\{2,3,5,7,11\\}$。\n- 测试用例 4 (二元四次曲线，有明显的有理点)：$d=1$, $e=-5$, $f=4$；搜索边界 $B=80$；素数集 $\\{2,3,5,7,11\\}$。\n\n最终输出规范：\n您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表的结果（例如，\"[result1,result2,result3,result4]\"）。每个结果必须是 $\\{0,1,2\\}$ 中的一个整数，遵循上述分类规则。不适用任何物理单位或角度单位，所有数值都是无量纲的。", "solution": "该问题要求设计一个实验性流程，根据两种特定形式（对角三次曲线和二元四次曲线）的亏格为 1 的曲线在实数域、p-进数域和有理数域上的可解性性质对其进行分类。此分类可作为一种数值模拟，用于判断一条曲线是代表 Tate-Shafarevich 群（$\\Sha$）中的平凡元素、非平凡元素，还是因局部不可解而无法成为 $\\Sha$ 中的元素。\n\n如果一条曲线 $C$ 在每个完备化 $\\mathbb{Q}_v$ 中都有点（即*局部可解*），但在 $\\mathbb{Q}$ 中没有点（即不是*全局可解*），那么它就代表了 $\\Sha(E/\\mathbb{Q})$ 中的一个元素。我们的任务是实现一个算法来测试给定曲线集的这些性质，并返回一个分类结果：\n- $0$：曲线在某个被测试的位（实数位或 p-进数位）上不是局部可解的。\n- $1$：曲线是全局可解的（找到了一个有理点）。\n- $2$：曲线在所有被测试的位上似乎都是局部可解的，但在指定的搜索边界内没有找到有理点。这标识了非平凡 $\\Sha$ 元素的实验性候选。\n\n该算法通过为所提供的两种曲线类型创建不同的处理流程来实现。\n\n### 对角三次曲线：$ax^3 + by^3 + cz^3 = 0$\n\n1.  **实数域上的可解性测试 ($C(\\mathbb{R}) \\neq \\emptyset$)**：对于非零整数系数 $a$、$b$ 和 $c$，方程 $ax^3 + by^3 + cz^3 = 0$ 总是存在非平凡的实数解。这是因为函数 $f(t) = t^3$ 是从 $\\mathbb{R}$ 到 $\\mathbb{R}$ 的满射。例如，可以固定 $y$ 和 $z$ 的非零实数值，比如 $y_0$ 和 $z_0$，然后通过 $x = \\sqrt[3]{(-by_0^3 - cz_0^3)/a}$ 求解 $x$，这总是一个定义明确的实数。因此，这些曲线总是在 $\\mathbb{R}$ 上可解。\n\n2.  **p-进数域上的可解性测试 ($C(\\mathbb{Q}_p) \\neq \\emptyset$)**：对于给定集合中的每个素数 $p$，我们测试其局部可解性。根据 Hensel 引理，一个模 $p$ 的*非奇异*解的存在性保证了在 $\\mathbb{Q}_p$ 中存在解。一个点 $(x_0, y_0, z_0)$ 是模 $p$ 非奇异的，如果其梯度向量 $(\\frac{\\partial F}{\\partial x}, \\frac{\\partial F}{\\partial y}, \\frac{\\partial F}{\\partial z}) = (3ax^2, 3by^2, 3cz^2)$ 在该点不与 $(0,0,0) \\pmod{p}$ 全等。如果所有模 $p$ 的解都是奇异的（这对于整除 $3abc$ 的素数 $p$ 会系统性地发生），我们便将任何非平凡的模 $p^2$ 解的存在性视为 $\\mathbb{Q}_p$ 中可解性的强数值证据。我们通过迭代 $x$ 和 $y$ 并使用哈希表来寻找对应的 $z$，从而优化模数解的搜索。\n\n3.  **有理可解性测试 ($C(\\mathbb{Q}) \\neq \\emptyset$)**：我们在有界范围内搜索满足 $ax^3 + by^3 + cz^3 = 0$ 的非平凡整数解 $(x,y,z) \\in \\mathbb{Z}^3 \\setminus \\{(0,0,0)\\}$，其中 $|x|, |y|, |z| \\leq B$。该搜索通过在边界 $[-B, B]$ 内迭代整数值 $x$ 和 $y$ 来实现，然后计算所需的值 $cz^3 = -(ax^3+by^3)$。如果该值能被 $c$ 整除，且结果是一个完全立方数 $z^3$，其中 $|z| \\leq B$，则找到了一个有理点。\n\n### 二元四次曲线：$u^2 = dx^4 + ex^2 + f$\n\n1.  **实数域上的可解性测试 ($C(\\mathbb{R}) \\neq \\emptyset$)**：当且仅当对于某个 $x \\in \\mathbb{R}$，多项式 $g(x) = dx^4 + ex^2 + f$ 的值为非负时，存在实数解。\n    - 如果 $d > 0$，当 $|x| \\to \\infty$ 时，$g(x) \\to +\\infty$，这保证了 $g(x)$ 会取到非负值。曲线在 $\\mathbb{R}$ 上是可解的。\n    - 如果 $d < 0$，当 $|x| \\to \\infty$ 时，$g(x) \\to -\\infty$。仅当 $g(x)$ 的全局最大值非负时，才存在实数解。我们通过检查 $g'(x) = 4dx^3 + 2ex = 0$ 的临界点来找到最大值。这发生在 $x=0$ 以及（如果 $-e/(2d) > 0$）$x = \\pm\\sqrt{-e/(2d)}$ 处。如果 $\\sup_{x \\in \\mathbb{R}} g(x) < 0$，则曲线在 $\\mathbb{R}$ 上不可解。\n\n2.  **p-进数域上的可解性测试 ($C(\\mathbb{Q}_p) \\neq \\emptyset$)**：原理与三次曲线相同。一个模 $p$ 的解 $(u_0, x_0)$ 是非奇异的，如果其梯度向量 $(\\frac{\\partial F}{\\partial u}, \\frac{\\partial F}{\\partial x}) = (2u, -(4dx^3 + 2ex))$ 在该点不与 $(0,0) \\pmod{p}$ 全等。我们搜索这样的点。如果只找到奇异解，则检查是否存在任何模 $p^2$ 的解。搜索过程包括迭代 $x \\pmod{p^n}$，并检查 $dx^4+ex^2+f$ 是否是模 $p^n$ 的二次剩余。\n\n3.  **有理可解性测试 ($C(\\mathbb{Q}) \\neq \\emptyset$)**：我们在边界 $B$ 内搜索整数解 $(x, u)$。由于 $x$ 仅以偶数次幂出现，我们只需搜索 $x \\in [0, B]$。对于每个 $x$，我们计算 $v = dx^4 + ex^2 + f$。如果 $v \\geq 0$ 且是一个完全平方数（比如 $v=u^2$），并且 $|u| \\leq B$，则找到了一个有理点。\n\n通过根据指定的分类规则组合这些测试，我们可以分析测试套件中的每条曲线。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef get_cbrt_if_int(n):\n    \"\"\"\n    Returns the integer cube root of n if it exists, otherwise None.\n    \"\"\"\n    if n == 0:\n        return 0\n    # np.cbrt handles signs correctly.\n    root = np.cbrt(n)\n    # Check if the root is an integer within a small tolerance for float inaccuracies.\n    i_root = int(round(root))\n    if i_root**3 == n:\n        return i_root\n    return None\n\ndef classify_cubic(a, b, c, B, primes):\n    \"\"\"\n    Classifies a diagonal cubic curve.\n    Returns 0 (local obstruction), 1 (rational point found), or 2 (candidate).\n    \"\"\"\n    # Step 1: Real Place Test\n    # For a*x^3 + b*y^3 + c*z^3 = 0, with a,b,c non-zero, a non-trivial\n    # real solution always exists. So, this test always passes.\n\n    # Step 2: Finite Place (p-adic) Tests\n    for p in primes:\n        is_locally_soluble_at_p = False\n        \n        # Test for a non-singular solution modulo p\n        cz3_map = { (c * pow(z, 3, p)) % p: z for z in range(p - 1, -1, -1) }\n        found_nonsingular_sol = False\n        for x in range(p):\n            for y in range(p):\n                target = (-a * pow(x, 3, p) - b * pow(y, 3, p)) % p\n                if target in cz3_map:\n                    z = cz3_map[target]\n                    if x != 0 or y != 0 or z != 0:\n                        # Gradient is (3ax^2, 3by^2, 3cz^2)\n                        grad_x = (3 * a * pow(x, 2, p)) % p\n                        grad_y = (3 * b * pow(y, 2, p)) % p\n                        grad_z = (3 * c * pow(z, 2, p)) % p\n                        if grad_x != 0 or grad_y != 0 or grad_z != 0:\n                            is_locally_soluble_at_p = True\n                            found_nonsingular_sol = True\n                            break\n            if found_nonsingular_sol:\n                break\n        \n        if not is_locally_soluble_at_p:\n            # If no non-singular solution mod p, test for any non-trivial solution mod p^2\n            M = p * p\n            cz3_map_p2 = { (c * pow(z, 3, M)) % M: z for z in range(M - 1, -1, -1) }\n            found_p2_sol = False\n            for x in range(M):\n                for y in range(M):\n                    target = (-a * pow(x, 3, M) - b * pow(y, 3, M)) % M\n                    if target in cz3_map_p2:\n                        z = cz3_map_p2[target]\n                        if x != 0 or y != 0 or z != 0:\n                            is_locally_soluble_at_p = True\n                            found_p2_sol = True\n                            break\n                if found_p2_sol:\n                    break\n\n        if not is_locally_soluble_at_p:\n            return 0 # Fails local solubility test at p\n\n    # Step 3: Rational Point Search\n    for x in range(-B, B + 1):\n        for y in range(-B, B + 1):\n            target_val = -a * x**3 - b * y**3\n            if c != 0 and target_val % c == 0:\n                z3_cand = target_val // c\n                z = get_cbrt_if_int(z3_cand)\n                if z is not None and abs(z) = B:\n                    if x != 0 or y != 0 or z != 0:\n                        return 1 # Found a rational point\n\n    return 2 # Locally soluble, no rational point found\n\ndef classify_quartic(d, e, f, B, primes):\n    \"\"\"\n    Classifies a binary quartic curve.\n    Returns 0 (local obstruction), 1 (rational point found), or 2 (candidate).\n    \"\"\"\n    # Step 1: Real Place Test\n    # Let g(x) = d*x^4 + e*x^2 + f.\n    if d > 0:\n        pass # g(x) -> +inf as |x| -> inf, so real solution exists.\n    else: # d = 0\n        if d == 0: # Not in test suite but handle for completeness\n            if e = 0 and f  0: return 0\n        else: # d  0\n            # g(x) -> -inf. Check supremum. g'(x) = 2x(2dx^2 + e).\n            max_g = float(f) # Value at x=0\n            if -e / (2 * d) > 0:\n                x_sq_crit = -e / (2 * d)\n                g_crit = d * x_sq_crit**2 + e * x_sq_crit + f\n                max_g = max(max_g, g_crit)\n            if max_g  0:\n                return 0 # No real solution\n    \n    # Step 2: Finite Place (p-adic) Tests\n    for p in primes:\n        is_locally_soluble_at_p = False\n\n        # Test for a non-singular solution modulo p\n        mod_sqrt_map = {pow(u, 2, p): u for u in range(p)}\n        found_nonsingular_sol = False\n        for x in range(p):\n            rhs = (d * pow(x, 4, p) + e * pow(x, 2, p) + f) % p\n            if rhs in mod_sqrt_map:\n                u = mod_sqrt_map[rhs]\n                # Gradient is (2u, -(4dx^3+2ex))\n                # Check point (u, x)\n                grad_x = (- (4 * d * pow(x, 3, p) + 2 * e * x)) % p\n                if (2 * u) % p != 0 or grad_x != 0:\n                    is_locally_soluble_at_p = True\n                    found_nonsingular_sol = True\n                    break\n                # Check point (-u, x) if first was singular (must be u=0)\n                if u == 0 and grad_x != 0: # This case is covered above but makes logic clear\n                    is_locally_soluble_at_p = True\n                    found_nonsingular_sol = True\n                    break\n        if not found_nonsingular_sol:\n            # Test for any solution mod p^2\n            M = p * p\n            squares_p2 = {pow(i, 2, M) for i in range(M)}\n            for x in range(M):\n                rhs = (d * pow(x, 4, M) + e * pow(x, 2, M) + f) % M\n                if rhs in squares_p2:\n                    is_locally_soluble_at_p = True\n                    break\n        \n        if not is_locally_soluble_at_p:\n            return 0 # Fails local solubility test at p\n\n    # Step 3: Rational Point Search\n    for x in range(B + 1):\n        val = d * x**4 + e * x**2 + f\n        if val >= 0:\n            # Use floating point sqrt and check if it's an integer\n            u_cand = np.sqrt(val)\n            if u_cand == int(u_cand):\n                u = int(u_cand)\n                if u = B:\n                    return 1 # Found a rational point\n\n    return 2 # Locally soluble, no rational point found\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis on the test suite.\n    \"\"\"\n    test_cases = [\n        {'type': 'cubic', 'a': 1, 'b': 1, 'c': -1, 'B': 60, 'primes': [2, 3, 5, 7, 11]},\n        {'type': 'cubic', 'a': 3, 'b': 4, 'c': 5, 'B': 120, 'primes': [2, 3, 5, 7, 11]},\n        {'type': 'quartic', 'd': -1, 'e': 0, 'f': -1, 'B': 80, 'primes': [2, 3, 5, 7, 11]},\n        {'type': 'quartic', 'd': 1, 'e': -5, 'f': 4, 'B': 80, 'primes': [2, 3, 5, 7, 11]},\n    ]\n\n    results = []\n    for case in test_cases:\n        if case['type'] == 'cubic':\n            result = classify_cubic(case['a'], case['b'], case['c'], case['B'], case['primes'])\n        else: # quartic\n            result = classify_quartic(case['d'], case['e'], case['f'], case['B'], case['primes'])\n        results.append(result)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "3029554"}, {"introduction": "虽然寻找$\\Sha$群的单个元素有助于理解其定义，但数论学家的目标是理解其整体结构，而这始于确定它的大小。本练习将介绍实现此目标的主要代数工具：下降理论（descent theory）。我们将运用一个基本的短正合列，它将 Mordell-Weil 群、塞尔默群（Selmer group）和泰特-沙法列维奇群联系在一起，从而使我们能够从相对更容易计算的塞尔默群出发，精确地计算出$\\Sha$群的$n$-挠部分$\\Sha(E/\\mathbb{Q})[n]$的大小。", "problem": "设 $E/\\mathbb{Q}$ 为一条椭圆曲线，并令 $\\Sha(E/\\mathbb{Q})$ 表示其 Tate–Shafarevich 群 ($\\Sha$)。对于一个正整数 $n$，$n$-Selmer 群 $\\mathrm{Sel}^{(n)}(E/\\mathbb{Q})$ 被定义为 Galois 上同调群 $H^{1}(\\mathbb{Q},E[n])$ 的一个子群，该子群由对 $\\mathbb{Q}$ 的所有位 $v$ 都在 Kummer 映射 $E(\\mathbb{Q}_{v})/nE(\\mathbb{Q}_{v}) \\to H^{1}(\\mathbb{Q}_{v},E[n])$ 的像中处处局部的类组成。从 $\\mathbb{Q}$ 上的群概形的 Kummer 精确序列出发，\n$$\n0 \\longrightarrow E[n] \\longrightarrow E \\xrightarrow{[n]} E \\longrightarrow 0,\n$$\n并应用 Galois 上同调以及整体到局部的比较，可得到以下精确序列\n$$\n0 \\longrightarrow E(\\mathbb{Q})/nE(\\mathbb{Q}) \\longrightarrow \\mathrm{Sel}^{(n)}(E/\\mathbb{Q}) \\longrightarrow \\Sha(E/\\mathbb{Q})[n] \\longrightarrow 0,\n$$\n其中 $\\Sha(E/\\mathbb{Q})[n]$ 表示 $\\Sha(E/\\mathbb{Q})$ 的 $n$-挠子群。\n\n假设 $E/\\mathbb{Q}$ 的以下算术不变量由显式下降计算确定：\n- Mordell–Weil 群 $E(\\mathbb{Q})$ 的秩 $r=0$，其挠子群为 $E(\\mathbb{Q})_{\\mathrm{tors}} \\simeq (\\mathbb{Z}/2\\mathbb{Z})^{2}$，因此 $|E(\\mathbb{Q})_{\\mathrm{tors}}|=4$，且挠子群中的元素乘以 2 后都为 0。\n- 一次完全二次下降得出 $|\\mathrm{Sel}^{(2)}(E/\\mathbb{Q})|=2^{5}$。\n- 一次完全四次下降得出 $|\\mathrm{Sel}^{(4)}(E/\\mathbb{Q})|=2^{7}$。\n\n仅使用上述基本定义及其推论，确定 $2$-挠子群 $\\Sha(E/\\mathbb{Q})[2]$ 的确切基数。将您的最终结果表示为一个精确整数（不需要或不允许四舍五入）。", "solution": "问题要求计算给定椭圆曲线 $E/\\mathbb{Q}$ 的 Tate-Shafarevich 群的 $2$-挠子群 $\\Sha(E/\\mathbb{Q})[2]$ 的基数。解题过程通过分析连接 Mordell-Weil 群、Selmer 群和 Tate-Shafarevich 群的基本短精确序列来进行。\n\n问题提供了从 Galois 上同调导出的以下短精确序列：\n$$\n0 \\longrightarrow E(\\mathbb{Q})/nE(\\mathbb{Q}) \\longrightarrow \\mathrm{Sel}^{(n)}(E/\\mathbb{Q}) \\longrightarrow \\Sha(E/\\mathbb{Q})[n] \\longrightarrow 0\n$$\n该序列对任何正整数 $n$ 都成立。由于此序列中的所有群都是有限阿贝尔群，我们可以关联它们的阶。序列的精确性意味着中间群的阶是两端群的阶的乘积：\n$$\n|\\mathrm{Sel}^{(n)}(E/\\mathbb{Q})| = |E(\\mathbb{Q})/nE(\\mathbb{Q})| \\cdot |\\Sha(E/\\mathbb{Q})[n]|\n$$\n我们关心的是 $n=2$ 的情况。方程变为：\n$$\n|\\mathrm{Sel}^{(2)}(E/\\mathbb{Q})| = |E(\\mathbb{Q})/2E(\\mathbb{Q})| \\cdot |\\Sha(E/\\mathbb{Q})[2]|\n$$\n我们可以重新整理该方程以求解所求量 $|\\Sha(E/\\mathbb{Q})[2]|$：\n$$\n|\\Sha(E/\\mathbb{Q})[2]| = \\frac{|\\mathrm{Sel}^{(2)}(E/\\mathbb{Q})|}{|E(\\mathbb{Q})/2E(\\mathbb{Q})|}\n$$\n问题提供了 $2$-Selmer 群的大小：$|\\mathrm{Sel}^{(2)}(E/\\mathbb{Q})| = 2^5 = 32$。\n\n下一步是确定群 $E(\\mathbb{Q})/2E(\\mathbb{Q})$ 的阶。我们已知 Mordell-Weil 群 $E(\\mathbb{Q})$ 的结构。其秩为 $r=0$，其挠子群为 $E(\\mathbb{Q})_{\\mathrm{tors}} \\simeq (\\mathbb{Z}/2\\mathbb{Z})^2$。\nMordell-Weil 群的一般结构是 $E(\\mathbb{Q}) \\simeq \\mathbb{Z}^r \\oplus E(\\mathbb{Q})_{\\mathrm{tors}}$。由于秩 $r=0$，该群仅由其挠点组成：\n$$\nE(\\mathbb{Q}) = E(\\mathbb{Q})_{\\mathrm{tors}} \\simeq (\\mathbb{Z}/2\\mathbb{Z})^2\n$$\n这是一个阶为 $|(\\mathbb{Z}/2\\mathbb{Z})^2| = 4$ 的有限群。\n为求商群 $E(\\mathbb{Q})/2E(\\mathbb{Q})$ 的阶，我们首先确定子群 $2E(\\mathbb{Q})$，它是 $E(\\mathbb{Q})$ 在乘以 2 映射下的像。由于每个元素 $P \\in E(\\mathbb{Q})$ 的阶都整除 $2$，我们有对所有 $P \\in E(\\mathbb{Q})$ 都有 $2P=O$，其中 $O$ 是单位元（无穷远点）。因此，此映射的像是平凡群：\n$$\n2E(\\mathbb{Q}) = \\{O\\}\n$$\n于是商群为：\n$$\nE(\\mathbb{Q})/2E(\\mathbb{Q}) = E(\\mathbb{Q})/\\{O\\} \\simeq E(\\mathbb{Q})\n$$\n因此该群的阶为：\n$$\n|E(\\mathbb{Q})/2E(\\mathbb{Q})| = |E(\\mathbb{Q})| = |(\\mathbb{Z}/2\\mathbb{Z})^2| = 4 = 2^2\n$$\n现在我们有了计算 $\\Sha(E/\\mathbb{Q})[2]$ 的阶所需的所有要素：\n$$\n|\\Sha(E/\\mathbb{Q})[2]| = \\frac{|\\mathrm{Sel}^{(2)}(E/\\mathbb{Q})|}{|E(\\mathbb{Q})/2E(\\mathbb{Q})|} = \\frac{2^5}{2^2} = 2^{5-2} = 2^3 = 8\n$$\n问题还提供了 $4$-Selmer 群的大小，$|\\mathrm{Sel}^{(4)}(E/\\mathbb{Q})|=2^7$。虽然这对上述计算并非严格必要，但该信息可用于验证算术数据的一致性。对 $n=4$ 使用相同的逻辑：\n$$\n|\\Sha(E/\\mathbb{Q})[4]| = \\frac{|\\mathrm{Sel}^{(4)}(E/\\mathbb{Q})|}{|E(\\mathbb{Q})/4E(\\mathbb{Q})|}\n$$\n群 $4E(\\mathbb{Q})$ 是 $E(\\mathbb{Q})$ 在乘以 4 映射下的像。由于对所有 $P \\in E(\\mathbb{Q})$ 都有 $2P=O$，可推出 $4P=2(2P)=2(O)=O$。因此，$4E(\\mathbb{Q}) = \\{O\\}$，所以 $|E(\\mathbb{Q})/4E(\\mathbb{Q})|=|E(\\mathbb{Q})|=4=2^2$。\n这得出了 Tate-Shafarevich 群的 $4$-挠子群的大小：\n$$\n|\\Sha(E/\\mathbb{Q})[4]| = \\frac{2^7}{2^2} = 2^5 = 32\n$$\n对于任何有限阿贝尔群 $A$，其 $4$-挠子群 $A[4]$ 和 $2$-挠子群 $A[2]$ 是相关的。如果 $A[4]$ 的结构为 $(\\mathbb{Z}/4\\mathbb{Z})^a \\oplus (\\mathbb{Z}/2\\mathbb{Z})^b$，那么它的阶为 $4^a 2^b = 2^{2a+b}$。其 $2$-挠子群 $A[2]$ 同构于 $(\\mathbb{Z}/2\\mathbb{Z})^{a+b}$，阶为 $2^{a+b}$。\n将此应用于 $A=\\Sha(E/\\mathbb{Q})$，我们有：\n$|\\Sha(E/\\mathbb{Q})[4]| = 2^{2a+b} = 32 = 2^5$，所以 $2a+b=5$。\n$|\\Sha(E/\\mathbb{Q})[2]| = 2^{a+b} = 8 = 2^3$，所以 $a+b=3$。\n解这个线性方程组得到 $a=2$ 和 $b=1$。这意味着 $4$-挠子群的结构是 $\\Sha(E/\\mathbb{Q})[4] \\simeq (\\mathbb{Z}/4\\mathbb{Z})^2 \\oplus \\mathbb{Z}/2\\mathbb{Z}$。这是一个一致的结果，为计算增添了进一步的可信度。然而，主要的计算只需要 $n=2$ 的数据。\n\n所确定的 $2$-挠子群的基数是 $8$。", "answer": "$$\\boxed{8}$$", "id": "3029567"}, {"introduction": "著名的贝赫和斯温纳顿-戴尔（Birch and Swinnerton-Dyer, BSD）猜想在$\\Sha$群的代数大小与曲线的$L$-函数的解析行为之间建立了一座宏伟的桥梁。本题旨在对一个已知猜想成立的特例进行验证计算。你需要综合运用多个核心概念——包括通过泰特算法（Tate's algorithm）确定坏素数处的约化类型和计算玉河数（Tamagawa number）$c_p$——来验证BSD公式，并亲眼见证$|\\Sha|$是如何作为关键成分，完美地平衡了方程的解析端与代数端。", "problem": "设 $E/\\mathbb{Q}$ 是由以下最小 Weierstrass 方程给出的椭圆曲线\n$$\ny^{2}+y \\;=\\; x^{3}-x^{2}-10x-20.\n$$\n该曲线是导子为 $11$ 的强 Weil 曲线。请从椭圆曲线、其 Néron 模型和在局部域 $\\mathbb{Q}_{p}$ 上的 Tate 算法的基本定义出发，从概念上解释如何确定在素数 $p$ 处的 Tamagawa 数 $c_{p}$。然后将此框架应用于上述曲线 $E$ 的特定素数 $p=11$，通过 Tate 算法提取 $c_{11}$。最后，将此 Tamagawa 数用于 Birch 与 Swinnerton-Dyer (BSD) 猜想的验证，具体如下：已知（您应假设）$E(\\mathbb{Q})$ 的秩为 $0$，挠子群 $E(\\mathbb{Q})_{\\mathrm{tors}}$ 的阶为 $5$，且 Tate–Shafarevich 群 $\\Sha(E/\\mathbb{Q})$ 是阶为 $1$ 的有限群。在这些假设下，Birch 与 Swinnerton-Dyer (BSD) 猜想预测\n$$\n\\frac{L(E,1)}{\\Omega_{E}} \\;=\\; \\frac{|\\Sha(E/\\mathbb{Q})| \\cdot \\prod_{p} c_{p}}{|E(\\mathbb{Q})_{\\mathrm{tors}}|^{2}},\n$$\n其中 $L(E,s)$ 是 $E$ 的 L-函数，$\\Omega_{E}$ 是实 Néron 周期。请计算给定曲线 $E$ 的上式右侧的精确值，并将最终答案表示为单个最简分数。无需进行数值四舍五入。", "solution": "该问题要求对定义在有理数 $\\mathbb{Q}$ 上的椭圆曲线 $E$ 的 Tamagawa 数 $c_p$ 进行概念性解释，计算特定曲线在素数 $p=11$ 处的该数值，并随后计算 Birch 与 Swinnerton-Dyer (BSD) 猜想所预测的比值 $L(E,1)/\\Omega_E$。\n\n### Tamagawa 数 $c_p$ 的概念性确定\n\n设 $E$ 是一个定义在有理数域 $\\mathbb{Q}$ 上的椭圆曲线。对于任意素数 $p$，我们可以将 $E$ 视为定义在 $p$-进数局部域 $\\mathbb{Q}_p$ 上的曲线。$\\mathbb{Q}_p$ 中的整数环记为 $\\mathbb{Z}_p$。\n\n研究 $E$ 在素数 $p$ 处的算术性质的一个关键对象是其 Néron 模型，记为 $\\mathcal{E}$。Néron 模型是一个在 $p$-进整数环 $\\mathrm{Spec}(\\mathbb{Z}_p)$ 上的光滑、分离的群概形，其泛纤维（在 $\\mathbb{Q}_p$ 上）与 $E$ 同构。Néron 模型的存在性和唯一性是 Néron 的一个基本结果。\n\nNéron 模型的特殊纤维，记为 $\\mathcal{E}_p$，是 $\\mathrm{Spec}(\\mathbb{Z}_p)$ 的闭点上的纤维，这对应于将模型模 $p$ 约化。这个特殊纤维 $\\mathcal{E}_p$ 是有限域 $\\mathbb{F}_p$ 上的一个代数群。它不总是连通的。我们将其单位元的连通分支记为 $\\mathcal{E}_p^0$。\n\n特殊纤维的分支群是有限群 $\\Phi_p(E) = \\mathcal{E}_p(\\mathbb{F}_p) / \\mathcal{E}_p^0(\\mathbb{F}_p)$。Tamagawa 数 $c_p$ 定义为该分支群的阶：\n$$\nc_p = |\\Phi_p(E)| = [\\mathcal{E}_p(\\mathbb{F}_p) : \\mathcal{E}_p^0(\\mathbb{F}_p)].\n$$\n如果 $E$ 在 $p$ 处有好处约化（good reduction），特殊纤维 $\\mathcal{E}_p$ 本身就是一条椭圆曲线，因此是连通的。在这种情况下，$\\mathcal{E}_p = \\mathcal{E}_p^0$，分支群是平凡的，且 $c_p=1$。如果 $E$ 在 $p$ 处有坏约化（bad reduction），特殊纤维是奇异的，并且可能不连通。在这些情况下，$c_p$ 可能大于 $1$。\n\nTate 算法提供了一种系统的方法，可以直接从 $E$ 在 $p$ 处的最小 Weierstrass 方程确定特殊纤维 $\\mathcal{E}_p$ 的结构，从而计算 $c_p$。该算法根据 Kodaira 分类（$I_n, II, III, IV$ 等）对约化类型进行分类，并给出相应的 $c_p$ 值。\n\n### 在 $p=11$ 处对 $E$ 的应用\n\n给定的曲线是 $E: y^{2}+y = x^{3}-x^{2}-10x-20$。这是一个广义 Weierstrass 方程 $y^2 + a_1xy + a_3y = x^3 + a_2x^2 + a_4x + a_6$，其系数为 $a_1=0, a_2=-1, a_3=1, a_4=-10, a_6=-20$。对于任何素数 $p$（包括 $p=11$），这些都是 $p$-进整数。\n\n我们计算标准不变量：\n$b_2 = a_1^2 + 4a_2 = 0^2 + 4(-1) = -4$\n$b_4 = 2a_4 + a_1a_3 = 2(-10) + 0(1) = -20$\n$b_6 = a_3^2 + 4a_6 = 1^2 + 4(-20) = 1 - 80 = -79$\n$c_4 = b_2^2 - 24b_4 = (-4)^2 - 24(-20) = 16 + 480 = 496$\n判别式 $\\Delta = -11^5$。\n\n在 $p=11$ 处判别式的 $p$-进赋值为 $v_{11}(\\Delta) = 5$。由于 $v_{11}(\\Delta)=5  12$，给定的方程在 $p=11$ 处是最小的。\n\n现在我们对 $p=11$ 应用 Tate 算法：\n1. 由于 $v_{11}(\\Delta) = 5  0$，曲线在 $p=11$ 处有坏约化。\n2. 我们检查 $c_4$ 的赋值。$c_4 = 496 = 45 \\times 11 + 1$。因此，$c_4 \\not\\equiv 0 \\pmod{11}$，这意味着 $v_{11}(c_4)=0$。\n3. 根据 Tate 算法，如果 $v_p(\\Delta)0$ 且 $v_p(c_4)=0$，则约化类型为 $I_n$（乘性约化），其中 $n = v_p(\\Delta)$。在我们的例子中，$n=v_{11}(\\Delta)=5$。所以约化类型是 $I_5$。\n4. $I_n$ 型的奇点是一个结点（node）。结点是分裂的（split）还是非分裂的（non-split）取决于其两条切线的斜率是否都在基域 $\\mathbb{F}_{p}$ 中。对于该曲线，可以计算出切线在 $\\mathbb{F}_{11}$ 上是有理的，因此奇点是分裂结点。\n5. 对于分裂乘性约化（split multiplicative reduction）类型 $I_n$，Tamagawa 数就是 $c_p = n$。因此，对于 $p=11$ 和类型 $I_5$，我们有 $c_{11} = 5$。\n\n### BSD 猜想的计算\n\n我们被要求计算表达式 $\\frac{|\\Sha(E/\\mathbb{Q})| \\cdot \\prod_{p} c_{p}}{|E(\\mathbb{Q})_{\\mathrm{tors}}|^{2}}$ 的值。\n乘积 $\\prod_p c_p$ 遍及所有素数 $p$。对于 $E$ 有好约化的任何素数 $p$，$c_p=1$。$c_p$ 可能不为 $1$ 的素数是那些坏约化素数，它们恰好是整除椭圆曲线导子 $N$ 的素数。\n问题陈述中说明 $E$ 的导子为 $N=11$。这意味着唯一的坏约化素数是 $p=11$。\n因此，Tamagawa 数的乘积是：\n$$\n\\prod_{p} c_{p} = c_{11} \\cdot \\prod_{p \\ne 11} c_{p} = c_{11} \\cdot \\prod_{p \\ne 11} 1 = c_{11}.\n$$\n我们计算出 $c_{11} = 5$。\n所以，$\\prod_{p} c_{p} = 5$。\n\n我们已知以下值：\n$|\\Sha(E/\\mathbb{Q})| = 1$\n$|E(\\mathbb{Q})_{\\mathrm{tors}}| = 5$\n\n将这些值代入表达式中：\n$$\n\\frac{|\\Sha(E/\\mathbb{Q})| \\cdot \\prod_{p} c_{p}}{|E(\\mathbb{Q})_{\\mathrm{tors}}|^{2}} = \\frac{1 \\cdot 5}{5^2} = \\frac{5}{25} = \\frac{1}{5}.\n$$\n对于该曲线，BSD 公式右侧的值是 $\\frac{1}{5}$。", "answer": "$$\\boxed{\\frac{1}{5}}$$", "id": "3013137"}]}