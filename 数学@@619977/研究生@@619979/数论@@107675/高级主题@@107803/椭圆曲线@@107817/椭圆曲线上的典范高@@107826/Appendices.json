{"hands_on_practices": [{"introduction": "我们从最基本的构件开始：计算一个点在良好约化素数处的局部高。这个练习将揭示良好约化情形下局部高的简明性，展示它如何直接与该点坐标的 $p$-进大小相关联。通过这个具体的计算，您将为处理更复杂的情形打下坚实的基础。[@problem_id:3025332]", "problem": "设 $p$ 为一个奇素数，并考虑定义在 $p$-进数域 $\\mathbb{Q}_{p}$ 上的椭圆曲线 $E$，其由整系数短 Weierstrass 方程给出\n$$\ny^{2} = x^{3} - x.\n$$\n令 $v_{p}(\\,\\cdot\\,)$ 表示 $\\mathbb{Q}_{p}$ 上的 $p$-进赋值，其被归一化以使得 $v_{p}(p)=1$。令 $|\\,\\cdot\\,|_{p}$ 表示由 $|z|_{p} = p^{-v_{p}(z)}$ 定义的相关联的 $p$-进绝对值。$E$ 的判别式为 $\\Delta_{E}=64$，因此 $E$ 在每个奇素数 $p$ 处都有好约化。\n\n设 $P \\in E(\\mathbb{Q}_{p})$ 是一点，其坐标满足 $v_{p}(x(P))=-2$ 和 $v_{p}(y(P))=-3$。（这些赋值与曲线方程是一致的，因为 $y(P)^{2}=x(P)\\bigl(x(P)^{2}-1\\bigr)$，且对于 $v_{p}(x(P))<0$ 有 $v_{p}\\bigl(x(P)^{2}-1\\bigr)=2\\,v_{p}\\bigl(x(P)\\bigr)$，故 $v_{p}\\bigl(y(P)\\bigr)=\\tfrac{3}{2}\\,v_{p}\\bigl(x(P)\\bigr)=-3$。)\n\n令 $\\lambda_{p}(P)$ 表示与 $E$ 上的正则高相关联的、$P$ 在 $p$ 处的局部 Néron 高。其采用标准归一化，即全局正则高分解为所有位上局部贡献之和，且非阿基米德贡献使用上述定义的绝对值 $|\\,\\cdot\\,|_{p}$。\n\n从 Néron 局部高在好约化位上的基本性质以及形式群参数在原点处的行为出发，计算 $\\lambda_{p}(P)$ 作为 $p$ 的函数的显式闭形式值。\n\n你的最终答案必须是单一的闭形式符号表达式。请使用自然对数，不要进行四舍五入或近似。", "solution": "该问题要求计算在 $\\mathbb{Q}_{p}$ 上由 $y^{2} = x^{3} - x$ 给出的椭圆曲线 $E$ 上的一个特定点 $P$ 的 Néron 局部高 $\\lambda_{p}(P)$。\n\n首先，我们验证曲线和点的性质。椭圆曲线为 $E: y^{2} = x^{3} - x$。这是一个 $y^2=x^3+Ax+B$ 形式的方程，其中 $A=-1, B=0$。其判别式为 $\\Delta_{E} = -16(4A^3+27B^2) = -16(4(-1)^3) = 64$。由于 $p$ 是一个奇素数，$v_{p}(\\Delta_{E}) = v_{p}(64) = v_p(2^6) = 0$。这意味着给定的 Weierstrass 方程在 $p$ 处是极小的，且 $E$ 在 $p$ 处有好约化。\n\n点 $P \\in E(\\mathbb{Q}_{p})$ 的坐标满足 $v_{p}(x(P)) = -2$ 和 $v_{p}(y(P)) = -3$。如果 $E$ 上的一个点 $(x,y)$ 的坐标不都是整的，那么它就位于模 $p$ 约化映射的核中，这由其赋值决定。具体来说，如果 $v_p(x) < 0$，则必然 $v_p(y) < 0$，且该点在约化曲线 $\\tilde{E}(\\mathbb{F}_p)$ 上约化为单位元 $\\tilde{O}$。这样的点构成了子群 $E_1(\\mathbb{Q}_p)$。因此，条件 $v_p(x(P)) = -2 < 0$ 意味着 $P \\in E_1(\\mathbb{Q}_p)$。这也可以通过使用形式群参数 $z = -x/y$ 来看出。对于点 $P$，其形式群参数的赋值为 $v_{p}(z(P)) = v_{p}(-x(P)/y(P)) = v_{p}(x(P)) - v_{p}(y(P)) = -2 - (-3) = 1$。由于 $v_p(z(P)) > 0$，$P$ 位于形式群中，从而证实了 $P \\in E_1(\\mathbb{Q}_p)$。\n\n$E(\\mathbb{Q})$ 上的正则高 $\\hat{h}(P)$ 分解为 $\\mathbb{Q}$ 的所有位上的局部高贡献之和：\n$$\n\\hat{h}(P) = \\lambda_{\\infty}(P) + \\sum_{q \\text{ prime}} \\lambda_{q}(P)\n$$\n我们需要计算分量 $\\lambda_{p}(P)$。对于一个好约化的素数 $q$，其中 $E$ 由一个极小 Weierstrass 方程给出，Néron 局部高由一个公认的公式给出（例如，参见 J.H. Silverman 的《The Arithmetic of Elliptic Curves》，第八章，定理 5.6）：\n$$\n\\lambda_{q}(P) = \\frac{1}{2} \\ln \\max\\{1, |x(P)|_{q}\\}\n$$\n问题指明 $p$ 是一个奇素数，在此情况下曲线有好约化且给定的方程是极小的。因此，该公式适用。\n\n给定 $v_{p}(x(P)) = -2$。$p$-进绝对值定义为 $|z|_{p} = p^{-v_{p}(z)}$。\n将此应用于 $x(P)$：\n$$\n|x(P)|_{p} = p^{-v_{p}(x(P))} = p^{-(-2)} = p^{2}\n$$\n由于 $p$ 是一个奇素数，$p \\ge 3$，这意味着 $p^{2} \\ge 9 > 1$。因此，$\\max\\{1, |x(P)|_{p}\\} = |x(P)|_{p} = p^{2}$。\n\n将此代入局部高的公式中：\n$$\n\\lambda_{p}(P) = \\frac{1}{2} \\ln(p^{2})\n$$\n使用对数性质 $\\ln(a^{b}) = b \\ln(a)$，我们得到：\n$$\n\\lambda_{p}(P) = \\frac{1}{2} (2 \\ln p) = \\ln p\n$$\n\n为了完全严谨并按要求从更基本的性质来证明这一点，我们可以使用正则高作为和的表达式。正则高 $\\hat{h}(P)$ 可以从 Weil 高 $h_x(P) = \\sum_v \\ln\\max(1, |x(P)|_v)$ 通过伸缩求和来构造：\n$$\n\\hat{h}(P) = \\frac{1}{2}h_x(P) - \\frac{1}{2}\\sum_{n=0}^{\\infty} \\frac{1}{4^{n+1}} \\left( h_x(2^{n+1}P) - 4h_x(2^n P) \\right)\n$$\n局部高 $\\lambda_p(P)$ 是此表达式在位 $p$ 处的分量。需要仔细计算项 $h_x(2Q) - 4h_x(Q)$ 的局部贡献。设 $Q=(x,y)$ 且 $|x|_p > 1$。设 $x=X/Z$ 且 $|X|_p > |Z|_p$。我们可以进行归一化使得 $|Z|_p=1$，则 $|X|_p = |x|_p > 1$。对 $h_x(Q)$ 的局部贡献是 $\\ln|X|_p = \\ln|x|_p$。对 $4h_x(Q)$ 的局部贡献是 $4\\ln|x|_p$。倍点公式给出 $x(2Q) = \\frac{(x^2+1)^2}{4x(x^2-1)}$。在齐次坐标中，这是 $x(2Q) = \\frac{(X^2+Z^2)^2}{4XZ(X^2-Z^2)}$。\n对 $h_x(2Q)$ 的局部贡献是 $\\ln\\max(|(X^2+Z^2)^2|_p, |4XZ(X^2-Z^2)|_p)$。\n对于我们的点 $P$，令 $x=x(P)$，所以 $|x|_p = p^2$。我们有 $|x^2|_p = p^4$。因此 $|x^2+1|_p = \\max(|x^2|_p, 1) = p^4$，所以 $|(x^2+1)^2|_p = p^8$。并且 $|4x(x^2-1)|_p = |4|_p|x|_p|x^2-1|_p = 1 \\cdot p^2 \\cdot p^4 = p^6$。\n对 $h_x(2P)$ 的局部贡献是 $\\ln\\max(p^8, p^6) = \\ln(p^8) = 8\\ln p$。对 $4h_x(P)$ 的局部贡献是 $4\\ln\\max(1, |x|_p) = 4\\ln(p^2) = 8\\ln p$。对 $h_x(2P)-4h_x(P)$ 的局部贡献是 $8\\ln p - 8\\ln p = 0$。\n类似的论证表明，由于 $v_p(x(2^n P)) = -2$，这对所有 $2^n P$ 都成立。因此，$\\lambda_p(P)$ 的整个求和项为零。\n这剩下 $\\lambda_p(P) = \\frac{1}{2}\\ln\\max(1, |x(P)|_p)$，这正是我们使用的第一个公式。该推导证实了其适用性。\n\n最终值为 $\\lambda_{p}(P) = \\ln p$。", "answer": "$$\n\\boxed{\\ln(p)}\n$$", "id": "3025332"}, {"introduction": "接下来，我们将挑战更复杂的坏约化情形。这个练习处理的是可分裂乘法约化的场景，并引入了 Tate 一致化这一强大工具。掌握这种情形下的计算对于理解和处理典范高在坏约化素数处的所有复杂性至关重要。[@problem_id:3025324]", "problem": "设 $E/\\mathbb{Q}$ 为一条椭圆曲线，其在有理素数 $p=11$ 处有可裂乘法约化。假设在 $p$ 处的局部一致化由一条 Tate 曲线给出，其参数为 $q \\in \\mathbb{Q}_{11}$ 且满足 $v_{11}(q)=7$，其中 $v_{11}$ 表示由 $v_{11}(11)=1$ 标准化的 $11$-adic 赋值。设点 $P \\in E(\\mathbb{Q})$ 在 Tate 一致化 $E_q(\\mathbb{Q}_{11}) \\cong \\mathbb{Q}_{11}^{\\times}/q^{\\mathbb{Z}}$ 下对应于一个参数 $u(P) \\in \\mathbb{Q}_{11}^{\\times}$，其满足 $v_{11}(u(P))=-3$。\n\n请利用 Néron–Tate 典范高度 $\\hat{h}(P)$ 分解为局部高度之和的性质，以及在可裂乘法位上的 Tate 一致化，来计算 $11$-adic 局部贡献 $\\lambda_{11}(P)$。请将结果表示为关于第二 Bernoulli 多项式 $B_{2}(t)=t^{2}-t+\\frac{1}{6}$ 以及赋值数据 $v_{11}(q)$、$v_{11}(u(P))$ 的表达式。你的最终答案必须是包含 $\\ln(11)$ 的单个闭式表达式，不得进行四舍五入。", "solution": "问题要求计算椭圆曲线 $E/\\mathbb{Q}$ 上一个有理点 $P$ 的 Néron-Tate 典范高度 $\\hat{h}(P)$ 的 $11$-adic 局部贡献 $\\lambda_{11}(P)$。\n\n首先，我们回顾 Néron-Tate 典范高度的基本结构。对于一个点 $P \\in E(\\mathbb{Q})$，其典范高度 $\\hat{h}(P)$ 由其在 $\\mathbb{Q}$ 的所有位 $v$ 上的局部贡献（局部高度或 Néron 函数）$\\lambda_v(P)$ 的总和给出：\n$$\n\\hat{h}(P) = \\sum_{v} \\lambda_v(P) = \\lambda_{\\infty}(P) + \\sum_{p \\text{ prime}} \\lambda_p(P)\n$$\n\n问题指明椭圆曲线 $E$ 在素数 $p=11$ 处有可裂乘法约化。在这样一个位上，曲线的 $\\mathbb{Q}_{11}$-点群同构于局部域 $\\mathbb{Q}_{11}$ 的乘法群与由 Tate 参数 $q$ 生成的循环子群的商群。这就是 Tate 一致化：\n$$\nE(\\mathbb{Q}_{11}) \\cong \\mathbb{Q}_{11}^{\\times} / q^{\\mathbb{Z}}\n$$\n此处，$q \\in \\mathbb{Q}_{11}$ 是一个 $11$-adic 赋值 $v_{11}(q) > 0$ 的元素。我们已知 $v_{11}(q)=7$。一个点 $P \\in E(\\mathbb{Q}) \\subset E(\\mathbb{Q}_{11})$ 对应于一个元素 $u(P) \\in \\mathbb{Q}_{11}^{\\times}$，该元素在相差一个 $q$ 的整数次幂的意义下是唯一定义的。我们已知 $v_{11}(u(P)) = -3$。\n\n局部高度 $\\lambda_{11}(P)$ 的计算依赖于一个从此一致化导出的显式公式。对于一个可裂乘法约化位 $v$（此处用素数 $p$ 表示），其局部高度的标准公式通过第二 Bernoulli 多项式 $B_2(t) = t^2-t+\\frac{1}{6}$ 将 $\\lambda_p(P)$ 与 $q$ 和 $u(P)$ 的赋值联系起来。如 Hindry 和 Silverman 的《Diophantine Geometry》等标准教材中给出的公式为：\n$$\n\\lambda_p(P) = \\frac{1}{2} v_p(q) \\ln(p) \\cdot B_2\\left( \\left\\{ \\frac{v_p(u(P))}{v_p(q)} \\right\\} \\right)\n$$\n其中 $\\{x\\} = x - \\lfloor x \\rfloor$ 表示实数 $x$ 的小数部分。\n\n值得注意的是，全局高度分解为局部份量的方式并非唯一。文献中存在对局部高度的不同标准化方法。上述公式是一种常见的选择。然而，典范高度 $\\hat{h}(P)$ 具有性质 $\\hat{h}(O)=0$，其中 $O$是曲线的单位点。通常会选择一种典范分解，以尽可能在局部层面反映此性质，例如要求对所有有限素数 $p$ 都有 $\\lambda_p(O)=0$。\n\n我们来用给定公式计算单位点 $O$ 的高度。点 $O$ 对应于 $\\mathbb{Q}_{11}^{\\times}/q^{\\mathbb{Z}}$ 中的单位元，可以由 $u(O)=1$ 表示。因此，$v_{11}(u(O))=v_{11}(1)=0$。Bernoulli 多项式的自变量因此为 $\\{\\frac{0}{7}\\} = 0$。\n$$\n\\lambda_{11}(O) = \\frac{1}{2} v_{11}(q) \\ln(11) \\cdot B_2(0)\n$$\n由于 $B_2(0) = 0^2-0+\\frac{1}{6} = \\frac{1}{6}$，我们得到\n$$\n\\lambda_{11}(O) = \\frac{1}{2} \\cdot 7 \\cdot \\ln(11) \\cdot \\frac{1}{6} = \\frac{7}{12}\\ln(11)\n$$\n这是一个非零值。“局部贡献”一词通常意味着一个唯一的、典范的选择。最自然的选择是在单位点处标准化为零的高度。因此，我们将计算标准化局部高度 $\\lambda_{11}^{\\text{norm}}(P) = \\lambda_{11}(P) - \\lambda_{11}(O)$，并假设这就是题目所要求的量。\n$$\n\\lambda_{11}^{\\text{norm}}(P) = \\frac{1}{2} v_{11}(q) \\ln(11) \\left( B_2\\left( \\left\\{ \\frac{v_{11}(u(P))}{v_{11}(q)} \\right\\} \\right) - B_2(0) \\right)\n$$\n现在我们应用题目中给出的数据：\n- $p=11$\n- $v_{11}(q) = 7$\n- $v_{11}(u(P)) = -3$\n\n首先，我们计算点 $P$ 对应的 Bernoulli 多项式的自变量：\n$$\n\\frac{v_{11}(u(P))}{v_{11}(q)} = \\frac{-3}{7}\n$$\n其小数部分为：\n$$\n\\left\\{ \\frac{-3}{7} \\right\\} = \\frac{-3}{7} - \\left\\lfloor \\frac{-3}{7} \\right\\rfloor = \\frac{-3}{7} - (-1) = \\frac{4}{7}\n$$\n接下来，我们计算 $B_2$ 在此值处的取值：\n$$\nB_2\\left(\\frac{4}{7}\\right) = \\left(\\frac{4}{7}\\right)^2 - \\frac{4}{7} + \\frac{1}{6} = \\frac{16}{49} - \\frac{4}{7} + \\frac{1}{6}\n$$\n为将这些分数相加，我们使用公分母 $49 \\times 6 = 294$：\n$$\nB_2\\left(\\frac{4}{7}\\right) = \\frac{16 \\cdot 6}{294} - \\frac{4 \\cdot 42}{294} + \\frac{49}{294} = \\frac{96 - 168 + 49}{294} = \\frac{-23}{294}\n$$\n现在我们可以计算标准化局部高度：\n$$\n\\lambda_{11}^{\\text{norm}}(P) = \\frac{1}{2} \\cdot 7 \\cdot \\ln(11) \\left( -\\frac{23}{294} - \\frac{1}{6} \\right)\n$$\n我们将 $\\frac{1}{6}$ 转换为分母是 $294$ 的分数：$\\frac{1}{6} = \\frac{49}{294}$。\n$$\n\\lambda_{11}^{\\text{norm}}(P) = \\frac{7}{2} \\ln(11) \\left( -\\frac{23}{294} - \\frac{49}{294} \\right) = \\frac{7}{2} \\ln(11) \\left( -\\frac{72}{294} \\right)\n$$\n我们简化该表达式：\n$$\n\\lambda_{11}^{\\text{norm}}(P) = -\\frac{7 \\cdot 72}{2 \\cdot 294} \\ln(11)\n$$\n由于 $294 = 6 \\times 49 = 6 \\times 7^2$，我们可以简化为：\n$$\n\\lambda_{11}^{\\text{norm}}(P) = -\\frac{7 \\cdot 72}{2 \\cdot 6 \\cdot 49} \\ln(11) = -\\frac{72}{2 \\cdot 6 \\cdot 7} \\ln(11) = -\\frac{72}{84} \\ln(11)\n$$\n最后，我们通过将分子和分母同除以它们的最大公约数 $12$ 来约简分数 $\\frac{72}{84}$：\n$$\n\\frac{72}{84} = \\frac{6 \\times 12}{7 \\times 12} = \\frac{6}{7}\n$$\n因此，标准化的局部贡献为：\n$$\n\\lambda_{11}(P) = -\\frac{6}{7} \\ln(11)\n$$\n这就是我们的最终答案，一个符合要求的闭式表达式。", "answer": "$$\\boxed{-\\frac{6}{7}\\ln(11)}$$", "id": "3025324"}, {"introduction": "在掌握了单个局部高的计算之后，一个关键的实践问题是如何将它们组合成全局高：哪些素数对总和有贡献？这个练习将引导您确定一个需要考虑的、完备且有限的素数集合，从而将一个看似无限的求和过程转变为一个可行的计算任务。[@problem_id:3025331]", "problem": "设 $E/\\mathbb{Q}$ 为一条由最小 Weierstrass 方程给出的椭圆曲线，其最小判别式为 $\\Delta_E$。对于一个有理点 $P \\in E(\\mathbb{Q})$，其 Néron-Tate 典范高度 $\\hat{h}(P)$ 可以分解为局部高度之和\n$$\n\\hat{h}(P) \\;=\\; \\sum_{v} \\lambda_v(P),\n$$\n其中求和遍历 $\\mathbb{Q}$ 的所有位 $v$（对应于素数 $p$ 的有限位和唯一的阿基米德位 $v=\\infty$），$\\lambda_v(P)$ 表示在 $v$ 处的典范局部高度。在实际计算中，我们通过对一个有限素数集合 $S$ 上的非阿基米德局部高度求和，并以给定的数值精度计算阿基米德局部高度来近似 $\\hat{h}(P)$，这样就忽略了 $S$ 之外的非阿基米德位的贡献，并在 $v=\\infty$ 处产生了一个数值截断误差。\n\n仅从以下标准事实和定义出发：\n- 对于一个最小 Weierstrass 模型，$E$ 在所有素数 $p \\nmid \\Delta_E$ 处都有好约化。\n- 如果 $E$ 在 $p$ 处有好约化，且 $P$ 具有 $p$-adic 整坐标（等价地，$P$ 的 $x$ 坐标的最简分式分母不被 $p$ 整除），那么在 $p$ 处的局部高度贡献为零，即 $\\lambda_p(P) = 0$。\n- 阿基米德局部高度 $\\lambda_\\infty(P)$ 可以被数值计算到任何给定的绝对精度 $\\delta > 0$。\n\n设计一个策略来选择一个有限素数集合 $S$ 和一个阿基米德精度 $\\delta$，使得所有被忽略的局部高度贡献之和不超过给定的容差 $\\epsilon > 0$。以下哪种策略在数学上足以保证被忽略的贡献 $\\leq \\epsilon$？\n\nA. 选择一个界 $B>0$ 使得 $\\sum_{p>B} p^{-1} < \\epsilon/2$，并取 $S$ 为所有素数 $p \\leq B$。以绝对精度 $\\delta = \\epsilon/2$ 计算 $\\lambda_\\infty(P)$，并舍弃所有其他局部项。\n\nB. 取 $S$ 为整除 $\\Delta_E$ 的素数集合。以绝对精度 $\\delta = \\epsilon/2$ 计算 $\\lambda_\\infty(P)$，并舍弃所有其他局部项。\n\nC. 取 $S$ 为整除 $\\Delta_E$ 的素数集合与整除 $P$ 的 $x$ 坐标最简分式分母的素数集合的并集。以绝对精度 $\\delta \\leq \\epsilon$ 计算 $\\lambda_\\infty(P)$，并舍弃所有其他局部项。\n\nD. 取 $S$ 为整除 $P$ 的 $x$ 坐标分子的素数集合与素数 $p \\leq B$ 的集合的并集，其中 $B$ 的选择使得 $\\sum_{p>B} \\log p < \\epsilon/2$。以绝对精度 $\\delta = \\epsilon/2$ 计算 $\\lambda_\\infty(P)$，并舍弃所有其他局部项。", "solution": "问题要求设计一个策略，以在期望的容差 $\\epsilon > 0$ 内，计算椭圆曲线 $E/\\mathbb{Q}$ 上有理点 $P$ 的典范高度 $\\hat{h}(P)$。计算中的总误差是阿基米德局部高度 $\\lambda_\\infty(P)$ 的数值误差与因忽略选定的有限集合 $S$ 之外的素数 $p$ 的非阿基米德局部高度 $\\lambda_p(P)$ 而产生的截断误差之和。我们必须找到一个能保证被忽略的总贡献小于或等于 $\\epsilon$ 的策略。\n\n首先，我们对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- $E/\\mathbb{Q}$ 是由最小 Weierstrass 方程给出的椭圆曲线。\n- $\\Delta_E$ 是 $E$ 的最小判别式。\n- $P \\in E(\\mathbb{Q})$ 是一个有理点。\n- Néron-Tate 典范高度为 $\\hat{h}(P) = \\sum_{v} \\lambda_v(P)$，其中求和遍历 $\\mathbb{Q}$ 的所有位 $v$（素数 $p$ 和 $v=\\infty$）。\n- $\\lambda_v(P)$ 是在位 $v$ 处的典范局部高度。\n- 对于一个有限素数集合 $S$，计算策略包括用 $\\lambda_\\infty(P)_{\\text{computed}} + \\sum_{p \\in S} \\lambda_p(P)$ 来近似 $\\hat{h}(P)$。\n- 被忽略的总贡献是所有被忽略的局部高度贡献之和。\n- **事实 1**：对于一个最小 Weierstrass 模型，$E$ 在所有素数 $p \\nmid \\Delta_E$ 处都有好约化。\n- **事实 2**：如果 $E$ 在 $p$ 处有好约化，且 $P$ 具有 $p$-adic 整坐标，则 $\\lambda_p(P) = 0$。$P$ 具有 $p$-adic 整坐标的条件被陈述为等价于 $P$ 的 $x$ 坐标的分母不被 $p$ 整除。\n- **事实 3**：阿基米德局部高度 $\\lambda_\\infty(P)$ 可以被数值计算到任何给定的绝对精度 $\\delta > 0$。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：问题陈述基于椭圆曲线算术中标准的、成熟的概念，即由 Néron 发展的 Néron-Tate 高度理论及其分解为局部高度的方法。好约化、整点和局部高度为零之间的关系是该理论的基石。所有给出的事实都是该领域的正确陈述。\n- **适定性**：该问题是适定的。它要求在给定一组明确的数学事实的情况下，给出一个足以限定误差项的策略。可以从这些前提出发严格推导出一个唯一的答案。\n- **客观性**：语言正式且无歧义。所有术语，如“最小 Weierstrass 方程”、“最小判别式”和“局部高度”都有精确的数学定义。\n\n问题陈述是科学合理的、适定的和客观的。它不包含任何矛盾、歧义或事实错误。\n\n### 步骤 3：结论与行动\n问题是有效的。我们可以继续进行求解。\n\n### 正确策略的推导\n\n被忽略的总贡献（我们记为 $E_{total}$）是忽略非阿基米德局部高度所产生的截断误差与计算阿基米德局部高度所产生的数值误差之和。设 $\\lambda_\\infty(P)$ 的计算值为 $\\lambda_\\infty(P)_{\\text{computed}}$。问题陈述说明我们可以做到 $|\\lambda_\\infty(P) - \\lambda_\\infty(P)_{\\text{computed}}| \\leq \\delta$。阿基米德高度中被忽略的部分就是这个数值误差，其上界为 $\\delta$。\n\n被忽略的非阿基米德贡献是所有不在我们所选集合 $S$ 中的素数对应的局部高度之和：\n$$\nE_{\\text{non-archimedean}} = \\sum_{p \\notin S} \\lambda_p(P)\n$$\n因此，被忽略的总贡献的上界为：\n$$\nE_{total} \\leq \\delta + \\left| \\sum_{p \\notin S} \\lambda_p(P) \\right|\n$$\n虽然局部高度可以为负，但标准结果（此处并非严格需要，但有助于理解上下文）表明，对于点是整点的好约化素数，$\\lambda_p(P) \\ge 0$。更重要的是，我们试图找到一个集合 $S$，使得对于 $p \\notin S$，有 $\\lambda_p(P)=0$。\n\n我们的目标是选择 $S$ 和 $\\delta$，使得 $E_{total} \\leq \\epsilon$。\n\n让我们*仅*根据所提供的事实来分析非阿基米德局部高度 $\\lambda_p(P)$ 何时可以不为零。根据事实 2，如果*同时*满足以下两个条件，则 $\\lambda_p(P) = 0$：\n1. $E$ 在 $p$ 处有好约化。\n2. $P$ 具有 $p$-adic 整坐标。\n\n因此，$\\lambda_p(P)$ 只有在至少一个条件被违反时才可能不为零。\n- **违反条件 1：** $E$ 在 $p$ 处有坏约化。根据事实 1，对于一个最小 Weierstrass 模型，如果 $E$ 在 $p$ 处有坏约化，则 $p$ 必定是最小判别式 $\\Delta_E$ 的一个素因子。\n- **违反条件 2：** $P$ 不具有 $p$-adic 整坐标。根据事实 2，这等价于素数 $p$ 整除 $P$ 的 $x$ 坐标的分母（当写成最简分式时）。设 $x(P) = a/b$ 且 $\\text{gcd}(a,b)=1$。那么这个条件意味着 $p|b$。\n\n综合以上两点，任何可能导致 $\\lambda_p(P)$ 不为零的素数 $p$ 都必须属于以下集合：\n$$\nS_{\\text{critical}} = \\{p \\text{ prime} \\mid p \\text{ divides } \\Delta_E\\} \\cup \\{p \\text{ prime} \\mid p \\text{ divides the denominator of } x(P)\\}\n$$\n如果我们选择集合 $S$ 恰好为这个 $S_{\\text{critical}}$ 集合，那么对于任何素数 $p \\notin S$：\n- $p$ 不整除 $\\Delta_E$，因此 $E$ 在 $p$ 处有好约化（根据事实 1）。\n- $p$ 不整除 $x(P)$ 的分母，因此 $P$ 具有 $p$-adic 整坐标（根据事实 2）。\n- 根据事实 2，这两个条件共同意味着对于所有 $p \\notin S$，有 $\\lambda_p(P)=0$。\n\n当选择 $S = S_{\\text{critical}}$ 时，被忽略的非阿基米德贡献之和为：\n$$\n\\sum_{p \\notin S} \\lambda_p(P) = \\sum_{p \\notin S_{\\text{critical}}} 0 = 0\n$$\n在这种情况下，全部误差都来自于阿基米德局部高度的数值近似。被忽略的总贡献上界为 $\\delta$。为保证被忽略的总贡献至多为 $\\epsilon$，我们必须选择 $\\delta$ 使得 $\\delta \\leq \\epsilon$。\n\n因此，一个充分的策略是：\n1. 选择 $S$ 为整除 $\\Delta_E$ 的素数集合与整除 $x(P)$ 分母的素数集合的并集。\n2. 以绝对精度 $\\delta \\leq \\epsilon$ 计算 $\\lambda_\\infty(P)$。\n\n现在我们来评估给出的选项。\n\n### 逐项分析\n\n**A. 选择一个界 $B>0$ 使得 $\\sum_{p>B} p^{-1} < \\epsilon/2$，并取 $S$ 为所有素数 $p \\leq B$。以绝对精度 $\\delta = \\epsilon/2$ 计算 $\\lambda_\\infty(P)$，并舍弃所有其他局部项。**\n\n这个策略是不充分的。所提供的事实并未建立 $\\lambda_p(P)$ 与 $p^{-1}$ 之间的任何关系。$E$ 可能在一个非常大的素数 $p_0 > B$ 处有坏约化，或者 $x(P)$ 的分母可能被一个大素数 $p_1 > B$ 整除。在这种情况下，$\\lambda_{p_0}(P)$ 或 $\\lambda_{p_1}(P)$ 可能不为零。该策略会忽略这些项，而我们没有任何信息来限定它们的大小。基于给定的事实，关于 $p^{-1}$ 求和的条件与限定截断误差无关。\n**结论：不正确。**\n\n**B. 取 $S$ 为整除 $\\Delta_E$ 的素数集合。以绝对精度 $\\delta = \\epsilon/2$ 计算 $\\lambda_\\infty(P)$，并舍弃所有其他局部项。**\n\n这个策略正确地处理了所有坏约化的素数。但是，它未能处理好约化但点 $P$ 非整的情况。如果 $q$ 是一个整除 $x(P)$ 分母但不整除 $\\Delta_E$ 的素数，那么 $E$ 在 $q$ 处有好约化，但 $P$ 不是 $q$-整点。所给的事实不允许我们断定 $\\lambda_q(P)=0$。实际上，$\\lambda_q(P)$ 可以不为零。该策略忽略了这些项，并且根据问题陈述，无法保证它们的和为零或被任何特定值所限定。因此，总误差不能保证 $\\leq \\epsilon$。\n**结论：不正确。**\n\n**C. 取 $S$ 为整除 $\\Delta_E$ 的素数集合与整除 $P$ 的 $x$ 坐标最简分式分母的素数集合的并集。以绝对精度 $\\delta \\leq \\epsilon$ 计算 $\\lambda_\\infty(P)$，并舍弃所有其他局部项。**\n\n这个策略与我们推导出的策略完全一致。集合 $S$ 被选为 $S_{\\text{critical}}$。正如我们的推导所示，对于任何素数 $p \\notin S$，事实 2 的两个条件都得到满足，这意味着 $\\lambda_p(P) = 0$。因此，所有被忽略的非阿基米德局部高度之和恰好为 $0$。唯一剩下的误差来源是 $\\lambda_\\infty(P)$ 的数值计算，也就是阿基米德局部高度中被忽略的部分。这个误差的上界是 $\\delta$。通过选择 $\\delta \\leq \\epsilon$，可以保证被忽略的总贡献 $\\leq \\epsilon$。这个策略在数学上是充分的。\n**结论：正确。**\n\n**D. 取 $S$ 为整除 $P$ 的 $x$ 坐标分子的素数集合与素数 $p \\leq B$ 的集合的并集，其中 $B$ 的选择使得 $\\sum_{p>B} \\log p < \\epsilon/2$。以绝对精度 $\\delta = \\epsilon/2$ 计算 $\\lambda_\\infty(P)$，并舍弃所有其他局部项。**\n\n这个策略因多个原因而不正确。首先，根据所提供的事实，整除 $x(P)$ *分子*的素数并非非零局部高度的来源（这与 $P$ 的约化是单位元有关，但根据所提供的事实，与 $\\lambda_p(P)$ 的值没有直接关系）。其次，如果整除 $\\Delta_E$ 或 $x(P)$ 分母的素数大于 $B$，该策略未能将它们包含在内。第三，与选项 A 类似，涉及 $\\sum \\log p$ 的界是一个障眼法，没有根据所提供的事实为限定局部高度贡献提供任何理由。\n**结论：不正确。**", "answer": "$$\\boxed{C}$$", "id": "3025331"}]}