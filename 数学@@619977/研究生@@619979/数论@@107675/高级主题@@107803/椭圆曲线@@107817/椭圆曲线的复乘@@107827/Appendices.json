{"hands_on_practices": [{"introduction": "动手实践的第一步是建立复数乘法（Complex Multiplication, CM）理论的核心联系：虚二次域的类群与具有相应复数乘法的椭圆曲线之间的关系。本练习通过经典的二次型方法，让你亲手计算几个基本判别式的类数，从而具体地验证这个深刻的定理。这个过程不仅能让你掌握一项基本的数论计算技能，还能让你直观地理解，为什么这些类数恰好对应于具有特定CM的椭圆曲线的$j$-不变量的个数 [@problem_id:3010294]。", "problem": "设 $D<0$ 为一个负的基本判别式，并令 $\\mathcal{O}_{D}$ 表示虚二次域 $\\mathbb{Q}(\\sqrt{D})$ 中判别式为 $D$ 的虚二次序。理想类群 $\\mathrm{Cl}(\\mathcal{O}_{D})$ 可与判别式为 $D=b^{2}-4ac$ 的本原正定二元二次型 $f(x,y)=ax^{2}+bxy+cy^{2}$ 在 $\\mathrm{SL}_{2}(\\mathbb{Z})$ 作用下的等价类群等同，其复合运算由高斯复合给出。如果一个二次型满足正定型的标准归约不等式，即 $|b|\\leq a\\leq c$，并且在 $|b|=a$ 或 $a=c$ 的情况下有 $b\\geq 0$，则称该二次型为既约型。\n\n从这些基本定义出发，通过明确列出相应判别式的所有既约本原正定二元二次型，并利用高斯对应推断其群结构，来确定 $D=-3, D=-4, D=-7$ 和 $D=-8$ 的类群 $\\mathrm{Cl}(\\mathcal{O}_{D})$。然后，利用 $\\mathrm{Cl}(\\mathcal{O}_{D})$ 与“具有 $\\mathcal{O}_{D}$ 复乘（CM）的复环面之同构类集合”（等价于其自同态环为 $\\mathcal{O}_{D}$ 的 $\\mathbb{C}$ 上椭圆曲线的同构类集合）之间的等同关系，解释为什么您得到的阶数等于由 $\\mathcal{O}_{D}$ 复乘产生的不同 $j$-不变量的数量。\n\n您的最终答案必须是行向量 $\\big(h(-3),\\,h(-4),\\,h(-7),\\,h(-8)\\big)$，其中 $h(D)=|\\mathrm{Cl}(\\mathcal{O}_{D})|$ 表示类数。无需四舍五入。", "solution": "该问题陈述有效。所有给出的定义和陈述在代数数论与复乘理论的框架下均为标准和正确的。此问题自洽、一致且良定。我们可以着手求解。\n\n问题要求分两部分作答：首先，通过寻找所有既约本原正定二元二次型，计算基本判别式 $D = -3, -4, -7, -8$ 的类数 $h(D) = |\\mathrm{Cl}(\\mathcal{O}_{D})|$；其次，解释这个数与具有 $\\mathcal{O}_{D}$ 序复乘（CM）的椭圆曲线的不同 $j$-不变量数量之间的联系。\n\n一个二元二次型 $f(x,y) = ax^2 + bxy + cy^2$ 的判别式为 $D = b^2 - 4ac$。对于 $D < 0$，若 $a > 0$，则该二次型为正定型。若 $\\gcd(a, b, c) = 1$，则称该二次型为本原的。这类二次型在 $\\mathrm{SL}_{2}(\\mathbb{Z})$ 作用下的等价类集合构成一个有限阿贝尔群，这是理想类群 $\\mathrm{Cl}(\\mathcal{O}_D)$ 的一个具体实现。每个等价类恰好包含一个既约型，其满足以下条件：\n1. $|b| \\leq a \\leq c$\n2. 若 $|b| = a$ 或 $a = c$，则 $b \\geq 0$。\n\n从判别式方程 $D = b^2 - 4ac$ 和归约条件，我们可以推导出系数的界。由于 $a \\leq c$，我们有 $4a^2 \\leq 4ac = b^2 - D$。又因为 $|b| \\leq a$，我们有 $b^2 \\leq a^2$。将这些结合起来得到 $4a^2 \\leq a^2 - D$，简化为 $3a^2 \\leq -D = |D|$。这给出了系数 $a$ 的一个上界：\n$$a \\leq \\sqrt{\\frac{|D|}{3}}$$\n由于 $a$ 必须为正整数，此不等式使得寻找既约型的过程是有限的。此外，对于一个基本判别式 $D$，系数 $b$ 必须与 $D$ 有相同的奇偶性，即 $b \\equiv D \\pmod{2}$。\n\n我们现在对每个给定的判别式枚举其既约型。\n\n**情形 1: $D = -3$**\n这是一个基本判别式。我们寻找满足条件的整数三元组 $(a, b, c)$。\n- $a$ 的界为 $a \\leq \\sqrt{\\frac{|-3|}{3}} = \\sqrt{1} = 1$。由于 $a>0$，必有 $a=1$。\n- 条件 $|b| \\leq a$ 意味着 $|b| \\leq 1$。\n- 判别式 $D=-3$ 是奇数，所以 $b$ 必须是奇数。这使得 $b=1$ 和 $b=-1$。\n- 对于 $b=1$：我们计算 $c = \\frac{b^2 - D}{4a} = \\frac{1^2 - (-3)}{4(1)} = \\frac{4}{4} = 1$。二次型为 $(1, 1, 1)$。\n  - 我们检查归约条件：$|1| \\leq 1 \\leq 1$ 成立。由于 $a=c=1$，必须有 $b \\geq 0$。$b=1$ 满足此条件。\n  - 该二次型是本原的，因为 $\\gcd(1,1,1)=1$。\n  - 因此，$x^2 + xy + y^2$ 是一个既约本原二次型。\n- 对于 $b=-1$：二次型将是 $(1,-1,1)$。这里 $a=c=1$，要求 $b \\geq 0$。这不被满足，所以该二次型不是既约型。\n我们只找到了一个既约型。因此，类数为 $h(-3) = 1$。\n\n**情形 2: $D = -4$**\n这是一个基本判别式。\n- $a$ 的界为 $a \\leq \\sqrt{\\frac{|-4|}{3}} \\approx 1.15$。必有 $a=1$。\n- 条件 $|b| \\leq a$ 意味着 $|b| \\leq 1$。\n- 判别式 $D=-4$ 是偶数，所以 $b$ 必须是偶数。这只剩下 $b=0$。\n- 对于 $b=0$：我们计算 $c = \\frac{b^2 - D}{4a} = \\frac{0^2 - (-4)}{4(1)} = \\frac{4}{4} = 1$。二次型为 $(1, 0, 1)$。\n  - 我们检查归约条件：$|0| \\leq 1 \\leq 1$ 成立。由于 $a=c=1$，必须有 $b \\geq 0$。$b=0$ 满足此条件。\n  - 该二次型是本原的，因为 $\\gcd(1,0,1)=1$。\n  - 因此，$x^2 + y^2$ 是一个既约本原二次型。\n我们只找到了一个既约型。因此，类数为 $h(-4) = 1$。\n\n**情形 3: $D = -7$**\n这是一个基本判别式。\n- $a$ 的界为 $a \\leq \\sqrt{\\frac{|-7|}{3}} \\approx 1.52$。必有 $a=1$。\n- 条件 $|b| \\leq a$ 意味着 $|b| \\leq 1$。\n- 判别式 $D=-7$ 是奇数，所以 $b$ 必须是奇数。这使得 $b=1$ 和 $b=-1$。\n- 对于 $b=1$：我们计算 $c = \\frac{b^2 - D}{4a} = \\frac{1^2 - (-7)}{4(1)} = \\frac{8}{4} = 2$。二次型为 $(1, 1, 2)$。\n  - 我们检查归约条件：$|1| \\leq 1 \\leq 2$ 成立。由于 $|b|=a=1$，必须有 $b \\geq 0$。$b=1$ 满足此条件。\n  - 该二次型是本原的，因为 $\\gcd(1,1,2)=1$。\n  - 因此，$x^2 + xy + 2y^2$ 是一个既约本原二次型。\n- 对于 $b=-1$：二次型为 $(1,-1,2)$。这里 $|b|=a=1$，要求 $b \\geq 0$。这不被满足。\n我们只找到了一个既约型。因此，类数为 $h(-7) = 1$。\n\n**情形 4: $D = -8$**\n这是一个基本判别式。\n- $a$ 的界为 $a \\leq \\sqrt{\\frac{|-8|}{3}} \\approx 1.63$。必有 $a=1$。\n- 条件 $|b| \\leq a$ 意味着 $|b| \\leq 1$。\n- 判别式 $D=-8$ 是偶数，所以 $b$ 必须是偶数。这只剩下 $b=0$。\n- 对于 $b=0$：我们计算 $c = \\frac{b^2 - D}{4a} = \\frac{0^2 - (-8)}{4(1)} = \\frac{8}{4} = 2$。二次型为 $(1, 0, 2)$。\n  - 我们检查归约条件：$|0| \\leq 1 \\leq 2$ 成立。边界情况 $|b|=a$ 和 $a=c$ 不适用。\n  - 该二次型是本原的，因为 $\\gcd(1,0,2)=1$。\n  - 因此，$x^2 + 2y^2$ 是一个既约本原二次型。\n我们只找到了一个既约型。因此，类数为 $h(-8) = 1$。\n\n在所有四种情况下，类数均为 $1$。\n\n**与复乘及 $j$-不变量的联系**\n\n复乘理论在虚二次序的类群与椭圆曲线的算术之间建立了深刻的联系。\n\n1. 复数域 $\\mathbb{C}$ 上的一个椭圆曲线 $E$ 同构于一个复环面 $\\mathbb{C}/\\Lambda$（其中 $\\Lambda$ 是某个格）。任何这样的格都位似于 $\\Lambda_{\\tau} = \\mathbb{Z} + \\mathbb{Z}\\tau$ 形式的格，其中 $\\tau$ 唯一地位于作用于上半平面 $\\mathbb{H}$ 的 $\\mathrm{SL}_2(\\mathbb{Z})$ 的基本域中。$E$ 的同构类由其 $j$-不变量 $j(E) = j(\\tau)$ 唯一确定。\n\n2. 如果一个椭圆曲线 $E$ 的自同态环 $\\mathrm{End}(E)$ 同构于一个虚二次域中的序 $\\mathcal{O}$，则称 $E$ 具有 $\\mathcal{O}$ 复乘（CM）。对于一般的曲线，$\\mathrm{End}(E) \\cong \\mathbb{Z}$。\n\n3. 复乘理论的一个关键结果是：一个椭圆曲线 $E \\cong \\mathbb{C}/(\\mathbb{Z} + \\mathbb{Z}\\tau)$ 具有 $\\mathcal{O}_D$ 序复乘，当且仅当 $\\tau$ 是虚二次域 $K = \\mathbb{Q}(\\sqrt{D})$ 中的一个元素。\n\n4. 具有特定序 $\\mathcal{O}_D$ 复乘的椭圆曲线的同构类集合并非任意的。在理想类群 $\\mathrm{Cl}(\\mathcal{O}_D)$ 与具有 $\\mathcal{O}_D$ 复乘的椭圆曲线的同构类集合之间存在一个典范双射。一个理想类 $[\\mathfrak{a}] \\in \\mathrm{Cl}(\\mathcal{O}_D)$ 对应于椭圆曲线 $\\mathbb{C}/\\mathfrak{a}$ 的同构类。两个这样的曲线 $\\mathbb{C}/\\mathfrak{a}$ 和 $\\mathbb{C}/\\mathfrak{b}$ 同构，当且仅当理想 $\\mathfrak{a}$ 和 $\\mathfrak{b}$ 属于同一个理想类。\n\n5. 综合以上事实，具有 $\\mathcal{O}_D$ 复乘的椭圆曲线的不同同构类的数量等于类群的阶，即 $h(D) = |\\mathrm{Cl}(\\mathcal{O}_D)|$。由于 $\\mathbb{C}$ 上的同构类与其 $j$-不变量一一对应，因此可得，具有 $\\mathcal{O}_D$ 复乘的椭圆曲线的不同 $j$-不变量的数量恰好是 $h(D)$。\n\n在我们的例子中，我们发现 $h(-3) = 1$, $h(-4) = 1$, $h(-7) = 1$ 和 $h(-8) = 1$。这意味着对于相应的序 $\\mathcal{O}_{-3}$, $\\mathcal{O}_{-4}$, $\\mathcal{O}_{-7}$ 和 $\\mathcal{O}_{-8}$，都只存在一个具有该序复乘的椭圆曲线同构类，因此只有一个唯一的 $j$-不变量。例如：\n- 对于 $D=-3$，序为 $\\mathcal{O}_{-3}=\\mathbb{Z}[\\frac{1+\\sqrt{-3}}{2}]$。对应的 $j$-不变量是 $j(\\frac{1+\\sqrt{-3}}{2}) = 0$。\n- 对于 $D=-4$，序为 $\\mathcal{O}_{-4}=\\mathbb{Z}[\\sqrt{-1}]$。对应的 $j$-不变量是 $j(i) = 1728$。\n由 $\\mathcal{O}_D$ 复乘产生的不同 $j$-不变量的数量为 $h(D)$，我们是通过计算既约二次型的数量得到该值的。这为这两个计数之间提供了一座直接的桥梁。\n\n最终答案是由计算出的类数组成的行向量。\n$h(-3)=1$\n$h(-4)=1$\n$h(-7)=1$\n$h(-8)=1$\n所以该向量是 $(1, 1, 1, 1)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 & 1 & 1 & 1\n\\end{pmatrix}\n}\n$$", "id": "3010294"}, {"introduction": "在我们理解了如何计算CM椭圆曲线的“数量”之后，下一步自然是去计算一些最著名例子的实际“数值”。这两个标志性的奇异模（singular moduli），$j(i)=1728$ 和 $j(\\zeta_3)=0$，在数论中无处不在。本练习将引导你利用对应格的独特对称性，从第一性原理出发推导出这些值，揭示几何对称性如何直接导致格不变量 $g_2$ 或 $g_3$ 为零，从而确定这些特殊的 $j$-不变量值 [@problem_id:3010320]。", "problem": "设 $\\tau$ 为复上半平面的一个元素，并令 $E_{\\tau} = \\mathbf{C}/(\\mathbf{Z} + \\tau \\mathbf{Z})$ 为对应的复椭圆曲线。使用 Weierstrass $\\wp$-函数和相关的不变量，从 $E_{\\tau}$ 的格不变量定义了绝对不变量 $j(\\tau)$，它在 $\\mathrm{SL}_{2}(\\mathbf{Z})$ 的作用下是不变的。从格不变量和绝对不变量的定义出发（不假设任何特殊值），利用 $\\tau = i$ 和 $\\tau = \\zeta_{3}$（一个本原三次单位根）时格的旋转对称性来计算 $j(i)$ 和 $j(\\zeta_{3})$。然后，找出具有这些 $j$-不变量的椭圆曲线在 $\\mathbf{C}$ 上的显式短 Weierstrass 模型，并通过将你的模型与相应的格和对称性联系起来，来论证你的模型实现了所需的不变量。\n\n你的最终数值答案应为有序对 $\\big(j(i), j(\\zeta_{3})\\big)$，以行向量的形式呈现。无需四舍五入。", "solution": "该问题要求计算 $j$-不变量 $j(i)$ 和 $j(\\zeta_3)$，并找出相应的椭圆曲线模型。我们首先回顾基本定义。\n\n对于复上半平面 $\\mathbb{H}$ 中的 $\\tau$，其对应的格为 $\\Lambda_{\\tau} = \\mathbb{Z} + \\tau\\mathbb{Z}$。与格 $\\Lambda$ 相关联的 Weierstrass 不变量，或称 Eisenstein 级数，由以下公式给出：\n$$g_2(\\Lambda) = 60 \\sum_{\\omega \\in \\Lambda \\setminus \\{0\\}} \\frac{1}{\\omega^4}$$\n$$g_3(\\Lambda) = 140 \\sum_{\\omega \\in \\Lambda \\setminus \\{0\\}} \\frac{1}{\\omega^6}$$\n这些不变量取决于格的选择。绝对不变量，或称 $j$-不变量，是根据 $g_2$ 和 $g_3$ 定义的：\n$$j(\\Lambda) = 1728 \\frac{g_2(\\Lambda)^3}{g_2(\\Lambda)^3 - 27 g_3(\\Lambda)^2}$$\n分母是格的判别式 $\\Delta(\\Lambda) = g_2(\\Lambda)^3 - 27 g_3(\\Lambda)^2$，对于任何格 $\\Lambda$ 它都非零。我们将 $g_2(\\Lambda_\\tau)$ 记为 $g_2(\\tau)$，$g_3$ 和 $j$ 也类似。\n\n这些不变量的一个关键性质是它们的齐次性。对于任何非零复数 $c \\in \\mathbb{C}^*$，缩放后的格 $c\\Lambda$ 的不变量与 $\\Lambda$ 的不变量有如下关系：\n$$g_2(c\\Lambda) = c^{-4} g_2(\\Lambda)$$\n$$g_3(c\\Lambda) = c^{-6} g_3(\\Lambda)$$\n\n如果椭圆曲线 $E_{\\Lambda} = \\mathbb{C}/\\Lambda$ 的自同态环严格大于 $\\mathbb{Z}$，则称其具有复乘（CM）。这种情况发生当且仅当格 $\\Lambda$ 具有旋转对称性，即存在一个非整数 $\\alpha \\in \\mathbb{C}$ 使得 $\\alpha\\Lambda \\subseteq \\Lambda$。$\\tau=i$ 和 $\\tau=\\zeta_3$ 就是典范的例子。\n\n**$j(i)$ 的计算**\n\n令 $\\tau = i$。对应的格是 $\\Lambda_i = \\mathbb{Z} + i\\mathbb{Z} = \\mathbb{Z}[i]$，即高斯整数环。该格在乘以 $i$ 时保持不变，因为 $i\\Lambda_i = i(\\mathbb{Z} + i\\mathbb{Z}) = i\\mathbb{Z} + i^2\\mathbb{Z} = i\\mathbb{Z} - \\mathbb{Z} = \\mathbb{Z} + i\\mathbb{Z} = \\Lambda_i$。该格表现出4阶旋转对称性。\n\n我们对格 $\\Lambda_i$ 和缩放因子 $c=i$ 应用齐次性：\n$$g_2(i) = g_2(\\Lambda_i) = g_2(i\\Lambda_i) = i^{-4} g_2(\\Lambda_i) = 1 \\cdot g_2(\\Lambda_i) = g_2(i)$$\n这个关系式是一个重言式，没有提供关于 $g_2(i)$ 的任何信息。\n$$g_3(i) = g_3(\\Lambda_i) = g_3(i\\Lambda_i) = i^{-6} g_3(\\Lambda_i) = (i^2)^3 g_3(\\Lambda_i) = (-1)^3 g_3(\\Lambda_i) = -g_3(i)$$\n关系式 $g_3(i) = -g_3(i)$ 蕴含 $2g_3(i)=0$，所以 $g_3(i)=0$。\n\n现在我们可以计算 $j$-不变量 $j(i)$：\n$$j(i) = 1728 \\frac{g_2(i)^3}{g_2(i)^3 - 27 g_3(i)^2} = 1728 \\frac{g_2(i)^3}{g_2(i)^3 - 27 (0)^2} = 1728 \\frac{g_2(i)^3}{g_2(i)^3}$$\n由于 $\\tau = i$ 在复上半平面，判别式 $\\Delta(i) = g_2(i)^3 - 27g_3(i)^2 = g_2(i)^3$ 非零。这蕴含 $g_2(i) \\neq 0$。因此，我们可以消去 $g_2(i)^3$ 项，得到：\n$$j(i) = 1728$$\n\n**$j(\\zeta_3)$ 的计算**\n\n令 $\\tau = \\zeta_3 = e^{2\\pi i/3} = -\\frac{1}{2} + i\\frac{\\sqrt{3}}{2}$，这是一个本原三次单位根，满足 $\\zeta_3^2+\\zeta_3+1=0$ 和 $\\zeta_3^3=1$。其对应的格是 $\\Lambda_{\\zeta_3} = \\mathbb{Z} + \\zeta_3\\mathbb{Z} = \\mathbb{Z}[\\zeta_3]$，即 Eisenstein 整数环。该格在乘以 $\\zeta_3$ 时保持不变：\n$\\zeta_3 \\Lambda_{\\zeta_3} = \\zeta_3(\\mathbb{Z} + \\zeta_3\\mathbb{Z}) = \\zeta_3\\mathbb{Z} + \\zeta_3^2\\mathbb{Z} = \\zeta_3\\mathbb{Z} + (-1-\\zeta_3)\\mathbb{Z} = \\mathbb{Z} + \\zeta_3\\mathbb{Z} = \\Lambda_{\\zeta_3}$。该格具有3阶旋转对称性（如果包括取负运算，则为6阶）。\n\n我们对格 $\\Lambda_{\\zeta_3}$ 和缩放因子 $c=\\zeta_3$ 应用齐次性：\n$$g_2(\\zeta_3) = g_2(\\Lambda_{\\zeta_3}) = g_2(\\zeta_3\\Lambda_{\\zeta_3}) = (\\zeta_3)^{-2} g_2(\\Lambda_{\\zeta_3}) = \\zeta_3 g_2(\\Lambda_{\\zeta_3})$$\n关系式 $g_2(\\zeta_3) = \\zeta_3 g_2(\\zeta_3)$ 可以重写为 $(1-\\zeta_3)g_2(\\zeta_3) = 0$。由于 $\\zeta_3 \\neq 1$，我们必然有 $g_2(\\zeta_3) = 0$。\n$$g_3(\\zeta_3) = g_3(\\Lambda_{\\zeta_3}) = g_3(\\zeta_3\\Lambda_{\\zeta_3}) = (\\zeta_3)^{-6} g_3(\\Lambda_{\\zeta_3}) = (\\zeta_3^3)^{-2} g_3(\\Lambda_{\\zeta_3}) = 1^{-2}g_3(\\Lambda_{\\zeta_3}) = g_3(\\zeta_3)$$\n这个关系式是一个重言式。\n\n现在我们计算 $j$-不变量 $j(\\zeta_3)$：\n$$j(\\zeta_3) = 1728 \\frac{g_2(\\zeta_3)^3}{g_2(\\zeta_3)^3 - 27 g_3(\\zeta_3)^2} = 1728 \\frac{0^3}{0^3 - 27 g_3(\\zeta_3)^2} = 1728 \\frac{0}{-27 g_3(\\zeta_3)^2}$$\n由于 $\\tau = \\zeta_3$ 在复上半平面，判别式 $\\Delta(\\zeta_3) = g_2(\\zeta_3)^3 - 27g_3(\\zeta_3)^2 = -27g_3(\\zeta_3)^2$ 非零。这蕴含 $g_3(\\zeta_3) \\neq 0$。因此，该表达式的计算结果为：\n$$j(\\zeta_3) = 0$$\n\n**Weierstrass 模型**\n\n在 $\\mathbb{C}$ 上的一个短 Weierstrass 方程形式为 $y^2 = x^3 + Ax + B$。其 $j$-不变量由公式 $j = 1728 \\frac{4A^3}{4A^3 + 27B^2}$ 给出。\n\n对于 $j(i) = 1728$：\n我们寻找系数 $A, B$ 使得 $1728 = 1728 \\frac{4A^3}{4A^3 + 27B^2}$。这可以化简为 $1 = \\frac{4A^3}{4A^3 + 27B^2}$，蕴含 $4A^3 = 4A^3 + 27B^2$，所以 $27B^2 = 0$，即 $B=0$。为了使曲线非奇异（即 $j$-不变量是良定义的），$4A^3+27B^2 \\neq 0$，这要求 $A \\neq 0$。最简单的选择是 $A=1$。\n因此，一个显式模型是椭圆曲线 $E_i: y^2 = x^3 + x$。\n这个模型的合理性在于它与格对称性的联系。与格 $\\Lambda_i$ 对应的曲线有 $g_3(i)=0$。我们选择的 $B=0$ 模型与任何由 $g_3=0$ 的格定义的曲线同构。该曲线的自同态环是 $\\mathbb{Z}[i]$，与格的对称性相对应。其非平凡自同构是乘以 $i$，它作为4阶自同构作用于曲线坐标：$[i]: (x,y) \\mapsto (-x, iy)$。我们可以验证这一点：$(iy)^2 = (-x)^3 + (-x) \\implies -y^2 = -x^3 - x \\implies y^2 = x^3+x$。\n\n对于 $j(\\zeta_3) = 0$：\n我们寻找系数 $A, B$ 使得 $0 = 1728 \\frac{4A^3}{4A^3 + 27B^2}$。这蕴含 $4A^3 = 0$，所以 $A=0$。为了保证非奇异性，$4A^3+27B^2 \\neq 0$，这要求 $B \\neq 0$。最简单的选择是 $B=1$。\n因此，一个显式模型是椭圆曲线 $E_{\\zeta_3}: y^2 = x^3 + 1$。\n这个模型的合理性在于它与格对称性的联系。与格 $\\Lambda_{\\zeta_3}$ 对应的曲线有 $g_2(\\zeta_3)=0$。我们选择的 $A=0$ 模型与任何由 $g_2=0$ 的格定义的曲线同构。其自同态环是 $\\mathbb{Z}[\\zeta_3]$。其非平凡自同构是乘以 $\\zeta_3$，它作为3阶自同构作用于曲线坐标：$[\\zeta_3]: (x,y) \\mapsto (\\zeta_3 x, y)$。我们验证这一点：$y^2 = (\\zeta_3 x)^3 + 1 \\implies y^2 = \\zeta_3^3 x^3 + 1 \\implies y^2 = x^3 + 1$。\n\n最终答案是有序对 $(j(i), j(\\zeta_3))$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1728 & 0\n\\end{pmatrix}\n}\n$$", "id": "3010320"}, {"introduction": "当我们掌握了CM $j$-不变量的计算后，便可以探索它们所蕴含的更深层次的算术信息。本练习将带领你从特征零的世界跨越到特征 $p$ 的世界，研究两个著名奇异模之差的素因子分解。通过分析 $j(i)-j(\\exp(2\\pi i/3))$ 这个整数，你将揭示一个深刻的算术现象：它的素因子与那些使得两条相应CM椭圆曲线同时具有超奇异约化（supersingular reduction）的素数 $p$ 密切相关，从而亲身体验CM理论的强大预测能力 [@problem_id:3010305]。", "problem": "设 $\\tau_{1} = i$ 且 $\\tau_{2} = \\exp(2\\pi i/3)$，它们分别对应于唯一的具有复乘（CM）的椭圆曲线，其自同态环分别为判别式为 $-4$ 的 $\\mathbb{Z}[i]$ 和判别式为 $-3$ 的 $\\mathbb{Z}\\left[\\exp(2\\pi i/3)\\right] = \\mathbb{Z}[\\omega]$。回顾对于复上半平面中的一个 CM 点 $\\tau$，其模 $j$-不变量 $j(\\tau)$ 是一个奇异模，因此是一个代数整数。对于这两个基本判别式，相应的类数为 $1$，所以 $j(\\tau_{1})$ 和 $j(\\tau_{2})$ 是有理整数。\n\n仅使用模 $j$-不变量的基本性质和关于类数为 $1$ 的判别式的奇异模的标准事实，确定整数 $j(\\tau_{1}) - j(\\tau_{2})$ 的精确素因子分解。使用来自复乘和椭圆曲线约化理论的局部推理（例如，在特征为 $p$ 时自同态代数的行为），简要解释为何在这种情况下只有小的素数能整除这个差。然后，作为你的最终数值输出，计算 $2$-进赋值 $v_{2}\\!\\left(j(\\tau_{1}) - j(\\tau_{2})\\right)$，其定义为使得 $2^{e}$ 整除 $j(\\tau_{1}) - j(\\tau_{2})$ 的最大整数 $e \\geq 0$。\n\n给出你的最终答案，形式为单个整数，无需四舍五入。", "solution": "### 第1步：提取已知条件\n- $\\tau_{1} = i$ 对应一条椭圆曲线，其具有虚二次域 $\\mathbb{Q}(i)$ 的整数环 $\\mathbb{Z}[i]$ 的复乘（CM）。这个序的判别式是 $d_1 = -4$。\n- $\\tau_{2} = \\exp(2\\pi i/3)$ 对应一条椭圆曲线，其具有虚二次域 $\\mathbb{Q}(\\sqrt{-3})$ 的整数环 $\\mathbb{Z}[\\exp(2\\pi i/3)] = \\mathbb{Z}[\\omega]$ 的复乘（CM）。这个序的判别式是 $d_2 = -3$。\n- 类数 $h(d_1)$ 和 $h(d_2)$ 都等于 $1$。\n- $j$-不变量 $j(\\tau_{1})$ 和 $j(\\tau_{2})$ 是奇异模，并且是有理整数。\n- 任务是确定整数 $j(\\tau_{1}) - j(\\tau_{2})$ 的素因子分解，使用CM理论解释为何其素因子是“小的”，并计算 $2$-进赋值 $v_{2}(j(\\tau_{1}) - j(\\tau_{2}))$。\n\n### 第2步：使用提取的已知条件进行验证\n该问题是良定的，并且科学上基于椭圆曲线的复乘理论，这是数论中的一个标准课题。所有提供的信息在事实上都是正确的。\n- 域 $\\mathbb{Q}(i)$ 的判别式为 $-4$，其整数环是 $\\mathbb{Z}[i]$。域 $\\mathbb{Q}(\\sqrt{-3})$ 的判别式为 $-3$，其整数环是 $\\mathbb{Z}[\\exp(2\\pi i/3)]$。\n- 一个已知的结论是，$\\mathbb{Q}(i)$ 和 $\\mathbb{Q}(\\sqrt{-3})$ 的类数都为 $1$。\n- 复乘主定理指出，对于一个对应于虚二次域 $K$ 中序 $\\mathcal{O}$ 的 CM 点 $\\tau$，$j(\\tau)$ 的值是一个代数整数，并且域扩张 $\\mathbb{Q}(j(\\tau))$ 是 $K$ 的希尔伯特类域。当类数为 1 时，希尔伯特类域是 $K$ 本身。由于判别式为有理数，基域为 $\\mathbb{Q}$。因此 $j(\\tau) \\in \\mathbb{Q}$。由于它是一个代数整数，所以它必须是一个有理整数，即 $j(\\tau) \\in \\mathbb{Z}$。\n- 所提出的问题（素因子分解、理论解释和 $p$-进赋值）是标准的数学探究。\n\n问题有效，因为它科学上是合理的、良构的且客观的。\n\n### 第3步：结论与行动\n问题有效。我将继续进行解答。\n\n### 解答\n该问题要求我们分析两个特定的奇异模 $j(\\tau_{1})$ 和 $j(\\tau_{2})$ 之间的差。\n\n首先，我们确定 $j(\\tau_{1}) = j(i)$ 和 $j(\\tau_{2}) = j(\\exp(2\\pi i/3))$ 的整数值。椭圆曲线的 $j$-不变量由其同构类决定。由复环面 $\\mathbb{C}/\\Lambda_{\\tau}$（其中 $\\Lambda_{\\tau} = \\mathbb{Z} + \\tau\\mathbb{Z}$）给出的椭圆曲线 $E$ 有一个自同态环 $\\mathrm{End}(E)$，它同构于序 $\\{\\alpha \\in \\mathbb{C} \\mid \\alpha \\Lambda_{\\tau} \\subseteq \\Lambda_{\\tau}\\}$。这个序的单位构成曲线的自同构群 $\\mathrm{Aut}(E)$。对于一个一般的 $\\tau$，这个群就是 $\\{\\pm 1\\}$。\n\n椭圆曲线的魏尔斯特拉斯方程是 $y^{2} = 4x^{3} - g_{2}x - g_{3}$，其中 $g_{2}$ 和 $g_{3}$ 是爱森斯坦级数，它们是 $\\tau$ 的函数。$j$-不变量由以下公式给出：\n$$j(\\tau) = 1728 \\frac{g_{2}(\\tau)^{3}}{g_{2}(\\tau)^{3} - 27 g_{3}(\\tau)^{2}}$$\n当且仅当 $g_{2}(\\tau)=0$ 或 $g_{3}(\\tau)=0$ 时，曲线有额外的自同构。\n\n对于 $\\tau_{1} = i$，格 $\\mathbb{Z}+i\\mathbb{Z}$ 是高斯整数环 $\\mathbb{Z}[i]$。$\\mathbb{Z}[i]$ 中的单位群是 $\\{\\pm 1, \\pm i\\}$，其阶为 $4$。这意味着对应于 $\\tau_{1}=i$ 的椭圆曲线 $E_{1}$ 有一个阶为 $4$ 的自同构群。当且仅当 $g_{3}=0$ 时，一个魏尔斯特拉斯曲线存在一个阶为 $4$ 的额外自同构（例如 $(x,y) \\mapsto (-x, iy)$）。当 $g_{3}(\\tau_{1})=0$ 时，$j$-不变量的公式得出：\n$$j(\\tau_{1}) = j(i) = 1728 \\frac{g_{2}(i)^{3}}{g_{2}(i)^{3} - 27 \\cdot 0^{2}} = 1728$$\n\n对于 $\\tau_{2} = \\exp(2\\pi i/3) = \\omega$，格 $\\mathbb{Z}+\\omega\\mathbb{Z}$ 是艾森斯坦整数环 $\\mathbb{Z}[\\omega]$。$\\mathbb{Z}[\\omega]$ 中的单位群是 $\\{\\pm 1, \\pm \\omega, \\pm \\omega^{2}\\}$，其阶为 $6$。因此，对应于 $\\tau_{2}=\\omega$ 的椭圆曲线 $E_{2}$ 有一个阶为 $6$ 的自同构群。这当且仅当 $g_{2}=0$ 时发生。当 $g_{2}(\\tau_{2})=0$ 时，$j$-不变量是：\n$$j(\\tau_{2}) = j(\\omega) = 1728 \\frac{0^{3}}{0^{3} - 27 g_{3}(\\omega)^{2}} = 0$$\n\n现在我们计算差值 $j(\\tau_{1}) - j(\\tau_{2})$ 及其素因子分解。\n$$j(\\tau_{1}) - j(\\tau_{2}) = 1728 - 0 = 1728$$\n为了找到 $1728$ 的素因子分解，我们可以识别出 $1728 = 12^{3}$。因为 $12 = 2^{2} \\cdot 3$，我们有：\n$$1728 = (2^{2} \\cdot 3)^{3} = (2^{2})^{3} \\cdot 3^{3} = 2^{6} \\cdot 3^{3}$$\n所以 $j(\\tau_{1}) - j(\\tau_{2})$ 的素因子分解是 $2^{6} \\cdot 3^{3}$。\n\n接下来，我们使用 CM 椭圆曲线的约化理论，为一个什么只有小的素数能整除这个差提供理论解释。一个素数 $p$ 整除 $j(\\tau_{1}) - j(\\tau_{2})$ 当且仅当 $j(\\tau_{1}) \\equiv j(\\tau_{2}) \\pmod{p}$。对于具有良好约化的素数，这个同余式意味着在有限域 $\\mathbb{F}_{p}$ 上的约化椭圆曲线 $\\tilde{E}_{1}$ 和 $\\tilde{E}_{2}$ 在代数闭包 $\\overline{\\mathbb{F}_{p}}$ 上同构。同构的曲线必须有同构的自同态代数，即 $\\mathrm{End}(\\tilde{E}_{1})_{\\overline{\\mathbb{F}_{p}}} \\cong \\mathrm{End}(\\tilde{E}_{2})_{\\overline{\\mathbb{F}_{p}}}$。\n\nCM 曲线 $E$ 在素数 $p$ 处的约化的自同态代数，或者是一个虚二次域中的一个序（如果约化是常态的），或者是一个四元数代数中的一个极大序（如果约化是超奇异的）。\n- 如果约化 $\\tilde{E}_{1}$ 和 $\\tilde{E}_{2}$ 都是常态的，它们的自同态代数将是它们各自的 CM 域 $\\mathbb{Q}(i)$ 和 $\\mathbb{Q}(\\sqrt{-3})$ 中的序。由于这些域不同构，它们的自同态代数不可能同构。因此，这种情况是不可能的。\n- 因此，为了让约化曲线同构，它们必须都是超奇异的。在特征为 $p$ 时，所有超奇异椭圆曲线在 $\\overline{\\mathbb{F}_p}$ 上都同构。\n\n约化的类型由素数 $p$ 在 CM 域中的行为决定。一个具有判别式为 $D$ 的序的 CM 的椭圆曲线在素数 $p$ 处有超奇异约化，当且仅当 $p$ 在二次域 $\\mathbb{Q}(\\sqrt{D})$ 中是惰性的或分歧的。\n1.  对于具有 $\\mathbb{Z}[i]$ 复乘（判别式为 $D_{1}=-4$）的 $E_{1}$，超奇异约化发生在那些在 $\\mathbb{Q}(i)$ 中不分裂的素数 $p$ 处。这些素数 $p$ 满足勒让德符号 $(\\frac{-4}{p}) \\neq 1$。此条件简化为 $(\\frac{-1}{p}) \\neq 1$，这意味着 $p=2$（分歧）或 $p \\equiv 3 \\pmod{4}$（惰性）。\n2.  对于具有 $\\mathbb{Z}[\\omega]$ 复乘（判别式为 $D_{2}=-3$）的 $E_{2}$，超奇异约化发生在那些在 $\\mathbb{Q}(\\sqrt{-3})$ 中不分裂的素数 $p$ 处。这些素数 $p$ 满足 $(\\frac{-3}{p}) \\neq 1$。这意味着 $p=3$（分歧）或 $p \\equiv 2 \\pmod{3}$（惰性）。\n\n要让一个素数 $p$ 整除 $j(\\tau_{1}) - j(\\tau_{2})$，它必须是两条曲线的超奇异约化素数。因此，$p$ 必须同时满足两组条件。\n- $p=2$ 在 $\\mathbb{Q}(i)$ 和 $\\mathbb{Q}(\\sqrt{-3})$ 中是不分裂的。\n- $p=3$ 在 $\\mathbb{Q}(i)$ 和 $\\mathbb{Q}(\\sqrt{-3})$ 中是不分裂的。\n- 对于 $p>3$，$p$ 必须满足 $p \\equiv 3 \\pmod{4}$ 和 $p \\equiv 2 \\pmod{3}$。根据中国剩余定理，这等价于 $p \\equiv 11 \\pmod{12}$。\n\n这个理论严格地将 $j(\\tau_{1}) - j(\\tau_{2})$ 的可能素因子限制在集合 $\\{2, 3, 11, 23, \\dots\\}$ 中。在这个意义上，只有“小的”素数或来自一个特定的、稀疏的算术级数的素数可以是因子。我们的显式计算 $j(\\tau_{1}) - j(\\tau_{2}) = 2^{6} \\cdot 3^{3}$ 证实了只有最小的可能素数 $2$ 和 $3$ 实际整除了这个差值。\n\n最后，我们计算 $2$-进赋值 $v_{2}(j(\\tau_{1}) - j(\\tau_{2}))$。$p$-进赋值 $v_{p}(n)$ 是整除整数 $n$ 的素数 $p$ 的最高次幂的指数。从素因子分解 $j(\\tau_{1}) - j(\\tau_{2}) = 1728 = 2^{6} \\cdot 3^{3}$，我们可以直接读出 $2$ 的指数。\n$$v_{2}(j(\\tau_{1}) - j(\\tau_{2})) = v_{2}(2^{6} \\cdot 3^{3}) = 6$$\n使得 $2^e$ 整除 $1728$ 的最大整数 $e$ 是 $6$。", "answer": "$$\\boxed{6}$$", "id": "3010305"}]}