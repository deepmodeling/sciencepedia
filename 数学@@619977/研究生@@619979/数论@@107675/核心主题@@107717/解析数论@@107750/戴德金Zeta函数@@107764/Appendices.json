{"hands_on_practices": [{"introduction": "第一个练习旨在全面演练戴德金zeta函数的基本构造。通过为一个特定的三次数值域计算关键不变量和局部欧拉因子，您将亲身体验一个域的算术性质（素数分解）如何直接转化为其zeta函数的解析结构，从而巩固您从第一原理出发处理数域理论的能力。[@problem_id:3010964]", "problem": "设 $K = \\mathbb{Q}(\\alpha)$ 是通过添加不可约多项式 $f(x) = x^{3} - x^{2} - 2 x + 1 \\in \\mathbb{Z}[x]$ 的一个根 $\\alpha$ 定义的三次代数体。利用关于判别式、嵌入和通过模素数约化进行素理想分解的基本事实，从第一性原理出发，确定 $K$ 的下列不变量：\n\n1. $K$的绝对判别式 $d_{K}$。\n2. $K$的符号差 $(r_{1}, r_{2})$，其中 $r_{1}$ 是实嵌入的个数，$r_{2}$ 是共轭复嵌入对的个数。\n3. 对于每个有理素数 $p \\in \\{2,3,5,7,11,13\\}$，通过将 $f(x)$ 模 $p$ 分解并推断分裂类型和剩余次数，求出 Dedekind zeta 函数 $\\zeta_{K}(s)$ 在 $p$ 处的欧拉因子 $E_{p}(s)$，其定义为 $E_{p}(s) = \\prod_{\\mathfrak{p} \\mid p} \\left(1 - N\\mathfrak{p}^{-s}\\right)^{-1}$。\n\n将您的最终答案以单行矩阵的形式报告，其中依次包含 $d_{K}$、$r_{1}$、$r_{2}$ 的值，以及对于 $p \\in \\{2,3,5,7,11,13\\}$ 的六个欧拉因子 $E_{p}(s)$（表示为 $p^{-s}$ 的显式有理函数）。不需要数值近似，也不涉及单位。", "solution": "问题要求确定由不可约多项式 $f(x) = x^{3} - x^{2} - 2 x + 1$ 定义的三次代数体 $K = \\mathbb{Q}(\\alpha)$ 的几个不变量。\n\n首先，我们验证问题陈述的合理性。多项式 $f(x)$ 声称在 $\\mathbb{Q}$ 上是不可约的。根据有理根定理，任何可能的有理根都必须是常数项 $1$ 的因数，因此候选根为 $\\pm 1$。我们计算 $f(1) = 1^{3} - 1^{2} - 2(1) + 1 = -1 \\neq 0$ 和 $f(-1) = (-1)^{3} - (-1)^{2} - 2(-1) + 1 = -1 - 1 + 2 + 1 = 1 \\neq 0$。由于 $f(x)$ 没有有理根且次数为 $3$，因此它在 $\\mathbb{Q}$ 上是不可约的。该问题是良定的，并且基于标准的代数数论。\n\n我们接下来确定所求的不变量。\n\n**1. $K$ 的符号差 $(r_1, r_2)$**\n\n符号差 $(r_1, r_2)$ 由实嵌入的个数 $r_1$ 和共轭复嵌入对的个数 $r_2$ 组成。$r_1$ 的数量等于极小多项式 $f(x)$ 的实根个数。我们在实数轴上分析函数 $f(x)$。我们计算它在几个整数点处的值：\n$f(-2) = (-2)^3 - (-2)^2 - 2(-2) + 1 = -8 - 4 + 4 + 1 = -7$。\n$f(-1) = (-1)^3 - (-1)^2 - 2(-1) + 1 = -1 - 1 + 2 + 1 = 1$。\n$f(0) = 0^3 - 0^2 - 2(0) + 1 = 1$。\n$f(1) = 1^3 - 1^2 - 2(1) + 1 = -1$。\n$f(2) = 2^3 - 2^2 - 2(2) + 1 = 8 - 4 - 4 + 1 = 1$。\n\n根据介值定理，因为 $f(-2) < 0$ 且 $f(-1) > 0$，所以在区间 $(-2, -1)$ 内存在一个根。\n因为 $f(0) > 0$ 且 $f(1) < 0$，所以在区间 $(0, 1)$ 内存在一个根。\n因为 $f(1) < 0$ 且 $f(2) > 0$，所以在区间 $(1, 2)$ 内存在一个根。\n\n由于一个三次多项式最多有 $3$ 个实根，我们已经找到了所有的实根。因此，有 $r_1 = 3$ 个实嵌入。扩张次数为 $n = [K:\\mathbb{Q}] = 3$。符号差必须满足 $n = r_1 + 2r_2$。代入数值，我们得到 $3 = 3 + 2r_2$，这意味着 $2r_2 = 0$，所以 $r_2 = 0$。$K$ 的符号差是 $(r_1, r_2) = (3, 0)$。这表明 $K$ 是一个全实域。\n\n**2. $K$ 的绝对判别式 $d_K$**\n\n首先，我们计算多项式 $f(x) = x^3 - x^2 - 2x + 1$ 的判别式。对于一般的三次多项式 $x^3 + ax^2 + bx + c$，判别式由公式 $\\Delta = a^2b^2 - 4b^3 - 4a^3c - 27c^2 + 18abc$ 给出。对于 $f(x)$，我们有 $a=-1$，$b=-2$ 和 $c=1$。\n$\\text{disc}(f) = (-1)^2(-2)^2 - 4(-2)^3 - 4(-1)^3(1) - 27(1)^2 + 18(-1)(-2)(1)$\n$= (1)(4) - 4(-8) - 4(-1)(1) - 27 + 36$\n$= 4 + 32 + 4 - 27 + 36 = 76 - 27 = 49 = 7^2$。\n\n多项式的判别式 $\\text{disc}(f)$ 与数域的绝对判别式 $d_K$ 通过公式 $\\text{disc}(f) = [\\mathcal{O}_K : \\mathbb{Z}[\\alpha]]^2 d_K$ 相关联，其中 $\\mathcal{O}_K$ 是 $K$ 的整数环。\n$49 = [\\mathcal{O}_K : \\mathbb{Z}[\\alpha]]^2 d_K$。\n这意味着 $d_K$ 必须是 $49$ 的一个因数。由于 $K \\neq \\mathbb{Q}$，我们必须有 $|d_K| > 1$。判别式的符号由 $(-1)^{r_2}$ 给出。因为 $r_2=0$，所以 $d_K > 0$。$49$ 的正因数是 $1, 7, 49$。因此，$d_K$ 可能是 $7$ 或 $49$。\n根据 Stickelberger 定理，一个数域的判别式必须模 $4$ 同余于 $0$ 或 $1$。\n$7 \\equiv 3 \\pmod 4$，所以 $d_K \\neq 7$。\n$49 \\equiv 1 \\pmod 4$，这是一个有效的可能性。\n因此，唯一的可能性是 $d_K=49$。\n这意味着 $[\\mathcal{O}_K : \\mathbb{Z}[\\alpha]]^2 = 1$，所以指数为 $1$。这表示整环 $\\mathbb{Z}[\\alpha]$ 是极大整环，因此 $\\mathcal{O}_K = \\mathbb{Z}[\\alpha]$。\n\n**3. 对于 $p \\in \\{2,3,5,7,11,13\\}$ 的欧拉因子 $E_p(s)$**\n\n由于 $\\mathcal{O}_K = \\mathbb{Z}[\\alpha]$，我们可以使用 Dedekind-Kummer 定理，通过将多项式 $f(x)$ 模 $p$ 分解来确定素理想 $(p)$ 的分解。如果 $f(x) \\equiv \\prod_{i=1}^{k} g_i(x)^{e_i} \\pmod p$ 是在 $\\mathbb{F}_p$ 上分解为次数为 $f_i = \\deg(g_i)$ 的不同不可约多项式 $g_i(x)$ 的形式，那么 $(p) = \\prod_{i=1}^{k} \\mathfrak{p}_i^{e_i}$，其中 $\\mathfrak{p}_i$ 是范数为 $N(\\mathfrak{p}_i) = p^{f_i}$ 的素理想。欧拉因子则为 $E_p(s) = \\prod_{i=1}^{k} (1 - N(\\mathfrak{p}_i)^{-s})^{-1} = \\prod_{i=1}^{k} (1 - p^{-f_i s})^{-1}$。\n\n- **情况 $p=2$**：$f(x) \\equiv x^3 - x^2 - 2x + 1 \\equiv x^3 + x^2 + 1 \\pmod 2$。\n在 $\\mathbb{F}_2$ 中检验根：$f(0) \\equiv 1$，$f(1) \\equiv 1+1+1=1$。没有根，所以 $f(x)$ 模 $2$ 不可约。\n这对应于一个次数为 $f_1=3$ 的不可约因子。理想 $(2)$ 是惰性的。\n$E_2(s) = (1 - 2^{-3s})^{-1}$。\n\n- **情况 $p=3$**：$f(x) \\equiv x^3 - x^2 - 2x + 1 \\equiv x^3 - x^2 + x + 1 \\pmod 3$。\n在 $\\mathbb{F}_3$ 中检验根：$f(0) \\equiv 1$，$f(1) \\equiv 1-1+1+1=2$，$f(2) \\equiv 8-4+2+1=7 \\equiv 1$。没有根，所以 $f(x)$ 模 $3$ 不可约。\n这对应于一个次数为 $f_1=3$ 的不可约因子。理想 $(3)$ 是惰性的。\n$E_3(s) = (1 - 3^{-3s})^{-1}$。\n\n- **情况 $p=5$**：$f(x) \\equiv x^3 - x^2 - 2x + 1 \\pmod 5$。\n在 $\\mathbb{F}_5$ 中检验根：$f(0) \\equiv 1, f(1) \\equiv -1, f(2) \\equiv 1, f(3) \\equiv 3, f(4) \\equiv 1$。没有根，所以 $f(x)$ 模 $5$ 不可约。\n这对应于一个次数为 $f_1=3$ 的不可约因子。理想 $(5)$ 是惰性的。\n$E_5(s) = (1 - 5^{-3s})^{-1}$。\n\n- **情况 $p=7$**：$f(x) \\equiv x^3 - x^2 - 2x + 1 \\pmod 7$。由于 $d_K=49$，我们预期 $p=7$ 会分歧。\n我们来找根：$f(5) = 125 - 25 - 10 + 1 = 91 = 13 \\times 7 \\equiv 0 \\pmod 7$。所以 $(x-5)$ 是一个因子。\n$f(x) = x^3-x^2-2x+1 \\equiv x^3+6x^2+5x+1 \\pmod 7$。\n除以 $(x-5) \\equiv x+2$：$(x^3+6x^2+5x+1) = (x+2)(x^2+4x+4)=(x+2)(x+2)^2=(x+2)^3$。\n所以 $f(x) \\equiv (x-5)^3 \\pmod 7$。\n这对应于一个次数为 $f_1=1$、指数为 $e_1=3$ 的因子。理想 $(7)$ 是完全分歧的：$(7)=\\mathfrak{p}^3$。$\\mathfrak{p}$ 的范数是 $7^1=7$。\n$E_7(s) = (1 - 7^{-s})^{-1}$。\n\n- **情况 $p=11$**：$f(x) \\equiv x^3 - x^2 - 2x + 1 \\pmod{11}$。\n对 $\\mathbb{F}_{11}$ 中的根进行系统性检查表明没有根：$f(0)=1, f(1)=10, f(2)=1, f(3)=2, f(4)=8, f(5)=3, f(6)=4, f(7)=4, f(8)=6, f(9)=4, f(10)=1$。\n所以 $f(x)$ 模 $11$ 不可约。这对应于一个次数为 $f_1=3$ 的不可约因子。理想 $(11)$ 是惰性的。\n$E_{11}(s) = (1 - 11^{-3s})^{-1}$。\n\n- **情况 $p=13$**：$f(x) \\equiv x^3 - x^2 - 2x + 1 \\pmod{13}$。\n在 $\\mathbb{F}_{13}$ 中检验根：$f(3) = 27 - 9 - 6 + 1 = 13 \\equiv 0 \\pmod{13}$。所以 $(x-3)$ 是一个因子。\n多项式除法：$(x^3 - x^2 - 2x + 1) = (x-3)(x^2 + 2x + 4) \\pmod{13}$。\n二次因子 $q(x) = x^2+2x+4$ 的判别式为 $\\Delta = 2^2 - 4(1)(4) = -12 \\equiv 1 \\pmod{13}$。\n由于判别式是一个平方数 ($1=1^2$)，$q(x)$ 分解为两个不同的线性因子。\n根为 $x = \\frac{-2 \\pm \\sqrt{1}}{2} = \\frac{-2 \\pm 1}{2}$。在 $\\mathbb{F}_{13}$ 中，$2$ 的乘法逆元是 $7$。\n$x_1 = (-1)(7) = -7 \\equiv 6 \\pmod{13}$。\n$x_2 = (-3)(7) = -21 \\equiv 5 \\pmod{13}$。\n所以 $f(x) \\equiv (x-3)(x-5)(x-6) \\pmod{13}$。\n$f(x)$ 完全分裂为三个不同的线性因子。这意味着理想 $(13)$ 分裂为 $(13) = \\mathfrak{p}_1 \\mathfrak{p}_2 \\mathfrak{p}_3$，其中每个 $\\mathfrak{p}_i$ 的范数为 $13^1=13$。\n$E_{13}(s) = (1 - 13^{-s})^{-1}(1 - 13^{-s})^{-1}(1 - 13^{-s})^{-1} = (1 - 13^{-s})^{-3}$。\n\n最终结果汇总在一个单行矩阵中。\n$d_K = 49$\n$(r_1, r_2) = (3, 0)$\n$E_2(s) = (1 - 2^{-3s})^{-1}$\n$E_3(s) = (1 - 3^{-3s})^{-1}$\n$E_5(s) = (1 - 5^{-3s})^{-1}$\n$E_7(s) = (1 - 7^{-s})^{-1}$\n$E_{11}(s) = (1 - 11^{-3s})^{-1}$\n$E_{13}(s) = (1 - 13^{-s})^{-3}$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n49 & 3 & 0 & \\left(1-2^{-3s}\\right)^{-1} & \\left(1-3^{-3s}\\right)^{-1} & \\left(1-5^{-3s}\\right)^{-1} & \\left(1-7^{-s}\\right)^{-1} & \\left(1-11^{-3s}\\right)^{-1} & \\left(1-13^{-s}\\right)^{-3}\n\\end{pmatrix}\n}\n$$", "id": "3010964"}, {"introduction": "本练习将深入探讨分歧这一关键概念，分歧是理想分解理论的核心。您将看到一个素数的分歧行为不仅决定了局部欧拉因子 $E_p(s)$ 的形式，还直接影响了域的全局判别式 $d_K$。这个练习揭示了局部不变量与全局不变量之间的深刻联系。[@problem_id:3010982]", "problem": "设 $K = \\mathbb{Q}(\\alpha)$，其中 $\\alpha$ 是不可约多项式 $f(x) = x^{3} - 5$ 的一个根。考虑素数 $p = 5$。仅使用代数数论中与戴德金 zeta 函数及素数处的局部行为相关的基本原理，确定戴德金 zeta 函数 $\\zeta_{K}(s)$ 在素数 $p$ 处的局部欧拉因子，以及 $K$ 的绝对判别式中 $p$ 的指数。\n\n为此，请按以下步骤进行：\n- 通过使用 $f(x)$ 模 $5$ 的约化及其所蕴含的 p-进结构来证明 $5$ 的分解类型，从而分析 $5$ 在 $\\mathcal{O}_{K}$ 中的 p-进分解行为。由此，确定 $K$ 中位于 $5$ 上方的素理想的个数及其分歧指数和剩余次数。\n- 根据得到的素理想分解，利用戴德金 zeta 函数 $\\zeta_{K}(s)$ 关于素理想和范数的基本定义，构建其欧拉乘积中出现在 $p$ 处的欧拉因子。\n- 从局部驯分歧原理出发，利用在 $p$ 处分歧的局部描述，通过差理想及其范数来确定 $K$ 的绝对判别式中 $p$ 的指数。\n\n与非分歧和惰性情形相比，清晰地描述在 $p$ 处的分歧如何改变欧拉因子，并从局部不变量中确定对判别式的 p-进贡献。你的最终答案必须是由 $\\zeta_{K}(s)$ 在 $p$ 处的欧拉因子和 $K$ 的判别式中 $p$ 的指数组成的有序对，写成一个 $1 \\times 2$ 行矩阵的形式。无需四舍五入。", "solution": "用户希望我分析素数 $p=5$ 在数域 $K = \\mathbb{Q}(\\alpha)$ 中的行为，其中 $\\alpha$ 是不可约多项式 $f(x) = x^3 - 5$ 的一个根。目标是确定戴德金 zeta 函数 $\\zeta_K(s)$ 在 $p=5$ 处的局部欧拉因子，以及 $K$ 的绝对判别式中 $5$ 的指数。\n\n### 步骤 1：素理想分解\n我们首先确定理想 $5\\mathcal{O}_K$ 在域 $K$ 的整数环 $\\mathcal{O}_K$ 中的分解。扩张次数为 $[K:\\mathbb{Q}] = 3$。我们使用 Kummer-Dedekind 定理，该定理将理想 $p\\mathcal{O}_K$ 的分解与最小多项式 $f(x)$ 模 $p$ 的分解联系起来。\n\n$\\alpha$ 的最小多项式是 $f(x) = x^3-5$。我们考虑其模 $p=5$ 的约化：\n$$f(x) \\equiv x^3 - 0 \\pmod{5}$$\n$$f(x) \\equiv x^3 \\pmod{5}$$\n在有限域 $\\mathbb{F}_5[x]$ 中，该多项式分解为 $\\bar{f}(x) = \\bar{g}(x)^e$，其中 $\\bar{g}(x) = x$ 是一个次数为 $1$ 的不可约多项式，指数为 $e=3$。\n\nKummer-Dedekind 定理的适用条件是素数 $p$ 不整除序 $\\mathbb{Z}[\\alpha]$ 在极大序 $\\mathcal{O}_K$ 中的指数，即 $p \\nmid [\\mathcal{O}_K : \\mathbb{Z}[\\alpha]]$。一个更精确的判据是：如果在分解式 $\\bar{f}(x) = \\prod_i \\bar{g}_i(x)^{e_i}$ 中，对于每个指数 $e_i>1$ 的因子 $\\bar{g}_i(x)$，我们都有 $\\bar{g}_i(x)$ 在 $\\mathbb{F}_p[x]$ 中不整除 $\\overline{(f(x)-\\prod_i g_i(x)^{e_i})/p}$，那么 $p$ 就不整除该指数。\n\n在我们的例子中，$\\bar{f}(x) = x^3$，因此只有一个因子 $\\bar{g}(x)=x$，其指数为 $e=3$。设 $g(x)=x$ 是它到 $\\mathbb{Z}[x]$ 的首一提升。\n余项多项式为 $R(x) = f(x) - g(x)^3 = (x^3 - 5) - x^3 = -5$。\n我们考虑多项式 $S(x) = R(x)/p = -5/5 = -1$。\n其模 $5$ 的约化是 $\\bar{S}(x) = -1 \\pmod{5}$。\n该定理的适用条件是 $\\bar{g}(x)$ 在 $\\mathbb{F}_5[x]$ 中不整除 $\\bar{S}(x)$。这里, 我们必须检查 $x$ 是否在 $\\mathbb{F}_5[x]$ 中整除 $-1$。由于 $-1$ 是一个非零常数，所以 $x$ 不整除它。\n因此, 素数 $p=5$ 不整除指数 $[\\mathcal{O}_K : \\mathbb{Z}[\\alpha]]$，Kummer-Dedekind 定理可以直接应用。\n\n分解式 $f(x) \\equiv x^3 \\pmod{5}$ 意味着理想 $5\\mathcal{O}_K$ 分解为单个素理想的幂：\n$$5\\mathcal{O}_K = \\mathfrak{p}^3$$\n$\\mathcal{O}_K$ 中只有一个位于 $5$ 上方的素理想 $\\mathfrak{p}$。\n$\\mathfrak{p}$ 对 $5$ 的分歧指数为 $e(\\mathfrak{p}|5) = 3$。\n$\\mathfrak{p}$ 对 $5$ 的剩余次数为 $f(\\mathfrak{p}|5) = \\deg(\\bar{g}(x)) = \\deg(x) = 1$。\n这证实了基本恒等式 $\\sum e_i f_i = e f = 3 \\cdot 1 = 3 = [K:\\mathbb{Q}]$。由于 $e=3 > 1$，素数 $5$ 是分歧的。由于 $e=3 = [K:\\mathbb{Q}]$，它是完全分歧的。\n\n### 步骤 2：在 $p=5$ 处的欧拉因子\n戴德金 zeta 函数 $\\zeta_K(s)$ 由其在 $\\mathcal{O}_K$ 的所有素理想 $\\mathfrak{q}$ 上的欧拉乘积定义：\n$$\\zeta_K(s) = \\prod_{\\mathfrak{q} \\subset \\mathcal{O}_K} \\frac{1}{1 - N(\\mathfrak{q})^{-s}}$$\n在有理素数 $p$ 处的局部欧拉因子是对应于 $\\mathcal{O}_K$ 中所有位于 $p$ 上方的素理想 $\\mathfrak{p}_i$ 的项的乘积。如果 $p\\mathcal{O}_K = \\prod_{i=1}^r \\mathfrak{p}_i^{e_i}$，则局部因子为：\n$$\\zeta_{K,p}(s) = \\prod_{i=1}^r \\frac{1}{1 - N(\\mathfrak{p}_i)^{-s}}$$\n素理想 $\\mathfrak{p}_i$ 的范数由 $N(\\mathfrak{p}_i) = p^{f_i}$ 给出，其中 $f_i$ 是其剩余次数。\n\n根据步骤 1，对于 $p=5$，我们发现在 $5$ 上方只有一个素理想 $\\mathfrak{p}$（因此 $r=1$），其剩余次数为 $f_1=f=1$。\n该理想的范数是 $N(\\mathfrak{p}) = 5^f = 5^1 = 5$。\n因此，在 $p=5$ 处的欧拉因子是：\n$$\\zeta_{K,5}(s) = \\frac{1}{1 - N(\\mathfrak{p})^{-s}} = \\frac{1}{1 - 5^{-s}}$$\n分歧间接地改变了这个因子。因子的结构取决于素理想的数量 $r$ 及其剩余次数 $f_i$。分歧通过关系式 $\\sum e_i f_i = n$ 约束了 $r$ 和 $f_i$ 的可能取值。例如，如果 $5$ 是非分歧且惰性的（$e=1, f=3, r=1$），则因子将是 $(1-5^{-3s})^{-1}$。如果它是非分歧且完全分裂的（$e=1, f=1, r=3$），则因子将是 $(1-5^{-s})^{-3}$。我们这里完全分歧的情况（$e=3, f=1, r=1$）得到的因子是 $(1-5^{-s})^{-1}$。\n\n### 步骤 3：判别式中 $p=5$ 的指数\n域 $K$ 的绝对判别式 $\\Delta_K$ 是差理想 $\\mathfrak{D}_{K/\\mathbb{Q}}$ 的范数：$|\\Delta_K| = N(\\mathfrak{D}_{K/\\mathbb{Q}})$。\n素数 $p$ 在判别式中的指数 $v_p(\\Delta_K)$ 由希尔伯特公式（也称为戴德金判别式公式）给出：\n$$v_p(\\Delta_K) = \\sum_{\\mathfrak{p}|p} f(\\mathfrak{p}|p) \\cdot v_{\\mathfrak{p}}(\\mathfrak{D}_{K/\\mathbb{Q}})$$\n其中 $v_{\\mathfrak{p}}(\\mathfrak{D}_{K/\\mathbb{Q}})$ 是差理想的素理想分解中 $\\mathfrak{p}$ 的指数。该指数由分歧指数 $e = e(\\mathfrak{p}|p)$ 决定。\n\n如果 $p$ 不整除 $e$，则分歧称为驯分歧。在这种情况下，$v_{\\mathfrak{p}}(\\mathfrak{D}_{K/\\mathbb{Q}}) = e-1$。\n如果 $p$ 整除 $e$，则分歧称为野分歧。\n\n在我们的例子中，对于素数 $p=5$，其上方只有一个素理想 $\\mathfrak{p}$，分歧指数为 $e=3$。由于 $p=5$ 不整除 $e=3$，因此分歧是驯分歧。\n因此，$\\mathfrak{p}$ 在差理想中的指数是：\n$$v_{\\mathfrak{p}}(\\mathfrak{D}_{K/\\mathbb{Q}}) = e-1 = 3-1 = 2$$\n现在，我们可以计算 $5$ 在判别式 $\\Delta_K$ 中的指数。在 $5$ 上方只有一个素理想 $\\mathfrak{p}$，其剩余次数为 $f=1$，差理想指数为 $2$。\n$$v_5(\\Delta_K) = f(\\mathfrak{p}|5) \\cdot v_{\\mathfrak{p}}(\\mathfrak{D}_{K/\\mathbb{Q}}) = 1 \\cdot 2 = 2$$\n$K$ 的绝对判别式中 $5$ 的指数是 $2$。这对应于对判别式绝对值的贡献 $N(\\mathfrak{p}^{v_{\\mathfrak{p}}(\\mathfrak{D})}) = N(\\mathfrak{p})^2 = 5^2$。\n\n最终答案要求是由 $p=5$ 处的欧拉因子和 $K$ 的判别式中 $5$ 的指数组成的有序对。\n欧拉因子是 $\\frac{1}{1-5^{-s}}$。\n判别式中 $5$ 的指数是 $2$。\n这给出有序对 $\\left( \\frac{1}{1-5^{-s}}, 2 \\right)$。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{1-5^{-s}} & 2 \\end{pmatrix}}$$", "id": "3010982"}, {"introduction": "戴德金zeta函数的真正威力在于其能够编码深刻的算术信息。这最后一个练习将理论与计算相结合，要求您通过数值方法来验证素理想定理。您将计算高斯整数环中理想的渐近密度，并亲眼见证它如何被zeta函数 $\\zeta_K(s)$ 在点 $s=1$ 处的留数精确地支配。[@problem_id:3010986]", "problem": "考虑一个数域 $K$ 及其 Dedekind zeta 函数 $\\zeta_K(s)$，对于满足 $\\operatorname{Re}(s) > 1$ 的复变量 $s$，该函数由 Dirichlet 级数定义\n$$\n\\zeta_K(s) \\;=\\; \\sum_{\\mathfrak{a} \\subset \\mathcal{O}_K \\setminus \\{0\\}} \\frac{1}{N\\mathfrak{a}^{\\,s}} \\;=\\; \\sum_{n=1}^{\\infty} \\frac{a_K(n)}{n^{s}},\n$$\n其中 $\\mathcal{O}_K$ 表示 $K$ 的整数环，$N\\mathfrak{a}$ 是理想 $\\mathfrak{a}$ 的绝对范数，$a_K(n)$ 是范数为 $n$ 的非零整理想的个数。定义求和计数函数\n$$\nA_K(x) \\;=\\; \\sum_{n \\le x} a_K(n),\n$$\n它计算 $\\mathcal{O}_K$ 中范数至多为 $x$ 的非零整理想的个数。解析类数公式给出了在 $s=1$ 处的留数，\n$$\n\\operatorname{Res}_{s=1}\\zeta_K(s) \\;=\\; \\frac{2^{r_1}(2\\pi)^{r_2} h_K R_K}{w_K \\sqrt{|d_K|}},\n$$\n其中 $r_1$ 是实嵌入的个数，$r_2$ 是复嵌入的对数，$h_K$ 是类数，$R_K$ 是调节子，$w_K$ 是 $K$ 中单位根的个数，而 $|d_K|$ 是 $K$ 的判别式的绝对值。经典的 Tauber 理论表明，$A_K(x)$ 的主项由留数乘以 $x$ 给出。\n\n你的任务是设计并实现一个程序，从这些核心定义出发，以算术函数的形式推导出 $A_K(x)$ 的可计算表达式，然后对具有整数环 $\\mathbb{Z}[i]$ 的小虚二次域 $K=\\mathbb{Q}(i)$ 进行数值计算。对于该数域，通过解析类数公式确定留数常数 $c_K = \\operatorname{Res}_{s=1}\\zeta_K(s)$，并将 $A_K(x)$ 与主项 $c_K x$ 进行比较。\n\n程序必须：\n- 使用数域 $K=\\mathbb{Q}(i)$，其判别式满足 $d_K = -4$，其不变量 $(r_1,r_2,h_K,R_K,w_K)$ 应在解决方案设计中根据第一性原理确定，并在代码中进行数值使用。\n- 基于从 $\\zeta_K(s)$ 产生的 Dirichlet 级数系数 $a_K(n)$，仅使用 $\\zeta_K(s)$ 的基本性质、Euler 乘积和标准算术函数，推导出 $A_K(x)$ 的一个显式、有限、可计算的公式。推导必须从上述定义开始，而不是从未经证明的快捷恒等式开始。\n- 对下面给出的测试集中的 $x$ 值进行 $A_K(x)$ 的数值计算。\n- 计算比较比率\n$$\nR(x) \\;=\\; \\frac{A_K(x)}{c_K x},\n$$\n该比率表明 $A_K(x)$ 与主项 $c_K x$ 的接近程度。\n\n测试集：\n- $x=1$ (边界情况),\n- $x=2$ (区分奇偶行为的小数值情况),\n- $x=25$ (平方数阈值),\n- $x=100$ (中等情况),\n- $x=1000$ (较大数据情况),\n- $x=10000$ (计算上仍然可行的压力测试情况)。\n\n最终输出格式：\n- 你的程序应生成一行输出，其中包含测试集中按上述顺序排列的 $R(x)$ 值，格式为逗号分隔的列表，并用方括号括起来（例如 $[r_1,r_2,r_3,r_4,r_5,r_6]$）。\n- 这些值必须是标准十进制表示法的浮点形式。不涉及物理单位，因此不需要。", "solution": "该问题要求从第一性原理出发，对高斯数域 $K=\\mathbb{Q}(i)$ 的理想计数函数 $A_K(x)$ 进行分析。这包括三个主要阶段：首先，使用解析类数公式确定 Dedekind zeta 函数 $\\zeta_K(s)$ 在 $s=1$ 处的留数；其次，推导 $\\zeta_K(s)$ 的 Dirichlet 级数系数 $a_K(n)$ 的可计算表达式；最后，实现一个数值算法来计算 $A_K(x)$ 并将其与渐近近似值进行比较。\n\n所讨论的域是 $K = \\mathbb{Q}(i)$，即高斯有理数域。其整数环为 $\\mathcal{O}_K = \\mathbb{Z}[i]$，即高斯整数环。给定的问题陈述是自洽的、科学上合理的且定义明确的。所有定义和任务在代数数论中都是标准的。我们开始进行解答。\n\n**第 1 部分：留数常数 $c_K$ 的确定**\n\n$A_K(x)$ 的渐近展开式中的主项由 $c_K x$ 给出，其中 $c_K = \\operatorname{Res}_{s=1}\\zeta_K(s)$。解析类数公式用域不变量给出了该留数的表达式：\n$$\nc_K = \\frac{2^{r_1}(2\\pi)^{r_2} h_K R_K}{w_K \\sqrt{|d_K|}}\n$$\n我们必须从基本定义出发，确定 $K=\\mathbb{Q}(i)$ 的不变量 $(r_1, r_2, h_K, R_K, w_K, d_K)$。\n\n1.  **次数和嵌入 ($r_1, r_2$)**: 数域扩张 $K/\\mathbb{Q}$ 由最小多项式 $t^2+1=0$ 的根 $i$ 生成。扩张的次数为 $[K:\\mathbb{Q}]=2$。最小多项式的根为 $\\pm i$，两者都是复数。因此，没有实嵌入 ($r_1=0$)，有一对共轭复嵌入 ($r_2=1$)。次数检验 $n = r_1+2r_2$ 满足，即 $2 = 0+2(1)$。\n\n2.  **判别式 ($d_K$)**: 整数环 $\\mathcal{O}_K = \\mathbb{Z}[i]$ 有一个整基 $\\{1, i\\}$。判别式定义为矩阵的行列式的平方，该矩阵的元素是基元素乘积的迹。元素 $a+bi \\in K$ 的迹为 $\\operatorname{Tr}(a+bi) = (a+bi) + (a-bi) = 2a$。\n    - $\\operatorname{Tr}(1 \\cdot 1) = \\operatorname{Tr}(1) = 2$。\n    - $\\operatorname{Tr}(1 \\cdot i) = \\operatorname{Tr}(i) = 0$。\n    - $\\operatorname{Tr}(i \\cdot i) = \\operatorname{Tr}(-1) = -2$。\n    因此判别式为 $d_K = \\det \\begin{pmatrix} 2 & 0 \\\\ 0 & -2 \\end{pmatrix} = -4$。其绝对值为 $|d_K|=4$。\n\n3.  **单位根 ($w_K$)**: $K$ 中的单位根是 $\\mathcal{O}_K = \\mathbb{Z}[i]$ 中同时也是单位的元素。$\\mathbb{Z}[i]$ 的单位是范数 $N(a+bi) = a^2+b^2$ 等于 1 的元素 $a+bi$。方程 $a^2+b^2=1$ 的整数解为 $(a,b) \\in \\{(\\pm 1, 0), (0, \\pm 1)\\}$。这对应于四个元素 $\\{1, -1, i, -i\\}$。因此，单位根的个数为 $w_K=4$。\n\n4.  **类数 ($h_K$)**: 类数 $h_K$ 是 $K$ 的理想类群的阶。环 $\\mathbb{Z}[i]$ 关于范数函数 $N(a+bi) = a^2+b^2$ 是一个欧几里得整环。每个欧几里得整环都是主理想整环 (PID)。在 PID 中，每个理想都是主理想，这意味着理想类群是平凡的。因此，类数为 $h_K=1$。\n\n5.  **调节子 ($R_K$)**: 调节子是衡量单位群“大小”的量。根据 Dirichlet 单位定理，单位群的秩为 $r = r_1+r_2-1$。对于 $K=\\mathbb{Q}(i)$，秩为 $0+1-1=0$。这意味着唯一的单位是单位根。对于秩为零的单位群（这种情况发生在 $\\mathbb{Q}$ 和虚二次域中），根据约定，调节子定义为 $R_K=1$。\n\n将这些不变量代入留数公式：\n$$\nc_K = \\frac{2^{0}(2\\pi)^{1} \\cdot 1 \\cdot 1}{4 \\cdot \\sqrt{4}} = \\frac{2\\pi}{4 \\cdot 2} = \\frac{2\\pi}{8} = \\frac{\\pi}{4}\n$$\n因此，理想个数的渐近近似为 $A_K(x) \\sim \\frac{\\pi}{4}x$。\n\n**第 2 部分：理想计数函数 $a_K(n)$ 的推导**\n\n为了计算 $A_K(x) = \\sum_{n \\le x} a_K(n)$，我们需要系数 $a_K(n)$ 的显式公式，它由 $\\zeta_K(s) = \\sum_{n=1}^\\infty a_K(n)n^{-s}$ 定义。我们从 $\\zeta_K(s)$ 的 Euler 乘积表示开始：\n$$\n\\zeta_K(s) = \\prod_{\\mathfrak{p} \\subset \\mathcal{O}_K} \\left(1 - \\frac{1}{N\\mathfrak{p}^s}\\right)^{-1}\n$$\n其中乘积遍及 $\\mathcal{O}_K = \\mathbb{Z}[i]$ 的所有非零素理想 $\\mathfrak{p}$。这些素理想的结构由有理素数 $p \\in \\mathbb{Z}$ 扩张到 $\\mathbb{Z}[i]$ 时的行为决定。此行为取决于 Legendre 符号 $(\\frac{d_K}{p}) = (\\frac{-4}{p}) = (\\frac{-1}{p})$。\n\n1.  **分歧素数 ($p=2$)**: 如果一个素数 $p$ 整除判别式 $d_K=-4$，它就分歧。这只发生在 $p=2$ 时。在 $\\mathbb{Z}[i]$ 中，我们有分解式 $2 = -i(1+i)^2$。理想分解为 $(2) = (1+i)^2$。在 2 之上只有一个素理想 $\\mathfrak{p}_2 = (1+i)$。其范数为 $N(\\mathfrak{p}_2) = N_{\\mathbb{Q}(i)/\\mathbb{Q}}(1+i) = 1^2+1^2=2$。相应的 Euler 因子是 $(1 - 2^{-s})^{-1}$。\n\n2.  **分裂素数 ($p \\equiv 1 \\pmod 4$)**: 如果 $(\\frac{-1}{p})=1$，即 $p \\equiv 1 \\pmod 4$ 时，一个素数 $p$ 就分裂。这样一个素数会分裂成两个不同素理想的乘积，$(p) = \\mathfrak{p}\\overline{\\mathfrak{p}}$。两个理想的范数均为 $p$。例如，$(5)=(2+i)(2-i)$。这样一个素数所对应的 Euler 因子贡献为 $(1-p^{-s})^{-1}(1-p^{-s})^{-1} = (1-p^{-s})^{-2}$。\n\n3.  **惰性素数 ($p \\equiv 3 \\pmod 4$)**: 如果 $(\\frac{-1}{p})=-1$，即 $p \\equiv 3 \\pmod 4$ 时，一个素数 $p$ 保持为惰性。理想 $(p)$ 本身就是 $\\mathbb{Z}[i]$ 中的一个素理想。其范数为 $N((p)) = |N_{\\mathbb{Q}(i)/\\mathbb{Q}}(p)| = p^2$。相应的 Euler 因子是 $(1 - (p^2)^{-s})^{-1} = (1 - p^{-2s})^{-1}$。\n\n综合这些情况，我们可以将 $\\zeta_K(s)$ 的 Euler 乘积写为：\n$$\n\\zeta_K(s) = (1 - 2^{-s})^{-1} \\prod_{p \\equiv 1 \\pmod 4} (1-p^{-s})^{-2} \\prod_{p \\equiv 3 \\pmod 4} (1-p^{-2s})^{-1}\n$$\n我们现在将其与已知的 L-函数联系起来。Riemann zeta 函数是 $\\zeta(s) = \\prod_p (1-p^{-s})^{-1}$。令 $\\chi_1$ 为模 4 的唯一非主 Dirichlet 特征，定义为：若 $n \\equiv 1 \\pmod 4$，则 $\\chi_1(n) = 1$；若 $n \\equiv 3 \\pmod 4$，则 $\\chi_1(n) = -1$；若 $n$ 是偶数，则 $\\chi_1(n) = 0$。相关的 Dirichlet L-函数是 $L(s, \\chi_1) = \\prod_p (1 - \\chi_1(p)p^{-s})^{-1}$。\n考虑乘积 $\\zeta(s) L(s, \\chi_1)$:\n$$\n\\zeta(s)L(s,\\chi_1) = \\prod_{p} \\left( (1-p^{-s})^{-1} (1-\\chi_1(p)p^{-s})^{-1} \\right)\n$$\n-   对于 $p=2$，$\\chi_1(2)=0$，因子是 $(1-2^{-s})^{-1}$。\n-   对于 $p \\equiv 1 \\pmod 4$，$\\chi_1(p)=1$，因子是 $(1-p^{-s})^{-1}(1-p^{-s})^{-1}=(1-p^{-s})^{-2}$。\n-   对于 $p \\equiv 3 \\pmod 4$，$\\chi_1(p)=-1$，因子是 $(1-p^{-s})^{-1}(1+p^{-s})^{-1}=(1-p^{-2s})^{-1}$。\n\n该乘积与 $\\zeta_K(s)$ 的 Euler 乘积逐项匹配。因此，我们建立了基本恒等式 $\\zeta_K(s) = \\zeta(s) L(s, \\chi_1)$。\n\n两个 Dirichlet 级数乘积的系数由它们各自系数的 Dirichlet 卷积给出。设 $u(n)=1$ 为 $\\zeta(s)$ 的系数函数，$\\chi_1(n)$ 为 $L(s, \\chi_1)$ 的系数函数。那么 $\\zeta_K(s)$ 的系数 $a_K(n)$ 由卷积给出：\n$$\na_K(n) = (u * \\chi_1)(n) = \\sum_{d|n} u(n/d)\\chi_1(d) = \\sum_{d|n} \\chi_1(d)\n$$\n这为 $a_K(n)$ 提供了一个显式、可计算的公式：它是 $\\chi_1(d)$ 对 $n$ 的所有正因数 $d$ 的求和。\n\n**第 3 部分：算法设计和数值评估**\n\n任务是计算 $A_K(x) = \\sum_{n=1}^{\\lfloor x \\rfloor} a_K(n)$ 以及比率 $R(x) = A_K(x) / (c_K x)$，针对几个 $x$ 值。通过迭代 $n$ 直到 $x$ 并找到每个 $n$ 的所有因数来进行直接计算，效率会很低。一种更优的方法是使用类似筛法的方法计算 $a_K(n)$ 在达到所需 $x$ 的最大值（记为 $x_{max}$）之前的所有值。\n\n1.  **$a_K(n)$ 的筛法**：我们为 $a_K(n)$ 的值初始化一个大小为 $x_{max}+1$ 的数组 `a_K_vals`，并全部置零。然后我们从 1 到 $x_{max}$ 遍历每个整数 $d$。对每个 $d$，我们计算 $\\chi_1(d)$。如果 $\\chi_1(d)$ 非零，我们将其值（$\\pm 1$）加到 `a_K_vals[n]` 上，其中 $n$ 是 $d$ 的所有倍数且不大于 $x_{max}$。这样就为每个 $n$ 正确地累加了和 $\\sum_{d|n} \\chi_1(d)$。\n\n2.  **$A_K(x)$ 的累积和**：一旦数组 `a_K_vals` 被填充，求和函数 $A_K(x)$ 的值可以通过对 `a_K_vals` 进行累积求和来高效计算。我们创建一个数组 `A_K_vals`，其中 `A_K_vals[x]` 存储 $\\sum_{n=1}^x a_K(n)$。\n\n3.  **比率的计算**：在预先计算出所有整数直到 $x_{max}$ 的 $A_K(x)$ 值后，我们可以直接查找测试集中每个 $x$ 值的 $A_K(x)$。常数 $c_K = \\pi/4$ 被计算出来。然后为每个测试用例计算比率 $R(x) = A_K(x) / (c_K x)$。\n\n该算法基于推导出的 $a_K(n)$ 公式，高效且准确地计算所需的量。实现将遵循此设计。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of computing the ideal counting function for the Gaussian\n    integers and comparing it to its asymptotic main term.\n    \"\"\"\n    test_cases = [1, 2, 25, 100, 1000, 10000]\n    x_max = max(test_cases)\n\n    # Part 1: Determine the residue constant c_K for K = Q(i).\n    # As derived in the solution, the invariants for K = Q(i) are:\n    # r1=0, r2=1, h_K=1, R_K=1, w_K=4, d_K=-4.\n    # The residue is c_K = (2^r1 * (2*pi)^r2 * h_K * R_K) / (w_K * sqrt(|d_K|))\n    # c_K = (2^0 * (2*pi)^1 * 1 * 1) / (4 * sqrt(4)) = (2*pi) / 8 = pi / 4.\n    c_K = np.pi / 4\n\n    # Part 2: Derive and implement the formula for a_K(n).\n    # As derived, a_K(n) = sum_{d|n} chi_1(d), where chi_1 is the\n    # non-principal Dirichlet character modulo 4.\n\n    def chi_1(d):\n        \"\"\"Computes the Dirichlet character chi_1(d) modulo 4.\"\"\"\n        if d % 2 == 0:\n            return 0\n        if d % 4 == 1:\n            return 1\n        # This covers the d % 4 == 3 case\n        return -1\n\n    # Part 3: Algorithmic implementation.\n    # Use a sieve method to compute a_K(n) for n from 1 to x_max.\n    # a_K_vals[n] will store the value of a_K(n). Index 0 is unused.\n    a_K_vals = np.zeros(x_max + 1, dtype=np.int32)\n\n    for d in range(1, x_max + 1):\n        chi_d = chi_1(d)\n        if chi_d == 0:\n            continue\n        # Add chi_d to a_K(n) for all multiples n of d.\n        for n in range(d, x_max + 1, d):\n            a_K_vals[n] += chi_d\n\n    # Compute the cumulative sum A_K(x) = sum_{n<=x} a_K(n).\n    # A_K_vals[x] will store the value of A_K(x).\n    # np.cumsum computes the cumulative sum. If a_K_vals[0]=0,\n    # then A_K_vals[x] = sum(a_K_vals[0...x]) = sum(a_K_vals[1...x]).\n    A_K_vals = np.cumsum(a_K_vals)\n\n    # Compute the comparison ratios R(x) = A_K(x) / (c_K * x).\n    results = []\n    for x in test_cases:\n        # A_K(x) is stored at index x of our cumulative sum array.\n        A_K_x = A_K_vals[x]\n        \n        # Asymptotic main term approximation\n        main_term = c_K * x\n        \n        # Ratio\n        ratio = A_K_x / main_term\n        results.append(ratio)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "3010986"}]}