{"hands_on_practices": [{"introduction": "解析数论的许多证明都依赖于一种能够“筛选”出特定算术级数中整数的强大工具。本练习的核心是推导狄利克雷特征的一个基本性质——正交关系。通过从基本定义出发，你将亲手证明所有模 $q$ 的特征在整数 $n$ 上的求和如何充当一个探测器，它精确地识别出 $n \\equiv 1 \\pmod{q}$ 的情况，这是将素数计数问题分解到不同级数的关键一步 [@problem_id:3021450]。", "problem": "设 $q \\ge 1$ 是一个固定的整数，模 $q$ 的狄利克雷特征是一个完全积性函数 $\\chi:\\mathbb{Z}\\to\\mathbb{C}$，它以 $q$ 为周期，并且当 $\\gcd(n,q)>1$ 时满足 $\\chi(n)=0$。设 $\\varphi(q)$ 表示欧拉函数，并设 $\\mathbf{1}_{E}$ 表示事件 $E$ 的指示函数（如果 $E$ 成立则为 $1$，否则为 $0$）。对于一个固定的整数 $n$，定义\n$$\nS_q(n)\\;=\\;\\sum_{\\chi \\bmod q} \\chi(n),\n$$\n其中求和遍历所有模 $q$ 的狄利克雷特征。仅从狄利克雷特征的定义和有限阿贝尔群特征的基本性质出发，推导 $S_q(n)$ 的一个显式闭式表达式，该表达式用 $\\varphi(q)$ 和一个依赖于 $n$ 模 $q$ 的剩余类的指示函数来表示，并用最大公约数 $\\gcd(n,q)$ 来解释这个答案。你的最终答案必须是 $S_q(n)$ 的一个单一闭式解析表达式（不需要四舍五入）。", "solution": "问题要求对和式 $S_q(n) = \\sum_{\\chi \\bmod q} \\chi(n)$ 给出一个显式闭式表达式，其中求和遍历固定整数 $q \\ge 1$ 的所有模 $q$ 狄利克雷特征 $\\chi$。推导必须基于狄利克雷特征的基本定义和有限阿贝尔群特征的性质。\n\n设 $G = (\\mathbb{Z}/q\\mathbb{Z})^\\times$ 为模 $q$ 整数的乘法群。这是一个阶为 $|G| = \\varphi(q)$ 的有限阿贝尔群，其中 $\\varphi$ 是欧拉函数。$G$ 的元素是满足 $\\gcd(a,q)=1$ 的剩余类 $[a]$。\n\n模 $q$ 的狄利克雷特征 $\\chi$ 被定义为 $\\mathbb{Z}$ 上的一个函数。当其定义域限制在与 $q$ 互质的整数 $n$ 上时，它充当 $G$ 上的一个群特征。也就是说，$\\chi(n)$ 仅依赖于 $n$ 模 $q$ 的剩余类，并且映射 $[n] \\mapsto \\chi(n)$ 是从 $G$ 到复数乘法群 $\\mathbb{C}^\\times$ 的一个同态。根据定义，对于任何满足 $\\gcd(n,q)>1$ 的 $n$，我们有 $\\chi(n)=0$。所有模 $q$ 的狄利克雷特征的集合在乘法下构成一个群，记为 $\\widehat{G}$，它与 $G$ 同构，因此其阶为 $|\\widehat{G}| = \\varphi(q)$。\n\n我们通过考虑基于 $\\gcd(n,q)$ 值的两种情况来分析和式 $S_q(n)$。\n\n情况 1: $\\gcd(n,q) > 1$。\n根据模 $q$ 狄利克雷特征的定义，如果一个整数 $n$ 与 $q$ 不互质，则对于每个特征 $\\chi \\pmod q$，都有 $\\chi(n)=0$。\n因此，和式 $S_q(n)$ 是所有项都等于 $0$ 的和：\n$$S_q(n) = \\sum_{\\chi \\bmod q} \\chi(n) = \\sum_{\\chi \\bmod q} 0 = 0.$$\n\n情况 2: $\\gcd(n,q) = 1$。\n在这种情况下，$n$ 代表群 $G = (\\mathbb{Z}/q\\mathbb{Z})^\\times$ 中的一个元素。由于 $\\chi(n) \\neq 0$，我们可以使用特征群 $\\widehat{G}$ 的性质。求和遍历 $\\widehat{G}$ 中的所有特征：\n$$S_q(n) = \\sum_{\\chi \\in \\widehat{G}} \\chi(n).$$\n我们现在引用有限阿贝尔群特征的第一正交关系。让我们按要求从基本原理推导这个性质。这个和式的值取决于 $n$ 是否对应于 $G$ 的单位元。$G$ 的单位元是剩余类 $1 \\pmod q$。\n\n子情况 2a: $n \\equiv 1 \\pmod q$。\n由于 $n \\equiv 1 \\pmod q$ 且 $\\gcd(n, q)=1$，$n$ 是 $G$ 的单位元。对于任何群特征 $\\chi$，它是一个同态，所以 $\\chi(1)=1$。复数值 $\\chi(n)$ 依赖于 $n$ 模 $q$ 的剩余类，因此 $\\chi(n)=\\chi(1)=1$。\n和式变为：\n$$S_q(n) = \\sum_{\\chi \\in \\widehat{G}} 1.$$\n模 $q$ 的狄利克雷特征的数量是 $|\\widehat{G}| = \\varphi(q)$。\n因此，当 $n \\equiv 1 \\pmod q$ 时，\n$$S_q(n) = \\varphi(q).$$\n\n子情况 2b: $n \\not\\equiv 1 \\pmod q$。\n由于 $\\gcd(n,q)=1$ 且 $n \\not\\equiv 1 \\pmod q$，$n$ 代表群 $G$ 中的一个非单位元。有限阿贝尔群特征的一个基本性质是它们可以区分点。这意味着对于任何非单位元 $g \\in G$，存在一个特征 $\\psi \\in \\widehat{G}$ 使得 $\\psi(g) \\neq 1$。\n所以，存在一个特征 $\\chi_0 \\in \\widehat{G}$ 使得 $\\chi_0(n) \\neq 1$。\n让我们考虑和式 $S_q(n) = \\sum_{\\chi \\in \\widehat{G}} \\chi(n)$。我们将这个和式乘以非单位复数 $\\chi_0(n)$：\n$$\\chi_0(n) S_q(n) = \\chi_0(n) \\sum_{\\chi \\in \\widehat{G}} \\chi(n) = \\sum_{\\chi \\in \\widehat{G}} \\chi_0(n)\\chi(n).$$\n由于特征是同态，$\\chi_0(n)\\chi(n) = (\\chi_0\\chi)(n)$。特征集 $\\widehat{G}$ 在乘法下构成一个群。对于一个固定的 $\\chi_0$，映射 $\\chi \\mapsto \\chi_0\\chi$ 是群 $\\widehat{G}$ 的一个置换。因此，对所有 $\\chi \\in \\widehat{G}$ 求和等价于对所有特征 $\\chi' = \\chi_0\\chi \\in \\widehat{G}$ 求和。\n$$\\chi_0(n) S_q(n) = \\sum_{\\chi' \\in \\widehat{G}} \\chi'(n) = S_q(n).$$\n这就得到了方程 $(\\chi_0(n) - 1)S_q(n) = 0$。\n根据我们对 $\\chi_0$ 的选择，我们有 $\\chi_0(n) \\neq 1$，这意味着因子 $(\\chi_0(n) - 1)$ 非零。要使乘积为零，必须有 $S_q(n)=0$。\n\n综合所有情况：\n- 如果 $\\gcd(n,q)>1$，那么 $S_q(n)=0$。\n- 如果 $\\gcd(n,q)=1$ 且 $n \\not\\equiv 1 \\pmod q$，那么 $S_q(n)=0$。\n- 如果 $\\gcd(n,q)=1$ 且 $n \\equiv 1 \\pmod q$，那么 $S_q(n)=\\varphi(q)$。\n\n我们可以将这些结果统一成一个单一的表达式。注意到如果 $n \\equiv 1 \\pmod q$，则对某个整数 $k$，有 $n = kq + 1$。根据欧几里得算法，$\\gcd(n,q) = \\gcd(kq+1, q) = \\gcd(1, q) = 1$（因为 $q \\ge 1$）。因此，条件 $n \\equiv 1 \\pmod q$ 自动蕴含了 $\\gcd(n,q)=1$。\n这意味着和式 $S_q(n)$ 非零当且仅当 $n \\equiv 1 \\pmod q$。\n我们可以使用指示函数 $\\mathbf{1}_{E}$ 来表达这一点，当事件 $E$ 为真时该函数为 $1$，否则为 $0$。\n最终的表达式是：\n$$S_q(n) = \\varphi(q) \\cdot \\mathbf{1}_{n \\equiv 1 \\pmod q}.$$\n\n这个结果通常被称为特征的正交关系。它表明，所有特征在一个群元素 $n$ 上的取值之和非零，当且仅当 $n$ 是该群的单位元。\n\n用 $\\gcd(n,q)$ 解释答案：\n表达式 $\\varphi(q) \\mathbf{1}_{n \\equiv 1 \\pmod q}$ 表明，和式 $S_q(n)$ 起到了一个检测特定剩余类 $1 \\pmod q$ 的“检测器”的作用。对于所有不满足 $n \\equiv 1 \\pmod q$ 的整数 $n$，该和式为零。这包括两类这样的整数：\n1. 所有满足 $\\gcd(n,q) > 1$ 的整数 $n$。如前所示，如果 $\\gcd(n,q) > 1$ (且 $q>1$)，那么 $n$ 不可能与 $1$ 模 $q$ 同余，所以指示函数为 $0$。\n2. 所有满足 $\\gcd(n,q) = 1$ 但 $n$ 不是 $(\\mathbb{Z}/q\\mathbb{Z})^\\times$ 中单位元（即 $n \\not\\equiv 1 \\pmod q$）的整数 $n$。\n该和式仅对那些满足严格条件 $n \\equiv 1 \\pmod q$ 的整数 $n$ 非零，取值为 $\\varphi(q)$，这个条件蕴含了 $\\gcd(n,q)=1$。", "answer": "$$\\boxed{\\varphi(q) \\mathbf{1}_{n \\equiv 1 \\pmod{q}}}$$", "id": "3021450"}, {"introduction": "理论概念只有通过具体例子才能变得生动。本练习将带领你从抽象的特征定义走向实践，为模 $q=8$ 具体地构造出所有的狄利克雷特征。通过处理这个虽然小但非循环的群 $(\\mathbb{Z}/8\\mathbb{Z})^{\\times}$，你将深入理解本原特征、诱导特征以及特征的导体和奇偶性等核心概念，为处理更复杂的模打下坚实基础 [@problem_id:3021462]。", "problem": "设 $q$ 是一个正整数，且令 $(\\mathbb{Z}/q\\mathbb{Z})^{\\times}$ 表示模 $q$ 的乘法单位群。一个模 $q$ 的 Dirichlet 特征是一个完全积性函数 $\\chi:\\mathbb{Z}\\to\\mathbb{C}$，该函数以 $q$ 为周期，并满足：若 $\\gcd(n,q)\\neq 1$，则 $\\chi(n)=0$；若 $\\gcd(n,q)=1$，则 $\\chi(n)\\neq 0$。模 $q$ 的 Dirichlet 特征 $\\chi$ 的导子(conductor)是这样一个最小的正整数 $f$，使得 $\\chi$ 是由一个模 $f$ 的本原 Dirichlet 特征所诱导的；等价地，$f$ 是 $\\chi$ 分解所经过的最小模数，并且相关的本原特征从该模数诱导了模 $q$ 的特征 $\\chi$。一个 Dirichlet 特征 $\\chi$ 的奇偶性由 $\\chi(-1)$ 的值决定，若 $\\chi(-1)=1$ 则称 $\\chi$ 为偶特征，若 $\\chi(-1)=-1$ 则称 $\\chi$ 为奇特征。\n\n根据这些定义和 $(\\mathbb{Z}/8\\mathbb{Z})^{\\times}$ 的结构，通过确定其在简化剩余系 $\\{1,3,5,7\\}$ 上的值来构造所有模 8 的 Dirichlet 特征，并为每个特征确定其导子和奇偶性。你的最终答案必须是一个单行矩阵，对每个特征，该矩阵按顺序列出：其四个值 $\\chi(1), \\chi(3), \\chi(5), \\chi(7)$，然后是其导子，以及 $\\chi(-1)$。按以下顺序排列特征：首先是模 8 的主特征，然后是由模 4 诱导的唯一非平凡特征，接着是模 8 的偶本原特征，最后是模 8 的奇本原特征。无需进行舍入。", "solution": "该问题要求构造和刻画所有模 8 的 Dirichlet 特征。这涉及分析模 8 的乘法单位群的结构，构建这些特征，然后确定每个特征的导子和奇偶性。\n\n首先，我们确定模 8 的单位群。该群记为 $(\\mathbb{Z}/8\\mathbb{Z})^{\\times}$，由所有与 8 互质的模 8 剩余类组成。这些剩余类的集合是 $\\{1, 3, 5, 7\\}$。群运算是模 8 乘法。该群的阶为 $\\phi(8) = 8(1-\\frac{1}{2}) = 4$，其中 $\\phi$ 是欧拉函数。\n\n我们来研究一下这个群的结构，我们将其记为 $G$。\n单位元是 $1$。\n非单位元的阶为：\n$3^2 \\equiv 9 \\equiv 1 \\pmod 8$，所以 $3$ 的阶是 $2$。\n$5^2 \\equiv 25 \\equiv 1 \\pmod 8$，所以 $5$ 的阶是 $2$。\n$7^2 \\equiv 49 \\equiv 1 \\pmod 8$，所以 $7$ 的阶是 $2$。\n因为每个非单位元的阶都是 $2$，所以该群是阿贝尔群，且同构于克莱因四元群(Klein four-group)，$C_2 \\times C_2$。\n\n$G$ 的特征群 $\\hat{G}$ 与 $G$ 本身同构，因此存在 4 个不同的模 8 Dirichlet 特征。一个特征 $\\chi: G \\to \\mathbb{C}^\\times$ 是一个同态。对任意元素 $g \\in G$，我们有 $g^2 = 1$。因此，$\\chi(g)^2 = \\chi(g^2) = \\chi(1) = 1$，这意味着 $\\chi(g)$ 必须是 $1$ 或 $-1$。\n\n我们可以选择 $\\{3, 5\\}$ 作为 $G$ 的一个生成元集，因为 $3 \\cdot 5 \\equiv 15 \\equiv 7 \\pmod 8$。一个特征 $\\chi$ 完全由它在这些生成元上的值 $\\chi(3)$ 和 $\\chi(5)$ 决定。由于这两个值都可以是 $1$ 或 $-1$，因此有 $2 \\times 2 = 4$ 个可能的特征。\n\n我们现在通过给生成元赋值来构造这 4 个特征：\n1.  $\\chi_a(3) = 1$, $\\chi_a(5) = 1$。\n    值：$\\chi_a(1)=1$, $\\chi_a(3)=1$, $\\chi_a(5)=1$, $\\chi_a(7)=\\chi_a(3)\\chi_a(5)=1 \\cdot 1 = 1$。\n    在 $\\{1,3,5,7\\}$ 上的值为 $(1, 1, 1, 1)$。\n\n2.  $\\chi_b(3) = -1$, $\\chi_b(5) = 1$。\n    值：$\\chi_b(1)=1$, $\\chi_b(3)=-1$, $\\chi_b(5)=1$, $\\chi_b(7)=\\chi_b(3)\\chi_b(5)=-1 \\cdot 1 = -1$。\n    在 $\\{1,3,5,7\\}$ 上的值为 $(1, -1, 1, -1)$。\n\n3.  $\\chi_c(3) = 1$, $\\chi_c(5) = -1$。\n    值：$\\chi_c(1)=1$, $\\chi_c(3)=1$, $\\chi_c(5)=-1$, $\\chi_c(7)=\\chi_c(3)\\chi_c(5)=1 \\cdot (-1) = -1$。\n    在 $\\{1,3,5,7\\}$ 上的值为 $(1, 1, -1, -1)$。\n\n4.  $\\chi_d(3) = -1$, $\\chi_d(5) = -1$。\n    值：$\\chi_d(1)=1$, $\\chi_d(3)=-1$, $\\chi_d(5)=-1$, $\\chi_d(7)=\\chi_d(3)\\chi_d(5)=(-1) \\cdot (-1) = 1$。\n    在 $\\{1,3,5,7\\}$ 上的值为 $(1, -1, -1, 1)$。\n\n接下来，我们确定每个特征的导子和奇偶性，并按规定顺序排列它们。奇偶性由 $\\chi(-1) = \\chi(7 \\pmod 8)$ 给出。导子是诱导 $\\chi$ 的本原特征的最小模数 $f$。\n\n**特征 1：模 8 的主特征**\n这是值为 $(1, 1, 1, 1)$ 的特征 $\\chi_a$。\n- 奇偶性：$\\chi_a(-1) = \\chi_a(7) = 1$。该特征是偶特征。\n- 导子：该特征由模 1 的平凡特征诱导，而模 1 的平凡特征是本原的。因此，其导子为 $f=1$。\n- 数据：$(\\chi(1), \\chi(3), \\chi(5), \\chi(7)) = (1, 1, 1, 1)$，导子 $1$，$\\chi(-1)=1$。\n\n**特征 2：由模 4 诱导的唯一非平凡特征**\n我们来检查哪个特征是由模 4 诱导的。模 4 的非主特征 $\\psi_1$ 定义为 $\\psi_1(1)=1$ 和 $\\psi_1(3)=-1$。如果对于所有满足 $\\gcd(n,8)=1$ 的 $n$，都有 $\\chi(n) = \\psi_1(n)$，那么模 8 的特征 $\\chi$ 就是由 $\\psi_1$ 诱导的。\n让我们测试我们的特征：\n- 对于 $n=5$，$5 \\equiv 1 \\pmod 4$，所以必须有 $\\chi(5) = \\psi_1(1) = 1$。这排除了 $\\chi_c$ 和 $\\chi_d$。\n- 我们剩下 $\\chi_b$。让我们来完整地验证它。\n$\\chi_b(1) = 1 = \\psi_1(1)$。\n$\\chi_b(3) = -1 = \\psi_1(3)$。\n$\\chi_b(5) = 1$，并且由于 $5 \\equiv 1 \\pmod 4$，$\\psi_1(5) = \\psi_1(1) = 1$。吻合。\n$\\chi_b(7) = -1$，并且由于 $7 \\equiv 3 \\pmod 4$，$\\psi_1(7) = \\psi_1(3) = -1$。吻合。\n所以，值为 $(1, -1, 1, -1)$ 的特征 $\\chi_b$ 是由模 4 的 $\\psi_1$ 诱导的。\n- 导子：模 4 的特征 $\\psi_1$ 是本原的，因为它不是从任何更小的模数（因子 1, 2）诱导的。因此，$\\chi_b$ 的导子为 $f=4$。\n- 奇偶性：$\\chi_b(-1) = \\chi_b(7) = -1$。该特征是奇特征。\n- 数据：$(\\chi(1), \\chi(3), \\chi(5), \\chi(7)) = (1, -1, 1, -1)$，导子 $4$，$\\chi(-1)=-1$。\n\n**特征 3：模 8 的偶本原特征**\n剩下的特征 $\\chi_c$ 和 $\\chi_d$，如对 $\\chi(5)$ 的检查所示，不是由模 4 诱导的。由于 $8$ 的仅有的其他真因子是 $1$ 和 $2$，而从这些模数只能诱导主特征，所以 $\\chi_c$ 和 $\\chi_d$ 必须是模 8 的本原特征。它们的导子是 $f=8$。\n我们需要偶特征，即 $\\chi(-1)=1$。\n- $\\chi_c(-1) = \\chi_c(7) = -1$。这个特征是奇特征。\n- $\\chi_d(-1) = \\chi_d(7) = 1$。这个特征是偶特征。\n所以偶本原特征是 $\\chi_d$，其值为 $(1, -1, -1, 1)$。\n- 数据：$(\\chi(1), \\chi(3), \\chi(5), \\chi(7)) = (1, -1, -1, 1)$，导子 $8$，$\\chi(-1)=1$。\n\n**特征 4：模 8 的奇本原特征**\n这必然是剩下的特征 $\\chi_c$。如前所述，它是模 8 的本原特征。\n它的奇偶性为 $\\chi_c(-1) = \\chi_c(7) = -1$，所以是奇特征。\n值为 $(1, 1, -1, -1)$。\n- 数据：$(\\chi(1), \\chi(3), \\chi(5), \\chi(7)) = (1, 1, -1, -1)$，导子 $8$，$\\chi(-1)=-1$。\n\n我们现在将最终答案组合成一个单行矩阵，按指定顺序列出每个特征的特征值、导子和奇偶性值。\n\n1.  模 8 主特征：$(1, 1, 1, 1)$，导子 $1$，$\\chi(-1)=1$。\n2.  由模 4 诱导的特征：$(1, -1, 1, -1)$，导子 $4$，$\\chi(-1)=-1$。\n3.  模 8 的偶本原特征：$(1, -1, -1, 1)$，导子 $8$，$\\chi(-1)=1$。\n4.  模 8 的奇本原特征：$(1, 1, -1, -1)$，导子 $8$，$\\chi(-1)=-1$。\n\n最终的矩阵连接了这 4 组数据。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 & 1 & 1 & 1 & 1 & 1 & 1 & -1 & 1 & -1 & 4 & -1 & 1 & -1 & -1 & 1 & 8 & 1 & 1 & 1 & -1 & -1 & 8 & -1\n\\end{pmatrix}\n}\n$$", "id": "3021462"}, {"introduction": "现在，我们将前面练习中获得的工具——特征正交性和具体构造——投入实际应用。本练习要求你将这些工具与西格尔-瓦尔菲施定理相结合，分析模 3 的算术级数中素数的分布情况。这个实践不仅展示了整个理论框架如何协同工作以证明素数的均等分布，而且还让你体验到如何从一个强大的抽象定理中推导出具体的、可量化的结论 [@problem_id:3021446]。", "problem": "令 $q=3$ 并定义算术级数中的 Chebyshev 函数为\n$$\\psi(x; q, a) \\;=\\; \\sum_{\\substack{n \\leq x \\\\ n \\equiv a \\;(\\mathrm{mod}\\; q)}} \\Lambda(n),$$\n其中 $\\Lambda(n)$ 是 von Mangoldt 函数，且 $a$ 与 $q$ 互质。令 $\\varphi$ 表示 Euler totient 函数（欧拉函数）。模 $q$ 的 Dirichlet 特征的正交性意味着对于 $\\gcd(a,q)=1$，\n$$\\psi(x; q, a) \\;=\\; \\frac{1}{\\varphi(q)} \\sum_{\\chi \\;(\\mathrm{mod}\\; q)} \\overline{\\chi(a)} \\sum_{n \\leq x} \\Lambda(n)\\,\\chi(n).$$\nSiegel–Walfisz 定理 (SWT) 指出，对于任意固定的 $A>0$，存在正常数 $C_{A}$ 和 $c_{A}$，使得对于 $q \\leq (\\ln x)^{A}$ 和 $\\gcd(a,q)=1$ 一致地有，\n$$\\left|\\psi(x; q, a) - \\frac{x}{\\varphi(q)}\\right| \\;\\leq\\; C_{A}\\,x\\,\\exp\\!\\Big(-\\,c_{A}\\,(\\ln x)^{3/5}(\\ln\\ln x)^{-1/5}\\Big).$$\n\n考虑 $q=3$ 的情况。从 $\\psi(x; q,a)$ 的基本定义和 Dirichlet 特征的正交性出发，推导 $\\psi(x; 3,1)$ 和 $\\psi(x; 3,2)$ 的主项，以及 Siegel–Walfisz 定理所保证形式的显式误差（你可以保留常数 $C_{A}$ 和 $c_{A}$ 为符号形式）。然后用此结果证明偏差\n$$\\Delta(x) \\;=\\; \\psi(x; 3,1)\\,-\\,\\psi(x; 3,2)$$\n受 Siegel–Walfisz 误差项的限制，因此由 $\\Lambda(n)$ 加权的素数在模 $3$ 的既约剩余类之间是等分布的。最后，为了对归一化偏差的衰减进行符号计算，设 $x=\\exp(\\exp(T))$ 且 $T>1$，并化简下式的上界\n$$\\delta(T)\\;=\\;\\frac{|\\Delta(x)|}{x}$$\n为一个关于 $T$、$C_{A}$ 和 $c_{A}$ 的封闭形式表达式。此符号计算无需四舍五入。\n\n将你的最终答案表示为 $\\psi(x;3,1)$ 和 $\\psi(x;3,2)$ 主项表达式的有序对。", "solution": "该问题要求基于 Chebyshev 函数 $\\psi(x; q, a)$ 和 Siegel-Walfisz 定理 (SWT)，对模 $q=3$ 的算术级数中素数的分布进行多步分析。我们必须首先推导 $\\psi(x; 3, 1)$ 和 $\\psi(x; 3, 2)$ 的主项，分析偏差 $\\Delta(x) = \\psi(x; 3, 1) - \\psi(x; 3, 2)$，并找到归一化偏差 $\\delta(T)$ 的一个上界。\n\n首先，我们针对模 $q=3$ 建立问题。模 $3$ 的既约剩余类群是 $(\\mathbb{Z}/3\\mathbb{Z})^\\times = \\{1, 2\\}$，因此我们关心的是 $a=1$ 和 $a=2$。Euler totient 函数（欧拉函数）为 $\\varphi(3) = 3(1 - 1/3) = 2$。\n存在 $\\varphi(3)=2$ 个模 $3$ 的 Dirichlet 特征。\n$1$. 主特征 $\\chi_0$ 定义为：当 $\\gcd(n,3)=1$ 时 $\\chi_0(n)=1$；当 $\\gcd(n,3) \\neq 1$ 时 $\\chi_0(n)=0$。\n$2$. 非主特征 $\\chi_1$ 由模 $3$ 的 Legendre 符号给出，即 $\\chi_1(n) = \\left(\\frac{n}{3}\\right)$。它是一个实特征，满足 $\\chi_1(1)=1$，$\\chi_1(2)=-1$，并且当 $n$ 是 $3$ 的倍数时 $\\chi_1(n)=0$。\n\n问题给出了利用特征正交性对 $\\psi(x; q, a)$ 的分解：\n$$ \\psi(x; q, a) = \\frac{1}{\\varphi(q)} \\sum_{\\chi \\;(\\mathrm{mod}\\; q)} \\overline{\\chi(a)} \\psi(x, \\chi), $$\n其中 $\\psi(x, \\chi) = \\sum_{n \\leq x} \\Lambda(n)\\chi(n)$。\n\n对于 $q=3$，我们有 $\\varphi(3)=2$。让我们将其应用于 $a=1$ 和 $a=2$ 的情况。\n\n对于 $a=1$：由于 $\\chi_0(1)=1$ 和 $\\chi_1(1)=1$，且两个特征都是实的（$\\overline{\\chi}=\\chi$），我们有：\n$$ \\psi(x; 3, 1) = \\frac{1}{2} \\left( \\chi_0(1)\\psi(x, \\chi_0) + \\chi_1(1)\\psi(x, \\chi_1) \\right) = \\frac{1}{2} \\left( \\psi(x, \\chi_0) + \\psi(x, \\chi_1) \\right). $$\n\n对于 $a=2$：我们有 $\\chi_0(2)=1$ 和 $\\chi_1(2)=-1$。\n$$ \\psi(x; 3, 2) = \\frac{1}{2} \\left( \\chi_0(2)\\psi(x, \\chi_0) + \\chi_1(2)\\psi(x, \\chi_1) \\right) = \\frac{1}{2} \\left( \\psi(x, \\chi_0) - \\psi(x, \\chi_1) \\right). $$\n\n为了找到主项，我们考察 $\\psi(x, \\chi_0)$ 和 $\\psi(x, \\chi_1)$ 的渐近行为。\n对于主特征 $\\chi_0$，求和 $\\psi(x, \\chi_0)$ 包含所有 $p^k \\leq x$ 的素数幂，除了 $p=3$ 的情况。我们可以将其与标准 Chebyshev 函数 $\\psi(x) = \\sum_{n \\leq x} \\Lambda(n)$ 联系起来：\n$$ \\psi(x, \\chi_0) = \\sum_{\\substack{n \\leq x \\\\ (n,3)=1}} \\Lambda(n) = \\psi(x) - \\sum_{k=1, 3^k \\leq x} \\Lambda(3^k) = \\psi(x) - \\ln(3)\\lfloor\\log_3 x\\rfloor. $$\n项 $\\ln(3)\\lfloor\\log_3 x\\rfloor$ 的阶为 $O(\\ln x)$。素数定理关于 $\\psi(x)$ 的形式给出 $\\psi(x) = x + E(x)$，其中 $E(x)$ 是一个 $o(x)$ 的误差项。一个可与 SWT 相媲美的强形式是 $E(x) = O\\left(x\\,\\exp(-c\\,(\\ln x)^{3/5}(\\ln\\ln x)^{-1/5})\\right)$。由于 $O(\\ln x)$ 项远小于此误差项，我们可以写出 $\\psi(x, \\chi_0) = x + E_0(x)$，其中 $E_0(x)$ 是一个 SWT 类型的误差项。因此，$\\psi(x, \\chi_0)$ 的主项是 $x$。\n\n对于非主特征 $\\chi_1$，解析数论中的一个基本结果（与 $L(s, \\chi_1)$ 在直线 $\\mathrm{Re}(s)=1$ 上不为零有关）表明 $\\psi(x, \\chi_1) = o(x)$。更具体地说，对 $|\\psi(x, \\chi_1)|$ 的界与 SWT 中的误差项形式相同，即 $|\\psi(x, \\chi_1)| \\leq C'\\,x\\,\\exp(-c'\\,(\\ln x)^{3/5}(\\ln\\ln x)^{-1/5})$。因此，$\\psi(x, \\chi_1)$ 的主项是 $0$。\n\n将这些主项代入我们关于 $\\psi(x; 3, a)$ 的表达式中：\n$\\psi(x; 3, 1)$ 的主项是 $\\psi(x, \\chi_0)$ 的主项与 $\\psi(x, \\chi_1)$ 的主项之和的一半，即 $\\frac{1}{2} (x + 0) = \\frac{x}{2}$。\n$\\psi(x; 3, 2)$ 的主项是 $\\psi(x, \\chi_0)$ 的主项与 $\\psi(x, \\chi_1)$ 的主项之差的一半，即 $\\frac{1}{2} (x - 0) = \\frac{x}{2}$。\n此结果与 Siegel-Walfisz 定理给出的主项 $\\frac{x}{\\varphi(q)} = \\frac{x}{2}$ 一致。每一项的误差，我们称之为 $E(x; 3, a)$，如 SWT 所述有界。\n$$ \\psi(x; 3, a) = \\frac{x}{2} + E(x; 3, a), \\quad \\text{with } |E(x; 3, a)| \\leq C_{A}\\,x\\,\\exp\\Big(-c_{A}\\,(\\ln x)^{3/5}(\\ln\\ln x)^{-1/5}\\Big). $$\n\n接下来，我们分析偏差 $\\Delta(x) = \\psi(x; 3, 1) - \\psi(x; 3, 2)$。使用主项和误差表示：\n$$ \\Delta(x) = \\left(\\frac{x}{2} + E(x; 3, 1)\\right) - \\left(\\frac{x}{2} + E(x; 3, 2)\\right) = E(x; 3, 1) - E(x; 3, 2). $$\n使用三角不等式和 SWT 界：\n$$ |\\Delta(x)| \\leq |E(x; 3, 1)| + |E(x; 3, 2)| \\leq 2\\,C_{A}\\,x\\,\\exp\\Big(-c_{A}\\,(\\ln x)^{3/5}(\\ln\\ln x)^{-1/5}\\Big). $$\n这表明 $|\\Delta(x)|$ 受一个 Siegel-Walfisz 误差形式的量的限制。由于此误差为 $o(x)$，这意味着 $\\lim_{x\\to\\infty} \\frac{\\Delta(x)}{x} = 0$，所以 $\\psi(x; 3, 1)$ 和 $\\psi(x; 3, 2)$ 是渐近相等的。由于它们共享相同的主项 $\\frac{x}{2}$，我们得出结论：由 $\\Lambda(n)$ 加权的素数幂在模 $3$ 的两个既约剩余类之间是等分布的。\n\n最后，我们找出当 $x = \\exp(\\exp(T))$ 且 $T>1$ 时归一化偏差 $\\delta(T) = \\frac{|\\Delta(x)|}{x}$ 的一个上界。由上面推导出的 $|\\Delta(x)|$ 的界：\n$$ \\delta(T) = \\frac{|\\Delta(x)|}{x} \\leq \\frac{1}{x} \\left( 2\\,C_{A}\\,x\\,\\exp\\Big(-c_{A}\\,(\\ln x)^{3/5}(\\ln\\ln x)^{-1/5}\\Big) \\right) = 2\\,C_{A}\\,\\exp\\Big(-c_{A}\\,(\\ln x)^{3/5}(\\ln\\ln x)^{-1/5}\\Big). $$\n现在，我们代入 $x = \\exp(\\exp(T))$：\n$\\ln(x) = \\ln(\\exp(\\exp(T))) = \\exp(T)$.\n$\\ln(\\ln(x)) = \\ln(\\exp(T)) = T$.\n将这些代入 $\\delta(T)$ 的上界表达式中：\n$$ \\delta(T) \\leq 2\\,C_{A}\\,\\exp\\left(-c_{A}\\,\\left(\\exp(T)\\right)^{3/5}(T)^{-1/5}\\right) = 2\\,C_{A}\\,\\exp\\left(-c_{A}\\,\\exp\\left(\\frac{3T}{5}\\right)T^{-1/5}\\right). $$\n这就得到了 $\\delta(T)$ 的简化封闭形式上界。\n\n问题的最后一部分要求给出 $\\psi(x;3,1)$ 和 $\\psi(x;3,2)$ 主项表达式的有序对。如上所推导，两者具有相同的主项。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{x}{2} & \\frac{x}{2} \\end{pmatrix}}$$", "id": "3021446"}]}