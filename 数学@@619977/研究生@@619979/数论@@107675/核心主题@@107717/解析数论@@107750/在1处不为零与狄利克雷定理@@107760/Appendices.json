{"hands_on_practices": [{"introduction": "本练习将让你亲自动手处理狄利克雷特征的定义。通过为小模数 $q=5$ 显式地构建所有特征，你将巩固对它们与群 $(\\mathbb{Z}/q\\mathbb{Z})^\\times$ 结构之间联系的理解。此练习还要求你验证一个基本的正交性关系，这是$L$函数解析理论的基石之一。[@problem_id:3019544]", "problem": "设 $q=5$。一个模 $q$ 的狄利克雷特征是一个完全积性函数 $\\chi:\\mathbb{Z}\\to\\mathbb{C}$，它满足：对所有 $n\\in\\mathbb{Z}$ 都有 $\\chi(n+q)=\\chi(n)$；当 $\\gcd(n,q)>1$ 时 $\\chi(n)=0$；且 $\\chi$ 在 $\\left(\\mathbb{Z}/q\\mathbb{Z}\\right)^{\\times}$ 上的限制是到 $\\mathbb{C}^{\\times}$ 的群同态。当 $q=5$ 时，乘法群 $\\left(\\mathbb{Z}/5\\mathbb{Z}\\right)^{\\times}$ 是一个由 $2$ 生成的 4 阶循环群。仅使用这些定义和基本的群论知识，完成以下任务：\n\n1. 通过指定在 $n\\in\\{1,2,3,4,5\\}$ 上的值，显式地构造所有模 5 的狄利克雷特征，并找出其中的主特征。\n2. 对每个非主特征 $\\chi$，直接验证 $\\sum_{n=1}^{5}\\chi(n)=0$。\n\n为了使最终答案无歧义，我们通过规则 $\\chi_{k}(5)=0$ 和 $\\chi_{k}(2)=\\mathrm{i}^{k}$（其中 $k\\in\\{0,1,2,3\\}$，$\\mathrm{i}$ 是虚数单位）来定义特征 $\\chi_{0},\\chi_{1},\\chi_{2},\\chi_{3}$ 的顺序，并将 $\\chi_{k}$ 通过积性和周期性扩展为狄利克雷特征。请给出以下行向量作为你的最终输出：\n$$\\left(\\sum_{n=1}^{5}\\chi_{0}(n),\\ \\sum_{n=1}^{5}\\chi_{1}(n),\\ \\sum_{n=1}^{5}\\chi_{2}(n),\\ \\sum_{n=1}^{5}\\chi_{3}(n)\\right)$$\n无需进行数值舍入；请给出精确值。", "solution": "问题陈述被评估为有效。这是一个初等数论中的良定问题，基于狄利克雷特征的标准定义和性质。所有提供的信息在数学上都是合理的、自洽的，并且足以推导出一个唯一的解。语言是客观且无歧义的。\n\n该问题要求构造和分析模 $q=5$ 的狄利克雷特征。模 5 整数乘法群，记作 $(\\mathbb{Z}/5\\mathbb{Z})^{\\times}$，由剩余类 $\\{1, 2, 3, 4\\}$ 组成。这个群是 $\\phi(5) = 4$ 阶的循环群。问题陈述指出一个生成元是 $g=2$。我们可以验证这一点：\n$2^1 \\equiv 2 \\pmod{5}$\n$2^2 \\equiv 4 \\pmod{5}$\n$2^3 \\equiv 8 \\equiv 3 \\pmod{5}$\n$2^4 \\equiv 16 \\equiv 1 \\pmod{5}$\n$2$ 的幂确实生成了 $(\\mathbb{Z}/5\\mathbb{Z})^{\\times}$ 的所有元素。\n\n一个模 5 的狄利克雷特征 $\\chi$ 是从 $(\\mathbb{Z}/5\\mathbb{Z})^{\\times}$ 到复数乘法群 $\\mathbb{C}^{\\times}$ 的一个群同态。由于 $(\\mathbb{Z}/5\\mathbb{Z})^{\\times}$ 是一个 4 阶循环群，任何这样的同态都完全由其在生成元 $g=2$ 上的值确定。设 $\\chi$ 为一个特征。因为 $g^4 \\equiv 1 \\pmod{5}$，我们必须有 $\\chi(g^4) = \\chi(1) = 1$。根据同态性质，$\\chi(g^4) = (\\chi(g))^4$。因此，$\\chi(2)^4 = 1$，这意味着 $\\chi(2)$ 必须是一个 4 次单位根。四个 4 次单位根是 $\\{1, \\mathrm{i}, -1, -\\mathrm{i}\\}$，其中 $\\mathrm{i}^2 = -1$。\n\n这意味着恰好存在四个模 5 的狄利克雷特征。问题根据规则 $\\chi_k(2) = \\mathrm{i}^k$ 为它们定义了一个顺序，即 $\\chi_k$，其中 $k \\in \\{0, 1, 2, 3\\}$。\n\n我们现在为每个特征构造其在 $n \\in \\{1, 2, 3, 4, 5\\}$ 上的值。\n对于任意特征 $\\chi_k$：\n如果 $\\gcd(n, 5) > 1$，则 $\\chi_k(n) = 0$。对于指定的范围，这意味着 $\\chi_k(5) = 0$。\n对于 $n \\in \\{1, 2, 3, 4\\}$，我们使用积性性质以及它们是模 5 下 2 的幂这一事实：\n$\\chi_k(1) = \\chi_k(2^4) = (\\chi_k(2))^4 = (\\mathrm{i}^k)^4 = \\mathrm{i}^{4k} = ( \\mathrm{i}^4 )^k = 1^k = 1$。\n$\\chi_k(2) = \\mathrm{i}^k$。\n$\\chi_k(3) = \\chi_k(2^3) = (\\chi_k(2))^3 = (\\mathrm{i}^k)^3 = \\mathrm{i}^{3k}$。\n$\\chi_k(4) = \\chi_k(2^2) = (\\chi_k(2))^2 = (\\mathrm{i}^k)^2 = \\mathrm{i}^{2k}$。\n\n我们列出每个特征 $\\chi_k$ 在 $n \\in \\{1, 2, 3, 4, 5\\}$ 上的值：\n\n特征 $\\chi_0$ (其中 $k=0$)：\n$\\chi_0(2) = \\mathrm{i}^0 = 1$。\n$\\chi_0(1) = 1$。\n$\\chi_0(2) = 1$。\n$\\chi_0(3) = \\mathrm{i}^{3 \\cdot 0} = 1$。\n$\\chi_0(4) = \\mathrm{i}^{2 \\cdot 0} = 1$。\n$\\chi_0(5) = 0$。\n对于 $n=1,2,3,4,5$ 的值为 $(1, 1, 1, 1, 0)$。这个特征对于所有与模互质的数为 $1$，否则为 $0$，是主特征。\n\n特征 $\\chi_1$ (其中 $k=1$)：\n$\\chi_1(2) = \\mathrm{i}^1 = \\mathrm{i}$。\n$\\chi_1(1) = 1$。\n$\\chi_1(2) = \\mathrm{i}$。\n$\\chi_1(3) = \\mathrm{i}^{3 \\cdot 1} = \\mathrm{i}^3 = -\\mathrm{i}$。\n$\\chi_1(4) = \\mathrm{i}^{2 \\cdot 1} = \\mathrm{i}^2 = -1$。\n$\\chi_1(5) = 0$。\n对于 $n=1,2,3,4,5$ 的值为 $(1, \\mathrm{i}, -\\mathrm{i}, -1, 0)$。这是一个非主特征。\n\n特征 $\\chi_2$ (其中 $k=2$)：\n$\\chi_2(2) = \\mathrm{i}^2 = -1$。\n$\\chi_2(1) = 1$。\n$\\chi_2(2) = -1$。\n$\\chi_2(3) = \\mathrm{i}^{3 \\cdot 2} = \\mathrm{i}^6 = (\\mathrm{i}^4)\\mathrm{i}^2 = -1$。\n$\\chi_2(4) = \\mathrm{i}^{2 \\cdot 2} = \\mathrm{i}^4 = 1$。\n$\\chi_2(5) = 0$。\n对于 $n=1,2,3,4,5$ 的值为 $(1, -1, -1, 1, 0)$。这是一个非主特征。\n\n特征 $\\chi_3$ (其中 $k=3$)：\n$\\chi_3(2) = \\mathrm{i}^3 = -\\mathrm{i}$。\n$\\chi_3(1) = 1$。\n$\\chi_3(2) = -\\mathrm{i}$。\n$\\chi_3(3) = \\mathrm{i}^{3 \\cdot 3} = \\mathrm{i}^9 = (\\mathrm{i}^4)^2\\mathrm{i} = \\mathrm{i}$。\n$\\chi_3(4) = \\mathrm{i}^{2 \\cdot 3} = \\mathrm{i}^6 = -1$。\n$\\chi_3(5) = 0$。\n对于 $n=1,2,3,4,5$ 的值为 $(1, -\\mathrm{i}, \\mathrm{i}, -1, 0)$。这是一个非主特征。注意 $\\chi_3$ 是 $\\chi_1$ 的复共轭。\n\n接下来，我们为每个 $k$ 计算和 $\\sum_{n=1}^{5}\\chi_k(n)$。\n\n对于 $k=0$ (主特征)：\n$\\sum_{n=1}^{5}\\chi_0(n) = \\chi_0(1) + \\chi_0(2) + \\chi_0(3) + \\chi_0(4) + \\chi_0(5) = 1 + 1 + 1 + 1 + 0 = 4$。\n\n对于 $k=1$ (一个非主特征)：\n$\\sum_{n=1}^{5}\\chi_1(n) = \\chi_1(1) + \\chi_1(2) + \\chi_1(3) + \\chi_1(4) + \\chi_1(5) = 1 + \\mathrm{i} + (-\\mathrm{i}) + (-1) + 0 = 0$。\n这验证了 $\\chi_1$ 的性质。\n\n对于 $k=2$ (一个非主特征)：\n$\\sum_{n=1}^{5}\\chi_2(n) = \\chi_2(1) + \\chi_2(2) + \\chi_2(3) + \\chi_2(4) + \\chi_2(5) = 1 + (-1) + (-1) + 1 + 0 = 0$。\n这验证了 $\\chi_2$ 的性质。\n\n对于 $k=3$ (一个非主特征)：\n$\\sum_{n=1}^{5}\\chi_3(n) = \\chi_3(1) + \\chi_3(2) + \\chi_3(3) + \\chi_3(4) + \\chi_3(5) = 1 + (-\\mathrm{i}) + \\mathrm{i} + (-1) + 0 = 0$。\n这验证了 $\\chi_3$ 的性质。\n\n最后的任务是按指定顺序提供这些和的行向量。\n该向量是 $(\\sum_{n=1}^{5}\\chi_0(n), \\sum_{n=1}^{5}\\chi_1(n), \\sum_{n=1}^{5}\\chi_2(n), \\sum_{n=1}^{5}\\chi_3(n))$。\n根据我们的计算，这个向量是 $(4, 0, 0, 0)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n4 & 0 & 0 & 0\n\\end{pmatrix}\n}\n$$", "id": "3019544"}, {"introduction": "在特征概念的基础上，本练习将焦点转移到相关的狄利克雷$L$函数上。你将计算模3的非主特征 $\\chi$ 在 $s=1$ 处的$L$函数值 $L(1, \\chi)$，这是解析数论中的一个经典结果。这个计算不仅展示了一种强大的解析技巧，而且为关键的非零性质 $L(1, \\chi) \\neq 0$ 提供了一个具体例证，而该性质正是狄利克雷定理的基石。[@problem_id:3019531]", "problem": "设 $\\chi$ 是模 $3$ 的非主狄利克雷特征，其定义为：$\\chi(1)=1$，$\\chi(2)=-1$，且当 $n \\equiv 0 \\pmod 3$ 时，$\\chi(n)=0$。考虑狄利克雷$L$函数 $L(s,\\chi)$，当 $\\Re(s)>1$ 时，其级数定义为\n$$\nL(s,\\chi)=\\sum_{n=1}^{\\infty}\\frac{\\chi(n)}{n^{s}}.\n$$\n仅使用级数定义、狄利克雷特征的性质以及关于经典特殊函数的公认解析事实，计算 $L(1,\\chi)$ 的精确闭式值。最终答案必须是单一的闭式表达式；无需四舍五入。", "solution": "该问题是为计算模 $3$ 的非主特征 $\\chi$ 的狄利克雷$L$函数 $L(s,\\chi)$ 在 $s=1$ 处的精确值。\n\n首先，我们对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- $\\chi$ 是模 $3$ 的非主狄利克雷特征。\n- $\\chi(1)=1$。\n- $\\chi(2)=-1$。\n- 当 $3$ 整除 $n$ 时，$\\chi(n)=0$。\n- 狄利克雷$L$函数定义为 $L(s,\\chi)=\\sum_{n=1}^{\\infty}\\frac{\\chi(n)}{n^{s}}$，其中 $\\Re(s)>1$。\n- 任务是计算 $L(1,\\chi)$ 的精确闭式值。\n- 允许使用的方法：级数定义、狄利克雷特征的性质以及关于经典特殊函数的公认解析事实。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，提法恰当且客观。这是解析数论中的一个标准问题。模 $3$ 的狄利克雷特征 $\\chi$ 的定义是正确的。$L(s,\\chi)$ 的级数也是标准的。虽然给定的级数定义仅在 $\\Re(s)>1$ 时有效，但对于非主特征 $\\chi$，函数 $L(s,\\chi)$ 可以解析延拓为复平面上的一个整函数。$L(1,\\chi)$ 的值是良定义且有限的。该问题隐含地要求使用在收敛域边界上对级数求值时有效的方法，而使用“公认解析事实”的指令允许了这一点。该问题不含任何科学缺陷、歧义或矛盾。\n\n**步骤3：结论与行动**\n该问题有效。我们现在开始求解。\n\n模 $3$ 的狄利克雷特征 $\\chi$ 由下式给出：\n如果 $n \\equiv 1 \\pmod 3$，则 $\\chi(n) = 1$\n如果 $n \\equiv 2 \\pmod 3$，则 $\\chi(n) = -1$\n如果 $n \\equiv 0 \\pmod 3$，则 $\\chi(n) = 0$\n\n狄利克雷$L$函数定义为：\n$$\nL(s,\\chi) = \\sum_{n=1}^{\\infty} \\frac{\\chi(n)}{n^s}\n$$\n我们希望计算 $L(1,\\chi)$。令 $s=1$，我们得到级数：\n$$\nL(1,\\chi) = \\sum_{n=1}^{\\infty} \\frac{\\chi(n)}{n} = \\frac{1}{1} - \\frac{1}{2} + \\frac{0}{3} + \\frac{1}{4} - \\frac{1}{5} + \\frac{0}{6} + \\frac{1}{7} - \\frac{1}{8} + \\dots\n$$\n这是一个交错级数，根据交错级数判别法，它是收敛的，因此 $L(1,\\chi)$ 是一个良定义的有限值。为求其闭式表达式，我们使用积分表示。对任意整数 $n \\geq 1$，我们有恒等式：\n$$\n\\frac{1}{n} = \\int_{0}^{1} x^{n-1} \\,dx\n$$\n将此代入 $L(1,\\chi)$ 的级数中：\n$$\nL(1,\\chi) = \\sum_{n=1}^{\\infty} \\chi(n) \\int_{0}^{1} x^{n-1} \\,dx\n$$\n我们可以交换求和与积分的次序。这可以通过关于幂级数的阿贝尔定理来证明，因为级数 $\\sum_{n=1}^{\\infty} \\chi(n) y^n$ 在 $|y|<1$ 时收敛，且其在 $y=1$ 处的值是当 $y \\to 1^{-}$ 时和的极限，而这正是该积分所表示的。或者，幂级数 $\\sum \\chi(n)x^{n-1}$ 在任何满足 $0 \\le r < 1$ 的紧子区间 $[0, r]$ 上一致收敛。\n$$\nL(1,\\chi) = \\int_{0}^{1} \\left( \\sum_{n=1}^{\\infty} \\chi(n) x^{n-1} \\right) \\,dx = \\int_{0}^{1} \\frac{1}{x} \\left( \\sum_{n=1}^{\\infty} \\chi(n) x^{n} \\right) \\,dx\n$$\n让我们计算在 $|x|<1$ 时积分内的幂级数：\n$$\n\\sum_{n=1}^{\\infty} \\chi(n) x^n = x - x^2 + x^4 - x^5 + x^7 - x^8 + \\dots\n$$\n我们可以将各项分组：\n$$\n(x - x^2) + (x^4 - x^5) + (x^7 - x^8) + \\dots = x(1-x) + x^4(1-x) + x^7(1-x) + \\dots\n$$\n这是一个几何级数，其首项为 $a = x(1-x)$，公比为 $r=x^3$。其和为：\n$$\n\\sum_{n=1}^{\\infty} \\chi(n) x^n = \\frac{x(1-x)}{1-x^3}\n$$\n使用因式分解 $1-x^3 = (1-x)(1+x+x^2)$，我们简化表达式：\n$$\n\\frac{x(1-x)}{(1-x)(1+x+x^2)} = \\frac{x}{1+x+x^2}\n$$\n现在，将此结果代回 $L(1,\\chi)$ 的积分中：\n$$\nL(1,\\chi) = \\int_{0}^{1} \\frac{1}{x} \\left( \\frac{x}{1+x+x^2} \\right) \\,dx = \\int_{0}^{1} \\frac{1}{1+x+x^2} \\,dx\n$$\n为计算此积分，我们对分母使用配方法：\n$$\nx^2+x+1 = \\left(x^2+x+\\frac{1}{4}\\right) - \\frac{1}{4} + 1 = \\left(x+\\frac{1}{2}\\right)^2 + \\frac{3}{4}\n$$\n积分变为：\n$$\nL(1,\\chi) = \\int_{0}^{1} \\frac{1}{\\left(x+\\frac{1}{2}\\right)^2 + \\frac{3}{4}} \\,dx\n$$\n我们进行换元。令 $u = x+\\frac{1}{2}$。则 $du = dx$。 $u$ 的积分上下限为从 $u=0+\\frac{1}{2}=\\frac{1}{2}$ 到 $u=1+\\frac{1}{2}=\\frac{3}{2}$。\n$$\nL(1,\\chi) = \\int_{1/2}^{3/2} \\frac{1}{u^2 + \\left(\\frac{\\sqrt{3}}{2}\\right)^2} \\,du\n$$\n这是一个标准积分，形式为 $\\int \\frac{1}{u^2+a^2}du = \\frac{1}{a} \\arctan(\\frac{u}{a}) + C$。此处 $a = \\frac{\\sqrt{3}}{2}$。\n$$\nL(1,\\chi) = \\left[ \\frac{1}{\\frac{\\sqrt{3}}{2}} \\arctan\\left(\\frac{u}{\\frac{\\sqrt{3}}{2}}\\right) \\right]_{1/2}^{3/2} = \\left[ \\frac{2}{\\sqrt{3}} \\arctan\\left(\\frac{2u}{\\sqrt{3}}\\right) \\right]_{1/2}^{3/2}\n$$\n现在，我们在积分上下限处计算该表达式的值：\n$$\nL(1,\\chi) = \\frac{2}{\\sqrt{3}} \\left[ \\arctan\\left(\\frac{2 \\cdot \\frac{3}{2}}{\\sqrt{3}}\\right) - \\arctan\\left(\\frac{2 \\cdot \\frac{1}{2}}{\\sqrt{3}}\\right) \\right]\n$$\n$$\n= \\frac{2}{\\sqrt{3}} \\left[ \\arctan\\left(\\frac{3}{\\sqrt{3}}\\right) - \\arctan\\left(\\frac{1}{\\sqrt{3}}\\right) \\right]\n$$\n$$\n= \\frac{2}{\\sqrt{3}} \\left[ \\arctan(\\sqrt{3}) - \\arctan\\left(\\frac{1}{\\sqrt{3}}\\right) \\right]\n$$\n我们使用反正切函数的熟知值：$\\arctan(\\sqrt{3}) = \\frac{\\pi}{3}$ 和 $\\arctan\\left(\\frac{1}{\\sqrt{3}}\\right) = \\frac{\\pi}{6}$。\n$$\nL(1,\\chi) = \\frac{2}{\\sqrt{3}} \\left( \\frac{\\pi}{3} - \\frac{\\pi}{6} \\right) = \\frac{2}{\\sqrt{3}} \\left( \\frac{2\\pi - \\pi}{6} \\right) = \\frac{2}{\\sqrt{3}} \\left( \\frac{\\pi}{6} \\right)\n$$\n$$\n= \\frac{2\\pi}{6\\sqrt{3}} = \\frac{\\pi}{3\\sqrt{3}}\n$$\n最后，为得到标准表示形式，我们对分母进行有理化：\n$$\nL(1,\\chi) = \\frac{\\pi}{3\\sqrt{3}} \\cdot \\frac{\\sqrt{3}}{\\sqrt{3}} = \\frac{\\pi\\sqrt{3}}{9}\n$$\n这就是 $L(1,\\chi)$ 的精确闭式值。", "answer": "$$\n\\boxed{\\frac{\\pi\\sqrt{3}}{9}}\n$$", "id": "3019531"}, {"introduction": "最后的这个实践练习将整个理论与其最著名的应用——关于算术级数中素数的狄利克雷定理——联系起来。通过一个数值实验，你将研究素数在模4的余数类中的分布，并观察它们倒数和的发散趋势。这项动手探索将完美地诠释 $L(1, \\chi) \\neq 0$ 这一抽象性质如何转化为素数在可行的算术级数中均等分布的深刻结论。[@problem_id:3019540]", "problem": "令 $q=4$，令 $\\chi_{0}$ 表示模 $4$ 的主狄利克雷特征，令 $\\chi$ 表示模 $4$ 的唯一非主狄利克雷特征，其定义为：若 $n$ 为偶数，则 $\\chi(n)=0$；若 $n\\equiv 1\\ (\\bmod\\ 4)$，则 $\\chi(n)=1$；若 $n\\equiv 3\\ (\\bmod\\ 4)$，则 $\\chi(n)=-1$。对于一个特征 $\\chi$，其狄利克雷$L$级数定义为 $L(s,\\chi)=\\sum_{n=1}^{\\infty}\\chi(n)n^{-s}$（其中 $\\Re(s)>1$），并拥有一个对所有素数 $p$ 的欧拉乘积 $L(s,\\chi)=\\prod_{p}(1-\\chi(p)p^{-s})^{-1}$。一个基本事实是，对于任意非主狄利克雷特征 $\\chi$，都有 $L(1,\\chi) \\neq 0$。而 Dirichlet 关于算术级数的定理断言，对于任何与 $q$ 互质的模 $q$ 剩余类 $a$，都存在无穷多个素数 $p$ 满足 $p\\equiv a\\ (\\bmod\\ q)$。\n\n你的任务是设计并实现一个数值实验，以探究沿模 $4$ 的两个互质剩余类的素数倒数和的发散行为。对于每个实数截断值 $X\\geq 10$，定义部分和\n$$\nS_{1}(X)=\\sum_{\\substack{p\\leq X\\\\ p\\equiv 1\\ (\\bmod\\ 4)}}\\frac{1}{p},\\qquad\nS_{3}(X)=\\sum_{\\substack{p\\leq X\\\\ p\\equiv 3\\ (\\bmod\\ 4)}}\\frac{1}{p}.\n$$\n你必须数值计算这些量，以及相关的素数计数\n$$\nC_{1}(X)=\\#\\{p\\leq X:\\ p\\equiv 1\\ (\\bmod\\ 4)\\},\\qquad\nC_{3}(X)=\\#\\{p\\leq X:\\ p\\equiv 3\\ (\\bmod\\ 4)\\}.\n$$\n此外，对于每个 $X$，计算归一化量 $N_{1}(X) = S_{1}(X)/(\\log\\log X)$ 和 $N_{3}(X) = S_{3}(X)/(\\log\\log X)$，以及差值 $D(X) = S_{1}(X)-S_{3}(X)$。这些量可以共同用于观察 $S_{1}(X)$ 与 $S_{3}(X)$ 的相对发散趋势。\n\n仅从上述核心定义以及“狄利克雷L级数允许欧拉乘积”和“非主狄利克雷L级数在 $s=1$ 处不为零”这两个经过充分检验的事实出发，给出一个基于基本原理的推导，解释为何 $S_{1}(X)$ 和 $S_{3}(X)$ 的发散速率预期是可比的，以及这与 Dirichlet 定理有何关联。然后，实现一个算法，该算法针对一组截断值 $X$，计算 $S_{1}(X)$、$S_{3}(X)$、$N_{1}(X)$、$N_{3}(X)$、$D(X)$、$C_{1}(X)$、$C_{3}(X)$ 以及比值 $R(X)=C_{1}(X)/C_{3}(X)$ 的值。\n\n算法要求：\n- 使用基于基本原理的正确方法（例如，Eratosthenes 筛法）生成直至最大截断值的所有素数。\n- 根据素数模 $4$ 的余数对其进行划分，并计算所需的和与计数。\n- $\\log$ 和 $\\log\\log$ 使用自然对数；不涉及角度，因此不需要角度单位。\n- 程序必须独立运行，无需用户输入。\n\n测试套件：\n使用以下截断值构成你的测试用例：\n- $X=100$ (边界小规模情况)，\n- $X=5000$ (中等规模情况)，\n- $X=100000$ (大规模情况)，\n- $X=1000000$ (用于更强趋势观测的超大规模情况)。\n\n最终输出规范：\n你的程序应产生单行输出，包含一个逗号分隔的结果列表，其中每个测试用例贡献一个形如\n$$\n[$X$, $S_{1}(X)$, $S_{3}(X)$, $N_{1}(X)$, $N_{3}(X)$, $D(X)$, $C_{1}(X)$, $C_{3}(X)$, $R(X)$]\n$$\n的列表，其中 $X$、$C_{1}(X)$、$C_{3}(X)$ 为整数，其他项为四舍五入到六位小数的浮点数。最外层输出必须是这些单个测试用例列表的列表，并用方括号括起来，例如\n$$\n[\\ [100, \\dots],\\ [5000, \\dots],\\ [100000, \\dots],\\ [1000000, \\dots]\\ ].\n$$", "solution": "该问题陈述是解析数论中的一个有效练习。它具有科学依据，问题定义明确且客观，并为得出完整解法提供了所有必要信息。\n\n该问题要求对模 $4$ 剩余类中素数倒数的部分和，即 $S_1(X) = \\sum_{p\\leq X, p\\equiv 1\\ (\\bmod\\ 4)}\\frac{1}{p}$ 和 $S_3(X) = \\sum_{p\\leq X, p\\equiv 3\\ (\\bmod\\ 4)}\\frac{1}{p}$ 的预期行为进行基于基本原理的推导，并要求通过数值实现来计算这些量及相关量。\n\n分析这些和的理论基础在于 Dirichlet 特征及其相关的 $L$级数理论。令 $q=4$。模 $4$ 的既约剩余类群是 $(\\mathbb{Z}/4\\mathbb{Z})^\\times = \\{1, 3\\}$，其阶为 $\\phi(4)=2$。存在两个模 $4$ 的 Dirichlet 特征：主特征 $\\chi_0$ 和一个唯一的非主特征 $\\chi$。\n\n关键工具是特征的正交关系。对于一个整数 $n$ 和一个与 $q$ 互质的模 $q$ 剩余类 $a$，同余式 $n \\equiv a \\pmod{q}$ 的指示函数由下式给出：\n$$\n\\mathbf{1}_{n\\equiv a \\pmod{q}} = \\frac{1}{\\phi(q)} \\sum_{\\psi \\pmod{q}} \\overline{\\psi(a)} \\psi(n)\n$$\n其中求和遍及所有模 $q$ 的 Dirichlet 特征 $\\psi$。\n\n我们将其应用于和 $S_a(X) = \\sum_{p\\le X, p\\equiv a \\pmod{q}} \\frac{1}{p}$。代入指示函数，我们得到：\n$$\nS_a(X) = \\sum_{p \\le X} \\frac{1}{p} \\left( \\frac{1}{\\phi(q)} \\sum_{\\psi \\pmod{q}} \\overline{\\psi(a)} \\psi(p) \\right) = \\frac{1}{\\phi(q)} \\sum_{\\psi \\pmod{q}} \\overline{\\psi(a)} \\sum_{p \\le X} \\frac{\\psi(p)}{p}\n$$\n在我们的例子中，$q=4$，$\\phi(4)=2$，特征为 $\\chi_0$ 和 $\\chi$。\n\n对于剩余类 $a=1$：\n由于 $\\chi_0(1)=1$ 且 $\\chi(1)=1$，我们有：\n$$\nS_1(X) = \\frac{1}{2} \\left( \\overline{\\chi_0(1)} \\sum_{p \\le X} \\frac{\\chi_0(p)}{p} + \\overline{\\chi(1)} \\sum_{p \\le X} \\frac{\\chi(p)}{p} \\right) = \\frac{1}{2} \\sum_{p \\le X} \\frac{\\chi_0(p)}{p} + \\frac{1}{2} \\sum_{p \\le X} \\frac{\\chi(p)}{p}\n$$\n对于剩余类 $a=3$：\n由于 $\\chi_0(3)=1$ 且 $\\chi(3)=-1$，我们有：\n$$\nS_3(X) = \\frac{1}{2} \\left( \\overline{\\chi_0(3)} \\sum_{p \\le X} \\frac{\\chi_0(p)}{p} + \\overline{\\chi(3)} \\sum_{p \\le X} \\frac{\\chi(p)}{p} \\right) = \\frac{1}{2} \\sum_{p \\le X} \\frac{\\chi_0(p)}{p} - \\frac{1}{2} \\sum_{p \\le X} \\frac{\\chi(p)}{p}\n$$\n为理解 $S_1(X)$ 和 $S_3(X)$ 的行为，我们必须分析等式右侧的两个素数和。\n\n1.  **主特征和**：模 $4$ 的主特征 $\\chi_0$ 定义为：若 $\\gcd(n,4)=1$（即 $n$ 是奇数），则 $\\chi_0(n)=1$；若 $\\gcd(n,4)\\neq 1$（即 $n$ 是偶数），则 $\\chi_0(n)=0$。对于素数 $p$，所有奇素数都有 $\\chi_0(p)=1$，而 $\\chi_0(2)=0$。因此，\n    $$\n    \\sum_{p \\le X} \\frac{\\chi_0(p)}{p} = \\sum_{\\substack{p \\le X \\\\ p \\text{ odd}}} \\frac{1}{p} = \\left(\\sum_{p \\le X} \\frac{1}{p}\\right) - \\frac{1}{2}\n    $$\n    根据 Mertens 第二定理，素数倒数和是发散的，其渐近行为为 $\\sum_{p \\le X} \\frac{1}{p} \\sim \\log\\log X + M$，其中 $M$ 是 Meissel–Mertens 常数。因此，主特征的贡献以 $\\log\\log X$ 的形式发散。\n\n2.  **非主特征和**：$\\sum_{p \\le X} \\frac{\\chi(p)}{p}$ 的行为与 Dirichlet $L$级数 $L(s, \\chi) = \\sum_{n=1}^\\infty \\frac{\\chi(n)}{n^s}$ 相关联。当 $\\Re(s)>1$ 时，该级数有一个欧拉乘积 $L(s,\\chi) = \\prod_p (1-\\chi(p)p^{-s})^{-1}$。取对数可得：\n    $$\n    \\log L(s, \\chi) = \\sum_p -\\log(1 - \\chi(p)p^{-s}) = \\sum_p \\sum_{k=1}^\\infty \\frac{\\chi(p^k)}{p^{ks}} = \\sum_p \\frac{\\chi(p)}{p^s} + \\sum_p \\sum_{k=2}^\\infty \\frac{\\chi(p^k)}{p^{ks}}\n    $$\n    右侧的第二项 $\\sum_{p, k\\ge 2}$ 在 $\\Re(s) > 1/2$ 时收敛。一个关键定理指出，对于任何非主特征 $\\chi$，其$L$级数 $L(s,\\chi)$ 都可以解析延拓到整个复平面，并且重要的是 $L(1,\\chi) \\neq 0$。由于 $L(1,\\chi)$ 是一个有限的非零复数，其对数 $\\log L(1,\\chi)$ 是良定义且有限的。当 $s \\to 1^+$ 时，我们有：\n    $$\n    \\log L(1, \\chi) = \\lim_{s \\to 1^+} \\left( \\sum_p \\frac{\\chi(p)}{p^s} \\right) + \\text{一个收敛级数}\n    $$\n    这表明级数 $\\sum_p \\frac{\\chi(p)}{p}$ 是收敛的。设其值为 $B_\\chi$。由此可推断，当 $X \\to \\infty$ 时，部分和 $\\sum_{p \\le X} \\frac{\\chi(p)}{p}$ 收敛于 $B_\\chi$。\n\n结合这些结果，我们可以得出 $S_1(X)$ 和 $S_3(X)$ 的渐近行为：\n$$\nS_1(X) \\approx \\frac{1}{2} (\\log\\log X) + \\frac{1}{2} B_\\chi + O(1)\n$$\n$$\nS_3(X) \\approx \\frac{1}{2} (\\log\\log X) - \\frac{1}{2} B_\\chi + O(1)\n$$\n这表明 $S_1(X)$ 和 $S_3(X)$ 以相同的速率发散，且与 $\\log\\log X$ 成正比。更精确地说，它们都表现出 $\\sim \\frac{1}{2} \\log\\log X$ 的渐近行为。这就解释了为什么归一化量 $N_1(X) = S_1(X)/\\log\\log X$ 和 $N_3(X) = S_3(X)/\\log\\log X$ 预期会趋近于极限 $\\frac{1}{\\phi(4)} = \\frac{1}{2}$。\n\n这些和的发散是 Dirichlet 定理在此情况下的核心。如果某个剩余类 $a \\pmod q$ 中只存在有限个素数，那么对应的和 $S_a(X)$ 将是一个固定项的有限和，因此会收敛到一个常数。该和发散的事实证明了必定存在无穷多个这样的素数。\n\n差值 $D(X) = S_1(X) - S_3(X)$ 由下式给出：\n$$\nD(X) = \\left(\\frac{1}{2} \\sum_{p \\le X} \\frac{\\chi_0(p)}{p} + \\frac{1}{2} \\sum_{p \\le X} \\frac{\\chi(p)}{p}\\right) - \\left(\\frac{1}{2} \\sum_{p \\le X} \\frac{\\chi_0(p)}{p} - \\frac{1}{2} \\sum_{p \\le X} \\frac{\\chi(p)}{p}\\right) = \\sum_{p \\le X} \\frac{\\chi(p)}{p}\n$$\n如前所述，当 $X \\to \\infty$ 时，此和收敛于常数 $B_\\chi$。数值实验应显示 $D(X)$ 趋近于一个稳定值。\n\n该算法将首先使用 Eratosthenes 筛法生成直至最大截断值 $X$ 的所有素数。然后，对于每个截断值，它将遍历这些素数，将它们划分为模 $4$ 余 $1$ 和模 $4$ 余 $3$ 的剩余类，并计算所需的计数 ($C_1, C_3$) 和和 ($S_1, S_3$)。最后，它将计算派生量 $N_1, N_3, D, R$。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs a numerical experiment on the distribution of primes in residue\n    classes modulo 4, based on Dirichlet's theorem on arithmetic progressions.\n    \"\"\"\n\n    test_cases = [100, 5000, 100000, 1000000]\n    max_x = max(test_cases)\n\n    def sieve_of_eratosthenes(n):\n        \"\"\"\n        Generates a list of prime numbers up to n using the Sieve of Eratosthenes.\n        \n        Args:\n            n (int): The upper limit for prime generation.\n            \n        Returns:\n            list[int]: A list of primes up to n.\n        \"\"\"\n        primes_bool = [True] * (n + 1)\n        if n >= 0:\n            primes_bool[0] = False\n        if n >= 1:\n            primes_bool[1] = False\n        \n        for p in range(2, int(np.sqrt(n)) + 1):\n            if primes_bool[p]:\n                for i in range(p * p, n + 1, p):\n                    primes_bool[i] = False\n        \n        prime_numbers = [p for p, is_p in enumerate(primes_bool) if is_p]\n        return prime_numbers\n\n    # Generate all necessary primes once for efficiency.\n    primes = sieve_of_eratosthenes(max_x)\n\n    all_results = []\n\n    for X in test_cases:\n        s1 = 0.0\n        s3 = 0.0\n        c1 = 0\n        c3 = 0\n\n        # Iterate through the pre-computed primes up to the current cutoff X.\n        for p in primes:\n            if p > X:\n                break\n            \n            # The prime 2 does not have a residue of 1 or 3 mod 4.\n            if p == 2:\n                continue\n\n            rem = p % 4\n            if rem == 1:\n                s1 += 1.0 / p\n                c1 += 1\n            elif rem == 3:\n                s3 += 1.0 / p\n                c3 += 1\n\n        # Calculate the derived quantities as per the problem description.\n        loglogX = np.log(np.log(X))\n        \n        n1 = s1 / loglogX\n        n3 = s3 / loglogX\n        d = s1 - s3\n        \n        # The ratio of counts. C3 will not be zero for X >= 10.\n        r = c1 / c3 if c3 != 0 else 0.0\n\n        # Store the results for the current test case.\n        # X, c1, and c3 are required to be integers.\n        # Others are floats rounded to six decimal places.\n        case_result = [\n            X,\n            s1,\n            s3,\n            n1,\n            n3,\n            d,\n            c1,\n            c3,\n            r\n        ]\n        all_results.append(case_result)\n    \n    # Format the final output string according to the specified format.\n    # e.g., [[100, 0.492112, ...], [5000, 0.810696, ...], ...]\n    inner_lists_str = []\n    for res in all_results:\n        # Format a single inner list string.\n        formatted_res_str = [\n            f\"{res[0]}\",             # X (int)\n            f\"{res[1]:.6f}\",         # S1\n            f\"{res[2]:.6f}\",         # S3\n            f\"{res[3]:.6f}\",         # N1\n            f\"{res[4]:.6f}\",         # N3\n            f\"{res[5]:.6f}\",         # D\n            f\"{res[6]}\",             # C1 (int)\n            f\"{res[7]}\",             # C3 (int)\n            f\"{res[8]:.6f}\"          # R\n        ]\n        inner_lists_str.append(f\"[{','.join(formatted_res_str)}]\")\n    \n    final_output_str = f\"[{','.join(inner_lists_str)}]\"\n    print(final_output_str)\n\nsolve()\n```", "id": "3019540"}]}