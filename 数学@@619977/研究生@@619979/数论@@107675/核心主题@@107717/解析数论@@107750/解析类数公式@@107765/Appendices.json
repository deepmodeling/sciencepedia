{"hands_on_practices": [{"introduction": "为了真正掌握解析类数公式的精髓，我们从最基础的数域——有理数域 $\\mathbb{Q}$ ——开始。这个练习将引导你使用现代的adèle语言和Tate的理论，来审视这一宏大框架是如何具体应用于$\\mathbb{Q}$的。通过亲自计算，你将验证这个通用理论如何自然地导出黎曼$\\zeta$函数在$s=1$处的留数为1这一经典结果，从而在现代与经典之间建立起一座坚实的桥梁[@problem_id:3024644]。", "problem": "设 $K=\\mathbb{Q}$，令 $\\mathbb{A}$ 表示 $\\mathbb{Q}$ 的 adele 环，且 $\\mathbb{A}^{\\times}$ 为 idele 群。固定标准加法特征 $\\psi:\\mathbb{A}\\to \\mathbb{C}^{\\times}$，其在 $\\mathbb{Q}$ 上平凡，在阿基米德位由 $\\psi_{\\infty}(x_{\\infty})=\\exp(2\\pi i x_{\\infty})$ 给出，在每个有限位 $p$ 由唯一的非分支加法特征给出。将加法 Haar 测度 $dx=\\prod_{v}dx_{v}$ 归一化为关于 $\\psi$ 是自对偶的，并定义乘法 Haar 测度 $d^{\\times}x=\\prod_{v}d^{\\times}x_{v}$，使得在每个有限位 $p$ 有 $\\int_{\\mathbb{Z}_{p}^{\\times}} d^{\\times}x_{p}=1$，而在阿基米德位有 $d^{\\times}x_{\\infty}=dx_{\\infty}/|x_{\\infty}|_{\\infty}$。设 $\\mathcal{S}(\\mathbb{A})$ 为 $\\mathbb{A}$ 上的 Schwartz–Bruhat 空间，并令 $\\widehat{\\phi}$ 表示 $\\phi\\in\\mathcal{S}(\\mathbb{A})$ 关于 $\\psi$ 和所选的自对偶测度的 Fourier 变换。\n\n考虑函数 $\\phi=\\phi_{\\infty}\\otimes\\bigotimes_{p}\\phi_{p}\\in\\mathcal{S}(\\mathbb{A})$，定义为 $\\phi_{\\infty}(x_{\\infty})=\\exp(-\\pi x_{\\infty}^{2})$ 和 $\\phi_{p}=\\mathbf{1}_{\\mathbb{Z}_{p}}$。对于 $\\operatorname{Re}(s)>1$，定义全局 Tate zeta 积分\n$$\nZ(\\phi,s)\\;=\\;\\int_{\\mathbb{A}^{\\times}}\\phi(x)\\,|x|_{\\mathbb{A}}^{s}\\,d^{\\times}x\\,.\n$$\n仅使用上述基本定义（adele、idele、Haar 测度、Fourier 变换以及在 $\\mathbb{Q}\\subset\\mathbb{A}$ 上的 Poisson 求和）和以下广为接受的事实：\n- $\\mathbb{Q}$ 的乘积公式，\n- 当 $\\phi$ 为纯张量时，$Z(\\phi,s)$ 分解为局部 zeta 积分的 Euler 乘积，\n- 在 $\\mathbb{A}$ 上对 $\\mathbb{Q}$ 使用自对偶测度的 Poisson 求和公式，\n- $\\mathbb{Q}$ 上乘法群 $\\mathbb{G}_{m}$ 的 Tamagawa 数 $\\tau(\\mathbb{G}_{m})$ 等于 $1$，\n从第一性原理推导 $Z(\\phi,s)$ 在 $s=1$ 处的极点行为，并将其与 Riemann zeta 函数 $\\zeta(s)$ 在 $s=1$ 处的留数联系起来。\n\n具体地，在你的推导中执行以下步骤：\n1. 将 $Z(\\phi,s)$ 分解为局部积分 $Z_{v}(\\phi_{v},s)=\\int_{\\mathbb{Q}_{v}^{\\times}}\\phi_{v}(x_{v})\\,|x_{v}|_{v}^{s}\\,d^{\\times}x_{v}$ 的乘积，并对 $v=p$ 和 $v=\\infty$ 的情况，使用上述归一化显式计算每个因子。\n2. 使用在 $\\mathbb{A}$ 上的 Poisson 求和公式以及通过 idele 范数对 $\\mathbb{A}^{\\times}$ 的乘法分解，证明 $Z(\\phi,s)$ 的亚纯延拓在 $s=1$ 处有一个单极点，其留数等于 $\\tau(\\mathbb{G}_{m})\\cdot\\widehat{\\phi}(0)$。\n3. 结合你的结果并使用 $\\tau(\\mathbb{G}_{m})=1$ 和阿基米德因子在 $s=1$ 处的值，来确定 $\\operatorname{Res}_{s=1}\\zeta(s)$ 的值。\n\n你的最终答案必须是一个以精确形式（无近似）给出的单个实数。如果你在此过程中进行了任何近似，请明确说明它们不影响最终的精确值。在你的答案中只陈述最终的数值。", "solution": "该问题要求通过分析在有理数域 $K=\\mathbb{Q}$ 上针对特定函数 $\\phi \\in \\mathcal{S}(\\mathbb{A})$ 的 Tate zeta 积分 $Z(\\phi,s)$，来推导 Riemann zeta 函数在 $s=1$ 处的留数。推导将按照问题描述中概述的三个步骤进行。\n\nTate zeta 积分对 $\\operatorname{Re}(s)>1$ 定义为\n$$\nZ(\\phi,s)\\;=\\;\\int_{\\mathbb{A}^{\\times}}\\phi(x)\\,|x|_{\\mathbb{A}}^{s}\\,d^{\\times}x\n$$\n其中 $\\mathbb{A}$ 是 $\\mathbb{Q}$ 的 adele 环，$\\mathbb{A}^{\\times}$ 是 idele 群， $|x|_{\\mathbb{A}}$ 是 adelic 范数，而 $d^{\\times}x$ 是具有指定归一化的乘法 Haar 测度。函数 $\\phi$ 是纯张量 $\\phi=\\phi_{\\infty}\\otimes\\bigotimes_{p}\\phi_{p}$，其中 $\\phi_{\\infty}(x_{\\infty})=\\exp(-\\pi x_{\\infty}^{2})$ 且 $\\phi_{p}=\\mathbf{1}_{\\mathbb{Z}_{p}}$。\n\n**步骤 1：Euler 乘积分解与局部积分的计算**\n\n对于纯张量函数 $\\phi = \\bigotimes_{v} \\phi_v$，全局 zeta 积分可以分解为 $\\mathbb{Q}$ 的所有位 $v$ 上的局部 zeta 积分的乘积：\n$$\nZ(\\phi,s) = \\prod_{v} Z_{v}(\\phi_{v},s) \\quad \\text{其中} \\quad Z_{v}(\\phi_{v},s)=\\int_{\\mathbb{Q}_{v}^{\\times}}\\phi_{v}(x_{v})\\,|x_{v}|_{v}^{s}\\,d^{\\times}x_{v}\n$$\n我们计算阿基米德位 $v=\\infty$ 和有限位 $v=p$ 的这些局部积分。\n\n对于阿基米德位 $v=\\infty$，$ \\mathbb{Q}_\\infty = \\mathbb{R}$。我们有 $\\phi_{\\infty}(x_{\\infty})=\\exp(-\\pi x_{\\infty}^{2})$，测度为 $d^{\\times}x_{\\infty} = dx_{\\infty}/|x_{\\infty}|_{\\infty}$。绝对值是标准的绝对值，$|x|_\\infty = |x|$。\n\\begin{align*}\nZ_{\\infty}(\\phi_{\\infty},s) &= \\int_{\\mathbb{R}^{\\times}} \\exp(-\\pi x_{\\infty}^{2}) |x_{\\infty}|^{s} \\frac{dx_{\\infty}}{|x_{\\infty}|} \\\\\n&= \\int_{-\\infty}^{\\infty} \\exp(-\\pi x_{\\infty}^{2}) |x_{\\infty}|^{s-1} dx_{\\infty} \\\\\n&= 2 \\int_{0}^{\\infty} \\exp(-\\pi x^{2}) x^{s-1} dx\n\\end{align*}\n我们进行换元 $u = \\pi x^{2}$，这意味着 $x = (u/\\pi)^{1/2}$ 且 $dx = \\frac{1}{2\\sqrt{\\pi u}}du$。\n\\begin{align*}\nZ_{\\infty}(\\phi_{\\infty},s) &= 2 \\int_{0}^{\\infty} e^{-u} \\left(\\frac{u}{\\pi}\\right)^{(s-1)/2} \\frac{1}{2\\sqrt{\\pi u}} du \\\\\n&= \\frac{1}{\\pi^{(s-1)/2}} \\frac{1}{\\sqrt{\\pi}} \\int_{0}^{\\infty} e^{-u} u^{(s-1)/2} u^{-1/2} du \\\\\n&= \\pi^{-s/2} \\int_{0}^{\\infty} e^{-u} u^{s/2 - 1} du \\\\\n&= \\pi^{-s/2} \\Gamma\\left(\\frac{s}{2}\\right)\n\\end{align*}\n其中 $\\Gamma(z)$ 是 gamma 函数。这正是完备 Riemann zeta 函数的阿基米德因子。\n\n对于有限位 $v=p$，$ \\mathbb{Q}_p$ 是 $p$-进数域。我们有 $\\phi_{p}(x_{p})=\\mathbf{1}_{\\mathbb{Z}_{p}}(x_p)$，即 $p$-进整数 $\\mathbb{Z}_p$ 的特征函数。积分是在 $\\mathbb{Q}_p^\\times$ 上进行的。由于 $\\phi_p$ 的支集在 $\\mathbb{Z}_p$ 上，积分被限制在 $\\mathbb{Z}_p \\setminus \\{0\\}$。我们将这个集合分解为不相交的圆环： $\\mathbb{Z}_p \\setminus \\{0\\} = \\bigsqcup_{k=0}^{\\infty} p^k \\mathbb{Z}_p^\\times$。\n\\begin{align*}\nZ_{p}(\\phi_{p},s) &= \\int_{\\mathbb{Z}_{p} \\setminus \\{0\\}} |x_{p}|_{p}^{s} d^{\\times}x_{p} \\\\\n&= \\sum_{k=0}^{\\infty} \\int_{p^k \\mathbb{Z}_p^\\times} |x_{p}|_{p}^{s} d^{\\times}x_{p}\n\\end{align*}\n对于任何 $x_p \\in p^k \\mathbb{Z}_p^\\times$，$|x_p|_p = p^{-k}$。测度 $d^\\times x_p$ 在乘法群 $\\mathbb{Q}_p^\\times$ 上是平移不变的，所以 $\\int_{p^k \\mathbb{Z}_p^\\times} d^{\\times}x_{p} = \\int_{\\mathbb{Z}_p^\\times} d^{\\times}x_{p}$。问题陈述此测度被归一化为 $\\int_{\\mathbb{Z}_p^\\times} d^{\\times}x_{p} = 1$。\n因此，\n$$\nZ_{p}(\\phi_{p},s) = \\sum_{k=0}^{\\infty} (p^{-k})^{s} \\cdot 1 = \\sum_{k=0}^{\\infty} (p^{-s})^{k}\n$$\n这是一个几何级数，对于 $\\operatorname{Re}(s)>0$（特别是在我们的初始定义域 $\\operatorname{Re}(s)>1$）收敛于：\n$$\nZ_{p}(\\phi_{p},s) = \\frac{1}{1-p^{-s}}\n$$\n这正是 Riemann zeta 函数的 Euler $p$-因子。\n\n结合所有局部因子，我们得到全局 zeta 积分：\n$$\nZ(\\phi,s) = Z_{\\infty}(\\phi_{\\infty},s) \\prod_{p} Z_{p}(\\phi_{p},s) = \\pi^{-s/2} \\Gamma\\left(\\frac{s}{2}\\right) \\prod_{p} \\frac{1}{1-p^{-s}}\n$$\n所有素数的乘积是 Riemann zeta 函数 $\\zeta(s)$ 的定义。因此，对于 $\\operatorname{Re}(s)>1$，\n$$\nZ(\\phi,s) = \\pi^{-s/2} \\Gamma\\left(\\frac{s}{2}\\right) \\zeta(s)\n$$\n这个表达式将我们所选的 $\\phi$ 的 Tate zeta 积分与完备 Riemann zeta 函数联系起来。\n\n**步骤 2：亚纯延拓与极点结构**\n\nTate 理论的一般理论，其根本上依赖于在 adele 群 $\\mathbb{A}$ 上关于离散子群 $\\mathbb{Q}$ 的 Poisson 求和公式，建立了 $Z(\\phi,s)$ 到整个复平面的亚纯延拓。该理论指出 $Z(\\phi,s)$ 除了在 $s=0$ 和 $s=1$ 处的单极点外，处处全纯。其留数由以下公式给出：\n\\begin{align*}\n\\operatorname{Res}_{s=1} Z(\\phi, s) &= \\widehat{\\phi}(0) \\cdot \\tau(\\mathbb{G}_{m}) \\\\\n\\operatorname{Res}_{s=0} Z(\\phi, s) &= -\\phi(0) \\cdot \\tau(\\mathbb{G}_{m})\n\\end{align*}\n其中 $\\tau(\\mathbb{G}_{m}) = \\operatorname{vol}(\\mathbb{A}^{\\times,1}/\\mathbb{Q}^\\times)$ 是乘法群 $\\mathbb{G}_m$ 在 $\\mathbb{Q}$ 上关于由所选 Haar 测度导出的测度的 Tamagawa 数。问题假定这个事实是由 Poisson 求和推导出来的。\n\n推导问题中关于 $s=1$ 处留数为 $\\tau(\\mathbb{G}_{m})\\cdot\\phi(0)$ 的论断，需要证明 $\\widehat{\\phi}(0) = \\phi(0)$。让我们对给定的 $\\phi$ 验证这一点。\n首先，我们计算 $\\phi(0)$：\n$$\n\\phi(0) = \\phi_{\\infty}(0) \\prod_{p} \\phi_{p}(0) = \\exp(-\\pi \\cdot 0^2) \\prod_{p} \\mathbf{1}_{\\mathbb{Z}_{p}}(0) = 1 \\cdot \\prod_{p} 1 = 1\n$$\n接下来，我们计算 Fourier 变换 $\\widehat{\\phi} = \\bigotimes_v \\widehat{\\phi}_v$。\n对于 $v=\\infty$，$\\phi_\\infty(x) = \\exp(-\\pi x^2)$ 关于特征 $\\psi_\\infty(y) = \\exp(2\\pi i y)$ 的 Fourier 变换是众所周知的其自身：\n$$\n\\widehat{\\phi}_{\\infty}(y) = \\int_{\\mathbb{R}} \\exp(-\\pi x^2) \\exp(2\\pi i xy) dx = \\exp(-\\pi y^2) = \\phi_{\\infty}(y)\n$$\n对于有限位 $v=p$，$\\phi_p = \\mathbf{1}_{\\mathbb{Z}_p}$ 的 Fourier 变换是关于自对偶测度 $dx_p$（其满足 $\\int_{\\mathbb{Z}_p} dx_p = 1$）和特征 $\\psi_p$ 计算的。\n$$\n\\widehat{\\phi}_{p}(y) = \\int_{\\mathbb{Q}_p} \\mathbf{1}_{\\mathbb{Z}_p}(x) \\psi_p(xy) dx_p = \\int_{\\mathbb{Z}_p} \\psi_p(xy) dx_p\n$$\n如果 $y \\in \\mathbb{Z}_p$，那么对于任何 $x \\in \\mathbb{Z}_p$，乘积 $xy \\in \\mathbb{Z}_p$。由于 $\\psi_p$ 是非分支的（在 $\\mathbb{Z}_p$ 上平凡），$\\psi_p(xy)=1$。积分变为 $\\int_{\\mathbb{Z}_p} 1 \\, dx_p = 1 = \\phi_p(y)$。\n如果 $y \\notin \\mathbb{Z}_p$，映射 $x \\mapsto \\psi_p(xy)$ 是紧加法群 $\\mathbb{Z}_p$ 的一个非平凡特征，所以它的积分为 0。在这种情况下，$\\phi_p(y) = \\mathbf{1}_{\\mathbb{Z}_p}(y) = 0$。\n因此，对于所有 $y \\in \\mathbb{Q}_p$，有 $\\widehat{\\phi}_{p}(y) = \\phi_{p}(y)$。\n由于对所有位 $v$ 都有 $\\widehat{\\phi}_v = \\phi_v$，我们得到 $\\widehat{\\phi} = \\phi$。因此，$\\widehat{\\phi}(0) = \\phi(0) = 1$。\n那么对于 $s=1$ 的一般留数公式变为：\n$$\n\\operatorname{Res}_{s=1} Z(\\phi, s) = \\widehat{\\phi}(0) \\cdot \\tau(\\mathbb{G}_{m}) = \\phi(0) \\cdot \\tau(\\mathbb{G}_{m})\n$$\n正如问题陈述中所主张的。\n\n**步骤 3：确定 Riemann zeta 函数的留数**\n\n现在我们结合前两个步骤的结果。\n从步骤 2 中，使用值 $\\phi(0)=1$ 和给定的事实 $\\tau(\\mathbb{G}_{m})=1$，我们求得 Tate 积分的留数：\n$$\n\\operatorname{Res}_{s=1} Z(\\phi, s) = 1 \\cdot 1 = 1\n$$\n从步骤 1 中，我们有表达式 $Z(\\phi,s) = \\pi^{-s/2} \\Gamma(s/2) \\zeta(s)$。我们可以计算这个乘积在 $s=1$ 处的留数。函数 $\\zeta(s)$ 在 $s=1$ 处有一个单极点，而因子 $f(s) = \\pi^{-s/2} \\Gamma(s/2)$ 在 $s=1$ 处是解析且非零的。因此，乘积的留数是在 $s=1$ 处解析部分的值乘以极点部分的留数：\n\\begin{align*}\n\\operatorname{Res}_{s=1} Z(\\phi, s) &= \\operatorname{Res}_{s=1} \\left( \\left(\\pi^{-s/2} \\Gamma\\left(\\frac{s}{2}\\right)\\right) \\zeta(s) \\right) \\\\\n&= \\left(\\lim_{s\\to 1} \\pi^{-s/2} \\Gamma\\left(\\frac{s}{2}\\right)\\right) \\cdot \\left(\\operatorname{Res}_{s=1} \\zeta(s)\\right)\n\\end{align*}\n我们计算解析因子的极限：\n$$\n\\lim_{s\\to 1} \\pi^{-s/2} \\Gamma\\left(\\frac{s}{2}\\right) = \\pi^{-1/2} \\Gamma\\left(\\frac{1}{2}\\right)\n$$\n使用熟知的值 $\\Gamma(1/2) = \\sqrt{\\pi}$，这变为：\n$$\n\\pi^{-1/2} \\cdot \\sqrt{\\pi} = 1\n$$\n因此，我们有\n$$\n\\operatorname{Res}_{s=1} Z(\\phi, s) = 1 \\cdot \\operatorname{Res}_{s=1} \\zeta(s) = \\operatorname{Res}_{s=1} \\zeta(s)\n$$\n令我们在 $s=1$ 处对 $Z(\\phi,s)$ 留数的两次计算相等：\n$$\n\\operatorname{Res}_{s=1} \\zeta(s) = 1\n$$\n推导至此结束。Riemann zeta 函数在 $s=1$ 处的留数是 $1$。", "answer": "$$\\boxed{1}$$", "id": "3024644"}, {"introduction": "在建立了对基础情形的理解后，我们现在来处理一个更具代表性的例子：实二次域 $\\mathbb{Q}(\\sqrt{3})$。这个实践是一个完整的演练，要求你计算解析类数公式中的每一个关键部分，从代数侧的基本单位和调整子（regulator），到分析侧的L函数值。通过这个练习，你将亲身体验如何将这些部分组合起来，最终确定该域的类数，从而深刻理解公式的内在结构[@problem_id:3024661]。", "problem": "令 $K=\\mathbb{Q}(\\sqrt{d})$ 为一个实二次域，其中 $d>0$ 是无平方数因子的整数。考虑 $d=3$ 的具体情况。从基本定义和经过验证的公式出发，确定类数 $h_K$。\n\n任务：\n1. 确定 $K$ 的整数环 $\\mathcal{O}_K$ 及其判别式 $\\Delta_K$。\n2. 使用 $\\sqrt{d}$ 的连分数方法或 Pell 型方程的论证，求出 $d=3$ 时 $x^{2}-d y^{2}=1$ 的最小正整数解 $(x,y)$，并由此找到一个范数为 $N_{K/\\mathbb{Q}}(\\varepsilon)=1$ 的基本单位 $\\varepsilon \\in \\mathcal{O}_K^{\\times}$。计算正则子 $R_K=\\log \\varepsilon$。\n3. 令 $\\chi_{\\Delta_K}$ 为与 $K$ 相关联的、模 $|\\Delta_K|$ 的本原二次 Dirichlet 特征（Kronecker 符号），并令 $L(s,\\chi_{\\Delta_K})$ 为其 Dirichlet $L$-函数。通过将级数按模 $|\\Delta_K|$ 的剩余类进行组织，从其 Dirichlet 级数定义出发计算 $L(1,\\chi_{\\Delta_K})$ 的值。\n4. 使用解析类数公式，根据你计算出的正则子和 $L(1,\\chi_{\\Delta_K})$ 来确定 $h_K$。将你的最终答案表示为一个整数。\n\n注：除了其定义的 Dirichlet 级数和 Dirichlet 特征的标准性质外，不要假设或引用任何关于 $L(1,\\chi_{\\Delta_K})$ 的特殊闭式恒等式。你可以使用因子分解 $\\zeta_K(s)=\\zeta(s)\\,L(s,\\chi_{\\Delta_K})$ 以及关于 $s=1$ 处 Dedekind zeta 函数留数的一般公式（用 $h_K$ 和正则子表示）。由于最终答案是整数，因此不需要舍入说明。", "solution": "该问题已经过验证，并被认为是有效的，因为它在代数数论中有科学依据，问题提出得当且客观。它包含一个标准的、可验证的计算。我们按照四个指定的任务进行求解。\n\n问题集中于实二次域 $K = \\mathbb{Q}(\\sqrt{d})$ 在 $d=3$ 时的具体情况。\n\n任务 1：确定整数环 $\\mathcal{O}_K$ 和判别式 $\\Delta_K$。\n对于一个二次域 $K = \\mathbb{Q}(\\sqrt{d})$，其中 $d$ 是一个无平方数因子的整数，其整数环 $\\mathcal{O}_K$ 由 $\\mathbb{Z}[\\omega]$ 给出，其中当 $d \\equiv 2$ 或 $3 \\pmod 4$ 时，$\\omega = \\sqrt{d}$；当 $d \\equiv 1 \\pmod 4$ 时，$\\omega = \\frac{1+\\sqrt{d}}{2}$。域判别式 $\\Delta_K$ 在第一种情况下为 $4d$，在第二种情况下为 $d$。\n在我们的例子中，$d=3$，满足 $3 \\equiv 3 \\pmod 4$。因此，$K = \\mathbb{Q}(\\sqrt{3})$ 的整数环是 $\\mathcal{O}_K = \\mathbb{Z}[\\sqrt{3}]$。判别式为 $\\Delta_K = 4d = 4 \\times 3 = 12$。\n\n任务 2：计算基本单位 $\\varepsilon$ 和正则子 $R_K$。\n实二次域的基本单位与 Pell 方程的最小正整数解有关。对于 $K = \\mathbb{Q}(\\sqrt{3})$，我们分析方程 $x^2 - 3y^2 = \\pm 1$。问题建议使用 $\\sqrt{3}$ 的连分数展开。\n展开式为：\n$$ \\sqrt{3} = 1 + (\\sqrt{3}-1) = 1 + \\frac{1}{\\frac{1}{\\sqrt{3}-1}} = 1 + \\frac{1}{\\frac{\\sqrt{3}+1}{2}} = 1 + \\frac{1}{1 + \\frac{\\sqrt{3}-1}{2}} = 1 + \\frac{1}{1 + \\frac{1}{\\sqrt{3}+1}} = 1 + \\frac{1}{1 + \\frac{1}{2 + (\\sqrt{3}-1)}} $$\n这个过程会重复，所以 $\\sqrt{3}$ 的连分数展开是周期的：$\\sqrt{3} = [1; \\overline{1, 2}]$。周期长度为 $r=2$。其渐近分数为 $c_0 = \\frac{1}{1}$，$c_1 = 1+\\frac{1}{1} = \\frac{2}{1}$，$c_2 = 1+\\frac{1}{1+\\frac{1}{2}} = \\frac{5}{3}$，等等。\n方程 $x^2 - 3y^2 = (-1)^r = (-1)^2 = 1$ 的基本解 $(x,y)$ 由第 $(r-1)$ 个渐近分数的分子和分母给出，即 $c_{2-1}=c_1=2/1$。因此，最小正整数解是 $(x,y)=(2,1)$。快速检验可确认 $2^2 - 3(1^2) = 4-3=1$。\n$\\mathcal{O}_K = \\mathbb{Z}[\\sqrt{3}]$ 中的单位形如 $a+b\\sqrt{3}$，其中 $a,b \\in \\mathbb{Z}$ 且 $N_{K/\\mathbb{Q}}(a+b\\sqrt{3}) = a^2-3b^2 = \\pm 1$。方程 $a^2-3b^2 = -1$ 没有整数解，因为这意味着 $a^2 \\equiv -1 \\pmod 3$，而这是不可能的。因此，所有单位的范数都为 $1$。基本单位 $\\varepsilon$ 是大于 $1$ 的最小单位。它对应于 $x^2 - 3y^2 = 1$ 的最小正整数解，所以 $\\varepsilon = 2+\\sqrt{3}$。\n$K$ 的正则子定义为 $R_K = \\ln|\\varepsilon_{fund}|$，其中 $\\varepsilon_{fund}$ 是基本单位。对于 $K=\\mathbb{Q}(\\sqrt{3})$，我们有一个基本单位 $\\varepsilon = 2+\\sqrt{3}$，所以正则子是 $R_K = \\ln(2+\\sqrt{3})$。\n\n任务 3：计算 $L(1, \\chi_{\\Delta_K})$ 的值。\n判别式为 $\\Delta_K = 12$。相关联的本原二次 Dirichlet 特征是 Kronecker 符号 $\\chi_{12}(n) = (\\frac{12}{n})$。此特征的导子为 $12$。对于与 $12$ 互质的 $n$，其值为：\n$\\chi_{12}(1) = (\\frac{12}{1}) = 1$\n$\\chi_{12}(5) = (\\frac{12}{5}) = (\\frac{2}{5}) = -1$\n$\\chi_{12}(7) = (\\frac{12}{7}) = (\\frac{5}{7}) = -1$\n$\\chi_{12}(11) = (\\frac{12}{11}) = (\\frac{1}{11}) = 1$\n对于任何与 $12$ 不互质的整数 $n$，$\\chi_{12}(n)=0$。\nDirichlet $L$-函数为 $L(s, \\chi_{12}) = \\sum_{n=1}^{\\infty} \\frac{\\chi_{12}(n)}{n^s}$。我们必须在 $s=1$ 处计算它的值。\n$$ L(1, \\chi_{12}) = \\sum_{n=1}^{\\infty} \\frac{\\chi_{12}(n)}{n} = 1 - \\frac{1}{5} - \\frac{1}{7} + \\frac{1}{11} + \\frac{1}{13} - \\frac{1}{17} - \\frac{1}{19} + \\frac{1}{23} - \\dots $$\n我们可以根据各项模 $12$ 的余数进行分组：\n$$ L(1, \\chi_{12}) = \\sum_{k=0}^{\\infty} \\left( \\frac{1}{12k+1} - \\frac{1}{12k+5} - \\frac{1}{12k+7} + \\frac{1}{12k+11} \\right) $$\n利用恒等式 $\\frac{1}{m} = \\int_0^1 x^{m-1} dx$，我们可以将该和写成一个积分：\n$$ L(1, \\chi_{12}) = \\int_0^1 \\sum_{k=0}^{\\infty} \\left( x^{12k} - x^{12k+4} - x^{12k+6} + x^{12k+10} \\right) dx $$\n对积分内的几何级数求和得到：\n$$ L(1, \\chi_{12}) = \\int_0^1 \\frac{1-x^4-x^6+x^{10}}{1-x^{12}} dx = \\int_0^1 \\frac{(1-x^4)(1-x^6)}{(1-x^6)(1+x^6)} dx = \\int_0^1 \\frac{1-x^4}{1+x^6} dx $$\n分母可以因式分解为 $1+x^6 = (1+x^2)(1-x^2+x^4)$。被积函数变为：\n$$ \\frac{(1-x^2)(1+x^2)}{(1+x^2)(x^4-x^2+1)} = \\frac{1-x^2}{x^4-x^2+1} $$\n所以我们计算 $I = \\int_0^1 \\frac{1-x^2}{x^4-x^2+1} dx$。我们将分子和分母同除以 $x^2$：\n$$ I = \\int_0^1 \\frac{\\frac{1}{x^2}-1}{x^2-1+\\frac{1}{x^2}} dx = \\int_0^1 \\frac{\\frac{1}{x^2}-1}{\\left(x+\\frac{1}{x}\\right)^2-3} dx $$\n令 $t = x+\\frac{1}{x}$。则 $dt = (1-\\frac{1}{x^2})dx$。$t$ 的积分限是从 $x=0^+$ 到 $x=1$。当 $x \\to 0^+$ 时，$t \\to \\infty$。当 $x \\to 1$ 时，$t \\to 2$。\n$$ I = \\int_{\\infty}^{2} \\frac{-dt}{t^2-3} = \\int_2^{\\infty} \\frac{dt}{t^2-3} $$\n使用部分分式分解，$\\frac{1}{t^2-3} = \\frac{1}{2\\sqrt{3}}\\left(\\frac{1}{t-\\sqrt{3}}-\\frac{1}{t+\\sqrt{3}}\\right)$。\n$$ I = \\frac{1}{2\\sqrt{3}} \\left[ \\ln|t-\\sqrt{3}| - \\ln|t+\\sqrt{3}| \\right]_2^{\\infty} = \\frac{1}{2\\sqrt{3}} \\left[ \\ln\\left|\\frac{t-\\sqrt{3}}{t+\\sqrt{3}}\\right| \\right]_2^{\\infty} $$\n在积分限处求值：\n$$ I = \\lim_{t\\to\\infty} \\frac{1}{2\\sqrt{3}} \\ln\\left|\\frac{1-\\frac{\\sqrt{3}}{t}}{1+\\frac{\\sqrt{3}}{t}}\\right| - \\frac{1}{2\\sqrt{3}} \\ln\\left(\\frac{2-\\sqrt{3}}{2+\\sqrt{3}}\\right) = 0 - \\frac{1}{2\\sqrt{3}} \\ln\\left(\\frac{(2-\\sqrt{3})^2}{4-3}\\right) $$\n$$ I = -\\frac{1}{2\\sqrt{3}} \\ln\\left((2-\\sqrt{3})^2\\right) = -\\frac{2}{2\\sqrt{3}} \\ln(2-\\sqrt{3}) = -\\frac{1}{\\sqrt{3}} \\ln\\left(\\frac{1}{2+\\sqrt{3}}\\right) = \\frac{\\ln(2+\\sqrt{3})}{\\sqrt{3}} $$\n因此，$L(1, \\chi_{12}) = \\frac{\\ln(2+\\sqrt{3})}{\\sqrt{3}}$。\n\n任务 4：计算类数 $h_K$。\n解析类数公式指出，Dedekind zeta 函数 $\\zeta_K(s)$ 在 $s=1$ 处的留数由以下公式给出：\n$$ \\lim_{s\\to 1} (s-1)\\zeta_K(s) = \\frac{2^{r_1}(2\\pi)^{r_2}h_K R_K}{w_K\\sqrt{|\\Delta_K|}} $$\n对于 $K=\\mathbb{Q}(\\sqrt{3})$，我们有两个实嵌入，没有复嵌入，所以 $r_1=2$ 且 $r_2=0$。实二次域中的单位根个数为 $w_K=2$（即 $\\pm 1$）。我们有 $\\Delta_K = 12$ 和 $R_K = \\ln(2+\\sqrt{3})$。\n将这些值代入公式中：\n$$ \\operatorname{Res}_{s=1}(\\zeta_K(s)) = \\frac{2^2 (2\\pi)^0 h_K \\ln(2+\\sqrt{3})}{2\\sqrt{12}} = \\frac{4 h_K \\ln(2+\\sqrt{3})}{2(2\\sqrt{3})} = \\frac{h_K \\ln(2+\\sqrt{3})}{\\sqrt{3}} $$\n问题提供了因子分解 $\\zeta_K(s) = \\zeta(s) L(s, \\chi_{\\Delta_K})$。在 $s=1$ 处取留数：\n$$ \\operatorname{Res}_{s=1}(\\zeta_K(s)) = \\lim_{s\\to 1} (s-1)\\zeta(s) L(s, \\chi_{\\Delta_K}) = \\left(\\lim_{s\\to 1} (s-1)\\zeta(s)\\right) \\left(\\lim_{s\\to 1} L(s, \\chi_{\\Delta_K})\\right) $$\n由于 Riemann zeta 函数 $\\zeta(s)$ 在 $s=1$ 处的留数为 $1$，且 $L(s, \\chi_{12})$ 在 $s=1$ 处是连续的，所以上式简化为：\n$$ \\operatorname{Res}_{s=1}(\\zeta_K(s)) = 1 \\cdot L(1, \\chi_{12}) = L(1, \\chi_{12}) $$\n令两个留数表达式相等：\n$$ \\frac{h_K \\ln(2+\\sqrt{3})}{\\sqrt{3}} = L(1, \\chi_{12}) $$\n代入我们计算出的 $L(1, \\chi_{12})$ 的值：\n$$ \\frac{h_K \\ln(2+\\sqrt{3})}{\\sqrt{3}} = \\frac{\\ln(2+\\sqrt{3})}{\\sqrt{3}} $$\n由于 $\\ln(2+\\sqrt{3}) \\neq 0$，我们可以消去两边的项 $\\frac{\\ln(2+\\sqrt{3})}{\\sqrt{3}}$，得到：\n$$ h_K = 1 $$\n域 $\\mathbb{Q}(\\sqrt{3})$ 的类数为 $1$。", "answer": "$$\\boxed{1}$$", "id": "3024661"}, {"introduction": "解析类数公式的核心在于L函数的值 $L(1, \\chi)$。虽然在某些特殊情况下可以得到其精确的封闭形式，但在更一般的情形中，我们必须依赖数值近似。本练习将带你进入计算数论的实践领域，通过截断Dirichlet级数来近似$L(1, \\chi_d)$的值，并使用Pólya–Vinogradov不等式等分析工具严格地控制截断误差[@problem_id:3024687]。这个过程不仅能加深你对L函数分析性质的理解，也是现代数学研究中不可或缺的技能。", "problem": "考虑与一个基本判别式 $d \\in \\mathbb{Z}$ 相关联的本原二次 Dirichlet 特征 $\\chi_d$，并考察其在点 $s=1$ 处的实值 Dirichlet 级数。该 Dirichlet 级数由 $L(1,\\chi_d) = \\sum_{n \\ge 1} \\chi_d(n) n^{-1}$ 定义，其中 $\\chi_d(n)$ 是由 Kronecker 符号 $(d/n)$ 给出的二次特征。\n\n你的任务是设计一个算法，通过在有限截断点 $N$ 处截断级数来近似计算 $L(1,\\chi_d)$，并结合特征和 $S(x) = \\sum_{n \\le x} \\chi_d(n)$ 的一个一致估计，使用分部求和来界定截断误差。\n\n具体要求如下：\n\n1. 对于 $n \\in \\mathbb{Z}_{\\ge 1}$ 和基本判别式 $d$，使用 Kronecker 符号 $(d/n)$ 来定义 $\\chi_d(n)$。你可以依赖 Kronecker 符号的标准性质，包括其积性、其作为 Jacobi 符号在奇数模上的推广，以及通过模 8 的剩余类在素数 2 处的求值方法。\n\n2. 令 $q$ 表示 $\\chi_d$ 的指挥子。对于基本判别式 $d$，可取 $q = |d|$。定义 $S(x) = \\sum_{n \\le x} \\chi_d(n)$ 并使用分部求和将尾项\n   $$\\sum_{n > N} \\frac{\\chi_d(n)}{n}$$\n   表示为 $S(x)$ 的形式。然后，使用一个经过充分检验的特征和估计（Pólya–Vinogradov 不等式），采用显式界\n   $$|S(x)| \\le C \\sqrt{q} \\log q \\quad \\text{for all } x \\ge 1,$$\n   其中 $C = 2$ 是一个固定的数值常数。从分部求和推导出截断误差的界为\n   $$\\left|\\sum_{n > N} \\frac{\\chi_d(n)}{n}\\right| \\le \\frac{C \\sqrt{q} \\log q}{N}。$$\n\n3. 利用 $\\chi_d$ 模 $q$ 的周期性，实现对截断和\n   $$L_N(1,\\chi_d) = \\sum_{n=1}^{N} \\frac{\\chi_d(n)}{n}$$\n   的高效计算，以降低计算成本。你的实现必须能处理负（虚二次）和正（实二次）两种基本判别式。\n\n4. 对于下方测试套件中的每个测试用例 $(d,N)$，计算两个量：\n   - 截断近似值 $L_N(1,\\chi_d)$（作为浮点数）。\n   - 截断误差的严格上界 $E(d,N) = C \\sqrt{q} \\log q / N$（作为浮点数）。\n\n5. 测试套件：\n   - $(d,N) = (-4, 100000)$\n   - $(d,N) = (-7, 200000)$\n   - $(d,N) = (5, 200000)$\n   - $(d,N) = (8, 250000)$\n   - $(d,N) = (-163, 800000)$\n   - $(d,N) = (-3, 300000)$\n\n6. 最终输出格式：你的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表。列表内容需严格按照上述测试套件的顺序，将每个测试用例的结果对 $(L_N(1,\\chi_d), E(d,N))$ 展平后放入列表。具体来说，输出必须具有以下形式\n   $$[L_N(1,\\chi_{-4}),E(-4,100000),L_N(1,\\chi_{-7}),E(-7,200000),\\dots,L_N(1,\\chi_{-3}),E(-3,300000)]。$$\n所有数字必须使用 Python 的默认字符串转换打印为十进制浮点值。不涉及任何物理单位。", "solution": "该问题被评估为有效，因为它基于解析数论的既定原理，具有科学依据，问题陈述良定，并以客观、正式的语言表述。该问题要求基于标准的数学公式和概念，实现一个算法来近似计算 Dirichlet L-级数并计算误差界。\n\n### 1. 理论框架\n\n问题围绕与本原二次特征 $\\chi_d$ 相关联的 Dirichlet L-级数展开，其定义为：\n$$L(s, \\chi_d) = \\sum_{n=1}^{\\infty} \\frac{\\chi_d(n)}{n^s}$$\n我们关心的是其在 $s=1$ 处的值，即 $L(1, \\chi_d)$。特征 $\\chi_d$ 与一个基本判别式 $d \\in \\mathbb{Z}$ 相关联，并由 Kronecker 符号 $\\chi_d(n) = (d/n)$ 给出。对于一个基本判别式 $d$，特征 $\\chi_d$ 的指挥子为 $q = |d|$。\n\n### 2. 截断和与误差界\n\n值 $L(1, \\chi_d)$ 通过一个截断和（或部分和）来近似，该和计算到截断点 $N$ 为止：\n$$L_N(1, \\chi_d) = \\sum_{n=1}^{N} \\frac{\\chi_d(n)}{n}$$\n此近似的误差是级数的尾项：\n$$\\text{Error} = L(1, \\chi_d) - L_N(1, \\chi_d) = \\sum_{n=N+1}^{\\infty} \\frac{\\chi_d(n)}{n}$$\n为界定此误差，我们使用分部求和（也称为 Abel 求和公式）。令 $S(x) = \\sum_{k=1}^{\\lfloor x \\rfloor} \\chi_d(k)$。该公式表明，对于一个序列 $(a_n)$ 和一个可微函数 $f(x)$：\n$$\\sum_{n=M+1}^{N} a_n f(n) = S_N f(N) - S_M f(M) - \\int_M^N S(t)f'(t)dt$$\n其中 $S_k = \\sum_{i=1}^k a_i$。\n将此公式应用于我们的尾项和，取 $a_n = \\chi_d(n)$ 和 $f(n) = 1/n$：\n$$\\sum_{n=N+1}^{\\infty} \\frac{\\chi_d(n)}{n} = \\lim_{M \\to \\infty} \\left( \\frac{S(M)}{M} - \\frac{S(N)}{N} - \\int_{N}^{M} S(t) \\left(-\\frac{1}{t^2}\\right) dt \\right) = -\\frac{S(N)}{N} + \\int_{N}^{\\infty} \\frac{S(t)}{t^2} dt$$\n这里用到了 $|S(x)|$ 的增长速度慢于 $x$ 这一事实，因此 $\\lim_{M \\to \\infty} S(M)/M = 0$。\n\n问题提供了 Pólya–Vinogradov 不等式来界定特征和 $S(x)$：\n$$|S(x)| = \\left|\\sum_{n=1}^{\\lfloor x \\rfloor} \\chi_d(n)\\right| \\le C \\sqrt{q} \\log q$$\n其中常数 $C=2$，指挥子 $q=|d|$。使用此界，我们可以估计误差的大小：\n$$\\left|\\sum_{n > N} \\frac{\\chi_d(n)}{n}\\right| \\le \\left|-\\frac{S(N)}{N}\\right| + \\left|\\int_{N}^{\\infty} \\frac{S(t)}{t^2} dt\\right| \\le \\frac{|S(N)|}{N} + \\int_{N}^{\\infty} \\frac{|S(t)|}{t^2} dt$$\n代入 $|S(t)|$ 的界：\n$$\\left|\\sum_{n > N} \\frac{\\chi_d(n)}{n}\\right| \\le \\frac{C \\sqrt{q} \\log q}{N} + \\int_{N}^{\\infty} \\frac{C \\sqrt{q} \\log q}{t^2} dt = \\frac{C \\sqrt{q} \\log q}{N} + C \\sqrt{q} \\log q \\left[-\\frac{1}{t}\\right]_{N}^{\\infty}$$\n$$\\left|\\sum_{n > N} \\frac{\\chi_d(n)}{n}\\right| \\le \\frac{C \\sqrt{q} \\log q}{N} + \\frac{C \\sqrt{q} \\log q}{N} = \\frac{2C \\sqrt{q} \\log q}{N}$$\n问题陈述提供了一个稍紧的界 $E(d,N) = \\frac{C \\sqrt{q} \\log q}{N}$，这是通过更精细地应用分部求和得出的。我们将遵循所提供的误差界公式 $E(d,N)$。\n\n### 3. 算法设计\n\n主要的计算任务是计算截断和 $L_N(1, \\chi_d)$ 与误差界 $E(d,N)$。\n\n#### 3.1. 计算特征 $\\chi_d(n)$\n\n特征 $\\chi_d(n)$ 由 Kronecker 符号 $(d/n)$ 给出。对于基本判别式 $d$，特征 $\\chi_d$ 是本原的，其指挥子为 $q=|d|$。其值的确定方式如下：\n1.  如果 $\\gcd(n, q) > 1$，则 $\\chi_d(n) = 0$。\n2.  如果 $\\gcd(n, q) = 1$，则 $\\chi_d(n)$ 由 Kronecker 符号 $(d/n)$ 给出，其值为 $1$ 或 $-1$。\n\n我们实现一个函数 `chi(d, n)` 来计算此值。该函数首先检查 $\\gcd(n, |d|) > 1$ 是否成立。若成立，则返回 $0$。否则，它使用一个基于二次互反律及其补充定律的迭代算法来计算 Kronecker 符号。该算法处理 $d$ 的符号和 $n$ 的素因子分解（特别是因子 $2$）以正确地计算该符号。\n\n#### 3.2. 计算截断和 $L_N(1, \\chi_d)$\n\n从 $n=1$ 到 $N$ 直接求和将需要调用 `chi(d, n)` 函数 $N$ 次。为优化此过程，我们按照问题建议，利用特征 $\\chi_d$ 的周期性。由于 $\\chi_d$ 的周期为 $q=|d|$，$\\chi_d(n)$ 的值仅取决于 $n \\pmod q$。\n\n算法如下：\n1.  令 $q = |d|$。\n2.  预计算一个长度为 $q$ 的数组 `chi_values`，其中 `chi_values[j] = chi(d, j)`，对于 $j \\in \\{0, 1, \\dots, q-1\\}$。\n3.  初始化和 `L_N = 0.0`。\n4.  从 $1$ 到 $N$ 迭代 $n$。在每一步中，将 `chi_values[n % q] / n` 加到和 `L_N` 中。\n\n这种方法显著降低了计算成本，因为可能开销很大的 `chi` 计算仅执行 $q$ 次，而主循环只涉及简单的数组查找和算术运算。\n\n#### 3.3. 计算误差界 $E(d,N)$\n\n误差界根据给定公式直接计算：\n$$E(d,N) = \\frac{C \\sqrt{q} \\log q}{N}$$\n其中 $C=2$，$q=|d|$，$\\log$ 是自然对数。我们使用 `numpy` 的平方根和对数函数以保证数值精度。\n\n最终的实现将处理测试套件中的每个 $(d,N)$ 对，计算出值对 $(L_N(1,\\chi_d), E(d,N))$，并将输出格式化为单个展平的列表。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport math\n\n# Do not import any other libraries.\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    It computes the truncated L-series sum and its error bound for each case.\n    \"\"\"\n\n    def chi(d, n):\n        \"\"\"\n        Computes the quadratic character chi_d(n) for a fundamental discriminant d.\n        This is implemented using the Kronecker symbol (d/n).\n        \"\"\"\n        # The character is periodic with conductor q = |d|.\n        q = abs(d)\n\n        # For a primitive character, chi_d(n) = 0 if gcd(n, q) > 1.\n        if math.gcd(n, q) > 1:\n            return 0\n        \n        # Now, compute the Kronecker symbol (d/n) for gcd(n, q) = 1.\n        # This implementation follows the standard iterative algorithm.\n        \n        if n == 0:\n            return 1 if q == 1 else 0\n        if n == 1:\n            return 1\n        \n        # Factor out powers of 2 from n: n = 2^k * m\n        k = 0\n        while n % 2 == 0:\n            k += 1\n            n //= 2\n        \n        # Contribution from (d/2)^k\n        if k % 2 == 0:\n            res = 1\n        else:\n            d_mod_8 = d % 8\n            if d_mod_8 == 1 or d_mod_8 == 7:\n                res = 1\n            elif d_mod_8 == 3 or d_mod_8 == 5:\n                res = -1\n            else: # d is even, but gcd(n,d)=1 implies n is odd, so k=0.\n                  # This branch should not be reached for valid inputs.\n                res = 0\n\n        # If the odd part of n is 1, we are done.\n        if n == 1:\n            return res\n\n        # Contribution from (d/m) for m odd\n        # Using quadratic reciprocity for the Jacobi symbol.\n        if d  0:\n            if n % 4 == 3:\n                res *= -1\n            d = -d\n\n        while d != 0:\n            # Factor out powers of 2 from d\n            v = 0\n            while d % 2 == 0:\n                v += 1\n                d //= 2\n            \n            if v % 2 == 1:\n                n_mod_8 = n % 8\n                if n_mod_8 == 3 or n_mod_8 == 5:\n                    res *= -1\n            \n            if d == 1:\n                break\n                \n            # Apply quadratic reciprocity rule\n            if d % 4 == 3 and n % 4 == 3:\n                res *= -1\n            \n            # Swap roles and reduce\n            d, n = n % d, d\n            \n        return res\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (-4, 100000),\n        (-7, 200000),\n        (5, 200000),\n        (8, 250000),\n        (-163, 800000),\n        (-3, 300000)\n    ]\n\n    results = []\n    for d, N in test_cases:\n        q = abs(d)\n        \n        # Pre-compute character values for one period\n        chi_values = np.array([chi(d, j) for j in range(q)])\n        \n        # Compute the truncated sum L_N(1, chi_d)\n        # We use a vectorized operation for better performance where possible,\n        # but a simple loop is clear and efficient enough here.\n        n_vals = np.arange(1, N + 1)\n        # Using the pre-computed values via modulus operator to leverage periodicity\n        chi_d_of_n = chi_values[n_vals % q]\n        l_sum = np.sum(chi_d_of_n / n_vals)\n        \n        # Compute the error bound E(d, N)\n        C = 2.0\n        # For d = -1, q = 1, log(1)=0. Must handle this, though not in test cases.\n        if q == 1:\n            error_bound = 0.0\n        else:\n            error_bound = (C * np.sqrt(q) * np.log(q)) / N\n        \n        results.append(l_sum)\n        results.append(error_bound)\n\n    # Final print statement in the exact required format.\n    # The map(str, ...) converts all numbers to strings using Python's default float representation.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "3024687"}]}