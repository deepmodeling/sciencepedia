{"hands_on_practices": [{"introduction": "理论的美妙之处在于其在实践中的应用。二次型类数理论的核心在于将无穷多的等价二次型简化为有限个唯一的“既约”代表。这个练习 [@problem_id:3010008] 将引导您亲手执行高斯既约算法，将一个给定的正定二次型通过一系列幺模变换，一步步化为其等价类中唯一的既约型。掌握这个过程是计算类数和理解类群结构的基础。", "problem": "设 $f(x,y) = a x^{2} + b x y + c y^{2}$ 是一个整系数二元二次型，其判别式为 $D = b^{2} - 4 a c$, 且 $a > 0$。假设 $f$ 是本原正定的 (即 $D < 0$ 且 $\\gcd(a,b,c) = 1$）。如果存在一个矩阵 $M \\in \\mathrm{SL}_{2}(\\mathbb{Z})$ 使得 $f'(x,y) = f((x,y)M)$，则称两个二次型 $[a,b,c]$ 和 $[a',b',c']$ 是等价的。此种等价关系保持判别式和正定性不变。如果一个正定二次型 $[a,b,c]$ 满足 $|b| \\leq a \\leq c$，并且在 $|b| = a$ 或 $a = c$ 的情况下额外满足 $b \\geq 0$，则称该二次型是简约的。\n\n从本原正定二次型 $[a,b,c] = [103, 78, 59]$（其判别式 $D = -18224$）出发，仅使用上述定义和初等幺模替换的作用，明确地执行简约过程，并找出其等价类中的一个简约代表元。在你的论证中，通过求解适当的不等式来推导每一次替换的选择，以使中间系数被驱入典范区间，并确保首项系数不被末项系数超过。\n\n然后，通过证明另一组不同选择的初始幺模替换序列仍然能得到相同的简约代表元，来验证输出的唯一性。总结说明为什么这种唯一性能确保对于判别式 $D = -18224$，计算简约代表元的数量可以得到一个良定义的类数。\n\n你的最终答案必须是简约代表元，写成其系数的有序三元组形式。使用 $\\mathrm{pmatrix}$ 环境将最终答案表示为一个行向量。无需进行四舍五入。", "solution": "问题陈述是二元二次型经典理论中的一个良构练习。所有给定条件都是一致的、数学上合理的，并基于已建立的数论。本原正定二次型、通过 $\\mathrm{SL}_{2}(\\mathbb{Z})$ 作用定义的等价关系以及简约二次型的定义都是标准的。初始二次型 $[103, 78, 59]$ 的判别式被正确地计算为 $D = 78^{2} - 4(103)(59) = 6084 - 24308 = -18224$。由于 $\\gcd(103, 78, 59) = 1$（因为 $103$ 和 $59$ 是素数，且不能整除 $78$），该二次型是本原的；又因为 $a=103 > 0$ 和 $D < 0$，它是正定的。因此，该问题是有效的。\n\n对本原正定二元二次型 $[a,b,c]$ 的简约化是一个算法过程，旨在找到其等价类中满足条件 $|b| \\leq a \\leq c$（并且在 $|b|=a$ 或 $a=c$ 时有 $b \\geq 0$）的唯一代表元。变换是通过矩阵 $M \\in \\mathrm{SL}_{2}(\\mathbb{Z})$ 实现的。问题指明，新的二次型 $f'$ 是通过 $f'(x,y) = f((x,y)M)$ 从 $f$ 得到的。如果 $f(u,v) = au^2+buv+cv^2$ 且 $M = \\begin{pmatrix} p & q \\\\ r & s \\end{pmatrix}$，那么在标准的变量替换约定下，有 $(u,v) = (px+ry, qx+sy)$。然而，问题的记法 $(x,y)M$ 意味着 $(u,v) = (x,y)\\begin{pmatrix} p & q \\\\ r & s \\end{pmatrix} = (xp+yr, xq+ys)$。那么 $f'(x,y) = a'x^2+b'xy+c'y^2$ 的新系数 $[a', b', c']$ 由 $a' = f(p,q)$、$c' = f(r,s)$ 和 $b' = 2apr+b(ps+qr)+2cqs$ 给出。我们将使用这个约定。\n\n简约算法包括两个基于 $\\mathrm{SL}_{2}(\\mathbb{Z})$ 中初等矩阵的主要操作：\n1.  矩阵 $S = \\begin{pmatrix} 0 & -1 \\\\ 1 & 0 \\end{pmatrix}$。将此矩阵对应的变换应用于二次型 $[a,b,c]$，得到 $[f(0,-1), b', f(1,0)]=[c, -b, a]$。当 $a > c$ 时使用此操作。\n2.  对于整数 $k$，矩阵为 $U_k = \\begin{pmatrix} 1 & 0 \\\\ k & 1 \\end{pmatrix}$。将此变换应用于二次型 $[a,b,c]$，得到 $[f(1,k), b', f(0,1)] = [ak^2+bk+c, b+2ak, a]$。等等，这不是标准的效果。让我们使用指定的约定重新计算。对于 $M=U_k$，我们有 $(u,v) = (x+ky, y)$。变换后的二次型是 $f'(x,y) = f(x+ky, y)=a(x+ky)^2+b(x+ky)y+cy^2 = ax^2+(2ak+b)xy+(ak^2+bk+c)y^2$。所以新的二次型是 $[a, 2ak+b, ak^2+bk+c]$。当 $|b| > a$ 时使用此操作。\n\n现在让我们对给定的二次型 $[a,b,c] = [103, 78, 59]$ 执行简约过程。\n\n**路径 1：标准简约算法**\n\n1.  **初始二次型：** $[a_0, b_0, c_0] = [103, 78, 59]$。\n    我们检查简约条件：$|b| \\leq a \\leq c$。\n    - $|78| \\leq 103$：成立。\n    - $103 \\leq 59$：不成立。\n    由于 $a_0 > c_0$，我们必须应用对应于 $S = \\begin{pmatrix} 0 & -1 \\\\ 1 & 0 \\end{pmatrix}$ 的变换。如上所推导，这将 $[a,b,c]$ 变换为 $[c, -b, a]$。\n    新的二次型为 $[a_1, b_1, c_1] = [59, -78, 103]$。\n\n2.  **第二个二次型：** $[a_1, b_1, c_1] = [59, -78, 103]$。\n    我们检查简约条件：\n    - $|-78| \\leq 59$：不成立，因为 $78 > 59$。\n    由于 $|b_1| > a_1$，我们必须应用一个剪切变换来减小中间系数的绝对值。我们使用对应于矩阵 $M = U_k = \\begin{pmatrix} 1 & 0 \\\\ k & 1 \\end{pmatrix}$ 的变换，它将 $[a,b,c]$ 映射到 $[a, b+2ak, c']$。我们的目标是选择一个整数 $k$，使得新的中间系数 $b_2 = b_1 + 2a_1k$ 满足 $|b_2| \\leq a_1$。\n    我们必须为整数 $k$ 解以下不等式：\n    $$|-78 + 2(59)k| \\leq 59$$\n    $$-59 \\leq -78 + 118k \\leq 59$$\n    各边同时加上 $78$ 得：\n    $$19 \\leq 118k \\leq 137$$\n    各边同时除以 $118$ 得：\n    $$\\frac{19}{118} \\leq k \\leq \\frac{137}{118}$$\n    数值上，这大约是 $0.161 \\leq k \\leq 1.161$。此区间内唯一的整数是 $k=1$。\n    我们将 $k=1$ 的变换应用于二次型 $[59, -78, 103]$。\n    - $a_2 = a_1 = 59$。\n    - $b_2 = b_1 + 2a_1k = -78 + 2(59)(1) = -78 + 118 = 40$。\n    - $c_2 = a_1k^2 + b_1k + c_1 = 59(1)^2 + (-78)(1) + 103 = 59 - 78 + 103 = 84$。\n    新的二次型是 $[a_2, b_2, c_2] = [59, 40, 84]$。\n\n3.  **第三个二次型：** $[a_2, b_2, c_2] = [59, 40, 84]$。\n    我们检查简约条件：\n    - $|40| \\leq 59$：成立。\n    - $59 \\leq 84$：成立。\n    $|b| \\leq a \\leq c$ 这两个条件都满足了。我们还检查边界情况：$|b| = a$ ($40 \\neq 59$) 和 $a=c$ ($59 \\neq 84$) 均不满足，因此没有关于 $b$ 的额外条件适用。\n    二次型 $[59, 40, 84]$ 是简约代表元。\n\n**路径 2：备选的替换序列**\n\n为了验证唯一性，我们再次从 $[a_0, b_0, c_0] = [103, 78, 59]$ 开始，但选择一个不同的初始变换。我们不采用因 $a_0 > c_0$ 而应用 $S$ 的标准步骤，而是应用一个不同的初等变换 $T_k = \\begin{pmatrix} 1 & k \\\\ 0 & 1 \\end{pmatrix}$。根据问题的约定，此矩阵的作用是 $(u,v) = (x,y)T_k = (x, kx+y)$。变换后的二次型是 $f'(x,y) = f(x, kx+y) = a x^2 + b x(kx+y) + c(kx+y)^2 = (a+bk+ck^2)x^2 + (b+2ck)xy + cy^2$。新的二次型是 $[a+bk+ck^2, b+2ck, c]$。\n\n1.  **初始二次型：** $[a_0, b_0, c_0] = [103, 78, 59]$。\n    我们应用变换 $T_k$ 并选择整数 $k$ 来最小化新的首项系数 $a_1 = a_0+b_0k+c_0k^2 = 103+78k+59k^2$。这是一个开口向上的关于 $k$ 的二次函数，所以其最小值在顶点附近，即 $k = -b_0/(2c_0) = -78/(2 \\times 59) = -39/59 \\approx -0.66$。使 $a_1$ 最小化的整数是与此值最接近的整数，即 $k=-1$。\n    当 $k=-1$ 时，变换矩阵为 $T_{-1} = \\begin{pmatrix} 1 & -1 \\\\ 0 & 1 \\end{pmatrix}$。将其应用于 $[103, 78, 59]$：\n    - $a_1 = 103 + 78(-1) + 59(-1)^2 = 103 - 78 + 59 = 84$。\n    - $b_1 = 78 + 2(59)(-1) = 78 - 118 = -40$。\n    - $c_1 = 59$。\n    新的二次型是 $[a_1, b_1, c_1] = [84, -40, 59]$。\n\n2.  **第二个二次型：** $[a_1, b_1, c_1] = [84, -40, 59]$。\n    我们检查简约条件：\n    - $|-40| \\leq 84$：成立。\n    - $84 \\leq 59$：不成立。\n    由于 $a_1 > c_1$，我们现在必须应用变换 $S = \\begin{pmatrix} 0 & -1 \\\\ 1 & 0 \\end{pmatrix}$。这将 $[a,b,c]$ 映射到 $[c,-b,a]$。\n    新的二次型是 $[a_2, b_2, c_2] = [59, -(-40), 84] = [59, 40, 84]$。\n\n3.  **第三个二次型：** $[a_2, b_2, c_2] = [59, 40, 84]$。\n    这与路径1结尾得到的二次型相同。如前所述，它是简约的。\n\n两条路径，尽管从不同的有效幺模替换开始，最终都收敛到同一个唯一的简约二次型 $[59, 40, 84]$。\n\n**关于类数的结论**\n\n对于给定的判别式 $D$，类数 $h(D)$ 是本原正定二元二次型的不等价类的数量。简约算法是一个构造性证明，表明每个这样的二次型都等价于至少一个简约二次型。我们的练习所阐明的一个更深刻的结果是，这个简约代表元是*唯一*的。\n\n我们通过两个不同的有效变换序列应用于同一个初始二次型，最终得到相同的简约二次型，这个演示为这一唯一性性质提供了经验性证据。因为一个等价类中的每一个二次型都会被简约化为同一个唯一的代表元，所以在该判别式下的等价类集合与简约二次型集合之间存在一一对应关系。\n\n此外，一个二次型 $[a,b,c]$ 成为简约二次型的条件（$|b| \\leq a \\leq c$ 且 $b^2-4ac = D < 0$）意味着对于任何给定的 $D$，只有有限多个这样的二次型。具体来说，$3a^2 \\leq 4a^2 - b^2 \\leq 4ac - b^2 = -D$，因此 $a \\leq \\sqrt{|D|/3}$。这就界定了 $a$ 的范围，从而也界定了 $b$ 的范围，并且对于每一对 $(a,b)$， $c$ 也就确定了。由于 $a$ 和 $b$ 的选择是有限的，因此简约二次型的数量也是有限的。\n\n简约代表元的唯一性保证了我们可以通过简单地枚举这个有限的简约二次型集合来找到类数。这确保了类数是一个良定义的有限整数，这是代数数论中的一个基本概念。", "answer": "$$ \\boxed{ \\begin{pmatrix} 59 & 40 & 84 \\end{pmatrix} } $$", "id": "3010008"}, {"introduction": "类群不仅是一个集合，更是一个有限阿贝尔群，其群运算被称为“复合”。这个抽象的群结构可以通过具体的计算来把握。在此练习 [@problem_id:3009985] 中，您将应用狄利克雷复合律，对两个具有相同判别式的互素二次型进行复合，从而得到一个新的二次型。这个过程让您真切地体验类群中的“加法”是如何运作的。", "problem": "设 $D$ 为一个本原、正定、整二元二次型的判别式。考虑判别式 $D=-23$，以及具有此判别式的两个二次型 $[a,b,c]=[2,1,3]$ 和 $[a',b',c']=[3,1,2]$。仅使用判别式、同余类以及二元二次型类的复合律的基本性质，完成以下步骤：\n\n- 论证互素条件 $\\gcd(a,a')=\\gcd(2,3)=1$ 使得复合型的首项系数可以选择为 $A=a\\,a'$。\n\n- 确定唯一的整数 $B$，使得 $B\\equiv b \\pmod{2a}$，$B\\equiv b' \\pmod{2a'}$，$B^{2}\\equiv D \\pmod{4A}$ 且 $-A<B\\leq A$。\n\n- 定义 $C=\\dfrac{B^{2}-D}{4A}$，并验证 $C$ 是一个整数，从而 $[A,B,C]$ 是一个判别式为 $D$ 的有效整二次型。\n\n作为最终答案，给出 $B$ 的值。不要四舍五入，要求提供一个精确的整数。", "solution": "题目陈述是经典二元二次型理论中的一个有效练习。它要求将 Dirichlet 复合律应用于两个特定的二次型。所有提供的数据在数学上都是合理的，并且内部一致。二次型 $[2,1,3]$ 和 $[3,1,2]$ 都是本原、正定、整二元二次型，它们的判别式均为 $b^2 - 4ac = 1^2 - 4(2)(3) = 1^2 - 4(3)(2) = 1 - 24 = -23$。整个问题都包含在已建立的数论框架内。我们可以开始求解。\n\n问题要求完成与两个本原、正定、整二元二次型 $f(x,y) = ax^2 + bxy + cy^2$ 和 $f'(x',y') = a'x'^2 + b'x'y' + c'y'^2$ 的复合相关的三项任务。\n具体的二次型为 $[a,b,c]=[2,1,3]$ 和 $[a',b',c']=[3,1,2]$。两者的判别式均为 $D = -23$。\n\n复合型记为 $[A,B,C]$。\n\n- **首项系数 $A=a\\,a'$ 的论证**\n\n对于具有相同判别式 $D$ 的两个二元二次型 $[a,b,c]$ 和 $[a',b',c']$，其复合律提供了一种构造复合型 $[A,B,C]$ 的方法。在首项系数互素（即 $\\gcd(a,a')=1$）这一特殊但重要的情形下，Dirichlet 方法将复合型的首项系数定义为 $A=a\\,a'$。在本题中，给定 $a=2$ 和 $a'=3$，确实有 $\\gcd(2,3)=1$。选择 $A$ 的理由在于，这是一个构造性算法的第一步，该算法保证能生成一个有效的复合型。后续步骤将证明，可以找到整数 $B$ 和 $C$，使得 $[A,B,C] = [a\\,a', B, C]$ 是一个判别式为 $D$ 的整二次型。互素条件 $\\gcd(a,a')=1$ 至关重要，因为它通过中国剩余定理保证了满足所需同余方程的整数 $B$（在模 $2aa'$ 意义下）的存在性和唯一性，我们现在就来确定这个 $B$。\n\n- **整数 $B$ 的确定**\n\n整数 $B$ 由一个同余方程组和一个不等式唯一确定。给定的参数为 $a=2$，$b=1$，$a'=3$，$b'=1$，$D=-23$。\n复合型的首项系数是 $A=a\\,a' = (2)(3) = 6$。\n\n$B$ 需满足的条件如下：\n1.  $B \\equiv b \\pmod{2a}$。代入数值，我们得到 $B \\equiv 1 \\pmod{2(2)}$，即 $B \\equiv 1 \\pmod{4}$。\n2.  $B \\equiv b' \\pmod{2a'}$。代入数值，我们得到 $B \\equiv 1 \\pmod{2(3)}$，即 $B \\equiv 1 \\pmod{6}$。\n3.  $B^2 \\equiv D \\pmod{4A}$。代入数值，我们得到 $B^2 \\equiv -23 \\pmod{4(6)}$，即 $B^2 \\equiv -23 \\pmod{24}$。\n4.  $-A < B \\leq A$。代入 $A$ 的值，我们得到 $-6 < B \\leq 6$。\n\n我们首先求解关于 $B$ 的线性同余方程组：\n由 $B \\equiv 1 \\pmod{4}$，我们可以写出 $B = 4k+1$，其中 $k$ 为某个整数。\n将此代入第二个同余式：\n$4k+1 \\equiv 1 \\pmod{6}$\n$4k \\equiv 0 \\pmod{6}$\n这意味着 $4k$ 是 $6$ 的倍数。设 $4k = 6j$，其中 $j$ 为某个整数。两边除以 $2$ 得到 $2k = 3j$。由于 $\\gcd(2,3)=1$，$k$ 必须是 $3$ 的倍数。所以，我们可以写出 $k=3m$，其中 $m$ 为某个整数。\n将此代回 $B$ 的表达式中：\n$B = 4(3m)+1 = 12m+1$\n这意味着 $B$ 必须满足同余式 $B \\equiv 1 \\pmod{12}$。这一个条件就概括了前两个同余式。\n\n现在，我们用第三个条件 $B^2 \\equiv -23 \\pmod{24}$ 来检验这个结果。\n因为 $-23 = -1 \\times 24 + 1$，我们有 $-23 \\equiv 1 \\pmod{24}$。所以该条件变为 $B^2 \\equiv 1 \\pmod{24}$。\n如果 $B = 12m+1$，那么\n$B^2 = (12m+1)^2 = 144m^2 + 24m + 1 = 24(6m^2+m) + 1$。\n因此，$B^2 \\equiv 1 \\pmod{24}$。该条件对任意整数 $m$ 都成立。\n\n最后，我们使用不等式 $-6 < B \\leq 6$ 来找到 $B$ 的唯一值。我们需要寻找一个形式为 $12m+1$ 且位于此区间内的整数 $B$。\n如果 $m=0$，那么 $B=1$。这个值满足 $-6 < 1 \\leq 6$。\n如果 $m=1$，那么 $B=13$，超出了该区间。\n如果 $m=-1$，那么 $B=-11$，也超出了该区间。\n因此，满足所有条件的唯一整数 $B$ 是 $B=1$。\n\n- **验证 $C$ 是整数**\n\n复合型的系数 $C$ 定义为 $C = \\frac{B^2 - D}{4A}$。\n使用 $B=1$、$D=-23$ 和 $A=6$ 这些值，我们计算 $C$：\n$$ C = \\frac{1^2 - (-23)}{4(6)} = \\frac{1+23}{24} = \\frac{24}{24} = 1 $$\n由于 $C=1$，$C$ 是一个整数。\n这就证实了 $[A,B,C]=[6,1,1]$ 是一个有效的整二元二次型。我们来检验它的判别式：$B^2 - 4AC = 1^2 - 4(6)(1) = 1-24 = -23$，这正是正确的判别式 $D$。\n\n问题要求的是 $B$ 的值。如上所确定的，$B=1$。", "answer": "$$\\boxed{1}$$", "id": "3009985"}, {"introduction": "在任何群论研究中，特殊元素的子集往往揭示了群的深刻结构。在类群中，“含糊类”（ambiguous classes）就是这样一类特殊元素，它们是自身的逆，构成了类群的2-挠子群。这个练习 [@problem_id:3009979] 首先要求您为一个给定的判别式 $D = -20$ 找出所有的既约二次型，从而确定其类群。然后，您需要识别出哪些类是含糊类，并计算它们的数量，这直接关系到类群的结构分析。", "problem": "设 $D<0$ 是一个基本判别式，令 $\\mathrm{Cl}(D)$ 表示判别式为 $D=b^{2}-4ac$ 的本原正定二元二次型 $f(x,y)=ax^{2}+bxy+cy^{2}$ 在 Gauss 复合下的真类群。类 $[a,b,c]\\in \\mathrm{Cl}(D)$ 的逆元是 $[a,-b,c]$。如果一个类 $[a,b,c]$ 与其逆元（作为真类）相等，则称该类为歧类。从真等价、由 Gauss 复合给出的 $\\mathrm{Cl}(D)$ 上的群结构以及逆元运算的核心定义出发，证明所有歧类构成的集合是 $\\mathrm{Cl}(D)$ 的一个子群。然后，对于特定判别式 $D=-20$，计算该歧类子群的确切大小。最终答案必须是一个整数。无需四舍五入。", "solution": "该问题要求我们首先证明二元二次型歧类的两个一般性质，然后计算特定判别式 $D=-20$ 下这类类的数量。\n\n设 $\\mathrm{Cl}(D)$ 为基本判别式 $D<0$ 的本原正定二元二次型的真类群。群运算是 Gauss 复合，这使得 $\\mathrm{Cl}(D)$ 成为一个有限阿贝尔群。该群的单位元记为 $[I]$，是包含主型的类。当 $D \\equiv 0 \\pmod{4}$ 时，主型为 $[1, 0, -D/4]$。当 $D \\equiv 1 \\pmod{4}$ 时，主型为 $[1, 1, (1-D)/4]$。\n\n歧类是 $\\mathrm{Cl}(D)$ 中一个与其自身逆元相等的类 $[f]$。由二次型 $(a,b,c)$ 代表的类的逆元是由 $(a,-b,c)$ 代表的类。因此，一个类 $[a,b,c]$ 是歧类当且仅当 $[a,b,c] = [a,-b,c]$。\n\n令 $S$ 为 $\\mathrm{Cl}(D)$ 中所有歧类的集合。\n\n**第一部分：歧类集合作为子群**\n\n我们要证明 $S$ 是 $\\mathrm{Cl}(D)$ 的一个子群。我们使用子群判定定理。歧类 $[f]$ 的定义是 $[f] = [f]^{-1}$。右乘 $[f]$，我们得到一个等价条件：$[f]^2 = [I]$，其中 $[I]$ 是单位类。因此，歧类的集合恰好是 $\\mathrm{Cl}(D)$ 中所有阶为1或2的元素的集合。这也被称为 $\\mathrm{Cl}(D)$ 的2-扭子群，通常记为 $\\mathrm{Cl}(D)[2]$。\n\n1.  **非空性**：单位类 $[I]$ 满足 $[I]^2 = [I]$，所以 $[I] \\in S$。因此，$S$ 非空。\n\n2.  **对群运算的封闭性**：设 $[f_1]$ 和 $[f_2]$ 是 $S$ 中的两个元素。根据定义，有 $[f_1]^2 = [I]$ 和 $[f_2]^2 = [I]$。我们必须证明它们的积 $[f_1][f_2]$ 也在 $S$ 中。我们验证是否 $([f_1][f_2])^2 = [I]$。\n    $$ ([f_1][f_2])^2 = ([f_1][f_2])([f_1][f_2]) $$\n    由于 $\\mathrm{Cl}(D)$ 在 Gauss 复合下是一个阿贝尔群，我们可以交换元素：\n    $$ ([f_1][f_2])^2 = [f_1]^2 [f_2]^2 = [I][I] = [I] $$\n    因此，$[f_1][f_2] \\in S$，所以 $S$ 对群运算是封闭的。\n\n3.  **对逆元的封闭性**：设 $[f] \\in S$。我们必须证明它的逆元 $[f]^{-1}$ 也在 $S$ 中。一个元素属于 $S$ 的条件是它的平方是单位元。我们检验 $([f]^{-1})^2$：\n    $$ ([f]^{-1})^2 = ([f]^2)^{-1} = [I]^{-1} = [I] $$\n    因此，$[f]^{-1} \\in S$。（或者，因为 $[f] \\in S$ 意味着 $[f] = [f]^{-1}$，所以 $[f]$ 的逆元就是它自身，根据假设它在 $S$ 中）。\n\n因为 $S$ 是 $\\mathrm{Cl}(D)$ 的一个非空子集，且对群运算和求逆运算封闭，所以 $S$ 是 $\\mathrm{Cl}(D)$ 的一个子群。\n\n**第二部分：歧类子群的指数**\n\n一个群 $G$ 的指数是使得对所有 $g \\in G$ 都有 $g^n=e$ 成立的最小正整数 $n$，其中 $e$ 是单位元。\n对于歧类子群 $S$，根据定义，每个元素 $[f] \\in S$ 都满足 $[f]^2 = [I]$。\n单位元 $[I]$ 的阶是 $1$，并且 $1^2=[I]$。$S$ 中任何非单位元的阶都是 $2$。\n群的指数是子群中所有元素阶的最小公倍数。如果 $S$ 只包含单位元，则指数是 $1$。如果 $S$ 包含任何阶为 $2$ 的元素，则指数必须是 $2$ 的倍数。由于对所有 $g \\in S$ 都有 $g^2=e$，指数至多为 $2$。因此，如果 $S$ 不是平凡群，其指数恰好为 $2$。\n\n**第三部分：对于 $D=-20$ 的歧类子群的大小**\n\n判别式为 $D=-20$。这是一个基本判别式，因为 $D/4 = -5$ 是无平方因子的，并且 $-5 \\equiv 3 \\pmod 4$。\n要找到歧类子群的大小，我们首先通过找出所有元素来确定整个类群 $\\mathrm{Cl}(-20)$ 的结构。类群的元素与既约的本原正定二元二次型 $(a,b,c)$ 一一对应。\n\n一个判别式 $D<0$ 的二次型 $(a,b,c)$ 是既约的，如果它满足 $|b| \\leq a \\leq c$，并且如果 $|b|=a$ 或 $a=c$，则 $b \\geq 0$。我们需要找到所有满足这些条件以及 $b^2 - 4ac = -20$ 的整数三元组 $(a,b,c)$，且 $\\gcd(a,b,c)=1$。\n\n从 $b^2 - 4ac = -20$，我们有 $4ac = b^2+20$。因为二次型是正定的，所以 $a>0$。条件 $|b| \\leq a$ 意味着 $b^2 \\leq a^2$。条件 $a \\leq c$ 意味着 $4a^2 \\leq 4ac$。\n结合这些，我们得到 $4a^2 \\leq 4ac = b^2+20 \\leq a^2+20$。\n这导出了不等式 $3a^2 \\leq 20$，即 $a^2 \\leq 20/3 \\approx 6.67$。\n$a$ 可能的整数值为 $1$ 和 $2$。\n\n情况1：$a=1$。\n由 $|b| \\leq a=1$，得 $b \\in \\{-1, 0, 1\\}$。\n- 如果 $b=0$：$4(1)c = 0^2+20 \\implies 4c=20 \\implies c=5$。这给出了二次型 $(1,0,5)$。\n  我们检查它是否是既约的：$|0| \\leq 1 \\leq 5$。是。\n  我们检查它是否是本原的：$\\gcd(1,0,5)=1$。是。\n  这个二次型是 $D=-20$ 的主型，代表单位类 $[I]$。\n\n- 如果 $b = \\pm 1$：$4(1)c = (\\pm 1)^2+20 \\implies 4c=21$。这没有整数解 $c$。\n\n情况2：$a=2$。\n由 $|b| \\leq a=2$，得 $b \\in \\{-2, -1, 0, 1, 2\\}$。\n- 如果 $b=0$：$4(2)c = 0^2+20 \\implies 8c=20$。没有整数解 $c$。\n- 如果 $b=\\pm 1$：$4(2)c = (\\pm 1)^2+20 \\implies 8c=21$。没有整数解 $c$。\n- 如果 $b=\\pm 2$：$4(2)c = (\\pm 2)^2+20 \\implies 8c=24 \\implies c=3$。这给出了二次型 $(2,2,3)$ 和 $(2,-2,3)$。\n  对于 $(2,2,3)$：我们检查其是否既约。$|2| \\leq 2 \\leq 3$ 成立。由于 $|b|=a$，我们必须有 $b \\geq 0$。因为 $b=2$，此条件满足。所以 $(2,2,3)$ 是一个既约二次型。\n  本原性：$\\gcd(2,2,3)=1$。是。\n  对于 $(2,-2,3)$：我们检查其是否既约。$|-2| \\leq 2 \\leq 3$ 成立。然而，$|b|=a$ 成立，但条件 $b \\geq 0$ 不满足，因为 $b=-2$。因此，$(2,-2,3)$ 不是既约二次型。实际上，它与 $(2,2,3)$ 是真等价的，这可以通过变换矩阵 $\\begin{pmatrix} 1 & 1 \\\\ 0 & 1 \\end{pmatrix}$ 来证明。\n\n$D=-20$ 的既约二次型集合是 $\\{(1,0,5), (2,2,3)\\}$。\n这意味着类数是 $h(-20)=2$。类群是 $\\mathrm{Cl}(-20) = \\{[1,0,5], [2,2,3]\\}$。任何2阶群都同构于循环群 $C_2$。\n\n现在我们必须确定这些类中哪些是歧类。歧类是满足 $[f]^2=[I]$ 的元素 $[f]$。\n1. 单位类 $[1,0,5]$ 总是歧类，因为 $[I]^2=[I]$。它的逆元是 $[1,-0,5]=[1,0,5]$。\n2. 另一个类是 $[2,2,3]$。由于群的阶为2，这个元素的阶必定为2。因此，$[2,2,3]^2 = [1,0,5] = [I]$。这意味着 $[2,2,3]$ 也是一个歧类。我们也可以通过检查它的逆元来验证这一点：$[2,2,3]$ 的逆元是 $[2,-2,3]$。如前所述，二次型 $(2,-2,3)$ 与 $(2,2,3)$ 是真等价的，所以 $[2,-2,3]=[2,2,3]$，这正是歧类的定义。\n\n$\\mathrm{Cl}(-20)$ 中的两个类都是歧类。歧类子群就是整个群 $\\mathrm{Cl}(-20)$。\n因此，这个子群的大小就是群的阶，即 $2$。", "answer": "$$\\boxed{2}$$", "id": "3009979"}]}