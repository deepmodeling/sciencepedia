{"hands_on_practices": [{"introduction": "理论学习之后，最好的巩固方式莫过于亲手实践。我们从最简单的情形开始：一个只有一个元素的类群。本练习将引导你处理判别式为 $D=-4$ 的二次型，通过找出唯一的既约形式并验证其与自身的复合运算结果，具体地展示类群中单位元的概念。[@problem_id:3015035]", "problem": "设 $Q(x,y) = a x^{2} + b x y + c y^{2}$ 是一个整系数二元二次型，其判别式为 $D = b^{2} - 4 a c$。并假设 $Q$ 是本原的，即 $\\gcd(a,b,c) = 1$，且是正定的，即 $D < 0$ 且 $a > 0$。如果存在一个矩阵 $\\gamma \\in \\mathrm{SL}_{2}(\\mathbb{Z})$ 使得 $Q' = Q \\circ \\gamma$，其中 $Q \\circ \\gamma$ 表示由 $\\gamma$ 引起的变量替换，则称两个二次型 $Q$ 和 $Q'$ 是真等价的。对于固定的判别式 $D$，本原正定二次型的所有真等价类在高斯复合下构成一个有限阿贝尔群。一个既约二次型是其等价类中的一个代表元 $Q$，满足既约不等式 $|b| \\leq a \\leq c$，以及附加条件：如果 $|b| = a$ 或 $a = c$，则 $b \\geq 0$。\n\n对于判别式 $D = -4$，仅根据上述定义和事实，完成以下任务：\n\n1. 确定判别式为 $D = -4$ 的所有既约本原正定二元二次型的完整列表，并由此推导出类数 $h(-4)$。\n\n2. 使用高斯复合（根据二元二次型复合律的基本定义构建），计算判别式为 $-4$ 的主既约形式与自身的显式复合，得到结果复合型的系数三元组 $(a'', b'', c'')$，其判别式也为 $-4$。通过求解必要的同余方程和整数性约束来执行复合运算，以确保所得系数定义了一个判别式为 $-4$ 的本原二次型。\n\n将你的最终答案表示为一个单行矩阵，其中首先包含类数 $h(-4)$，然后按顺序是复合型系数 $(a'', b'', c'')$。无需四舍五入。", "solution": "该问题分为两部分。首先，我们必须确定判别式为 $D = -4$ 的所有既约本原正定二元二次型的完整列表，并由此求出类数 $h(-4)$。其次，我们必须计算主既约形式与自身的高斯复合。\n\n第1部分：确定既约形式和类数 $h(-4)$\n\n一个二元二次型 $Q(x,y) = ax^2 + bxy + cy^2$ 由其整数系数 $(a, b, c)$ 确定。判别式为 $D = b^2 - 4ac$。我们已知 $D = -4$。该二次型必须是本原的，即 $\\gcd(a, b, c) = 1$，且是正定的，即 $D < 0$ 且 $a > 0$。\n\n如果一个二次型满足不等式 $|b| \\leq a \\leq c$，并附带附加条件：如果 $|b| = a$ 或 $a = c$，则 $b \\geq 0$，那么该二次型是既约的。\n\n让我们找出满足 $D=-4$ 的所有整数三元组 $(a, b, c)$。\n判别式方程为 $b^2 - 4ac = -4$，可以改写为 $4ac = b^2 + 4$。\n由于 $a$ 和 $c$ 是整数，$b^2+4$ 必须能被 $4$ 整除。这意味着 $b^2$ 必须能被 $4$ 整除，进而意味着 $b$ 必须是一个偶数。设 $b = 2k$，其中 $k$ 为某个整数。\n\n我们使用既约条件来约束 $a$、$b$ 和 $c$ 的可能取值。\n根据正定条件，我们有 $a > 0$。\n既约条件是 $|b| \\leq a$ 和 $a \\leq c$。\n由于 $a \\leq c$，我们有 $4a^2 \\leq 4ac$。代入 $4ac = b^2 + 4$，得到 $4a^2 \\leq b^2 + 4$。\n从 $|b| \\leq a$，我们有 $b^2 \\leq a^2$。\n结合这些不等式，我们得到：\n$4a^2 \\leq b^2 + 4 \\leq a^2 + 4$\n这导出了 $3a^2 \\leq 4$。\n\n由于 $a$ 必须是正整数，所以 $a^2$ 也必须是正整数。不等式 $a^2 \\leq \\frac{4}{3}$ 对于 $a^2$ 只有一个正整数解，即 $a^2 = 1$。这意味着 $a = 1$。\n\n既然我们已经确定 $a=1$，我们使用条件 $|b| \\leq a$ 来求 $b$。\n$|b| \\leq 1$。\n如前所述，$b$ 必须是偶数。满足 $|b| \\leq 1$ 的唯一偶数是 $b = 0$。\n\n最后，我们使用判别式方程求出 $c$ 的值：\n$b^2 - 4ac = -4$\n$0^2 - 4(1)c = -4$\n$-4c = -4$\n$c = 1$。\n\n这给了我们一个唯一的既约形式候选者：系数三元组 $(a,b,c) = (1, 0, 1)$。我们必须验证这个二次型满足所有必需的条件。\n1. 形式：$Q(x,y) = 1x^2 + 0xy + 1y^2 = x^2 + y^2$。\n2. 判别式：$D = 0^2 - 4(1)(1) = -4$。正确。\n3. 正定性：$D < 0$ 且 $a = 1 > 0$。正确。\n4. 本原性：$\\gcd(a, b, c) = \\gcd(1, 0, 1) = 1$。正确。\n5. 既约性：\n   - $|b| \\leq a \\implies |0| \\leq 1$，成立。\n   - $a \\leq c \\implies 1 \\leq 1$，成立。\n   - 附加条件：由于 $a=c=1$，我们必须有 $b \\geq 0$。我们的值 $b=0$ 满足此条件。\n因此，二次型 $(1, 0, 1)$ 确实是一个判别式为 $D=-4$ 的既约本原正定二次型。由于这是我们找到的唯一一个这样的二次型，所以这类二次型的完整列表只包含这一个二次型。\n\n类数，记为 $h(D)$，是判别式为 $D$ 的本原正定二次型的不同真等价类的数量。这等于既约形式的数量。\n由于只有一个既约形式，类数为 $h(-4) = 1$。\n\n第2部分：高斯复合\n\n我们被要求计算判别式为 $D=-4$ 的主既约形式与自身的复合。主型是代表类群中单位元的二次型。对于正定二次型，这是 $a=1$ 的二次型。在我们的例子中，唯一的既约形式是 $(1, 0, 1)$，所以它必然是主型。\n\n设 $Q_1(x_1, y_1) = x_1^2 + y_1^2$ 和 $Q_2(x_2, y_2) = x_2^2 + y_2^2$。系数分别为 $(a_1, b_1, c_1) = (1, 0, 1)$ 和 $(a_2, b_2, c_2) = (1, 0, 1)$。我们想要求出复合型 $Q'' = Q_1 \\circ Q_2$ 的系数 $(a'', b'', c'')$。\n\n高斯复合理论提供了一种构造复合型的方法。首先，我们计算 $g = \\gcd(a_1, a_2, \\frac{b_1+b_2}{2})$。\n代入我们的值，$g = \\gcd(1, 1, \\frac{0+0}{2}) = \\gcd(1, 1, 0) = 1$。\n\n复合型的第一个系数 $a''$ 由 $a'' = \\frac{a_1 a_2}{g^2}$ 给出。\n$a'' = \\frac{1 \\cdot 1}{1^2} = 1$。\n\n第二个系数 $b''$ 是一个整数 $B$，它是以下同余方程组的联立解：\n1. $B \\equiv b_1 \\pmod{2a_1/g}$\n2. $B \\equiv b_2 \\pmod{2a_2/g}$\n3. $B^2 \\equiv D \\pmod{4a_1 a_2 / g^2}$\n\n代入给定值 ($a_1=1, b_1=0, a_2=1, b_2=0, D=-4, g=1$)：\n1. $B \\equiv 0 \\pmod{2(1)/1} \\implies B \\equiv 0 \\pmod 2$。\n2. $B \\equiv 0 \\pmod{2(1)/1} \\implies B \\equiv 0 \\pmod 2$。\n3. $B^2 \\equiv -4 \\pmod{4(1)(1)/1^2} \\implies B^2 \\equiv 0 \\pmod 4$。\n\n从第一个同余方程可知，$B$ 必须是偶数。设 $B = 2k$，其中 $k \\in \\mathbb{Z}$ 是某个整数。\n将此代入第三个同余方程：$(2k)^2 = 4k^2$。这个数总能被 $4$ 整除，所以对于任何整数 $k$，$4k^2 \\equiv 0 \\pmod 4$ 都成立。\n因此，任何偶数 $B$ 都是该同余方程组的有效解。$B$ 的具体选择会影响到所得等价类中产生的是哪一个二次型。我们可以选择最简单的解，$B = 0$。\n所以，我们取 $b'' = 0$。\n\n第三个系数 $c''$ 由复合型也必须有判别式 $D = -4$ 的要求确定：\n$b''^2 - 4a''c'' = D$\n$0^2 - 4(1)c'' = -4$\n$-4c'' = -4$\n$c'' = 1$。\n\n得到的复合型的系数为 $(a'', b'', c'') = (1, 0, 1)$。\n我们必须检查这个二次型是本原的：$\\gcd(a'', b'', c'') = \\gcd(1, 0, 1) = 1$。确实是。\n\n因此，主型 $(1, 0, 1)$ 与自身的复合产生了二次型 $(1, 0, 1)$。这个结果是预料之中的，因为类群 $Cl(-4)$ 的阶为 $h(-4)=1$。唯一的元素是单位类，它必须是自身的逆元，将它与自身复合必须再次得到单位元。\n\n最终答案要求类数 $h(-4)$ 和复合型的系数 $(a'', b'', c'')$。\n$h(-4) = 1$\n$(a'', b'', c'') = (1, 0, 1)$", "answer": "$$\\boxed{\\begin{pmatrix} 1 & 1 & 0 & 1 \\end{pmatrix}}$$", "id": "3015035"}, {"introduction": "理解了单位元之后，下一步是探索一个非平凡的类群。本练习选用判别式 $D=-23$，其类数大于 1。你的任务是首先通过枚举所有既约形式来确定类群的大小，然后对一个非主形式进行自复合，以揭示该群的循环结构。这个练习让你能亲手体验分析一个完整类群的全部流程。[@problem_id:3015037]", "problem": "设 $\\Delta=-23$ 是一个基本判别式。考虑判别式为 $\\Delta$ 的本原正定二元二次型 $f(x,y)=a x^{2}+b x y+c y^{2}$，即满足 $b^{2}-4 a c=\\Delta$ 和 $\\gcd(a,b,c)=1$，以及在整数上的特殊线性群（$\\mathrm{SL}_{2}(\\mathbb{Z})$）下的真等价，即通过替换 $(x,y)\\mapsto (p x+q y, r x+s y)$（其中 $p,q,r,s\\in\\mathbb{Z}$ 且 $p s-q r=1$）进行变换。一个二次型被称为既约的，如果它满足正定二次型的标准既约不等式：$|b|\\leq a\\leq c$，并附带一个打破僵局的约定：如果 $|b|=a$ 或 $a=c$，则 $b\\geq 0$。\n\n从这些定义和二元二次型高斯复合的理论出发，完成以下任务：\n\n1. 仅使用既约不等式和关系式 $b^{2}-4 a c=\\Delta$，导出任何判别式为 $\\Delta=-23$ 的既约本原正定二次型的首项系数 $a$ 的严格界限。\n\n2. 枚举所有满足 $b^{2}-4 a c=-23$、$\\gcd(a,b,c)=1$ 和既约条件的整数三元组 $(a,b,c)$，并论证所得列表构成了一个真等价类的既约代表元的完备集。\n\n3. 解释为什么这些既约形式中的每一个都代表 $\\mathrm{SL}_{2}(\\mathbb{Z})$ 下一个不同的真等价类。\n\n4. 至少演示一次高斯复合，将一个非主既约类与自身复合，使用狄利克雷复合框架得到一个复合形式，然后通过行列式为1的幺模变换将其既约化，从而确认类群的封闭性并确定其中逆元。\n\n将类数 $h(\\Delta)$ 作为你的最终答案，它定义为判别式为 $\\Delta$ 的本原正定二元二次型的真等价类的数量。你的最终答案应表示为一个整数。", "solution": "该问题要求分析判别式为 $\\Delta = -23$ 的本原正定二元二次型。这包括找出该判别式的所有既约形式，证明它们构成了真等价类的一个完备代表集，并通过高斯复合阐释这些类上的群结构。最终目标是确定类数 $h(-23)$。\n\n二元二次型是具有整数系数 $a, b, c$ 的表达式 $f(x,y) = ax^2 + bxy + cy^2$。其判别式为 $\\Delta = b^2 - 4ac$。如果 $\\Delta < 0$ 且 $a > 0$，则该二次型是正定的。如果 $\\gcd(a,b,c)=1$，则它是本原的。如果存在一个矩阵 $\\begin{pmatrix} p & q \\\\ r & s \\end{pmatrix} \\in \\mathrm{SL}_2(\\mathbb{Z})$（即 $p,q,r,s \\in \\mathbb{Z}$ 且 $ps-qr=1$），通过代换 $(x,y) \\mapsto (px+qy, rx+sy)$ 将二次型 $f$ 变换为 $g$，则称两个二次型 $f$ 和 $g$ 是真等价的，记为 $f \\sim g$。一个正定二次型被称为既约的，如果其系数满足不等式 $|b| \\leq a \\leq c$，并附带额外条件：如果 $|b|=a$ 或 $a=c$，则 $b \\geq 0$。一个基本定理指出，每个本原正定二次型的真等价类中恰好包含一个既约形式。\n\n我们将按问题陈述中指定的四个任务进行。\n\n1. 导出首项系数 $a$ 的界限。\n对于一个既约形式 $(a,b,c)$，我们有条件 $|b| \\leq a \\leq c$。从判别式关系中，我们有 $4ac = b^2 - \\Delta$。由于我们的判别式是 $\\Delta = -23$，这变成 $4ac = b^2 + 23$。\n条件 $a \\leq c$ 意味着 $4a^2 \\leq 4ac$。\n代入 $4ac$ 的表达式，我们得到 $4a^2 \\leq b^2 + 23$。\n条件 $|b| \\leq a$ 意味着 $b^2 \\leq a^2$。\n结合这些不等式，我们有：\n$$4a^2 \\leq a^2 + 23$$\n$$3a^2 \\leq 23$$\n$$a^2 \\leq \\frac{23}{3} \\approx 7.667$$\n由于二次型是正定的，$a$ 必须是正整数。因此，$a$ 可能的整数值为 $a=1$ 和 $a=2$。这提供了首项系数的所需严格界限。\n\n2. 枚举所有既约形式。\n我们现在寻找所有满足本原条件 $\\gcd(a,b,c)=1$、既约条件 $|b|\\leq a \\leq c$（及打破僵局规则）和判别式方程 $b^2 - 4ac = -23$ 的整数三元组 $(a,b,c)$。我们使用上面导出的 $a$ 的界限。注意，从 $b^2 - 4ac = -23$ 可得 $b^2 \\equiv -23 \\pmod 4$，可简化为 $b^2 \\equiv 1 \\pmod 4$。这意味着 $b$ 必须是奇数。\n\n情况 1：$a=1$。\n条件 $|b| \\leq a=1$ 且 $b$ 为奇数意味着 $b \\in \\{-1, 1\\}$。\n对于 $|b|=a$ 的打破僵局条件规定我们必须有 $b \\geq 0$。因此，我们必须选择 $b=1$。\n我们从判别式方程中求出 $c$：\n$b^2 - 4ac = -23 \\implies 1^2 - 4(1)c = -23 \\implies 1 - 4c = -23 \\implies 4c = 24 \\implies c=6$。\n这得到三元组 $(a,b,c)=(1,1,6)$。\n- 既约：$|b|=1 \\leq a=1 \\leq c=6$。对于 $|b|=a$ 的打破僵局规则 $b=1 \\geq 0$ 得到满足。该形式是既约的。\n- 本原：$\\gcd(1,1,6)=1$。该形式是本原的。\n所以，$f_1(x,y) = x^2+xy+6y^2$ 是一个既约本原形式。这是主形式，因为它在 $(x,y)=(1,0)$ 处表示1。\n\n情况 2：$a=2$。\n条件 $|b| \\leq a=2$ 且 $b$ 为奇数意味着 $b \\in \\{-1, 1\\}$。\n如果 $b=1$：\n$b^2 - 4ac = -23 \\implies 1^2 - 4(2)c = -23 \\implies 1 - 8c = -23 \\implies 8c = 24 \\implies c=3$。\n这得到三元组 $(a,b,c)=(2,1,3)$。\n- 既约：$|b|=1 \\leq a=2 \\leq c=3$。不等式是严格的，所以不适用打破僵局规则。该形式是既约的。\n- 本原：$\\gcd(2,1,3)=1$。该形式是本原的。\n所以，$f_2(x,y) = 2x^2+xy+3y^2$ 是一个既约本原形式。\n\n如果 $b=-1$：\n$b^2 - 4ac = -23 \\implies (-1)^2 - 4(2)c = -23 \\implies 1 - 8c = -23 \\implies 8c = 24 \\implies c=3$。\n这得到三元组 $(a,b,c)=(2,-1,3)$。\n- 既约：$|b|=1 \\leq a=2 \\leq c=3$。不等式是严格的。该形式是既约的。\n- 本原：$\\gcd(2,-1,3)=1$。该形式是本原的。\n所以，$f_3(x,y) = 2x^2-xy+3y^2$ 是一个既约本原形式。\n\n我们基于 $a$ 的导出界限进行的穷举搜索，恰好得到了三个判别式为 $\\Delta=-23$ 的既约本原正定二次型：\n- $f_1(x,y) = x^2+xy+6y^2$，对应三元组 $(1,1,6)$。\n- $f_2(x,y) = 2x^2+xy+3y^2$，对应三元组 $(2,1,3)$。\n- $f_3(x,y) = 2x^2-xy+3y^2$，对应三元组 $(2,-1,3)$。\n由于我们的搜索是穷尽了既约条件所允许的所有可能性，所以这个列表是完备的。\n\n3. 关于等价类不同性的论证。\n关于二元二次型既约化的基本定理指出，对于负判别式，每个真等价类恰好包含一个既约形式。由于我们找到了三个不同的既约形式 $f_1, f_2, f_3$，它们必然代表三个不同的真等价类。\n值得注意的是，二次型 $f_2 = (2,1,3)$ 和 $f_3 = (2,-1,3)$ 不是真等价的。两个形式 $(a,b,c)$ 和 $(a,-b,c)$（其中 $b \\neq 0$）是真等价的，当且仅当 $|b|=a$ 或 $a=c$ 这两个条件之一成立。对于 $f_2$ 和 $f_3$，我们有 $a=2, b=1, c=3$。我们看到 $|b|=1 \\neq a=2$ 且 $a=2 \\neq c=3$。因此，$f_2$ 和 $f_3$ 不是真等价的。然而，它们是假等价的（通过一个行列式为-1的变换等价）。\n\n4. 高斯复合的演示。\n在高斯复合下，真等价类集合构成一个有限阿贝尔群，称为类群 $\\text{Cl}(\\Delta)$。单位元是主形式的类 $[f_1]$。我们将一个非主形式的类 $[f_2]$ 与其自身进行复合。这对应于计算 $[f_2]^2$。\n\n设要复合的两个形式为 $F_1(x_1, y_1) = 2x_1^2 + x_1y_1 + 3y_1^2$ 和 $F_2(x_2, y_2) = 2x_2^2 + x_2y_2 + 3y_2^2$。我们使用狄利克雷的复合方法。\n由于首项系数不互质（$\\gcd(2,2)=2$），我们必须先找到其中一个二次型的一个真等价形式。二次型 $F_2$ 表示 $F_2(0,1)=3$。由于 $\\gcd(a_1, 3)=\\gcd(2,3)=1$，我们可以找到一个与 $F_2$ 真等价且首项系数为 3 的二次型。\n变换 $(x,y) \\mapsto (-y,x)$（矩阵为 $\\begin{pmatrix} 0 & -1 \\\\ 1 & 0 \\end{pmatrix} \\in \\mathrm{SL}_2(\\mathbb{Z})$）将一个形式 $(a,b,c)$ 变换为 $(c,-b,a)$。将此变换应用于 $F_2=(2,1,3)$，得到真等价形式 $(3, -1, 2)$。我们称其为 $F_2'=(3,-1,2)$。\n\n现在我们复合 $F_1=(2,1,3)$ 和 $F_2'=(3,-1,2)$。数据为 $a_1=2, b_1=1, c_1=3$ 和 $a_2=3, b_2=-1, c_2=2$。\n我们求解满足以下同余式的整数 $B$：\n- $B \\equiv b_1 \\pmod{2a_1} \\implies B \\equiv 1 \\pmod 4$\n- $B \\equiv b_2 \\pmod{2a_2} \\implies B \\equiv -1 \\pmod 6$\n- $B^2 \\equiv \\Delta \\pmod{4a_1a_2} \\implies B^2 \\equiv -23 \\pmod{24} \\implies B^2 \\equiv 1 \\pmod{24}$\n\n从 $B \\equiv -1 \\pmod 6$，我们可以写出 $B = 6k - 1$。\n代入第一个同余式：$6k - 1 \\equiv 1 \\pmod 4 \\implies 2k-1 \\equiv 1 \\pmod 4 \\implies 2k \\equiv 2 \\pmod 4$。这对任何奇数 $k$ 都成立。我们尝试 $k=1$，得到 $B=5$。\n我们检查 $B=5$ 是否满足所有条件：\n- $5 \\equiv 1 \\pmod 4$ (成立)\n- $5 \\equiv -1 \\pmod 6$ (成立)\n- $5^2 = 25 \\equiv 1 \\pmod {24}$ (成立)\n所以，我们可以取 $B=5$。\n\n复合形式 $H(x,y)=A X^2 + B XY + C Y^2$ 的系数为：\n- $A = a_1a_2 = (2)(3) = 6$。\n- $B = 5$。\n- $C = \\frac{B^2-\\Delta}{4A} = \\frac{5^2 - (-23)}{4(6)} = \\frac{25+23}{24} = \\frac{48}{24} = 2$。\n所以复合形式是 $H(x,y)=6x^2+5xy+2y^2$。\n\n这个形式不是既约的，因为它不满足 $a\\le c$ 的条件 ($a=6>c=2$)。我们必须将其既约化。\n该形式为 $(a,b,c)=(6,5,2)$。\n1. 由于 $a>c$，我们应用变换 $(x,y) \\mapsto (-y, x)$，对应于矩阵 $\\begin{pmatrix} 0 & -1 \\\\ 1 & 0 \\end{pmatrix}$。它将 $(a,b,c)$ 映射到 $(c,-b,a)$。新形式为 $(2,-5,6)$。\n2. 新形式 $(a',b',c')=(2,-5,6)$ 不是既约的，因为 $|b'|=5 > a'=2$。我们应用变换 $(x,y) \\mapsto (x+ky, y)$，对应矩阵 $\\begin{pmatrix} 1 & k \\\\ 0 & 1 \\end{pmatrix}$，其中整数 $k$ 的选择要使新的中间系数 $b'' = b' + 2a'k$ 满足 $|b''| \\leq a'$。对于 $(a',b')=(2,-5)$，我们需要 $|-5 + 4k| \\leq 2$。选择 $k=1$ 满足此条件，因为 $|-5+4(1)| = |-1| = 1 \\leq 2$。应用此变换，新形式的系数为 $(a', b'+2a'k, a'k^2+b'k+c')$。当 $k=1$ 时，新系数为：\n$a'''=a'=2$。\n$b'''=b'+2a'(1) = -5+4(1)=-1$。\n$c'''=a'(1)^2+b'(1)+c' = 2(1)+(-5)(1)+6 = 2-5+6=3$。\n完全既约后的形式是 $(2,-1,3)$，这正是我们的形式 $f_3(x,y)$。\n\n这个计算，$[f_2] * [f_2] = [f_3]$，证明了我们的类集合的封闭性。它也有助于确定逆元。在一个3阶群中，如果 $[f_2]$ 不是单位元，它的逆元必然是 $[f_2]^2$。因此，$[f_3]$ 是 $[f_2]$ 的逆元，我们记为 $[f_2]^{-1} = [f_3]$。这与 $[f_2]*[f_3] = [f_2]*[f_2]^2 = [f_2]^3$ 相符。由于该群的阶为3，根据拉格朗日定理，$[f_2]^3 = [f_1]$，即单位元。该群是3阶循环群，由 $[f_2]$ 生成（也由 $[f_3]$ 生成）。\n\n类数 $h(\\Delta)$ 是真等价类的数量，它等于既约形式的数量。我们已经找到了3个这样的形式。", "answer": "$$\\boxed{3}$$", "id": "3015037"}, {"introduction": "前面的练习在数值上展示了主形式 $(1,0,1)$ 在判别式 $D=-4$ 的情形下如同单位元。本练习将这一观察提升为一个普适的证明。通过分析其中一个二次型的首项系数为 $a=1$ （即属于主类）这一特殊情况下的复合公式，你将从代数层面推导出为何任何形式与主类复合，总会返回其自身所在的类。这个练习旨在将数值计算的经验与抽象的代数理解联系起来。[@problem_id:3015044]", "problem": "设 $f(x,y)=a x^{2}+b x y+c y^{2}$ 与 $f'(x,y)=a' x^{2}+b' x y+c' y^{2}$ 是具有相同判别式 $D=b^{2}-4 a c=b'^{2}-4 a' c'$ 的本原二次型。考虑它们的狄利克雷-高斯复合，其定义由以下标准构造给出：设 $g=\\gcd\\!\\left(a, a', \\frac{b+b'}{2}\\right)$ 且 $A=\\frac{a a'}{g^{2}}$。选取一个满足联立同余方程 $B \\equiv b \\pmod{\\frac{2 a}{g}}$，$B \\equiv b' \\pmod{\\frac{2 a'}{g}}$ 以及 $B^{2} \\equiv D \\pmod{4 A}$ 的整数 $B$。然后定义 $C=\\frac{B^{2}-D}{4 A}$。这就产生了一个本原二次型 $F(x,y)=A x^{2}+B x y+C y^{2}$，它与 $f$ 和 $f'$ 所属类的 Gauss 复合真等价。\n\n分析当 $a=1$ 或 $a'=1$ 时的边界情况。在这两种情况下，推导复合形式的中间系数 $B$ 和末尾系数 $C$ 的显式简化闭式表达式，表达式应纯粹用 $a, b, c, a', b', c'$ 以及共享的判别式恒等式来表示。你的推导必须从上述复合构造开始，通过在这些特殊情况下逻辑地简化同余和整除条件来进行，不得援引所提供框架之外任何未经证明的“捷径”恒等式。\n\n将你的最终结果表示为一个单行矩阵，按顺序包含四个条目：$a=1$ 时的 $B$，$a=1$ 时的 $C$，$a'=1$ 时的 $B$，$a'=1$ 时的 $C$。不需要进行数值计算或四舍五入；请给出精确的符号表达式。", "solution": "该问题要求在 $a=1$ 或 $a'=1$ 的特殊情况下，推导两个本原二次型 $f(x,y)=a x^{2}+b x y+c y^{2}$ 和 $f'(x,y)=a' x^{2}+b' x y+c' y^{2}$ 的狄利克雷-高斯复合 $F(x,y) = A x^{2} + B x y + C y^{2}$ 的系数 $B$ 和 $C$ 的简化闭式表达式。这两个二次型具有相同的判别式 $D = b^{2}-4ac = b'^{2}-4a'c'$。\n\n复合形式的构造由以下步骤给出：\n1.  定义 $g=\\gcd\\!\\left(a, a', \\frac{b+b'}{2}\\right)$。注意，由于 $D \\equiv b^2 \\pmod{4}$ 且 $D \\equiv b'^2 \\pmod{4}$，可得 $b^2 \\equiv b'^2 \\pmod{4}$，这意味着 $b$ 和 $b'$ 具有相同的奇偶性。因此，$b+b'$ 总是偶数，且 $\\frac{b+b'}{2}$ 是一个整数。\n2.  定义 $A=\\frac{a a'}{g^{2}}$。\n3.  选取一个满足以下联立同余方程的整数 $B$：\n    $$ B \\equiv b \\pmod{\\frac{2 a}{g}} $$\n    $$ B \\equiv b' \\pmod{\\frac{2 a'}{g}} $$\n    $$ B^{2} \\equiv D \\pmod{4 A} $$\n4.  通过关系式 $D = B^2 - 4AC$ 定义 $C$，即 $C=\\frac{B^{2}-D}{4 A}$。\n\n现在我们将基于此构造分析两种指定的边界情况。\n\n**情况 1：$a=1$**\n\n我们考虑二次型 $f(x,y) = x^2 + bxy + c y^2$。给定的形式是本原的，当 $a=1$ 时，这总是成立的，因为 $\\gcd(1, b, c) = 1$。\n\n首先，我们简化 $g$ 的表达式：\n$$ g = \\gcd\\!\\left(a, a', \\frac{b+b'}{2}\\right) = \\gcd\\!\\left(1, a', \\frac{b+b'}{2}\\right) = 1 $$\n任何包含 $1$ 的整数集合的最大公约数总是 $1$。\n\n接着，我们确定复合形式的系数 $A$：\n$$ A = \\frac{a a'}{g^{2}} = \\frac{1 \\cdot a'}{1^{2}} = a' $$\n\n现在，我们分析关于中间系数 $B$ 的同余方程组。代入 $a=1$ 和 $g=1$：\n1.  $B \\equiv b \\pmod{\\frac{2 \\cdot 1}{1}} \\implies B \\equiv b \\pmod{2}$\n2.  $B \\equiv b' \\pmod{\\frac{2 a'}{1}} \\implies B \\equiv b' \\pmod{2a'}$\n3.  $B^{2} \\equiv D \\pmod{4 A} \\implies B^{2} \\equiv D \\pmod{4a'}$\n\n第二个同余式 $B \\equiv b' \\pmod{2a'}$ 是最具限制性的。任何满足该同余式的整数 $B$ 必为 $B = b' + 2a'k$ 的形式，其中 $k$ 为某个整数。\n我们来验证这样的 $B$ 是否满足另外两个同余式。\n对于第一个同余式：$b' + 2a'k \\equiv b \\pmod{2}$。由于 $2a'k \\equiv 0 \\pmod{2}$，该式简化为 $b' \\equiv b \\pmod{2}$。如前所述，$b$ 和 $b'$ 必须具有相同的奇偶性，因此这个条件总是满足的。\n对于第三个同余式：我们有 $B \\equiv b' \\pmod{2a'}$，这意味着 $B^2 \\equiv b'^2 \\pmod{4a'}$。根据判别式恒等式 $D = b'^{2} - 4a'c'$，我们可以写出 $b'^2 = D + 4a'c'$。这意味着 $b'^2 \\equiv D \\pmod{4a'}$。因此，如果 $B^2 \\equiv b'^2 \\pmod{4a'}$，则 $B^2 \\equiv D \\pmod{4a'}$。所以，对于任何满足第二个同余式的 $B$，第三个同余式也得到满足。\n\n该同余方程组实际上简化为 $B \\equiv b' \\pmod{2a'}$。问题要求给出 $B$ 的显式简化表达式。满足此条件的整数 $B$ 的最简单选择是取 $k=0$，可得：\n$$ B = b' $$\n\n选定 $B$ 后，我们现在确定最后的系数 $C$：\n$$ C = \\frac{B^{2}-D}{4 A} = \\frac{(b')^{2}-D}{4 a'} $$\n代入判别式恒等式 $D = b'^{2}-4a'c'$：\n$$ C = \\frac{b'^{2} - (b'^{2}-4a'c')}{4 a'} = \\frac{4a'c'}{4 a'} $$\n由于 $f'(x,y)$ 是一个二次型，其首项系数 $a'$ 是一个非零整数。因此，我们可以简化该分数：\n$$ C = c' $$\n所以，在 $a=1$ 的情况下，系数为 $B=b'$ 和 $C=c'$。得到的复合形式为 $F(x,y)=a'x^2+b'xy+c'y^2$，与 $f'(x,y)$ 相同。这与以下事实相符：任何 $a=1$ 的二次型都属于主类，而与主类复合相当于单位元运算。\n\n**情况 2：$a'=1$**\n\n这种情况与第一种情况完全对称。我们考虑二次型 $f'(x,y) = x^2 + b'xy + c'y^2$。\n\n首先，我们简化 $g$ 的表达式：\n$$ g = \\gcd\\!\\left(a, a', \\frac{b+b'}{2}\\right) = \\gcd\\!\\left(a, 1, \\frac{b+b'}{2}\\right) = 1 $$\n\n接着，我们确定系数 $A$：\n$$ A = \\frac{a a'}{g^{2}} = \\frac{a \\cdot 1}{1^{2}} = a $$\n\n现在，我们分析关于 $B$ 的同余方程组。代入 $a'=1$ 和 $g=1$：\n1.  $B \\equiv b \\pmod{\\frac{2 a}{1}} \\implies B \\equiv b \\pmod{2a}$\n2.  $B \\equiv b' \\pmod{\\frac{2 \\cdot 1}{1}} \\implies B \\equiv b' \\pmod{2}$\n3.  $B^{2} \\equiv D \\pmod{4 A} \\implies B^{2} \\equiv D \\pmod{4a}$\n\n第一个同余式 $B \\equiv b \\pmod{2a}$ 是最具限制性的。任何满足该同余式的整数 $B$ 必为 $B = b + 2ak$ 的形式，其中 $k$ 为某个整数。\n我们来验证这样的 $B$ 是否满足另外两个同余式。\n对于第二个同余式：$b + 2ak \\equiv b' \\pmod{2}$。该式简化为 $b \\equiv b' \\pmod{2}$，此条件总是成立的。\n对于第三个同余式：我们有 $B \\equiv b \\pmod{2a}$，这意味着 $B^2 \\equiv b^2 \\pmod{4a}$。根据判别式恒等式 $D = b^{2} - 4ac$，我们有 $b^2 = D + 4ac$。这意味着 $b^2 \\equiv D \\pmod{4a}$。因此，如果 $B^2 \\equiv b^2 \\pmod{4a}$，则 $B^2 \\equiv D \\pmod{4a}$。所以第三个同余式也得到满足。\n\n该同余方程组简化为 $B \\equiv b \\pmod{2a}$。我们通过取 $k=0$ 来选择 $B$ 的最简单的整数代表：\n$$ B = b $$\n\n选定 $B$ 后，我们确定 $C$：\n$$ C = \\frac{B^{2}-D}{4 A} = \\frac{b^{2}-D}{4 a} $$\n代入判别式恒等式 $D = b^{2}-4ac$：\n$$ C = \\frac{b^{2} - (b^{2}-4ac)}{4 a} = \\frac{4ac}{4 a} $$\n由于 $f(x,y)$ 是一个二次型，$a \\neq 0$。我们可以简化：\n$$ C = c $$\n所以，在 $a'=1$ 的情况下，系数为 $B=b$ 和 $C=c$。得到的复合形式为 $F(x,y)=ax^2+bxy+cy^2$，与 $f(x,y)$ 相同。\n\n总之，推导出的显式表达式为：\n- 当 $a=1$ 时：$B=b'$ 且 $C=c'$。\n- 当 $a'=1$ 时：$B=b$ 且 $C=c$。\n我们将这四个结果以上述要求的单行矩阵格式呈现。", "answer": "$$ \\boxed{ \\begin{pmatrix} b' & c' & b & c \\end{pmatrix} } $$", "id": "3015044"}]}