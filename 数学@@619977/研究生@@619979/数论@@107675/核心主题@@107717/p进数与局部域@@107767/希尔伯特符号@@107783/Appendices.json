{"hands_on_practices": [{"introduction": "掌握希尔伯特符号的第一步是亲手实践其定义。本练习将引导你直接在 $p$-adic 域 $\\mathbb{Q}_5$ 中，通过检验二次方程 $ax^2 + by^2 = z^2$ 是否有非平凡解来计算希尔伯特符号的值。这个过程不仅能让你熟悉 $p$-adic 范数、模 $p$ 约化以及 Hensel 引理等基本工具，更是从第一性原理理解希尔伯特符号具体行为的绝佳机会 [@problem_id:3026930]。", "problem": "设 $p$ 是一个奇素数，$\\mathbb{Q}_p$ 是 $p$-进数域。对于 $a,b \\in \\mathbb{Q}_p^{\\times}$，希尔伯特符号 $(a,b)_p \\in \\{\\pm 1\\}$ 定义为：如果齐次二次方程 $a x^2 + b y^2 = z^2$ 有一个非平凡解 $(x,y,z) \\in \\mathbb{Q}_p^3 \\setminus \\{(0,0,0)\\}$，则 $(a,b)_p = 1$，否则 $(a,b)_p = -1$。在 $\\mathbb{Q}_5$ 上进行计算，仅使用上述定义、$5$-进赋值的基本性质、模 $5$ 约化以及（当适用时）通过 Hensel 引理进行提升，计算三个希尔伯特符号 $(2,5)_5$、$(2,3)_5$ 和 $(5,5)_5$。然后，将你的结果与来自 $\\mathbb{F}_5$ 上勒让德符号的直观预期进行比较，即对 $(\\frac{2}{5})$ 和 $(\\frac{-1}{5})$ 的二次剩余考量。你最终报告的答案必须是按顺序 $((2,5)_5,(2,3)_5,(5,5)_5)$ 排列的三个值，并写成单行矩阵的形式。无需舍入。", "solution": "问题陈述的有效性已得到确认。该问题在数论领域是良置的、有科学依据的，并包含了得到唯一解所需的所有必要信息。\n\n对于 $a,b \\in \\mathbb{Q}_p^\\times$，希尔伯特符号 $(a,b)_p$ 定义为：如果方程 $ax^2 + by^2 = z^2$ 有一个非平凡解 $(x,y,z) \\in \\mathbb{Q}_p^3 \\setminus \\{(0,0,0)\\}$，则其值为 $1$，否则为 $-1$。我们可以寻找在 $\\mathbb{Z}_p^3$ 中的一个“本原”解，即一个解 $(x,y,z) \\in \\mathbb{Z}_p^3$，其中 $x,y,z$ 不全被 $p$ 整除。在 $\\mathbb{Q}_p$ 中存在非平凡解等价于在 $\\mathbb{Z}_p$ 中存在本原解。我们在 $\\mathbb{Q}_5$ 中计算，所以 $p=5$。\n\n1.  **计算 $(2,5)_5$**\n    我们分析方程 $2x^2 + 5y^2 = z^2$ 以寻找本原解 $(x,y,z) \\in \\mathbb{Z}_5^3$。\n    将方程模 $5$ 约化，我们得到：\n    $$2x^2 + 5y^2 \\equiv z^2 \\pmod{5}$$\n    $$2x^2 \\equiv z^2 \\pmod{5}$$\n    模 $5$ 的二次剩余是 $\\{1^2, 2^2, 3^2, 4^2, 0^2\\} \\pmod{5}$，即 $\\{1, 4, 9\\equiv4, 16\\equiv1, 0\\}$，也就是 $\\{0, 1, 4\\}$。\n    如果 $x$ 是 $\\mathbb{Z}_5$ 中的一个单位，其 $5$-进赋值 $v_5(x)$ 为 $0$，所以 $x \\not\\equiv 0 \\pmod{5}$。在这种情况下，$x^2 \\equiv 1$ 或 $4 \\pmod{5}$。\n    - 如果 $x^2 \\equiv 1 \\pmod{5}$，那么 $2x^2 \\equiv 2 \\pmod{5}$。\n    - 如果 $x^2 \\equiv 4 \\pmod{5}$，那么 $2x^2 \\equiv 8 \\equiv 3 \\pmod{5}$。\n    无论哪种情况，$2x^2$ 都同余于 $2$ 或 $3 \\pmod{5}$。表达式 $z^2$ 必须同余于 $0, 1,$ 或 $4 \\pmod{5}$。当 $x \\not\\equiv 0 \\pmod{5}$ 时，没有值能满足 $2x^2 \\equiv z^2 \\pmod{5}$。\n    因此，任何解都必须有 $x \\equiv 0 \\pmod{5}$。\n    如果 $x \\equiv 0 \\pmod{5}$，方程 $2x^2 \\equiv z^2 \\pmod{5}$ 变为 $0 \\equiv z^2 \\pmod{5}$，这意味着 $z \\equiv 0 \\pmod{5}$。\n    所以，对于任何可能的本原解 $(x,y,z)$，我们必须有 $v_5(x) \\ge 1$ 和 $v_5(z) \\ge 1$。设 $x=5x_1$ 且 $z=5z_1$，其中 $x_1, z_1 \\in \\mathbb{Z}_5$。\n    将它们代入原方程：\n    $$2(5x_1)^2 + 5y^2 = (5z_1)^2$$\n    $$50x_1^2 + 5y^2 = 25z_1^2$$\n    两边除以 $5$：\n    $$10x_1^2 + y^2 = 5z_1^2$$\n    将这个新方程模 $5$ 约化：\n    $$10x_1^2 + y^2 \\equiv 5z_1^2 \\pmod{5}$$\n    $$y^2 \\equiv 0 \\pmod{5}$$\n    这意味着 $y \\equiv 0 \\pmod{5}$，所以 $v_5(y) \\ge 1$。\n    我们已经证明，如果 $(x,y,z)$ 是 $\\mathbb{Z}_5^3$ 中的一个解，那么 $x,y,z$ 必须都能被 $5$ 整除。这与 $(x,y,z)$ 是一个本原解的假设相矛盾。通过无穷递降法，此论证表明在 $\\mathbb{Z}_5^3$ 中唯一的解是平凡解 $(0,0,0)$。\n    因此，在 $\\mathbb{Q}_5^3$ 中没有非平凡解。\n    $$(2,5)_5 = -1$$\n\n2.  **计算 $(2,3)_5$**\n    我们分析方程 $2x^2 + 3y^2 = z^2$。$2$ 和 $3$ 都是 $\\mathbb{Z}_5$ 中的单位。我们寻找一个非平凡解。让我们尝试找一个 $z=1$ 的解。方程变为 $2x^2 + 3y^2 = 1$。\n    我们首先找一个模 $5$ 的解：$2x^2 + 3y^2 \\equiv 1 \\pmod{5}$。\n    通过试算，我们可以设 $y_0 = 1$。方程变为 $2x^2 + 3 \\equiv 1 \\pmod{5}$，化简为 $2x^2 \\equiv -2 \\equiv 3 \\pmod{5}$。模 $5$ 的平方数是 $0, 1, 4$。$2(0)^2=0$, $2(1)^2=2$, $2(2)^2=8\\equiv3$, $2(3)^2=18\\equiv3$, $2(4)^2=32\\equiv2$。所以我们可以取 $x_0=2$。\n    因此，$(x_0, y_0) = (2,1)$ 是 $2x^2 + 3y^2 \\equiv 1 \\pmod{5}$ 的一个解。\n    我们现在使用 Hensel 引理将其提升到 $\\mathbb{Z}_5$ 中的一个解。我们固定 $y=1$ 并求解方程 $2x^2 + 3(1)^2 - 1^2 = 0$ 中的 $x$。\n    设 $f(x) = 2x^2 + 2$。我们有一个模 $5$ 的根 $x_0 = 2$，因为 $f(2) = 2(2^2) + 2 = 10 \\equiv 0 \\pmod{5}$。\n    其导数是 $f'(x) = 4x$。在 $x_0=2$ 处，我们有 $f'(2) = 4(2) = 8 \\equiv 3 \\not\\equiv 0 \\pmod{5}$。\n    我们检验 Hensel 引理的条件：$|f(x_0)|_5 < |f'(x_0)|_5^2$。\n    $|f(2)|_5 = |10|_5 = |2 \\cdot 5|_5 = 5^{-1}$。\n    $|f'(2)|_5 = |8|_5 = 1$。\n    条件是 $5^{-1} < 1^2$，这是成立的。\n    Hensel 引理保证存在唯一的根 $\\alpha \\in \\mathbb{Z}_5$ 使得 $f(\\alpha) = 0$ 且 $\\alpha \\equiv 2 \\pmod{5}$。\n    这意味着存在一个 $\\alpha \\in \\mathbb{Z}_5$ 使得 $2\\alpha^2 + 2 = 0$，这等价于 $2\\alpha^2 + 3(1)^2 = 1^2$。\n    因此，$(\\alpha, 1, 1)$ 是方程 $2x^2 + 3y^2 = z^2$ 在 $\\mathbb{Z}_5^3$ 中的一个非平凡解。\n    $$(2,3)_5 = 1$$\n\n3.  **计算 $(5,5)_5$**\n    我们分析方程 $5x^2 + 5y^2 = z^2$。\n    我们可以通过注意到如果 $-1$ 在 $\\mathbb{Q}_5$ 中是平方数（比如说 $\\alpha^2=-1$），那么我们可以设 $y=1, z=0$，从而简化这个方程。方程变为 $5x^2+5(1)^2=0$，这意味着 $5x^2=-5$，所以 $x^2=-1$。$x$ 的一个解将是 $\\alpha$。那么 $(\\alpha, 1, 0)$ 将会是一个非平凡解。\n    我们检查 $-1$ 是否是 $\\mathbb{Q}_5$ 中的平方数。对于一个奇素数 $p$，一个单位 $u \\in \\mathbb{Z}_p^\\times$ 在 $\\mathbb{Q}_p$ 中是平方数，当且仅当勒让德符号 $(\\frac{u \\pmod p}{p})$ 为 $1$。\n    对于 $p=5$，我们检查 $\\left(\\frac{-1}{5}\\right)$。根据数论，$\\left(\\frac{-1}{p}\\right) = (-1)^{(p-1)/2}$。\n    对于 $p=5$，这便是 $\\left(\\frac{-1}{5}\\right) = (-1)^{(5-1)/2} = (-1)^2 = 1$。\n    由于 $-1$ 是模 $5$ 的二次剩余（例如 $2^2=4 \\equiv -1 \\pmod 5$），根据 Hensel 引理，存在一个 $\\alpha \\in \\mathbb{Z}_5$ 使得 $\\alpha^2 = -1$。\n    于是设 $(x,y,z) = (\\alpha, 1, 0)$，我们得到 $5\\alpha^2 + 5(1)^2 = 5(-1) + 5 = 0 = 0^2$。这是一个在 $\\mathbb{Q}_5^3$ 中的有效的非平凡解。\n    作为另一种更直接的方法，可以寻找一个整数解。考虑 $(x,y) = (1,2)$：\n    $$5(1)^2 + 5(2)^2 = 5 + 5(4) = 25$$\n    我们需要它等于 $z^2$。设 $z^2=25$ 得到 $z=5$。\n    因此，$(x,y,z) = (1,2,5)$ 是 $\\mathbb{Z}^3$ 中的一个非平凡解。因为 $\\mathbb{Z} \\subset \\mathbb{Q}_5$，所以这也是 $\\mathbb{Q}_5^3$ 中的一个非平凡解。\n    $$(5,5)_5 = 1$$\n\n**与来自勒让德符号的直观预期的比较**\n\n- 对于 $(2,5)_5 = -1$：方程模 $5$ 为 $2x^2 \\equiv z^2 \\pmod{5}$。一个非平凡解要求 $x,z \\not\\equiv 0 \\pmod 5$。这将意味着 $2 \\equiv (z/x)^2 \\pmod 5$，也就是说 $2$ 是模 $5$ 的二次剩余。然而，勒让德符号 $\\left(\\frac{2}{5}\\right) = -1$。对于非零的 $x,z$，该同余式无解，这强烈地表明希尔伯特符号为 $-1$。\n\n- 对于 $(2,3)_5 = 1$：因为 $2,3$ 是 $\\mathbb{Z}_5$ 中的单位，一个常见的直观方法是检查 $-3/2$ 是否是 $\\mathbb{Q}_5$ 中的平方数。这等价于检查其模 $5$ 的约化是否是二次剩余。$-3/2 \\equiv (-3)(3) = -9 \\equiv 1 \\pmod 5$。勒让德符号 $\\left(\\frac{1}{5}\\right) = 1$。这正确地预测了 $(2,3)_5=1$。\n\n- 对于 $(5,5)_5 = 1$：一个类似的直观方法建议检查 $-5/5 = -1$ 是否是 $\\mathbb{Q}_5$ 中的平方数。如前所计算，$\\left(\\frac{-1}{5}\\right) = 1$，所以 $-1$ 是 $\\mathbb{Q}_5$ 中的一个平方数。这个直观方法正确地预测了 $(5,5)_5=1$。\n\n**最终答案**\n三个希尔伯特符号是 $(2,5)_5 = -1$、$(2,3)_5 = 1$ 和 $(5,5)_5 = 1$。最终报告的答案即为这三个值的有序组。", "answer": "$$\\boxed{\\begin{pmatrix} -1 & 1 & 1 \\end{pmatrix}}$$", "id": "3026930"}, {"introduction": "在掌握了单个局部域上的计算后，下一步是理解这些局部符号如何相互关联，构成一幅全局图景。希尔伯特互反律是数论中的一个深刻结果，它指出对于任意 $a, b \\in \\mathbb{Q}^\\times$，所有局部希尔伯特符号 $(a,b)_v$ 的乘积恒为 $1$。本练习将通过一个具体例子，计算在所有相关“位” $v$ 上的符号值，来亲手验证这一优美的定律，从而加深对局部-全局原则的理解 [@problem_id:3026947]。", "problem": "设 $a=13$ 和 $b=5$ 为 $\\mathbb{Q}^{\\times}$ 中的元素。对于 $\\mathbb{Q}$ 的每个赋值 $v$，我们将局部域 $\\mathbb{Q}_{v}$ 上的希尔伯特符号 $(a,b)_{v}$ 定义为：如果二次型 $a x^{2}+b y^{2}-z^{2}$ 在 $\\mathbb{Q}_{v}$ 上非平凡地表示 $0$（即，存在不全为零的 $x,y,z \\in \\mathbb{Q}_{v}$ 使得 $a x^{2}+b y^{2}=z^{2}$），则 $(a,b)_{v}=1$；否则 $(a,b)_{v}=-1$。请从这个定义以及关于赋值和二次剩余的基本知识出发，计算对于 $\\mathbb{Q}$ 的所有赋值 $v$ 的 $(a,b)_{v}$，然后计算乘积 $\\prod_{v}(a,b)_{v}$。你的最终答案必须是乘积 $\\prod_{v}(a,b)_{v}$ 的值，该值应为一个精确的数字。不需要四舍五入，也不涉及物理单位。", "solution": "首先对问题进行验证。\n\n### 第1步：提取已知条件\n-   $a = 13 \\in \\mathbb{Q}^{\\times}$\n-   $b = 5 \\in \\mathbb{Q}^{\\times}$\n-   $v$ 表示 $\\mathbb{Q}$ 的一个赋值。\n-   $\\mathbb{Q}_{v}$ 是 $\\mathbb{Q}$ 在赋值 $v$ 上的完备化。\n-   希尔伯特符号 $(a,b)_{v}$ 定义如下：\n    -   $(a,b)_{v} = 1$ 如果存在不全为零的 $x, y, z \\in \\mathbb{Q}_{v}$，使得 $a x^{2} + b y^{2} = z^{2}$。这等价于说二次型 $a x^{2} + b y^{2} - z^{2}$ 在 $\\mathbb{Q}_{v}$ 上非平凡地表示 $0$。\n    -   否则 $(a,b)_{v} = -1$。\n-   任务是计算对于 $\\mathbb{Q}$ 的所有赋值 $v$ 的 $(a,b)_{v}$，然后计算乘积 $\\prod_{v}(a,b)_{v}$。\n\n### 第2步：使用提取的已知条件进行验证\n-   **科学依据：** 该问题是代数数论中的一个标准练习。希尔伯特符号的定义、$\\mathbb{Q}$ 的赋值概念以及局部域上的二次型性质都是成熟的数学概念。该问题在科学上和事实上都是合理的。\n-   **适定性：** 提供了所有必要的数据（$a=13, b=5$）和定义。目标明确无歧义。存在唯一解。\n-   **客观性：** 问题使用精确、形式化的数学语言陈述，没有主观或模糊的术语。\n\n### 第3步：结论与行动\n该问题是 **有效的**，因为它在数学上是合理的、适定的且客观的。没有矛盾、信息缺失或违反科学原则的情况。可以进行求解过程。\n\n我们被要求计算有理数域 $\\mathbb{Q}$ 的所有赋值 $v$ 上，对于 $a=13$ 和 $b=5$ 的希尔伯特符号 $(a,b)_{v}$，然后计算它们的乘积。$\\mathbb{Q}$ 的赋值包括无限赋值 $v=\\infty$（对应于完备化 $\\mathbb{Q}_{\\infty} = \\mathbb{R}$）和对每个素数 $p$ 的有限赋值 $v=p$（对应于完备化 $\\mathbb{Q}_{p}$）。\n\n**1. 无限赋值 ($v = \\infty$)**\n我们计算 $(13, 5)_{\\infty}$。此时的域是实数集 $\\mathbb{R}$。方程为 $13x^{2} + 5y^{2} = z^{2}$。由于 $a=13$ 和 $b=5$ 都是正数，我们可以轻易找到一个非平凡的实数解。例如，取 $x=1$ 和 $y=0$，我们得到 $13 = z^{2}$，它有一个解 $z=\\sqrt{13} \\in \\mathbb{R}$。因此，$(x, y, z) = (1, 0, \\sqrt{13})$是 $\\mathbb{R}^{3}$ 中的一个非平凡解。根据定义，这意味着 $(13, 5)_{\\infty} = 1$。一般地，对于 $a, b \\in \\mathbb{R}^{\\times}$，$(a,b)_{\\infty} = -1$ 当且仅当 $a < 0$ 和 $b < 0$ 都成立。由于 $13 > 0$ 且 $5 > 0$，该符号值为 $1$。\n\n**2. 有限赋值 ($v = p$)**\n我们现在计算对所有素数 $p$ 的 $(13, 5)_{p}$。希尔伯特符号的一个基本性质是，对于任意非零有理数 $a$ 和 $b$，除了有限个素数 $p$ 以外，符号 $(a,b)_{p}$ 都等于 $1$。具体来说，$(a,b)_{p}$ 可能不等于 $1$ 的情况只发生在 $p=\\infty$ 以及整除 $2ab$ 的有限素数 $p$。在我们的例子中，$a=13$，$b=5$，所以 $2ab = 2 \\cdot 13 \\cdot 5 = 130$。我们需要检查的素数是 $p=2$、$p=5$ 和 $p=13$。对于所有其他素数 $p$，我们有 $(13, 5)_{p} = 1$。\n\n**情况 $p=2$：**\n我们计算 $(13, 5)_{2}$。我们使用 $\\mathbb{Q}_{2}$ 上希尔伯特符号的标准公式。对于 $a, b \\in \\mathbb{Z}_{2}^{\\times}$（即奇整数），公式为 $(a,b)_{2} = (-1)^{\\epsilon(a)\\epsilon(b)}$，其中 $\\epsilon(x) = \\frac{x-1}{2}$。\n这里，$a=13$，$b=5$。\n$\\epsilon(13) = \\frac{13-1}{2} = 6$。\n$\\epsilon(5) = \\frac{5-1}{2} = 2$。\n所以，$(13, 5)_{2} = (-1)^{6 \\cdot 2} = (-1)^{12} = 1$。\n\n**情况 $p=5$：**\n我们计算 $(13, 5)_{5}$。对于一个奇素数 $p$，希尔伯特符号 $(a,b)_{p}$ 的一个通用公式由下式给出\n$$ (a,b)_{p} = (-1)^{\\alpha\\beta\\frac{p-1}{2}} \\left(\\frac{u}{p}\\right)^{\\beta} \\left(\\frac{v}{p}\\right)^{\\alpha} $$\n其中 $a = p^{\\alpha}u$, $b = p^{\\beta}v$，$u, v$ 是 $p$-adic 单位，而 $(\\frac{\\cdot}{p})$ 是勒让德符号。\n对于 $a=13$，$b=5$ 和 $p=5$：\n$a = 13 = 5^{0} \\cdot 13$，所以 $\\alpha = 0$ 且 $u=13$。\n$b = 5 = 5^{1} \\cdot 1$，所以 $\\beta = 1$ 且 $v=1$。\n将这些代入公式：\n$$ (13, 5)_{5} = (-1)^{0 \\cdot 1 \\cdot \\frac{5-1}{2}} \\left(\\frac{13}{5}\\right)^{1} \\left(\\frac{1}{5}\\right)^{0} = \\left(\\frac{13}{5}\\right) $$\n勒让德符号计算如下 $\\left(\\frac{13}{5}\\right) = \\left(\\frac{13 \\pmod 5}{5}\\right) = \\left(\\frac{3}{5}\\right)$。\n模 $5$ 的二次剩余是 $1^{2} \\equiv 1$ 和 $2^{2} \\equiv 4$。由于 $3$ 不是模 $5$ 的二次剩余，我们有 $\\left(\\frac{3}{5}\\right) = -1$。\n因此，$(13, 5)_{5} = -1$。\n\n**情况 $p=13$：**\n我们计算 $(13, 5)_{13}$。我们使用与 $p=5$ 时相同的公式。\n对于 $a=13$，$b=5$ 和 $p=13$：\n$a = 13 = 13^{1} \\cdot 1$，所以 $\\alpha = 1$ 且 $u=1$。\n$b = 5 = 13^{0} \\cdot 5$，所以 $\\beta = 0$ 且 $v=5$。\n将这些代入公式：\n$$ (13, 5)_{13} = (-1)^{1 \\cdot 0 \\cdot \\frac{13-1}{2}} \\left(\\frac{1}{13}\\right)^{0} \\left(\\frac{5}{13}\\right)^{1} = \\left(\\frac{5}{13}\\right) $$\n为了计算勒让德符号 $\\left(\\frac{5}{13}\\right)$，我们可以使用二次互反律：\n$$ \\left(\\frac{5}{13}\\right) = \\left(\\frac{13}{5}\\right) (-1)^{\\frac{5-1}{2} \\frac{13-1}{2}} = \\left(\\frac{3}{5}\\right) (-1)^{2 \\cdot 6} = \\left(\\frac{3}{5}\\right) $$\n如前所计算， $\\left(\\frac{3}{5}\\right) = -1$。\n因此，$(13, 5)_{13} = -1$。\n\n**希尔伯特符号总结：**\n-   $(13, 5)_{\\infty} = 1$\n-   $(13, 5)_{2} = 1$\n-   $(13, 5)_{5} = -1$\n-   $(13, 5)_{13} = -1$\n-   对于所有其他素数 $p \\notin \\{2, 5, 13\\}$，$(13, 5)_{p} = 1$。\n\n**所有赋值上的乘积：**\n最后一步是计算这些值在 $\\mathbb{Q}$ 的所有赋值 $v$ 上的乘积。\n$$ \\prod_{v} (13, 5)_{v} = (13, 5)_{\\infty} \\cdot \\prod_{p \\text{ prime}} (13, 5)_{p} $$\n$$ \\prod_{v} (13, 5)_{v} = (13, 5)_{\\infty} \\cdot (13, 5)_{2} \\cdot (13, 5)_{5} \\cdot (13, 5)_{13} \\cdot \\prod_{p \\notin \\{2,5,13\\}} (13, 5)_{p} $$\n代入计算出的值：\n$$ \\prod_{v} (13, 5)_{v} = 1 \\cdot 1 \\cdot (-1) \\cdot (-1) \\cdot \\prod_{p \\notin \\{2,5,13\\}} 1 $$\n$$ \\prod_{v} (13, 5)_{v} = 1 \\cdot 1 \\cdot 1 = 1 $$\n结果是 $1$。这是希尔伯特互反律的一个实例，该定律指出，对于任何 $a,b \\in \\mathbb{Q}^{\\times}$，其所有希尔伯特符号 $(a,b)_{v}$ 在 $\\mathbb{Q}$ 的所有赋值 $v$ 上的乘积总是等于 $1$。", "answer": "$$\n\\boxed{1}\n$$", "id": "3026947"}, {"introduction": "理论的最终试金石是其在实践中的应用与泛化。这个综合性练习要求你将之前学到的所有计算规则——包括奇素数 $p$ 的情况以及更为精细的 $p=2$ 的情况——整合成一个统一的算法。将抽象的数学公式转化为精确、可执行的计算步骤，是现代数论研究中一项至关重要的技能，本练习将全面锻炼你在这方面的能力 [@problem_id:3026921]。", "problem": "设计并实现一个完整的可运行程序，该程序为给定的数对 $(a,b) \\in \\mathbb{Q}_p^\\times \\times \\mathbb{Q}_p^\\times$ 和一个素数 $p$ 计算 Hilbert 符号 $(a,b)_p \\in \\{\\pm 1\\}$。算法基础只能使用以下基本工具：$p$-进赋值、模 $p$ 约化（当 $p=2$ 时为模 $8$）以及使用 Hensel 提升将计算简化为单位计算。您的程序必须使用精确有理数算术，不得依赖浮点近似值。\n\n您在推理和设计中可以假设的基础仅限于：\n- $\\mathbb{Q}^\\times$ 上 $p$-进赋值 $v_p$ 的定义及其基本性质（乘法性以及将 $x$ 分解为 $x=p^{v_p(x)}u$ 的形式，其中 $u \\in \\mathbb{Z}_p^\\times$ 是一个单位）。\n- 对于奇素数 $p$ 和单位 $u \\in \\mathbb{Z}_p^\\times$，Legendre 符号 $\\left(\\frac{u}{p}\\right)$ 的定义，以及 Euler 准则 $u^{(p-1)/2} \\equiv \\left(\\frac{u}{p}\\right) \\pmod p$。\n- 用于将解从剩余域提升到 $\\mathbb{Z}_p$ 的 Hensel 引理（概念性地用于证明简化为单位计算的合理性；您不得硬编码任何目标公式作为捷径）。\n- Hilbert 符号 $(\\cdot,\\cdot)_p$ 在 $\\mathbb{Q}_p^\\times / (\\mathbb{Q}_p^\\times)^2$ 上的乘法性和双线性。\n\n您的算法必须遵循以下基本原理：\n1. 给定 $a,b \\in \\mathbb{Q}^\\times$ 和一个素数 $p$，计算赋值 $v_p(a)$ 和 $v_p(b)$，并将 $a,b$写作 $a=p^\\alpha u$ 和 $b=p^\\beta v$ 的形式，其中 $u,v \\in \\mathbb{Z}_p^\\times$ 是单位。\n2. 利用双线性和 Hilbert 符号仅取决于 $a,b$ 在 $\\mathbb{Q}_p^\\times$ 中的平方剩余类这一事实，将 $(a,b)_p$ 的计算简化为单位计算。\n3. 对于奇素数 $p$，通过 Hensel 提升和 Legendre 符号将单位信息约化为模 $p$ 的剩余类，并将其与来自 $v_p(a), v_p(b)$ 的奇偶性信息相结合。\n4. 对于 $p=2$，通过 Hensel 提升将单位信息约化为模 $8$ 的剩余类，并使用控制 $\\mathbb{Q}_2^\\times$ 上 Hilbert 符号的标准模 $8$ 单位不变量。\n\n您的程序必须通过算法实现上述步骤，不得使用任何用于计算 Hilbert 符号的外部黑盒。\n\n测试套件：\n为以下每个测试用例计算 $(a,b)_p$。每个有理数都以精确分数 $a=\\frac{m}{n}$，$b=\\frac{r}{s}$ 的形式给出，其中整数 $m,n,r,s \\neq 0$。\n\n- 情况 1：$p=3$, $a=\\frac{3}{1}$, $b=\\frac{3}{1}$。\n- 情况 2：$p=5$, $a=\\frac{5}{1}$, $b=\\frac{5}{1}$。\n- 情况 3：$p=7$, $a=\\frac{2}{1}$, $b=\\frac{7}{1}$。\n- 情况 4：$p=7$, $a=\\frac{3}{1}$, $b=\\frac{7}{1}$。\n- 情况 5：$p=3$, $a=\\frac{2}{1}$, $b=\\frac{2}{1}$。\n- 情况 6：$p=2$, $a=\\frac{-1}{1}$, $b=\\frac{-1}{1}$。\n- 情况 7：$p=2$, $a=\\frac{2}{1}$, $b=\\frac{2}{1}$。\n- 情况 8：$p=2$, $a=\\frac{-1}{1}$, $b=\\frac{2}{1}$。\n- 情况 9：$p=2$, $a=\\frac{3}{1}$, $b=\\frac{3}{1}$。\n- 情况 10：$p=5$, $a=\\frac{1}{5}$, $b=\\frac{5}{1}$。\n- 情况 11：$p=3$, $a=\\frac{2}{3}$, $b=\\frac{6}{1}$。\n- 情况 12：$p=2$, $a=\\frac{3}{5}$, $b=\\frac{7}{9}$。\n\n答案规格：\n- 对于每种情况，输出必须是表示 $(a,b)_p$ 的整数 $+1$ 或 $-1$。\n- 您的程序应生成单行输出，其中包含按顺序排列的结果，格式为用方括号括起来的逗号分隔列表，例如 $[1,-1,1]$。\n\n不涉及物理单位。所有角度单位和百分比均不相关。最终输出必须是严格符合指定列表格式的一行。程序必须是自包含的，并且不需要任何输入。", "solution": "对于 $a,b \\in \\mathbb{Q}^\\times$ 和一个素数 $p$，计算 Hilbert 符号 $(a,b)_p$ 是数论中的一项基本任务。Hilbert 符号定义为\n$$\n(a,b)_p = \\begin{cases}\n    1 & \\text{如果方程 } z^2 = ax^2 + by^2 \\text{ 在 } \\mathbb{Q}_p \\text{ 中有非平凡解} \\\\\n    -1 & \\text{否则}\n\\end{cases}\n$$\n我们的算法方法基于指定的符号性质，避免直接使用此定义。该方法的核心是利用 Hilbert 符号的双线性，将计算简化为涉及 $p$-进单位和素数 $p$ 本身的更简单情况。\n\n首先，对于任何 $x \\in \\mathbb{Q}^\\times$，我们可以将其唯一地写成 $x = p^{v_p(x)} u$ 的形式，其中 $v_p(x)$ 是 $x$ 的 $p$-进赋值，而 $u \\in \\mathbb{Z}_p^\\times$ 是一个 $p$-进单位（即分子和分母都不能被 $p$ 整除的有理数）。令 $a = p^{\\alpha} u$ 和 $b = p^{\\beta} v$，其中 $\\alpha = v_p(a)$，$\\beta = v_p(b)$，且 $u, v$ 是 $p$-进单位。\n\n利用 Hilbert 符号的双线性和对称性，我们可以展开 $(a,b)_p$：\n$$\n(a,b)_p = (p^\\alpha u, p^\\beta v)_p = (p^\\alpha, p^\\beta v)_p (u, p^\\beta v)_p\n$$\n$$\n= (p^\\alpha, p^\\beta)_p (p^\\alpha, v)_p (u, p^\\beta)_p (u, v)_p\n$$\n$$\n= (p,p)_p^{\\alpha\\beta} (p,v)_p^{\\alpha} (u,p)_p^{\\beta} (u,v)_p\n$$\n由于 Hilbert 符号的取值在 $\\{\\pm 1\\}$ 中，所有指数都可以看作是模 $2$ 的。因此，计算分解为对各个组成符号求值，这取决于 $p$ 是奇素数还是 $p=2$。\n\n**情况 1：$p$ 是奇素数**\n\n对于奇素数 $p$，组成符号的值由标准公式给出，其合理性依赖于 Hensel 引理，该引理允许我们将解从剩余域 $\\mathbb{F}_p$ 提升到 $\\mathbb{Z}_p$。\n\n1.  对于任意两个 $p$-进单位 $u, v \\in \\mathbb{Z}_p^\\times$，有 $(u,v)_p = 1$。这是因为二次型 $z^2 - \\bar{u}x^2 - \\bar{v}y^2$ 在 $\\mathbb{F}_p$ 中有一个非平凡零点（根据 Chevalley-Warning 定理），这个零点可以被提升到 $\\mathbb{Z}_p$ 中的一个非平凡解。\n\n2.  对于一个单位 $u \\in \\mathbb{Z}_p^\\times$，有 $(p,u)_p = \\left(\\frac{u}{p}\\right)$，其中 $\\left(\\frac{\\cdot}{p}\\right)$ 是 Legendre 符号。该值仅取决于 $u$ 模 $p$ 的剩余类，记为 $\\bar{u}$。Euler 准则表明 $\\left(\\frac{\\bar{u}}{p}\\right) \\equiv \\bar{u}^{(p-1)/2} \\pmod p$。\n\n3.  符号 $(p,p)_p$ 可以与另一个已知符号相关联。对于任何 $c \\in \\mathbb{Q}_p^\\times$，我们有恒等式 $(c, -c)_p = 1$。因此 $(p, -p)_p = 1$。根据双线性，$(p,p)_p (p,-1)_p = 1$，这意味着 $(p,p)_p = (p,-1)_p$。使用上一条规则，$(p,-1)_p = \\left(\\frac{-1}{p}\\right)$。一个标准结果是 $\\left(\\frac{-1}{p}\\right) = (-1)^{(p-1)/2}$。\n\n结合这些结果，对于奇素数 $p$ 的公式变为：\n$$\n(a,b)_p = \\left(\\left(\\frac{-1}{p}\\right)\\right)^{\\alpha\\beta} \\left(\\left(\\frac{v}{p}\\right)\\right)^{\\alpha} \\left(\\left(\\frac{u}{p}\\right)\\right)^{\\beta} (1)\n$$\n其中所有指数实际上都是模 $2$ 的。将此式写成 $(-1)$ 的指数形式：\n$$\n(a,b)_p = (-1)^{\\alpha\\beta \\frac{p-1}{2}} \\left(\\frac{\\bar{u}}{p}\\right)^{\\beta} \\left(\\frac{\\bar{v}}{p}\\right)^{\\alpha}\n$$\n对于有理单位 $u=u_n/u_d$ 和 $v=v_n/v_d$，其剩余 $\\bar{u}$ 和 $\\bar{v}$ 可按模 $p$ 计算为 $\\bar{u} \\equiv u_n (u_d^{p-2}) \\pmod p$，对 $v$ 也类似。\n\n**情况 2：$p=2$**\n\n域 $\\mathbb{Q}_2$ 需要单独处理，因为 Hensel 引理需要从 $k>1$ 的剩余环 $\\mathbb{Z}/2^k\\mathbb{Z}$ 进行提升。符号值取决于单位模 $4$ 或 $8$ 的剩余类。\n\n1.  对于单位 $u, v \\in \\mathbb{Z}_2^\\times$：$(u,v)_2 = (-1)^{\\frac{u-1}{2}\\frac{v-1}{2}}$。此值由 $u, v$ 模 $4$ 的剩余类确定。我们定义 $\\epsilon(x) = \\frac{x-1}{2} \\pmod 2$。那么 $(u,v)_2 = (-1)^{\\epsilon(u)\\epsilon(v)}$。\n\n2.  对于一个单位 $u \\in \\mathbb{Z}_2^\\times$：$(2,u)_2 = (-1)^{\\frac{u^2-1}{8}}$。此值由 $u$ 模 $8$ 的剩余类确定。我们定义 $\\omega(x) = \\frac{x^2-1}{8} \\pmod 2$。那么 $(2,u)_2 = (-1)^{\\omega(u)}$。\n\n3.  符号 $(2,2)_2 = 1$。这是因为方程 $z^2 = 2x^2 + 2y^2$ 有一个整数解 $(x,y,z)=(1,1,2)$，它同时也是 $\\mathbb{Q}_2$ 中的一个解。\n\n对于 $a=2^\\alpha u$ 和 $b=2^\\beta v$，结合以上结果：\n$$\n(a,b)_2 = (2,2)_2^{\\alpha\\beta} (2,v)_2^{\\alpha} (2,u)_2^{\\beta} (u,v)_2\n$$\n$$\n= (1)^{\\alpha\\beta} ((-1)^{\\omega(v)})^{\\alpha} ((-1)^{\\omega(u)})^{\\beta} ((-1)^{\\epsilon(u)\\epsilon(v)})\n$$\n这给出了 $p=2$ 时的最终公式：\n$$\n(a,b)_2 = (-1)^{\\alpha \\cdot \\omega(v) + \\beta \\cdot \\omega(u) + \\epsilon(u)\\epsilon(v)}\n$$\n对于一个有理单位 $x=x_n/x_d$，其模 $k \\in \\{4,8\\}$ 的剩余类由 $x_n \\cdot x_d^{-1} \\pmod k$ 给出。由于 $x_d$ 是奇数，它模 $4$ 或 $8$ 的逆元是 $x_d$ 本身，因为对于任何奇数 $d$，都有 $d^2 \\equiv 1 \\pmod 8$。因此，$x \\equiv x_n x_d \\pmod k$。\n\n实现将遵循这些公式，使用精确有理数算术来正确确定赋值和单位部分。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import special\nfrom fractions import Fraction\n\ndef v_p_int(n, p):\n    \"\"\"Computes the p-adic valuation of an integer n.\"\"\"\n    if n == 0:\n        # According to the problem, inputs are in Q_p^x, so numerators and\n        # denominators of the original fractions are non-zero.\n        # This case won't be hit with valid inputs.\n        return float('inf')\n    \n    n_abs = abs(n)\n    if n_abs == 1:\n        return 0\n    \n    count = 0\n    while n_abs > 0 and n_abs % p == 0:\n        count += 1\n        n_abs //= p\n    return count\n\ndef v_p(frac, p):\n    \"\"\"Computes the p-adic valuation of a rational number.\"\"\"\n    if frac == 0:\n        return float('inf')\n    return v_p_int(frac.numerator, p) - v_p_int(frac.denominator, p)\n\ndef legendre_symbol(a, p):\n    \"\"\"Computes the Legendre symbol (a/p) using Euler's criterion.\"\"\"\n    if a % p == 0:\n        return 0\n    ls = pow(a, (p - 1) // 2, p)\n    if ls == p - 1:\n        return -1\n    return 1\n\ndef hilbert_symbol(a_frac, b_frac, p):\n    \"\"\"Computes the Hilbert symbol (a,b)_p.\"\"\"\n    alpha = v_p(a_frac, p)\n    beta = v_p(b_frac, p)\n\n    u = a_frac / Fraction(p)**alpha\n    v = b_frac / Fraction(p)**beta\n\n    if p != 2:\n        # Case p is an odd prime\n        u_mod_p = (u.numerator * pow(u.denominator, p - 2, p)) % p\n        v_mod_p = (v.numerator * pow(v.denominator, p - 2, p)) % p\n\n        term1 = pow(-1, (alpha * beta * (p - 1) // 2))\n        term2 = pow(legendre_symbol(u_mod_p, p), beta)\n        term3 = pow(legendre_symbol(v_mod_p, p), alpha)\n        \n        return int(term1 * term2 * term3)\n    else: # p == 2\n        \n        # Helper to get residue mod k for a 2-adic unit rational\n        def get_residue(frac, k):\n            # for a 2-adic unit x = n/d, x mod k is (n * d_inv) mod k.\n            # for k=4 or 8, d_inv is d itself since d^2=1 mod 8 for odd d.\n            return (frac.numerator * frac.denominator) % k\n        \n        u_mod4 = get_residue(u, 4)\n        v_mod4 = get_residue(v, 4)\n        u_mod8 = get_residue(u, 8)\n        v_mod8 = get_residue(v, 8)\n\n        # epsilon(x) = (x-1)/2 mod 2\n        eps_u = ((u_mod4 - 1) // 2) % 2\n        eps_v = ((v_mod4 - 1) // 2) % 2\n        \n        # omega(x) = (x^2-1)/8 mod 2\n        om_u = ((u_mod8**2 - 1) // 8) % 2\n        om_v = ((v_mod8**2 - 1) // 8) % 2\n        \n        exponent = (alpha * om_v + beta * om_u + eps_u * eps_v) % 2\n        \n        return 1 if exponent == 0 else -1\n\ndef solve():\n    \"\"\"\n    Main function to run test cases and print results.\n    \"\"\"\n    test_cases = [\n        # (p, a_num, a_den, b_num, b_den)\n        (3, 3, 1, 3, 1),      # Case 1\n        (5, 5, 1, 5, 1),      # Case 2\n        (7, 2, 1, 7, 1),      # Case 3\n        (7, 3, 1, 7, 1),      # Case 4\n        (3, 2, 1, 2, 1),      # Case 5\n        (2, -1, 1, -1, 1),    # Case 6\n        (2, 2, 1, 2, 1),      # Case 7\n        (2, -1, 1, 2, 1),     # Case 8\n        (2, 3, 1, 3, 1),      # Case 9\n        (5, 1, 5, 5, 1),      # Case 10\n        (3, 2, 3, 6, 1),      # Case 11\n        (2, 3, 5, 7, 9),      # Case 12\n    ]\n\n    results = []\n    for p, a_num, a_den, b_num, b_den in test_cases:\n        a = Fraction(a_num, a_den)\n        b = Fraction(b_num, b_den)\n        result = hilbert_symbol(a, b, p)\n        results.append(str(result))\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n\n```", "id": "3026921"}]}