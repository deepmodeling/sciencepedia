{"hands_on_practices": [{"introduction": "本练习是基础功的演练。我们将从剖析一个复杂的公式开始，精确地区分哪些变量是自由的，哪些是受量词约束的。随后，我们将执行一次“捕获避免代换”，这是理解证明系统和逻辑等价性的核心技能。此练习将磨练你对支配逻辑意义的句法细节的敏锐度。[@problem_id:2988595]", "problem": "本题在一阶逻辑 (FOL) 框架下进行，其标号包含一个二元谓词符号 $R$，一个一元函数符号 $f$，并且没有常量符号。变量取自一个可数集合，该集合包含 $x$、$y$、$z$ 和 $w$。回顾基本句法定义：量词 $\\forall v$ 或 $\\exists v$ 约束其辖域内变量 $v$ 的每一次出现；如果一个变量的出现不在任何约束它的量词的辖域内，则称其为自由出现；量词的辖域是紧随其后的公式。使用标准的避免捕获的替换：对于项 $t$ 和变量 $v$，替换操作 $\\varphi[v := t]$ 会将 $\\varphi$ 中 $v$ 的所有自由出现替换为 $t$，并且如果某个量词约束了一个在 $t$ 中自由出现的变量，则在执行替换之前，将该约束变量重命名为一个新鲜变量，以避免变量捕获。\n\n考虑下述构造的公式：\n$$\n\\varphi \\;=\\; \\big(R(x,y) \\;\\land\\; \\forall x \\,\\big(R(x,z) \\;\\lor\\; \\exists y \\, R(y,x)\\big)\\big)\\;\\;\\lor\\;\\; \\forall z \\,\\big(R(f(y),z) \\;\\land\\; \\exists x \\, R(z,x)\\big).\n$$\n在 $\\varphi$ 中，变量 $x$ 在公式的不同部分既作为自由变量出现，也作为约束变量出现。请根据公式中量词的辖域，解释 $x$ 的哪些出现是自由的，哪些是约束的，并说明为什么这些出现被各自的量词辖域所分隔。\n\n然后，计算执行避免捕获的替换 $\\varphi[y := f(x)]$ 的结果，其中任何必要的约束变量重命名都必须使用新鲜变量 $w$。完成此替换后，确定结果公式中 $x$ 的自由出现次数。请以单个整数形式提供您的答案。无需四舍五入。", "solution": "该问题陈述清晰，且基于一阶逻辑的标准原理。所有术语、定义和公式均已给出，因此可以得出一个严谨且唯一的解。\n\n该问题包含三个部分：\n1.  分析给定公式 $\\varphi$ 中变量 $x$ 的出现，以确定哪些是自由的，哪些是约束的。\n2.  计算避免捕获的替换 $\\varphi[y := f(x)]$ 的结果。\n3.  计算结果公式中变量 $x$ 的自由出现次数。\n\n设给定公式为\n$$\n\\varphi \\;=\\; \\big(R(x,y) \\;\\land\\; \\forall x \\,\\big(R(x,z) \\;\\lor\\; \\exists y \\, R(y,x)\\big)\\big)\\;\\;\\lor\\;\\; \\forall z \\,\\big(R(f(y),z) \\;\\land\\; \\exists x \\, R(z,x)\\big).\n$$\n\n**第一部分：分析 $\\varphi$ 中 $x$ 的自由和约束出现**\n\n要确定一个变量的出现是自由的还是约束的，我们必须识别量词及其辖域。如果一个出现位于约束该变量的量词的辖域内，则该出现是约束的。否则，它是自由的。\n\n公式 $\\varphi$ 是一个析取式 $\\psi_1 \\lor \\psi_2$，其中：\n- $\\psi_1 = R(x,y) \\;\\land\\; \\forall x \\,\\big(R(x,z) \\;\\lor\\; \\exists y \\, R(y,x)\\big)$\n- $\\psi_2 = \\forall z \\,\\big(R(f(y),z) \\;\\land\\; \\exists x \\, R(z,x)\\big)$\n\n我们来分析 $x$ 的出现情况：\n1.  $x$ 的第一次出现是在原子公式 $R(x,y)$ 中。该子公式是一个合取式的一部分，其中另一个合取项是 $\\forall x (\\dots)$。这个量词 $\\forall x$ 的辖域是子公式 $\\big(R(x,z) \\;\\lor\\; \\exists y \\, R(y,x)\\big)$。初始的 $R(x,y)$ 在此辖域之外。没有其他量词约束这个 $x$。因此，$x$ 的这次出现是**自由的**。\n\n2.  第二次出现是量词 $\\forall x$ 本身。\n\n3.  第三次出现是在 $R(x,z)$ 中。它位于量词 $\\forall x$ 的辖域内。因此，$x$ 的这次出现是**约束的**。\n\n4.  第四次出现是在 $R(y,x)$ 中，它在 $\\exists y$ 的辖域内。而整个子公式 $\\exists y \\, R(y,x)$ 又在 $\\forall x$ 的辖域内。约束一个变量的量词是包含它在其辖域内的最内层量词。在这里，它被 $\\forall x$ 约束。因此，$x$ 的这次出现是**约束的**。\n\n5.  第五次出现是 $\\psi_2$ 中的量词 $\\exists x$。\n\n6.  第六次出现是在 $\\psi_2$ 的 $R(z,x)$ 中。它位于量词 $\\exists x$ 的辖域内。因此，$x$ 的这次出现是**约束的**。\n\n总之，变量 $x$ 在 $\\varphi$ 中有一次自由出现（在项 $R(x,y)$ 中）和多次约束出现，这与问题陈述一致。\n\n**第二部分：计算替换 $\\varphi[y := f(x)]$**\n\n要进行的替换是 $\\varphi[y := f(x)]$。被替换的变量是 $y$，用于替换的项是 $t = f(x)$。项 $t$ 中的自由变量集合是 $FV(t) = \\{x\\}$。\n\n问题为避免捕获的替换提供了一条具体规则：“如果某个量词约束了一个在 $t$ 中自由出现的变量，则在执行替换之前，将该约束变量重命名为一个新鲜变量”。\n\n我们应用此规则：\n1.  在 $\\varphi$ 中找出约束了来自 $FV(t)=\\{x\\}$ 中变量的量词。它们是 $\\psi_1$ 中的量词 $\\forall x$ 和 $\\psi_2$ 中的量词 $\\exists x$。\n2.  根据规则，这些约束变量必须被重命名。问题指定使用新鲜变量 $w$。\n\n此重命名步骤在对 $y$ 进行替换*之前*在 $\\varphi$ 上执行。我们称重命名后的公式为 $\\varphi_{\\text{renamed}}$：\n$$\n\\varphi_{\\text{renamed}} = \\big(R(x,y) \\;\\land\\; \\forall w \\,\\big(R(w,z) \\;\\lor\\; \\exists y \\, R(y,w)\\big)\\big)\\;\\;\\lor\\;\\; \\forall z \\,\\big(R(f(y),z) \\;\\land\\; \\exists w \\, R(z,w)\\big).\n$$\n\n现在，我们在 $\\varphi_{\\text{renamed}}$ 上执行替换 $[y := f(x)]$。这涉及将 $y$ 的所有*自由*出现替换为项 $f(x)$。在 $\\varphi$ 中（因此也在 $\\varphi_{\\text{renamed}}$ 中）$y$ 的自由出现是：\n- 在原子公式 $R(x,y)$ 中。\n- 在原子公式 $R(f(y),z)$ 中。\n\n执行替换：\n- $R(x,y)$ 变为 $R(x,f(x))$。\n- $R(f(y),z)$ 变为 $R(f(f(x)),z)$。\n\n将这些替换回 $\\varphi_{\\text{renamed}}$，我们得到最终的结果公式，我们称之为 $\\varphi'$：\n$$\n\\varphi' = \\big(R(x,f(x)) \\;\\land\\; \\forall w \\,\\big(R(w,z) \\;\\lor\\; \\exists y \\, R(y,w)\\big)\\big)\\;\\;\\lor\\;\\; \\forall z \\,\\big(R(f(f(x)),z) \\;\\land\\; \\exists w \\, R(z,w)\\big).\n$$\n\n**第三部分：计算结果公式中 $x$ 的自由出现次数**\n\n现在我们必须找出公式 $\\varphi'$ 中变量 $x$ 的自由出现次数。我们来分析其结构 $\\varphi' = \\varphi'_1 \\lor \\varphi'_2$。\n\n- 对 $\\varphi'_1 = R(x,f(x)) \\;\\land\\; \\forall w \\,\\big(R(w,z) \\;\\lor\\; \\exists y \\, R(y,w)\\big)$ 的分析：\n    - 在子公式 $R(x,f(x))$ 中，第一个参数是 $x$。$x$ 的这次出现不在任何约束 $x$ 的量词的辖域内。它是**自由的**。\n    - 第二个参数是 $f(x)$。该项内 $x$ 的出现也不在任何约束 $x$ 的量词的辖域内。它是**自由的**。\n    - $\\varphi'_1$ 的其余部分是子公式 $\\forall w (\\dots)$，其中不包含变量 $x$。\n    - 因此，在 $\\varphi'_1$ 中有 $2$ 次 $x$ 的自由出现。\n\n- 对 $\\varphi'_2 = \\forall z \\,\\big(R(f(f(x)),z) \\;\\land\\; \\exists w \\, R(z,w)\\big)$ 的分析：\n    - 主要量词是 $\\forall z$。\n    - 在其辖域内，我们有合取项 $R(f(f(x)),z)$。变量 $x$ 出现一次，在项 $f(f(x))$ 内部。这次出现不在量词 $\\exists w$ 的辖域内，也没有被 $\\forall z$ 约束（因为 $x \\ne z$）。因此，$x$ 的这次出现是**自由的**。\n    - 另一个合取项 $\\exists w \\, R(z,w)$ 不包含变量 $x$。\n    - 因此，在 $\\varphi'_2$ 中有 $1$ 次 $x$ 的自由出现。\n\n$\\varphi'$ 中 $x$ 的总自由出现次数是 $\\varphi'_1$ 和 $\\varphi'_2$ 中次数的总和。\n总次数 = $2 + 1 = 3$。\n\n结果公式中 $x$ 的自由出现次数为 $3$。", "answer": "$$\n\\boxed{3}\n$$", "id": "2988595"}, {"introduction": "掌握了机械操作后，让我们来探究其背后的原因——为什么规则如此严格。本题将展示，当忽略捕获避免代换的规则时，逻辑会如何出错。通过构造一个具体的反例，让一条标准的逻辑定律失效，你将更深刻地体会到这些规则在变换中保持公式原意的关键作用。[@problem_id:2988600]", "problem": "考虑一阶逻辑（FOL），其变量的取值范围为一个非空论域。令 $\\mathrm{FV}(t)$ 表示项 $t$ 的自由变量集合，令 $\\varphi[x := t]$ 表示在公式 $\\varphi$ 中，将变量 $x$ 的所有自由出现都替换为项 $t$ 的避免捕获的代换。该代换通过结构递归常规定义，并使用 $\\alpha$-转换重命名约束变量以避免变量捕获。一条标准的交换律陈述如下：如果 $y \\neq x$ 且 $y \\notin \\mathrm{FV}(t)$，则 $(\\forall y\\,\\varphi)[x := t]$ 等价于 $\\forall y\\,(\\varphi[x := t])$。请仅使用一阶逻辑的基本语义（量词和等词的 Tarski 语义）以及带有 $\\alpha$-转换的避免捕获代换的定义，在一个只含等词且论域为自然数的语言中，说明当 $y \\in \\mathrm{FV}(t)$ 时该定律为何失效。\n\n具体地，设语言为 $\\mathcal{L} = \\{=\\}$，结构为 $\\mathcal{M} = (\\mathbb{N}, =)$，其中等词被解释为 $\\mathbb{N}$ 上的实际相等关系。设赋值 $g$ 将变量 $y$ 映射到 $0$（除非另有说明，否则 $g$ 下其他变量的值是无关紧要的）。令 $\\varphi$ 为公式 $x = y$，令 $t$ 为项 $y$。注意 $y \\in \\mathrm{FV}(t)$。定义以下两个公式：\n- 左侧公式使用带有 $\\alpha$-转换的避免捕获代换：$((\\forall y\\,\\varphi)[x := t])$。\n- 右侧公式使用直接的内层代换：$(\\forall y\\,(\\varphi[x := t]))$。\n\n请使用标准语义计算这两个公式在结构 $\\mathcal{M}$ 和赋值 $g$ 下的真值，将真编码为 $1$，假编码为 $0$，然后计算数值差 $V_{\\mathrm{RHS}} - V_{\\mathrm{LHS}}$，其中 $V_{\\mathrm{RHS}}$ 和 $V_{\\mathrm{LHS}}$ 分别是右侧和左侧公式的编码真值。请将你的最终答案以单个实数的形式给出。无需四舍五入。", "solution": "该问题要求我们分析在不满足变量新鲜性条件时，代换与全称量化交换律的失效情况。我们需要在一个特定模型中计算两个公式的真值，然后求出其编码值的数值差。\n\n设语言为 $\\mathcal{L} = \\{=\\}$，结构为 $\\mathcal{M} = (\\mathbb{N}, =)$，其论域为自然数 $\\mathbb{N}=\\{0, 1, 2, \\dots\\}$，等号符号解释为 $\\mathbb{N}$ 上的恒等关系。变量赋值 $g$ 满足 $g(y) = 0$。公式 $\\varphi$ 为 $x = y$，项 $t$ 为 $y$。我们要用 $t$ 代换 $x$。被检验的交换律是 $(\\forall y\\,\\varphi)[x := t] \\equiv \\forall y\\,(\\varphi[x := t])$，它在 $y \\notin \\mathrm{FV}(t)$ 时成立。此处，$t$ 是 $y$，所以 $\\mathrm{FV}(t) = \\mathrm{FV}(y) = \\{y\\}$。条件 $y \\notin \\mathrm{FV}(t)$ 未被满足，因为 $y \\in \\{y\\}$。\n\n我们将按照问题中的定义，评估左侧（LHS）和右侧（RHS）公式的真值。真编码为 $1$，假编码为 $0$。\n\n**1. 左侧（LHS）公式的求值**\n\nLHS 公式定义为 $((\\forall y\\,\\varphi)[x := t])$，这意味着我们必须应用避免捕获的代换。\n具体公式为 $(\\forall y\\,(x=y))[x := y]$。\n在公式 $\\forall y\\,(x=y)$ 中，变量 $x$ 是自由的。代换 $[x := y]$ 试图将这个自由的 $x$ 替换为 $y$。然而，这会将新的 $y$ 置于量词 $\\forall y$ 的作用域内，导致被代换的变量被“捕获”。\n\n避免捕获的代换要求重命名约束变量以避免这种捕获。我们对 $\\forall y\\,(x=y)$ 进行 $\\alpha$-转换。我们选择一个新变量 $z$（$z$ 不同于 $x$ 和 $y$），并将约束变量 $y$ 重命名为 $z$。\n公式 $\\forall y\\,(x=y)$ 逻辑等价于 $\\forall z\\,((x=y)[y:=z])$，即 $\\forall z\\,(x=z)$。\n\n现在，我们可以安全地对经过 $\\alpha$-转换的公式 $\\forall z\\,(x=z)$ 执行代换 $[x := y]$：\n$$ (\\forall z\\,(x=z))[x := y] $$\n由于量词的变量 $z$ 在项 $y$ 中不是自由的（即 $z \\notin \\mathrm{FV}(y)$），我们可以将代换移入量词内部：\n$$ \\forall z\\,((x=z)[x := y]) $$\n这得到公式：\n$$ \\forall z\\,(y=z) $$\n我们称其为 LHS 公式，$\\varphi_{\\mathrm{LHS}}$。现在我们确定它在结构 $\\mathcal{M}$ 和赋值 $g$ 下的真值。\n陈述 $\\mathcal{M}, g \\models \\forall z\\,(y=z)$ 为真，当且仅当对于每一个元素 $d \\in \\mathbb{N}$，陈述 $\\mathcal{M}, g[z \\mapsto d] \\models y=z$ 为真。\n这里，$g[z \\mapsto d]$ 是将 $z$ 映射到 $d$ 并将任何其他变量 $v \\neq z$ 映射到 $g(v)$ 的赋值。\n在赋值 $g[z \\mapsto d]$ 下，项 $y$ 的值为 $g[z \\mapsto d](y) = g(y) = 0$。项 $z$ 的值为 $g[z \\mapsto d](z) = d$。\n因此，条件变为：对于任意 $d \\in \\mathbb{N}$，等式 $0 = d$ 必须成立。\n这是假的。例如，如果我们选择 $d=1$，那么 $0=1$ 是假的。全称量化失败。\n因此，LHS 公式 $\\varphi_{\\mathrm{LHS}}$ 在 $\\mathcal{M}$ 和 $g$ 下为假。\n其编码真值为 $V_{\\mathrm{LHS}} = 0$。\n\n**2. 右侧（RHS）公式的求值**\n\nRHS 公式定义为 $(\\forall y\\,(\\varphi[x := t]))$，这意味着我们先对内层公式 $\\varphi$ 进行代换，然后再应用量词。\n具体公式是 $\\forall y\\,((x=y)[x := y])$。\n首先，我们计算内层代换 $(x=y)[x := y]$。这意味着我们将 $x=y$ 中所有 $x$ 的自由出现替换为项 $y$。结果是公式 $y=y$。\n接下来，我们对这个结果应用全称量词 $\\forall y$。\n因此，RHS 公式 $\\varphi_{\\mathrm{RHS}}$ 是：\n$$ \\forall y\\,(y=y) $$\n我们现在确定这个公式在 $\\mathcal{M}$ 和 $g$ 下的真值。\n陈述 $\\mathcal{M}, g \\models \\forall y\\,(y=y)$ 为真，当且仅当对于每一个元素 $d \\in \\mathbb{N}$，陈述 $\\mathcal{M}, g[y \\mapsto d] \\models y=y$ 为真。\n在赋值 $g[y \\mapsto d]$ 下，项 $y$ 的值为 $g[y \\mapsto d](y) = d$。\n因此，条件变为：对于任意 $d \\in \\mathbb{N}$，等式 $d = d$ 必须成立。\n这是真的，因为等价关系是自反关系。该陈述对所有 $d \\in \\mathbb{N}$ 均成立。\n因此，RHS 公式 $\\varphi_{\\mathrm{RHS}}$ 在 $\\mathcal{M}$ 和 $g$ 下为真。\n其编码真值为 $V_{\\mathrm{RHS}} = 1$。\n\n**3. 最终计算**\n\n问题要求计算数值差 $V_{\\mathrm{RHS}} - V_{\\mathrm{LHS}}$。\n使用我们计算出的值：\n- $V_{\\mathrm{LHS}} = 0$\n- $V_{\\mathrm{RHS}} = 1$\n\n差值为 $V_{\\mathrm{RHS}} - V_{\\mathrm{LHS}} = 1 - 0 = 1$。\n\n这个例子表明，当一个代换引入的变量被量词捕获时，在量词内部执行一个朴素的代换（RHS）可能导致与正确定义的避免捕获代换（LHS）不同的语义。当 $y \\in \\mathrm{FV}(t)$ 时，交换律 $(\\forall y\\,\\varphi)[x := t] \\equiv \\forall y\\,(\\varphi[x := t])$ 失效。", "answer": "$$\n\\boxed{1}\n$$", "id": "2988600"}, {"introduction": "最后的练习将从分析转向综合。你不再仅仅是应用规则，而是要发展一个系统化的程序（一个算法），来判定变量捕获在何处可能发生，以及需要多少次重命名来避免它。这个练习将直观的检查转化为一个形式化的、可重复的过程，这是计算逻辑中的关键一步，从而巩固你的理解。[@problem_id:2988630]", "problem": "设所用形式体系为标准一阶逻辑（First-Order Logic, FOL），其具有词项和公式的常规语法，以及自由变量、约束变量和量词作用域的标准概念。如果将公式 $\\varphi$ 中 $x$ 的每个自由出现都替换为词项 $t$ 后，$t$ 的自由变量没有被 $\\varphi$ 中已有的任何量词所约束，则称代换 $[x := t]$ 对公式 $\\varphi$ 是无捕获的。$\\alpha$-重命名是指在其约束量词的整个作用域内，将一个约束变量一致地替换为一个新鲜变量。\n\n任务：\n1) 仅从自由和约束变量、量词作用域以及一阶逻辑中语法代换的标准定义出发，推导一个判定过程。该过程对于给定的公式 $\\varphi$、变量 $x$ 和词项 $t$，仅通过检查 $\\varphi$ 中量词的作用域和 $t$ 的自由变量，来判定代换 $[x := t]$ 是否是无捕获的。您的过程必须精确地识别出是哪些特定的约束变量出现（即约束量词）导致了潜在的捕获，并且必须确定使代换变为无捕获所需的最少约束变量 $\\alpha$-重命名次数。您可以假定，在重命名时，总是有可用的、且不出现在 $\\varphi$ 或 $t$ 中的新鲜变量名。\n\n2) 将您的过程应用于下面的具体实例，并计算使该代换变为无捕获所需的最少不同约束变量的 $\\alpha$-重命名次数。\n\n给定一个包含函数符号 $f$ 和谓词符号 $A, P, Q, R, S, T, U$ 的符号集，定义公式\n$$\n\\varphi \\equiv \\bigl(\\forall y\\,\\bigl(A(y) \\rightarrow \\bigl(P(x,y)\\ \\wedge\\ \\exists z\\,\\bigl(Q(y,z)\\ \\wedge\\ R(x,z)\\bigr)\\bigr)\\bigr)\\bigr)\\ \\wedge\\ \\bigl(\\exists y\\,\\bigl(S(y)\\ \\vee\\ \\forall z\\,\\bigl(T(x,z,y)\\ \\wedge\\ \\exists w\\,U(w,y,x)\\bigr)\\bigr)\\bigr).\n$$\n设词项为\n$$\nt \\equiv f(y,w,v).\n$$\n考虑将 $[x := t]$ 代换到 $\\varphi$ 中。确定需要多少次最少的不同约束变量的 $\\alpha$-重命名，才能将 $\\varphi$ 转换为一个 $\\alpha$-等价的公式 $\\psi$，使得代换 $[x := t]$ 对于 $\\psi$ 是无捕获的。请用一个整数表达您的最终答案。无需四舍五入。", "solution": "这个问题在数理逻辑领域内是良定的且有科学依据。它要求推导出一个用于安全代换的判定过程，并将其应用于一个具体案例。我们将首先推导该过程，然后应用它。\n\n设 $\\varphi$ 为一阶逻辑中的一个公式，$x$ 为一个变量，$t$ 为一个词项。将 $t$ 代换 $\\varphi$ 中的 $x$，记作 $\\varphi[x := t]$，是指将 $\\varphi$ 中 $x$ 的每个自由出现都替换为词项 $t$ 后得到的公式。\n\n如果一个变量 $v$ 在一个词项或公式中没有被任何量词（$\\forall$ 或 $\\exists$）约束，则称它在该词项或公式中是自由的。令 $FV(\\tau)$ 表示表达式 $\\tau$（可以是词项或公式）中的自由变量集合。\n\n如果对于 $FV(t)$ 中的每个变量 $v$，在 $\\varphi[x := t]$ 中，任何被插入的 $t$ 实例中的 $v$ 的自由出现都没有变成约束出现，则称代换 $[x := t]$ 对 $\\varphi$ 是无捕获的。如果 $v$ 的一个出现落入量词 $\\forall v$ 或 $\\exists v$ 的作用域内，它就变成被约束的。\n\n这就引出了变量捕获的形式化条件：当且仅当存在一个变量 $v \\in FV(t)$ 并且 $\\varphi$ 中 $x$ 的一个自由出现位于约束 $v$ 的量词的作用域内时，捕获就会发生。也就是说，$\\varphi$ 包含形如 $\\forall v \\, \\psi$ 或 $\\exists v \\, \\psi$ 的子公式，使得 $x$ 在 $\\psi$ 中有自由出现。\n\n为避免捕获，我们必须对任何此类有问题的量词执行 $\\alpha$-重命名。例如，对 $\\forall v \\, \\psi$ 进行 $\\alpha$-重命名，需要选择一个新鲜变量 $v'$（一个在 $\\psi$ 或 $t$ 中不自由的变量），并将该子公式替换为 $\\forall v' \\, \\psi[v := v']$。此修改使得将 $t$ 代换入 $\\psi[v := v']$ 对于变量 $v$ 是安全的。\n\n需要一个最小的重命名集合。对量词 $\\forall v$ 或 $\\exists v$ 进行单次 $\\alpha$-重命名，可以解决其作用域内所有 $x$ 自由出现引起的捕获冲突。由于公式抽象语法树中的不同量词对应于不同的作用域，每个导致捕获的量词都必须独立重命名。因此，最少的重命名次数恰好是满足捕获条件的量词的数目。\n\n这得出了以下判定过程：\n\n1.  **识别词项的自由变量**：计算词项 $t$ 中的自由变量集合。令其为 $V_t = FV(t)$。\n2.  **识别量词及其作用域**：遍历公式 $\\varphi$ 并识别其所有不同的量化子公式。对于每个第 $i$ 个量词，记录其约束变量 $y_i$ 及其作用域 $\\psi_i$。量化子公式是形如 $\\forall y_i \\, \\psi_i$ 或 $\\exists y_i \\, \\psi_i$ 的表达式。\n3.  **检查捕获条件**：对于每个量词 $i$，当且仅当以下两个条件同时成立时，会发生捕获：\n    a) 约束变量 $y_i$是词项 $t$ 中的一个自由变量，即 $y_i \\in V_t$。\n    b) 待代换的变量 $x$ 在该量词的作用域 $\\psi_i$ 内至少有一个自由出现。\n4.  **计算必要的重命名次数**：最少的 $\\alpha$-重命名次数是满足步骤3中两个条件的量词总数。\n\n我们现在将此过程应用于给定的实例。\n\n公式为：\n$$\n\\varphi \\equiv \\bigl(\\forall y\\,\\bigl(A(y) \\rightarrow \\bigl(P(x,y)\\ \\wedge\\ \\exists z\\,\\bigl(Q(y,z)\\ \\wedge\\ R(x,z)\\bigr)\\bigr)\\bigr)\\bigr)\\ \\wedge\\ \\bigl(\\exists y\\,\\bigl(S(y)\\ \\vee\\ \\forall z\\,\\bigl(T(x,z,y)\\ \\wedge\\ \\exists w\\,U(w,y,x)\\bigr)\\bigr)\\bigr)\n$$\n代换为 $[x := t]$，其中词项为：\n$$\nt \\equiv f(y,w,v)\n$$\n\n**步骤1：识别词项的自由变量**\n$t \\equiv f(y,w,v)$ 的自由变量是出现在其中的变量。因此，$V_t = FV(t) = \\{y, w, v\\}$。\n\n**步骤2：识别量词及其作用域**\n我们在 $\\varphi$ 中识别出五个不同的量词：\n- $Q_1$：第一个合取项中的 $\\forall y$。其作用域为 $\\psi_1 \\equiv A(y) \\rightarrow \\bigl(P(x,y)\\ \\wedge\\ \\exists z\\,\\bigl(Q(y,z)\\ \\wedge\\ R(x,z)\\bigr)\\bigr)$。\n- $Q_2$：$\\psi_1$ 中的 $\\exists z$。其作用域为 $\\psi_2 \\equiv Q(y,z)\\ \\wedge\\ R(x,z)$。\n- $Q_3$：第二个合取项中的 $\\exists y$。其作用域为 $\\psi_3 \\equiv S(y)\\ \\vee\\ \\forall z\\,\\bigl(T(x,z,y)\\ \\wedge\\ \\exists w\\,U(w,y,x)\\bigr)$。\n- $Q_4$：$\\psi_3$ 中的 $\\forall z$。其作用域为 $\\psi_4 \\equiv T(x,z,y)\\ \\wedge\\ \\exists w\\,U(w,y,x)$。\n- $Q_5$：$\\psi_4$ 中的 $\\exists w$。其作用域为 $\\psi_5 \\equiv U(w,y,x)$。\n\n**步骤3：检查捕获条件**\n我们逐一检查每个量词：\n\n- **对于 $Q_1$ ($\\forall y$):**\n  a) 约束变量是 $y$。$y \\in V_t$ 吗？是的，$y \\in \\{y, w, v\\}$。\n  b) $x$ 在 $\\psi_1$ 中是否自由出现？是的，$x$ 在 $P(x,y)$ 和 $R(x,z)$ 中有自由出现，这两者都在 $\\psi_1$ 内部。\n  两个条件都满足。因此，$Q_1$ 导致变量捕获，需要进行 $\\alpha$-重命名。\n\n- **对于 $Q_2$ ($\\exists z$):**\n  a) 约束变量是 $z$。$z \\in V_t$ 吗？不，$z \\notin \\{y, w, v\\}$。\n  第一个条件不满足。$Q_2$ 不会导致捕获。\n\n- **对于 $Q_3$ ($\\exists y$):**\n  a) 约束变量是 $y$。$y \\in V_t$ 吗？是的，$y \\in \\{y, w, v\\}$。\n  b) $x$ 在 $\\psi_3$ 中是否自由出现？是的，$x$ 在 $T(x,z,y)$ 和 $U(w,y,x)$ 中有自由出现，这两者都在 $\\psi_3$ 内部。\n  两个条件都满足。因此，$Q_3$ 导致变量捕获，需要进行 $\\alpha$-重命名。这是一个与 $Q_1$ 不同的量词。\n\n- **对于 $Q_4$ ($\\forall z$):**\n  a) 约束变量是 $z$。$z \\in V_t$ 吗？不，$z \\notin \\{y, w, v\\}$。\n  第一个条件不满足。$Q_4$ 不会导致捕获。\n\n- **对于 $Q_5$ ($\\exists w$):**\n  a) 约束变量是 $w$。$w \\in V_t$ 吗？是的，$w \\in \\{y, w, v\\}$。\n  b) $x$ 在 $\\psi_5$ 中是否自由出现？是的，$x$ 在 $U(w,y,x)$ 中有自由出现。\n  两个条件都满足。因此，$Q_5$ 导致变量捕获，需要进行 $\\alpha$-重命名。\n\n**步骤4：计算必要的重命名次数**\n被识别出导致捕获的量词是 $Q_1$ ($\\forall y$)、$Q_3$ ($\\exists y$) 和 $Q_5$ ($\\exists w$)。这些是公式 $\\varphi$ 中三个不同的量词出现。为了使代换 $[x := t]$ 成为无捕获的，这三个量词都必须进行 $\\alpha$-重命名。\n\n因此，最少的不同约束变量的 $\\alpha$-重命名次数是 $3$。", "answer": "$$\\boxed{3}$$", "id": "2988630"}]}