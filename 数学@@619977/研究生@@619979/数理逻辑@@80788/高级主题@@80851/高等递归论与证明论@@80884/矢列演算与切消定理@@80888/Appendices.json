{"hands_on_practices": [{"introduction": "我们将从一个具体而直接的例子开始，亲手实践切消定理的威力。在这个练习中 [@problem_id:484256]，我们将处理一个包含“切消”规则的、关于蕴含传递律这一基本逻辑重言式的证明。通过手动将其转换为一个无切消证明，我们将直观地观察到证明结构的变化，为理解切消算法的底层机制奠定坚实的基础。", "problem": "在命题逻辑的相继式演算语境中，我们如下定义相继式、公理和推理规则。\n\n相继式是形如 $\\Gamma \\vdash \\Delta$ 的表达式，其中 $\\Gamma$（前件）和 $\\Delta$（后件）是命题公式的有限多重集。公式由原子命题（例如，$A, B, C$）和蕴含连接词（$\\to$）构成。\n\n该演算包含以下规则：\n\n1.  **公理（同一律）**：对于任意公式 $A$，下面的相继式是一条公理。\n    $$A \\vdash A$$\n\n2.  **蕴含右规则**：\n    $$(\\rightarrow R): \\frac{A, \\Gamma \\vdash B, \\Delta}{\\Gamma \\vdash A \\to B, \\Delta}$$\n\n3.  **蕴含左规则**：这是乘法形式。\n    $$(\\rightarrow L): \\frac{\\Gamma \\vdash A, \\Delta \\quad \\Pi, B \\vdash \\Sigma}{\\Gamma, \\Pi, A \\to B \\vdash \\Delta, \\Sigma}$$\n\n4.  **切消规则**：\n    $$(Cut): \\frac{\\Gamma \\vdash A, \\Delta \\quad A, \\Pi \\vdash \\Sigma}{\\Gamma, \\Pi \\vdash \\Delta, \\Sigma}$$\n\n证明树是一个由相继式构成的树，其中每个叶子都是公理（同一律）规则的一个实例，而每个非叶节点（一次推理）都是通过其中一条规则从其子节点（前提）推导出的结论。证明树的叶子被称为“公理叶”。\n\n考虑下面用于证明相继式 $\\vdash (A \\to B) \\to ((B \\to C) \\to (A \\to C))$ 的证明树 $\\mathcal{D}$，该相继式表示了蕴含的传递性。\n\n$$\n\\mathcal{D} =\n\\frac{\n  \\frac{\n    \\frac{\n      \\frac{A \\vdash A \\quad B \\vdash B}{A, A \\to B \\vdash B} (\\rightarrow L) \\quad \\frac{B \\vdash B \\quad C \\vdash C}{B, B \\to C \\vdash C} (\\rightarrow L)\n    }{A, A \\to B, B \\to C \\vdash C} (Cut)\n  }{A \\to B, B \\to C \\vdash A \\to C} (\\rightarrow R)\n}{(A \\to B) \\vdash (B \\to C) \\to (A \\to C)} (\\rightarrow R)\n}{\\vdash (A \\to B) \\to ((B \\to C) \\to (A \\to C))} (\\rightarrow R)\n$$\n\n该证明包含一次对 $(Cut)$ 规则的应用，其切消公式为 $B$。切消消除过程是证明论中的一个核心成果，它展示了如何将任何包含切消的证明转换为一个证明相同终相继式的无切消证明。\n\n对证明 $\\mathcal{D}$ 中唯一的 $(Cut)$ 推理应用标准的切消消除算法。此过程将产生一个新的、无切消的证明树 $\\mathcal{D}'$。你的任务是确定最终得到的证明树 $\\mathcal{D}'$ 中公理叶的总数。", "solution": "我们在推导 \n$$\\vdash (A\\to B)\\to((B\\to C)\\to(A\\to C))$$\n的过程中，消除关于 $B$ 的唯一一个 $(Cut)$。\n关键子证明是\n$$A,\\,A\\to B,\\,B\\to C\\;\\vdash\\;C$$\n它通过对 $B$ 进行切消得到。我们将其替换为一个无切消的推导：\n\n1. 原子公式的同一律公理：\n   $$A\\;\\vdash\\;A\n   \\quad\n   B\\;\\vdash\\;B\n   \\quad\n   C\\;\\vdash\\;C.$$\n\n2. 对 $B\\to C$ 应用 $(\\to L)$ 规则：\n   $$\\frac{B\\vdash B\\quad C\\vdash C}\n         {B,\\,B\\to C\\;\\vdash\\;C}\n     \\;(\\to L).$$\n\n3. 对 $A\\to B$ 应用 $(\\to L)$ 规则：\n   $$\\frac{A\\vdash A\\quad B,\\,B\\to C\\vdash C}\n         {A,\\,B\\to C,\\,A\\to B\\;\\vdash\\;C}\n     \\;(\\to L).$$\n\n4. 重建右蕴含引入：\n   $$\\frac{A,\\,B\\to C,\\,A\\to B\\vdash C}\n         {B\\to C,\\,A\\to B\\vdash A\\to C}\n     \\;(\\to R),$$\n   $$\\frac{B\\to C,\\,A\\to B\\vdash A\\to C}\n         {A\\to B\\;\\vdash\\;(B\\to C)\\to(A\\to C)}\n     \\;(\\to R),$$\n   $$\\frac{A\\to B\\vdash(B\\to C)\\to(A\\to C)}\n         {\\vdash(A\\to B)\\to((B\\to C)\\to(A\\to C))}\n     \\;(\\to R).$$\n\n这个无切消证明恰好有三个公理叶。", "answer": "$$\\boxed{3}$$", "id": "484256"}, {"introduction": "在掌握了命题逻辑中的基本操作后，我们将进入更复杂的一阶逻辑领域，其中量词带来了新的挑战。本练习 [@problem_id:2979668] 聚焦于消除全称量化公式上的切消，这是切消定理通用证明中的一个关键步骤，即“主公式情形”。它要求我们细致地处理本征变元（eigenvariable）和代换，从而磨练处理形式证明时必不可少的技能。", "problem": "考虑 Gentzen 的经典一阶逻辑相继式演算 (LK)，其具有通常的结构规则和全称量词的量词规则。全称量词规则如下：\n$$\n\\frac{\\Gamma \\vdash \\Delta, A(y)}{\\Gamma \\vdash \\Delta, \\forall x\\,A(x)}\\;\\;(\\forall\\text{-}R)\\quad\\text{其中 $y$ 是一个本征变量，不在 $\\Gamma$ 或 $\\Delta$ 中自由出现，}\n$$\n$$\n\\frac{\\Pi, A(t) \\vdash \\Lambda}{\\Pi, \\forall x\\,A(x) \\vdash \\Lambda}\\;\\;(\\forall\\text{-}L)\\quad\\text{对于任意项 $t$。}\n$$\n切消规则如下：\n$$\n\\frac{\\Gamma \\vdash \\Delta, \\varphi \\quad\\quad \\Pi, \\varphi \\vdash \\Lambda}{\\Gamma, \\Pi \\vdash \\Delta, \\Lambda}\\;\\;(\\mathrm{cut}).\n$$\n\n我们工作在一阶语言中，该语言包含一个常数符号 $a$、一个一元函数符号 $f$ 以及一元谓词符号 $P$ 和 $Q$。令 $A(x)$ 为公式 $P(x) \\rightarrow Q(f(x))$。假设你有一个如下形式的推导，其中公式 $\\forall x\\,A(x)$ 被切消：\n$$\n\\infer[\\mathrm{cut}]{\\Gamma, \\Pi \\vdash \\Delta, \\Lambda}{\n  \\infer[\\forall\\text{-}R]{\\Gamma \\vdash \\Delta, \\forall x\\,A(x)}{\n    \\pi_{R}':\\;\\Gamma \\vdash \\Delta, A(y)\n  }\n  &\n  \\infer[\\forall\\text{-}L]{\\Pi, \\forall x\\,A(x) \\vdash \\Lambda}{\n    \\pi_{L}':\\;\\Pi, A(f(a)) \\vdash \\Lambda\n  }\n}\n$$\n其中 $y$ 是 $\\forall$ 右规则推断的一个本征变量，即 $y$ 不在 $\\Gamma$ 或 $\\Delta$ 中自由出现。\n\n从上述 LK 规则的基本定义出发，执行一次详细的切消消除，通过在实例 $A(f(a))$ 上产生一个切消来消除对 $\\forall x\\,A(x)$ 的切消。在你的消除过程中，你必须明确展示本征变量条件是如何被保持的，包括对 $y$ 的任何重命名以及为对齐切消公式实例所需的随后的避免捕获的代换。\n\n为量化切消的复杂度，将公式的阶 $\\mathrm{rk}(\\cdot)$ 归纳定义如下：\n- 对于任意项 $t$，$\\mathrm{rk}(P(t)) = 0$ 且 $\\mathrm{rk}(Q(t)) = 0$ (原子公式的阶为 $0$)，\n- $\\mathrm{rk}(B \\rightarrow C) = \\max\\{\\mathrm{rk}(B), \\mathrm{rk}(C)\\} + 1$，\n- $\\mathrm{rk}(\\forall x\\,B) = \\mathrm{rk}(B) + 1$。\n\n在你的切消消除完成后，根据上述定义确定新的切消公式 $A(f(a))$ 的阶。你的最终答案必须是这个阶的单一数值。无需四舍五入。", "solution": "该问题展示了 Gentzen 的相继式演算 LK 中一个切消的具体实例，并要求应用切消消除过程，然后计算所得切消公式的阶。该问题定义明确，在证明论中有坚实的科学基础，并包含所有必要信息。因此，我们可以开始解题。\n\n需要转换的初始推导是：\n$$\n\\infer[\\mathrm{cut}]{\\Gamma, \\Pi \\vdash \\Delta, \\Lambda}{\n  \\infer[\\forall\\text{-}R]{\\Gamma \\vdash \\Delta, \\forall x\\,A(x)}{\n    \\pi_{R}':\\;\\Gamma \\vdash \\Delta, A(y)\n  }\n  &\n  \\infer[\\forall\\text{-}L]{\\Pi, \\forall x\\,A(x) \\vdash \\Lambda}{\n    \\pi_{L}':\\;\\Pi, A(f(a)) \\vdash \\Lambda\n  }\n}\n$$\n切消公式是 $\\forall x\\,A(x)$。在这种配置中，切消公式是紧接在切消规则两边的推断的主公式，这被称为主情形。切消消除的目标是用一个或多个作用于更低复杂度公式上的切消来替换此切消。\n\n切消的左前提是通过使用在相继式左侧引入全称量词的规则 $(\\forall\\text{-}L)$ 推导出来的，方法是将量化变量 $x$ 实例化为项 $f(a)$。右前提是通过使用在右侧引入全称量词的规则 $(\\forall\\text{-}R)$ 并使用一个本征变量 $y$ 推导出来的。$(\\forall\\text{-}R)$ 规则的本征变量条件是，变量 $y$ 不能在规则的结论中自由出现，这意味着 $y$ 不是 $\\Gamma$ 或 $\\Delta$ 中任何公式里的自由变量。\n\n切消消除步骤的核心是，使用右前提的推导 $\\pi_R'$ 来获得一个相继式的推导，该相继式可以与 $(\\forall\\text{-}L)$ 规则的前提直接进行切消。\n推导 $\\pi_R'$ 证明了相继式 $\\Gamma \\vdash \\Delta, A(y)$。因为 $y$ 是 $(\\forall\\text{-}R)$ 推断的本征变量，所以它在 $\\Gamma$ 或 $\\Delta$ 中没有任何自由出现。这个性质至关重要，因为它允许我们在整个推导 $\\pi_R'$ 中用任意项替换 $y$ 的自由出现，而不会使推导的结构或 $\\Gamma$ 和 $\\Delta$ 中的公式无效。\n\n我们对推导 $\\pi_R'$ 中的本征变量 $y$ 的所有自由出现执行项 $f(a)$ (来自 $(\\forall\\text{-}L)$ 推断) 的代换。我们将此代换表示为 $[f(a)/y]$。将此代换应用于推导 $\\pi_R'$ 会得到一个新的推导，我们称之为 $\\pi_R'' = \\pi_R'[f(a)/y]$。这个新推导的结论是将代换应用于相继式 $\\Gamma \\vdash \\Delta, A(y)$ 的结果：\n$$\n(\\Gamma \\vdash \\Delta, A(y))[f(a)/y]\n$$\n由于 $y$ 在 $\\Gamma$ 或 $\\Delta$ 中不是自由的，这变为：\n$$\n\\Gamma \\vdash \\Delta, A(y)[f(a)/y]\n$$\n公式 $A(x)$ 被给定为 $P(x) \\rightarrow Q(f(x))$。因此，$A(y)$ 是 $P(y) \\rightarrow Q(f(y))$。将代换应用于 $A(y)$：\n$$\nA(y)[f(a)/y] = (P(y) \\rightarrow Q(f(y)))[f(a)/y] = P(f(a)) \\rightarrow Q(f(f(a)))\n$$\n得到的这个公式恰好是 $A(f(a))$。因此，新的推导 $\\pi_R''$ 证明了相继式 $\\Gamma \\vdash \\Delta, A(f(a))$。\n\n这个代换过程的有效性必须得到确认。将 $t/v$ 代换入一个证明是有效的，如果它保持了每个推断步骤的正确性。一个潜在的问题是变量捕获，即项 $t$ 中的一个自由变量被证明中公式的量词所约束。在我们的例子中，被代换的项是 $f(a)$。这个项不含变量，只包含常数符号 $a$ 和函数符号 $f$。因此不会发生变量捕获。问题还提到了对 $y$ 的重命名。如果项 $f(a)$ 包含了可能与推导 $\\pi_R'$ 中使用的本征变量冲突的变量，那么重命名将是必要的。由于 $f(a)$ 是一个基项(不含变量)，这不成问题。所以该代换是有效且安全的。\n\n我们现在有两个推导：\n1. $\\pi_R''$，它证明了 $\\Gamma \\vdash \\Delta, A(f(a))$。\n2. $\\pi_L'$，它证明了 $\\Pi, A(f(a)) \\vdash \\Lambda$。\n\n这两个推导可以使用切消规则进行组合，以 $A(f(a))$ 作为新的切消公式：\n$$\n\\infer[\\mathrm{cut}]{\\Gamma, \\Pi \\vdash \\Delta, \\Lambda}{\n  \\pi_R'': \\Gamma \\vdash \\Delta, A(f(a))\n  &\n  \\pi_L': \\Pi, A(f(a)) \\vdash \\Lambda\n}\n$$\n这个新的推导与原始推导有相同的结论 $\\Gamma, \\Pi \\vdash \\Delta, \\Lambda$，但现在的切消作用于公式 $A(f(a))$ 而不是 $\\forall x\\,A(x)$。这构成了对原始切消的消除。切消公式的阶已经被降低了，因为 $\\mathrm{rk}(A(f(a))) < \\mathrm{rk}(\\forall x\\,A(x))$。\n\n任务的第二部分是根据所提供的定义计算新切消公式 $A(f(a))$ 的阶。\n公式 $A(f(a))$ 是 $P(f(a)) \\rightarrow Q(f(f(a)))$。阶函数 $\\mathrm{rk}(\\cdot)$ 定义如下：\n- 对于任意项 $t$，$\\mathrm{rk}(P(t)) = 0$ 且 $\\mathrm{rk}(Q(t)) = 0$。\n- $\\mathrm{rk}(B \\rightarrow C) = \\max\\{\\mathrm{rk}(B), \\mathrm{rk}(C)\\} + 1$。\n- $\\mathrm{rk}(\\forall x\\,B) = \\mathrm{rk}(B) + 1$。\n\n让我们计算 $A(f(a))$ 的阶。\n该公式具有 $B \\rightarrow C$ 的结构，其中 $B$ 是 $P(f(a))$，$C$ 是 $Q(f(f(a)))$。\n首先，我们求出 $B$ 和 $C$ 的阶。\n公式 $P(f(a))$ 是原子的，因为它是谓词符号 $P$ 应用于项 $f(a)$ 的结果。根据定义，它的阶为 $0$：\n$$\n\\mathrm{rk}(P(f(a))) = 0\n$$\n公式 $Q(f(f(a)))$ 也是原子的，是谓词符号 $Q$ 应用于项 $f(f(a))$ 的结果。它的阶也为 $0$：\n$$\n\\mathrm{rk}(Q(f(f(a)))) = 0\n$$\n现在，我们使用蕴含规则来求 $A(f(a))$ 的阶：\n$$\n\\mathrm{rk}(A(f(a))) = \\mathrm{rk}(P(f(a)) \\rightarrow Q(f(f(a)))) = \\max\\{\\mathrm{rk}(P(f(a))), \\mathrm{rk}(Q(f(f(a))))\\} + 1\n$$\n代入原子分量的阶：\n$$\n\\mathrm{rk}(A(f(a))) = \\max\\{0, 0\\} + 1 = 0 + 1 = 1\n$$\n新切消公式 $A(f(a))$ 的阶为 $1$。\n为完整起见，我们可以验证这确实是一次阶的降低。原始切消公式 $\\forall x\\,A(x)$ 的阶是 $\\mathrm{rk}(A(x)) + 1$。$A(x) = P(x) \\rightarrow Q(f(x))$ 的阶是 $\\max\\{\\mathrm{rk}(P(x)), \\mathrm{rk}(Q(f(x)))\\} + 1 = \\max\\{0,0\\} + 1 = 1$。因此，$\\mathrm{rk}(\\forall x\\,A(x)) = 1 + 1 = 2$。阶确实从 $2$ 降低到了 $1$，这正是切消消除过程的目标。", "answer": "$$\\boxed{1}$$", "id": "2979668"}, {"introduction": "这个练习将我们的关注点从“如何”切消转移到“代价多大”。虽然无切消证明具有子公式性质等优良特性，但消除切消可能会导致证明长度的急剧膨胀。本练习 [@problem_id:2982698] 提供了一个量化模型来探索这一现象，揭示了一个简洁的切消规则如何能隐藏一个指数级规模的无切消推导。这有助于我们深刻理解证明的简洁性与优雅性之间的权衡。", "problem": "考虑 Gentzen 的经典相继式演算（LK），该演算用于命题逻辑，包含结构规则（弱化、收缩、交换）、针对 $\\land$、$\\lor$ 和 $\\neg$ 的逻辑规则，以及切消规则。令一个公式的秩为其二元联结词的数量。对于每个整数 $d \\geq 1$，定义一个公式 $\\varphi_{d}$，它是一个由原子仅使用 $\\land$ 和 $\\lor$ 构成的深度为 $d$ 的满二叉树，因此叶节点的数量为 $2^{d}$，内部二元联结词的数量为 $2^{d} - 1$。考虑 LK 中某个固定相继式 $\\Gamma \\vdash \\Delta$ 的一个证明 $P_{d}$，该证明恰好对公式 $\\varphi_{d}$ 使用一次切消，并假设此次切消的两个前提中不包含其他切消。\n\n将证明的长度度量为逻辑规则的应用次数，其中切消规则和同一性公理 $A \\vdash A$ 的应用也计为逻辑规则的应用。在标准的 Gentzen 切消消除变换下，当切消公式的顶层联结词为 $\\land$ 或 $\\lor$ 时，该切消被替换为对其直接子公式的两个切消；并且每当切消与该联结词的逻辑引入步骤进行置换时，恰好产生一次额外的逻辑规则应用。原子切消由单个同一性公理消解。\n\n令 $L_{\\mathrm{cut}}(d)$ 表示 $P_{d}$ 中单个切消对证明长度的贡献（因此 $L_{\\mathrm{cut}}(d) = 1$），并令 $L_{\\mathrm{cf}}(d)$ 表示从 $P_{d}$ 中消除该切消时引入的逻辑规则应用总数，这包括将切消置换过 $2^{d} - 1$ 个二元联结词时产生的“推入”步骤，以及在叶节点处消解最终产生的原子切消所需的 $2^{d}$ 个同一性公理。\n\n计算比较加速比的精确封闭形式解析表达式\n$$\nR(d) \\;=\\; \\frac{L_{\\mathrm{cf}}(d)}{L_{\\mathrm{cut}}(d)} \\, .\n$$\n\n你的最终答案必须是一个关于 $d$ 的单一封闭形式表达式。", "solution": "首先验证该问题，以确保其是自洽的、有科学依据且适定的。该问题设置在数学逻辑这一成熟领域内，具体涉及关于 Gentzen 的相继式演算（LK）和切消消除定理的证明论。所有术语都得到了形式化且定量的定义：公式 $\\varphi_d$ 的结构、证明长度的度量、切消消除的成本（$L_{\\mathrm{cf}}(d)$）的组成部分，以及切消的初始成本（$L_{\\mathrm{cut}}(d)$）。该问题为切消消除过程的成本提供了一个具体但简化的模型。任务是在这个明确定义的模型内进行计算。经查，该问题是有效的，因为它是一致的、完备的且可形式化的。\n\n目标是计算比率 $R(d) = \\frac{L_{\\mathrm{cf}}(d)}{L_{\\mathrm{cut}}(d)}$。已知 $L_{\\mathrm{cut}}(d) = 1$，代表初始证明 $P_d$ 中对公式 $\\varphi_d$ 的单次切消规则应用。因此，问题简化为求出 $L_{\\mathrm{cf}}(d)$ 的表达式，然后计算 $R(d) = L_{\\mathrm{cf}}(d)$。\n\n量 $L_{\\mathrm{cf}}(d)$ 被定义为在消除对 $\\varphi_d$ 的单次切消过程中引入的逻辑规则应用总数。问题指明该成本包含两个不同的组成部分：\n$1$. 在将切消置换过 $\\varphi_d$ 中所有二元联结词时产生的“推入”步骤。\n$2$. 用于在该过程结束时消解所产生的原子切消的同一性公理。\n\n让我们分析每一个组成部分。\n\n首先，我们考虑公式 $\\varphi_d$ 的结构。它被定义为由原子仅使用 $\\land$ 和 $\\lor$ 构成的深度为 $d \\geq 1$ 的满二叉树。\n- 叶节点的数量，即原子公式的数量，为 $2^d$。\n- 内部节点的数量，即二元联结词的数量，是深度为 $d$ 的满二叉树中的节点总数减去叶节点的数量。节点总数为 $\\sum_{i=0}^{d} 2^i = 2^{d+1}-1$。因此，联结词的数量为 $(2^{d+1}-1) - 2^d = 2^d \\cdot 2 - 1 - 2^d = 2^d - 1$。这一点在问题描述中也已说明。\n\n问题陈述，来自“推入”步骤的成本是在“将切消置换过 $2^d - 1$ 个二元联结词时”产生的。对所提供模型的最直接解释是， $2^d-1$ 个联结词中的每一个都需要一个“推入”步骤来消除。此步骤将对复合公式的切消转换为对其直接子公式的切消。将 $\\varphi_d$ 完全分解为其原子成分所需的此类转换步骤的总数，恰好是 $\\varphi_d$ 中联结词的数量。\n令 $N_{\\text{push}}(d)$ 为推入步骤的总数。\n$$\nN_{\\text{push}}(d) = 2^d - 1\n$$\n\n其次，我们考虑消解原子切消的成本。当切消公式为原子公式时，切消消除过程终止。公式 $\\varphi_d$ 有 $2^d$ 个原子叶节点。消除过程通过递归地分解切消公式，将产生 $2^d$ 个独立的切消，每个切消都作用于原始公式 $\\varphi_d$ 的一个原子叶节点。问题指明“原子切消由单个同一性公理消解”，并且同一性公理（$A \\vdash A$）计为逻辑规则的应用。\n因此，所需的同一性公理数量 $N_{\\text{axiom}}(d)$ 等于原子切消的数量。\n$$\nN_{\\text{axiom}}(d) = 2^d\n$$\n\n总成本 $L_{\\mathrm{cf}}(d)$ 是这两个组成部分的总和。\n$$\nL_{\\mathrm{cf}}(d) = N_{\\text{push}}(d) + N_{\\text{axiom}}(d)\n$$\n代入我们找到的表达式：\n$$\nL_{\\mathrm{cf}}(d) = (2^d - 1) + 2^d\n$$\n$$\nL_{\\mathrm{cf}}(d) = 2 \\cdot 2^d - 1\n$$\n$$\nL_{\\mathrm{cf}}(d) = 2^{d+1} - 1\n$$\n\n最后，我们计算比较加速比 $R(d)$。\n$$\nR(d) = \\frac{L_{\\mathrm{cf}}(d)}{L_{\\mathrm{cut}}(d)}\n$$\n已知 $L_{\\mathrm{cut}}(d) = 1$。\n$$\nR(d) = \\frac{2^{d+1} - 1}{1}\n$$\n$$\nR(d) = 2^{d+1} - 1\n$$\n这个表达式代表了（通过消除切消生成的）证明的无切消部分的长度与原始切消应用本身的长度之比。它显示了证明长度作为切消公式深度的函数呈指数级增长，这是切消消除的一个典型特征。", "answer": "$$\n\\boxed{2^{d+1} - 1}\n$$", "id": "2982698"}]}