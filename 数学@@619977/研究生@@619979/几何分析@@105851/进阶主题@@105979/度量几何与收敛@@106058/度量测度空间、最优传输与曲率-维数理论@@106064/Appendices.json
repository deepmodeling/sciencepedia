{"hands_on_practices": [{"introduction": "蒙日（Monge）和坎托罗维奇（Kantorovich）公式之间的区别是现代替最优输运理论的基石。虽然蒙日公式寻求一个直接的输运映射，更符合直觉，但它在一些简单场景中可能会失效。本练习将通过一个度量图上的具体例子，精确地揭示这种因“质量分裂”导致的失效，并展示坎托罗维奇的松弛公式如何提供解决方案，从而帮助你深入理解坎托罗维奇问题的必要性。[@problem_id:3032195]", "problem": "考虑以下几何分析意义下的度量测度空间。设 $X$ 是将两个闭区间 $[0,2]$ 和 $[0,3]$ 在其 $0$ 端点处粘合得到的度量图，并将公共点记为 $o$。为 $X$ 配备由图上欧几里得长度诱导的路径度量 $d$，并设 $m$ 为限制在 $X$ 上的一维豪斯多夫测度。将区间 $[0,2]$ 的端点记为 $y_{1}$，区间 $[0,3]$ 的端点记为 $y_{2}$，因此有 $d(o,y_{1})=2$ 和 $d(o,y_{2})=3$。考虑代价函数 $c(x,y)=d(x,y)^{2}$。在 $X$ 的波莱尔 $\\sigma$-代数上，定义源概率测度 $\\mu=\\delta_{o}$ 和目标概率测度 $\\nu=\\frac{1}{3}\\,\\delta_{y_{1}}+\\frac{2}{3}\\,\\delta_{y_{2}}$。\n\n从蒙日表述（寻找一个可测输运映射 $T:X\\to X$，满足 $T_{\\#}\\mu=\\nu$ 且最小化 $\\int c(x,T(x))\\,\\mathrm{d}\\mu(x)$）和坎托罗维奇表述（寻找 $(\\mu,\\nu)$ 的一个耦合 $\\pi$，最小化 $\\int c(x,y)\\,\\mathrm{d}\\pi(x,y)$）的基本定义出发，完成以下任务：\n\n1. 仅使用前推测度的定义以及 $\\mu$ 和 $\\nu$ 的结构，解释为何蒙日表述在此设定下是不可行的。\n2. 构造一个容许的坎托罗维奇耦合 $\\pi$，并证明它在所有容许耦合中最小化了输运代价。\n3. 显式计算最优坎托罗维奇代价 $\\int c(x,y)\\,\\mathrm{d}\\pi(x,y)$。你的最终答案必须是一个实数。\n\n你的推理过程不得依赖任何预设了输运映射专门存在性结果的捷径；而应仅使用前推测度、耦合和代价泛函的核心定义。你可以通过回顾曲率-维数条件（CD$(K,N)$）在绝对连续性和非分支假设下与输运映射的存在性和唯一性相互作用，来引用曲率-维数理论的一般背景，但在此处不要假设这些条件成立。请给出精确的最终数值答案；无需四舍五入。", "solution": "该问题是良定义的，可以通过直接应用最优输运的蒙日和坎托罗维奇表述的基本定义来解决。\n\n度量测度空间为 $(X, d, m)$，其中 $X$ 是一个通过在点 $o$（对应于两个区间中的 $0$）处连接两个区间（可分别等同于 $[0,2]$ 和 $[0,3]$）而形成的度量图。度量 $d$ 是最短路径距离。源测度为 $\\mu = \\delta_{o}$，即在连接点 $o$ 处的一个狄拉克质量。目标测度为 $\\nu = \\frac{1}{3}\\delta_{y_{1}} + \\frac{2}{3}\\delta_{y_{2}}$，是图的另外两个端点上狄拉克质量的加权和，其中 $d(o, y_{1}) = 2$ 且 $d(o, y_{2}) = 3$。代价函数为 $c(x, y) = d(x, y)^{2}$。\n\n1. 蒙日表述的不可行性\n\n蒙日问题旨在寻找一个可测映射 $T: X \\to X$，它在满足前推约束 $T_{\\#}\\mu = \\nu$ 的条件下，最小化输运代价 $\\int_{X} c(x, T(x))\\,\\mathrm{d}\\mu(x)$。我们来分析这个约束。源测度为 $\\mu = \\delta_{o}$。前推测度 $T_{\\#}\\mu$ 由其对任意波莱尔集 $A \\subseteq X$ 的作用定义：\n$$ (T_{\\#}\\mu)(A) = \\mu(T^{-1}(A)) = \\delta_{o}(T^{-1}(A)) $$\n根据狄拉克测度的定义，如果 $o \\in S$，则 $\\delta_{o}(S)$ 等于 $1$，否则等于 $0$。因此：\n$$ (T_{\\#}\\mu)(A) = \\begin{cases} 1 & \\text{if } o \\in T^{-1}(A) \\\\ 0 & \\text{if } o \\notin T^{-1}(A) \\end{cases} $$\n条件 $o \\in T^{-1}(A)$ 等价于 $T(o) \\in A$。这意味着前推测度 $T_{\\#}\\mu$ 是一个集中在单点 $T(o) \\in X$ 上的狄拉克测度。也就是说，$T_{\\#}\\mu = \\delta_{T(o)}$。\n\n因此，前推约束 $T_{\\#}\\mu = \\nu$ 变为：\n$$ \\delta_{T(o)} = \\frac{1}{3}\\delta_{y_{1}} + \\frac{2}{3}\\delta_{y_{2}} $$\n该方程断言了两个测度相等。为使此等式成立，这两个测度必须在所有可测集上都一致。让我们对单点集 $\\{y_{1}\\}$ 进行检验。\n等式左边的测度给出 $\\delta_{T(o)}(\\{y_{1}\\})$，其值只能取 $1$（如果 $T(o) = y_{1}$）或 $0$（如果 $T(o) \\neq y_{1}$）。\n等式右边的测度给出：\n$$ \\nu(\\{y_{1}\\}) = \\left(\\frac{1}{3}\\delta_{y_{1}} + \\frac{2}{3}\\delta_{y_{2}}\\right)(\\{y_{1}\\}) = \\frac{1}{3}\\delta_{y_{1}}(\\{y_{1}\\}) + \\frac{2}{3}\\delta_{y_{2}}(\\{y_{1}\\}) = \\frac{1}{3}(1) + \\frac{2}{3}(0) = \\frac{1}{3} $$\n因此，该等式将要求 $\\delta_{T(o)}(\\{y_{1}\\}) = \\frac{1}{3}$。这是一个矛盾，因为一个集合的狄拉克测度值只能是 $0$ 或 $1$。问题的核心在于，一个映射 $T$ 将点 $o$ 映至单点 $T(o)$，因此它无法将 $\\delta_o$ 的质量“分裂”并分配到两个不同的点 $y_{1}$ 和 $y_{2}$ 上。因此，不存在这样的输运映射 $T$，蒙日问题因没有容许解而是不可行的。\n\n2. 最优坎托罗维奇耦合\n\n坎托罗维奇问题旨在寻找一个在乘积空间 $X \\times X$ 上的概率测度 $\\pi$（称为耦合），使其边缘测度为 $\\mu$ 和 $\\nu$，并最小化总代价 $\\int_{X \\times X} c(x, y)\\,\\mathrm{d}\\pi(x, y)$。一个耦合 $\\pi$ 是容许的，如果对所有波莱尔集 $A, B \\subseteq X$：\n$$ \\pi(A \\times X) = \\mu(A) \\quad \\text{and} \\quad \\pi(X \\times B) = \\nu(B) $$\n让我们应用第一个边缘约束，其中 $\\mu = \\delta_{o}$。对于任何不包含 $o$ 的波莱尔集 $A \\subseteq X$，我们有 $\\mu(A) = \\delta_{o}(A) = 0$。该约束意味着 $\\pi(A \\times X) = 0$。这迫使测度 $\\pi$ 的支撑集是 $\\{o\\} \\times X$ 的一个子集。换言之，任何容许耦合 $\\pi$ 都必须具有 $\\pi = \\delta_{o} \\otimes \\rho$ 的形式，其中 $\\rho$ 是 $X$ 上的某个概率测度。\n\n现在我们应用第二个边缘约束。对于任何波莱尔集 $B \\subseteq X$：\n$$ \\pi(X \\times B) = (\\delta_{o} \\otimes \\rho)(X \\times B) = \\delta_{o}(X) \\rho(B) = (1) \\rho(B) = \\rho(B) $$\n约束 $\\pi(X \\times B) = \\nu(B)$ 要求对所有波莱尔集 $B$ 都有 $\\rho(B) = \\nu(B)$。这唯一地确定了测度 $\\rho$ 为 $\\nu$。\n因此，只存在一个满足两个边缘条件的容许耦合：\n$$ \\pi = \\delta_{o} \\otimes \\nu $$\n代入 $\\nu$ 的表达式：\n$$ \\pi = \\delta_{o} \\otimes \\left(\\frac{1}{3}\\delta_{y_{1}} + \\frac{2}{3}\\delta_{y_{2}}\\right) $$\n根据测度张量积的双线性，这等于：\n$$ \\pi = \\frac{1}{3}(\\delta_{o} \\otimes \\delta_{y_{1}}) + \\frac{2}{3}(\\delta_{o} \\otimes \\delta_{y_{2}}) $$\n这个测度可以被等同为 $X \\times X$ 上的一个测度 $\\pi = \\frac{1}{3}\\delta_{(o, y_{1})} + \\frac{2}{3}\\delta_{(o, y_{2})}$，其中 $\\delta_{(a,b)}$ 是在点 $(a,b) \\in X \\times X$ 上的狄拉克质量。\n\n由于只有一个容许耦合 $\\pi$，所有容许耦合的集合 $\\Pi(\\mu, \\nu)$ 是一个单元素集。在一个单元素集上最小化代价泛函，其结果自然由该集合的唯一元素实现。因此，这个唯一的耦合 $\\pi = \\delta_{o} \\otimes \\nu$ 就是最优坎托罗维奇耦合。蒙日表述的失败以及唯一坎托罗维奇耦合的存在性，是涉及质量分裂问题的典型特征。这种情况突显了为何坎托罗维奇松弛是必不可少的。像曲率-维数 CD$(K,N)$ 这样的理论通常为最优输运*映射*（一个蒙日解）的存在性提供条件，但这些条件通常要求源测度相对于参考测度 $m$ 是绝对连续的，并且空间是非分支的——这些条件在本问题设定中显然不成立。\n\n3. 最优代价的计算\n\n最优坎托罗维奇代价是对最优耦合 $\\pi$ 求值的输运代价泛函的值。\n$$ \\text{Cost} = \\int_{X \\times X} c(x, y)\\,\\mathrm{d}\\pi(x, y) = \\int_{X \\times X} d(x, y)^{2}\\,\\mathrm{d}\\pi(x, y) $$\n代入最优耦合 $\\pi = \\frac{1}{3}\\delta_{(o, y_{1})} + \\frac{2}{3}\\delta_{(o, y_{2})}$：\n$$ \\text{Cost} = \\int_{X \\times X} d(x, y)^{2}\\,\\mathrm{d}\\left(\\frac{1}{3}\\delta_{(o, y_{1})} + \\frac{2}{3}\\delta_{(o, y_{2})}\\right) $$\n根据积分的线性性：\n$$ \\text{Cost} = \\frac{1}{3}\\int_{X \\times X} d(x, y)^{2}\\,\\mathrm{d}\\delta_{(o, y_{1})} + \\frac{2}{3}\\int_{X \\times X} d(x, y)^{2}\\,\\mathrm{d}\\delta_{(o, y_{2})} $$\n函数 $f(p)$ 对狄拉克测度 $\\delta_{p_0}$ 的积分是 $f(p_0)$。应用此规则：\n$$ \\text{Cost} = \\frac{1}{3}d(o, y_{1})^{2} + \\frac{2}{3}d(o, y_{2})^{2} $$\n问题给出了距离 $d(o, y_{1}) = 2$ 和 $d(o, y_{2}) = 3$。代入这些值：\n$$ \\text{Cost} = \\frac{1}{3}(2)^{2} + \\frac{2}{3}(3)^{2} = \\frac{1}{3}(4) + \\frac{2}{3}(9) = \\frac{4}{3} + \\frac{18}{3} = \\frac{22}{3} $$\n最优坎托罗维奇代价是 $\\frac{22}{3}$。", "answer": "$$\n\\boxed{\\frac{22}{3}}\n$$", "id": "3032195"}, {"introduction": "瓦瑟斯坦（Wasserstein）距离赋予了概率测度空间丰富的几何结构，使我们能够探究两个分布之间的“最短路径”或测地线，这在许多应用和理论发展中居于核心地位。本练习旨在通过具体计算在实直线上的两个离散测度之间的 $W_2$-测地线，来加深对这一概念的理解。通过应用单调重排原理来构建显式的测地线路径并计算沿途的距离，你将巩固对最优输运动力学公式和瓦瑟斯坦空间几何的掌握。[@problem_id:3032182]", "problem": "考虑实线 $\\mathbb{R}$ 上的玻尔概率测度空间，该空间配备了欧几里得距离 $d(x,y)=|x-y|$ 以及由下式定义的2阶二次瓦瑟斯坦距离：\n$$\nW_{2}(\\mu,\\nu)^{2}=\\inf_{\\pi\\in\\Pi(\\mu,\\nu)}\\int_{\\mathbb{R}\\times\\mathbb{R}}|x-y|^{2}\\,d\\pi(x,y),\n$$\n其中 $\\Pi(\\mu,\\nu)$ 表示 $\\mu$ 和 $\\nu$ 的所有耦合的集合。在实线上，最优耦合可以通过累积分布函数（CDF）进行单调重排来刻画。对于概率测度 $\\mu$，其CDF定义为 $F_{\\mu}(x)=\\mu((-\\infty,x])$，相应的分位数函数为 $F_{\\mu}^{-1}(u)=\\inf\\{x\\in\\mathbb{R}:F_{\\mu}(x)\\ge u\\}$，其中 $u\\in(0,1)$。$\\mu_{0}$ 和 $\\mu_{1}$ 之间的一条 $W_{2}$-测地线是一条曲线 $(\\mu_{t})_{t\\in[0,1]}$，它通过在最优耦合对之间沿直线输运质量来构造。\n\n设\n$$\n\\mu_{0}=\\frac{1}{2}\\,\\delta_{0}+\\frac{1}{2}\\,\\delta_{3},\\qquad \\mu_{1}=\\frac{1}{4}\\,\\delta_{-1}+\\frac{1}{2}\\,\\delta_{2}+\\frac{1}{4}\\,\\delta_{5}.\n$$\n仅使用 $W_{2}$ 的定义和 $\\mathbb{R}$ 上的单调重排原理，确定 $\\mu_{0}$ 和 $\\mu_{1}$ 之间的唯一最优耦合，通过在该耦合下进行位移插值来显式构造 $W_{2}$-测地线 $(\\mu_{t})_{t\\in[0,1]}$，然后计算 $W_{2}(\\mu_{t},\\mu_{1/3})$ 作为 $t\\in[0,1]$ 的函数的精确闭式表达式。将你的最终答案表示为单个解析表达式。不需要四舍五入，也不涉及物理单位。", "solution": "问题陈述经核实具有科学依据、问题适定且客观。这是度量空间上最优输运理论领域的标准问题。所有必要的定义和数据均已提供，不存在矛盾或歧义。\n\n该问题要求三项内容：给定测度 $\\mu_{0}$ 和 $\\mu_{1}$ 之间的最优耦合， $W_{2}$-测地线 $(\\mu_{t})_{t\\in[0,1]}$ 的显式构造，以及 $W_{2}(\\mu_{t},\\mu_{1/3})$ 的计算。\n\n**第1步：确定最优耦合**\n\n$\\mathbb{R}$ 上两个概率测度之间的最优耦合由单调重排原理确定。对于离散测度，这意味着按其位置的升序匹配质量分量。我们首先计算累积分布函数（CDF）及其广义逆，即分位数函数。\n\n初始测度为 $\\mu_{0}=\\frac{1}{2}\\,\\delta_{0}+\\frac{1}{2}\\,\\delta_{3}$。其CDF为：\n$$\nF_{\\mu_{0}}(x) = \\begin{cases} 0 & \\text{若 } x < 0 \\\\ \\frac{1}{2} & \\text{若 } 0 \\le x < 3 \\\\ 1 & \\text{若 } x \\ge 3 \\end{cases}\n$$\n相应的分位数函数 $F_{\\mu_{0}}^{-1}(u) = \\inf\\{x \\in \\mathbb{R} : F_{\\mu_{0}}(x) \\ge u\\}$（对于 $u \\in (0,1)$）为：\n$$\nF_{\\mu_{0}}^{-1}(u) = \\begin{cases} 0 & \\text{若 } 0 < u \\le \\frac{1}{2} \\\\ 3 & \\text{若 } \\frac{1}{2} < u \\le 1 \\end{cases}\n$$\n\n最终测度为 $\\mu_{1}=\\frac{1}{4}\\,\\delta_{-1}+\\frac{1}{2}\\,\\delta_{2}+\\frac{1}{4}\\,\\delta_{5}$。其CDF为：\n$$\nF_{\\mu_{1}}(x) = \\begin{cases} 0 & \\text{若 } x < -1 \\\\ \\frac{1}{4} & \\text{若 } -1 \\le x < 2 \\\\ \\frac{3}{4} & \\text{若 } 2 \\le x < 5 \\\\ 1 & \\text{若 } x \\ge 5 \\end{cases}\n$$\n相应的分位数函数为：\n$$\nF_{\\mu_{1}}^{-1}(u) = \\begin{cases} -1 & \\text{若 } 0 < u \\le \\frac{1}{4} \\\\ 2 & \\text{若 } \\frac{1}{4} < u \\le \\frac{3}{4} \\\\ 5 & \\text{若 } \\frac{3}{4} < u \\le 1 \\end{cases}\n$$\n\n最优输运方案匹配分位数。我们考虑分位数变量 $u \\in (0,1)$ 的区间：\n1. 对于 $u \\in (0, \\frac{1}{4}]$，我们有 $F_{\\mu_{0}}^{-1}(u)=0$ 和 $F_{\\mu_{1}}^{-1}(u)=-1$。这意味着将 $\\frac{1}{4}$ 的质量从 $0$ 输运到 $-1$。\n2. 对于 $u \\in (\\frac{1}{4}, \\frac{1}{2}]$，我们有 $F_{\\mu_{0}}^{-1}(u)=0$ 和 $F_{\\mu_{1}}^{-1}(u)=2$。这意味着将 $\\frac{1}{4}$ 的质量从 $0$ 输运到 $2$。\n3. 对于 $u \\in (\\frac{1}{2}, \\frac{3}{4}]$，我们有 $F_{\\mu_{0}}^{-1}(u)=3$ 和 $F_{\\mu_{1}}^{-1}(u)=2$。这意味着将 $\\frac{1}{4}$ 的质量从 $3$ 输运到 $2$。\n4. 对于 $u \\in (\\frac{3}{4}, 1]$，我们有 $F_{\\mu_{0}}^{-1}(u)=3$ 和 $F_{\\mu_{1}}^{-1}(u)=5$。这意味着将 $\\frac{1}{4}$ 的质量从 $3$ 输运到 $5$。\n\n因此，最优耦合 $\\pi \\in \\Pi(\\mu_{0},\\mu_{1})$ 是 $\\mathbb{R}\\times\\mathbb{R}$ 上的离散测度：\n$$\n\\pi = \\frac{1}{4}\\,\\delta_{(0, -1)} + \\frac{1}{4}\\,\\delta_{(0, 2)} + \\frac{1}{4}\\,\\delta_{(3, 2)} + \\frac{1}{4}\\,\\delta_{(3, 5)}\n$$\n\n**第2步：构造 $W_{2}$-测地线**\n\n$W_{2}$-测地线 $(\\mu_{t})_{t\\in[0,1]}$ 是通过位移插值构造的。每个质量粒子以恒定速度从其初始位置 $x$ 沿直线路径移动到其最终位置 $y$。在时间 $t$ 的位置由 $(1-t)x + ty$ 给出。将此应用于最优耦合 $\\pi$ 的支撑集：\n1. $\\frac{1}{4}$ 的质量从 $0$ 移动到 $-1$。在时间 $t$，它位于 $(1-t)0 + t(-1) = -t$。\n2. $\\frac{1}{4}$ 的质量从 $0$ 移动到 $2$。在时间 $t$，它位于 $(1-t)0 + t(2) = 2t$。\n3. $\\frac{1}{4}$ 的质量从 $3$ 移动到 $2$。在时间 $t$，它位于 $(1-t)3 + t(2) = 3-3t+2t = 3-t$。\n4. $\\frac{1}{4}$ 的质量从 $3$ 移动到 $5$。在时间 $t$，它位于 $(1-t)3 + t(5) = 3-3t+5t = 3+2t$。\n\n因此，在时间 $t \\in [0,1]$ 的测度 $\\mu_{t}$ 由下式给出：\n$$\n\\mu_{t} = \\frac{1}{4}\\,\\delta_{-t} + \\frac{1}{4}\\,\\delta_{2t} + \\frac{1}{4}\\,\\delta_{3-t} + \\frac{1}{4}\\,\\delta_{3+2t}\n$$\n\n**第3步：计算 $W_{2}(\\mu_{t}, \\mu_{1/3})$**\n\n我们需要求出 $s = \\frac{1}{3}$ 时 $\\mu_{t}$ 和 $\\mu_{s}$ 之间的瓦瑟斯坦距离。首先，我们写出 $\\mu_{1/3}$：\n$$\n\\mu_{1/3} = \\frac{1}{4}\\,\\delta_{-1/3} + \\frac{1}{4}\\,\\delta_{2/3} + \\frac{1}{4}\\,\\delta_{3-1/3} + \\frac{1}{4}\\,\\delta_{3+2/3} = \\frac{1}{4}\\,\\delta_{-1/3} + \\frac{1}{4}\\,\\delta_{2/3} + \\frac{1}{4}\\,\\delta_{8/3} + \\frac{1}{4}\\,\\delta_{11/3}\n$$\n$\\mu_{t}$和$\\mu_{1/3}$都是具有四个等权重$\\frac{1}{4}$原子的离散测度。为计算$W_{2}$距离，我们再次使用单调重排原理。我们必须对每个测度的支撑点进行排序。\n\n$\\mu_{t}$的支撑点是 $x_1(t)=-t$、$x_2(t)=2t$、$x_3(t)=3-t$ 和 $x_4(t)=3+2t$。对于 $t \\in (0,1)$，我们有 $-t < 2t < 3-t < 3+2t$。\n$\\mu_{1/3}$的支撑点是 $y_1=-1/3$、$y_2=2/3$、$y_3=8/3$ 和 $y_4=11/3$。\n\n$\\mu_{t}$ 和 $\\mu_{1/3}$ 之间的最优耦合将 $\\mu_{t}$ 的第 $i$ 个有序点与 $\\mu_{1/3}$ 的第 $i$ 个有序点配对。$W_{2}$ 距离的平方是这些配对点之间距离平方的加权和：\n$$\nW_{2}(\\mu_{t}, \\mu_{1/3})^{2} = \\frac{1}{4}\\sum_{i=1}^{4} |x_i(t) - y_i|^2\n$$\n让我们计算各个平方差：\n\\begin{itemize}\n    \\item $|x_1(t) - y_1|^2 = |-t - (-1/3)|^2 = |\\frac{1}{3} - t|^2 = (t - \\frac{1}{3})^2$\n    \\item $|x_2(t) - y_2|^2 = |2t - 2/3|^2 = |2(t - \\frac{1}{3})|^2 = 4(t - \\frac{1}{3})^2$\n    \\item $|x_3(t) - y_3|^2 = |(3-t) - 8/3|^2 = |\\frac{9-8}{3} - t|^2 = |\\frac{1}{3} - t|^2 = (t - \\frac{1}{3})^2$\n    \\item $|x_4(t) - y_4|^2 = |(3+2t) - 11/3|^2 = |\\frac{9-11}{3} + 2t|^2 = |2t - \\frac{2}{3}|^2 = 4(t - \\frac{1}{3})^2$\n\\end{itemize}\n将这些相加得到：\n$$\n\\sum_{i=1}^{4} |x_i(t) - y_i|^2 = (t - \\frac{1}{3})^2 + 4(t - \\frac{1}{3})^2 + (t - \\frac{1}{3})^2 + 4(t - \\frac{1}{3})^2 = 10(t - \\frac{1}{3})^2\n$$\n现在我们将其代回距离平方的表达式中：\n$$\nW_{2}(\\mu_{t}, \\mu_{1/3})^{2} = \\frac{1}{4} \\left( 10(t - \\frac{1}{3})^2 \\right) = \\frac{5}{2}(t - \\frac{1}{3})^2\n$$\n取平方根，我们得到距离的最终表达式：\n$$\nW_{2}(\\mu_{t}, \\mu_{1/3}) = \\sqrt{\\frac{5}{2}} |t - \\frac{1}{3}|\n$$\n这个结果与 $W_2$-测地线的一般性质 $W_{2}(\\mu_s, \\mu_t) = |s-t| W_{2}(\\mu_0, \\mu_1)$ 相符。我们的计算证实了这一性质，而没有将其作为前提。", "answer": "$$\\boxed{\\sqrt{\\frac{5}{2}} \\left|t - \\frac{1}{3}\\right|}$$", "id": "3032182"}, {"introduction": "现代几何分析的一项重大成就是为一般的度量测度空间发展了曲率的综合概念，在这些空间中，经典的微分几何工具不再适用。Bakry–Émery 曲率-维数条件 $CD(K, N)$ 通过对一个扩散算子的分析，提供了一个强有力的替代概念。本练习将引导你完成高斯空间上 Ornstein-Uhlenbeck 算子的基础计算，这是一个满足 $CD(1, \\infty)$ 条件的经典范例。通过显式计算“场方”算子 $\\Gamma$ 和 $\\Gamma_2$，你将直接看到一个分析不等式如何编码几何信息，从而搭建起连接度量测度空间上的分析与里奇曲率概念的桥梁。[@problem_id:3032188]", "problem": "设 $(\\mathbb{R}^n, d, \\gamma_n)$ 为一个度量测度空间，其中 $d$ 是欧几里得距离，$\\gamma_n$ 是高斯概率测度，其相对于勒贝格测度的密度为 $(2\\pi)^{-n/2}\\exp(-|x|^2/2)$。考虑 Ornstein–Uhlenbeck 算子 $L$，它作用于光滑函数 $f \\in C^{\\infty}(\\mathbb{R}^n)$ 的定义为 $L f = \\Delta f - \\langle x, \\nabla f \\rangle$，其中 $\\Delta$ 是欧几里得拉普拉斯算子，$\\nabla$ 是欧几里得梯度，$\\langle \\cdot,\\cdot \\rangle$ 是欧几里得内积。定义 carré du champ 算子 $\\Gamma$ 为\n$$\n\\Gamma(f,g) \\coloneqq \\frac{1}{2}\\big(L(fg) - f\\,L g - g\\,L f\\big), \\quad \\Gamma(f) \\coloneqq \\Gamma(f,f),\n$$\n以及迭代 carré du champ 算子为\n$$\n\\Gamma_2(f) \\coloneqq \\frac{1}{2}\\big(L\\,\\Gamma(f) - 2\\,\\Gamma(f, L f)\\big).\n$$\n带参数 $K \\in \\mathbb{R}$ 和 $N \\in (1,\\infty]$ 的 Bakry–Émery 曲率-维数条件 $\\mathrm{CD}(K,N)$ 是一个逐点不等式，它要求对于所有光滑函数 $f$，\n$$\n\\Gamma_2(f) \\;\\ge\\; K\\,\\Gamma(f) \\;+\\; \\frac{1}{N}\\,\\big(L f\\big)^2,\n$$\n并约定当 $N=\\infty$ 时，省略最后一项。\n\n从上述定义出发，仅使用标准的多变量微积分恒等式，为 $(\\mathbb{R}^n, \\gamma_n)$ 上的算子 $L$ 计算 $\\Gamma(f,g)$ 和 $\\Gamma_2(f)$ 的显式公式。然后，确定最大的曲率下界 $K$ 和最小的维数参数 $N \\in (n,\\infty]$（允许 $N=\\infty$），使得 $\\mathrm{CD}(K,N)$ 对所有光滑函数 $f$ 逐点成立。将你的最终答案以行矩阵的形式，使用 $\\mathrm{pmatrix}$ 符号表示为序对 $(K,N)$。无需进行数值舍入。", "solution": "用户要求计算 carré du champ 算子，并确定高斯空间上 Ornstein–Uhlenbeck 算子的最优 Bakry–Émery 曲率-维数参数。\n\n问题陈述的验证如下：\n- **已知条件**：度量测度空间为 $(\\mathbb{R}^n, d, \\gamma_n)$，其中 $d$ 是欧几里得距离，$\\gamma_n$ 是标准高斯测度。Ornstein–Uhlenbeck 算子为 $L f = \\Delta f - \\langle x, \\nabla f \\rangle$。算子 $\\Gamma(f,g)$、$\\Gamma(f)$ 和 $\\Gamma_2(f)$ 均已定义，$\\mathrm{CD}(K,N)$ 条件也已定义为：$\\Gamma_2(f) \\ge K\\,\\Gamma(f) + \\frac{1}{N}\\,(L f)^2$。参数必须满足 $K \\in \\mathbb{R}$ 和 $N \\in (n,\\infty]$。\n- **验证**：此问题具有科学依据，是适定且客观的。它是 Bakry–Émery 曲率理论中一个标准且基础的练习。所有术语都有正式定义，前提在数学上是合理的。此问题有效。\n\n我们开始求解。\n\n首先，我们计算 carré du champ 算子 $\\Gamma(f,g)$ 的显式公式。根据定义，\n$$\n\\Gamma(f,g) \\coloneqq \\frac{1}{2}\\big(L(fg) - f\\,L g - g\\,L f\\big)\n$$\n我们将算子 $L h = \\Delta h - \\langle x, \\nabla h \\rangle$ 的定义代入此表达式。为此，我们需要 $L(fg)$ 的表达式。我们使用多变量微积分中的标准乘积法则：\n- 乘积的梯度：$\\nabla(fg) = f\\nabla g + g\\nabla f$。\n- 乘积的拉普拉斯算子：$\\Delta(fg) = \\nabla \\cdot \\nabla(fg) = \\nabla \\cdot (f\\nabla g + g\\nabla f) = (\\nabla f \\cdot \\nabla g + f\\Delta g) + (\\nabla g \\cdot \\nabla f + g\\Delta f) = f\\Delta g + g\\Delta f + 2\\langle\\nabla f, \\nabla g\\rangle$。\n\n现在，我们计算 $L(fg)$：\n$$\nL(fg) = \\Delta(fg) - \\langle x, \\nabla(fg) \\rangle = \\big( f\\Delta g + g\\Delta f + 2\\langle\\nabla f, \\nabla g\\rangle \\big) - \\langle x, f\\nabla g + g\\nabla f \\rangle\n$$\n$$\nL(fg) = f\\Delta g + g\\Delta f + 2\\langle\\nabla f, \\nabla g\\rangle - f\\langle x, \\nabla g \\rangle - g\\langle x, \\nabla f \\rangle\n$$\n接下来，我们展开 $f\\,Lg$ 和 $g\\,Lf$ 这两项：\n$$\nf\\,Lg = f(\\Delta g - \\langle x, \\nabla g \\rangle) = f\\Delta g - f\\langle x, \\nabla g \\rangle\n$$\n$$\ng\\,Lf = g(\\Delta f - \\langle x, \\nabla f \\rangle) = g\\Delta f - g\\langle x, \\nabla f \\rangle\n$$\n我们将这些表达式代回 $\\Gamma(f,g)$ 的定义中：\n$$\n2\\,\\Gamma(f,g) = \\big( f\\Delta g + g\\Delta f + 2\\langle\\nabla f, \\nabla g\\rangle - f\\langle x, \\nabla g \\rangle - g\\langle x, \\nabla f \\rangle \\big) - \\big(f\\Delta g - f\\langle x, \\nabla g \\rangle\\big) - \\big(g\\Delta f - g\\langle x, \\nabla f \\rangle\\big)\n$$\n$f\\Delta g$、$g\\Delta f$、$f\\langle x, \\nabla g \\rangle$ 和 $g\\langle x, \\nabla f \\rangle$ 这些项都相互抵消，剩下：\n$$\n2\\,\\Gamma(f,g) = 2\\langle\\nabla f, \\nabla g\\rangle\n$$\n因此，carré du champ 的显式公式为：\n$$\n\\Gamma(f,g) = \\langle\\nabla f, \\nabla g\\rangle\n$$\n对于 $g=f$ 的情况，我们有 $\\Gamma(f) \\coloneqq \\Gamma(f,f)$：\n$$\n\\Gamma(f) = \\langle\\nabla f, \\nabla f\\rangle = |\\nabla f|^2\n$$\n\n接下来，我们计算迭代 carré du champ 算子 $\\Gamma_2(f)$。根据定义，\n$$\n\\Gamma_2(f) \\coloneqq \\frac{1}{2}\\big(L\\,\\Gamma(f) - 2\\,\\Gamma(f, L f)\\big)\n$$\n我们分别计算这两项。首先是 $L\\,\\Gamma(f) = L(|\\nabla f|^2)$。\n我们需要 $|\\nabla f|^2 = \\sum_{i=1}^n (\\partial_i f)^2$ 的梯度和拉普拉斯算子。梯度的第 $k$ 个分量是：\n$$\n(\\nabla|\\nabla f|^2)_k = \\partial_k \\sum_{i=1}^n (\\partial_i f)^2 = \\sum_{i=1}^n 2(\\partial_i f)(\\partial_{ki} f) = 2 \\sum_{i=1}^n H_{ki}(f) (\\partial_i f)\n$$\n其中 $H(f)$ 是 $f$ 的 Hessian 矩阵，其元素为 $H_{ij}(f) = \\partial_{ij} f$。用向量符号表示，即为 $\\nabla(|\\nabla f|^2) = 2 H(f) \\nabla f$。\n拉普拉斯算子是梯度的散度：\n$$\n\\Delta(|\\nabla f|^2) = \\nabla \\cdot (2 H(f) \\nabla f) = \\sum_{k=1}^n \\partial_k \\left( 2 \\sum_{i=1}^n (\\partial_i f)(\\partial_{ki} f) \\right)\n$$\n$$\n= 2 \\sum_{k,i=1}^n \\left( (\\partial_{ki} f)(\\partial_{ki} f) + (\\partial_i f)(\\partial_{kki} f) \\right)\n$$\n第一项是 $2\\sum_{k,i}(\\partial_{ki}f)^2 = 2|H(f)|_{HS}^2$，其中 $|\\cdot|_{HS}$ 是 Hilbert-Schmidt 范数。第二项，通过交换求和与微分的顺序（根据光滑函数的 Clairaut 定理），得到 $2\\sum_{i}(\\partial_i f) \\partial_i (\\sum_k \\partial_{kk}f) = 2\\langle \\nabla f, \\nabla(\\Delta f) \\rangle$。\n所以，$\\Delta(|\\nabla f|^2) = 2|H(f)|_{HS}^2 + 2\\langle \\nabla f, \\nabla(\\Delta f) \\rangle$。\n现在我们可以写出 $L(\\Gamma(f))$：\n$$\nL(\\Gamma(f)) = L(|\\nabla f|^2) = \\Delta(|\\nabla f|^2) - \\langle x, \\nabla(|\\nabla f|^2) \\rangle = 2|H(f)|_{HS}^2 + 2\\langle \\nabla f, \\nabla(\\Delta f) \\rangle - \\langle x, 2 H(f) \\nabla f \\rangle\n$$\n我们计算 $\\Gamma_2(f)$ 所需的第二项是 $\\Gamma(f, L f)$。使用我们的公式 $\\Gamma(f,g) = \\langle \\nabla f, \\nabla g \\rangle$，我们有：\n$$\n\\Gamma(f, L f) = \\langle \\nabla f, \\nabla(L f) \\rangle\n$$\n我们计算 $\\nabla(Lf) = \\nabla(\\Delta f - \\langle x, \\nabla f \\rangle) = \\nabla(\\Delta f) - \\nabla(\\langle x, \\nabla f \\rangle)$。\n$\\nabla(\\langle x, \\nabla f \\rangle)$ 的第 $k$ 个分量是 $\\partial_k(\\sum_j x_j \\partial_j f) = \\sum_j (\\delta_{kj}\\partial_j f + x_j \\partial_{kj} f) = \\partial_k f + \\sum_j x_j H_{kj}(f)$。用向量形式表示，$\\nabla(\\langle x, \\nabla f \\rangle) = \\nabla f + H(f)x$。\n所以，$\\nabla(Lf) = \\nabla(\\Delta f) - \\nabla f - H(f)x$。\n将此代入 $\\Gamma(f, L f)$ 的表达式中：\n$$\n\\Gamma(f, L f) = \\langle \\nabla f, \\nabla(\\Delta f) - \\nabla f - H(f)x \\rangle = \\langle \\nabla f, \\nabla(\\Delta f) \\rangle - |\\nabla f|^2 - \\langle \\nabla f, H(f)x \\rangle\n$$\n现在我们来组合 $\\Gamma_2(f)$：\n$$\n2\\Gamma_2(f) = L(\\Gamma(f)) - 2\\Gamma(f, L f)\n$$\n$$\n= \\left( 2|H(f)|_{HS}^2 + 2\\langle \\nabla f, \\nabla(\\Delta f) \\rangle - 2\\langle x, H(f) \\nabla f \\rangle \\right) - 2\\left( \\langle \\nabla f, \\nabla(\\Delta f) \\rangle - |\\nabla f|^2 - \\langle \\nabla f, H(f)x \\rangle \\right)\n$$\n由于 Hessian 矩阵 $H(f)$ 是对称的，$\\langle x, H(f) \\nabla f \\rangle = \\langle H(f)x, \\nabla f \\rangle = \\langle \\nabla f, H(f)x \\rangle$。因此，这些项相互抵消。包含 $\\langle \\nabla f, \\nabla(\\Delta f) \\rangle$ 的项也相互抵消。\n$$\n2\\Gamma_2(f) = 2|H(f)|_{HS}^2 - (-2|\\nabla f|^2) = 2|H(f)|_{HS}^2 + 2|\\nabla f|^2\n$$\n迭代 carré du champ 的显式公式为：\n$$\n\\Gamma_2(f) = |H(f)|_{HS}^2 + |\\nabla f|^2\n$$\n最后，我们确定 $\\mathrm{CD}(K,N)$ 条件的最优参数 $K$ 和 $N$，该条件为逐点不等式：\n$$\n\\Gamma_2(f) \\ge K\\,\\Gamma(f) + \\frac{1}{N}\\,(L f)^2\n$$\n代入我们计算出的表达式：\n$$\n|H(f)|_{HS}^2 + |\\nabla f|^2 \\ge K\\,|\\nabla f|^2 + \\frac{1}{N}\\,(L f)^2\n$$\n整理各项，我们得到一个必须对所有光滑函数 $f$ 在所有点 $x \\in \\mathbb{R}^n$ 处都成立的不等式：\n$$\n(1-K)|\\nabla f|^2 + |H(f)|_{HS}^2 - \\frac{1}{N}\\,(L f)^2 \\ge 0\n$$\n为了找到最精确的参数，我们用特定的函数来检验这个不等式。考虑一个非恒定的线性函数 $f(x) = \\langle a, x \\rangle$，其中 $a \\in \\mathbb{R}^n$ 是一个固定的非零向量。对于这个函数，我们计算：\n- $\\nabla f = a$，所以 $|\\nabla f|^2 = |a|^2$。\n- $H(f) = 0$ (零矩阵)，所以 $|H(f)|_{HS}^2 = 0$。\n- $\\Delta f = 0$。\n- $L f = \\Delta f - \\langle x, \\nabla f \\rangle = 0 - \\langle x, a \\rangle = -\\langle x, a \\rangle$。\n\n将这些代入不等式得到：\n$$\n(1-K)|a|^2 + 0 - \\frac{1}{N}\\,(-\\langle x, a \\rangle)^2 \\ge 0\n$$\n$$\n(1-K)|a|^2 \\ge \\frac{1}{N}\\,\\langle x, a \\rangle^2\n$$\n这个不等式必须对所有的 $x \\in \\mathbb{R}^n$ 成立。对于给定的 $f$，左边是一个常数。然而，右边依赖于 $x$。由于 $a \\neq 0$，当 $|x| \\to \\infty$ 时，$\\langle x, a \\rangle^2$ 项是无界的。鉴于 $N \\in (n, \\infty]$，有 $1/N$ 是非负的。如果 $N$ 是有限的，那么 $1/N > 0$，右边可以变得任意大，这将违反不等式。因此，为了使不等式对所有 $x$ 成立，我们必须让依赖于 $x$ 的项的系数为零。这意味着 $1/N = 0$，所以我们必须有 $N=\\infty$。这是允许集合 $(n, \\infty]$ 中能够满足条件的“最小”值。\n\n当 $N=\\infty$ 时，$\\frac{1}{N}(Lf)^2$ 项消失，不等式简化为：\n$$\n(1-K)|\\nabla f|^2 + |H(f)|_{HS}^2 \\ge 0\n$$\n这必须对所有光滑函数 $f$ 成立。再次使用我们的测试函数 $f(x)=\\langle a, x \\rangle$，对于它有 $|\\nabla f|^2=|a|^2$ 和 $H(f)=0$，不等式变为：\n$$\n(1-K)|a|^2 \\ge 0\n$$\n因为这对任意非零向量 $a$ 的选择都必须成立，所以我们必须有系数 $(1-K) \\ge 0$，这意味着 $K \\le 1$。为了找到可能的最大曲率下界，我们取其上确界，即 $K=1$。\n\n我们现在验证序对 $(K,N)=(1, \\infty)$ 是否对所有光滑函数 $f$ 满足该条件。不等式变为：\n$$\n(1-1)|\\nabla f|^2 + |H(f)|_{HS}^2 \\ge 0\n$$\n$$\n|H(f)|_{HS}^2 \\ge 0\n$$\nHessian 矩阵的 Hilbert-Schmidt 范数的平方由 $|H(f)|_{HS}^2 = \\sum_{i,j=1}^n (\\partial_{ij}f)^2$ 给出。作为一个实数的平方和，这个量总是非负的。因此，该条件对所有光滑函数 $f$ 都成立。\n\n$K$ 的最大值为 $1$，而对应的 $N \\in (n, \\infty]$ 的最小值为 $\\infty$。该序对为 $(K,N) = (1, \\infty)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 & \\infty\n\\end{pmatrix}\n}\n$$", "id": "3032188"}]}