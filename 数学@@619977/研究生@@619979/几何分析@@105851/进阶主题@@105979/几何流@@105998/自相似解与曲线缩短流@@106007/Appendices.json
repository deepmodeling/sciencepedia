{"hands_on_practices": [{"introduction": "我们的第一个练习是基础性的。我们将把自相似解的定义应用于曲线缩短流方程，以推导出轮廓曲线所满足的常微分方程。通过特化为圆形，我们将确定著名的“收缩圆”的唯一半径 $R$，并计算一个与之相关的关键变分量。[@problem_id:3033436]", "problem": "考虑一个光滑单参数嵌入闭合曲线族 $\\gamma(t): S^{1} \\to \\mathbb{R}^{2}$，其演化遵循曲线缩短流 (CSF)，该流由几何偏微分方程 $\\partial_{t} \\gamma = \\kappa \\mathbf{n}$ 定义，其中 $\\kappa$ 是标量曲率，$\\mathbf{n}$ 是沿曲线的内指向单位法向量。一个自相似收缩解是指存在一条轮廓曲线 $\\Gamma \\subset \\mathbb{R}^{2}$，使得对于 $t<0$，该曲线族在不计环境等距的情况下由 $\\gamma(t) = \\sqrt{-t}\\,\\Gamma$ 给出。在一个以原点为中心、没有旋转或平移的坐标系中进行计算。\n\n从这些基本定义和所述的自相似性出发，首先根据伸缩族 $\\gamma(t) = \\sqrt{-t}\\,\\Gamma$ 是 CSF 解的要求，推导静态轮廓曲线 $\\Gamma$ 所满足的常微分方程。利用此推导确定唯一的圆形静态轮廓的半径 $R$。\n\n接下来，考虑高斯加权长度泛函\n$$\nF[\\Gamma] = (4\\pi)^{-\\frac{1}{2}} \\int_{\\Gamma} \\exp\\!\\left(-\\frac{|x|^{2}}{4}\\right)\\, ds,\n$$\n其中 $ds$ 表示沿 $\\Gamma$ 的弧长元。计算上述得到的圆形静态轮廓的 $F[\\Gamma]$ 的精确值。将最终答案表示为闭式解析表达式。无需四舍五入，不涉及单位。", "solution": "该问题要求推导在曲线缩短流 (CSF) 下自相似收缩轮廓曲线 $\\Gamma$ 的控制方程，确定圆形轮廓的半径 $R$，并计算该圆的特定泛函 $F[\\Gamma]$。\n\n问题陈述的有效性验证如下：\n- **提取的已知条件**：\n    - 一个闭合曲线族 $\\gamma(t): S^{1} \\to \\mathbb{R}^{2}$ 的演化由曲线缩短流 (CSF) 方程控制：$\\partial_{t} \\gamma = \\kappa \\mathbf{n}$。\n    - $\\kappa$ 是标量曲率。\n    - $\\mathbf{n}$ 是内指向单位法向量。\n    - 对于 $t<0$ 的自相似收缩解具有形式 $\\gamma(t) = \\sqrt{-t}\\,\\Gamma$，其中 $\\Gamma$ 是静态轮廓曲线。\n    - 坐标系固定在原点。\n    - 待求值的泛函为 $F[\\Gamma] = (4\\pi)^{-\\frac{1}{2}} \\int_{\\Gamma} \\exp\\!\\left(-\\frac{|x|^{2}}{4}\\right)\\, ds$。\n- **验证**：该问题在科学上基于成熟的几何流理论，特别是曲线缩短流。自相似解（收缩子）和相关的高斯加权泛函（与 Huisken 的单调性公式相关）的概念是该领域的标准内容。该问题是适定的、客观的，并包含得出唯一解所需的所有信息。没有矛盾、歧义或事实错误。\n- **结论**：问题有效。\n\n我们按要求分三部分进行求解。\n\n**第 1 部分：轮廓曲线 $\\Gamma$ 的常微分方程推导**\n\n设轮廓曲线 $\\Gamma$ 由位置向量 $X$ 参数化。演化曲线 $\\gamma(t)$ 上的一个点由位置向量 $x(t) = \\sqrt{-t} X$ 给出。参数 $t$ 小于 0。\n\n曲线上某一点的速度，对于 $\\Gamma$ 上一个固定的对应点 $X$，由对 $t$ 的偏导数给出：\n$$\n\\partial_t x(t) = \\frac{\\partial}{\\partial t} (\\sqrt{-t} X) = -\\frac{1}{2\\sqrt{-t}} X\n$$\n代入 $X = x(t) / \\sqrt{-t}$，我们可以用瞬时位置向量 $x(t)$ 来表示速度：\n$$\n\\partial_t x(t) = -\\frac{1}{2\\sqrt{-t}} \\left(\\frac{x(t)}{\\sqrt{-t}}\\right) = -\\frac{x(t)}{2(-t)}\n$$\n曲线缩短流方程 $\\partial_t \\gamma = \\kappa \\mathbf{n}$ 表明曲线的速度向量是纯法向的。这意味着任何参数化速度的法向分量必须等于 $\\kappa$。我们用下标 $\\gamma$ 表示 $\\gamma(t)$ 的几何量，用下标 $\\Gamma$ 表示 $\\Gamma$ 的几何量。速度的法向分量是 $(\\partial_t x) \\cdot \\mathbf{n}_\\gamma$。因此，CSF 方程为：\n$$\n(\\partial_t x) \\cdot \\mathbf{n}_\\gamma = \\kappa_\\gamma\n$$\n代入我们关于 $\\partial_t x$ 的表达式：\n$$\n\\left(-\\frac{x(t)}{2(-t)}\\right) \\cdot \\mathbf{n}_\\gamma = \\kappa_\\gamma\n$$\n接下来，我们将 $\\gamma(t)$ 的几何量与轮廓曲线 $\\Gamma$ 的几何量联系起来。曲线 $\\gamma(t)$ 是 $\\Gamma$ 按因子 $\\lambda(t) = \\sqrt{-t}$ 缩放后的版本。\n- 位置向量关系为 $x = \\lambda X$。\n- 弧长元关系为 $ds_\\gamma = \\lambda ds_\\Gamma = \\sqrt{-t} ds_\\Gamma$。\n- 单位切向量和单位法向量在均匀缩放变换下是不变的：$T_\\gamma = T_\\Gamma$ 和 $\\mathbf{n}_\\gamma = \\mathbf{n}_\\Gamma$。\n- 曲率与缩放因子成反比：$\\kappa_\\gamma = \\kappa_\\Gamma / \\lambda = \\kappa_\\Gamma / \\sqrt{-t}$。\n\n将这些关系代入 CSF 方程：\n$$\n\\left(-\\frac{\\sqrt{-t} X}{2(-t)}\\right) \\cdot \\mathbf{n}_\\Gamma = \\frac{\\kappa_\\Gamma}{\\sqrt{-t}}\n$$\n$$\n-\\frac{1}{2\\sqrt{-t}} (X \\cdot \\mathbf{n}_\\Gamma) = \\frac{\\kappa_\\Gamma}{\\sqrt{-t}}\n$$\n两边同乘以 $\\sqrt{-t}$，得到轮廓曲线 $\\Gamma$ 的不依赖于时间的方程：\n$$\n\\kappa_\\Gamma = -\\frac{1}{2} \\langle X, \\mathbf{n}_\\Gamma \\rangle\n$$\n这里，$\\langle X, \\mathbf{n}_\\Gamma \\rangle$ 是 $\\Gamma$ 上的位置向量 $X$ 与该点处内指向单位法向量 $\\mathbf{n}_\\Gamma$ 的点积。这就是静态轮廓曲线 $\\Gamma$ 所满足的常微分方程（在几何意义上）。\n\n**第 2 部分：圆形轮廓半径 $R$ 的确定**\n\n我们现在考虑 $\\Gamma$ 是一个以原点为中心、半径为 $R$ 的圆的情况。\n对于这样的圆：\n- 圆上的一个点由一个常数模长 $|X| = R$ 的位置向量 $X$ 给出。\n- 在 $X$ 点的内指向单位法向量 $\\mathbf{n}_\\Gamma$ 指向原点，因此它与位置向量反平行：$\\mathbf{n}_\\Gamma = -X / |X| = -X / R$。\n- 半径为 $R$ 的圆的标量曲率 $\\kappa_\\Gamma$ 是一个常数，由 $\\kappa_\\Gamma = 1/R$ 给出。\n\n我们将圆的这些性质代入推导出的 $\\Gamma$ 的常微分方程中：\n$$\n\\kappa_\\Gamma = -\\frac{1}{2} \\langle X, \\mathbf{n}_\\Gamma \\rangle\n$$\n$$\n\\frac{1}{R} = -\\frac{1}{2} \\left\\langle X, -\\frac{X}{R} \\right\\rangle\n$$\n$$\n\\frac{1}{R} = \\frac{1}{2R} \\langle X, X \\rangle\n$$\n因为 $\\langle X, X \\rangle = |X|^2 = R^2$，我们有：\n$$\n\\frac{1}{R} = \\frac{1}{2R} (R^2) = \\frac{R}{2}\n$$\n求解 $R$：\n$$\n2 = R^2 \\implies R = \\sqrt{2}\n$$\n半径必须为正，所以我们取正根。唯一的圆形静态轮廓的半径为 $R=\\sqrt{2}$。\n\n**第 3 部分：泛函 $F[\\Gamma]$ 的计算**\n\n最后的任务是计算这个特定轮廓曲线 $\\Gamma$（一个以原点为中心、半径为 $R=\\sqrt{2}$ 的圆）的泛函 $F[\\Gamma]$ 的值。该泛函定义为：\n$$\nF[\\Gamma] = (4\\pi)^{-\\frac{1}{2}} \\int_{\\Gamma} \\exp\\!\\left(-\\frac{|x|^{2}}{4}\\right)\\, ds\n$$\n积分是沿着曲线 $\\Gamma$ 进行的。对于此圆上的任意点 $x$，其位置向量的模长为 $|x|=R=\\sqrt{2}$。因此， $|x|^2 = (\\sqrt{2})^2 = 2$。\n\n被积函数 $\\exp(-|x|^2/4)$ 在 $\\Gamma$ 上处处为常数：\n$$\n\\exp\\left(-\\frac{|x|^2}{4}\\right) = \\exp\\left(-\\frac{2}{4}\\right) = \\exp\\left(-\\frac{1}{2}\\right)\n$$\n由于被积函数是常数，我们可以将其从积分中提出：\n$$\nF[\\Gamma] = (4\\pi)^{-\\frac{1}{2}} \\exp\\left(-\\frac{1}{2}\\right) \\int_{\\Gamma} ds\n$$\n积分 $\\int_{\\Gamma} ds$ 是曲线 $\\Gamma$ 的总弧长，即圆的周长。周长 $L$ 由 $L = 2\\pi R$ 给出。当 $R=\\sqrt{2}$ 时，长度为：\n$$\nL = 2\\pi\\sqrt{2}\n$$\n现在，我们将此长度代回到 $F[\\Gamma]$ 的表达式中：\n$$\nF[\\Gamma] = (4\\pi)^{-\\frac{1}{2}} \\exp\\left(-\\frac{1}{2}\\right) (2\\pi\\sqrt{2})\n$$\n我们简化该表达式：\n$$\nF[\\Gamma] = \\frac{1}{\\sqrt{4\\pi}} \\exp\\left(-\\frac{1}{2}\\right) (2\\pi\\sqrt{2}) = \\frac{1}{2\\sqrt{\\pi}} \\exp\\left(-\\frac{1}{2}\\right) (2\\pi\\sqrt{2})\n$$\n分子和分母中的因子 $2$ 消去：\n$$\nF[\\Gamma] = \\frac{\\pi\\sqrt{2}}{\\sqrt{\\pi}} \\exp\\left(-\\frac{1}{2}\\right) = (\\sqrt{\\pi}\\sqrt{2}) \\exp\\left(-\\frac{1}{2}\\right)\n$$\n$$\nF[\\Gamma] = \\sqrt{2\\pi} \\exp\\left(-\\frac{1}{2}\\right)\n$$\n这就是圆形静态轮廓的泛函的精确值。", "answer": "$$\\boxed{\\sqrt{2\\pi} \\exp\\left(-\\frac{1}{2}\\right)}$$", "id": "3033436"}, {"introduction": "理论给出了方程，但计算可以提供强大的直观理解。在这个实践中，我们将对定义收缩子轮廓的常微分方程系统进行数值求解。这使我们能够将这些曲线可视化，并从计算上理解为什么只有非常特定的初始条件才能产生像圆一样的闭合对称解。[@problem_id:3033431]", "problem": "考虑平面曲线缩短流，该流动由偏微分方程 (PDE) $\\partial_{t}\\gamma = k\\,\\mathbf{n}$ 为光滑的嵌入曲线族 $\\gamma(\\cdot,t): \\mathbb{S}^{1} \\to \\mathbb{R}^{2}$ 定义，其中 $k$ 是带符号曲率，$\\mathbf{n}$ 是选定的单位法向量。位似收缩自相似解是一族通过关于原点的均匀伸缩而相互关联的曲线。对于此类解，其时间切片满足收缩子方程 $k = \\frac{1}{2}\\langle x, \\mathbf{n}\\rangle$，其中 $x \\in \\mathbb{R}^{2}$ 是曲线上的位置向量，$\\mathbf{n}$ 是外单位法向量。\n\n使用弧长参数化 $s$，转角 $\\theta(s)$ 由单位切向量 $\\mathbf{t}(s) = (\\cos\\theta(s), \\sin\\theta(s))$ 定义。使用外单位法向量 $\\mathbf{n}(s) = (\\sin\\theta(s), -\\cos\\theta(s))$。从基本定义 $x'(s) = \\mathbf{t}(s)$ 和 $k(s) = \\theta'(s)$ 以及收缩子方程 $k(s) = \\frac{1}{2}\\langle x(s), \\mathbf{n}(s)\\rangle$ 出发，推导控制自相似收缩子轮廓上 $(x(s), \\theta(s))$ 的常微分方程 (ODE) 系统。然后，实现一个数值求解器，使用基于事件的停止条件，对此弧长 ODE 从 $s=0$ 开始积分，直到转角增加 $2\\pi$（角度必须以弧度为单位）。对于每个积分后的轮廓，计算两个诊断量：\n- 闭合误差，定义为欧几里得范数 $\\|x(s_{\\mathrm{end}}) - x(0)\\|$，其中 $s_{\\mathrm{end}}$ 是满足 $\\theta(s_{\\mathrm{end}}) - \\theta(0) = 2\\pi$ 的第一个时间点。\n- 近闭合的布尔指示符，如果闭合误差小于容差 $\\tau = 10^{-3}$，则定义为真，否则为假。\n\n您的程序必须使用鲁棒的自适应求解器实现 ODE 积分，并报告以下初始条件测试套件的诊断结果。在每种情况下，于 $s=0$ 处以 $x(0) = (x_{0}, y_{0})$ 和 $\\theta(0) = \\theta_{0}$ 进行初始化：\n1. $x_{0} = \\sqrt{2}$，$y_{0} = 0$，$\\theta_{0} = \\frac{\\pi}{2}$。\n2. $x_{0} = 1$，$y_{0} = 0$，$\\theta_{0} = \\frac{\\pi}{2}$。\n3. $x_{0} = 2$，$y_{0} = 0$，$\\theta_{0} = \\frac{\\pi}{2}$。\n4. $x_{0} = \\sqrt{2}$，$y_{0} = 0.1$，$\\theta_{0} = \\frac{\\pi}{2}$。\n\n所有角度必须以弧度处理。长度没有物理单位；将其视为无量纲。您的程序应生成单行输出，其中包含八个结果，聚合为一个逗号分隔的列表，并用方括号括起来，顺序如下：\n$[\\mathrm{err}_{1}, \\mathrm{closed}_{1}, \\mathrm{err}_{2}, \\mathrm{closed}_{2}, \\mathrm{err}_{3}, \\mathrm{closed}_{3}, \\mathrm{err}_{4}, \\mathrm{closed}_{4}]$，\n其中每个 $\\mathrm{err}_{i}$ 是一个浮点数，每个 $\\mathrm{closed}_{i}$ 是一个布尔值，分别对应于测试用例 $i$ 的闭合误差和近闭合指示符。", "solution": "所提出的问题在科学上是合理的，在数学上是适定的，并包含了唯一解所需的所有信息。这是几何分析领域的一个标准练习，特别是关于曲线缩短流的自相似解。因此，我们可以进行推导和数值求解。\n\n### 第 1 部分：ODE 系统的推导\n\n目标是推导一个常微分方程 (ODE) 系统，用于描述由位置 $x(s) \\in \\mathbb{R}^2$ 和转角 $\\theta(s)$ 所描述的曲线状态，其中 $s$ 是弧长参数。曲线上任意点 $s$ 的系统状态可以用向量 $Y(s) = (x_1(s), x_2(s), \\theta(s))$ 来描述，其中 $x(s) = (x_1(s), x_2(s))$。我们必须找到导数 $Y'(s) = \\frac{dY}{ds}$。\n\n问题提供了以下基于弧长参数化的基本关系：\n1. 位置向量 $x(s)$ 的导数是单位切向量 $\\mathbf{t}(s)$：\n    $$x'(s) = \\mathbf{t}(s)$$\n2. 单位切向量由转角 $\\theta(s)$ 定义：\n    $$\\mathbf{t}(s) = (\\cos\\theta(s), \\sin\\theta(s))$$\n3. 转角的导数是带符号曲率 $k(s)$：\n    $$\\theta'(s) = k(s)$$\n\n结合前两点，得到我们系统的前两个 ODE，描述了位置分量的演化：\n$$x_1'(s) = \\cos\\theta(s)$$\n$$x_2'(s) = \\sin\\theta(s)$$\n\n为了找到 $\\theta'(s)$ 的第三个 ODE，我们使用定义关系 $\\theta'(s) = k(s)$ 和给定的收缩子方程，任何位似收缩自相似解都必须满足该方程：\n$$k(s) = \\frac{1}{2}\\langle x(s), \\mathbf{n}(s)\\rangle$$\n这里，$\\langle \\cdot, \\cdot \\rangle$ 表示 $\\mathbb{R}^2$ 中的欧几里得内积，$\\mathbf{n}(s)$ 是外单位法向量。问题指定了与给定切向量对应的外法向量：\n$$\\mathbf{n}(s) = (\\sin\\theta(s), -\\cos\\theta(s))$$\n该法向量是通过将切向量 $\\mathbf{t}(s)$ 顺时针旋转 $\\frac{\\pi}{2}$ 弧度得到的，这与沿逆时针方向（即随着 $\\theta$ 增加）遍历的曲线的外向法向量一致。\n\n通过令曲率的两个表达式相等，我们得到：\n$$\\theta'(s) = \\frac{1}{2}\\langle x(s), \\mathbf{n}(s)\\rangle$$\n现在我们可以代入 $x(s) = (x_1(s), x_2(s))$ 和 $\\mathbf{n}(s)$ 的分量形式：\n$$\\theta'(s) = \\frac{1}{2} \\langle (x_1(s), x_2(s)), (\\sin\\theta(s), -\\cos\\theta(s)) \\rangle$$\n$$\\theta'(s) = \\frac{1}{2} (x_1(s)\\sin\\theta(s) - x_2(s)\\cos\\theta(s))$$\n这为我们的系统提供了第三个 ODE。\n\n综上所述，在弧长参数化下，控制自相似收缩子轮廓的完整一阶自治 ODE 系统为：\n$$\n\\begin{cases}\nx_1'(s) = \\cos\\theta(s) \\\\\nx_2'(s) = \\sin\\theta(s) \\\\\n\\theta'(s) = \\frac{1}{2}(x_1(s)\\sin\\theta(s) - x_2(s)\\cos\\theta(s))\n\\end{cases}\n$$\n\n### 第 2 部分：数值解策略\n\n为了数值求解该 ODE 系统，我们将使用一个自适应步长的积分器。`scipy.integrate.solve_ivp` 函数非常适合此任务。它提供了鲁棒的算法（例如默认的龙格-库塔方法 `RK45`），并且关键是支持事件检测。\n\n问题要求从初始状态 $(x(0), \\theta(0))$ 开始积分，直到转角 $\\theta(s)$ 恰好增加了 $2\\pi$。这是一个终端事件问题。我们定义一个事件函数，用于跟踪值 $\\theta(s) - (\\theta(0) + 2\\pi)$。当该函数从负值到正值穿过零时，积分停止。\n\n对于指定的四个测试用例中的每一个：\n1.  构造一个初始状态向量 $Y(0) = (x_{1,0}, x_{2,0}, \\theta_0)$。\n2.  相对于特定的初始角度 $\\theta_0$ 定义事件函数。\n3.  使用 ODE 系统、一个足够大的弧长 $s$ 积分区间（例如，$s \\in [0, 50]$）、初始状态和事件函数来调用 `solve_ivp`。\n4.  在事件成功终止时，求解器返回在精确弧长 $s_{\\mathrm{end}}$ 处的状​​态 $Y(s_{\\mathrm{end}})$，其中 $\\theta(s_{\\mathrm{end}}) = \\theta_0 + 2\\pi$。\n5.  闭合误差计算为最终位置 $x(s_{\\mathrm{end}}) = (x_{1}(s_{\\mathrm{end}}), x_{2}(s_{\\mathrm{end}}))$ 与初始位置 $x(0) = (x_{1,0}, x_{2,0})$ 之间的欧几里得距离：\n    $$\\mathrm{err} = \\|x(s_{\\mathrm{end}}) - x(0)\\| = \\sqrt{(x_1(s_{\\mathrm{end}})-x_{1,0})^2 + (x_2(s_{\\mathrm{end}})-x_{2,0})^2}$$\n6.  通过将闭合误差与容差 $\\tau = 10^{-3}$ 进行比较，确定一个近闭合的布尔指示符：\n    $$\\mathrm{closed} = (\\mathrm{err} < \\tau)$$\n\n第一个测试用例，即 $x(0) = (\\sqrt{2}, 0)$ 和 $\\theta(0) = \\frac{\\pi}{2}$，对应于位于以原点为中心、半径为 $R = \\sqrt{2}$ 的圆上的一个初始条件。一个已知的结果是，这样的圆是一个闭合的自相似收缩子。因此，对于这种情况，我们期望数值积分产生的闭合误差非常接近于零，仅受数值求解器精度的限制。其他测试用例对应于扰动或不同的初始条件，对于这些情况，曲线预计不会闭合。", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Derives and numerically solves the ODE system for a self-similar shrinker\n    under the curve shortening flow, and computes diagnostics for a given set of\n    initial conditions.\n    \"\"\"\n\n    # Define the system of Ordinary Differential Equations (ODEs)\n    # State vector y = [x1, x2, theta]\n    # Independent variable s = arc length\n    def ode_system(s, y):\n        \"\"\"\n        The ODE system for the shrinker profile.\n        y[0]: x-coordinate of the curve\n        y[1]: y-coordinate of the curve\n        y[2]: turning angle theta\n        \"\"\"\n        x1, x2, theta = y\n        dx1_ds = np.cos(theta)\n        dx2_ds = np.sin(theta)\n        # k = d(theta)/ds = 0.5 * <x, n>\n        dtheta_ds = 0.5 * (x1 * np.sin(theta) - x2 * np.cos(theta))\n        return [dx1_ds, dx2_ds, dtheta_ds]\n\n    # Test suite of initial conditions at s=0\n    # Format: (x0, y0, theta0)\n    test_cases = [\n        (np.sqrt(2), 0.0, np.pi / 2),\n        (1.0, 0.0, np.pi / 2),\n        (2.0, 0.0, np.pi / 2),\n        (np.sqrt(2), 0.1, np.pi / 2),\n    ]\n\n    results = []\n    TOLERANCE = 1e-3\n\n    for case in test_cases:\n        x0, y0, theta0 = case\n        initial_pos = np.array([x0, y0])\n        initial_state = np.array([x0, y0, theta0])\n\n        # Define the event function to stop integration when theta increases by 2*pi\n        def stop_event(s, y):\n            # The event occurs when y[2] - (theta0 + 2*pi) = 0\n            return y[2] - (theta0 + 2 * np.pi)\n\n        stop_event.terminal = True  # Stop integration when event occurs\n        stop_event.direction = 1  # Event triggers on zero-crossing from negative to positive\n\n        # Integrate the ODE system. s_span is chosen to be large enough\n        # to ensure the event occurs for all test cases.\n        s_span = [0, 50]\n        sol = solve_ivp(\n            ode_system,\n            s_span,\n            initial_state,\n            method='RK45',\n            events=stop_event,\n            dense_output=True,\n            atol=1e-9,  # Stricter tolerances for higher accuracy\n            rtol=1e-9,\n        )\n        \n        if sol.status == 1 and len(sol.t_events[0]) > 0:\n            # Event was successfully triggered\n            s_end = sol.t_events[0][0]\n            final_state = sol.sol(s_end)\n            final_pos = final_state[:2]\n\n            # Compute diagnostics\n            closure_error = np.linalg.norm(final_pos - initial_pos)\n            is_near_closed = closure_error < TOLERANCE\n            \n            results.append(closure_error)\n            results.append(is_near_closed)\n        else:\n            # Integration failed or did not trigger event, which indicates an issue.\n            # Append NaN and False for robustness.\n            results.append(float('nan'))\n            results.append(False)\n\n    # Format the output as a single comma-separated list string.\n    # str(bool) gives 'True'/'False', which is acceptable.\n    output_str = ','.join(map(str, results))\n    print(f\"[{output_str}]\")\n\nsolve()\n\n```", "id": "3033431"}, {"introduction": "在确定了一个关键解之后，几何分析中的一个核心问题是它的稳定性。本练习通过分析小扰动在重标度流下的演化，深入研究圆形收缩子的线性稳定性。通过傅里叶分析，我们将计算不同扰动模式的增长率 $\\lambda_m$，从而揭示哪些形变会随时间衰减，哪些会增长。[@problem_id:3033432]", "problem": "考虑平面中一条光滑、嵌入、闭合的曲线，由弧长 $s \\in \\mathbb{R}/(2\\pi R\\mathbb{Z})$ 参数化，其平面曲线缩短流 (CSF) 由速度定律 $\\partial_{t} X = \\kappa n$ 定义，其中 $X(s,t) \\in \\mathbb{R}^{2}$ 是曲线位置，$\\kappa(s,t)$ 是标量曲率，$n(s,t)$ 是单位法向量。令 $T$ 表示未重标度流的第一个奇异时间。引入自相似（高斯）重标度\n$$\nY(\\tau,s) := (T-t)^{-1/2} X(t,s), \\quad \\tau := -\\ln(T-t).\n$$\n在这些变量中，以原点为中心、半径为 $\\sqrt{2}$ 的（重标度）圆是稳态的。考虑在此稳态圆上的一个小的法向图扰动，由下式给出\n$$\nY(\\tau,\\theta) = \\sqrt{2}\\,e_{r}(\\theta) + u(\\tau,\\theta)\\,n_{0}(\\theta),\n$$\n其中 $\\theta \\in \\mathbb{R}/(2\\pi\\mathbb{Z})$ 是极角，$e_{r}(\\theta)$ 是径向单位向量，$n_{0}(\\theta)$ 是基圆的单位法向量，$u(\\tau,\\theta)$ 是一个标量振幅，且 $|u| \\ll 1$。运用几何分析的基本原理，即 CSF 的定义、在法向图下曲率变化的 Frenet 公式以及上述重标度，推导在稳态圆附近 $u(\\tau,\\theta)$ 的线性化演化偏微分方程 (PDE)。然后通过寻找形式为 $u(\\tau,\\theta) = \\hat{u}_{m}(\\tau) \\exp(i m \\theta)$（对于整数 $m \\in \\mathbb{Z}$）的解，对圆进行傅里叶分析，并计算由 $\\partial_{\\tau} \\hat{u}_{m} = \\lambda_{m} \\hat{u}_{m}$ 定义的相应增长率 $\\lambda_{m}$。\n\n请提供您最终答案，即 $\\lambda_{m}$ 关于 $m$ 的闭式解析表达式。不需要数值近似或四舍五入。答案必须是单个符号表达式。", "solution": "用户希望我通过以下步骤解决问题：\n1.  **验证问题陈述：** 我将检查问题的科学正确性、一致性和完整性。\n2.  **提供一个合理的解法：** 如果问题有效，我将推导扰动的线性化演化偏微分方程 (PDE)，然后计算增长率。\n\n### 步骤 1：问题验证\n\n**1.1. 提取已知条件**\n- **流：** 平面曲线缩短流 (CSF)。\n- **方程：** $\\partial_{t} X = \\kappa n$。\n- **曲线：** 光滑、嵌入、闭合，由弧长 $s$ 参数化。$X(s,t) \\in \\mathbb{R}^{2}$。\n- **符号：** $\\kappa(s,t)$ 是标量曲率，$n(s,t)$ 是单位法向量。\n- **奇异时间：** $T$ 是第一个奇异时间。\n- **自相似重标度：** $Y(\\tau,s) := (T-t)^{-1/2} X(t,s)$，其中 $\\tau := -\\ln(T-t)$。\n- **稳态解：** 对于重标度流，一个以原点为中心、半径为 $\\sqrt{2}$ 的圆是稳态的。\n- **扰动：** 在稳态圆上的一个小的法向图扰动由 $Y(\\tau,\\theta) = \\sqrt{2}\\,e_{r}(\\theta) + u(\\tau,\\theta)\\,n_{0}(\\theta)$ 给出，其中 $\\theta$ 是极角，$e_{r}(\\theta)$ 是径向单位向量，$n_{0}(\\theta)$ 是基圆的单位法向量，且 $|u| \\ll 1$。\n- **任务：** 推导 $u(\\tau,\\theta)$ 的线性化演化 PDE，并计算傅里叶模式 $u(\\tau,\\theta) = \\hat{u}_{m}(\\tau) \\exp(i m \\theta)$ 的增长率 $\\lambda_{m}$，其中 $\\partial_{\\tau} \\hat{u}_{m} = \\lambda_{m} \\hat{u}_{m}$。\n\n**1.2. 使用提取的已知条件进行验证**\n- **科学依据：** 该问题是几何流理论中的一个标准练习，特别是曲线缩短流。自相似解、奇异点附近的重标度以及这些解的稳定性分析等概念是该领域的基础。收缩圆（或平移的“grim reaper”解）是一个经典的解。\n- **适定性：** 问题定义良好。它要求推导一个线性化方程，并计算其对于特定函数基的特征值。这是线性稳定性分析中的标准程序，并且预期会有一个唯一的、有意义的解。\n- **客观性：** 语言正式、精确、客观。\n- **完整性与一致性：** 提供了所有必要的定义和变量。关于半径为 $\\sqrt{2}$ 的圆是稳态的陈述与重标度 CSF 的理论是一致的。\n\n**1.3. 结论与行动**\n问题有效。我将继续进行求解。\n\n### 步骤 2：推导与求解\n\n求解过程首先推导重标度曲线 $Y$ 的演化方程，然后围绕稳态圆解对此方程进行线性化，以求得扰动函数 $u$ 的 PDE，最后进行傅里叶分析。\n\n**2.1. 重标度曲线的演化方程**\n重标度曲线为 $Y(\\tau,s) = (T-t)^{-1/2} X(t,s)$，其中 $\\tau = -\\ln(T-t)$。\n我们计算速度 $\\partial_{\\tau} Y$。根据链式法则，有 $\\frac{\\partial}{\\partial \\tau} = \\frac{dt}{d\\tau} \\frac{\\partial}{\\partial t} = (T-t)\\frac{\\partial}{\\partial t}$。\n$$\n\\partial_{\\tau} Y = (T-t) \\frac{\\partial}{\\partial t} \\left[ (T-t)^{-1/2} X \\right]\n$$\n使用乘法法则：\n$$\n\\partial_{\\tau} Y = (T-t) \\left[ \\frac{1}{2}(T-t)^{-3/2} X + (T-t)^{-1/2} \\partial_{t} X \\right]\n$$\n$$\n\\partial_{\\tau} Y = \\frac{1}{2} (T-t)^{-1/2} X + (T-t)^{1/2} \\partial_{t} X\n$$\n代入 $Y = (T-t)^{-1/2} X$ 和 CSF 定律 $\\partial_t X = \\kappa n$：\n$$\n\\partial_{\\tau} Y = \\frac{1}{2} Y + (T-t)^{1/2} \\kappa n\n$$\n原始曲线 $X$ 的曲率 $\\kappa$ 与重标度曲线 $Y$ 的曲率 $\\tilde{\\kappa}$ 通过缩放因子相关联。由于 $Y=c X$，其中 $c=(T-t)^{-1/2}$，我们有 $\\tilde{\\kappa} = \\kappa/c = (T-t)^{1/2}\\kappa$。单位法向量在各向同性缩放变换下是不变的，因此 $n = \\tilde{n}$。\n代入 $\\kappa = (T-t)^{-1/2}\\tilde{\\kappa}$ 和 $n=\\tilde{n}$：\n$$\n\\partial_{\\tau} Y = \\frac{1}{2} Y + (T-t)^{1/2} \\left[ (T-t)^{-1/2}\\tilde{\\kappa} \\right] \\tilde{n} = \\frac{1}{2} Y + \\tilde{\\kappa} \\tilde{n}\n$$\n这就是重标度曲线 $Y$ 的演化方程。注意，速度向量 $\\partial_{\\tau} Y$ 通常不与曲线 $Y$ 正交，因为它有一个切向分量 $\\frac{1}{2}Y \\cdot \\tilde{T}$，其中 $\\tilde{T}$ 是 $Y$ 的单位切向量。\n\n**2.2. 围绕稳态圆的线性化**\n稳态解是一个以原点为中心、半径为 $R_0 = \\sqrt{2}$ 的圆 $Y_0$。我们可以用角度 $\\theta$ 将其参数化为 $Y_0(\\theta) = \\sqrt{2} e_r(\\theta)$。对于这个圆，其向内单位法向量为 $n_0 = -e_r(\\theta)$，其曲率为 $\\tilde{\\kappa}_0 = 1/R_0 = 1/\\sqrt{2}$。\n稳态条件 $\\partial_{\\tau}Y_0 = 0$ 意味着 $0 = \\frac{1}{2}Y_0 + \\tilde{\\kappa}_0 n_0$，这是满足的：\n$$\n\\frac{1}{2}(\\sqrt{2} e_r) + \\frac{1}{\\sqrt{2}}(-e_r) = (\\frac{\\sqrt{2}}{2} - \\frac{1}{\\sqrt{2}})e_r = 0\n$$\n扰动后的曲线由 $Y(\\tau,\\theta) = \\sqrt{2}\\,e_{r}(\\theta) + u(\\tau,\\theta)\\,n_{0}(\\theta)$ 给出。使用 $n_0 = -e_r$，这可以写成 $Y(\\theta) = (\\sqrt{2} - u) e_r(\\theta)$。这是一个在极坐标下由半径函数 $r(\\theta) = \\sqrt{2} - u(\\theta)$ 给出的曲线。\n\n图函数 $u$ 的演化由曲线的法向速度 $V_N = (\\partial_{\\tau} Y) \\cdot \\tilde{n}$ 决定。速度的切向分量对应于沿曲线的重新参数化，不影响曲线的形状，因此在此坐标系下对 $u$ 的演化没有贡献。\n$$\n\\partial_{\\tau} u \\approx V_N = \\left(\\frac{1}{2} Y + \\tilde{\\kappa} \\tilde{n}\\right) \\cdot \\tilde{n} = \\frac{1}{2} Y \\cdot \\tilde{n} + \\tilde{\\kappa}\n$$\n我们需要将 $Y \\cdot \\tilde{n}$ 和 $\\tilde{\\kappa}$ 两项按 $u$ 及其导数的幂次进行线性化。令 $R_0=\\sqrt{2}$。\n\n_曲率 $\\tilde{\\kappa}$ 的线性化_：\n对于在极坐标下由 $r(\\theta)$ 给出的曲线，其曲率为 $\\kappa = \\frac{|r^2 + 2(r')^2 - r r''|}{(r^2 + (r')^2)^{3/2}}$。\n当 $r = R_0 - u(\\theta)$ 时，我们有 $r' = -u'$ 和 $r'' = -u''$。\n到 $u$ 的一阶：\n$r^2 + 2(r')^2 - r r'' \\approx (R_0-u)^2 - (R_0-u)(-u'') \\approx R_0^2 - 2R_0 u + R_0 u''$。\n$(r^2+(r')^2)^{3/2} \\approx ((R_0-u)^2)^{3/2} \\approx (R_0^2-2R_0 u)^{3/2} = R_0^3 (1-2u/R_0)^{3/2} \\approx R_0^3(1-3u/R_0)$。\n$$\n\\tilde{\\kappa} \\approx \\frac{R_0^2 - 2R_0 u + R_0 u''}{R_0^3(1-3u/R_0)} \\approx \\frac{1}{R_0}\\left(1-\\frac{2u}{R_0}+\\frac{u''}{R_0}\\right)\\left(1+\\frac{3u}{R_0}\\right)\n$$\n$$\n\\tilde{\\kappa} \\approx \\frac{1}{R_0}\\left(1+\\frac{u}{R_0}+\\frac{u''}{R_0}\\right) = \\tilde{\\kappa}_0 + \\frac{u+u_{\\theta\\theta}}{R_0^2}\n$$\n因此，曲率的一阶变分为 $\\delta\\tilde{\\kappa} = \\frac{u+u_{\\theta\\theta}}{R_0^2}$。\n\n_$Y \\cdot \\tilde{n}$ 的线性化_：\n曲线 $r(\\theta)$ 的向内单位法向量是 $\\tilde{n} = \\frac{-r e_r + r' e_\\theta}{\\sqrt{r^2+(r')^2}}$。\n当 $r=R_0-u$ 且 $r'=-u'$ 时，线性化得到：\n$$\n\\tilde{n} \\approx \\frac{-(R_0-u)e_r - u' e_\\theta}{\\sqrt{R_0^2-2R_0u}} \\approx \\frac{-R_0 e_r + u e_r - u' e_\\theta}{R_0(1-u/R_0)} \\approx (-e_r + \\frac{u}{R_0}e_r - \\frac{u'}{R_0}e_\\theta)(1+\\frac{u}{R_0})\n$$\n$$\n\\tilde{n} \\approx -e_r - \\frac{u'}{R_0}e_\\theta = n_0 - \\frac{u'}{R_0}e_\\theta\n$$\n现在我们计算 $Y \\cdot \\tilde{n}$：\n$$\nY \\cdot \\tilde{n} \\approx \\left((R_0-u)e_r\\right) \\cdot \\left(-e_r - \\frac{u'}{R_0} e_\\theta\\right) = -(R_0-u) \\approx -R_0+u\n$$\n零阶部分是 $-R_0 = -\\sqrt{2}$，一阶部分是 $u$。\n\n_线性化的 PDE_：\n将线性化后的项代入 $\\partial_{\\tau}u$ 的方程中：\n$$\n\\partial_{\\tau} u \\approx \\frac{1}{2}(-R_0+u) + \\left(\\tilde{\\kappa}_0 + \\frac{u+u_{\\theta\\theta}}{R_0^2}\\right)\n$$\n$$\n\\partial_{\\tau} u \\approx \\left(-\\frac{R_0}{2} + \\tilde{\\kappa}_0\\right) + \\frac{u}{2} + \\frac{u+u_{\\theta\\theta}}{R_0^2}\n$$\n零阶项 $(-\\frac{R_0}{2} + \\tilde{\\kappa}_0) = (-\\frac{\\sqrt{2}}{2} + \\frac{1}{\\sqrt{2}}) = 0$，正如稳态解所预期的那样。\n一阶项给出了 $u$ 的线性化 PDE：\n$$\n\\partial_{\\tau} u = \\frac{u}{2} + \\frac{u+u_{\\theta\\theta}}{R_0^2}\n$$\n代入 $R_0^2 = 2$：\n$$\n\\partial_{\\tau} u = \\frac{u}{2} + \\frac{u+u_{\\theta\\theta}}{2} = u + \\frac{1}{2}u_{\\theta\\theta}\n$$\n这就是所求的线性化偏微分方程。\n\n**2.3. 傅里叶分析**\n我们寻找形式为 $u(\\tau,\\theta) = \\hat{u}_{m}(\\tau) \\exp(i m \\theta)$ 的解，其中 $m \\in \\mathbb{Z}$ 为整数。\n对 $\\theta$ 求二阶导数得到：\n$$\nu_{\\theta\\theta} = \\hat{u}_{m}(\\tau) (im)^2 \\exp(im\\theta) = -m^2 \\hat{u}_{m}(\\tau) \\exp(im\\theta) = -m^2 u\n$$\n将此代入线性化 PDE 中：\n$$\n\\partial_{\\tau} (\\hat{u}_{m} \\exp(im\\theta)) = (\\hat{u}_{m} \\exp(im\\theta)) + \\frac{1}{2} (-m^2 \\hat{u}_{m} \\exp(im\\theta))\n$$\n$$\n(\\partial_{\\tau} \\hat{u}_{m}) \\exp(im\\theta) = \\left(1 - \\frac{m^2}{2}\\right) \\hat{u}_{m} \\exp(im\\theta)\n$$\n两边除以 $\\exp(im\\theta)$，我们得到模式振幅 $\\hat{u}_{m}$ 的常微分方程：\n$$\n\\partial_{\\tau} \\hat{u}_{m} = \\left(1 - \\frac{m^2}{2}\\right) \\hat{u}_{m}\n$$\n根据定义，增长率 $\\lambda_m$ 由 $\\partial_{\\tau} \\hat{u}_{m} = \\lambda_m \\hat{u}_m$ 给出。\n比较两个表达式，我们求得增长率：\n$$\n\\lambda_m = 1 - \\frac{m^2}{2}\n$$\n模式 $m=0$（膨胀）和 $m=1$（平移）具有正增长率 $\\lambda_0=1$ 和 $\\lambda_1=1/2$，这反映了稳态圆对于半径变化和重标度中心平移是不稳定。$|m| \\ge 2$ 的模式是稳定的（$\\lambda_m \\le -1$），表明圆形对于高频扰动是稳定的。\n最终答案是 $\\lambda_m$ 的表达式。", "answer": "$$\\boxed{1 - \\frac{m^2}{2}}$$", "id": "3033432"}]}