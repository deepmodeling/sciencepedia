{
    "hands_on_practices": [
        {
            "introduction": "本实践将引导您从零开始，通过严格的计算来确定缓冲溶液的pH值。您将学习如何将质量守恒、电荷守恒以及平衡常数的定义结合起来，构建一个精确的、包含水自身质子转移效应的完整方程。这种严谨的方法是分析任何化学平衡体系的基石。",
            "id": "2958738",
            "problem": "一种水溶液在 $25\\,^{\\circ}\\mathrm{C}$ 时含有氨 $\\mathrm{NH_3}$ 和氯化铵 $\\mathrm{NH_4Cl}$，其分析浓度分别为 $0.20\\,\\mathrm{M}$ 和 $0.10\\,\\mathrm{M}$。将该溶液视为理想稀溶液（活度系数等于 $1$）。在 $25\\,^{\\circ}\\mathrm{C}$ 时，氨的碱解离常数为 $K_{b} = 1.8 \\times 10^{-5}$。在 $25\\,^{\\circ}\\mathrm{C}$ 时，水的自递质子常数为 $K_{w} = 1.0 \\times 10^{-14}$。\n\n仅从质量守恒、电荷平衡的基本陈述以及平衡常数的定义出发，为 $\\mathrm{NH_4^+}/\\mathrm{NH_3}$ 和水的平衡建立并求解耦合的非线性平衡问题。不要假定水的自递质子作用可以忽略；应通过 $K_{w}$ 将其明确地包含在内。计算溶液的氢离子浓度并报告其 $\\mathrm{pH}$ 值。将最终的 $\\mathrm{pH}$ 值四舍五入至四位有效数字。以 $\\mathrm{pH}$ 值（无单位）的形式表示最终答案。",
            "solution": "该问题提法恰当且科学上合理，符合化学平衡的基本原理。所有必要的数据均已提供，且约束条件一致。这是一个有效的问题。\n\n该水溶液包含以下物种：$\\mathrm{NH_3}$、$\\mathrm{NH_4^+}$、$\\mathrm{Cl^-}$、$\\mathrm{H^+}$（等同于 $\\mathrm{H_3O^+}$）和 $\\mathrm{OH^-}$。溶剂是水 $\\mathrm{H_2O}$。\n\n该体系受两个同时存在的平衡控制：\n$1$. 氨的碱解离：\n$$\\mathrm{NH_3} + \\mathrm{H_2O} \\rightleftharpoons \\mathrm{NH_4^+} + \\mathrm{OH^-}$$\n其平衡常数为 $K_b = \\frac{[\\mathrm{NH_4^+}][\\mathrm{OH^-}]}{[\\mathrm{NH_3}]} = 1.8 \\times 10^{-5}$。\n\n$2$. 水的自递质子：\n$$\\mathrm{H_2O} \\rightleftharpoons \\mathrm{H^+} + \\mathrm{OH^-}$$\n其平衡常数为 $K_w = [\\mathrm{H^+}][\\mathrm{OH^-}] = 1.0 \\times 10^{-14}$。\n\n为严谨起见，使用铵离子的酸解离 $\\mathrm{NH_4^+} \\rightleftharpoons \\mathrm{NH_3} + \\mathrm{H^+}$ 会更方便，其常数 $K_a$ 与 $K_b$ 和 $K_w$ 通过表达式 $K_a K_b = K_w$ 联系起来。\n$$K_a = \\frac{[\\mathrm{NH_3}][\\mathrm{H^+}]}{[\\mathrm{NH_4^+}]} = \\frac{K_w}{K_b} = \\frac{1.0 \\times 10^{-14}}{1.8 \\times 10^{-5}}$$\n$$K_a = \\frac{5}{9} \\times 10^{-9} \\approx 5.556 \\times 10^{-10}$$\n\n为了确定平衡浓度，我们基于基本守恒定律建立一个方程组。\n\n首先是质量平衡方程。\n氯化铵 $\\mathrm{NH_4Cl}$ 是一种强电解质，会完全解离。氯离子 $\\mathrm{Cl^-}$ 是旁观离子，其浓度由 $\\mathrm{NH_4Cl}$ 的初始分析浓度确定：\n$$[\\mathrm{Cl^-}] = C_{\\mathrm{NH_4Cl}} = 0.10\\,\\mathrm{M}$$\n含氮物种（“氨族”）的总浓度是守恒的。它等于加入溶液中的氨和氯化铵的分析浓度之和：\n$$C_{T} = [\\mathrm{NH_3}] + [\\mathrm{NH_4^+}] = C_{\\mathrm{NH_3}} + C_{\\mathrm{NH_4Cl}} = 0.20\\,\\mathrm{M} + 0.10\\,\\mathrm{M} = 0.30\\,\\mathrm{M}$$\n\n其次是电荷平衡方程（电中性原理）。正电荷总浓度必须等于负电荷总浓度：\n$$[\\mathrm{NH_4^+}] + [\\mathrm{H^+}] = [\\mathrm{Cl^-}] + [\\mathrm{OH^-}]$$\n\n我们得到了一个由五个独立方程组成的方程组，用于求解五个未知浓度（$[\\mathrm{NH_3}]$、$[\\mathrm{NH_4^+}]$、$[\\mathrm{H^+}]$、$[\\mathrm{OH^-}]$、$[\\mathrm{Cl^-}]$）：\n$1$. $K_a = \\frac{[\\mathrm{NH_3}][\\mathrm{H^+}]}{[\\mathrm{NH_4^+}]}$\n$2$. $K_w = [\\mathrm{H^+}][\\mathrm{OH^-}]$\n$3$. $[\\mathrm{Cl^-}] = C_{\\mathrm{NH_4Cl}}$\n$4$. $[\\mathrm{NH_3}] + [\\mathrm{NH_4^+}] = C_{T}$\n$5$. $[\\mathrm{NH_4^+}] + [\\mathrm{H^+}] = [\\mathrm{Cl^-}] + [\\mathrm{OH^-}]$\n\n为了求解该方程组，我们将所有未知浓度用单个主变量表示，我们选择 $h=[\\mathrm{H^+}]$ 作为主变量。\n\n根据 $K_a$ 的定义和总氮质量平衡，我们将 $[\\mathrm{NH_3}]$ 和 $[\\mathrm{NH_4^+}]$ 表示为 $C_T$ 的分数形式：\n从 $K_a = \\frac{(C_T - [\\mathrm{NH_4^+}]) h}{[\\mathrm{NH_4^+}]}$，我们求解 $[\\mathrm{NH_4^+}]$：\n$$[\\mathrm{NH_4^+}] = C_T \\frac{h}{K_a + h}$$\n对于 $[\\mathrm{NH_3}]$：\n$$[\\mathrm{NH_3}] = C_T - [\\mathrm{NH_4^+}] = C_T \\left(1 - \\frac{h}{K_a + h}\\right) = C_T \\frac{K_a}{K_a + h}$$\n\n根据水的自递质子常数，我们有：\n$$[\\mathrm{OH^-}] = \\frac{K_w}{h}$$\n\n现在，我们将这些表达式以及 $[\\mathrm{Cl^-}] = C_{\\mathrm{NH_4Cl}}$ 代入电荷平衡方程：\n$$C_T \\frac{h}{K_a + h} + h = C_{\\mathrm{NH_4Cl}} + \\frac{K_w}{h}$$\n这是关于 $h = [\\mathrm{H^+}]$ 的精确方程。为求解该方程，我们将其重排为多项式形式。所有项乘以 $h(K_a + h)$：\n$$C_T h^2 + h^2(K_a + h) = C_{\\mathrm{NH_4Cl}} h(K_a + h) + K_w(K_a + h)$$\n$$C_T h^2 + K_a h^2 + h^3 = C_{\\mathrm{NH_4Cl}} K_a h + C_{\\mathrm{NH_4Cl}} h^2 + K_w K_a + K_w h$$\n按 $h$ 的幂次对各项进行分组：\n$$h^3 + (C_T + K_a - C_{\\mathrm{NH_4Cl}}) h^2 - (C_{\\mathrm{NH_4Cl}} K_a + K_w) h - K_w K_a = 0$$\n将 $C_T = C_{\\mathrm{NH_3}} + C_{\\mathrm{NH_4Cl}}$ 代入 $h^2$ 项的系数中：\n$$h^3 + (C_{\\mathrm{NH_3}} + K_a) h^2 - (C_{\\mathrm{NH_4Cl}} K_a + K_w) h - K_w K_a = 0$$\n这就是氢离子浓度 $h$ 的精确三次多项式。\n\n虽然这个三次方程可以数值求解，但通过分析各项的量级，可以获得一个高精度的解析解。对于这个缓冲体系，我们预期 $\\mathrm{pH}$ 值接近 $\\mathrm{p}K_a \\approx 9.26$，所以 $h$ 将是一个很小的数（约为 $10^{-10}\\,\\mathrm{M}$ 的量级）。\n让我们使用 $C_{\\mathrm{NH_3}} = 0.20$、$C_{\\mathrm{NH_4Cl}} = 0.10$、$K_a = \\frac{5}{9} \\times 10^{-9}$ 和 $K_w = 1.0 \\times 10^{-14}$ 来检查各项系数。\n$h^2$ 的系数是 $C_{\\mathrm{NH_3}} + K_a \\approx 0.20$。\n$h$ 的系数是 $-(C_{\\mathrm{NH_4Cl}} K_a + K_w) \\approx -(0.10 \\times 5.56 \\times 10^{-10}) = -5.56 \\times 10^{-11}$。\n常数项是 $-K_w K_a \\approx -5.56 \\times 10^{-24}$。\n$h^3$ 项和常数项比 $h^2$ 项和 $h$ 项小很多个数量级。例如，如果 $h \\approx 10^{-10}$，那么 $h^3 \\approx 10^{-30}$，常数项约为 $\\approx -5.56 \\times 10^{-24}$。$h^2$ 项约为 $\\approx 0.2 \\times 10^{-20}$，$h$ 项约为 $\\approx -5.56 \\times 10^{-11} \\times 10^{-10} = -5.56 \\times 10^{-21}$。\n忽略 $h^3$ 和 $-K_w K_a$ 项可以得到一个极好的近似。三次方程简化为关于 $h$ 的线性方程：\n$$(C_{\\mathrm{NH_3}} + K_a) h^2 - (C_{\\mathrm{NH_4Cl}} K_a + K_w) h \\approx 0$$\n因为 $h \\neq 0$，我们可以两边同除以 $h$：\n$$(C_{\\mathrm{NH_3}} + K_a) h \\approx C_{\\mathrm{NH_4Cl}} K_a + K_w$$\n$$h \\approx \\frac{C_{\\mathrm{NH_4Cl}} K_a + K_w}{C_{\\mathrm{NH_3}} + K_a}$$\n这个近似等同于将电荷平衡方程简化为 $[\\mathrm{NH_4^+}] \\approx [\\mathrm{Cl^-}] + [\\mathrm{OH^-}]$（即 $[\\mathrm{H^+}]$ 可以忽略），但同时正确地保留了所有其他物种。\n\n现在，我们计算 $h$ 的数值：\n$$h = \\frac{(0.10) \\left(\\frac{5}{9} \\times 10^{-9}\\right) + (1.0 \\times 10^{-14})}{0.20 + \\left(\\frac{5}{9} \\times 10^{-9}\\right)}$$\n$$h = \\frac{5.5555... \\times 10^{-11} + 1.0 \\times 10^{-14}}{0.20000000055...}$$\n$$h = \\frac{5.556555... \\times 10^{-11}}{0.20000000055...} \\approx 2.778277... \\times 10^{-10}\\,\\mathrm{M}$$\n最后，我们计算 $\\mathrm{pH}$ 值：\n$$\\mathrm{pH} = -\\log_{10}(h) = -\\log_{10}(2.778277... \\times 10^{-10})$$\n$$\\mathrm{pH} \\approx 9.55622...$$\n按要求将结果四舍五入至四位有效数字：\n$$\\mathrm{pH} = 9.556$$\n这个结果证实了溶液是碱性的，并且 $\\mathrm{H^+}$ 的浓度确实非常小，从而验证了为简化三次方程所做的近似是有效的。",
            "answer": "$$\\boxed{9.556}$$"
        },
        {
            "introduction": "在掌握了基本技能之后，下一个练习将探讨同离子效应在一个更复杂且具有生物学意义的多质子体系——磷酸盐缓冲液中的应用。您将运用同样的质量与电荷守恒基本原理，推导在加入同离子后控制pH的控制方程。这个实践突出了如何处理具有多个相互作用平衡的系统。",
            "id": "2958765",
            "problem": "在温度$25\\,^{\\circ}\\mathrm{C}$下，使用共轭酸碱对磷酸二氢根$\\mathrm{H_2PO_4^-}$和磷酸氢根$\\mathrm{HPO_4^{2-}}$制备一种缓冲溶液。最初，$1.000\\,\\mathrm{L}$的溶液中含有总分析浓度为$0.0500\\,\\mathrm{mol\\,L^{-1}}$的磷酸盐，该浓度在$\\mathrm{NaH_2PO_4}$和$\\mathrm{Na_2HPO_4}$之间平分，因此$\\mathrm{H_2PO_4^-}$的分析浓度为$0.0250\\,\\mathrm{mol\\,L^{-1}}$，$\\mathrm{HPO_4^{2-}}$的分析浓度为$0.0250\\,\\mathrm{mol\\,L^{-1}}$。随后，向溶液中加入$0.01000\\,\\mathrm{mol}$的固体$\\mathrm{Na_2HPO_4}$，其溶解后溶液体积无明显变化。\n\n假设溶液为理想溶液行为（活度系数等于$1$）。在此$\\mathrm{pH}$下，仅使用第二级解离平衡\n$$\\mathrm{H_2PO_4^- \\rightleftharpoons H^+ + HPO_4^{2-}},$$\n来分析该磷酸盐体系，其在$25\\,^{\\circ}\\mathrm{C}$时的热力学酸度常数$K_{a2}$为$K_{a2} = 6.17 \\times 10^{-8}$。忽略$\\mathrm{H_3PO_4}$和$\\mathrm{PO_4^{3-}}$的贡献。水的离子积为$K_{w} = 1.000 \\times 10^{-14}$。\n\n从化学平衡、磷酸盐的物料守恒和电荷平衡等基本关系出发，推导最终溶液中氢离子浓度$[\\mathrm{H^+}]$的控制方程，并数值计算$\\mathrm{pH}$值。将您的$\\mathrm{pH}$值四舍五入到四位有效数字。将$\\mathrm{pH}$报告为无量纲的数值。",
            "solution": "问题陈述已经过验证，被认为是化学平衡领域中一个良定且科学合理的问题。我们现在将进行严谨的推导和求解。\n\n任务是确定在加入共轭碱后缓冲溶液的最终$\\mathrm{pH}$值。我们必须从基本原理出发，推导氢离子浓度$[\\mathrm{H^+}]$的控制方程。\n\n首先，我们确定共轭酸碱对的最终分析浓度。初始溶液体积为$V = 1.000\\,\\mathrm{L}$。初始分析浓度为$[\\mathrm{H_2PO_4^-}]_{formal, i} = 0.0250\\,\\mathrm{mol\\,L^{-1}}$和$[\\mathrm{HPO_4^{2-}}]_{formal, i} = 0.0250\\,\\mathrm{mol\\,L^{-1}}$。加入的固体$\\mathrm{Na_2HPO_4}$的量为$n_{add} = 0.01000\\,\\mathrm{mol}$。由于体积恒定，这使得磷酸氢根的分析浓度增加了$\\Delta C = \\frac{n_{add}}{V} = \\frac{0.01000\\,\\mathrm{mol}}{1.000\\,\\mathrm{L}} = 0.01000\\,\\mathrm{mol\\,L^{-1}}$。\n\n最终分析浓度，我们将其记为酸组分($\\mathrm{H_2PO_4^-}$)的$C_A$和碱组分($\\mathrm{HPO_4^{2-}}$)的$C_B$，分别为：\n$$ C_A = [\\mathrm{H_2PO_4^-}]_{formal} = 0.0250\\,\\mathrm{mol\\,L^{-1}} $$\n$$ C_B = [\\mathrm{HPO_4^{2-}}]_{formal} = 0.0250\\,\\mathrm{mol\\,L^{-1}} + 0.01000\\,\\mathrm{mol\\,L^{-1}} = 0.0350\\,\\mathrm{mol\\,L^{-1}} $$\n\n溶液中存在的物种有$\\mathrm{H_2O}$、$\\mathrm{H^+}$、$\\mathrm{OH^-}$、$\\mathrm{Na^+}$、$\\mathrm{H_2PO_4^-}$和$\\mathrm{HPO_4^{2-}}$。根据问题陈述，忽略了$\\mathrm{H_3PO_4}$和$\\mathrm{PO_4^{3-}}$物种。\n\n该体系由三个基本关系支配：两个平衡条件、一个物料守恒条件和一个电荷平衡条件。\n\n1.  平衡关系：\n弱酸$\\mathrm{H_2PO_4^-}$的解离和水的自偶电离是相关的平衡：\n$$ \\mathrm{H_2PO_4^- \\rightleftharpoons H^+ + HPO_4^{2-}} \\quad \\implies \\quad K_{a2} = \\frac{[\\mathrm{H^+}][\\mathrm{HPO_4^{2-}}]}{[\\mathrm{H_2PO_4^-}]} = 6.17 \\times 10^{-8} $$\n$$ \\mathrm{H_2O \\rightleftharpoons H^+ + OH^-} \\quad \\implies \\quad K_{w} = [\\mathrm{H^+}][\\mathrm{OH^-}] = 1.000 \\times 10^{-14} $$\n\n2.  磷酸盐的物料守恒：\n所有形式的磷酸盐物种的总浓度必须等于所添加磷酸盐的分析浓度之和。\n$$ [\\mathrm{H_2PO_4^-}] + [\\mathrm{HPO_4^{2-}}] = C_A + C_B = 0.0250 + 0.0350 = 0.0600\\,\\mathrm{mol\\,L^{-1}} $$\n\n3.  电荷平衡（电中性）：\n正电荷总浓度必须等于负电荷总浓度。钠离子浓度$[\\mathrm{Na^+}]$由盐$\\mathrm{NaH_2PO_4}$和$\\mathrm{Na_2HPO_4}$的分析浓度确定。每摩尔来自$\\mathrm{NaH_2PO_4}$的$\\mathrm{H_2PO_4^-}$对应一摩尔的$\\mathrm{Na^+}$。每摩尔来自$\\mathrm{Na_2HPO_4}$的$\\mathrm{HPO_4^{2-}}$对应两摩尔的$\\mathrm{Na^+}$。\n$$ [\\mathrm{Na^+}] = C_A + 2C_B = 0.0250 + 2(0.0350) = 0.0250 + 0.0700 = 0.0950\\,\\mathrm{mol\\,L^{-1}} $$\n电荷平衡方程为：\n$$ [\\mathrm{Na^+}] + [\\mathrm{H^+}] = [\\mathrm{OH^-}] + [\\mathrm{H_2PO_4^-}] + 2[\\mathrm{HPO_4^{2-}}] $$\n\n为了推导$[\\mathrm{H^+}]$的控制方程，我们结合这些关系。将$[\\mathrm{Na^+}]$的表达式代入电荷平衡方程：\n$$ (C_A + 2C_B) + [\\mathrm{H^+}] = [\\mathrm{OH^-}] + [\\mathrm{H_2PO_4^-}] + 2[\\mathrm{HPO_4^{2-}}] $$\n根据物料守恒，我们可以将$[\\mathrm{H_2PO_4^-}]$表示为$[\\mathrm{H_2PO_4^-}] = (C_A + C_B) - [\\mathrm{HPO_4^{2-}}]$。将此式代入前一个方程得到：\n$$ (C_A + 2C_B) + [\\mathrm{H^+}] = [\\mathrm{OH^-}] + \\left( (C_A + C_B) - [\\mathrm{HPO_4^{2-}}] \\right) + 2[\\mathrm{HPO_4^{2-}}] $$\n合并同类项简化此表达式：\n$$ C_A + 2C_B + [\\mathrm{H^+}] = [\\mathrm{OH^-}] + C_A + C_B + [\\mathrm{HPO_4^{2-}}] $$\n$$ C_B + [\\mathrm{H^+}] - [\\mathrm{OH^-}] = [\\mathrm{HPO_4^{2-}}] $$\n这个强大的关系式将碱的分析浓度与参与质子转移的物种的平衡浓度联系起来。现在，我们将$[\\mathrm{OH^-}]$和$[\\mathrm{HPO_4^{2-}}]$表示为$[\\mathrm{H^+}]$的函数。\n根据水的自偶电离，我们有$[\\mathrm{OH^-}] = \\frac{K_w}{[\\mathrm{H^+}]}$。\n从物料守恒和$K_{a2}$表达式，我们可以推导出$[\\mathrm{HPO_4^{2-}}]$的表达式：\n$$ [\\mathrm{H_2PO_4^-}] = \\frac{[\\mathrm{H^+}][\\mathrm{HPO_4^{2-}}]}{K_{a2}} $$\n$$ \\frac{[\\mathrm{H^+}][\\mathrm{HPO_4^{2-}}]}{K_{a2}} + [\\mathrm{HPO_4^{2-}}] = C_A + C_B $$\n$$ [\\mathrm{HPO_4^{2-}}] \\left( \\frac{[\\mathrm{H^+}]}{K_{a2}} + 1 \\right) = C_A + C_B $$\n$$ [\\mathrm{HPO_4^{2-}}] = \\frac{K_{a2}(C_A + C_B)}{[\\mathrm{H^+}] + K_{a2}} $$\n将这些$[\\mathrm{OH^-}]$和$[\\mathrm{HPO_4^{2-}}]$的表达式代入我们推导出的关系式$C_B + [\\mathrm{H^+}] - [\\mathrm{OH^-}] = [\\mathrm{HPO_4^{2-}}]$，得到$[\\mathrm{H^+}]$的最终控制方程：\n$$ C_B + [\\mathrm{H^+}] - \\frac{K_w}{[\\mathrm{H^+}]} = \\frac{K_{a2}(C_A + C_B)}{[\\mathrm{H^+}] + K_{a2}} $$\n在所述假设下，该方程是精确的。它是一个关于$[\\mathrm{H^+}]$的三次多项式。\n\n为了计算$\\mathrm{pH}$值，我们必须解这个关于$[\\mathrm{H^+}]$的方程。设$x = [\\mathrm{H^+}]$。\n$$ 0.0350 + x - \\frac{1.000 \\times 10^{-14}}{x} = \\frac{(6.17 \\times 10^{-8})(0.0600)}{x + 6.17 \\times 10^{-8}} $$\n可以从Henderson-Hasselbalch方程得到一个很好的$x$的初始近似值，该方程假设$[\\mathrm{H^+}] \\ll C_A, C_B$且$[\\mathrm{OH^-}] \\ll C_A, C_B$：$[\\mathrm{H^+}] \\approx K_{a2} \\frac{C_A}{C_B} = (6.17 \\times 10^{-8}) \\frac{0.0250}{0.0350} \\approx 4.407 \\times 10^{-8}\\,\\mathrm{M}$。\n我们可以将这个值作为更精确方程迭代解的初始值：\n$$ x = K_{a2} \\frac{C_A - x + K_w/x}{C_B + x - K_w/x} $$\n从$x_0 = 4.40714 \\times 10^{-8}$开始，迭代快速收敛。\n我们来计算修正项$x - K_w/x$：\n$x_0 - K_w/x_0 = 4.40714 \\times 10^{-8} - \\frac{1.000 \\times 10^{-14}}{4.40714 \\times 10^{-8}} = 4.40714 \\times 10^{-8} - 2.26901 \\times 10^{-7} = -1.82829 \\times 10^{-7}$。\n下一次迭代给出：\n$$ x_1 = (6.17 \\times 10^{-8}) \\frac{0.0250 - (-1.82829 \\times 10^{-7})}{0.0350 + (-1.82829 \\times 10^{-7})} = (6.17 \\times 10^{-8}) \\frac{0.025000183}{0.034999817} \\approx 4.40719 \\times 10^{-8} $$\n该值已经收敛。平衡氢离子浓度为$[\\mathrm{H^+}] = 4.40719 \\times 10^{-8}\\,\\mathrm{mol\\,L^{-1}}$。\n\n最后，我们计算$\\mathrm{pH}$值：\n$$ \\mathrm{pH} = -\\log_{10}([\\mathrm{H^+}]) = -\\log_{10}(4.40719 \\times 10^{-8}) \\approx 7.355845 $$\n题目要求将$\\mathrm{pH}$值四舍五入到四位有效数字。\n$$ \\mathrm{pH} \\approx 7.356 $$",
            "answer": "$$\\boxed{7.356}$$"
        },
        {
            "introduction": "这项最终的高级实践将理论模型与实验现实联系起来。您将开发一个计算模型来预测$\\mathrm{pH}$，然后用它来解决一个反问题：从一组模拟的含噪声$\\mathrm{pH}$测量数据中估计酸解离常数（$K_a$）。本练习将向您介绍参数估计和不确定性量化的强大技术，这些都是现代化学研究中不可或缺的技能。",
            "id": "2958712",
            "problem": "一元弱酸溶液在温度为 $25\\,^{\\circ}\\mathrm{C}$ 时制备，具有固定的分析酸浓度，然后通过加入已知分析量的、可提供共轭碱（同离子）的其钠盐来进行滴定。假设为理想行为（活度系数等于 $1$）且纯水发生自电离，其离子积 $K_{\\mathrm{w}} = 1.0\\times 10^{-14}$。酸解离反应为 $\\mathrm{HA} \\rightleftharpoons \\mathrm{H^+} + \\mathrm{A^-}$，其未知的热力学酸解离常数 $K_{\\mathrm{a}}$ 有待估计。\n\n使用的基本原理：\n- 酸家族的物料平衡：携带酸原子平衡的所有物种的总浓度是分析酸浓度和加入的共轭碱浓度之和。如果 $C_{\\mathrm{HA}}$ 是初始存在的弱酸的分析浓度，$C_{\\mathrm{salt}}$ 是加入的共轭碱钠盐的分析浓度，则总酸家族浓度为 $C_{\\mathrm{T}} = C_{\\mathrm{HA}} + C_{\\mathrm{salt}}$，且物种满足 $[\\mathrm{HA}] + [\\mathrm{A^-}] = C_{\\mathrm{T}}$。\n- 电荷平衡（电中性）：正电荷的总和等于负电荷的总和，包括来自 $\\mathrm{H^+}$、$\\mathrm{OH^-}$、共轭碱 $\\mathrm{A^-}$ 以及来自盐添加的钠抗衡离子的贡献。\n- 解离的质量作用定律：$K_{\\mathrm{a}} = \\dfrac{[\\mathrm{H^+}][\\mathrm{A^-}]}{[\\mathrm{HA}]}$。\n- 水的自电离：$K_{\\mathrm{w}} = [\\mathrm{H^+}][\\mathrm{OH^-}]$。\n\n测量数据由 $N$ 对 $\\{(C_{\\mathrm{salt},i}, \\mathrm{pH}_i^{\\mathrm{(meas)}})\\}_{i=1}^N$ 组成，其中 $C_{\\mathrm{HA}}$ 固定，每个 $\\mathrm{pH}_i^{\\mathrm{(meas)}}$ 是通过向真实模型 $\\mathrm{pH}_i^{\\mathrm{(true)}} = -\\log_{10}([\\mathrm{H^+}]_i)$ 添加独立同分布的零均值高斯噪声（以 $\\mathrm{pH}$ 单位计）而获得的，该噪声具有已知的标准差。真实模型 $\\mathrm{pH}$ 由上述原理根据给定的 $K_{\\mathrm{a}}$、$C_{\\mathrm{HA}}$ 和 $C_{\\mathrm{salt},i}$ 预测。\n\n任务：\n1) 仅从上述基本定律和定义出发，建立一个正向模型，对于任何给定的 $K_{\\mathrm{a}}$、$C_{\\mathrm{HA}}$、$C_{\\mathrm{salt}}$ 和 $K_{\\mathrm{w}}$，计算 $[\\mathrm{H^+}]$ 的物理有效正实根，并返回 $\\mathrm{pH} = -\\log_{10}([\\mathrm{H^+}])$。\n2) 给定由已知真实参数生成的含噪声 $\\mathrm{pH}$ 数据，通过最小化非线性最小二乘目标函数来估计 $K_{\\mathrm{a}}$：\n$$\nS(K_{\\mathrm{a}}) = \\sum_{i=1}^N \\left(\\mathrm{pH}_i^{\\mathrm{(meas)}} - \\mathrm{pH}_i^{\\mathrm{(model)}}(K_{\\mathrm{a}})\\right)^2,\n$$\n受限于 $K_{\\mathrm{a}} > 0$。使用一种能保证正性且搜索域为有界一维的参数化方法。\n3) 使用针对 $\\mathrm{pH}$ 中独立同分布高斯误差（方差为 $\\sigma^2$）的费雪信息方法，计算对数参数化 $\\theta = \\ln K_{\\mathrm{a}}$ 中单个参数的费雪信息：\n$$\n\\mathcal{I}(\\theta) = \\frac{1}{\\sigma^2}\\sum_{i=1}^N \\left(\\frac{\\partial \\mathrm{pH}_i^{\\mathrm{(model)}}}{\\partial \\theta}\\right)^2,\n$$\n在估计量 $\\hat{\\theta}$ 处对其求值，并报告通过将 $\\theta$ 的正态近似变换回原始尺度而获得的 $K_{\\mathrm{a}}$ 的近似 $95\\%$ 置信区间。使用数值稳定的方法计算 $\\frac{\\partial \\mathrm{pH}_i^{\\mathrm{(model)}}}{\\partial \\theta}$。\n4) 对于每个测试案例，按顺序输出一个包含三个科学记数法浮点数的列表：估计的 $K_{\\mathrm{a}}$、$K_{\\mathrm{a}}$ 的近似 $95\\%$ 置信区间下界和近似 $95\\%$ 置信区间上界。\n\n数据生成协议（必须严格遵守以确保可测试性）：\n- 对所有案例，使用 $K_{\\mathrm{w}} = 1.0\\times 10^{-14}$ 和固定的随机种子 $2025$。\n- 通过向无噪声的模型 $\\mathrm{pH}$ 添加具有零均值和指定标准差 $\\sigma_{\\mathrm{pH}}$（以 $\\mathrm{pH}$ 单位计）的独立高斯噪声，生成含噪声的 $\\mathrm{pH}$ 测量值。\n- 对于每个测试案例，使用真实值 $K_{\\mathrm{a}}^{(\\mathrm{true})}$、指定的 $C_{\\mathrm{HA}}$ 和 $C_{\\mathrm{salt}}$ 值列表计算“真实”$\\mathrm{pH}$ 值，然后添加噪声。\n\n要实现的测试套件：\n- 案例 A（理想路径）：$K_{\\mathrm{a}}^{(\\mathrm{true})} = 1.8\\times 10^{-5}$，$C_{\\mathrm{HA}} = 1.0\\times 10^{-2}$，$C_{\\mathrm{salt}} \\in \\{0.0, 1.0\\times 10^{-3}, 3.0\\times 10^{-3}, 1.0\\times 10^{-2}, 3.0\\times 10^{-2}\\}$，$\\sigma_{\\mathrm{pH}} = 2.0\\times 10^{-3}$。\n- 案例 B（极弱酸体系，水的电离很重要）：$K_{\\mathrm{a}}^{(\\mathrm{true})} = 1.0\\times 10^{-8}$，$C_{\\mathrm{HA}} = 1.0\\times 10^{-3}$，$C_{\\mathrm{salt}} \\in \\{0.0, 3.0\\times 10^{-4}, 1.0\\times 10^{-3}, 3.0\\times 10^{-3}\\}$，$\\sigma_{\\mathrm{pH}} = 2.0\\times 10^{-3}$。\n- 案例 C（强同离子效应）：$K_{\\mathrm{a}}^{(\\mathrm{true})} = 1.0\\times 10^{-6}$，$C_{\\mathrm{HA}} = 5.0\\times 10^{-3}$，$C_{\\mathrm{salt}} \\in \\{0.0, 5.0\\times 10^{-2}, 1.0\\times 10^{-1}, 2.0\\times 10^{-1}\\}$，$\\sigma_{\\mathrm{pH}} = 2.0\\times 10^{-3}$。\n\n计算和报告细节：\n- 对于每个案例，使 $N$ 等于所列 $C_{\\mathrm{salt}}$ 值的数量。\n- 对于最小二乘拟合，通过 $\\theta = \\ln K_{\\mathrm{a}}$ 进行参数化，并在有界区间 $\\theta \\in [\\ln(10^{-12}), \\ln(1)]$ 中搜索。\n- 通过无偏残差方差 $\\hat{\\sigma}^2 = \\dfrac{\\mathrm{RSS}}{N - 1}$ 来估计 $\\sigma^2$，其中 $\\mathrm{RSS}$ 是在最小化点的残差平方和，并且只有一个拟合参数。\n- 使用数值稳定的中心差分近似来计算灵敏度 $\\dfrac{\\partial \\mathrm{pH}_i^{\\mathrm{(model)}}}{\\partial \\theta}$，并以较小的步长在 $\\theta$ 中计算其费雪信息 $\\mathcal{I}(\\hat{\\theta})$。\n- 首先获得基于正态分布的 $\\theta$ 的区间，构造一个近似的 $K_{\\mathrm{a}}$ 的 $95\\%$ 置信区间：\n$$\n\\hat{\\theta} \\pm 1.96 \\sqrt{\\mathcal{I}(\\hat{\\theta})^{-1}},\n$$\n然后通过指数函数将其端点映射回 $K_{\\mathrm{a}}$。\n- 最终输出格式：您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。每个测试案例贡献一个子列表，其中包含三个科学记数法表示的值（精确到六位有效数字），顺序为 $[K_{\\mathrm{a}}^{(\\mathrm{est})}, K_{\\mathrm{a}}^{(\\mathrm{lo95})}, K_{\\mathrm{a}}^{(\\mathrm{hi95})}]$。例如：[[1.234567e-05,1.111111e-05,1.358024e-05],[...],[...]]。",
            "solution": "所呈现的问题是在化学平衡建模、参数估计和统计不确定性量化方面的一个综合性练习。它在科学上是合理的、良态的，并要求严格应用基本原理。我们将继续进行推导和求解。\n\n解决方案分为三个部分：\n1.  推导用于计算氢离子浓度 $[\\mathrm{H^+}]$ 并进而计算 $\\mathrm{pH}$ 的正向模型。\n2.  阐述通过非线性最小二乘法估计酸解离常数 $K_{\\mathrm{a}}$ 的反问题。\n3.  建立使用费雪信息矩阵确定估计的 $K_{\\mathrm{a}}$ 的置信区间的统计框架。\n\n首先，我们必须构建正向模型，该模型为给定的一组参数 $\\{K_{\\mathrm{a}}, C_{\\mathrm{HA}}, C_{\\mathrm{salt}}, K_{\\mathrm{w}}\\}$ 预测 $\\mathrm{pH}$。我们从提供的四个基本平衡关系开始：\n1.  酸/碱共轭对的物料平衡：$[\\mathrm{HA}] + [\\mathrm{A^-}] = C_{\\mathrm{T}}$，其中 $C_{\\mathrm{T}} = C_{\\mathrm{HA}} + C_{\\mathrm{salt}}$。\n2.  电荷平衡（电中性）：$[\\mathrm{Na^+}] + [\\mathrm{H^+}] = [\\mathrm{A^-}] + [\\mathrm{OH^-}]$。由于钠盐是同离子 $\\mathrm{A^-}$ 和抗衡离子 $\\mathrm{Na^+}$ 的来源，我们有 $[\\mathrm{Na^+}] = C_{\\mathrm{salt}}$。\n3.  酸解离平衡：$K_{\\mathrm{a}} = \\dfrac{[\\mathrm{H^+}][\\mathrm{A^-}]}{[\\mathrm{HA}]}$。\n4.  水的自电离平衡：$K_{\\mathrm{w}} = [\\mathrm{H^+}][\\mathrm{OH^-}]$。\n\n让我们将氢离子浓度表示为 $h \\equiv [\\mathrm{H^+}]$。我们的目标是推导出一个关于 $h$ 的单一方程。从水的自电离平衡（4）中，我们将氢氧根浓度表示为 $[\\mathrm{OH^-}] = K_{\\mathrm{w}}/h$。将此式和 $[\\mathrm{Na^+}] = C_{\\mathrm{salt}}$ 代入电荷平衡方程（2），我们可以用 $h$ 来表示共轭碱浓度 $[\\mathrm{A^-}]$：\n$$\nC_{\\mathrm{salt}} + h = [\\mathrm{A^-}] + \\frac{K_{\\mathrm{w}}}{h} \\implies [\\mathrm{A^-}] = C_{\\mathrm{salt}} + h - \\frac{K_{\\mathrm{w}}}{h}\n$$\n接下来，我们使用酸解离（3）和物料平衡（1）关系来找到 $[\\mathrm{A^-}]$ 的另一个表达式。从（3）中，$[\\mathrm{HA}] = \\frac{h[\\mathrm{A^-}]}{K_{\\mathrm{a}}}$。将其代入（1）：\n$$\n\\frac{h[\\mathrm{A^-}]}{K_{\\mathrm{a}}} + [\\mathrm{A^-}] = C_{\\mathrm{T}} \\implies [\\mathrm{A^-}]\\left(\\frac{h}{K_{\\mathrm{a}}}+1\\right) = C_{\\mathrm{T}} \\implies [\\mathrm{A^-}] = C_{\\mathrm{T}}\\left(\\frac{K_{\\mathrm{a}}}{h+K_{\\mathrm{a}}}\\right)\n$$\n将两个关于 $[\\mathrm{A^-}]$ 的表达式相等，得到 $h$ 的控制方程：\n$$\nC_{\\mathrm{salt}} + h - \\frac{K_{\\mathrm{w}}}{h} = (C_{\\mathrm{HA}} + C_{\\mathrm{salt}})\\left(\\frac{K_{\\mathrm{a}}}{h+K_{\\mathrm{a}}}\\right)\n$$\n为了求解 $h$，我们通过将所有项乘以 $h(h+K_{\\mathrm{a}})$ 将其重新排列成多项式形式：\n$$\n(C_{\\mathrm{salt}} + h)h(h+K_{\\mathrm{a}}) - K_{\\mathrm{w}}(h+K_{\\mathrm{a}}) = (C_{\\mathrm{HA}} + C_{\\mathrm{salt}})K_{\\mathrm{a}}h\n$$\n展开并收集 $h$ 的各次幂项：\n$$\nh^3 + (K_{\\mathrm{a}} + C_{\\mathrm{salt}})h^2 - (K_{\\mathrm{a}}C_{\\mathrm{HA}} + K_{\\mathrm{w}})h - K_{\\mathrm{a}}K_{\\mathrm{w}} = 0\n$$\n这是关于 $h=[\\mathrm{H^+}]$ 的三次方程。对于任何物理上现实的一组正参数 $\\{K_{\\mathrm{a}}, C_{\\mathrm{HA}}, C_{\\mathrm{salt}}, K_{\\mathrm{w}}\\}$，该多项式恰好有一个正实根。这可以通过对系数 $(1, K_{\\mathrm{a}}+C_{\\mathrm{salt}}, -(K_{\\mathrm{a}}C_{\\mathrm{HA}}+K_{\\mathrm{w}}), -K_{\\mathrm{a}}K_{\\mathrm{w}})$ 使用笛卡尔符号法则来证实，其符号模式为 $(+, +, -, -)$，表示只有一个符号变化，因此只有一个正根。这个唯一的正根是物理上有效的浓度 $[\\mathrm{H^+}]$。通过计算 $\\mathrm{pH} = -\\log_{10}(h)$ 完成正向模型。\n\n第二，我们解决估计 $K_{\\mathrm{a}}$ 的反问题。我们给定 $N$ 对数据 $\\{(C_{\\mathrm{salt},i}, \\mathrm{pH}_i^{\\mathrm{(meas)}})\\}_{i=1}^N$。通过最小化测量到的 $\\mathrm{pH}$ 与模型预测的 $\\mathrm{pH}$ 之间的残差平方和（RSS）来进行估计：\n$$\nS(K_{\\mathrm{a}}) = \\sum_{i=1}^N \\left(\\mathrm{pH}_i^{\\mathrm{(meas)}} - \\mathrm{pH}_i^{\\mathrm{(model)}}(K_{\\mathrm{a}}, C_{\\mathrm{HA}}, C_{\\mathrm{salt},i})\\right)^2\n$$\n为了强制执行物理约束 $K_{\\mathrm{a}} > 0$ 并提高优化的数值稳定性，我们进行变量替换为 $\\theta = \\ln K_{\\mathrm{a}}$，因此 $K_{\\mathrm{a}} = e^{\\theta}$。优化问题变为找到最小化以下函数的 $\\hat{\\theta}$：\n$$\nS(\\theta) = \\sum_{i=1}^N \\left(\\mathrm{pH}_i^{\\mathrm{(meas)}} - \\mathrm{pH}_i^{\\mathrm{(model)}}(e^{\\theta}, C_{\\mathrm{HA}}, C_{\\mathrm{salt},i})\\right)^2\n$$\n这是一个在指定的有界域 $\\theta \\in [\\ln(10^{-12}), \\ln(1)]$ 上的一维优化问题，可以使用诸如 Brent 方法之类的数值方法高效求解。然后 $K_{\\mathrm{a}}$ 的估计值为 $\\hat{K}_{\\mathrm{a}} = e^{\\hat{\\theta}}$。\n\n第三，我们构建估计值 $\\hat{K}_{\\mathrm{a}}$ 的置信区间。对于测量变量（$\\mathrm{pH}$）中独立同分布的高斯误差，参数估计量 $\\hat{\\theta}$ 的方差可以由克拉默-拉奥下界来近似，该下界是费雪信息的倒数，$\\mathcal{I}(\\theta)$。单个参数 $\\theta$ 的费雪信息由下式给出：\n$$\n\\mathcal{I}(\\theta) = \\frac{1}{\\sigma^2}\\sum_{i=1}^N \\left(\\frac{\\partial \\mathrm{pH}_i^{\\mathrm{(model)}}}{\\partial \\theta}\\right)^2\n$$\n此处，$\\sigma^2$ 是以 $\\mathrm{pH}$ 单位计的测量噪声的方差。由于 $\\sigma^2$ 未知，它通过拟合的残差来估计：$\\hat{\\sigma}^2 = \\frac{\\mathrm{RSS}_{\\min}}{N-p}$，其中 $\\mathrm{RSS}_{\\min} = S(\\hat{\\theta})$ 是最小残差平方和，$p=1$ 是拟合参数的数量。灵敏度导数 $\\frac{\\partial \\mathrm{pH}}{\\partial \\theta}$ 在最优值 $\\hat{\\theta}$ 处使用对称中心差分公式进行数值计算以保证稳定性：\n$$\n\\frac{\\partial \\mathrm{pH}_i^{\\mathrm{(model)}}}{\\partial \\theta} \\approx \\frac{\\mathrm{pH}_i^{\\mathrm{(model)}}(e^{\\hat{\\theta}+\\delta}) - \\mathrm{pH}_i^{\\mathrm{(model)}}(e^{\\hat{\\theta}-\\delta})}{2\\delta}\n$$\n对于一个小的步长 $\\delta$。然后在估计值处评估费雪信息：$\\mathcal{I}(\\hat{\\theta}) = \\frac{1}{\\hat{\\sigma}^2}\\sum_{i=1}^N \\left(\\frac{\\partial \\mathrm{pH}_i}{\\partial \\theta}\\right)^2_{\\theta=\\hat{\\theta}}$。估计量 $\\hat{\\theta}$ 的标准误差是 $\\mathrm{se}(\\hat{\\theta}) = \\sqrt{\\mathcal{I}(\\hat{\\theta})^{-1}}$。$\\theta$ 的近似 $95\\%$ 置信区间是 $[\\theta_{\\mathrm{lo}}, \\theta_{\\mathrm{hi}}] = [\\hat{\\theta} - 1.96 \\cdot \\mathrm{se}(\\hat{\\theta}), \\hat{\\theta} + 1.96 \\cdot \\mathrm{se}(\\hat{\\theta})]$。通过将该区间的端点转换回原始参数空间，我们得到 $K_{\\mathrm{a}}$ 的 $95\\%$ 置信区间：\n$$\n[K_{\\mathrm{a},\\mathrm{lo95}}, K_{\\mathrm{a},\\mathrm{hi95}}] = [e^{\\theta_{\\mathrm{lo}}}, e^{\\theta_{\\mathrm{hi}}}]\n$$\n这就完成了理论框架。实现将为每个测试案例精确地遵循这些步骤。",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import minimize_scalar\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    It generates data, estimates Ka, computes confidence intervals,\n    and prints the formatted results.\n    \"\"\"\n    K_w = 1.0e-14\n    random_seed = 2025\n\n    test_cases = [\n        { # Case A\n            \"Ka_true\": 1.8e-5, \"C_HA\": 1.0e-2,\n            \"C_salt_list\": [0.0, 1.0e-3, 3.0e-3, 1.0e-2, 3.0e-2],\n            \"sigma_pH\": 2.0e-3\n        },\n        { # Case B\n            \"Ka_true\": 1.0e-8, \"C_HA\": 1.0e-3,\n            \"C_salt_list\": [0.0, 3.0e-4, 1.0e-3, 3.0e-3],\n            \"sigma_pH\": 2.0e-3\n        },\n        { # Case C\n            \"Ka_true\": 1.0e-6, \"C_HA\": 5.0e-3,\n            \"C_salt_list\": [0.0, 5.0e-2, 1.0e-1, 2.0e-1],\n            \"sigma_pH\": 2.0e-3\n        },\n    ]\n\n    all_results = []\n    for case in test_cases:\n        Ka_est, Ka_lo, Ka_hi = solve_case(\n            Ka_true=case[\"Ka_true\"],\n            C_HA=case[\"C_HA\"],\n            C_salt_list=np.array(case[\"C_salt_list\"]),\n            sigma_pH=case[\"sigma_pH\"],\n            K_w=K_w,\n            seed=random_seed\n        )\n        all_results.append([f\"{Ka_est:.6e}\", f\"{Ka_lo:.6e}\", f\"{Ka_hi:.6e}\"])\n\n    # Format output as a list of lists\n    formatted_output = \",\".join([f\"[{','.join(res)}]\" for res in all_results])\n    print(f\"[{formatted_output}]\")\n\n\ndef forward_model(Ka, C_HA, C_salt, K_w):\n    \"\"\"\n    Computes the pH for given system parameters by solving the cubic equation for [H+].\n    \"\"\"\n    if Ka <= 0:\n        return np.nan\n\n    # Coefficients of the cubic equation: h^3 + a2*h^2 + a1*h + a0 = 0\n    a2 = Ka + C_salt\n    a1 = -(Ka * C_HA + K_w)\n    a0 = -(Ka * K_w)\n    coeffs = [1, a2, a1, a0]\n\n    roots = np.roots(coeffs)\n    \n    # Find the unique positive real root\n    positive_real_roots = roots[(np.isreal(roots)) & (roots > 0)].real\n    if len(positive_real_roots) != 1:\n        # Fallback for numerical instability, though not expected here\n        return np.nan\n        \n    h_plus = positive_real_roots[0]\n    return -np.log10(h_plus)\n\n\ndef solve_case(Ka_true, C_HA, C_salt_list, sigma_pH, K_w, seed):\n    \"\"\"\n    Solves a single test case: data generation, optimization, and CI calculation.\n    \"\"\"\n    rng = np.random.default_rng(seed)\n    N = len(C_salt_list)\n\n    # 1. Data Generation\n    pH_true = np.array([forward_model(Ka_true, C_HA, cs, K_w) for cs in C_salt_list])\n    noise = rng.normal(0, sigma_pH, size=N)\n    pH_measured = pH_true + noise\n\n    # 2. Parameter Estimation (Nonlinear Least Squares)\n    def objective_function(theta):\n        Ka = np.exp(theta)\n        pH_model = np.array([forward_model(Ka, C_HA, cs, K_w) for cs in C_salt_list])\n        if np.isnan(pH_model).any():\n            return np.inf  # Penalize invalid Ka values\n        return np.sum((pH_measured - pH_model)**2)\n\n    # Bounded 1D optimization for theta = ln(Ka)\n    bounds = (np.log(1e-12), np.log(1))\n    result = minimize_scalar(objective_function, bounds=bounds, method='bounded')\n\n    theta_hat = result.x\n    Ka_hat = np.exp(theta_hat)\n    rss_min = result.fun\n\n    # 3. Confidence Interval Calculation\n    # Estimate noise variance\n    sigma2_hat = rss_min / (N - 1)\n    \n    # Calculate sensitivities (dpH/dtheta) using central differences\n    delta = 1e-7 # Small step for numerical derivative\n    \n    Ka_upper = np.exp(theta_hat + delta)\n    Ka_lower = np.exp(theta_hat - delta)\n    \n    ph_upper = np.array([forward_model(Ka_upper, C_HA, cs, K_w) for cs in C_salt_list])\n    ph_lower = np.array([forward_model(Ka_lower, C_HA, cs, K_w) for cs in C_salt_list])\n\n    dpH_dtheta = (ph_upper - ph_lower) / (2 * delta)\n\n    # Calculate Fisher Information\n    fisher_info = np.sum(dpH_dtheta**2) / sigma2_hat\n\n    # 95% CI for theta\n    se_theta = np.sqrt(1 / fisher_info)\n    z_score = 1.96 # For 95% CI\n    theta_lo = theta_hat - z_score * se_theta\n    theta_hi = theta_hat + z_score * se_theta\n\n    # Transform CI back to Ka scale\n    Ka_lo95 = np.exp(theta_lo)\n    Ka_hi95 = np.exp(theta_hi)\n\n    return Ka_hat, Ka_lo95, Ka_hi95\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}