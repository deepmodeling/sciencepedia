{
    "hands_on_practices": [
        {
            "introduction": "在定量分析任何复杂化学平衡体系时，首要且最关键的步骤是建立一个准确的数学模型。此练习旨在锻炼一项基本技能：将一个化学系统的文字描述转化为一套完整且正确的数学方程组 。这套方程组基于质量作用定律和质量守恒定律，是进行任何后续计算或预测的必要基础。",
            "id": "2929539",
            "problem": "将二元质子配体 $\\mathrm{H_2L}$ 与化学计量量的二价金属阳离子 $\\mathrm{M^{2+}}$ 一同引入水中。该配体发生逐级酸解离，并且只有完全去质子化的碱 $\\mathrm{L^{2-}}$ 与金属配位形成单核配合物 $\\mathrm{ML}$。假设溶液为理想稀溶液，因此活度等于浓度，忽略任何金属水解和除 $\\mathrm{ML}$ 之外的任何配合物，并忽略与反离子的离子对效应。$\\mathrm{H_2L}$ 的热力学酸解离常数记为 $K_{a1}$ 和 $K_{a2}$，$\\mathrm{ML}$ 的形成常数记为 $K_f$。仅使用质量作用定律和物质守恒，选择一个选项，该选项正确列出了独立的平衡反应及其定义的平衡常数表达式，并给出了由配体和金属的分析总浓度 $C_L^{\\mathrm{T}}$ 和 $C_M^{\\mathrm{T}}$ 制备的溶液中，配体和金属的正确总质量平衡方程。\n\nA. \n平衡：\n$\\mathrm{H_2L} \\rightleftharpoons \\mathrm{H^+} + \\mathrm{HL^-}$，其中 $K_{a1} = \\dfrac{[\\mathrm{H^+}][\\mathrm{HL^-}]}{[\\mathrm{H_2L}]}$；\n$\\mathrm{HL^-} \\rightleftharpoons \\mathrm{H^+} + \\mathrm{L^{2-}}$，其中 $K_{a2} = \\dfrac{[\\mathrm{H^+}][\\mathrm{L^{2-}}]}{[\\mathrm{HL^-}] }$；\n$\\mathrm{M^{2+}} + \\mathrm{L^{2-}} \\rightleftharpoons \\mathrm{ML}$，其中 $K_f = \\dfrac{[\\mathrm{ML}]}{[\\mathrm{M^{2+}}][\\mathrm{L^{2-}}]}$。\n质量平衡：\n$C_L^{\\mathrm{T}} = [\\mathrm{H_2L}] + [\\mathrm{HL^-}] + [\\mathrm{L^{2-}}] + [\\mathrm{ML}]$；\n$C_M^{\\mathrm{T}} = [\\mathrm{M^{2+}}] + [\\mathrm{ML}]$。\n\nB.\n平衡：\n$\\mathrm{H_2L} \\rightleftharpoons \\mathrm{H^+} + \\mathrm{HL^-}$，其中 $K_{a1} = \\dfrac{[\\mathrm{H_2L}]}{[\\mathrm{H^+}][\\mathrm{HL^-}] }$；\n$\\mathrm{HL^-} \\rightleftharpoons \\mathrm{H^+} + \\mathrm{L^{2-}}$，其中 $K_{a2} = \\dfrac{[\\mathrm{HL^-}]}{[\\mathrm{H^+}][\\mathrm{L^{2-}}] }$；\n$\\mathrm{M^{2+}} + \\mathrm{HL^-} \\rightleftharpoons \\mathrm{MHL^+}$，其中 $K_f = \\dfrac{[\\mathrm{MHL^+}]}{[\\mathrm{M^{2+}}][\\mathrm{HL^-}] }$。\n质量平衡：\n$C_L^{\\mathrm{T}} = [\\mathrm{H_2L}] + [\\mathrm{L^{2-}}] + [\\mathrm{MHL^+}]$；\n$C_M^{\\mathrm{T}} = [\\mathrm{M^{2+}}] + [\\mathrm{MHL^+}]$。\n\nC.\n平衡：\n$\\mathrm{H_2L} \\rightleftharpoons \\mathrm{H^+} + \\mathrm{HL^-}$，其中 $K_{a1} = \\dfrac{[\\mathrm{H^+}][\\mathrm{HL^-}]}{[\\mathrm{H_2L}]}$；\n$\\mathrm{HL^-} \\rightleftharpoons \\mathrm{H^+} + \\mathrm{L^{2-}}$，其中 $K_{a2} = \\dfrac{[\\mathrm{H^+}][\\mathrm{L^{2-}}]}{[\\mathrm{HL^-}] }$；\n$\\mathrm{M^{2+}} + \\mathrm{L^{2-}} \\rightleftharpoons \\mathrm{ML}$，其中 $K_f = \\dfrac{[\\mathrm{ML}]}{[\\mathrm{M^{2+}}][\\mathrm{L^{2-}}]}$；\n$\\mathrm{M^{2+}} + \\mathrm{H_2O} \\rightleftharpoons \\mathrm{MOH^+} + \\mathrm{H^+}$，其中 $K_h = \\dfrac{[\\mathrm{MOH^+}][\\mathrm{H^+}]}{[\\mathrm{M^{2+}}]}$。\n质量平衡：\n$C_L^{\\mathrm{T}} = [\\mathrm{H_2L}] + [\\mathrm{HL^-}] + [\\mathrm{L^{2-}}] + [\\mathrm{ML}]$；\n$C_M^{\\mathrm{T}} = [\\mathrm{M^{2+}}] + [\\mathrm{ML}] + [\\mathrm{MOH^+}]$。\n\nD.\n平衡：\n$\\mathrm{H_2L} + \\mathrm{H_2O} \\rightleftharpoons \\mathrm{HL^-} + \\mathrm{H_3O^+}$，其中 $K_{a1} = \\dfrac{[\\mathrm{HL^-}][\\mathrm{H_3O^+}]}{[\\mathrm{H_2L}] }$；\n$\\mathrm{M^{2+}} + \\mathrm{L^{2-}} \\rightleftharpoons \\mathrm{ML}$，其中 $K_f = \\dfrac{[\\mathrm{ML}]}{[\\mathrm{M^{2+}}][\\mathrm{L^{2-}}]}$。\n质量平衡：\n$C_L^{\\mathrm{T}} = [\\mathrm{H_2L}] + [\\mathrm{HL^-}] + [\\mathrm{L^{2-}}]$；\n$C_M^{\\mathrm{T}} = [\\mathrm{M^{2+}}] + [\\mathrm{ML}] + [\\mathrm{L^{2-}}]$。\n\n选择与所述假设完全一致并正确应用质量作用定律和物质守恒的唯一最佳选项。",
            "solution": "此问题要求为一个含有二价金属阳离子 $\\mathrm{M^{2+}}$ 和二元质子配体 $\\mathrm{H_2L}$ 的水溶液体系建立一个完整的化学描述。该描述必须包括所有相关的、独立的平衡反应及其相应的平衡常数表达式，以及配体和金属总浓度的质量平衡方程。分析将在问题陈述中给出的特定约束条件下进行。\n\n首先，我们必须根据问题描述，确定平衡时存在的所有化学物质。二元质子配体 $\\mathrm{H_2L}$ 发生逐级解离，因此会存在 $\\mathrm{H_2L}$、$\\mathrm{HL^-}$ 和 $\\mathrm{L^{2-}}$ 这些物质。金属以 $\\mathrm{M^{2+}}$ 的形式引入。题目明确指出，只有完全去质子化的配体 $\\mathrm{L^{2-}}$ 与金属配位形成单一的单核配合物 $\\mathrm{ML}$。问题要求忽略金属水解（因此没有 $\\mathrm{MOH^+}$ 或类似物质）和任何其他配合物（因此没有 $\\mathrm{M(L)_2^{2-}}$、$\\mathrm{MHL^+}$ 等）。因此，需要考虑的物质是：$\\mathrm{H_2L}$、$\\mathrm{HL^-}$、$\\mathrm{L^{2-}}$、$\\mathrm{M^{2+}}$ 和 $\\mathrm{ML}$。相应的溶剂和反应产物，$\\mathrm{H_2O}$ 和 $\\mathrm{H^+}$ (或 $\\mathrm{H_3O^+}$），也存在于体系中。\n\n接下来，我们根据质量作用定律建立主导的平衡反应及其数学表达式。\n\n1.  **配体的第一步酸解离**：配体 $\\mathrm{H_2L}$ 失去其第一个质子。\n    $$ \\mathrm{H_2L} \\rightleftharpoons \\mathrm{H^+} + \\mathrm{HL^-} $$\n    第一酸解离常数 $K_{a1}$ 定义为：\n    $$ K_{a1} = \\frac{[\\mathrm{H^+}][\\mathrm{HL^-}]}{[\\mathrm{H_2L}]} $$\n\n2.  **配体的第二步酸解离**：中间物质 $\\mathrm{HL^-}$ 失去其第二个质子，形成完全去质子化的配体 $\\mathrm{L^{2-}}$。\n    $$ \\mathrm{HL^-} \\rightleftharpoons \\mathrm{H^+} + \\mathrm{L^{2-}} $$\n    第二酸解离常数 $K_{a2}$ 定义为：\n    $$ K_{a2} = \\frac{[\\mathrm{H^+}][\\mathrm{L^{2-}}]}{[\\mathrm{HL^-}]} $$\n\n3.  **配合物形成**：金属阳离子 $\\mathrm{M^{2+}}$ 与配体 $\\mathrm{L^{2-}}$ 结合形成配合物 $\\mathrm{ML}$。\n    $$ \\mathrm{M^{2+}} + \\mathrm{L^{2-}} \\rightleftharpoons \\mathrm{ML} $$\n    此反应的形成常数（或稳定常数） $K_f$ 定义为：\n    $$ K_f = \\frac{[\\mathrm{ML}]}{[\\mathrm{M^{2+}}][\\mathrm{L^{2-}}]} $$\n\n这三个反应构成了一个完整的、独立的集合，描述了在给定假设下的体系。\n\n最后，我们应用物质守恒原理来写出配体和金属的总质量平衡方程。某个组分的总分析浓度是所有含有该组分的物质的平衡浓度之和。\n\n1.  **配体（L）的质量平衡**：配体的总分析浓度，记为 $C_L^{\\mathrm{T}}$，必须等于所有含有配体部分 'L' 的物质的浓度之和。这些物质是 $\\mathrm{H_2L}$、$\\mathrm{HL^-}$、$\\mathrm{L^{2-}}$ 和配合物 $\\mathrm{ML}$。\n    $$ C_L^{\\mathrm{T}} = [\\mathrm{H_2L}] + [\\mathrm{HL^-}] + [\\mathrm{L^{2-}}] + [\\mathrm{ML}] $$\n\n2.  **金属（M）的质量平衡**：金属的总分析浓度，记为 $C_M^{\\mathrm{T}}$，必须等于所有含有金属 'M' 的物质的浓度之和。根据问题的约束条件，这些物质是自由金属离子 $\\mathrm{M^{2+}}$ 和配合物 $\\mathrm{ML}$。\n    $$ C_M^{\\mathrm{T}} = [\\mathrm{M^{2+}}] + [\\mathrm{ML}] $$\n\n现在，我们用这个推导出的正确描述来评估每个给定的选项。\n\nA.\n该选项列出了以下内容：\n平衡：\n$\\mathrm{H_2L} \\rightleftharpoons \\mathrm{H^+} + \\mathrm{HL^-}$，其中 $K_{a1} = \\dfrac{[\\mathrm{H^+}][\\mathrm{HL^-}]}{[\\mathrm{H_2L}]}$\n$\\mathrm{HL^-} \\rightleftharpoons \\mathrm{H^+} + \\mathrm{L^{2-}}$，其中 $K_{a2} = \\dfrac{[\\mathrm{H^+}][\\mathrm{L^{2-}}]}{[\\mathrm{HL^-}] }$\n$\\mathrm{M^{2+}} + \\mathrm{L^{2-}} \\rightleftharpoons \\mathrm{ML}$，其中 $K_f = \\dfrac{[\\mathrm{ML}]}{[\\mathrm{M^{2+}}][\\mathrm{L^{2-}}]}$\n质量平衡：\n$C_L^{\\mathrm{T}} = [\\mathrm{H_2L}] + [\\mathrm{HL^-}] + [\\mathrm{L^{2-}}] + [\\mathrm{ML}]$\n$C_M^{\\mathrm{T}} = [\\mathrm{M^{2+}}] + [\\mathrm{ML}]$\n该选项中提出的每个方程都与我们从第一性原理推导出的结果完全一致。\n**结论：正确**\n\nB.\n此选项存在几个错误。$K_{a1}$ 和 $K_{a2}$ 的表达式是倒置的；它们代表的是结合常数，而不是酸解离常数。配位反应被错误地表示为涉及 $\\mathrm{HL^-}$ 形成 $\\mathrm{MHL^+}$，这在问题陈述中被明确排除了。配体的质量平衡错误地省略了 $[\\mathrm{HL^-}]$ 并包含了不存在的物质 $[\\mathrm{MHL^+}]$。金属的质量平衡也因为包含了错误的配合物而变得不正确。\n**结论：不正确**\n\nC.\n该选项正确列出了三个主要平衡和配体的质量平衡。然而，它引入了第四个平衡——金属水解，$\\mathrm{M^{2+}} + \\mathrm{H_2O} \\rightleftharpoons \\mathrm{MOH^+} + \\mathrm{H^+}$，并将水解产物 $\\mathrm{MOH^+}$ 包括在金属的质量平衡中。这直接违反了“忽略任何金属水解”的明确指示。\n**结论：不正确**\n\nD.\n该选项在多个方面存在缺陷。它省略了第二个酸解离平衡（$\\mathrm{HL^-} \\rightleftharpoons \\mathrm{H^+} + \\mathrm{L^{2-}}$），而这对于作为配位剂的 $\\mathrm{L^{2-}}$ 是至关重要的。配体的质量平衡，$C_L^{\\mathrm{T}} = [\\mathrm{H_2L}] + [\\mathrm{HL^-}] + [\\mathrm{L^{2-}}]$，是不正确的，因为它省略了配合物的浓度 $[\\mathrm{ML}]$。金属的质量平衡，$C_M^{\\mathrm{T}} = [\\mathrm{M^{2+}}] + [\\mathrm{ML}] + [\\mathrm{L^{2-}}]$，是根本错误的，因为它包含了不含金属 M 的物质 $[\\mathrm{L^{2-}}]$。\n**结论：不正确**\n\n基于全面的分析，只有选项 A 提供了与问题陈述和基本化学原理相一致的、对该体系的完整且正确的描述。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在水溶液中，金属配合物的稳定性通常高度依赖于溶液的$pH$值，因为许多配体本身就是可以被质子化的碱。本练习将演示如何通过推导条件稳定常数$K_f'$，来定量描述$pH$对配合物形成的影响 。这个过程将热力学稳定常数$K_f$与依赖于$pH$的表观常数$K_f'$联系起来，为预测在缓冲溶液或环境水体等真实条件下的配位行为提供了强有力的工具。",
            "id": "2929570",
            "problem": "一个离子强度恒定的水溶液含有一种记为 $L$ 的中性、单齿、单质子碱性配体。在水中，$L$ 根据以下酸解离平衡被质子化为其共轭酸 $HL^{+}$：\n$$HL^{+} \\rightleftharpoons H^{+} + L,$$\n该平衡由热力学酸解离常数 $K_{a}$ 表征，根据质量作用定律定义为：\n$$K_{a} = \\frac{a_{H^{+}}\\,a_{L}}{a_{HL^{+}}},$$\n其中 $a_{i}$ 表示物种 $i$ 的活度。酸度函数按常规方式定义：$pH \\equiv -\\log_{10}(a_{H^{+}})$ 和 $pK_{a} \\equiv -\\log_{10}(K_{a})$。假设在所述条件下，活度可由浓度近似。设所有质子化形态的未络合配体总浓度为 $C_{L}^{*} \\equiv [L] + [HL^{+}]$。将未质子化配体的分数丰度定义为 $\\alpha_{L} \\equiv \\frac{[L]}{C_{L}^{*}}$。\n\n一个二价金属离子 $M^{2+}$ 与 $L$ 根据以下反应形成 $1{:}1$ 络合物：\n$$M^{2+} + L \\rightleftharpoons ML^{2+},$$\n其逐级形成常数为：\n$$K_{f} = \\frac{[ML^{2+}]}{[M^{2+}]\\,[L]}.$$\n假设只有 $L$（而非 $HL^{+}$）能与 $M^{2+}$ 发生显著结合。相对于未络合配体总量 $C_{L}^{*}$ 的条件（表观）形成常数 $K_{f}'$ 定义为：\n$$K_{f}' \\equiv \\frac{[ML^{2+}]}{[M^{2+}]\\,C_{L}^{*}}.$$\n\n请仅使用上述定义和质量作用定律，首先推导出以 $pK_{a}$ 和 $pH$ 表示的 $\\alpha_{L}$，然后推导出 $K_{f}'$ 作为 $K_{f}$、$pK_{a}$ 和 $pH$ 的显式函数。请将最终结果表示为以 $K_{f}$、$pK_{a}$ 和 $pH$ 表示的 $K_{f}'(pH)$ 的单个闭合形式解析表达式。无需进行数值计算。",
            "solution": "问题陈述已经过验证，被认定为科学上合理、提法明确、客观且自洽。这是一个水溶液化学平衡研究中的标准问题。我们将按要求进行推导。\n\n任务是推导两个表达式。第一，以 $pH$ 和 $pK_{a}$ 表示的未质子化配体分数丰度 $\\alpha_{L}$ 的表达式。第二，条件形成常数 $K_{f}'$ 作为热力学形成常数 $K_{f}$、$pK_{a}$ 和 $pH$ 的函数的表达式。\n\n第 $1$ 部分：$\\alpha_{L}$ 的推导\n\n我们从配体 $L$ 的分数丰度的定义开始：\n$$ \\alpha_{L} \\equiv \\frac{[L]}{C_{L}^{*}} $$\n未络合配体的总浓度 $C_{L}^{*}$，是其质子化和未质子化形式的浓度之和：\n$$ C_{L}^{*} = [L] + [HL^{+}] $$\n将此代入 $\\alpha_{L}$ 的定义，得到：\n$$ \\alpha_{L} = \\frac{[L]}{[L] + [HL^{+}]} $$\n为继续推导，我们必须将质子化形式的浓度 $[HL^{+}]$ 与未质子化形式的浓度 $[L]$ 联系起来。这种关系由 $HL^{+}$ 的酸解离平衡给出：\n$$ HL^{+} \\rightleftharpoons H^{+} + L $$\n在活度可由浓度近似的假设下，相应的酸解离常数 $K_{a}$ 为：\n$$ K_{a} = \\frac{[H^{+}]\\,[L]}{[HL^{+}]} $$\n重新整理此表达式以求解 $[HL^{+}]$，得到：\n$$ [HL^{+}] = \\frac{[H^{+}]\\,[L]}{K_{a}} $$\n现在，我们将这个关于 $[HL^{+}]$ 的表达式代回到 $\\alpha_{L}$ 的方程中：\n$$ \\alpha_{L} = \\frac{[L]}{[L] + \\frac{[H^{+}]\\,[L]}{K_{a}}} $$\n项 $[L]$ 是分母中的公因子，可以提取出来：\n$$ \\alpha_{L} = \\frac{[L]}{[L] \\left( 1 + \\frac{[H^{+}]}{K_{a}} \\right)} $$\n约去分子和分母中的 $[L]$ 项后，我们得到一个以浓度和常数表示的 $\\alpha_{L}$ 表达式：\n$$ \\alpha_{L} = \\frac{1}{1 + \\frac{[H^{+}]}{K_{a}}} $$\n题目要求用 $pH$ 和 $pK_{a}$ 表示此表达式。我们使用标准定义：\n$$ pH = -\\log_{10}([H^{+}]) \\implies [H^{+}] = 10^{-pH} $$\n$$ pK_{a} = -\\log_{10}(K_{a}) \\implies K_{a} = 10^{-pK_{a}} $$\n将这些代入 $\\alpha_{L}$ 的表达式中：\n$$ \\alpha_{L} = \\frac{1}{1 + \\frac{10^{-pH}}{10^{-pK_{a}}}} $$\n使用指数性质 $\\frac{10^{a}}{10^{b}} = 10^{a-b}$，该分数变为：\n$$ \\alpha_{L} = \\frac{1}{1 + 10^{-pH - (-pK_{a})}} = \\frac{1}{1 + 10^{pK_{a} - pH}} $$\n这就是 $L$ 的分数丰度作为 $pH$ 和 $pK_{a}$ 的函数的最终表达式。\n\n第 $2$ 部分：$K_{f}'$ 的推导\n\n我们的任务是推导条件形成常数 $K_{f}'$ 的表达式，其定义如下：\n$$ K_{f}' \\equiv \\frac{[ML^{2+}]}{[M^{2+}]\\,C_{L}^{*}} $$\n目标是将其与热力学形成常数 $K_{f}$ 联系起来，后者是为涉及未质子化配体 $L$ 的反应所定义的：\n$$ K_{f} = \\frac{[ML^{2+}]}{[M^{2+}]\\,[L]} $$\n通过处理 $K_{f}'$ 的表达式，可以建立 $K_{f}'$ 和 $K_{f}$ 之间的直接关系。我们可以通过乘以并除以 $[L]$ 来重写它：\n$$ K_{f}' = \\frac{[ML^{2+}]}{[M^{2+}]\\,[L]} \\cdot \\frac{[L]}{C_{L}^{*}} $$\n我们认出第一项是 $K_{f}$ 的定义，第二项是 $\\alpha_{L}$ 的定义：\n$$ K_{f}' = K_{f} \\cdot \\alpha_{L} $$\n这个基本方程表明，条件常数就是热力学常数乘以反应物种 $L$ 的分数丰度。\n\n现在，我们代入在第 $1$ 部分推导出的 $\\alpha_{L}$ 表达式：\n$$ K_{f}' = K_{f} \\left( \\frac{1}{1 + 10^{pK_{a} - pH}} \\right) $$\n这可以写成一个单一的分数形式：\n$$ K_{f}'(pH) = \\frac{K_{f}}{1 + 10^{pK_{a} - pH}} $$\n这就是所要求的条件形成常数 $K_{f}'$ 作为 $K_{f}$、$pK_{a}$ 和 $pH$ 的显式函数的闭合形式解析表达式。推导完成。",
            "answer": "$$\n\\boxed{\nK_{f}' = \\frac{K_{f}}{1 + 10^{pK_{a} - pH}}\n}\n$$"
        },
        {
            "introduction": "真实的化学体系通常涉及多种竞争性平衡的复杂相互作用，例如金属配位、配体质子化和金属离子水解。对于这类复杂体系，简单的代数方法往往难以求得解析解。这项高级练习将理论化学与计算实践联系起来 ，要求您首先为包含多种竞争反应的实际体系推导出控制方程，然后应用数值方法——这是现代化学研究中的一项关键技能——来求解体系的平衡状态。",
            "id": "2929503",
            "problem": "给定一个水溶液中的金属-配体体系，其中金属会发生水解，配体是多元质子酸。从逐级和累积平衡常数的定义以及质量守恒定律出发，推导一个同时考虑金属水解和配体质子化的组合形成函数。然后，编写一个程序，对于每个指定的参数集和一个固定的氢离子电位 (pH)，数值求解在该 pH 下每个金属中心结合的配体分子的平均数，记为 $\\bar{n}$。\n\n使用的基本原理：\n- 络合反应的累积形成常数定义：如果 $M$ 是游离金属，$L$ 是去质子化的游离配体，那么对于 $ML$ 和 $ML_{2}$，累积形成常数 $\\beta_{1}$ 和 $\\beta_{2}$ 满足 $[ML] = \\beta_{1}[M][L]$ 和 $[ML_{2}] = \\beta_{2}[M][L]^{2}$。\n- 相对于 $\\mathrm{H}^{+}$ 表示的逐级水解常数定义：对于 $M + \\mathrm{H}_{2}O \\rightleftharpoons MOH + \\mathrm{H}^{+}$ 和 $MOH + \\mathrm{H}_{2}O \\rightleftharpoons M(OH)_{2} + \\mathrm{H}^{+}$，逐级常数 $K_{h1}$ 和 $K_{h2}$ 定义为 $[MOH] = K_{h1}\\,[M]/[\\mathrm{H}^{+}]$ 和 $[M(OH)_{2}] = K_{h1}K_{h2}\\,[M]/[\\mathrm{H}^{+}]^{2}$。\n- 二元质子酸配体的逐级酸解离常数定义：对于 $HL \\rightleftharpoons \\mathrm{H}^{+} + L$ 和 $H_{2}L \\rightleftharpoons \\mathrm{H}^{+} + HL$，解离常数 $K_{a1}$ 和 $K_{a2}$ 满足 $[HL] = ([\\mathrm{H}^{+}]/K_{a1})[L]$ 和 $[H_{2}L] = ([\\mathrm{H}^{+}]^{2}/(K_{a1}K_{a2}))[L]$。\n- 总金属和总配体浓度的质量平衡关系，其中“总”浓度计算了溶液中该元素所有化学形态的总和。\n- 氢离子电位 (pH) 的定义：$\\mathrm{pH} = -\\log_{10}([\\mathrm{H}^{+}])$。\n\n推导任务：\n- 仅使用上述定义和质量守恒定律，在固定的 pH 值下，推导出一个以未知游离浓度 $[M]$ 和 $[L]$ 为变量的代数方程组，该方程组足以确定 $\\bar{n}$。您必须首先将金属和配体的副反应系数表示为 $[\\mathrm{H}^{+}]$ 的函数：\n  - $\\alpha_{M}([\\mathrm{H}^{+}])$，考虑了 $M$、$MOH$ 和 $M(OH)_{2}$。\n  - $\\alpha_{L}([\\mathrm{H}^{+}])$，考虑了 $L$、$HL$ 和 $H_{2}L$。\n- 然后，将 $\\bar{n}$ 定义为与金属结合的配体总浓度与被配体结合的金属总浓度之比（两者均不包括纯粹水解或纯粹质子化的物种），并用解出的浓度和副反应系数来表示 $\\bar{n}$。\n\n计算任务：\n- 实现一个数值求解器，它接收参数集作为输入，由 pH 计算出 $[\\mathrm{H}^{+}] \\text{，并求解 } [M] \\text{ 和 } [L]$，同时确保结果不为负。\n- 使用该解计算推导出的 $\\bar{n}$。\n- 所有浓度必须以摩尔浓度 (molarity) 处理，即单位为 $\\mathrm{mol}\\,\\mathrm{L}^{-1}$。\n- 最终报告的 $\\bar{n}$ 是无量纲的，并且必须以小数形式输出，精确到小数点后 $6$ 位。\n\n测试套件：\n对于所有测试，假设温度恒定，因此活度系数可取为 1，水的活度也为 1。使用以下四个参数集，每个参数集指定为一个有序元组 $(C_{M}^{T}, C_{L}^{T}, \\beta_{1}, \\beta_{2}, K_{h1}, K_{h2}, K_{a1}, K_{a2}, \\mathrm{pH})$：\n- 测试 1: ($1.0 \\times 10^{-4}$, $5.0 \\times 10^{-4}$, $1.0 \\times 10^{6}$, $1.0 \\times 10^{11}$, $1.0 \\times 10^{-9}$, $3.0 \\times 10^{-9}$, $1.0 \\times 10^{-4}$, $1.0 \\times 10^{-9}$, 5.50)。\n- 测试 2: ($1.0 \\times 10^{-4}$, $5.0 \\times 10^{-4}$, $1.0 \\times 10^{6}$, $1.0 \\times 10^{11}$, $1.0 \\times 10^{-9}$, $3.0 \\times 10^{-9}$, $1.0 \\times 10^{-4}$, $1.0 \\times 10^{-9}$, 2.00)。\n- 测试 3: ($1.0 \\times 10^{-4}$, $5.0 \\times 10^{-4}$, $1.0 \\times 10^{6}$, $1.0 \\times 10^{11}$, $1.0 \\times 10^{-9}$, $3.0 \\times 10^{-9}$, $1.0 \\times 10^{-4}$, $1.0 \\times 10^{-9}$, 11.00)。\n- 测试 4: ($2.0 \\times 10^{-5}$, $3.0 \\times 10^{-5}$, $1.0 \\times 10^{3}$, $1.0 \\times 10^{5}$, $1.0 \\times 10^{-8}$, $1.0 \\times 10^{-9}$, $1.0 \\times 10^{-5}$, $1.0 \\times 10^{-8}$, 7.00)。\n\n其中：\n- $C_{M}^{T}$ 是金属的总分析浓度，单位为 $\\mathrm{mol}\\,\\mathrm{L}^{-1}$。\n- $C_{L}^{T}$ 是配体的总分析浓度，单位为 $\\mathrm{mol}\\,\\mathrm{L}^{-1}$。\n- $\\beta_{1}$ 和 $\\beta_{2}$ 分别是 $ML$ 和 $ML_{2}$ 的累积形成常数。\n- $K_{h1}$ 和 $K_{h2}$ 是如上定义的、相对于 $\\mathrm{H}^{+}$ 的逐级水解常数。\n- $K_{a1}$ 和 $K_{a2}$ 是配体的酸解离常数。\n- $\\mathrm{pH}$ 是无量纲的。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表项为按上述测试顺序排列的结果，每个 $\\bar{n}$ 值都需精确到小数点后 $6$ 位（例如，$\\,[0.123456,1.234568,0.000001,2.000000]\\,$）。",
            "solution": "问题陈述已经过严格审查，并被认为是有效的。该问题在科学上基于化学平衡原理，问题设定良好（well-posed），有足够的信息来获得唯一解，并以客观、正式的语言表述。因此，我们可以继续进行推导和求解。\n\n任务是推导金属-配体体系的形成函数 $\\bar{n}$，其中考虑了金属水解和配体质子化的竞争性平衡。这需要求解所有物种的平衡浓度。\n\n首先，我们建立质量平衡方程。金属的总分析浓度 $C_M^T$ 是所有含金属物种的浓度之和：\n$$\nC_M^T = [M] + [MOH] + [M(OH)_2] + [ML] + [ML_2]\n$$\n同样，配体的总分析浓度 $C_L^T$ 是所有含配体物种的浓度之和，并考虑了化学计量：\n$$\nC_L^T = [L] + [HL] + [H_2L] + [ML] + 2[ML_2]\n$$\n此处，$[M]$ 是游离金属离子的浓度，$[L]$ 是完全去质子化的游离配体的浓度。\n\n接下来，我们使用所提供的平衡常数定义，将每个物种的浓度用 $[M]$、$[L]$ 和氢离子浓度 $[H^+]$ 来表示。问题固定了氢离子电位 $\\mathrm{pH}$，所以 $[H^+]$ 是一个由 $[H^+] = 10^{-\\mathrm{pH}}$ 给出的常数参数。\n\n水解金属物种：\n$$[MOH] = \\frac{K_{h1}}{[H^+]}[M]$$\n$$[M(OH)_2] = \\frac{K_{h1}K_{h2}}{([H^+])^2}[M]$$\n\n质子化配体物种：\n$$[HL] = \\frac{[H^+]}{K_{a1}}[L]$$\n$$[H_2L] = \\frac{([H^+])^2}{K_{a1}K_{a2}}[L]$$\n\n金属-配体络合物：\n$$[ML] = \\beta_1[M][L]$$\n$$[ML_2] = \\beta_2[M][L]^2$$\n\n为简化质量平衡方程，我们引入副反应系数 $\\alpha_M$ 和 $\\alpha_L$，它们说明了未参与主络合反应的所有金属和配体的形态。\n\n金属的副反应系数 $\\alpha_M([\\mathrm{H}^{+}])$ 考虑了水解反应：\n$$\n\\alpha_M([\\mathrm{H}^{+}]) = \\frac{[M] + [MOH] + [M(OH)_2]}{[M]} = 1 + \\frac{K_{h1}}{[H^+]} + \\frac{K_{h1}K_{h2}}{([H^+])^2}\n$$\n配体的副反应系数 $\\alpha_L([\\mathrm{H}^{+}])$ 考虑了质子化反应：\n$$\n\\alpha_L([\\mathrm{H}^{+}]) = \\frac{[L] + [HL] + [H_2L]}{[L]} = 1 + \\frac{[H^+]}{K_{a1}} + \\frac{([H^+])^2}{K_{a1}K_{a2}}\n$$\n由于 $\\mathrm{pH}$ 是固定的，对于给定的计算，$\\alpha_M$ 和 $\\alpha_L$ 是常数。\n\n将这些表达式代入质量平衡方程，得到一个包含两个未知数 $[M]$ 和 $[L]$ 的非线性代数方程组：\n$$\nC_M^T = [M]\\alpha_M([\\mathrm{H}^{+}]) + \\beta_1[M][L] + \\beta_2[M][L]^2 \\quad \\text{(1)}\n$$\n$$\nC_L^T = [L]\\alpha_L([\\mathrm{H}^{+}]) + \\beta_1[M][L] + 2\\beta_2[M][L]^2 \\quad \\text{(2)}\n$$\n从方程（1）中，我们可以将 $[M]$ 表示为 $[L]$ 的函数：\n$$\n[M] = \\frac{C_M^T}{\\alpha_M([\\mathrm{H}^{+}]) + \\beta_1[L] + \\beta_2[L]^2} \\quad \\text{(3)}\n$$\n将此式代入方程（2）以消去 $[M]$，得到一个只含单个未知数 $[L]$ 的方程：\n$$\nC_L^T = [L]\\alpha_L([\\mathrm{H}^{+}]) + \\left( \\frac{C_M^T}{\\alpha_M([\\mathrm{H}^{+}]) + \\beta_1[L] + \\beta_2[L]^2} \\right) \\left( \\beta_1[L] + 2\\beta_2[L]^2 \\right)\n$$\n这个方程可以重新整理为一个求根问题 $f([L]) = 0$：\n$$\nf([L]) = C_L^T - [L]\\alpha_L([\\mathrm{H}^{+}]) - C_M^T \\frac{\\beta_1[L] + 2\\beta_2[L]^2}{\\alpha_M([\\mathrm{H}^{+}]) + \\beta_1[L] + \\beta_2[L]^2} = 0\n$$\n该方程必须通过数值方法求解 $[L]$。在区间 $0 < [L] < C_L^T$ 内存在一个唯一的、具有物理意义的解。\n\n问题为平均配体数 $\\bar{n}$ 提供了一个特定定义：“与金属结合的配体总浓度与被配体结合的金属总浓度之比”。这可以表示为：\n$$\n\\bar{n} = \\frac{\\text{结合配体的总浓度}}{\\text{形成络合物的金属总浓度}}\n$$\n分子是络合物中配体分子的总和，并按化学计量加权：$[ML] + 2[ML_2]$。分母是所有作为络合物一部分的金属离子的总和：$[ML] + [ML_2]$。\n$$\n\\bar{n} = \\frac{[ML] + 2[ML_2]}{[ML] + [ML_2]}\n$$\n必须注意的是，这不是标准的 Bjerrum 形成函数，后者的分母定义为总金属浓度 $C_M^T$。该指定量代表的是每个**已络合**的金属中心上的平均配体数，而不是体系中每个**总**金属中心的平均配体数。遵循问题的明确指示，我们代入平衡表达式：\n$$\n\\bar{n} = \\frac{\\beta_1[M][L] + 2\\beta_2[M][L]^2}{\\beta_1[M][L] + \\beta_2[M][L]^2}\n$$\n将分子和分母同除以 $[M]$，得到一个仅依赖于 $[L]$ 和形成常数的简化表达式：\n$$\n\\bar{n} = \\frac{\\beta_1[L] + 2\\beta_2[L]^2}{\\beta_1[L] + \\beta_2[L]^2}\n$$\n计算步骤如下：\n1. 对每个参数集，计算常数值 $[H^+]$、$\\alpha_M([\\mathrm{H}^{+}])$ 和 $\\alpha_L([\\mathrm{H}^{+}])$。\n2. 数值求解方程 $f([L]) = 0$，以找到平衡时的游离配体浓度 $[L]$。\n3. 使用解出的 $[L]$ 值，通过推导出的公式计算 $\\bar{n}$。\n4. 报告结果，四舍五入至小数点后六位。\n\n此过程构成了对所提出问题的完整而严谨的解决方案。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Solves for the average ligand number in a metal-ligand system\n    with competing hydrolysis and protonation equilibria for a set of test cases.\n    \"\"\"\n    \n    # Test cases defined as tuples:\n    # (C_M_T, C_L_T, beta_1, beta_2, K_h1, K_h2, K_a1, K_a2, pH)\n    test_cases = [\n        (1.0e-4, 5.0e-4, 1.0e6, 1.0e11, 1.0e-9, 3.0e-9, 1.0e-4, 1.0e-9, 5.50),\n        (1.0e-4, 5.0e-4, 1.0e6, 1.0e11, 1.0e-9, 3.0e-9, 1.0e-4, 1.0e-9, 2.00),\n        (1.0e-4, 5.0e-4, 1.0e6, 1.0e11, 1.0e-9, 3.0e-9, 1.0e-4, 1.0e-9, 11.00),\n        (2.0e-5, 3.0e-5, 1.0e3, 1.0e5, 1.0e-8, 1.0e-9, 1.0e-5, 1.0e-8, 7.00),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        C_M_T, C_L_T, beta_1, beta_2, K_h1, K_h2, K_a1, K_a2, pH = case\n        \n        # 1. Pre-calculation of constants based on pH\n        H_conc = 10**(-pH)\n        \n        # Side-reaction coefficient for the metal (hydrolysis)\n        alpha_M = 1.0 + (K_h1 / H_conc) + ((K_h1 * K_h2) / (H_conc**2))\n        \n        # Side-reaction coefficient for the ligand (protonation)\n        alpha_L = 1.0 + (H_conc / K_a1) + ((H_conc**2) / (K_a1 * K_a2))\n        \n        # 2. Define the function f([L]) = 0 to be solved for free ligand concentration [L]\n        def objective_function(L_conc):\n            if L_conc <= 0:\n                # To handle edge cases in the solver, technically L_conc > 0\n                return C_L_T\n            \n            numerator_complex_term = beta_1 * L_conc + 2 * beta_2 * L_conc**2\n            denominator_complex_term = alpha_M + beta_1 * L_conc + beta_2 * L_conc**2\n            \n            if denominator_complex_term == 0:\n                # Avoid division by zero, though unlikely with positive constants\n                return np.inf\n\n            return C_L_T - L_conc * alpha_L - C_M_T * (numerator_complex_term / denominator_complex_term)\n\n        # 3. Numerically solve for [L]\n        # The root must be between 0 and C_L_T.\n        # We use a small positive number to avoid issues at L_conc=0.\n        try:\n            sol = root_scalar(objective_function, bracket=(1e-20, C_L_T), method='brentq')\n            L_conc_eq = sol.root\n        except ValueError:\n            # If the signs at the bracket ends are the same, it indicates an issue.\n            # This might happen if complexation is negligible and [L] is extremely small.\n            # In such a case, objective_function(C_L_T) might be positive.\n            # We can try to find the root in a smaller interval.\n            sol = root_scalar(objective_function, x0=1e-15, x1=C_L_T, method='secant')\n            L_conc_eq = sol.root\n\n        # 4. Calculate n_bar using the derived formula\n        # n_bar = (beta1*[L] + 2*beta2*[L]^2) / (beta1*[L] + beta2*[L]^2)\n        numerator_n_bar = beta_1 * L_conc_eq + 2 * beta_2 * L_conc_eq**2\n        denominator_n_bar = beta_1 * L_conc_eq + beta_2 * L_conc_eq**2\n        \n        if denominator_n_bar > 0:\n            n_bar = numerator_n_bar / denominator_n_bar\n        else:\n            # This case happens when no complexes are formed ([L] is effectively zero)\n            # The limit of n_bar as [L]->0 is 1, provided beta_1 is not zero.\n            n_bar = 1.0\n            \n        # Format and store result\n        results.append(f\"{n_bar:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}