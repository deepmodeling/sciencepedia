{
    "hands_on_practices": [
        {
            "introduction": "The common ion effect is a fundamental principle governing the solubility of sparingly soluble salts. This first practice moves beyond a purely qualitative understanding by requiring a rigorous mathematical treatment of the system . By deriving and solving the exact cubic polynomial for the solubility of calcium fluoride in a sodium fluoride solution, you will develop a deeper appreciation for the underlying algebraic structure of equilibrium problems and the importance of justifying the simplifying assumptions that are often employed.",
            "id": "2958920",
            "problem": "A sparingly soluble salt calcium fluoride, $CaF_{2}(s)$, is placed in a well-stirred, isothermal aqueous solution at $25^\\circ\\mathrm{C}$ that initially contains sodium fluoride at bulk concentration $0.020\\ \\mathrm{M}$. The thermodynamic solubility product at $25^\\circ\\mathrm{C}$ is $K_{sp}=1.46\\times 10^{-10}$. Let $s$ denote the equilibrium molar solubility of $CaF_{2}$, defined as the increase in the total dissolved calcium concentration due solely to dissolution of the solid into this medium.\n\nStarting only from the definition of chemical equilibrium via the Law of Mass Action for dissolution and the stoichiometry of $CaF_{2}(s)\\rightleftharpoons Ca^{2+}(aq)+2F^{-}(aq)$, derive the governing algebraic equation for $s$ and reduce it to a cubic polynomial with constant coefficients in $s$. In your derivation, explicitly state any approximations you invoke and justify their physical reasonableness on the basis of scale separation or limiting behavior.\n\nThen, solve this cubic equation to obtain a numerical value of $s$ for the stated conditions. If you make any further simplifying assumptions when solving, quantify the error introduced and verify consistency a posteriori. Express your final result as a numerical value in $\\mathrm{mol\\ L^{-1}}$. Round your answer to three significant figures.",
            "solution": "The problem requires the derivation and solution of the governing equation for the molar solubility, $s$, of calcium fluoride, $CaF_{2}(s)$, in an aqueous solution initially containing sodium fluoride, $NaF$, at a concentration of $C_0 = 0.020\\ \\mathrm{M}$. The analysis must be grounded in the principles of chemical equilibrium.\n\nFirst, we establish the relevant chemical equilibrium. Calcium fluoride is a sparingly soluble salt that dissolves according to the following stoichiometry:\n$$CaF_{2}(s) \\rightleftharpoons Ca^{2+}(aq) + 2F^{-}(aq)$$\nThe equilibrium condition for this dissolution process is described by the Law of Mass Action. The thermodynamic solubility product, $K_{sp}$, is defined in terms of the activities of the aqueous species. For a species $i$, its activity $a_i$ is related to its molar concentration $[i]$ by the activity coefficient $\\gamma_i$, such that $a_i = \\gamma_i [i]$.\n$$K_{sp} = a_{Ca^{2+}} \\cdot (a_{F^{-}})^2 = (\\gamma_{Ca^{2+}}[Ca^{2+}]) \\cdot (\\gamma_{F^{-}}[F^{-}])^2$$\nThe problem provides concentrations in molarity and does not provide information to calculate activity coefficients. Therefore, as is common in such problems, we invoke the approximation that the solution is sufficiently dilute such that the activity coefficients of the ionic species are approximately unity, i.e., $\\gamma_{Ca^{2+}} \\approx 1$ and $\\gamma_{F^{-}} \\approx 1$. This reduces the activity-based expression to a concentration-based one:\n$$K_{sp} = [Ca^{2+}][F^{-}]^2 = 1.46 \\times 10^{-10}$$\n\nNext, we express the equilibrium concentrations of the ions in terms of the molar solubility, $s$. The variable $s$ is defined as the concentration of $Ca^{2+}$ ions originating from the dissolution of $CaF_{2}(s)$. By stoichiometry, for every mole of $CaF_{2}$ that dissolves, one mole of $Ca^{2+}$ and two moles of $F^{-}$ are produced. Thus, at equilibrium:\n$$[Ca^{2+}] = s$$\nThe fluoride ions, $F^{-}$, originate from two sources: the complete dissociation of the initial sodium fluoride ($NaF(aq) \\to Na^{+}(aq) + F^{-}(aq)$), which contributes a concentration $C_0 = 0.020\\ \\mathrm{M}$, and the dissolution of $CaF_2$, which contributes a concentration of $2s$. Therefore, the total equilibrium concentration of fluoride is:\n$$[F^{-}] = C_0 + 2s$$\n\nSubstituting these expressions for the equilibrium concentrations into the $K_{sp}$ equation yields the governing algebraic equation for $s$:\n$$K_{sp} = (s)(C_0 + 2s)^2$$\nTo reduce this to a cubic polynomial with constant coefficients, we expand the squared term:\n$$K_{sp} = s(C_0^2 + 4C_0s + 4s^2)$$\n$$K_{sp} = C_0^2s + 4C_0s^2 + 4s^3$$\nRearranging this into the standard polynomial form, $ax^3+bx^2+cx+d=0$, gives:\n$$4s^3 + 4C_0s^2 + C_0^2s - K_{sp} = 0$$\nThis is the exact cubic equation for the molar solubility $s$. Substituting the given values $C_0 = 0.020\\ \\mathrm{M}$ and $K_{sp} = 1.46 \\times 10^{-10}$:\n$$4s^3 + 4(0.020)s^2 + (0.020)^2s - 1.46 \\times 10^{-10} = 0$$\n$$4s^3 + 0.080s^2 + 4.0 \\times 10^{-4}s - 1.46 \\times 10^{-10} = 0$$\n\nTo solve this cubic equation, we may first attempt a physically justified approximation. The presence of a common ion, $F^{-}$, from $NaF$ will significantly suppress the dissolution of $CaF_2$ according to Le Châtelier's principle. Consequently, the molar solubility $s$ is expected to be very small compared to the initial concentration of the common ion, $C_0$.\nWe posit the approximation $2s \\ll C_0$.\nIf this holds, the total fluoride concentration can be approximated as:\n$$[F^{-}] = C_0 + 2s \\approx C_0$$\nUnder this simplifying assumption, the equilibrium expression becomes:\n$$K_{sp} \\approx s \\cdot (C_0)^2$$\nSolving for $s$ yields the approximate solubility, which we denote $s_{approx}$:\n$$s_{approx} = \\frac{K_{sp}}{(C_0)^2} = \\frac{1.46 \\times 10^{-10}}{(0.020)^2} = \\frac{1.46 \\times 10^{-10}}{4.0 \\times 10^{-4}} = 3.65 \\times 10^{-7}\\ \\mathrm{mol\\ L^{-1}}$$\n\nNow, we must verify the validity of our approximation a posteriori. Let us check if $2s_{approx} \\ll C_0$:\n$$2s_{approx} = 2 \\times (3.65 \\times 10^{-7}) = 7.30 \\times 10^{-7}\\ \\mathrm{M}$$\n$$C_0 = 0.020 = 2.0 \\times 10^{-2}\\ \\mathrm{M}$$\nThe condition $7.30 \\times 10^{-7} \\ll 2.0 \\times 10^{-2}$ is clearly satisfied, as $2s_{approx}$ is more than four orders of magnitude smaller than $C_0$. The percentage error introduced in the fluoride concentration by this approximation is:\n$$\\text{Error} \\% = \\frac{2s_{approx}}{C_0} \\times 100\\% = \\frac{7.30 \\times 10^{-7}}{0.020} \\times 100\\% \\approx 0.00365\\%$$\nThis error is negligible, indicating that the approximation is highly accurate. To confirm, we can use this value of $s_{approx}$ to calculate a corrected solubility, $s'$, using the full expression for $[F^{-}]$:\n$$s' = \\frac{K_{sp}}{(C_0 + 2s_{approx})^2} = \\frac{1.46 \\times 10^{-10}}{(0.020 + 2(3.65 \\times 10^{-7}))^2} = \\frac{1.46 \\times 10^{-10}}{(0.02000073)^2} \\approx 3.64977 \\times 10^{-7}\\ \\mathrm{mol\\ L^{-1}}$$\nThe difference between $s_{approx}$ and $s'$ is insignificant. Rounded to three significant figures, both values are identical:\n$$s \\approx 3.65 \\times 10^{-7}\\ \\mathrm{mol\\ L^{-1}}$$\nTherefore, the solution derived from the simplifying assumption is sufficient for the required precision.",
            "answer": "$$\\boxed{3.65 \\times 10^{-7}}$$"
        },
        {
            "introduction": "Real chemical systems often involve multiple, simultaneous equilibria. This exercise  explores how the solubility of a salt with a basic anion, like calcium oxalate, is significantly influenced by the pH of the solution. You will learn to quantitatively account for this effect by using the concept of alpha fractions, providing a powerful tool for predicting solubility in more complex chemical environments.",
            "id": "2958951",
            "problem": "A sparingly soluble salt, calcium oxalate, $\\mathrm{CaC_2O_4(s)}$, is in equilibrium with an aqueous solution at temperature $25\\,^{\\circ}\\mathrm{C}$. The dissolution equilibrium is $\\mathrm{CaC_2O_4(s)} \\rightleftharpoons \\mathrm{Ca^{2+}} + \\mathrm{C_2O_4^{2-}}$, with solubility product constant $K_{sp} = 2.30 \\times 10^{-9}$. The solution is acidified and maintained at $\\mathrm{pH} = 2.00$ by a strong acid reservoir, and the ionic strength is sufficiently low that activities may be approximated by molar concentrations. No complexing agents other than protons are present, and there is no background common ion other than the proton.\n\nOxalate is the fully deprotonated base of oxalic acid, $\\mathrm{H_2C_2O_4}$, whose stepwise acid dissociation constants at $25\\,^{\\circ}\\mathrm{C}$ are $K_{a1} = 5.60 \\times 10^{-2}$ and $K_{a2} = 5.42 \\times 10^{-5}$. Assume that $\\mathrm{H_2C_2O_4}$, $\\mathrm{HC_2O_4^{-}}$, and $\\mathrm{C_2O_4^{2-}}$ are the only oxalate-containing aqueous species.\n\nExplain, using equilibrium definitions and mass balance, why the presence of $\\mathrm{H^{+}}$ reduces the common ion effect of oxalate on the solubility of $\\mathrm{CaC_2O_4(s)}$. Then, compute the molar solubility $s$ of $\\mathrm{CaC_2O_4(s)}$ at $\\mathrm{pH}=2.00$ under the stated assumptions. Round your final numerical result for $s$ to three significant figures and express it in $\\mathrm{mol\\,L^{-1}}$ ($\\mathrm{M}$).",
            "solution": "The problem requires an explanation of the effect of pH on the solubility of calcium oxalate, $\\mathrm{CaC_2O_4(s)}$, and a calculation of its molar solubility, $s$, at a fixed $\\mathrm{pH}$ of $2.00$. The problem is well-posed and scientifically sound, containing all necessary data and definitions for a complete solution.\n\nFirst, we address the qualitative explanation. The primary equilibrium is the dissolution of the sparingly soluble salt:\n$$ \\mathrm{CaC_2O_4(s)} \\rightleftharpoons \\mathrm{Ca^{2+}(aq)} + \\mathrm{C_2O_4^{2-}(aq)} $$\nThe equilibrium for this process is described by the solubility product constant, $K_{sp}$:\n$$ K_{sp} = [\\mathrm{Ca^{2+}}][\\mathrm{C_2O_4^{2-}}] = 2.30 \\times 10^{-9} $$\nIn a neutral solution, the dissolution is limited by the accumulation of the product ions $\\mathrm{Ca^{2+}}$ and $\\mathrm{C_2O_4^{2-}}$. The \"common ion effect\" describes the phenomenon where the solubility of a salt is decreased by the presence of a common ion from an external source. In this context, the phrase \"common ion effect of oxalate\" can be interpreted as the inherent solubility-limiting effect of the product oxalate ion, $\\mathrm{C_2O_4^{2-}}$, on the dissolution equilibrium.\n\nThe oxalate ion, $\\mathrm{C_2O_4^{2-}}$, is the conjugate base of the weak diprotic acid, oxalic acid ($\\mathrm{H_2C_2O_4}$). In an acidic solution, the oxalate ion reacts with hydronium ions ($\\mathrm{H^+}$) in a stepwise manner:\n$$ \\mathrm{C_2O_4^{2-}(aq)} + \\mathrm{H^+(aq)} \\rightleftharpoons \\mathrm{HC_2O_4^{-}(aq)} \\quad (K = 1/K_{a2}) $$\n$$ \\mathrm{HC_2O_4^{-}(aq)} + \\mathrm{H^+(aq)} \\rightleftharpoons \\mathrm{H_2C_2O_4(aq)} \\quad (K = 1/K_{a1}) $$\nThese subsequent acid-base equilibria consume the free oxalate ion, $\\mathrm{C_2O_4^{2-}}$, from the solution. According to Le Châtelier's principle, the removal of a product species ($\\mathrm{C_2O_4^{2-}}$) from the dissolution equilibrium causes the equilibrium to shift to the right, in favor of dissolving more solid $\\mathrm{CaC_2O_4(s)}$. This leads to an increase in the concentration of $\\mathrm{Ca^{2+}}$ ions at equilibrium, and thus a higher molar solubility. Therefore, the presence of $\\mathrm{H^+}$ \"reduces\" the limiting impact that the accumulation of $\\mathrm{C_2O_4^{2-}}$ would otherwise have, thereby enhancing the overall solubility of the salt.\n\nNext, we proceed with the quantitative calculation of the molar solubility, $s$. By definition, the molar solubility $s$ is the number of moles of $\\mathrm{CaC_2O_4(s)}$ that dissolve per liter of solution. From the stoichiometry of the dissolution, this is equal to the equilibrium concentration of the calcium ion:\n$$ s = [\\mathrm{Ca^{2+}}] $$\nA mass balance on the oxalate species requires that the total concentration of all forms of oxalate in solution must also equal the molar solubility, as all oxalate originates from the dissolved solid:\n$$ s = [\\mathrm{C_2O_4}]_{total} = [\\mathrm{H_2C_2O_4}] + [\\mathrm{HC_2O_4^{-}}] + [\\mathrm{C_2O_4^{2-}}] $$\nWe can express the total oxalate concentration in terms of the free oxalate concentration, $[\\mathrm{C_2O_4^{2-}}]$, using the acid dissociation constants, $K_{a1}$ and $K_{a2}$:\n$$ K_{a1} = \\frac{[\\mathrm{H^+}][\\mathrm{HC_2O_4^{-}}]}{[\\mathrm{H_2C_2O_4}]} = 5.60 \\times 10^{-2} $$\n$$ K_{a2} = \\frac{[\\mathrm{H^+}][\\mathrm{C_2O_4^{2-}}]}{[\\mathrm{HC_2O_4^{-}}]} = 5.42 \\times 10^{-5} $$\nFrom these definitions, we can write $[\\mathrm{HC_2O_4^{-}}]$ and $[\\mathrm{H_2C_2O_4}]$ in terms of $[\\mathrm{C_2O_4^{2-}}]$ and the fixed hydrogen ion concentration $[\\mathrm{H^+}] = 10^{-2.00} = 1.00 \\times 10^{-2} \\, \\mathrm{M}$:\n$$ [\\mathrm{HC_2O_4^{-}}] = \\frac{[\\mathrm{H^+}][\\mathrm{C_2O_4^{2-}}]}{K_{a2}} $$\n$$ [\\mathrm{H_2C_2O_4}] = \\frac{[\\mathrm{H^+}][\\mathrm{HC_2O_4^{-}}]}{K_{a1}} = \\frac{[\\mathrm{H^+}]}{K_{a1}} \\left( \\frac{[\\mathrm{H^+}][\\mathrm{C_2O_4^{2-}}]}{K_{a2}} \\right) = \\frac{[\\mathrm{H^+}]^2[\\mathrm{C_2O_4^{2-}}]}{K_{a1}K_{a2}} $$\nThe fraction of total oxalate present as the free ion $\\mathrm{C_2O_4^{2-}}$ is denoted by $\\alpha_{\\mathrm{C_2O_4^{2-}}}$:\n$$ \\alpha_{\\mathrm{C_2O_4^{2-}}} = \\frac{[\\mathrm{C_2O_4^{2-}}]}{[\\mathrm{C_2O_4}]_{total}} = \\frac{[\\mathrm{C_2O_4^{2-}}]}{[\\mathrm{H_2C_2O_4}] + [\\mathrm{HC_2O_4^{-}}] + [\\mathrm{C_2O_4^{2-}}]} $$\nSubstituting the expressions for the protonated species:\n$$ \\alpha_{\\mathrm{C_2O_4^{2-}}} = \\frac{[\\mathrm{C_2O_4^{2-}}]}{\\frac{[\\mathrm{H^+}]^2[\\mathrm{C_2O_4^{2-}}]}{K_{a1}K_{a2}} + \\frac{[\\mathrm{H^+}][\\mathrm{C_2O_4^{2-}}]}{K_{a2}} + [\\mathrm{C_2O_4^{2-}}]} = \\frac{1}{\\frac{[\\mathrm{H^+}]^2}{K_{a1}K_{a2}} + \\frac{[\\mathrm{H^+}]}{K_{a2}} + 1} $$\nThis can be rearranged to a more convenient form:\n$$ \\alpha_{\\mathrm{C_2O_4^{2-}}} = \\frac{K_{a1}K_{a2}}{[\\mathrm{H^+}]^2 + K_{a1}[\\mathrm{H^+}] + K_{a1}K_{a2}} $$\nNow we can substitute the given numerical values:\n$$ [\\mathrm{H^+}] = 1.00 \\times 10^{-2} $$\n$$ K_{a1} = 5.60 \\times 10^{-2} $$\n$$ K_{a2} = 5.42 \\times 10^{-5} $$\n$$ K_{a1}K_{a2} = (5.60 \\times 10^{-2})(5.42 \\times 10^{-5}) = 3.0352 \\times 10^{-6} $$\n$$ \\alpha_{\\mathrm{C_2O_4^{2-}}} = \\frac{3.0352 \\times 10^{-6}}{(1.00 \\times 10^{-2})^2 + (5.60 \\times 10^{-2})(1.00 \\times 10^{-2}) + 3.0352 \\times 10^{-6}} $$\n$$ \\alpha_{\\mathrm{C_2O_4^{2-}}} = \\frac{3.0352 \\times 10^{-6}}{1.00 \\times 10^{-4} + 5.60 \\times 10^{-4} + 3.0352 \\times 10^{-6}} $$\n$$ \\alpha_{\\mathrm{C_2O_4^{2-}}} = \\frac{3.0352 \\times 10^{-6}}{6.60 \\times 10^{-4} + 0.030352 \\times 10^{-4}} = \\frac{3.0352 \\times 10^{-6}}{6.630352 \\times 10^{-4}} \\approx 4.5777 \\times 10^{-3} $$\nThe relationship between total oxalate and free oxalate is $[\\mathrm{C_2O_4^{2-}}] = \\alpha_{\\mathrm{C_2O_4^{2-}}}[\\mathrm{C_2O_4}]_{total}$. Since $s = [\\mathrm{C_2O_4}]_{total}$, we have:\n$$ [\\mathrm{C_2O_4^{2-}}] = \\alpha_{\\mathrm{C_2O_4^{2-}}} \\cdot s $$\nNow we substitute the expressions for $[\\mathrm{Ca^{2+}}]$ and $[\\mathrm{C_2O_4^{2-}}]$ into the solubility product expression:\n$$ K_{sp} = [\\mathrm{Ca^{2+}}][\\mathrm{C_2O_4^{2-}}] = (s)(\\alpha_{\\mathrm{C_2O_4^{2-}}} \\cdot s) = \\alpha_{\\mathrm{C_2O_4^{2-}}}s^2 $$\nSolving for the molar solubility $s$:\n$$ s = \\sqrt{\\frac{K_{sp}}{\\alpha_{\\mathrm{C_2O_4^{2-}}}}} $$\nSubstituting the numerical values for $K_{sp}$ and the calculated $\\alpha_{\\mathrm{C_2O_4^{2-}}}$:\n$$ s = \\sqrt{\\frac{2.30 \\times 10^{-9}}{4.5777 \\times 10^{-3}}} = \\sqrt{5.02459 \\times 10^{-7}} $$\n$$ s \\approx 7.0884 \\times 10^{-4} \\, \\mathrm{mol\\,L^{-1}} $$\nRounding the result to three significant figures as requested, we obtain the final answer for the molar solubility.\n$$ s \\approx 7.09 \\times 10^{-4} \\, \\mathrm{M} $$\nFor comparison, the solubility in pure water would be $s_0 = \\sqrt{K_{sp}} = \\sqrt{2.30 \\times 10^{-9}} \\approx 4.80 \\times 10^{-5} \\, \\mathrm{M}$. The solubility at $\\mathrm{pH}=2.00$ is significantly higher, confirming our qualitative analysis.",
            "answer": "$$\\boxed{7.09 \\times 10^{-4}}$$"
        },
        {
            "introduction": "This final practice challenges you to construct and solve a comprehensive model that mirrors how complex, real-world aqueous systems are analyzed . You will synthesize all the concepts—solubility, common ions, competing reactions, and activity corrections—into a single set of non-linear equations. The task emphasizes the formulation of the model from first principles and highlights the necessity of numerical methods for solving such intricate systems, a key skill in modern chemical science.",
            "id": "2958971",
            "problem": "A sparingly soluble salt $CaF_2(s)$ is placed in water at $25\\,^\\circ\\mathrm{C}$ together with a weak acid $HF$ and a fully dissociated salt $NaF$. Assume that all equilibria are at $25\\,^\\circ\\mathrm{C}$ and activities are described by the Davies equation. You are to derive, from first principles, the full chemical speciation model and then implement a numerical solver to compute the molar solubility $s$ of $CaF_2$ (defined as the total analytical concentration of dissolved calcium originating from the solid, in $\\mathrm{mol\\cdot L^{-1}}$). Your program must compute $s$ for each case in the test suite given below and print the results as specified.\n\nFundamental base and modeling assumptions to be used:\n- Strong electrolytes dissociate completely (e.g., $NaF \\to Na^+ + F^-$).\n- Equilibrium constants are defined in terms of activities. For a generic reaction $\\sum_i \\nu_i A_i = 0$, the mass action law is $\\prod_i a_i^{\\nu_i} = K$, where $a_i = \\gamma_i c_i$ is the activity of species $i$, $c_i$ is its molar concentration, and $\\gamma_i$ is its activity coefficient.\n- Water autoionization: $H_2O \\rightleftharpoons H^+ + OH^-$ with $K_w = a_{H^+} a_{OH^-}$.\n- Debye–Hückel (Davies) activity coefficient model at $25\\,^\\circ\\mathrm{C}$: for an ion of charge $z$, \n$$\\log_{10}\\gamma = -A z^2\\left(\\frac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3 I\\right),$$\nwith $A = 0.509$ and ionic strength \n$$I = \\tfrac{1}{2}\\sum_i z_i^2 c_i.$$\n- Neutral species have $\\gamma \\approx 1$.\n- The only calcium complex considered is $CaF^+$, with formation constant $K_1$; no other complexes are present in significant amounts.\n- Temperature is constant at $25\\,^\\circ\\mathrm{C}$.\n\nSystem to be modeled:\n- Dissolution (solubility product) of $CaF_2(s)$:\n$$CaF_2(s) \\rightleftharpoons Ca^{2+} + 2F^-,\\quad K_{sp} = a_{Ca^{2+}}\\,a_{F^-}^2.$$\n- Complex formation:\n$$Ca^{2+} + F^- \\rightleftharpoons CaF^+,\\quad K_1 = \\frac{a_{CaF^+}}{a_{Ca^{2+}}\\,a_{F^-}}.$$\n- Weak acid dissociation:\n$$HF \\rightleftharpoons H^+ + F^-,\\quad K_a = \\frac{a_{H^+}\\,a_{F^-}}{a_{HF}}.$$\n- Water:\n$$H_2O \\rightleftharpoons H^+ + OH^-,\\quad K_w = a_{H^+}\\,a_{OH^-}.$$\n\nDefinitions of totals and balances:\n- Let $C_{HF}$ be the formal (analytical) concentration of hydrofluoric acid initially added, in $\\mathrm{mol\\cdot L^{-1}}$. Let $C_{NaF}$ be the formal concentration of sodium fluoride initially added, in $\\mathrm{mol\\cdot L^{-1}}$.\n- Let $s$ denote the total dissolved calcium originating from $CaF_2(s)$, in $\\mathrm{mol\\cdot L^{-1}}$.\n- Calcium mass balance:\n$$s = [Ca^{2+}] + [CaF^+].$$\n- Fluoride element mass balance (counting all fluoride from all sources including dissolution):\n$$C_F^{tot} = C_{NaF} + C_{HF} + 2s = [F^-] + [HF] + [CaF^+].$$\n- Charge balance:\n$$2[Ca^{2+}] + [CaF^+] + [Na^+] + [H^+] = [F^-] + [OH^-].$$\n\nEquilibrium relationships to eliminate dependent species in terms of a minimal set of unknowns:\n- Use $K_{sp}$, $K_1$, $K_a$, and $K_w$ with activities $a_i = \\gamma_i c_i$ to relate $[Ca^{2+}]$, $[F^-]$, $[H^+]$, $[CaF^+]$, $[HF]$, and $[OH^-]$.\n- Use the Davies equation to compute $\\gamma_i$ from the ionic strength $I$ that depends on the ionic species present.\n\nConstants at $25\\,^\\circ\\mathrm{C}$ to be used:\n- $K_{sp}(CaF_2) = 1.46\\times 10^{-10}$.\n- $K_a(HF) = 6.76\\times 10^{-4}$.\n- $K_w = 1.00\\times 10^{-14}$.\n- $K_1(CaF^+) = 7.59$ (formation constant on a molarity and activity basis as defined above).\n- $A = 0.509$ in the Davies equation.\n\nTasks:\n1. From the fundamental base above, write down the complete set of unknowns, the mass balances, the charge balance, and the mass action expressions that together close the system. Your set must be sufficient to solve for $s$ without introducing any additional, unmentioned approximations.\n2. Propose a robust numerical strategy that enforces non-negativity of concentrations, handles the self-consistent dependence of activity coefficients on ionic strength, and converges reliably across a range of $C_{HF}$ and $C_{NaF}$ values.\n3. Implement the strategy in a program that, for each test case, computes $s$ in $\\mathrm{mol\\cdot L^{-1}}$ and prints the results as specified.\n\nNumerical requirements and constraints for the program:\n- Angles do not appear.\n- All concentrations must be non-negative real numbers.\n- Activities must be computed self-consistently with the ionic strength in the Davies equation.\n- The numerical solver must be deterministic and not require user input.\n- For robustness, you may work with logarithms of concentrations as primary unknowns to enforce positivity.\n\nTest suite:\n- Case $1$: $C_{HF} = 0.00\\,\\mathrm{mol\\cdot L^{-1}}$, $C_{NaF} = 0.00\\,\\mathrm{mol\\cdot L^{-1}}$.\n- Case $2$: $C_{HF} = 0.00\\,\\mathrm{mol\\cdot L^{-1}}$, $C_{NaF} = 1.00\\times 10^{-3}\\,\\mathrm{mol\\cdot L^{-1}}$.\n- Case $3$: $C_{HF} = 1.00\\times 10^{-2}\\,\\mathrm{mol\\cdot L^{-1}}$, $C_{NaF} = 0.00\\,\\mathrm{mol\\cdot L^{-1}}$.\n- Case $4$: $C_{HF} = 1.00\\times 10^{-1}\\,\\mathrm{mol\\cdot L^{-1}}$, $C_{NaF} = 1.00\\times 10^{-1}\\,\\mathrm{mol\\cdot L^{-1}}$.\n- Case $5$: $C_{HF} = 0.00\\,\\mathrm{mol\\cdot L^{-1}}$, $C_{NaF} = 1.00\\times 10^{-1}\\,\\mathrm{mol\\cdot L^{-1}}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the computed solubilities for the five cases, expressed in $\\mathrm{mol\\cdot L^{-1}}$, each rounded to six significant figures, as a comma-separated list enclosed in square brackets. For example: $\"[x_1,x_2,x_3,x_4,x_5]\"$ where each $x_i$ is a floating-point number with six significant figures.",
            "solution": "The problem as stated is valid. It is a well-posed problem in advanced chemical equilibrium, grounded in fundamental principles of physical chemistry, including mass action laws, mass and charge conservation, and non-ideal solution theory via the Davies activity model. All necessary constants, equations, and conditions are provided, and no scientific or logical contradictions are present.\n\nThe system describes the dissolution of calcium fluoride, $CaF_2(s)$, in an aqueous solution containing initial amounts of hydrofluoric acid ($C_{HF}$) and sodium fluoride ($C_{NaF}$). The solubility is influenced by several coupled equilibria: the intrinsic solubility of $CaF_2$, the common-ion effect from $NaF$, the pH-dependent speciation of fluoride due to the weak acid $HF$, and the formation of a calcium-fluoride complex, $CaF^+$. The non-ideality of the solution requires the use of activities, which are coupled to the concentrations of all ionic species through the ionic strength, $I$.\n\nThe complete speciation model requires determining the concentrations of all species present at equilibrium: $Ca^{2+}$, $F^-$, $H^+$, $OH^-$, $HF$, $CaF^+$, and $Na^+$. We also seek to determine the molar solubility, $s$, of $CaF_2$.\n\nThe system is governed by a set of algebraic equations:\n\n1.  **Mass Action Laws (Equilibrium Expressions)**: These relate the activities ($a_i = \\gamma_i [X_i]$) of the species involved in the four chemical equilibria.\n    $$K_{sp} = a_{Ca^{2+}} a_{F^-}^2 = (\\gamma_{Ca^{2+}} [Ca^{2+}]) (\\gamma_{F^-} [F^-])^2$$\n    $$K_1 = \\frac{a_{CaF^+}}{a_{Ca^{2+}} a_{F^-}} = \\frac{\\gamma_{CaF^+} [CaF^+]}{(\\gamma_{Ca^{2+}} [Ca^{2+}]) (\\gamma_{F^-} [F^-])}$$\n    $$K_a = \\frac{a_{H^+} a_{F^-}}{a_{HF}} = \\frac{(\\gamma_{H^+} [H^+]) (\\gamma_{F^-} [F^-])}{[HF]}$$\n    (Note: The activity coefficient of the neutral species $HF$ is taken as $\\gamma_{HF} = 1$.)\n    $$K_w = a_{H^+} a_{OH^-} = (\\gamma_{H^+} [H^+]) (\\gamma_{OH^-} [OH^-])$$\n\n2.  **Mass Balance Equations**: These enforce the conservation of atomic species.\n    -   Calcium Balance: The total concentration of dissolved calcium, defined as the solubility $s$, must equal the sum of the concentrations of all calcium-containing species.\n        $$s = [Ca^{2+}] + [CaF^+]$$\n    -   Fluoride Balance: The total concentration of fluoride from all sources (initial $C_{NaF}$, $C_{HF}$, and dissolved $CaF_2$) must equal the sum of the concentrations of all fluoride-containing species in solution.\n        $$C_{NaF} + C_{HF} + 2s = [F^-] + [HF] + [CaF^+]$$\n    -   Sodium Balance: Sodium is a spectator ion from a fully dissociated salt.\n        $$[Na^+] = C_{NaF}$$\n\n3.  **Charge Balance (Electroneutrality)**: The total positive charge concentration in the solution must equal the total negative charge concentration.\n    $$2[Ca^{2+}] + [CaF^+] + [Na^+] + [H^+] = [F^-] + [OH^-]$$\n\n4.  **Activity Coefficient Model**: The Davies equation relates the activity coefficient $\\gamma_i$ of an ion $i$ with charge $z_i$ to the ionic strength $I$ of the solution.\n    $$\\log_{10}\\gamma_i = -A z_i^2 \\left( \\frac{\\sqrt{I}}{1+\\sqrt{I}} - 0.3 I \\right)$$\n    The ionic strength $I$ itself depends on the concentrations $c_j$ and charges $z_j$ of all ions in the solution:\n    $$I = \\frac{1}{2}\\sum_j c_j z_j^2 = \\frac{1}{2} \\left( 4[Ca^{2+}] + [F^-] + [H^+] + [OH^-] + [CaF^+] + [Na^+] \\right)$$\n\nThis system of coupled non-linear equations must be solved simultaneously. A robust numerical strategy involves reducing the system to a minimum number of independent variables (master variables) and solving for them using a root-finding algorithm. We select the concentrations of the fundamental free ions $[Ca^{2+}]$, $[F^-]$, and $[H^+]$ as our master variables. To enforce the physical constraint of non-negative concentrations, we will work with their natural logarithms as the primary unknowns:\n$$y_1 = \\ln([Ca^{2+}]) \\quad \\implies \\quad [Ca^{2+}] = e^{y_1}$$\n$$y_2 = \\ln([F^-]) \\quad \\implies \\quad [F^-] = e^{y_2}$$\n$$y_3 = \\ln([H^+]) \\quad \\implies \\quad [H^+] = e^{y_3}$$\n\nAll other concentrations can be expressed in terms of these master variables and the activity coefficients. The activity coefficients, in turn, depend on all ionic concentrations. This circular dependency requires a self-consistent calculation. Our numerical approach embeds this self-consistency requirement within the function that evaluates the residuals for the root-finder.\n\nWe establish a system of three residual equations, $\\mathbf{F}(\\mathbf{y}) = \\mathbf{0}$, which must be satisfied at the solution $\\mathbf{y} = (y_1, y_2, y_3)^T$.\n\n1.  **Residual $F_1$ (from $K_{sp}$)**: This equation enforces the solubility product equilibrium.\n    $$F_1(\\mathbf{y}) = \\gamma_{Ca^{2+}} e^{y_1} (\\gamma_{F^-} e^{y_2})^2 - K_{sp} = 0$$\n\n2.  **Residual $F_2$ (from Charge Balance)**: This enforces electroneutrality. We substitute the expressions for dependent species concentrations:\n    $$F_2(\\mathbf{y}) = 2e^{y_1} + [CaF^+] + C_{NaF} + e^{y_3} - e^{y_2} - [OH^-] = 0$$\n    where $[OH^-] = \\frac{K_w}{\\gamma_{H^+} \\gamma_{OH^-} e^{y_3}}$ and $[CaF^+] = K_1 \\frac{\\gamma_{Ca^{2+}} \\gamma_{F^-}}{\\gamma_{CaF^+}} e^{y_1} e^{y_2}$.\n\n3.  **Residual $F_3$ (from Fluoride/Calcium Mass Balance)**: By substituting the definition of $s$ into the fluoride balance, we obtain a third independent equation:\n    $$C_{NaF} + C_{HF} + 2([Ca^{2+}] + [CaF^+]) = [F^-] + [HF] + [CaF^+]$$\n    Simplifying gives a residual function:\n    $$F_3(\\mathbf{y}) = C_{NaF} + C_{HF} + 2e^{y_1} + [CaF^+] - e^{y_2} - [HF] = 0$$\n    where $[HF] = \\frac{\\gamma_{H^+} \\gamma_{F^-}}{K_a} e^{y_3} e^{y_2}$.\n\nThe numerical implementation proceeds as follows:\n- For a given vector of unknowns $\\mathbf{y}$, the concentrations $[Ca^{2+}]$, $[F^-]$, and $[H^+]$ are calculated.\n- An iterative inner loop is performed to find a self-consistent ionic strength $I$ and the corresponding set of activity coefficients $\\gamma_i$. In this loop, an initial guess for $I$ is used to calculate $\\gamma_i$ values, which are then used to calculate all dependent species concentrations. A new $I$ is computed from this full set of concentrations, and the process is repeated until $I$ converges.\n- Once the self-consistent $\\gamma_i$ and dependent concentrations are obtained for the given $\\mathbf{y}$, the three residuals $F_1, F_2, F_3$ are computed.\n- A numerical solver, specifically `scipy.optimize.root`, is employed to adjust $\\mathbf{y}$ until the vector of residuals $\\mathbf{F}(\\mathbf{y})$ is driven to zero within a specified tolerance.\n- Upon convergence, the solver returns the solution vector $\\mathbf{y}_{sol}$. The final equilibrium concentrations of all species are calculated from $\\mathbf{y}_{sol}$, and the molar solubility $s$ is computed as $s = [Ca^{2+}] + [CaF^+]$.\n\nThis procedure is deterministic and robust, yielding a physically and chemically meaningful solution for the given initial conditions. The process is repeated for each of the test cases provided.",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import root\n\ndef solve():\n    \"\"\"\n    Computes the molar solubility of CaF2 under various conditions using a\n    full chemical speciation model with Davies activity corrections.\n    \"\"\"\n    \n    # Constants at 25°C\n    K_SP = 1.46e-10  # Solubility product of CaF2\n    K_A = 6.76e-4    # Acid dissociation constant of HF\n    K_W = 1.00e-14   # Ion product of water\n    K_1 = 7.59       # Formation constant of CaF+\n    A_DAVIES = 0.509 # Davies equation parameter\n\n    test_cases = [\n        (0.00, 0.00),             # Case 1: Pure water\n        (0.00, 1.00e-3),          # Case 2: NaF added\n        (1.00e-2, 0.00),          # Case 3: HF added\n        (1.00e-1, 1.00e-1),       # Case 4: HF and NaF buffer\n        (0.00, 1.00e-1),          # Case 5: High NaF\n    ]\n\n    results = []\n\n    for C_HF, C_NaF in test_cases:\n\n        def get_residuals(y):\n            \"\"\"\n            Calculates the residuals of the 3 governing equations for a given\n            set of master variables y = (ln[Ca2+], ln[F-], ln[H+]).\n            This function includes a self-consistent loop to determine\n            activity coefficients.\n            \"\"\"\n            ln_c_ca, ln_c_f, ln_c_h = y\n            c_ca = np.exp(ln_c_ca)\n            c_f = np.exp(ln_c_f)\n            c_h = np.exp(ln_c_h)\n\n            # --- Self-consistent loop for ionic strength and activity coefficients ---\n            # Initial guess for ionic strength I\n            I = 0.5 * (4 * c_ca + c_f + c_h + 1e-7 + c_ca + C_NaF) \n            \n            for _ in range(15): # Loop for self-consistency, 15 is ample\n                if I  0: I = 1e-12 # Prevent math errors\n                sqrt_I = np.sqrt(I)\n                davies_term = sqrt_I / (1.0 + sqrt_I) - 0.3 * I\n                \n                # Activity coefficients (gamma)\n                # z^2=4 for Ca2+\n                gamma_ca = 10**(-A_DAVIES * 4.0 * davies_term)\n                # z^2=1 for H+, OH-, F-, CaF+, Na+\n                gamma_z1 = 10**(-A_DAVIES * 1.0 * davies_term)\n                gamma_h = gamma_oh = gamma_f = gamma_caf = gamma_na = gamma_z1\n\n                # Dependent concentrations\n                c_oh = K_W / (gamma_h * c_h * gamma_oh)\n                c_hf = (gamma_h * c_h * gamma_f * c_f) / K_A # gamma_hf = 1\n                c_caf = K_1 * (gamma_ca * c_ca * gamma_f * c_f) / gamma_caf\n                c_na = C_NaF\n\n                # Recalculate ionic strength I\n                I_new = 0.5 * (4 * c_ca + c_f + c_h + c_oh + c_caf + c_na)\n                \n                if abs(I_new - I)  1e-14 * (I + 1e-14):\n                    break\n                I = I_new\n            \n            # --- Residuals based on mass action, charge balance, mass balance ---\n            \n            # R1: Solubility product equilibrium\n            res1 = gamma_ca * c_ca * (gamma_f * c_f)**2 - K_SP\n            \n            # R2: Charge balance\n            res2 = 2 * c_ca + c_caf + c_na + c_h - c_f - c_oh\n            \n            # R3: Fluoride/Calcium mass balance\n            # C_F_tot + 2*s = [F-] + [HF] + [CaF+] where s = [Ca2+] + [CaF+]\n            # C_NaF + C_HF + 2*([Ca2+] + [CaF+]) = [F-] + [HF] + [CaF+]\n            # Simplified: C_NaF + C_HF + 2*[Ca2+] + [CaF+] - [F-] - [HF] = 0\n            res3 = C_NaF + C_HF + 2 * c_ca + c_caf - c_f - c_hf\n\n            return [res1, res2, res3]\n\n        # Initial guess (y0) for the solver for each case\n        if C_HF == 0 and C_NaF == 0: # Pure water\n            s_guess = (K_SP / 4.0)**(1/3.0)\n            y0 = [np.log(s_guess), np.log(2*s_guess), np.log(1e-7)]\n        elif C_NaF > 0 and C_HF == 0: # Common ion\n            s_guess = K_SP / C_NaF**2\n            y0 = [np.log(s_guess), np.log(C_NaF), np.log(1e-7)]\n        elif C_HF > 0 and C_NaF == 0: # Weak acid\n            h_guess = np.sqrt(K_A * C_HF)\n            s_guess = K_SP / h_guess**2\n            y0 = [np.log(s_guess), np.log(h_guess), np.log(h_guess)]\n        else: # Buffer\n            h_guess = K_A * C_HF / C_NaF\n            s_guess = K_SP / C_NaF**2\n            y0 = [np.log(s_guess), np.log(C_NaF), np.log(h_guess)]\n\n        # Solve the system of non-linear equations\n        sol = root(get_residuals, y0, method='hybr')\n        \n        if not sol.success:\n            # Fallback or error handling if needed, but 'hybr' is robust here.\n            # For this problem, solver is expected to succeed.\n            pass\n\n        # Calculate final solubility s = [Ca2+] + [CaF+]\n        ln_c_ca_sol, ln_c_f_sol, ln_c_h_sol = sol.x\n        c_ca_sol = np.exp(ln_c_ca_sol)\n        c_f_sol = np.exp(ln_c_f_sol)\n        c_h_sol = np.exp(ln_c_h_sol)\n        \n        # Final calculation of c_caf requires final activity coefficients\n        I_final = 0.5 * (4 * c_ca_sol + c_f_sol + c_h_sol + K_W/(c_h_sol) + C_NaF) # Approximate I\n        for _ in range(5):\n             sqrt_I = np.sqrt(I_final)\n             davies_term = sqrt_I / (1.0 + sqrt_I) - 0.3 * I_final\n             gamma_ca = 10**(-A_DAVIES * 4.0 * davies_term)\n             gamma_f = 10**(-A_DAVIES * 1.0 * davies_term)\n             gamma_caf = 10**(-A_DAVIES * 1.0 * davies_term)\n             gamma_h = gamma_oh = gamma_caf\n             c_oh = K_W / (gamma_h**2 * c_h_sol)\n             c_caf_sol = K_1 * (gamma_ca * c_ca_sol * gamma_f * c_f_sol) / gamma_caf\n             I_final_new = 0.5 * (4*c_ca_sol + c_f_sol + c_h_sol + c_oh + c_caf_sol + C_NaF)\n             if abs(I_final_new - I_final)  1e-14:\n                 break\n             I_final = I_final_new\n\n        c_caf_final = K_1 * (gamma_ca * c_ca_sol * gamma_f * c_f_sol) / gamma_caf\n        s = c_ca_sol + c_caf_final\n        results.append(f\"{s:.6g}\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}