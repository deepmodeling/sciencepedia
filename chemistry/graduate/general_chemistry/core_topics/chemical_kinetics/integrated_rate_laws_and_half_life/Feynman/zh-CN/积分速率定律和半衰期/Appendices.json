{
    "hands_on_practices": [
        {
            "introduction": "本实践提供了一个处理二级反应动力学的基础练习，这是化学反应中的一种常见情况。你将从基本的微分速率定律出发，推导时间与反应转化率 $X$ 之间的关系，后者是化学工程和过程设计中的一个关键参数。这个问题旨在强化微积分在解决动力学问题中的直接应用，并展示如何使用不同变量来描述反应进程。",
            "id": "2942228",
            "problem": "一个化学计量比为 $2\\,\\mathrm{A} \\rightarrow \\text{products}$ 的均相等温间歇反应是基元反应。$\\mathrm{A}$ 的消失速率由微分速率定律 $-\\mathrm{d}[A]/\\mathrm{d}t = 2k\\,[A]^{2}$ 给出，其中 $k$ 是反应速率常数。该体系在恒定体积下混合均匀，在 $t=0$ 时的初始浓度为 $[A]_{0} = 0.010\\,\\mathrm{M}$。在所研究的温度下，速率常数为 $k = 0.25\\,\\mathrm{M^{-1}\\,s^{-1}}$。定义 $\\mathrm{A}$ 的分数转化率为 $X \\equiv \\left([A]_{0} - [A]\\right)/[A]_{0}$。仅从基本速率定义和 $X$ 的定义出发，确定达到分数转化率 $X = 0.75$ 所需的时间。然后，验证您的结果与从同一起点推导出的、关联该动力学中 $[A](t)$ 与 $t$ 的积分表达式相一致。时间以秒为单位表示，并将最终数值答案四舍五入至三位有效数字。",
            "solution": "首先对问题陈述进行严格验证。已知条件为：一个二级基元反应 $2\\,\\mathrm{A} \\rightarrow \\text{products}$，其速率定律为 $-\\mathrm{d}[A]/\\mathrm{d}t = 2k\\,[A]^{2}$，初始浓度 $[A]_{0} = 0.010\\,\\mathrm{M}$，速率常数 $k = 0.25\\,\\mathrm{M^{-1}\\,s^{-1}}$，以及目标分数转化率 $X = 0.75$。分数转化率的定义为 $X \\equiv \\left([A]_{0} - [A]\\right)/[A]_{0}$。问题要求首先通过对以 $X$ 表示的速率定律进行直接积分来确定达到此转化率所需的时间，然后使用关于物种浓度 $[A]$ 的标准积分速率定律来验证该结果。该问题具有科学依据，提法明确，客观且内部一致。这是一个化学动力学中的标准问题。因此，该问题被认为是有效的，我们可以继续进行求解。\n\n问题要求从基本定义开始推导。我们首先用分数转化率 $X$ 来表示反应物 $\\mathrm{A}$ 的浓度，记为 $[A]$。定义如下：\n$$X = \\frac{[A]_{0} - [A]}{[A]_{0}}$$\n将此表达式重新整理以求解 $[A]$ 可得：\n$$[A] = [A]_{0} (1 - X)$$\n为了将其与速率定律关联，我们必须求出 $[A]$ 的时间导数。由于 $[A]_{0}$ 是一个常数，对时间 $t$ 求导可得：\n$$\\frac{\\mathrm{d}[A]}{\\mathrm{d}t} = \\frac{\\mathrm{d}}{\\mathrm{d}t} \\left( [A]_{0} (1 - X) \\right) = -[A]_{0} \\frac{\\mathrm{d}X}{\\mathrm{d}t}$$\n给定的微分速率定律是：\n$$-\\frac{\\mathrm{d}[A]}{\\mathrm{d}t} = 2k[A]^{2}$$\n现在我们将以 $X$ 表示的 $[A]$ 及其导数的表达式代入速率定律中。代入 $-\\frac{\\mathrm{d}[A]}{\\mathrm{d}t} = [A]_{0} \\frac{\\mathrm{d}X}{\\mathrm{d}t}$ 和 $[A]^{2} = [A]_{0}^{2}(1-X)^{2}$，我们得到：\n$$[A]_{0} \\frac{\\mathrm{d}X}{\\mathrm{d}t} = 2k [A]_{0}^{2} (1-X)^{2}$$\n这是一个关于 $X(t)$ 的微分方程。我们简化并分离变量，为积分做准备：\n$$\\frac{\\mathrm{d}X}{(1-X)^{2}} = 2k [A]_{0} \\,\\mathrm{d}t$$\n我们将此方程从初始状态（$t=0$ 时 $X=0$）积分到最终状态（时间为 $t$ 时转化率为 $X$）：\n$$\\int_{0}^{X} \\frac{\\mathrm{d}X'}{(1-X')^{2}} = \\int_{0}^{t} 2k [A]_{0} \\,\\mathrm{d}t'$$\n左侧积分为 $\\left[ \\frac{1}{1-X'} \\right]_{0}^{X} = \\frac{1}{1-X} - \\frac{1}{1-0} = \\frac{1}{1-X} - 1 = \\frac{X}{1-X}$。右侧积分为 $2k [A]_{0} t$。将两边结果相等，得到以分数转化率表示的积分速率定律：\n$$\\frac{X}{1-X} = 2k [A]_{0} t$$\n我们求解时间 $t$：\n$$t = \\frac{1}{2k[A]_{0}} \\left( \\frac{X}{1-X} \\right)$$\n现在，我们代入给定的数值：$k = 0.25\\,\\mathrm{M^{-1}\\,s^{-1}}$，$[A]_{0} = 0.010\\,\\mathrm{M}$ 以及 $X = 0.75$。\n$$t = \\frac{1}{2(0.25)(0.010)} \\left( \\frac{0.75}{1-0.75} \\right) = \\frac{1}{0.005} \\left( \\frac{0.75}{0.25} \\right) = (200) \\cdot (3) = 600\\,\\mathrm{s}$$\n\n接下来，我们必须使用关联 $[A]$ 与 $t$ 的标准积分速率定律来验证此结果。我们再次从速率定律开始：\n$$-\\frac{\\mathrm{d}[A]}{\\mathrm{d}t} = 2k[A]^{2}$$\n分离变量可得：\n$$-\\frac{\\mathrm{d}[A]}{[A]^{2}} = 2k \\,\\mathrm{d}t$$\n我们从初始状态（$t=0$ 时 $[A]=[A]_{0}$）积分到最终状态（时间为 $t$ 时浓度为 $[A]$）：\n$$\\int_{[A]_{0}}^{[A]} -\\frac{\\mathrm{d}[A]'}{([A]')^{2}} = \\int_{0}^{t} 2k \\,\\mathrm{d}t'$$\n左侧积分为 $\\left[ \\frac{1}{[A]'} \\right]_{[A]_{0}}^{[A]} = \\frac{1}{[A]} - \\frac{1}{[A]_{0}}$。右侧为 $2kt$。这就得出了我们熟悉的二级反应的积分速率定律：\n$$\\frac{1}{[A]} - \\frac{1}{[A]_{0}} = 2kt$$\n要使用此方程，我们必须求出当分数转化率 $X$ 为 $0.75$ 时的浓度 $[A]$：\n$$[A] = [A]_{0} (1 - X) = (0.010\\,\\mathrm{M}) (1 - 0.75) = (0.010\\,\\mathrm{M}) (0.25) = 0.0025\\,\\mathrm{M}$$\n现在，我们求解积分速率定律中的时间 $t$：\n$$t = \\frac{1}{2k} \\left( \\frac{1}{[A]} - \\frac{1}{[A]_{0}} \\right)$$\n代入数值：\n$$t = \\frac{1}{2(0.25)} \\left( \\frac{1}{0.0025} - \\frac{1}{0.010} \\right) = \\frac{1}{0.5} \\left( 400 - 100 \\right) = 2 (300) = 600\\,\\mathrm{s}$$\n两种方法得到的结果相同，这便完成了所要求的验证。确切时间是 $600\\,\\mathrm{s}$。题目要求答案四舍五入至三位有效数字，即 $6.00 \\times 10^2\\,\\mathrm{s}$。",
            "answer": "$$\\boxed{6.00 \\times 10^{2}}$$"
        },
        {
            "introduction": "在掌握了积分速率定律的推导之后，下一个关键步骤是学习如何使用它们来解释实验数据。本练习要求你设计一种图形策略，以区分一级和二级反应动力学，这是实验化学中的一项基本任务。通过确定能产生直线的正确数据变换方式，你将练习模型辨别的核心技能，并将抽象的数学方程与其图形特征联系起来。",
            "id": "2942179",
            "problem": "通过测量从初始浓度 $[A]_0$ 开始，在多个时间点 $t \\ge 0$ 的浓度 $[A](t)$，研究一个单反应物、等温、恒容的分解反应 $A \\rightarrow \\text{产物}$。假设该体系为基元反应，其速率定律形式为 $-\\dfrac{d[A]}{dt} = k [A]^n$，其中 $k>0$，级数 $n$ 为整数且 $n \\in \\{1,2\\}$；假设没有逆反应和副反应。定义半衰期 $t_{1/2}$ 为满足 $[A](t_{1/2}) = \\dfrac{[A]_0}{2}$ 的时间。您希望设计一种作图策略，该策略应满足：(i) 如果级数假设正确，经过正确的变换后能产生一条直线；(ii) 其斜率能直接用 $k$ 解释，且其符号能被动力学正确预测；(iii) 通过比较在两种不同初始浓度 $[A]_0$ 和 $f[A]_0$（其中 $f>0$）下进行的实验，利用 $t_{1/2}$ 如何随 $[A]_0$ 变化的规律，提供一种辅助诊断方法。请选择一个选项，该选项能同时对 $n=1$ 和 $n=2$ 的情况正确地指明：变换后的纵坐标对 $t$ 的线性图、以 $k$ 表示的斜率的符号和大小，以及 $t_{1/2}$ 对 $[A]_0$ 的定性依赖关系。\n\nA. 一级反应：绘制 $\\ln[A]$ 对 $t$ 的图像；预期斜率为 $-k$。二级反应：绘制 $1/[A]$ 对 $t$ 的图像；预期斜率为 $-k$。半衰期：两种级数的 $t_{1/2}$ 均与 $[A]_0$ 无关。\n\nB. 一级反应：绘制 $[A]$ 对 $t$ 的图像；预期斜率为 $-k$。二级反应：绘制 $1/[A]$ 对 $t$ 的图像；预期斜率为 $+k$。半衰期：两种级数的 $t_{1/2}$ 均与 $[A]_0$ 无关。\n\nC. 一级反应：绘制 $\\ln[A]$ 对 $t$ 的图像；预期斜率为 $-k$。二级反应：绘制 $1/[A]$ 对 $t$ 的图像；预期斜率为 $+k$。半衰期：对于一级反应，$t_{1/2}$ 与 $[A]_0$ 无关，而对于二级反应，$t_{1/2} \\propto 1/[A]_0$（因此将 $[A]_0$ 替换为 $f[A]_0$ 会使 $t_{1/2}$ 缩放 $1/f$ 倍）。\n\nD. 一级反应：绘制 $1/[A]$ 对 $t$ 的图像；预期斜率为 $+k$。二级反应：绘制 $\\ln[A]$ 对 $t$ 的图像；预期斜率为 $-k$。半衰期：对于二级反应，$t_{1/2}$ 与 $[A]_0$ 无关，而对于一级反应，$t_{1/2} \\propto 1/[A]_0$。\n\nE. 一级反应：绘制 $\\log_{10}[A]$ 对 $t$ 的图像；预期斜率为 $-k$。二级反应：绘制 $1/[A]$ 对 $t$ 的图像；预期斜率为 $+k$。半衰期：对于一级反应，$t_{1/2}$ 与 $[A]_0$ 无关，而对于二级反应，$t_{1/2} \\propto 1/[A]_0$。\n\n请选择唯一的一个选项。",
            "solution": "问题陈述提出了一个化学动力学中的标准练习，要求推导和比较一级反应和二级反应的积分速率定律。我将首先验证问题，然后从第一性原理出发，系统地推导求解。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- **反应：** 单反应物、等温、恒容的分解反应 $A \\rightarrow \\text{产物}$。\n- **速率定律：** $-\\dfrac{d[A]}{dt} = k [A]^n$，速率常数 $k>0$。\n- **反应级数：** 级数 $n$ 为整数，$n \\in \\{1,2\\}$。\n- **条件：** 无逆反应，无副反应。\n- **初始条件：** $t=0$ 时浓度为 $[A]_0$。\n- **半衰期定义：** $[A](t_{1/2}) = \\dfrac{[A]_0}{2}$。\n- **目标：** 对 $n=1$ 和 $n=2$ 的情况，确定正确的线性图（变换后的纵坐标对 $t$），以 $k$ 表示的相应斜率，以及 $t_{1/2}$ 对 $[A]_0$ 的依赖关系。\n\n**步骤2：验证已知条件**\n该问题具有科学依据，因为它基于化学动力学的基本原理。速率定律 $-\\dfrac{d[A]}{dt} = k [A]^n$ 是该领域的基石。所提供的条件（等温、恒容、无副反应）是推导积分速率定律时标准的简化假设。问题提法得当；它要求为基元反应级数推导出标准的、唯一的结果。语言客观而精确。所有必要信息均已提供，且无内部矛盾。\n\n**步骤3：结论**\n问题陈述有效。我将继续进行推导。\n\n### 推导与求解\n\n问题的核心是求解特定整数级数 $n=1$ 和 $n=2$ 的微分速率定律。\n\n**情况1：一级反应 ($n=1$)**\n\n速率定律为：\n$$-\\frac{d[A]}{dt} = k[A]$$\n这是一个可分离的一阶微分方程。我们重排各项以分离变量 $[A]$ 和 $t$：\n$$\\frac{d[A]}{[A]} = -k \\, dt$$\n接下来，我们对两边进行积分。浓度范围从时间 $t=0$ 时的初始值 $[A]_0$ 到时间 $t$ 时的 $[A]$。\n$$\\int_{[A]_0}^{[A]} \\frac{1}{[A']} \\, d[A'] = \\int_0^t -k \\, dt'$$\n进行定积分得到：\n$$[\\ln[A']]_{[A]_0}^{[A]} = [-kt']_0^t$$\n$$\\ln[A] - \\ln[A]_0 = -kt$$\n这个方程是一级反应的积分速率定律。为了确定线性图，我们将其重排为线性方程的形式 $y=mx+b$：\n$$\\ln[A] = -kt + \\ln[A]_0$$\n从这个形式可以明显看出，绘制 $y = \\ln[A]$ 对 $x = t$ 的图像将产生一条直线。\n- **线性图：** $\\ln[A]$ 对 $t$。\n- **斜率：** 该直线的斜率为 $m = -k$。由于给定 $k>0$，斜率为负。\n\n为了求出半衰期 $t_{1/2}$，我们使用其定义：在 $t = t_{1/2}$ 时，$[A] = [A]_0/2$。将此代入积分速率定律：\n$$\\ln\\left(\\frac{[A]_0}{2}\\right) = -k t_{1/2} + \\ln[A]_0$$\n$$\\ln[A]_0 - \\ln(2) = -k t_{1/2} + \\ln[A]_0$$\n$$-\\ln(2) = -k t_{1/2}$$\n$$t_{1/2} = \\frac{\\ln(2)}{k}$$\n- **半衰期依赖性：** $t_{1/2}$ 的表达式不包含 $[A]_0$ 项。因此，一级反应的半衰期与初始浓度无关。\n\n**情况2：二级反应 ($n=2$)**\n\n速率定律为：\n$$-\\frac{d[A]}{dt} = k[A]^2$$\n同样，这是一个可分离的微分方程。我们重排并积分：\n$$\\frac{d[A]}{[A]^2} = -k \\, dt$$\n$$\\int_{[A]_0}^{[A]} [A']^{-2} \\, d[A'] = \\int_0^t -k \\, dt'$$\n进行积分：\n$$\\left[-\\frac{1}{[A']}\\right]_{[A]_0}^{[A]} = [-kt']_0^t$$\n$$-\\frac{1}{[A]} - \\left(-\\frac{1}{[A]_0}\\right) = -kt$$\n$$\\frac{1}{[A]_0} - \\frac{1}{[A]} = -kt$$\n为了得到线性形式 $y=mx+b$，我们重排：\n$$\\frac{1}{[A]} = kt + \\frac{1}{[A]_0}$$\n这个方程表明，绘制 $y = 1/[A]$ 对 $x = t$ 的图像将是一条直线。\n- **线性图：** $1/[A]$ 对 $t$。\n- **斜率：** 该直线的斜率为 $m = +k$。由于 $k>0$，斜率为正。\n\n为了求出半衰期 $t_{1/2}$，我们在 $t = t_{1/2}$ 时代入 $[A] = [A]_0/2$：\n$$\\frac{1}{[A]_0/2} = k t_{1/2} + \\frac{1}{[A]_0}$$\n$$\\frac{2}{[A]_0} = k t_{1/2} + \\frac{1}{[A]_0}$$\n$$\\frac{1}{[A]_0} = k t_{1/2}$$\n$$t_{1/2} = \\frac{1}{k[A]_0}$$\n- **半衰期依赖性：** 二级反应的半衰期与初始浓度成反比，即 $t_{1/2} \\propto 1/[A]_0$。因此，如果初始浓度从 $[A]_0$ 变为 $f[A]_0$，新的半衰期将缩放 $1/f$ 倍。\n\n### 选项评估\n\n现在我将根据这些推导出的结果来评估每个选项。\n\n**A.** 一级反应：绘制 $\\ln[A]$ 对 $t$ 的图像；斜率为 $-k$。此项正确。二级反应：绘制 $1/[A]$ 对 $t$ 的图像；斜率为 $-k$。此项错误；斜率应为 $+k$。半衰期：两种级数均无关。此项对二级反应是错误的。\n**结论：错误。**\n\n**B.** 一级反应：绘制 $[A]$ 对 $t$ 的图像。此项错误；该图对零级反应是线性的，而非一级反应。二级反应：绘制 $1/[A]$ 对 $t$ 的图像；斜率为 $+k$。此项正确。半衰期：两种级数均无关。此项错误。\n**结论：错误。**\n\n**C.** 一级反应：绘制 $\\ln[A]$ 对 $t$ 的图像；斜率为 $-k$。此项正确。二级反应：绘制 $1/[A]$ 对 $t$ 的图像；斜率为 $+k$。此项正确。半衰期：对于一级反应，$t_{1/2}$ 与 $[A]_0$ 无关；对于二级反应，$t_{1/2} \\propto 1/[A]_0$。此项正确。此选项的所有部分都与我们的推导一致。\n**结论：正确。**\n\n**D.** 此选项错误地交换了一级和二级反应的动力学特征。它将一级反应的图像描述为 $1/[A]$ 对 $t$，二级反应的图像描述为 $\\ln[A]$ 对 $t$。\n**结论：错误。**\n\n**E.** 一级反应：绘制 $\\log_{10}[A]$ 对 $t$ 的图像；斜率为 $-k$。此项错误。$\\log_{10}[A]$ 对 $t$ 的图像确实是线性的，但其斜率不是 $-k$。使用关系式 $\\ln[A] = \\ln(10) \\log_{10}[A]$，积分速率定律变为 $\\ln(10) \\log_{10}[A] = -kt + \\ln(10) \\log_{10}[A]_0$。这得到 $\\log_{10}[A] = (-k/\\ln(10))t + \\log_{10}[A]_0$。斜率为 $-k/\\ln(10)$，或约等于 $-k/2.303$，而不是 $-k$。该选项的其余部分是正确的，但第一部分使其无效。\n**结论：错误。**\n\n唯一能同时正确描述两种反应级数动力学的选项是 C。",
            "answer": "$$\\boxed{C}$$"
        },
        {
            "introduction": "现实世界中的化学体系常常偏离理想条件，在理想条件下速率“常数”是恒定的。这个高级实践将推动你超越这些理想化模型，引入一个随时间变化的速率系数 $k(t)$。你将通过实施数值积分方案来求解速率方程，并将其结果与解析解进行比较，从而将分析理论与计算实践联系起来，展示一种解决复杂、非理想动力学问题的强大方法。",
            "id": "2942187",
            "problem": "单个反应物经历一级衰变，其速率系数随时间变化。其瞬时速率定律由常微分方程（ODE）$\\,\\dfrac{dC}{dt} = -k(t)\\,C\\,$ 给出，初始条件为 $\\,C(0)=C_0\\,$，其中 $\\,C(t)\\,$ 是在时间 $\\,t\\,$ 的浓度，$\\,k(t)\\,$ 是速率系数，$\\,C_0\\,$ 是一个正常数。半衰期 $\\,t_{1/2}\\,$ 定义为满足 $\\,C(t_{1/2}) = \\dfrac{C_0}{2}\\,$ 的唯一时间。仅从该ODE和半衰期的定义出发（不使用任何预先记下的积分形式），推导出一个确定 $\\,t_{1/2}\\,$ 的准则，该准则用一个包含 $\\,k(t)\\,$ 的积分表示。然后，对下面每个测试案例中指定的具体 $\\,k(t)\\,$，使用此准则获得 $\\,t_{1/2}\\,$ 的解析目标方程。\n\n接下来，实现一个固定步长的显式四阶Runge–Kutta时间推进格式，从 $\\,t=0\\,$ 和 $\\,C(0)=C_0\\,$ 开始，以步长 $\\,\\Delta t = 10^{-4}\\,$ 秒（s）对该ODE的解进行数值近似。在时间上向前推进，直到数值解越过半浓度阈值。通过在跨越阈值 $\\,C=C_0/2\\,$ 的最后两个时间节点 $\\,t_n\\,$ 和 $\\,t_{n+1}=t_n+\\Delta t\\,$ 之间进行线性插值，来估算数值半衰期 $\\,\\widehat{t}_{1/2}\\,$。对每个测试案例，计算绝对差 $\\,|\\,\\widehat{t}_{1/2} - t_{1/2}\\,|\\,$，单位为秒（s）。\n\n对于每个案例中的解析目标 $\\,t_{1/2}\\,$，按以下步骤进行。首先，根据你的积分准则，推导出闭式反导数（不定积分）$\\,\\int_0^t k(\\tau)\\,d\\tau\\,$. 然后：\n- 当求解 $\\,t_{1/2}\\,$ 的过程可以简化为代数或初等函数时，完成代数运算以显式地获得 $\\,t_{1/2}\\,$。\n- 当求解 $\\,t_{1/2}\\,$ 的方程是超越方程时，对解析积分后的形式使用一个稳健的标量求根方法（此步骤不要使用ODE的数值时间步进）。在以下所有案例中，假设存在唯一的正解。\n\n使用 $\\,C_0 = 1.0\\,$（任意浓度单位）。时间单位为秒（s），速率常数单位为秒的倒数（s$^{-1}$）或相应的导出单位。所有答案必须以秒（s）为单位，用十进制数表示。\n\n测试套件：\n- 案例 $\\,1\\,$ (速率随时间线性变化): $\\,k(t)=k_0 + a\\,t\\,$，参数为 $\\,k_0 = 0.5\\,$ s$^{-1}$ 和 $\\,a = 0.1\\,$ s$^{-2}$。\n- 案例 $\\,2\\,$ (速率呈指数衰减): $\\,k(t)=k_0\\,e^{-b\\,t}\\,$，参数为 $\\,k_0 = 1.0\\,$ s$^{-1}$ 和 $\\,b = 0.5\\,$ s$^{-1}$。\n- 案例 $\\,3\\,$ (带有正常数偏移的正弦调制速率): $\\,k(t)=k_0 + A\\sin(\\omega t)\\,$，参数为 $\\,k_0 = 0.8\\,$ s$^{-1}$，$\\,A = 0.3\\,$ s$^{-1}$ 和 $\\,\\omega = 2.0\\,$ s$^{-1}$。\n- 案例 $\\,4\\,$ (速率呈分段常数的阶跃变化): $\\,k(t)=k_1\\,$ 对于 $\\,0 \\le t < t_s\\,$ 并且 $\\,k(t)=k_2\\,$ 对于 $\\,t \\ge t_s\\,$，参数为 $\\,k_1 = 0.2\\,$ s$^{-1}$，$\\,k_2 = 1.5\\,$ s$^{-1}$ 和 $\\,t_s = 2.0\\,$ s。\n\n数值格式要求：\n- 对Runge–Kutta方法使用固定时间步长 $\\,\\Delta t = 10^{-4}\\,$ s。\n- 为ODE $\\,\\dfrac{dC}{dt}=-k(t)\\,C\\,$ 实现经典的四阶Runge–Kutta更新。\n- 检测首次穿过 $\\,C=C_0/2\\,$ 的点，并通过在两个相邻节点之间进行线性插值来估算 $\\,\\widehat{t}_{1/2}\\,$。\n\n解析目标：\n- 对于案例 $\\,1\\,$, $\\,2\\,$ 和 $\\,4\\,$，在对 $\\,k(t)\\,$ 积分后，使用初等代数显式求解 $\\,t_{1/2}\\,$。\n- 对于案例 $\\,3\\,$，在对 $\\,k(t)\\,$ 积分后，对积分后的表达式使用一个稳健的一维求根器，求解得到的标量方程以获得 $\\,t_{1/2}\\,$。\n\n你的程序应生成单行输出，其中包含四个案例的绝对差，形式为用方括号括起来的逗号分隔列表（例如，$[d_1,d_2,d_3,d_4]$），其中每个 $\\,d_i\\,$ 是以秒（s）为单位的绝对误差 $\\,|\\,\\widehat{t}_{1/2}-t_{1/2}\\,|\\,$，表示为十进制数。",
            "solution": "问题陈述将进行验证。\n\n**步骤1：提取已知条件**\n- **控制方程**：常微分方程（ODE）$\\dfrac{dC}{dt} = -k(t)\\,C$。\n- **初始条件**：$C(0) = C_0$，其中 $C_0$ 是一个正常数。\n- **半衰期定义**：$t_{1/2}$ 是唯一的满足 $C(t_{1/2}) = \\dfrac{C_0}{2}$ 的时间。\n- **数值方法**：四阶显式Runge-Kutta (RK4) 格式。\n- **时间步长**：$\\Delta t = 10^{-4}$ s。\n- **数值半衰期估算**：在包含 $C = C_0/2$ 阈值的时间节点之间进行线性插值。\n- **初始浓度**：所有计算均使用 $C_0 = 1.0$。\n- **测试案例1**：$k(t)=k_0 + a\\,t$，其中 $k_0 = 0.5\\,$ s$^{-1}$，$a = 0.1\\,$ s$^{-2}$。\n- **测试案例2**：$k(t)=k_0\\,e^{-b\\,t}$，其中 $k_0 = 1.0\\,$ s$^{-1}$，$b = 0.5\\,$ s$^{-1}$。\n- **测试案例3**：$k(t)=k_0 + A\\sin(\\omega t)$，其中 $k_0 = 0.8\\,$ s$^{-1}$，$A = 0.3\\,$ s$^{-1}$，$\\omega = 2.0\\,$ s$^{-1}$。注意，对于所有 $t \\ge 0$，$k(t) \\ge k_0 - A = 0.8 - 0.3 = 0.5 > 0$。\n- **测试案例4**：分段常数 $k(t)$，其中 $k(t)=k_1$ 对于 $0 \\le t < t_s$ 且 $k(t)=k_2$ 对于 $t \\ge t_s$，其中 $k_1 = 0.2\\,$ s$^{-1}$，$k_2 = 1.5\\,$ s$^{-1}$，$t_s = 2.0\\,$ s。\n\n**步骤2：使用提取的已知条件进行验证**\n- **有科学依据**：该问题描述了具有时变速率系数的一级化学动力学。这是物理化学和化学工程中的一个标准且成熟的课题。所有给出的 $k(t)$ 函数在物理上都是现实的（它们对于所有 $t \\ge 0$ 都保持正值）。\n- **适定的**：该问题是一个线性一阶常微分方程的适定初值问题，保证有唯一解。寻找解析和数值半衰期的条件已明确规定。\n- **客观的**：该问题以精确、定量和明确的术语陈述。\n\n**步骤3：结论与行动**\n该问题有科学依据、适定且客观。它不包含可辨别的缺陷。因此，该问题是**有效的**。将构建一个解决方案。\n\n**基于原理的解答**\n\n该解答分为三部分：首先，推导半衰期 $t_{1/2}$ 的通用解析准则；其次，将此准则应用于每种具体情况，以确定 $t_{1/2}$ 的解析目标方程；第三，描述用于找到近似半衰期 $\\widehat{t}_{1/2}$ 的数值格式。\n\n**第1部分：半衰期的通用解析准则**\n\n控制微分方程为：\n$$ \\dfrac{dC}{dt} = -k(t)\\,C $$\n这是一个线性一阶可分离常微分方程。我们分离变量：\n$$ \\dfrac{1}{C} dC = -k(t) dt $$\n我们对两边从初始条件 $(t=0, C=C_0)$ 到任意状态 $(t, C(t))$ 进行积分。为避免混淆，我们使用积分哑变量，$\\tau$ 表示时间，$C'$ 表示浓度。\n$$ \\int_{C_0}^{C(t)} \\dfrac{1}{C'} dC' = -\\int_0^t k(\\tau) d\\tau $$\n计算左侧积分可得：\n$$ \\left[ \\ln(C') \\right]_{C_0}^{C(t)} = \\ln(C(t)) - \\ln(C_0) = \\ln\\left(\\dfrac{C(t)}{C_0}\\right) $$\n因此，积分速率定律的一般形式为：\n$$ \\ln\\left(\\dfrac{C(t)}{C_0}\\right) = -\\int_0^t k(\\tau) d\\tau $$\n根据半衰期的定义，在 $t = t_{1/2}$ 时，浓度为 $C(t_{1/2}) = C_0 / 2$。我们将此代入积分速率定律：\n$$ \\ln\\left(\\dfrac{C_0/2}{C_0}\\right) = -\\int_0^{t_{1/2}} k(\\tau) d\\tau $$\n$$ \\ln\\left(\\dfrac{1}{2}\\right) = -\\ln(2) = -\\int_0^{t_{1/2}} k(\\tau) d\\tau $$\n这得出了确定半衰期 $t_{1/2}$ 的基本准则：\n$$ \\int_0^{t_{1/2}} k(\\tau) d\\tau = \\ln(2) $$\n此方程是所有测试案例中找到 $t_{1/2}$ 解析值的基础。\n\n**第2部分：测试案例的解析半衰期方程**\n\n对于每个案例，我们首先计算定积分 $\\int_0^t k(\\tau)d\\tau$。\n\n**案例1：$k(t) = k_0 + a\\,t$**\n积分为：\n$$ \\int_0^t (k_0 + a\\tau)d\\tau = \\left[ k_0\\tau + \\dfrac{1}{2}a\\tau^2 \\right]_0^t = k_0t + \\dfrac{1}{2}at^2 $$\n设 $t=t_{1/2}$ 并使其等于 $\\ln(2)$，得到一个关于 $t_{1/2}$ 的二次方程：\n$$ \\dfrac{1}{2}a t_{1/2}^2 + k_0 t_{1/2} - \\ln(2) = 0 $$\n物理上有意义的解必须为正，因此我们取二次方程求根公式的正根：\n$$ t_{1/2} = \\dfrac{-k_0 + \\sqrt{k_0^2 - 4(\\frac{1}{2}a)(-\\ln(2))}}{a} = \\dfrac{-k_0 + \\sqrt{k_0^2 + 2a\\ln(2)}}{a} $$\n\n**案例2：$k(t) = k_0e^{-bt}$**\n积分为：\n$$ \\int_0^t k_0e^{-b\\tau}d\\tau = k_0 \\left[ -\\dfrac{1}{b}e^{-b\\tau} \\right]_0^t = -\\dfrac{k_0}{b}(e^{-bt} - e^0) = \\dfrac{k_0}{b}(1 - e^{-bt}) $$\n设 $t=t_{1/2}$ 并使其等于 $\\ln(2)$，得到：\n$$ \\dfrac{k_0}{b}(1 - e^{-bt_{1/2}}) = \\ln(2) $$\n通过代数变换解出 $t_{1/2}$：\n$$ 1 - e^{-bt_{1/2}} = \\dfrac{b\\ln(2)}{k_0} \\implies e^{-bt_{1/2}} = 1 - \\dfrac{b\\ln(2)}{k_0} $$\n$$ -bt_{1/2} = \\ln\\left(1 - \\dfrac{b\\ln(2)}{k_0}\\right) \\implies t_{1/2} = -\\dfrac{1}{b}\\ln\\left(1 - \\dfrac{b\\ln(2)}{k_0}\\right) $$\n\n**案例3：$k(t) = k_0 + A\\sin(\\omega t)$**\n积分为：\n$$ \\int_0^t (k_0 + A\\sin(\\omega\\tau))d\\tau = \\left[ k_0\\tau - \\dfrac{A}{\\omega}\\cos(\\omega\\tau) \\right]_0^t = \\left( k_0t - \\dfrac{A}{\\omega}\\cos(\\omega t) \\right) - \\left( 0 - \\dfrac{A}{\\omega}\\cos(0) \\right) = k_0t - \\dfrac{A}{\\omega}\\cos(\\omega t) + \\dfrac{A}{\\omega} $$\n设 $t=t_{1/2}$ 并使其等于 $\\ln(2)$，得到一个超越方程：\n$$ k_0t_{1/2} - \\dfrac{A}{\\omega}\\cos(\\omega t_{1/2}) + \\dfrac{A}{\\omega} - \\ln(2) = 0 $$\n此方程没有简单的 $t_{1/2}$ 代数解，必须使用数值求根算法求解。\n\n**案例4：分段常数 $k(t)$**\n积分取决于 $t$ 是小于还是大于 $t_s$。首先，我们必须通过计算在 $t=t_s$ 时的积分值来确定 $t_{1/2}$ 是小于还是大于 $t_s$：\n$$ \\int_0^{t_s} k(\\tau)d\\tau = \\int_0^{t_s} k_1 d\\tau = k_1t_s $$\n如果 $k_1t_s > \\ln(2)$，则 $t_{1/2} < t_s$。$t_{1/2}$ 的方程为 $k_1t_{1/2} = \\ln(2)$，所以 $t_{1/2} = \\ln(2)/k_1$。\n如果 $k_1t_s \\le \\ln(2)$，则 $t_{1/2} \\ge t_s$。积分在 $t_s$ 处分段：\n$$ \\int_0^{t_{1/2}} k(\\tau)d\\tau = \\int_0^{t_s} k_1 d\\tau + \\int_{t_s}^{t_{1/2}} k_2 d\\tau = k_1t_s + k_2(t_{1/2} - t_s) $$\n令其等于 $\\ln(2)$，得到一个关于 $t_{1/2}$ 的线性方程：\n$$ k_1t_s + k_2(t_{1/2} - t_s) = \\ln(2) \\implies t_{1/2} = t_s + \\dfrac{\\ln(2) - k_1t_s}{k_2} $$\n\n**第3部分：数值解法**\nODE $dC/dt = f(t,C) = -k(t)C$ 的数值解是使用经典的四阶Runge-Kutta (RK4) 方法获得的。给定状态 $(t_n, C_n)$，下一个时间步的状态 $(t_n+\\Delta t, C_{n+1})$ 计算如下：\n$$ C_{n+1} = C_n + \\dfrac{\\Delta t}{6}(s_1 + 2s_2 + 2s_3 + s_4) $$\n其中斜率 $s_i$ 为：\n$$ s_1 = f(t_n, C_n) = -k(t_n)C_n $$\n$$ s_2 = f\\left(t_n + \\dfrac{\\Delta t}{2}, C_n + \\dfrac{\\Delta t}{2}s_1\\right) = -k\\left(t_n + \\dfrac{\\Delta t}{2}\\right)\\left(C_n + \\dfrac{\\Delta t}{2}s_1\\right) $$\n$$ s_3 = f\\left(t_n + \\dfrac{\\Delta t}{2}, C_n + \\dfrac{\\Delta t}{2}s_2\\right) = -k\\left(t_n + \\dfrac{\\Delta t}{2}\\right)\\left(C_n + \\dfrac{\\Delta t}{2}s_2\\right) $$\n$$ s_4 = f(t_n + \\Delta t, C_n + \\Delta t s_3) = -k(t_n + \\Delta t)(C_n + \\Delta t s_3) $$\n从 $(t_0, C_0)=(0, 1.0)$ 开始，以固定步长 $\\Delta t = 10^{-4}$ s 进行时间推进，直到浓度越过阈值 $C_0/2 = 0.5$。这发生在 $C_n \\ge 0.5$ 且 $C_{n+1} < 0.5$ 时。此时，两个点 $(t_n, C_n)$ 和 $(t_{n+1}, C_{n+1})$ 包含了半衰期。\n\n数值半衰期 $\\widehat{t}_{1/2}$ 通过在这两点之间进行线性插值来估计。我们在通过 $(t_n, C_n)$ 和 $(t_{n+1}, C_{n+1})$ 的直线上，求解浓度为 $0.5$ 时的 $\\widehat{t}_{1/2}$：\n$$ \\dfrac{\\widehat{t}_{1/2} - t_n}{t_{n+1} - t_n} = \\dfrac{0.5 - C_n}{C_{n+1} - C_n} $$\n注意到 $t_{n+1} - t_n = \\Delta t$，我们得到：\n$$ \\widehat{t}_{1/2} = t_n + \\Delta t \\left(\\dfrac{0.5 - C_n}{C_{n+1} - C_n}\\right) $$\n最后的任务是计算四个案例中每一个的绝对差 $|\\widehat{t}_{1/2} - t_{1/2}|$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Solves the problem of finding analytical and numerical half-times for a first-order\n    decay with a time-dependent rate coefficient, and computes the absolute difference.\n    \"\"\"\n    \n    C0 = 1.0  # Initial concentration\n    DT = 1e-4   # Time step for RK4\n\n    # Test cases defined in the problem statement\n    test_cases = [\n        {'id': 1, 'params': {'k0': 0.5, 'a': 0.1}},\n        {'id': 2, 'params': {'k0': 1.0, 'b': 0.5}},\n        {'id': 3, 'params': {'k0': 0.8, 'A': 0.3, 'omega': 2.0}},\n        {'id': 4, 'params': {'k1': 0.2, 'k2': 1.5, 'ts': 2.0}},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        case_id = case['id']\n        params = case['params']\n        \n        # Define k(t) function for the current case\n        if case_id == 1:\n            k_func = lambda t, p: p['k0'] + p['a'] * t\n        elif case_id == 2:\n            k_func = lambda t, p: p['k0'] * np.exp(-p['b'] * t)\n        elif case_id == 3:\n            k_func = lambda t, p: p['k0'] + p['A'] * np.sin(p['omega'] * t)\n        elif case_id == 4:\n            k_func = lambda t, p: p['k1'] if t < p['ts'] else p['k2']\n\n        # --- Analytical Half-Time Calculation ---\n        ln2 = np.log(2)\n        \n        if case_id == 1:\n            k0, a = params['k0'], params['a']\n            # Solve quadratic equation: 0.5*a*t^2 + k0*t - ln(2) = 0\n            t_half_analytical = (-k0 + np.sqrt(k0**2 + 2 * a * ln2)) / a\n        elif case_id == 2:\n            k0, b = params['k0'], params['b']\n            # Solve t = -1/b * ln(1 - (b*ln(2))/k0)\n            t_half_analytical = -1/b * np.log(1 - (b * ln2) / k0)\n        elif case_id == 3:\n            k0, A, w = params['k0'], params['A'], params['omega']\n            # Solve transcendental equation: k0*t - A/w*cos(w*t) + A/w - ln(2) = 0\n            root_func = lambda t: k0*t - (A/w)*np.cos(w*t) + (A/w) - ln2\n            # Initial guess: t_1/2 for constant k=k0\n            t_guess = ln2 / k0\n            sol = root_scalar(root_func, bracket=[t_guess * 0.5, t_guess * 1.5], method='brentq')\n            t_half_analytical = sol.root\n        elif case_id == 4:\n            k1, k2, ts = params['k1'], params['k2'], params['ts']\n            # Check if t_1/2 is before or after the step time ts\n            integral_at_ts = k1 * ts\n            if integral_at_ts >= ln2:\n                t_half_analytical = ln2 / k1\n            else:\n                t_half_analytical = ts + (ln2 - integral_at_ts) / k2\n\n        # --- Numerical Half-Time Calculation using RK4 ---\n        t = 0.0\n        C = C0\n        t_prev, C_prev = t, C\n\n        while C >= C0 / 2.0:\n            t_prev, C_prev = t, C\n            \n            # Classical RK4 slopes\n            s1 = -k_func(t, params) * C\n            s2 = -k_func(t + 0.5 * DT, params) * (C + 0.5 * DT * s1)\n            s3 = -k_func(t + 0.5 * DT, params) * (C + 0.5 * DT * s2)\n            s4 = -k_func(t + DT, params) * (C + DT * s3)\n            \n            # Update concentration and time\n            C += (DT / 6.0) * (s1 + 2 * s2 + 2 * s3 + s4)\n            t += DT\n\n        # Linear interpolation to estimate t_1/2\n        t_half_numerical = t_prev + DT * (C0 / 2.0 - C_prev) / (C - C_prev)\n        \n        # Calculate the absolute difference and store it\n        diff = abs(t_half_numerical - t_half_analytical)\n        results.append(diff)\n\n    # Format the final output string as required\n    output_str = \"[\" + \",\".join(map(str, results)) + \"]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}