{
    "hands_on_practices": [
        {
            "introduction": "The first step in mastering any physical model is learning to apply it to a concrete problem. This exercise serves as a fundamental application of the van der Waals equation, moving beyond the ideal gas approximation to describe a more realistic scenario. By calculating the temperature required for a given amount of argon gas to reach a high pressure in a fixed-volume container, you will directly engage with the roles of the van der Waals parameters, $a$ and $b$, and develop a quantitative feel for how intermolecular attractions and finite molecular size affect a gas's properties. ",
            "id": "2026294",
            "problem": "A materials scientist is preparing to synthesize a new compound under high-pressure conditions. The synthesis is conducted in a sealed, rigid steel reactor with a fixed internal volume of $1.00 \\text{ L}$. To ensure an inert atmosphere, the reactor is first evacuated and then filled with $2.50 \\text{ moles}$ of argon gas. The experimental protocol requires the argon gas to reach a pressure of exactly $100.0 \\text{ atm}$ before the reactants are introduced. Assuming argon behaves as a van der Waals gas, determine the temperature to which the reactor must be heated to achieve this target pressure.\n\nUse the following constants for your calculation:\n- van der Waals constant 'a' for Argon: $a = 1.345 \\frac{\\text{L}^2 \\cdot \\text{atm}}{\\text{mol}^2}$\n- van der Waals constant 'b' for Argon: $b = 0.03219 \\frac{\\text{L}}{\\text{mol}}$\n- Universal gas constant: $R = 0.08206 \\frac{\\text{L} \\cdot \\text{atm}}{\\text{mol} \\cdot \\text{K}}$\n\nExpress your final answer for the temperature in Kelvin, rounded to three significant figures.",
            "solution": "We are given a rigid reactor of fixed volume, containing argon modeled as a van der Waals gas. The van der Waals equation of state for a fixed amount of gas is\n$$\n\\left[P + a\\left(\\frac{n}{V}\\right)^{2}\\right]\\left(V - nb\\right) = nRT.\n$$\nWe are asked to find the temperature $T$ required to reach a specified pressure $P$, so we solve algebraically for $T$:\n$$\nT = \\frac{\\left[P + a\\left(\\frac{n}{V}\\right)^{2}\\right]\\left(V - nb\\right)}{nR}.\n$$\nInsert the given quantities $P = 100.0\\,\\text{atm}$, $V = 1.00\\,\\text{L}$, $n = 2.50\\,\\text{mol}$, $a = 1.345\\,\\text{L}^{2}\\,\\text{atm}\\,\\text{mol}^{-2}$, $b = 0.03219\\,\\text{L}\\,\\text{mol}^{-1}$, and $R = 0.08206\\,\\text{L}\\,\\text{atm}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$.\n\nFirst compute the correction terms:\n$$\n\\frac{n}{V} = \\frac{2.50}{1.00} = 2.50,\\quad \\left(\\frac{n}{V}\\right)^{2} = 6.25,\n$$\n$$\na\\left(\\frac{n}{V}\\right)^{2} = 1.345 \\times 6.25 = 8.40625\\ \\text{atm},\n$$\n$$\nP + a\\left(\\frac{n}{V}\\right)^{2} = 100.0 + 8.40625 = 108.40625\\ \\text{atm}.\n$$\nNext, compute the covolume correction:\n$$\nnb = 2.50 \\times 0.03219 = 0.080475\\ \\text{L},\\quad V - nb = 1.00 - 0.080475 = 0.919525\\ \\text{L}.\n$$\nForm the numerator and denominator of the temperature expression:\n$$\n\\left[P + a\\left(\\frac{n}{V}\\right)^{2}\\right]\\left(V - nb\\right) = 108.40625 \\times 0.919525 = 99.68225703125\\ \\text{L}\\cdot\\text{atm},\n$$\n$$\nnR = 2.50 \\times 0.08206 = 0.20515\\ \\text{L}\\cdot\\text{atm}\\,\\text{K}^{-1}.\n$$\nTherefore,\n$$\nT = \\frac{99.68225703125}{0.20515}\\ \\text{K} \\approx 485.899\\ \\text{K}.\n$$\nRounded to three significant figures, the required temperature is $486\\ \\text{K}$.",
            "answer": "$$\\boxed{486}$$"
        },
        {
            "introduction": "Powerful physical models often yield predictions that reveal universal principles, transcending the specific substances they describe. This practice guides you to derive one such profound result from the van der Waals equation: the value of the critical compressibility factor, $Z_c$. By applying calculus to identify the unique mathematical properties of the critical point—the state where liquid and gas phases become indistinguishable—you will uncover a universal constant predicted by the model, offering a glimpse into the law of corresponding states. ",
            "id": "2026264",
            "problem": "The van der Waals equation of state is a modification of the ideal gas law that accounts for the non-zero volume of gas molecules and the attractive forces between them. It is given by the expression:\n$$ \\left(P + \\frac{a}{V_m^2}\\right)(V_m - b) = RT $$\nHere, $P$ is the pressure, $V_m$ is the molar volume, $T$ is the absolute temperature, and $R$ is the universal gas constant. The parameters $a$ and $b$ are substance-specific constants, with $a$ correcting for intermolecular attractive forces and $b$ correcting for finite molecular volume.\n\nFor any substance, there exists a unique \"critical point\" defined by a critical temperature ($T_c$), critical pressure ($P_c$), and critical molar volume ($V_{m,c}$). At temperatures and pressures above the critical point, the distinction between the liquid and gas phases disappears, and the substance exists in a state known as a supercritical fluid. Mathematically, the critical point corresponds to the point of inflection on a P-V isotherm.\n\nA key prediction of any equation of state is the value of the compressibility factor, $Z = \\frac{PV_m}{RT}$, at the critical point. For the van der Waals model, this value, $Z_c = \\frac{P_c V_{m,c}}{R T_c}$, is predicted to be a universal constant, independent of the specific substance (i.e., independent of $a$ and $b$).\n\nCalculate this universal value for the critical compressibility factor, $Z_c$, as predicted by the van der Waals equation. Express your answer as an exact fraction.",
            "solution": "Start from the van der Waals equation written to give pressure as a function of $V_{m}$ and $T$:\n$$\nP=\\frac{R T}{V_{m}-b}-\\frac{a}{V_{m}^{2}}.\n$$\nAt the critical point, the $P$–$V_{m}$ isotherm has an inflection point, so\n$$\n\\left(\\frac{\\partial P}{\\partial V_{m}}\\right)_{T}=0,\\qquad \\left(\\frac{\\partial^{2} P}{\\partial V_{m}^{2}}\\right)_{T}=0\n$$\nevaluated at $V_{m}=V_{m,c}$ and $T=T_{c}$. Compute the derivatives:\n$$\n\\left(\\frac{\\partial P}{\\partial V_{m}}\\right)_{T}=-\\frac{R T}{\\left(V_{m}-b\\right)^{2}}+\\frac{2 a}{V_{m}^{3}},\n$$\n$$\n\\left(\\frac{\\partial^{2} P}{\\partial V_{m}^{2}}\\right)_{T}=\\frac{2 R T}{\\left(V_{m}-b\\right)^{3}}-\\frac{6 a}{V_{m}^{4}}.\n$$\nSetting these to zero at the critical point gives\n$$\n\\frac{R T_{c}}{\\left(V_{m,c}-b\\right)^{2}}=\\frac{2 a}{V_{m,c}^{3}},\\qquad \\frac{R T_{c}}{\\left(V_{m,c}-b\\right)^{3}}=\\frac{3 a}{V_{m,c}^{4}}.\n$$\nDivide the second equation by the first to eliminate $R T_{c}$:\n$$\n\\frac{1}{V_{m,c}-b}\\cdot \\frac{1}{1}=\\frac{3}{2}\\cdot \\frac{1}{V_{m,c}},\n$$\nwhich simplifies to\n$$\n2 V_{m,c}=3\\left(V_{m,c}-b\\right)\\quad \\Rightarrow \\quad V_{m,c}=3 b.\n$$\nSubstitute $V_{m,c}=3 b$ back into the first derivative condition to obtain $T_{c}$. From\n$$\n\\frac{R T_{c}}{(3 b-b)^{2}}=\\frac{2 a}{(3 b)^{3}},\n$$\nwe get\n$$\n\\frac{R T_{c}}{4 b^{2}}=\\frac{2 a}{27 b^{3}}\\quad \\Rightarrow \\quad R T_{c}=\\frac{8 a}{27 b}\\quad \\Rightarrow \\quad T_{c}=\\frac{8 a}{27 b R}.\n$$\nEvaluate $P_{c}$ from the equation of state at $V_{m,c}=3 b$ and $T_{c}$:\n$$\nP_{c}=\\frac{R T_{c}}{3 b-b}-\\frac{a}{(3 b)^{2}}=\\frac{R T_{c}}{2 b}-\\frac{a}{9 b^{2}}.\n$$\nUsing $R T_{c}=\\frac{8 a}{27 b}$ gives\n$$\nP_{c}=\\frac{1}{2 b}\\cdot \\frac{8 a}{27 b}-\\frac{a}{9 b^{2}}=\\frac{4 a}{27 b^{2}}-\\frac{3 a}{27 b^{2}}=\\frac{a}{27 b^{2}}.\n$$\nThe critical compressibility factor is\n$$\nZ_{c}=\\frac{P_{c} V_{m,c}}{R T_{c}}=\\frac{\\left(\\frac{a}{27 b^{2}}\\right)\\left(3 b\\right)}{\\frac{8 a}{27 b}}=\\frac{\\frac{a}{9 b}}{\\frac{8 a}{27 b}}=\\frac{27}{72}=\\frac{3}{8}.\n$$\nThus, $Z_{c}$ is a universal constant for the van der Waals model, independent of $a$ and $b$, and equals $\\frac{3}{8}$.",
            "answer": "$$\\boxed{\\frac{3}{8}}$$"
        },
        {
            "introduction": "A complete mastery of a physical model comes from the ability to implement it computationally to make predictions and solve complex problems. This advanced practice bridges theory and computation by challenging you to build a robust numerical solver for the van der Waals equation, starting from the fundamental Helmholtz free energy. You will learn to navigate the complexities of the model, such as the existence of multiple mathematical roots, and apply a physical stability criterion to identify the true, observable state of the system, a critical skill in modern computational chemistry and physics. ",
            "id": "2961955",
            "problem": "You are asked to implement a robust numerical solver that, for a given temperature $T$ and pressure $P$, computes the molar volume $v$ of a fluid obeying the van der Waals model while avoiding spurious roots associated with mechanically unstable states. The solver must be based on bracketing and bisection to ensure determinism and robustness.\n\nStart from the following fundamental base. Consider the Helmholtz free energy (HFE) of $N$ molecules of a van der Waals fluid,\n$$\nA(T,V,N) = N k_{\\mathrm{B}} T\\left[\\ln\\left(\\frac{n\\,\\Lambda^3}{1 - n b}\\right) - 1\\right] - a\\,\\frac{N^2}{V}\n$$\nwhere $k_{\\mathrm{B}}$ is the Boltzmann constant, $n = N/V$ is the number density, $\\Lambda$ is the thermal de Broglie wavelength (which will cancel from any measurable equation of state), and $a$ and $b$ are characteristic parameters of the fluid. Using the definition of pressure as the negative derivative of the Helmholtz free energy at constant temperature and particle number,\n$$\nP(T,V,N) = -\\left(\\frac{\\partial A}{\\partial V}\\right)_{T,N},\n$$\nderive the pressure as a function of temperature and molar volume $v = V/N$. Then, express the mechanical stability criterion in terms of the sign of the isothermal slope,\n$$\n\\left(\\frac{\\partial P}{\\partial v}\\right)_T,\n$$\nand explain how it rules out the unphysical root on the unstable branch. Finally, derive the conditions for the critical point as the simultaneous solution of\n$$\n\\left(\\frac{\\partial P}{\\partial v}\\right)_{T} = 0,\n\\qquad\n\\left(\\frac{\\partial^2 P}{\\partial v^2}\\right)_{T} = 0,\n$$\nand express the critical molar volume $v_{\\mathrm{c}}$, critical temperature $T_{\\mathrm{c}}$, and critical pressure $P_{\\mathrm{c}}$ in terms of $a$, $b$, and the universal gas constant $R$.\n\nAlgorithmic requirements:\n- Define the residual function $f(v;T,P) = P_{\\mathrm{model}}(T,v) - P$, where $P_{\\mathrm{model}}(T,v)$ is the pressure derived above. The physically allowed domain is $v > b$.\n- Implement a bracketing-plus-bisection solver that:\n  - Scans a geometrically spaced grid over $v \\in (b, v_{\\max}]$ with a sufficiently large $v_{\\max}$ determined adaptively from the ideal-gas estimate $v_{\\mathrm{ig}} = RT/P$.\n  - Identifies all sign changes of $f(v;T,P)$ to obtain disjoint brackets for roots.\n  - Applies bisection on each bracket to compute all real roots within the domain $v > b$ to a tight tolerance.\n  - Filters roots by the mechanical stability condition $(\\frac{\\partial P}{\\partial v})_T \\le 0$ to reject the unphysical unstable root (which has $(\\frac{\\partial P}{\\partial v})_T > 0$). Treat the critical case with $(\\frac{\\partial P}{\\partial v})_T = 0$ as acceptable.\n  - Returns the largest stable root to stay on the gas-like branch, which is continuous with the ideal-gas limit at low pressure.\n- If no stable root exists in the domain $v > b$ for the given inputs, return a Not-a-Number (NaN) value.\n\nPhysical and numerical units:\n- Use the International System of Units (SI) consistently.\n- The universal gas constant is $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$.\n- For carbon dioxide, use $a = 0.3592\\,\\mathrm{Pa\\,m^6\\,mol^{-2}}$ and $b = 4.267\\times 10^{-5}\\,\\mathrm{m^3\\,mol^{-1}}$.\n- All outputs must be the molar volume $v$ in $\\mathrm{m^3\\,mol^{-1}}$, rounded to eight significant digits.\n\nTest suite:\nImplement your program to evaluate the following four test cases for carbon dioxide, each specified by $(T,P)$ in SI units. Use the critical parameters defined by your own derived expressions:\n- Case A (single root above the critical temperature): $T = 1.2\\,T_{\\mathrm{c}}$, $P = 0.8\\,P_{\\mathrm{c}}$.\n- Case B (three-real-root regime below the critical temperature; return the gas-like root): $T = 0.9\\,T_{\\mathrm{c}}$, $P = 0.7\\,P_{\\mathrm{c}}$.\n- Case C (critical point; triple root): $T = T_{\\mathrm{c}}$, $P = P_{\\mathrm{c}}$.\n- Case D (near-ideal-gas regime at moderate pressure): $T = 350\\,\\mathrm{K}$, $P = 1.0\\times 10^{5}\\,\\mathrm{Pa}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the four results as a comma-separated list enclosed in square brackets, in the order A, B, C, D. For example, the printed line must look like\n[resA,resB,resC,resD]\nwith each entry being a floating-point number equal to the molar volume in $\\mathrm{m^3\\,mol^{-1}}$, rounded to eight significant digits.",
            "solution": "The posed problem is scientifically grounded, well-posed, and objective. It is based on the established principles of thermodynamics and the van der Waals model of real fluids. The objectives are clearly defined, all necessary parameters and constants are provided, and the required algorithmic approach is specified in sufficient detail to permit a unique and verifiable solution. The problem is therefore deemed valid and a full solution is provided below.\n\nThe solution proceeds in two stages. First, the requisite theoretical framework is derived from fundamental principles as specified in the problem statement. Second, a numerical algorithm conforming to the stated requirements is designed and implemented.\n\n**1. Theoretical Derivations**\n\n**1.1. Derivation of the van der Waals Equation of State**\n\nThe starting point is the Helmholtz Free Energy, $A$, for $N$ particles in a volume $V$ at temperature $T$:\n$$\nA(T,V,N) = N k_{\\mathrm{B}} T\\left[\\ln\\left(\\frac{n\\,\\Lambda^3}{1 - n b}\\right) - 1\\right] - a\\,\\frac{N^2}{V}\n$$\nHere, $n = N/V$ is the number density, $k_{\\mathrm{B}}$ is the Boltzmann constant, and $\\Lambda$ is the thermal de Broglie wavelength. The parameters $a$ and $b$ are characteristic of the fluid and represent intermolecular attraction and excluded volume, respectively. The provided units for $a$ ($Pa\\,m^6\\,mol^{-2}$) and $b$ ($m^3\\,mol^{-1}$) indicate that these are molar quantities. Thus, we must interpret $N$ as the number of moles and replace $k_{\\mathrm{B}}$ with the universal gas constant $R$. Substituting $n=N/V$, the expression for $A$ becomes:\n$$\nA(T,V,N) = N R T\\left[\\ln\\left(\\frac{N\\Lambda'^3}{V - N b}\\right) - 1\\right] - a\\,\\frac{N^2}{V}\n$$\nwhere $\\Lambda'$ is an effective thermal wavelength whose value does not affect the equation of state.\n\nPressure, $P$, is obtained from its thermodynamic definition as the negative partial derivative of $A$ with respect to $V$ at constant $T$ and $N$:\n$$\nP(T,V,N) = -\\left(\\frac{\\partial A}{\\partial V}\\right)_{T,N}\n$$\nWe compute the derivative term by term:\n$$\n\\left(\\frac{\\partial A}{\\partial V}\\right)_{T,N} = \\frac{\\partial}{\\partial V}\\left(N R T\\left[\\ln(N\\Lambda'^3) - \\ln(V - N b) - 1\\right] - a\\,\\frac{N^2}{V}\\right)\n$$\nThe terms $\\ln(N\\Lambda'^3)$ and $-1$ are constant with respect to $V$, so their derivatives are zero. The derivatives of the remaining terms are:\n$$\n\\frac{\\partial}{\\partial V} \\left( -N R T \\ln(V - N b) \\right) = -N R T \\frac{1}{V - N b}\n$$\n$$\n\\frac{\\partial}{\\partial V} \\left( -a\\,\\frac{N^2}{V} \\right) = -a N^2 \\left( -V^{-2} \\right) = a \\frac{N^2}{V^2}\n$$\nCombining these results:\n$$\n\\left(\\frac{\\partial A}{\\partial V}\\right)_{T,N} = -\\frac{N R T}{V - N b} + a \\frac{N^2}{V^2}\n$$\nApplying the definition of pressure, we find:\n$$\nP = -\\left(-\\frac{N R T}{V - N b} + a \\frac{N^2}{V^2}\\right) = \\frac{N R T}{V - N b} - a \\frac{N^2}{V^2}\n$$\nTo express this equation in terms of the molar volume, $v = V/N$, we divide the equation by $N$ and substitute $V = vN$:\n$$\nP = \\frac{R T}{V/N - b} - a \\frac{N^2}{(vN)^2}\n$$\nThis simplifies to the familiar intensive form of the van der Waals equation of state:\n$$\nP(T,v) = \\frac{R T}{v - b} - \\frac{a}{v^2}\n$$\nThis is the model pressure, $P_{\\mathrm{model}}(T,v)$, to be used in the solver. The physical domain for molar volume is $v > b$, as the volume cannot be less than the excluded volume of the molecules.\n\n**1.2. Mechanical Stability Criterion**\n\nFor a system to be in a mechanically stable equilibrium, its pressure must not increase with an increase in volume at constant temperature. An increase in pressure upon expansion would lead to a runaway process, which is unphysical. Therefore, the stability criterion is:\n$$\n\\left(\\frac{\\partial P}{\\partial V}\\right)_{T,N} \\le 0\n$$\nSince the molar volume $v=V/N$ is directly proportional to $V$ for a fixed number of moles $N$, this condition is equivalent to:\n$$\n\\left(\\frac{\\partial P}{\\partial v}\\right)_T \\le 0\n$$\nThe case of equality corresponds to marginal stability (spinodal decomposition points and the critical point). For the van der Waals model, this derivative is:\n$$\n\\left(\\frac{\\partial P}{\\partial v}\\right)_T = \\frac{\\partial}{\\partial v}\\left(\\frac{R T}{v - b} - \\frac{a}{v^2}\\right) = -\\frac{R T}{(v - b)^2} + \\frac{2a}{v^3}\n$$\nBelow the critical temperature, the van der Waals isotherm exhibits a region where $(\\partial P / \\partial v)_T > 0$. Any root of the equation of state, $v$, that falls within this region is physically spurious and must be rejected.\n\n**1.3. Derivation of Critical Point Parameters**\n\nThe critical point $(T_c, P_c, v_c)$ is a unique point on the phase diagram where the liquid and gas phases become indistinguishable. Mathematically, it is an inflection point on the critical isotherm where the slope is zero and the second derivative is also zero. This is expressed by the simultaneous conditions:\n$$\n\\left(\\frac{\\partial P}{\\partial v}\\right)_{T} = 0 \\quad \\text{and} \\quad \\left(\\frac{\\partial^2 P}{\\partial v^2}\\right)_{T} = 0\n$$\nFrom the first condition at the critical point $(T_c, v_c)$:\n$$\n-\\frac{R T_c}{(v_c - b)^2} + \\frac{2a}{v_c^3} = 0 \\implies R T_c = \\frac{2a(v_c-b)^2}{v_c^3} \\quad (1)\n$$\nThe second derivative is:\n$$\n\\left(\\frac{\\partial^2 P}{\\partial v^2}\\right)_{T} = \\frac{\\partial}{\\partial v}\\left(-\\frac{R T}{(v - b)^2} + \\frac{2a}{v^3}\\right) = \\frac{2 R T}{(v - b)^3} - \\frac{6a}{v^4}\n$$\nApplying the second condition at the critical point:\n$$\n\\frac{2 R T_c}{(v_c - b)^3} - \\frac{6a}{v_c^4} = 0 \\implies R T_c = \\frac{3a(v_c-b)^3}{v_c^4} \\quad (2)\n$$\nTo find $v_c$, we equate the two expressions for $R T_c$:\n$$\n\\frac{2a(v_c-b)^2}{v_c^3} = \\frac{3a(v_c-b)^3}{v_c^4}\n$$\nAssuming $a \\ne 0$ and $v_c \\ne b$, we can simplify by dividing by $a(v_c-b)^2$ and multiplying by $v_c^4$:\n$$\n2v_c = 3(v_c-b) \\implies 2v_c = 3v_c - 3b \\implies v_c = 3b\n$$\nTo find $T_c$, we substitute $v_c = 3b$ back into equation (1):\n$$\nR T_c = \\frac{2a(3b-b)^2}{(3b)^3} = \\frac{2a(2b)^2}{27b^3} = \\frac{2a(4b^2)}{27b^3} = \\frac{8a}{27b} \\implies T_c = \\frac{8a}{27Rb}\n$$\nFinally, to find $P_c$, we substitute $v_c$ and $T_c$ into the van der Waals equation itself:\n$$\nP_c = \\frac{R T_c}{v_c - b} - \\frac{a}{v_c^2} = \\frac{R(8a/27Rb)}{3b - b} - \\frac{a}{(3b)^2} = \\frac{8a/27b}{2b} - \\frac{a}{9b^2} = \\frac{8a}{54b^2} - \\frac{a}{9b^2} = \\frac{4a}{27b^2} - \\frac{3a}{27b^2}\n$$\n$$\nP_c = \\frac{a}{27b^2}\n$$\n\n**2. Algorithmic Design**\n\nThe numerical solver finds the molar volume $v$ for a given temperature $T$ and pressure $P$. It must return the largest stable root, corresponding to the gas-like phase.\n\n1.  **Residual Function**: The problem is a root-finding problem for the function $f(v;T,P)$:\n    $$\n    f(v; T, P) = P_{\\mathrm{model}}(T,v) - P = \\left(\\frac{R T}{v - b} - \\frac{a}{v^2}\\right) - P\n    $$\n    The roots of $f(v)=0$ in the domain $v > b$ are the possible molar volumes.\n\n2.  **Bracketing**: To find all real roots, we first bracket them.\n    *   A search range for $v$ is established from $(b, v_{\\max}]$. The lower bound is infinitesimally larger than $b$. The upper bound $v_{\\max}$ is chosen adaptively as a large multiple of the ideal gas molar volume, $v_{\\mathrm{ig}} = RT/P$. A value of $v_{\\max} = 50\\, v_{\\mathrm{ig}}$ is sufficient to ensure all physically relevant roots are included.\n    *   A finely-spaced geometric grid of points is created within this range, for example, using `numpy.geomspace`.\n    *   The residual function $f(v)$ is evaluated at each grid point.\n    *   A sign change in $f(v)$ between two consecutive grid points, $v_i$ and $v_{i+1}$, indicates the presence of a root in the interval $[v_i, v_{i+1}]$. All such intervals are identified as brackets. This method is robust and will also identify the triple root at the critical point, as the cubic function $v^3 P - (Pb+RT)v^2+av-ab=0$ (equivalent to $f(v)=0$) crosses the axis at a triple root.\n\n3.  **Bisection**: For each bracket $[v_{\\text{low}}, v_{\\text{high}}]$ found, the bisection method is applied to find the root with high precision. The interval is repeatedly halved, and the half containing the root (identified by the sign of $f(v)$ at the midpoint) is retained. This iterative process continues until the interval width is smaller than a specified tolerance ($\\approx 10^{-15} \\mathrm{m^3/mol}$).\n\n4.  **Root Filtering**: Each located root, $v_{\\text{root}}$, is validated against the mechanical stability criterion.\n    *   The derivative $(\\partial P / \\partial v)_T$ is computed at $v = v_{\\text{root}}$.\n    *   If $(\\partial P / \\partial v)_T \\le 0$ (within a small numerical tolerance), the root is considered physically stable and is retained.\n    *   If $(\\partial P / \\partial v)_T > 0$, the root corresponds to an unstable state and is discarded.\n\n5.  **Final Selection**: After filtering, if the set of stable roots is empty, the function returns a Not-a-Number (NaN) value. Otherwise, it returns the largest value from the set of stable roots. This choice ensures that for conditions where both liquid-like and gas-like states are possible stable solutions, the solver returns the gas-like root, which is continuous with the ideal gas limit at low pressures.\n\n**3. Application to Carbon Dioxide Test Cases**\n\nUsing the given constants for carbon dioxide:\n$a = 0.3592\\,\\mathrm{Pa\\,m^6\\,mol^{-2}}$\n$b = 4.267\\times 10^{-5}\\,\\mathrm{m^3\\,mol^{-1}}$\n$R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n\nThe critical point parameters are calculated as:\n$v_c = 3b = 1.2801 \\times 10^{-4}\\,\\mathrm{m^3\\,mol^{-1}}$\n$T_c = \\frac{8a}{27Rb} = 299.91\\,\\mathrm{K}$\n$P_c = \\frac{a}{27b^2} = 7.3082 \\times 10^{6}\\,\\mathrm{Pa}$\n\nThe solver is applied to the four test cases:\n*   **Case A**: $T = 1.2\\,T_{\\mathrm{c}}, P = 0.8\\,P_{\\mathrm{c}}$. Supercritical temperature. A single, stable root is expected.\n*   **Case B**: $T = 0.9\\,T_{\\mathrm{c}}, P = 0.7\\,P_{\\mathrm{c}}$. Subcritical region. Three real roots are expected: one stable liquid-like, one unstable, and one stable gas-like. The solver will return the largest stable (gas-like) root.\n*   **Case C**: $T = T_{\\mathrm{c}}, P = P_{\\mathrm{c}}$. The critical point. A single triple root at $v_c$ is expected, which is marginally stable and will be returned.\n*   **Case D**: $T = 350\\,\\mathrm{K}, P = 1.0\\times 10^{5}\\,\\mathrm{Pa}$. Supercritical temperature and low pressure, near ideal gas conditions. A single, stable root near $v_{\\mathrm{ig}} = RT/P$ is expected.",
            "answer": "```python\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Solves for the molar volume of a van der Waals fluid for given test cases.\n    \"\"\"\n\n    # --- Constants and Fluid Properties ---\n    # Universal gas constant in SI units (J mol^-1 K^-1)\n    R_GAS = 8.314462618\n    # Van der Waals parameters for carbon dioxide in SI units\n    # a: Pa m^6 mol^-2\n    A_CO2 = 0.3592\n    # b: m^3 mol^-1\n    B_CO2 = 4.267e-5\n\n    # --- Helper function for rounding to significant figures ---\n    def round_to_sf(num, sf):\n        \"\"\"Rounds a number to a specified number of significant figures.\"\"\"\n        if num == 0 or not np.isfinite(num):\n            return num\n        # Calculate the rounding position\n        power = -math.floor(math.log10(abs(num))) + (sf - 1)\n        factor = 10**power\n        return round(num * factor) / factor\n\n    # --- Core Solver Implementation ---\n    def solve_vdw_case(T, P, a, b):\n        \"\"\"\n        Calculates the largest stable molar volume for a van der Waals fluid.\n        \n        Args:\n            T (float): Temperature in Kelvin.\n            P (float): Pressure in Pascals.\n            a (float): Van der Waals parameter 'a'.\n            b (float): Van der Waals parameter 'b'.\n\n        Returns:\n            float: The largest stable molar volume in m^3/mol, or NaN if no stable root exists.\n        \"\"\"\n\n        # --- Model-specific functions ---\n        def p_vdw(v):\n            \"\"\"Van der Waals pressure as a function of molar volume.\"\"\"\n            if v = b:\n                return np.inf\n            return (R_GAS * T) / (v - b) - a / v**2\n\n        def residual(v):\n            \"\"\"Residual function for root finding: P_vdw(v) - P = 0.\"\"\"\n            return p_vdw(v) - P\n\n        def dp_dv(v):\n            \"\"\"Derivative of pressure with respect to volume (for stability check).\"\"\"\n            if v = b:\n                return np.nan\n            return -(R_GAS * T) / (v - b)**2 + (2 * a) / v**3\n\n        # 1. Bracketing Stage\n        # Set up a wide, geometrically spaced grid to find root brackets.\n        v_ig = R_GAS * T / P  # Ideal gas volume as a scale reference\n        v_min_search = b * (1.0 + 1e-9) # Start search just above b\n        v_max_search = v_ig * 50.0      # Generous upper bound\n        \n        # In case pressure is very high, ensure v_max is >> v_min\n        if v_max_search  10 * v_min_search:\n            v_max_search = 10 * v_min_search\n\n        num_grid_points = 20000\n        v_grid = np.geomspace(v_min_search, v_max_search, num_grid_points)\n        f_grid = np.array([residual(v) for v in v_grid])\n\n        brackets = []\n        for i in range(num_grid_points - 1):\n            if np.sign(f_grid[i]) != np.sign(f_grid[i+1]):\n                brackets.append((v_grid[i], v_grid[i+1]))\n\n        # 2. Bisection Stage\n        roots = []\n        tolerance = 1e-15\n        max_iter = 100\n        for v_low, v_high in brackets:\n            f_low = residual(v_low)\n            for _ in range(max_iter):\n                v_mid = (v_low + v_high) / 2.0\n                if (v_high - v_low)  tolerance:\n                    break\n                f_mid = residual(v_mid)\n                if np.sign(f_mid) == np.sign(f_low):\n                    v_low = v_mid\n                    f_low = f_mid\n                else:\n                    v_high = v_mid\n            roots.append((v_low + v_high) / 2.0)\n\n        if not roots:\n             # Handle rare cases where grid misses a touch-point root (e.g., critical point)\n             min_abs_f_idx = np.argmin(np.abs(f_grid))\n             if np.abs(f_grid[min_abs_f_idx])  1e-9: # If minimum is very close to zero\n                 roots.append(v_grid[min_abs_f_idx])\n                 \n        # 3. Filtering Stage\n        stable_roots = []\n        # Use rounding to identify unique roots found through different brackets/methods\n        unique_roots = sorted(list(set(np.round(r, 12) for r in roots)))\n        for r in unique_roots:\n            stability_check = dp_dv(r)\n            # Stability criterion: dP/dv = 0 ( allowing for small float inaccuracies)\n            if stability_check = 1e-9:\n                stable_roots.append(r)\n\n        # 4. Selection Stage\n        if not stable_roots:\n            return np.nan\n        else:\n            # Per problem, return the largest stable root (gas-like branch)\n            return max(stable_roots)\n    \n    # --- Main Execution Logic ---\n    # Calculate critical properties for CO2\n    Tc = (8 * A_CO2) / (27 * R_GAS * B_CO2)\n    Pc = A_CO2 / (27 * B_CO2**2)\n    \n    # Define test cases from the problem statement\n    test_cases = [\n        # (T, P) pairs in SI units (K, Pa)\n        (1.2 * Tc, 0.8 * Pc),  # Case A: Supercritical\n        (0.9 * Tc, 0.7 * Pc),  # Case B: Subcritical, three roots\n        (Tc, Pc),              # Case C: Critical point\n        (350.0, 1.0e5),        # Case D: Near-ideal gas\n    ]\n\n    results = []\n    for T, P in test_cases:\n        v_molar = solve_vdw_case(T, P, A_CO2, B_CO2)\n        # Round the final result to 8 significant figures\n        v_rounded = round_to_sf(v_molar, 8)\n        results.append(v_rounded)\n\n    # Format the final output as specified\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}