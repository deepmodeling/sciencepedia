{
    "hands_on_practices": [
        {
            "introduction": "对渗透压的理解始于其热力学根源。本练习将指导您从平衡状态下化学势相等的首要原则出发，推导出著名的范特霍夫方程。通过完成这一推导，您将巩固对微观热力学势与宏观可观测性质之间联系的理解。",
            "id": "2783180",
            "problem": "一个由磷脂双分子层膜包围的巨大单层囊泡，内部充满纯水，并含有只允许水分子通过的水通道蛋白。该囊泡被浸没在外部溶液中，该溶液含有浓度为 $C = 0.300\\ \\text{mol L}^{-1}$ 的不渗透非电解质溶质，温度为 $T = 298\\ \\text{K}$。囊泡膜对溶质不渗透，并可假设溶液为理想稀溶液。一个外部活塞对溶液施加均匀的静水压力。在稳态时，当膜两侧水的化学势相等时，水的净通量为零。\n\n从半透膜两侧溶剂化学势相等出发，仅使用化学势的基本热力学关系和理想稀溶液行为，推导阻止水净流入囊泡所需的最小静水压力差（即渗透压）的表达式。然后计算该系统下此值的大小。使用普适气体常数 $R = 0.082\\ \\text{L atm mol}^{-1}\\ \\text{K}^{-1}$，并假设非电解质溶质的 van ’t Hoff 因子 $i = 1$。将最终的渗透压以大气压为单位表示，并将答案四舍五入到四位有效数字。",
            "solution": "首先对问题陈述进行验证。\n\n步骤 1：提取已知条件\n- 系统：一个充满纯水的巨大单层囊泡 (GUV)。\n- 膜：含有水通道蛋白的磷脂双分子层，仅对水可渗透，对特定溶质不渗透。\n- 外部环境：含有浓度为 $C = 0.300\\ \\text{mol L}^{-1}$ 的不渗透非电解质溶质的水溶液。\n- 温度：$T = 298\\ \\text{K}$。\n- 外部条件：对外部溶液施加均匀的静水压力。\n- 平衡条件：在稳态时，水的净通量为零，这发生在膜两侧水的化学势相等时。\n- 假设：理想稀溶液行为。van 't Hoff 因子 $i = 1$。\n- 常数：普适气体常数 $R = 0.082\\ \\text{L atm mol}^{-1}\\ \\text{K}^{-1}$。\n- 任务：1) 推导阻止水净流入所需的最小静水压力差（渗透压）的表达式。2) 计算其值，单位为大气压，并四舍五入到四位有效数字。\n\n步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，提法明确且客观。它描述了一个基于基本热力学原理的经典物理化学渗透现象。语言精确，并为获得唯一解提供了所有必要的数据和条件。问题是自洽的，没有矛盾、模糊或科学不准确之处。所给数值对于一个生物系统是物理上现实的。\n\n步骤 3：结论与行动\n问题有效。将提供一个完整的、有理有据的解答。\n\n在半透膜两侧没有水净通量的平衡基本条件是，水在两侧的化学势相等。设囊泡内部用 'in' 表示，外部溶液用 'out' 表示。因此，平衡条件为：\n$$\n\\mu_{w}^{\\text{in}} = \\mu_{w}^{\\text{out}}\n$$\n囊泡内部含有纯水。其化学势 $\\mu_{w}^{\\text{in}}$ 是纯水 $\\mu_{w}^*$ 在囊泡内部压力 $P_{\\text{in}}$ 下的化学势。\n$$\n\\mu_{w}^{\\text{in}} = \\mu_{w}^*(T, P_{\\text{in}})\n$$\n外部溶液是一个溶液。在理想稀溶液中，溶剂（水）在压力 $P_{\\text{out}}$ 下的化学势 $\\mu_{w}^{\\text{out}}$ 由下式给出：\n$$\n\\mu_{w}^{\\text{out}} = \\mu_{w}^*(T, P_{\\text{out}}) + RT \\ln(x_{w}^{\\text{out}})\n$$\n其中 $\\mu_{w}^*(T, P_{\\text{out}})$ 是纯水在外部压力 $P_{\\text{out}}$ 下的化学势，$R$ 是普适气体常数，$T$ 是绝对温度，$x_{w}^{\\text{out}}$ 是外部溶液中水的摩尔分数。\n\n令平衡时的化学势相等，可得：\n$$\n\\mu_{w}^*(T, P_{\\text{in}}) = \\mu_{w}^*(T, P_{\\text{out}}) + RT \\ln(x_{w}^{\\text{out}})\n$$\n该方程可重新排列为：\n$$\n\\mu_{w}^*(T, P_{\\text{in}}) - \\mu_{w}^*(T, P_{\\text{out}}) = RT \\ln(x_{w}^{\\text{out}})\n$$\n在恒定温度下，纯物质的化学势对压力的依赖关系由基本热力学关系 $d\\mu^* = \\bar{V}dP$ 给出，其中 $\\bar{V}$ 是该物质的摩尔体积。对于水，我们将其表示为 $\\bar{V}_{w}$。将此关系从 $P_{\\text{out}}$ 积分到 $P_{\\text{in}}$，并假设水的摩尔体积 $\\bar{V}_{w}$ 不随压力变化（对液体而言这是一个极好的近似），我们得到：\n$$\n\\int_{P_{\\text{out}}}^{P_{\\text{in}}} \\bar{V}_{w} dP = \\mu_{w}^*(T, P_{\\text{in}}) - \\mu_{w}^*(T, P_{\\text{out}}) = \\bar{V}_{w}(P_{\\text{in}} - P_{\\text{out}})\n$$\n将此结果代回平衡方程，我们得到：\n$$\n\\bar{V}_{w}(P_{\\text{in}} - P_{\\text{out}}) = RT \\ln(x_{w}^{\\text{out}})\n$$\n渗透压 $\\Pi$ 定义为必须施加在溶液上以阻止溶剂从纯溶剂一侧净流入溶液的额外静水压力。在本问题中，对外部溶液施加外部压力以阻止水流入囊泡。因此，渗透压 $\\Pi$ 就是所需的压力差，即 $\\Pi = P_{\\text{out}} - P_{\\text{in}}$。代入此定义可得：\n$$\n-\\bar{V}_{w}\\Pi = RT \\ln(x_{w}^{\\text{out}})\n$$\n外部溶液含有一种摩尔分数为 $x_{s}^{\\text{out}}$ 的非电解质溶质。水的摩尔分数为 $x_{w}^{\\text{out}} = 1 - x_{s}^{\\text{out}}$。对于稀溶液，$x_{s}^{\\text{out}} \\ll 1$，我们可以使用泰勒级数近似 $\\ln(1 - x) \\approx -x$（对于小的 $x$）。\n$$\n\\ln(x_{w}^{\\text{out}}) = \\ln(1 - x_{s}^{\\text{out}}) \\approx -x_{s}^{\\text{out}}\n$$\n代入此近似值可得：\n$$\n-\\bar{V}_{w}\\Pi \\approx RT(-x_{s}^{\\text{out}}) \\implies \\Pi \\approx \\frac{RT}{\\bar{V}_{w}} x_{s}^{\\text{out}}\n$$\n现在，我们将溶质的摩尔分数 $x_{s}^{\\text{out}}$ 与其摩尔浓度 $C$ 联系起来。摩尔分数为 $x_{s}^{\\text{out}} = \\frac{n_s}{n_s + n_w}$，其中 $n_s$ 和 $n_w$ 分别是溶质和水的摩尔数。对于稀溶液，$n_s \\ll n_w$，所以 $x_{s}^{\\text{out}} \\approx \\frac{n_s}{n_w}$。\n摩尔浓度 $C$ 定义为 $C = \\frac{n_s}{V_{\\text{solution}}}$。在稀水溶液中，溶液的体积 $V_{\\text{solution}}$ 约等于溶剂的体积，$V_{\\text{solution}} \\approx V_w = n_w \\bar{V}_{w}$。\n因此，$C \\approx \\frac{n_s}{n_w \\bar{V}_{w}}$。由此，我们可以将近似的摩尔分数表示为 $x_{s}^{\\text{out}} \\approx \\frac{n_s}{n_w} \\approx C \\bar{V}_{w}$。\n将 $x_{s}^{\\text{out}}$ 的这个表达式代入我们的 $\\Pi$ 方程：\n$$\n\\Pi \\approx \\frac{RT}{\\bar{V}_{w}} (C \\bar{V}_{w}) = CRT\n$$\n对于可能解离的溶质，此表达式使用 van 't Hoff 因子 $i$ 进行概括，$i$ 是溶质解离成的粒子数。对于非电解质，$i=1$。这个通用表达式，被称为 van 't Hoff 方程，是：\n$$\n\\Pi = iCRT\n$$\n这就是推导出的渗透压表达式。\n\n现在，我们计算给定系统的数值。\n给定的参数是：\n- van 't Hoff 因子, $i = 1$\n- 溶质浓度, $C = 0.300\\ \\text{mol L}^{-1}$\n- 普适气体常数, $R = 0.082\\ \\text{L atm mol}^{-1}\\ \\text{K}^{-1}$\n- 温度, $T = 298\\ \\text{K}$\n\n将这些值代入推导出的公式：\n$$\n\\Pi = (1) \\times (0.300\\ \\text{mol L}^{-1}) \\times (0.082\\ \\text{L atm mol}^{-1}\\ \\text{K}^{-1}) \\times (298\\ \\text{K})\n$$\n单位适当抵消，结果以大气压 (atm) 为单位：\n$$\n\\Pi = (0.300 \\times 0.082 \\times 298)\\ \\text{atm}\n$$\n$$\n\\Pi = (0.0246 \\times 298)\\ \\text{atm}\n$$\n$$\n\\Pi = 7.3308\\ \\text{atm}\n$$\n题目要求最终答案四舍五入到四位有效数字。\n$$\n\\Pi \\approx 7.331\\ \\text{atm}\n$$\n这就是阻止水净流入囊泡所需的最小静水压力差。",
            "answer": "$$\n\\boxed{7.331}\n$$"
        },
        {
            "introduction": "在掌握了基础理论之后，我们将转向更复杂且更贴近现实的体系，例如在生物学和材料科学中常见的聚电解质溶液。本练习将探讨决定离子跨膜分布的唐南平衡 (Donnan equilibrium)，并引入一个重要的非理想效应——反离子凝聚 (counterion condensation)。通过引入有效电荷分数 $f_{\\mathrm{eff}}$，您将学习如何修正理想模型，以更精确地描述真实世界的现象。",
            "id": "2949408",
            "problem": "一张半透膜隔开了两个大的储液池。隔室I含有一种柔性阴离子聚电解质的水溶液，其具有均匀的固定电荷浓度 $C_f$（单位为 $\\mathrm{mol\\ L^{-1}}$）。隔室II仅含有本体浓度为 $C_s$ 的对称单价盐。该膜对溶剂和小离子是可渗透的，但对聚电解质不可渗透。假设理想稀溶液行为（活度系数等于$1$）、单价离子的化合价为 $z=\\pm 1$，以及在平衡状态下可渗透离子的电化学势相等。温度为 $T$，普适气体常数为 $R$。\n\n据观察，由于抗衡离子凝聚或离子对，一部分聚电解质的抗衡离子与聚合物紧密结合，使得聚合物名义电荷中只有一部分（分数 $f_{\\mathrm{eff}}$）在本体中保持渗透和静电活性。假设 $0<f_{\\mathrm{eff}}\\le 1$，并且凝聚部分 $(1-f_{\\mathrm{eff}})$ 既不贡献渗透压，也不作为独立的可移动物种参与Donnan分配。\n\n仅使用以下基本要素作为您的出发点：\n- 每个隔室中的电中性守恒，\n- 平衡时每种可渗透离子的电化学势相等，\n- 溶剂化学势和渗透压的理想溶液形式，\n\n判断以下哪个表达式在热力学上与渗透压差 $\\Delta \\Pi$（隔室I相对于隔室II）一致，该表达式通过有效电荷分数包含了抗衡离子凝聚的影响。每个选项都使用 $C_s$ 表示远离膜的隔室II中的盐浓度。\n\nA. $\\Delta \\Pi \\;=\\; R T \\left(\\sqrt{(f_{\\mathrm{eff}} C_f)^2 + 4 C_s^2}\\;-\\;2 C_s\\right)$\n\nB. $\\Delta \\Pi \\;=\\; f_{\\mathrm{eff}}\\, R T \\left(\\sqrt{C_f^2 + 4 C_s^2}\\;-\\;2 C_s\\right)$\n\nC. $\\Delta \\Pi \\;=\\; R T \\left(\\sqrt{C_f^2 + 4 (f_{\\mathrm{eff}} C_s)^2}\\;-\\;2 f_{\\mathrm{eff}} C_s\\right)$\n\nD. $\\Delta \\Pi \\;=\\; f_{\\mathrm{eff}}\\, R T \\left(\\sqrt{(f_{\\mathrm{eff}} C_f)^2 + 4 C_s^2}\\;-\\;2 C_s\\right)",
            "solution": "问题陈述是科学合理的、定义明确的且客观的。它描述了聚电解质溶液的一个典型Donnan平衡情景，并通过有效电荷分数 $f_{\\mathrm{eff}}$ 引入了抗衡离子凝聚这一公认的概念。所提供的基本原理和假设是充分且一致的，足以推导出渗透压差的唯一且有意义的解。该问题是有效的，将从指定的第一性原理出发推导解答。\n\n我们分别用 $C_{+,I}$ 和 $C_{-,I}$ 表示隔室I中可移动阳离子（化合价 $z=+1$）和阴离子（化合价 $z=-1$）的浓度。在隔室II，即外部盐储液池中，对称单价盐的浓度为 $C_s$，这意味着阳离子和阴离子的浓度分别为 $C_{+,II} = C_s$ 和 $C_{-,II} = C_s$。半透膜对阴离子聚电解质是不可渗透的。\n\n隔室I中阴离子聚电解质的有效固定电荷浓度为 $f_{\\mathrm{eff}} C_f$。$C_f$ 是名义固定电荷浓度，$f_{\\mathrm{eff}}$ 是具有静电活性的电荷分数，其中 $0<f_{\\mathrm{eff}}\\le 1$。\n\n我们通过应用问题中规定的三个基本要素来继续。\n\n**1. 电中性守恒**\n每个隔室必须是电中性的。\n*   在仅含有对称盐的隔室II中：\n    $$C_{+,II} = C_{-,II} = C_s$$\n*   在隔室I中，正电荷的总和必须等于负电荷的总和。正电荷来自可移动的阳离子 $C_{+,I}$。负电荷来自可移动的阴离子 $C_{-,I}$ 和阴离子聚电解质的有效固定电荷 $f_{\\mathrm{eff}} C_f$。\n    $$C_{+,I} = C_{-,I} + f_{\\mathrm{eff}} C_f$$\n    这可以重新排列为：\n    $$C_{+,I} - C_{-,I} = f_{\\mathrm{eff}} C_f \\quad (*)$$\n\n**2. 电化学势相等**\n在平衡状态下，每种可渗透离子物种 $i$ 的电化学势 $\\tilde{\\mu}_i$ 在两个隔室中必须相同。其一般形式为 $\\tilde{\\mu}_i = \\mu_i^0 + RT \\ln C_i + z_i F \\phi$，根据理想溶液的假设，我们使用浓度 $C_i$ 代替活度。$F$ 是法拉第常数，$\\phi$ 是电势。\n\n*   对于阳离子（$z=+1$）：\n    $$\\mu_{+}^0 + RT \\ln C_{+,I} + F \\phi_I = \\mu_{+}^0 + RT \\ln C_{+,II} + F \\phi_{II}$$\n    $$RT \\ln\\left(\\frac{C_{+,I}}{C_{+,II}}\\right) = F(\\phi_{II} - \\phi_I)$$\n*   对于阴离子（$z=-1$）：\n    $$\\mu_{-}^0 + RT \\ln C_{-,I} - F \\phi_I = \\mu_{-}^0 + RT \\ln C_{-,II} - F \\phi_{II}$$\n    $$RT \\ln\\left(\\frac{C_{-,I}}{C_{-,II}}\\right) = F(\\phi_{I} - \\phi_{II})$$\n\n结合这两个结果可得：\n$$\\ln\\left(\\frac{C_{+,I}}{C_{+,II}}\\right) = - \\ln\\left(\\frac{C_{-,I}}{C_{-,II}}\\right) = \\ln\\left(\\frac{C_{-,II}}{C_{-,I}}\\right)$$\n$$\\frac{C_{+,I}}{C_{+,II}} = \\frac{C_{-,II}}{C_{-,I}}$$\n这导出了Donnan关系：\n$$C_{+,I} C_{-,I} = C_{+,II} C_{-,II}$$\n代入 $C_{+,II} = C_s$ 和 $C_{-,II} = C_s$：\n$$C_{+,I} C_{-,I} = C_s^2 \\quad (**)$$\n\n我们现在得到了一个关于两个未知浓度 $C_{+,I}$ 和 $C_{-,I}$ 的方程组，由方程 $(*)$ 和 $(**)$ 组成。我们可以解这个方程组。由 $(*)$ 可得 $C_{-,I} = C_{+,I} - f_{\\mathrm{eff}} C_f$。将其代入 $(**)$：\n$$C_{+,I}(C_{+,I} - f_{\\mathrm{eff}} C_f) = C_s^2$$\n$$C_{+,I}^2 - (f_{\\mathrm{eff}} C_f)C_{+,I} - C_s^2 = 0$$\n这是一个关于 $C_{+,I}$ 的二次方程。使用二次公式，并为浓度选择有物理意义的正根：\n$$C_{+,I} = \\frac{f_{\\mathrm{eff}} C_f + \\sqrt{(-f_{\\mathrm{eff}} C_f)^2 - 4(1)(-C_s^2)}}{2} = \\frac{f_{\\mathrm{eff}} C_f + \\sqrt{(f_{\\mathrm{eff}} C_f)^2 + 4C_s^2}}{2}$$\n然后，我们从 $C_{-,I} = C_{+,I} - f_{\\mathrm{eff}} C_f$ 中求出 $C_{-,I}$：\n$$C_{-,I} = \\frac{f_{\\mathrm{eff}} C_f + \\sqrt{(f_{\\mathrm{eff}} C_f)^2 + 4C_s^2}}{2} - f_{\\mathrm{eff}} C_f = \\frac{-f_{\\mathrm{eff}} C_f + \\sqrt{(f_{\\mathrm{eff}} C_f)^2 + 4C_s^2}}{2}$$\n\n**3. 渗透压**\n根据理想溶液的范特霍夫定律，渗透压差 $\\Delta \\Pi = \\Pi_I - \\Pi_{II}$ 与膜两侧所有溶质物种的总摩尔浓度之差成正比。\n$$\\Delta \\Pi = RT \\left( \\sum_i C_{i,I} - \\sum_j C_{j,II} \\right)$$\n隔室I中的溶质物种是聚电解质大分子、阳离子和阴离子。隔室II中的溶质物种是盐的阳离子和阴离子。\n$$\\Delta \\Pi = RT \\left[ (C_{poly} + C_{+,I} + C_{-,I}) - (C_{+,II} + C_{-,II}) \\right]$$\n其中 $C_{poly}$ 是聚电解质大分子的摩尔浓度。问题陈述和提供的选项不包含 $C_{poly}$。这暗示着 $C_{poly}$ 要么被认为可以忽略不计（例如，对于非常高分子量的聚合物），要么问题所问的是所谓的Donnan渗透压，即完全由可移动离子的不对称分布引起的贡献。鉴于选项的结构，我们必须采用后一种解释。\n由可移动离子引起的渗透压差为：\n$$\\Delta \\Pi = RT \\left[ (C_{+,I} + C_{-,I}) - (C_s + C_s) \\right]$$\n我们来计算隔室I中可移动离子的浓度之和：\n$$C_{+,I} + C_{-,I} = \\left(\\frac{f_{\\mathrm{eff}} C_f + \\sqrt{(f_{\\mathrm{eff}} C_f)^2 + 4C_s^2}}{2}\\right) + \\left(\\frac{-f_{\\mathrm{eff}} C_f + \\sqrt{(f_{\\mathrm{eff}} C_f)^2 + 4C_s^2}}{2}\\right)$$\n$$C_{+,I} + C_{-,I} = \\frac{2\\sqrt{(f_{\\mathrm{eff}} C_f)^2 + 4C_s^2}}{2} = \\sqrt{(f_{\\mathrm{eff}} C_f)^2 + 4C_s^2}$$\n将此代入 $\\Delta \\Pi$ 的表达式中：\n$$\\Delta \\Pi = RT \\left( \\sqrt{(f_{\\mathrm{eff}} C_f)^2 + 4C_s^2} - 2C_s \\right)$$\n这个推导出的表达式代表了基于所提供原理以及由选项所暗示的对问题范围的必要解释而得出的热力学一致的结果。\n\n**选项评估**\n\n*   **A. $\\Delta \\Pi \\;=\\; R T \\left(\\sqrt{(f_{\\mathrm{eff}} C_f)^2 + 4 C_s^2}\\;-\\;2 C_s\\right)$**\n    该表达式与我们推导出的结果完全匹配。在标准的Donnan渗透压公式中，有效电荷浓度 $f_{\\mathrm{eff}} C_f$ 被正确地用来代替名义固定电荷。\n    **结论：正确。**\n\n*   **B. $\\Delta \\Pi \\;=\\; f_{\\mathrm{eff}}\\, R T \\left(\\sqrt{C_f^2 + 4 C_s^2}\\;-\\;2 C_s\\right)$**\n    该选项使用名义电荷浓度 $C_f$ 计算标准的Donnan渗透压，然后将整个结果乘以 $f_{\\mathrm{eff}}$。这是不正确的。有效电荷在平衡内部非线性地影响离子分布，其效应不能作为一个简单的前置因子被提取出来。\n    **结论：不正确。**\n\n*   **C. $\\Delta \\Pi \\;=\\; R T \\left(\\sqrt{C_f^2 + 4 (f_{\\mathrm{eff}} C_s)^2}\\;-\\;2 f_{\\mathrm{eff}} C_s\\right)$**\n    该表达式错误地将有效电荷分数 $f_{\\mathrm{eff}}$ 应用于外部盐浓度 $C_s$。参数 $f_{\\mathrm{eff}}$ 是隔室I中聚电解质的一个属性，没有物理依据来修改外部储液池中的盐浓度。\n    **结论：不正确。**\n\n*   **D. $\\Delta \\Pi \\;=\\; f_{\\mathrm{eff}}\\, R T \\left(\\sqrt{(f_{\\mathrm{eff}} C_f)^2 + 4 C_s^2}\\;-\\;2 C_s\\right)$**\n    该选项取了选项A中的正确表达式，并再次将其乘以 $f_{\\mathrm{eff}}$。这是多余的，且在物理上是不正确的。它重复应用了电荷减少效应。\n    **结论：不正确。**\n\n在所有选项中，唯一热力学一致的表达式是选项A。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "这项高级实践旨在搭建分析理论与现代计算研究之间的桥梁。在这里，您将设计一个策略，从统计力学的第一性原理出发，通过计算静态结构因子 $S(0)$ 和使用可压缩性状态方程来计算渗透压。该练习不仅加深了您的理论认识，还提供了处理复杂流体（在这些流体中简单的解析解已不再适用）的计算方法的实践经验。",
            "id": "2949395",
            "problem": "一个由溶剂中不可区分、不带电的大分子组成的体系，被限制在半透膜一侧的周期性立方体积内。该半透膜只允许溶剂通过，因此渗透压是由大分子引起的额外压力。当中心间距 $r \\ge \\sigma$ 时，这些大分子通过直径为 $\\sigma$ 的排除体积硬核和带屏蔽的排斥性汤川尾部相互作用，其对势 $u(r)$ 是有限程的，并近似呈指数衰减。您的任务是设计并实现一种计算策略，从对关联中估算相互作用大分子的零波矢静态结构因子 $S(0)$，然后通过对连接 $S(0)$ 与等温渗透压缩率的适当热力学关系进行积分，重构渗透压曲线 $\\Pi(\\rho)$ 随数密度 $\\rho$ 的变化。设计必须明确处理有限周期性盒子（有限尺寸效应）和长程相互作用截断（尾部修正）的影响，并且必须基于统计力学的第一性原理，而不是使用任何没有理论依据的简化公式。\n\n请从静态结构因子关于数密度涨落和径向分布函数 $g(r)$ 的基本定义，以及溶质的等温压缩率热力学定义出发。推导、论证并实现一个可通过 $g(r) - 1$ 的积分计算 $S(0)$ 的表达式，并推导排斥性对势下 $g(r)$ 的特定低密度近似，以及一个适用于屏蔽相互作用的、可解析积分的关联函数渐近尾部模型。利用这些要素，构建一个数值稳定的算法。给定一组密度 $\\{\\rho_i\\}_{i=0}^M$（其中 $\\rho_0 = 0$），该算法通过在离散密度集上使用一致的求积法则对渗透压缩率关系进行积分，以重构相对于纯溶剂的渗透压差 $\\Pi(\\rho_M)$。所有步骤必须与边长为 $L$、截断半径为 $r_c = L/2$ 的周期性立方盒子内部一致。\n\n物理模型和单位：\n- 长度以 $\\sigma$ 为单位度量，因此 $\\sigma = 1$ 定义了约化长度单位。\n- 温度被吸收到约化逆温度 $\\beta = 1/(k_\\mathrm{B} T)$ 中，您应以约化单位 $k_\\mathrm{B} T / \\sigma^3$ 报告渗透压。\n- 对势为硬核加汤川势，\n  对于 $0 \\le r < \\sigma$，$u(r) = +\\infty$；对于 $r \\ge \\sigma$，$u(r) = \\varepsilon \\, (\\sigma / r)\\, \\exp(-\\kappa (r - \\sigma))$，其中 $\\kappa$ 是逆屏蔽长度，$\\varepsilon$ 设定相互作用强度。\n- 使用低密度闭合 $g(r) \\approx \\exp(-\\beta u(r))$（对于 $r \\ge \\sigma$）和 $g(r) = 0$（对于 $0 \\le r < \\sigma$）来构造 $S(0)$ 积分中的 $h(r) = g(r) - 1$。\n- 对于超出截断半径 $r_c$ 的长程尾部，使用一个从 $u(r)$ 的屏蔽形式一致推导出的、可解析积分的 $h(r)$ 渐近模型。\n\n有限尺寸和长程相互作用修正：\n- 边长为 $L$ 的有限模拟盒子意味着最大有效对间距截断为 $r_c = L/2$。您的算法必须能产生一个“朴素”估计的 $S(0)$（通过在 $r_c$ 处截断关联积分而不进行任何尾部修正）和一个“修正后”的估计（加上基于 $h(r)$ 屏蔽渐近形式解析推导出的 $r \\ge r_c$ 的尾部积分）。\n- 对于每个密度 $\\rho > 0$，如果粒子数为 $N$，则盒子边长受限于 $L = (N/\\rho)^{1/3}$（以约化单位计）。对于 $\\rho = 0$，需与理想参考态一致地定义 $S(0)$。\n\n渗透压的重构：\n- 从您的第一性原理推导中，确定连接 $S(0)$ 与等温渗透压缩率的热力学关系，并使用梯形法则在离散集合 $\\{\\rho_i\\}$ 上进行数值积分，以获得 $\\Pi(\\rho_M)$，并且通过构造保证 $\\Pi(0) = 0$。\n- 确保对给定的密度，数值积分是稳定的。\n\n数值要求：\n- 所有关于 $r$ 的数值积分必须以最多 $10^{-6}$ 的相对容差进行评估。\n- 所有输出必须报告为精确到六位小数的浮点数。\n- 渗透压必须以约化单位 $k_\\mathrm{B} T / \\sigma^3$ 报告。\n\n测试套件：\n实现您的程序，为以下三个参数集计算并汇总结果。在所有情况下，取 $\\sigma = 1$。\n\n- 情况 A（理想情况，短程，弱排斥）：\n  - 参数：$\\kappa = 3.0$，$\\beta \\varepsilon = 1.0$，$N = 500$。\n  - 密度：$\\{\\rho\\} = \\{0.0, 0.05, 0.10, 0.15\\}$。\n  - 任务：使用从 $\\rho=0$ 开始的路径上的修正后 $S(0)$ 值，计算最高密度 $\\rho = 0.15$ 处的修正后渗透压 $\\beta \\Pi(\\rho)$。\n  - 输出项：单个值 $\\beta \\Pi(0.15)$。\n\n- 情况 B（长程，强排斥）：\n  - 参数：$\\kappa = 1.0$，$\\beta \\varepsilon = 2.5$，$N = 800$。\n  - 密度：$\\{\\rho\\} = \\{0.0, 0.02, 0.05, 0.10\\}$。\n  - 任务：计算 (i) $\\rho = 0.10$ 处的修正后 $S(0)$ 和 (ii) 使用相同的重构程序计算修正后渗透压 $\\beta \\Pi(0.10)$。\n  - 输出项：两个值，$S(0)$ 在 $\\rho = 0.10$ 处的值和 $\\beta \\Pi(0.10)$，按此顺序。\n\n- 情况 C（有限尺寸边缘情况，显式小盒子以暴露截断误差）：\n  - 参数：$\\kappa = 1.0$，$\\beta \\varepsilon = 2.5$，固定盒子边长 $L = 6.0$。\n  - 目标密度：$\\rho_\\mathrm{target} = 0.10$。使用 $N = \\mathrm{round}(\\rho_\\mathrm{target} L^3)$，然后设置实际密度为 $\\rho = N / L^3$。使用此单一密度 $\\rho$ 以两种方式计算 $S(0)$。\n  - 任务：计算 (i) 在该 $\\rho$ 下，使用在 $r_c = L/2$ 处截断且无尾部修正的朴素 $S(0)$，以及 (ii) 加上 $r_c$ 之外解析推导的屏蔽尾部的修正后 $S(0)$。\n  - 输出项：两个值，此情况下的朴素 $S(0)$，然后是修正后 $S(0)$。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，顺序如下：\n  - 情况 A: $\\beta \\Pi(0.15)$，\n  - 情况 B: $\\rho = 0.10$ 时的 $S(0)$，然后是 $\\beta \\Pi(0.10)$，\n  - 情况 C: 实际 $\\rho$ 时的朴素 $S(0)$，然后是相同 $\\rho$ 时的修正后 $S(0)$。\n- 示例格式：”[$x_1,x_2,x_3,x_4,x_5$]”，其中每个 $x_i$ 都四舍五入到恰好六位小数。\n\n角度单位不适用。所有具有物理量纲的量必须以指定的约化单位报告。最终的数值结果必须是浮点类型，并严格按照上述单行格式显示。",
            "solution": "该问题要求从统计力学的第一性原理出发，构建并实现一种计算方法，以确定大分子溶液的渗透压。该溶液被建模为一个通过硬核加汤川对势相互作用的粒子体系。该方法的核心是计算零波矢静态结构因子 $S(0)$，然后对渗透压缩率状态方程进行积分。此推导必须严格考虑有限体系尺寸效应和长程相互作用的截断。\n\n该解决方案的逻辑基础如下：\n1.  建立静态结构因子 $S(0)$ 与径向分布函数 $g(r)$ 之间的关系。\n2.  将 $S(0)$ 与等温渗透压缩率联系起来，从而得到渗透压 $\\Pi$ 作为数密度 $\\rho$ 函数的微分方程。\n3.  通过积分求解该微分方程，得到 $\\Pi(\\rho)$。\n4.  通过指定给定势的 $g(r)$ 的近似形式，并推导有限计算体积所需的修正，来开发一个具体的计算算法。\n\n**1. 静态结构因子与对关联**\n\n静态结构因子 $S(\\mathbf{k})$ 通过密度涨落的傅里叶变换来定义。对于体积为 $V$ 的均匀各向同性流体中的 $N$ 个粒子，它与总关联函数 $h(r) = g(r) - 1$ 相关，其中 $g(r)$ 是径向分布函数。该关系由傅里叶空间中的Ornstein-Zernike方程给出：\n$$S(k) = 1 + \\rho \\hat{h}(k)$$\n其中 $\\rho = N/V$ 是数密度，$\\hat{h}(k)$ 是 $h(r)$ 的三维傅里叶变换：\n$$\\hat{h}(k) = \\int_V h(r) e^{-i \\mathbf{k} \\cdot \\mathbf{r}} d\\mathbf{r} = \\frac{4\\pi}{k} \\int_0^\\infty h(r) r \\sin(kr) dr$$\n在零波矢极限下 ($k \\to 0$)，我们有 $\\sin(kr) \\approx kr$，这使得变换简化为 $\\hat{h}(0) = 4\\pi \\int_0^\\infty h(r) r^2 dr$。因此，在 $k=0$ 时的结构因子为：\n$$S(0) = 1 + 4\\pi\\rho \\int_0^\\infty [g(r) - 1] r^2 dr$$\n这是连接宏观涨落与微观对结构的基本表达式。\n\n**2. 渗透压缩率与压力**\n\n根据巨正则系综中的统计力学涨落理论，$S(0)$ 与等温渗透压缩率 $\\chi_T^{\\text{osmotic}}$ 直接成正比。对于溶剂中的溶质，这由以下公式给出：\n$$S(0) = \\rho k_B T \\chi_T^{\\text{osmotic}}$$\n其中 $k_B$ 是玻尔兹曼常数，$T$ 是绝对温度，渗透压缩率定义为：\n$$\\chi_T^{\\text{osmotic}} = \\frac{1}{\\rho} \\left(\\frac{\\partial \\rho}{\\partial \\Pi}\\right)_T$$\n这里，$\\Pi$ 是渗透压。结合这些关系得到：\n$$S(0) = k_B T \\left(\\frac{\\partial \\rho}{\\partial \\Pi}\\right)_T$$\n重新整理此式，得到渗透压的微分方程：\n$$\\left(\\frac{\\partial \\Pi}{\\partial \\rho}\\right)_T = \\frac{k_B T}{S(0)}$$\n我们需要以约化单位 $\\Pi_{red} = \\beta \\Pi \\sigma^3$ 报告压力，其中 $\\beta = 1/(k_B T)$，$\\sigma$ 是粒子直径。代入 $\\Pi = \\Pi_{red}/(\\beta \\sigma^3)$ 得：\n$$\\frac{1}{\\beta \\sigma^3} \\left(\\frac{\\partial \\Pi_{red}}{\\partial \\rho}\\right)_T = \\frac{1}{\\beta S(0)} \\implies \\left(\\frac{\\partial \\Pi_{red}}{\\partial \\rho}\\right)_T = \\frac{\\sigma^3}{S(0)}$$\n从零密度（纯溶剂）积分到最终密度 $\\rho_f$，并使用边界条件 $\\Pi(0)=0$，我们得到约化渗透压：\n$$\\Pi_{red}(\\rho_f) = \\int_0^{\\rho_f} \\frac{\\sigma^3}{S(0; \\rho')} d\\rho'$$\n由于所有长度都以 $\\sigma$ 为单位度量，我们设 $\\sigma=1$，得到最终的积分公式：\n$$\\Pi_{red}(\\rho_f) = \\int_0^{\\rho_f} \\frac{1}{S(0; \\rho')} d\\rho'$$\n\n**3. 物理模型与低密度近似**\n\n对势由硬核和带屏蔽的汤川尾部给出：\n$$ u(r) = \\begin{cases} +\\infty & 0 \\le r < \\sigma \\\\ \\varepsilon \\frac{\\sigma}{r} e^{-\\kappa(r-\\sigma)} & r \\ge \\sigma \\end{cases} $$\n问题指定使用径向分布函数的低密度近似：$g(r) \\approx \\exp(-\\beta u(r))$。这使我们可以将总关联函数 $h(r) = g(r)-1$ 定义为：\n$$ h(r) = \\begin{cases} -1 & 0 \\le r < \\sigma \\\\ \\exp\\left(-\\beta \\varepsilon \\frac{\\sigma}{r} e^{-\\kappa(r-\\sigma)}\\right) - 1 & r \\ge \\sigma \\end{cases} $$\n\n**4. 带修正的 S(0) 计算算法**\n\n$S(0)$ 的积分是在边长为 $L$、截断半径为 $r_c = L/2$ 的立方盒子中计算的。该积分分解为三个部分：一个硬核贡献，一个为 $\\sigma \\le r \\le r_c$ 数值计算的部分，以及一个为 $r > r_c$ 的解析尾部修正。设 $\\sigma=1$：\n$$4\\pi\\rho \\int_0^\\infty h(r) r^2 dr = 4\\pi\\rho \\left[ \\int_0^1 (-1) r^2 dr + \\int_1^{r_c} h(r) r^2 dr + \\int_{r_c}^\\infty h(r) r^2 dr \\right]$$\n1.  **硬核贡献 ($0 \\le r < 1$):** 此积分为解析的。\n    $$ I_{HC} = 4\\pi\\rho \\int_0^1 (-1) r^2 dr = -\\frac{4}{3}\\pi\\rho $$\n2.  **数值贡献 ($1 \\le r \\le r_c$):** 这部分需要数值积分。\n    $$ I_{num} = 4\\pi\\rho \\int_1^{r_c} \\left[\\exp\\left(-\\frac{\\beta\\varepsilon}{r} e^{-\\kappa(r-1)}\\right) - 1\\right] r^2 dr $$\n    $S(0)$ 的“朴素”估计是通过在 $r_c$ 处截断积分得到的：\n    $$S_{naive}(0) = 1 + I_{HC} + I_{num}$$\n3.  **尾部修正 ($r > r_c$):** 对于大的 $r$，势 $\\beta u(r)$ 很小，所以 $h(r) \\approx -\\beta u(r)$。尾部积分为：\n    $$ I_{tail} = 4\\pi\\rho \\int_{r_c}^\\infty [-\\beta u(r)] r^2 dr = -4\\pi\\rho (\\beta\\varepsilon) e^\\kappa \\int_{r_c}^\\infty r e^{-\\kappa r} dr $$\n    该积分可以解析求解：\n    $$ \\int_{r_c}^\\infty r e^{-\\kappa r} dr = \\left[ -e^{-\\kappa r} \\left(\\frac{r}{\\kappa} + \\frac{1}{\\kappa^2}\\right) \\right]_{r_c}^\\infty = e^{-\\kappa r_c} \\left(\\frac{r_c}{\\kappa} + \\frac{1}{\\kappa^2}\\right) $$\n    因此，尾部贡献为：\n    $$ I_{tail} = -4\\pi\\rho (\\beta\\varepsilon) \\frac{e^{\\kappa(1-r_c)}}{\\kappa^2} (\\kappa r_c + 1) $$\n    “修正后”的 $S(0)$ 估计包括此解析修正：\n    $$S_{corr}(0) = S_{naive}(0) + I_{tail}$$\n\n**5. 渗透压重构**\n\n给定一组离散密度 $\\{\\rho_0, \\rho_1, \\dots, \\rho_M\\}$ 且 $\\rho_0 = 0$，在 $\\rho_M$ 处的渗透压通过使用梯形法则对压缩率关系进行数值积分来计算。首先，为每个密度 $\\rho_i > 0$ 计算修正后的 $S_{corr}(0)$。对于 $\\rho_0=0$，我们使用理想气体极限 $S(0)=1$。令 $y_i = 1/S_{corr}(0; \\rho_i)$。那么约化渗透压可近似为：\n$$\\Pi_{red}(\\rho_M) \\approx \\sum_{i=0}^{M-1} \\frac{1}{2} (y_i + y_{i+1}) (\\rho_{i+1} - \\rho_i)$$\n此过程构成了从指定的模型和参数计算所需物理量的完整、自洽的算法。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Main function to orchestrate the calculations for all test cases and print the final result.\n    \"\"\"\n    \n    SIGMA = 1.0  # Reduced units, sigma = 1\n    TOL = 1e-7   # Integration tolerance보다 조금 더 타이트하게 설정\n\n    def beta_u(r, beta_eps, kappa):\n        \"\"\"Calculates dimensionless potential energy beta*u(r) for r >= sigma.\"\"\"\n        if r < SIGMA:\n            return np.inf\n        return beta_eps * (SIGMA / r) * np.exp(-kappa * (r - SIGMA))\n\n    def h_func(r, beta_eps, kappa):\n        \"\"\"Total correlation function h(r) = g(r) - 1 using the low-density approximation.\"\"\"\n        if r < SIGMA:\n            return -1.0\n        # For numerical stability, handle large potential values\n        potential = beta_u(r, beta_eps, kappa)\n        if potential > 100: # np.exp(-100) is effectively zero\n            return -1.0\n        return np.exp(-potential) - 1.0\n\n    def calculate_S0_values(rho, N, beta_eps, kappa, L_override=None):\n        \"\"\"\n        Calculates both naive and corrected S(0) for a given density and parameters.\n        - rho: number density\n        - N: number of particles\n        - beta_eps: reduced interaction strength\n        - kappa: inverse screening length\n        - L_override: optional fixed box length\n        \"\"\"\n        if rho == 0.0:\n            return 1.0, 1.0\n\n        if L_override is not None:\n            L = L_override\n        else:\n            L = (N / rho)**(1.0 / 3.0)\n        \n        r_c = L / 2.0\n\n        # Part 1: Analytical hard-core contribution to the integral\n        # Integral of 4*pi*rho*(-1)*r^2 from 0 to SIGMA\n        hc_integral_contribution = -4.0 * np.pi * rho * (SIGMA**3 / 3.0)\n\n        # Part 2: Numerical integration from SIGMA to r_c\n        # The case r_c <= SIGMA implies the simulation box is smaller than the hard core diameter,\n        # so there's no soft repulsive part to integrate numerically.\n        numerical_integral_part = 0.0\n        if r_c > SIGMA:\n            integrand = lambda r: 4.0 * np.pi * rho * h_func(r, beta_eps, kappa) * r**2\n            numerical_integral_part, _ = quad(integrand, SIGMA, r_c, epsabs=TOL, epsrel=TOL)\n\n        # Naive S(0) is based on truncation at r_c\n        s0_naive = 1.0 + hc_integral_contribution + numerical_integral_part\n\n        # Part 3: Analytical tail correction for r > r_c\n        # Based on the asymptotic approximation h(r) ~ -beta*u(r)\n        # The tail correction is zero if r_c is smaller than the hard core, as the soft potential starts at SIGMA\n        tail_contribution = 0.0\n        if r_c > SIGMA:\n             tail_contribution = (\n                 -4.0 * np.pi * rho * beta_eps\n                 * np.exp(kappa * (SIGMA - r_c))\n                 * (r_c / kappa + 1.0 / kappa**2)\n             )\n\n        # Corrected S(0) includes the tail\n        s0_corrected = s0_naive + tail_contribution\n        \n        return s0_naive, s0_corrected\n\n    def calculate_pi(densities, N, beta_eps, kappa):\n        \"\"\"\n        Calculates the reduced osmotic pressure by integrating the compressibility relation.\n        - densities: A list of densities along the integration path.\n        - Other params are for S(0) calculation.\n        \"\"\"\n        integrand_values = []\n        for rho_i in densities:\n            if rho_i == 0.0:\n                s0_corr = 1.0\n            else:\n                _, s0_corr = calculate_S0_values(rho_i, N, beta_eps, kappa)\n            \n            integrand_values.append(1.0 / s0_corr)\n\n        # Use trapezoidal rule for numerical integration\n        pi_reduced = np.trapz(integrand_values, x=densities)\n        return pi_reduced\n\n    # --- Test Cases ---\n    results = []\n\n    # Case A: Happy path, short-range, weak repulsion\n    kappa_A, beta_eps_A, N_A = 3.0, 1.0, 500\n    densities_A = [0.0, 0.05, 0.10, 0.15]\n    pi_A = calculate_pi(densities_A, N_A, beta_eps_A, kappa_A)\n    results.append(pi_A)\n\n    # Case B: Longer-range, stronger repulsion\n    kappa_B, beta_eps_B, N_B = 1.0, 2.5, 800\n    densities_B = [0.0, 0.02, 0.05, 0.10]\n    rho_B_target = 0.10\n    \n    # Task (i): Corrected S(0) at rho = 0.10\n    _, s0_corr_B = calculate_S0_values(rho_B_target, N_B, beta_eps_B, kappa_B)\n    results.append(s0_corr_B)\n\n    # Task (ii): Corrected osmotic pressure at rho = 0.10\n    pi_B = calculate_pi(densities_B, N_B, beta_eps_B, kappa_B)\n    results.append(pi_B)\n    \n    # Case C: Finite-size edge case, small box\n    kappa_C, beta_eps_C, L_C = 1.0, 2.5, 6.0\n    rho_target_C = 0.10\n    \n    N_C = int(round(rho_target_C * L_C**3))\n    rho_C = N_C / L_C**3\n    \n    # Task (i) Naive S(0) and Task (ii) Corrected S(0)\n    s0_naive_C, s0_corr_C = calculate_S0_values(rho_C, N_C, beta_eps_C, kappa_C, L_override=L_C)\n    results.append(s0_naive_C)\n    results.append(s0_corr_C)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{x:.6f}' for x in results)}]\")\n\nsolve()\n```"
        }
    ]
}