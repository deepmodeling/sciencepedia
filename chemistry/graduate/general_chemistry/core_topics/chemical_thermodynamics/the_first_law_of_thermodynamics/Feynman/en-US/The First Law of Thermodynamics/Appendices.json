{
    "hands_on_practices": [
        {
            "introduction": "Understanding the distinction between state functions and path functions is central to mastering the First Law of Thermodynamics. This practice provides a concrete application of these concepts by analyzing a simple, closed thermodynamic cycle for an ideal gas. By explicitly calculating the heat ($q$), work ($w$), and internal energy change ($\\Delta U$) for each leg of a rectangular p-V cycle, you will directly verify that while $q$ and $w$ depend on the path taken, the net change in the state function $U$ over the full cycle is zero, as dictated by the First Law .",
            "id": "2959099",
            "problem": "A sample of $n = 1.000$ $\\mathrm{mol}$ of a monatomic ideal gas is taken through a clockwise rectangular cycle in the pressure–volume plane consisting of two isobaric legs and two isochoric legs. The four vertices of the rectangle are defined by the pairs ($p,V$) with $p_{\\mathrm{low}} = 125.0$ $\\mathrm{kPa}$, $p_{\\mathrm{high}} = 275.0$ $\\mathrm{kPa}$, $V_{\\mathrm{low}} = 9.00$ $\\mathrm{L}$, and $V_{\\mathrm{high}} = 15.00$ $\\mathrm{L}$. The cycle proceeds as follows:\n- State $\\mathrm{A}$: ($p_{\\mathrm{high}}, V_{\\mathrm{low}}$).\n- $\\mathrm{A} \\to \\mathrm{B}$: isobaric expansion at $p_{\\mathrm{high}}$ from $V_{\\mathrm{low}}$ to $V_{\\mathrm{high}}$.\n- $\\mathrm{B} \\to \\mathrm{C}$: isochoric pressure decrease at $V_{\\mathrm{high}}$ from $p_{\\mathrm{high}}$ to $p_{\\mathrm{low}}$.\n- $\\mathrm{C} \\to \\mathrm{D}$: isobaric compression at $p_{\\mathrm{low}}$ from $V_{\\mathrm{high}}$ to $V_{\\mathrm{low}}$.\n- $\\mathrm{D} \\to \\mathrm{A}$: isochoric pressure increase at $V_{\\mathrm{low}}$ from $p_{\\mathrm{low}}$ to $p_{\\mathrm{high}}$.\n\nAssumptions and conventions:\n- The process is quasistatic (reversible) so that the system pressure equals the external pressure along each leg.\n- The gas remains ideal at all points and obeys $pV = nRT$ with $R = 8.314462618$ $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$.\n- For the monatomic ideal gas, the molar heat capacity at constant volume is temperature independent and equal to $C_{V,\\mathrm{m}} = \\tfrac{3}{2}R$.\n- The inexact differential of pressure–volume work is defined as $\\delta w = -p\\,dV$ (work done on the system is positive). The inexact differential of heat is defined as $\\delta q$ (heat added to the system is positive).\n- The First Law of Thermodynamics is taken in the form $dU = \\delta q + \\delta w$.\n\nTasks:\n- Compute the cyclic work $\\oint \\delta w$.\n- Compute the cyclic heat $\\oint \\delta q$.\n- Verify that the total change in internal energy over the complete cycle is zero, $\\Delta U_{\\mathrm{cycle}} = 0$, by explicit calculation consistent with the stated principles.\n\nExpress all energies in $\\mathrm{J}$. Round your final numerical answers to three significant figures. The final answer must be a single object and must contain the values of $\\oint \\delta w$, $\\oint \\delta q$, and $\\Delta U_{\\mathrm{cycle}}$ in that order.",
            "solution": "The problem requires the calculation of the total work done on the gas, $w_{\\mathrm{cycle}} = \\oint \\delta w$, the total heat absorbed by the gas, $q_{\\mathrm{cycle}} = \\oint \\delta q$, and the total change in internal energy, $\\Delta U_{\\mathrm{cycle}}$, for one complete cycle. The First Law of Thermodynamics, $dU = \\delta q + \\delta w$, governs the energy transformations, using the convention that work done on the system is positive.\n\nFirst, we must express all given quantities in SI units.\nPressure:\n$p_{\\mathrm{low}} = 125.0\\,\\mathrm{kPa} = 1.250 \\times 10^5\\,\\mathrm{Pa}$\n$p_{\\mathrm{high}} = 275.0\\,\\mathrm{kPa} = 2.750 \\times 10^5\\,\\mathrm{Pa}$\nVolume:\n$V_{\\mathrm{low}} = 9.00\\,\\mathrm{L} = 9.00 \\times 10^{-3}\\,\\mathrm{m^3}$\n$V_{\\mathrm{high}} = 15.00\\,\\mathrm{L} = 1.500 \\times 10^{-2}\\,\\mathrm{m^3}$\n\nThe cycle consists of four quasistatic legs: $\\mathrm{A} \\to \\mathrm{B}$, $\\mathrm{B} \\to \\mathrm{C}$, $\\mathrm{C} \\to \\mathrm{D}$, and $\\mathrm{D} \\to \\mathrm{A}$.\n\nTask 1: Compute the cyclic work, $\\oint \\delta w = w_{\\mathrm{cycle}}$.\nThe total work is the sum of the work done during each leg of the cycle:\n$$w_{\\mathrm{cycle}} = w_{AB} + w_{BC} + w_{CD} + w_{DA}$$\nWork done *on* the system is defined by the integral $w = \\int -p\\,dV$.\n\nLeg $\\mathrm{A} \\to \\mathrm{B}$ (isobaric expansion at $p = p_{\\mathrm{high}}$):\n$w_{AB} = \\int_{V_{\\mathrm{low}}}^{V_{\\mathrm{high}}} -p_{\\mathrm{high}}\\,dV = -p_{\\mathrm{high}}(V_{\\mathrm{high}} - V_{\\mathrm{low}})$\n\nLeg $\\mathrm{B} \\to \\mathrm{C}$ (isochoric pressure decrease at $V = V_{\\mathrm{high}}$):\nSince the volume is constant, $dV = 0$, and the work done is zero.\n$w_{BC} = \\int -p\\,dV = 0$\n\nLeg $\\mathrm{C} \\to \\mathrm{D}$ (isobaric compression at $p = p_{\\mathrm{low}}$):\n$w_{CD} = \\int_{V_{\\mathrm{high}}}^{V_{\\mathrm{low}}} -p_{\\mathrm{low}}\\,dV = -p_{\\mathrm{low}}(V_{\\mathrm{low}} - V_{\\mathrm{high}}) = p_{\\mathrm{low}}(V_{\\mathrm{high}} - V_{\\mathrm{low}})$\n\nLeg $\\mathrm{D} \\to \\mathrm{A}$ (isochoric pressure increase at $V = V_{\\mathrm{low}}$):\nSince the volume is constant, $dV = 0$, and the work done is zero.\n$w_{DA} = \\int -p\\,dV = 0$\n\nThe total work for the cycle is the sum of these contributions:\n$w_{\\mathrm{cycle}} = -p_{\\mathrm{high}}(V_{\\mathrm{high}} - V_{\\mathrm{low}}) + 0 + p_{\\mathrm{low}}(V_{\\mathrm{high}} - V_{\\mathrm{low}}) + 0$\n$$w_{\\mathrm{cycle}} = -(p_{\\mathrm{high}} - p_{\\mathrm{low}})(V_{\\mathrm{high}} - V_{\\mathrm{low}})$$\nThis result corresponds to the negative of the area enclosed by the rectangular path in the $p-V$ plane. The clockwise direction of the cycle means the system does net work on the surroundings, so the work done *on* the system is negative.\n\nNow, we substitute the numerical values:\n$\\Delta p = p_{\\mathrm{high}} - p_{\\mathrm{low}} = (2.750 - 1.250) \\times 10^5\\,\\mathrm{Pa} = 1.500 \\times 10^5\\,\\mathrm{Pa}$\n$\\Delta V = V_{\\mathrm{high}} - V_{\\mathrm{low}} = (15.00 - 9.00) \\times 10^{-3}\\,\\mathrm{m^3} = 6.00 \\times 10^{-3}\\,\\mathrm{m^3}$\n$w_{\\mathrm{cycle}} = -(1.500 \\times 10^5\\,\\mathrm{Pa}) \\times (6.00 \\times 10^{-3}\\,\\mathrm{m^3}) = -900.0\\,\\mathrm{J}$\nThe number of significant figures is limited by the value for $\\Delta V$, which has three. Thus, we round the result to three significant figures.\n$w_{\\mathrm{cycle}} = -9.00 \\times 10^2\\,\\mathrm{J}$\n\nTask 2: Verify $\\Delta U_{\\mathrm{cycle}} = 0$.\nInternal energy $U$ is a state function, meaning its change depends only on the initial and final states. For any closed cycle, the initial and final states are identical, so the net change in internal energy must be zero, $\\Delta U_{\\mathrm{cycle}} = 0$. The problem requires explicit verification.\n\nFor a monatomic ideal gas, the change in internal energy is given by $\\Delta U = n C_{V,\\mathrm{m}} \\Delta T$, where $C_{V,\\mathrm{m}} = \\frac{3}{2}R$. Using the ideal gas law, $pV = nRT$, we can write $\\Delta U = \\frac{3}{2} nR \\Delta T = \\frac{3}{2} \\Delta(nRT) = \\frac{3}{2}\\Delta(pV)$.\nThe total change over the cycle is:\n$\\Delta U_{\\mathrm{cycle}} = \\Delta U_{AB} + \\Delta U_{BC} + \\Delta U_{CD} + \\Delta U_{DA}$\n\n$\\Delta U_{AB} = \\frac{3}{2}(p_B V_B - p_A V_A) = \\frac{3}{2}(p_{\\mathrm{high}}V_{\\mathrm{high}} - p_{\\mathrm{high}}V_{\\mathrm{low}}) = \\frac{3}{2}p_{\\mathrm{high}}(V_{\\mathrm{high}} - V_{\\mathrm{low}})$\n$\\Delta U_{BC} = \\frac{3}{2}(p_C V_C - p_B V_B) = \\frac{3}{2}(p_{\\mathrm{low}}V_{\\mathrm{high}} - p_{\\mathrm{high}}V_{\\mathrm{high}}) = \\frac{3}{2}V_{\\mathrm{high}}(p_{\\mathrm{low}} - p_{\\mathrm{high}})$\n$\\Delta U_{CD} = \\frac{3}{2}(p_D V_D - p_C V_C) = \\frac{3}{2}(p_{\\mathrm{low}}V_{\\mathrm{low}} - p_{\\mathrm{low}}V_{\\mathrm{high}}) = \\frac{3}{2}p_{\\mathrm{low}}(V_{\\mathrm{low}} - V_{\\mathrm{high}})$\n$\\Delta U_{DA} = \\frac{3}{2}(p_A V_A - p_D V_D) = \\frac{3}{2}(p_{\\mathrm{high}}V_{\\mathrm{low}} - p_{\\mathrm{low}}V_{\\mathrm{low}}) = \\frac{3}{2}V_{\\mathrm{low}}(p_{\\mathrm{high}} - p_{\\mathrm{low}})$\n\nSumming these terms algebraically:\n$\\Delta U_{\\mathrm{cycle}} = \\frac{3}{2} [ (p_{\\mathrm{high}}V_{\\mathrm{high}} - p_{\\mathrm{high}}V_{\\mathrm{low}}) + (p_{\\mathrm{low}}V_{\\mathrm{high}} - p_{\\mathrm{high}}V_{\\mathrm{high}}) + (p_{\\mathrm{low}}V_{\\mathrm{low}} - p_{\\mathrm{low}}V_{\\mathrm{high}}) + (p_{\\mathrm{high}}V_{\\mathrm{low}} - p_{\\mathrm{low}}V_{\\mathrm{low}}) ]$\nUpon rearranging, all terms cancel:\n$\\Delta U_{\\mathrm{cycle}} = \\frac{3}{2} [ (p_{\\mathrm{high}}V_{\\mathrm{high}} - p_{\\mathrm{high}}V_{\\mathrm{high}}) + (-p_{\\mathrm{high}}V_{\\mathrm{low}} + p_{\\mathrm{high}}V_{\\mathrm{low}}) + (p_{\\mathrm{low}}V_{\\mathrm{high}} - p_{\\mathrm{low}}V_{\\mathrm{high}}) + (p_{\\mathrm{low}}V_{\\mathrm{low}} - p_{\\mathrm{low}}V_{\\mathrm{low}}) ] = \\frac{3}{2}[0] = 0$\n\nNumerically:\n$\\Delta U_{AB} = \\frac{3}{2}(2.750 \\times 10^5)(6.00 \\times 10^{-3}) = 2475\\,\\mathrm{J}$\n$\\Delta U_{BC} = \\frac{3}{2}(1.500 \\times 10^{-2})(-1.500 \\times 10^5) = -3375\\,\\mathrm{J}$\n$\\Delta U_{CD} = \\frac{3}{2}(1.250 \\times 10^5)(-6.00 \\times 10^{-3}) = -1125\\,\\mathrm{J}$\n$\\Delta U_{DA} = \\frac{3}{2}(9.00 \\times 10^{-3})(1.500 \\times 10^5) = 2025\\,\\mathrm{J}$\n$\\Delta U_{\\mathrm{cycle}} = 2475 - 3375 - 1125 + 2025 = 0\\,\\mathrm{J}$.\nThe explicit calculation confirms that $\\Delta U_{\\mathrm{cycle}} = 0$.\n\nTask 3: Compute the cyclic heat, $\\oint \\delta q = q_{\\mathrm{cycle}}$.\nAccording to the First Law of Thermodynamics for a complete cycle:\n$$\\Delta U_{\\mathrm{cycle}} = q_{\\mathrm{cycle}} + w_{\\mathrm{cycle}}$$\nSince we have established that $\\Delta U_{\\mathrm{cycle}} = 0$, it must hold that:\n$$q_{\\mathrm{cycle}} = -w_{\\mathrm{cycle}}$$\nTherefore, using the result from Task 1:\n$q_{\\mathrm{cycle}} = -(-900.0\\,\\mathrm{J}) = 900.0\\,\\mathrm{J}$\nRounding to three significant figures, we get:\n$q_{\\mathrm{cycle}} = 9.00 \\times 10^2\\,\\mathrm{J}$\n\nThe final values for the three requested quantities are $\\oint \\delta w = -9.00 \\times 10^2\\,\\mathrm{J}$, $\\oint \\delta q = 9.00 \\times 10^2\\,\\mathrm{J}$, and $\\Delta U_{\\mathrm{cycle}} = 0\\,\\mathrm{J}$.",
            "answer": "$$\\boxed{\\begin{pmatrix} -9.00 \\times 10^2 & 9.00 \\times 10^2 & 0 \\end{pmatrix}}$$"
        },
        {
            "introduction": "While the ideal gas is a powerful pedagogical tool, real systems exhibit non-ideal behavior due to intermolecular forces. This exercise delves into the thermodynamics of a van der Waals gas, a more realistic model that accounts for molecular size and attractions. You will derive the change in internal energy for an isothermal expansion, discovering firsthand that for a non-ideal gas, internal energy is not a function of temperature alone but also depends on volume . This calculation elegantly demonstrates how the '$a$' parameter, representing intermolecular attractions, gives rise to a volume-dependent internal energy.",
            "id": "2959157",
            "problem": "A closed, single-phase system contains $n$ moles of a gas that obeys the van der Waals equation of state for all relevant states, with temperature-independent parameters $a$ and $b$. The gas undergoes a reversible, isothermal expansion at temperature $T$ from an initial volume $V_1$ to a final volume $V_2$, with $V_2 > V_1$. Neglect kinetic and potential energy changes. Starting only from the First Law of Thermodynamics for a closed system and standard thermodynamic identities, derive an exact expression for the internal energy change $\\Delta U$ along this isothermal path. Your derivation must make explicit which features of nonideality contribute to $\\Delta U$. \n\nReport your final result as a single analytic expression in terms of $a$, $n$, $V_1$, and $V_2$. Use the International System of Units (SI), taking $a$ in $\\mathrm{Pa \\cdot m^6 \\cdot mol^{-2}}$, volumes in $\\mathrm{m^3}$, and energy in $\\mathrm{J}$. Do not substitute numerical values. No rounding is required. Express the final answer as a closed-form analytic expression.",
            "solution": "The problem requires the derivation of the change in internal energy, $\\Delta U$, for a reversible isothermal expansion of a van der Waals gas, starting from the First Law of Thermodynamics and standard thermodynamic identities.\n\nThe First Law of Thermodynamics for a closed system undergoing a reversible process states that the differential change in internal energy, $dU$, is the sum of the heat added to the system, $\\delta Q_{\\text{rev}}$, and the work done on the system, $\\delta W_{\\text{rev}}$. In differential form, this is $dU = \\delta Q_{\\text{rev}} + \\delta W_{\\text{rev}}$. For a reversible process, we have $\\delta Q_{\\text{rev}} = T dS$ and $\\delta W_{\\text{rev}} = -P dV$. This leads to the fundamental equation for internal energy:\n$$ dU = T dS - P dV $$\nInternal energy, $U$, is a state function. We can therefore express its total differential in terms of any two independent state variables. For this problem, the variables of temperature, $T$, and volume, $V$, are most convenient. The total differential of $U(T, V)$ is:\n$$ dU = \\left(\\frac{\\partial U}{\\partial T}\\right)_V dT + \\left(\\frac{\\partial U}{\\partial V}\\right)_T dV $$\nThe process under consideration is isothermal, which means the temperature $T$ is constant, and therefore its differential $dT$ is zero. The expression for the change in internal energy simplifies to:\n$$ dU_T = \\left(\\frac{\\partial U}{\\partial V}\\right)_T dV $$\nThe partial derivative $\\left(\\frac{\\partial U}{\\partial V}\\right)_T$ is known as the internal pressure, which quantifies how the internal energy of a substance changes with volume at constant temperature. To find an expression for this term, we return to the fundamental equation $dU = T dS - P dV$. Dividing by $dV$ while holding $T$ constant gives:\n$$ \\left(\\frac{\\partial U}{\\partial V}\\right)_T = T \\left(\\frac{\\partial S}{\\partial V}\\right)_T - P $$\nThis expression contains a partial derivative of entropy, which is not convenient. We can replace it using a Maxwell relation. The Maxwell relations arise from the fact that the fundamental thermodynamic potentials are state functions, meaning their mixed second partial derivatives are equal. The relevant relation comes from the Helmholtz free energy, $A = U - TS$. Its differential is $dA = dU - T dS - S dT = (T dS - P dV) - T dS - S dT = -S dT - P dV$. From $A(T, V)$, the equality of mixed partial derivatives $\\frac{\\partial^2 A}{\\partial V \\partial T} = \\frac{\\partial^2 A}{\\partial T \\partial V}$ implies:\n$$ \\left(\\frac{\\partial (-S)}{\\partial V}\\right)_T = \\left(\\frac{\\partial (-P)}{\\partial T}\\right)_V \\implies \\left(\\frac{\\partial S}{\\partial V}\\right)_T = \\left(\\frac{\\partial P}{\\partial T}\\right)_V $$\nSubstituting this Maxwell relation into the equation for the internal pressure yields a critical thermodynamic equation of state:\n$$ \\left(\\frac{\\partial U}{\\partial V}\\right)_T = T \\left(\\frac{\\partial P}{\\partial T}\\right)_V - P $$\nThis equation is general and applies to any fluid. Now we apply it to the specific case of a van der Waals gas. The van der Waals equation of state is given by:\n$$ \\left(P + \\frac{an^2}{V^2}\\right)(V - nb) = nRT $$\nTo use our thermodynamic equation of state, we must first find $\\left(\\frac{\\partial P}{\\partial T}\\right)_V$. We rearrange the van der Waals equation to express pressure $P$ as a function of $T$ and $V$:\n$$ P(T,V) = \\frac{nRT}{V - nb} - \\frac{an^2}{V^2} $$\nNow we take the partial derivative of $P$ with respect to $T$ at constant $V$ and $n$:\n$$ \\left(\\frac{\\partial P}{\\partial T}\\right)_V = \\frac{\\partial}{\\partial T} \\left( \\frac{nRT}{V - nb} - \\frac{an^2}{V^2} \\right) = \\frac{nR}{V - nb} $$\nThe term $\\frac{an^2}{V^2}$, which accounts for the attractive forces between molecules, is independent of temperature, so its derivative with respect to $T$ is zero.\nNext, substitute this result for $\\left(\\frac{\\partial P}{\\partial T}\\right)_V$ into the expression for the internal pressure:\n$$ \\left(\\frac{\\partial U}{\\partial V}\\right)_T = T \\left( \\frac{nR}{V - nb} \\right) - P $$\nNow, we substitute the full expression for the van der Waals pressure $P$ back into this equation:\n$$ \\left(\\frac{\\partial U}{\\partial V}\\right)_T = \\frac{nRT}{V - nb} - \\left( \\frac{nRT}{V - nb} - \\frac{an^2}{V^2} \\right) $$\nThe terms involving the kinetic energy component of the pressure cancel, leaving a remarkably simple result:\n$$ \\left(\\frac{\\partial U}{\\partial V}\\right)_T = \\frac{an^2}{V^2} $$\nThis result explicitly reveals the feature of non-ideality responsible for the volume dependence of internal energy. The internal pressure of a van der Waals gas is non-zero solely due to the parameter $a$, which represents the strength of intermolecular attractive forces. For an ideal gas, $a=0$, and thus $\\left(\\frac{\\partial U}{\\partial V}\\right)_T = 0$, meaning its internal energy depends only on temperature. For the van der Waals gas, expanding the volume requires work to pull the molecules apart against these attractions, which increases their potential energy and thus the total internal energy of the system. The parameter $b$, representing excluded volume, does not contribute to the internal pressure.\n\nTo find the total change in internal energy, $\\Delta U$, for the specified isothermal expansion from an initial volume $V_1$ to a final volume $V_2$, we must integrate $dU_T$ over the path:\n$$ \\Delta U = \\int_{U(T,V_1)}^{U(T,V_2)} dU = \\int_{V_1}^{V_2} \\left(\\frac{\\partial U}{\\partial V}\\right)_T dV $$\nSubstituting our derived expression for the internal pressure:\n$$ \\Delta U = \\int_{V_1}^{V_2} \\frac{an^2}{V^2} dV $$\nThe parameters $a$ and $n$ are constants, so we can move them outside the integral:\n$$ \\Delta U = an^2 \\int_{V_1}^{V_2} V^{-2} dV $$\nPerforming the definite integration yields:\n$$ \\Delta U = an^2 \\left[ -\\frac{1}{V} \\right]_{V_1}^{V_2} = an^2 \\left( \\left(-\\frac{1}{V_2}\\right) - \\left(-\\frac{1}{V_1}\\right) \\right) $$\nThis simplifies to the final analytical expression for the change in internal energy:\n$$ \\Delta U = an^2 \\left( \\frac{1}{V_1} - \\frac{1}{V_2} \\right) $$\nAs the problem specifies an expansion, $V_2 > V_1$, it follows that $\\frac{1}{V_1} > \\frac{1}{V_2}$. Therefore, the term $\\left( \\frac{1}{V_1} - \\frac{1}{V_2} \\right)$ is positive, and $\\Delta U > 0$. This confirms that the internal energy increases during an isothermal expansion of a van der Waals gas, consistent with the physical reasoning that energy is required to overcome intermolecular attractions.",
            "answer": "$$ \\boxed{an^{2} \\left( \\frac{1}{V_1} - \\frac{1}{V_2} \\right)} $$"
        },
        {
            "introduction": "The principles of thermodynamics are not confined to textbook examples; they are the bedrock of modern computational materials science. This advanced practice invites you to step into the role of a computational chemist, using simulated phonon data to explore the thermal properties of a crystalline solid . By combining statistical mechanics with the First Law, you will construct the internal energy $U(V,T)$ and calculate the thermal pressure, a key quantity in a material's equation of state. This exercise provides a hands-on experience in how fundamental thermodynamic concepts are applied to predict the macroscopic behavior of materials from first-principles data.",
            "id": "2529333",
            "problem": "You are provided with a synthetic but scientifically consistent dataset that mimics the outcome of first-principles phonon calculations for a crystalline solid at several volumes. Your task is to use fundamental thermodynamics and statistical mechanics to construct the vibrational internal energy as a function of volume and temperature, denoted by $U(V,T)$, and from it determine the thermal pressure contribution to the equation of state under the quasi-harmonic approximation. Your final output must be produced by a complete, runnable program.\n\nFundamental base to use:\n- The first law of thermodynamics: $dU = \\delta Q - \\delta W$, with reversible $p\\,dV$ work and the definition of pressure as a generalized force $p = -\\left(\\partial F/\\partial V\\right)_{T}$, where $F$ is the Helmholtz free energy.\n- The statistical mechanics of a quantum harmonic oscillator: the canonical partition function, equilibrium averages, and the Bose–Einstein occupation for phonons.\n- The quasi-harmonic approximation (QHA): vibrational frequencies depend on volume $V$ but not explicitly on temperature $T$.\n\nDataset:\n- Volumes in cubic angstrom per formula unit: $V_{1} = 15.00$, $V_{2} = 15.75$, $V_{3} = 16.50$.\n- For each volume $V_{k}$, you are given a set of $6$ phonon mode frequencies (in terahertz) that represent the $3N$ normal modes of a primitive cell with $N=2$ atoms (degeneracy $=1$ for each listed mode). The identity (ordering) of modes is consistent across volumes.\n  - At $V_{1}$: $\\{11.0,\\,9.0,\\,7.0,\\,5.0,\\,3.5,\\,2.0\\}$.\n  - At $V_{2}$: $\\{10.3,\\,8.5,\\,6.6,\\,4.7,\\,3.3,\\,1.9\\}$.\n  - At $V_{3}$: $\\{9.8,\\,8.0,\\,6.2,\\,4.4,\\,3.1,\\,1.8\\}$.\n\nConstants and units to use:\n- Reduced Planck constant $\\hbar = 1.054\\,571\\,817\\times 10^{-34}\\ \\mathrm{J\\cdot s}$.\n- Boltzmann constant $k_{\\mathrm{B}} = 1.380\\,649\\times 10^{-23}\\ \\mathrm{J/K}$.\n- Electron volt to joule conversion: $1\\ \\mathrm{eV} = 1.602\\,176\\,634\\times 10^{-19}\\ \\mathrm{J}$.\n- Frequency conversion: if $\\nu$ is in terahertz, the angular frequency is $\\omega = 2\\pi\\,\\nu\\times 10^{12}\\ \\mathrm{rad/s}$.\n- Volume conversion: $1\\ \\text{\\AA}^{3} = 10^{-30}\\ \\mathrm{m}^{3}$.\n\nThermodynamic constructions you must implement, starting from the fundamental base:\n1. For each normal mode of angular frequency $\\omega(V)$, the quantum harmonic oscillator internal energy $U_{\\text{mode}}(V,T)$ must be obtained from equilibrium statistical mechanics. Define the zero-temperature limit $U_{\\text{mode}}(V,0)$ to compute the strictly thermal part $U_{\\text{mode,th}}(V,T) = U_{\\text{mode}}(V,T) - U_{\\text{mode}}(V,0)$.\n2. Use the definition of pressure as a derivative of the Helmholtz free energy with respect to volume at constant temperature and the quasi-harmonic volume dependence of the frequencies to express the vibrational pressure. Define the thermal pressure contribution as $P_{\\text{th}}(V,T) = P_{\\text{vib}}(V,T) - P_{\\text{vib}}(V,0)$ so that $P_{\\text{th}}(V,0)=0$ by construction.\n3. Estimate the mode-resolved Grüneisen parameter for each mode $i$ via a centered finite-difference slope of the logarithm of frequency with respect to the logarithm of volume using the data at $V_{1}$ and $V_{3}$:\n   $$\\gamma_{i} \\equiv -\\frac{\\partial \\ln \\omega_{i}}{\\partial \\ln V}\\approx -\\frac{\\ln \\omega_{i}(V_{3}) - \\ln \\omega_{i}(V_{1})}{\\ln V_{3} - \\ln V_{1}}.$$\n   Use these $\\gamma_{i}$ as volume-independent constants over the provided volume range for evaluating $P_{\\text{th}}(V,T)$ at the tabulated volumes.\n4. The internal energy $U(V,T)$ for a given $V$ and $T$ is the sum of the mode energies over all listed modes at that same $V$.\n5. The thermal pressure $P_{\\text{th}}(V,T)$ must be evaluated in pascals from the appropriate thermodynamic relations and then reported in gigapascals.\n\nProgramming task:\n- Implement a program that:\n  - Uses the dataset exactly as given above (no interpolation; only evaluate at $V\\in\\{V_{1},V_{2},V_{3}\\}$).\n  - Computes $U(V,T)$ in electron volts per formula unit and $P_{\\text{th}}(V,T)$ in gigapascals for each test case.\n  - Rounds each reported number to $6$ decimal places.\n\nTest suite:\n- Case $1$: $V=15.75\\ \\text{\\AA}^{3}$, $T=0\\ \\mathrm{K}$.\n- Case $2$: $V=15.75\\ \\text{\\AA}^{3}$, $T=300\\ \\mathrm{K}$.\n- Case $3$: $V=16.50\\ \\text{\\AA}^{3}$, $T=1000\\ \\mathrm{K}$.\n- Case $4$: $V=15.00\\ \\text{\\AA}^{3}$, $T=10\\ \\mathrm{K}$.\n\nAnswer specification:\n- For each test case, output two floats in this order: $U(V,T)$ in $\\mathrm{eV}$ and $P_{\\text{th}}(V,T)$ in $\\mathrm{GPa}$, each rounded to $6$ decimal places.\n- Aggregate the results for all cases into a single flat list in the order of the test suite above, and print a single line containing that list as a comma-separated list enclosed in square brackets, for example $[u_{1},p_{1},u_{2},p_{2},u_{3},p_{3},u_{4},p_{4}]$.\n- Angles do not appear; temperatures must be treated in kelvin; volumes must be treated in cubic meters when entering thermodynamic expressions; frequencies must be converted to angular frequency in radians per second before use.\n\nScientific realism requirements:\n- Treat each listed mode as an independent harmonic oscillator.\n- Ensure unit consistency at all steps.\n- Do not introduce any formulas not derivable from the stated fundamental base; instead, implement the relations you derive from it in your solution.",
            "solution": "The problem requires the calculation of the total vibrational internal energy $U(V,T)$ and the thermal pressure $P_{\\text{th}}(V,T)$ for a crystalline solid, based on a given set of phonon frequencies at several volumes. The solution will be constructed from the fundamental principles of statistical mechanics and thermodynamics, under the quasi-harmonic approximation (QHA).\n\n**1. Theoretical Foundation**\n\nA crystalline solid's vibrational state can be modeled as a collection of independent quantum harmonic oscillators (QHOs), each corresponding to a normal mode (phonon) with an angular frequency $\\omega$. In the QHA, these frequencies depend on volume but not explicitly on temperature, i.e., $\\omega_i = \\omega_i(V)$.\n\n**1.1. Vibrational Internal Energy $U(V,T)$**\n\nThe energy levels of a single QHO with angular frequency $\\omega$ are $E_n = \\hbar\\omega(n + 1/2)$ for $n=0, 1, 2, \\dots$. The canonical partition function for a single mode is:\n$$ Z_{\\text{mode}} = \\sum_{n=0}^{\\infty} e^{-E_n / (k_B T)} = e^{-\\hbar\\omega / (2k_B T)} \\sum_{n=0}^{\\infty} \\left(e^{-\\hbar\\omega / (k_B T)}\\right)^n = \\frac{e^{-\\hbar\\omega / (2k_B T)}}{1 - e^{-\\hbar\\omega / (k_B T)}} $$\nThe average internal energy of this mode, $U_{\\text{mode}}$, is found using the standard statistical mechanical relation $U = -\\partial(\\ln Z)/\\partial\\beta$, where $\\beta = 1/(k_B T)$:\n$$ U_{\\text{mode}}(V,T) = -\\frac{\\partial}{\\partial\\beta} \\ln Z_{\\text{mode}} = \\frac{\\hbar\\omega(V)}{2} + \\frac{\\hbar\\omega(V)}{e^{\\hbar\\omega(V)/(k_B T)} - 1} $$\nThis expression consists of two parts: the temperature-independent zero-point energy (ZPE), $U_{\\text{mode}}(V,0) = \\frac{1}{2}\\hbar\\omega(V)$, and a temperature-dependent term representing thermal excitation. The quantity $n_B(\\omega, T) = (e^{\\hbar\\omega/(k_B T)} - 1)^{-1}$ is the Bose-Einstein distribution, or the average occupation number of phonons in the mode.\n\nThe total internal energy of the solid per formula unit, $U(V,T)$, is the sum of the energies of all $3N$ modes (where $N$ is the number of atoms per formula unit):\n$$ U(V,T) = \\sum_{i=1}^{3N} U_{\\text{mode}, i}(V,T) = \\sum_{i=1}^{3N} \\left[ \\frac{\\hbar\\omega_i(V)}{2} + \\frac{\\hbar\\omega_i(V)}{e^{\\hbar\\omega_i(V)/(k_B T)} - 1} \\right] $$\nFor the problem, we are given $6$ modes for a primitive cell with $N=2$ atoms, so the sum is over these $6$ modes. This is the formula to be implemented for $U(V,T)$.\n\n**1.2. Thermal Pressure $P_{\\text{th}}(V,T)$**\n\nPressure is a thermodynamic derivative of the Helmholtz free energy, $F$, with respect to volume: $P = -(\\partial F/\\partial V)_T$. The free energy of a single mode is $F_{\\text{mode}} = -k_B T \\ln Z_{\\text{mode}}$:\n$$ F_{\\text{mode}}(V,T) = \\frac{\\hbar\\omega(V)}{2} + k_B T \\ln\\left(1 - e^{-\\hbar\\omega(V)/(k_B T)}\\right) $$\nThe total free energy is $F(V,T) = \\sum_i F_{\\text{mode},i}(V,T)$. The vibrational pressure is then:\n$$ P_{\\text{vib}}(V,T) = -\\left(\\frac{\\partial F(V,T)}{\\partial V}\\right)_T = -\\sum_i \\frac{\\partial F_{\\text{mode},i}}{\\partial \\omega_i} \\frac{d\\omega_i}{dV} $$\nIt can be shown that $\\partial F_{\\text{mode},i}/\\partial \\omega_i = U_{\\text{mode},i}/\\omega_i$. To handle the volume derivative of frequency, we introduce the dimensionless mode Grüneisen parameter, $\\gamma_i$:\n$$ \\gamma_i(V) \\equiv -\\frac{d\\ln\\omega_i}{d\\ln V} = -\\frac{V}{\\omega_i(V)}\\frac{d\\omega_i(V)}{dV} $$\nThis allows us to write $\\frac{d\\omega_i}{dV} = -\\frac{\\gamma_i \\omega_i}{V}$. Substituting this into the pressure expression yields:\n$$ P_{\\text{vib}}(V,T) = \\sum_i \\frac{\\gamma_i(V)}{V} U_{\\text{mode},i}(V,T) $$\nThe problem asks for the thermal pressure, $P_{\\text{th}}(V,T)$, which is the pressure change relative to $T=0\\ \\mathrm{K}$.\n$$ P_{\\text{th}}(V,T) = P_{\\text{vib}}(V,T) - P_{\\text{vib}}(V,0) $$\n$$ P_{\\text{th}}(V,T) = \\sum_i \\frac{\\gamma_i(V)}{V} \\left[ U_{\\text{mode},i}(V,T) - U_{\\text{mode},i}(V,0) \\right] $$\nThe term in the bracket is the purely thermal part of the internal energy, $U_{\\text{mode,th},i}(V,T) = \\hbar\\omega_i(V)/(e^{\\hbar\\omega_i(V)/(k_B T)} - 1)$. Thus, the final expression for thermal pressure is:\n$$ P_{\\text{th}}(V,T) = \\frac{1}{V} \\sum_{i=1}^{3N} \\gamma_i(V) \\left( \\frac{\\hbar\\omega_i(V)}{e^{\\hbar\\omega_i(V)/(k_B T)} - 1} \\right) $$\nBy definition, $P_{\\text{th}}(V,0) = 0$.\n\n**2. Computational Implementation**\n\nThe calculation proceeds as follows:\n\nFirst, the mode Grüneisen parameters, $\\gamma_i$, assumed to be constant over the volume range, are estimated using the provided finite-difference formula and the data at volumes $V_1 = 15.00\\ \\text{\\AA}^3$ and $V_3 = 16.50\\ \\text{\\AA}^3$. Since $\\omega_i$ is directly proportional to frequency $\\nu_i$, we can use $\\nu_i$ directly in the formula:\n$$ \\gamma_{i} \\approx -\\frac{\\ln \\nu_{i}(V_{3}) - \\ln \\nu_{i}(V_{1})}{\\ln V_{3} - \\ln V_{1}} $$\nThis calculation is performed once for each of the $6$ modes.\n\nSecond, for each test case specified by a pair $(V, T)$, we retrieve the corresponding list of phonon frequencies $\\nu_i(V)$.\n\nThird, we compute the total internal energy $U(V,T)$. For each of the $6$ modes, we convert its frequency $\\nu_i$ (in THz) to angular frequency $\\omega_i$ (in rad/s) using $\\omega_i = 2\\pi\\nu_i \\times 10^{12}$. We then apply the derived formula for $U(V,T)$, summing the contributions from all modes. For $T=0\\ \\mathrm{K}$, the thermal term is zero, and $U(V,0)$ is simply the sum of the zero-point energies. All calculations are performed using SI units (J, K, m$^3$), and the final result is converted from Joules to electron volts (eV).\n\nFourth, we compute the thermal pressure $P_{\\text{th}}(V,T)$. For $T=0\\ \\mathrm{K}$, the thermal pressure is $0$ by definition. For $T > 0\\ \\mathrm{K}$, we use the formula for $P_{\\text{th}}(V,T)$, summing the contributions from all modes. The volume $V$ must be converted from $\\text{\\AA}^3$ to $\\text{m}^3$. The calculation yields pressure in Pascals (Pa), which is then converted to Gigapascals (GPa).\n\nFinally, the computed values of $U(V,T)$ and $P_{\\text{th}}(V,T)$ are rounded to $6$ decimal places as required. All constants and unit conversions are handled precisely as specified in the problem statement.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of calculating vibrational internal energy and thermal pressure\n    for a crystalline solid based on provided phonon frequency data.\n    \"\"\"\n    # Define constants in SI units as specified\n    HBAR = 1.054571817e-34  # J*s\n    KB = 1.380649e-23      # J/K\n    EV_TO_J = 1.602176634e-19 # J/eV\n    A3_TO_M3 = 1e-30        # m^3/A^3\n    THZ_TO_RAD_S = 2 * np.pi * 1e12 # rad/s / THz\n\n    # Define the dataset from the problem statement\n    # Volumes in cubic angstrom per formula unit\n    V1, V2, V3 = 15.00, 15.75, 16.50\n    # Phonon frequencies in terahertz for each volume\n    FREQS = {\n        V1: np.array([11.0, 9.0, 7.0, 5.0, 3.5, 2.0]),\n        V2: np.array([10.3, 8.5, 6.6, 4.7, 3.3, 1.9]),\n        V3: np.array([9.8, 8.0, 6.2, 4.4, 3.1, 1.8]),\n    }\n\n    def calculate_gruneisen_parameters(v1, v3, freqs_v1, freqs_v3):\n        \"\"\"\n        Calculates mode Gruneisen parameters using a centered finite-difference formula.\n        The parameters are assumed to be volume-independent.\n        \"\"\"\n        log_v_ratio = np.log(v3 / v1)\n        log_freq_ratio = np.log(freqs_v3 / freqs_v1)\n        return -log_freq_ratio / log_v_ratio\n\n    def calculate_properties(V_A3, T_K, freqs_thz, gammas):\n        \"\"\"\n        Computes total internal energy U(V,T) in eV and thermal pressure P_th(V,T) in GPa.\n        \n        Args:\n            V_A3 (float): Volume in cubic angstroms.\n            T_K (float): Temperature in Kelvin.\n            freqs_thz (np.ndarray): Array of phonon frequencies in THz.\n            gammas (np.ndarray): Array of mode Gruneisen parameters.\n        \n        Returns:\n            tuple: (U in eV, P_th in GPa), rounded to 6 decimal places.\n        \"\"\"\n        # Use a small tolerance for floating point comparison with zero\n        is_zero_temp = T_K  1e-9\n\n        # Convert inputs to SI units\n        V_m3 = V_A3 * A3_TO_M3\n        omegas_rad_s = freqs_thz * THZ_TO_RAD_S\n\n        # --- Calculate total internal energy U(V,T) ---\n        # U = U_zpe + U_thermal\n        zpe_per_mode_j = 0.5 * HBAR * omegas_rad_s\n        total_zpe_j = np.sum(zpe_per_mode_j)\n\n        if is_zero_temp:\n            total_thermal_energy_j = 0.0\n        else:\n            exp_arg = (HBAR * omegas_rad_s) / (KB * T_K)\n            # Use np.expm1 for better numerical stability when exp_arg is small\n            # Use np.divide with a 'where' clause to handle potential division by zero\n            # if any exp_arg were to become zero (not the case here, but good practice).\n            thermal_energy_per_mode_j = np.divide(\n                HBAR * omegas_rad_s, np.expm1(exp_arg),\n                out=np.zeros_like(omegas_rad_s),\n                where=(np.expm1(exp_arg) != 0)\n            )\n            total_thermal_energy_j = np.sum(thermal_energy_per_mode_j)\n        \n        total_energy_j = total_zpe_j + total_thermal_energy_j\n        total_energy_ev = total_energy_j / EV_TO_J\n\n        # --- Calculate thermal pressure P_th(V,T) ---\n        # P_th = (1/V) * sum(gamma_i * U_thermal_i)\n        if is_zero_temp:\n            thermal_pressure_gpa = 0.0\n        else:\n            exp_arg = (HBAR * omegas_rad_s) / (KB * T_K)\n            thermal_energy_per_mode_j = np.divide(\n                HBAR * omegas_rad_s, np.expm1(exp_arg),\n                out=np.zeros_like(omegas_rad_s),\n                where=(np.expm1(exp_arg) != 0)\n            )\n            pressure_sum_j = np.sum(gammas * thermal_energy_per_mode_j)\n            thermal_pressure_pa = pressure_sum_j / V_m3\n            thermal_pressure_gpa = thermal_pressure_pa / 1e9\n\n        return round(total_energy_ev, 6), round(thermal_pressure_gpa, 6)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (15.75, 0.0),    # Case 1\n        (15.75, 300.0),  # Case 2\n        (16.50, 1000.0), # Case 3\n        (15.00, 10.0),   # Case 4\n    ]\n\n    # Pre-calculate the volume-independent Gruneisen parameters\n    gammas = calculate_gruneisen_parameters(V1, V3, FREQS[V1], FREQS[V3])\n    \n    results = []\n    for V_case, T_case in test_cases:\n        # Select the appropriate frequency set for the volume\n        freqs_case = FREQS[V_case]\n        # Calculate properties for the test case\n        u_val, p_val = calculate_properties(V_case, T_case, freqs_case, gammas)\n        results.append(u_val)\n        results.append(p_val)\n        \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}