{
    "hands_on_practices": [
        {
            "introduction": "单粒子箱中粒子模型是理解量子限制的基础，但真实系统通常包含多个粒子。这个练习将探讨当一个一维无限深势阱中同时包含 $N$ 个费米子和 $N$ 个玻色子时，系统的基态能量是如何决定的。通过这个实践，你将具体看到泡利不相容原理和玻色子基态占据如何从根本上影响多粒子系统的总能量。",
            "id": "356992",
            "problem": "考虑一个限制在长度为 $L$ 的一维无限深势阱中的量子系统。其势能为 $V(x) = 0$（当 $0 < x < L$ 时）及 $V(x) = \\infty$（其他情况）。该系统包含 $N$ 个无相互作用的自旋1/2费米子和 $N$ 个无相互作用的自旋0玻色子。为简便起见，假设所有粒子（包括费米子和玻色子）都具有相同的质量 $m$，并且 $N$ 是一个偶数。\n\n推导该组合系统的总基态动能 $K_{total}$ 的闭合形式表达式。用 $N$、$m$、$L$ 和约化普朗克常数 $\\hbar$ 来表示你的答案。",
            "solution": "一维无限深势阱中的单粒子能量为\n$$E_n = \\frac{\\hbar^2\\pi^2 n^2}{2mL^2}.$$  \n\n所有 $N$ 个自旋0玻色子都占据 $n=1$ 能级，因此\n$$K_{\\rm b} = N\\,E_1 = N\\frac{\\hbar^2\\pi^2}{2mL^2}.$$  \n\n$N$ 个自旋$\\tfrac12$费米子填充能级 $n=1,\\dots,M$，其中 $M=N/2$，每个能级有两个自旋：\n$$K_{\\rm f} = \\sum_{n=1}^{M}2E_n \n= \\frac{\\hbar^2\\pi^2}{mL^2}\\sum_{n=1}^{M}n^2\n= \\frac{\\hbar^2\\pi^2}{mL^2}\\frac{M(M+1)(2M+1)}{6}.$$  \n\n代入 $M=N/2$，\n$$\\sum_{n=1}^{N/2}n^2=\\frac{1}{6}\\frac{N}{2}\\Bigl(\\frac{N}{2}+1\\Bigr)(N+1)\n=\\frac{N(N+2)(N+1)}{24},$$  \n所以\n$$K_{\\rm f} = \\frac{\\hbar^2\\pi^2}{mL^2}\\frac{N(N+2)(N+1)}{24}.$$  \n\n因此，总基态动能为\n$$\nK_{\\rm total}\n=K_{\\rm f}+K_{\\rm b}\n=\\frac{\\hbar^2\\pi^2}{mL^2}\\frac{N(N^2+3N+14)}{24}.\n$$",
            "answer": "$$\\boxed{\\frac{\\hbar^2\\pi^2\\,N\\,(N^2+3N+14)}{24\\,m\\,L^2}}$$"
        },
        {
            "introduction": "量子系统如何响应其边界条件的瞬时改变？本练习探讨了一个经典场景：当一维无限深势阱的宽度突然加倍时，处于基态的粒子会发生什么。通过应用突变近似，你将计算粒子跃迁到新势阱的某个激发态的概率，这需要将旧系统的波函数投影到新系统的本征态上，从而深入理解量子态在哈密顿量突变时的演化规则。",
            "id": "356867",
            "problem": "一个质量为 $m$ 的粒子初始处于宽度为 $L$ 的一维无限深势阱的基态。该势由 $V(x) = 0$（当 $0 < x < L$ 时）和 $V(x) = \\infty$（其他情况）描述。该势的归一化能量本征态由 $\\psi_n(x) = \\sqrt{\\frac{2}{L}}\\sin\\left(\\frac{n\\pi x}{L}\\right)$ 给出，其中 $n=1, 2, 3, \\ldots$。\n\n在时间 $t=0$ 时，势阱的右壁从 $x=L$ 瞬时移动到 $x=2L$，从而改变了势。新势为 $V'(x) = 0$（当 $0 < x < 2L$ 时）和 $V'(x) = \\infty$（其他情况）。这个新的、更宽势阱的归一化能量本征态为 $\\phi_{n'}(x) = \\sqrt{\\frac{2}{2L}}\\sin\\left(\\frac{n'\\pi x}{2L}\\right)$，其中 $n' = 1, 2, 3, \\ldots$。\n\n根据突变近似，粒子在势阱扩张后的瞬时波函数与其扩张前的状态相同。该状态可以表示为更宽势阱的新能量本征态的叠加。推导出在新势阱的第二激发态（$n'=3$）中找到粒子的概率表达式。",
            "solution": "我们分别有在 $[0,L]$ 和 $[0,2L]$ 上的初始和最终本征态：\n$$\\psi_1(x)=\\sqrt{\\frac{2}{L}}\\sin\\!\\Bigl(\\frac{\\pi x}{L}\\Bigr),\\qquad\n\\phi_{n'}(x)=\\sqrt{\\frac{2}{2L}}\\sin\\!\\Bigl(\\frac{n'\\pi x}{2L}\\Bigr)=\\frac{1}{\\sqrt{L}}\\sin\\!\\Bigl(\\frac{n'\\pi x}{2L}\\Bigr).$$\n根据突变近似，展开系数为\n$$c_{n'}=\\int_0^{2L}\\phi_{n'}(x)\\,\\psi_1(x)\\,dx\n=\\frac{\\sqrt{2}}{L}\\int_0^L\\sin\\!\\Bigl(\\frac{n'\\pi x}{2L}\\Bigr)\\sin\\!\\Bigl(\\frac{\\pi x}{L}\\Bigr)\\,dx.$$\n使用恒等式\n$$\\int_0^L\\sin(Ax)\\sin(Bx)\\,dx\n=\\frac{1}{2}\\Bigl[\\frac{\\sin((A-B)L)}{A-B}-\\frac{\\sin((A+B)L)}{A+B}\\Bigr],$$\n令 $A=\\frac{n'\\pi}{2L},\\;B=\\frac{\\pi}{L}$，对于 $n'=3$ 我们有\n$$A-B=\\frac{\\pi}{2L},\\quad A+B=\\frac{5\\pi}{2L},\\quad\n\\sin\\bigl((A-B)L\\bigr)=\\sin\\!\\Bigl(\\frac{\\pi}{2}\\Bigr)=1,\\quad\n\\sin\\bigl((A+B)L\\bigr)=\\sin\\!\\Bigl(\\frac{5\\pi}{2}\\Bigr)=1.$$\n因此\n$$\\int_0^L\\sin\\!\\Bigl(\\frac{3\\pi x}{2L}\\Bigr)\\sin\\!\\Bigl(\\frac{\\pi x}{L}\\Bigr)\\,dx\n=\\frac{1}{2}\\Bigl[\\frac{1}{\\frac{\\pi}{2L}}-\\frac{1}{\\frac{5\\pi}{2L}}\\Bigr]\n=\\frac{4L}{5\\pi}$$\n且\n$$c_3=\\frac{\\sqrt{2}}{L}\\,\\frac{4L}{5\\pi}=\\frac{4\\sqrt2}{5\\pi}.$$\n在 $n'=3$ 中找到粒子的概率为\n$$P_{3}=|c_3|^2=\\frac{32}{25\\pi^2}.$$",
            "answer": "$$\\boxed{\\frac{32}{25\\pi^2}}$$"
        },
        {
            "introduction": "虽然箱中粒子模型存在精确的解析解，但大多数量子化学问题都必须依赖数值方法求解。本练习将指导你通过编程，应用有限差分法将定态薛定谔方程离散化，从而数值计算一维势阱的本征能量。通过分析数值解相对于网格尺寸的收敛速度，你将亲身体验计算化学中的一个核心概念，并深刻理解理论模型与计算模拟之间的联系。",
            "id": "2960274",
            "problem": "实现一个程序，该程序通过离散化不含时 Schrödinger 方程来模拟区间 $[0,L]$ 上的一维无限深势阱（也称为箱中粒子）。离散化方法为：使用二阶中心有限差分近似二阶导数，并采用位于 $x=0$ 和 $x=L$ 的 Dirichlet 边界条件。从第一性原理出发，始于不含时 Schrödinger 方程和无限深势阱的定义。构建离散的哈密顿算符，为一系列网格间距计算其特征值，并将计算得到的能级 $E_n$ 与从底层微分方程推导出的精确连续解进行比较。定量分析离散化误差作为网格间距的函数，并估算收敛率指数。\n\n要求：\n- 物理模型：\n  - 质量为 $m$ 的粒子在 $[0,L]$ 上的无限深势阱中的不含时 Schrödinger 方程应作为基本出发点。边界条件为 $\\psi(0)=0$ 和 $\\psi(L)=0$。\n  - 用于参考的连续能级 $E_n$ 必须通过从第一性原理求解此边界值问题得到，而不是在你的推理中调用任何未经证明的捷径公式。一旦在你的推导中建立了该解析表达式，你的程序便可以使用它。\n- 离散化：\n  - 使用一个包含 $M$ 个内部点的均匀网格，网格间距为 $h=L/(M+1)$。\n  - 在内部点上应用标准的二阶中心有限差分近似来处理二阶导数，并通过从未知向量中省略边界节点来隐式地施加 Dirichlet 边界条件。\n  - 构建与内部节点上的动能算符相对应的离散哈密顿矩阵 $H$。\n- 数值计算：\n  - 对于每组指定的参数，计算离散哈密顿矩阵 $H$ 的第 $n$ 个特征值（按升序排列），作为第 $n$ 个离散能级 $E_n^{(h)}$。\n  - 计算绝对误差 $|E_n^{(h)}-E_n|$，其中 $E_n$ 是对应相同 $n$、 $L$ 和 $m$ 的精确连续能量。\n  - 对于每个测试用例，通过改变 $M$ 来在一系列值上改变网格间距 $h$，并通过对 $\\log |E_n^{(h)}-E_n|$ 与 $\\log h$ 进行最小二乘拟合，来估算经验关系式 $|E_n^{(h)}-E_n|\\approx C\\,h^p$ 中的指数 $p$。报告拟合得到的斜率 $p$。\n- 单位：\n  - 所有计算必须使用国际单位制（SI）。$L$ 的单位为米，$m$ 的单位为千克，能量的单位为焦耳。\n  - 使用约化 Planck 常量值 $\\hbar = 1.054571817\\times 10^{-34}\\ \\mathrm{J\\cdot s}$ 和电子质量 $m_e=9.1093837015\\times 10^{-31}\\ \\mathrm{kg}$。\n  - 当测试套件中 $L$ 以纳米为单位指定时，使用 $1\\ \\mathrm{nm}=1.0\\times 10^{-9}\\ \\mathrm{m}$ 进行转换。\n- 输出：\n  - 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，例如 $[r_1,r_2,r_3]$，其中每个 $r_i$ 是测试用例 $i$ 的拟合斜率 $p$，并四舍五入到三位小数。\n\n测试套件：\n- 使用以下用例，每个用例指定为一个元组 $\\left(L_{\\mathrm{nm}}, n, [M_1,M_2,M_3,M_4]\\right)$，其中 $L_{\\mathrm{nm}}$ 的单位是纳米，在计算中必须转换为米：\n  - 用例1: $\\left(1.0,\\,1,\\,[20,\\,40,\\,80,\\,160]\\right)$。\n  - 用例2: $\\left(0.5,\\,5,\\,[50,\\,100,\\,200,\\,400]\\right)$。\n  - 用例3: $\\left(2.0,\\,1,\\,[3,\\,6,\\,12,\\,24]\\right)$。\n- 对于所有用例，使用 $m=m_e$。\n- 最终输出格式：\n  - 单行输出包含三个拟合斜率的列表 $[r_1,r_2,r_3]$，每个斜率四舍五入到三位小数，无任何额外文本。",
            "solution": "问题陈述经评估后被确定为有效。它提出了一个计算量子力学中标准的、适定的问题，该问题在科学上是合理的、自洽的、客观的，并且没有矛盾或含糊之处。因此，我将进行完整的推导和求解。\n\n任务是数值求解一维无限深势阱中粒子的不含时 Schrödinger 方程，分析离散化误差，并确定数值方法的经验收敛阶。\n\n**1. 连续问题的解析解**\n\n第一性原理是质量为 $m$ 的粒子在势 $V(x)$ 中的不含时 Schrödinger 方程：\n$$\n\\hat{H}\\psi(x) = \\left[-\\frac{\\hbar^2}{2m}\\frac{d^2}{dx^2} + V(x)\\right]\\psi(x) = E\\psi(x)\n$$\n对于长度为 $L$ 的无限深势阱，势 $V(x)$ 在定义域 $[0, L]$ 上定义为：\n$$\nV(x) = \\begin{cases} 0 & \\text{if } 0 < x < L \\\\ \\infty & \\text{otherwise} \\end{cases}\n$$\n边界上的无限大势能意味着粒子不能存在于区间 $(0, L)$ 之外。因此，波函数 $\\psi(x)$ 的连续性要求施加 Dirichlet 边界条件：\n$$\n\\psi(0) = 0 \\quad \\text{and} \\quad \\psi(L) = 0\n$$\n在势阱内部，其中 $V(x)=0$，Schrödinger 方程简化为：\n$$\n-\\frac{\\hbar^2}{2m}\\frac{d^2\\psi(x)}{dx^2} = E\\psi(x)\n$$\n此方程可重排为经典简谐振子方程的形式：\n$$\n\\frac{d^2\\psi(x)}{dx^2} + k^2\\psi(x) = 0, \\quad \\text{where } k = \\frac{\\sqrt{2mE}}{\\hbar}\n$$\n这个二阶常微分方程的通解是：\n$$\n\\psi(x) = A\\sin(kx) + B\\cos(kx)\n$$\n应用第一个边界条件 $\\psi(0) = 0$：\n$$\n\\psi(0) = A\\sin(0) + B\\cos(0) = B = 0\n$$\n因此，解必须具有 $\\psi(x) = A\\sin(kx)$ 的形式。应用第二个边界条件 $\\psi(L) = 0$：\n$$\n\\psi(L) = A\\sin(kL) = 0\n$$\n一个非平凡解要求 $A \\neq 0$，这意味着 $\\sin(kL)$ 必须为零。当 $kL$ 是 $\\pi$ 的整数倍时，此条件得到满足：\n$$\nkL = n\\pi, \\quad \\text{for } n = 1, 2, 3, \\ldots\n$$\n量子数 $n$ 必须是正整数，因为 $n=0$ 会导致 $k=0$ 和一个平凡波函数 $\\psi(x)=0$。这就量子化了波数 $k_n = \\frac{n\\pi}{L}$。将此代入 $k$ 的定义中：\n$$\n\\left(\\frac{n\\pi}{L}\\right)^2 = \\frac{2mE_n}{\\hbar^2}\n$$\n求解能量 $E_n$ 可得一维无限深势阱中粒子的精确量子化能级：\n$$\nE_n = \\frac{n^2\\pi^2\\hbar^2}{2mL^2}\n$$\n$E_n$ 的这个解析表达式将作为精确参考，用于与数值结果进行比较。\n\n**2. Schrödinger 方程的离散化**\n\n为数值求解此问题，我们将空间域 $[0, L]$ 离散化为一个均匀网格。我们定义 $M$ 个内部点，从而总点数为 $M+2$。网格间距为 $h = \\frac{L}{M+1}$，网格点为 $x_i = i \\cdot h$，其中 $i=0, 1, \\dots, M+1$。在这些离散点上的波函数记为 $\\psi_i = \\psi(x_i)$。边界条件明确为 $\\psi_0=0$ 和 $\\psi_{M+1}=0$。\n\n二阶导数算符 $\\frac{d^2}{dx^2}$ 在每个内部点 $x_i$ 处使用二阶中心有限差分格式进行近似：\n$$\n\\left.\\frac{d^2\\psi}{dx^2}\\right|_{x=x_i} \\approx \\frac{\\psi(x_i+h) - 2\\psi(x_i) + \\psi(x_i-h)}{h^2} = \\frac{\\psi_{i+1} - 2\\psi_i + \\psi_{i-1}}{h^2}\n$$\n将此近似代入内部点 $i$ （其中 $i=1, \\dots, M$）的 Schrödinger 方程中：\n$$\n-\\frac{\\hbar^2}{2m} \\left( \\frac{\\psi_{i-1} - 2\\psi_i + \\psi_{i+1}}{h^2} \\right) = E^{(h)}\\psi_i\n$$\n这里，$E^{(h)}$ 表示能量特征值的数值近似，它依赖于网格间距 $h$。重排此表达式，我们得到：\n$$\n\\left(-\\frac{\\hbar^2}{2mh^2}\\right)\\psi_{i-1} + \\left(\\frac{\\hbar^2}{mh^2}\\right)\\psi_i + \\left(-\\frac{\\hbar^2}{2mh^2}\\right)\\psi_{i+1} = E^{(h)}\\psi_i\n$$\n这代表了一个关于未知值 $\\psi_1, \\dots, \\psi_M$ 的 $M$ 个耦合线性方程组。\n\n**3. 离散哈密顿矩阵**\n\n由离散化得到的方程组可以表示为一个矩阵特征值问题 $\\mathbf{H}\\vec{\\psi} = E^{(h)}\\vec{\\psi}$。向量 $\\vec{\\psi}$ 是 $(\\psi_1, \\psi_2, \\dots, \\psi_M)^T$，而 $\\mathbf{H}$ 是哈密顿算符的 $M \\times M$ 矩阵表示，称为离散哈密顿量。\n\n我们定义动能比例因子 $T = \\frac{\\hbar^2}{2mh^2}$。每个节点 $i$ 的方程变为：\n$$\n-T\\psi_{i-1} + 2T\\psi_i - T\\psi_{i+1} = E^{(h)}\\psi_i\n$$\n使用边界条件 $\\psi_0 = 0$ 和 $\\psi_{M+1}=0$，对于 $i=1, \\dots, M$ 的方程组产生一个对称三对角矩阵 $\\mathbf{H}$：\n$$\n\\mathbf{H} = \\begin{pmatrix}\n2T & -T & 0 & \\cdots & 0 \\\\\n-T & 2T & -T & \\cdots & 0 \\\\\n0 & -T & 2T & \\ddots & \\vdots \\\\\n\\vdots & \\vdots & \\ddots & \\ddots & -T \\\\\n0 & 0 & \\cdots & -T & 2T\n\\end{pmatrix}\n$$\n该矩阵 $\\mathbf{H}$ 的特征值对应于离散能级 $E_n^{(h)}$。第 $n$ 个特征值（按升序排序）是第 $n$ 个能级 $E_n$ 的数值近似。\n\n**4. 收敛性分析**\n\n中心差分格式的截断误差为 $O(h^2)$ 阶。对于如此的自伴随特征值问题，预测其特征值的误差也表现出相同的收敛阶。因此，我们期望数值能量与精确能量之间的绝对误差随网格间距 $h$ 的变化关系为：\n$$\n|E_n^{(h)} - E_n| \\approx C h^p\n$$\n其中 $p$ 是收敛率指数，我们期望其值为 $2$。为了通过经验方法找到 $p$，我们对误差方程取自然对数：\n$$\n\\ln\\left(|E_n^{(h)} - E_n|\\right) \\approx \\ln(C) + p \\ln(h)\n$$\n这揭示了 $\\ln(\\text{误差})$ 与 $\\ln(h)$ 之间的线性关系。通过计算一系列减小的网格间距 $h$（对应于增大的 $M$）的误差，并对 $(\\ln(h), \\ln(\\text{误差}))$ 数据进行线性最小二乘拟合，所得直线的斜率即为 $p$ 的估计值。此过程在提供的代码中实现，以满足问题要求。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 1D particle-in-a-box problem numerically and analyzes convergence.\n    \"\"\"\n    # Define physical constants in SI units\n    HBAR = 1.054571817e-34  # Reduced Planck constant in J*s\n    M_E = 9.1093837015e-31   # Electron mass in kg\n    NM_TO_M = 1.0e-9         # Nanometer to meter conversion factor\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (L_nm, n, [M_1, M_2, M_3, M_4])\n    test_cases = [\n        (1.0, 1, [20, 40, 80, 160]),\n        (0.5, 5, [50, 100, 200, 400]),\n        (2.0, 1, [3, 6, 12, 24]),\n    ]\n\n    results = []\n    \n    # Process each test case\n    for case in test_cases:\n        L_nm, n, M_list = case\n        \n        # Set parameters for the current case\n        L = L_nm * NM_TO_M  # Convert box length to meters\n        m = M_E             # Set mass to electron mass\n\n        # Calculate the exact analytical energy for level n\n        E_n_exact = (n**2 * np.pi**2 * HBAR**2) / (2 * m * L**2)\n\n        log_h_vals = []\n        log_error_vals = []\n\n        # Iterate over the specified numbers of interior grid points (M)\n        for M in M_list:\n            # Calculate grid spacing h\n            h = L / (M + 1)\n\n            # Construct the discrete Hamiltonian matrix H\n            # T is the kinetic energy scaling factor: hbar^2 / (2*m*h^2)\n            T = HBAR**2 / (2 * m * h**2)\n            \n            # The matrix H has 2T on the main diagonal and -T on the adjacent diagonals\n            main_diag = np.full(M, 2 * T)\n            off_diag = np.full(M - 1, -T)\n            H = np.diag(main_diag) + np.diag(off_diag, k=1) + np.diag(off_diag, k=-1)\n\n            # Compute eigenvalues of the symmetric matrix H.\n            # np.linalg.eigh is efficient and returns sorted eigenvalues.\n            eigenvalues = np.linalg.eigh(H)[0]\n            \n            # The numerical energy E_n is the n-th eigenvalue (0-indexed)\n            E_n_h = eigenvalues[n - 1]\n\n            # Calculate the absolute error and store its logarithm\n            error = np.abs(E_n_h - E_n_exact)\n            log_error_vals.append(np.log(error))\n            \n            # Store the logarithm of the grid spacing\n            log_h_vals.append(np.log(h))\n\n        # Perform a linear least-squares fit on the log-log data.\n        # log(error) = p * log(h) + log(C)\n        # np.polyfit with degree 1 returns the slope (p) and intercept (log(C)).\n        p, _ = np.polyfit(log_h_vals, log_error_vals, 1)\n        results.append(p)\n\n    # Format the results to three decimal places as required.\n    rounded_results = [round(r, 3) for r in results]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, rounded_results))}]\")\n\nsolve()\n```"
        }
    ]
}