{"hands_on_practices": [{"introduction": "这个练习将带你深入研究 Ornstein-Uhlenbeck 过程，这是描述受限于谐波势阱中（如光镊中的胶体颗粒）的布朗粒子运动的一个基本模型。通过直接求解朗之万方程，你将从第一性原理出发，推导出体系的动态属性——自中间散射函数。这项练习不仅能加深你对涨落-耗散定理的理解，还能锻炼你处理随机微分方程和计算时间相关函数的核心技能 [@problem_id:2907882]。", "problem": "一个流体动力学阻尼系数为 $\\gamma$ 的胶体微球，在温度为 $T$、势为 $U(x) = \\tfrac{1}{2} k x^{2}$ 的一维谐振光阱中进行过阻尼布朗运动。其过阻尼郎之万方程为\n$$\n\\gamma \\,\\frac{dx(t)}{dt} = - k\\, x(t) + \\sqrt{2 \\gamma k_{B} T}\\,\\eta(t),\n$$\n其中 $k_{B}$ 是玻尔兹曼常数，$\\eta(t)$ 是高斯白噪声，其均值为零，时间相关性为 $\\langle \\eta(t) \\eta(t') \\rangle = \\delta(t-t')$，这与涨落耗散定理 (FDT) 一致。假设系统在 $t=0$ 时处于稳态平衡系综中。\n\n请仅使用上述郎之万方程、噪声的高斯性质以及平衡统计力学中的定义，从第一性原理推导出精确的平衡自中间散射函数（也称为单粒子动态结构因子），\n$$\nF(q,t) \\equiv \\left\\langle \\exp\\!\\big( i q [x(t) - x(0)] \\big) \\right\\rangle_{\\mathrm{eq}},\n$$\n其中 $q$ 为任意实波数，$t \\ge 0$ 为时间。\n\n你的推导必须从运动方程和噪声统计特性出发，不得预先假设任何关于奥恩斯坦-乌伦贝克过程的闭合形式结果。请将你的最终答案表示为关于 $q$、$k$、$\\gamma$、$k_{B}$、$T$ 和 $t$ 的单一闭合形式解析表达式。最终的方框答案中不要包含单位。", "solution": "问题陈述经过验证。\n\n逐字提取的已知条件如下：\n- 一个流体动力学阻尼系数为 $\\gamma$ 的胶体微球。\n- 在一维谐振光阱中的过阻尼布朗运动。\n- 势：$U(x) = \\tfrac{1}{2} k x^{2}$。\n- 温度：$T$。\n- 郎之万方程：$\\gamma \\,\\frac{dx(t)}{dt} = - k\\, x(t) + \\sqrt{2 \\gamma k_{B} T}\\,\\eta(t)$。\n- 玻尔兹曼常数：$k_{B}$。\n- 噪声特性：$\\eta(t)$ 是高斯白噪声，其均值为 $\\langle \\eta(t) \\rangle = 0$，时间相关性为 $\\langle \\eta(t) \\eta(t') \\rangle = \\delta(t-t')$。\n- 初始条件：系统在 $t=0$ 时处于稳态平衡系综中。\n- 待推导量：平衡自中间散射函数 $F(q,t) \\equiv \\left\\langle \\exp\\!\\big( i q [x(t) - x(0)] \\big) \\right\\rangle_{\\mathrm{eq}}$。\n- 约束条件：推导必须从运动方程和噪声统计特性出发，不得预先假设任何关于奥恩斯坦-乌伦贝克过程的闭合形式结果。最终答案必须是关于 $q$、$k$、$\\gamma$、$k_{B}$、$T$ 和 $t$ 的单一闭合形式解析表达式。\n\n验证结论：\n该问题具有科学依据，提法明确且客观。它描述了奥恩斯坦-乌伦贝克过程，这是统计物理学中的一个典范模型。郎之万方程、噪声特性以及待计算的量都是标准且明确定义的。所有必要信息均已提供，没有矛盾或含糊之处。该问题是统计力学中一个非平凡但标准的推导，与指定主题直接相关。因此，该问题被认定为 **有效**。\n\n推导过程如下。\n\n待计算的量是自中间散射函数，定义为\n$$\nF(q,t) = \\left\\langle \\exp\\!\\big( i q [x(t) - x(0)] \\big) \\right\\rangle_{\\mathrm{eq}}\n$$\n其中平均 $\\langle \\dots \\rangle_{\\mathrm{eq}}$ 是对稳态平衡系综进行的平均。我们感兴趣的变量是位移 $\\Delta x(t) = x(t) - x(0)$。\n\n给定的郎之万方程是一个线性随机微分方程。噪声项 $\\eta(t)$ 是一个高斯过程。由于位移 $\\Delta x(t)$ 是初始位置 $x(0)$ 和噪声历史的线性泛函，并且系统处于谐振势中的热平衡状态（这意味着 $x(0)$ 本身遵循高斯分布），因此对于任意固定的 $t$，变量 $\\Delta x(t)$ 是一个高斯随机变量。\n\n对于一个高斯随机变量 $Y$，其特征函数由一个著名的恒等式给出：\n$$\n\\langle \\exp(i q Y) \\rangle = \\exp\\left(i q \\langle Y \\rangle - \\frac{1}{2} q^2 \\left\\langle (Y - \\langle Y \\rangle)^2 \\right\\rangle \\right)\n$$\n在我们的情况中，$Y = \\Delta x(t) = x(t) - x(0)$。我们必须首先计算它在平衡系综中的均值和方差。\n\n平均位移为 $\\langle \\Delta x(t) \\rangle_{\\mathrm{eq}} = \\langle x(t) - x(0) \\rangle_{\\mathrm{eq}} = \\langle x(t) \\rangle_{\\mathrm{eq}} - \\langle x(0) \\rangle_{\\mathrm{eq}}$。\n在稳态平衡系综中，统计性质不随时间变化。平均位置由势 $U(x) = \\frac{1}{2} k x^2$ 决定。由于势是关于 $x=0$ 对称的，平衡概率分布 $P_{\\mathrm{eq}}(x) \\propto \\exp(-U(x)/k_B T)$ 也是对称的。因此，平均位置为零：$\\langle x \\rangle_{\\mathrm{eq}} = 0$。\n在稳态下，这对所有时间都成立，所以 $\\langle x(t) \\rangle_{\\mathrm{eq}} = \\langle x(0) \\rangle_{\\mathrm{eq}} = 0$。\n因此，平均位移为零：\n$$\n\\langle \\Delta x(t) \\rangle_{\\mathrm{eq}} = 0\n$$\n于是，$F(q,t)$ 的表达式简化为：\n$$\nF(q,t) = \\exp\\left( -\\frac{1}{2} q^2 \\left\\langle (\\Delta x(t))^2 \\right\\rangle_{\\mathrm{eq}} \\right)\n$$\n问题简化为计算平衡状态下的均方位移 (MSD)，即 $\\langle (\\Delta x(t))^2 \\rangle_{\\mathrm{eq}}$。\n\nMSD 可以展开为：\n$$\n\\langle (\\Delta x(t))^2 \\rangle_{\\mathrm{eq}} = \\langle (x(t)-x(0))^2 \\rangle_{\\mathrm{eq}} = \\langle x(t)^2 \\rangle_{\\mathrm{eq}} - 2 \\langle x(t) x(0) \\rangle_{\\mathrm{eq}} + \\langle x(0)^2 \\rangle_{\\mathrm{eq}}\n$$\n由于稳态性，均方位置不随时间变化：$\\langle x(t)^2 \\rangle_{\\mathrm{eq}} = \\langle x(0)^2 \\rangle_{\\mathrm{eq}}$。这个值是位置的平衡方差。根据二次自由度的能量均分定理，$\\langle U(x) \\rangle_{\\mathrm{eq}} = \\langle \\frac{1}{2} k x^2 \\rangle_{\\mathrm{eq}} = \\frac{1}{2} k_B T$。这给出：\n$$\n\\langle x^2 \\rangle_{\\mathrm{eq}} = \\frac{k_B T}{k}\n$$\n所以，MSD 变为：\n$$\n\\langle (\\Delta x(t))^2 \\rangle_{\\mathrm{eq}} = 2 \\langle x(0)^2 \\rangle_{\\mathrm{eq}} - 2 \\langle x(t) x(0) \\rangle_{\\mathrm{eq}} = 2 \\frac{k_B T}{k} - 2 \\langle x(t) x(0) \\rangle_{\\mathrm{eq}}\n$$\n为了求时间相关函数 $\\langle x(t) x(0) \\rangle_{\\mathrm{eq}}$，我们必须求解郎之万方程。\n该方程为 $\\gamma \\frac{dx}{dt} = -k x + F_{\\mathrm{rand}}(t)$，其中 $F_{\\mathrm{rand}}(t) = \\sqrt{2 \\gamma k_B T} \\eta(t)$。\n重写该方程：\n$$\n\\frac{dx}{dt} + \\frac{k}{\\gamma} x(t) = \\sqrt{\\frac{2 k_B T}{\\gamma}} \\eta(t)\n$$\n这是一个关于 $x(t)$ 的一阶线性常微分方程。我们定义弛豫时间 $\\tau_R = \\gamma/k$。该方程可用积分因子 $e^{t/\\tau_R}$ 求解：\n$$\n\\frac{d}{dt} \\left( x(t) e^{t/\\tau_R} \\right) = e^{t/\\tau_R} \\sqrt{\\frac{2 k_B T}{\\gamma}} \\eta(t)\n$$\n从 $t'=0$ 到 $t'=t$ 积分，给出给定 $t=0$ 时值为 $x(0)$ 的 $x(t)$ 的形式解：\n$$\nx(t) e^{t/\\tau_R} - x(0) e^{0} = \\sqrt{\\frac{2 k_B T}{\\gamma}} \\int_0^t e^{t'/\\tau_R} \\eta(t') dt'\n$$\n$$\nx(t) = x(0) e^{-t/\\tau_R} + \\sqrt{\\frac{2 k_B T}{\\gamma}} \\int_0^t e^{-(t-t')/\\tau_R} \\eta(t') dt'\n$$\n现在，我们通过乘以 $x(0)$ 并取平衡平均来计算时间相关函数：\n$$\n\\langle x(t) x(0) \\rangle_{\\mathrm{eq}} = \\left\\langle x(0)^2 e^{-t/\\tau_R} \\right\\rangle_{\\mathrm{eq}} + \\sqrt{\\frac{2 k_B T}{\\gamma}} \\int_0^t e^{-(t-t')/\\tau_R} \\langle x(0) \\eta(t') \\rangle_{\\mathrm{eq}} dt'\n$$\n关键步骤是计算 $t' > 0$ 时的 $\\langle x(0) \\eta(t') \\rangle_{\\mathrm{eq}}$。粒子在 $t=0$ 时的位置 $x(0)$ 是由 $t=0$ 之前所有时间的随机力历史决定的。根据白噪声的定义，在未来某个时间 $t' > 0$ 的噪声 $\\eta(t')$ 与其过去的值不相关。因此，$x(0)$ 与所有 $t' > 0$ 的 $\\eta(t')$ 统计独立。这个原理被称为因果性。\n$$\n\\langle x(0) \\eta(t') \\rangle_{\\mathrm{eq}} = \\langle x(0) \\rangle_{\\mathrm{eq}} \\langle \\eta(t') \\rangle = 0 \\times 0 = 0\n$$\n$\\langle x(t) x(0) \\rangle_{\\mathrm{eq}}$ 表达式中的第二项消失为零。我们剩下：\n$$\n\\langle x(t) x(0) \\rangle_{\\mathrm{eq}} = \\langle x(0)^2 \\rangle_{\\mathrm{eq}} e^{-t/\\tau_R} = \\frac{k_B T}{k} e^{-t/\\tau_R}\n$$\n将此结果代回到 MSD 的表达式中：\n$$\n\\langle (\\Delta x(t))^2 \\rangle_{\\mathrm{eq}} = 2 \\frac{k_B T}{k} - 2 \\left( \\frac{k_B T}{k} e^{-t/\\tau_R} \\right) = 2 \\frac{k_B T}{k} \\left( 1 - e^{-t/\\tau_R} \\right)\n$$\n现在，我们可以组合出 $F(q,t)$ 的最终表达式：\n$$\nF(q,t) = \\exp\\left( -\\frac{1}{2} q^2 \\left[ 2 \\frac{k_B T}{k} \\left( 1 - e^{-t/\\tau_R} \\right) \\right] \\right)\n$$\n$$\nF(q,t) = \\exp\\left( - q^2 \\frac{k_B T}{k} \\left( 1 - e^{-t/\\tau_R} \\right) \\right)\n$$\n最后，将弛豫时间 $\\tau_R = \\gamma/k$ 的定义代回表达式，得到以给定参数表示的最终答案：\n$$\nF(q,t) = \\exp\\left( - \\frac{q^2 k_B T}{k} \\left( 1 - e^{-kt/\\gamma} \\right) \\right)\n$$\n此推导从第一性原理出发，仅使用了郎之万方程和噪声的统计特性，符合要求。", "answer": "$$\n\\boxed{\\exp\\left(-\\frac{q^{2} k_{B} T}{k} \\left(1 - \\exp\\left(-\\frac{kt}{\\gamma}\\right)\\right)\\right)}\n$$", "id": "2907882"}, {"introduction": "下一个练习将微观的随机运动与宏观的化学反应速率联系起来，这是一个经典但至关重要的问题。我们将考虑一个溶质分子如何通过扩散到达一个球形反应微粒的表面并发生反应。通过求解稳态扩散方程并应用耦合了扩散与反应的边界条件，你将能够推导出整体的捕获速率常数，并深刻理解“扩散限制”反应的概念，这在化学、生物学和材料科学中都至关重要 [@problem_id:2907870]。", "problem": "一种稀释的分子溶质在含有半径为 $a$ 的孤立球形微凝胶颗粒的牛顿流体溶剂中进行布朗运动。溶质数浓度场为 $c(\\mathbf{r},t)$，分子扩散系数为 $D$。在远离颗粒处，通过一个充分搅拌的体系将溶质浓度维持在一个恒定值 $c_{\\infty}$。半径 $r=a$ 处的颗粒表面具有反应性：溶质分子到达界面时，会发生一级界面反应，其内禀表面速率常数为 $k_{s}$（单位为长度/时间），因此界面反应速率密度与表面的局部浓度成正比。\n\n假设孤立颗粒周围处于稳态，对流可忽略不计，且具有球形对称性。从质量守恒和菲克定律出发，在球坐标系中建立稳态扩散问题，并利用在 $r=a$ 处法向扩散通量与线性表面反应动力学相平衡的条件，导出适当的边界条件。求解稳态浓度分布 $c(r)$，并计算单个颗粒的总吸收速率 $R$（单位时间内的数量）。通过 $R = k_{\\mathrm{eff}}\\,c_{\\infty}$ 定义总捕获速率常数 $k_{\\mathrm{eff}}$，并将 $k_{\\mathrm{eff}}$ 表示为 $D$、$a$ 和 $k_{s}$ 的闭式解析函数。\n\n提供 $k_{\\mathrm{eff}}$ 的精确解析表达式作为最终结果。如果进行数值计算，以国际单位制（SI）报告 $k_{\\mathrm{eff}}$，单位为 $\\mathrm{m^{3}\\,s^{-1}}$。最终的方框答案中不要包含单位。无需四舍五入。", "solution": "所述问题是物理化学中一个标准的、适定的问题，涉及球形边界上的扩散控制反应。其科学基础是菲克扩散定律和一级反应动力学。问题提供了推导唯一解所需的所有参数和条件。该问题是有效的。\n\n该物理过程受溶质分子守恒控制。在没有对流的情况下，连续性方程为 $\\frac{\\partial c}{\\partial t} + \\nabla \\cdot \\mathbf{J} = 0$，其中 $c(\\mathbf{r},t)$ 是溶质浓度，$\\mathbf{J}$ 是扩散通量。在稳态下，$\\frac{\\partial c}{\\partial t} = 0$，这使连续性方程简化为 $\\nabla \\cdot \\mathbf{J} = 0$。\n\n根据菲克第一定律，扩散通量与浓度梯度成正比：$\\mathbf{J} = -D \\nabla c$，其中 $D$ 是扩散系数。将菲克定律代入稳态连续性方程，得到稳态扩散方程，即浓度场的拉普拉斯方程：\n$$ -D \\nabla^2 c(\\mathbf{r}) = 0 \\implies \\nabla^2 c(\\mathbf{r}) = 0 $$\n鉴于问题的球形对称性，浓度 $c$ 仅取决于距颗粒中心的径向距离 $r$，$c=c(r)$。在球坐标系中，作用于仅与 $r$ 相关的函数的拉普拉斯算子为 $\\nabla^2 c(r) = \\frac{1}{r^2} \\frac{d}{dr}\\left(r^2 \\frac{dc}{dr}\\right)$。因此，控制方程变为：\n$$ \\frac{1}{r^2} \\frac{d}{dr}\\left(r^2 \\frac{dc}{dr}\\right) = 0 $$\n对于 $r \\geq a$。两边乘以 $r^2$ 并对 $r$ 积分一次，得到：\n$$ r^2 \\frac{dc}{dr} = C_1 $$\n其中 $C_1$ 是一个积分常数。重新整理并进行第二次积分，得到浓度分布的通解：\n$$ \\frac{dc}{dr} = \\frac{C_1}{r^2} \\implies c(r) = -\\frac{C_1}{r} + C_2 $$\n其中 $C_2$ 是第二个积分常数。\n\n常数 $C_1$ 和 $C_2$ 由边界条件确定。\n第一个边界条件指定在远离颗粒处，该处浓度维持在一个恒定的体相值 $c_{\\infty}$：\n$$ c(r) \\to c_{\\infty} \\quad \\text{as} \\quad r \\to \\infty $$\n将此条件应用于通解：\n$$ c_{\\infty} = -\\frac{C_1}{\\infty} + C_2 \\implies C_2 = c_{\\infty} $$\n因此，浓度分布为 $c(r) = c_{\\infty} - \\frac{C_1}{r}$。\n\n第二个边界条件位于反应性颗粒的表面 $r=a$。在这里，溶质分子通过扩散到达的速率必须等于它们通过表面反应被消耗的速率。向内的径向扩散通量密度（单位面积单位时间内的分子数）由 $-J_r = -(-D \\frac{dc}{dr}) = D\\frac{dc}{dr}$ 给出。一级反应的单位面积消耗速率为 $k_s c(r=a)$。令这两个速率相等，可得边界条件：\n$$ D \\left(\\frac{dc}{dr}\\right)_{r=a} = k_s c(a) $$\n这是一个 Robin 型边界条件。我们现在必须应用它来求解 $C_1$。\n首先，我们求出浓度分布的导数：$\\frac{dc}{dr} = \\frac{C_1}{r^2}$。\n然后，我们计算边界条件中在 $r=a$ 处的各项：\n$$ \\left(\\frac{dc}{dr}\\right)_{r=a} = \\frac{C_1}{a^2} $$\n$$ c(a) = c_{\\infty} - \\frac{C_1}{a} $$\n将这些代入边界条件方程：\n$$ D \\left(\\frac{C_1}{a^2}\\right) = k_s \\left(c_{\\infty} - \\frac{C_1}{a}\\right) $$\n我们求解这个代数方程以得到 $C_1$：\n$$ \\frac{D C_1}{a^2} = k_s c_{\\infty} - \\frac{k_s C_1}{a} $$\n$$ C_1 \\left(\\frac{D}{a^2} + \\frac{k_s}{a}\\right) = k_s c_{\\infty} $$\n$$ C_1 \\left(\\frac{D + a k_s}{a^2}\\right) = k_s c_{\\infty} $$\n$$ C_1 = \\frac{k_s c_{\\infty} a^2}{D + a k_s} $$\n确定了 $C_1$ 后，稳态浓度分布 $c(r)$ 就完全确定了：\n$$ c(r) = c_{\\infty} - \\frac{1}{r} \\left( \\frac{k_s c_{\\infty} a^2}{D + a k_s} \\right) = c_{\\infty} \\left( 1 - \\frac{a}{r} \\frac{k_s a}{D + a k_s} \\right) $$\n\n总吸收速率 $R$ 是单位时间内在颗粒表面反应的溶质分子总数。这可以通过将向内通量密度在整个球体表面积 $A = 4\\pi a^2$ 上积分得到：\n$$ R = A \\times \\left. \\left( D \\frac{dc}{dr} \\right) \\right|_{r=a} = 4\\pi a^2 D \\left( \\frac{C_1}{a^2} \\right) = 4\\pi D C_1 $$\n代入 $C_1$ 的表达式：\n$$ R = 4\\pi D \\left( \\frac{k_s c_{\\infty} a^2}{D + a k_s} \\right) = \\frac{4 \\pi D k_s a^2}{D + a k_s} c_{\\infty} $$\n问题通过关系式 $R = k_{\\mathrm{eff}} c_{\\infty}$ 定义了总捕获速率常数 $k_{\\mathrm{eff}}$。通过与我们推导出的 $R$ 的表达式直接比较，我们确定 $k_{\\mathrm{eff}}$：\n$$ k_{\\mathrm{eff}} = \\frac{4 \\pi D k_s a^2}{D + a k_s} $$\n该表达式代表有效速率常数，它正确地结合了溶剂中的扩散和表面反应的贡献。当 $k_s \\to \\infty$（无限快反应）时，它正确地恢复到扩散限制的结果 $k_{\\mathrm{eff}} \\to 4\\pi D a$；当 $D \\to \\infty$（无限快输运）时，它正确地恢复到反应限制的结果 $k_{\\mathrm{eff}} \\to 4\\pi a^2 k_s$。该结果在量纲上是一致的，单位为体积/时间（$L^3/T$）。", "answer": "$$ \\boxed{\\frac{4 \\pi D k_s a^2}{D + a k_s}} $$", "id": "2907870"}, {"introduction": "最后一个练习融合了理论推导与计算实践，引导你探索一个更高级的概念：布朗桥。布朗桥描述的是一个起点和终点位置都被固定的扩散过程，这对于分析实验轨迹或模拟受限高分子链至关重要。你将首先推导布朗桥的统计特性（均值和协方差），然后应用这些结果来编写程序，计算给定观测路径的概率密度，从而将抽象的理论与具体的数据分析联系起来 [@problem_id:2907892]。", "problem": "考虑一个高分子示踪剂在粘性溶剂中的一维过阻尼朗之万动力学，其由一个无漂移的随机微分方程（SDE）建模：$\\mathrm{d}X(t) = \\sqrt{2 D}\\,\\mathrm{d}W(t)$，其中 $X(t)$ 是位置（单位：微米），$D$ 是扩散系数（单位：$\\mu \\mathrm{m}^2/\\mathrm{s}$），$t$ 是时间（单位：$\\mathrm{s}$），$W(t)$ 是一个标准 Wiener 过程。假设 $X(0)=x_0$，并且在之后的某个固定时间 $T$，示踪剂被约束在 $X(T)=x_T$ 的位置。在这些端点约束下的过程 $X(t)$ 被称为布朗桥，代表了端点钉扎意义下的受限扩散。\n\n仅从布朗运动的基本性质出发，即对于无约束运动，其增量是独立的、高斯分布的、平稳的，且方差为 $\\mathbb{V}[X(t+\\Delta t)-X(t)] = 2 D\\,\\Delta t$，并且有限个点 $\\{X(t_i)\\}_{i=1}^n$ 的联合分布是多元正态分布，完全由其均值向量和协方差矩阵确定。请推导对于 $t,s \\in (0,T)$ 的条件均值函数 $m(t) = \\mathbb{E}[X(t)\\mid X(0)=x_0, X(T)=x_T]$ 和条件协方差函数 $C(s,t) = \\mathrm{Cov}(X(s),X(t)\\mid X(0)=x_0, X(T)=x_T)$。\n\n然后，对于一组有限的中间时刻 $\\{t_i\\}_{i=1}^n \\subset (0,T)$ 和相应的观测位置 $\\{x_i\\}_{i=1}^n$（单位：$\\mu \\mathrm{m}$），在布朗桥模型下，请使用推导出的均值向量 $\\mathbf{m} = (m(t_1),\\dots,m(t_n))^\\top$ 和元素为 $\\Sigma_{ij} = C(t_i,t_j)$ 的协方差矩阵 $\\Sigma$ 来表达向量 $\\mathbf{x} = (x_1,\\dots,x_n)^\\top$ 的联合概率密度函数（PDF）的自然对数 $\\ln p(\\mathbf{x}\\mid x_0,x_T,D,T)$。您的推导应依赖于多元正态分布的标准线性代数条件化方法，并必须明确展示受约束的协方差与无约束布朗运动的协方差有何不同。\n\n实现一个程序，对于下方的每个测试用例，仅使用推导出的表达式计算 $\\ln p(\\mathbf{x}\\mid x_0,x_T,D,T)$ 的值。所有长度必须以 $\\mu \\mathrm{m}$ 为单位处理，所有时间以 $\\mathrm{s}$ 为单位，扩散系数以 $\\mu \\mathrm{m}^2/\\mathrm{s}$ 为单位。概率密度的对数是无量纲的，因此您必须返回无量纲的数字。为确保格式确定，将每个结果四舍五入到 $6$ 位小数。\n\n测试套件：\n- 案例 A（一般行为）：$D = 1.0$ $\\mu \\mathrm{m}^2/\\mathrm{s}$，$T = 2.0$ $\\mathrm{s}$，$x_0 = 0.0$ $\\mu \\mathrm{m}$，$x_T = 1.0$ $\\mu \\mathrm{m}$，时间 $\\{0.5, 1.0, 1.5\\}$ $\\mathrm{s}$，观测值 $\\{0.2, 0.6, 0.9\\}$ $\\mu \\mathrm{m}$。\n- 案例 B（接近边界的时间和对称的端点）：$D = 0.2$ $\\mu \\mathrm{m}^2/\\mathrm{s}$，$T = 1.0$ $\\mathrm{s}$，$x_0 = 0.0$ $\\mu \\mathrm{m}$，$x_T = 0.0$ $\\mu \\mathrm{m}$，时间 $\\{0.1, 0.9\\}$ $\\mathrm{s}$，观测值 $\\{0.05, -0.03\\}$ $\\mu \\mathrm{m}$。\n- 案例 C（更大的跨度和不对称的端点）：$D = 0.8$ $\\mu \\mathrm{m}^2/\\mathrm{s}$，$T = 3.0$ $\\mathrm{s}$，$x_0 = -0.5$ $\\mu \\mathrm{m}$，$x_T = 0.5$ $\\mu \\mathrm{m}$，时间 $\\{0.3, 1.7, 2.9\\}$ $\\mathrm{s}$，观测值 $\\{-0.4, -0.1, 0.45\\}$ $\\mu \\mathrm{m}$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含三个结果，按 A、B、C 的顺序以逗号分隔，并用方括号括起来，每个结果四舍五入到 $6$ 位小数（例如，$\\left[\\text{value}_A,\\text{value}_B,\\text{value}_C\\right]$）。", "solution": "该问题要求推导布朗桥的条件均值和协方差函数，并随后推导在该模型下一组观测值的对数概率密度。布朗桥是一个描述进行布朗运动的粒子的随机过程 $X(t)$，其条件为在时间 $t=0$ 时从指定位置 $x_0$ 开始，并在时间 $t=T$ 时结束于另一指定位置 $x_T$。\n\n首先，我们来确定从 $X_u(0) = x_0$ 开始的无约束一维布朗运动的性质，我们将其记为 $X_u(t)$。该过程由随机微分方程 $\\mathrm{d}X_u(t) = \\sqrt{2D}\\,\\mathrm{d}W(t)$ 控制，其中 $W(t)$ 是一个标准 Wiener 过程。由于没有漂移项，期望位置是恒定的：\n$$\n\\mathbb{E}[X_u(t)] = x_0\n$$\n问题陈述了增量是平稳和高斯分布的，其方差为 $\\mathbb{V}[X_u(t+\\Delta t)-X_u(t)] = 2D\\Delta t$。从 $x_0$ 开始的过程的协方差函数 $\\mathrm{Cov}(X_u(s), X_u(t))$ 与从 $0$ 开始的过程相同。对于 $s \\le t$，我们可以写出 $X_u(t) - x_0 = (X_u(s) - x_0) + (X_u(t) - X_u(s))$。那么协方差为：\n$$\n\\mathrm{Cov}(X_u(s), X_u(t)) = \\mathbb{E}[(X_u(s)-x_0)(X_u(t)-x_0)] = \\mathbb{E}[(X_u(s)-x_0)^2] + \\mathbb{E}[(X_u(s)-x_0)(X_u(t)-X_u(s))]\n$$\n由于 Wiener 过程的增量是独立的，交叉项的期望为零。因此，协方差等于较早时间点的方差：\n$$\n\\mathrm{Cov}(X_u(s), X_u(t)) = \\mathbb{V}[X_u(s)] = \\mathbb{V}[X_u(s)-X_u(0)] = 2Ds\n$$\n对于任意 $s,t \\ge 0$ 进行推广，无约束布朗运动的协方差函数为：\n$$\n\\mathrm{Cov}(X_u(s), X_u(t)) = 2D\\min(s,t)\n$$\n一组有限的随机变量 $\\{X_u(t_i)\\}_{i=1}^n$ 的联合分布服从一个多元正态分布。其均值向量的所有分量都等于 $x_0$，其协方差矩阵的元素为 $[\\Sigma_u]_{ij} = 2D\\min(t_i, t_j)$。\n\n现在我们通过应用多元正态分布的条件化法则来推导条件过程，即布朗桥 $X(t)$ 的性质。如果一个随机向量 $\\mathbf{Z}$ 被划分为 $\\mathbf{Z} = (\\mathbf{Z}_1, \\mathbf{Z}_2)^\\top$ 并服从正态分布 $\\mathcal{N}(\\boldsymbol{\\mu}, \\Sigma)$，其中 $\\boldsymbol{\\mu} = (\\boldsymbol{\\mu}_1, \\boldsymbol{\\mu}_2)^\\top$ 且 $\\Sigma = \\begin{pmatrix} \\Sigma_{11}  \\Sigma_{12} \\\\ \\Sigma_{21}  \\Sigma_{22} \\end{pmatrix}$，那么在给定 $\\mathbf{Z}_2=\\mathbf{z}_2$ 的条件下，$\\mathbf{Z}_1$ 的条件分布也为正态分布，其条件均值为 $\\boldsymbol{\\mu}_{1|2} = \\boldsymbol{\\mu}_1 + \\Sigma_{12}\\Sigma_{22}^{-1}(\\mathbf{z}_2 - \\boldsymbol{\\mu}_2)$，条件协方差为 $\\Sigma_{1|2} = \\Sigma_{11} - \\Sigma_{12}\\Sigma_{22}^{-1}\\Sigma_{21}$。\n\n为了求出 $t \\in (0,T)$ 时的条件均值 $m(t) = \\mathbb{E}[X(t)\\mid X(0)=x_0, X(T)=x_T]$，我们考虑无约束过程在时间 $t$ 和 $T$ 的联合分布。令 $\\mathbf{Z}_1 = X_u(t)$ 和 $\\mathbf{Z}_2 = X_u(T)$。其联合分布为正态分布，参数为：\n$$\n\\boldsymbol{\\mu} = \\begin{pmatrix} x_0 \\\\ x_0 \\end{pmatrix}, \\quad \\Sigma = \\begin{pmatrix} 2Dt  2Dt \\\\ 2Dt  2DT \\end{pmatrix}\n$$\n我们对事件 $X_u(T) = x_T$ 进行条件化。应用条件均值公式：\n$$\nm(t) = \\mathbb{E}[X_u(t) | X_u(T) = x_T] = x_0 + (2Dt)(2DT)^{-1}(x_T - x_0) = x_0 + \\frac{t}{T}(x_T - x_0)\n$$\n这可以简化为起点和终点之间的线性插值：\n$$\nm(t) = x_0\\left(1-\\frac{t}{T}\\right) + x_T\\frac{t}{T}\n$$\n为了求出条件协方差函数 $C(s,t) = \\mathrm{Cov}(X(s), X(t)\\mid X(0)=x_0, X(T)=x_T)$，我们考虑在 $X_u(T)=x_T$ 条件下 $(X_u(s), X_u(t))^\\top$ 的联合分布。设 $0  s \\le t  T$。我们设置 $\\mathbf{Z}_1 = (X_u(s), X_u(t))^\\top$ 和 $\\mathbf{Z}_2=X_u(T)$。$(X_u(s), X_u(t), X_u(T))^\\top$ 的联合分布参数为：\n$$\n\\boldsymbol{\\mu} = \\begin{pmatrix} x_0 \\\\ x_0 \\\\ x_0 \\end{pmatrix}, \\quad \\Sigma = \\begin{pmatrix} 2Ds  2Ds  2Ds \\\\ 2Ds  2Dt  2Dt \\\\ 2Ds  2Dt  2DT \\end{pmatrix}\n$$\n条件化公式所需的子矩阵为：\n$$\n\\Sigma_{11} = \\begin{pmatrix} 2Ds  2Ds \\\\ 2Ds  2Dt \\end{pmatrix}, \\quad \\Sigma_{12} = \\begin{pmatrix} 2Ds \\\\ 2Dt \\end{pmatrix}, \\quad \\Sigma_{22} = 2DT\n$$\n条件协方差矩阵 $\\Sigma_{1|2}$ 为：\n$$\n\\Sigma_{1|2} = \\Sigma_{11} - \\Sigma_{12}\\Sigma_{22}^{-1}\\Sigma_{21} = \\begin{pmatrix} 2Ds  2Ds \\\\ 2Ds  2Dt \\end{pmatrix} - \\frac{1}{2DT} \\begin{pmatrix} 2Ds \\\\ 2Dt \\end{pmatrix} \\begin{pmatrix} 2Ds  2Dt \\end{pmatrix}\n$$\n$$\n\\Sigma_{1|2} = \\begin{pmatrix} 2Ds  2Ds \\\\ 2Ds  2Dt \\end{pmatrix} - \\frac{2D}{T} \\begin{pmatrix} s^2  st \\\\ st  t^2 \\end{pmatrix} = \\begin{pmatrix} 2Ds - \\frac{2Ds^2}{T}  2Ds - \\frac{2Dst}{T} \\\\ 2Ds - \\frac{2Dst}{T}  2Dt - \\frac{2Dt^2}{T} \\end{pmatrix}\n$$\n因此，对于 $s \\le t$，条件协方差是该矩阵的 (1,2) 项：$C(s,t) = 2Ds(1-t/T)$。将其与对称情况 $t \\le s$ 结合，我们可以写出一个单一的表达式：\n$$\nC(s,t) = 2D\\left(\\min(s,t) - \\frac{st}{T}\\right)\n$$\n这个表达式显示了与无约束情况 $2D\\min(s,t)$ 相比，端点约束如何减少了协方差，减少量与乘积 $st$ 成正比。对角线元素给出了条件方差，$C(t,t) = \\mathbb{V}[X(t) | \\text{endpoints}] = 2Dt(1-t/T)$，根据要求，它在 $t=0$ 和 $t=T$ 时为零。\n\n最后，我们表达在中间时刻 $\\mathbf{t} = (t_1,\\dots,t_n)^\\top$ 的观测向量 $\\mathbf{x} = (x_1,\\dots,x_n)^\\top$ 的对数概率密度 $\\ln p(\\mathbf{x}|\\dots)$。在布朗桥模型下，随机向量 $(X(t_1), \\dots, X(t_n))^\\top$ 服从多元正态分布，其均值向量为 $\\mathbf{m}$，协方差矩阵为 $\\Sigma$，其中：\n$$\nm_i = m(t_i) = x_0\\left(1-\\frac{t_i}{T}\\right) + x_T\\frac{t_i}{T}\n$$\n$$\n\\Sigma_{ij} = C(t_i, t_j) = 2D\\left(\\min(t_i,t_j) - \\frac{t_i t_j}{T}\\right)\n$$\n对于一个 $n$ 维正态随机变量 $\\mathbf{Z} \\sim \\mathcal{N}(\\mathbf{m}, \\Sigma)$，其概率密度函数为：\n$$\np(\\mathbf{x}; \\mathbf{m}, \\Sigma) = \\frac{1}{(2\\pi)^{n/2} \\det(\\Sigma)^{1/2}} \\exp\\left(-\\frac{1}{2}(\\mathbf{x}-\\mathbf{m})^\\top \\Sigma^{-1} (\\mathbf{x}-\\mathbf{m})\\right)\n$$\n取自然对数，我们得到所需的表达式：\n$$\n\\ln p(\\mathbf{x}\\mid x_0,x_T,D,T) = -\\frac{n}{2}\\ln(2\\pi) - \\frac{1}{2}\\ln(\\det(\\Sigma)) - \\frac{1}{2}(\\mathbf{x}-\\mathbf{m})^\\top \\Sigma^{-1} (\\mathbf{x}-\\mathbf{m})\n$$\n这个表达式将被实现用于解决测试用例。二次型项 $(\\mathbf{x}-\\mathbf{m})^\\top \\Sigma^{-1} (\\mathbf{x}-\\mathbf{m})$ 可以通过首先求解线性系统 $\\Sigma\\mathbf{v} = (\\mathbf{x}-\\mathbf{m})$ 得到 $\\mathbf{v}$，然后计算点积 $(\\mathbf{x}-\\mathbf{m}) \\cdot \\mathbf{v}$ 来高效地计算。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the log-probability density of observations under a Brownian bridge model.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A\n        {\n            \"D\": 1.0,\n            \"T\": 2.0,\n            \"x0\": 0.0,\n            \"xT\": 1.0,\n            \"times\": [0.5, 1.0, 1.5],\n            \"observations\": [0.2, 0.6, 0.9],\n        },\n        # Case B\n        {\n            \"D\": 0.2,\n            \"T\": 1.0,\n            \"x0\": 0.0,\n            \"xT\": 0.0,\n            \"times\": [0.1, 0.9],\n            \"observations\": [0.05, -0.03],\n        },\n        # Case C\n        {\n            \"D\": 0.8,\n            \"T\": 3.0,\n            \"x0\": -0.5,\n            \"xT\": 0.5,\n            \"times\": [0.3, 1.7, 2.9],\n            \"observations\": [-0.4, -0.1, 0.45],\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        D = case[\"D\"]\n        T = case[\"T\"]\n        x0 = case[\"x0\"]\n        xT = case[\"xT\"]\n        t = np.array(case[\"times\"])\n        x = np.array(case[\"observations\"])\n        n = len(t)\n\n        # 1. Calculate the mean vector m\n        # m(t_i) = x0 * (1 - t_i/T) + xT * t_i/T\n        m = x0 * (1 - t / T) + xT * (t / T)\n\n        # 2. Calculate the covariance matrix Sigma\n        # Sigma_ij = 2*D * (min(t_i, t_j) - t_i*t_j/T)\n        # Using broadcasting for efficient matrix construction\n        t_i_mat = np.tile(t, (n, 1))\n        t_j_mat = t_i_mat.T\n        min_t_mat = np.minimum(t_i_mat, t_j_mat)\n        Sigma = 2 * D * (min_t_mat - (t_i_mat * t_j_mat) / T)\n\n        # 3. Calculate the log-probability density\n        # ln p = -n/2*ln(2*pi) - 1/2*ln(det(Sigma)) - 1/2*(x-m)^T * Sigma^-1 * (x-m)\n        \n        # Deviation vector\n        y = x - m\n        \n        # Log determinant of Sigma\n        sign, log_det_Sigma = np.linalg.slogdet(Sigma)\n        if sign = 0:\n            # Covariance matrix must be positive definite, so determinant must be positive.\n            # This case is not expected with valid parameters.\n            # Set log_p to a very low number or handle as an error.\n            # For this problem, we assume sign will be +1.\n            pass\n\n        # Quadratic term: y^T * Sigma^-1 * y\n        # Solved via linear system to avoid explicit inverse, which is more stable.\n        # Solve Sigma * v = y for v\n        v = np.linalg.solve(Sigma, y)\n        # Compute quadratic term as y^T * v\n        quad_term = np.dot(y, v)\n\n        # Final log probability\n        log_p = -0.5 * n * np.log(2 * np.pi) - 0.5 * log_det_Sigma - 0.5 * quad_term\n        \n        results.append(round(log_p, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2907892"}]}