{"hands_on_practices": [{"introduction": "在处理具有乘性噪声的系统时，随机微分方程（SDE）的数学形式本身存在模糊性，因为噪声项的积分方式会影响结果。本练习将引导你从黎曼和的定义出发，深入探讨两种最主要的随机积分约定——伊东（Itô）积分和斯特拉托诺维奇（Stratonovich）积分。通过推导它们之间的转换关系，你将亲手揭示在从斯特拉托诺维奇表述转换到伊东表述时出现的所谓“伪漂移”项的来源，从而对随机过程的数学基础建立更深刻的理解 [@problem_id:2815958]。", "problem": "在许多化学动力学的粗粒化描述中，一维反应坐标 $x(t)$ 在一个过阻尼朗之万方程下演化，该方程包含由位置依赖的迁移率产生的乘性噪声。考虑描述 $x(t)$ 的斯特拉토诺维奇（Stratonovich）随机微分方程（SDE）：\n$$\ndx = a(x)\\,dt + b(x)\\circ dW_t,\n$$\n其中 $W_t$ 是一个标准维纳过程，$a(x)$ 和 $b(x)$ 是充分光滑的函数。在不预先假设任何已知转换公式的情况下，从斯特拉托诺维奇（Stratonovich）和伊藤（Itô）随机积分的黎曼和定义以及维纳增量的均方性质出发，推导控制同一物理过程的等效伊藤（Itô）随机微分方程。然后，明确指出从斯特拉托诺维奇诠释转换到伊藤诠释时出现的附加漂移项（在理论化学和统计物理中通常称为伪漂移）。\n\n请用一个包含 $a(x)$、$b(x)$ 及其空间导数的单闭式解析表达式给出此附加漂移项的最终答案。最终方框内的表达式不应包含任何单位。", "solution": "所述问题是有效的。这是一个适定且有科学依据的问题，对于理论化学和物理学中随机过程的研究至关重要。它要求从第一性原理进行推导，这是理解伊藤（Itô）和斯特拉托诺维奇（Stratonovich）微积分之间区别的标准且必要的练习。我们现在开始推导。\n\n给定斯特拉托诺维奇（Stratonovich）随机微分方程（SDE）：\n$$\ndx = a(x)\\,dt + b(x)\\circ dW_t\n$$\n其中 $x(t)$ 是状态变量，$a(x)$ 是漂移系数，$b(x)$ 是扩散系数（代表位置依赖的迁移率），$dW_t$ 是标准维纳过程的增量。我们的目标是通过分析斯特拉托诺维奇积分的定义来找到等效的伊藤（Itô）随机微分方程。\n\n该SDE的积分形式为：\n$$\nx(t) - x(t_0) = \\int_{t_0}^{t} a(x(s)) \\, ds + \\int_{t_0}^{t} b(x(s)) \\circ dW_s\n$$\n问题的核心在于对随机积分的诠释。我们将时间区间 $[t_0, t]$ 离散化为 $N$ 个宽度为 $\\Delta t$ 的子区间，其中 $t_k = t_0 + k\\Delta t$。斯特拉托诺维奇积分定义为一个和的极限，其中被积函数在每个时间步 $[t_k, t_{k+1}]$ 的中点处取值：\n$$\n\\int_{t_0}^{t} b(x(s)) \\circ dW_s = \\lim_{N \\to \\infty} \\sum_{k=0}^{N-1} b\\left(x\\left(\\frac{t_k + t_{k+1}}{2}\\right)\\right) [W(t_{k+1}) - W(t_k)]\n$$\n对于足够小的步长，我们可以用过程在端点的平均值 $\\frac{x(t_k) + x(t_{k+1})}{2}$ 来近似中点取值点 $x\\left(\\frac{t_k + t_{k+1}}{2}\\right)$。我们记 $x_k = x(t_k)$ 以及维纳增量 $\\Delta W_k = W(t_{k+1}) - W(t_k)$。那么近似斯特拉托诺维奇积分的离散和（我们记为 $I_S$）为：\n$$\nI_S \\approx \\sum_{k=0}^{N-1} b\\left(\\frac{x_{k+1} + x_k}{2}\\right) \\Delta W_k\n$$\n为了将其与在区间起点 $t_k$ 处对被积函数求值的伊藤积分联系起来，我们必须将项 $b\\left(\\frac{x_{k+1} + x_k}{2}\\right)$ 在点 $x_k$ 附近展开。首先，我们使用SDE自身的一个离散步来近似 $x_{k+1}$：\n$$\nx_{k+1} \\approx x_k + a(x_k)\\Delta t + b(x_k)\\Delta W_k\n$$\n使用此近似，$b$ 的自变量变为：\n$$\n\\frac{x_{k+1} + x_k}{2} \\approx \\frac{(x_k + a(x_k)\\Delta t + b(x_k)\\Delta W_k) + x_k}{2} = x_k + \\frac{1}{2}a(x_k)\\Delta t + \\frac{1}{2}b(x_k)\\Delta W_k\n$$\n由于假设 $b(x)$ 是一个光滑函数，我们在 $x_k$ 附近对 $b$ 进行泰勒展开。令 $b'(x) = \\frac{db}{dx}$。\n$$\nb\\left(\\frac{x_{k+1} + x_k}{2}\\right) \\approx b\\left(x_k + \\frac{1}{2}a(x_k)\\Delta t + \\frac{1}{2}b(x_k)\\Delta W_k\\right)\n$$\n$$\nb\\left(\\frac{x_{k+1} + x_k}{2}\\right) \\approx b(x_k) + b'(x_k) \\left( \\frac{1}{2}a(x_k)\\Delta t + \\frac{1}{2}b(x_k)\\Delta W_k \\right) + \\mathcal{O}((\\Delta t)^2, (\\Delta W_k)^2)\n$$\n我们将此展开式代回到 $I_S$ 的求和中：\n$$\nI_S \\approx \\sum_{k=0}^{N-1} \\left[ b(x_k) + \\frac{1}{2}b'(x_k)b(x_k)\\Delta W_k + \\frac{1}{2}b'(x_k)a(x_k)\\Delta t \\right] \\Delta W_k\n$$\n分配 $\\Delta W_k$ 项可得：\n$$\nI_S \\approx \\sum_{k=0}^{N-1} b(x_k)\\Delta W_k + \\sum_{k=0}^{N-1} \\frac{1}{2} b(x_k) b'(x_k) (\\Delta W_k)^2 + \\sum_{k=0}^{N-1} \\frac{1}{2} a(x_k) b'(x_k) \\Delta t \\Delta W_k\n$$\n现在我们取极限 $\\Delta t \\to 0$。这三个和的表现如下：\n1.  第一个和 $\\sum_{k=0}^{N-1} b(x_k)\\Delta W_k$ 正是伊藤积分的定义，其中被积函数在左端点 $t_k$ 处求值。\n    $$\n    \\lim_{\\Delta t \\to 0} \\sum_{k=0}^{N-1} b(x_k)\\Delta W_k = \\int_{t_0}^{t} b(x(s)) dW_s \\quad (\\text{Itô})\n    $$\n2.  第二个和涉及维纳过程的二次变分。增量 $\\Delta W_k$ 是独立的随机变量，其均值为 $\\mathbb{E}[\\Delta W_k] = 0$，方差为 $\\mathbb{E}[(\\Delta W_k)^2] = \\Delta t$。在均方意义上，和 $\\sum (\\Delta W_k)^2$ 收敛于 $t - t_0$。因此，在连续极限下，$(\\Delta W_k)^2$ 变为 $dt$。\n    $$\n    \\lim_{\\Delta t \\to 0} \\sum_{k=0}^{N-1} \\frac{1}{2} b(x_k) b'(x_k) (\\Delta W_k)^2 = \\int_{t_0}^{t} \\frac{1}{2} b(x(s)) b'(x(s)) ds\n    $$\n3.  第三个和涉及项 $\\Delta t \\Delta W_k$，其随机阶为 $(\\Delta t)^{3/2}$。当 $\\Delta t \\to 0$ 时，该项比其他项更快地消失。\n    $$\n    \\lim_{\\Delta t \\to 0} \\sum_{k=0}^{N-1} \\frac{1}{2} a(x_k) b'(x_k) \\Delta t \\Delta W_k = 0\n    $$\n结合这些结果，斯特拉托诺维奇积分可以用一个伊藤积分和一个标准黎曼积分来表示：\n$$\n\\int_{t_0}^{t} b(x(s)) \\circ dW_s = \\int_{t_0}^{t} b(x(s)) dW_s + \\int_{t_0}^{t} \\frac{1}{2} b(x(s)) b'(x(s)) ds\n$$\n用微分形式表示，此关系为：\n$$\nb(x) \\circ dW_t = b(x) dW_t + \\frac{1}{2} b(x) b'(x) dt\n$$\n将此关系代回原始的斯特拉托诺维奇SDE中：\n$$\ndx = a(x) dt + \\left( b(x) dW_t + \\frac{1}{2} b(x) b'(x) dt \\right)\n$$\n我们将与 $dt$ 成正比的项组合在一起，得到最终的伊藤形式：\n$$\ndx = \\left( a(x) + \\frac{1}{2} b(x) b'(x) \\right) dt + b(x) dW_t\n$$\n这就是等效的伊藤SDE。原始漂移项是 $a(x)$。在伊藤表示法中，新的有效漂移项是 $a(x) + \\frac{1}{2} b(x) b'(x)$。附加漂移项，也称为噪声诱导漂移或伪漂移，是从使用标准微积分法则的斯特拉托诺维奇诠释转换为伊藤诠释时所需的修正。该项是伊藤漂移与斯特拉托诺维奇漂移之间的差值：\n$$\na_{\\text{additional}}(x) = \\left( a(x) + \\frac{1}{2}b(x)b'(x) \\right) - a(x) = \\frac{1}{2}b(x)b'(x)\n$$\n该项的出现是因为斯特拉托诺维奇积分在一个无穷小时间步长内隐式地考虑了过程 $x(t)$ 与噪声增量 $dW_t$ 之间的相关性，而伊藤积分根据其前向点定义忽略了这种相关性。附加漂移项明确地恢复了这一物理信息。", "answer": "$$\n\\boxed{\\frac{1}{2} b(x) b'(x)}\n$$", "id": "2815958"}, {"introduction": "从抽象的数学形式主义转向具体的物理应用，谐振子中的布朗粒子（即Ornstein-Uhlenbeck过程）是统计物理学中的一个基石模型。它不仅描述了聚合物链节或光学陷阱中纳米颗粒的行为，也为理解更复杂的弛豫现象提供了理论基础。在本练习中，你将求解该系统的郎之万方程，计算位置和速度的时间自相关函数与互相关函数，这项实践将帮助你掌握如何从微观的运动方程出发，预测可通过实验测量的宏观动态性质，如系统的弛豫速率 [@problem_id:2815972]。", "problem": "考虑一个质量为 $m$ 的单个布朗粒子，在一维空间中的谐波势 $U(x)=\\tfrac{1}{2} k x^{2}$ 中运动，并与绝对温度为 $T$ 的热浴接触。设溶剂施加一个系数为 $\\gamma$ 的线性斯托克斯摩擦力，以及一个满足涨落-耗散定理的随机力。仅从牛顿第二定律和随机力的涨落-耗散定理出发，写出位置 $x(t)$ 和速度 $v(t)$ 的随机运动方程，以及对应于双分量状态 $(x,v)^{\\mathsf{T}}$ 的线性漂移算符。然后，使用朗之万和福克-普朗克方程的框架，推导稳态时间相关的协方差矩阵\n$$\nC(t) \\equiv \\begin{pmatrix}\n\\langle x(t)\\,x(0)\\rangle  \\langle x(t)\\,v(0)\\rangle \\\\\n\\langle v(t)\\,x(0)\\rangle  \\langle v(t)\\,v(0)\\rangle\n\\end{pmatrix},\n$$\n对于 $t \\ge 0$ 和平衡初始条件。提供所有四个矩阵元关于 $m$、$\\gamma$、 $k$、 $k_{B}$、 $T$ 和 $t$ 的显式表达式，并讨论其函数形式在欠阻尼和过阻尼区域如何变化。最后，提取出在两种区域中主导相关函数指数弛豫的两个弛豫率，仅用 $m$、$\\gamma$ 和 $k$ 表示。使用 LaTeX 的 $\\texttt{pmatrix}$ 环境将这两个弛豫率报告为单个行矩阵。不需要进行数值计算，所有常数应保持符号形式。最终答案必须仅为这对弛豫率，形式为单个闭合解析表达式，不带单位。", "solution": "所述问题在科学上是合理的、适定的、客观的和自洽的。这是一个统计物理学中的标准问题，涉及奥恩斯坦-乌伦贝克过程，该过程模拟了一个谐振子束缚的布朗粒子。所有必需的参数和条件都已提供，不存在不一致或模糊之处。因此，该问题是有效的，并将提供解答。\n\n粒子的运动由牛顿第二定律支配，其中包括谐波势、线性摩擦力和来自热浴的随机力。运动方程是朗之万方程：\n$$\nm \\frac{d^2x}{dt^2} = -k x - \\gamma \\frac{dx}{dt} + R(t)\n$$\n其中 $m$ 是质量，$k$ 是谐波势 $U(x) = \\frac{1}{2} k x^2$ 的弹簧常数，$\\gamma$ 是摩擦系数，$R(t)$ 是随机力。\n\n系统的状态由双分量向量 $\\mathbf{z}(t) = (x(t), v(t))^{\\mathsf{T}}$ 描述，其中 $v(t) = dx/dt$ 是速度。这个二阶随机微分方程可以写成一个一阶方程组：\n$$\n\\frac{dx}{dt} = v\n$$\n$$\n\\frac{dv}{dt} = -\\frac{k}{m} x - \\frac{\\gamma}{m} v + \\frac{1}{m} R(t)\n$$\n该方程组可以用矩阵形式表示为一个多元奥恩斯坦-乌伦贝克过程：\n$$\n\\frac{d\\mathbf{z}}{dt} = A\\mathbf{z} + \\mathbf{f}(t)\n$$\n其中线性漂移算符（或矩阵）$A$ 和随机力项 $\\mathbf{f}(t)$ 由下式给出：\n$$\nA = \\begin{pmatrix} 0  1 \\\\ -\\frac{k}{m}  -\\frac{\\gamma}{m} \\end{pmatrix}, \\quad \\mathbf{f}(t) = \\begin{pmatrix} 0 \\\\ \\frac{1}{m} R(t) \\end{pmatrix}\n$$\n随机力 $R(t)$ 是一个满足涨落-耗散定理的白噪声过程，该定理规定了其统计特性：\n$$\n\\langle R(t) \\rangle = 0\n$$\n$$\n\\langle R(t) R(t') \\rangle = 2\\gamma k_B T \\delta(t-t')\n$$\n其中 $k_B$ 是玻尔兹曼常数，$T$ 是绝对温度。\n\n我们需要求解 $t \\ge 0$ 时的稳态时间相关协方差矩阵 $C(t)$，其定义为：\n$$\nC(t) = \\langle \\mathbf{z}(t) \\mathbf{z}(0)^{\\mathsf{T}} \\rangle = \\begin{pmatrix} \\langle x(t)x(0)\\rangle  \\langle x(t)v(0)\\rangle \\\\ \\langle v(t)x(0)\\rangle  \\langle v(t)v(0)\\rangle \\end{pmatrix}\n$$\n该线性随机微分方程的形式解为：\n$$\n\\mathbf{z}(t) = e^{At} \\mathbf{z}(0) + \\int_0^t e^{A(t-s)} \\mathbf{f}(s) ds\n$$\n将此式代入 $C(t)$ 的定义中：\n$$\nC(t) = \\left\\langle \\left( e^{At} \\mathbf{z}(0) + \\int_0^t e^{A(t-s)} \\mathbf{f}(s) ds \\right) \\mathbf{z}(0)^{\\mathsf{T}} \\right\\rangle\n$$\n由于系统处于平衡状态，初始状态 $\\mathbf{z}(0)$ 与任何 $s>0$ 的随机力 $\\mathbf{f}(s)$ 不相关。因此，交叉项消失：$\\langle \\mathbf{f}(s) \\mathbf{z}(0)^{\\mathsf{T}} \\rangle = 0$。这使得表达式简化为：\n$$\nC(t) = e^{At} \\langle \\mathbf{z}(0) \\mathbf{z}(0)^{\\mathsf{T}} \\rangle = e^{At} \\Sigma\n$$\n其中 $\\Sigma$ 是平衡时的等时协方差矩阵。$\\Sigma$ 的分量由平衡麦克斯韦-玻尔兹曼分布 $P_{eq}(x,v) \\propto \\exp\\left(-\\frac{H(x,v)}{k_B T}\\right)$ 确定，其中哈密顿量为 $H(x,v) = \\frac{1}{2}kx^2 + \\frac{1}{2}mv^2$。\n根据能量均分定理，每个二次自由度的平均能量为 $\\frac{1}{2}k_B T$：\n$$\n\\langle \\tfrac{1}{2}kx^2 \\rangle_{eq} = \\tfrac{1}{2}k_B T \\implies \\langle x^2 \\rangle_{eq} = \\frac{k_B T}{k}\n$$\n$$\n\\langle \\tfrac{1}{2}mv^2 \\rangle_{eq} = \\tfrac{1}{2}k_B T \\implies \\langle v^2 \\rangle_{eq} = \\frac{k_B T}{m}\n$$\n交叉相关项 $\\langle xv \\rangle_{eq}$ 为零，因为平衡分布在 $x$ 和 $v$ 上是可分的，并且 $v$（或 $x$）的奇函数在对称区间上的平均值为零。因此，平衡协方差矩阵为：\n$$\n\\Sigma = \\begin{pmatrix} \\langle x^2 \\rangle_{eq}  \\langle xv \\rangle_{eq} \\\\ \\langle vx \\rangle_{eq}  \\langle v^2 \\rangle_{eq} \\end{pmatrix} = \\begin{pmatrix} \\frac{k_B T}{k}  0 \\\\ 0  \\frac{k_B T}{m} \\end{pmatrix}\n$$\n为了求得 $C(t)$，我们必须计算矩阵指数 $e^{At}$。这可以通过求解 $A$ 的特征值和特征向量来完成。特征方程为 $\\det(A - \\lambda I) = 0$：\n$$\n\\det\\begin{pmatrix} -\\lambda  1 \\\\ -\\frac{k}{m}  -\\frac{\\gamma}{m}-\\lambda \\end{pmatrix} = (-\\lambda)(-\\tfrac{\\gamma}{m}-\\lambda) - (-\\tfrac{k}{m}) = \\lambda^2 + \\frac{\\gamma}{m}\\lambda + \\frac{k}{m} = 0\n$$\n特征值是这个二次方程的根：\n$$\n\\lambda_{\\pm} = \\frac{-\\frac{\\gamma}{m} \\pm \\sqrt{(\\frac{\\gamma}{m})^2 - \\frac{4k}{m}}}{2} = \\frac{-\\gamma \\pm \\sqrt{\\gamma^2 - 4mk}}{2m}\n$$\n根据 Cayley-Hamilton 定理，矩阵指数 $e^{At}$可以写成 $e^{At} = c_0(t)I + c_1(t)A$，或者通过对角化求得。对于不同的特征值 $\\lambda_+, \\lambda_-$，$e^{At}$ 的一般形式是：\n$$\ne^{At} = \\frac{1}{\\lambda_+ - \\lambda_-} \\begin{pmatrix} \\lambda_+ e^{\\lambda_- t} - \\lambda_- e^{\\lambda_+ t}  e^{\\lambda_+ t} - e^{\\lambda_- t} \\\\ -\\frac{k}{m}(e^{\\lambda_+ t} - e^{\\lambda_- t})  \\lambda_+ e^{\\lambda_+ t} - \\lambda_- e^{\\lambda_- t} \\end{pmatrix}\n$$\n现在我们计算 $C(t) = e^{At}\\Sigma$：\n$$\nC(t) = \\frac{1}{\\lambda_+ - \\lambda_-} \\begin{pmatrix} \\lambda_+ e^{\\lambda_- t} - \\lambda_- e^{\\lambda_+ t}  e^{\\lambda_+ t} - e^{\\lambda_- t} \\\\ -\\frac{k}{m}(e^{\\lambda_+ t} - e^{\\lambda_- t})  \\lambda_+ e^{\\lambda_+ t} - \\lambda_- e^{\\lambda_- t} \\end{pmatrix} \\begin{pmatrix} \\frac{k_B T}{k}  0 \\\\ 0  \\frac{k_B T}{m} \\end{pmatrix}\n$$\n协方差矩阵的四个矩阵元是：\n$$\n\\langle x(t)x(0) \\rangle = \\frac{k_B T}{k(\\lambda_+ - \\lambda_-)} (\\lambda_+ e^{\\lambda_- t} - \\lambda_- e^{\\lambda_+ t})\n$$\n$$\n\\langle x(t)v(0) \\rangle = \\frac{k_B T}{m(\\lambda_+ - \\lambda_-)} (e^{\\lambda_+ t} - e^{\\lambda_- t})\n$$\n$$\n\\langle v(t)x(0) \\rangle = \\frac{k_B T}{k(\\lambda_+ - \\lambda_-)} \\left(-\\frac{k}{m}\\right)(e^{\\lambda_+ t} - e^{\\lambda_- t}) = -\\frac{k_B T}{m(\\lambda_+ - \\lambda_-)} (e^{\\lambda_+ t} - e^{\\lambda_- t})\n$$\n$$\n\\langle v(t)v(0) \\rangle = \\frac{k_B T}{m(\\lambda_+ - \\lambda_-)} (\\lambda_+ e^{\\lambda_+ t} - \\lambda_- e^{\\lambda_- t})\n$$\n这些相关函数的函数形式取决于判别式 $\\Delta = \\gamma^2 - 4mk$ 的符号。\n\n1.  **过阻尼区域 ($\\gamma^2 > 4mk$)：** 特征值 $\\lambda_+$ 和 $\\lambda_-$ 是不相等的实数且为负。相关函数是两个衰减实指数函数 $e^{\\lambda_+ t}$ 和 $e^{\\lambda_- t}$ 的和。没有振荡。系统单调地弛豫到平衡态。\n\n2.  **欠阻尼区域 ($\\gamma^2 < 4mk$)：** 特征值是一对共轭复数：\n    $$\n    \\lambda_{\\pm} = -\\frac{\\gamma}{2m} \\pm i\\omega_1, \\quad \\text{where} \\quad \\omega_1 = \\frac{\\sqrt{4mk - \\gamma^2}}{2m} = \\sqrt{\\frac{k}{m} - \\left(\\frac{\\gamma}{2m}\\right)^2}\n    $$\n    在这种情况下，$\\lambda_+ - \\lambda_- = -2i\\omega_1$。相关函数表现为阻尼振荡。例如，速度自相关函数变为：\n    $$\n    \\langle v(t)v(0) \\rangle = \\frac{k_B T}{m(-2i\\omega_1)} ((-\\frac{\\gamma}{2m}-i\\omega_1)e^{(-\\frac{\\gamma}{2m}+i\\omega_1)t} - (-\\frac{\\gamma}{2m}+i\\omega_1)e^{(-\\frac{\\gamma}{2m}-i\\omega_1)t})\n    $$\n    $$\n    \\langle v(t)v(0) \\rangle = \\frac{k_B T}{m} e^{-\\frac{\\gamma t}{2m}} \\left(\\cos(\\omega_1 t) - \\frac{\\gamma}{2m\\omega_1} \\sin(\\omega_1 t)\\right)\n    $$\n    相关函数以包络函数 $e^{-\\gamma t/(2m)}$ 衰减，并以频率 $\\omega_1$ 振荡。其他矩阵元也有类似的表达式。\n\n3.  **临界阻尼区域 ($\\gamma^2 = 4mk$)：** 特征值是相等的实数，$\\lambda_+ = \\lambda_- = -\\gamma/(2m)$。相关函数按 $(c_1 + c_2 t)e^{-\\gamma t/(2m)}$ 衰减，这是无振荡情况下可能的最快衰减。\n\n问题要求解主导指数弛豫的两个弛豫率。这些弛豫率对应于系统本征模式的衰减，由特征值 $\\lambda_{\\pm}$ 的相反数给出。\n设弛豫率为 $r_1$ 和 $r_2$。\n$$\nr_{1,2} = -\\lambda_{\\pm} = \\frac{\\gamma \\mp \\sqrt{\\gamma^2 - 4mk}}{2m}\n$$\n这两个表达式提供了过阻尼区域的两个实数弛豫率，在欠阻尼区域它们成为一对共轭复数，其中实部给出衰减率，虚部给出振荡频率。这两个弛豫率完全描述了所有区域中的弛豫动力学。\n这两个弛豫率是：\n$$\n\\frac{\\gamma + \\sqrt{\\gamma^2 - 4mk}}{2m} \\quad \\text{和} \\quad \\frac{\\gamma - \\sqrt{\\gamma^2 - 4mk}}{2m}\n$$", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\gamma + \\sqrt{\\gamma^2 - 4mk}}{2m}  \\frac{\\gamma - \\sqrt{\\gamma^2 - 4mk}}{2m} \\end{pmatrix}}\n$$", "id": "2815972"}, {"introduction": "对于大多数实际的复杂系统，郎之万方程难以获得解析解，必须依赖数值模拟。然而，当迁移率依赖于位置（即存在乘性噪声）时，简单的离散化方案（如欧拉-丸山法）在有限时间步长下无法精确维持系统的热力学平衡态。本练习将理论与计算实践相结合，指导你设计一个包含Metropolis-Hastings校正步骤的数值积分器，以确保模拟严格满足细致平衡条件，并能准确地对玻尔兹曼分布进行抽样 [@problem_id:2815978]。掌握这种方法对于进行精确的分子模拟研究至关重要。", "problem": "考虑一个一维过阻尼朗之万动力学，其乘性噪声源于一个位置依赖的迁移率。设 $x_t \\in \\mathbb{R}$ 的演化遵循 Itô 随机微分方程\n$$\n\\mathrm{d}x_t \\;=\\; a(x_t)\\,\\mathrm{d}t \\;+\\; b(x_t)\\,\\mathrm{d}W_t,\n$$\n其中 $W_t$ 是一个标准维纳过程，$m(x) > 0$ 是一个光滑的标量迁移率，$U(x)$ 是一个光滑势，$T$ 是绝对温度，其逆温度为 $\\beta = (k_{\\mathrm{B}} T)^{-1}$，其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数。在等温约定下，漂移和扩散振幅为\n$$\na(x) \\;=\\; -\\,m(x)\\,U'(x) \\;+\\; \\beta^{-1} m'(x), \n\\qquad \nb(x) \\;=\\; \\sqrt{2\\,\\beta^{-1}\\, m(x)}.\n$$\n\n任务 A (从第一性原理推导)：从与该 Itô 随机微分方程相关的 Fokker–Planck 方程 (FPE) 出发，推导唯一的稳态解 $\\rho_\\star(x)$ (不考虑归一化)。你的推导必须从 Fokker–Planck 方程和标准微积分法则开始，而不是从任何预先引用的专门结果开始。明确证明上面给出的 $a(x)$ 和 $b(x)$ 的选择会得到作为稳态解的玻尔兹曼分布\n$$\n\\rho_\\star(x) \\;\\propto\\; \\exp\\!\\big(-\\beta\\,U(x)\\big).\n$$\n\n任务 B (测度保持离散化的设计与平稳性证明)：考虑以下离散化方案，该方案使用一个带有等温漂移的 Euler–Maruyama 提议，并通过一个 Metropolis–Hastings (MH) 接受/拒绝步骤来修正有限时间步长带来的偏差。对于时间步长 $\\Delta t > 0$ 和当前状态 $x$，定义提议均值和方差\n$$\n\\mu(x) \\;=\\; x \\;+\\; a(x)\\,\\Delta t, \n\\qquad \ns^2(x) \\;=\\; b^2(x)\\,\\Delta t \\;=\\; 2\\,\\beta^{-1}\\,m(x)\\,\\Delta t,\n$$\n并提议 $x^\\dagger \\sim \\mathcal{N}\\!\\big(\\mu(x),\\, s^2(x)\\big)$。将提议转移密度表示为\n$$\nq(x^\\dagger \\mid x) \\;=\\; \\frac{1}{\\sqrt{2\\pi s^2(x)}}\\,\n\\exp\\!\\left(-\\frac{\\left(x^\\dagger - \\mu(x)\\right)^2}{2\\,s^2(x)}\\right).\n$$\n以概率\n$$\n\\alpha(x \\to x^\\dagger) \\;=\\; \\min\\!\\left\\{\\,1,\\;\n\\frac{\\exp\\!\\big(-\\beta U(x^\\dagger)\\big)\\, q(x \\mid x^\\dagger)}{\\exp\\!\\big(-\\beta U(x)\\big)\\, q(x^\\dagger \\mid x)} \\right\\},\n$$\n接受该提议，否则停留在 $x$。使用细致平衡证明，此马尔可夫链具有精确的稳态分布\n$$\n\\pi(x) \\;\\propto\\; \\exp\\!\\big(-\\beta U(x)\\big).\n$$\n简要解释此构造如何与保持乘性噪声动力学的正确平衡分布这一目标相关，并评论 Fixman 型中点思想与 Metropolis–Hastings 校正在实现有限 $\\Delta t$ 下的精确平稳性方面的作用。\n\n任务 C (实现与测试)：在一个无需任何外部输入的程序中实现上述测度保持算法。在 $\\beta = 1$ 的无量纲单位下进行计算。对下面的每个测试用例，模拟马尔可夫链，丢弃初始的预烧期样本，并对链进行稀疏化处理以减少自相关。从保留的样本中估计均值 $\\mathbb{E}[X]$ 和二阶矩 $\\mathbb{E}[X^2]$，并将它们与通过如下数值积分计算出的精确玻尔兹曼期望值进行比较：\n$$\n\\mathbb{E}[f(X)] \\;=\\; \\frac{\\displaystyle \\int_{\\mathbb{R}} f(x)\\, e^{-U(x)}\\, \\mathrm{d}x}{\\displaystyle \\int_{\\mathbb{R}} e^{-U(x)}\\, \\mathrm{d}x}.\n$$\n对于每个测试用例，报告两个布尔值，分别表示估计的均值和二阶矩的绝对误差是否低于指定的容差。你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔的结果列表 (例如, $\\texttt{[result1,result2,result3]}$)。\n\n使用以下测试套件，其中所有参数均为无量纲：\n\n- 测试 $1$ (顺利路径，谐振子势与缓慢变化的迁移率):\n  - 势 $U(x) = \\tfrac{1}{2}\\,x^2$。\n  - 迁移率 $m(x) = 1 + \\tfrac{1}{2}\\,x^2$。\n  - 时间步长 $\\Delta t = 0.5$。\n  - 总步数 $N = 150{,}000$，预烧期 $N_{\\mathrm{burn}} = 30{,}000$，稀疏化因子 $n_{\\mathrm{thin}} = 10$。\n  - 伪随机种子 $s = 12345$。\n  - 容差: $|\\widehat{\\mathbb{E}}[X] - \\mathbb{E}[X]| \\le 2\\times 10^{-2}$， $|\\widehat{\\mathbb{E}}[X^2] - \\mathbb{E}[X^2]| \\le 3\\times 10^{-2}$。\n\n- 测试 $2$ (边界情况，迁移率快速变化):\n  - 势 $U(x) = \\tfrac{1}{2}\\,x^2$。\n  - 迁移率 $m(x) = \\exp(0.8\\,x)$。\n  - 时间步长 $\\Delta t = 0.25$。\n  - 总步数 $N = 160{,}000$，预烧期 $N_{\\mathrm{burn}} = 30{,}000$，稀疏化因子 $n_{\\mathrm{thin}} = 10$。\n  - 伪随机种子 $s = 24680$。\n  - 容差: $|\\widehat{\\mathbb{E}}[X] - \\mathbb{E}[X]| \\le 2\\times 10^{-2}$， $|\\widehat{\\mathbb{E}}[X^2] - \\mathbb{E}[X^2]| \\le 4\\times 10^{-2}$。\n\n- 测试 $3$ (非二次势与有界的振荡迁移率):\n  - 势 $U(x) = \\tfrac{1}{4}\\,x^4 + \\tfrac{1}{2}\\,x^2$。\n  - 迁移率 $m(x) = 1 + \\tfrac{1}{2}\\,\\sin(x)$。\n  - 时间步长 $\\Delta t = 0.20$。\n  - 总步数 $N = 160{,}000$，预烧期 $N_{\\mathrm{burn}} = 30{,}000$，稀疏化因子 $n_{\\mathrm{thin}} = 10$。\n  - 伪随机种子 $s = 11223$。\n  - 容差: $|\\widehat{\\mathbb{E}}[X] - \\mathbb{E}[X]| \\le 2\\times 10^{-2}$， $|\\widehat{\\mathbb{E}}[X^2] - \\mathbb{E}[X^2]| \\le 4\\times 10^{-2}$。\n\n角度单位无关紧要。所有量均为无量纲。最终输出必须是单行，包含一个按以下顺序排列的含 $6$ 个布尔值的列表\n$$\n[\\text{测试 1 均值 ok},\\; \\text{测试 1 二阶矩 ok},\\; \\text{测试 2 均值 ok},\\; \\text{测试 2 二阶矩 ok},\\; \\text{测试 3 均值 ok},\\; \\text{测试 3 二阶矩 ok}].\n$$", "solution": "所提出的问题是理论和计算统计力学中一个有效且良构的练习。它正确地阐述了带乘性噪声的过阻尼朗之万动力学、相关的 Fokker-Planck 方程，以及一个用于对其平衡分布进行采样的标准、稳健的数值方案。我们将继续进行所需的推导和证明。\n\n**任务 A：稳态解的推导**\n\n目标是从给定的 Fokker-Planck 方程 (FPE) 推导出稳态概率密度函数 $\\rho_\\star(x)$，并证明它对应于玻尔兹曼分布。\n\n概率密度 $\\rho(x,t)$ 的 FPE 如下所示：\n$$\n\\partial_t \\rho(x,t) \\;=\\; -\\partial_x\\big(a(x)\\,\\rho(x,t)\\big) \\;+\\; \\tfrac{1}{2}\\,\\partial_x^2\\big(b^2(x)\\,\\rho(x,t)\\big)\n$$\n该方程可以表示为一个连续性方程 $\\partial_t \\rho = -\\partial_x J$，其中 $J(x,t)$ 是概率流密度：\n$$\nJ(x,t) \\;=\\; a(x)\\,\\rho(x,t) \\;-\\; \\tfrac{1}{2}\\,\\partial_x\\big(b^2(x)\\,\\rho(x,t)\\big)\n$$\n稳态解 $\\rho_\\star(x)$ 由条件 $\\partial_t \\rho(x,t) = 0$ 定义。这意味着稳态概率流 $J_\\star(x)$ 必须相对于位置 $x$ 是一个常数。对于一个受势约束的系统，我们在无穷远处施加自然（反射）边界条件，使得概率流为零，即 $\\lim_{x\\to\\pm\\infty} J_\\star(x) = 0$。这要求该常数流在任何地方都为零，因此对所有 $x$都有 $J_\\star(x) = 0$。\n\n将稳态流设为零，得到以下一阶常微分方程：\n$$\na(x)\\,\\rho_\\star(x) \\;-\\; \\tfrac{1}{2}\\,\\frac{\\mathrm{d}}{\\mathrm{d}x}\\big(b^2(x)\\,\\rho_\\star(x)\\big) \\;=\\; 0\n$$\n在等温约定下，给定的漂移和扩散系数为：\n$$\na(x) \\;=\\; -m(x)\\,U'(x) \\;+\\; \\beta^{-1} m'(x)\n$$\n$$\nb^2(x) \\;=\\; 2\\,\\beta^{-1}\\,m(x)\n$$\n其中 $m'(x) = \\frac{\\mathrm{d}m}{\\mathrm{d}x}$ 且 $U'(x) = \\frac{\\mathrm{d}U}{\\mathrm{d}x}$。\n\n将这些表达式代入零流条件：\n$$\n\\left( -m(x)\\,U'(x) \\;+\\; \\beta^{-1} m'(x) \\right) \\rho_\\star(x) \\;-\\; \\tfrac{1}{2}\\,\\frac{\\mathrm{d}}{\\mathrm{d}x}\\big(2\\,\\beta^{-1}\\,m(x)\\,\\rho_\\star(x)\\big) \\;=\\; 0\n$$\n简化第二项：\n$$\n\\left( -m(x)\\,U'(x) \\;+\\; \\beta^{-1} m'(x) \\right) \\rho_\\star(x) \\;-\\; \\beta^{-1}\\,\\frac{\\mathrm{d}}{\\mathrm{d}x}\\big(m(x)\\,\\rho_\\star(x)\\big) \\;=\\; 0\n$$\n我们对项 $\\frac{\\mathrm{d}}{\\mathrm{d}x}(m(x)\\,\\rho_\\star(x))$ 应用微分乘法法则：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}x}\\big(m(x)\\,\\rho_\\star(x)\\big) \\;=\\; m'(x)\\,\\rho_\\star(x) \\;+\\; m(x)\\,\\rho_\\star'(x)\n$$\n将此代回方程：\n$$\n\\left( -m(x)\\,U'(x) \\;+\\; \\beta^{-1} m'(x) \\right) \\rho_\\star(x) \\;-\\; \\beta^{-1}\\left( m'(x)\\,\\rho_\\star(x) \\;+\\; m(x)\\,\\rho_\\star'(x) \\right) \\;=\\; 0\n$$\n分配因子并重新排列各项：\n$$\n-m(x)\\,U'(x)\\,\\rho_\\star(x) \\;+\\; \\beta^{-1} m'(x)\\,\\rho_\\star(x) \\;-\\; \\beta^{-1} m'(x)\\,\\rho_\\star(x) \\;-\\; \\beta^{-1} m(x)\\,\\rho_\\star'(x) \\;=\\; 0\n$$\n包含 $m'(x)\\,\\rho_\\star(x)$ 的项精确地相互抵消。这种抵消是以这种特定形式选择 Itô 漂移项 $a(x)$ 的关键结果。我们剩下：\n$$\n-m(x)\\,U'(x)\\,\\rho_\\star(x) \\;-\\; \\beta^{-1} m(x)\\,\\rho_\\star'(x) \\;=\\; 0\n$$\n由于对所有 $x$，迁移率 $m(x) > 0$，我们可以将整个方程除以 $-m(x)$：\n$$\nU'(x)\\,\\rho_\\star(x) \\;+\\; \\beta^{-1}\\,\\rho_\\star'(x) \\;=\\; 0\n$$\n这是一个关于 $\\rho_\\star(x)$ 的可分离一阶线性常微分方程：\n$$\n\\frac{\\rho_\\star'(x)}{\\rho_\\star(x)} \\;=\\; -\\beta\\,U'(x)\n$$\n对两边关于 $x$ 积分：\n$$\n\\int \\frac{1}{\\rho_\\star(x)}\\,\\mathrm{d}\\rho_\\star(x) \\;=\\; -\\beta \\int U'(x)\\,\\mathrm{d}x\n$$\n$$\n\\ln\\rho_\\star(x) \\;=\\; -\\beta\\,U(x) \\;+\\; C_1\n$$\n其中 $C_1$ 是积分常数。对两边取指数，得到稳态解：\n$$\n\\rho_\\star(x) \\;=\\; e^{C_1} e^{-\\beta\\,U(x)} \\;=\\; C e^{-\\beta\\,U(x)}\n$$\n其中 $C = e^{C_1}$ 是一个归一化常数。这证明了稳态解是玻尔兹曼分布 $\\rho_\\star(x) \\propto \\exp(-\\beta\\,U(x))$，正如所要求。\n\n**任务 B：细致平衡的证明**\n\n目标是证明给定的 Metropolis-Hastings 校正数值方案相对于目标稳态分布 $\\pi(x) \\propto \\exp(-\\beta U(x))$ 满足细致平衡条件。\n\n细致平衡条件指出，对于一个具有转移核 $P(x' \\mid x)$ 的马尔可夫链，以下关系式必须对于稳态分布 $\\pi(x)$ 成立：\n$$\n\\pi(x)\\,P(x' \\mid x) \\;=\\; \\pi(x')\\,P(x \\mid x')\n$$\nMetropolis-Hastings 算法的转移核 $P(x' \\mid x)$ 由一个提议步骤和一个接受步骤组成。对于 $x' \\ne x$，转移密度由提议密度 $q(x' \\mid x)$ 和接受概率 $\\alpha(x \\to x')$ 的乘积给出。对于 $x' \\ne x$ 的细致平衡条件变为：\n$$\n\\pi(x)\\,q(x' \\mid x)\\,\\alpha(x \\to x') \\;=\\; \\pi(x')\\,q(x \\mid x')\\,\\alpha(x' \\to x)\n$$\n接受概率定义为：\n$$\n\\alpha(x \\to x') \\;=\\; \\min\\!\\left\\{\\,1,\\; \\frac{\\pi(x')\\, q(x \\mid x')}{\\pi(x)\\, q(x' \\mid x)} \\right\\}\n$$\n让我们将 Metropolis-Hastings 比率 $R(x, x')$ 定义为：\n$$\nR(x, x') \\;=\\; \\frac{\\pi(x')\\, q(x \\mid x')}{\\pi(x)\\, q(x' \\mid x)}\n$$\n那么 $\\alpha(x \\to x') = \\min\\{1, R(x, x')\\}$，并且根据对称性，$\\alpha(x' \\to x) = \\min\\{1, R(x', x)\\}$。注意 $R(x', x) = 1/R(x, x')$。\n\n我们通过考虑两种情况来验证细致平衡。\n\n情况 1: $R(x, x') \\ge 1$。\n在这种情况下，$\\alpha(x \\to x') = 1$。由于 $R(x, x') \\ge 1$，我们有 $R(x', x) = 1/R(x, x') \\le 1$。因此，$\\alpha(x' \\to x) = R(x', x)$。\n细致平衡等式的左边 (LHS) 是：\n$$\n\\text{LHS} \\;=\\; \\pi(x)\\,q(x' \\mid x)\\,(1) \\;=\\; \\pi(x)\\,q(x' \\mid x)\n$$\n右边 (RHS) 是：\n$$\n\\text{RHS} \\;=\\; \\pi(x')\\,q(x \\mid x')\\,\\alpha(x' \\to x) \\;=\\; \\pi(x')\\,q(x \\mid x')\\,R(x', x)\n$$\n将 $R(x', x)$ 的定义代入：\n$$\n\\text{RHS} \\;=\\; \\pi(x')\\,q(x \\mid x')\\,\\left(\\frac{\\pi(x)\\, q(x' \\mid x)}{\\pi(x')\\, q(x \\mid x')}\\right) \\;=\\; \\pi(x)\\,q(x' \\mid x)\n$$\n因此，LHS = RHS，细致平衡得到满足。\n\n情况 2: $R(x, x') < 1$。\n在这种情况下，$\\alpha(x \\to x') = R(x, x')$。由于 $R(x, x') < 1$，我们有 $R(x', x) = 1/R(x, x') > 1$。因此，$\\alpha(x' \\to x) = 1$。\n细致平衡等式的左边 (LHS) 是：\n$$\n\\text{LHS} \\;=\\; \\pi(x)\\,q(x' \\mid x)\\,\\alpha(x \\to x') \\;=\\; \\pi(x)\\,q(x' \\mid x)\\,R(x, x')\n$$\n将 $R(x, x')$ 的定义代入：\n$$\n\\text{LHS} \\;=\\; \\pi(x)\\,q(x' \\mid x)\\,\\left(\\frac{\\pi(x')\\, q(x \\mid x')}{\\pi(x)\\, q(x' \\mid x)}\\right) \\;=\\; \\pi(x')\\,q(x \\mid x')\n$$\n右边 (RHS) 是：\n$$\n\\text{RHS} \\;=\\; \\pi(x')\\,q(x \\mid x')\\,(1) \\;=\\; \\pi(x')\\,q(x \\mid x')\n$$\n因此，LHS = RHS，细致平衡得到满足。\n\n由于对于 $x' \\ne x$ 的所有情况，细致平衡都成立，因此由该算法生成的马尔可夫链具有稳态分布 $\\pi(x) \\propto \\exp(-\\beta U(x))$。$q(x^\\dagger \\mid x)$ 的具体形式（基于 Euler-Maruyama 步骤的高斯分布）和 $\\pi(x)$ 的具体形式（玻尔兹曼分布）都被 Metropolis-Hastings 接受准则的通用机制正确处理。\n\n这种构造是必要的，因为对于带有乘性噪声的随机微分方程，朴素的数值离散化（例如用于提议的 Euler-Maruyama 方案）通常在有限时间步长 $\\Delta t$ 下不能保持正确的稳态分布。其误差量级为 $\\Delta t$。更复杂的方案，例如那些采用中点评估的方案（与 Stratonovich 诠释或 Fixman 势相关），可以减少稳态分布中的系统误差，但在有限的 $\\Delta t$ 下仍不能完全消除它。相比之下，Metropolis-Hastings 校正步骤精确地强制了细致平衡条件，从而确保所生成的马尔可夫链从真实的平衡分布 $\\pi(x)$ 中采样，而不管 $\\Delta t$ 的大小如何。这种精确性的代价是，如果 $\\Delta t$ 太大，接受率可能会降低，并且由于算法生成的是马尔可夫链而非真实的动力学轨迹，会引入相关性。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Main solver function that executes all test cases and prints the final results.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"name\": \"Test 1\",\n            \"U\": lambda x: 0.5 * x**2,\n            \"U_prime\": lambda x: x,\n            \"m\": lambda x: 1.0 + 0.5 * x**2,\n            \"m_prime\": lambda x: x,\n            \"dt\": 0.5,\n            \"N_steps\": 150000,\n            \"N_burn\": 30000,\n            \"N_thin\": 10,\n            \"seed\": 12345,\n            \"tol_mean\": 2e-2,\n            \"tol_moment2\": 3e-2,\n        },\n        {\n            \"name\": \"Test 2\",\n            \"U\": lambda x: 0.5 * x**2,\n            \"U_prime\": lambda x: x,\n            \"m\": lambda x: np.exp(0.8 * x),\n            \"m_prime\": lambda x: 0.8 * np.exp(0.8 * x),\n            \"dt\": 0.25,\n            \"N_steps\": 160000,\n            \"N_burn\": 30000,\n            \"N_thin\": 10,\n            \"seed\": 24680,\n            \"tol_mean\": 2e-2,\n            \"tol_moment2\": 4e-2,\n        },\n        {\n            \"name\": \"Test 3\",\n            \"U\": lambda x: 0.25 * x**4 + 0.5 * x**2,\n            \"U_prime\": lambda x: x**3 + x,\n            \"m\": lambda x: 1.0 + 0.5 * np.sin(x),\n            \"m_prime\": lambda x: 0.5 * np.cos(x),\n            \"dt\": 0.20,\n            \"N_steps\": 160000,\n            \"N_burn\": 30000,\n            \"N_thin\": 10,\n            \"seed\": 11223,\n            \"tol_mean\": 2e-2,\n            \"tol_moment2\": 4e-2,\n        },\n    ]\n\n    all_results = []\n    for params in test_cases:\n        mean_ok, moment2_ok = run_test_case(params)\n        all_results.extend([mean_ok, moment2_ok])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(str(b).lower() for b in all_results)}]\")\n\n\ndef run_test_case(params):\n    \"\"\"\n    Runs a single test case: simulation, analysis, and comparison.\n    \"\"\"\n    beta = 1.0  # As per problem statement, dimensionless units beta=1\n\n    # Get exact moments\n    exact_mean, exact_moment2 = get_exact_moments(params[\"U\"])\n\n    # Run simulation\n    samples = simulate(\n        U=params[\"U\"],\n        U_prime=params[\"U_prime\"],\n        m=params[\"m\"],\n        m_prime=params[\"m_prime\"],\n        beta=beta,\n        dt=params[\"dt\"],\n        N_steps=params[\"N_steps\"],\n        N_burn=params[\"N_burn\"],\n        N_thin=params[\"N_thin\"],\n        seed=params[\"seed\"],\n    )\n\n    # Calculate estimated moments\n    est_mean = np.mean(samples)\n    est_moment2 = np.mean(samples**2)\n\n    # Compare and check tolerances\n    mean_ok = abs(est_mean - exact_mean) = params[\"tol_mean\"]\n    moment2_ok = abs(est_moment2 - exact_moment2) = params[\"tol_moment2\"]\n\n    return mean_ok, moment2_ok\n\n\ndef get_exact_moments(U):\n    \"\"\"\n    Computes exact first and second moments by numerical quadrature.\n    \"\"\"\n    # For symmetric potentials U(x) = U(-x), the mean E[X] is zero.\n    # All potentials in the test suite are symmetric.\n    exact_mean = 0.0\n\n    # For U(x) = 0.5*x^2 (standard normal), E[X^2] = 1.\n    if callable(U) and U(1.0) == 0.5 and U(2.0) == 2.0: # A simple check for U(x)=0.5x^2\n        return 0.0, 1.0\n\n    # For other potentials, use numerical quadrature.\n    # The integration range [-20, 20] is sufficient as integrands decay rapidly.\n    integration_range = [-20, 20]\n    \n    # Integrand for the normalization constant Z\n    integrand_Z = lambda x: np.exp(-U(x))\n    Z, _ = integrate.quad(integrand_Z, *integration_range)\n\n    # Integrand for the second moment numerator\n    integrand_M2 = lambda x: x**2 * np.exp(-U(x))\n    M2_num, _ = integrate.quad(integrand_M2, *integration_range)\n\n    exact_moment2 = M2_num / Z\n    \n    return exact_mean, exact_moment2\n\n\ndef simulate(U, U_prime, m, m_prime, beta, dt, N_steps, N_burn, N_thin, seed):\n    \"\"\"\n    Performs the Metropolis-corrected Langevin simulation.\n    \"\"\"\n    rng = np.random.default_rng(seed)\n    x = 0.0  # Start simulation at x=0\n    samples = []\n\n    for i in range(N_steps):\n        # Current state values\n        m_x = m(x)\n        Up_x = U_prime(x)\n        mp_x = m_prime(x)\n        U_x = U(x)\n\n        # Proposal generation (Euler-Maruyama step)\n        a_x = -m_x * Up_x + (1.0 / beta) * mp_x\n        s2_x = 2.0 * (1.0 / beta) * m_x * dt\n        \n        mu_proposal = x + a_x * dt\n        # Propose a new state x_prop\n        x_prop = mu_proposal + rng.standard_normal() * np.sqrt(s2_x)\n\n        # Proposed state values\n        m_prop = m(x_prop)\n        Up_prop = U_prime(x_prop)\n        mp_prop = m_prime(x_prop)\n        U_prop = U(x_prop)\n\n        # Calculate quantities for the backward proposal\n        a_prop = -m_prop * Up_prop + (1.0 / beta) * mp_prop\n        s2_prop = 2.0 * (1.0 / beta) * m_prop * dt\n        \n        # Calculate log of proposal probabilities (ignoring constant terms)\n        # log q(x_prop | x)\n        log_q_forward = -0.5 * np.log(s2_x) - (x_prop - mu_proposal)**2 / (2 * s2_x)\n        \n        # log q(x | x_prop)\n        mu_backward = x_prop + a_prop * dt\n        log_q_backward = -0.5 * np.log(s2_prop) - (x - mu_backward)**2 / (2 * s2_prop)\n\n        # Calculate log of acceptance ratio\n        log_pi_ratio = -beta * (U_prop - U_x)\n        log_R = log_pi_ratio + log_q_backward - log_q_forward\n        \n        # Metropolis-Hastings acceptance step\n        if log_R >= 0 or rng.uniform()  np.exp(log_R):\n            x = x_prop\n\n        # Store sample after burn-in and thinning\n        if i >= N_burn and (i - N_burn) % N_thin == 0:\n            samples.append(x)\n    \n    return np.array(samples)\n\n\nif __name__ == '__main__':\n    solve()\n```", "id": "2815978"}]}