{"hands_on_practices": [{"introduction": "温泽尔-克拉默斯-布里渊（WKB）近似是半经典力学的基石，它为量子隧穿提供了深刻的见解，而无需进行完整的数值求解。本练习旨在挑战您运用WKB形式主义来分析化学中隧穿效应最引人注目的实验证据之一：动力学同位素效应（KIE）[@problem_id:2798785]。通过推导隧穿概率对质量的依赖关系，您将在粒子的质量与其反应速率之间建立直接的理论联系，这是物理有机化学和酶动力学中的一个基本概念。", "problem": "考虑一个质量为 $m$ 的单粒子，沿着具有单一势垒的 Born–Oppenheimer 势能面 $V(x)$ 上的一维反应坐标 $x$ 运动。设粒子的总能量为 $E$，使得存在经典转折点 $x_{a}$ 和 $x_{b}$，满足 $V(x_{a}) = E$，$V(x_{b}) = E$，并且对于 $x \\in (x_{a}, x_{b})$ 有 $V(x) > E$。从不含时 Schrödinger 方程出发，并使用半经典 Wentzel–Kramers–Brillouin (WKB) 近似，完成以下任务：\n\n- 推导至半经典领头阶，隧穿透射概率 $T$ 的表达式，该表达式为一个在经典禁区 $(x_{a}, x_{b})$ 上的积分，并用 $m$，$V(x)$，$E$ 和约化普朗克常数 $\\hbar$ 表示。\n- 考虑一个同位素取代，它将质量从 $m$ 变为 $\\alpha m$（其中 $\\alpha > 0$），而不改变势 $V(x)$ 或总能量 $E$。在相同的半经典领头阶近似下，展示控制透射概率的指数在 $m \\mapsto \\alpha m$ 的变换下如何变化。\n- 在一个无非绝热性、绝热反应坐标的深隧穿机制中，反应速率常数 $k$ 由势垒透射主导，且指前因子对质量取代不敏感，请将质量变化对速率的影响表示为比率 $k(\\alpha)/k(1)$ 的一个闭合形式表达式，该表达式包含一个在势垒区域上的积分。\n\n请将您的最终答案表示为 $k(\\alpha)/k(1)$ 的单个解析表达式，用 $m$、$\\alpha$、$V(x)$、$E$、$x_{a}$、$x_{b}$ 和 $\\hbar$ 表示。不要计算任何积分。最终表达式中不要包含任何单位。无需进行数值取整。", "solution": "所提出的问题是半经典量子力学中的一个标准练习，具体来说是 Wentzel–Kramers–Brillouin (WKB) 近似在势垒隧穿中的应用。该问题具有科学依据、提法适定，且其求解所需的所有必要参数和假设均已提供。因此，该问题被认为是有效的，可以进行形式推导。\n\n出发点是质量为 $m$、能量为 $E$ 的粒子在势 $V(x)$ 中的一维不含时 Schrödinger 方程：\n$$\n-\\frac{\\hbar^2}{2m} \\frac{d^2\\psi(x)}{dx^2} + V(x)\\psi(x) = E\\psi(x)\n$$\n这可以重新排列为：\n$$\n\\frac{d^2\\psi(x)}{dx^2} = \\frac{2m}{\\hbar^2} (V(x) - E) \\psi(x)\n$$\n在经典禁区内，即区间 $(x_{a}, x_{b})$，其中 $V(x) > E$，项 $(V(x) - E)$ 是正的。我们定义一个实的、与位置相关的波数 $\\kappa(x)$ 如下：\n$$\n\\kappa(x) = \\sqrt{\\frac{2m}{\\hbar^2}(V(x) - E)}\n$$\n因此，该区域内的 Schrödinger 方程变为：\n$$\n\\frac{d^2\\psi(x)}{dx^2} = \\kappa(x)^2 \\psi(x)\n$$\n在 WKB 近似中，该方程的解由指数增长和衰减函数给出，其中局域振幅受 $\\kappa(x)$ 的平方根倒数调制：\n$$\n\\psi(x) \\approx \\frac{C_{1}}{\\sqrt{\\kappa(x)}} \\exp\\left(\\int^{x} \\kappa(x') dx'\\right) + \\frac{C_{2}}{\\sqrt{\\kappa(x)}} \\exp\\left(-\\int^{x} \\kappa(x') dx'\\right)\n$$\n通过势垒的透射概率 $T$ 代表透射波的通量与入射波的通量之比。对于高和/或宽势垒（“深隧穿”机制），在领头阶 WKB 近似中，此概率主要由波函数振幅在穿越非经典区域 $x_{a}$ 到 $x_{b}$ 时的指数衰减所决定。透射系数是通过将允许区域中的振荡解与势垒内部的渐逝解相连接来找到的。此过程得出透射概率 $T$ 为：\n$$\nT \\approx \\exp\\left(-2 \\int_{x_{a}}^{x_{b}} \\kappa(x) dx\\right)\n$$\n代入 $\\kappa(x)$ 的定义，我们得到第一个要求的结果：半经典领头阶的隧穿透射概率 $T$。\n$$\nT \\approx \\exp\\left(-2 \\int_{x_{a}}^{x_{b}} \\sqrt{\\frac{2m}{\\hbar^2}(V(x) - E)} dx\\right) = \\exp\\left(-\\frac{2}{\\hbar} \\int_{x_{a}}^{x_{b}} \\sqrt{2m(V(x) - E)} dx\\right)\n$$\n指数函数的宗量，我们将其表示为 $-\\sigma(m)$，它控制着隧穿概率的大小。指数 $\\sigma(m)$ 为：\n$$\n\\sigma(m) = \\frac{2}{\\hbar} \\int_{x_{a}}^{x_{b}} \\sqrt{2m(V(x) - E)} dx\n$$\n\n接下来，我们考虑同位素取代效应，它将质量从 $m$ 变为 $\\alpha m$，其中 $\\alpha > 0$。势 $V(x)$ 和能量 $E$ 保持不变，同样不变的还有经典转折点 $x_{a}$ 和 $x_{b}$，因为它们仅依赖于 $V(x)$ 和 $E$。我们需要找出指数 $\\sigma$ 如何变化。设新的指数为 $\\sigma(\\alpha m)$。我们在其定义中用 $\\alpha m$ 替换 $m$：\n$$\n\\sigma(\\alpha m) = \\frac{2}{\\hbar} \\int_{x_{a}}^{x_{b}} \\sqrt{2(\\alpha m)(V(x) - E)} dx\n$$\n由于 $\\alpha$ 是一个常数，我们可以从积分中提出因子 $\\sqrt{\\alpha}$：\n$$\n\\sigma(\\alpha m) = \\sqrt{\\alpha} \\left(\\frac{2}{\\hbar} \\int_{x_{a}}^{x_{b}} \\sqrt{2m(V(x) - E)} dx\\right)\n$$\n这显示了新旧指数之间的直接关系：\n$$\n\\sigma(\\alpha m) = \\sqrt{\\alpha} \\sigma(m)\n$$\n该指数与质量比 $\\alpha$ 的平方根成比例。这是隧穿背景下动力学同位素效应的一个基本结果。\n\n最后，我们需要在给定假设下求出反应速率常数的比率 $k(\\alpha)/k(1)$。问题陈述，反应速率常数 $k$ 由势垒透射主导，并且任何指前因子对质量取代都不敏感。这意味着速率常数与透射概率之间存在直接正比关系：\n$$\nk \\propto T\n$$\n设 $k(1)$ 是质量为 $m$（对应于 $\\alpha=1$）时的速率常数，$k(\\alpha)$ 是质量为 $\\alpha m$ 时的速率常数。它们的比率可以表示为各自透射概率 $T(\\alpha)$ 和 $T(1)$ 的比率：\n$$\n\\frac{k(\\alpha)}{k(1)} = \\frac{T(\\alpha)}{T(1)}\n$$\n使用 $T$ 的 WKB 表达式：\n$$\n\\frac{k(\\alpha)}{k(1)} = \\frac{\\exp(-\\sigma(\\alpha m))}{\\exp(-\\sigma(m))} = \\exp(-\\sigma(\\alpha m) + \\sigma(m))\n$$\n将关系式 $\\sigma(\\alpha m) = \\sqrt{\\alpha} \\sigma(m)$ 代入此表达式：\n$$\n\\frac{k(\\alpha)}{k(1)} = \\exp(-\\sqrt{\\alpha}\\sigma(m) + \\sigma(m)) = \\exp((1 - \\sqrt{\\alpha})\\sigma(m))\n$$\n现在我们代入 $\\sigma(m)$ 的完整积分表达式，以获得用基本参数表示的速率常数比率的最终闭合形式表达式：\n$$\n\\frac{k(\\alpha)}{k(1)} = \\exp\\left( \\left( 1 - \\sqrt{\\alpha} \\right) \\frac{2}{\\hbar} \\int_{x_{a}}^{x_{b}} \\sqrt{2m(V(x) - E)} dx \\right)\n$$\n此表达式在半经典近似内量化了由隧穿引起的动力学同位素效应。", "answer": "$$\n\\boxed{\\exp\\left( \\left( 1 - \\sqrt{\\alpha} \\right) \\frac{2}{\\hbar} \\int_{x_{a}}^{x_{b}} \\sqrt{2m(V(x) - E)} dx \\right)}\n$$", "id": "2798785"}, {"introduction": "尽管像WKB这样的解析近似提供了宝贵的物理直觉，但定量预测通常需要对薛定谔方程进行数值精确求解。本练习将指导您使用稳健的传输矩阵方法，从零开始构建一个量子隧穿计算器[@problem_id:2461151]。通过将势垒离散化并在此基础上“传播”波函数，您将实现一个能够处理任意形状势垒的通用工具，并探索像共振隧穿这样的复杂现象，从而远远超越简单解析模型的局限性。", "problem": "要求您实现一个完整的、可运行的程序，通过对任意势垒进行阶梯常数近似，数值求解不含时薛定谔方程，从而计算一维量子隧穿中定态散射态的透射系数。其科学基础必须从第一性原理出发。使用一维不含时薛定谔方程（TISE），\n$$\n\\frac{d^2 \\psi(x)}{dx^2} + \\frac{2 m}{\\hbar^2} \\left(E - V(x)\\right)\\psi(x) = 0,\n$$\n结合波函数及其一阶导数在材料界面处的连续性，以及定态的概率流定义，将透射系数定义为通量之比。请勿使用任何现成的透射公式；相反，您需要在自己的算法步骤中，基于这些基本原理推导出您所实现的内容。\n\n您必须在原子单位（a.u.）下进行计算，其中电子质量 $m = 1$，$\\hbar = 1$。因此，能量单位是哈特里（Hartree），长度单位是玻尔（Bohr）。透射系数是无量纲的。\n\n您的实现要求如下：\n- 将有限域 $[x_L,x_R]$ 离散化为 $N$ 个宽度为 $\\Delta x = (x_R - x_L)/N$ 的均匀切片。\n- 用一个分段常数函数来近似 $V(x)$，在第 $j$ 个切片上，其值取该切片中点处的 $V_j$。\n- 在每个切片内，求解局域形式的 TISE，并利用连续性条件关联跨越每个切片和每个界面的波幅。\n- 使用这些关系从左侧引线传播到右侧引线，并计算透射系数 $T$，即透射概率流与入射概率流之比，表示为一个在 $[0,1]$ 区间内的实数。\n\n测试套件：\n实现四个测试用例，以检验不同的物理情景。在所有情况下，使用 $x_L = -10$ (Bohr)，$x_R = 10$ (Bohr)，以及 $N = 4000$。\n\n- 情况 A (单个有限方形势垒，能量低于势垒高度):\n  - 势：当 $|x| \\le a/2$ 时，$V(x) = V_0$，其他情况 $V(x) = 0$。\n  - 参数：$V_0 = 0.5$ (Hartree)，$a = 2.0$ (Bohr)，$E = 0.2$ (Hartree)。\n  - 预期的定性行为：由于隧穿效应，$T$ 很小但不为零。\n\n- 情况 B (单个有限方形势垒，高能量):\n  - 与情况 A 具有相同的势和几何形状。\n  - 参数：$V_0 = 0.5$ (Hartree)，$a = 2.0$ (Bohr)，$E = 2.0$ (Hartree)。\n  - 预期的定性行为：$T$ 接近于 $1$。\n\n- 情况 C (无势垒，自由传播):\n  - 势：对所有 $x$，$V(x) = 0$。\n  - 参数：$E = 0.3$ (Hartree)。\n  - 预期的定性行为：$T = 1$。\n\n- 情况 D (带谐振阱的双势垒):\n  - 势：两个相同的高为 $V_0$、宽为 $b$ 的方形势垒，由一个宽度为 $L_w$ 的势阱隔开。明确地说，在 $[-L_w/2 - b, -L_w/2] \\cup [L_w/2, L_w/2 + b]$ 区间上 $V(x) = V_0$，其他地方 $V(x) = 0$。\n  - 参数：$V_0 = 0.6$ (Hartree)，$b = 0.5$ (Bohr)，$L_w = 4.0$ (Bohr)，$E = 0.31$ (Hartree)。\n  - 预期的定性行为：$T$ 表现出谐振增强效应，在谐振点附近可以接近 $1$。\n\n角度单位不适用。透射系数是无量纲的。您的程序必须生成单行输出，其中包含一个 Python 风格的列表，内含对应于 A、B、C、D 四种情况的四个数值透射系数值，顺序不变，每个值四舍五入到 $6$ 位小数。确切的输出格式要求为：\n\"[t_A,t_B,t_C,t_D]\"\n不含空格。\n\n您的程序不得读取任何输入。它必须计算这四个值并打印所要求的单行输出。最终答案必须是浮点数。推导和算法必须仅基于 TISE、界面处的连续性条件以及概率流定义。在您的选择和计算中，请确保数值稳定性和科学合理性。", "solution": "该问题是有效的。它在科学上基于量子力学原理，问题定义明确、客观，并包含了获得唯一解所需的所有信息。我们将进行完整的推导和实现。\n\n此问题的基础是一维不含时薛定谔方程（TISE）。在原子单位中，电子质量 $m=1$，约化普朗克常数 $\\hbar=1$，对于能量为 $E$ 的粒子在势 $V(x)$ 中的 TISE 为：\n$$\n\\frac{d^2 \\psi(x)}{dx^2} + 2 \\left(E - V(x)\\right)\\psi(x) = 0\n$$\n我们的任务是求解此方程的散射态，其中一个粒子从左侧入射到一个势垒上。势 $V(x)$ 被近似为一个分段常数函数。感兴趣的区域 $[x_L, x_R]$ 被离散化为 $N$ 个均匀的切片，每个切片的宽度为 $\\Delta x = (x_R - x_L)/N$。在第 $j$ 个切片内，即区间 $[x_{j-1}, x_j]$（其中 $x_j = x_L + j\\Delta x$），势被保持为常数 $V_j = V(x_{j-1} + \\Delta x/2)$。\n\n在切片 $j$ 中，TISE 呈现为简谐振子方程的形式：\n$$\n\\frac{d^2 \\psi_j(x)}{dx^2} + k_j^2 \\psi_j(x) = 0\n$$\n其中 $k_j^2 = 2(E - V_j)$ 是局域波数的平方。解的性质取决于 $k_j^2$ 的符号：\n1.  如果 $E > V_j$，$k_j = \\sqrt{2(E - V_j)}$ 为实数。解是振荡的，代表传播波：$\\psi_j(x) = A_j e^{i k_j x} + B_j e^{-i k_j x}$。\n2.  如果 $E  V_j$，$k_j = i\\sqrt{2(V_j - E)} \\equiv i\\kappa_j$ 是纯虚数，其中 $\\kappa_j$ 是实数。解是指数形式的，代表倏逝（非传播）波：$\\psi_j(x) = A_j e^{-\\kappa_j x} + B_j e^{\\kappa_j x}$。\n\n为了求解整个区域的系统，我们采用传输矩阵法。我们不追踪可能导致数值不稳定的系数 $(A_j, B_j)$，而是传播状态矢量 $\\mathbf{S}(x) = \\begin{pmatrix} \\psi(x) \\\\ \\psi'(x) \\end{pmatrix}$，其中 $\\psi'(x) = d\\psi/dx$。通过这种方法，$\\psi(x)$ 和 $\\psi'(x)$ 在切片间界面处的连续性得以自然保持。\n\n在切片 $j$ 内，我们需要一个矩阵 $\\mathbf{P}_j$ 来关联切片末端的状态 $\\mathbf{S}(x_j)$ 与初始状态 $\\mathbf{S}(x_{j-1})$：$\\mathbf{S}(x_j) = \\mathbf{P}_j \\mathbf{S}(x_{j-1})$。切片 $j$ 内的通解可以写为 $\\psi(x) = C \\cos(k_j(x-x_{j-1})) + D \\sin(k_j(x-x_{j-1}))$。在 $x=x_{j-1}$ 处，我们有 $\\psi(x_{j-1}) = C$ 和 $\\psi'(x_{j-1}) = D k_j$，这使我们能够用初始状态矢量表示 $C$ 和 $D$。在 $x=x_j=x_{j-1}+\\Delta x$ 处计算 $\\psi(x)$ 和 $\\psi'(x)$，即可得到传播矩阵 $\\mathbf{P}_j$。\n\n情况 1：$E > V_j$（$k_j$ 为实数且非零）\n解是振荡的。传播矩阵为：\n$$\n\\mathbf{P}_j = \\begin{pmatrix} \\cos(k_j \\Delta x)  \\frac{1}{k_j}\\sin(k_j \\Delta x) \\\\ -k_j \\sin(k_j \\Delta x)  \\cos(k_j \\Delta x) \\end{pmatrix}\n$$\n情况 2：$E  V_j$（$\\kappa_j$ 为实数且非零）\n解是指数的。使用 $\\cos(iy) = \\cosh(y)$ 和 $\\sin(iy) = i\\sinh(y)$，传播矩阵变为：\n$$\n\\mathbf{P}_j = \\begin{pmatrix} \\cosh(\\kappa_j \\Delta x)  \\frac{1}{\\kappa_j}\\sinh(\\kappa_j \\Delta x) \\\\ \\kappa_j \\sinh(\\kappa_j \\Delta x)  \\cosh(\\kappa_j \\Delta x) \\end{pmatrix}\n$$\n情况 3：$E = V_j$（$k_j=0$）\nTISE 简化为 $\\psi''(x)=0$，其解为 $\\psi(x) = Ax+B$。传播矩阵是情况 1 在 $k_j \\to 0$ 时的极限：\n$$\n\\mathbf{P}_j = \\begin{pmatrix} 1  \\Delta x \\\\ 0  1 \\end{pmatrix}\n$$\n右边界 $x_R=x_N$ 的状态通过所有切片传播矩阵的乘积与左边界 $x_L=x_0$ 的状态相关联：\n$$\n\\mathbf{S}(x_R) = (\\mathbf{P}_N \\mathbf{P}_{N-1} \\cdots \\mathbf{P}_1) \\mathbf{S}(x_L) \\equiv \\mathbf{P}_{total} \\mathbf{S}(x_L)\n$$\n问题指定了散射边界条件。我们假设在区域 $[x_L, x_R]$ 之外势为零。\n-   在左侧引线 ($x \\leq x_L$) 中，波函数是单位振幅的入射波和反射波的叠加：$\\psi_L(x) = e^{ik_0 x} + r e^{-ik_0 x}$，其中 $k_0 = \\sqrt{2E}$。\n-   在右侧引线 ($x \\geq x_R$) 中，只有透射波：$\\psi_R(x) = t e^{ik_0 x}$。\n\n根据这些形式，我们确定边界处的状态矢量：\n$$\n\\mathbf{S}(x_L) = \\begin{pmatrix} e^{ik_0 x_L} + r e^{-ik_0 x_L} \\\\ ik_0(e^{ik_0 x_L} - r e^{-ik_0 x_L}) \\end{pmatrix} \\quad , \\quad \\mathbf{S}(x_R) = t \\begin{pmatrix} e^{ik_0 x_R} \\\\ ik_0 e^{ik_0 x_R} \\end{pmatrix}\n$$\n将这些代入关系式 $\\mathbf{S}(x_R) = \\mathbf{P}_{total} \\mathbf{S}(x_L)$，得到一个关于未知复振幅 $r$ 和 $t$ 的二元线性方程组。设 $\\mathbf{P}_{total} = \\begin{pmatrix} P_{11}  P_{12} \\\\ P_{21}  P_{22} \\end{pmatrix}$。求解该方程组得到透射振幅 $t$：\n$$\nt = \\frac{-2ik_0 e^{-ik_0(x_R-x_L)}}{ (P_{21} - k_0^2 P_{12}) - i k_0 (P_{11} + P_{22}) }\n$$\n透射系数 $T$ 定义为透射概率流与入射概率流之比。定态的概率流为 $j(x) = \\frac{1}{2i}(\\psi^* \\psi' - \\psi \\psi'^*)$。\n-   入射流：$j_{inc} = k_0$（对于入射波 $e^{ik_0 x}$）。\n-   透射流：$j_{trans} = |t|^2 k_0$（对于透射波 $t e^{ik_0 x}$）。\n因此，透射系数为 $T = j_{trans}/j_{inc} = |t|^2$。\n使用 $t$ 的表达式，并注意到传播矩阵 $\\mathbf{P}_j$ 是实数矩阵，我们发现：\n$$\nT = |t|^2 = \\frac{4k_0^2}{|(P_{21} - k_0^2 P_{12}) - i k_0 (P_{11} + P_{22})|^2} = \\frac{4k_0^2}{(P_{21} - k_0^2 P_{12})^2 + k_0^2(P_{11} + P_{22})^2}\n$$\n这个公式可以直接计算透射系数。\n\n算法如下：\n1.  对每个测试用例，定义能量 $E$ 和势函数 $V(x)$。\n2.  建立空间网格，并计算 $N$ 个切片中每个切片的恒定势 $V_j$。\n3.  计算自由空间波数 $k_0 = \\sqrt{2E}$。\n4.  将总传播矩阵 $\\mathbf{P}_{total}$ 初始化为 $2 \\times 2$ 的单位矩阵。\n5.  遍历每个切片 $j=1, \\ldots, N$。在每次迭代中，根据 $2(E-V_j)$ 的符号计算切片矩阵 $\\mathbf{P}_j$，并通过左乘更新总矩阵：$\\mathbf{P}_{total} \\leftarrow \\mathbf{P}_j \\, \\mathbf{P}_{total}$。\n6.  遍历完所有切片后，提取最终 $\\mathbf{P}_{total}$ 矩阵的四个元素。\n7.  使用推导出的 $T$ 的公式计算透射系数。\n此过程将为所有四个测试用例实现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the four test cases for quantum tunneling.\n    \"\"\"\n\n    def calculate_transmission(params):\n        \"\"\"\n        Calculates the transmission coefficient for a single set of parameters.\n        The method uses the transfer matrix approach for the state vector (psi, psi').\n        \"\"\"\n        x_L, x_R, N, E, V_func = params\n        dx = (x_R - x_L) / N\n\n        if E = 0:\n            return 0.0\n        \n        k0 = np.sqrt(2 * E)\n\n        # Initialize the total propagation matrix\n        P_total = np.identity(2, dtype=np.float64)\n\n        # Define grid midpoints for potential evaluation\n        x_mids = x_L + dx / 2.0 + np.arange(N) * dx\n        \n        # Create an array of potential values for each slice\n        V_slices = V_func(x_mids)\n\n        # The total propagation matrix is P_N * P_{N-1} * ... * P_1\n        # Loop computes P_1, then P_2*P_1, then P_3*P_2*P_1, etc.\n        for i in range(N):\n            V = V_slices[i]\n            k_squared = 2 * (E - V)\n            \n            # This is the matrix for the i-th slice (P_{i+1} in formula)\n            P_slice = np.empty((2, 2), dtype=np.float64)\n\n            # E > V: Propagating region\n            if k_squared > 0:\n                k = np.sqrt(k_squared)\n                # Handle k -> 0 case for numerical stability\n                if np.abs(k * dx)  1e-9:\n                    P_slice[0, 0] = 1.0\n                    P_slice[0, 1] = dx\n                    P_slice[1, 0] = 0.0\n                    P_slice[1, 1] = 1.0\n                else:\n                    c = np.cos(k * dx)\n                    s = np.sin(k * dx)\n                    P_slice[0, 0] = c\n                    P_slice[0, 1] = s / k\n                    P_slice[1, 0] = -k * s\n                    P_slice[1, 1] = c\n            # E  V: Evanescent region\n            else:\n                kappa = np.sqrt(-k_squared)\n                # Handle kappa -> 0 case (same as k -> 0)\n                if np.abs(kappa * dx)  1e-9:\n                    P_slice[0, 0] = 1.0\n                    P_slice[0, 1] = dx\n                    P_slice[1, 0] = 0.0\n                    P_slice[1, 1] = 1.0\n                else:\n                    ch = np.cosh(kappa * dx)\n                    sh = np.sinh(kappa * dx)\n                    P_slice[0, 0] = ch\n                    P_slice[0, 1] = sh / kappa\n                    P_slice[1, 0] = kappa * sh\n                    P_slice[1, 1] = ch\n            \n            # Left-multiply to build P_i * P_{i-1} * ...\n            P_total = P_slice @ P_total\n\n        # Extract elements of the total propagation matrix\n        P11, P12, P21, P22 = P_total.flatten()\n        \n        # Calculate transmission coefficient T using the derived formula\n        denominator = (P21 - k0**2 * P12)**2 + (k0 * (P11 + P22))**2\n        \n        if denominator == 0:\n            # Should not happen for k0 > 0, but as a safeguard\n            return 1.0  # Physical limit for resonance\n\n        T = 4 * k0**2 / denominator\n        return T\n\n    # Common parameters for all test cases\n    x_L = -10.0\n    x_R = 10.0\n    N = 4000\n\n    # Test Case A: Single rectangular barrier, sub-barrier energy\n    V0_A = 0.5\n    a_A = 2.0\n    E_A = 0.2\n    V_func_A = lambda x: np.where(np.abs(x) = a_A / 2.0, V0_A, 0.0)\n    case_A = (x_L, x_R, N, E_A, V_func_A)\n\n    # Test Case B: Single rectangular barrier, high energy\n    V0_B = 0.5\n    a_B = 2.0\n    E_B = 2.0\n    V_func_B = lambda x: np.where(np.abs(x) = a_B / 2.0, V0_B, 0.0)\n    case_B = (x_L, x_R, N, E_B, V_func_B)\n\n    # Test Case C: No barrier, free propagation\n    E_C = 0.3\n    V_func_C = lambda x: np.zeros_like(x)\n    case_C = (x_L, x_R, N, E_C, V_func_C)\n\n    # Test Case D: Double barrier with a resonant well\n    V0_D = 0.6\n    b_D = 0.5\n    Lw_D = 4.0\n    E_D = 0.31\n    def V_func_D(x):\n        abs_x = np.abs(x)\n        return np.where((abs_x >= Lw_D / 2.0)  (abs_x = Lw_D / 2.0 + b_D), V0_D, 0.0)\n    case_D = (x_L, x_R, N, E_D, V_func_D)\n\n    test_cases = [case_A, case_B, case_C, case_D]\n\n    results = []\n    for case in test_cases:\n        result = calculate_transmission(case)\n        results.append(result)\n\n    # Format the final output string as required\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2461151"}, {"introduction": "进入现代理论化学的领域，我们会遇到一些能为反应动力学提供更深刻半经典描述的方法。这项高级练习将向您介绍瞬子理论，这是一个源自 Richard Feynman 量子力学路径积分形式的强大框架[@problem_id:2461167]。您将实践瞬子理论的核心概念——涉及在虚时间中沿反转势垒的运动——来计算质子转移反应的隧穿概率，这是化学和生物学中一个普遍存在的基本过程。本练习为您提供了一个亲身实践的机会，来学习一种计算量子反应速率的前沿技术。", "problem": "要求您设计并实现一个完整的程序，使用半经典极限下的瞬时子理论，在解析势能面上计算一维质子转移的隧穿概率。质子被建模为一个质量为 $m$ 的粒子，在势能函数 $V(x)$ 下沿一维坐标 $x$ 运动。您的算法必须从量子力学的路径积分表述和虚时间中的最小作用量原理出发，将隧穿概率简化为一个由连接反转势上经典转折点的“bounce”轨迹的欧几里得作用量决定的量。您不能假定任何作为推导最终目标的结果；您必须从基本定义出发，得出一个可以进行数值计算的可计算表达式。您必须使用国际单位制（SI）中的约化普朗克常数 $\\hbar$ 和质子质量 $m$，其中 $x$ 的单位是米，$V$ 的单位是焦耳，$m$ 的单位是千克，时间的单位是秒。所有概率都是无量纲的，并且必须以小数形式报告。\n\n势能面由一个带有线性倾斜的四次双阱势定义，\n$$\nV(x) = a\\,(x^2 - b^2)^2 + c\\,x,\n$$\n其中 $a$ 的单位是焦耳/米⁴，$b$ 的单位是米，$c$ 的单位是焦耳/米。质子质量为 $m = 1.67262192369\\times 10^{-27}\\,\\text{kg}$，约化普朗克常数为 $\\hbar = 1.054571817\\times 10^{-34}\\,\\text{J}\\cdot \\text{s}$。\n\n对于每一组指定的参数 $(a,b,c)$，您的程序必须仅使用瞬时子理论的基本原理和经过充分检验的简化方法，以物理上一致的方式执行以下操作：\n- 通过寻找 $V(x)$ 的驻点并根据 $V''(x)$ 对其进行分类，确定左侧反应物势阱的最小值点 $x_{\\mathrm{L}}$。\n- 通过 $x_{\\mathrm{L}}$ 附近的谐振子零点能来近似反应物态的能量 $E$，即最小值能量加上 $\\hbar$ 乘以由 $V''(x_{\\mathrm{L}})$ 和 $m$ 导出的局部谐振角频率的一半。所有中间步骤必须使用国际单位制（SI）进行。\n- 通过定位位于两个最小值点之间且具有负曲率 $V''(x_{\\mathrm{B}})  0$ 的驻点，确定两个势阱之间的势垒顶点 $x_{\\mathrm{B}}$，并计算 $V_{\\max} = V(x_{\\mathrm{B}})$。\n- 如果 $E \\ge V_{\\max}$，则将隧穿概率设置为 $1$（经典允许的越垒运动）。\n- 如果 $E  V_{\\max}$，则通过求解 $V(x) = E$ 且满足 $x_a  x_{\\mathrm{B}}  x_b$ 来确定经典转折点 $x_a  x_b$。然后，通过计算 $x_a$ 和 $x_b$ 之间“bounce”轨迹的欧几里得作用量，并将其转换为与瞬时子近似一致的概率，来评估对隧穿概率的半经典瞬时子主导贡献。您的推导必须从虚时间作用量和反转势上经典“bounce”的定义开始，并将其简化为在经典禁区上可进行数值计算的量。最终的概率必须是开区间 $(0,1)$ 内的实数。\n\n您的程序必须实现稳健的数值方法来定位驻点和转折点，并以对平滑一维势稳定的方式执行任何所需的积分。所有计算都必须以国际单位制（SI）进行。如果出现角度，必须以弧度表示。最终答案必须是小数。\n\n使用以下参数值的测试套件，每组 $(a,b,c)$ 均以国际单位制（SI）给出：\n- 情况 1（对称，中等势垒）：$a = 7.5\\times 10^{21}\\,\\text{J}\\,\\text{m}^{-4}$，$b = 5.0\\times 10^{-11}\\,\\text{m}$，$c = 0.0\\,\\text{J}\\,\\text{m}^{-1}$。\n- 情况 2（极低势垒，越垒运动）：$a = 1.0\\times 10^{20}\\,\\text{J}\\,\\text{m}^{-4}$，$b = 5.0\\times 10^{-11}\\,\\text{m}$，$c = 0.0\\,\\text{J}\\,\\text{m}^{-1}$。\n- 情况 3（对称，宽且高势垒）：$a = 1.28\\times 10^{21}\\,\\text{J}\\,\\text{m}^{-4}$，$b = 1.0\\times 10^{-10}\\,\\text{m}$，$c = 0.0\\,\\text{J}\\,\\text{m}^{-1}$。\n- 情况 4（轻微倾斜的势阱）：$a = 7.5\\times 10^{21}\\,\\text{J}\\,\\text{m}^{-4}$，$b = 5.0\\times 10^{-11}\\,\\text{m}$，$c = 8.0\\times 10^{-11}\\,\\text{J}\\,\\text{m}^{-1}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[r_1,r_2,r_3,r_4]$），其中每个 $r_i$ 是情况 $i$ 的隧穿概率，以符合国际单位制的小数表示（无量纲概率）。不应打印任何其他文本。", "solution": "提交审议的问题陈述是有效的。它在科学上基于半经典量子力学的原理，特别是用于模拟量子隧穿的瞬时子理论。该问题定义明确，提供了清晰的解析势、所有必要的物理常数以及一组用于计算的已定义参数。目标清晰，并以正式、客观的语言表达。所需的计算任务是计算物理和计算化学中的标准程序。因此，我将着手构建解决方案。\n\n我们分析的基础是虚时间（$\\tau = it$）中的量子力学路径积分表述。隧穿概率与亚稳态的衰变率有关，该衰变率可以从系统基态能量的虚部中提取。在半经典极限下，即约化普朗克常数 $\\hbar$ 被认为很小时，这可以通过 Feynman 路径积分的稳相近似来计算。转换到虚时间将振荡的被积函数 $\\exp(iS/\\hbar)$ 变为衰减的指数函数 $\\exp(-S_E/\\hbar)$，其中 $S_E$ 是欧几里得作用量。\n\n质量为 $m$ 的粒子在势 $V(x)$ 下沿一维路径 $x(\\tau)$ 运动的欧几里得作用量由下式给出：\n$$\nS_E[x(\\tau)] = \\int \\left[ \\frac{1}{2}m\\left(\\frac{dx}{d\\tau}\\right)^2 + V(x(\\tau)) \\right] d\\tau\n$$\n在半经典极限下，路径积分由最小化此作用量的经典路径主导。应用最小作用量原理 $\\delta S_E[x(\\tau)] = 0$，可得出虚时间中轨迹的 Euler-Lagrange 方程：\n$$\nm \\frac{d^2x}{d\\tau^2} = \\frac{dV}{dx}\n$$\n该方程在数学上等同于粒子在*反转*势 $U_{eff}(x) = -V(x)$ 中的 Newtonian 运动方程。沿此轨迹的守恒量是反转势中的经典能量：\n$$\nE_{cl} = \\frac{1}{2}m\\left(\\frac{dx}{d\\tau}\\right)^2 - V(x)\n$$\n一个具有确定能量 $E$ 并隧穿势垒的量子态，对应于反转势中一个具有守恒能量 $E_{cl} = -E$ 的经典轨迹。用于隧穿的感兴趣轨迹是“bounce”或“瞬时子”解。该轨迹从一个经典转折点 $x_a$（其中 $V(x_a) = E$）开始，在虚时间中行进到另一个转折点 $x_b$（其中 $V(x_b) = E$），然后返回到 $x_a$。在转折点处，虚时间中的动能为零。\n\n根据能量守恒方程，我们可以在经典禁区（$x_a  x  x_b$ 且 $V(x) > E$）内表示虚时间中的速度：\n$$\n\\frac{dx}{d\\tau} = \\sqrt{\\frac{2}{m}(V(x) - E)}\n$$\n“bounce”轨迹的欧几里得作用量的值 $S_{bounce}$ 是决定隧穿概率的量。该作用量可以通过在“bounce”持续时间内对欧几里得拉格朗日量 $L_E = \\frac{1}{2}m(\\dot{x})^2 + V(x)$ 进行积分来计算。利用能量守恒，我们可以将拉格朗日量重写为 $L_E = m(\\dot{x})^2 + E$。从 $x_a$ 到 $x_b$ 的路径作用量为：\n$$\n\\int_{x_a}^{x_b} L_E \\, d\\tau = \\int_{x_a}^{x_b} (m(\\dot{x})^2 + E) \\frac{dx}{\\dot{x}} = \\int_{x_a}^{x_b} (m\\dot{x} + \\frac{E}{\\dot{x}}) dx\n$$\n另一种更直接的方法是使用简略作用量。完整“bounce”（从 $x_a$ 到 $x_b$ 再返回 $x_a$）的作用量由动量 $p(\\tau) = m(dx/d\\tau)$ 沿从 $x_a$到 $x_b$ 路径积分的两倍给出：\n$$\nS_{bounce} = \\oint p(\\tau) dx = 2 \\int_{x_a}^{x_b} m \\frac{dx}{d\\tau} dx = 2 \\int_{x_a}^{x_b} m \\sqrt{\\frac{2}{m}(V(x) - E)} dx = 2 \\int_{x_a}^{x_b} \\sqrt{2m(V(x) - E)} dx\n$$\n对隧穿概率 $P$ 的主导阶半经典贡献由 Gamow 因子给出，该因子与“bounce”轨迹的作用量直接相关：\n$$\nP \\approx \\exp\\left(-\\frac{S_{bounce}}{\\hbar}\\right) = \\exp\\left(-\\frac{2}{\\hbar} \\int_{x_a}^{x_b} \\sqrt{2m(V(x) - E)}\\,dx\\right)\n$$\n这就是我们必须进行数值计算的表达式。\n\n对于给定的一组参数 $(a, b, c)$，计算步骤如下：\n1. 定义势能 $V(x) = a(x^2 - b^2)^2 + cx$ 及其一阶和二阶导数 $V'(x)$ 和 $V''(x)$。驻点是三次多项式 $V'(x) = 4ax^3 - 4ab^2x + c = 0$ 的根。\n2. 数值求解 $V'(x)=0$ 的实根。这些是驻点。使用二阶导数 $V''(x) = 12ax^2 - 4ab^2$ 的符号对它们进行分类。极小值点满足 $V''(x)>0$，势垒顶点满足 $V''(x)0$。我们将最左侧的极小值点确定为反应物势阱 $x_L$。\n3. 反应物态的能量 $E$ 通过反应物势阱中的谐振子零点能来近似。局部角频率为 $\\omega_L = \\sqrt{V''(x_L)/m}$。能量则为 $E = V(x_L) + \\frac{1}{2}\\hbar\\omega_L$。\n4. 确定势垒最大值点 $x_B$，即位于两个极小值点之间的驻点，并计算势垒高度 $V_{max} = V(x_B)$。\n5. 如果 $E \\ge V_{max}$，运动是经典允许的。隧穿概率为 $1$。\n6. 如果 $E  V_{max}$，则发生隧穿。我们必须通过求解 $V(x) = E$ 来找到经典转折点 $x_a$ 和 $x_b$。这等效于求解四次多项式 $ax^4 - 2ab^2x^2 + cx + (ab^4 - E) = 0$ 的根。从实根中，我们确定包含势垒区域并满足 $x_a  x_B  x_b$ 的一对点 $(x_a, x_b)$。\n7. 然后我们使用稳健的求积方法（例如 `scipy.integrate.quad` 提供的方法）数值计算作用量积分 $S_0 = \\int_{x_a}^{x_b} \\sqrt{2m(V(x) - E)}\\,dx$。该方法可以处理端点处的可积奇点。\n8. 最后，隧穿概率计算为 $P = \\exp(-2S_0/\\hbar)$。\n\n该算法将使用 Python 实现，利用 `numpy` 库进行求根和数组操作，以及 `scipy` 库进行数值积分。所有计算都将按规定使用国际单位制（SI）进行。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Solves for the tunneling probability for a proton in a quartic double-well potential\n    using semiclassical instanton theory for a given set of test cases.\n    \"\"\"\n    # Physical constants in SI units\n    m_p = 1.67262192369e-27  # Proton mass in kg\n    hbar = 1.054571817e-34    # Reduced Planck constant in J*s\n\n    # Test suite of parameters (a, b, c) in SI units\n    test_cases = [\n        # Case 1 (symmetric, moderate barrier)\n        (7.5e21, 5.0e-11, 0.0),\n        # Case 2 (very low barrier, over-barrier motion)\n        (1.0e20, 5.0e-11, 0.0),\n        # Case 3 (symmetric, wide and high barrier)\n        (1.28e21, 1.0e-10, 0.0),\n        # Case 4 (slightly tilted wells)\n        (7.5e21, 5.0e-11, 8.0e-11),\n    ]\n\n    results = []\n    for case in test_cases:\n        a, b, c = case\n        prob = compute_probability(a, b, c, m_p, hbar)\n        results.append(prob)\n\n    # Format the output as a comma-separated list in brackets\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\ndef compute_probability(a, b, c, m, hbar):\n    \"\"\"\n    Computes the tunneling probability for a single set of potential parameters.\n    \"\"\"\n    # Define potential and its derivatives\n    V = lambda x: a * (x**2 - b**2)**2 + c * x\n    V_prime_coeffs = [4 * a, 0, -4 * a * b**2, c]\n    V_double_prime = lambda x: 12 * a * x**2 - 4 * a * b**2\n\n    # 1. Find and classify stationary points by solving V'(x) = 0\n    stationary_points = np.roots(V_prime_coeffs)\n    real_stationary_points = np.sort(stationary_points[np.isreal(stationary_points)].real)\n\n    if len(real_stationary_points)  3:\n        # This case suggests a single well or monotonic potential, not a double well.\n        # For the given problem structure, we assume a double well.\n        # This branch might be needed for more general cases.\n        # For simplicity, we assume 3 real roots for a double well.\n        # If over-barrier, prob is 1. Under-barrier in a single well, prob is 0.\n        # Here we can return a nominal value, but a robust solver would classify potential shape.\n        return 1.0 # Or some other indicator of unexpected potential shape\n\n    minima = [p for p in real_stationary_points if V_double_prime(p) > 0]\n    maxima = [p for p in real_stationary_points if V_double_prime(p)  0]\n\n    if not minima or not maxima:\n        # Not a standard double well, might be over-barrier by default\n        return 1.0\n\n    x_L = min(minima)\n    x_B = maxima[0] # Should be only one barrier top between minima\n\n    # 2. Calculate reactant state energy E (harmonic ZPE approximation)\n    V_L = V(x_L)\n    V_pp_L = V_double_prime(x_L)\n    omega_L = np.sqrt(V_pp_L / m)\n    E = V_L + 0.5 * hbar * omega_L\n\n    # 3. Find barrier top V_max and check for over-barrier motion\n    V_max = V(x_B)\n\n    if E >= V_max:\n        return 1.0\n\n    # 4. Find classical turning points by solving V(x) = E\n    # This is a quartic equation: a(x^2-b^2)^2 + cx - E = 0\n    # ax^4 - 2ab^2x^2 + cx + (ab^4 - E) = 0\n    quartic_coeffs = [a, 0, -2 * a * b**2, c, a * b**4 - E]\n    turning_points = np.roots(quartic_coeffs)\n    real_turning_points = np.sort(turning_points[np.isreal(turning_points)].real)\n    \n    if len(real_turning_points)  2:\n        # Should not happen if E  V_max in a double well\n        return 0.0\n\n    # The relevant turning points are the two inner ones bracketing the barrier\n    # For a typical double-well, there are 4 real roots when E is between the two minima energies.\n    # The two inner roots define the classically forbidden region under the main barrier.\n    # Identify x_a and x_b such that x_a  x_B  x_b\n    \n    # Find index of root just less than x_B\n    idx = np.searchsorted(real_turning_points, x_B) - 1\n    if idx  0 or idx + 1 >= len(real_turning_points):\n        # Atypical turning point structure; could indicate E is below product well, etc.\n        # For this problem, assume simple case where x_a and x_b are well-defined.\n        # This protection is for robustness.\n        # Fallback to no tunneling if inner turning points are not found.\n        return 0.0\n    x_a = real_turning_points[idx]\n    x_b = real_turning_points[idx + 1]\n\n    # 5. Evaluate the action integral S0\n    integrand = lambda x: np.sqrt(2 * m * (V(x) - E))\n    # We must guard against floating point errors making V(x)-E negative\n    # `quad` is generally robust if the interval is correct.\n    # Define a safe integrand for numerical stability near the boundaries\n    safe_integrand = lambda x: np.sqrt(np.maximum(0, 2 * m * (V(x) - E)))\n    \n    S0, _ = integrate.quad(safe_integrand, x_a, x_b, limit=200)\n\n    # 6. Calculate tunneling probability P\n    S_bounce = 2 * S0\n    prob = np.exp(-S_bounce / hbar)\n    \n    return prob\n\nsolve()\n```", "id": "2461167"}]}