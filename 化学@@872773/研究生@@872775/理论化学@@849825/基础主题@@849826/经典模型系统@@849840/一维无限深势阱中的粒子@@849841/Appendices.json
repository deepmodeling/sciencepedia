{"hands_on_practices": [{"introduction": "虽然一维势箱模型存在精确解，但它也为检验量子力学中的近似方法提供了一个理想的实验平台。变分原理是一种强大的工具，能够为任何量子体系的基态能量提供一个严格的上限。本练习将引导你应用变分原理，使用一个包含可调参数 $\\beta$ 的试探波函数，通过优化该参数来寻找基态能量的最佳上界[@problem_id:2792826]。这个过程不仅能加深你对变分法的理解，还能锻炼处理更复杂哈密顿量的关键分析技巧。", "problem": "一个质量为 $m$ 的粒子被限制在区间 $x \\in [0,L]$ 上的一维无限深势阱（箱中粒子）中，势能为 $V(x)=0$（当 $0  x  L$ 时）和 $V(x)=+\\infty$（其他情况）。使用试探波函数 $\\psi_{\\beta}(x) = x(L-x)\\exp(-\\beta x)$（其中 $\\beta$ 是一个实变分参数），通过最小化能量期望值来计算基态能量的变分上界。", "solution": "该系统是一个在一维无限深势阱 $x \\in [0,L]$ 中的粒子，区间内 $V(x)=0$，区间外 $V(x)=+\\infty$，因此容许的波函数必须满足 $\\psi(0)=\\psi(L)=0$。势阱内的哈密顿量为 $H=-\\frac{\\hbar^{2}}{2m}\\frac{d^{2}}{dx^{2}}$。瑞利-里兹变分原理指出，对于任意归一化的容许波函数 $\\psi$，其期望值 $E[\\psi]=\\dfrac{\\langle \\psi|H|\\psi\\rangle}{\\langle \\psi|\\psi\\rangle}$ 满足 $E[\\psi]\\ge E_{0}$，其中 $E_{0}$ 是精确的基态能量。\n\n对于实试探函数 $\\psi_{\\beta}(x)=x(L-x)\\exp(-\\beta x)$，能量泛函为\n$$\nE(\\beta)=\\frac{\\displaystyle \\int_{0}^{L}\\psi_{\\beta}(x)\\left(-\\frac{\\hbar^{2}}{2m}\\frac{d^{2}}{dx^{2}}\\right)\\psi_{\\beta}(x)\\,dx}{\\displaystyle \\int_{0}^{L} \\psi_{\\beta}(x)^{2}\\,dx}.\n$$\n利用 $\\psi_{\\beta}(0)=\\psi_{\\beta}(L)=0$ 进行分部积分可得\n$$\n\\int_{0}^{L}\\psi_{\\beta}(x)\\left(-\\frac{d^{2}}{dx^{2}}\\psi_{\\beta}(x)\\right)\\,dx=\\int_{0}^{L}\\left(\\frac{d\\psi_{\\beta}}{dx}\\right)^{2}\\,dx,\n$$\n因为边界项 $-\\psi_{\\beta}\\,\\psi_{\\beta}'\\big|_{0}^{L}$为零。因此，\n$$\nE(\\beta)=\\frac{\\hbar^{2}}{2m}\\,\\frac{\\displaystyle \\int_{0}^{L}\\left(\\frac{d\\psi_{\\beta}}{dx}\\right)^{2} dx}{\\displaystyle \\int_{0}^{L}\\psi_{\\beta}(x)^{2}\\,dx}.\n$$\n这将问题简化为计算初等函数的积分。\n\n为了揭示尺度关系并减少参数，定义无量纲坐标 $y=x/L$（因此 $y\\in[0,1]$）、无量纲参数 $t=\\beta L$，并写出 $x=L y$。那么\n$$\n\\psi_{\\beta}(x)=L^{2}\\,y(1-y)\\,\\exp(-t y),\n$$\n以及\n$$\n\\frac{d\\psi_{\\beta}}{dx}=\\frac{1}{L}\\frac{d}{dy}\\left(L^{2}y(1-y)\\exp(-t y)\\right)=L\\,\\frac{d}{dy}\\left(y(1-y)\\exp(-t y)\\right).\n$$\n因此，\n$$\n\\int_{0}^{L}\\psi_{\\beta}(x)^{2}\\,dx=L^{5}\\int_{0}^{1} y^{2}(1-y)^{2}\\,\\exp(-2 t y)\\,dy\\equiv L^{5}\\,I_{0}(t),\n$$\n以及\n$$\n\\int_{0}^{L}\\left(\\frac{d\\psi_{\\beta}}{dx}\\right)^{2}\\,dx=L^{3}\\int_{0}^{1}\\left[\\frac{d}{dy}\\left(y(1-y)\\exp(-t y)\\right)\\right]^{2}dy\\equiv L^{3}\\,I_{1}(t).\n$$\n因此，变分能量可以写成\n$$\nE(\\beta)=\\frac{\\hbar^{2}}{2m}\\,\\frac{L^{3} I_{1}(t)}{L^{5} I_{0}(t)}=\\frac{\\hbar^{2}}{2m L^{2}}\\;\\frac{I_{1}(t)}{I_{0}(t)}\\equiv \\frac{\\hbar^{2}}{2m L^{2}}\\,F(t),\n$$\n其中\n$$\nI_{0}(t)=\\int_{0}^{1} y^{2}(1-y)^{2}\\,\\exp(-2 t y)\\,dy,\\qquad I_{1}(t)=\\int_{0}^{1}\\left[\\frac{d}{dy}\\left(y(1-y)\\exp(-t y)\\right)\\right]^{2}dy.\n$$\n$I_{1}(t)$ 内的导数为\n$$\n\\frac{d}{dy}\\left(y(1-y)\\exp(-t y)\\right)=\\exp(-t y)\\left[(1-2y)-t\\,y(1-y)\\right],\n$$\n所以\n$$\nI_{1}(t)=\\int_{0}^{1}\\exp(-2 t y)\\left[(1-2y)-t\\,y(1-y)\\right]^{2}dy.\n$$\n\n接下来，我们分析关于 $t$（等价于关于 $\\beta$）的优化。考虑反射变换 $y\\mapsto 1-y$（等价于 $x\\mapsto L-x$）。在此变换下，\n$$\n\\psi_{\\beta}(L-x)=(L-x)\\,x\\,\\exp\\!\\left(-\\beta(L-x)\\right)=\\exp(-\\beta L)\\,x(L-x)\\,\\exp(+\\beta x)\\propto \\psi_{-\\beta}(x).\n$$\n由于能量泛函仅通过归一化比率 $\\langle \\psi|H|\\psi\\rangle/\\langle\\psi|\\psi\\rangle$ 依赖于试探函数，任何总体的常数因子都会在分子和分母之间消去。由于哈密顿量和定义域在 $x\\mapsto L-x$ 变换下不变，能量必须满足\n$$\nE(\\beta)=E(-\\beta),\n$$\n即 $F(t)$ 是 $t$ 的偶函数。因此 $t=0$ 是一个驻点。\n\n为了确定 $t=0$ 是一个最小值，我们将 $F(t)$ 展开到 $t^{2}$ 阶，并证明二次项系数为正。记\n$$\nA(y)=1-2y,\\qquad B(y)=y(1-y).\n$$\n那么\n$$\nI_{0}(t)=\\int_{0}^{1} B(y)^{2}\\,\\exp(-2 t y)\\,dy,\\qquad I_{1}(t)=\\int_{0}^{1}\\left[A(y)-t B(y)\\right]^{2}\\exp(-2 t y)\\,dy.\n$$\n将 $\\exp(-2 t y)=1-2 t y+2 t^{2} y^{2}+\\mathcal{O}(t^{3})$ 展开并保留到 $t^{2}$ 阶的项，可得\n$$\nI_{0}(t)=\\int_{0}^{1}\\left[B^{2}-2 t\\,y B^{2}+2 t^{2} y^{2} B^{2}\\right]dy+\\mathcal{O}(t^{3}),\n$$\n$$\nI_{1}(t)=\\int_{0}^{1}\\left[A^{2}-2 t A B+t^{2} B^{2}\\right]\\left(1-2 t y+2 t^{2} y^{2}\\right)dy+\\mathcal{O}(t^{3}).\n$$\n使用在 $[0,1]$ 上的初等积分，\n$$\n\\int_{0}^{1}A^{2}dy=\\frac{1}{3},\\quad \\int_{0}^{1}y A^{2}dy=\\frac{1}{6},\\quad \\int_{0}^{1}y^{2}A^{2}dy=\\frac{2}{15},\n$$\n$$\n\\int_{0}^{1}B^{2}dy=\\frac{1}{30},\\quad \\int_{0}^{1}y B^{2}dy=\\frac{1}{60},\\quad \\int_{0}^{1}y^{2} B^{2}dy=\\frac{1}{105},\n$$\n以及 $\\int_{0}^{1}A B\\,dy=0$, $\\int_{0}^{1}y A B\\,dy=-\\frac{1}{60}$，我们得到\n$$\nI_{0}(t)=\\frac{1}{30}-\\frac{1}{30}t+\\frac{2}{105}t^{2}+\\mathcal{O}(t^{3}),\n$$\n$$\nI_{1}(t)=\\frac{1}{3}-\\frac{1}{3}t+\\frac{7}{30}t^{2}+\\mathcal{O}(t^{3}).\n$$\n构造比率，\n$$\nF(t)=\\frac{I_{1}(t)}{I_{0}(t)}=10\\left[1+\\left(\\frac{7}{10}-\\frac{4}{7}\\right)t^{2}+\\mathcal{O}(t^{3})\\right]=10\\left[1+\\frac{9}{70}t^{2}+\\mathcal{O}(t^{3})\\right].\n$$\n$t^{2}$ 的正系数表明 $t=0$ 是一个严格的局部最小值。根据偶函数性质和平滑性，$t=0$ 是此单参数函数族内的全局最小值点。\n\n因此，最优参数是 $\\beta^{\\star}=0$，在 $t=0$ 时对应的积分为\n$$\nI_{0}(0)=\\int_{0}^{1}y^{2}(1-y)^{2}dy=\\frac{1}{30},\\qquad I_{1}(0)=\\int_{0}^{1}(1-2y)^{2}dy=\\frac{1}{3}.\n$$\n因此\n$$\nF(0)=\\frac{I_{1}(0)}{I_{0}(0)}=\\frac{1/3}{1/30}=10,\n$$\n优化后的基态能量的变分上限为\n$$\nE_{\\mathrm{var,min}}=\\frac{\\hbar^{2}}{2m L^{2}}\\times 10=\\frac{5\\,\\hbar^{2}}{m\\,L^{2}}.\n$$\n这是对精确基态能量的一个严格上限。它大于无限深势阱的精确值，与变分原理一致，并且在此函数族内对 $\\beta$ 的优化选择了对称的成员 $\\beta=0$，这与哈密顿量和定义域的反射对称性所预期的结果相符。", "answer": "$$\\boxed{\\frac{5\\,\\hbar^{2}}{m\\,L^{2}}}$$", "id": "2792826"}, {"introduction": "掌握了静态性质后，我们将转向时间相关的动力学过程。真实世界中的量子体系常常会受到外部环境变化的影响。本练习探讨了两种相对的极限情况：无限缓慢（绝热）和瞬时（骤然）改变势箱的宽度[@problem_id:1410530]。通过对比这两种情形下体系的最终状态和能量，你将对绝热定理以及量子态在骤然微扰下的投影行为获得更深刻的物理直觉。", "problem": "一个质量为 $m$ 的粒子最初处于一维无限深势阱的基态，该势阱由 $V(x)=0$（对于 $0  x  L$）和 $V(x)=\\infty$（其他情况）定义。粒子的初始能量为 $E_{init}$。通过移动右壁，势阱宽度被扩大到新的长度 $2L$。我们将比较此扩张过程的两种不同情况。\n\n**情况A（绝热膨胀）：** 势阱壁从 $x=L$ 无限缓慢地移动到 $x=2L$。设此情况下粒子的末态能量为 $E_{final,A}$。\n\n**情况B（突发膨胀）：** 势阱壁从 $x=L$ 瞬间移动到 $x=2L$。膨胀后瞬间，粒子的状态是新的、更宽势阱的本征态 $\\phi_n(x)$ 的叠加。对于每个 $n=1, 2, 3, \\ldots$，设 $P_n$ 是在能量为 $E'_n$ 的第 $n$ 个本征态 $\\phi_n$ 中找到粒子的概率。\n\n设 $\\phi_j$ 和 $\\phi_k$ 是突发膨胀后粒子最可能占据的两个特定本征态，其对应概率为 $P_j$ 和 $P_k$，满足对于所有其他态 $m \\neq j, k$，有 $P_j > P_k > P_m$。能量的期望值，在粒子处于这两个态所张成的子空间的条件下，由 $\\bar{E}_{jk} = \\frac{P_j E'_j + P_k E'_k}{P_j + P_k}$ 给出。\n\n计算由下式定义的无量纲比率 $\\mathcal{R}$：\n$$\n\\mathcal{R} = \\frac{\\bar{E}_{jk} - E_{final,A}}{E_{init} - E_{final,A}}\n$$\n将您的答案表示为解析闭合形式表达式。", "solution": "宽度为 $a$ 的一维无限深势阱中的定态和能量为 $\\psi_{n}^{(a)}(x)=\\sqrt{2/a}\\,\\sin(n\\pi x/a)$，能量为 $E_{n}(a)=n^{2}\\pi^{2}\\hbar^{2}/(2ma^{2})$。最初，对于宽度为 $L$ 的势阱，粒子处于基态，能量为\n$$\nE_{init}=E_{1}(L)=\\frac{\\pi^{2}\\hbar^{2}}{2mL^{2}}.\n$$\n在绝热膨胀到宽度 $2L$ 的过程中，量子数保持不变，因此粒子仍处于新势阱的基态，并且\n$$\nE_{final,A}=E_{1}(2L)=\\frac{\\pi^{2}\\hbar^{2}}{2m(2L)^{2}}=\\frac{1}{4}E_{init}.\n$$\n对于突发膨胀到宽度 $2L$ 的情况，新的本征态为 $\\phi_{n}(x)=\\sqrt{2/(2L)}\\sin(n\\pi x/(2L))=\\sqrt{1/L}\\sin(n\\pi x/(2L))$，能量为\n$$\nE'_{n}=E_{n}(2L)=\\frac{n^{2}\\pi^{2}\\hbar^{2}}{2m(2L)^{2}}=\\frac{n^{2}}{4}E_{init}.\n$$\n与初始态 $\\psi_{1}^{(L)}(x)=\\sqrt{2/L}\\sin(\\pi x/L)$ 的交叠系数为\n$$\nc_{n}=\\int_{0}^{2L}\\phi_{n}(x)\\psi_{1}^{(L)}(x)\\,dx=\\frac{\\sqrt{2}}{L}\\int_{0}^{L}\\sin\\!\\left(\\frac{\\pi x}{L}\\right)\\sin\\!\\left(\\frac{n\\pi x}{2L}\\right)dx.\n$$\n令 $u=x/L$，\n$$\nc_{n}=\\sqrt{2}\\int_{0}^{1}\\sin(\\pi u)\\sin\\!\\left(\\frac{n\\pi u}{2}\\right)du.\n$$\n使用 $\\sin A\\sin B=\\frac{1}{2}\\left[\\cos(A-B)-\\cos(A+B)\\right]$，\n$$\nc_{n}=\\frac{\\sqrt{2}}{2}\\left[\\frac{\\sin\\!\\big(\\pi(1-\\tfrac{n}{2})\\big)}{\\pi(1-\\tfrac{n}{2})}-\\frac{\\sin\\!\\big(\\pi(1+\\tfrac{n}{2})\\big)}{\\pi(1+\\tfrac{n}{2})}\\right].\n$$\n对于 $n\\neq 2$，使用 $\\sin(\\pi(1\\mp n/2))=\\pm\\sin(\\pi n/2)$ 得到\n$$\nc_{n}=\\frac{4\\sqrt{2}}{\\pi}\\,\\frac{\\sin(\\pi n/2)}{4-n^{2}},\\quad n\\neq 2,\n$$\n而对于 $n=2$，\n$$\nc_{2}=\\sqrt{2}\\int_{0}^{1}\\sin^{2}(\\pi u)\\,du=\\frac{\\sqrt{2}}{2}.\n$$\n因此，概率为\n$$\nP_{2}=|c_{2}|^{2}=\\frac{1}{2},\\quad P_{n}=|c_{n}|^{2}=\\frac{32}{\\pi^{2}}\\frac{\\sin^{2}(\\pi n/2)}{(4-n^{2})^{2}}\\ \\text{对于}\\ n\\neq 2.\n$$\n因此对于偶数 $n\\neq 2$，$P_{n}=0$；对于奇数 $n$，有 $\\sin^{2}(\\pi n/2)=1$，所以特别地\n$$\nP_{1}=\\frac{32}{9\\pi^{2}},\\quad P_{3}=\\frac{32}{25\\pi^{2}},\\ \\ldots\n$$\n因此，两个最可能的态是 $j=2$ 和 $k=1$，且对于所有 $m\\neq 1,2$，有 $P_{2}P_{1}P_{m}$。它们的能量是 $E'_{2}=E_{init}$ 和 $E'_{1}=E_{init}/4=E_{final,A}$。条件期望值为\n$$\n\\bar{E}_{21}=\\frac{P_{2}E'_{2}+P_{1}E'_{1}}{P_{2}+P_{1}}=E_{init}\\,\\frac{P_{2}+\\tfrac{1}{4}P_{1}}{P_{2}+P_{1}}.\n$$\n该比率为\n$$\n\\mathcal{R}=\\frac{\\bar{E}_{21}-E_{final,A}}{E_{init}-E_{final,A}}=\\frac{E_{init}\\left(\\frac{P_{2}+\\tfrac{1}{4}P_{1}}{P_{2}+P_{1}}-\\frac{1}{4}\\right)}{\\frac{3}{4}E_{init}}=\\frac{P_{2}}{P_{1}+P_{2}}.\n$$\n代入 $P_{2}=\\frac{1}{2}$ 和 $P_{1}=\\frac{32}{9\\pi^{2}}$，\n$$\n\\mathcal{R}=\\frac{\\frac{1}{2}}{\\frac{1}{2}+\\frac{32}{9\\pi^{2}}}=\\frac{1}{1+\\frac{64}{9\\pi^{2}}}=\\frac{9\\pi^{2}}{9\\pi^{2}+64}.\n$$\n这是一个解析闭合形式表达式。", "answer": "$$\\boxed{\\frac{9\\pi^{2}}{9\\pi^{2}+64}}$$", "id": "1410530"}, {"introduction": "为了连接解析理论与计算实践，我们必须掌握数值求解方法。对于绝大多数实际势场，薛定谔方程无法解析求解。有限差分法是一种基础而强大的数值技术，它将微分方程转化为可以在计算机上求解的矩阵本征值问题[@problem_id:2913789]。本练习将指导你从头推导该方法，通过编程实现它，并对照已知的精确解来评估其准确性，从而为你奠定计算化学领域的一项基本技能。", "problem": "考虑一个质量为 $m$ 的非相对论粒子，被限制在 $x=0$ 和 $x=L$ 处具有无限高势垒的一维区间 $(0,L)$ 内。势阱内定态所满足的不含时薛定谔方程是一个齐次二阶线性常微分方程\n$$\n-\\frac{\\hbar^2}{2m}\\frac{d^2\\psi(x)}{dx^2}=E\\,\\psi(x),\\quad x\\in(0,L),\n$$\n其服从狄利克雷边界条件 $\\psi(0)=0$ 和 $\\psi(L)=0$。仅从此微分方程和边界条件出发，在 $(0,L)$ 内部间距为 $h$ 的均匀网格上，构建动能算符的二阶精确有限差分（FD）离散化。你的推导必须使用关于内部网格点的泰勒展开，并需要证明局部截断误差的量级为 $\\mathcal{O}(h^2)$。\n\n根据你的离散化，构建一个近似于该连续问题的有限维对称矩阵特征值问题。然后，针对下方的每个给定测试用例，实现一个程序，该程序能够：\n- 在 $M$ 个内部网格点上构建离散动能算符矩阵（$M$ 是内部点的数量；均匀间距为 $h=L/(M+1)$）。\n- 求解所得的对称矩阵特征值问题，并提取第 $n$ 个（按升序排列的）特征值 $E_{n,h}$。\n- 根据一维箱中粒子问题的薛定谔方程解析解，计算相同 $n$、$L$ 和 $m$ 对应的精确连续谱能量 $E_n$。\n- 返回绝对离散化误差 $|E_{n,h}-E_n|$。\n\n使用的物理常数：\n- 约化普朗克常数 $\\hbar = 1.054571817\\times 10^{-34}\\,\\mathrm{J\\cdot s}$。\n- 基本电荷 $e = 1.602176634\\times 10^{-19}\\,\\mathrm{C}$（精确值），用于通过 $1\\,\\mathrm{eV}=e\\,\\mathrm{J}$ 将焦耳转换为电子伏特。\n- 电子质量 $m_{\\mathrm{e}}=9.1093837015\\times 10^{-31}\\,\\mathrm{kg}$。\n\n所有能量和能量误差必须以电子伏特（eV）表示。对于每个测试用例，你的程序必须计算以 $\\mathrm{eV}$ 为单位的绝对离散化误差 $|E_{n,h}-E_n|$，并输出四舍五入到 $10$ 位小数的结果。\n\n测试套件（每个用例是一个四元组 $(L\\,[\\mathrm{m}],\\,m\\,[\\mathrm{kg}],\\,n,\\,M)$）：\n1. $(1.0\\times 10^{-9},\\,9.1093837015\\times 10^{-31},\\,1,\\,10)$\n2. $(1.0\\times 10^{-9},\\,9.1093837015\\times 10^{-31},\\,1,\\,20)$\n3. $(1.0\\times 10^{-9},\\,9.1093837015\\times 10^{-31},\\,1,\\,40)$\n4. $(1.0\\times 10^{-9},\\,9.1093837015\\times 10^{-31},\\,3,\\,120)$\n5. $(1.0\\times 10^{-9},\\,9.1093837015\\times 10^{-31},\\,5,\\,200)$\n6. $(0.5\\times 10^{-9},\\,9.1093837015\\times 10^{-31},\\,1,\\,40)$\n7. $(1.0\\times 10^{-9},\\,9.1093837015\\times 10^{-31},\\,8,\\,10)$\n\n最终输出格式要求：\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果的顺序与上述测试用例相同。例如，输出必须如下所示\n$$\n[\\text{result}_1,\\text{result}_2,\\ldots,\\text{result}_7],\n$$\n其中每个 $\\text{result}_k$ 是一个十进制数，表示以 $\\mathrm{eV}$ 为单位的 $|E_{n,h}-E_n|$，四舍五入到 $10$ 位小数。", "solution": "该问题要求推导一种求解一维箱中粒子不含时薛定谔方程的数值方法，并实现该方法以计算若干测试用例的离散化误差。\n\n首先，我们推导动能算符的有限差分近似。薛定谔方程由下式给出：\n$$\n-\\frac{\\hbar^2}{2m}\\frac{d^2\\psi(x)}{dx^2} = E\\psi(x) \\quad \\text{for } x \\in (0, L)\n$$\n其边界条件为 $\\psi(0)=0$ 和 $\\psi(L)=0$。\n\n我们将区间 $(0,L)$ 离散化为 $M+1$ 个等长的线段，长度为 $h = L/(M+1)$。这定义了一个包含 $M+2$ 个点的网格 $x_i = i \\cdot h$，其中 $i=0, 1, \\dots, M+1$。内部点为 $x_1, \\dots, x_M$。在网格点 $x_i$ 处的波函数记为 $\\psi_i \\equiv \\psi(x_i)$。根据边界条件，有 $\\psi_0 = 0$ 和 $\\psi_{M+1} = 0$。\n\n为了近似内部网格点 $x_i$ 处的二阶导数 $\\frac{d^2\\psi}{dx^2}$，我们使用 $\\psi(x)$ 在 $x_i$ 点的泰勒级数展开：\n$$\n\\psi(x_i + h) = \\psi(x_i) + h \\psi'(x_i) + \\frac{h^2}{2!} \\psi''(x_i) + \\frac{h^3}{3!} \\psi'''(x_i) + \\frac{h^4}{4!} \\psi^{(4)}(x_i) + \\mathcal{O}(h^5)\n$$\n$$\n\\psi(x_i - h) = \\psi(x_i) - h \\psi'(x_i) + \\frac{h^2}{2!} \\psi''(x_i) - \\frac{h^3}{3!} \\psi'''(x_i) + \\frac{h^4}{4!} \\psi^{(4)}(x_i) - \\mathcal{O}(h^5)\n$$\n用网格点表示法，即为：\n$$\n\\psi_{i+1} = \\psi_i + h \\psi'(x_i) + \\frac{h^2}{2} \\psi''(x_i) + \\frac{h^3}{6} \\psi'''(x_i) + \\frac{h^4}{24} \\psi^{(4)}(x_i) + \\mathcal{O}(h^5)\n$$\n$$\n\\psi_{i-1} = \\psi_i - h \\psi'(x_i) + \\frac{h^2}{2} \\psi''(x_i) - \\frac{h^3}{6} \\psi'''(x_i) + \\frac{h^4}{24} \\psi^{(4)}(x_i) - \\mathcal{O}(h^5)\n$$\n将这两个方程相加，可以消去所有 $h$ 的奇次幂项：\n$$\n\\psi_{i+1} + \\psi_{i-1} = 2\\psi_i + h^2 \\psi''(x_i) + \\frac{h^4}{12} \\psi^{(4)}(x_i) + \\mathcal{O}(h^6)\n$$\n整理方程以求解二阶导数 $\\psi''(x_i)$：\n$$\n\\psi''(x_i) = \\frac{\\psi_{i+1} - 2\\psi_i + \\psi_{i-1}}{h^2} - \\frac{h^2}{12} \\psi^{(4)}(x_i) + \\mathcal{O}(h^4)\n$$\n因此，二阶导数的中心有限差分近似为：\n$$\n\\frac{d^2\\psi}{dx^2}\\bigg|_{x=x_i} \\approx \\frac{\\psi_{i+1} - 2\\psi_i + \\psi_{i-1}}{h^2}\n$$\n局部截断误差（LTE）是精确导数与其近似值之间的差：\n$$\n\\text{LTE} = \\psi''(x_i) - \\left( \\frac{\\psi_{i+1} - 2\\psi_i + \\psi_{i-1}}{h^2} \\right) = - \\frac{h^2}{12} \\psi^{(4)}(x_i) + \\mathcal{O}(h^4)\n$$\n首项误差与 $h^2$ 成正比，因此这是一个二阶精确的格式，符合要求。\n\n现在，我们将此近似代入每个内部网格点 $x_i$（$i = 1, \\dots, M$）的薛定谔方程中：\n$$\n-\\frac{\\hbar^2}{2m} \\left( \\frac{\\psi_{i+1} - 2\\psi_i + \\psi_{i-1}}{h^2} \\right) = E_h \\psi_i\n$$\n其中 $E_h$ 是能量特征值的数值近似。整理各项，我们得到：\n$$\n-\\frac{\\hbar^2}{2mh^2} \\psi_{i-1} + \\frac{2\\hbar^2}{2mh^2} \\psi_i - \\frac{\\hbar^2}{2mh^2} \\psi_{i+1} = E_h \\psi_i\n$$\n这代表了一个关于值 $\\psi_1, \\dots, \\psi_M$ 的 $M$ 个耦合线性方程组。\n对于 $i=1$：$-\\frac{\\hbar^2}{2mh^2}\\psi_0 + \\frac{\\hbar^2}{mh^2}\\psi_1 - \\frac{\\hbar^2}{2mh^2}\\psi_2 = E_h \\psi_1$。由于 $\\psi_0=0$，方程变为 $\\frac{\\hbar^2}{mh^2}\\psi_1 - \\frac{\\hbar^2}{2mh^2}\\psi_2 = E_h \\psi_1$。\n对于 $i=M$：$-\\frac{\\hbar^2}{2mh^2}\\psi_{M-1} + \\frac{\\hbar^2}{mh^2}\\psi_M - \\frac{\\hbar^2}{2mh^2}\\psi_{M+1} = E_h \\psi_M$。由于 $\\psi_{M+1}=0$，方程变为 $-\\frac{\\hbar^2}{2mh^2}\\psi_{M-1} + \\frac{\\hbar^2}{mh^2}\\psi_M = E_h \\psi_M$。\n\n这个方程组可以写成矩阵特征值问题 $\\mathbf{H}\\vec{\\psi} = E_h \\vec{\\psi}$，其中 $\\vec{\\psi} = [\\psi_1, \\psi_2, \\dots, \\psi_M]^T$ 是内部网格点上波函数值的向量，而 $\\mathbf{H}$ 是 $M \\times M$ 的离散哈密顿矩阵。$\\mathbf{H}$ 的矩阵元为：\n$$\nH_{ij} = \\begin{cases} \\frac{\\hbar^2}{mh^2}  \\text{if } i=j \\\\ -\\frac{\\hbar^2}{2mh^2}  \\text{if } |i-j|=1 \\\\ 0  \\text{otherwise} \\end{cases}\n$$\n该矩阵可表示为：\n$$\n\\mathbf{H} = \\frac{\\hbar^2}{2mh^2}\n\\begin{pmatrix}\n2  -1  0  \\cdots  0 \\\\\n-1  2  -1  \\cdots  0 \\\\\n0  -1  2  \\ddots  \\vdots \\\\\n\\vdots  \\vdots  \\ddots  \\ddots  -1 \\\\\n0  0  \\cdots  -1  2\n\\end{pmatrix}\n$$\n这是一个实对称三对角矩阵。求解该特征值问题可得到 $M$ 个特征值 $E_{n,h}$ 和对应的特征向量 $\\vec{\\psi}_n$，其中 $n=1, \\dots, M$。这些是连续系统前 $M$ 个能级和波函数的数值近似。\n\n一维箱中粒子问题的连续能量特征值的解析解为：\n$$\nE_n = \\frac{n^2 \\pi^2 \\hbar^2}{2mL^2}, \\quad n=1, 2, 3, \\dots\n$$\n程序将求解矩阵 $\\mathbf{H}$ 的特征值问题以找到数值特征值 $E_{n,h}$，计算相应的精确特征值 $E_n$，并计算绝对误差 $|E_{n,h} - E_n|$。所有能量都必须通过除以基本电荷 $e$ 从焦耳（Joule）转换为电子伏特（eV）。所需的物理常数为 $\\hbar = 1.054571817 \\times 10^{-34}\\,\\mathrm{J\\cdot s}$，$m_{\\mathrm{e}}=9.1093837015\\times 10^{-31}\\,\\mathrm{kg}$ 和 $e = 1.602176634\\times 10^{-19}\\,\\mathrm{C}$。\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh_tridiagonal\n\ndef solve():\n    \"\"\"\n    Solves the particle in a box problem using a finite difference method\n    and computes the absolute error against the exact analytical solution.\n    \"\"\"\n    # Define physical constants as specified.\n    HBAR = 1.054571817e-34  # J*s\n    E_CHARGE = 1.602176634e-19  # C (for J to eV conversion)\n    M_E = 9.1093837015e-31  # kg (electron mass)\n    J_PER_EV = E_CHARGE # Joules per electronvolt\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (L [m], m [kg], n, M)\n        (1.0e-9, M_E, 1, 10),\n        (1.0e-9, M_E, 1, 20),\n        (1.0e-9, M_E, 1, 40),\n        (1.0e-9, M_E, 3, 120),\n        (1.0e-9, M_E, 5, 200),\n        (0.5e-9, M_E, 1, 40),\n        (1.0e-9, M_E, 8, 10),\n    ]\n\n    results = []\n    for L, m, n, M in test_cases:\n        # Calculate the uniform grid spacing h.\n        h = L / (M + 1)\n        \n        # Construct the tridiagonal Hamiltonian matrix H.\n        # The matrix is H = (hbar^2 / (2*m*h^2)) * Tridiag(-1, 2, -1).\n        # We can implement this for eigh_tridiagonal by defining the main\n        # and off-diagonal vectors.\n        \n        # Main diagonal elements: hbar^2 / (m * h^2)\n        main_diag_val = HBAR**2 / (m * h**2)\n        main_diag = np.full(M, main_diag_val)\n        \n        # Off-diagonal elements: -hbar^2 / (2 * m * h^2)\n        off_diag_val = -HBAR**2 / (2 * m * h**2)\n        off_diag = np.full(M - 1, off_diag_val)\n        \n        # Solve the eigenvalue problem for the symmetric tridiagonal matrix.\n        # eigh_tridiagonal is highly efficient and returns eigenvalues sorted in\n        # ascending order. The energies are in Joules.\n        eigenvalues_J, _ = eigh_tridiagonal(main_diag, off_diag)\n        \n        # Select the n-th numerical eigenvalue (using 0-based indexing).\n        # The problem uses 1-based indexing for n (n-th eigenvalue).\n        E_nh_J = eigenvalues_J[n - 1]\n        \n        # Calculate the exact analytical energy for the n-th state.\n        E_n_J = (n**2 * np.pi**2 * HBAR**2) / (2 * m * L**2)\n        \n        # Convert energies from Joules to electronvolts (eV).\n        E_nh_eV = E_nh_J / J_PER_EV\n        E_n_eV = E_n_J / J_PER_EV\n        \n        # Compute the absolute discretization error in eV.\n        absolute_error_eV = abs(E_nh_eV - E_n_eV)\n        \n        # Append the rounded result to the list.\n        results.append(f\"{absolute_error_eV:.10f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\n# This part is for execution and obtaining the answer. It will not be in the final XML.\n# solve()\n```", "answer": "[0.0000762956,0.0000190772,0.0000047696,0.0001026040,0.0002165089,0.0000190786,0.1197779919]", "id": "2913789"}]}