{"hands_on_practices": [{"introduction": "我们将从一个最基础的模型入手，来练习正则系综的核心方法。这个练习考虑一个只有两个能级的简化系统，例如一个生物大分子的折叠与去折叠状态。通过为这个简单系统构建配分函数并计算其平均能量，我们可以清晰地看到微观能级信息是如何通过统计力学的框架与宏观热力学量（如能量）直接联系起来的 [@problem_id:1996069]。这是理解正则系综的第一步，也是最重要的一步。", "problem": "一个简化的玩具模型被用来描述单个生物大分子的构象变化。该分子只能存在于两种不同的状态：紧凑的折叠态和伸展的展开态。折叠态被视作基态，其能量为零。展开态的形成需要能量输入，因此其能量为 $\\epsilon$，其中 $\\epsilon  0$。该大分子浸在一个保持恒定绝对温度 $T$ 的大热浴中。\n\n基于此模型，推导单个此类大分子的平均能量 $\\langle E \\rangle$ 的表达式。你的最终答案应该是一个关于能量差 $\\epsilon$、温度 $T$ 和玻尔兹曼常数 $k_B$ 的闭合形式解析表达式。", "solution": "该大分子有两个能级：折叠态的能量为 $E_{0}=0$，展开态的能量为 $E_{1}=\\epsilon$，其中 $\\epsilon0$。在与绝对温度为 $T$ 的热浴接触时，适用的系综是正则系综。定义 $\\beta=\\frac{1}{k_{B}T}$。能量为 $E_{i}$ 的状态的玻尔兹曼权重为 $\\exp(-\\beta E_{i})$，配分函数是所有状态的这些权重之和：\n$$\nZ=\\sum_{i}\\exp(-\\beta E_{i})=\\exp(-\\beta\\cdot 0)+\\exp(-\\beta\\epsilon)=1+\\exp(-\\beta\\epsilon).\n$$\n处于状态 $i$ 的概率为 $p_{i}=\\frac{\\exp(-\\beta E_{i})}{Z}$。因此，平均能量为\n$$\n\\langle E\\rangle=\\sum_{i}E_{i}p_{i}=0\\cdot\\frac{\\exp(0)}{Z}+\\epsilon\\cdot\\frac{\\exp(-\\beta\\epsilon)}{Z}=\\epsilon\\,\\frac{\\exp(-\\beta\\epsilon)}{1+\\exp(-\\beta\\epsilon)}.\n$$\n为简化起见，分子和分母同乘以 $\\exp(\\beta\\epsilon)$：\n$$\n\\langle E\\rangle=\\epsilon\\,\\frac{1}{\\exp(\\beta\\epsilon)+1}.\n$$\n代入 $\\beta=\\frac{1}{k_{B}T}$ 得到关于 $\\epsilon$、$T$ 和 $k_{B}$ 的闭合形式表达式：\n$$\n\\langle E\\rangle=\\frac{\\epsilon}{1+\\exp\\left(\\frac{\\epsilon}{k_{B}T}\\right)}.\n$$\n此结果与极限情况一致：当 $T\\to 0$ 时，得到 $\\langle E\\rangle\\to 0$；当 $T\\to\\infty$ 时，得到 $\\langle E\\rangle\\to \\frac{\\epsilon}{2}$。", "answer": "$$\\boxed{\\frac{\\epsilon}{1+\\exp\\left(\\frac{\\epsilon}{k_{B}T}\\right)}}$$", "id": "1996069"}, {"introduction": "掌握了基础模型后，我们可以向更复杂的真实系统迈进。这个实践问题引入了能级简并和外场导致的能级分裂，这些都是在真实物理系统中常见的现象。你的任务是推导该系统在高温极限下的定容热容 $C_V$，这是一个衡量系统能量如何随温度变化的响应函数 [@problem_id:118084]。通过这个练习，你将学会处理更复杂的配分函数，并运用泰勒展开等近似方法，进一步体会配分函数作为连接微观与宏观桥梁的强大功能。", "problem": "一个固体包含 $N$ 个可分辨的、无相互作用的原子。每个原子的能级可按如下方式建模。存在一个能量为 $E_0=0$ 的非简并基态。此外还有一组激发态，在没有任何外场的情况下，这些激发态是 $g$ 重简并的，能量为 $\\epsilon  0$。我们假设 $g$ 是一个奇数，因此可以写成 $g=2m+1$，其中 $m$ 为某个非负整数。\n\n一个外场施加到该固体上，部分地解除了激发态的简并。这 $g$ 个激发能级现在围绕原始能量 $\\epsilon$ 对称地分裂，新的能量由下式给出\n$$ E_j = \\epsilon + j\\delta $$\n其中 $j = -m, -m+1, \\dots, m$。参数 $\\delta$ 是一个由场强决定的小的正能量分裂常数。\n\n系统与温度为 $T$ 的热浴处于热平衡状态。在高温极限下（$k_B T \\gg \\epsilon, k_B T \\gg g\\delta$），求这个由 $N$ 个原子组成的系统的定容热容 $C_V$。你的答案应该是高温展开中的首个非零项。用 $N$、$g$、$\\epsilon$、$\\delta$、温度 $T$ 以及玻尔兹曼常数 $k_B$ 将你的结果表示为单个闭合形式的表达式。", "solution": "该系统由 $N$ 个可分辨的、无相互作用的原子组成。单个原子的配分函数 $z$ 由下式给出：\n\n$$\nz = 1 + \\sum_{j=-m}^{m} e^{-E_j / (k_B T)},\n$$\n\n其中 $E_j = \\epsilon + j\\delta$，$j = -m, -m+1, \\dots, m$，$g = 2m+1$ 是未分裂激发态的简并度。因此，\n\n$$\nz = 1 + e^{-\\epsilon / (k_B T)} \\sum_{j=-m}^{m} e^{-j\\delta / (k_B T)}.\n$$\n\n定义 $\\beta = 1/(k_B T)$。求和 $S = \\sum_{j=-m}^{m} e^{-\\beta j \\delta}$ 关于 $j$ 是对称的。在高温极限下，$\\beta \\epsilon \\ll 1$ 且 $\\beta g \\delta \\ll 1$，因此将 $S$ 对 $\\beta$ 展开到二阶：\n\n$$\nS \\approx \\sum_{j=-m}^{m} \\left(1 - \\beta j \\delta + \\frac{1}{2} (\\beta j \\delta)^2\\right).\n$$\n\n由于对称性，线性项消失，剩下：\n\n$$\nS \\approx \\sum_{j=-m}^{m} \\left(1 + \\frac{1}{2} \\beta^2 j^2 \\delta^2\\right) = g + \\frac{1}{2} \\beta^2 \\delta^2 \\sum_{j=-m}^{m} j^2.\n$$\n\n求和 $\\sum_{j=-m}^{m} j^2 = \\frac{g(g^2 - 1)}{12}$，所以：\n\n$$\nS \\approx g + \\frac{\\beta^2 \\delta^2 g (g^2 - 1)}{24}.\n$$\n\n现在，$z$ 变为：\n\n$$\nz = 1 + e^{-\\beta \\epsilon} \\left( g + \\frac{\\beta^2 \\delta^2 g (g^2 - 1)}{24} \\right).\n$$\n\n展开 $e^{-\\beta \\epsilon} \\approx 1 - \\beta \\epsilon + \\frac{1}{2} \\beta^2 \\epsilon^2$：\n\n$$\nz \\approx 1 + \\left(1 - \\beta \\epsilon + \\frac{1}{2} \\beta^2 \\epsilon^2\\right) \\left( g + \\frac{\\beta^2 \\delta^2 g (g^2 - 1)}{24} \\right).\n$$\n\n相乘并保留至 $\\beta^2$ 的项：\n\n$$\nz \\approx 1 + g - g \\beta \\epsilon + \\frac{g}{2} \\beta^2 \\epsilon^2 + \\frac{\\beta^2 \\delta^2 g (g^2 - 1)}{24}.\n$$\n\n设 $A = 1 + g$，$B = -g \\epsilon$，$C = \\frac{g}{2} \\epsilon^2 + \\frac{\\delta^2 g (g^2 - 1)}{24}$，所以：\n\n$$\nz \\approx A + B \\beta + C \\beta^2.\n$$\n\n$z$ 的对数为：\n\n$$\n\\ln z = \\ln A + \\ln\\left(1 + \\frac{B}{A} \\beta + \\frac{C}{A} \\beta^2\\right) \\approx \\ln A + \\frac{B}{A} \\beta + \\left( \\frac{C}{A} - \\frac{1}{2} \\left( \\frac{B}{A} \\right)^2 \\right) \\beta^2.\n$$\n\n单个原子的内能为 $U_1 = -\\frac{\\partial \\ln z}{\\partial \\beta}$：\n\n$$\nU_1 \\approx -\\left[ \\frac{B}{A} + 2 \\left( \\frac{C}{A} - \\frac{1}{2} \\left( \\frac{B}{A} \\right)^2 \\right) \\beta \\right].\n$$\n\n对于 $N$ 个原子，$U = N U_1$。热容为 $C_V = \\left( \\frac{\\partial U}{\\partial T} \\right)_V$。由于 $\\frac{d\\beta}{dT} = -\\frac{1}{k_B T^2}$：\n\n$$\nC_V = \\left( \\frac{\\partial U}{\\partial \\beta} \\right)_V \\frac{d\\beta}{dT} = N \\left( \\frac{\\partial U_1}{\\partial \\beta} \\right)_V \\left(-\\frac{1}{k_B T^2}\\right).\n$$\n\n代入 $U_1$：\n\n$$\n\\frac{\\partial U_1}{\\partial \\beta} \\approx -2 \\left( \\frac{C}{A} - \\frac{1}{2} \\left( \\frac{B}{A} \\right)^2 \\right),\n$$\n\n所以：\n\n$$\nC_V \\approx N \\left( -2 \\left( \\frac{C}{A} - \\frac{1}{2} \\left( \\frac{B}{A} \\right)^2 \\right) \\right) \\left(-\\frac{1}{k_B T^2}\\right) = \\frac{2N}{k_B T^2} \\left( \\frac{C}{A} - \\frac{1}{2} \\left( \\frac{B}{A} \\right)^2 \\right).\n$$\n\n现在代入 $A = 1 + g$，$B = -g \\epsilon$，$C = \\frac{g}{2} \\epsilon^2 + \\frac{\\delta^2 g (g^2 - 1)}{24}$：\n$$\n\\frac{C}{A} - \\frac{1}{2} \\left( \\frac{B}{A} \\right)^2 = \\frac{ \\frac{g}{2} \\epsilon^2 + \\frac{\\delta^2 g (g^2 - 1)}{24} }{1 + g} - \\frac{1}{2} \\frac{g^2 \\epsilon^2}{(1 + g)^2}\n$$\n合并各项，使用公分母 $(1 + g)^2$：\n$$\n= \\frac{ (1 + g) \\left( \\frac{g}{2} \\epsilon^2 + \\frac{\\delta^2 g (g^2 - 1)}{24} \\right) - \\frac{1}{2} g^2 \\epsilon^2 }{(1 + g)^2}\n$$\n分子为：\n$$\n(1 + g) \\frac{g}{2} \\epsilon^2 + (1 + g) \\frac{\\delta^2 g (g^2 - 1)}{24} - \\frac{1}{2} g^2 \\epsilon^2 = \\frac{g}{2} \\epsilon^2 (1 + g - g) + \\frac{\\delta^2 g (g^2 - 1) (1 + g)}{24} = \\frac{g \\epsilon^2}{2} + \\frac{\\delta^2 g (g^2 - 1) (1 + g)}{24}\n$$\n因此：\n$$\n\\frac{C}{A} - \\frac{1}{2} \\left( \\frac{B}{A} \\right)^2 = \\frac{ \\frac{g \\epsilon^2}{2} + \\frac{\\delta^2 g (g^2 - 1) (1 + g)}{24} }{(1 + g)^2} = \\frac{g \\epsilon^2}{2 (1 + g)^2} + \\frac{\\delta^2 g (g^2 - 1)}{24 (1 + g)}\n$$\n代入 $C_V$ 的表达式并化简 $g^2-1$ 项：\n$$\nC_V = \\frac{2N}{k_B T^2} \\left( \\frac{g \\epsilon^2}{2 (1 + g)^2} + \\frac{\\delta^2 g (g - 1)(g+1)}{24 (1 + g)} \\right) = \\frac{N}{k_B T^2} \\left( \\frac{g \\epsilon^2}{(1 + g)^2} + \\frac{g (g - 1) \\delta^2}{12} \\right)\n$$\n这就是高温展开中的首个非零项。", "answer": "$$ \\boxed{ \\frac{N}{k_B T^2} \\left( \\frac{g \\epsilon^2}{(g+1)^2} + \\frac{g(g-1)\\delta^2}{12} \\right) } $$", "id": "118084"}, {"introduction": "除了分析推导，正则系综的原理在现代计算化学中还有着至关重要的应用，尤其是在蒙特卡洛（Monte Carlo）模拟中。这类模拟的目标就是按照正则分布 $P \\propto \\exp(-\\beta U)$ 来对系统的构型空间进行抽样。这个练习将挑战你从理论家转向算法设计者的角色 [@problem_id:2463730]。你需要为一种二元混合物设计一个能够满足细致平衡条件的粒子身份交换步骤，这是确保模拟正确性的核心。这项实践将理论概念与计算方法紧密结合，让你了解如何在实际的计算机模拟中实现正则系综。", "problem": "考虑一个正则（NVT）系综中的经典二元混合物，即物种数量固定的数量-体积-温度（NVT）系综：在一个体积为 $V$、温度为 $T$ 的容器中，有 $N_A$ 个 A 物种粒子和 $N_B$ 个 B 物种粒子，总粒子数为 $N=N_A+N_B$。构型状态可以表示为 $(\\mathbf{r},\\sigma)$，其中 $\\mathbf{r}=(\\mathbf{r}_1,\\ldots,\\mathbf{r}_N)$ 是粒子位置，$\\sigma=(\\sigma_1,\\ldots,\\sigma_N)$ 是物种标签，其中 $\\sigma_i\\in\\{A,B\\}$，且恰好有 $N_A$ 个标签为 A，$N_B$ 个标签为 B。势能为 $U(\\mathbf{r},\\sigma)$，它通过相互作用参数依赖于物种，但在下述移动中没有坐标变换。正则构型概率密度正比于 $\\exp(-\\beta U)$，其中 $\\beta=1/(k_\\mathrm{B}T)$，$k_\\mathrm{B}$ 是玻尔兹曼常数。\n\n你希望用一种身份交换移动来增强标准的蒙特卡洛采样器，该移动交换一个 A 型粒子和一个 B 型粒子的物种标签，同时保持位置 $\\mathbf{r}$ 不变，因此组分 $(N_A,N_B)$ 保持固定。以下哪种设计能确保相对于正则分布满足细致平衡条件？\n\nA. 每次尝试时，从 $N_A$ 个 A 型粒子中均匀随机选择一个 A 粒子，从 $N_B$ 个 B 型粒子中均匀随机选择一个 B 粒子；交换它们的物种标签，计算势能变化 $\\Delta U=U(\\mathbf{r},\\sigma')-U(\\mathbf{r},\\sigma)$，并以概率 $\\min\\{1,\\exp(-\\beta\\,\\Delta U)\\}$ 接受。\n\nB. 每次尝试时，均匀随机选择一个 A 粒子和一个 B 粒子；交换它们的物种标签，并以概率 $\\min\\{1,\\exp[-\\beta(\\Delta U-\\Delta\\mu)]\\}$ 接受，其中 $\\Delta\\mu=\\mu_A-\\mu_B$ 是 A 和 B 之间的化学势差。\n\nC. 每次尝试时，均匀随机选择一个 A 粒子和一个 B 粒子；交换它们的物种标签，并以概率 $\\min\\{1,\\exp(-\\beta\\,\\Delta U)\\,(N_A/N_B)\\}$ 接受，以校正 A 和 B 选择数量上的差异。\n\nD. 每次尝试时，均匀随机选择一个 A 粒子和一个 B 粒子；交换它们的物종标签，当且仅当 $\\Delta U\\le 0$ 时接受，否则拒绝，因为能量增加的移动会违反正则系綜中的能量守恒。", "solution": "为了确保蒙特卡洛移动满足细致平衡条件，我们必须确保从状态 $x$ 到 $x'$ 的转移概率满足：\n$$ p(x) T(x \\to x') = p(x') T(x' \\to x) $$\n其中 $p(x)$ 是平衡概率，$T(x \\to x')$ 是总转移概率，它等于建议概率 $g(x \\to x')$ 与接受概率 $A(x \\to x')$ 的乘积。Metropolis-Hastings 算法给出的接受概率为：\n$$ A(x \\to x') = \\min\\left(1, \\frac{p(x')}{p(x)} \\frac{g(x' \\to x)}{g(x \\to x')}\\right) $$\n在我们的问题中，一个状态由物种标签构型 $\\sigma$ 定义（位置 $\\mathbf{r}$ 不变）。正则系综的概率为 $p(\\sigma) \\propto \\exp[-\\beta U(\\sigma)]$。因此，两个状态的概率比为：\n$$ \\frac{p(\\sigma')}{p(\\sigma)} = \\exp[-\\beta (U(\\sigma') - U(\\sigma))] = \\exp(-\\beta \\Delta U) $$\n移动的建议方案是：“从 $N_A$ 个 A 型粒子中均匀随机选择一个 A 粒子，从 $N_B$ 个 B 型粒子中均匀随机选择一个 B 粒子”。因此，建议交换特定 A 粒子和 B 粒子的概率为 $g(\\sigma \\to \\sigma') = \\frac{1}{N_A} \\times \\frac{1}{N_B}$。逆向移动的建议概率 $g(\\sigma' \\to \\sigma)$ 完全相同，因为在状态 $\\sigma'$ 中，我们仍然是从 $N_A$ 个 A 粒子和 $N_B$ 个 B 粒子中选择。\n由于建议概率是对称的，即 $g(\\sigma' \\to \\sigma) / g(\\sigma \\to \\sigma') = 1$，Metropolis-Hastings 接受概率简化为标准的 Metropolis 准则：\n$$ A(\\sigma \\to \\sigma') = \\min\\left(1, \\frac{p(\\sigma')}{p(\\sigma)}\\right) = \\min\\{1, \\exp(-\\beta \\Delta U)\\} $$\n现在我们评估各个选项：\n*   **A** 选项提出的建议方案和接受概率与我们的推导完全吻合。这是一个对称的建议移动，使用正确的 Metropolis 接受准则。因此，该选项是**正确**的。\n*   **B** 选项引入了化学势差 $\\Delta\\mu$。这只在粒子数可以变化的系综（如巨正则系综）中是正确的。对于固定的 $N_A$ 和 $N_B$ 的正则系综，这是不正确的。\n*   **C** 选项包含一个校正因子 $N_A/N_B$。这种因子只在建议概率不对称时才需要。正如我们所证，本题中的建议概率是对称的，因此这个因子是多余且错误的。\n*   **D** 选项只接受能量降低的移动，这是一种贪心算法，会导致系统陷入局部能量最小值，而不是在有限温度下对正确的玻尔兹曼分布进行抽样。其关于能量守恒的理由也是错误的；正则系综的能量是涨落的，不守恒。", "answer": "$$\\boxed{A}$$", "id": "2463730"}]}