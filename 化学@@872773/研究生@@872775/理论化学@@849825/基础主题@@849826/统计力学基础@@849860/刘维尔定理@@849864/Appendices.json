{"hands_on_practices": [{"introduction": "为了从根本上理解刘维尔定理，我们首先从一个经典且可解的系统——一维谐振子——开始。通过直接追踪相空间中一个初始区域随时间的演化，我们将明确地验证其面积在哈密顿动力学下保持不变 [@problem_id:98440]。这个练习将抽象的定理转化为一个具体的、可计算的结果，从而加深对相空间流不可压缩性的直观理解。", "problem": "一个由质量为 $m$ 的粒子组成的经典系统，被约束在谐振子势 $V(q) = \\frac{1}{2}m\\omega^2q^2$ 的影响下进行一维运动。系统的状态由二维相空间中的一个点 $(q, p)$ 描述，其中 $q$ 是位置，$p$ 是动量。系统的时间演化由哈密顿量 $H(q, p) = \\frac{p^2}{2m} + \\frac{1}{2}m\\omega^2q^2$ 控制。\n\n考虑一个由这类系统组成的系综。在时间 $t=0$ 时，该系综的状态占据相空间中的一个矩形区域，该区域由坐标为 $(q_a, p_a)$、$(q_b, p_a)$、$(q_b, p_b)$ 和 $(q_a, p_b)$ 的四个顶点定义，其中 $q_b > q_a$ 且 $p_b > p_a$。设这个初始区域的面积为 $A_0$。\n\n随着时间的推移，该区域中的每个点都根据哈密顿方程进行演化。因此，该矩形区域将会变形。设在时间 $t > 0$ 时，这个变形区域的面积为 $A(t)$。\n\n通过显式计算矩形顶点的随时间演化，确定比值 $\\frac{A(t)}{A_0}$ 的值。", "solution": "系统的哈密顿量由下式给出：\n\n$$\nH(q, p) = \\frac{p^2}{2m} + \\frac{1}{2} m \\omega^2 q^2\n$$\n\n哈密顿运动方程为：\n\n$$\n\\dot{q} = \\frac{\\partial H}{\\partial p} = \\frac{p}{m}, \\quad \\dot{p} = -\\frac{\\partial H}{\\partial q} = -m \\omega^2 q\n$$\n\n这些方程的解为：\n\n$$\nq(t) = q(0) \\cos(\\omega t) + \\frac{p(0)}{m \\omega} \\sin(\\omega t)\n$$\n\n\n$$\np(t) = p(0) \\cos(\\omega t) - m \\omega q(0) \\sin(\\omega t)\n$$\n\n这可以表示为矩阵形式：\n\n$$\n\\begin{pmatrix} q(t) \\\\ p(t) \\end{pmatrix} = \\begin{pmatrix} \\cos(\\omega t) & \\frac{\\sin(\\omega t)}{m \\omega} \\\\ -m \\omega \\sin(\\omega t) & \\cos(\\omega t) \\end{pmatrix} \\begin{pmatrix} q(0) \\\\ p(0) \\end{pmatrix}\n$$\n\n相空间中的初始矩形区域的顶点为 $(q_a, p_a)$、$(q_b, p_a)$、$(q_b, p_b)$ 和 $(q_a, p_b)$，其中 $q_b > q_a$ 且 $p_b > p_a$。初始面积为：\n\n$$\nA_0 = (q_b - q_a)(p_b - p_a)\n$$\n\n将时间演化应用于每个顶点：\n\n- 位于 $(q_a, p_a)$ 的顶点：\n  \n$$\n  q_1'(t) = q_a \\cos(\\omega t) + \\frac{p_a}{m \\omega} \\sin(\\omega t), \\quad p_1'(t) = -m \\omega q_a \\sin(\\omega t) + p_a \\cos(\\omega t)\n  $$\n\n\n- 位于 $(q_b, p_a)$ 的顶点：\n  \n$$\n  q_2'(t) = q_b \\cos(\\omega t) + \\frac{p_a}{m \\omega} \\sin(\\omega t), \\quad p_2'(t) = -m \\omega q_b \\sin(\\omega t) + p_a \\cos(\\omega t)\n  $$\n\n\n- 位于 $(q_b, p_b)$ 的顶点：\n  \n$$\n  q_3'(t) = q_b \\cos(\\omega t) + \\frac{p_b}{m \\omega} \\sin(\\omega t), \\quad p_3'(t) = -m \\omega q_b \\sin(\\omega t) + p_b \\cos(\\omega t)\n  $$\n\n\n- 位于 $(q_a, p_b)$ 的顶点：\n  \n$$\n  q_4'(t) = q_a \\cos(\\omega t) + \\frac{p_b}{m \\omega} \\sin(\\omega t), \\quad p_4'(t) = -m \\omega q_a \\sin(\\omega t) + p_b \\cos(\\omega t)\n  $$\n\n\n变换后的区域是一个平行四边形。为了求其面积，我们考虑构成该平行四边形的两条边向量：\n\n- 从 $(q_1', p_1')$ 到 $(q_2', p_2')$ 的向量 $\\vec{v}_1$：\n  \n$$\n  \\Delta q_1 = q_2' - q_1' = (q_b - q_a) \\cos(\\omega t), \\quad \\Delta p_1 = p_2' - p_1' = -m \\omega (q_b - q_a) \\sin(\\omega t)\n  $$\n\n\n- 从 $(q_1', p_1')$ 到 $(q_4', p_4')$ 的向量 $\\vec{v}_2$：\n  \n$$\n  \\Delta q_2 = q_4' - q_1' = \\frac{(p_b - p_a)}{m \\omega} \\sin(\\omega t), \\quad \\Delta p_2 = p_4' - p_1' = (p_b - p_a) \\cos(\\omega t)\n  $$\n\n\n平行四边形的面积是叉积的绝对值：\n\n$$\nA(t) = \\left| \\Delta q_1 \\Delta p_2 - \\Delta p_1 \\Delta q_2 \\right|\n$$\n\n代入表达式：\n\n$$\n\\Delta q_1 \\Delta p_2 = (q_b - q_a) \\cos(\\omega t) \\cdot (p_b - p_a) \\cos(\\omega t) = (q_b - q_a)(p_b - p_a) \\cos^2(\\omega t)\n$$\n\n\n$$\n\\Delta p_1 \\Delta q_2 = [-m \\omega (q_b - q_a) \\sin(\\omega t)] \\cdot \\left[ \\frac{(p_b - p_a)}{m \\omega} \\sin(\\omega t) \\right] = - (q_b - q_a)(p_b - p_a) \\sin^2(\\omega t)\n$$\n\n因此，\n\n$$\n\\Delta q_1 \\Delta p_2 - \\Delta p_1 \\Delta q_2 = (q_b - q_a)(p_b - p_a) \\cos^2(\\omega t) - \\left[ - (q_b - q_a)(p_b - p_a) \\sin^2(\\omega t) \\right] = (q_b - q_a)(p_b - p_a) [\\cos^2(\\omega t) + \\sin^2(\\omega t)] = (q_b - q_a)(p_b - p_a)\n$$\n\n因为 $q_b > q_a$ 且 $p_b > p_a$，所以该表达式为正，因此：\n\n$$\nA(t) = (q_b - q_a)(p_b - p_a)\n$$\n\n时间 $t$ 时的面积等于初始面积：\n\n$$\nA(t) = A_0\n$$\n\n因此，比值为：\n\n$$\n\\frac{A(t)}{A_0} = 1\n$$\n\n这个结果与刘维尔定理一致，该定理指出在哈密顿动力学下，相空间面积是守恒的。", "answer": "$$ \\boxed{1} $$", "id": "98440"}, {"introduction": "刘维尔定理的成立依赖于一个关键前提：系统的动力学是哈密顿的，即不存在耗散力。那么，当系统存在耗散时会发生什么？这个练习通过分析一个有阻尼的振子系统来探讨这个问题 [@problem_id:1250887]。通过计算相空间体积的变化率，我们能清楚地看到耗散力如何导致相空间体积收缩，这与刘维尔定理描述的体积守恒形成鲜明对比，从而突显了该定理的应用边界。", "problem": "在经典力学中，一个具有 $N$ 个自由度的系统的状态由一个 $2N$ 维相空间中的一个点来描述。对于一个由一阶方程 $\\dot{\\mathbf{z}} = \\mathbf{F}(\\mathbf{z})$ 描述的广义动力学系统，其中 $\\mathbf{z}=(q_1, \\dots, q_N, p_1, \\dots, p_N)$ 是相空间坐标，一个无穷小相空间体积元 $dV$ 的相对变化率由相空间流矢量 $\\mathbf{F}$ 的散度给出：\n$$\n\\frac{1}{dV}\\frac{d(dV)}{dt} = \\nabla \\cdot \\mathbf{F} = \\sum_{i=1}^{N} \\left( \\frac{\\partial \\dot{q}_i}{\\partial q_i} + \\frac{\\partial \\dot{p}_i}{\\partial p_i} \\right)\n$$\n对于哈密顿系统，该散度恒为零（刘维尔定理），这表示相空间体积是守恒的。然而，对于耗散系统，体积可以收缩或膨胀。\n\n考虑一个在一维空间中运动的、由两个耦合阻尼谐振子组成的系统。粒子1的质量为 $m_1$，通过一个劲度系数为 $k_1$ 的弹簧连接到一面固定墙上。粒子2的质量为 $m_2$，通过一个劲度系数为 $k_2$ 的弹簧连接到另一面固定墙上。两个粒子通过一个劲度系数为 $k_c$ 的弹簧相互耦合。每个粒子都受到一个线性粘滞阻尼力，其特征系数分别为 $\\Gamma_1$ 和 $\\Gamma_2$。粒子位置 $x_1(t)$ 和 $x_2(t)$ 的运动方程为：\n$$\nm_1\\ddot{x}_1 + \\Gamma_1 \\dot{x}_1 + k_1 x_1 + k_c(x_1 - x_2) = 0\n$$\n$$\nm_2\\ddot{x}_2 + \\Gamma_2 \\dot{x}_2 + k_2 x_2 + k_c(x_2 - x_1) = 0\n$$\n该系统的相空间是四维的，坐标为 $(x_1, x_2, p_1, p_2)$，其中 $p_1 = m_1 \\dot{x}_1$ 和 $p_2 = m_2 \\dot{x}_2$ 是正则动量。\n\n计算该系统的相空间体积的相对变化率 $\\frac{1}{V}\\frac{dV}{dt}$。", "solution": "1. 定义正则动量 $p_i=m_i\\dot x_i$。该一阶系统为\n$$\n\\dot x_1=\\frac{p_1}{m_1},\\quad\n\\dot x_2=\\frac{p_2}{m_2},\n$$\n$$\n\\dot p_1=-\\frac{\\Gamma_1}{m_1}p_1-(k_1+k_c)x_1+k_cx_2,\n\\quad\n\\dot p_2=-\\frac{\\Gamma_2}{m_2}p_2-(k_2+k_c)x_2+k_cx_1.\n$$\n\n2. 相空间中的散度为\n$$\n\\nabla\\cdot\\mathbf F\n=\\frac{\\partial\\dot x_1}{\\partial x_1}\n+\\frac{\\partial\\dot x_2}{\\partial x_2}\n+\\frac{\\partial\\dot p_1}{\\partial p_1}\n+\\frac{\\partial\\dot p_2}{\\partial p_2}.\n$$\n\n3. 计算每一项：\n$$\n\\frac{\\partial\\dot x_1}{\\partial x_1}=0,\\quad\n\\frac{\\partial\\dot x_2}{\\partial x_2}=0,\n$$\n$$\n\\frac{\\partial\\dot p_1}{\\partial p_1}=-\\frac{\\Gamma_1}{m_1},\\quad\n\\frac{\\partial\\dot p_2}{\\partial p_2}=-\\frac{\\Gamma_2}{m_2}.\n$$\n\n4. 求和得到\n$$\n\\frac1V\\frac{dV}{dt}\n=-\\frac{\\Gamma_1}{m_1}-\\frac{\\Gamma_2}{m_2}.\n$$", "answer": "$$\\boxed{-\\!\\bigl(\\tfrac{\\Gamma_1}{m_1}+\\tfrac{\\Gamma_2}{m_2}\\bigr)}$$", "id": "1250887"}, {"introduction": "刘维尔定理不仅是一个深刻的理论概念，它在计算化学，特别是分子动力学（MD）模拟中，也具有至关重要的实践意义。虽然精确的哈密顿动力学保持相空间体积，但用于模拟的数值积分算法却不一定能做到。这个练习将对比两种积分方法——一种非辛方法（显式欧拉法）和一种辛方法——对相空间体积的影响 [@problem_id:2783804]。通过分析它们的雅可比行列式，我们将揭示为什么辛算法对于长期、稳定地模拟分子系统是必不可少的，因为它们在离散时间步下仍能精确地保持相空间体积。", "problem": "多原子分子的单个简正模可以建模为一维谐振子，其哈密顿量为 $H(q,p) = \\frac{p^{2}}{2 m} + \\frac{1}{2} k q^{2}$，其中 $q$ 是质量加权坐标，$p$ 是其共轭动量，$m$ 是有效质量，$k$ 是力常数。根据刘维尔定理，由哈密顿方程生成的精确哈密顿流保持相空间体积不变。\n\n考虑两种离散时间积分器，它们将状态从 $(q_{n},p_{n})$ 以时间步长 $h$ 推进到 $(q_{n+1},p_{n+1})$：\n\n- 显式欧拉法，定义为在 $(q_{n},p_{n})$ 处应用哈密顿方程的右侧来更新 $(q,p)$ 一个步长。\n\n- 踢-漂变体形式的辛欧拉法，定义为首先使用在 $(q_{n},p_{n})$ 处的力更新动量，然后使用新的动量更新坐标。\n\n将每一步更新视为一个可微映射 $(q_{n},p_{n}) \\mapsto (q_{n+1},p_{n+1})$，并令相空间体积变化因子为该映射的雅可比矩阵的行列式。从哈密顿方程出发，为每种积分器推导与一个步长相关的线性映射，并计算其雅可比行列式（即二维相空间中的面积缩放）。然后，定义对比率\n$$\nR \\equiv \\frac{\\text{(显式欧拉法一步中的相空间体积变化因子)}}{\\text{(辛欧拉法一步中的相空间体积变化因子)}}。\n$$\n用 $h$、$m$ 和 $k$ 以闭合形式表示 $R$。你的最终答案必须是单一的解析表达式。最终答案中不要包含单位。不需要进行数值取整。", "solution": "该问题要求分析两种用于一维谐振子的数值积分方案，并比较它们对相空间体积的影响。严谨的方法要求我们从基本的运动方程开始。\n\n系统由哈密顿量描述：\n$$ H(q,p) = \\frac{p^{2}}{2m} + \\frac{1}{2} k q^{2} $$\n其中 $q$ 是广义坐标，$p$ 是共轭动量，$m$ 是有效质量，$k$ 是力常数。系统的连续时间演化由哈密顿方程控制：\n$$ \\dot{q} = \\frac{\\partial H}{\\partial p} = \\frac{p}{m} $$\n$$ \\dot{p} = -\\frac{\\partial H}{\\partial q} = -kq $$\n我们将使用时间步长 $h$ 对这些方程进行离散化，为每种指定的积分器定义单步映射 $(q_n, p_n) \\mapsto (q_{n+1}, p_{n+1})$。相空间面积的变化由该映射的雅可比矩阵的行列式给出。\n\n首先，我们分析显式欧拉法。此方法通过使用在当前状态 $(q_n, p_n)$ 处计算的导数来近似时间 $t_{n+1} = t_n + h$ 时的状态。更新规则为：\n$$ q_{n+1} = q_n + h \\dot{q}(q_n, p_n) = q_n + h \\frac{p_n}{m} $$\n$$ p_{n+1} = p_n + h \\dot{p}(q_n, p_n) = p_n - h k q_n $$\n这个从 $(q_n, p_n)$ 到 $(q_{n+1}, p_{n+1})$ 的变换是一个线性映射。我们可以将其表示为矩阵形式：\n$$ \\begin{pmatrix} q_{n+1} \\\\ p_{n+1} \\end{pmatrix} = \\begin{pmatrix} 1 & \\frac{h}{m} \\\\ -hk & 1 \\end{pmatrix} \\begin{pmatrix} q_n \\\\ p_n \\end{pmatrix} $$\n该映射的雅可比矩阵（我们记为 $J_{EE}$）就是这个线性变换本身的矩阵：\n$$ J_{EE} = \\frac{\\partial(q_{n+1}, p_{n+1})}{\\partial(q_n, p_n)} = \\begin{pmatrix} \\frac{\\partial q_{n+1}}{\\partial q_n} & \\frac{\\partial q_{n+1}}{\\partial p_n} \\\\ \\frac{\\partial p_{n+1}}{\\partial q_n} & \\frac{\\partial p_{n+1}}{\\partial p_n} \\end{pmatrix} = \\begin{pmatrix} 1 & \\frac{h}{m} \\\\ -hk & 1 \\end{pmatrix} $$\n显式欧拉法的相空间体积变化因子是该雅可比矩阵的行列式：\n$$ \\det(J_{EE}) = (1)(1) - \\left(\\frac{h}{m}\\right)(-hk) = 1 + \\frac{h^2 k}{m} $$\n\n接下来，我们分析踢-漂变体形式的辛欧拉法。该过程是顺序的。\n首先，使用在当前位置 $q_n$ 处计算的力来更新动量（“踢”）：\n$$ p_{n+1} = p_n + h \\dot{p}(q_n) = p_n - hk q_n $$\n其次，使用*新计算出*的动量 $p_{n+1}$ 来更新位置（“漂”）：\n$$ q_{n+1} = q_n + h \\dot{q}(p_{n+1}) = q_n + h \\frac{p_{n+1}}{m} $$\n为了找到从 $(q_n, p_n)$ 到 $(q_{n+1}, p_{n+1})$ 的单步映射，我们将第一步中 $p_{n+1}$ 的表达式代入第二步：\n$$ q_{n+1} = q_n + \\frac{h}{m} (p_n - hk q_n) = \\left(1 - \\frac{h^2 k}{m}\\right) q_n + \\frac{h}{m} p_n $$\n因此，完整的映射为：\n$$ q_{n+1} = \\left(1 - \\frac{h^2 k}{m}\\right) q_n + \\frac{h}{m} p_n $$\n$$ p_{n+1} = -hk q_n + p_n $$\n这同样是一个线性映射。其雅可比矩阵 $J_{SE}$ 为：\n$$ J_{SE} = \\frac{\\partial(q_{n+1}, p_{n+1})}{\\partial(q_n, p_n)} = \\begin{pmatrix} 1 - \\frac{h^2 k}{m} & \\frac{h}{m} \\\\ -hk & 1 \\end{pmatrix} $$\n辛欧拉法的相空间体积变化因子是该矩阵的行列式：\n$$ \\det(J_{SE}) = \\left(1 - \\frac{h^2 k}{m}\\right)(1) - \\left(\\frac{h}{m}\\right)(-hk) = 1 - \\frac{h^2 k}{m} + \\frac{h^2 k}{m} = 1 $$\n这个行列式恰好为 $1$ 的结果，证实了辛积分器的一个定义性属性：它在离散层面上精确地保持相空间体积不变，这是它与精确连续流所共有的一个特性。\n\n最后，我们计算问题陈述中定义的对比率 $R$：\n$$ R \\equiv \\frac{\\text{(显式欧拉法一步中的相空间体积变化因子)}}{\\text{(辛欧拉法一步中的相空间体积变化因子)}} = \\frac{\\det(J_{EE})}{\\det(J_{SE})} $$\n代入推导出的行列式：\n$$ R = \\frac{1 + \\frac{h^2 k}{m}}{1} = 1 + \\frac{h^2 k}{m} $$\n该表达式表明，显式欧拉法在每一步都会导致相空间体积的人为增加，其增加量与时间步长 $h$ 的平方成正比。相比之下，辛欧拉法精确地保持体积不变。这展示了辛积分器在哈密顿系统长时间模拟中的优越定性行为。", "answer": "$$\n\\boxed{1 + \\frac{h^2 k}{m}}\n$$", "id": "2783804"}]}