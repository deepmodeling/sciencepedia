{"hands_on_practices": [{"introduction": "ONIOM方法的核心在于其巧妙的“减法方案”，它通过组合不同理论水平下对系统不同部分的计算来近似整个系统的高精度能量。本次实践将通过一个三层ONIOM模型的具体计算，帮助你直观地理解这一过程。通过这个练习，你将掌握如何将各个子系统的能量组合起来，得到最终的ONIOM能量，并体会到每个校正项对总能量的贡献[@problem_id:2818896]。", "problem": "一种三层的“我们自己 N 层积分分子轨道和分子力学”(Our N-layered Integrated molecular Orbital and Molecular mechanics, ONIOM)方案将一个大分子体系划分为多个嵌套的子体系：一个称为模型子体系的最小内部区域，一个称为中间子体系的扩大的内部区域，以及一个称为真实子体系的完整分子体系。概念上，三层 ONIOM 能量旨在通过加减系统选择的、在不同理论水平上为特定子体系计算的能量，来近似真实子体系的高水平能量，从而近似缺失的高水平贡献，同时避免重复计算。\n\n您将获得五个单点电子能，每个能量都是在完全一致的几何构型上，使用三种理论水平计算得出的：一种高水平量子方法、一种中等水平量子方法和一种低水平分子力学力场。所有能量均以千焦耳/摩尔为单位，是相对于一个共同零点的相对能量。这些方法是：高水平为 Coupled Cluster with Singles, Doubles, and perturbative Triples [CCSD(T)]，中等水平为 Density Functional Theory (DFT)，低水平为 Molecular Mechanics (MM)。\n\n可用数据如下：\n- 模型子体系的高水平能量：$E_{\\mathrm{H}}^{\\mathrm{M}} = -418.73$。\n- 中间子体系的中等水平能量：$E_{\\mathrm{M}}^{\\mathrm{I}} = -395.62$。\n- 模型子体系的中等水平能量：$E_{\\mathrm{M}}^{\\mathrm{M}} = -402.18$。\n- 真实子体系的低水平能量：$E_{\\mathrm{L}}^{\\mathrm{R}} = -380.44$。\n- 中间子体系的低水平能量：$E_{\\mathrm{L}}^{\\mathrm{I}} = -387.31$。\n\n从 ONIOM(3) 组合能量的基本思想出发，即为最小区域添加最佳可用描述，然后以递减的理论水平校正体系缺失的部分（同时消除重叠），请根据此划分逻辑推导出三层 ONIOM 能量表达式，并计算真实子体系的组合能量 $E$。\n\n此外，通过量化中等水平校正和低水平校正相对于基础高水平模型能量的大小，来解释每项校正值相对于所选划分的量级。\n\n以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位表示最终能量，并将您的答案四舍五入到四位有效数字。请勿在最终数值答案中包含任何解释。", "solution": "该问题提出了一个理论与计算化学领域内的任务，具体涉及“我们自己 N 层积分分子轨道和分子力学”(Our N-layered Integrated molecular Orbital and Molecular mechanics, ONIOM) 方法的应用。该问题具有科学依据，提法明确，并为其解决提供了所有必要的数据。我将开始解答。\n\nONIOM 方法的基本目标是在高理论水平 ($H$) 上近似一个大分子体系（称为真实体系, $R$）的能量，而直接进行这种计算是不可行的。近似值 $E_{\\mathrm{ONIOM}}$ 是通过一个系统的减法方案构建的，该方案结合了在不同理论水平上对体系不同部分进行的计算。\n\n该体系被划分为三个嵌套的区域：\n$1$. 主要化学兴趣的核心区域，称为模型子体系 ($M$)。\n$2$. 包括模型子体系及其直接环境的中间区域，称为中间子体系 ($I$)。\n$3$. 整个分子体系，称为真实子体系 ($R$)。\n因此，我们有嵌套关系 $M \\subset I \\subset R$。\n\n可用的理论水平有：\n$1$. 高水平 ($H$)：Coupled Cluster with Singles, Doubles, and perturbative Triples, CCSD(T)。\n$2$. 中等水平 ($M$)：Density Functional Theory, DFT。\n$3$. 低水平 ($L$)：Molecular Mechanics, MM。\n\n真实体系在高理论水平下的能量 $E_{\\mathrm{H}}^{\\mathrm{R}}$ 的 ONIOM 外推法可以从第一性原理推导出来。其逻辑是，从最精确的可用计算开始，为体系的更大部分添加逐次校正，同时确保相互作用能的任何部分都不会被重复计算。\n\n步骤 1：最佳可用估计是模型体系在高理论水平下的能量 $E_{\\mathrm{H}}^{\\mathrm{M}}$。这构成了我们近似的基础。\n\n步骤 2：我们必须考虑中间层（集合差 $I \\setminus M$）中原子的影响。我们通过计算整个中间体系在中等水平下的能量 $E_{\\mathrm{M}}^{\\mathrm{I}}$，并减去在相同中等水平下计算的模型体系的能量 $E_{\\mathrm{M}}^{\\mathrm{M}}$ 来实现。这个差值 $(E_{\\mathrm{M}}^{\\mathrm{I}} - E_{\\mathrm{M}}^{\\mathrm{M}})$ 代表了由中等理论水平描述的中间层的能量贡献。将其加到我们的基础上，可以得到中间体系在高水平下的能量近似值：\n$$ E_{\\mathrm{H}}^{\\mathrm{I}} \\approx E_{\\mathrm{H}}^{\\mathrm{M}} + (E_{\\mathrm{M}}^{\\mathrm{I}} - E_{\\mathrm{M}}^{\\mathrm{M}}) $$\n这是子体系 $I$ 的两层 ONIOM(H:M) 能量。\n\n步骤 3：现在我们必须考虑最外层原子（集合差 $R \\setminus I$）的影响。这在最低的理论水平上完成。我们取整个真实体系在低水平下的能量 $E_{\\mathrm{L}}^{\\mathrm{R}}$，并减去在相同低水平下计算的中间体系的能量 $E_{\\mathrm{L}}^{\\mathrm{I}}$。这个差值 $(E_{\\mathrm{L}}^{\\mathrm{R}} - E_{\\mathrm{L}}^{\\mathrm{I}})$ 代表了由低理论水平描述的最外层的能量贡献。\n\n综合这些步骤可得出最终的三层 ONIOM 能量表达式。我们从模型体系的高水平描述开始，加上中间层的中等水平校正，最后加上真实层的低水平校正。\n$$ E_{\\mathrm{ONIOM}} = E_{\\mathrm{H}}^{\\mathrm{M}} + (E_{\\mathrm{M}}^{\\mathrm{I}} - E_{\\mathrm{M}}^{\\mathrm{M}}) + (E_{\\mathrm{L}}^{\\mathrm{R}} - E_{\\mathrm{L}}^{\\mathrm{I}}) $$\n该方程近似了目标能量 $E_{\\mathrm{H}}^{\\mathrm{R}}$。\n\n现在，我们将所提供的数据代入此表达式。所有能量的单位均为 $\\mathrm{kJ\\,mol^{-1}}$。\n给定数据：\n$E_{\\mathrm{H}}^{\\mathrm{M}} = -418.73$\n$E_{\\mathrm{M}}^{\\mathrm{I}} = -395.62$\n$E_{\\mathrm{M}}^{\\mathrm{M}} = -402.18$\n$E_{\\mathrm{L}}^{\\mathrm{R}} = -380.44$\n$E_{\\mathrm{L}}^{\\mathrm{I}} = -387.31$\n\n组合能量 $E$ 的计算如下：\n$$ E = -418.73 + (-395.62 - (-402.18)) + (-380.44 - (-387.31)) $$\n$$ E = -418.73 + (-395.62 + 402.18) + (-380.44 + 387.31) $$\n\n首先，我们按要求计算各个校正项。\n中等水平校正为：\n$$ \\Delta E_{\\mathrm{M}} = E_{\\mathrm{M}}^{\\mathrm{I}} - E_{\\mathrm{M}}^{\\mathrm{M}} = -395.62 - (-402.18) = 6.56 \\, \\mathrm{kJ\\,mol^{-1}} $$\n该项量化了在 DFT 理论水平下，将中间层 ($I \\setminus M$) 的原子添加到模型体系中的能量效应。\n\n低水平校正为：\n$$ \\Delta E_{\\mathrm{L}} = E_{\\mathrm{L}}^{\\mathrm{R}} - E_{\\mathrm{L}}^{\\mathrm{I}} = -380.44 - (-387.31) = 6.87 \\, \\mathrm{kJ\\,mol^{-1}} $$\n该项量化了在 MM 理论水平下，将最外层 ($R \\setminus I$) 的原子添加到中间体系中的能量效应。\n\n两项校正项均为正值，表明在此特定情况下，包含周围环境相对于较小的子体系而言是去稳定化的。其量值 $6.56 \\, \\mathrm{kJ\\,mol^{-1}}$ 和 $6.87 \\, \\mathrm{kJ\\,mol^{-1}}$ 具有化学意义，并证明了即使在较低的理论水平上，包含环境效应也是重要的。\n\n现在，我们计算总能量：\n$$ E = E_{\\mathrm{H}}^{\\mathrm{M}} + \\Delta E_{\\mathrm{M}} + \\Delta E_{\\mathrm{L}} $$\n$$ E = -418.73 + 6.56 + 6.87 $$\n$$ E = -418.73 + 13.43 $$\n$$ E = -405.30 $$\n\n问题要求最终答案四舍五入到四位有效数字。计算值为 $-405.30$。四位最高有效数字是 $4$、$0$、$5$ 和 $3$。因此，四舍五入后的值为 $-405.3$。", "answer": "$$\n\\boxed{-405.3}\n$$", "id": "2818896"}, {"introduction": "在能量计算的基础上，ONIOM方法的一个强大应用是进行几何优化和分子动力学模拟，而这需要精确计算体系中的力，即能量的梯度。本次实践将引导你从ONIOM能量表达式出发，利用多元链式法则推导出ONIOM梯度的计算公式。通过一个具体的例子，你将学会如何将模型区域的梯度信息正确地映射回整个真实系统，从而理解ONIOM方法如何高效地处理大体系的结构优化问题[@problem_id:2818913]。", "problem": "考虑一个在笛卡尔坐标下的双层“我们自己N层积分的分子轨道和分子力学方法”(ONIOM)构造，其真实体系包含 $N_R = 4$ 个原子，模型子体系包含 $N_M = 3$ 个原子。设真实体系的笛卡尔坐标向量为 $x_R \\in \\mathbb{R}^{3N_R}$，其分量按 $(x_1,y_1,z_1,x_2,y_2,z_2,x_3,y_3,z_3,x_4,y_4,z_4)$ 顺序排列；模型体系的坐标向量为 $x_M \\in \\mathbb{R}^{3N_M}$，其分量按 $(x_1,y_1,z_1,x_2,y_2,z_2,x_3,y_3,z_3)$ 顺序排列。模型子体系与真实体系的原子 $1$–$3$ 重合，因此坐标映射是线性的，由 $x_M = T x_R$ 给出，其中\n$$\nT \\in \\mathbb{R}^{9 \\times 12}, \\qquad T = \\begin{bmatrix} I_9  0_{9\\times 3} \\end{bmatrix},\n$$\n其中 $I_9$ 是 $9\\times 9$ 的单位矩阵，$0_{9\\times 3}$ 是 $9\\times 3$ 的零矩阵。\n\n假设ONIOM总能量由标准的能级差分组合表达式定义\n$$\nE_{\\text{ONIOM}}(x_R) = E_H\\!\\big(x_M(x_R)\\big) + E_L(x_R) - E_L\\!\\big(x_M(x_R)\\big),\n$$\n其中 $E_H$ 以高水平理论作用于模型子体系，$E_L$ 以低水平理论作用。\n\n给定在相应构象下计算的以下笛卡尔梯度（列向量），单位为哈特里/玻尔:\n- 高水平模型梯度\n$$\ng_H(M) = \\begin{bmatrix}\n1.0 \\\\ -2.0 \\\\ 0.5 \\\\\n0.0 \\\\ 1.5 \\\\ -1.0 \\\\\n-0.5 \\\\ 2.0 \\\\ 1.0\n\\end{bmatrix}.\n$$\n- 低水平模型梯度\n$$\ng_L(M) = \\begin{bmatrix}\n0.8 \\\\ -1.9 \\\\ 0.3 \\\\\n0.1 \\\\ 1.4 \\\\ -0.9 \\\\\n-0.6 \\\\ 1.8 \\\\ 1.2\n\\end{bmatrix}.\n$$\n- 低水平真实体系梯度\n$$\ng_L(R) = \\begin{bmatrix}\n0.9 \\\\ -2.1 \\\\ 0.4 \\\\\n0.05 \\\\ 1.6 \\\\ -0.95 \\\\\n-0.55 \\\\ 1.9 \\\\ 1.1 \\\\\n0.2 \\\\ -0.3 \\\\ 0.7\n\\end{bmatrix}.\n$$\n\n从ONIOM能量定义、线性坐标映射 $x_M = T x_R$ 和多元链式法则出发，推导ONIOM梯度相对于真实体系坐标的显式表达式，然后使用上述数据计算其值。报告最终的梯度向量分量，其顺序为 $(x_1,y_1,z_1,x_2,y_2,z_2,x_3,y_3,z_3,x_4,y_4,z_4)$。以哈特里/玻尔为单位表示最终梯度。不要四舍五入；报告给出的精确小数值。", "solution": "在尝试解答之前，对问题陈述进行验证。\n\n**步骤 1: 提取给定条件**\n- **体系**：一个双层“我们自己N层积分的分子轨道和分子力学方法”(ONIOM)模型。\n- **真实体系**：包含 $N_R = 4$ 个原子。笛卡尔坐标向量为 $x_R \\in \\mathbb{R}^{12}$，分量按 $(x_1,y_1,z_1,x_2,y_2,z_2,x_3,y_3,z_3,x_4,y_4,z_4)$ 顺序排列。\n- **模型子体系**：包含 $N_M = 3$ 个原子。笛卡尔坐标向量为 $x_M \\in \\mathbb{R}^{9}$，分量按 $(x_1,y_1,z_1,x_2,y_2,z_2,x_3,y_3,z_3)$ 顺序排列。\n- **坐标映射**：模型子体系的原子是真实体系的原子 $1$–$3$。映射是线性的，$x_M = T x_R$，变换矩阵 $T \\in \\mathbb{R}^{9 \\times 12}$ 定义为 $T = \\begin{bmatrix} I_9  0_{9\\times 3} \\end{bmatrix}$，其中 $I_9$ 是 $9\\times 9$ 的单位矩阵，$0_{9\\times 3}$ 是 $9\\times 3$ 的零矩阵。\n- **ONIOM 能量**：总能量为 $E_{\\text{ONIOM}}(x_R) = E_H(x_M(x_R)) + E_L(x_R) - E_L(x_M(x_R))$，其中 $E_H$ 是模型体系的高水平能量，$E_L$ 是低水平能量。\n- **给定梯度**（单位为哈特里/玻尔）：\n  - 高水平模型梯度，$g_H(M) = \\frac{dE_H}{dx_M} = \\begin{bmatrix} 1.0, -2.0, 0.5, 0.0, 1.5, -1.0, -0.5, 2.0, 1.0 \\end{bmatrix}^T$。\n  - 低水平模型梯度，$g_L(M) = \\frac{dE_L}{dx_M} = \\begin{bmatrix} 0.8, -1.9, 0.3, 0.1, 1.4, -0.9, -0.6, 1.8, 1.2 \\end{bmatrix}^T$。\n  - 低水平真实体系梯度，$g_L(R) = \\frac{dE_L}{dx_R} = \\begin{bmatrix} 0.9, -2.1, 0.4, 0.05, 1.6, -0.95, -0.55, 1.9, 1.1, 0.2, -0.3, 0.7 \\end{bmatrix}^T$。\n\n**步骤 2: 使用提取的给定条件进行验证**\n- 该问题具有科学依据，植根于ONIOM方法的标准公式。ONIOM是计算化学中广泛使用的量子力学/分子力学(QM/MM)技术。\n- 该问题是适定的。能量表达式已定义，所有必要的输入数据（子体系的梯度）已提供，坐标映射已明确给出。总梯度的唯一解可以确定。\n- 语言客观精确。数学设置一致且完整。没有违反任何科学原理。\n\n**步骤 3: 结论与行动**\n问题被认为是有效的。将提供解答。\n\n目标是计算ONIOM能量相对于真实体系笛卡尔坐标的梯度，$g_{\\text{ONIOM}}(R) = \\frac{dE_{\\text{ONIOM}}}{dx_R}$。我们从ONIOM能量的定义开始：\n$$\nE_{\\text{ONIOM}}(x_R) = E_H(x_M(x_R)) + E_L(x_R) - E_L(x_M(x_R))\n$$\n我们对每一项应用关于 $x_R$ 的梯度算子。梯度是偏导数的列向量。\n\n1. 第一项 $E_H(x_M(x_R))$ 的梯度需要使用多元链式法则。设 $E_H$ 相对于其参数 $x_M$ 的梯度为 $g_H(M) = \\frac{dE_H}{dx_M}$。坐标映射 $x_M(x_R) = T x_R$ 的雅可比矩阵是 $\\frac{\\partial x_M}{\\partial x_R} = T$。因此，此项相对于 $x_R$ 的梯度为：\n$$\n\\frac{d}{dx_R} E_H(x_M(x_R)) = \\left(\\frac{\\partial x_M}{\\partial x_R}\\right)^T \\frac{dE_H}{dx_M} = T^T g_H(M)\n$$\n\n2. 第二项 $E_L(x_R)$ 的梯度就是低水平能量相对于真实体系坐标的梯度：\n$$\n\\frac{d}{dx_R} E_L(x_R) = g_L(R)\n$$\n\n3. 第三项 $-E_L(x_M(x_R))$ 的梯度使用链式法则求得，与第一项类似。设 $E_L$ 相对于其参数 $x_M$ 的梯度为 $g_L(M) = \\frac{dE_L}{dx_M}$。\n$$\n\\frac{d}{dx_R} \\left(-E_L(x_M(x_R))\\right) = - \\left(\\frac{\\partial x_M}{\\partial x_R}\\right)^T \\frac{dE_L}{dx_M} = -T^T g_L(M)\n$$\n\n综合这三个结果，总的ONIOM梯度为：\n$$\ng_{\\text{ONIOM}}(R) = T^T g_H(M) + g_L(R) - T^T g_L(M)\n$$\n为了概念上的清晰和计算效率，这个表达式可以重排为：\n$$\ng_{\\text{ONIOM}}(R) = g_L(R) + T^T \\left( g_H(M) - g_L(M) \\right)\n$$\n这是双层ONIOM梯度的一般公式。它表明总梯度是完整体系上的低水平梯度，加上模型体系上高水平和低水平梯度之差的修正，该修正被投影回真实体系的坐标上。\n\n现在，我们使用给定的数据计算这个表达式的值。首先，我们计算模型体系梯度的差值，$\\Delta g = g_H(M) - g_L(M)$：\n$$\n\\Delta g = g_H(M) - g_L(M) = \\begin{bmatrix} 1.0 \\\\ -2.0 \\\\ 0.5 \\\\ 0.0 \\\\ 1.5 \\\\ -1.0 \\\\ -0.5 \\\\ 2.0 \\\\ 1.0 \\end{bmatrix} - \\begin{bmatrix} 0.8 \\\\ -1.9 \\\\ 0.3 \\\\ 0.1 \\\\ 1.4 \\\\ -0.9 \\\\ -0.6 \\\\ 1.8 \\\\ 1.2 \\end{bmatrix} = \\begin{bmatrix} 1.0 - 0.8 \\\\ -2.0 - (-1.9) \\\\ 0.5 - 0.3 \\\\ 0.0 - 0.1 \\\\ 1.5 - 1.4 \\\\ -1.0 - (-0.9) \\\\ -0.5 - (-0.6) \\\\ 2.0 - 1.8 \\\\ 1.0 - 1.2 \\end{bmatrix} = \\begin{bmatrix} 0.2 \\\\ -0.1 \\\\ 0.2 \\\\ -0.1 \\\\ 0.1 \\\\ -0.1 \\\\ 0.1 \\\\ 0.2 \\\\ -0.2 \\end{bmatrix}\n$$\n这是一个 $9 \\times 1$ 的列向量。接下来，我们应用转置映射矩阵 $T^T$。给定 $T = \\begin{bmatrix} I_9  0_{9\\times 3} \\end{bmatrix}$，其转置是一个 $12 \\times 9$ 的矩阵：\n$$\nT^T = \\begin{bmatrix} I_9 \\\\ 0_{3\\times 9} \\end{bmatrix}\n$$\n乘积 $T^T \\Delta g$ 将 9 维的修正向量投影到真实体系的 12 维空间中：\n$$\nT^T \\Delta g = \\begin{bmatrix} I_9 \\\\ 0_{3\\times 9} \\end{bmatrix} \\begin{bmatrix} 0.2 \\\\ -0.1 \\\\ 0.2 \\\\ -0.1 \\\\ 0.1 \\\\ -0.1 \\\\ 0.1 \\\\ 0.2 \\\\ -0.2 \\end{bmatrix} = \\begin{bmatrix} 0.2 \\\\ -0.1 \\\\ 0.2 \\\\ -0.1 \\\\ 0.1 \\\\ -0.1 \\\\ 0.1 \\\\ 0.2 \\\\ -0.2 \\\\ 0.0 \\\\ 0.0 \\\\ 0.0 \\end{bmatrix}\n$$\n如预期的那样，修正项仅对前三个原子（模型体系）非零。最后，我们将此修正项加到真实体系的低水平梯度 $g_L(R)$ 上：\n$$\ng_{\\text{ONIOM}}(R) = g_L(R) + T^T \\Delta g = \\begin{bmatrix} 0.9 \\\\ -2.1 \\\\ 0.4 \\\\ 0.05 \\\\ 1.6 \\\\ -0.95 \\\\ -0.55 \\\\ 1.9 \\\\ 1.1 \\\\ 0.2 \\\\ -0.3 \\\\ 0.7 \\end{bmatrix} + \\begin{bmatrix} 0.2 \\\\ -0.1 \\\\ 0.2 \\\\ -0.1 \\\\ 0.1 \\\\ -0.1 \\\\ 0.1 \\\\ 0.2 \\\\ -0.2 \\\\ 0.0 \\\\ 0.0 \\\\ 0.0 \\end{bmatrix}\n$$\n执行向量加法：\n$$\ng_{\\text{ONIOM}}(R) = \\begin{bmatrix} 0.9 + 0.2 \\\\ -2.1 + (-0.1) \\\\ 0.4 + 0.2 \\\\ 0.05 + (-0.1) \\\\ 1.6 + 0.1 \\\\ -0.95 + (-0.1) \\\\ -0.55 + 0.1 \\\\ 1.9 + 0.2 \\\\ 1.1 + (-0.2) \\\\ 0.2 + 0.0 \\\\ -0.3 + 0.0 \\\\ 0.7 + 0.0 \\end{bmatrix} = \\begin{bmatrix} 1.1 \\\\ -2.2 \\\\ 0.6 \\\\ -0.05 \\\\ 1.7 \\\\ -1.05 \\\\ -0.45 \\\\ 2.1 \\\\ 0.9 \\\\ 0.2 \\\\ -0.3 \\\\ 0.7 \\end{bmatrix}\n$$\n这是最终的ONIOM梯度向量，单位为哈特里/玻尔。各分量对应于笛卡尔坐标 $(x_1, y_1, z_1, x_2, y_2, z_2, x_3, y_3, z_3, x_4, y_4, z_4)$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 1.1 & -2.2 & 0.6 & -0.05 & 1.7 & -1.05 & -0.45 & 2.1 & 0.9 & 0.2 & -0.3 & 0.7 \\end{pmatrix}}\n$$", "id": "2818913"}, {"introduction": "在ONIOM计算中，如何选择模型区域（即QM区域）的大小是一个至关重要的问题，它直接影响结果的准确性和可靠性。一个好的模型选择应该确保计算结果对QM区域的微小变动不敏感。本次实践将为你展示一个系统性的方案，用于测试ONIOM总能量相对于模型区域大小的收敛性，帮助你学会如何判断所选模型是否足够大，以确保你的科学结论是稳健的，而非出于任意划分的偶然结果[@problem_id:2818912]。", "problem": "一个研究小组使用我们自己 N 层积分的分子轨道和分子力学 (Our own N-layered Integrated molecular Orbital and molecular Mechanics, ONIOM) 方法来计算嵌入在蛋白质中的酶活性位点的反应能。该体系被划分为一个高水平的量子力学模型区域和一个低水平的环境。你需要设计一个有原则、可重复的方案，以测试 ONIOM 总能量对模型区域大小的敏感性，并说明如何随着模型区域中的原子数（用 $\\lvert M \\rvert$ 表示）的增加来评估收敛性。\n\n从 ONIOM 的核心思想出发，即它结合了对模型子系统的高水平描述和对完整系统的低水平描述，并且应通过隔离跨越模型-环境边界的原子移动效应来评估关于 $\\lvert M \\rvert$ 的收敛性，请选择以下最能满足以下目标且不引入混杂变量的方案：\n\n- 构建一个由 $k \\in \\{1,2,\\dots\\}$ 索引的嵌套模型区域序列，满足 $\\lvert M_k \\rvert  \\lvert M_{k+1} \\rvert$ 和 $M_{k} \\subset M_{k+1}$。\n- 确保在不同 $k$ 之间观察到的 ONIOM 总能量的任何变化仅反映模型区域的扩展，而不是方法、基组或力场的变化。\n- 为增加的 $\\lvert M \\rvert$ 定义一个定量的收敛性评估，并解释如何判断 $\\lvert M \\rvert$ 对于目标性质何时足够大。\n\n哪个选项是最合适的方案？\n\nA. 通过在化学活性核心周围，基于共价连接或径向截断添加原子壳层来构建一个嵌套序列 $\\{M_{k}\\}$，同时保持连接原子和电荷封顶一致。使用单一、共同的参考构型（例如，使用 ONIOM 在一个中间大小的 $\\lvert M \\rvert$ 下优化一次的构型），并在固定的高水平和低水平方法及基组下，为所有 $k$ 计算单点 ONIOM 能量 $E_{\\text{ONIOM}}(M_{k})$。定义增量 $\\Delta_{k} = E_{\\text{ONIOM}}(M_{k}) - E_{\\text{ONIOM}}(M_{k-1})$，当 $\\lvert \\Delta_{k} \\rvert$ 在至少连续两次扩展中低于预设阈值 $\\varepsilon$（例如 $\\varepsilon \\approx 1\\,\\mathrm{kcal\\ mol^{-1}}$），并且当连接键构型和边界电荷保持稳定时，宣布收敛。可选地，通过在几个快照上重复分析，并在最大的 $M_{k}$ 处重新优化，来确认稳健性，以检查构型弛豫是否会改变结论。\n\nB. 对于每次扩展 $M_{k} \\to M_{k+1}$，同时升级高水平基组（例如，从 double-$\\zeta$ 升级到 triple-$\\zeta$）并添加色散校正，然后重新优化构型。当 $E_{\\text{ONIOM}}(M_{k})$ 趋近于零且梯度范数最小时，判断为收敛。\n\nC. 一次性计算真实体系的低水平能量。对于每个 $M_{k}$，仅计算 $M_{k}$ 上的高水平能量，并监测其随 $k$ 的变化。当高水平模型能量的变化不再超过 $\\varepsilon$ 时宣布收敛，而不管低水平模型部分的贡献如何。\n\nD. 通过包含 Mulliken 电荷超过某个幅值阈值的原子来选择 $M$，并相应地放置连接原子。对跨越边界的片段执行平衡校正的二聚体计算，并在连接原子数量稳定时停止扩展；以此作为 $E_{\\text{ONIOM}}$ 收敛的证据。\n\nE. 用对真实体系片段进行的高水平计算的多体展开来替代 ONIOM 组合，截断至二体项，并比较连续的截断阶数，作为 ONIOM 中 $\\lvert M \\rvert$ 收敛性的代理。当二体校正的变化小于 $\\varepsilon$ 时，认为达到收敛。", "solution": "用户要求对问题陈述进行验证，然后提供完整的解决方案并对所有选项进行评估。\n\n问题陈述已经过验证，被认为是合理的。它在科学上基于计算化学的原理，特别是 ONIOM (我们自己 N 层积分的分子轨道和分子力学) 方法。这个问题提得很好，客观且自成体系，提出了在 QM/MM 方法应用中的一个标准且重要的任务：评估总能量相对于量子力学 (QM) 区域大小的收敛性。没有发现任何缺陷。\n\n双层 ONIOM 能量的基本方程是：\n$$ E_{\\text{ONIOM}} = E(\\text{real, low}) + E(\\text{model, high}) - E(\\text{model, low}) $$\n此处，`real` 指的是整个体系，`model` 指的是用高水平方法（例如量子力学）处理的中心区域。`low` 指的是低水平方法（例如分子力学力场）。项 `$E(\\text{model, high}) - E(\\text{model, low})$` 作为对整个体系低水平描述的校正。\n\n该问题要求一个方案来测试随着模型区域 `$M$` 系统性地扩大时 `$E_{\\text{ONIOM}}$` 的收敛性。让我们用 `$M_{k}$` 表示一系列嵌套的模型区域，其中 `$M_{k} \\subset M_{k+1}$` 且原子数 `$\\lvert M_k \\rvert  \\lvert M_{k+1} \\rvert$`。对于每个 `$k$`，ONIOM 能量为：\n$$ E_{\\text{ONIOM}}(M_{k}) = E(\\text{real, low}) + E(M_{k}, \\text{high}) - E(M_{k}, \\text{low}) $$\n为了系统地、严格地测试收敛性，连续模型之间的 `$E_{\\text{ONIOM}}$` 的任何变化，即 `$\\Delta_{k} = E_{\\text{ONIOM}}(M_{k}) - E_{\\text{ONIOM}}(M_{k-1})$`，必须*只*能归因于模型区域从 `$M_{k-1}$` 到 `$M_{k}$` 的扩展。这是科学方法的经典应用：为了研究一个变量的影响，所有其他变量必须保持不变。在此背景下，需要控制的混杂变量是：\n1.  **体系构型**：如果对每个模型大小 `$M_{k}$` 都重新优化构型，能量变化将混合 QM 区域大小的影响和结构弛豫的影响。因此，所有计算都必须是在单一、固定的参考构型上进行的单点能评估。\n2.  **计算水平**：`high` 水平（例如，DFT 泛函和基组）和 `low` 水平（例如，力场参数）的定义在系列中的所有计算中必须保持相同。\n\n然后可以通过监测能量变化的幅值 `$\\lvert \\Delta_{k} \\rvert$` 来评估收敛性。当 `$\\lvert \\Delta_{k} \\rvert$` 在一次或多次连续扩展中低于预定义的容差 `$\\varepsilon$`（例如，对于化学精度为 `$1-2\\,\\mathrm{kcal \\cdot mol^{-1}}$`）时，能量被认为相对于 QM 区域大小收敛。\n\n现在，我们将根据这些原则评估每个选项。\n\n**A. 通过在化学活性核心周围，基于共价连接或径向截断添加原子壳层来构建一个嵌套序列 $\\{M_{k}\\}$，同时保持连接原子和电荷封顶一致。使用单一、共同的参考构型（例如，使用 ONIOM 在一个中间大小的 $\\lvert M \\rvert$ 下优化一次的构型），并在固定的高水平和低水平方法及基组下，为所有 $k$ 计算单点 ONIOM 能量 $E_{\\text{ONIOM}}(M_{k})$。定义增量 $\\Delta_{k} = E_{\\text{ONIOM}}(M_{k}) - E_{\\text{ONIOM}}(M_{k-1})$，当 $\\lvert \\Delta_{k} \\rvert$ 在至少连续两次扩展中低于预设阈值 $\\varepsilon$（例如 $\\varepsilon \\approx 1\\,\\mathrm{kcal\\ mol^{-1}}$），并且当连接键构型和边界电荷保持稳定时，宣布收敛。可选地，通过在几个快照上重复分析，并在最大的 $M_{k}$ 处重新优化，来确认稳健性，以检查构型弛豫是否会改变结论。**\n\n该方案堪称典范。它正确地实施了所有必要的控制：一个嵌套的模型系列 (`$\\{M_{k}\\}$`)，一个固定的参考构型 (`single, common reference geometry`)，以及固定的计算水平 (`fixed high-level and low-level methods and basis sets`)。收敛标准 (`$\\lvert \\Delta_{k} \\rvert  \\varepsilon$`) 是定量的，并且是该领域的标准。提及一致的边界处理 (`link atoms`, `charge capping`) 和额外的稳健性检查 (`several snapshots`, `reoptimizing at the largest M_k`) 展示了一种彻底而严谨的方法。该方案完美地隔离了模型区域大小的影响。\n**结论：正确**\n\n**B. 对于每次扩展 $M_{k} \\to M_{k+1}$，同时升级高水平基组（例如，从 double-$\\zeta$ 升级到 triple-$\\zeta$）并添加色散校正，然后重新优化构型。当 $E_{\\text{ONIOM}}(M_{k})$ 趋近于零且梯度范数最小时，判断为收敛。**\n\n该方案在科学上是无效的。它违反了控制变量的基本原则。通过同时改变模型大小、基组、色散校正和构型，使得无法将观察到的能量变化归因于任何单一因素。对于既定目的，所得数据是无法解释的。此外，`$E_{\\text{ONIOM}}(M_{k})$` 应趋近于零的收敛标准是无稽之谈；相对于分离的原子核和电子，总电子能量是很大的负数，没有物理原因使其趋近于零。最小的梯度范数仅表示一个驻点，这与构型优化有关，而与 QM 区域的收敛性无关。\n**结论：不正确**\n\n**C. 一次性计算真实体系的低水平能量。对于每个 $M_{k}$，仅计算 $M_{k}$ 上的高水平能量，并监测其随 $k$ 的变化。当高水平模型能量的变化不再超过 $\\varepsilon$ 时宣布收敛，而不管低水平模型部分的贡献如何。**\n\n该方案基于对 ONIOM 能量公式的误解。总能量包含 `$-E(M_{k}, \\text{low})$` 这一项。随着模型 `$M_{k}$` 随 `$k$` 变化，这个减去项也会变化。忽略它意味着根本没有在计算 ONIOM 能量，而是在计算 `$E(\\text{real, low}) + E(M_{k}, \\text{high})$`，这错误地重复计算了模型区域内的相互作用。仅 `$E(M_{k}, \\text{high})$` 的收敛并不等同于总 ONIOM 能量的收敛。\n**结论：不正确**\n\n**D. 通过包含 Mulliken 电荷超过某个幅值阈值的原子来选择 $M$，并相应地放置连接原子。对跨越边界的片段执行平衡校正的二聚体计算，并在连接原子数量稳定时停止扩展；以此作为 $E_{\\text{ONIOM}}$ 收敛的证据。**\n\n该方案在多个方面存在缺陷。首先，基于单一电荷阈值选择 QM 区域并不构成用于测试收敛性的系统性扩展方案。其次，所提出的收敛标准——连接原子数量的稳定——不是能量收敛的可靠指标。在向 QM 区域添加非共价键合基团时，ONIOM 能量可能会显著变化，而这不会改变连接原子的数量。能量必须是收敛的度量，而不是像被切断的键的数量这样的结构代理。最后，虽然平衡校正解决了基组重叠误差 (BSSE)，但它在这里的应用是非标准的，并且使 QM 区域大小收敛性的分析复杂化。\n**结论：不正确**\n\n**E. 用对真实体系片段进行的高水平计算的多体展开来替代 ONIOM 组合，截断至二体项，并比较连续的截断阶数，作为 ONIOM 中 $\\lvert M \\rvert$ 收敛性的代理。当二体校正的变化小于 $\\varepsilon$ 时，认为达到收敛。**\n\n该方案没有回答问题。它建议使用一种完全不同的计算技术，即多体展开 (MBE) 方法，作为 ONIOM 的“代理”。虽然 MBE 是处理大体系的一种有效方法，但其关于截断阶数（例如，包括三体项）的收敛行为在概念上不同于 ONIOM 关于 QM 区域大小的收敛。测试一种方法的方案不能替代测试另一种方法的方案。问题明确询问如何*在 ONIOM 框架内*测试收敛性。\n**结论：不正确**\n\n总之，选项 A是唯一一个描述了用于该任务的科学严谨且合适的方案的选项。", "answer": "$$\\boxed{A}$$", "id": "2818912"}]}