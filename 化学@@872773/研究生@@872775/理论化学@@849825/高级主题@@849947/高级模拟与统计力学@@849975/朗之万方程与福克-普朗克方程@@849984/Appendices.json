{"hands_on_practices": [{"introduction": "这个基础练习将分析谐振子势中的布朗粒子，即物理学和化学中经典的 Ornstein-Uhlenbeck 过程。通过求解这个模型，你将掌握求解线性随机微分方程组的关键技巧。这项实践的核心是推导时间和速度-位置协方差矩阵，并从中提取弛豫速率，这对于理解系统如何返回平衡态至关重要。[@problem_id:2815972]", "problem": "考虑一个质量为 $m$ 的单个布朗粒子，在一维空间中，在谐波势 $U(x)=\\tfrac{1}{2} k x^{2}$ 中运动，并与绝对温度为 $T$ 的热浴接触。设溶剂施加一个系数为 $\\gamma$ 的线性斯托克斯摩擦力，以及一个满足涨落-耗散定理的随机力。仅从牛顿第二定律和随机力的涨落-耗散定理出发，写出位置 $x(t)$ 和速度 $v(t)$ 的随机运动方程，以及对应于双分量状态 $(x,v)^{\\mathsf{T}}$ 的线性漂移算符。然后，使用朗之万方程和福克-普朗克方程的框架，推导在平衡初始条件下 $t \\ge 0$ 时的稳态时间相关协方差矩阵\n$$\nC(t) \\equiv \\begin{pmatrix}\n\\langle x(t)\\,x(0)\\rangle  \\langle x(t)\\,v(0)\\rangle \\\\\n\\langle v(t)\\,x(0)\\rangle  \\langle v(t)\\,v(0)\\rangle\n\\end{pmatrix},\n$$\n给出所有四个矩阵元的显式表达式，用 $m$、$\\gamma$、$k$、$k_{B}$、$T$ 和 $t$ 表示，并讨论函数形式在欠阻尼和过阻尼状态下如何变化。最后，提取在两种状态下控制相关性指数弛豫的两个弛豫率，仅用 $m$、$\\gamma$ 和 $k$ 表示。将这两个弛豫率以单行矩阵的形式报告，使用 LaTeX $\\texttt{pmatrix}$ 环境。不需要进行数值计算，所有常数应保留为符号形式。最终答案必须仅为这两个弛豫率，形式为单个闭式解析表达式，不带单位。", "solution": "所述问题在科学上是合理的、适定的、客观的且自洽的。这是一个统计物理学中的标准问题，涉及 Ornstein-Uhlenbeck 过程，该过程模拟了一个谐波束缚的布朗粒子。所有必需的参数和条件都已提供，不存在不一致或模糊之处。因此，该问题是有效的，将提供解答。\n\n粒子的运动由牛顿第二定律支配，该定律包括谐波势能产生的力、线性摩擦力以及来自热浴的随机力。运动方程是朗之万方程：\n$$\nm \\frac{d^2x}{dt^2} = -k x - \\gamma \\frac{dx}{dt} + R(t)\n$$\n其中 $m$ 是质量，$k$ 是谐波势 $U(x) = \\frac{1}{2} k x^2$ 的弹簧常数，$\\gamma$ 是摩擦系数，$R(t)$ 是随机力。\n\n系统的状态由双分量向量 $\\mathbf{z}(t) = (x(t), v(t))^{\\mathsf{T}}$ 描述，其中 $v(t) = dx/dt$ 是速度。这个二阶随机微分方程可以写成一个一阶方程组：\n$$\n\\frac{dx}{dt} = v\n$$\n$$\n\\frac{dv}{dt} = -\\frac{k}{m} x - \\frac{\\gamma}{m} v + \\frac{1}{m} R(t)\n$$\n该系统可以以矩阵形式表示为一个多元 Ornstein-Uhlenbeck 过程：\n$$\n\\frac{d\\mathbf{z}}{dt} = A\\mathbf{z} + \\mathbf{f}(t)\n$$\n其中线性漂移算符（或矩阵）$A$ 和随机力项 $\\mathbf{f}(t)$ 由下式给出：\n$$\nA = \\begin{pmatrix} 0  1 \\\\ -\\frac{k}{m}  -\\frac{\\gamma}{m} \\end{pmatrix}, \\quad \\mathbf{f}(t) = \\begin{pmatrix} 0 \\\\ \\frac{1}{m} R(t) \\end{pmatrix}\n$$\n随机力 $R(t)$ 是一个满足涨落-耗散定理的白噪声过程，该定理规定了其统计特性：\n$$\n\\langle R(t) \\rangle = 0\n$$\n$$\n\\langle R(t) R(t') \\rangle = 2\\gamma k_B T \\delta(t-t')\n$$\n其中 $k_B$ 是玻尔兹曼常数，$T$ 是绝对温度。\n\n我们需要求解的是 $t \\ge 0$ 时的稳态时间相关协方差矩阵 $C(t)$，其定义为：\n$$\nC(t) = \\langle \\mathbf{z}(t) \\mathbf{z}(0)^{\\mathsf{T}} \\rangle = \\begin{pmatrix} \\langle x(t)x(0)\\rangle  \\langle x(t)v(0)\\rangle \\\\ \\langle v(t)x(0)\\rangle  \\langle v(t)v(0)\\rangle \\end{pmatrix}\n$$\n该线性随机微分方程的形式解为：\n$$\n\\mathbf{z}(t) = e^{At} \\mathbf{z}(0) + \\int_0^t e^{A(t-s)} \\mathbf{f}(s) ds\n$$\n将此解代入 $C(t)$ 的定义中：\n$$\nC(t) = \\left\\langle \\left( e^{At} \\mathbf{z}(0) + \\int_0^t e^{A(t-s)} \\mathbf{f}(s) ds \\right) \\mathbf{z}(0)^{\\mathsf{T}} \\right\\rangle\n$$\n由于系统处于平衡状态，初始状态 $\\mathbf{z}(0)$ 与任何 $s > 0$ 的随机力 $\\mathbf{f}(s)$ 都不相关。因此，交叉项为零：$\\langle \\mathbf{f}(s) \\mathbf{z}(0)^{\\mathsf{T}} \\rangle = 0$。这使得表达式简化为：\n$$\nC(t) = e^{At} \\langle \\mathbf{z}(0) \\mathbf{z}(0)^{\\mathsf{T}} \\rangle = e^{At} \\Sigma\n$$\n其中 $\\Sigma$ 是平衡时的等时协方差矩阵。$\\Sigma$ 的分量由平衡态的 Maxwell-Boltzmann 分布 $P_{eq}(x,v) \\propto \\exp\\left(-\\frac{H(x,v)}{k_B T}\\right)$ 确定，其中哈密顿量为 $H(x,v) = \\frac{1}{2}kx^2 + \\frac{1}{2}mv^2$。\n根据能量均分定理，每个二次自由度的平均能量为 $\\frac{1}{2}k_B T$：\n$$\n\\langle \\tfrac{1}{2}kx^2 \\rangle_{eq} = \\tfrac{1}{2}k_B T \\implies \\langle x^2 \\rangle_{eq} = \\frac{k_B T}{k}\n$$\n$$\n\\langle \\tfrac{1}{2}mv^2 \\rangle_{eq} = \\tfrac{1}{2}k_B T \\implies \\langle v^2 \\rangle_{eq} = \\frac{k_B T}{m}\n$$\n交叉相关项 $\\langle xv \\rangle_{eq}$ 为零，因为平衡分布在 $x$ 和 $v$ 上是可分的，并且 $v$（或 $x$）的奇函数在对称区间上的平均值为零。因此，平衡协方差矩阵为：\n$$\n\\Sigma = \\begin{pmatrix} \\langle x^2 \\rangle_{eq}  \\langle xv \\rangle_{eq} \\\\ \\langle vx \\rangle_{eq}  \\langle v^2 \\rangle_{eq} \\end{pmatrix} = \\begin{pmatrix} \\frac{k_B T}{k}  0 \\\\ 0  \\frac{k_B T}{m} \\end{pmatrix}\n$$\n为了求得 $C(t)$，我们必须计算矩阵指数 $e^{At}$。这可以通过求解 $A$ 的特征值和特征向量来完成。特征方程为 $\\det(A - \\lambda I) = 0$：\n$$\n\\det\\begin{pmatrix} -\\lambda  1 \\\\ -\\frac{k}{m}  -\\frac{\\gamma}{m}-\\lambda \\end{pmatrix} = (-\\lambda)(-\\tfrac{\\gamma}{m}-\\lambda) - (-\\tfrac{k}{m}) = \\lambda^2 + \\frac{\\gamma}{m}\\lambda + \\frac{k}{m} = 0\n$$\n特征值是这个二次方程的根：\n$$\n\\lambda_{\\pm} = \\frac{-\\frac{\\gamma}{m} \\pm \\sqrt{(\\frac{\\gamma}{m})^2 - \\frac{4k}{m}}}{2} = \\frac{-\\gamma \\pm \\sqrt{\\gamma^2 - 4mk}}{2m}\n$$\n根据 Cayley-Hamilton 定理，矩阵指数 $e^{At}$ 可以写成 $e^{At} = c_0(t)I + c_1(t)A$，或者通过对角化求得。对于不同的特征值 $\\lambda_+, \\lambda_-$，$e^{At}$ 的一般形式为：\n$$\ne^{At} = \\frac{1}{\\lambda_+ - \\lambda_-} \\begin{pmatrix} \\lambda_+ e^{\\lambda_- t} - \\lambda_- e^{\\lambda_+ t}  e^{\\lambda_+ t} - e^{\\lambda_- t} \\\\ -\\frac{k}{m}(e^{\\lambda_+ t} - e^{\\lambda_- t})  \\lambda_+ e^{\\lambda_+ t} - \\lambda_- e^{\\lambda_- t} \\end{pmatrix}\n$$\n现在我们计算 $C(t) = e^{At}\\Sigma$：\n$$\nC(t) = \\frac{1}{\\lambda_+ - \\lambda_-} \\begin{pmatrix} \\lambda_+ e^{\\lambda_- t} - \\lambda_- e^{\\lambda_+ t}  e^{\\lambda_+ t} - e^{\\lambda_- t} \\\\ -\\frac{k}{m}(e^{\\lambda_+ t} - e^{\\lambda_- t})  \\lambda_+ e^{\\lambda_+ t} - \\lambda_- e^{\\lambda_- t} \\end{pmatrix} \\begin{pmatrix} \\frac{k_B T}{k}  0 \\\\ 0  \\frac{k_B T}{m} \\end{pmatrix}\n$$\n协方差矩阵的四个矩阵元是：\n$$\n\\langle x(t)x(0) \\rangle = \\frac{k_B T}{k(\\lambda_+ - \\lambda_-)} (\\lambda_+ e^{\\lambda_- t} - \\lambda_- e^{\\lambda_+ t})\n$$\n$$\n\\langle x(t)v(0) \\rangle = \\frac{k_B T}{m(\\lambda_+ - \\lambda_-)} (e^{\\lambda_+ t} - e^{\\lambda_- t})\n$$\n$$\n\\langle v(t)x(0) \\rangle = -\\frac{k_B T}{m(\\lambda_+ - \\lambda_-)} (e^{\\lambda_+ t} - e^{\\lambda_- t})\n$$\n$$\n\\langle v(t)v(0) \\rangle = \\frac{k_B T}{m(\\lambda_+ - \\lambda_-)} (\\lambda_+ e^{\\lambda_+ t} - \\lambda_- e^{\\lambda_- t})\n$$\n这些相关性的函数形式取决于判别式 $\\Delta = \\gamma^2 - 4mk$ 的符号。\n\n1.  **过阻尼状态 ($\\gamma^2 > 4mk$):** 特征值 $\\lambda_+$ 和 $\\lambda_-$ 是不相等的、实的、负的。相关函数是两个衰减的实指数函数 $e^{\\lambda_+ t}$ 和 $e^{\\lambda_- t}$ 的和。没有振荡。系统单调地弛豫到平衡状态。\n\n2.  **欠阻尼状态 ($\\gamma^2  4mk$):** 特征值为一对共轭复数：\n    $$\n    \\lambda_{\\pm} = -\\frac{\\gamma}{2m} \\pm i\\omega_1, \\quad \\text{其中} \\quad \\omega_1 = \\frac{\\sqrt{4mk - \\gamma^2}}{2m} = \\sqrt{\\frac{k}{m} - \\left(\\frac{\\gamma}{2m}\\right)^2}\n    $$\n    在这种情况下，$\\lambda_+ - \\lambda_- = 2i\\omega_1$。相关函数表现出阻尼振荡。例如，速度自相关函数变为：\n    $$\n    \\langle v(t)v(0) \\rangle = \\frac{k_B T}{m(2i\\omega_1)} ((-\\frac{\\gamma}{2m}+i\\omega_1)e^{(-\\frac{\\gamma}{2m}+i\\omega_1)t} - (-\\frac{\\gamma}{2m}-i\\omega_1)e^{(-\\frac{\\gamma}{2m}-i\\omega_1)t})\n    $$\n    $$\n    \\langle v(t)v(0) \\rangle = \\frac{k_B T}{m} e^{-\\frac{\\gamma t}{2m}} \\left(\\cos(\\omega_1 t) - \\frac{\\gamma}{2m\\omega_1} \\sin(\\omega_1 t)\\right)\n    $$\n    相关性以包络函数 $e^{-\\gamma t/(2m)}$ 衰减，并以频率 $\\omega_1$ 振荡。其他矩阵元也有类似的表达式。\n\n3.  **临界阻尼状态 ($\\gamma^2 = 4mk$):** 特征值是相等的实数，$\\lambda_+ = \\lambda_- = -\\gamma/(2m)$。相关函数以 $(c_1 + c_2 t)e^{-\\gamma t/(2m)}$ 的形式衰减，这是最快且无振荡的衰减方式。\n\n问题要求的是控制指数弛豫的两个弛豫率。这些弛豫率对应于系统本征模的衰减，由特征值 $\\lambda_{\\pm}$ 的相反数给出。\n设弛豫率为 $r_1$ 和 $r_2$。\n$$\nr_{1,2} = -\\lambda_{\\pm} = \\frac{\\gamma \\mp \\sqrt{\\gamma^2 - 4mk}}{2m}\n$$\n这两个表达式在过阻尼状态下提供了两个实数弛豫率，在欠阻尼状态下它们成为一对共轭复数，其中实部给出衰减率，虚部给出振荡频率。这两个弛豫率完全表征了所有状态下的弛豫动力学。\n这两个弛豫率是：\n$$\n\\frac{\\gamma + \\sqrt{\\gamma^2 - 4mk}}{2m} \\quad \\text{和} \\quad \\frac{\\gamma - \\sqrt{\\gamma^2 - 4mk}}{2m}\n$$", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\gamma + \\sqrt{\\gamma^2 - 4mk}}{2m}  \\frac{\\gamma - \\sqrt{\\gamma^2 - 4mk}}{2m} \\end{pmatrix}}\n$$", "id": "2815972"}, {"introduction": "真实世界的分子系统通常处于非均匀环境中，这导致了位置依赖的扩散系数和朗之万方程中的乘性噪声。这项练习将向你介绍一个处理这类复杂模型的强大数学工具：伊腾引理 (Itô's lemma)。掌握变量替换下随机微分方程的正确变换，对于构建和分析更真实的化学和生物物理模型是一项不可或缺的技能。[@problem_id:2815970]", "problem": "对于一个在谐波势 $U(x)$ 中、在具有位置依赖性扩散 $D(x)$ 的非均匀环境中演化的分子反应坐标 $x_{t}$，其一维过阻尼朗之万动力学可以用伊藤意义下的随机微分方程（SDE）来建模：\n$$\n\\mathrm{d}x_{t} = a(x_{t})\\,\\mathrm{d}t + b(x_{t})\\,\\mathrm{d}W_{t},\n$$\n其中 $W_{t}$ 是标准维纳过程，$a(x)$ 是漂移项，$b(x)$ 是噪声振幅。假设在逆温度 $\\beta$ 下，其形式为热力学一致的伊藤形式，\n$$\na(x) = -\\beta D(x) U'(x) + D'(x), \\qquad b(x) = \\sqrt{2 D(x)}.\n$$\n设扩散分布为 $D(x) = D_{0}\\left(1 + \\lambda x^{2}\\right)$，其中 $D_{0}  0$ 且 $\\lambda  0$，势为 $U(x) = \\tfrac{1}{2} k x^{2}$，其中 $k  0$。考虑使用光滑、可逆的变量替换 $y = g(x)$，其中\n$$\ng(x) = \\arctan\\!\\big(\\sqrt{\\lambda}\\,x\\big).\n$$\n使用伊藤链式法则，将关于 $x_{t}$ 的 SDE 转换为关于 $y_{t} = g(x_{t})$ 的 SDE，并推导变换后的漂移项 $\\mathcal{A}(y)$ 和扩散振幅 $\\mathcal{B}(y)$ 的显式解析表达式，其中变换后的 SDE 写作伊藤形式：\n$$\n\\mathrm{d}y_{t} = \\mathcal{A}(y_{t})\\,\\mathrm{d}t + \\mathcal{B}(y_{t})\\,\\mathrm{d}W_{t}.\n$$\n将你的最终答案以行向量 $\\big[\\mathcal{A}(y),\\,\\mathcal{B}(y)\\big]$ 的形式表示，该表达式应为关于 $y$, $\\beta$, $D_{0}$, $\\lambda$ 和 $k$ 的封闭形式。最终答案中不要提供中间步骤。无需进行数值计算。", "solution": "该问题陈述是自洽、一致且科学上合理的。它在理论化学的背景下，提出了一个关于随机微分方程（SDE）变换的适定数学问题。我们将着手推导解答。\n\n该问题要求对伊藤SDE进行变换\n$$\n\\mathrm{d}x_{t} = a(x_{t})\\,\\mathrm{d}t + b(x_{t})\\,\\mathrm{d}W_{t}\n$$\n在变量替换 $y_{t} = g(x_{t})$ 下，其中 $g(x) = \\arctan(\\sqrt{\\lambda}\\,x)$。变换得到的 SDE 需表示为以下形式：\n$$\n\\mathrm{d}y_{t} = \\mathcal{A}(y_{t})\\,\\mathrm{d}t + \\mathcal{B}(y_{t})\\,\\mathrm{d}W_{t}.\n$$\n漂移和扩散系数的变换由伊藤链式法则（也称为伊藤引理）决定。对于函数 $y = g(x)$，该法则表述为：\n$$\n\\mathrm{d}y_{t} = \\left( a(x_{t}) g'(x_{t}) + \\frac{1}{2} b(x_{t})^2 g''(x_{t}) \\right) \\mathrm{d}t + b(x_{t}) g'(x_{t}) \\,\\mathrm{d}W_{t}\n$$\n由此，我们确定变换后的漂移项 $\\mathcal{A}(y)$ 和扩散振幅 $\\mathcal{B}(y)$ 为：\n$$\n\\mathcal{A}(y) = a(x) g'(x) + \\frac{1}{2} b(x)^2 g''(x)\n$$\n$$\n\\mathcal{B}(y) = b(x) g'(x)\n$$\n其中最终表达式必须以 $y$ 的函数形式给出。\n\n首先，我们计算变换函数 $g(x) = \\arctan(\\sqrt{\\lambda}\\,x)$ 所需的导数。\n一阶导数为：\n$$\ng'(x) = \\frac{\\mathrm{d}}{\\mathrm{d}x}\\arctan(\\sqrt{\\lambda}\\,x) = \\frac{\\sqrt{\\lambda}}{1 + (\\sqrt{\\lambda}\\,x)^2} = \\frac{\\sqrt{\\lambda}}{1 + \\lambda x^2}\n$$\n二阶导数为：\n$$\ng''(x) = \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\frac{\\sqrt{\\lambda}}{1 + \\lambda x^2}\\right) = \\sqrt{\\lambda} \\cdot (-1) (1 + \\lambda x^2)^{-2} \\cdot (2\\lambda x) = -\\frac{2\\lambda^{\\frac{3}{2}} x}{(1 + \\lambda x^2)^2}\n$$\n\n接下来，我们确定原始漂移项 $a(x)$ 和 $b(x)^2$ 项的显式形式。\n势为 $U(x) = \\frac{1}{2} k x^2$，其导数为 $U'(x) = kx$。\n扩散分布为 $D(x) = D_{0}(1 + \\lambda x^2)$，其导数为 $D'(x) = 2D_{0}\\lambda x$。\n将这些代入给定的漂移项表达式 $a(x) = -\\beta D(x) U'(x) + D'(x)$：\n$$\na(x) = -\\beta \\left(D_{0}(1 + \\lambda x^2)\\right) (kx) + 2D_{0}\\lambda x = - \\beta D_{0} k x (1 + \\lambda x^2) + 2D_{0}\\lambda x\n$$\n噪声振幅为 $b(x) = \\sqrt{2D(x)}$，可得：\n$$\nb(x)^2 = 2D(x) = 2D_{0}(1 + \\lambda x^2)\n$$\n\n现在我们计算变换后漂移项 $\\mathcal{A}(y)$ 的各项。\n第一项是 $a(x)g'(x)$：\n$$\na(x)g'(x) = \\left[- \\beta D_{0} k x (1 + \\lambda x^2) + 2D_{0}\\lambda x\\right] \\left(\\frac{\\sqrt{\\lambda}}{1 + \\lambda x^2}\\right) = - \\beta D_{0} k x \\sqrt{\\lambda} + \\frac{2D_{0}\\lambda^{\\frac{3}{2}} x}{1 + \\lambda x^2}\n$$\n第二项是 $\\frac{1}{2} b(x)^2 g''(x)$：\n$$\n\\frac{1}{2} b(x)^2 g''(x) = \\frac{1}{2} \\left[2D_{0}(1 + \\lambda x^2)\\right] \\left(-\\frac{2\\lambda^{\\frac{3}{2}}x}{(1 + \\lambda x^2)^2}\\right) = -\\frac{2D_{0}\\lambda^{\\frac{3}{2}}x}{1 + \\lambda x^2}\n$$\n将这两项相加得到 $\\mathcal{A}(y)$，我们观察到一个抵消：\n$$\n\\mathcal{A}(y) = \\left(- \\beta D_{0} k x \\sqrt{\\lambda} + \\frac{2D_{0}\\lambda^{\\frac{3}{2}} x}{1 + \\lambda x^2}\\right) + \\left(-\\frac{2D_{0}\\lambda^{\\frac{3}{2}}x}{1 + \\lambda x^2}\\right) = - \\beta D_{0} k x \\sqrt{\\lambda}\n$$\n\n接下来，我们计算变换后的扩散振幅 $\\mathcal{B}(y)$：\n$$\n\\mathcal{B}(y) = b(x)g'(x) = \\sqrt{2D(x)} g'(x) = \\sqrt{2D_{0}(1 + \\lambda x^2)} \\left(\\frac{\\sqrt{\\lambda}}{1 + \\lambda x^2}\\right) = \\frac{\\sqrt{2D_{0}\\lambda}}{\\sqrt{1 + \\lambda x^2}}\n$$\n\n最后，我们将这些结果用新坐标 $y$ 表示。坐标变换为 $y = \\arctan(\\sqrt{\\lambda}\\,x)$。对于 $y \\in (-\\frac{\\pi}{2}, \\frac{\\pi}{2})$，该变换是可逆的，得到 $\\tan(y) = \\sqrt{\\lambda}\\,x$，或 $x = \\frac{1}{\\sqrt{\\lambda}}\\tan(y)$。\n我们将此逆关系代入 $\\mathcal{A}(y)$ 和 $\\mathcal{B}(y)$ 的表达式中。\n对于漂移项 $\\mathcal{A}(y)$：\n$$\n\\mathcal{A}(y) = - \\beta D_{0} k x \\sqrt{\\lambda} = - \\beta D_{0} k \\left(\\frac{\\tan(y)}{\\sqrt{\\lambda}}\\right) \\sqrt{\\lambda} = - \\beta D_{0} k \\tan(y)\n$$\n对于扩散项 $\\mathcal{B}(y)$，我们首先重新表示 $\\sqrt{1 + \\lambda x^2}$ 项：\n$$\n1 + \\lambda x^2 = 1 + \\lambda \\left(\\frac{\\tan(y)}{\\sqrt{\\lambda}}\\right)^2 = 1 + \\tan^2(y) = \\sec^2(y)\n$$\n由于 $y \\in (-\\frac{\\pi}{2}, \\frac{\\pi}{2})$，$\\cos(y)  0$，因此 $\\sec(y)  0$。所以，$\\sqrt{1 + \\lambda x^2} = \\sec(y)$。\n将此代入 $\\mathcal{B}(y)$ 的表达式中：\n$$\n\\mathcal{B}(y) = \\frac{\\sqrt{2D_{0}\\lambda}}{\\sec(y)} = \\sqrt{2D_{0}\\lambda} \\cos(y)\n$$\n\n变换后的漂移项和扩散振幅关于 $y$ 和给定参数的显式解析表达式为：\n$$\n\\mathcal{A}(y) = - \\beta D_{0} k \\tan(y)\n$$\n$$\n\\mathcal{B}(y) = \\sqrt{2D_{0}\\lambda} \\cos(y)\n$$\n问题要求答案以行向量 $\\big[\\mathcal{A}(y), \\mathcal{B}(y)\\big]$ 的形式给出。", "answer": "$$\n\\boxed{\\begin{pmatrix} - \\beta D_{0} k \\tan(y)  \\sqrt{2 D_{0} \\lambda} \\cos(y) \\end{pmatrix}}\n$$", "id": "2815970"}, {"introduction": "当解析解不再可行时，数值积分成为研究复杂朗之万动力学的核心方法。这项实践将理论与计算联系起来，深入探讨了一种先进且高效的积分算法——BAOAB 分裂法。你将不仅学习如何实现该算法，还将分析其对构象采样的系统性偏差，这是评估和确保分子模拟准确性的关键一步。[@problem_id:2815946]", "problem": "考虑一个质量为 $m$ 的粒子在一维势 $U(x)$ 中的欠阻尼朗之万动力学，该粒子与温度为 $T$、摩擦系数为 $\\gamma$ 的热浴耦合。其运动方程为如下的随机微分方程 (SDE)：\n$$\n\\frac{dx}{dt} = v,\\qquad m\\frac{dv}{dt} = -\\frac{dU}{dx}(x) - \\gamma m v + \\sqrt{2\\gamma m k_{\\mathrm{B}} T}\\,\\eta(t),\n$$\n其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数，$\\eta(t)$ 是标准白噪声。在无量纲简化单位下进行计算，使得 $m = 1$，$k_{\\mathrm{B}}T = 1$，并且所有量都用这些单位表示。\n\n你的任务是提出用于上述动力学时间离散化的 \"BAOAB\" 分裂算法，然后分析其在谐振势 $U(x) = \\tfrac{1}{2}k x^2$ 下的构型采样偏差。此处，“BAOAB” 这个名称指的是按顺序组合以下步骤：半步动量踢 ($B$)、半步位置漂移 ($A$)、一次 Ornstein–Uhlenbeck (OU) 随机动量更新 ($O$)，然后是另一次半步漂移 ($A$) 和最后一次半步踢 ($B$)。该算法作用于大小为 $\\Delta t$ 的单个时间步长。\n\n仅从基本原理出发（牛顿第二定律、带有涨落-耗散的随机力定义，以及用于线性映射的线性代数），完成以下操作：\n\n1. 指定在一维空间中谐振势 $U(x) = \\tfrac{1}{2}k x^2$ 的 BAOAB 更新步骤。使用 $\\Delta t$ 表示时间步长，$\\gamma$ 表示（无量纲）摩擦系数，$k$ 表示（无量纲）弹簧常数，并使用标准正态变量作为随机数。除上述定义外，不要假定任何公式。\n\n2. 对于谐振势，证明单个 BAOAB 步骤通过一个带有加性高斯噪声的仿射变换将状态向量 $y_n = \\begin{bmatrix} x_n \\\\ p_n \\end{bmatrix}$ 映射到 $y_{n+1}$，形式如下\n$$\ny_{n+1} = M\\,y_n + G\\,\\xi_n,\n$$\n其中 $\\xi_n \\sim \\mathcal{N}(0,1)$，并用 $\\Delta t$、$\\gamma$、$k$ 和简化单位参数明确确定矩阵 $M$ 和 $G$。\n\n3. 仅使用第一性原理，确定由 BAOAB 积分器为谐振势定义的马尔可夫链的稳态构型方差 $\\operatorname{Var}[x]$。你必须计算满足以下条件的稳态协方差矩阵 $\\Sigma$：\n$$\n\\Sigma = M\\,\\Sigma\\,M^\\top + Q,\\qquad Q = GG^\\top,\n$$\n然后提取 $\\Sigma$ 的 $(1,1)$ 元作为构型方差。\n\n4. 在连续极限下，谐振势的精确构型方差为 $\\operatorname{Var}_{\\mathrm{exact}}[x] = \\frac{k_{\\mathrm{B}}T}{k}$。将有符号分数构型偏差定义为\n$$\n\\mathcal{B}(\\Delta t,\\gamma) = \\frac{\\operatorname{Var}_{\\mathrm{BAOAB}}[x] - \\operatorname{Var}_{\\mathrm{exact}}[x]}{\\operatorname{Var}_{\\mathrm{exact}}[x]}。\n$$\n\n在 $m = 1$，$k_{\\mathrm{B}}T = 1$ 和 $k = 1$ 的简化单位下，为以下 $(\\Delta t,\\gamma)$ 对的测试套件计算 $\\mathcal{B}(\\Delta t,\\gamma)$：\n- $(0.005, 1.0)$\n- $(0.050, 1.0)$\n- $(0.500, 1.0)$\n- $(1.500, 1.0)$\n- $(1.900, 1.0)$\n- $(0.200, 0.1)$\n- $(0.200, 5.0)$\n\n你的程序必须通过从 BAOAB 组合构建 $M$ 和 $G$ 并求解稳态协方差，来为线性高斯系统精确计算这七个值；不要通过轨迹采样来估计它们。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含七个有符号分数偏差，以逗号分隔列表的形式用方括号括起来，顺序与上面相同（例如，$[b_1,b_2,b_3,b_4,b_5,b_6,b_7]$）。条目必须是浮点数。", "solution": "所提出的问题是一个独立的、数学上明确定义的练习，涉及随机微分方程数值积分器的分析。它在科学上基于统计力学原理和马尔可夫链理论。该问题是有效的，并允许进行严格的解析求解。\n\n我们首先将系统形式化。质量为 $m$ 的粒子在一维谐振势 $U(x) = \\frac{1}{2} k x^2$ 中的欠阻尼朗之万动力学由以下随机微分方程给出：\n$$\n\\frac{dx}{dt} = v\n$$\n$$\nm\\frac{dv}{dt} = -kx - \\gamma mv + \\sqrt{2\\gamma m k_{\\mathrm{B}} T}\\,\\eta(t)\n$$\n在质量 $m=1$ 和热能 $k_{\\mathrm{B}}T=1$ 的简化单位中，并使用动量 $p=mv=v$，系统简化为：\n$$\n\\frac{dx}{dt} = p\n$$\n$$\n\\frac{dp}{dt} = -kx - \\gamma p + \\sqrt{2\\gamma}\\,\\eta(t)\n$$\n我们将分析用于这些动力学的 BAOAB 分裂算法。该算法是在一个时间步长 $\\Delta t$ 内顺序应用的五个不同操作的组合。系统的状态由向量 $y = \\begin{bmatrix} x \\\\ p \\end{bmatrix}$ 表示。\n\n1.  **谐振势的 BAOAB 更新步骤**\n\nBAOAB 算法是通过将朗之万刘维尔算子分裂为三部分来构建的：由于位置漂移的更新 (A)，由于保守力的动量踢的更新 (B)，以及在摩擦和随机力作用下控制动量的 Ornstein-Uhlenbeck 过程的精确解 (O)。\n\n设一个步骤开始时的状态为 $(x_n, p_n)$。产生 $(x_{n+1}, p_{n+1})$ 的 BAOAB 积分器的单步操作如下：\n\n-   **B 步骤（半步踢，$\\Delta t/2$）：** 动量由保守力 $F(x) = -kx$ 在半个时间步长内更新。\n    $$\n    p \\leftarrow p + F(x) \\frac{\\Delta t}{2} = p - kx \\frac{\\Delta t}{2}\n    $$\n-   **A 步骤（半步漂移，$\\Delta t/2$）：** 位置由动量在半个时间步长内更新。由于 $m=1$，$v=p$。\n    $$\n    x \\leftarrow x + p \\frac{\\Delta t}{2}\n    $$\n-   **O 步骤（全步 OU 更新，$\\Delta t$）：** 动量通过在整个时间步长 $\\Delta t$ 内精确求解 Ornstein-Uhlenbeck SDE $dp_t = -\\gamma p_t dt + \\sqrt{2\\gamma} dW_t$ 来更新。解为：\n    $$\n    p \\leftarrow p \\cdot e^{-\\gamma \\Delta t} + \\sqrt{k_B T(1 - e^{-2\\gamma \\Delta t})} \\cdot \\xi\n    $$\n    其中 $\\xi \\sim \\mathcal{N}(0,1)$ 是一个标准正态随机变量。在我们的简化单位中，$k_B T=1$，这变为：\n    $$\n    p \\leftarrow p \\cdot e^{-\\gamma \\Delta t} + \\sqrt{1 - e^{-2\\gamma \\Delta t}} \\cdot \\xi\n    $$\n-   **A 步骤（半步漂移，$\\Delta t/2$）：** 第二次位置更新。\n    $$\n    x \\leftarrow x + p \\frac{\\Delta t}{2}\n    $$\n-   **B 步骤（半步踢，$\\Delta t/2$）：** 第二次动量更新。\n    $$\n    p \\leftarrow p - kx \\frac{\\Delta t}{2}\n    $$\n\n2.  **仿射变换矩阵 $M$ 和 $G$**\n\n每个步骤都可以写成对状态向量 $y = \\begin{bmatrix} x \\\\ p \\end{bmatrix}$ 的仿射变换。设 $\\xi_n$ 为第 $n$ 步的标准正态变量。\n\n-   B 步骤矩阵： $M_B = \\begin{pmatrix} 1  0 \\\\ -k \\frac{\\Delta t}{2}  1 \\end{pmatrix}$\n-   A 步骤矩阵： $M_A = \\begin{pmatrix} 1  \\frac{\\Delta t}{2} \\\\ 0  1 \\end{pmatrix}$\n-   O 步骤算子： $y \\to M_O y + G_O \\xi_n$，其中 $M_O = \\begin{pmatrix} 1  0 \\\\ 0  e^{-\\gamma \\Delta t} \\end{pmatrix}$ 且 $G_O = \\begin{pmatrix} 0 \\\\ \\sqrt{1 - e^{-2\\gamma \\Delta t}} \\end{pmatrix}$。\n\n完整的 BAOAB 更新 $y_{n+1} = \\text{B(A(O(A(B(}y_n\\text{)))))}$ 组合如下：\n$$\ny_{n+1} = M_B M_A \\left( M_O \\left( M_A M_B y_n \\right) + G_O \\xi_n \\right)\n$$\n这给出了仿射变换 $y_{n+1} = M y_n + G \\xi_n$，其中：\n$$\nM = M_B M_A M_O M_A M_B \\qquad \\text{且} \\qquad G = M_B M_A G_O\n$$\n我们进行矩阵乘法。首先，我们定义辅助矩阵：\n$M_{AB} = M_A M_B = \\begin{pmatrix} 1  \\frac{\\Delta t}{2} \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ -k\\frac{\\Delta t}{2}  1 \\end{pmatrix} = \\begin{pmatrix} 1 - k\\frac{\\Delta t^2}{4}  \\frac{\\Delta t}{2} \\\\ -k\\frac{\\Delta t}{2}  1 \\end{pmatrix}$\n$M_{BA} = M_B M_A = \\begin{pmatrix} 1  0 \\\\ -k\\frac{\\Delta t}{2}  1 \\end{pmatrix} \\begin{pmatrix} 1  \\frac{\\Delta t}{2} \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 1  \\frac{\\Delta t}{2} \\\\ -k\\frac{\\Delta t}{2}  1 - k\\frac{\\Delta t^2}{4} \\end{pmatrix}$\n\n传播矩阵为 $M = M_{BA} M_O M_{AB}$：\n$$\nM = \\begin{pmatrix} 1  \\frac{\\Delta t}{2} \\\\ -k\\frac{\\Delta t}{2}  1 - k\\frac{\\Delta t^2}{4} \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  e^{-\\gamma \\Delta t} \\end{pmatrix} \\begin{pmatrix} 1 - k\\frac{\\Delta t^2}{4}  \\frac{\\Delta t}{2} \\\\ -k\\frac{\\Delta t}{2}  1 \\end{pmatrix}\n$$\n乘法得出 $M$ 的矩阵元素：\n$$ M_{11} = 1 - \\frac{k\\Delta t^2}{4}(1 + e^{-\\gamma\\Delta t}) $$\n$$ M_{12} = \\frac{\\Delta t}{2}(1 + e^{-\\gamma\\Delta t}) $$\n$$ M_{21} = -\\frac{k\\Delta t}{2}\\left(1 - \\frac{k\\Delta t^2}{4}\\right)(1 + e^{-\\gamma\\Delta t}) $$\n$$ M_{22} = -\\frac{k\\Delta t^2}{4} + \\left(1 - \\frac{k\\Delta t^2}{4}\\right)e^{-\\gamma\\Delta t} $$\n\n噪声向量 $G$ 由 $G = M_{BA} G_O$ 给出：\n$$\nG = \\begin{pmatrix} 1  \\frac{\\Delta t}{2} \\\\ -k\\frac{\\Delta t}{2}  1 - k\\frac{\\Delta t^2}{4} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ \\sqrt{1 - e^{-2\\gamma \\Delta t}} \\end{pmatrix} = \\begin{pmatrix} \\frac{\\Delta t}{2} \\sqrt{1 - e^{-2\\gamma \\Delta t}} \\\\ \\left(1 - \\frac{k\\Delta t^2}{4}\\right) \\sqrt{1 - e^{-2\\gamma \\Delta t}} \\end{pmatrix}\n$$\n\n3.  **稳态构型方差**\n\n由仿射变换定义的马尔可夫链为状态向量 $y$ 生成一个稳态高斯分布，前提是系统稳定。稳态分布的均值为零，协方差矩阵 $\\Sigma = \\mathbb{E}[y y^\\top]$ 满足离散时间李雅普诺夫方程：\n$$\n\\Sigma = M \\Sigma M^\\top + Q\n$$\n其中 $Q = GG^\\top$ 是加性噪声项 $G\\xi_n$ 的协方差。矩阵 $Q$ 为：\n$$\nQ = (1 - e^{-2\\gamma \\Delta t}) \\begin{pmatrix} \\left(\\frac{\\Delta t}{2}\\right)^2  \\frac{\\Delta t}{2}\\left(1 - \\frac{k\\Delta t^2}{4}\\right) \\\\ \\frac{\\Delta t}{2}\\left(1 - \\frac{k\\Delta t^2}{4}\\right)  \\left(1 - \\frac{k\\Delta t^2}{4}\\right)^2 \\end{pmatrix}\n$$\n求解对称 $2 \\times 2$ 矩阵 $\\Sigma$ 的李雅普诺夫方程可得到稳态协方差。构型方差是该矩阵的左上角元素，$\\operatorname{Var}_{\\mathrm{BAOAB}}[x] = \\Sigma_{11}$。该方程可以使用标准的线性代数库进行数值求解。\n\n4.  **构型偏差计算**\n\n连续系统的精确稳态构型方差由能量均分定理给出：$\\operatorname{Var}_{\\mathrm{exact}}[x] = \\frac{k_{\\mathrm{B}}T}{k}$。在本问题的简化单位（$k_{\\mathrm{B}}T=1$）以及弹簧常数 $k=1$ 的特定测试案例中，精确方差为 $\\operatorname{Var}_{\\mathrm{exact}}[x] = 1$。\n\n因此，有符号分数构型偏差定义为：\n$$\n\\mathcal{B}(\\Delta t,\\gamma) = \\frac{\\operatorname{Var}_{\\mathrm{BAOAB}}[x] - \\operatorname{Var}_{\\mathrm{exact}}[x]}{\\operatorname{Var}_{\\mathrm{exact}}[x]} = \\Sigma_{11} - 1\n$$\n下面的程序实现了矩阵 $M$ 和 $Q$ 的构建，并求解李雅普诺夫方程以计算指定测试案例的此偏差。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve_discrete_lyapunov\n\ndef solve():\n    \"\"\"\n    Computes the signed fractional configurational bias of the BAOAB integrator\n    for a harmonic potential in one dimension.\n    \"\"\"\n    \n    # Test cases are provided as pairs of (timestep, friction_coefficient).\n    test_cases = [\n        (0.005, 1.0),\n        (0.050, 1.0),\n        (0.500, 1.0),\n        (1.500, 1.0),\n        (1.900, 1.0),\n        (0.200, 0.1),\n        (0.200, 5.0)\n    ]\n\n    results = []\n    \n    # System parameters in reduced units as specified by the problem.\n    k = 1.0  # spring constant\n    m = 1.0  # mass\n    kBT = 1.0 # thermal energy\n\n    for dt, gamma in test_cases:\n        # Calculate intermediate terms based on the BAOAB splitting.\n        exp_gdt = np.exp(-gamma * dt)\n        exp_2gdt = np.exp(-2.0 * gamma * dt)\n        \n        # 1. Construct the propagator matrix M.\n        # M = M_BA * M_O * M_AB\n        # The elements of M are derived from first principles in the solution text.\n        M = np.zeros((2, 2))\n        M[0, 0] = 1.0 - k * dt**2 / 4.0 * (1.0 + exp_gdt)\n        M[0, 1] = dt / 2.0 * (1.0 + exp_gdt)\n        M[1, 0] = -k * dt / 2.0 * (1.0 - k * dt**2 / 4.0) * (1.0 + exp_gdt)\n        M[1, 1] = -k * dt**2 / 4.0 + (1.0 - k * dt**2 / 4.0) * exp_gdt\n        \n        # 2. Construct the noise covariance matrix Q = G G^T.\n        # G is the noise vector G = M_BA * G_O.\n        sqrt_term = np.sqrt(1.0 - exp_2gdt)\n        g1 = dt / 2.0 * sqrt_term\n        g2 = (1.0 - k * dt**2 / 4.0) * sqrt_term\n        \n        Q = np.array([\n            [g1**2, g1 * g2],\n            [g1 * g2, g2**2]\n        ])\n\n        # 3. Solve the discrete-time Lyapunov equation: Sigma = M Sigma M^T + Q.\n        # The function solve_discrete_lyapunov solves A X A^H + Q = X.\n        # This corresponds to our equation with A=M and X=Sigma.\n        Sigma = solve_discrete_lyapunov(M, Q)\n        \n        # 4. Extract configurational variance and compute the bias.\n        var_baoab_x = Sigma[0, 0]\n        \n        # The exact variance is Var_exact[x] = kBT / k = 1.0 in these units.\n        var_exact_x = kBT / k\n        \n        # The signed fractional bias is (Var_baoab - Var_exact) / Var_exact.\n        bias = (var_baoab_x - var_exact_x) / var_exact_x\n        \n        results.append(bias)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2815946"}]}