{"hands_on_practices": [{"introduction": "本练习通过分析一个最小的双能级系统，帮助你建立对Bethe-Salpeter哈密顿量的基本理解。通过解析求解该模型，你将亲眼见证电子-空穴相互作用如何使简并的跃迁发生分裂，并产生光学活性（“亮”）和非活性（“暗”）的激子，这是光谱学中的一个核心概念。[@problem_id:2463571]", "problem": "考虑一个单重态激子的最小贝特-萨尔佩特方程（BSE）模型，该模型构建在由两个独立的带间跃迁（表示为 $\\{|1\\rangle, |2\\rangle\\}$）组成的基上。每次跃迁具有相同的单粒子激发能 $\\Delta0$。在这个最小模型中，电子-空穴筛选的直接相互作用为两次跃迁增加了相同的对角位移 $U$，而电子-空穴交换相互作用通过一个对称的非对角矩阵元 $X$ 耦合了这两次跃迁。因此，在共振粒子-空穴基 $\\{|1\\rangle, |2\\rangle\\}$ 中，激子哈密顿量是一个 $2\\times 2$ 的实对称矩阵\n$$\nH \\equiv \\begin{pmatrix}\n\\Delta + U  X \\\\\nX  \\Delta + U\n\\end{pmatrix}.\n$$\n激子本征问题为 $H\\,\\boldsymbol{A}=\\Omega\\,\\boldsymbol{A}$，其中 $\\boldsymbol{A}=(A_{1},A_{2})^{\\mathsf{T}}$ 是激子在所选基中的展开系数。沿某一固定偏振方向的光学振子强度与激子跃迁偶极矩的模平方成正比，在此基中为 $|\\boldsymbol{t}\\cdot \\boldsymbol{A}|^{2}$，其中 $\\boldsymbol{t}=(t_{1},t_{2})$ 汇集了单粒子跃迁偶极矩。假设两次跃迁具有相同且共线的偶极矩，即 $t_{1}=t_{2}=t$ 且 $t\\neq 0$。“暗”激子态定义为振子强度为零的态，即 $|\\boldsymbol{t}\\cdot \\boldsymbol{A}|^{2}=0$。\n\n在这些条件下，确定暗态的激子能量 $\\Omega_{\\mathrm{d}}$，用 $\\Delta$、$U$ 和 $X$ 表示为一个封闭形式的表达式。请将最终答案表示为单个解析表达式。不需要数值四舍五入，也不需要单位。", "solution": "首先将对问题陈述进行严格的验证过程。\n\n步骤1：提取已知条件。\n已知条件如下：\n- 一个单重态激子的最小贝特-萨尔佩特方程（BSE）模型。\n- 基由两个独立的带间跃迁组成：$\\{|1\\rangle, |2\\rangle\\}$。\n- 两次跃迁的单粒子激发能：$\\Delta  0$。\n- 筛选的直接相互作用（对角位移）：$U$。\n- 电子-空穴交换相互作用（非对角耦合）：$X$。\n- 激子哈密顿量是一个 $2\\times 2$ 的实对称矩阵：\n$$\nH = \\begin{pmatrix}\n\\Delta + U  X \\\\\nX  \\Delta + U\n\\end{pmatrix}\n$$\n- 激子本征问题为 $H\\,\\boldsymbol{A}=\\Omega\\,\\boldsymbol{A}$。\n- 激子本征矢量为 $\\boldsymbol{A}=(A_{1},A_{2})^{\\mathsf{T}}$。\n- 跃迁偶极矩矢量为 $\\boldsymbol{t}=(t_{1},t_{2})$。\n- 偶极矩的条件是 $t_{1}=t_{2}=t$ 且 $t\\neq 0$。\n- “暗”激子态定义为振子强度为零的态，对应于条件 $|\\boldsymbol{t}\\cdot \\boldsymbol{A}|^{2}=0$。\n\n步骤2：使用提取的已知条件进行验证。\n根据既定标准对问题进行验证。\n- **科学依据**：该问题使用BSE形式主义描述了一个二能级系统中激子的简化但标准的模型。哈密顿量代表了两个简并态通过相互作用耦合的常见情景。这是量子力学和固态物理学中的一个基本概念。该问题在科学上是合理的。\n- **适定性**：该问题被呈现为一个 $2\\times 2$ 对称矩阵的标准本征值问题，该问题总是可解的。“暗”态的条件在数学上是精确的。该问题是适定的，并且对于暗态的能量有唯一的解。\n- **客观性**：语言精确且量化。所有术语都在理论物理学的背景下定义。没有主观或模糊的陈述。\n- 该问题是自洽的、一致的，并提供了得出解决方案所需的所有必要信息。\n\n步骤3：结论与行动。\n该问题被认为是有效的。这是量子力学中的一个标准练习。将提供完整的解答。\n\n激子的能量本征值 $\\Omega$ 和相应的本征矢量 $\\boldsymbol{A}$ 是通过求解不含时薛定谔方程来确定的，其矩阵形式为本征问题 $H\\boldsymbol{A} = \\Omega\\boldsymbol{A}$。本征值通过求解特征方程 $\\det(H - \\Omega I) = 0$ 得到，其中 $I$ 是 $2 \\times 2$ 单位矩阵。\n$$\n\\det\\begin{pmatrix} \\Delta + U - \\Omega  X \\\\ X  \\Delta + U - \\Omega \\end{pmatrix} = 0\n$$\n展开行列式得到久期方程：\n$$\n(\\Delta + U - \\Omega)^{2} - X^{2} = 0\n$$\n求解该方程以得到 $\\Omega$：\n$$\n\\Delta + U - \\Omega = \\pm X\n$$\n$$\n\\Omega = \\Delta + U \\mp X\n$$\n只要 $X\\neq 0$，这就产生两个不同的激子态能量本征值：\n$$\n\\Omega_{1} = \\Delta + U - X\n$$\n$$\n\\Omega_{2} = \\Delta + U + X\n$$\n接下来，我们确定每个本征值对应的本征矢量。\n\n对于本征值 $\\Omega_{1} = \\Delta + U - X$，其本征矢量 $\\boldsymbol{A}_{1} = (A_{1,1}, A_{1,2})^{\\mathsf{T}}$ 通过求解以下方程得到：\n$$\n\\begin{pmatrix} \\Delta + U  X \\\\ X  \\Delta + U \\end{pmatrix} \\begin{pmatrix} A_{1,1} \\\\ A_{1,2} \\end{pmatrix} = (\\Delta + U - X) \\begin{pmatrix} A_{1,1} \\\\ A_{1,2} \\end{pmatrix}\n$$\n这给出了线性方程组：\n$$\n(\\Delta + U)A_{1,1} + X A_{1,2} = (\\Delta + U - X)A_{1,1}\n$$\n简化方程，我们得到：\n$$\nX A_{1,1} + X A_{1,2} = 0\n$$\n$$\nX(A_{1,1} + A_{1,2}) = 0\n$$\n假设耦合 $X$ 不为零（否则这些态是平凡简并且未耦合的，我们稍后可以讨论这种情况），这意味着 $A_{1,1} = -A_{1,2}$。未归一化的本征矢量与 $(1, -1)^{\\mathsf{T}}$ 成正比。\n\n对于本征值 $\\Omega_{2} = \\Delta + U + X$，其本征矢量 $\\boldsymbol{A}_{2} = (A_{2,1}, A_{2,2})^{\\mathsf{T}}$ 通过求解以下方程得到：\n$$\n\\begin{pmatrix} \\Delta + U  X \\\\ X  \\Delta + U \\end{pmatrix} \\begin{pmatrix} A_{2,1} \\\\ A_{2,2} \\end{pmatrix} = (\\Delta + U + X) \\begin{pmatrix} A_{2,1} \\\\ A_{2,2} \\end{pmatrix}\n$$\n这给出了方程：\n$$\n(\\Delta + U)A_{2,1} + X A_{2,2} = (\\Delta + U + X)A_{2,1}\n$$\n简化后，我们得到：\n$$\n-X A_{2,1} + X A_{2,2} = 0\n$$\n$$\nX(-A_{2,1} + A_{2,2}) = 0\n$$\n再次假设 $X \\neq 0$，这意味着 $A_{2,1} = A_{2,2}$。未归一化的本征矢量与 $(1, 1)^{\\mathsf{T}}$ 成正比。\n\n现在，我们必须识别“暗”态。如果一个态的振子强度为零，则该态是暗态。振子强度与 $|\\boldsymbol{t}\\cdot \\boldsymbol{A}|^{2}$ 成正比，其中 $\\boldsymbol{t} = (t_{1}, t_{2})$。已知 $t_{1} = t_{2} = t$ 且 $t \\neq 0$。因此，$\\boldsymbol{t} = (t, t)$。\n暗态的条件是 $|\\boldsymbol{t}\\cdot \\boldsymbol{A}|^{2}=0$，这等价于 $\\boldsymbol{t}\\cdot \\boldsymbol{A}=0$。\n$$\n\\boldsymbol{t}\\cdot \\boldsymbol{A} = (t, t) \\cdot \\begin{pmatrix} A_{1} \\\\ A_{2} \\end{pmatrix} = tA_{1} + tA_{2} = t(A_{1} + A_{2}) = 0\n$$\n由于 $t \\neq 0$，暗态的条件简化为：\n$$\nA_{1} + A_{2} = 0\n$$\n我们对找到的两个本征矢量检查此条件。\n- 对于能量为 $\\Omega_{1} = \\Delta + U - X$ 的态，其本征矢量分量满足 $A_{1,1} = -A_{1,2}$。因此，$A_{1,1} + A_{1,2} = -A_{1,2} + A_{1,2} = 0$。此条件满足。该态是暗激子。\n- 对于能量为 $\\Omega_{2} = \\Delta + U + X$ 的态，其本征矢量分量满足 $A_{2,1} = A_{2,2}$。因此，$A_{2,1} + A_{2,2} = A_{2,2} + A_{2,2} = 2A_{2,2}$。仅当 $A_{2,2}=0$ 时，此表达式为零，这意味着本征矢量是零矢量，这不是一个有效的物理态。因此，该态不是暗态；它是“明”态。\n\n暗态的能量 $\\Omega_{\\mathrm{d}}$ 是对应于满足暗态条件的本征矢量的本征值。即 $\\Omega_{1}$。\n因此，暗态的激子能量为：\n$$\n\\Omega_{\\mathrm{d}} = \\Delta + U - X\n$$\n如果我们考虑 $X=0$ 的情况，哈密顿量是对角的，$H = (\\Delta+U)I$。任何矢量都是本征矢量，具有简并能量 $\\Omega = \\Delta+U$。我们仍然可以构造基态的“对称”和“反对称”组合。本征矢量与 $(1, -1)^{\\mathsf{T}}$ 成比例的态是暗态，能量为 $\\Delta+U$。我们的公式给出 $\\Omega_{\\mathrm{d}} = \\Delta+U-0 = \\Delta+U$，因此它仍然是正确的。\n最终答案是推导出的暗激子能量的解析表达式。", "answer": "$$\n\\boxed{\\Delta + U - X}\n$$", "id": "2463571"}, {"introduction": "在简单模型的基础上，本练习将探讨BSE计算中的实际选择如何影响最终结果。你将从两种不同的电子结构理论（Hartree-Fock和DFT）出发，计算激子束缚能这一关键的实验可观测量。此练习旨在强调底层平均场计算的关键作用，以及它对于准确预测材料光学性质的重要性。[@problem_id:2463567]", "problem": "题目给出了一个简化的 Bethe-Salpeter 方程 (BSE) 模型，该模型用于描述 Tamm-Dancoff 近似 (TDA) 下的单重态激子，并构建在单粒子跃迁的离散基上。设存在 $N$ 个独立的单粒子跃迁，由索引 $i \\in \\{1,\\dots,N\\}$ 标记。每次跃迁对应于将一个电子从占据态 $\\ket{v_i}$ 激发到未占据态 $\\ket{c_i}$，其无相互作用能量差为 $\\Delta_i = \\epsilon_{c_i} - \\epsilon_{v_i}$，单位为电子伏特 (eV)。在此基下，用于单重态激发的 BSE-TDA 激子哈密顿量是一个 $N \\times N$ 的厄米矩阵\n$$\nH_{ij} \\;=\\; \\Delta_i \\,\\delta_{ij} \\;+\\; K_{ij},\n$$\n其中相互作用核为\n$$\nK_{ij} \\;=\\; -\\,W_{ij} \\;+\\; 2\\,v_{ij}.\n$$\n此处，$W_{ij}$ 是静态屏蔽的直接电子-空穴相互作用（单位 eV），$v_{ij}$ 是裸交换相互作用（单位 eV）。所有量均为实数，所有矩阵均为对称矩阵。$H$ 的最小本征值（记为 $E_0$）是最低单重态激子能量（单位 eV）。准粒子带隙定义为\n$$\nE_g \\;=\\; \\min_i \\Delta_i,\n$$\n单重态激子束缚能为\n$$\nE_b \\;=\\; E_g \\;-\\; E_0,\n$$\n以 eV 表示。\n\n每个测试用例提供两组参数：\n- 一组标记为 Hartree-Fock (HF)，代表 $\\{\\Delta_i^{\\mathrm{HF}}\\}$、$W^{\\mathrm{HF}}$ 和 $v^{\\mathrm{HF}}$。\n- 一组标记为密度泛函理论与 Perdew-Burke-Ernzerhof 泛函 (DFT-PBE)，代表 $\\{\\Delta_i^{\\mathrm{PBE}}\\}$、$W^{\\mathrm{PBE}}$ 和 $v^{\\mathrm{PBE}}$。\n\n对于每个测试用例，计算 $E_b^{\\mathrm{HF}}$、$E_b^{\\mathrm{PBE}}$ 以及差值 $\\Delta E_b = E_b^{\\mathrm{HF}} - E_b^{\\mathrm{PBE}}$，均以 eV 为单位。报告这三个量，每个量均四舍五入到六位小数。\n\n要求的最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个元素本身是一个包含三个浮点数 $[E_b^{\\mathrm{HF}},E_b^{\\mathrm{PBE}},\\Delta E_b]$ 的列表（单位 eV），每个浮点数都四舍五入到六位小数。例如，输出必须具有以下形式：\n$$\n[\\,[x_1,y_1,z_1],\\,[x_2,y_2,z_2],\\,\\dots\\,]\n$$\n不含任何额外文本。\n\n使用以下包含四个用例的测试套件。所有能量单位均为 eV。\n\n测试用例 1（一般情况，$N=3$）：\n- $$\\Delta^{\\mathrm{HF}} = \\begin{bmatrix} 7.2 \\\\ 7.9 \\\\ 8.5 \\end{bmatrix}, \\quad\n\\Delta^{\\mathrm{PBE}} = \\begin{bmatrix} 3.8 \\\\ 4.4 \\\\ 4.9 \\end{bmatrix}.$$\n- $$W^{\\mathrm{HF}} = \\begin{bmatrix}\n0.65  0.22  0.18 \\\\\n0.22  0.60  0.20 \\\\\n0.18  0.20  0.55\n\\end{bmatrix}, \\quad\nv^{\\mathrm{HF}} = \\begin{bmatrix}\n0.12  0.05  0.04 \\\\\n0.05  0.11  0.05 \\\\\n0.04  0.05  0.10\n\\end{bmatrix}.$$\n- $$W^{\\mathrm{PBE}} = \\begin{bmatrix}\n0.45  0.18  0.15 \\\\\n0.18  0.42  0.16 \\\\\n0.15  0.16  0.40\n\\end{bmatrix}, \\quad\nv^{\\mathrm{PBE}} = \\begin{bmatrix}\n0.10  0.04  0.03 \\\\\n0.04  0.09  0.04 \\\\\n0.03  0.04  0.08\n\\end{bmatrix}.$$\n\n测试用例 2（零相互作用的边界情况，$N=2$）：\n- $$\\Delta^{\\mathrm{HF}} = \\begin{bmatrix} 6.0 \\\\ 6.5 \\end{bmatrix}, \\quad\n\\Delta^{\\mathrm{PBE}} = \\begin{bmatrix} 3.0 \\\\ 3.5 \\end{bmatrix}.$$\n- $$W^{\\mathrm{HF}} = \\begin{bmatrix} 0.0  0.0 \\\\ 0.0  0.0 \\end{bmatrix}, \\quad\nv^{\\mathrm{HF}} = \\begin{bmatrix} 0.0  0.0 \\\\ 0.0  0.0 \\end{bmatrix}.$$\n- $$W^{\\mathrm{PBE}} = \\begin{bmatrix} 0.0  0.0 \\\\ 0.0  0.0 \\end{bmatrix}, \\quad\nv^{\\mathrm{PBE}} = \\begin{bmatrix} 0.0  0.0 \\\\ 0.0  0.0 \\end{bmatrix}.$$\n\n测试用例 3（强耦合，$N=3$）：\n- $$\\Delta^{\\mathrm{HF}} = \\begin{bmatrix} 6.5 \\\\ 6.7 \\\\ 7.0 \\end{bmatrix}, \\quad\n\\Delta^{\\mathrm{PBE}} = \\begin{bmatrix} 3.2 \\\\ 3.3 \\\\ 3.5 \\end{bmatrix}.$$\n- $$W^{\\mathrm{HF}} = \\begin{bmatrix}\n1.20  0.50  0.45 \\\\\n0.50  1.10  0.40 \\\\\n0.45  0.40  1.00\n\\end{bmatrix}, \\quad\nv^{\\mathrm{HF}} = \\begin{bmatrix}\n0.22  0.10  0.09 \\\\\n0.10  0.20  0.08 \\\\\n0.09  0.08  0.18\n\\end{bmatrix}.$$\n- $$W^{\\mathrm{PBE}} = \\begin{bmatrix}\n0.75  0.32  0.30 \\\\\n0.32  0.70  0.28 \\\\\n0.30  0.28  0.65\n\\end{bmatrix}, \\quad\nv^{\\mathrm{PBE}} = \\begin{bmatrix}\n0.18  0.08  0.07 \\\\\n0.08  0.17  0.07 \\\\\n0.07  0.07  0.16\n\\end{bmatrix}.$$\n\n测试用例 4（近简并，$N=2$）：\n- $$\\Delta^{\\mathrm{HF}} = \\begin{bmatrix} 7.0 \\\\ 7.0 \\end{bmatrix}, \\quad\n\\Delta^{\\mathrm{PBE}} = \\begin{bmatrix} 4.0 \\\\ 4.0 \\end{bmatrix}.$$\n- $$W^{\\mathrm{HF}} = \\begin{bmatrix} 0.90  0.40 \\\\ 0.40  0.88 \\end{bmatrix}, \\quad\nv^{\\mathrm{HF}} = \\begin{bmatrix} 0.25  0.12 \\\\ 0.12  0.24 \\end{bmatrix}.$$\n- $$W^{\\mathrm{PBE}} = \\begin{bmatrix} 0.55  0.22 \\\\ 0.22  0.52 \\end{bmatrix}, \\quad\nv^{\\mathrm{PBE}} = \\begin{bmatrix} 0.20  0.10 \\\\ 0.10  0.19 \\end{bmatrix}.$$\n\n为每个测试用例计算并报告三元组 $[E_b^{\\mathrm{HF}},E_b^{\\mathrm{PBE}},\\Delta E_b]$（单位 eV），其中每个数字都四舍五入到六位小数。最终的程序输出必须是遵循以下确切格式的单行文本：\n$$\n[\\,[E_b^{\\mathrm{HF}}(1),E_b^{\\mathrm{PBE}}(1),\\Delta E_b(1)],\\,[E_b^{\\mathrm{HF}}(2),E_b^{\\mathrm{PBE}}(2),\\Delta E_b(2)],\\,[E_b^{\\mathrm{HF}}(3),E_b^{\\mathrm{PBE}}(3),\\Delta E_b(3)],\\,[E_b^{\\mathrm{HF}}(4),E_b^{\\mathrm{PBE}}(4),\\Delta E_b(4)]\\,].\n$$", "solution": "所述问题在科学上和数学上都是提法恰当、完整的，并且没有歧义。所有提供的数据和定义都与计算化学和凝聚态物理中使用的多体微扰理论的既定原则相一致。该任务是一个标准理论模型的直接数值实现。因此，可以推导出解决方案。\n\n目标是计算在两个不同的理论起点——Hartree-Fock ($HF$) 和密度泛函理论 ($DFT$-$PBE$)——下的单重态激子束缚能 $E_b$，然后求出这两个结果之间的差值。对于四个不同的测试用例，需要重复此过程。\n\n理论基础是在 Tamm-Dancoff 近似 ($TDA$) 内的 Bethe-Salpeter 方程 ($BSE$)。对于单重态激发，激子哈密顿量 $H$ 在一个由 $N$ 个从占据态 $\\ket{v_i}$ 到未占据态 $\\ket{c_i}$ 的单粒子跃迁构成的离散基上构建。哈密顿矩阵的元素由下式给出：\n$$\nH_{ij} = \\Delta_i \\delta_{ij} + K_{ij}\n$$\n此处，$\\Delta_i = \\epsilon_{c_i} - \\epsilon_{v_i}$ 是无相互作用跃迁的能量差，$\\delta_{ij}$ 是克罗内克 δ。矩阵 $K$ 是相互作用核，对于单重态激子，其形式为：\n$$\nK_{ij} = -W_{ij} + 2v_{ij}\n$$\n其中 $W_{ij}$ 是静态屏蔽的直接电子-空穴库仑相互作用，$v_{ij}$ 是裸交换相互作用。所有矩阵都是实数且对称的。\n\n对于给定的一组参数 ($\\{\\Delta_i\\}$, $W$, $v$)，确定束缚能 $E_b$ 的计算步骤如下：\n\n1.  **构建相互作用核矩阵 $K$**：\n    对于从 $1$ 到 $N$ 的每一对索引 $(i, j)$，使用提供的屏蔽相互作用矩阵 $W$ 和裸交换矩阵 $v$ 来计算核矩阵元素 $K_{ij}$。计算公式为 $K = -W + 2v$。\n\n2.  **构建激子哈密顿矩阵 $H$**：\n    哈密顿量 $H$ 是通过将跃迁能的对角矩阵 $\\text{diag}(\\Delta)$ 与核 $K$ 相加而形成的。用矩阵形式表示为 $H = \\text{diag}(\\Delta_1, \\Delta_2, \\dots, \\Delta_N) + K$。\n\n3.  **确定最低激子能量 $E_0$**：\n    哈密顿量 $H$ 是一个实的、对称的 $N \\times N$ 矩阵。其本征值代表激子态的能量。我们必须求解本征值问题 $H \\Psi = E \\Psi$。最低激子能量 $E_0$ 是 $H$ 的最小本征值。\n    $$\n    E_0 = \\min(\\text{eig}(H))\n    $$\n    这是一个标准的数值线性代数任务，通过对矩阵 $H$ 进行对角化来完成。\n\n4.  **确定准粒子带隙 $E_g$**：\n    准粒子带隙 $E_g$ 定义为创建一个无相互作用的电子-空穴对所需的最小能量。这对应于所提供的最小单粒子跃迁能。\n    $$\n    E_g = \\min_{i} \\Delta_i\n    $$\n\n5.  **计算激子束缚能 $E_b$**：\n    激子束缚能是电子和空穴通过相互作用结合在一起所获得的能量，相对于无相互作用状态而言。它是准粒子带隙与最低激子能量之间的差值。\n    $$\n    E_b = E_g - E_0\n    $$\n\n对每个测试用例，整个过程执行两次：一次使用 Hartree-Fock 参数（$\\Delta^{\\mathrm{HF}}$, $W^{\\mathrm{HF}}$, $v^{\\mathrm{HF}}$）得到 $E_b^{\\mathrm{HF}}$，另一次使用 DFT-PBE 参数（$\\Delta^{\\mathrm{PBE}}$, $W^{\\mathrm{PBE}}$, $v^{\\mathrm{PBE}}$）得到 $E_b^{\\mathrm{PBE}}$。\n\n最后，束缚能的差值计算如下：\n$$\n\\Delta E_b = E_b^{\\mathrm{HF}} - E_b^{\\mathrm{PBE}}\n$$\n问题要求为每个测试用例报告这三个值 $[E_b^{\\mathrm{HF}}, E_b^{\\mathrm{PBE}}, \\Delta E_b]$，每个数值都四舍五入到六位小数。实现将使用 `NumPy` 库进行高效的矩阵运算和本征值计算。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Bethe-Salpeter equation for excitons for the given test cases.\n    \"\"\"\n    test_cases = [\n        {\n            # Test Case 1 (general case, N=3)\n            \"hf\": {\n                \"delta\": np.array([7.2, 7.9, 8.5]),\n                \"W\": np.array([[0.65, 0.22, 0.18], [0.22, 0.60, 0.20], [0.18, 0.20, 0.55]]),\n                \"v\": np.array([[0.12, 0.05, 0.04], [0.05, 0.11, 0.05], [0.04, 0.05, 0.10]])\n            },\n            \"pbe\": {\n                \"delta\": np.array([3.8, 4.4, 4.9]),\n                \"W\": np.array([[0.45, 0.18, 0.15], [0.18, 0.42, 0.16], [0.15, 0.16, 0.40]]),\n                \"v\": np.array([[0.10, 0.04, 0.03], [0.04, 0.09, 0.04], [0.03, 0.04, 0.08]])\n            }\n        },\n        {\n            # Test Case 2 (boundary case with zero interaction, N=2)\n            \"hf\": {\n                \"delta\": np.array([6.0, 6.5]),\n                \"W\": np.array([[0.0, 0.0], [0.0, 0.0]]),\n                \"v\": np.array([[0.0, 0.0], [0.0, 0.0]])\n            },\n            \"pbe\": {\n                \"delta\": np.array([3.0, 3.5]),\n                \"W\": np.array([[0.0, 0.0], [0.0, 0.0]]),\n                \"v\": np.array([[0.0, 0.0], [0.0, 0.0]])\n            }\n        },\n        {\n            # Test Case 3 (strong coupling, N=3)\n            \"hf\": {\n                \"delta\": np.array([6.5, 6.7, 7.0]),\n                \"W\": np.array([[1.20, 0.50, 0.45], [0.50, 1.10, 0.40], [0.45, 0.40, 1.00]]),\n                \"v\": np.array([[0.22, 0.10, 0.09], [0.10, 0.20, 0.08], [0.09, 0.08, 0.18]])\n            },\n            \"pbe\": {\n                \"delta\": np.array([3.2, 3.3, 3.5]),\n                \"W\": np.array([[0.75, 0.32, 0.30], [0.32, 0.70, 0.28], [0.30, 0.28, 0.65]]),\n                \"v\": np.array([[0.18, 0.08, 0.07], [0.08, 0.17, 0.07], [0.07, 0.07, 0.16]])\n            }\n        },\n        {\n            # Test Case 4 (near-degeneracy, N=2)\n            \"hf\": {\n                \"delta\": np.array([7.0, 7.0]),\n                \"W\": np.array([[0.90, 0.40], [0.40, 0.88]]),\n                \"v\": np.array([[0.25, 0.12], [0.12, 0.24]])\n            },\n            \"pbe\": {\n                \"delta\": np.array([4.0, 4.0]),\n                \"W\": np.array([[0.55, 0.22], [0.22, 0.52]]),\n                \"v\": np.array([[0.20, 0.10], [0.10, 0.19]])\n            }\n        }\n    ]\n\n    def calculate_binding_energy(delta, W, v):\n        \"\"\"\n        Calculates the exciton binding energy from the BSE Hamiltonian components.\n        \n        Args:\n            delta (np.ndarray): Vector of noninteracting transition energies.\n            W (np.ndarray): Matrix of the statically screened direct interaction.\n            v (np.ndarray): Matrix of the bare exchange interaction.\n            \n        Returns:\n            float: The exciton binding energy, Eb.\n        \"\"\"\n        # Construct the interaction kernel K = -W + 2v\n        K = -W + 2 * v\n        \n        # Construct the Hamiltonian H = diag(delta) + K\n        H = np.diag(delta) + K\n        \n        # Find the eigenvalues of the real symmetric Hamiltonian H\n        # np.linalg.eigh is suitable for Hermitian (or real symmetric) matrices\n        eigenvalues = np.linalg.eigh(H)[0]\n        \n        # The lowest exciton energy E0 is the minimum eigenvalue\n        E0 = np.min(eigenvalues)\n        \n        # The quasiparticle gap Eg is the minimum transition energy\n        Eg = np.min(delta)\n        \n        # The binding energy Eb = Eg - E0\n        Eb = Eg - E0\n        \n        return Eb\n\n    final_results = []\n    for case in test_cases:\n        # Calculate for Hartree-Fock\n        Eb_hf = calculate_binding_energy(case[\"hf\"][\"delta\"], case[\"hf\"][\"W\"], case[\"hf\"][\"v\"])\n        \n        # Calculate for DFT-PBE\n        Eb_pbe = calculate_binding_energy(case[\"pbe\"][\"delta\"], case[\"pbe\"][\"W\"], case[\"pbe\"][\"v\"])\n        \n        # Calculate the difference\n        delta_Eb = Eb_hf - Eb_pbe\n        \n        # Format results to six decimal places and append\n        result_triple = [f\"{Eb_hf:.6f}\", f\"{Eb_pbe:.6f}\", f\"{delta_Eb:.6f}\"]\n        final_results.append(f\"[{', '.join(result_triple)}]\")\n    \n    # Print the final result string in the required format\n    print(f\"[{', '.join(final_results)}]\")\n\nsolve()\n```", "id": "2463567"}, {"introduction": "对真实材料进行BSE计算的资源消耗可能非常巨大，这主要源于存储和处理屏蔽库仑相互作用矩阵 $W$ 的开销。最后一个练习将焦点转向计算成本这一实际挑战，要求你估算存储 $W$ 所需的内存。你还将探索低秩分解等先进技术如何显著降低这些成本，从而使大规模计算成为可能。[@problem_id:2810870]", "problem": "在用于计算激子的 Bethe–Salpeter 方程 (BSE) 中，倒易空间中的静态屏蔽库仑相互作用（表示为 $W_{\\mathbf{G}\\mathbf{G}'}(\\mathbf{q})$）通过一个经过充分检验的关系式 $W_{\\mathbf{G}\\mathbf{G}'}(\\mathbf{q}) = v_{\\mathbf{G}}(\\mathbf{q})^{1/2}\\,\\epsilon^{-1}_{\\mathbf{G}\\mathbf{G}'}(\\mathbf{q})\\,v_{\\mathbf{G}'}(\\mathbf{q})^{1/2}$ 与逆介电矩阵相关联，其中 $v_{\\mathbf{G}}(\\mathbf{q})$ 是倒易空间中的裸库仑相互作用。在静态极限下，$\\epsilon^{-1}_{\\mathbf{G}\\mathbf{G}'}(\\mathbf{q})$ 是厄米矩阵，因此对于每个波矢 $\\mathbf{q}$，$W_{\\mathbf{G}\\mathbf{G}'}(\\mathbf{q})$ 都是一个复厄米矩阵。考虑一个周期性固体，其 BSE 核是构建在一个包含 $N_{q}^{\\mathrm{irr}}$ 个不可约波矢的集合上，并且在每个 $\\mathbf{q}$ 点使用包含 $N_{G}$ 个倒格矢的平面波基组。假设使用复双精度存储，每个复标量需要 $b_{\\mathbb{C}} = 16$ 字节。可以假设只存储每个厄米矩阵的上三角部分（包括对角线）。\n\n(a) 从厄米性质出发，通过计算独立矩阵元的数量，推导存储整个不可约集合上所有 $W_{\\mathbf{G}\\mathbf{G}'}(\\mathbf{q})$ 所需的总内存占用 $M_{\\mathrm{full}}$（以字节为单位）的符号表达式。用 $N_{G}$、$N_{q}^{\\mathrm{irr}}$ 和 $b_{\\mathbb{C}}$ 表示结果。\n\n(b) 对 (a) 部分的表达式，代入 $N_{G} = 8000$，$N_{q}^{\\mathrm{irr}} = 100$ 和 $b_{\\mathbb{C}} = 16$ 进行求值。使用十进制约定 $1~\\mathrm{GB} = 10^{9}$ 字节将结果转换为吉字节 (GB)。将答案四舍五入至四位有效数字，并以 $\\mathrm{GB}$ 为单位表示。\n\n(c) 为降低存储成本，考虑对每个 $\\mathbf{q}$ 进行低秩分解，形式为 $W_{\\mathbf{G}\\mathbf{G}'}(\\mathbf{q}) \\approx \\sum_{k=1}^{r} L_{\\mathbf{G}k}(\\mathbf{q})\\,L^{*}_{\\mathbf{G}'k}(\\mathbf{q})$，其中 $L(\\mathbf{q})$ 是一个 $N_{G} \\times r$ 的复数矩阵。假设对每个 $\\mathbf{q}$ 只存储 $L(\\mathbf{q})$，推导总存储量 $M_{\\mathrm{LR}}$（以字节为单位）关于 $N_{G}$、$N_{q}^{\\mathrm{irr}}$、$r$ 和 $b_{\\mathbb{C}}$ 的符号表达式。给定内存预算（上限）为 $M_{\\mathrm{cap}} = 32~\\mathrm{GB}$，使用与 (b) 部分相同的 $N_{G}$、$N_{q}^{\\mathrm{irr}}$ 和 $b_{\\mathbb{C}}$，计算满足 $M_{\\mathrm{LR}} \\le M_{\\mathrm{cap}}$ 的最大允许整数秩 $r_{\\max}$。报告 $r_{\\max}$ 作为你的最终答案。\n\n在你的解答中，简要地（定性地）论证为什么在此背景下，低秩压缩或动态实时（on-the-fly）屏蔽在物理上和计算上是合理的。最终答案必须是无单位的单个数字 $r_{\\max}$。", "solution": "所提出的问题是在计算资源估算方面一个独立的、具有科学依据的练习，与理论化学和凝聚态物理领域相关。该问题表述清晰，没有逻辑或事实上的不一致。因此，我们直接进行求解。\n\n问题要求我们分析静态屏蔽库仑相互作用 $W_{\\mathbf{G}\\mathbf{G}'}(\\mathbf{q})$ 的内存存储需求，这是 Bethe-Salpeter 方程 (BSE) 计算中的一个核心量。\n\n(a) 总存储成本 $M_{\\mathrm{full}}$ 的推导。\n对于不可约集中的每个波矢 $\\mathbf{q}$，矩阵 $W(\\mathbf{q})$ 是一个 $N_{G} \\times N_{G}$ 的复厄米矩阵。厄米性质定义为 $W_{\\mathbf{G}\\mathbf{G}'}(\\mathbf{q}) = W^{*}_{\\mathbf{G}'\\mathbf{G}}(\\mathbf{q})$，其中星号表示复共轭。此性质意味着对角元 $W_{\\mathbf{G}\\mathbf{G}}(\\mathbf{q})$ 是实数，而位于 $\\mathbf{G}$ 行、$\\mathbf{G}'$ 列的非对角元是位于 $\\mathbf{G}'$ 行、$\\mathbf{G}$ 列元素的复共轭。\n\n为避免冗余存储，标准做法是只存储主对角线及其上方的元素（即上三角部分，包括对角线）。对于一个 $N_{G} \\times N_{G}$ 矩阵，对角元素的数量为 $N_{G}$。非对角元素的数量为 $N_{G}^2 - N_{G}$。上三角部分中独立非对角元素的数量是其一半，即 $\\frac{N_{G}(N_{G}-1)}{2}$。\n\n因此，存储单个厄米矩阵 $W(\\mathbf{q})$ 所需的复标量总数为对角元和上三角非对角元数量之和：\n$$ N_{\\text{elements per matrix}} = N_{G} + \\frac{N_{G}(N_{G}-1)}{2} = \\frac{2N_{G} + N_{G}^2 - N_{G}}{2} = \\frac{N_{G}^2 + N_{G}}{2} = \\frac{N_{G}(N_{G}+1)}{2} $$\n这些元素中的每一个都是复数，需要 $b_{\\mathbb{C}}$ 字节的存储空间。一个矩阵的总存储量为 $\\frac{N_{G}(N_{G}+1)}{2} \\times b_{\\mathbb{C}}$。\n\n问题指明，这些矩阵是为包含 $N_{q}^{\\mathrm{irr}}$ 个波矢的不可约集计算的。假设每个 $\\mathbf{q}$ 对应的矩阵是独立的并且都必须存储，那么总内存占用 $M_{\\mathrm{full}}$ 是单个矩阵的存储量乘以矩阵的数量：\n$$ M_{\\mathrm{full}} = N_{q}^{\\mathrm{irr}} \\times \\frac{N_{G}(N_{G}+1)}{2} \\times b_{\\mathbb{C}} $$\n这就是所要求的符号表达式。\n\n(b) $M_{\\mathrm{full}}$ 的求值。\n给定参数 $N_{G} = 8000$，$N_{q}^{\\mathrm{irr}} = 100$ 和 $b_{\\mathbb{C}} = 16$ 字节。将这些值代入我们推导的表达式中：\n$$ M_{\\mathrm{full}} = 100 \\times \\frac{8000(8000+1)}{2} \\times 16 $$\n$$ M_{\\mathrm{full}} = 100 \\times \\frac{8000 \\times 8001}{2} \\times 16 = 100 \\times (4000 \\times 8001) \\times 16 $$\n$$ M_{\\mathrm{full}} = 100 \\times 32004000 \\times 16 = 51206400000~\\text{bytes} $$\n为了将此结果转换为吉字节 (GB)，我们使用约定 $1~\\mathrm{GB} = 10^{9}$ 字节：\n$$ M_{\\mathrm{full}} = \\frac{51206400000}{10^9}~\\mathrm{GB} = 51.2064~\\mathrm{GB} $$\n四舍五入到四位有效数字，内存需求为 $51.21~\\mathrm{GB}$。如此巨大的内存成本促使人们使用压缩技术。\n\n(c) 低秩分解与最大秩 $r_{\\max}$。\n问题引入了 $W(\\mathbf{q})$ 的一个低秩近似：\n$$ W_{\\mathbf{G}\\mathbf{G}'}(\\mathbf{q}) \\approx \\sum_{k=1}^{r} L_{\\mathbf{G}k}(\\mathbf{q})\\,L^{*}_{\\mathbf{G}'k}(\\mathbf{q}) $$\n这可以写成矩阵形式 $W(\\mathbf{q}) \\approx L(\\mathbf{q})L^{\\dagger}(\\mathbf{q})$，其中 $L(\\mathbf{q})$ 是一个 $N_{G} \\times r$ 的复数矩阵。我们只需存储因子矩阵 $L(\\mathbf{q})$，而不必存储完整的 $N_{G} \\times N_{G}$ 矩阵 $W(\\mathbf{q})$。\n\n矩阵 $L(\\mathbf{q})$ 中复元素的数量为 $N_{G} \\times r$。存储一个这样的矩阵所需的空间为 $N_{G} \\times r \\times b_{\\mathbb{C}}$。\n同前，我们必须为 $N_{q}^{\\mathrm{irr}}$ 个波矢中的每一个存储一个这样的因子矩阵。低秩近似的总存储量 $M_{\\mathrm{LR}}$ 为：\n$$ M_{\\mathrm{LR}} = N_{q}^{\\mathrm{irr}} \\times N_{G} \\times r \\times b_{\\mathbb{C}} $$\n给定内存预算 $M_{\\mathrm{cap}} = 32~\\mathrm{GB} = 32 \\times 10^9$ 字节。我们必须找到最大整数秩 $r_{\\max}$，使得 $M_{\\mathrm{LR}} \\le M_{\\mathrm{cap}}$。\n$$ N_{q}^{\\mathrm{irr}} \\times N_{G} \\times r_{\\max} \\times b_{\\mathbb{C}} \\le M_{\\mathrm{cap}} $$\n求解 $r_{\\max}$：\n$$ r_{\\max} \\le \\frac{M_{\\mathrm{cap}}}{N_{q}^{\\mathrm{irr}} \\times N_{G} \\times b_{\\mathbb{C}}} $$\n代入给定值：\n$$ r_{\\max} \\le \\frac{32 \\times 10^9}{100 \\times 8000 \\times 16} = \\frac{32 \\times 10^9}{10^2 \\times 8 \\times 10^3 \\times 16} = \\frac{32 \\times 10^9}{128 \\times 10^5} $$\n$$ r_{\\max} \\le \\frac{32}{128} \\times 10^{9-5} = 0.25 \\times 10^4 = 2500 $$\n由于不等式给出了一个整数界，最大允许的整数秩为 $r_{\\max} = 2500$。\n\n定性论证：\n介电矩阵（并延伸至屏蔽库仑相互作用 $W$）的低秩近似的物理依据在于电子屏蔽的本质。介电矩阵 $\\epsilon^{-1}_{\\mathbf{G}\\mathbf{G}'}(\\mathbf{q})$ 描述了电子对外部势的微观响应。这种响应主要由相对少数的集体电子模式（如等离激元）主导。因此，介电矩阵的本征值谱通常表现出快速衰减的特性。少数本征值显著偏离 1（无屏蔽极限），而大多数本征值则接近 1。这意味着该矩阵在“物理上”是低秩的，因为其最重要的特征可以被与这些主导本征值相对应的本征向量所张成的基底所捕捉。\n\n从计算的角度来看，诸如低秩压缩之类的方法对于可行性至关重要。如 (b) 部分所示，对于实际系统尺寸，存储完整的 $W$ 矩阵需要巨大的内存资源（本例中  50 GB），其内存需求随基组大小呈二次方增长，即 $O(N_G^2)$。低秩方法将这种规模缩放关系降低为线性依赖关系 $O(N_G r)$，其中秩 $r$ 通常远小于 $N_G$。另一种方法是“动态实时（on-the-fly）”计算，即在需要时重新计算矩阵元或矩阵向量积，以此用增加的计算时间换取内存空间的节省。当内存是主要限制因素，或者当重新计算的成本低于从慢速磁盘存储中检索预先计算好的数据的延迟时，这种做法是合理的。这些策略之间的选择取决于具体的硬件架构和问题参数。", "answer": "$$\n\\boxed{2500}\n$$", "id": "2810870"}]}