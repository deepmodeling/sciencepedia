{"hands_on_practices": [{"introduction": "理解贝里相位始于其局域的根源——贝里曲率。本练习提供了一个基础性的计算，从一个通用的二能级量子系统（在布洛赫球上参数化）出发，运用第一性原理推导贝里联络和贝里曲率。此练习旨在揭示锥形交叉与磁单极子场之间的深刻联系，这是该领域的一个基石概念 [@problem_id:2762686]。", "problem": "在玻恩-奥本海默近似（Born–Oppenheimer approximation, BOA）中，电子态沿着核坐标（参数）空间中的一条闭合路径进行绝热输运时，会积累一个几何相位，该相位由贝里联络和贝里曲率表征。考虑一个锥形交叉附近与化学相关的两能级电子子空间，其中的绝热本征态可以通过布洛赫球面上的单位矢量 $\\hat{\\boldsymbol n}(\\theta,\\phi)$ 进行参数化。设 $\\theta$ 和 $\\phi$ 分别表示标准的极角和方位角（以弧度为单位），并设 $\\boldsymbol{\\sigma}$ 表示泡利矩阵矢量。选择北半球坐标片上的归一化绝热本征态为\n$$\n|u(\\theta,\\phi)\\rangle = \\begin{pmatrix} \\cos\\left(\\frac{\\theta}{2}\\right) \\\\ \\exp(-i\\phi)\\sin\\left(\\frac{\\theta}{2}\\right) \\end{pmatrix},\n$$\n该本征态在远离南极点处是光滑的。仅使用核心定义：\n- 贝里联络（贝里规范势）$\\,\\boldsymbol{\\mathcal A}(\\theta,\\phi)\\,$，其分量为 $\\,\\mathcal A_{\\mu}(\\theta,\\phi) \\equiv i\\,\\langle u(\\theta,\\phi)|\\,\\partial_{\\mu}\\,u(\\theta,\\phi)\\rangle\\,$，其中 $\\mu\\in\\{\\theta,\\phi\\}$，且在此参数化中根据构造有 $\\,\\mathcal A_{r}=0\\,$。\n- 贝里曲率二形式分量 $\\,\\mathcal F_{\\theta\\phi} \\equiv \\partial_{\\theta}\\mathcal A_{\\phi}-\\partial_{\\phi}\\mathcal A_{\\theta}\\,$。\n\n推导球坐标中 $\\,\\mathcal A_{r}(\\theta,\\phi)\\,$、$\\,\\mathcal A_{\\theta}(\\theta,\\phi)\\,$、$\\,\\mathcal A_{\\phi}(\\theta,\\phi)\\,$ 以及 $\\,\\mathcal F_{\\theta\\phi}(\\theta,\\phi)\\,$ 的显式表达式。然后，使用参数空间中二形式与矢量场之间的标准等同关系 $\\,\\boldsymbol{\\mathcal F}_{\\text{vec}} = \\mathcal F_{\\theta\\phi}\\,\\hat{\\boldsymbol r}/(r^{2}\\sin\\theta)\\,$，将得到的 $\\boldsymbol{\\mathcal F}_{\\text{vec}}$ 解释为位于参数空间原点的磁单极子所产生的场。\n\n你的最终答案必须是 $\\,\\mathcal A_{r}\\,$、$\\,\\mathcal A_{\\theta}\\,$、$\\,\\mathcal A_{\\phi}\\,$ 和 $\\,\\mathcal F_{\\theta\\phi}\\,$ 的解析表达式，并按此顺序呈现。不需要进行数值计算。角度以弧度为单位。", "solution": "问题陈述经核实具有科学依据、提法明确且客观。它提出了一个计算由球坐标参数化的两能级量子系统的贝里联络和曲率的标准习题。所有必需的定义和初始数据都已提供，使得问题是自洽且在数学上可解的。我们着手进行推导。\n\n所提供的归一化绝热本征态为\n$$\n|u(\\theta,\\phi)\\rangle = \\begin{pmatrix} \\cos\\left(\\frac{\\theta}{2}\\right) \\\\ \\exp(-i\\phi)\\sin\\left(\\frac{\\theta}{2}\\right) \\end{pmatrix}\n$$\n相应的 bra 矢量为\n$$\n\\langle u(\\theta,\\phi)| = \\begin{pmatrix} \\cos\\left(\\frac{\\theta}{2}\\right)  \\exp(i\\phi)\\sin\\left(\\frac{\\theta}{2}\\right) \\end{pmatrix}\n$$\n贝里联络 $\\boldsymbol{\\mathcal A}$ 的分量由 $\\mathcal A_{\\mu} = i\\,\\langle u|\\,\\partial_{\\mu}\\,u\\rangle$ 定义。\n\n1.  $\\mathcal A_{r}(\\theta,\\phi)$ 的推导：\n    态矢量 $|u(\\theta,\\phi)\\rangle$ 仅由角度 $\\theta$ 和 $\\phi$ 参数化。它没有对径向坐标 $r$ 的函数依赖性。因此，关于 $r$ 的偏导数恒为零：$\\partial_r|u\\rangle = 0$。因此贝里联络的径向分量为\n    $$\n    \\mathcal A_{r} = i\\,\\langle u|\\partial_r u\\rangle = i\\,\\langle u|0\\rangle = 0\n    $$\n    这与问题陈述中给出的前提一致。\n\n2.  $\\mathcal A_{\\theta}(\\theta,\\phi)$ 的推导：\n    为了计算 $\\theta$ 分量，我们首先计算 ket 矢量关于 $\\theta$ 的偏导数：\n    $$\n    \\partial_{\\theta}|u\\rangle = \\frac{\\partial}{\\partial\\theta} \\begin{pmatrix} \\cos\\left(\\frac{\\theta}{2}\\right) \\\\ \\exp(-i\\phi)\\sin\\left(\\frac{\\theta}{2}\\right) \\end{pmatrix} = \\begin{pmatrix} -\\frac{1}{2}\\sin\\left(\\frac{\\theta}{2}\\right) \\\\ \\frac{1}{2}\\exp(-i\\phi)\\cos\\left(\\frac{\\theta}{2}\\right) \\end{pmatrix}\n    $$\n    接下来，我们计算内积 $\\langle u|\\partial_{\\theta} u\\rangle$：\n    $$\n    \\langle u|\\partial_{\\theta} u\\rangle = \\begin{pmatrix} \\cos\\left(\\frac{\\theta}{2}\\right)  \\exp(i\\phi)\\sin\\left(\\frac{\\theta}{2}\\right) \\end{pmatrix} \\begin{pmatrix} -\\frac{1}{2}\\sin\\left(\\frac{\\theta}{2}\\right) \\\\ \\frac{1}{2}\\exp(-i\\phi)\\cos\\left(\\frac{\\theta}{2}\\right) \\end{pmatrix}\n    $$\n    $$\n    = -\\frac{1}{2}\\cos\\left(\\frac{\\theta}{2}\\right)\\sin\\left(\\frac{\\theta}{2}\\right) + \\frac{1}{2}\\exp(i\\phi)\\sin\\left(\\frac{\\theta}{2}\\right)\\exp(-i\\phi)\\cos\\left(\\frac{\\theta}{2}\\right)\n    $$\n    $$\n    = -\\frac{1}{2}\\sin\\left(\\frac{\\theta}{2}\\right)\\cos\\left(\\frac{\\theta}{2}\\right) + \\frac{1}{2}\\sin\\left(\\frac{\\theta}{2}\\right)\\cos\\left(\\frac{\\theta}{2}\\right) = 0\n    $$\n    因此贝里联络的 $\\theta$ 分量为\n    $$\n    \\mathcal A_{\\theta} = i \\times 0 = 0\n    $$\n\n3.  $\\mathcal A_{\\phi}(\\theta,\\phi)$ 的推导：\n    为了计算 $\\phi$ 分量，我们计算关于 $\\phi$ 的偏导数：\n    $$\n    \\partial_{\\phi}|u\\rangle = \\frac{\\partial}{\\partial\\phi} \\begin{pmatrix} \\cos\\left(\\frac{\\theta}{2}\\right) \\\\ \\exp(-i\\phi)\\sin\\left(\\frac{\\theta}{2}\\right) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -i\\exp(-i\\phi)\\sin\\left(\\frac{\\theta}{2}\\right) \\end{pmatrix}\n    $$\n    接下来，我们计算内积 $\\langle u|\\partial_{\\phi} u\\rangle$：\n    $$\n    \\langle u|\\partial_{\\phi} u\\rangle = \\begin{pmatrix} \\cos\\left(\\frac{\\theta}{2}\\right)  \\exp(i\\phi)\\sin\\left(\\frac{\\theta}{2}\\right) \\end{pmatrix} \\begin{pmatrix} 0 \\\\ -i\\exp(-i\\phi)\\sin\\left(\\frac{\\theta}{2}\\right) \\end{pmatrix}\n    $$\n    $$\n    = 0 + \\exp(i\\phi)\\sin\\left(\\frac{\\theta}{2}\\right) \\left(-i\\exp(-i\\phi)\\sin\\left(\\frac{\\theta}{2}\\right)\\right) = -i\\sin^{2}\\left(\\frac{\\theta}{2}\\right)\n    $$\n    贝里联络的 $\\phi$ 分量为\n    $$\n    \\mathcal A_{\\phi} = i \\left(-i\\sin^{2}\\left(\\frac{\\theta}{2}\\right)\\right) = \\sin^{2}\\left(\\frac{\\theta}{2}\\right)\n    $$\n    使用半角恒等式 $\\sin^{2}(x) = \\frac{1-\\cos(2x)}{2}$，这也可以写成 $\\mathcal A_{\\phi} = \\frac{1}{2}(1-\\cos(\\theta))$。\n\n4.  $\\mathcal F_{\\theta\\phi}(\\theta,\\phi)$ 的推导：\n    贝里曲率二形式分量定义为 $\\mathcal F_{\\theta\\phi} = \\partial_{\\theta}\\mathcal A_{\\phi}-\\partial_{\\phi}\\mathcal A_{\\theta}$。使用我们得到的联络分量结果：\n    $$\n    \\partial_{\\phi}\\mathcal A_{\\theta} = \\partial_{\\phi}(0) = 0\n    $$\n    $$\n    \\partial_{\\theta}\\mathcal A_{\\phi} = \\frac{\\partial}{\\partial\\theta} \\left(\\sin^{2}\\left(\\frac{\\theta}{2}\\right)\\right) = 2\\sin\\left(\\frac{\\theta}{2}\\right)\\cos\\left(\\frac{\\theta}{2}\\right) \\cdot \\frac{1}{2} = \\sin\\left(\\frac{\\theta}{2}\\right)\\cos\\left(\\frac{\\theta}{2}\\right)\n    $$\n    使用二倍角恒等式 $\\sin(\\theta) = 2\\sin(\\frac{\\theta}{2})\\cos(\\frac{\\theta}{2})$，上式变为\n    $$\n    \\partial_{\\theta}\\mathcal A_{\\phi} = \\frac{1}{2}\\sin(\\theta)\n    $$\n    因此，贝里曲率分量为\n    $$\n    \\mathcal F_{\\theta\\phi} = \\frac{1}{2}\\sin(\\theta) - 0 = \\frac{1}{2}\\sin(\\theta)\n    $$\n\n5.  解释为磁单极子场：\n    问题提供了关系式 $\\boldsymbol{\\mathcal F}_{\\text{vec}} = \\mathcal F_{\\theta\\phi}\\,\\hat{\\boldsymbol r}/(r^{2}\\sin\\theta)$ 来将曲率二形式分量映射到三维参数空间中的矢量场。代入我们的 $\\mathcal F_{\\theta\\phi}$ 结果：\n    $$\n    \\boldsymbol{\\mathcal F}_{\\text{vec}} = \\frac{\\frac{1}{2}\\sin(\\theta)}{r^{2}\\sin(\\theta)}\\hat{\\boldsymbol r} = \\frac{1}{2r^{2}}\\hat{\\boldsymbol r}\n    $$\n    该场具有位于原点的磁单极子所产生的磁场的标志性 $1/r^2$ 依赖关系和径向方向。在磁荷为 $g_m$ 的磁单极子产生的场表示为 $\\boldsymbol{B} = \\frac{g_m}{r^2}\\hat{\\boldsymbol r}$ 的单位制中，该贝里曲率对应于一个强度为 $g_m = 1/2$ 的磁单极子。贝里曲率在原点（$r \\to 0$）处的这个奇点对应于电子结构中的锥形交叉，它充当几何相位的来源。\n\n因此，所需的解析表达式为 $\\mathcal A_{r} = 0$, $\\mathcal A_{\\theta} = 0$, $\\mathcal A_{\\phi} = \\sin^{2}(\\frac{\\theta}{2})$, 和 $\\mathcal F_{\\theta\\phi} = \\frac{1}{2}\\sin(\\theta)$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0  0  \\sin^{2}\\left(\\frac{\\theta}{2}\\right)  \\frac{1}{2}\\sin(\\theta) \\end{pmatrix}}\n$$", "id": "2762686"}, {"introduction": "贝里相位并非仅仅是数学上的奇珍，它具有可观测的物理效应。本练习题阐述了其最直接的后果之一：对系统能谱的改变。通过研究一个简单的环上粒子模型，您将看到一个值为 $\\pi$ 的非平庸贝里相位如何从根本上改变量子边界条件，并因此影响可观测的能级间距 [@problem_id:2762717]。", "problem": "考虑一个在玻恩-奥本海默（BO）近似下的单个核自由度，在半径为 $R$（转动惯量 $I=\\mu R^{2}$，有效质量为 $\\mu$）的刚性环上进行赝旋转，其中绝热电子态在角度坐标 $\\phi\\in[0,2\\pi)$ 上绕行一圈 $2\\pi$ 后会产生一个几何（贝里）相位（BP）$\\gamma$。环上的核哈密顿量为 $H= -(\\hbar^{2}/2I)\\,\\partial^{2}/\\partial \\phi^{2}$，而贝里相位强制要求边界条件为 $\\psi(\\phi+2\\pi)=\\exp(i\\gamma)\\,\\psi(\\phi)$。\n\n仅根据以上给出的要素，推导出能量本征值谱 $E_{m}(\\gamma)$，然后将最小非零能级间距 $\\Delta E_{\\min}(\\gamma)$ 定义为两个最小的不同能量本征值之差（在能量排序时，如果存在简并，则忽略不计）。计算在 $\\gamma=0$ 和 $\\gamma=\\pi$ 两种情况下的 $\\Delta E_{\\min}(\\gamma)$，并报告其比值\n$$\\rho \\equiv \\frac{\\Delta E_{\\min}(\\gamma=\\pi)}{\\Delta E_{\\min}(\\gamma=0)}.$$\n将 $\\rho$ 的最终答案以一个无单位实数的形式给出。如果使用了任何中间表达式，请以符号形式表示；不要求也禁止使用任何数值。", "solution": "此问题提交以供验证。我们首先按要求逐字列出给定的量和条件。\n\n已知条件：\n1.  系统：一个在半径为 $R$ 的刚性环上进行赝旋转的单个核自由度。\n2.  转动惯量：$I = \\mu R^{2}$。\n3.  角度坐标：$\\phi \\in [0, 2\\pi)$。\n4.  贝里相位：绕行 $2\\pi$ 后为 $\\gamma$。\n5.  核哈密顿量：$H = -(\\hbar^{2}/2I) \\partial^{2}/\\partial \\phi^{2}$。\n6.  边界条件：$\\psi(\\phi+2\\pi) = \\exp(i\\gamma) \\psi(\\phi)$。\n7.  能级间距的定义：$\\Delta E_{\\min}(\\gamma)$ 是两个最小的不同能量本征值之差。\n8.  目标量：比值 $\\rho \\equiv \\frac{\\Delta E_{\\min}(\\gamma=\\pi)}{\\Delta E_{\\min}(\\gamma=0)}$。\n\n验证：\n该问题具有科学依据。环上粒子的哈密顿量是量子力学中的标准模型。通过修正边界条件引入几何相位是一种成熟的方法，类似于阿哈罗诺夫-玻姆效应。该问题是适定 (well-posed) 的，提供了一个清晰的微分方程和边界条件，这足以确定唯一的能谱。术语精确且客观。该问题不违反任何基本原理，不不完整或自相矛盾，并且是理论化学中一个可形式化的问题。因此，该问题被认为是有效的。我们将继续推导解答。\n\n需要求解的基本方程是该系统的定态薛定谔方程：\n$$H\\psi(\\phi) = E\\psi(\\phi)$$\n代入给定的哈密顿量，我们得到：\n$$-\\frac{\\hbar^{2}}{2I} \\frac{d^{2}\\psi}{d\\phi^{2}} = E\\psi(\\phi)$$\n这个二阶常微分方程的通解形式为 $\\psi(\\phi) = A \\exp(ik\\phi)$，其中 $A$ 是归一化常数，$k$ 是待定的波数。将此形式代入薛定谔方程，得到能量 $E$ 和波数 $k$ 之间的关系：\n$$-\\frac{\\hbar^{2}}{2I} (ik)^{2} \\exp(ik\\phi) = E \\exp(ik\\phi)$$\n$$-\\frac{\\hbar^{2}}{2I} (-k^{2}) = E$$\n$$E = \\frac{\\hbar^{2}k^{2}}{2I}$$\n波数 $k$ 受到边界条件 $\\psi(\\phi+2\\pi) = \\exp(i\\gamma) \\psi(\\phi)$ 的约束。将此条件应用于我们的解的形式：\n$$A \\exp(ik(\\phi+2\\pi)) = \\exp(i\\gamma) A \\exp(ik\\phi)$$\n$$\\exp(ik\\phi)\\exp(ik2\\pi) = \\exp(i\\gamma)\\exp(ik\\phi)$$\n这简化为对 $k$ 的量子化条件：\n$$\\exp(ik2\\pi) = \\exp(i\\gamma)$$\n这意味着 $k2\\pi = \\gamma + 2\\pi m$，其中 $m$ 是任意整数，$m \\in \\{ \\dots, -2, -1, 0, 1, 2, \\dots \\}$。\n解出 $k$，我们得到允许的值，记为 $k_m$：\n$$k_m = m + \\frac{\\gamma}{2\\pi}$$\n将这个量子化的波数代回能量表达式，得到能量本征值谱 $E_m(\\gamma)$：\n$$E_{m}(\\gamma) = \\frac{\\hbar^{2}}{2I} \\left( m + \\frac{\\gamma}{2\\pi} \\right)^{2}, \\quad m \\in \\mathbb{Z}$$\n\n现在，我们必须针对 $\\gamma=0$ 和 $\\gamma=\\pi$ 这两种具体情况，计算最小非零能级间距 $\\Delta E_{\\min}(\\gamma)$。\n\n情况 1：$\\gamma=0$（周期性边界条件）\n当 $\\gamma=0$ 时，能谱为：\n$$E_m(0) = \\frac{\\hbar^{2}}{2I} m^{2}, \\quad m \\in \\mathbb{Z}$$\n可能的能量值为：\n- 当 $m=0$ 时：$E_0(0) = 0$。这是基态。\n- 当 $m=\\pm 1$ 时：$E_{\\pm 1}(0) = \\frac{\\hbar^{2}}{2I}(1)^{2} = \\frac{\\hbar^{2}}{2I}$。这是第一激发态，是二重简并的。\n- 当 $m=\\pm 2$ 时：$E_{\\pm 2}(0) = \\frac{\\hbar^{2}}{2I}(2)^{2} = \\frac{4\\hbar^{2}}{2I}$。\n按升序排列的不同能量本征值列表以 $0, \\frac{\\hbar^{2}}{2I}, \\frac{4\\hbar^{2}}{2I}, \\dots$ 开始。\n两个最小的不同能量本征值是 $0$ 和 $\\frac{\\hbar^{2}}{2I}$。\n间距 $\\Delta E_{\\min}(0)$ 是它们的差：\n$$\\Delta E_{\\min}(0) = \\frac{\\hbar^{2}}{2I} - 0 = \\frac{\\hbar^{2}}{2I}$$\n\n情况 2：$\\gamma=\\pi$（反周期性边界条件）\n当 $\\gamma=\\pi$ 时，能谱为：\n$$E_m(\\pi) = \\frac{\\hbar^2}{2I} \\left(m + \\frac{\\pi}{2\\pi}\\right)^{2} = \\frac{\\hbar^2}{2I} \\left(m + \\frac{1}{2}\\right)^{2}, \\quad m \\in \\mathbb{Z}$$\n量子数实际上是半整数。可能的能量值为：\n- 当 $m=0$ 或 $m=-1$ 时：$E_0(\\pi) = \\frac{\\hbar^{2}}{2I} (\\frac{1}{2})^{2} = \\frac{\\hbar^{2}}{8I}$ 且 $E_{-1}(\\pi) = \\frac{\\hbar^{2}}{2I} (-\\frac{1}{2})^{2} = \\frac{\\hbar^{2}}{8I}$。基态是二重简并的，能量为 $\\frac{\\hbar^{2}}{8I}$。\n- 当 $m=1$ 或 $m=-2$ 时：$E_1(\\pi) = \\frac{\\hbar^{2}}{2I} (\\frac{3}{2})^{2} = \\frac{9\\hbar^{2}}{8I}$ 且 $E_{-2}(\\pi) = \\frac{\\hbar^{2}}{2I} (-\\frac{3}{2})^{2} = \\frac{9\\hbar^{2}}{8I}$。第一激发态也是二重简并的，能量为 $\\frac{9\\hbar^{2}}{8I}$。\n按升序排列的不同能量本征值列表以 $\\frac{\\hbar^{2}}{8I}, \\frac{9\\hbar^{2}}{8I}, \\frac{25\\hbar^{2}}{8I}, \\dots$ 开始。\n两个最小的不同能量本征值是 $\\frac{\\hbar^{2}}{8I}$ 和 $\\frac{9\\hbar^{2}}{8I}$。\n间距 $\\Delta E_{\\min}(\\pi)$ 是它们的差：\n$$\\Delta E_{\\min}(\\pi) = \\frac{9\\hbar^{2}}{8I} - \\frac{\\hbar^{2}}{8I} = \\frac{8\\hbar^{2}}{8I} = \\frac{\\hbar^{2}}{I}$$\n\n最后，我们计算比值 $\\rho$：\n$$\\rho = \\frac{\\Delta E_{\\min}(\\gamma=\\pi)}{\\Delta E_{\\min}(\\gamma=0)} = \\frac{\\frac{\\hbar^{2}}{I}}{\\frac{\\hbar^{2}}{2I}} = \\frac{1}{1/2} = 2$$\n常数 $\\hbar$ 和 $I$ 被消掉，这对于一个无量纲比值是符合预期的。", "answer": "$$\\boxed{2}$$", "id": "2762717"}, {"introduction": "虽然解析模型极具启发性，但现实世界中的化学问题通常需要数值求解。本动手编程练习通过引入威尔逊环路 (Wilson loop) 方法，搭建了从理论到实践的桥梁。这是一种在离散格点上计算贝里曲率的强大数值技术。通过此练习，您将掌握关键的计算技能，并深入了解在现代电子结构理论中这些拓扑量是如何被计算的 [@problem_id:2762718]。", "problem": "考虑一个由两个核坐标 $Q_1$ 和 $Q_2$ 参数化的双能级电子哈密顿量，\n$$\n\\hat{H}(Q_1,Q_2) \\;=\\; Q_1 \\,\\hat{\\sigma}_x \\;+\\; Q_2 \\,\\hat{\\sigma}_y \\;+\\; \\Delta \\,\\hat{\\sigma}_z \\;,\n$$\n其中 $\\hat{\\sigma}_x$、$\\hat{\\sigma}_y$ 和 $\\hat{\\sigma}_z$ 是泡利矩阵，$\\Delta0$ 是一个恒定的能隙参数。在 Born-Oppenheimer (BO) 近似下，假设系统占据较低的绝热电子态 $|\\!u_-(Q_1,Q_2)\\rangle$。Berry 联络定义为 $\\mathbf{A}(Q_1,Q_2) = i\\,\\langle u_-(Q_1,Q_2)|\\nabla_{(Q_1,Q_2)} u_-(Q_1,Q_2)\\rangle$，Berry 曲率为 $F_{12}(Q_1,Q_2) = \\partial_{Q_1} A_2 - \\partial_{Q_2} A_1$。\n\n您的任务是设计并实现 $(Q_1,Q_2)$ 平面中一个边长为 $h$、中心在 $(Q_1^{(c)},Q_2^{(c)})$ 的小方格的数值离散化，以使用由平行输运环路变量构建的 Wilson 圈相位来近似中心处的局域 Berry 曲率。使用以下基本依据：\n- 电子和核自由度的 BO 绝热分离。\n- Berry 相位的定义，即 Berry 联络沿闭合回路的线积分，相位以弧度表示。\n- Wilson 圈离散化，它通过沿回路的相邻绝热本征态的交叠乘积的复相位来近似小回路周围的 Berry 相位。\n\n实现以下步骤：\n1. 对于哈密顿量 $\\hat{H}(Q_1,Q_2)$，计算在任意 $(Q_1,Q_2)$ 处对应于较低本征值的归一化绝热本征矢量。将此矢量表示为 $|\\!u_-(Q_1,Q_2)\\rangle$。\n2. 对于一个边长为 $h$、中心在 $(Q_1^{(c)},Q_2^{(c)})$ 的方格，按逆时针顺序定义四个角点为\n   - $C_1 = (Q_1^{(c)}-\\tfrac{h}{2},\\,Q_2^{(c)}-\\tfrac{h}{2})$，\n   - $C_2 = (Q_1^{(c)}+\\tfrac{h}{2},\\,Q_2^{(c)}-\\tfrac{h}{2})$，\n   - $C_3 = (Q_1^{(c)}+\\tfrac{h}{2},\\,Q_2^{(c)}+\\tfrac{h}{2})$，\n   - $C_4 = (Q_1^{(c)}-\\tfrac{h}{2},\\,Q_2^{(c)}+\\tfrac{h}{2})$。\n3. 计算 Wilson 圈相位（以弧度为单位），其值为沿回路 $C_1\\to C_2\\to C_3\\to C_4\\to C_1$ 的平行输运环路变量乘积的辐角，其中相邻角点 $C_i\\to C_{i+1}$ 之间的每个环路变量是归一化的交叠\n   $$\n   U_{i,i+1} \\;=\\; \\frac{\\langle u_-(C_i)\\,|\\,u_-(C_{i+1})\\rangle}{\\left|\\langle u_-(C_i)\\,|\\,u_-(C_{i+1})\\rangle\\right|} \\;.\n   $$\n   Wilson 圈相位则为 $\\phi(h) = \\mathrm{Arg}\\!\\left(U_{12}U_{23}U_{34}U_{41}\\right)$，其中 $\\mathrm{Arg}$ 表示在 $(-\\pi,\\pi]$ 内的主值，角度以弧度表示。\n4. 通过 $F_{12}^{\\mathrm{est}}(h) = \\phi(h)/h^2$ 来近似方格中心处的局域 Berry 曲率。\n5. 从第一性原理独立推导给定哈密顿量的较低绝热态的精确 Berry 曲率 $F_{12}^{\\mathrm{exact}}(Q_1^{(c)},Q_2^{(c)};\\Delta)$ 的解析表达式，并加以实现。\n6. 对于下面列出的每个测试用例，评估用例中每个网格间距 $h$ 的绝对误差 $E(h) = \\left|F_{12}^{\\mathrm{est}}(h) - F_{12}^{\\mathrm{exact}}\\right|$，并通过对所提供的 $h$ 值的 $(\\log h, \\log E(h))$ 进行线性拟合来估计经验收敛阶 $p$。如果任何 $E(h)$ 在数值上为零，则在拟合中省略这些点；如果剩余的有效点少于两个，则将 $p$ 设置为非数值(not-a-number)。报告 $p$ 和该用例中最小 $h$ 处的绝对误差。\n\n角度单位要求：所有相位必须以弧度计算和处理。\n\n您的程序必须实现上述算法并为以下测试套件生成结果：\n- 用例 1（一般情况，远离奇点）：$\\Delta = 0.5$, $(Q_1^{(c)},Q_2^{(c)})=(0.3,-0.2)$, $h\\in\\{0.2,\\,0.1,\\,0.05\\}$。\n- 用例 2（靠近高曲率区域但非奇异）：$\\Delta = 0.5$, $(Q_1^{(c)},Q_2^{(c)})=(0.05,0.04)$, $h\\in\\{0.02,\\,0.01\\}$。\n- 用例 3（远离奇点）：$\\Delta = 0.5$, $(Q_1^{(c)},Q_2^{(c)})=(2.0,1.5)$, $h\\in\\{0.2,\\,0.1,\\,0.05\\}$。\n\n最终输出格式要求：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，每个用例贡献一个包含两个浮点数的列表 $[p, E_{\\min}]$，其中 $p$ 是估计的收敛阶，$E_{\\min}$ 是该用例中最小 $h$ 处的绝对误差。对于上述三个用例，最终输出的形式应为\n  $$\n  \\big[\\,[p_1,E_{\\min,1}],\\,[p_2,E_{\\min,2}],\\,[p_3,E_{\\min,3}]\\,\\big].\n  $$", "solution": "问题陈述需经过验证。该问题描述了在化学和物理学中用于研究几何相位效应的锥形交叉点的典型双能级模型。该问题在科学上是合理的，并且定义明确，提供了所有必要的参数和公式来进行解析推导和数值实现。\n\n**基于原理的解决方案**\n\n该问题要求对贝里曲率进行解析推导和数值近似。\n\n**1. 贝里曲率的解析推导**\n\n哈密顿量可以紧凑地表示为 $\\hat{H} = \\mathbf{d} \\cdot \\hat{\\boldsymbol{\\sigma}}$，其中 $\\mathbf{d} = (Q_1, Q_2, \\Delta)$ 是参数空间中的一个向量。\n该哈密顿量的本征值为 $E_{\\pm} = \\pm |\\mathbf{d}| = \\pm \\sqrt{Q_1^2 + Q_2^2 + \\Delta^2}$。系统占据能量为 $E_- = -|\\mathbf{d}|$ 的较低绝热态。\n\n对于这种形式的通用双能级系统，较低能态的贝里曲率分量 $F_{ij}$ 的公式为：\n$$ F_{ij}^{-} = -\\frac{1}{2|\\mathbf{d}|^3} \\mathbf{d} \\cdot \\left( \\frac{\\partial \\mathbf{d}}{\\partial R_i} \\times \\frac{\\partial \\mathbf{d}}{\\partial R_j} \\right) $$\n其中 $R_i, R_j$ 是参数，在我们的例子中是 $Q_1$ 和 $Q_2$。我们计算 $\\mathbf{d}$ 的偏导数：\n$$ \\frac{\\partial \\mathbf{d}}{\\partial Q_1} = (1, 0, 0) = \\hat{\\mathbf{e}}_1 $$\n$$ \\frac{\\partial \\mathbf{d}}{\\partial Q_2} = (0, 1, 0) = \\hat{\\mathbf{e}}_2 $$\n它们的叉积是：\n$$ \\frac{\\partial \\mathbf{d}}{\\partial Q_1} \\times \\frac{\\partial \\mathbf{d}}{\\partial Q_2} = \\hat{\\mathbf{e}}_1 \\times \\hat{\\mathbf{e}}_2 = \\hat{\\mathbf{e}}_3 = (0, 0, 1) $$\n与 $\\mathbf{d}$ 的点积是：\n$$ \\mathbf{d} \\cdot (0, 0, 1) = (Q_1, Q_2, \\Delta) \\cdot (0, 0, 1) = \\Delta $$\n将此代入 $F_{12}^{-}$ 的公式，并注意到 $|\\mathbf{d}| = \\sqrt{Q_1^2 + Q_2^2 + \\Delta^2}$，我们得到贝里曲率的精确解析表达式：\n$$ F_{12}^{\\mathrm{exact}}(Q_1, Q_2; \\Delta) = -\\frac{\\Delta}{2 (Q_1^2 + Q_2^2 + \\Delta^2)^{3/2}} $$\n这是需要实现的正确解析表达式。\n\n**2. 通过威尔逊环路的数值近似**\n\n根据斯托克斯定理，沿闭合路径 $C$ 的贝里相位 $\\gamma = \\oint_C \\mathbf{A} \\cdot d\\mathbf{R}$ 等于贝里曲率 $F_{12}$ 在该路径所包围的面积 $S$ 上的通量，$\\gamma = \\iint_S F_{12} \\,dQ_1 dQ_2$。对于一个面积为 $h^2$ 的小方格，通量可以近似为 $\\gamma \\approx F_{12}(Q_c) \\cdot h^2$，从而得到曲率的近似值 $F_{12}^{\\mathrm{est}} = \\gamma/h^2$。数值任务就是计算 $\\gamma$。\n\n线积分被离散化为连接回路上相邻点的“环路变量”的乘积，该乘积的相位，即威尔逊环路相位 $\\phi(h)$，近似于 $\\gamma$。一个稳健的环路变量定义是归一化交叠：\n$$ U_{i,i+1} = \\frac{\\langle u_-(C_i)\\,|\\,u_-(C_{i+1})\\rangle}{\\left|\\langle u_-(C_i)\\,|\\,u_-(C_{i+1})\\rangle\\right|} $$\n环绕方格的威尔逊环路相位则为 $\\phi(h) = \\mathrm{Arg}(U_{12}U_{23}U_{34}U_{41})$。\n\n为避免数值对角化带来的任意相位问题，我们使用本征矢量的解析表达式。对应于 $E_-$ 的归一化本征矢量 $|\\!u_-\\rangle$ 为：\n$$ |\\!u_-(Q_1, Q_2)\\rangle = \\frac{1}{\\sqrt{2E(E+\\Delta)}} \\begin{pmatrix} -(Q_1 - iQ_2) \\\\ \\Delta + E \\end{pmatrix} $$\n其中 $E = \\sqrt{Q_1^2 + Q_2^2 + \\Delta^2}$。此表达式将用于计算方格四个角点的本征矢量。\n\n**3. 收敛性分析**\n\n该离散化方法的误差 $E(h) = |F_{12}^{\\mathrm{est}}(h) - F_{12}^{\\mathrm{exact}}|$ 预计与 $h^p$ 成正比，其中收敛阶 $p=2$。我们将通过对 $(\\log h, \\log E(h))$ 数据进行线性拟合来凭经验验证这一点，拟合直线的斜率即为 $p$ 的估计值。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    It orchestrates the calculation of analytical and numerical Berry curvature,\n    computes the error, estimates the convergence order, and prints the final result.\n    \"\"\"\n    \n    test_cases = [\n        (0.5, (0.3, -0.2), [0.2, 0.1, 0.05]),\n        (0.5, (0.05, 0.04), [0.02, 0.01]),\n        (0.5, (2.0, 1.5), [0.2, 0.1, 0.05]),\n    ]\n\n    results = []\n    for case in test_cases:\n        delta, center, h_values = case\n        q1_c, q2_c = center\n        \n        f_exact = analytical_curvature(q1_c, q2_c, delta)\n        \n        errors = []\n        log_h_fit = []\n        log_E_fit = []\n        \n        for h in h_values:\n            f_est = calculate_estimated_curvature(q1_c, q2_c, delta, h)\n            error = np.abs(f_est - f_exact)\n            errors.append(error)\n            \n            if error > 1e-16:\n                log_h_fit.append(np.log(h))\n                log_E_fit.append(np.log(error))\n\n        p = np.nan\n        if len(log_h_fit) >= 2:\n            p = np.polyfit(log_h_fit, log_E_fit, 1)[0]\n            \n        min_h = min(h_values)\n        min_h_index = h_values.index(min_h)\n        e_min = errors[min_h_index]\n        \n        results.append([p, e_min])\n\n    outer_parts = []\n    for pair in results:\n        p_val, emin_val = pair\n        outer_parts.append(f\"[{p_val:.8f},{emin_val:.8f}]\")\n    print(f\"[[{','.join(outer_parts)}]]\")\n\ndef get_lower_eigenvector(q1, q2, delta):\n    \"\"\"\n    Computes the normalized eigenvector for the lower adiabatic state.\n    \"\"\"\n    E = np.sqrt(q1**2 + q2**2 + delta**2)\n    norm = np.sqrt(2 * E * (E + delta))\n    \n    if np.abs(norm)  1e-12:\n        # This happens at the degeneracy Q1=Q2=delta=0, which is excluded by delta > 0.\n        # But for robustness, return a default vector.\n        return np.array([1.0, 0.0])\n\n    v1 = -(q1 - 1j * q2)\n    v2 = delta + E\n    \n    eigenvector = np.array([v1, v2]) / norm\n    return eigenvector\n\ndef calculate_estimated_curvature(q1_c, q2_c, delta, h):\n    \"\"\"\n    Calculates the Berry curvature using the Wilson loop method on a square plaquette.\n    \"\"\"\n    h_half = h / 2.0\n    corners_coords = [\n        (q1_c - h_half, q2_c - h_half),\n        (q1_c + h_half, q2_c - h_half),\n        (q1_c + h_half, q2_c + h_half),\n        (q1_c - h_half, q2_c + h_half),\n    ]\n    \n    evecs = [get_lower_eigenvector(q1, q2, delta) for q1, q2 in corners_coords]\n    \n    overlaps = [\n        np.vdot(evecs[0], evecs[1]),\n        np.vdot(evecs[1], evecs[2]),\n        np.vdot(evecs[2], evecs[3]),\n        np.vdot(evecs[3], evecs[0]),\n    ]\n    \n    wilson_product = 1.0 + 0.0j\n    for c in overlaps:\n        abs_c = np.abs(c)\n        if abs_c > 1e-12:\n            wilson_product *= c / abs_c\n    \n    phi = np.angle(wilson_product)\n    \n    f_est = phi / (h**2)\n    \n    return f_est\n\ndef analytical_curvature(q1, q2, delta):\n    \"\"\"\n    Calculates the exact analytical Berry curvature F_12 for the lower state.\n    \"\"\"\n    denominator = (q1**2 + q2**2 + delta**2)**(1.5)\n    if np.abs(denominator)  1e-12:\n        return 0.0 # Curvature is singular at the origin, but delta>0 prevents this.\n    f_exact = -delta / (2.0 * denominator)\n    return f_exact\n\nif __name__ == '__main__':\n    solve()\n```", "id": "2762718"}]}