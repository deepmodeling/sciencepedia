## 引言
在计算化学领域，电子布居分析是一套至关重要的概念工具，它旨在将从量子力学计算中得到的连续、弥漫的电子云，转化为化学家所熟悉的离散语言——原子、[电荷](@entry_id:275494)和化学键。这种转化对于从复杂的[波函数](@entry_id:147440)或电子密度中提取化学直觉、解释反应性以及预测分子性质至关重要。然而，如何将总电子数精确且有意义地“分配”给分子中的各个原子，并不存在唯一答案。这引出了一个核心的知识挑战：不同的分配方案（即布居分析方法）基于截然不同的物理和数学哲学，各自拥有独特的优势和固有的局限性。

本文将系统地引导读者深入电子布居分析的世界。在 **“原理与机制”** 一章中，我们将建立布居分析的统一数学框架，并详细剖析两大[类核](@entry_id:178267)心方法——[希尔伯特空间划分](@entry_id:202324)与[实空间](@entry_id:754128)划分的内在机制。接下来，**“应用与[交叉](@entry_id:147634)学科联系”** 一章将通过具体的化学案例（如CO分子的电荷分布）来展示这些理论工具的实际应用，并比较不同方法在诊断[计算模型](@entry_id:152639)和解释化学现象时的优劣。最后，**“动手实践”** 部分将提供具体的计算练习，帮助读者将理论知识付诸实践。通过这一结构，本文旨在为读者构建一个从基本原理到实际应用的完整知识体系。

## 原理与机制

在[量子化学](@entry_id:140193)中，一个分子的电子云是一个连续的、弥漫在整个空间的实体。然而，化学家们的核心语言却是建立在离散的原子、[化学键](@entry_id:138216)和[官能团](@entry_id:139479)等概念之上的。为了在这两种描述之间架起一座桥梁，我们需要一套系统的方法，将连续的电子密度“分配”给各个原子。这个过程被称为**电子布居分析** (electron population analysis)。其目标是将总电子数 $N$ 分解为与每个原子相关联的**原子布居** (atomic populations)，进而得到**原子净[电荷](@entry_id:275494)** (net atomic charges)，并量化原子间的电子共享，即**键级** (bond orders)。本章将深入探讨实现这一目标的核心原理与机制。

从根本上说，所有布居分析方法都可以归入两大类，它们在如何分割电子密度这一核心问题上采取了截然不同的哲学。[@problem_id:2770775]

### 布居分析的基本框架：[希尔伯特空间](@entry_id:261193)与[实空间](@entry_id:754128)划分

为了理解这两种方法的区别，我们首先需要一个统一的数学框架。在一个 $N$ 电子体系中，所有单电子性质都可以从**单粒子[约化密度算符](@entry_id:190449)** $\hat{\gamma}$ 中获得。一个任意单电子[可观测量](@entry_id:267133) $\hat{A}$ 的[期望值](@entry_id:153208)由迹公式给出：$\langle \hat{A} \rangle = \mathrm{Tr}[\hat{\gamma}\hat{A}]$。总电子数 $N$ 是单位算符 $\hat{I}$ 的[期望值](@entry_id:153208)，即 $N = \mathrm{Tr}[\hat{\gamma}\hat{I}] = \mathrm{Tr}[\hat{\gamma}]$。

布居分析的本质，就是将单位算符 $\hat{I}$ 分割为一组与各个原子 $A$ 相关的算符 $\hat{O}_A$ 的和，即 $\sum_A \hat{O}_A = \hat{I}$。这个关系被称为**单位分解** (partition of unity)。一旦有了这样的分解，原子 $A$ 的电子布居 $N_A$ 就自然地定义为：

$N_A = \mathrm{Tr}[\hat{\gamma}\hat{O}_A]$

由于[迹的线性](@entry_id:199170)性质，所有原子布居之和自动守恒：$\sum_A N_A = \sum_A \mathrm{Tr}[\hat{\gamma}\hat{O}_A] = \mathrm{Tr}[\hat{\gamma} (\sum_A \hat{O}_A)] = \mathrm{Tr}[\hat{\gamma}\hat{I}] = N$。

两种主要的布居分析方法的核心区别，就在于如何构建这组原子算符 $\hat{O}_A$。[@problem_id:2770775]

1.  **[实空间](@entry_id:754128)划分 (Real-Space Partitioning)**：这种方法直接在三维坐标空间 $\mathbb{R}^3$ 中进行划分。它将整个空间分割成一系列互不重叠的区域 $\Omega_A$，每个区域唯一地与一个原子 $A$ 相关联。在这种情况下，原子算符 $\hat{O}_A$ 是一个在位置表象中为[对角形式](@entry_id:264850)的[投影算符](@entry_id:154142) $\hat{\Pi}_{\Omega_A}$，其矩阵元为 $\langle \mathbf{r} | \hat{\Pi}_{\Omega_A} | \mathbf{r}' \rangle = \chi_{\Omega_A}(\mathbf{r}) \delta(\mathbf{r}-\mathbf{r}')$，其中 $\chi_{\Omega_A}(\mathbf{r})$ 是区域 $\Omega_A$ 的[指示函数](@entry_id:186820)（在区域内为1，区域外为0）。将这个算符代入布居公式，可以证明原子布居就是电子密度 $n(\mathbf{r}) = \langle \mathbf{r} | \hat{\gamma} | \mathbf{r} \rangle$ 在其对应区域上的积分：

    $N_A = \mathrm{Tr}[\hat{\gamma}\hat{\Pi}_{\Omega_A}] = \int_{\Omega_A} n(\mathbf{r}) d\mathbf{r}$

    这种方法的概念清晰直观：原子布居就是其“领地”内的电子总数。挑战在于如何无歧义地定义这些原子区域 $\Omega_A$。

2.  **[希尔伯特空间划分](@entry_id:202324) (Hilbert-Space Partitioning)**：这种方法不是划分真实空间，而是划分描述电子状态的抽象数学空间——希尔伯特空间。在[计算化学](@entry_id:143039)中，这个空间通常由一组原子中心[基函数](@entry_id:170178)（原子轨道, AO）$\{\chi_\mu\}$ 张成。这种方法试图将这些[基函数](@entry_id:170178)划分给不同的原子，并以此定义原子算符 $\hat{O}_A$。如果[基函数](@entry_id:170178)是**正交的**，那么可以简单地定义一个[投影算符](@entry_id:154142) $\hat{P}_A = \sum_{\mu \in A} |\chi_\mu\rangle\langle\chi_\mu|$，其中求和遍历所有属于原子 $A$ 的[基函数](@entry_id:170178)。然而，标准的[高斯基组](@entry_id:198430)等几乎总是**非正交的**，即它们的交叠矩阵 $S_{\mu\nu} = \langle \chi_\mu | \chi_\nu \rangle$ 不是单位矩阵。这使得定义一组满足单位分解的、性质优良的[投影算符](@entry_id:154142)变得非常困难，并催生了多种不同的处理方案。

接下来，我们将详细探讨这两类方法中的[代表性](@entry_id:204613)方案、它们的内在机制以及各自的优缺点。

### [希尔伯特空间划分](@entry_id:202324)方法

这类方法的核心挑战在于如何处理[非正交基](@entry_id:154908)函数带来的交叠布居问题。

#### Mulliken 布居分析

Mulliken 分析是历史最悠久、概念最简单的希尔伯特空间方法。[@problem_id:2770837] 它直接在非正交的原子轨道[基组](@entry_id:160309) $\{\chi_\mu\}$ 中进行操作。在这一[基组](@entry_id:160309)中，总电子数 $N$ 可以表示为密度矩阵 $\mathbf{P}$ 和交叠矩阵 $\mathbf{S}$ 乘积的迹：

$N = \mathrm{Tr}(\mathbf{PS}) = \sum_{\mu, \nu} P_{\mu\nu} S_{\nu\mu}$

Mulliken 的思想是将这个总数进行分配。它将矩阵乘积 $\mathbf{PS}$ 的对角元 $(\mathbf{PS})_{\mu\mu}$ 定义为[基函数](@entry_id:170178) $\chi_\mu$ 的**总[轨道](@entry_id:137151)布居** (gross orbital population)。原子 $A$ 的**总原子布居** (Gross Atomic Population, GAP) $N_A$ 则是其上所有[基函数](@entry_id:170178)的总[轨道](@entry_id:137151)布居之和：

$N_A = \sum_{\mu \in A} (\mathbf{PS})_{\mu\mu} = \sum_{\mu \in A} \sum_{\nu} P_{\mu\nu} S_{\nu\mu}$

一旦得到 $N_A$，**原子净[电荷](@entry_id:275494)** (net atomic charge) $q_A$ 就由[原子核](@entry_id:167902)[电荷](@entry_id:275494) $Z_A$ 减去电子布居得到：$q_A = Z_A - N_A$。

Mulliken 分析的本质在于它如何处理交叠布居。对于任意一对[基函数](@entry_id:170178) $\chi_\mu$ 和 $\chi_\nu$，它们对总电子数的贡献是 $P_{\mu\nu}S_{\nu\mu} + P_{\nu\mu}S_{\mu\nu}$。Mulliken 方案将这一项在 $\mu$ 和 $\nu$ 之间平均分配。[@problem_id:2770837]

这一平均分配的思想也延伸到了对化学键的描述。两个不同原子 $A$ 和 $B$ 之间的 **Mulliken 交叠布居** (Mulliken Overlap Population, OP) 定义为：[@problem_id:2770809]

$OP_{AB} = 2 \sum_{\mu \in A} \sum_{\nu \in B} P_{\mu\nu} S_{\nu\mu}$

这个量可以作为[键级](@entry_id:142548)的定性指标。当原子轨道通过[成键分子轨道](@entry_id:183240)发生建设性干涉时，$P_{\mu\nu}$ 和 $S_{\nu\mu}$ 通常同号（对于相邻原子，通常均为正），使得 $OP_{AB} > 0$，指示成键相互作用。反之，当发生反键相互作用时，$P_{\mu\nu}$ 的符号会改变，导致 $OP_{AB}  0$，指示反键相互作用。如果 $OP_{AB} \approx 0$，则表明为[非键相互作用](@entry_id:189647)。

然而，Mulliken 分析的简洁性是以巨大的代价换来的。它的主要缺陷在于对[基组](@entry_id:160309)的极端敏感性。[@problem_id:2770813] 当在[基组](@entry_id:160309)中加入**弥散函数**（即空间延展很广的函数）时，这些函数会与许多远处的原子产生不可忽略的交叠积分 $S_{\mu\nu}$。Mulliken 方案会机械地将这些“交叠布居”进行分配，导致[电荷](@entry_id:275494)被不合理地转移到远处的原子上，产生与化学直觉严重不符的结果。

更严重的是，Mulliken 分析甚至可能产生完全非物理的结果，例如**负的电子布居**。[@problem_id:2770832] 考虑一个简单的模型，一个分子[轨道](@entry_id:137151)由三个[基函数](@entry_id:170178)[线性组合](@entry_id:154743)而成，$\psi = c_1\chi_1 + c_2\chi_2 + c_3\chi_3$。$\chi_1$ 上的总布居为 $Q_1 = 2c_1^2 + 2c_1c_2S_{12} + 2c_1c_3S_{13}$。其中第一项 $2c_1^2$ 总是非负的，但后面的交叠项可以为负。如果系数 $c_1$ 和 $c_2$ 符号相反（表示 $\chi_1$ 和 $\chi_2$ 之间存在反键成分），且交叠项的负贡献足够大，就有可能压倒第一项的正贡献，导致 $Q_1$ 为负值。这暴露了 Mulliken 方案的根本缺陷：它分配的不是处处非负的电子密度，而是在数学上分割 $\mathrm{Tr}(\mathbf{PS})$ 这个数值，从而可能导致非物理的分配结果。

#### 基于正交化的布居分析

为了克服 Mulliken 分析处理[非正交基组](@entry_id:190211)的困难，另一类方法是先将非正交的原子轨道 (AO) [基组](@entry_id:160309) $\{\chi_\mu\}$ 变换为一个正交的[基组](@entry_id:160309) $\{\phi_i\}$，然后再进行布居分析。在这个新的[正交基](@entry_id:264024)组中，交叠矩阵为单位矩阵，总电子数就是[密度矩阵的迹](@entry_id:145147) $N = \mathrm{Tr}(\bar{\mathbf{P}})$，其中 $\bar{\mathbf{P}}$ 是在新[基组](@entry_id:160309)中的密度矩阵。[轨道](@entry_id:137151) $\phi_i$ 的布居就是对角元 $\bar{P}_{ii}$，原子 $A$ 的布居就是其上所有正交[轨道](@entry_id:137151)布居之和。

这个方法的关键在于**[正交化](@entry_id:149208)过程并非唯一**。不同的[正交化](@entry_id:149208)方案会产生不同的正交基组，从而导致不同的原子布居。这揭示了[希尔伯特空间划分](@entry_id:202324)方法的另一个内在模糊性。[@problem_id:2770835]

两种常见的[正交化](@entry_id:149208)方案是：

1.  **[对称正交化](@entry_id:167626) (Löwdin Orthogonalization)**：使用[变换矩阵](@entry_id:151616) $\mathbf{X}_{\mathrm{L}} = \mathbf{S}^{-1/2}$。这种方法产生的正交[轨道](@entry_id:137151)在最小二乘意义上与原始的非正交 AO最为接近，因此在某种程度上保留了原始 AO 的特性。

2.  **典范[正交化](@entry_id:149208) (Canonical Orthogonalization)**：首先对交叠矩阵 $\mathbf{S}$ 进行[谱分解](@entry_id:173707) $\mathbf{S} = \mathbf{U}\mathbf{s}\mathbf{U}^\top$，然后构造变换矩阵 $\mathbf{X}_{\mathrm{C}} = \mathbf{U}\mathbf{s}^{-1/2}$。这个过程会舍弃由于[基组](@entry_id:160309)线性依赖而导致的小于阈值的[本征值](@entry_id:154894)对应的[轨道](@entry_id:137151)。

这两种方案会得到不同的布居。例如，在一个由两个等价原子轨道构成的简单[双原子分子](@entry_id:148655)模型中，Löwdin [正交化](@entry_id:149208)会得到两个原子上完全相等的电子布居，而典范[正交化](@entry_id:149208)可能将所有电子布居集中在其中一个“典范”[轨道](@entry_id:137151)上，另一个[轨道](@entry_id:137151)布居为零。[@problem_id:2770835] 这说明基于[正交化](@entry_id:149208)的布居分析结果依赖于具体的正交化选择。

在[正交基](@entry_id:264024)组中，可以定义更稳健的键级指数。**Wiberg-Mayer 键级指数** 就是一个例子，它定义在[正交基](@entry_id:264024)组中，原子 $A$ 和 $B$ 之间的键级为：[@problem_id:2770790]

$W_{AB} = \sum_{\mu \in A} \sum_{\nu \in B} (P_{\mu\nu})^2$

其中 $P_{\mu\nu}$ 是在正交基组中的[密度矩阵](@entry_id:139892)元。这个定义保证了键级非负，并且对于原子内部[基函数](@entry_id:170178)的幺正变换（例如从原子轨道到杂化轨道的变换）是不变的，这使得它比 Mulliken 交叠布居更为稳健。

#### 自然布居分析 (NPA)

自然布居分析 (NPA) 是一种更精致的希尔伯特空间方法，它旨在系统性地解决 Mulliken 分析的[基组依赖性](@entry_id:197523)和正交化方法的任意性问题。[@problem_id:2770813]

NPA 的核心是构建一套独特的、性质优良的正交原子中心[轨道](@entry_id:137151)，称为**自然[原子轨道](@entry_id:140819)** (Natural Atomic Orbitals, NAOs)。这个过程通过对[密度矩阵](@entry_id:139892)的原子内（one-center）块进行[对角化](@entry_id:147016)，旨在找到一组能够以最大效率描述原子自身电子密度的局域化[轨道](@entry_id:137151)。这些[轨道](@entry_id:137151)被构造成一个完备的[正交基](@entry_id:264024)。

一旦得到了这组为分子“量身定制”的 NAO 基，布居分析就变得非常简单：原子 $A$ 的布居就是其上所有 NAO 的布居（即[密度矩阵](@entry_id:139892)在 NAO 基下的对角元）之和。因为 NAO 基是正交的，所以不存在 Mulliken 分析中那种需要人为划分的“交叠布居”。

通过这种方式，NPA 将[基组依赖性](@entry_id:197523)的问题从“如何划分交叠布居”转化为了“如何为分子构建最优的原子中心[正交基](@entry_id:264024)”。事实证明，后者是一个定义更明确、结果更稳定的问题。当向[基组](@entry_id:160309)中添加弥散或极化函数时，NPA 过程能够稳健地将这些函数的作用“吸收”到对核心 NAO 的微调中，而不会像 Mulliken 分析那样导致[电荷](@entry_id:275494)的剧烈、非物理的重新[分布](@entry_id:182848)。因此，NPA 的结果对[基组](@entry_id:160309)的选择表现出远小于 Mulliken 分析的敏感性。[@problem_id:2770813]

### 实空间划分方法

与[希尔伯特空间](@entry_id:261193)方法不同，实空间方法直接划分三维物理空间，将位于特定空间区域内的电子密度归属于某个原子。

#### Hirshfeld “股东”方法

Hirshfeld 方法，又称“股东”方法，提供了一种非常直观的[划分方案](@entry_id:635750)。[@problem_id:2770785] 它首先构建一个**前分子** (promolecule)，即一个由孤立的、球形平均化的中性原子密度 $\rho_A^0(\mathbf{r})$ 在分子几何位置上简单叠加而成的体系。这个前分子的总密度为 $\rho^0(\mathbf{r}) = \sum_B \rho_B^0(\mathbf{r})$。

Hirshfeld 方法的核心思想是，在真实分子中的每一点 $\mathbf{r}$，电子密度 $n(\mathbf{r})$ 都应该按照各个原子在前分子中对该点的贡献比例来分配。这个比例，即原子 $A$ 的权重函数 $w_A(\mathbf{r})$，定义为：

$w_A(\mathbf{r}) = \frac{\rho_A^0(\mathbf{r})}{\sum_B \rho_B^0(\mathbf{r})}$

这个定义类似于一个公司的股权分配：在空间中的每一点，每个原子（股东）根据其初始投资（前原子密度）占总投资的比例，来分享该点的利润（真实电子密度）。因此得名“股东”方法。

原子 $A$ 的电子布居 $N_A$ 就是其权重函数在整个空间内对真实电子密度 $n(\mathbf{r})$ 的加权积分：

$N_A = \int w_A(\mathbf{r}) n(\mathbf{r}) d\mathbf{r}$

由于权重函数满足[单位分解](@entry_id:150115) $\sum_A w_A(\mathbf{r}) = 1$，Hirshfeld 方法严格保证[电荷守恒](@entry_id:264158)。此外，因为它只依赖于总电子密度 $n(\mathbf{r})$，而不依赖于[轨道](@entry_id:137151)，所以它对于描述密度的[轨道](@entry_id:137151)[基组](@entry_id:160309)的幺正变换是不变的。[@problem_id:2770785] 它的主要缺点是结果依赖于所选的参考原子密度 $\rho_A^0(\mathbf{r})$，不同的[参考态](@entry_id:151465)（如离子态）会给出不同的[电荷](@entry_id:275494)。

#### 分子中的[原子理论](@entry_id:143111) (QTAIM)

Bader 的**分子中的[原子理论](@entry_id:143111)** (Quantum Theory of Atoms in Molecules, QTAIM) 是最严格、最物理的实空间划分方法之一。它不依赖于任何外部参考或[基函数](@entry_id:170178)，而是完全基于真实电子密度 $n(\mathbf{r})$ 的拓扑学性质。[@problem_id:2770805]

QTAIM 将 $n(\mathbf{r})$ 视为一个三维[标量场](@entry_id:151443)，并分析其**梯度矢量场** $\nabla n(\mathbf{r})$。这个矢量场中的每条积分路径都指示了密度增加最快的方向。QTAIM 定义的**[原子盆](@entry_id:188451)** (atomic basin) 是空间中所有点的集合，从这些点出发沿着梯度上升路径最终都会到达同一个密度极大值点。在分子中，这些密度极大值点几乎总是位于[原子核](@entry_id:167902)的位置。

因此，一个 QTAIM 原子就是由[原子核](@entry_id:167902)及其吸引的所有梯度路径所构成的空间区域。不同[原子盆](@entry_id:188451)之间的边界是**零通量面** (zero-flux surfaces)。在这些面上，梯度矢量 $\nabla n(\mathbf{r})$ 与[曲面的法向量](@entry_id:274852) $\mathbf{n}$ 正交，即 $\nabla n(\mathbf{r}) \cdot \mathbf{n} = 0$。这意味着没有梯度路径会穿过这个边界，从而实现了对空间的完备且无重叠的划分。

值得强调的是，零通量面与**[等值面](@entry_id:196027)** ($n(\mathbf{r}) = \text{const.}$) 是根本不同的概念。在[等值面](@entry_id:196027)上，梯度矢量是处处与[曲面](@entry_id:267450)**垂直**的，而零通量面上的梯度矢量则是处处与[曲面](@entry_id:267450)**相切**的。[@problem_id:2770805]

只要电子密度的所有[临界点](@entry_id:144653)（梯度为零的点）都是非简并的，这种基于[梯度流](@entry_id:635964)的划分就是唯一且明确的。如果存在简并[临界点](@entry_id:144653)，划分的唯一性可能会被破坏。QTAIM 提供了一个无参数、无歧义地在真[实空间](@entry_id:754128)中定义“分子中的原子”的方法，其原子布居就是电子密度在各自[原子盆](@entry_id:188451)内的积分。

### [自旋布居](@entry_id:188184)分析

以上所有概念都可以推广到处理[开壳层体系](@entry_id:168723)，即具有未配对电子的体系。此时，我们不仅关心总电子密度，还关心**自旋密度** (spin density) 的[分布](@entry_id:182848)。[自旋密度](@entry_id:267742)定义为 $\alpha$ 自旋电子密度和 $\beta$ 自旋电子密度之差：[@problem_id:2770842]

$\rho_s(\mathbf{r}) = \rho_\alpha(\mathbf{r}) - \rho_\beta(\mathbf{r})$

总[自旋密度](@entry_id:267742)在全[空间的积](@entry_id:151742)分等于 $\alpha$ 电子数 $N_\alpha$ 与 $\beta$ 电子数 $N_\beta$之差，这个差值又与体系的总[自旋[量子](@entry_id:142550)数](@entry_id:145558) $M_S$ 直接相关：

$\int \rho_s(\mathbf{r}) d\mathbf{r} = N_\alpha - N_\beta = 2M_S$

对于任何给定的布居分析方案（无论是[希尔伯特空间](@entry_id:261193)还是[实空间](@entry_id:754128)），我们都可以独立地对 $\rho_\alpha(\mathbf{r})$ 和 $\rho_\beta(\mathbf{r})$ 进行分析，得到各自的原子布居 $N_A^\alpha$ 和 $N_A^\beta$。原子 $A$ 上的**[自旋布居](@entry_id:188184)** (spin population) $S_A$ 就定义为这两者之差：

$S_A = N_A^\alpha - N_A^\beta$

所有原子[自旋布居](@entry_id:188184)之和也满足一个简单的[守恒定律](@entry_id:269268)：$\sum_A S_A = N_\alpha - N_\beta = 2M_S$。[@problem_id:2770842]

一个重要的现象是**自旋极化** (spin polarization)。即使在一个整体 $M_S=0$ 的体系中（例如，拉伸的 H$_2$ 分子），也可能出现局部的[自旋密度](@entry_id:267742)不为零的情况。通过非限制性计算（如 UHF 或 UKS），体系可以降低能量，使得一个原子上出现净的 $\alpha$ 自旋 ($S_A > 0$)，而另一个原子上出现净的 $\beta$ 自旋 ($S_B  0$)，只要满足 $S_A + S_B = 0$ 即可。这表明，即使分子的[总自旋](@entry_id:153335)为零，其内部也可能存在复杂的自旋[分布](@entry_id:182848)。原子[自旋布居](@entry_id:188184)是揭示这种磁性结构的关键工具。