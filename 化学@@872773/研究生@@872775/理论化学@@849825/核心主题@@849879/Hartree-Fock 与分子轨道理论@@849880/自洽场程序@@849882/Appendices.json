{"hands_on_practices": [{"introduction": "在非正交的原子轨道基组中求解Hartree-Fock-Roothaan方程会得到一个广义本征值问题 $\\mathbf{F}\\mathbf{C} = \\mathbf{S}\\mathbf{C}\\mathbf{E}$。为了使用求解标准本征值问题的数值算法，我们必须先将其转换。此练习 [@problem_id:215564] 将引导你实践一种关键的转换方法——对称正交化，通过计算变换矩阵 $\\mathbf{X} = \\mathbf{S}^{-1/2}$ 来加深对基组变换在自洽场方法中作用的理解。", "problem": "在Hartree-Fock-Roothaan自洽场（SCF）方法中，电子结构问题被表述为一个广义本征值问题：\n$$ \\mathbf{F}\\mathbf{C} = \\mathbf{S}\\mathbf{C}\\mathbf{E} $$\n此处，$\\mathbf{F}$是Fock矩阵，$\\mathbf{C}$是分子轨道系数矩阵，$\\mathbf{S}$是非正交原子轨道基函数的重叠矩阵，$\\mathbf{E}$是轨道能量的对角矩阵。\n\n为使用标准的本征值问题数值算法求解该方程，必须首先将其变换为 $\\mathbf{F}'\\mathbf{C}' = \\mathbf{C}'\\mathbf{E}$ 形式的标准本征值问题。实现这一变换的一个常用方法是通过对称正交化，也称为Löwdin正交化。该方法引入一个变换矩阵 $\\mathbf{X} = \\mathbf{S}^{-1/2}$，用于变换基函数和Fock矩阵。\n\n考虑一个线型对称三原子分子 A-B-A 的简单模型，该模型由一个最小基组描述，每个原子上包含一个s型原子轨道，分别记为 $\\phi_1$、$\\phi_2$ 和 $\\phi_3$。在此基组下，重叠矩阵 $\\mathbf{S}$ 由下式给出：\n$$ \\mathbf{S} = \\begin{pmatrix} 1 & s & 0 \\\\ s & 1 & s \\\\ 0 & s & 1 \\end{pmatrix} $$\n其中 $s$ 是相邻原子轨道间的重叠积分，且末端原子间的重叠假定为零。参数 $s$ 是一个满足 $0 < s < 1/\\sqrt{2}$ 的实数，以确保重叠矩阵是正定的。\n\n你的任务是计算对称正交化矩阵 $\\mathbf{X} = \\mathbf{S}^{-1/2}$ 的非对角矩阵元 $X_{12}$。", "solution": "我们希望计算以下矩阵的非对角元 $X_{12}$：\n\n$$\n\\mathbf X = \\mathbf S^{-1/2},\n\\qquad\n\\mathbf S = \\begin{pmatrix}1 & s & 0\\\\s & 1 & s\\\\0 & s & 1\\end{pmatrix}.\n$$\n\n1. 用一个标准正交矩阵 $U$ 对角化 $\\mathbf S$：\n\n$$\n\\mathbf S = U\\,\\Lambda\\,U^T,\n\\qquad\n\\Lambda = \\mathrm{diag}(\\lambda_1,\\lambda_2,\\lambda_3).\n$$\n\n对于由三个轨道组成的线性链，其本征值为\n\n$$\n\\lambda_k=1+2s\\cos\\frac{k\\pi}{4},\n\\quad k=1,2,3,\n$$\n\n所以\n\n$$\n\\lambda_1=1+\\sqrt2\\,s,\\quad\n\\lambda_2=1,\\quad\n\\lambda_3=1-\\sqrt2\\,s.\n$$\n\n\n2. （未归一化的）本征向量的分量为\n\n$$\nu_{j k}=\\sin\\!\\bigl(jk\\pi/4\\bigr),\n\\quad j=1,2,3,\n$$\n\n且可通过 $\\sum_{j=1}^3\\sin^2(jk\\pi/4)=2$ 进行归一化。因此\n\n$$\nU_{jk}=\\frac{\\sin(jk\\pi/4)}{\\sqrt2}.\n$$\n\n\n3. 对称正交化矩阵为\n\n$$\n\\mathbf X=\\mathbf S^{-1/2}\n=U\\,\\Lambda^{-1/2}\\,U^T,\n$$\n\n所以每个矩阵元为\n\n$$\nX_{12}\n=\\sum_{k=1}^3U_{1k}\\,U_{2k}\\,\\frac1{\\sqrt{\\lambda_k}}.\n$$\n\n由于 $U_{12}U_{22}=0$，只有 $k=1,3$ 项有贡献。我们有\n\n$$\nU_{11}U_{21}\n=\\frac{\\sin(\\pi/4)\\sin(2\\pi/4)}{2}\n=\\frac{1}{2\\sqrt2},\n\\quad\nU_{13}U_{23}\n=\\frac{\\sin(3\\pi/4)\\sin(6\\pi/4)}{2}\n=-\\frac{1}{2\\sqrt2}.\n$$\n\n因此\n\n$$\nX_{12}\n=\\frac{1}{2\\sqrt2}\\Bigl(\\frac1{\\sqrt{1+\\sqrt2\\,s}}\n-\\frac1{\\sqrt{1-\\sqrt2\\,s}}\\Bigr).\n$$", "answer": "$$\\boxed{\\frac{1}{2\\sqrt{2}}\\Bigl(\\frac{1}{\\sqrt{1+\\sqrt{2}\\,s}}-\\frac{1}{\\sqrt{1-\\sqrt{2}\\,s}}\\Bigr)}$$", "id": "215564"}, {"introduction": "在自洽场计算中，仅凭能量变化量很小来判断收敛是不可靠的，有时会导致“伪收敛”现象。这个练习 [@problem_id:2804024] 构建了一个精巧的二维玩具模型，在该模型中，两次迭代间的能量变化已经小于阈值，但波函数离真实的自洽解还相差甚远。通过计算福克矩阵与密度矩阵的对易子范数，你将亲身体会到为何需要更严格的收敛判据来确保计算的可靠性。", "problem": "考虑一个在正交原子轨道基 $\\{\\,|1\\rangle, |2\\rangle\\,\\}$ 中的单电子、双能级玩具自洽场 (SCF) 模型。在 SCF 迭代第 $n$ 步时，Fock 算符由厄米矩阵表示\n$$\nF^{(n)} \\;=\\; \\begin{pmatrix} \\alpha & 0 \\\\ 0 & \\beta \\end{pmatrix},\n$$\n其中 $\\alpha = 0$ (单位为 $\\mathrm{Hartree}$)，$\\beta = \\Delta$，而 $\\Delta = 2.0 \\times 10^{-2}$ (单位为 $\\mathrm{Hartree}$)。在迭代第 $n$ 步时，单电子密度是到已占据自旋轨道的投影算符 $P^{(n)} = |c\\rangle \\langle c|$\n$$\n|c\\rangle \\;=\\; \\begin{pmatrix} \\cos\\theta \\\\ \\sin\\theta \\end{pmatrix}, \\quad \\text{其中 } \\theta = \\frac{\\pi}{4} \\text{ (弧度)}。\n$$\n假设在迭代第 $n+1$ 步时，算法施加了一个微小的均匀对角移动，产生\n$$\nF^{(n+1)} \\;=\\; \\begin{pmatrix} \\alpha + \\delta & 0 \\\\ 0 & \\beta + \\delta \\end{pmatrix},\n$$\n其中 $\\delta = 1.0 \\times 10^{-10}$ (单位为 $\\mathrm{Hartree}$)，而由于阻尼，密度保持不变，$P^{(n+1)} = P^{(n)}$。\n\n对于这个单电子玩具模型，使用期望值作为其能量泛函\n$$\nE^{(k)} \\;=\\; \\operatorname{Tr}\\!\\big(F^{(k)} P^{(k)}\\big),\n$$\n并回想一下，在正交基中，自洽定态条件要求对易子 $[F^{(n)}, P^{(n)}] = F^{(n)} P^{(n)} - P^{(n)} F^{(n)}$ 在收敛时为零。残差范数取为 Frobenius 范数 $\\|X\\|_{\\mathrm{F}} = \\sqrt{\\operatorname{Tr}(X^{\\dagger} X)}$。目标收敛阈值为：能量变化阈值 $\\tau_{E} = 1.0 \\times 10^{-8}$ (单位为 $\\mathrm{Hartree}$) 和残差阈值 $\\tau_{R} = 1.0 \\times 10^{-3}$ (单位为 $\\mathrm{Hartree}$)。\n\n任务：\n1) 计算 $E^{(n)}$ 和 $E^{(n+1)}$，并验证是否满足 $\\big|E^{(n+1)} - E^{(n)}\\big| < \\tau_{E}$。\n2) 计算 Frobenius 范数 $\\big\\|\\,[F^{(n)}, P^{(n)}]\\,\\big\\|_{\\mathrm{F}}$ 并将其与 $\\tau_{R}$ 比较，以评估残差是否表明未收敛。\n\n以 $\\mathrm{Hartree}$ 为单位表示 Frobenius 范数的最终数值，并将您的答案四舍五入到四位有效数字。您的最终答案必须是一个数字。", "solution": "所述问题具有科学依据，提法得当，且客观公正。它在使用简化的双能级量子系统的自洽场 (SCF) 理论背景下，提出了一个标准的教学练习。所有必要的数据和定义均已给出，任务明确。因此，该问题是有效的，并将提供解答。\n\n第一步是根据给定的已占据自旋轨道 $|c\\rangle$ 构建单电子密度矩阵 $P^{(n)}$。在正交基 $\\{|1\\rangle, |2\\rangle\\}$ 中，该自旋轨道定义为：\n$$\n|c\\rangle \\;=\\; \\begin{pmatrix} \\cos\\theta \\\\ \\sin\\theta \\end{pmatrix}, \\quad \\text{其中 } \\theta = \\frac{\\pi}{4}\n$$\n代入 $\\theta$ 的值，我们得到 $\\cos(\\frac{\\pi}{4}) = \\frac{1}{\\sqrt{2}}$ 和 $\\sin(\\frac{\\pi}{4}) = \\frac{1}{\\sqrt{2}}$。因此，该轨道为：\n$$\n|c\\rangle \\;=\\; \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\n对应的伴随向量是 $\\langle c| = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 & 1 \\end{pmatrix}$。密度矩阵 $P^{(n)}$ 是投影算符 $|c\\rangle \\langle c|$：\n$$\nP^{(n)} \\;=\\; |c\\rangle \\langle c| \\;=\\; \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 & 1 \\end{pmatrix} \\;=\\; \\frac{1}{2}\\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix} \\;=\\; \\begin{pmatrix} \\frac{1}{2} & \\frac{1}{2} \\\\ \\frac{1}{2} & \\frac{1}{2} \\end{pmatrix}\n$$\n问题陈述，由于阻尼，密度矩阵在下一次迭代中保持不变，因此 $P^{(n+1)} = P^{(n)}$。\n\n**任务 1：能量计算与收敛性**\n\n我们使用泛函 $E^{(k)} = \\operatorname{Tr}(F^{(k)} P^{(k)})$ 计算迭代第 $k$ 步的能量 $E^{(k)}$。\n\n在迭代第 $n$ 步时，Fock 矩阵给定为 $F^{(n)} = \\begin{pmatrix} \\alpha & 0 \\\\ 0 & \\beta \\end{pmatrix}$，其中 $\\alpha = 0$ 且 $\\beta = \\Delta = 2.0 \\times 10^{-2}$。\n$$\nF^{(n)} \\;=\\; \\begin{pmatrix} 0 & 0 \\\\ 0 & \\Delta \\end{pmatrix}\n$$\n乘积 $F^{(n)} P^{(n)}$ 为：\n$$\nF^{(n)} P^{(n)} \\;=\\; \\begin{pmatrix} 0 & 0 \\\\ 0 & \\Delta \\end{pmatrix} \\begin{pmatrix} \\frac{1}{2} & \\frac{1}{2} \\\\ \\frac{1}{2} & \\frac{1}{2} \\end{pmatrix} \\;=\\; \\begin{pmatrix} 0 & 0 \\\\ \\frac{\\Delta}{2} & \\frac{\\Delta}{2} \\end{pmatrix}\n$$\n能量 $E^{(n)}$ 是该矩阵的迹：\n$$\nE^{(n)} \\;=\\; \\operatorname{Tr}(F^{(n)} P^{(n)}) \\;=\\; 0 + \\frac{\\Delta}{2} \\;=\\; \\frac{\\Delta}{2}\n$$\n在迭代第 $n+1$ 步时，Fock 矩阵为 $F^{(n+1)} = \\begin{pmatrix} \\alpha + \\delta & 0 \\\\ 0 & \\beta + \\delta \\end{pmatrix}$，其中 $\\delta = 1.0 \\times 10^{-10}$。\n$$\nF^{(n+1)} \\;=\\; \\begin{pmatrix} \\delta & 0 \\\\ 0 & \\Delta + \\delta \\end{pmatrix}\n$$\n使用 $P^{(n+1)} = P^{(n)}$，乘积 $F^{(n+1)} P^{(n+1)}$ 为：\n$$\nF^{(n+1)} P^{(n+1)} \\;=\\; \\begin{pmatrix} \\delta & 0 \\\\ 0 & \\Delta + \\delta \\end{pmatrix} \\begin{pmatrix} \\frac{1}{2} & \\frac{1}{2} \\\\ \\frac{1}{2} & \\frac{1}{2} \\end{pmatrix} \\;=\\; \\begin{pmatrix} \\frac{\\delta}{2} & \\frac{\\delta}{2} \\\\ \\frac{\\Delta + \\delta}{2} & \\frac{\\Delta + \\delta}{2} \\end{pmatrix}\n$$\n能量 $E^{(n+1)}$ 是该矩阵的迹：\n$$\nE^{(n+1)} \\;=\\; \\operatorname{Tr}(F^{(n+1)} P^{(n+1)}) \\;=\\; \\frac{\\delta}{2} + \\frac{\\Delta + \\delta}{2} \\;=\\; \\frac{\\Delta + 2\\delta}{2} \\;=\\; \\frac{\\Delta}{2} + \\delta\n$$\n能量的变化为：\n$$\n\\big|E^{(n+1)} - E^{(n)}\\big| \\;=\\; \\left|\\left(\\frac{\\Delta}{2} + \\delta\\right) - \\frac{\\Delta}{2}\\right| \\;=\\; |\\delta| \\;=\\; 1.0 \\times 10^{-10} \\, \\mathrm{Hartree}\n$$\n我们将其与能量变化阈值 $\\tau_{E} = 1.0 \\times 10^{-8} \\, \\mathrm{Hartree}$ 进行比较。由于 $1.0 \\times 10^{-10} < 1.0 \\times 10^{-8}$，能量收敛判据 $|E^{(n+1)} - E^{(n)}| < \\tau_{E}$ 得到满足。\n\n**任务 2：残差范数计算与收敛性**\n\n自洽定态条件是对易子 $[F^{(n)}, P^{(n)}]$ 为零。我们计算这个对易子。首先，我们需要乘积 $P^{(n)} F^{(n)}$：\n$$\nP^{(n)} F^{(n)} \\;=\\; \\begin{pmatrix} \\frac{1}{2} & \\frac{1}{2} \\\\ \\frac{1}{2} & \\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} 0 & 0 \\\\ 0 & \\Delta \\end{pmatrix} \\;=\\; \\begin{pmatrix} 0 & \\frac{\\Delta}{2} \\\\ 0 & \\frac{\\Delta}{2} \\end{pmatrix}\n$$\n对易子，我们记为 $C^{(n)}$，是：\n$$\nC^{(n)} \\;=\\; [F^{(n)}, P^{(n)}] \\;=\\; F^{(n)} P^{(n)} - P^{(n)} F^{(n)} \\;=\\; \\begin{pmatrix} 0 & 0 \\\\ \\frac{\\Delta}{2} & \\frac{\\Delta}{2} \\end{pmatrix} - \\begin{pmatrix} 0 & \\frac{\\Delta}{2} \\\\ 0 & \\frac{\\Delta}{2} \\end{pmatrix} \\;=\\; \\begin{pmatrix} 0 & -\\frac{\\Delta}{2} \\\\ \\frac{\\Delta}{2} & 0 \\end{pmatrix}\n$$\n残差范数是该对易子的 Frobenius 范数，$\\|C^{(n)}\\|_{\\mathrm{F}} = \\sqrt{\\operatorname{Tr}((C^{(n)})^{\\dagger} C^{(n)})}$。$C^{(n)}$ 的伴随矩阵是：\n$$\n(C^{(n)})^{\\dagger} \\;=\\; \\begin{pmatrix} 0 & \\frac{\\Delta}{2} \\\\ -\\frac{\\Delta}{2} & 0 \\end{pmatrix}\n$$\n乘积 $(C^{(n)})^{\\dagger} C^{(n)}$ 是：\n$$\n(C^{(n)})^{\\dagger} C^{(n)} \\;=\\; \\begin{pmatrix} 0 & \\frac{\\Delta}{2} \\\\ -\\frac{\\Delta}{2} & 0 \\end{pmatrix} \\begin{pmatrix} 0 & -\\frac{\\Delta}{2} \\\\ \\frac{\\Delta}{2} & 0 \\end{pmatrix} \\;=\\; \\begin{pmatrix} \\frac{\\Delta^2}{4} & 0 \\\\ 0 & \\frac{\\Delta^2}{4} \\end{pmatrix}\n$$\n该矩阵的迹是：\n$$\n\\operatorname{Tr}((C^{(n)})^{\\dagger} C^{(n)}) \\;=\\; \\frac{\\Delta^2}{4} + \\frac{\\Delta^2}{4} \\;=\\; \\frac{\\Delta^2}{2}\n$$\nFrobenius 范数是该值的平方根：\n$$\n\\big\\|[F^{(n)}, P^{(n)}]\\big\\|_{\\mathrm{F}} \\;=\\; \\sqrt{\\frac{\\Delta^2}{2}} \\;=\\; \\frac{|\\Delta|}{\\sqrt{2}}\n$$\n给定 $\\Delta = 2.0 \\times 10^{-2} \\, \\mathrm{Hartree}$，范数为：\n$$\n\\big\\|[F^{(n)}, P^{(n)}]\\big\\|_{\\mathrm{F}} \\;=\\; \\frac{2.0 \\times 10^{-2}}{\\sqrt{2}} \\;=\\; \\sqrt{2} \\times 10^{-2} \\, \\mathrm{Hartree}\n$$\n数值上，$\\sqrt{2} \\approx 1.41421356$。所以，范数约等于 $1.41421356 \\times 10^{-2} \\, \\mathrm{Hartree}$。\n我们将其与残差阈值 $\\tau_{R} = 1.0 \\times 10^{-3} \\, \\mathrm{Hartree}$ 进行比较。\n$$\n1.414... \\times 10^{-2} \\; > \\; 1.0 \\times 10^{-3}\n$$\n因此，残差范数大于阈值，表明 SCF 过程在迭代第 $n$ 步时并未收敛，尽管能量变化非常小。这说明了能量变化小是 SCF 收敛的必要条件，但不是充分条件。能量相对于轨道旋转的梯度（在此由对易子范数表示）也必须很小。\n\n问题要求 Frobenius 范数的数值，并四舍五入到四位有效数字。\n$$\n\\sqrt{2} \\times 10^{-2} \\approx 1.414 \\times 10^{-2}\n$$\n这就是最终的数值结果。", "answer": "$$\\boxed{1.414 \\times 10^{-2}}$$", "id": "2804024"}, {"introduction": "理论学习的最终目的是将其付诸实践。这项综合性练习 [@problem_id:2923088] 让你扮演计算化学家的角色，完成一次完整的限制性Hartree-Fock自洽场宏观迭代。从给定的基本积分（重叠、核心哈密顿量和双电子排斥积分）出发，你将构建福克矩阵、求解广义本征值方程、更新密度矩阵，并最终计算体系的电子能量，从而将所有理论环节融会贯通。", "problem": "给定原子轨道基下模型系统的单电子和双电子积分数据。您的任务是从一个初始密度矩阵开始，实现限制性哈特里-福克自洽场 (RHF-SCF) 程序的一次宏观迭代。从正交归一分子轨道的电子能量变分原理以及限制性闭壳层情况下的福克算符定义出发。推导在非正交原子轨道基中出现的广义本征值问题，以及从已占据分子轨道构建闭壳层密度矩阵的相应规则。然后，利用这些推导出的关系，执行一次宏观迭代，包括：从初始密度构建福克矩阵，求解广义本征值问题以获得分子轨道，并使用正确的闭壳层轨道占据数更新密度矩阵。最后，使用更新后的密度和相应的福克矩阵计算更新后的电子能量。忽略核排斥能，仅报告电子能量。所有量均使用原子单位（能量单位为哈特里）。\n\n您必须使用的基本原理包括：多电子系统的哈特里-福克变分原理、在非正交基中通过重叠矩阵表示的分子轨道的正交归一性、限制性哈特里-福克形式论中的闭壳层电子计数规则，以及由化学家记法中的双电子排斥积分构建的库仑和交换贡献的定义。除了源于这些原理的公式外，您不得假定任何预先指定的简化公式。\n\n详细信息与约定：\n- 在原子轨道基下进行计算，使用重叠矩阵 $S$、核心哈密顿矩阵 $H$ 和化学家记法下的电子排斥积分 (ERIs) $(\\mu\\nu|\\lambda\\sigma)$。\n- 使用限制性闭壳层形式：共有 $N_{\\mathrm{elec}}$ 个电子，全部配对，因此已占据的空间轨道数为 $N_{\\mathrm{occ}} = N_{\\mathrm{elec}}/2$。\n- ERIs 满足完全置换对称性：$(\\mu\\nu|\\lambda\\sigma) = (\\nu\\mu|\\lambda\\sigma) = (\\mu\\nu|\\sigma\\lambda) = (\\lambda\\sigma|\\mu\\nu)$，未列出的积分四重组其值为 $0$。\n- 索引从零开始：$\\mu,\\nu,\\lambda,\\sigma \\in \\{0,1,\\ldots,n_{\\mathrm{bf}}-1\\}$。\n- 按如下步骤执行单次宏观迭代：\n  1. 从初始密度矩阵 $P^{(0)}$ 出发，构建适用于非正交原子轨道基中限制性哈特里-福克方法的福克矩阵 $F^{(0)}$，使用变分原理和给定 ERIs 所隐含的库仑和交换构建方法。\n  2. 求解广义对称本征值问题 $F^{(0)} C = S C \\varepsilon$ 以获得相对于 $S$ 正交归一的分子轨道系数 $C$。\n  3. 确定 $N_{\\mathrm{occ}}$ 个能量最低的已占据轨道，并从这些轨道在原子轨道基中构建更新后的闭壳层密度矩阵 $P^{(1)}$。\n  4. 使用 $P^{(1)}$ 构建相应的福克矩阵 $F^{(1)}$，并根据哈特里-福克能量泛函，以 $H$、$F^{(1)}$ 和 $P^{(1)}$ 表示的形式，计算此次宏观迭代后的电子能量，单位为原子单位（哈特里）。\n- 您必须将最终能量表示为浮点数，并四舍五入到十位小数。\n\n测试套件：\n实现您的程序以在内部处理以下三个测试用例。对于每个用例，完全按照描述执行一次宏观迭代，并报告最终的电子能量（不包括核排斥能），单位为哈特里。矩阵以嵌套列表形式给出；所有数字均以原子单位表示，所有索引均从零开始。\n\n用例 A（正常路径，小型 $2\\times 2$ 系统）：\n- 基组大小 $n_{\\mathrm{bf}} = 2$，电子数 $N_{\\mathrm{elec}} = 2$（因此 $N_{\\mathrm{occ}} = 1$）。\n- 重叠矩阵 $S = \\left[\\left[1.0,\\,0.2\\right],\\left[0.2,\\,1.0\\right]\\right]$。\n- 核心哈密顿量 $H = \\left[\\left[-1.0,\\,-0.2\\right],\\left[-0.2,\\,-0.8\\right]\\right]$。\n- 初始密度 $P^{(0)} = \\left[\\left[0.0,\\,0.0\\right],\\left[0.0,\\,0.0\\right]\\right]$。\n- 唯一 ERI 元组列表 $(\\mu,\\nu,\\lambda,\\sigma,\\text{value})$：\n  - $(0,0,0,0,0.70)$,\n  - $(0,0,0,1,0.20)$,\n  - $(0,0,1,1,0.60)$,\n  - $(0,1,0,1,0.30)$,\n  - $(0,1,1,1,0.25)$,\n  - $(1,1,1,1,0.675)$。\n\n用例 B（较大的 $3\\times 3$ 系统，具有非平凡的初始密度）：\n- 基组大小 $n_{\\mathrm{bf}} = 3$，电子数 $N_{\\mathrm{elec}} = 4$（因此 $N_{\\mathrm{occ}} = 2$）。\n- 重叠矩阵 $S = \\left[\\left[1.0,\\,0.1,\\,0.0\\right],\\left[0.1,\\,1.0,\\,0.2\\right],\\left[0.0,\\,0.2,\\,1.0\\right]\\right]$。\n- 核心哈密顿量 $H = \\left[\\left[-1.2,\\,-0.1,\\,0.0\\right],\\left[-0.1,\\,-0.9,\\,-0.15\\right],\\left[0.0,\\,-0.15,\\,-0.5\\right]\\right]$。\n- 初始密度 $P^{(0)} = \\left[\\left[1.8,\\,0.1,\\,0.05\\right],\\left[0.1,\\,1.2,\\,0.08\\right],\\left[0.05,\\,0.08,\\,0.0\\right]\\right]$。\n- 唯一 ERI 列表：\n  - $(0,0,0,0,0.80)$,\n  - $(0,0,0,1,0.15)$,\n  - $(0,0,0,2,0.05)$,\n  - $(0,0,1,1,0.60)$,\n  - $(0,0,1,2,0.07)$,\n  - $(0,0,2,2,0.50)$,\n  - $(0,1,0,1,0.20)$,\n  - $(0,1,0,2,0.06)$,\n  - $(0,1,1,2,0.08)$,\n  - $(0,1,1,1,0.18)$,\n  - $(0,1,2,2,0.12)$,\n  - $(0,2,0,2,0.16)$,\n  - $(0,2,1,2,0.09)$,\n  - $(0,2,2,2,0.14)$,\n  - $(1,1,1,1,0.70)$,\n  - $(1,1,1,2,0.11)$,\n  - $(1,1,2,2,0.55)$,\n  - $(1,2,1,2,0.19)$,\n  - $(1,2,2,2,0.13)$,\n  - $(2,2,2,2,0.65)$。\n\n用例 C（$S$ 中存在近线性相关的边缘情况）：\n- 基组大小 $n_{\\mathrm{bf}} = 2$，电子数 $N_{\\mathrm{elec}} = 2$（因此 $N_{\\mathrm{occ}} = 1$）。\n- 重叠矩阵 $S = \\left[\\left[1.0,\\,0.98\\right],\\left[0.98,\\,1.0\\right]\\right]$。\n- 核心哈密顿量 $H = \\left[\\left[-1.0,\\,-0.9\\right],\\left[-0.9,\\,-1.0\\right]\\right]$。\n- 初始密度 $P^{(0)} = \\left[\\left[0.0,\\,0.0\\right],\\left[0.0,\\,0.0\\right]\\right]$。\n- 唯一 ERI 列表：\n  - $(0,0,0,0,0.70)$,\n  - $(0,0,0,1,0.25)$,\n  - $(0,0,1,1,0.68)$,\n  - $(0,1,0,1,0.33)$,\n  - $(0,1,1,1,0.28)$,\n  - $(1,1,1,1,0.72)$。\n\n您的程序必须：\n- 使用所述的对称性从每个案例的唯一积分列表中重构完整的四中心 ERI 张量，所有未指定的四重组均等于 $0$。\n- 对每个案例按规定执行一次 RHF-SCF 宏观迭代。\n- 使用更新后的密度和相应的更新福克矩阵计算最终的电子能量（单位为哈特里）。\n- 输出一个单行，该行为一个逗号分隔的三个能量列表，每个能量都四舍五入到恰好十位小数，并用方括号括起来，例如 $\\left[\\text{caseA},\\text{caseB},\\text{caseC}\\right]$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，“[result1,result2,result3]”）。", "solution": "所述问题是有效的。它提出了计算量子化学中一个明确定义的任务，该任务基于哈特里-福克近似的基本原理。所有必要的数据和约束都已提供，问题没有科学上的不准确、矛盾或含糊之处。我们将首先进行严谨的推导，然后进行算法实现。\n\n目标是执行限制性哈特里-福克 (RHF) 自洽场 (SCF) 程序的一次宏观迭代。该方法的基础是变分原理，它指出多电子系统的真实基态能量是哈密顿量期望值的最小值。在哈特里-福克近似中，试探波函数被限制为单个斯莱特行列式。对于具有 $N_{\\mathrm{elec}}$ 个电子的闭壳层系统，这会得到一个依赖于 $N_{\\mathrm{occ}} = N_{\\mathrm{elec}}/2$ 个双占据空间分子轨道 (MOs) $\\{\\psi_i\\}$ 的能量泛函。\n\n分子轨道 (MOs) $\\psi_i$ 通过原子轨道线性组合 (LCAO) 近似，表示为一组 $n_{\\mathrm{bf}}$ 个非正交原子轨道 (AOs) $\\{\\phi_\\mu\\}$ 的线性组合：\n$$ \\psi_i = \\sum_{\\mu=1}^{n_{\\mathrm{bf}}} C_{\\mu i} \\phi_\\mu $$\n其中 $C_{\\mu i}$ 是 MO 系数。AO 基的非正交性由重叠矩阵 $S$ 描述，其矩阵元为 $S_{\\mu\\nu} = \\langle \\phi_\\mu | \\phi_\\nu \\rangle$。分子轨道被约束为正交归一的，这在 AO 基中转化为矩阵方程：\n$$ C^T S C = I $$\n其中 $C$ 是 $n_{\\mathrm{bf}} \\times n_{\\mathrm{bf}}$ 的 MO 系数矩阵，$I$ 是单位矩阵。\n\n在 RHF 形式中，电子能量泛函可以用单电子密度矩阵 $P$ 来表示。在 AO 基中，闭壳层体系的密度矩阵元定义为：\n$$ P_{\\mu\\nu} = 2 \\sum_{i=1}^{N_{\\mathrm{occ}}} C_{\\mu i} C_{\\nu i} $$\n因子 $2$ 说明了每个空间轨道的双重占据。\n\n在正交归一约束下，对能量泛函关于 MO 系数 $C_{\\mu i}$ 进行最小化，得到罗特汉-霍尔方程，这是一个广义本征值问题：\n$$ F C = S C \\varepsilon $$\n这里，$F$ 是福克矩阵，$\\varepsilon$ 是一个对角矩阵，其对角元为 MO 能量。福克矩阵 $F$ 是有效单电子福克算符在 AO 基中的矩阵表示。其矩阵元由下式给出：\n$$ F_{\\mu\\nu} = H_{\\mu\\nu} + G_{\\mu\\nu} $$\n其中 $H_{\\mu\\nu} = \\langle \\phi_\\mu | \\hat{h} | \\phi_\\nu \\rangle$ 是核心哈密顿矩阵的矩阵元，代表单个电子的动能和电子-核吸引能。矩阵 $G$ 代表一个电子所感受到的平均双电子势（库仑和交换）。其矩阵元 $G_{\\mu\\nu}$ 由密度矩阵 $P$ 和双电子排斥积分 (ERIs) $(\\mu\\nu|\\lambda\\sigma)$ 构建：\n$$ G_{\\mu\\nu} = \\sum_{\\lambda=0}^{n_{\\mathrm{bf}}-1} \\sum_{\\sigma=0}^{n_{\\mathrm{bf}}-1} P_{\\lambda\\sigma} \\left[ (\\mu\\nu|\\lambda\\sigma) - \\frac{1}{2} (\\mu\\lambda|\\nu\\sigma) \\right] $$\n项 $(\\mu\\nu|\\lambda\\sigma)$ 对应于库仑相互作用，而 $(\\mu\\lambda|\\nu\\sigma)$ 对应于交换相互作用。注意 ERIs 的索引采用化学家记法。\n\nSCF 过程是一个迭代过程。从一个初始的密度矩阵猜测开始，构建福克矩阵，求解罗特汉-霍尔方程以获得新的 MO 系数，然后构建一个新的密度矩阵。重复此过程，直到密度矩阵或能量收敛。本问题要求进行一次这样的迭代。\n\n一次宏观迭代的具体步骤如下：\n1. **福克矩阵构建**：给定一个初始密度矩阵 $P^{(0)}$，构建初始福克矩阵 $F^{(0)}$。其矩阵元为：\n$$ F_{\\mu\\nu}^{(0)} = H_{\\mu\\nu} + \\sum_{\\lambda,\\sigma} P_{\\lambda\\sigma}^{(0)} \\left[ (\\mu\\nu|\\lambda\\sigma) - \\frac{1}{2}(\\mu\\lambda|\\nu\\sigma) \\right] $$\n在此步骤之前，必须使用指定的置换对称性规则 $(\\mu\\nu|\\lambda\\sigma) = (\\nu\\mu|\\lambda\\sigma) = (\\mu\\nu|\\sigma\\lambda) = (\\lambda\\sigma|\\mu\\nu)$，从提供的唯一积分列表中构建完整的四中心 ERI 张量。\n\n2. **求解广义本征值问题**：求解罗特汉-霍尔方程 $F^{(0)} C = S C \\varepsilon$。这将得到一组 $n_{\\mathrm{bf}}$ 个轨道能量（本征值 $\\varepsilon_{i}$）和相应的 MO 系数向量（矩阵 $C$ 的列向量）。本征向量 $C$ 被归一化，使得 $C^T S C = I$。\n\n3. **更新密度矩阵**：根据轨道能量按升序对 MO 进行排序。能量最低的 $N_{\\mathrm{occ}}$ 个轨道是已占据轨道。从这些已占据轨道的系数构建新的密度矩阵 $P^{(1)}$：\n$$ P_{\\mu\\nu}^{(1)} = 2 \\sum_{i=1}^{N_{\\mathrm{occ}}} C_{\\mu i} C_{\\nu i} $$\n在线性代数中，如果 $C_{\\mathrm{occ}}$ 是一个 $n_{\\mathrm{bf}} \\times N_{\\mathrm{occ}}$ 矩阵，包含 $C$ 的前 $N_{\\mathrm{occ}}$ 列，则 $P^{(1)} = 2 C_{\\mathrm{occ}} C_{\\mathrm{occ}}^T$。\n\n4. **计算最终电子能量**：使用更新后的密度矩阵 $P^{(1)}$ 和由它构建的福克矩阵 $F^{(1)}$ 来计算一次迭代后的电子能量。电子能量的公式为：\n$$ E_{\\mathrm{elec}}^{(1)} = \\frac{1}{2} \\sum_{\\mu,\\nu} P_{\\mu\\nu}^{(1)} (H_{\\mu\\nu} + F_{\\mu\\nu}^{(1)}) $$\n其中 $F^{(1)}$ 的计算方式与 $F^{(0)}$ 相同，但使用 $P^{(1)}$：\n$$ F_{\\mu\\nu}^{(1)} = H_{\\mu\\nu} + \\sum_{\\lambda,\\sigma} P_{\\lambda\\sigma}^{(1)} \\left[ (\\mu\\nu|\\lambda\\sigma) - \\frac{1}{2}(\\mu\\lambda|\\nu\\sigma) \\right] $$\n此计算提供单次 SCF 步骤后的电子能量，即为所需输出。根据问题陈述，核排斥能是一个常数偏移量，在此被忽略。该程序将对每个指定的测试用例执行。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef solve():\n    \"\"\"\n    Main function to define test cases and orchestrate the RHF-SCF single iteration.\n    \"\"\"\n    \n    # Case A: 2x2 system, 2 electrons, zero initial density\n    case_a = {\n        \"n_bf\": 2, \"n_elec\": 2,\n        \"S\": [[1.0, 0.2], [0.2, 1.0]],\n        \"H\": [[-1.0, -0.2], [-0.2, -0.8]],\n        \"P0\": [[0.0, 0.0], [0.0, 0.0]],\n        \"eris\": [\n            (0, 0, 0, 0, 0.70), (0, 0, 0, 1, 0.20), (0, 0, 1, 1, 0.60),\n            (0, 1, 0, 1, 0.30), (0, 1, 1, 1, 0.25), (1, 1, 1, 1, 0.675)\n        ]\n    }\n    \n    # Case B: 3x3 system, 4 electrons, non-trivial initial density\n    case_b = {\n        \"n_bf\": 3, \"n_elec\": 4,\n        \"S\": [[1.0, 0.1, 0.0], [0.1, 1.0, 0.2], [0.0, 0.2, 1.0]],\n        \"H\": [[-1.2, -0.1, 0.0], [-0.1, -0.9, -0.15], [0.0, -0.15, -0.5]],\n        \"P0\": [[1.8, 0.1, 0.05], [0.1, 1.2, 0.08], [0.05, 0.08, 0.0]],\n        \"eris\": [\n            (0, 0, 0, 0, 0.80), (0, 0, 0, 1, 0.15), (0, 0, 0, 2, 0.05),\n            (0, 0, 1, 1, 0.60), (0, 0, 1, 2, 0.07), (0, 0, 2, 2, 0.50),\n            (0, 1, 0, 1, 0.20), (0, 1, 0, 2, 0.06), (0, 1, 1, 2, 0.08),\n            (0, 1, 1, 1, 0.18), (0, 1, 2, 2, 0.12), (0, 2, 0, 2, 0.16),\n            (0, 2, 1, 2, 0.09), (0, 2, 2, 2, 0.14), (1, 1, 1, 1, 0.70),\n            (1, 1, 1, 2, 0.11), (1, 1, 2, 2, 0.55), (1, 2, 1, 2, 0.19),\n            (1, 2, 2, 2, 0.13), (2, 2, 2, 2, 0.65)\n        ]\n    }\n    \n    # Case C: 2x2 system with near-linear dependence, 2 electrons\n    case_c = {\n        \"n_bf\": 2, \"n_elec\": 2,\n        \"S\": [[1.0, 0.98], [0.98, 1.0]],\n        \"H\": [[-1.0, -0.9], [-0.9, -1.0]],\n        \"P0\": [[0.0, 0.0], [0.0, 0.0]],\n        \"eris\": [\n            (0, 0, 0, 0, 0.70), (0, 0, 0, 1, 0.25), (0, 0, 1, 1, 0.68),\n            (0, 1, 0, 1, 0.33), (0, 1, 1, 1, 0.28), (1, 1, 1, 1, 0.72)\n        ]\n    }\n    \n    test_cases = [case_a, case_b, case_c]\n    results = []\n\n    for case in test_cases:\n        energy = run_rhf_iteration(\n            case[\"n_bf\"], case[\"n_elec\"], case[\"S\"], case[\"H\"], case[\"P0\"], case[\"eris\"]\n        )\n        results.append(f\"{energy:.10f}\")\n\n    print(f\"[{','.join(results)}]\")\n\n\ndef run_rhf_iteration(n_bf, n_elec, S_list, H_list, P0_list, eris_list):\n    \"\"\"\n    Performs one macro-iteration of the RHF-SCF procedure for a given system.\n    \n    Args:\n        n_bf (int): Number of basis functions.\n        n_elec (int): Number of electrons.\n        S_list (list): Overlap matrix.\n        H_list (list): Core Hamiltonian matrix.\n        P0_list (list): Initial density matrix.\n        eris_list (list): List of unique ERIs.\n        \n    Returns:\n        float: The electronic energy after one iteration.\n    \"\"\"\n    \n    # --- Step 0: Setup ---\n    # Convert lists to NumPy arrays for matrix operations.\n    S = np.array(S_list)\n    H = np.array(H_list)\n    P0 = np.array(P0_list)\n    n_occ = n_elec // 2\n\n    # Reconstruct the full 4-index ERI tensor from the unique list\n    # using 8-fold permutational symmetry for real integrals.\n    g = np.zeros((n_bf, n_bf, n_bf, n_bf))\n    for mu, nu, lam, sig, val in eris_list:\n        g[mu, nu, lam, sig] = val\n        g[nu, mu, lam, sig] = val\n        g[mu, nu, sig, lam] = val\n        g[nu, mu, sig, lam] = val\n        g[lam, sig, mu, nu] = val\n        g[sig, lam, mu, nu] = val\n        g[lam, sig, nu, mu] = val\n        g[sig, lam, nu, mu] = val\n        \n    # --- Step 1: Form Fock Matrix F^(0) from P^(0) ---\n    # The two-electron contribution G is built using Einstein summation for efficiency.\n    # F_munu = H_munu + sum_ls P_ls * [ (mn|ls) - 0.5 * (ml|ns) ]\n    # J_munu = sum_ls P_ls * (mn|ls) --> einsum('ls,mnls->mn', P, g)\n    # K_munu = sum_ls P_ls * (ml|ns) --> einsum('ls,mlsn->mn', P, g)\n    J0 = np.einsum('ls,mnls->mn', P0, g, optimize=True)\n    K0 = np.einsum('ls,mlsn->mn', P0, g, optimize=True)\n    G0 = J0 - 0.5 * K0\n    F0 = H + G0\n    \n    # --- Step 2: Solve the generalized eigenvalue problem FC = SCe ---\n    # scipy.linalg.eigh solves the symmetric generalized eigenvalue problem.\n    # It returns eigenvalues sorted in ascending order and corresponding eigenvectors.\n    eps, C = eigh(F0, S)\n    \n    # --- Step 3: Build new density matrix P^(1) ---\n    # The columns of C are the MO coefficients. We take the first n_occ columns\n    # for the occupied orbitals.\n    C_occ = C[:, :n_occ]\n    # P_munu = 2 * sum_{i=occ} C_mui * C_nui\n    P1 = 2.0 * (C_occ @ C_occ.T)\n    \n    # --- Step 4: Compute final electronic energy ---\n    # First, form the updated Fock matrix F^(1) using the new density P^(1).\n    J1 = np.einsum('ls,mnls->mn', P1, g, optimize=True)\n    K1 = np.einsum('ls,mlsn->mn', P1, g, optimize=True)\n    G1 = J1 - 0.5 * K1\n    F1 = H + G1\n    \n    # Calculate the electronic energy using the updated matrices.\n    # E = 0.5 * Tr(P(H+F))\n    # This can be computed efficiently as the sum over the element-wise product.\n    energy = 0.5 * np.sum(P1 * (H + F1))\n    \n    return energy\n\nsolve()\n```", "id": "2923088"}]}