{"hands_on_practices": [{"introduction": "有效核势（ECP）通过仅关注化学活性的价电子，从根本上简化了量子计算。第一个练习提供了一个直接但至关重要的实践，用于应用这一原理。通过计算像磷五氟化物（$PF_5$）这样的分子中被明确处理的电子数量，您将巩固对“标准”ECP如何定义并应用于分子中不同元素的理解 [@problem_id:1364323]。", "problem": "在现代计算化学中，一种简化含多电子分子计算的常用技术是使用有效核势（ECP）。ECP近似地处理了化学惰性的核心电子的静电效应，从而使量子力学计算能够仅关注化学活性的价电子。\n\n考虑分子五氟化磷（$PF_5$）。对其进行量子化学计算，其中对中心磷原子以及五个氟原子均使用了标准的ECP。对于像磷和氟这样的主族元素，标准的ECP被构建用来取代由元素周期表中紧邻其前的稀有气体的电子排布所定义的核心电子。\n\n已知磷（P）的原子序数为15，氟（F）的原子序数为9，请确定在这次量子力学处理中，整个$PF_5$分子中被明确包含的电子总数。", "solution": "有效核势（ECP）取代了与元素之前紧邻的稀有气体相对应的核心电子，只留下价电子进行显式处理。\n\n令磷的原子序数为 $Z_{\\mathrm{P}}=15$，氟的原子序数为 $Z_{\\mathrm{F}}=9$。磷的前一个稀有气体是氖，其原子序数为 $Z_{\\mathrm{Ne}}=10$；氟的前一个稀有气体是氦，其原子序数为 $Z_{\\mathrm{He}}=2$。\n\n每个原子被显式处理的电子（价电子）数可以通过减去稀有气体核心的电子数得到：\n$$\nN_{\\mathrm{val}}(\\mathrm{P})=Z_{\\mathrm{P}}-Z_{\\mathrm{Ne}}=15-10=5,\n$$\n$$\nN_{\\mathrm{val}}(\\mathrm{F})=Z_{\\mathrm{F}}-Z_{\\mathrm{He}}=9-2=7.\n$$\n对于$PF_5$，有一个磷原子和五个氟原子，因此被明确包含的电子总数为\n$$\nN_{\\mathrm{QM}}=N_{\\mathrm{val}}(\\mathrm{P})+5\\,N_{\\mathrm{val}}(\\mathrm{F})=5+5\\times 7=40.\n$$\n等价地，从总电子数开始减去所有核心电子，\n$$\n(Z_{\\mathrm{P}}+5Z_{\\mathrm{F}})-(Z_{\\mathrm{Ne}}+5Z_{\\mathrm{He}})=(15+5\\times 9)-(10+5\\times 2)=60-20=40,\n$$\n这证实了该结果。", "answer": "$$\\boxed{40}$$", "id": "1364323"}, {"introduction": "除了仅仅减少电子数量，ECP也是在重元素化学中引入相对论效应的不可或缺的工具，否则这些效应在计算上是难以模拟的。本练习使用金二聚体（$Au_2$）的简化模型，来演示相对论效应（分解为标量和自旋轨道耦合分量）如何系统地改变键合参数，并导致可观测性质（如键长）的变化 [@problem_id:2454645]。通过这个实践，您将深入了解现代ECP最强大的应用之一。", "problem": "您将使用一个最小的紧束缚加短程排斥模型，对由两个金原子组成的双原子分子的平衡键长进行建模，并量化在使用非相对论有效核势（ECP）与相对论有效核势时预测键长的变化。您需要将总差异分解为标量相对论效应和自旋-轨道耦合的贡献。\n\n从玻恩-奥本海默图像出发，其中沿核间距的势能面由一个短程排斥项和一个成键稳定项描述。在一个每个原子一个轨道的最小紧束缚模型中，假设排斥作用可以很好地由指数函数 $B e^{-\\mu r}$ 近似，其中 $B \\gt 0$ 和 $\\mu \\gt 0$。成键稳定项来源于相距为 $r$ 的两个价轨道之间的跃迁项 $t(r)$ 的二阶微扰理论。设 $t(r) = t_0 e^{-\\lambda r}$，其中 $\\lambda \\gt 0$。那么，对于 $t(r)$ 的主导项，一个电子在成键轨道中的成键稳定能与 $-A e^{-2 \\lambda r}$ 成比例，其中 $A \\propto t_0^2 / \\Delta$，而 $\\Delta \\gt 0$ 是与反键态或更高能态的有效能量分离。采用以下显式总能量模型：\n$$\nE(r) = B e^{-\\mu r} - A e^{-2 \\lambda r},\n$$\n其中 $B \\gt 0$、$\\mu \\gt 0$、$A \\gt 0$ 和 $\\lambda \\gt 0$。通过最小化 $E(r)$（对 $r$ 求导）可得到平衡键长 $r_e$。\n\n有效核势（ECP）会改变价电子结构参数。考虑三种ECP变体：\n- 非相对论ECP（其参数用下标 $\\mathrm{NR}$ 表示），\n- 仅包含标量相对论效应的ECP（用下标 $\\mathrm{SR}$ 表示），\n- 包含自旋-轨道耦合的全相对论ECP（用下标 $\\mathrm{REL}$ 表示，其包含 $\\mathrm{SR}$ 中的标量相对论效应以及自旋-轨道耦合）。\n\n使用以下假设来对ECP的依赖性进行建模：\n- 轨道衰减常数从 $\\lambda_{\\mathrm{NR}}$ 变为 $\\lambda_{\\mathrm{SR}} = c_{\\mathrm{SR}} \\lambda_{\\mathrm{NR}}$，其中 $c_{\\mathrm{SR}} \\ge 1$。对于全相对论情况，取 $\\lambda_{\\mathrm{REL}} = \\lambda_{\\mathrm{SR}}$。\n- 跃迁指前因子与轨道衰减常数成比例，即 $t_{0,\\mathrm{SR}} = t_{0,\\mathrm{NR}} \\left(\\lambda_{\\mathrm{SR}}/\\lambda_{\\mathrm{NR}}\\right)$，且 $t_{0,\\mathrm{REL}} = t_{0,\\mathrm{SR}}$。\n- 由于价轨道流形的标量相对论稳定化效应，有效能量分离 $\\Delta$ 从 $\\Delta_{\\mathrm{NR}}$ 变为 $\\Delta_{\\mathrm{SR}}$，而自旋-轨道耦合进一步将其增加至 $\\Delta_{\\mathrm{REL}} = \\Delta_{\\mathrm{SR}} (1 + s_{\\mathrm{SO}})$，其中 $s_{\\mathrm{SO}} \\ge 0$。\n- 根据 $A \\propto t_0^2 / \\Delta$，可以得出\n$$\nA_{\\mathrm{SR}} = A_{\\mathrm{NR}} \\left(\\frac{\\lambda_{\\mathrm{SR}}}{\\lambda_{\\mathrm{NR}}}\\right)^2 \\left(\\frac{\\Delta_{\\mathrm{NR}}}{\\Delta_{\\mathrm{SR}}}\\right), \\quad\nA_{\\mathrm{REL}} = A_{\\mathrm{NR}} \\left(\\frac{\\lambda_{\\mathrm{REL}}}{\\lambda_{\\mathrm{NR}}}\\right)^2 \\left(\\frac{\\Delta_{\\mathrm{NR}}}{\\Delta_{\\mathrm{REL}}}\\right).\n$$\n\n您的任务：\n1. 从 $E(r) = B e^{-\\mu r} - A e^{-2 \\lambda r}$ 出发，推导出用 $B$、$\\mu$、$A$ 和 $\\lambda$ 表示的 $r_e$ 的表达式，并用它计算下面每个测试用例的 $r_{\\mathrm{NR}}$、$r_{\\mathrm{SR}}$ 和 $r_{\\mathrm{REL}}$。\n2. 对于每个测试用例，计算相对于全相对论情况的总键长误差、标量相对论贡献和自旋-轨道耦合贡献，具体如下：\n$$\n\\Delta r_{\\mathrm{total}} = r_{\\mathrm{NR}} - r_{\\mathrm{REL}}, \\quad\n\\Delta r_{\\mathrm{scalar}} = r_{\\mathrm{NR}} - r_{\\mathrm{SR}}, \\quad\n\\Delta r_{\\mathrm{SO}} = r_{\\mathrm{SR}} - r_{\\mathrm{REL}}.\n$$\n3. 对于每个测试用例，返回列表 $[\\Delta r_{\\mathrm{total}}, \\Delta r_{\\mathrm{scalar}}, \\Delta r_{\\mathrm{SO}}, \\mathrm{check}]$，其中 $\\mathrm{check}$ 是一个布尔值，当 $\\left|\\Delta r_{\\mathrm{total}} - (\\Delta r_{\\mathrm{scalar}} + \\Delta r_{\\mathrm{SO}})\\right| \\le 10^{-9}$ 时为true，否则为false。\n\n科学和数学细节：\n- 所有距离 $r$ 必须以埃（ångström）为单位，所有报告的差异 $\\Delta r$ 也必须以埃为单位。指数衰减常数 $\\mu$ 和 $\\lambda$ 的单位是埃的倒数。能量 $A$、$B$ 和 $\\Delta$ 的单位是电子伏特。自旋-轨道参数 $s_{\\mathrm{SO}}$ 是无量纲的。\n- 假设 $B \\mu \\gt 2 \\lambda A$ 且 $\\mu \\gt 2 \\lambda$，以确保在所有提供的测试用例中，平衡距离是有限的，且对数函数的参数为正。\n\n测试套件：\n每个测试用例由元组 $(B, \\mu, \\lambda_{\\mathrm{NR}}, c_{\\mathrm{SR}}, A_{\\mathrm{NR}}, \\Delta_{\\mathrm{NR}}, \\Delta_{\\mathrm{SR}}, s_{\\mathrm{SO}})$ 指定，其单位和含义如上文所定义。使用以下四个用例：\n- 用例 1: $(50, 4.0, 1.30, 1.05, 4.0, 2.2, 1.4, 0.20)$。\n- 用例 2: $(50, 4.0, 1.30, 1.05, 4.0, 2.2, 1.4, 0.00)$。\n- 用例 3: $(45, 4.2, 1.45, 1.05, 4.8, 2.4, 1.8, 0.15)$。\n- 用例 4: $(60, 3.6, 1.25, 1.01, 4.2, 2.3, 2.0, 0.10)$。\n\n程序规范：\n- 您的程序必须为每个测试用例计算以埃为单位的 $\\Delta r_{\\mathrm{total}}$、$\\Delta r_{\\mathrm{scalar}}$ 和 $\\Delta r_{\\mathrm{SO}}$ 值，以及如上定义的布尔值 $\\mathrm{check}$。\n- 您的程序应生成单行输出，其中包含一个以逗号分隔的列表的列表形式的结果，每个子列表对应一个测试用例，格式必须完全如下所示：\n\"[[x11,x12,x13,x14],[x21,x22,x23,x24],[x31,x32,x33,x34],[x41,x42,x43,x44]]\"\n其中 $x_{i1}$、$x_{i2}$ 和 $x_{i3}$ 是浮点数（单位为埃），$x_{i4}$ 是布尔值。", "solution": "所提出的问题是计算化学中一个有效的理论练习。它在科学上基于一个简化的紧束缚模型，问题定义良好，所有必要的参数和关系都已明确，并且以客观、正式的语言陈述。我们将着手解决此问题。\n\n目标是分析相对论效应对双原子分子平衡键长的影响，并将其分解为标量和自旋-轨道贡献。这是通过使用一个参数化的势能模型来实现的，其中参数被改变以反映不同层次的相对论理论（非相对论、标量相对论和全相对论）。\n\n首先，我们推导平衡键长 $r_e$ 的通用表达式。势能 $E(r)$ 如下：\n$$\nE(r) = B e^{-\\mu r} - A e^{-2 \\lambda r}\n$$\n平衡键长对应于该函数的最小值，可通过将势能对核间距 $r$ 的一阶导数设为零来找到。\n$$\n\\frac{dE}{dr} = -B \\mu e^{-\\mu r} - A (-2 \\lambda) e^{-2 \\lambda r} = 0\n$$\n这给出了平衡条件：\n$$\nB \\mu e^{-\\mu r_e} = 2 A \\lambda e^{-2 \\lambda r_e}\n$$\n为了求解 $r_e$，我们重新整理方程：\n$$\n\\frac{e^{-\\mu r_e}}{e^{-2 \\lambda r_e}} = \\frac{2 A \\lambda}{B \\mu}\n$$\n$$\ne^{(2\\lambda - \\mu)r_e} = \\frac{2 A \\lambda}{B \\mu}\n$$\n对两边取自然对数：\n$$\n(2\\lambda - \\mu)r_e = \\ln\\left(\\frac{2 A \\lambda}{B \\mu}\\right)\n$$\n假设 $\\mu > 2\\lambda$，为了在给定约束（$B\\mu > 2A\\lambda$）下确保分母和对数的参数都为正，将表达式写成以下更方便的形式：\n$$\n(\\mu - 2\\lambda)r_e = -\\ln\\left(\\frac{2 A \\lambda}{B \\mu}\\right) = \\ln\\left(\\left(\\frac{2 A \\lambda}{B \\mu}\\right)^{-1}\\right) = \\ln\\left(\\frac{B \\mu}{2 A \\lambda}\\right)\n$$\n因此，平衡键长 $r_e$ 的解析表达式为：\n$$\nr_e(A, \\lambda) = \\frac{1}{\\mu - 2\\lambda} \\ln\\left(\\frac{B \\mu}{2 A \\lambda}\\right)\n$$\n该公式将用于计算每种ECP变体的键长。参数 $B$ 和 $\\mu$ 在所有模型中保持不变。参数 $A$ 和 $\\lambda$ 则取决于ECP变体。让我们为每种情况定义它们。\n\n每个测试用例的输入是元组 $(B, \\mu, \\lambda_{\\mathrm{NR}}, c_{\\mathrm{SR}}, A_{\\mathrm{NR}}, \\Delta_{\\mathrm{NR}}, \\Delta_{\\mathrm{SR}}, s_{\\mathrm{SO}})$。\n\n1.  **非相对论 (NR) 模型：**\n    参数直接从输入中使用。\n    $A_{\\mathrm{NR}}$ 已给出。\n    $\\lambda_{\\mathrm{NR}}$ 已给出。\n    键长为 $r_{\\mathrm{NR}} = r_e(A_{\\mathrm{NR}}, \\lambda_{\\mathrm{NR}})$。\n\n2.  **标量相对论 (SR) 模型：**\n    参数由NR参数和相对论校正因子导出。\n    轨道衰减常数为 $\\lambda_{\\mathrm{SR}} = c_{\\mathrm{SR}} \\lambda_{\\mathrm{NR}}$。\n    成键参数 $A$ 受轨道衰减和能隙变化的双重调制：\n    $$\n    A_{\\mathrm{SR}} = A_{\\mathrm{NR}} \\left(\\frac{\\lambda_{\\mathrm{SR}}}{\\lambda_{\\mathrm{NR}}}\\right)^2 \\left(\\frac{\\Delta_{\\mathrm{NR}}}{\\Delta_{\\mathrm{SR}}}\\right) = A_{\\mathrm{NR}} c_{\\mathrm{SR}}^2 \\frac{\\Delta_{\\mathrm{NR}}}{\\Delta_{\\mathrm{SR}}}\n    $$\n    键长为 $r_{\\mathrm{SR}} = r_e(A_{\\mathrm{SR}}, \\lambda_{\\mathrm{SR}})$。\n\n3.  **全相对论 (REL) 模型：**\n    该模型同时包含标量和自旋-轨道效应。\n    轨道衰减常数与SR情况相同：$\\lambda_{\\mathrm{REL}} = \\lambda_{\\mathrm{SR}}$。\n    自旋-轨道耦合进一步修正了能隙：$\\Delta_{\\mathrm{REL}} = \\Delta_{\\mathrm{SR}} (1 + s_{\\mathrm{SO}})$。\n    这导致了一个新的成键参数 $A_{\\mathrm{REL}}$：\n    $$\n    A_{\\mathrm{REL}} = A_{\\mathrm{NR}} \\left(\\frac{\\lambda_{\\mathrm{REL}}}{\\lambda_{\\mathrm{NR}}}\\right)^2 \\left(\\frac{\\Delta_{\\mathrm{NR}}}{\\Delta_{\\mathrm{REL}}}\\right) = A_{\\mathrm{NR}} c_{\\mathrm{SR}}^2 \\frac{\\Delta_{\\mathrm{NR}}}{\\Delta_{\\mathrm{SR}}(1 + s_{\\mathrm{SO}})} = \\frac{A_{\\mathrm{SR}}}{1 + s_{\\mathrm{SO}}}\n    $$\n    键长为 $r_{\\mathrm{REL}} = r_e(A_{\\mathrm{REL}}, \\lambda_{\\mathrm{REL}})$。\n\n利用这三个键长，我们计算所需的差异：\n总误差：$\\Delta r_{\\mathrm{total}} = r_{\\mathrm{NR}} - r_{\\mathrm{REL}}$\n标量相对论贡献：$\\Delta r_{\\mathrm{scalar}} = r_{\\mathrm{NR}} - r_{\\mathrm{SR}}$\n自旋-轨道贡献：$\\Delta r_{\\mathrm{SO}} = r_{\\mathrm{SR}} - r_{\\mathrm{REL}}$\n\n最后，我们进行一致性检查。通过简单的代换，可以清楚地看到：\n$$\n\\Delta r_{\\mathrm{scalar}} + \\Delta r_{\\mathrm{SO}} = (r_{\\mathrm{NR}} - r_{\\mathrm{SR}}) + (r_{\\mathrm{SR}} - r_{\\mathrm{REL}}) = r_{\\mathrm{NR}} - r_{\\mathrm{REL}} = \\Delta r_{\\mathrm{total}}\n$$\n布尔变量 `check` 验证了该恒等式在 $10^{-9}$ 的浮点容差内成立：\n$$\n\\mathrm{check} = \\left|\\Delta r_{\\mathrm{total}} - (\\Delta r_{\\mathrm{scalar}} + \\Delta r_{\\mathrm{SO}})\\right| \\le 10^{-9}\n$$\n\n解答需要为每个提供的测试用例实现这一系列计算，并按规定格式化输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the diatomic molecule bond length problem for a suite of test cases.\n    \"\"\"\n\n    # Test cases as tuples:\n    # (B, mu, lambda_NR, c_SR, A_NR, Delta_NR, Delta_SR, s_SO)\n    test_cases = [\n        (50.0, 4.0, 1.30, 1.05, 4.0, 2.2, 1.4, 0.20),\n        (50.0, 4.0, 1.30, 1.05, 4.0, 2.2, 1.4, 0.00),\n        (45.0, 4.2, 1.45, 1.05, 4.8, 2.4, 1.8, 0.15),\n        (60.0, 3.6, 1.25, 1.01, 4.2, 2.3, 2.0, 0.10),\n    ]\n\n    all_results = []\n\n    def calculate_r_e(B, mu, A, lam):\n        \"\"\"\n        Calculates the equilibrium bond length r_e.\n        r_e = (1 / (mu - 2*lambda)) * ln((B*mu) / (2*A*lambda))\n        \"\"\"\n        # Constraints from the problem statement ensure the arguments are valid.\n        # mu > 2*lambda and B*mu > 2*A*lambda\n        denominator = mu - 2.0 * lam\n        numerator_log = (B * mu) / (2.0 * A * lam)\n        return (1.0 / denominator) * np.log(numerator_log)\n\n    for case in test_cases:\n        B, mu, lambda_NR, c_SR, A_NR, Delta_NR, Delta_SR, s_SO = case\n\n        # Non-relativistic (NR) case\n        A_nr = A_NR\n        lambda_nr = lambda_NR\n        r_NR = calculate_r_e(B, mu, A_nr, lambda_nr)\n\n        # Scalar-relativistic (SR) case\n        lambda_sr = c_SR * lambda_nr\n        A_sr = A_NR * (c_SR ** 2) * (Delta_NR / Delta_SR)\n        r_SR = calculate_r_e(B, mu, A_sr, lambda_sr)\n\n        # Fully relativistic (REL) case\n        lambda_rel = lambda_sr\n        # A_rel can be computed from A_sr\n        A_rel = A_sr / (1.0 + s_SO)\n        r_REL = calculate_r_e(B, mu, A_rel, lambda_rel)\n\n        # Calculate differences\n        delta_r_total = r_NR - r_REL\n        delta_r_scalar = r_NR - r_SR\n        delta_r_so = r_SR - r_REL\n\n        # Consistency check\n        check = abs(delta_r_total - (delta_r_scalar + delta_r_so)) = 1e-9\n\n        # Store results for this case\n        all_results.append([delta_r_total, delta_r_scalar, delta_r_so, check])\n\n    # Format the final output string as per problem specification.\n    # e.g., \"[[x11,x12,x13,true],[x21,x22,x23,true]]\"\n    outer_list_str = []\n    for res in all_results:\n        # Format boolean as lowercase 'true'/'false'\n        res_str = [f\"{v:.15f}\" for v in res[:3]] + [str(res[3]).lower()]\n        inner_list_str = f\"[{','.join(res_str)}]\"\n        outer_list_str.append(inner_list_str)\n    \n    final_string = f\"[{','.join(outer_list_str)}]\"\n    print(final_string)\n\nsolve()\n```", "id": "2454645"}, {"introduction": "了解一种方法的局限性与其优势同等重要。虽然ECP在描述价层性质方面表现出色，但其构造决定了它不适用于依赖于原子核附近电子密度的性质。最后一个练习使用一个受控的数学模型，来定量地展示这一关键限制 [@problem_id:2454650]。通过使用和不使用ECP近似计算一个依赖于核区性质的量，您将确切地看到为什么这种方法会失败并导致非物理的结果。", "problem": "要求您在一个数学上受控的环境中，论证为何使用有效核势 (ECP) 计算与芯层电子密度相关的性质会导致无意义的结果。请完全在原子单位制下进行计算，其中玻尔半径为 $a_0 = 1$。考虑一个核电荷为 $Z$ 的单电子类氢 $1s$ 态，其归一化的全电子径向波函数为 $\\psi_{1s}(r) = \\left(\\dfrac{Z^3}{\\pi}\\right)^{1/2} e^{-Z r}$，其电子密度为 $\\rho_{\\mathrm{AE}}(r;Z) = \\left|\\psi_{1s}(r)\\right|^2 = \\dfrac{Z^3}{\\pi} e^{-2 Z r}$。将一个“弥散接触”可观测量（费米接触超精细相互作用的替代模型）定义为半径为 $r_s$ 的小球内的平均电子密度：\n$$\n\\overline{\\rho}_{\\mathrm{AE}}(Z,r_s) = \\frac{3}{r_s^3} \\int_{0}^{r_s} \\rho_{\\mathrm{AE}}(r;Z)\\, r^2 \\, dr.\n$$\n现在采用一个简化的 ECP 模型，该模型通过在核半径 $r_c$ 内将赝密度设为零来移除芯层电子密度：\n$$\n\\rho_{\\mathrm{ECP}}(r;Z,r_c) = \n\\begin{cases}\n0,  0 \\le r \\le r_c,\\\\\n\\rho_{\\mathrm{AE}}(r;Z),  r  r_c.\n\\end{cases}\n$$\n定义相应的弥散 ECP 可观测量\n$$\n\\overline{\\rho}_{\\mathrm{ECP}}(Z,r_c,r_s) = \\frac{3}{r_s^3} \\int_{\\max(0,r_c)}^{r_s} \\rho_{\\mathrm{AE}}(r;Z)\\, r^2 \\, dr,\n$$\n并理解如果 $r_c \\ge r_s$，该积分为零。您的任务是：\n- 从给定的定义和标准积分出发，推导出比率\n$$\nR(Z,r_c,r_s) = \\frac{\\overline{\\rho}_{\\mathrm{ECP}}(Z,r_c,r_s)}{\\overline{\\rho}_{\\mathrm{AE}}(Z,r_s)}.\n$$\n的闭合形式表达式。\n- 实现一个程序，用于计算下面每个测试用例的 $R(Z,r_c,r_s)$ 值，单位为原子单位。程序不应需要任何外部输入。\n\n测试集（每个元组为 $(Z,r_c,r_s)$）：\n- $(1, 0.05, 0.2)$\n- $(1, 0.2, 0.2)$\n- $(6, 0.02, 0.2)$\n- $(10, 0.05, 0.2)$\n- $(2, 0.0, 0.2)$\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，$[\\text{result}_1,\\text{result}_2,\\dots]$）。每个结果必须是四舍五入到 $6$ 位小数的浮点数。可观测量的期望单位是 $a_0^{-3}$，但由于要求您返回比率 $R(Z,r_c,r_s)$，最终报告的数字是无单位的。在您的解释中，请说明为何这种基于简化 ECP 的可观测量在用于近似依赖于芯层电子密度（如原子核处的电场梯度或费米接触项）的性质时是无意义的。", "solution": "所提出的问题已经过验证，被认为是科学上可靠、定义明确且客观的。它构成了一个有效的练习，用以展示计算化学中有效核势 (ECP) 方法的一个基本局限性。因此，我们接下来进行完整的解析推导和计算实现。\n\n任务是推导并计算一个简化的类氢体系的比率 $R(Z,r_c,r_s) = \\overline{\\rho}_{\\mathrm{ECP}} / \\overline{\\rho}_{\\mathrm{AE}}$。我们首先推导这两个可观测量​​的表达式。\n\n首先，我们评估全电子 (AE) 弥散接触可观测量 $\\overline{\\rho}_{\\mathrm{AE}}(Z,r_s)$。这需要计算在半径为 $r_s$ 的球体内的径向概率密度 $4\\pi r^2 \\rho_{\\mathrm{AE}}(r;Z)$ 的积分。给出的定义是 $\\overline{\\rho}_{\\mathrm{AE}}(Z,r_s) = \\frac{3}{r_s^3} \\int_{0}^{r_s} \\rho_{\\mathrm{AE}}(r;Z)\\, r^2 \\, dr$。给定 $\\rho_{\\mathrm{AE}}(r;Z) = \\frac{Z^3}{\\pi} e^{-2 Z r}$，积分部分为：\n$$\nI_{\\mathrm{AE}} = \\int_{0}^{r_s} \\rho_{\\mathrm{AE}}(r;Z)\\, r^2 \\, dr = \\frac{Z^3}{\\pi} \\int_{0}^{r_s} r^2 e^{-2 Z r} dr\n$$\n为求解此积分，我们利用不定积分的标准形式：\n$$\n\\int r^2 e^{ar} dr = e^{ar} \\left( \\frac{r^2}{a} - \\frac{2r}{a^2} + \\frac{2}{a^3} \\right)\n$$\n通过代换 $a = -2Z$，我们得到：\n$$\n\\int r^2 e^{-2Zr} dr = -e^{-2Zr} \\left( \\frac{r^2}{2Z} + \\frac{2r}{4Z^2} + \\frac{2}{8Z^3} \\right) = -\\frac{e^{-2Zr}}{4Z^3} (2Z^2r^2 + 2Zr + 1)\n$$\n计算从 $0$ 到 $r_s$ 的定积分：\n$$\n\\int_{0}^{r_s} r^2 e^{-2Zr} dr = \\left[ -\\frac{e^{-2Zr}}{4Z^3} \\left( 2Z^2r^2 + 2Zr + 1 \\right) \\right]_{0}^{r_s}\n$$\n$$\n= \\left( -\\frac{e^{-2Zr_s}}{4Z^3} \\left( 2Z^2r_s^2 + 2Zr_s + 1 \\right) \\right) - \\left( -\\frac{e^{0}}{4Z^3} (0 + 0 + 1) \\right)\n$$\n$$\n= \\frac{1}{4Z^3} \\left( 1 - e^{-2Zr_s} \\left( 2Z^2r_s^2 + 2Zr_s + 1 \\right) \\right)\n$$\n将此结果代回到 $I_{\\mathrm{AE}}$ 的表达式中，然后代入 $\\overline{\\rho}_{\\mathrm{AE}}(Z,r_s)$：\n$$\nI_{\\mathrm{AE}} = \\frac{Z^3}{\\pi} \\frac{1}{4Z^3} \\left( 1 - e^{-2Zr_s} (2Z^2r_s^2 + 2Zr_s + 1) \\right) = \\frac{1}{4\\pi} \\left( 1 - e^{-2Zr_s} (2Z^2r_s^2 + 2Zr_s + 1) \\right)\n$$\n$$\n\\overline{\\rho}_{\\mathrm{AE}}(Z,r_s) = \\frac{3}{r_s^3} I_{\\mathrm{AE}} = \\frac{3}{4\\pi r_s^3} \\left( 1 - e^{-2Zr_s} (2Z^2r_s^2 + 2Zr_s + 1) \\right)\n$$\n接下来，我们评估 ECP 可观测量 $\\overline{\\rho}_{\\mathrm{ECP}}(Z,r_c,r_s)$。ECP 模型将 $r \\le r_c$ 的密度设为零。因此，积分的下限从 $r_c$ 开始。\n$$\n\\overline{\\rho}_{\\mathrm{ECP}}(Z,r_c,r_s) = \\frac{3}{r_s^3} \\int_{r_c}^{r_s} \\rho_{\\mathrm{AE}}(r;Z)\\, r^2 \\, dr\n$$\n这适用于 $0 \\le r_c  r_s$ 的情况。如果 $r_c \\ge r_s$，积分区间为空或长度为零，积分严格为零。对于 $r_c  r_s$，我们使用与之前相同的不定积分，但使用新的积分限：\n$$\nI_{\\mathrm{ECP}} = \\int_{r_c}^{r_s} \\rho_{\\mathrm{AE}}(r;Z)\\, r^2 \\, dr = \\frac{Z^3}{\\pi} \\left[ -\\frac{e^{-2Zr}}{4Z^3} \\left( 2Z^2r^2 + 2Zr + 1 \\right) \\right]_{r_c}^{r_s}\n$$\n$$\nI_{\\mathrm{ECP}} = \\frac{1}{4\\pi} \\left[ -e^{-2Zr} \\left( 2Z^2r^2 + 2Zr + 1 \\right) \\right]_{r_c}^{r_s}\n$$\n$$\nI_{\\mathrm{ECP}} = \\frac{1}{4\\pi} \\left( e^{-2Zr_c}(2Z^2r_c^2 + 2Zr_c + 1) - e^{-2Zr_s}(2Z^2r_s^2 + 2Zr_s + 1) \\right)\n$$\n比率 $R(Z,r_c,r_s)$ 为 $\\overline{\\rho}_{\\mathrm{ECP}} / \\overline{\\rho}_{\\mathrm{AE}} = I_{\\mathrm{ECP}} / I_{\\mathrm{AE}}$，因为前置因子 $\\frac{3}{r_s^3}$ 完全抵消了。\n$$\nR(Z,r_c,r_s) = \\frac{e^{-2Zr_c}(2Z^2r_c^2 + 2Zr_c + 1) - e^{-2Zr_s}(2Z^2r_s^2 + 2Zr_s + 1)}{1 - e^{-2Zr_s}(2Z^2r_s^2 + 2Zr_s + 1)} \\quad \\text{for } r_c  r_s\n$$\n对于 $r_c \\ge r_s$ 的情况，我们有 $\\overline{\\rho}_{\\mathrm{ECP}} = 0$，这意味着 $R(Z,r_c,r_s) = 0$。\n一个特殊的平凡情况是 $r_c = 0$。此时，分子变为 $e^0(0+0+1) - e^{-2Zr_s}(...)$，与分母相同，得到 $R(Z,0,r_s)=1$。这是正确的，因为核半径为零的 ECP 等同于全电子计算。\n\n此 $R(Z,r_c,r_s)$ 的闭合形式表达式被实现用于评估指定的测试用例。\n\n物理诠释展示了这种简化 ECP 方法的失败之处。有效核势的构建是为了再现价层性质，例如轨道能量和远离原子核的电子密度空间分布。它们通过用一个较弱的赝势替换强库仑势和芯层电子的复杂效应来实现这一点。该过程产生的无节点的价层赝波函数在计算上很方便，但在核区 ($r  r_c$) 在物理上是不正确的。\n\n诸如费米接触相互作用、原子核处的电场梯度以及 Mössbauer 异构体位移等性质，都极其依赖于原子核处或非常靠近原子核 ($r \\to 0$) 的电子密度及其梯度。ECP 模型根据其设计原理，移除了芯层电子，并将这个关键区域的电子密度设为零。正如我们在 $(Z, r_c, r_s) = (1, 0.2, 0.2)$ 的计算中所显示的，如果采样半径 $r_s$ 小于或等于核半径 $r_c$，基于 ECP 的可观测量恰好为零。这是一个灾难性的失败，与非零的全电子结果相比，产生了无限大的相对误差。\n\n即使当 $r_c  r_s$ 时，ECP 的结果也对人为参数 $r_c$ 高度敏感。对于具有较大 $Z$ 的较重原子（例如 $Z=10$），芯层密度更加集中在原子核附近。即使对于一个小的 $r_c$（例如 $0.05$ a.u.），移除这部分密度也会导致严重错误的结果，正如在测试用例 $(10, 0.05, 0.2)$ 中所看到的，其误差超过 $10\\%$。$r_c$ 的值是一个为计算方便而设的参数，并非物理可观测量。任何强烈依赖于 $r_c$ 的计算性质，根据定义，都是一个不符合物理的假象。结论是不可避免的：ECP 从根本上不适合用于计算依赖于核区内部电子密度的性质。试图这样做是对该方法的误用，并会导致无意义的、任意的结果。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of computing the ratio R(Z, r_c, r_s) for a set of test cases.\n    \"\"\"\n\n    test_cases = [\n        (1, 0.05, 0.2),  # Z, r_c, r_s in atomic units\n        (1, 0.2, 0.2),\n        (6, 0.02, 0.2),\n        (10, 0.05, 0.2),\n        (2, 0.0, 0.2),\n    ]\n\n    def calculate_R(Z, r_c, r_s):\n        \"\"\"\n        Calculates the ratio R for a given set of parameters Z, r_c, and r_s.\n\n        The ratio is defined as:\n        R = [exp(-2*Z*r_c)*P(r_c) - exp(-2*Z*r_s)*P(r_s)] / [1 - exp(-2*Z*r_s)*P(r_s)]\n        where P(r) = (2*Z^2*r^2 + 2*Z*r + 1).\n\n        Args:\n            Z (float): Nuclear charge.\n            r_c (float): Core radius.\n            r_s (float): Smearing radius.\n\n        Returns:\n            float: The calculated ratio R.\n        \"\"\"\n        # If the core radius is greater than or equal to the smearing radius,\n        # the ECP observable integral becomes zero.\n        if r_c >= r_s:\n            return 0.0\n\n        # Define a helper function for the polynomial term P(r) = 2*Z^2*r^2 + 2*Z*r + 1\n        def poly(r, Z_val):\n            term1 = 2 * (Z_val * r)**2\n            term2 = 2 * Z_val * r\n            return term1 + term2 + 1\n\n        # Calculate exponential terms\n        exp_rc = np.exp(-2 * Z * r_c)\n        exp_rs = np.exp(-2 * Z * r_s)\n        \n        # Calculate polynomial terms\n        poly_rc = poly(r_c, Z)\n        poly_rs = poly(r_s, Z)\n\n        # Numerator of the ratio R\n        numerator = exp_rc * poly_rc - exp_rs * poly_rs\n        \n        # Denominator of the ratio R\n        denominator = 1.0 - exp_rs * poly_rs\n\n        # It is a mathematical certainty that for r_s > 0 the denominator is non-zero.\n        # The integrated probability inside the sphere must be less than 1, so\n        # 4*pi*I_AE  1, which implies 1 - exp(...)*P(...) > 0.\n        if denominator == 0:\n            # This case physically corresponds to r_s -> infinity, where R->1.\n            # For finite r_s, this should not happen. It might indicate a precision issue\n            # if r_s is extremely large, but is safe to handle.\n            # A special case is r_c = 0 where num=den, so R=1.\n            if numerator == denominator:\n                return 1.0\n            else: # Should not be reached with valid inputs.\n                return np.nan\n\n        return numerator / denominator\n\n    results = []\n    for case in test_cases:\n        Z, r_c, r_s = case\n        result = calculate_R(Z, r_c, r_s)\n        results.append(f\"{result:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n\n```", "id": "2454650"}]}