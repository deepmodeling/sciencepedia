{"hands_on_practices": [{"introduction": "计算化学依赖于标准化的记号来传达复杂的基组构成。本练习旨在检验您将广泛使用的Pople风格记号，如 $\\text{6-31+G(d,p)}$，转化为对重原子和氢原子所添加函数的精确描述的能力 [@problem_id:2796127]。掌握这一点是为您的计算做出明智基组选择的第一步。", "problem": "您正在使用Pople分裂价高斯型轨道 (GTO) 基组，为一个主族阴离子和一个氢键复合物准备从头计算。该基组的标记为 $\\text{6-31+G(d,p)}$。请根据Pople风格表示法的标准语义，确定相对于母体 $\\text{6-31G}$，在非氢（“重”）原子和氢原子上确切添加了哪些额外的壳层，以及每个这样的添加壳层包含多少个高斯原函数。您的推理应基于以下广为接受的事实：极化函数是角动量比给定原子上已占据价空间最低要求更高的GTO；弥散函数是与已占据价空间角动量相同但指数较低的GTO，其能改善弱束缚电子密度的径向灵活性；符号“$+$”仅为重原子补充弥散函数，而“$++$”则同时为重原子和氢原子补充；在Pople基组中，每个指定的极化或弥散“集”均以每个原子上每个角动量一个非收缩原函数的形式实现。\n\n哪个选项是正确的？\n\nA. 重原子：添加1个非收缩的$d$型极化原函数，并添加1个弥散$s$原函数和1个弥散$p$原函数；氢原子：添加1个非收缩的$p$型极化原函数；氢原子上没有弥散原函数。\n\nB. 重原子：添加1个非收缩的$d$型极化原函数，并仅添加1个弥散$s$原函数；氢原子：添加1个弥散$s$原函数；氢原子上没有极化函数。\n\nC. 重原子：添加1个非收缩的$d$型和1个非收缩的$p$型极化原函数，并添加1个弥散$s$原函数；氢原子：添加1个非收缩的$d$型极化原函数。\n\nD. 重原子：添加1个非收缩的$f$型极化原函数，并添加1个弥散$s$原函数和1个弥散$p$原函数；氢原子：添加1个非收缩的$p$型极化原函数和1个弥散$s$原函数。\n\nE. 重原子：添加1个非收缩的$d$型极化原函数；氢原子：添加1个非收缩的$p$型极化原函数；重原子上的弥散扩充包含每个原子2个$s$原函数和2个$p$原函数；氢原子上没有弥散原函数。", "solution": "对该问题的分析必须严格遵守理论化学的既定原则。首先，必须对问题陈述本身的科学合理性和逻辑一致性进行验证。\n\n**问题验证**\n\n**步骤1：提取已知条件**\n-   **体系**：一个主族阴离子和一个氢键复合物。\n-   **方法**：从头计算。\n-   **基组**：Pople分裂价高斯型轨道 (GTO) 基组，具体标记为 $\\text{6-31+G(d,p)}$。\n-   **目标**：确定相对于母体 $\\text{6-31G}$ 基组，为非氢（“重”）原子和氢原子添加了哪些额外的壳层，以及每个添加的壳层包含的高斯原函数数量。\n-   **给定的定义和规则**：\n    1.  极化函数是角动量比给定原子上已占据价空间最低要求更高的GTO。\n    2.  弥散函数是与已占据价空间角动量相同但指数较低的GTO。\n    3.  符号“$+$”仅为重原子补充弥散函数。\n    4.  符号“$++$”同时为重原子和氢原子补充弥散函数。\n    5.  在Pople基组中，每个指定的极化或弥散“集”均以每个原子上每个角动量一个非收缩原函数的形式实现。\n\n**步骤2：使用提取的已知条件进行验证**\n-   **科学依据**：该问题立足于量子化学中用于Pople风格基组的标准表示法和定义。对极化函数和弥散函数的描述，以及像 `$+$` 和 `(d,p)` 这样的符号的含义，都与该领域普遍接受的惯例一致。体系的选择（阴离子、氢键复合物）正确地说明了使用此类函数来描述弥散电子密度和电荷分布畸变的动机。该问题在科学上是合理的。\n-   **问题的适定性**：问题精确无歧义。鉴于Pople表示法的标准语义（已作为规则明确提供），可以推导出唯一且确定的解。\n-   **客观性**：问题以客观的技术语言陈述，不含任何主观或非科学内容。\n\n**步骤3：结论与行动**\n问题陈述在科学上是合理的，适定的，客观的，且内部一致。它包含了推导唯一答案所需的所有信息。因此，该问题是**有效的**。我将继续进行解答。\n\n**解答的推导**\n\n任务是解构基组标记 $\\text{6-31+G(d,p)}$，并识别在基础 $\\text{6-31G}$ 基组上添加的函数。按照标准做法，我们将分别分析 `+G` 和 `(d,p)` 这两个组成部分。\n\n1.  **极化函数的分析：`(d,p)`**\n    表示法 `(d,p)` 指定了要添加的极化函数。逗号前的函数适用于重（非氢）原子，逗号后的函数适用于氢原子。\n    -   **重原子**：符号 `$d$` 表示添加 $d$ 型极化函数。如给定规则所述，极化函数拥有比价轨道更高的角动量 ($L$)。对于主族重原子（如碳、氧、氮），价壳层由 $s$ ($L=0$) 和 $p$ ($L=1$) 轨道组成。下一个更高的角动量是 $d$ ($L=2$)。问题指出，每个指定的集都是一个非收缩原函数。因此，对于每个重原子，会添加**一个非收缩的$d$型原函数壳层**。\n    -   **氢原子**：逗号后的符号 `$p$` 表示为氢原子添加 $p$ 型极化函数。对于氢，价壳层由一个 $s$ 轨道 ($L=0$) 组成。下一个更高的角动量是 $p$ ($L=1$)。因此，对于每个氢原子，会添加**一个非收缩的$p$型原函数壳层**。\n\n2.  **弥散函数的分析：`+G`**\n    位于 `G` 前的 `$+$` 符号表示添加弥散函数。\n    -   **重原子**：问题明确指出，单个 `$+$` 号**仅**为**重原子**补充弥散函数。它还指出，弥散函数与已占据价空间的角动量相同。对于主族重原子，价轨道是 $s$ 型和 $p$ 型。因此，必须添加 $s$ 型和 $p$ 型的弥散函数。根据每个“集”都是一个非收缩原函数的规则，这意味着为每个重原子添加**一个非收缩的弥散$s$型原函数**和**一个非收缩的弥散$p$型原函数**。\n    -   **氢原子**：问题指明 `$+$` 符号仅适用于重原子。要为氢原子添加弥散函数，需要使用 `$++$` 表示法。因此，**没有为氢原子添加弥散函数**。\n\n**对 $\\text{6-31G}$ 的补充总结：**\n-   **在每个重原子上**：一个非收缩的$d$型极化原函数，一个非收缩的弥散$s$型原函数，以及一个非收缩的弥散$p$型原函数。\n-   **在每个氢原子上**：一个非收缩的$p$型极化原函数。\n\n有了这个正确的推导，我们现在来评估所提供的选项。\n\n**逐项分析**\n\n-   **A. 重原子：添加1个非收缩的$d$型极化原函数，并添加1个弥散$s$原函数和1个弥散$p$原函数；氢原子：添加1个非收缩的$p$型极化原函数；氢原子上没有弥散原函数。**\n    该陈述与我们推导出的结论完全相符。它正确地指出了重原子上的$d$型极化、氢原子上的$p$型极化、重原子上同时添加$s$和$p$弥散函数，以及氢原子上没有弥散函数。根据问题的前提，原函数的数量（每种添加的壳层类型为1个）也是正确的。\n    **结论：正确。**\n\n-   **B. 重原子：添加1个非收缩的$d$型极化原函数，并仅添加1个弥散$s$原函数；氢原子：添加1个弥散$s$原函数；氢原子上没有极化函数。**\n    这个选项在多个方面都是错误的。对于重原子，它遗漏了必要的弥散$p$原函数。对于氢原子，它错误地添加了一个弥散$s$原函数（这需要 `$++$`），并错误地遗漏了 `(d,p)` 所表示的$p$型极化函数。\n    **结论：错误。**\n\n-   **C. 重原子：添加1个非收缩的$d$型和1个非收缩的$p$型极化原函数，并添加1个弥散$s$原函数；氢原子：添加1个非收缩的$d$型极化原函数。**\n    这个选项存在根本性错误。它错误地为重原子添加了$p$型极化函数。它遗漏了重原子的弥散$p$型函数。它错误地为氢原子添加了$d$型极化函数，这并非 `(d,p)` 的含义。\n    **结论：错误。**\n\n-   **D. 重原子：添加1个非收缩的$f$型极化原函数，并添加1个弥散$s$原函数和1个弥散$p$原函数；氢原子：添加1个非收缩的$p$型极化原函数和1个弥散$s$原函数。**\n    这个选项是错误的。它为重原子指定了$f$型极化，而表示法是 `(d,p)`。它还错误地为氢原子添加了弥散函数。\n    **结论：错误。**\n\n-   **E. 重原子：添加1个非收缩的$d$型极化原函数；氢原子：添加1个非收缩的$p$型极化原函数；重原子上的弥散扩充包含每个原子2个$s$原函数和2个$p$原函数；氢原子上没有弥散原函数。**\n    这个选项正确地指出了极化函数以及氢原子上没有弥散函数。但是，它错误地描述了重原子上的弥散函数扩充。`$+$` 表示法添加单个弥散函数集（一个$s$原函数和一个$p$原函数），而不是两个。一个为每个价角动量包含`$2$`个弥散原函数的基组会有不同的命名，并且与“每个指定的...弥散‘集’均以一个非收缩原函数的形式实现”的前提相矛盾。\n    **结论：错误。**", "answer": "$$\\boxed{A}$$", "id": "2796127"}, {"introduction": "极化函数对于描述分子电子云如何响应电场而变形至关重要，这一性质由极化率张量 $\\alpha$ 来量化。本练习将指导您基于微扰理论，建立一个简单但功能强大的双能级模型，以量化添加单个 $d$ 型极化函数如何增强极化率 [@problem_id:2916115]。通过推导和应用该模型，您将对这一关键基组效应背后的物理机制有更深刻的定量理解。", "problem": "考虑在一个水分子的氧中心上添加一个角动量为 $d$ 的单极化函数时，静态偶极极化率的变化，该变化按如下方式进行最小化建模。在 Hartree 原子单位 (a.u.) 中进行计算，其中基本电荷、约化普朗克常数和电子质量均设为 $1$，偶极矩的单位为 Bohr ($a_0$)，能量的单位为 Hartree ($E_h$)，极化率的单位为 $a_0^3$。\n\n从静态偶极极化率张量 $\\alpha_{ij}$ 的定义出发，该张量是电子基态能量 $E$ 相对于均匀电场分量 $\\mathcal{E}_i$ 的二阶导数，在零场下取值，即 $\\alpha_{ij} = -\\left.\\frac{\\partial^2 E}{\\partial \\mathcal{E}_i \\partial \\mathcal{E}_j}\\right|_{\\mathcal{E}=0}$。使用非简并定态 Rayleigh–Schrödinger 微扰理论和标准的全态求和 (sum-over-states) 表示作为基本依据，推导当通过添加一个单一、正交归一化的笛卡尔 $d$ 型高斯型轨道 (GTO) 引入一个新的以氧为中心的虚轨道通道时，沿固定分子轴 $k$ 的单个张量分量 $\\Delta \\alpha_{kk}$ 变化的最低阶表达式。\n\n采用以下具有物理动机且自洽的建模假设，以使问题明确且可进行数值检验，除此处列出的假设外，不引入任何额外的近似：\n- 变化量 $\\Delta \\alpha_{kk}$ 主要由一个具有 $p$ 特性的、以氧为中心的孤对电子类占据分子轨道 $\\lvert p \\rangle$ 与由添加的 $d$ 型 GTO 支持的新虚轨道构型 $\\lvert d \\rangle$ 之间的混合所主导。所有其他占据-虚轨道通道均假定不变，因此在差值中被抵消。\n- 这两种构型之间的能隙是一个正常数 $\\Delta E = E_d - E_p > 0$，在每个测试案例中以 $E_h$ 为单位指定。\n- 沿 $k$ 轴的跃迁偶极矩阵元与所添加的笛卡尔 $d$ 型 GTO 的空间范围成比例。具体而言，取该矩阵元的大小为 $\\mu_{pd}^{(k)} = S\\,\\zeta_d^{-1/2}$，其中 $\\zeta_d > 0$ 是 $d$ 函数的高斯指数，单位为 $a_0^{-2}$；$S > 0$ 是一个无量纲振幅，用于捕捉氧上沿 $k$ 轴的有效 $p$ 特性以及角耦合。\n- 假设所涉及的态是正交归一的，并忽略电场中超过一阶的弛豫效应，这与线性响应一致。\n\n您的任务是：\n1. 仅使用所述的基本依据和建模假设，推导 $\\Delta \\alpha_{kk}$ 关于 $\\Delta E$、$\\zeta_d$ 和 $S$ 的显式表达式，并确定其符号。您的推导必须基于一阶微扰密度观点和全态求和图像，并且必须在逻辑上将 $\\mu_{pd}^{(k)}$ 的标度关系与观察到的 $\\Delta \\alpha_{kk}$ 对 $\\zeta_d$ 和 $\\Delta E$ 的依赖关系联系起来。\n2. 实现一个程序，对下面给定的一小组参数三元组 $(\\Delta E, \\zeta_d, S)$ 测试集，计算您推导的表达式。为每个测试案例生成 $\\Delta \\alpha_{kk}$ 的数值，单位为 $a_0^3$。\n3. 最终输出必须是单行，包含一个 Python 列表字面量，其中含有各测试案例的结果，顺序与所列顺序相同，每个值四舍五入到 $6$ 位小数，例如 $[x_1,x_2,x_3]$。\n4. 您需要以 $a_0^3$ 为单位表示结果。\n\n测试集 (每个三元组为 $(\\Delta E, \\zeta_d, S)$，其中 $\\Delta E$ 的单位为 $E_h$，$\\zeta_d$ 的单位为 $a_0^{-2}$，$S$ 为无量纲)：\n- 案例 A (一般理想路径): $(0.6,\\;1.5,\\;1.1)$。\n- 案例 B (紧凑 $d$ 函数, 类边界行为): $(1.5,\\;6.0,\\;1.1)$。\n- 案例 C (弥散 $d$ 函数, 边缘情况行为): $(0.3,\\;0.5,\\;1.1)$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $[r_1,r_2,r_3]$），其中每个 $r_i$ 是相应测试案例计算出的 $\\Delta \\alpha_{kk}$ 值（单位为 $a_0^3$），并四舍五入到 $6$ 位小数。", "solution": "首先对问题陈述进行验证程序。\n\n步骤 1：提取的已知条件。\n- 静态偶极极化率张量的定义为 $\\alpha_{ij} = -\\left.\\partial^2 E / \\partial \\mathcal{E}_i \\partial \\mathcal{E}_j\\right|_{\\mathcal{E}=0}$。\n- 理论基础是非简并定态 Rayleigh–Schrödinger 微扰理论和全态求和表示。\n- 关注的量是，在水分子的氧原子上添加一个笛卡尔 $d$ 型高斯型轨道 (GTO) 后，极化率张量分量 $\\Delta \\alpha_{kk}$ 的变化。\n- 假设 1：变化 $\\Delta \\alpha_{kk}$ 完全是由于在已占据的 $p$ 型分子轨道 (MO) $\\lvert p \\rangle$ 和新的虚 $d$ 型分子轨道 $\\lvert d \\rangle$ 之间引入了一个新的激发通道。\n- 假设 2：这两个态之间的能隙是一个正常数 $\\Delta E = E_d - E_p  0$。\n- 假设 3：沿 $k$ 轴，这些态之间的跃迁偶极矩阵元的大小由模型 $\\mu_{pd}^{(k)} = S\\,\\zeta_d^{-1/2}$ 给出，其中 $\\zeta_d  0$ 是 GTO 指数，$S  0$ 是无量纲振幅。\n- 假设 4：这些态是正交归一的，并且忽略超过一阶的电子弛豫效应。\n- 所有计算均在 Hartree 原子单位中进行，极化率以 $a_0^3$ 为单位表示。\n- $(\\Delta E, \\zeta_d, S)$ 的测试案例：案例 A $(0.6, 1.5, 1.1)$；案例 B $(1.5, 6.0, 1.1)$；案例 C $(0.3, 0.5, 1.1)$。\n\n步骤 2：验证。\n该问题具有科学依据，基于量子化学的标准原理（微扰理论、基组、分子性质）。其简化假设虽然大胆，但具有物理动机，旨在创建一个可解的模型，并已明确陈述。问题提法得当、客观且自成体系，为推导唯一表达式和计算所需数值提供了所有必要信息。它没有违反任何基本定律，也不是无足轻重或定义不明确的。\n\n步骤 3：结论。\n问题有效。将提供一个合理的解答。\n\n推导过程从静态偶极极化率的全态求和 (SOS) 表达式开始，该表达式是将二阶 Rayleigh-Schrödinger 微扰理论应用于静态电场中分子的直接结果。对于对角分量 $\\alpha_{kk}$，SOS 表达式为：\n$$\n\\alpha_{kk} = 2 \\sum_{n \\neq 0} \\frac{|\\langle \\Psi_0 | \\hat{\\mu}_k | \\Psi_n \\rangle|^2}{E_n - E_0}\n$$\n其中 $\\Psi_0$ 是能量为 $E_0$ 的电子基态，$\\{\\Psi_n\\}_{n \\neq 0}$ 是能量为 $E_n$ 的所有激发电子态的集合，$\\hat{\\mu}_k$ 是电偶极算符的 $k$ 分量。所有量均采用原子单位。\n\n问题指出，添加一个新的 $d$ 型 GTO 会引入一个单一的新虚轨道通道，该通道涉及一个占据轨道 $\\lvert p \\rangle$ 和一个新的虚轨道 $\\lvert d \\rangle$。所有其他占据-虚轨道通道假定不受影响。因此，极化率的变化 $\\Delta \\alpha_{kk}$ 就是这个单一新增项对全态求和的贡献：\n$$\n\\Delta \\alpha_{kk} = 2 \\frac{|\\langle \\Psi_0 | \\hat{\\mu}_k | \\Psi_{p \\to d} \\rangle|^2}{E_{p \\to d} - E_0}\n$$\n其中 $\\Psi_{p \\to d}$ 是新近可及的激发态，对应于电子从 $\\lvert p \\rangle$ 跃迁到 $\\lvert d \\rangle$。\n\n我们现在应用建模假设来计算此表达式。\n1. 能量分母 $E_{p \\to d} - E_0$ 是激发能。在分子轨道图像中，这近似于轨道能量的差值。问题直接以能隙 $\\Delta E = E_d - E_p$ 的形式给出了这个值。\n2. 分子包含跃迁偶极矩的平方，$|\\langle \\Psi_0 | \\hat{\\mu}_k | \\Psi_{p \\to d} \\rangle|^2$。在单粒子模型中，这个态-态矩阵元与轨道矩阵元 $\\mu_{pd}^{(k)} = \\langle p | \\hat{\\mu}_k | d \\rangle$ 成正比。问题为这个有效跃迁矩的大小提供了一个模型：$|\\mu_{pd}^{(k)}| = S \\zeta_d^{-1/2}$。\n\n将这些模型参数代入 $\\Delta \\alpha_{kk}$ 的表达式中：\n$$\n\\Delta \\alpha_{kk} = 2 \\frac{(S \\zeta_d^{-1/2})^2}{\\Delta E}\n$$\n这可以简化为最终表达式：\n$$\n\\Delta \\alpha_{kk} = \\frac{2 S^2}{\\Delta E \\cdot \\zeta_d}\n$$\n这就是 $\\Delta \\alpha_{kk}$ 关于给定参数 $\\Delta E$、$\\zeta_d$ 和 $S$ 的显式表达式。\n\n为了确定 $\\Delta \\alpha_{kk}$ 的符号，我们注意到根据定义 $S  0$，因此 $S^2  0$。能隙 $\\Delta E  0$ 和高斯指数 $\\zeta_d  0$ 也被给定为正常数。由于表达式中所有因子均为正，所得的极化率变化 $\\Delta \\alpha_{kk}$ 必须为正。这在物理上是正确的：为电子密度响应外部电场增加一个极化通道，必然会增加系统的极化率。\n\n该推导也阐明了 $\\Delta \\alpha_{kk}$ 对模型参数的依赖性。与能隙的反比关系 $\\Delta \\alpha_{kk} \\propto 1/\\Delta E$ 是二阶微扰理论的典型特征：较小的能隙导致更强的耦合和更大的响应。与指数的反比关系 $\\Delta \\alpha_{kk} \\propto 1/\\zeta_d$ 源于跃迁偶极矩的标度行为。较小的高斯指数 $\\zeta_d$ 意味着一个在空间上更弥散的 GTO。一个弥散函数具有更大的空间范围，这导致依赖于位置的偶极算符的矩阵元 $\\mu_{pd}^{(k)}$ 值更大。这个更大的跃迁矩反过来又对极化率产生更大的贡献，这与弥散基函数对于准确描述极化率至关重要的已知事实相一致。\n\n问题现在简化为使用推导出的公式对所提供的测试案例进行数值计算。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the change in static dipole polarizability based on a derived\n    two-level model and provided test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is (delta_E, zeta_d, S)\n    test_cases = [\n        (0.6, 1.5, 1.1),  # Case A: General happy path\n        (1.5, 6.0, 1.1),  # Case B: Tight d function, boundary-like behavior\n        (0.3, 0.5, 1.1),  # Case C: Diffuse d function, edge-case behavior\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack parameters for the current case\n        delta_E, zeta_d, S = case\n\n        # The derived formula for the change in polarizability is:\n        # delta_alpha_kk = (2 * S^2) / (delta_E * zeta_d)\n        # All inputs are in Hartree atomic units, so the result is in the\n        # atomic unit of polarizability, which is a_0^3.\n        delta_alpha_kk = (2 * S**2) / (delta_E * zeta_d)\n\n        # Append the result formatted to 6 decimal places as required.\n        results.append(f\"{delta_alpha_kk:.6f}\")\n\n    # Final print statement in the exact required format: [r1,r2,r3]\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2916115"}, {"introduction": "准确计算维持分子复合物的弱相互作用是量子化学的核心挑战。一个主要障碍是基组重叠误差（Basis Set Superposition Error, BSSE），这是一种因使用不完备基组而产生的非物理性稳定化。本练习将介绍平衡校正（counterpoise correction）框架，并要求您将相互作用能误差分解为来自BSSE和内在基组不完备性的分量，从而为您评估计算可靠性提供一个强大的诊断工具 [@problem_id:2916061]。", "problem": "给定一个卤化物-水复合物的超分子描述，以及使用不同基组（包含和不包含弥散增广）计算的一系列绝对电子能量。您的目标是使用半对位校正 (half-CP) 框架，将相互作用能误差分解为一个归因于基组重叠误差 (BSSE) 的分量和一个归因于基组不完备性（有时称为基组不完备性误差）的分量。\n\n从以下基本事实和定义出发，这些是量子化学中的标准内容，源于变分原理和超分子能量定义：\n- 令 $E_{AB}^{AB}$ 表示在二聚体基组中计算的二聚体电子能量。\n- 令 $E_{A}^{A}$ 和 $E_{B}^{B}$ 表示在各自单体基组中计算的单体电子能量。\n- 令 $E_{A}^{AB}$ 和 $E_{B}^{AB}$ 表示在伙伴基函数作为鬼函数（即带有单个鬼原子的“二聚体基组”）存在下计算的单体能量，根据变分原理，它们满足 $E_{A}^{AB} \\le E_{A}^{A}$ 和 $E_{B}^{AB} \\le E_{B}^{B}$。\n- 原始（未校正的）超分子相互作用能为\n$$\nI_{\\mathrm{raw}} \\equiv E_{AB}^{AB} - E_{A}^{A} - E_{B}^{B}.\n$$\n- 遵循 Boys–Bernardi 对位校正的对位校正 (CP) 相互作用能为\n$$\nI_{\\mathrm{CP}} \\equiv E_{AB}^{AB} - E_{A}^{AB} - E_{B}^{AB}.\n$$\n- 半对位校正 (half-CP) 相互作用能是平均值\n$$\nI_{1/2} \\equiv \\tfrac{1}{2}\\left(I_{\\mathrm{raw}} + I_{\\mathrm{CP}}\\right).\n$$\n- CP 偏移（基组重叠误差 (BSSE) 的标准估计量）为\n$$\n\\Delta_{\\mathrm{CP}} \\equiv \\left(E_{A}^{AB} - E_{A}^{A}\\right) + \\left(E_{B}^{AB} - E_{B}^{B}\\right),\n$$\n其满足 $I_{\\mathrm{CP}} = I_{\\mathrm{raw}} - \\Delta_{\\mathrm{CP}}$。\n\n设参考（完备基）相互作用能由 $I_{\\mathrm{ref}}$ 给出，并将半对位校正相互作用能误差定义为\n$$\n\\varepsilon_{1/2} \\equiv I_{1/2} - I_{\\mathrm{ref}}.\n$$\n\n您的任务是：\n1) 仅使用上述定义，将 $\\varepsilon_{1/2}$ 代数地表示为两个贡献之和，一个依赖于 $\\Delta_{\\mathrm{CP}}$，另一个仅依赖于 $I_{\\mathrm{CP}} - I_{\\mathrm{ref}}$。将这两项分别解释为“half-CP 中的残余 BSSE 贡献”和“half-CP 中的基组不完备性贡献”。除给定定义外，不要引入任何额外假设。\n2) 在一个程序中实现这些表达式，为每个测试用例评估这两个贡献及其总和。\n3) 使用换算因子 $1\\,\\text{hartree} = 2625.49962\\,\\text{kJ}\\,\\text{mol}^{-1}$，将所有最终报告的量从哈特里 (hartree) 转换为千焦每摩尔 ($\\text{kJ}\\,\\text{mol}^{-1}$)。\n4) 将所有最终数值答案以 $\\text{kJ}\\,\\text{mol}^{-1}$ 为单位表示，并四舍五入到六位小数。\n\n使用以下参数集测试套件，每组提供 $\\left(E_{AB}^{AB}, E_{A}^{A}, E_{B}^{B}, E_{A}^{AB}, E_{B}^{AB}\\right)$（单位为哈特里），以及一个对应相同复合物几何构型的通用参考相互作用能 $I_{\\mathrm{ref}}$（单位为哈特里）：\n\n- 测试用例 1 (非增广、极化、双泽塔类):\n  - $E_{AB}^{AB} = -536.490000$\n  - $E_{A}^{A} = -460.180000$\n  - $E_{B}^{B} = -76.280000$\n  - $E_{A}^{AB} = -460.186000$\n  - $E_{B}^{AB} = -76.284000$\n- 测试用例 2 (非增广、极化、三泽塔类):\n  - $E_{AB}^{AB} = -536.526666$\n  - $E_{A}^{A} = -460.200000$\n  - $E_{B}^{B} = -76.300000$\n  - $E_{A}^{AB} = -460.205000$\n  - $E_{B}^{AB} = -76.302000$\n- 测试用例 3 (弥散增广、极化、三泽塔类):\n  - $E_{AB}^{AB} = -536.542800$\n  - $E_{A}^{A} = -460.210000$\n  - $E_{B}^{B} = -76.310000$\n  - $E_{A}^{AB} = -460.211500$\n  - $E_{B}^{AB} = -76.310800$\n- 测试用例 4 (弥散增广、极化、四泽塔类):\n  - $E_{AB}^{AB} = -536.550700$\n  - $E_{A}^{A} = -460.215000$\n  - $E_{B}^{B} = -76.315000$\n  - $E_{A}^{AB} = -460.215200$\n  - $E_{B}^{AB} = -76.315100$\n\n所有用例使用相同的参考相互作用能：\n- $I_{\\mathrm{ref}} = -0.020500$ 哈特里。\n\n对于每个测试用例，您的程序必须计算并返回一个三元组\n$$\n\\left[\\varepsilon_{1/2},\\ \\varepsilon_{\\mathrm{BSSE}}^{(1/2)},\\ \\varepsilon_{\\mathrm{inc}}^{(1/2)}\\right],\n$$\n其中每个条目都以 $\\text{kJ}\\,\\text{mol}^{-1}$ 表示并四舍五入到六位小数，其中 $\\varepsilon_{1/2}$ 是 half-CP 总相互作用能误差，$\\varepsilon_{\\mathrm{BSSE}}^{(1/2)}$ 是 half-CP 中的残余 BSSE 贡献，$\\varepsilon_{\\mathrm{inc}}^{(1/2)}$ 是 half-CP 中的基组不完备性贡献，使得\n$$\n\\varepsilon_{1/2} = \\varepsilon_{\\mathrm{BSSE}}^{(1/2)} + \\varepsilon_{\\mathrm{inc}}^{(1/2)}.\n$$\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个 JSON 风格的列表的列表，每个内部列表对应一个测试用例，并按上述顺序排列。例如：\n- \n  \"[[x11,x12,x13],[x21,x22,x23],[x31,x32,x33],[x41,x42,x43]]\"\n- \n其中每个 $x_{ij}$ 以 $\\text{kJ}\\,\\text{mol}^{-1}$ 为单位，四舍五入到六位小数，且无任何附加文本。\n\n角度单位不适用。所有提供的能量单位均为哈特里，所有要求的输出必须以 $\\text{kJ}\\,\\text{mol}^{-1}$ 为单位。", "solution": "问题陈述已经过严格验证，被认为是科学上可靠、适定且内部一致的。所有给出的定义在量子化学领域都是标准的，数值数据在物理上是现实的，并符合变分原理，即 $E_{X}^{XY} \\le E_{X}^{X}$。因此，我们可以着手求解。\n\n主要任务是将半对位校正 (half-CP) 相互作用能的总误差 $\\varepsilon_{1/2}$ 分解为两个具有物理意义的分量：一个残余基组重叠误差 (BSSE) 贡献 $\\varepsilon_{\\mathrm{BSSE}}^{(1/2)}$ 和一个基组不完备性贡献 $\\varepsilon_{\\mathrm{inc}}^{(1/2)}$。这个分解必须从提供的基本定义代数推导得出。\n\n我们从半对位校正相互作用能误差的定义开始：\n$$\n\\varepsilon_{1/2} \\equiv I_{1/2} - I_{\\mathrm{ref}}\n$$\n半对位校正相互作用能 $I_{1/2}$ 定义为原始相互作用能和完全经对位校正的相互作用能的算术平均值：\n$$\nI_{1/2} \\equiv \\frac{1}{2}\\left(I_{\\mathrm{raw}} + I_{\\mathrm{CP}}\\right)\n$$\n将此代入 $\\varepsilon_{1/2}$ 的表达式中，得到：\n$$\n\\varepsilon_{1/2} = \\frac{1}{2}\\left(I_{\\mathrm{raw}} + I_{\\mathrm{CP}}\\right) - I_{\\mathrm{ref}}\n$$\n问题给出了原始相互作用能 $I_{\\mathrm{raw}}$、经 CP 校正的相互作用能 $I_{\\mathrm{CP}}$ 和 CP 偏移 $\\Delta_{\\mathrm{CP}}$ 之间的关系为 $I_{\\mathrm{CP}} = I_{\\mathrm{raw}} - \\Delta_{\\mathrm{CP}}$。我们可以重新整理此式，用 $I_{\\mathrm{CP}}$ 和 $\\Delta_{\\mathrm{CP}}$ 来表示 $I_{\\mathrm{raw}}$：\n$$\nI_{\\mathrm{raw}} = I_{\\mathrm{CP}} + \\Delta_{\\mathrm{CP}}\n$$\n现在，我们将 $I_{\\mathrm{raw}}$ 的这个表达式代入我们的 $\\varepsilon_{1/2}$ 方程中：\n$$\n\\varepsilon_{1/2} = \\frac{1}{2}\\left((I_{\\mathrm{CP}} + \\Delta_{\\mathrm{CP}}) + I_{\\mathrm{CP}}\\right) - I_{\\mathrm{ref}}\n$$\n合并括号内的项，得到：\n$$\n\\varepsilon_{1/2} = \\frac{1}{2}\\left(2I_{\\mathrm{CP}} + \\Delta_{\\mathrm{CP}}\\right) - I_{\\mathrm{ref}}\n$$\n分配因子 $\\frac{1}{2}$ 并重新排列各项以分离出所需的相关性，我们得到：\n$$\n\\varepsilon_{1/2} = I_{\\mathrm{CP}} + \\frac{1}{2}\\Delta_{\\mathrm{CP}} - I_{\\mathrm{ref}} = \\left(I_{\\mathrm{CP}} - I_{\\mathrm{ref}}\\right) + \\frac{1}{2}\\Delta_{\\mathrm{CP}}\n$$\n这个表达式提供了所需的分解。我们现在可以确定这两个贡献。\n\n第一项 $(I_{\\mathrm{CP}} - I_{\\mathrm{ref}})$ 代表了完全经 CP 校正的相互作用能与精确参考值之间的偏差。CP 校正旨在消除 BSSE。因此，$I_{\\mathrm{CP}}$ 中任何剩余的误差都归因于所选基组的内在缺陷或不完备性。我们将其定义为基组不完备性贡献：\n$$\n\\varepsilon_{\\mathrm{inc}}^{(1/2)} \\equiv I_{\\mathrm{CP}} - I_{\\mathrm{ref}}\n$$\n第二项 $\\frac{1}{2}\\Delta_{\\mathrm{CP}}$ 正是总 CP 校正值的一半，而总 CP 校正值是 BSSE 大小的标准估计量。根据其构造，half-CP 方法仅校正了估计 BSSE 的一半。因此，将这第二项解释为在 half-CP 方案中未被校正的残余 BSSE 是合乎逻辑的：\n$$\n\\varepsilon_{\\mathrm{BSSE}}^{(1/2)} \\equiv \\frac{1}{2}\\Delta_{\\mathrm{CP}}\n$$\n如所推导，总的 half-CP 误差是这两个分量之和，即 $\\varepsilon_{1/2} = \\varepsilon_{\\mathrm{BSSE}}^{(1/2)} + \\varepsilon_{\\mathrm{inc}}^{(1/2)}$。\n\n每个测试用例的计算步骤如下。给定一组能量 $\\left(E_{AB}^{AB}, E_{A}^{A}, E_{B}^{B}, E_{A}^{AB}, E_{B}^{AB}\\right)$（单位为哈特里）和参考相互作用能 $I_{\\mathrm{ref}}$（单位为哈特里）：\n1.  计算 CP 偏移 $\\Delta_{\\mathrm{CP}}$，单位为哈特里：\n    $$\n    \\Delta_{\\mathrm{CP}} = (E_{A}^{AB} - E_{A}^{A}) + (E_{B}^{AB} - E_{B}^{B})\n    $$\n2.  计算经 CP 校正的相互作用能 $I_{\\mathrm{CP}}$，单位为哈特里：\n    $$\n    I_{\\mathrm{CP}} = E_{AB}^{AB} - E_{A}^{AB} - E_{B}^{AB}\n    $$\n3.  计算两个误差分量，单位为哈特里：\n    $$\n    \\varepsilon_{\\mathrm{BSSE}}^{(1/2)} = \\frac{1}{2}\\Delta_{\\mathrm{CP}}\n    $$\n    $$\n    \\varepsilon_{\\mathrm{inc}}^{(1/2)} = I_{\\mathrm{CP}} - I_{\\mathrm{ref}}\n    $$\n4.  计算总的 half-CP 误差 $\\varepsilon_{1/2}$，单位为哈特里，即它们的和：\n    $$\n    \\varepsilon_{1/2} = \\varepsilon_{\\mathrm{BSSE}}^{(1/2)} + \\varepsilon_{\\mathrm{inc}}^{(1/2)}\n    $$\n5.  使用给定的换算因子 $1\\,\\text{hartree} = 2625.49962\\,\\text{kJ}\\,\\text{mol}^{-1}$，将这三个量从哈特里转换为 $\\text{kJ}\\,\\text{mol}^{-1}$。\n6.  将最终的 $\\text{kJ}\\,\\text{mol}^{-1}$ 结果四舍五入到六位小数。\n\n此过程将被实现并应用于所提供的四个测试用例。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and partitions the half-CP interaction energy error for a series of\n    quantum chemical calculations on a halide-water complex.\n    \"\"\"\n\n    # Conversion factor from Hartree to kJ/mol as specified.\n    H_TO_KJ_MOL = 2625.49962\n\n    # Reference interaction energy in Hartree, common to all test cases.\n    I_ref_hartree = -0.020500\n\n    # Test cases: (E_AB_AB, E_A_A, E_B_B, E_A_AB, E_B_AB) in Hartree.\n    test_cases = [\n        # Test Case 1 (non-augmented, polarized, double-zeta-like)\n        (-536.490000, -460.180000, -76.280000, -460.186000, -76.284000),\n        # Test Case 2 (non-augmented, polarized, triple-zeta-like)\n        (-536.526666, -460.200000, -76.300000, -460.205000, -76.302000),\n        # Test Case 3 (diffuse-augmented, polarized, triple-zeta-like)\n        (-536.542800, -460.210000, -76.310000, -460.211500, -76.310800),\n        # Test Case 4 (diffuse-augmented, polarized, quadruple-zeta-like)\n        (-536.550700, -460.215000, -76.315000, -460.215200, -76.315100),\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        E_AB_AB, E_A_A, E_B_B, E_A_AB, E_B_AB = case\n\n        # 1. Calculate CP shift (Delta_CP) in Hartree.\n        # This is the standard estimator for the Basis Set Superposition Error (BSSE).\n        delta_cp_hartree = (E_A_AB - E_A_A) + (E_B_AB - E_B_B)\n\n        # 2. Calculate CP-corrected interaction energy (I_CP) in Hartree.\n        I_cp_hartree = E_AB_AB - E_A_AB - E_B_AB\n\n        # 3. Calculate the error components in Hartree based on the derivation.\n        # Residual BSSE contribution in half-CP scheme.\n        eps_bsse_half_cp_hartree = 0.5 * delta_cp_hartree\n        # Basis-set incompleteness contribution in half-CP scheme.\n        eps_inc_half_cp_hartree = I_cp_hartree - I_ref_hartree\n        # Total half-CP error, being the sum of the two components.\n        eps_half_cp_hartree = eps_bsse_half_cp_hartree + eps_inc_half_cp_hartree\n\n        # 4. Convert all quantities to kJ/mol.\n        eps_half_cp_kjmol = eps_half_cp_hartree * H_TO_KJ_MOL\n        eps_bsse_half_cp_kjmol = eps_bsse_half_cp_hartree * H_TO_KJ_MOL\n        eps_inc_half_cp_kjmol = eps_inc_half_cp_hartree * H_TO_KJ_MOL\n\n        # 5. Round to six decimal places as required.\n        result_triple = [\n            round(eps_half_cp_kjmol, 6),\n            round(eps_bsse_half_cp_kjmol, 6),\n            round(eps_inc_half_cp_kjmol, 6),\n        ]\n        \n        all_results.append(result_triple)\n\n    # 6. Format the output as a JSON-like string of a list of lists.\n    # The format requires no spaces and specific bracketing.\n    case_strings = [f\"[{res[0]},{res[1]},{res[2]}]\" for res in all_results]\n    final_output = f\"[{','.join(case_strings)}]\"\n    \n    # Print the final formatted string.\n    print(final_output)\n\nsolve()\n```", "id": "2916061"}]}