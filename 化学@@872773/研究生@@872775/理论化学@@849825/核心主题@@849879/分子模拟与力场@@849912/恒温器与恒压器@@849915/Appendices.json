{"hands_on_practices": [{"introduction": "在分子动力学中，我们通过恒温器来控制系统的热力学温度$T$。然而，在任何有限的系统中，瞬时动能温度$\\hat{T}$本身就是一个涨落的量。理解这些涨落的性质，是评估恒温器性能和理解系综统计特性的第一步。本练习将从统计力学的基本原理出发，推导瞬时温度估算子的相对方差，揭示其与系统自由度的基本关系 ([@problem_id:2825163])。", "problem": "考虑一个由 $N$ 个粒子组成的经典系统，在恒温器下演化，使其动量从热力学温度为 $T$ 的正则系综中抽样。在移除所有完整约束和整体守恒量后，假设该系统有 $f$ 个有效动能自由度（DOF）。在分子动力学（MD）恒温器中常用的瞬时动能温度估计量定义为\n$$\n\\hat{T} \\equiv \\frac{2 K}{f k_{\\mathrm{B}}},\n$$\n其中 $K$ 是瞬时动能，$k_{\\mathrm{B}}$ 是玻尔兹曼常数。在正则系综中，联合动量分布可因子分解并服从 Maxwell–Boltzmann 形式，因此\n$$\nP(\\{p_{i}\\}\\,|\\,T) \\propto \\exp\\!\\left(-\\beta \\sum_{i=1}^{f} \\frac{p_{i}^{2}}{2 m_{i}}\\right), \\quad \\beta \\equiv \\frac{1}{k_{\\mathrm{B}} T},\n$$\n其中有效质量 $m_{i} > 0$ 与 $f$ 个二次动能模式相关联。\n\n从这些正则系综的事实以及独立高斯变量的基本性质出发，推导无量纲相对方差\n$$\n\\frac{\\operatorname{Var}(\\hat{T})}{T^{2}}\n$$\n的一个仅用 $f$ 表示的闭式表达式。请将最终答案表示为关于 $f$ 的单个解析表达式。该比值为无量纲，无需单位，也无需进行数值取整。", "solution": "所述问题具有科学依据、内容自洽且良定，是统计力学中的一个标准推导。下面我们开始求解。\n\n我们的目标是推导瞬时动能温度估计量 $\\hat{T}$ 的无量纲相对方差的表达式，其定义为\n$$\n\\hat{T} \\equiv \\frac{2 K}{f k_{\\mathrm{B}}}\n$$\n其中 $K$ 是总瞬时动能，$f$ 是有效动能自由度的数量，$k_{\\mathrm{B}}$ 是玻尔兹曼常数。需要推导的量是 $\\frac{\\operatorname{Var}(\\hat{T})}{T^2}$。\n\n方差定义为 $\\operatorname{Var}(\\hat{T}) = \\langle \\hat{T}^2 \\rangle - \\langle \\hat{T} \\rangle^2$。尖括号 $\\langle \\dots \\rangle$ 表示在热力学温度为 $T$ 的正则系综上的系综平均。因此，所求的比值为\n$$\n\\frac{\\operatorname{Var}(\\hat{T})}{T^2} = \\frac{\\langle \\hat{T}^2 \\rangle - \\langle \\hat{T} \\rangle^2}{T^2}\n$$\n总动能 $K$ 是 $f$ 个独立模式的动能之和：\n$$\nK = \\sum_{i=1}^{f} K_i = \\sum_{i=1}^{f} \\frac{p_i^2}{2 m_i}\n$$\n其中 $p_i$ 和 $m_i$ 分别是第 $i$ 个自由度的动量和有效质量。\n\n首先，我们计算期望值 $\\langle \\hat{T} \\rangle$。\n$$\n\\langle \\hat{T} \\rangle = \\left\\langle \\frac{2 K}{f k_{\\mathrm{B}}} \\right\\rangle = \\frac{2}{f k_{\\mathrm{B}}} \\langle K \\rangle = \\frac{2}{f k_{\\mathrm{B}}} \\left\\langle \\sum_{i=1}^{f} K_i \\right\\rangle = \\frac{2}{f k_{\\mathrm{B}}} \\sum_{i=1}^{f} \\langle K_i \\rangle\n$$\n每个动量 $p_i$ 都服从 Maxwell-Boltzmann 分布，对于单个模式来说，这是一个高斯分布。在正则系综中，单个二次自由度的能量期望值是能量均分定理的直接推论，该定理指出 $\\langle K_i \\rangle = \\frac{1}{2} k_{\\mathrm{B}} T$。\n\n因此，平均总动能为：\n$$\n\\langle K \\rangle = \\sum_{i=1}^{f} \\frac{1}{2} k_{\\mathrm{B}} T = \\frac{f}{2} k_{\\mathrm{B}} T\n$$\n将此结果代入 $\\langle \\hat{T} \\rangle$ 的表达式中：\n$$\n\\langle \\hat{T} \\rangle = \\frac{2}{f k_{\\mathrm{B}}} \\left( \\frac{f}{2} k_{\\mathrm{B}} T \\right) = T\n$$\n这表明 $\\hat{T}$ 是热力学温度 $T$ 的一个无偏估计量。\n\n接下来，我们计算二阶矩 $\\langle \\hat{T}^2 \\rangle$：\n$$\n\\langle \\hat{T}^2 \\rangle = \\left\\langle \\left( \\frac{2 K}{f k_{\\mathrm{B}}} \\right)^2 \\right\\rangle = \\frac{4}{(f k_{\\mathrm{B}})^2} \\langle K^2 \\rangle\n$$\n我们需要计算 $\\langle K^2 \\rangle$：\n$$\n\\langle K^2 \\rangle = \\left\\langle \\left( \\sum_{i=1}^{f} K_i \\right)^2 \\right\\rangle = \\left\\langle \\sum_{i=1}^{f} K_i^2 + \\sum_{i \\neq j} K_i K_j \\right\\rangle = \\sum_{i=1}^{f} \\langle K_i^2 \\rangle + \\sum_{i \\neq j} \\langle K_i K_j \\rangle\n$$\n联合动量分布是可因子分解的，这意味着动量变量 $p_i$ 是统计独立的。因此，动能项 $K_i = \\frac{p_i^2}{2m_i}$ 也是统计独立的。对于 $i \\neq j$，我们有：\n$$\n\\langle K_i K_j \\rangle = \\langle K_i \\rangle \\langle K_j \\rangle = \\left( \\frac{1}{2} k_{\\mathrm{B}} T \\right) \\left( \\frac{1}{2} k_{\\mathrm{B}} T \\right) = \\frac{1}{4} (k_{\\mathrm{B}} T)^2\n$$\n现在我们必须计算 $\\langle K_i^2 \\rangle$。这需要动量的四阶矩 $\\langle p_i^4 \\rangle$。对于一个均值为 $0$、方差为 $\\sigma^2$ 的一维高斯变量 $x$，其各阶矩为 $\\langle x^2 \\rangle = \\sigma^2$ 和 $\\langle x^4 \\rangle = 3 \\sigma^4$。从分布 $P(p_i) \\propto \\exp(-\\frac{\\beta p_i^2}{2m_i})$ 中，我们可确定 $p_i$ 的方差为 $\\sigma_{p_i}^2 = m_i k_{\\mathrm{B}} T$。\n因此，$p_i$ 的各阶矩为：\n$$\n\\langle p_i^2 \\rangle = m_i k_{\\mathrm{B}} T\n$$\n$$\n\\langle p_i^4 \\rangle = 3 (m_i k_{\\mathrm{B}} T)^2\n$$\n现在我们可以求出 $\\langle K_i^2 \\rangle$：\n$$\n\\langle K_i^2 \\rangle = \\left\\langle \\left( \\frac{p_i^2}{2m_i} \\right)^2 \\right\\rangle = \\frac{1}{4m_i^2} \\langle p_i^4 \\rangle = \\frac{1}{4m_i^2} \\left[ 3 (m_i k_{\\mathrm{B}} T)^2 \\right] = \\frac{3}{4} (k_{\\mathrm{B}} T)^2\n$$\n现在我们将各项组合起来计算 $\\langle K^2 \\rangle$。求和 $\\sum_{i=1}^{f} \\langle K_i^2 \\rangle$ 有 $f$ 个相同的项，而求和 $\\sum_{i \\neq j} \\langle K_i K_j \\rangle$ 有 $f(f-1)$ 个相同的项。\n$$\n\\langle K^2 \\rangle = f \\left[ \\frac{3}{4} (k_{\\mathrm{B}} T)^2 \\right] + f(f-1) \\left[ \\frac{1}{4} (k_{\\mathrm{B}} T)^2 \\right]\n$$\n$$\n\\langle K^2 \\rangle = \\frac{(k_{\\mathrm{B}} T)^2}{4} [3f + f(f-1)] = \\frac{(k_{\\mathrm{B}} T)^2}{4} [3f + f^2 - f] = \\frac{(k_{\\mathrm{B}} T)^2}{4} (f^2 + 2f)\n$$\n将此结果代回 $\\langle \\hat{T}^2 \\rangle$ 的表达式中：\n$$\n\\langle \\hat{T}^2 \\rangle = \\frac{4}{(f k_{\\mathrm{B}})^2} \\langle K^2 \\rangle = \\frac{4}{f^2 k_{\\mathrm{B}}^2} \\left[ \\frac{(k_{\\mathrm{B}} T)^2}{4} (f^2 + 2f) \\right] = \\frac{f^2 + 2f}{f^2} T^2 = \\left( 1 + \\frac{2}{f} \\right) T^2\n$$\n现在我们可以计算 $\\hat{T}$ 的方差：\n$$\n\\operatorname{Var}(\\hat{T}) = \\langle \\hat{T}^2 \\rangle - \\langle \\hat{T} \\rangle^2 = \\left( 1 + \\frac{2}{f} \\right) T^2 - T^2 = \\frac{2}{f} T^2\n$$\n最后，所求的无量纲相对方差为：\n$$\n\\frac{\\operatorname{Var}(\\hat{T})}{T^2} = \\frac{\\frac{2}{f} T^2}{T^2} = \\frac{2}{f}\n$$\n这个结果表明，动能温度估计量的相对涨落与自由度数成反比，这是有限系统统计力学中的一个基本结果。", "answer": "$$\\boxed{\\frac{2}{f}}$$", "id": "2825163"}, {"introduction": "理解了温度的统计性质后，下一步是学习如何设计一个能够有效产生正则系综的恒温器。诺斯-胡佛链（Nosé-Hoover chain, NHC）是一种强大而严谨的方法，但其效率高度依赖于其参数（即“质量”$Q_i$）的选取。此练习将指导你如何基于等能量分配和简谐振动等物理思想，为NHC恒温器选择合适的质量，以确保其在广泛的频率范围内都能实现鲁棒的温度控制 ([@problem_id:2825162])。", "problem": "要求您为在温度 $T$ 下的分子动力学（MD）参数化一个 Nosé–Hoover 链（NHC）恒温器。该链的长度为 $M$，恒温器变量由 $i \\in \\{1,\\dots,M\\}$ 索引，每个变量都有一个恒温器质量 $Q_i$。令 $k_{\\mathrm{B}}$ 表示玻尔兹曼常数。第一个恒温器与具有有效自由度数 $g_1$ 的物理系统耦合，而链中更深层的恒温器作用于前一个恒温器变量，并可视为耦合单个自由度，即对于 $i>1$ 有 $g_i = 1$。\n\n仅从以下基本原理出发：\n- 能量均分原理：在温度 $T$ 的热平衡状态下，每个独立的二次型自由度携带的平均能量为 $\\tfrac{1}{2}k_{\\mathrm{B}}T$。\n- 微振动（谐振）近似：在平衡点附近，一个惯量为 $m$、刚度为 $k$ 的二次型模式以角频率 $\\omega = \\sqrt{k/m}$ 和特征时间 $ \\tau = 1/\\omega$ 振荡。\n\n利用这些原理构建一个选择恒温器质量 $Q_i$ 的程序，使得恒温器链的特征时间 $\\tau_i$ 在对数轴上形成相等的时间尺度间隔，即一个公比为 $r>1$ 的等比数列。然后，说明由此得到的恒温器角频率 $\\omega_i$ 在整个链上的分布。\n\n选择所有正确且自洽地指定了该程序，并正确描述了其对恒温器频率分布影响的选项。每个选项都涉及一个从 $i=1$ 开始索引的链，具有给定的基础时间尺度 $\\tau_1$ 和公比为 $r>1$。\n\nA. 选择 $\\tau_i = \\tau_1 r^{\\,i-1}$ 并设置 $Q_i = g_i\\,k_{\\mathrm{B}}T\\,\\tau_i^2 = g_i\\,k_{\\mathrm{B}}T\\,\\tau_1^2\\,r^{\\,2(i-1)}$。那么 $\\omega_i = 1/\\tau_i = \\omega_1\\,r^{-(i-1)}$，其中 $\\omega_1 = 1/\\tau_1$，因此频率在对数尺度上是等间距的。\n\nB. 选择 $\\tau_i = \\tau_1 r^{\\,i-1}$ 但设置 $Q_i = g_i\\,k_{\\mathrm{B}}T\\,\\tau_1^2\\,r^{-(i-1)}$。那么 $\\omega_i \\propto \\sqrt{Q_i}$，得到 $\\omega_i = \\omega_1\\,r^{-\\tfrac{1}{2}(i-1)}$，这会产生恒温器频率的均等对数间隔。\n\nC. 为所有 $i$ 选择一个恒定的 $Q_i = Q$，使得所有恒温器的时间尺度都相同。这种“扁平”选择通过将恒温器置于相同频率来在整个频谱上产生均匀的阻尼，这对于宽带控制是理想的。\n\nD. 选择 $Q_i = g_i\\,k_{\\mathrm{B}}T\\,\\tau_1^2\\,r^{\\,i-1}$ 以使 $\\omega_i = \\omega_1\\,r^{-\\tfrac{1}{2}(i-1)}$。这实现了相等的时间尺度间隔，因为质量与比率 $r$ 线性相关。\n\nE. 在一个 $M$ 恒温器链中，取 $g_1 = g_{\\mathrm{phys}}$（与第一个恒温器耦合的物理自由度数）和 $g_i=1$（对于 $i>1$），并选择 $\\tau_i = \\tau_1 r^{\\,i-1}$ 及 $Q_i = g_i\\,k_{\\mathrm{B}}T\\,\\tau_i^2$，即 $Q_1 = g_{\\mathrm{phys}}\\,k_{\\mathrm{B}}T\\,\\tau_1^2$ 和 $Q_{i>1} = k_{\\mathrm{B}}T\\,\\tau_1^2\\,r^{\\,2(i-1)}$。这在整个链上保持了一个几何频率分布 $\\omega_i = \\omega_1 r^{-(i-1)}$。\n\n选择所有适用的选项。", "solution": "我们从所述的基本原理推导出恒温器质量和时间尺度之间的映射关系。\n\n根据微振动近似，一个惯量为 $m$、刚度为 $k$ 的二次型模式的角频率为 $\\omega = \\sqrt{k/m}$，特征时间为 $\\tau = 1/\\omega = \\sqrt{m/k}$。在 Nosé–Hoover 链（NHC）中，第 $i$ 层的恒温器变量是一个惯量为 $Q_i$ 的二次型模式。控制其在平衡点附近涨落的“刚度”是由它所调节的自由度的热尺度决定的。根据能量均分原理，每个二次型自由度贡献的平均能量为 $\\tfrac{1}{2}k_{\\mathrm{B}}T$。对于第一个恒温器，它调节有效自由度数为 $g_1$ 的动能，相关的热尺度与 $g_1 k_{\\mathrm{B}}T$ 成正比。对于更深层的恒温器，它们调节单个前驱恒温器变量，通常且一致地取 $g_i = 1$（对于 $i>1$）。\n\n这些考虑导出了一个被广泛使用且量纲一致的映射关系（这是 MD 实践中一个标准且经过充分检验的选择）\n$$\n\\tau_i^2 \\;=\\; \\frac{Q_i}{g_i\\,k_{\\mathrm{B}}T}, \\qquad \\text{等价于} \\qquad Q_i \\;=\\; g_i\\,k_{\\mathrm{B}}T\\,\\tau_i^2,\n$$\n因此恒温器的固有频率为\n$$\n\\omega_i \\;=\\; \\frac{1}{\\tau_i} \\;=\\; \\sqrt{\\frac{g_i\\,k_{\\mathrm{B}}T}{Q_i}}.\n$$\n\n现在，通过选择以下方式，在对数轴上施加相等的时间尺度间隔\n$$\n\\tau_i \\;=\\; \\tau_1\\, r^{\\,i-1}, \\qquad r>1.\n$$\n代入映射关系，得到恒温器质量\n$$\nQ_i \\;=\\; g_i\\,k_{\\mathrm{B}}T\\,\\tau_i^2 \\;=\\; g_i\\,k_{\\mathrm{B}}T\\,\\tau_1^2\\, r^{\\,2(i-1)}.\n$$\n相应的频率为\n$$\n\\omega_i \\;=\\; \\frac{1}{\\tau_i} \\;=\\; \\frac{1}{\\tau_1}\\, r^{-(i-1)} \\;=\\; \\omega_1\\, r^{-(i-1)},\n$$\n因此 $\\{\\omega_i\\}$ 是以公比 $1/r$ 呈几何级数分布的，即在对数频率轴上是等间距的。\n\n我们现在评估每个选项：\n\nA. 该选项指定 $\\tau_i = \\tau_1 r^{\\,i-1}$ 并设置 $Q_i = g_i\\,k_{\\mathrm{B}}T\\,\\tau_i^2 = g_i\\,k_{\\mathrm{B}}T\\,\\tau_1^2\\, r^{\\,2(i-1)}$，并推导出 $\\omega_i = \\omega_1 r^{-(i-1)}$。这与上面的推导相符，并正确地陈述了对数频率间隔。结论 — 正确。\n\nB. 该选项指定 $Q_i = g_i\\,k_{\\mathrm{B}}T\\,\\tau_1^2\\, r^{-(i-1)}$，这与 $\\tau_i = \\tau_1 r^{\\,i-1}$ 时的 $Q_i \\propto \\tau_i^2$ 相矛盾；$r$ 的指数不正确且符号错误。它还断言 $\\omega_i \\propto \\sqrt{Q_i}$，而从 $\\omega_i = 1/\\tau_i$ 和 $\\tau_i^2 = Q_i/(g_i k_{\\mathrm{B}}T)$ 我们得到 $\\omega_i \\propto 1/\\sqrt{Q_i}$，而不是 $\\sqrt{Q_i}$。结论 — 错误。\n\nC. 选择一个恒定的 $Q_i = Q$ 仅当 $g_i$ 也为恒定时，才会产生相同的 $\\tau_i = \\sqrt{Q/(g_i k_{\\mathrm{B}}T)}$；即便如此，所有恒温器将共享相同的特征频率 $\\omega_i$，这不能提供跨频带的覆盖，也无法实现相等的时间尺度间隔。所谓的“在整个频谱上的均匀阻尼”并不能从相同的频率推导出来。结论 — 错误。\n\nD. 该选项使用 $Q_i \\propto r^{\\,i-1}$，这意味着 $\\tau_i \\propto r^{\\tfrac{1}{2}(i-1)}$ 和 $\\omega_i \\propto r^{-\\tfrac{1}{2}(i-1)}$，而不是目标 $\\tau_i \\propto r^{\\,i-1}$。因此，它没有通过 $\\tau_i$ 中公比为 $r$ 的等比数列来实现相等的时间尺度间隔；它将间隔压缩了一个平方根。结论 — 错误。\n\nE. 该选项包含了常规且一致的选择 $g_1 = g_{\\mathrm{phys}}$ 和 $g_i=1$（对于 $i>1$），应用了 $\\tau_i = \\tau_1 r^{\\,i-1}$，并设置了 $Q_i = g_i\\,k_{\\mathrm{B}}T\\,\\tau_i^2$，明确给出了 $Q_1 = g_{\\mathrm{phys}}\\,k_{\\mathrm{B}}T\\,\\tau_1^2$ 和 $Q_{i>1} = k_{\\mathrm{B}}T\\,\\tau_1^2\\,r^{\\,2(i-1)}$。得到的 $\\omega_i = \\omega_1 r^{-(i-1)}$ 与几何频率分布相匹配。这是一个正确且常用的实现细节，与推导出的程序保持一致。结论 — 正确。\n\n因此，正确的选项是 A 和 E。", "answer": "$$\\boxed{AE}$$", "id": "2825162"}, {"introduction": "在配置了合适的恒温器和恒压器进行模拟后，最终目标是计算可靠的系综平均值。然而，由于模拟数据点之间存在时间相关性，直接计算统计误差是不可靠的。本练习将引导你推导如何从一个相关的时间序列中正确估算平均值的统计不确定性，并利用这个理论来确定为达到目标精度所需的模拟时长，这是将模拟结果转化为科学结论的关键一步 ([@problem_id:2825153])。", "problem": "在环境条件下对液态水进行的恒定数量、压强、温度 (NPT) 系综分子动力学模拟中，您打算以预定的统计精度报告平均压强 $\\langle P \\rangle$。考虑一个由采用确定性恒温器和恒压器的模拟所生成的平稳、遍历的压强时间序列 $P(t)$。定义压强涨落为 $\\delta P(t) = P(t) - \\langle P \\rangle$，自协方差函数为 $C_{P}(t) = \\langle \\delta P(0)\\,\\delta P(t) \\rangle$，归一化自相关函数为 $\\rho_{P}(t) = C_{P}(t)/C_{P}(0)$。积分自相关时间在连续时间中定义为\n$$\n\\tau_{\\mathrm{int}} = \\int_{0}^{\\infty} \\rho_{P}(t)\\,dt,\n$$\n假设对于该过程，此积分为有限且良定义的。一次简短的初步运行提供了以下可靠的估计值：瞬时压强涨落的标准差 $\\sigma_{P} = \\sqrt{C_{P}(0)} = 250\\ \\text{bar}$ 和积分自相关时间 $\\tau_{\\mathrm{int}} = 2.5\\ \\text{ps}$。您希望从持续时间为 $T$ 的长生产轨迹计算得出的样本平均压强 $\\overline{P}$ 的标准误差（均方根不确定度）满足 $\\operatorname{SE}[\\overline{P}] = 2.0\\ \\text{bar}$。\n\n仅从时间平均和双时关联函数的基本定义出发，推导相关平稳过程的时间平均方差关于 $C_{P}(t)$ 的大 $T$ 渐近表达式，然后用 $\\sigma_{P}$ 和 $\\tau_{\\mathrm{int}}$ 对其进行重新表述，并最终获得达到目标标准误差所需的最小生产长度 $T$ 的显式表达式。使用此表达式，根据给定的 $\\sigma_{P}$ 和 $\\tau_{\\mathrm{int}}$ 计算所需的 $T$。以 $\\text{ns}$（纳秒）为单位表示最终时间，并将您的答案四舍五入到四位有效数字。", "solution": "所述问题在科学上是合理的、适定的，并包含其求解所需的所有必要信息。它构成了分子模拟时间序列数据统计分析中的一个标准练习。我们开始进行推导和求解。\n\n在持续时间为 $T$ 的生产运行中，压强的样本均值（或时间平均）$\\overline{P}$ 定义为：\n$$\n\\overline{P} = \\frac{1}{T} \\int_{0}^{T} P(t') \\, dt'\n$$\n该样本均值的方差，用于量化其统计不确定性，由 $\\operatorname{Var}[\\overline{P}] = \\langle (\\overline{P} - \\langle \\overline{P} \\rangle)^2 \\rangle$ 给出。对于一个平稳遍历过程，时间平均的系综平均等于瞬时量的系综平均，即 $\\langle \\overline{P} \\rangle = \\langle P \\rangle$。因此，我们可以写出：\n$$\n\\operatorname{Var}[\\overline{P}] = \\left\\langle \\left( \\frac{1}{T} \\int_{0}^{T} P(t') \\, dt' - \\langle P \\rangle \\right)^2 \\right\\rangle\n$$\n使用压强涨落的定义 $\\delta P(t) = P(t) - \\langle P \\rangle$，上式变为：\n$$\n\\operatorname{Var}[\\overline{P}] = \\left\\langle \\left( \\frac{1}{T} \\int_{0}^{T} \\delta P(t') \\, dt' \\right)^2 \\right\\rangle = \\frac{1}{T^2} \\left\\langle \\left( \\int_{0}^{T} \\delta P(t') \\, dt' \\right) \\left( \\int_{0}^{T} \\delta P(t'') \\, dt'' \\right) \\right\\rangle\n$$\n我们可以将系综平均移到积分内部：\n$$\n\\operatorname{Var}[\\overline{P}] = \\frac{1}{T^2} \\int_{0}^{T} dt' \\int_{0}^{T} dt'' \\, \\langle \\delta P(t') \\, \\delta P(t'') \\rangle\n$$\n该过程是平稳的，这意味着双时关联函数仅取决于时间差，而不取决于绝对时间。因此，我们可以写出 $\\langle \\delta P(t') \\, \\delta P(t'') \\rangle = C_{P}(|t' - t''|)$，其中 $C_{P}(t)$ 是自协方差函数。方差的表达式变为：\n$$\n\\operatorname{Var}[\\overline{P}] = \\frac{1}{T^2} \\int_{0}^{T} dt' \\int_{0}^{T} dt'' \\, C_{P}(|t' - t''|)\n$$\n为了计算这个二重积分，我们进行变量替换。令 $\\tau = t' - t''$ 和 $s = t''$。该变换的雅可比行列式为 $1$。在 $(t', t'')$ 平面上的积分区域是由 $0 \\le t' \\le T$ 和 $0 \\le t'' \\le T$ 定义的正方形。在新变量 $(\\tau, s)$ 中，这对应于 $0 \\le s \\le T$ 和 $-s \\le \\tau \\le T-s$。我们可以将积分重写为：\n$$\nI = \\int_{0}^{T} ds \\int_{-s}^{T-s} d\\tau \\, C_{P}(|\\tau|)\n$$\n我们可以交换积分次序。$\\tau$ 的范围是从 $-T$ 到 $T$。对于给定的 $\\tau$，$s$ 的范围是从 $\\max(0, -\\tau)$ 到 $\\min(T, T-s)$。注意，s 的上限来自 $t' = \\tau+s \\le T$，因此 $s \\le T-\\tau$。\n交换次序后正确的积分限为：\n$$\nI = \\int_{-T}^{T} d\\tau \\int_{\\max(0, -\\tau)}^{\\min(T, T-\\tau)} ds \\, C_{P}(|\\tau|)\n$$\n对 $s$ 的内层积分结果是积分区间的长度。\n如果 $\\tau > 0$，区间为 $[0, T-\\tau]$，长度为 $T-\\tau$。\n如果 $\\tau < 0$，区间为 $[-\\tau, T]$，长度为 $T-(-\\tau) = T+\\tau$。\n两种情况下，长度均为 $T-|\\tau|$。因此，积分变为：\n$$\nI = \\int_{-T}^{T} (T - |\\tau|) C_{P}(|\\tau|) \\, d\\tau\n$$\n由于被积函数是 $\\tau$ 的偶函数，我们可以写出：\n$$\nI = 2 \\int_{0}^{T} (T - \\tau) C_{P}(\\tau) \\, d\\tau\n$$\n将此结果代回方差的表达式中，得到精确公式：\n$$\n\\operatorname{Var}[\\overline{P}] = \\frac{2}{T^2} \\int_{0}^{T} (T - \\tau) C_{P}(\\tau) \\, d\\tau = \\frac{2}{T} \\int_{0}^{T} \\left(1 - \\frac{\\tau}{T}\\right) C_{P}(\\tau) \\, d\\tau\n$$\n这是第一个要求的推导。现在我们考虑渐近极限，其中模拟时间 $T$ 远大于相关性的特征衰减时间。在此极限下，对于 $C_P(\\tau)$ 不可忽略的 $\\tau$ 值，我们有 $\\tau \\ll T$，因此因子 $(1 - \\tau/T)$ 近似为 $1$。我们也可以将积分上限扩展到无穷大，因为当 $\\tau$ 很大时被积函数趋于零。这给出了大 $T$ 的渐近表达式：\n$$\n\\operatorname{Var}[\\overline{P}] \\approx \\frac{2}{T} \\int_{0}^{\\infty} C_{P}(\\tau) \\, d\\tau\n$$\n接下来，我们用给定的量 $\\sigma_{P}$ 和 $\\tau_{\\mathrm{int}}$ 来重新表述这个表达式。给定归一化自相关函数 $\\rho_{P}(t) = C_{P}(t)/C_{P}(0)$ 和标准差 $\\sigma_{P} = \\sqrt{C_{P}(0)}$。这意味着 $C_{P}(t) = C_{P}(0)\\rho_{P}(t) = \\sigma_{P}^{2}\\rho_{P}(t)$。将此代入方差表达式中：\n$$\n\\operatorname{Var}[\\overline{P}] \\approx \\frac{2\\sigma_{P}^{2}}{T} \\int_{0}^{\\infty} \\rho_{P}(\\tau) \\, d\\tau\n$$\n使用积分自相关时间的定义 $\\tau_{\\mathrm{int}} = \\int_{0}^{\\infty} \\rho_{P}(t)\\,dt$，我们得到：\n$$\n\\operatorname{Var}[\\overline{P}] \\approx \\frac{2\\sigma_{P}^{2}\\tau_{\\mathrm{int}}}{T}\n$$\n平均值的标准误差 $\\operatorname{SE}[\\overline{P}]$ 是平均值方差的平方根：$\\operatorname{SE}[\\overline{P}] = \\sqrt{\\operatorname{Var}[\\overline{P}]}$。因此：\n$$\n\\operatorname{SE}[\\overline{P}]^2 \\approx \\frac{2\\sigma_{P}^{2}\\tau_{\\mathrm{int}}}{T}\n$$\n对此求解以达到目标标准误差所需的最小生产长度 $T$，得到显式表达式：\n$$\nT \\approx \\frac{2\\sigma_{P}^{2}\\tau_{\\mathrm{int}}}{\\operatorname{SE}[\\overline{P}]^2}\n$$\n现在，我们代入给定的数值：$\\sigma_{P} = 250\\ \\text{bar}$，$\\tau_{\\mathrm{int}} = 2.5\\ \\text{ps}$，以及 $\\operatorname{SE}[\\overline{P}] = 2.0\\ \\text{bar}$。\n$$\nT \\approx \\frac{2 \\times (250)^2 \\times 2.5}{(2.0)^2} \\ \\text{ps}\n$$\n$$\nT \\approx \\frac{2 \\times 62500 \\times 2.5}{4.0} \\ \\text{ps}\n$$\n$$\nT \\approx \\frac{312500}{4.0} \\ \\text{ps} = 78125 \\ \\text{ps}\n$$\n问题要求答案以纳秒（$\\text{ns}$）为单位，其中 $1 \\ \\text{ns} = 1000 \\ \\text{ps}$。\n$$\nT \\approx \\frac{78125}{1000} \\ \\text{ns} = 78.125 \\ \\text{ns}\n$$\n最后，将结果四舍五入到四位有效数字，得到 $78.13 \\ \\text{ns}$。", "answer": "$$\\boxed{78.13}$$", "id": "2825153"}]}