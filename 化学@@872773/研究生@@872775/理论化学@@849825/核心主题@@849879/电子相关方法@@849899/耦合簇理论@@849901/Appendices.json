{"hands_on_practices": [{"introduction": "理解一个像耦合簇理论这样复杂的新理论，一个好方法是看它如何与我们更熟悉的理论联系起来。本练习将非线性的耦合簇方程与广为人知的 Møller-Plesset 微扰理论联系起来。通过推导 MP2 振幅表达式作为 CCSD 方程的最低阶解，我们可以洞察簇振幅的物理内涵，并认识到 CC 框架是微扰理论的一个强大推广。[@problem_id:2766799]", "problem": "考虑一个闭壳层 Hartree–Fock (HF) 参考行列式 $|\\Phi_{0}\\rangle$，它由具有对角 Fock 矩阵的正则自旋轨道构成，因此单电子 Fock 算符满足 $f |\\phi_{p}\\rangle = \\epsilon_{p} |\\phi_{p}\\rangle$，其中轨道能为 $\\epsilon_{p}$。使用 Møller–Plesset 划分将电子哈密顿量 $\\hat{H}$ 分解为一个零阶 Fock 部分和一个微扰势，并将相对于 $|\\Phi_{0}\\rangle$ 的正规排序哈密顿量写作 $\\hat{H}_{N} = \\hat{F}_{N} + \\hat{V}_{N}$。在包含簇算符 $\\hat{T}$ 的耦合簇 (CC) 理论中，通过将相似变换后的哈密顿量 $\\bar{H} = \\exp(-\\hat{T}) \\hat{H}_{N} \\exp(\\hat{T})$ 投影到激发行列式上，可以得到振幅方程。关注耦合簇双激发 (CCD) 或耦合簇单双激发 (CCSD) 中的双激发部分，并假设使用正则 HF 轨道，因此根据 Brillouin 定理，单激发在最低非零阶上没有贡献。\n\n从投影的双激发振幅方程 $0 = \\langle \\Phi_{ij}^{ab} | \\bar{H} | \\Phi_{0} \\rangle$ 出发，其中指标 $i,j$ 表示占据轨道，$a,b$ 表示虚轨道，推导双激发振幅 $t_{ij}^{ab}$ 关于反对称化双电子积分和轨道能的最低阶（以微扰势为准）解析表达式。明确说明您所使用的 Baker–Campbell–Hausdorff 展开的任何截断，并通过微扰理论阶数分析来证明其合理性。将反对称化双电子积分定义为 $\\bar{v}_{ij}^{ab} = \\langle ij \\Vert ab \\rangle$，并以 $\\bar{v}_{ij}^{ab}$ 和集合 $\\{\\epsilon_{p}\\}$ 的形式，为 $t_{ij}^{ab}$ 提供一个单一的闭合形式解析表达式作为您的最终结果。\n\n你的最终答案必须是单个闭合形式的解析表达式。不包含单位。无需进行数值计算或四舍五入。", "solution": "该问题要求从投影的耦合簇方程出发，推导耦合簇双激发振幅 $t_{ij}^{ab}$ 的最低阶表达式。分析将通过援引哈密顿量的 Møller–Plesset (MP) 划分并应用微扰理论阶数分析来进行。\n\n电子哈密顿量 $\\hat{H}$ 被划分为一个零阶 Fock 算符 $\\hat{F}_0$ 和一个一阶微扰势 $\\hat{V}$。在相对于 Hartree-Fock 参考行列式 $|\\Phi_0\\rangle$ 的正规排序形式中，哈密顿量为 $\\hat{H}_N = \\hat{F}_N + \\hat{V}_N$。这里，$\\hat{F}_N$ 是零阶的，$\\hat{V}_N$ 在微扰中是一阶的。耦合簇 (CC) 波函数由 $|\\Psi_{CC}\\rangle = \\exp(\\hat{T})|\\Phi_0\\rangle$ 给出，其中簇算符为 $\\hat{T} = \\hat{T}_1 + \\hat{T}_2 + \\dots$。对于此问题，我们考虑耦合簇双激发 (CCD) 或单双激发 (CCSD)，因此 $\\hat{T} \\approx \\hat{T}_1 + \\hat{T}_2$。\n\n簇算符双激发部分 $\\hat{T}_2 = \\frac{1}{4} \\sum_{ijab} t_{ij}^{ab} a^\\dagger_a a^\\dagger_b a_j a_i$ 的振幅是通过将相似变换后的薛定谔方程投影到双激发行列式 $|\\Phi_{ij}^{ab}\\rangle = a^\\dagger_a a^\\dagger_b a_j a_i |\\Phi_0\\rangle$ 的空间上来确定的。这会得到振幅方程：\n$$\n0 = \\langle \\Phi_{ij}^{ab} | \\bar{H} | \\Phi_0 \\rangle\n$$\n其中 $\\bar{H} = \\exp(-\\hat{T}) \\hat{H}_N \\exp(\\hat{T})$。\n\n为了找到 $t_{ij}^{ab}$ 的最低阶表达式，我们使用 Baker–Campbell–Hausdorff (BCH) 公式展开 $\\bar{H}$：\n$$\n\\bar{H} = \\hat{H}_N + [\\hat{H}_N, \\hat{T}] + \\frac{1}{2}[[\\hat{H}_N, \\hat{T}], \\hat{T}] + \\dots\n$$\n将此代入振幅方程得到：\n$$\n0 = \\langle \\Phi_{ij}^{ab} | \\hat{H}_N + [\\hat{H}_N, \\hat{T}] + \\frac{1}{2}[[\\hat{H}_N, \\hat{T}], \\hat{T}] + \\dots | \\Phi_0 \\rangle\n$$\n我们现在基于 MP 划分进行阶数分析。算符和振幅在微扰势中被赋予一个阶数：\n- 正规排序 Fock 算符 $\\hat{F}_N$ 是零阶的，$O(0)$。\n- 正规排序微扰势 $\\hat{V}_N$ 是一阶的，$O(1)$。\n- 因此，$\\hat{H}_N = \\hat{F}_N^{(0)} + \\hat{V}_N^{(1)}$。\n- 簇振幅进行微扰展开：$\\hat{T} = \\hat{T}^{(1)} + \\hat{T}^{(2)} + \\dots$。\n\n对于正则 Hartree-Fock 轨道，Brillouin 定理指出，完整哈密顿量在 HF 行列式和单激发行列式之间的矩阵元为零。这意味着一阶单激发振幅 $t_i^{a(1)}$ 为零。因此，$\\hat{T}_1$ 仅在二阶及更高阶有贡献，即 $\\hat{T}_1 \\sim O(2)$。然而，双激发振幅具有一阶贡献，因此 $\\hat{T}_2 = \\hat{T}_2^{(1)} + \\hat{T}_2^{(2)} + \\dots$，其中 $\\hat{T}_2^{(1)} \\sim O(1)$。\n\n为了找到 $t_{ij}^{ab}$ 的最低阶（一阶）表达式，我们需要收集展开的振幅方程中所有一阶的项。\n\n1.  **第一项：$\\langle \\Phi_{ij}^{ab} | \\hat{H}_N | \\Phi_0 \\rangle$**\n    由于 $\\hat{H}_N = \\hat{F}_N^{(0)} + \\hat{V}_N^{(1)}$，我们有 $\\langle \\Phi_{ij}^{ab} | \\hat{F}_N^{(0)} | \\Phi_0 \\rangle + \\langle \\Phi_{ij}^{ab} | \\hat{V}_N^{(1)} | \\Phi_0 \\rangle$。\n    算符 $\\hat{F}_N$ 是一个单体算符，不能将参考态 $|\\Phi_0\\rangle$ 连接到双激发行列式 $|\\Phi_{ij}^{ab}\\rangle$。因此，$\\langle \\Phi_{ij}^{ab} | \\hat{F}_N | \\Phi_0 \\rangle = 0$。\n    项 $\\langle \\Phi_{ij}^{ab} | \\hat{V}_N | \\Phi_0 \\rangle$ 涉及双体微扰势，它可以直接将参考态耦合到双激发态。根据定义，该矩阵元是反对称化双电子积分 $\\bar{v}_{ij}^{ab} = \\langle ij \\Vert ab \\rangle$。此项是一阶的。\n    $$\n    \\langle \\Phi_{ij}^{ab} | \\hat{H}_N | \\Phi_0 \\rangle = \\bar{v}_{ij}^{ab}\n    $$\n\n2.  **第二项：$\\langle \\Phi_{ij}^{ab} | [\\hat{H}_N, \\hat{T}] | \\Phi_0 \\rangle$**\n    我们将其展开为 $\\langle \\Phi_{ij}^{ab} | [\\hat{F}_N^{(0)} + \\hat{V}_N^{(1)}, \\hat{T}_1 + \\hat{T}_2] | \\Phi_0 \\rangle$。\n    为了获得一阶贡献，我们必须将 $\\hat{H}_N$ 的零阶部分与 $\\hat{T}$ 的一阶部分结合起来。如前所述，$\\hat{T}_1^{(1)}=0$，所以我们只考虑 $\\hat{T}_2^{(1)}$。相关项是 $\\langle \\Phi_{ij}^{ab} | [\\hat{F}_N^{(0)}, \\hat{T}_2^{(1)}] | \\Phi_0 \\rangle$。\n    对易子对参考态的作用是：\n    $$\n    [\\hat{F}_N, \\hat{T}_2]|\\Phi_0\\rangle = \\hat{F}_N \\hat{T}_2 |\\Phi_0\\rangle - \\hat{T}_2 \\hat{F}_N |\\Phi_0\\rangle\n    $$\n    正规排序的 Fock 算符湮灭参考真空，$\\hat{F}_N |\\Phi_0\\rangle = 0$。所以第二项消失了。\n    第一项是 $\\hat{F}_N \\hat{T}_2 |\\Phi_0\\rangle$。算符 $\\hat{T}_2$ 作用于参考态，产生双激发行列式的线性组合：$\\hat{T}_2|\\Phi_0\\rangle = \\frac{1}{4} \\sum_{klcd} t_{kl}^{cd} |\\Phi_{kl}^{cd}\\rangle$。\n    对于正则轨道，激发行列式是 $\\hat{F}_N$ 的本征态：\n    $$\n    \\hat{F}_N |\\Phi_{kl}^{cd}\\rangle = (\\epsilon_c + \\epsilon_d - \\epsilon_k - \\epsilon_l) |\\Phi_{kl}^{cd}\\rangle\n    $$\n    因此，矩阵元变为：\n    $$\n    \\langle \\Phi_{ij}^{ab} | \\hat{F}_N \\hat{T}_2 | \\Phi_0 \\rangle = \\frac{1}{4} \\sum_{klcd} t_{kl}^{cd} (\\epsilon_c + \\epsilon_d - \\epsilon_k - \\epsilon_l) \\langle \\Phi_{ij}^{ab} | \\Phi_{kl}^{cd} \\rangle\n    $$\n    由于行列式的正交性，求和中唯一保留下来的项是 $(k,l)$ 是 $(i,j)$ 的一个排列且 $(c,d)$ 是 $(a,b)$ 的一个排列的项。在考虑了振幅和行列式的反对称性后，此表达式简化为：\n    $$\n    \\langle \\Phi_{ij}^{ab} | [\\hat{F}_N, \\hat{T}_2^{(1)}] | \\Phi_0 \\rangle = t_{ij}^{ab(1)} (\\epsilon_a + \\epsilon_b - \\epsilon_i - \\epsilon_j)\n    $$\n    此项是一阶的（$O(0) \\times O(1)$）。\n\n3.  **更高阶项**\n    BCH 展开中的所有其他项都是二阶或更高阶的。例如：\n    - $\\langle \\Phi_{ij}^{ab} | [\\hat{V}_N^{(1)}, \\hat{T}^{(1)}] | \\Phi_0 \\rangle$ 是二阶的。\n    - $\\langle \\Phi_{ij}^{ab} | [[\\hat{F}_N^{(0)}, \\hat{T}^{(1)}], \\hat{T}^{(1)}] | \\Phi_0 \\rangle$ 是二阶的。\n    在最低阶推导中，这些项可以合理地被忽略。因此，对于一阶微扰分析，将 BCH 展开在第一个对易子项（加上裸哈密顿量）之后截断是合理的。\n\n**组合最低阶方程**\n收集所有一阶项，双激发振幅方程变为：\n$$\n0 = \\bar{v}_{ij}^{ab} + t_{ij}^{ab(1)} (\\epsilon_a + \\epsilon_b - \\epsilon_i - \\epsilon_j)\n$$\n求解一阶双激发振幅 $t_{ij}^{ab(1)}$ 得到：\n$$\nt_{ij}^{ab(1)} (\\epsilon_i + \\epsilon_j - \\epsilon_a - \\epsilon_b) = \\bar{v}_{ij}^{ab}\n$$\n$$\nt_{ij}^{ab(1)} = \\frac{\\bar{v}_{ij}^{ab}}{\\epsilon_i + \\epsilon_j - \\epsilon_a - \\epsilon_b}\n$$\n该表达式是双激发振幅 $t_{ij}^{ab}$ 的最低阶近似，并且与二阶 Møller-Plesset 微扰理论 (MP2) 中双激发振幅的表达式相同。", "answer": "$$\n\\boxed{\\frac{\\bar{v}_{ij}^{ab}}{\\epsilon_{i} + \\epsilon_{j} - \\epsilon_{a} - \\epsilon_{b}}}\n$$", "id": "2766799"}, {"introduction": "在建立了与微扰理论的联系之后，我们现在来探索耦合簇 ansatz 完整的、非微扰的力量。本问题研究一个最小的双电子体系，这个场景足够简单，可以进行精确的解析求解，但又足够丰富，足以揭示该理论的关键特征。通过证明 CCSD 在此系统中提供了精确的能量，等同于完全组态相互作用 (FCI) 的计算结果，您将亲眼看到指数算符如何隐含地将相关效应求和至无穷阶。[@problem_id:2766789]", "problem": "考虑一个闭壳层双电子体系，该体系在一个正则限制性Hartree–Fock (RHF) 自旋轨道基中描述，其中恰好有一个双占据空间轨道 $i$ 和一个虚拟空间轨道 $a$。令 $|\\Phi_{0}\\rangle$ 表示 RHF 参考行列式（两个电子以相反自旋占据轨道 $i$），并令唯一的双激发行列式为 $|\\Phi_{2}\\rangle \\equiv |\\Phi_{i i}^{a a}\\rangle$（两个电子均以相反自旋被激发到轨道 $a$）。在二次量子化形式下使用电子哈密顿量 $\\hat{H}$，并定义矩阵元 $H_{00} \\equiv \\langle \\Phi_{0}|\\hat{H}|\\Phi_{0}\\rangle$，$H_{22} \\equiv \\langle \\Phi_{2}|\\hat{H}|\\Phi_{2}\\rangle$ 和 $H_{20} \\equiv \\langle \\Phi_{2}|\\hat{H}|\\Phi_{0}\\rangle = \\langle \\Phi_{0}|\\hat{H}|\\Phi_{2}\\rangle$。\n\n从耦合簇拟设 $|\\Psi\\rangle = \\exp(\\hat{T})|\\Phi_{0}\\rangle$ 出发，其中簇算符为 $\\hat{T} = \\hat{T}_{1} + \\hat{T}_{2}$，按以下步骤进行：\n\n- 仅使用耦合簇理论的基本定义（指数拟设、相似变换哈密顿量 $\\bar{H} \\equiv \\exp(-\\hat{T}) \\hat{H} \\exp(\\hat{T})$ 和投影方程）以及正则RHF的性质。从第一性原理出发，推导在该体系中单激发振幅为零，即 $\\hat{T}_{1} = 0$，并且只有一个独立的双激发振幅存在，即 $t \\equiv t_{i\\alpha\\, i\\beta}^{a\\alpha\\, a\\beta}$。\n\n- 利用此双行列式子空间的有限维结构和 Baker–Campbell–Hausdorff 展开，证明对于该体系，Baker–Campbell–Hausdorff 级数精确地截断于双重对易子，并从投影振幅条件 $\\langle \\Phi_{2}| \\bar{H} |\\Phi_{0}\\rangle = 0$ 中得到关于 $t$ 的一个闭合的Riccati型方程。\n\n- 从 $E = \\langle \\Phi_{0}| \\bar{H} |\\Phi_{0}\\rangle$ 推导包含单激发和双激发的耦合簇 (CCSD) 能量，用 $t$ 和上面定义的哈密顿量矩阵元表示。\n\n- 通过与 $\\{|\\Phi_{0}\\rangle, |\\Phi_{2}\\rangle\\}$ 基中的全组态相互作用 (FCI) 久期问题进行直接比较，证明 CCSD 能量与该双电子体系的精确 FCI 基态能量一致。\n\n你的最终答案必须是仅用 $H_{00}$、$H_{22}$ 和 $H_{20}$ 表示的精确关联基态能量 $E$ 的单一闭合形式解析表达式。不要包含单位，最终答案不要提供不等式或方程；请提供一个单一的表达式。无需进行数值计算。", "solution": "问题陈述是理论化学中一个提法恰当且有科学依据的练习。它要求对一个最小的双电子、双轨道模型体系，进行包含单激发和双激发的耦合簇 (CCSD) 能量的第一性原理推导，并与精确的全组态相互作用 (FCI) 结果进行比较。所有提供的信息都是自洽、一致的，并遵循量子力学和多体理论的既定原理。该问题是有效的。\n\n我们首先分析希尔伯特空间的结构和簇算符 $\\hat{T} = \\hat{T}_1 + \\hat{T}_2$。该体系包含两个电子，处于一个限制性Hartree-Fock (RHF) 基态行列式 $|\\Phi_0\\rangle = |i\\alpha, i\\beta\\rangle$ 中，其中 $i$ 是唯一的占据空间轨道。唯一可用的虚拟空间轨道是 $a$。\n\n精确波函数，即 FCI 波函数 $|\\Psi_{\\text{FCI}}\\rangle$，必须是哈密顿量 $\\hat{H}$ 和总自旋算符 $\\hat{S}^2$ 的本征函数。由于我们从一个闭壳层单重态 RHF 行列式出发，且哈密顿量与自旋无关，因此基态必须是单重态。可能的激发行列式有单激发和双激发两种。\n诸如 $|\\Phi_{i\\alpha}^{a\\alpha}\\rangle$ 的单激发行列式必须组合起来形成自旋匹配组态。单重态的单激发组态为 ${}^1|\\Phi_{i}^{a}\\rangle = \\frac{1}{\\sqrt{2}}(|\\Phi_{i\\alpha}^{a\\alpha}\\rangle + |\\Phi_{i\\beta}^{a\\beta}\\rangle)$。根据 Brillouin's theorem，对于正则 RHF 轨道，哈密顿量不将参考行列式与单激发行列式耦合：$\\langle {}^1\\Phi_{i}^{a} | \\hat{H} | \\Phi_0 \\rangle = 0$。\n唯一可能的双激发行列式是 $|\\Phi_2\\rangle \\equiv |\\Phi_{ii}^{aa}\\rangle = |a\\alpha, a\\beta\\rangle$，它本身已经是单重态。该行列式通过哈密顿量的双电子部分与参考行列式耦合，因此通常情况下 $\\langle \\Phi_2 | \\hat{H} | \\Phi_0 \\rangle = H_{20} \\neq 0$。没有其他激发是可能的。因此，FCI 空间仅由 $\\{|\\Phi_0\\rangle, |\\Phi_2\\rangle\\}$ 张成，精确的基态波函数形式为 $|\\Psi_{\\text{FCI}}\\rangle = c_0 |\\Phi_0\\rangle + c_2 |\\Phi_2\\rangle$。\n\n耦合簇拟设为 $|\\Psi_{\\text{CC}}\\rangle = \\exp(\\hat{T})|\\Phi_0\\rangle$。将其展开得到：\n$$|\\Psi_{\\text{CC}}\\rangle = (1 + \\hat{T}_1 + \\hat{T}_2 + \\frac{1}{2}\\hat{T}_1^2 + \\dots)|\\Phi_0\\rangle = |\\Phi_0\\rangle + \\hat{T}_1|\\Phi_0\\rangle + \\hat{T}_2|\\Phi_0\\rangle + \\dots$$\n算符 $\\hat{T}_1$ 生成单激发行列式的线性组合。由于这些行列式在精确波函数 $|\\Psi_{\\text{FCI}}\\rangle$ 中不存在，因此它们在 $|\\Psi_{\\text{CC}}\\rangle$ 展开式中的系数必须为零。这要求 $\\hat{T}_1|\\Phi_0\\rangle = 0$，这意味着所有单激发振幅都为零。因此，$\\hat{T}_1 = 0$。\n算符 $\\hat{T}_2$ 生成双激发行列式。在该体系中，只可能发生一种这样的激发，即从轨道对 $(i,i)$ 到 $(a,a)$。我们将其振幅定义为 $t$。相应的算符为 $\\hat{T}_2 = t \\, a_{a\\alpha}^\\dagger a_{a\\beta}^\\dagger a_{i\\beta} a_{i\\alpha}$。根据此定义，$\\hat{T}_2|\\Phi_0\\rangle = t|\\Phi_2\\rangle$。这样我们就证明了要求的第一个要点。\n\n接下来，我们分析相似变换哈密顿量 $\\bar{H} = \\exp(-\\hat{T})\\hat{H}\\exp(\\hat{T})$ 的 Baker-Campbell-Hausdorff (BCH) 展开。当 $\\hat{T}=\\hat{T}_2$ 时，即为 $\\bar{H} = \\exp(-\\hat{T}_2)\\hat{H}\\exp(\\hat{T}_2)$。对于此体系的关键洞见在于算符 $\\hat{T}_2$ 的平方为零。算符 $a_{i\\alpha}$ 湮灭自旋轨道 $i\\alpha$ 上的一个电子。如果我们连续作用两次 $\\hat{T}_2$，第二次作用将涉及产生算符 $a_{a\\alpha}^\\dagger, a_{a\\beta}^\\dagger$ 作用于一个这些轨道已经被占据的态（即 $|\\Phi_2\\rangle$），根据泡利不相容原理，结果为零。更形式化地，$\\hat{T}_2 = t \\hat{A}$，其中 $\\hat{A} = a_{a\\alpha}^\\dagger a_{a\\beta}^\\dagger a_{i\\beta} a_{i\\alpha}$。由于只有一个虚拟空间轨道 $a$，$(\\hat{A})^2 = 0$。因此，算符 $\\hat{T}_2$ 是 2 阶幂零的：$\\hat{T}_2^2 = 0$。\n这立即截断了指数函数的泰勒级数：$\\exp(\\hat{T}_2) = 1 + \\hat{T}_2$。\nBCH 级数为 $\\bar{H} = \\hat{H} + [\\hat{H}, \\hat{T}_2] + \\frac{1}{2}[[\\hat{H}, \\hat{T}_2], \\hat{T}_2] + \\frac{1}{6}[[[\\hat{H}, \\hat{T}_2], \\hat{T}_2], \\hat{T}_2] + \\dots$。\n让我们计算对易子：\n$[[\\hat{H}, \\hat{T}_2], \\hat{T}_2] = [\\hat{H}\\hat{T}_2 - \\hat{T}_2\\hat{H}, \\hat{T}_2] = \\hat{H}\\hat{T}_2^2 - \\hat{T}_2\\hat{H}\\hat{T}_2 - \\hat{T}_2\\hat{H}\\hat{T}_2 + \\hat{T}_2^2\\hat{H} = -2\\hat{T}_2\\hat{H}\\hat{T}_2$ (因为 $\\hat{T}_2^2=0$)。\n三重对易子是 $[[[\\hat{H}, \\hat{T}_2], \\hat{T}_2], \\hat{T}_2] = [-2\\hat{T}_2\\hat{H}\\hat{T}_2, \\hat{T}_2] = -2(\\hat{T}_2\\hat{H}\\hat{T}_2^2 - \\hat{T}_2^2\\hat{H}\\hat{T}_2) = 0$。\n所有更高阶的对易子也为零。因此，BCH 级数精确地终止于双重对易子：\n$\\bar{H} = \\hat{H} + [\\hat{H}, \\hat{T}_2] - \\hat{T}_2\\hat{H}\\hat{T}_2$。\n或者，$\\bar{H} = (1-\\hat{T}_2)\\hat{H}(1+\\hat{T}_2) = \\hat{H} + \\hat{H}\\hat{T}_2 - \\hat{T}_2\\hat{H} - \\hat{T}_2\\hat{H}\\hat{T}_2$。\n\n现在，我们从投影薛定谔方程 $\\langle \\Phi_2 | \\bar{H} | \\Phi_0 \\rangle = 0$ 推导振幅 $t$ 的方程。\n$$ \\langle \\Phi_2 | (\\hat{H} + \\hat{H}\\hat{T}_2 - \\hat{T}_2\\hat{H} - \\hat{T}_2\\hat{H}\\hat{T}_2) | \\Phi_0 \\rangle = 0 $$\n我们计算每一项：\n1. $\\langle \\Phi_2 | \\hat{H} | \\Phi_0 \\rangle = H_{20}$。\n2. $\\langle \\Phi_2 | \\hat{H}\\hat{T}_2 | \\Phi_0 \\rangle = \\langle \\Phi_2 | \\hat{H} (t|\\Phi_2\\rangle) = t \\langle \\Phi_2 | \\hat{H} | \\Phi_2 \\rangle = t H_{22}$。\n3. $\\langle \\Phi_2 | \\hat{T}_2\\hat{H} | \\Phi_0 \\rangle = ( \\langle \\Phi_0 | \\hat{H}^\\dagger \\hat{T}_2^\\dagger | \\Phi_2 \\rangle )^*$。在 $\\hat{H}$ 为厄米且矩阵元为实数的情况下，此项为 $\\langle \\Phi_0 | \\hat{H} \\hat{T}_2^\\dagger | \\Phi_2 \\rangle$。算符 $\\hat{T}_2^\\dagger = t^* a_{i\\alpha}^\\dagger a_{i\\beta}^\\dagger a_{a\\beta} a_{a\\alpha}$。作用于 $|\\Phi_2\\rangle = a_{a\\alpha}^\\dagger a_{a\\beta}^\\dagger |\\text{vac}\\rangle$ 得到 $\\hat{T}_2^\\dagger |\\Phi_2\\rangle = t^* |\\Phi_0\\rangle$。假设 $t$ 为实数，则结果为 $t|\\Phi_0\\rangle$。该项变为 $\\langle \\Phi_0 | \\hat{H} (t|\\Phi_0\\rangle) = t \\langle \\Phi_0 | \\hat{H} | \\Phi_0 \\rangle = t H_{00}$。\n4. $\\langle \\Phi_2 | \\hat{T}_2\\hat{H}\\hat{T}_2 | \\Phi_0 \\rangle = \\langle \\Phi_2 | \\hat{T}_2\\hat{H} (t|\\Phi_2\\rangle) = t ( \\langle \\Phi_2 | \\hat{T}_2\\hat{H} |\\Phi_2\\rangle )$。使用相同的伴随算符技巧，$\\langle \\Phi_2 | \\hat{T}_2\\hat{H} |\\Phi_2\\rangle = (\\langle \\Phi_2 | \\hat{H}^\\dagger \\hat{T}_2^\\dagger |\\Phi_2\\rangle)^* = ( \\langle \\Phi_2 | \\hat{H} (t|\\Phi_0\\rangle) )^* = t H_{20}$。整个项是 $t(t H_{20}) = t^2 H_{20}$。\n\n综合这些结果，振幅 $t$ 的方程为：\n$H_{20} + t H_{22} - t H_{00} - t^2 H_{20} = 0$，这是一个Riccati型方程：$H_{20}(1 - t^2) + t(H_{22} - H_{00}) = 0$。\n\nCCSD 能量为 $E = \\langle \\Phi_0 | \\bar{H} | \\Phi_0 \\rangle$。\n$$ E = \\langle \\Phi_0 | (\\hat{H} + \\hat{H}\\hat{T}_2 - \\hat{T}_2\\hat{H} - \\hat{T}_2\\hat{H}\\hat{T}_2) | \\Phi_0 \\rangle $$\n我们计算每一项对能量的贡献：\n1. $\\langle \\Phi_0 | \\hat{H} | \\Phi_0 \\rangle = H_{00}$。\n2. $\\langle \\Phi_0 | \\hat{H}\\hat{T}_2 | \\Phi_0 \\rangle = \\langle \\Phi_0 | \\hat{H} (t|\\Phi_2\\rangle) = t \\langle \\Phi_0 | \\hat{H} | \\Phi_2 \\rangle = t H_{02} = t H_{20}$。\n3. $\\langle \\Phi_0 | \\hat{T}_2\\hat{H} | \\Phi_0 \\rangle = 0$ 因为 $\\langle \\Phi_0 | \\hat{T}_2 = (\\hat{T}_2^\\dagger |\\Phi_0\\rangle)^\\dagger = 0$，这是由于 $\\hat{T}_2^\\dagger$ 包含对虚拟轨道的湮灭算符，而 $|\\Phi_0\\rangle$ 中不存在这些轨道。\n4. $\\langle \\Phi_0 | \\hat{T}_2\\hat{H}\\hat{T}_2 | \\Phi_0 \\rangle = 0$ 出于同样的原因。\n因此 CCSD 能量为 $E = H_{00} + t H_{20}$。\n\n为了找到能量的显式形式，我们求解关于 $t$ 的二次方程：$H_{20} t^2 - (H_{22} - H_{00})t - H_{20} = 0$。\n方程的解为 $t = \\frac{(H_{22} - H_{00}) \\pm \\sqrt{(H_{22} - H_{00})^2 + 4H_{20}^2}}{2H_{20}}$。为了使振幅 $t$ 在相互作用 $H_{20}$ 趋于零时也趋于零，我们必须选择负号。\n$$ t = \\frac{H_{22} - H_{00} - \\sqrt{(H_{22} - H_{00})^2 + 4H_{20}^2}}{2H_{20}} $$\n将此代入能量表达式：\n$$ E = H_{00} + \\left( \\frac{H_{22} - H_{00} - \\sqrt{(H_{22} - H_{00})^2 + 4H_{20}^2}}{2H_{20}} \\right) H_{20} $$\n$$ E = H_{00} + \\frac{H_{22} - H_{00} - \\sqrt{(H_{22} - H_{00})^2 + 4H_{20}^2}}{2} $$\n$$ E = \\frac{2H_{00} + H_{22} - H_{00} - \\sqrt{(H_{22} - H_{00})^2 + 4H_{20}^2}}{2} $$\n$$ E = \\frac{H_{00} + H_{22} - \\sqrt{(H_{22} - H_{00})^2 + 4H_{20}^2}}{2} $$\n\n最后，我们将此结果与 FCI 结果进行比较。在 $\\{|\\Phi_0\\rangle, |\\Phi_2\\rangle\\}$ 基中，FCI 哈密顿量是一个 $2 \\times 2$ 矩阵 $\\mathbf{H} = \\begin{pmatrix} H_{00} & H_{20} \\\\ H_{20} & H_{22} \\end{pmatrix}$。其本征值 $\\lambda$ 可通过久期方程 $\\det(\\mathbf{H} - \\lambda\\mathbf{I}) = 0$ 求得，即 $(H_{00} - \\lambda)(H_{22} - \\lambda) - H_{20}^2 = 0$。基态能量是较小的那个本征值：\n$$ E_{\\text{FCI}} = \\frac{H_{00} + H_{22} - \\sqrt{(H_{00} + H_{22})^2 - 4(H_{00}H_{22} - H_{20}^2)}}{2} $$\n$$ E_{\\text{FCI}} = \\frac{H_{00} + H_{22} - \\sqrt{(H_{22} - H_{00})^2 + 4H_{20}^2}}{2} $$\n该结果与我们推导出的 CCSD 能量完全相同。这证实了 CCSD (以及 CCD) 对于任何双电子体系都是精确的。最终的表达式就是精确的关联基态能量。", "answer": "$$\n\\boxed{\\frac{H_{00} + H_{22} - \\sqrt{(H_{22} - H_{00})^{2} + 4H_{20}^{2}}}{2}}\n$$", "id": "2766789"}, {"introduction": "虽然耦合簇理论为获得高精度结果提供了一条途径，但其实际应用取决于其计算可行性。最后一个练习将我们的焦点从形式理论转移到真实 CCSD 计算的算法复杂性和成本上。通过分析计算量如何随系统大小而扩展，并了解如何通过引入中间体来显著降低成本，您将对 CC 方法为何在某些情况下被誉为“黄金标准”而在另一些情况下却昂贵得令人望而却步有一个基本的理解。[@problem_id:2766796]", "problem": "考虑在正则哈特里-福克分子轨道基下，一个闭壳层体系的自旋轨道耦合簇单双激发 (CCSD) 方程。令 $N_o$ 表示占据轨道的数量，$N_v$ 表示虚拟轨道的数量。下标 $i,j,k,l$ 标记占据轨道（维度为 $N_o$），下标 $a,b,c,d$ 标记虚拟轨道（维度为 $N_v$）。令 $t_{i}^{a}$ 和 $t_{ij}^{ab}$ 分别表示单激发和双激发振幅，令 $v_{pq}^{rs} \\equiv \\langle pr \\| qs \\rangle$ 表示反对称化的双电子积分。关注双激发振幅的更新，它由“双电子积分与振幅缩并”这种一般形式的张量缩并构成。在整个过程中，在指标循环基数的层面上计算浮点乘加运算次数；忽略常数因子和低阶项，并假设除了代数中已编码的反对称性外，循环范围没有利用其他对称性。\n\n1) 从 CCSD 双激发残差的基本张量缩并结构出发，分析以下对双激发更新 $r_{ij}^{ab}$ 有代表性的贡献项的朴素计算代价（以关于 $N_o$ 和 $N_v$ 的大-$\\mathcal{O}$标度表示）：\n- 粒子-粒子梯形缩并：$r_{ij}^{ab} \\leftarrow \\sum_{cd} v_{ab}^{cd} \\, t_{ij}^{cd}$。\n- 空穴-空穴梯形缩并：$r_{ij}^{ab} \\leftarrow \\sum_{kl} v_{kl}^{ij} \\, t_{kl}^{ab}$。\n- 环形/粒子-空穴缩并：$r_{ij}^{ab} \\leftarrow \\sum_{kc} v_{kb}^{ic} \\, t_{jk}^{ac}$，及其指标置换的对应项。\n\n对于每一项，通过显式地列举外部（自由指标）循环和内部（缩并指标）循环的大小，然后将这些基数相乘，来推导其渐近运算计数。\n\n2) 众所周知，通过引入中间体（例如，通过形成粒子-空穴中间体和福克修饰的对象），可以重组双激发更新的直接逐项计算，使得没有任何张量缩并的渐近代价会超过粒子-粒子梯形缩并或粒子-空穴（环形）缩并的代价。在渐近指标循环计数的层面上，展示如何通过对项进行分组和引入中间体来：\n- 保持粒子-粒子梯形贡献项的代价为 $\\mathcal{O}(N_o^2 N_v^4)$，并且\n- 将任何朴素的 $\\mathcal{O}(N_o^4 N_v^2)$ 贡献项减少为主要代价为 $\\mathcal{O}(N_o^3 N_v^3)$ 的缩并，\n从而使优化的 CCSD 振幅构建的总体主要代价为 $\\mathcal{O}(N_o^2 N_v^4)$ 和 $\\mathcal{O}(N_o^3 N_v^3)$。\n\n你的推理必须从基于指标维度的张量缩并代价定义和 CCSD 双激发残差的结构开始；不要在一开始就假设目标标度。\n\n3) 对于一个具有 $N_o = 28$ 和 $N_v = 220$ 的体系，假设朴素的空穴-空穴梯形路径和基于中间体的重组路径具有相同的前置常数，计算比率\n$$\nR \\equiv \\frac{\\text{朴素空穴-空穴梯形代价}}{\\text{基于中间体的重组代价}} \\, ,\n$$\n即比较 $\\mathcal{O}(N_o^4 N_v^2)$ 与 $\\mathcal{O}(N_o^3 N_v^3)$。将 R 的最终数值四舍五入到四位有效数字。将 R 表示为无单位的纯数。", "solution": "对问题陈述进行验证。\n\n步骤1：提取给定信息\n- 体系：闭壳层分子。\n- 基组：正则哈特里-福克分子轨道。\n- $N_o$：占据轨道数。\n- $N_v$：虚拟轨道数。\n- 下标 $i,j,k,l$：占据轨道，维度 $N_o$。\n- 下标 $a,b,c,d$：虚拟轨道，维度 $N_v$。\n- 振幅：$t_{i}^{a}$ (单激发)，$t_{ij}^{ab}$ (双激发)。\n- 双电子积分：$v_{pq}^{rs} \\equiv \\langle pr \\| qs \\rangle$。\n- 任务1：分析对双激发残差 $r_{ij}^{ab}$ 的三个特定贡献项的朴素计算代价 (大-$\\mathcal{O}$)。\n  - 粒子-粒子梯形：$r_{ij}^{ab} \\leftarrow \\sum_{cd} v_{ab}^{cd} \\, t_{ij}^{cd}$。\n  - 空穴-空穴梯形：$r_{ij}^{ab} \\leftarrow \\sum_{kl} v_{kl}^{ij} \\, t_{kl}^{ab}$。\n  - 环形/粒子-空穴：$r_{ij}^{ab} \\leftarrow \\sum_{kc} v_{kb}^{ic} \\, t_{jk}^{ac}$。\n- 任务2：展示如何引入中间体来重组双激发更新，以避免高于 $\\mathcal{O}(N_o^2 N_v^4)$ 或 $\\mathcal{O}(N_o^3 N_v^3)$ 的代价，特别是将朴素的 $\\mathcal{O}(N_o^4 N_v^2)$ 贡献项降低到主要代价为 $\\mathcal{O}(N_o^3 N_v^3)$。\n- 任务3：对于 $N_o = 28$ 和 $N_v = 220$，计算朴素空穴-空穴梯形代价 $\\mathcal{O}(N_o^4 N_v^2)$ 与重组代价 $\\mathcal{O}(N_o^3 N_v^3)$ 的比率 $R$，假设前置因子相等。四舍五入到四位有效数字。\n\n步骤2：使用提取的给定信息进行验证\n- 该问题具有科学依据。它涉及耦合簇单双激发 (CCSD) 理论的计算复杂性，这是现代量子化学的基石。术语、符号和特定的张量缩并在该领域都是标准的。\n- 该问题提法恰当。它提供了所有必要的定义，并要求关于算法标度的具体、可推导的结果以及基于这些标度律的数值计算。\n- 该问题是客观的。语言技术性强且精确，没有任何主观性或歧义。\n- 该问题是完整、一致且可验证的。它没有违反任何物理或数学原理。\n\n步骤3：结论与行动\n问题有效。将提供完整解答。\n\n张量缩并的计算代价由所有涉及指标的维度的乘积决定。对于形式为 $C_{\\text{free}} = \\sum_{\\text{summed}} A_{\\dots} B_{\\dots}$ 的运算，总运算计数与自由指标数量和求和指标数量的乘积成正比。我们将相应地分析每个要求的项。\n\n1) 朴素计算代价分析\n\n令 $r_{ij}^{ab}$ 为双激发振幅的残差。下标 $i,j$ 的范围是 $N_o$ 个占据轨道，下标 $a,b$ 的范围是 $N_v$ 个虚拟轨道。因此，对整个 $r_{ij}^{ab}$ 张量的任何更新都必然涉及为所有 $N_o^2 N_v^2$ 种这些自由指标的组合计算一个表达式。总代价是这个因子乘以每个元素的求和代价。\n\n- 粒子-粒子梯形缩并：更新为 $r_{ij}^{ab} \\leftarrow \\sum_{cd} v_{ab}^{cd} \\, t_{ij}^{cd}$。\n自由指标是 $i, j, a, b$，基本上产生 $N_o^2 N_v^2$ 次运算。求和是针对下标 $c$ 和 $d$，它们是虚拟轨道指标。这些求和的循环次数最高到 $N_v$。因此，求和的代价为 $\\mathcal{O}(N_v^2)$。\n总计算代价是外部（自由指标）循环和内部（缩并指标）循环的基数的乘积：\n$$\n\\text{Cost}_{pp} \\propto (N_o \\times N_o \\times N_v \\times N_v) \\times (N_v \\times N_v) = N_o^2 N_v^4 \\, .\n$$\n渐近标度为 $\\mathcal{O}(N_o^2 N_v^4)$。\n\n- 空穴-空穴梯形缩并：更新为 $r_{ij}^{ab} \\leftarrow \\sum_{kl} v_{kl}^{ij} \\, t_{kl}^{ab}$。\n自由指标同样是 $i, j, a, b$，贡献一个因子 $N_o^2 N_v^2$。求和是针对下标 $k$ 和 $l$，它们是占据轨道指标。这些求和的循环次数最高到 $N_o$。求和的代价为 $\\mathcal{O}(N_o^2)$。\n总计算代价是：\n$$\n\\text{Cost}_{hh} \\propto (N_o \\times N_o \\times N_v \\times N_v) \\times (N_o \\times N_o) = N_o^4 N_v^2 \\, .\n$$\n渐近标度为 $\\mathcal{O}(N_o^4 N_v^2)$。\n\n- 环形/粒子-空穴缩并：更新为 $r_{ij}^{ab} \\leftarrow \\sum_{kc} v_{kb}^{ic} \\, t_{jk}^{ac}$。\n自由指标是 $i, j, a, b$，贡献 $N_o^2 N_v^2$。求和是针对一个占据指标 $k$ 和一个虚拟指标 $c$。求和的代价为 $\\mathcal{O}(N_o N_v)$。\n总计算代价是：\n$$\n\\text{Cost}_{ring} \\propto (N_o \\times N_o \\times N_v \\times N_v) \\times (N_o \\times N_v) = N_o^3 N_v^3 \\, .\n$$\n渐近标度为 $\\mathcal{O}(N_o^3 N_v^3)$。该项的其他指标置换，例如 $\\sum_{kc} v_{ka}^{ic} t_{jk}^{bc}$，具有相同的结构和标度。\n\n2) 使用中间体重组\n\n对 CCSD 方程进行直接的、逐项的计算会导致步骤具有非常高的计算标度，例如 $\\mathcal{O}(N_o^4 N_v^2)$ 的空穴-空穴梯形项和某些可高达 $\\mathcal{O}(N_o^4 N_v^4)$ 的二次项。一个优化的实现通过对项进行分组和形成中间体来重组计算，以降低最昂贵步骤的标度。\n\n粒子-粒子梯形项，标度为 $\\mathcal{O}(N_o^2 N_v^4)$，是 CCSD 的计算瓶颈之一，通常不能通过简单的因子分解来降低。其代价标度保持为 $\\mathcal{O}(N_o^2 N_v^4)$。\n\n问题是如何将朴素标度为 $\\mathcal{O}(N_o^4 N_v^2)$ 的贡献项降低为一系列代价更易于管理的步骤，例如 $\\mathcal{O}(N_o^3 N_v^3)$。这不是通过孤立地对单个项进行因子分解来实现的，而是通过对整个方程进行全局重构。这个原理可以通过考察一个朴素代价甚至更高（$\\mathcal{O}(N_o^4 N_v^4)$）的不同项并演示其因子分解来最清楚地说明。这展示了通用的策略。\n\n考虑 CCD 残差中出现的一个代表性的二次项：\n$$\nX_{ij}^{ab} = \\sum_{klcd} v_{kl}^{cd} t_{ik}^{ac} t_{jl}^{bd}\n$$\n朴素的计算涉及对 8 个指标 $i, j, a, b, k, l, c, d$ 的循环，导致不可接受的 $\\mathcal{O}(N_o^4 N_v^4)$ 标度。我们可以通过引入一个中间体并分两个连续的步骤执行缩并来降低这个代价。\n\n让我们将求和重排为：\n$$\nX_{ij}^{ab} = \\sum_{kc} \\left( \\sum_{ld} v_{kl}^{cd} t_{jl}^{bd} \\right) t_{ik}^{ac}\n$$\n括号中的表达式可以定义为一个中间张量 $I_{kc}^{ja}$。请注意，为了使这个定义有用，中间体的指标不能依赖于括号外的指标。这里的指标是 $k, c, j, a$。\n$$\nI_{kc}^{ja} = \\sum_{ld} v_{kl}^{cd} t_{jl}^{bd}\n$$\n步骤1：构建中间体 $I_{kc}^{ja}$。自由指标是 $k, j$（占据，维度 $N_o$）和 $c, a$（虚拟，维度 $N_v$）。求和指标是 $l$（占据，维度 $N_o$）和 $d$（虚拟，维度 $N_v$）。构建这个中间体的代价是所有参与指标维度的乘积：\n$$\n\\text{Cost}(I) \\propto (N_o \\times N_v \\times N_o \\times N_v) \\times (N_o \\times N_v) = N_o^3 N_v^3\n$$\n中间体 $I_{kc}^{ja}$ 是一个大小为 $N_o^2 N_v^2$ 的张量。\n\n步骤2：将中间体与剩余的振幅张量缩并以计算 $X_{ij}^{ab}$：\n$$\nX_{ij}^{ab} = \\sum_{kc} I_{kc}^{ja} t_{ik}^{ac}\n$$\n自由指标是 $i, j, a, b$（$N_o^2 N_v^2$ 个元素）。求和指标是 $k$（占据，维度 $N_o$）和 $c$（虚拟，维度 $N_v$）。这第二步的代价是：\n$$\n\\text{Cost}(X) \\propto (N_o \\times N_o \\times N_v \\times N_v) \\times (N_o \\times N_v) = N_o^3 N_v^3\n$$\n通过将单个 $\\mathcal{O}(N_o^4 N_v^4)$ 步骤分解为两个连续的 $\\mathcal{O}(N_o^3 N_v^3)$ 步骤，此项贡献的总体计算标度降低到 $\\mathcal{O}(N_o^3 N_v^3)$。\n\n这个完全相同的原理，即通过积分和振幅的缩并形成中间体，是用来处理 CCSD 方程中所有高阶项的通用策略。虽然空穴-空穴梯形项 $\\sum_{kl} v_{kl}^{ij} t_{kl}^{ab}$ 在振幅上是线性的，其直接的因子分解不那么简单，但它在完整算法中是作为更大的复合中间体的一部分进行计算的。总体结果是，整个 CCSD 残差可以通过一系列步骤构建，其中最昂贵的步骤是粒子-粒子梯形项 $\\mathcal{O}(N_o^2 N_v^4)$，以及各种标度为 $\\mathcal{O}(N_o^3 N_v^3)$ 的环形缩并。因此，在优化的算法中避免了朴素的 $\\mathcal{O}(N_o^4 N_v^2)$ 代价。问题陈述指的是，对于这些“重空穴”(hole-heavy)项，重组路径的有效主要代价是 $\\mathcal{O}(N_o^3 N_v^3)$。\n\n3) 比率计算\n\n我们被要求计算朴素空穴-空穴梯形代价与针对同类型贡献的重组、基于中间体的路径代价的比率 $R$。\n朴素代价的标度为 $\\mathcal{O}(N_o^4 N_v^2)$。\n如第2部分所述，重组路径的主要标度为 $\\mathcal{O}(N_o^3 N_v^3)$。\n问题陈述要求假设标度律的前置常数相等。令此常数为 $C$。\n$$\n\\text{Cost}_{\\text{naive}} = C \\cdot N_o^4 N_v^2\n$$\n$$\n\\text{Cost}_{\\text{reorganized}} = C \\cdot N_o^3 N_v^3\n$$\n因此，比率 $R$ 是：\n$$\nR = \\frac{\\text{Cost}_{\\text{naive}}}{\\text{Cost}_{\\text{reorganized}}} = \\frac{C \\cdot N_o^4 N_v^2}{C \\cdot N_o^3 N_v^3} = \\frac{N_o}{N_v}\n$$\n给定值 $N_o = 28$ 和 $N_v = 220$：\n$$\nR = \\frac{28}{220} = \\frac{7}{55}\n$$\n将此分数转换为小数值并四舍五入到四位有效数字：\n$$\nR \\approx 0.12727272... \\approx 0.1273\n$$\n这证明了通过重组计算所实现的显著计算节省，特别是对于虚拟轨道数 $N_v$ 远超占据轨道数 $N_o$ 的体系，这是典型情况。", "answer": "$$\\boxed{0.1273}$$", "id": "2766796"}]}