{"hands_on_practices": [{"introduction": "构型相互作用（CI）方法的出发点是构建多电子波函数的展开空间。本练习 ([@problem_id:2881654]) 将引导你通过组合计数，亲手计算不同截断等级（CIS, CISD, CISDT）下 CI 空间的维度。通过这个计算，你将直观地感受到 CI 维度的“组合爆炸”问题，并理解为何完全 CI (FCI) 仅适用于极小的体系，而截断 CI 方法是更实用的选择。", "problem": "考虑一个基于自旋轨道基组中的哈特里-福克（HF）行列式构建的单参考组态相互作用（CI）展开。令 $n_o$ 表示活性空间中已占据自旋轨道的数量，$n_v$ 表示同一空间中虚拟自旋轨道的数量。一个秩为 $k$ 的激发用 $k$ 个不同的虚拟自旋轨道替换 $k$ 个不同的已占据自旋轨道，从而生成一个新的斯莱特行列式。假设行列式直接在自旋轨道表象中构建（无自旋匹配），并且给定截断秩的CI空间包括HF参考行列式以及所有激发秩直到该截断秩的不同的斯莱特行列式。\n\n从二次量子化中斯莱特行列式和电子激发的标准定义出发，推导出一个关于 $n_o$ 和 $n_v$ 的、计算不同 $k$ 重激发行列式数量的通用计数表达式，并由此获得在单激发（Configuration Interaction Singles, CIS）、单双激发（Configuration Interaction Singles and Doubles, CISD）以及单双三激发（Configuration Interaction Singles, Doubles, and Triples, CISDT）水平下截断CI空间的总维度。\n\n然后，对于一个具有 $n_o=5$ 个已占据自旋轨道和 $n_v=10$ 个虚拟自旋轨道的水体系的有效活性空间模型，以精确整数的形式数值计算CIS、CISD和CISDT的维度。最后，简要讨论这些维度对于CI中哈密顿量构建和对角化的计算影响。\n\n请以三个精确整数的形式提供CIS、CISD和CISDT维度的最终数值结果。无需四舍五入。最终答案必须只包含这三个值。", "solution": "对问题陈述进行验证。\n\n**第1步：提取已知条件**\n- 该体系是一个基于自旋轨道基组中的哈特里-福克（HF）行列式构建的单参考组态相互作用（CI）展开。\n- $n_o$：活性空间中已占据自旋轨道的数量。\n- $n_v$：活性空间中虚拟自旋轨道的数量。\n- 一个秩为 $k$ 的激发用 $k$ 个不同的虚拟自旋轨道替换 $k$ 个不同的已占据自旋轨道。\n- 行列式在自旋轨道表象中构建，无自旋匹配。\n- 一个给定截断秩的截断CI空间包括HF参考以及所有激发秩直到该截断秩的不同的斯莱特行列式。\n- 给定一个活性空间模型，其中 $n_o=5$ 且 $n_v=10$。\n- 任务是：\n    1. 推导计算 $k$ 重激发行列式数量的通用计数表达式。\n    2. 推导CIS、CISD和CISDT空间维度的表达式。\n    3. 为给定模型数值计算这些维度。\n    4. 讨论计算上的影响。\n\n**第2步：使用提取的已知条件进行验证**\n- **科学合理**：该问题基于量子化学的基本原理，特别是组态相互作用理论。所有术语和概念都是标准的、定义明确的。它在科学上是合理的。\n- **提法明确**：该问题提法明确。它提供了推导所需表达式和计算最终答案所需的所有定义和数值。所提问题有唯一、可推导的解。\n- **客观**：该问题以精确、客观的语言陈述，没有歧义或主观论断。\n\n**第3步：结论与行动**\n该问题是有效的，因为它科学合理、提法明确、客观且完整。将提供解答。\n\n组态相互作用的基础是将精确的多电子波函数在一组斯莱特行列式基上展开。这些行列式由一组单电子自旋轨道构建而成，这些自旋轨道被划分为已占据自旋轨道（在参考的哈特里-福克行列式 $|\\Psi_0\\rangle$ 中）和虚拟（未占据）自旋轨道。\n\n一个秩为 $k$ 的激发行列式是通过将 $k$ 个电子从 $k$ 个不同的已占据自旋轨道提升到 $k$ 个不同的虚拟自旋轨道而形成的。我们需要求出在给定激发秩 $k$ 下可以生成的唯一斯莱特行列式的数量。令这个数量为 $N_k$。\n\n创建一个 $k$ 重激发行列式的过程涉及两个独立的选择：\n1.  选择要移出电子的 $k$ 个已占据自旋轨道。\n2.  选择要填充电子的 $k$ 个虚拟自旋轨道。\n\n给定 $n_o$ 个已占据自旋轨道，从中选择 $k$ 个不同自旋轨道的方法数由二项式系数 $\\binom{n_o}{k}$ 给出。\n$$ \\binom{n_o}{k} = \\frac{n_o!}{k!(n_o - k)!} $$\n该表达式在 $0 \\le k \\le n_o$ 时有效。\n\n类似地，给定 $n_v$ 个虚拟自旋轨道，选择 $k$ 个不同自旋轨道以安置激发电子的方法数由二项式系数 $\\binom{n_v}{k}$ 给出。\n$$ \\binom{n_v}{k} = \\frac{n_v!}{k!(n_v - k)!} $$\n这在 $0 \\le k \\le n_v$ 时有效。\n\n由于已占据轨道的选择和虚拟轨道的选择是独立的，所以不同的 $k$ 重激发行列式的总数 $N_k$ 是这两个组合因子的乘积。\n$$ N_k = \\binom{n_o}{k} \\binom{n_v}{k} $$\n这就是在自旋轨道基下，不同 $k$ 重激发行列式数量的通用计数表达式。注意，当 $k=0$ 时，我们有 $N_0 = \\binom{n_o}{0}\\binom{n_v}{0} = 1 \\times 1 = 1$，这表示单个哈特里-福克参考行列式本身。\n\n一个截断CI空间的总维度是每个包含的激发级别下行列式数量的总和。\nCIS（单激发组态相互作用）空间包括参考行列式（$k=0$）和所有单激发（$k=1$）。其维度 $D_{CIS}$ 为：\n$$ D_{CIS} = N_0 + N_1 = 1 + \\binom{n_o}{1}\\binom{n_v}{1} = 1 + n_o n_v $$\n\nCISD（单双激发组态相互作用）空间包括参考、单激发和双激发（$k=2$）。其维度 $D_{CISD}$ 为：\n$$ D_{CISD} = N_0 + N_1 + N_2 = 1 + \\binom{n_o}{1}\\binom{n_v}{1} + \\binom{n_o}{2}\\binom{n_v}{2} = D_{CIS} + \\binom{n_o}{2}\\binom{n_v}{2} $$\n\nCISDT（单双三激发组态相互作用）空间包括参考、单激发、双激发和三激发（$k=3$）。其维度 $D_{CISDT}$ 为：\n$$ D_{CISDT} = N_0 + N_1 + N_2 + N_3 = 1 + \\binom{n_o}{1}\\binom{n_v}{1} + \\binom{n_o}{2}\\binom{n_v}{2} + \\binom{n_o}{3}\\binom{n_v}{3} = D_{CISD} + \\binom{n_o}{3}\\binom{n_v}{3} $$\n\n现在，我们为给定的活性空间模型（$n_o=5$ 和 $n_v=10$）计算这些维度。\n\n对于CIS：\n$$ D_{CIS} = 1 + n_o n_v = 1 + (5)(10) = 1 + 50 = 51 $$\n\n对于CISD：\n首先，我们计算双激发的数量 $N_2$。\n$$ N_2 = \\binom{n_o}{2}\\binom{n_v}{2} = \\binom{5}{2}\\binom{10}{2} $$\n$$ \\binom{5}{2} = \\frac{5 \\times 4}{2 \\times 1} = 10 $$\n$$ \\binom{10}{2} = \\frac{10 \\times 9}{2 \\times 1} = 45 $$\n$$ N_2 = 10 \\times 45 = 450 $$\nCISD空间的维度为：\n$$ D_{CISD} = D_{CIS} + N_2 = 51 + 450 = 501 $$\n\n对于CISDT：\n首先，我们计算三激发的数量 $N_3$。\n$$ N_3 = \\binom{n_o}{3}\\binom{n_v}{3} = \\binom{5}{3}\\binom{10}{3} $$\n$$ \\binom{5}{3} = \\frac{5 \\times 4 \\times 3}{3 \\times 2 \\times 1} = 10 $$\n$$ \\binom{10}{3} = \\frac{10 \\times 9 \\times 8}{3 \\times 2 \\times 1} = 10 \\times 3 \\times 4 = 120 $$\n$$ N_3 = 10 \\times 120 = 1200 $$\nCISDT空间的维度为：\n$$ D_{CISDT} = D_{CISD} + N_3 = 501 + 1200 = 1701 $$\n\n维度为 $D_{CIS}=51$，$D_{CISD}=501$ 和 $D_{CISDT}=1701$。\n\n最后，需要简要讨论计算上的影响。CI空间的维度 $D_{CI}$ 决定了必须构建和对角化的哈密顿矩阵 $\\mathbf{H}$ 的大小。该矩阵的维度为 $D_{CI} \\times D_{CI}$。CI计算的计算成本有两个主要组成部分：\n1. 构建哈密顿矩阵元 $H_{IJ} = \\langle \\Psi_I | \\hat{H} | \\Psi_J \\rangle$。此类矩阵元的数量约为 $\\frac{1}{2}D_{CI}^2$。\n2. 对角化矩阵 $\\mathbf{H}$ 以获得其本征值（能量）和本征矢量（波函数）。标准对角化算法的标度为 $O(D_{CI}^3)$。对于大问题，采用像Davidson算法这样的迭代方法，其每个根的成本大致标度为 $O(N_{iter} D_{CI}^2)$，其中 $N_{iter}$ 是收敛所需的迭代次数。\n\n推导出的表达式表明，$D_{CI}$ 随激发能级 $k$ 呈组合增长，随轨道数（$n_o$ 和 $n_v$）呈多项式增长。具体来说，对于固定的较大 $k$，$N_k \\sim O(n_o^k n_v^k)$。这种快速的、类似阶乘的增长被称为量子化学的“指数墙”。从我们的计算中可以看出（$51 \\to 501 \\to 1701$），即使对于一个小体系和低激发能级，CI矩阵的维度也会急剧增加。这使得高阶CI方法对于除了最小的分子体系之外的所有体系都计算成本过高，因此必须使用计算效率更高的近似方法。", "answer": "$$\\boxed{\\begin{pmatrix} 51  501  1701 \\end{pmatrix}}$$", "id": "2881654"}, {"introduction": "虽然截断 CI 方法在计算上是可行的，但它们存在重要的理论缺陷。本练习 ([@problem_id:2632125]) 设计了一个包含两个互不相互作用的原子的思想实验，旨在揭示一个关键问题：尺寸一致性（size-consistency）的缺乏。你将分析并推导出，CISD 方法计算得到的二聚体能量并不等于两个单体能量之和，这个误差是衡量电子结构方法可靠性的一个重要指标。", "problem": "在 Born–Oppenheimer 近似下，考虑两个充分分离的氦原子，使得该二聚体的总电子哈密顿量为 $H = H_{A} + H_{B}$，其中 $[H_{A}, H_{B}] = 0$，并且所有片段间的单电子和双电子积分均为零。对两个原子使用一个公共的正交归一分子轨道基组，并假设闭壳层 Hartree–Fock 参考态由每个单体上的正则轨道构成。关注一个能够捕获每个氦原子动力学相关的最小但非平凡的组态相互作用模型。\n\n对于单个氦原子（单体），将组态空间限制在 Hartree–Fock 参考行列式 $\\lvert \\Phi_{0} \\rangle$ 和一个概括了主要双激发相关通道的单个有效双激发行列式 $\\lvert \\Phi_{D} \\rangle$。在这个收缩的二维行列式子空间中，设电子哈密顿量的矩阵元为\n- $\\langle \\Phi_{0} \\lvert H \\rvert \\Phi_{0} \\rangle = E_{0}$，\n- $\\langle \\Phi_{D} \\lvert H \\rvert \\Phi_{D} \\rangle = E_{0} + \\Delta$ 且 $\\Delta > 0$，\n- $\\langle \\Phi_{0} \\lvert H \\rvert \\Phi_{D} \\rangle = \\langle \\Phi_{D} \\lvert H \\rvert \\Phi_{0} \\rangle = V$ 且 $V$ 为实数且 $V \\neq 0$，\n并根据 Brillouin 定理，假设单激发不与 $\\lvert \\Phi_{0} \\rangle$ 耦合。\n\n对于无限分离的氦二聚体，考虑相对于二聚体参考态 $\\lvert \\Phi_{0}^{A} \\Phi_{0}^{B} \\rangle$ 的单双激发组态相互作用 (CISD) 展开。根据相对于二聚体参考态最多截断到双激发的规则以及无相互作用片段的假设，包含两个乘积行列式 $\\lvert \\Phi_{D}^{A} \\Phi_{0}^{B} \\rangle$ 和 $\\lvert \\Phi_{0}^{A} \\Phi_{D}^{B} \\rangle$，但排除 $\\lvert \\Phi_{D}^{A} \\Phi_{D}^{B} \\rangle$，因为它相对于 $\\lvert \\Phi_{0}^{A} \\Phi_{0}^{B} \\rangle$ 是一个四激发。使用 Slater–Condon 规则和 $H$ 的可分离性，在此三维子空间中构建 CISD 哈密顿矩阵，并确定其最低本征值。\n\n将大小一致性误差 $\\varepsilon$ 定义为二聚体 CISD 能量与两倍单体 CISD 能量之差，\n$$\n\\varepsilon \\equiv E_{\\mathrm{CISD}}^{\\mathrm{dimer}} - 2 E_{\\mathrm{CISD}}^{\\mathrm{monomer}} \\, .\n$$\n用 $\\Delta$ 和 $V$ 推导出 $\\varepsilon$ 的闭合解析形式。您的最终答案必须是单个闭合形式的符号表达式。不要进行近似或级数展开。", "solution": "该问题要求推导在两个无相互作用的氦原子模型体系上进行单双激发组态相互作用 (CISD) 计算时的大小一致性误差 $\\varepsilon$。该误差定义为 $\\varepsilon \\equiv E_{\\mathrm{CISD}}^{\\mathrm{dimer}} - 2 E_{\\mathrm{CISD}}^{\\mathrm{monomer}}$。为求此值，我们必须首先在指定的截断组态相互作用空间内确定单体和二聚体的最低电子能量。\n\n首先，我们分析单体体系。单个氦原子在双态模型中描述，其基由 Hartree-Fock 参考行列式 $\\lvert \\Phi_{0} \\rangle$ 和单个有效的双激发行列式 $\\lvert \\Phi_{D} \\rangle$ 组成。在此正交归一基 $\\{\\lvert \\Phi_{0} \\rangle, \\lvert \\Phi_{D} \\rangle\\}$ 中，哈密顿矩阵 $\\mathbf{H}_{\\mathrm{monomer}}$ 由问题陈述给出：\n$$\n\\mathbf{H}_{\\mathrm{monomer}} = \\begin{pmatrix} \\langle \\Phi_{0} \\lvert H \\rvert \\Phi_{0} \\rangle  \\langle \\Phi_{0} \\lvert H \\rvert \\Phi_{D} \\rangle \\\\ \\langle \\Phi_{D} \\lvert H \\rvert \\Phi_{0} \\rangle  \\langle \\Phi_{D} \\lvert H \\rvert \\Phi_{D} \\rangle \\end{pmatrix} = \\begin{pmatrix} E_{0}  V \\\\ V  E_{0} + \\Delta \\end{pmatrix}\n$$\n该矩阵的本征值 $\\lambda$ 是特征方程 $\\det(\\mathbf{H}_{\\mathrm{monomer}} - \\lambda \\mathbf{I}) = 0$ 的根。\n$$\n\\det \\begin{pmatrix} E_{0} - \\lambda  V \\\\ V  E_{0} + \\Delta - \\lambda \\end{pmatrix} = (E_{0} - \\lambda)(E_{0} + \\Delta - \\lambda) - V^{2} = 0\n$$\n为简化起见，令 $\\lambda' = \\lambda - E_{0}$。方程变为：\n$$\n(-\\lambda')(\\Delta - \\lambda') - V^{2} = 0\n$$\n$$\n(\\lambda')^{2} - \\Delta \\lambda' - V^{2} = 0\n$$\n这个关于 $\\lambda'$ 的二次方程的解为：\n$$\n\\lambda' = \\frac{\\Delta \\pm \\sqrt{(-\\Delta)^{2} - 4(1)(-V^{2})}}{2} = \\frac{\\Delta \\pm \\sqrt{\\Delta^{2} + 4V^{2}}}{2}\n$$\n能量本征值为 $\\lambda = E_{0} + \\lambda'$。最低能量，我们将其确定为单体 CISD 能量 $E_{\\mathrm{CISD}}^{\\mathrm{monomer}}$，对应于负根：\n$$\nE_{\\mathrm{CISD}}^{\\mathrm{monomer}} = E_{0} + \\frac{\\Delta - \\sqrt{\\Delta^{2} + 4V^{2}}}{2}\n$$\n\n接下来，我们分析由两个无相互作用的氦原子 $A$ 和 $B$ 组成的二聚体体系。总哈密顿量为 $H = H_{A} + H_{B}$。CISD 空间由参考行列式 $\\lvert \\Psi_{0} \\rangle = \\lvert \\Phi_{0}^{A} \\Phi_{0}^{B} \\rangle$ 和最多有两次激发的行列式张成。根据单体模型，由于 Brillouin 定理，一个片段上的单激发与另一个片段上的参考态耦合（例如 $\\lvert \\Phi_{S}^{A} \\Phi_{0}^{B} \\rangle$）不与参考态 $\\lvert \\Psi_{0} \\rangle$ 耦合。相关的双激发是指一个片段被双激发而另一个片段处于其参考态的情况。它们是 $\\lvert \\Psi_{1} \\rangle = \\lvert \\Phi_{D}^{A} \\Phi_{0}^{B} \\rangle$ 和 $\\lvert \\Psi_{2} \\rangle = \\lvert \\Phi_{0}^{A} \\Phi_{D}^{B} \\rangle$。态 $\\lvert \\Phi_{D}^{A} \\Phi_{D}^{B} \\rangle$ 相对于 $\\lvert \\Psi_{0} \\rangle$ 是一个四激发，因此被排除在 CISD 空间之外。因此，我们在三维基 $\\{\\lvert \\Psi_{0} \\rangle, \\lvert \\Psi_{1} \\rangle, \\lvert \\Psi_{2} \\rangle\\}$ 中构建哈密顿矩阵 $\\mathbf{H}_{\\mathrm{dimer}}$。\n\n矩阵元 $H_{ij} = \\langle \\Psi_{i} \\lvert H_{A} + H_{B} \\rvert \\Psi_{j} \\rangle$ 的计算如下，利用了不同片段的行列式是正交归一的这一事实，例如 $\\langle \\Phi_{0}^{A} \\lvert \\Phi_{D}^{A} \\rangle = 0$。\n$$\nH_{00} = \\langle \\Phi_{0}^{A} \\Phi_{0}^{B} \\lvert H_{A} + H_{B} \\rvert \\Phi_{0}^{A} \\Phi_{0}^{B} \\rangle = \\langle \\Phi_{0}^{A} \\lvert H_{A} \\rvert \\Phi_{0}^{A} \\rangle + \\langle \\Phi_{0}^{B} \\lvert H_{B} \\rvert \\Phi_{0}^{B} \\rangle = E_{0} + E_{0} = 2E_{0}\n$$\n$$\nH_{11} = \\langle \\Phi_{D}^{A} \\Phi_{0}^{B} \\lvert H_{A} + H_{B} \\rvert \\Phi_{D}^{A} \\Phi_{0}^{B} \\rangle = \\langle \\Phi_{D}^{A} \\lvert H_{A} \\rvert \\Phi_{D}^{A} \\rangle + \\langle \\Phi_{0}^{B} \\lvert H_{B} \\rvert \\Phi_{0}^{B} \\rangle = (E_{0} + \\Delta) + E_{0} = 2E_{0} + \\Delta\n$$\n$$\nH_{22} = \\langle \\Phi_{0}^{A} \\Phi_{D}^{B} \\lvert H_{A} + H_{B} \\rvert \\Phi_{0}^{A} \\Phi_{D}^{B} \\rangle = \\langle \\Phi_{0}^{A} \\lvert H_{A} \\rvert \\Phi_{0}^{A} \\rangle + \\langle \\Phi_{D}^{B} \\lvert H_{B} \\rvert \\Phi_{D}^{B} \\rangle = E_{0} + (E_{0} + \\Delta) = 2E_{0} + \\Delta\n$$\n$$\nH_{01} = \\langle \\Phi_{0}^{A} \\Phi_{0}^{B} \\lvert H_{A} + H_{B} \\rvert \\Phi_{D}^{A} \\Phi_{0}^{B} \\rangle = \\langle \\Phi_{0}^{A} \\lvert H_{A} \\rvert \\Phi_{D}^{A} \\rangle \\langle \\Phi_{0}^{B} \\lvert \\Phi_{0}^{B} \\rangle = V \\cdot 1 = V\n$$\n$$\nH_{02} = \\langle \\Phi_{0}^{A} \\Phi_{0}^{B} \\lvert H_{A} + H_{B} \\rvert \\Phi_{0}^{A} \\Phi_{D}^{B} \\rangle = \\langle \\Phi_{0}^{A} \\lvert \\Phi_{0}^{A} \\rangle \\langle \\Phi_{0}^{B} \\lvert H_{B} \\rvert \\Phi_{D}^{B} \\rangle = 1 \\cdot V = V\n$$\n$$\nH_{12} = \\langle \\Phi_{D}^{A} \\Phi_{0}^{B} \\lvert H_{A} + H_{B} \\rvert \\Phi_{0}^{A} \\Phi_{D}^{B} \\rangle = \\langle \\Phi_{D}^{A} \\lvert H_{A} \\rvert \\Phi_{0}^{A} \\rangle \\langle \\Phi_{0}^{B} \\lvert \\Phi_{D}^{B} \\rangle + \\langle \\Phi_{D}^{A} \\lvert \\Phi_{0}^{A} \\rangle \\langle \\Phi_{0}^{B} \\lvert H_{B} \\rvert \\Phi_{D}^{B} \\rangle = V \\cdot 0 + 0 \\cdot V = 0\n$$\n根据厄米性，$H_{10}=H_{01}$，$H_{20}=H_{02}$，以及 $H_{21}=H_{12}$。二聚体的哈密顿矩阵为：\n$$\n\\mathbf{H}_{\\mathrm{dimer}} = \\begin{pmatrix} 2E_{0}  V  V \\\\ V  2E_{0} + \\Delta  0 \\\\ V  0  2E_{0} + \\Delta \\end{pmatrix}\n$$\n我们通过求解 $\\det(\\mathbf{H}_{\\mathrm{dimer}} - \\lambda \\mathbf{I}) = 0$ 来找到本征值 $\\lambda$。令 $\\lambda' = \\lambda - 2E_{0}$。\n$$\n\\det \\begin{pmatrix} -\\lambda'  V  V \\\\ V  \\Delta - \\lambda'  0 \\\\ V  0  \\Delta - \\lambda' \\end{pmatrix} = 0\n$$\n$$\n-\\lambda'(\\Delta - \\lambda')^{2} - V(V(\\Delta - \\lambda')) + V(-V(\\Delta - \\lambda')) = 0\n$$\n$$\n-\\lambda'(\\Delta - \\lambda')^{2} - 2V^{2}(\\Delta - \\lambda') = 0\n$$\n$$\n-(\\Delta - \\lambda')[\\lambda'(\\Delta - \\lambda') + 2V^{2}] = 0\n$$\n这导致两种情况。要么 $\\Delta - \\lambda' = 0$，得到 $\\lambda' = \\Delta$；要么 $\\lambda'(\\Delta - \\lambda') + 2V^{2} = 0$。第二种情况是二次方程 $(\\lambda')^{2} - \\Delta \\lambda' - 2V^{2} = 0$，其解为：\n$$\n\\lambda' = \\frac{\\Delta \\pm \\sqrt{(-\\Delta)^{2} - 4(1)(-2V^{2})}}{2} = \\frac{\\Delta \\pm \\sqrt{\\Delta^{2} + 8V^{2}}}{2}\n$$\n二聚体的最低能量本征值 $E_{\\mathrm{CISD}}^{\\mathrm{dimer}}$ 对应于最小的 $\\lambda'$ 值。\n$$\nE_{\\mathrm{CISD}}^{\\mathrm{dimer}} = 2E_{0} + \\frac{\\Delta - \\sqrt{\\Delta^{2} + 8V^{2}}}{2}\n$$\n最后，我们计算大小一致性误差 $\\varepsilon$。\n$$\n\\varepsilon = E_{\\mathrm{CISD}}^{\\mathrm{dimer}} - 2 E_{\\mathrm{CISD}}^{\\mathrm{monomer}}\n$$\n$$\n\\varepsilon = \\left( 2E_{0} + \\frac{\\Delta - \\sqrt{\\Delta^{2} + 8V^{2}}}{2} \\right) - 2 \\left( E_{0} + \\frac{\\Delta - \\sqrt{\\Delta^{2} + 4V^{2}}}{2} \\right)\n$$\n$$\n\\varepsilon = \\left( 2E_{0} + \\frac{\\Delta}{2} - \\frac{\\sqrt{\\Delta^{2} + 8V^{2}}}{2} \\right) - \\left( 2E_{0} + \\Delta - \\sqrt{\\Delta^{2} + 4V^{2}} \\right)\n$$\n$$\n\\varepsilon = \\left(\\frac{\\Delta}{2} - \\Delta\\right) + \\sqrt{\\Delta^{2} + 4V^{2}} - \\frac{\\sqrt{\\Delta^{2} + 8V^{2}}}{2}\n$$\n$$\n\\varepsilon = -\\frac{\\Delta}{2} + \\sqrt{\\Delta^{2} + 4V^{2}} - \\frac{\\sqrt{\\Delta^{2} + 8V^{2}}}{2}\n$$\n这个表达式就是用 $\\Delta$ 和 $V$ 表示的大小一致性误差的闭合解析形式。", "answer": "$$\\boxed{\\sqrt{\\Delta^{2} + 4V^{2}} - \\frac{\\Delta}{2} - \\frac{\\sqrt{\\Delta^{2} + 8V^{2}}}{2}}$$", "id": "2632125"}, {"introduction": "在确定了 CI 空间的维度和性质后，核心任务是求解 CI 哈密顿矩阵的最低本征值（即基态能量）。由于 CI 矩阵通常维度巨大，直接对角化并不可行。本练习 ([@problem_id:2765693]) 将带你手动执行戴维森（Davidson）迭代算法的两个步骤，这正是求解大型稀疏 CI 矩阵的标准方法，让你深入了解 CI 计算背后的数值核心。", "problem": "在用于电子结构的截断组态相互作用 (CI) 方法中，选定行列式子空间中的哈密顿量表示为一个有限的实对称矩阵。考虑以下 $3 \\times 3$ 对称矩阵，您可以将其视为正交归一的行列式基矢下的截断 CI 哈密顿量，\n$$\n\\mathbf{A} \\;=\\;\n\\begin{pmatrix}\n2  1  0 \\\\\n1  3  1 \\\\\n0  1  4\n\\end{pmatrix}.\n$$\n使用 Davidson 方法，从初始归一化猜测向量开始，近似计算最低特征值（该子空间内的基态能量）：\n$$\n\\mathbf{v}^{(0)} \\;=\\; \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}.\n$$\n采用基于 $\\mathbf{A}$ 对角线的标准对角 Davidson 预处理器，其元素为 $d_i = A_{ii}$，因此校正向量的分量计算为 $t_i = r_i / (d_i - \\theta)$，其中 $\\theta$ 是当前的 Ritz 值，$\\mathbf{r}$ 是残差。如果 $d_i - \\theta = 0$，则将该分量设置为 $t_i = 0$。在每次扩展时，通过 Gram-Schmidt 方法将新向量与当前子空间正交化，并重新归一化。\n\n精确执行两次 Davidson 迭代，如下所示：\n- 迭代 1：从 $\\mathbf{v}^{(0)}$ 构建一维子空间，计算 Ritz 值 $\\theta$、残差 $\\mathbf{r}$、预处理校正 $\\mathbf{t}$，然后正交归一化以获得下一个基向量，并形成二维子空间。\n- 迭代 2：在二维子空间中，计算新的 Ritz 对和相应的残差，应用对角预处理器得到校正，正交归一化以扩展到三维子空间。\n\n然后在所得的三维子空间中执行 Rayleigh-Ritz 投影，以获得当前的最低 Ritz 值。请将第二次 Davidson 迭代后的最终最低 Ritz 值以单一精确解析表达式的形式给出。不要四舍五入；如有必要，请提供包含根式的精确形式。", "solution": "所述问题具有科学依据，提法得当且客观。它描述了 Davidson 迭代法在寻找实对称矩阵最低特征值方面的标准应用，这是计算量子化学中的一个常见任务，尤其是在组态相互作用理论中。所有必要的数据和程序规则均已提供，不存在矛盾或含糊之处。因此，该问题是有效的，我们可以着手求解。\n\n给定对称矩阵 $\\mathbf{A}$ 和初始归一化向量 $\\mathbf{v}^{(0)}$：\n$$\n\\mathbf{A} = \\begin{pmatrix} 2  1  0 \\\\ 1  3  1 \\\\ 0  1  4 \\end{pmatrix}, \\quad \\mathbf{v}^{(0)} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n该过程将执行两次完整的迭代。\n\n**迭代 1**\n\n开始时，搜索子空间 $S_1$ 是一维的，由正交归一基 $B_1 = \\{\\mathbf{v}^{(0)}\\}$ 张成。\n\n1.  **Rayleigh-Ritz 投影：** 我们构建 $1 \\times 1$ 的投影哈密顿矩阵 $H_1$：\n    $$\n    H_1 = (\\mathbf{v}^{(0)})^T \\mathbf{A} \\mathbf{v}^{(0)} = \\begin{pmatrix} 1  0  0 \\end{pmatrix} \\begin{pmatrix} 2  1  0 \\\\ 1  3  1 \\\\ 0  1  4 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = 2\n    $$\n    这个 $1 \\times 1$ 矩阵的特征值是第一个 Ritz 值，$\\theta^{(1)} = 2$。对应的特征向量是标量 $1$。\n\n2.  **Ritz 向量和残差：** 当前对特征向量的近似（Ritz 向量）是 $\\mathbf{y}^{(1)} = \\mathbf{v}^{(0)}$。我们计算残差 $\\mathbf{r}^{(1)}$：\n    $$\n    \\mathbf{r}^{(1)} = (\\mathbf{A} - \\theta^{(1)}\\mathbf{I})\\mathbf{y}^{(1)} = \\mathbf{A}\\mathbf{v}^{(0)} - 2\\mathbf{v}^{(0)} = \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\end{pmatrix} - 2 \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}\n    $$\n\n3.  **预处理校正：** 我们使用对角预处理器计算校正向量 $\\mathbf{t}^{(1)}$。分量由 $t_i = r_i / (d_i - \\theta)$ 给出，其中 $d_i = A_{ii}$ 且 $\\theta = \\theta^{(1)} = 2$。\n    *   $t_1^{(1)} = \\frac{r_1^{(1)}}{A_{11} - \\theta^{(1)}} = \\frac{0}{2-2}$。分母为零，因此根据规则，我们设置 $t_1^{(1)} = 0$。\n    *   $t_2^{(1)} = \\frac{r_2^{(1)}}{A_{22} - \\theta^{(1)}} = \\frac{1}{3-2} = 1$。\n    *   $t_3^{(1)} = \\frac{r_3^{(1)}}{A_{33} - \\theta^{(1)}} = \\frac{0}{4-2} = 0$。\n    校正向量为 $\\mathbf{t}^{(1)} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}$。\n\n4.  **子空间扩展：** 我们必须将一个从 $\\mathbf{t}^{(1)}$ 派生出的新向量添加到我们的基中。我们使用 Gram-Schmidt 过程将 $\\mathbf{t}^{(1)}$ 相对于当前基 $\\{\\mathbf{v}^{(0)}\\}$ 进行正交化。令未归一化的新向量为 $\\mathbf{w} = \\mathbf{t}^{(1)}$。\n    $$\n    \\mathbf{v}^{(1)'} = \\mathbf{w} - ((\\mathbf{v}^{(0)})^T \\mathbf{w}) \\mathbf{v}^{(0)}\n    $$\n    投影为 $(\\mathbf{v}^{(0)})^T \\mathbf{w} = \\begin{pmatrix} 1  0  0 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = 0$。\n    所以，$\\mathbf{v}^{(1)'} = \\mathbf{w} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}$。\n    最后，我们对这个向量进行归一化。它的范数为 $||\\mathbf{v}^{(1)'}|| = \\sqrt{0^2+1^2+0^2} = 1$。它已经是归一化的。\n    新的基向量是 $\\mathbf{v}^{(1)} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}$。\n    新的搜索子空间 $S_2$ 由正交归一基 $B_2 = \\{\\mathbf{v}^{(0)}, \\mathbf{v}^{(1)}\\}$ 张成。\n\n**迭代 2**\n\n1.  **Rayleigh-Ritz 投影：** 我们在基 $B_2$ 中构建 $2 \\times 2$ 的投影哈密顿量 $H_2$。令 $V_2 = [\\mathbf{v}^{(0)} | \\mathbf{v}^{(1)}]$。\n    $$\n    H_2 = V_2^T \\mathbf{A} V_2 = \\begin{pmatrix} (\\mathbf{v}^{(0)})^T \\mathbf{A} \\mathbf{v}^{(0)}  (\\mathbf{v}^{(0)})^T \\mathbf{A} \\mathbf{v}^{(1)} \\\\ (\\mathbf{v}^{(1)})^T \\mathbf{A} \\mathbf{v}^{(0)}  (\\mathbf{v}^{(1)})^T \\mathbf{A} \\mathbf{v}^{(1)} \\end{pmatrix}\n    $$\n    对角元素为：\n    *   $(H_2)_{11} = (\\mathbf{v}^{(0)})^T \\mathbf{A} \\mathbf{v}^{(0)} = 2$（来自迭代 1）。\n    *   $(H_2)_{22} = (\\mathbf{v}^{(1)})^T \\mathbf{A} \\mathbf{v}^{(1)} = \\begin{pmatrix} 0  1  0 \\end{pmatrix} \\begin{pmatrix} 2  1  0 \\\\ 1  3  1 \\\\ 0  1  4 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = 3$。\n    非对角元素为：\n    *   $(H_2)_{12} = (\\mathbf{v}^{(0)})^T \\mathbf{A} \\mathbf{v}^{(1)} = \\begin{pmatrix} 1  0  0 \\end{pmatrix} \\begin{pmatrix} 2  1  0 \\\\ 1  3  1 \\\\ 0  1  4 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1  0  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 3 \\\\ 1 \\end{pmatrix} = 1$。\n    因此，投影哈密顿量为 $H_2 = \\begin{pmatrix} 2  1 \\\\ 1  3 \\end{pmatrix}$。我们通过求解特征方程 $\\det(H_2 - \\lambda\\mathbf{I}) = 0$ 来找到其特征值：\n    $$\n    (2-\\lambda)(3-\\lambda) - 1^2 = 0 \\implies \\lambda^2 - 5\\lambda + 5 = 0\n    $$\n    根为 $\\lambda = \\frac{5 \\pm \\sqrt{25-20}}{2} = \\frac{5 \\pm \\sqrt{5}}{2}$。最低的 Ritz 值是 $\\theta^{(2)} = \\frac{5 - \\sqrt{5}}{2}$。我们找到其对应的特征向量 $\\mathbf{c} = \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix}$：\n    $$\n    \\left(2 - \\frac{5 - \\sqrt{5}}{2}\\right)c_1 + c_2 = 0 \\implies \\left(\\frac{-1 + \\sqrt{5}}{2}\\right)c_1 + c_2 = 0\n    $$\n\n2.  **Ritz 向量和残差：** 新的 Ritz 向量是 $\\mathbf{y}^{(2)} = c_1 \\mathbf{v}^{(0)} + c_2 \\mathbf{v}^{(1)}$。残差 $\\mathbf{r}^{(2)} = (\\mathbf{A} - \\theta^{(2)}\\mathbf{I})\\mathbf{y}^{(2)}$ 与子空间 $S_2$ 正交。由于 $\\mathbf{v}^{(0)}=\\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$ 且 $\\mathbf{v}^{(1)}=\\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}$，$S_2$ 中的任何向量的第三个分量都为零。与 $S_2$ 正交的向量必须是 $\\begin{pmatrix} 0 \\\\ 0 \\\\ z \\end{pmatrix}$ 的形式。残差计算证实了这一点：\n    $$\n    \\mathbf{r}^{(2)} = \\mathbf{A}\\mathbf{y}^{(2)} - \\theta^{(2)}\\mathbf{y}^{(2)} = (c_1\\mathbf{A}\\mathbf{v}^{(0)} + c_2\\mathbf{A}\\mathbf{v}^{(1)}) - \\theta^{(2)}(c_1\\mathbf{v}^{(0)} + c_2\\mathbf{v}^{(1)})\n    $$\n    它简化为 $c_2 \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$。所以 $\\mathbf{r}^{(2)}$ 与 $\\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$ 成正比。\n\n3.  **预处理校正：** 我们使用 $\\mathbf{r}^{(2)}$ 和 $\\theta^{(2)} = \\frac{5-\\sqrt{5}}{2}$ 计算 $\\mathbf{t}^{(2)}$。未归一化的残差是 $\\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$。\n    *   $t_1^{(2)}=0$, $t_2^{(2)}=0$。\n    *   $t_3^{(2)} = \\frac{1}{A_{33} - \\theta^{(2)}} = \\frac{1}{4 - \\frac{5-\\sqrt{5}}{2}} = \\frac{1}{\\frac{3+\\sqrt{5}}{2}} = \\frac{2}{3+\\sqrt{5}}$。\n    校正向量 $\\mathbf{t}^{(2)}$ 与 $\\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$ 成正比。\n\n4.  **子空间扩展：** 我们将与 $\\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$ 成正比的新方向向量相对于基 $\\{\\mathbf{v}^{(0)}, \\mathbf{v}^{(1)}\\}$ 进行正交归一化。这个向量已经与 $\\mathbf{v}^{(0)}$ 和 $\\mathbf{v}^{(1)}$ 正交。它的范数是 $1$。新的基向量是 $\\mathbf{v}^{(2)} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$。\n    新的子空间 $S_3$ 由 $B_3 = \\{\\mathbf{v}^{(0)}, \\mathbf{v}^{(1)}, \\mathbf{v}^{(2)}\\}$ 张成，这是 $\\mathbb{R}^3$ 的标准基。\n\n**最终 Rayleigh-Ritz 投影**\n\n问题要求最终三维子空间中的最低 Ritz 值。基矩阵是 $V_3 = [\\mathbf{v}^{(0)} | \\mathbf{v}^{(1)} | \\mathbf{v}^{(2)}] = \\mathbf{I}$，即单位矩阵。投影的哈密顿量为：\n$$\nH_3 = V_3^T \\mathbf{A} V_3 = \\mathbf{I}^T \\mathbf{A} \\mathbf{I} = \\mathbf{A}\n$$\n因此，我们必须求原始矩阵 $\\mathbf{A}$ 的特征值。特征方程是 $\\det(\\mathbf{A} - \\lambda\\mathbf{I}) = 0$：\n$$\n\\det \\begin{pmatrix} 2-\\lambda  1  0 \\\\ 1  3-\\lambda  1 \\\\ 0  1  4-\\lambda \\end{pmatrix} = (2-\\lambda)((3-\\lambda)(4-\\lambda)-1) - 1(4-\\lambda) = 0\n$$\n$$\n(2-\\lambda)(\\lambda^2 - 7\\lambda + 11) - (4-\\lambda) = 0\n$$\n$$\n2\\lambda^2 - 14\\lambda + 22 - \\lambda^3 + 7\\lambda^2 - 11\\lambda - 4 + \\lambda = 0\n$$\n$$\n-\\lambda^3 + 9\\lambda^2 - 24\\lambda + 18 = 0 \\quad \\text{或} \\quad \\lambda^3 - 9\\lambda^2 + 24\\lambda - 18 = 0\n$$\n通过观察，$\\lambda = 3$ 是一个根：$3^3 - 9(3^2) + 24(3) - 18 = 27 - 81 + 72 - 18 = 0$。\n我们将三次多项式除以 $(\\lambda - 3)$ 来找到剩余的二次因子：\n$$\n\\frac{\\lambda^3 - 9\\lambda^2 + 24\\lambda - 18}{\\lambda - 3} = \\lambda^2 - 6\\lambda + 6\n$$\n$\\lambda^2 - 6\\lambda + 6 = 0$ 的根由二次公式给出：\n$$\n\\lambda = \\frac{6 \\pm \\sqrt{36 - 4(6)}}{2} = \\frac{6 \\pm \\sqrt{12}}{2} = \\frac{6 \\pm 2\\sqrt{3}}{2} = 3 \\pm \\sqrt{3}\n$$\n$\\mathbf{A}$ 的三个特征值是 $3$、$3+\\sqrt{3}$ 和 $3-\\sqrt{3}$。其中最低的是 $3 - \\sqrt{3}$。这是最终子空间中的最低 Ritz 值。", "answer": "$$\\boxed{3 - \\sqrt{3}}$$", "id": "2765693"}]}