{"hands_on_practices": [{"introduction": "多参考微扰理论在处理与参考态能量近乎简并的外部态时，常常会遇到“小分母”问题，导致计算不稳定。为了解决这个问题，研究者们引入了能级移动（level-shifting）技术。本练习通过一个简化模型进行动手计算，让您定量地理解不同类型的移动（无移动、实数移动和虚数移动）如何影响二阶能量校正，从而阐明这些关键正则化方法的数学基础 [@problem_id:2654359]。", "problem": "一个多参考微扰理论模型定义如下。一个能量为 $E_0^{(0)}$ 的归一化零阶参考态 $\\lvert \\Psi_0 \\rangle$ 通过微扰 $\\hat{V}$ 与一个由 $M$ 个组态 $\\{\\lvert \\mu \\rangle\\}$ 构成的外部空间耦合，这些组态的零阶能量为 $E_{\\mu}^{(0)}$。定义激发能分母为 $\\Delta \\equiv E_{\\mu}^{(0)} - E_0^{(0)}$。在该模型中，分母 $\\Delta$ 在区间 $[a,b]$ 上独立且服从均匀分布，耦合强度为常数，即对所有 $\\mu$ 都有 $\\lvert\\langle \\Psi_0 \\rvert \\hat{V} \\rvert \\mu \\rangle\\rvert = v$。假设连续谱近似（将离散求和替换为在给定分布上的平均值乘以 $M$）有效。\n\n在多参考背景下，使用二阶 Rayleigh–Schrödinger 能量校正表达式，并采用在实际多参考微扰理论中使用的标准能级移动正则化方法。计算使用以下方法的二阶能量：\n- 无能级移动，\n- 大小为 $s$ 的实数能级移动，\n- 大小为 $\\eta$ 的虚数能级移动，其中物理上有意义的能量是复数表达式的实部。\n\n该模型的参数为 $M = 100$，$v = 0.010\\,E_h$，$a = 0.020\\,E_h$，$b = 0.800\\,E_h$，$s = 0.200\\,E_h$ 以及 $\\eta = 0.200\\,E_h$。\n\n按（无移动、实数移动、虚数移动）的顺序报告三个数值能量。将您的答案四舍五入到 $4$ 位有效数字，并以 $E_h$ 为单位表示每个能量。", "solution": "首先将对问题陈述进行严格的验证过程。\n\n### 步骤1：提取已知条件\n逐字提取的已知条件如下：\n- 一个能量为 $E_0^{(0)}$ 的归一化零阶参考态 $\\lvert \\Psi_0 \\rangle$。\n- 一个由 $M$ 个组态 $\\{\\lvert \\mu \\rangle\\}$ 构成的外部空间，其零阶能量为 $E_{\\mu}^{(0)}$。\n- 微扰耦合 $\\hat{V}$。\n- 激发能分母：$\\Delta \\equiv E_{\\mu}^{(0)} - E_0^{(0)}$。\n- $\\Delta$ 的分布：在区间 $[a,b]$ 上独立且服从均匀分布。\n- 恒定的耦合强度：对所有 $\\mu$ 都有 $\\lvert\\langle \\Psi_0 \\rvert \\hat{V} \\rvert \\mu \\rangle\\rvert = v$。\n- 连续谱近似有效。\n- 能量校正将使用二阶 Rayleigh–Schrödinger 表达式计算。\n- 考虑三种正则化分母的情况：无能级移动、实数能级移动 $s$、以及虚数能级移动 $\\eta$（取最终能量的实部）。\n- 参数：$M = 100$，$v = 0.010\\,E_h$，$a = 0.020\\,E_h$，$b = 0.800\\,E_h$，$s = 0.200\\,E_h$ 以及 $\\eta = 0.200\\,E_h$。\n\n### 步骤2：使用提取的已知条件进行验证\n根据所需标准对问题进行分析。\n1.  **科学基础**：该问题描述了一个用于研究多参考微扰理论的简化模型哈密顿量，这是一种量子化学中标准且成熟的方法。对能量分母使用均匀分布和恒定耦合是一种常见的理论简化，以实现解析上的易处理性。能级移动（使用实数或虚数移动）是一种标准技术（例如，在 CASPT2 中），用于处理近简并情况并改善收敛性。该问题在科学上是合理的。\n2.  **适定性**：该问题是适定的。它提供了一个明确的目标（计算三个能量值），以及所有必要的参数和物理假设（连续谱近似、均匀分布），从而可以为每种情况推导出唯一的解。\n3.  **客观性**：该问题使用精确、客观、正式的科学语言陈述，没有任何主观性或歧义。\n4.  **完整性与一致性**：所提供的数据（$M$、$v$、$a$、$b$、$s$、$\\eta$）是完整的，并且在量纲上是一致的（所有能量都以 $E_h$ 为单位）。不存在矛盾。\n\n### 步骤3：结论与行动\n该问题被判定为**有效**。这是一个来自理论物理化学领域的适定的、有科学依据的问题。将提供解答。\n\n参考态 $\\lvert \\Psi_0 \\rangle$ 的二阶 Rayleigh-Schrödinger 微扰理论 (RSPT) 能量校正由下式给出：\n$$ E^{(2)} = \\sum_{\\mu \\ne 0} \\frac{\\lvert\\langle \\Psi_0 \\rvert \\hat{V} \\lvert \\mu \\rangle\\rvert^2}{E_0^{(0)} - E_{\\mu}^{(0)}} $$\n使用给定的定义，其中 $\\Delta_\\mu = E_{\\mu}^{(0)} - E_0^{(0)}$ 且 $\\lvert\\langle \\Psi_0 \\rvert \\hat{V} \\lvert \\mu \\rangle\\rvert = v$，表达式变为：\n$$ E^{(2)} = -\\sum_{\\mu=1}^{M} \\frac{v^2}{\\Delta_\\mu} $$\n问题规定使用连续谱近似。对 $M$ 个离散态的求和被替换为在能量分母分布上的积分。对于 $[a,b]$ 上的均匀分布，其概率密度函数 $P(\\Delta)$ 为：当 $\\Delta \\in [a,b]$ 时，$P(\\Delta) = \\frac{1}{b-a}$，否则为 0。求和替换如下：\n$$ \\sum_{\\mu=1}^{M} f(\\Delta_\\mu) \\to M \\int_a^b f(\\Delta) P(\\Delta) d\\Delta = \\frac{M}{b-a} \\int_a^b f(\\Delta) d\\Delta $$\n\n**情况1：无能级移动**\n被积函数为 $f(\\Delta) = -\\frac{v^2}{\\Delta}$。二阶能量为：\n$$ E_{no\\_shift}^{(2)} = \\frac{M}{b-a} \\int_a^b \\left(-\\frac{v^2}{\\Delta}\\right) d\\Delta = -\\frac{M v^2}{b-a} \\int_a^b \\frac{1}{\\Delta} d\\Delta $$\n该积分的计算结果为 $\\ln(\\Delta)$，因此：\n$$ E_{no\\_shift}^{(2)} = -\\frac{M v^2}{b-a} [\\ln(\\Delta)]_a^b = -\\frac{M v^2}{b-a} \\ln\\left(\\frac{b}{a}\\right) $$\n代入给定的数值：$M=100$，$v=0.010$，$a=0.020$，$b=0.800$。\n$$ E_{no\\_shift}^{(2)} = -\\frac{100 \\times (0.010)^2}{0.800 - 0.020} \\ln\\left(\\frac{0.800}{0.020}\\right) = -\\frac{0.01}{0.780} \\ln(40) $$\n$$ E_{no\\_shift}^{(2)} \\approx -0.0128205 \\times 3.6888795 \\approx -0.0472933 \\, E_h $$\n四舍五入到 $4$ 位有效数字，结果为 $-0.04729 \\, E_h$。\n\n**情况2：大小为 $s$ 的实数能级移动**\n分母移动一个实数值 $s$。函数变为 $f(\\Delta) = -\\frac{v^2}{\\Delta + s}$。\n$$ E_{real\\_shift}^{(2)} = -\\frac{M v^2}{b-a} \\int_a^b \\frac{1}{\\Delta + s} d\\Delta $$\n该积分的计算结果为 $\\ln(\\Delta + s)$：\n$$ E_{real\\_shift}^{(2)} = -\\frac{M v^2}{b-a} [\\ln(\\Delta + s)]_a^b = -\\frac{M v^2}{b-a} \\ln\\left(\\frac{b+s}{a+s}\\right) $$\n代入数值，其中 $s=0.200$：\n$$ E_{real\\_shift}^{(2)} = -\\frac{100 \\times (0.010)^2}{0.780} \\ln\\left(\\frac{0.800 + 0.200}{0.020 + 0.200}\\right) = -\\frac{0.01}{0.780} \\ln\\left(\\frac{1.000}{0.220}\\right) $$\n$$ E_{real\\_shift}^{(2)} \\approx -0.0128205 \\times \\ln(4.5454...) \\approx -0.0128205 \\times 1.5141278 \\approx -0.0194118 \\, E_h $$\n四舍五入到 $4$ 位有效数字，结果为 $-0.01941 \\, E_h$。\n\n**情况3：大小为 $\\eta$ 的虚数能级移动**\n分母移动一个虚数值 $i\\eta$。复数能量为：\n$$ E_{complex}^{(2)} = -\\frac{M v^2}{b-a} \\int_a^b \\frac{1}{\\Delta + i\\eta} d\\Delta $$\n物理上有意义的能量是其实部，$E_{imag\\_shift}^{(2)} = \\text{Re}(E_{complex}^{(2)})$。我们取被积函数的实部：\n$$ \\text{Re}\\left(\\frac{1}{\\Delta + i\\eta}\\right) = \\text{Re}\\left(\\frac{\\Delta - i\\eta}{(\\Delta + i\\eta)(\\Delta - i\\eta)}\\right) = \\frac{\\Delta}{\\Delta^2 + \\eta^2} $$\n因此，能量为：\n$$ E_{imag\\_shift}^{(2)} = -\\frac{M v^2}{b-a} \\int_a^b \\frac{\\Delta}{\\Delta^2 + \\eta^2} d\\Delta $$\n为求解该积分，我们使用换元法，令 $u = \\Delta^2 + \\eta^2$，则 $du = 2\\Delta d\\Delta$。\n$$ \\int \\frac{\\Delta}{\\Delta^2 + \\eta^2} d\\Delta = \\frac{1}{2} \\int \\frac{1}{u} du = \\frac{1}{2}\\ln(u) = \\frac{1}{2}\\ln(\\Delta^2 + \\eta^2) $$\n定积分为：\n$$ \\int_a^b \\frac{\\Delta}{\\Delta^2 + \\eta^2} d\\Delta = \\frac{1}{2} [\\ln(\\Delta^2 + \\eta^2)]_a^b = \\frac{1}{2} \\ln\\left(\\frac{b^2 + \\eta^2}{a^2 + \\eta^2}\\right) $$\n能量校正为：\n$$ E_{imag\\_shift}^{(2)} = -\\frac{M v^2}{2(b-a)} \\ln\\left(\\frac{b^2 + \\eta^2}{a^2 + \\eta^2}\\right) $$\n代入数值，其中 $\\eta=0.200$：\n$$ E_{imag\\_shift}^{(2)} = -\\frac{100 \\times (0.010)^2}{2(0.780)} \\ln\\left(\\frac{(0.800)^2 + (0.200)^2}{(0.020)^2 + (0.200)^2}\\right) = -\\frac{0.01}{1.56} \\ln\\left(\\frac{0.64 + 0.04}{0.0004 + 0.04}\\right) $$\n$$ E_{imag\\_shift}^{(2)} = -\\frac{0.01}{1.56} \\ln\\left(\\frac{0.68}{0.0404}\\right) \\approx -0.006410256 \\times \\ln(16.83168...) $$\n$$ E_{imag\\_shift}^{(2)} \\approx -0.006410256 \\times 2.823226 \\approx -0.0180998 \\, E_h $$\n四舍五入到 $4$ 位有效数字，结果为 $-0.01810 \\, E_h$。\n\n所要求的三个能量，按（无移动、实数移动、虚数移动）的顺序，四舍五入到四位有效数字，分别为 $-0.04729\\,E_h$、$-0.01941\\,E_h$ 和 $-0.01810\\,E_h$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-0.04729 & -0.01941 & -0.01810\n\\end{pmatrix}\n}\n$$", "id": "2654359"}, {"introduction": "小分母的抽象概念在实际的量子化学计算中会具体表现为非物理的赝象。一个典型的例子是使用CASPT2方法计算势能面时出现的“鼓包”，其原因通常是所谓的“闯入态”（intruder states）。本题旨在挑战您在氮气分子解离的背景下诊断这一众所周知的问题，并确定标准的理论解决方案，从而在形式理论与计算实践之间架起一座桥梁 [@problem_id:2459118]。", "problem": "对氮分子 $\\mathrm{N}_2$ 沿键长 $R$ 进行解离扫描，该计算采用完整活性空间自洽场 (CASSCF) 作为参考态，然后进行完整活性空间二阶微扰理论 (CASPT2) 计算。CASSCF 使用了一个包含 $6$ 个电子和 $6$ 个轨道的活性空间，该活性空间由价层 $\\sigma$ 和 $\\pi$ 成键与反键轨道组成。对于单重态，它产生了一条在趋向解离极限时平滑、单调递减的基态势能曲线。相比之下，CASPT2 校正在势能面上一个拉伸构型附近（约 $R \\approx 2.0\\,\\mathrm{\\AA}$）产生了一个非物理的局域极大值（“凸起”）。在整个扫描过程中，活性轨道的占据数保持物理上的合理性，并且在相同理论水平下已验证了关于价层相关空间的基组收敛性。\n\n哪个选项最能确定 CASPT2 “凸起”的可能物理原因，并提出了在多参考微扰理论框架内的适当补救措施？\n\nA. 原因：键拉伸导致的基组重叠误差；补救措施：对 CASPT2 能量应用平衡校正。\n\nB. 原因：入侵态导致二阶校正中出现近零分母；补救措施：引入虚能级移动或使用 N 电子价态二阶微扰理论 (NEVPT2)。\n\nC. 原因：非限制性轨道导致的参考态自旋污染；补救措施：对 CASSCF 参考态应用自旋投影。\n\nD. 原因：态平均参考态中由激发态污染引起的根翻转；补救措施：减少平均态的数量或使用纯粹的态特定 CASSCF。\n\nE. 原因：活性空间过大；补救措施：从活性空间中移除反键 $\\pi_g^\\ast$ 轨道以稳定微扰展开。", "solution": "完整活性空间二阶微扰理论 (CASPT2) 校正是一种应用于完整活性空间自洽场 (CASSCF) 零阶波函数的二阶微扰处理。在基于多组态参考态的二阶微扰理论中，能量校正的形式为\n$$\nE^{(2)} \\;=\\; \\sum_{I} \\frac{\\left\\lvert\\langle \\Psi_0 \\rvert \\hat{H} \\rvert \\Psi_I \\rangle \\right\\rvert^2}{\\Delta_I},\n$$\n其中 $\\lvert \\Psi_0 \\rangle$ 是参考态，$\\lvert \\Psi_I \\rangle$ 是正交的外部组态，$\\Delta_I = E_0^{(0)} - E_I^{(0)}$ 是由所选零阶哈密顿量定义的能量分母。CASPT2 的一个著名失效模式是入侵态的存在：即存在 $E_I^{(0)} \\approx E_0^{(0)}$ 的外部组态 $\\lvert \\Psi_I \\rangle$，使得 $\\Delta_I \\to 0$，微扰振幅变得异常大。随着分子构型的变化（例如，键的拉伸），里德堡或电荷转移类型的外部组态可能与参考态变得准简并，从而在势能面上产生尖锐的、非物理的特征，例如尖峰或局域极大值（“凸起”）。\n\n一个有原则的补救措施是正则化分母，以使准简并性不会主导校正。在 CASPT2 中，这通常通过向分母添加一个位移来实现。一种流行的选择是虚能级移动，它有效地将 $\\Delta_I$ 替换为 $\\Delta_I + i \\eta$（其中 $\\eta > 0$），在不引入不连续性的情况下抑制了小的 $\\Delta_I$ 的贡献；所得 $E^{(2)}$ 的实部被视为相关能。或者，可以通过电离势电子亲和能 (IPEA) 移动来改变零阶哈密顿量，或者更确定地，采用 N 电子价态二阶微扰理论 (NEVPT2)，该理论使用 Dyall 哈密顿量，并通过构造产生严格为正的分母，从而避免了入侵态。\n\n我们现在评估每个选项：\n\nA. 基组重叠误差 (BSSE) 主要是在弱束缚复合物中的一种分子间效应，通常不是相关理论水平下分子内解离曲线上出现尖锐、非物理局域极大值的原因。在此背景下，平衡校正对于分子内键拉伸没有标准定义或效果不佳，且问题陈述已指出基组收敛性已经得到验证。结论：不正确。\n\nB. 入侵态对应于 $E^{(2)}$ 中的近零分母 $\\Delta_I$，这可能在势能面上随构型变化产生非物理特征。引入虚能级移动（或适当的实能级移动）可以正则化小的分母，而切换到 N 电子价态二阶微扰理论 (NEVPT2) 则通过构造避免了入侵态。这些是适当且被广泛接受的补救措施。结论：正确。\n\nC. CASSCF 使用自旋匹配的组态态函数，并为目标自旋态产生 $\\hat{S}^2$ 的本征函数；自旋污染是针对非限制性单行列式参考态的问题，而不是针对多组态自旋匹配参考态。自旋投影在此不适用。结论：不正确。\n\nD. 在态平均 CASSCF 中，如果目标态的身份在扫描过程中发生变化，根翻转可能导致不连续性。然而，该设置指定了一个平滑的 CASSCF 势能曲线，并且此外，它确定了一个已经避免了根翻转的态特定处理。因此，减少态平均不是针对 CASPT2 特定凸起的相应补救措施。结论：不正确。\n\nE. 从活性空间中移除诸如 $\\pi_g^\\ast$ 之类的基本价层反键轨道会降低对断键过程的描述，并且通常会使解离时的行为恶化，而不是改善。“过大”的活性空间不是入侵态的原因；相反，过小或不平衡的活性空间可能会加剧问题，但给定的活性空间对于 $\\mathrm{N}_2$ 来说是标准的。结论：不正确。\n\n因此，可能的原因是 CASPT2 展开中的入侵态，而适当的补救措施是采用能级移动策略（例如，虚能级移动）或使用通过构造而无入侵态的 NEVPT2。", "answer": "$$\\boxed{B}$$", "id": "2459118"}, {"introduction": "衡量一种量子化学方法优劣的关键标准之一是其“尺度一致性”（size-consistency），该性质确保两个无相互作用体系的总能量等于它们各自能量之和。不同的MRPT方法在此方面的表现各异，这对它们的实际应用具有深远影响。本练习通过一个计算实验，向您展示为何像NEVPT2这样的方法被设计为具有尺度一致性，而标准的CASPT2则可能引入尺度一致性误差，从而揭示了它们在理论构造上的根本区别 [@problem_id:2459090]。", "problem": "您将使用一个最小化的、完全指定的玩具模型来分析大小一致性，该模型抽象了两种著名的多参考二阶微扰理论：带实能级移动的完全活性空间二阶微扰理论 (CASPT2) 和 N电子价态微扰理论 (NEVPT2)。考虑两个无相互作用的片段，标记为 $A$ 和 $B$，其零阶模型态是其片段模型态的张量积。每个片段 $X \\in \\{A,B\\}$ 都有一个外部构型，其特征是相对于其片段模型态的能隙 $\\Delta_X > 0$ 以及模型与外部构型之间的实耦合振幅 $g_X$。假设总哈密顿量是严格可分的，因此不存在片段间的耦合。令 $s \\ge 0$ 表示一个实能级移动。\n\n对于 NEVPT2 的抽象（Epstein–Nesbet 可分构造），定义片段二阶校正为\n$$\nE^{(2)}_{\\mathrm{NEV}}(X) = -\\frac{g_X^2}{\\Delta_X},\n$$\n对于复合的无相互作用二聚体 $AB$，\n$$\nE^{(2)}_{\\mathrm{NEV}}(AB) = -\\frac{g_A^2}{\\Delta_A} - \\frac{g_B^2}{\\Delta_B}.\n$$\n这种构造通过为仅涉及 $A$ 和仅涉及 $B$ 的激发分配不同的外部空间来强制实现强可分性。\n\n对于带能级移动的 CASPT2 的抽象（内收缩、能级移动构造），定义片段二阶校正为\n$$\nE^{(2)}_{\\mathrm{CAS}}(X;s) = -\\frac{g_X^2}{\\Delta_X + s}.\n$$\n对于复合的无相互作用二聚体 $AB$，在单个外部类的水平上对内收缩进行建模，该类将仅涉及 $A$ 和仅涉及 $B$ 的外部构型合并为一个收缩的外部矢量，其总耦合为 $g_A + g_B$，并使用一个有效的平均分母。定义\n$$\n\\overline{\\Delta}_{AB}(s) = \\frac{\\Delta_A + \\Delta_B}{2} + s,\n\\quad\nE^{(2)}_{\\mathrm{CAS}}(AB;s) = -\\frac{(g_A + g_B)^2}{\\overline{\\Delta}_{AB}(s)}.\n$$\n这种构造模拟了内收缩的不可分效应，并结合了应用于合并激发类的全局能级移动。\n\n将给定方法的大小一致性定义为表达式 $E^{(2)}(\\mathrm{AB}) = E^{(2)}(\\mathrm{A}) + E^{(2)}(\\mathrm{B})$。对于下面的每个参数集，在绝对容差 $\\tau = 1\\times 10^{-12}$ 内，评估上述抽象中的 NEVPT2 和带能级移动的 CASPT2 是否满足大小一致性。您的程序应为每个测试用例计算两个布尔值：\n- 第一个值指示 NEVPT2 是否具有大小一致性，\n- 第二个值指示带能级移动的 CASPT2 是否具有大小一致性。\n\n使用以下参数值测试套件 $(\\Delta_A, g_A, \\Delta_B, g_B, s)$：\n1. $(0.8, 0.25, 1.1, 0.18, 0.2)$\n2. $(0.5, 0.3, 1.5, 0.1, 0.05)$\n3. $(0.7, 0.2, 2.0, 0.0, 0.3)$\n4. $(0.5, 0.3, 0.5, 0.3, 1000.0)$\n\n所有量纲均为无量纲。不出现角度。不使用百分比。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序如下\n$[\\text{NEV-1}, \\text{CAS-1}, \\text{NEV-2}, \\text{CAS-2}, \\text{NEV-3}, \\text{CAS-3}, \\text{NEV-4}, \\text{CAS-4}]$，\n其中每个条目都是使用绝对容差 $\\tau = 1\\times 10^{-12}$ 计算的布尔值。", "solution": "问题陈述经过验证，被认为是科学上合理的、问题定义良好的和客观的。它在计算化学领域提出了一个有效的理论练习，使用简化但合理的模型来研究多参考微扰理论中的大小一致性属性。该问题是自包含的，并为唯一解提供了所有必要的定义和数据。因此，我们可以进行严格的分析。\n\n任务是评估两种抽象的二阶微扰理论 NEVPT2 和 CASPT2 对于一个由两个无相互作用片段 $A$ 和 $B$ 组成的系统的大小一致性。大小一致性要求复合系统（二聚体）的能量是单个片段能量的总和，即 $E^{(2)}(AB) = E^{(2)}(A) + E^{(2)}(B)$。我们对每个模型评估此条件。数值相等的容差为 $\\tau = 1 \\times 10^{-12}$。\n\n首先，我们分析 N 电子价态微扰理论 (NEVPT2) 的抽象。\n单个片段 $X \\in \\{A, B\\}$ 的二阶能量校正由下式给出：\n$$\nE^{(2)}_{\\mathrm{NEV}}(X) = -\\frac{g_X^2}{\\Delta_X}\n$$\n因此，片段能量的总和为：\n$$\nE^{(2)}_{\\mathrm{NEV}}(A) + E^{(2)}_{\\mathrm{NEV}}(B) = \\left(-\\frac{g_A^2}{\\Delta_A}\\right) + \\left(-\\frac{g_B^2}{\\Delta_B}\\right) = -\\frac{g_A^2}{\\Delta_A} - \\frac{g_B^2}{\\Delta_B}\n$$\n无相互作用二聚体 $AB$ 的能量定义为：\n$$\nE^{(2)}_{\\mathrm{NEV}}(AB) = -\\frac{g_A^2}{\\Delta_A} - \\frac{g_B^2}{\\Delta_B}\n$$\n通过直接比较，我们可以看到大小一致性条件\n$$\nE^{(2)}_{\\mathrm{NEV}}(AB) = E^{(2)}_{\\mathrm{NEV}}(A) + E^{(2)}_{\\mathrm{NEV}}(B)\n$$\n根据定义是精确满足的。该模型被构造成严格可分的，或称“强大小一致性”。大小一致性误差在解析上为零。因此，对于任何参数集 $(\\Delta_A, g_A, \\Delta_B, g_B, s)$，只要 $\\Delta_A, \\Delta_B > 0$，此模型就具有大小一致性。\n\n接下来，我们分析带有实能级移动的完全活性空间二阶微扰理论 (CASPT2) 的抽象。\n对于带有能级移动 $s \\ge 0$ 的单个片段 $X \\in \\{A, B\\}$，其二阶能量校正为：\n$$\nE^{(2)}_{\\mathrm{CAS}}(X;s) = -\\frac{g_X^2}{\\Delta_X + s}\n$$\n片段能量的总和为：\n$$\nE^{(2)}_{\\mathrm{CAS}}(A;s) + E^{(2)}_{\\mathrm{CAS}}(B;s) = -\\frac{g_A^2}{\\Delta_A + s} - \\frac{g_B^2}{\\Delta_B + s}\n$$\n二聚体 $AB$ 的能量是使用内收缩模型和平均分母定义的：\n$$\nE^{(2)}_{\\mathrm{CAS}}(AB;s) = -\\frac{(g_A + g_B)^2}{\\overline{\\Delta}_{AB}(s)} = -\\frac{(g_A + g_B)^2}{\\frac{\\Delta_A + \\Delta_B}{2} + s}\n$$\n大小一致性误差 $\\delta E$ 是二聚体能量与片段能量总和之间的差值：\n$$\n\\delta E = E^{(2)}_{\\mathrm{CAS}}(AB;s) - \\left( E^{(2)}_{\\mathrm{CAS}}(A;s) + E^{(2)}_{\\mathrm{CAS}}(B;s) \\right)\n$$\n$$\n\\delta E = \\left( \\frac{g_A^2}{\\Delta_A + s} + \\frac{g_B^2}{\\Delta_B + s} \\right) - \\frac{(g_A + g_B)^2}{\\frac{\\Delta_A + \\Delta_B}{2} + s}\n$$\n该表达式通常不等于零。因此，该模型通常不具有大小一致性。大小一致性误差源于该模型模仿真实 CASPT2 的两个特征：对合并的激发类使用单一的平均分母，以及由于内收缩导致分子项的不可分性（在此模型中表示为 $(g_A + g_B)^2$）。只有当 $|\\delta E| \\le \\tau$ 时，大小一致性才成立。我们必须对每个测试用例评估此条件。\n\n情况 1： $(\\Delta_A, g_A, \\Delta_B, g_B, s) = (0.8, 0.25, 1.1, 0.18, 0.2)$\n- NEVPT2：根据定义具有大小一致性。结果：True。\n- CASPT2：\n  - $E^{(2)}_{\\mathrm{CAS}}(A;s) + E^{(2)}_{\\mathrm{CAS}}(B;s) = -\\frac{0.25^2}{0.8+0.2} - \\frac{0.18^2}{1.1+0.2} = -0.0625 - \\frac{0.0324}{1.3} \\approx -0.0874230769$\n  - $E^{(2)}_{\\mathrm{CAS}}(AB;s) = -\\frac{(0.25+0.18)^2}{\\frac{0.8+1.1}{2}+0.2} = -\\frac{0.43^2}{1.15} = -\\frac{0.1849}{1.15} \\approx -0.1607826087$\n  - $|\\delta E| \\approx |-0.1607826087 - (-0.0874230769)| \\approx 0.0733595318 \\gg \\tau$。不具有大小一致性。结果：False。\n\n情况 2： $(\\Delta_A, g_A, \\Delta_B, g_B, s) = (0.5, 0.3, 1.5, 0.1, 0.05)$\n- NEVPT2：根据定义具有大小一致性。结果：True。\n- CASPT2：\n  - $E^{(2)}_{\\mathrm{CAS}}(A;s) + E^{(2)}_{\\mathrm{CAS}}(B;s) = -\\frac{0.3^2}{0.5+0.05} - \\frac{0.1^2}{1.5+0.05} = -\\frac{0.09}{0.55} - \\frac{0.01}{1.55} \\approx -0.1700879765$\n  - $E^{(2)}_{\\mathrm{CAS}}(AB;s) = -\\frac{(0.3+0.1)^2}{\\frac{0.5+1.5}{2}+0.05} = -\\frac{0.4^2}{1.05} = -\\frac{0.16}{1.05} \\approx -0.1523809524$\n  - $|\\delta E| \\approx |-0.1523809524 - (-0.1700879765)| \\approx 0.0177070241 \\gg \\tau$。不具有大小一致性。结果：False。\n\n情况 3： $(\\Delta_A, g_A, \\Delta_B, g_B, s) = (0.7, 0.2, 2.0, 0.0, 0.3)$\n- NEVPT2：根据定义具有大小一致性。结果：True。\n- CASPT2：此处，$g_B=0$。误差变为 $\\delta E = g_A^2 \\left( \\frac{1}{\\Delta_A+s} - \\frac{1}{\\frac{\\Delta_A+\\Delta_B}{2}+s} \\right)$。除非 $\\Delta_A = \\Delta_B$，否则该值不为零。此处 $\\Delta_A \\neq \\Delta_B$。\n  - $E^{(2)}_{\\mathrm{CAS}}(A;s) + E^{(2)}_{\\mathrm{CAS}}(B;s) = -\\frac{0.2^2}{0.7+0.3} - \\frac{0^2}{2.0+0.3} = -0.04$\n  - $E^{(2)}_{\\mathrm{CAS}}(AB;s) = -\\frac{(0.2+0)^2}{\\frac{0.7+2.0}{2}+0.3} = -\\frac{0.04}{1.65} \\approx -0.0242424242$\n  - $|\\delta E| \\approx |-0.0242424242 - (-0.04)| \\approx 0.0157575758 \\gg \\tau$。不具有大小一致性。结果：False。\n\n情况 4： $(\\Delta_A, g_A, \\Delta_B, g_B, s) = (0.5, 0.3, 0.5, 0.3, 1000.0)$\n- NEVPT2：根据定义具有大小一致性。结果：True。\n- CASPT2：能级移动 $s$ 很大。在 $s \\to \\infty$ 的极限下，误差趋近于零，为 $\\delta E \\approx -2g_A g_B / s$。对于有限但大的 $s$，误差很小但不为零。\n  - $E^{(2)}_{\\mathrm{CAS}}(A;s) + E^{(2)}_{\\mathrm{CAS}}(B;s) = -\\frac{0.3^2}{0.5+1000} - \\frac{0.3^2}{0.5+1000} = -2 \\frac{0.09}{1000.5} \\approx -0.0001799100$\n  - $E^{(2)}_{\\mathrm{CAS}}(AB;s) = -\\frac{(0.3+0.3)^2}{\\frac{0.5+0.5}{2}+1000} = -\\frac{0.6^2}{1000.5} = -\\frac{0.36}{1000.5} \\approx -0.0003598201$\n  - $|\\delta E| \\approx |-0.0003598201 - (-0.0001799100)| \\approx 0.0001799101 \\gg \\tau$。不具有大小一致性。结果：False。\n\n总而言之，NEVPT2 抽象对于所有测试用例都具有大小一致性，而 CASPT2 抽象对于任何测试用例都不具有大小一致性，因为该模型固有地引入了在给定条件下不会消失的大小一致性误差。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Analyzes the size-consistency of two abstract multireference perturbation\n    theory models (NEVPT2 and CASPT2) for a series of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (delta_A, g_A, delta_B, g_B, s)\n    test_cases = [\n        (0.8, 0.25, 1.1, 0.18, 0.2),\n        (0.5, 0.3, 1.5, 0.1, 0.05),\n        (0.7, 0.2, 2.0, 0.0, 0.3),\n        (0.5, 0.3, 0.5, 0.3, 1000.0),\n    ]\n\n    # Absolute tolerance for checking size-consistency\n    tau = 1.0e-12\n\n    results = []\n    for case in test_cases:\n        delta_A, g_A, delta_B, g_B, s = case\n\n        # --- NEVPT2 Validation ---\n        # The NEVPT2 abstraction defines the dimer energy as the exact sum of\n        # the fragment energies:\n        # E2_NEV(AB) = -g_A**2/delta_A - g_B**2/delta_B\n        # E2_NEV(A) + E2_NEV(B) = (-g_A**2/delta_A) + (-g_B**2/delta_B)\n        # These are analytically identical. The size-consistency error is zero.\n        # Therefore, the result for NEVPT2 is always True.\n        results.append(True)\n\n        # --- CASPT2-with-level-shift Validation ---\n        # Sum of fragment energies\n        E2_CAS_A = -g_A**2 / (delta_A + s)\n        if delta_B > 0: # Problem states delta_X > 0, so this check is redundant but safe.\n            E2_CAS_B = -g_B**2 / (delta_B + s)\n        else:\n            E2_CAS_B = 0.0\n        \n        sum_E2_CAS = E2_CAS_A + E2_CAS_B\n\n        # Dimer energy\n        delta_AB_bar = (delta_A + delta_B) / 2.0 + s\n        E2_CAS_AB = -(g_A + g_B)**2 / delta_AB_bar\n\n        # Check for size-consistency\n        error_cas = abs(E2_CAS_AB - sum_E2_CAS)\n        is_cas_consistent = error_cas = tau\n        results.append(is_cas_consistent)\n\n    # Final print statement in the exact required format.\n    # map(str, ...) converts Python booleans (True, False) to their string representations.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2459090"}]}