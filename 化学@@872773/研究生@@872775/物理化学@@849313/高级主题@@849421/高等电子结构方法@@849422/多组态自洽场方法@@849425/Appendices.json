{"hands_on_practices": [{"introduction": "分子对称性为简化量子化学计算和理解电子结构提供了强大的理论框架。本练习将指导您运用群论，从第一性原理出发为原型多参考体系——乙烯——构建活性空间，并确定分子轨道和组态态函数的对称性。[@problem_id:2906791]", "problem": "乙烯是平面分子，属于 $D_{2h}$ 点群。采用标准的 $D_{2h}$ 轴约定：分子平面为 $xy$ 平面，碳-碳双键沿 $x$ 轴方向，而 $z$ 轴垂直于分子平面。在一个最小完备活性空间中，包含两个空间轨道中的两个电子，记作 $\\mathrm{CAS}(2,2)$，选择由两个碳原子的 $p_{z}$ 原子轨道形成的 $\\pi$ 和 $\\pi^{\\ast}$ 轨道作为活性轨道。\n\n从对称性匹配线性组合和不可约表示的定义出发，并仅使用 $D_{2h}$ 对称操作 $C_{2}(x)$、$C_{2}(y)$、$C_{2}(z)$ 和反演 $i$ 的特征标性质，完成以下任务：\n\n1. 构造两个 $p_{z}$ 原子轨道的两个对称性匹配线性组合，并确定它们在 $C_{2}(x)$、$C_{2}(y)$、$C_{2}(z)$ 和 $i$ 操作下的变换性质。将相应的 $D_{2h}$ 不可约表示指定给成键 $\\pi$ 分子轨道和反键 $\\pi^{\\ast}$ 分子轨道。\n\n2. 构建在 $\\mathrm{CAS}(2,2)$ 空间内可以建立的自旋匹配单重态组态态函数，并使用不可约表示的直积为每个单重态组态指定空间对称性。\n\n相应的完备活性空间组态相互作用 (CAS-CI) 问题中，自旋匹配单重态 $\\mathrm{A}_{g}$ 子空间的维度是多少？请以单个整数形式提供最终答案，不带单位。如果得到数值，请勿四舍五入。", "solution": "在尝试求解之前，对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 分子：乙烯 ($C_2H_4$)\n- 点群：$D_{2h}$\n- 轴约定：分子平面为 $xy$ 平面，碳-碳双键沿 $x$ 轴方向，而 $z$ 轴垂直于分子平面。\n- 活性空间：$\\mathrm{CAS}(2,2)$，两个空间轨道中的两个电子。\n- 活性轨道：由两个碳原子的 $p_{z}$ 原子轨道派生出的 $\\pi$ 和 $\\pi^{\\ast}$ 轨道。\n- 用于分析的操作：$C_{2}(x)$、$C_{2}(y)$、$C_{2}(z)$ 和反演 $i$。\n- 任务1：构造两个 $p_{z}$ 原子轨道的对称性匹配线性组合 (SALCs)，确定它们在指定操作下的变换性质，并指定相应的 $D_{2h}$ 不可约表示 (irreps)。\n- 任务2：在 $\\mathrm{CAS}(2,2)$ 空间内构建自旋匹配单重态组态态函数 (CSFs) 并指定其空间对称性。\n- 最终问题：确定 CAS-CI 问题中自旋匹配单重态 $\\mathrm{A}_{g}$ 子空间的维度。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题是群论在分子轨道理论和组态相互作用中的标准应用，是量子化学中的一个基本课题。它在科学上是合理的。\n- **适定性**：该问题是适定的，提出了一个清晰的问题，并提供了足够的信息来推导出唯一的整数值答案。\n- **客观性**：该问题以精确、客观和技术性的语言陈述。\n\n**步骤3：结论与行动**\n问题有效。将构建一个严谨的解。\n\n按照问题陈述的要求，解答分两部分进行。\n\n**第1部分：分子轨道的对称性**\n\n我们首先定义基组。设两个碳原子分别表示为 $C_A$ 和 $C_B$。根据指定的轴约定，我们将它们放置在坐标 $C_A = (-d, 0, 0)$ 和 $C_B = (d, 0, 0)$ 处，其中 $d > 0$ 为某一距离。基组由两个 $p_z$ 原子轨道组成，即中心在 $C_A$ 上的 $\\phi_A$ 和中心在 $C_B$ 上的 $\\phi_B$。一个 $p_z$ 轨道的函数形式为 $f(r)z$，它相对于 $xy$ 平面是反对称的。\n\n我们分析基轨道 $\\phi_A$ 和 $\\phi_B$ 在 $D_{2h}$ 群的指定对称操作下的变换。\n1.  **$C_{2}(x)$ 旋转**：绕 $x$ 轴旋转 $\\pi$ 弧度。坐标变换为 $(x, y, z) \\rightarrow (x, -y, -z)$。原子 $C_A$ 和 $C_B$ 位于轴上，不发生交换。$z$ 坐标反转，因此 $p_z$ 轨道的符号反转。\n    $$\n    C_{2}(x)\\phi_A = -\\phi_A \\quad ; \\quad C_{2}(x)\\phi_B = -\\phi_B\n    $$\n2.  **$C_{2}(y)$ 旋转**：绕 $y$ 轴旋转 $\\pi$ 弧度。坐标变换为 $(x, y, z) \\rightarrow (-x, y, -z)$。此操作交换碳原子，$C_A \\leftrightarrow C_B$。$z$ 坐标也反转。\n    $$\n    C_{2}(y)\\phi_A = -\\phi_B \\quad ; \\quad C_{2}(y)\\phi_B = -\\phi_A\n    $$\n3.  **$C_{2}(z)$ 旋转**：绕 $z$ 轴旋转 $\\pi$ 弧度。坐标变换为 $(x, y, z) \\rightarrow (-x, -y, z)$。此操作交换碳原子，$C_A \\leftrightarrow C_B$。$z$ 坐标不变，因此 $p_z$ 轨道的符号保持不变。\n    $$\n    C_{2}(z)\\phi_A = \\phi_B \\quad ; \\quad C_{2}(z)\\phi_B = \\phi_A\n    $$\n4.  **反演 $i$**：通过原点 $(0, 0, 0)$ 的反演。坐标变换为 $(x, y, z) \\rightarrow (-x, -y, -z)$。此操作交换碳原子，$C_A \\leftrightarrow C_B$，并反转 $z$ 坐标。\n    $$\n    i\\phi_A = -\\phi_B \\quad ; \\quad i\\phi_B = -\\phi_A\n    $$\n\n接下来，我们构造对称性匹配线性组合 (SALCs)。它们是成键 ($\\pi$) 和反键 ($\\pi^{\\ast}$) 分子轨道 (MOs)。令 $\\psi_1$ 为成键 $\\pi$ 分子轨道，$\\psi_2$ 为反键 $\\pi^{\\ast}$ 分子轨道，忽略归一化常数。\n$$\n\\psi_1 = \\phi_A + \\phi_B \\quad (\\text{成键 } \\pi \\text{ 轨道})\n$$\n$$\n\\psi_2 = \\phi_A - \\phi_B \\quad (\\text{反键 } \\pi^{\\ast} \\text{ 轨道})\n$$\n我们通过找出每个分子轨道在指定操作下的特征标来确定其不可约表示。\n\n对于成键 $\\pi$ 轨道 $\\psi_1$：\n- $C_{2}(x)\\psi_1 = C_{2}(x)(\\phi_A + \\phi_B) = -\\phi_A - \\phi_B = -1 \\cdot \\psi_1$。特征标为 $\\chi(C_{2}(x)) = -1$。\n- $C_{2}(y)\\psi_1 = C_{2}(y)(\\phi_A + \\phi_B) = -\\phi_B - \\phi_A = -1 \\cdot \\psi_1$。特征标为 $\\chi(C_{2}(y)) = -1$。\n- $C_{2}(z)\\psi_1 = C_{2}(z)(\\phi_A + \\phi_B) = \\phi_B + \\phi_A = +1 \\cdot \\psi_1$。特征标为 $\\chi(C_{2}(z)) = +1$。\n- $i\\psi_1 = i(\\phi_A + \\phi_B) = -\\phi_B - \\phi_A = -1 \\cdot \\psi_1$。特征标为 $\\chi(i) = -1$。\n关于 $(\\chi(C_{2}(z)), \\chi(C_{2}(y)), \\chi(C_{2}(x)))$ 的特征标为 $(+1, -1, -1)$。在反演操作下的特征标为 $-1$ (ungerade, u)。查阅 $D_{2h}$ 特征标表，具有这些特征标的不可约表示是 $B_{1u}$。因此，$\\pi$ 轨道具有 $b_{1u}$ 对称性。\n\n对于反键 $\\pi^{\\ast}$ 轨道 $\\psi_2$：\n- $C_{2}(x)\\psi_2 = C_{2}(x)(\\phi_A - \\phi_B) = -\\phi_A - (-\\phi_B) = -(\\phi_A - \\phi_B) = -1 \\cdot \\psi_2$。特征标为 $\\chi(C_{2}(x)) = -1$。\n- $C_{2}(y)\\psi_2 = C_{2}(y)(\\phi_A - \\phi_B) = -\\phi_B - (-\\phi_A) = \\phi_A - \\phi_B = +1 \\cdot \\psi_2$。特征标为 $\\chi(C_{2}(y)) = +1$。\n- $C_{2}(z)\\psi_2 = C_{2}(z)(\\phi_A - \\phi_B) = \\phi_B - \\phi_A = -(\\phi_A - \\phi_B) = -1 \\cdot \\psi_2$。特征标为 $\\chi(C_{2}(z)) = -1$。\n- $i\\psi_2 = i(\\phi_A - \\phi_B) = -\\phi_B - (-\\phi_A) = \\phi_A - \\phi_B = +1 \\cdot \\psi_2$。特征标为 $\\chi(i) = +1$。\n关于 $(\\chi(C_{2}(z)), \\chi(C_{2}(y)), \\chi(C_{2}(x)))$ 的特征标为 $(-1, +1, -1)$。在反演操作下的特征标为 $+1$ (gerade, g)。查阅 $D_{2h}$ 特征标表，具有这些特征标的不可约表示是 $B_{2g}$。因此，$\\pi^{\\ast}$ 轨道具有 $b_{2g}$ 对称性。\n\n**第2部分：组态态函数的对称性与最终维度**\n\n活性空间为 $\\mathrm{CAS}(2,2)$，其中两个电子分布在两个活性轨道中：$\\psi_{b_{1u}}$ ($\\pi$) 和 $\\psi_{b_{2g}}$ ($\\pi^{\\ast}$)。可能的电子组态有：\n1.  $(\\psi_{b_{1u}})^2 (\\psi_{b_{2g}})^0$\n2.  $(\\psi_{b_{1u}})^1 (\\psi_{b_{2g}})^1$\n3.  $(\\psi_{b_{1u}})^0 (\\psi_{b_{2g}})^2$\n\n我们关心的是自旋匹配的单重态 CSF。CSF 的空间对称性由所占据的单电子轨道的不可约表示的直积决定。\n\n1.  **组态 $(\\psi_{b_{1u}})^2$**：该组态有一个双占据轨道，唯一地形成一个单重态。其空间对称性 $\\Gamma_1$ 由直积给出：\n    $$\n    \\Gamma_1 = B_{1u} \\otimes B_{1u} = A_g\n    $$\n    任何不可约表示与其自身的直积总是全对称的不可约表示 $A_g$。该组态为单重态流形贡献了一个 $A_g$ 对称性的 CSF。\n\n2.  **组态 $(\\psi_{b_{1u}})^1 (\\psi_{b_{2g}})^1$**：这种两个电子处于两个不同轨道的组态会产生一个单重态和一个三重态。单重态和三重态 CSF 的空间对称性 $\\Gamma_2$ 均由直积给出：\n    $$\n    \\Gamma_2 = B_{1u} \\otimes B_{2g}\n    $$\n    我们通过将 $B_{1u}$ 和 $B_{2g}$ 的特征标相乘来得到结果的不可约表示：\n    - $\\chi(C_{2}(z)) = (+1) \\times (-1) = -1$\n    - $\\chi(C_{2}(y)) = (-1) \\times (+1) = -1$\n    - $\\chi(C_{2}(x)) = (-1) \\times (-1) = +1$\n    - $\\chi(i) = (-1) \\times (+1) = -1$ (ungerade, u)\n    特征标集 $(\\chi(C_{2}(z)), \\chi(C_{2}(y)), \\chi(C_{2}(x))) = (-1,-1,+1)$ 对应于 $B_3$ 表示。结合 ungerade 宇称，对称性为 $B_{3u}$。该组态贡献了一个 $B_{3u}$ 对称性的单重态 CSF。它对 $A_g$ 子空间没有贡献。\n\n3.  **组态 $(\\psi_{b_{2g}})^2$**：这是另一个双占据组态，形成一个单重态。其空间对称性 $\\Gamma_3$ 为：\n    $$\n    \\Gamma_3 = B_{2g} \\otimes B_{2g} = A_g\n    $$\n    该组态为单重态流形贡献了第二个 $A_g$ 对称性的 CSF。\n\nCAS-CI 问题的自旋匹配单重态 $A_g$ 子空间由按照 $A_g$ 不可约表示变换的单重态 CSF 张成。我们找到了两个这样的 CSF：一个来自 $(\\psi_{b_{1u}})^2$ 组态，另一个来自 $(\\psi_{b_{2g}})^2$ 组态。这两个 CSF 构成了 CI 矩阵的 $A_g$ 单重态块的基。\n\n因此，自旋匹配单重态 $A_g$ 子空间的维度为 $2$。", "answer": "$$\\boxed{2}$$", "id": "2906791"}, {"introduction": "在实际应用中，选择一个合适的活性空间是多参考计算中最关键也最具挑战性的步骤之一。本练习聚焦于一个核心的实践准则：通过分析自然轨道占据数 (NOONs) 来区分静态相关和动态相关，旨在培养您为复杂体系设置有效CASSCF计算所需的化学直觉。[@problem_id:2654001]", "problem": "一个分子体系通过多参考方法进行分析，该方法给出了六个价空间轨道的自然轨道占据数：$\\{1.98, 1.95, 1.80, 1.20, 0.15, 0.10\\}$。您的任务是提出了一个完整活性空间自洽场 (CASSCF) 活性空间，该活性空间需要是足以捕捉主要静态（非动态）相关作用的最小空间。请通过量化预期的静态相关来证明您的选择，并使用一个基于自然轨道占据数偏离单行列式极限程度的阈值标准。选择一个最佳选项，该选项需指定一个合理的完整活性空间 (CAS)，一个明确的阈值标准，以及一个与该标准一致的静态相关定量评估。\n\nA. 提议 $\\mathrm{CAS}(2,2)$，包括占据数为 $1.80$ 和 $1.20$ 的两个轨道，并排除占据数为 $1.98$、$1.95$、$0.15$ 和 $0.10$ 的轨道。使用每个轨道偏离幂等性的阈值 $\\tau = 0.20$ 来划分静态相关；将静态相关量化为所含轨道偏离值的总和，得出大约 $0.20 + 0.80 = 1.00$ 个电子的静态相关，这与分布在两个近简并轨道上的单个电子对相符。\n\nB. 提议 $\\mathrm{CAS}(4,4)$，包括占据数为 $1.95$、$1.80$、$1.20$ 和 $0.15$ 的轨道。使用每个轨道偏离幂等性的阈值 $\\tau = 0.05$ 来划分静态相关；将静态相关量化为大约 $0.05 + 0.20 + 0.80 + 0.15 = 1.20$ 个电子的静态相关，确保所有超过此容差的非整数占据数都被视为静态。\n\nC. 提议 $\\mathrm{CAS}(6,6)$，包括所有六个轨道，因为任何偏离 $2$ 或 $0$ 的情况都表示存在静态相关。不使用阈值（即任何偏离都计算在内）；将静态相关量化为大约 $0.02 + 0.05 + 0.20 + 0.80 + 0.15 + 0.10 = 1.32$ 个电子的静态相关。\n\nD. 提议 $\\mathrm{CAS}(2,3)$，包括占据数为 $1.80$、$1.20$ 和 $0.15$ 的轨道，并使用每个轨道偏离的阈值 $\\tau = 0.10$；将静态相关量化为大约 $0.20 + 0.80 + 0.15 = 1.15$ 个电子的静态相关，理由是像 $0.15$ 这样小的非零占据数必须被视为静态，以避免参考态产生偏差。", "solution": "该问题要求为一个分子体系提出一个最小且完备的完整活性空间自洽场 (CASSCF) 活性空间，并给出了先前多参考计算得到的一组自然轨道占据数。该选择必须通过一个阈值标准和对静态相关的定量评估来证明其合理性。\n\n基于自然轨道占据数选择 CASSCF 活性空间的基本原则如下：\n1.  在单行列式 Hartree-Fock (HF) 理论中，空间轨道的占据数严格为 $2$（对于闭壳层体系中的占据轨道）或 $0$（对于虚轨道）。此性质与单粒子密度矩阵的幂等性有关。\n2.  电子相关导致了对这种情况的偏离。自然轨道占据数变为分数，位于区间 $[0, 2]$ 内。\n3.  静态（或非动态）相关与电子组态的近简并性有关，其特征是自然轨道的占据数*显著*偏离 $2$ 或 $0$。这些轨道被称为“活性”轨道，必须包含在 CASSCF 活性空间中。\n4.  动态相关与短程的电子-电子 cusp 有关，涉及大量权重较小的组态的贡献。它导致自然轨道占据数仅*轻微*偏离 $2$ 或 $0$。这些轨道通常被排除在活性空间之外，以保持计算的可行性，并通过后-CASSCF 方法（例如，CASPT2, NEVPT2, MRCI）进行处理。\n5.  因此，一个用于静态相关的“最小完备”活性空间应包括所有占据数远离 $0$ 或 $2$ 的轨道（基于选定的偏离阈值），同时排除那些占据数接近 $0$ 或 $2$ 的轨道。\n6.  完整活性空间的表示法为 $\\mathrm{CAS}(N, M)$，其中 $N$ 是活性电子数，$M$ 是活性空间轨道数。通常通过将所选活性轨道的占据数相加并四舍五入到最接近的整数来确定一个一致的 $N$ 值。\n\n给定的六个价空间轨道的自然轨道占据数为 $\\{1.98, 1.95, 1.80, 1.20, 0.15, 0.10\\}$。\n让我们分析每个占据数 $n$ 与整数值（$0$ 或 $2$）的偏离。一个合理的偏离度量是 $\\min(|n-0|, |n-2|)$。\n-   $n_1 = 1.98$：偏离为 $2 - 1.98 = 0.02$。\n-   $n_2 = 1.95$：偏离为 $2 - 1.95 = 0.05$。\n-   $n_3 = 1.80$：偏离为 $2 - 1.80 = 0.20$。\n-   $n_4 = 1.20$：偏离为 $\\min(1.20, 2 - 1.20) = \\min(1.20, 0.80) = 0.80$。或者，与最近的整数 $1$ 的偏离是 $0.20$。在任何科学合理的解释中，该轨道都显示出非常大的偏离幂等性。\n-   $n_5 = 0.15$：偏离为 $0.15 - 0 = 0.15$。\n-   $n_6 = 0.10$：偏离为 $0.10 - 0 = 0.10$。\n\n占据数为 $n_3 = 1.80$ 和 $n_4 = 1.20$ 的两个轨道显示出与单行列式值 $0$ 或 $2$ 的最大偏离。其他轨道的偏离要小得多（对于几乎全满的轨道为 $0.05, 0.02$；对于几乎全空的轨道为 $0.15, 0.10$）。因此，一个足以捕捉主要静态相关的“最小完备”活性空间必须包括占据数为 $1.80$ 和 $1.20$ 的这两个轨道。活性轨道数为 $M=2$。活性电子数 $N$ 应为其占据数的总和：$N = 1.80 + 1.20 = 3.00$。因此，基于这些数据，一个合适的最小活性空间是 $\\mathrm{CAS}(3,2)$。\n\n现在，我们评估每个给定的选项。\n\n**A. 提议 $\\mathrm{CAS}(2,2)$ 包括占据数为 $1.80$ 和 $1.20$ 的两个轨道，并排除占据数为 $1.98$、$1.95$、$0.15$ 和 $0.10$ 的轨道。使用每个轨道偏离幂等性的阈值 $\\tau = 0.20$ 来划分静态相关；将静态相关量化为所含轨道偏离值的总和，得出大约 $0.20 + 0.80 = 1.00$ 个电子的静态相关，这与分布在两个近简并轨道上的单个电子对相符。**\n\n-   **轨道选择**: 该选项正确地将偏离最大的两个轨道（$1.80$ 和 $1.20$）确定为活性轨道，这与最小活性空间的原则一致。\n-   **阈值标准**: 提出了偏离阈值为 $\\tau = 0.20$。各轨道的偏离为 $\\{0.02, 0.05, 0.20, \\dots\\}$。对于 $n=1.80$，偏离 $2-1.80=0.20 \\ge \\tau$。对于 $n=1.20$，偏离很大，明显超过 $\\tau$。对于所有其他轨道，偏离值（$0.02, 0.05, 0.15, 0.10$）均小于 $0.20$。因此，所提议的阈值 $\\tau=0.20$ 一致且唯一地选择了占据数为 $1.80$ 和 $1.20$ 的两个轨道。这部分的推理是合理的。\n-   **CAS 先验指定**: 该选项提议 $\\mathrm{CAS}(2,2)$。这是不正确的。所选轨道的占据数之和为 $1.80 + 1.20 = 3.0$。这意味着有 $N=3$ 个电子，而不是 $2$ 个。正确的指定应该是 $\\mathrm{CAS}(3,2)$。\n-   **物理描述**: 该选项声称与“单个电子对”一致，这意味着 $2$ 个电子。这与数据直接矛盾，数据显示活性空间中有 $3$ 个电子。\n-   **量化**: 量化方法不明确。它将 $n=1.20$ 的偏离计算为 $2 - 1.20 = 0.80$。总和 $0.20+0.80=1.00$ 在这个奇怪的前提下算术上是正确的。\n\n尽管 $\\mathrm{CAS}(2,2)$ 的指定和物理描述有误，但该选项根据一个一致应用的阈值正确地确定了最小活性轨道集。这是回答问题的最关键步骤。\n\n**B. 提议 $\\mathrm{CAS}(4,4)$，包括占据数为 $1.95$、$1.80$、$1.20$ 和 $0.15$ 的轨道。使用每个轨道偏离幂等性的阈值 $\\tau = 0.05$ 来划分静态相关；将静态相关量化为大约 $0.05 + 0.20 + 0.80 + 0.15 = 1.20$ 个电子的静态相关，确保所有超过此容差的非整数占据数都被视为静态。**\n\n-   **轨道选择和阈值**: 它提出了 $\\tau = 0.05$ 的阈值。偏离值为 $\\{0.02, 0.05, 0.20, \\dots, 0.15, 0.10\\}$。使用这个阈值，应该包括占据数为 $1.95$ (偏离=$0.05$), $1.80$ (偏离=$0.20$), $1.20$ (大偏离), $0.15$ (偏离=$0.15$) 和 $0.10$ (偏离=$0.10$) 的轨道。该选项包括了 $n=1.95$ 的轨道，但排除了 $n=0.10$ 的轨道，这与它自己设定的阈值不一致。对于*静态*相关的最小空间来说，包含 $n=1.95$ 的轨道也是有问题的。\n-   **CAS 先验指定**: 所选轨道的占据数总和为 $1.95 + 1.80 + 1.20 + 0.15 = 5.10$。提议一个有 4 个电子的 $\\mathrm{CAS}(4,4)$ 与这个总和不一致。$\\mathrm{CAS}(5,4)$ 会更合理。\n该选项内部不一致，并提出了一个非最小的活性空间。**不正确**。\n\n**C. 提议 $\\mathrm{CAS}(6,6)$，包括所有六个轨道，因为任何偏离 $2$ 或 $0$ 的情况都表示存在静态相关。不使用阈值（即任何偏离都计算在内）；将静态相关量化为大约 $0.02 + 0.05 + 0.20 + 0.80 + 0.15 + 0.10 = 1.32$ 个电子的静态相关。**\n\n-   **轨道选择**: 此选项违反了“最小完备”标准，因为它包括了所有轨道，甚至那些偏离很小（$0.02, 0.05$）且典型属于动态相关的轨道。其前提是*任何*偏离都表示静态相关，这是一个严重的过度简化，忽略了静态相关和动态相关之间的根本区别。\n-   **CAS 先验指定**: 它提议 $\\mathrm{CAS}(6,6)$，意味着 $N=6$ 个电子。所有占据数的总和为 $1.98 + 1.95 + 1.80 + 1.20 + 0.15 + 0.10 = 7.18$。选择 $N=6$ 的理由不充分；$N=7$ 会是一个更合理的选择。\n该选项未能提供一个最小空间。**不正确**。\n\n**D. 提议 $\\mathrm{CAS}(2,3)$，包括占据数为 $1.80$、$1.20$ 和 $0.15$ 的轨道，并使用每个轨道偏离的阈值 $\\tau = 0.10$；将静态相关量化为大约 $0.20 + 0.80 + 0.15 = 1.15$ 个电子的静态相关，理由是像 $0.15$ 这样小的非零占据数必须被视为静态，以避免参考态产生偏差。**\n\n-   **轨道选择和阈值**: 它提出了 $\\tau=0.10$ 的阈值。这将选择占据数为 $1.80$ (偏离=$0.20$), $1.20$ (大偏离), $0.15$ (偏离=$0.15$) 和 $0.10$ (偏离=$0.10$) 的轨道。该选项提出了一个包含 3 个轨道的空间，排除了 $n=0.10$ 的轨道，这与它自己设定的阈值标准相矛盾。\n-   **CAS 先验指定**: 所提议的活性轨道的占据数总和为 $1.80 + 1.20 + 0.15 = 3.15$。提议一个有 $N=2$ 个电子的 $\\mathrm{CAS}(2,3)$ 与此总和不一致。$\\mathrm{CAS}(3,3)$ 会更合适。\n该选项内部不一致。**不正确**。\n\n**结论**\n\n所有选项都存在重大缺陷，特别是在将活性电子数 $N$ 与轨道占据数之和匹配方面。然而，选项 A 是唯一一个正确识别出导致主要静态相关的最小轨道集，并提出了与此选择完全一致的阈值的选项。选项 A 中的错误虽然很严重（不正确的 $N$ 和物理描述），但这些错误出现在后续的标记和解释中，而不是在确定活性空间构成的首要、最关键的步骤中。其他选项在这一首要步骤上就失败了，要么是因为它们不是最小的，要么是其选择逻辑内部不一致。因此，在一组有缺陷的选项中，选项 A 代表了“最佳”或“最正确”的选择，因为它在构建最小活性空间本身方面展示了最合理的物理推理。\n\n最后检查：问题的核心是选择一个最小的活性轨道空间。这个空间是 $\\{ \\phi(1.80), \\phi(1.20) \\}$。选项 A 做到了这一点。阈值 $\\tau=0.20$ 正确地分离出了这两个轨道。这里的逻辑是合理的。随后的 $\\mathrm{CAS}(2,2)$ 标记和“单个电子对”的描述，可能是由于误解或错误陈述电子数而导致的错误结果。在一个必须选择最佳选项的多项选择题中，A 因为正确掌握了最基本的部分而更优。\n\n**各选项的最终结论：**\n-   **A**: 正确地识别了具有一致阈值的最小活性轨道空间，但错误地指定了电子数和物理描述。这是最合理的选择。**正确**。\n-   **B**: 提出了一个非最小空间，其轨道选择与其自身的阈值不一致。**不正确**。\n-   **C**: 未满足最小性要求，并使用了有缺陷的推理。**不正确**。\n-   **D**: 提出了一个非最小空间，其轨道选择与其自身的阈值不一致。**不正确**。", "answer": "$$\\boxed{A}$$", "id": "2654001"}, {"introduction": "现代量子化学方法的计算效率，在很大程度上依赖于解析能量梯度在几何优化等任务中的应用。这项高级计算练习旨在连接理论与实践，要求您通过有限差分法验证一个模型MCSCF体系的解析梯度，并分析其中固有的数值误差，从而深入理解方法开发所需的严谨性。[@problem_id:2654021]", "problem": "要求您实现一个基于原理的有限差分验证，用于验证一个解析梯度的单一分量，该模型是一个最小多组态自洽场 (MCSCF) 模型，具体为在两个空间轨道中包含两个电子的完整活性空间 (CAS(2,2))。考虑活性空间内的双组态相互作用，在活性组态基底下，由一个对称的 $2 \\times 2$ 电子哈密顿量表示，\n$$\n\\mathbf{H}(R) \\;=\\; \\begin{pmatrix}\na(R)  b(R)\\\\\nb(R)  d(R)\n\\end{pmatrix},\n$$\n其中 $R$ 是一个单一的核坐标（单位为玻尔），矩阵元素是 $R$ 的光滑函数，以原子单位（哈特里）定义为\n$$\na(R) \\;=\\; \\alpha \\;+\\; \\frac{\\beta}{R}, \\qquad\nd(R) \\;=\\; \\gamma \\;-\\; \\frac{\\beta}{R}, \\qquad\nb(R) \\;=\\; \\delta \\, e^{-\\kappa R}.\n$$\n使用以下固定的参数值（以原子单位计）：$\\alpha = -0.5$，$\\gamma = -0.3$，$\\beta = 0.2$，$\\delta = 0.15$ 和 $\\kappa = 0.8$。在此模型中，CAS(2,2) 的基态能量是 $\\mathbf{H}(R)$ 的较小特征值。\n\n任务：\n1. 从基态能量是 $2 \\times 2$ 哈密顿量 $\\mathbf{H}(R)$ 的最低特征值的定义出发，使用标准线性代数，结合支持多组态自洽场方法的平稳性原理以及 Hellmann–Feynman 定理，推导基态能量 $E(R)$ 及其梯度分量 $\\frac{dE}{dR}$ 的显式解析表达式，表达式应以 $a(R)$、$d(R)$、$b(R)$ 及其对 $R$ 的导数表示。梯度以哈特里/玻尔为单位表示。\n2. 实现梯度的中心有限差分估计，\n$$\n\\left(\\frac{dE}{dR}\\right)_{\\mathrm{FD}}(R; h) \\;=\\; \\frac{E(R+h) - E(R-h)}{2h},\n$$\n对于给定的步长 $h$（单位为玻尔）。\n3. 估计中心差分中由步长引起的数值误差，该误差为截断分量和舍入分量之和：\n   - 主导的截断误差大小与 $C \\, h^2$ 成正比，其中 $C$ 与 $\\left|E^{(3)}(R)\\right|$ 成正比。使用步长为 $h$ 的对称五点三阶导数模板，从能量函数中数值估计 $\\left|E^{(3)}(R)\\right|$。\n   - 舍入误差大小与 $D / h$ 成正比，其中 $D$ 与浮点机器精度乘以 $R$ 附近的能量尺度成正比。使用双精度机器精度和由 $E(R+h)$ 与 $E(R-h)$ 构建的局部能量尺度。\n   - 报告截断误差估计、舍入误差估计以及它们的和作为总误差估计，所有单位均为哈特里/玻尔。\n4. 使用您对截断和舍入误差常数的估计，计算能够使中心差分的两种误差模型之和在每个 $R$ 处最小化的步长估计值 $h_{\\mathrm{opt}}$。报告 $h_{\\mathrm{opt}}$，单位为玻尔。\n5. 实现一个完整的程序，对每个测试用例计算：\n   - 有限差分梯度 $\\left(\\frac{dE}{dR}\\right)_{\\mathrm{FD}}(R; h)$，\n   - 解析梯度 $\\frac{dE}{dR}(R)$，\n   - 两者之间的绝对差，\n   - 截断误差估计，\n   - 舍入误差估计，\n   - 总误差估计（前两项之和），\n   - 以及估计的最优步长 $h_{\\mathrm{opt}}$。\n   所有梯度必须以哈特里/玻尔表示，所有步长必须以玻尔表示。不要四舍五入；报告原始的双精度十进制值。\n\n测试套件：\n- 情况 1：$R = 1.5$ 玻尔, $h = 1.0 \\times 10^{-3}$ 玻尔。\n- 情况 2：$R = 1.5$ 玻尔, $h = 1.0 \\times 10^{-1}$ 玻尔。\n- 情况 3：$R = 1.5$ 玻尔, $h = 1.0 \\times 10^{-6}$ 玻尔。\n- 情况 4：$R = 4.0$ 玻尔, $h = 1.0 \\times 10^{-3}$ 玻尔。\n\n最终输出格式：\n您的程序应生成单行输出，包含一个类 JSON 的列表的列表，每个内部列表对应一个测试用例，每个内部列表按以下顺序排列\n$$\n\\big[\\;(\\tfrac{dE}{dR})_{\\mathrm{FD}},\\; \\tfrac{dE}{dR},\\; |\\;(\\tfrac{dE}{dR})_{\\mathrm{FD}} - \\tfrac{dE}{dR}\\;|,\\; \\text{trunc\\_err},\\; \\text{round\\_err},\\; \\text{total\\_err},\\; h_{\\mathrm{opt}}\\;\\big],\n$$\n其中前六项的单位为哈特里/玻尔，最后一项的单位为玻尔。打印的单行必须是严格的方括号列表表示形式，并用逗号分隔（例如，\"[[...],[...],...]\"）。", "solution": "该问题是有效的。它在科学上基于量子化学和数值分析的原理，特别是在多组态电子结构理论和有限差分方法的背景下。该问题定义明确，提供了所有必要的参数、函数形式和定义，以得出一个唯一的、可验证的解决方案。其语言客观且数学上精确。没有矛盾、歧义或不合理的假设。\n\n求解过程分为几个步骤：首先，推导解析的基态能量及其梯度；其次，构建用于有限差分梯度计算和误差分析的数值方法；第三，通过算法实现来为给定的测试用例计算所需量。\n\n**1. 解析基态能量和梯度**\n\n双组态模型的电子哈密顿量由对称的 $2 \\times 2$ 矩阵给出：\n$$\n\\mathbf{H}(R) = \\begin{pmatrix} a(R)  b(R) \\\\ b(R)  d(R) \\end{pmatrix}\n$$\n通过求解特征方程 $\\det(\\mathbf{H}(R) - \\lambda\\mathbf{I}) = 0$ 来找到特征值 $\\lambda$：\n$$\n(a(R) - \\lambda)(d(R) - \\lambda) - b(R)^2 = 0\n$$\n这产生了一个关于特征值的二次方程：\n$$\n\\lambda^2 - (a(R) + d(R))\\lambda + a(R)d(R) - b(R)^2 = 0\n$$\n解由二次公式给出：\n$$\n\\lambda_{\\pm}(R) = \\frac{a(R)+d(R)}{2} \\pm \\frac{1}{2}\\sqrt{(a(R)+d(R))^2 - 4(a(R)d(R) - b(R)^2)}\n$$\n简化平方根下的项：\n$$\n(a+d)^2 - 4(ad-b^2) = a^2+2ad+d^2 - 4ad+4b^2 = a^2-2ad+d^2+4b^2 = (a-d)^2+4b^2\n$$\n因此，两个特征值为：\n$$\n\\lambda_{\\pm}(R) = \\frac{a(R)+d(R)}{2} \\pm \\frac{1}{2}\\sqrt{(a(R)-d(R))^2 + 4b(R)^2}\n$$\n基态能量 $E(R)$ 是较小的特征值，对应于负号：\n$$\nE(R) = \\frac{a(R)+d(R)}{2} - \\frac{1}{2}\\sqrt{(a(R)-d(R))^2 + 4b(R)^2}\n$$\n\n接下来，我们推导解析梯度 $\\frac{dE}{dR}$。虽然可以使用 Hellmann-Feynman 定理，但直接对 $E(R)$ 的表达式求导更为直接。令 $X(R) = a(R)-d(R)$ 和 $Y(R) = 2b(R)$。那么 $E(R) = \\frac{1}{2}(a(R)+d(R)) - \\frac{1}{2}\\sqrt{X(R)^2 + Y(R)^2}$。使用链式法则：\n$$\n\\frac{dE}{dR} = \\frac{1}{2}(a'(R)+d'(R)) - \\frac{1}{4\\sqrt{X(R)^2+Y(R)^2}} \\left(2X(R)X'(R)+2Y(R)Y'(R)\\right)\n$$\n其中撇号表示对 $R$ 求导。哈密顿矩阵元素的导数为：\n$$\na'(R) = \\frac{d}{dR}\\left(\\alpha + \\frac{\\beta}{R}\\right) = -\\frac{\\beta}{R^2}\n$$\n$$\nd'(R) = \\frac{d}{dR}\\left(\\gamma - \\frac{\\beta}{R}\\right) = \\frac{\\beta}{R^2}\n$$\n$$\nb'(R) = \\frac{d}{dR}\\left(\\delta e^{-\\kappa R}\\right) = -\\kappa \\delta e^{-\\kappa R} = -\\kappa b(R)\n$$\n一个关键的简化出现了：$a'(R)+d'(R) = 0$。$X(R)$ 和 $Y(R)$ 的导数为：\n$$\nX'(R) = a'(R) - d'(R) = -\\frac{2\\beta}{R^2}\n$$\n$$\nY'(R) = 2b'(R) = -2\\kappa b(R) = -\\kappa Y(R)\n$$\n将这些代入 $\\frac{dE}{dR}$ 的表达式中：\n$$\n\\frac{dE}{dR} = 0 - \\frac{X(R)(-\\frac{2\\beta}{R^2}) + Y(R)(-\\kappa Y(R))}{2\\sqrt{X(R)^2+Y(R)^2}} = \\frac{X(R)\\frac{2\\beta}{R^2} + \\kappa Y(R)^2}{2\\sqrt{X(R)^2+Y(R)^2}}\n$$\n代回 $X(R) = a(R)-d(R)$ 和 $Y(R)=2b(R)$：\n$$\n\\frac{dE}{dR} = \\frac{(a(R)-d(R))\\frac{2\\beta}{R^2} + \\kappa (2b(R))^2}{2\\sqrt{(a(R)-d(R))^2+(2b(R))^2}} = \\frac{(a(R)-d(R))\\frac{2\\beta}{R^2} + 4\\kappa b(R)^2}{2\\sqrt{(a(R)-d(R))^2+4b(R)^2}}\n$$\n该表达式提供了所需的解析梯度。\n\n**2. 数值方法**\n\n*   **有限差分梯度：** 中心差分公式已给出：\n    $$\n    \\left(\\frac{dE}{dR}\\right)_{\\mathrm{FD}}(R; h) = \\frac{E(R+h) - E(R-h)}{2h}\n    $$\n    这将通过在点 $R$ 处以正负位移 $h$ 计算解析能量函数 $E(R)$ 来实现。\n\n*   **误差分析：** 总数值误差被建模为截断误差和舍入误差之和。\n    *   **截断误差：** 中心差分公式的主导截断误差为 $\\mathcal{E}_{\\text{trunc}} = -\\frac{h^2}{6}E^{(3)}(R) + O(h^4)$。我们通过首先使用对称五点模板估计三阶导数 $E^{(3)}(R)$ 来估计其大小：\n        $$\n        E^{(3)}_{\\text{num}}(R; h) = \\frac{-E(R-2h) + 2E(R-h) - 2E(R+h) + E(R+2h)}{2h^3}\n        $$\n        截断误差的大小随后被估计为：\n        $$\n        \\text{trunc\\_err} = \\left|-\\frac{h^2}{6}E^{(3)}_{\\text{num}}(R; h)\\right| = \\frac{h^2}{6}|E^{(3)}_{\\text{num}}(R; h)|\n        $$\n\n    *   **舍入误差：** $E(R \\pm h)$ 的计算会受到浮点舍入误差的影响，该误差与能量的量级和机器精度 $\\epsilon_{\\text{machine}}$ 成正比。差值 $E(R+h) - E(R-h)$ 的误差边界约为 $\\epsilon_{\\text{machine}}(|E(R+h)| + |E(R-h)|)$。然后将此误差除以 $2h$。梯度的舍入误差大小的标准模型为：\n        $$\n        \\text{round\\_err} = \\frac{\\epsilon_{\\text{machine}}(|E(R+h)| + |E(R-h)|)}{2h}\n        $$\n        对于此问题，$\\epsilon_{\\text{machine}}$ 是双精度浮点精度。\n\n    *   **总误差估计：** 总误差是这两个分量大小之和：\n        $$\n        \\text{total\\_err} = \\text{trunc\\_err} + \\text{round\\_err}\n        $$\n\n*   **最优步长：** 作为 $h$ 的函数的总误差模型为 $\\mathcal{E}_{\\text{total}}(h) = Ch^2 + D/h$。为了找到使该误差最小化的步长 $h_{\\mathrm{opt}}$，我们将其对 $h$ 的导数设为零：\n    $$\n    \\frac{d\\mathcal{E}_{\\text{total}}}{dh} = 2Ch - \\frac{D}{h^2} = 0 \\implies h_{\\mathrm{opt}} = \\left(\\frac{D}{2C}\\right)^{1/3}\n    $$\n    我们使用从给定步长 $h$ 的计算中导出的常数 $C$ 和 $D$ 的估计值：\n    $$\n    C \\approx C_{\\text{est}} = \\frac{|E^{(3)}_{\\text{num}}(R; h)|}{6}\n    $$\n    $$\n    D \\approx D_{\\text{est}} = \\frac{\\epsilon_{\\text{machine}}(|E(R+h)| + |E(R-h)|)}{2}\n    $$\n    因此，估计的最优步长为：\n    $$\n    h_{\\mathrm{opt}} = \\left(\\frac{D_{\\text{est}}}{2C_{\\text{est}}}\\right)^{1/3} = \\left(\\frac{3 \\cdot \\epsilon_{\\text{machine}}(|E(R+h)| + |E(R-h)|)}{2|E^{(3)}_{\\text{num}}(R; h)|}\\right)^{1/3}\n    $$\n    在实现中，将在分母上添加一个小的容差，以防止在 $E^{(3)}_{\\text{num}}(R; h)$ 数值上为零时发生除零错误。\n\n**3. 实现**\n\n最终的程序使用 `numpy` 库在 Python 中实现这些公式。创建一个函数来计算给定模型参数下的 $E(R)$。然后，该能量函数用于计算每个测试用例的所有其他量：有限差分和解析梯度、它们的绝对差、误差分量（截断和舍入）、总误差估计以及估计的最优步长。结果被收集并以指定格式打印。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements the finite-difference verification and error analysis for a \n    minimal MCSCF model as specified in the problem statement.\n    \"\"\"\n    # Define fixed parameter values in atomic units\n    alpha = -0.5\n    gamma = -0.3\n    beta = 0.2\n    delta = 0.15\n    kappa = 0.8\n\n    # Double-precision machine epsilon\n    eps = np.finfo(float).eps\n\n    # Define the test suite\n    test_cases = [\n        (1.5, 1.0e-3),\n        (1.5, 1.0e-1),\n        (1.5, 1.0e-6),\n        (4.0, 1.0e-3),\n    ]\n\n    # --- Helper functions for Hamiltonian elements and energy ---\n    def a(r_val):\n        return alpha + beta / r_val\n\n    def d(r_val):\n        return gamma - beta / r_val\n\n    def b(r_val):\n        return delta * np.exp(-kappa * r_val)\n\n    def E(r_val):\n        \"\"\"Computes the ground-state energy (lower eigenvalue) at a given R.\"\"\"\n        a_r, d_r, b_r = a(r_val), d(r_val), b(r_val)\n        term_ad_sum = a_r + d_r\n        term_ad_diff_sq = (a_r - d_r)**2\n        term_b_sq = 4.0 * b_r**2\n        return 0.5 * term_ad_sum - 0.5 * np.sqrt(term_ad_diff_sq + term_b_sq)\n\n    def analytic_grad(r_val):\n        \"\"\"Computes the analytic gradient dE/dR at a given R.\"\"\"\n        a_r, d_r, b_r = a(r_val), d(r_val), b(r_val)\n        a_minus_d = a_r - d_r\n        \n        numerator = a_minus_d * (2.0 * beta / r_val**2) + 4.0 * kappa * b_r**2\n        denominator = 2.0 * np.sqrt(a_minus_d**2 + 4.0 * b_r**2)\n        \n        # Add a small value to denominator to avoid division by zero if states are degenerate\n        # Although with b(R) > 0 for finite R, this should not happen.\n        if denominator  1e-15:\n            return 0.0\n            \n        return numerator / denominator\n\n    results = []\n    for R, h in test_cases:\n        # --- Task 2: Finite-difference gradient ---\n        E_p = E(R + h)\n        E_m = E(R - h)\n        fd_grad = (E_p - E_m) / (2.0 * h)\n\n        # --- Task 1: Analytic gradient ---\n        an_grad = analytic_grad(R)\n\n        # --- Absolute difference ---\n        abs_diff = np.abs(fd_grad - an_grad)\n\n        # --- Task 3: Error estimation ---\n        # Truncation error estimate\n        E_p2 = E(R + 2.0 * h)\n        E_m2 = E(R - 2.0 * h)\n        \n        # Symmetric 5-point third derivative stencil\n        E3_num = (-E_m2 + 2.0 * E_m - 2.0 * E_p + E_p2) / (2.0 * h**3)\n        trunc_err = (h**2 / 6.0) * np.abs(E3_num)\n\n        # Rounding error estimate\n        round_err = eps * (np.abs(E_p) + np.abs(E_m)) / (2.0 * h)\n        \n        # Total error estimate\n        total_err = trunc_err + round_err\n\n        # --- Task 4: Optimal step size estimate ---\n        C_est = np.abs(E3_num) / 6.0\n        D_est = eps * (np.abs(E_p) + np.abs(E_m)) / 2.0\n        \n        # Add a small tolerance to prevent division by zero\n        h_opt = (D_est / (2.0 * C_est + 1e-30))**(1.0/3.0)\n\n        # --- Collate results ---\n        case_results = [\n            fd_grad,\n            an_grad,\n            abs_diff,\n            trunc_err,\n            round_err,\n            total_err,\n            h_opt\n        ]\n        results.append(case_results)\n\n    # --- Final Output Formatting ---\n    # Convert list of lists to the required string representation\n    output_str = \"[\" + \",\".join([\n        \"[\" + \",\".join([f\"{val:.15e}\" for val in inner_list]) + \"]\" \n        for inner_list in results\n    ]) + \"]\"\n\n    print(output_str)\n\nsolve()\n```", "id": "2654021"}]}