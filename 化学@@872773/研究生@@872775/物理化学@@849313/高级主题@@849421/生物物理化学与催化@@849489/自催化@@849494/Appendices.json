{"hands_on_practices": [{"introduction": "理论学习的下一步是将其付诸实践。我们从一个基础但至关重要的练习开始：在封闭的批式反应器中求解一个简单的自催化反应的动力学方程。通过从质量作用定律和质量守恒出发，直接积分速率方程，您将亲手推导出反应物浓度随时间变化的S型曲线背后的数学形式。这项练习不仅能巩固您对非线性动力学积分的技能，还能让您深入理解自催化反应标志性的“诱导期”是如何依赖于初始催化剂（产物）浓度的，正如在 [@problem_id:2624643] 中所探讨的。", "problem": "一个混合均匀、恒温、恒容的间歇式反应器中，浓度分别为 $A(t)$ 和 $X(t)$ 的物种正在发生自催化反应 $A+X \\xrightarrow{k} 2X$，该反应遵循二级速率定律 $r(t)=k\\,A(t)\\,X(t)$，其中 $k>0$ 是速率常数。假设没有副反应，没有逆反应，且质量作用动力学定律精确成立。在 $t=0$ 时的初始浓度为 $A(0)=A_{0}>0$ 和 $X(0)=X_{0}>0$，且系统是封闭的，因此总摩尔数守恒。考虑 $0", "solution": "所述问题具有科学依据、提法恰当且客观。它呈现了化学动力学中一个可以使用基本原理解答的标准情景。所提供的信息是完整且一致的。因此，我们可以开始进行推导。\n\n自催化反应为 $A+X \\xrightarrow{k} 2X$。根据此二级过程的质量作用定律，反应速率 $r(t)$ 为 $r(t)=k\\,A(t)\\,X(t)$，其中 $A(t)$ 和 $X(t)$ 分别是物种 $A$ 和 $X$ 在时间 $t$ 的浓度，而 $k$ 是速率常数。\n\n浓度的变化率由反应的化学计量关系推导得出。每消耗一摩尔的 $A$，就会消耗一摩尔的 $X$ 并生成两摩尔的 $X$，从而净生成一摩尔的 $X$。\n相应的微分速率方程为：\n$$\n\\frac{dA}{dt} = -k\\,A(t)\\,X(t)\n$$\n$$\n\\frac{dX}{dt} = +k\\,A(t)\\,X(t)\n$$\n将这两个方程相加，得到：\n$$\n\\frac{dA}{dt} + \\frac{dX}{dt} = \\frac{d}{dt}(A(t) + X(t)) = -k\\,A(t)\\,X(t) + k\\,A(t)\\,X(t) = 0\n$$\n该方程意味着 $A$ 和 $X$ 的浓度之和是一个守恒量。我们可以将此方程对时间从 $t=0$ 积分到任意时间 $t$：\n$$\nA(t) + X(t) = \\text{constant}\n$$\n使用初始条件 $A(0) = A_{0}$ 和 $X(0) = X_{0}$，我们求得该常数的值：\n$$\nA(t) + X(t) = A_{0} + X_{0}\n$$\n该守恒定律对所有时间 $t \\ge 0$ 成立。我们可以用它来将 $A(t)$ 表示为 $X(t)$ 的函数：\n$$\nA(t) = (A_{0} + X_{0}) - X(t)\n$$\n将这个 $A(t)$ 的表达式代入 $X(t)$ 的速率方程，得到一个只含 $X(t)$ 的微分方程：\n$$\n\\frac{dX}{dt} = k\\,X(t)\\,[(A_{0} + X_{0}) - X(t)]\n$$\n这是一个一阶、非线性、可分离变量的常微分方程。我们可以分离变量以准备积分：\n$$\n\\frac{dX}{X(t)\\,[(A_{0} + X_{0}) - X(t)]} = k\\,dt\n$$\n为了对左边进行积分，我们使用部分分式分解法。设初始总浓度为 $C_{total} = A_{0} + X_{0}$。被积函数为 $\\frac{1}{X(C_{total} - X)}$。\n$$\n\\frac{1}{X(C_{total} - X)} = \\frac{P}{X} + \\frac{Q}{C_{total} - X}\n$$\n解出系数可得 $P=Q=\\frac{1}{C_{total}}$。因此：\n$$\n\\frac{1}{C_{total}}\\left(\\frac{1}{X} + \\frac{1}{C_{total} - X}\\right)dX = k\\,dt\n$$\n我们对两边进行积分，从 $t=0$ 时的初始状态（此时 $X=X_{0}$）到时间 $t$ 时的状态（此时浓度为 $X(t)$）：\n$$\n\\frac{1}{A_{0} + X_{0}} \\int_{X_{0}}^{X(t)} \\left(\\frac{1}{X'} + \\frac{1}{(A_{0} + X_{0}) - X'}\\right) dX' = \\int_{0}^{t} k\\,dt'\n$$\n反应过程中，$X$ 从 $X_0$ 增加到 $A_0+X_0$，同时 $A$ 从 $A_0$ 减少到 $0$。在我们关心的范围内，$X(t)$ 和 $A(t)=(A_0+X_0)-X(t)$ 均为正值，因此我们可以在对数中省略绝对值符号。\n$$\n\\frac{1}{A_{0} + X_{0}} \\left[ \\ln(X') - \\ln((A_{0} + X_{0}) - X') \\right]_{X_{0}}^{X(t)} = k[t']_{0}^{t}\n$$\n$$\n\\frac{1}{A_{0} + X_{0}} \\left[ \\ln\\left(\\frac{X(t)}{(A_{0} + X_{0}) - X(t)}\\right) - \\ln\\left(\\frac{X_{0}}{(A_{0} + X_{0}) - X_{0}}\\right) \\right] = kt\n$$\n注意到 $(A_{0} + X_{0}) - X(t) = A(t)$ 以及 $(A_{0} + X_{0}) - X_{0} = A_{0}$，我们可以简化表达式：\n$$\n\\frac{1}{A_{0} + X_{0}} \\left[ \\ln\\left(\\frac{X(t)}{A(t)}\\right) - \\ln\\left(\\frac{X_{0}}{A_{0}}\\right) \\right] = kt\n$$\n$$\nkt = \\frac{1}{A_{0} + X_{0}} \\ln\\left(\\frac{A_{0}X(t)}{A(t)X_{0}}\\right)\n$$\n题目要求我们求出 $X(t)$ 达到值 $\\frac{A_{0}+X_{0}}{2}$ 的时间 $t_{1/2}$。让我们评估系统在这个特定时间的状态。\n在 $t=t_{1/2}$ 时，我们有 $X(t_{1/2}) = \\frac{A_{0}+X_{0}}{2}$。\n根据守恒定律，此时 $A$ 的浓度为：\n$$\nA(t_{1/2}) = (A_{0} + X_{0}) - X(t_{1/2}) = (A_{0} + X_{0}) - \\frac{A_{0}+X_{0}}{2} = \\frac{A_{0}+X_{0}}{2}\n$$\n因此，在时间 $t_{1/2}$，$A$ 和 $X$ 的浓度相等：$A(t_{1/2}) = X(t_{1/2})$。比值 $\\frac{X(t_{1/2})}{A(t_{1/2})} = 1$。\n将此条件代入我们的积分速率方程中：\n$$\nk t_{1/2} = \\frac{1}{A_{0} + X_{0}} \\ln\\left(\\frac{A_{0}}{X_{0}} \\cdot \\frac{X(t_{1/2})}{A(t_{1/2})}\\right) = \\frac{1}{A_{0} + X_{0}} \\ln\\left(\\frac{A_{0}}{X_{0}} \\cdot 1\\right)\n$$\n解出 $t_{1/2}$，我们得到最终的表达式：\n$$\nt_{1/2} = \\frac{1}{k(A_{0}+X_{0})} \\ln\\left(\\frac{A_{0}}{X_{0}}\\right)\n$$\n题目的约束条件 $0", "answer": "$$\n\\boxed{\\frac{1}{k(A_{0}+X_{0})} \\ln\\left(\\frac{A_{0}}{X_{0}}\\right)}\n$$", "id": "2624643"}, {"introduction": "在掌握了封闭系统的基础后，我们将探索自催化在开放系统（如连续搅拌釜反应器，CSTR）中如何引发更复杂的行为。与最终达到平衡的批式反应器不同，开放系统可以达到非平衡的稳态。这个练习 [@problem_id:2624731] 将引导您分析一个包含自催化反应的CSTR，您将发现系统可以存在多个稳态，包括反应完全“熄灭”的状态和持续进行的“点燃”状态。通过计算雅可比矩阵的特征值来进行线性稳定性分析，您将学会判断这些稳态的稳定性，这是化学反应工程和非线性动力学中的一个核心技能。", "problem": "考虑一个恒定体积的等温、理想混合连续搅拌釜反应器（CSTR），其中进行自催化反应 $\\mathrm{A} + \\mathrm{X} \\to 2\\,\\mathrm{X}$。该反应遵循质量作用速率 $r = k a x$，其中 $a$ 和 $x$ 分别表示物种 $\\mathrm{A}$ 和 $\\mathrm{X}$ 的浓度，$k>0$ 是速率常数。反应器的进料体积流量使得停留时间为 $\\tau>0$，物种 $\\mathrm{A}$ 的进料浓度为 $a_f>0$，物种 $\\mathrm{X}$ 的进料浓度为 $x_f = 0$。假设密度恒定且混合理想。确定性物种平衡方程为\n$$\n\\frac{d a}{d t} = \\frac{a_f - a}{\\tau} - k a x,\\qquad\n\\frac{d x}{d t} = \\frac{x_f - x}{\\tau} + k a x,\n$$\n其中 $x_f = 0$。\n\n从这些平衡方程和质量作用定律出发，完成以下任务：\n- 推导反应器的所有稳态 $(a^{*}, x^{*})$。\n- 在每个稳态点附近将动力学系统线性化，以获得雅可比矩阵 $J(a^{*}, x^{*})$。\n- 计算在 $x^{*} = 0$ 的稳态和 $x^{*} > 0$ 的稳态（当此状态存在时）下 $J(a^{*}, x^{*})$ 的特征值，并用它们的符号来评估每种情况下的局部稳定性。您必须以 $k$、$a_f$ 和 $\\tau$ 的函数形式给出特征值的闭式解。\n\n答案规格：\n- 将四个特征值按 $\\lambda_{0,1}$、$\\lambda_{0,2}$（对应于 $x^{*}=0$ 的稳态）和 $\\lambda_{+,1}$、$\\lambda_{+,2}$（对应于 $x^{*}>0$ 的稳态）的顺序列出，并使用 $\\mathrm{pmatrix}$ 表示法写成一个单行矩阵。\n- 以 $\\mathrm{s}^{-1}$ 为单位表示特征值。\n- 无需进行数值代入或四舍五入；仅提供精确的符号表达式。", "solution": "所述问题是在化学反应工程和非线性动力学领域中一个适定的、有科学依据的练习。它基于质量平衡和质量作用动力学的基本原理，在数学上是自洽的，并且有唯一且可验证的解。我们开始进行推导。\n\n物种 $\\mathrm{A}$ 和 $\\mathrm{X}$ 的浓度（分别表示为 $a(t)$ 和 $x(t)$）的动力学由以下常微分方程组描述：\n$$\n\\frac{d a}{d t} = \\frac{a_f - a}{\\tau} - k a x\n$$\n$$\n\\frac{d x}{d t} = -\\frac{x}{\\tau} + k a x\n$$\n此处，$a_f > 0$ 是 $\\mathrm{A}$ 的进料浓度，$\\tau > 0$ 是反应器停留时间，$k > 0$ 是反应速率常数。$\\mathrm{X}$ 的进料浓度给定为 $x_f = 0$。\n\n首先，我们通过将时间导数设为零来确定系统的稳态 $(a^*, x^*)$：\n$$\n\\frac{a_f - a^*}{\\tau} - k a^* x^* = 0 \\quad (1)\n$$\n$$\n-\\frac{x^*}{\\tau} + k a^* x^* = 0 \\quad (2)\n$$\n从方程 $(2)$ 中，我们可以提出公因子 $x^*$：\n$$\nx^* \\left( k a^* - \\frac{1}{\\tau} \\right) = 0\n$$\n该方程对于稳态有两个可能的解。\n\n情况1：洗出稳态。\n第一个解是 $x^* = 0$。将其代入方程 $(1)$：\n$$\n\\frac{a_f - a^*}{\\tau} - k a^* (0) = 0 \\implies a_f - a^* = 0 \\implies a^* = a_f\n$$\n因此，第一个稳态是 $(a_0^*, x_0^*) = (a_f, 0)$。此状态对应于自催化剂 $\\mathrm{X}$ 被完全洗出，此时仅有物种 $\\mathrm{A}$ 以其进料浓度存在。\n\n情况2：反应稳态。\n第二个解来自因式分解后的方程 $(2)$ 中的另一个因子：\n$$\nk a^* - \\frac{1}{\\tau} = 0 \\implies a^* = \\frac{1}{k \\tau}\n$$\n我们将这个 $a^*$ 的值代回方程 $(1)$ 来求解 $x^*$：\n$$\n\\frac{a_f - (1/k\\tau)}{\\tau} - k \\left(\\frac{1}{k\\tau}\\right) x^* = 0\n$$\n$$\n\\frac{a_f}{\\tau} - \\frac{1}{k\\tau^2} - \\frac{x^*}{\\tau} = 0\n$$\n两边乘以 $\\tau$ 并重新整理可得：\n$$\nx^* = a_f - \\frac{1}{k\\tau}\n$$\n为使该稳态具有物理意义，浓度 $x^*$ 必须为非负。由于 $k, \\tau, a_f$ 均为正值，$a^*$ 总是正的。$x^* > 0$ 的条件要求 $a_f > 1/(k\\tau)$，这等价于条件 $k \\tau a_f > 1$。\n因此，第二个稳态是 $(a_+^*, x_+^*) = \\left(\\frac{1}{k\\tau}, a_f - \\frac{1}{k\\tau}\\right)$，它仅在 $k \\tau a_f > 1$ 时存在。\n\n接下来，我们通过计算雅可比矩阵 $J(a, x)$ 来线性化系统。设函数向量为 $\\mathbf{f}(a,x) = \\left( \\frac{a_f - a}{\\tau} - k a x, -\\frac{x}{\\tau} + k a x \\right)^T$。雅可比矩阵为：\n$$\nJ(a, x) = \\begin{pmatrix} \\frac{\\partial f_a}{\\partial a} & \\frac{\\partial f_a}{\\partial x} \\\\ \\frac{\\partial f_x}{\\partial a} & \\frac{\\partial f_x}{\\partial x} \\end{pmatrix} = \\begin{pmatrix} -\\frac{1}{\\tau} - kx & -ka \\\\ kx & -\\frac{1}{\\tau} + ka \\end{pmatrix}\n$$\n\n现在，我们在每个稳态点计算雅可比矩阵的值，以确定局部稳定性。\n\n对洗出稳态 $(a_f, 0)$ 的分析：\n将 $(a, x) = (a_f, 0)$ 代入雅可比矩阵：\n$$\nJ(a_f, 0) = \\begin{pmatrix} -\\frac{1}{\\tau} - k(0) & -ka_f \\\\ k(0) & -\\frac{1}{\\tau} + ka_f \\end{pmatrix} = \\begin{pmatrix} -\\frac{1}{\\tau} & -ka_f \\\\ 0 & ka_f - \\frac{1}{\\tau} \\end{pmatrix}\n$$\n因为这是一个上三角矩阵，所以其特征值即为对角线上的元素。\n洗出稳态的特征值为：\n$$\n\\lambda_{0,1} = -\\frac{1}{\\tau}\n$$\n$$\n\\lambda_{0,2} = k a_f - \\frac{1}{\\tau}\n$$\n为保证稳定性，所有特征值都必须有负实部。由于 $\\tau > 0$，$\\lambda_{0,1}$ 总是负的。$\\lambda_{0,2}$ 的符号取决于 $k \\tau a_f$ 的值。\n如果 $k \\tau a_f  1$，两个特征值都为负，洗出稳态是一个稳定节点。\n如果 $k \\tau a_f  1$，$\\lambda_{0,2}$ 变为正值，洗出稳态是一个不稳定鞍点。\n\n对反应稳态 $(\\frac{1}{k\\tau}, a_f - \\frac{1}{k\\tau})$ 的分析：\n该状态在 $k \\tau a_f  1$ 时存在。我们将 $(a_+^*, x_+^*) = (\\frac{1}{k\\tau}, a_f - \\frac{1}{k\\tau})$ 代入雅可比矩阵：\n$$\nJ(a_+^*, x_+^*) = \\begin{pmatrix} -\\frac{1}{\\tau} - k(a_f - \\frac{1}{k\\tau})  -k(\\frac{1}{k\\tau}) \\\\ k(a_f - \\frac{1}{k\\tau})  -\\frac{1}{\\tau} + k(\\frac{1}{k\\tau}) \\end{pmatrix}\n$$\n$$\nJ(a_+^*, x_+^*) = \\begin{pmatrix} -ka_f  -\\frac{1}{\\tau} \\\\ ka_f - \\frac{1}{\\tau}  0 \\end{pmatrix}\n$$\n特征值 $\\lambda$ 可通过特征方程 $\\det(J - \\lambda I) = 0$ 求得：\n$$\n\\det \\begin{pmatrix} -ka_f - \\lambda  -\\frac{1}{\\tau} \\\\ ka_f - \\frac{1}{\\tau}  -\\lambda \\end{pmatrix} = 0\n$$\n$$\n(-\\lambda)(-ka_f - \\lambda) - \\left(-\\frac{1}{\\tau}\\right)\\left(ka_f - \\frac{1}{\\tau}\\right) = 0\n$$\n$$\n\\lambda^2 + ka_f \\lambda + \\left(\\frac{ka_f}{\\tau} - \\frac{1}{\\tau^2}\\right) = 0\n$$\n根的和为 $\\lambda_{+,1} + \\lambda_{+,2} = -ka_f  0$。根的积为 $\\lambda_{+,1} \\lambda_{+,2} = \\frac{ka_f}{\\tau} - \\frac{1}{\\tau^2} = \\frac{k\\tau a_f - 1}{\\tau^2}$。由于该状态仅在 $k\\tau a_f  1$ 时存在，所以根的积为正。和为负且积为正意味着两个特征值都具有负实部。因此，反应稳态在其存在时总是局部稳定的。\n\n为了求出特征值的闭式解，我们求解这个二次方程：\n$$\n\\lambda = \\frac{-ka_f \\pm \\sqrt{(ka_f)^2 - 4\\left(\\frac{ka_f}{\\tau} - \\frac{1}{\\tau^2}\\right)}}{2}\n$$\n$$\n\\lambda = \\frac{-ka_f \\pm \\sqrt{k^2 a_f^2 - \\frac{4ka_f}{\\tau} + \\frac{4}{\\tau^2}}}{2}\n$$\n平方根下的项是一个完全平方：$(ka_f - \\frac{2}{\\tau})^2$。\n$$\n\\lambda = \\frac{-ka_f \\pm \\sqrt{\\left(ka_f - \\frac{2}{\\tau}\\right)^2}}{2} = \\frac{-ka_f \\pm \\left|ka_f - \\frac{2}{\\tau}\\right|}{2}\n$$\n这给出了两个特征值。我们通过去掉绝对值来得到两个解：\n$$\n\\lambda_{+,1} = \\frac{-ka_f + (ka_f - \\frac{2}{\\tau})}{2} = \\frac{-2/\\tau}{2} = -\\frac{1}{\\tau}\n$$\n$$\n\\lambda_{+,2} = \\frac{-ka_f - (ka_f - \\frac{2}{\\tau})}{2} = \\frac{-2ka_f + 2/\\tau}{2} = \\frac{1}{\\tau} - ka_f\n$$\n这就是反应稳态的两个特征值。如前所述，当 $k\\tau a_f  1$ 时，两者都为负。\n\n所要求的四个特征值是：\n对于 $x^*=0$ 的稳态：$\\lambda_{0,1} = -\\frac{1}{\\tau}$，$\\lambda_{0,2} = k a_f - \\frac{1}{\\tau}$。\n对于 $x^*0$ 的稳态：$\\lambda_{+,1} = -\\frac{1}{\\tau}$，$\\lambda_{+,2} = \\frac{1}{\\tau} - k a_f$。", "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{1}{\\tau}  k a_f - \\frac{1}{\\tau}  -\\frac{1}{\\tau}  \\frac{1}{\\tau} - k a_f \\end{pmatrix}}\n$$", "id": "2624731"}, {"introduction": "经典的化学动力学模型将浓度视为连续变量，但这在分子数量极少的系统中（例如在纳米技术或单个细胞内）可能不再适用。为了理解这些场景下的自催化，我们必须转向随机模型。这项高级实践 [@problem_id:2624746] 要求您超越确定性的速率方程，采用基于化学主方程的随机视角来分析一个从单分子开始的自催化反应。您将计算的不再是一个确定的诱导期，而是一个随机的“延迟时间”分布，这揭示了化学反应在分子层面固有的概率性，是理解生物化学开关和随机基因表达等前沿问题的关键一步。", "problem": "考虑一个充分混合、等温、等容的纳米反应器，其中唯一与化学相关的过程是在稀溶液条件下的自催化反应 $\\mathrm{A} + \\mathrm{X} \\to 2\\mathrm{X}$。假设采用基元质量作用动力学，并通过化学主方程进行随机性描述。设总体积为 $V$ 升，底物分子的初始数量为 $A_0$（无量纲计数），双分子速率常数为 $k$（单位为 $\\mathrm{M^{-1}\\,s^{-1}}$），自催化剂的初始数量为 $X(0)=1$ 个分子。定义滞后时间 $T_N$ 为自催化剂数量首次达到 $X=N$ 个分子时的随机首次通过时间（单位为秒）。假设底物不被补充，并且仅通过自催化反应消耗。对于相对于 $A_0$ 较小的目标 $N$，将底物浓度近似为在达到阈值 $N$ 之前保持恒定在物理上是合理的。\n\n仅从质量作用定律、化学主方程（CME）的定义以及通过 Avogadro's number $N_\\mathrm{A}=6.02214076\\times 10^{23}\\,\\mathrm{mol^{-1}}$ 在分子数和摩尔浓度之间进行转换出发，实现一个程序。该程序针对每个指定的参数集，在底物浓度恒定的近似下估计 $T_N$ 的分布，并报告 $\\alpha\\in\\{0.1,0.5,0.9\\}$ 时的 $\\alpha$-分位数。您的方法必须从第一性原理推导得出，可以通过对此近似下的CME进行精确计算，或者通过与CME一致的、统计上正确的随机模拟。所有时间必须以秒为单位表示，并四舍五入到六位小数。\n\n在达到阈值 $N$ 之前采用底物浓度恒定的近似，取底物摩尔浓度为 $[\\mathrm{A}]=A_0/(N_\\mathrm{A} V)$（单位为 $\\mathrm{M}$），因此单分子自催化倾向因子为 $\\lambda = k[\\mathrm{A}]$（单位为 $\\mathrm{s^{-1}}$）。使用此方法为 $T_N$ 的累积分布函数构建一个有原则的估计量，并计算所需的分位数。\n\n测试套件：\n- 案例1（正常路径）：$V=1\\times 10^{-15}\\,\\mathrm{L}$，$A_0=100$，$k=1.0\\times 10^{6}\\,\\mathrm{M^{-1}\\,s^{-1}}$，$N=10$。\n- 案例2（速率降低）：$V=1\\times 10^{-15}\\,\\mathrm{L}$，$A_0=100$，$k=5.0\\times 10^{5}\\,\\mathrm{M^{-1}\\,s^{-1}}$，$N=10$。\n- 案例3（体积减半）：$V=5\\times 10^{-16}\\,\\mathrm{L}$，$A_0=100$，$k=1.0\\times 10^{6}\\,\\mathrm{M^{-1}\\,s^{-1}}$，$N=10$。\n- 案例4（目标尺寸边界）：$V=1\\times 10^{-15}\\,\\mathrm{L}$，$A_0=100$，$k=1.0\\times 10^{6}\\,\\mathrm{M^{-1}\\,s^{-1}}$，$N=2$。\n\n您的程序应生成单行输出，包含每个案例的 $T_N$ 的 $0.1$、$0.5$ 和 $0.9$ 分位数，以秒为单位，四舍五入到六位小数，并聚合成一个用方括号括起来的逗号分隔列表，顺序为：案例1、案例2、案例3、案例4，每个案例按 $\\alpha=0.1,0.5,0.9$ 的顺序贡献三个分位数。例如，输出格式必须与 $[q_{1,0.1},q_{1,0.5},q_{1,0.9},q_{2,0.1},q_{2,0.5},q_{2,0.9},q_{3,0.1},q_{3,0.5},q_{3,0.9},q_{4,0.1},q_{4,0.5},q_{4,0.9}]$ 完全相同，其中每个 $q_{\\cdot,\\cdot}$ 是一个以秒为单位、四舍五入到六位小数的浮点数。", "solution": "问题陈述经评估后被确定为有效。它具有科学依据、问题明确、客观且内部一致。它提出了一个随机化学动力学中的标准问题，该问题可以按要求从第一性原理求解。\n\n我们的任务是，在一个恒定体积 $V$ 中，从 $X(0)=1$ 个分子开始，求解自催化反应 $\\mathrm{A} + \\mathrm{X} \\to 2\\mathrm{X}$ 的首次通过时间 $T_N$ 的分位数。分析将在底物浓度 $[\\mathrm{A}]$ 恒定的近似下进行。\n\n此随机过程的基本描述是化学主方程（CME）。化学反应事件的速率由倾向函数描述。对于双分子反应 $\\mathrm{A} + \\mathrm{X} \\to 2\\mathrm{X}$，根据质量作用定律，在含有 $n_A$ 个 $\\mathrm{A}$ 分子和 $n_X$ 个 $\\mathrm{X}$ 分子的系统中，发生单个反应事件的倾向函数 $a(n_A, n_X)$ 为：\n$$\na(n_A, n_X) = c \\cdot n_A \\cdot n_X\n$$\n其中 $c$ 是随机速率常数。该常数通过 $c = k / (N_\\mathrm{A} V)$ 与确定性速率常数 $k$（单位为 $\\mathrm{M^{-1}\\,s^{-1}}$）相关，其中 $N_\\mathrm{A}$ 是 Avogadro's number。因此，\n$$\na(n_A, n_X) = \\frac{k}{N_\\mathrm{A} V} n_A n_X\n$$\n问题规定，为了计算滞后时间 $T_N$，底物浓度应被视为其初始值 $[\\mathrm{A}]_0 = A_0 / (N_\\mathrm{A} V)$ 恒定，其中 $A_0$ 是底物分子的初始数量。这意味着倾向函数中底物分子数 $n_A$ 被视为常数，$n_A = A_0$。请注意，物种 $\\mathrm{A}$ 是被消耗的，因此这是一个在 $N \\ll A_0$ 时有效的近似。在此近似下，$\\mathrm{X}$ 分子数量增加一（一个“产生”事件）的倾向仅取决于当前 $\\mathrm{X}$ 分子的数量，我们将其表示为 $j$。设此倾向为 $a_j$：\n$$\na_j = \\frac{k}{N_\\mathrm{A} V} A_0 j\n$$\n我们根据问题陈述定义一个恒定速率参数 $\\lambda$：\n$$\n\\lambda = k [\\mathrm{A}]_0 = k \\frac{A_0}{N_\\mathrm{A} V}\n$$\n$\\lambda$ 的单位是 $\\mathrm{s^{-1}}$。产生事件的倾向现在可以写为：\n$$\na_j = \\lambda j\n$$\n这描述了一个纯生过程，也称为 Yule 过程。系统的状态完全由 $\\mathrm{X}$ 分子的数量来表征。\n\n滞后时间 $T_N$ 是从状态 $X(0)=1$ 开始达到状态 $N$ 的首次通过时间。该过程需要 $N-1$ 次连续的产生事件（从 $j=1$到 $j=2$，从 $j=2$ 到 $j=3$，...，从 $j=N-1$ 到 $j=N$）。总时间 $T_N$ 是这些步骤中每个步骤等待时间的总和：\n$$\nT_N = \\sum_{j=1}^{N-1} \\tau_j\n$$\n其中 $\\tau_j$ 是当系统处于状态 $j$（即拥有 $j$ 个 $\\mathrm{X}$ 分子）时，反应发生的随机等待时间。\n\n根据由CME描述的随机过程理论，任何给定状态下的等待时间是一个呈指数分布的随机变量。此指数分布的速率参数是离开该状态的总倾向。在我们的案例中，从 $j \\to j+1$ 转变的等待时间 $\\tau_j$ 服从速率为 $a_j = \\lambda j$ 的指数分布：\n$$\n\\tau_j \\sim \\mathrm{Exponential}(\\lambda j)\n$$\n随机变量 $\\tau_j$ 是相互独立的。因此，$T_N$ 是 $N-1$ 个独立但不同分布的指数随机变量之和。这样的和服从亚指数分布。\n\n$T_N$ 的累积分布函数（CDF），记为 $F_{T_N}(t)$，可以被系统地推导出来。$\\tau_j$ 的概率密度函数（PDF）的拉普拉斯变换是 $\\mathcal{L}_{\\tau_j}(s) = \\frac{\\lambda j}{s + \\lambda j}$。由于独立性，$T_N$ 的PDF的拉普拉斯变换是乘积：\n$$\n\\mathcal{L}_{T_N}(s) = \\prod_{j=1}^{N-1} \\mathcal{L}_{\\tau_j}(s) = \\prod_{j=1}^{N-1} \\frac{\\lambda j}{s + \\lambda j}\n$$\n通过对 $\\mathcal{L}_{T_N}(s)$ 进行部分分式展开，然后应用拉普拉斯逆变换，可以得到PDF，并通过积分得到CDF。对于这个特定的速率序列（$\\lambda, 2\\lambda, \\dots, (N-1)\\lambda$），一个已知的CDF的优雅表达式是：\n$$\nF_{T_N}(t) = (1 - e^{-\\lambda t})^{N-1}\n$$\n这可以通过证明亚指数CDF的通用公式 $F_{T_N}(t) = \\sum_{j=1}^{N-1} \\left( \\prod_{i=1, i\\neq j}^{N-1} \\frac{i}{i-j} \\right) (1-e^{-j\\lambda t})$，通过与二项式定理相关的组合恒等式，可以简化为 $(1-e^{-\\lambda t})^{N-1}$ 来证实。\n\n为了找到分布的 $\\alpha$-分位数，记为 $t_\\alpha$，我们必须求解方程 $F_{T_N}(t_\\alpha) = \\alpha$ 以得到 $t_\\alpha$：\n$$\n(1 - e^{-\\lambda t_\\alpha})^{N-1} = \\alpha\n$$\n求解 $t_\\alpha$ 的过程如下：\n$$\n1 - e^{-\\lambda t_\\alpha} = \\alpha^{\\frac{1}{N-1}}\n$$\n$$\ne^{-\\lambda t_\\alpha} = 1 - \\alpha^{\\frac{1}{N-1}}\n$$\n$$\n-\\lambda t_\\alpha = \\ln\\left(1 - \\alpha^{\\frac{1}{N-1}}\\right)\n$$\n$$\nt_\\alpha = -\\frac{1}{\\lambda} \\ln\\left(1 - \\alpha^{\\frac{1}{N-1}}\\right)\n$$\n该公式为在所述近似下首次通过时间的分位数提供了一个精确的解析表达式。\n\n计算过程如下。对于每组给定的参数 $(V, A_0, k, N)$：\n$1$. 计算速率参数 $\\lambda = \\frac{k A_0}{N_\\mathrm{A} V}$。\n$2$. 对于每个所需的分位数水平 $\\alpha \\in \\{0.1, 0.5, 0.9\\}$，使用推导出的分位数函数计算相应的时间 $t_\\alpha$。\n$3$. 然后根据要求将结果四舍五入到六位小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the autocatalysis first-passage time problem based on the\n    derived analytical solution for the quantiles.\n    \"\"\"\n    \n    # Avogadro's number\n    N_A = 6.02214076e23  # mol^-1\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (V in L, A0 count, k in M^-1 s^-1, N target count)\n        (1.0e-15, 100, 1.0e6, 10),  # Case 1\n        (1.0e-15, 100, 5.0e5, 10),  # Case 2\n        (5.0e-16, 100, 1.0e6, 10),  # Case 3\n        (1.0e-15, 100, 1.0e6, 2),   # Case 4\n    ]\n\n    # Quantile levels to calculate\n    alphas = [0.1, 0.5, 0.9]\n\n    # Store all results in a single flat list\n    all_results = []\n\n    for case in test_cases:\n        V, A0, k, N = case\n\n        # Calculate the per-capita rate parameter lambda\n        # lambda = k * [A]_0 = k * (A0 / (N_A * V))\n        lambda_val = (k * A0) / (N_A * V)\n        \n        # The initial number of autocatalyst molecules X is 1.\n        # The target N must be greater than 1 for the time to be non-zero.\n        if N == 1:\n            # First-passage time is 0 if N is not greater than the start count.\n            # Append three zeros for the three quantiles.\n            all_results.extend([0.0, 0.0, 0.0])\n            continue\n            \n        case_quantiles = []\n        for alpha in alphas:\n            # Derived quantile function: t_alpha = -1/lambda * ln(1 - alpha^(1/(N-1)))\n            exponent = 1.0 / (N - 1)\n            base = alpha\n            \n            # alpha^(1/(N-1))\n            term = base ** exponent\n            \n            # Argument of the natural logarithm\n            log_arg = 1.0 - term\n            \n            # Calculate the quantile t_alpha\n            t_alpha = - (1.0 / lambda_val) * np.log(log_arg)\n            case_quantiles.append(t_alpha)\n            \n        all_results.extend(case_quantiles)\n\n    # Format the results to six decimal places and create the final output string.\n    # The print statement must produce ONLY the single-line formatted output.\n    formatted_results = [f\"{r:.6f}\" for r in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2624746"}]}