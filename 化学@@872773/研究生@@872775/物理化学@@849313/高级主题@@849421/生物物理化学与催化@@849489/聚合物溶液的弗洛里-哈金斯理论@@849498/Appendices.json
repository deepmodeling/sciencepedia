{"hands_on_practices": [{"introduction": "Flory-Huggins理论为我们预测聚合物能否自发溶于溶剂提供了基本工具。本练习将引导你将完整的Flory-Huggins方程应用于一个实际场景——发动机油中的聚合物添加剂。通过计算总的混合吉布斯自由能（$\\Delta G_{mix}$），你将亲手实践处理决定聚合物溶解度的各个熵贡献和焓贡献项，从而加深对理论的理解。[@problem_id:2026104]", "problem": "现代发动机润滑油是一种复杂的流体，设计用于在很宽的温度范围内工作。其关键组分之一通常是称为粘度指数改进剂（VII）的高摩尔质量聚合物，溶解在矿物基础油或合成基础油中。该聚合物与油混合的自发性可以使用 Flory-Huggins 聚合物溶液模型进行分析。\n\n考虑一个简化系统：在典型的发动机工作温度下，将一种VII聚合物与一种烃类基础油混合。您通过将 $m_2 = 50.0$ g 的VII聚合物与 $m_1 = 1.00$ kg 的基础油混合来制备溶液。假设该系统可按如下方式建模：\n- 基础油可被视为单一组分溶剂，其摩尔质量为 $M_1 = 140.0$ g/mol。\n- VII聚合物的摩尔质量为 $M_2 = 28,000$ g/mol。\n- Flory-Huggins 格子模型的基本假设成立：一个溶剂分子的摩尔体积等于聚合物链中一个重复链段的摩尔体积。因此，一个聚合物链段的摩尔质量等于 $M_1$。\n- 混合在 $T = 100.0$ °C 的恒定温度下发生。\n- 在此温度下，该聚合物-溶剂对的 Flory-Huggins 相互作用参数为 $\\chi = 0.35$。\n- 理想气体常数为 $R = 8.314 \\text{ J K}^{-1} \\text{mol}^{-1}$。\n\n使用 Flory-Huggins 理论，计算该整个溶液的总混合吉布斯自由能 $\\Delta G_{mix}$。根据您的计算结果，判断在该条件下聚合物是否会自发溶解于油中。\n\n作为最终答案，仅提供总混合吉布斯自由能 $\\Delta G_{mix}$ 的数值。答案以千焦（kJ）为单位表示，并保留三位有效数字。", "solution": "我们使用 Flory-Huggins 理论对油（组分1）和聚合物（组分2）进行建模。聚合度由链段体积等效性给出：\n$$r=\\frac{M_{2}}{M_{1}}=\\frac{28000}{140}=200.$$\n各组分的物质的量为\n$$n_{1}=\\frac{m_{1}}{M_{1}}=\\frac{1000}{140}=\\frac{50}{7},\\qquad n_{2}=\\frac{m_{2}}{M_{2}}=\\frac{50}{28000}=\\frac{1}{560}.$$\n总格点数（以摩尔为单位）为\n$$\\ell=n_{1}+r n_{2}=\\frac{50}{7}+200\\cdot\\frac{1}{560}=\\frac{50}{7}+\\frac{5}{14}=\\frac{105}{14}=\\frac{15}{2}.$$\n因此体积分数为\n$$\\phi_{1}=\\frac{n_{1}}{\\ell}=\\frac{50/7}{15/2}=\\frac{20}{21},\\qquad \\phi_{2}=\\frac{r n_{2}}{\\ell}=\\frac{200/560}{15/2}=\\frac{1}{21}.$$\n溶液总混合吉布斯自由能的 Flory-Huggins 表达式为\n$$\\Delta G_{mix}=RT\\left[n_{1}\\ln\\phi_{1}+n_{2}\\ln\\phi_{2}+\\chi\\,n_{1}\\phi_{2}\\right].$$\n使用 $T=373.15\\ \\text{K}$ 和 $\\chi=0.35$，我们计算各项如下：\n$$n_{1}\\ln\\phi_{1}=\\frac{50}{7}\\ln\\!\\left(\\frac{20}{21}\\right)\\approx -0.348501173,$$\n$$n_{2}\\ln\\phi_{2}=\\frac{1}{560}\\ln\\!\\left(\\frac{1}{21}\\right)\\approx -0.005436647,$$\n$$\\chi\\,n_{1}\\phi_{2}=0.35\\cdot\\frac{50}{7}\\cdot\\frac{1}{21}=\\frac{5}{42}\\approx 0.119047619.$$\n求和得到\n$$\\frac{\\Delta G_{mix}}{RT}\\approx -0.348501173-0.005436647+0.119047619=-0.234890200.$$\n当 $R=8.314\\ \\text{J K}^{-1}\\text{mol}^{-1}$ 且 $T=373.15\\ \\text{K}$ 时，\n$$RT=8.314\\times 373.15\\ \\text{J mol}^{-1}\\approx 3102.3691\\ \\text{J mol}^{-1},$$\n所以\n$$\\Delta G_{mix}\\approx 3102.3691\\times(-0.234890200)\\ \\text{J}\\approx -728.716\\ \\text{J}=-0.728716\\ \\text{kJ}.$$\n保留三位有效数字，$\\Delta G_{mix}=-0.729\\ \\text{kJ}$。由于 $\\Delta G_{mix}  0$，在所述条件下混合是自发的。", "answer": "$$\\boxed{-0.729}$$", "id": "2026104"}, {"introduction": "Flory-Huggins相互作用参数 $\\chi$ 是该理论的核心，但它的数值从何而来？本练习将不再把 $\\chi$ 视作一个给定的常数，而是展示如何利用正则溶液理论的原理来估算它。你将推导 $\\chi$ 与Hildebrand溶解度参数（$\\delta$）之间的关系，这为你提供了一种基于纯组分性质来预测聚合物-溶剂相互作用的有力方法。[@problem_id:2641151]", "problem": "一种聚合物溶液使用 Flory-Huggins 理论的平均场晶格框架和正规溶液热力学进行建模。考虑在温度 $T = 313.15\\,\\mathrm{K}$ 下，聚苯乙烯（聚合物 2）溶解在环己烷（溶剂 1）中。在此温度下，聚苯乙烯的 Hildebrand 溶解度参数为 $\\delta_{2} = 18.6\\,\\mathrm{MPa}^{1/2}$，环己烷的为 $\\delta_{1} = 16.8\\,\\mathrm{MPa}^{1/2}$。在 $T = 313.15\\,\\mathrm{K}$ 时，溶剂（环己烷）的摩尔质量为 $M_{1} = 84.16\\,\\mathrm{g}\\,\\mathrm{mol}^{-1}$，质量密度为 $\\rho_{1} = 0.759\\,\\mathrm{g}\\,\\mathrm{cm}^{-3}$。假设参考晶格位点体积 $v_{0}$ 等于溶剂的分子体积，即 $v_{0} = V_{m,1}/N_{A}$，其中 $V_{m,1} = M_{1}/\\rho_{1}$。\n\n从 (i) 溶解度参数的定义 $\\delta_{i} \\equiv \\sqrt{(\\Delta E/V)_{i}}$（即内聚能密度的平方根），(ii) 单位体积混合焓的正规溶液近似，以及 (iii) Flory-Huggins 平均场自由能（其中焓贡献与体积分数的乘积成正比）出发，推导一个将 Flory-Huggins 相互作用参数 $\\chi$ 与 $\\delta_{1}$、$\\delta_{2}$、$v_{0}$、$k_{B}$ 和 $T$ 联系起来的表达式。然后用它来估计给定体系的 $\\chi$。\n\n使用以下常数和单位关系：$N_{A} = 6.02214076 \\times 10^{23}\\,\\mathrm{mol}^{-1}$，$k_{B} = 1.380649 \\times 10^{-23}\\,\\mathrm{J}\\,\\mathrm{K}^{-1}$，$1\\,\\mathrm{MPa} = 10^{6}\\,\\mathrm{J}\\,\\mathrm{m}^{-3}$，以及 $1\\,\\mathrm{cm}^{3} = 10^{-6}\\,\\mathrm{m}^{3}$。在计算前，请仔细将所有量转换为国际单位制。\n\n最后，简要指出将正规溶液描述映射到 Flory-Huggins 相互作用参数所依据的核心物理假设，并评论这些假设在所述温度下对此聚合物-溶剂对的合理性。\n\n将 $\\chi$ 的最终值表示为一个纯数（无量纲），并四舍五入到三位有效数字。", "solution": "所述问题具有科学依据，提法恰当，并包含获得唯一解所需的所有信息。我们着手进行推导和计算。\n\n目标是建立 Flory-Huggins 相互作用参数 $\\chi$ 与 Hildebrand 溶解度参数 $\\delta_i$ 之间的关系。这可以通过将正规溶液理论和 Flory-Huggins 理论中混合焓 $\\Delta H_{mix}$ 的表达式相等来实现。\n\n首先，我们考虑正规溶液理论。对于二元混合物，单位体积的混合焓 $\\frac{\\Delta H_{mix}}{V}$ 由 Scatchard-Hildebrand 方程给出：\n$$\n\\frac{\\Delta H_{mix}}{V} = (\\delta_1 - \\delta_2)^2 \\phi_1 \\phi_2\n$$\n其中 $\\phi_1$ 和 $\\phi_2$ 分别是溶剂（组分 1）和聚合物（组分 2）的体积分数。溶解度参数 $\\delta_1$ 和 $\\delta_2$ 分别是溶剂和聚合物的溶解度参数。这个 $\\Delta H_{mix}$ 的表达式是在假设随机混合、混合时体积无变化以及不同种类物质间的相互作用能可以用同种物质相互作用能的几何平均值来近似的条件下推导出来的。\n\n接下来，我们考虑 Flory-Huggins 晶格模型。混合吉布斯自由能 $\\Delta G_{mix}$ 由下式给出：\n$$\n\\frac{\\Delta G_{mix}}{k_B T} = n_1 \\ln \\phi_1 + n_2 \\ln \\phi_2 + \\chi N_{sites} \\phi_1 \\phi_2\n$$\n此处，$n_1$ 和 $n_2$ 是溶剂和聚合物的分子数，$k_B$ 是玻尔兹曼常数，$T$ 是绝对温度，$N_{sites}$ 是晶格位点的总数。前两项代表不同大小分子的组合混合熵，第三项代表相互作用焓。参数 $\\chi$ 是一个无量纲量，它表征了以 $k_B T$ 为单位的每个溶剂分子与周围聚合物链段的平均相互作用能。\n\n在 Flory-Huggins 模型中，对混合自由能的焓贡献为 $\\Delta H_{mix} = \\chi k_B T N_{sites} \\phi_1 \\phi_2$。体系的总体积为 $V = N_{sites} v_0$，其中 $v_0$ 是单个晶格位点的体积。因此，单位体积的混合焓为：\n$$\n\\frac{\\Delta H_{mix}}{V} = \\frac{\\chi k_B T N_{sites} \\phi_1 \\phi_2}{N_{sites} v_0} = \\frac{\\chi k_B T}{v_0} \\phi_1 \\phi_2\n$$\n通过令两个单位体积混合焓的表达式相等，我们得到：\n$$\n(\\delta_1 - \\delta_2)^2 \\phi_1 \\phi_2 = \\frac{\\chi k_B T}{v_0} \\phi_1 \\phi_2\n$$\n对于 $\\phi_1 \\neq 0$ 且 $\\phi_2 \\neq 0$ 的非平凡解，我们可以将两边同除以 $\\phi_1 \\phi_2$ 来找到 $\\chi$ 的关系式：\n$$\n\\chi = \\frac{v_0}{k_B T} (\\delta_1 - \\delta_2)^2\n$$\n这就是所求的表达式。我们现在开始计算给定体系的 $\\chi$ 的数值。\n\n首先，所有量都必须转换为国际单位制 (SI)。\n参考体积 $v_0$ 取为溶剂（环己烷）的分子体积。\n$$\nv_0 = \\frac{V_{m,1}}{N_A} = \\frac{M_1}{\\rho_1 N_A}\n$$\n给定值为：\n$M_1 = 84.16\\,\\mathrm{g}\\,\\mathrm{mol}^{-1} = 84.16 \\times 10^{-3}\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}$\n$\\rho_1 = 0.759\\,\\mathrm{g}\\,\\mathrm{cm}^{-3} = 0.759 \\times \\frac{10^{-3}\\,\\mathrm{kg}}{(10^{-2}\\,\\mathrm{m})^3} = 0.759 \\times 10^3\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$\n$N_A = 6.02214076 \\times 10^{23}\\,\\mathrm{mol}^{-1}$\n\n溶剂的摩尔体积为：\n$$\nV_{m,1} = \\frac{M_1}{\\rho_1} = \\frac{84.16 \\times 10^{-3}\\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}}{0.759 \\times 10^3\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}} \\approx 1.1088 \\times 10^{-4}\\,\\mathrm{m}^3\\,\\mathrm{mol}^{-1}\n$$\n参考晶格体积为：\n$$\nv_0 = \\frac{1.1088 \\times 10^{-4}\\,\\mathrm{m}^3\\,\\mathrm{mol}^{-1}}{6.02214076 \\times 10^{23}\\,\\mathrm{mol}^{-1}} \\approx 1.8412 \\times 10^{-28}\\,\\mathrm{m}^3\n$$\n接下来，我们计算涉及溶解度参数的项：\n$\\delta_2 = 18.6\\,\\mathrm{MPa}^{1/2}$ 和 $\\delta_1 = 16.8\\,\\mathrm{MPa}^{1/2}$。\n使用换算关系 $1\\,\\mathrm{MPa} = 10^6\\,\\mathrm{J}\\,\\mathrm{m}^{-3}$：\n$$\n(\\delta_1 - \\delta_2)^2 = (16.8 - 18.6)^2 \\, \\mathrm{MPa} = (-1.8)^2 \\, \\mathrm{MPa} = 3.24\\,\\mathrm{MPa} = 3.24 \\times 10^6\\,\\mathrm{J}\\,\\mathrm{m}^{-3}\n$$\n热能为：\n$T = 313.15\\,\\mathrm{K}$\n$k_B = 1.380649 \\times 10^{-23}\\,\\mathrm{J}\\,\\mathrm{K}^{-1}$\n$$\nk_B T = (1.380649 \\times 10^{-23}\\,\\mathrm{J}\\,\\mathrm{K}^{-1})(313.15\\,\\mathrm{K}) \\approx 4.3235 \\times 10^{-21}\\,\\mathrm{J}\n$$\n现在，将这些值代入 $\\chi$ 的表达式中：\n$$\n\\chi = \\frac{v_0 (\\delta_1 - \\delta_2)^2}{k_B T} = \\frac{(1.8412 \\times 10^{-28}\\,\\mathrm{m}^3)(3.24 \\times 10^6\\,\\mathrm{J}\\,\\mathrm{m}^{-3})}{4.3235 \\times 10^{-21}\\,\\mathrm{J}}\n$$\n$$\n\\chi \\approx \\frac{5.9655 \\times 10^{-22}}{4.3235 \\times 10^{-21}} \\approx 0.13798\n$$\n四舍五入到三位有效数字，估计值为 $\\chi = 0.138$。\n\n最后，我们讨论此映射所依据的核心物理假设。该推导将正规溶液理论中的焓项与 Flory-Huggins 理论中的相互作用项等同起来。因此，主要假设是 Scatchard-Hildebrand 正规溶液模型的假设：\n1. 混合体积为零，$\\Delta V_{mix} = 0$。这是一个近似；通常会发生小的体积变化，但一般可以忽略不计。\n2. 超额混合熵为零。这意味着假设 Flory-Huggins 参数 $\\chi$ 的来源纯粹是焓，随 $1/T$ 变化。实际上，$\\chi$ 通常包含一个显著的熵组分，通常表示为一个常数项，$\\chi = A + B/T$。我们的推导实际上设定了 $A=0$。这是一个重大的简化，因为特定的相互作用或构象变化可以对非组合混合熵做出贡献。\n3. 不同种类物质（$1$-$2$）之间的相互作用能是纯物质（$1$-$1$ 和 $2$-$2$）相互作用能的几何平均值。这个近似对于分子间作用力主要由伦敦色散力主导的非极性体系最为有效。\n\n对于聚苯乙烯在环己烷中的体系，两种组分都主要是非极性的。因此，几何平均近似是合理的。给定温度 $T=313.15\\,\\mathrm{K}$ ($40\\,\\mathrm{^\\circ C}$) 高于该体系的 $\\theta$ 温度（约为 $307.65\\,\\mathrm{K}$ 或 $34.5\\,\\mathrm{^\\circ C}$）。在 $\\theta$ 温度下，$\\chi=0.5$。$\\chi \\approx 0.138  0.5$ 的值正确地表明，在 $40\\,\\mathrm{^\\circ C}$ 时，环己烷是聚苯乙烯的良溶剂，这在物理上是一致的。虽然忽略 $\\chi$ 的熵组分是一种简化，但正规溶液方法为相互作用参数的焓贡献提供了一个合理且物理上直观的一阶估计。", "answer": "$$\n\\boxed{0.138}\n$$", "id": "2641151"}, {"introduction": "为了最深刻地理解 $\\chi$ 参数，我们必须将其与分子相互作用的微观世界联系起来。这个高级练习将指导你直接从基于格点模型的分子模拟中获得的基本相互作用能和接触数出发，推导出一个有效的相互作用参数。通过这项实践，你将打通宏观热力学和统计力学之间的壁垒，揭示关键理论参数如何从第一性原理中涌现。[@problem_id:2641153]", "problem": "本题要求您形式化如何通过在基于格点的分子模拟中计数异种接触来估算 Flory-Huggins 相互作用参数，并进行计算验证。您必须从配位格点上二元混合物的基本能量描述和混合焓的定义出发，不得假定任何快捷公式。您的推导必须从第一性原理出发，得到一个有效的、依赖于组成和温度的相互作用参数的可计算表达式。然后，您必须实现此表达式以评估指定的测试案例。\n\n考虑一个由物种 $A$ 和 $B$ 组成的二元混合物，占据一个拥有 $N$ 个格点、配位数为 $z$（每个格点有 $z$ 个邻居）的格点。设 $N_A$ 和 $N_B$ 分别是 $A$ 和 $B$ 格点的数量，其中 $N_A + N_B = N$，体积分数为 $\\phi_A = N_A/N$ 和 $\\phi_B = N_B/N$。定义每个最近邻接触的对相互作用能为 $\\varepsilon_{AA}$、$\\varepsilon_{BB}$ 和 $\\varepsilon_{AB}$（单位为焦耳）。在给定的绝对温度 $T$（单位为开尔文）下，玻尔兹曼常数为 $k_{\\mathrm{B}} = 1.380649\\times 10^{-23}\\,\\mathrm{J/K}$。假设在此类格点上的分子模拟（例如，蒙特卡洛模拟）在平衡状态下产生了混合物中异种 $A$–$B$ 最近邻接触的总数 $n_{AB}$。模拟盒子很大且呈周期性，$n_{AB}$ 是在整个盒子中测量的；可以理解，$n_{AA}$ 和 $n_{BB}$ 是相应的同种接触计数，并且 $n_{AA} + n_{BB} + n_{AB} = zN/2$ 计入了无向接触。\n\n任务：\n1) 仅从(i)以接触数和对能量表示的最近邻格点混合物的内能定义，以及(ii)分离的纯相与混合物之间的混合焓（内能）定义出发，推导出一个用 $n_{AB}$ 和适当参数表示的单位格点混合焓的显式表达式。然后，通过识别 Flory-Huggins 单位格点混合自由能中的焓贡献，推导出一个用 $n_{AB}$、$N$、$\\phi_A$、$\\phi_B$、$T$ 和对相互作用能表示的有效相互作用参数 $\\chi_{\\mathrm{eff}}(\\phi_A,\\phi_B,T)$ 的可计算表达式。您的推导必须是自洽的，并且不得假定任何预先已知的 $\\chi$ 的最终公式。\n\n2) 实现一个程序，为以下测试案例评估 $\\chi_{\\mathrm{eff}}$。在每个案例中，$N$、$z$、$T$、$\\varepsilon_{AA}$、$\\varepsilon_{BB}$、$\\varepsilon_{AB}$ 和 $n_{AB}$ 均已提供。使用 $k_{\\mathrm{B}} = 1.380649\\times 10^{-23}\\,\\mathrm{J/K}$。对于每个案例，将 $\\chi_{\\mathrm{eff}}$ 报告为无量纲浮点数，四舍五入到 $6$ 位小数。体积分数必须根据提供的 $\\phi_B$ 计算，即 $\\phi_A = 1 - \\phi_B$。所有能量均为每个接触的焦耳数，温度单位为开尔文，计数为整数。您不得引入任何额外的拟合参数。\n\n测试案例：\n- 案例 $1$：$N = 100000$，$z = 6$，$T = 400$，$\\phi_B = 0.3$，$\\varepsilon_{AA} = -2.5\\times 10^{-21}$，$\\varepsilon_{BB} = -2.0\\times 10^{-21}$，$\\varepsilon_{AB} = -2.2\\times 10^{-21}$，$n_{AB} = 126000$。\n- 案例 $2$：与案例 $1$ 相同，但 $n_{AB} = 113400$。\n- 案例 $3$：$N = 200000$，$z = 6$，$T = 298$，$\\phi_B = 0.02$，$\\varepsilon_{AA} = -2.0\\times 10^{-21}$，$\\varepsilon_{BB} = -2.0\\times 10^{-21}$，$\\varepsilon_{AB} = -2.2\\times 10^{-21}$，$n_{AB} = 23520$。\n- 案例 $4$：与案例 $1$ 相同，但 $T = 800$ 且 $n_{AB} = 126000$。\n\n输出要求：\n- 您的程序必须生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，顺序与上述案例相同。例如，输出必须类似于 $[\\chi_1,\\chi_2,\\chi_3,\\chi_4]$，其中每个 $\\chi_i$ 都四舍五入到 $6$ 位小数。\n- 所有输出均为无量纲数。不得打印任何单位。", "solution": "所提出的问题是统计热力学应用于混合物格点模型的一个有效且适定的练习，这是物理化学的基石之一。它要求从基本原理推导 Flory-Huggins 相互作用参数并进行后续计算。以下是推导和求解过程。\n\n该问题要求完成两项任务。首先，从第一性原理推导有效 Flory-Huggins 相互作用参数 $\\chi_{\\mathrm{eff}}$。其次，实现推导出的公式，为提供的测试案例计算 $\\chi_{\\mathrm{eff}}$。\n\n**第一部分：有效相互作用参数 $\\chi_{\\mathrm{eff}}$ 的推导**\n\n推导过程从基于格点的二元混合物的内能和混合焓的定义开始。\n\n**步骤1：混合物的内能**\n考虑一个总共有 $N$ 个格点的格点，被 $N_A$ 个物种 $A$ 的粒子和 $N_B$ 个物种 $B$ 的粒子占据，其中 $N = N_A + N_B$。该体系的特征是最近邻对相互作用能 $\\varepsilon_{AA}$、$\\varepsilon_{BB}$ 和 $\\varepsilon_{AB}$。设 $n_{AA}$、$n_{BB}$ 和 $n_{AB}$ 是平衡时混合物中无向 $A-A$、$B-B$ 和 $A-B$ 接触的总数。混合物的总内能 $U_{\\text{mix}}$ 是所有对相互作用能的总和：\n$$U_{\\text{mix}} = n_{AA}\\varepsilon_{AA} + n_{BB}\\varepsilon_{BB} + n_{AB}\\varepsilon_{AB}$$\n\n**步骤2：纯组分的内能**\n在混合之前，系统由两个分离的纯相组成：一个包含 $N_A$ 个 $A$ 粒子，另一个包含 $N_B$ 个 $B$ 粒子。\n在一个占据 $N_A$ 个格点的纯 $A$ 相中，每个格点有 $z$ 个邻居，总共产生 $zN_A$ 个“键的一半”。由于每个 $A-A$ 键连接两个 $A$ 粒子，因此 $A-A$ 接触的总数为 $\\frac{zN_A}{2}$。纯 $A$ 相的内能为：\n$$U_{A, \\text{pure}} = \\left(\\frac{zN_A}{2}\\right) \\varepsilon_{AA}$$\n以此类推，纯 $B$ 相的内能为：\n$$U_{B, \\text{pure}} = \\left(\\frac{zN_B}{2}\\right) \\varepsilon_{BB}$$\n未混合系统的总内能 $U_{\\text{pure}}$ 是纯组分能量的总和：\n$$U_{\\text{pure}} = U_{A, \\text{pure}} + U_{B, \\text{pure}} = \\frac{zN_A}{2}\\varepsilon_{AA} + \\frac{zN_B}{2}\\varepsilon_{BB}$$\n\n**步骤3：混合焓**\n对于凝聚相体系，混合时的体积变化通常可以忽略不计，因此混合焓 $\\Delta H_{\\text{mix}}$ 可以很好地用内能变化 $\\Delta U_{\\text{mix}}$ 来近似。\n$$\\Delta H_{\\text{mix}} \\approx \\Delta U_{\\text{mix}} = U_{\\text{mix}} - U_{\\text{pure}}$$\n代入 $U_{\\text{mix}}$ 和 $U_{\\text{pure}}$ 的表达式：\n$$\\Delta U_{\\text{mix}} = (n_{AA}\\varepsilon_{AA} + n_{BB}\\varepsilon_{BB} + n_{AB}\\varepsilon_{AB}) - \\left(\\frac{zN_A}{2}\\varepsilon_{AA} + \\frac{zN_B}{2}\\varepsilon_{BB}\\right)$$\n为了用给定的可观测量 $n_{AB}$ 来表示 $\\Delta U_{\\text{mix}}$，我们必须消去 $n_{AA}$ 和 $n_{BB}$。我们通过考虑每个物种的“键平衡”来建立接触数之间的关系。所有 $A$ 粒子发出的键一半的总数是 $zN_A$。这些键一半参与 $A-A$ 或 $A-B$ 接触。每个 $A-A$ 接触涉及两个这样的键一半，每个 $A-B$ 接触涉及一个。因此：\n$$zN_A = 2n_{AA} + n_{AB} \\implies n_{AA} = \\frac{1}{2}(zN_A - n_{AB})$$\n类似地，对于物种 $B$：\n$$zN_B = 2n_{BB} + n_{AB} \\implies n_{BB} = \\frac{1}{2}(zN_B - n_{AB})$$\n现在，将这些 $n_{AA}$ 和 $n_{BB}$ 的表达式代入 $\\Delta U_{\\text{mix}}$ 的方程中：\n$$\\Delta U_{\\text{mix}} = \\left[\\frac{1}{2}(zN_A - n_{AB})\\varepsilon_{AA} + \\frac{1}{2}(zN_B - n_{AB})\\varepsilon_{BB} + n_{AB}\\varepsilon_{AB}\\right] - \\left(\\frac{zN_A}{2}\\varepsilon_{AA} + \\frac{zN_B}{2}\\varepsilon_{BB}\\right)$$\n展开各项：\n$$\\Delta U_{\\text{mix}} = \\left(\\frac{zN_A}{2}\\varepsilon_{AA} - \\frac{n_{AB}}{2}\\varepsilon_{AA}\\right) + \\left(\\frac{zN_B}{2}\\varepsilon_{BB} - \\frac{n_{AB}}{2}\\varepsilon_{BB}\\right) + n_{AB}\\varepsilon_{AB} - \\frac{zN_A}{2}\\varepsilon_{AA} - \\frac{zN_B}{2}\\varepsilon_{BB}$$\n包含 $z$ 的项相互抵消，剩下：\n$$\\Delta U_{\\text{mix}} = n_{AB}\\varepsilon_{AB} - \\frac{n_{AB}}{2}\\varepsilon_{AA} - \\frac{n_{AB}}{2}\\varepsilon_{BB}$$\n提出因子 $n_{AB}$，得到用异种接触数表示的总混合焓：\n$$\\Delta H_{\\text{mix}} = n_{AB} \\left( \\varepsilon_{AB} - \\frac{\\varepsilon_{AA} + \\varepsilon_{BB}}{2} \\right)$$\n因此，每个格点的混合焓为：\n$$\\frac{\\Delta H_{\\text{mix}}}{N} = \\frac{n_{AB}}{N} \\left( \\varepsilon_{AB} - \\frac{\\varepsilon_{AA} + \\varepsilon_{BB}}{2} \\right)$$\n这就完成了所需推导的第一部分。\n\n**步骤4：与 Flory-Huggins 理论的关联**\n对于一个简单的二元混合物（两种物质的聚合度均为1），Flory-Huggins 理论给出的单位格点混合 Gibbs 自由能 $\\frac{\\Delta G_{\\text{mix}}}{N}$ 为：\n$$\\frac{\\Delta G_{\\text{mix}}}{N k_{\\mathrm{B}} T} = \\phi_A \\ln(\\phi_A) + \\phi_B \\ln(\\phi_B) + \\chi \\phi_A \\phi_B$$\n其中 $\\phi_A = N_A/N$ 和 $\\phi_B = N_B/N$ 是体积分数，$k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是绝对温度。项 $\\chi \\phi_A \\phi_B$ 代表对混合自由能的无量纲焓贡献。因此，单位格点的混合焓可以表示为：\n$$\\frac{\\Delta H_{\\text{mix}}}{N} = \\chi k_{\\mathrm{B}} T \\phi_A \\phi_B$$\n问题要求一个与模拟接触数 $n_{AB}$ 一致的有效参数 $\\chi_{\\mathrm{eff}}$。通过将我们推导出的单位格点混合焓表达式与 Flory-Huggins 框架中定义的表达式相等，我们得到：\n$$\\frac{n_{AB}}{N} \\left( \\varepsilon_{AB} - \\frac{\\varepsilon_{AA} + \\varepsilon_{BB}}{2} \\right) = \\chi_{\\mathrm{eff}} k_{\\mathrm{B}} T \\phi_A \\phi_B$$\n解出 $\\chi_{\\mathrm{eff}}$ 即可得到所需的可计算表达式。请注意，由于给定的 $n_{AB}$ 是特定状态（在给定的 $T$ 和组成下）的结果，因此得到的 $\\chi_{\\mathrm{eff}}$是该状态下的一个有效参数。\n$$\\chi_{\\mathrm{eff}}(\\phi_A, \\phi_B, T) = \\frac{n_{AB}}{N \\phi_A \\phi_B} \\frac{1}{k_{\\mathrm{B}} T} \\left( \\varepsilon_{AB} - \\frac{\\varepsilon_{AA} + \\varepsilon_{BB}}{2} \\right)$$\n推导到此完成。\n\n**第二部分：测试案例的计算**\n\n推导出的公式将被实现用于计算每个测试案例的 $\\chi_{\\mathrm{eff}}$。参数在问题陈述中已提供。体积分数 $\\phi_A$ 计算为 $1 - \\phi_B$。玻尔兹曼常数的值为 $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23} \\, \\mathrm{J/K}$。结果将四舍五入到 $6$ 位小数。\n\n计算过程如最终答案中的 Python 代码所示。\n- 案例 1: $\\chi_{\\mathrm{eff}} = 0.054322$\n- 案例 2: $\\chi_{\\mathrm{eff}} = 0.048890$\n- 案例 3: $\\chi_{\\mathrm{eff}} = -0.291673$\n- 案例 4: $\\chi_{\\mathrm{eff}} = 0.027161$", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and calculates the effective Flory-Huggins interaction parameter\n    for a binary mixture on a lattice based on simulated contact counts.\n    \"\"\"\n    \n    # Define the Boltzmann constant\n    k_B = 1.380649e-23  # J/K\n\n    # Define the test cases from the problem statement.\n    # Each case is a dictionary of parameters.\n    test_cases = [\n        {\n            \"N\": 100000, \"z\": 6, \"T\": 400, \"phi_B\": 0.3,\n            \"eps_AA\": -2.5e-21, \"eps_BB\": -2.0e-21, \"eps_AB\": -2.2e-21,\n            \"n_AB\": 126000\n        },\n        {\n            \"N\": 100000, \"z\": 6, \"T\": 400, \"phi_B\": 0.3,\n            \"eps_AA\": -2.5e-21, \"eps_BB\": -2.0e-21, \"eps_AB\": -2.2e-21,\n            \"n_AB\": 113400\n        },\n        {\n            \"N\": 200000, \"z\": 6, \"T\": 298, \"phi_B\": 0.02,\n            \"eps_AA\": -2.0e-21, \"eps_BB\": -2.0e-21, \"eps_AB\": -2.2e-21,\n            \"n_AB\": 23520\n        },\n        {\n            \"N\": 100000, \"z\": 6, \"T\": 800, \"phi_B\": 0.3,\n            \"eps_AA\": -2.5e-21, \"eps_BB\": -2.0e-21, \"eps_AB\": -2.2e-21,\n            \"n_AB\": 126000\n        }\n    ]\n\n    results = []\n    \n    # Formula for chi_eff:\n    # chi_eff = (n_AB / (N * phi_A * phi_B)) * (eps_AB - (eps_AA + eps_BB) / 2) / (k_B * T)\n\n    for case in test_cases:\n        N = case[\"N\"]\n        T = case[\"T\"]\n        phi_B = case[\"phi_B\"]\n        eps_AA = case[\"eps_AA\"]\n        eps_BB = case[\"eps_BB\"]\n        eps_AB = case[\"eps_AB\"]\n        n_AB = case[\"n_AB\"]\n\n        # Calculate volume fraction of A\n        phi_A = 1.0 - phi_B\n\n        # Calculate the exchange energy\n        delta_eps = eps_AB - (eps_AA + eps_BB) / 2.0\n\n        # Calculate the thermal energy\n        k_B_T = k_B * T\n\n        # Calculate the prefactor related to contact numbers\n        # This term can be interpreted as the ratio of actual A-B contacts\n        # to the number expected in a mean-field random mixture.\n        # prefactor = n_AB / (z * N * phi_A * phi_B)\n        # The z is then multiplied back in chi = z * prefactor * delta_eps / k_B_T\n        # An equivalent way to write is the one derived in the solution:\n        contact_prefactor = n_AB / (N * phi_A * phi_B)\n        \n        # Calculate the effective interaction parameter\n        chi_eff = contact_prefactor * delta_eps / k_B_T\n        \n        results.append(chi_eff)\n\n    # Format the results for output\n    # Each result is rounded to 6 decimal places.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2641153"}]}