{"hands_on_practices": [{"introduction": "隧穿电流与探针-样品间距之间的指数关系是扫描隧道显微镜（STM）的基石。本练习将引导你从WKB近似出发，推导出这一基本关系，并将其应用于一种常见的实验测量——$I(z)$谱。通过分析电流的衰减率，你将能从模拟的实验数据中提取出一个关键的物理参数——表观势垒高度，从而在量子理论和实验数据之间建立起切实的联系 [@problem_id:2662479]。", "problem": "在扫描隧道显微镜（STM）中，$I(z)$谱测量记录了在固定的微小偏压下，隧穿电流$I$随真空针尖-样品间距$z$变化的函数。考虑这样一种情况：真空势垒可被建模为一维的，并且势垒高度是有效恒定且与能量无关的，等于相对于费米能级测量的表观势垒高度$\\phi_{\\mathrm{app}}$。从不含时薛定谔方程和用于穿隧经典禁区的半经典Wentzel–Kramers–Brillouin（WKB）近似出发，推导$\\ln I$对$z$的曲线斜率$s \\equiv d(\\ln I)/dz$与$\\phi_{\\mathrm{app}}$、电子质量$m_{e}$以及约化普朗克常数$\\hbar$之间的关系。然后，对于在足够小的偏压下（势垒高度可视为常数）测得的斜率$s = -22\\,\\mathrm{nm}^{-1}$，计算$\\phi_{\\mathrm{app}}$的值（以电子伏特为单位）。\n\n使用以下常数：$\\hbar = 1.054\\,571\\,817 \\times 10^{-34}\\,\\mathrm{J\\,s}$，$m_{e} = 9.109\\,383\\,56 \\times 10^{-31}\\,\\mathrm{kg}$，以及$1\\,\\mathrm{eV} = 1.602\\,176\\,634 \\times 10^{-19}\\,\\mathrm{J}$。将$\\phi_{\\mathrm{app}}$的最终数值答案四舍五入到三位有效数字，并以$\\mathrm{eV}$为单位表示。", "solution": "所述问题具有科学依据，提法明确，且包含足够的信息以获得唯一解。这是一个将量子隧穿原理应用于扫描隧道显微镜操作的标准练习。我们将进行推导和随后的计算。\n\n任务是首先推导出斜率$s \\equiv d(\\ln I)/dz$的关系式，然后计算表观势垒高度$\\phi_{\\mathrm{app}}$。出发点是不含时薛定谔方程和Wentzel–Kramers–Brillouin（WKB）近似。\n\n在固定的微小偏压下，隧穿电流$I$与电子从针尖隧穿到样品（或反之）的量子力学透射概率$T$成正比。我们可以将其写为$I \\propto T$。电流的主要贡献来自费米能级$E_F$处的电子。\n\nWKB近似给出了质量为$m_e$、能量为$E$的粒子从$x=0$到$x=z$隧穿过势垒$V(x)$的透射系数$T$为：\n$$\nT \\approx \\exp\\left( -2 \\int_{0}^{z} \\sqrt{\\frac{2m_e (V(x') - E)}{\\hbar^2}} \\, dx' \\right)\n$$\n在此问题中，我们将真空间隙建模为一维矩形势垒。\n势垒高度是恒定的，由相对于费米能级定义的表观势垒高度$\\phi_{\\mathrm{app}}$给出。因此，对于势垒内部所有的$x'$，即$0  x'  z$，有$V(x') - E = \\phi_{\\mathrm{app}}$。\n将这些条件代入WKB公式：\n$$\nT \\approx \\exp\\left( -2 \\int_{0}^{z} \\sqrt{\\frac{2m_e \\phi_{\\mathrm{app}}}{\\hbar^2}} \\, dx' \\right)\n$$\n由于被积函数相对于积分变量$x'$是常数，该积分是平凡的：\n$$\n\\int_{0}^{z} \\sqrt{\\frac{2m_e \\phi_{\\mathrm{app}}}{\\hbar^2}} \\, dx' = \\sqrt{\\frac{2m_e \\phi_{\\mathrm{app}}}{\\hbar^2}} \\int_{0}^{z} dx' = z \\frac{\\sqrt{2m_e \\phi_{\\mathrm{app}}}}{\\hbar}\n$$\n将此结果代回$T$的表达式中：\n$$\nT(z) \\approx \\exp\\left( -2z \\frac{\\sqrt{2m_e \\phi_{\\mathrm{app}}}}{\\hbar} \\right)\n$$\n隧穿电流$I(z)$与$T(z)$成正比，所以我们可以写出：\n$$\nI(z) \\approx C \\exp\\left( -2z \\frac{\\sqrt{2m_e \\phi_{\\mathrm{app}}}}{\\hbar} \\right)\n$$\n其中$C$是一个比例常数，它取决于针尖和样品的电子态密度以及偏压，但与间距$z$无关。\n\n题目要求我们求出斜率$s \\equiv d(\\ln I)/dz$。首先，我们对$I(z)$取自然对数：\n$$\n\\ln I(z) \\approx \\ln \\left( C \\exp\\left( -2z \\frac{\\sqrt{2m_e \\phi_{\\mathrm{app}}}}{\\hbar} \\right) \\right) = \\ln C + \\ln \\left( \\exp\\left( -2z \\frac{\\sqrt{2m_e \\phi_{\\mathrm{app}}}}{\\hbar} \\right) \\right)\n$$\n$$\n\\ln I(z) \\approx \\ln C - 2z \\frac{\\sqrt{2m_e \\phi_{\\mathrm{app}}}}{\\hbar}\n$$\n现在，我们对$z$求导以求得斜率$s$：\n$$\ns = \\frac{d(\\ln I)}{dz} \\approx \\frac{d}{dz} \\left( \\ln C - 2z \\frac{\\sqrt{2m_e \\phi_{\\mathrm{app}}}}{\\hbar} \\right)\n$$\n由于$\\ln C$、$\\phi_{\\mathrm{app}}$、$m_e$和$\\hbar$相对于$z$是常数，导数为：\n$$\ns = -2 \\frac{\\sqrt{2m_e \\phi_{\\mathrm{app}}}}{\\hbar}\n$$\n这就是所要求的斜率$s$与物理常数$\\phi_{\\mathrm{app}}$、$m_e$和$\\hbar$之间的关系。\n\n对于问题的第二部分，我们必须根据测得的斜率$s = -22\\,\\mathrm{nm}^{-1}$来计算$\\phi_{\\mathrm{app}}$。我们重新整理推导出的方程以求解$\\phi_{\\mathrm{app}}$：\n$$\ns^2 = \\left( -2 \\frac{\\sqrt{2m_e \\phi_{\\mathrm{app}}}}{\\hbar} \\right)^2 = 4 \\frac{2m_e \\phi_{\\mathrm{app}}}{\\hbar^2} = \\frac{8m_e \\phi_{\\mathrm{app}}}{\\hbar^2}\n$$\n$$\n\\phi_{\\mathrm{app}} = \\frac{s^2 \\hbar^2}{8m_e}\n$$\n如果所有量都采用国际单位制（SI），该表达式将得出$\\phi_{\\mathrm{app}}$的焦耳（Joules）值。我们给出的数值如下：\n$s = -22\\,\\mathrm{nm}^{-1} = -22 \\times 10^9\\,\\mathrm{m}^{-1}$\n$\\hbar = 1.054571817 \\times 10^{-34}\\,\\mathrm{J\\,s}$\n$m_e = 9.10938356 \\times 10^{-31}\\,\\mathrm{kg}$\n\n代入这些值：\n$$\n\\phi_{\\mathrm{app}} = \\frac{(-22 \\times 10^9\\,\\mathrm{m}^{-1})^2 (1.054571817 \\times 10^{-34}\\,\\mathrm{J\\,s})^2}{8 (9.10938356 \\times 10^{-31}\\,\\mathrm{kg})}\n$$\n$$\n\\phi_{\\mathrm{app}} = \\frac{(484 \\times 10^{18}\\,\\mathrm{m}^{-2}) (1.112119 \\times 10^{-68}\\,\\mathrm{J^2\\,s^2})}{7.2875068 \\times 10^{-30}\\,\\mathrm{kg}}\n$$\n$$\n\\phi_{\\mathrm{app}} = \\frac{5.382658 \\times 10^{-49}\\,\\mathrm{J^2\\,s^2\\,m^{-2}}}{7.2875068 \\times 10^{-30}\\,\\mathrm{kg}}\n$$\n回顾$1\\,\\mathrm{J} = 1\\,\\mathrm{kg\\,m^2\\,s^{-2}}$，单位正确地解析为焦耳。\n$$\n\\phi_{\\mathrm{app}} \\approx 7.38613 \\times 10^{-19}\\,\\mathrm{J}\n$$\n问题要求答案以电子伏特（$\\mathrm{eV}$）为单位。我们使用给定的转换因子$1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}$。这个量在数值上等于基本电荷$e$。\n$$\n\\phi_{\\mathrm{app}} [\\mathrm{eV}] = \\frac{\\phi_{\\mathrm{app}} [\\mathrm{J}]}{1.602176634 \\times 10^{-19}\\,\\mathrm{J/eV}}\n$$\n$$\n\\phi_{\\mathrm{app}} [\\mathrm{eV}] = \\frac{7.38613 \\times 10^{-19}\\,\\mathrm{J}}{1.602176634 \\times 10^{-19}\\,\\mathrm{J/eV}} \\approx 4.60999\\,\\mathrm{eV}\n$$\n按要求将最终答案四舍五入到三位有效数字，得到$4.61\\,\\mathrm{eV}$。", "answer": "$$\n\\boxed{4.61}\n$$", "id": "2662479"}, {"introduction": "与扫描隧道显微镜不同，原子力显微镜（AFM）的工作原理基于原子间力。AFM悬臂梁的稳定性取决于其自身弹性恢复力与探针-样品相互作用力之间的精妙平衡。本练习将深入探讨该系统的力学原理，指导你推导出系统失稳的临界条件，即“跳接触”现象，并计算在范德瓦尔斯力作用下的吸附距离，这是理解AFM成像和力谱测量的一个核心概念 [@problem_id:2662545]。", "problem": "在原子力显微镜（AFM）中，半径为 $R$ 的球形针尖向平坦表面的静态逼近过程，由悬臂梁的弹性恢复力与保守的针尖-样品相互作用力之间的平衡所决定。考虑一个劲度系数为 $k$ 的悬臂梁，在保守的针尖-样品力 $F_{\\mathrm{ts}}(z)$ 作用下发生偏转 $x$，其中 $z$ 是瞬时的针尖-样品间距。对于非延迟色散力占主导的纳米尺度间距，我们使用球体-平面范德华相互作用来模拟针尖-样品力：$F_{\\mathrm{ts}}(z)=-A_{H}R/(6z^{2})$，其中 $A_{H}$ 是Hamaker常数。\n\n从该耦合系统的总势能出发，利用适用于保守单自由度系统的平衡与稳定性条件，推导静态不稳定性（突跳接触）开始的条件，并用 $k$ 和 $\\partial F_{\\mathrm{ts}}/\\partial z$ 表示。然后，对于给定的范德华力模型，在 $A_{H}=10^{-19}\\,\\mathrm{J}$，$R=20\\,\\mathrm{nm}$ 和 $k=0.5\\,\\mathrm{N/m}$ 的条件下，计算首次满足该等式时的吸附距离 $z_{\\mathrm{snap}}$。请用纳米（nm）表示最终数值答案，并四舍五入至三位有效数字。", "solution": "该问题在科学上是合理的，提法清晰，并包含了解决问题所需的全部信息。它描述了原子力显微镜物理学中的一个经典情景，该情景基于力学和分子间力的基本原理。\n\n**第一部分：推导不稳定性条件**\n\n系统的总势能 $U_{\\mathrm{total}}$ 是悬臂梁的弹性势能 $U_{\\mathrm{el}}$ 和针尖-样品相互作用势能 $U_{\\mathrm{ts}}$ 的和。\n设悬臂梁的静止位置（无偏转时）在 $z_0$ 处，悬臂梁的劲度系数为 $k$。当针尖位于 $z$ 处时，悬臂梁的偏转为 $(z - z_0)$。弹性势能为：\n$U_{\\mathrm{el}} = \\frac{1}{2} k (z - z_0)^2$\n\n相互作用势能 $U_{\\mathrm{ts}}(z)$ 与力 $F_{\\mathrm{ts}}(z)$ 的关系为 $F_{\\mathrm{ts}} = -\\frac{dU_{\\mathrm{ts}}}{dz}$。\n因此，总势能为：\n$U_{\\mathrm{total}}(z) = U_{\\mathrm{el}} + U_{\\mathrm{ts}}(z) = \\frac{1}{2} k (z - z_0)^2 + U_{\\mathrm{ts}}(z)$\n\n系统的平衡位置由总势能的一阶导数为零确定：\n$\\frac{dU_{\\mathrm{total}}}{dz} = k(z - z_0) + \\frac{dU_{\\mathrm{ts}}}{dz} = k(z - z_0) - F_{\\mathrm{ts}}(z) = 0$\n这表示在平衡时，悬臂梁的恢复力 $-k(z-z_0)$ 与针尖-样品力 $F_{\\mathrm{ts}}(z)$ 相平衡。\n\n系统的稳定性由总势能的二阶导数确定。稳定平衡要求 $U_{\\mathrm{total}}$ 处于一个局部最小值，即 $\\frac{d^2U_{\\mathrm{total}}}{dz^2} > 0$。\n$\\frac{d^2U_{\\mathrm{total}}}{dz^2} = k - \\frac{dF_{\\mathrm{ts}}}{dz} > 0$\n这个不等式表明，只要悬臂梁的劲度系数大于力梯度的负值，系统就是稳定的。\n\n静态不稳定性，即“突跳接触”（snap-to-contact），发生在稳定平衡条件被破坏的临界点。此时，势能曲线的曲率变为零，系统不再能维持稳定平衡，针尖会突然跳向样品表面。这个临界条件是：\n$\\frac{d^2U_{\\mathrm{total}}}{dz^2} = k - \\frac{dF_{\\mathrm{ts}}}{dz} = 0$\n因此，不稳定性开始的条件是：\n$$k = \\frac{dF_{\\mathrm{ts}}}{dz} \\quad \\text{或} \\quad k = \\frac{\\partial F_{\\mathrm{ts}}}{\\partial z}$$\n\n**第二部分：计算吸附距离 $z_{\\mathrm{snap}}$**\n\n我们使用给定的范德华力模型：\n$F_{\\mathrm{ts}}(z) = -\\frac{A_{H}R}{6z^{2}}$\n\n首先，计算力梯度 $\\frac{dF_{\\mathrm{ts}}}{dz}$：\n$\\frac{dF_{\\mathrm{ts}}}{dz} = \\frac{d}{dz} \\left( -\\frac{A_{H}R}{6} z^{-2} \\right) = -\\frac{A_{H}R}{6} (-2 z^{-3}) = \\frac{A_{H}R}{3z^{3}}$\n\n将这个表达式代入我们推导出的不稳定性条件 $k = \\frac{dF_{\\mathrm{ts}}}{dz}$：\n$k = \\frac{A_{H}R}{3z^{3}}$\n\n我们要求解的吸附距离 $z_{\\mathrm{snap}}$ 就是满足这个等式的 $z$ 值。重新整理方程以求解 $z_{\\mathrm{snap}}$：\n$z_{\\mathrm{snap}}^3 = \\frac{A_{H}R}{3k}$\n$z_{\\mathrm{snap}} = \\left( \\frac{A_{H}R}{3k} \\right)^{1/3}$\n\n现在，代入给定的数值：\n$A_{H} = 10^{-19}\\,\\mathrm{J}$\n$R = 20\\,\\mathrm{nm} = 20 \\times 10^{-9}\\,\\mathrm{m}$\n$k = 0.5\\,\\mathrm{N/m}$\n\n所有单位均为国际单位制（SI）：\n$z_{\\mathrm{snap}}^3 = \\frac{(10^{-19}\\,\\mathrm{J}) \\times (20 \\times 10^{-9}\\,\\mathrm{m})}{3 \\times (0.5\\,\\mathrm{N/m})} = \\frac{20 \\times 10^{-28}\\,\\mathrm{J \\cdot m}}{1.5\\,\\mathrm{N/m}}$\n由于 $1\\,\\mathrm{J} = 1\\,\\mathrm{N \\cdot m}$，单位可以简化：\n$z_{\\mathrm{snap}}^3 = \\frac{20 \\times 10^{-28}}{1.5}\\,\\mathrm{m^3} \\approx 1.3333 \\times 10^{-27}\\,\\mathrm{m^3}$\n\n计算立方根：\n$z_{\\mathrm{snap}} = (1.3333 \\times 10^{-27}\\,\\mathrm{m^3})^{1/3} \\approx 1.1006 \\times 10^{-9}\\,\\mathrm{m}$\n\n将结果转换为纳米（nm）：\n$z_{\\mathrm{snap}} \\approx 1.1006\\,\\mathrm{nm}$\n\n根据要求，将答案四舍五入到三位有效数字，得到 $1.10\\,\\mathrm{nm}$。", "answer": "$$\\boxed{1.10}$$", "id": "2662545"}, {"introduction": "任何扫描探针显微镜的精度都取决于其压电扫描器的性能，但压电材料本身存在迟滞和非线性等固有缺陷。如果不对这些效应进行恰当的校正，它们会给图像和测量数据带来显著的畸变。本练习提供了一个实践性很强的计算任务，你将通过对扫描器位移数据的建模来量化这些非理想行为，这对于精确解读数据和校准仪器而言是一项至关重要的技能 [@problem_id:2662481]。", "problem": "您的任务是量化用于扫描探针显微镜 (SPM) 的压电扫描器的迟滞和非线性，具体应用背景为扫描隧道显微镜 (STM) 和原子力显微镜 (AFM)。在典型的实验中，由于铁电畴物理学和材料蠕变，驱动扫描器的压电致动器的位移与电压关系表现出路径依赖性，从而产生不同的正向和反向扫描曲线。在物理化学和材料表征领域，一种常见且经过充分检验的建模方法是，用电压的低阶多项式来近似每次扫描，然后计算在指定范围内总结迟滞和静态非线性的指标。\n\n从以下基本依据出发：\n\n- 扫描器位移与所施加电压的关系在有限范围内，可以很好地通过一个关于所施加电压的截断多项式来近似。这源于在工作点附近的 Taylor 展开，并被广泛用于捕捉压电致动器的低阶非线性和迟滞效应。\n- 普通最小二乘法用于估计模型参数，其方法是对于每个扫描方向，最小化模型预测值与观测数据之间的残差平方和。\n\n您的程序必须为每个测试用例实现以下内容：\n\n1. 数据生成：\n   - 使用一个包含 $N = 201$ 个点的均匀电压网格，范围从 $V_{\\min} = -50\\,\\mathrm{V}$ 到 $V_{\\max} = +50\\,\\mathrm{V}$。\n   - 按如下方式生成一个正向和一个反向的合成位移数据集。定义基础位移为 $x_{\\mathrm{base}}(V) = a_{1} V + a_{2} V^{2} + a_{3} V^{3}$，并定义一个反对称的迟滞贡献 $h(V) = h_{1} V + h_{3} V^{3}$。然后：\n     - 正向扫描位移（无噪声）：$x_{\\mathrm{f,true}}(V) = x_{\\mathrm{base}}(V) + h(V)$。\n     - 反向扫描位移（无噪声）：$x_{\\mathrm{b,true}}(V) = x_{\\mathrm{base}}(V) - h(V)$。\n   - 为每个位移样本添加均值为零、标准差为 $\\sigma$ 的独立同分布高斯噪声。为保证可复现性，对每个测试用例，正向扫描使用以给定整数种子 $s$ 初始化的伪随机数生成器，反向扫描使用种子 $s+1$。\n   - 位移单位必须是 $\\mathrm{nm}$，电压单位必须是 $\\mathrm{V}$。\n\n2. 多项式拟合：\n   - 通过普通最小二乘法（最小化残差平方和），将正向数据集和反向数据集分别拟合到关于 $V$ 的 $d = 3$ 次多项式。\n\n3. 迟滞幅度：\n   - 在一个从 $-50\\,\\mathrm{V}$ 到 $+50\\,\\mathrm{V}$、包含 $M = 1001$ 个电压点的密集均匀评估网格上，计算拟合的正向曲线 $x_{\\mathrm{f,fit}}(V)$ 和拟合的反向曲线 $x_{\\mathrm{b,fit}}(V)$。\n   - 将迟滞幅度 $H$ 定义为这两条拟合曲线在该范围内的最大绝对差值：\n     $$H = \\max_{V \\in [-50\\,\\mathrm{V},\\, +50\\,\\mathrm{V}]} \\left| x_{\\mathrm{f,fit}}(V) - x_{\\mathrm{b,fit}}(V) \\right|.$$\n   - 报告 $H$ 值，单位为 $\\mathrm{nm}$，四舍五入到 $3$ 位小数。\n\n4. 静态非线性：\n   - 在相同的密集网格上，定义平均拟合曲线为 $m(V) = \\dfrac{x_{\\mathrm{f,fit}}(V) + x_{\\mathrm{b,fit}}(V)}{2}$。\n   - 在密集网格上，通过普通最小二乘法将一个理想的线性参考 $L(V)$ 拟合到 $m(V)$（即，一个关于 $V$ 的 $1$ 次多项式）。\n   - 定义满量程范围 (full-scale range) $\\mathrm{FSR} = L(+50\\,\\mathrm{V}) - L(-50\\,\\mathrm{V})$。\n   - 将静态非线性定义为与线性参考的最大绝对偏差，并用满量程范围进行归一化：\n     $$\\mathrm{NL} = \\frac{ \\max_{V \\in [-50\\,\\mathrm{V},\\, +50\\,\\mathrm{V}]} \\left| m(V) - L(V) \\right| }{ \\mathrm{FSR} }.$$\n   - 报告 $\\mathrm{NL}$，形式为无单位小数（而非百分比），四舍五入到 $6$ 位小数。\n\n5. 输出格式：\n   - 对每个测试用例，输出一个包含两个条目 $[H, \\mathrm{NL}]$ 的列表。\n   - 您的程序应生成单行输出，其中包含所有测试用例的结果，格式为方括号括起来的逗号分隔列表，具体来说是一个列表的列表：$\\big[ [H_{1}, \\mathrm{NL}_{1}], [H_{2}, \\mathrm{NL}_{2}], \\dots \\big]$。\n\n测试套件（请严格按照指定参数使用；所有系数的单位均为 $\\mathrm{nm}$ 除以 $\\mathrm{V}$ 的相应幂次）：\n\n- 案例 $1$（轻微迟滞，弱非线性）：\n  - $a_{1} = 2.00$, $a_{2} = -1.0\\times 10^{-3}$, $a_{3} = 5.0\\times 10^{-6}$,\n  - $h_{1} = 0.20$, $h_{3} = 1.0\\times 10^{-5}$,\n  - $\\sigma = 0.02$, $s = 42$。\n- 案例 $2$（强迟滞，中等非线性）：\n  - $a_{1} = 2.00$, $a_{2} = -1.0\\times 10^{-3}$, $a_{3} = 1.0\\times 10^{-5}$,\n  - $h_{1} = 1.00$, $h_{3} = 3.0\\times 10^{-5}$,\n  - $\\sigma = 0.01$, $s = 7$。\n- 案例 $3$（纯线性，无迟滞，无噪声）：\n  - $a_{1} = 1.50$, $a_{2} = 0.0$, $a_{3} = 0.0$,\n  - $h_{1} = 0.0$, $h_{3} = 0.0$,\n  - $\\sigma = 0.0$, $s = 0$。\n- 案例 $4$（轻微非线性伴有小迟滞）：\n  - $a_{1} = 1.80$, $a_{2} = 1.5\\times 10^{-3}$, $a_{3} = -4.0\\times 10^{-6}$,\n  - $h_{1} = 0.10$, $h_{3} = 0.0$,\n  - $\\sigma = 0.015$, $s = 123$。\n\n角度单位不适用。确保 $H$ 以 $\\mathrm{nm}$ 为单位表示，并四舍五入到 $3$ 位小数；$\\mathrm{NL}$ 以小数形式表示，并四舍五入到 $6$ 位小数。您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，例如：$[[H_{1},\\mathrm{NL}_{1}],[H_{2},\\mathrm{NL}_{2}],[H_{3},\\mathrm{NL}_{3}],[H_{4},\\mathrm{NL}_{4}]]$。", "solution": "问题陈述经过了严格验证。它具有科学依据、问题设定良好且客观。它正确地阐述了实验物理化学中用于表征扫描探针显微镜所用压电致动器的一个标准流程。所提供的模型、定义和参数是一致的、符合物理现实的，并且足以得出一个唯一且有意义的解。因此，该问题被认定为有效。\n\n该解决方案要求实现一个计算协议，用以量化压电扫描器的两个关键性能指标：迟滞和静态非线性。该方法论遵循一系列逻辑步骤，从合成真实的测量数据开始，到计算指定的性能指标结束。\n\n首先，我们必须生成能够模拟物理扫描器行为的合成数据。压电元件的位移 $x$ 作为所施加电压 $V$ 的函数，其本身具有非线性并表现出迟滞效应。在有限的工作范围内，截断多项式模型是对此行为的一种成熟的近似方法。我们定义一个基础位移曲线 $x_{\\mathrm{base}}(V) = a_{1} V + a_{2} V^{2} + a_{3} V^{3}$，它捕捉了基本的非线性响应。在此基础上，我们增加一个迟滞贡献 $h(V) = h_{1} V + h_{3} V^{3}$，该贡献在正向扫描时加入，在反向扫描时减去，从而形成一个典型的迟滞回线。因此，真实无噪声的位移函数为：\n$$x_{\\mathrm{f,true}}(V) = x_{\\mathrm{base}}(V) + h(V)$$\n$$x_{\\mathrm{b,true}}(V) = x_{\\mathrm{base}}(V) - h(V)$$\n实验测量不可避免地会受到噪声的干扰。我们通过为每个数据点添加标准差为 $\\sigma$ 的独立同分布高斯噪声来模拟这种情况。这一过程在一个从 $V_{\\min}=-50\\,\\mathrm{V}$ 到 $V_{\\max}=+50\\,\\mathrm{V}$，包含 $N=201$ 个电压点 $V_i$ 的离散网格上执行。正向和反向扫描分别使用伪随机数生成器种子 $s$ 和 $s+1$，以正确模拟两次测量运行之间的统计独立性。\n\n其次，我们必须从这些带噪声的合成数据中估计出底层的扫描器响应。在真实实验中，真实函数 $x_{\\mathrm{f,true}}(V)$ 和 $x_{\\mathrm{b,true}}(V)$ 是未知的。我们通过将正向和反向数据集分别拟合到一个 $d=3$ 次的多项式来近似它们。这是一个模型辨识问题，使用普通最小二乘法 (OLS) 求解。OLS 确定一组多项式系数 $\\{c_k\\}$，以最小化残差平方和 $\\sum_i (x_{\\mathrm{data}}(V_i) - \\sum_{k=0}^{d} c_k V_i^k)^2$。此过程产生两条估计的响应曲线，$x_{\\mathrm{f,fit}}(V)$ 和 $x_{\\mathrm{b,fit}}(V)$。\n\n第三，我们量化迟滞幅度 $H$。迟滞是扫描器位移的路径依赖性。它被量化为在整个电压范围内，拟合的正向曲线和反向曲线之间的最大间距。为精确确定此最大值，我们在一个包含 $M=1001$ 个点的密集网格上评估拟合的多项式。迟滞幅度则为：\n$$H = \\max_{V \\in [V_{\\min},\\, V_{\\max}]} \\left| x_{\\mathrm{f,fit}}(V) - x_{\\mathrm{b,fit}}(V) \\right|$$\n\n第四，我们量化静态非线性 $\\mathrm{NL}$。该指标描述了扫描器的平均响应偏离理想线性行为的程度。我们首先计算平均路径 $m(V) = \\frac{1}{2}(x_{\\mathrm{f,fit}}(V) + x_{\\mathrm{b,fit}}(V))$，它代表扫描器响应的静态、非迟滞分量。然后，通过在密集评估网格上对 $m(V)$ 进行一阶多项式的 OLS 拟合，来确定一个理想的线性参考 $L(V)$。静态非线性是平均路径与该线性参考之间的最大绝对偏差，并由线性拟合的满量程范围 (FSR) 进行归一化，其中 $\\mathrm{FSR} = L(V_{\\max}) - L(V_{\\min})$。这种归一化产生了一个无量纲的量，适用于比较不同的扫描器。公式为：\n$$\\mathrm{NL} = \\frac{ \\max_{V \\in [V_{\\min},\\, V_{\\max}]} \\left| m(V) - L(V) \\right| }{ \\mathrm{FSR} }$$\n如果 $\\mathrm{FSR}$ 为零，会出现特殊情况；然而，对于任何非平凡的扫描器响应（$a_1 \\neq 0$），这种情况不会发生。\n\n最终的程序将为四个指定的测试用例中的每一个执行这整个序列，并按要求将得出的 $[H, \\mathrm{NL}]$ 对整理成单一的输出结构。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the SPM scanner characterization problem for a suite of test cases.\n    \"\"\"\n    test_cases = [\n        # Case 1: mild hysteresis, weak nonlinearity\n        {\n            \"a_coeffs\": (2.00, -1.0e-3, 5.0e-6),  # a1, a2, a3\n            \"h_coeffs\": (0.20, 1.0e-5),       # h1, h3\n            \"sigma\": 0.02,\n            \"seed\": 42\n        },\n        # Case 2: strong hysteresis, moderate nonlinearity\n        {\n            \"a_coeffs\": (2.00, -1.0e-3, 1.0e-5),\n            \"h_coeffs\": (1.00, 3.0e-5),\n            \"sigma\": 0.01,\n            \"seed\": 7\n        },\n        # Case 3: purely linear, no hysteresis, noiseless\n        {\n            \"a_coeffs\": (1.50, 0.0, 0.0),\n            \"h_coeffs\": (0.0, 0.0),\n            \"sigma\": 0.0,\n            \"seed\": 0\n        },\n        # Case 4: mild nonlinearity with small hysteresis\n        {\n            \"a_coeffs\": (1.80, 1.5e-3, -4.0e-6),\n            \"h_coeffs\": (0.10, 0.0),\n            \"sigma\": 0.015,\n            \"seed\": 123\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        # Unpack parameters\n        a1, a2, a3 = case[\"a_coeffs\"]\n        h1, h3 = case[\"h_coeffs\"]\n        sigma = case[\"sigma\"]\n        s = case[\"seed\"]\n\n        # Define constants\n        N = 201\n        M = 1001\n        V_min, V_max = -50.0, 50.0\n        fit_degree = 3\n\n        # 1. Data generation\n        V_data = np.linspace(V_min, V_max, N)\n\n        def x_base(V):\n            return a1 * V + a2 * V**2 + a3 * V**3\n\n        def h(V):\n            return h1 * V + h3 * V**3\n\n        x_f_true = x_base(V_data) + h(V_data)\n        x_b_true = x_base(V_data) - h(V_data)\n\n        # Generate noise\n        rng_f = np.random.default_rng(seed=s)\n        noise_f = rng_f.normal(0, sigma, N)\n        rng_b = np.random.default_rng(seed=s + 1)\n        noise_b = rng_b.normal(0, sigma, N)\n\n        x_f_data = x_f_true + noise_f\n        x_b_data = x_b_true + noise_b\n        \n        # 2. Polynomial fitting\n        coeffs_f = np.polyfit(V_data, x_f_data, fit_degree)\n        coeffs_b = np.polyfit(V_data, x_b_data, fit_degree)\n\n        poly_f = np.poly1d(coeffs_f)\n        poly_b = np.poly1d(coeffs_b)\n\n        # 3. Hysteresis magnitude (H)\n        V_eval = np.linspace(V_min, V_max, M)\n        x_f_fit = poly_f(V_eval)\n        x_b_fit = poly_b(V_eval)\n\n        H = np.max(np.abs(x_f_fit - x_b_fit))\n\n        # 4. Static nonlinearity (NL)\n        m_V = (x_f_fit + x_b_fit) / 2.0\n        \n        # Fit linear reference L(V) to m(V)\n        coeffs_L = np.polyfit(V_eval, m_V, 1)\n        poly_L = np.poly1d(coeffs_L)\n        \n        # Calculate full-scale range (FSR)\n        FSR = poly_L(V_max) - poly_L(V_min)\n        \n        # Calculate nonlinearity\n        L_V = poly_L(V_eval)\n        max_deviation = np.max(np.abs(m_V - L_V))\n\n        # Handle FSR=0 case to avoid division by zero, although unlikely with given inputs\n        if np.isclose(FSR, 0):\n             NL = 0.0\n        else:\n             NL = max_deviation / FSR\n             \n        # Format results for the current case\n        result = [round(H, 3), round(NL, 6)]\n        all_results.append(result)\n\n    # Final print statement in the exact required format.\n    # The default string representation of a list in Python is the required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```", "id": "2662481"}]}