{"hands_on_practices": [{"introduction": "动力学同位素效应 (KIE) 的核心在于同位素取代如何改变反应的活化能。这一实践练习将带你回到问题的根本，通过一个简化的阿伦尼乌斯模型，让你亲手计算由零点能差异引起的活化能变化如何直接影响反应速率常数之比。这个基础计算清晰地揭示了 KIE 的能量起源，是理解更复杂模型的第一步。[@problem_id:1520113]", "problem": "在有机金属化学领域，理解反应机理对于设计更高效的催化剂至关重要。一位化学家正在研究一种新型的催化C-H键活化反应。该反应的速率决定步骤被认为是此C-H键的断裂。为了检验这一假设，该化学家合成了一种同位素标记的反应物，其中参与断裂的特定氢原子被其更重的同位素——氘（D）所取代。\n\n在 $298 \\text{ K}$ 的恒定温度下，对含普通氢（H）和含氘（D）的反应物所发生的反应进行了研究。该化学家测定出，含氘反应物的反应活化能比含普通氢反应物的反应活化能正好高出 $4.8 \\text{ kJ/mol}$。假设两个反应的阿伦尼乌斯方程中的指前因子相同，计算一级动力学同位素效应（KIE）的值，其定义为含氢反应物的速率常数（$k_H$）与含氘反应物的速率常数（$k_D$）之比。\n\n使用理想气体常数值 $R = 8.314 \\text{ J} \\cdot \\text{mol}^{-1} \\cdot \\text{K}^{-1}$。最终答案以无量纲数的形式报告，并四舍五入到三位有效数字。", "solution": "速率常数的阿伦尼乌斯方程为\n$$\nk = A \\exp\\!\\left(-\\frac{E_{a}}{RT}\\right),\n$$\n其中 $A$ 是指前因子，$E_{a}$ 是活化能，$R$ 是理想气体常数，$T$ 是温度。对于含氢和含氘的底物（根据假设，$A$ 相同），一级动力学同位素效应为\n$$\n\\frac{k_{H}}{k_{D}}=\\frac{A \\exp\\!\\left(-\\frac{E_{a}(H)}{RT}\\right)}{A \\exp\\!\\left(-\\frac{E_{a}(D)}{RT}\\right)}=\\exp\\!\\left(\\frac{E_{a}(D)-E_{a}(H)}{RT}\\right).\n$$\n已知 $E_{a}(D)-E_{a}(H)=4.8 \\times 10^{3}\\ \\text{J}\\cdot\\text{mol}^{-1}$，$R=8.314\\ \\text{J}\\cdot\\text{mol}^{-1}\\cdot\\text{K}^{-1}$，且 $T=298\\ \\text{K}$，计算\n$$\n\\frac{k_{H}}{k_{D}}=\\exp\\!\\left(\\frac{4.8\\times 10^{3}}{8.314\\times 298}\\right)=\\exp\\!\\left(\\frac{4800}{2477.572}\\right)\\approx \\exp(1.93738)\\approx 6.94.\n$$\n因此，一级 KIE 约等于 $6.94$。", "answer": "$$\\boxed{6.94}$$", "id": "1520113"}, {"introduction": "单个KIE值可以告诉我们一个化学键是否在限速步骤中被断裂，但通过比较涉及不同同位素（如H、D、T）的KIE，我们可以获得关于过渡态几何形状和反应路径的更深层信息。Swain-Schaad关系式为这些KIE值之间的关联提供了一个半经典理论基准。这项实践将指导你如何运用该关系式作为一个诊断工具，通过比较实验数据与理论预测的偏差，来推断是否存在量子隧穿或非线性过渡态等更为复杂的机理特征。[@problem_id:1520159]", "problem": "一位酶学家正在研究一种由黄素酶催化的氢负离子转移反应的机理。为了探究过渡态的性质，在298 K下进行了动力学同位素效应（KIE）研究。分别使用含普通氢的底物（H）、转移的氢负离子被氘（D）取代的底物以及被氚（T）取代的底物来测量反应速率。\n\n实验测得的一级动力学同位素效应为：\n- $k_H/k_D = 9.50$\n- $k_D/k_T = 2.65$\n\nSwain-Schaad关系式是一个从简化的半经典模型推导出的理论预测。该模型假设过渡态是线性的，反应坐标仅由键伸缩振动构成，并且量子力学隧穿效应可以忽略不计。实验数据与该关系式之间的差异为了解该简化模型未能捕捉的机理特征（如隧穿效应或非线性过渡态）提供了线索。\n\n这种差异的程度可以通过计算一个*有效*实验指数 $C_{exp}$ 来量化，该指数使用测量的KIE值满足以下方程：\n$$ \\left(\\frac{k_H}{k_T}\\right)_{exp} = \\left(\\left(\\frac{k_H}{k_D}\\right)_{exp}\\right)^{C_{exp}} $$\n根据所提供的实验数据，计算此有效指数 $C_{exp}$ 的值。将您的最终答案四舍五入到三位有效数字。", "solution": "实验的总比率可以通过同位素效应的乘积得到：\n$$\\left(\\frac{k_{H}}{k_{T}}\\right)_{exp}=\\left(\\frac{k_{H}}{k_{D}}\\right)_{exp}\\left(\\frac{k_{D}}{k_{T}}\\right)_{exp}=9.50\\times 2.65=25.175.$$\n定义 $C_{exp}$ 如下\n$$\\left(\\frac{k_{H}}{k_{T}}\\right)_{exp}=\\left(\\left(\\frac{k_{H}}{k_{D}}\\right)_{exp}\\right)^{C_{exp}},$$\n得到\n$$25.175=9.50^{C_{exp}}.$$\n取自然对数并求解 $C_{exp}$：\n$$\\ln(25.175)=C_{exp}\\ln(9.50),\\quad C_{exp}=\\frac{\\ln(25.175)}{\\ln(9.50)}.$$\n数值上，\n$$C_{exp}\\approx \\frac{3.225851438}{2.251291799}\\approx 1.43289,$$\n四舍五入到三位有效数字为 $1.43$。", "answer": "$$\\boxed{1.43}$$", "id": "1520159"}, {"introduction": "为了构建一个完整且具有预测能力的KIE模型，我们必须超越简化关系式，转向全面的统计力学处理。本练习将引导你使用Rice–Ramsperger–Kassel–Marcus (RRKM) 理论，在高压极限下它等效于过渡态理论 (TST)，从第一性原理出发构建KIE模型。这项高级计算实践将指导你利用从量子化学计算中获得的分子参数（振动频率、转动常数），亲手搭建一个KIE预测程序，从而将基础理论与现代计算化学的工作流程紧密联系起来。[@problem_id:2677472]", "problem": "您的任务是构建一个完整且可运行的程序，该程序使用高压极限下的 Rice–Ramsperger–Kassel–Marcus (RRKM) 理论，在反应物和过渡态均采用可分离谐振子和刚性转子近似的情况下，计算单分子反应的动力学同位素效应 (KIE)。该程序必须实现一个基于第一性原理的、有原则的工作流程，从 RRKM 理论的微正则定义出发，推导出适用于指定条件的正则系综热速率表达式。该工作流程必须一致且自洽地仅使用所提供的两种同位素体（轻同位素体和重同位素体）的谐振频率和刚性转子转动常数，以及经典势垒高度，同时正确地纳入零点能差异和转动对称数。\n\n请使用以下内容作为基础起点（不得使用任何其他未经证明或针对特定问题的捷径公式作为起点）：\n- 微正则 RRKM 定义，即单分子微正则速率常数由过渡态的态求和与反应物的态密度之比乘以普朗克常数给出，即 $k(E) = N^{\\ddagger}(E - E_{0}) / \\left(h \\,\\rho(E)\\right)$。\n- 正则系综定义，即热速率常数是使用玻尔兹曼权重对能量进行的系综平均。\n- 用于振动的可分离谐振子模型和用于转动的刚性转子模型。\n- 零点能的定义，即谐振动量子能量之和的一半。\n- 在相同的可分离性假设下，RRKM 理论的高压极限等效于过渡态系综平均。\n\n您的程序必须为每个测试用例计算正则动力学同位素效应，其定义为热单分子速率常数之比，\n$ \\mathrm{KIE}(T) = k_{\\text{light}}(T) / k_{\\text{heavy}}(T), $\n并且仅使用每种同位素体的以下输入：\n- 温度 $T$，单位为开尔文。\n- 经典势垒高度 $E_{0}$，单位为 $\\mathrm{kJ\\,mol^{-1}}$。\n- 反应物振动频率，以波数列表形式给出，单位为 $\\mathrm{cm^{-1}}$。\n- 过渡态振动频率，以实数（非虚数）波数列表形式给出，单位为 $\\mathrm{cm^{-1}}$。\n- 反应物转动常数 $\\{A,B,C\\}$，单位为 $\\mathrm{cm^{-1}}$。\n- 过渡态转动常数 $\\{A,B,C\\}$，单位为 $\\mathrm{cm^{-1}}$。\n- 反应物转动对称数 $\\sigma_{\\mathrm{R}}$ 和过渡态转动对称数 $\\sigma_{\\ddagger}}$（均为无量纲整数）。\n\n您的工作流程必须：\n- 从 RRKM 理论的能量分辨定义开始，并执行正则变换以获得适用于高压极限的热速率常数，证明在比较相同同位素体的状态时平动贡献的抵消，并解释转动对称性如何通过刚性转子配分函数引入。\n- 从振动频率构建谐振动配分函数，并使用谐振近似计算每种同位素体对经典势垒的零点能校正。\n- 从转动常数和转动对称数构建非线性刚性转子配分函数。\n- 结合这些元素以获得每种同位素体的热单分子速率，从而得到 KIE。\n- 在需要时仅使用基本常数 $h$、$k_{\\mathrm{B}}$、$c$ 和 $N_{\\mathrm{A}}$，并进行正确的物理单位转换。所有涉及物理单位的答案必须在内部以国际单位制表示，任何输入或输出单位要求均在下文明确指定。\n\n单位要求和转换：\n- 输入温度必须以开尔文（$\\mathrm{K}$）为单位。\n- 输入能量必须以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位，并使用阿伏伽德罗常数转换为每个分子的焦耳（$\\mathrm{J}$）。\n- 输入的振动频率和转动常数以波数（$\\mathrm{cm^{-1}}$）给出。使用 $E = h\\,c\\,\\tilde{\\nu}$ 进行能量转换，其中 $\\tilde{\\nu}$ 的单位为 $\\mathrm{m^{-1}}$。为方便起见，请注意 $\\tilde{\\nu}\\,(\\mathrm{m^{-1}}) = 100 \\times \\tilde{\\nu}\\,(\\mathrm{cm^{-1}})$。\n- 程序内部对所有计算的能量必须使用 $\\mathrm{SI}$ 单位。\n\n角度单位不适用。输出中不出现百分比。\n\n测试套件：\n为以下三个测试用例中的每一个提供 KIE。对于每个用例，计算一个定义为 $k_{\\text{light}}(T)/k_{\\text{heavy}}(T)$ 的单浮点数：\n1. 正常路径，中等温度：\n   - $T = 298.15\\,\\mathrm{K}$。\n   - $E_{0} = 120.0\\,\\mathrm{kJ\\,mol^{-1}}$。\n   - 轻同位素体反应物振动频率（单位 $\\mathrm{cm^{-1}}$）：$\\{3000,1500,1400,1200,1000,800,600,400,200\\}$。\n   - 轻同位素体过渡态振动频率（单位 $\\mathrm{cm^{-1}}$；仅实数模式）：$\\{1200,1100,900,800,700,500,300,200\\}$。\n   - 重同位素体反应物振动频率（单位 $\\mathrm{cm^{-1}}$）：$\\{2200,1500,1400,1200,1000,800,600,400,200\\}$。\n   - 重同位素体过渡态振动频率（单位 $\\mathrm{cm^{-1}}$；仅实数模式）：$\\{900,1100,900,800,700,500,300,200\\}$。\n   - 轻同位素体反应物转动常数（单位 $\\mathrm{cm^{-1}}$）：$\\{0.30,0.20,0.10\\}$。\n   - 轻同位素体过渡态转动常数（单位 $\\mathrm{cm^{-1}}$）：$\\{0.25,0.18,0.09\\}$。\n   - 重同位素体反应物转动常数（单位 $\\mathrm{cm^{-1}}$）：$\\{0.28,0.19,0.095\\}$。\n   - 重同位素体过渡态转动常数（单位 $\\mathrm{cm^{-1}}$）：$\\{0.23,0.17,0.085\\}$。\n   - 转动对称数：$\\sigma_{\\mathrm{R}}^{\\text{light}}=\\sigma_{\\ddagger}^{\\text{light}}=\\sigma_{\\mathrm{R}}^{\\text{heavy}}=\\sigma_{\\ddagger}^{\\text{heavy}}=1$。\n2. 与测试用例1相同的分子数据，但在较低温度下：\n   - $T = 150.0\\,\\mathrm{K}$，所有其他参数与测试用例1相同。\n3. 高温，对称性变化主导的情况：\n   - $T = 1000.0\\,\\mathrm{K}$。\n   - $E_{0} = 50.0\\,\\mathrm{kJ\\,mol^{-1}}$。\n   - 轻同位素体反应物振动频率（单位 $\\mathrm{cm^{-1}}$）：$\\{1000,800,600,400\\}$。\n   - 轻同位素体过渡态振动频率（单位 $\\mathrm{cm^{-1}}$；仅实数模式）：$\\{900,700,500\\}$。\n   - 重同位素体反应物振动频率（单位 $\\mathrm{cm^{-1}}$）：$\\{980,790,590,390\\}$。\n   - 重同位素体过渡态振动频率（单位 $\\mathrm{cm^{-1}}$；仅实数模式）：$\\{880,690,490\\}$。\n   - 轻同位素体反应物转动常数（单位 $\\mathrm{cm^{-1}}$）：$\\{0.20,0.15,0.10\\}$。\n   - 轻同位素体过渡态转动常数（单位 $\\mathrm{cm^{-1}}$）：$\\{0.18,0.14,0.09\\}$。\n   - 重同位素体反应物转动常数（单位 $\\mathrm{cm^{-1}}$）：$\\{0.195,0.145,0.095\\}$。\n   - 重同位素体过渡态转动常数（单位 $\\mathrm{cm^{-1}}$）：$\\{0.175,0.135,0.085\\}$。\n   - 转动对称数：$\\sigma_{\\mathrm{R}}^{\\text{light}}=2$, $\\sigma_{\\ddagger}^{\\text{light}}=1$, $\\sigma_{\\mathrm{R}}^{\\text{heavy}}=1$, $\\sigma_{\\ddagger}^{\\text{heavy}}=1$。\n\n输出规范：\n- 对于每个测试用例，计算单个浮点数值 $\\mathrm{KIE}(T)$。\n- 您的程序应生成单行输出，其中包含三个结果，格式为逗号分隔的列表，并用方括号括起来，例如 $\\big[$result\\_1,result\\_2,result\\_3$\\big]$。\n- 不得打印任何附加文本。\n\n科学真实性约束：\n- 假设所有情况均为非线性转子。\n- 假设过渡态振动列表排除了单个不稳定（虚数）模式。\n- 必须一致地处理平动贡献，并注意在比较单分子反应中相同同位素体的状态时出现的任何抵消。\n- 所有数值常数、单位和转换必须物理上正确且一致地应用。\n\n您的程序必须是完全自包含的，并且不得读取任何输入。", "solution": "我们从单分子反应速率常数在固定能量 $E$ 下的微正则 Rice–Ramsperger–Kassel–Marcus (RRKM) 定义开始，\n$$\nk(E) = \\frac{N^{\\ddagger}(E - E_{0})}{h\\,\\rho(E)},\n$$\n其中 $N^{\\ddagger}(E - E_{0})$ 是过渡态（不包括不稳定模式）在能量达到 $E - E_{0}$ 时的态求和，$\\rho(E)$ 是反应物的态密度，$h$ 是普朗克常数。通过对反应物的能量分布进行玻尔兹曼平均，可以得到正则系综热速率常数。通过态密度和态求和的拉普拉斯变换来定义正则配分函数，可以得到一个标准关系式，在高压极限（在该极限下，RRKM 系综平均等于可分离性假设下的过渡态理论系综平均）下，该关系式产生\n$$\nk(T) = \\frac{k_{\\mathrm{B}} T}{h}\\,\\frac{Q^{\\ddagger}(T)}{Q_{\\mathrm{R}}(T)}\\,\\exp\\!\\left[-\\beta\\,\\Delta E_{\\mathrm{eff}}\\right],\n$$\n其中 $\\beta = 1/(k_{\\mathrm{B}}T)$，$Q^{\\ddagger}(T)$ 是不包括反应坐标的过渡态配分函数，$Q_{\\mathrm{R}}(T)$ 是反应物配分函数，而 $\\Delta E_{\\mathrm{eff}}$ 是包含零点能（ZPE）校正的有效势垒高度，\n$$\n\\Delta E_{\\mathrm{eff}} = E_{0} + \\left(\\mathrm{ZPE}^{\\ddagger} - \\mathrm{ZPE}_{\\mathrm{R}}\\right).\n$$\n这是通过对 $N^{\\ddagger}(E-E_{0})$ 和 $\\rho(E)$ 应用拉普拉斯变换，利用卷积定理，并认识到对 $E$ 的导数对应于拉普拉斯空间中的乘以 $\\beta$，当转换回正则系综时，得到因子 $k_{\\mathrm{B}}T/h$。\n\n现在我们在可分离谐振子和刚性转子近似下构建配分函数。对于同一同位素体内过渡态与反应物之间的单分子反应速率比，平动贡献不是必需的，因为单个分子的平动配分函数在分子和分母之间被抵消。具体来说，对于给定的同位素体，反应物和紧凑的过渡态描述了在相同体积中的相同总质量和分子数，因此平动配分函数之比为1。因此，为了计算 $Q^{\\ddagger}(T)/Q_{\\mathrm{R}}(T)$，我们只包括内振动和转动。\n\n对于谐振动模式（不包括过渡态的单个虚频模式），谐振子配分函数可分解为各模式的乘积。设振动波数以反厘米给出。我们定义模式 $i$ 的振动特征温度为\n$$\n\\theta^{\\mathrm{vib}}_i = \\frac{h\\,c\\,\\tilde{\\nu}_i}{k_{\\mathrm{B}}} = \\frac{h\\,c\\,(100)\\,\\tilde{\\nu}_i^{(\\mathrm{cm}^{-1})}}{k_{\\mathrm{B}}},\n$$\n这样无量纲量即为 $\\theta_i^{\\mathrm{vib}}/T$。不包括零点能贡献的谐振配分函数是\n$$\nq_{\\mathrm{vib}} = \\prod_{i} \\frac{1}{1 - \\exp\\!\\left(-\\theta_i^{\\mathrm{vib}}/T\\right)}.\n$$\n一组模式的零点能是\n$$\n\\mathrm{ZPE} = \\frac{1}{2}\\sum_{i} h\\,c\\,\\tilde{\\nu}_i = \\frac{1}{2}\\sum_{i} h\\,c\\,(100)\\,\\tilde{\\nu}_i^{(\\mathrm{cm}^{-1})}.\n$$\n\n对于转动，我们模拟一个非线性刚性转子，并基于以反厘米为单位的转动常数 $A,B,C$ 定义转动特征温度：\n$$\n\\theta^{\\mathrm{rot}}_{A} = \\frac{h\\,c\\,A}{k_{\\mathrm{B}}}, \\quad\n\\theta^{\\mathrm{rot}}_{B} = \\frac{h\\,c\\,B}{k_{\\mathrm{B}}}, \\quad\n\\theta^{\\mathrm{rot}}_{C} = \\frac{h\\,c\\,C}{k_{\\mathrm{B}}}.\n$$\n在高温刚性转子极限下（对于我们测试套件中相对于 $T$ 的典型分子参数是合适的），经典的非线性刚性转子配分函数是\n$$\nq_{\\mathrm{rot}} = \\frac{\\sqrt{\\pi}}{\\sigma}\\,\\frac{T^{3/2}}{\\sqrt{\\theta^{\\mathrm{rot}}_{A}\\,\\theta^{\\mathrm{rot}}_{B}\\,\\theta^{\\mathrm{rot}}_{C}}},\n$$\n其中 $\\sigma$ 是转动对称数。当 $T$ 和转动特征温度都以开尔文为单位时，该表达式是无量纲且物理上一致的。\n\n综合各个部分，给定同位素体的热速率常数计算如下\n$$\nk(T) = \\frac{k_{\\mathrm{B}} T}{h}\\,\n\\frac{q_{\\mathrm{rot}}^{\\ddagger}\\,q_{\\mathrm{vib}}^{\\ddagger}}{q_{\\mathrm{rot}}^{\\mathrm{R}}\\,q_{\\mathrm{vib}}^{\\mathrm{R}}}\\,\n\\exp\\!\\left[-\\beta\\left(E_{0} + \\mathrm{ZPE}^{\\ddagger} - \\mathrm{ZPE}_{\\mathrm{R}}\\right)\\right],\n$$\n其中 $E_{0}$ 的单位是每个分子的焦耳。由于输入指定 $E_{0}$ 的单位是 $\\mathrm{kJ\\,mol^{-1}}$，我们使用阿伏伽德罗常数 $N_{\\mathrm{A}}$ 进行转换：\n$$\nE_{0}^{(\\mathrm{per\\ molecule})} = \\frac{E_{0}^{(\\mathrm{kJ/mol})}\\times 10^{3}}{N_{\\mathrm{A}}} \\;\\; \\mathrm{J}.\n$$\n\n动力学同位素效应 (KIE) 是以下比率\n$$\n\\mathrm{KIE}(T) = \\frac{k_{\\text{light}}(T)}{k_{\\text{heavy}}(T)}.\n$$\n\n适合实现的算法设计：\n1. 解析每个测试用例的参数：温度 $T$，经典势垒 $E_{0}$，两种同位素体的反应物和过渡态的振动频率列表（不包括过渡态的虚频），两种同位素体的反应物和过渡态的转动常数 $\\{A,B,C\\}$，以及对称数 $\\sigma_{\\mathrm{R}}$ 和 $\\sigma_{\\ddagger}$。\n2. 预计算转换因子 $\\Theta_{\\mathrm{fac}} = \\left(h\\,c\\,(100)\\right)/k_{\\mathrm{B}}$，用于将任何以 $\\mathrm{cm^{-1}}$ 为单位的波数转换为以开尔文为单位的特征温度。同时计算 $E_{\\mathrm{fac}} = h\\,c\\,(100)$，用于将波数转换为以焦耳为单位的能量。\n3. 对于每种同位素体和状态（反应物或过渡态）：\n   - 计算振动特征温度集 $\\theta^{\\mathrm{vib}}_i$，并为数值稳定性计算 $\\ln q_{\\mathrm{vib}} = -\\sum_{i}\\ln\\!\\left(1 - e^{-\\theta^{\\mathrm{vib}}_i/T}\\right)$。\n   - 计算 $\\mathrm{ZPE} = \\frac{1}{2}\\,E_{\\mathrm{fac}}\\sum_{i}\\tilde{\\nu}_i^{(\\mathrm{cm}^{-1})}$。\n   - 计算转动特征温度 $\\theta^{\\mathrm{rot}}_{A,B,C}$，然后计算 $\\ln q_{\\mathrm{rot}} = \\tfrac{1}{2}\\ln \\pi + \\tfrac{3}{2}\\ln T - \\tfrac{1}{2}\\ln\\!\\left(\\theta^{\\mathrm{rot}}_{A}\\theta^{\\mathrm{rot}}_{B}\\theta^{\\mathrm{rot}}_{C}\\right) - \\ln \\sigma$。\n4. 对于每种同位素体，组合成\n   $$\n   \\ln k(T) = \\ln\\!\\left(\\frac{k_{\\mathrm{B}}T}{h}\\right) + \\left[\\ln q_{\\mathrm{rot}}^{\\ddagger} + \\ln q_{\\mathrm{vib}}^{\\ddagger} - \\ln q_{\\mathrm{rot}}^{\\mathrm{R}} - \\ln q_{\\mathrm{vib}}^{\\mathrm{R}}\\right] - \\beta\\left(E_{0} + \\mathrm{ZPE}^{\\ddagger} - \\mathrm{ZPE}_{\\mathrm{R}}\\right),\n   $$\n   然后计算 $k(T) = \\exp\\left(\\ln k(T)\\right)$。\n5. 计算 $\\mathrm{KIE}(T)$ 作为轻同位素体与重同位素体速率常数之比。\n6. 以指定的输出格式聚合所有测试用例的结果。\n\n科学考量与边界情况：\n- 在内部配分函数比中没有平动贡献是合理的，因为对于单分子反应，对于给定的同位素体，分子和分母都对应于相同体积中的相同分子；因此 $Q_{\\mathrm{trans}}$ 在 $Q^{\\ddagger}/Q_{\\mathrm{R}}$ 中被抵消。这种抵消在每种同位素体内部分别发生；因此平动因子对 KIE 没有贡献。\n- 过渡态列表必须排除虚频，因此在计算 $q_{\\mathrm{vib}}^{\\ddagger}$ 和 $\\mathrm{ZPE}^{\\ddagger}$ 时只计算实振动模式。\n- 转动对称数通过 $q_{\\mathrm{rot}}$ 出现，当同位素取代破坏对称性时，可以对 KIE 产生主要贡献。\n- 通过以对数形式计算配分函数可以提高数值稳定性。\n- 所有单位转换都使用 $h$、$k_{\\mathrm{B}}$、$c$ 和 $N_{\\mathrm{A}}$，确保物理一致性。\n\n该程序为三个指定的测试用例实现了此工作流程，并输出一行包含三个浮点 KIE 值的逗号分隔列表（在方括号内）。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Physical constants (SI)\nh = 6.62607015e-34        # Planck constant, J s\nkB = 1.380649e-23         # Boltzmann constant, J/K\nc = 299792458.0           # Speed of light, m/s\nNA = 6.02214076e23        # Avogadro constant, 1/mol\n\n# Precompute useful conversion factors\n# Wavenumber (cm^-1) to characteristic temperature (K): theta = (h c 100 * nu_cm) / kB\nTHETA_FACTOR = (h * c * 100.0) / kB  # K per (cm^-1)\n# Wavenumber (cm^-1) to energy (J): E = h c 100 * nu_cm\nENERGY_PER_WAVENUMBER = h * c * 100.0  # J per (cm^-1)\n# kJ/mol to J per molecule\ndef kJmol_to_J_per_molecule(x_kJ_per_mol: float) - float:\n    return (x_kJ_per_mol * 1000.0) / NA\n\ndef ln_q_vib_from_wavenumbers_cm(nu_cm: np.ndarray, T: float) - float:\n    \"\"\"\n    Harmonic vibrational partition function (excluding ZPE), in log form:\n    ln q_vib = - sum_i ln(1 - exp(- theta_i / T)), theta_i = THETA_FACTOR * nu_i\n    \"\"\"\n    if len(nu_cm) == 0:\n        return 0.0\n    theta = THETA_FACTOR * np.array(nu_cm, dtype=float)  # in K\n    x = -theta / T\n    # To avoid underflow for very negative x, exp(x) ~ 0 - ln(1 - 0) = 0; safe in double precision\n    ln_terms = np.log1p(-np.exp(x))  # ln(1 - exp(x))\n    return -np.sum(ln_terms)\n\ndef zpe_from_wavenumbers_cm(nu_cm: np.ndarray) - float:\n    \"\"\"\n    Zero-point energy in J per molecule: ZPE = 1/2 * sum_i (h c 100 * nu_i)\n    \"\"\"\n    if len(nu_cm) == 0:\n        return 0.0\n    return 0.5 * ENERGY_PER_WAVENUMBER * float(np.sum(np.array(nu_cm, dtype=float)))\n\ndef ln_q_rot_nonlinear_from_rotconsts_cm(rot_consts_cm: np.ndarray, sigma: int, T: float) - float:\n    \"\"\"\n    Classical non-linear rigid-rotor partition function, in log form:\n    q_rot = sqrt(pi)/sigma * T^(3/2) / sqrt(theta_A theta_B theta_C)\n    with theta_i = THETA_FACTOR * B_i (in cm^-1)\n    \"\"\"\n    A, B, C = [float(x) for x in rot_consts_cm]\n    thetaA = THETA_FACTOR * A\n    thetaB = THETA_FACTOR * B\n    thetaC = THETA_FACTOR * C\n    # Ensure positive rotational constants\n    if thetaA = 0 or thetaB = 0 or thetaC = 0:\n        raise ValueError(\"Rotational constants must be positive.\")\n    ln_q = 0.5 * np.log(np.pi) + 1.5 * np.log(T) - 0.5 * np.log(thetaA * thetaB * thetaC) - np.log(float(sigma))\n    return float(ln_q)\n\ndef ln_rate_TST_like(params: dict) - float:\n    \"\"\"\n    Compute ln k(T) using high-pressure limit RRKM (equivalent to canonical TST under separability).\n    params keys:\n      T, E0_kJmol,\n      vib_R_cm (list), vib_TS_cm (list),\n      rot_R_cm (3-list), rot_TS_cm (3-list),\n      sigma_R (int), sigma_TS (int)\n    \"\"\"\n    T = float(params[\"T\"])\n    beta = 1.0 / (kB * T)\n    E0 = kJmol_to_J_per_molecule(float(params[\"E0_kJmol\"]))\n    vib_R = np.array(params[\"vib_R_cm\"], dtype=float)\n    vib_TS = np.array(params[\"vib_TS_cm\"], dtype=float)\n    rot_R = np.array(params[\"rot_R_cm\"], dtype=float)\n    rot_TS = np.array(params[\"rot_TS_cm\"], dtype=float)\n    sigma_R = int(params[\"sigma_R\"])\n    sigma_TS = int(params[\"sigma_TS\"])\n\n    # Vibrational ln partition functions\n    ln_qv_R = ln_q_vib_from_wavenumbers_cm(vib_R, T)\n    ln_qv_TS = ln_q_vib_from_wavenumbers_cm(vib_TS, T)\n\n    # Rotational ln partition functions\n    ln_qr_R = ln_q_rot_nonlinear_from_rotconsts_cm(rot_R, sigma_R, T)\n    ln_qr_TS = ln_q_rot_nonlinear_from_rotconsts_cm(rot_TS, sigma_TS, T)\n\n    # Zero-point energies\n    zpe_R = zpe_from_wavenumbers_cm(vib_R)\n    zpe_TS = zpe_from_wavenumbers_cm(vib_TS)\n\n    # ln(kB T / h)\n    ln_pref = np.log(kB * T / h)\n\n    # Effective barrier with ZPE correction\n    delta_E_eff = E0 + (zpe_TS - zpe_R)\n\n    ln_k = ln_pref + (ln_qr_TS + ln_qv_TS - ln_qr_R - ln_qv_R) - beta * delta_E_eff\n    return float(ln_k)\n\ndef compute_KIE_for_case(case: dict) - float:\n    \"\"\"\n    Given a test case with 'light' and 'heavy' parameter dicts and temperature/barrier,\n    compute KIE = k_light / k_heavy.\n    \"\"\"\n    ln_k_light = ln_rate_TST_like(case[\"light\"])\n    ln_k_heavy = ln_rate_TST_like(case[\"heavy\"])\n    ln_KIE = ln_k_light - ln_k_heavy\n    return float(np.exp(ln_KIE))\n\ndef solve():\n    # Define the test cases from the problem statement.\n\n    # Common dataset for cases 1 and 2\n    common_light = {\n        \"vib_R_cm\": [3000.0, 1500.0, 1400.0, 1200.0, 1000.0, 800.0, 600.0, 400.0, 200.0],\n        \"vib_TS_cm\": [1200.0, 1100.0, 900.0, 800.0, 700.0, 500.0, 300.0, 200.0],\n        \"rot_R_cm\": [0.30, 0.20, 0.10],\n        \"rot_TS_cm\": [0.25, 0.18, 0.09],\n        \"sigma_R\": 1,\n        \"sigma_TS\": 1,\n    }\n    common_heavy = {\n        \"vib_R_cm\": [2200.0, 1500.0, 1400.0, 1200.0, 1000.0, 800.0, 600.0, 400.0, 200.0],\n        \"vib_TS_cm\": [900.0, 1100.0, 900.0, 800.0, 700.0, 500.0, 300.0, 200.0],\n        \"rot_R_cm\": [0.28, 0.19, 0.095],\n        \"rot_TS_cm\": [0.23, 0.17, 0.085],\n        \"sigma_R\": 1,\n        \"sigma_TS\": 1,\n    }\n\n    case1 = {\n        \"light\": dict({\"T\": 298.15, \"E0_kJmol\": 120.0}, **common_light),\n        \"heavy\": dict({\"T\": 298.15, \"E0_kJmol\": 120.0}, **common_heavy),\n    }\n    case2 = {\n        \"light\": dict({\"T\": 150.0, \"E0_kJmol\": 120.0}, **common_light),\n        \"heavy\": dict({\"T\": 150.0, \"E0_kJmol\": 120.0}, **common_heavy),\n    }\n\n    # Case 3 distinct data with symmetry change\n    case3_light = {\n        \"T\": 1000.0,\n        \"E0_kJmol\": 50.0,\n        \"vib_R_cm\": [1000.0, 800.0, 600.0, 400.0],\n        \"vib_TS_cm\": [900.0, 700.0, 500.0],\n        \"rot_R_cm\": [0.20, 0.15, 0.10],\n        \"rot_TS_cm\": [0.18, 0.14, 0.09],\n        \"sigma_R\": 2,\n        \"sigma_TS\": 1,\n    }\n    case3_heavy = {\n        \"T\": 1000.0,\n        \"E0_kJmol\": 50.0,\n        \"vib_R_cm\": [980.0, 790.0, 590.0, 390.0],\n        \"vib_TS_cm\": [880.0, 690.0, 490.0],\n        \"rot_R_cm\": [0.195, 0.145, 0.095],\n        \"rot_TS_cm\": [0.175, 0.135, 0.085],\n        \"sigma_R\": 1,\n        \"sigma_TS\": 1,\n    }\n    case3 = {\"light\": case3_light, \"heavy\": case3_heavy}\n\n    test_cases = [case1, case2, case3]\n\n    results = []\n    for case in test_cases:\n        result = compute_KIE_for_case(case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2677472"}]}