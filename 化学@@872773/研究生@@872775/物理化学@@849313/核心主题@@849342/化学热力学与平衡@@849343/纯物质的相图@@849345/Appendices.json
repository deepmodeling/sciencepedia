{"hands_on_practices": [{"introduction": "克劳修斯-克拉佩龙方程是描述相平衡的核心工具，它将宏观可测量的蒸气压曲线与分子的蒸发焓 $\\Delta H_{\\text{vap}}$ 联系起来。本练习将引导你从第一性原理出发，推导并应用此关系，从实验数据中提取热力学参数，并深入探讨模型近似的物理根源及其局限性。这项实践对于培养从实验数据中提炼物理洞察力的能力至关重要[@problem_id:2951265]。", "problem": "研究一种纯物质沿其液汽共存曲线的性质。对于每个温度 $T$（单位为 $\\mathrm{K}$），记录相应的平衡蒸气压 $P$，并列表记录 $\\ln\\!\\big(P/P^{\\circ}\\big)$ 的值，其中 $P^{\\circ} = 1\\,\\mathrm{bar}$，因此 $\\ln\\!\\big(P/P^{\\circ}\\big)$ 是无量纲的。测量数据以有序对 $\\big(x,y\\big) = \\big(1/T,\\ \\ln(P/P^{\\circ})\\big)$ 的形式给出：\n- $\\big(0.0031250000,\\ -3.1250000\\big)$\n- $\\big(0.0030303030,\\ -2.7272727\\big)$\n- $\\big(0.0029411765,\\ -2.3529412\\big)$\n- $\\big(0.0028571429,\\ -2.0000000\\big)$\n- $\\big(0.0027777778,\\ -1.6000000\\big)$\n- $\\big(0.0027027027,\\ -1.2700000\\big)$\n\n您的任务是：\n- 仅使用基本定律和核心定义，从克劳修斯-克拉佩龙关系（其本身是克拉佩龙相平衡方程的推论）和理想气体定律出发。在远离临界区的纯物质的标准假设下，推导一个表达式，将 $y=\\ln(P/P^{\\circ})$ 对 $x=1/T$ 的直线图的斜率与摩尔汽化焓 $\\Delta H_{\\mathrm{vap}}$ 联系起来，其中 $\\Delta H_{\\mathrm{vap}}$ 在该温度区间内可被视为近似恒定。\n- 仅使用前四个数据点（最低温度），根据斜率确定 $\\Delta H_{\\mathrm{vap}}$ 的数值。使用普适气体常数 $R = 8.314462618\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}$。将最终的 $\\Delta H_{\\mathrm{vap}}$ 以 $\\mathrm{kJ\\ mol^{-1}}$ 为单位表示，并将答案四舍五入到四位有效数字。\n- 简要定性地讨论为什么两个最高温度点在 $\\ln P$ 对 $1/T$ 的图中偏离了直线趋势。您的讨论应指出纯物质此类偏差的热力学根源，并参考恒压热容（Cp）、实际气体效应以及液体在临界区附近的行为等标准概念。\n\n最终答案只需报告 $\\Delta H_{\\mathrm{vap}}$ 的数值。", "solution": "问题陈述经评估确定为有效。它在科学上基于化学热力学原理，问题提出得当，有足够的数据得出唯一解，并且表述客观。我们将着手求解。\n\n该问题需要进行三部分分析：推导工作方程，计算摩尔汽化焓的数值，以及定性讨论与理想化模型的偏差。\n\n首先，我们推导 $y = \\ln(P/P^{\\circ})$ 对 $x = 1/T$ 作图的斜率与摩尔汽化焓 $\\Delta H_{\\mathrm{vap}}$ 之间的关系。我们从克拉佩龙方程开始，该方程描述了两相 $\\alpha$ 和 $\\beta$ 之间的相共存曲线：\n$$\n\\frac{dP}{dT} = \\frac{\\Delta S_m}{\\Delta V_m} = \\frac{S_{m,\\beta} - S_{m,\\alpha}}{V_{m,\\beta} - V_{m,\\alpha}}\n$$\n在平衡状态下，摩尔吉布斯自由能变为零，$\\Delta G_m = \\Delta H_m - T\\Delta S_m = 0$，这意味着 $\\Delta S_m = \\Delta H_m / T$。将此代入克拉佩龙方程，得到：\n$$\n\\frac{dP}{dT} = \\frac{\\Delta H_m}{T \\Delta V_m}\n$$\n对于液（$l$）-汽（$g$）平衡，这变为：\n$$\n\\frac{dP}{dT} = \\frac{\\Delta H_{\\mathrm{vap}}}{T (V_{m,g} - V_{m,l})}\n$$\n我们引入两个适用于远离临界点的系统的标准假设。第一，液体的摩尔体积与气体的摩尔体积相比可以忽略不计，$V_{m,l} \\ll V_{m,g}$，所以 $\\Delta V_m \\approx V_{m,g}$。第二，气相表现为理想气体，其摩尔体积由理想气体定律给出：$V_{m,g} = RT/P$。\n代入这些近似值，得到克劳修斯-克拉佩龙方程：\n$$\n\\frac{dP}{dT} = \\frac{\\Delta H_{\\mathrm{vap}}}{T (RT/P)} = \\frac{P \\Delta H_{\\mathrm{vap}}}{RT^2}\n$$\n该方程可以重新整理为 $\\frac{1}{P}\\frac{dP}{dT} = \\frac{\\Delta H_{\\mathrm{vap}}}{RT^2}$。注意到 $d(\\ln P) = (1/P)dP$，我们有：\n$$\n\\frac{d(\\ln P)}{dT} = \\frac{\\Delta H_{\\mathrm{vap}}}{RT^2}\n$$\n问题指定了 $y = \\ln(P/P^{\\circ})$ 对 $x = 1/T$ 的图。我们求导数 $\\frac{dy}{dx}$。使用链式法则求导：\n$$\n\\frac{dy}{dx} = \\frac{d(\\ln(P/P^{\\circ}))}{d(1/T)} = \\frac{d(\\ln P - \\ln P^{\\circ})}{d(1/T)}\n$$\n由于 $P^{\\circ}$ 是一个常数，所以 $d(\\ln P^{\\circ}) = 0$。因此，我们需要计算 $\\frac{d(\\ln P)}{d(1/T)}$。我们再次使用链式法则：\n$$\n\\frac{d(\\ln P)}{d(1/T)} = \\frac{d(\\ln P)}{dT} \\cdot \\frac{dT}{d(1/T)}\n$$\n我们有 $\\frac{d(\\ln P)}{dT} = \\frac{\\Delta H_{\\mathrm{vap}}}{RT^2}$。对于第二项，由于 $x=1/T$，我们有 $T=1/x$，且 $\\frac{dT}{dx} = -1/x^2 = -T^2$。\n结合这些结果：\n$$\n\\frac{dy}{dx} = \\left(\\frac{\\Delta H_{\\mathrm{vap}}}{RT^2}\\right) (-T^2) = -\\frac{\\Delta H_{\\mathrm{vap}}}{R}\n$$\n这个推导表明，在所述假设以及 $\\Delta H_{\\mathrm{vap}}$ 在该温度范围内为常数的额外假设下，$\\ln(P/P^{\\circ})$ 对 $1/T$ 的图是一条直线，其斜率 $m = -\\frac{\\Delta H_{\\mathrm{vap}}}{R}$。\n\n第二，我们使用前四个数据点确定 $\\Delta H_{\\mathrm{vap}}$ 的数值。这些点 $(x,y)$ 是 $(1/T, \\ln(P/P^{\\circ}))$。这些点是：\n$P_1 = (0.0031250000, -3.1250000)$，对应于 $(1/320, -25/8)$。\n$P_2 = (0.0030303030, -2.7272727)$，对应于 $(1/330, -30/11)$。\n$P_3 = (0.0029411765, -2.3529412)$，对应于 $(1/340, -40/17)$。\n$P_4 = (0.0028571429, -2.0000000)$，对应于 $(1/350, -2)$。\n我们计算这些点中任意两点之间的斜率 $m = \\Delta y / \\Delta x$。使用点 $P_1$ 和 $P_4$：\n$$\nm = \\frac{y_4 - y_1}{x_4 - x_1} = \\frac{-2 - (-3.125)}{0.0028571429 - 0.0031250000} = \\frac{1.125}{-0.0002678571} = -4200\\ \\mathrm{K}\n$$\n使用精确分数形式的计算证实，对于前四个点中的所有点对，该斜率都是精确的。\n从推导出的关系 $m = -\\frac{\\Delta H_{\\mathrm{vap}}}{R}$，我们求解 $\\Delta H_{\\mathrm{vap}}$：\n$$\n\\Delta H_{\\mathrm{vap}} = -mR\n$$\n代入斜率 $m$ 和普适气体常数 $R$ 的值：\n$$\n\\Delta H_{\\mathrm{vap}} = -(-4200\\ \\mathrm{K}) \\times (8.314462618\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}})\n$$\n$$\n\\Delta H_{\\mathrm{vap}} = 34920.743\\ \\mathrm{J\\ mol^{-1}}\n$$\n问题要求答案以 $\\mathrm{kJ\\ mol^{-1}}$ 为单位，并四舍五入到四位有效数字。\n$$\n\\Delta H_{\\mathrm{vap}} = 34.920743\\ \\mathrm{kJ\\ mol^{-1}} \\approx 34.92\\ \\mathrm{kJ\\ mol^{-1}}\n$$\n\n第三，我们讨论两个最高温度数据点偏离线性趋势的原因。线性关系 $y = mx + c$ 依赖于三个关键假设：$V_{m,l} \\ll V_{m,g}$，蒸气是理想气体（$Z=PV/RT=1$），以及 $\\Delta H_{\\mathrm{vap}}$ 不随温度变化。随着温度沿共存曲线升高，这些假设的有效性逐渐降低。\n\n观测数据显示，较高温度的点位于从低温数据外推的直线上方。这表明 $\\ln P$ 对 $1/T$ 的图存在向上弯曲，意味着随着温度 $T$ 的升高（$1/T$ 减小），负斜率的绝对值 $|m|$ 减小。\n\n斜率更精确的表达式为 $\\frac{d(\\ln P)}{d(1/T)} = -\\frac{\\Delta H_{\\mathrm{vap}}}{Z R (1 - V_{m,l}/V_{m,g})}$。对线性的偏离源于 $\\Delta H_{\\mathrm{vap}}$ 的温度依赖性、压缩因子 $Z$ 以及液气体积比 $V_{m,l}/V_{m,g}$。\n\n1.  **$\\Delta H_{\\mathrm{vap}}$ 的温度依赖性**：这是偏差的主要原因。汽化焓不是恒定的；它随着温度的升高而减小，最终在临界点变为零。根据 Kirchhoff 定律，$\\frac{d(\\Delta H_{\\mathrm{vap}})}{dT} = \\Delta C_p = C_{p, \\text{gas}} - C_{p, \\text{liquid}}$。对于大多数物质，$C_{p, \\text{liquid}} > C_{p, \\text{gas}}$，因此 $\\Delta C_p$ 为负，导致 $\\Delta H_{\\mathrm{vap}}$ 随 $T$ 升高而减小。$\\Delta H_{\\mathrm{vap}}$ 的减小导致斜率绝对值的减小，使图像向上弯曲。这与观察到的偏差一致。\n\n2.  **实际气体效应（$Z \\neq 1$）**：在较高的温度和压力下，蒸气偏离理想气体行为。对于非极端压力，分子间引力通常占主导地位，导致压缩因子 $Z  1$。这会使分母 $Z R$ 变小，斜率绝对值 $|m|$ 变大，导致向下弯曲，与观察到的趋势相反。\n\n3.  **不可忽略的液体体积**：当温度接近临界温度时，液体的摩尔体积 $V_{m,l}$ 增加，而气体的摩尔体积 $V_{m,g}$ 减小。项 $(1 - V_{m,l}/V_{m,g})$ 变得显著小于1。这使得分母变小，斜率绝对值 $|m|$ 变大，同样导致向下弯曲。\n\n观察到的数据点相较于线性模型的向上偏离表明，在这个特定的温度和压力范围内，$\\Delta H_{\\mathrm{vap}}$ 随温度降低的影响超过了实际气体行为和不可忽略的液体体积的相反影响。", "answer": "$$\n\\boxed{34.92}\n$$", "id": "2951265"}, {"introduction": "范德华方程是超越理想气体模型、描述真实流体相变的经典理论，它内在地包含了液-气共存与临界现象。本练习将引导你使用范德华方程，通过分析其等温线的力学不稳定性（即 $(\\partial p/\\partial v)_T \\gt 0$ 的区域），来确定亚稳态与不稳定态的边界——旋节线。通过将旋节线体积与麦克斯韦等面积法则所决定的平衡共存体积进行对比，你将深刻理解稳定平衡、亚稳态和不稳定态之间的区别[@problem_id:2659684]。", "problem": "一种单组分流体由范德华状态方程 (EOS) $p = \\dfrac{R T}{v - b} - \\dfrac{a}{v^{2}}$ 描述，其中 $p$ 是压力，$T$ 是温度，$v$ 是摩尔体积，$R$ 是普适气体常数，$a,b$ 是与物质相关的参数。使用临界参数 $T_{c} = \\dfrac{8 a}{27 R b}$、$p_{c} = \\dfrac{a}{27 b^{2}}$ 和 $v_{c} = 3 b$ 定义对比变量：\n$$\nT_{r} = \\frac{T}{T_{c}},\\quad p_{r} = \\frac{p}{p_{c}},\\quad v_{r} = \\frac{v}{v_{c}}.\n$$\n在固定的对比温度 $T_{r} = \\dfrac{1}{2}$ 下，通过求解以对比变量表示的机械不稳定性条件 $\\left(\\dfrac{\\partial p}{\\partial v}\\right)_{T} = 0$，确定两个对比旋节线摩尔体积 $v_{r}^{-}$ 和 $v_{r}^{+}$。然后，从对比形式的范德华等温线和麦克斯韦等面积建构出发，建立在 $T_{r} = \\dfrac{1}{2}$ 时的等面积条件，并仅利用等温压缩率的符号和等温线的结构来解释，为什么满足麦克斯韦建构的两个共存对比摩尔体积 $v_{r,\\ell}$ 和 $v_{r,g}$ 必须满足 $v_{r,\\ell}  v_{r}^{-}$ 和 $v_{r,g} > v_{r}^{+}$，而无需显式计算 $v_{r,\\ell}$ 和 $v_{r,g}$。\n\n作为最终答案，报告精确乘积 $v_{r}^{-} v_{r}^{+}$。不需要数值近似，也不应包含单位，因为对比量是无量纲的。", "solution": "该问题要求分析对比变量形式的范德华状态方程，以确定在特定对比温度下的旋节线体积，并提供一个关于共存体积相对于这些旋节线体积位置的定性论证。\n\n首先，我们必须用对比变量 $p_r$、$v_r$ 和 $T_r$ 来表示范德华 (vdW) 状态方程。vdW 方程为：\n$$\np = \\frac{R T}{v - b} - \\frac{a}{v^{2}}\n$$\n对比变量由关系式 $p = p_r p_c$、$v = v_r v_c$ 和 $T = T_r T_c$ 定义。将这些代入 vdW 方程得到：\n$$\np_r p_c = \\frac{R (T_r T_c)}{v_r v_c - b} - \\frac{a}{(v_r v_c)^{2}}\n$$\n现在我们代入临界参数的表达式 $p_c = \\frac{a}{27b^2}$、$v_c = 3b$ 和 $T_c = \\frac{8a}{27Rb}$：\n$$\np_r \\left(\\frac{a}{27b^2}\\right) = \\frac{R T_r \\left(\\frac{8a}{27Rb}\\right)}{v_r (3b) - b} - \\frac{a}{(v_r (3b))^{2}}\n$$\n简化各项，我们得到：\n$$\np_r \\frac{a}{27b^2} = \\frac{T_r \\frac{8a}{27b}}{b(3v_r - 1)} - \\frac{a}{9b^2 v_r^2}\n$$\n为了分离出 $p_r$，我们将整个方程除以因子 $\\frac{a}{27b^2}$：\n$$\np_r = \\left(\\frac{T_r \\frac{8a}{27b}}{b(3v_r - 1)}\\right) \\left(\\frac{27b^2}{a}\\right) - \\left(\\frac{a}{9b^2 v_r^2}\\right) \\left(\\frac{27b^2}{a}\\right)\n$$\n$$\np_r = \\frac{8 T_r}{3v_r - 1} - \\frac{3}{v_r^2}\n$$\n这就是著名的对比范德华状态方程。它的形式是普适的，与特定物质的参数 $a$ 和 $b$ 无关。\n\n接下来，我们确定旋节线，它是流体变得机械不稳定的点的轨迹。这个条件由压力对体积的等温导数在恒定温度下为零来定义：\n$$\n\\left(\\frac{\\partial p}{\\partial v}\\right)_{T} = 0\n$$\n在对比变量中，此条件变为 $\\left(\\frac{\\partial p_r}{\\partial v_r}\\right)_{T_r} = 0$。我们从对比EOS计算这个导数：\n$$\n\\left(\\frac{\\partial p_r}{\\partial v_r}\\right)_{T_r} = \\frac{\\partial}{\\partial v_r} \\left(\\frac{8 T_r}{3v_r - 1} - \\frac{3}{v_r^2}\\right) = -\\frac{8 T_r \\cdot 3}{(3v_r - 1)^2} - (-2)\\frac{3}{v_r^3} = -\\frac{24 T_r}{(3v_r - 1)^2} + \\frac{6}{v_r^3}\n$$\n将导数设为零，得到旋节线的方程：\n$$\n\\frac{24 T_r}{(3v_r - 1)^2} = \\frac{6}{v_r^3} \\implies 4 T_r v_r^3 = (3v_r - 1)^2\n$$\n问题指定对比温度 $T_r = \\frac{1}{2}$。代入此值，我们得到该温度下旋节线体积的具体方程：\n$$\n4\\left(\\frac{1}{2}\\right) v_r^3 = (3v_r - 1)^2 \\implies 2 v_r^3 = 9v_r^2 - 6v_r + 1\n$$\n这是一个关于 $v_r$ 的三次方程：\n$$\n2v_r^3 - 9v_r^2 + 6v_r - 1 = 0\n$$\n通过检验，可以测试简单的根。对于 $v_r = \\frac{1}{2}$：\n$$\n2\\left(\\frac{1}{2}\\right)^3 - 9\\left(\\frac{1}{2}\\right)^2 + 6\\left(\\frac{1}{2}\\right) - 1 = 2\\left(\\frac{1}{8}\\right) - 9\\left(\\frac{1}{4}\\right) + 3 - 1 = \\frac{1}{4} - \\frac{9}{4} + 2 = -\\frac{8}{4} + 2 = -2 + 2 = 0\n$$\n因此，$v_r = \\frac{1}{2}$ 是一个根。我们可以通过除以 $(2v_r - 1)$ 来对这个三次多项式进行因式分解：\n$$\n(2v_r - 1)(v_r^2 - 4v_r + 1) = 0\n$$\n剩余的根可以通过使用求根公式解二次方程 $v_r^2 - 4v_r + 1 = 0$ 得到：\n$$\nv_r = \\frac{-(-4) \\pm \\sqrt{(-4)^2 - 4(1)(1)}}{2(1)} = \\frac{4 \\pm \\sqrt{16 - 4}}{2} = \\frac{4 \\pm \\sqrt{12}}{2} = \\frac{4 \\pm 2\\sqrt{3}}{2} = 2 \\pm \\sqrt{3}\n$$\n三个数学根是 $v_r = \\frac{1}{2}$、$v_r = 2 - \\sqrt{3}$ 和 $v_r = 2 + \\sqrt{3}$。然而，摩尔体积 $v$ 必须大于排斥体积 $b$，这是 vdW 模型的一个基本约束。在对比变量中，这意味着 $v_r v_c > b$，或 $v_r(3b) > b$，简化为 $v_r > \\frac{1}{3}$。\n我们必须根据这个物理约束来检查我们的根：\n\\begin{itemize}\n    \\item $v_r = 2 - \\sqrt{3} \\approx 2 - 1.732 = 0.268$。这个根小于 $\\frac{1}{3} \\approx 0.333$，因此在物理上是不可接受的。\n    \\item $v_r = \\frac{1}{2} = 0.5$。这个根大于 $\\frac{1}{3}$，在物理上是有效的。\n    \\item $v_r = 2 + \\sqrt{3} \\approx 2 + 1.732 = 3.732$。这个根也大于 $\\frac{1}{3}$，在物理上是有效的。\n\\end{itemize}\n因此，两个对比旋节线摩尔体积是 $v_r = \\frac{1}{2}$ 和 $v_r = 2 + \\sqrt{3}$。按照惯例，较小的体积表示为 $v_r^{-}$，较大的表示为 $v_r^{+}$。\n因此，$v_r^{-} = \\frac{1}{2}$ 且 $v_r^{+} = 2 + \\sqrt{3}$。\n\n问题的第二部分要求解释为什么液相的对比共存体积 $v_{r,\\ell}$ 和气相的对比共存体积 $v_{r,g}$ 必须满足 $v_{r,\\ell}  v_{r}^{-}$ 和 $v_{r,g} > v_{r}^{+}$。这个论证必须基于等温压缩率的符号和麦克斯韦建构的结构，而无需显式计算 $v_{r,\\ell}$ 和 $v_{r,g}$。\n等温压缩率 $\\kappa_T = -\\frac{1}{v}\\left(\\frac{\\partial v}{\\partial p}\\right)_T$ 对于处于热力学稳定或亚稳态的物质必须为正。这个机械稳定性条件 $\\kappa_T > 0$ 等价于 $\\left(\\frac{\\partial p}{\\partial v}\\right)_T  0$。\n旋节线区域由 $\\left(\\frac{\\partial p}{\\partial v}\\right)_T > 0$ 定义，在此区域内系统是机械不稳定的，均相无法存在。该区域的边界是旋节线点 $v_r^{-}$ 和 $v_r^{+}$，在这些点上 $\\left(\\frac{\\partial p_r}{\\partial v_r}\\right)_{T_r} = 0$。\n根据定义，饱和液态 $(p_{r,sat}, v_{r,\\ell})$ 和饱和汽态 $(p_{r,sat}, v_{r,g})$ 是稳定热力学平衡态。因此，它们必须位于机械稳定区域内。这要求它们位于旋节线区间 $[v_r^{-}, v_r^{+}]$ 之外。因此，我们必须有 $v_{r,\\ell} \\le v_r^{-}$ 和 $v_{r,g} \\ge v_r^{+}$。\n严格不等式是麦克斯韦等面积建构的结果。该建构将 vdW 等温线从 $v_{r,\\ell}$ 到 $v_{r,g}$ 的积分与由饱和压力 $p_{r,sat}$ 及体积 $v_{r,\\ell}$ 和 $v_{r,g}$ 构成的矩形面积相等同。这意味着饱和压力线必须切割 vdW 环路，使得 $p_{r,sat}$ 上方的环路面积等于其下方的环路面积。对于任何温度 $T_r  1$，vdW 等温线在 $v_r^{-}$ 处有局部最大压力，在 $v_r^{+}$ 处有局部最小压力。只有当饱和压力 $p_{r,sat}$ 严格位于这两个极值之间时，等面积建构才可能实现：$p_r(v_r^{+})  p_{r,sat}  p_r(v_r^{-})$。\n如果 $v_{r,\\ell}$ 等于 $v_r^{-}$，那么 $p_{r,sat}$ 必须是 $p_r(v_r^{-})$。在此压力下，等压线上方的环路面积为零，而其下方的面积严格为正，这违反了麦克斯韦条件。一个对称的论证表明，如果 $v_{r,g}$ 等于 $v_r^{+}$，等面积条件也将被违反。因此，不等式必须是严格的：$v_{r,\\ell}  v_r^{-}$ 和 $v_{r,g} > v_r^{+}$。\n\n最后，问题要求两个旋节线体积的精确乘积 $v_r^{-} v_r^{+}$。使用我们确定的值：\n$$\nv_{r}^{-} v_{r}^{+} = \\left(\\frac{1}{2}\\right) \\left(2 + \\sqrt{3}\\right) = 1 + \\frac{\\sqrt{3}}{2}\n$$\n这就是所要求的精确解析结果。", "answer": "$$\\boxed{1 + \\frac{\\sqrt{3}}{2}}$$", "id": "2659684"}, {"introduction": "在实际的科学研究中，从充满噪声的实验数据中精确提取物理参数是一项关键技能。三相点是一个物质固有的物理常数，因此固-气和液-气两条共存曲线必须精确地交于此点，这一物理事实可以作为强约束应用于数据分析中。本练习是一个综合性的计算实践，要求你基于克劳修斯-克拉佩龙模型进行约束非线性拟合，从而从两组独立的实验数据中同时确定三相点参数和相变焓。这项任务旨在训练你结合物理定律与统计方法来处理真实数据的能力[@problem_id:2951296]。", "problem": "给定两组纯物质的压力-温度数据，每组数据对应一条涉及气相的两相共存线。第一组对应固-气线（记为 $\\mathrm{SV}$），第二组对应液-气线（记为 $\\mathrm{LV}$）。每个数据点包含一个温度 $T$（单位为开尔文），一个测得的平衡压力 $P$（单位为帕斯卡），以及该测量值的估计标准不确定度 $\\sigma_P$（单位为帕斯卡）。这些数据含有噪声，并包含微小但不可忽略的不确定度。您的任务是跨越两条共存线进行单次约束拟合，强制两条曲线在唯一一个共同的三相点 $(T_{\\mathrm{t}}, P_{\\mathrm{t}})$ 相交。\n\n使用的基本原理：\n- 两相平衡的 Clapeyron 方程，$dP/dT = \\Delta S/\\Delta V$。\n- 温度 $T$ 下潜焓 $\\Delta H$ 的关系式 $\\Delta H = T \\Delta S$。\n- 气相的理想气体定律，以及在所考虑的温度和压力范围内，凝聚相（固相或液相）的摩尔体积与气相相比可以忽略不计的经验观察。\n- 平滑变量变换下的不确定度传播标准法则。\n\n基于这些原理，您必须为每条共存线推导出一个具有物理依据的、低参数的模型，该模型应：\n- 在所述近似条件下与 Clapeyron 方程一致。\n- 对 $\\mathrm{SV}$ 和 $\\mathrm{LV}$ 两条线使用一个共同的交点 $(T_{\\mathrm{t}}, P_{\\mathrm{t}})$。\n- 为每条线引入一个独立的潜焓参数，记为 $\\Delta H_{\\mathrm{SV}}$ 和 $\\Delta H_{\\mathrm{LV}}$，并假定在数据范围内这些参数与温度无关。\n- 在一个变换空间中，使用基于统计原理的加权最小二乘目标函数进行拟合，该变换能将与 $P$ 相关的实验不确定度 $\\sigma_P$ 正确地传播到变换后的变量中。\n\n您的程序必须：\n- 实现对参数矢量 $\\boldsymbol{\\theta} = (T_{\\mathrm{t}}, P_{\\mathrm{t}}, \\Delta H_{\\mathrm{SV}}, \\Delta H_{\\mathrm{LV}})$ 的加权非线性最小二乘估计。\n- 通过参数化两条共存线，使它们都通过点 $(T_{\\mathrm{t}}, P_{\\mathrm{t}})$，从而强制执行交点约束。\n- 使用由您选择的变换变量的传播不确定度所导出的权重。\n- 使用从适当变换空间中对每条线进行独立加权线性回归得到的数值稳定的初始猜测值，然后通过联合约束优化进行精炼。\n\n测试套件：\n为以下两个独立的数据集提供结果。在每个数据集中，$\\mathrm{SV}$ 和 $\\mathrm{LV}$ 数据如下，以三元组 $(T, P, \\sigma_P)$ 的形式给出，单位已指定。所有温度 $T$ 的单位均为开尔文，所有压力 $P$ 和不确定度 $\\sigma_P$ 的单位均为帕斯卡。\n\n数据集 $\\#1$：\n- $\\mathrm{SV}$ 点：\n  - $(240.0, 28.2, 1.1)$\n  - $(250.0, 74.5, 2.0)$\n  - $(260.0, 203.0, 4.4)$\n  - $(265.0, 299.0, 6.6)$\n  - $(268.0, 391.0, 8.5)$\n  - $(273.0, 608.0, 12.6)$\n- $\\mathrm{LV}$ 点：\n  - $(273.5, 640.0, 13.1)$\n  - $(276.0, 742.0, 15.5)$\n  - $(280.0, 1008.0, 20.4)$\n  - $(285.0, 1380.0, 28.4)$\n  - $(295.0, 2620.0, 53.6)$\n  - $(305.0, 4950.0, 97.3)$\n\n数据集 $\\#2$：\n- $\\mathrm{SV}$ 点：\n  - $(190.0, 76000.0, 770.0)$\n  - $(200.0, 161000.0, 1620.0)$\n  - $(210.0, 341000.0, 3420.0)$\n- $\\mathrm{LV}$ 点：\n  - $(216.8, 524000.0, 5250.0)$\n  - $(220.0, 605000.0, 6060.0)$\n  - $(230.0, 860000.0, 8610.0)$\n  - $(240.0, 1250000.0, 12510.0)$\n\n数值和物理单位要求：\n- 报告拟合的三相点温度 $T_{\\mathrm{t}}$，单位为开尔文。\n- 报告拟合的三相点压力 $P_{\\mathrm{t}}$，单位为帕斯卡。\n- 报告拟合的潜焓 $\\Delta H_{\\mathrm{SV}}$ 和 $\\Delta H_{\\mathrm{LV}}$，单位为焦耳/摩尔。\n- 将 $T_{\\mathrm{t}}$ 表示为恰好 $2$ 位小数，$P_{\\mathrm{t}}$ 表示为恰好 $1$ 位小数，两个 $\\Delta H$ 值均表示为恰好 $0$ 位小数（作为带小数点的浮点值）。\n\n输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。\n- 对每个数据集，以 $[T_{\\mathrm{t}}, P_{\\mathrm{t}}, \\Delta H_{\\mathrm{SV}}, \\Delta H_{\\mathrm{LV}}]$ 的形式输出一个子列表，并满足所需的舍入和单位要求。\n- 因此，总输出应为一个包含两个子列表的列表，例如 $[[\\cdots],[\\cdots]]$。\n- 不应打印任何其他文本。\n\n科学真实性约束：\n- 所有建模步骤必须明确源自 Clapeyron 方程和针对纯物质所述的近似。\n- 所有不确定度权重必须通过将给定的 $\\sigma_P$ 正确地一阶传播到您拟合的变换变量中来推导。\n- 实现一个数值稳定的优化，该优化应遵守单一三相点的物理约束，并产生有限的正参数估计值。\n\n您的程序必须完全自包含，不得要求任何用户输入或外部数据。它必须仅使用指定的 Python 标准库、NumPy 和 SciPy。", "solution": "所提出的问题是物理化学和统计数据分析领域一个有效且适定的练习。我现在将提供一个完整且论证充分的解决方案。\n\n核心任务是确定 pure substance 的三相点坐标 $(T_{\\mathrm{t}}, P_{\\mathrm{t}})$ 以及升华潜焓 $\\Delta H_{\\mathrm{SV}}$ 和蒸发潜焓 $\\Delta H_{\\mathrm{LV}}$。这是通过同时拟合两组蒸气压数据来实现的，一组用于固-气（SV）共存线，另一组用于液-气（LV）共存线，并受到两条曲线必须在三相点相交的物理约束。\n\n模拟蒸气压与温度依赖关系的基本原理是 Clapeyron 方程：\n$$\n\\frac{dP}{dT} = \\frac{\\Delta S}{\\Delta V}\n$$\n其中 $\\Delta S$ 是相变的摩尔熵变，$\\Delta V$ 是相变的摩尔体积变。利用平衡时 $\\Delta G = 0$ 的热力学关系（这意味着 $\\Delta H = T\\Delta S$），我们可以用潜焓 $\\Delta H$ 重写该方程：\n$$\n\\frac{dP}{dT} = \\frac{\\Delta H}{T \\Delta V}\n$$\n问题指明了几个简化近似。首先，凝聚相（固相或液相）的摩尔体积与气相的摩尔体积相比可以忽略不计（$V_{\\text{cond}} \\ll V_{\\text{gas}}$），因此 $\\Delta V \\approx V_{\\text{gas}}$。其次，气相是理想气体，其摩尔体积为 $V_{\\text{gas}} = RT/P$。将这些近似代入 Clapeyron 方程，得到 Clausius-Clapeyron 方程：\n$$\n\\frac{dP}{dT} = \\frac{\\Delta H}{T (RT/P)} = \\frac{P\\Delta H}{RT^2}\n$$\n这是一个可分离的微分方程：\n$$\n\\frac{dP}{P} = \\frac{\\Delta H}{R} \\frac{dT}{T^2}\n$$\n问题进一步假设在数据所在的温度范围内 $\\Delta H$ 是一个常数。将方程从参考点 $(T_0, P_0)$ 积分到共存曲线上的任意点 $(T, P)$，可得：\n$$\n\\int_{P_0}^{P} d(\\ln P') = \\int_{T_0}^{T} \\frac{\\Delta H}{RT'^2} dT' \\implies \\ln P - \\ln P_0 = -\\frac{\\Delta H}{R} \\left(\\frac{1}{T} - \\frac{1}{T_0}\\right)\n$$\n通过选择三相点 $(T_{\\mathrm{t}}, P_{\\mathrm{t}})$ 作为参考点 $(T_0, P_0)$，来强制执行 SV 和 LV 两条线共用一个三相点的物理约束。这导出了两个模型方程，每个对应一个相平衡，它们共享参数 $T_{\\mathrm{t}}$ 和 $P_{\\mathrm{t}}$：\n$$\n\\text{SV line: } \\ln P(T) = \\ln P_{\\mathrm{t}} - \\frac{\\Delta H_{\\mathrm{SV}}}{R} \\left(\\frac{1}{T} - \\frac{1}{T_{\\mathrm{t}}}\\right)\n$$\n$$\n\\text{LV line: } \\ln P(T) = \\ln P_{\\mathrm{t}} - \\frac{\\Delta H_{\\mathrm{LV}}}{R} \\left(\\frac{1}{T} - \\frac{1}{T_{\\mathrm{t}}}\\right)\n$$\n这些方程根据我们寻求估计的四参数矢量 $\\boldsymbol{\\theta} = (T_{\\mathrm{t}}, P_{\\mathrm{t}}, \\Delta H_{\\mathrm{SV}}, \\Delta H_{\\mathrm{LV}})$ 定义了每条共存曲线上压力和温度之间的关系。\n\n$\\boldsymbol{\\theta}$ 的估计是通过加权非线性最小二乘拟合来执行的。该模型在参数 $T_{\\mathrm{t}}$ 和 $P_{\\mathrm{t}}$ 上是非线性的。为便于分析，我们将因变量 $P$ 变换为 $y = \\ln P$。给定的压力实验不确定度 $\\sigma_P$ 必须传播到变换后的变量。使用一阶误差传播， $y$ 的不确定度为 $\\sigma_y \\approx |\\frac{dy}{dP}| \\sigma_P = \\sigma_P/P$。目标是最小化两个数据集上的总加权残差平方和 $\\chi^2$。每个数据点的权重是拟合变量不确定度的平方倒数，即 $w_i = 1/\\sigma_{y_i}^2 = (P_i/\\sigma_{P_i})^2$。要最小化的目标函数是：\n$$\n\\chi^2(\\boldsymbol{\\theta}) = \\sum_{i \\in \\text{SV}} \\left( \\frac{\\ln P_i - \\ln P(T_i; \\boldsymbol{\\theta})}{\\sigma_{y_i}} \\right)^2 + \\sum_{j \\in \\text{LV}} \\left( \\frac{\\ln P_j - \\ln P(T_j; \\boldsymbol{\\theta})}{\\sigma_{y_j}} \\right)^2\n$$\n数值求解按规定分两个阶段进行。\n\n首先，获得参数的初始估计值。通过重排模型方程，我们发现 $\\ln P$ 与 $1/T$ 呈线性关系：$\\ln P = (-\\Delta H/R)(1/T) + (\\ln P_{\\mathrm{t}} + \\Delta H/(RT_{\\mathrm{t}}))$。我们对 SV 和 LV 数据集，使用权重 $w_i$ 分别对 $y_i = \\ln P_i$ 与 $x_i = 1/T_i$ 进行加权线性回归。这将产生两条直线，$y = m_{\\text{SV}}x + c_{\\text{SV}}$ 和 $y = m_{\\text{LV}}x + c_{\\text{LV}}$。从斜率中，我们获得焓的初始估计值：$\\Delta H_{\\text{SV,init}} = -m_{\\text{SV}}R$ 和 $\\Delta H_{\\text{LV,init}} = -m_{\\text{LV}}R$。这两条线的交点提供了三相点的初始估计值：由 $x_{\\mathrm{t}} = (c_{\\mathrm{LV}} - c_{\\mathrm{SV}})/(m_{\\mathrm{SV}} - m_{\\mathrm{LV}})$ 得到 $T_{\\mathrm{t,init}} = 1/x_{\\mathrm{t}}$，随后由 $y_{\\mathrm{t}} = m_{\\text{SV}}x_{\\mathrm{t}} + c_{\\text{SV}}$ 得到 $P_{\\mathrm{t,init}} = \\exp(y_{\\mathrm{t}})$。\n\n其次，通过联合非线性优化来精炼这些初始估计值。我们使用 `scipy.optimize.least_squares` 中实现的 Levenberg-Marquardt 算法，来最小化关于这四个参数的总 $\\chi^2$。为了数值稳定性，优化是针对参数矢量 $\\boldsymbol{\\phi} = (T_{\\mathrm{t}}, \\ln P_{\\mathrm{t}}, \\Delta H_{\\mathrm{SV}}, \\Delta H_{\\mathrm{LV}})$ 进行的，这样可以避免对优化变量取对数。该算法从其初始猜测值开始迭代调整 $\\boldsymbol{\\phi}$，以找到根据加权最小二乘准则同时最佳拟合所有数据点的值。\n\n最终优化的参数矢量提供了 $T_{\\mathrm{t}}$、$\\ln P_{\\mathrm{t}}$、$\\Delta H_{\\mathrm{SV}}$ 和 $\\Delta H_{\\mathrm{LV}}$ 的最佳拟合值。三相点压力 $P_{\\mathrm{t}}$ 通过 $P_{\\mathrm{t}} = \\exp(\\ln P_t)$ 恢复。然后将结果格式化为指定的小数位数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import least_squares\n\n# Scientific constant\nR = 8.314462618  # Gas constant in J/(mol·K)\n\ndef weighted_linear_regression(x, y, w):\n    \"\"\"\n    Performs a weighted linear regression for y = m*x + c.\n    \n    Args:\n        x (np.ndarray): Independent variable data.\n        y (np.ndarray): Dependent variable data.\n        w (np.ndarray): Weights for each data point.\n        \n    Returns:\n        tuple: (slope, intercept) of the best-fit line.\n    \"\"\"\n    S = np.sum(w)\n    Sx = np.sum(w * x)\n    Sy = np.sum(w * y)\n    Sxx = np.sum(w * x * x)\n    Sxy = np.sum(w * x * y)\n    \n    D = S * Sxx - Sx * Sx\n    \n    # This scenario is highly unlikely with real experimental data.\n    if abs(D)  1e-15:\n        raise ValueError(\"Cannot perform linear regression, determinant is zero.\")\n        \n    m = (S * Sxy - Sx * Sy) / D\n    c = (Sxx * Sy - Sx * Sxy) / D\n    return m, c\n\ndef get_initial_guess(sv_data, lv_data):\n    \"\"\"\n    Calculates initial guesses for the four parameters by performing\n    separate weighted linear regressions on the SV and LV data.\n    \"\"\"\n    # Process Solid-Vapor (SV) data\n    T_sv, P_sv, sigma_P_sv = sv_data.T\n    x_sv = 1.0 / T_sv\n    y_sv = np.log(P_sv)\n    w_sv = (P_sv / sigma_P_sv)**2\n    m_sv, c_sv = weighted_linear_regression(x_sv, y_sv, w_sv)\n    \n    # Process Liquid-Vapor (LV) data\n    T_lv, P_lv, sigma_P_lv = lv_data.T\n    x_lv = 1.0 / T_lv\n    y_lv = np.log(P_lv)\n    w_lv = (P_lv / sigma_P_lv)**2\n    m_lv, c_lv = weighted_linear_regression(x_lv, y_lv, w_lv)\n    \n    # Initial guess for enthalpies from slopes (m = -dH/R)\n    dH_sv_init = -m_sv * R\n    dH_lv_init = -m_lv * R\n    \n    # Initial guess for triple point from intersection of the two lines\n    # m_sv * x_t + c_sv = m_lv * x_t + c_lv -> x_t = (c_lv - c_sv) / (m_sv - m_lv)\n    x_t_init = (c_lv - c_sv) / (m_sv - m_lv)\n    T_t_init = 1.0 / x_t_init\n    \n    # y_t can be calculated from either line\n    log_P_t_init = m_sv * x_t_init + c_sv\n\n    # Return the vector of initial parameters for optimization\n    return [T_t_init, log_P_t_init, dH_sv_init, dH_lv_init]\n\ndef residuals(params, sv_data, lv_data):\n    \"\"\"\n    Calculates the weighted residuals for the joint dataset.\n    This function is the target for the least-squares optimizer.\n    \"\"\"\n    T_t, log_P_t, dH_sv, dH_lv = params\n    \n    # Unpack SV data\n    T_sv, P_sv, sigma_P_sv = sv_data.T\n    \n    # Calculate weighted residuals for SV data\n    y_sv_data = np.log(P_sv)\n    y_sv_model = log_P_t - (dH_sv / R) * (1.0/T_sv - 1.0/T_t)\n    sigma_y_sv = sigma_P_sv / P_sv\n    res_sv = (y_sv_data - y_sv_model) / sigma_y_sv\n    \n    # Unpack LV data\n    T_lv, P_lv, sigma_P_lv = lv_data.T\n\n    # Calculate weighted residuals for LV data\n    y_lv_data = np.log(P_lv)\n    y_lv_model = log_P_t - (dH_lv / R) * (1.0/T_lv - 1.0/T_t)\n    sigma_y_lv = sigma_P_lv / P_lv\n    res_lv = (y_lv_data - y_lv_model) / sigma_y_lv\n    \n    return np.concatenate((res_sv, res_lv))\n\ndef solve_for_dataset(sv_data, lv_data):\n    \"\"\"\n    Perform the full two-step fitting procedure for one dataset.\n    \"\"\"\n    sv_data_np = np.array(sv_data, dtype=float)\n    lv_data_np = np.array(lv_data, dtype=float)\n    \n    # 1. Get initial parameters from linear fits\n    initial_params = get_initial_guess(sv_data_np, lv_data_np)\n    \n    # 2. Perform nonlinear least-squares refinement\n    opt_result = least_squares(\n        residuals,\n        initial_params,\n        args=(sv_data_np, lv_data_np),\n        method='lm'\n    )\n    \n    T_t_fit, log_P_t_fit, dH_sv_fit, dH_lv_fit = opt_result.x\n    \n    P_t_fit = np.exp(log_P_t_fit)\n    \n    # Format results to the specified precision\n    T_t_fmt = float(f\"{T_t_fit:.2f}\")\n    P_t_fmt = float(f\"{P_t_fit:.1f}\")\n    dH_sv_fmt = float(f\"{dH_sv_fit:.0f}\")\n    dH_lv_fmt = float(f\"{dH_lv_fit:.0f}\")\n    \n    return [T_t_fmt, P_t_fmt, dH_sv_fmt, dH_lv_fmt]\n\ndef solve():\n    \"\"\"\n    Main function to define datasets, run the solver for each,\n    and print the final results in the specified format.\n    \"\"\"\n    test_cases = [\n        {\n            \"sv_data\": [\n                (240.0, 28.2, 1.1), (250.0, 74.5, 2.0), (260.0, 203.0, 4.4),\n                (265.0, 299.0, 6.6), (268.0, 391.0, 8.5), (273.0, 608.0, 12.6)\n            ],\n            \"lv_data\": [\n                (273.5, 640.0, 13.1), (276.0, 742.0, 15.5), (280.0, 1008.0, 20.4),\n                (285.0, 1380.0, 28.4), (295.0, 2620.0, 53.6), (305.0, 4950.0, 97.3)\n            ]\n        },\n        {\n            \"sv_data\": [\n                (190.0, 76000.0, 770.0), (200.0, 161000.0, 1620.0), (210.0, 341000.0, 3420.0)\n            ],\n            \"lv_data\": [\n                (216.8, 524000.0, 5250.0), (220.0, 605000.0, 6060.0), \n                (230.0, 860000.0, 8610.0), (240.0, 1250000.0, 12510.0)\n            ]\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = solve_for_dataset(case[\"sv_data\"], case[\"lv_data\"])\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # The construction below ensures no extra spaces are added by str() list A-`[A, B, C]`\n    sublists_str = [f\"[{r[0]},{r[1]},{r[2]},{r[3]}]\" for r in results]\n    print(f\"[{','.join(sublists_str)}]\")\n\nsolve()\n```", "id": "2951296"}]}