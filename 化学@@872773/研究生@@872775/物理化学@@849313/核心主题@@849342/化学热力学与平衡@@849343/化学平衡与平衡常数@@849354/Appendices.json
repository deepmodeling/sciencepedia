{"hands_on_practices": [{"introduction": "本练习旨在建立吉布斯自由能变（$\\Delta_r G$）与反应进程之间的基本联系。通过计算不同反应商（$Q$）下的 $\\Delta_r G$，您将练习预测自发变化的方向，并体会体系的组成如何决定其趋向平衡的热力学驱动力。[@problem_id:2628284]", "problem": "一个在恒温恒压下进行的单步、化学计量平衡的反应，可以用基于反应进度的吉布斯自由能变来描述。考虑一个理想混合物（或理想气体混合物），其中每种物质的活度等于其摩尔分数或相对于标准态的分压比，因此反应商是活度的无量纲乘积。在温度 $T=500\\,\\mathrm{K}$ 时，反应的标准吉布斯自由能变为 $\\Delta_{r} G^{\\circ}(T) = 5.0\\,\\mathrm{kJ\\,mol^{-1}}$。制备了两种非平衡组分，其反应商分别为 $Q_{1}=0.0100$ 和 $Q_{2}=100$。仅使用基本定义，从理想混合物的化学势表达式出发，推导在恒定 $T$ 和压力下，瞬时反应吉布斯自由能变 $\\Delta_{r} G$ 对 $Q$ 和 $T$ 的依赖关系。利用此关系式，判断对于每个 $Q$ 值，正向的无限小进程是否是自发的。最后，定义标量\n$$\nS \\equiv \\Delta_{r} G(Q_{2}) - \\Delta_{r} G(Q_{1}),\n$$\n并使用 $R=8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$ 计算 $S$ 的数值。将 $S$ 的最终值以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位表示，并四舍五入至四位有效数字。最终答案必须仅为 $S$ 的单个数值。", "solution": "反应的瞬时吉布斯自由能变 $\\Delta_{r} G$ 定义为在恒温 $T$ 和恒压 $p$ 下，吉布斯自由能 $G$ 对反应进度 $\\xi$ 的导数。对于一个通用化学反应 $\\sum_{i} \\nu_{i} M_{i} = 0$，其中 $\\nu_{i}$ 是化学计量系数（产物为正，反应物为负），$M_{i}$ 是化学物种，该值由下式给出：\n$$\n\\Delta_{r} G = \\left( \\frac{\\partial G}{\\partial \\xi} \\right)_{T,p} = \\sum_{i} \\nu_{i} \\mu_{i}\n$$\n其中 $\\mu_{i}$ 是物种 $i$ 的化学势。\n\n对于理想混合物中的物种 $i$，其化学势通过基本关系式与其标准化学势 $\\mu_{i}^{\\circ}(T)$ 和活度 $a_{i}$ 相关联：\n$$\n\\mu_{i} = \\mu_{i}^{\\circ}(T) + RT \\ln(a_{i})\n$$\n其中 $R$ 是通用气体常数，$T$ 是绝对温度。标准态化学势 $\\mu_{i}^{\\circ}(T)$ 仅是温度的函数。\n\n将 $\\mu_{i}$ 的表达式代入 $\\Delta_{r} G$ 的方程中：\n$$\n\\Delta_{r} G = \\sum_{i} \\nu_{i} \\left( \\mu_{i}^{\\circ}(T) + RT \\ln(a_{i}) \\right) = \\sum_{i} \\nu_{i} \\mu_{i}^{\\circ}(T) + \\sum_{i} \\nu_{i} RT \\ln(a_{i})\n$$\n根据定义，第一项是反应的标准吉布斯自由能变 $\\Delta_{r} G^{\\circ}(T)$：\n$$\n\\Delta_{r} G^{\\circ}(T) \\equiv \\sum_{i} \\nu_{i} \\mu_{i}^{\\circ}(T)\n$$\n第二项可以利用对数性质 $\\sum_{i} \\nu_{i} RT \\ln(a_{i}) = RT \\ln \\left( \\prod_{i} a_{i}^{\\nu_{i}} \\right)$ 进行简化。乘积项 $\\prod_{i} a_{i}^{\\nu_{i}}$ 正是反应商 $Q$ 的定义。因此，我们得到瞬时反应吉布斯自由能变对 $Q$ 和 $T$ 的依赖关系：\n$$\n\\Delta_{r} G = \\Delta_{r} G^{\\circ}(T) + RT \\ln(Q)\n$$\n至此完成了所需的推导。\n\n接下来，我们判断对于两种组成中的每一种，正向的无限小进程是否是自发的。在恒定 $T$ 和 $p$ 下，自发过程的判据是 $\\Delta_{r} G  0$。给定 $\\Delta_{r} G^{\\circ}(T) = 5.0\\,\\mathrm{kJ\\,mol^{-1}} = 5000\\,\\mathrm{J\\,mol^{-1}}$，$T = 500\\,\\mathrm{K}$，以及 $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n\n对于第一种组成，$Q_{1} = 0.0100$：\n$$\n\\Delta_{r} G(Q_{1}) = 5000\\,\\mathrm{J\\,mol^{-1}} + (8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}})(500\\,\\mathrm{K})\\ln(0.0100)\n$$\n$$\n\\Delta_{r} G(Q_{1}) \\approx 5000 + (4157.23)(-4.60517)\\,\\mathrm{J\\,mol^{-1}} \\approx 5000 - 19145.5\\,\\mathrm{J\\,mol^{-1}} \\approx -14146\\,\\mathrm{J\\,mol^{-1}}\n$$\n由于 $\\Delta_{r} G(Q_{1})  0$，对于此组成，反应在正向是自发的。\n\n对于第二种组成，$Q_{2} = 100$：\n$$\n\\Delta_{r} G(Q_{2}) = 5000\\,\\mathrm{J\\,mol^{-1}} + (8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}})(500\\,\\mathrm{K})\\ln(100)\n$$\n$$\n\\Delta_{r} G(Q_{2}) \\approx 5000 + (4157.23)(4.60517)\\,\\mathrm{J\\,mol^{-1}} \\approx 5000 + 19145.5\\,\\mathrm{J\\,mol^{-1}} \\approx 24146\\,\\mathrm{J\\,mol^{-1}}\n$$\n由于 $\\Delta_{r} G(Q_{2}) > 0$，反应在正向是非自发的。逆向反应是自发的。\n\n最后，我们计算标量 $S \\equiv \\Delta_{r} G(Q_{2}) - \\Delta_{r} G(Q_{1})$：\n$$\nS = \\left( \\Delta_{r} G^{\\circ}(T) + RT \\ln(Q_{2}) \\right) - \\left( \\Delta_{r} G^{\\circ}(T) + RT \\ln(Q_{1}) \\right)\n$$\n标准吉布斯自由能变项被消去：\n$$\nS = RT \\ln(Q_{2}) - RT \\ln(Q_{1}) = RT \\ln\\left(\\frac{Q_{2}}{Q_{1}}\\right)\n$$\n代入给定的数值：\n$$\nS = (8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}})(500\\,\\mathrm{K}) \\ln\\left(\\frac{100}{0.0100}\\right)\n$$\n$$\nS = (4157.231309\\,\\mathrm{J\\,mol^{-1}}) \\ln(10000)\n$$\n$$\nS \\approx (4157.231309\\,\\mathrm{J\\,mol^{-1}}) \\times (9.21034037) \\approx 38289.155\\,\\mathrm{J\\,mol^{-1}}\n$$\n问题要求答案以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位表示，并四舍五入至四位有效数字。\n$$\nS \\approx 38.289155\\,\\mathrm{kJ\\,mol^{-1}} \\approx 38.29\\,\\mathrm{kJ\\,mol^{-1}}\n$$", "answer": "$$\n\\boxed{38.29}\n$$", "id": "2628284"}, {"introduction": "在真实的化学体系中，尤其是在溶液中，分子间的相互作用会导致对理想行为的偏离。本练习通过引入活度系数，将实验测得的浓度比（$K_{\\mathrm{conc}}$）与真实的热力学平衡常数（$K$）联系起来，从而超越了理想假设。掌握这种区别对于在非理想溶液中准确解读实验数据至关重要。[@problem_id:2628299]", "problem": "考虑在温度为 $25^\\circ\\mathrm{C}$ 的水溶液中的缔合反应：\n$$\\mathrm{A} + \\mathrm{B} \\rightleftharpoons \\mathrm{AB}.$$\n假设在某一离子强度下，溶质的（摩尔浓度标度）活度系数为常数，且给定为 $\\gamma_{\\mathrm{A}}=\\gamma_{\\mathrm{B}}=0.85$ 和 $\\gamma_{\\mathrm{AB}}=0.92$。采用摩尔浓度标度，标准浓度为 $c^{\\circ}=1\\,\\mathrm{mol\\,L^{-1}}$，溶质活度定义为 $a_i=\\gamma_i [i]/c^{\\circ}$，其中 $[i]$ 表示物种 $i$ 的摩尔浓度。\n\n仅从以化学势表示的化学平衡条件和溶质活度的定义出发，推导无量纲热力学平衡常数 $K$ 如何与摩尔浓度标度下的浓度比 $K_{\\mathrm{conc}}=[\\mathrm{AB}]/([\\mathrm{A}][\\mathrm{B}])$ 相关联。然后，计算满足以下关系的单个无量纲数值因子 $F$：\n$$K = F\\,c^{\\circ}\\,K_{\\mathrm{conc}}.$$\n\n将您关于 $F$ 的最终答案表示为一个无单位的精确分数。不要四舍五入。", "solution": "在恒温恒压下，化学平衡的基本条件是体系的吉布斯自由能处于最小值。这意味着反应的吉布斯自由能变化量 $\\Delta_rG$ 为零。对于反应 $\\mathrm{A} + \\mathrm{B} \\rightleftharpoons \\mathrm{AB}$，该条件用所涉及物种的化学势 $\\mu_i$ 表示为：\n$$ \\mu_{\\mathrm{A}} + \\mu_{\\mathrm{B}} = \\mu_{\\mathrm{AB}} $$\n溶液中溶质物种 $i$ 的化学势与其活度 $a_i$ 通过以下表达式相关联：\n$$ \\mu_i = \\mu_i^{\\circ} + RT \\ln(a_i) $$\n其中 $\\mu_i^{\\circ}$ 是物种 $i$ 在标准浓度 $c^{\\circ}$ 下的标准化学势。将此表达式代入平衡条件得到：\n$$ (\\mu_{\\mathrm{A}}^{\\circ} + RT \\ln(a_{\\mathrm{A}})) + (\\mu_{\\mathrm{B}}^{\\circ} + RT \\ln(a_{\\mathrm{B}})) = \\mu_{\\mathrm{AB}}^{\\circ} + RT \\ln(a_{\\mathrm{AB}}) $$\n重新整理各项，将标准势与活度项分开，得到：\n$$ \\mu_{\\mathrm{AB}}^{\\circ} - \\mu_{\\mathrm{A}}^{\\circ} - \\mu_{\\mathrm{B}}^{\\circ} = -RT \\ln\\left(\\frac{a_{\\mathrm{AB}}}{a_{\\mathrm{A}} a_{\\mathrm{B}}}\\right)_{\\mathrm{eq}} $$\n左边的项是标准反应吉布斯自由能 $\\Delta_r G^{\\circ}$，它定义了热力学平衡常数 $K$：$\\Delta_r G^{\\circ} = -RT \\ln K$。因此，$K$ 是平衡时活度的反应商：\n$$ K = \\left(\\frac{a_{\\mathrm{AB}}}{a_{\\mathrm{A}} a_{\\mathrm{B}}}\\right)_{\\mathrm{eq}} $$\n问题将溶质 $i$ 的活度定义为 $a_i = \\gamma_i [i]/c^{\\circ}$，其中 $\\gamma_i$ 是活度系数，$[i]$ 是摩尔浓度，$c^{\\circ}$ 是标准浓度 $1\\,\\mathrm{mol\\,L^{-1}}$。我们将此定义代入 $K$ 的表达式中：\n$$ K = \\frac{\\gamma_{\\mathrm{AB}} [\\mathrm{AB}] / c^{\\circ}}{(\\gamma_{\\mathrm{A}} [\\mathrm{A}] / c^{\\circ})(\\gamma_{\\mathrm{B}} [\\mathrm{B}] / c^{\\circ})} $$\n该表达式可以通过分离活度系数、浓度和标准浓度项来简化：\n$$ K = \\left(\\frac{\\gamma_{\\mathrm{AB}}}{\\gamma_{\\mathrm{A}} \\gamma_{\\mathrm{B}}}\\right) \\left(\\frac{[\\mathrm{AB}]}{[\\mathrm{A}][\\mathrm{B}]}\\right) \\frac{1/c^{\\circ}}{(1/c^{\\circ})^2} = \\left(\\frac{\\gamma_{\\mathrm{AB}}}{\\gamma_{\\mathrm{A}} \\gamma_{\\mathrm{B}}}\\right) \\left(\\frac{[\\mathrm{AB}]}{[\\mathrm{A}][\\mathrm{B}]}\\right) c^{\\circ} $$\n问题将浓度比定义为 $K_{\\mathrm{conc}} = [\\mathrm{AB}]/([\\mathrm{A}][\\mathrm{B}])$。将其代入 $K$ 的方程中：\n$$ K = \\left(\\frac{\\gamma_{\\mathrm{AB}}}{\\gamma_{\\mathrm{A}} \\gamma_{\\mathrm{B}}}\\right) K_{\\mathrm{conc}} c^{\\circ} $$\n题目要求我们找到关系式 $K = F c^{\\circ} K_{\\mathrm{conc}}$ 中的无量纲因子 $F$。通过将我们推导的表达式与此目标形式直接比较，我们确定 $F$ 是活度系数之比：\n$$ F = \\frac{\\gamma_{\\mathrm{AB}}}{\\gamma_{\\mathrm{A}} \\gamma_{\\mathrm{B}}} $$\n现在，我们使用给定的活度系数计算 $F$ 的数值：$\\gamma_{\\mathrm{A}}=0.85$，$\\gamma_{\\mathrm{B}}=0.85$，以及 $\\gamma_{\\mathrm{AB}}=0.92$。为了按要求获得精确分数，我们将小数值转换为分数：\n$$ \\gamma_{\\mathrm{A}} = 0.85 = \\frac{17}{20}, \\quad \\gamma_{\\mathrm{B}} = 0.85 = \\frac{17}{20}, \\quad \\gamma_{\\mathrm{AB}} = 0.92 = \\frac{23}{25} $$\n将这些分数代入 $F$ 的表达式中：\n$$ F = \\frac{\\frac{23}{25}}{\\left(\\frac{17}{20}\\right)\\left(\\frac{17}{20}\\right)} = \\frac{\\frac{23}{25}}{\\frac{289}{400}} = \\frac{23}{25} \\times \\frac{400}{289} $$\n由于 $400/25 = 16$，表达式简化为：\n$$ F = 23 \\times \\frac{16}{289} = \\frac{368}{289} $$\n该因子是无量纲的，符合要求。", "answer": "$$\\boxed{\\frac{368}{289}}$$", "id": "2628299"}, {"introduction": "许多实际的平衡问题，例如天然水体或生物流体中的物种形成，涉及多个耦合反应并需要进行非理想性校正，这使得解析求解变得过于复杂。这项计算练习要求您将所有核心概念——质量作用定律、质量与电荷平衡、以及自洽的活度校正——整合成一个可运行的程序。这是一个总结性的实践，反映了现代化学平衡问题在科研和工业中的求解方式。[@problem_id:2628319]", "problem": "要求您编写一个完整的、可运行的程序，用于计算在温度 $T = 298.15\\,\\mathrm{K}$、存在控制离子强度的背景 $1{:}1$ 型惰性电解质的情况下，二元酸 $\\mathrm{H_2A}$ 水溶液的平衡物种分布和酸度（国际纯粹与应用化学联合会 (IUPAC) 定义的酸度，记为 $pH$）。程序必须在活度标度上处理平衡常数，并必须使用 Davies 方程对所有离子物种进行活度校正。程序不得接受任何用户输入，并且必须使用下面指定的固定测试套件。所有输出必须按规定在单行中生成。浓度必须以 $\\mathrm{mol\\,L^{-1}}$ 为单位报告。\n\n使用的基本出发点和定义：\n\n- 平衡的特征是化学势相等；活度标度上的质量作用定律由此得出。对于反应\n  $$\\mathrm{H_2A} \\rightleftharpoons \\mathrm{H^+} + \\mathrm{HA^-}, \\quad \\mathrm{HA^-} \\rightleftharpoons \\mathrm{H^+} + \\mathrm{A^{2-}}, \\quad \\mathrm{H_2O} \\rightleftharpoons \\mathrm{H^+} + \\mathrm{OH^-},$$\n  定义热力学平衡常数（无限稀释标准态）$K_{a1}^\\circ$、$K_{a2}^\\circ$ 和 $K_w^\\circ$ 如下：\n  $$K_{a1}^\\circ = \\frac{a_{\\mathrm{H^+}} a_{\\mathrm{HA^-}}}{a_{\\mathrm{H_2A}}}, \\quad K_{a2}^\\circ = \\frac{a_{\\mathrm{H^+}} a_{\\mathrm{A^{2-}}}}{a_{\\mathrm{HA^-}}}, \\quad K_w^\\circ = a_{\\mathrm{H^+}} a_{\\mathrm{OH^-}},$$\n  其中 $a_i$ 表示物种 $i$ 的活度。\n- 活度满足 $a_i = \\gamma_i \\, c_i / c^\\circ$，其中 $c_i$ 是摩尔浓度，$c^\\circ = 1\\,\\mathrm{mol\\,L^{-1}}$ 是标准浓度，$\\gamma_i$ 是活度系数。取 $\\gamma_{\\mathrm{H_2A}} = 1$（中性溶质）。\n- 离子强度 $I$（单位为 $\\mathrm{mol\\,L^{-1}}$）为\n  $$I = \\frac{1}{2} \\sum_i z_i^2 c_i,$$\n  其中 $z_i$ 是离子 $i$ 的电荷数。在本问题中，溶液包含离子 $\\mathrm{H^+}$、$\\mathrm{OH^-}$、$\\mathrm{HA^-}$、$\\mathrm{A^{2-}}$，以及分析浓度为 $C_s$ 的惰性 $1{:}1$ 型电解质（完全解离为 $\\mathrm{Na^+}$ 和 $\\mathrm{Cl^-}$）。对于 $1{:}1$ 型电解质，其对 $I$ 的贡献恰好是 $C_s$。\n- 在 $T = 298.15\\,\\mathrm{K}$ 时，Davies 方程给出了电荷为 $z_i$ 的离子 $i$ 的活度系数为\n  $$\\log_{10} \\gamma_i = - A \\, z_i^2 \\left( \\frac{\\sqrt{I}}{1 + \\sqrt{I}} - 0.3 I \\right),$$\n  其中 $A = 0.509\\,\\mathrm{(mol/L)^{-1/2}}$。当 $I = 0$ 时，使用 $\\gamma_i = 1$。此方程适用于 $\\mathrm{H^+}$、$\\mathrm{OH^-}$、$\\mathrm{HA^-}$、$\\mathrm{A^{2-}}$、$\\mathrm{Na^+}$ 和 $\\mathrm{Cl^-}$。\n- IUPAC 定义的酸度为 $pH = -\\log_{10} a_{\\mathrm{H^+}} = -\\log_{10}(\\gamma_{\\mathrm{H^+}} c_{\\mathrm{H^+}}/c^\\circ)$。\n\n您的程序必须：\n\n- 使用以下在 $T = 298.15\\,\\mathrm{K}$ 时的热力学常数：\n  - $pK_{a1}^\\circ = 3.60$ 和 $pK_{a2}^\\circ = 8.20$，因此 $K_{a1}^\\circ = 10^{-3.60}$ 和 $K_{a2}^\\circ = 10^{-8.20}$。\n  - $K_w^\\circ = 1.0 \\times 10^{-14}$。\n- 同时强制执行以下约束条件：\n  - 二元酸的质量守恒：$c_{\\mathrm{H_2A}} + c_{\\mathrm{HA^-}} + c_{\\mathrm{A^{2-}}} = C_T$，其中 $C_T$ 是 $\\mathrm{H_2A}$ 的总分析浓度。\n  - 电中性：$c_{\\mathrm{H^+}} + c_{\\mathrm{Na^+}} = c_{\\mathrm{OH^-}} + c_{\\mathrm{HA^-}} + 2 c_{\\mathrm{A^{2-}}} + c_{\\mathrm{Cl^-}}$。由于 $c_{\\mathrm{Na^+}} = c_{\\mathrm{Cl^-}} = C_s$，此式简化为 $c_{\\mathrm{H^+}} = c_{\\mathrm{OH^-}} + c_{\\mathrm{HA^-}} + 2 c_{\\mathrm{A^{2-}}}$。\n  - 所有三个平衡的基于活度的质量作用约束。\n  - 离子强度 $I$ 与包括背景电解质在内的所有离子浓度的自洽性，以及通过 Davies 方程得到的自洽活度系数。\n- 计算如上定义的 $pH$ 以及平衡浓度 $c_{\\mathrm{H_2A}}$、$c_{\\mathrm{HA^-}}$ 和 $c_{\\mathrm{A^{2-}}}$，单位为 $\\mathrm{mol\\,L^{-1}}$。\n\n数值和单位要求：\n\n- 所有浓度以 $\\mathrm{mol\\,L^{-1}}$ 报告。\n- 将 $pH$ 报告为无量纲数。\n- 对于每个测试用例，按 $[pH, c_{\\mathrm{H_2A}}, c_{\\mathrm{HA^-}}, c_{\\mathrm{A^{2-}}}]$ 的顺序输出一个包含四个数字的列表。\n- 将 $pH$ 四舍五入到 $6$ 位小数。每种浓度使用科学记数法表示，保留 $6$ 位有效数字。\n\n测试套件：\n\n计算并返回以下四个测试用例的结果，每个用例由 $(C_T, I_b)$ 指定，其中 $C_T$ 是 $\\mathrm{H_2A}$ 的总分析浓度，$I_b$ 是由 $1{:}1$ 型惰性电解质设定的目标背景离子强度。通过将背景电解质的分析浓度设为 $C_s = I_b$ 来实现。\n\n- 用例 1（一般情况）：$(C_T, I_b) = (10^{-3}, 10^{-1})$。\n- 用例 2（极稀酸，基本为纯水）：$(C_T, I_b) = (10^{-8}, 0)$。\n- 用例 3（中等离子强度下的类缓冲体系）：$(C_T, I_b) = (10^{-2}, 10^{-2})$。\n- 用例 4（接近 Davies 方程有效性上限的高离子强度）：$(C_T, I_b) = (5 \\times 10^{-3}, 5 \\times 10^{-1})$。\n\n最终输出格式：\n\n您的程序应生成单行输出，其中包含一个含四个子列表的列表，每个子列表对应一个测试用例，顺序与上文指定相同。每个子列表必须为 $[pH, c_{\\mathrm{H_2A}}, c_{\\mathrm{HA^-}}, c_{\\mathrm{A^{2-}}}]$ 的形式。总输出必须是形如 $[[\\dots],[\\dots],[\\dots],[\\dots]]$ 的单行字符串，各项之间用逗号分隔。例如，一个语法上有效的输出行看起来像 $[[7.000000,1.00000e-08,0.00000e+00,0.00000e+00],[\\dots],\\dots]$，但其中包含每个测试用例的实际计算数值。", "solution": "该问题要求计算二元酸 $\\mathrm{H_2A}$ 水溶液的平衡物种分布和 $pH$，计算中包含活度校正。这是物理化学中的一个经典问题，需要求解一个耦合的非线性代数方程组。解必须是自洽的，即计算出的离子浓度所产生的离子强度，通过 Davies 方程得到的活度系数，必须与计算本身所使用的活度系数一致。这种循环依赖性要求采用迭代数值方法。\n\n该系统受以下基本原理和方程的制约：\n\n$1$. **化学平衡（质量作用定律）：**\n三个相关的平衡是酸的两个解离步骤和水的自电离。在活度标度（$a_i$）上定义的热力学平衡常数如下：\n$$K_{a1}^\\circ = \\frac{a_{\\mathrm{H^+}} a_{\\mathrm{HA^-}}}{a_{\\mathrm{H_2A}}} = 10^{-3.60}$$\n$$K_{a2}^\\circ = \\frac{a_{\\mathrm{H^+}} a_{\\mathrm{A^{2-}}}}{a_{\\mathrm{HA^-}}} = 10^{-8.20}$$\n$$K_w^\\circ = a_{\\mathrm{H^+}} a_{\\mathrm{OH^-}} = 1.0 \\times 10^{-14}$$\n活度 $a_i$ 通过 $a_i = \\gamma_i (c_i/c^\\circ)$ 与摩尔浓度 $c_i$ 相关，其中 $\\gamma_i$ 是活度系数，$c^\\circ = 1\\,\\mathrm{mol\\,L^{-1}}$。对于中性物种 $\\mathrm{H_2A}$，我们取 $\\gamma_{\\mathrm{H_2A}} = 1$。\n\n$2$. **质量守恒：**\n二元酸的总分析浓度 $C_T$ 必须等于其在平衡时所有形式的浓度之和：\n$$C_T = c_{\\mathrm{H_2A}} + c_{\\mathrm{HA^-}} + c_{\\mathrm{A^{2-}}}$$\n\n$3$. **电中性（电荷平衡）：**\n溶液中的总正电荷浓度必须等于总负电荷浓度。存在的离子有 $\\mathrm{H^+}$、$\\mathrm{OH^-}$、$\\mathrm{HA^-}$、$\\mathrm{A^{2-}}$，以及来自惰性 $1{:}1$ 型电解质的离子 $\\mathrm{Na^+}$ 和 $\\mathrm{Cl^-}$（浓度为 $C_s$）。\n$$c_{\\mathrm{H^+}} + c_{\\mathrm{Na^+}} = c_{\\mathrm{OH^-}} + c_{\\mathrm{HA^-}} + 2 c_{\\mathrm{A^{2-}}} + c_{\\mathrm{Cl^-}}$$\n鉴于 $c_{\\mathrm{Na^+}} = c_{\\mathrm{Cl^-}} = C_s$，电荷平衡方程简化为通常所说的质子条件：\n$$c_{\\mathrm{H^+}} = c_{\\mathrm{OH^-}} + c_{\\mathrm{HA^-}} + 2 c_{\\mathrm{A^{2-}}}$$\n\n$4$. **离子强度和活度系数：**\n离子强度 $I$ 由溶液中所有离子的浓度和电荷（$z_i$）定义：\n$$I = \\frac{1}{2} \\sum_i z_i^2 c_i = \\frac{1}{2} (c_{\\mathrm{H^+}} \\cdot 1^2 + c_{\\mathrm{OH^-}} \\cdot (-1)^2 + c_{\\mathrm{HA^-}} \\cdot (-1)^2 + c_{\\mathrm{A^{2-}}} \\cdot (-2)^2 + c_{\\mathrm{Na^+}} \\cdot 1^2 + c_{\\mathrm{Cl^-}} \\cdot (-1)^2)$$\n$$I = C_s + \\frac{1}{2} (c_{\\mathrm{H^+}} + c_{\\mathrm{OH^-}} + c_{\\mathrm{HA^-}} + 4 c_{\\mathrm{A^{2-}}})$$\n电荷为 $z_i$ 的离子的活度系数 $\\gamma_i$ 使用在 $T = 298.15\\,\\mathrm{K}$ 时的 Davies 方程计算：\n$$\\log_{10} \\gamma_i = - 0.509 \\, z_i^2 \\left( \\frac{\\sqrt{I}}{1 + \\sqrt{I}} - 0.3 I \\right)$$\n对于 $I=0$，$\\gamma_i=1$。请注意，$\\gamma_{\\mathrm{H^+}} = \\gamma_{\\mathrm{OH^-}} = \\gamma_{\\mathrm{HA^-}}$，因为它们的电荷大小都为 $1$。\n\n为求解该方程组，我们选择一个主变量 $h \\equiv c_{\\mathrm{H^+}}$，并用它表示所有其他浓度。此过程嵌入在一个迭代循环中，该循环收敛于一个自洽的离子强度 $I$。\n\n**迭代求解算法：**\n\n该算法从离子强度的初始猜测值 $I^{(0)}$ 开始，例如 $I^{(0)} = C_s + C_T$。重复以下步骤，直到 $I$ 收敛。\n\n**步骤 1：计算活度系数。**\n对于第 $k$ 次迭代时给定的离子强度 $I^{(k)}$，我们使用 Davies 方程计算活度系数 $\\gamma_{\\mathrm{H^+}}$、$\\gamma_{\\mathrm{OH^-}}$、$\\gamma_{\\mathrm{HA^-}}$ 和 $\\gamma_{\\mathrm{A^{2-}}}$。设 $\\gamma_1$ 为电荷为 $\\pm 1$ 的离子的系数，$\\gamma_2$ 为电荷为 $\\pm 2$ 的离子的系数。\n\n**步骤 2：定义条件平衡常数。**\n为了方便，我们将质量作用定律改写为用浓度表示。我们定义条件（或表观）平衡常数，这些常数通过活度系数依赖于离子强度：\n$$K_{a1,c} = \\frac{c_{\\mathrm{H^+}} c_{\\mathrm{HA^-}}}{c_{\\mathrm{H_2A}}} = K_{a1}^\\circ \\frac{\\gamma_{\\mathrm{H_2A}}}{\\gamma_{\\mathrm{H^+}}\\gamma_{\\mathrm{HA^-}}} = \\frac{K_{a1}^\\circ}{\\gamma_1^2}$$\n$$K_{a2,c} = \\frac{c_{\\mathrm{H^+}} c_{\\mathrm{A^{2-}}}}{c_{\\mathrm{HA^-}}} = K_{a2}^\\circ \\frac{\\gamma_{\\mathrm{HA^-}}}{\\gamma_{\\mathrm{H^+}}\\gamma_{\\mathrm{A^{2-}}}} = \\frac{K_{a2}^\\circ}{\\gamma_2}$$\n$$K_{w,c} = c_{\\mathrm{H^+}} c_{\\mathrm{OH^-}} = K_w^\\circ / (\\gamma_{\\mathrm{H^+}}\\gamma_{\\mathrm{OH^-}}) = K_w^\\circ / \\gamma_1^2$$\n\n**步骤 3：求解主方程以得到 $h = c_{\\mathrm{H^+}}$。**\n使用条件常数，我们将电荷平衡方程中所有物种的浓度表示为 $h$ 的函数：\n$$c_{\\mathrm{OH^-}} = \\frac{K_{w,c}}{h} = \\frac{K_w^\\circ}{\\gamma_1^2 h}$$\n使用质量平衡约束，酸物种的浓度可以用 $C_T$ 和 $h$ 表示：\n$$c_{\\mathrm{H_2A}} = C_T \\frac{h^2}{h^2 + K_{a1,c} h + K_{a1,c} K_{a2,c}}$$\n$$c_{\\mathrm{HA^-}} = C_T \\frac{K_{a1,c} h}{h^2 + K_{a1,c} h + K_{a1,c} K_{a2,c}}$$\n$$c_{\\mathrm{A^{2-}}} = C_T \\frac{K_{a1,c} K_{a2,c}}{h^2 + K_{a1,c} h + K_{a1,c} K_{a2,c}}$$\n将这些代入简化的电荷平衡方程，得到一个关于 $h$ 的单一主方程：\n$$f(h) = h - \\frac{K_w^\\circ}{\\gamma_1^2 h} - C_T \\left( \\frac{K_{a1,c} h + 2 K_{a1,c} K_{a2,c}}{h^2 + K_{a1,c} h + K_{a1,c} K_{a2,c}} \\right) = 0$$\n使用数值方法（如稳健高效的 Brent 方法）求解此非线性方程，以获得其根 $h > 0$。\n\n**步骤 4：更新离子强度。**\n一旦找到根 $h$，就可以计算所有平衡浓度（$c_{\\mathrm{H^+}}$、$c_{\\mathrm{OH^-}}$、$c_{\\mathrm{H_2A}}$、$c_{\\mathrm{HA^-}}$、$c_{\\mathrm{A^{2-}}}$）。然后根据其定义计算离子强度的新值 $I^{(k+1)}$。\n\n**步骤 5：检查收敛性。**\n将新的离子强度 $I^{(k+1)}$ 与前一个值 $I^{(k)}$ 进行比较。如果它们足够接近（例如，对于一个小的容差 $\\epsilon$，有 $|I^{(k+1)} - I^{(k)}|/I^{(k+1)}  \\epsilon$），则解是自洽的，迭代终止。否则，我们设置 $I^{(k)} \\leftarrow I^{(k+1)}$ 并返回步骤 1。\n\n**步骤 6：最终计算。**\n收敛后，即可得到最终浓度。氢离子的活度为 $a_{\\mathrm{H^+}} = \\gamma_1 c_{\\mathrm{H^+}}$，并根据 IUPAC 定义计算 $pH$：\n$$pH = -\\log_{10}(a_{\\mathrm{H^+}})$$\n程序实现了此算法来解决所提供的每个测试用例。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Computes equilibrium speciation for a diprotic acid in an aqueous solution\n    with a background electrolyte, applying activity corrections via the Davies equation.\n    \"\"\"\n\n    # Thermodynamic constants at T = 298.15 K\n    PKA1_0 = 3.60\n    PKA2_0 = 8.20\n    PKW_0 = 14.0\n    KA1_0 = 10**(-PKA1_0)\n    KA2_0 = 10**(-PKA2_0)\n    KW_0 = 10**(-PKW_0)\n    A_DEBYE = 0.509  # Parameter for Davies equation in (mol/L)^(-1/2)\n\n    def compute_speciation_for_case(Ct, Cs):\n        \"\"\"\n        Solves the equilibrium for a single case of total acid concentration (Ct)\n        and background salt concentration (Cs).\n\n        Args:\n            Ct (float): Total analytical concentration of the diprotic acid H2A.\n            Cs (float): Concentration of the 1:1 inert electrolyte.\n\n        Returns:\n            list: A list containing [pH, c_H2A, c_HA, c_A2-].\n        \"\"\"\n        # Initial guess for ionic strength.\n        # A small value is used if both Ct and Cs are zero to avoid division by zero.\n        I = Cs + Ct if (Cs + Ct) > 0 else 1e-12\n\n        for _ in range(100):  # Iterative loop for self-consistency, max 100 iterations.\n            # Step 1: Calculate activity coefficients based on current ionic strength I.\n            if I > 0:\n                sqrt_I = np.sqrt(I)\n                davies_term = (sqrt_I / (1.0 + sqrt_I)) - 0.3 * I\n                # gamma1 for ions with |z|=1 (H+, OH-, HA-)\n                log10_gamma1 = -A_DEBYE * (1**2) * davies_term\n                gamma1 = 10**log10_gamma1\n                # gamma2 for ions with |z|=2 (A^2-)\n                log10_gamma2 = -A_DEBYE * (2**2) * davies_term\n                gamma2 = 10**log10_gamma2\n            else:  # For I = 0, all activity coefficients are 1.\n                gamma1, gamma2 = 1.0, 1.0\n\n            # Step 2: Define conditional equilibrium constants.\n            Ka1_c = KA1_0 / (gamma1**2)\n            Ka2_c = KA2_0 / gamma2\n\n            # Step 3: Define the master equation (charge balance residual) to find h = c_H+.\n            def charge_balance_residual(h):\n                if h = 0: return -1.0\n                \n                denom = h**2 + Ka1_c * h + Ka1_c * Ka2_c\n                if denom == 0: return h # Should not happen for h > 0\n                \n                c_OH = KW_0 / (gamma1**2 * h)\n                c_HA = Ct * Ka1_c * h / denom\n                c_A2 = Ct * Ka1_c * Ka2_c / denom\n                \n                return h - c_OH - c_HA - 2.0 * c_A2\n            \n            # Find the root h = c_H+ using Brent's method.\n            # The interval [1e-15, Ct + Cs + 1.0] safely brackets the physical root.\n            try:\n                h = brentq(charge_balance_residual, 1e-15, Ct + Cs + 1.0)\n            except ValueError:\n                # This error indicates the function does not have opposite signs at the\n                # interval ends, which implies a problem with the model or interval.\n                # For this problem, the chosen interval is safe.\n                raise RuntimeError(\"Root finding failed. The interval may not bracket the root.\")\n\n            # Step 4: Calculate all species concentrations and the new ionic strength.\n            c_H = h\n            c_OH = KW_0 / (gamma1**2 * c_H)\n            denom = c_H**2 + Ka1_c * c_H + Ka1_c * Ka2_c\n            c_H2A = Ct * c_H**2 / denom\n            c_HA = Ct * Ka1_c * c_H / denom\n            c_A2 = Ct * Ka1_c * Ka2_c / denom\n            \n            # Update ionic strength definition\n            I_new = Cs + 0.5 * (c_H + c_OH + c_HA + 4.0 * c_A2)\n\n            # Step 5: Check for convergence.\n            if I > 1e-15 and abs(I_new - I) / I_new  1e-12:\n                I = I_new\n                break\n            # Special case for nearly pure water where I remains extremely small.\n            elif I  1e-15 and I_new  1e-12:\n                break\n            \n            I = I_new\n        \n        # Step 6: Final calculation of pH.\n        a_H = gamma1 * c_H\n        pH = -np.log10(a_H)\n        \n        return [pH, c_H2A, c_HA, c_A2]\n\n    # Define the test cases from the problem statement.\n    # Each tuple is (C_T, I_b), where I_b is implemented as C_s.\n    test_cases = [\n        (1e-3, 1e-1),   # Case 1\n        (1e-8, 0.0),    # Case 2\n        (1e-2, 1e-2),   # Case 3\n        (5e-3, 5e-1),   # Case 4\n    ]\n\n    results = []\n    for Ct, Cs in test_cases:\n        result = compute_speciation_for_case(Ct, Cs)\n        results.append(result)\n\n    # Format the final output string as specified.\n    formatted_case_results = []\n    for res in results:\n        pH, c_H2A, c_HA, c_A2 = res\n        # Format pH to 6 decimal places and concentrations to 6 significant figures in scientific notation.\n        formatted_list = [\n            f\"{pH:.6f}\",\n            f\"{c_H2A:.6e}\",\n            f\"{c_HA:.6e}\",\n            f\"{c_A2:.6e}\"\n        ]\n        formatted_case_results.append(f\"[{','.join(formatted_list)}]\")\n    \n    # Final print statement in the exact required format.\n    print(f\"[[{formatted_case_results[0]}],[{formatted_case_results[1]}],[{formatted_case_results[2]}],[{formatted_case_results[3]}]]\")\n\nsolve()\n```", "id": "2628319"}]}