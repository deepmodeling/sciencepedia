## 引言
在量子世界中，薛定谔方程是描述微观粒子行为的根本大法。然而，除了少数几个极其简单的体系，直接求解[多体系统](@entry_id:144006)的薛定谔方程几乎是不可能的任务。这一挑战催生了理论与计算科学中一个至关重要的分支：发展和应用近似方法。在众多近似方法中，变分原理以其深刻的物理内涵、严谨的数学基础和无与伦比的普适性脱颖而出，成为我们理解和预测分子与材料性质的基石。它不仅提供了一种系统地逼近量子系统[基态能量](@entry_id:263704)的方法，更重要的是，它为我们评估任何近似解的质量提供了一个明确的判据。

本文旨在对变分原理及其最强大的实现形式——线性变分理论进行一次全面而深入的探讨。我们将从其核心的数学定理出发，逐步揭示其如何被转化为强大的计算工具，并最终展现其在现代科学研究中的广泛影响力。

在接下来的内容中，读者将首先在“**原理与机制**”一章中，深入学习变分法的基本定理，包括针对[基态](@entry_id:150928)的里兹-瑞利原理和处理[激发态](@entry_id:261453)的HUM定理，并详细拆解[线性变分法](@entry_id:150058)的推导过程及其解的性质。随后，“**应用与跨学科联系**”一章将带领读者跨出[量子化学](@entry_id:140193)的范畴，探索变分思想如何在[材料科学](@entry_id:152226)、广义相对论乃至新兴的[量子计算](@entry_id:142712)领域中扮演关键角色，揭示其作为一种普适性科学思想的魅力。最后，在“**动手实践**”部分，通过精选的计算练习，读者将有机会亲手应用所学理论，解决具体问题，从而将抽象的原理内化为扎实的技能。

## 原理与机制

在量子力学中，精确求解多体系统的薛定谔方程通常是不可行的，只有少数几个最简单的系统除外。因此，开发和应用近似方法是理论化学和物理学的核心任务之一。在这些方法中，[变分法](@entry_id:163656)以其严谨的数学基础和广泛的适用性而独树一帜。本章将深入探讨变分法的基本原理，重点介绍其最普遍的实现形式——线性变分理论，并阐述其在现代[量子化学](@entry_id:140193)计算中的应用、细微差别和潜在挑战。

### 里兹-瑞利[变分原理](@entry_id:198028)

变分原理为我们提供了一种系统地逼近量子系统基态能量的方法，并为评估任何近似[波函数](@entry_id:147440)的质量提供了严格的判据。

#### [基态](@entry_id:150928)[变分定理](@entry_id:184487)

对于一个由[哈密顿算符](@entry_id:144286) $\hat{H}$ 描述的量子系统，其时间无关薛定谔方程为 $\hat{H}\Psi_n = E_n\Psi_n$。假设该[哈密顿算符](@entry_id:144286)是自伴的，并且其能谱是下方有界的，即存在一个最低的[能量本征值](@entry_id:144381)，我们称之为基态能量 $E_0$。

[变分定理](@entry_id:184487)的核心在于一个简洁而深刻的不等式。对于任何满足[系统边界](@entry_id:158917)条件且归一化的“试验”[波函数](@entry_id:147440) $\Psi$，其[哈密顿量](@entry_id:172864)的[期望值](@entry_id:153208)——也称为**里兹-[瑞利商](@entry_id:137794) (Rayleigh quotient)**——永远不会低于真实的基态能量 $E_0$。里兹-瑞利商的定义为：

$$
\mathcal{E}[\Psi] = \frac{\langle\Psi|\hat{H}|\Psi\rangle}{\langle\Psi|\Psi\rangle}
$$

其中，分母 $\langle\Psi|\Psi\rangle$ 用于处理未归一化的试验函数。[变分定理](@entry_id:184487)可以表述为：

$$
\mathcal{E}[\Psi] \ge E_0
$$

这个不等式是绝对的。等号成立的充分必要条件是，试验函数 $\Psi$ 与真实的[基态](@entry_id:150928)本征函数 $\Psi_0$ 完全相同（在[基态](@entry_id:150928)简并的情况下，$\Psi$ 是[基态](@entry_id:150928)[本征空间](@entry_id:147356)中的任意向量）。

这个定理的证明过程极具启发性。我们可以将任意一个归一化的试验函数 $\tilde{\Psi}$ 按系统完备的归一化[正交本征函数](@entry_id:167480)系 $\{\Psi_n\}$ 展开：$\tilde{\Psi} = \sum_n c_n \Psi_n$，其中 $\sum_n |c_n|^2 = 1$。其[能量期望值](@entry_id:174035)为：

$$
\mathcal{E}[\tilde{\Psi}] = \langle\sum_m c_m \Psi_m | \hat{H} | \sum_n c_n \Psi_n\rangle = \sum_{m,n} c_m^* c_n \langle\Psi_m|\hat{H}|\Psi_n\rangle = \sum_{m,n} c_m^* c_n E_n \delta_{mn} = \sum_n |c_n|^2 E_n
$$

由于 $E_n \ge E_0$ 对所有 $n$ 成立，我们可以得到：

$$
\mathcal{E}[\tilde{\Psi}] = \sum_n |c_n|^2 E_n \ge \sum_n |c_n|^2 E_0 = E_0 \left(\sum_n |c_n|^2\right) = E_0
$$

这证明了变分原理。这也揭示了，任何近似[波函数](@entry_id:147440)与真实[基态](@entry_id:150928)[波函数](@entry_id:147440)的差异，都会导致其[能量期望值](@entry_id:174035)“混合”进更高的[能量本征值](@entry_id:144381)，从而抬高其[平均能量](@entry_id:145892)。

值得注意的是，变分原理的应用有一个前提，即试验函数 $\Psi$ 必须位于[哈密顿算符](@entry_id:144286) $\hat{H}$ 的定义域内，这意味着 $\langle\Psi|\hat{H}|\Psi\rangle$ 必须是有限的。在实际应用中，我们选择的试验函数可能无法完美满足真实[波函数](@entry_id:147440)的所有局部性质。例如，在使用[高斯型轨道](@entry_id:175800)（GTOs）作为[基函数](@entry_id:170178)时，构造出的分子[轨道](@entry_id:137151)在[原子核](@entry_id:167902)位置不满足电子-[原子核](@entry_id:167902)**库仑[尖点条件](@entry_id:190416) (cusp condition)**。然而，只要这些函数仍然是平方可积且其在哈密顿作用下的[期望值](@entry_id:153208)有限，[变分定理](@entry_id:184487)依然严格成立。这意味着，即使试验函数在某些局部性质上存在缺陷，其计算出的能量仍然是真实[基态能量](@entry_id:263704)的严格[上界](@entry_id:274738)，尽管这种缺陷可能会减慢计算结果随[基组](@entry_id:160309)增大而收敛到精确值的速度 [@problem_id:2681485]。

#### [激发态](@entry_id:261453)变分原理

[变分原理](@entry_id:198028)最直接的应用是寻找[基态能量](@entry_id:263704)的上界。那么，我们能否用它来处理[激发态](@entry_id:261453)呢？简单地最小化里兹-瑞利商总是会使系统趋向于[基态](@entry_id:150928)。为了处理[激发态](@entry_id:261453)，我们需要引入更精妙的定理。

**Hylleraas–Undheim–MacDonald (HUM) 定理**，或称为交错定理，是处理[激发态](@entry_id:261453)的理论基石。它指出，当我们在一个 $N$ 维的试验函数[子空间](@entry_id:150286)中求解[变分问题](@entry_id:756445)时，会得到 $N$ 个[本征值](@entry_id:154894)（或称“里兹根”），$E_1 \le E_2 \le \dots \le E_N$。该定理保证，第 $k$ 个里兹根 $E_k$ 是系统第 $k$ 个真实[能量本征值](@entry_id:144381) $E_{k-1}^{\text{exact}}$ 的[上界](@entry_id:274738)（按能量排序，[基态](@entry_id:150928)为第0个）：

$$
E_k \ge E_{k-1}^{\text{exact}} \qquad (k=1, 2, \dots, N)
$$

例如，一个二维[变分问题](@entry_id:756445)得到的两个能量根 $E_1$ 和 $E_2$，分别满足 $E_1 \ge E_0^{\text{exact}}$ 和 $E_2 \ge E_1^{\text{exact}}$ [@problem_id:2681499]。

与此相关的是**MacDonald 定理**，它提供了一种序贯地寻找[激发态](@entry_id:261453)的方法。为了得到对第一[激发态](@entry_id:261453)能量 $E_1^{\text{exact}}$ 的变分[上界](@entry_id:274738)，我们必须在所有与**精确**[基态](@entry_id:150928)本征函数 $\Psi_0^{\text{exact}}$ 正交的试验函数构成的集合中，最小化里兹-[瑞利商](@entry_id:137794)。推广而言，对第 $k$ 个[激发态](@entry_id:261453)能量 $E_k^{\text{exact}}$ 的变分上界，可以通过在与所有低阶精确本征函数 $\{\Psi_0^{\text{exact}}, \dots, \Psi_{k-1}^{\text{exact}}\}$ 正交的试验函数空间中最小化能量来获得。

这里需要特别强调一个实践中的陷阱：如果在寻找[激发态](@entry_id:261453)时，我们施加的是与**近似**的低阶[波函数](@entry_id:147440)正交的约束，那么[变分定理](@entry_id:184487)的严格[上界](@entry_id:274738)保证就不再成立。这种操作有时可能导致计算出的能量甚至低于真实的[激发态](@entry_id:261453)能量 [@problem_id:2681499]。

### [线性变分法](@entry_id:150058)

[变分原理](@entry_id:198028)本身只是一个判据。为了将其转化为一种可计算的方法，最常用和最强大的策略是**[线性变分法](@entry_id:150058)**，也称为**[里兹法](@entry_id:168680) (Ritz method)**。其核心思想是，将未知的真实[波函数](@entry_id:147440)用一组预先选定的、[线性独立](@entry_id:153759)的[基函数](@entry_id:170178) $\{\phi_i\}_{i=1}^N$ 的线性组合来近似：

$$
\Psi = \sum_{i=1}^{N} c_i \phi_i
$$

这里的 $c_i$ 是待定的线性变分系数。现在，[变分问题](@entry_id:756445)转化为了一个[多元函数](@entry_id:145643)求极值问题：寻找一组系数 $\{c_i\}$，使得里兹-瑞利商 $\mathcal{E}[c_1, \dots, c_N]$ 达到最小值。

#### [久期方程](@entry_id:200202)

将线性组合代入里兹-瑞利商的表达式中，我们得到：

$$
\mathcal{E} = \frac{\sum_{i,j} c_i^* c_j \langle\phi_i|\hat{H}|\phi_j\rangle}{\sum_{i,j} c_i^* c_j \langle\phi_i|\phi_j\rangle}
$$

为了方便，我们引入矩阵记号。定义**哈密顿矩阵** $\mathbf{H}$ 和**[重叠矩阵](@entry_id:268881)** $\mathbf{S}$，其[矩阵元](@entry_id:186505)分别为：

$$
H_{ij} = \langle\phi_i|\hat{H}|\phi_j\rangle \qquad S_{ij} = \langle\phi_i|\phi_j\rangle
$$

$\mathbf{H}$ 和 $\mathbf{S}$ 都是[厄米矩阵](@entry_id:155147)（对于实函[数基](@entry_id:634389)组，它们是[实对称矩阵](@entry_id:192806)）。能量表达式可以写成：

$$
\mathcal{E} = \frac{\mathbf{c}^\dagger \mathbf{H} \mathbf{c}}{\mathbf{c}^\dagger \mathbf{S} \mathbf{c}}
$$

其中 $\mathbf{c}$ 是由系数 $c_i$ 构成的列向量。根据[变分原理](@entry_id:198028)，我们要求解使 $\mathcal{E}$ 对所有系数 $c_k$ 的变分为零的 stationary points。这可以通过对所有 $c_k^*$ 求偏导并令其为零来实现：$\frac{\partial \mathcal{E}}{\partial c_k^*} = 0$。经过推导，这最终导向一组 $N$ 个联立的[线性方程组](@entry_id:148943)：

$$
\sum_{j=1}^{N} (H_{kj} - E S_{kj}) c_j = 0 \quad \text{for } k=1, 2, \dots, N
$$

这组方程可以写成一个紧凑的矩阵形式：

$$
\mathbf{Hc} = E\mathbf{Sc}
$$

这就是著名的**广义本征值问题 (generalized eigenvalue problem)**，其对应的[行列式](@entry_id:142978)方程 $\det(\mathbf{H} - E\mathbf{S}) = 0$ 被称为**[久期方程](@entry_id:200202) (secular equation)**。如果[基函数](@entry_id:170178)组 $\{\phi_i\}$ 是标准正交的，那么[重叠矩阵](@entry_id:268881) $\mathbf{S}$ 就是单位矩阵 $\mathbf{I}$，方程就简化为我们更熟悉的标准本征值问题 $\mathbf{Hc} = E\mathbf{c}$ [@problem_id:2681508]。然而，在[量子化学](@entry_id:140193)的许多应用中，例如使用原子轨道作为[基组](@entry_id:160309)时，[基函数](@entry_id:170178)通常是非正交的，因此必须求解广义本征值问题 [@problem_id:2681485]。

#### 解的性质

求解[久期方程](@entry_id:200202)会得到 $N$ 个实数[本征值](@entry_id:154894) $E_k$（里兹根）和 $N$ 个对应的[本征向量](@entry_id:151813) $\mathbf{c}_k$。
- **[本征值](@entry_id:154894)**：这些[本征值](@entry_id:154894) $E_k$ 就是在选定[子空间](@entry_id:150286)内的变分能量。根据 HUM 定理，它们从低到高依次是真实能谱中从[基态](@entry_id:150928)开始的各个能级的[上界](@entry_id:274738)。最低的[本征值](@entry_id:154894) $E_1$ 是对[基态能量](@entry_id:263704) $E_0$ 的最佳变分近似。
- **[本征向量](@entry_id:151813)**：每个[本征向量](@entry_id:151813) $\mathbf{c}_k$ 定义了一个近似的本征函数 $\Psi_k = \sum_i c_{ik} \phi_i$。这些近似[本征函数](@entry_id:154705)的一个重要性质是，它们是关于[重叠矩阵](@entry_id:268881) $\mathbf{S}$ **加权正交**的，即 $\langle\Psi_k|\Psi_l\rangle = \mathbf{c}_k^\dagger \mathbf{S} \mathbf{c}_l = \delta_{kl}$（如果[本征向量](@entry_id:151813)已归一化）。这不同于系数向量本身的欧几里得正交性（$\mathbf{c}_k^\dagger \mathbf{c}_l = \delta_{kl}$），后者仅在[标准正交基](@entry_id:147779)的情况下成立 [@problem_id:2681499]。
- **[子空间](@entry_id:150286)中的最优性**：[线性变分法](@entry_id:150058)找到的解 $\Psi_k$ 是能量泛函在试验[子空间](@entry_id:150286) $\mathcal{S} = \text{span}\{\phi_i\}$ 内的**[驻点](@entry_id:136617)**。最低的根 $E_1$ 对应于[全局最小值](@entry_id:165977)，而较高的根 $E_k (k>1)$ 对应于**[鞍点](@entry_id:142576)** [@problem_id:2681487]。这意味着，对于一个近似的[激发态](@entry_id:261453) $\Psi_k$，总能在[子空间](@entry_id:150286)内找到一个方向（例如，混入低阶近似态 $\Psi_j$ 的方向），使得能量降低。
- **Galerkin 条件**：在任何一个里兹解 $(\Psi_k, E_k)$ 处，其**残差向量 (residual vector)** $\lvert r_k \rangle = (\hat{H} - E_k)\lvert\Psi_k\rangle$ 与整个试验[子空间](@entry_id:150286) $\mathcal{S}$ 正交。也就是说，对任意 $\phi_j \in \mathcal{S}$，都有 $\langle\phi_j|r_k\rangle = 0$ [@problem_id:2681487]。这个条件表明，通过将薛定谔方程投影到试验[子空间](@entry_id:150286)上，我们的近似解在该[子空间](@entry_id:150286)内已经“尽力”满足了方程。然而，如果 $\Psi_k$ 不是精确解，[残差向量](@entry_id:165091)本身并不为零，它指向[子空间](@entry_id:150286)的正交补空间。这个方向正是能够最快降低能量的变分方向 [@problem_id:2681487]。

#### [基组](@entry_id:160309)的角色

[线性变分法](@entry_id:150058)的成功在很大程度上取决于[基组](@entry_id:160309) $\{\phi_i\}$ 的选择。
- **[线性无关](@entry_id:148207)性与[重叠矩阵](@entry_id:268881)**：一个“好”的[基组](@entry_id:160309)首先必须是[线性无关](@entry_id:148207)的。在线性代数层面，这等价于[重叠矩阵](@entry_id:268881) $\mathbf{S}$ 是**正定 (positive-definite)** 的，即对于任何非零向量 $\mathbf{c}$，二次型 $\mathbf{c}^\dagger \mathbf{S} \mathbf{c} > 0$。这个二次型实际上就是试验函数 $\Psi$ 的模方 $\langle\Psi|\Psi\rangle$，因此其正定性是物理上必须的。一个正定的[厄米矩阵](@entry_id:155147)，其所有[本征值](@entry_id:154894)都为正实数 [@problem_id:2681502]。
- **线性相关与奇异性**：如果[基组](@entry_id:160309)中存在线性相关（或“近似[线性相关](@entry_id:185830)”），$\mathbf{S}$ 就会变得奇异（[行列式](@entry_id:142978)为零）或病态（ill-conditioned，条件数巨大）。
    - **病态问题**：近似线性相关意味着某些[基函数](@entry_id:170178)几乎可以被其他[基函数](@entry_id:170178)线性表出。这会导致 $\mathbf{S}$ 的最小[本征值](@entry_id:154894)非常接近于零，其[条件数](@entry_id:145150)（最大[本征值](@entry_id:154894)与最小[本征值](@entry_id:154894)之比 [@problem_id:2681502]）变得极大。在有限精度计算中，这会引发严重的数值不稳定性，但需要明确的是，在理想的精确计算中，变分上界原理并未被破坏 [@problem_id:2681502]。
    - **奇异问题**：严格的[线性相关](@entry_id:185830)意味着[基组](@entry_id:160309)是冗余的。这并不意味着[变分法](@entry_id:163656)失败，而只是说明我们选择了一个不经济的[基组](@entry_id:160309)。处理方法很简单：从原[基组](@entry_id:160309)中移除冗余的函数，得到一个新的、线性无关的[基组](@entry_id:160309)，它张成完全相同的[子空间](@entry_id:150286)。在这个新[基组](@entry_id:160309)上求解，得到的结果与在原冗余[基组](@entry_id:160309)上（正确处理后）得到的结果完全一致，并且能量依然是真实能量的上界 [@problem_id:2681485, @problem_id:2681502]。
- **[正交化](@entry_id:149208)**：处理[非正交基组](@entry_id:190211)的一个常用技巧是将其变换为一个[标准正交基](@entry_id:147779)组。例如，通过**典则正交化 (canonical orthogonalization)**，利用 $\mathbf{S}^{-1/2}$ 矩阵，可以将广义本征值问题 $\mathbf{Hc} = E\mathbf{Sc}$ 严格地转化为一个标准[本征值问题](@entry_id:142153) $\mathbf{H'c'} = E\mathbf{c'}$，其中 $\mathbf{H'} = \mathbf{S}^{-1/2}\mathbf{H}\mathbf{S}^{-1/2}$。这个变换不改变问题的[本征值](@entry_id:154894)谱，是许多[量子化学](@entry_id:140193)程序中的标准步骤 [@problem_id:2681502]。

### 应用与进阶概念

[线性变分法](@entry_id:150058)是[理论化学](@entry_id:199050)中许多核心方法的统一框架。

#### 构型相互作用作为线性变分

**构型相互作用 (Configuration Interaction, CI)** 方法是[线性变分法](@entry_id:150058)最直接的应用之一。在这里，[基函数](@entry_id:170178) $\{\phi_i\}$ 不再是单粒子函数，而是多电子的**斯莱特行列式 (Slater determinants)** $\lvert D_I \rangle$。每一个[行列式](@entry_id:142978)代表了电子占据不同[自旋轨道](@entry_id:274032)的一种“构型”。
- **FCI**: 如果我们使用一个有限的单粒[子基](@entry_id:151637)组，并构造出所有可能的 $N$ 电子[斯莱特行列式](@entry_id:139034)，然后以它们为基进行线性变分计算，这个过程称为**全构型相互作用 (Full CI, FCI)**。FCI 在给定的单粒[子基](@entry_id:151637)组所能张成的多电子[希尔伯特空间](@entry_id:261193)内是“精确”的，其给出的能量是该[基组](@entry_id:160309)下所能达到的最低能量 [@problem_id:2681508]。
- **[误差分析](@entry_id:142477)**: 在这个框架下，我们可以清晰地分解近似计算的总误差。
    1.  **相关能 (Correlation Energy)**: 对于一个给定的[基组](@entry_id:160309)，FCI 能量 $E_{\text{FCI}}(M)$ 与同一[基组](@entry_id:160309)下的哈特里-福克 ([Hartree-Fock](@entry_id:142303), HF) 能量 $E_{\text{HF}}(M)$ 之差，定义为该[基组](@entry_id:160309)所能描述的[电子相关能](@entry_id:261350)。HF 方法本身就是一种约束性的[变分法](@entry_id:163656)（约束[波函数](@entry_id:147440)为单个[行列式](@entry_id:142978)），因此 $E_{\text{FCI}}(M) \le E_{\text{HF}}(M)$ [@problem_id:2681501]。相关能的严格定义是精确非[相对论能量](@entry_id:158443) $E_0$ 与[完备基组](@entry_id:200333)下的HF能量 $E_{\text{HF}}(\infty)$ 之差 [@problem_id:2681501]。
    2.  **[基组不完备性误差](@entry_id:166106) (Basis Set Incompleteness Error)**: FCI 能量 $E_{\text{FCI}}(M)$ 与真实能量 $E_0$ 之间的差异，则完全是由于单粒[子基](@entry_id:151637)组不完备造成的。随着[基组](@entry_id:160309)趋于完备（$M \to \infty$），$E_{\text{FCI}}(M)$ 会从上方收敛于 $E_0$ [@problem_id:2681501]。
- **重要特性**:
    - **[Brillouin 定理](@entry_id:166170)**: HF 方程的自洽性保证了 HF [行列式](@entry_id:142978)与所有单激发[行列式](@entry_id:142978)之间的[哈密顿矩阵元](@entry_id:201928)为零。这意味着只包含单激发的 CI (CIS) 计算不会降低基态能量 [@problem_id:2681508]。
    - **[大小一致性](@entry_id:199161) (Size Consistency)**: 像 CISD（包含单、双激发）这样的截断 CI 方法不是大小一致的。这意味着，对于两个不相互作用的体系 A 和 B，CISD(A+B) 的能量不等于 CISD(A) + CISD(B) [@problem_id:2681508]。
    - **[显式相关方法](@entry_id:174900)**: 像引入 [Jastrow 因子](@entry_id:158362) $\exp(\gamma r_{12})$ 这样直接将电子间距离 $r_{12}$ 引入[波函数](@entry_id:147440)的方法，其试验函数不属于任何有限[基组](@entry_id:160309)的 FCI 空间。因此，它们有可能在小[基组](@entry_id:160309)下获得比 FCI 更低的能量，因为它们能更有效地描述电子相关，特别是电子-电子尖点 [@problem_id:2681501]。

#### [非线性](@entry_id:637147)变分参数

除了线性系数，我们还可以在[基函数](@entry_id:170178)本身引入**[非线性](@entry_id:637147)参数**（例如高斯函数的指数 $\alpha$），然后对所有参数（线性和[非线性](@entry_id:637147)）同时进行能量最小化。
- 变分原理依然适用：对所有参数最小化得到的能量，仍然是真实[基态能量](@entry_id:263704)的上界 [@problem_id:2681495]。
- 如果试验函数的形式足够灵活，以至于在某个参数值下它能够精确地等于真实[波函数](@entry_id:147440)，那么变分法原则上可以找到精确解 [@problem_id:2681495]。例如，对于[谐振子](@entry_id:155622)，使用[高斯函数](@entry_id:261394)作为试验函数并优化其指数，可以得到精确的基态能量和[波函数](@entry_id:147440)。但对于[非谐振子](@entry_id:142760)（如包含 $x^4$ 项的势），高斯函数不是其[本征态](@entry_id:149904)，因此只能得到近似解 [@problem_id:2681511]。
- **广义 Hellmann-Feynman 定理**: 当线性系数被优化后，变分能量对[非线性](@entry_id:637147)参数的导数有一个简洁的形式，这为[梯度下降](@entry_id:145942)等[优化算法](@entry_id:147840)提供了便利。这个导数不包含线性系数对参数的导数项，但确实包含哈密顿矩阵和[重叠矩阵](@entry_id:268881)对参数的导数项 [@problem_id:2681495]。
- 在仅有线性参数的变分中，所有根（[基态](@entry_id:150928)和[激发态](@entry_id:261453)）都是同时通过一次[对角化](@entry_id:147016)找到的。但在[非线性优化](@entry_id:143978)中，如果目标是[激发态](@entry_id:261453)，必须施加正交约束，否则优化过程很可能会“坍缩”到能量更低的[基态](@entry_id:150928)上 [@problem_id:2681499]。

#### 与微扰论的联系

[线性变分法](@entry_id:150058)与**瑞利-薛定谔微扰论 (Rayleigh-Schrödinger Perturbation Theory, RSPT)** 之间存在深刻的联系。如果我们选择一个未受扰[哈密顿量](@entry_id:172864) $\hat{H}_0$ 的本征函数系作为[基组](@entry_id:160309)，对全[哈密顿量](@entry_id:172864) $\hat{H} = \hat{H}_0 + \lambda\hat{V}$ 进行线性变分计算，那么在微扰小量 $\lambda$ 的低阶展开中，[变分法](@entry_id:163656)的结果与 RSPT 的结果完全吻合。具体来说，[变分法](@entry_id:163656)给出的[一阶波函数修正](@entry_id:275651)和[二阶能量修正](@entry_id:136486)与 RSPT 的标准公式完全一致 [@problem_id:2681510]。这为理解两种方法的内在联系提供了一个有力的视角。

#### 无界[哈密顿量](@entry_id:172864)的挑战：变分坍缩

标准变分原理的可靠性依赖于[哈密顿量](@entry_id:172864)是**下方有界**的这一前提。非相对论薛定谔[哈密顿量](@entry_id:172864)通常满足此条件。然而，在[相对论量子力学](@entry_id:148643)中，情况发生了根本性的变化。
- **[狄拉克-库仑哈密顿量](@entry_id:202349) ($\hat{H}_{\text{D}}$)**: 该算符的谱不仅包含对应于电子束缚态和正能连续谱（从 $\approx +mc^2$ 开始），还包含一个延伸至 $-\infty$ 的负能[连续谱](@entry_id:155477)（对应于正电子）。因此，$\hat{H}_{\text{D}}$ 是下方无界的。
- **变分坍缩 (Variational Collapse)**: 如果将标准的、基于最小化的变分原理直接应用于 $\hat{H}_{\text{D}}$，随着[基组](@entry_id:160309)的灵活性增加，计算得到的最低能量将不可避免地持续下降，坠入负能海，最终趋向于 $-\infty$。这个现象称为“变分坍缩”或“[布朗-拉文霍尔病](@entry_id:202082) (Brown-Ravenhall disease)”。此时，变分法完全失效，无法给出任何有意义的束缚态能量[上界](@entry_id:274738) [@problem_id:2681484]。
- **解决方案**:
    1.  **最小-最大原理 (Min-Max Principle)**: 严格的数学理论表明，对于像 $\hat{H}_{\text{D}}$ 这样的算符，其谱隙中的离散[本征值](@entry_id:154894)（即电子的束缚态）对应于里兹-瑞利商泛函的**[鞍点](@entry_id:142576)**，而非最小值。因此，必须使用更为复杂的最小-最大原理来寻找它们。
    2.  **投影算符法**: 一个在实践中更可行的方法是，通过**[投影算符](@entry_id:154142)** $P_+$ 将[哈密顿量](@entry_id:172864)投影到（通常是[自由粒子](@entry_id:148748)狄拉克算符的）正[能谱](@entry_id:181780)[子空间](@entry_id:150286)上，即求解 $P_+\hat{H}_{\text{D}}P_+$ 的[本征问题](@entry_id:748835)。这个投影后的算符是下方有界的，因此可以安全地使用标准[变分法](@entry_id:163656)。
    3.  **动能平衡 (Kinetic Balance)**: 这是在[基组](@entry_id:160309)层面解决问题的巧妙方法。通过在构建四分量旋量[基组](@entry_id:160309)时，强制小分量[基组](@entry_id:160309)与大分量[基组](@entry_id:160309)之间满足正确的非相对论极限关系（例如，$\psi_S \approx \frac{\boldsymbol{\sigma}\cdot\hat{\mathbf{p}}}{2mc}\psi_L$），可以有效地阻止[基组](@entry_id:160309)描述负能态，从而避免变分坍缩 [@problem_id:2681484]。

需要澄清的是，变分坍缩是相对论理论特有的问题，在非相对论的 [Kohn-Sham密度泛函理论](@entry_id:144173)（DFT）等方法中并不存在，因为其有效[单电子算符](@entry_id:191980)是下方有界的 [@problem_id:2681484]。

总之，[变分原理](@entry_id:198028)及其线性实现构成了我们近似求解量子力学问题的理论武库中最强大和最灵活的工具之一。理解其基本定理、应用细节以及其成立的边界条件，对于任何有志于理论与计算化学研究的学者来说都至关重要。