{"hands_on_practices": [{"introduction": "要真正理解Hartree-Fock-Roothaan方法，没有什么比亲手进行计算更能加深理解的了。第一个练习将引导您对一个最小体系手动执行单次自洽场（SCF）迭代。通过手动构建矩阵并求解广义本征值问题[@problem_id:2643602]，您将对初始猜测如何向自洽解演化获得一个具体而坚实的理解。", "problem": "考虑一个用于演示的最小简化系统，旨在说明在非正交原子轨道 (AO) 基组中闭壳层分子的 Hartree–Fock–Roothaan 方程。有 $2$ 个电子以双占据方式（限制性闭壳层）占据一个空间分子轨道。该基组维度为 $2$，其原子轨道重叠矩阵为\n$$\nS \\;=\\; \\begin{pmatrix}\n1.0  0.2 \\\\\n0.2  1.0\n\\end{pmatrix}.\n$$\n单电子核心哈密顿矩阵（单位为哈特里原子单位）为\n$$\nH^{\\text{core}} \\;=\\; \\begin{pmatrix}\n-1.0  -0.2 \\\\\n-0.2  -0.5\n\\end{pmatrix}.\n$$\n电子排斥积分以化学家记法 $(\\mu\\nu|\\lambda\\sigma)$ 给出，并遵循标准的置换对称性。唯一非零的双电子积分（单位为哈特里）是\n$$\n(11|11)=0.7,\\quad (22|22)=0.6,\\quad (11|22)=(22|11)=0.2,\\quad (12|12)=(21|21)=(12|21)=(21|12)=0.25,\n$$\n所有其他 $(\\mu\\nu|\\lambda\\sigma)$ 均为零。假设核排斥能为 $0$ 哈特里。\n\n从初始零密度出发，根据限制性闭壳层系统的 Hartree–Fock–Roothaan 方法，明确地执行一次自洽场 (SCF) 迭代：在原子轨道基组中对角化初始 Fock 矩阵的广义本征值问题，以获得最低能量的归一化分子轨道（进行 $S$-正交归一化），构建更新后的原子轨道密度矩阵，使用更新后的密度重建 Fock 矩阵，然后计算闭壳层电子能量。在非正交原子轨道基组中，使用适用于 Hartree–Fock 理论的标准闭壳层定义。\n\n以哈特里为单位表示最终的电子能量（不包括核排斥能），并将您的答案四舍五入到四位有效数字。您的最终答案必须是一个实数。", "solution": "该问题要求对一个限制性闭壳层系统执行一次完整的自洽场 (SCF) 过程迭代，如 Hartree-Fock-Roothaan 方程所描述。该系统由 $2$ 个电子组成，处于由两个原子轨道 (AO) 构成的非正交基组中。最终目标是计算这次单次迭代后的电子能量。\n\n在原子轨道基组中的 Hartree-Fock-Roothaan 方程是一个广义本征值问题：\n$$ FC = SCE $$\n其中 $F$ 是 Fock 矩阵，$C$ 是分子轨道 (MO) 系数矩阵，$S$ 是原子轨道重叠矩阵，$E$ 是轨道能量 $\\epsilon_i$ 的对角矩阵。\n\n对于限制性闭壳层系统，Fock 矩阵的元素 $F_{\\mu\\nu}$ 由下式给出：\n$$ F_{\\mu\\nu} = H_{\\mu\\nu}^{\\text{core}} + \\sum_{\\lambda\\sigma} P_{\\lambda\\sigma} \\left[ (\\mu\\nu|\\lambda\\sigma) - \\frac{1}{2}(\\mu\\lambda|\\nu\\sigma) \\right] $$\n这里，$H^{\\text{core}}$ 是核心哈密顿量，$(\\mu\\nu|\\lambda\\sigma)$ 是化学家记法中的双电子排斥积分，$P$ 是密度矩阵。对于一个有 $N$ 个电子的系统，密度矩阵元素 $P_{\\lambda\\sigma}$ 定义为：\n$$ P_{\\lambda\\sigma} = 2 \\sum_{i=1}^{N/2} C_{\\lambda i} C_{\\sigma i}^* $$\n其中求和遍及所有占据的分子轨道。对于本问题，$N=2$，因此求和仅针对最低能量的分子轨道，即 $i=1$。\n\n电子能量 $E_{elec}$ 使用收敛的密度矩阵和 Fock 矩阵计算：\n$$ E_{elec} = \\frac{1}{2} \\sum_{\\mu\\nu} P_{\\nu\\mu} (H_{\\mu\\nu}^{\\text{core}} + F_{\\mu\\nu}) $$\n鉴于矩阵是实数且对称的，这等价于 $E_{elec} = \\frac{1}{2} \\text{Tr}[P(H^{\\text{core}} + F)]$。\n\nSCF 过程从对密度矩阵 $P^{(0)}$ 的初始猜测开始。\n**步骤 0：初始猜测**\n题目指定初始密度为零。因此，初始密度矩阵 $P^{(0)}$ 是一个 $2 \\times 2$ 的零矩阵：\n$$ P^{(0)} = \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix} $$\n\n**步骤 1：初始 Fock 矩阵**\n使用 $P^{(0)}$，我们构建初始 Fock 矩阵 $F^{(0)}$。由于 $P^{(0)}$ 是零矩阵，Fock 矩阵表达式中的双电子项消失。因此，初始 Fock 矩阵等于核心哈密顿量：\n$$ F^{(0)} = H^{\\text{core}} = \\begin{pmatrix} -1.0  -0.2 \\\\ -0.2  -0.5 \\end{pmatrix} $$\n\n**步骤 2：求解广义本征值问题**\n我们求解广义本征值问题 $F^{(0)}C^{(1)} = SC^{(1)}E^{(1)}$ 以找到分子轨道系数 $C^{(1)}$ 和能量 $E^{(1)}$ 的第一次迭代。这需要解久期方程 $\\det(F^{(0)} - \\epsilon S) = 0$。\n$$ \\det \\left( \\begin{pmatrix} -1.0  -0.2 \\\\ -0.2  -0.5 \\end{pmatrix} - \\epsilon \\begin{pmatrix} 1.0  0.2 \\\\ 0.2  1.0 \\end{pmatrix} \\right) = 0 $$\n$$ \\det \\begin{pmatrix} -1.0 - \\epsilon  -0.2 - 0.2\\epsilon \\\\ -0.2 - 0.2\\epsilon  -0.5 - \\epsilon \\end{pmatrix} = 0 $$\n行列式为：\n$$ (-1.0 - \\epsilon)(-0.5 - \\epsilon) - (-0.2 - 0.2\\epsilon)^2 = 0 $$\n展开后得到二次方程：\n$$ 0.96\\epsilon^2 + 1.42\\epsilon + 0.46 = 0 $$\n求解这个二次方程，我们得到两个轨道能量：$\\epsilon_1 = -1.0$ 和 $\\epsilon_2 = -0.92/1.92 \\approx -0.47917$。最低能量的轨道是 $\\epsilon_1 = -1.0$。\n\n**步骤 3：确定并归一化最低能量的分子轨道**\n我们通过求解 $(F^{(0)} - \\epsilon_1 S)C_1 = 0$ 来找到对应于 $\\epsilon_1 = -1.0$ 的本征向量 $C_1$：\n$$ \\left( \\begin{pmatrix} -1.0  -0.2 \\\\ -0.2  -0.5 \\end{pmatrix} - (-1.0) \\begin{pmatrix} 1.0  0.2 \\\\ 0.2  1.0 \\end{pmatrix} \\right) \\begin{pmatrix} c_{11} \\\\ c_{21} \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  0.5 \\end{pmatrix} \\begin{pmatrix} c_{11} \\\\ c_{21} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} $$\n第二行给出 $0.5 c_{21} = 0$，所以 $c_{21}=0$。第一行 $0=0$ 对 $c_{11}$ 没有约束。我们可以设 $c_{11}=1$，得到未归一化的本征向量 $C_1' = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n分子轨道必须根据 $C_1^\\dagger S C_1 = 1$ 进行归一化。\n$$ \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} 1.0  0.2 \\\\ 0.2  1.0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} 1.0 \\\\ 0.2 \\end{pmatrix} = 1.0 $$\n归一化常数为 $1$，因此归一化后的分子轨道系数向量是 $C_1^{(1)} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n\n**步骤 4：构建更新的密度矩阵**\n在单个占据的分子轨道 $\\psi_1$ 中有 $2$ 个电子，新的密度矩阵 $P^{(1)}$ 是：\n$$ P_{\\mu\\nu}^{(1)} = 2 C_{\\mu 1}^{(1)} C_{\\nu 1}^{(1)} $$\n使用 $C_1^{(1)} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$，我们得到：\n$P_{11}^{(1)} = 2(1)(1) = 2$\n$P_{12}^{(1)} = P_{21}^{(1)} = 2(1)(0) = 0$\n$P_{22}^{(1)} = 2(0)(0) = 0$\n$$ P^{(1)} = \\begin{pmatrix} 2  0 \\\\ 0  0 \\end{pmatrix} $$\n\n**步骤 5：重建 Fock 矩阵**\n更新后的 Fock 矩阵 $F^{(1)}$ 是使用 $P^{(1)}$ 构建的。一个矩阵元素的一般表达式为：\n$$ F_{\\mu\\nu}^{(1)} = H_{\\mu\\nu}^{\\text{core}} + \\sum_{\\lambda\\sigma} P_{\\lambda\\sigma}^{(1)} \\left[ (\\mu\\nu|\\lambda\\sigma) - \\frac{1}{2}(\\mu 1|\\nu 1) \\right] $$\n由于只有 $P_{11}^{(1)} = 2$ 非零，求和简化为 $\\lambda=\\sigma=1$ 的项：\n$$ F_{\\mu\\nu}^{(1)} = H_{\\mu\\nu}^{\\text{core}} + P_{11}^{(1)} \\left[ (\\mu\\nu|11) - \\frac{1}{2}(\\mu 1|\\nu 1) \\right] = H_{\\mu\\nu}^{\\text{core}} + 2 \\left[ (\\mu\\nu|11) - \\frac{1}{2}(\\mu 1|\\nu 1) \\right] $$\n未列出的积分为零。\n对于 $F_{11}^{(1)}$: $(\\mu=1, \\nu=1)$\n$$ F_{11}^{(1)} = H_{11}^{\\text{core}} + 2 \\left[ (11|11) - \\frac{1}{2}(11|11) \\right] = H_{11}^{\\text{core}} + (11|11) = -1.0 + 0.7 = -0.3 $$\n对于 $F_{22}^{(1)}$: $(\\mu=2, \\nu=2)$\n$$ F_{22}^{(1)} = H_{22}^{\\text{core}} + 2 \\left[ (22|11) - \\frac{1}{2}(21|21) \\right] = -0.5 + 2 \\left[ 0.2 - \\frac{1}{2}(0.25) \\right] = -0.5 + 2(0.075) = -0.35 $$\n对于 $F_{12}^{(1)}$: $(\\mu=1, \\nu=2)$\n$$ F_{12}^{(1)} = H_{12}^{\\text{core}} + 2 \\left[ (12|11) - \\frac{1}{2}(11|21) \\right] $$\n积分 $(12|11)$ 和 $(11|21)$ 不在非零积分列表中，因此它们为 $0$。\n$$ F_{12}^{(1)} = H_{12}^{\\text{core}} + 0 = -0.2 $$\n根据对称性，$F_{21}^{(1)} = -0.2$。新的 Fock 矩阵是：\n$$ F^{(1)} = \\begin{pmatrix} -0.3  -0.2 \\\\ -0.2  -0.35 \\end{pmatrix} $$\n\n**步骤 6：计算电子能量**\n一次迭代后的电子能量 $E_{elec}^{(1)}$ 使用 $P^{(1)}$ 和 $F^{(1)}$ 计算：\n$$ E_{elec}^{(1)} = \\frac{1}{2} \\sum_{\\mu\\nu} P_{\\mu\\nu}^{(1)} (H_{\\mu\\nu}^{\\text{core}} + F_{\\mu\\nu}^{(1)}) $$\n由于 $P^{(1)}$ 只有一个非零元素 $P_{11}^{(1)}=2$：\n$$ E_{elec}^{(1)} = \\frac{1}{2} P_{11}^{(1)} (H_{11}^{\\text{core}} + F_{11}^{(1)}) = \\frac{1}{2} (2) (-1.0 + (-0.3)) = 1 \\cdot (-1.3) = -1.3 $$\n经过一次 SCF 迭代后，电子能量（不包括核排斥能）为 $-1.3$ 哈特里。\n\n题目要求答案四舍五入到四位有效数字。这给出 $-1.300$。", "answer": "$$\\boxed{-1.300}$$", "id": "2643602"}, {"introduction": "尽管SCF程序在理论上很优雅，但其在实际应用中常面临数值挑战。一个常见问题源于原子轨道基组中的线性依赖，这会导致重叠矩阵 $S$ 奇异，这个练习[@problem_id:2464743]探讨了奇异 $S$ 矩阵的数学后果，以及量子化学软件中为确保解的稳定性和意义而采用的标准处理技术。", "problem": "在针对闭壳层体系的 Hartree-Fock-Roothaan 方法中，分子轨道在一个有限的、通常非正交的原子轨道 (AO) 集合中展开。由此产生的广义本征值问题是 $F C = S C \\varepsilon$，其中 $F$ 是原子轨道基组下的 Fock 矩阵，$S$ 是原子轨道重叠矩阵，其矩阵元为 $S_{\\mu \\nu} = \\langle \\chi_{\\mu} | \\chi_{\\nu} \\rangle$，$C$ 汇集了分子轨道系数，而 $\\varepsilon$ 是轨道能量的对角矩阵。考虑所选的原子轨道基组存在精确线性相关性的情况，因此重叠矩阵 $S$ 是奇异的（秩亏的）。\n\n在这种情况下，下列哪些陈述是正确的？选择所有适用项。\n\nA. 广义本征值问题 $F C = S C \\varepsilon$ 是不适定的，因为 $S$ 不可逆；在 $S$ 的非平凡零空间存在的情况下，系数向量不是唯一的，因为在系数向量中添加零空间中的任何分量，既不会改变原子轨道空间范数，也不会改变物理轨道。\n\nB. 当 $S$ 是奇异矩阵时，无法构建基于 $X = S^{-1/2}$ 的正则正交化；一个标准的补救方法是对角化 $S = U s U^{\\dagger}$，舍弃 $s_{ii}$ 低于某个数值阈值的本征向量，并仅使用保留的子空间来设置 $X = U_{r} s_{r}^{-1/2} U_{r}^{\\dagger}$，从而消除线性相关性。\n\nC. 即使当 $S$ 是奇异矩阵时，执行 Cholesky 分解 $S = L L^{\\dagger}$ 也总能成功，因此可以安全地构建 $X = L^{-1}$ 来进行正交化，而无需修改基组。\n\nD. 用 $S + \\delta I$（其中 $\\delta  0$ 是一个小量）替换 $S$，能保证在 $\\delta \\to 0^{+}$ 的极限下保留 Hartree-Fock 驻点，同时保留完整基组，因此这是一种精确且通常首选的补救方法。\n\nE. 基组中的线性相关性意味着 $S$ 至少有一个负本征值，这违反了变分原理，并导致 Hartree-Fock 方法从根本上失败。", "solution": "该问题探讨了在针对闭壳层体系的 Hartree-Fock-Roothaan 方法中，原子轨道 (AO) 基组中线性相关性的后果。问题的核心是广义本征值方程 $F C = S C \\varepsilon$，其中重叠矩阵 $S$ 由于这些线性相关性而变得奇异（秩亏）。一个奇异的 $S$ 矩阵具有非平凡的零空间，意味着至少存在一个非零向量 $v$ 使得 $S v = 0$。这具有显著的数学和数值意义，我们将对每个陈述进行分析。\n\n具有矩阵元 $S_{\\mu\\nu} = \\langle \\chi_\\mu | \\chi_\\nu \\rangle$ 的重叠矩阵 $S$ 是一个格拉姆矩阵 (Gramian matrix)。根据其构造，它是半正定的。对于任何复向量 $c$，其二次型为 $c^{\\dagger} S c = \\sum_{\\mu,\\nu} c_\\mu^* S_{\\mu\\nu} c_\\nu = \\langle \\sum_\\mu c_\\mu \\chi_\\mu | \\sum_\\nu c_\\nu \\chi_\\nu \\rangle = \\| \\sum_\\mu c_\\mu \\chi_\\mu \\|^2 \\ge 0$。矩阵 $S$ 是奇异的，当且仅当存在一个非零向量 $v$，使得 $v^{\\dagger} S v = 0$。这对应于基函数的某个线性组合为零函数，即 $\\sum_\\mu v_\\mu \\chi_\\mu = 0$。这意味着 $S$ 的至少一个本征值为零，而所有其他本征值均为正。\n\n我们现在来评估每个陈述。\n\n**A. 广义本征值问题 $F C = S C \\varepsilon$ 是不适定的，因为 $S$ 不可逆；在 $S$ 的非平凡零空间存在的情况下，系数向量不是唯一的，因为在系数向量中添加零空间中的任何分量，既不会改变原子轨道空间范数，也不会改变物理轨道。**\n\n这个陈述是正确的。\n1.  **$S$ 的不适定性和不可逆性**：右侧带有奇异矩阵 $S$ 的广义本征值问题确实是不适定的。标准的求解算法通常需要将问题转换为标准的本征值问题，这涉及到 $S$ 的逆矩阵或其平方根 $S^{-1/2}$。由于奇异矩阵是不可逆的，这些标准程序会失败。\n2.  **系数向量的唯一性**：设 $\\phi_i = \\sum_\\mu c_{i\\mu} \\chi_\\mu$ 是由系数向量 $c_i$ 描述的分子轨道 (MO)。设 $v$ 是 $S$ 零空间中的任意向量，根据定义，它对应于一个线性相关性 $\\sum_\\mu v_\\mu \\chi_\\mu = 0$。考虑一个新的系数向量 $c'_i = c_i + \\alpha v$，其中 $\\alpha$ 是某个标量。与 $c'_i$ 对应的物理轨道是 $\\phi'_i = \\sum_\\mu (c_{i\\mu} + \\alpha v_\\mu) \\chi_\\mu = \\sum_\\mu c_{i\\mu} \\chi_\\mu + \\alpha \\sum_\\mu v_\\mu \\chi_\\mu = \\phi_i + 0 = \\phi_i$。物理轨道保持不变。\n3.  **AO 空间范数的不变性**：一个 MO 系数向量的范数是相对于度规 $S$ 定义的，即 $\\|c_i\\|^2 = c_i^\\dagger S c_i$。对于新向量 $c'_i$，其范数为 $\\|c'_i\\|^2 = (c_i + \\alpha v)^\\dagger S (c_i + \\alpha v) = c_i^\\dagger S c_i + \\alpha c_i^\\dagger S v + \\alpha^* v^\\dagger S c_i + |\\alpha|^2 v^\\dagger S v$。由于 $v$ 在 $S$ 的零空间中，我们有 $Sv=0$，并且因为 $S$ 是厄米矩阵，所以 $v^\\dagger S = (Sv)^\\dagger = 0$。因此，$\\|c'_i\\|^2 = c_i^\\dagger S c_i = \\|c_i\\|^2$。范数也保持不变。\n\n不同的系数向量（$c_i$ 和 $c_i + \\alpha v$）映射到同一个物理对象（MO $\\phi_i$）并具有相同的范数，这一事实表明了表示中的冗余性。这种模糊性是不适定问题的标志。\n\n对 A 的判断：**正确**。\n\n**B. 当 $S$ 是奇异矩阵时，无法构建基于 $X = S^{-1/2}$ 的正则正交化；一个标准的补救方法是对角化 $S = U s U^{\\dagger}$，舍弃 $s_{ii}$ 低于某个数值阈值的本征向量，并仅使用保留的子空间来设置 $X = U_{r} s_{r}^{-1/2} U_{r}^{\\dagger}$，从而消除线性相关性。**\n\n这个陈述也是正确的。\n1.  **正则正交化的失败**：正则正交化过程使用变换矩阵 $X = S^{-1/2}$ 将基组变换为标准正交基。算符 $S^{-1/2}$ 仅对正定矩阵有良好定义。由于 $S$ 是奇异的，它不是正定的（它是半正定的），其逆矩阵 $S^{-1}$ 和平方根逆矩阵 $S^{-1/2}$ 都不存在。\n2.  **标准补救方法**：所述过程是量子化学程序中用于处理线性相关性的标准且最稳健的方法。\n    *   首先对半正定矩阵 $S$ 进行对角化：$S U = U s$，其中 $U$ 是本征向量构成的酉矩阵，$s$ 是非负本征值构成的对角矩阵。\n    *   $S$ 的奇异性表现为一个或多个零本征值。在数值实践中，低于某个阈值的本征值被视为零。\n    *   对应于这些近零本征值的本征向量张成了基组中线性相关的部分。这些向量被舍弃。\n    *   剩下的对应于显著本征值 ($s_r$) 的本征向量 ($U_r$) 被用来构造一个到一个更小的、非冗余的、标准正交基的变换。\n    *   虽然变换矩阵最常被构造成矩形矩阵 $X = U_r s_r^{-1/2}$，它将 N 维 AO 空间映射到 $N_r$ 维正交空间，但选项中给出的表达式 $X = U_r s_r^{-1/2} U_r^\\dagger$ 是 $S^{1/2}$ 的 Moore-Penrose 伪逆。该矩阵的作用是投影到非冗余子空间上，并且是解决该问题的有效程序的一部分。对整个策略的描述——对角化 $S$ 并移除有问题的子空间——是完全准确的，并代表了当前最先进的技术。\n\n对 B 的判断：**正确**。\n\n**C. 即使当 $S$ 是奇异矩阵时，执行 Cholesky 分解 $S = L L^{\\dagger}$ 也总能成功，因此可以安全地构建 $X = L^{-1}$ 来进行正交化，而无需修改基组。**\n\n这个陈述是不正确的。\nCholesky 分解 $S = L L^{\\dagger}$（其中 $L$ 是一个对角元为正的下三角矩阵）存在当且仅当 $S$ 是一个正定矩阵。对于一个半正定但奇异的矩阵 $S$，标准的 Cholesky 算法会失败。在分解过程中，它会需要对一个零或负数开平方，或者除以一个零对角元。具体来说，$L$ 的一个对角元将变为零，使得 $L$ 奇异，其逆矩阵 $L^{-1}$ 无定义。因此，人们无法“安全地构建 $X = L^{-1}$”。虽然存在适用于半正定矩阵的带主元选择的改进 Cholesky 算法，但它们不会产生一个与原始维度相同的可逆三角因子 $L$，并且基组必须被修改（即缩减），这与陈述相矛盾。\n\n对 C 的判断：**不正确**。\n\n**D. 用 $S + \\delta I$（其中 $\\delta  0$ 是一个小量）替换 $S$，能保证在 $\\delta \\to 0^{+}$ 的极限下保留 Hartree-Fock 驻点，同时保留完整基组，因此这是一种精确且通常首选的补救方法。**\n\n这个陈述是不正确的。\n这种技术被称为 Tikhonov 正则化。用 $S' = S + \\delta I$ 替换 $S$ 会使矩阵对于任何 $\\delta  0$ 都变为正定，因为 $S$ 的所有本征值 $\\lambda_i$ 都变成了 $\\lambda_i + \\delta  0$。这使得矩阵 $S'$ 可以求逆，从而使问题在数值上变得易于处理。然而，这种方法是一种近似，而不是“精确”的补救措施。它将标准正交性条件修改为 $C^\\dagger(S + \\delta I)C = I$，这与原始问题的约束条件 $C^\\dagger S C=I$ 在物理上是不同的。得到的波函数和能量将依赖于 $\\delta$。虽然可以研究 $\\delta \\to 0^+$ 的极限，但这个极限在数值上是不稳定的，因为问题会再次变得不适定。如果没有更复杂的处理，不能保证解会收敛到原始问题的正确物理驻点。选项 B 中描述的过程通常是首选，因为它在数值上是稳定的，并且对应于对数学冗余的精确移除。\n\n对 D 的判断：**不正确**。\n\n**E. 基组中的线性相关性意味着 $S$ 至少有一个负本征值，这违反了变分原理，并导致 Hartree-Fock 方法从根本上失败。**\n\n这个陈述是不正确的。\n如引言分析所示，重叠矩阵 $S$ 是半正定的。它的本征值必须是非负的 ($\\lambda_i \\ge 0$)。线性相关性意味着 $S$ 是奇异的，这意味着它必须至少有一个本征值恰好为零。这并不意味着存在负本征值。该陈述的前提在事实上是错误的。\n\n对 E 的判断：**不正确**。\n\n总之，陈述 A 和 B 正确地描述了问题的性质及其标准解决方法。", "answer": "$$\\boxed{AB}$$", "id": "2464743"}, {"introduction": "SCF方法的基本迭代方案可能会收敛缓慢甚至发生振荡。为了克服这一点，现代量子化学程序采用了先进的加速技术，其中迭代子空间直接求逆（DIIS）法是功能最强大和最流行的方法之一。这个高级练习[@problem_id:2643564]要求您推导DIIS的核心方程，应用约束优化方法，从先前的迭代中智能地外插出一个更好的Fock矩阵。", "problem": "在一个重叠矩阵为 $S$ 的非正交原子轨道基组中，关于分子轨道系数矩阵 $C$ 和对角轨道能矩阵 $\\varepsilon$ 的Hartree–Fock–Roothaan方程为 $F C = S C \\varepsilon$，且满足 $C^{\\top} S C = I$。设 $P_i$ 为自洽场（SCF）第 $i$ 次迭代时占据轨道的密度矩阵，$F_i$ 为相应的Fock矩阵。将第 $i$ 次迭代的对易子残差（误差）定义为 $e_i = F_i P_i S - S P_i F_i$。在自洽时，精确解满足 $e = 0$。\n\n迭代子空间直接求逆（DIIS）过程从一组 $m$ 个存储的对 $\\{(F_i, e_i)\\}$ 构建一个外推的Fock矩阵 $F^{\\ast} = \\sum_{i=1}^{m} c_i F_i$，其中系数 $\\{c_i\\}$ 的选择是为了最小化外推误差 $E = \\sum_{i=1}^{m} c_i e_i$ 的范数。在实数矩阵空间上采用弗罗贝尼乌斯内积 $\\langle A, B \\rangle = \\mathrm{Tr}(A^{\\top} B)$ 以及相应的弗罗贝尼乌斯范数 $\\|A\\|_{\\mathrm{F}}^{2} = \\langle A, A \\rangle$。施加仿射约束 $\\sum_{i=1}^{m} c_i = 1$。\n\n仅从广义Roothaan方程、$e_i$ 的定义以及所述的内积出发，推导在约束 $\\sum_{i=1}^{m} c_i = 1$ 下最小化 $\\|E\\|_{\\mathrm{F}}^{2}$ 的优化器所满足的条件，并写出关于系数 $\\{c_i\\}$ 和拉格朗日乘子的最终线性系统，以及 $F^{\\ast}$ 的表达式。下面哪个选项正确地给出了这个系统和用元素为 $B_{ij} = \\langle e_i, e_j \\rangle$ 的矩阵 $B$ 表示的外推Fock矩阵？\n\nA. 使用 $B_{ij} = \\mathrm{Tr}(e_i^{\\top} e_j)$。求解\n$$\n\\begin{bmatrix}\nB  \\mathbf{1} \\\\\n\\mathbf{1}^{\\top}  0\n\\end{bmatrix}\n\\begin{bmatrix}\n\\mathbf{c} \\\\\n\\lambda\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\mathbf{0} \\\\\n1\n\\end{bmatrix},\n$$\n其中 $\\mathbf{c} = (c_1,\\dots,c_m)^{\\top}$，$\\mathbf{1}$ 是 $m$ 个分量全为 $1$ 的向量，并设 $F^{\\ast} = \\sum_{i=1}^{m} c_i F_i$。\n\nB. 使用 $B_{ij} = \\mathrm{Tr}(e_i^{\\top} e_j)$。求解无约束的正规方程 $B\\,\\mathbf{c} = \\mathbf{0}$，然后将 $\\mathbf{c}$除以 $\\sum_{i=1}^{m} c_i$ 进行归一化以强制满足 $\\sum_{i=1}^{m} c_i = 1$，最后设 $F^{\\ast} = \\sum_{i=1}^{m} c_i F_i$。\n\nC. 定义密度残差 $d_i = P_i^2 - P_i$ 和 $B_{ij} = \\mathrm{Tr}(d_i^{\\top} d_j)$。求解\n$$\n\\begin{bmatrix}\nB  \\mathbf{1} \\\\\n\\mathbf{1}^{\\top}  0\n\\end{bmatrix}\n\\begin{bmatrix}\n\\mathbf{c} \\\\\n\\lambda\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\mathbf{0} \\\\\n1\n\\end{bmatrix},\n$$\n并取 $F^{\\ast} = \\sum_{i=1}^{m} c_i P_i$。\n\nD. 使用 $S$ 加权度量 $B_{ij} = \\mathrm{Tr}(e_i^{\\top} S\\, e_j\\, S)$ 并求解\n$$\n\\begin{bmatrix}\nB  \\mathbf{1} \\\\\n\\mathbf{1}^{\\top}  0\n\\end{bmatrix}\n\\begin{bmatrix}\n\\mathbf{c} \\\\\n\\lambda\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\mathbf{0} \\\\\n1\n\\end{bmatrix},\n$$\n其中 $F^{\\ast} = \\sum_{i=1}^{m} c_i F_i$。", "solution": "对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n-   Hartree–Fock–Roothaan方程：$F C = S C \\varepsilon$\n-   分子轨道系数矩阵：$C$\n-   对角轨道能矩阵：$\\varepsilon$\n-   重叠矩阵：$S$\n-   正交归一化条件：$C^{\\top} S C = I$\n-   第 $i$ 次迭代的密度矩阵：$P_i$\n-   第 $i$ 次迭代的Fock矩阵：$F_i$\n-   第 $i$ 次迭代的对易子残差（误差）：$e_i = F_i P_i S - S P_i F_i$\n-   收敛条件：$e = 0$\n-   DIIS外推Fock矩阵：$F^{\\ast} = \\sum_{i=1}^{m} c_i F_i$\n-   DIIS外推误差：$E = \\sum_{i=1}^{m} c_i e_i$\n-   最小化目标：最小化外推误差的范数，$\\|E\\|_{\\mathrm{F}}^{2}$\n-   实数矩阵 $A, B$ 的内积：$\\langle A, B \\rangle = \\mathrm{Tr}(A^{\\top} B)$\n-   弗罗贝尼乌斯范数：$\\|A\\|_{\\mathrm{F}}^{2} = \\langle A, A \\rangle$\n-   系数的仿射约束：$\\sum_{i=1}^{m} c_i = 1$\n-   矩阵 $B$ 的定义：$B_{ij} = \\langle e_i, e_j \\rangle$\n\n### 步骤2：使用已知条件进行验证\n该问题描述了迭代子空间直接求逆（DIIS）方法，这是自洽场（SCF）计算中一种广泛使用且稳健的收敛加速技术。\n-   **科学基础：** 该表述是量子化学中的标准形式。广义本征值问题 $F C = S C \\varepsilon$ 是非正交基组下Hartree-Fock-Roothaan方程的正确形式。误差向量定义 $e_i = F_i P_i S - S P_i F_i$ 是一个有效的残差选择，因为该量在自洽时为零。DIIS方法旨在寻求先前Fock矩阵的线性组合，以最小化相应误差向量线性组合的范数，并受系数的归一化约束。这是一个公认的程序。\n-   **适定性：** 该问题是一个约束二次最小化问题，在数学上是适定的。给定一组线性无关的误差向量 $\\{e_i\\}$，得到的格拉姆矩阵 $B$ 是正定的，关于系数 $\\{c_i\\}$ 和拉格朗日乘子的线性系统有唯一解。\n-   **目标：** 问题陈述使用了精确的数学和化学术语，没有歧义。\n\n### 步骤3：结论与行动\n问题陈述有效。这是理论化学中的一个标准推导。我将继续进行求解。\n\n### 推导\n\n目标是找到系数 $\\{c_i\\}_{i=1}^m$，在约束 $\\sum_{i=1}^{m} c_i = 1$ 下，最小化外推误差的弗罗贝尼乌斯范数平方 $\\|E\\|_{\\mathrm{F}}^{2}$。\n\n外推误差为 $E = \\sum_{i=1}^{m} c_i e_i$。其范数平方为：\n$$\n\\|E\\|_{\\mathrm{F}}^{2} = \\langle E, E \\rangle = \\left\\langle \\sum_{i=1}^{m} c_i e_i, \\sum_{j=1}^{m} c_j e_j \\right\\rangle\n$$\n利用内积的线性性质，我们展开此表达式：\n$$\n\\|E\\|_{\\mathrm{F}}^{2} = \\sum_{i=1}^{m} \\sum_{j=1}^{m} c_i c_j \\langle e_i, e_j \\rangle\n$$\n问题定义了矩阵 $B$ 的元素为 $B_{ij} = \\langle e_i, e_j \\rangle$。范数平方的表达式可以写成矩阵形式：\n$$\n\\|E\\|_{\\mathrm{F}}^{2} = \\mathbf{c}^{\\top} B \\mathbf{c}\n$$\n其中 $\\mathbf{c} = (c_1, c_2, \\dots, c_m)^{\\top}$ 是系数的列向量。\n\n最小化是在仿射约束下进行的：\n$$\n\\sum_{i=1}^{m} c_i = 1\n$$\n在向量表示法中，这是 $\\mathbf{1}^{\\top} \\mathbf{c} = 1$，其中 $\\mathbf{1}$ 是一个所有 $m$ 个元素都等于 $1$ 的列向量。\n\n这是一个约束优化问题。我们使用拉格朗日乘子法。我们构造拉格朗日函数 $\\mathcal{L}$，并寻求其驻点。为了与选项中的形式匹配，我们将拉格朗日函数定义为：\n$$\n\\mathcal{L}(\\mathbf{c}, \\lambda) = \\frac{1}{2} \\mathbf{c}^{\\top} B \\mathbf{c} + \\lambda \\left(\\mathbf{1}^{\\top} \\mathbf{c} - 1\\right)\n$$\n请注意，最小化 $\\mathbf{c}^{\\top} B \\mathbf{c}$ 等价于最小化 $\\frac{1}{2}\\mathbf{c}^{\\top} B \\mathbf{c}$。因子 $\\frac{1}{2}$ 简化了求导。变量 $\\lambda$ 是一个拉格朗日乘子。\n\n为了找到最小值，我们将 $\\mathcal{L}$ 关于 $\\mathbf{c}$ 的梯度和关于 $\\lambda$ 的导数设为零。\n关于向量 $\\mathbf{c}$ 的梯度为：\n$$\n\\nabla_{\\mathbf{c}} \\mathcal{L} = \\frac{\\partial}{\\partial \\mathbf{c}} \\left(\\frac{1}{2} \\mathbf{c}^{\\top} B \\mathbf{c} + \\lambda (\\mathbf{1}^{\\top} \\mathbf{c} - 1)\\right) = B \\mathbf{c} + \\lambda \\mathbf{1}\n$$\n（这里我们利用了 $B$ 是对称的这一事实，因为 $\\langle e_i, e_j \\rangle = \\langle e_j, e_i \\rangle$）。\n将梯度设为零，得到第一个条件：\n$$\nB \\mathbf{c} + \\lambda \\mathbf{1} = \\mathbf{0}\n$$\n关于 $\\lambda$ 的导数为：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\lambda} = \\mathbf{1}^{\\top} \\mathbf{c} - 1\n$$\n将其设为零，得到第二个条件，即原始约束：\n$$\n\\mathbf{1}^{\\top} \\mathbf{c} = 1\n$$\n现在我们得到了一个关于 $m$ 个系数 $c_i$ 和拉格朗日乘子 $\\lambda$ 的 $m+1$ 个线性方程组。我们可以将该方程组写成一个单一的分块矩阵方程。未知数是向量 $\\mathbf{c}$ 和标量 $\\lambda$。设未知向量为 $\\begin{bmatrix} \\mathbf{c} \\\\ \\lambda \\end{bmatrix}$。\n\n第一个方程 $B \\mathbf{c} + \\lambda \\mathbf{1} = \\mathbf{0}$ 可写作 $[B \\quad \\mathbf{1}] \\begin{bmatrix} \\mathbf{c} \\\\ \\lambda \\end{bmatrix} = \\mathbf{0}$。\n第二个方程 $\\mathbf{1}^{\\top} \\mathbf{c} = 1$ 可写作 $[\\mathbf{1}^{\\top} \\quad 0] \\begin{bmatrix} \\mathbf{c} \\\\ \\lambda \\end{bmatrix} = 1$。\n\n将这两个方程组合起来，得到分块矩阵系统：\n$$\n\\begin{bmatrix}\nB  \\mathbf{1} \\\\\n\\mathbf{1}^{\\top}  0\n\\end{bmatrix}\n\\begin{bmatrix}\n\\mathbf{c} \\\\\n\\lambda\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\mathbf{0} \\\\\n1\n\\end{bmatrix}\n$$\n求解该系统即可得到所需的系数 $\\mathbf{c}$。然后构造外推的Fock矩阵 $F^{\\ast} = \\sum_{i=1}^{m} c_i F_i$。\n\n### 逐项分析\n\n**A. 使用 $B_{ij} = \\mathrm{Tr}(e_i^{\\top} e_j)$。求解\n$$\n\\begin{bmatrix}\nB  \\mathbf{1} \\\\\n\\mathbf{1}^{\\top}  0\n\\end{bmatrix}\n\\begin{bmatrix}\n\\mathbf{c} \\\\\n\\lambda\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\mathbf{0} \\\\\n1\n\\end{bmatrix},\n$$\n其中 $\\mathbf{c} = (c_1,\\dots,c_m)^{\\top}$，$\\mathbf{1}$ 是 $m$ 个分量全为 $1$ 的向量，并设 $F^{\\ast} = \\sum_{i=1}^{m} c_i F_i$。**\n\n此选项正确地使用指定的弗罗贝尼乌斯内积构建了矩阵 $B$，因为 $B_{ij} = \\langle e_i, e_j \\rangle = \\mathrm{Tr}(e_i^{\\top} e_j)$。所呈现的线性系统与上面从约束最小化原理推导出的系统完全相同。外推Fock矩阵 $F^{\\ast}$ 的表达式也符合问题定义。\n**结论：正确。**\n\n**B. 使用 $B_{ij} = \\mathrm{Tr}(e_i^{\\top} e_j)$。求解无约束的正规方程 $B\\,\\mathbf{c} = \\mathbf{0}$，然后将 $\\mathbf{c}$除以 $\\sum_{i=1}^{m} c_i$ 进行归一化以强制满足 $\\sum_{i=1}^{m} c_i = 1$，最后设 $F^{\\ast} = \\sum_{i=1}^{m} c_i F_i$。**\n\n这个过程是有缺陷的。它试图通过将 $\\|E\\|_{\\mathrm{F}}^{2}$ 的梯度设为零（即 $2B\\mathbf{c}=\\mathbf{0}$）来找到无约束最小化问题的解。这是在寻找一个使误差向量的线性组合恰好为零的解，而这通常是不可能的。如果矩阵 $B$ 是非奇异的，唯一的解是平凡解 $\\mathbf{c} = \\mathbf{0}$，这违反了约束 $\\sum c_i = 1$。如果 $B$ 是奇异的，可能存在非平凡解，但随后的归一化是一种临时凑合的程序，并不对应于原始约束最小化问题的解。约束必须通过拉格朗日乘子法在优化过程中引入，而不是在之后强制执行。\n**结论：不正确。**\n\n**C. 定义密度残差 $d_i = P_i^2 - P_i$ 和 $B_{ij} = \\mathrm{Tr}(d_i^{\\top} d_j)$。求解\n$$\n\\begin{bmatrix}\nB  \\mathbf{1} \\\\\n\\mathbf{1}^{\\top}  0\n\\end{bmatrix}\n\\begin{bmatrix}\n\\mathbf{c} \\\\\n\\lambda\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\mathbf{0} \\\\\n1\n\\end{bmatrix},\n$$\n并取 $F^{\\ast} = \\sum_{i=1}^{m} c_i P_i$。**\n\n此选项在两个根本方面偏离了问题陈述。首先，它使用密度矩阵的幂等性 $d_i = P_i^2 - P_i$ 来定义误差向量，而问题明确定义误差为 $e_i = F_i P_i S - S P_i F_i$。其次，它试图外推密度矩阵（$F^{\\ast} = \\sum c_i P_i$），而问题将DIIS过程定义为Fock矩阵的外推（$F^{\\ast} = \\sum c_i F_i$）。这两处改动都与给定的前提相矛盾。\n**结论：不正确。**\n\n**D. 使用 $S$ 加权度量 $B_{ij} = \\mathrm{Tr}(e_i^{\\top} S\\, e_j\\, S)$ 并求解\n$$\n\\begin{bmatrix}\nB  \\mathbf{1} \\\\\n\\mathbf{1}^{\\top}  0\n\\end{bmatrix}\n\\begin{bmatrix}\n\\mathbf{c} \\\\\n\\lambda\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\mathbf{0} \\\\\n1\n\\end{bmatrix},\n$$\n其中 $F^{\\ast} = \\sum_{i=1}^{m} c_i F_i$。**\n\n此选项提出了一个不同的内积，一个由重叠矩阵 $S$ 加权的度量。然而，问题陈述是明确的：“采用弗罗贝尼乌斯内积 $\\langle A, B \\rangle = \\mathrm{Tr}(A^{\\top} B)$”。这规定了 $B_{ij}$ 必须是 $\\langle e_i, e_j \\rangle = \\mathrm{Tr}(e_i^{\\top} e_j)$。使用一个替代的度量，无论它在其他情况下可能多么有效，都与问题的明确指令相矛盾。\n**结论：不正确。**", "answer": "$$\\boxed{A}$$", "id": "2643564"}]}