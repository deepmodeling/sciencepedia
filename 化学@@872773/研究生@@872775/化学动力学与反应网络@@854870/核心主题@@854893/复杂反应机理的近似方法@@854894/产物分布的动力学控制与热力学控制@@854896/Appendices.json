{"hands_on_practices": [{"introduction": "我们的实践探索始于最基本的竞争反应体系：平行的不可逆一级反应。通过从基本原理出发，严格推导产物浓度随时间变化的精确表达式，我们将揭示一个关于动力学控制的核心法则。这项练习旨在巩固您对反应速率积分定律的掌握，并阐明在纯动力学控制条件下，产物选择性是如何由反应速率常数的比率唯一决定的 [@problem_id:2650595]。", "problem": "考虑一个等温、恒容的间歇式反应器，其中单一反应物 $A$ 发生两个平行的、基元的、不可逆的一级反应，生成产物 $P_{1}$ 和 $P_{2}$：\n$$A \\xrightarrow{k_{1}} P_{1}, \\quad A \\xrightarrow{k_{2}} P_{2}.$$\n假设质量作用定律成立，速率常数 $k_{1}$ 和 $k_{2}$ 与时间无关，并且没有其他反应或传输过程。在时间 $t=0$ 时，初始浓度满足 $[A](0)=A_{0}$ 和 $[P_{1}](0)=[P_{2}](0)=0$。在间歇条件下，随着反应的进行，$A$ 会发生有限消耗。\n\n仅使用基本动力学原理（质量作用定律、一级速率定律的定义和守恒定律），推导 $[P_{1}](t)$ 和 $[P_{2}](t)$ 的精确表达式，这些表达式要完全包含 $A$ 的有限消耗。然后，将随时间变化的选择性定义为\n$$S(t) \\equiv \\frac{[P_{1}](t)}{[P_{2}](t)}.$$\n将最终的选择性 $S(t)$ 表示为包含 $k_{1}$、$k_{2}$、$A_{0}$ 和 $t$ 的闭式解析表达式。无需进行数值计算。选择性是无量纲的；报告表达式时无需带单位。你的最终答案必须是单个解析表达式（而不是方程或不等式）。", "solution": "在尝试任何解答之前，对问题陈述进行验证。\n\n**步骤 1：提取已知条件**\n- 反应方案：$A \\xrightarrow{k_{1}} P_{1}$, $A \\xrightarrow{k_{2}} P_{2}$。\n- 系统条件：等温、恒容的间歇式反应器。\n- 反应动力学：反应是平行的、基元的、不可逆的、一级反应。\n- 基本假设：质量作用定律有效。速率常数 $k_{1}$ 和 $k_{2}$ 与时间无关。没有其他反应或传输过程发生。\n- 初始条件：在时间 $t=0$ 时，浓度为 $[A](0)=A_{0}$，$[P_{1}](0)=0$ 和 $[P_{2}](0)=0$。\n- 过程约束：反应物 $A$ 发生有限消耗。\n- 提供的定义：随时间变化的选择性为 $S(t) \\equiv \\frac{[P_{1}](t)}{[P_{2}](t)}$。\n- 目标：推导 $[P_{1}](t)$ 和 $[P_{2}](t)$ 的表达式，并随后推导 $S(t)$ 关于 $k_{1}$、$k_{2}$、$A_{0}$ 和 $t$ 的闭式表达式。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题陈述清晰且科学上合理。它描述了平行反应动力学的一个典型例子，这是化学反应工程和物理化学中的一个基本概念。该系统由一组具有指定初始条件的线性常微分方程描述，这保证了其解的唯一性和稳定性。所有术语都有明确的定义，前提条件自洽且基于已确立的化学原理。该问题并非无足轻重，因为它要求从第一性原理推导积分速率定律。\n\n**步骤 3：结论与行动**\n该问题被判定为有效。现在将给出解的严格推导过程。\n\n每种物质浓度的变化率由根据质量作用定律推导出的微分方程描述。由于物质 $A$ 在两个平行的一级反应中被消耗，其消失速率是两个途径速率的总和：\n$$ -\\frac{d[A]}{dt} = k_{1}[A] + k_{2}[A] = (k_{1} + k_{2})[A] $$\n这是一个可分离的一阶线性常微分方程。我们通过从 $t=0$ 时的初始条件 $[A](0) = A_{0}$ 到时间 $t$ 时的 $[A](t)$ 进行积分来求解它。\n$$ \\int_{A_{0}}^{[A](t)} \\frac{d[A]}{[A]} = - \\int_{0}^{t} (k_{1} + k_{2}) dt' $$\n积分得到：\n$$ \\ln([A](t)) - \\ln(A_{0}) = -(k_{1} + k_{2})t $$\n$$ \\ln\\left(\\frac{[A](t)}{A_{0}}\\right) = -(k_{1} + k_{2})t $$\n对两边取指数，得到 $A$ 的浓度随时间变化的函数，这恰当地包含了其有限消耗：\n$$ [A](t) = A_{0} \\exp(-(k_{1} + k_{2})t) $$\n接下来，我们写出产物 $P_{1}$ 和 $P_{2}$ 生成的速率定律：\n$$ \\frac{d[P_{1}]}{dt} = k_{1}[A] $$\n$$ \\frac{d[P_{2}]}{dt} = k_{2}[A] $$\n为了求得 $[P_{1}](t)$，我们将 $[A](t)$ 的表达式代入其速率方程：\n$$ \\frac{d[P_{1}]}{dt} = k_{1} A_{0} \\exp(-(k_{1} + k_{2})t) $$\n然后我们从 $t=0$ 时的初始条件 $[P_{1}](0) = 0$ 开始对该方程进行积分：\n$$ \\int_{0}^{[P_{1}](t)} d[P_{1}] = \\int_{0}^{t} k_{1} A_{0} \\exp(-(k_{1} + k_{2})t') dt' $$\n$$ [P_{1}](t) = k_{1} A_{0} \\left[ \\frac{\\exp(-(k_{1} + k_{2})t')}{-(k_{1} + k_{2})} \\right]_{0}^{t} $$\n$$ [P_{1}](t) = -\\frac{k_{1} A_{0}}{k_{1} + k_{2}} \\left( \\exp(-(k_{1} + k_{2})t) - 1 \\right) $$\n$$ [P_{1}](t) = \\frac{k_{1} A_{0}}{k_{1} + k_{2}} \\left( 1 - \\exp(-(k_{1} + k_{2})t) \\right) $$\n$[P_{2}](t)$ 的推导形式上是相同的，只需将 $k_{1}$ 替换为 $k_{2}$：\n$$ [P_{2}](t) = \\frac{k_{2} A_{0}}{k_{1} + k_{2}} \\left( 1 - \\exp(-(k_{1} + k_{2})t) \\right) $$\n推导出 $[P_{1}](t)$ 和 $[P_{2}](t)$ 的精确表达式后，我们现在可以计算问题中定义的选择性 $S(t)$。\n$$ S(t) = \\frac{[P_{1}](t)}{[P_{2}](t)} = \\frac{\\frac{k_{1} A_{0}}{k_{1} + k_{2}} \\left( 1 - \\exp(-(k_{1} + k_{2})t) \\right)}{\\frac{k_{2} A_{0}}{k_{1} + k_{2}} \\left( 1 - \\exp(-(k_{1} + k_{2})t) \\right)} $$\n假设反应进行（即至少一个速率常数不为零）且 $t > 0$，则项 $\\left( 1 - \\exp(-(k_{1} + k_{2})t) \\right)$ 不为零。这一项和前置因子 $\\frac{A_{0}}{k_{1} + k_{2}}$ 在分子和分母中都被消去。这得出了一个非常简单的结果：\n$$ S(t) = \\frac{k_{1}}{k_{2}} $$\n这个结果展示了平行反应动力学的一个基本原理：对于相同级数的反应，选择性在整个反应过程中是恒定的，并且仅由反应速率常数的比值决定。它与时间 $t$ 和初始反应物浓度 $A_{0}$ 无关。尽管问题要求用 $k_{1}$、$k_{2}$、$A_{0}$ 和 $t$ 来表示解，但正确的推导表明它对 $A_{0}$ 和 $t$ 的依赖性是不存在的。", "answer": "$$\n\\boxed{\\frac{k_{1}}{k_{2}}}\n$$", "id": "2650595"}, {"introduction": "在掌握了基本的动力学控制原理后，我们来挑战一个更复杂、也更接近真实化学情景的难题。许多化学网络包含可逆步骤和快速平衡的中间体，这使得简单的动力学预测可能失效。本练习 [@problem_id:2650601] 构建了一个精巧的反应网络，其中尽管通往某一产物的能垒更低，但体系最终却由热力学控制。通过分析此案例，您将深刻理解可逆性与“隐藏”的反应循环如何使系统能够“纠正”最初的动力学选择，最终达到全局热力学平衡。", "problem": "一个温度为 $T=298\\,\\mathrm{K}$ 的封闭、等温间歇式反应器在时间 $t=0$ 时仅含有可异构化的底物 $A$。以下反应网络由一种守恒的催化剂催化，该催化剂不改变化学计量，为清晰起见在记号中省略。所有步骤均为基元反应且可逆，遵循质量作用动力学和微观可逆性（细致平衡）。假设为理想溶液，因此活度等于浓度。\n\n该反应网络为\n$$\nA \\;\\rightleftharpoons\\; I \\;\\rightleftharpoons\\; J,\\qquad I \\;\\rightleftharpoons\\; P_1,\\qquad J \\;\\rightleftharpoons\\; P_2.\n$$\n\n在温度 $T$ 下的标准摩尔吉布斯自由能（每摩尔）为\n$$\nG^\\circ(A)=0\\,\\mathrm{kJ\\,mol^{-1}},\\quad G^\\circ(I)=+2.0\\,\\mathrm{kJ\\,mol^{-1}},\\quad G^\\circ(J)=+3.0\\,\\mathrm{kJ\\,mol^{-1}},\n$$\n$$\nG^\\circ(P_1)=-20.0\\,\\mathrm{kJ\\,mol^{-1}},\\quad G^\\circ(P_2)=-25.0\\,\\mathrm{kJ\\,mol^{-1}}.\n$$\n产物形成正向步骤的能垒使得\n$$\n\\Delta G^\\ddagger_{I\\to P_1}=60.0\\,\\mathrm{kJ\\,mol^{-1}},\\qquad \\Delta G^\\ddagger_{J\\to P_2}=80.0\\,\\mathrm{kJ\\,mol^{-1}},\n$$\n且逆向能垒满足细致平衡的约束，即\n$$\n\\Delta G^\\ddagger_{P_1\\to I}=\\Delta G^\\ddagger_{I\\to P_1}+\\bigl(G^\\circ(P_1)-G^\\circ(I)\\bigr),\\qquad\n\\Delta G^\\ddagger_{P_2\\to J}=\\Delta G^\\ddagger_{J\\to P_2}+\\bigl(G^\\circ(P_2)-G^\\circ(J)\\bigr).\n$$\n相互转化 $I\\rightleftharpoons J$ 的活化自由能很小（双向均 $10\\,\\mathrm{kJ\\,mol^{-1}}$），使其在所有可及的时间尺度上都远快于任一产物形成步骤。使用 $R=8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n\n一个仅考察从 $A$ 到各产物的正向能垒的朴素能垒高度判据会预测该反应受动力学控制且有利于 $P_1$，因为到 $P_1$ 的最低能量正向路径的最高能垒低于到 $P_2$ 的路径。然而，关于此反应网络的实验报告指出，经过足够长的时间后，观测到的产物比 $[P_2]/[P_1]$ 是一个常数，与初始条件和能垒大小无关（只要各步骤保持可逆），并且其数值与热力学预测相符。\n\n哪个选项最好地解释了该网络尽管到 $P_1$ 的正向能垒较低，却能产生热力学控制的产物分布的机理，并给出了长时间下 $[P_2]/[P_1]$ 的正确数值？\n\nA. 快速的 $I\\rightleftharpoons J$ 相互转化维持了一个准平衡的中间体流形，而 $I\\rightleftharpoons P_1$ 和 $J\\rightleftharpoons P_2$ 的可逆性创造了通过 $I$ 和 $J$ 连接 $P_1$ 和 $P_2$ 的隐藏循环。根据细致平衡，唯一的长时间稳态是 $\\{A,I,J,P_1,P_2\\}$ 上的全局热力学平衡，因此在 $T=298\\,\\mathrm{K}$ 时，$[P_2]/[P_1]=\\exp\\!\\bigl(-\\bigl(G^\\circ(P_2)-G^\\circ(P_1)\\bigr)/(RT)\\bigr)\\approx 7.5$。\n\nB. 产物分布由从 $A$ 到产物的最低正向能垒进行动力学控制，因此 $P_1$ 占主导，因为 $\\Delta G^\\ddagger_{I\\to P_1}  \\Delta G^\\ddagger_{J\\to P_2}$。一旦产物形成步骤成为速率决定步骤， $I$ 和 $J$ 之间的预平衡就与产物比无关。\n\nC. 长时间下的产物分布仅由预平衡 $I\\rightleftharpoons J$ 决定，得出 $[P_2]/[P_1]\\approx [J]/[I]$。因为 $G^\\circ(J)>G^\\circ(I)$，这预测了 $P_1$ 占主导。\n\nD. 因为 $G^\\circ(P_2)  G^\\circ(P_1)$ 并且网络是完全可逆的，所以该体系在 $t \\to 0^+$ 时立即受热力学控制，与能垒无关，产物比为无穷大。", "solution": "我们从适用于化学动力学和热力学的两个基本基础出发：(i) 基元反应的质量作用动力学，以及 (ii) 微观可逆性（细致平衡），它意味着在一个封闭、等温、理想的混合物达到平衡时，每个基元可逆反应的净通量为零，并且正向和逆向速率常数之比等于热力学平衡常数 $K^\\circ=\\exp(-\\Delta G^\\circ/RT)$，其中 $\\Delta G^\\circ$ 是标准吉布斯自由能变。等效地说，任何由可逆基元步骤组成的封闭网络都会演化到唯一的组成，该组成使总吉布斯自由能最小化，这与动力学能垒无关，前提是所有步骤在观测时间尺度上保持微观可逆。\n\n反应网络的结构和时间尺度。反应网络\n$$\nA \\;\\rightleftharpoons\\; I \\;\\rightleftharpoons\\; J,\\qquad I \\;\\rightleftharpoons\\; P_1,\\qquad J \\;\\rightleftharpoons\\; P_2\n$$\n是完全连通和可逆的。相互转化 $I\\rightleftharpoons J$ 很快（$\\Delta G^\\ddagger$ 很小），因此中间体池 $\\{I,J\\}$ 迅速达到并维持其自身之间以及与 $A$ 的准平衡。产物形成步骤较慢但可逆。因为 $P_1$ 和 $P_2$ 通过循环 $P_1\\rightleftharpoons I\\rightleftharpoons J\\rightleftharpoons P_2$ 连接，所以存在一个隐藏的催化循环，允许产物在中间体的介导下相互转化。只要所有步骤保持可逆，长时间极限就不是由能垒设定的动力学稳态，而是所有五种物质的热力学平衡。\n\n通过细致平衡计算热力学产物比。在平衡时，每个基元步骤的平衡常数满足\n$$\nK^\\circ_{X\\rightleftharpoons Y}=\\frac{[Y]_\\mathrm{eq}}{[X]_\\mathrm{eq}}=\\exp\\!\\left(-\\frac{G^\\circ(Y)-G^\\circ(X)}{RT}\\right).\n$$\n沿着路径 $P_1\\rightleftharpoons I\\rightleftharpoons J\\rightleftharpoons P_2$ 我们有\n$$\n\\frac{[P_2]_\\mathrm{eq}}{[P_1]_\\mathrm{eq}}=\\frac{[P_2]_\\mathrm{eq}}{[J]_\\mathrm{eq}}\\cdot\\frac{[J]_\\mathrm{eq}}{[I]_\\mathrm{eq}}\\cdot\\frac{[I]_\\mathrm{eq}}{[P_1]_\\mathrm{eq}}=K^\\circ_{J\\rightleftharpoons P_2}\\;K^\\circ_{I\\rightleftharpoons J}\\;K^\\circ_{P_1\\rightleftharpoons I}.\n$$\n使用 $K^\\circ_{X\\rightleftharpoons Y}=\\exp\\!\\bigl(-(G^\\circ(Y)-G^\\circ(X))/(RT)\\bigr)$ 并将标准自由能进行伸缩相加得到\n$$\n\\frac{[P_2]_\\mathrm{eq}}{[P_1]_\\mathrm{eq}}=\\exp\\!\\left(-\\frac{G^\\circ(P_2)-G^\\circ(P_1)}{RT}\\right).\n$$\n这个结果与活化能垒无关；它仅取决于标准态热力学以及可逆性和理想行为的假设。\n\n数值计算。已知 $G^\\circ(P_2)-G^\\circ(P_1)=(-25.0)-(-20.0)=-5.0\\,\\mathrm{kJ\\,mol^{-1}}=-5000\\,\\mathrm{J\\,mol^{-1}}$，$R=8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$，以及 $T=298\\,\\mathrm{K}$，\n$$\n\\frac{[P_2]_\\mathrm{eq}}{[P_1]_\\mathrm{eq}}=\\exp\\!\\left(-\\frac{-5000}{8.314\\times 298}\\right)=\\exp\\!\\left(\\frac{5000}{2477.6}\\right)\\approx \\exp(2.02)\\approx 7.5.\n$$\n机理诠释与朴素能垒高度推理的对比。朴素的能垒高度判据仅考察从 $A$ 到 $P_1$ 和从 $A$ 到 $P_2$ 的最低能量路径上的正向能垒，并得出结论：$P_1$ 是动力学产物，因为 $\\Delta G^\\ddagger_{I\\to P_1}  \\Delta G^\\ddagger_{J\\to P_2}$。如果产物形成步骤在观测时间尺度上实际上是不可逆的，或者如果产物没有途径重新进入一个已平衡的流形，那么这个结论才是相关的。然而，在这个反应网络中，$I\\rightleftharpoons P_1$ 和 $J\\rightleftharpoons P_2$ 都是可逆的，并且 $I\\rightleftharpoons J$ 非常快，所以任何形成的 $P_1$ 都可以返回到 $I$，与 $J$ 平衡，然后进行到 $P_2$，反之亦然。这些隐藏的循环消除了初始的动力学偏好，并驱动体系达到热力学产物比。因此，观测到的长时间分布是热力学控制的，尽管能垒高度表明在极短时间内是动力学控制的。\n\n逐项分析选项。\n\n- 选项 A: 该选项指出，快速的 $I\\rightleftharpoons J$ 相互转化维持了一个准平衡的中间体池，并且由于产物形成步骤是可逆的，存在通过 $I$ 和 $J$ 连接 $P_1$ 和 $P_2$ 的循环。它援引细致平衡得出结论，长时间状态是全局平衡，并给出 $[P_2]/[P_1]=\\exp\\!\\bigl(-(G^\\circ(P_2)-G^\\circ(P_1))/(RT)\\bigr)\\approx 7.5$，与上述推导相符。结论 — 正确。\n\n- 选项 B: 该选项断言由正向能垒决定的动力学控制，并忽略了平衡的作用。这与可逆性的存在以及将产物连接回中间体的隐藏循环相矛盾，这些循环确保了在长时间下体系会弛豫到热力学平衡。结论 — 错误。\n\n- 选项 C: 该选项声称长时间下的产物比等于预平衡比 $[J]/[I]$，而与产物步骤的可逆性无关。这只适用于不同的极限情况（例如，如果产物被不可逆地抽出且永不返回反应网络，并且产物形成速率常数相等），即便如此，Curtin–Hammett 原理也会使该比例取决于过渡态的自由能，而不仅仅是 $[J]/[I]$。在我们这个可逆网络中，长时间比率是热力学的，取决于 $G^\\circ(P_2)-G^\\circ(P_1)$，而不仅仅是 $G^\\circ(J)-G^\\circ(I)$。结论 — 错误。\n\n- 选项 D: 该选项声称在 $t\\to 0^+$ 时立即实现热力学控制，与能垒无关，并且比值为无穷大。即使在热力学控制的体系中，有限的速率也决定了向平衡的趋近过程；在极短的时间内，组成无法跳跃到其平衡值，而且比值肯定不是无穷大。结论 — 错误。", "answer": "$$\\boxed{A}$$", "id": "2650601"}, {"introduction": "从定性理解转向定量分析是科学研究深化的关键一步。本练习 [@problem_id:2650548] 将引导您使用灵敏度分析这一强大工具，来精确量化动力学与热力学因素对产物分布的控制程度。您将通过求解微分方程组，计算产物比例对反应能垒（动力学参数）和产物自由能（热力学参数）的偏导数。这项实践不仅能让您直观地“看到”控制机制如何随反应时间的推移而从动力学主导转变为热力学主导，还能培养您运用计算方法解决复杂动力学问题的核心能力。", "problem": "给定一个平行可逆反应网络，其中单一反应物通过不同通道生成两种产物。该网络定义如下：反应物 $A$ 通过通道 $1$ 与产物 $P_1$ 可逆地相互转化，并通过通道 $2$ 与产物 $P_2$ 可逆地相互转化。状态变量为浓度 $[A](t)$、$[P_1](t)$ 和 $[P_2](t)$，初始条件为 $[A](0) = A_0$、$[P_1](0) = 0$、$[P_2](0) = 0$。所有浓度必须以摩尔单位解释，但下面要求的最终输出是无量纲的或关于能量的导数，因此输出中无需浓度单位。动力学遵循质量作用动力学和用于速率常数的过渡态理论 (TST)。假设反应物参考自由能为 $G_A = 0$。\n\n需要使用的基本依据和定义：\n- 令 $T$ 为绝对温度，单位为开尔文。令 $k_B$ 表示玻尔兹曼常数， $h$ 表示普朗克常数。艾林前置因子为 $k_0 = \\kappa \\, (k_B T / h)$，其中透射系数 $\\kappa = 1$。\n- 令 $R$ 表示摩尔气体常数。逆热能为 $\\beta = 1/(R T)$。您必须通过使用单位为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$ 的 $R$ 和单位为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 的所有自由能来保持单位一致。\n- 对于每个通道 $i \\in \\{1,2\\}$，令正向活化自由能为 $\\Delta G_i^\\ddagger$，产物标准自由能为 $G_{P_i}$，所有能量均相对于 $G_A = 0$ 测量。TST 正向和逆向速率常数为\n$$\nk_{f,i} = k_0 \\exp\\!\\left(-\\beta \\, \\Delta G_i^\\ddagger\\right), \\qquad\nk_{r,i} = k_0 \\exp\\!\\left(-\\beta \\, (\\Delta G_i^\\ddagger - G_{P_i})\\right).\n$$\n- 在质量作用动力学下，浓度的常微分方程 (ODEs) 为\n$$\n\\frac{d}{dt}\n\\begin{bmatrix}\n[A] \\\\\n[P_1] \\\\\n[P_2]\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n-(k_{f,1}+k_{f,2})[A] + k_{r,1}[P_1] + k_{r,2}[P_2] \\\\\nk_{f,1}[A] - k_{r,1}[P_1] \\\\\nk_{f,2}[A] - k_{r,2}[P_2]\n\\end{bmatrix}.\n$$\n\n定义 $P_1$ 的终末时间产物分数为\n$$\nf_1(t_f) = \\frac{[P_1](t_f)}{[P_1](t_f) + [P_2](t_f)}.\n$$\n您必须对 $f_1(t_f)$ 相对于动力学“杠杆” $\\Delta G_1^\\ddagger$、$\\Delta G_2^\\ddagger$ 和热力学“杠杆” $G_{P_1}$、$G_{P_2}$ 进行局部（无穷小）灵敏度分析。具体来说，计算偏导数\n$$\n\\left[\\frac{\\partial f_1}{\\partial \\Delta G_1^\\ddagger},\\;\\frac{\\partial f_1}{\\partial \\Delta G_2^\\ddagger},\\;\\frac{\\partial f_1}{\\partial G_{P_1}},\\;\\frac{\\partial f_1}{\\partial G_{P_2}}\\right]_{t=t_f},\n$$\n在指定的基线参数集下求值。这些导数必须以实数形式报告，单位为每 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$（即无量纲量相对于以 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 为单位的能量的导数）。使用一致的单位制，能量单位为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$，温度单位为 $\\mathrm{K}$，时间单位为 $\\mathrm{s}$，并使用下面提供的气体常数 $R$。\n\n您的程序必须：\n- 从上述带有 TST 速率常数的 ODEs 出发，从给定的基本依据开始，使用一种与 ODE 系统解对参数求导相一致的系统性方法来计算灵敏度。不要假设任何预先简化的 $f_1(t)$ 公式。\n- 为了可复现性，请使用以下物理常数作为精确数值：$k_B = 1.380649 \\times 10^{-23}\\,\\mathrm{J}\\,\\mathrm{K}^{-1}$，$h = 6.62607015 \\times 10^{-34}\\,\\mathrm{J}\\,\\mathrm{s}$，$R = 8.314462618 \\times 10^{-3}\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$，以及 $\\kappa = 1$。\n- 使用初始浓度 $A_0 = 1.0$（单位为 $\\mathrm{mol}\\,\\mathrm{L}^{-1}$），且 $[P_1](0) = 0$ 和 $[P_2](0) = 0$。\n- 对于每个测试用例，在给定基线参数的情况下，计算在指定 $t_f$ 处的灵敏度向量。\n\n测试套件：\n为以下四个测试用例提供结果，每个用例指定为 $(T,\\; t_f,\\; \\Delta G_1^\\ddagger,\\; \\Delta G_2^\\ddagger,\\; G_{P_1},\\; G_{P_2})$，其中能量单位为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$，温度单位为 $\\mathrm{K}$，时间单位为 $\\mathrm{s}$：\n1. 用例 K（早期动力学控制）：$(T = 298.15,\\; t_f = 1.0\\times 10^{-4},\\; \\Delta G_1^\\ddagger = 60.0,\\; \\Delta G_2^\\ddagger = 62.0,\\; G_{P_1} = -10.0,\\; G_{P_2} = -20.0)$。\n2. 用例 T（长时间热力学控制）：$(T = 298.15,\\; t_f = 100.0,\\; \\Delta G_1^\\ddagger = 60.0,\\; \\Delta G_2^\\ddagger = 62.0,\\; G_{P_1} = -10.0,\\; G_{P_2} = -20.0)$。\n3. 用例 S（对称通道）：$(T = 298.15,\\; t_f = 1.0,\\; \\Delta G_1^\\ddagger = 60.0,\\; \\Delta G_2^\\ddagger = 60.0,\\; G_{P_1} = -20.0,\\; G_{P_2} = -20.0)$。\n4. 用例 C（动力学与热力学竞争）：$(T = 298.15,\\; t_f = 0.1,\\; \\Delta G_1^\\ddagger = 58.0,\\; \\Delta G_2^\\ddagger = 66.0,\\; G_{P_1} = -5.0,\\; G_{P_2} = -30.0)$。\n\n不涉及角度单位。所有输出都将是数值浮点数。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个由四个列表组成的逗号分隔列表，每个内部列表按上述顺序对应一个测试用例。每个内部列表必须按 $\\left[\\frac{\\partial f_1}{\\partial \\Delta G_1^\\ddagger},\\;\\frac{\\partial f_1}{\\partial \\Delta G_2^\\ddagger},\\;\\frac{\\partial f_1}{\\partial G_{P_1}},\\;\\frac{\\partial f_1}{\\partial G_{P_2}}\\right]$ 的顺序包含四个灵敏度。将每个浮点数四舍五入到六位小数。例如：$[[x_1,x_2,x_3,x_4],[y_1,y_2,y_3,y_4],[z_1,z_2,z_3,z_4],[w_1,w_2,w_3,w_4]]$。", "solution": "所提出的问题是一个适定且科学合理的化学动力学练习，特别关注产物分布相对于潜在热力学和动力学参数的灵敏度分析。它基于质量作用动力学和过渡态理论的基本原理，并包含了获得唯一解所需的所有信息。因此，不仅可能，而且需要一个严谨的解。\n\n任务是计算终末时间产物分数 $f_1(t_f)$ 相对于四个能量参数的局部灵敏度：正向活化自由能 $\\Delta G_1^\\ddagger$ 和 $\\Delta G_2^\\ddagger$，以及产物标准自由能 $G_{P_1}$ 和 $G_{P_2}$。这些灵敏度是 $f_1(t_f)$ 对这些参数的偏导数，在给定的基线值集合下进行求值。\n\n完成此任务的系统性方法是对基础的常微分方程 (ODEs) 系统进行前向灵敏度分析。设浓度状态向量为 $\\mathbf{y}(t) = [[A](t), [P_1](t), [P_2](t)]^T$，为方便起见，我们记 $y_1(t) = [A](t)$，$y_2(t) = [P_1](t)$，$y_3(t) = [P_2](t)$。设参数向量为 $\\boldsymbol{\\lambda} = [\\lambda_1, \\lambda_2, \\lambda_3, \\lambda_4]^T = [\\Delta G_1^\\ddagger, \\Delta G_2^\\ddagger, G_{P_1}, G_{P_2}]^T$。\n\n系统的动力学由一组线性一阶 ODE 描述：\n$$\n\\frac{d\\mathbf{y}}{dt} = \\mathbf{F}(\\mathbf{y}, \\boldsymbol{\\lambda}) = \\mathbf{K}(\\boldsymbol{\\lambda}) \\mathbf{y}(t)\n$$\n初始条件为 $\\mathbf{y}(0) = [A_0, 0, 0]^T$。矩阵 $\\mathbf{K}(\\boldsymbol{\\lambda})$ 包含速率常数，这些常数依赖于参数 $\\boldsymbol{\\lambda}$：\n$$\n\\mathbf{K}(\\boldsymbol{\\lambda}) =\n\\begin{bmatrix}\n-(k_{f,1}+k_{f,2})  k_{r,1}  k_{r,2} \\\\\nk_{f,1}  -k_{r,1}  0 \\\\\nk_{f,2}  0  -k_{r,2}\n\\end{bmatrix}\n$$\n速率常数 $k_{f,i}$ 和 $k_{r,i}$ 由过渡态理论表达式给出：\n$$\nk_{f,i} = k_0 \\exp(-\\beta \\Delta G_i^\\ddagger), \\quad k_{r,i} = k_0 \\exp(-\\beta (\\Delta G_i^\\ddagger - G_{P_i}))\n$$\n对于通道 $i=1,2$。\n\n目标函数是在终末时间 $t_f$ 时 $P_1$ 的产物分数：\n$$\nf_1(t_f) = \\frac{y_2(t_f)}{y_2(t_f) + y_3(t_f)}\n$$\n它关于参数 $\\lambda_j$ 的导数通过链式法则求得：\n$$\n\\frac{\\partial f_1}{\\partial \\lambda_j} = \\frac{\\partial f_1}{\\partial y_2} \\frac{\\partial y_2}{\\partial \\lambda_j} + \\frac{\\partial f_1}{\\partial y_3} \\frac{\\partial y_3}{\\partial \\lambda_j}\n$$\n其中所有项都在 $t=t_f$ 时求值。$f_1$ 关于状态变量的偏导数为：\n$$\n\\frac{\\partial f_1}{\\partial y_2} = \\frac{y_3}{(y_2 + y_3)^2}, \\quad \\frac{\\partial f_1}{\\partial y_3} = \\frac{-y_2}{(y_2 + y_3)^2}\n$$\n项 $\\frac{\\partial y_i}{\\partial \\lambda_j}$ 是状态灵敏度。令 $\\mathbf{S}_j(t) = \\frac{\\partial \\mathbf{y}(t)}{\\partial \\lambda_j}$ 为参数 $\\lambda_j$ 的灵敏度向量。为求得 $\\mathbf{S}_j(t)$，我们将原始 ODE 系统对 $\\lambda_j$ 求导：\n$$\n\\frac{d}{dt} \\mathbf{S}_j(t) = \\frac{d}{dt}\\left(\\frac{\\partial \\mathbf{y}}{\\partial \\lambda_j}\\right) = \\frac{\\partial}{\\partial \\lambda_j}\\left(\\frac{d\\mathbf{y}}{dt}\\right) = \\frac{\\partial}{\\partial \\lambda_j} \\mathbf{F}(\\mathbf{y}, \\boldsymbol{\\lambda})\n$$\n对右侧应用链式法则得到灵敏度方程：\n$$\n\\frac{d\\mathbf{S}_j}{dt} = \\frac{\\partial \\mathbf{F}}{\\partial \\mathbf{y}} \\mathbf{S}_j + \\frac{\\partial \\mathbf{F}}{\\partial \\lambda_j} = \\mathbf{J}(t) \\mathbf{S}_j(t) + \\frac{\\partial \\mathbf{F}}{\\partial \\lambda_j}\n$$\n其中 $\\mathbf{J}(t)$ 是系统的雅可比矩阵。对于此线性系统，$\\mathbf{J} = \\mathbf{K}$。项 $\\frac{\\partial \\mathbf{F}}{\\partial \\lambda_j}$ 是 $\\mathbf{F}$ 对 $\\lambda_j$ 的偏导数，并保持 $\\mathbf{y}$ 不变，其计算结果为 $\\frac{\\partial \\mathbf{K}}{\\partial \\lambda_j} \\mathbf{y}$。灵敏度的初始条件为 $\\mathbf{S}_j(0) = \\frac{\\partial \\mathbf{y}(0)}{\\partial \\lambda_j} = \\mathbf{0}$，因为初始状态不依赖于 $\\boldsymbol{\\lambda}$。\n\n我们通过对一个包含 $3 + 4 \\times 3 = 15$ 个 ODE 的增广系统从 $t=0$ 到 $t=t_f$ 进行积分，来同时求解状态向量 $\\mathbf{y}(t)$ 和 4 个灵敏度向量 $\\mathbf{S}_j(t)$。该增广系统为：\n$$\n\\frac{d}{dt}\n\\begin{pmatrix}\n\\mathbf{y} \\\\ \\mathbf{S}_1 \\\\ \\mathbf{S}_2 \\\\ \\mathbf{S}_3 \\\\ \\mathbf{S}_4\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\mathbf{K}\\mathbf{y} \\\\\n\\mathbf{K}\\mathbf{S}_1 + \\mathbf{b}_1(\\mathbf{y}) \\\\\n\\mathbf{K}\\mathbf{S}_2 + \\mathbf{b}_2(\\mathbf{y}) \\\\\n\\mathbf{K}\\mathbf{S}_3 + \\mathbf{b}_3(\\mathbf{y}) \\\\\n\\mathbf{K}\\mathbf{S}_4 + \\mathbf{b}_4(\\mathbf{y})\n\\end{pmatrix}\n$$\n其中强迫项 $\\mathbf{b}_j(\\mathbf{y}) = \\frac{\\partial \\mathbf{K}}{\\partial \\lambda_j} \\mathbf{y}$ 由速率常数的导数导出。当 $\\beta = 1/(RT)$ 时，这些导数为：\n$\\frac{\\partial k_{f,1}}{\\partial \\lambda_1} = -\\beta k_{f,1}$, $\\frac{\\partial k_{r,1}}{\\partial \\lambda_1} = -\\beta k_{r,1}$\n$\\frac{\\partial k_{f,2}}{\\partial \\lambda_2} = -\\beta k_{f,2}$, $\\frac{\\partial k_{r,2}}{\\partial \\lambda_2} = -\\beta k_{r,2}$\n$\\frac{\\partial k_{r,1}}{\\partial \\lambda_3} = \\beta k_{r,1}$\n$\\frac{\\partial k_{r,2}}{\\partial \\lambda_4} = \\beta k_{r,2}$\n所有其他速率常数的偏导数均为零。\n\n因此，强迫向量为：\n$$\n\\mathbf{b}_1 = -\\beta \\begin{bmatrix} -(k_{f,1}y_1 - k_{r,1}y_2) \\\\ (k_{f,1}y_1 - k_{r,1}y_2) \\\\ 0 \\end{bmatrix}, \\quad\n\\mathbf{b}_2 = -\\beta \\begin{bmatrix} -(k_{f,2}y_1 - k_{r,2}y_3) \\\\ 0 \\\\ (k_{f,2}y_1 - k_{r,2}y_3) \\end{bmatrix}\n$$\n$$\n\\mathbf{b}_3 = \\beta \\begin{bmatrix} k_{r,1}y_2 \\\\ -k_{r,1}y_2 \\\\ 0 \\end{bmatrix}, \\quad\n\\mathbf{b}_4 = \\beta \\begin{bmatrix} k_{r,2}y_3 \\\\ 0 \\\\ -k_{r,2}y_3 \\end{bmatrix}\n$$\n\n算法如下：\n$1$. 对每个测试用例，定义参数 $(T, t_f, \\boldsymbol{\\lambda})$。\n$2$. 计算 $\\beta = 1/(RT)$ 和 $k_0 = k_B T/h$。\n$3$. 计算速率常数 $k_{f,i}, k_{r,i}$ 并组装矩阵 $\\mathbf{K}$。\n$4$. 构建增广系统的初始状态 $\\mathbf{z}(0)$，这是一个大小为 15 的向量，其中 $[y_1(0), y_2(0), y_3(0)] = [1.0, 0.0, 0.0]$，所有其他元素均为零。\n$5$. 使用鲁棒的求解器（如 `scipy.integrate.solve_ivp`）对增广 ODE 系统从 $t=0$到 $t=t_f$ 进行数值积分。\n$6$. 从解 $\\mathbf{z}(t_f)$ 中，提取最终状态 $\\mathbf{y}(t_f)$ 和灵敏度向量 $\\mathbf{S}_j(t_f)$。\n$7$. 对于每个参数 $\\lambda_j$，使用提取的值计算产物分数的最终灵敏度：\n$$\n\\frac{\\partial f_1}{\\partial \\lambda_j} \\bigg|_{t=t_f} = \\frac{y_3(t_f) S_{2j}(t_f) - y_2(t_f) S_{3j}(t_f)}{\\left(y_2(t_f) + y_3(t_f)\\right)^2}\n$$\n这个过程在提供的 Python 代码中实现，遵循指定的数值常数并生成所需的输出格式。", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    使用前向灵敏度分析法，求解平行可逆反应网络中产物分数的灵敏度。\n    \"\"\"\n    # Physical constants\n    K_B = 1.380649e-23  # J K^-1\n    H = 6.62607015e-34   # J s\n    R = 8.314462618e-3   # kJ mol^-1 K^-1\n    KAPPA = 1.0          # Transmission coefficient\n\n    # Initial concentrations\n    A0 = 1.0\n\n    # Test cases: (T, t_f, dG1_ddagger, dG2_ddagger, GP1, GP2)\n    test_cases = [\n        # Case K (Kinetic control)\n        (298.15, 1.0e-4, 60.0, 62.0, -10.0, -20.0),\n        # Case T (Thermodynamic control)\n        (298.15, 100.0, 60.0, 62.0, -10.0, -20.0),\n        # Case S (Symmetric channels)\n        (298.15, 1.0, 60.0, 60.0, -20.0, -20.0),\n        # Case C (Competing kinetics/thermodynamics)\n        (298.15, 0.1, 58.0, 66.0, -5.0, -30.0)\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        T, t_f, dG1_ddagger, dG2_ddagger, GP1, GP2 = case\n        params = np.array([dG1_ddagger, dG2_ddagger, GP1, GP2])\n\n        # Calculate thermodynamic and kinetic constants\n        beta = 1.0 / (R * T)\n        k0 = KAPPA * K_B * T / H\n\n        # Calculate rate constants\n        kf1 = k0 * np.exp(-beta * dG1_ddagger)\n        kf2 = k0 * np.exp(-beta * dG2_ddagger)\n        kr1 = k0 * np.exp(-beta * (dG1_ddagger - GP1))\n        kr2 = k0 * np.exp(-beta * (dG2_ddagger - GP2))\n\n        # Rate matrix K (Jacobian)\n        K = np.array([\n            [-(kf1 + kf2), kr1, kr2],\n            [kf1, -kr1, 0.0],\n            [kf2, 0.0, -kr2]\n        ])\n\n        def augmented_ode_system(t, z):\n            # Unpack state vector y and sensitivity vectors S_j\n            y = z[0:3]\n            S = z[3:].reshape((4, 3))\n\n            # State equation\n            dydt = K @ y\n\n            # Forcing terms for sensitivity equations\n            b1 = -beta * np.array([-(kf1 * y[0] - kr1 * y[1]), kf1 * y[0] - kr1 * y[1], 0.0])\n            b2 = -beta * np.array([-(kf2 * y[0] - kr2 * y[2]), 0.0, kf2 * y[0] - kr2 * y[2]])\n            b3 = beta * np.array([kr1 * y[1], -kr1 * y[1], 0.0])\n            b4 = beta * np.array([kr2 * y[2], 0.0, -kr2 * y[2]])\n            \n            b = [b1, b2, b3, b4]\n            \n            # Sensitivity equations\n            dSdt = np.zeros_like(S)\n            for j in range(4):\n                dSdt[j, :] = K @ S[j, :] + b[j]\n\n            # Combine derivatives into a single vector\n            dzdt = np.concatenate((dydt, dSdt.flatten()))\n            return dzdt\n\n        # Initial conditions for augmented system\n        z0 = np.zeros(15)\n        z0[0] = A0\n\n        # Solve the augmented ODE system\n        sol = solve_ivp(augmented_ode_system, [0, t_f], z0, method='Radau', rtol=1e-9, atol=1e-12)\n        \n        # Extract final state and sensitivities\n        z_final = sol.y[:, -1]\n        y_final = z_final[0:3]\n        S_final = z_final[3:].reshape((4, 3))\n        \n        y2_f, y3_f = y_final[1], y_final[2]\n        \n        # Calculate sensitivities of the product fraction f1\n        sensitivities = []\n        denom = (y2_f + y3_f)**2\n        \n        if abs(denom)  1e-16: # Avoid division by zero at t=0 or if no product forms\n             sensitivities = [0.0, 0.0, 0.0, 0.0]\n        else:\n            for j in range(4):\n                S2j_f, S3j_f = S_final[j, 1], S_final[j, 2]\n                df1_d_lambda_j = (y3_f * S2j_f - y2_f * S3j_f) / denom\n                sensitivities.append(df1_d_lambda_j)\n\n        all_results.append(sensitivities)\n    \n    # Format output string\n    # E.g., [[-0.123456,0.123456,...],[...]]\n    output_str = '[' + ','.join(\n        '[' + ','.join([f'{val:.6f}' for val in res]) + ']'\n        for res in all_results\n    ) + ']'\n    print(output_str)\n\nsolve()\n\n```", "id": "2650548"}]}