{"hands_on_practices": [{"introduction": "掌握链式反应的第一步是能够自信地计算动力学链长 $\\nu$。这个练习 [@problem_id:1474921] 提供了一个基于大气化学的现实场景，您将运用化学动力学中的基石——稳态近似法 (QSSA)——来确定自由基链载体的浓度，并进而计算链式过程的效率。", "problem": "某些氯氟烃（CFC）替代品（如1,1,2-三氟乙烷）的大气降解过程可以被模拟为气相链式反应。考虑在一个模拟平流层条件的受控实验室环境中，此类溶剂（我们记作 $M$）降解的简化模型。该反应由氯原子 $\\cdot Cl$ 引发，氯原子也充当链载体。\n\n反应机理包括三个主要阶段：\n1.  **链引发：** 氯原子由前体以恒定速率 $R_{\\text{init}}$ 生成。\n2.  **链增长：** 氯原子与溶剂分子 $M$ 反应，导致其分解并再生氯原子。总的链增长步骤可表示为 $\\cdot Cl + M \\rightarrow \\text{产物} + \\cdot Cl$。链增长速率由定律 $R_{\\text{prop}} = k_p [\\cdot Cl][M]$ 给出。\n3.  **链终止：** 链式反应通过两个氯原子复合形成稳定的氯分子而终止：$2 \\cdot Cl \\rightarrow Cl_2$。链终止速率遵循定律 $R_{\\text{term}} = 2k_t [\\cdot Cl]^2$。\n\n在某特定实验中，系统达到了稳态，其参数如下：\n- 溶剂的恒定浓度为 $[M] = 8.0 \\times 10^{-8}$ M。\n- 链引发速率为 $R_{\\text{init}} = 3.5 \\times 10^{-12}$ M s$^{-1}$。\n- 链增长速率常数为 $k_p = 2.1 \\times 10^7$ M$^{-1}$s$^{-1}$。\n- 链终止速率常数为 $k_t = 5.2 \\times 10^9$ M$^{-1}$s$^{-1}$。\n\n假设氯原子链载体的浓度在整个稳态期间保持不变，计算该降解过程的动力学链长。将最终答案四舍五入至三位有效数字。", "solution": "将动力学链长定义为每个链引发事件发生的链增长循环次数。因此，动力学链长由链增长速率与链引发速率之比给出：\n$$\n\\nu \\equiv \\frac{R_{\\text{prop}}}{R_{\\text{init}}}.\n$$\n对于给定的机理，链增长速率为\n$$\nR_{\\text{prop}} = k_{p}[\\cdot Cl][M].\n$$\n假设链载体处于稳态，氯原子浓度满足\n$$\n\\frac{d[\\cdot Cl]}{dt} = R_{\\text{init}} - 2k_{t}[\\cdot Cl]^{2} = 0 \\quad \\Rightarrow \\quad [\\cdot Cl] = \\left(\\frac{R_{\\text{init}}}{2k_{t}}\\right)^{\\frac{1}{2}}.\n$$\n将此代入链长的表达式，得到完全符号化的结果\n$$\n\\nu = \\frac{k_{p}[M][\\cdot Cl]}{R_{\\text{init}}} = \\frac{k_{p}[M]}{R_{\\text{init}}}\\left(\\frac{R_{\\text{init}}}{2k_{t}}\\right)^{\\frac{1}{2}} = \\frac{k_{p}[M]}{\\left(2k_{t}R_{\\text{init}}\\right)^{\\frac{1}{2}}}.\n$$\n现在使用给定值进行数值计算：\n$$\nk_{p}[M] = \\left(2.1 \\times 10^{7}\\right)\\left(8.0 \\times 10^{-8}\\right) = 1.68,\n$$\n$$\n\\left(2k_{t}R_{\\text{init}}\\right)^{\\frac{1}{2}} = \\left[\\left(2 \\times 5.2 \\times 10^{9}\\right)\\left(3.5 \\times 10^{-12}\\right)\\right]^{\\frac{1}{2}} = \\left(3.64 \\times 10^{-2}\\right)^{\\frac{1}{2}} \\approx 0.190788.\n$$\n因此，\n$$\n\\nu = \\frac{1.68}{0.190788} \\approx 8.81,\n$$\n该值为无量纲，并四舍五入到三位有效数字。", "answer": "$$\\boxed{8.81}$$", "id": "1474921"}, {"introduction": "动力学链长远非一个抽象的理论数值，它对材料的宏观性质有着深远的影响。这个实践 [@problem_id:1474968] 将带您进入高分子科学的世界，在这里，聚合物链的长度直接由动力学参数决定。您将推导动力学链长 $\\nu$ 与数均聚合度 $X_n$ 之间的关键关系，并考虑不同的终止机理如何影响最终聚合物的大小。", "problem": "在单体的自由基链式增长聚合反应中，整个过程包括三个主要阶段：引发、增长和终止。增长中的聚合物链（自由基）的终止可以通过两种主要机理发生：偶合，即两条自由基链结合形成一条更长的链；以及歧化，即一个自由基从另一个自由基上夺取一个原子（通常是氢原子），从而产生两条独立的、稳定的聚合物链。\n\n让我们定义该过程的两个重要特征：\n\n1.  **动力学链长 ($\\nu$)** 定义为增长速率（即单体消耗速率）与新动力学链引发速率之比。\n2.  **数均聚合度 ($X_n$)** 定义为结合到聚合物中的单体单元总数与产生的最终稳定聚合物分子总数之比。\n\n考虑一个两种终止机理都存在的聚合过程。偶合终止的速率常数为 $k_{tc}$，歧化终止的速率常数为 $k_{td}$。令 $\\delta$ 表示通过歧化路径进行的终止反应的比例，其表达式为 $\\delta = \\frac{k_{td}}{k_{tc} + k_{td}}$。\n\n推导数均聚合度 $X_n$ 关于动力学链长 $\\nu$ 和比例 $\\delta$ 的通用表达式。你的最终表达式应只包含 $\\nu$ 和 $\\delta$。", "solution": "将增长速率定义为 $R_{p}$，动力学链的引发速率定义为 $R_{i}$。动力学链长定义为\n$$\n\\nu = \\frac{R_{p}}{R_{i}}.\n$$\n令 $[R^{\\bullet}]$ 表示增长自由基链末端的浓度。根据质量作用定律，偶合和歧化终止事件的速率分别为\n$$\nR_{tc}^{\\text{evt}} = k_{tc}[R^{\\bullet}]^{2}, \\quad R_{td}^{\\text{evt}} = k_{td}[R^{\\bullet}]^{2}.\n$$\n总终止事件速率和相应的自由基损失速率为\n$$\nR_{\\text{term}}^{\\text{evt}} = \\left(k_{tc}+k_{td}\\right)[R^{\\bullet}]^{2}, \\quad R_{\\text{term}}^{\\text{rad}} = 2\\left(k_{tc}+k_{td}\\right)[R^{\\bullet}]^{2}.\n$$\n在稳态条件下，动力学链的引发速率等于自由基的损失速率，因此\n$$\nR_{i} = R_{\\text{term}}^{\\text{rad}} = 2\\left(k_{tc}+k_{td}\\right)[R^{\\bullet}]^{2}.\n$$\n通过歧化发生的终止事件的比例为\n$$\n\\delta = \\frac{k_{td}}{k_{tc}+k_{td}} = \\frac{R_{td}^{\\text{evt}}}{R_{\\text{term}}^{\\text{evt}}}.\n$$\n每个偶合终止事件产生一个聚合物分子，而每个歧化终止事件产生两个聚合物分子。因此，聚合物分子的生成速率为\n$$\nR_{\\text{poly}} = 1 \\cdot R_{tc}^{\\text{evt}} + 2 \\cdot R_{td}^{\\text{evt}} = \\left[(1-\\delta)+2\\delta\\right]R_{\\text{term}}^{\\text{evt}} = (1+\\delta)R_{\\text{term}}^{\\text{evt}}.\n$$\n使用上述稳态关系中的 $R_{\\text{term}}^{\\text{evt}} = R_{i}/2$，我们得到\n$$\nR_{\\text{poly}} = \\frac{1+\\delta}{2}\\,R_{i}.\n$$\n根据定义，数均聚合度是单体结合速率除以聚合物分子的生成速率：\n$$\nX_{n} = \\frac{R_{p}}{R_{\\text{poly}}} = \\frac{R_{p}}{\\frac{1+\\delta}{2}\\,R_{i}} = \\frac{2}{1+\\delta}\\,\\frac{R_{p}}{R_{i}}.\n$$\n考虑到 $\\nu = R_{p}/R_{i}$，我们得出结论\n$$\nX_{n} = \\frac{2\\nu}{1+\\delta}.\n$$\n该表达式可简化为已知的极限情况：对于纯偶合（$\\delta=0$），$X_{n}=2\\nu$；对于纯歧化（$\\delta=1$），$X_{n}=\\nu$。", "answer": "$$\\boxed{\\frac{2\\nu}{1+\\delta}}$$", "id": "1474968"}, {"introduction": "现代化学动力学研究与计算建模密不可分。这项高级实践 [@problem_id:2630634] 旨在挑战您像计算化学家一样思考。在推导出链长的基本表达式后，您将编写程序来系统地探索 $\\nu$ 如何响应增长和终止速率的变化，从而创建反应行为的“相图”，并识别出高效率或潜在的“临界”区域。", "problem": "考虑一个恒容、均相、等温的链式反应过程，其中，一种由 $R\\cdot$ 表示的单一链载体自由基，由外部引发剂以恒定的引发通量 $R_i$ 产生，并参与一个消耗底物 $A$ 的链增长步骤。底物 $A$ 大量过量，因此在自由基动力学的时间尺度上，其浓度 $[A]$ 可视为常数。机理步骤如下，以形式反应和质量作用动力学的形式写出：\n\n- 引发：外部源以恒定的单位体积摩尔速率 $R_i$ 提供自由基，单位为 $\\mathrm{mol\\,L^{-1}\\,s^{-1}}$。\n- 链增长：$R\\cdot + A \\rightarrow R\\cdot + (\\text{产物})$，速率常数为 $k_p$，摩尔速率为 $r_p = k_p [R\\cdot][A]$，其中 $k_p$ 的单位为 $\\mathrm{L\\,mol^{-1}\\,s^{-1}}$，$[A]$ 被视为常数，等于 $M$，单位为 $\\mathrm{mol\\,L^{-1}}$。\n- 链终止：$R\\cdot + R\\cdot \\rightarrow (\\text{非活性产物})$，速率常数为 $k_t$，摩尔速率为 $r_t = k_t [R\\cdot]^2$，其中 $k_t$ 的单位为 $\\mathrm{L\\,mol^{-1}\\,s^{-1}}$。\n\n仅从质量作用动力学和链载体浓度 $[R\\cdot]$ 的稳态（stationary/steady state）定义出发，并使用链长 $\\nu$ 在稳态下定义为每次引发事件平均发生的链增长事件数，推导出一个关于 $k_p$、$k_t$、$R_i$ 和 $M$ 的 $\\nu$ 的闭式表达式。不要假设任何预先制定的公式；从该机理和所述定义所蕴含的常微分方程（ODE）开始推导。\n\n然后，实现一个程序，使用您推导的表达式，在指定的网格上对 $k_t$ 和 $k_p$ 进行参数扫描，并为下面的每个测试用例构建 $\\nu(k_t,k_p)$ 的相图。对于每个测试用例，计算并报告以下五个定量诊断指标：\n\n1. 网格上的最大链长 $\\max \\nu$。\n2. $\\nu$ 在网格上达到其最大值时的坐标 $(k_t^\\ast,k_p^\\ast)$（如果出现多个最大值，选择 $k_t$ 最小的那个；如果仍然并列，选择 $k_p$ 最小的那个）。\n3. 其 $\\nu$ 值大于或等于指定阈值 $\\nu_{\\text{large}}$ 的网格点所占的比例（以小数形式报告）。\n4. 一个布尔值“临界性”指标，其定义为是否存在至少一个网格点的 $\\nu \\ge \\nu_{\\text{crit}}$。\n\n所有量都必须使用上述指定的单位进行计算。链长 $\\nu$ 是无量纲的。所有浮点输出必须四舍五入到六位有效数字。输出应将每个测试用例的五个诊断指标聚合为一个列表，并将所有测试用例聚合为单个列表的列表。您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，$[result1,result2,result3]$）。\n\n使用以下参数网格和阈值的测试套件（所有速率常数单位为 $\\mathrm{L\\,mol^{-1}\\,s^{-1}}$，所有浓度单位为 $\\mathrm{mol\\,L^{-1}}$，所有引发通量单位为 $\\mathrm{mol\\,L^{-1}\\,s^{-1}}$）：\n\n- 测试用例 1 (一般情况):\n  - $R_i = 1.0\\times 10^{-6}$，$M = 1.0$，\n  - $k_t \\in \\{1.0\\times 10^{7},\\, 1.0\\times 10^{8},\\, 1.0\\times 10^{9}\\}$，\n  - $k_p \\in \\{10.0,\\, 100.0,\\, 1000.0\\}$，\n  - $\\nu_{\\text{large}} = 100.0$，$\\nu_{\\text{crit}} = 10000.0$。\n- 测试用例 2 (弱终止，大增长窗口):\n  - $R_i = 1.0\\times 10^{-9}$，$M = 2.0$，\n  - $k_t \\in \\{1.0\\times 10^{3},\\, 1.0\\times 10^{5},\\, 1.0\\times 10^{7}\\}$，\n  - $k_p \\in \\{1000.0,\\, 10000.0\\}$，\n  - $\\nu_{\\text{large}} = 1000.0$，$\\nu_{\\text{crit}} = 1000000.0$。\n- 测试用例 3 (增长限制区域):\n  - $R_i = 1.0\\times 10^{-6}$，$M = 0.5$，\n  - $k_t \\in \\{1.0\\times 10^{6},\\, 1.0\\times 10^{7}\\}$，\n  - $k_p \\in \\{0.01,\\, 0.1\\}$，\n  - $\\nu_{\\text{large}} = 1.0$，$\\nu_{\\text{crit}} = 100.0$。\n\n您的程序必须为每个测试用例扫描指定 $k_t$ 和 $k_p$ 值的所有组合，使用您推导的表达式计算每个网格点的 $\\nu$，然后输出一行包含三个列表的列表（对应三个测试用例）。每个内部列表必须按以下顺序包含五个条目：$[\\max \\nu, k_t^\\ast, k_p^\\ast, \\nu \\ge \\nu_{\\text{large}} \\text{ 的比例}, \\text{临界性标志}]$。浮点条目必须四舍五入到六位有效数字，临界性标志是一个布尔值，写作 $\\mathrm{True}$ 或 $\\mathrm{False}$。", "solution": "对问题陈述进行验证。\n\n### 步骤 1：提取给定信息\n\n问题提供了以下信息：\n- 一个恒容、均相、等温的链式反应过程。\n- 单一链载体自由基物种 $R\\cdot$。\n- 引发：外部源以恒定的单位体积速率 $R_i$ $(\\mathrm{mol\\,L^{-1}\\,s^{-1}})$ 提供自由基。\n- 链增长：$R\\cdot + A \\rightarrow R\\cdot + (\\text{产物})$，速率常数为 $k_p$ $(\\mathrm{L\\,mol^{-1}\\,s^{-1}})$，速率为 $r_p = k_p [R\\cdot][A]$。底物 $A$ 的浓度 $[A]$ 是恒定的，等于 $M$ $(\\mathrm{mol\\,L^{-1}})$。\n- 链终止：$R\\cdot + R\\cdot \\rightarrow (\\text{非活性产物})$，速率常数为 $k_t$ $(\\mathrm{L\\,mol^{-1}\\,s^{-1}})$，速率为 $r_t = k_t [R\\cdot]^2$。\n- 系统相对于 $[R\\cdot]$ 处于稳态（stationary/steady state）。\n- 链长 $\\nu$ 定义为稳态下每次引发事件平均发生的链增长事件数。\n\n- 测试用例 1：$R_i = 1.0\\times 10^{-6}$，$M = 1.0$，$k_t \\in \\{1.0\\times 10^{7}, 1.0\\times 10^{8}, 1.0\\times 10^{9}\\}$，$k_p \\in \\{10.0, 100.0, 1000.0\\}$，$\\nu_{\\text{large}} = 100.0$，$\\nu_{\\text{crit}} = 10000.0$。\n- 测试用例 2：$R_i = 1.0\\times 10^{-9}$，$M = 2.0$，$k_t \\in \\{1.0\\times 10^{3}, 1.0\\times 10^{5}, 1.0\\times 10^{7}\\}$，$k_p \\in \\{1000.0, 10000.0\\}$，$\\nu_{\\text{large}} = 1000.0$，$\\nu_{\\text{crit}} = 1000000.0$。\n- 测试用例 3：$R_i = 1.0\\times 10^{-6}$，$M = 0.5$，$k_t \\in \\{1.0\\times 10^{6}, 1.0\\times 10^{7}\\}$，$k_p \\in \\{0.01, 0.1\\}$，$\\nu_{\\text{large}} = 1.0$，$\\nu_{\\text{crit}} = 100.0$。\n\n### 步骤 2：使用提取的给定信息进行验证\n\n根据验证标准对问题进行分析。\n- **科学依据**：该问题描述了一个链式反应（例如，自由基聚合）的经典模型，包括引发、链增长和双分子终止步骤。对高活性中间体 ($R\\cdot$) 使用质量作用动力学和稳态近似是化学动力学中的标准基石原理。所有单位在量纲上都是一致的。该问题是科学合理的。\n- **适定性**：该问题要求从第一性原理推导闭式表达式并进行后续的数值评估。步骤逻辑结构清晰，所提供的信息足以推导出链长的唯一且有意义的表达式。该问题是适定的。\n- **客观性**：该问题使用精确、无歧义的科学语言和定量数据进行阐述。它不含主观论断。该问题是客观的。\n- **完整性和一致性**：所有必需的常数和定义 ($R_i, k_p, k_t, [A]=M, \\nu$) 都已明确给出。测试用例的数据集是完整的。没有内部矛盾。\n- **真实性**：所提供的速率常数和浓度值在真实化学系统的物理合理范围内。\n- **无其他缺陷**：该问题并非无足轻重、不可形式化或无法验证。该任务需要进行基础推导，而不仅仅是套用公式。\n\n### 步骤 3：结论与行动\n\n问题陈述是**有效的**。这是一个化学动力学中的标准、定义明确的问题。我将继续进行完整的推导和求解。\n\n**链长表达式的推导**\n\n目标是根据给定的参数 $k_p$、$k_t$、$R_i$ 和 $M$ 推导链长 $\\nu$ 的闭式表达式。推导必须从基本速率方程开始。\n\n首先，我们写出链载体浓度 $[R\\cdot]$ 的常微分方程（ODE）。$[R\\cdot]$ 的变化速率是其生成速率和消耗速率的总和。\n- **生成**：自由基仅由外部引发源以恒定速率 $R_i$ 生成。\n- **消耗**：\n    - 对于链增长步骤 $R\\cdot + A \\rightarrow R\\cdot + (\\text{product})$，一个自由基被消耗，同时一个自由基被生成，因此 $[R\\cdot]$ 的净变化为零。\n    - 对于链终止步骤 $R\\cdot + R\\cdot \\rightarrow (\\text{dead product})$，每个反应事件消耗两个自由基。该反应的速率为 $r_t = k_t [R\\cdot]^2$。因此，物种 $R\\cdot$ 的消耗速率是反应速率的两倍，即 $2 k_t [R\\cdot]^2$。\n\n结合这些项，$[R\\cdot]$ 的速率定律为：\n$$\n\\frac{d[R\\cdot]}{dt} = R_i - 2 k_t [R\\cdot]^2\n$$\n\n问题指明系统对于 $[R\\cdot]$ 处于稳态（stationary/steady state）。稳态近似（SSA）意味着活性中间体的浓度是恒定的，即其净生成速率为零。\n$$\n\\frac{d[R\\cdot]_{ss}}{dt} = 0\n$$\n其中 $[R\\cdot]_{ss}$ 表示稳态浓度。\n\n将稳态近似应用于速率定律：\n$$\nR_i - 2 k_t [R\\cdot]_{ss}^2 = 0\n$$\n\n我们现在求解这个关于 $[R\\cdot]_{ss}$ 的代数方程：\n$$\n2 k_t [R\\cdot]_{ss}^2 = R_i\n$$\n$$\n[R\\cdot]_{ss}^2 = \\frac{R_i}{2 k_t}\n$$\n由于浓度必须为非负量，我们取正平方根：\n$$\n[R\\cdot]_{ss} = \\sqrt{\\frac{R_i}{2 k_t}}\n$$\n\n接下来，我们使用链长 $\\nu$ 的定义：“稳态下每次引发事件平均发生的链增长事件数”。这是在稳态下评估的链增长速率与引发速率之比。\n\n链增长速率为 $r_p = k_p [R\\cdot][A]$。在稳态下，给定 $[A]$ 为常数 $M$，链增长速率为：\n$$\nr_{p,ss} = k_p [R\\cdot]_{ss} M\n$$\n\n引发速率为给定的 $R_i$。因此，链长 $\\nu$ 为：\n$$\n\\nu = \\frac{r_{p,ss}}{R_i} = \\frac{k_p [R\\cdot]_{ss} M}{R_i}\n$$\n\n最后，我们将推导出的 $[R\\cdot]_{ss}$ 表达式代入 $\\nu$ 的方程：\n$$\n\\nu = \\frac{k_p M}{R_i} \\left( \\sqrt{\\frac{R_i}{2 k_t}} \\right)\n$$\n\n为简化起见，我们将 $1/R_i$ 项移入平方根内：\n$$\n\\nu = k_p M \\sqrt{\\frac{R_i}{2 k_t R_i^2}}\n$$\n$$\n\\nu = k_p M \\sqrt{\\frac{1}{2 k_t R_i}}\n$$\n这可以写成其最终的闭式形式：\n$$\n\\nu = \\frac{k_p M}{\\sqrt{2 k_t R_i}}\n$$\n这就是所要求的表达式。它给出了无量纲链长 $\\nu$ 作为系统参数 $k_p$、$k_t$、$R_i$ 和 $M$ 的函数。该表达式将在程序中实现，以计算所需的诊断指标。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the chemical kinetics problem by deriving and applying a formula for chain length.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"Ri\": 1.0e-6, \"M\": 1.0,\n            \"kt_grid\": [1.0e7, 1.0e8, 1.0e9],\n            \"kp_grid\": [10.0, 100.0, 1000.0],\n            \"nu_large\": 100.0, \"nu_crit\": 10000.0\n        },\n        {\n            \"Ri\": 1.0e-9, \"M\": 2.0,\n            \"kt_grid\": [1.0e3, 1.0e5, 1.0e7],\n            \"kp_grid\": [1000.0, 10000.0],\n            \"nu_large\": 1000.0, \"nu_crit\": 1000000.0\n        },\n        {\n            \"Ri\": 1.0e-6, \"M\": 0.5,\n            \"kt_grid\": [1.0e6, 1.0e7],\n            \"kp_grid\": [0.01, 0.1],\n            \"nu_large\": 1.0, \"nu_crit\": 100.0\n        }\n    ]\n\n    all_results = []\n\n    def format_float(n):\n        \"\"\"Rounds a float to six significant figures.\"\"\"\n        if n == 0:\n            return 0.0\n        # Use g-formatting to handle significant figures correctly for a wide range of numbers.\n        return float(f\"{n:.6g}\")\n\n    for case in test_cases:\n        Ri, M = case[\"Ri\"], case[\"M\"]\n        kt_grid, kp_grid = case[\"kt_grid\"], case[\"kp_grid\"]\n        nu_large, nu_crit = case[\"nu_large\"], case[\"nu_crit\"]\n\n        max_nu = -1.0\n        opt_coords = (np.inf, np.inf)\n        large_nu_count = 0\n        is_critical = False\n        \n        # The input grids are already sorted, which simplifies tie-breaking.\n        # The first time a maximum value is found, its coordinates will be\n        # the smallest lexicographically, satisfying the problem's rule.\n        for kt in kt_grid:\n            for kp in kp_grid:\n                # Derived formula: nu = (kp * M) / sqrt(2 * kt * Ri)\n                denominator = np.sqrt(2 * kt * Ri)\n                if denominator == 0:\n                    nu = np.inf\n                else:\n                    nu = (kp * M) / denominator\n\n                # 1. Check for maximum chain length\n                if nu > max_nu:\n                    max_nu = nu\n                    opt_coords = (kt, kp)\n\n                # 2. Check if nu exceeds the 'large' threshold\n                if nu >= nu_large:\n                    large_nu_count += 1\n                \n                # 3. Check for criticality\n                if nu >= nu_crit:\n                    is_critical = True\n        \n        # Calculate the fraction of grid points with nu >= nu_large\n        total_points = len(kt_grid) * len(kp_grid)\n        fraction_large = large_nu_count / total_points if total_points > 0 else 0.0\n\n        # Assemble the results for the current test case, formatting as required\n        case_result = [\n            format_float(max_nu),\n            format_float(opt_coords[0]),\n            format_float(opt_coords[1]),\n            format_float(fraction_large),\n            is_critical\n        ]\n        all_results.append(case_result)\n\n    # The final output must be a string representation of a list of lists,\n    # with no spaces.\n    final_output_str = str(all_results).replace(\" \", \"\")\n    print(final_output_str)\n\nsolve()\n```", "id": "2630634"}]}