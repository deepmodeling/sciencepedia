{"hands_on_practices": [{"introduction": "为了研究光化学反应，我们首先需要识别出其中的关键角色：锥形交叉点。这项练习将指导您实现一种标准的计算算法，用以寻找最小能量锥形交叉点（MECI），并将其形貌分类为“斜坡型”或“尖峰型”。这种分类对于预测反应结果至关重要。通过解决这个约束优化问题[@problem_id:2635932]，您将掌握计算化学中用于表征非绝热过程核心区域的一项基本技能。", "problem": "给定一个局域线性振动耦合模型，用于描述维度为 $N$ 的核坐标空间中锥形交叉附近的两个绝热势能面。这两个绝热能量可建模为\n$$\nE_{\\pm}(\\mathbf{x}) \\;=\\; E_0 \\;+\\; \\tfrac{1}{2}\\,\\mathbf{x}^{\\mathsf{T}}\\mathbf{A}\\,\\mathbf{x} \\;+\\; \\mathbf{s}_0^{\\mathsf{T}}\\mathbf{x} \\;\\pm\\; \\sqrt{(\\mathbf{g}^{\\mathsf{T}}\\mathbf{x})^2 + (\\mathbf{h}^{\\mathsf{T}}\\mathbf{x})^2},\n$$\n其中 $\\mathbf{x}\\in\\mathbb{R}^N$ 是相对于参考几何结构的位移向量，$\\mathbf{A}\\in\\mathbb{R}^{N\\times N}$ 是一个对称正定矩阵，描述了平均能量的谐波曲率，$\\mathbf{s}_0\\in\\mathbb{R}^N$ 是一个常数向量，而 $\\mathbf{g},\\mathbf{h}\\in\\mathbb{R}^N$ 是定义分支平面的两个线性无关向量。分支平面是二维子空间 $\\mathcal{B}=\\mathrm{span}\\{\\mathbf{g},\\mathbf{h}\\}$。平均能量为\n$$\nE_{\\mathrm{avg}}(\\mathbf{x}) \\;=\\; \\tfrac{1}{2}\\left(E_{+}(\\mathbf{x})+E_{-}(\\mathbf{x})\\right) \\;=\\; E_0 \\;+\\; \\tfrac{1}{2}\\,\\mathbf{x}^{\\mathsf{T}}\\mathbf{A}\\,\\mathbf{x} \\;+\\; \\mathbf{s}_0^{\\mathsf{T}}\\mathbf{x},\n$$\n其梯度为\n$$\n\\mathbf{s}(\\mathbf{x}) \\;=\\; \\nabla E_{\\mathrm{avg}}(\\mathbf{x}) \\;=\\; \\mathbf{A}\\mathbf{x} + \\mathbf{s}_0.\n$$\n在此局域模型中，锥形交叉缝是满足简并约束条件的点的集合\n$$\n\\mathbf{g}^{\\mathsf{T}}\\mathbf{x} \\;=\\; 0,\\qquad \\mathbf{h}^{\\mathsf{T}}\\mathbf{x} \\;=\\; 0.\n$$\n此处，最小能量锥形交叉 (MECI) 几何结构 $\\mathbf{x}^{\\star}$ 定义为约束优化问题：在满足 $\\mathbf{g}^{\\mathsf{T}}\\mathbf{x}=0$ 和 $\\mathbf{h}^{\\mathsf{T}}\\mathbf{x}=0$ 的条件下最小化 $E_{\\mathrm{avg}}(\\mathbf{x})$ 的任意解。记到分支平面上的正交投影为 $\\mathbf{P}_{\\mathcal{B}}$，到其正交补空间上的投影为 $\\mathbf{P}_{\\mathcal{B}}^{\\perp}=\\mathbf{I}-\\mathbf{P}_{\\mathcal{B}}$。\n\n您的任务是实现一个分支平面约束优化算法，该算法能够：\n- 通过在两个线性简并约束条件下最小化 $E_{\\mathrm{avg}}(\\mathbf{x})$ 来计算 $\\mathbf{x}^{\\star}$。\n- 在 MECI 处计算平均能量梯度 $\\mathbf{s}^{\\star}=\\mathbf{A}\\mathbf{x}^{\\star}+\\mathbf{s}_0$。\n- 计算垂直于分支平面的平均能量梯度分量 $\\mathbf{s}_{\\perp}^{\\star}=\\mathbf{P}_{\\mathcal{B}}^{\\perp}\\mathbf{s}^{\\star}$，作为 MECI 处约束满足情况的诊断。\n- 计算分支平面内的平均能量梯度分量 $\\mathbf{s}_{\\parallel}^{\\star}=\\mathbf{P}_{\\mathcal{B}}\\mathbf{s}^{\\star}$，如果 $\\lVert \\mathbf{s}_{\\parallel}^{\\star}\\rVert_2$ 大于一个阈值，则将 MECI 拓扑分类为“斜坡型”(sloped)，否则分类为“尖峰型”(peaked)。\n\n算法要求：\n1. 使用拉格朗日乘子法构建并求解约束二次最小化问题。设 $\\mathbf{C}\\in\\mathbb{R}^{2\\times N}$ 的行分别为 $\\mathbf{g}^{\\mathsf{T}}$ 和 $\\mathbf{h}^{\\mathsf{T}}$。求解 Karush–Kuhn–Tucker 线性系统\n$$\n\\begin{bmatrix}\n\\mathbf{A} & \\mathbf{C}^{\\mathsf{T}}\\\\\n\\mathbf{C} & \\mathbf{0}\n\\end{bmatrix}\n\\begin{bmatrix}\n\\mathbf{x}^{\\star}\\\\\n\\boldsymbol{\\lambda}^{\\star}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n-\\mathbf{s}_0\\\\\n\\mathbf{0}\n\\end{bmatrix}.\n$$\n2. 通过对 $\\{\\mathbf{g},\\mathbf{h}\\}$ 进行正交规范化（例如，通过 Gram–Schmidt 过程或瘦 QR 分解）来构造 $\\mathbf{P}_{\\mathcal{B}}$。如果 $\\mathbf{Q}\\in\\mathbb{R}^{N\\times 2}$ 具有张成 $\\mathcal{B}$ 的正交规范列，则 $\\mathbf{P}_{\\mathcal{B}}=\\mathbf{Q}\\mathbf{Q}^{\\mathsf{T}}$ 且 $\\mathbf{P}_{\\mathcal{B}}^{\\perp}=\\mathbf{I}-\\mathbf{Q}\\mathbf{Q}^{\\mathsf{T}}$。\n3. 计算 $\\mathbf{s}^{\\star}$、$\\mathbf{s}_{\\perp}^{\\star}$ 和 $\\mathbf{s}_{\\parallel}^{\\star}$。\n4. 使用绝对分类阈值 $\\tau=10^{-10}$。如果 $\\lVert \\mathbf{s}_{\\parallel}^{\\star}\\rVert_2>\\tau$，则分类为“斜坡型”(sloped)；否则分类为“尖峰型”(peaked)。对于输出，将“斜坡型”编码为整数 $1$，将“尖峰型”编码为整数 $0$。\n\n测试套件：\n为以下情况实现您的程序。每种情况都指定了 $N$、$\\mathbf{A}$、$\\mathbf{g}$、$\\mathbf{h}$ 和 $\\mathbf{s}_0$。\n\n- 情况 1 (基准尖峰型):\n  - $N=3$。\n  - $\\mathbf{A}=\\mathrm{diag}(1,1,1)$。\n  - $\\mathbf{g}=(1,0,0)^{\\mathsf{T}}$, $\\mathbf{h}=(0,1,0)^{\\mathsf{T}}$。\n  - $\\mathbf{s}_0=(0,0,0)^{\\mathsf{T}}$。\n\n- 情况 2 (具有单位曲率的通用斜坡型):\n  - $N=3$。\n  - $\\mathbf{A}=\\mathrm{diag}(1,1,1)$。\n  - $\\mathbf{g}=(1,1,0)^{\\mathsf{T}}$, $\\mathbf{h}=(0,1,1)^{\\mathsf{T}}$。\n  - $\\mathbf{s}_0=(0.5,-0.4,0.1)^{\\mathsf{T}}$。\n\n- 情况 3 (具有各向异性曲率的尖峰型):\n  - $N=4$。\n  - $\\mathbf{A}=\\mathrm{diag}(2,1.5,1,0.5)$。\n  - $\\mathbf{g}=(1,0,1,0)^{\\mathsf{T}}$, $\\mathbf{h}=(0,1,0,1)^{\\mathsf{T}}$。\n  - $\\mathbf{s}_0=(0,0,0,0)^{\\mathsf{T}}$。\n\n- 情况 4 (具有耦合曲率的通用斜坡型):\n  - $N=4$。\n  - $\\mathbf{A}=\\begin{bmatrix}\n2 & 0.2 & 0 & 0\\\\\n0.2 & 1.5 & 0.1 & 0\\\\\n0 & 0.1 & 1.2 & 0.05\\\\\n0 & 0 & 0.05 & 0.8\n\\end{bmatrix}$。\n  - $\\mathbf{g}=(1,1,0,0)^{\\mathsf{T}}$, $\\mathbf{h}=(0,1,1,0)^{\\mathsf{T}}$。\n  - $\\mathbf{s}_0=(0.1,-0.2,0.3,-0.05)^{\\mathsf{T}}$。\n\n答案规范：\n- 您的程序必须使用上述算法，按给定顺序计算每种情况的分类。不涉及物理单位；所有量均为无量纲实数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔的整数列表，结果的顺序与情况的顺序完全一致，其中整数 $1$ 代表“斜坡型”，$0$ 代表“尖峰型”。例如，如果您的计算结果与情况相符，则像 $[0,1,0,1]$ 这样的输出是可以接受的。", "solution": "问题陈述已经过严格审查，并被确定为有效。它在科学上是合理的，问题定义清晰，客观且内部一致。它阐述了理论化学中的一个标准问题——在线性振动耦合模型中优化锥形交叉几何结构——并为其求解提供了一个清晰、数学上严谨的算法。因此，我们可以继续进行。\n\n问题的核心是找到一个最小能量锥形交叉 (MECI) 几何结构，记为 $\\mathbf{x}^{\\star} \\in \\mathbb{R}^N$。这是通过在定义锥形交叉缝的线性约束条件下，最小化平均势能 $E_{\\mathrm{avg}}(\\mathbf{x})$ 来实现的。该优化问题表述为：\n$$\n\\begin{aligned}\n \\underset{\\mathbf{x}}{\\text{minimize}}\n & E_{\\mathrm{avg}}(\\mathbf{x}) = E_0 + \\mathbf{s}_0^{\\mathsf{T}}\\mathbf{x} + \\tfrac{1}{2}\\mathbf{x}^{\\mathsf{T}}\\mathbf{A}\\mathbf{x} \\\\\n \\text{subject to}\n & \\mathbf{g}^{\\mathsf{T}}\\mathbf{x} = 0 \\\\\n &  \\mathbf{h}^{\\mathsf{T}}\\mathbf{x} = 0\n\\end{aligned}\n$$\n由于 $E_0$ 是一个常数，它不影响最小值的位置，因此可以在优化过程中忽略。该问题是一个带等式约束的二次规划问题。拉格朗日乘子法是解决此类问题的标准方法。\n\n我们定义拉格朗日函数 $\\mathcal{L}(\\mathbf{x}, \\boldsymbol{\\lambda})$，其中拉格朗日乘子向量为 $\\boldsymbol{\\lambda} = (\\lambda_1, \\lambda_2)^{\\mathsf{T}}$：\n$$\n\\mathcal{L}(\\mathbf{x}, \\boldsymbol{\\lambda}) = E_{\\mathrm{avg}}(\\mathbf{x}) + \\lambda_1 (\\mathbf{g}^{\\mathsf{T}}\\mathbf{x}) + \\lambda_2 (\\mathbf{h}^{\\mathsf{T}}\\mathbf{x})\n$$\n使用约束矩阵 $\\mathbf{C} \\in \\mathbb{R}^{2 \\times N}$（其行分别为 $\\mathbf{g}^{\\mathsf{T}}$ 和 $\\mathbf{h}^{\\mathsf{T}}$），可以更紧凑地写成：\n$$\n\\mathcal{L}(\\mathbf{x}, \\boldsymbol{\\lambda}) = E_{\\mathrm{avg}}(\\mathbf{x}) + \\boldsymbol{\\lambda}^{\\mathsf{T}}\\mathbf{C}\\mathbf{x}\n$$\n对于最小值 $(\\mathbf{x}^{\\star}, \\boldsymbol{\\lambda}^{\\star})$ 的一阶必要条件要求拉格朗日函数相对于 $\\mathbf{x}$ 和 $\\boldsymbol{\\lambda}$ 的梯度均为零。\n相对于 $\\mathbf{x}$ 的梯度为：\n$$\n\\nabla_{\\mathbf{x}}\\mathcal{L}(\\mathbf{x}^{\\star}, \\boldsymbol{\\lambda}^{\\star}) = \\nabla E_{\\mathrm{avg}}(\\mathbf{x}^{\\star}) + \\mathbf{C}^{\\mathsf{T}}\\boldsymbol{\\lambda}^{\\star} = \\mathbf{A}\\mathbf{x}^{\\star} + \\mathbf{s}_0 + \\mathbf{C}^{\\mathsf{T}}\\boldsymbol{\\lambda}^{\\star} = \\mathbf{0}\n$$\n相对于 $\\boldsymbol{\\lambda}$ 的梯度即为恢复约束条件：\n$$\n\\nabla_{\\boldsymbol{\\lambda}}\\mathcal{L}(\\mathbf{x}^{\\star}, \\boldsymbol{\\lambda}^{\\star}) = \\mathbf{C}\\mathbf{x}^{\\star} = \\mathbf{0}\n$$\n这两个向量方程可以重排为一个分块矩阵线性系统，即 Karush–Kuhn–Tucker (KKT) 系统，这正是问题陈述中给出的形式：\n$$\n\\begin{bmatrix}\n\\mathbf{A} & \\mathbf{C}^{\\mathsf{T}}\\\\\n\\mathbf{C} & \\mathbf{0}\n\\end{bmatrix}\n\\begin{bmatrix}\n\\mathbf{x}^{\\star}\\\\\n\\boldsymbol{\\lambda}^{\\star}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n-\\mathbf{s}_0\\\\\n\\mathbf{0}\n\\end{bmatrix}\n$$\n由于给定 $\\mathbf{A}$ 是正定的，且约束向量 $\\mathbf{g}$ 和 $\\mathbf{h}$ 是线性无关的（使得 $\\mathbf{C}$ 满秩），因此 KKT 矩阵是非奇异的，这保证了 $\\mathbf{x}^{\\star}$ 和 $\\boldsymbol{\\lambda}^{\\star}$ 存在唯一解。\n\n解决每个测试用例的算法步骤如下：\n\n1.  **求解 KKT 系统**：使用提供的参数 $\\mathbf{A}$、$\\mathbf{g}$、$\\mathbf{h}$ 和 $\\mathbf{s}_0$ 构造 $(N+2) \\times (N+2)$ 的 KKT 矩阵和 $(N+2) \\times 1$ 的右侧向量。求解这个线性系统以获得解向量，并从中提取 MECI 几何结构 $\\mathbf{x}^{\\star}$（前 $N$ 个分量）。\n\n2.  **计算 MECI 梯度**：在 MECI 几何结构处计算平均能量的梯度，$\\mathbf{s}^{\\star} = \\mathbf{s}(\\mathbf{x}^{\\star}) = \\mathbf{A}\\mathbf{x}^{\\star} + \\mathbf{s}_0$。根据 KKT 条件 $\\mathbf{A}\\mathbf{x}^{\\star} + \\mathbf{s}_0 = -\\mathbf{C}^{\\mathsf{T}}\\boldsymbol{\\lambda}^{\\star}$，很明显 $\\mathbf{s}^{\\star}$ 必须位于 $\\mathbf{C}^{\\mathsf{T}}$ 的列空间中，即分支平面 $\\mathcal{B} = \\mathrm{span}\\{\\mathbf{g}, \\mathbf{h}\\}$。\n\n3.  **构造分支平面投影算子**：为了分解梯度，我们需要到分支平面上的正交投影算子 $\\mathbf{P}_{\\mathcal{B}}$。这可以通过为 $\\mathcal{B}$ 构造一个正交规范基底来完成。我们构造一个大小为 $N \\times 2$ 的矩阵 $\\mathbf{G} = [\\mathbf{g} | \\mathbf{h}]$，并对其进行瘦 QR 分解，$\\mathbf{G} = \\mathbf{Q}\\mathbf{R}$，其中 $\\mathbf{Q}$ 是一个 $N \\times 2$ 的矩阵，其正交规范列张成 $\\mathcal{B}$。然后投影算子由 $\\mathbf{P}_{\\mathcal{B}} = \\mathbf{Q}\\mathbf{Q}^{\\mathsf{T}}$ 给出。到正交补空间上的投影算子为 $\\mathbf{P}_{\\mathcal{B}}^{\\perp} = \\mathbf{I} - \\mathbf{P}_{\\mathcal{B}}$。\n\n4.  **分解梯度**：计算梯度 $\\mathbf{s}^{\\star}$ 位于分支平面内的分量：$\\mathbf{s}_{\\parallel}^{\\star} = \\mathbf{P}_{\\mathcal{B}}\\mathbf{s}^{\\star}$。如步骤 2 所述，我们预期 $\\mathbf{s}^{\\star}$ 已在 $\\mathcal{B}$ 中，因此理论上 $\\mathbf{s}_{\\parallel}^{\\star} = \\mathbf{s}^{\\star}$。垂直于分支平面的分量 $\\mathbf{s}_{\\perp}^{\\star} = \\mathbf{P}_{\\mathcal{B}}^{\\perp}\\mathbf{s}^{\\star}$ 可用作数值诊断；其范数应接近于零。\n\n5.  **分类 MECI 拓扑**：MECI 的拓扑是根据分支平面内梯度的量级进行分类的。我们计算欧几里得范数 $L = \\lVert \\mathbf{s}_{\\parallel}^{\\star} \\rVert_2$。如果 $L$ 大于指定的阈值 $\\tau = 10^{-10}$，则 MECI 为“斜坡型”拓扑，编码为整数 $1$。如果 $L \\le \\tau$，则认为梯度在 MECI 处消失，这对应于“尖峰型”拓扑，编码为整数 $0$。此过程将系统地应用于所有提供的测试用例。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the MECI geometry and classifies its topology for a series of test cases\n    based on a local linear vibronic coupling model.\n    \"\"\"\n    \n    test_cases = [\n        {\n            \"N\": 3,\n            \"A\": np.diag([1.0, 1.0, 1.0]),\n            \"g\": np.array([1.0, 0.0, 0.0]),\n            \"h\": np.array([0.0, 1.0, 0.0]),\n            \"s0\": np.array([0.0, 0.0, 0.0]),\n        },\n        {\n            \"N\": 3,\n            \"A\": np.diag([1.0, 1.0, 1.0]),\n            \"g\": np.array([1.0, 1.0, 0.0]),\n            \"h\": np.array([0.0, 1.0, 1.0]),\n            \"s0\": np.array([0.5, -0.4, 0.1]),\n        },\n        {\n            \"N\": 4,\n            \"A\": np.diag([2.0, 1.5, 1.0, 0.5]),\n            \"g\": np.array([1.0, 0.0, 1.0, 0.0]),\n            \"h\": np.array([0.0, 1.0, 0.0, 1.0]),\n            \"s0\": np.array([0.0, 0.0, 0.0, 0.0]),\n        },\n        {\n            \"N\": 4,\n            \"A\": np.array([\n                [2.0, 0.2, 0.0, 0.0],\n                [0.2, 1.5, 0.1, 0.0],\n                [0.0, 0.1, 1.2, 0.05],\n                [0.0, 0.0, 0.05, 0.8]\n            ]),\n            \"g\": np.array([1.0, 1.0, 0.0, 0.0]),\n            \"h\": np.array([0.0, 1.0, 1.0, 0.0]),\n            \"s0\": np.array([0.1, -0.2, 0.3, -0.05]),\n        },\n    ]\n\n    results = []\n    tau = 1e-10\n\n    for case in test_cases:\n        N = case[\"N\"]\n        A = case[\"A\"]\n        # Ensure vectors are column vectors for consistent matrix algebra\n        g = case[\"g\"].reshape(N, 1)\n        h = case[\"h\"].reshape(N, 1)\n        s0 = case[\"s0\"].reshape(N, 1)\n        \n        # 1. Formulate and solve the KKT linear system.\n        # Constraint matrix C\n        C = np.vstack([g.T, h.T])\n\n        # KKT matrix (block matrix)\n        KKT_matrix = np.block([\n            [A, C.T],\n            [C, np.zeros((2, 2))]\n        ])\n        \n        # Right-hand side vector\n        rhs = np.vstack([-s0, np.zeros((2, 1))])\n        \n        # Solve for [x_star^T, lambda_star^T]^T\n        solution = np.linalg.solve(KKT_matrix, rhs)\n        x_star = solution[:N]\n\n        # 2. Evaluate the average-energy gradient at the MECI.\n        s_star = A @ x_star + s0\n\n        # 3. Construct the projection operator P_B.\n        # Form matrix G whose columns [g, h] span the branching plane.\n        G = np.hstack([g, h])\n        # Orthonormalize the columns of G via QR decomposition.\n        Q, _ = np.linalg.qr(G)\n        # Projector onto the branching plane B.\n        P_B = Q @ Q.T\n        \n        # 4. Compute the component of the gradient within the branching plane.\n        s_parallel_star = P_B @ s_star\n\n        # 5. Classify the MECI topology.\n        # As a check, s_star should already be in the branching plane,\n        # so norm(s_parallel_star) should equal norm(s_star).\n        norm_s_parallel = np.linalg.norm(s_parallel_star)\n\n        if norm_s_parallel > tau:\n            classification = 1  # Sloped\n        else:\n            classification = 0  # Peaked\n            \n        results.append(classification)\n        \n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2635932"}, {"introduction": "锥形交叉点的几何结构直接影响其后的核动力学过程。这项练习提供了一个具体的杜申斯基（Duschinsky）效应的例子，展示了基态和激发态的简正模式是如何混合的。通过计算一个“倾向因子”，您将能够量化初始沿着特定基态模式的运动如何有效地驱动系统发生非绝热跃迁[@problem_id:2635977]。", "problem": "考虑一个在质量加权笛卡尔坐标系中，通过线性振动耦合框架描述的双态锥形交叉。锥形交叉处的局域分支平面由梯度差向量 $\\mathbf{g}$ 和导数（非绝热）耦合向量 $\\mathbf{h}$ 张成，这两个向量被取为标准正交的：$|\\mathbf{g}| = 1$, $|\\mathbf{h}| = 1$, 且 $\\mathbf{g}\\cdot\\mathbf{h} = 0$。在这个二维子空间内，每个电子态都有一对标准正交的简正模，它们定义了其局域的调谐轴和耦合轴。\n\n在基态极小值点，分支平面内的两个归一化简正模方向由下式给出\n$$\n\\mathbf{Q}_{g1} = \\frac{\\sqrt{3}}{2}\\,\\mathbf{g} + \\frac{1}{2}\\,\\mathbf{h}, \n\\qquad\n\\mathbf{Q}_{g2} = -\\frac{1}{2}\\,\\mathbf{g} + \\frac{\\sqrt{3}}{2}\\,\\mathbf{h}.\n$$\n在激发态极小值点，分支平面内的两个归一化简正模方向为\n$$\n\\mathbf{Q}_{e1} = \\frac{1}{\\sqrt{5}}\\,\\mathbf{g} + \\frac{2}{\\sqrt{5}}\\,\\mathbf{h},\n\\qquad\n\\mathbf{Q}_{e2} = -\\frac{2}{\\sqrt{5}}\\,\\mathbf{g} + \\frac{1}{\\sqrt{5}}\\,\\mathbf{h}.\n$$\n\n仅使用分支平面和 Duschinsky 效应的基本定义，完成以下任务：\n- 构建 Duschinsky 旋转矩阵 $\\mathbf{J}$，该矩阵通过 $\\mathbf{Q}_{e} = \\mathbf{J}\\,\\mathbf{Q}_{g} + \\mathbf{K}$ 将分支平面内的基态简正模坐标 $(Q_{g1}, Q_{g2})$ 映射到激发态简正模坐标 $(Q_{e1}, Q_{e2})$，此变换仅限于分支平面，并忽略该平面内的位移向量 $\\mathbf{K}$。\n- 从 $\\mathbf{J}$ 中提取主 Duschinsky 旋转角 $\\theta$（取主值，满足 $0 \\le \\theta \\le \\pi$）。使用弧度制。\n- 在锥形交叉附近的线性振动耦合描述中，非对角耦合（diabatic coupling）沿 $\\mathbf{h}$ 坐标是线性的。在每个态的分支平面参考系中，将第二个简正模轴解释为该态的耦合轴。对于一个在基态上、初始核速度沿 $\\mathbf{Q}_{g1}$ 方向发射的波包，通过如下的无量纲倾向因子来量化其瞬时的非绝热驱动力\n$$\nF \\equiv \\left|\\mathbf{Q}_{e2}\\cdot \\mathbf{Q}_{g1}\\right|^{2}.\n$$\n\n将 $F$ 的最终值报告为一个无量纲数，并四舍五入到四位有效数字。", "solution": "题目要求计算一个与锥形交叉处的非绝热跃迁相关的无量纲倾向因子 $F$。这个计算需要构建 Duschinsky 旋转矩阵 $\\mathbf{J}$，该矩阵将二维分支平面内的基态简正模坐标映射到激发态简正模坐标。\n\n分支平面由两个标准正交向量定义，即梯度差向量 $\\mathbf{g}$ 和非绝热耦合向量 $\\mathbf{h}$，满足 $|\\mathbf{g}|=1$, $|\\mathbf{h}|=1$, 且 $\\mathbf{g} \\cdot \\mathbf{h}=0$。它们构成了该平面的一个基。\n\n该平面内的基态简正模由下式给出：\n$$\n\\mathbf{Q}_{g1} = \\frac{\\sqrt{3}}{2}\\,\\mathbf{g} + \\frac{1}{2}\\,\\mathbf{h}\n$$\n$$\n\\mathbf{Q}_{g2} = -\\frac{1}{2}\\,\\mathbf{g} + \\frac{\\sqrt{3}}{2}\\,\\mathbf{h}\n$$\n所给向量构成一个标准正交基，因为 $|\\mathbf{Q}_{g1}|^2 = (\\frac{\\sqrt{3}}{2})^2 + (\\frac{1}{2})^2 = \\frac{3}{4} + \\frac{1}{4} = 1$, $|\\mathbf{Q}_{g2}|^2 = (-\\frac{1}{2})^2 + (\\frac{\\sqrt{3}}{2})^2 = \\frac{1}{4} + \\frac{3}{4} = 1$, 且 $\\mathbf{Q}_{g1} \\cdot \\mathbf{Q}_{g2} = (\\frac{\\sqrt{3}}{2})(-\\frac{1}{2}) + (\\frac{1}{2})(\\frac{\\sqrt{3}}{2}) = 0$。\n\n该平面内的激发态简正模为：\n$$\n\\mathbf{Q}_{e1} = \\frac{1}{\\sqrt{5}}\\,\\mathbf{g} + \\frac{2}{\\sqrt{5}}\\,\\mathbf{h}\n$$\n$$\n\\mathbf{Q}_{e2} = -\\frac{2}{\\sqrt{5}}\\,\\mathbf{g} + \\frac{1}{\\sqrt{5}}\\,\\mathbf{h}\n$$\n这些向量也构成一个标准正交基，因为 $|\\mathbf{Q}_{e1}|^2 = (\\frac{1}{\\sqrt{5}})^2 + (\\frac{2}{\\sqrt{5}})^2 = \\frac{1}{5} + \\frac{4}{5} = 1$, $|\\mathbf{Q}_{e2}|^2 = (-\\frac{2}{\\sqrt{5}})^2 + (\\frac{1}{\\sqrt{5}})^2 = \\frac{4}{5} + \\frac{1}{5} = 1$, 且 $\\mathbf{Q}_{e1} \\cdot \\mathbf{Q}_{e2} = (\\frac{1}{\\sqrt{5}})(-\\frac{2}{\\sqrt{5}}) + (\\frac{2}{\\sqrt{5}})(\\frac{1}{\\sqrt{5}}) = 0$。\n\nDuschinsky 变换，忽略位移向量 $\\mathbf{K}$，为 $\\mathbf{Q}_{e} = \\mathbf{J}\\,\\mathbf{Q}_{g}$。Duschinsky 矩阵 $\\mathbf{J}$ 的元素由两个态的简正模向量的点积给出：$J_{ij} = \\mathbf{Q}_{ei} \\cdot \\mathbf{Q}_{gj}$。我们为分支平面内的简正模构建 $2 \\times 2$ 的矩阵 $\\mathbf{J}$。\n\n$\\mathbf{J}$ 的元素计算如下：\n$J_{11} = \\mathbf{Q}_{e1} \\cdot \\mathbf{Q}_{g1} = \\left(\\frac{1}{\\sqrt{5}}\\,\\mathbf{g} + \\frac{2}{\\sqrt{5}}\\,\\mathbf{h}\\right) \\cdot \\left(\\frac{\\sqrt{3}}{2}\\,\\mathbf{g} + \\frac{1}{2}\\,\\mathbf{h}\\right) = \\frac{\\sqrt{3}}{2\\sqrt{5}} + \\frac{2}{2\\sqrt{5}} = \\frac{2+\\sqrt{3}}{2\\sqrt{5}}$.\n$J_{12} = \\mathbf{Q}_{e1} \\cdot \\mathbf{Q}_{g2} = \\left(\\frac{1}{\\sqrt{5}}\\,\\mathbf{g} + \\frac{2}{\\sqrt{5}}\\,\\mathbf{h}\\right) \\cdot \\left(-\\frac{1}{2}\\,\\mathbf{g} + \\frac{\\sqrt{3}}{2}\\,\\mathbf{h}\\right) = -\\frac{1}{2\\sqrt{5}} + \\frac{2\\sqrt{3}}{2\\sqrt{5}} = \\frac{2\\sqrt{3}-1}{2\\sqrt{5}}$.\n$J_{21} = \\mathbf{Q}_{e2} \\cdot \\mathbf{Q}_{g1} = \\left(-\\frac{2}{\\sqrt{5}}\\,\\mathbf{g} + \\frac{1}{\\sqrt{5}}\\,\\mathbf{h}\\right) \\cdot \\left(\\frac{\\sqrt{3}}{2}\\,\\mathbf{g} + \\frac{1}{2}\\,\\mathbf{h}\\right) = -\\frac{2\\sqrt{3}}{2\\sqrt{5}} + \\frac{1}{2\\sqrt{5}} = \\frac{1-2\\sqrt{3}}{2\\sqrt{5}}$.\n$J_{22} = \\mathbf{Q}_{e2} \\cdot \\mathbf{Q}_{g2} = \\left(-\\frac{2}{\\sqrt{5}}\\,\\mathbf{g} + \\frac{1}{\\sqrt{5}}\\,\\mathbf{h}\\right) \\cdot \\left(-\\frac{1}{2}\\,\\mathbf{g} + \\frac{\\sqrt{3}}{2}\\,\\mathbf{h}\\right) = \\frac{2}{2\\sqrt{5}} + \\frac{\\sqrt{3}}{2\\sqrt{5}} = \\frac{2+\\sqrt{3}}{2\\sqrt{5}}$.\n\n因此，Duschinsky 矩阵为：\n$$\n\\mathbf{J} = \\begin{pmatrix} J_{11} & J_{12} \\\\ J_{21} & J_{22} \\end{pmatrix} = \\frac{1}{2\\sqrt{5}} \\begin{pmatrix} 2+\\sqrt{3} & 2\\sqrt{3}-1 \\\\ 1-2\\sqrt{3} & 2+\\sqrt{3} \\end{pmatrix}\n$$\n这是一个行列式为 $\\det(\\mathbf{J})=1$ 的正交矩阵，代表一个纯旋转。题目要求 Duschinsky 旋转角 $\\theta$ 在 $[0, \\pi]$ 区间内，它可以通过对角元素求得，即 $\\cos(\\theta) = J_{11}$。因此，$\\theta = \\arccos\\left(\\frac{2+\\sqrt{3}}{2\\sqrt{5}}\\right)$。\n\n主要目标是计算倾向因子 $F$，其定义为：\n$$\nF \\equiv \\left|\\mathbf{Q}_{e2}\\cdot \\mathbf{Q}_{g1}\\right|^{2}\n$$\n这个量恰好是矩阵元素 $J_{21}$ 大小的平方。\n$$\nF = (J_{21})^2 = \\left(\\frac{1-2\\sqrt{3}}{2\\sqrt{5}}\\right)^2\n$$\n我们进行计算：\n$$\nF = \\frac{(1-2\\sqrt{3})^2}{(2\\sqrt{5})^2} = \\frac{1^2 - 2(1)(2\\sqrt{3}) + (2\\sqrt{3})^2}{4 \\cdot 5} = \\frac{1 - 4\\sqrt{3} + 12}{20} = \\frac{13 - 4\\sqrt{3}}{20}\n$$\n这是 $F$ 的精确解析表达式。为了提供数值，我们代入 $\\sqrt{3} \\approx 1.7320508$：\n$$\nF = \\frac{13 - 4(1.7320508)}{20} = \\frac{13 - 6.9282032}{20} = \\frac{6.0717968}{20} \\approx 0.30358984\n$$\n按照要求将结果四舍五入到四位有效数字，我们得到：\n$$\nF \\approx 0.3036\n$$\n这个因子 $F$ 量化了沿基态模式 $\\mathbf{Q}_{g1}$ 的运动在激发态耦合模式 $\\mathbf{Q}_{e2}$ 上的投影，为非绝热跃迁的初始驱动力提供了一个度量。", "answer": "$$\n\\boxed{0.3036}\n$$", "id": "2635977"}, {"introduction": "模拟非绝热动力学极具挑战性，而常用的近似方法有时会得出完全错误的结果。这个问题展示了一个经典场景：流行的埃伦费斯特（Ehrenfest）平均场方法由于对称性赝象（symmetry artifact）而错误地预测了零布居数转移。通过完成这个例子[@problem_id:2635996]，您将对平均场理论的局限性以及描述波包分裂的更高级方法的必要性获得批判性的洞察。", "problem": "考虑一个在绝热表象下描述的非绝热动力学的一维双态模型，其核坐标为 $x$，质量为 $M$。绝热电子能量为常数，并由一个非零的能隙分开，$E_{1}(x) = \\Delta/2$ 和 $E_{2}(x) = -\\Delta/2$，其中 $\\Delta > 0$。非绝热导数耦合是一个偶的、局域化的函数 $d_{12}(x) = d_{0}\\exp\\!\\big(-x^{2}/\\sigma^{2}\\big)$，其中 $d_{0} > 0$ 且 $\\sigma > 0$。绝热基下的耦合 Ehrenfest 方程采用其标准形式：电子振幅 $\\{c_{1}(t),c_{2}(t)\\}$ 满足\n$$\ni\\hbar\\,\\dot{c}_{j}(t) \\;=\\; E_{j}\\!\\big(x(t)\\big)\\,c_{j}(t) \\;-\\; i\\hbar\\,\\sum_{k=1}^{2}\\dot{x}(t)\\,d_{jk}\\!\\big(x(t)\\big)\\,c_{k}(t),\n$$\n其中 $d_{21}(x) = -d_{12}(x)$ 且 $d_{11}(x)=d_{22}(x)=0$，而经典核自由度遵循平均场力定律\n$$\nM\\,\\ddot{x}(t) \\;=\\; -\\sum_{j=1}^{2} |c_{j}(t)|^{2}\\,\\nabla E_{j}\\!\\big(x(t)\\big) \\;-\\; 2\\,\\Re\\!\\Big(c_{1}^{*}(t)c_{2}(t)\\Big)\\,\\big(E_{2}-E_{1}\\big)\\,d_{12}\\!\\big(x(t)\\big).\n$$\n给定一个在 $t=0$ 时对称的、反向传播的核系综，它由两个等权重的窄波束组成：一个中心在 $x(0)=-L$，速度为 $+v$；另一个中心在 $x(0)=+L$，速度为 $-v$，其中 $L>0$ 且 $v>0$。在两个波束中，电子态都制备在绝热态 $1$ 上，即 $c_{1}(0)=1$ 且 $c_{2}(0)=0$。一个常见但违反对称性的建模简化是用单一的 Ehrenfest 轨道来代替这个系综，该轨道在系综的平均值处初始化，$x(0)=0$，$\\dot{x}(0)=0$，并具有相同的电子振幅 $c_{1}(0)=1$， $c_{2}(0)=0$。假设除了上述模型所蕴含的力之外没有其他外力，并取一个足够大的最终时间 $T$，使得如果单独处理，两个波束都已完全穿过非绝热相互作用区域，即 $T \\gg L/v$。\n\n仅使用上面给出的方程和定义，确定单一 Ehrenfest 轨道预测的到时间 $T$ 时转移到绝热态 $2$ 的净布居数，即 $\\Delta P_{2}^{\\mathrm{EF}}(T) \\equiv |c_{2}(T)|^{2} - |c_{2}(0)|^{2}$，并将其表示为关于给定参数的闭合形式解析表达式。以单个数字或不带单位的表达式形式给出你的最终答案。\n\n不要进行任何舍入；提供精确结果。此外，简要指出至少一种可以打破这种构造中对称性赝像的平均场动力学的有原则的修正方法，但不要用它进行计算。", "solution": "所述问题是适定的，在半经典动力学框架内具有科学依据，并且不包含任何矛盾或歧义。它描述了一个标准的、尽管简化的模型，可以为其推导出一个唯一的解。问题的核心是分析 Ehrenfest 平均场方程在一组特定的高对称性初始条件下的行为。我们将进行推导。\n\n系统的动力学由关于核坐标 $x(t)$ 和电子振幅 $c_{1}(t)$、$c_{2}(t)$ 的一组耦合微分方程控制。我们首先分析核的运动方程：\n$$\nM\\,\\ddot{x}(t) \\;=\\; -\\sum_{j=1}^{2} |c_{j}(t)|^{2}\\,\\nabla E_{j}\\!\\big(x(t)\\big) \\;-\\; 2\\,\\Re\\!\\Big(c_{1}^{*}(t)c_{2}(t)\\Big)\\,\\big(E_{2}(t)-E_{1}(t)\\big)\\,d_{12}\\!\\big(x(t)\\big)\n$$\n右边的第一项代表平均场力，也称为 Hellmann-Feynman 力。绝热势能面被给定为常数：$E_{1}(x) = \\frac{\\Delta}{2}$ 和 $E_{2}(x) = -\\frac{\\Delta}{2}$。因此，它们相对于核坐标 $x$ 的梯度为零：\n$$\n\\nabla E_{1}(x) = \\frac{d}{dx}\\left(\\frac{\\Delta}{2}\\right) = 0\n$$\n$$\n\\nabla E_{2}(x) = \\frac{d}{dx}\\left(-\\frac{\\Delta}{2}\\right) = 0\n$$\n因此，平均场力项在所有时间上恒为零：\n$$\n-\\sum_{j=1}^{2} |c_{j}(t)|^{2}\\,\\nabla E_{j}\\!\\big(x(t)\\big) = -|c_{1}(t)|^{2}(0) - |c_{2}(t)|^{2}(0) = 0\n$$\n右边的第二项涉及能量差 $E_{2}-E_{1} = -\\frac{\\Delta}{2} - \\frac{\\Delta}{2} = -\\Delta$。因此，核运动方程大大简化为：\n$$\nM\\,\\ddot{x}(t) = -2\\,\\Re\\!\\Big(c_{1}^{*}(t)c_{2}(t)\\Big)\\,(-\\Delta)\\,d_{12}(x(t)) = 2\\Delta\\,\\Re\\!\\Big(c_{1}^{*}(t)c_{2}(t)\\Big)\\,d_{12}(x(t))\n$$\n该方程表明，作用在核上的唯一力来自非绝热耦合，并且与电子相干性的实部 $\\Re(c_{1}^{*}c_{2})$ 成正比。\n\n接下来，我们考察电子振幅的方程：\n$$\ni\\hbar\\,\\dot{c}_{1}(t) \\;=\\; E_{1}\\,c_{1}(t) - i\\hbar\\,\\dot{x}(t)\\,d_{12}(x(t))\\,c_{2}(t)\n$$\n$$\ni\\hbar\\,\\dot{c}_{2}(t) \\;=\\; E_{2}\\,c_{2}(t) - i\\hbar\\,\\dot{x}(t)\\,d_{21}(x(t))\\,c_{1}(t) \\;=\\; E_{2}\\,c_{2}(t) + i\\hbar\\,\\dot{x}(t)\\,d_{12}(x(t))\\,c_{1}(t)\n$$\n这些方程表明，电子态之间的布居数转移（即 $|c_{j}(t)|^2$ 的变化）是由核速度 $\\dot{x}(t)$ 通过非绝热耦合项驱动的。\n\n我们现在应用单一 Ehrenfest 轨道的指定初始条件：$x(0)=0$, $\\dot{x}(0)=0$, $c_{1}(0)=1$, 和 $c_{2}(0)=0$。\n\n让我们评估系统在初始时刻 $t=0$ 的状态。\n在 $t=0$ 时作用在核上的力是：\n$$\nM\\,\\ddot{x}(0) = 2\\Delta\\,\\Re\\!\\Big(c_{1}^{*}(0)c_{2}(0)\\Big)\\,d_{12}(x(0)) = 2\\Delta\\,\\Re\\!\\Big(1 \\cdot 0\\Big)\\,d_{12}(0) = 0\n$$\n由于质量 $M$ 非零，初始加速度为 $\\ddot{x}(0) = 0$。\n\n在 $t=0$ 时振幅 $c_{2}$ 的时间导数是：\n$$\ni\\hbar\\,\\dot{c}_{2}(0) = E_{2}\\,c_{2}(0) + i\\hbar\\,\\dot{x}(0)\\,d_{12}(x(0))\\,c_{1}(0) = \\left(-\\frac{\\Delta}{2}\\right)(0) + i\\hbar\\,(0)\\,d_{12}(0)\\,(1) = 0\n$$\n这意味着 $\\dot{c}_{2}(0) = 0$。\n\n我们已经确定，在 $t=0$ 时，核粒子处于静止状态（$\\dot{x}(0)=0$）并且不受任何力（$\\ddot{x}(0)=0$）。此外，态 $2$ 的布居数为零（$c_{2}(0)=0$），其初始变化率也为零（$\\dot{c}_{2}(0)=0$）。\n这构成了整个动力学的一个不动点。由于没有初始速度和初始力，核将不会离开其初始位置：对于所有 $t \\ge 0$，$x(t) = 0$。因此，核速度和加速度在所有时间上都为零，$\\dot{x}(t) = 0$ 和 $\\ddot{x}(t) = 0$。\n\n当 $\\dot{x}(t) = 0$ 对所有时间成立时，电子运动方程变为非耦合的：\n$$\ni\\hbar\\,\\dot{c}_{1}(t) = E_{1}\\,c_{1}(t) = \\frac{\\Delta}{2}c_{1}(t)\n$$\n$$\ni\\hbar\\,\\dot{c}_{2}(t) = E_{2}\\,c_{2}(t) = -\\frac{\\Delta}{2}c_{2}(t)\n$$\n在初始条件 $c_{2}(0)=0$ 下，$c_{2}(t)$ 的解是平凡的：\n$$\nc_{2}(t) = c_{2}(0)\\exp\\left(\\frac{-iE_{2}t}{\\hbar}\\right) = 0 \\cdot \\exp\\left(\\frac{i\\Delta t}{2\\hbar}\\right) = 0\n$$\n因此，第二个绝热态的布居数 $|c_{2}(t)|^{2}$ 在所有时间 $t$ 上都保持为零。\n\n问题要求到时间 $T$ 时转移到绝热态 $2$ 的净布居数，即 $\\Delta P_{2}^{\\mathrm{EF}}(T) = |c_{2}(T)|^{2} - |c_{2}(0)|^{2}$。\n代入我们的发现：\n$$\n\\Delta P_{2}^{\\mathrm{EF}}(T) = |0|^{2} - |0|^{2} = 0\n$$\n这个结果是 Ehrenfest 平均场动力学的一个已知赝像。代表对称系综平均值的单一轨道由于平均力为零而被困在高对称性点。它未能捕捉到核波包的组分穿过耦合区域导致布居数转移的物理过程。\n\n关于打破这种对称性赝像的有原则的修正方法：需要使用多个耦合函数基来表示核波包的方法。一个主要的例子是**基于高斯波包的轨迹量子动力学**，例如**从头算多重增殖 (Ab Initio Multiple Spawning, AIMS)** 或**变分多组态高斯 (Variational Multiconfigurational Gaussian, vMCG)**。在这些方法中，核波函数是耦合高斯基函数的线性组合。即使初始波包中心在 $x=0$ 且平均动量为零，非零的非绝热耦合也可以诱导新的高斯基函数“增殖”到另一个电子态上。这些新的基函数随后在它们各自势能面的力作用下演化，正确地描述了核波包的分裂和随后的布居数转移，从而打破了平均场描述的对称性。另一个有效的例子是**精确分解 (Exact Factorization)** 方法，它在核动力学中引入一个量子势项，防止系统被困在此类对称性点。", "answer": "$$\n\\boxed{0}\n$$", "id": "2635996"}]}