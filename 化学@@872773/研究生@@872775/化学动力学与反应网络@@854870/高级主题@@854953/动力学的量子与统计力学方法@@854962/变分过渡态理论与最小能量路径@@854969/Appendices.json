{"hands_on_practices": [{"introduction": "在研究反应路径之前，我们必须首先理解其发生的“地图”——势能面（PES）。本练习将引导你完成定位关键地标的基本过程：稳定态（反应物/产物）和过渡态，它们分别对应于势能面上的局域最小值和一阶鞍点。这是任何反应动力学研究的第一步，通过对一个二维模型势能面的分析，你将掌握识别这些驻点并计算反应能垒的核心数学技能 [@problem_id:2693873]。", "problem": "一个二维模型势能面 (PES) 由定义在 $\\mathbb{R}^2$ 上的标量场 $V(x,y)$ 给出，其表达式为 $V(x,y)=x^{4}-2x^{2}+y^{2}+\\frac{1}{2}xy$。在变分过渡态理论 (VTST) 中，过渡态与最小能量路径 (MEP) 上的指数为1的鞍点相关联，而局域极小值点对应于势阱。从驻点满足 $\\nabla V=\\mathbf{0}$ 以及黑塞矩阵 $H$ 通过其特征值的符号决定局域曲率并进行分类这些基本定义出发，完成以下任务：\n\n1. 通过求解 $\\frac{\\partial V}{\\partial x}=0$ 和 $\\frac{\\partial V}{\\partial y}=0$ 来确定 $V$ 的所有驻点 $(x^{\\ast},y^{\\ast})$。\n2. 对每个驻点，计算其黑塞矩阵 $H$ 并根据 $H$ 的特征值符号对该点进行分类（局域极小值点，指数为1的鞍点）。\n3. 识别连接两个极小值点的最小能量路径 (MEP) 上的指数为1的鞍点。利用该点计算能垒高度 $\\Delta V$，其定义为差值 $V(x_{\\text{s}},y_{\\text{s}})-V(x_{\\text{m}},y_{\\text{m}})$，其中 $(x_{\\text{s}},y_{\\text{s}})$ 是该鞍点，而 $(x_{\\text{m}},y_{\\text{m}})$ 是第2步中两个对称相关的极小值点中的任意一个。\n\n将能垒高度 $\\Delta V$ 的最终答案表示为给定势能面的约化能量单位下的一个精确有理数（无近似值）（无物理单位）。你的最终答案必须是单个数值。", "solution": "该问题要求对由 $V(x,y)=x^{4}-2x^{2}+y^{2}+\\frac{1}{2}xy$ 给出的势能面 (PES) 进行彻底分析。按照要求，分析分三个阶段进行：首先，找出所有驻点；其次，对这些点进行分类；第三，计算势阱之间跃迁的能垒。\n\n第1步：确定驻点\n\n标量场 $V(x,y)$ 的驻点 $(x^{\\ast},y^{\\ast})$ 必须满足场梯度为零的条件，即 $\\nabla V(x^{\\ast},y^{\\ast})=\\mathbf{0}$。这对应于一个由两个方程组成的方程组：\n$$ \\frac{\\partial V}{\\partial x} = 0 $$\n$$ \\frac{\\partial V}{\\partial y} = 0 $$\n首先，我们计算给定势能 $V(x,y)$ 的偏导数：\n$$ \\frac{\\partial V}{\\partial x} = \\frac{\\partial}{\\partial x} (x^{4}-2x^{2}+y^{2}+\\frac{1}{2}xy) = 4x^{3} - 4x + \\frac{1}{2}y $$\n$$ \\frac{\\partial V}{\\partial y} = \\frac{\\partial}{\\partial y} (x^{4}-2x^{2}+y^{2}+\\frac{1}{2}xy) = 2y + \\frac{1}{2}x $$\n将它们设为零，得到方程组：\n$$ 4x^{3} - 4x + \\frac{1}{2}y = 0 \\quad (1) $$\n$$ 2y + \\frac{1}{2}x = 0 \\quad (2) $$\n由方程 $(2)$，我们可以用 $x$ 表示 $y$：\n$$ 2y = -\\frac{1}{2}x \\implies y = -\\frac{1}{4}x $$\n将这个 $y$ 的表达式代入方程 $(1)$：\n$$ 4x^{3} - 4x + \\frac{1}{2}(-\\frac{1}{4}x) = 0 $$\n$$ 4x^{3} - 4x - \\frac{1}{8}x = 0 $$\n$$ 4x^{3} - (\\frac{32}{8} + \\frac{1}{8})x = 0 $$\n$$ 4x^{3} - \\frac{33}{8}x = 0 $$\n将 $x$ 因子提出：\n$$ x(4x^{2} - \\frac{33}{8}) = 0 $$\n该方程对 $x$ 有三个可能的解：\n1. $x = 0$\n2. $4x^{2} = \\frac{33}{8} \\implies x^{2} = \\frac{33}{32} \\implies x = \\pm\\sqrt{\\frac{33}{32}} = \\pm\\frac{\\sqrt{33}}{4\\sqrt{2}} = \\pm\\frac{\\sqrt{66}}{8}$\n\n我们使用 $y = -\\frac{1}{4}x$ 找出每个 $x$ 对应的 $y$ 值：\n- 对于 $x_0 = 0$：$y_0 = -\\frac{1}{4}(0) = 0$。第一个驻点是 $P_0 = (0,0)$。\n- 对于 $x_1 = \\sqrt{\\frac{33}{32}}$：$y_1 = -\\frac{1}{4}\\sqrt{\\frac{33}{32}}$。第二个驻点是 $P_1 = (\\sqrt{\\frac{33}{32}}, -\\frac{1}{4}\\sqrt{\\frac{33}{32}})$。\n- 对于 $x_2 = -\\sqrt{\\frac{33}{32}}$：$y_2 = -\\frac{1}{4}(-\\sqrt{\\frac{33}{32}}) = \\frac{1}{4}\\sqrt{\\frac{33}{32}}$。第三个驻点是 $P_2 = (-\\sqrt{\\frac{33}{32}}, \\frac{1}{4}\\sqrt{\\frac{33}{32}})$。\n\n第2步：驻点的分类\n\n这些驻点的分类由在每个点上计算的黑塞矩阵 $H$ 的定性决定。黑塞矩阵是二阶偏导数矩阵：\n$$ H(x,y) = \\begin{pmatrix} \\frac{\\partial^2 V}{\\partial x^2}  \\frac{\\partial^2 V}{\\partial x \\partial y} \\\\ \\frac{\\partial^2 V}{\\partial y \\partial x}  \\frac{\\partial^2 V}{\\partial y^2} \\end{pmatrix} $$\n所需的二阶偏导数是：\n$$ \\frac{\\partial^2 V}{\\partial x^2} = \\frac{\\partial}{\\partial x} (4x^{3} - 4x + \\frac{1}{2}y) = 12x^{2} - 4 $$\n$$ \\frac{\\partial^2 V}{\\partial y^2} = \\frac{\\partial}{\\partial y} (2y + \\frac{1}{2}x) = 2 $$\n$$ \\frac{\\partial^2 V}{\\partial x \\partial y} = \\frac{\\partial}{\\partial x} (2y + \\frac{1}{2}x) = \\frac{1}{2} $$\n所以黑塞矩阵是：\n$$ H(x,y) = \\begin{pmatrix} 12x^{2} - 4  \\frac{1}{2} \\\\ \\frac{1}{2}  2 \\end{pmatrix} $$\n我们现在在每个驻点处计算该矩阵。点的性质由 $H$ 的特征值的符号决定。这可以通过行列式 $\\det(H)$ 和迹 $\\text{tr}(H)$ 来评估。如果 $\\det(H)  0$，特征值异号，表示为鞍点。如果 $\\det(H)  0$，特征值同号；如果 $\\text{tr}(H)  0$，则两者均为正（局域极小值点），如果 $\\text{tr}(H)  0$，则两者均为负（局域极大值点）。\n\n- 在点 $P_0 = (0,0)$ 处：\n$$ H(0,0) = \\begin{pmatrix} 12(0)^{2} - 4  \\frac{1}{2} \\\\ \\frac{1}{2}  2 \\end{pmatrix} = \\begin{pmatrix} -4  \\frac{1}{2} \\\\ \\frac{1}{2}  2 \\end{pmatrix} $$\n$$ \\det(H(0,0)) = (-4)(2) - (\\frac{1}{2})(\\frac{1}{2}) = -8 - \\frac{1}{4} = -\\frac{33}{4} $$\n由于行列式为负，特征值符号相反。因此，$P_0 = (0,0)$ 是一个指数为1的鞍点（一个过渡态）。\n\n- 在点 $P_1$ 和 $P_2$ 处：\n对于这两个点，$x^{2} = \\frac{33}{32}$。因此，两者的黑塞矩阵是相同的。\n$$ \\frac{\\partial^2 V}{\\partial x^2} = 12(\\frac{33}{32}) - 4 = \\frac{3 \\cdot 33}{8} - 4 = \\frac{99}{8} - \\frac{32}{8} = \\frac{67}{8} $$\n$$ H(P_{1,2}) = \\begin{pmatrix} \\frac{67}{8}  \\frac{1}{2} \\\\ \\frac{1}{2}  2 \\end{pmatrix} $$\n$$ \\det(H(P_{1,2})) = (\\frac{67}{8})(2) - (\\frac{1}{2})(\\frac{1}{2}) = \\frac{67}{4} - \\frac{1}{4} = \\frac{66}{4} = \\frac{33}{2} $$\n$$ \\text{tr}(H(P_{1,2})) = \\frac{67}{8} + 2 = \\frac{67}{8} + \\frac{16}{8} = \\frac{83}{8} $$\n由于 $\\det(H)  0$ 且 $\\text{tr}(H)  0$，两个特征值都为正。因此，点 $P_1$ 和 $P_2$ 都是局域极小值点。\n\n第3步：计算能垒高度\n\n问题陈述最小能量路径 (MEP) 连接两个极小值点。我们已经找到了两个这样的极小值点，$P_1$ 和 $P_2$。此路径上的过渡态必须是一个指数为1的鞍点。我们只找到了一个这样的点，$P_0=(0,0)$。这必定是连接两个势阱的反应的过渡态。因此，鞍点的坐标是 $(x_s, y_s) = (0,0)$。极小值点的坐标是 $(x_m, y_m)$，可以是 $P_1$ 或 $P_2$。我们选择 $P_1$。\n\n能垒高度 $\\Delta V$ 定义为鞍点与其中一个极小值点之间的势能差：\n$$ \\Delta V = V(x_s, y_s) - V(x_m, y_m) $$\n首先，计算鞍点 $(x_s, y_s)=(0,0)$ 处的势能：\n$$ V(0,0) = (0)^{4} - 2(0)^{2} + (0)^{2} + \\frac{1}{2}(0)(0) = 0 $$\n接下来，计算一个极小值点处的势能，例如使用 $P_1$ 的坐标，其中 $x_m^2 = \\frac{33}{32}$ 且 $y_m = -\\frac{1}{4}x_m$：\n$$ V(x_m, y_m) = x_m^{4} - 2x_m^{2} + y_m^{2} + \\frac{1}{2}x_m y_m $$\n代入 $y_m = -\\frac{1}{4}x_m$：\n$$ V(x_m, y_m) = x_m^{4} - 2x_m^{2} + (-\\frac{1}{4}x_m)^{2} + \\frac{1}{2}x_m(-\\frac{1}{4}x_m) $$\n$$ V(x_m, y_m) = x_m^{4} - 2x_m^{2} + \\frac{1}{16}x_m^{2} - \\frac{1}{8}x_m^{2} $$\n$$ V(x_m, y_m) = x_m^{4} - (\\frac{32}{16} - \\frac{1}{16} + \\frac{2}{16})x_m^{2} = x_m^{4} - \\frac{33}{16}x_m^{2} $$\n现在代入 $x_m^2 = \\frac{33}{32}$ 的值：\n$$ V(x_m, y_m) = (x_m^2)^2 - \\frac{33}{16}x_m^2 = (\\frac{33}{32})^2 - \\frac{33}{16}(\\frac{33}{32}) $$\n$$ V(x_m, y_m) = \\frac{33^2}{32^2} - \\frac{33^2}{16 \\cdot 32} = \\frac{1089}{1024} - \\frac{1089}{512} $$\n$$ V(x_m, y_m) = \\frac{1089}{1024} - \\frac{2 \\cdot 1089}{1024} = -\\frac{1089}{1024} $$\n由于势能相对于变换 $(x,y) \\rightarrow (-x,-y)$ 具有对称性，两个极小值点处的势能是相同的。\n\n最后，能垒高度 $\\Delta V$ 为：\n$$ \\Delta V = V(0,0) - V(x_m, y_m) = 0 - (-\\frac{1089}{1024}) = \\frac{1089}{1024} $$\n该值是所要求的精确有理数。", "answer": "$$\\boxed{\\frac{1089}{1024}}$$", "id": "2693873"}, {"introduction": "在确定了反应路径的起点（反应物）、终点（产物）和最高点（鞍点）之后，下一个合理的步骤是描绘连接它们的最有效路径。本练习将深入探讨“内禀反应坐标”（IRC）或“最小能量路径”（MEP）的概念，即从鞍点出发的最陡下降路径。你将学习如何建立并数值求解定义这条路径的微分方程，这是计算化学中的一项核心技能 [@problem_id:2693839]。", "problem": "考虑一个由标量函数 $V:\\mathbb{R}^2 \\to \\mathbb{R}$ 定义的二维势能面，其表达式为\n$$\nV(x,y) = \\frac{1}{4}\\left(x^2 - 1\\right)^2 + 0.5\\,y^2 + 0.2\\,x\\,y.\n$$\n在最小能量路径和变分过渡态理论 (VTST) 的背景下，内禀反应坐标 (IRC) 是 $V$ 在质量加权坐标下的最陡下降曲线。设质量矩阵为对角矩阵 $M = \\mathrm{diag}(m_x,m_y)$，其对角元 $m_x,m_y \\in \\mathbb{R}_{0}$ 均为严格正数。我们感兴趣的鞍点是 $R^\\ddagger=(x^\\ddagger,y^\\ddagger)=(0,0)$。\n\n你的任务是：\n\n$1.$ 仅从以下原理和定义出发：\n- $V$ 的梯度，记为 $\\nabla_R V(R)$，其中 $R=(x,y)$，\n- 质量加权坐标变换 $q = M^{1/2} R$，\n- 最小能量路径是在每个点都与质量加权度量下 $V$ 的最陡下降方向相切的单位速度曲线这一概念，\n推导IRC所满足的以笛卡尔坐标 $R(s)$ 表示的一阶常微分方程 (ODE)，其中 $s$ 是质量加权弧长参数。你的推导必须明确体现对质量矩阵 $M$ 的依赖性，并且不得假设任何已知的IRC公式。\n\n$2.$ 通过构建并求解相应的特征值问题来确定 $R^\\ddagger$ 处的非稳定模式（负曲率方向），从而确定从鞍点 $R^\\ddagger$ 开始积分IRC的初始方向。使用 $V$ 在 $R^\\ddagger$ 处的Hessian矩阵，并以有原则的方式考虑质量。说明如何归一化初始方向。\n\n$3.$ 提出一个至少4阶的具体数值积分算法，用于积分任务1中得到的ODE，包括基于梯度质量加权范数和最大弧长的精确停止准则。你的算法必须通过选择初始位移的符号来处理沿非稳定模式从鞍点向左和向右的两种偏离，以靶向特定的吸引盆。你必须从 $R(0)=R^\\ddagger \\pm \\varepsilon\\,v$ 开始积分，其中 $v$ 是在任务2中获得的归一化非稳定特征向量，$\\varepsilon0$ 是一个很小的标量。\n\n$4.$ 将你的算法实现为一个完整的程序，为以下每个测试用例计算IRC终点，从 $R^\\ddagger=(0,0)$ 开始积分，直到质量加权梯度范数低于容差或弧长超过指定的最大值：\n- 测试A（左侧最小值）：$m_x=1$，$m_y=1$，$\\varepsilon=10^{-3}$，步长 $\\Delta s=0.05$，最大弧长 $s_{\\max}=6.0$，当质量加权梯度范数小于 $10^{-8}$ 时终止。选择初始位移的符号，使得 $x$ 初始时从0减小。\n- 测试B（右侧最小值）：$m_x=1$，$m_y=1$，$\\varepsilon=10^{-3}$，步长 $\\Delta s=0.05$，最大弧长 $s_{\\max}=6.0$，当质量加权梯度范数小于 $10^{-8}$ 时终止。选择初始位移的符号，使得 $x$ 初始时从0增大。\n- 测试C（各向异性质量下的左侧最小值）：$m_x=2.0$，$m_y=0.5$，$\\varepsilon=10^{-3}$，步长 $\\Delta s=0.03$，最大弧长 $s_{\\max}=6.0$，当质量加权梯度范数小于 $10^{-8}$ 时终止。选择初始位移的符号，使得 $x$ 初始时从0减小。\n\n所有坐标均视为无量纲。以无量纲单位表示每个最终坐标。\n\n$5.$ 程序输出规范：你的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表形式的结果。该列表必须按顺序包含测试A、测试B和测试C的最终坐标，每对坐标都四舍五入到小数点后恰好六位数字。具体格式必须是\n$$\n[\\;x_A,\\;y_A,\\;x_B,\\;y_B,\\;x_C,\\;y_C\\;],\n$$\n其中每个 $x_\\bullet,y_\\bullet$ 都以无量纲单位报告，并四舍五入到六位小数。\n\n注释和要求：\n- 程序不得读取任何输入。程序必须是自包含的。\n- ODE、特征向量归一化和步长选择必须如上所述从第一性原理推导。\n- 为覆盖率而设计：测试A检查对称质量情况下朝向左侧最小值的情况，测试B在相同的数值控制下检查相反方向，测试C测试对各向异性质量的敏感性。你的算法必须足够鲁棒，以在规定的限制内对每种情况都达到一个最小值的吸引盆。", "solution": "该问题是计算化学动力学中一个关于确定最小能量路径（MEP，亦称内禀反应坐标，IRC）的适定且有科学依据的练习。该问题是有效的，并将按其陈述进行求解。求解过程分为三部分：首先，推导IRC的控制微分方程；其次，确定从鞍点开始积分的初始条件；第三，详述用于解决该问题的数值算法。\n\n势能面由函数 $V(x,y) = \\frac{1}{4}\\left(x^2 - 1\\right)^2 + 0.5\\,y^2 + 0.2\\,x\\,y$ 给出。在笛卡尔坐标 $R=(x,y)$ 下的梯度向量为 $\\nabla_R V(R) = \\begin{pmatrix} x(x^2-1) + 0.2y \\\\ y + 0.2x \\end{pmatrix}$。Hessian矩阵为 $H(R) = \\begin{pmatrix} 3x^2-1  0.2 \\\\ 0.2  1 \\end{pmatrix}$。在指定的鞍点 $R^\\ddagger = (0,0)$，梯度 $\\nabla_R V(0,0)$ 为零，Hessian矩阵为 $H(0,0) = \\begin{pmatrix} -1  0.2 \\\\ 0.2  1 \\end{pmatrix}$，该矩阵有一个负特征值和一个正特征值，证实了其鞍点性质。\n\n$1.$ 内禀反应坐标ODE的推导\n\nIRC被定义为从势能面上的鞍点出发的最陡下降路径，由质量加权弧长 $s$ 参数化。这种下降被视为“最陡”的坐标系是质量加权坐标系，由变换 $q = M^{1/2} R$ 定义，其中 $R=(x,y)$ 是笛卡尔坐标，$M=\\mathrm{diag}(m_x, m_y)$ 是对角质量矩阵。\n\n势 $V$ 在点 $q$ 处的最陡下降方向由质量加权坐标下梯度的负值给出，即 $-\\nabla_q V$。对于由弧长 $s$ 参数化的曲线 $q(s)$，其切向量 $\\frac{dq}{ds}$ 具有单位范数。因此，IRC方程通过将单位切向量与最陡下降方向对齐来定义：\n$$\n\\frac{dq(s)}{ds} = -\\frac{\\nabla_q V}{\\|\\nabla_q V\\|_2}\n$$\n为了在原始笛卡尔坐标 $R(s)$ 中求解此方程，我们必须变换该方程。左侧变换如下：\n$$\n\\frac{dq}{ds} = \\frac{d}{ds}(M^{1/2} R) = M^{1/2} \\frac{dR}{ds}\n$$\n梯度 $\\nabla_q V$ 通过链式法则与笛卡尔梯度 $\\nabla_R V$ 相关联。第 $i$ 个分量为：\n$$\n(\\nabla_q V)_i = \\frac{\\partial V}{\\partial q_i} = \\sum_{j} \\frac{\\partial V}{\\partial R_j} \\frac{\\partial R_j}{\\partial q_i}\n$$\n由于 $R = M^{-1/2} q$，或 $R_j = m_j^{-1/2} q_j$，雅可比矩阵元素为 $\\frac{\\partial R_j}{\\partial q_i} = \\delta_{ij} m_j^{-1/2}$。代入此式得：\n$$\n(\\nabla_q V)_i = m_i^{-1/2} (\\nabla_R V)_i \\quad \\implies \\quad \\nabla_q V = M^{-1/2} \\nabla_R V\n$$\n分母中的范数，我们记为 $g_{mw}$，是质量加权梯度范数：\n$$\ng_{mw} = \\|\\nabla_q V\\|_2 = \\sqrt{(\\nabla_q V)^T(\\nabla_q V)} = \\sqrt{(M^{-1/2} \\nabla_R V)^T (M^{-1/2} \\nabla_R V)} = \\sqrt{(\\nabla_R V)^T M^{-1} (\\nabla_R V)}\n$$\n组合变换后的分量得到：\n$$\nM^{1/2} \\frac{dR}{ds} = -\\frac{M^{-1/2} \\nabla_R V}{g_{mw}}\n$$\n从左侧乘以 $M^{-1/2}$ 以分离出 $\\frac{dR}{ds}$：\n$$\n\\frac{dR}{ds} = - \\frac{M^{-1} \\nabla_R V(R)}{\\sqrt{(\\nabla_R V(R))^T M^{-1} (\\nabla_R V(R))}}\n$$\n这就是以笛卡尔坐标表示的IRC $R(s)$ 的一阶常微分方程。\n\n$2.$ 从鞍点出发的初始方向\n\nIRC的ODE在鞍点 $R^\\ddagger$ 处是奇异的，因为在该点 $\\nabla_R V = 0$，从而 $g_{mw}=0$。因此，积分必须从一个稍微偏离 $R^\\ddagger$ 的点开始。此位移的正确方向是沿着系统在鞍点处的非稳定模式。该模式对应于势能面在质量加权坐标下的负曲率方向。\n\n曲率由Hessian矩阵描述。质量加权坐标下的Hessian矩阵 $H^q$ 通过以下变换与笛卡尔Hessian矩阵 $H$ 相关：\n$$\nH^q = M^{-1/2} H M^{-1/2}\n$$\nIRC的初始方向由 $H^q$ 对应于其唯一负特征值 $\\lambda_{unstable}  0$ 的特征向量 $u_{unstable}$ 给出。我们在 $R^\\ddagger$ 处求解特征值问题：\n$$\nH^q(R^\\ddagger) u = \\lambda u\n$$\n特征向量 $u_{unstable}$ 是在质量加权坐标下获得的，必须归一化为单位长度，即 $\\|u_{unstable}\\|_2 = 1$。为了找到笛卡尔坐标下的相应位移向量 $v$，我们应用逆坐标变换：\n$$\nv = M^{-1/2} u_{unstable}\n$$\n这个向量 $v$ 指定了初始方向。积分从 $R_{start} = R^\\ddagger \\pm \\varepsilon v$ 开始，其中 $\\varepsilon$ 是一个小标量。选择符号以将路径引向左侧（$x0$）或右侧（$x0$）的势能最小值。具体来说，为位移 $p \\varepsilon v$ 选择符号乘子 $p \\in \\{-1, 1\\}$，使得起始点 $(R_{start})_x$ 的 $x$ 分量具有期望的符号。\n\n$3.$ 数值积分算法\n\n推导出的ODE $\\frac{dR}{ds} = f(R(s))$ 将使用经典的四阶Runge-Kutta (RK4) 方法进行积分，该方法满足至少4阶的要求。给定在弧长 $s_n$ 处的当前位置 $R_n$ 和步长 $\\Delta s$，下一个位置 $R_{n+1}$（在 $s_{n+1} = s_n + \\Delta s$ 处）计算如下：\n$$\n\\begin{align*}\nk_1 = \\Delta s \\cdot f(R_n) \\\\\nk_2 = \\Delta s \\cdot f(R_n + k_1/2) \\\\\nk_3 = \\Delta s \\cdot f(R_n + k_2/2) \\\\\nk_4 = \\Delta s \\cdot f(R_n + k_3) \\\\\nR_{n+1} = R_n + \\frac{1}{6}(k_1 + 2k_2 + 2k_3 + k_4)\n\\end{align*}\n$$\n其中 $f(R) = - \\frac{M^{-1} \\nabla_R V(R)}{g_{mw}}$。积分从位移点 $R_0 = R_{start}$ 开始，迭代进行。\n\n积分在满足以下两个条件之一时终止：\na) 收敛到最小值：质量加权梯度范数 $g_{mw}$ 降至指定容差 $\\tau_{grad}$ 以下。对于此问题，$\\tau_{grad} = 10^{-8}$。这表示路径已进入一个稳定区域（吸引盆）。\nb) 最大路径长度：总积分弧长 $s$ 超过最大值 $s_{max}$。对于此问题，$s_{max} = 6.0$。\n\n报告的最终坐标是算法计算出的最后一个点 $R_n$ 的坐标。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the IRC endpoints for the given test cases.\n    \"\"\"\n\n    def potential_gradient(R):\n        \"\"\"Computes the gradient of the potential V at coordinate R=(x,y).\"\"\"\n        x, y = R\n        grad_x = x * (x**2 - 1.0) + 0.2 * y\n        grad_y = y + 0.2 * x\n        return np.array([grad_x, grad_y])\n\n    def hessian_at_saddle():\n        \"\"\"Computes the Hessian of the potential V at the saddle point (0,0).\"\"\"\n        # H(x,y) = [[3x^2 - 1, 0.2], [0.2, 1]]\n        # At (0,0), H = [[-1, 0.2], [0.2, 1]]\n        return np.array([[-1.0, 0.2], [0.2, 1.0]])\n\n    def get_initial_direction(m_x, m_y):\n        \"\"\"\n        Calculates the initial displacement vector v in Cartesian coordinates.\n        This is done by finding the unstable eigenvector of the mass-weighted Hessian.\n        \"\"\"\n        M_inv_sqrt = np.diag([1.0/np.sqrt(m_x), 1.0/np.sqrt(m_y)])\n        \n        # Cartesian Hessian at the saddle point R_ddagger=(0,0)\n        H_cartesian = hessian_at_saddle()\n        \n        # Mass-weighted Hessian: H_q = M^(-1/2) * H * M^(-1/2)\n        H_mass_weighted = M_inv_sqrt @ H_cartesian @ M_inv_sqrt\n        \n        # Solve the eigenvalue problem for the symmetric mass-weighted Hessian\n        eigenvalues, eigenvectors = np.linalg.eigh(H_mass_weighted)\n        \n        # Find the index of the negative eigenvalue (unstable mode)\n        unstable_idx = np.argmin(eigenvalues)\n        u_unstable = eigenvectors[:, unstable_idx] # This is already normalized\n        \n        # Transform the normalized unstable eigenvector back to Cartesian coordinates\n        v_cartesian = M_inv_sqrt @ u_unstable\n        \n        return v_cartesian\n\n    def irc_ode_rhs(R, M, M_inv, M_inv_sqrt):\n        \"\"\"\n        Computes the right-hand side of the IRC ODE: -M^-1 * grad(V) / g_mw\n        \"\"\"\n        grad_V = potential_gradient(R)\n        \n        # Mass-weighted gradient norm: g_mw = ||M^(-1/2) * grad(V)||\n        g_mw = np.linalg.norm(M_inv_sqrt @ grad_V)\n        \n        # Avoid division by zero, although in practice we start away from the saddle point\n        if g_mw  1e-15:\n            return np.zeros(2)\n            \n        return - (M_inv @ grad_V) / g_mw\n\n    def find_irc_endpoint(m_x, m_y, epsilon, delta_s, s_max, grad_tol, direction):\n        \"\"\"\n        Integrates the IRC ODE using RK4 to find the endpoint.\n        \n        direction: -1 for left minimum (x decreasing), +1 for right minimum (x increasing).\n        \"\"\"\n        M = np.diag([m_x, m_y])\n        M_inv = np.diag([1.0/m_x, 1.0/m_y])\n        M_inv_sqrt = np.diag([1.0/np.sqrt(m_x), 1.0/np.sqrt(m_y)])\n        \n        R_saddle = np.array([0.0, 0.0])\n        \n        # 1. Get initial direction vector\n        v = get_initial_direction(m_x, m_y)\n        \n        # 2. Determine sign of displacement to match desired direction\n        sign_multiplier = direction / np.sign(v[0])\n        \n        # 3. Set starting point for integration\n        R_current = R_saddle + sign_multiplier * epsilon * v\n        s_current = 0.0\n        \n        # 4. Integrate using RK4\n        while s_current  s_max:\n            # Check stopping criterion: mass-weighted gradient norm\n            grad_V = potential_gradient(R_current)\n            g_mw = np.linalg.norm(M_inv_sqrt @ grad_V)\n            if g_mw  grad_tol:\n                break\n\n            # RK4 step\n            k1 = delta_s * irc_ode_rhs(R_current, M, M_inv, M_inv_sqrt)\n            k2 = delta_s * irc_ode_rhs(R_current + 0.5 * k1, M, M_inv, M_inv_sqrt)\n            k3 = delta_s * irc_ode_rhs(R_current + 0.5 * k2, M, M_inv, M_inv_sqrt)\n            k4 = delta_s * irc_ode_rhs(R_current + k3, M, M_inv, M_inv_sqrt)\n            \n            R_current += (k1 + 2*k2 + 2*k3 + k4) / 6.0\n            s_current += delta_s\n        \n        return R_current\n\n    test_cases = [\n        # (m_x, m_y, epsilon, delta_s, s_max, grad_tol, direction)\n        (1.0, 1.0, 1e-3, 0.05, 6.0, 1e-8, -1),  # Test A: left minimum\n        (1.0, 1.0, 1e-3, 0.05, 6.0, 1e-8, +1),  # Test B: right minimum\n        (2.0, 0.5, 1e-3, 0.03, 6.0, 1e-8, -1),  # Test C: left minimum, anisotropic\n    ]\n\n    final_coords = []\n    for params in test_cases:\n        x_final, y_final = find_irc_endpoint(*params)\n        final_coords.append(f\"{x_final:.6f}\")\n        final_coords.append(f\"{y_final:.6f}\")\n\n    print(f\"[{','.join(final_coords)}]\")\n\nsolve()\n```", "id": "2693839"}, {"introduction": "传统的过渡态理论将反应瓶颈置于势能最高点（鞍点）。然而，变分过渡态理论（VTST）认识到，真实的瓶颈取决于活化自由能，而不仅仅是势能。本练习将通过计算沿最小能量路径的活化亥姆霍兹自由能，阐明这一关键原理，并展示振动频率的变化（即熵的贡献）如何使反应瓶颈在有限温度下偏离鞍点 [@problem_id:2693838]。", "problem": "一个单分子异构化反应沿着由无量纲弧长坐标 $s \\in [0,1]$ 参数化的最低能量路径 (MEP) 进行，其中 $s=0$ 对应反应物谷，$s=1$ 对应产物谷。在每个固定的 $s$ 值处，可以构建一个与 MEP 正交的分隔面，并用频率为 $\\nu_i(s)$（单位为赫兹）的简谐振动简正模式来描述该表面上的小振幅运动，其中不包括反应坐标本身。在变分过渡态理论 (VTST) 中，变分瓶颈的位置是通过在给定温度 $T$ 下，对亥姆霍兹活化自由能 $A^\\ddagger(s,T)$ 关于 $s$ 进行最大化来获得的，其中只考虑沿着 MEP 的势能和正交振动模式对 $s$ 的依赖贡献。转动和平动贡献可以视为与 $s$ 无关，因此在确定最大值时可以忽略。\n\n从正则（恒定-$NVT$）系综和量子谐振子出发，根据第一性原理推导单个频率为 $\\nu$ 的简谐模式对亥姆霍兹自由能的振动贡献表达式，并用它来构建每摩尔的 $A^\\ddagger(s,T)$，其形式为沿着 MEP 的势能与正交模式的摩尔振动自由能贡献之和。\n\n给定以下离散的 $s$ 值网格，以及每个分隔面上 MEP 的势能 $V(s)$（单位为 $\\mathrm{kJ\\ mol^{-1}}$，相对于反应物）和三个正交简谐振动频率 $\\nu_i(s)$（单位为 $\\mathrm{THz}$，即 $10^{12}\\ \\mathrm{Hz}$）。使用 $T=500\\ \\mathrm{K}$。\n\n- $s=0.00$：$V(s)=0.0\\ \\mathrm{kJ\\ mol^{-1}}$；$\\nu_i(s)=(25.0,\\ 20.0,\\ 15.0)\\ \\mathrm{THz}$\n- $s=0.25$：$V(s)=20.0\\ \\mathrm{kJ\\ mol^{-1}}$；$\\nu_i(s)=(22.0,\\ 18.0,\\ 14.0)\\ \\mathrm{THz}$\n- $s=0.50$：$V(s)=38.0\\ \\mathrm{kJ\\ mol^{-1}}$；$\\nu_i(s)=(18.0,\\ 15.0,\\ 12.0)\\ \\mathrm{THz}$\n- $s=0.75$：$V(s)=27.0\\ \\mathrm{kJ\\ mol^{-1}}$；$\\nu_i(s)=(20.0,\\ 16.0,\\ 13.0)\\ \\mathrm{THz}$\n- $s=1.00$：$V(s)=6.0\\ \\mathrm{kJ\\ mol^{-1}}$；$\\nu_i(s)=(23.0,\\ 19.0,\\ 15.0)\\ \\mathrm{THz}$\n\n使用以下常数：\n- 普朗克常数 $h = 6.62607015\\times 10^{-34}\\ \\mathrm{J\\ s}$，\n- 玻尔兹曼常数 $k_B = 1.380649\\times 10^{-23}\\ \\mathrm{J\\ K^{-1}}$，\n- 阿伏伽德罗常数 $N_A = 6.02214076\\times 10^{23}\\ \\mathrm{mol^{-1}}$，\n- 气体常数 $R = N_A k_B = 8.314462618\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}$。\n\n任务：\n1. 推导在温度 $T$ 下，单个频率为 $\\nu$ 的量子谐振子的摩尔振动亥姆霍兹自由能表达式，并利用给定数据构建每摩尔的 $A^\\ddagger(s,T)$ 表达式。\n2. 计算网格中每个 $s$ 对应的 $A^\\ddagger(s,500\\ \\mathrm{K})$ 值，单位为 $\\mathrm{kJ\\ mol^{-1}}$。\n3. 确定此网格上使 $A^\\ddagger(s,500\\ \\mathrm{K})$ 最大化的 $s$ 值（即变分瓶颈）。\n\n最终答案仅报告给定网格上使函数值最大化的 $s$ 值。将最终答案四舍五入至三位有效数字。报告的 $s$ 是无量纲的。", "solution": "所给问题具有科学依据、提法明确、客观，并包含了获得唯一解所需的所有信息。这是统计力学在化学动力学中的一个标准应用，特别是变分过渡态理论 (VTST)。该问题被认为是有效的，并将提供完整的解答。\n\n第一个任务是根据第一性原理推导摩尔振动亥姆霍兹自由能的表达式。我们从正则系综开始。单个频率为 $\\nu$ 的量子谐振子的能级 $E_n$ 由下式给出：\n$$E_n = \\left(n + \\frac{1}{2}\\right)h\\nu, \\quad n = 0, 1, 2, \\dots$$\n其中 $h$ 是普朗克常数。\n\n在温度 $T$ 下，这个单个振子的正则配分函数 $q$ 是对所有量子态的求和：\n$$q_{vib} = \\sum_{n=0}^{\\infty} \\exp\\left(-\\frac{E_n}{k_B T}\\right) = \\sum_{n=0}^{\\infty} \\exp\\left(-\\frac{(n + \\frac{1}{2})h\\nu}{k_B T}\\right)$$\n其中 $k_B$ 是玻尔兹曼常数。该表达式可以进行因式分解：\n$$q_{vib} = \\exp\\left(-\\frac{h\\nu}{2k_B T}\\right) \\sum_{n=0}^{\\infty} \\left[\\exp\\left(-\\frac{h\\nu}{k_B T}\\right)\\right]^n$$\n该求和是一个形式为 $\\sum_{n=0}^{\\infty} x^n = \\frac{1}{1-x}$ 的几何级数，其中 $x = \\exp\\left(-\\frac{h\\nu}{k_B T}\\right)$。由于 $T  0$，我们有 $|x|1$，因此级数收敛。\n因此，一个振子的配分函数为：\n$$q_{vib} = \\frac{\\exp\\left(-\\frac{h\\nu}{2k_B T}\\right)}{1 - \\exp\\left(-\\frac{h\\nu}{k_B T}\\right)}$$\n亥姆霍兹自由能 $A$ 通过 $A = -k_B T \\ln q$ 与配分函数相关。对于单个振子，其振动亥姆霍兹自由能 $A_{vib}$ 为：\n$$A_{vib} = -k_B T \\ln(q_{vib}) = -k_B T \\ln\\left(\\frac{\\exp\\left(-\\frac{h\\nu}{2k_B T}\\right)}{1 - \\exp\\left(-\\frac{h\\nu}{k_B T}\\right)}\\right)$$\n利用对数的性质，我们得到：\n$$A_{vib} = -k_B T \\left[-\\frac{h\\nu}{2k_B T} - \\ln\\left(1 - \\exp\\left(-\\frac{h\\nu}{k_B T}\\right)\\right)\\right]$$\n$$A_{vib} = \\frac{1}{2}h\\nu + k_B T \\ln\\left(1 - \\exp\\left(-\\frac{h\\nu}{k_B T}\\right)\\right)$$\n这个表达式代表单个振子的自由能。它包括零点能 (ZPE) $\\frac{1}{2}h\\nu$ 和一个与温度相关的项。\n为了得到摩尔振动亥姆霍兹自由能 $A_{vib, m}$，我们乘以阿伏伽德罗常数 $N_A$：\n$$A_{vib, m} = N_A A_{vib} = \\frac{1}{2}N_A h\\nu + N_A k_B T \\ln\\left(1 - \\exp\\left(-\\frac{h\\nu}{k_B T}\\right)\\right)$$\n使用摩尔气体常数 $R = N_A k_B$ 的定义，最终表达式为：\n$$A_{vib, m}(\\nu, T) = \\frac{1}{2}N_A h\\nu + R T \\ln\\left(1 - \\exp\\left(-\\frac{h\\nu}{k_B T}\\right)\\right)$$\n问题将亥姆霍兹活化自由能 $A^\\ddagger(s,T)$ 定义为在分隔面 $s$ 处的亥姆霍兹自由能与在 $s=0$ 处反应物的亥姆霍兹自由能之差。在任意 $s$ 处的总亥姆霍兹自由能是势能 $V(s)$ 与所有 $N_{modes}$ 个正交振动模式贡献的总和。给定 $V(s=0)=0$：\n$$A^\\ddagger(s,T) = \\left(V(s) + \\sum_{i=1}^{N_{modes}} A_{vib, m}(\\nu_i(s), T)\\right) - \\left(V(s=0) + \\sum_{i=1}^{N_{modes}} A_{vib, m}(\\nu_i(0), T)\\right)$$\n$$A^\\ddagger(s,T) = V(s) + \\sum_{i=1}^{N_{modes}} \\left[A_{vib, m}(\\nu_i(s), T) - A_{vib, m}(\\nu_i(0), T)\\right]$$\n\n第二个任务是计算在 $T=500\\ \\mathrm{K}$ 时，给定 $s$ 值网格上 $A^\\ddagger(s,T)$ 的值。在每个点上，我们有三个正交模式 ($N_{modes}=3$)。我们必须使用提供的常数：\n$h = 6.62607015\\times 10^{-34}\\ \\mathrm{J\\ s}$\n$k_B = 1.380649\\times 10^{-23}\\ \\mathrm{J\\ K^{-1}}$\n$N_A = 6.02214076\\times 10^{23}\\ \\mathrm{mol^{-1}}$\n$R = 8.314462618\\ \\mathrm{J\\ mol^{-1}\\ K^{-1}}$\n$T = 500\\ \\mathrm{K}$\n\n我们首先计算反应物态 $s=0$ 处的总摩尔振动自由能，它作为我们的参考。在 $s=0$ 处，频率为 $\\nu_i(0)=(25.0, 20.0, 15.0)\\ \\mathrm{THz}$。我们将总和表示为 $A_{vib,tot}(s,T) = \\sum_{i=1}^3 A_{vib,m}(\\nu_i(s), T)$。\n对于 $s=0.00$：\n频率为 $\\nu_1 = 25.0 \\times 10^{12}\\ \\mathrm{Hz}$，$\\nu_2 = 20.0 \\times 10^{12}\\ \\mathrm{Hz}$ 和 $\\nu_3 = 15.0 \\times 10^{12}\\ \\mathrm{Hz}$。\n$A_{vib,m}(25.0\\ \\mathrm{THz}) = 4.592\\ \\mathrm{kJ\\ mol^{-1}}$\n$A_{vib,m}(20.0\\ \\mathrm{THz}) = 3.331\\ \\mathrm{kJ\\ mol^{-1}}$\n$A_{vib,m}(15.0\\ \\mathrm{THz}) = 1.868\\ \\mathrm{kJ\\ mol^{-1}}$\n$A_{vib,tot}(s=0, T=500\\ \\mathrm{K}) = 4.592 + 3.331 + 1.868 = 9.791\\ \\mathrm{kJ\\ mol^{-1}}$。\n根据定义，$A^\\ddagger(0,T) = V(0) + A_{vib,tot}(0,T) - A_{vib,tot}(0,T) = 0\\ \\mathrm{kJ\\ mol^{-1}}$。\n\n现在我们计算网格上其他点的 $A^\\ddagger(s,T)$。\n对于 $s=0.25$：$V(s) = 20.0\\ \\mathrm{kJ\\ mol^{-1}}$，$\\nu_i(s) = (22.0, 18.0, 14.0)\\ \\mathrm{THz}$。\n$A_{vib,tot}(s=0.25, T=500\\ \\mathrm{K}) = A_{vib,m}(22.0) + A_{vib,m}(18.0) + A_{vib,m}(14.0) = 3.869 + 2.767 + 1.639 = 8.275\\ \\mathrm{kJ\\ mol^{-1}}$。\n$A^\\ddagger(0.25, T) = V(0.25) + A_{vib,tot}(0.25,T) - A_{vib,tot}(0,T) = 20.0 + 8.275 - 9.791 = 18.484\\ \\mathrm{kJ\\ mol^{-1}}$。\n\n对于 $s=0.50$：$V(s) = 38.0\\ \\mathrm{kJ\\ mol^{-1}}$，$\\nu_i(s) = (18.0, 15.0, 12.0)\\ \\mathrm{THz}$。\n$A_{vib,tot}(s=0.50, T=500\\ \\mathrm{K}) = A_{vib,m}(18.0) + A_{vib,m}(15.0) + A_{vib,m}(12.0) = 2.767 + 1.868 + 1.207 = 5.842\\ \\mathrm{kJ\\ mol^{-1}}$。\n$A^\\ddagger(0.50, T) = V(0.50) + A_{vib,tot}(0.50,T) - A_{vib,tot}(0,T) = 38.0 + 5.842 - 9.791 = 34.051\\ \\mathrm{kJ\\ mol^{-1}}$。\n\n对于 $s=0.75$：$V(s) = 27.0\\ \\mathrm{kJ\\ mol^{-1}}$，$\\nu_i(s) = (20.0, 16.0, 13.0)\\ \\mathrm{THz}$。\n$A_{vib,tot}(s=0.75, T=500\\ \\mathrm{K}) = A_{vib,m}(20.0) + A_{vib,m}(16.0) + A_{vib,m}(13.0) = 3.331 + 2.116 + 1.419 = 6.866\\ \\mathrm{kJ\\ mol^{-1}}$。\n$A^\\ddagger(0.75, T) = V(0.75) + A_{vib,tot}(0.75,T) - A_{vib,tot}(0,T) = 27.0 + 6.866 - 9.791 = 24.075\\ \\mathrm{kJ\\ mol^{-1}}$。\n\n对于 $s=1.00$：$V(s) = 6.0\\ \\mathrm{kJ\\ mol^{-1}}$，$\\nu_i(s) = (23.0, 19.0, 15.0)\\ \\mathrm{THz}$。\n$A_{vib,tot}(s=1.00, T=500\\ \\mathrm{K}) = A_{vib,m}(23.0) + A_{vib,m}(19.0) + A_{vib,m}(15.0) = 4.103 + 3.045 + 1.868 = 9.016\\ \\mathrm{kJ\\ mol^{-1}}$。\n$A^\\ddagger(1.00, T) = V(1.00) + A_{vib,tot}(1.00,T) - A_{vib,tot}(0,T) = 6.0 + 9.016 - 9.791 = 5.225\\ \\mathrm{kJ\\ mol^{-1}}$。\n\n第三个任务是确定使 $A^\\ddagger(s, 500\\ \\mathrm{K})$ 最大化的 $s$ 值。总结结果如下：\n$A^\\ddagger(0.00, 500\\ \\mathrm{K}) = 0.000\\ \\mathrm{kJ\\ mol^{-1}}$\n$A^\\ddagger(0.25, 500\\ \\mathrm{K}) = 18.484\\ \\mathrm{kJ\\ mol^{-1}}$\n$A^\\ddagger(0.50, 500\\ \\mathrm{K}) = 34.051\\ \\mathrm{kJ\\ mol^{-1}}$\n$A^\\ddagger(0.75, 500\\ \\mathrm{K}) = 24.075\\ \\mathrm{kJ\\ mol^{-1}}$\n$A^\\ddagger(1.00, 500\\ \\mathrm{K}) = 5.225\\ \\mathrm{kJ\\ mol^{-1}}$\n\n通过直接比较，给定网格上 $A^\\ddagger(s, 500\\ \\mathrm{K})$ 的最大值为 $34.051\\ \\mathrm{kJ\\ mol^{-1}}$，出现在 $s=0.50$ 处。该位置对应于此温度下反应的变分瓶颈。势能曲线 $V(s)$ 的最大值也出现在 $s=0.50$ 处，但由于振动频率沿反应路径发生变化，自由能垒低于势能垒（$38.0\\ \\mathrm{kJ\\ mol^{-1}}$）。\n\n问题要求的是使 $A^\\ddagger(s,T)$ 最大化的 $s$ 值。这个值是 $0.50$。四舍五入到三位有效数字，我们写作 $0.500$。", "answer": "$$\\boxed{0.500}$$", "id": "2693838"}]}