{"hands_on_practices": [{"introduction": "为了从根本上理解化学反应的动态过程，我们必须首先将整个反应体系的整体平动（这部分运动对于反应本身是无关紧要的）与反应物之间真正决定反应发生与否的相对运动分离开。这一关键步骤通过转换到质心（center-of-mass, CM）参考系来完成。本练习将引导你通过一个交叉分子束实验的假设场景，计算该参考系的关键属性——质心速度 $V_{CM}$ 以及可用于引发反应的碰撞能量 $E_{coll}$，这是分析任何反应动力学问题的第一步 [@problem_id:1529507]。", "problem": "为了研究氩原子与氧分子之间的碰撞，我们搭建了一个交叉分子束实验装置。交叉分子束实验是研究反应动力学的一种强大技术。一束氩(Ar)原子沿x轴正方向运动，一束与之垂直的双原子氧(O$_2$)分子沿y轴正方向运动。两束分子束在原点相交。实验参数如下：\n\n- 氩原子的速率为 $v_{Ar} = 500.0 \\text{ m/s}$。\n- 氧分子的速率为 $v_{O_2} = 400.0 \\text{ m/s}$。\n- 氩的摩尔质量为 $M_{Ar} = 39.95 \\text{ g/mol}$。\n- 氧的摩尔质量为 $M_{O_2} = 32.00 \\text{ g/mol}$。\n- 阿伏伽德罗常数为 $N_A = 6.022 \\times 10^{23} \\text{ mol}^{-1}$。\n\n为了分析碰撞事件，必须在质心(CM)参考系中进行。你需要确定该参考系的关键性质。计算质心的速率、其速度矢量与x轴正方向的夹角，以及系统在质心参考系中的总动能（通常称为碰撞能）。\n\n最终答案请按顺序提供一组三个数值，分别对应速率、角度和动能。速率以m/s为单位，角度以度为单位，动能以焦耳为单位。将所有三个最终答案四舍五入到三位有效数字。", "solution": "我们将碰撞建模为一个两体系统，包含一个Ar原子（单个粒子质量为$m_{Ar}$，速度为$\\vec{v}_{Ar}$）和一个$\\mathrm{O}_{2}$分子（单个粒子质量为$m_{O_{2}}$，速度为$\\vec{v}_{O_{2}}$）。单个粒子的质量可由给定的摩尔质量$M_{Ar}$和$M_{O_{2}}$通过$m_{i} = \\frac{M_{i}}{N_{A}}$得出。\n\n根据动量守恒，质心(CM)速度定义为\n$$\n\\vec{V}_{\\mathrm{CM}}=\\frac{m_{Ar}\\,\\vec{v}_{Ar}+m_{O_{2}}\\,\\vec{v}_{O_{2}}}{m_{Ar}+m_{O_{2}}}.\n$$\n当$\\vec{v}_{Ar}=(v_{Ar},0)$且$\\vec{v}_{O_{2}}=(0,v_{O_{2}})$时，其分量为\n$$\nV_{x}=\\frac{m_{Ar}\\,v_{Ar}}{m_{Ar}+m_{O_{2}}}=\\frac{M_{Ar}\\,v_{Ar}}{M_{Ar}+M_{O_{2}}},\\qquad\nV_{y}=\\frac{m_{O_{2}}\\,v_{O_{2}}}{m_{Ar}+m_{O_{2}}}=\\frac{M_{O_{2}}\\,v_{O_{2}}}{M_{Ar}+M_{O_{2}}}.\n$$\n因此，质心速率及其相对于+x轴的方向为\n$$\nV_{\\mathrm{CM}}=\\sqrt{V_{x}^{2}+V_{y}^{2}}=\\frac{\\sqrt{(M_{Ar}v_{Ar})^{2}+(M_{O_{2}}v_{O_{2}})^{2}}}{M_{Ar}+M_{O_{2}}},\\qquad\n\\theta=\\arctan\\!\\left(\\frac{V_{y}}{V_{x}}\\right)=\\arctan\\!\\left(\\frac{M_{O_{2}}\\,v_{O_{2}}}{M_{Ar}\\,v_{Ar}}\\right).\n$$\n对于一个两体系统，质心系中的总动能（碰撞能）为\n$$\nE_{\\mathrm{coll}}=\\frac{1}{2}\\,\\mu\\,v_{\\mathrm{rel}}^{2},\\qquad \\mu=\\frac{m_{Ar}\\,m_{O_{2}}}{m_{Ar}+m_{O_{2}}}=\\frac{M_{Ar}M_{O_{2}}}{N_{A}\\,(M_{Ar}+M_{O_{2}})},\n$$\n其中相对速率为$v_{\\mathrm{rel}}=|\\vec{v}_{Ar}-\\vec{v}_{O_{2}}|$。因为分子束是垂直的，\n$$\nv_{\\mathrm{rel}}=\\sqrt{v_{Ar}^{2}+v_{O_{2}}^{2}}.\n$$\n\n现在代入给定的数值（其中$M$使用国际单位制单位）并进行计算：\n- $M_{Ar}=0.03995\\,\\text{kg/mol}$, $M_{O_{2}}=0.03200\\,\\text{kg/mol}$, $N_{A}=6.022\\times 10^{23}\\,\\text{mol}^{-1}$,\n- $v_{Ar}=500.0\\,\\text{m/s}$, $v_{O_{2}}=400.0\\,\\text{m/s}$.\n\n质心速度分量：\n$$\nV_{x}=\\frac{0.03995\\times 500.0}{0.03995+0.03200}\\approx 2.77623\\times 10^{2}\\,\\text{m/s},\n$$\n$$\nV_{y}=\\frac{0.03200\\times 400.0}{0.03995+0.03200}\\approx 1.77901\\times 10^{2}\\,\\text{m/s}.\n$$\n质心速率和角度：\n$$\nV_{\\mathrm{CM}}=\\sqrt{(2.77623\\times 10^{2})^{2}+(1.77901\\times 10^{2})^{2}}\\approx 3.29733\\times 10^{2}\\,\\text{m/s},\n$$\n$$\n\\theta=\\arctan\\!\\left(\\frac{12.800}{19.975}\\right)\\approx \\arctan(0.640801)\\approx 32.7\\,\\text{degrees}.\n$$\n\n碰撞能：\n$$\n\\mu=\\frac{M_{Ar}M_{O_{2}}}{N_{A}(M_{Ar}+M_{O_{2}})}=\\frac{0.03995\\,\\text{kg/mol}\\times 0.03200\\,\\text{kg/mol}}{6.022\\times 10^{23}\\,\\text{mol}^{-1}\\times (0.03995+0.03200)\\,\\text{kg/mol}}\\approx 2.95\\times 10^{-26}\\,\\text{kg},\n$$\n$$\nv_{\\mathrm{rel}}=\\sqrt{500.0^{2}+400.0^{2}}=\\sqrt{410000}\\,\\text{m/s},\n$$\n$$\nE_{\\mathrm{coll}}=\\frac{1}{2}\\,\\mu\\,v_{\\mathrm{rel}}^{2}=\\frac{1}{2}\\times (2.95\\times 10^{-26}\\,\\text{kg})\\times (410000\\,\\text{m}^2/\\text{s}^2)\\approx 6.05\\times 10^{-21}\\,\\text{J}.\n$$\n\n四舍五入到三位有效数字，质心速率、角度（度）和碰撞能（焦耳）分别为：\n- $V_{\\mathrm{CM}}\\approx 3.30\\times 10^{2}$,\n- $\\theta\\approx 32.7$,\n- $E_{\\mathrm{coll}}\\approx 6.05\\times 10^{-21}$.", "answer": "$$\\boxed{\\begin{pmatrix}3.30\\times 10^{2} & 32.7 & 6.05\\times 10^{-21}\\end{pmatrix}}$$", "id": "1529507"}, {"introduction": "化学反应的理论模型最自然地是在质心参考系中构建的，因为它消除了体系的整体平动，使我们能专注于粒子间的相互作用。然而，所有实验都是在实验室（LAB）参考系中进行的。本练习旨在搭建起理论与实验之间的桥梁，演示如何将一个理论上的产物角分布从质心系转换到实验室系，这是将理论预测与实验测量结果进行比较的关键步骤。通过一个简化的各向同性散射模型，该练习揭示了这一转换背后的核心数学关系，这种关系通常可以通过牛顿图（Newton diagram）进行可视化 [@problem_id:2626677]。", "problem": "一个反应散射实验将物种 $A$ 的溢流源与物种 $B$ 的单能分子束交叉。物种 $B$ 的分子束以实验室速度 $u_{b}$ 沿 $+z$ 轴传播，而物种 $A$ 的溢流源保持在温度 $T$。反应 $A + B \\rightarrow P + \\cdots$ 生成产物 $P$，其具有精确定义的质心 (CM) 速度 $v_{0}$（即产物平动能释放范围窄）。产物 $P$ 的质心微分散射截面 (DCS) 是各向同性的，即 $d\\sigma/d\\Omega_{\\mathrm{CM}}$ 是一个常数。假设 $m_{A} = m_{B}$，且溢流源相对于分子束足够冷，以至于 $k_{B} T \\ll \\tfrac{1}{2} m_{B} u_{b}^{2}$，因此在确定质心运动时，物种 $A$ 的速度与 $u_{b}$ 相比可以忽略不计。\n\n仅使用伽利略速度加法和动量守恒来定义质心速度，并利用质心参考系和实验室参考系之间速度-方向映射的雅可比行列式，从质心微分散射截面推导出实验室角分布 $I(\\theta_{\\mathrm{lab}})$（允许相差一个乘法常数）。然后，对于具体参数 $u_{b} = 2.0 \\times 10^{3}\\ \\mathrm{m\\,s^{-1}}$，$v_{0} = 1.5 \\times 10^{3}\\ \\mathrm{m\\,s^{-1}}$ 和 $m_{A} = m_{B}$，计算比值\n$$\nR \\equiv \\frac{I(\\theta_{\\mathrm{lab}} = \\tfrac{\\pi}{2}\\ \\mathrm{radians})}{I(\\theta_{\\mathrm{lab}} = 0\\ \\mathrm{radians})}.\n$$\n将您的最终答案表示为单一的精确解析表达式（无数值四舍五入）。角度单位为弧度。", "solution": "质心速度 $\\mathbf{V}_{\\mathrm{CM}}$ 由线性动量守恒定义：\n$$\n\\mathbf{V}_{\\mathrm{CM}} = \\frac{m_{A} \\mathbf{v}_{A} + m_{B} \\mathbf{v}_{B}}{m_{A} + m_{B}}\n$$\n根据已知条件，物种 $B$ 的分子束沿 $+z$ 轴传播，因此其速度矢量为 $\\mathbf{v}_{B} = u_{b} \\hat{\\mathbf{z}}$。题目指出，来自溢流源的物种 $A$ 的热速度可以忽略不计，因此我们取 $\\mathbf{v}_{A} \\approx \\mathbf{0}$。在质量条件 $m_{A} = m_{B} = m$ 下，质心速度变为：\n$$\n\\mathbf{V}_{\\mathrm{CM}} = \\frac{m(\\mathbf{0}) + m(u_{b} \\hat{\\mathbf{z}})}{m + m} = \\frac{1}{2} u_{b} \\hat{\\mathbf{z}}\n$$\n质心速度的大小为 $V_{\\mathrm{CM}} = \\frac{u_{b}}{2}$，方向沿实验室坐标系的 $z$ 轴。\n\n产物 $P$ 在实验室参考系中的速度 $\\mathbf{v}_{\\mathrm{lab}}$ 与其在质心参考系中的速度 $\\mathbf{v}_{\\mathrm{CM}}$ 之间的关系由伽利略变换给出：\n$$\n\\mathbf{v}_{\\mathrm{lab}} = \\mathbf{V}_{\\mathrm{CM}} + \\mathbf{v}_{\\mathrm{CM}}\n$$\n这个矢量加法构成一个速度三角形，通常称为牛顿图。$\\mathbf{v}_{\\mathrm{CM}}$ 的大小为给定的常数 $v_{0}$。\n\n实验室角分布 $I(\\theta_{\\mathrm{lab}})$ 与实验室参考系中的微分散射截面 $d\\sigma/d\\Omega_{\\mathrm{lab}}$ 成正比。为了得到它，我们将双微分散射截面从质心参考系变换到实验室参考系。散射粒子数是守恒的，因此通量不变，这导致了双微分散射截面 $\\sigma(\\mathbf{v}) \\equiv d^2\\sigma/d\\Omega dv$ 的变换规则：\n$$\n\\sigma_{\\mathrm{lab}}(v_{\\mathrm{lab}}, \\theta_{\\mathrm{lab}}) = \\left(\\frac{v_{\\mathrm{lab}}}{v_{\\mathrm{CM}}}\\right)^{2} \\sigma_{\\mathrm{CM}}(v_{\\mathrm{CM}}, \\theta_{\\mathrm{CM}})\n$$\n题目指出质心散射是各向同性的，且产物速度是精确的 $v_{0}$。我们可以将其表示为：\n$$\n\\sigma_{\\mathrm{CM}}(v_{\\mathrm{CM}}, \\theta_{\\mathrm{CM}}) = C \\cdot \\delta(v_{\\mathrm{CM}} - v_{0})\n$$\n其中 $C$ 是一个与总截面相关的常数，$\\delta$ 是狄拉克-德尔塔函数。将此代入变换方程，我们得到实验室参考系中的分布：\n$$\n\\sigma_{\\mathrm{lab}}(v_{\\mathrm{lab}}, \\theta_{\\mathrm{lab}}) = C \\left(\\frac{v_{\\mathrm{lab}}}{v_{0}}\\right)^{2} \\delta(\\sqrt{|\\mathbf{v}_{\\mathrm{lab}} - \\mathbf{V}_{\\mathrm{CM}}|^2} - v_{0})\n$$\n德尔塔函数的自变量将实验室速度和质心速度联系起来。根据速度三角形的余弦定理，我们有 $v_{\\mathrm{CM}}^2 = v_{\\mathrm{lab}}^2 + V_{\\mathrm{CM}}^2 - 2v_{\\mathrm{lab}}V_{\\mathrm{CM}}\\cos\\theta_{\\mathrm{lab}}$。因此：\n$$\n\\sigma_{\\mathrm{lab}}(v_{\\mathrm{lab}}, \\theta_{\\mathrm{lab}}) = C \\frac{v_{\\mathrm{lab}}^2}{v_{0}^2} \\delta(\\sqrt{v_{\\mathrm{lab}}^2 + V_{\\mathrm{CM}}^2 - 2v_{\\mathrm{lab}}V_{\\mathrm{CM}}\\cos\\theta_{\\mathrm{lab}}} - v_{0})\n$$\n实验室角分布 $I(\\theta_{\\mathrm{lab}})$ 是通过将此表达式对所有可能的实验室速度 $v_{\\mathrm{lab}}$ 在固定实验室角度 $\\theta_{\\mathrm{lab}}$ 下积分得到的：\n$$\nI(\\theta_{\\mathrm{lab}}) \\propto \\frac{d\\sigma}{d\\Omega_{\\mathrm{lab}}} = \\int_{0}^{\\infty} \\sigma_{\\mathrm{lab}}(v_{\\mathrm{lab}}, \\theta_{\\mathrm{lab}}) \\, dv_{\\mathrm{lab}}\n$$\n为了计算该积分，我们使用德尔塔函数的性质 $\\int f(x)\\delta(g(x))dx = \\sum_{i} \\frac{f(x_{i})}{|g'(x_{i})|}$，其中 $x_{i}$ 是 $g(x)=0$ 的根。在这里，$g(v_{\\mathrm{lab}}) = \\sqrt{v_{\\mathrm{lab}}^2 + V_{\\mathrm{CM}}^2 - 2v_{\\mathrm{lab}}V_{\\mathrm{CM}}\\cos\\theta_{\\mathrm{lab}}} - v_{0}$。根 $v_{\\mathrm{lab}}^*$ 满足 $v_{\\mathrm{lab}}^2 - (2V_{\\mathrm{CM}}\\cos\\theta_{\\mathrm{lab}})v_{\\mathrm{lab}} + (V_{\\mathrm{CM}}^2 - v_{0}^2) = 0$。解为：\n$$\nv_{\\mathrm{lab}}^* = V_{\\mathrm{CM}}\\cos\\theta_{\\mathrm{lab}} \\pm \\sqrt{v_{0}^2 - V_{\\mathrm{CM}}^2\\sin^2\\theta_{\\mathrm{lab}}}\n$$\n导数为 $|g'(v_{\\mathrm{lab}}^*)| = \\frac{|v_{\\mathrm{lab}}^* - V_{\\mathrm{CM}}\\cos\\theta_{\\mathrm{lab}}|}{v_{0}} = \\frac{\\sqrt{v_{0}^2 - V_{\\mathrm{CM}}^2\\sin^2\\theta_{\\mathrm{lab}}}}{v_{0}}$。\n积分正比于：\n$$\nI(\\theta_{\\mathrm{lab}}) \\propto \\sum_{\\text{roots}} \\frac{v_{0}}{v_{0}^2} \\frac{(v_{\\mathrm{lab}}^*)^2}{\\sqrt{v_{0}^2 - V_{\\mathrm{CM}}^2\\sin^2\\theta_{\\mathrm{lab}}}} = \\frac{1}{v_{0}\\sqrt{v_{0}^2 - V_{\\mathrm{CM}}^2\\sin^2\\theta_{\\mathrm{lab}}}} \\sum_{\\text{roots}} (v_{\\mathrm{lab}}^*)^2\n$$\n对于给定的参数 $u_{b} = 2.0 \\times 10^{3}\\ \\mathrm{m\\,s^{-1}}$ 和 $v_{0} = 1.5 \\times 10^{3}\\ \\mathrm{m\\,s^{-1}}$。这给出 $V_{\\mathrm{CM}} = u_{b}/2 = 1.0 \\times 10^{3}\\ \\mathrm{m\\,s^{-1}}$。由于 $V_{\\mathrm{CM}}  v_{0}$，质心原点位于牛顿球内部。因此，对于任何 $\\theta_{\\mathrm{lab}}$，$v_{\\mathrm{lab}}$ 只有一个物理上有意义（正值）的根：\n$$\nv_{\\mathrm{lab}}^* = V_{\\mathrm{CM}}\\cos\\theta_{\\mathrm{lab}} + \\sqrt{v_{0}^2 - V_{\\mathrm{CM}}^2\\sin^2\\theta_{\\mathrm{lab}}}\n$$\n另一个根总是负的，因此被舍弃。所以求和只包含一项。\n$$\nI(\\theta_{\\mathrm{lab}}) \\propto \\frac{(V_{\\mathrm{CM}}\\cos\\theta_{\\mathrm{lab}} + \\sqrt{v_{0}^2 - V_{\\mathrm{CM}}^2\\sin^2\\theta_{\\mathrm{lab}}})^2}{v_{0}\\sqrt{v_{0}^2 - V_{\\mathrm{CM}}^2\\sin^2\\theta_{\\mathrm{lab}}}}\n$$\n现在我们计算比值 $R$。\n对于 $\\theta_{\\mathrm{lab}} = 0$：\n$\\cos(0) = 1$, $\\sin(0) = 0$。\n$$\nI(0) \\propto \\frac{(V_{\\mathrm{CM}} + \\sqrt{v_{0}^2})^2}{v_{0}\\sqrt{v_{0}^2}} = \\frac{(V_{\\mathrm{CM}}+v_{0})^2}{v_{0}^2}\n$$\n对于 $\\theta_{\\mathrm{lab}} = \\pi/2$：\n$\\cos(\\pi/2) = 0$, $\\sin(\\pi/2) = 1$。\n$$\nI(\\pi/2) \\propto \\frac{(\\sqrt{v_{0}^2 - V_{\\mathrm{CM}}^2})^2}{v_{0}\\sqrt{v_{0}^2 - V_{\\mathrm{CM}}^2}} = \\frac{v_{0}^2 - V_{\\mathrm{CM}}^2}{v_{0}\\sqrt{v_{0}^2 - V_{\\mathrm{CM}}^2}} = \\frac{\\sqrt{v_{0}^2 - V_{\\mathrm{CM}}^2}}{v_{0}}\n$$\n比值 $R$ 是：\n$$\nR = \\frac{I(\\pi/2)}{I(0)} = \\frac{\\frac{\\sqrt{v_{0}^2 - V_{\\mathrm{CM}}^2}}{v_{0}}}{\\frac{(V_{\\mathrm{CM}}+v_{0})^2}{v_{0}^2}} = \\frac{v_{0}\\sqrt{v_{0}^2 - V_{\\mathrm{CM}}^2}}{(V_{\\mathrm{CM}}+v_{0})^2}\n$$\n我们代入给定值：$v_{0} = 1.5 \\times 10^{3}\\ \\mathrm{m\\,s^{-1}}$ 和 $V_{\\mathrm{CM}} = 1.0 \\times 10^{3}\\ \\mathrm{m\\,s^{-1}}$。\n$10^{3}$ 因子可以被提出并消掉：\n$$\nR = \\frac{1.5 \\sqrt{1.5^2 - 1.0^2}}{(1.0 + 1.5)^2} = \\frac{1.5 \\sqrt{2.25 - 1.0}}{2.5^2} = \\frac{1.5 \\sqrt{1.25}}{6.25}\n$$\n将小数写成分数：$1.5 = \\frac{3}{2}$，$1.25 = \\frac{5}{4}$，$6.25 = \\frac{25}{4}$。\n$$\nR = \\frac{\\frac{3}{2} \\sqrt{\\frac{5}{4}}}{\\frac{25}{4}} = \\frac{\\frac{3}{2} \\frac{\\sqrt{5}}{2}}{\\frac{25}{4}} = \\frac{\\frac{3\\sqrt{5}}{4}}{\\frac{25}{4}} = \\frac{3\\sqrt{5}}{25}\n$$\n这是该比值的最终精确解析表达式。", "answer": "$$\n\\boxed{\\frac{3\\sqrt{5}}{25}}\n$$", "id": "2626677"}, {"introduction": "在真实的散射实验中，产物角分布的数据通常以在特定角度范围内收集、并带有噪声的数据点形式呈现。为了从这些原始数据中提取潜在的物理规律，我们需要将其拟合到一个理论形式，通常是勒让德多项式（Legendre polynomials）的级数展开。本计算练习将指导你编写一个程序，从分箱的（binned）数据中确定这些展开系数 $A_{\\ell}$，这是现代散射实验中解读角分布数据、揭示反应微观动力学机制的一项核心技能 [@problem_id:2626680]。", "problem": "给定一个轴对称反应散射情景，其微分截面 (DCS) 仅取决于极角 $\\theta \\in [0,\\pi]$，并可展开为勒让德多项式级数形式 $d\\sigma/d\\Omega = f(\\theta) = \\sum_{\\ell=0}^{\\ell_{\\max}} A_{\\ell} P_{\\ell}(\\cos\\theta)$。此处，$P_{\\ell}$ 表示 $\\ell$ 次勒让德多项式，$A_{\\ell}$ 是表征产物角分布的实系数。可测量的是每单位立体角的 $f(\\theta)$。数据是在不同的极角区间内收集的，每个区间内报告的值是在该区间中点处计算的 $f(\\theta)$ 的带噪声的估计值。\n\n基本事实：\n- 勒让德多项式满足正交关系 $\\int_{-1}^{1} P_{\\ell}(\\mu) P_{m}(\\mu)\\, d\\mu = \\frac{2}{2\\ell+1}\\delta_{\\ell m}$，其中 $\\mu = \\cos\\theta$，$\\delta_{\\ell m}$ 是克罗内克 δ (Kronecker delta)，且 $\\ell,m \\in \\mathbb{N}_0$。\n- 立体角微元可分离为 $d\\Omega = \\sin\\theta\\, d\\theta\\, d\\phi$。对于轴对称的 $f(\\theta)$，不存在对方位角 $\\phi$ 的依赖关系，其在 $P_{\\ell}(\\cos\\theta)$ 上的投影简化为带权重 $\\sin\\theta$ 的关于 $\\theta$ 的一维积分。\n\n任务：\n- 从正交关系和级数展开定义出发，推导出一个 $A_{\\ell}$ 的投影估计量，该估计量表示为 $f(\\theta) P_{\\ell}(\\cos\\theta)$ 在 $\\theta \\in [0,\\pi]$ 上带适当权重的积分。然后，为了从带噪声的分箱数据中计算 $A_{\\ell}$，请使用中点法则黎曼和来近似该积分：使用区间中点角 $\\theta_i$、区间宽度 $\\Delta\\theta_i$ 和测量值 $y_i \\approx f(\\theta_i)$，并采用物理上正确的权重 $\\sin\\theta_i$。您的估计量必须对非均匀和均匀的区间宽度都有效。数据中提供的所有角度都以度为单位；在进行任何三角函数计算之前，您必须在内部将度转换为弧度。\n- 在一个程序中实现此估计量，对于下述每个测试用例，该程序返回估计系数列表 $[A_0,A_1,\\dots,A_{\\ell_{\\max}}]$，结果为浮点数并四舍五入到六位小数。\n\n角度单位要求：\n- 所有输入角度均以度为单位指定。您的程序必须在计算前将度转换为弧度。输入中不应有任何角度被视为弧度。三角函数和任何角度积分都必须使用弧度。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含所有测试用例的结果。结果是一个由方括号括起来的逗号分隔列表，其中每个测试用例的结果本身就是一个由方括号括起来的、逗号分隔的系数列表。例如，一个有效的输出应类似于 $[[a_{0}^{(1)},a_{1}^{(1)}],[a_{0}^{(2)},a_{1}^{(2)}]]$，其中每个 $a$ 值都四舍五入到六位小数。\n\n测试套件：\n- 对于每个测试用例，您将获得以度为单位的区间边界和在中点处的带噪声测量值。这些区间划分了 $[0^\\circ,180^\\circ]$；第 $i$ 个区间的中点是其两个边界角度的平均值。相应的区间宽度（以弧度为单位）是相邻边界之差并转换为弧度的结果。\n\n提供一个能评估以下所有用例的程序：\n\n1) 用例 #1 (均匀区间，中等各向异性):\n- $\\ell_{\\max} = 4$。\n- 区间边界 (度): $[\\,\\;0,\\;30,\\;60,\\;90,\\;120,\\;150,\\;180\\;\\,]$.\n- 中点测量值 $y_i$ ($f(\\theta)$ 的量纲，每单位立体角): $[\\,\\;1.324820,\\;1.198250,\\;0.776555,\\;0.765555,\\;1.215250,\\;1.308820\\;\\,]$.\n\n2) 用例 #2 (非均匀区间，不同尺度的各向异性):\n- $\\ell_{\\max} = 2$。\n- 区间边界 (度): $[\\,\\;0,\\;20,\\;50,\\;80,\\;120,\\;160,\\;180\\;\\,]$.\n- 中点测量值 $y_i$: $[\\,\\;1.723569,\\;1.833045,\\;2.089627,\\;2.131431,\\;1.885929,\\;1.718569\\;\\,]$.\n\n3) 用例 #3 (均匀区间，估计量边界情况):\n- $\\ell_{\\max} = 0$。\n- 区间边界 (度): $[\\,\\;0,\\;45,\\;90,\\;135,\\;180\\;\\,]$.\n- 中点测量值 $y_i$: $[\\,\\;1.812132,\\;1.377868,\\;1.407868,\\;1.807132\\;\\,]$.\n\n科学真实性与单位：\n- 将 $y_i$ 视为在区间中点对 $f(\\theta)$ 的带噪声的评估值，无需额外的缩放因子。您实现的估计量必须通过权重 $\\sin\\theta$ 和以弧度为单位的区间宽度来遵循正确的角度测度。最终答案中除了数值系数值外，无需报告其他单位。角度必须在内部以弧度处理。\n\n答案规格：\n- 输出必须是单行文本，包含一个由方括号括起来的列表，该列表包含三个列表。每个子列表是对应于上述三个用例（按给定顺序）估计出的 $A_{\\ell}$ 浮点数，并四舍五入到六位小数。", "solution": "所述问题具有科学依据，数学上一致，且提法明确。它提出了散射数据分析中的一个标准任务，即从测量的微分截面中提取角动量分量。所有必要信息均已提供。我们将继续推导并实现所需的估计量。\n\n任务是确定轴对称微分截面的勒让德多项式展开式中的系数 $A_{\\ell}$，其形式如下：\n$$\n\\frac{d\\sigma}{d\\Omega} = f(\\theta) = \\sum_{\\ell=0}^{\\ell_{\\max}} A_{\\ell} P_{\\ell}(\\cos\\theta)\n$$\n其中 $P_{\\ell}$ 是 $\\ell$ 次勒让德多项式，$\\theta$ 是极散射角。\n\n首先，我们推导 $A_{\\ell}$ 的解析公式。这些系数的提取依赖于勒让德多项式的正交性，该性质针对变量 $\\mu \\in [-1, 1]$ 给出：\n$$\n\\int_{-1}^{1} P_{\\ell}(\\mu) P_{m}(\\mu)\\, d\\mu = \\frac{2}{2\\ell+1}\\delta_{\\ell m}\n$$\n其中 $\\delta_{\\ell m}$ 是克罗内克 δ (Kronecker delta)。\n\n为利用此性质，我们必须构建一个涉及 $f(\\theta)$ 的合适积分。角域 $\\theta \\in [0, \\pi]$ 与正交域 $\\mu \\in [-1, 1]$ 之间的联系是代换 $\\mu = \\cos\\theta$。这意味着 $d\\mu = -\\sin\\theta \\, d\\theta$。此外，问题指出，对于轴对称系统，在 $P_{\\ell}(\\cos\\theta)$ 上的投影涉及一个带权重 $\\sin\\theta$ 的关于 $\\theta$ 的积分。这自然地源于立体角元 $d\\Omega = \\sin\\theta \\, d\\theta \\, d\\phi$。\n\n让我们考虑将 $f(\\theta)$ 乘以 $P_m(\\cos\\theta)$ 和权重函数 $\\sin\\theta$ 后，在 $\\theta$ 的整个取值范围上进行积分：\n$$\nI_m = \\int_{0}^{\\pi} f(\\theta) P_{m}(\\cos\\theta) \\sin\\theta \\, d\\theta\n$$\n代入 $f(\\theta)$ 的展开式：\n$$\nI_m = \\int_{0}^{\\pi} \\left( \\sum_{\\ell=0}^{\\ell_{\\max}} A_{\\ell} P_{\\ell}(\\cos\\theta) \\right) P_{m}(\\cos\\theta) \\sin\\theta \\, d\\theta\n$$\n对于有限和，我们可以交换求和与积分的顺序：\n$$\nI_m = \\sum_{\\ell=0}^{\\ell_{\\max}} A_{\\ell} \\int_{0}^{\\pi} P_{\\ell}(\\cos\\theta) P_{m}(\\cos\\theta) \\sin\\theta \\, d\\theta\n$$\n现在我们进行变量代换 $\\mu = \\cos\\theta$。当 $\\theta$ 从 $0$ 变到 $\\pi$ 时，$\\mu$ 从 $1$ 变到 $-1$。微分变为 $d\\mu = -\\sin\\theta \\, d\\theta$，即 $\\sin\\theta \\, d\\theta = -d\\mu$。\n$$\nI_m = \\sum_{\\ell=0}^{\\ell_{\\max}} A_{\\ell} \\int_{1}^{-1} P_{\\ell}(\\mu) P_{m}(\\mu) (-d\\mu) = \\sum_{\\ell=0}^{\\ell_{\\max}} A_{\\ell} \\int_{-1}^{1} P_{\\ell}(\\mu) P_{m}(\\mu) \\, d\\mu\n$$\n应用正交关系：\n$$\nI_m = \\sum_{\\ell=0}^{\\ell_{\\max}} A_{\\ell} \\left( \\frac{2}{2\\ell+1}\\delta_{\\ell m} \\right)\n$$\n克罗内克 δ 确保了求和式中唯一的非零项是 $\\ell = m$ 的那一项。因此，求和式简化为：\n$$\nI_m = A_m \\left( \\frac{2}{2m+1} \\right)\n$$\n通过令 $I_m$ 的两个表达式相等并解出 $A_m$（为保持一致性，将索引重命名为 $\\ell$）：\n$$\nA_{\\ell} = \\frac{2\\ell+1}{2} \\int_{0}^{\\pi} f(\\theta) P_{\\ell}(\\cos\\theta) \\sin\\theta \\, d\\theta\n$$\n这就是系数 $A_{\\ell}$ 的精确解析表达式。\n\n接下来，我们必须使用所提供的分箱数据来近似这个积分。数据由在角区间中点 $\\theta_i$ 处对函数 $f(\\theta)$ 的测量值 $y_i$ 组成。问题指定了使用中点法则黎曼和。在 $[0, \\pi]$ 上的积分被划分为在每个区间 $[\\theta_{edge, i-1}, \\theta_{edge, i}]$ 上的积分之和。\n$$\n\\int_{0}^{\\pi} g(\\theta) \\, d\\theta = \\sum_{i=1}^{N} \\int_{\\theta_{edge, i-1}}^{\\theta_{edge, i}} g(\\theta) \\, d\\theta\n$$\n其中 $g(\\theta) = f(\\theta) P_{\\ell}(\\cos\\theta) \\sin\\theta$，$N$ 是区间的数量。使用中点法则，单个区间上的积分近似为：\n$$\n\\int_{\\theta_{edge, i-1}}^{\\theta_{edge, i}} g(\\theta) \\, d\\theta \\approx g(\\theta_i) \\Delta\\theta_i\n$$\n其中中点为 $\\theta_i = (\\theta_{edge, i-1} + \\theta_{edge, i}) / 2$，区间宽度为 $\\Delta\\theta_i = \\theta_{edge, i} - \\theta_{edge, i-1}$。函数 $f(\\theta_i)$ 由其测量值 $y_i$ 近似。\n\n一个关键细节是，对于三角函数计算和区间宽度 $\\Delta\\theta_i$，所有角度都必须以弧度为单位。输入的区间边界是以度为单位的，需要进行转换。\n\n结合这些要素，该积分近似为：\n$$\n\\int_{0}^{\\pi} f(\\theta) P_{\\ell}(\\cos\\theta) \\sin\\theta \\, d\\theta \\approx \\sum_{i=1}^{N} y_i P_{\\ell}(\\cos\\theta_i) \\sin(\\theta_i) \\Delta\\theta_i\n$$\n将此求和代入我们的解析公式，得出 $A_{\\ell}$ 的最终数值估计量：\n$$\nA_{\\ell} \\approx \\frac{2\\ell+1}{2} \\sum_{i=1}^{N} y_i P_{\\ell}(\\cos\\theta_i) \\sin(\\theta_i) \\Delta\\theta_i\n$$\n该估计量正确地包含了非均匀区间宽度 $\\Delta\\theta_i$ 和来自积分测度的必要权重 $\\sin\\theta_i$。实现程序将为每个测试用例计算从 $\\ell=0$ 到 $\\ell_{\\max}$ 的每个所需值的此求和。", "answer": "[[1.000000,0.000000,0.500000,0.000000,0.000000],[2.000000,0.400000,0.200000],[1.500000]]", "id": "2626680"}]}