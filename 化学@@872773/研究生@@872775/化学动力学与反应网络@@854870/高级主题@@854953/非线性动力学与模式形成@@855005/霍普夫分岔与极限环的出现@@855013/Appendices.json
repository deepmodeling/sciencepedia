{"hands_on_practices": [{"introduction": "分析化学振荡器的第一步是解析地确定振荡产生的条件。本练习将通过一个经典的化学振荡模型，让你亲手实践完成此任务所需的基本数学工具 [@problem_id:2647395]。通过在稳态点附近对系统进行线性化并分析得到的雅可比矩阵，你将推导出霍普夫分岔的精确参数阈值以及初始振荡的频率 $\\omega$。", "problem": "考虑一个在两种外部物种浓度恒定的恒化器进料下运行的连续搅拌釜反应器。动态物种为 $X$ 和 $Y$，反应网络为\n- $R_1$: $A \\to X$,\n- $R_2$: $2X + Y \\to 3X$,\n- $R_3$: $B + X \\to Y + D$,\n- $R_4$: $X \\to E$,\n其中 $A$、$B$、$D$ 和 $E$ 的浓度由环境（恒化器）维持恒定，而 $X$ 和 $Y$ 在一个充分混合的体积内根据质量作用动力学进行演化。假设通过标准的时间和浓度重标，速率常数已被无量纲化为 $k_{1}=k_{2}=k_{3}=k_{4}=1$，并令恒化器浓度用 $A$ 和 $B$ 表示（均为正常数）。\n\n任务：\n- 从质量作用定律和反应的化学计量变化向量出发，写出控制 $x(t)=[X](t)$ 和 $y(t)=[Y](t)$ 的常微分方程 (ODE)。\n- 构造动态物种的化学计量矩阵，并确定由其列向量张成的化学计量子空间的维数。请证明你的结论。\n- 通过求解常微分方程的稳态，求得唯一正稳态 $(x^{\\ast},y^{\\ast})$，并将其表示为 $A$ 和 $B$ 的函数。\n- 推导在 $(x^{\\ast},y^{\\ast})$ 处的反应动力学的雅可比矩阵，并仅使用动力系统线性化的第一性原理，推导出在 $(x^{\\ast},y^{\\ast})$ 处发生霍普夫分岔时 $(A,B)$ 需满足的显式条件（即线性化后系统有一对纯虚特征值且无零特征值）。陈述分岔点对应的线性振荡角频率 $\\omega$（用 $A$ 和 $B$ 表示）。\n- 最后，对于特定的恒化器值 $A=\\tfrac{3}{2}$，计算分岔点处的精确霍普夫角频率 $\\omega_{c}$（单位为弧度/单位时间）。\n\n你的最终答案必须是最后一项要求的 $\\omega_{c}$ 的唯一精确值。最终的方框答案中不要包含单位。如果在任何阶段进行了数值近似，你仍必须报告未经舍入的精确最终值。", "solution": "我们从质量作用定律以及动态物种 $X$ 和 $Y$ 的化学计量变化开始。令 $x(t)=[X](t)$ 和 $y(t)=[Y](t)$。当 $k_{1}=k_{2}=k_{3}=k_{4}=1$ 时，反应速率为\n- $v_{1}=A$，对于 $R_{1}: A \\to X$，\n- $v_{2}=x^{2}y$，对于 $R_{2}: 2X+Y \\to 3X$，\n- $v_{3}=Bx$，对于 $R_{3}: B+X \\to Y + D$，\n- $v_{4}=x$，对于 $R_{4}: X \\to E$。\n\n$(X,Y)$ 的化学计量变化向量为\n- $\\nu_{1}=(+1,\\,0)^{\\top}$，对于 $R_{1}$，\n- $\\nu_{2}=(+1,\\,-1)^{\\top}$，对于 $R_{2}$，\n- $\\nu_{3}=(-1,\\,+1)^{\\top}$，对于 $R_{3}$，\n- $\\nu_{4}=(-1,\\,0)^{\\top}$，对于 $R_{4}$。\n\n因此，质量作用动力学方程为\n$$\n\\frac{d}{dt}\\begin{pmatrix}x \\\\ y\\end{pmatrix}\n= \\sum_{j=1}^{4} \\nu_{j} v_{j}\n= \\begin{pmatrix} +1 \\\\ 0 \\end{pmatrix} A\n+ \\begin{pmatrix} +1 \\\\ -1 \\end{pmatrix} x^{2}y\n+ \\begin{pmatrix} -1 \\\\ +1 \\end{pmatrix} Bx\n+ \\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix} x.\n$$\n等价地，\n$$\n\\begin{aligned}\n\\dot{x} = A - x + x^{2}y - Bx \\\\\n= A - (B+1)x + x^{2}y, \\\\\n\\dot{y} = -x^{2}y + Bx.\n\\end{aligned}\n$$\n\n接下来，动态物种的化学计量矩阵 $S$ 为，其列按 $(R_{1},R_{2},R_{3},R_{4})$ 的顺序由化学计量变化向量给出：\n$$\nS = \\begin{pmatrix}\n1  1  -1  -1 \\\\\n0  -1  1  0\n\\end{pmatrix}.\n$$\n这些列向量张成 $\\mathbb{R}^{2}$ 的一个子空间。我们检查其列秩。第一列和第二列分别是 $(1,0)^{\\top}$ 和 $(1,-1)^{\\top}$，它们是线性无关的，因为 $a(1,0)^{\\top}+b(1,-1)^{\\top}=(0,0)^{\\top}$ 的唯一解是 $a=b=0$。因此，$\\mathrm{rank}(S)=2$，化学计量子空间的维数为 $2$。因为 $A$、$B$、$D$ 和 $E$ 的浓度是恒定的，不存在涉及 $x$ 和 $y$ 的守恒关系来进一步降低维数；因此，动态物种的降维子系统已经是二维的。\n\n为求稳态 $(x^{\\ast},y^{\\ast})$，令 $\\dot{x}=0$ 和 $\\dot{y}=0$：\n$$\n\\begin{aligned}\n0 = A - (B+1)x^{\\ast} + (x^{\\ast})^{2}y^{\\ast}, \\\\\n0 = - (x^{\\ast})^{2} y^{\\ast} + B x^{\\ast}.\n\\end{aligned}\n$$\n从第二个方程，当 $x^{\\ast}0$ 时，我们得到\n$$\n(x^{\\ast})^{2} y^{\\ast} = B x^{\\ast} \\quad \\Rightarrow \\quad y^{\\ast} = \\frac{B}{x^{\\ast}}.\n$$\n代入第一个方程：\n$$\n0 = A - (B+1)x^{\\ast} + (x^{\\ast})^{2}\\left(\\frac{B}{x^{\\ast}}\\right)\n= A - (B+1)x^{\\ast} + B x^{\\ast}\n= A - x^{\\ast}.\n$$\n因此 $x^{\\ast}=A$，然后 $y^{\\ast} = \\dfrac{B}{A}$。这给出了唯一的正稳态\n$$\n(x^{\\ast},y^{\\ast}) = \\left(A,\\; \\frac{B}{A}\\right).\n$$\n\n我们现在在 $(x^{\\ast},y^{\\ast})$ 附近进行线性化。定义 $f(x,y)=A-(B+1)x+x^{2}y$ 和 $g(x,y)=Bx-x^{2}y$。雅可比矩阵为\n$$\nJ(x,y) = \\begin{pmatrix}\n\\frac{\\partial f}{\\partial x}  \\frac{\\partial f}{\\partial y} \\\\\n\\frac{\\partial g}{\\partial x}  \\frac{\\partial g}{\\partial y}\n\\end{pmatrix}\n= \\begin{pmatrix}\n-(B+1) + 2xy  x^{2} \\\\\nB - 2xy  -x^{2}\n\\end{pmatrix}.\n$$\n在 $(x^{\\ast},y^{\\ast})=\\left(A,\\dfrac{B}{A}\\right)$ 处，我们有 $x^{\\ast}y^{\\ast}=B$，因此\n$$\nJ^{\\ast} := J(x^{\\ast},y^{\\ast}) = \\begin{pmatrix}\n-(B+1) + 2B  A^{2} \\\\\nB - 2B  -A^{2}\n\\end{pmatrix}\n= \\begin{pmatrix}\nB - 1  A^{2} \\\\\n- B  -A^{2}\n\\end{pmatrix}.\n$$\n$J^{\\ast}$ 的特征多项式是 $\\lambda^{2} - (\\mathrm{tr}\\,J^{\\ast})\\lambda + \\det(J^{\\ast})=0$，其中\n$$\n\\mathrm{tr}\\,J^{\\ast} = (B-1) + (-A^{2}) = B - 1 - A^{2}, \\quad\n\\det(J^{\\ast}) = (B - 1)(-A^{2}) - (A^{2})(-B).\n$$\n计算行列式：\n$$\n\\det(J^{\\ast}) = -A^{2}(B - 1) + A^{2}B = A^{2}.\n$$\n在一个二维光滑系统中，当线性化后系统有一对简单的纯虚特征值且没有零特征值时，就会发生霍普夫分岔，这在雅可比矩阵的层面上意味着\n- $\\mathrm{tr}\\,J^{\\ast}=0$（因此实部为零），并且\n- $\\det(J^{\\ast})0$（因此特征值不为零且为纯虚数）。\n\n根据以上推导，\n$$\n\\mathrm{tr}\\,J^{\\ast}=0 \\quad \\Longleftrightarrow \\quad B - 1 - A^{2} = 0 \\quad \\Longleftrightarrow \\quad B = 1 + A^{2},\n$$\n并且\n$$\n\\det(J^{\\ast}) = A^{2}  0 \\quad \\text{对于所有 } A0.\n$$\n因此，霍普夫分岔发生在参数空间中的曲线 $B=1+A^{2}$ 上，分岔点对应的线性振荡角频率由特征值虚部的模给出，其大小等于\n$$\n\\omega = \\sqrt{\\det(J^{\\ast})} = A.\n$$\n\n最后，对于特定值 $A=\\tfrac{3}{2}$，霍普夫角频率为\n$$\n\\omega_{c} = A = \\frac{3}{2}.\n$$\n根据无量纲化的构造以及 $\\omega$ 作为角频率的定义，其单位为弧度/单位时间。", "answer": "$$\\boxed{\\frac{3}{2}}$$", "id": "2647395"}, {"introduction": "在实际研究中，化学反应网络往往过于复杂，难以进行精确分析，这迫使建模者使用近似方法，如准稳态近似（Quasi-Steady-State Approximation, QSSA）。然而，这些简化并非没有风险。本练习揭示了一个关键陷阱：不当应用的 QSSA 如何通过改变系统的稳定性来产生虚假的振荡，这对任何构建预测性动力学模型的人来说都是至关重要的一课 [@problem_id:2647406]。", "problem": "考虑以下三物种质量作用反应网络，该网络旨在模拟一个包含一个与其他物种相比弛豫速度极快的中间产物的最小化学振荡模块：\n- 一个核心双物种底物-产物模块，其中 $X$ 和 $Y$ 之间的普适慢反应由光滑函数 $f(x,y)$ 和 $g(x,y)$ 描述，这些函数不涉及 $Z$。假设 $f$ 和 $g$ 由标准质量作用步骤生成，并且在所关注的平衡点附近至少是连续可微的。\n- 一个快速中间产物 $Z$，它由 $X$ 产生，并通过一级衰变和依赖于 $Y$ 的相互作用而被移除：\n$$X \\xrightarrow{k_3} X + Z, \\quad Z \\xrightarrow{k_4} \\varnothing, \\quad Y + Z \\xrightarrow{k_5} \\varnothing.$$\n- 介导 $Z$ 对 $X$ 的抑制以及 $Z$ 对 $Y$ 的激发的耦合：\n$$X + Z \\xrightarrow{k_6} \\varnothing, \\quad Z \\xrightarrow{k_7} Y.$$\n\n在 $Z$ 相对于 $X$ 和 $Y$ 而言是快速物种的明确时间尺度分离的假设下，充分混合的确定性动力学可以写为\n$$\\frac{d x}{d t} \\;=\\; f(x,y) \\;-\\; k_6\\,x\\,z,$$\n$$\\frac{d y}{d t} \\;=\\; g(x,y) \\;+\\; k_7\\,z,$$\n$$\\varepsilon\\,\\frac{d z}{d t} \\;=\\; k_3\\,x \\;-\\; k_4\\,z \\;-\\; k_5\\,y\\,z,$$\n其中 $0  \\varepsilon\\ll 1$ 是小时间尺度参数。设 $(x_0,y_0,z_0)$ 是一个满足 $k_3 x_0 - k_4 z_0 - k_5 y_0 z_0 = 0$ 的正稳态。\n\n在 $(x_0,y_0)$ 处，慢 $(x,y)$ 子系统线性化的“不当”准稳态近似 (QSSA) 是通过直接代入代数快速平衡关系 $k_3 x - k_4 z - k_5 y z = 0$ 从等式右侧消去 $z$，然后如同 $z$ 与 $(x,y)$ 无关一样计算 $(x,y)$ 的雅可比矩阵得到的。相比之下，“恰当”的慢速简化通过链式法则考虑了 $z$ 对 $(x,y)$ 的依附关系。两种简化后的 $(x,y)$ 线性化之间的差异改变了 $(x,y)$ 雅可比矩阵的迹，因此可能在霍普夫 (Hopf) 分岔附近改变迹的符号，导致在不当 QSSA 下出现虚假振荡。\n\n从质量作用动力学出发，在 $(x_0,y_0,z_0)$ 处将整个系统线性化，将雅可比矩阵分块，其中慢块为 $A=\\partial(f,g)/\\partial(x,y)$，慢-快和快-慢耦合为 $B=\\partial(f,g)/\\partial z$ 和 $D=\\partial(k_3 x - k_4 z - k_5 y z)/\\partial(x,y)$，快块为 $C=\\partial(k_3 x - k_4 z - k_5 y z)/\\partial z$。对受支配的快变量使用链式法则，以获得“恰当”的慢雅可比矩阵，并将其与“不当”的雅可比矩阵进行比较，以明确显示迹的差异。然后，用动力学常数 $k_3,k_4,k_5,k_6,k_7$ 和稳态值 $x_0,y_0$（使用快速平衡关系消去 $z_0$）表示，给出由以下公式定义的迹差异 $\\Delta$ 的简化解析表达式：\n$$\\Delta \\;=\\; \\operatorname{tr}\\big(J_{\\text{improper}}\\big) \\;-\\; \\operatorname{tr}\\big(J_{\\text{proper}}\\big).$$\n\n最后，根据你的推导，阐明一个准则，该准则能保证不当 QSSA 不会在真实慢动力学的霍普夫 (Hopf) 分岔附近错误地改变迹的符号。你的准则必须在时间尺度分离和耦合强度方面具有物理可解释性。不要将该准则作为你的最终答案报告；仅报告所要求的 $\\Delta$ 的符号表达式作为你的最终答案。", "solution": "该方程组可以写成向量形式。设慢变量为 $\\mathbf{x}_s = (x, y)^T$，快变量为 $z$。动力学方程为：\n$$ \\frac{d\\mathbf{x}_s}{dt} = \\mathbf{F}(\\mathbf{x}_s, z) $$\n$$ \\varepsilon \\frac{dz}{dt} = h(\\mathbf{x}_s, z) $$\n其中 $\\mathbf{F}(\\mathbf{x}_s, z) = \\begin{pmatrix} f(x,y) - k_6xz \\\\ g(x,y) + k_7z \\end{pmatrix}$ 且 $h(\\mathbf{x}_s, z) = k_3x - k_4z - k_5yz$。\n\n我们在稳态 $(x_0, y_0, z_0)$ 附近将系统线性化。右手边函数的雅可比矩阵按指定分块：\n$A' = \\frac{\\partial \\mathbf{F}}{\\partial \\mathbf{x}_s}$，$B = \\frac{\\partial \\mathbf{F}}{\\partial z}$，$D = \\frac{\\partial h}{\\partial \\mathbf{x}_s}$，和 $C = \\frac{\\partial h}{\\partial z}$。\n设在 $(x_0, y_0)$ 处求值的 $f$ 和 $g$ 的偏导数记为 $f_x, f_y, g_x, g_y$。\n\n块 $A'$ 通过对 $\\mathbf{F}$ 关于 $x$ 和 $y$ 求导并在稳态处求值来计算：\n$$ A' = \\begin{pmatrix} \\frac{\\partial}{\\partial x}(f(x,y) - k_6xz)  \\frac{\\partial}{\\partial y}(f(x,y) - k_6xz) \\\\ \\frac{\\partial}{\\partial x}(g(x,y) + k_7z)  \\frac{\\partial}{\\partial y}(g(x,y) + k_7z) \\end{pmatrix}_{(x_0,y_0,z_0)} = \\begin{pmatrix} f_x - k_6z_0  f_y \\\\ g_x  g_y \\end{pmatrix} $$\n根据定义，“不当”QSSA通过将 $z$ 视为常数参数 $z_0$ 来计算雅可比矩阵。此过程恰好是 $A'$ 的计算。因此，$J_{\\text{improper}} = A'$。\n不当雅可比矩阵的迹为：\n$$ \\operatorname{tr}(J_{\\text{improper}}) = \\operatorname{tr}(A') = f_x - k_6z_0 + g_y $$\n\n“恰当”的QSSA雅可比矩阵是从由 $h(\\mathbf{x}_s, z) = 0$ 定义的慢流形上的动力学导出的。该流形由 $z = z^*(\\mathbf{x}_s)$ 给出。此流形上的动力学为 $\\frac{d\\mathbf{x}_s}{dt} = \\mathbf{F}(\\mathbf{x}_s, z^*(\\mathbf{x}_s))$。应用链式法则，此简化系统的雅可比矩阵为：\n$$ J_{\\text{proper}} = \\frac{d\\mathbf{F}}{d\\mathbf{x}_s} = \\frac{\\partial \\mathbf{F}}{\\partial \\mathbf{x}_s} + \\frac{\\partial \\mathbf{F}}{\\partial z} \\frac{dz^*}{d\\mathbf{x}_s} $$\n导数 $\\frac{dz^*}{d\\mathbf{x}_s}$ 通过使用隐函数定理对 $h(\\mathbf{x}_s, z^*(\\mathbf{x}_s))=0$ 求导得到：\n$$ \\frac{\\partial h}{\\partial \\mathbf{x}_s} + \\frac{\\partial h}{\\partial z} \\frac{dz^*}{d\\mathbf{x}_s} = 0 \\implies \\frac{dz^*}{d\\mathbf{x}_s} = - \\left(\\frac{\\partial h}{\\partial z}\\right)^{-1} \\frac{\\partial h}{\\partial \\mathbf{x}_s} $$\n用分块表示法，即为 $\\frac{dz^*}{d\\mathbf{x}_s} = -C^{-1}D$。将其代回，得到慢简化雅可比矩阵的标准公式：\n$$ J_{\\text{proper}} = A' - BC^{-1}D $$\n迹为 $\\operatorname{tr}(J_{\\text{proper}}) = \\operatorname{tr}(A') - \\operatorname{tr}(BC^{-1}D)$。\n因此，迹差异为 $\\Delta = \\operatorname{tr}(J_{\\text{improper}}) - \\operatorname{tr}(J_{\\text{proper}}) = \\operatorname{tr}(A') - (\\operatorname{tr}(A') - \\operatorname{tr}(BC^{-1}D)) = \\operatorname{tr}(BC^{-1}D)$。\n\n我们现在计算在稳态处的块 $B$、$C$ 和 $D$：\n$$ B = \\frac{\\partial \\mathbf{F}}{\\partial z} = \\begin{pmatrix} -k_6 x_0 \\\\ k_7 \\end{pmatrix} $$\n$$ C = \\frac{\\partial h}{\\partial z} = -k_4 - k_5 y_0 $$\n注意 $C$ 是一个标量，所以 $C^{-1} = -\\frac{1}{k_4 + k_5 y_0}$。\n$$ D = \\frac{\\partial h}{\\partial \\mathbf{x}_s} = \\begin{pmatrix} \\frac{\\partial h}{\\partial x}  \\frac{\\partial h}{\\partial y} \\end{pmatrix} = \\begin{pmatrix} k_3  -k_5 z_0 \\end{pmatrix} $$\n现在我们计算 $\\Delta = \\operatorname{tr}(BC^{-1}D)$。利用迹的循环性质，$\\operatorname{tr}(BC^{-1}D) = \\operatorname{tr}(C^{-1}DB) = C^{-1}DB$，因为 $C^{-1}DB$ 是一个标量（$1 \\times 1$ 矩阵）。\n$$ DB = \\begin{pmatrix} k_3  -k_5 z_0 \\end{pmatrix} \\begin{pmatrix} -k_6 x_0 \\\\ k_7 \\end{pmatrix} = -k_3 k_6 x_0 - k_5 k_7 z_0 $$\n$$ \\Delta = C^{-1}DB = \\left(-\\frac{1}{k_4 + k_5 y_0}\\right) (-k_3 k_6 x_0 - k_5 k_7 z_0) = \\frac{k_3 k_6 x_0 + k_5 k_7 z_0}{k_4 + k_5 y_0} $$\n最后一步是利用快变量的稳态条件 $k_3 x_0 - k_4 z_0 - k_5 y_0 z_0 = 0$ 来消去 $z_0$。这得到 $z_0 = \\frac{k_3 x_0}{k_4 + k_5 y_0}$。\n将 $z_0$ 的这个表达式代入我们得到的 $\\Delta$ 结果中：\n$$ \\Delta = \\frac{k_3 k_6 x_0 + k_5 k_7 \\left(\\frac{k_3 x_0}{k_4 + k_5 y_0}\\right)}{k_4 + k_5 y_0} $$\n为了简化，提取公因子并合并分数：\n$$ \\Delta = \\frac{k_3 x_0 \\left( k_6 + \\frac{k_5 k_7}{k_4 + k_5 y_0} \\right)}{k_4 + k_5 y_0} = \\frac{k_3 x_0 \\left( \\frac{k_6(k_4 + k_5 y_0) + k_5 k_7}{k_4 + k_5 y_0} \\right)}{k_4 + k_5 y_0} $$\n这就得到了迹差异的最终简化表达式：\n$$ \\Delta = \\frac{k_3 x_0 (k_4 k_6 + k_5 k_6 y_0 + k_5 k_7)}{(k_4 + k_5 y_0)^2} $$\n\n最后，我们阐明一个在霍普夫分岔附近不当 QSSA 有效性的准则。\n由于所有速率常数 ($k_i$) 和稳态浓度 ($x_0, y_0$) 均为正，差异 $\\Delta$ 严格为正。\n迹之间的关系是 $\\operatorname{tr}(J_{\\text{improper}}) = \\operatorname{tr}(J_{\\text{proper}}) + \\Delta$。这意味着不当 QSSA 系统性地高估了迹，使系统偏向不稳定性。当 $\\operatorname{tr}(J_{\\text{proper}})$ 穿过零时，真实的慢系统中会发生霍普夫分岔。如果 $\\operatorname{tr}(J_{\\text{proper}})$ 是一个小的负数，但 $\\Delta  |\\operatorname{tr}(J_{\\text{proper}})|$，使得 $\\operatorname{tr}(J_{\\text{improper}})$ 为正，就可能出现虚假的振荡（不稳定性）预测。\n为了保证不当 QSSA 不会错误地改变迹的符号，差异 $\\Delta$ 必须是可忽略不计的。在物理上，这意味着涉及快变量 $Z$ 的反馈回路必须很弱，或者 $Z$ 的特征弛豫时间必须比这些反馈相互作用的时间尺度快得多。$Z$ 的弛豫速率为 $\\tau_Z^{-1} = k_4 + k_5 y_0$。差异 $\\Delta$ 的单位也是速率，代表了“隐藏”反馈效应的量级。\n一个稳健的准则就是，这两个速率的无量纲比率必须远小于 1：\n$$ \\frac{\\Delta}{\\tau_Z^{-1}} = \\frac{\\Delta}{k_4 + k_5 y_0} \\ll 1 $$\n这确保了对迹的修正与快动力学本身的速率相比是微不足道的，而这是有效时间尺度分离的基本条件。当这个准则成立时，$\\operatorname{tr}(J_{\\text{improper}}) \\approx \\operatorname{tr}(J_{\\text{proper}})$，并且不当近似在确定稳定性边界时变得可靠。", "answer": "$$\n\\boxed{\\frac{k_3 x_0 (k_4 k_6 + k_5 k_6 y_0 + k_5 k_7)}{(k_4 + k_5 y_0)^2}}\n$$", "id": "2647406"}, {"introduction": "解析理论预测了在霍普夫分岔点会诞生极限环，但它并未描述这个轨道本身。这个计算练习通过指导你实现一个数值打靶法来弥合预测与现实之间的鸿沟 [@problem_id:2647420]。你将学会如何计算从分岔中出现的周期轨道，并使用弗洛凯理论 (Floquet theory) 严格验证其稳定性，这是分析动力系统中周期解的强大技术。", "problem": "考虑无量纲布鲁塞尔振子 (Brusselator) 化学反应模型，这是一个双物种自催化网络，广泛用于研究化学动力学中的振荡。物种浓度的动力学系统为\n$$\n\\frac{dx}{dt} = f_1(x,y;A,B) = A - (B+1)\\,x + x^2 y,\\qquad\n\\frac{dy}{dt} = f_2(x,y;A,B) = B\\,x - x^2 y,\n$$\n其中参数 $A0$ 且 $B0$。唯一的均匀稳态是\n$$\nx^\\ast = A,\\quad y^\\ast = \\frac{B}{A}.\n$$\n在 $B=1+A^2$ 时，关于 $(x^\\ast,y^\\ast)$ 的线性化系统有一对纯虚特征值（一个霍普夫点），而对于 $B1+A^2$，稳态变得不稳定，并出现一个稳定的周期轨道（超临界霍普夫）。您的任务是通过单次打靶法计算分岔点附近的一个此类轨道，然后检查其弗洛凯乘子，从而数值验证所检测到的霍普夫分岔确实产生了小振幅周期轨道。\n\n您必须从动力系统和数值分析的基本原理出发，实现以下内容，不得依赖任何预打包的延拓或配置工具箱。\n\n- 使用上面给出的常微分方程 (ODE) 模型作为控制方程，以及连续时间自治系统的周期轨道定义：存在一个轨迹 $(x(t),y(t))$ 和一个周期 $T0$，使得对于所有 $t$，都有 $(x(t+T),y(t+T))=(x(t),y(t))$。\n\n- 使用单次打靶法，为未知初始点 $(x_0,y_0)$ 和周期 $T$ 构建一个非线性系统，该系统通过一个标量相位条件来强制周期性并消除时间平移不确定性。使用相位条件\n$$\ng(x_0,y_0;A,\\rho)= (x_0 - x^\\ast) - \\rho = 0,\n$$\n其中 $\\rho0$ 是用户指定的小振幅目标。您必须求解的非线性系统是\n$$\n\\Phi_T(x_0,y_0;A,B) - \\begin{bmatrix}x_0\\\\y_0\\end{bmatrix} = \\begin{bmatrix}0\\\\0\\end{bmatrix},\\qquad\ng(x_0,y_0;A,\\rho)=0,\n$$\n其中 $\\Phi_T$ 表示 ODE 的时间-$T$ 流映射。使用标准的牛顿型求根方法求解该系统，通过对 ODE 进行数值时间积分来计算 $\\Phi_T$。\n\n- 在获得一个候选周期轨道 $(x^\\star(t),y^\\star(t))$ 和周期 $T^\\star$ 后，通过沿周期轨道积分 $2\\times 2$ 变分方程来计算单值矩阵，\n$$\n\\frac{d}{dt}Y(t) = J(x^\\star(t),y^\\star(t);A,B)\\,Y(t),\\qquad Y(0)=I_{2},\n$$\n其中 $J$ 是 $(f_1,f_2)$ 关于 $(x,y)$ 的雅可比矩阵，$I_2$ 是 $2\\times 2$ 单位矩阵。$Y(T^\\star)$ 的特征值即为弗洛凯乘子。对于一个平面自治系统中的稳定极限环，一个弗洛凯乘子必须是 $1$（由于时间平移不变性），另一个的模必须小于 $1$。\n\n- 实现一个数值验证规则，该规则返回一个布尔值，指示在给定参数下，是否通过具有预期弗洛凯乘子的小振幅周期轨道验证了霍普夫分岔。您的规则必须检查以下所有内容：\n  - 打靶方程被高精度求解，意味着周期性残差\n    $$\n    r_{\\text{per}} = \\left\\|\\Phi_{T^\\star}(x_0^\\star,y_0^\\star;A,B) - \\begin{bmatrix}x_0^\\star\\\\y_0^\\star\\end{bmatrix}\\right\\|_2\n    $$\n    低于您选择的容差，并且 $T^\\star0$ 相对于线性振荡时间尺度是合理的。\n  - 轨道具有与霍普夫分岔一致的非平凡小振幅。将振幅量化为在一个周期内的最大径向偏差，\n    $$\n    \\max_{t\\in[0,T^\\star]} \\sqrt{(x^\\star(t)-x^\\ast)^2 + (y^\\star(t)-y^\\ast)^2},\n    $$\n    并要求它超过一个小的阈值，同时与 1 阶浓度相比保持较小。\n  - 弗洛凯乘子中，一个乘子在数值上接近 $1$，另一个严格在单位圆内。\n\n- 仅使用上述基本定义、ODE 及其雅可比矩阵，以及标准的积分和求根数值方法；您不得使用任何专门的周期轨道或延拓库。\n\n您的程序必须对以下参数集 $(A,B,\\rho)$ 的测试套件实现此过程，这些参数集旨在探测霍普夫阈值的两侧以及距阈值两种不同的距离：\n- 情况 1（超临界侧，接近）：$(A,B,\\rho) = (\\,1.0,\\,2.05,\\,0.05\\,)$。\n- 情况 2（亚临界侧，接近）：$(A,B,\\rho) = (\\,1.0,\\,1.95,\\,0.05\\,)$。\n- 情况 3（在现行霍普夫点）：$(A,B,\\rho) = (\\,1.0,\\,2.0,\\,0.05\\,)$。\n- 情况 4（超临界侧，较远）：$(A,B,\\rho) = (\\,1.2,\\,2.64,\\,0.04\\,)$。\n\n对于每种情况，输出一个布尔值，当且仅当您的数值程序根据您的量化检查验证了一个具有一个弗洛凯乘子接近 $1$ 而另一个严格在单位圆内的小振幅周期轨道时，该值为真。您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，“[true_or_false_1,true_or_false_2,true_or_false_3,true_or_false_4]”），其中每个条目是 Python 字面布尔值 \"True\" 或 \"False\"。所有计算都是无量纲的，不需要物理单位。确保您的数值容差和阈值在代码中声明，根据上述定义给出合理解释，并在所有情况下一致应用。最终输出必须是指定格式的单行文本。", "solution": "所提出的问题是计算动力系统领域一个明确定义的练习。它要求使用标准的、基本的技术来数值验证布鲁塞尔振子模型中的超临界霍普夫分岔：使用单次打靶法定位周期轨道和使用弗洛凯理论进行稳定性分析。问题的所有组成部分——模型、控制方程、数值方法的描述以及验证标准——都是科学上合理、自成体系且客观的。不存在矛盾、歧义或事实不准确之处。因此，该问题被认为是有效的，我们可以着手解决。\n\n我们的目标是实现一个数值程序，以找到布鲁塞尔振子系统的周期轨道并分析其稳定性。这涉及求解一个边值问题，我们将使用单次打靶法来构建该问题，然后计算所找到轨道的弗洛凯乘子。\n\n该动力学系统由以下自治常微分方程 (ODE) 组给出：\n$$\n\\frac{dx}{dt} = f_1(x,y;A,B) = A - (B+1)x + x^2y\n$$\n$$\n\\frac{dy}{dt} = f_2(x,y;A,B) = Bx - x^2y\n$$\n状态向量为 $X(t) = [x(t), y(t)]^T$，向量场为 $F(X; A, B) = [f_1, f_2]^T$。该系统在 $X^\\ast = [x^\\ast, y^\\ast]^T = [A, B/A]^T$ 处有一个唯一的均匀稳态。\n\n一个周期为 $T0$、起始于 $X_0 = [x_0, y_0]^T$ 的周期轨道必须满足周期性条件 $X(T) = X_0$。使用流映射 $\\Phi_T$（它将初始点 $X_0$ 映射到时间 $T$ 的解），这变为 $\\Phi_T(X_0; A, B) - X_0 = 0$。这代表了两个关于三个未知数（$x_0$，$y_0$，$T$）的方程。为了获得一个适定系统，我们必须添加第三个方程，即一个相位条件，以消除轨道的平移不变性。问题指定了相位条件：\n$$\ng(x_0, y_0; A, \\rho) = x_0 - x^\\ast - \\rho = 0\n$$\n这将轨道的初始点约束在相平面中的一条特定直线上。我们将这些组合成一个关于未知向量 $U = [x_0, y_0, T]^T$ 的三个非线性方程组：\n$$\n\\mathcal{F}(U; A, B, \\rho) = \\begin{bmatrix} \\Phi_{T,x}(x_0,y_0) - x_0 \\\\ \\Phi_{T,y}(x_0,y_0) - y_0 \\\\ x_0 - A - \\rho \\end{bmatrix} = 0\n$$\n\n我们使用牛顿-拉夫逊方法求解这个系统。给定一个迭代值 $U^{(k)}$，下一个迭代值是 $U^{(k+1)} = U^{(k)} + \\Delta U^{(k)}$，其中更新量 $\\Delta U^{(k)}$ 是以下线性系统的解：\n$$\nD\\mathcal{F}(U^{(k)}) \\Delta U^{(k)} = -\\mathcal{F}(U^{(k)})\n$$\n这里，$D\\mathcal{F}$ 是系统 $\\mathcal{F}$ 关于 $U$ 的雅可比矩阵。为了计算这个雅可比矩阵，我们需要流映射 $\\Phi_T$ 的导数。关于初始条件的导数 $\\partial \\Phi_T / \\partial X_0$ 是单值矩阵，我们将其表示为 $Y(T)$。这个矩阵是在时间 $T$ 处变分方程的解：\n$$\n\\frac{dY(t)}{dt} = J(X(t)) Y(t), \\quad Y(0) = I_2\n$$\n其中 $J(X(t))$ 是向量场 $F$ 沿轨迹 $X(t)$ 计算的雅可比矩阵：\n$$\nJ(x,y) = \\frac{\\partial F}{\\partial X} = \\begin{pmatrix} 2xy - (B+1)  x^2 \\\\ B - 2xy  -x^2 \\end{pmatrix}\n$$\n流关于周期 $T$ 的导数是向量场本身在轨迹终点处的值：$\\partial \\Phi_T / \\partial T = F(\\Phi_T(X_0))$。有了这些元素，牛顿法的雅可比矩阵为：\n$$\nD\\mathcal{F}(U) = \\begin{bmatrix} Y_{11}(T) - 1  Y_{12}(T)  f_1(x(T), y(T)) \\\\ Y_{21}(T)  Y_{22}(T) - 1  f_2(x(T), y(T)) \\\\ 1  0  0 \\end{bmatrix}\n$$\n在每个牛顿步骤中，我们对状态 $X(t)$ 和展开的灵敏度矩阵 $Y(t)$ 的 6 个 ODE 组成的增广系统进行从 $t=0$ 到 $t=T$ 的数值积分。这提供了组装 $\\mathcal{F}$ 和 $D\\mathcal{F}$ 所需的所有组件。牛顿迭代的一个合适的初始猜测源于霍普夫点 $B_c = 1+A^2$ 处的线性稳定性分析。该点处的振荡频率为 $\\omega_c = A$，这表明初始周期猜测为 $T^{(0)} = 2\\pi/A$。相位条件确定了 $x_0^{(0)} = A+\\rho$，为简单起见，我们取 $y_0^{(0)} = B/A$。\n\n当牛顿求解器收敛到解 $U^\\star = [x_0^\\star, y_0^\\star, T^\\star]^T$ 时，我们便得到了候选周期轨道。该轨道的稳定性由弗洛凯乘子决定，这些乘子是沿轨道计算的单值矩阵 $Y(T^\\star)$ 的特征值。对于自治平面系统，一个乘子 $\\mu_1$ 必须为 $1$。对于稳定的极限环，另一个乘子 $\\mu_2$ 的模必须小于 $1$，即 $|\\mu_2|1$。\n\n我们实现一个验证函数，对于给定的参数集 $(A, B, \\rho)$，它会验证以下条件：\n1.  **收敛性：** 牛顿法收敛到一个解，其中周期性残差 $\\|\\Phi_{T^\\star}(X_0^\\star) - X_0^\\star\\|_2$ 低于 $10^{-10}$ 的容差。\n2.  **周期合理性：** 周期 $T^\\star$ 是正且合理的，我们通过确保它与线性估计 $2\\pi/A$ 的偏差在 $50\\%$ 以内来定量评估。\n3.  **振幅：** 轨道的振幅，定义为 $\\max_{t \\in [0,T^\\star]} \\sqrt{(x(t)-x^\\ast)^2 + (y(t)-y^\\ast)^2}$，必须是非平凡但小的，具体在 $[0.5\\rho, 5\\rho]$ 范围内。这确认了我们找到了一个小振幅极限环，而不是不动点本身或一个大的、不相关的振荡。\n4.  **弗洛凯乘子：** 一个乘子在数值上接近 $1$（在 $10^{-6}$ 范围内），另一个严格位于单位圆内部（模小于 $1-10^{-6}$）。\n\n只有当所有这些条件都满足时，我们才验证存在一个与超临界霍普夫分岔一致的、稳定的、小振幅的周期轨道。这个严谨的程序将应用于每个测试用例。", "answer": "[True,False,False,True]", "id": "2647420"}]}