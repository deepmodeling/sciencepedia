{"hands_on_practices": [{"introduction": "本练习将带你直接接触图灵失稳的核心数学机制。从一个给定的线性化系统出发，你将直接应用线性稳定性分析得出的判据，来确定空间格局能够涌现的参数范围。这项练习旨在磨练你运用控制格局形成的核心代数条件的能力。[@problem_id:2661473]", "problem": "考虑一个一维空间中的双物种反应扩散系统，该系统经过无量纲化，使得第一个物种的扩散系数为1。设在均匀稳态附近的局部反应动力学的线性化由雅可比矩阵表示\n$$\nJ \\;=\\;\n\\begin{pmatrix}\n1  -2 \\\\\n3  -5\n\\end{pmatrix},\n$$\n并设扩散矩阵为\n$$\nD \\;=\\; \\operatorname{diag}(1,d),\n$$\n其中 $d0$ 是第二个物种相对于第一个物种的（无量纲）扩散系数比。用 $f_u$、$f_v$、$g_u$ 和 $g_v$ 表示稳态下反应速率的偏导数，因此 $J=\\begin{pmatrix} f_u  f_v \\\\ g_u  g_v \\end{pmatrix}$。\n\n从反应扩散偏微分方程（PDE）中空间均匀稳态在波数为 $k$ 的傅里叶模式扰动下的线性稳定性分析出发，并仅利用以下基本事实：(i) 无扩散时动力学的稳定性要求迹 $\\tau=f_u+g_v$ 为负，行列式 $\\Delta=f_u g_v - f_v g_u$ 为正；(ii) 扩散通过从 $J$ 中减去 $k^2 D$ 来修正线性算子。请完成以下任务：\n\n1. 推导增长率作为 $k^2$ 函数的色散关系，并由此获得在无扩散时动力学稳定的情况下，存在扩散驱动不稳定性（图灵不稳定性）的充要条件。\n\n2. 将这些条件应用于给定的 $J$ 和 $D$，确定发生图灵不稳定性的 $d$ 的取值范围。推导出在该范围内，不稳定波数带的端点 $k_{-}^2$ 和 $k_{+}^2$ 作为 $d$ 的函数的显式表达式。\n\n3. 确定临界扩散系数比 $d_c$（可能发生图灵不稳定性的最小 $d$ 值），并计算相应的临界波数 $k_c^2$（在此波数下，两个带端点在失稳开始时合并）。\n\n以单行矩阵 $\\bigl(d_c,\\,k_c^2\\bigr)$ 的形式提供您的最终答案。无需四舍五入；给出精确值。假设所有量都是无量纲的，因此无需报告物理单位。最终答案中不要包含任何不等式。", "solution": "该问题要求对一个双物种反应扩散系统进行线性稳定性分析。系统的状态由浓度向量 $\\mathbf{c} = (u,v)^T$ 描述。从均匀稳态 $\\mathbf{c}_0$ 出发的小扰动 $\\delta\\mathbf{c}$ 的演化由以下线性化偏微分方程控制：\n$$ \\frac{\\partial}{\\partial t} \\delta\\mathbf{c} = J \\delta\\mathbf{c} + D \\nabla^2 \\delta\\mathbf{c} $$\n其中 $J$ 是反应动力学的雅可比矩阵，$D$ 是扩散系数的对角矩阵，两者均在稳态 $\\mathbf{c}_0$ 处取值。给定：\n$$ J = \\begin{pmatrix} f_u  f_v \\\\ g_u  g_v \\end{pmatrix} = \\begin{pmatrix} 1  -2 \\\\ 3  -5 \\end{pmatrix}, \\quad D = \\begin{pmatrix} 1  0 \\\\ 0  d \\end{pmatrix} $$\n我们考虑一维空间中的傅里叶模式扰动 $\\delta\\mathbf{c}(x,t) = \\mathbf{u}_k \\exp(\\lambda t + i k x)$，其中 $k$ 是波数，$\\lambda$ 是增长率。将其代入控制方程，得到关于 $\\lambda$ 的特征值问题：\n$$ \\lambda \\mathbf{u}_k = (J - k^2 D) \\mathbf{u}_k $$\n增长率 $\\lambda$ 是矩阵 $J_k = J - k^2 D$ 的特征值。对于给定的波数 $k$，系统的稳定性由这些特征值实部的符号决定。特征值是特征多项式 $\\det(J_k - \\lambda I) = 0$ 的根，即\n$$ \\lambda^2 - \\tau_k \\lambda + \\Delta_k = 0 $$\n其中 $\\tau_k = \\operatorname{tr}(J_k)$ 且 $\\Delta_k = \\operatorname{det}(J_k)$。\n具体来说，迹为：\n$$ \\tau_k = \\operatorname{tr}(J - k^2 D) = (f_u - k^2) + (g_v - d k^2) = (f_u + g_v) - (1+d)k^2 = \\tau - (1+d)k^2 $$\n行列式为：\n$$ \\Delta_k = \\det(J - k^2 D) = (f_u - k^2)(g_v - d k^2) - f_v g_u = (f_u g_v - f_v g_u) - (d f_u + g_v)k^2 + d k^4 = \\Delta - (d f_u + g_v)k^2 + d k^4 $$\n当稳态对纯粹的时间扰动（即 $k=0$ 时）是稳定的，但对某个波数 $k \\neq 0$ 的空间扰动是不稳定时，就会发生扩散驱动不稳定性，或称图灵不稳定性。\n\n首先，我们验证无扩散时（$k=0$）动力学的稳定性。$J$ 的特征值必须具有负实部。这要求 $\\tau = \\operatorname{tr}(J)  0$ 且 $\\Delta = \\det(J)  0$。对于给定的雅可比矩阵：\n$$ \\tau = f_u + g_v = 1 + (-5) = -4 $$\n$$ \\Delta = f_u g_v - f_v g_u = (1)(-5) - (-2)(3) = -5 + 6 = 1 $$\n由于 $\\tau = -4  0$ 且 $\\Delta = 1  0$，因此在没有扩散的情况下，空间均匀稳态是稳定的，符合题设要求。\n\n接下来，我们寻找由扩散驱动的不稳定性的条件，即对于某个 $k^2  0$，有 $\\operatorname{Re}(\\lambda)  0$。特征方程的根为 $\\lambda = (\\tau_k \\pm \\sqrt{\\tau_k^2 - 4\\Delta_k}) / 2$。已知 $\\tau  0$ 且 $d0$，因此对于任何 $k$，$\\tau_k = \\tau - (1+d)k^2$ 总是负的。因此，霍普夫（Hopf）分岔（即对于某个 $k$，$\\tau_k=0$）是不可能发生的。不稳定性只可能在某个特征值变为实数且为正时出现。由于 $\\tau_k  0$，要使 $\\lambda$ 为正，必须有 $\\sqrt{\\tau_k^2 - 4\\Delta_k}  -\\tau_k$，这等价于 $\\tau_k^2 - 4\\Delta_k  \\tau_k^2$，或简写为 $\\Delta_k  0$。\n\n因此，扩散驱动不稳定性的条件是 $\\Delta_k$ 必须在某个正的 $k^2$ 值范围内为负。令 $K = k^2$。函数 $\\Delta_k(K) = d K^2 - (d f_u + g_v)K + \\Delta$ 是一个关于 $K$ 的开口向上的抛物线（因为 $d0$）。在 $K=0$ 时，$\\Delta_k(0) = \\Delta  0$。要使该抛物线在某个 $K0$ 的区间内为负，必须满足两个条件：\n1. 抛物线的顶点必须位于一个正的 $K$ 值处。最小值出现在 $K = (d f_u + g_v)/(2d)$。这要求 $d f_u + g_v  0$。\n2. 在此最小值处的 $\\Delta_k$ 值必须为负。最小值为 $\\Delta - (d f_u + g_v)^2 / (4d)$。因此，我们需要 $\\Delta - (d f_u + g_v)^2 / (4d)  0$，这等价于 $(d f_u + g_v)^2  4d\\Delta$。\n这就完成了图灵不稳定性的一般充要条件的推导。\n\n现在我们将这些条件应用于给定的问题。当 $f_u=1$，$g_v=-5$，且 $\\Delta=1$ 时，这些条件变为：\n1. $d(1) + (-5)  0 \\implies d  5$。\n2. $(d(1) - 5)^2  4d(1) \\implies (d-5)^2  4d$。\n展开第二个不等式得到 $d^2 - 10d + 25  4d$，简化为 $d^2 - 14d + 25  0$。为了找到这个不等式成立的条件，我们求解二次方程 $d^2 - 14d + 25 = 0$ 的根：\n$$ d = \\frac{14 \\pm \\sqrt{(-14)^2 - 4(1)(25)}}{2} = \\frac{14 \\pm \\sqrt{196 - 100}}{2} = \\frac{14 \\pm \\sqrt{96}}{2} = \\frac{14 \\pm 4\\sqrt{6}}{2} = 7 \\pm 2\\sqrt{6} $$\n抛物线 $d^2 - 14d + 25$ 在 $d  7+2\\sqrt{6}$ 或 $d  7-2\\sqrt{6}$ 时为正。我们必须同时满足这个条件和 $d5$。\n根 $7-2\\sqrt{6} = 7-\\sqrt{24}$ 在 2 和 3 之间，所以区域 $d  7-2\\sqrt{6}$ 与 $d5$ 不兼容。\n根 $7+2\\sqrt{6} = 7+\\sqrt{24}$ 大于 $7+\\sqrt{16}=11$，因此条件 $d  7+2\\sqrt{6}$ 蕴含了 $d5$。\n因此，发生图灵不稳定性的扩散系数比 $d$ 的范围是 $d  7+2\\sqrt{6}$。\n\n不稳定波数带 $(k_{-}^2, k_{+}^2)$ 是 $\\Delta_k  0$ 成立的 $k^2  0$ 的区间。端点 $k_{-}^2$ 和 $k_{+}^2$ 是方程 $\\Delta_k = d(k^2)^2 - (d-5)k^2 + 1 = 0$ 的根。对 $k^2$ 使用二次公式：\n$$ k^2 = \\frac{(d-5) \\pm \\sqrt{(d-5)^2 - 4d}}{2d} = \\frac{d-5 \\pm \\sqrt{d^2 - 14d + 25}}{2d} $$\n对于 $d  7+2\\sqrt{6}$，判别式为正，并且由于 $d5$，根的和 $(d-5)/d$ 与根的积 $1/d$ 均为正，这保证了 $k^2$ 有两个不同的正根。端点是：\n$$ k_{-}^2 = \\frac{d-5 - \\sqrt{d^2 - 14d + 25}}{2d}, \\quad k_{+}^2 = \\frac{d-5 + \\sqrt{d^2 - 14d + 25}}{2d} $$\n\n最后，我们确定临界扩散系数比 $d_c$ 和相应的临界波数 $k_c^2$。不稳定的起始点发生在满足不稳定条件的最小 $d$ 值处。这对应于不稳定带出现的点，即当 $k_{-}^2 = k_{+}^2$ 时。这种情况发生在关于 $k^2$ 的二次方程的判别式为零时：\n$$ d_c^2 - 14d_c + 25 = 0 $$\n如前所述，满足约束 $d_c  5$ 的唯一根是 $d_c = 7+2\\sqrt{6}$。这就是临界扩散系数比。\n\n在这个临界值下，波数 $k_c^2$ 是唯一的：\n$$ k_c^2 = \\frac{d_c - 5}{2d_c} $$\n代入 $d_c$ 的表达式：\n$$ k_c^2 = \\frac{(7+2\\sqrt{6}) - 5}{2(7+2\\sqrt{6})} = \\frac{2+2\\sqrt{6}}{2(7+2\\sqrt{6})} = \\frac{1+\\sqrt{6}}{7+2\\sqrt{6}} $$\n为了简化，我们将分母有理化：\n$$ k_c^2 = \\frac{1+\\sqrt{6}}{7+2\\sqrt{6}} \\cdot \\frac{7-2\\sqrt{6}}{7-2\\sqrt{6}} = \\frac{(1+\\sqrt{6})(7-2\\sqrt{6})}{7^2 - (2\\sqrt{6})^2} = \\frac{7 - 2\\sqrt{6} + 7\\sqrt{6} - 2(6)}{49 - 24} = \\frac{-5 + 5\\sqrt{6}}{25} = \\frac{5(\\sqrt{6}-1)}{25} $$\n$$ k_c^2 = \\frac{\\sqrt{6}-1}{5} $$\n所求的临界值为 $d_c = 7+2\\sqrt{6}$ 和 $k_c^2 = \\frac{\\sqrt{6}-1}{5}$。", "answer": "$$\\boxed{\\begin{pmatrix} 7+2\\sqrt{6}  \\frac{\\sqrt{6}-1}{5} \\end{pmatrix}}$$", "id": "2661473"}, {"introduction": "在掌握了基本分析方法后，我们将从抽象系统转向一个具体的化学模型——著名的 Schnakenberg 动力学。这个问题要求你进行完整的分析：找到系统的稳态，对反应动力学进行线性化，然后应用图灵条件来确定临界扩散比。你还将探索有限区域上的边界条件如何导致一组离散的不稳定模式，从而将连续理论与更实际的情景联系起来。[@problem_id:2661515]", "problem": "考虑在长度为 $L=10$ 的一维区间上，具有 Schnakenberg 动力学的双物种反应扩散系统，该系统满足齐次诺伊曼边界条件（端点处无通量）：\n$$\n\\frac{\\partial u}{\\partial t} = d_1 \\frac{\\partial^2 u}{\\partial x^2} + f(u,v), \n\\qquad\n\\frac{\\partial v}{\\partial t} = d_2 \\frac{\\partial^2 v}{\\partial x^2} + g(u,v),\n$$\n其中局部反应项为\n$$\nf(u,v) = a - u + u^2 v, \n\\qquad\ng(u,v) = b - u^2 v,\n$$\n参数为 $a=0.2$、$b=1.3$、$d_1=1$ 和待定的 $d_20$。令 $(u^\\ast,v^\\ast)$ 表示唯一的正常数均匀稳态，令 $J$ 为 $(f,g)$ 在 $(u^\\ast,v^\\ast)$ 处求值的雅可比矩阵。仅使用第一性原理（在 $(u^\\ast,v^\\ast)$ 附近进行线性化，并根据诺伊曼边界条件将变量分离为拉普拉斯特征模态），确定以下内容：\n\n1) 首次出现扩散驱动（图灵）不稳定性时的临界扩散系数 $d_{2,c}$ 的精确解析表达式。\n\n2) 连续模态指数边界 $n_-^\\ast(d_2)$ 和 $n_+^\\ast(d_2)$ 的精确解析表达式，使得当 $d_2d_{2,c}$ 时，不稳定的离散诺伊曼模态恰好是满足 $n_-^\\ast(d_2)  n  n_+^\\ast(d_2)$ 的整数 $n$。此处离散诺伊曼特征波数为 $k_n = n \\pi/L$。\n\n将您的最终结果以单行矩阵的形式报告，其中包含按顺序排列的三个闭式表达式 $\\big(d_{2,c},\\,n_-^\\ast(d_2),\\,n_+^\\ast(d_2)\\big)$。不要近似或四舍五入；给出精确表达式。最终答案中不需要单位。", "solution": "该问题提法恰当且有科学依据。我们开始求解。\n\n首先，我们通过将反应项 $f(u,v)$ 和 $g(u,v)$ 置零来找到唯一的正常数均匀稳态 $(u^\\ast, v^\\ast)$：\n$$\n\\begin{cases}\n    f(u,v) = a - u + u^2 v = 0 \\\\\n    g(u,v) = b - u^2 v = 0\n\\end{cases}\n$$\n从第二个方程，我们得到 $u^2 v = b$。将其代入第一个方程，得到 $a - u + b = 0$，这给出 $u^\\ast = a+b$。\n将 $u^\\ast$ 代回 $u^2 v = b$ 得到 $(a+b)^2 v^\\ast = b$，所以 $v^\\ast = \\frac{b}{(a+b)^2}$。\n使用给定参数 $a=0.2$ 和 $b=1.3$：\n$u^\\ast = 0.2 + 1.3 = 1.5 = \\frac{3}{2}$\n$v^\\ast = \\frac{1.3}{(0.2+1.3)^2} = \\frac{1.3}{1.5^2} = \\frac{1.3}{2.25} = \\frac{13/10}{9/4} = \\frac{13}{10} \\cdot \\frac{4}{9} = \\frac{52}{90} = \\frac{26}{45}$。\n\n接下来，我们围绕该稳态对系统进行线性化。反应动力学的雅可比矩阵是：\n$$ J = \\begin{pmatrix} \\frac{\\partial f}{\\partial u}  \\frac{\\partial f}{\\partial v} \\\\ \\frac{\\partial g}{\\partial u}  \\frac{\\partial g}{\\partial v} \\end{pmatrix} = \\begin{pmatrix} -1+2uv  u^2 \\\\ -2uv  -u^2 \\end{pmatrix} $$\n在 $(u^\\ast, v^\\ast)$ 处求值：\n$f_u^\\ast \\equiv \\frac{\\partial f}{\\partial u}\\Big|_{(u^\\ast,v^\\ast)} = -1 + 2u^\\ast v^\\ast = -1 + 2(a+b)\\frac{b}{(a+b)^2} = -1 + \\frac{2b}{a+b} = -1 + \\frac{2(1.3)}{1.5} = -1 + \\frac{2.6}{1.5} = \\frac{11}{15}$。\n$f_v^\\ast \\equiv \\frac{\\partial f}{\\partial v}\\Big|_{(u^\\ast,v^\\ast)} = (u^\\ast)^2 = (a+b)^2 = (1.5)^2 = 2.25 = \\frac{9}{4}$。\n$g_u^\\ast \\equiv \\frac{\\partial g}{\\partial u}\\Big|_{(u^\\ast,v^\\ast)} = -2u^\\ast v^\\ast = -\\frac{2b}{a+b} = -\\frac{2(1.3)}{1.5} = -\\frac{2.6}{1.5} = -\\frac{26}{15}$。\n$g_v^\\ast \\equiv \\frac{\\partial g}{\\partial v}\\Big|_{(u^\\ast,v^\\ast)} = -(u^\\ast)^2 = -(a+b)^2 = -(1.5)^2 = -2.25 = -\\frac{9}{4}$。\n因此，稳态处的雅可比矩阵为 $J = \\begin{pmatrix} 11/15  9/4 \\\\ -26/15  -9/4 \\end{pmatrix}$。\n\n扩散驱动不稳定性要求均匀稳态在没有扩散的情况下是稳定的。这要求 $J$ 的特征值具有负实部，如果 $\\text{tr}(J)  0$ 且 $\\det(J)  0$，则此条件满足。\n$\\text{tr}(J) = f_u^\\ast + g_v^\\ast = \\frac{11}{15} - \\frac{9}{4} = \\frac{44 - 135}{60} = -\\frac{91}{60}  0$。\n$\\det(J) = f_u^\\ast g_v^\\ast - f_v^\\ast g_u^\\ast = (\\frac{11}{15})(-\\frac{9}{4}) - (\\frac{9}{4})(-\\frac{26}{15}) = \\frac{9}{4 \\cdot 15} (-11+26) = \\frac{9 \\cdot 15}{60} = \\frac{9}{4}  0$。\n两个条件都满足，因此对于纯反应系统，该稳态是稳定的。\n\n现在我们考虑在 $(u^\\ast, v^\\ast)$ 附近线性化的完整反应扩散系统。我们寻求分离变量（傅里叶模态）形式的解，对于诺伊曼边界条件，解的形式为 $\\cos(k_n x)$，其中波数为 $k_n = \\frac{n\\pi}{L}$（$n \\ge 0$ 为整数）。\n对于每个模态 $n$，其时间演化由矩阵 $J_{k_n} = J - k_n^2 D$ 的特征值 $\\lambda$ 决定，其中 $D = \\text{diag}(d_1, d_2)$。\n$$ J_{k_n} = \\begin{pmatrix} f_u^\\ast - d_1 k_n^2  f_v^\\ast \\\\ g_u^\\ast  g_v^\\ast - d_2 k_n^2 \\end{pmatrix} $$\n如果 $J_{k_n}$ 的一个特征值获得正实部，则模态 $n$ 发生不稳定性。特征值之和为 $\\text{tr}(J_{k_n}) = \\text{tr}(J) - (d_1+d_2)k_n^2$。由于 $\\text{tr}(J)  0$，对于 $k_n0$，$\\text{tr}(J_{k_n})$ 总是负的。因此，不稳定性只能在特征值为实数且其中一个变为正数时发生，这对应于特征值之积 $\\det(J_{k_n})$ 变为负数。\n令 $k^2 = k_n^2$。不稳定的条件是 $\\det(J_k)  0$。\n$\\det(J_k) = (f_u^\\ast - d_1 k^2)(g_v^\\ast - d_2 k^2) - f_v^\\ast g_u^\\ast = \\det(J) - (d_1 g_v^\\ast + d_2 f_u^\\ast)k^2 + d_1 d_2 k^4$。\n令 $h(K) = d_1 d_2 K^2 - (d_1 g_v^\\ast + d_2 f_u^\\ast)K + \\det(J)$，其中 $K=k^2$。不稳定性对应于对于某个 $K0$ 有 $h(K)  0$。\n这个关于 $K$ 的二次函数只有在其最小值是负的情况下才能有负值区域。最小值出现在 $K_c = \\frac{d_1 g_v^\\ast + d_2 f_u^\\ast}{2d_1 d_2}$。为了使不稳定性成为可能（$K_c0$），我们必须有 $d_1 g_v^\\ast + d_2 f_u^\\ast  0$。给定 $d_1=1, g_v^\\ast  0, f_u^\\ast  0$，这要求 $d_2 f_u^\\ast  -d_1 g_v^\\ast$。\n最小值为 $h(K_c) = \\det(J) - \\frac{(d_1 g_v^\\ast + d_2 f_u^\\ast)^2}{4d_1 d_2}$。\n如果 $h(K_c)  0$，则可能出现不稳定性，这意味着 $(d_1 g_v^\\ast + d_2 f_u^\\ast)^2  4d_1 d_2 \\det(J)$。\n\n1) 临界扩散系数 $d_{2,c}$ 是不稳定性首次变得可能时的 $d_2$ 值。这发生在 $h(K)$ 的最小值接触零点时：$h(K_c) = 0$。\n$(d_1 g_v^\\ast + d_{2,c} f_u^\\ast)^2 = 4d_1 d_{2,c} \\det(J)$。\n取正平方根（因为 $d_1 g_v^\\ast + d_2 f_u^\\ast  0$）：\n$d_1 g_v^\\ast + d_{2,c} f_u^\\ast = 2\\sqrt{d_1 d_{2,c} \\det(J)}$。\n令 $y = \\sqrt{d_{2,c}}$。这给出了一个关于 $y$ 的二次方程：\n$f_u^\\ast y^2 - 2\\sqrt{d_1 \\det(J)} y + d_1 g_v^\\ast=0$。\n代入数值 $d_1=1$，$f_u^\\ast = 11/15$，$g_v^\\ast = -9/4$ 和 $\\det(J) = 9/4$：\n$\\frac{11}{15} y^2 - 2\\sqrt{1 \\cdot \\frac{9}{4}} y - \\frac{9}{4} = 0 \\implies \\frac{11}{15} y^2 - 3y - \\frac{9}{4} = 0$。\n两边乘以 $60$：$44y^2 - 180y - 135 = 0$。\n使用二次公式求解 $y0$：\n$y = \\frac{180 + \\sqrt{(-180)^2 - 4(44)(-135)}}{2(44)} = \\frac{180 + \\sqrt{32400 + 23760}}{88} = \\frac{180 + \\sqrt{56160}}{88}$。\n化简根式：$\\sqrt{56160} = \\sqrt{144 \\cdot 390} = 12\\sqrt{390}$。\n$y = \\frac{180 + 12\\sqrt{390}}{88} = \\frac{45 + 3\\sqrt{390}}{22}$。\n$d_{2,c} = y^2 = \\left(\\frac{45 + 3\\sqrt{390}}{22}\\right)^2 = \\frac{45^2 + 2(45)(3\\sqrt{390}) + 9(390)}{484} = \\frac{2025 + 270\\sqrt{390} + 3510}{484} = \\frac{5535 + 270\\sqrt{390}}{484}$。\n\n2) 对于给定的 $d_2  d_{2,c}$，不稳定的波数平方 $K=k^2$ 的范围通过求解 $h(K)0$ 找到。该范围的边界是 $h(K)=0$ 的根：\n$K_\\pm = \\frac{ (d_1 g_v^\\ast + d_2 f_u^\\ast) \\pm \\sqrt{(d_1 g_v^\\ast + d_2 f_u^\\ast)^2 - 4d_1 d_2 \\det(J)} }{2d_1 d_2}$。\n不稳定的模态具有波数 $k$，满足 $\\sqrt{K_-}  k  \\sqrt{K_+}$。\n离散波数为 $k_n = n\\pi/L$。不稳定的模态是满足 $\\sqrt{K_{-}}  n\\pi/L  \\sqrt{K_{+}}$ 的整数 $n$，这意味着 $\\frac{L}{\\pi}\\sqrt{K_{-}}  n  \\frac{L}{\\pi}\\sqrt{K_{+}}$。\n问题将连续模态指数边界定义为 $n_\\pm^\\ast(d_2) = \\frac{L}{\\pi}\\sqrt{K_\\pm}$。\n代入 $L=10$ 和 $K_\\pm$ 的表达式：\n$n_\\pm^\\ast(d_2) = \\frac{10}{\\pi}\\sqrt{ \\frac{ (d_1 g_v^\\ast + d_2 f_u^\\ast) \\pm \\sqrt{(d_1 g_v^\\ast + d_2 f_u^\\ast)^2 - 4d_1 d_2 \\det(J)} }{2d_1 d_2} }$.\n使用参数和雅可比矩阵元素的数值：\n$n_\\pm^\\ast(d_2) = \\frac{10}{\\pi}\\sqrt{ \\frac{ \\frac{11}{15}d_2 - \\frac{9}{4} \\pm \\sqrt{(\\frac{11}{15}d_2 - \\frac{9}{4})^2 - 9d_2} }{2d_2} }$.\n$n_-^\\ast(d_2)$ 和 $n_+^\\ast(d_2)$ 的表达式分别通过在分子中取减号和加号得到。\n\n三个所需量的最终表达式为：\n$d_{2,c} = \\frac{5535 + 270\\sqrt{390}}{484}$。\n$n_{-}^\\ast(d_2) = \\frac{10}{\\pi} \\sqrt{ \\frac{1}{2d_2} \\left( \\frac{11}{15}d_2 - \\frac{9}{4} - \\sqrt{\\left(\\frac{11}{15}d_2 - \\frac{9}{4}\\right)^2 - 9 d_2} \\right) }$.\n$n_{+}^\\ast(d_2) = \\frac{10}{\\pi} \\sqrt{ \\frac{1}{2d_2} \\left( \\frac{11}{15}d_2 - \\frac{9}{4} + \\sqrt{\\left(\\frac{11}{15}d_2 - \\frac{9}{4}\\right)^2 - 9 d_2} \\right) }$.", "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{5535 + 270\\sqrt{390}}{484}  \\frac{10}{\\pi} \\sqrt{ \\frac{1}{2d_2} \\left( \\frac{11}{15}d_2 - \\frac{9}{4} - \\sqrt{\\left(\\frac{11}{15}d_2 - \\frac{9}{4}\\right)^2 - 9 d_2} \\right) }  \\frac{10}{\\pi} \\sqrt{ \\frac{1}{2d_2} \\left( \\frac{11}{15}d_2 - \\frac{9}{4} + \\sqrt{\\left(\\frac{11}{15}d_2 - \\frac{9}{4}\\right)^2 - 9 d_2} \\right) } \\end{pmatrix} } $$", "id": "2661515"}, {"introduction": "尽管解析解能提供深刻的洞见，但许多现实世界的系统过于复杂，无法手动求解。最后的这个练习将指导你开发一个数值算法来扫描图灵不稳定性。通过实现一个计算工具，你将获得一个分析任何反应扩散系统的稳健且通用的方法，从而巩固你对波数与系统稳定性之间关系的理解。[@problem_id:2661506]", "problem": "给定一个 $n$ 物种化学反应网络的线性化反应扩散系统，其形式为一个空间均匀稳态，具有雅可比矩阵 $J \\in \\mathbb{R}^{n \\times n}$ 和对角扩散矩阵 $D = \\mathrm{diag}(d_1,\\dots,d_n)$，其中矩阵元素 $d_i \\in \\mathbb{R}_{0}$ 均为严格正值。对于每个空间傅里叶模式，其波数平方为 $k^2 \\in \\mathbb{R}_{\\ge 0}$，扰动的线性化动力学根据矩阵 $A(k^2) = J - k^2 D$ 演化。谱横坐标 $\\alpha(k^2)$ 定义为 $A(k^2)$ 的特征值实部的最大值。\n\n您的任务是：\n- 设计并实现一个算法，在给定 $J$ 和 $D$ 的情况下，扫描一个指定的 $k^2$ 值网格，为每个网格点计算谱横坐标 $\\alpha(k^2)$，然后返回网格上的最大值 $\\max_{k^2} \\alpha(k^2)$ 以及该最大值出现的 $k^2$ 值。\n- 基于此，判断 $(J,D)$ 对是否在以下意义上表现出扩散驱动（Turing）不稳定性：均匀稳态在没有扩散时是线性稳定的（即 $\\alpha(0)  0$），但存在某个 $k^2  0$ 使得 $\\alpha(k^2)  0$。在与零比较时，使用数值容差 $\\varepsilon = 10^{-8}$ 来减轻浮点舍入误差。\n- 在代码的注释或文档中，根据反应扩散系统的基本线性稳定性分析，证明您的算法的正确性，并分析其关于物种数量 $n$ 和扫描网格点数 $M$ 的计算复杂度。\n\n您可以假定的基本原理：反应扩散系统在均匀稳态附近的线性化会导出一族由 $k^2$ 参数化的线性系统，其增长率是 $A(k^2) = J - k^2 D$ 的特征值。当均匀稳态在没有扩散时是线性稳定的，但对于某个非零空间模式变得不稳定时，就会发生扩散驱动不稳定性。\n\n实现以下算法要求：\n- 在区间 $[0,K_{\\max}]$ 上定义一个均匀网格 $G = \\{k^2_m\\}_{m=0}^{M-1}$，间距为 $\\Delta k^2$，其中 $k^2_m = m \\,\\Delta k^2$，$K_{\\max} = (M-1)\\Delta k^2$。\n- 对于每个 $k^2_m \\in G$，计算 $A(k^2_m) = J - k^2_m D$，然后计算 $A(k^2_m)$ 的所有特征值，并将这些特征值中的最大实部记录为 $\\alpha(k^2_m)$。\n- 计算 $\\alpha(0)$、网格上的最大谱横坐标 $\\alpha_{\\max} = \\max_{m} \\alpha(k^2_m)$ 以及最大值出现的对应 $k^2$ 值 $k^2_\\star$（如果出现平局，则选择最小的 $k^2_m$）。\n- 将图灵不稳定性指示器确定为一个布尔值\n  $$\\mathrm{is\\_turing} = \\big(\\alpha(0)  -\\varepsilon\\big) \\wedge \\big(\\alpha_{\\max}  \\varepsilon\\big)。$$\n\n数值规格：\n- 使用容差 $\\varepsilon = 10^{-8}$。\n- 使用一个均匀网格，其参数为 $K_{\\max} = 10$ 和 $\\Delta k^2 = 0.01$，即 $M = 1001$。\n- 返回的浮点数输出四舍五入到 $6$ 位小数。\n\n测试套件：\n对于每个测试用例，给定 $(J,D)$，其中所有数值都是无量纲的。对所有用例使用共享的网格参数 $K_{\\max} = 10$ 和 $\\Delta k^2 = 0.01$。\n\n- 测试用例 $1$（两物种，强差异扩散，预期出现扩散驱动不稳定性）：\n  $$J_1 = \\begin{bmatrix} 1  2 \\\\ -3  -4 \\end{bmatrix}, \\quad D_1 = \\mathrm{diag}(0.1,\\,10)。$$\n\n- 测试用例 $2$（两物种，相同扩散，预期无扩散驱动不稳定性）：\n  $$J_2 = \\begin{bmatrix} 1  2 \\\\ -3  -4 \\end{bmatrix}, \\quad D_2 = \\mathrm{diag}(1,\\,1)。$$\n\n- 测试用例 $3$（两物种，无扩散时不稳，根据定义不是 Turing 不稳定性）：\n  $$J_3 = \\begin{bmatrix} 1  0 \\\\ 0  -0.5 \\end{bmatrix}, \\quad D_3 = \\mathrm{diag}(0.1,\\,10)。$$\n\n- 测试用例 $4$（三物种，对角占优稳定雅可比矩阵，相同扩散，预期无扩散驱动不稳定性）：\n  $$J_4 = \\begin{bmatrix} -1  0.2  0 \\\\ 0.1  -2  0.3 \\\\ 0  0.2  -3 \\end{bmatrix}, \\quad D_4 = \\mathrm{diag}(1,\\,1,\\,1)。$$\n\n输出规格：\n- 对每个测试用例，输出一个包含四项的列表：\n  $[\\mathrm{is\\_turing},\\,\\alpha(0),\\,\\alpha_{\\max},\\,k^2_\\star]$，其中 $\\mathrm{is\\_turing}$ 是一个布尔值，三个浮点值四舍五入到 $6$ 位小数。\n- 您的程序应生成单行输出，其中包含所有测试用例的结果。结果为一个逗号分隔的列表，用方括号括起来，每个测试用例的结果本身也格式化为一个列表。例如：\n  $$[[\\mathrm{True},-1.000000,0.123456,0.210000],[\\mathrm{False},-0.500000,-0.100000,0.000000]]$$\n\n您的代码必须是自包含的，不需要任何输入，并遵守上述指定的数值参数。此问题不涉及物理单位；所有量均为无量纲。算法的实现必须能够处理通用的 $n$。", "solution": "该问题要求设计并实现一个数值算法，用于在一般的 $n$ 物种反应扩散系统中测试扩散驱动（Turing）不稳定性。系统在均匀稳态附近的线性动力学由矩阵 $A(k^2) = J - k^2 D$ 描述，其中 $J \\in \\mathbb{R}^{n \\times n}$ 是反应雅可比矩阵，$D = \\mathrm{diag}(d_1, \\dots, d_n)$ 是正扩散系数 $d_i  0$ 构成的对角矩阵，$k^2 \\ge 0$ 是空间扰动的波数平方。\n\n对于给定的空间模式 $k^2$，系统的线性稳定性由矩阵 $A(k^2)$ 的谱横坐标决定，定义为 $\\alpha(k^2) = \\max_{j} \\{\\mathrm{Re}(\\lambda_j)\\}$，其中 $\\{\\lambda_j\\}$ 是 $A(k^2)$ 的特征值。正的谱横坐标 $\\alpha(k^2)  0$ 意味着波数为 $k$ 的扰动会随时间指数增长，表示不稳定。负的谱横坐标 $\\alpha(k^2)  0$ 意味着此类扰动会衰减，表示稳定。\n\n扩散驱动（或 Turing）不稳定性是一种特定现象，即一个对均匀扰动稳定（在没有扩散时，即 $k^2=0$ 时）的系统，由于在某个非零空间频率上存在扩散而被驱动至不稳定。形式上，这对应于两个条件：\n$1$. 均匀稳态是稳定的：$\\alpha(0)  0$。\n$2$. 存在某个波数范围，系统在该范围内是不稳定的：对于某个 $k^2  0$，有 $\\alpha(k^2)  0$。\n\n为验证给定对 $(J,D)$ 的这些条件，算法构建如下：\n\n首先，我们必须在一系列非负 $k^2$ 值上研究函数 $\\alpha(k^2)$ 的行为。由于一般 $n \\times n$ 矩阵的特征值解析解不可行，且解析地最大化 $\\alpha(k^2)$ 也很棘手，我们采用数值方法。我们将波数平方的目标域 $[0, K_{\\max}]$ 离散化为一个均匀网格 $G = \\{k^2_m\\}_{m=0}^{M-1}$，并指定间距 $\\Delta k^2$。在此问题中，给定的参数为 $K_{\\max} = 10$ 和 $\\Delta k^2 = 0.01$，从而得到 $M=1001$ 个网格点。\n\n对于网格 $G$ 中的每个点 $k^2_m$，我们执行以下步骤：\n$1$. 构造特定模式的矩阵：$A(k^2_m) = J - k^2_m D$。\n$2$. 使用标准的数值线性代数程序计算 $n \\times n$ 矩阵 $A(k^2_m)$ 的全谱特征值。\n$3$. 通过找到计算出的特征值的最大实部来计算该模式的谱横坐标：$\\alpha(k^2_m) = \\max_j \\{\\mathrm{Re}(\\lambda_j(A(k^2_m)))\\}$。\n\n遍历所有网格点后，我们得到一个代表在网格 $G$ 上采样的函数 $\\alpha(k^2)$ 的值数组。从这个数组中，我们提取必要的信息：\n- $k^2=0$ 处的谱横坐标，记为 $\\alpha(0)$，是该数组的第一个元素。\n- 扫描范围内的最大谱横坐标 $\\alpha_{\\max} = \\max_{m} \\{\\alpha(k^2_m)\\}$，通过确定数组中的最大值找到。\n- 相应的波数平方 $k^2_\\star$，是实现该最大值的网格点 $k^2_m$。问题规定，如果出现平局，应选择最小的那个 $k^2_m$。这可以由查找数组中最大值首次出现位置的索引的算法自然处理。\n\n最后，使用计算出的值和一个小的数值容差 $\\varepsilon = 10^{-8}$ 来检查图灵不稳定性条件，以考虑浮点不精确性。布尔指示器 $\\mathrm{is\\_turing}$ 由逻辑谓词确定：\n$$ \\mathrm{is\\_turing} = (\\alpha(0)  -\\varepsilon) \\wedge (\\alpha_{\\max}  \\varepsilon) $$\n该表达式将图灵不稳定性的理论定义直接转化为一个可验证的数值测试。\n\n该算法的正确性建立在线性稳定性理论的基本原则之上，并假设所选网格足够精细，能够捕捉连续函数 $\\alpha(k^2)$ 的基本特征，包括其在区间 $[0, K_{\\max}]$ 内的全局最大值。$K_{\\max}$ 的选择必须足够大，以包含不稳定模式的相关范围，这通常是与具体问题相关的。对于给定的测试用例，指定的网格是足够的。\n\n该算法的计算复杂度由其最耗时的步骤决定，即主循环内部的特征值计算。对于一个一般的 $n \\times n$ 矩阵，标准特征值算法（如 QR 算法）的复杂度约为 $O(n^3)$。由于该操作对波数网格上的 $M$ 个点中的每一个都重复执行，因此该过程的总计算复杂度为 $O(M \\cdot n^3)$。其余操作，如矩阵组装和查找结果数组的最大值，其复杂度较低，分别为 $O(M \\cdot n)$ 和 $O(M)$，不会改变整体的复杂度级别。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function that defines test cases, processes them,\n    and prints the results in the specified format.\n    \"\"\"\n    \n    # Numerical specifications\n    epsilon = 1e-8\n    k2_max = 10.0\n    delta_k2 = 0.01\n    \n    # Test cases defined as tuples of (Jacobian, Diffusion_matrix)\n    test_cases = [\n        # Test case 1 (two species, strongly differential diffusion)\n        (np.array([[1.0, 2.0], [-3.0, -4.0]]), \n         np.diag([0.1, 10.0])),\n        \n        # Test case 2 (two species, equal diffusion)\n        (np.array([[1.0, 2.0], [-3.0, -4.0]]),\n         np.diag([1.0, 1.0])),\n\n        # Test case 3 (two species, unstable without diffusion)\n        (np.array([[1.0, 0.0], [0.0, -0.5]]),\n         np.diag([0.1, 10.0])),\n\n        # Test case 4 (three species, diagonally dominant stable Jacobian)\n        (np.array([[-1.0, 0.2, 0.0], [0.1, -2.0, 0.3], [0.0, 0.2, -3.0]]),\n         np.diag([1.0, 1.0, 1.0]))\n    ]\n\n    # Generate the grid of k^2 values\n    num_points = int(k2_max / delta_k2) + 1\n    k2_grid = np.linspace(0, k2_max, num_points)\n\n    all_results = []\n    for J, D in test_cases:\n        result = process_case(J, D, k2_grid, epsilon)\n        all_results.append(result)\n\n    # Format the final output string according to the problem specification.\n    # Each sub-result is formatted as a string \"[bool,float,float,float]\"\n    # to avoid spaces introduced by Python's default list-to-string conversion.\n    result_strings = []\n    for res in all_results:\n        is_turing_str = 'True' if res[0] else 'False'\n        float_strs = [f\"{val:.6f}\" for val in res[1:]]\n        result_strings.append(f\"[{is_turing_str},{','.join(float_strs)}]\")\n    \n    # Join all sub-result strings and enclose in brackets.\n    final_output = f\"[{','.join(result_strings)}]\"\n    print(final_output)\n\ndef process_case(J, D, k2_grid, epsilon):\n    \"\"\"\n    Analyzes a single reaction-diffusion system (J, D) for Turing instability.\n\n    The algorithm's correctness derives from the direct application of linear stability\n    analysis for reaction-diffusion systems. By scanning a grid of wavenumbers (k),\n    it numerically approximates the dispersion relation alpha(k^2) and checks the\n    defining conditions for a Turing instability.\n\n    Complexity Analysis:\n    - n: number of species (size of matrix J)\n    - M: number of grid points in k2_grid\n    - The dominant operation is eigenvalue computation (O(n^3)) performed M times.\n    - Total complexity: O(M * n^3).\n\n    Args:\n        J (np.ndarray): The n x n Jacobian matrix.\n        D (np.ndarray): The n x n diagonal diffusion matrix.\n        k2_grid (np.ndarray): The grid of squared wavenumber values to scan.\n        epsilon (float): The numerical tolerance for comparisons with zero.\n\n    Returns:\n        list: A list containing [is_turing, alpha_0, alpha_max, k2_star].\n    \"\"\"\n    \n    alpha_values = []\n    for k2 in k2_grid:\n        # Construct the matrix A(k^2) = J - k^2 * D\n        A_k2 = J - k2 * D\n        \n        # Compute eigenvalues and find the spectral abscissa (max real part)\n        eigenvalues = np.linalg.eigvals(A_k2)\n        alpha_k2 = np.max(eigenvalues.real)\n        alpha_values.append(alpha_k2)\n\n    alpha_values = np.array(alpha_values)\n\n    # alpha(0) is the stability of the homogeneous steady state\n    alpha_0 = alpha_values[0]\n\n    # Find the maximum spectral abscissa over the grid and the corresponding k^2\n    # np.argmax() returns the index of the first occurrence of the maximum,\n    # which satisfies the tie-breaking rule (smallest k^2_m).\n    max_idx = np.argmax(alpha_values)\n    alpha_max = alpha_values[max_idx]\n    k2_star = k2_grid[max_idx]\n    \n    # Determine the Turing instability indicator based on the definition:\n    # Stable at k^2=0, but unstable for some k^2 > 0.\n    is_turing = (alpha_0  -epsilon) and (alpha_max > epsilon)\n    \n    # Convert numpy boolean to Python boolean for correct string formatting\n    return [bool(is_turing), alpha_0, alpha_max, k2_star]\n\n# Execute the solver\n# The following lines are for direct execution as a script.\n# In a library context, the solve() function would be called by another module.\nif __name__ == '__main__':\n    solve()\n\n```", "id": "2661506"}]}