{"hands_on_practices": [{"introduction": "在对基因回路进行建模时，理解转录因子如何与DNA结合是第一步。协同性，即一个分子的结合会影响其他分子的结合，是产生急剧的、开关般响应的关键机制。本练习将指导您推导这种响应的数学形式（结合曲线），并使用有效Hill系数来量化其陡峭程度，这是生物化学中的一个基石概念[@problem_id:2682176]。", "problem": "一个合成启动子有两个相同的转录因子（TF，记为 $T$）结合位点。在快速平衡条件下，每个位点与浓度为 $[T]$ 的充分搅拌体系中的 $T$ 反应，具有相同的解离常数 $K_d$。存在正协同性：当一个位点被占据时，两个位点都被占据的启动子状态的统计权重乘以一个无量纲协同因子 $\\omega$（$\\omega>1$）。假设结合和解离相对于下游事件是快速的，因此热力学平衡的描述是有效的，并且结合是非排他性的（除了协同相互作用外，两个位点之间没有空间位阻）。将启动子分数占据率 $\\theta([T])$ 定义为平均占据位点数除以 2。\n\n仅使用质量作用定律和与结合的平衡统计力学一致的状态枚举法（无动力学捷径），推导出 $\\theta([T])$ 作为 $[T]$、$K_d$ 和 $\\omega$ 的函数的闭合形式。然后，将有效希尔系数 $n_H$ 定义为半占据时希尔图的斜率，\n$$\nn_{H} \\equiv \\left.\\frac{d \\ln\\!\\left(\\frac{\\theta}{1-\\theta}\\right)}{d \\ln [T]}\\right|_{\\theta=1/2},\n$$\n并解析地计算 $n_H$ 作为 $\\omega$ 的函数。\n\n以 $n_H$ 关于 $\\omega$ 的闭合形式表达式报告您的最终答案。不需要进行数值计算或四舍五入。", "solution": "该问题陈述是一个关于具有协同性的二聚体系统平衡结合特性的恰当提问，这是生物物理化学和合成生物学中的一个基本课题。它在科学上是合理的，并包含了获得唯一解析解所需的所有信息。我们将着手进行推导。\n\n该系统由一个启动子组成，其上带有两个相同的转录因子 $T$ 结合位点。结合过程处于热力学平衡状态。我们可以通过枚举启动子的可能状态及其相应的统计权重，使用统计力学来对该系统建模。设 $P_i$ 表示结合了 $i$ 个 $T$ 分子的启动子状态。可能的状态有 $P_0$（未占据）、$P_1$（一个位点被占据）和 $P_2$（两个位点都被占据）。\n\n一个状态的统计权重与其在平衡时的浓度成正比。我们将未占据状态的统计权重 $W_0$ 定义为参考，因此 $W_0 = 1$。\n\n对于有一个位点被占据的状态 $P_1$，结合反应为 $P_0 + T \\rightleftharpoons P_1$（考虑一个特定位点）。解离常数为 $K_d = \\frac{[P_0][T]}{[P_1, \\text{site 1}]}$。浓度，也即统计权重，与 $\\frac{[T]}{K_d}$ 成正比。由于有两个相同且独立的位点，因此结合一个分子（无论在哪个位点）的总统计权重是每个微观状态（位点1结合或位点2结合）的权重之和。这给出了一个组合因子 $\\binom{2}{1}=2$。因此，单占据状态的统计权重为：\n$$\nW_1 = 2 \\frac{[T]}{K_d}\n$$\n\n对于有两个位点被占据的状态 $P_2$，反应为 $P_0 + 2T \\rightleftharpoons P_2$。问题陈述指出，一个协同因子 $\\omega$ 乘以双占据状态的统计权重。对于两个独立的结合事件，统计权重本应为 $\\left(\\frac{[T]}{K_d}\\right)^2$。协同因子将其修正为：\n$$\nW_2 = \\omega \\left(\\frac{[T]}{K_d}\\right)^2\n$$\n在此，$\\omega > 1$ 对应于正协同性，意味着第二个配体的结合比没有协同性时更有利。\n\n配分函数 $Z$ 是所有统计权重的总和，并作为概率的归一化因子。\n$$\nZ = W_0 + W_1 + W_2 = 1 + 2 \\frac{[T]}{K_d} + \\omega \\left(\\frac{[T]}{K_d}\\right)^2\n$$\n\n平均占据位点数 $\\langle N \\rangle$ 是每个状态的占据位点数乘以该状态的概率的总和：\n$$\n\\langle N \\rangle = \\frac{\\sum_{i=0}^{2} i \\cdot W_i}{Z} = \\frac{0 \\cdot W_0 + 1 \\cdot W_1 + 2 \\cdot W_2}{Z} = \\frac{2 \\frac{[T]}{K_d} + 2\\omega \\left(\\frac{[T]}{K_d}\\right)^2}{1 + 2 \\frac{[T]}{K_d} + \\omega \\left(\\frac{[T]}{K_d}\\right)^2}\n$$\n\n分数占据率 $\\theta$ 定义为平均占据位点数除以总位点数（即 2）。\n$$\n\\theta([T]) = \\frac{\\langle N \\rangle}{2} = \\frac{\\frac{[T]}{K_d} + \\omega \\left(\\frac{[T]}{K_d}\\right)^2}{1 + 2 \\frac{[T]}{K_d} + \\omega \\left(\\frac{[T]}{K_d}\\right)^2}\n$$\n这是分数占据率的闭合形式表达式。为了简化后续的推导，我们定义一个无量纲浓度 $x = \\frac{[T]}{K_d}$。$\\theta$ 的表达式变为：\n$$\n\\theta(x) = \\frac{x + \\omega x^2}{1 + 2x + \\omega x^2}\n$$\n这样就完成了问题的第一部分。\n\n接下来，我们必须计算半占据时（$\\theta = 1/2$）的有效希尔系数 $n_H$。其定义如下：\n$$\nn_{H} \\equiv \\left.\\frac{d \\ln\\!\\left(\\frac{\\theta}{1-\\theta}\\right)}{d \\ln [T]}\\right|_{\\theta=1/2}\n$$\n首先，我们找出比值 $\\frac{\\theta}{1-\\theta}$ 的表达式。\n$$\n1-\\theta = 1 - \\frac{x + \\omega x^2}{1 + 2x + \\omega x^2} = \\frac{(1 + 2x + \\omega x^2) - (x + \\omega x^2)}{1 + 2x + \\omega x^2} = \\frac{1+x}{1 + 2x + \\omega x^2}\n$$\n$$\n\\frac{\\theta}{1-\\theta} = \\frac{x + \\omega x^2}{1+x} = \\frac{x(1+\\omega x)}{1+x}\n$$\n设 $Y(x) = \\frac{\\theta}{1-\\theta}$。我们需要计算 $\\ln(Y)$ 对 $\\ln([T])$ 的导数。由于 $x = [T]/K_d$，我们有 $\\ln(x) = \\ln([T]) - \\ln(K_d)$，这意味着 $d\\ln(x) = d\\ln([T])$。因此，可以对 $\\ln(x)$ 求导。\n$$\nn_H(x) = \\frac{d \\ln(Y)}{d \\ln(x)}\n$$\n我们有 $\\ln(Y) = \\ln\\left(\\frac{x(1+\\omega x)}{1+x}\\right) = \\ln(x) + \\ln(1+\\omega x) - \\ln(1+x)$。\n对 $x$ 求导并乘以 $x$（这等价于对 $\\ln x$ 求导）：\n$$\nn_H(x) = x \\left( \\frac{d}{dx} \\ln(Y) \\right) = x \\left(\\frac{1}{x} + \\frac{\\omega}{1+\\omega x} - \\frac{1}{1+x}\\right) = 1 + \\frac{\\omega x}{1+\\omega x} - \\frac{x}{1+x}\n$$\n这是希尔系数作为浓度 $x$ 的函数的通用表达式。我们必须在半占据点，即 $\\theta=1/2$ 处对其进行求值。我们来找出满足此条件的浓度 $x_{1/2}$。\n$$\n\\theta(x_{1/2}) = \\frac{1}{2} \\implies \\frac{x_{1/2} + \\omega x_{1/2}^2}{1 + 2x_{1/2} + \\omega x_{1/2}^2} = \\frac{1}{2}\n$$\n$$\n2(x_{1/2} + \\omega x_{1/2}^2) = 1 + 2x_{1/2} + \\omega x_{1/2}^2\n$$\n$$\n2x_{1/2} + 2\\omega x_{1/2}^2 = 1 + 2x_{1/2} + \\omega x_{1/2}^2\n$$\n$$\n\\omega x_{1/2}^2 = 1 \\implies x_{1/2} = \\frac{1}{\\sqrt{\\omega}}\n$$\n我们取正根，因为浓度必须为正。现在我们将这个值 $x_{1/2}$ 代入 $n_H(x)$ 的表达式中：\n$$\nn_H = n_H(x_{1/2}) = 1 + \\frac{\\omega (1/\\sqrt{\\omega})}{1+\\omega (1/\\sqrt{\\omega})} - \\frac{1/\\sqrt{\\omega}}{1+1/\\sqrt{\\omega}}\n$$\n$$\nn_H = 1 + \\frac{\\sqrt{\\omega}}{1+\\sqrt{\\omega}} - \\frac{1/\\sqrt{\\omega}}{(1+\\sqrt{\\omega})/\\sqrt{\\omega}}\n$$\n$$\nn_H = 1 + \\frac{\\sqrt{\\omega}}{1+\\sqrt{\\omega}} - \\frac{1}{1+\\sqrt{\\omega}}\n$$\n将各项合并，使用公分母 $(1+\\sqrt{\\omega})$：\n$$\nn_H = \\frac{1+\\sqrt{\\omega}}{1+\\sqrt{\\omega}} + \\frac{\\sqrt{\\omega}}{1+\\sqrt{\\omega}} - \\frac{1}{1+\\sqrt{\\omega}} = \\frac{(1+\\sqrt{\\omega}) + \\sqrt{\\omega} - 1}{1+\\sqrt{\\omega}} = \\frac{2\\sqrt{\\omega}}{1+\\sqrt{\\omega}}\n$$\n这就是半占据时有效希尔系数作为协同性参数 $\\omega$ 的函数的最终解析表达式。", "answer": "$$\n\\boxed{\\frac{2\\sqrt{\\omega}}{1+\\sqrt{\\omega}}}\n$$", "id": "2682176"}, {"introduction": "在理解了单个启动子的调控机制后，我们可以将这些组件连接成回路。本练习探讨了基因开关，这是合成生物学中的一个基本模体，其中两个基因相互抑制。通过零斜线分析，本练习将展示这种简单的负反馈结构如何产生双稳态——即系统存在于两种不同稳定状态的能力——这对于创建细胞记忆和决策回路至关重要[@problem_id:2682236]。", "problem": "考虑一个合成生物学中的对称双基因拨动开关，其中两种基因产物以相同的协同性相互抑制对方的转录，这种协同性由希尔函数描述。经过无量纲化处理（其中降解被缩放以使一阶损失率为 $1$），该系统的常微分方程（ODE）模型为\n$$\n\\frac{dx}{dt}=\\frac{\\alpha}{1+y^{n}}-x,\\qquad \\frac{dy}{dt}=\\frac{\\alpha}{1+x^{n}}-y,\n$$\n其中 $x(t)$ 和 $y(t)$ 是无量纲的蛋白质浓度，$\\alpha>0$ 是一个无量纲的产生强度参数（最大产生速率与降解速率之比），$n>0$ 是希尔系数（协同性）。\n\n使用零斜线分析和关于对称不动点的线性化方法，确定作为希尔系数函数的最小产生强度，记为 $\\alpha_{c}(n)$，使得系统恰好有三个不动点（一个对称不动点和两个非对称不动点）。将您的最终答案表示为关于 $n$ 的 $\\alpha_{c}(n)$ 的单个闭式解析表达式。请勿对答案进行四舍五入。陈述结果时无需带单位。", "solution": "用户提供的问题是数学生物学和非线性动力学领域一个有效且适定的问题。它要求在一个经典的基因拨动开关模型中，确定叉式分岔的临界参数。该问题在科学上是合理的、自洽的，并且需要标准的分析方法来解决。我现在开始解答。\n\n描述这两种相互抑制的蛋白质动力学的常微分方程（ODE）系统由下式给出：\n$$\n\\frac{dx}{dt}=\\frac{\\alpha}{1+y^{n}}-x\n$$\n$$\n\\frac{dy}{dt}=\\frac{\\alpha}{1+x^{n}}-y\n$$\n其中 $x(t)$ 和 $y(t)$ 是无量纲浓度，$\\alpha > 0$ 是产生强度，$n > 0$ 是希尔系数。\n\n系统的不动点（或稳态）是相空间中变化率为零的点 $(x, y)$。这意味着 $\\frac{dx}{dt} = 0$ 且 $\\frac{dy}{dt} = 0$。因此，不动点的条件由两条零斜线的交点给出：\n$$\nx = \\frac{\\alpha}{1+y^{n}} \\quad (\\text{x-零斜线})\n$$\n$$\ny = \\frac{\\alpha}{1+x^{n}} \\quad (\\text{y-零斜线})\n$$\n该系统是对称的，这意味着如果 $(x_0, y_0)$ 是一个不动点，那么 $(y_0, x_0)$ 也是一个不动点。\n\n在 $x=y$ 处存在一个对称不动点。我们用 $(x^*, x^*)$ 表示这个点。将 $y=x$ 代入任一零斜线方程，得到 $x^*$ 的条件：\n$$\nx^* = \\frac{\\alpha}{1+(x^*)^{n}}\n$$\n对于任何 $\\alpha > 0$ 和 $n > 0$，函数 $f(x) = \\frac{\\alpha}{1+x^n}$ 是一个单调递减函数，从 $f(0)=\\alpha$ 开始，当 $x \\to \\infty$ 时趋近于 $0$。直线 $y=x$ 必须与该函数至少相交一次，这保证了至少存在一个对称不动点。\n\n系统通过叉式分岔，从拥有一个不动点（对称不动点）过渡到拥有三个不动点（一个变得不稳定的对称不动点和两个新的稳定非对称不动点）。这种分岔发生在对称不动点失去其稳定性时。不动点的稳定性由系统在该点评估的雅可比矩阵的特征值确定。\n\n雅可比矩阵 $J(x, y)$ 是：\n$$\nJ(x, y) = \\begin{pmatrix} \\frac{\\partial}{\\partial x}\\left(\\frac{\\alpha}{1+y^{n}}-x\\right)  \\frac{\\partial}{\\partial y}\\left(\\frac{\\alpha}{1+y^{n}}-x\\right) \\\\ \\frac{\\partial}{\\partial x}\\left(\\frac{\\alpha}{1+x^{n}}-y\\right)  \\frac{\\partial}{\\partial y}\\left(\\frac{\\alpha}{1+x^{n}}-y\\right) \\end{pmatrix} = \\begin{pmatrix} -1  -\\frac{\\alpha n y^{n-1}}{(1+y^{n})^2} \\\\ -\\frac{\\alpha n x^{n-1}}{(1+x^{n})^2}  -1 \\end{pmatrix}\n$$\n我们在对称不动点 $(x^*, x^*)$ 处评估雅可比矩阵：\n$$\nJ(x^*, x^*) = \\begin{pmatrix} -1  -\\frac{\\alpha n (x^*)^{n-1}}{(1+(x^*)^{n})^2} \\\\ -\\frac{\\alpha n (x^*)^{n-1}}{(1+(x^*)^{n})^2}  -1 \\end{pmatrix}\n$$\n我们来简化非对角线项。根据不动点条件 $x^* = \\frac{\\alpha}{1+(x^*)^{n}}$，我们有 $\\alpha = x^*(1+(x^*)^n)$。将此代入非对角线元素，得到：\n$$\n-\\frac{x^*(1+(x^*)^n) n (x^*)^{n-1}}{(1+(x^*)^n)^2} = -\\frac{n (x^*)^n}{1+(x^*)^n}\n$$\n我们用 $j^* = -\\frac{n (x^*)^n}{1+(x^*)^n}$ 表示这一项。雅可比矩阵变为：\n$$\nJ(x^*, x^*) = \\begin{pmatrix} -1  j^* \\\\ j^*  -1 \\end{pmatrix}\n$$\n特征值 $\\lambda$ 可从特征方程 $\\det(J(x^*, x^*) - \\lambda I) = 0$ 求得：\n$$\n(-1-\\lambda)^2 - (j^*)^2 = 0 \\implies 1+\\lambda = \\pm j^* \\implies \\lambda = -1 \\pm j^*\n$$\n由于矩阵是对称的，其特征值是实数。它们是 $\\lambda_{\\pm} = -1 \\pm |j^*| = -1 \\pm \\frac{n (x^*)^n}{1+(x^*)^n}$。\n一个特征值是 $\\lambda_1 = -1 - \\frac{n (x^*)^n}{1+(x^*)^n}$，由于 $n>0, x^*>0$，所以 $\\lambda_1$ 总是负的。\n另一个特征值是 $\\lambda_2 = -1 + \\frac{n (x^*)^n}{1+(x^*)^n}$。\n对称不动点的稳定性由 $\\lambda_2$ 的符号决定。如果 $\\lambda_2 < 0$，不动点是稳定的；当 $\\lambda_2 > 0$ 时，它变得不稳定。分岔恰好在 $\\lambda_2=0$ 时发生。这个条件定义了临界产生强度 $\\alpha_c(n)$。\n\n令 $\\lambda_2 = 0$：\n$$\n-1 + \\frac{n (x^*)^n}{1+(x^*)^n} = 0 \\implies \\frac{n (x^*)^n}{1+(x^*)^n} = 1\n$$\n$$\nn (x^*)^n = 1+(x^*)^n \\implies (n-1)(x^*)^n = 1\n$$\n该方程仅当 $n-1 > 0$（即 $n>1$）时，才会对 $x^*$ 产生一个实数正解。对于 $n \\le 1$，这种分岔不会发生，系统总是只有一个稳定的不动点。问题暗示我们处于可能存在三个不动点的区域，因此我们继续以 $n > 1$ 进行分析。\n\n根据分岔条件，我们找到临界点处的浓度 $x^*$：\n$$\n(x^*)^n = \\frac{1}{n-1} \\implies x^* = \\left(\\frac{1}{n-1}\\right)^{1/n} = (n-1)^{-1/n}\n$$\n临界产生强度 $\\alpha_c(n)$ 是对于这个特定的 $x^*$ 值满足不动点方程的 $\\alpha$ 值：\n$$\n\\alpha_c(n) = x^*(1+(x^*)^n)\n$$\n在分岔点代入 $x^*$ 和 $(x^*)^n$ 的表达式：\n$$\n\\alpha_c(n) = (n-1)^{-1/n} \\left(1 + \\frac{1}{n-1}\\right)\n$$\n$$\n\\alpha_c(n) = (n-1)^{-1/n} \\left(\\frac{n-1+1}{n-1}\\right) = (n-1)^{-1/n} \\left(\\frac{n}{n-1}\\right)\n$$\n$$\n\\alpha_c(n) = n (n-1)^{-1} (n-1)^{-1/n} = n (n-1)^{-(1+\\frac{1}{n})}\n$$\n化简指数，得到系统支持三个不动点所需的最小产生强度的最终表达式：\n$$\n\\alpha_c(n) = n(n-1)^{-\\frac{n+1}{n}}\n$$\n对于任何 $\\alpha > \\alpha_c(n)$，系统将表现出双稳态，拥有一个不稳定的对称不动点和两个稳定的非对称不动点。因此，$\\alpha_c(n)$ 是系统存在总共三个不动点所需的最小产生强度。", "answer": "$$\\boxed{n(n-1)^{-\\frac{n+1}{n}}}$$", "id": "2682236"}, {"introduction": "确定性模型可以预测稳定状态，但真实的生物系统本质上是充满噪声的。本练习深入探讨基因回路的随机性，研究随机波动如何导致系统在其稳定状态之间“切换”。通过将 Kramers 理论应用于简化的势能景观模型，您将学习计算系统在每个状态的平均驻留时间，从而对合成基因开关在噪声存在下的稳定性和可靠性有定量的理解[@problem_id:2682159]。", "problem": "考虑一个通过在时间尺度分离下对快变量进行绝热消除而获得的双稳态合成基因开关的简化一维描述。设有效无量纲坐标为 $x \\in \\mathbb{R}$，其在有效势 $U(x)$ 和白噪声驱动的过阻尼随机动力学下演化。假设过阻尼朗之万模型为\n$$\n\\gamma \\, \\dot{x}(t) = -\\frac{dU}{dx}(x(t)) + \\sqrt{2 \\gamma \\, \\varepsilon} \\, \\xi(t),\n$$\n其中 $\\gamma > 0$ 是一个无量纲摩擦系数，$\\varepsilon > 0$ 是一个无量纲的有效噪声强度，它粗粒化了内在和外在的涨落，而 $\\xi(t)$ 是一个零均值、$\\delta$ 相关的白高斯噪声，满足 $\\langle \\xi(t) \\xi(t') \\rangle = \\delta(t - t')$。对于合成生物学中的拨动开关类电路，一个广泛使用的、能够捕捉两个稳定表达态和一个中心势垒的简化势是倾斜的四次势\n$$\nU(x; \\alpha, \\beta, \\delta) = \\alpha \\, x^4 - \\beta \\, x^2 + \\delta \\, x,\n$$\n其中 $\\alpha > 0$ 且 $\\beta > 0$，而 $\\delta \\in \\mathbb{R}$ 引起不对称性。在亚稳态区域且 $\\varepsilon$ 足够小的情况下，噪声诱导的在两个盆地之间的切换通过罕见的越垒事件发生。在适用于过阻尼生化反应的高摩擦区域，Kramers’ 理论根据 $U$ 在稳定不动点（局部极小值点）和势垒顶点（局部极大值点）的局部曲率以及势垒高度，为这些切换速率提供了一个渐近估计。\n\n你的任务是编写一个程序，对于每组参数，纯粹从化学动力学和随机过程的第一性原理出发，完成以下任务：\n- 通过求解三次方程 $\\frac{dU}{dx} = 0$，即\n$$\n4 \\alpha \\, x^3 - 2 \\beta \\, x + \\delta = 0\n$$\n来找到 $U$ 的所有驻点。\n- 通过二阶导数 $U''(x^\\star) = 12 \\alpha \\, x^{\\star 2} - 2 \\beta$ 的符号对每个实驻点 $x^\\star$ 进行分类：若 $U''(x^\\star) > 0$ 则为局部极小值点，若 $U''(x^\\star) < 0$ 则为局部极大值点。\n- 通过识别两个局部极小值点 $x_L < x_R$ 和一个局部极大值点 $x_b$（满足 $x_L < x_b < x_R$）来验证双稳态性。\n- 使用过阻尼 Kramers 高摩擦渐近理论，根据 $\\gamma$、$\\varepsilon$、$U''(x_L)$、$U''(x_R)$、$U''(x_b)$ 以及势垒高度\n$$\n\\Delta U_L = U(x_b) - U(x_L), \\quad \\Delta U_R = U(x_b) - U(x_R)\n$$\n来计算从左到右的正向切换速率 $k_{L \\to R}$ 和从右到左的反向切换速率 $k_{R \\to L}$。\n- 输出平均驻留时间 $\\tau_L = 1 / k_{L \\to R}$ 和 $\\tau_R = 1 / k_{R \\to L}$。\n\n设计算法时必须使用的基本原理：\n- 在势 $U(x)$ 中运动、有效温度为 $\\varepsilon$ 的粒子的过阻尼朗之万方程及其对应的福克-普朗克方程（FPE）。\n- 亚稳态阱中的准静态分布以及作为高摩擦极限下 Kramers 逃逸率基础的越垒通量-布居数原理。\n- 在驻点附近对 $U(x)$ 进行二次展开，以将局部曲率与尝试频率联系起来。\n你不能引入任何非物理的假设，也不能假定任何没有这些基础支持的结果；所有需要的关系都必须在你的解法中推导出来。\n\n本问题中所有量均为无量纲量。不出现角度。最终答案必须以浮点数形式报告。对于数值输出，将每个值四舍五入到恰好 $6$ 位小数。\n\n用于评估你的程序的测试套件：\n- 案例 1：$(\\alpha, \\beta, \\delta, \\gamma, \\varepsilon) = (1.0, 2.0, 0.0, 1.0, 0.2)$。\n- 案例 2：$(\\alpha, \\beta, \\delta, \\gamma, \\varepsilon) = (0.5, 1.2, 0.3, 1.5, 0.15)$。\n- 案例 3：$(\\alpha, \\beta, \\delta, \\gamma, \\varepsilon) = (1.0, 1.1, -0.1, 0.8, 0.05)$。\n- 案例 4：$(\\alpha, \\beta, \\delta, \\gamma, \\varepsilon) = (1.2, 2.4, 0.0, 2.0, 0.6)$。\n\n程序要求：\n- 对每个案例，使用上述步骤计算 $(\\tau_L, \\tau_R)$。如果一个案例不是双稳态的（少于两个极小值点或它们之间没有极大值点），则该案例的两个输出均返回 $\\mathrm{NaN}$。\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，顺序为 $[\\tau_L^{(1)}, \\tau_R^{(1)}, \\tau_L^{(2)}, \\tau_R^{(2)}, \\tau_L^{(3)}, \\tau_R^{(3)}, \\tau_L^{(4)}, \\tau_R^{(4)}]$，每个值都四舍五入到恰好 $6$ 位小数，例如 $[1.234000,5.678000,\\dots]$。", "solution": "问题陈述已经过验证，被认为是科学上可靠、适定且客观的。它描述了统计物理学中的一个典型问题——噪声诱导的从亚稳态的逃逸——并将其应用于一个合成基因开关模型。该模型基于过阻尼朗之万方程，分析依赖于 Kramers' 理论，这两者都是基础且公认的原理。问题是自洽的，并为得到唯一解提供了所有必要的参数和函数形式。因此，我们可以进行严格的推导和算法构建。\n\n系统的动力学由一维过阻尼朗之万方程控制，对于无量纲坐标 $x(t)$：\n$$\n\\gamma \\, \\frac{dx}{dt} = -\\frac{dU}{dx}(x(t)) + \\sqrt{2 \\gamma \\, \\varepsilon} \\, \\xi(t)\n$$\n此处，$\\gamma > 0$ 是摩擦系数，$\\varepsilon > 0$ 是有效噪声强度，其作用类似于温度，而 $\\xi(t)$ 是一个标准的白高斯噪声，其均值为零，相关性为 $\\langle \\xi(t) \\xi(t') \\rangle = \\delta(t - t')$。力由倾斜的四次势 $U(x) = \\alpha x^4 - \\beta x^2 + \\delta x$ 导出。\n\n粒子位置的概率密度函数 $P(x,t)$ 的演化由相应的福克-普朗克方程（FPE）描述：\n$$\n\\frac{\\partial P(x,t)}{\\partial t} = -\\frac{\\partial J(x,t)}{\\partial x}\n$$\n其中 $J(x,t)$ 是概率流，由下式给出：\n$$\nJ(x,t) = -\\frac{1}{\\gamma} \\left( \\frac{dU}{dx} P(x,t) + \\varepsilon \\frac{\\partial P(x,t)}{\\partial x} \\right)\n$$\n当 $J=0$ 时的稳态分布是 Boltzmann-Gibbs 分布 $P_{st}(x) = \\mathcal{N} \\exp(-U(x)/\\varepsilon)$，其中 $\\mathcal{N}$ 是归一化常数。\n\n对于一个在 $x_L$（左）和 $x_R$（右）有两个极小值点并由位于 $x_b$ 的势垒隔开的双稳态势，系统在每个势阱中都是亚稳态的。对于小的 $\\varepsilon$，一个逃逸事件，例如从左势阱到右势阱，是一个罕见事件。这类跃迁的速率 $k_{L \\to R}$ 可以使用越垒通量-布居数方法计算。我们假设一个准静态，其中左势阱中的布居数 $N_L = \\int_{-\\infty}^{x_b} P(x,t) dx$ 指数衰减：$dN_L/dt = -k_{L \\to R} N_L$。那么速率就是跨越势垒的稳态概率流 $J$ 与布居数 $N_L$ 的比值：\n$$\nk_{L \\to R} = \\frac{J}{N_L}\n$$\n为了找到 $J$ 和 $N_L$，我们求解稳态 FPE（$\\partial P/\\partial t = 0$，因此 $J(x)=J$ 是常数），其边界条件反映了左势阱中的一个源和右势阱中的一个汇，从而维持一个稳定通量。这使得当 $x \\to \\infty$（超出右势阱）时 $P(x) \\to 0$，并在左势阱内形成准平衡分布。\n\n从概率流的表达式，我们有 $J = -\\frac{\\varepsilon}{\\gamma} \\exp(-U(x)/\\varepsilon) \\frac{d}{dx} \\left( P(x) \\exp(U(x)/\\varepsilon) \\right)$。整理并从左势阱内的点 $a$ 积分到右势阱内的点 $c$ 可得：\n$$\nJ \\int_a^c \\frac{\\gamma}{\\varepsilon} \\exp(U(y)/\\varepsilon) dy = \\left[ -P(y) \\exp(U(y)/\\varepsilon) \\right]_a^c = P(a) \\exp(U(a)/\\varepsilon) - P(c) \\exp(U(c)/\\varepsilon)\n$$\n在 $c$ 处的吸收边界条件下，$P(c) \\approx 0$。在左势阱内部，假定概率分布处于局部平衡，$P(x) \\approx P_{quasi}(x) = \\frac{N_L}{\\int_{-\\infty}^{x_b} \\exp(-U(y)/\\varepsilon) dy} \\exp(-U(x)/\\varepsilon)$。因此，$P(a) = \\frac{N_L \\exp(-U(a)/\\varepsilon)}{\\int_{-\\infty}^{x_b} \\exp(-U(y)/\\varepsilon) dy}$。\n将此代入积分后的流方程，我们得到速率：\n$$\nk_{L \\to R} = \\frac{J}{N_L} = \\frac{\\varepsilon}{\\gamma} \\left( \\int_{-\\infty}^{x_b} e^{-U(y)/\\varepsilon} dy \\right)^{-1} \\left( \\int_a^c e^{U(y)/\\varepsilon} dy \\right)^{-1}\n$$\n在低噪声极限下（$\\varepsilon \\ll \\Delta U_L, \\Delta U_R$），这些积分可以使用鞍点法（拉普拉斯方法）进行评估。在驻点附近，势被二次近似。\n在极小值点 $x_L$ 附近：$U(x) \\approx U(x_L) + \\frac{1}{2} U''(x_L) (x - x_L)^2$。\n在势垒极大值点 $x_b$ 附近：$U(x) \\approx U(x_b) + \\frac{1}{2} U''(x_b) (x - x_b)^2$，其中 $U''(x_b) < 0$。\n\n第一个积分由位于 $x_L$ 的极小值点主导：\n$$\n\\int_{-\\infty}^{x_b} e^{-U(y)/\\varepsilon} dy \\approx e^{-U(x_L)/\\varepsilon} \\int_{-\\infty}^{\\infty} e^{-U''(x_L)(y-x_L)^2/(2\\varepsilon)} dy = e^{-U(x_L)/\\varepsilon} \\sqrt{\\frac{2\\pi\\varepsilon}{U''(x_L)}}\n$$\n第二个积分由位于 $x_b$ 的极大值点主导：\n$$\n\\int_a^c e^{U(y)/\\varepsilon} dy \\approx e^{U(x_b)/\\varepsilon} \\int_{-\\infty}^{\\infty} e^{U''(x_b)(y-x_b)^2/(2\\varepsilon)} dy = e^{U(x_b)/\\varepsilon} \\sqrt{\\frac{2\\pi\\varepsilon}{|U''(x_b)|}}\n$$\n将这些近似代入速率方程，得到过阻尼情况下的 Kramers' 速率：\n$$\nk_{L \\to R} = \\frac{\\varepsilon}{\\gamma} \\left( e^{-U(x_L)/\\varepsilon} \\sqrt{\\frac{2\\pi\\varepsilon}{U''(x_L)}} \\right)^{-1} \\left( e^{U(x_b)/\\varepsilon} \\sqrt{\\frac{2\\pi\\varepsilon}{|U''(x_b)|}} \\right)^{-1} = \\frac{\\sqrt{U''(x_L)|U''(x_b)|}}{2\\pi\\gamma} e^{-(U(x_b)-U(x_L))/\\varepsilon}\n$$\n将势垒高度记为 $\\Delta U_L = U(x_b) - U(x_L)$，正向速率为：\n$$\nk_{L \\to R} = \\frac{\\sqrt{U''(x_L)|U''(x_b)|}}{2\\pi\\gamma} \\exp\\left(-\\frac{\\Delta U_L}{\\varepsilon}\\right)\n$$\n通过对称性，反向速率 $k_{R \\to L}$ 可以通过将左势阱的性质替换为右势阱的性质得到：\n$$\nk_{R \\to L} = \\frac{\\sqrt{U''(x_R)|U''(x_b)|}}{2\\pi\\gamma} \\exp\\left(-\\frac{\\Delta U_R}{\\varepsilon}\\right)\n$$\n其中 $\\Delta U_R = U(x_b) - U(x_R)$ 是逃离右势阱的势垒。平均驻留时间是这些速率的倒数：$\\tau_L = 1/k_{L \\to R}$ 和 $\\tau_R = 1/k_{R \\to L}$。\n\n解决问题的算法如下：\n1.  对于每组参数 $(\\alpha, \\beta, \\delta, \\gamma, \\varepsilon)$，通过求解三次方程 $U'(x) = 4\\alpha x^3 - 2\\beta x + \\delta = 0$ 来找到势 $U(x)$ 的驻点。\n2.  识别实数根。如果不同实数根的数量不为三，则系统在所需的双阱结构下不是双稳态的，结果不确定（$\\mathrm{NaN}$）。\n3.  将三个实数根排序，$r_1 < r_2 < r_3$。\n4.  通过计算二阶导数 $U''(x) = 12\\alpha x^2 - 2\\beta$ 的符号来对每个根进行分类。对于一个有效的双稳态系统，我们需要 $U''(r_1) > 0$（极小值点），$U''(r_2) < 0$（极大值点），以及 $U''(r_3) > 0$（极小值点）。如果不满足此条件，结果为不确定。\n5.  指定稳定点 $x_L = r_1$，$x_R = r_3$ 和不稳定势垒点 $x_b = r_2$。\n6.  计算这些点上的势能：$U(x_L)$，$U(x_R)$ 和 $U(x_b)$。\n7.  计算势垒高度 $\\Delta U_L = U(x_b) - U(x_L)$ 和 $\\Delta U_R = U(x_b) - U(x_R)$。\n8.  计算必要的曲率：$U''(x_L)$，$U''(x_R)$ 和 $|U''(x_b)|$。\n9.  使用推导出的公式计算平均驻留时间：\n    $$\n    \\tau_L = \\frac{2\\pi\\gamma}{\\sqrt{U''(x_L)|U''(x_b)|}} \\exp\\left(\\frac{\\Delta U_L}{\\varepsilon}\\right)\n    $$\n    $$\n    \\tau_R = \\frac{2\\pi\\gamma}{\\sqrt{U''(x_R)|U''(x_b)|}} \\exp\\left(\\frac{\\Delta U_R}{\\varepsilon}\\right)\n    $$\n10. 报告每个案例计算出的值 $(\\tau_L, \\tau_R)$，按要求格式化。\n\n此过程在以下程序中实现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the mean residence times in a bistable gene switch model.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (alpha, beta, delta, gamma, epsilon)\n        (1.0, 2.0, 0.0, 1.0, 0.2),\n        (0.5, 1.2, 0.3, 1.5, 0.15),\n        (1.0, 1.1, -0.1, 0.8, 0.05),\n        (1.2, 2.4, 0.0, 2.0, 0.6),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        alpha, beta, delta, gamma, epsilon = case\n\n        # Step 1: Find stationary points by solving the cubic equation\n        # 4*alpha*x^3 - 2*beta*x + delta = 0\n        coeffs = [4 * alpha, 0, -2 * beta, delta]\n        roots = np.roots(coeffs)\n\n        # Step 2: Filter for real roots and check for bistability condition\n        # A small tolerance for floating point comparisons\n        real_tol = 1e-9\n        real_roots = sorted([r.real for r in roots if abs(r.imag)  real_tol])\n        \n        # We need exactly 3 distinct real roots for a double-well potential\n        if len(real_roots) != 3:\n            results.extend([np.nan, np.nan])\n            continue\n        \n        # Define second derivative function\n        def U_pp(x, a, b):\n            return 12 * a * x**2 - 2 * b\n\n        x1, x2, x3 = real_roots\n        \n        # Step 3  4: Classify roots and verify bistability\n        # U''(x1) > 0 (min), U''(x2)  0 (max), U''(x3) > 0 (min)\n        U_pp_x1 = U_pp(x1, alpha, beta)\n        U_pp_x2 = U_pp(x2, alpha, beta)\n        U_pp_x3 = U_pp(x3, alpha, beta)\n\n        if not (U_pp_x1 > 0 and U_pp_x2  0 and U_pp_x3 > 0):\n            results.extend([np.nan, np.nan])\n            continue\n        \n        # Step 5: Assign stable and unstable points\n        x_L, x_b, x_R = x1, x2, x3\n\n        # Define potential function\n        def U(x, a, b, d):\n            return a * x**4 - b * x**2 + d * x\n\n        # Step 6  7: Calculate potentials and barrier heights\n        U_L = U(x_L, alpha, beta, delta)\n        U_b = U(x_b, alpha, beta, delta)\n        U_R = U(x_R, alpha, beta, delta)\n\n        delta_U_L = U_b - U_L\n        delta_U_R = U_b - U_R\n\n        # Step 8: Get curvatures\n        U_pp_L = U_pp_x1\n        U_pp_b_abs = abs(U_pp_x2)\n        U_pp_R = U_pp_x3\n        \n        # Step 9: Calculate mean residence times using Kramers' formula\n        # tau_L = (2*pi*gamma / sqrt(U''(x_L)*|U''(x_b)|)) * exp(Delta_U_L / epsilon)\n        tau_L = (2 * np.pi * gamma / np.sqrt(U_pp_L * U_pp_b_abs)) * np.exp(delta_U_L / epsilon)\n        \n        # tau_R = (2*pi*gamma / sqrt(U''(x_R)*|U''(x_b)|)) * exp(Delta_U_R / epsilon)\n        tau_R = (2 * np.pi * gamma / np.sqrt(U_pp_R * U_pp_b_abs)) * np.exp(delta_U_R / epsilon)\n        \n        results.extend([tau_L, tau_R])\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"{val:.6f}\" if not np.isnan(val) else \"NaN\" for val in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2682159"}]}