{"hands_on_practices": [{"introduction": "模型简化的理想目标是创建一个更简单的模型，该模型对于集总变量而言与原始系统完全等价。这个练习将探讨精确线性集总的代数基础。通过这个练习 [@problem_id:2655909]，你将推导出一个线性系统能够被精确集总的充要条件，从而建立起原始速率常数 $k_i$ 与有效速率常数 $\\tilde{k}_i$ 之间的直接联系。这项实践旨在训练应用集总矩阵形式主义的核心技能。", "problem": "考虑一个混合均匀、等温的三种化学物种的稀溶液，其反应遵循一级（线性）质量作用动力学。设物种浓度为 $x_1(t)$、$x_2(t)$ 和 $x_3(t)$，并考虑以下反应网络：\n- $x_1 \\to x_2$，速率常数为 $k_1$，\n- $x_2 \\to \\varnothing$，速率常数为 $k_2$，\n- $x_3 \\to \\varnothing$，速率常数为 $k_3$。\n\n假设标准的质量作用常微分方程（ODE）描述成立。给定线性集总映射 $z = L x$，它将模型从三个物种降维到两个物种，其中\n$$\nL \\equiv \\begin{bmatrix}\n1  0  0 \\\\\n0  1  1\n\\end{bmatrix},\n\\qquad\nz_1 \\equiv x_1,\n\\qquad\nz_2 \\equiv x_2 + x_3.\n$$\n我们寻求一个形式如下的精确双室一级降维模型：\n$$\n\\frac{d}{dt}\\begin{bmatrix} z_1 \\\\ z_2 \\end{bmatrix}\n=\n\\begin{bmatrix}\n-\\tilde{k}_1  0 \\\\\n\\tilde{k}_1  -\\tilde{k}_2\n\\end{bmatrix}\n\\begin{bmatrix} z_1 \\\\ z_2 \\end{bmatrix},\n$$\n其中有效参数 $\\tilde{k}_1$ 和 $\\tilde{k}_2$ 为常数。\n\n仅从基本的质量作用ODE和线性集总定义出发，推导原始速率常数 $k_1$、$k_2$ 和 $k_3$ 必须满足的充要代数条件，使得精确线性集总条件成立，并且两个有效参数 $\\tilde{k}_1$ 和 $\\tilde{k}_2$ 是唯一可辨识的（即，可以无歧义地用 $k_1$、$k_2$ 和 $k_3$ 表示）。然后，在这些条件下，用 $k_1$、$k_2$ 和 $k_3$ 表示所得的 $\\tilde{k}_1$ 和 $\\tilde{k}_2$。\n\n你的最终答案必须是以行矩阵形式表示的数对 $\\tilde{k}_1,\\tilde{k}_2$。不需要进行数值计算。", "solution": "所述问题具有科学依据，是适定且客观的。这是化学反应网络理论中的一个标准练习，具体涉及精确线性集总的条件。因此，我们可以进行形式推导。\n\n首先，我们必须写出原始三物种系统的主导质量作用常微分方程（ODE）。物种浓度由向量 $x(t) = \\begin{bmatrix} x_1(t)  x_2(t)  x_3(t) \\end{bmatrix}^T$ 表示。反应网络为：\n$x_1 \\xrightarrow{k_1} x_2$\n$x_2 \\xrightarrow{k_2} \\varnothing$\n$x_3 \\xrightarrow{k_3} \\varnothing$\n\n每个物种浓度的变化率由以下线性ODE系统给出：\n$$\n\\frac{dx_1}{dt} = -k_1 x_1\n$$\n$$\n\\frac{dx_2}{dt} = k_1 x_1 - k_2 x_2\n$$\n$$\n\\frac{dx_3}{dt} = -k_3 x_3\n$$\n该系统可以写成矩阵形式 $\\frac{d}{dt}x = K x$，其中 $x = \\begin{bmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{bmatrix}$，速率矩阵 $K$ 为：\n$$\nK = \\begin{bmatrix} -k_1  0  0 \\\\ k_1  -k_2  0 \\\\ 0  0  -k_3 \\end{bmatrix}\n$$\n问题指定了一个从三维状态向量 $x$ 到二维状态向量 $z = \\begin{bmatrix} z_1  z_2 \\end{bmatrix}^T$ 的线性集总变换。该变换由集总矩阵 $L$ 定义：\n$$\nz = L x = \\begin{bmatrix} 1  0  0 \\\\ 0  1  1 \\end{bmatrix} \\begin{bmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{bmatrix} = \\begin{bmatrix} x_1 \\\\ x_2 + x_3 \\end{bmatrix}\n$$\n集总变量 $z$ 的动力学通过对此表达式关于时间 $t$ 求导得到：\n$$\n\\frac{d}{dt}z = \\frac{d}{dt}(L x) = L \\left(\\frac{d}{dt}x\\right)\n$$\n代入表达式 $\\frac{d}{dt}x = Kx$，我们得到：\n$$\n\\frac{d}{dt}z = L K x\n$$\n要使精确集总存在，z 的动力学必须能仅用 z 来表示。这意味着必须存在一个常数矩阵 $\\tilde{K}$，使得 $z$ 的动力学遵循降维模型 $\\frac{d}{dt}z = \\tilde{K}z$。代入 $z=Lx$，此条件变为：\n$$\n\\frac{d}{dt}z = \\tilde{K} L x\n$$\n令 $\\frac{d}{dt}z$ 的两个表达式相等，我们得到了精确线性集总的基本条件：\n$$\nL K x = \\tilde{K} L x\n$$\n对于系统动力学可达的任何状态向量 $x(t)$，此关系都必须成立。对于一个线性时不变系统，这要求矩阵恒等式 $L K = \\tilde{K} L$ 成立。\n\n我们已知降维速率矩阵 $\\tilde{K}$ 的结构：\n$$\n\\tilde{K} = \\begin{bmatrix} -\\tilde{k}_1  0 \\\\ \\tilde{k}_1  -\\tilde{k}_2 \\end{bmatrix}\n$$\n我们现在计算矩阵乘积 $L K$ 和 $\\tilde{K} L$。\n首先，计算乘积 $L K$：\n$$\nL K = \\begin{bmatrix} 1  0  0 \\\\ 0  1  1 \\end{bmatrix} \\begin{bmatrix} -k_1  0  0 \\\\ k_1  -k_2  0 \\\\ 0  0  -k_3 \\end{bmatrix} = \\begin{bmatrix} (1)(-k_1) + (0)(k_1) + (0)(0)  (1)(0) + (0)(-k_2) + (0)(0)  (1)(0) + (0)(0) + (0)(-k_3) \\\\ (0)(-k_1) + (1)(k_1) + (1)(0)  (0)(0) + (1)(-k_2) + (1)(0)  (0)(0) + (1)(0) + (1)(-k_3) \\end{bmatrix}\n$$\n$$\nL K = \\begin{bmatrix} -k_1  0  0 \\\\ k_1  -k_2  -k_3 \\end{bmatrix}\n$$\n接下来，计算乘积 $\\tilde{K} L$：\n$$\n\\tilde{K} L = \\begin{bmatrix} -\\tilde{k}_1  0 \\\\ \\tilde{k}_1  -\\tilde{k}_2 \\end{bmatrix} \\begin{bmatrix} 1  0  0 \\\\ 0  1  1 \\end{bmatrix} = \\begin{bmatrix} (-\\tilde{k}_1)(1) + (0)(0)  (-\\tilde{k}_1)(0) + (0)(1)  (-\\tilde{k}_1)(0) + (0)(1) \\\\ (\\tilde{k}_1)(1) + (-\\tilde{k}_2)(0)  (\\tilde{k}_1)(0) + (-\\tilde{k}_2)(1)  (\\tilde{k}_1)(0) + (-\\tilde{k}_2)(1) \\end{bmatrix}\n$$\n$$\n\\tilde{K} L = \\begin{bmatrix} -\\tilde{k}_1  0  0 \\\\ \\tilde{k}_1  -\\tilde{k}_2  -\\tilde{k}_2 \\end{bmatrix}\n$$\n要使集总条件 $L K = \\tilde{K} L$ 成立，这两个结果矩阵必须完全相同。我们逐个元素地令它们相等：\n$$\n\\begin{bmatrix} -k_1  0  0 \\\\ k_1  -k_2  -k_3 \\end{bmatrix} = \\begin{bmatrix} -\\tilde{k}_1  0  0 \\\\ \\tilde{k}_1  -\\tilde{k}_2  -\\tilde{k}_2 \\end{bmatrix}\n$$\n该矩阵等式产生以下标量方程组：\n1.  由元素 $(1,1)$ 得：$-k_1 = -\\tilde{k}_1 \\implies \\tilde{k}_1 = k_1$。\n2.  由元素 $(1,2)$ 得：$0 = 0$。这是一致的。\n3.  由元素 $(1,3)$ 得：$0 = 0$。这是一致的。\n4.  由元素 $(2,1)$ 得：$k_1 = \\tilde{k}_1$。这与方程 $1$ 一致。\n5.  由元素 $(2,2)$ 得：$-k_2 = -\\tilde{k}_2 \\implies \\tilde{k}_2 = k_2$。\n6.  由元素 $(2,3)$ 得：$-k_3 = -\\tilde{k}_2 \\implies \\tilde{k}_2 = k_3$。\n\n从方程 $5$ 和 $6$ 中，我们得到了 $\\tilde{k}_2$ 的两个表达式。要使这两个表达式同时成立，原始速率常数必须满足条件 $k_2 = k_3$。这就是指定的具有常数参数 $\\tilde{k}_1$ 和 $\\tilde{k}_2$ 的精确线性降维模型存在的充要代数条件。\n\n在此条件下，有效参数被唯一确定为：\n$$\n\\tilde{k}_1 = k_1\n$$\n$$\n\\tilde{k}_2 = k_2 = k_3\n$$\n因此，当且仅当物种 $x_2$ 和 $x_3$ 的衰变速率相同时，集总是精确的。当此条件成立时，集总变量 $z_2 = x_2 + x_3$ 的行为如同一个以速率常数 $k_2$ 衰变的单一物种。\n按要求以行矩阵形式表示的有效参数的最终表达式为 $\\begin{pmatrix} k_1  k_2 \\end{pmatrix}$。", "answer": "$$\n\\boxed{\\begin{pmatrix} k_1  k_2 \\end{pmatrix}}\n$$", "id": "2655909"}, {"introduction": "在实际应用中，精确集总非常罕见，我们更常依赖于近似方法，例如准稳态近似（QSSA）。这个练习 [@problem_id:2655913] 深入探讨了一种强大的系统性方法，通过推导一阶校正项来改进基本的QSSA，从而获得更精确的简化模型。这项实践将向你介绍奇异摄动理论和不变流形等高级概念，这对于处理具有多重时间尺度的复杂系统至关重要。", "problem": "考虑一个具有质量作用动力学的简单酶催化机理：酶 $E$ 与底物 $S$ 结合形成复合物 $C$，复合物 $C$ 不可逆地转化为产物 $P$ 并再生出酶 $E$，即 $E + S \\xrightleftharpoons[k_{-1}]{k_{1}} C \\xrightarrow{k_{2}} E + P$。令 $s(t)$ 和 $c(t)$ 分别表示 $S$ 和 $C$ 的浓度，且总酶浓度守恒，为 $E_{T} = e(t) + c(t)$，其中 $e(t)$ 是游离酶浓度。根据质量作用定律，该系统的常微分方程 (ODEs) 为\n$$\n\\frac{ds}{dt} = -k_{1}\\,e\\,s + k_{-1}\\,c, \n\\qquad\n\\frac{dc}{dt} = k_{1}\\,e\\,s - (k_{-1} + k_{2})\\,c,\n\\qquad\ne = E_{T} - c,\n$$\n其中参数 $k_{1}$、$k_{-1}$、$k_{2}$ 为正常数，初始条件 $s(0) = S_{0}$、$c(0) = 0$、$e(0) = E_{T}$ 为正且满足 $E_{T} \\ll S_{0}$。定义无量纲变量 $x = s/S_{0}$、$y = c/E_{T}$ 和快时间 $\\tau$，由 $t = \\tau/(k_{1} S_{0})$ 给出。引入小参数 $\\epsilon = E_{T}/S_{0}$ 以及正的无量纲参数 $\\kappa = k_{-1}/(k_{1} S_{0})$ 和 $\\rho = k_{2}/(k_{1} S_{0})$。证明该系统可以写成如下的快慢形式\n$$\n\\frac{dx}{d\\tau} = \\epsilon\\,f(x,y), \n\\qquad \n\\frac{dy}{d\\tau} = g(x,y),\n$$\n其中 $f(x,y) = -x + x y + \\kappa y$ 且 $g(x,y) = x(1 - y) - (\\kappa + \\rho)\\,y$。准稳态近似 (QSSA) 设 $g(x,y) = 0$，以得到零阶慢流形 $y = h_{0}(x)$ 和在慢时间 $T = \\epsilon\\,\\tau$ 下的降维动力学 $\\frac{dx}{dT} = f(x,h_{0}(x))$。\n\n从此快慢系统形式出发，使用关于 $\\epsilon$ 的零阶不变流形理论（即芬尼切尔-吉洪诺夫方法 Fenichel–Tikhonov approach），对慢不变流形 $y = h(x;\\epsilon) = h_{0}(x) + \\epsilon\\,h_{1}(x) + O(\\epsilon^{2})$ 进行系统性展开，并利用不变性方程推导出用 $x$、$\\kappa$ 和 $\\rho$ 表示的 $h_{1}(x)$。然后，求出降维慢动力学的 $O(\\epsilon)$ 阶修正项，\n$$\n\\frac{dx}{dT} = f(x,h_{0}(x)) + \\epsilon\\,F_{1}(x) + O(\\epsilon^{2}),\n$$\n其中 $F_{1}(x)$ 是一个关于 $x$、$\\kappa$ 和 $\\rho$ 的显式函数。\n\n你的任务是从第一性原理出发完成此推导，即从质量作用公式和通过不变性方程对慢流形的定义开始（不要假定任何预先推导出的降维公式）。以闭合形式给出 $O(\\epsilon)$ 阶修正项 $F_{1}(x)$ 的显式表达式。最终答案只报告 $F_{1}(x)$。无需进行数值计算，也无需在最终答案中报告单位。", "solution": "本题要求针对给定的酶反应机理，推导准稳态近似 (QSSA) 的 $O(\\epsilon)$ 阶修正项。这可以通过应用奇异摄动理论来找到慢不变流形的一阶修正来实现。\n\n该常微分方程组以快慢形式给出：\n$$\n\\frac{dx}{d\\tau} = \\epsilon\\,f(x,y)\n$$\n$$\n\\frac{dy}{d\\tau} = g(x,y)\n$$\n其中 $\\tau$ 是快时间变量，$\\epsilon = E_T/S_0 \\ll 1$ 是小参数，函数 $f$ 和 $g$ 定义为：\n$$\nf(x,y) = -x + xy + \\kappa y\n$$\n$$\ng(x,y) = x(1-y) - (\\kappa + \\rho)y\n$$\n参数 $\\kappa$ 和 $\\rho$ 是正的无量纲常数。\n\n该系统拥有一个慢不变流形，可以表示为函数 $y = h(x;\\epsilon)$。此流形上的动力学是慢的。该流形在系统流下保持不变的条件由不变性方程给出，该方程指出矢量场必须在流形上的每一点都与流形相切。这在数学上表示为：\n$$\n\\frac{dy}{d\\tau} = \\frac{dh}{dx} \\frac{dx}{d\\tau}\n$$\n将系统方程代入在流形 $y=h(x;\\epsilon)$ 上取值的不变性方程，我们得到：\n$$\ng(x, h(x;\\epsilon)) = \\frac{dh(x;\\epsilon)}{dx} \\left[ \\epsilon\\,f(x, h(x;\\epsilon)) \\right]\n$$\n我们以关于 $\\epsilon$ 的级数展开形式寻找慢流形的解：\n$$\ny = h(x;\\epsilon) = h_0(x) + \\epsilon\\,h_1(x) + O(\\epsilon^2)\n$$\n为了求解未知函数 $h_0(x)$ 和 $h_1(x)$，我们将不变性方程中的各项按 $\\epsilon$ 的幂次展开。\n左侧 (LHS) 变为：\n$$\ng(x, h(x;\\epsilon)) = g(x, h_0(x) + \\epsilon\\,h_1(x) + \\dots) = g(x, h_0(x)) + \\epsilon\\,h_1(x)\\frac{\\partial g}{\\partial y}(x, h_0(x)) + O(\\epsilon^2)\n$$\n右侧 (RHS) 变为：\n$$\n\\epsilon \\left( \\frac{dh_0}{dx} + \\epsilon \\frac{dh_1}{dx} + \\dots \\right) \\left( f(x, h_0(x)) + \\epsilon\\,h_1(x)\\frac{\\partial f}{\\partial y}(x, h_0(x)) + \\dots \\right) = \\epsilon \\frac{dh_0}{dx} f(x, h_0(x)) + O(\\epsilon^2)\n$$\n令展开后的左侧和右侧相等，我们有：\n$$\ng(x, h_0(x)) + \\epsilon\\,h_1(x)\\frac{\\partial g}{\\partial y}(x, h_0(x)) + O(\\epsilon^2) = \\epsilon \\frac{dh_0}{dx} f(x, h_0(x)) + O(\\epsilon^2)\n$$\n通过比较 $\\epsilon$ 各次幂的系数，我们得到一个方程层级。\n\n在 $O(\\epsilon^0)$ 阶：\n$$\ng(x, h_0(x)) = 0\n$$\n该方程定义了零阶慢流形，也称为临界流形，它对应于标准的 QSSA。我们求解 $h_0(x)$：\n$$\nx(1 - h_0(x)) - (\\kappa + \\rho)h_0(x) = 0\n$$\n$$\nx = h_0(x) (x + \\kappa + \\rho)\n$$\n$$\nh_0(x) = \\frac{x}{x + \\kappa + \\rho}\n$$\n\n在 $O(\\epsilon^1)$ 阶：\n$$\nh_1(x)\\frac{\\partial g}{\\partial y}(x, h_0(x)) = \\frac{dh_0}{dx}(x) f(x, h_0(x))\n$$\n这个方程使我们能够求解一阶修正项 $h_1(x)$。我们首先需要计算所涉及的各项。\n$g$ 对 $y$ 的偏导数为：\n$$\n\\frac{\\partial g}{\\partial y} = -x - (\\kappa + \\rho)\n$$\n$h_0(x)$ 对 $x$ 的导数为：\n$$\n\\frac{dh_0}{dx} = \\frac{d}{dx}\\left(\\frac{x}{x + \\kappa + \\rho}\\right) = \\frac{1(x + \\kappa + \\rho) - x(1)}{(x + \\kappa + \\rho)^2} = \\frac{\\kappa + \\rho}{(x + \\kappa + \\rho)^2}\n$$\n函数 $f(x,y)$ 在临界流形 $y=h_0(x)$ 上的值为：\n$$\nf(x, h_0(x)) = -x + x h_0(x) + \\kappa h_0(x) = -x + (x+\\kappa)h_0(x)\n$$\n$$\nf(x, h_0(x)) = -x + (x+\\kappa)\\left(\\frac{x}{x + \\kappa + \\rho}\\right) = \\frac{-x(x + \\kappa + \\rho) + x(x+\\kappa)}{x + \\kappa + \\rho} = \\frac{-x^2 - x\\kappa - x\\rho + x^2 + x\\kappa}{x + \\kappa + \\rho} = \\frac{-x\\rho}{x + \\kappa + \\rho}\n$$\n现在，我们将这些表达式代回 $O(\\epsilon^1)$ 阶方程以求出 $h_1(x)$：\n$$\nh_1(x) \\left[ -x - (\\kappa + \\rho) \\right] = \\left( \\frac{\\kappa + \\rho}{(x + \\kappa + \\rho)^2} \\right) \\left( \\frac{-x\\rho}{x + \\kappa + \\rho} \\right)\n$$\n$$\n-h_1(x) (x + \\kappa + \\rho) = \\frac{-x\\rho(\\kappa + \\rho)}{(x + \\kappa + \\rho)^3}\n$$\n求解 $h_1(x)$：\n$$\nh_1(x) = \\frac{x\\rho(\\kappa + \\rho)}{(x + \\kappa + \\rho)^4}\n$$\n慢流形上的动力学由慢变量 $x$ 的演化来描述。慢动力学的时间变量是 $T = \\epsilon \\tau$。控制方程为：\n$$\n\\frac{dx}{dT} = \\frac{dx}{d(\\epsilon \\tau)} = \\frac{1}{\\epsilon}\\frac{dx}{d\\tau} = f(x, y)\n$$\n将动力学限制在不变流形 $y = h(x;\\epsilon)$ 上：\n$$\n\\frac{dx}{dT} = f(x, h(x;\\epsilon)) = f(x, h_0(x) + \\epsilon h_1(x) + O(\\epsilon^2))\n$$\n将右侧按 $\\epsilon$ 的幂次展开：\n$$\n\\frac{dx}{dT} = f(x, h_0(x)) + \\epsilon\\, h_1(x) \\frac{\\partial f}{\\partial y}(x, h_0(x)) + O(\\epsilon^2)\n$$\n问题要求展开式中的项 $F_1(x)$：\n$$\n\\frac{dx}{dT} = f(x,h_0(x)) + \\epsilon\\,F_1(x) + O(\\epsilon^2)\n$$\n通过比较，我们确定 $F_1(x)$ 为：\n$$\nF_1(x) = h_1(x) \\frac{\\partial f}{\\partial y}(x, h_0(x))\n$$\n我们需要 $f$ 对 $y$ 的偏导数：\n$$\n\\frac{\\partial f}{\\partial y} = x + \\kappa\n$$\n此表达式与 $y$ 无关，因此 $\\frac{\\partial f}{\\partial y}(x, h_0(x)) = x + \\kappa$。\n最后，我们组合出 $F_1(x)$ 的表达式：\n$$\nF_1(x) = \\left( \\frac{x\\rho(\\kappa + \\rho)}{(x + \\kappa + \\rho)^4} \\right) (x + \\kappa)\n$$\n这就给出了降维慢动力学的 $O(\\epsilon)$ 阶修正项的显式闭合形式表达式。", "answer": "$$\\boxed{\\frac{x \\rho (\\kappa + \\rho) (x + \\kappa)}{(x + \\kappa + \\rho)^4}}$$", "id": "2655913"}, {"introduction": "推导出一个简化模型只是工作的一半，我们还必须验证其准确性。这项实践 [@problem_id:2655869] 结合了理论推导与计算验证，要求你首先基于时间尺度分离原理推导出一个近似的简化模型，然后通过数值模拟实现完整模型和简化模型，并量化近似误差。这项练习将让你亲身体验模型简化的完整工作流程，培养连接理论与实践的关键能力。", "problem": "考虑一个遵循质量作用动力学的线性反应网络 $A \\xrightleftharpoons[\\epsilon k_{-1}]{k_1} B \\xrightarrow{k_2} C$，其中 $\\epsilon$ 是一个小的无量纲参数。设浓度分别由 $x_A(t)$、$x_B(t)$ 和 $x_C(t)$ 表示。假设无量纲初始条件为 $x_A(0)=x_{A,0}$，$x_B(0)=0$ 和 $x_C(0)=0$。定义集总变量 $S(t) = x_A(t) + x_B(t)$，它代表 $\\{A,B\\}$ 模块中的总浓度。本问题中的所有量均为无量纲。\n\n任务1（推导）。从质量作用动力学的定义和物质守恒原理出发，写出关于 $(x_A(t), x_B(t), x_C(t))$ 的完整常微分方程组。由此推导出用 $x_B(t)$ 表示的 $S(t)$ 的精确演化方程。然后，利用由小参数 $\\epsilon$ 引起的时间尺度分离所支持的 $\\{A,B\\}$ 模块内部的准稳态内部分布，推导一个关于 $S(t)$ 的主阶（$\\epsilon$ 的）降阶、闭合常微分方程，其形式为\n$$\n\\frac{dS}{dt} = -k_{\\mathrm{eff}}(\\epsilon)\\, S,\n$$\n并给出 $k_{\\mathrm{eff}}(\\epsilon)$ 直到 $\\mathcal{O}(\\epsilon)$ 阶的显式主阶表达式。\n\n任务2（数值比较）。对于下面测试套件中的每个参数集，计算：\n- 通过在 $[0,T]$ 上的均匀时间网格上对 $(x_A(t), x_B(t), x_C(t))$ 的完整常微分方程组进行数值积分，并在此网格上计算 $S(t)=x_A(t)+x_B(t)$，得到 $S(t)$ 的精确动力学；\n- 由任务1的主阶降阶模型给出的降阶动力学 $S_{\\mathrm{red}}(t)$，初始条件相同，为 $S(0)=x_{A,0}$。\n\n然后，对每个参数集，返回网格上的最大绝对误差，\n$$\nE_{\\max}=\\max_{t\\in[0,T]} \\left| S(t) - S_{\\mathrm{red}}(t) \\right|.\n$$\n\n所有计算都是无量纲的，不需要物理单位。\n\n测试套件。使用以下参数集，这些参数集的选择旨在测试不同的动力学区域（快速内部分布、中等分离、差分离以及一个具有挑战性的边界情况）。对于每种情况，参数为 $(k_1, k_{-1}, k_2, \\epsilon, x_{A,0}, T)$:\n- 情况1：$(k_1, k_{-1}, k_2, \\epsilon, x_{A,0}, T)=(50, 3, 1, 0.02, 1, 10)$。\n- 情况2：$(k_1, k_{-1}, k_2, \\epsilon, x_{A,0}, T)=(1, 2, 1, 0.05, 1, 10)$。\n- 情况3：$(k_1, k_{-1}, k_2, \\epsilon, x_{A,0}, T)=(5, 2, 5, 0.01, 1, 3)$。\n- 情况4：$(k_1, k_{-1}, k_2, \\epsilon, x_{A,0}, T)=(0.2, 2, 1, 0.01, 1, 10)$。\n\n程序输入和输出。没有外部输入。你的程序应该：\n- 实现任务1的推导，以定义主阶有效速率 $k_{\\mathrm{eff}}(\\epsilon)$ 和降阶解 $S_{\\mathrm{red}}(t)$；\n- 对每种情况，在 $[0,T]$ 上至少1000个点的均匀网格上对完整系统进行数值积分；\n- 按上述定义计算每种情况的 $E_{\\max}$。\n\n最终输出格式。你的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表，按上述案例的顺序排列，例如 $[E_{\\max,1},E_{\\max,2},E_{\\max,3},E_{\\max,4}]$。每个 $E_{\\max,i}$ 都必须是一个浮点数。", "solution": "问题陈述经过严格验证。\n\n步骤1：提取已知条件。\n- 反应网络：$A \\xrightleftharpoons[\\epsilon k_{-1}]{k_1} B \\xrightarrow{k_2} C$。\n- 动力学：质量作用。\n- 参数 $\\epsilon$：一个小的无量纲参数。\n- 浓度：$x_A(t)$, $x_B(t)$, $x_C(t)$。\n- 初始条件：$x_A(0)=x_{A,0}$, $x_B(0)=0$, $x_C(0)=0$。\n- 集总变量：$S(t) = x_A(t) + x_B(t)$。\n- 任务1：推导一个关于 $S(t)$ 的形式为 $\\frac{dS}{dt} = -k_{\\mathrm{eff}}(\\epsilon)\\, S$ 的降阶、闭合常微分方程，并找到 $k_{\\mathrm{eff}}(\\epsilon)$ 直到 $\\mathcal{O}(\\epsilon)$ 阶的表达式。\n- 任务2：对给定的参数集，计算完整系统的 $S(t)$ 精确动力学与降阶模型动力学 $S_{\\mathrm{red}}(t)$ 之间的最大绝对误差 $E_{\\max}=\\max_{t\\in[0,T]} \\left| S(t) - S_{\\mathrm{red}}(t) \\right|$。\n- 测试套件：$(k_1, k_{-1}, k_2, \\epsilon, x_{A,0}, T)$\n    - 情况1：$(50, 3, 1, 0.02, 1, 10)$。\n    - 情况2：$(1, 2, 1, 0.05, 1, 10)$。\n    - 情况3：$(5, 2, 5, 0.01, 1, 3)$。\n    - 情况4：$(0.2, 2, 1, 0.01, 1, 10)$。\n- 数值要求：在 $[0,T]$ 上至少1000个点的均匀网格上积分。\n- 输出格式：包含逗号分隔的 $E_{\\max}$ 值列表的单行：$[E_{\\max,1},E_{\\max,2},E_{\\max,3},E_{\\max,4}]$。\n\n步骤2：使用提取的已知条件进行验证。\n该问题具有科学依据，是使用奇异摄动理论对化学反应网络进行模型降阶的一个标准练习。这是一个适定问题，提供了一套完整的、带有指定初始条件和参数的线性常微分方程组。目标清晰、定量且客观。该问题是自洽的，没有矛盾或歧义。\n\n步骤3：结论和行动。\n问题有效。将提供一个解决方案。\n\n**任务1：降阶模型的推导**\n\n首先，我们基于反应网络 $A \\xrightleftharpoons[\\epsilon k_{-1}]{k_1} B \\xrightarrow{k_2} C$ 的质量作用动力学定律，建立完整的常微分方程（ODE）组。各个反应步骤的速率为 $v_1 = k_1 x_A$，$v_{-1} = \\epsilon k_{-1} x_B$ 和 $v_2 = k_2 x_B$。浓度的随时间演化由以下方程给出：\n$$\n\\frac{dx_A}{dt} = -v_1 + v_{-1} = -k_1 x_A + \\epsilon k_{-1} x_B\n$$\n$$\n\\frac{dx_B}{dt} = v_1 - v_{-1} - v_2 = k_1 x_A - \\epsilon k_{-1} x_B - k_2 x_B = k_1 x_A - (\\epsilon k_{-1} + k_2) x_B\n$$\n$$\n\\frac{dx_C}{dt} = v_2 = k_2 x_B\n$$\n\n初始条件给出为 $x_A(0) = x_{A,0}$，$x_B(0) = 0$ 和 $x_C(0) = 0$。\n\n接下来，我们推导集总变量 $S(t) = x_A(t) + x_B(t)$ 的精确演化方程。通过对时间求导并代入 $\\frac{dx_A}{dt}$ 和 $\\frac{dx_B}{dt}$ 的表达式，我们得到：\n$$\n\\frac{dS}{dt} = \\frac{dx_A}{dt} + \\frac{dx_B}{dt} = (-k_1 x_A + \\epsilon k_{-1} x_B) + (k_1 x_A - (\\epsilon k_{-1} + k_2) x_B)\n$$\n化简表达式得到关于 $S(t)$ 的精确但非闭合的方程：\n$$\n\\frac{dS}{dt} = -k_2 x_B(t)\n$$\n该方程不是闭合的，因为它的右侧依赖于 $x_B(t)$，而不仅仅是 $S(t)$。\n\n为了推导出关于 $S(t)$ 的闭合方程，我们采用由小参数 $\\epsilon$ 引起的时间尺度分离所支持的准稳态近似。$\\{A,B\\}$ 子系统（忽略解耦的 C 的生成）的控制矩阵为 $K = \\begin{pmatrix} -k_1  \\epsilon k_{-1} \\\\ k_1  -(k_2 + \\epsilon k_{-1}) \\end{pmatrix}$。对于小的 $\\epsilon$，该矩阵的特征值近似为 $\\lambda_1 \\approx -k_1$ 和 $\\lambda_2 \\approx -k_2$。与 $\\lambda_1$ 相关的动力学通常比与 $\\lambda_2$ 相关的动力学更快（假设 $k_1$ 不显著小于 $k_2$）。在 $\\sim 1/k_1$ 的时间尺度上经历一个快速的初始瞬态之后，系统状态会沿着一个慢流形演化。这个流形由对应于慢特征值 $\\lambda_2$ 的特征向量定义。\n\n在 $\\epsilon$ 的主阶上，定义这个慢流形的条件可以通过分析 $\\lambda \\approx -k_2$ 的特征向量方程找到。该关系为 $k_1 x_A - \\epsilon k_{-1} x_B \\approx 0$。这意味着在整个过程的慢时间尺度上，内部反应 $A \\leftrightarrow B$ 处于准平衡状态：\n$$\nx_A(t) \\approx \\frac{\\epsilon k_{-1}}{k_1} x_B(t)\n$$\n这个被称为“准平衡”的近似表明，A到B的快速转化被缓慢的逆反应迅速平衡，从而在它们的浓度之间建立并维持一个动态比率。\n\n我们现在用这个关系来以慢变量 $S$ 表示 $x_B$：\n$$\nS = x_A + x_B \\approx \\frac{\\epsilon k_{-1}}{k_1} x_B + x_B = x_B \\left(1 + \\frac{\\epsilon k_{-1}}{k_1}\\right)\n$$\n解出 $x_B$ 可得：\n$$\nx_B(t) \\approx \\frac{S(t)}{1 + \\epsilon \\frac{k_{-1}}{k_1}}\n$$\n将 $x_B(t)$ 的这个近似代入 $S(t)$ 的精确演化方程，得到闭合的降阶ODE：\n$$\n\\frac{dS}{dt} \\approx -k_2 \\left( \\frac{S}{1 + \\epsilon \\frac{k_{-1}}{k_1}} \\right) = - \\left( \\frac{k_2}{1 + \\epsilon \\frac{k_{-1}}{k_1}} \\right) S\n$$\n这就是所要求的形式 $\\frac{dS}{dt} = -k_{\\mathrm{eff}}(\\epsilon) S$，其有效速率常数为 $k_{\\mathrm{eff}}(\\epsilon) = \\frac{k_2}{1 + \\epsilon \\frac{k_{-1}}{k_1}}$。\n\n问题要求 $k_{\\mathrm{eff}}(\\epsilon)$ 直到 $\\mathcal{O}(\\epsilon)$ 阶的主阶表达式。我们对表达式在小 $\\epsilon$ 处进行泰勒展开。对小的 $x$ 使用展开式 $(1+x)^{-1} \\approx 1 - x$：\n$$\nk_{\\mathrm{eff}}(\\epsilon) = k_2 \\left(1 + \\epsilon \\frac{k_{-1}}{k_1}\\right)^{-1} \\approx k_2 \\left(1 - \\epsilon \\frac{k_{-1}}{k_1}\\right)\n$$\n这就是所要求的有效速率常数的主阶表达式。\n\n那么降阶模型由简单的一阶线性ODE给出：\n$$\n\\frac{dS_{\\mathrm{red}}}{dt} = -k_{\\mathrm{eff}} S_{\\mathrm{red}}, \\quad S_{\\mathrm{red}}(0) = x_{A,0}\n$$\n解析解是：\n$$\nS_{\\mathrm{red}}(t) = x_{A,0} \\exp(-k_{\\mathrm{eff}} t) = x_{A,0} \\exp\\left(-k_2 \\left(1 - \\epsilon \\frac{k_{-1}}{k_1}\\right) t\\right)\n$$\n\n**任务2：数值比较**\n\n对于数值任务，我们为每个参数集实现以下步骤：\n1.  为完整模型定义包含三个ODE的方程组。\n2.  使用给定的初始条件 $x_A(0) = x_{A,0}$，$x_B(0)=0$，$x_C(0)=0$，从 $t=0$ 到 $t=T$ 对这些ODE进行数值积分。这是在具有足够数量点（例如 $2001$）的时间网格上执行的，以确保准确性。`scipy.integrate.solve_ivp` 函数适合此任务。\n3.  从 $x_A(t)$ 和 $x_B(t)$ 的数值解中，在时间网格上计算“精确”的集总变量 $S(t) = x_A(t) + x_B(t)$。\n4.  计算理论有效速率常数 $k_{\\mathrm{eff}} = k_2 (1 - \\epsilon k_{-1}/k_1)$。\n5.  在相同的时间网格上计算降阶模型解 $S_{\\mathrm{red}}(t) = x_{A,0} \\exp(-k_{\\mathrm{eff}} t)$。\n6.  在网格上计算最大绝对误差 $E_{\\max} = \\max_{t \\in [0,T]} |S(t) - S_{\\mathrm{red}}(t)|$。\n\n这个流程将被编码成一个Python脚本来生成最终答案。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the model reduction problem for the given reaction network.\n    \n    For each test case, it:\n    1. Numerically integrates the full system of ODEs to find S(t) = x_A(t) + x_B(t).\n    2. Calculates the analytical solution for the reduced model, S_red(t).\n    3. Computes the maximum absolute error E_max = max|S(t) - S_red(t)| over the time interval.\n    \"\"\"\n\n    # Test suite parameters: (k1, k_neg1, k2, epsilon, x_A0, T)\n    test_cases = [\n        (50.0, 3.0, 1.0, 0.02, 1.0, 10.0),  # Case 1\n        (1.0, 2.0, 1.0, 0.05, 1.0, 10.0),  # Case 2\n        (5.0, 2.0, 5.0, 0.01, 1.0, 3.0),   # Case 3\n        (0.2, 2.0, 1.0, 0.01, 1.0, 10.0),  # Case 4\n    ]\n\n    results = []\n    num_points = 2001 # Grid points, >= 1000\n\n    for case in test_cases:\n        k1, k_neg1, k2, epsilon, x_A0, T = case\n\n        # 1. Full Model Solution\n        \n        # Define the system of ODEs for the full model: [x_A, x_B, x_C]\n        def full_system(t, y):\n            x_A, x_B, x_C = y\n            dxA_dt = -k1 * x_A + epsilon * k_neg1 * x_B\n            dxB_dt = k1 * x_A - (epsilon * k_neg1 + k2) * x_B\n            dxC_dt = k2 * x_B\n            return [dxA_dt, dxB_dt, dxC_dt]\n\n        # Set initial conditions\n        y0 = [x_A0, 0.0, 0.0]\n\n        # Define time grid for evaluation\n        t_span = [0, T]\n        t_eval = np.linspace(0, T, num_points)\n\n        # Numerically solve the ODE system\n        sol = solve_ivp(\n            fun=full_system,\n            t_span=t_span,\n            y0=y0,\n            t_eval=t_eval,\n            method='RK45', # A robust general-purpose solver\n            rtol=1e-8,\n            atol=1e-10\n        )\n\n        # Extract S(t) = x_A(t) + x_B(t) from the solution\n        S_full = sol.y[0] + sol.y[1]\n\n        # 2. Reduced Model Solution\n\n        # Calculate the leading-order effective rate constant\n        k_eff = k2 * (1 - epsilon * k_neg1 / k1)\n\n        # Calculate the reduced model solution S_red(t) analytically\n        S_red = x_A0 * np.exp(-k_eff * t_eval)\n\n        # 3. Compute Maximum Absolute Error\n\n        # Calculate E_max = max|S(t) - S_red(t)|\n        e_max = np.max(np.abs(S_full - S_red))\n        results.append(e_max)\n\n    # Print the final results in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2655869"}]}