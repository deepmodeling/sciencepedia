{"hands_on_practices": [{"introduction": "在深入研究热力学之前，我们必须首先理解反应网络的“骨架”。本练习的核心是将一组化学反应转化为一个数学对象——化学计量矩阵。通过分析该矩阵，我们可以揭示系统的基本属性，例如将系统动力学限制在特定子空间内的守恒律，这是对任何反应系统进行严格分析的基础步骤。", "problem": "考虑一个充分混合、等温、等容的介观反应器，其中包含三种化学物种 $A$、$B$ 和 $C$，它们经历以下单分子反应：$A \\to B$、$B \\to C$ 和 $C \\to A$，每个反应都作为具有有限速率常数的基元反应发生。该系统通过化学主方程进行随机建模，其中状态是分子数向量 $\\boldsymbol{n} = (n_A, n_B, n_C)^{\\mathsf{T}} \\in \\mathbb{Z}_{\\ge 0}^{3}$。化学计量矩阵 $S \\in \\mathbb{Z}^{3 \\times 3}$ 的定义是，其第 $j$ 列是第 $j$ 个反应通道的状态改变（化学计量）向量 $\\boldsymbol{\\nu}_j$，而化学计量子空间是由 $S$ 的列向量在 $\\mathbb{R}^{3}$ 中张成的线性子空间。线性守恒量是任意满足 $\\boldsymbol{\\ell}^{\\mathsf{T}} S = \\boldsymbol{0}^{\\mathsf{T}}$ 的向量 $\\boldsymbol{\\ell} \\in \\mathbb{R}^{3}$，这意味着 $\\boldsymbol{\\ell}^{\\mathsf{T}} \\boldsymbol{n}(t)$ 在动力学过程中保持不变。仅使用这些定义和标准线性代数，完成以下任务：\n1. 构建化学计量矩阵 $S$。\n2. 识别一个非平凡的线性守恒总数，并表示为 $n_A$、$n_B$ 和 $n_C$ 的显式线性组合。\n3. 确定化学计量子空间的维数。\n将您的最终结果报告为一个三元组，包含 $S$、守恒总数的显式符号表达式以及化学计量子空间的维数。不需要进行数值四舍五入，也不需要单位。您的最终答案必须是单一表达式。", "solution": "该问题要求针对给定的化学反应网络确定三个量：化学计量矩阵 $S$、一个非平凡的线性守恒量以及化学计量子空间的维数。本分析将基于所提供的定义和线性代数原理系统地进行。\n\n系统的状态由分子数向量 $\\boldsymbol{n} = (n_A, n_B, n_C)^{\\mathsf{T}}$ 给出，其中 $n_A$、$n_B$ 和 $n_C$ 分别是物种 $A$、$B$ 和 $C$ 的分子数。\n\n首先，我们构建化学计量矩阵 $S$。$S$ 的列是三个反应中每个反应的状态改变向量 $\\boldsymbol{\\nu}_j$。\n\n1.  反应 $R_1$：$A \\to B$。此反应消耗一个 $A$ 分子，生成一个 $B$ 分子。状态向量的变化为 $\\Delta\\boldsymbol{n} = (-1, 1, 0)^{\\mathsf{T}}$。因此，第一个状态改变向量是 $\\boldsymbol{\\nu}_1 = \\begin{pmatrix} -1 \\\\ 1 \\\\ 0 \\end{pmatrix}$。\n\n2.  反应 $R_2$：$B \\to C$。此反应消耗一个 $B$ 分子，生成一个 $C$ 分子。状态向量的变化为 $\\Delta\\boldsymbol{n} = (0, -1, 1)^{\\mathsf{T}}$。因此，第二个状态改变向量是 $\\boldsymbol{\\nu}_2 = \\begin{pmatrix} 0 \\\\ -1 \\\\ 1 \\end{pmatrix}$。\n\n3.  反应 $R_3$：$C \\to A$。此反应消耗一个 $C$ 分子，生成一个 $A$ 分子。状态向量的变化为 $\\Delta\\boldsymbol{n} = (1, 0, -1)^{\\mathsf{T}}$。因此，第三个状态改变向量是 $\\boldsymbol{\\nu}_3 = \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix}$。\n\n化学计量矩阵 $S$ 由这些向量作为其列构成：\n$$ S = \\begin{bmatrix} \\boldsymbol{\\nu}_1  \\boldsymbol{\\nu}_2  \\boldsymbol{\\nu}_3 \\end{bmatrix} = \\begin{pmatrix} -1  0  1 \\\\ 1  -1  0 \\\\ 0  1  -1 \\end{pmatrix} $$\n\n其次，我们识别一个非平凡的线性守恒量。根据所提供的定义，这对应于一个量 $\\boldsymbol{\\ell}^{\\mathsf{T}}\\boldsymbol{n}$，其中 $\\boldsymbol{\\ell} \\in \\mathbb{R}^{3}$ 是一个满足 $\\boldsymbol{\\ell}^{\\mathsf{T}} S = \\boldsymbol{0}^{\\mathsf{T}}$ 的非零向量。因此，向量 $\\boldsymbol{\\ell}$ 是 $S$ 的左零空间的一个基向量。设 $\\boldsymbol{\\ell} = (\\ell_A, \\ell_B, \\ell_C)^{\\mathsf{T}}$。条件 $\\boldsymbol{\\ell}^{\\mathsf{T}} S = \\boldsymbol{0}^{\\mathsf{T}}$ 可转化为以下线性方程组：\n$$ \\begin{pmatrix} \\ell_A  \\ell_B  \\ell_C \\end{pmatrix} \\begin{pmatrix} -1  0  1 \\\\ 1  -1  0 \\\\ 0  1  -1 \\end{pmatrix} = \\begin{pmatrix} 0  0  0 \\end{pmatrix} $$\n这得到：\n1.  $-\\ell_A + \\ell_B = 0 \\implies \\ell_A = \\ell_B$\n2.  $-\\ell_B + \\ell_C = 0 \\implies \\ell_B = \\ell_C$\n3.  $\\ell_A - \\ell_C = 0 \\implies \\ell_A = \\ell_C$\n\n从这些方程中，可以明显看出 $\\ell_A = \\ell_B = \\ell_C$。为了找到一个非平凡的向量 $\\boldsymbol{\\ell}$，我们可以设置 $\\ell_A = \\ell_B = \\ell_C = 1$。这得到 $\\boldsymbol{\\ell} = (1, 1, 1)^{\\mathsf{T}}$。相应的守恒量为：\n$$ \\boldsymbol{\\ell}^{\\mathsf{T}}\\boldsymbol{n} = \\begin{pmatrix} 1  1  1 \\end{pmatrix} \\begin{pmatrix} n_A \\\\ n_B \\\\ n_C \\end{pmatrix} = n_A + n_B + n_C $$\n这个量代表反应器中分子的总数，由于反应只在物种之间相互转化，因此该总数保持不变。\n\n第三，我们确定化学计量子空间的维数。该子空间是 $S$ 的列空间，其维数等于 $S$ 的秩，记为 $\\text{rank}(S)$。矩阵的秩是其列空间（及其行空间）的维数。\n\n我们可以观察到 $S$ 的列之间的线性关系：\n$$ \\boldsymbol{\\nu}_1 + \\boldsymbol{\\nu}_2 + \\boldsymbol{\\nu}_3 = \\begin{pmatrix} -1 \\\\ 1 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ -1 \\\\ 1 \\end{pmatrix} + \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n这表明这三个列向量是线性相关的，因此 $\\text{rank}(S)  3$。\n\n为了求出确切的秩，我们可以使用秩-零度定理，该定理对于矩阵 $A \\in \\mathbb{R}^{m \\times n}$ 表明 $\\text{rank}(A) + \\text{nullity}(A^{\\mathsf{T}}) = m$，其中 $\\text{nullity}(A^{\\mathsf{T}})$ 是左零空间的维数。我们已经发现 $S$ 的左零空间由单个向量 $\\boldsymbol{\\ell} = (1, 1, 1)^{\\mathsf{T}}$ 张成。因此，左零空间的维数是 $1$。矩阵 $S$ 有 $m=3$ 行。应用该定理：\n$$ \\text{rank}(S) + \\text{dim}(\\text{ker}(S^{\\mathsf{T}})) = 3 $$\n$$ \\text{rank}(S) + 1 = 3 $$\n$$ \\text{rank}(S) = 2 $$\n因此，化学计量子空间的维数是 $2$。\n\n所需的三个结果是矩阵 $S$、守恒量的表达式 $n_A + n_B + n_C$ 以及化学计量子空间的维数 $2$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\begin{pmatrix}\n-1  0  1 \\\\\n1  -1  0 \\\\\n0  1  -1\n\\end{pmatrix}\n\nn_A + n_B + n_C\n\n2\n\\end{pmatrix}\n}\n$$", "id": "2678453"}, {"introduction": "许多生物和化学系统在远离平衡的状态下运行，由持续的能量或物质流维持。本练习旨在探讨循环亲和势的概念，它量化了此类非平衡过程的热力学驱动力 [@problem_id:2678365]。通过将微观动力学速率与宏观热力学势联系起来，您将验证局部细致平衡原理所要求的内在一致性，这是随机热力学的基石之一。", "problem": "考虑一个描述三态单循环反应网络的连续时间马尔可夫跳跃过程，其状态为 $1 \\to 2 \\to 3 \\to 1$，处于均匀温度 $T$ 下。该系统与两个恒化势化学池耦合，这两个化学池分别为底物物种 $S$ 和产物物种 $P$ 维持恒定的化学势 $\\mu_{S}$ 和 $\\mu_{P}$。每个完成的正向循环 $1 \\to 2 \\to 3 \\to 1$ 对应于净化学转化 $S \\to P$。假设各状态的粗粒化内能相同，因此跃迁不改变系统的内能，并且不存在机械非保守力。该动力学遵循马尔可夫跳跃过程的微观可逆性和局域细致平衡。\n\n非零跃迁速率指定如下：\n$k_{12} = \\exp(2)\\,\\mathrm{s}^{-1}$，$k_{21} = 1\\,\\mathrm{s}^{-1}$，$k_{23} = \\exp(1)\\,\\mathrm{s}^{-1}$，$k_{32} = 1\\,\\mathrm{s}^{-1}$，$k_{31} = \\exp(2)\\,\\mathrm{s}^{-1}$，$k_{13} = 1\\,\\mathrm{s}^{-1}$。\n化学势满足 $\\mu_{S} - \\mu_{P} = 5\\,k_{B} T$，其中 $k_{B}$ 是玻尔兹曼常数。\n\n仅使用随机热力学的基本原理（微观可逆性和局域细致平衡），从指定的跃迁速率确定正向 $1 \\to 2 \\to 3 \\to 1$ 的稳态循环亲和势 $\\mathcal{A}$，并验证其与恒化势化学池的化学势的一致性。将最终的循环亲和势 $\\mathcal{A}$ 表示为无量纲数。无需四舍五入；给出精确值。", "solution": "该问题要求计算单循环反应网络的稳态循环亲和势 $\\mathcal{A}$，并验证其与所述热力学条件的一致性。根据将亲和势表示为无量纲数的要求，我们将以无量纲形式定义 $\\mathcal{A}$，这是随机热力学中的标准惯例。\n\n该系统是一个三态马尔可夫跳跃过程，状态标记为 $1$、$2$ 和 $3$。网络拓扑是一个单循环，为正向路径 $1 \\to 2 \\to 3 \\to 1$ 定义了跃迁。动力学由局域细致平衡原理支配。\n\n对于任意两个状态 $i$ 和 $j$ 之间的基本跃迁，局域细致平衡将正向和反向跃迁速率 $k_{ij}$ 和 $k_{ji}$ 与热力学力联系起来。对于循环 $C: 1 \\to 2 \\to 3 \\to 1$，无量纲循环亲和势 $\\mathcal{A}$ 是每一步的无量纲自由能降的总和。这可以用速率常数表示为：\n$$\n\\mathcal{A} = \\ln\\left(\\frac{k_{12}}{k_{21}}\\right) + \\ln\\left(\\frac{k_{23}}{k_{32}}\\right) + \\ln\\left(\\frac{k_{31}}{k_{13}}\\right)\n$$\n该表达式可简化为整个循环中正向速率乘积与反向速率乘积之比的自然对数：\n$$\n\\mathcal{A} = \\ln\\left(\\frac{k_{12} k_{23} k_{31}}{k_{21} k_{32} k_{13}}\\right)\n$$\n问题给出了以下非零跃迁速率：$k_{12} = \\exp(2)\\,\\mathrm{s}^{-1}$，$k_{21} = 1\\,\\mathrm{s}^{-1}$，$k_{23} = \\exp(1)\\,\\mathrm{s}^{-1}$，$k_{32} = 1\\,\\mathrm{s}^{-1}$，$k_{31} = \\exp(2)\\,\\mathrm{s}^{-1}$，以及 $k_{13} = 1\\,\\mathrm{s}^{-1}$。\n\n我们将这些值代入亲和势 $\\mathcal{A}$ 的表达式中。首先，我们计算循环 $1 \\to 2 \\to 3 \\to 1$ 的正向速率乘积：\n$$\nk_{12} k_{23} k_{31} = (\\exp(2)) \\cdot (\\exp(1)) \\cdot (\\exp(2)) = \\exp(2+1+2) = \\exp(5)\n$$\n该乘积的单位是 $(\\mathrm{s}^{-1})^{3}$。接下来，我们计算同一循环的反向速率乘积：\n$$\nk_{21} k_{32} k_{13} = (1) \\cdot (1) \\cdot (1) = 1\n$$\n单位也是 $(\\mathrm{s}^{-1})^{3}$。因此，这些乘积的比率是一个无量纲量：\n$$\n\\frac{k_{12} k_{23} k_{31}}{k_{21} k_{32} k_{13}} = \\frac{\\exp(5)}{1} = \\exp(5)\n$$\n然后通过取自然对数求得无量纲循环亲和势 $\\mathcal{A}$：\n$$\n\\mathcal{A} = \\ln(\\exp(5)) = 5\n$$\n任务的第二部分是验证此结果与恒化势化学池的化学势的一致性。\n根据非平衡热力学原理，有量纲的亲和势 $\\mathcal{A} \\cdot k_B T$ 必须等于一个循环中由外部化学池提供的总自由能。问题陈述了每个正向循环对应于净化学转化 $S \\to P$。此转化的自由能变化是化学势之差，$\\Delta\\mu = \\mu_S - \\mu_P$。\n为保证一致性，必须满足以下等式：\n$$\n\\mathcal{A} \\cdot k_B T = \\mu_S - \\mu_P\n$$\n我们已知化学势差为 $\\mu_S - \\mu_P = 5 \\, k_B T$。\n通过我们的动力学计算，我们发现无量纲亲和势为 $\\mathcal{A} = 5$。将此值代入一致性条件，得到：\n$$\n5 \\cdot k_B T = 5 \\, k_B T\n$$\n该等式成立。这证实了给定的动力学速率与化学池指定的的热力学驱动力完全一致，正如随机热力学基本原理所要求的那样。确定的无量纲循环亲和势为 $5$。", "answer": "$$\\boxed{5}$$", "id": "2678365"}, {"introduction": "理论概念在能够被检验和观察时才最强大。本练习将引导您理解Gillespie随机模拟算法（SSA）的内在逻辑，这是一种生成化学系统精确随机轨迹的主力方法 [@problem_id:2678446]。更关键的是，您还将学习如何基于单个反应事件来测量流入环境的熵，从而能够直接从模拟中计算热力学量。", "problem": "考虑一个温度为 $T$ 的混合均匀的等温稀溶液，其中包含 $S$ 个化学物种，它们通过 $R$ 个反应通道相互作用。令状态为分子数向量 $x \\in \\mathbb{N}_0^S$，并令第 $r$ 个反应的化学计量变化向量为 $\\nu_r \\in \\mathbb{Z}^S$，倾向函数为 $w_r(x)$，其中 $r \\in \\{1,\\dots,R\\}$。假设动力学由化学主方程控制，因此构成一个连续时间马尔可夫跳跃过程，其转移速率为 $k_{x \\to x+\\nu_r} = w_r(x)$。对于每个反应 $r$，假设存在一个唯一的逆反应通道 $r^\\star$，其化学计量变化向量为 $\\nu_{r^\\star} = -\\nu_r$，倾向函数为 $w_{r^\\star}(x')$，其中 $x' = x + \\nu_r$，使得局域细致平衡成立，即与通过 $r$ 的单次跳跃 $x \\to x'$ 相关的环境熵流由这些微观状态之间的正向和逆向速率的对数比给出。您希望使用直接随机模拟算法 (SSA) 在时间区间 $[0, T_{\\mathrm{end}}]$ 上模拟单条随机轨迹，并记录沿轨迹的累计环境熵产生 $S_{\\mathrm{m}}(t)$，作为所有跳跃贡献的总和。\n\n哪个选项正确地概述了针对该系统的直接 Gillespie 随机模拟算法 (SSA) 的步骤，并正确地指定了如何根据局域细致平衡在每次跳跃时记录环境熵增量？\n\nA. 在当前状态 $x$ 和时间 $t$，计算总倾向函数 $w_0(x) = \\sum_{r=1}^R w_r(x)$。从速率为 $w_0(x)$ 的指数分布（即对于 $\\tau \\ge 0$，概率密度为 $w_0(x)\\,\\exp(-w_0(x)\\,\\tau)$）中抽样一个等待时间 $\\tau$。以概率 $w_r(x)/w_0(x)$ 选择下一个反应通道 $r$。将状态更新为 $x' = x + \\nu_r$，并将时间更新为 $t \\leftarrow t + \\tau$。记录环境熵增量 $\\Delta s_{\\mathrm{m}} = \\ln\\left[\\dfrac{w_r(x)}{w_{r^\\star}(x')}\\right]$，将其加到 $S_{\\mathrm{m}}(t)$ 上，在 $x'$ 处重新计算倾向函数，并迭代直到 $t \\ge T_{\\mathrm{end}}$。\n\nB. 在当前状态 $x$ 和时间 $t$，计算 $w_0(x) = \\sum_{r=1}^R w_r(x)$。设置一个确定性的等待时间 $\\tau = 1/w_0(x)$。以概率 $w_r(x)/w_0(x)$ 选择反应 $r$。更新到 $x' = x + \\nu_r$，设置 $t \\leftarrow t + \\tau$，并记录 $\\Delta s_{\\mathrm{m}} = \\ln\\left[\\dfrac{w_r(x)}{w_0(x)}\\right]$。重复直到 $t \\ge T_{\\mathrm{end}}$。\n\nC. 在当前状态 $x$ 和时间 $t$，从速率为 $w_0(x) = \\sum_{r=1}^R w_r(x)$ 的指数分布中抽样一个等待时间 $\\tau$。以与 $w_r(x+\\nu_r)$ 成正比的概率选择反应 $r$，即根据归一化集合 $\\{w_r(x+\\nu_r)/\\sum_{q=1}^R w_q(x+\\nu_q)\\}$。更新到 $x' = x + \\nu_r$，设置 $t \\leftarrow t + \\tau$，并记录 $\\Delta s_{\\mathrm{m}} = -\\ln p_t(x') + \\ln p_t(x)$，其中 $p_t$ 是状态上的瞬时概率分布。重复直到 $t \\ge T_{\\mathrm{end}}$。\n\nD. 使用固定的时间离散化步长 $\\delta t  0$ 来演化系统。在每一步，从 $\\{1,\\dots,R\\}$ 中均匀随机抽取一个反应通道 $r$，如果一个均匀随机数 $u \\in [0,1]$ 小于 $w_r(x)\\,\\delta t$，则触发该反应，否则什么也不做；然后设置 $t \\leftarrow t + \\delta t$。如果反应 $r$ 触发，更新到 $x' = x + \\nu_r$ 并记录 $\\Delta s_{\\mathrm{m}} = \\ln\\left[\\dfrac{w_r(x)}{w_{r^\\star}(x)}\\right]$。继续直到 $t \\ge T_{\\mathrm{end}}$。", "solution": "其基本控制方程是化学主方程 (CME)，它定义了分子数状态空间上的一个连续时间马尔可夫跳跃过程。对于当前状态 $x$，离开 $x$ 的总速率是 $w_0(x) = \\sum_{r=1}^R w_r(x)$，其中 $w_r(x)$ 是反应 $r$ 在状态 $x$ 的倾向函数。从 CME 和标准的风险率论证可以得出连续时间马尔可夫跳跃过程的两个关键结果：\n\n$1.$ 等待时间分布。设 $P(\\tau)$ 为在时间 $t$ 系统处于状态 $x$ 的条件下，在时间区间 $[t, t+\\tau)$ 内没有反应发生的生存概率。在一个无穷小增量 $\\mathrm{d}\\tau$ 内，没有反应发生的概率是 $1 - w_0(x)\\,\\mathrm{d}\\tau + o(\\mathrm{d}\\tau)$，因为离开 $x$ 的总风险率为 $w_0(x)$。因此 $P(\\tau + \\mathrm{d}\\tau) = P(\\tau)\\left(1 - w_0(x)\\,\\mathrm{d}\\tau\\right) + o(\\mathrm{d}\\tau)$，这导致了微分方程 $\\dfrac{\\mathrm{d}P}{\\mathrm{d}\\tau} = -w_0(x)\\,P(\\tau)$，其初始条件为 $P(0) = 1$。解为 $P(\\tau) = \\exp\\left(-w_0(x)\\,\\tau\\right)$。因此，到下一次反应的等待时间 $\\tau$ 服从速率为 $w_0(x)$ 的指数分布，其概率密度为 $f(\\tau) = w_0(x)\\,\\exp\\left(-w_0(x)\\,\\tau\\right)$（对于 $\\tau \\ge 0$）。\n\n$2.$ 通道选择分布。在时间 $t+\\tau$ 发生一次反应的条件下，该反应通道为 $r$ 的概率由其风险率与跳跃前状态 $x$ 的总风险率之比给出，即 $\\mathbb{P}(r \\mid x) = w_r(x)/w_0(x)$。这可以从总速率分解为各通道的贡献以及指数等待时间的无记忆性推导得出。\n\n这两个结果是 Daniel Gillespie 的直接随机模拟算法 (SSA) 的基础：在每个状态，使用总倾向函数抽样一个指数等待时间，然后根据跳跃前状态的归一化倾向函数选择一个反应通道。\n\n现在考虑随机热力学中的环境熵流。对于服从局域细致平衡且具有明确定义的逆向转移的马尔可夫跳跃过程，通过反应 $r$ 的一次基本跳跃 $x \\to x'$ 所关联的环境熵增量由下式给出：\n$$\n\\Delta s_{\\mathrm{m}}(x \\to x'; r) \\equiv \\ln \\frac{k_{x \\to x'}(r)}{k_{x' \\to x}(r^\\star)} = \\ln \\frac{w_r(x)}{w_{r^\\star}(x')}.\n$$\n该表达式源于跳跃前后微小时间间隔内正向和时间反演路径段的概率密度之比。在等温条件、理想稀溶液和恒定化学势下，当考虑到相应的能量和化学贡献时，局域細致平衡通过 $\\Delta s_{\\mathrm{m}} = \\beta q_{\\mathrm{env}}$ 将此对数比与耗散的热量和化学功联系起来，但用于沿轨迹记录的基本、可直接实现的表达式是跳跃前状态的正向倾向函数与跳跃后状态的逆向倾向函数之对数比。\n\n我们现在来评估每个选项：\n\n选项 A：该选项指定计算 $w_0(x) = \\sum_{r=1}^R w_r(x)$；从速率为 $w_0(x)$ 的指数分布中抽样 $\\tau$；以概率 $w_r(x)/w_0(x)$ 选择反应 $r$；将状态更新为 $x \\to x' = x + \\nu_r$；并记录环境熵增量 $\\Delta s_{\\mathrm{m}} = \\ln\\left[w_r(x)/w_{r^\\star}(x')\\right]$。这些步骤与从 CME 推导出的等待时间和通道选择完全匹配，并且它们使用在跳跃后状态评估的逆向倾向函数实现了局域细致平衡的环境熵增量。在 $x'$ 处重新计算倾向函数并迭代是标准的直接 SSA 循环。因此，选项 A 是正确的。\n\n选项 B：该选项设置了一个确定性的等待时间 $\\tau = 1/w_0(x)$。这与从 CME 推导出的指数等待时间分布相矛盾；正确的等待时间是一个概率密度为 $w_0(x)\\,\\exp(-w_0(x)\\,\\tau)$ 的随机变量，而不是一个常数。此外，它记录的 $\\Delta s_{\\mathrm{m}} = \\ln\\left[w_r(x)/w_0(x)\\right]$ 也不是跳跃的局域细致平衡熵流；环境熵增量取决于从跳跃后状态出发的逆向转移速率，而不是跳跃前的总速率。因此，选项 B 是不正确的。\n\n选项 C：该选项使用了正确的速率为 $w_0(x)$ 的指数等待时间，但随后以与 $w_r(x+\\nu_r)$ 成正比的概率选择反应通道，即使用反应发生后的倾向函数来选择通道。正确的条件概率使用跳跃前的风险率 $w_r(x)/w_0(x)$；使用 $w_r(x+\\nu_r)$ 与跳跃前状态的马尔可夫跳跃过程分解不一致。此外，它记录的 $\\Delta s_{\\mathrm{m}} = -\\ln p_t(x') + \\ln p_t(x)$ 是瞬时系统熵变贡献 $\\Delta s_{\\mathrm{sys}}$，而不是环境熵流。如上所述，环境熵增量由正向和逆向速率的对数比给出。因此，选项 C 是不正确的。\n\n选项 D：该选项使用固定的时间步长 $\\delta t$ 和一种类似抽样筛选的方案，通过将一个均匀选择的 $r$ 所对应的 $w_r(x)\\,\\delta t$ 与 $u$ 进行比较。这不是直接 Gillespie SSA；它是一种基于拒绝的离散时间近似，通常不能产生精确的样本路径，除非 $\\delta t \\to 0$ 并且使用总速率抽样筛选来小心处理多个通道。此外，记录的环境熵增量 $\\Delta s_{\\mathrm{m}} = \\ln\\left[w_r(x)/w_{r^\\star}(x)\\right]$ 使用的是在跳跃前状态 $x$ 而非跳跃后状态 $x'$ 评估的逆向倾向函数，而局域细致平衡要求的是连接跳跃的两个状态之间的比率 $w_r(x)/w_{r^\\star}(x')$。因此，选项 D 是不正确的。\n\n总之，只有选项 A 正确地指定了精确的直接 Gillespie SSA 和每次跳跃时要记录的满足局域细致平衡的环境熵增量。", "answer": "$$\\boxed{A}$$", "id": "2678446"}]}