{"hands_on_practices": [{"introduction": "在进行任何不确定性分析之前，我们必须首先理解一个基本问题：模型预测对参数的微小变化有多敏感？这个概念被局部灵敏度系数所量化，它为我们评估参数可估性奠定了基础。本练习将通过一个简单的一级反应，引导您推导灵敏度系数的解析表达式，并分析其随时间变化的动态行为，从而为实验设计提供直观的洞察力。[@problem_id:2692536]", "problem": "在一个充分混合、等温、恒容的间歇式反应器中，考虑由质量作用定律控制的从物种$A$到物种$B$的不可逆单分子反应。令$x_{A}(t)$表示物种$A$在时间$t$的浓度，令$k>0$为一级反应速率常数。$x_{A}(t)$的动力学遵循常微分方程(ODE) $\\,\\frac{\\mathrm{d} x_{A}}{\\mathrm{d} t}=-k\\,x_{A}\\,$，初始条件为$\\,x_{A}(0)=x_{0}>0\\,$。\n\n任务：\n- 仅从常微分方程和初始条件出发，推导$x_{A}(t)$的闭式解。\n- 使用关于参数的局部灵敏度系数的定义，$S_{k}(t)=\\frac{\\partial x_{A}(t)}{\\partial k}$，计算$S_{k}(t)$的闭式表达式。\n- 从第一性原理简要解释$|S_{k}(t)|$在$t$较小和$t$较大时如何随时间$t$变化，并确定$|S_{k}(t)|$达到最大值的时间以及相应的最大值。\n\n答案规格：\n- 以$S_{k}(t)$的单一符号表达式形式提供您的最终答案。\n- 无需数值取整。\n- 在您最终的方框答案中不要包含单位。", "solution": "已对所提供的问题陈述进行分析，并确定其有效。这是一个源于化学动力学领域的科学基础扎实、适定且客观的问题。这是一个求解一阶常微分方程和进行灵敏度分析的标准练习，两者都是基本步骤。我们将进行推导。\n\n物种$A$的浓度（记作$x_{A}(t)$）的动力学由以下初值问题描述：\n$$ \\frac{\\mathrm{d}x_{A}}{\\mathrm{d}t} = -k x_{A}, \\quad x_{A}(0) = x_{0} $$\n其中$k > 0$且$x_{0} > 0$。这是一个一阶线性齐次常微分方程。该方程是可分离的，可以通过直接积分求解。\n$$ \\frac{\\mathrm{d}x_{A}}{x_{A}} = -k \\mathrm{d}t $$\n我们将两边从初始时间$t=0$积分到任意时间$t$。\n$$ \\int_{x_{A}(0)}^{x_{A}(t)} \\frac{1}{\\xi} \\mathrm{d}\\xi = \\int_{0}^{t} -k \\mathrm{d}\\tau $$\n积分得到：\n$$ [\\ln|\\xi|]_{x_{0}}^{x_{A}(t)} = [-k\\tau]_{0}^{t} $$\n$$ \\ln|x_{A}(t)| - \\ln|x_{0}| = -kt $$\n鉴于浓度$x_{A}$必须为非负，且初始浓度$x_{0}$为正，因此在所有有限时间$t$内，$x_{A}(t)$将保持为正。因此，可以去掉绝对值符号。\n$$ \\ln\\left(\\frac{x_{A}(t)}{x_{0}}\\right) = -kt $$\n通过对两边取指数，我们得到浓度分布的闭式解：\n$$ x_{A}(t) = x_{0} \\exp(-kt) $$\n这完成了第一个任务。\n\n第二个任务是计算$x_{A}(t)$关于参数$k$的局部灵敏度系数，其定义为$S_{k}(t) = \\frac{\\partial x_{A}(t)}{\\partial k}$。我们可以通过对推导出的$x_{A}(t)$表达式关于$k$求导来直接计算，将$x_{0}$和$t$视为常数。\n$$ S_{k}(t) = \\frac{\\partial}{\\partial k} \\left( x_{0} \\exp(-kt) \\right) $$\n使用链式法则求导，我们发现：\n$$ S_{k}(t) = x_{0} \\cdot \\exp(-kt) \\cdot \\frac{\\partial}{\\partial k}(-kt) $$\n$$ S_{k}(t) = x_{0} \\exp(-kt) (-t) $$\n因此，灵敏度系数的闭式表达式为：\n$$ S_{k}(t) = -t x_{0} \\exp(-kt) $$\n\n最后一个任务是分析灵敏度大小$|S_{k}(t)|$的行为，并求其最大值。因为$t \\ge 0$，$x_{0} > 0$，且$\\exp(-kt) > 0$，所以其大小为：\n$$ |S_{k}(t)| = t x_{0} \\exp(-kt) $$\n\n小$t$时的行为：对于$t \\to 0^{+}$，我们可以通过考虑指数项的泰勒级数展开来分析其行为，$\\exp(-kt) \\approx 1 - kt + \\mathcal{O}((kt)^{2})$。\n$$ |S_{k}(t)| \\approx t x_{0} (1 - kt) = x_{0}t - kx_{0}t^{2} $$\n对于小$t$，线性项占主导地位，所以$|S_{k}(t)|$随时间线性变化，即$|S_{k}(t)| \\propto t$。这在物理上是直观的：在$t=0$时，没有发生反应，所以浓度$x_A(0)=x_0$与$k$无关，使得灵敏度为零。随着反应的开始，浓度越来越依赖于速率常数$k$。\n\n大$t$时的行为：对于$t \\to \\infty$，指数项$\\exp(-kt)$衰减到零的速度远快于线性项$t$的增长速度。我们可以正式地计算这个极限：\n$$ \\lim_{t \\to \\infty} |S_{k}(t)| = \\lim_{t \\to \\infty} t x_{0} \\exp(-kt) = x_{0} \\lim_{t \\to \\infty} \\frac{t}{\\exp(kt)} $$\n这是一个$\\frac{\\infty}{\\infty}$的不定式。应用洛必达法则 (L'Hôpital's rule)：\n$$ x_{0} \\lim_{t \\to \\infty} \\frac{\\frac{\\mathrm{d}}{\\mathrm{d}t}(t)}{\\frac{\\mathrm{d}}{\\mathrm{d}t}(\\exp(kt))} = x_{0} \\lim_{t \\to \\infty} \\frac{1}{k \\exp(kt)} = 0 $$\n因此，当$t \\to \\infty$时，$|S_{k}(t)| \\to 0$。这在物理上也是合理的：经过很长时间后，反应接近完成（$x_{A} \\to 0$），这个最终状态与$k$的具体值无关（只要$k>0$）。系统的状态变得对其达到该状态的速率不敏感。\n\n为了找到$|S_{k}(t)|$达到最大值的时间，我们必须通过将其关于时间的一阶导数设为零来找到临界点。\n$$ \\frac{\\mathrm{d}}{\\mathrm{d}t}|S_{k}(t)| = \\frac{\\mathrm{d}}{\\mathrm{d}t} \\left( t x_{0} \\exp(-kt) \\right) $$\n使用乘积法则：\n$$ \\frac{\\mathrm{d}}{\\mathrm{d}t}|S_{k}(t)| = x_{0} \\left[ (1)\\exp(-kt) + t(-k \\exp(-kt)) \\right] = x_{0} \\exp(-kt) (1-kt) $$\n将导数设为零：\n$$ x_{0} \\exp(-kt) (1-kt) = 0 $$\n因为$x_{0} > 0$且$\\exp(-kt) > 0$，所以只有当$1-kt = 0$时方程才成立。这给出了最大灵敏度的时间：\n$$ t_{\\text{max}} = \\frac{1}{k} $$\n这个时间对应于一阶衰变过程的特征时间常数。为了确认这是一个最大值，我们可以检查二阶导数的符号，或者简单地注意到$|S_k(0)|=0$且当$t \\to \\infty$时$|S_k(t)| \\to 0$，而$t=1/k$是唯一的正临界点。因此，函数必须在此处达到其最大值。\n\n通过将$t_{\\text{max}}$代入$|S_{k}(t)|$的表达式，可以找到灵敏度的最大值：\n$$ |S_{k}(t_{\\text{max}})| = \\left(\\frac{1}{k}\\right) x_{0} \\exp\\left(-k\\left(\\frac{1}{k}\\right)\\right) = \\frac{x_{0}}{k} \\exp(-1) = \\frac{x_{0}}{ke} $$\n总而言之，浓度$x_A$对速率常数$k$的灵敏度最初为零，在特征时间$t=1/k$时增加到最大值$\\frac{x_0}{ke}$，然后随着反应完成而衰减到零。这个时间点代表了速率常数$k$的微小相对变化对物种$A$的浓度产生最大绝对影响的时刻。", "answer": "$$\n\\boxed{-t x_{0} \\exp(-k t)}\n$$", "id": "2692536"}, {"introduction": "单个灵敏度系数告诉我们特定时刻的信息，但一个完整的实验包含多个时间点的测量。费雪信息矩阵 (Fisher Information Matrix, FIM) 是一个关键工具，它通过对所有测量点的灵敏度进行加权求和，量化了整个实验所能提供的关于参数的总信息量。通过本练习，您将学会如何从灵敏度构建费雪信息，并探索采样时间的选择如何影响参数估计的精度，这是优化实验设计的核心问题。[@problem_id:2692578]", "problem": "考虑一个不可逆、等温、充分混合的间歇反应 $A \\to B$，该反应遵循质量作用动力学，其一级速率常数为 $k$（单位为 $\\,\\mathrm{s}^{-1}$）。物种 $A$ 的浓度，记为 $x_A(t)$，遵循常微分方程 $\\mathrm{d}x_A/\\mathrm{d}t=-k\\,x_A$，初始条件为 $x_A(0)=x_0$，其中 $x_0>0$ 已知。您在采样时间 $\\{t_i\\}_{i=1}^n$ 对 $x_A(t)$ 进行了 $n$ 次独立测量，观测模型为 $y_i=x_A(t_i)+\\varepsilon_i$，其中噪声 $\\varepsilon_i$ 是独立同分布的，服从均值为零、方差为 $\\sigma^2$ 的高斯分布，且 $\\sigma^2$ 已知。\n\n仅使用所述的动力学、观测模型以及统计估计理论中费雪信息的定义，推导关于 $k$ 的标量费雪信息（记为 $F_{kk}(k)$）的闭式表达式，该表达式应以 $x_0$、$\\sigma^2$、$k$ 和 $\\{t_i\\}_{i=1}^n$ 表示。然后，通过找出当 $k$ 被视为已知时，能使 $F_{kk}(k)$ 的单样本贡献最大化的采样时间 $t^\\star$（视为连续变量），来分析 $F_{kk}(k)$ 如何依赖于采样方案 $\\{t_i\\}_{i=1}^n$。请对此最大化点所体现的权衡关系进行简要的定性解释。\n\n费雪信息的单位应表示为秒的平方，但最终方框内的答案不应包含单位。您的最终答案必须是 $F_{kk}(k)$ 的一个解析表达式，并尽可能简化。", "solution": "首先对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 反应：$A \\to B$，不可逆、等温、充分混合、间歇。\n- 动力学：质量作用，一级。\n- 速率常数：$k$，单位为 $\\mathrm{s}^{-1}$。\n- 状态模型 (ODE)：$\\frac{\\mathrm{d}x_A}{\\mathrm{d}t}=-k\\,x_A$。\n- 初始条件：$x_A(0)=x_0$，其中 $x_0 > 0$ 已知。\n- 测量次数：$n$。\n- 采样时间：$\\{t_i\\}_{i=1}^n$。\n- 观测模型：$y_i=x_A(t_i)+\\varepsilon_i$。\n- 噪声模型：$\\varepsilon_i$ 为独立同分布 (i.i.d.) 的随机变量，服从均值为零、已知方差为 $\\sigma^2$ 的高斯分布，即 $\\varepsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$。\n\n**步骤2：使用提取的已知条件进行验证**\n根据所需标准对问题进行评估。\n- **科学依据**：该问题建立在化学动力学（一级衰减）和统计估计理论（加性高斯噪声下参数估计的费雪信息）的基本原理之上。这些都是标准的、完善的模型。该设定在科学上是合理的。\n- **适定性**：该问题提供了推导所求量所需的所有信息。模型被完全指定，参数被定义，任务以数学精度陈述。存在一个唯一的、有意义的解。\n- **客观性**：该问题使用客观、技术性的语言表述，不含任何主观或模棱两可的术语。\n\n该问题没有表现出任何列出的缺陷。它不是科学上不合理、不可形式化、不完整、不现实、不适定、微不足道或不可验证的。\n\n**步骤3：结论与行动**\n问题有效。将提供完整解答。\n\n从第一性原理开始推导。\n首先，我们必须求解控制物种 $A$ 浓度 $x_A(t)$ 的常微分方程。该方程为 $\\frac{\\mathrm{d}x_A}{\\mathrm{d}t} = -k x_A$。这是一个可分离的一阶线性微分方程。\n$$\n\\frac{\\mathrm{d}x_A}{x_A} = -k \\, \\mathrm{d}t\n$$\n对两边积分，时间从 $0$ 到 $t$，浓度从 $x_A(0)$ 到 $x_A(t)$：\n$$\n\\int_{x_A(0)}^{x_A(t)} \\frac{1}{\\xi} \\, \\mathrm{d}\\xi = \\int_0^t -k \\, \\mathrm{d}\\tau\n$$\n$$\n\\ln(x_A(t)) - \\ln(x_A(0)) = -kt\n$$\n给定初始条件 $x_A(0) = x_0$，我们有：\n$$\n\\ln\\left(\\frac{x_A(t)}{x_0}\\right) = -kt\n$$\n对两边取指数，得到浓度分布的解：\n$$\nx_A(t) = x_0 \\exp(-kt)\n$$\n观测模型是 $y_i = x_A(t_i) + \\varepsilon_i$，其中 $\\varepsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$。这意味着每次测量 $y_i$ 都是一个随机变量，服从均值为 $\\mu_i = x_A(t_i)$、方差为 $\\sigma^2$ 的高斯分布。给定参数 $k$ 时，单次测量 $y_i$ 的概率密度函数为：\n$$\np(y_i | k) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(y_i - x_A(t_i))^2}{2\\sigma^2}\\right)\n$$\n费雪信息衡量了可观测随机变量所携带的、关于该随机变量概率所依赖的未知参数的信息量。对于单个参数 $\\theta$ 以及被独立、加性、零均值、恒定方差 $\\sigma^2$ 的高斯噪声污染的观测值，费雪信息可简化为对所有测量的求和：\n$$\nF_{\\theta\\theta}(\\theta) = \\sum_{i=1}^n \\frac{1}{\\sigma^2} \\left( \\frac{\\partial \\mu_i}{\\partial \\theta} \\right)^2\n$$\n在我们的问题中，参数为 $\\theta = k$，在时间 $t_i$ 的测量均值为 $\\mu_i = x_A(t_i; k)$。因此，关于 $k$ 的标量费雪信息，记为 $F_{kk}(k)$，是：\n$$\nF_{kk}(k) = \\sum_{i=1}^n \\frac{1}{\\sigma^2} \\left( \\frac{\\partial x_A(t_i)}{\\partial k} \\right)^2\n$$\n我们必须计算状态 $x_A(t)$ 对参数 $k$ 的偏导数。这个导数被称为状态对参数的灵敏度。\n$$\n\\frac{\\partial x_A(t)}{\\partial k} = \\frac{\\partial}{\\partial k} \\left( x_0 \\exp(-kt) \\right)\n$$\n由于 $x_0$ 和 $t$ 不是 $k$ 的函数，我们应用链式法则：\n$$\n\\frac{\\partial x_A(t)}{\\partial k} = x_0 \\exp(-kt) \\cdot \\frac{\\partial}{\\partial k}(-kt) = x_0 \\exp(-kt) \\cdot (-t) = -t x_0 \\exp(-kt)\n$$\n现在，我们将此灵敏度表达式代回费雪信息的公式中：\n$$\nF_{kk}(k) = \\sum_{i=1}^n \\frac{1}{\\sigma^2} \\left( -t_i x_0 \\exp(-kt_i) \\right)^2\n$$\n简化求和内的表达式：\n$$\nF_{kk}(k) = \\sum_{i=1}^n \\frac{1}{\\sigma^2} \\left( t_i^2 x_0^2 \\exp(-2kt_i) \\right)\n$$\n由于 $x_0$ 和 $\\sigma^2$ 对所有测量都是常数，它们可以从求和中提取出来：\n$$\nF_{kk}(k) = \\frac{x_0^2}{\\sigma^2} \\sum_{i=1}^n t_i^2 \\exp(-2kt_i)\n$$\n这就是速率常数 $k$ 的费雪信息的闭式表达式。$x_0$ 和 $\\sigma$ 的单位是浓度，使得比值 $x_0^2/\\sigma^2$ 是无量纲的。速率常数 $k$ 的单位是 $\\mathrm{s}^{-1}$，时间 $t_i$ 的单位是 $\\mathrm{s}$，所以指数的参数 $-2kt_i$ 是无量纲的。$t_i^2$ 项的单位是 $\\mathrm{s}^2$，因此 $F_{kk}(k)$ 的整个表达式的单位是 $\\mathrm{s}^2$，符合要求。\n\n接下来，我们分析使费雪信息的单样本贡献最大化的采样时间 $t^\\star$。在时间 $t$ 进行单次采样的贡献是求和项：\n$$\nf(t; k) = \\frac{x_0^2}{\\sigma^2} t^2 \\exp(-2kt)\n$$\n为了找到使该函数最大化的时间 $t$，我们计算它关于 $t$ 的导数并将其设为零。项 $\\frac{x_0^2}{\\sigma^2}$ 是一个正常数，不影响最大值的位置。设 $g(t) = t^2 \\exp(-2kt)$。\n$$\n\\frac{\\mathrm{d}g}{\\mathrm{d}t} = \\frac{\\mathrm{d}}{\\mathrm{d}t} \\left( t^2 \\exp(-2kt) \\right)\n$$\n使用乘积法则求导：\n$$\n\\frac{\\mathrm{d}g}{\\mathrm{d}t} = (2t) \\exp(-2kt) + t^2 \\exp(-2kt) \\cdot (-2k) = (2t - 2kt^2) \\exp(-2kt)\n$$\n我们将导数设为零以寻找临界点：\n$$\n(2t - 2kt^2) \\exp(-2kt) = 2t(1-kt) \\exp(-2kt) = 0\n$$\n对于有物理意义的时间 $t > 0$，项 $2t \\exp(-2kt)$ 总是正的。因此，极值点出现在以下情况：\n$$\n1-kt = 0 \\implies kt = 1 \\implies t^\\star = \\frac{1}{k}\n$$\n为确认这是一个最大值，我们检查二阶导数。\n$$\n\\frac{\\mathrm{d}^2g}{\\mathrm{d}t^2} = \\frac{\\mathrm{d}}{\\mathrm{d}t} \\left( (2t - 2kt^2) \\exp(-2kt) \\right) = (2 - 4kt)\\exp(-2kt) + (2t - 2kt^2)(-2k)\\exp(-2kt)\n$$\n$$\n\\frac{\\mathrm{d}^2g}{\\mathrm{d}t^2} = (2 - 4kt - 4kt + 4k^2t^2)\\exp(-2kt) = (2 - 8kt + 4k^2t^2)\\exp(-2kt)\n$$\n在 $t = t^\\star = 1/k$ 处求值：\n$$\n\\left. \\frac{\\mathrm{d}^2g}{\\mathrm{d}t^2} \\right|_{t=1/k} = (2 - 8k(1/k) + 4k^2(1/k)^2)\\exp(-2k(1/k)) = (2 - 8 + 4)\\exp(-2) = -2\\exp(-2)\n$$\n由于二阶导数为负， $t^\\star = 1/k$ 确实是一个局部最大值。因为当 $t \\to 0^+$ 时 $g(t) \\to 0$ 且当 $t \\to \\infty$ 时 $g(t) \\to 0$，所以这是 $t>0$ 上的全局最大值。\n\n这个最佳采样时间的存在反映了一个基本的权衡。信息量与灵敏度的平方 $(\\frac{\\partial x_A}{\\partial k})^2 = t^2 x_A(t)^2$ 成正比。该表达式包含两个相互竞争的因素。$t^2$ 因子表明对 $k$ 的灵敏度随时间增加；等待更长时间可以让速率的影响累积。然而，$x_A(t)^2 = (x_0 \\exp(-kt))^2$ 因子表明随着时间的推移，反应物浓度呈指数衰减。当浓度接近零时，信噪比降低，测量所提供的信息变少。最佳采样时间 $t^\\star = 1/k$，即反应的特征时间常数，代表了这种权衡达到完美平衡的点。此时，浓度已衰减至 $x_A(1/k) = x_0 \\exp(-1)$，这个值与初始状态有显著差异，但仍然足够大，可以进行有合理精度的测量。", "answer": "$$\n\\boxed{\\frac{x_0^2}{\\sigma^2} \\sum_{i=1}^n t_i^2 \\exp(-2kt_i)}\n$$", "id": "2692578"}, {"introduction": "在某些情况下，无论我们收集多少完美的数据，模型的某些参数组合都可能无法被唯一确定，这种现象被称为结构不可辨识性。这通常发生在不同参数对模型输出产生相似或线性相关的影响时，导致灵敏度矩阵的列向量线性相关，矩阵失去满秩。本练习将引导您通过对经典的米氏动力学模型进行前向灵敏度分析和奇异值分解，以编程方式诊断这种内在的不可辨识性，揭示模型结构对参数估计的根本限制。[@problem_id:2692559]", "problem": "考虑一个遵循准稳态近似下米氏动力学的单酶单底物系统，该系统在单次底物脉冲下进行观测。状态变量为底物浓度 $S(t)$ 和产物浓度 $P(t)$。该模型假设酶池总量守恒且具有催化活性，总浓度为 $E_0$，并且不会被消耗。设未知参数矢量为 $\\boldsymbol{\\theta} = (k_{\\text{cat}}, E_0, K_M)$，其中 $k_{\\text{cat}}$ 是催化速率常数，$E_0$ 是总酶浓度，$K_M$ 是米氏常数。其控制常微分方程 (ODEs) 为\n$$\n\\frac{\\mathrm{d}S}{\\mathrm{d}t} = -v(S;\\boldsymbol{\\theta}), \\quad \\frac{\\mathrm{d}P}{\\mathrm{d}t} = v(S;\\boldsymbol{\\theta}),\n$$\n其中米氏速率为\n$$\nv(S;\\boldsymbol{\\theta}) = \\frac{k_{\\text{cat}}\\,E_0\\,S}{K_M + S}.\n$$\n单次底物脉冲实验的初始条件为 $S(0) = S_0$ 和 $P(0) = 0$。可观测量是在离散时间点 $t_1,\\ldots,t_m$ 采样的产物轨迹，即对 $i \\in \\{1,\\ldots,m\\}$ 有 $y_i = P(t_i;\\boldsymbol{\\theta})$。\n\n您的任务是使用灵敏度矩阵的秩分析，从单次脉冲产物观测中检测参数矢量 $\\boldsymbol{\\theta}$ 的局部结构不可辨识性。请基于以下基本原理进行操作：\n- 准稳态近似下的酶动力学反应速率定律。\n- 用于对常微分方程解关于参数求导的链式法则。\n- 用于数值秩估计的奇异值分解 (SVD)。\n\n定义灵敏度矩阵 $J \\in \\mathbb{R}^{m \\times 3}$ 为\n$$\nJ_{i,j} = \\frac{\\partial P(t_i;\\boldsymbol{\\theta})}{\\partial \\theta_j},\n$$\n其中 $\\theta_1 = k_{\\text{cat}}$，$\\theta_2 = E_0$，$\\theta_3 = K_M$。当 $J$ 的数值秩小于 $3$ 时，表明参数存在不可辨识性。\n\n您必须通过使用链式法则和给定模型，将 $(S,P)$ 的常微分方程系统与灵敏度 $\\frac{\\partial S}{\\partial \\theta_j}$ 和 $\\frac{\\partial P}{\\partial \\theta_j}$ (其中 $j \\in \\{1,2,3\\}$) 进行增广，从而实现前向灵敏度分析。使用奇异值分解计算 $J$ 的数值秩，并采用以下容差：\n$$\n\\tau = \\varepsilon \\cdot \\max(m,3) \\cdot \\sigma_{\\max},\n$$\n其中 $\\varepsilon = 10^{-9}$，$\\sigma_{\\max}$ 是 $J$ 的最大奇异值。通过计算严格大于 $\\tau$ 的奇异值数量来确定数值秩。返回一个布尔值以指示不可辨识性：如果秩小于 $3$，则返回 $\\text{True}$，否则返回 $\\text{False}$。\n\n输出中无需物理单位；输出为无量纲布尔值。不涉及角度。不涉及百分比。\n\n测试套件。使用以下 $4$ 个案例；在每个案例中，在包含端点的 $N$ 个点的均匀网格上，从 $t=0$ 积分到 $t=T$ 来定义采样时间 $t_i$。所有案例均使用初始条件 $S(0) = S_0$ 和 $P(0) = 0$。\n- 案例 $1$ (典型状态，持续时间充足): $k_{\\text{cat}} = 1.0$, $E_0 = 0.5$, $K_M = 2.0$, $S_0 = 10.0$, $T = 20.0$, $N = 51$。\n- 案例 $2$ (催化速度快，持续时间短): $k_{\\text{cat}} = 5.0$, $E_0 = 0.1$, $K_M = 2.0$, $S_0 = 10.0$, $T = 2.0$, $N = 41$。\n- 案例 $3$ (初始底物极少，持续时间长): $k_{\\text{cat}} = 1.0$, $E_0 = 1.0$, $K_M = 2.0$, $S_0 = 0.01$, $T = 20.0$, $N = 51$。\n- 案例 $4$ (米氏常数大，近线性状态): $k_{\\text{cat}} = 1.0$, $E_0 = 0.5$, $K_M = 1000.0$, $S_0 = 10.0$, $T = 20.0$, $N = 51$。\n\n最终输出规格。您的程序应生成单行输出，其中包含一个用方括号括起来的、按案例 $1$ 到 $4$ 顺序排列的逗号分隔布尔值列表，例如 $[\\text{True},\\text{False},\\text{True},\\text{True}]$。", "solution": "用户提供了一个关于米氏动力学模型中参数的局部结构可辨识性的问题。根据我的职责，在进行求解之前，我将首先验证问题陈述。\n\n### 步骤 1：提取已知条件\n- **模型**：准稳态近似下的单酶单底物动力学。\n- **状态变量**：底物浓度 $S(t)$ 和产物浓度 $P(t)$。\n- **控制常微分方程**：\n$$ \\frac{\\mathrm{d}S}{\\mathrm{d}t} = -v(S;\\boldsymbol{\\theta}), \\quad \\frac{\\mathrm{d}P}{\\mathrm{d}t} = v(S;\\boldsymbol{\\theta}) $$\n- **速率定律**：\n$$ v(S;\\boldsymbol{\\theta}) = \\frac{k_{\\text{cat}}\\,E_0\\,S}{K_M + S} $$\n- **参数矢量**：$\\boldsymbol{\\theta} = (\\theta_1, \\theta_2, \\theta_3)^T = (k_{\\text{cat}}, E_0, K_M)^T$。\n- **初始条件**：$S(0) = S_0$, $P(0) = 0$。\n- **可观测量**：离散时间点的产物浓度，$y_i = P(t_i;\\boldsymbol{\\theta})$。\n- **任务**：通过分析灵敏度矩阵 $J$ 的秩来确定局部结构不可辨识性。\n- **灵敏度矩阵**：$J \\in \\mathbb{R}^{m \\times 3}$，其中 $J_{i,j} = \\frac{\\partial P(t_i;\\boldsymbol{\\theta})}{\\partial \\theta_j}$。\n- **不可辨识性条件**：$J$ 的数值秩小于 $3$。\n- **方法**：通过增广常微分方程系统进行前向灵敏度分析。\n- **数值秩计算**：\n    - 计算 $J$ 的奇异值分解 (SVD)。\n    - 容差 $\\tau = \\varepsilon \\cdot \\max(m,3) \\cdot \\sigma_{\\max}$，其中 $\\varepsilon = 10^{-9}$，$\\sigma_{\\max}$ 是 $J$ 的最大奇异值。\n    - 秩是严格大于 $\\tau$ 的奇异值的数量。\n- **输出**：对于不可辨识（秩 < 3）的情况，输出布尔值 `True`，否则输出 `False`。\n- **测试案例**：提供了四组特定的参数和实验条件。\n\n### 步骤 2：问题验证\n该问题具有科学依据，采用了米氏模型和灵敏度分析，这些是化学动力学和系统生物学中的核心概念。其表述客观、数学上精确且自洽，为获得唯一解提供了所有必要的定义、常数和数据。指定的数值秩确定方法（带有确定容差的 SVD）是数值线性代数中的标准实践。该问题是适定的，并与指定主题直接相关。不存在不一致、歧义或事实错误。\n\n### 步骤 3：结论与行动\n问题是 **有效的**。我将继续提供完整解答。\n\n### 基于原理的解决方案\n该问题要求执行前向灵敏度分析以构建灵敏度矩阵 $J$，然后确定其数值秩。\n\n首先，我们观察到系统有一个守恒量：$S(t) + P(t) = S_0 + P(0) = S_0$。这可以用于简化问题。可观测量为 $P(t_i) = S_0 - S(t_i)$。可观测量关于参数 $\\theta_j$ 的灵敏度为：\n$$ \\frac{\\partial P(t)}{\\partial \\theta_j} = \\frac{\\partial}{\\partial \\theta_j}(S_0 - S(t)) = -\\frac{\\partial S(t)}{\\partial \\theta_j} $$\n因此，灵敏度矩阵 $J$ 可以由底物浓度 $S(t)$ 的灵敏度构建。我们只需要求解 $S(t)$ 及其灵敏度。\n\n设 $S_j(t) = \\frac{\\partial S(t)}{\\partial \\theta_j}$，其中 $j=1,2,3$。我们用其灵敏度的三个附加常微分方程来增广关于 $S(t)$ 的单个常微分方程。底物的常微分方程为：\n$$ \\frac{\\mathrm{d}S}{\\mathrm{d}t} = -v(S; \\boldsymbol{\\theta}) = -\\frac{k_{\\text{cat}}E_0 S}{K_M + S} $$\n为了找到灵敏度 $S_j$ 的常微分方程，我们使用链式法则对上述方程关于 $\\theta_j$ 求导：\n$$ \\frac{\\mathrm{d} S_j}{\\mathrm{d}t} = \\frac{\\mathrm{d}}{\\mathrm{d}t}\\left(\\frac{\\partial S}{\\partial \\theta_j}\\right) = \\frac{\\partial}{\\partial \\theta_j}\\left(\\frac{\\mathrm{d}S}{\\mathrm{d}t}\\right) = -\\frac{\\partial v}{\\partial \\theta_j} = -\\left( \\frac{\\partial v}{\\partial S} \\frac{\\partial S}{\\partial \\theta_j} + \\frac{\\partial v}{\\partial \\theta_j} \\right) = -\\frac{\\partial v}{\\partial S} S_j - \\frac{\\partial v}{\\partial \\theta_j} $$\n所需的速率函数 $v$ 的偏导数如下：\n- 关于 $S$ 的偏导数：\n$$ \\frac{\\partial v}{\\partial S} = \\frac{\\partial}{\\partial S}\\left( \\frac{k_{\\text{cat}}E_0 S}{K_M + S} \\right) = \\frac{k_{\\text{cat}}E_0 K_M}{(K_M + S)^2} $$\n- 关于 $\\theta_1 = k_{\\text{cat}}$ 的偏导数：\n$$ \\frac{\\partial v}{\\partial k_{\\text{cat}}} = \\frac{E_0 S}{K_M + S} $$\n- 关于 $\\theta_2 = E_0$ 的偏导数：\n$$ \\frac{\\partial v}{\\partial E_0} = \\frac{k_{\\text{cat}} S}{K_M + S} $$\n- 关于 $\\theta_3 = K_M$ 的偏导数：\n$$ \\frac{\\partial v}{\\partial K_M} = \\frac{\\partial}{\\partial K_M} \\left( \\frac{k_{\\text{cat}}E_0 S}{K_M + S} \\right) = -\\frac{k_{\\text{cat}}E_0 S}{(K_M + S)^2} $$\n\n这构成了一个关于状态矢量 $\\mathbf{Y}(t) = [S(t), S_1(t), S_2(t), S_3(t)]^T$ 的 4 个常微分方程的增广系统。\n初始条件为 $S(0) = S_0$，并且由于初始条件不依赖于参数，初始灵敏度为零：$S_j(0) = \\frac{\\partial S(0)}{\\partial \\theta_j} = 0$ (对 $j=1,2,3$)。因此，初始状态矢量为 $\\mathbf{Y}(0) = [S_0, 0, 0, 0]^T$。\n\n对于每个测试案例，我们将该常微分方程系统从 $t=0$ 到 $t=T$ 进行数值积分，并在 $m=N$ 个均匀间隔的时间点 $t_i$ 上评估解。该解提供了 $S(t_i)$ 的轨迹和灵敏度 $S_j(t_i)$。\n\n然后，组装灵敏度矩阵 $J \\in \\mathbb{R}^{m \\times 3}$，其元素由 $J_{i,j} = -\\frac{\\partial S(t_i)}{\\partial \\theta_j} = -S_j(t_i)$ 给出。\n\n米氏速率定律的一个基本特征是，参数 $k_{\\text{cat}}$ 和 $E_0$ 仅以乘积 $V_{\\max} = k_{\\text{cat}}E_0$ 的形式出现。因此，在仅测量反应进程的实验中，它们无法被独立辨识。这是结构不可辨识性的一个经典案例。从解析上看，这意味着关于 $k_{\\text{cat}}$ 和 $E_0$ 的灵敏度列之间存在线性相关性：$\\frac{\\partial P}{\\partial E_0} = \\frac{k_{\\text{cat}}}{E_0} \\frac{\\partial P}{\\partial k_{\\text{cat}}}$。因此，灵敏度矩阵 $J$ 的解析秩最多为 $2$。在某些动力学区间，例如当 $S \\ll K_M$ 时，所有参数会坍缩成一个单一的有效速率常数，从而使秩进一步降至 $1$。在所有情况下，解析秩都小于 $3$。数值任务是验证这种不可辨识性是否能被指定的数值秩分析检测到。\n\n对于每个测试案例，我们计算矩阵 $J$ 的奇异值分解 (SVD)。设奇异值为 $\\sigma_1 \\ge \\sigma_2 \\ge \\sigma_3 \\ge 0$。数值秩通过计算严格大于容差 $\\tau = \\varepsilon \\cdot \\max(m,3) \\cdot \\sigma_1$ 的奇异值数量来确定，其中 $\\varepsilon=10^{-9}$ 且 $\\sigma_1 = \\sigma_{\\max}$。如果计算出的秩小于 $3$，则参数被视为不可辨识，结果为 `True`。否则为 `False`。\n考虑到结构不可辨识性，第三个奇异值 $\\sigma_3$ 在数值上应接近于零，因此小于容差 $\\tau$，导致数值秩为 $2$ 或 $1$。所有给定测试案例的预期结果均为 `True`。", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the parameter identifiability problem for the given test cases.\n    \"\"\"\n\n    test_cases = [\n        # Case 1: k_cat, E0, KM, S0, T, N\n        (1.0, 0.5, 2.0, 10.0, 20.0, 51),\n        # Case 2\n        (5.0, 0.1, 2.0, 10.0, 2.0, 41),\n        # Case 3\n        (1.0, 1.0, 2.0, 0.01, 20.0, 51),\n        # Case 4\n        (1.0, 0.5, 1000.0, 10.0, 20.0, 51),\n    ]\n\n    results = []\n    \n    # Epsilon for numerical rank tolerance\n    eps = 1e-9\n\n    for case in test_cases:\n        k_cat, E0, KM, S0, T, N = case\n        params = (k_cat, E0, KM)\n\n        def augmented_ode_system(t, y, p):\n            \"\"\"\n            Defines the augmented ODE system for substrate and its sensitivities.\n            y[0]: S (substrate concentration)\n            y[1]: dS/dk_cat (sensitivity wrt k_cat)\n            y[2]: dS/dE0 (sensitivity wrt E0)\n            y[3]: dS/dKM (sensitivity wrt KM)\n            p: (k_cat, E0, KM)\n            \"\"\"\n            S, S_kcat, S_E0, S_KM = y\n            k_cat_p, E0_p, KM_p = p\n\n            # To prevent division by zero, although S>=0 and KM>0 here.\n            # A small value is added for robustness in a general context.\n            # For this problem, it's not strictly necessary.\n            if KM_p + S  1e-12:\n                # This state is unphysical but handled for solver stability\n                return np.zeros(4)\n\n            # Michaelis-Menten rate and its partial derivatives\n            common_denom = KM_p + S\n            v_rate = (k_cat_p * E0_p * S) / common_denom\n            \n            dv_dS = (k_cat_p * E0_p * KM_p) / (common_denom**2)\n            dv_dkcat = (E0_p * S) / common_denom\n            dv_dE0 = (k_cat_p * S) / common_denom\n            dv_dKM = -(k_cat_p * E0_p * S) / (common_denom**2)\n\n            # ODEs for substrate and sensitivities\n            dS_dt = -v_rate\n            dS_kcat_dt = -dv_dS * S_kcat - dv_dkcat\n            dS_E0_dt = -dv_dS * S_E0 - dv_dE0\n            dS_KM_dt = -dv_dS * S_KM - dv_dKM\n            \n            return [dS_dt, dS_kcat_dt, dS_E0_dt, dS_KM_dt]\n\n        # Initial conditions: S(0)=S0, all sensitivities are 0\n        y0 = [S0, 0.0, 0.0, 0.0]\n\n        # Time points for integration\n        t_span = (0, T)\n        t_eval = np.linspace(0, T, N)\n        \n        # Solve the augmented ODE system\n        sol = solve_ivp(\n            fun=augmented_ode_system,\n            t_span=t_span,\n            y0=y0,\n            t_eval=t_eval,\n            args=(params,),\n            method='RK45',\n            atol=1e-12,\n            rtol=1e-9\n        )\n        \n        # Extract sensitivities for S. The sensitivities for P are -1 * those for S.\n        # J_ij = dP(t_i)/d_theta_j = -dS(t_i)/d_theta_j\n        # sol.y has shape (4, N)\n        # sol.y[1] is dS/dk_cat, sol.y[2] is dS/dE0, sol.y[3] is dS/dKM\n        J = -sol.y[1:4, :].T  # shape (N, 3)\n\n        # Compute SVD and numerical rank\n        if J.shape[0] == 0:\n             # Handle edge case of no time points\n            rank = 0\n        else:\n            # Compute singular values\n            singular_values = np.linalg.svd(J, compute_uv=False)\n            sigma_max = singular_values[0] if len(singular_values) > 0 else 0\n\n            if sigma_max > 1e-15: # Avoid issues with all-zero matrix\n                m, n_params = J.shape\n                # Tolerance as specified in the problem\n                tau = eps * max(m, n_params) * sigma_max\n                # Numerical rank\n                rank = np.sum(singular_values > tau)\n            else:\n                rank = 0\n\n        # Non-identifiable if rank is less than the number of parameters (3)\n        non_identifiable = (rank  3)\n        results.append(non_identifiable)\n\n    # Format and print the final output\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == '__main__':\n    solve()\n```", "id": "2692559"}]}