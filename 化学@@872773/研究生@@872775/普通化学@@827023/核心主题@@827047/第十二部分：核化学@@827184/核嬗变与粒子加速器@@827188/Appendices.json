{"hands_on_practices": [{"introduction": "带电粒子在物质中的能量损失是核物理和核化学实验设计中的一个核心概念。本练习通过实践贝特公式 (Bethe formula)，让你亲手计算质子在铝靶中的射程，从而深入理解粒子如何与物质相互作用。通过实现一个包含低能修正的实际模型并进行数值积分，你将掌握预测粒子行为的基础技能，这对于设计靶、探测器和辐射屏蔽至关重要。[@problem_id:2948349]", "problem": "一个动能为 $E_0$ 的质子笔形束穿过一个均匀的铝靶，根据阻止本领概念，其能量会损失给靶中的电子。对于电荷为 $z e$、速度为 $v$ 的带电粒子，其平均电子质量阻止本领 $S_m(E)$（单位面密度的能量损失）在非相对论到中度相对论能量范围内，通过 Bethe 公式进行建模。该公式由受运动学和玻恩近似约束的与靶电子的二元库仑碰撞推导得出。您将通过从第一性原理出发，对 $1/S(E)$ 进行数值积分，计算在铝中的投影连续慢化近似 (CSDA) 射程 $R$，并将结果与受“物质中离子阻止及射程”(SRIM) 启发的半经验期望值进行比较。\n\n基本原理和给定数据：\n- 铝的材料参数为：原子序数 $Z = 13$，摩尔质量 $A = 26.9815385\\,\\mathrm{g/mol}$，体密度 $\\rho = 2.70\\,\\mathrm{g/cm^3}$，以及平均激发能 $I = 166\\,\\mathrm{eV} = 1.66\\times 10^{-4}\\,\\mathrm{MeV}$。\n- 在电子阻止区，重带电粒子（此处为质子，$z=1$）的 Bethe 质量阻止本领为\n$$\nS_m(E) = K \\frac{z^2 Z}{A} \\frac{1}{\\beta^2} \\left[ \\frac{1}{2}\\ln\\!\\left(\\frac{2 m_e c^2 \\beta^2 \\gamma^2\\, T_{\\max}}{I^2}\\right) - \\beta^2 - \\frac{\\delta}{2} \\right],\n$$\n其中 $K = 0.307075\\,\\mathrm{MeV\\,cm^2/g}$，$m_e c^2 = 0.51099895\\,\\mathrm{MeV}$，$m_p c^2 = 938.2720813\\,\\mathrm{MeV}$，$z=1$，$\\gamma = 1 + E/(m_p c^2)$，$\\beta^2 = 1 - 1/\\gamma^2$，并且在单次碰撞中可转移给一个电子的最大动能为\n$$\nT_{\\max} = \\frac{2 m_e c^2 \\beta^2 \\gamma^2}{1 + 2\\gamma (m_e/m_p) + (m_e/m_p)^2}.\n$$\n对于本任务所关注的能量范围，密度效应修正可以忽略，因此设 $\\delta = 0$。对于指定的能量和材料，核阻止和辐射过程也可忽略不计。\n- CSDA 面射程 $R_m$（单位为 $\\mathrm{g/cm^2}$）满足\n$$\nR_m(E_0) = \\int_0^{E_0} \\frac{dE}{S_m(E)}.\n$$\n投影路径长度 $R$（单位为 $\\mathrm{cm}$）为 $R(E_0) = R_m(E_0)/\\rho$。\n\n为保证物理真实性和数值稳定性进行的低能修正：\n- Bethe 模型在低能区会失效，因为此时入射粒子的有效电荷和电荷交换过程会改变 $S_m(E)$。为保持科学真实性，当 $E  E_{\\mathrm{patch}}$（其中 $E_{\\mathrm{patch}} = 0.1\\,\\mathrm{MeV}$）时，使用一个匹配的低能替代模型。通过如下定义来保证在 $E_{\\mathrm{patch}}$ 处的数值连续性\n$$\nS_m^{\\mathrm{low}}(E) = S_m(E_{\\mathrm{patch}})\\,\\left(\\frac{E}{E_{\\mathrm{patch}}}\\right)^{1/2}, \\quad 0 \\le E \\le E_{\\mathrm{patch}}.\n$$\n- 使用此替代模型，对面积射程的低能贡献具有以下闭合形式\n$$\nR_m^{\\mathrm{low}}(E_0) =\n\\begin{cases}\n\\displaystyle \\frac{2 \\sqrt{E_{\\mathrm{patch}}\\, E_0}}{S_m(E_{\\mathrm{patch}})},  0 \\le E_0 \\le E_{\\mathrm{patch}},\\\\[8pt]\n\\displaystyle \\frac{2 E_{\\mathrm{patch}}}{S_m(E_{\\mathrm{patch}})},  E_0  E_{\\mathrm{patch}}.\n\\end{cases}\n$$\n- 对于 $E_0  E_{\\mathrm{patch}}$，通过数值积分计算剩余的面射程\n$$\nR_m^{\\mathrm{Bethe}}(E_0) = \\int_{E_{\\mathrm{patch}}}^{E_0} \\frac{dE}{S_m(E)},\n$$\n并设 $R_m(E_0) = R_m^{\\mathrm{low}}(E_0) + R_m^{\\mathrm{Bethe}}(E_0)$。\n\n数值要求：\n- 在积分区间 $E \\in [E_{\\mathrm{patch}}, E_0]$ 上实现一个鲁棒的数值求积方法，使用足够精细的划分来控制在目标能量范围内的离散化误差。\n- 仅使用上述常数和关系式作为物理模型基础。不允许使用外部数据文件或网络访问。\n\n单位和格式要求：\n- 将最终的投影射程转换为毫米，并以 $\\mathrm{mm}$ 为单位表示，每个值四舍五入到三位有效数字。\n- 本任务中不使用角度。\n- 百分比（如有）必须表示为小数。\n\n测试套件和基于 SRIM 的期望值：\n- 针对以下入射质子能量（单位 $\\mathrm{MeV}$）评估您的算法：$E_0 \\in \\{1.0,\\;3.0,\\;10.0,\\;20.0\\}$。\n- 作为比较，请使用以下受 SRIM 启发的、针对相同能量下质子在铝中的 CSDA 面射程期望值（单位 $\\mathrm{g/cm^2}$），这些值反映了该能量区的半经验趋势：\n$$\nR_m^{\\mathrm{SRIM}}(1.0) = 6.5\\times 10^{-3},\\quad\nR_m^{\\mathrm{SRIM}}(3.0) = 1.8\\times 10^{-2},\\quad\nR_m^{\\mathrm{SRIM}}(10.0) = 1.4\\times 10^{-1},\\quad\nR_m^{\\mathrm{SRIM}}(20.0) = 3.3\\times 10^{-1}.\n$$\n- 对于每个能量，如果相对偏差\n$$\n\\left| R_m(E_0) - R_m^{\\mathrm{SRIM}}(E_0) \\right| \\big/ R_m^{\\mathrm{SRIM}}(E_0)\n$$\n小于或等于 $0.35$，则计算一个布尔值，其为真 (true)，否则为假 (false)。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。第一个元素必须是四个投影射程（单位为 $\\mathrm{mm}$）的列表（按 $E_0$ 升序排列，每个值四舍五入到三位有效数字）。第二个元素必须是四个布尔值的列表（按相同的 $E_0$ 值排序），表示结果是否在指定的相对容差内与受 SRIM 启发的期望值一致。因此，最终输出必须是两个列表组成的列表的单行字符串表示形式，即类似于 `[[...],[...]]` 的形式。", "solution": "问题陈述已经过验证，并被认定为有效。它在科学上基于粒子物理学原理，特别是带电粒子与物质的相互作用。该问题是适定的，提供了一整套常数、物理定律和一个明确的计算目标。所有参数都已指定，所需的计算（包括数值积分）也已明确定义。因此，提供解是合理的。\n\n这个问题的核心是计算质子在铝靶中的投影射程。这是通过在连续慢化近似 (CSDA)下，对质子阻止本领的倒数相对于其动能进行积分来实现的。阻止本领，即单位路径长度的平均能量损失，由 Bethe 公式建模。\n\n步骤如下：\n\n1.  **物理模型设置**：我们首先定义物理系统。所有为铝提供的常数和材料参数（$Z=13$, $A=26.9815385\\,\\mathrm{g/mol}$, $\\rho=2.70\\,\\mathrm{g/cm^3}$, $I=1.66\\times 10^{-4}\\,\\mathrm{MeV}$）和质子参数（$z=1$, $m_p c^2 = 938.2720813\\,\\mathrm{MeV}$）都以一致的单位建立。基本常数 $K = 0.307075\\,\\mathrm{MeV\\,cm^2/g}$ 和 $m_e c^2 = 0.51099895\\,\\mathrm{MeV}$ 也被定义。\n\n2.  **阻止本领函数**：实现一个函数来计算给定质子动能 $E$ 下的质量阻止本领 $S_m(E)$。该函数严格遵守所提供的 Bethe 公式：\n    $$\n    S_m(E) = K \\frac{z^2 Z}{A} \\frac{1}{\\beta^2} \\left[ \\frac{1}{2}\\ln\\!\\left(\\frac{2 m_e c^2 \\beta^2 \\gamma^2\\, T_{\\max}}{I^2}\\right) - \\beta^2 \\right]\n    $$\n    在此，密度效应 $\\delta$ 取为 $0$。首先计算相对论项，即洛伦兹因子 $\\gamma = 1 + E/(m_p c^2)$ 和速度平方 $\\beta^2 = 1 - 1/\\gamma^2$。随后，使用其完整的相对论表达式计算单次碰撞中可转移给靶电子的最大动能 $T_{\\max}$：\n    $$\n    T_{\\max} = \\frac{2 m_e c^2 \\beta^2 \\gamma^2}{1 + 2\\gamma (m_e/m_p) + (m_e/m_p)^2}\n    $$\n    $Z/A$ 因子中的项 $A$ 被视为无量纲的质量数，其数值等于所提供的摩尔质量值。这种解释确保了量纲上的一致性，因为常数 $K$ 的单位是 $\\mathrm{MeV\\,cm^2/g}$。\n\n3.  **低能处理**：众所周知，Bethe 公式在低能区不准确。问题指定了一个修正方案来解决这个问题。对于低于阈值 $E_{\\mathrm{patch}} = 0.1\\,\\mathrm{MeV}$ 的能量，阻止本领由一个替代函数 $S_m^{\\mathrm{low}}(E)$ 近似。对于任何初始能量 $E_0  E_{\\mathrm{patch}}$，来自能量区间 $[0, E_{\\mathrm{patch}}]$ 对总射程的贡献由以下解析表达式给出：\n    $$\n    R_m^{\\mathrm{low}} = \\frac{2 E_{\\mathrm{patch}}}{S_m(E_{\\mathrm{patch}})}\n    $$\n    由于所有指定的初始能量都超过 $E_{\\mathrm{patch}}$，该值只需计算一次，并用于所有测试用例。\n\n4.  **数值积分**：面射程的剩余部分，即从 $E_{\\mathrm{patch}}$ 到初始能量 $E_0$ 的部分，通过对 Bethe 阻止本领函数的倒数进行数值积分来计算：\n    $$\n    R_m^{\\mathrm{Bethe}}(E_0) = \\int_{E_{\\mathrm{patch}}}^{E_0} \\frac{dE}{S_m(E)}\n    $$\n    这个定积分是使用一个鲁棒的自适应求积程序，特别是 `scipy.integrate.quad` 来计算的，它确保了在整个积分域上的准确性。\n\n5.  **总射程与比较**：对于集合 $\\{1.0, 3.0, 10.0, 20.0\\}\\,\\mathrm{MeV}$ 中的每个初始能量 $E_0$，总面射程是低能贡献和高能贡献之和：$R_m(E_0) = R_m^{\\mathrm{low}} + R_m^{\\mathrm{Bethe}}(E_0)$。然后将此面射程（单位为 $\\mathrm{g/cm^2}$）转换为以毫米为单位的线性投影射程 $R(E_0)$：\n    $$\n    R(E_0)\\,\\mathrm{[mm]} = \\frac{R_m(E_0)\\,\\mathrm{[g/cm^2]}}{\\rho\\,\\mathrm{[g/cm^3]}} \\times 10\\,\\mathrm{[mm/cm]}\n    $$\n    最终射程值格式化为三位有效数字。随后，将计算出的面射程 $R_m(E_0)$ 与提供的基于 SRIM 的半经验值 $R_m^{\\mathrm{SRIM}}(E_0)$ 进行比较。通过检查相对偏差是否在指定的 $35\\%$ 容差范围内来确定一个布尔结果：\n    $$\n    \\left| \\frac{R_m(E_0) - R_m^{\\mathrm{SRIM}}(E_0)}{R_m^{\\mathrm{SRIM}}(E_0)} \\right| \\le 0.35\n    $$\n    较大的容差承认了与更精炼的经验模型相比，所提供的 Bethe 模型中存在的内在近似。\n\n6.  **最终输出**：将计算出的射程（单位为 mm）和布尔比较结果收集到两个独立的列表中。然后根据问题要求，将这些列表格式化为单个输出字符串，表示一个包含两个列表的列表。", "answer": "```python\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Computes the proton range in aluminum using the Bethe formula and a low-energy patch,\n    and compares the results to SRIM-based expectations.\n    \"\"\"\n    # Fundamental constants and material parameters\n    K = 0.307075  # MeV cm^2/g\n    Z = 13.0  # Atomic number of Aluminum\n    A = 26.9815385  # Molar mass of Al; used as dimensionless mass number in formula\n    rho = 2.70  # Density of Aluminum in g/cm^3\n    I_MeV = 1.66e-4  # Mean excitation energy of Al in MeV\n    mec2 = 0.51099895  # Electron rest mass energy in MeV\n    mpc2 = 938.2720813  # Proton rest mass energy in MeV\n    z = 1.0  # Proton charge number\n    E_patch = 0.1  # Patching energy in MeV\n    delta = 0.0 # Density effect correction\n\n    # Test suite and SRIM expectations\n    test_energies_MeV = [1.0, 3.0, 10.0, 20.0]\n    r_srim_g_cm2 = {\n        1.0: 6.5e-3,\n        3.0: 1.8e-2,\n        10.0: 1.4e-1,\n        20.0: 3.3e-1\n    }\n\n    def s_m(E: float) -> float:\n        \"\"\"\n        Calculates the mass stopping power S_m(E) in MeV cm^2/g using the Bethe formula.\n        \"\"\"\n        if E == 0:\n            return np.inf\n        \n        gamma = 1.0 + E / mpc2\n        beta2 = 1.0 - 1.0 / (gamma**2)\n        \n        if beta2 == 0:\n            return np.inf\n\n        me_over_mp = mec2 / mpc2\n        \n        # Maximum kinetic energy transfer T_max\n        T_max_num = 2.0 * mec2 * beta2 * gamma**2\n        T_max_den = 1.0 + 2.0 * gamma * me_over_mp + me_over_mp**2\n        T_max = T_max_num / T_max_den\n\n        # Logarithm argument in the Bethe formula\n        log_arg = T_max_num * T_max / (I_MeV**2)\n        if log_arg = 0:\n              return np.inf\n              \n        # Bracketed term in the Bethe formula\n        bracket_term = 0.5 * np.log(log_arg) - beta2 - delta / 2.0\n        \n        # Full mass stopping power formula\n        stopping_power = K * (z**2 * Z / A) * (1.0 / beta2) * bracket_term\n        return stopping_power\n\n    # Calculate the fixed low-energy contribution to the range\n    s_m_at_patch = s_m(E_patch)\n    r_m_low_contribution = (2.0 * E_patch) / s_m_at_patch\n\n    # Define the integrand for the high-energy part of the range calculation\n    def integrand(E: float) -> float:\n        return 1.0 / s_m(E)\n\n    # Lists to store the results\n    ranges_mm = []\n    booleans = []\n\n    # Main calculation loop for each initial energy\n    for E0 in test_energies_MeV:\n        # Numerically integrate to find the high-energy part of the areal range\n        r_m_bethe, _ = integrate.quad(integrand, E_patch, E0)\n\n        # Total areal range (g/cm^2)\n        r_m_total = r_m_low_contribution + r_m_bethe\n\n        # Convert to projected linear range (cm), then to mm\n        r_cm = r_m_total / rho\n        r_mm = r_cm * 10.0\n        \n        # Format to three significant figures and store\n        ranges_mm.append(f\"{r_mm:.3g}\")\n\n        # Compare with SRIM-based expectation\n        r_m_srim = r_srim_g_cm2[E0]\n        relative_deviation = abs(r_m_total - r_m_srim) / r_m_srim\n        agrees = relative_deviation = 0.35\n        booleans.append(agrees)\n\n    # Format the final output string as per requirements\n    ranges_str = \",\".join(ranges_mm)\n    booleans_str = \",\".join(str(b).lower() for b in booleans)\n    print(f\"[[{ranges_str}],[{booleans_str}]]\")\n\nsolve()\n```", "id": "2948349"}, {"introduction": "在核反应实验中，反应截面这一关键物理量无法直接测量，而是必须通过分析宏观可观测量（如束流强度和产物生成率）来推断。本练习将指导你如何从一组典型的实验数据中计算微观反应截面，并进行严格的误差分析。通过应用标准误差传播方法，你将学会量化测量不确定度如何影响最终结果的精度，这是实验科学家必备的一项基本功。[@problem_id:2948326]", "problem": "一个稳定的自支撑薄靶被回旋加速器产生的单能质子束辐照以引发核嬗变。在薄靶极限下并忽略束流衰减，每个入射射弹的反应概率等于靶的面数密度与微观反应截面之积。加速器电流由法拉第杯测量。一个稳态在线伽马能谱仪显示反应产物的形成速率是恒定的。\n\n已知：\n- 测得的产物形成速率（假设其不确定度与其他来源相比可忽略不计）：$R = 1.20 \\times 10^{5}\\ \\text{s}^{-1}$。\n- 束流电流（标准不确定度主要来自校准）：$I = 0.800\\ \\mu\\text{A}$，其标准相对不确定度为 $2.0 \\times 10^{-2}$。\n- 靶的面数密度（通过卢瑟福背散射谱法（Rutherford Backscattering Spectrometry, RBS）测量）：$n_{t} = 5.00 \\times 10^{17}\\ \\text{atoms}\\ \\text{cm}^{-2}$，其标准相对不确定度为 $4.0 \\times 10^{-2}$。\n- 射弹电荷量：$q = e = 1.602\\,176\\,634 \\times 10^{-19}\\ \\text{C}$。\n- 定义：$1\\ \\text{barn} = 10^{-24}\\ \\text{cm}^{2}$ 且 $1\\ \\text{millibarn} = 10^{-3}\\ \\text{barn}$。\n\n假设：\n- 薄靶近似适用，且束流在靶中的衰减可忽略不计。\n- $I$ 和 $n_{t}$ 是唯一不可忽略的不确定度来源。\n- $I$ 和 $n_{t}$ 的不确定度不相关，且足够小，可以使用一阶（线性）不确定度传播。\n\n任务：\n从关联反应速率、束流电流、射弹电荷和面数密度的基本定义出发，推导所推断的微观截面 $\\sigma$ 及其由 $I$ 和 $n_{t}$ 引起的标准不确定度的表达式，使用标准的一阶误差传播方法。然后计算 $\\sigma$ 的标准不确定度的数值，并以毫靶（millibarns）为单位表示。将最终结果四舍五入至三位有效数字，并按要求以毫靶（millibarns）为单位报告（不要在最终的方框答案中包含单位）。", "solution": "在尝试求解之前，对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 产物形成速率：$R = 1.20 \\times 10^{5}\\ \\text{s}^{-1}$。\n- 束流电流：$I = 0.800\\ \\mu\\text{A}$。\n- 电流的标准相对不确定度：$\\frac{u(I)}{I} = 2.0 \\times 10^{-2}$。\n- 靶的面数密度：$n_{t} = 5.00 \\times 10^{17}\\ \\text{atoms}\\ \\text{cm}^{-2}$。\n- 面密度的标准相对不确定度：$\\frac{u(n_{t})}{n_{t}} = 4.0 \\times 10^{-2}$。\n- 射弹电荷量（基本电荷）：$q = e = 1.602\\,176\\,634 \\times 10^{-19}\\ \\text{C}$。\n- 定义：$1\\ \\text{barn} = 10^{-24}\\ \\text{cm}^{2}$， $1\\ \\text{millibarn} = 10^{-3}\\ \\text{barn}$。\n- 假设：薄靶近似；可忽略的束流衰减；只有 $I$ 和 $n_{t}$ 的不确定度不可忽略；不确定度不相关且很小，允许一阶传播。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，描述了一个标准的核反应实验。反应速率、通量、靶密度和截面之间的关系是核物理的基础。参数和实验装置（回旋加速器、法拉第杯、RBS、伽马能谱仪）是符合实际的。该问题提法明确，提供了所有必要的信息和清晰的假设，以推导出截面及其不确定度的唯一解。语言是客观和定量的。因此，该问题被认为是有效的。\n\n**步骤3：结论与行动**\n问题有效。将提供解答。\n\n**推导与计算**\n在薄靶极限下，核反应速率 $R$ 由入射射弹通量 $\\Phi_{p}$、单位面积的靶核数量 $n_{t}$ 和微观反应截面 $\\sigma$ 的乘积给出。\n$$R = \\Phi_{p} n_{t} \\sigma$$\n射弹通量 $\\Phi_{p}$ 是单位时间内入射到靶上的射弹数量。这与束流电流 $I$（单位时间内的总电荷）和单个射弹的电荷 $q$ 有关。\n$$\\Phi_{p} = \\frac{I}{q}$$\n将通量的表达式代入速率方程得：\n$$R = \\left(\\frac{I}{q}\\right) n_{t} \\sigma$$\n根据这个基本关系，我们求解微观截面 $\\sigma$：\n$$\\sigma = \\frac{R q}{I n_{t}}$$\n为了确定 $\\sigma$ 的标准不确定度，记为 $u(\\sigma)$，我们使用不相关不确定度的一阶传播公式。对于函数 $\\sigma(I, n_{t})$，其不确定度的平方由下式给出：\n$$u^{2}(\\sigma) \\approx \\left(\\frac{\\partial \\sigma}{\\partial I}\\right)^{2} u^{2}(I) + \\left(\\frac{\\partial \\sigma}{\\partial n_{t}}\\right)^{2} u^{2}(n_{t})$$\n所需的偏导数是：\n$$\\frac{\\partial \\sigma}{\\partial I} = \\frac{\\partial}{\\partial I} \\left(\\frac{R q}{I n_{t}}\\right) = -\\frac{R q}{I^{2} n_{t}} = -\\frac{1}{I} \\left(\\frac{R q}{I n_{t}}\\right) = -\\frac{\\sigma}{I}$$\n$$\\frac{\\partial \\sigma}{\\partial n_{t}} = \\frac{\\partial}{\\partial n_{t}} \\left(\\frac{R q}{I n_{t}}\\right) = -\\frac{R q}{I n_{t}^{2}} = -\\frac{1}{n_{t}} \\left(\\frac{R q}{I n_{t}}\\right) = -\\frac{\\sigma}{n_{t}}$$\n将这些代入不确定度传播公式得出：\n$$u^{2}(\\sigma) \\approx \\left(-\\frac{\\sigma}{I}\\right)^{2} u^{2}(I) + \\left(-\\frac{\\sigma}{n_{t}}\\right)^{2} u^{2}(n_{t}) = \\sigma^{2} \\left(\\frac{u(I)}{I}\\right)^{2} + \\sigma^{2} \\left(\\frac{u(n_{t})}{n_{t}}\\right)^{2}$$\n两边除以 $\\sigma^{2}$ 得到相对不确定度平方的表达式：\n$$\\left(\\frac{u(\\sigma)}{\\sigma}\\right)^{2} \\approx \\left(\\frac{u(I)}{I}\\right)^{2} + \\left(\\frac{u(n_{t})}{n_{t}}\\right)^{2}$$\n任务是求绝对标准不确定度 $u(\\sigma)$。首先，我们使用所提供的数据计算 $\\sigma$ 的值。\n电流为 $I = 0.800\\ \\mu\\text{A} = 0.800 \\times 10^{-6}\\ \\text{A} = 0.800 \\times 10^{-6}\\ \\text{C}\\ \\text{s}^{-1}$。\n$$\n\\sigma = \\frac{(1.20 \\times 10^{5}\\ \\text{s}^{-1})(1.602\\,176\\,634 \\times 10^{-19}\\ \\text{C})}{(0.800 \\times 10^{-6}\\ \\text{C}\\ \\text{s}^{-1})(5.00 \\times 10^{17}\\ \\text{atoms}\\ \\text{cm}^{-2})}\n$$\n$$\n\\sigma = \\frac{1.92261196 \\times 10^{-14}}{4.00 \\times 10^{11}}\\ \\text{cm}^{2} = 0.480653 \\times 10^{-25}\\ \\text{cm}^{2} = 4.80653 \\times 10^{-26}\\ \\text{cm}^{2}\n$$\n现在，我们使用给定的值计算相对不确定度的平方：\n$$\\left(\\frac{u(\\sigma)}{\\sigma}\\right)^{2} = (2.0 \\times 10^{-2})^{2} + (4.0 \\times 10^{-2})^{2} = 4.0 \\times 10^{-4} + 16.0 \\times 10^{-4} = 20.0 \\times 10^{-4} = 2.0 \\times 10^{-3}$$\n那么，绝对不确定度 $u(\\sigma)$ 是：\n$$u(\\sigma) = \\sigma \\sqrt{2.0 \\times 10^{-3}} = (4.80653 \\times 10^{-26}\\ \\text{cm}^{2}) \\sqrt{2.0 \\times 10^{-3}}$$\n$$u(\\sigma) \\approx (4.80653 \\times 10^{-26}\\ \\text{cm}^{2}) (0.04472136) \\approx 2.1498 \\times 10^{-27}\\ \\text{cm}^{2}$$\n问题要求答案以毫靶（$\\text{mb}$）为单位。我们使用给定的换算关系：\n$$1\\ \\text{millibarn} = 10^{-3}\\ \\text{barn} = 10^{-3} \\times (10^{-24}\\ \\text{cm}^{2}) = 10^{-27}\\ \\text{cm}^{2}$$\n因此，换算因子是 $1\\ \\text{mb} = 10^{-27}\\ \\text{cm}^{2}$。\n$$u(\\sigma) = \\frac{2.1498 \\times 10^{-27}\\ \\text{cm}^{2}}{10^{-27}\\ \\text{cm}^{2}/\\text{mb}} \\approx 2.1498\\ \\text{mb}$$\n将结果四舍五入到三位有效数字，我们得到：\n$$u(\\sigma) = 2.15\\ \\text{mb}$$\n这就是所计算截面的标准不确定度。", "answer": "$$\\boxed{2.15}$$", "id": "2948326"}, {"introduction": "在实际的同位素生产或材料活化分析中，简单的“薄靶”假设往往不成立，必须考虑更为复杂的物理过程。本练习综合了前面所学的知识，要求你建立一个包含束流自屏蔽和靶核燃耗效应的厚靶活化模型。通过量化这些效应对推导截面值造成的系统偏差，你将深刻理解理论模型与复杂实验现实之间的差距，并学会如何通过精细建模来修正和解释这些偏差。[@problem_id:2948320]", "problem": "一束恒定注量率的单能准直带电粒子束入射到面积为 A、厚度为 L 的平行平面靶上。该粒子束与靶核相互作用，通过单一活化道产生放射性产物，并且粒子束在穿过大块基体时因非产物性相互作用而衰减（自屏蔽）。您将推导并实现一个考虑了深度相关的自屏蔽和时间相关的靶核燃耗（损耗）的厚靶活化模型，然后用它来量化忽略这些效应会给通过简单薄靶分析推导出的微观截面带来多大的偏差。\n\n您的推导仅需基于以下基本定律和核心定义：\n- 比尔-朗伯衰减定律：对于平板中的单能粒子束，如果宏观衰减系数记为 $\\Sigma_{\\mathrm{m}}$（单位 $\\mathrm{cm}^{-1}$），则深度相关的注量率为 $\\phi(x) = \\phi_{0}\\,e^{-\\Sigma_{\\mathrm{m}} x}$，其中深度 $x \\in [0,L]$。\n- 嬗变和放射性衰变的一级反应动力学：在深度 $x$ 和时间 $t$，靶核数密度为 $N_{\\mathrm{T}}(x,t)$（单位 $\\mathrm{cm}^{-3}$），微观活化截面为 $\\sigma_{\\mathrm{a}}$（单位 $\\mathrm{cm}^{2}$），衰变常数为 $\\lambda$（单位 $\\mathrm{s}^{-1}$），则局部反应率密度为 $R(x,t) = \\phi(x)\\,\\sigma_{\\mathrm{a}}\\,N_{\\mathrm{T}}(x,t)$。耦合常微分方程（ODE）为 $dN_{\\mathrm{T}}/dt = -R(x,t)$ 和 $dN_{\\mathrm{P}}/dt = R(x,t) - \\lambda N_{\\mathrm{P}}(x,t)$，其中 $N_{\\mathrm{P}}(x,t)$ 是产物数密度（单位 $\\mathrm{cm}^{-3}$）。\n- 等待和计数期间的放射性衰变：如果在辐照时间 $T_{\\mathrm{irr}}$ 结束时产物原子数为 $N_{\\mathrm{P}}(x,T_{\\mathrm{irr}})$，则在等待时间 $t_{\\mathrm{w}}$ 之后开始的持续时间为 $\\Delta t_{\\mathrm{c}}$ 的计数区间内记录的总计数为 $C = f_{\\mathrm{det}} \\int_{t_{\\mathrm{w}}}^{t_{\\mathrm{w}}+\\Delta t_{\\mathrm{c}}} \\lambda \\left[\\int_{V} N_{\\mathrm{P}}(x,T_{\\mathrm{irr}})\\,dV\\right] e^{-\\lambda (t - T_{\\mathrm{irr}})} dt$，其中 $f_{\\mathrm{det}}$ 是全能峰探测效率和发射概率的乘积（无量纲），$V$ 是靶体积。\n\n任务：\n- 基于以上基础，推导出足以计算面积为 $A$（单位 $\\mathrm{cm}^{2}$）、厚度为 $L$（单位 $\\mathrm{cm}$）的有限厚度平板靶的测量计数 $C$ 的表达式，其中允许 $N_{\\mathrm{T}}$ 因燃耗而损耗，并允许 $\\phi(x)$ 因自屏蔽（通过 $\\Sigma_{\\mathrm{m}}$）而衰减。您可以假设 $\\Sigma_{\\mathrm{m}}$ 与 $t$ 无关且不受燃耗影响，并且 $\\sigma_{\\mathrm{a}}$ 与 $x$ 和 $t$ 无关。\n- 考虑一种忽略燃耗和自屏蔽的简单薄靶分析。在该分析中，假设整个靶中的注量率均匀为 $\\phi_{0}$，$N_{\\mathrm{T}}$ 没有损耗，并且在辐照期间产物的累积遵循教科书中的恒定产生和衰变模型。在这些假设下，薄靶模型预测测得的计数 $C$ 对应于一个推导出的截面 $\\sigma_{\\mathrm{ded}}$，该截面可通过对薄靶活化累积和衰变表达式进行代数反演得到。\n- 将忽略自屏蔽和燃耗所产生的偏差定义为无量纲比率 $r = \\sigma_{\\mathrm{ded}} / \\sigma_{\\mathrm{true}}$，其中 $\\sigma_{\\mathrm{true}}$ 是自然界在辐照中使用的实际微观截面（即出现在反应率中的那个）。您的程序必须计算下面每个测试用例的 $r$ 值。\n\n实现要求：\n- 实现对 $x \\in [0,L]$ 的深度积分，以获得辐照结束时的总产物原子数 $N_{\\mathrm{P,tot}}(T_{\\mathrm{irr}}) = \\int_{V} N_{\\mathrm{P}}(x,T_{\\mathrm{irr}})\\,dV = A \\int_{0}^{L} N_{\\mathrm{P}}(x,T_{\\mathrm{irr}})\\,dx$。您可以用数值方法进行此积分。\n- 使用常微分方程以及等待和计数期间指数衰变所蕴含的精确时间依赖关系。不要对 $t$ 或 $x$ 进行线性化。\n- 单位和常数：\n  - 一致地使用 $\\mathrm{cm}$、$\\mathrm{s}$ 和 $\\mathrm{barn}$。一靶等于 $10^{-24}\\,\\mathrm{cm}^{2}$。在输入参数中，所有截面均以靶为单位表示，但在计算时应内部转换为 $\\mathrm{cm}^{2}$。\n  - 注量率 $\\phi_{0}$ 的单位必须是 $\\mathrm{cm}^{-2}\\,\\mathrm{s}^{-1}$，数密度的单位是 $\\mathrm{cm}^{-3}$，面积的单位是 $\\mathrm{cm}^{2}$，长度的单位是 $\\mathrm{cm}$，时间的单位是 $\\mathrm{s}$。\n  - 如果提供了半衰期 $T_{1/2}$，则通过 $\\lambda = \\ln(2) / T_{1/2}$ 将其转换为衰变常数。\n- 输出规范：\n  - 对于每个测试用例，将比率 $r$ 输出为浮点数（无单位）。\n  - 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的结果按顺序对应下面的测试用例，例如 $\\big[$$r_{1}$$,$ $r_{2}$$,$ $r_{3}$$\\big]$。\n\n测试套件：\n对于所有用例，取探测因子 $f_{\\mathrm{det}} = $ $0.12$（无量纲），等待时间 $t_{\\mathrm{w}} = $ $1800\\,\\mathrm{s}$，计数时间 $\\Delta t_{\\mathrm{c}} = $ $1200\\,\\mathrm{s}$，靶面积 $A = $ $1.0\\,\\mathrm{cm}^{2}$，初始靶核数密度 $N_{\\mathrm{T0}} = $ $5.0 \\times 10^{22}\\,\\mathrm{cm}^{-3}$。\n\n- 用例 A（理想情况；自屏蔽和燃耗可忽略不计）：\n  - 粒子束注量率 $\\phi_{0} = $ $1.0 \\times 10^{12}\\,\\mathrm{cm}^{-2}\\,\\mathrm{s}^{-1}$,\n  - 微观截面 $\\sigma_{\\mathrm{a}} = $ $0.20\\,\\mathrm{barn}$,\n  - 宏观基体衰减 $\\Sigma_{\\mathrm{m}} = $ $0.020\\,\\mathrm{cm}^{-1}$,\n  - 靶厚度 $L = $ $0.020\\,\\mathrm{cm}$,\n  - 辐照时间 $T_{\\mathrm{irr}} = $ $3600\\,\\mathrm{s}$,\n  - 产物半衰期 $T_{1/2} = $ $6.0\\,\\mathrm{h}$.\n\n- 用例 B（较强自屏蔽；燃耗可忽略不计）：\n  - 粒子束注量率 $\\phi_{0} = $ $1.0 \\times 10^{12}\\,\\mathrm{cm}^{-2}\\,\\mathrm{s}^{-1}$,\n  - 微观截面 $\\sigma_{\\mathrm{a}} = $ $0.20\\,\\mathrm{barn}$,\n  - 宏观基体衰减 $\\Sigma_{\\mathrm{m}} = $ $2.00\\,\\mathrm{cm}^{-1}$,\n  - 靶厚度 $L = $ $0.50\\,\\mathrm{cm}$,\n  - 辐照时间 $T_{\\mathrm{irr}} = $ $3600\\,\\mathrm{s}$,\n  - 产物半衰期 $T_{1/2} = $ $6.0\\,\\mathrm{h}$.\n\n- 用例 C（中等自屏蔽；相对于衰变有显著燃耗）：\n  - 粒子束注量率 $\\phi_{0} = $ $5.0 \\times 10^{14}\\,\\mathrm{cm}^{-2}\\,\\mathrm{s}^{-1}$,\n  - 微观截面 $\\sigma_{\\mathrm{a}} = $ $800\\,\\mathrm{barn}$,\n  - 宏观基体衰减 $\\Sigma_{\\mathrm{m}} = $ $0.10\\,\\mathrm{cm}^{-1}$,\n  - 靶厚度 $L = $ $0.10\\,\\mathrm{cm}$,\n  - 辐照时间 $T_{\\mathrm{irr}} = $ $1.0 \\times 10^{6}\\,\\mathrm{s}$,\n  - 产物半衰期 $T_{1/2} = $ $30.0\\,\\mathrm{d}$.\n\n答案格式和单位：\n- 要求的最终输出是格式为 $\\big[$$r_{\\mathrm{A}}$$,$ $r_{\\mathrm{B}}$$,$ $r_{\\mathrm{C}}$$\\big]$ 的单行，其中每个 $r$ 是推导截面与真实微观截面之比（无单位）。每个 $r$ 必须以小数形式打印（而不是分数或百分比）。\n\n科学真实性约束：\n- 假设入射粒子是单能的，并且 $\\sigma_{\\mathrm{a}}$ 在整个平板中与能量无关。\n- 假设没有反向散射回粒子束，没有次级产物生成道，并且除了一维深度依赖性外，没有其他靶几何效应。\n- 确保数值积分的精度足以分辨衰减或燃耗效应很强的情况。", "solution": "该问题要求推导并实现一个用于厚靶活化的模型，该模型同时考虑了粒子束衰减（自屏蔽）和靶核损耗（燃耗）。目标是量化一个忽略了这些效应的简单薄靶分析所引入的偏差。偏差定义为推导截面 $\\sigma_{\\mathrm{ded}}$ 与真实截面 $\\sigma_{\\mathrm{true}}$（在问题陈述中记为 $\\sigma_{\\mathrm{a}}$）之比。\n\n首先，对问题陈述进行验证。\n\n**第1步：提取给定条件**\n\n- **基本定律与定义：**\n  - 比尔-朗伯定律：深度 $x$ 处的注量率为 $\\phi(x) = \\phi_{0}\\,e^{-\\Sigma_{\\mathrm{m}} x}$，其中 $x \\in [0,L]$，宏观衰减系数为 $\\Sigma_{\\mathrm{m}}$ ($\\mathrm{cm}^{-1}$)。\n  - 一级动力学：\n    - 局部反应率密度：$R(x,t) = \\phi(x)\\,\\sigma_{\\mathrm{a}}\\,N_{\\mathrm{T}}(x,t)$。\n    - 靶核损耗常微分方程：$dN_{\\mathrm{T}}/dt = -R(x,t)$。\n    - 产物生成常微分方程：$dN_{\\mathrm{P}}/dt = R(x,t) - \\lambda N_{\\mathrm{P}}(x,t)$。\n    - 变量：靶核数密度 $N_{\\mathrm{T}}(x,t)$ ($\\mathrm{cm}^{-3}$)，产物数密度 $N_{\\mathrm{P}}(x,t)$ ($\\mathrm{cm}^{-3}$)，微观活化截面 $\\sigma_{\\mathrm{a}}$ ($\\mathrm{cm}^{2}$)，衰变常数 $\\lambda$ ($\\mathrm{s}^{-1}$)。\n  - 放射性衰变与计数：净计数 $C = f_{\\mathrm{det}} \\int_{t_{\\mathrm{w}}}^{t_{\\mathrm{w}}+\\Delta t_{\\mathrm{c}}} \\lambda \\left[\\int_{V} N_{\\mathrm{P}}(x,T_{\\mathrm{irr}})\\,dV\\right] e^{-\\lambda (t - T_{\\mathrm{irr}})} dt$。\n    - 常数：探测因子 $f_{\\mathrm{det}}$，辐照时间 $T_{\\mathrm{irr}}$，等待时间 $t_{\\mathrm{w}}$，计数时间 $\\Delta t_{\\mathrm{c}}$，靶体积 $V$。\n- **假设：**\n  - $\\Sigma_{\\mathrm{m}}$ 与时间无关且不受燃耗影响。\n  - $\\sigma_{\\mathrm{a}}$ 与深度 $x$ 和时间 $t$ 无关。\n- **任务：**\n  - 推导计算面积为 $A$、厚度为 $L$ 的平板靶的测量计数 $C$ 的表达式。\n  - 定义偏差 $r = \\sigma_{\\mathrm{ded}} / \\sigma_{\\mathrm{true}}$。$\\sigma_{\\mathrm{ded}}$ 来自对简单薄靶模型的反演。\n  - 实现深度依赖的数值积分。\n- **常数与单位：**\n  - $1\\,\\mathrm{barn} = 10^{-24}\\,\\mathrm{cm}^{2}$。\n  - $\\lambda = \\ln(2) / T_{1/2}$。\n- **测试套件共享参数：**\n  - $f_{\\mathrm{det}} = 0.12$\n  - $t_{\\mathrm{w}} = 1800\\,\\mathrm{s}$\n  - $\\Delta t_{\\mathrm{c}} = 1200\\,\\mathrm{s}$\n  - $A = 1.0\\,\\mathrm{cm}^{2}$\n  - 初始靶核数密度 $N_{\\mathrm{T0}} = 5.0 \\times 10^{22}\\,\\mathrm{cm}^{-3}$\n- **测试用例：** 为用例A、B和C给定了 $\\phi_{0}$, $\\sigma_{\\mathrm{a}}$, $\\Sigma_{\\mathrm{m}}$, $L$, $T_{\\mathrm{irr}}$ 和 $T_{1/2}$ 的具体值。\n\n**第2步：使用提取的给定条件进行验证**\n\n根据指定标准对问题进行评估：\n- **科学依据充分：** 问题基于核反应动力学（一级速率方程）和粒子输运（比尔-朗伯定律）的基本原理。这些是物理学中标准且成熟的模型。诸如单能束和能量无关截面等假设是常见且可接受的简化，以便建立一个易于处理的模型。\n- **良态的：** 问题定义清晰。它提供了所有必要的控制方程、初始条件（$N_{\\mathrm{T}}(x,0) = N_{\\mathrm{T0}}$, $N_{\\mathrm{P}}(x,0) = 0$）和参数来计算“真实”结果。它还精确定义了“简单”模型以及计算推导截面和最终偏差比的方法。对于每组参数，比率 $r$ 都存在唯一解。\n- **客观的：** 问题以精确、客观和定量的术语陈述。没有主观或模糊的语言。\n\n该问题没有表现出任何列出的缺陷（科学上不合理、非形式化、设置不完整、条件不切实际等）。所提供的参数在核活化实验的物理合理范围内。\n\n**第3步：结论与行动**\n\n该问题是**有效的**。将提供一个完整的、论证充分的解答。\n\n**模型推导**\n\n推导过程主要分为三个部分：完整的“真实”模型、简化的“简单”模型和偏差比的计算。\n\n**1. 包含自屏蔽和燃耗的‘真实’模型**\n\n我们首先求解固定深度 $x$ 处的耦合微分方程。注量率为 $\\phi(x) = \\phi_0 e^{-\\Sigma_{\\mathrm{m}} x}$。\n\n首先，我们求解靶核数密度 $N_{\\mathrm{T}}(x,t)$：\n$$\n\\frac{dN_{\\mathrm{T}}}{dt} = -R(x,t) = -\\phi(x) \\sigma_{\\mathrm{a}} N_{\\mathrm{T}}(x,t) = -(\\phi_0 \\sigma_{\\mathrm{a}} e^{-\\Sigma_{\\mathrm{m}} x}) N_{\\mathrm{T}}(x,t)\n$$\n这是一个一阶可分离常微分方程。我们定义一个深度相关的燃耗率常数 $\\Lambda_{\\mathrm{b}}(x) = \\phi_0 \\sigma_{\\mathrm{a}} e^{-\\Sigma_{\\mathrm{m}} x}$。方程变为 $dN_{\\mathrm{T}}/dt = -\\Lambda_{\\mathrm{b}}(x) N_{\\mathrm{T}}$。在初始条件 $N_{\\mathrm{T}}(x,0) = N_{\\mathrm{T0}}$下，解为：\n$$\nN_{\\mathrm{T}}(x,t) = N_{\\mathrm{T0}} e^{-\\Lambda_{\\mathrm{b}}(x) t} = N_{\\mathrm{T0}} \\exp\\left(-\\phi_0 \\sigma_{\\mathrm{a}} e^{-\\Sigma_{\\mathrm{m}} x} t\\right)\n$$\n接下来，我们求解产物数密度 $N_{\\mathrm{P}}(x,t)$。其控制方程为：\n$$\n\\frac{dN_{\\mathrm{P}}}{dt} + \\lambda N_{\\mathrm{P}}(x,t) = R(x,t) = \\phi(x) \\sigma_{\\mathrm{a}} N_{\\mathrm{T}}(x,t) = \\Lambda_{\\mathrm{b}}(x) N_{\\mathrm{T0}} e^{-\\Lambda_{\\mathrm{b}}(x) t}\n$$\n这是一个一阶线性常微分方程。我们使用积分因子 $e^{\\lambda t}$，并根据初始条件 $N_{\\mathrm{P}}(x,0) = 0$ 来求解。\n$$\n\\frac{d}{dt}\\left(N_{\\mathrm{P}}(x,t) e^{\\lambda t}\\right) = \\Lambda_{\\mathrm{b}}(x) N_{\\mathrm{T0}} e^{-\\Lambda_{\\mathrm{b}}(x) t} e^{\\lambda t} = \\Lambda_{\\mathrm{b}}(x) N_{\\mathrm{T0}} e^{(\\lambda - \\Lambda_{\\mathrm{b}}(x)) t}\n$$\n从 $0$ 到 $t$ 积分，我们得到：\n$$\nN_{\\mathrm{P}}(x,t) e^{\\lambda t} = \\Lambda_{\\mathrm{b}}(x) N_{\\mathrm{T0}} \\int_0^t e^{(\\lambda - \\Lambda_{\\mathrm{b}}(x)) \\tau} d\\tau\n$$\n对于 $\\lambda \\neq \\Lambda_{\\mathrm{b}}(x)$ 的一般情况：\n$$\nN_{\\mathrm{P}}(x,t) = \\frac{\\Lambda_{\\mathrm{b}}(x) N_{\\mathrm{T0}}}{\\lambda - \\Lambda_{\\mathrm{b}}(x)} \\left(e^{-\\Lambda_{\\mathrm{b}}(x) t} - e^{-\\lambda t}\\right)\n$$\n在 $\\lambda = \\Lambda_{\\mathrm{b}}(x)$ 的特殊情况下，被积函数为常数，解为 $N_{\\mathrm{P}}(x,t) = \\Lambda_{\\mathrm{b}}(x) N_{\\mathrm{T0}} t e^{-\\lambda t}$。\n\n在辐照结束时，$t=T_{\\mathrm{irr}}$，局部产物密度为 $N_{\\mathrm{P}}(x, T_{\\mathrm{irr}})$。总产物原子数 $N_{\\mathrm{P,tot}}(T_{\\mathrm{irr}})$ 是通过对靶体积 $V = A \\cdot L$ 进行积分得到的：\n$$\nN_{\\mathrm{P,tot}}(T_{\\mathrm{irr}}) = \\int_V N_{\\mathrm{P}}(x, T_{\\mathrm{irr}}) dV = A \\int_0^L N_{\\mathrm{P}}(x, T_{\\mathrm{irr}}) dx\n$$\n这个涉及 $N_{\\mathrm{P}}(x, T_{\\mathrm{irr}})$ 的积分将以数值方式计算。\n\n计数 $C_{\\mathrm{true}}$ 是通过对计数周期内的衰变率进行积分得到的：\n$$\nC_{\\mathrm{true}} = f_{\\mathrm{det}} N_{\\mathrm{P,tot}}(T_{\\mathrm{irr}}) \\int_{T_{\\mathrm{irr}}+t_{\\mathrm{w}}}^{T_{\\mathrm{irr}}+t_{\\mathrm{w}}+\\Delta t_{\\mathrm{c}}} \\lambda e^{-\\lambda(t - T_{\\mathrm{irr}})} dt = f_{\\mathrm{det}} N_{\\mathrm{P,tot}}(T_{\\mathrm{irr}}) e^{-\\lambda t_{\\mathrm{w}}} (1 - e^{-\\lambda \\Delta t_{\\mathrm{c}}})\n$$\n\n**2. ‘简单’薄靶模型**\n\n该模型做了两个简化假设：无自屏蔽（$\\phi(x) = \\phi_0$）和无靶核燃耗（$N_{\\mathrm{T}}(x,t) = N_{\\mathrm{T0}}$）。整个靶的产物生成率是恒定的：$R_{\\mathrm{naive}} = \\phi_0 \\sigma_{\\mathrm{a}} N_{\\mathrm{T0}}$。\n产物生成的常微分方程变为：$dN_{\\mathrm{P}}/dt = R_{\\mathrm{naive}} - \\lambda N_{\\mathrm{P}}$。\n在时间 $T_{\\mathrm{irr}}$ 时的产物密度解为：\n$$\nN_{\\mathrm{P,naive}}(T_{\\mathrm{irr}}) = \\frac{\\phi_0 \\sigma_{\\mathrm{a}} N_{\\mathrm{T0}}}{\\lambda} (1 - e^{-\\lambda T_{\\mathrm{irr}}})\n$$\n总产物原子数为 $N_{\\mathrm{P,tot,naive}} = N_{\\mathrm{P,naive}} \\cdot V = N_{\\mathrm{P,naive}} \\cdot (A L)$。相应的计数 $C_{\\mathrm{naive}}$ 为：\n$$\nC_{\\mathrm{naive}}(\\sigma_{\\mathrm{a}}) = f_{\\mathrm{det}} \\left( \\frac{\\phi_0 \\sigma_{\\mathrm{a}} N_{\\mathrm{T0}} A L}{\\lambda} (1 - e^{-\\lambda T_{\\mathrm{irr}}}) \\right) e^{-\\lambda t_{\\mathrm{w}}} (1 - e^{-\\lambda \\Delta t_{\\mathrm{c}}})\n$$\n\n**3. 偏差比计算**\n\n为了求出推导截面 $\\sigma_{\\mathrm{ded}}$，我们将真实模型得到的测量计数 $C_{\\mathrm{true}}$ 与简单模型预测的 $C_{\\mathrm{naive}}(\\sigma_{\\mathrm{ded}})$ 相等：\n$$\nC_{\\mathrm{true}} = C_{\\mathrm{naive}}(\\sigma_{\\mathrm{ded}})\n$$\n$$\nf_{\\mathrm{det}} N_{\\mathrm{P,tot}}(T_{\\mathrm{irr}}) e^{-\\lambda t_{\\mathrm{w}}} (1 - e^{-\\lambda \\Delta t_{\\mathrm{c}}}) = f_{\\mathrm{det}} \\left( \\frac{\\phi_0 \\sigma_{\\mathrm{ded}} N_{\\mathrm{T0}} A L}{\\lambda} (1 - e^{-\\lambda T_{\\mathrm{irr}}}) \\right) e^{-\\lambda t_{\\mathrm{w}}} (1 - e^{-\\lambda \\Delta t_{\\mathrm{c}}})\n$$\n探测和衰变项相互抵消，剩下：\n$$\nN_{\\mathrm{P,tot}}(T_{\\mathrm{irr}}) = \\frac{\\phi_0 \\sigma_{\\mathrm{ded}} N_{\\mathrm{T0}} A L}{\\lambda} (1 - e^{-\\lambda T_{\\mathrm{irr}}})\n$$\n解出 $\\sigma_{\\mathrm{ded}}$：\n$$\n\\sigma_{\\mathrm{ded}} = \\frac{N_{\\mathrm{P,tot}}(T_{\\mathrm{irr}}) \\lambda}{\\phi_0 N_{\\mathrm{T0}} A L (1 - e^{-\\lambda T_{\\mathrm{irr}}})}\n$$\n代入 $N_{\\mathrm{P,tot}}(T_{\\mathrm{irr}}) = A \\int_0^L N_{\\mathrm{P}}(x, T_{\\mathrm{irr}}) dx$：\n$$\n\\sigma_{\\mathrm{ded}} = \\frac{(A \\int_0^L N_{\\mathrm{P}}(x, T_{\\mathrm{irr}}) dx) \\lambda}{\\phi_0 N_{\\mathrm{T0}} A L (1 - e^{-\\lambda T_{\\mathrm{irr}}})} = \\frac{\\lambda \\int_0^L N_{\\mathrm{P}}(x, T_{\\mathrm{irr}}) dx}{\\phi_0 N_{\\mathrm{T0}} L (1 - e^{-\\lambda T_{\\mathrm{irr}}})}\n$$\n偏差比为 $r = \\sigma_{\\mathrm{ded}} / \\sigma_{\\mathrm{true}}$，其中 $\\sigma_{\\mathrm{true}} = \\sigma_{\\mathrm{a}}$。\n$$\nr = \\frac{1}{\\sigma_{\\mathrm{a}}} \\left( \\frac{\\lambda \\int_0^L N_{\\mathrm{P}}(x, T_{\\mathrm{irr}}) dx}{\\phi_0 N_{\\mathrm{T0}} L (1 - e^{-\\lambda T_{\\mathrm{irr}}})} \\right)\n$$\n这就是需要实现的最终表达式。积分将使用数值方法进行计算，被积函数 $N_{\\mathrm{P}}(x, T_{\\mathrm{irr}})$ 是在第1部分中推导出的解。", "answer": "```python\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Solves the thick-target activation problem for three test cases.\n    \"\"\"\n\n    # --- Constants ---\n    BARN_TO_CM2 = 1e-24\n    \n    # --- Shared Parameters ---\n    # These are not needed for the ratio r calculation, as they cancel out,\n    # but are included for completeness.\n    # f_det = 0.12\n    # t_w_s = 1800.0\n    # dt_c_s = 1200.0\n    # A_cm2 = 1.0\n    N_T0_per_cm3 = 5.0e22\n\n    # --- Test Cases ---\n    test_cases = [\n        # Case A (happy path; negligible self-shielding and burnup)\n        {\n            \"phi0\": 1.0e12,           # cm^-2 s^-1\n            \"sigma_a_barn\": 0.20,     # barn\n            \"Sigma_m\": 0.020,         # cm^-1\n            \"L_cm\": 0.020,            # cm\n            \"T_irr_s\": 3600.0,        # s\n            \"T_half_s\": 6.0 * 3600.0, # s (6 hours)\n        },\n        # Case B (stronger self-shielding; negligible burnup)\n        {\n            \"phi0\": 1.0e12,           # cm^-2 s^-1\n            \"sigma_a_barn\": 0.20,     # barn\n            \"Sigma_m\": 2.00,          # cm^-1\n            \"L_cm\": 0.50,             # cm\n            \"T_irr_s\": 3600.0,        # s\n            \"T_half_s\": 6.0 * 3600.0, # s (6 hours)\n        },\n        # Case C (mild self-shielding; significant burnup relative to decay)\n        {\n            \"phi0\": 5.0e14,           # cm^-2 s^-1\n            \"sigma_a_barn\": 800.0,    # barn\n            \"Sigma_m\": 0.10,          # cm^-1\n            \"L_cm\": 0.10,             # cm\n            \"T_irr_s\": 1.0e6,         # s\n            \"T_half_s\": 30.0 * 24 * 3600.0, # s (30 days)\n        },\n    ]\n\n    def calculate_bias_ratio(params, N_T0):\n        \"\"\"\n        Calculates the bias ratio r = sigma_ded / sigma_true.\n        \"\"\"\n        # Unpack parameters\n        phi0 = params[\"phi0\"]\n        sigma_a_barn = params[\"sigma_a_barn\"]\n        Sigma_m = params[\"Sigma_m\"]\n        L_cm = params[\"L_cm\"]\n        T_irr_s = params[\"T_irr_s\"]\n        T_half_s = params[\"T_half_s\"]\n\n        # Convert units\n        sigma_a_cm2 = sigma_a_barn * BARN_TO_CM2\n        lambda_decay = np.log(2) / T_half_s\n\n        def integrand_Np(x, phi0, sigma_a, Sigma_m, T_irr, lambda_d, N_T0):\n            \"\"\"\n            Calculates N_P(x, T_irr), the product atom density at depth x.\n            This is the integrand for the spatial integration.\n            \"\"\"\n            lambda_burnup = phi0 * sigma_a * np.exp(-Sigma_m * x)\n\n            if np.isclose(lambda_burnup, lambda_d):\n                # Handle the special case where burnup rate equals decay constant\n                return lambda_d * N_T0 * T_irr * np.exp(-lambda_d * T_irr)\n            else:\n                # General case\n                term1 = lambda_burnup * N_T0 / (lambda_d - lambda_burnup)\n                term2 = np.exp(-lambda_burnup * T_irr) - np.exp(-lambda_d * T_irr)\n                return term1 * term2\n\n        # Perform numerical integration to get Integral[N_P(x, T_irr) dx] from 0 to L\n        integral_val, _ = integrate.quad(\n            integrand_Np,\n            0,\n            L_cm,\n            args=(phi0, sigma_a_cm2, Sigma_m, T_irr_s, lambda_decay, N_T0)\n        )\n\n        # Calculate the deduced cross section using the naive model's inverted formula\n        # sigma_ded = (lambda * Integral[N_p dx]) / (phi0 * N_T0 * L * (1 - exp[-lambda*T_irr]))\n        \n        # Use np.expm1 for better numerical precision if lambda*T_irr is small\n        # 1 - exp(-x) = -expm1(-x)\n        denominator_naive = phi0 * N_T0 * L_cm * (-np.expm1(-lambda_decay * T_irr_s))\n        \n        # Avoid division by zero if denominator is zero (e.g., if T_irr is zero)\n        if denominator_naive == 0:\n            # In the limit T_irr -> 0, the denominator grows as T_irr, and the\n            # numerator also grows as T_irr, leading to a finite limit.\n            # Simplified: Np(x,T) ~ lambda_b(x)*N_T0*T, integral ~ T, denom ~ T.\n            # The ratio r approaches a value related to self-shielding only.\n            # The limit of the naive term (1-exp(-lambda*T_irr)) / lambda is T_irr.\n            sigma_ded_cm2_num = integral_val\n            sigma_ded_cm2_den = phi0 * N_T0 * L_cm * T_irr_s\n            if sigma_ded_cm2_den == 0:\n                return 1.0 # Trivial case T_irr=0 means no production, r=1\n            sigma_ded_cm2 = sigma_ded_cm2_num / sigma_ded_cm2_den\n        else:\n            sigma_ded_cm2 = (integral_val * lambda_decay) / denominator_naive\n\n        # Calculate the bias ratio\n        r = sigma_ded_cm2 / sigma_a_cm2\n        return r\n\n    results = []\n    for case in test_cases:\n        r = calculate_bias_ratio(case, N_T0_per_cm3)\n        results.append(r)\n\n    # Format the output as specified\n    print(f\"[{','.join(f'{res:.8f}' for res in results)}]\")\n\nsolve()\n\n```", "id": "2948320"}]}