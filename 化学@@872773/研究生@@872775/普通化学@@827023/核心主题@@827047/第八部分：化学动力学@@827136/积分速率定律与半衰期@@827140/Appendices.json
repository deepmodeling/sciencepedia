{"hands_on_practices": [{"introduction": "零级反应是反应速率与反应物浓度无关的特殊情况。尽管不如一级或二级反应常见，但它们在某些场景下至关重要，例如在催化剂表面饱和的反应或某些酶促反应中。本练习将引导你从基本定义出发，推导零级反应的积分速率方程，并将其应用于一个实际问题，包括分析实验参数的不确定性如何影响预测结果 [@problem_id:2942199]。", "problem": "在恒容、密闭、充分混合的恒温反应器中，进行物种 $A$ 分解为产物的单反应物分解反应。基本可观测量是 $A$ 的浓度，记为 $[A](t)$，其初始值为 $[A]_0$。对于特定的催化剂和操作条件，实验报告的速率常数为 $k=1.5\\times 10^{-5}\\,\\mathrm{M\\,s^{-1}}$，其单位表明为零级动力学，初始浓度为 $[A]_0=0.020\\,\\mathrm{M}$。\n\n仅从零级过程的反应速率定义出发，推导 $[A](t)$ 和 $t$ 之间的积分关系式。利用此关系式，得到一个通用表达式，用于计算 $[A](t)$ 达到其初始值的某个固定分数 $f$（其中 $0  f  1$）所需的时间 $t_f$。然后，利用给定的参数值，计算反应物浓度降至其初始值的25%（即 $f=0.25$）所需的时间。最后，评估如果速率常数 $k$ 具有 $\\pm 0.10$ 的相对不确定性，达到此目标是否可行，可行性定义为目标是否在反应物完全耗尽之前达到。", "solution": "该问题陈述已被验证，并被认为是自洽的、科学上基于化学动力学原理且良定的。所有提供的参数在物理上都是现实的，并且定义明确。该问题是有效的，并将给出一个严谨的解法。\n\n该反应是反应物 $A$ 的零级分解。反应速率，即 $A$ 浓度变化速率的负值，与 $A$ 的浓度无关。因此，微分速率方程由下式给出：\n$$\n-\\frac{d[A]}{dt} = k[A]^0 = k\n$$\n其中 $[A]$ 是物种 $A$ 在时间 $t$ 的浓度，而 $k$ 是零级速率常数。\n\n为了找到关联浓度与时间的积分速率定律，我们必须对该微分方程进行积分。我们重新排列方程以分离变量：\n$$\nd[A] = -k \\, dt\n$$\n我们对两边从初始状态（在 $t=0$时，浓度为 $[A]_0$）积分到一个任意时间 $t$ 的状态（此时浓度为 $[A](t)$）：\n$$\n\\int_{[A]_0}^{[A](t)} d[A] = \\int_0^t -k \\, dt\n$$\n由于在恒温条件下 $k$ 是一个常数，积分得到：\n$$\n[A](t) - [A]_0 = -k(t - 0)\n$$\n这就得到了零级反应的积分速率定律：\n$$\n[A](t) = [A]_0 - kt\n$$\n\n接下来，题目要求我们找到一个通用表达式，用于计算 $A$ 的浓度达到其初始值 $[A]_0$ 的某个固定分数 $f$ 所需的时间 $t_f$。在时间 $t_f$ 时，浓度为 $[A](t_f) = f[A]_0$，其中 $0  f  1$。我们将此条件代入积分速率定律：\n$$\nf[A]_0 = [A]_0 - kt_f\n$$\n我们现在求解 $t_f$：\n$$\nkt_f = [A]_0 - f[A]_0\n$$\n$$\nkt_f = [A]_0 (1 - f)\n$$\n因此，$t_f$ 的通用表达式为：\n$$\nt_f = \\frac{[A]_0 (1 - f)}{k}\n$$\n\n现在我们必须针对 $f = 0.25$ 的特定情况，使用所提供的标称参数 $[A]_0 = 0.020\\,\\mathrm{M}$ 和 $k = 1.5 \\times 10^{-5}\\,\\mathrm{M\\,s^{-1}}$ 来计算这个时间。\n将这些值代入 $t_f$ 的表达式：\n$$\nt_{0.25} = \\frac{(0.020\\,\\mathrm{M})(1 - 0.25)}{1.5 \\times 10^{-5}\\,\\mathrm{M\\,s^{-1}}}\n$$\n$$\nt_{0.25} = \\frac{(0.020)(0.75)}{1.5 \\times 10^{-5}}\\,\\mathrm{s}\n$$\n$$\nt_{0.25} = \\frac{0.015}{1.5 \\times 10^{-5}}\\,\\mathrm{s} = \\frac{1.5 \\times 10^{-2}}{1.5 \\times 10^{-5}}\\,\\mathrm{s} = 1.0 \\times 10^3\\,\\mathrm{s}\n$$\n输入值 $[A]_0$ 和 $k$ 均给出两位有效数字，因此结果也必须表示为两位有效数字。计算出的时间为 $1000\\,\\mathrm{s}$，为正确表示其精度，写作 $1.0 \\times 10^3\\,\\mathrm{s}$。\n\n最后，我们必须评估在 $k$ 具有 $\\pm 0.10$ 的相对不确定度的情况下，达到 $f=0.25$ 的可行性。可行性定义为是否在反应物完全耗尽之前达到目标。完全耗尽发生在 $[A](t) = 0$ 时。设这个时间为 $t_{complete}$。根据积分速率定律，$0 = [A]_0 - kt_{complete}$，得到：\n$$\nt_{complete} = \\frac{[A]_0}{k}\n$$\n可行性的条件是，达到分数 $f$ 所需的时间 $t_f$ 必须小于完全耗尽所需的时间 $t_{complete}$。\n$$\nt_f  t_{complete}\n$$\n代入我们推导出的表达式：\n$$\n\\frac{[A]_0(1 - f)}{k}  \\frac{[A]_0}{k}\n$$\n由于初始浓度 $[A]_0$ 和速率常数 $k$ 都是正量，我们可以将不等式两边同乘以 $\\frac{k}{[A]_0}$ 而不改变不等号的方向：\n$$\n1 - f  1\n$$\n这简化为 $-f  0$，即 $f > 0$。问题陈述中规定 $0  f  1$，这意味着条件 $f > 0$ 是内在的得到满足的。因此，达到此范围内的任何分数浓度 $f$ 在物理上总是可行的，因为它总是在反应物完全消耗之前发生。这个结论是零级模型的直接数学推论，并且与 $k$ 的具体值无关。$k$ 的不确定度会影响 $t_f$ 和 $t_{complete}$ 的数值，但不会改变 $t_f  t_{complete}$ 这一逻辑事实。可行性评估确认，达到 $f=0.25$ 的目标不受指定的速率常数不确定度的影响。", "answer": "$$\\boxed{1.0 \\times 10^{3}}$$", "id": "2942199"}, {"introduction": "二级反应是理解许多化学过程的基础，从气相碰撞到溶液相反应。在动力学问题求解中，采用不同视角往往能带来更深的理解。本练习引入了“转化率” ($X$) 这一变量，作为浓度的替代描述方式。通过推导以 $X$ 表示的速率方程，并与传统的基于浓度的方法进行比较，你将对反应动力学建立更灵活、更扎实的理解 [@problem_id:2942228]。", "problem": "一个化学计量式为 $2\\,\\mathrm{A} \\to \\text{products}$ 的均相、恒温间歇反应按基元反应进行，因此 $\\mathrm{A}$ 的消失速率由微分速率定律 $-\\frac{\\mathrm{d}[A]}{\\mathrm{d}t} = k\\,[A]^{2}$ 给出。该系统在恒定体积下混合均匀，在 $t=0$ 时的初始浓度为 $[A]_{0} = 0.010\\,\\mathrm{M}$。在所研究的温度下，速率常数为 $k = 0.25\\,\\mathrm{M^{-1}\\,s^{-1}}$。定义 $\\mathrm{A}$ 的分数转化率为 $X \\equiv \\left([A]_{0} - [A]\\right)/[A]_{0}$。仅从基本速率定义和 $X$ 的定义出发，确定达到分数转化率 $X = 0.75$ 所需的时间。然后，验证你的结果与从同一起点推导出的、描述该动力学中 $[A](t)$ 与 $t$ 关系的积分表达式相一致。时间以秒为单位表示，并将最终数值答案四舍五入至三位有效数字。", "solution": "首先对问题陈述进行严格验证。已知条件为：一个二级基元反应 $2\\,\\mathrm{A} \\to \\text{products}$，其速率定律为 $-\\frac{\\mathrm{d}[A]}{\\mathrm{d}t} = k\\,[A]^{2}$，初始浓度 $[A]_{0} = 0.010\\,\\mathrm{M}$，速率常数 $k = 0.25\\,\\mathrm{M^{-1}\\,s^{-1}}$，目标分数转化率 $X = 0.75$。分数转化率的定义为 $X \\equiv \\left([A]_{0} - [A]\\right)/[A]_{0}$。问题要求首先通过直接对以 $X$ 表示的速率定律进行积分来确定达到此转化率的时间，然后使用关于物种浓度 $[A]$ 的标准积分速率定律来验证此结果。该问题具有科学依据，提法恰当，客观且内部一致。这是一个化学动力学中的标准问题。因此，该问题被认为是有效的，我们可以继续进行求解。\n\n问题要求从基本定义出发进行推导。我们首先用分数转化率 $X$ 来表示反应物 $\\mathrm{A}$ 的浓度，记为 $[A]$。定义如下：\n$$X = \\frac{[A]_{0} - [A]}{[A]_{0}}$$\n对该表达式进行整理以求解 $[A]$，得到：\n$$[A] = [A]_{0} (1 - X)$$\n为了将其与速率定律联系起来，我们必须求出 $[A]$ 的时间导数。由于 $[A]_{0}$ 是一个常数，对时间 $t$ 求导得到：\n$$\\frac{\\mathrm{d}[A]}{\\mathrm{d}t} = \\frac{\\mathrm{d}}{\\mathrm{d}t} \\left( [A]_{0} (1 - X) \\right) = -[A]_{0} \\frac{\\mathrm{d}X}{\\mathrm{d}t}$$\n给定的微分速率定律是：\n$$-\\frac{\\mathrm{d}[A]}{\\mathrm{d}t} = k[A]^{2}$$\n现在，我们将用 $X$ 表示的 $[A]$ 及其导数的表达式代入速率定律。代入 $-\\frac{\\mathrm{d}[A]}{\\mathrm{d}t} = [A]_{0} \\frac{\\mathrm{d}X}{\\mathrm{d}t}$ 和 $[A]^{2} = [A]_{0}^{2}(1-X)^{2}$，我们得到：\n$$[A]_{0} \\frac{\\mathrm{d}X}{\\mathrm{d}t} = k [A]_{0}^{2} (1-X)^{2}$$\n这是一个关于 $X(t)$ 的微分方程。我们简化并分离变量，为积分做准备：\n$$\\frac{\\mathrm{d}X}{(1-X)^{2}} = k [A]_{0} \\,\\mathrm{d}t$$\n我们将此方程从初始状态（$t=0$，此时 $X=0$）积分到最终状态（时间 $t$，此时转化率为 $X$）：\n$$\\int_{0}^{X} \\frac{\\mathrm{d}X'}{(1-X')^{2}} = \\int_{0}^{t} k [A]_{0} \\,\\mathrm{d}t'$$\n左侧积分为 $\\left[ \\frac{1}{1-X'} \\right]_{0}^{X} = \\frac{1}{1-X} - \\frac{1}{1-0} = \\frac{1}{1-X} - 1 = \\frac{X}{1-X}$。右侧积分为 $k [A]_{0} t$。令两边相等，得到以分数转化率表示的积分速率定律：\n$$\\frac{X}{1-X} = k [A]_{0} t$$\n我们求解时间 $t$：\n$$t = \\frac{1}{k[A]_{0}} \\left( \\frac{X}{1-X} \\right)$$\n现在，我们代入给定的数值：$k = 0.25\\,\\mathrm{M^{-1}\\,s^{-1}}$，$[A]_{0} = 0.010\\,\\mathrm{M}$，以及 $X = 0.75$。\n$$t = \\frac{1}{(0.25)(0.010)} \\left( \\frac{0.75}{1-0.75} \\right) = \\frac{1}{0.0025} \\left( \\frac{0.75}{0.25} \\right) = (400) \\cdot (3) = 1200\\,\\mathrm{s}$$\n\n接下来，我们必须使用联系 $[A]$ 与 $t$ 的标准积分速率定律来验证此结果。我们再次从速率定律出发：\n$$-\\frac{\\mathrm{d}[A]}{\\mathrm{d}t} = k[A]^{2}$$\n分离变量得到：\n$$-\\frac{\\mathrm{d}[A]}{[A]^{2}} = k \\,\\mathrm{d}t$$\n我们从初始状态（$t=0$，$[A]=[A]_{0}$）积分到最终状态（时间 $t$，浓度 $[A]$）：\n$$\\int_{[A]_{0}}^{[A]} -\\frac{\\mathrm{d}[A]'}{([A]')^{2}} = \\int_{0}^{t} k \\,\\mathrm{d}t'$$\n左侧积分为 $\\left[ \\frac{1}{[A]'} \\right]_{[A]_{0}}^{[A]} = \\frac{1}{[A]} - \\frac{1}{[A]_{0}}$。右侧为 $kt$。这就得到了我们熟悉的二级反应的积分速率定律：\n$$\\frac{1}{[A]} - \\frac{1}{[A]_{0}} = kt$$\n要使用此方程，我们必须求出当分数转化率 $X$ 为 $0.75$ 时的浓度 $[A]$：\n$$[A] = [A]_{0} (1 - X) = (0.010\\,\\mathrm{M}) (1 - 0.75) = (0.010\\,\\mathrm{M}) (0.25) = 0.0025\\,\\mathrm{M}$$\n现在，我们对积分速率定律求解时间 $t$：\n$$t = \\frac{1}{k} \\left( \\frac{1}{[A]} - \\frac{1}{[A]_{0}} \\right)$$\n代入数值：\n$$t = \\frac{1}{0.25} \\left( \\frac{1}{0.0025} - \\frac{1}{0.010} \\right) = 4 \\left( 400 - 100 \\right) = 4 (300) = 1200\\,\\mathrm{s}$$\n两种方法的结果相同，这便作为所要求的验证。精确时间是 $1200\\,\\mathrm{s}$。问题要求答案四舍五入到三位有效数字，即 $1.20 \\times 10^3\\,\\mathrm{s}$。", "answer": "$$\\boxed{1.20 \\times 10^{3}}$$", "id": "2942228"}, {"introduction": "在许多理论模型中，我们假设速率常数 $k$ 是一个定值，但这是一种理想化情况。在众多实际体系中，温度、催化剂活性等条件会随时间变化，从而导致 $k$ 也依赖于时间。这项高级练习将直面这一挑战，要求你为速率常数非恒定的($k(t)$)一级衰变过程推导通用解。该问题融合了解析方法（微积分）和数值技术（龙格－库塔积分法），是解决现代化学动力学问题的一个绝佳范例 [@problem_id:2942187]。", "problem": "一种单一反应物经历一级衰变，其速率系数随时间变化。瞬时速率定律由常微分方程 (ODE) $\\,\\dfrac{dC}{dt} = -k(t)\\,C\\,$ 给出，初始条件为 $\\,C(0)=C_0\\,$，其中 $\\,C(t)\\,$ 是在时间 $\\,t\\,$ 时的浓度，$\\,k(t)\\,$ 是速率系数，$\\,C_0\\,$ 是一个正常数。半衰期 $\\,t_{1/2}\\,$ 被定义为满足 $\\,C(t_{1/2}) = \\dfrac{C_0}{2}\\,$ 的唯一时间。仅从该常微分方程和半衰期的定义出发（不借助任何预先记下的积分形式），推导出以包含 $\\,k(t)\\,$ 的积分形式确定 $\\,t_{1/2}\\,$ 的判据。然后，对于下面每个测试用例中指定的具体 $\\,k(t)\\,$，使用此判据获得 $\\,t_{1/2}\\,$ 的解析目标方程。\n\n接下来，实现一个固定步长 ($\\,\\Delta t = 10^{-4}\\,$ 秒 (s)) 的显式四阶龙格－库塔时间推进格式，从 $\\,t=0\\,$ 和 $\\,C(0)=C_0\\,$ 开始，对该常微分方程的解进行数值近似。随时间推进，直到数值解穿过半浓度阈值。通过在跨越阈值 $\\,C=C_0/2\\,$ 的最后两个时间节点 $\\,t_n\\,$ 和 $\\,t_{n+1}=t_n+\\Delta t\\,$ 之间进行线性插值，来估算数值半衰期 $\\,\\widehat{t}_{1/2}\\,$。对于每个测试用例，计算绝对差 $\\,|\\,\\widehat{t}_{1/2} - t_{1/2}\\,|\\,$，单位为秒 (s)。\n\n对于每种情况下的解析目标 $\\,t_{1/2}\\,$，按以下步骤进行。首先，根据您的积分判据，推导出 $\\,\\int_0^t k(\\tau)\\,d\\tau\\,$ 的闭式反导数。然后：\n- 当求解 $\\,t_{1/2}\\,$ 的过程可以归约为代数或初等函数时，完成代数运算以显式地获得 $\\,t_{1/2}\\,$。\n- 当 $\\,t_{1/2}\\,$ 的方程是超越方程时，在解析积分形式上使用鲁棒的标量求根方法（此步骤不要使用常微分方程的数值时间步进）。在以下所有情况中，假定存在唯一的正解。\n\n使用 $\\,C_0 = 1.0\\,$（任意浓度单位）。时间单位为秒 (s)，速率常数单位为逆秒 ($s^{-1}$) 或酌情使用相应的导出单位。所有答案必须以秒 (s) 为单位，用十进制数表示。\n\n测试套件：\n- 情况 $\\,1\\,$ (速率随时间线性变化)：$\\,k(t)=k_0 + a\\,t\\,$，参数为 $\\,k_0 = 0.5\\,$ s$^{-1}$ 和 $\\,a = 0.1\\,$ s$^{-2}$。\n- 情况 $\\,2\\,$ (速率呈指数衰减)：$\\,k(t)=k_0\\,e^{-b\\,t}\\,$，参数为 $\\,k_0 = 1.0\\,$ s$^{-1}$ 和 $\\,b = 0.5\\,$ s$^{-1}$。\n- 情况 $\\,3\\,$ (带正偏移的正弦调制速率)：$\\,k(t)=k_0 + A\\sin(\\omega t)\\,$，参数为 $\\,k_0 = 0.8\\,$ s$^{-1}$，$\\,A = 0.3\\,$ s$^{-1}$ 和 $\\,\\omega = 2.0\\,$ s$^{-1}$。\n- 情况 $\\,4\\,$ (速率为分段常数的阶跃变化)：$\\,k(t)=k_1\\,$ 当 $\\,0 \\le t  t_s\\,$ 且 $\\,k(t)=k_2\\,$ 当 $\\,t \\ge t_s\\,$，参数为 $\\,k_1 = 0.2\\,$ s$^{-1}$，$\\,k_2 = 1.5\\,$ s$^{-1}$ 和 $\\,t_s = 2.0\\,$ s。\n\n数值格式要求：\n- 使用固定时间步长 $\\,\\Delta t = 10^{-4}\\,$ s 用于龙格－库塔方法。\n- 为常微分方程 $\\,\\dfrac{dC}{dt}=-k(t)\\,C\\,$ 实现经典的四阶龙格－库塔更新。\n- 检测首次穿越 $\\,C=C_0/2\\,$ 的情况，并通过在两个相邻节点之间进行线性插值来估算 $\\,\\widehat{t}_{1/2}\\,$。\n\n解析目标：\n- 对于情况 $\\,1\\,$, $\\,2\\,$ 和 $\\,4\\,$，在对 $\\,k(t)\\,$ 进行积分后，使用初等代数显式求解 $\\,t_{1/2}\\,$。\n- 对于情况 $\\,3\\,$，在对 $\\,k(t)\\,$ 进行积分后，在积分表达式上使用鲁棒的一维求根器求解得到的关于 $\\,t_{1/2}\\,$ 的标量方程。\n\n您的程序应产生单行输出，其中包含四个情况的绝对差，形式为方括号括起来的逗号分隔列表（例如，$[d_1,d_2,d_3,d_4]$），其中每个 $\\,d_i\\,$ 是以十进制数表示的绝对误差 $\\,|\\,\\widehat{t}_{1/2}-t_{1/2}\\,|\\,$，单位为秒 (s)。", "solution": "对问题陈述进行验证。\n\n**第 1 步：提取给定条件**\n- **控制方程**：常微分方程 (ODE) $\\dfrac{dC}{dt} = -k(t)\\,C$。\n- **初始条件**：$C(0) = C_0$，其中 $C_0$ 为正常数。\n- **半衰期定义**：$t_{1/2}$ 是满足 $C(t_{1/2}) = \\dfrac{C_0}{2}$ 的唯一时间。\n- **数值方法**：四阶显式龙格-库塔 (RK4) 格式。\n- **时间步长**：$\\Delta t = 10^{-4}$ s。\n- **数值半衰期估算**：在包含 $C = C_0/2$ 阈值的时间节点之间进行线性插值。\n- **初始浓度**：所有计算均使用 $C_0 = 1.0$。\n- **测试用例 1**：$k(t)=k_0 + a\\,t$，其中 $k_0 = 0.5\\,$ s$^{-1}$, $a = 0.1\\,$ s$^{-2}$。\n- **测试用例 2**：$k(t)=k_0\\,e^{-b\\,t}$，其中 $k_0 = 1.0\\,$ s$^{-1}$, $b = 0.5\\,$ s$^{-1}$。\n- **测试用例 3**：$k(t)=k_0 + A\\sin(\\omega t)$，其中 $k_0 = 0.8\\,$ s$^{-1}$, $A = 0.3\\,$ s$^{-1}$, $\\omega = 2.0\\,$ s$^{-1}$。注意，对于所有 $t$, $k(t) \\ge k_0 - A = 0.8 - 0.3 = 0.5  0$。\n- **测试用例 4**：分段常数 $k(t)$，当 $0 \\le t  t_s$ 时 $k(t)=k_1$，当 $t \\ge t_s$ 时 $k(t)=k_2$，其中 $k_1 = 0.2\\,$ s$^{-1}$, $k_2 = 1.5\\,$ s$^{-1}$, $t_s = 2.0\\,$ s。\n\n**第 2 步：使用提取的给定条件进行验证**\n- **科学上成立**：该问题描述了具有时变速率系数的一级化学动力学。这是物理化学和化学工程中的一个标准且成熟的课题。所有提供的 $k(t)$ 函数在物理上都是现实的（对于所有 $t \\ge 0$，它们都保持正值）。\n- **适定的**：该问题是一个线性一阶常微分方程的适定初值问题，保证有唯一解。寻找解析和数值半衰期的条件都已明确规定。\n- **客观的**：该问题以精确、定量且无歧义的术语陈述。\n\n**第 3 步：结论与行动**\n此问题在科学上成立、适定且客观。它不包含可辨别的缺陷。因此，该问题是**有效的**。将构建一个解。\n\n**基于原理的求解**\n\n求解过程分三部分：首先，推导半衰期 $t_{1/2}$ 的一般解析判据；其次，将此判据应用于每种具体情况，以确定 $t_{1/2}$ 的解析目标方程；第三，描述用于寻找近似半衰期 $\\widehat{t}_{1/2}$ 的数值格式。\n\n**第 1 部分：半衰期的一般解析判据**\n\n控制微分方程为：\n$$ \\dfrac{dC}{dt} = -k(t)\\,C $$\n这是一个线性一阶可分离常微分方程。我们分离变量：\n$$ \\dfrac{1}{C} dC = -k(t) dt $$\n我们对两边从初始条件 $(t=0, C=C_0)$ 到任意状态 $(t, C(t))$ 进行积分。为避免混淆，我们使用积分哑元，时间为 $\\tau$，浓度为 $C'$。\n$$ \\int_{C_0}^{C(t)} \\dfrac{1}{C'} dC' = -\\int_0^t k(\\tau) d\\tau $$\n计算左侧积分得到：\n$$ \\left[ \\ln(C') \\right]_{C_0}^{C(t)} = \\ln(C(t)) - \\ln(C_0) = \\ln\\left(\\dfrac{C(t)}{C_0}\\right) $$\n因此，积分速率定律的一般形式为：\n$$ \\ln\\left(\\dfrac{C(t)}{C_0}\\right) = -\\int_0^t k(\\tau) d\\tau $$\n根据半衰期的定义，在 $t = t_{1/2}$ 时，浓度为 $C(t_{1/2}) = C_0 / 2$。我们将其代入积分速率定律：\n$$ \\ln\\left(\\dfrac{C_0/2}{C_0}\\right) = -\\int_0^{t_{1/2}} k(\\tau) d\\tau $$\n$$ \\ln\\left(\\dfrac{1}{2}\\right) = -\\ln(2) = -\\int_0^{t_{1/2}} k(\\tau) d\\tau $$\n这得出了确定半衰期 $t_{1/2}$ 的基本判据：\n$$ \\int_0^{t_{1/2}} k(\\tau) d\\tau = \\ln(2) $$\n这个方程是在所有测试用例中寻找 $t_{1/2}$ 解析值的基础。\n\n**第 2 部分：测试用例的解析半衰期方程**\n\n对于每种情况，我们首先计算定积分 $\\int_0^t k(\\tau)d\\tau$。\n\n**情况 1: $k(t) = k_0 + a\\,t$**\n积分为：\n$$ \\int_0^t (k_0 + a\\tau)d\\tau = \\left[ k_0\\tau + \\dfrac{1}{2}a\\tau^2 \\right]_0^t = k_0t + \\dfrac{1}{2}at^2 $$\n令 $t=t_{1/2}$ 并使其等于 $\\ln(2)$，得到一个关于 $t_{1/2}$ 的二次方程：\n$$ \\dfrac{1}{2}a t_{1/2}^2 + k_0 t_{1/2} - \\ln(2) = 0 $$\n物理上有意义的解必须是正的，所以我们取二次公式的正根：\n$$ t_{1/2} = \\dfrac{-k_0 + \\sqrt{k_0^2 - 4(\\frac{1}{2}a)(-\\ln(2))}}{a} = \\dfrac{-k_0 + \\sqrt{k_0^2 + 2a\\ln(2)}}{a} $$\n\n**情况 2: $k(t) = k_0e^{-bt}$**\n积分为：\n$$ \\int_0^t k_0e^{-b\\tau}d\\tau = k_0 \\left[ -\\dfrac{1}{b}e^{-b\\tau} \\right]_0^t = -\\dfrac{k_0}{b}(e^{-bt} - e^0) = \\dfrac{k_0}{b}(1 - e^{-bt}) $$\n令 $t=t_{1/2}$ 并使其等于 $\\ln(2)$，得到：\n$$ \\dfrac{k_0}{b}(1 - e^{-bt_{1/2}}) = \\ln(2) $$\n通过代数变换解出 $t_{1/2}$：\n$$ 1 - e^{-bt_{1/2}} = \\dfrac{b\\ln(2)}{k_0} \\implies e^{-bt_{1/2}} = 1 - \\dfrac{b\\ln(2)}{k_0} $$\n$$ -bt_{1/2} = \\ln\\left(1 - \\dfrac{b\\ln(2)}{k_0}\\right) \\implies t_{1/2} = -\\dfrac{1}{b}\\ln\\left(1 - \\dfrac{b\\ln(2)}{k_0}\\right) $$\n\n**情况 3: $k(t) = k_0 + A\\sin(\\omega t)$**\n积分为：\n$$ \\int_0^t (k_0 + A\\sin(\\omega\\tau))d\\tau = \\left[ k_0\\tau - \\dfrac{A}{\\omega}\\cos(\\omega\\tau) \\right]_0^t = \\left( k_0t - \\dfrac{A}{\\omega}\\cos(\\omega t) \\right) - \\left( 0 - \\dfrac{A}{\\omega}\\cos(0) \\right) = k_0t - \\dfrac{A}{\\omega}\\cos(\\omega t) + \\dfrac{A}{\\omega} $$\n令 $t=t_{1/2}$ 并使其等于 $\\ln(2)$，产生一个超越方程：\n$$ k_0t_{1/2} - \\dfrac{A}{\\omega}\\cos(\\omega t_{1/2}) + \\dfrac{A}{\\omega} - \\ln(2) = 0 $$\n这个方程没有简单的代数解，必须使用数值求根算法求解。\n\n**情况 4: 分段常数 $k(t)$**\n积分取决于 $t$ 是小于还是大于 $t_s$。首先，我们必须通过计算在 $t=t_s$ 时的积分值来判断 $t_{1/2}$ 是小于还是大于 $t_s$：\n$$ \\int_0^{t_s} k(\\tau)d\\tau = \\int_0^{t_s} k_1 d\\tau = k_1t_s $$\n如果 $k_1t_s > \\ln(2)$，则 $t_{1/2}  t_s$。$t_{1/2}$ 的方程为 $k_1t_{1/2} = \\ln(2)$，所以 $t_{1/2} = \\ln(2)/k_1$。\n如果 $k_1t_s \\le \\ln(2)$，则 $t_{1/2} \\ge t_s$。积分在 $t_s$ 处分段：\n$$ \\int_0^{t_{1/2}} k(\\tau)d\\tau = \\int_0^{t_s} k_1 d\\tau + \\int_{t_s}^{t_{1/2}} k_2 d\\tau = k_1t_s + k_2(t_{1/2} - t_s) $$\n令其等于 $\\ln(2)$，得到一个关于 $t_{1/2}$ 的线性方程：\n$$ k_1t_s + k_2(t_{1/2} - t_s) = \\ln(2) \\implies t_{1/2} = t_s + \\dfrac{\\ln(2) - k_1t_s}{k_2} $$\n\n**第 3 部分：数值求解格式**\n使用经典的四阶龙格-库塔 (RK4) 方法获得 ODE $dC/dt = f(t,C) = -k(t)C$ 的数值解。给定状态 $(t_n, C_n)$，下一个时间步的状态 $(t_n+\\Delta t, C_{n+1})$ 计算如下：\n$$ C_{n+1} = C_n + \\dfrac{\\Delta t}{6}(s_1 + 2s_2 + 2s_3 + s_4) $$\n其中斜率 $s_i$ 为：\n$$ s_1 = f(t_n, C_n) = -k(t_n)C_n $$\n$$ s_2 = f\\left(t_n + \\dfrac{\\Delta t}{2}, C_n + \\dfrac{\\Delta t}{2}s_1\\right) = -k\\left(t_n + \\dfrac{\\Delta t}{2}\\right)\\left(C_n + \\dfrac{\\Delta t}{2}s_1\\right) $$\n$$ s_3 = f\\left(t_n + \\dfrac{\\Delta t}{2}, C_n + \\dfrac{\\Delta t}{2}s_2\\right) = -k\\left(t_n + \\dfrac{\\Delta t}{2}\\right)\\left(C_n + \\dfrac{\\Delta t}{2}s_2\\right) $$\n$$ s_4 = f(t_n + \\Delta t, C_n + \\Delta t s_3) = -k(t_n + \\Delta t)(C_n + \\Delta t s_3) $$\n从 $(t_0, C_0)=(0, 1.0)$ 开始，以固定步长 $\\Delta t = 10^{-4}$ s 进行时间推进，直到浓度穿过阈值 $C_0/2 = 0.5$。这发生在 $C_n \\ge 0.5$ 和 $C_{n+1}  0.5$ 时。此时，两个点 $(t_n, C_n)$ 和 $(t_{n+1}, C_{n+1})$ 将半衰期包含在内。\n\n数值半衰期 $\\widehat{t}_{1/2}$ 通过在这两点之间进行线性插值来估算。我们在穿过 $(t_n, C_n)$ 和 $(t_{n+1}, C_{n+1})$ 的直线上求解 $\\widehat{t}_{1/2}$，该点浓度为 $0.5$：\n$$ \\dfrac{\\widehat{t}_{1/2} - t_n}{t_{n+1} - t_n} = \\dfrac{0.5 - C_n}{C_{n+1} - C_n} $$\n注意到 $t_{n+1} - t_n = \\Delta t$，我们得到：\n$$ \\widehat{t}_{1/2} = t_n + \\Delta t \\left(\\dfrac{0.5 - C_n}{C_{n+1} - C_n}\\right) $$\n最后的任务是计算四种情况下每一种的绝对差 $|\\widehat{t}_{1/2} - t_{1/2}|$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Solves the problem of finding analytical and numerical half-times for a first-order\n    decay with a time-dependent rate coefficient, and computes the absolute difference.\n    \"\"\"\n    \n    C0 = 1.0  # Initial concentration\n    DT = 1e-4   # Time step for RK4\n\n    # Test cases defined in the problem statement\n    test_cases = [\n        {'id': 1, 'params': {'k0': 0.5, 'a': 0.1}},\n        {'id': 2, 'params': {'k0': 1.0, 'b': 0.5}},\n        {'id': 3, 'params': {'k0': 0.8, 'A': 0.3, 'omega': 2.0}},\n        {'id': 4, 'params': {'k1': 0.2, 'k2': 1.5, 'ts': 2.0}},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        case_id = case['id']\n        params = case['params']\n        \n        # Define k(t) function for the current case\n        if case_id == 1:\n            k_func = lambda t, p: p['k0'] + p['a'] * t\n        elif case_id == 2:\n            k_func = lambda t, p: p['k0'] * np.exp(-p['b'] * t)\n        elif case_id == 3:\n            k_func = lambda t, p: p['k0'] + p['A'] * np.sin(p['omega'] * t)\n        elif case_id == 4:\n            k_func = lambda t, p: p['k1'] if t  p['ts'] else p['k2']\n\n        # --- Analytical Half-Time Calculation ---\n        ln2 = np.log(2)\n        \n        if case_id == 1:\n            k0, a = params['k0'], params['a']\n            # Solve quadratic equation: 0.5*a*t^2 + k0*t - ln(2) = 0\n            t_half_analytical = (-k0 + np.sqrt(k0**2 + 2 * a * ln2)) / a\n        elif case_id == 2:\n            k0, b = params['k0'], params['b']\n            # Solve t = -1/b * ln(1 - (b*ln(2))/k0)\n            t_half_analytical = -1/b * np.log(1 - (b * ln2) / k0)\n        elif case_id == 3:\n            k0, A, w = params['k0'], params['A'], params['omega']\n            # Solve transcendental equation: k0*t - A/w*cos(w*t) + A/w - ln(2) = 0\n            root_func = lambda t: k0*t - (A/w)*np.cos(w*t) + (A/w) - ln2\n            # Initial guess: t_1/2 for constant k=k0\n            t_guess = ln2 / k0\n            sol = root_scalar(root_func, bracket=[t_guess * 0.5, t_guess * 1.5], method='brentq')\n            t_half_analytical = sol.root\n        elif case_id == 4:\n            k1, k2, ts = params['k1'], params['k2'], params['ts']\n            # Check if t_1/2 is before or after the step time ts\n            integral_at_ts = k1 * ts\n            if integral_at_ts >= ln2:\n                t_half_analytical = ln2 / k1\n            else:\n                t_half_analytical = ts + (ln2 - integral_at_ts) / k2\n\n        # --- Numerical Half-Time Calculation using RK4 ---\n        t = 0.0\n        C = C0\n        t_prev, C_prev = t, C\n\n        while C >= C0 / 2.0:\n            t_prev, C_prev = t, C\n            \n            # Classical RK4 slopes\n            s1 = -k_func(t, params) * C\n            s2 = -k_func(t + 0.5 * DT, params) * (C + 0.5 * DT * s1)\n            s3 = -k_func(t + 0.5 * DT, params) * (C + 0.5 * DT * s2)\n            s4 = -k_func(t + DT, params) * (C + DT * s3)\n            \n            # Update concentration and time\n            C += (DT / 6.0) * (s1 + 2 * s2 + 2 * s3 + s4)\n            t += DT\n\n        # Linear interpolation to estimate t_1/2\n        t_half_numerical = t_prev + DT * (C0 / 2.0 - C_prev) / (C - C_prev)\n        \n        # Calculate the absolute difference and store it\n        diff = abs(t_half_numerical - t_half_analytical)\n        results.append(diff)\n\n    # Format the final output string as required\n    output_str = \"[\" + \",\".join(map(str, results)) + \"]\"\n    print(output_str)\n\nsolve()\n```", "id": "2942187"}]}