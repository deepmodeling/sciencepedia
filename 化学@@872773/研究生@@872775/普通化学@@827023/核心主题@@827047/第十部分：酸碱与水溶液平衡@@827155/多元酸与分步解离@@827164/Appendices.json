{"hands_on_practices": [{"introduction": "在处理复杂的多质子酸体系时，一项关键技能是判断在特定条件下哪些化学物种和平衡起主导作用。这种“主导平衡分析”方法可以极大地简化问题，使我们能够洞察体系的核心行为，是建立化学直觉的重要一步。本练习 [@problem_id:2951933] 将指导你对一个三元酸体系进行此类分析，通过比较不同物种的浓度，确定在特定pH区间内电荷平衡方程中的主要贡献项。", "problem": "一种三元酸 $\\mathrm{H_3A}$ 在 $25~^{\\circ}\\mathrm{C}$ 时的逐级酸解离常数由 $pK_{a1} = 2.00$，$pK_{a2} = 6.80$ 和 $pK_{a3} = 11.80$ 表征。通过将分析浓度为 $C_T = 10^{-4}\\ \\mathrm{M}$ 的纯酸溶解在纯水（无外加盐）中制备水溶液。考虑由 $pK_{a1}+1 \\le \\mathrm{pH} \\le pK_{a2}-1$ 定义的内部 $\\mathrm{pH}$ 区域。基于逐级解离平衡、水的自递质子分解、物料守恒和电中性（电荷守恒）的定义，使用主导项平衡分析，哪个选项正确地指出了在该 $\\mathrm{pH}$ 区域内此溶液的电荷守恒中应保留的主导项，以及在给定参数下 $\\mathrm{pH}$ 的相应主导阶标度关系？\n\nA. 在此 $\\mathrm{pH}$ 区域内，电荷守恒在左侧由 $\\left[\\mathrm{H}^+\\right]$ 主导，在右侧由 $\\left[\\mathrm{H_2A^-}\\right]$ 主导，而 $\\left[\\mathrm{OH^-}\\right]$、$\\left[\\mathrm{HA^{2-}}\\right]$ 和 $\\left[\\mathrm{A^{3-}}\\right]$ 可忽略不计；物料守恒给出 $\\left[\\mathrm{H_2A^-}\\right] \\sim C_T$，因此 $\\left[\\mathrm{H}^+\\right] \\sim C_T$ 且 $\\mathrm{pH} \\approx -\\log_{10} C_T \\approx 4.00$。\n\nB. 在此 $\\mathrm{pH}$ 区域内，$\\mathrm{H_2A^-}$ 的两性特征将 $\\left[\\mathrm{H}^+\\right]$ 固定为 $\\left[\\mathrm{H}^+\\right] \\sim \\sqrt{K_{a1}K_{a2}}$，与 $C_T$ 无关，因此主导阶电荷守恒保留 $\\left[\\mathrm{H_2A^-}\\right]$ 和 $\\left[\\mathrm{HA^{2-}}\\right]$，同时忽略 $\\left[\\mathrm{OH^-}\\right]$，得到 $\\mathrm{pH} \\approx \\left(pK_{a1}+pK_{a2}\\right)/2 \\approx 4.40$。\n\nC. 在此 $\\mathrm{pH}$ 区域内，仅由第一级解离控制电荷守恒，因此 $\\left[\\mathrm{H}^+\\right] \\sim K_{a1}$ 且 $\\mathrm{pH} \\approx pK_{a1} \\approx 2.00$，所有共轭碱项均可忽略不计。\n\nD. 在此 $\\mathrm{pH}$ 区域内，水的自递质子分解主导电荷守恒，以至于 $\\left[\\mathrm{H}^+\\right] \\approx \\left[\\mathrm{OH^-}\\right]$，且酸的贡献可以忽略不计；因此，无论 $C_T$、$K_{a1}$、$K_{a2}$ 和 $K_{a3}$ 为何值，$\\mathrm{pH} \\approx 7.00$。", "solution": "首先必须验证问题陈述的科学性和逻辑完整性。\n\n**步骤1：提取已知条件**\n- **体系：** 一种三元酸 $\\mathrm{H_3A}$ 的水溶液。\n- **热力学数据：** 在 $25~^{\\circ}\\mathrm{C}$ 时，给定的逐级酸解离常数为 $pK_{a1} = 2.00$，$pK_{a2} = 6.80$ 和 $pK_{a3} = 11.80$。这意味着 $K_{a1} = 10^{-2.00}$，$K_{a2} = 10^{-6.80}$ 和 $K_{a3} = 10^{-11.80}$。该温度意味着水的自递质子分解常数为 $K_w = 10^{-14.00}$。\n- **浓度：** 酸的分析浓度为 $C_T = 10^{-4}\\ \\mathrm{M}$。\n- **条件：** 溶液在纯水中制备，未添加其他盐。\n- **关注区域：** 分析将在由 $pK_{a1}+1 \\le \\mathrm{pH} \\le pK_{a2}-1$ 定义的 $\\mathrm{pH}$ 范围内进行。数值上，这对应于范围 $3.00 \\le \\mathrm{pH} \\le 5.80$。\n- **要求分析：** 基于基本原理（平衡、物料守恒、电荷守恒）的主导项平衡分析，以确定电荷守恒中的主导项以及由此产生的 $\\mathrm{pH}$ 标度关系。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据。多元酸的逐级解离概念是普通化学和分析化学中的一个标准课题。提供的 $pK_a$ 值是符合实际的；例如，它们与磷酸（$\\mathrm{H_3PO_4}$）的值相近。问题是适定的，提供了确定体系平衡状态所需的所有必要信息（$C_T$ 和所有 $K_a$ 值）。语言客观而精确。任务是在一个指定的、数学上一致的区域内，应用一种标准的近似方法（主导项平衡分析）。问题设置没有违反任何基本原理，并且不是不完整的、矛盾的或模棱两可的。\n\n**步骤3：结论与行动**\n问题陈述有效。将推导求解。\n\n**推导**\n\n该体系的基本控制方程如下：\n1.  **化学平衡：**\n    $$ \\mathrm{H_3A} + \\mathrm{H_2O} \\rightleftharpoons \\mathrm{H_2A^-} + \\mathrm{H_3O^+} \\quad K_{a1} = \\frac{\\left[\\mathrm{H_2A^-}\\right]\\left[\\mathrm{H}^+\\right]}{\\left[\\mathrm{H_3A}\\right]} = 10^{-2.00} $$\n    $$ \\mathrm{H_2A^-} + \\mathrm{H_2O} \\rightleftharpoons \\mathrm{HA^{2-}} + \\mathrm{H_3O^+} \\quad K_{a2} = \\frac{\\left[\\mathrm{HA^{2-}}\\right]\\left[\\mathrm{H}^+\\right]}{\\left[\\mathrm{H_2A^-}\\right]} = 10^{-6.80} $$\n    $$ \\mathrm{HA^{2-}} + \\mathrm{H_2O} \\rightleftharpoons \\mathrm{A^{3-}} + \\mathrm{H_3O^+} \\quad K_{a3} = \\frac{\\left[\\mathrm{A^{3-}}\\right]\\left[\\mathrm{H}^+\\right]}{\\left[\\mathrm{HA^{2-}}\\right]} = 10^{-11.80} $$\n    $$ 2\\mathrm{H_2O} \\rightleftharpoons \\mathrm{H_3O^+} + \\mathrm{OH^-} \\quad K_w = \\left[\\mathrm{H}^+\\right]\\left[\\mathrm{OH^-}\\right] = 10^{-14.00} $$\n    此处，$\\left[\\mathrm{H}^+\\right]$ 用作 $\\left[\\mathrm{H_3O^+}\\right]$ 的简写。\n\n2.  **物料守恒：** 所有含共轭碱 'A' 的物种的总浓度必须等于初始分析浓度 $C_T$。\n    $$ C_T = \\left[\\mathrm{H_3A}\\right] + \\left[\\mathrm{H_2A^-}\\right] + \\left[\\mathrm{HA^{2-}}\\right] + \\left[\\mathrm{A^{3-}}\\right] = 10^{-4}\\ \\mathrm{M} $$\n\n3.  **电荷守恒（电中性）：** 正电荷的摩尔浓度之和必须等于负电荷的摩尔浓度之和。\n    $$ \\left[\\mathrm{H}^+\\right] = \\left[\\mathrm{OH^-}\\right] + \\left[\\mathrm{H_2A^-}\\right] + 2\\left[\\mathrm{HA^{2-}}\\right] + 3\\left[\\mathrm{A^{3-}}\\right] $$\n\n问题指导我们在指定的 $\\mathrm{pH}$ 范围 $3.00 \\le \\mathrm{pH} \\le 5.80$ 内进行主导项平衡分析。我们首先分析该区域内由酸衍生的物种的分布。相邻物种的相对分数由比率 $\\left[\\mathrm{H}^+\\right]/K_a$ 决定。\n\n-   **$\\left[\\mathrm{H_3A}\\right]$ 与 $\\left[\\mathrm{H_2A^-}\\right]$ 的比率：**\n    $$ \\frac{\\left[\\mathrm{H_3A}\\right]}{\\left[\\mathrm{H_2A^-}\\right]} = \\frac{\\left[\\mathrm{H}^+\\right]}{K_{a1}} $$\n    由于 $\\mathrm{pH}$ 区域是 $3.00 \\le \\mathrm{pH} \\le 5.80$，我们有 $10^{-5.80} \\le \\left[\\mathrm{H}^+\\right] \\le 10^{-3.00}$。$K_{a1}$ 的值是 $10^{-2.00}$。因此，比率 $\\left[\\mathrm{H}^+\\right]/K_{a1}$ 在范围 $[10^{-3.80}, 10^{-1.00}]$ 内。这意味着 $\\left[\\mathrm{H_3A}\\right]$ 最多是 $\\left[\\mathrm{H_2A^-}\\right]$ 的 $10\\%$（在 $\\mathrm{pH}=3.00$ 时），并且在该范围内的更高 $\\mathrm{pH}$ 值下要小得多。因此，与 $\\left[\\mathrm{H_2A^-}\\right]$ 相比，$\\left[\\mathrm{H_3A}\\right]$ 是一个次要物种。\n\n-   **$\\left[\\mathrm{HA^{2-}}\\right]$ 与 $\\left[\\mathrm{H_2A^-}\\right]$ 的比率：**\n    $$ \\frac{\\left[\\mathrm{HA^{2-}}\\right]}{\\left[\\mathrm{H_2A^-}\\right]} = \\frac{K_{a2}}{\\left[\\mathrm{H}^+\\right]} $$\n    $K_{a2}$ 的值是 $10^{-6.80}$。在给定的 $\\mathrm{pH}$ 范围内，比率 $K_{a2}/\\left[\\mathrm{H}^+\\right]$ 在范围 $[10^{-3.80}, 10^{-1.00}]$ 内。这意味着 $\\left[\\mathrm{HA^{2-}}\\right]$ 最多是 $\\left[\\mathrm{H_2A^-}\\right]$ 的 $10\\%$（在 $\\mathrm{pH}=5.80$ 时），并且在该范围内的较低 $\\mathrm{pH}$ 值下要小得多。因此，与 $\\left[\\mathrm{H_2A^-}\\right]$ 相比，$\\left[\\mathrm{HA^{2-}}\\right]$ 也是一个次要物种。\n\n-   由于 $\\left[\\mathrm{HA^{2-}}\\right]$ 是次要的，$\\left[\\mathrm{A^{3-}}\\right]$ 必定可以忽略，因为在此 $\\mathrm{pH}$ 范围内 $\\left[\\mathrm{A^{3-}}\\right]/\\left[\\mathrm{HA^{2-}}\\right] = K_{a3}/\\left[\\mathrm{H}^+\\right] \\ll 1$。\n\n鉴于在指定的 $\\mathrm{pH}$ 区域内，$\\left[\\mathrm{H_3A}\\right]$、$\\left[\\mathrm{HA^{2-}}\\right]$ 和 $\\left[\\mathrm{A^{3-}}\\right]$ 与 $\\left[\\mathrm{H_2A^-}\\right]$ 相比都是次要物种，物料守恒方程简化为：\n$$ C_T \\approx \\left[\\mathrm{H_2A^-}\\right] $$\n\n现在我们分析电荷守恒方程：$\\left[\\mathrm{H}^+\\right] = \\left[\\mathrm{OH^-}\\right] + \\left[\\mathrm{H_2A^-}\\right] + 2\\left[\\mathrm{HA^{2-}}\\right] + 3\\left[\\mathrm{A^{3-}}\\right]$。\n-   **$\\left[\\mathrm{OH^-}\\right]$:** 在 $3.00 \\le \\mathrm{pH} \\le 5.80$ 的范围内，$\\left[\\mathrm{H}^+\\right]$ 至少为 $10^{-5.80} \\mathrm{M}$，而 $\\left[\\mathrm{OH^-}\\right]$至多为 $10^{-8.20} \\mathrm{M}$。因此，与 $\\left[\\mathrm{H}^+\\right]$ 相比，$\\left[\\mathrm{OH^-}\\right]$ 可忽略不计。\n-   **来自酸的项：** 我们已经确定 $\\left[\\mathrm{HA^{2-}}\\right]$ 和 $\\left[\\mathrm{A^{3-}}\\right]$ 与 $\\left[\\mathrm{H_2A^-}\\right]$ 相比很小。具体来说，$\\left[\\mathrm{HA^{2-}}\\right]  0.1 \\left[\\mathrm{H_2A^-}\\right]$ 且 $3\\left[\\mathrm{A^{3-}}\\right]$ 更小。因此，右侧来自酸物种的主导项是 $\\left[\\mathrm{H_2A^-}\\right]$。\n\n简化的电荷守恒方程变为：\n$$ \\left[\\mathrm{H}^+\\right] \\approx \\left[\\mathrm{H_2A^-}\\right] $$\n\n结合简化的物料守恒和电荷守恒的结果：\n$$ \\left[\\mathrm{H}^+\\right] \\approx \\left[\\mathrm{H_2A^-}\\right] \\approx C_T $$\n代入给定的 $C_T$ 值：\n$$ \\left[\\mathrm{H}^+\\right] \\approx 10^{-4}\\ \\mathrm{M} $$\n这导致 $\\mathrm{pH}$ 的估计值为：\n$$ \\mathrm{pH} \\approx -\\log_{10}(10^{-4}) = 4.00 $$\n这个计算出的 $\\mathrm{pH}$ 4.00 位于指定的分析范围 $3.00 \\le \\mathrm{pH} \\le 5.80$ 内，这证实了我们的近似和分析的自洽性。\n\n**逐项分析选项**\n\n**A. 在此 $\\mathrm{pH}$ 区域内，电荷守恒在左侧由 $\\left[\\mathrm{H}^+\\right]$ 主导，在右侧由 $\\left[\\mathrm{H_2A^-}\\right]$ 主导，而 $\\left[\\mathrm{OH^-}\\right]$、$\\left[\\mathrm{HA^{2-}}\\right]$ 和 $\\left[\\mathrm{A^{3-}}\\right]$ 可忽略不计；物料守恒给出 $\\left[\\mathrm{H_2A^-}\\right] \\sim C_T$，因此 $\\left[\\mathrm{H}^+\\right] \\sim C_T$ 且 $\\mathrm{pH} \\approx -\\log_{10} C_T \\approx 4.00$。**\n这个陈述与我们的推导完全相符。主导项平衡分析表明，在指定的 $\\mathrm{pH}$ 区域内，$\\left[\\mathrm{H_2A^-}\\right]$ 是从酸衍生的主要物种，使得 $\\left[\\mathrm{H_2A^-}\\right] \\approx C_T$。电荷守恒简化为 $\\left[\\mathrm{H}^+\\right] \\approx \\left[\\mathrm{H_2A^-}\\right]$ 也是正确的。$\\left[\\mathrm{H}^+\\right] \\approx C_T$ 和 $\\mathrm{pH} \\approx 4.00$ 的结论是合乎逻辑的结果。\n判决：**正确**。\n\n**B. 在此 $\\mathrm{pH}$ 区域内，$\\mathrm{H_2A^-}$ 的两性特征将 $\\left[\\mathrm{H}^+\\right]$ 固定为 $\\left[\\mathrm{H}^+\\right] \\sim \\sqrt{K_{a1}K_{a2}}$，与 $C_T$ 无关，因此主导阶电荷守恒保留 $\\left[\\mathrm{H_2A^-}\\right]$ 和 $\\left[\\mathrm{HA^{2-}}\\right]$，同时忽略 $\\left[\\mathrm{OH^-}\\right]$，得到 $\\mathrm{pH} \\approx \\left(pK_{a1}+pK_{a2}\\right)/2 \\approx 4.40$。**\n这个推理是错误的。公式 $\\mathrm{pH} \\approx (pK_{a1}+pK_{a2})/2$ 是为溶解两性盐（例如 $\\mathrm{NaH_2A}$）而非纯酸 $\\mathrm{H_3A}$ 制备的溶液的近似。那个不同体系的质子平衡导致了这个结果。对于 $\\mathrm{H_3A}$ 的溶液，正确的电荷守恒是上面推导中陈述的那个。主导阶电荷守恒保留 $\\left[\\mathrm{H_2A^-}\\right]$ 和 $\\left[\\mathrm{HA^{2-}}\\right]$ 的说法是错误的；如前所示，主导平衡在 $\\left[\\mathrm{H}^+\\right]$ 和 $\\left[\\mathrm{H_2A^-}\\right]$ 之间。\n判决：**错误**。\n\n**C. 在此 $\\mathrm{pH}$ 区域内，仅由第一级解离控制电荷守恒，因此 $\\left[\\mathrm{H}^+\\right] \\sim K_{a1}$ 且 $\\mathrm{pH} \\approx pK_{a1} \\approx 2.00$，所有共轭碱项均可忽略不计。**\n这个选项包含几个错误。首先，所得的 $\\mathrm{pH}$ 2.00 超出了指定的分析区域 $[3.00, 5.80]$，这是一个直接的矛盾。其次，$\\left[\\mathrm{H}^+\\right] \\sim K_{a1}$ 的假设是没有根据的。将第一级解离作为弱酸进行正确分析，$K_{a1} = \\left[\\mathrm{H}^+\\right]^2 / (C_T - \\left[\\mathrm{H}^+\\right])$，其中 $C_T=10^{-4}\\ \\mathrm{M}$ 和 $K_{a1}=10^{-2.00}\\ \\mathrm{M}$，得出 $\\left[\\mathrm{H}^+\\right] \\approx 10^{-4}\\ \\mathrm{M}$，这对应于 $\\mathrm{pH} \\approx 4.00$，而不是 $2.00$。最后，陈述“所有共轭碱项均可忽略不计”是矛盾的，因为第一级解离需要 $\\left[\\mathrm{H_2A^-}\\right]$ 来平衡来自 $\\left[\\mathrm{H}^+\\right]$ 的电荷。\n判决：**错误**。\n\n**D. 在此 $\\mathrm{pH}$ 区域内，水的自递质子分解主导电荷守恒，以至于 $\\left[\\mathrm{H}^+\\right] \\approx \\left[\\mathrm{OH^-}\\right]$，且酸的贡献可以忽略不计；因此，无论 $C_T$、$K_{a1}$、$K_{a2}$ 和 $K_{a3}$ 为何值，$\\mathrm{pH} \\approx 7.00$。**\n这个选项是根本错误的。添加酸，即使是稀酸，也必须导致 $\\mathrm{pH}  7.00$。提议的 $\\mathrm{pH}$ 7.00 也超出了指定的分析区域 $[3.00, 5.80]$。对于 $pK_{a1}=2.00$、浓度为 $10^{-4}\\ \\mathrm{M}$ 的酸来说，“酸的贡献可以忽略不计”的前提是错误的。正如我们的主要分析所示，酸的解离是 $\\mathrm{H}^+$ 的主要来源。\n判决：**错误**。", "answer": "$$\\boxed{A}$$", "id": "2951933"}, {"introduction": "在建立了近似分析的直觉后，我们转向精确的定量计算。本练习 [@problem_id:2951880] 以一个常见且重要的两性物质——碳酸氢根离子——为研究对象，要求你从基本原理出发，推导并求解精确的平衡方程以确定溶液的pH。这个过程不仅能锻炼你处理完整化学平衡体系代数复杂性的能力，还能让你深入理解精确解与常用近似公式之间的关系。", "problem": "在温度 $25^\\circ\\mathrm{C}$ 下，将碳酸氢钠溶解在水中，制备成初始浓度为 $C_{\\mathrm{NaHCO_3}} = 0.050\\ \\mathrm{mol}\\ \\mathrm{L}^{-1}$ 的水溶液。该过程在密闭容器中进行，无二氧化碳气体交换。将该溶液视为理想溶液，因此活度等于摩尔浓度。碳酸 $\\mathrm{H_2CO_3}$ 在 $25^\\circ\\mathrm{C}$ 时发生分步电离，其酸解离常数由 $\\mathrm{p}K_{a,1} = 6.35$ 和 $\\mathrm{p}K_{a,2} = 10.33$ 表征。在 $25^\\circ\\mathrm{C}$ 时，水的自电离常数为 $K_{\\mathrm{w}} = 1.0 \\times 10^{-14}$。请仅从质量作用定律、解离常数的定义以及精确的物料守恒和电荷守恒出发，确定该溶液的 $\\mathrm{pH}$ 值。将 $\\mathrm{pH}$ 值作为无量纲值报告，并四舍五入至四位有效数字。", "solution": "该问题涉及计算两性物质 ($\\mathrm{HCO_3^-}$) 溶液的pH。我们从第一性原理出发。\n对于溶解有 $\\mathrm{NaHCO_3}$ 的溶液，参考物种为 $\\mathrm{H_2O}$ 和 $\\mathrm{HCO_3^-}$。质子比参考物种多的物种是 $\\mathrm{H_3O^+}$ 和 $\\mathrm{H_2CO_3}$。质子比参考物种少的物种是 $\\mathrm{OH^-}$ 和 $\\mathrm{CO_3^{2-}}$。\n**质子平衡方程 (Proton Balance Equation)** 是精确求解的出发点：\n$$ [\\mathrm{H_2CO_3}] + [\\mathrm{H}^+] = [\\mathrm{CO_3^{2-}}] + [\\mathrm{OH^-}] $$\n这个方程是精确的，因为它等价于结合了电荷守恒和物料守恒。\n接下来，我们利用平衡常数表达式，将所有物种浓度用 $[\\mathrm{H}^+]$ 和 $[\\mathrm{HCO_3^-}]$ 表示：\n-   来自 $K_{a,1}$: $[\\mathrm{H_2CO_3}] = \\frac{[\\mathrm{H^+}][\\mathrm{HCO_3^-}]}{K_{a,1}}$\n-   来自 $K_{a,2}$: $[\\mathrm{CO_3^{2-}}] = \\frac{K_{a,2}[\\mathrm{HCO_3^-}]}{[\\mathrm{H^+}]}$\n-   来自 $K_w$: $[\\mathrm{OH^-}] = \\frac{K_w}{[\\mathrm{H^+}]}$\n\n将这些代入质子平衡方程：\n$$ \\frac{[\\mathrm{H^+}][\\mathrm{HCO_3^-}]}{K_{a,1}} + [\\mathrm{H}^+] = \\frac{K_{a,2}[\\mathrm{HCO_3^-}]}{[\\mathrm{H^+}]} + \\frac{K_w}{[\\mathrm{H^+}]} $$\n这是一个仍然包含两个未知数 ($[\\mathrm{H}^+]$ 和 $[\\mathrm{HCO_3^-}]$) 的精确方程。为了求解，我们需要引入物料守恒 $C_T = [\\mathrm{H_2CO_3}] + [\\mathrm{HCO_3^-}] + [\\mathrm{CO_3^{2-}}]$，这会得到一个复杂的高次多项式。\n\n然而，我们可以引入一个非常合理的近似。由于 $\\mathrm{HCO_3^-}$ 的酸性 ($pK_{a,2}=10.33$) 和碱性 (作为 $\\mathrm{H_2CO_3}$ 的共轭碱，$pK_b = 14 - pK_{a,1} = 7.65$) 都很弱，且其初始浓度 $C_T = 0.050\\ \\mathrm{M}$ 相对较高，因此它发生解离或质子化的程度很小。所以，我们可以近似认为其平衡浓度约等于其初始浓度：\n$$ [\\mathrm{HCO_3^-}] \\approx C_{\\mathrm{NaHCO_3}} = C_T = 0.050\\ \\mathrm{M} $$\n将此近似代入上式：\n$$ \\frac{[\\mathrm{H}^+]C_T}{K_{a,1}} + [\\mathrm{H}^+] = \\frac{K_{a,2}C_T}{[\\mathrm{H^+}]} + \\frac{K_w}{[\\mathrm{H^+}]} $$\n为了解出 $[\\mathrm{H}^+]$，我们将方程两边都乘以 $[\\mathrm{H}^+]$：\n$$ \\frac{[\\mathrm{H}^+]^2 C_T}{K_{a,1}} + [\\mathrm{H}^+]^2 = K_{a,2}C_T + K_w $$\n整理可得：\n$$ [\\mathrm{H}^+]^2 \\left( \\frac{C_T}{K_{a,1}} + 1 \\right) = K_{a,2}C_T + K_w $$\n因此，我们得到一个计算 $[\\mathrm{H}^+]$ 的常用且相当精确的公式：\n$$ [\\mathrm{H}^+] = \\sqrt{\\frac{K_{a,2}C_T + K_w}{1 + C_T/K_{a,1}}} $$\n现在代入数值：\n- $C_T = 0.050\\ \\mathrm{M}$\n- $K_{a,1} = 10^{-6.35} \\approx 4.467 \\times 10^{-7}$\n- $K_{a,2} = 10^{-10.33} \\approx 4.677 \\times 10^{-11}$\n- $K_w = 1.0 \\times 10^{-14}$\n\n计算分子：\n$$ K_{a,2}C_T + K_w = (4.677 \\times 10^{-11})(0.050) + 1.0 \\times 10^{-14} = 2.3385 \\times 10^{-12} + 1.0 \\times 10^{-14} = 2.3485 \\times 10^{-12} $$\n计算分母：\n$$ 1 + C_T/K_{a,1} = 1 + \\frac{0.050}{4.467 \\times 10^{-7}} \\approx 1 + 111932 = 111933 $$\n计算 $[\\mathrm{H}^+]^2$:\n$$ [\\mathrm{H}^+]^2 = \\frac{2.3485 \\times 10^{-12}}{111933} \\approx 2.0981 \\times 10^{-17} $$\n计算 $[\\mathrm{H}^+]$:\n$$ [\\mathrm{H}^+] = \\sqrt{2.0981 \\times 10^{-17}} \\approx 4.5805 \\times 10^{-9}\\ \\mathrm{mol}\\ \\mathrm{L}^{-1} $$\n最后计算 $\\mathrm{pH}$：\n$$ \\mathrm{pH} = -\\log_{10}(4.5805 \\times 10^{-9}) \\approx 8.33916 $$\n根据题目要求，将 $\\mathrm{pH}$ 值四舍五入至四位有效数字，得到：\n$$ \\mathrm{pH} = 8.339 $$", "answer": "$$\\boxed{8.339}$$", "id": "2951880"}, {"introduction": "理论分析和手动计算虽然重要，但现代化学问题的解决越来越依赖于计算工具。本练习 [@problem_id:2951873] 旨在将你的理解提升到一个新的层次：从解决特定问题到构建一个能够处理通用二元酸体系的普适性数值求解器。你将推导完整的控制方程，并实现一个稳健的牛顿-拉夫逊迭代算法，这不仅能加深你对平衡理论的理解，也为你提供了解决复杂化学问题的实用计算技能。", "problem": "您需要编写一个程序，仅使用第一性原理（平衡定义、质量守恒和电荷中性）来计算一种通用二元酸水溶液中的氢离子浓度 $[\\mathrm{H}^+]$。考虑一种通用的二元酸 $\\mathrm{H_2A}$，其在水中的逐步解离平衡由酸解离常数 $K_{\\mathrm{a1}}$ 和 $K_{\\mathrm{a2}}$ 表征，该温度下水的离子积为 $K_\\mathrm{w}$。酸的形式浓度（也称分析浓度）为 $C_\\mathrm{T}$，定义为 $C_\\mathrm{T} = [\\mathrm{H_2A}] + [\\mathrm{HA}^-] + [\\mathrm{A}^{2-}]$。不存在其他溶质。所有浓度均以 $\\mathrm{mol\\,L^{-1}}$ 表示。\n\n仅从以下定义出发：平衡常数、酸的质量平衡、溶液的电中性（电荷平衡）以及水的自电离，\n- 平衡常数：$K_{\\mathrm{a1}} = \\dfrac{[\\mathrm{H}^+][\\mathrm{HA}^-]}{[\\mathrm{H_2A}]}$，$K_{\\mathrm{a2}} = \\dfrac{[\\mathrm{H}^+][\\mathrm{A}^{2-}]}{[\\mathrm{HA}^-]}$，\n- 质量平衡：$C_\\mathrm{T} = [\\mathrm{H_2A}] + [\\mathrm{HA}^-] + [\\mathrm{A}^{2-}]$，\n- 水：$K_\\mathrm{w} = [\\mathrm{H}^+][\\mathrm{OH}^-]$，\n- 电中性：溶液中总正电荷等于总负电荷，\n推导出一个单一的非线性标量方程 $f([\\mathrm{H}^+]) = 0$，其具有物理意义的根给出氢离子浓度 $[\\mathrm{H}^+] > 0$。然后，您必须实现一个牛顿-拉夫逊迭代来求解此方程，通过保护迭代使其保持在物理允许域 $[\\mathrm{H}^+] > 0$ 内并遵守函数变号的括号区间，从而在实践中实现全局收敛。\n\n您的实现必须遵循以下算法规范：\n- 待求解变量：$[\\mathrm{H}^+]$，单位为 $\\mathrm{mol\\,L^{-1}}$。\n- 初始猜测值：基于单质子极限构建一个有原则的初始猜测值，其中忽略第二次解离但保留水的自电离。从控制方程中证明此选择的合理性；不要使用临时常数。\n- 保护措施：维持一个括号区间 $[H_\\mathrm{lo}, H_\\mathrm{hi}]$，其中 $H_\\mathrm{lo}  0$ 且 $f(H_\\mathrm{lo})  0  f(H_\\mathrm{hi})$（或相反），并确保牛顿步骤不会离开此区间；如果离开，则回退到二分法步骤。\n- 停止准则：当绝对残差容差和相对步长容差同时满足时停止，其中绝对函数容差为 $\\lvert f([\\mathrm{H}^+]) \\rvert \\le \\tau_f$，相对步长容差为 $\\dfrac{\\lvert \\Delta [\\mathrm{H}^+] \\rvert}{\\max(1, \\lvert [\\mathrm{H}^+] \\rvert)} \\le \\tau_x$。您应设置 $\\tau_f = 10^{-16}\\,\\mathrm{mol\\,L^{-1}}$ 和 $\\tau_x = 10^{-12}$，并将最大迭代次数限制为 $200$。\n\n您的程序必须为以下五个测试案例（每个由 $(K_{\\mathrm{a1}}, K_{\\mathrm{a2}}, C_\\mathrm{T}, K_\\mathrm{w})$ 指定，单位均为 $\\mathrm{mol\\,L^{-1}}$) 求解问题：\n- 测试 1（第一步中等强度，第二步弱）：$(1.0\\times 10^{-2},\\, 1.0\\times 10^{-7},\\, 1.0\\times 10^{-2},\\, 1.0\\times 10^{-14})$。\n- 测试 2（极弱酸；水占主导地位）：$(1.0\\times 10^{-7},\\, 1.0\\times 10^{-12},\\, 1.0\\times 10^{-3},\\, 1.0\\times 10^{-14})$。\n- 测试 3（极稀酸）：$(1.0\\times 10^{-6},\\, 1.0\\times 10^{-10},\\, 1.0\\times 10^{-8},\\, 1.0\\times 10^{-14})$。\n- 测试 4（浓酸；第一步接近强酸）：$(5.0\\times 10^{-1},\\, 1.0\\times 10^{-3},\\, 1.0,\\, 1.0\\times 10^{-14})$。\n- 测试 5（解离常数几乎相等）：$(1.0\\times 10^{-5},\\, 1.0\\times 10^{-5},\\, 1.0\\times 10^{-3},\\, 1.0\\times 10^{-14})$。\n\n最终输出格式：\n- 对于每个测试案例，计算您推导的方程的唯一正根 $[\\mathrm{H}^+]$，以 $\\mathrm{mol\\,L^{-1}}$ 表示。\n- 您的程序应生成单行输出，包含用方括号括起来的逗号分隔的结果列表，每个值使用科学记数法并保留恰好 $10$ 位有效数字。例如，预期的格式类似于 `[1.2345678900e-03,2.3456789000e-04]`（在文本输出中无单位，但所有值均代表 $\\mathrm{mol\\,L^{-1}}$）。", "solution": "所述问题需进行验证。\n\n### 步骤 1：提取给定信息\n\n问题为二元酸 $\\mathrm{H_2A}$ 的水溶液提供了以下控制原理和定义：\n- **平衡常数**：\n  - 第一次酸解离：$K_{\\mathrm{a1}} = \\dfrac{[\\mathrm{H}^+][\\mathrm{HA}^-]}{[\\mathrm{H_2A}]}$\n  - 第二次酸解离：$K_{\\mathrm{a2}} = \\dfrac{[\\mathrm{H}^+][\\mathrm{A}^{2-}]}{[\\mathrm{HA}^-]}$\n  - 水的自电离：$K_\\mathrm{w} = [\\mathrm{H}^+][\\mathrm{OH}^-]$\n- **守恒定律**：\n  - 酸物种的质量平衡：$C_\\mathrm{T} = [\\mathrm{H_2A}] + [\\mathrm{HA}^-] + [\\mathrm{A}^{2-}]$，其中 $C_\\mathrm{T}$ 是形式浓度。\n  - 电中性（电荷平衡）：正电荷浓度之和必须等于负电荷浓度之和。\n- **目标**：推导出一个关于氢离子浓度 $[\\mathrm{H}^+]$ 的单一非线性标量方程 $f([\\mathrm{H}^+]) = 0$，并使用带保护措施的牛顿-拉夫逊方法求解。\n- **数值规格**：\n  - 初始猜测值：基于包含水的自电离的单质子酸近似。\n  - 保护措施：维持一个括号区间并使用二分法回退。\n  - 容差：$\\tau_f = 10^{-16}\\,\\mathrm{mol\\,L^{-1}}$，$\\tau_x = 10^{-12}$。\n  - 最大迭代次数：$200$。\n- **测试案例**：提供了五组参数 $(K_{\\mathrm{a1}}, K_{\\mathrm{a2}}, C_\\mathrm{T}, K_\\mathrm{w})$。\n\n### 步骤 2：使用提取的给定信息进行验证\n\n根据验证标准对问题进行审查。\n\n- **科学基础**：该问题是物理化学中的一个经典练习，完全基于化学平衡、质量守恒和电荷中性的基本原理。所有原理都是标准的且事实正确。\n- **适定性**：该问题是适定的。从第一性原理出发的推导会得到一个关于单一变量 $[\\mathrm{H}^+]$ 的非线性方程。由于该函数被证明是单调的，因此存在唯一的正根，确保了唯一且稳定的解。\n- **客观性**：问题陈述精确、量化，没有主观或含糊的语言。\n- **完整性和一致性**：问题提供了推导和求解方程所需的所有定义、常数和约束。没有矛盾之处。\n- **可行性**：测试案例的参数值对于水溶液是物理上现实的。\n\n该问题不存在任何指定的缺陷。\n\n### 步骤 3：结论与行动\n\n该问题是**有效的**。将提供一个完整、合理的解决方案。\n\n### 控制方程的推导\n\n目标是找到氢离子浓度，我们将其表示为 $h \\equiv [\\mathrm{H}^+]$。所有其他可变浓度必须用 $h$ 和给定的常数 $K_{\\mathrm{a1}}$、$K_{\\mathrm{a2}}$、$C_\\mathrm{T}$ 和 $K_\\mathrm{w}$ 来表示。\n\n**1. 电荷平衡方程：**\n溶液中存在的离子有 $\\mathrm{H}^+$、$\\mathrm{OH}^-$、$\\mathrm{HA}^-$ 和 $\\mathrm{A}^{2-}$。电中性条件要求正电荷的总浓度等于负电荷的总浓度。\n$$[\\mathrm{H}^+] = [\\mathrm{OH}^-] + [\\mathrm{HA}^-] + 2[\\mathrm{A}^{2-}]$$\n$[\\mathrm{A}^{2-}]$ 的系数为 $2$ 是因为该离子携带 $-2$ 的电荷。\n\n**2. 用 $h$ 表示浓度：**\n- 从水的自电离，我们有：\n$$[\\mathrm{OH}^-] = \\frac{K_\\mathrm{w}}{h}$$\n- 为了用 $h$ 表示酸物种的浓度 $([\\mathrm{H_2A}], [\\mathrm{HA}^-], [\\mathrm{A}^{2-}])$，我们结合使用质量平衡方程和平衡常数定义。定义每个物种的分数 $\\alpha_i$ 会很方便：\n$$ \\alpha_0 = \\frac{[\\mathrm{H_2A}]}{C_\\mathrm{T}}, \\quad \\alpha_1 = \\frac{[\\mathrm{HA}^-]}{C_\\mathrm{T}}, \\quad \\alpha_2 = \\frac{[\\mathrm{A}^{2-}]}{C_\\mathrm{T}} $$\n根据平衡定义：\n$$[\\mathrm{HA}^-] = \\frac{K_{\\mathrm{a1}}[\\mathrm{H_2A}]}{h}$$\n$$[\\mathrm{A}^{2-}] = \\frac{K_{\\mathrm{a2}}[\\mathrm{HA}^-]}{h} = \\frac{K_{\\mathrm{a1}}K_{\\mathrm{a2}}[\\mathrm{H_2A}]}{h^2}$$\n将这些代入质量平衡方程 $C_\\mathrm{T} = [\\mathrm{H_2A}] + [\\mathrm{HA}^-] + [\\mathrm{A}^{2-}]$ 得到：\n$$C_\\mathrm{T} = [\\mathrm{H_2A}] \\left( 1 + \\frac{K_{\\mathrm{a1}}}{h} + \\frac{K_{\\mathrm{a1}}K_{\\mathrm{a2}}}{h^2} \\right) = [\\mathrm{H_2A}] \\left( \\frac{h^2 + K_{\\mathrm{a1}}h + K_{\\mathrm{a1}}K_{\\mathrm{a2}}}{h^2} \\right)$$\n令分母为 $D(h) = h^2 + K_{\\mathrm{a1}}h + K_{\\mathrm{a1}}K_{\\mathrm{a2}}$。现在我们可以用 $h$、$C_\\mathrm{T}$ 和平衡常数来表示 $[\\mathrm{H_2A}]$，并随后表示 $[\\mathrm{HA}^-]$ 和 $[\\mathrm{A}^{2-}]$：\n$$[\\mathrm{H_2A}] = C_\\mathrm{T} \\frac{h^2}{D(h)} \\implies \\alpha_0 = \\frac{h^2}{D(h)}$$\n$$[\\mathrm{HA}^-] = C_\\mathrm{T} \\frac{K_{\\mathrm{a1}}h}{D(h)} \\implies \\alpha_1 = \\frac{K_{\\mathrm{a1}}h}{D(h)}$$\n$$[\\mathrm{A}^{2-}] = C_\\mathrm{T} \\frac{K_{\\mathrm{a1}}K_{\\mathrm{a2}}}{D(h)} \\implies \\alpha_2 = \\frac{K_{\\mathrm{a1}}K_{\\mathrm{a2}}}{D(h)}$$\n\n**3. 最终的非线性方程：**\n将 $[\\mathrm{OH}^-]$、$[\\mathrm{HA}^-]$ 和 $[\\mathrm{A}^{2-}]$ 的这些表达式代回电荷平衡方程：\n$$h = \\frac{K_\\mathrm{w}}{h} + C_\\mathrm{T} \\frac{K_{\\mathrm{a1}}h}{h^2 + K_{\\mathrm{a1}}h + K_{\\mathrm{a1}}K_{\\mathrm{a2}}} + 2 C_\\mathrm{T} \\frac{K_{\\mathrm{a1}}K_{\\mathrm{a2}}}{h^2 + K_{\\mathrm{a1}}h + K_{\\mathrm{a1}}K_{\\mathrm{a2}}}$$\n我们定义函数 $f(h)$，使其根给出 $h$ 的解：\n$$f(h) = h - \\frac{K_\\mathrm{w}}{h} - C_\\mathrm{T} \\left( \\frac{K_{\\mathrm{a1}}h + 2K_{\\mathrm{a1}}K_{\\mathrm{a2}}}{h^2 + K_{\\mathrm{a1}}h + K_{\\mathrm{a1}}K_{\\mathrm{a2}}} \\right) = 0$$\n这是所需的非线性标量方程。具有物理意义的解是该方程唯一的正根。\n\n### 通过带保护措施的牛顿-拉夫逊方法进行数值求解\n\n牛顿-拉夫逊方法通过以下迭代方案找到 $f(h)=0$ 的根：\n$$h_{k+1} = h_k - \\frac{f(h_k)}{f'(h_k)}$$\n其中 $f'(h)$ 是 $f(h)$ 对 $h$ 的导数。\n\n**1. $f(h)$ 的导数：**\n导数计算如下：\n$$f'(h) = \\frac{d}{dh} \\left( h - K_\\mathrm{w}h^{-1} - C_\\mathrm{T} \\frac{N(h)}{D(h)} \\right)$$\n其中 $N(h) = K_{\\mathrm{a1}}h + 2K_{\\mathrm{a1}}K_{\\mathrm{a2}}}$ 且 $D(h) = h^2 + K_{\\mathrm{a1}}h + K_{\\mathrm{a1}}K_{\\mathrm{a2}}$。\n对第三项使用商法则：\n$$f'(h) = 1 + \\frac{K_\\mathrm{w}}{h^2} - C_\\mathrm{T} \\frac{N'(h)D(h) - N(h)D'(h)}{D(h)^2}$$\n其中 $N'(h) = K_{\\mathrm{a1}}$ 且 $D'(h) = 2h + K_{\\mathrm{a1}}$。经过代数化简，我们发现：\n$$N'(h)D(h) - N(h)D'(h) = -K_{\\mathrm{a1}}h^2 - 4K_{\\mathrm{a1}}K_{\\mathrm{a2}}h - K_{\\mathrm{a1}}^2 K_{\\mathrm{a2}}$$\n因此，导数为：\n$$f'(h) = 1 + \\frac{K_\\mathrm{w}}{h^2} + C_\\mathrm{T} \\frac{K_{\\mathrm{a1}}h^2 + 4K_{\\mathrm{a1}}K_{\\mathrm{a2}}h + K_{\\mathrm{a1}}^2 K_{\\mathrm{a2}}}{(h^2 + K_{\\mathrm{a1}}h + K_{\\mathrm{a1}}K_{\\mathrm{a2}})^2}$$\n对于任何物理相关参数（$C_\\mathrm{T} \\ge 0$，$K's  0$）和任何 $h  0$，$f'(h)$ 中的每一项都是非负的，且第一项为 $1$。因此，$f'(h)  0$。这证明了对于 $h0$，$f(h)$ 是一个严格单调递增的函数，从而保证了唯一的正根。\n\n**2. 初始猜测值 ($h_0$)：**\n根据规定，初始猜测值由单质子近似（$K_{\\mathrm{a2}}=0$）推导得出，并保留了水的自电离的贡献。电荷平衡简化为 $[\\mathrm{H}^+] = [\\mathrm{OH}^-] + [\\mathrm{HA}^-]$，这导致了三次方程：\n$$h^3 + K_{\\mathrm{a1}}h^2 - (K_{\\mathrm{a1}}C_\\mathrm{T} + K_\\mathrm{w})h - K_{\\mathrm{a1}}K_\\mathrm{w} = 0$$\n该方程恰好有一个正实根，它提供了一个有原则且稳健的初始猜测值 $h_0$。我们用数值方法求解这个多项式。\n\n**3. 括号区间 $[H_{\\mathrm{lo}}, H_{\\mathrm{hi}}]$：**\n一个包含根的严格括号区间对于保护机制至关重要。\n- **下界 ($H_{\\mathrm{lo}}$)：** 在纯水中（$C_\\mathrm{T}=0$），$h=\\sqrt{K_\\mathrm{w}}$。加入酸（$C_\\mathrm{T}0$）必然会增加 $h$。因此，根总是大于 $\\sqrt{K_\\mathrm{w}}$。在 $h = \\sqrt{K_\\mathrm{w}}$ 处，$f(\\sqrt{K_\\mathrm{w}}) = 0 - C_\\mathrm{T}(\\ldots) \\le 0$。因此，我们可以设置 $H_{\\mathrm{lo}} = \\sqrt{K_\\mathrm{w}}$。\n- **上界 ($H_{\\mathrm{hi}}$)：** 来自酸的阴离子浓度 $[\\mathrm{HA}^-] + 2[\\mathrm{A}^{2-}]$ 代表每升释放的质子量，不能超过 $2C_\\mathrm{T}$。从电荷平衡 $h = [\\mathrm{OH}^-] + ([\\mathrm{HA}^-] + 2[\\mathrm{A}^{2-}])$，我们有不等式 $h \\le K_\\mathrm{w}/h + 2C_\\mathrm{T}$。这可以重新整理为 $h^2 - 2C_\\mathrm{T}h - K_\\mathrm{w} \\le 0$。满足此条件的 $h$ 的最右正值是 $h^2 - 2C_\\mathrm{T}h - K_\\mathrm{w} = 0$ 的较大根，即 $h = C_\\mathrm{T} + \\sqrt{C_\\mathrm{T}^2 + K_\\mathrm{w}}$。在此值处，$f(h) \\ge 0$。因此，我们可以设置 $H_{\\mathrm{hi}} = C_\\mathrm{T} + \\sqrt{C_\\mathrm{T}^2 + K_\\mathrm{w}}$。\n根保证位于区间 $[\\sqrt{K_\\mathrm{w}}, C_\\mathrm{T} + \\sqrt{C_\\mathrm{T}^2 + K_\\mathrm{w}}]$ 内。\n\n**4. 算法实现：**\n算法流程如下：\n1. 用单质子三次方程的根 $h_0$ 初始化迭代。\n2. 初始化括号区间 $[H_{\\mathrm{lo}}, H_{\\mathrm{hi}}]$。\n3. 在每次迭代中，计算牛顿步长 $\\Delta h = -f(h)/f'(h)$。\n4. 设预期的下一次迭代值为 $h_{\\text{new}} = h + \\Delta h$。\n5. **保护措施：** 如果 $h_{\\text{new}}$ 超出当前括号区间 $(H_{\\mathrm{lo}}, H_{\\mathrm{hi}})$，则舍弃它，并改为执行一次二分法步骤：$h_{\\text{new}} = (H_{\\mathrm{lo}} + H_{\\mathrm{hi}})/2$。\n6. 更新当前迭代值：$h \\leftarrow h_{\\text{new}}$。\n7. 更新括号区间：如果 $f(h)  0$，则设置 $H_{\\mathrm{lo}} = h$；如果 $f(h) > 0$，则设置 $H_{\\mathrm{hi}} = h$。\n8. 检查收敛性：如果 $|f(h)| \\le \\tau_f$ 和 $|\\Delta h| / \\max(1, |h_{\\text{old}}|) \\le \\tau_x$ 同时满足，则停止。\n9. 如果未达到收敛，则从步骤 3 开始重复，直至达到最大迭代次数。\n\n这种混合的牛顿-二分法结合了牛顿-拉夫逊方法的快速局部收敛性和二分法的保证全局收敛性。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve_diprotic_acid_h_conc(Ka1, Ka2, CT, Kw, tau_f, tau_x, max_iter):\n    \"\"\"\n    Computes the hydrogen ion concentration [H+] for a diprotic acid solution\n    using a safeguarded Newton-Raphson method.\n\n    Args:\n        Ka1 (float): First acid dissociation constant.\n        Ka2 (float): Second acid dissociation constant.\n        CT (float): Formal concentration of the acid.\n        Kw (float): Ionic product of water.\n        tau_f (float): Absolute function residual tolerance.\n        tau_x (float): Relative step tolerance.\n        max_iter (int): Maximum number of iterations.\n\n    Returns:\n        float: The calculated hydrogen ion concentration [H+].\n    \"\"\"\n    if CT == 0.0:\n        return np.sqrt(Kw)\n\n    # Define the function f(h) = 0 and its derivative f'(h)\n    def f(h):\n        if h = 0:\n            return -np.inf\n        # Denominator for alpha fractions\n        den = h**2 + Ka1 * h + Ka1 * Ka2\n        if den == 0: # Avoid division by zero, though unlikely for h  0\n            return np.inf if Ka1  0 else h - Kw/h\n        # Charge balance equation: h - Kw/h - CT*(alpha1 + 2*alpha2) = 0\n        return h - Kw/h - CT * (Ka1 * h + 2 * Ka1 * Ka2) / den\n\n    def f_prime(h):\n        if h = 0:\n            return np.inf\n        # Denominator\n        den = h**2 + Ka1 * h + Ka1 * Ka2\n        if den == 0:\n            return np.inf\n        # Numerator of the derivative of the acid term\n        num_prime_term = Ka1 * h**2 + 4 * Ka1 * Ka2 * h + Ka1**2 * Ka2\n        return 1 + Kw/h**2 + CT * num_prime_term / den**2\n\n    # Step 1: Principled initial guess h_0 from monoprotic approximation\n    # h^3 + Ka1*h^2 - (Ka1*CT + Kw)*h - Ka1*Kw = 0\n    coeffs = [1, Ka1, -(Ka1 * CT + Kw), -Ka1 * Kw]\n    roots = np.roots(coeffs)\n    h_current = next((np.real(r) for r in roots if np.isreal(r) and r  0), np.sqrt(Kw + Ka1*CT))\n\n    # Step 2: Establish a rigorous bracketing interval\n    h_lo = np.sqrt(Kw)\n    h_hi = CT + np.sqrt(CT**2 + Kw)\n    \n    # Ensure initial guess is within the bracket for stability\n    if not (h_lo = h_current = h_hi):\n        h_current = (h_lo + h_hi) / 2.0\n\n    # Step 3: Safeguarded Newton-Raphson iteration\n    for i in range(max_iter):\n        h_old = h_current\n        fh = f(h_old)\n        \n        # Check for convergence on entry\n        if abs(fh) = tau_f:\n            break\n\n        fph = f_prime(h_old)\n\n        if fph = 0: # Should not occur; fallback to bisection\n            delta_h = (h_lo + h_hi) / 2.0 - h_old\n        else:\n            # Newton step\n            delta_h = -fh / fph\n\n        h_new = h_old + delta_h\n\n        # Safeguard: if Newton step is out of bounds, use bisection\n        if not (h_lo  h_new  h_hi):\n            h_new = (h_lo + h_hi) / 2.0\n            delta_h = h_new - h_old\n        \n        h_current = h_new\n\n        # Update bracketing interval\n        fh_new = f(h_current)\n        if fh_new  0:\n            h_lo = h_current\n        elif fh_new  0:\n            h_hi = h_current\n        else: # Found exact root\n            break\n\n        # Check for convergence based on the step just taken\n        rel_step_converged = abs(delta_h) / max(1.0, abs(h_old)) = tau_x\n        if rel_step_converged:\n            # Check function residual one last time after a small step\n            if abs(fh_new) = tau_f:\n                break\n            \n    return h_current\n\ndef solve():\n    \"\"\"\n    Main function to run the test cases and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (Ka1, Ka2, CT, Kw)\n    test_cases = [\n        (1.0e-2, 1.0e-7, 1.0e-2, 1.0e-14),\n        (1.0e-7, 1.0e-12, 1.0e-3, 1.0e-14),\n        (1.0e-6, 1.0e-10, 1.0e-8, 1.0e-14),\n        (5.0e-1, 1.0e-3, 1.0, 1.0e-14),\n        (1.0e-5, 1.0e-5, 1.0e-3, 1.0e-14),\n    ]\n\n    # Numerical parameters from the problem statement\n    tau_f = 1.0e-16\n    tau_x = 1.0e-12\n    max_iter = 200\n\n    results = []\n    for case in test_cases:\n        Ka1, Ka2, CT, Kw = case\n        h_plus = solve_diprotic_acid_h_conc(Ka1, Ka2, CT, Kw, tau_f, tau_x, max_iter)\n        results.append(\"{:.10e}\".format(h_plus))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2951873"}]}