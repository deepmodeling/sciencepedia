{"hands_on_practices": [{"introduction": "络合物的形成并非孤立发生，它常常与其他化学平衡相互关联，其中最常见的就是酸碱反应。本练习将引导你通过数学推导，揭示络合物的稳定性如何随溶液 $pH$ 值的变化而改变，并引入条件稳定常数（$K_f'$）这一关键概念 [@problem_id:2929570]。掌握这一技能是理解和预测真实水相体系中金属离子形态分布的基础。", "problem": "在恒定离子强度的水溶液中，含有一种中性的单齿碱性配体，记为 $L$，它是单质子的。在水中，$L$ 根据酸解离平衡\n$$\\text{HL}^{+} \\rightleftharpoons \\text{H}^{+} + L,$$\n被质子化为其共轭酸 $\\text{HL}^{+}$，其特征在于热力学酸解离常数 $K_{a}$，由质量作用定律定义为\n$$K_{a} = \\frac{a_{\\text{H}^{+}}\\,a_{L}}{a_{\\text{HL}^{+}}},$$\n其中 $a_{i}$ 表示物种 $i$ 的活度。酸度函数按常规方式定义：$pH \\equiv -\\log_{10}(a_{\\text{H}^{+}})$ 和 $pK_{a} \\equiv -\\log_{10}(K_{a})$。假设在所述条件下，活度可以用浓度来近似。设所有质子化状态下未络合配体的总浓度为 $C_{L}^{*} \\equiv [L] + [\\text{HL}^{+}]$。定义未质子化配体的分布分数为 $\\alpha_{L} \\equiv \\frac{[L]}{C_{L}^{*}}$。\n\n一种二价金属离子 $\\text{M}^{2+}$ 与 $L$ 根据以下反应形成一个 $1{:}1$ 的络合物\n$$\\text{M}^{2+} + L \\rightleftharpoons \\text{ML}^{2+},$$\n其逐级形成常数为\n$$K_{f} = \\frac{[\\text{ML}^{2+}]}{[\\text{M}^{2+}]\\,[L]}.$$\n假设只有 $L$（而非 $\\text{HL}^{+}$）能与 $\\text{M}^{2+}$ 显著结合。相对于未络合配体总量 $C_{L}^{*}$ 的条件（表观）形成常数定义为\n$$K_{f}' \\equiv \\frac{[\\text{ML}^{2+}]}{[\\text{M}^{2+}]\\,C_{L}^{*}}.$$\n\n仅使用上述定义和质量作用定律，首先推导用 $pK_{a}$ 和 $pH$ 表示的 $\\alpha_{L}$，然后推导 $K_{f}'$ 作为 $K_{f}$、$pK_{a}$ 和 $pH$ 的显式函数。将您的最终结果表示为关于 $K_{f}'(pH)$ 的一个单一闭式解析表达式，该表达式用 $K_{f}$、$pK_{a}$ 和 $pH$ 表示。无需进行数值计算。", "solution": "问题陈述已经过验证，被认为是科学上合理、提法良定、客观且自洽的。它提出了水溶液化学平衡研究中的一个标准问题。我们将按要求进行推导。\n\n任务是推导两个表达式。首先，用 $pH$ 和 $pK_{a}$ 表示未质子化配体 $\\alpha_{L}$ 的分布分数的表达式。其次，条件形成常数 $K_{f}'$ 作为热力学形成常数 $K_{f}$、$pK_{a}$ 和 $pH$ 的函数的表达式。\n\n第1部分：$\\alpha_{L}$ 的推导\n\n我们从配体 $L$ 的分布分数的定义开始：\n$$ \\alpha_{L} \\equiv \\frac{[L]}{C_{L}^{*}} $$\n未络合配体的总浓度 $C_{L}^{*}$ 给出为其质子化和未质子化形式的浓度之和：\n$$ C_{L}^{*} = [L] + [\\text{HL}^{+}] $$\n将此代入 $\\alpha_{L}$ 的定义，得出：\n$$ \\alpha_{L} = \\frac{[L]}{[L] + [\\text{HL}^{+}]} $$\n为了继续推导，我们必须将质子化形式的浓度 $[\\text{HL}^{+}]$ 与未质子化形式的浓度 $[L]$ 联系起来。这种关系由 $\\text{HL}^{+}$ 的酸解离平衡提供：\n$$ \\text{HL}^{+} \\rightleftharpoons \\text{H}^{+} + L $$\n在活度可用浓度近似的假设下，相应的酸解离常数 $K_{a}$ 为：\n$$ K_{a} = \\frac{[\\text{H}^{+}]\\,[L]}{[\\text{HL}^{+}]} $$\n重新整理此表达式以求解 $[\\text{HL}^{+}]$，得到：\n$$ [\\text{HL}^{+}] = \\frac{[\\text{H}^{+}]\\,[L]}{K_{a}} $$\n现在，我们将这个关于 $[\\text{HL}^{+}]$ 的表达式代回到 $\\alpha_{L}$ 的方程中：\n$$ \\alpha_{L} = \\frac{[L]}{[L] + \\frac{[\\text{H}^{+}]\\,[L]}{K_{a}}} $$\n项 $[L]$ 是分母中的一个公因式，可以提取出来：\n$$ \\alpha_{L} = \\frac{[L]}{[L] \\left( 1 + \\frac{[\\text{H}^{+}]}{K_{a}} \\right)} $$\n从分子和分母中消去 $[L]$ 项，我们得到一个用浓度和常数表示的 $\\alpha_{L}$ 表达式：\n$$ \\alpha_{L} = \\frac{1}{1 + \\frac{[\\text{H}^{+}]}{K_{a}}} $$\n问题要求用 $pH$ 和 $pK_{a}$ 表示此表达式。我们使用标准定义：\n$$ pH = -\\log_{10}([\\text{H}^{+}]) \\implies [\\text{H}^{+}] = 10^{-pH} $$\n$$ pK_{a} = -\\log_{10}(K_{a}) \\implies K_{a} = 10^{-pK_{a}} $$\n将这些代入 $\\alpha_{L}$ 的表达式中：\n$$ \\alpha_{L} = \\frac{1}{1 + \\frac{10^{-pH}}{10^{-pK_{a}}}} $$\n使用指数性质 $\\frac{10^{a}}{10^{b}} = 10^{a-b}$，该分数变为：\n$$ \\alpha_{L} = \\frac{1}{1 + 10^{-pH - (-pK_{a})}} = \\frac{1}{1 + 10^{pK_{a} - pH}} $$\n这是 $L$ 的分布分数作为 $pH$ 和 $pK_{a}$ 的函数的最终表达式。\n\n第2部分：$K_{f}'$ 的推导\n\n我们的任务是推导条件形成常数 $K_{f}'$ 的表达式，其定义为：\n$$ K_{f}' \\equiv \\frac{[\\text{ML}^{2+}]}{[\\text{M}^{2+}]\\,C_{L}^{*}} $$\n目标是将其与热力学形成常数 $K_{f}$ 联系起来，后者是为涉及未质子化配体 $L$ 的反应所定义的：\n$$ K_{f} = \\frac{[\\text{ML}^{2+}]}{[\\text{M}^{2+}]\\,[L]} $$\n通过处理 $K_{f}'$ 的表达式，可以建立 $K_{f}'$ 和 $K_{f}$ 之间的直接关系。我们可以通过乘以并除以 $[L]$ 来重写它：\n$$ K_{f}' = \\frac{[\\text{ML}^{2+}]}{[\\text{M}^{2+}]\\,[L]} \\cdot \\frac{[L]}{C_{L}^{*}} $$\n我们认出第一项是 $K_{f}$ 的定义，第二项是 $\\alpha_{L}$ 的定义：\n$$ K_{f}' = K_{f} \\cdot \\alpha_{L} $$\n这个基本方程表明，条件常数仅仅是热力学常数按反应物种 $L$ 的分布分数进行的缩放。\n\n现在，我们代入在第1部分中推导出的 $\\alpha_{L}$ 表达式：\n$$ K_{f}' = K_{f} \\left( \\frac{1}{1 + 10^{pK_{a} - pH}} \\right) $$\n这可以写成一个单一的分数形式：\n$$ K_{f}'(pH) = \\frac{K_{f}}{1 + 10^{pK_{a} - pH}} $$\n这就是所要求的条件形成常数 $K_{f}'$ 作为 $K_{f}$、$pK_{a}$ 和 $pH$ 的显式函数的闭式解析表达式。推导完成。", "answer": "$$\n\\boxed{\nK_{f}' = \\frac{K_{f}}{1 + 10^{pK_{a} - pH}}\n}\n$$", "id": "2929570"}, {"introduction": "在许多化学和生物环境中，多种潜在的配体常常会争夺同一种金属离子。本练习将挑战你为这样一个竞争体系建立一个普适的数学模型 [@problem_id:2929546]。通过推导与每种配体结合的金属离子所占的比例表达式，你将学会如何基于配体浓度和各自的稳定常数来量化这场“拔河比赛”的结果。", "problem": "在固定的离子强度和温度下，一种金属离子 $\\text{M}^{z+}$ 溶解在水中。存在两种单功能配体 $\\text{L}_1$ 和 $\\text{L}_2$，其自由浓度 $[\\text{L}_1]$ 和 $[\\text{L}_2]$ 是可控的。该金属仅与每种配体形成纯配体配合物（homoleptic complexes），即 $\\text{ML}_1{}_n$（其中 $n \\in \\{1,\\dots,N_1\\}$）和 $\\text{ML}_2{}_m$（其中 $m \\in \\{1,\\dots,N_2\\}$），不存在混合配体物种（即，不存在 $a \\geq 1$ 且 $b \\geq 1$ 的 $\\text{M}(\\text{L}_1)_a(\\text{L}_2)_b$）且不存在多核物种。假定活度系数已包含在稳定常数中。对于每种配体体系，根据质量作用定律，累积稳定常数（生成常数）定义如下：\n$$\n\\beta^{(1)}_{n} \\equiv \\frac{[\\text{ML}_1{}_n]}{[\\text{M}][\\text{L}_1]^{n}}, \\quad n=1,\\dots,N_1,\n\\qquad\n\\beta^{(2)}_{m} \\equiv \\frac{[\\text{ML}_2{}_m]}{[\\text{M}][\\text{L}_2]^{m}}, \\quad m=1,\\dots,N_2.\n$$\n设溶解金属的总（分析）浓度为 $[\\text{M}]_{\\mathrm{T}}$，并假设 $[\\text{L}_1]$ 和 $[\\text{L}_2]$ 表示自由配体浓度。仅从上述定义、质量作用定律以及金属的质量平衡出发，推导与 $\\text{L}_1$ 结合的总金属分数和与 $\\text{L}_2$ 结合的总金属分数作为 $[\\text{L}_1]$、$[\\text{L}_2]$、$\\{\\beta^{(1)}_{n}\\}_{n=1}^{N_1}$ 和 $\\{\\beta^{(2)}_{m}\\}_{m=1}^{N_2}$ 的函数的通用表达式。\n\n你的最终答案必须是表示为关于 $[\\text{L}_1]$、$[\\text{L}_2]$、$\\{\\beta^{(1)}_{n}\\}$ 和 $\\{\\beta^{(2)}_{m}\\}$ 的行矩阵的分数对。不需要进行数值计算，也不需要四舍五入。请以封闭形式的解析表达式给出最终答案。", "solution": "所述问题在科学上是合理的、提法恰当的、客观的且自洽的。它代表了溶液中化学平衡研究的一个标准模型体系。给定的定义和约束对于进行形式推导是充分且一致的。因此，我将着手构建解答。\n\n推导从质量守恒的基本原理开始。金属的总浓度 $[\\text{M}]_{\\mathrm{T}}$ 是溶液中所有含金属物种的浓度之和。根据问题陈述，这些物种是自由（水合）金属离子 $\\text{M}^{z+}$，以及两个系列的纯配体配合物 $\\text{ML}_1{}_n$ 和 $\\text{ML}_2{}_m$。因此，质量平衡方程为：\n$$\n[\\text{M}]_{\\mathrm{T}} = [\\text{M}] + \\sum_{n=1}^{N_1} [\\text{ML}_1{}_n] + \\sum_{m=1}^{N_2} [\\text{ML}_2{}_m]\n$$\n配合物物种的浓度由质量作用定律通过给定的累积稳定常数 $\\beta^{(1)}_{n}$ 和 $\\beta^{(2)}_{m}$ 来定义。我们可以用金属的自由浓度 $[\\text{M}]$ 和相应配体（$[\\text{L}_1]$ 或 $[\\text{L}_2]$）的自由浓度来表示每种配合物的浓度。\n对于与配体 $\\text{L}_1$ 形成的配合物：\n$$\n[\\text{ML}_1{}_n] = \\beta^{(1)}_{n} [\\text{M}] [\\text{L}_1]^{n}, \\quad \\text{for } n=1, \\dots, N_1\n$$\n对于与配体 $\\text{L}_2$ 形成的配合物：\n$$\n[\\text{ML}_2{}_m] = \\beta^{(2)}_{m} [\\text{M}] [\\text{L}_2]^{m}, \\quad \\text{for } m=1, \\dots, N_2\n$$\n将这些表达式代入质量平衡方程，得到：\n$$\n[\\text{M}]_{\\mathrm{T}} = [\\text{M}] + \\sum_{n=1}^{N_1} \\left( \\beta^{(1)}_{n} [\\text{M}] [\\text{L}_1]^{n} \\right) + \\sum_{m=1}^{N_2} \\left( \\beta^{(2)}_{m} [\\text{M}] [\\text{L}_2]^{m} \\right)\n$$\n自由金属离子的浓度 $[\\text{M}]$ 是右侧所有项的公因子。将此项提出，可得到总金属浓度和自由金属浓度之间的关系：\n$$\n[\\text{M}]_{\\mathrm{T}} = [\\text{M}] \\left( 1 + \\sum_{n=1}^{N_1} \\beta^{(1)}_{n} [\\text{L}_1]^{n} + \\sum_{m=1}^{N_2} \\beta^{(2)}_{m} [\\text{L}_2]^{m} \\right)\n$$\n问题要求推导与配体 $\\text{L}_1$ 结合的总金属分数（我们将其记为 $\\Phi_1$）和与配体 $\\text{L}_2$ 结合的总金属分数（记为 $\\Phi_2$）的表达式。\n\n首先，我们定义与 $\\text{L}_1$ 形成配合物的金属总浓度：\n$$\n[\\text{M}]_{\\text{bound}, 1} = \\sum_{n=1}^{N_1} [\\text{ML}_1{}_n] = \\sum_{n=1}^{N_1} \\beta^{(1)}_{n} [\\text{M}] [\\text{L}_1]^{n} = [\\text{M}] \\sum_{n=1}^{N_1} \\beta^{(1)}_{n} [\\text{L}_1]^{n}\n$$\n分数 $\\Phi_1$ 是该量与总金属浓度 $[\\text{M}]_{\\mathrm{T}}$ 的比值：\n$$\n\\Phi_1 = \\frac{[\\text{M}]_{\\text{bound}, 1}}{[\\text{M}]_{\\mathrm{T}}} = \\frac{[\\text{M}] \\sum_{n=1}^{N_1} \\beta^{(1)}_{n} [\\text{L}_1]^{n}}{[\\text{M}] \\left( 1 + \\sum_{n=1}^{N_1} \\beta^{(1)}_{n} [\\text{L}_1]^{n} + \\sum_{m=1}^{N_2} \\beta^{(2)}_{m} [\\text{L}_2]^{m} \\right)}\n$$\n自由金属浓度 $[\\text{M}]$ 同时出现在分子和分母中，因此可以消去。这个消去至关重要，因为它使得该分数独立于总金属浓度，而仅依赖于自由配体浓度和稳定常数。由此得到的 $\\Phi_1$ 的表达式为：\n$$\n\\Phi_1 = \\frac{\\sum_{n=1}^{N_1} \\beta^{(1)}_{n} [\\text{L}_1]^{n}}{1 + \\sum_{n=1}^{N_1} \\beta^{(1)}_{n} [\\text{L}_1]^{n} + \\sum_{m=1}^{N_2} \\beta^{(2)}_{m} [\\text{L}_2]^{m}}\n$$\n通过完全相同的推理思路，我们定义与 $\\text{L}_2$ 形成配合物的金属总浓度：\n$$\n[\\text{M}]_{\\text{bound}, 2} = \\sum_{m=1}^{N_2} [\\text{ML}_2{}_m] = \\sum_{m=1}^{N_2} \\beta^{(2)}_{m} [\\text{M}] [\\text{L}_2]^{m} = [\\text{M}] \\sum_{m=1}^{N_2} \\beta^{(2)}_{m} [\\text{L}_2]^{m}\n$$\n分数 $\\Phi_2$ 是该浓度与总金属浓度 $[\\text{M}]_{\\mathrm{T}}$ 的比值：\n$$\n\\Phi_2 = \\frac{[\\text{M}]_{\\text{bound}, 2}}{[\\text{M}]_{\\mathrm{T}}} = \\frac{[\\text{M}] \\sum_{m=1}^{N_2} \\beta^{(2)}_{m} [\\text{L}_2]^{m}}{[\\text{M}] \\left( 1 + \\sum_{n=1}^{N_1} \\beta^{(1)}_{n} [\\text{L}_1]^{n} + \\sum_{m=1}^{N_2} \\beta^{(2)}_{m} [\\text{L}_2]^{m} \\right)}\n$$\n同样，$[\\text{M}]$ 项被消去，得到 $\\Phi_2$ 的最终表达式：\n$$\n\\Phi_2 = \\frac{\\sum_{m=1}^{N_2} \\beta^{(2)}_{m} [\\text{L}_2]^{m}}{1 + \\sum_{n=1}^{N_1} \\beta^{(1)}_{n} [\\text{L}_1]^{n} + \\sum_{m=1}^{N_2} \\beta^{(2)}_{m} [\\text{L}_2]^{m}}\n$$\n推导出的这两个表达式，即 $\\Phi_1$ 和 $\\Phi_2$ 的表达式，构成了问题的完整解答。它们将金属离子在两类配合物体系间的分配表示为指定变量的函数。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\sum_{n=1}^{N_1} \\beta^{(1)}_{n} [\\mathrm{L_1}]^{n}}{1 + \\sum_{n=1}^{N_1} \\beta^{(1)}_{n} [\\mathrm{L_1}]^{n} + \\sum_{m=1}^{N_2} \\beta^{(2)}_{m} [\\mathrm{L_2}]^{m}}  \\frac{\\sum_{m=1}^{N_2} \\beta^{(2)}_{m} [\\mathrm{L_2}]^{m}}{1 + \\sum_{n=1}^{N_1} \\beta^{(1)}_{n} [\\mathrm{L_1}]^{n} + \\sum_{m=1}^{N_2} \\beta^{(2)}_{m} [\\mathrm{L_2}]^{m}} \\end{pmatrix}}\n$$", "id": "2929546"}, {"introduction": "本章的最后一个练习将处理一个接近真实化学体系复杂度的情景，其中多种竞争性过程——金属离子水解、配体质子化和络合作用——同时发生。当纯粹的解析解变得异常繁琐时，本练习将引导你超越这一局限，进入计算化学的领域 [@problem_id:2929503]。你将构建完整的方程组，并构思一种数值方法来求解，这是现代化学研究中一项至关重要的技能。", "problem": "给定一个水溶液中的金属-配体体系，其中金属会发生水解，配体是多质子的。从逐级和累积平衡常数的定义以及质量守恒定律出发，推导一个同时考虑金属水解和配体质子化的组合形成函数。然后，编写一个程序，对于每个指定的参数集和固定的氢离子电位 (pH) 值，数值求解在该 pH 值下每个金属中心结合的配体分子的平均数，记为 $\\bar{n}$。\n\n使用的基本原理：\n- 络合反应的累积形成常数定义：如果 $M$ 是游离金属，$L$ 是去质子化的游离配体，那么对于 $ML$ 和 $ML_{2}$，累积形成常数 $\\beta_{1}$ 和 $\\beta_{2}$ 满足 $[ML] = \\beta_{1}[M][L]$ 和 $[ML_{2}] = \\beta_{2}[M][L]^{2}$。\n- 相对于 $\\mathrm{H}^{+}$ 表示的逐级水解常数定义：对于 $M + \\mathrm{H}_{2}O \\rightleftharpoons MOH + \\mathrm{H}^{+}$ 和 $MOH + \\mathrm{H}_{2}O \\rightleftharpoons M(OH)_{2} + \\mathrm{H}^{+}$，逐级常数 $K_{h1}$ 和 $K_{h2}$ 定义为 $[MOH] = K_{h1}\\,[M]/[\\mathrm{H}^{+}]$ 和 $[M(OH)_{2}] = K_{h1}K_{h2}\\,[M]/[\\mathrm{H}^{+}]^{2}$。\n- 二元质子配体的逐级酸解离常数定义：对于 $HL \\rightleftharpoons \\mathrm{H}^{+} + L$ 和 $H_{2}L \\rightleftharpoons \\mathrm{H}^{+} + HL$，解离常数 $K_{a1}$ 和 $K_{a2}$ 满足 $[HL] = ([\\mathrm{H}^{+}]/K_{a1})[L]$ 和 $[H_{2}L] = ([\\mathrm{H}^{+}]^{2}/(K_{a1}K_{a2}))[L]$。\n- 金属和配体总浓度的物料平衡关系，其中“总”浓度计算了溶液中该元素所有化学形态的总和。\n- 氢离子电位 (pH) 的定义：$\\mathrm{pH} = -\\log_{10}([\\mathrm{H}^{+}])$。\n\n推导任务：\n- 仅使用上述定义和质量守恒定律，在固定的 $\\mathrm{pH}$ 值下，推导一个关于未知游离浓度 $[M]$ 和 $[L]$ 的代数方程组，该方程组足以确定 $\\bar{n}$。您必须首先将金属和配体的副反应系数表示为 $[\\mathrm{H}^{+}]$ 的函数：\n  - $\\alpha_{M}([\\mathrm{H}^{+}])$，它考虑了 $M$、$MOH$ 和 $M(OH)_{2}$。\n  - $\\alpha_{L}([\\mathrm{H}^{+}])$，它考虑了 $L$、$HL$ 和 $H_{2}L$。\n- 然后，将 $\\bar{n}$ 定义为与金属结合的配体总浓度与被配体结合的金属总浓度之比（两者均不包括纯粹水解或纯粹质子化的物种），并用求解出的浓度和副反应系数来表示 $\\bar{n}$。\n\n计算任务：\n- 实现一个数值求解器，输入参数集，由 $\\mathrm{pH}$ 计算 $[\\mathrm{H}^{+}]​$，并求解 $[M]$ 和 $[L]$，同时确保非负性。使用求解结果计算推导出的 $\\bar{n}$。\n- 所有浓度必须以摩尔浓度（即 $\\mathrm{mol}\\,\\mathrm{L}^{-1}$）处理。\n- 最终报告的 $\\bar{n}$ 是无量纲的，并且必须以小数点后保留 $6$ 位的小数形式输出。\n\n测试套件：\n对于所有测试，假设温度恒定，因此活度系数可视为 1，水的活度也视为 1。使用以下四组参数集，每组指定为一个有序元组 $(C_{M}^{T}, C_{L}^{T}, \\beta_{1}, \\beta_{2}, K_{h1}, K_{h2}, K_{a1}, K_{a2}, \\mathrm{pH})$：\n- 测试 1：($1.0\\times 10^{-4}$, $5.0\\times 10^{-4}$, $1.0\\times 10^{6}$, $1.0\\times 10^{11}$, $1.0\\times 10^{-9}$, $3.0\\times 10^{-9}$, $1.0\\times 10^{-4}$, $1.0\\times 10^{-9}$, $5.50$)。\n- 测试 2：($1.0\\times 10^{-4}$, $5.0\\times 10^{-4}$, $1.0\\times 10^{6}$, $1.0\\times 10^{11}$, $1.0\\times 10^{-9}$, $3.0\\times 10^{-9}$, $1.0\\times 10^{-4}$, $1.0\\times 10^{-9}$, $2.00$)。\n- 测试 3：($1.0\\times 10^{-4}$, $5.0\\times 10^{-4}$, $1.0\\times 10^{6}$, $1.0\\times 10^{11}$, $1.0\\times 10^{-9}$, $3.0\\times 10^{-9}$, $1.0\\times 10^{-4}$, $1.0\\times 10^{-9}$, $11.00$)。\n- 测试 4：($2.0\\times 10^{-5}$, $3.0\\times 10^{-5}$, $1.0\\times 10^{3}$, $1.0\\times 10^{5}$, $1.0\\times 10^{-8}$, $1.0\\times 10^{-9}$, $1.0\\times 10^{-5}$, $1.0\\times 10^{-8}$, $7.00$)。\n\n其中：\n- $C_{M}^{T}$ 是金属的总分析浓度，单位为 $\\mathrm{mol}\\,\\mathrm{L}^{-1}$。\n- $C_{L}^{T}$ 是配体的总分析浓度，单位为 $\\mathrm{mol}\\,\\mathrm{L}^{-1}$。\n- $\\beta_{1}$ 和 $\\beta_{2}$ 分别是 $ML$ 和 $ML_{2}$ 的累积形成常数。\n- $K_{h1}$ 和 $K_{h2}$ 是如上定义的、相对于 $\\mathrm{H}^{+}$ 的逐级水解常数。\n- $K_{a1}$ 和 $K_{a2}$ 是配体的酸解离常数。\n- $\\mathrm{pH}$ 是无量纲的。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含按上述测试顺序排列的结果，形式为方括号括起来的逗号分隔列表，每个 $\\bar{n}$ 值都精确四舍五入到小数点后 $6$ 位（例如，$[0.123456, 1.234567, 0.000001, 2.000000]$）。", "solution": "问题陈述已经过严格审查，并被认为是有效的。它在科学上基于化学平衡原理，问题定义良好，有足够的信息得到唯一解，并以客观、正式的语言表述。因此，我们可以继续进行推导和求解。\n\n任务是推导一个金属-配体体系的形成函数 $\\bar{n}$，该函数需考虑金属水解和配体质子化的竞争平衡。这需要求解所有物种的平衡浓度。\n\n首先，我们建立物料平衡方程。金属的总分析浓度 $C_M^T$ 是所有含金属物种的浓度之和：\n$$\nC_M^T = [M] + [MOH] + [M(OH)_2] + [ML] + [ML_2]\n$$\n同样，配体的总分析浓度 $C_L^T$ 是所有含配体物种的浓度之和，并考虑了化学计量：\n$$\nC_L^T = [L] + [HL] + [H_2L] + [ML] + 2[ML_2]\n$$\n此处，$[M]$ 是游离金属离子的浓度，$[L]$ 是完全去质子化的游离配体的浓度。\n\n接下来，使用给定的平衡常数定义，我们将每个物种的浓度用 $[M]$、$[L]$ 和氢离子浓度 $[\\text{H}^+]$ 来表示。问题中固定了氢离子电位 $\\mathrm{pH}$，因此 $[\\text{H}^+]$ 是一个由 $[\\text{H}^+] = 10^{-\\mathrm{pH}}$ 给出的常数参数。\n\n水解金属物种：\n$$[MOH] = \\frac{K_{h1}}{[\\text{H}^+]}[M]$$\n$$[M(OH)_2] = \\frac{K_{h1}K_{h2}}{([\\text{H}^+])^2}[M]$$\n\n质子化配体物种：\n$$[HL] = \\frac{[\\text{H}^+]}{K_{a1}}[L]$$\n$$[H_2L] = \\frac{([\\text{H}^+])^2}{K_{a1}K_{a2}}[L]$$\n\n金属-配体络合物：\n$$[ML] = \\beta_1[M][L]$$\n$$[ML_2] = \\beta_2[M][L]^2$$\n\n为简化物料平衡方程，我们引入副反应系数 $\\alpha_M$ 和 $\\alpha_L$，它们分别考虑了未参与主络合反应的所有金属形态和配体形态。\n\n金属的副反应系数 $\\alpha_M([\\mathrm{H}^{+}])$ 考虑了水解反应：\n$$\n\\alpha_M([\\mathrm{H}^{+}]) = \\frac{[M] + [MOH] + [M(OH)_2]}{[M]} = 1 + \\frac{K_{h1}}{[\\text{H}^+]} + \\frac{K_{h1}K_{h2}}{([\\text{H}^+])^2}\n$$\n配体的副反应系数 $\\alpha_L([\\mathrm{H}^{+}])$ 考虑了质子化反应：\n$$\n\\alpha_L([\\mathrm{H}^{+}]) = \\frac{[L] + [HL] + [H_2L]}{[L]} = 1 + \\frac{[\\text{H}^+]}{K_{a1}} + \\frac{([\\text{H}^+])^2}{K_{a1}K_{a2}}\n$$\n由于 $\\mathrm{pH}$ 是固定的，对于给定的计算，$\\alpha_M$ 和 $\\alpha_L$ 是常数。\n\n将这些表达式代入物料平衡方程，得到一个包含两个未知数 $[M]$ 和 $[L]$ 的非线性代数方程组：\n$$\nC_M^T = [M]\\alpha_M([\\mathrm{H}^{+}]) + \\beta_1[M][L] + \\beta_2[M][L]^2 \\quad \\text{(1)}\n$$\n$$\nC_L^T = [L]\\alpha_L([\\mathrm{H}^{+}]) + \\beta_1[M][L] + 2\\beta_2[M][L]^2 \\quad \\text{(2)}\n$$\n从方程 (1) 中，我们可以将 $[M]$ 表示为 $[L]$ 的函数：\n$$\n[M] = \\frac{C_M^T}{\\alpha_M([\\mathrm{H}^{+}]) + \\beta_1[L] + \\beta_2[L]^2} \\quad \\text{(3)}\n$$\n将此式代入方程 (2) 消去 $[M]$，得到一个只含单一未知数 $[L]$ 的方程：\n$$\nC_L^T = [L]\\alpha_L([\\mathrm{H}^{+}]) + \\left( \\frac{C_M^T}{\\alpha_M([\\mathrm{H}^{+}]) + \\beta_1[L] + \\beta_2[L]^2} \\right) \\left( \\beta_1[L] + 2\\beta_2[L]^2 \\right)\n$$\n该方程可以重排为一个求根问题 $f([L]) = 0$：\n$$\nf([L]) = C_L^T - [L]\\alpha_L([\\mathrm{H}^{+}]) - C_M^T \\frac{\\beta_1[L] + 2\\beta_2[L]^2}{\\alpha_M([\\mathrm{H}^{+}]) + \\beta_1[L] + \\beta_2[L]^2} = 0\n$$\n该方程必须通过数值方法求解 $[L]$。在区间 $0  [L]  C_L^T$ 内存在一个唯一的、具有物理意义的解。\n\n问题为平均配位数 $\\bar{n}$ 提供了特定定义：“与金属结合的配体总浓度与被配体结合的金属总浓度之比”。这可以表示为：\n$$\n\\bar{n} = \\frac{\\text{结合配体的总浓度}}{\\text{络合金属的总浓度}}\n$$\n分子是络合物中配体分子的总和，按化学计量加权：$[ML] + 2[ML_2]$。分母是作为络合物一部分的所有金属离子的总和：$[ML] + [ML_2]$。\n$$\n\\bar{n} = \\frac{[ML] + 2[ML_2]}{[ML] + [ML_2]}\n$$\n必须指出，这不是标准的 Bjerrum 形成函数，后者的分母是总金属浓度 $C_M^T$。所指定的量代表每个络合金属中心的平均配体数，而不是体系中每个总金属中心的平均配体数。遵循问题的明确指示，我们代入平衡表达式：\n$$\n\\bar{n} = \\frac{\\beta_1[M][L] + 2\\beta_2[M][L]^2}{\\beta_1[M][L] + \\beta_2[M][L]^2}\n$$\n将分子和分母同除以 $[M]$，得到一个仅依赖于 $[L]$ 和形成常数的简化表达式：\n$$\n\\bar{n} = \\frac{\\beta_1[L] + 2\\beta_2[L]^2}{\\beta_1[L] + \\beta_2[L]^2}\n$$\n计算步骤如下：\n1. 对每组参数集，计算常数 $[\\text{H}^+]$、$\\alpha_M([\\mathrm{H}^{+}])$ 和 $\\alpha_L([\\mathrm{H}^{+}])$ 的值。\n2. 数值求解方程 $f([L]) = 0$ 以找到平衡时的游离配体浓度 $[L]$。\n3. 使用求解得到的 $[L]$ 值，通过推导出的公式计算 $\\bar{n}$。\n4. 报告结果，四舍五入到小数点后六位。\n\n此程序构成了对所提出问题的完整而严谨的解决方案。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Solves for the average ligand number in a metal-ligand system\n    with competing hydrolysis and protonation equilibria for a set of test cases.\n    \"\"\"\n    \n    # Test cases defined as tuples:\n    # (C_M_T, C_L_T, beta_1, beta_2, K_h1, K_h2, K_a1, K_a2, pH)\n    test_cases = [\n        (1.0e-4, 5.0e-4, 1.0e6, 1.0e11, 1.0e-9, 3.0e-9, 1.0e-4, 1.0e-9, 5.50),\n        (1.0e-4, 5.0e-4, 1.0e6, 1.0e11, 1.0e-9, 3.0e-9, 1.0e-4, 1.0e-9, 2.00),\n        (1.0e-4, 5.0e-4, 1.0e6, 1.0e11, 1.0e-9, 3.0e-9, 1.0e-4, 1.0e-9, 11.00),\n        (2.0e-5, 3.0e-5, 1.0e3, 1.0e5, 1.0e-8, 1.0e-9, 1.0e-5, 1.0e-8, 7.00),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        C_M_T, C_L_T, beta_1, beta_2, K_h1, K_h2, K_a1, K_a2, pH = case\n        \n        # 1. Pre-calculation of constants based on pH\n        H_conc = 10**(-pH)\n        \n        # Side-reaction coefficient for the metal (hydrolysis)\n        alpha_M = 1.0 + (K_h1 / H_conc) + ((K_h1 * K_h2) / (H_conc**2))\n        \n        # Side-reaction coefficient for the ligand (protonation)\n        alpha_L = 1.0 + (H_conc / K_a1) + ((H_conc**2) / (K_a1 * K_a2))\n        \n        # 2. Define the function f([L]) = 0 to be solved for free ligand concentration [L]\n        def objective_function(L_conc):\n            if L_conc == 0:\n                # To handle edge cases in the solver, technically L_conc > 0\n                return C_L_T\n            \n            numerator_complex_term = beta_1 * L_conc + 2 * beta_2 * L_conc**2\n            denominator_complex_term = alpha_M + beta_1 * L_conc + beta_2 * L_conc**2\n            \n            if denominator_complex_term == 0:\n                # Avoid division by zero, though unlikely with positive constants\n                return np.inf\n\n            return C_L_T - L_conc * alpha_L - C_M_T * (numerator_complex_term / denominator_complex_term)\n\n        # 3. Numerically solve for [L]\n        # The root must be between 0 and C_L_T.\n        # We use a small positive number to avoid issues at L_conc=0.\n        try:\n            sol = root_scalar(objective_function, bracket=(1e-20, C_L_T), method='brentq')\n            L_conc_eq = sol.root\n        except ValueError:\n            # If the signs at the bracket ends are the same, it indicates an issue.\n            # This might happen if complexation is negligible and [L] is extremely small.\n            # In such a case, objective_function(C_L_T) might be positive.\n            # We can try to find the root in a smaller interval.\n            sol = root_scalar(objective_function, x0=1e-15, x1=C_L_T, method='secant')\n            L_conc_eq = sol.root\n\n        # 4. Calculate n_bar using the derived formula\n        # n_bar = (beta1*[L] + 2*beta2*[L]^2) / (beta1*[L] + beta2*[L]^2)\n        numerator_n_bar = beta_1 * L_conc_eq + 2 * beta_2 * L_conc_eq**2\n        denominator_n_bar = beta_1 * L_conc_eq + beta_2 * L_conc_eq**2\n        \n        if denominator_n_bar > 0:\n            n_bar = numerator_n_bar / denominator_n_bar\n        else:\n            # This case happens when no complexes are formed ([L] is effectively zero)\n            # The limit of n_bar as [L]->0 is 1, provided beta_1 is not zero.\n            n_bar = 1.0\n            \n        # Format and store result\n        results.append(f\"{n_bar:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2929503"}]}