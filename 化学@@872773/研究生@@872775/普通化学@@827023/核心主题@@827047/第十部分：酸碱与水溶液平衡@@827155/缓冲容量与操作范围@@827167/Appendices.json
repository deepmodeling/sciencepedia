{"hands_on_practices": [{"introduction": "滴定曲线的斜率与缓冲容量之间存在着一种深刻但常被误解的关系。一个常见的误解是，滴定曲线的“拐点”出现在 $pH = pK_{a}$ 处，也就是缓冲能力最强的点。本练习旨在通过严格的数学推导，揭示滴定曲线斜率 $\\frac{d(pH)}{dn}$ 与缓冲容量 $\\beta$ 之间的反比关系，从而澄清这一概念。通过本练习，你将理解为什么缓冲能力最强的点（曲线最平坦处）与用于确定化学计量点的操作拐点（曲线最陡峭处）并非同一点 [@problem_id:2925491]。", "problem": "将一份含有初始摩尔数为 $N_{0}$、体积为 $V_{0}$ 的一元弱酸 $HA$ 溶液，用浓度为 $C_{b}$ 的强碱进行滴定，加入的强碱体积为 $V_{b}$。令 $n \\equiv C_{b} V_{b}$ 表示加入的强碱的摩尔数。将滴定路径上的缓冲容量（范斯莱克缓冲指数）操作性地定义为微分比\n$$\\beta \\equiv \\frac{d n}{d\\,\\mathrm{pH}},$$\n即，在滴定过程中某一点的当前组成下，使 $\\mathrm{pH}$ 值改变一个单位所需的强碱当量数。考虑滴定曲线 $\\mathrm{pH}$ 是关于 $n$ 的函数，在通常条件下，当 $0 \\le n \\le N_{0}$ 时，该曲线是光滑且严格递增的。为本题目的，将滴定曲线上斜率 $d\\,\\mathrm{pH}/d n$ 达到最大值的点称为“操作拐点”（该点在分析上通常用于定位等当点区域）。\n\n关于操作拐点相对于 $pH = pK_{a}$ 的位置及其与滴定过程中 $\\beta$ 分布图的关系，下列哪个陈述是正确的？选择所有适用项。\n\nA. 操作拐点与 $pH = pK_{a}$ 重合，因为在半中和点时 $[HA] = [A^{-}]$，使得缓冲液最有效，因此滴定曲线在此处变化最剧烈。\n\nB. 操作拐点满足 $\\beta$ 关于 $\\mathrm{pH}$ 的平稳性条件，并且对应于滴定路径上 $\\beta$ 的一个局部最小值；这使其位于等当点区域附近，而不是在 $pH = pK_{a}$ 处。\n\nC. 条件 $pH = pK_{a}$ 对应于滴定路径上 $\\beta$ 的一个局部最大值，因此对应于斜率 $d\\,\\mathrm{pH}/d n$ 的一个局部最小值；故该点不是操作拐点。\n\nD. 只有当同时考虑稀释效应和水的自电离时，操作拐点才会偏离 $pH = pK_{a}$；如果忽略这些效应，最大斜率点恰好在 $pH = pK_{a}$ 处。\n\nE. 在弱酸-强碱滴定过程中，$\\beta$ 作为 $\\mathrm{pH}$ 的函数通常表现出两个平稳点：一个在 $pH \\approx pK_{a}$ 附近的局部最大值，以及一个在等当点区域附近的局部最小值；因此，滴定曲线相对于 $n$ 有两个数学上的拐点，但只有后者（与 $\\beta$ 的局部最小值相关联的那个）是用于定位等当点的操作拐点。", "solution": "我们从定义以及支配酸碱平衡和缓冲容量的一般物理定律出发。\n\n1) 根据定义，\n$$\\beta \\equiv \\frac{d n}{d\\,\\mathrm{pH}},$$\n因此，以 $n$ 为自变量的滴定曲线的斜率为\n$$\\frac{d\\,\\mathrm{pH}}{d n} = \\frac{1}{\\beta}.$$\n这个恒等式直接源于定义以及可微单调函数的反函数定理。\n\n2) 此处操作拐点被定义为斜率 $d\\,\\mathrm{pH}/d n$ 达到最大值的点。为找到此点，考虑斜率关于 $n$ 的导数：\n$$\\frac{d}{d n}\\!\\left(\\frac{d\\,\\mathrm{pH}}{d n}\\right) = \\frac{d^{2}\\,\\mathrm{pH}}{d n^{2}}.$$\n使用 $\\frac{d\\,\\mathrm{pH}}{d n} = \\beta^{-1}$ 和链式法则，\n$$\\frac{d^{2}\\,\\mathrm{pH}}{d n^{2}} = \\frac{d}{d n}\\!\\left(\\beta^{-1}\\right) = -\\,\\beta^{-2}\\,\\frac{d\\beta}{d n}.$$\n再次对 $d\\beta/d n$ 应用链式法则，得到\n$$\\frac{d\\beta}{d n} = \\frac{d\\beta}{d\\,\\mathrm{pH}}\\,\\frac{d\\,\\mathrm{pH}}{d n} = \\frac{1}{\\beta}\\,\\frac{d\\beta}{d\\,\\mathrm{pH}}.$$\n因此，\n$$\\frac{d^{2}\\,\\mathrm{pH}}{d n^{2}} = -\\,\\frac{1}{\\beta^{3}}\\,\\frac{d\\beta}{d\\,\\mathrm{pH}}.$$\n斜率的一个平稳点（即 $d\\,\\mathrm{pH}/d n$ 的最大值或最小值的候选点）满足\n$$\\frac{d^{2}\\,\\mathrm{pH}}{d n^{2}} = 0 \\quad \\Longleftrightarrow \\quad \\frac{d\\beta}{d\\,\\mathrm{pH}} = 0.$$\n因此，斜率的极值点精确对应于将 $\\beta$ 视为滴定路径上 $\\mathrm{pH}$ 的函数时的平稳点。斜率极值的性质（最大值或最小值）由三阶导数的符号决定，或者在此处更简单地，通过比较各平稳点上 $\\beta$ 的值来确定，因为 $d\\,\\mathrm{pH}/d n = 1/\\beta$。\n\n3) 弱酸-强碱滴定过程中 $\\beta$ 的定性分布图。对于总形式浓度为 $C_{t}$ 的一元弱酸-共轭碱对，每升溶液的缓冲指数的经过充分检验的范斯莱克表达式为\n$$\\beta_{\\text{pair}}(\\mathrm{pH}) = 2.303\\,C_{t}\\,\\frac{K_{a}\\,[H^{+}]}{\\left(K_{a} + [H^{+}]\\right)^{2}},$$\n该式在 $[H^{+}] = K_{a}$，即在 $pH = pK_{a}$ 处有唯一的最大值。在实际滴定中，$C_{t}$ 随总体积 $V = V_{0} + V_{b}$ 以及在达到等当点区域前 $HA$ 的化学计量消耗而变化，因此酸碱对对 $\\beta$ 的贡献在缓冲中点附近最大，并由于缓冲组分之一的耗尽和稀释效应而朝等当点区域方向减小。\n\n此外，还有来自水的自电离以及超过等当点后 $A^{-}$ 水解的额外贡献。一个标准的、经过充分检验的水的贡献表达式是\n$$\\beta_{\\text{w}}(\\mathrm{pH}) = 2.303\\left([H^{+}] + \\frac{K_{w}}{[H^{+}]}\\right),$$\n该式在 $[H^{+}] = \\sqrt{K_{w}}$ 处（在 $T = 298\\,\\mathrm{K}$ 时，接近 $pH \\approx 7$）有最小值。滴定过程中的总缓冲指数近似为\n$$\\beta_{\\text{tot}}(\\mathrm{pH}) \\approx \\beta_{\\text{pair}}(\\mathrm{pH}) + \\beta_{\\text{w}}(\\mathrm{pH}) + \\text{(在等当点附近及之后的水解项)},$$\n需要理解的是，$C_{t}$ 本身是 $V$ 的函数，因此也是 $n$ 的函数。\n\n将这些定性事实综合起来：\n- 在 $pH = pK_{a}$ 附近（半中和点），$\\beta_{\\text{pair}}$ 局部最大，稀释效应影响不大；因此 $\\beta_{\\text{tot}}$ 在此处有一个局部最大值。所以，$d\\,\\mathrm{pH}/d n = 1/\\beta_{\\text{tot}}$ 在 $pH = pK_{a}$ 处有一个局部最小值。该点不是最大斜率点。\n- 当滴定接近等当点区域时，共轭酸碱对对 $\\beta$ 的贡献骤降，因为酸碱对中的一个成员已被化学计量地耗尽，而水和水解的贡献尚未完全增加到主导地位。因此，总的 $\\beta_{\\text{tot}}$ 在等当点附近经过一个局部最小值。在该最小值处，$d\\,\\mathrm{pH}/d n$ 达到一个局部最大值。这就是用于定位等当点的操作拐点，因为它能产生 $\\mathrm{pH}$ 随 $n$ 的最急剧变化。\n\n4) 对曲率和“拐点”的影响。从\n$$\\frac{d^{2}\\,\\mathrm{pH}}{d n^{2}} = -\\,\\frac{1}{\\beta^{3}}\\,\\frac{d\\beta}{d\\,\\mathrm{pH}},$$\n可知，$\\beta(\\mathrm{pH})$ 的每个平稳点都会产生二阶导数的一个零点，从而成为 $\\mathrm{pH}(n)$ 的一个数学上的拐点。对于弱酸-强碱滴定，$\\beta(\\mathrm{pH})$ 通常有：\n- 一个在 $pH \\approx pK_{a}$ 附近的局部最大值（由缓冲对引起），以及\n- 一个在等当点区域附近的局部最小值（由于缓冲对的耗尽以及在该阶段水/水解的缓冲作用不大）。\n因此，滴定曲线相对于 $n$ 可以表现出两个数学上的拐点：一个与 $pH \\approx pK_{a}$ 处的斜率局部最小值相关联（曲线最平缓之处），另一个与等当点附近斜率的局部最大值相关联（操作拐点）。\n\n有了这些推导和定性分析，我们可以评估每个选项。\n\n选项 A：“操作拐点与 $pH = pK_{a}$ 重合，因为在半中和点时缓冲液最有效，曲线变化最剧烈。” 这混淆了最大缓冲效能（最大 $\\beta$）与最大斜率。由于 $d\\,\\mathrm{pH}/d n = 1/\\beta$，在 $pH = pK_{a}$ 处 $\\beta$ 的最大值意味着斜率的最小值，而不是最大值。结论：错误。\n\n选项 B：“操作拐点满足 $\\beta$ 关于 $\\mathrm{pH}$ 的平稳性条件，并对应于 $\\beta$ 的一个局部最小值；因此它位于等当点区域附近，而非 $pH = pK_{a}$ 处。” 平稳性条件 $d\\beta/d\\,\\mathrm{pH} = 0$ 从 $d^{2}pH/d n^{2} = 0$ 推导得出。操作拐点要求 $d\\,\\mathrm{pH}/d n = 1/\\beta$ 达到最大值，即 $\\beta$ 达到局部最小值，基于所述原因，这发生在等当点区域附近。结论：正确。\n\n选项 C：“在 $pH = pK_{a}$ 处，$\\beta$ 局部最大，而 $d\\,\\mathrm{pH}/d n$ 局部最小；因此该点不是操作拐点。” 这正是从范斯莱克分布图以及斜率与 $\\beta$ 之间的反比关系得出的结论。结论：正确。\n\n选项 D：“只有当同时考虑稀释和水的自电离时，操作拐点才会偏离 $pH = pK_{a}$；如果忽略这些效应，最大斜率点恰好在 $pH = pK_{a}$ 处。” 即使忽略稀释和水的作用，缓冲对的贡献 $\\beta_{\\text{pair}}$ 在 $pH = pK_{a}$ 处也是最大的，因此斜率在该点是最小的。最大斜率出现在 $\\beta$ 最小的地方，即接近组分之一被化学计量耗尽处（等当点区域），而不是在 $pH = pK_{a}$。稀释和水的作用会调整曲线轮廓，但它们既不是使最大斜率与 $pH = pK_{a}$ 重合的必要条件，也不是充分条件。结论：错误。\n\n选项 E：“$\\beta(\\mathrm{pH})$ 通常有两个平稳点（一个在 $pH \\approx pK_{a}$ 附近的局部最大值和一个在等当点附近的局部最小值）；因此相对于 $n$ 有两个数学拐点，但只有后者是用于定位等当点的操作拐点。” 这与分析相符：$\\beta$ 的两个平稳点都产生 $d^{2}pH/d n^{2}$ 的零点，但只有与 $\\beta$ 的最小值相关联的那个点给出了用于定位等当点的最大斜率。结论：正确。", "answer": "$$\\boxed{BCE}$$", "id": "2925491"}, {"introduction": "理论公式在实际应用中的价值体现在其可计算性上。本练习将引导你跨越从理论到实践的鸿沟，将缓冲容量的复杂表达式转化为一个具体的计算算法。你将通过对 $pH$ 空间进行离散化处理，以编程方式确定满足多重现实约束（如最小缓冲容量和组分比例限制）的“操作范围” [@problem_id:2925475]。这个过程不仅能加深你对缓冲容量理论的理解，还能锻炼你解决实际化学问题的计算思维。", "problem": "考虑一个由弱酸物种 $\\mathrm{HA}$ 及其共轭碱 $\\mathrm{A^-}$ 在水温 $25^\\circ\\mathrm{C}$ 下组成的单质子弱酸缓冲溶液，此过程在理想稀溶液行为和活度系数偏差可忽略不计的假设下进行。设缓冲对的总分析浓度为 $C_T$，其中 $C_T = [\\mathrm{HA}] + [\\mathrm{A^-}]$，酸解离平衡由 $K_a = \\dfrac{[\\mathrm{H^+}][\\mathrm{A^-}]}{[\\mathrm{HA}]}$ 定义。水的自电离由 $K_w = [\\mathrm{H^+}][\\mathrm{OH^-}]$ 控制，在 $25^\\circ\\mathrm{C}$ 时 $K_w = 10^{-14}$。定义组成比 $r = \\dfrac{[\\mathrm{A^-}]}{[\\mathrm{HA}]}$。定义缓冲容量 $\\beta$ 为使 $\\mathrm{pH}$ 改变一个单位所需加入的强酸或强碱的量（单位为 $\\mathrm{mol\\cdot L^{-1}}$），即在总缓冲浓度 $C_T$ 和体积 $V$ 恒定时，$\\beta = \\dfrac{d n_{\\text{strong}}/V}{d\\mathrm{pH}}$，其中 $n_{\\text{strong}}$ 是加入的单质子强酸或强碱的摩尔数。\n\n您的任务是构建一个 $\\mathrm{pH}$ 的均匀离散化，并仅使用上述基本定律和定义（物料平衡、电荷平衡和平衡关系），确定在哪个工作 $\\mathrm{pH}$ 范围内同时满足以下两个条件：\n- 最小缓冲容量阈值 $\\beta \\ge \\beta_{\\min}$ (单位为 $\\mathrm{mol\\cdot L^{-1}\\cdot pH^{-1}}$)。\n- 组成约束 $r_{\\min} \\le r \\le r_{\\max}$。\n\n离散化必须是闭区间 $[\\mathrm{pH}_{\\min}, \\mathrm{pH}_{\\max}]$ 上的一个均匀网格 $\\{\\mathrm{pH}_i\\}$，步长为 $\\Delta$，即 $\\mathrm{pH}_i = \\mathrm{pH}_{\\min} + i\\Delta$（其中 $i$ 为整数且满足 $\\mathrm{pH}_i \\le \\mathrm{pH}_{\\max}$）。对于每个网格点，计算 $[\\mathrm{H^+}]$、在约束 $C_T = [\\mathrm{HA}] + [\\mathrm{A^-}]$ 下的平衡组成 $\\{[\\mathrm{HA}],[\\mathrm{A^-}]\\}$、比值 $r = \\dfrac{[\\mathrm{A^-}]}{[\\mathrm{HA}]}$ 以及由定义、物料平衡、电荷平衡和在恒定 $C_T$ 下的平衡所隐含的缓冲容量 $\\beta$。如果 $\\beta \\ge \\beta_{\\min}$ 和 $r_{\\min} \\le r \\le r_{\\max}$ 两个条件都成立，则接受该网格点。将工作范围定义为在 $[\\mathrm{pH}_{\\min}, \\mathrm{pH}_{\\max}]$ 中所有可接受网格点的最小和最大 $\\mathrm{pH}$ 值。如果没有网格点被接受，则工作范围为空集。\n\n程序要求：\n- 使用以10为底的对数计算 $\\mathrm{pH}$，即 $\\mathrm{pH} = -\\log_{10}([\\mathrm{H^+}])$。\n- 将 $K_w$ 视为 $10^{-14}$，其中 $[\\mathrm{H^+}]$ 和 $[\\mathrm{OH^-}]$ 的单位为 $\\mathrm{mol\\cdot L^{-1}}$。\n- 所有浓度均以 $\\mathrm{mol\\cdot L^{-1}}$ 为单位计算。\n- 报告 $\\mathrm{pH}$ 值时，它们是无量纲的。将最终工作范围的端点表示为精确到小数点后三位的浮点数。\n\n测试套件：\n对于每个测试，给定 $(\\mathrm{p}K_a, C_T, \\beta_{\\min}, r_{\\min}, r_{\\max}, \\mathrm{pH}_{\\min}, \\mathrm{pH}_{\\max}, \\Delta)$，其中 $\\mathrm{p}K_a = -\\log_{10}(K_a)$，$C_T$ 的单位为 $\\mathrm{mol\\cdot L^{-1}}$。使用 $K_a = 10^{-\\mathrm{p}K_a}$。使用以下四种情况：\n\n- 情况1（理想情况，受组分和阈值限制）：$(7.0, 0.10, 0.02, 0.1, 10.0, 0.0, 14.0, 0.001)$。\n- 情况2（因浓度过低无可行范围）：$(7.0, 0.0001, 0.0005, 0.1, 10.0, 0.0, 14.0, 0.001)$。\n- 情况3（仅受组分限制，高浓度）：$(6.35, 1.0, 0.05, 0.2, 5.0, 0.0, 14.0, 0.001)$。\n- 情况4（接近等摩尔的窄组分范围）：$(9.0, 0.01, 0.002, 0.9, 1.1, 0.0, 14.0, 0.001)$。\n\n输出规格：\n- 对于每种情况，计算可接受的 $\\mathrm{pH}$ 网格点集合，如果无点被接受，则返回一个空列表，否则返回一个包含最小和最大可接受 $\\mathrm{pH}$ 值的双元素列表 $[\\mathrm{pH}_{\\text{low}}, \\mathrm{pH}_{\\text{high}}]$，四舍五入到小数点后三位。\n- 您的程序应生成单行输出，其中包含所有四种情况的结果，形式为一个以逗号分隔的列表，并用方括号括起来。例如，一个有效的输出格式是 $[[x_1,x_2],[],[y_1,y_2],[z_1,z_2]]$，其中每个 $x_i$、$y_i$、$z_i$ 都是精确到小数点后三位的浮点数。", "solution": "我们从基本定义和定律出发，推导在任何给定 $\\mathrm{pH}$ 下进行算法评估所需的量。\n\n定义 $\\mathrm{pH} = -\\log_{10}([\\mathrm{H^+}])$，因此对于给定的网格点 $\\mathrm{pH}_i$，质子浓度为 $[\\mathrm{H^+}] = 10^{-\\mathrm{pH}_i}$。水的自电离满足 $K_w = [\\mathrm{H^+}][\\mathrm{OH^-}]$，因此 $[\\mathrm{OH^-}] = \\dfrac{K_w}{[\\mathrm{H^+}]}$，在 $25^\\circ\\mathrm{C}$ 时 $K_w = 10^{-14}$。\n\n对于一个总分析浓度为 $C_T = [\\mathrm{HA}] + [\\mathrm{A^-}]$、酸解离平衡常数为 $K_a = \\dfrac{[\\mathrm{H^+}][\\mathrm{A^-}]}{[\\mathrm{HA}]}$ 的单质子酸缓冲体系 $\\mathrm{HA}/\\mathrm{A^-}$，可以将物料平衡与平衡关系结合，将物种浓度表示为 $[\\mathrm{H^+}]$ 的函数：\n- 从 $K_a = \\dfrac{[\\mathrm{H^+}][\\mathrm{A^-}]}{[\\mathrm{HA}]}$ 我们得到 $\\dfrac{[\\mathrm{A^-}]}{[\\mathrm{HA}]} = \\dfrac{K_a}{[\\mathrm{H^+}]}$。\n- 施加 $C_T = [\\mathrm{HA}] + [\\mathrm{A^-}] = [\\mathrm{HA}]\\left(1 + \\dfrac{K_a}{[\\mathrm{H^+}]}\\right)$，得到 $[\\mathrm{HA}] = C_T \\dfrac{[\\mathrm{H^+}]}{K_a + [\\mathrm{H^+}]}$ 和 $[\\mathrm{A^-}] = C_T \\dfrac{K_a}{K_a + [\\mathrm{H^+}]}$。\n\n因此，组成比为\n$$\nr = \\frac{[\\mathrm{A^-}]}{[\\mathrm{HA}]} = \\frac{K_a}{[\\mathrm{H^+}]},\n$$\n该比值在平衡时仅取决于 $K_a$ 和 $[\\mathrm{H^+}]$。\n\n接下来，推导缓冲容量 $\\beta$。缓冲容量定义为\n$$\n\\beta = \\frac{d n_{\\text{strong}}/V}{d\\mathrm{pH}},\n$$\n即在恒定体积和恒定 $C_T$ 下，使 $\\mathrm{pH}$ 偏移一个单位所需的强单质子酸或碱的微分量（单位为 $\\mathrm{mol\\cdot L^{-1}}$）。我们可以使用电荷平衡和物料平衡来表示强物种的无限小添加对质子平衡的影响。单位体积内吸收或释放质子的物种的总当量包括自由质子 $[\\mathrm{H^+}]$、氢氧根离子 $[\\mathrm{OH^-}]$，以及通过其质子化状态体现的弱酸对。设 $\\alpha$ 表示缓冲对每 $\\mathrm{pH}$ 增量对质子吸收或释放的贡献程度。从上述平衡表达式可知，缓冲液中碱形态 $\\mathrm{A^-}$ 的分数为 $x = \\dfrac{[\\mathrm{A^-}]}{C_T} = \\dfrac{K_a}{K_a + [\\mathrm{H^+}]}$，酸形态的分数为 $1 - x = \\dfrac{[\\mathrm{H^+}]}{K_a + [\\mathrm{H^+}]}$。在恒定 $C_T$ 下，当 $\\mathrm{pH}$ 发生无限小变化时，缓冲液中和状态的变化由 $\\mathrm{HA}$ 和 $\\mathrm{A^-}$ 之间的转换决定，其相对于 $[\\mathrm{H^+}]$ 在固定 $K_a$ 下的微分为\n$$\n\\frac{d[\\mathrm{A^-}]}{d[\\mathrm{H^+}]} = C_T \\frac{d}{d[\\mathrm{H^+}]}\\left(\\frac{K_a}{K_a + [\\mathrm{H^+]}}\\right) = - C_T \\frac{K_a}{(K_a + [\\mathrm{H^+]})^2}.\n$$\n$[\\mathrm{H^+}]$ 的正向增加会驱动 $\\mathrm{A^-}\\to \\mathrm{HA}$，消耗碱当量。通过 $d\\mathrm{pH} = -\\dfrac{1}{\\ln 10}\\dfrac{d[\\mathrm{H^+}]}{[\\mathrm{H^+}]}$ 转换为 $\\mathrm{pH}$，我们得到缓冲对对容量的贡献：\n$$\n\\beta_{\\text{buffer}} = -\\frac{d[\\mathrm{A^-}]}{d\\mathrm{pH}} = \\left(C_T \\frac{K_a}{(K_a + [\\mathrm{H^+]})^2}\\right)\\frac{d[\\mathrm{H^+}]}{d\\mathrm{pH}} = \\left(C_T \\frac{K_a}{(K_a + [\\mathrm{H^+]})^2}\\right)\\left(-\\ln 10\\right) [\\mathrm{H^+}],\n$$\n因此\n$$\n\\beta_{\\text{buffer}} = 2.303 \\, C_T \\, \\frac{K_a [\\mathrm{H^+}]}{(K_a + [\\mathrm{H^+]})^2}.\n$$\n水的贡献来自于强酸/强碱的添加也通过水的自电离直接改变 $[\\mathrm{H^+}]$ 和 $[\\mathrm{OH^-}]$。仅考虑水的微分电荷平衡给出\n$$\n\\beta_{\\text{water}} = -\\frac{d([\\mathrm{H^+}] - [\\mathrm{OH^-}])}{d\\mathrm{pH}} = -\\left(\\frac{d[\\mathrm{H^+}]}{d\\mathrm{pH}} - \\frac{d[\\mathrm{OH^-}]}{d\\mathrm{pH}}\\right).\n$$\n使用 $[\\mathrm{H^+}] = 10^{-\\mathrm{pH}}$ 及其导数 $\\dfrac{d[\\mathrm{H^+}]}{d\\mathrm{pH}} = -(\\ln 10) [\\mathrm{H^+}]$ 和 $[\\mathrm{OH^-}] = \\dfrac{K_w}{[\\mathrm{H^+}]}$ 及其导数 $\\dfrac{d[\\mathrm{OH^-}]}{d\\mathrm{pH}} = (\\ln 10)\\dfrac{K_w}{[\\mathrm{H^+}]}$，我们发现\n$$\n\\beta_{\\text{water}} = 2.303\\left([\\mathrm{H^+}] + \\frac{K_w}{[\\mathrm{H^+}]}\\right).\n$$\n根据微分的线性性质，该单质子体系的总缓冲容量是两者之和\n$$\n\\beta = \\beta_{\\text{water}} + \\beta_{\\text{buffer}} = 2.303\\left([\\mathrm{H^+}] + \\frac{K_w}{[\\mathrm{H^+}]} + C_T \\frac{K_a [\\mathrm{H^+}]}{(K_a + [\\mathrm{H^+]})^2}\\right).\n$$\n该表达式严格地从定义、物料平衡、电荷平衡和平衡关系中获得。\n\n算法设计：\n- 对于每个测试用例，计算 $K_a = 10^{-\\mathrm{p}K_a}$。\n- 构建网格 $\\mathrm{pH}_i = \\mathrm{pH}_{\\min} + i\\Delta$，其中 $i$ 为整数，直到 $\\mathrm{pH}_{\\max}$。\n- 在每个 $\\mathrm{pH}_i$ 处，计算 $[\\mathrm{H^+}] = 10^{-\\mathrm{pH}_i}$。\n- 计算 $r = \\dfrac{K_a}{[\\mathrm{H^+}]}$ 并评估组分约束 $r_{\\min} \\le r \\le r_{\\max}$。\n- 计算 $\\beta = 2.303\\left([\\mathrm{H^+}] + \\dfrac{K_w}{[\\mathrm{H^+}]} + C_T \\dfrac{K_a [\\mathrm{H^+}]}{(K_a + [\\mathrm{H^+]})^2}\\right)$ 并检查 $\\beta \\ge \\beta_{\\min}$。\n- 如果两个条件都满足，则接受 $\\mathrm{pH}_i$。\n- 如果没有网格点被接受，则返回空列表。否则，返回最小和最大可接受的 $\\mathrm{pH}$ 值，四舍五入到三位小数。\n\n测试用例讨论：\n- 情况1：当 $\\mathrm{p}K_a = 7.0$，$C_T = 0.10$，且 $\\beta_{\\min} = 0.02$ 时，组分范围 $r \\in [0.1,10.0]$ 将 $\\mathrm{pH}$ 限制在 $\\mathrm{p}K_a$ 附近，大约为 $[6.0, 8.0]$。缓冲容量标准进一步将两端稍微收窄到距离 $\\mathrm{p}K_a$ 不到 $\\pm 1$ 个单位，得到端点接近 $\\mathrm{pH} \\approx 6.025$ 和 $\\mathrm{pH} \\approx 7.975$。\n- 情况2：当 $C_T = 0.0001$ 且 $\\beta_{\\min} = 0.0005$ 时，即使在 $\\mathrm{pH} \\approx \\mathrm{p}K_a$ 处，缓冲容量也约为 $2.303 C_T/4 \\approx 0.0000576$（在中性附近，水的贡献可忽略不计），这未达到阈值；结果为空集。\n- 情况3：当 $C_T = 1.0$ 且 $\\beta_{\\min} = 0.05$ 时，在组分允许的区域 $r \\in [0.2,5.0]$ 内，容量很大，因此工作范围由 $\\mathrm{p}K_a$ 引起的组分界限给出，大约为 $\\mathrm{pH} \\in [5.651, 7.049]$。\n- 情况4：当组分约束很严格，$r \\in [0.9,1.1]$（围绕等摩尔点），且 $C_T = 0.01$ 时，在该狭窄窗口内容易满足容量标准，因此工作范围基本上就是组分窗口 $\\mathrm{pH} \\in [8.954, 9.041]$。\n\n程序实现了这种离散化和评估，为每种情况返回最小和最大可接受的 $\\mathrm{pH}$（四舍五入到三位小数），并以指定格式在单行上打印结果列表。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef operational_range(pKa, C_T, beta_min, r_min, r_max, pH_min, pH_max, dpH, Kw=1e-14):\n    # Construct pH grid\n    n_steps = int(np.floor((pH_max - pH_min) / dpH)) + 1\n    pH_grid = pH_min + dpH * np.arange(n_steps + 1)\n    # Ensure upper bound inclusion within floating error tolerance\n    pH_grid = pH_grid[pH_grid <= pH_max + 1e-12]\n\n    Ka = 10.0**(-pKa)\n    H = 10.0**(-pH_grid)\n\n    # Composition ratio r = Ka / H\n    r = Ka / H\n\n    # Buffer capacity beta = 2.303 * ( H + Kw/H + C_T * Ka*H / (Ka + H)^2 )\n    denom = (Ka + H)\n    buffer_term = C_T * Ka * H / (denom * denom)\n    beta = 2.303 * (H + Kw / H + buffer_term)\n\n    # Acceptance mask\n    mask = (r >= r_min) & (r <= r_max) & (beta >= beta_min)\n\n    if not np.any(mask):\n        return []\n\n    idxs = np.where(mask)[0]\n    low = float(pH_grid[idxs[0]])\n    high = float(pH_grid[idxs[-1]])\n    # Round to exactly three decimals for reporting\n    low = round(low, 3)\n    high = round(high, 3)\n    return [low, high]\n\ndef format_results(results):\n    # Format as specified: list of per-case results, each either [] or [low,high],\n    # with floats shown with exactly three decimals.\n    items = []\n    for res in results:\n        if isinstance(res, list) and len(res) == 2:\n            items.append(f\"[{res[0]:.3f},{res[1]:.3f}]\")\n        elif isinstance(res, list) and len(res) == 0:\n            items.append(\"[]\")\n        else:\n            # Fallback formatting\n            items.append(str(res))\n    return \"[\" + \",\".join(items) + \"]\"\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # (pKa, C_T, beta_min, r_min, r_max, pH_min, pH_max, dpH)\n    test_cases = [\n        (7.0, 0.10, 0.02, 0.1, 10.0, 0.0, 14.0, 0.001),\n        (7.0, 1e-4, 5e-4, 0.1, 10.0, 0.0, 14.0, 0.001),\n        (6.35, 1.0, 0.05, 0.2, 5.0, 0.0, 14.0, 0.001),\n        (9.0, 0.01, 0.002, 0.9, 1.1, 0.0, 14.0, 0.001),\n    ]\n\n    results = []\n    for case in test_cases:\n        pKa, C_T, beta_min, r_min, r_max, pH_min, pH_max, dpH = case\n        rng = operational_range(pKa, C_T, beta_min, r_min, r_max, pH_min, pH_max, dpH)\n        results.append(rng)\n\n    # Final print statement in the exact required format.\n    print(format_results(results))\n\nsolve()\n```", "id": "2925475"}, {"introduction": "在掌握了缓冲溶液的分析方法后，更高层次的挑战在于如何“设计”一个满足特定性能指标的缓冲系统。本练习将带你从分析走向综合，挑战你设计一个由多种弱酸构成的复合缓冲溶液。你需要建立并求解一个“最大-最小”优化问题，以在给定的总浓度预算下，最大化目标 $pH$ 区间内的最低缓冲容量 [@problem_id:2925460]。这个练习是缓冲理论在高端化学设计中应用的绝佳范例。", "problem": "某实验室需要设计一种缓冲液，使其在生理范围内保持近乎恒定的酸度。设计变量是缓冲组分的总分析浓度集合 $\\{C_{T,i}\\}$。目标性能标准是缓冲容量 $\\beta$，其定义为每升溶液中，使氢离子活度改变一个对数单位所需强碱的摩尔数。考虑在 $T=298.15\\ \\mathrm{K}$ 条件下的一种无盐配方，该配方表现出理想行为（在所考虑的离子强度下，活度系数等于$1$）。该配方是两种独立的单质子弱酸 $\\mathrm{HA}_1$ 和 $\\mathrm{HA}_2$ 的混合物，其酸解离常数由 $\\mathrm{p}K_{a,1}=6.80$ 和 $\\mathrm{p}K_{a,2}=7.20$ 表征。溶剂的自递常数为 $K_w=1.0\\times 10^{-14}$。目标酸度区间为 $[\\mathrm{pH}_1,\\mathrm{pH}_2]=[6.80,7.20]$。实验室施加了严格的离子强度预算，该预算作为对缓冲液组成的线性约束进行保守执行：总分析浓度之和必须满足 $C_{T,1}+C_{T,2}\\leq C_{\\max}$，其中 $C_{\\max}=0.050\\ \\mathrm{mol\\ L^{-1}}$。\n\n从基本定义（质量作用、质量平衡、水自电离、电中性）和缓冲容量 $\\beta$ 作为每升溶液中添加的强碱量对 $\\mathrm{pH}$ 的导数这一操作性定义出发，建立最大-最小化优化问题，该问题选择 $\\{C_{T,1},C_{T,2}\\}$ 以在组成和非负性约束下，最大化 $\\beta(\\mathrm{pH})$ 在 $\\mathrm{pH}\\in[6.80,7.20]$ 区间内的最小值。然后，在给定的假设和数据下精确求解该优化问题。\n\n最大最差情况缓冲容量值是多少，即在最优 $\\{C_{T,1},C_{T,2}\\}$ 下，$\\min_{\\mathrm{pH}\\in[6.80,7.20]}\\beta(\\mathrm{pH})$ 的最优值是多少？请以 $\\mathrm{mol\\ L^{-1}\\ per\\ pH\\ unit}$ 为单位表示您的最终答案，并将结果四舍五入至四位有效数字。", "solution": "该问题要求建立并求解一个最大-最小化优化问题，以在总浓度约束下，找到两种弱酸混合物在指定pH区间内的最大可能的最差情况缓冲容量。\n\n首先，我们必须推导出缓冲容量 $\\beta$ 的表达式。在加入浓度为 $C_B$ 的单质子强碱（例如 $\\mathrm{NaOH}$）后，系统的电荷平衡方程为：\n$$ [\\mathrm{Na}^+] + [\\mathrm{H}^+] = [\\mathrm{OH}^-] + [\\mathrm{A}_1^-] + [\\mathrm{A}_2^-] $$\n假设该碱是 $\\mathrm{Na}^+$ 的唯一来源，则 $C_B = [\\mathrm{Na}^+]$。设 $h = [\\mathrm{H}^+]$ 为氢离子浓度。根据水的自递常数 $K_w = [\\mathrm{H}^+][\\mathrm{OH}^-]$，我们得到 $[\\mathrm{OH}^-] = K_w/h$。电荷平衡方程变为：\n$$ C_B = \\frac{K_w}{h} - h + [\\mathrm{A}_1^-] + [\\mathrm{A}_2^-] $$\n对于每种弱酸 $\\mathrm{HA}_i$，其总分析浓度 $C_{T,i}$ 由质量平衡方程 $C_{T,i} = [\\mathrm{HA}_i] + [\\mathrm{A}_i^-]$ 给出。其酸解离常数为 $K_{a,i} = \\frac{h[\\mathrm{A}_i^-]}{[\\mathrm{HA}_i]}$。结合这些，我们将共轭碱 $[\\mathrm{A}_i^-]$ 的浓度表示为：\n$$ [\\mathrm{A}_i^-] = C_{T,i} \\frac{K_{a,i}}{h + K_{a,i}} $$\n将此代入 $C_B$ 的表达式中：\n$$ C_B(h) = \\frac{K_w}{h} - h + C_{T,1} \\frac{K_{a,1}}{h + K_{a,1}} + C_{T,2} \\frac{K_{a,2}}{h + K_{a,2}} $$\n缓冲容量 $\\beta$ 定义为 $\\beta = \\frac{dC_B}{d(\\mathrm{pH})}$。使用链式法则，$\\beta = \\frac{dC_B}{dh} \\frac{dh}{d(\\mathrm{pH})}$。\n已知 $\\mathrm{pH} = -\\log_{10}(h)$，我们有 $h = 10^{-\\mathrm{pH}}$，以及 $\\frac{dh}{d(\\mathrm{pH})} = -(\\ln 10)h$。\n对 $C_B(h)$ 关于 $h$ 求导：\n$$ \\frac{dC_B}{dh} = -\\frac{K_w}{h^2} - 1 - C_{T,1}\\frac{K_{a,1}}{(h+K_{a,1})^2} - C_{T,2}\\frac{K_{a,2}}{(h+K_{a,2})^2} $$\n乘以 $-(\\ln 10)h$ 得到缓冲容量：\n$$ \\beta(h) = (\\ln 10) \\left( \\frac{K_w}{h} + h + C_{T,1} \\frac{h K_{a,1}}{(h+K_{a,1})^2} + C_{T,2} \\frac{h K_{a,2}}{(h+K_{a,2})^2} \\right) $$\n该表达式由水的贡献 $\\beta_w = (\\ln 10)(h + K_w/h)$ 和每种弱酸的贡献 $\\beta_i = (\\ln 10) C_{T,i} \\frac{h K_{a,i}}{(h+K_{a,i})^2}$ 组成。\n\n优化问题为：\n$$ \\max_{C_{T,1}, C_{T,2}} \\left( \\min_{\\mathrm{pH} \\in [6.80, 7.20]} \\beta(\\mathrm{pH}) \\right) $$\n受限于约束条件 $C_{T,1} + C_{T,2} \\leq C_{\\max} = 0.050\\ \\mathrm{mol\\ L^{-1}}$，以及 $C_{T,1} \\geq 0$, $C_{T,2} \\geq 0$。\n\n对于任何固定的 $\\mathrm{pH}$，$\\beta$ 是 $C_{T,1}$ 和 $C_{T,2}$ 的正线性函数。为了最大化 $\\beta$，我们必须最大化总浓度。因此，约束必须取等号：$C_{T,1} + C_{T,2} = C_{\\max}$。我们可以将 $C_{T,2}$ 表示为 $C_{T,2} = C_{\\max} - C_{T,1}$。\n\n$\\mathrm{pH}$ 区间为 $[6.80, 7.20]$。给定的 $\\mathrm{p}K_a$ 值为 $\\mathrm{p}K_{a,1} = 6.80$ 和 $\\mathrm{p}K_{a,2} = 7.20$。该区间的端点与酸的 $\\mathrm{p}K_a$ 值重合。设 $\\mathrm{pH}_1 = 6.80$ 且 $\\mathrm{pH}_2=7.20$。\n另外，我们来评估水的贡献。在 $\\mathrm{pH}=7.00$ 时，$\\beta_w = (\\ln 10)(10^{-7} + 10^{-7}) \\approx 4.6 \\times 10^{-7}\\ \\mathrm{mol\\ L^{-1}}$，与来自酸的预期缓冲容量（数量级为 $0.01\\ \\mathrm{mol\\ L^{-1}}$）相比，可以忽略不计。我们可以在优化逻辑中忽略 $\\beta_w$，但为了准确性，我们会在最终计算中将其包括在内。\n\n问题简化为找到最优的 $C_{T,1} \\in [0, C_{\\max}]$，以最大化 $\\min(\\beta(\\mathrm{pH}_1), \\beta(\\mathrm{pH}_2))$，因为一个递减函数 ($\\beta_1$) 和一个递增函数 ($\\beta_2$) 之和的最小值很可能出现在区间的边界上。我们来分析端点 $\\mathrm{pH}_1$ 和 $\\mathrm{pH}_2$ 处的缓冲容量。\n在 $\\mathrm{pH}_1 = 6.80$ 时，我们有 $h_1 = 10^{-6.80}=K_{a,1}$。\n在 $\\mathrm{pH}_2 = 7.20$ 时，我们有 $h_2 = 10^{-7.20}=K_{a,2}$。\n\n在 $\\mathrm{pH}_j$ 时，来自酸 $i$ 的缓冲容量贡献近似为 $\\beta_{i,j} = (\\ln 10) C_{T,i} \\frac{h_j K_{a,i}}{(h_j+K_{a,i})^2}$。\n在 $\\mathrm{pH}_1 = 6.80$ 时：\n$\\beta_{1,1} = (\\ln 10)C_{T,1}\\frac{K_{a,1}^2}{(2K_{a,1})^2} = (\\ln 10)\\frac{C_{T,1}}{4}$。\n$\\beta_{2,1} = (\\ln 10)C_{T,2}\\frac{K_{a,1} K_{a,2}}{(K_{a,1}+K_{a,2})^2}$。\n在 $\\mathrm{pH}_2 = 7.20$ 时：\n$\\beta_{1,2} = (\\ln 10)C_{T,1}\\frac{K_{a,2} K_{a,1}}{(K_{a,2}+K_{a,1})^2}$。\n$\\beta_{2,2} = (\\ln 10)C_{T,2}\\frac{K_{a,2}^2}{(2K_{a,2})^2} = (\\ln 10)\\frac{C_{T,2}}{4}$。\n设 $\\gamma = \\frac{K_{a,1} K_{a,2}}{(K_{a,1}+K_{a,2})^2}$。在端点处的总缓冲容量（忽略水）为：\n$\\beta(\\mathrm{pH}_1) \\approx (\\ln 10) \\left( \\frac{C_{T,1}}{4} + C_{T,2}\\gamma \\right)$\n$\\beta(\\mathrm{pH}_2) \\approx (\\ln 10) \\left( C_{T,1}\\gamma + \\frac{C_{T,2}}{4} \\right)$\n\n为了最大化这两个值的最小值，我们应该让它们相等。这是因为 $\\beta(\\mathrm{pH}_1)$ 是 $C_{T,1}$ 的增函数（因为 $C_{T,2} = C_{\\max}-C_{T,1}$ 且 $1/4 > \\gamma$），而 $\\beta(\\mathrm{pH}_2)$ 是 $C_{T,1}$ 的减函数。最小值的最大值在它们相等时出现。\n$$ \\frac{C_{T,1}}{4} + C_{T,2}\\gamma = C_{T,1}\\gamma + \\frac{C_{T,2}}{4} $$\n$$ (C_{T,1} - C_{T,2})\\left(\\frac{1}{4} - \\gamma\\right) = 0 $$\n由于 $K_{a,1} \\neq K_{a,2}$，所以 $\\gamma  1/4$。因此，我们必须有 $C_{T,1} = C_{T,2}$。\n根据约束条件 $C_{T,1} + C_{T,2} = C_{\\max}$，最优浓度为：\n$$ C_{T,1} = C_{T,2} = \\frac{C_{\\max}}{2} = \\frac{0.050}{2} = 0.025\\ \\mathrm{mol\\ L^{-1}} $$\n\n当浓度相等时，缓冲容量函数 $\\beta(\\mathrm{pH})$ 关于中点 $\\mathrm{pH} = \\frac{\\mathrm{p}K_{a,1}+\\mathrm{p}K_{a,2}}{2} = 7.00$ 对称。二阶导数分析表明 $\\beta(\\mathrm{pH})$ 在 $\\mathrm{pH}=7.00$ 处有一个局部最大值。因此，$\\beta(\\mathrm{pH})$ 在区间 $[\\mathrm{p}K_{a,1}, \\mathrm{p}K_{a,2}]$ 上的最小值必定出现在端点处。\n\n最大最差情况缓冲容量就是这个最小值，即 $\\beta_{\\min} = \\beta(\\mathrm{pH}=6.80)$。\n$$ \\beta_{\\min} = (\\ln 10) \\left( h_1 + \\frac{K_w}{h_1} + C_{T,1} \\frac{1}{4} + C_{T,2} \\gamma \\right) $$\n使用 $C_{T,1}=C_{T,2}=C_{\\max}/2=0.025\\ \\mathrm{mol\\ L^{-1}}$：\n$$ \\beta_{\\min} = (\\ln 10) \\left( 10^{-6.80} + 10^{-7.20} + \\frac{C_{\\max}}{2} \\left( \\frac{1}{4} + \\gamma \\right) \\right) $$\n现在我们计算数值。\n$h_1 + K_w/h_1 = 10^{-6.80} + 10^{-14}/10^{-6.80} = 10^{-6.80} + 10^{-7.20}$。\n$10^{-6.80} \\approx 1.58489 \\times 10^{-7}\\ \\mathrm{mol\\ L^{-1}}$。\n$10^{-7.20} \\approx 0.63096 \\times 10^{-7}\\ \\mathrm{mol\\ L^{-1}}$。\n水的贡献项为 $1.58489 \\times 10^{-7} + 0.63096 \\times 10^{-7} = 2.21585 \\times 10^{-7}\\ \\mathrm{mol\\ L^{-1}}$。\n参数 $\\gamma$ 为：\n$$ \\gamma = \\frac{K_{a,1} K_{a,2}}{(K_{a,1}+K_{a,2})^2} = \\frac{10^{-6.80} \\times 10^{-7.20}}{(10^{-6.80}+10^{-7.20})^2} = \\frac{10^{-14}}{(2.21585 \\times 10^{-7})^2} \\approx 0.203666 $$\n缓冲贡献项为：\n$$ \\frac{C_{\\max}}{2} \\left( \\frac{1}{4} + \\gamma \\right) = 0.025 \\times (0.25 + 0.203666) = 0.025 \\times 0.453666 = 0.01134165\\ \\mathrm{mol\\ L^{-1}} $$\n将括号内的贡献项相加：\n$$ 2.21585 \\times 10^{-7} + 0.01134165 = 0.01134187\\ \\mathrm{mol\\ L^{-1}} $$\n最后，乘以 $\\ln 10 \\approx 2.302585$：\n$$ \\beta_{\\min} = 2.302585 \\times 0.01134187 \\approx 0.0261160\\ \\mathrm{mol\\ L^{-1}} $$\n四舍五入到四位有效数字，最大最差情况缓冲容量为 $0.02612\\ \\mathrm{mol\\ L^{-1}}$。", "answer": "$$\n\\boxed{0.02612}\n$$", "id": "2925460"}]}