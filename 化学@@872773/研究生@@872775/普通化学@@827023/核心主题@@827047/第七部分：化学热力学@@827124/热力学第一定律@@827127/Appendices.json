{"hands_on_practices": [{"introduction": "本练习将通过一个完整的热力学循环来巩固您对热力学第一定律的理解。通过计算理想气体在一个闭合路径上所做的总功、吸收的总热量以及内能的总变化，您将直接验证内能是一个状态函数，而功和热是依赖于路径的。这是掌握能量守恒原理的一项基础性实践。[@problem_id:2959099]", "problem": "样本量为 $n = 1.000$ $\\mathrm{mol}$ 的单原子理想气体，在压力-体积平面上经历一个由两条等压过程和两条等容过程组成的顺时针矩形循环。该矩形的四个顶点由数对 $(p,V)$ 定义，其参数为 $p_{\\mathrm{low}} = 125.0$ $\\mathrm{kPa}$，$p_{\\mathrm{high}} = 275.0$ $\\mathrm{kPa}$，$V_{\\mathrm{low}} = 9.00$ $\\mathrm{L}$ 以及 $V_{\\mathrm{high}} = 15.00$ $\\mathrm{L}$。循环过程如下：\n- 状态 $\\mathrm{A}$: $(p_{\\mathrm{high}}, V_{\\mathrm{low}})$。\n- $\\mathrm{A} \\to \\mathrm{B}$: 在 $p_{\\mathrm{high}}$ 下从 $V_{\\mathrm{low}}$ 等压膨胀到 $V_{\\mathrm{high}}$。\n- $\\mathrm{B} \\to \\mathrm{C}$: 在 $V_{\\mathrm{high}}$ 下从 $p_{\\mathrm{high}}$ 等容降压到 $p_{\\mathrm{low}}$。\n- $\\mathrm{C} \\to \\mathrm{D}$: 在 $p_{\\mathrm{low}}$ 下从 $V_{\\mathrm{high}}$ 等压压缩到 $V_{\\mathrm{low}}$。\n- $\\mathrm{D} \\to \\mathrm{A}$: 在 $V_{\\mathrm{low}}$ 下从 $p_{\\mathrm{low}}$ 等容升压到 $p_{\\mathrm{high}}$。\n\n假设与约定：\n- 该过程是准静态的（可逆的），因此在每个阶段，系统压力等于外部压力。\n- 气体在所有点上都保持理想状态，并遵循理想气体定律 $pV = nRT$，其中 $R = 8.314462618$ $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n- 对于单原子理想气体，其定容摩尔热容与温度无关，等于 $C_{V,\\mathrm{m}} = \\tfrac{3}{2}R$。\n- 体积功的非恰当微分定义为 $\\delta w = -p\\,dV$（外界对系统做功为正）。\n- 热量的非恰当微分定义为 $\\delta q$（系统吸热为正）。\n- 热力学第一定律采用 $dU = \\delta q + \\delta w$ 的形式。\n\n任务：\n- 计算循环功 $\\oint \\delta w$。\n- 计算循环热 $\\oint \\delta q$。\n- 通过与所述原理一致的显式计算，验证整个循环中内能的总变化为零，即 $\\Delta U_{\\mathrm{cycle}} = 0$。\n\n所有能量均以 $\\mathrm{J}$ 表示。将最终数值答案四舍五入至三位有效数字。最终答案必须是单个对象，并按顺序包含 $\\oint \\delta w$、$\\oint \\delta q$ 和 $\\Delta U_{\\mathrm{cycle}}$ 的值。", "solution": "该问题要求计算一个完整循环中外界对气体所做的总功 $w_{\\mathrm{cycle}} = \\oint \\delta w$、气体吸收的总热量 $q_{\\mathrm{cycle}} = \\oint \\delta q$ 以及内能的总变化量 $\\Delta U_{\\mathrm{cycle}}$。热力学第一定律 $dU = \\delta q + \\delta w$ 控制着能量的转换。\n\n首先，我们必须将所有给定值用国际单位制（SI）表示。\n压力：\n$p_{\\mathrm{low}} = 125.0\\,\\mathrm{kPa} = 1.250 \\times 10^5\\,\\mathrm{Pa}$\n$p_{\\mathrm{high}} = 275.0\\,\\mathrm{kPa} = 2.750 \\times 10^5\\,\\mathrm{Pa}$\n体积：\n$V_{\\mathrm{low}} = 9.00\\,\\mathrm{L} = 9.00 \\times 10^{-3}\\,\\mathrm{m^3}$\n$V_{\\mathrm{high}} = 15.00\\,\\mathrm{L} = 1.500 \\times 10^{-2}\\,\\mathrm{m^3}$\n\n该循环由四个准静态过程组成：$\\mathrm{A} \\to \\mathrm{B}$、$\\mathrm{B} \\to \\mathrm{C}$、$\\mathrm{C} \\to \\mathrm{D}$ 和 $\\mathrm{D} \\to \\mathrm{A}$。\n\n任务1：计算循环功 $\\oint \\delta w = w_{\\mathrm{cycle}}$。\n总功是循环中每个过程所做功的总和：\n$$w_{\\mathrm{cycle}} = w_{AB} + w_{BC} + w_{CD} + w_{DA}$$\n功由积分 $w = \\int -p\\,dV$ 定义。\n\n过程 $\\mathrm{A} \\to \\mathrm{B}$（在 $p = p_{\\mathrm{high}}$ 下的等压膨胀）：\n$w_{AB} = \\int_{V_{\\mathrm{low}}}^{V_{\\mathrm{high}}} -p_{\\mathrm{high}}\\,dV = -p_{\\mathrm{high}}(V_{\\mathrm{high}} - V_{\\mathrm{low}})$\n\n过程 $\\mathrm{B} \\to \\mathrm{C}$（在 $V = V_{\\mathrm{high}}$ 下的等容冷却）：\n由于体积恒定，$dV = 0$，因此所做的功为零。\n$w_{BC} = \\int -p\\,dV = 0$\n\n过程 $\\mathrm{C} \\to \\mathrm{D}$（在 $p = p_{\\mathrm{low}}$ 下的等压压缩）：\n$w_{CD} = \\int_{V_{\\mathrm{high}}}^{V_{\\mathrm{low}}} -p_{\\mathrm{low}}\\,dV = -p_{\\mathrm{low}}(V_{\\mathrm{low}} - V_{\\mathrm{high}}) = p_{\\mathrm{low}}(V_{\\mathrm{high}} - V_{\\mathrm{low}})$\n\n过程 $\\mathrm{D} \\to \\mathrm{A}$（在 $V = V_{\\mathrm{low}}$ 下的等容加热）：\n由于体积恒定，$dV = 0$，因此所做的功为零。\n$w_{DA} = \\int -p\\,dV = 0$\n\n循环的总功是这些贡献的总和：\n$w_{\\mathrm{cycle}} = -p_{\\mathrm{high}}(V_{\\mathrm{high}} - V_{\\mathrm{low}}) + 0 + p_{\\mathrm{low}}(V_{\\mathrm{high}} - V_{\\mathrm{low}}) + 0$\n$$w_{\\mathrm{cycle}} = -(p_{\\mathrm{high}} - p_{\\mathrm{low}})(V_{\\mathrm{high}} - V_{\\mathrm{low}})$$\n该结果的绝对值对应于 $p-V$ 平面中矩形路径所包围的面积。循环的顺时针方向导致系统对外做净功，因此外界对系统做的净功为负。\n\n现在，我们代入数值：\n$\\Delta p = p_{\\mathrm{high}} - p_{\\mathrm{low}} = (2.750 - 1.250) \\times 10^5\\,\\mathrm{Pa} = 1.500 \\times 10^5\\,\\mathrm{Pa}$\n$\\Delta V = V_{\\mathrm{high}} - V_{\\mathrm{low}} = (15.00 - 9.00) \\times 10^{-3}\\,\\mathrm{m^3} = 6.00 \\times 10^{-3}\\,\\mathrm{m^3}$\n$w_{\\mathrm{cycle}} = -(1.500 \\times 10^5\\,\\mathrm{Pa}) \\times (6.00 \\times 10^{-3}\\,\\mathrm{m^3}) = -900.0\\,\\mathrm{J}$\n有效数字的位数受 $\\Delta V$ 的值限制，其具有三位有效数字。因此，我们将结果四舍五入到三位有效数字。\n$w_{\\mathrm{cycle}} = -9.00 \\times 10^2\\,\\mathrm{J}$\n\n任务2：验证 $\\Delta U_{\\mathrm{cycle}} = 0$。\n内能 $U$ 是一个状态函数，意味着其变化仅取决于初态和末态。对于任何闭合循环，初态和末态相同，因此内能的净变化必须为零，即 $\\Delta U_{\\mathrm{cycle}} = 0$。本题要求进行显式验证。\n\n对于单原子理想气体，内能的变化由 $\\Delta U = n C_{V,\\mathrm{m}} \\Delta T$ 给出，其中 $C_{V,\\mathrm{m}} = \\frac{3}{2}R$。使用理想气体定律 $pV = nRT$，我们可以写出 $\\Delta U = \\frac{3}{2} nR \\Delta T = \\frac{3}{2} \\Delta(nRT) = \\frac{3}{2}\\Delta(pV)$。\n整个循环的总变化为：\n$\\Delta U_{\\mathrm{cycle}} = \\Delta U_{AB} + \\Delta U_{BC} + \\Delta U_{CD} + \\Delta U_{DA}$\n\n$\\Delta U_{AB} = \\frac{3}{2}(p_B V_B - p_A V_A) = \\frac{3}{2}(p_{\\mathrm{high}}V_{\\mathrm{high}} - p_{\\mathrm{high}}V_{\\mathrm{low}}) = \\frac{3}{2}p_{\\mathrm{high}}(V_{\\mathrm{high}} - V_{\\mathrm{low}})$\n$\\Delta U_{BC} = \\frac{3}{2}(p_C V_C - p_B V_B) = \\frac{3}{2}(p_{\\mathrm{low}}V_{\\mathrm{high}} - p_{\\mathrm{high}}V_{\\mathrm{high}}) = \\frac{3}{2}V_{\\mathrm{high}}(p_{\\mathrm{low}} - p_{\\mathrm{high}})$\n$\\Delta U_{CD} = \\frac{3}{2}(p_D V_D - p_C V_C) = \\frac{3}{2}(p_{\\mathrm{low}}V_{\\mathrm{low}} - p_{\\mathrm{low}}V_{\\mathrm{high}}) = \\frac{3}{2}p_{\\mathrm{low}}(V_{\\mathrm{low}} - V_{\\mathrm{high}})$\n$\\Delta U_{DA} = \\frac{3}{2}(p_A V_A - p_D V_D) = \\frac{3}{2}(p_{\\mathrm{high}}V_{\\mathrm{low}} - p_{\\mathrm{low}}V_{\\mathrm{low}}) = \\frac{3}{2}V_{\\mathrm{low}}(p_{\\mathrm{high}} - p_{\\mathrm{low}})$\n\n将这些项代数相加：\n$\\Delta U_{\\mathrm{cycle}} = \\frac{3}{2} [ (p_{\\mathrm{high}}V_{\\mathrm{high}} - p_{\\mathrm{high}}V_{\\mathrm{low}}) + (p_{\\mathrm{low}}V_{\\mathrm{high}} - p_{\\mathrm{high}}V_{\\mathrm{high}}) + (p_{\\mathrm{low}}V_{\\mathrm{low}} - p_{\\mathrm{low}}V_{\\mathrm{high}}) + (p_{\\mathrm{high}}V_{\\mathrm{low}} - p_{\\mathrm{low}}V_{\\mathrm{low}}) ]$\n重新排列后，所有项都抵消了：\n$\\Delta U_{\\mathrm{cycle}} = \\frac{3}{2} [ (p_{\\mathrm{high}}V_{\\mathrm{high}} - p_{\\mathrm{high}}V_{\\mathrm{high}}) + (-p_{\\mathrm{high}}V_{\\mathrm{low}} + p_{\\mathrm{high}}V_{\\mathrm{low}}) + (p_{\\mathrm{low}}V_{\\mathrm{high}} - p_{\\mathrm{low}}V_{\\mathrm{high}}) + (p_{\\mathrm{low}}V_{\\mathrm{low}} - p_{\\mathrm{low}}V_{\\mathrm{low}}) ] = \\frac{3}{2}[0] = 0$\n\n数值计算：\n$\\Delta U_{AB} = \\frac{3}{2}(2.750 \\times 10^5)(6.00 \\times 10^{-3}) = 2475\\,\\mathrm{J}$\n$\\Delta U_{BC} = \\frac{3}{2}(1.500 \\times 10^{-2})(-1.500 \\times 10^5) = -3375\\,\\mathrm{J}$\n$\\Delta U_{CD} = \\frac{3}{2}(1.250 \\times 10^5)(-6.00 \\times 10^{-3}) = -1125\\,\\mathrm{J}$\n$\\Delta U_{DA} = \\frac{3}{2}(9.00 \\times 10^{-3})(1.500 \\times 10^5) = 2025\\,\\mathrm{J}$\n$\\Delta U_{\\mathrm{cycle}} = 2475 - 3375 - 1125 + 2025 = 0\\,\\mathrm{J}$。\n显式计算证实了 $\\Delta U_{\\mathrm{cycle}} = 0$。\n\n任务3：计算循环热 $\\oint \\delta q = q_{\\mathrm{cycle}}$。\n根据热力学第一定律，对于一个完整循环：\n$$\\Delta U_{\\mathrm{cycle}} = q_{\\mathrm{cycle}} + w_{\\mathrm{cycle}}$$\n由于我们已经确定 $\\Delta U_{\\mathrm{cycle}} = 0$，因此必然有：\n$$q_{\\mathrm{cycle}} = -w_{\\mathrm{cycle}}$$\n因此，使用任务1的结果：\n$q_{\\mathrm{cycle}} = -(-900.0\\,\\mathrm{J}) = 900.0\\,\\mathrm{J}$\n四舍五入到三位有效数字，我们得到：\n$q_{\\mathrm{cycle}} = 9.00 \\times 10^2\\,\\mathrm{J}$\n\n所求的三个量的最终值是 $\\oint \\delta w = -9.00 \\times 10^2\\,\\mathrm{J}$、$\\oint \\delta q = 9.00 \\times 10^2\\,\\mathrm{J}$ 和 $\\Delta U_{\\mathrm{cycle}} = 0\\,\\mathrm{J}$。", "answer": "$$\\boxed{\\begin{pmatrix} -9.00 \\times 10^2  9.00 \\times 10^2  0 \\end{pmatrix}}$$", "id": "2959099"}, {"introduction": "与理想气体不同，真实气体的内能因分子间作用力而随体积变化。本练习将引导您进行推导，以量化范德华气体在等温膨胀过程中内能的变化。您将揭示由参数 $a$ 所代表的分子间引力是如何在体积变化时引起势能变化的，从而在微观相互作用和宏观热力学性质之间建立起切实的联系。[@problem_id:2959157]", "problem": "一个封闭的单相系统包含 $n$ 摩尔气体，在所有相关状态下，该气体都遵循范德华状态方程，其参数 $a$ 和 $b$ 不随温度变化。该气体在温度 $T$ 下经历一次可逆等温膨胀，从初始体积 $V_1$ 膨胀到最终体积 $V_2$，且 $V_2 > V_1$。忽略动能和势能的变化。请仅从封闭系统的热力学第一定律和标准热力学恒等式出发，推导沿此等温路径的内能变化 $\\Delta U$ 的精确表达式。你的推导必须明确指出是哪些非理想性特征对 $\\Delta U$ 有贡献。\n\n请以 $a$、$n$、$V_1$ 和 $V_2$ 的单个解析表达式形式报告你的最终结果。使用国际单位制 (SI)，其中 $a$ 的单位为 $\\mathrm{Pa \\cdot m^6 \\cdot mol^{-2}}$，体积单位为 $\\mathrm{m^3}$，能量单位为 $\\mathrm{J}$。不要代入数值。无需四舍五入。将最终答案表示为闭合形式的解析表达式。", "solution": "本题要求从热力学第一定律和标准热力学恒等式出发，推导范德华气体进行可逆等温膨胀过程的内能变化量 $\\Delta U$。\n\n对于经历可逆过程的封闭系统，热力学第一定律指出，内能的微分变化量 $dU$ 是系统吸收的热量 $dQ_{\\text{rev}}$ 与外界对系统做的功 $dW_{\\text{rev}}$ 之和。其微分形式为 $dU = dQ_{\\text{rev}} + dW_{\\text{rev}}$。对于可逆过程，我们有 $dQ_{\\text{rev}} = T dS$ 和 $dW_{\\text{rev}} = -P dV$。这导出了内能的基本方程：\n$$ dU = T dS - P dV $$\n内能 $U$ 是一个状态函数。因此，我们可以用任意两个独立的状态变量来表示其全微分。对于本问题，最方便的变量是温度 $T$ 和体积 $V$。$U(T, V)$ 的全微分为：\n$$ dU = \\left(\\frac{\\partial U}{\\partial T}\\right)_V dT + \\left(\\frac{\\partial U}{\\partial V}\\right)_T dV $$\n所考虑的过程是等温过程，这意味着温度 $T$ 恒定，因此其微分 $dT$ 为零。内能变化的表达式简化为：\n$$ dU_T = \\left(\\frac{\\partial U}{\\partial V}\\right)_T dV $$\n偏导数 $\\left(\\frac{\\partial U}{\\partial V}\\right)_T$ 被称为内压力，它量化了物质在恒温下内能随体积变化的程度。为了找到该项的表达式，我们回到基本方程 $dU = T dS - P dV$。在保持 $T$ 恒定的同时除以 $dV$ 得到：\n$$ \\left(\\frac{\\partial U}{\\partial V}\\right)_T = T \\left(\\frac{\\partial S}{\\partial V}\\right)_T - P $$\n这个表达式包含一个熵的偏导数，使用起来不方便。我们可以用一个麦克斯韦关系式来替换它。麦克斯韦关系式源于基本热力学势是状态函数这一事实，这意味着它们的混合二阶偏导数相等。相关的关系式来自亥姆霍兹自由能 $A = U - TS$。其微分为 $dA = dU - T dS - S dT = (T dS - P dV) - T dS - S dT = -S dT - P dV$。从 $A(T, V)$ 出发，混合偏导数的相等性 $\\frac{\\partial^2 A}{\\partial V \\partial T} = \\frac{\\partial^2 A}{\\partial T \\partial V}$ 意味着：\n$$ \\left(\\frac{\\partial (-S)}{\\partial V}\\right)_T = \\left(\\frac{\\partial (-P)}{\\partial T}\\right)_V \\implies \\left(\\frac{\\partial S}{\\partial V}\\right)_T = \\left(\\frac{\\partial P}{\\partial T}\\right)_V $$\n将此麦克斯韦关系式代入内压力的方程，得到一个关键的热力学状态方程：\n$$ \\left(\\frac{\\partial U}{\\partial V}\\right)_T = T \\left(\\frac{\\partial P}{\\partial T}\\right)_V - P $$\n这个方程是通用的，适用于任何流体。现在我们将其应用于范德华气体的具体情况。范德华状态方程为：\n$$ \\left(P + \\frac{an^2}{V^2}\\right)(V - nb) = nRT $$\n为了使用我们的热力学状态方程，我们必须首先求出 $\\left(\\frac{\\partial P}{\\partial T}\\right)_V$。我们重排范德华方程，将压力 $P$ 表示为 $T$ 和 $V$ 的函数：\n$$ P(T,V) = \\frac{nRT}{V - nb} - \\frac{an^2}{V^2} $$\n现在我们在 $V$ 和 $n$ 恒定的情况下，对 $P$ 求关于 $T$ 的偏导数：\n$$ \\left(\\frac{\\partial P}{\\partial T}\\right)_V = \\frac{\\partial}{\\partial T} \\left( \\frac{nRT}{V - nb} - \\frac{an^2}{V^2} \\right) = \\frac{nR}{V - nb} $$\n项 $\\frac{an^2}{V^2}$ 解释了分子间的引力，它与温度无关，因此其关于 $T$ 的导数为零。\n接下来，将这个 $\\left(\\frac{\\partial P}{\\partial T}\\right)_V$ 的结果代入内压力的表达式中：\n$$ \\left(\\frac{\\partial U}{\\partial V}\\right)_T = T \\left( \\frac{nR}{V - nb} \\right) - P $$\n现在，我们将范德华压力 $P$ 的完整表达式代回此方程：\n$$ \\left(\\frac{\\partial U}{\\partial V}\\right)_T = \\frac{nRT}{V - nb} - \\left( \\frac{nRT}{V - nb} - \\frac{an^2}{V^2} \\right) $$\n涉及压力动能分量的项相互抵消，留下一个非常简单的结果：\n$$ \\left(\\frac{\\partial U}{\\partial V}\\right)_T = \\frac{an^2}{V^2} $$\n这个结果明确地揭示了导致内能依赖于体积的非理想性特征。范德华气体的内压力不为零，完全是由于参数 $a$ 的存在，该参数代表分子间引力的强度。对于理想气体，$a=0$，因此 $\\left(\\frac{\\partial U}{\\partial V}\\right)_T = 0$，这意味着其内能仅依赖于温度。对于范德华气体，体积膨胀需要做功来克服这些引力将分子拉开，这增加了它们的势能，从而增加了系统的总内能。代表排除体积的参数 $b$ 对内压力没有贡献。\n\n为了求出从初始体积 $V_1$ 到最终体积 $V_2$ 的指定等温膨胀过程的总内能变化量 $\\Delta U$，我们必须沿该路径对 $dU_T$ 进行积分：\n$$ \\Delta U = \\int_{U(T,V_1)}^{U(T,V_2)} dU = \\int_{V_1}^{V_2} \\left(\\frac{\\partial U}{\\partial V}\\right)_T dV $$\n代入我们推导出的内压力表达式：\n$$ \\Delta U = \\int_{V_1}^{V_2} \\frac{an^2}{V^2} dV $$\n参数 $a$ 和 $n$ 是常数，所以我们可以将它们移到积分符号外面：\n$$ \\Delta U = an^2 \\int_{V_1}^{V_2} V^{-2} dV $$\n执行定积分得到：\n$$ \\Delta U = an^2 \\left[ -\\frac{1}{V} \\right]_{V_1}^{V_2} = an^2 \\left( \\left(-\\frac{1}{V_2}\\right) - \\left(-\\frac{1}{V_1}\\right) \\right) $$\n这简化为内能变化的最终解析表达式：\n$$ \\Delta U = an^2 \\left( \\frac{1}{V_1} - \\frac{1}{V_2} \\right) $$\n由于题目指定的是膨胀过程，$V_2  V_1$，因此可得 $\\frac{1}{V_1}  \\frac{1}{V_2}$。因此，项 $\\left( \\frac{1}{V_1} - \\frac{1}{V_2} \\right)$ 为正，且 $\\Delta U  0$。这证实了在范德华气体的等温膨胀过程中内能是增加的，这与需要能量来克服分子间引力的物理解释相一致。", "answer": "$$ \\boxed{an^{2} \\left( \\frac{1}{V_1} - \\frac{1}{V_2} \\right)} $$", "id": "2959157"}, {"introduction": "这项高级实践通过计算方法，在量子理论与宏观热力学之间架起了一座桥梁。利用给定的声子频率数据集，您将应用统计力学原理来构建固体的振动内能函数 $U(V,T)$。该练习展示了现代计算方法如何让我们能够直接从材料的微观量子行为出发，预测其热力学性质，例如热压。[@problem_id:2529333]", "problem": "提供给您一个合成的、但在科学上一致的数据集，该数据集模拟了晶体固体在几个不同体积下的第一性原理声子计算结果。您的任务是利用基础热力学和统计力学，构建作为体积和温度函数的振动内能 $U(V,T)$，并由此确定在准谐波近似下对状态方程的热压贡献。您的最终输出必须由一个完整的、可运行的程序生成。\n\n使用的基础理论：\n- 热力学第一定律：$dU = \\delta Q + \\delta W$，其中可逆功为 $\\delta W = -p\\,dV$，以及压力作为广义力的定义 $p = -\\left(\\partial F/\\partial V\\right)_{T}$，其中 $F$ 是亥姆霍兹自由能。\n- 量子谐振子的统计力学：正则配分函数、平衡平均值以及声子的玻色-爱因斯坦占据数。\n- 准谐波近似 (QHA)：振动频率依赖于体积 $V$，但不显式依赖于温度 $T$。\n\n数据集：\n- 体积，单位为立方埃/化学式单位：$V_{1} = 15.00$, $V_{2} = 15.75$, $V_{3} = 16.50$。\n- 对于每个体积 $V_{k}$，给定一组 $6$ 个声子模式频率（单位为太赫兹），代表一个包含 $N=2$ 个原子的原胞的 $3N$ 个简正模式（每个列出的模式简并度 $=1$）。模式的标识（排序）在不同体积间是一致的。\n  - 在 $V_{1}$ 下：$\\{11.0,\\,9.0,\\,7.0,\\,5.0,\\,3.5,\\,2.0\\}$。\n  - 在 $V_{2}$ 下：$\\{10.3,\\,8.5,\\,6.6,\\,4.7,\\,3.3,\\,1.9\\}$。\n  - 在 $V_{3}$ 下：$\\{9.8,\\,8.0,\\,6.2,\\,4.4,\\,3.1,\\,1.8\\}$。\n\n使用的常数和单位：\n- 约化普朗克常数 $\\hbar = 1.054\\,571\\,817\\times 10^{-34}\\ \\mathrm{J\\cdot s}$。\n- 玻尔兹曼常数 $k_{\\mathrm{B}} = 1.380\\,649\\times 10^{-23}\\ \\mathrm{J/K}$。\n- 电子伏特到焦耳转换：$1\\ \\mathrm{eV} = 1.602\\,176\\,634\\times 10^{-19}\\ \\mathrm{J}$。\n- 频率转换：如果 $\\nu$ 的单位是太赫兹，则角频率为 $\\omega = 2\\pi\\,\\nu\\times 10^{12}\\ \\mathrm{rad/s}$。\n- 体积转换：$1\\ \\text{\\AA}^{3} = 10^{-30}\\ \\mathrm{m}^{3}$。\n\n您必须从基础理论出发实现的的热力学构造：\n1. 对于每个角频率为 $\\omega(V)$ 的简正模式，必须从平衡统计力学中获得其量子谐振子内能 $U_{\\text{mode}}(V,T)$。定义零温极限 $U_{\\text{mode}}(V,0)$，以计算纯热学部分 $U_{\\text{mode,th}}(V,T) = U_{\\text{mode}}(V,T) - U_{\\text{mode}}(V,0)$。\n2. 利用压力是亥姆霍兹自由能对体积在恒温下的导数的定义，以及频率的准谐波体积依赖性，来表达振动压力。将热压贡献定义为 $P_{\\text{th}}(V,T) = P_{\\text{vib}}(V,T) - P_{\\text{vib}}(V,0)$，这样根据构造可得 $P_{\\text{th}}(V,0)=0$。\n3. 对于每个模式 $i$，使用 $V_{1}$ 和 $V_{3}$ 的数据，通过频率对数对体积对数的中心有限差分斜率来估计其模式分辨的格林艾森参数：\n   $$\\gamma_{i} \\equiv -\\frac{\\partial \\ln \\omega_{i}}{\\partial \\ln V}\\approx -\\frac{\\ln \\omega_{i}(V_{3}) - \\ln \\omega_{i}(V_{1})}{\\ln V_{3} - \\ln V_{1}}.$$\n   在所提供的体积范围内，将这些 $\\gamma_{i}$ 用作与体积无关的常数，以计算表格中各体积下的 $P_{\\text{th}}(V,T)$。\n4. 对于给定的 $V$ 和 $T$，内能 $U(V,T)$ 是在该 $V$ 下所有列出模式的能量之和。\n5. 热压 $P_{\\text{th}}(V,T)$ 必须通过适当的热力学关系以帕斯卡为单位进行计算，然后以吉帕斯卡为单位进行报告。\n\n编程任务：\n- 实现一个程序，该程序：\n  - 完全按照上面给出的数据集使用（无插值；仅在 $V\\in\\{V_{1},V_{2},V_{3}\\}$ 处进行计算）。\n  - 为每个测试用例计算 $U(V,T)$（单位为电子伏特/化学式单位）和 $P_{\\text{th}}(V,T)$（单位为吉帕斯卡）。\n  - 将每个报告的数字四舍五入到 $6$ 位小数。\n\n测试套件：\n- 案例 1：$V=15.75\\ \\text{\\AA}^{3}$，$T=0\\ \\mathrm{K}$。\n- 案例 2：$V=15.75\\ \\text{\\AA}^{3}$，$T=300\\ \\mathrm{K}$。\n- 案例 3：$V=16.50\\ \\text{\\AA}^{3}$，$T=1000\\ \\mathrm{K}$。\n- 案例 4：$V=15.00\\ \\text{\\AA}^{3}$，$T=10\\ \\mathrm{K}$。\n\n答案规范：\n- 对于每个测试用例，按此顺序输出两个浮点数：$U(V,T)$（单位为 $\\mathrm{eV}$）和 $P_{\\text{th}}(V,T)$（单位为 $\\mathrm{GPa}$），每个都四舍五入到 $6$ 位小数。\n- 将所有案例的结果按照上述测试套件的顺序汇总到一个扁平列表中，并打印包含该列表的一行，格式为用方括号括起来的逗号分隔列表，例如 $[u_{1},p_{1},u_{2},p_{2},u_{3},p_{3},u_{4},p_{4}]$。\n- 角度不出现；温度必须以开尔文为单位处理；在代入热力学表达式时，体积必须以立方米为单位处理；频率在使用前必须转换为角频率，单位为弧度/秒。\n\n科学真实性要求：\n- 将每个列出的模式视为独立的谐振子。\n- 确保所有步骤中的单位一致性。\n- 不要引入任何无法从所述基础理论推导出的公式；而应在您的解决方案中实现您从中推导出的关系。", "solution": "问题要求基于给定的一组在几个不同体积下的声子频率，计算晶体固体的总振动内能 $U(V,T)$ 和热压 $P_{\\text{th}}(V,T)$。解决方案将根据统计力学和热力学的基础原理，在准谐波近似 (QHA) 下构建。\n\n**1. 理论基础**\n\n晶体固体的振动状态可以建模为一组独立的量子谐振子 (QHO)，每个谐振子对应一个角频率为 $\\omega$ 的简正模式（声子）。在 QHA 中，这些频率依赖于体积但不显式依赖于温度，即 $\\omega_i = \\omega_i(V)$。\n\n**1.1. 振动内能 $U(V,T)$**\n\n角频率为 $\\omega$ 的单个 QHO 的能级为 $E_n = \\hbar\\omega(n + 1/2)$，其中 $n=0, 1, 2, \\dots$。单个模式的正则配分函数是：\n$$ Z_{\\text{mode}} = \\sum_{n=0}^{\\infty} e^{-E_n / (k_B T)} = e^{-\\hbar\\omega / (2k_B T)} \\sum_{n=0}^{\\infty} \\left(e^{-\\hbar\\omega / (k_B T)}\\right)^n = \\frac{e^{-\\hbar\\omega / (2k_B T)}}{1 - e^{-\\hbar\\omega / (k_B T)}} $$\n该模式的平均内能 $U_{\\text{mode}}$，是使用标准的统计力学关系 $U = -\\partial(\\ln Z)/\\partial\\beta$ 求得的，其中 $\\beta = 1/(k_B T)$：\n$$ U_{\\text{mode}}(V,T) = -\\frac{\\partial}{\\partial\\beta} \\ln Z_{\\text{mode}} = \\frac{\\hbar\\omega(V)}{2} + \\frac{\\hbar\\omega(V)}{e^{\\hbar\\omega(V)/(k_B T)} - 1} $$\n这个表达式由两部分组成：与温度无关的零点能 (ZPE) $U_{\\text{mode}}(V,0) = \\frac{1}{2}\\hbar\\omega(V)$，以及一个代表热激发的与温度相关的项。量 $n_B(\\omega, T) = (e^{\\hbar\\omega/(k_B T)} - 1)^{-1}$ 是玻色-爱因斯坦分布，即该模式中声子的平均占据数。\n\n每个化学式单位的固体总内能 $U(V,T)$ 是所有 $3N$ 个模式（其中 $N$ 是每个化学式单位的原子数）的能量之和：\n$$ U(V,T) = \\sum_{i=1}^{3N} U_{\\text{mode}, i}(V,T) = \\sum_{i=1}^{3N} \\left[ \\frac{\\hbar\\omega_i(V)}{2} + \\frac{\\hbar\\omega_i(V)}{e^{\\hbar\\omega_i(V)/(k_B T)} - 1} \\right] $$\n对于本问题，我们给定了一个包含 $N=2$ 个原子的原胞的 $6$ 个模式，因此求和是针对这 $6$ 个模式。这就是要为 $U(V,T)$ 实现的公式。\n\n**1.2. 热压 $P_{\\text{th}}(V,T)$**\n\n压力是亥姆霍兹自由能 $F$ 对体积的热力学导数：$P = -(\\partial F/\\partial V)_T$。单个模式的自由能是 $F_{\\text{mode}} = -k_B T \\ln Z_{\\text{mode}}$：\n$$ F_{\\text{mode}}(V,T) = \\frac{\\hbar\\omega(V)}{2} + k_B T \\ln\\left(1 - e^{-\\hbar\\omega(V)/(k_B T)}\\right) $$\n总自由能是 $F(V,T) = \\sum_i F_{\\text{mode},i}(V,T)$。那么振动压力是：\n$$ P_{\\text{vib}}(V,T) = -\\left(\\frac{\\partial F(V,T)}{\\partial V}\\right)_T = -\\sum_i \\frac{\\partial F_{\\text{mode},i}}{\\partial \\omega_i} \\frac{d\\omega_i}{dV} $$\n可以证明 $\\partial F_{\\text{mode},i}/\\partial \\omega_i = U_{\\text{mode},i}/\\omega_i$。为了处理频率的体积导数，我们引入无量纲的模式格林艾森参数 $\\gamma_i$：\n$$ \\gamma_i(V) \\equiv -\\frac{d\\ln\\omega_i}{d\\ln V} = -\\frac{V}{\\omega_i(V)}\\frac{d\\omega_i(V)}{dV} $$\n这使得我们可以写出 $\\frac{d\\omega_i}{dV} = -\\frac{\\gamma_i \\omega_i}{V}$。将此代入压力表达式中得到：\n$$ P_{\\text{vib}}(V,T) = \\sum_i \\frac{\\gamma_i(V)}{V} U_{\\text{mode},i}(V,T) $$\n问题要求的是热压 $P_{\\text{th}}(V,T)$，即相对于 $T=0\\ \\mathrm{K}$ 的压力变化。\n$$ P_{\\text{th}}(V,T) = P_{\\text{vib}}(V,T) - P_{\\text{vib}}(V,0) $$\n$$ P_{\\text{th}}(V,T) = \\sum_i \\frac{\\gamma_i(V)}{V} \\left[ U_{\\text{mode},i}(V,T) - U_{\\text{mode},i}(V,0) \\right] $$\n方括号中的项是内能的纯热学部分，$U_{\\text{mode,th},i}(V,T) = \\hbar\\omega_i(V)/(e^{\\hbar\\omega_i(V)/(k_B T)} - 1)$。因此，热压的最终表达式是：\n$$ P_{\\text{th}}(V,T) = \\frac{1}{V} \\sum_{i=1}^{3N} \\gamma_i(V) \\left( \\frac{\\hbar\\omega_i(V)}{e^{\\hbar\\omega_i(V)/(k_B T)} - 1} \\right) $$\n根据定义，$P_{\\text{th}}(V,0) = 0$。\n\n**2. 计算实现**\n\n计算过程如下：\n\n首先，假设模式格林艾森参数 $\\gamma_i$ 在体积范围内是常数，使用提供的有限差分公式以及体积 $V_1 = 15.00\\ \\text{\\AA}^3$ 和 $V_3 = 16.50\\ \\text{\\AA}^3$ 的数据来估计它们。由于 $\\omega_i$ 与频率 $\\nu_i$ 成正比，我们可以直接在公式中使用 $\\nu_i$：\n$$ \\gamma_{i} \\approx -\\frac{\\ln \\nu_{i}(V_{3}) - \\ln \\nu_{i}(V_{1})}{\\ln V_{3} - \\ln V_{1}} $$\n对 $6$ 个模式中的每一个都执行一次此计算。\n\n其次，对于由一对 $(V, T)$ 指定的每个测试用例，我们检索相应的声子频率列表 $\\nu_i(V)$。\n\n第三，我们计算总内能 $U(V,T)$。对于 $6$ 个模式中的每一个，我们使用 $\\omega_i = 2\\pi\\nu_i \\times 10^{12}$ 将其频率 $\\nu_i$（单位 THz）转换为角频率 $\\omega_i$（单位 rad/s）。然后我们应用推导出的 $U(V,T)$ 公式，对所有模式的贡献求和。对于 $T=0\\ \\mathrm{K}$，热学项为零，$U(V,0)$ 仅是零点能之和。所有计算都使用国际单位制（J, K, m$^3$），最终结果从焦耳转换为电子伏特 (eV)。\n\n第四，我们计算热压 $P_{\\text{th}}(V,T)$。对于 $T=0\\ \\mathrm{K}$，根据定义热压为 $0$。对于 $T  0\\ \\mathrm{K}$，我们使用 $P_{\\text{th}}(V,T)$ 的公式，对所有模式的贡献求和。体积 $V$ 必须从 $\\text{\\AA}^3$ 转换为 $\\text{m}^3$。计算得出以帕斯卡 (Pa) 为单位的压力，然后将其转换为吉帕斯卡 (GPa)。\n\n最后，按要求将计算出的 $U(V,T)$ 和 $P_{\\text{th}}(V,T)$ 值四舍五入到 $6$ 位小数。所有常数和单位转换都严格按照问题陈述中的规定进行处理。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of calculating vibrational internal energy and thermal pressure\n    for a crystalline solid based on provided phonon frequency data.\n    \"\"\"\n    # Define constants in SI units as specified\n    HBAR = 1.054571817e-34  # J*s\n    KB = 1.380649e-23      # J/K\n    EV_TO_J = 1.602176634e-19 # J/eV\n    A3_TO_M3 = 1e-30        # m^3/A^3\n    THZ_TO_RAD_S = 2 * np.pi * 1e12 # rad/s / THz\n\n    # Define the dataset from the problem statement\n    # Volumes in cubic angstrom per formula unit\n    V1, V2, V3 = 15.00, 15.75, 16.50\n    # Phonon frequencies in terahertz for each volume\n    FREQS = {\n        V1: np.array([11.0, 9.0, 7.0, 5.0, 3.5, 2.0]),\n        V2: np.array([10.3, 8.5, 6.6, 4.7, 3.3, 1.9]),\n        V3: np.array([9.8, 8.0, 6.2, 4.4, 3.1, 1.8]),\n    }\n\n    def calculate_gruneisen_parameters(v1, v3, freqs_v1, freqs_v3):\n        \"\"\"\n        Calculates mode Gruneisen parameters using a centered finite-difference formula.\n        The parameters are assumed to be volume-independent.\n        \"\"\"\n        log_v_ratio = np.log(v3 / v1)\n        log_freq_ratio = np.log(freqs_v3 / freqs_v1)\n        return -log_freq_ratio / log_v_ratio\n\n    def calculate_properties(V_A3, T_K, freqs_thz, gammas):\n        \"\"\"\n        Computes total internal energy U(V,T) in eV and thermal pressure P_th(V,T) in GPa.\n        \n        Args:\n            V_A3 (float): Volume in cubic angstroms.\n            T_K (float): Temperature in Kelvin.\n            freqs_thz (np.ndarray): Array of phonon frequencies in THz.\n            gammas (np.ndarray): Array of mode Gruneisen parameters.\n        \n        Returns:\n            tuple: (U in eV, P_th in GPa), rounded to 6 decimal places.\n        \"\"\"\n        # Use a small tolerance for floating point comparison with zero\n        is_zero_temp = T_K  1e-9\n\n        # Convert inputs to SI units\n        V_m3 = V_A3 * A3_TO_M3\n        omegas_rad_s = freqs_thz * THZ_TO_RAD_S\n\n        # --- Calculate total internal energy U(V,T) ---\n        # U = U_zpe + U_thermal\n        zpe_per_mode_j = 0.5 * HBAR * omegas_rad_s\n        total_zpe_j = np.sum(zpe_per_mode_j)\n\n        if is_zero_temp:\n            total_thermal_energy_j = 0.0\n        else:\n            exp_arg = (HBAR * omegas_rad_s) / (KB * T_K)\n            # Use np.expm1 for better numerical stability when exp_arg is small\n            # Use np.divide with a 'where' clause to handle potential division by zero\n            # if any exp_arg were to become zero (not the case here, but good practice).\n            thermal_energy_per_mode_j = np.divide(\n                HBAR * omegas_rad_s, np.expm1(exp_arg),\n                out=np.zeros_like(omegas_rad_s),\n                where=(np.expm1(exp_arg) != 0)\n            )\n            total_thermal_energy_j = np.sum(thermal_energy_per_mode_j)\n        \n        total_energy_j = total_zpe_j + total_thermal_energy_j\n        total_energy_ev = total_energy_j / EV_TO_J\n\n        # --- Calculate thermal pressure P_th(V,T) ---\n        # P_th = (1/V) * sum(gamma_i * U_thermal_i)\n        if is_zero_temp:\n            thermal_pressure_gpa = 0.0\n        else:\n            exp_arg = (HBAR * omegas_rad_s) / (KB * T_K)\n            thermal_energy_per_mode_j = np.divide(\n                HBAR * omegas_rad_s, np.expm1(exp_arg),\n                out=np.zeros_like(omegas_rad_s),\n                where=(np.expm1(exp_arg) != 0)\n            )\n            pressure_sum_j = np.sum(gammas * thermal_energy_per_mode_j)\n            thermal_pressure_pa = pressure_sum_j / V_m3\n            thermal_pressure_gpa = thermal_pressure_pa / 1e9\n\n        return round(total_energy_ev, 6), round(thermal_pressure_gpa, 6)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (15.75, 0.0),    # Case 1\n        (15.75, 300.0),  # Case 2\n        (16.50, 1000.0), # Case 3\n        (15.00, 10.0),   # Case 4\n    ]\n\n    # Pre-calculate the volume-independent Gruneisen parameters\n    gammas = calculate_gruneisen_parameters(V1, V3, FREQS[V1], FREQS[V3])\n    \n    results = []\n    for V_case, T_case in test_cases:\n        # Select the appropriate frequency set for the volume\n        freqs_case = FREQS[V_case]\n        # Calculate properties for the test case\n        u_val, p_val = calculate_properties(V_case, T_case, freqs_case, gammas)\n        results.append(u_val)\n        results.append(p_val)\n        \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2529333"}]}