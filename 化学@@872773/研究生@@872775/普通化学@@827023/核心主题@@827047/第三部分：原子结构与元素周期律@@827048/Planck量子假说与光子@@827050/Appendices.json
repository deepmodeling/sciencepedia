{"hands_on_practices": [{"introduction": "这项练习将带您深入研究催生量子理论的历史转折点之一：黑体辐射。通过分别推导经典的瑞利-金斯定律和普朗克的量子定律，您将亲眼见证并量化经典物理学在高频区域的彻底失败——即所谓的“紫外灾变”。本练习旨在巩固您对普朗克革命性的能量量子化假说如何解决这场危机并为量子力学奠定基础的理解。[@problem_id:2951477]", "problem": "一个体积为 $V$ 的完美吸收腔体在温度 $T$ 下处于热平衡状态。考虑腔内电磁（EM）场的单位频率谱能量密度 $u(\\nu,T)$。仅使用以下基本要素：\n- 温度为 $T$ 时谐振模式的经典能量均分定理。\n- Planck 的量子假设，即频率为 $\\nu$ 的模式的能量是量子化的，为 $E_{n} = n h \\nu$，其中 $n = 0,1,2,\\dots$（在计算热可及能量时忽略零点能）。\n- 正则系综中的 Boltzmann 分布。\n- 在三维空间中，经过充分检验的单位体积单位频率的电磁模式密度为 $g(\\nu) = \\dfrac{8\\pi \\nu^{2}}{c^{3}}$。\n\n(a) 将每个模式的平均能量的能量均分结果与 $g(\\nu)$ 相结合，推导出 $u(\\nu,T)$ 的经典 Rayleigh–Jeans 表达式。\n\n(b) 将由 Planck 假设所蕴含的每个量子化模式的正则系综平均能量与 $g(\\nu)$ 相结合，推导出 $u(\\nu,T)$ 的量子（Planck）表达式。\n\n(c) 根据你在(a)和(b)中的结果，求出在相同温度 $T$ 和频率 $\\nu$ 下，Rayleigh–Jeans 谱能量密度与 Planck 谱能量密度的比值 $R(T,\\nu)$。\n\n(d) 在 $T = 1800\\ \\mathrm{K}$ 和 $\\nu = 7.500 \\times 10^{13}\\ \\mathrm{s}^{-1}$ 条件下计算 $R(T,\\nu)$。使用 $h = 6.62607015 \\times 10^{-34}\\ \\mathrm{J\\,s}$，$k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}\\ \\mathrm{J\\,K}^{-1}$ 和 $c = 2.99792458 \\times 10^{8}\\ \\mathrm{m\\,s}^{-1}$。将你的最终答案表示为一个纯数（无量纲），并四舍五入到五位有效数字。", "solution": "问题陈述在科学上是合理的、适定的、客观的和完整的。这是统计力学和量子理论中关于黑体辐射理论历史发展的标准问题。该问题是有效的，可以按所述方式解决。\n\n分析将按照问题陈述中描述的四个部分进行。单位频率的谱能量密度 $u(\\nu, T)$ 定义为单位体积单位频率的电磁模式密度 $g(\\nu)$ 与每个模式的平均能量 $\\langle E \\rangle$ 的乘积。\n$$u(\\nu, T) = g(\\nu) \\langle E \\rangle$$\n给定的模式密度为 $g(\\nu) = \\dfrac{8\\pi \\nu^{2}}{c^{3}}$。\n\n(a) Rayleigh–Jeans 表达式的推导\n为了推导经典的 Rayleigh–Jeans 定律，我们必须确定每个模式的经典平均能量 $\\langle E \\rangle_{classical}$。问题要求使用能量均分定理。腔内的电磁模式表现得像一个经典谐振子。一维谐振子的能量有两个二次项（一个动能项，一个势能项）。根据能量均分定理，在温度为 $T$ 的热平衡状态下，每个二次自由度对系统贡献的平均能量为 $\\dfrac{1}{2} k_{\\mathrm{B}} T$，其中 $k_{\\mathrm{B}}$ 是 Boltzmann 常数。\n因此，单个模式的平均能量为：\n$$\\langle E \\rangle_{classical} = 2 \\times \\frac{1}{2} k_{\\mathrm{B}} T = k_{\\mathrm{B}} T$$\n然后，将此平均能量代入 $u(\\nu, T)$ 的一般表达式，得到 Rayleigh–Jeans 谱能量密度 $u_{RJ}(\\nu, T)$：\n$$u_{RJ}(\\nu, T) = \\left( \\frac{8\\pi \\nu^{2}}{c^{3}} \\right) k_{\\mathrm{B}} T$$\n这就是 Rayleigh–Jeans 公式。\n\n(b) Planck 表达式的推导\n为了推导量子（Planck）表达式，我们必须计算一个模式的量子力学平均能量 $\\langle E \\rangle_{quantum}$。问题提供了 Planck 的假设，该假设将频率为 $\\nu$ 的振子的能量量子化为 $E_{n} = n h \\nu$，其中 $n$ 是一个非负整数（$n=0, 1, 2, \\dots$），$h$ 是 Planck 常数。\n平均能量使用正则系综和 Boltzmann 分布计算。一个模式具有能量 $E_n$ 的概率 $P(E_n)$ 与 Boltzmann 因子 $\\exp(-E_{n} / k_{\\mathrm{B}} T)$ 成正比。\n平均能量是所有可能能量按其各自概率加权的总和：\n$$\\langle E \\rangle_{quantum} = \\frac{\\sum_{n=0}^{\\infty} E_{n} \\exp(-E_{n}/k_{\\mathrm{B}}T)}{\\sum_{n=0}^{\\infty} \\exp(-E_{n}/k_{\\mathrm{B}}T)}$$\n分母是配分函数 $Z$。让我们代入 $E_{n} = n h \\nu$ 并定义 $\\beta = 1/(k_{\\mathrm{B}}T)$。\n$$Z = \\sum_{n=0}^{\\infty} \\exp(-n h \\nu \\beta) = \\sum_{n=0}^{\\infty} (\\exp(-h \\nu \\beta))^{n}$$\n这是一个公比为 $r = \\exp(-h \\nu \\beta)$ 的几何级数，对于 $T > 0$，该公比小于 $1$。其和为 $Z = \\dfrac{1}{1 - \\exp(-h \\nu \\beta)}$。\n分子是：\n$$\\sum_{n=0}^{\\infty} (n h \\nu) \\exp(-n h \\nu \\beta) = h \\nu \\sum_{n=0}^{\\infty} n (\\exp(-h \\nu \\beta))^{n}$$\n一个方便的计算方法是注意到 $\\sum n x^n = x \\frac{d}{dx} \\sum x^n$。或者，可以使用关系式 $\\langle E \\rangle = -\\dfrac{\\partial \\ln Z}{\\partial \\beta}$。\n使用后一种方法：\n$$\\ln Z = -\\ln(1 - \\exp(-h \\nu \\beta))$$\n$$\\langle E \\rangle_{quantum} = -\\frac{\\partial}{\\partial \\beta} [-\\ln(1 - \\exp(-h \\nu \\beta))] = \\frac{1}{1 - \\exp(-h \\nu \\beta)} \\cdot \\frac{\\partial}{\\partial \\beta}(1 - \\exp(-h \\nu \\beta))$$\n$$\\langle E \\rangle_{quantum} = \\frac{1}{1 - \\exp(-h \\nu \\beta)} \\cdot (- \\exp(-h \\nu \\beta)) \\cdot (-h \\nu) = \\frac{h \\nu \\exp(-h \\nu \\beta)}{1 - \\exp(-h \\nu \\beta)}$$\n将分子和分母同乘以 $\\exp(h \\nu \\beta)$，得到平均能量的最终形式：\n$$\\langle E \\rangle_{quantum} = \\frac{h \\nu}{\\exp(h \\nu \\beta) - 1} = \\frac{h \\nu}{\\exp(h \\nu / k_{\\mathrm{B}} T) - 1}$$\n然后，通过代入这个量子平均能量，找到 Planck 谱能量密度 $u_{P}(\\nu, T)$：\n$$u_{P}(\\nu, T) = g(\\nu) \\langle E \\rangle_{quantum} = \\left( \\frac{8\\pi \\nu^{2}}{c^{3}} \\right) \\left( \\frac{h \\nu}{\\exp(h \\nu / k_{\\mathrm{B}} T) - 1} \\right) = \\frac{8\\pi h \\nu^{3}}{c^{3}} \\frac{1}{\\exp(h \\nu / k_{\\mathrm{B}} T) - 1}$$\n这就是 Planck 辐射定律。\n\n(c) Rayleigh–Jeans 密度与 Planck 密度的比值\n比值 $R(T, \\nu)$ 定义为 Rayleigh–Jeans 谱能量密度除以 Planck 谱能量密度：\n$$R(T, \\nu) = \\frac{u_{RJ}(\\nu, T)}{u_{P}(\\nu, T)} = \\frac{\\dfrac{8\\pi \\nu^{2} k_{\\mathrm{B}} T}{c^{3}}}{\\dfrac{8\\pi h \\nu^{3}}{c^{3}} \\dfrac{1}{\\exp(h \\nu / k_{\\mathrm{B}} T) - 1}}$$\n公因子 $\\dfrac{8\\pi \\nu^{2}}{c^{3}}$ 从分子和分母中约去。\n$$R(T, \\nu) = \\frac{k_{\\mathrm{B}} T}{h \\nu} (\\exp(h \\nu / k_{\\mathrm{B}} T) - 1)$$\n这就是该比值的解析表达式。\n\n(d) 数值计算\n我们必须对给定值计算 $R(T, \\nu)$：\n$T = 1800\\ \\mathrm{K}$\n$\\nu = 7.500 \\times 10^{13}\\ \\mathrm{s}^{-1}$\n$h = 6.62607015 \\times 10^{-34}\\ \\mathrm{J\\,s}$\n$k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}\\ \\mathrm{J\\,K}^{-1}$\n\n首先，我们计算无量纲量 $x = \\dfrac{h \\nu}{k_{\\mathrm{B}} T}$：\n$$x = \\frac{(6.62607015 \\times 10^{-34}\\ \\mathrm{J\\,s}) \\times (7.500 \\times 10^{13}\\ \\mathrm{s}^{-1})}{(1.380649 \\times 10^{-23}\\ \\mathrm{J\\,K}^{-1}) \\times (1800\\ \\mathrm{K})}$$\n$$x = \\frac{4.9695526125 \\times 10^{-20}\\ \\mathrm{J}}{2.4851682 \\times 10^{-20}\\ \\mathrm{J}} \\approx 1.999683700$$\n比值 $R(T, \\nu)$ 可以用 $x$ 表示为：\n$$R(x) = \\frac{1}{x} (\\exp(x) - 1)$$\n代入 $x$ 的值：\n$$R \\approx \\frac{1}{1.999683700} (\\exp(1.999683700) - 1)$$\n$$R \\approx \\frac{1}{1.999683700} (7.386766020 - 1)$$\n$$R \\approx \\frac{6.386766020}{1.999683700} \\approx 3.19391090$$\n按要求将结果四舍五入到五位有效数字，得到 $3.1939$。", "answer": "$$\\boxed{3.1939}$$", "id": "2951477"}, {"introduction": "在普朗克初步假说的基础上，爱因斯坦提出光本身被量子化为称为光子的粒子。这项练习聚焦于光电效应，这是一个为光子概念提供直接证据的关键现象。您将把能量守恒原理应用于光子-电子相互作用，以推导出光的频率与实验中的截止电压之间的关系，从而使光子能量这一抽象概念变得具体且可测量。[@problem_id:2951441]", "problem": "在一次对真空中洁净金属表面进行的光电发射实验中，频率为 $\\nu$ 的单色光照射到该表面上，电子被发射出来。在发射极和收集极之间施加一个可变的反向电压，当该电压达到一个特定值时，光电流降至 $0$，这个特定值被称为截止电压。设 $h$ 表示普朗克常数，$e$ 表示元电荷的大小，$\\phi$ 表示金属的功函数。假设频率 $\\nu$ 足够高，使得电子能够被发射出来，并且存在一个有限的截止电压。仅从能量守恒、电磁辐射量子化为光子，以及截止电压是将最大电子动能减小到 $0$ 的最小反向电压这一定义出发，推导截止电压 $V_{s}$ 关于 $h$、$\\nu$、$\\phi$ 和 $e$ 的简化符号表达式。在您的推导中，用物理术语明确定义功函数 $\\phi$。将您的最终结果表示为 $V_{s}$ 的单个符号表达式。在您最终的方框答案中不要包含单位。", "solution": "仔细审查问题陈述，发现其是有效的。它提出了一个关于光电效应的标准、适定的物理学问题，该问题基于已确立的科学原理——即能量守恒和 Planck 的量子假说。所提供的变量和条件对于推导所要求的关系是充分且一致的。语言客观且明确。因此，我们可以开始推导。\n\n主导光电发射过程的基本原理是能量守恒。根据 Planck 提出并后来由 Einstein 应用于光的量子假说，频率为 $\\nu$ 的电磁辐射由称为光子的离散能量量子组成。单个光子的能量 $E_{photon}$ 由以下关系式给出：\n$$E_{photon} = h\\nu$$\n其中 $h$ 是普朗朗克常数。\n\n在光电效应中，单个光子被金属表面的单个电子吸收。吸收的能量的一部分被电子用来克服将其束缚在金属中的静电力。电子从材料表面逸出所需的最小能量是该金属的一个特征属性，称为功函数，用 $\\phi$ 表示。\n\n光子能量在克服功函数后剩余的任何能量都会转化为发射出的电子（称为光电子）的动能 $K$。因此，该过程的能量守恒方程可以写为：\n$$E_{photon} = \\phi + K$$\n代入光子能量的表达式得到：\n$$h\\nu = \\phi + K$$\n从表面发射出的电子并非都具有相同的动能。这是因为电子在金属内处于不同的能级，并且在逸出前可能通过碰撞损失一些能量。最大动能 $K_{max}$ 由那些束缚最不紧密且无能量损失而逸出的电子所拥有，对于这些电子，其逸出所需的能量恰好是功函数 $\\phi$。对于这些能量最高的电子，能量守恒方程为：\n$$h\\nu = \\phi + K_{max}$$\n问题定义了施加在发射极和收集极之间的反向电压 $V$。该电压产生一个电场，抵抗发射出的电子的运动。截止电压 $V_s$ 是该反向电压的一个特定值，它恰好足以阻止即使是能量最高的电子的流动。对于一个电荷大小为 $e$ 的电子，在电势差 $V_s$ 中反向运动，电场对该电子做的功是 $e V_s$。在截止电压下，这个功必须恰好等于光电子的最大动能。因此，我们有定义：\n$$K_{max} = e V_s$$\n现在我们可以将 $K_{max}$ 的这个表达式代入我们的能量守恒方程中：\n$$h\\nu = \\phi + e V_s$$\n目标是推导截止电压 $V_s$ 的符号表达式。为此，我们重新整理方程以分离出包含 $V_s$ 的项：\n$$e V_s = h\\nu - \\phi$$\n最后，将方程两边同时除以元电荷 $e$，得到所求的截止电压表达式：\n$$V_s = \\frac{h\\nu - \\phi}{e}$$\n这就是 $V_s$ 关于给定参数 $h$、$\\nu$、$\\phi$ 和 $e$ 的简化符号表达式。", "answer": "$$\\boxed{\\frac{h\\nu - \\phi}{e}}$$", "id": "2951441"}, {"introduction": "要巩固光子这一概念，关键在于理解它不仅拥有能量，还像粒子一样在碰撞中表现出动量。这项高级练习将探讨康普顿散射，这是证明光子动量存在的决定性证据。您不仅需要从相对论性的能量-动量守恒中推导出理论公式，还将参与一项实际的数据分析任务：利用加权最小二乘法从模拟实验数据中估算普朗克常数，从而将基础理论与现代科学实践联系起来。[@problem_id:2951509]", "problem": "给定从单色 X 射线源经过自由静止电子弹性散射后的光子波长的合成康普顿散射测量数据。仅从以下基本关系和事实出发，推导从数据中估计普朗克常数 $h$ 所需的统计模型，并将其实现为一个程序：\n\n- 普朗克关系 $E = h \\nu$ 和光子动量大小 $p_{\\gamma} = h/\\lambda$，其中对于以光速 $c$ 运动的光子，$E = pc$。\n- 光子与初始静止的自由电子（静止质量为 $m_{e}$）之间碰撞的总能量和总线性动量守恒。\n- 高斯测量模型：如果一个测量量的仪器分辨率已知且等于标准差 $\\sigma$，那么测量误差可以理想化为一个均值为 $0$、方差为 $\\sigma^{2}$ 的独立正态随机变量。\n\n您的推导必须产生一个参数线性关系，该关系允许根据已知散射角的散射波长偏移测量值来估计 $h$。将电子视作自由且初始静止，并假设入射波长已知且不确定性可忽略不计。仪器分辨率以每次散射波长测量的已知标准差形式提供，并且必须在估计量和置信区间中得到适当的应用。\n\n使用的常数：\n- 电子静止质量 $m_{e} = 9.1093837015 \\times 10^{-31}$ kg\n- 光速 $c = 299792458$ m/s\n\n程序要求：\n- 在由仪器分辨率引起的高斯噪声模型下，使用加权最小二乘法（WLS）作为最大似然估计量（MLE）来估计 $h$。\n- 使用具有已知异方差的 WLS 估计量的精确正态理论协方差，计算 $h$ 的双侧 95% 置信区间。\n- 所有角度在内部必须以弧度处理。输入角度以度为单位提供，必须转换为弧度以用于三角函数。\n- 所有波长以皮米（pm）为单位提供，必须转换为米（m）以估计 $h$，$h$ 必须以焦耳-秒（J·s）为单位返回。\n- 将 $h$ 及其 95% 置信区间的下限和上限的最终数值结果以国际单位制（J·s）表示。\n\n测试套件：\n提供一个单一程序，按顺序处理以下三个测试用例。每个测试用例包括以皮米为单位的入射波长、以度为单位的散射角数组、以皮米为单位的测量散射波长数组以及以皮米为单位的仪器分辨率标准差数组。下面的每个数字都以十进制字面量形式给出，必须严格按照规定使用。\n\n- 测试用例 A（条件良好的角度和中等分辨率）：\n  - 入射波长 $\\lambda_{0,\\mathrm{pm}} = $ $71.00000$\n  - 散射角（度）$\\Theta_{\\mathrm{deg}} = [$ $20.0$, $45.0$, $90.0$, $120.0$, $150.0$ $]$\n  - 测量的散射波长（皮米）$\\Lambda'_{\\mathrm{pm}} = [$ $71.14933$, $71.71000$, $73.42781$, $74.63747$, $75.52930$ $]$\n  - 仪器分辨率标准差（皮米）$\\Sigma_{\\mathrm{pm}} = [$ $0.0100$, $0.0100$, $0.0150$, $0.0200$, $0.0250$ $]$\n\n- 测试用例 B（小角度边界条件和较大的相对分辨率）：\n  - 入射波长 $\\lambda_{0,\\mathrm{pm}} = $ $71.00000$\n  - 散射角（度）$\\Theta_{\\mathrm{deg}} = [$ $0.0$, $5.0$, $10.0$, $15.0$, $20.0$ $]$\n  - 测量的散射波长（皮米）$\\Lambda'_{\\mathrm{pm}} = [$ $71.00000$, $71.01924$, $71.02888$, $71.08879$, $71.14210$ $]$\n  - 仪器分辨率标准差（皮米）$\\Sigma_{\\mathrm{pm}} = [$ $0.0200$, $0.0200$, $0.0200$, $0.0200$, $0.0200$ $]$\n\n- 测试用例 C（大角度边缘情况和强异方差分辨率）：\n  - 入射波长 $\\lambda_{0,\\mathrm{pm}} = $ $50.00000$\n  - 散射角（度）$\\Theta_{\\mathrm{deg}} = [$ $60.0$, $90.0$, $135.0$, $170.0$ $]$\n  - 测量的散射波长（皮米）$\\Lambda'_{\\mathrm{pm}} = [$ $51.19816$, $52.44631$, $54.14100$, $54.71440$ $]$\n  - 仪器分辨率标准差（皮米）$\\Sigma_{\\mathrm{pm}} = [$ $0.0500$, $0.0500$, $0.0800$, $0.2000$ $]$\n\n输出规范：\n- 对于每个测试用例，计算点估计值 $\\hat{h}$ 和双侧 95% 置信区间的下限和上限 $[\\hat{h}_{\\mathrm{low}}, \\hat{h}_{\\mathrm{high}}]$，所有值均以焦耳-秒为单位。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例贡献一个包含三个数字的子列表，顺序为 $[\\hat{h}, \\hat{h}_{\\mathrm{low}}, \\hat{h}_{\\mathrm{high}}]$。将每个浮点数格式化为具有精确 $10$ 位有效数字的科学记数法。例如，一个有效的整体输出格式是：\n  - $[$ $[\\hat{h}_{A}, \\hat{h}_{A,\\mathrm{low}}, \\hat{h}_{A,\\mathrm{high}}]$, $[\\hat{h}_{B}, \\hat{h}_{B,\\mathrm{low}}, \\hat{h}_{B,\\mathrm{high}}]$, $[\\hat{h}_{C}, \\hat{h}_{C,\\mathrm{low}}, \\hat{h}_{C,\\mathrm{high}}]$ $]$\n- 角度以度为单位提供，在进行任何三角函数计算前必须转换为弧度。确保 $h$ 及其置信区间的最终答案以 J·s 为单位表示，并以上述确切的单行格式打印。", "solution": "该问题要求从康普顿散射数据中推导并实现一个用于估计普朗克常数 $h$ 的统计估计程序。此过程始于对问题陈述的严格验证，我们发现其在科学上是合理的、适定的和完整的。我们接下来将推导物理模型，然后是统计框架和计算算法。\n\n首先，我们从能量和动量守恒原理推导出控制物理方程。一个能量为 $E_0 = hc/\\lambda_0$、动量大小为 $p_0 = h/\\lambda_0$ 的入射光子与一个自由电子碰撞，该电子被假设初始静止，其静止能量为 $E_e = m_e c^2$。碰撞后，光子相对于其初始方向以角度 $\\theta$ 散射，其新能量为 $E' = hc/\\lambda'$，动量大小为 $p' = h/\\lambda'$。电子因反冲而获得动能和动量。\n\n总能量守恒表示为：\n$$E_0 + m_e c^2 = E' + E'_e$$\n其中 $E'_e$ 是散射电子的总能量。整理 $E'_e$ 可得：\n$$E'_e = hc\\left(\\frac{1}{\\lambda_0} - \\frac{1}{\\lambda'}\\right) + m_e c^2 \\quad (1)$$\n\n总线性动量守恒规定 $\\vec{p}_0 = \\vec{p}' + \\vec{p}'_e$，其中 $\\vec{p}'_e$ 是散射电子的动量。整理后得到 $\\vec{p}'_e = \\vec{p}_0 - \\vec{p}'$。我们将此向量与其自身进行点积，以求其大小的平方：\n$$(p'_e)^2 = (\\vec{p}_0 - \\vec{p}') \\cdot (\\vec{p}_0 - \\vec{p}') = p_0^2 + (p')^2 - 2\\vec{p}_0 \\cdot \\vec{p}'$$\n代入光子动量大小，我们得到：\n$$(p'_e)^2 = \\left(\\frac{h}{\\lambda_0}\\right)^2 + \\left(\\frac{h}{\\lambda'}\\right)^2 - 2\\frac{h^2}{\\lambda_0 \\lambda'} \\cos\\theta \\quad (2)$$\n\n散射电子的相对论能量-动量关系为：\n$$(E'_e)^2 = (p'_e c)^2 + (m_e c^2)^2 \\quad (3)$$\n\n我们现在将方程 $(1)$ 和 $(2)$ 代入 $(3)$：\n$$\\left[hc\\left(\\frac{1}{\\lambda_0} - \\frac{1}{\\lambda'}\\right) + m_e c^2\\right]^2 = c^2\\left[\\left(\\frac{h}{\\lambda_0}\\right)^2 + \\left(\\frac{h}{\\lambda'}\\right)^2 - 2\\frac{h^2}{\\lambda_0 \\lambda'} \\cos\\theta\\right] + (m_e c^2)^2$$\n展开左侧并通过消去 $(m_e c^2)^2$ 项进行简化，得到：\n$$h^2 c^2\\left(\\frac{1}{\\lambda_0^2} - \\frac{2}{\\lambda_0\\lambda'} + \\frac{1}{(\\lambda')^2}\\right) + 2hcm_ec^2\\left(\\frac{1}{\\lambda_0} - \\frac{1}{\\lambda'}\\right) = h^2 c^2\\left(\\frac{1}{\\lambda_0^2} + \\frac{1}{(\\lambda')^2} - \\frac{2\\cos\\theta}{\\lambda_0 \\lambda'}\\right)$$\n进一步的代数简化得到：\n$$-2h^2c^2\\frac{1}{\\lambda_0\\lambda'} + 2hm_ec^3\\frac{\\lambda' - \\lambda_0}{\\lambda_0\\lambda'} = -2h^2c^2\\frac{\\cos\\theta}{\\lambda_0\\lambda'}$$\n除以公因数并整理波长偏移 $\\Delta\\lambda = \\lambda' - \\lambda_0$，得到康普顿散射公式：\n$$\\lambda' - \\lambda_0 = \\frac{h}{m_e c} (1 - \\cos\\theta)$$\n\n这个方程为我们的统计模型提供了基础。它建立了波长偏移与散射角函数之间的线性关系。对于每次测量 $i$，令因变量为 $y_i = \\lambda'_i - \\lambda_0$，自变量为 $x_i = 1 - \\cos\\theta_i$。模型采用过原点的线性回归形式：\n$$y_i = \\beta x_i$$\n其中斜率参数为 $\\beta = \\frac{h}{m_e c}$。我们的目标是从数据中估计 $\\beta$，从而确定 $h$。\n\n问题陈述指出，每次散射波长的测量值 $\\lambda'_{i, \\text{meas}}$ 都服从高斯误差：$\\lambda'_{i, \\text{meas}} = \\lambda'_{i, \\text{true}} + \\epsilon_i$，其中 $\\epsilon_i \\sim N(0, \\sigma_i^2)$，$\\sigma_i$ 是已知的仪器分辨率。入射波长 $\\lambda_0$ 和散射角 $\\theta_i$ 被假定为无误差的已知量。因此，因变量 $y_i = \\lambda'_{i, \\text{meas}} - \\lambda_0$ 中的误差完全源于 $\\lambda'_i$ 的误差，所以 $\\text{Var}(y_i) = \\sigma_i^2$。完整的统计模型是：\n$$y_i = \\beta x_i + \\delta_i, \\quad \\text{其中 } \\delta_i \\sim N(0, \\sigma_i^2)$$\n由于所有测量的方差 $\\sigma_i^2$ 并非完全相同，这是一个异方差模型。\n\n对于这样一个方差已知的模型，最大似然估计量（MLE）就是加权最小二乘（WLS）估计量。WLS 估计量最小化加权残差平方和 $S(\\beta) = \\sum_i w_i (y_i - \\beta x_i)^2$，其中权重是方差的倒数，$w_i = 1/\\sigma_i^2$。将导数 $\\frac{dS}{d\\beta}$ 设为零并求解 $\\beta$，得到估计量 $\\hat{\\beta}$：\n$$\\hat{\\beta} = \\frac{\\sum_i w_i x_i y_i}{\\sum_i w_i x_i^2} = \\frac{\\sum_i (x_i y_i / \\sigma_i^2)}{\\sum_i (x_i^2 / \\sigma_i^2)}$$\n普朗克常数的估计量则直接通过 $\\hat{h} = \\hat{\\beta} \\cdot m_e c$ 获得。\n\n为了构建 $h$ 的置信区间，我们首先需要 $\\hat{\\beta}$ 的方差。由于 $\\hat{\\beta}$ 是独立高斯随机变量 $y_i$ 的线性组合，因此它也服从正态分布。其方差为：\n$$\\text{Var}(\\hat{\\beta}) = \\frac{1}{\\sum_i w_i x_i^2} = \\frac{1}{\\sum_i (x_i^2 / \\sigma_i^2)}$$\n$\\beta$ 的双侧 $95\\%$ 置信区间由 $\\hat{\\beta} \\pm z_{0.975} \\cdot \\sqrt{\\text{Var}(\\hat{\\beta})}$ 给出，其中 $z_{0.975}$ 是标准正态分布的 $0.975$ 分位数（约 $1.959964$）。$h$ 的置信区间是通过将 $\\beta$ 的区间乘以常数因子 $m_e c$ 得到的：\n$$[\\hat{h}_{\\text{low}}, \\hat{h}_{\\text{high}}] = \\left[ (\\hat{\\beta} - z_{0.975}\\sqrt{\\text{Var}(\\hat{\\beta})})m_e c, \\, (\\hat{\\beta} + z_{0.975}\\sqrt{\\text{Var}(\\hat{\\beta})})m_e c \\right]$$\n这等价于 $\\hat{h} \\pm z_{0.975} \\cdot \\text{SE}(\\hat{h})$，其中 $\\text{SE}(\\hat{h}) = \\sqrt{\\text{Var}(\\hat{\\beta})} \\cdot m_e c$。\n\n实现算法如下：\n1. 定义物理常数 $m_e$ 和 $c$。\n2. 对于每个测试用例，检索输入数据：$\\lambda_{0,\\text{pm}}$、$\\Theta_{\\text{deg}}$、$\\Lambda'_{\\text{pm}}$ 和 $\\Sigma_{\\text{pm}}$。\n3. 将所有输入单位转换为国际单位制（SI）单位：波长从皮米到米（$1\\,\\text{pm} = 10^{-12}\\,\\text{m}$），角度从度到弧度。\n4. 计算自变量 $x_i = 1 - \\cos\\theta_i$ 和因变量 $y_i = \\lambda'_i - \\lambda_0$ 的向量。\n5. 计算权重 $w_i = 1/\\sigma_i^2$。\n6. 使用上面推导的公式计算 WLS 估计值 $\\hat{\\beta}$。\n7. 计算普朗克常数的估计值：$\\hat{h} = \\hat{\\beta} m_e c$。\n8. 计算 $\\hat{\\beta}$ 的方差 $\\text{Var}(\\hat{\\beta})$，并由此计算 $h$ 的误差范围。\n9. 确定 $h$ 的 $95\\%$ 置信区间的下限和上限。\n10. 将结果 $\\hat{h}$、$\\hat{h}_{\\text{low}}$ 和 $\\hat{h}_{\\text{high}}$ 格式化为具有 $10$ 位有效数字的科学记数法，并以指定的列表格式呈现。\n将此程序应用于所提供的三个测试用例中的每一个。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import norm\n\ndef solve():\n    \"\"\"\n    Solves for Planck's constant and its confidence interval from Compton scattering data.\n    \"\"\"\n    \n    # Define physical constants in SI units\n    m_e = 9.1093837015e-31  # Electron rest mass in kg\n    c = 299792458.0         # Speed of light in m/s\n    \n    # Define the test cases from the problem statement\n    test_cases = [\n        # Test Case A\n        {\n            \"lambda0_pm\": 71.00000,\n            \"Theta_deg\": np.array([20.0, 45.0, 90.0, 120.0, 150.0]),\n            \"Lambda_prime_pm\": np.array([71.14933, 71.71000, 73.42781, 74.63747, 75.52930]),\n            \"Sigma_pm\": np.array([0.0100, 0.0100, 0.0150, 0.0200, 0.0250])\n        },\n        # Test Case B\n        {\n            \"lambda0_pm\": 71.00000,\n            \"Theta_deg\": np.array([0.0, 5.0, 10.0, 15.0, 20.0]),\n            \"Lambda_prime_pm\": np.array([71.00000, 71.01924, 71.02888, 71.08879, 71.14210]),\n            \"Sigma_pm\": np.array([0.0200, 0.0200, 0.0200, 0.0200, 0.0200])\n        },\n        # Test Case C\n        {\n            \"lambda0_pm\": 50.00000,\n            \"Theta_deg\": np.array([60.0, 90.0, 135.0, 170.0]),\n            \"Lambda_prime_pm\": np.array([51.19816, 52.44631, 54.14100, 54.71440]),\n            \"Sigma_pm\": np.array([0.0500, 0.0500, 0.0800, 0.2000])\n        }\n    ]\n    \n    all_results = []\n    \n    # Z-value for 95% two-sided confidence interval\n    z_975 = norm.ppf(0.975)\n\n    for case in test_cases:\n        # 1. Unit Conversion (to SI units)\n        pm_to_m = 1e-12\n        lambda0_m = case[\"lambda0_pm\"] * pm_to_m\n        lambda_prime_m = case[\"Lambda_prime_pm\"] * pm_to_m\n        sigma_m = case[\"Sigma_pm\"] * pm_to_m\n        theta_rad = np.deg2rad(case[\"Theta_deg\"])\n        \n        # 2. Prepare variables for linear regression (y = beta * x)\n        # y is the wavelength shift lambda' - lambda_0\n        # x is the angular term 1 - cos(theta)\n        y = lambda_prime_m - lambda0_m\n        x = 1.0 - np.cos(theta_rad)\n        \n        # 3. Perform Weighted Least Squares (WLS) estimation for beta = h / (m_e * c)\n        # The weights are w = 1 / sigma^2\n        # Handle potential division by zero if any sigma is zero, although not expected from problem data.\n        with np.errstate(divide='raise'):\n            try:\n                w = 1.0 / (sigma_m**2)\n            except FloatingPointError:\n                # This should not happen with the given test cases.\n                # If a sigma is zero, that point has infinite weight, implying a perfect measurement.\n                # WLS logic would need to be adapted, but we follow the general formula.\n                 w = np.full_like(sigma_m, np.inf)\n\n        # WLS estimate for beta (for regression through origin)\n        # beta_hat = (sum(w*x*y)) / (sum(w*x*x))\n        sum_wxy = np.sum(w * x * y)\n        sum_wx2 = np.sum(w * x**2)\n        \n        # If sum_wx2 is zero, it means all x are zero (all angles are 0).\n        # In this scenario, the slope beta cannot be determined.\n        if sum_wx2 == 0:\n            # For test case B, the point at angle 0 contributes 0 to this sum,\n            # but other points will make it non-zero.\n            # This is a robust check.\n            h_hat, h_low, h_high = np.nan, np.nan, np.nan\n        else:\n            beta_hat = sum_wxy / sum_wx2\n            \n            # 4. Estimate Planck's constant, h\n            h_hat = beta_hat * m_e * c\n            \n            # 5. Calculate the 95% confidence interval for h\n            # Variance of beta_hat = 1 / sum(w*x*x)\n            var_beta_hat = 1.0 / sum_wx2\n            se_beta_hat = np.sqrt(var_beta_hat)\n            \n            # Margin of error for h\n            margin_of_error_h = z_975 * se_beta_hat * m_e * c\n            \n            h_low = h_hat - margin_of_error_h\n            h_high = h_hat + margin_of_error_h\n        \n        all_results.append([h_hat, h_low, h_high])\n\n    # 6. Format the output as specified\n    formatted_results = []\n    for result_set in all_results:\n        formatted_set = [f\"{val:.9e}\" for val in result_set]\n        formatted_results.append(f\"[{','.join(formatted_set)}]\")\n    \n    final_output_str = f\"[{','.join(formatted_results)}]\"\n    \n    print(final_output_str)\n\nsolve()\n```", "id": "2951509"}]}