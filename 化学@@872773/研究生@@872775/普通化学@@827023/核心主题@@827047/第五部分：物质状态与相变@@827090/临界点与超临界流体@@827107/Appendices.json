{"hands_on_practices": [{"introduction": "van der Waals 方程是第一个成功描述真实气体液-气相变和临界点现象的简单状态方程。通过将数学上临界点（拐点）的定义应用于该方程，我们可以推导出临界压缩因子 $Z_c$ 这样的普适常数。这项实践将引导你完成这一经典推导，从而加深对理论模型如何捕捉物理实在的理解，并让你体会到模型的预测能力及其固有的局限性 [@problem_id:2931983]。", "problem": "一种单组分流体由一摩尔的范德华(vdW)状态方程来描述，\n$$(P + \\frac{a}{V_m^{2}})(V_m - b) = R T,$$\n其中$P$是压力，$T$是温度，$V_m$是摩尔体积，$R$是气体常数，$a$和$b$是特定于流体的参数。流体的临界点定义为等温线上满足拐点条件的点，即$ \\left(\\frac{\\partial P}{\\partial V_m}\\right)_{T} = 0 $ 和 $ \\left(\\frac{\\partial^{2} P}{\\partial V_m^{2}}\\right)_{T} = 0 $。从这些定义和范德华状态方程出发，推导范德华流体的临界压缩因子 $Z_c = \\frac{P_c V_c}{R T_c}$，用普适数值常数表示。然后，取一种简单真实流体的代表性实验临界压缩因子为$0.289$，通过计算下式来量化范德华(vdW)预测值与该实验值之间的偏差\n$$\\Delta = Z_c^{\\mathrm{(vdW)}} - 0.289.$$\n将$\\Delta$的单一数值报告为一个纯数字，并四舍五入至四位有效数字。最终报告的值不需要单位。", "solution": "该问题陈述有效。这是一个物理化学中的标准推导，科学上成立、定义明确且客观。我们将继续解答。\n\n该问题要求从范德华(vdW)状态方程推导临界压缩因子$Z_c$，然后量化其与给定实验值的偏差。\n\n一摩尔流体的范德华方程如下：\n$$ \\left(P + \\frac{a}{V_m^{2}}\\right)(V_m - b) = R T $$\n此处，$P$是压力，$V_m$是摩尔体积，$T$是温度，$R$是普适气体常数，$a$和$b$是特定物质的常数。\n\n为求临界点，我们必须首先将$P$表示为$V_m$和$T$的函数：\n$$ P(V_m, T) = \\frac{R T}{V_m - b} - \\frac{a}{V_m^{2}} $$\n临界点是临界等温线上的一个拐点，其定义条件为在恒定温度下，压力对摩尔体积的一阶和二阶偏导数均为零：\n$$ \\left(\\frac{\\partial P}{\\partial V_m}\\right)_{T} = 0 \\quad \\text{和} \\quad \\left(\\frac{\\partial^{2} P}{\\partial V_m^{2}}\\right)_{T} = 0 $$\n首先，我们计算一阶导数：\n$$ \\left(\\frac{\\partial P}{\\partial V_m}\\right)_{T} = \\frac{\\partial}{\\partial V_m} \\left( \\frac{R T}{V_m - b} - \\frac{a}{V_m^{2}} \\right) = -\\frac{R T}{(V_m - b)^{2}} + \\frac{2a}{V_m^{3}} $$\n接下来，我们计算二阶导数：\n$$ \\left(\\frac{\\partial^{2} P}{\\partial V_m^{2}}\\right)_{T} = \\frac{\\partial}{\\partial V_m} \\left( -\\frac{R T}{(V_m - b)^{2}} + \\frac{2a}{V_m^{3}} \\right) = \\frac{2 R T}{(V_m - b)^{3}} - \\frac{6a}{V_m^{4}} $$\n在临界点$(P_c, V_c, T_c)$，这些导数为零。由此得到一个由两个方程组成的方程组：\n$$ -\\frac{R T_c}{(V_c - b)^{2}} + \\frac{2a}{V_c^{3}} = 0 \\implies \\frac{R T_c}{(V_c - b)^{2}} = \\frac{2a}{V_c^{3}} \\quad (1) $$\n$$ \\frac{2 R T_c}{(V_c - b)^{3}} - \\frac{6a}{V_c^{4}} = 0 \\implies \\frac{2 R T_c}{(V_c - b)^{3}} = \\frac{6a}{V_c^{4}} \\quad (2) $$\n为求解临界常数，我们将方程$(2)$除以方程$(1)$：\n$$ \\frac{2 R T_c / (V_c - b)^{3}}{R T_c / (V_c - b)^{2}} = \\frac{6a / V_c^{4}}{2a / V_c^{3}} $$\n$$ \\frac{2}{V_c - b} = \\frac{3}{V_c} $$\n求解临界摩尔体积$V_c$：\n$$ 2 V_c = 3 (V_c - b) \\implies 2 V_c = 3 V_c - 3b \\implies V_c = 3b $$\n现在，我们将$V_c$的这个表达式代回方程$(1)$，以求出临界温度$T_c$：\n$$ \\frac{R T_c}{(3b - b)^{2}} = \\frac{2a}{(3b)^{3}} \\implies \\frac{R T_c}{(2b)^{2}} = \\frac{2a}{27b^{3}} \\implies \\frac{R T_c}{4b^{2}} = \\frac{2a}{27b^{3}} $$\n$$ T_c = \\frac{8a}{27b^{3}} \\frac{b^{2}}{R} = \\frac{8a}{27Rb} $$\n已知$V_c$和$T_c$后，我们将它们代入范德华状态方程以求出临界压力$P_c$：\n$$ P_c = \\frac{R T_c}{V_c - b} - \\frac{a}{V_c^{2}} = \\frac{R}{3b - b}\\left(\\frac{8a}{27Rb}\\right) - \\frac{a}{(3b)^{2}} $$\n$$ P_c = \\frac{1}{2b}\\left(\\frac{8a}{27b}\\right) - \\frac{a}{9b^{2}} = \\frac{8a}{54b^{2}} - \\frac{a}{9b^{2}} = \\frac{4a}{27b^{2}} - \\frac{3a}{27b^{2}} = \\frac{a}{27b^{2}} $$\n我们现在已经用范德华参数推导出了临界常数：\n$$ V_c = 3b, \\quad T_c = \\frac{8a}{27Rb}, \\quad P_c = \\frac{a}{27b^{2}} $$\n临界压缩因子$Z_c$定义为$Z_c = \\frac{P_c V_c}{R T_c}$。代入我们推导出的表达式：\n$$ Z_c^{\\mathrm{(vdW)}} = \\frac{\\left(\\frac{a}{27b^{2}}\\right)(3b)}{R\\left(\\frac{8a}{27Rb}\\right)} = \\frac{\\frac{3ab}{27b^{2}}}{\\frac{8aR}{27Rb}} = \\frac{\\frac{a}{9b}}{\\frac{8a}{27b}} $$\n参数$a$和$b$相消，从而得到一个适用于所有范德华流体的普适常数：\n$$ Z_c^{\\mathrm{(vdW)}} = \\frac{1}{9} \\times \\frac{27}{8} = \\frac{3}{8} $$\n这个值的小数形式为$Z_c^{\\mathrm{(vdW)}} = 0.375$。\n问题要求计算与实验值$0.289$的偏差$\\Delta$：\n$$ \\Delta = Z_c^{\\mathrm{(vdW)}} - 0.289 $$\n$$ \\Delta = 0.375 - 0.289 = 0.086 $$\n最终值必须报告为四舍五入到四位有效数字。数字$0.086$有两位有效数字。为了用四位有效数字的精度表示，我们添加尾随零。\n$$ \\Delta = 0.08600 $$", "answer": "$$\n\\boxed{0.08600}\n$$", "id": "2931983"}, {"introduction": "要精确描述超临界流体的行为，我们需要量化其与理想气体的偏差。为此，热力学引入了“剩余性质”这一强大工具，它定义为真实流体性质与同温同压下理想气体性质之差。这项练习将带领你从逸度等基本概念出发，推导并计算剩余焓 $H^R$——一个在涉及真实流体的能量衡算中至关重要的热力学量 [@problem_id:2931977]。", "problem": "研究了近临界低密度区域的单组分流体。剩余性质定义为在相同温度和压力下，真实气体性质与理想气体性质之差，即对于任何摩尔性质 $X$，$X^{R} \\equiv X - X^{\\mathrm{ig}}$。考虑摩尔逸度 $f$ 和逸度系数 $\\phi \\equiv f/P$。从关联化学势、吉布斯能和焓的基本热力学定义出发，结合真实气体的逸度定义，推导摩尔剩余焓 $H^{R}$ 用 $\\ln \\phi$ 在恒定压力下对温度的导数表示的表达式。然后，使用第二维里表达式计算近临界稀疏状态下的 $H^{R}$。\n\n假设如下：\n- 在低压下，沿等温线的压缩因子由第二维里截断式 $Z = 1 + B(T)\\,P/(R T) + \\cdots$ 表示，其中 $B(T)$ 是第二维里系数。\n- 在所关注的温度范围内，第二维里系数采用 van der Waals 形式是足够的：$B(T) = b - a/(R T)$，其中参数 $a$ 和 $b$ 通过 van der Waals 临界等式 $V_c = 3 b$, $P_c = a/(27 b^2)$ 和 $T_c = 8 a/(27 R b)$ 与临界常数相关联。\n- 该流体的临界温度为 $T_c = 304.13\\ \\mathrm{K}$，临界压力为 $P_c = 7.377 \\times 10^{6}\\ \\mathrm{Pa}$，通用气体常数为 $R = 8.314462618\\ \\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$。\n- 计算在 $T = 1.0500\\,T_c$ 和 $P = 5.000 \\times 10^{5}\\ \\mathrm{Pa}$ 时的剩余焓。\n\n要求：\n1) 仅从定义和热力学恒等式出发（不预设任何目标结果），推导一个用 $\\partial \\ln \\phi / \\partial T$ 在恒定 $P$ 下表示 $H^{R}$ 的关系式。\n2) 使用第二维里截断式和 $B(T) = b - a/(R T)$ 的形式，获得在低压下用 $a$、$b$、$R$、$T$ 和 $P$ 表示的 $H^{R}$ 的显式解析表达式。\n3) 从 $T_c$ 和 $P_c$ 确定 $a$ 和 $b$，然后计算在给定 $T$ 和 $P$ 下 $H^{R}$ 的数值。\n\n将最终焓以 $\\mathrm{J}\\,\\mathrm{mol}^{-1}$ 为单位表示，并将答案四舍五入到四位有效数字。", "solution": "该问题陈述具有科学依据，表述清晰且自成体系，是化学热力学中的一个标准问题。因此，该问题被认为是有效的。解题过程将遵循所要求的三个步骤进行。\n\n首先，我们推导摩尔剩余焓 $H^{R}$ 用逸度系数 $\\phi$ 表示的通用表达式。对于一摩尔纯物质，剩余吉布斯能 $G^{R}$ 定义为在相同温度 $T$ 和压力 $P$ 下，真实流体的摩尔吉布斯能 $G$ 与理想气体的摩尔吉布斯能 $G^{\\mathrm{ig}}$ 之差。\n$$ G^{R} \\equiv G - G^{\\mathrm{ig}} $$\n逸度 $f$ 的定义由恒定 $T$ 下的 $dG = R T \\,d\\ln f$ 给出。对于真实气体，$G(T, P) = G^{\\circ}(T) + R T \\ln(f/P^{\\circ})$，其中 $G^{\\circ}$ 是在标准状态压力 $P^{\\circ}$ 下的摩尔吉布斯能。对于理想气体，$f$ 被 $P$ 替代，因此 $G^{\\mathrm{ig}}(T, P) = G^{\\circ}(T) + R T \\ln(P/P^{\\circ})$。两者相减得到剩余吉布斯能：\n$$ G^{R} = R T \\ln\\left(\\frac{f}{P}\\right) = R T \\ln\\phi $$\n其中 $\\phi \\equiv f/P$ 是逸度系数。摩尔焓 $H$ 和摩尔吉布斯能 $G$ 之间的关系由 Gibbs-Helmholtz 方程给出：\n$$ \\left( \\frac{\\partial (G/T)}{\\partial T} \\right)_{P} = -\\frac{H}{T^2} $$\n这个基本关系适用于任何热力学上一致的性质集合。我们将其应用于剩余性质：\n$$ \\left( \\frac{\\partial (G^{R}/T)}{\\partial T} \\right)_{P} = -\\frac{H^{R}}{T^2} $$\n代入 $G^{R}$ 的表达式：\n$$ \\left( \\frac{\\partial (R T \\ln\\phi / T)}{\\partial T} \\right)_{P} = \\left( \\frac{\\partial (R \\ln\\phi)}{\\partial T} \\right)_{P} = -\\frac{H^{R}}{T^2} $$\n由于通用气体常数 $R$ 是一个常数，我们可以写出：\n$$ R \\left( \\frac{\\partial \\ln\\phi}{\\partial T} \\right)_{P} = -\\frac{H^{R}}{T^2} $$\n对 $H^{R}$ 进行整理，得到所需的关系式：\n$$ H^{R} = -R T^2 \\left( \\frac{\\partial \\ln\\phi}{\\partial T} \\right)_{P} $$\n\n第二，我们对由压缩因子 $Z \\equiv PV/(RT)$ 的第二维里截断式所描述的气体计算此表达式。问题指定了按压力展开的形式：\n$$ Z = 1 + \\frac{B(T)P}{RT} $$\n逸度系数 $\\phi$ 通过以下通用公式与 $Z$ 相关：\n$$ \\ln\\phi = \\int_{0}^{P} \\frac{Z-1}{P'} \\,dP' $$\n代入 $Z$ 的表达式：\n$$ \\ln\\phi = \\int_{0}^{P} \\frac{1}{P'} \\left(1 + \\frac{B(T)P'}{RT} - 1\\right) \\,dP' = \\int_{0}^{P} \\frac{B(T)}{RT} \\,dP' = \\frac{B(T)P}{RT} $$\n现在我们计算 $\\ln\\phi$ 在恒定 $P$ 下对 $T$ 的偏导数：\n$$ \\left( \\frac{\\partial \\ln\\phi}{\\partial T} \\right)_{P} = \\frac{\\partial}{\\partial T} \\left( \\frac{B(T)P}{RT} \\right)_{P} = \\frac{P}{R} \\frac{\\partial}{\\partial T} \\left( \\frac{B(T)}{T} \\right)_{P} $$\n使用除法求导法则，我们得到：\n$$ \\frac{\\partial}{\\partial T} \\left( \\frac{B(T)}{T} \\right) = \\frac{1}{T^2} \\left( T \\frac{dB}{dT} - B(T) \\right) $$\n将此结果代回 $\\ln\\phi$ 的导数表达式中：\n$$ \\left( \\frac{\\partial \\ln\\phi}{\\partial T} \\right)_{P} = \\frac{P}{RT^2} \\left( T \\frac{dB}{dT} - B(T) \\right) $$\n现在我们将此结果代入我们关于 $H^{R}$ 的表达式中：\n$$ H^{R} = -R T^2 \\left[ \\frac{P}{RT^2} \\left( T \\frac{dB}{dT} - B(T) \\right) \\right] = -P \\left( T \\frac{dB}{dT} - B(T) \\right) = P \\left( B(T) - T \\frac{dB}{dT} \\right) $$\n问题提供了第二维里系数的 van der Waals 形式：\n$$ B(T) = b - \\frac{a}{RT} $$\n它对温度的导数是：\n$$ \\frac{dB}{dT} = \\frac{d}{dT} \\left( b - \\frac{a}{RT} \\right) = \\frac{a}{RT^2} $$\n将 $B(T)$ 及其导数代入 $H^{R}$ 的表达式中：\n$$ H^{R} = P \\left[ \\left( b - \\frac{a}{RT} \\right) - T \\left( \\frac{a}{RT^2} \\right) \\right] = P \\left( b - \\frac{a}{RT} - \\frac{a}{RT} \\right) $$\n这简化为此模型中剩余焓的最终解析表达式：\n$$ H^{R} = P \\left( b - \\frac{2a}{RT} \\right) $$\n\n第三，我们计算数值。参数 $a$ 和 $b$ 通过 van der Waals 临界等式与临界温度 $T_c$ 和临界压力 $P_c$ 相关联：\n$$ T_c = \\frac{8a}{27Rb}, \\quad P_c = \\frac{a}{27b^2} $$\n解此方程组得到 $a$ 和 $b$：\n$$ b = \\frac{R T_c}{8 P_c}, \\quad a = \\frac{27 R^2 T_c^2}{64 P_c} $$\n为最小化舍入误差，我们将 $a$ 和 $b$ 的这些表达式直接代入我们关于 $H^{R}$ 的公式中：\n$$ H^{R} = P \\left( \\frac{R T_c}{8 P_c} - \\frac{2}{RT} \\frac{27 R^2 T_c^2}{64 P_c} \\right) = P \\left( \\frac{R T_c}{8 P_c} - \\frac{54 R T_c^2}{64 T P_c} \\right) $$\n提取公因式：\n$$ H^{R} = \\frac{P R T_c}{P_c} \\left( \\frac{1}{8} - \\frac{27 T_c}{32 T} \\right) $$\n问题指出计算是在 $T = 1.0500\\,T_c$ 下进行，因此比值 $T_c/T = 1/1.0500$。我们给定了以下数值：\n$P = 5.000 \\times 10^5\\ \\mathrm{Pa}$\n$T_c = 304.13\\ \\mathrm{K}$\n$P_c = 7.377 \\times 10^6\\ \\mathrm{Pa}$\n$R = 8.314462618\\ \\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$\n\n将这些值代入表达式中：\n$$ H^{R} = \\frac{(5.000 \\times 10^5) (8.314462618) (304.13)}{7.377 \\times 10^6} \\left( \\frac{1}{8} - \\frac{27}{32 \\times 1.0500} \\right) $$\n$$ H^{R} = \\frac{1.264132... \\times 10^9}{7.377 \\times 10^6} \\left( 0.125 - \\frac{27}{33.6} \\right) $$\n$$ H^{R} = (171.3653...) \\times (0.125 - 0.8035714...) $$\n$$ H^{R} = (171.3653...) \\times (-0.6785714...) \\approx -116.307366\\ \\mathrm{J}\\,\\mathrm{mol}^{-1} $$\n根据要求将结果四舍五入到四位有效数字，我们得到最终答案。", "answer": "$$\\boxed{-116.3}$$", "id": "2931977"}, {"introduction": "本节我们将理论知识应用于解决一个实际的工程设计问题：如何确定超临界萃取过程所需的操作压力以达到目标溶解度。这项实践极具挑战性，它要求你综合运用多个热力学模型，包括相平衡条件、固体的蒸气压方程、溶剂的密度模型以及溶质的逸度系数模型。通过建立并求解这个系统的平衡方程，你将体验到如何将分散的理论知识整合成一个强大的计算框架，用以预测和设计真实的化学过程 [@problem_id:2931981]。", "problem": "将一种固体溶质萃取到一种致密的超临界溶剂中。在相平衡时，溶质在超临界流体中的逸度等于纯固体溶质的逸度。目标是通过基本定义和经验校准关系，强制执行平衡条件 $f_i^\\mathrm{fluid}=f_i^\\mathrm{solid}$，从而计算在指定温度和给定流体相中目标溶质摩尔分数下的萃取压力。\n\n基本原理：\n- 平衡时的逸度相等：$f_i^\\mathrm{fluid}=f_i^\\mathrm{solid}$。\n- 对于稠密流体中的极稀溶质，流体中溶质的逸度近似为 $f_i^\\mathrm{fluid}=y_i\\,\\phi_i(T,\\rho)\\,P$，其中 $y_i$ 是流体中溶质的摩尔分数，$\\phi_i(T,\\rho)$ 是无限稀释下溶质的逸度系数，作为温度和溶剂密度的函数，而 $P$ 是总压力。\n- 对于纯固体，逸度近似为 $f_i^\\mathrm{solid}=p_i^\\mathrm{sub}(T)\\,\\exp\\!\\left(\\frac{v_i^\\mathrm{s}}{R\\,T}\\left(P-P_\\mathrm{ref}\\right)\\right)$，这是经Poynting因子校正的升华蒸气压。此处 $p_i^\\mathrm{sub}(T)$ 是溶质的升华蒸气压，$v_i^\\mathrm{s}$ 是固相中溶质的摩尔体积，$R$ 是通用气体常数，$P_\\mathrm{ref}$ 是参考压力，取为 $P_\\mathrm{ref}=0$。\n\n使用以下科学上合理且自洽的模型和参数：\n- 溶质的升华蒸气压由Clausius–Clapeyron关系式描述，$\\ln p_i^\\mathrm{sub}(T)=A-\\frac{B}{T}$，其中 $A=23.0$ 和 $B=6000.0$，当温度 $T$ 以 $\\mathrm{K}$ 为单位时，计算出的 $p_i^\\mathrm{sub}$ 以 $\\mathrm{Pa}$ 为单位。\n- 高于临界温度的溶剂密度等温线由每条等温线上压力的二次经验公式给出，并随温度进行线性插值：\n  $$\\rho(P,T)=a(T)+b(T)\\,P+c(T)\\,P^2,$$\n  其中 $\\rho$ 的单位是 $\\mathrm{mol\\,L^{-1}}$，$P$ 的单位是 $\\mathrm{MPa}$。这些系数在三个温度点上给出，并且必须对 $T$ 进行线性插值：\n  - 在 $T=308.0\\,\\mathrm{K}$ 时：$(a,b,c)=(3.0,\\,0.80,\\,-0.005)$，\n  - 在 $T=328.0\\,\\mathrm{K}$ 时：$(a,b,c)=(2.0,\\,0.45,\\,-0.003)$，\n  - 在 $T=348.0\\,\\mathrm{K}$ 时：$(a,b,c)=(1.5,\\,0.30,\\,-0.002)$。\n- 无限稀释下溶质的逸度系数与温度和溶剂密度的关系式为\n  $$\\ln \\phi_i(T,\\rho)=k_0+\\frac{k_T}{T}+k_\\rho\\,\\rho,$$\n  其中常数 $k_0=-1.0$，$k_T=-500.0\\,\\mathrm{K}$，$k_\\rho=-0.03\\,\\mathrm{L\\,mol^{-1}}$。密度 $\\rho$ 的单位是 $\\mathrm{mol\\,L^{-1}}$，温度 $T$ 的单位是 $\\mathrm{K}$。\n- 使用固相摩尔体积 $v_i^\\mathrm{s}=4.0\\times 10^{-5}\\,\\mathrm{m^3\\,mol^{-1}}$，通用气体常数 $R=8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$，以及溶剂的临界压力 $P_c=7.3773\\,\\mathrm{MPa}$。\n- 只允许超临界条件。因此，萃取压力的解必须满足 $P\\ge P_\\text{min}$，其中 $P_\\text{min}=7.5\\,\\mathrm{MPa}$。如果在闭区间 $[P_\\text{min},P_\\text{max}]$ (其中 $P_\\text{max}=60.0\\,\\mathrm{MPa}$) 内不存在 $P$ 的解，则返回一个哨兵值 $-1.0$。\n\n对于每个测试用例，您必须通过在 $[P_\\text{min},P_\\text{max}]$ 区间内数值求解压力 $P$（单位 MPa），来求解平衡方程 $f_i^\\mathrm{fluid}=f_i^\\mathrm{solid}$。请注意，在计算中必须保持单位一致，例如，通过将所有压力项统一转换为帕斯卡（Pa）来实现，因为 $1\\ \\text{MPa} = 10^6\\ \\text{Pa}$。使用一种稳健的区间法，仅当残差在区间内变号时才宣告成功。如果符号没有变化，则对该情况报告 $-1.0$。\n\n不使用角度单位。所有物理量必须按规定使用一致的单位处理。将每个案例的最终萃取压力以 $\\mathrm{MPa}$ 为单位表示，并四舍五入到三位小数。如果不存在超临界解，则精确返回 $-1.0$（不进行四舍五入）。\n\n测试套件（温度 $T$ 单位为 $\\mathrm{K}$，目标溶质摩尔分数 $y_i$ 无量纲）：\n- 案例1：$\\left(T,y_i\\right)=\\left(318.0,\\,1.0\\times 10^{-4}\\right)$。\n- 案例2：$\\left(T,y_i\\right)=\\left(338.0,\\,1.7\\times 10^{-4}\\right)$。\n- 案例3：$\\left(T,y_i\\right)=\\left(308.5,\\,6.0\\times 10^{-5}\\right)$。\n- 案例4（旨在在允许的超临界范围内无解的边缘案例）：$\\left(T,y_i\\right)=\\left(348.0,\\,2.0\\times 10^{-5}\\right)$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$\\left[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4\\right]$），其中每个条目要么是单位为 $\\mathrm{MPa}$ 并四舍五入到三位小数的浮点数，要么是哨兵值 $-1.0$。", "solution": "平衡条件是由相平衡的逸度定义所决定的，这是一项基本的热力学要求。对于在固相和超临界流体溶剂之间分配的溶质 $i$，平衡意味着 $f_i^\\mathrm{fluid}=f_i^\\mathrm{solid}$。\n\n对于无限稀释下的流体逸度，使用经过充分检验的近似式 $f_i^\\mathrm{fluid}=y_i\\,\\phi_i\\,P$，其中 $y_i$ 是稠密流体中溶质的摩尔分数，$\\phi_i$ 是捕捉非理想性的逸度系数，$P$ 是压力。对于固体逸度，Poynting校正解释了压力对固体化学势（相对于其升华压力参考态）的影响，得出 $f_i^\\mathrm{solid}=p_i^\\mathrm{sub}(T)\\,\\exp\\!\\left(\\frac{v_i^\\mathrm{s}}{R\\,T}\\int_{P_\\mathrm{ref}}^{P} \\mathrm{d}P'\\right)$。设 $P_\\mathrm{ref}=0$ 并假设 $v_i^\\mathrm{s}$ 在相关范围内与压力无关，积分得到 $f_i^\\mathrm{solid}=p_i^\\mathrm{sub}(T)\\,\\exp\\!\\left(\\frac{v_i^\\mathrm{s}\\,P}{R\\,T}\\right)$，注意压力单位必须与 $R$ 中的单位相同，以保持量纲一致性。\n\n为了使问题封闭，引入了三个具有物理动机的辅助关系：\n- 升华蒸气压由Clausius–Clapeyron形式 $\\ln p_i^\\mathrm{sub}(T)=A-\\frac{B}{T}$ 表示，其中提供了常数 $A$ 和 $B$；当 $T$ 以 $\\mathrm{K}$ 为单位时，此式返回以 $\\mathrm{Pa}$ 为单位的 $p_i^\\mathrm{sub}$。\n- 高于临界温度的等温线上溶剂密度与压力的关系为 $\\rho(P,T)=a(T)+b(T)\\,P+c(T)\\,P^2$，其中 $P$ 单位为 $\\mathrm{MPa}$，$\\rho$ 单位为 $\\mathrm{mol\\,L^{-1}}$。系数的温度依赖性通过在 $T=308.0\\,\\mathrm{K}$、$T=328.0\\,\\mathrm{K}$ 和 $T=348.0\\,\\mathrm{K}$ 的校准值之间进行线性插值来处理，这是在表格化状态之间平滑变化经验参数的标准方法。\n- 无限稀释下溶质的逸度系数由 $\\ln \\phi_i(T,\\rho)=k_0+\\frac{k_T}{T}+k_\\rho\\,\\rho$ 建模，其中提供了常数 $k_0$、$k_T$ 和 $k_\\rho$。这捕捉了由于溶剂-溶质相互作用增强而观察到的 $\\phi_i$ 随密度增加而减小的现象，同时也考虑了温度依赖性。\n\n平衡方程中的未知数是压力 $P$。定义残差函数\n$$\nF(P;T,y_i)=y_i\\,\\phi_i\\!\\left(T,\\rho(P,T)\\right)\\,P_\\mathrm{Pa}-p_i^\\mathrm{sub}(T)\\,\\exp\\!\\left(\\frac{v_i^\\mathrm{s}\\,P_\\mathrm{Pa}}{R\\,T}\\right),\n$$\n其中 $P_\\mathrm{Pa}=P\\times 10^6$ 将 $P$ 从 $\\mathrm{MPa}$ 转换为 $\\mathrm{Pa}$，以便两项在指数项和流体侧乘积 $y_i\\,\\phi_i\\,P$ 中都使用一致的国际单位制（SI）单位。寻找萃取压力的问题简化为一个一维求根任务：在允许的超临界区间 $[P_\\text{min},P_\\text{max}]$ 内找到 $P$，使得 $F(P;T,y_i)=0$。\n\n一种稳健的数值方法是使用区间法，如二分法，该方法要求 $F$ 在区间上存在符号变化。算法如下：\n- 对于每个测试用例 $\\left(T,y_i\\right)$，计算 $F(P_\\text{min})$ 和 $F(P_\\text{max})$。\n- 如果 $F(P_\\text{min})\\cdot F(P_\\text{max})0$，则区间内不存在根，且在这些约束下不存在物理上允许的超临界解；报告哨兵值 $-1.0$。\n- 否则，在 $[P_\\text{min},P_\\text{max}]$ 上进行二分法迭代，直到区间足够小或残差足够接近零，并返回中点作为萃取压力。然后按要求将返回值四舍五入到三位小数，单位为 $\\mathrm{MPa}$。\n\n使用的参数值：\n- $A=23.0$ 和 $B=6000.0$ 用于Clausius–Clapeyron关系式。\n- $v_i^\\mathrm{s}=4.0\\times 10^{-5}\\,\\mathrm{m^3\\,mol^{-1}}$。\n- $R=8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n- 在 $T=308.0\\,\\mathrm{K}$ 时 $\\left(a,b,c\\right)$ 等于 $\\left(3.0,\\,0.80,\\,-0.005\\right)$，在 $T=328.0\\,\\mathrm{K}$ 时等于 $\\left(2.0,\\,0.45,\\,-0.003\\right)$，在 $T=348.0\\,\\mathrm{K}$ 时等于 $\\left(1.5,\\,0.30,\\,-0.002\\right)$；线性插值为中间温度 $T$ 提供 $\\left(a(T),b(T),c(T)\\right)$。\n- $k_0=-1.0$，$k_T=-500.0\\,\\mathrm{K}$，$k_\\rho=-0.03\\,\\mathrm{L\\,mol^{-1}}$。\n- $P_\\text{min}=7.5\\,\\mathrm{MPa}$ 和 $P_\\text{max}=60.0\\,\\mathrm{MPa}$。\n\n该算法直接从第一性原理强制执行等式 $f_i^\\mathrm{fluid}=f_i^\\mathrm{solid}$，同时使用物理上合理的、插值的密度等温线和基于经验的无限稀释逸度系数。Poynting校正的应用与所选的固体摩尔体积和绝对单位保持一致。测试套件包括三个预期在超临界区域有唯一解的案例，以及一个设计为在允许区间内无解的边缘案例，从而测试了正常路径和哨兵行为。最终程序将结果汇总为指定的单行列表格式，每个成功的萃取压力都以 $\\mathrm{MPa}$ 为单位表示，并四舍五入到三位小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport math\n\n# Constants\nR = 8.314462618  # J/mol/K\nv_s = 4.0e-5     # m^3/mol\nPc_MPa = 7.3773  # MPa\nPmin = 7.5       # MPa (enforce supercritical)\nPmax = 60.0      # MPa\n\n# Sublimation vapor pressure parameters (Clausius–Clapeyron), returns Pa\nA_sub = 23.0\nB_sub = 6000.0\n\n# Fugacity coefficient correlation parameters: ln(phi) = k0 + kT/T + k_rho * rho\nk0 = -1.0\nkT = -500.0\nk_rho = -0.03  # per (mol/L)\n\n# Density isotherm coefficients at T nodes (T in K): rho(P,T)=a(T)+b(T)P+c(T)P^2 with P in MPa, rho in mol/L\nisotherm_data = [\n    (308.0, (3.0, 0.80, -0.005)),\n    (328.0, (2.0, 0.45, -0.003)),\n    (348.0, (1.5, 0.30, -0.002)),\n]\n\ndef p_sub_pa(T):\n    # p_sub in Pa\n    return math.exp(A_sub - B_sub / T)\n\ndef interp_coeffs(T):\n    # Linear interpolation of (a,b,c) over T using two nearest nodes\n    # Extrapolate linearly if outside provided range.\n    # Sort by temperature\n    data = sorted(isotherm_data, key=lambda x: x[0])\n    if T = data[0][0]:\n        return data[0][1]\n    if T >= data[-1][0]:\n        return data[-1][1]\n    # Find interval\n    for i in range(len(data) - 1):\n        T0, (a0, b0, c0) = data[i]\n        T1, (a1, b1, c1) = data[i + 1]\n        if T0 = T = T1:\n            f = (T - T0) / (T1 - T0)\n            a = a0 + f * (a1 - a0)\n            b = b0 + f * (b1 - b0)\n            c = c0 + f * (c1 - c0)\n            return (a, b, c)\n    # Fallback (should not reach here)\n    return data[-1][1]\n\ndef rho_mol_per_L(P_MPa, T):\n    a, b, c = interp_coeffs(T)\n    return a + b * P_MPa + c * (P_MPa ** 2)\n\ndef phi_infinite_dilution(T, rho_mol_L):\n    ln_phi = k0 + (kT / T) + k_rho * rho_mol_L\n    # Ensure numerical stability\n    return math.exp(ln_phi)\n\ndef residual(P_MPa, T, y):\n    # Convert P to Pa where needed\n    P_Pa = P_MPa * 1.0e6\n    rho = rho_mol_per_L(P_MPa, T)\n    phi = phi_infinite_dilution(T, rho)\n    f_fluid = y * phi * P_Pa\n    f_solid = p_sub_pa(T) * math.exp((v_s * P_Pa) / (R * T))\n    return f_fluid - f_solid\n\ndef find_pressure(T, y, P_lo=Pmin, P_hi=Pmax, tol=1e-9, max_iter=200):\n    f_lo = residual(P_lo, T, y)\n    f_hi = residual(P_hi, T, y)\n    if math.isnan(f_lo) or math.isnan(f_hi):\n        return -1.0\n    # If no sign change, declare no solution in bracket\n    if f_lo == 0.0:\n        return P_lo\n    if f_hi == 0.0:\n        return P_hi\n    if f_lo * f_hi > 0.0:\n        return -1.0\n    # Bisection\n    a = P_lo\n    b = P_hi\n    fa = f_lo\n    fb = f_hi\n    for _ in range(max_iter):\n        m = 0.5 * (a + b)\n        fm = residual(m, T, y)\n        # Check convergence either by residual or interval\n        if abs(fm)  1e-6:\n            return m\n        if (b - a)  tol:\n            return m\n        # Update bracket\n        if fa * fm = 0.0:\n            b = m\n            fb = fm\n        else:\n            a = m\n            fa = fm\n    return 0.5 * (a + b)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (T in K, y dimensionless)\n    test_cases = [\n        (318.0, 1.0e-4),\n        (338.0, 1.7e-4),\n        (308.5, 6.0e-5),\n        (348.0, 2.0e-5),\n    ]\n\n    results_str = []\n    for T, y in test_cases:\n        P = find_pressure(T, y, P_lo=Pmin, P_hi=Pmax)\n        if P  0.0:\n            results_str.append(str(-1.0))\n        else:\n            results_str.append(f\"{P:.3f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results_str)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2931981"}]}