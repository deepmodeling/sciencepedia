{"hands_on_practices": [{"introduction": "理论知识的一个关键应用是澄清常见的误解。本练习旨在解决一个普遍的混淆点：将方均根速率（$v_{\\mathrm{rms}}$）等同于最概然速率（$v_{\\mathrm{mp}}$）。通过从第一性原理推导这两个量并对特定气体（氖气）进行数值计算，您将亲手构建一个定量的反例，从而加深对这些不同特征速率物理意义的理解。[@problem_id:2947207]", "problem": "在气体动理论中，一个常见的学生论断是，在给定温度下，气体的方均根速率 $v_{\\mathrm{rms}}$ 等于其最可几速率 $v_{\\mathrm{mp}}$。考虑一种稀薄的单原子理想氖气，其温度 $T = 400\\,\\mathrm{K}$，摩尔质量 $M = 20.1797\\,\\mathrm{g\\,mol^{-1}}$。请仅使用平动动能的 Boltzmann 因子、速度空间的各向同性以及标准常数，通过从第一性原理出发推导 $v_{\\mathrm{mp}}$ 和 $v_{\\mathrm{rms}}$ 的表达式，并针对给定的 $T$ 和 $M$ 进行数值计算，来构建一个定量的反例。取理想气体常数 $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$，并在需要时使用单位为 $\\mathrm{kg\\,mol^{-1}}$ 的 $M$。对于 $T = 400\\,\\mathrm{K}$ 的氖气，哪个选项正确地提供了一个有效的反例（即，一对通过正确的第一性原理推导得出的不相等的 $v_{\\mathrm{rms}}$ 和 $v_{\\mathrm{mp}}$ 数值）？\n\n- A. $v_{\\mathrm{rms}} \\approx 703\\,\\mathrm{m\\,s^{-1}}$ 和 $v_{\\mathrm{mp}} \\approx 574\\,\\mathrm{m\\,s^{-1}}$\n\n- B. $v_{\\mathrm{rms}} = v_{\\mathrm{mp}} \\approx 574\\,\\mathrm{m\\,s^{-1}}$\n\n- C. $v_{\\mathrm{rms}} \\approx 574\\,\\mathrm{m\\,s^{-1}}$ 和 $v_{\\mathrm{mp}} \\approx 703\\,\\mathrm{m\\,s^{-1}}$\n\n- D. $v_{\\mathrm{rms}} = v_{\\mathrm{mp}} \\approx 648\\,\\mathrm{m\\,s^{-1}}$", "solution": "对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 系统是稀薄单原子理想气体。\n- 气体是氖气。\n- 温度：$T = 400\\,\\mathrm{K}$。\n- 氖的摩尔质量：$M = 20.1797\\,\\mathrm{g\\,mol^{-1}}$。\n- 理想气体常数：$R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n- 问题是评估方均根速率 $v_{\\mathrm{rms}}$ 等于最可几速率 $v_{\\mathrm{mp}}$ 这一论断。\n- 推导必须从第一性原理出发，仅使用平动动能的 Boltzmann 因子、速度空间的各向同性以及标准常数。\n\n**步骤2：使用已知条件进行验证**\n- **科学上成立：** 该问题根植于气体动理论和统计力学，特别是 Maxwell-Boltzmann 分布。这些是成熟且基础的科学理论。\n- **适定性：** 提供了所有必要的数据（$T$、$M$、$R$）。要推导的量（$v_{\\mathrm{rms}}$、$v_{\\mathrm{mp}}$）定义明确。存在一个唯一、稳定且有意义的解。\n- **客观性：** 问题的表述精确、定量且无偏见。它要求对一个特定的论断进行科学驳斥。\n\n**步骤3：结论与行动**\n问题是有效的。它在科学上是合理的，适定的，并且是完整的。我将继续进行推导和求解。\n\n任务是驳斥学生关于 $v_{\\mathrm{rms}} = v_{\\mathrm{mp}}$ 的论断。这将通过按规定从第一性原理推导这两个量的表达式来实现。\n\n**Maxwell-Boltzmann 速率分布的推导**\n\n设一个分子质量为 $m$，速度为 $\\vec{v} = (v_x, v_y, v_z)$。其平动动能为 $\\epsilon = \\frac{1}{2}m v^2 = \\frac{1}{2}m(v_x^2 + v_y^2 + v_z^2)$。\n\n根据 Boltzmann 因子，分子具有速度分量 $v_x$ 的概率正比于 $e^{-\\epsilon_x / (k_B T)}$，其中 $\\epsilon_x = \\frac{1}{2}m v_x^2$，$k_B$ 是 Boltzmann 常数。\n因此，$v_x$ 的概率密度函数形式为 $g(v_x) = C e^{-m v_x^2 / (2 k_B T)}$。归一化常数 $C$ 通过要求 $\\int_{-\\infty}^{\\infty} g(v_x) dv_x = 1$ 来确定。使用高斯积分 $\\int_{-\\infty}^{\\infty} e^{-ax^2} dx = \\sqrt{\\pi/a}$，其中 $a = m/(2 k_B T)$，我们得到 $C = \\sqrt{m/(2\\pi k_B T)}$。\n所以，单个分量的归一化分布为：\n$$g(v_x) = \\left(\\frac{m}{2\\pi k_B T}\\right)^{1/2} e^{-\\frac{m v_x^2}{2 k_B T}}$$\n由于空间的各向同性，速度分量是独立同分布的。速度矢量 $\\vec{v}$ 的概率密度为：\n$$f(\\vec{v}) = g(v_x) g(v_y) g(v_z) = \\left(\\frac{m}{2\\pi k_B T}\\right)^{3/2} e^{-\\frac{m(v_x^2+v_y^2+v_z^2)}{2 k_B T}} = \\left(\\frac{m}{2\\pi k_B T}\\right)^{3/2} e^{-\\frac{m v^2}{2 k_B T}}$$\n为了找到速率 $v = |\\vec{v}|$ 的分布，我们在速度空间中变换到球坐标。体积元为 $d^3\\vec{v} = v^2 \\sin\\theta dv d\\theta d\\phi$。对所有角度进行积分（$\\int_0^{2\\pi} d\\phi \\int_0^\\pi \\sin\\theta d\\theta = 4\\pi$），得到找到一个速率在 $v$ 和 $v+dv$ 之间的分子的概率 $F(v)dv$：\n$$F(v)dv = \\left(\\frac{m}{2\\pi k_B T}\\right)^{3/2} e^{-\\frac{m v^2}{2 k_B T}} (4\\pi v^2 dv)$$\n因此，Maxwell-Boltzmann 速率分布函数为：\n$$F(v) = 4\\pi \\left(\\frac{m}{2\\pi k_B T}\\right)^{3/2} v^2 e^{-\\frac{m v^2}{2 k_B T}}$$\n\n**最可几速率 ($v_{\\mathrm{mp}}$) 的推导**\n\n最可几速率 $v_{\\mathrm{mp}}$ 对应于分布函数 $F(v)$ 的最大值。我们通过令导数 $\\frac{dF(v)}{dv}$ 等于零来找到它。\n$$\\frac{d}{dv} \\left(v^2 e^{-\\frac{m v^2}{2 k_B T}}\\right) = 0$$\n使用乘积法则：\n$$2v e^{-\\frac{m v^2}{2 k_B T}} + v^2 \\left(-\\frac{2mv}{2 k_B T}\\right) e^{-\\frac{m v^2}{2 k_B T}} = 0$$\n对于 $v > 0$，我们可以除以 $v e^{-\\frac{m v^2}{2 k_B T}}$：\n$$2 - \\frac{m v^2}{k_B T} = 0$$\n解出 $v$ 得到最可几速率 $v_{\\mathrm{mp}}$：\n$$v_{\\mathrm{mp}}^2 = \\frac{2 k_B T}{m} \\implies v_{\\mathrm{mp}} = \\sqrt{\\frac{2 k_B T}{m}}$$\n使用摩尔量，其中 $R = N_A k_B$ 且 $M = N_A m$（$N_A$ 是 Avogadro 数）：\n$$v_{\\mathrm{mp}} = \\sqrt{\\frac{2 (R/N_A) T}{(M/N_A)}} = \\sqrt{\\frac{2 R T}{M}}$$\n\n**方均根速率 ($v_{\\mathrm{rms}}$) 的推导**\n\n方均根速率 $v_{\\mathrm{rms}}$ 是均方速率 $\\langle v^2 \\rangle$ 的平方根。均方速率定义为：\n$$\\langle v^2 \\rangle = \\int_0^\\infty v^2 F(v) dv = \\int_0^\\infty v^2 \\left( 4\\pi \\left(\\frac{m}{2\\pi k_B T}\\right)^{3/2} v^2 e^{-\\frac{m v^2}{2 k_B T}} \\right) dv$$\n$$\\langle v^2 \\rangle = 4\\pi \\left(\\frac{m}{2\\pi k_B T}\\right)^{3/2} \\int_0^\\infty v^4 e^{-\\frac{m v^2}{2 k_B T}} dv$$\n令 $a = \\frac{m}{2 k_B T}$。该积分的形式为 $\\int_0^\\infty x^4 e^{-ax^2} dx = \\frac{3}{8}\\sqrt{\\frac{\\pi}{a^5}}$。\n代入此结果：\n$$\\langle v^2 \\rangle = 4\\pi \\left(\\frac{a}{\\pi}\\right)^{3/2} \\left(\\frac{3}{8}\\sqrt{\\frac{\\pi}{a^5}}\\right) = 4\\pi \\frac{a^{3/2}}{\\pi^{3/2}} \\frac{3\\pi^{1/2}}{8 a^{5/2}} = \\frac{12\\pi a^{3/2} \\pi^{1/2}}{8 \\pi^{3/2} a^{5/2}} = \\frac{3}{2a}$$\n代回 $a = \\frac{m}{2 k_B T}$：\n$$\\langle v^2 \\rangle = \\frac{3}{2(m/(2 k_B T))} = \\frac{3 k_B T}{m}$$\n因此，方均根速率为：\n$$v_{\\mathrm{rms}} = \\sqrt{\\langle v^2 \\rangle} = \\sqrt{\\frac{3 k_B T}{m}}$$\n以摩尔量表示：\n$$v_{\\mathrm{rms}} = \\sqrt{\\frac{3 R T}{M}}$$\n\n**定量反例**\n\n从推导出的表达式可以看出，$v_{\\mathrm{rms}} = \\sqrt{\\frac{3 R T}{M}}$ 且 $v_{\\mathrm{mp}} = \\sqrt{\\frac{2 R T}{M}}$。很明显，$v_{\\mathrm{rms}} \\neq v_{\\mathrm{mp}}$。具体来说，$v_{\\mathrm{rms}} = \\sqrt{3/2} \\cdot v_{\\mathrm{mp}} \\approx 1.225 \\cdot v_{\\mathrm{mp}}$。因此，从第一性原理证明了该学生的论断是错误的。\n\n现在我们对 $T = 400\\,\\mathrm{K}$ 的氖气进行数值计算。\n已知：\n$T = 400\\,\\mathrm{K}$\n$M = 20.1797\\,\\mathrm{g\\,mol^{-1}} = 0.0201797\\,\\mathrm{kg\\,mol^{-1}}$\n$R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n\n$v_{\\mathrm{mp}}$ 的计算：\n$$v_{\\mathrm{mp}} = \\sqrt{\\frac{2 \\times (8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}) \\times (400\\,\\mathrm{K})}{0.0201797\\,\\mathrm{kg\\,mol^{-1}}}} \\approx \\sqrt{\\frac{6651.57}{0.0201797}}\\,\\mathrm{m\\,s^{-1}} \\approx \\sqrt{329617.45}\\,\\mathrm{m\\,s^{-1}} \\approx 574.12\\,\\mathrm{m\\,s^{-1}}$$\n\n$v_{\\mathrm{rms}}$ 的计算：\n$$v_{\\mathrm{rms}} = \\sqrt{\\frac{3 \\times (8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}) \\times (400\\,\\mathrm{K})}{0.0201797\\,\\mathrm{kg\\,mol^{-1}}}} \\approx \\sqrt{\\frac{9977.36}{0.0201797}}\\,\\mathrm{m\\,s^{-1}} \\approx \\sqrt{494426.18}\\,\\mathrm{m\\,s^{-1}} \\approx 703.15\\,\\mathrm{m\\,s^{-1}}$$\n\n如选项中那样四舍五入到最接近的整数，我们得到 $v_{\\mathrm{mp}} \\approx 574\\,\\mathrm{m\\,s^{-1}}$ 和 $v_{\\mathrm{rms}} \\approx 703\\,\\mathrm{m\\,s^{-1}}$。\n\n**选项评估**\n\n- **A. $v_{\\mathrm{rms}} \\approx 703\\,\\mathrm{m\\,s^{-1}}$ 和 $v_{\\mathrm{mp}} \\approx 574\\,\\mathrm{m\\,s^{-1}}$**\n该选项给出的数值与我们严谨的推导和数值计算相符。它正确地表明了 $v_{\\mathrm{rms}} > v_{\\mathrm{mp}}$ 并提供了正确的数值。这构成了一个有效的反例。\n**结论：正确**\n\n- **B. $v_{\\mathrm{rms}} = v_{\\mathrm{mp}} \\approx 574\\,\\mathrm{m\\,s^{-1}}$**\n该选项提出了 $v_{\\mathrm{rms}} = v_{\\mathrm{mp}}$ 的错误论断。推导证明了这是错误的。它还错误地将 $v_{\\mathrm{mp}}$ 的值赋给了 $v_{\\mathrm{rms}}$。\n**结论：错误**\n\n- **C. $v_{\\mathrm{rms}} \\approx 574\\,\\mathrm{m\\,s^{-1}}$ 和 $v_{\\mathrm{mp}} \\approx 703\\,\\mathrm{m\\,s^{-1}}$**\n该选项正确地认识到两个速率不相等，但错误地交换了它们的值。推导表明 $v_{\\mathrm{rms}} = \\sqrt{3/2} \\cdot v_{\\mathrm{mp}}$，因此 $v_{\\mathrm{rms}}$ 必须大于 $v_{\\mathrm{mp}}$。\n**结论：错误**\n\n- **D. $v_{\\mathrm{rms}} = v_{\\mathrm{mp}} \\approx 648\\,\\mathrm{m\\,s^{-1}}$**\n该选项也提出了 $v_{\\mathrm{rms}} = v_{\\mathrm{mp}}$ 的错误论断。数值 $648\\,\\mathrm{m\\,s^{-1}}$ 大约是平均速率，$v_{\\mathrm{avg}} = \\sqrt{8RT/\\pi M} \\approx 647.7\\,\\mathrm{m\\,s^{-1}}$。这在多个层面上都是不相关且错误的。\n**结论：错误**", "answer": "$$\\boxed{A}$$", "id": "2947207"}, {"introduction": "麦克斯韦-玻尔兹曼分布的形状源于两个因素的竞争：指数衰减的玻尔兹曼因子和随速率增加的相空间体积。为了更深入地理解后者的作用，本练习将引导您探索一个假设的二维气体系统。通过推导并比较二维和三维空间中的速率分布，您将能够清晰地看到维度（体现在雅可比行列式 $v^{d-1}$ 中）是如何从根本上塑造这些概率分布的。[@problem_id:2947240]", "problem": "质量为 $m$ 的理想单原子气体粒子处于热平衡状态，绝对温度为 $T$。在 $d$ 维空间中，速度矢量 $\\mathbf{v}=(v_{1},\\dots,v_{d})$ 的平衡概率密度与 $\\exp\\!\\big(-m |\\mathbf{v}|^{2}/(2 k_{\\mathrm{B}} T)\\big)$ 成正比，其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数。以此为基础，在二维空间 ($d=2$) 中进行计算，并：\n\n1. 在速度空间中从笛卡尔坐标变换到极坐标，以推导速率 $v=|\\mathbf{v}|$ 的归一化概率密度。请仔细考虑变量替换产生的雅可比因子。\n2. 使用此速率密度，明确求出以 $k_{\\mathrm{B}}$、$T$ 和 $m$ 表示的最概然速率 $v_{\\mathrm{mp},2}$ 和平均速率 $\\langle v\\rangle_{2}$。\n3. 对 $d=3$ 的情况重复此推导，以获得 $v_{\\mathrm{mp},3}$ 和 $\\langle v\\rangle_{3}$。\n\n为了量化雅可比因子 $v^{d-1}$ 在塑造 $d=2$ 和 $d=3$ 之间分布差异中的作用，定义无量纲比较\n$$\nR \\;=\\; \\frac{\\big(\\langle v\\rangle_{2}/v_{\\mathrm{mp},2}\\big)}{\\big(\\langle v\\rangle_{3}/v_{\\mathrm{mp},3}\\big)}.\n$$\n给出 $R$ 的单个精确表达式作为最终答案，不带单位。不要对结果进行四舍五入。", "solution": "我们从 $d$ 维空间中速度矢量的麦克斯韦-玻尔兹曼形式开始。$\\mathbf{v}\\in\\mathbb{R}^{d}$ 的联合概率密度为\n$$\np(\\mathbf{v}) \\;=\\; A_{d}\\,\\exp\\!\\left(-\\frac{m}{2 k_{\\mathrm{B}} T}\\,|\\mathbf{v}|^{2}\\right),\n$$\n其中 $A_{d}$ 是一个归一化常数。速率 $v=|\\mathbf{v}|$ 是 $\\mathbf{v}$ 的模。为得到速率分布，我们在速度空间中变换到超球坐标，并对角度进行积分。$(d-1)$ 维球面上的表面积元贡献了一个与 $v^{d-1}$ 成正比的雅可比因子，因此（未归一化的）速率密度具有以下形式\n$$\nf_{d}(v)\\,\\mathrm{d}v \\;\\propto\\; v^{d-1}\\,\\exp\\!\\left(-\\alpha v^{2}\\right)\\,\\mathrm{d}v,\\qquad \\alpha \\equiv \\frac{m}{2 k_{\\mathrm{B}} T},\\quad v\\ge 0.\n$$\n归一化确定了该常数。使用对于 $\\alpha>0$ 和 $s>0$ 的标准积分，\n$$\n\\int_{0}^{\\infty} v^{s-1}\\,\\exp(-\\alpha v^{2})\\,\\mathrm{d}v \\;=\\; \\frac{1}{2}\\,\\alpha^{-s/2}\\,\\Gamma\\!\\left(\\frac{s}{2}\\right),\n$$\n我们得到 $d$ 维空间中的归一化速率密度：\n$$\nf_{d}(v) \\;=\\; \\frac{2\\,\\alpha^{d/2}}{\\Gamma\\!\\left(\\frac{d}{2}\\right)}\\,v^{d-1}\\,\\exp\\!\\left(-\\alpha v^{2}\\right),\\qquad v\\ge 0.\n$$\n\n$d$ 维空间中的最概然速率。最概然速率 $v_{\\mathrm{mp},d}$ 使 $f_{d}(v)$ 在 $v\\ge 0$ 时最大化。因为前置因子是常数，我们只需最大化 $g(v)=v^{d-1}\\exp(-\\alpha v^{2})$。对 $\\ln g(v)=(d-1)\\ln v-\\alpha v^{2}$ 求导并令其为零，\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}v}\\ln g(v) \\;=\\; \\frac{d-1}{v} - 2\\alpha v \\;=\\; 0 \\;\\;\\Longrightarrow\\;\\; v_{\\mathrm{mp},d}^{2} \\;=\\; \\frac{d-1}{2\\alpha} \\;=\\; \\frac{(d-1)\\,k_{\\mathrm{B}} T}{m}.\n$$\n因此，\n$$\nv_{\\mathrm{mp},d} \\;=\\; \\sqrt{\\frac{(d-1)\\,k_{\\mathrm{B}} T}{m}}.\n$$\n\n$d$ 维空间中的平均速率。平均值为\n$$\n\\langle v\\rangle_{d} \\;=\\; \\int_{0}^{\\infty} v\\,f_{d}(v)\\,\\mathrm{d}v \\;=\\; \\frac{2\\,\\alpha^{d/2}}{\\Gamma\\!\\left(\\frac{d}{2}\\right)} \\int_{0}^{\\infty} v^{d}\\,\\exp(-\\alpha v^{2})\\,\\mathrm{d}v.\n$$\n使用相同的积分，令 $s=d+1$，\n$$\n\\int_{0}^{\\infty} v^{d}\\,\\exp(-\\alpha v^{2})\\,\\mathrm{d}v \\;=\\; \\frac{1}{2}\\,\\alpha^{-(d+1)/2}\\,\\Gamma\\!\\left(\\frac{d+1}{2}\\right),\n$$\n我们得到\n$$\n\\langle v\\rangle_{d} \\;=\\; \\alpha^{-1/2}\\,\\frac{\\Gamma\\!\\left(\\frac{d+1}{2}\\right)}{\\Gamma\\!\\left(\\frac{d}{2}\\right)} \\;=\\; \\sqrt{\\frac{2 k_{\\mathrm{B}} T}{m}}\\;\\frac{\\Gamma\\!\\left(\\frac{d+1}{2}\\right)}{\\Gamma\\!\\left(\\frac{d}{2}\\right)}.\n$$\n\n具体到 $d=2$ 的情况。代入 $d=2$ 得到\n$$\nv_{\\mathrm{mp},2} \\;=\\; \\sqrt{\\frac{k_{\\mathrm{B}} T}{m}},\\qquad\n\\langle v\\rangle_{2} \\;=\\; \\sqrt{\\frac{2 k_{\\mathrm{B}} T}{m}}\\;\\frac{\\Gamma\\!\\left(\\frac{3}{2}\\right)}{\\Gamma(1)} \\;=\\; \\sqrt{\\frac{2 k_{\\mathrm{B}} T}{m}}\\;\\frac{\\sqrt{\\pi}}{2} \\;=\\; \\sqrt{\\frac{\\pi k_{\\mathrm{B}} T}{2 m}}.\n$$\n\n具体到 $d=3$ 的情况。代入 $d=3$ 得到\n$$\nv_{\\mathrm{mp},3} \\;=\\; \\sqrt{\\frac{2 k_{\\mathrm{B}} T}{m}},\\qquad\n\\langle v\\rangle_{3} \\;=\\; \\sqrt{\\frac{2 k_{\\mathrm{B}} T}{m}}\\;\\frac{\\Gamma(2)}{\\Gamma\\!\\left(\\frac{3}{2}\\right)} \\;=\\; \\sqrt{\\frac{2 k_{\\mathrm{B}} T}{m}}\\;\\frac{1}{\\sqrt{\\pi}/2} \\;=\\; \\sqrt{\\frac{8 k_{\\mathrm{B}} T}{\\pi m}}.\n$$\n\n构建比较值 $R$。首先，分别计算每个维度下平均速率与最概然速率的比值：\n$$\n\\frac{\\langle v\\rangle_{2}}{v_{\\mathrm{mp},2}} \\;=\\; \\frac{\\sqrt{\\frac{\\pi k_{\\mathrm{B}} T}{2 m}}}{\\sqrt{\\frac{k_{\\mathrm{B}} T}{m}}} \\;=\\; \\sqrt{\\frac{\\pi}{2}},\\qquad\n\\frac{\\langle v\\rangle_{3}}{v_{\\mathrm{mp},3}} \\;=\\; \\frac{\\sqrt{\\frac{8 k_{\\mathrm{B}} T}{\\pi m}}}{\\sqrt{\\frac{2 k_{\\mathrm{B}} T}{m}}} \\;=\\; \\frac{2}{\\sqrt{\\pi}}.\n$$\n因此，\n$$\nR \\;=\\; \\frac{\\left(\\langle v\\rangle_{2}/v_{\\mathrm{mp},2}\\right)}{\\left(\\langle v\\rangle_{3}/v_{\\mathrm{mp},3}\\right)} \\;=\\; \\frac{\\sqrt{\\frac{\\pi}{2}}}{\\,2/\\sqrt{\\pi}\\,} \\;=\\; \\frac{\\pi}{2\\sqrt{2}}.\n$$\n\n这个无量纲比较清晰地展示了雅可比因子 $v^{d-1}$ 的影响：在三维空间中（通过 $v^{2}$），对较高速率的权重更大，使得平均值相对地比在二维空间中（通过 $v^{1}$）更接近最概然速率，从而得到 $R>1$，其精确值如上所示。", "answer": "$$\\boxed{\\frac{\\pi}{2\\sqrt{2}}}$$", "id": "2947240"}, {"introduction": "将解析理论与计算科学相结合是现代物理化学研究的重要方法。本练习将指导您设计一个蒙特卡洛模拟，从最基本的原理——速度分量的独立高斯分布——出发，生成分子速率样本。通过将模拟结果与理论分布进行统计比较，您不仅能验证麦克斯韦-玻尔兹曼分布的正确性，还能掌握一种通过计算实验来检验物理模型的强大实践技能。[@problem_id:2947200]", "problem": "在热力学平衡状态下，绝对温度为 $T$ 的稀薄单原子理想气体中的单个无相互作用的原子，其动能为 $E = \\frac{1}{2} m v^{2}$，其中 $m$ 是粒子质量，$v$ 是速率。在正则系综中，速度空间中的概率密度与 $\\exp\\!\\left(- \\frac{E}{k_{\\mathrm{B}} T}\\right)$ 成正比，其中 $k_{\\mathrm{B}}$ 是 Boltzmann 常数。以此为基本出发点，按以下步骤进行。\n\n- 从第一性原理出发，证明速度的三个笛卡尔分量 $(v_{x}, v_{y}, v_{z})$ 是均值为 $0$、方差为 $\\sigma^{2} = \\frac{k_{\\mathrm{B}} T}{m}$ 的独立同分布高斯随机变量。\n- 通过在速度空间中变换到球坐标系，推导标量速率 $v = \\sqrt{v_{x}^{2} + v_{y}^{2} + v_{z}^{2}}$ 的一维概率密度函数 (Probability Density Function (PDF))。由此，用初等函数和误差函数表示相应的累积分布函数 (Cumulative Distribution Function (CDF)) $F(v)$。\n- 推导平均速率 $\\langle v \\rangle$ 和均方速率 $\\langle v^{2} \\rangle$ 的闭合形式表达式，并验证 $\\frac{1}{2} m \\langle v^{2} \\rangle = \\frac{3}{2} k_{\\mathrm{B}} T$ 符合能量均分定理的要求。\n- 设计一个算法，通过抽取三个方差为 $\\sigma^{2} = \\frac{k_{\\mathrm{B}} T}{m}$、均值为 $0$ 的独立高斯偏差量，将它们组合成一个速度矢量 $(v_{x}, v_{y}, v_{z})$，然后计算其欧几里得范数作为速率 $v$，来对三维分子速度进行采样。使用大小为 $N$ 的 Monte Carlo (MC) 样本来经验地近似速率分布。\n- 为验证采样速率是否遵循理论推导的速率 CDF，计算 Kolmogorov–Smirnov (KS) 统计量，其定义为经验 CDF 和理论 CDF 之间绝对差值在 $v \\in [0, \\infty)$ 上的上确界。此外，计算两个无量纲的诊断量：平均速率的相对误差 $\\left|\\langle v \\rangle_{\\mathrm{emp}} - \\langle v \\rangle_{\\mathrm{th}}\\right| / \\langle v \\rangle_{\\mathrm{th}}$，以及平均动能的相对误差 $\\left|\\frac{1}{2} m \\langle v^{2} \\rangle_{\\mathrm{emp}} - \\frac{3}{2} k_{\\mathrm{B}} T\\right| \\big/ \\left(\\frac{3}{2} k_{\\mathrm{B}} T\\right)$。\n- 使用 Boltzmann 常数 $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23} \\ \\mathrm{J \\, K^{-1}}$。所有物理量必须以国际单位制 (SI) 表示。质量必须以千克为单位，温度以开尔文为单位，速率以 $\\mathrm{m \\, s^{-1}}$ 为单位，能量以焦耳为单位。您计算的诊断量是无量纲的，应以十进制浮点数形式报告。\n\n实现一个程序，对以下测试套件执行采样和验证。在每种情况下，使用提供的伪随机种子以确保可复现性，并如上所述精确抽取 $N$ 个独立的三维速度矢量。原子质量以原子质量单位指定（使用 $1 \\ \\mathrm{u} = 1.66053906660 \\times 10^{-27} \\ \\mathrm{kg}$ 进行转换），然后在所有计算中使用转换后的千克质量。\n\n- 测试用例 1 (正常路径)：氩，质量 $39.948 \\ \\mathrm{u}$，$T = 300 \\ \\mathrm{K}$，$N = 200000$，种子 $12345$。\n- 测试用例 2 (低温，轻原子)：氦，质量 $4.002602 \\ \\mathrm{u}$，$T = 10 \\ \\mathrm{K}$，$N = 100000$，种子 $24680$。\n- 测试用例 3 (高温，重原子)：氙，质量 $131.293 \\ \\mathrm{u}$，$T = 1000 \\ \\mathrm{K}$，$N = 150000$，种子 $13579$。\n- 测试用例 4 (小样本边界)：氮，质量 $28.0134 \\ \\mathrm{u}$，$T = 300 \\ \\mathrm{K}$，$N = 5000$，种子 $98765$。\n\n对于每个测试用例，计算并返回一个包含三个浮点数的列表：\n- Kolmogorov–Smirnov 统计量，\n- 平均速率的相对误差，\n- 平均动能的相对误差。\n\n最终输出格式要求：\n- 您的程序应生成单行输出，其中包含一个按顺序排列的四个测试用例结果的列表，每个测试用例结果本身就是一个包含三个浮点数的列表。总体格式必须是一个用方括号括起来的列表，条目之间用逗号分隔，不含空格，例如 $[[a_{11},a_{12},a_{13}],[a_{21},a_{22},a_{23}],[a_{31},a_{32},a_{33}],[a_{41},a_{42},a_{43}]]$.\n- 输出中的每个浮点数必须格式化为小数点后恰好六位数字。", "solution": "该问题具有科学依据，提法明确，并包含了完整解答所需的所有信息。这是统计力学中的一个标准练习，结合了理论推导和数值验证。因此，该问题被认为是有效的。\n\n解决方案分两个阶段进行。首先，从第一性原理推导所需的理论表达式。其次，设计并实现一个算法来执行 Monte Carlo 模拟并计算指定的诊断量。\n\n**理论推导**\n\n**1. 速度分量分布**\n\n问题指出，在正则系综中，速度矢量 $\\vec{v} = (v_x, v_y, v_z)$ 的概率密度函数 (PDF) 与 $\\exp(-E / (k_{\\mathrm{B}} T))$ 成正比。动能纯粹是平动能：\n$$E = \\frac{1}{2} m v^2 = \\frac{1}{2} m (v_x^2 + v_y^2 + v_z^2)$$\n其中 $m$ 是原子质量，$T$ 是绝对温度，$k_{\\mathrm{B}}$ 是 Boltzmann 常数。\n\n因此，速度分量的联合 PDF 为：\n$$P(v_x, v_y, v_z) \\propto \\exp\\left(-\\frac{m(v_x^2 + v_y^2 + v_z^2)}{2 k_{\\mathrm{B}} T}\\right)$$\n这个表达式可以分解为三个关于 $v_x$, $v_y$ 和 $v_z$ 的独立函数：\n$$P(v_x, v_y, v_z) \\propto \\exp\\left(-\\frac{m v_x^2}{2 k_{\\mathrm{B}} T}\\right) \\exp\\left(-\\frac{m v_y^2}{2 k_{\\mathrm{B}} T}\\right) \\exp\\left(-\\frac{m v_z^2}{2 k_{\\mathrm{B}} T}\\right)$$\n这种分解意味着速度分量 $v_x$, $v_y$ 和 $v_z$ 是统计独立的随机变量。任何单个分量（例如 $v_x$）的 PDF 为：\n$$p(v_x) \\propto \\exp\\left(-\\frac{m v_x^2}{2 k_{\\mathrm{B}} T}\\right)$$\n这是高斯（正态）分布的函数形式，其通用 PDF 由下式给出：\n$$f(x; \\mu, \\sigma^2) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(x - \\mu)^2}{2\\sigma^2}\\right)$$\n通过将 $p(v_x)$ 中的指数与通用形式进行比较，我们可以通过令二次项的系数相等来确定均值 $\\mu = 0$ 和方差 $\\sigma^2$：\n$$\\frac{m}{2 k_{\\mathrm{B}} T} = \\frac{1}{2\\sigma^2} \\implies \\sigma^2 = \\frac{k_{\\mathrm{B}} T}{m}$$\n由于 $v_x$, $v_y$ 和 $v_z$ 的函数形式相同，这三个分量是均值为 $0$、方差为 $\\sigma^2 = k_{\\mathrm{B}} T / m$ 的独立同分布 (i.i.d.) 高斯随机变量。\n\n**2. 速率分布（麦克斯韦-玻尔兹曼）**\n\n为了推导标量速率 $v = \\sqrt{v_x^2 + v_y^2 + v_z^2}$ 的 PDF，我们将联合 PDF 从笛卡尔速度坐标 $(v_x, v_y, v_z)$ 变换到球坐标 $(v, \\theta, \\phi)$，其中 $v \\in [0, \\infty)$，$\\theta \\in [0, \\pi]$，$\\phi \\in [0, 2\\pi)$。速度空间中的体积元变换为 $dv_x dv_y dv_z = v^2 \\sin\\theta \\, dv \\, d\\theta \\, d\\phi$。\n\n笛卡尔坐标系中的归一化联合 PDF 为：\n$$P(v_x, v_y, v_z) = \\left(\\frac{m}{2\\pi k_{\\mathrm{B}} T}\\right)^{3/2} \\exp\\left(-\\frac{m(v_x^2 + v_y^2 + v_z^2)}{2 k_{\\mathrm{B}} T}\\right)$$\n在无穷小体积元中找到速度矢量的概率是 $P(v_x, v_y, v_z) \\, dv_x dv_y dv_z$。在球坐标中，这个概率是：\n$$d\\text{Prob} = \\left(\\frac{m}{2\\pi k_{\\mathrm{B}} T}\\right)^{3/2} \\exp\\left(-\\frac{m v^2}{2 k_{\\mathrm{B}} T}\\right) v^2 \\sin\\theta \\, dv \\, d\\theta \\, d\\phi$$\n为了求出速率 $v$ 的 PDF，记为 $f(v)$，我们对所有可能的立体角进行积分：\n$$f(v) dv = \\left[ \\int_0^{2\\pi} \\int_0^{\\pi} \\left(\\frac{m}{2\\pi k_{\\mathrm{B}} T}\\right)^{3/2} \\exp\\left(-\\frac{m v^2}{2 k_{\\mathrm{B}} T}\\right) v^2 \\sin\\theta \\, d\\theta \\, d\\phi \\right] dv$$\n对角度部分的积分是 $\\int_0^{2\\pi} d\\phi \\int_0^{\\pi} \\sin\\theta \\, d\\theta = (2\\pi)(2) = 4\\pi$。\n因此，速率 PDF 为：\n$$f(v) = 4\\pi \\left(\\frac{m}{2\\pi k_{\\mathrm{B}} T}\\right)^{3/2} v^2 \\exp\\left(-\\frac{m v^2}{2 k_{\\mathrm{B}} T}\\right)$$\n这就是分子速率的麦克斯韦-玻尔兹曼分布。\n\n累积分布函数 (CDF) $F(v)$ 是 PDF 从 $0$ 到 $v$ 的积分：\n$$F(v) = \\int_0^v f(u) \\, du = 4\\pi \\left(\\frac{m}{2\\pi k_{\\mathrm{B}} T}\\right)^{3/2} \\int_0^v u^2 \\exp\\left(-\\frac{m u^2}{2 k_{\\mathrm{B}} T}\\right) du$$\n令 $a = m / (2k_{\\mathrm{B}} T)$ 并进行变量替换 $x = u\\sqrt{a}$。那么 $du = dx/\\sqrt{a}$。积分变为：\n$$F(v) = 4\\pi \\left(\\frac{a}{\\pi}\\right)^{3/2} \\int_0^{v\\sqrt{a}} \\left(\\frac{x}{\\sqrt{a}}\\right)^2 e^{-x^2} \\frac{dx}{\\sqrt{a}} = \\frac{4}{\\sqrt{\\pi}} \\int_0^{v\\sqrt{a}} x^2 e^{-x^2} dx$$\n对 $\\int x^2 e^{-x^2} dx$ 使用分部积分法，令 $u=x$ 和 $dv'=x e^{-x^2} dx$，我们得到 $\\int x^2 e^{-x^2} dx = -\\frac{1}{2} x e^{-x^2} + \\frac{1}{2} \\int e^{-x^2} dx$。\n根据误差函数的定义 $\\text{erf}(z) = \\frac{2}{\\sqrt{\\pi}} \\int_0^z e^{-x^2} dx$，定积分为：\n$$\\int_0^{z} x^2 e^{-x^2} dx = \\left[-\\frac{1}{2} x e^{-x^2}\\right]_0^z + \\frac{1}{2} \\int_0^z e^{-x^2} dx = -\\frac{1}{2} z e^{-z^2} + \\frac{\\sqrt{\\pi}}{4} \\text{erf}(z)$$\n代入 $z = v\\sqrt{a}$，CDF 变为：\n$$F(v) = \\frac{4}{\\sqrt{\\pi}} \\left(-\\frac{1}{2} v\\sqrt{a} \\, e^{-av^2} + \\frac{\\sqrt{\\pi}}{4} \\text{erf}(v\\sqrt{a})\\right)$$\n$$F(v) = \\text{erf}\\left(v\\sqrt{\\frac{m}{2 k_{\\mathrm{B}} T}}\\right) - \\frac{2}{\\sqrt{\\pi}} v\\sqrt{\\frac{m}{2 k_{\\mathrm{B}} T}} \\exp\\left(-\\frac{m v^2}{2 k_{\\mathrm{B}} T}\\right)$$\n\n**3. 平均速率和均方速率**\n\n平均速率 $\\langle v \\rangle$ 是速率 PDF 的一阶矩：\n$$\\langle v \\rangle = \\int_0^{\\infty} v f(v) \\, dv = 4\\pi \\left(\\frac{a}{\\pi}\\right)^{3/2} \\int_0^{\\infty} v^3 e^{-av^2} dv$$\n使用标准积分 $\\int_0^{\\infty} x^3 e^{-ax^2} dx = 1/(2a^2)$，我们得到：\n$$\\langle v \\rangle = 4\\pi \\left(\\frac{a}{\\pi}\\right)^{3/2} \\frac{1}{2a^2} = \\frac{2}{\\sqrt{\\pi a}} = \\sqrt{\\frac{4}{\\pi a}} = \\sqrt{\\frac{4}{\\pi} \\frac{2k_{\\mathrm{B}}T}{m}} = \\sqrt{\\frac{8 k_{\\mathrm{B}} T}{\\pi m}}$$\n均方速率 $\\langle v^2 \\rangle$ 是二阶矩：\n$$\\langle v^2 \\rangle = \\int_0^{\\infty} v^2 f(v) \\, dv = 4\\pi \\left(\\frac{a}{\\pi}\\right)^{3/2} \\int_0^{\\infty} v^4 e^{-av^2} dv$$\n使用标准积分 $\\int_0^{\\infty} x^4 e^{-ax^2} dx = \\frac{3}{8}\\sqrt{\\frac{\\pi}{a^5}}$，我们得到：\n$$\\langle v^2 \\rangle = 4\\pi \\left(\\frac{a}{\\pi}\\right)^{3/2} \\frac{3}{8} \\sqrt{\\frac{\\pi}{a^5}} = \\frac{3}{2a} = \\frac{3 k_{\\mathrm{B}} T}{m}$$\n最后，我们验证能量均分定理。平均动能为：\n$$\\langle E \\rangle = \\frac{1}{2} m \\langle v^2 \\rangle = \\frac{1}{2} m \\left(\\frac{3 k_{\\mathrm{B}} T}{m}\\right) = \\frac{3}{2} k_{\\mathrm{B}} T$$\n这个结果是正确的，因为单原子粒子有 3 个平动自由度，每个自由度对平均能量的贡献为 $\\frac{1}{2} k_{\\mathrm{B}} T$。\n\n**算法设计与验证**\n\n该算法基于推导出的原理实现了一个 Monte Carlo 模拟。\n\n1.  **初始化**：对于每个测试用例（质量 $m_u$，温度 $T$，样本大小 $N$，种子），设置物理常数 $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23} \\, \\mathrm{J \\, K^{-1}}$ 和 $1 \\, \\mathrm{u} = 1.66053906660 \\times 10^{-27} \\, \\mathrm{kg}$。将质量从原子质量单位转换为千克：$m = m_u \\times (1.66053906660 \\times 10^{-27})$。\n2.  **参数计算**：计算方差 $\\sigma^2 = k_{\\mathrm{B}} T / m$ 以及理论计算所需的相关参数 $a = m / (2k_{\\mathrm{B}} T)$。\n3.  **速度采样**：\n    *   使用指定的种子初始化伪随机数生成器以保证可复现性。\n    *   从标准正态分布（均值为 $0$，方差为 $1$）中生成 $N \\times 3$ 个独立随机数样本。\n    *   将其重塑为一个 $N \\times 3$ 的数组，表示 $N$ 组 $(g_x, g_y, g_z)$。\n    *   将这些偏差量乘以标准差 $\\sigma = \\sqrt{\\sigma^2}$，以生成 $N$ 个速度矢量 $(v_x, v_y, v_z)$，其中每个分量都从 $N(0, \\sigma^2)$ 分布中抽取。\n4.  **速率计算**：对于每个速度矢量，计算速率 $v = \\sqrt{v_x^2 + v_y^2 + v_z^2}$。这将得到一个包含 $N$ 个速率的样本。\n5.  **诊断量计算**：\n    *   **Kolmogorov-Smirnov (KS) 统计量**：该统计量衡量采样速率的经验 CDF (ECDF) 与理论 CDF $F(v)$ 之间的最大绝对差。ECDF 是根据已排序的速率样本构建的。使用 `scipy.stats.kstest` 函数将采样速率与推导出的理论 CDF $F(v)$ 进行比较。\n    *   **平均速率的相对误差**：经验平均速率 $\\langle v \\rangle_{\\mathrm{emp}}$ 是 $N$ 个采样速率的算术平均值。理论平均速率是 $\\langle v \\rangle_{\\mathrm{th}} = \\sqrt{8k_{\\mathrm{B}}T/(\\pi m)}$。相对误差计算为 $|\\langle v \\rangle_{\\mathrm{emp}} - \\langle v \\rangle_{\\mathrm{th}}| / \\langle v \\rangle_{\\mathrm{th}}$。\n    *   **平均动能的相对误差**：经验均方速率 $\\langle v^2 \\rangle_{\\mathrm{emp}}$ 是采样速率平方的平均值。经验平均动能是 $\\langle E \\rangle_{\\mathrm{emp}} = \\frac{1}{2} m \\langle v^2 \\rangle_{\\mathrm{emp}}$。理论平均动能是 $\\langle E \\rangle_{\\mathrm{th}} = \\frac{3}{2} k_{\\mathrm{B}} T$。相对误差是 $| \\langle E \\rangle_{\\mathrm{emp}} - \\langle E \\rangle_{\\mathrm{th}} | / \\langle E \\rangle_{\\mathrm{th}}$。\n\n将此过程应用于问题陈述中提供的每个测试用例。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import kstest\nfrom scipy.special import erf\n\ndef solve():\n    \"\"\"\n    Solves the problem by running Monte Carlo simulations for each test case\n    and computing the required diagnostics.\n    \"\"\"\n    # Define constants\n    K_B = 1.380649e-23  # Boltzmann constant in J/K\n    U_TO_KG = 1.66053906660e-27  # Atomic mass unit to kg\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (mass_u, T_K, N, seed)\n        (39.948, 300.0, 200000, 12345),      # Argon\n        (4.002602, 10.0, 100000, 24680),     # Helium\n        (131.293, 1000.0, 150000, 13579),    # Xenon\n        (28.0134, 300.0, 5000, 98765),       # Nitrogen (as point mass)\n    ]\n\n    results = []\n    for mass_u, T, N, seed in test_cases:\n        # Step 1: Initialization and Parameter Calculation\n        m_kg = mass_u * U_TO_KG\n        \n        # Variance of velocity components\n        sigma_sq = (K_B * T) / m_kg\n        sigma = np.sqrt(sigma_sq)\n        \n        # Parameter 'a' for theoretical formulas\n        a = m_kg / (2.0 * K_B * T)\n        sqrt_a = np.sqrt(a)\n\n        # Step 2: Sampling Velocities and Speeds\n        rng = np.random.default_rng(seed)\n        # Generate N velocity vectors (N, 3) with components from N(0, sigma^2)\n        velocity_vectors = rng.normal(loc=0.0, scale=sigma, size=(N, 3))\n        # Compute the speed (Euclidean norm) for each vector\n        sampled_speeds = np.linalg.norm(velocity_vectors, axis=1)\n\n        # Step 3: Compute Diagnostics\n        \n        # 3.1: Kolmogorov-Smirnov Statistic\n        \n        # Define the theoretical CDF F(v)\n        def theoretical_cdf(v):\n            z = v * sqrt_a\n            term1 = erf(z)\n            term2 = (2.0 / np.sqrt(np.pi)) * z * np.exp(-z**2)\n            return term1 - term2\n\n        # Perform the KS test\n        ks_result = kstest(sampled_speeds, theoretical_cdf)\n        ks_statistic = ks_result.statistic\n\n        # 3.2: Relative Error in Mean Speed\n        mean_speed_emp = np.mean(sampled_speeds)\n        mean_speed_th = np.sqrt(8.0 * K_B * T / (np.pi * m_kg))\n        rel_err_mean_speed = np.abs(mean_speed_emp - mean_speed_th) / mean_speed_th\n\n        # 3.3: Relative Error in Mean Kinetic Energy\n        mean_sq_speed_emp = np.mean(np.power(sampled_speeds, 2))\n        mean_energy_emp = 0.5 * m_kg * mean_sq_speed_emp\n        mean_energy_th = 1.5 * K_B * T\n        rel_err_mean_energy = np.abs(mean_energy_emp - mean_energy_th) / mean_energy_th\n\n        # Store the three computed diagnostics for this test case\n        results.append([ks_statistic, rel_err_mean_speed, rel_err_mean_energy])\n\n    # Final print statement in the exact required format.\n    sub_results = []\n    for res_tuple in results:\n        sub_results.append(f\"[{res_tuple[0]:.6f},{res_tuple[1]:.6f},{res_tuple[2]:.6f}]\")\n    final_output_str = f\"[{','.join(sub_results)}]\"\n    print(final_output_str)\n\nsolve()\n```", "id": "2947200"}]}