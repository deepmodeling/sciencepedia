{"hands_on_practices": [{"introduction": "现实世界中的量子体系很少能被理想化的模型完美描述。微扰理论为我们提供了一个强有力的数学框架，用以分析微小外部影响或内部相互作用如何改变体系的能量和状态。本练习 [@problem_id:357028] 将带你应用简并微扰理论，探究在一个具有高度对称性的三维箱中，一个简单的微扰势如何解除能级的简并性，这是理解原子和分子光谱中能级分裂的关键一步。", "problem": "一个质量为 $m$ 的粒子被限制在一个边长为 $L$ 的三维立方盒子中。势能 $V(x,y,z)$ 在盒子内部（$0  x, y, z  L$）为零，在盒子外部为无穷大。未受微扰的定态由波函数\n$$\n\\psi_{n_x, n_y, n_z}^{(0)}(x, y, z) = \\left(\\frac{2}{L}\\right)^{3/2} \\sin\\left(\\frac{n_x \\pi x}{L}\\right) \\sin\\left(\\frac{n_y \\pi y}{L}\\right) \\sin\\left(\\frac{n_z \\pi z}{L}\\right)\n$$\n描述，其对应的能量为\n$$\nE_{n_x, n_y, n_z}^{(0)} = \\frac{\\pi^2 \\hbar^2}{2mL^2} (n_x^2 + n_y^2 + n_z^2)\n$$\n其中 $n_x, n_y, n_z$ 为正整数。\n\n该系统的第一激发能级是三重简并的。现在，该系统受到一个由势 $V' = \\epsilon z^2$ 描述的弱微扰，其中 $\\epsilon$ 是一个具有适当单位的小常数。\n\n使用一级简并微扰理论，推导第一激发态能量分裂大小 $\\Delta E$ 的表达式。该分裂定义为由微扰引起的最高和最低修正后能量本征值之间的绝对差。", "solution": "我们在由 $\\{|1,1,2\\},\\{|1,2,1\\},\\{|2,1,1\\}$ 张成的子空间中使用一级简并微扰理论，微扰为 $V'=\\epsilon z^2$。矩阵元为\n$$W_{ij}=\\epsilon\\int\\psi_i^*(x,y,z)\\,z^2\\,\\psi_j(x,y,z)\\,dV$$\n由于在第一激发态简并子空间中，没有两个不同的态同时具有相同的 $n_x, n_y$（且微扰只与 $z$ 有关），因此非对角元 $W_{ij}$ ($i \\ne j$) 为零。因此，修正后的能量为\n$$E_{n_x,n_y,n_z}=E^{(0)}+\\epsilon\\int|\\psi_{n_z}(z)|^2z^2dz$$ \n定义\n$$I_n=\\int_0^Lz^2\\sin^2\\!\\bigl(\\tfrac{n\\pi z}{L}\\bigr)\\,dz\n=\\frac12\\int_0^Lz^2\\,dz-\\frac12\\int_0^Lz^2\\cos\\!\\bigl(\\tfrac{2n\\pi z}{L}\\bigr)\\,dz$$\n计算\n$$\\int_0^Lz^2dz=\\frac{L^3}{3}$$\n$$\\int_0^Lz^2\\cos(\\alpha z)dz\n=\\frac{2L}{\\alpha^2}, \\quad \\text{其中 } \\alpha=\\frac{2n\\pi}{L}$$\n因此\n$$I_n=\\frac{L^3}{6}-\\frac{L^3}{4n^2\\pi^2}\n=L^3\\Bigl(\\frac16-\\frac1{4n^2\\pi^2}\\Bigr)$$\n由于 $\\psi_{n_z}(z)^2=(2/L)\\sin^2(n_z\\pi z/L)$，\n$$W_{n_z}=\\epsilon\\frac{2}{L}I_{n_z}\n=\\epsilon L^2\\Bigl(\\frac13-\\frac1{2n_z^2\\pi^2}\\Bigr)$$\n在第一激发三重态中，两个态的 $n_z=1$，一个态的 $n_z=2$。因此分裂为\n$$\\Delta E=\\bigl|W_2-W_1\\bigr|\n=\\epsilon L^2\\Bigl|\\frac13-\\frac1{8\\pi^2}-\\Bigl(\\frac13-\\frac1{2\\pi^2}\\Bigr)\\Bigr|\n=\\frac{3\\epsilon L^2}{8\\pi^2}$$", "answer": "$$\\boxed{\\frac{3\\epsilon L^2}{8\\pi^2}}$$", "id": "357028"}, {"introduction": "量子系统的哈密顿量不仅会受到静态微扰，还可能随时间发生剧烈变化。骤然近似是处理此类动力学过程的重要理论工具，它使我们能够计算系统在哈密顿量发生瞬时改变后，从一个本征态跃迁到另一个本征态的概率。通过这个练习 [@problem_id:356867]，你将具体计算当一维无限深势阱宽度突然加倍时，粒子发生能级跃迁的概率，从而深入理解量子态的叠加原理和演化。", "problem": "一个质量为 $m$ 的粒子最初处于宽度为 $L$ 的一维无限深势阱的基态。该势阱由 $V(x) = 0$ ($0  x  L$) 和 $V(x) = \\infty$ (其他位置) 描述。此势阱的归一化能量本征态由 $\\psi_n(x) = \\sqrt{\\frac{2}{L}}\\sin\\left(\\frac{n\\pi x}{L}\\right)$ 给出，其中 $n=1, 2, 3, \\ldots$。\n\n在 $t=0$ 时刻，通过将势阱的右壁从 $x=L$ 移动到 $x=2L$，势阱瞬时发生改变。新的势阱为 $V'(x) = 0$ ($0  x  2L$) 和 $V'(x) = \\infty$ (其他位置)。这个新的、更宽的势阱的归一化能量本征态为 $\\phi_{n'}(x) = \\sqrt{\\frac{2}{2L}}\\sin\\left(\\frac{n'\\pi x}{2L}\\right)$，其中 $n' = 1, 2, 3, \\ldots$。\n\n根据突变近似，粒子在膨胀后瞬间的波函数与其膨胀前的状态相同。这个状态可以表示为更宽势阱的新能量本征态的叠加。推导在新势阱的第二激发态（$n'=3$）上发现该粒子的概率表达式。", "solution": "我们分别有在 $[0,L]$ 和 $[0,2L]$ 上的初始和最终本征态：\n$$\\psi_1(x)=\\sqrt{\\frac{2}{L}}\\sin\\!\\Bigl(\\frac{\\pi x}{L}\\Bigr),\\qquad\n\\phi_{n'}(x)=\\sqrt{\\frac{2}{2L}}\\sin\\!\\Bigl(\\frac{n'\\pi x}{2L}\\Bigr)=\\frac{1}{\\sqrt{L}}\\sin\\!\\Bigl(\\frac{n'\\pi x}{2L}\\Bigr)$$\n根据突变近似，展开系数为\n$$c_{n'}=\\int_0^{2L}\\phi_{n'}^*(x)\\,\\psi_1(x)\\,dx\n=\\frac{\\sqrt{2}}{L}\\int_0^L\\sin\\!\\Bigl(\\frac{n'\\pi x}{2L}\\Bigr)\\sin\\!\\Bigl(\\frac{\\pi x}{L}\\Bigr)\\,dx$$\n使用恒等式\n$$\\int_0^L\\sin(Ax)\\sin(Bx)\\,dx\n=\\frac{1}{2}\\Bigl[\\frac{\\sin((A-B)L)}{A-B}-\\frac{\\sin((A+B)L)}{A+B}\\Bigr]$$\n当 $A=\\frac{n'\\pi}{2L},\\;B=\\frac{\\pi}{L}$ 且 $n'=3$ 时，我们得到\n$$A-B=\\frac{\\pi}{2L},\\quad A+B=\\frac{5\\pi}{2L}$$\n$$\\sin\\bigl((A-B)L\\bigr)=\\sin\\!\\Bigl(\\frac{\\pi}{2}\\Bigr)=1,\\quad\n\\sin\\bigl((A+B)L\\bigr)=\\sin\\!\\Bigl(\\frac{5\\pi}{2}\\Bigr)=1$$\n因此\n$$\\int_0^L\\sin\\!\\Bigl(\\frac{3\\pi x}{2L}\\Bigr)\\sin\\!\\Bigl(\\frac{\\pi x}{L}\\Bigr)\\,dx\n=\\frac{1}{2}\\Bigl[\\frac{1}{\\frac{\\pi}{2L}}-\\frac{1}{\\frac{5\\pi}{2L}}\\Bigr]\n=\\frac{4L}{5\\pi}$$\n且\n$$c_3=\\frac{\\sqrt{2}}{L}\\,\\frac{4L}{5\\pi}=\\frac{4\\sqrt2}{5\\pi}$$\n在 $n'=3$ 态上发现该粒子的概率为\n$$P_{3}=|c_3|^2=\\frac{32}{25\\pi^2}$$", "answer": "$$\\boxed{\\frac{32}{25\\pi^2}}$$", "id": "356867"}, {"introduction": "尽管解析解在理论上十分优美，但解决大多数真实的量子问题都离不开强大的数值计算方法。本练习 [@problem_id:2960274] 旨在搭建从连续的薛定谔方程到离散的矩阵本征值问题之间的桥梁，指导你通过有限差分法对“箱中粒子”模型进行数值求解。你将亲手实现这一过程，并分析数值解的收敛性，这对于培养现代科学研究中必不可少的计算思维和编程技能至关重要。", "problem": "实现一个程序，通过离散化不含时 Schrödinger 方程来模拟区间 $[0,L]$ 上的一维无限深势阱（也称为盒中粒子模型）。离散化时，对二阶导数使用二阶中心有限差分近似，并在 $x=0$ 和 $x=L$ 处施加 Dirichlet 边界条件。从第一性原理出发，以不含时 Schrödinger 方程和无限深势阱的定义为起点。构建离散的哈密顿算符，计算其在一系列网格间距下的特征值，并将计算出的能级 $E_n$ 与从底层微分方程推导出的精确连续解进行比较。定量分析离散化误差作为网格间距的函数，并估计收敛率指数。\n\n需求：\n- 物理模型：\n  - 质量为 $m$ 的粒子在 $[0,L]$ 上无限深势阱中的不含时 Schrödinger 方程应作为基本出发点。边界条件为 $\\psi(0)=0$ 和 $\\psi(L)=0$。\n  - 用作参考的连续能级 $E_n$ 必须通过从第一性原理求解此边值问题获得，而不是在你的推理中调用任何未经推导的快捷公式。一旦你在推导中建立了该解析表达式，你的程序就可以使用它。\n- 离散化：\n  - 使用一个包含 $M$ 个内部点的均匀网格，网格间距为 $h=L/(M+1)$。\n  - 对内部点上的二阶导数应用标准的二阶中心有限差分近似，并通过从未知向量中省略边界节点来隐式地施加 Dirichlet 边界条件。\n  - 构建与内部节点上的动能算符相对应的离散哈密顿矩阵 $H$。\n- 数值计算：\n  - 对于每组指定的参数，计算第 $n$ 个离散能量 $E_n^{(h)}$，即离散哈密顿矩阵 $H$ 的第 $n$ 个（按升序排列的）特征值。\n  - 计算绝对误差 $|E_n^{(h)}-E_n|$，其中 $E_n$ 是对于相同的 $n$、$L$ 和 $m$ 的精确连续能量。\n  - 对于每个测试用例，通过改变 $M$ 来使网格间距 $h$ 遍历一个值列表，并通过对 $\\log |E_n^{(h)}-E_n|$ 与 $\\log h$ 进行最小二乘拟合，来估计经验关系 $|E_n^{(h)}-E_n|\\approx C\\,h^p$ 中的指数 $p$。报告拟合出的斜率 $p$。\n- 单位：\n  - 所有计算都必须在国际单位制（SI）中进行。$L$ 的单位为米，$m$ 的单位为千克，能量的单位为焦耳。\n  - 使用约化普朗克常数值 $\\hbar = 1.054571817\\times 10^{-34}\\ \\mathrm{J\\cdot s}$ 和电子质量 $m_e=9.1093837015\\times 10^{-31}\\ \\mathrm{kg}$。\n  - 当测试套件中 $L$ 以纳米为单位指定时，使用 $1\\ \\mathrm{nm}=1.0\\times 10^{-9}\\ \\mathrm{m}$ 进行转换。\n- 输出：\n  - 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，例如 $[r_1,r_2,r_3]$，其中每个 $r_i$ 是测试用例 $i$ 的拟合斜率 $p$，四舍五入到三位小数。\n\n测试套件：\n- 使用以下用例，每个用例指定为一个元组 $\\left(L_{\\mathrm{nm}}, n, [M_1,M_2,M_3,M_4]\\right)$，其中 $L_{\\mathrm{nm}}$ 以纳米为单位，在计算中必须转换为米：\n  - 用例 1：$\\left(1.0,\\,1,\\,[20,\\,40,\\,80,\\,160]\\right)$。\n  - 用例 2：$\\left(0.5,\\,5,\\,[50,\\,100,\\,200,\\,400]\\right)$。\n  - 用例 3：$\\left(2.0,\\,1,\\,[3,\\,6,\\,12,\\,24]\\right)$。\n- 对所有用例，使用 $m=m_e$。\n- 最终输出格式：\n  - 一行包含列表 $[r_1,r_2,r_3]$，其中包含三个拟合斜率，每个都四舍五入到三位小数，无额外文本。", "solution": "该问题陈述经评估确定为有效。它提出了一个计算量子力学中的标准、良置问题，该问题在科学上是合理的、自洽的且客观的。它没有矛盾或歧义。因此，我将进行完整的推导和求解。\n\n任务是数值求解一维无限深势阱中粒子的不含时 Schrödinger 方程，分析离散化误差，并确定数值方法的经验收敛阶。\n\n**1. 连续问题的解析解**\n\n第一性原理是质量为 $m$ 的粒子在势 $V(x)$ 中的不含时 Schrödinger 方程：\n$$\n\\hat{H}\\psi(x) = \\left[-\\frac{\\hbar^2}{2m}\\frac{d^2}{dx^2} + V(x)\\right]\\psi(x) = E\\psi(x)\n$$\n对于长度为 $L$ 的无限深势阱，在定义域 $[0, L]$ 上的势 $V(x)$ 定义为：\n$$\nV(x) = \\begin{cases} 0,  \\text{若 } 0  x  L \\\\ \\infty,  \\text{其他} \\end{cases}\n$$\n边界处的无限势意味着粒子不能存在于区间 $(0, L)$ 之外。因此，波函数 $\\psi(x)$ 的连续性施加了 Dirichlet 边界条件：\n$$\n\\psi(0) = 0 \\quad \\text{and} \\quad \\psi(L) = 0\n$$\n在势阱内部，$V(x)=0$，Schrödinger 方程简化为：\n$$\n-\\frac{\\hbar^2}{2m}\\frac{d^2\\psi(x)}{dx^2} = E\\psi(x)\n$$\n这个方程被重排成经典简谐振子方程的形式：\n$$\n\\frac{d^2\\psi(x)}{dx^2} + k^2\\psi(x) = 0, \\quad \\text{where } k = \\frac{\\sqrt{2mE}}{\\hbar}\n$$\n这个二阶常微分方程的通解是：\n$$\n\\psi(x) = A\\sin(kx) + B\\cos(kx)\n$$\n应用第一个边界条件 $\\psi(0) = 0$：\n$$\n\\psi(0) = A\\sin(0) + B\\cos(0) = B = 0\n$$\n因此，解的形式必须为 $\\psi(x) = A\\sin(kx)$。应用第二个边界条件 $\\psi(L) = 0$：\n$$\n\\psi(L) = A\\sin(kL) = 0\n$$\n非平凡解要求 $A \\neq 0$，这意味着 $\\sin(kL)$ 必须为零。当 $kL$ 是 $\\pi$ 的整数倍时，此条件得到满足：\n$$\nkL = n\\pi, \\quad \\text{for } n = 1, 2, 3, \\ldots\n$$\n量子数 $n$ 必须是正整数，因为 $n=0$ 会导致 $k=0$ 和平凡波函数 $\\psi(x)=0$。这将波数量子化为 $k_n = \\frac{n\\pi}{L}$。将其代入 k 的定义中：\n$$\n\\left(\\frac{n\\pi}{L}\\right)^2 = \\frac{2mE_n}{\\hbar^2}\n$$\n解出能量 $E_n$ 即可得到一维无限深势阱中粒子的精确、量子化的能级：\n$$\nE_n = \\frac{n^2\\pi^2\\hbar^2}{2mL^2}\n$$\n这个 $E_n$ 的解析表达式将作为精确参考，用于与数值结果进行比较。\n\n**2. Schrödinger 方程的离散化**\n\n为了数值求解该问题，我们将空间域 $[0, L]$ 离散化为一个均匀网格。我们定义 $M$ 个内部点，使得总点数为 $M+2$。网格间距为 $h = \\frac{L}{M+1}$，网格点为 $x_i = i \\cdot h$，其中 $i=0, 1, \\dots, M+1$。这些离散点上的波函数记为 $\\psi_i = \\psi(x_i)$。边界条件明确为 $\\psi_0=0$ 和 $\\psi_{M+1}=0$。\n\n在每个内部点 $x_i$ 上，使用二阶中心有限差分格式来近似二阶导数算符 $\\frac{d^2}{dx^2}$：\n$$\n\\left.\\frac{d^2\\psi}{dx^2}\\right|_{x=x_i} \\approx \\frac{\\psi(x_i+h) - 2\\psi(x_i) + \\psi(x_i-h)}{h^2} = \\frac{\\psi_{i+1} - 2\\psi_i + \\psi_{i-1}}{h^2}\n$$\n将此近似代入内部点 $i$（其中 $i=1, \\dots, M$）的 Schrödinger 方程中：\n$$\n-\\frac{\\hbar^2}{2m} \\left( \\frac{\\psi_{i-1} - 2\\psi_i + \\psi_{i+1}}{h^2} \\right) = E^{(h)}\\psi_i\n$$\n这里，$E^{(h)}$ 表示能量特征值的数值近似，它取决于网格间距 $h$。重排这个表达式，我们得到：\n$$\n-\\frac{\\hbar^2}{2mh^2}\\psi_{i-1} + \\frac{\\hbar^2}{mh^2}\\psi_i - \\frac{\\hbar^2}{2mh^2}\\psi_{i+1} = E^{(h)}\\psi_i\n$$\n这代表了一个关于未知值 $\\psi_1, \\dots, \\psi_M$ 的 $M$ 个耦合线性方程组。\n\n**3. 离散哈密顿矩阵**\n\n来自离散化的方程组可以写成矩阵特征值问题 $\\mathbf{H}\\vec{\\psi} = E^{(h)}\\vec{\\psi}$。向量 $\\vec{\\psi}$ 是 $(\\psi_1, \\psi_2, \\dots, \\psi_M)^T$，而 $\\mathbf{H}$ 是哈密顿算符的 $M \\times M$ 矩阵表示，称为离散哈密顿量。\n\n我们定义动能缩放因子 $T = \\frac{\\hbar^2}{2mh^2}$。每个节点 $i$ 的方程变为：\n$$\n-T\\psi_{i-1} + 2T\\psi_i - T\\psi_{i+1} = E^{(h)}\\psi_i\n$$\n使用边界条件 $\\psi_0 = 0$ 和 $\\psi_{M+1}=0$，对于 $i=1, \\dots, M$ 的方程组产生一个对称三对角矩阵 $\\mathbf{H}$：\n$$\n\\mathbf{H} = \\begin{pmatrix}\n2T  -T  0  \\cdots  0 \\\\\n-T  2T  -T  \\cdots  0 \\\\\n0  -T  2T  \\ddots  \\vdots \\\\\n\\vdots  \\vdots  \\ddots  \\ddots  -T \\\\\n0  0  \\cdots  -T  2T\n\\end{pmatrix}\n$$\n该矩阵 $\\mathbf{H}$ 的特征值对应于离散能级 $E_n^{(h)}$。第 $n$ 个特征值（按升序排列）是第 $n$ 个能级 $E_n$ 的数值近似。\n\n**4. 收敛性分析**\n\n中心差分格式的截断误差为 $O(h^2)$ 阶。对于像这样的自伴随特征值问题，预计特征值的误差会表现出相同的收敛阶。因此，我们期望数值能量与精确能量之间的绝对误差随网格间距 $h$ 的缩放关系如下：\n$$\n|E_n^{(h)} - E_n| \\approx C h^p\n$$\n其中 $p$ 是收敛率指数，我们期望它为 $2$。为了经验地找到 $p$，我们对误差方程取自然对数：\n$$\n\\ln\\left(|E_n^{(h)} - E_n|\\right) \\approx \\ln(C) + p \\ln(h)\n$$\n这揭示了 $\\ln(\\text{error})$ 和 $\\ln(h)$ 之间的线性关系。通过为一系列减小的网格间距 $h$（对应于增大的 $M$）计算误差，并对 $(\\ln(h), \\ln(\\text{error}))$ 数据进行线性最小二乘拟合，所得直线的斜率提供了对 $p$ 的估计。这个过程在提供的代码中实现，以满足问题要求。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 1D particle-in-a-box problem numerically and analyzes convergence.\n    \"\"\"\n    # Define physical constants in SI units\n    HBAR = 1.054571817e-34  # Reduced Planck constant in J*s\n    M_E = 9.1093837015e-31   # Electron mass in kg\n    NM_TO_M = 1.0e-9         # Nanometer to meter conversion factor\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (L_nm, n, [M_1, M_2, M_3, M_4])\n    test_cases = [\n        (1.0, 1, [20, 40, 80, 160]),\n        (0.5, 5, [50, 100, 200, 400]),\n        (2.0, 1, [3, 6, 12, 24]),\n    ]\n\n    results = []\n    \n    # Process each test case\n    for case in test_cases:\n        L_nm, n, M_list = case\n        \n        # Set parameters for the current case\n        L = L_nm * NM_TO_M  # Convert box length to meters\n        m = M_E             # Set mass to electron mass\n\n        # Calculate the exact analytical energy for level n\n        E_n_exact = (n**2 * np.pi**2 * HBAR**2) / (2 * m * L**2)\n\n        log_h_vals = []\n        log_error_vals = []\n\n        # Iterate over the specified numbers of interior grid points (M)\n        for M in M_list:\n            # Calculate grid spacing h\n            h = L / (M + 1)\n\n            # Construct the discrete Hamiltonian matrix H\n            # T is the kinetic energy scaling factor: hbar^2 / (2*m*h^2)\n            T = HBAR**2 / (2 * m * h**2)\n            \n            # The matrix H has 2T on the main diagonal and -T on the adjacent diagonals\n            main_diag = np.full(M, 2 * T)\n            off_diag = np.full(M - 1, -T)\n            H = np.diag(main_diag) + np.diag(off_diag, k=1) + np.diag(off_diag, k=-1)\n\n            # Compute eigenvalues of the symmetric matrix H.\n            # np.linalg.eigh is efficient and returns sorted eigenvalues.\n            eigenvalues = np.linalg.eigh(H)[0]\n            \n            # The numerical energy E_n is the n-th eigenvalue (0-indexed)\n            E_n_h = eigenvalues[n - 1]\n\n            # Calculate the absolute error and store its logarithm\n            error = np.abs(E_n_h - E_n_exact)\n            log_error_vals.append(np.log(error))\n            \n            # Store the logarithm of the grid spacing\n            log_h_vals.append(np.log(h))\n\n        # Perform a linear least-squares fit on the log-log data.\n        # log(error) = p * log(h) + log(C)\n        # np.polyfit with degree 1 returns the slope (p) and intercept (log(C)).\n        p, _ = np.polyfit(log_h_vals, log_error_vals, 1)\n        results.append(p)\n\n    # Format the results to three decimal places as required.\n    rounded_results = [round(r, 3) for r in results]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, rounded_results))}]\")\n\nsolve()\n```", "id": "2960274"}]}