{"hands_on_practices": [{"introduction": "真实的生物系统通常比基础的米氏模型更复杂，例如产物会反馈抑制酶的活性。从基本动力学机制出发，通过数学推导得出相应的速率方程，是深入理解酶催化行为的一项关键技能。这个练习将引导你应用稳态近似法，处理一个包含竞争性产物抑制的系统 ([@problem_id:1993723])，从而掌握分析更复杂酶动力学模型的核心方法。", "problem": "一种酶 `E` 在工业生物反应器中用于将底物 `S` 转化为有价值的产物 `P`。实验数据表明，随着产物 `P` 的累积，反应速率的下降幅度超过了仅由底物消耗所预期的程度。据推测，这是由于竞争性产物抑制所致，即产物 `P` 可逆地结合到酶的活性位点。\n\n提出的动力学机理如下：\n1.  酶-底物结合：$E + S \\rightleftharpoons ES$（正向速率常数为 $k_1$，逆向速率常数为 $k_{-1}$）\n2.  催化步骤：$ES \\rightarrow E + P$（催化速率常数为 $k_{cat}$）\n3.  产物抑制：$E + P \\rightleftharpoons EP$（快速平衡）\n\n对于此系统，我们定义以下常数：\n- 米氏常数，$K_M = \\frac{k_{-1} + k_{cat}}{k_1}$。\n- 产物抑制解离常数，$K_P = \\frac{[E][P]}{[EP]}$。\n- 总酶浓度，$[E]_T$。\n- 最大速率，$V_{max} = k_{cat}[E]_T$。\n\n假设酶-底物复合物 `[ES]` 的浓度达到稳态，推导初始反应速率 $v_0$ 的闭式解析表达式。该表达式应以 $V_{max}$、$K_M$、$K_P$、初始底物浓度 $[S]$ 和初始产物浓度 $[P]$ 来表示。", "solution": "我们使用给定的动力学机理，其中产物与游离酶发生竞争性结合，并对酶-底物复合物应用稳态近似，同时对产物结合使用快速平衡。\n\n首先，写出 $[ES]$ 的稳态条件：\n$$\n\\frac{d[ES]}{dt}=k_{1}[E][S]-(k_{-1}+k_{cat})[ES]=0 \\quad \\Rightarrow \\quad [ES]=\\frac{k_{1}}{k_{-1}+k_{cat}}[E][S]=\\frac{[E][S]}{K_{M}}.\n$$\n\n接下来，对产物与游离酶的结合使用快速平衡：\n$$\nK_{P}=\\frac{[E][P]}{[EP]} \\quad \\Rightarrow \\quad [EP]=\\frac{[E][P]}{K_{P}}.\n$$\n\n应用酶总量守恒：\n$$\n[E]_{T}=[E]+[ES]+[EP]=[E]+[ES]+\\frac{[E][P]}{K_{P}}=[E]\\left(1+\\frac{[P]}{K_{P}}\\right)+[ES].\n$$\n由此求解 $[E]$：\n$$\n[E]=\\frac{[E]_{T}-[ES]}{1+\\frac{[P]}{K_{P}}}.\n$$\n\n将此 $[E]$ 的表达式代入 $[ES]=\\frac{[E][S]}{K_{M}}$：\n$$\n[ES]=\\frac{[S]}{K_{M}}\\cdot \\frac{[E]_{T}-[ES]}{1+\\frac{[P]}{K_{P}}}.\n$$\n重新整理以显式求解 $[ES]$：\n$$\n[ES]\\left(1+\\frac{[P]}{K_{P}}\\right)=\\frac{[S]}{K_{M}}\\left([E]_{T}-[ES]\\right),\n$$\n$$\n[ES]\\left(1+\\frac{[P]}{K_{P}}+\\frac{[S]}{K_{M}}\\right)=\\frac{[E]_{T}[S]}{K_{M}},\n$$\n$$\n[ES]=\\frac{[E]_{T}\\,\\frac{[S]}{K_{M}}}{1+\\frac{[P]}{K_{P}}+\\frac{[S]}{K_{M}}}.\n$$\n\n初始速率为 $v_{0}=k_{cat}[ES]$。使用 $V_{max}=k_{cat}[E]_{T}$，\n$$\nv_{0}=k_{cat}[ES]=V_{max}\\,\\frac{\\frac{[S]}{K_{M}}}{1+\\frac{[P]}{K_{P}}+\\frac{[S]}{K_{M}}}.\n$$\n等价地，将分子和分母同乘以 $K_{M}$，得到标准的竞争性抑制形式：\n$$\nv_{0}=\\frac{V_{max}[S]}{K_{M}\\left(1+\\frac{[P]}{K_{P}}\\right)+[S]}.\n$$\n这就是所求的以 $V_{max}$、$K_M$、$K_P$、$[S]$ 和 $[P]$ 表示的闭式表达式。", "answer": "$$\\boxed{\\frac{V_{max}[S]}{K_{M}\\left(1+\\frac{[P]}{K_{P}}\\right)+[S]}}$$", "id": "1993723"}, {"introduction": "动力学参数如 $K_M$ 并非绝对的“常数”，它们的数值与温度等物理条件密切相关，其根源在于热力学。这个思想实验将酶的宏观动力学行为与底物和抑制剂结合过程的焓变联系起来，这对于理解酶在不同环境下的功能至关重要 ([@problem_id:1993720])。通过分析，你将学会如何基于范特霍夫方程，定性预测温度变化对包含竞争性抑制剂的酶促反应表观米氏常数 $K_{M,app}$ 的影响。", "problem": "正在开发一种酶生物传感器用于检测特定底物S。该传感器利用一种酶E，该酶遵循米氏动力学（Michaelis-Menten kinetics）。该酶对底物的米氏常数表示为 $K_M$。\n\n传感器工作的样品基质中含有一种背景物质I，它作为该酶的一种竞争性抑制剂。在传感器的工作寿命内，这种抑制剂的浓度 $[I]$ 可被视为恒定的。I的抑制常数表示为 $K_I$。在这些条件下，该酶表现出表观米氏常数 $K_{M,app}$，由关系式 $K_{M,app} = K_M \\left(1 + \\frac{[I]}{K_I}\\right)$ 给出。\n\n已经对结合过程进行了热力学研究。底物S与酶E的结合 ($E+S \\rightleftharpoons ES$) 是一个轻微的吸热过程，其标准摩尔焓变为 $\\Delta H_{bind,S}^\\circ > 0$。相比之下，抑制剂I与酶E的结合 ($E+I \\rightleftharpoons EI$) 是一个强烈的放热过程，其标准摩尔焓变为 $\\Delta H_{bind,I}^\\circ < 0$。假设在传感器的小工作范围内，这些焓变不随温度变化。解离常数 $K_M$ 和 $K_I$ 与它们各自解离过程的标准吉布斯自由能相关。\n\n该生物传感器在温度 $T_0$ 下进行初始校准。如果传感器的工作温度略有增加，表观米氏常数 $K_{M,app}$ 的值将如何变化？\n\nA. $K_{M,app}$ 会增加。\n\nB. $K_{M,app}$ 会减小。\n\nC. $K_{M,app}$ 会保持不变。\n\nD. $K_{M,app}$ 的变化取决于抑制剂的初始浓度 $[I]$。\n\nE. 在不知道结合过程的熵变的情况下，无法确定 $K_{M,app}$ 的变化。", "solution": "在竞争性抑制下，表观米氏常数为 $K_{M,\\mathrm{app}}(T)=K_{M}(T)\\left(1+\\frac{[I]}{K_{I}(T)}\\right)$，其中 $[I]$ 是恒定的。\n\n为了确定 $K_{M,\\mathrm{app}}$ 如何随温度变化，我们使用范特霍夫关系式（van 't Hoff relation）来描述缔合（结合）平衡 $E+L \\rightleftharpoons EL$，其标准结合焓为 $\\Delta H_{\\mathrm{bind},L}^{\\circ}$：\n$$\n\\frac{\\mathrm{d}\\ln K_{a,L}}{\\mathrm{d}T}=\\frac{\\Delta H_{\\mathrm{bind},L}^{\\circ}}{R T^{2}},\n$$\n其中 $K_{a,L}$ 是缔合平衡常数。解离常数为 $K_{d,L}=1/K_{a,L}$，因此\n$$\n\\frac{\\mathrm{d}\\ln K_{d,L}}{\\mathrm{d}T}=-\\frac{\\Delta H_{\\mathrm{bind},L}^{\\circ}}{R T^{2}}.\n$$\n\n将 $K_{M}$ 等同于底物解离常数，将 $K_{I}$ 等同于抑制剂解离常数（如题所述），我们得到：\n- 对于底物结合，$\\Delta H_{\\mathrm{bind},S}^{\\circ}>0$（吸热），因此\n$$\n\\frac{\\mathrm{d}\\ln K_{M}}{\\mathrm{d}T}=-\\frac{\\Delta H_{\\mathrm{bind},S}^{\\circ}}{R T^{2}} < 0 \\quad \\Rightarrow \\quad \\frac{\\mathrm{d}K_{M}}{\\mathrm{d}T} < 0.\n$$\n- 对于抑制剂结合，$\\Delta H_{\\mathrm{bind},I}^{\\circ}<0$（放热），因此\n$$\n\\frac{\\mathrm{d}\\ln K_{I}}{\\mathrm{d}T}=-\\frac{\\Delta H_{\\mathrm{bind},I}^{\\circ}}{R T^{2}}>0 \\quad \\Rightarrow \\quad \\frac{\\mathrm{d}K_{I}}{\\mathrm{d}T}>0.\n$$\n\n对 $K_{M,\\mathrm{app}}(T)$ 求导：\n$$\n\\frac{\\mathrm{d}K_{M,\\mathrm{app}}}{\\mathrm{d}T}\n=\\left(\\frac{\\mathrm{d}K_{M}}{\\mathrm{d}T}\\right)\\left(1+\\frac{[I]}{K_{I}}\\right)\n+K_{M}\\left(-\\frac{[I]}{K_{I}^{2}}\\right)\\left(\\frac{\\mathrm{d}K_{I}}{\\mathrm{d}T}\\right).\n$$\n由于 $1+\\frac{[I]}{K_{I}}>0$，$\\frac{\\mathrm{d}K_{M}}{\\mathrm{d}T}<0$，以及 $\\frac{\\mathrm{d}K_{I}}{\\mathrm{d}T}>0$，等式右边的两项均为负值。因此，\n$$\n\\frac{\\mathrm{d}K_{M,\\mathrm{app}}}{\\mathrm{d}T} < 0,\n$$\n所以温度的轻微增加会使 $K_{M,\\mathrm{app}}$ 减小。这个结论不依赖于 $[I]$ 的具体值（只要其为非负值），也不需要知道熵变，因为温度趋势是由给定的焓变符号通过范特霍夫关系式决定的。\n\n因此，正确的选项是 $K_{M,app}$ 会减小。", "answer": "$$\\boxed{B}$$", "id": "1993720"}, {"introduction": "从实验数据中准确提取动力学参数（如 $V_{max}$ 和 $K_m$）是酶学研究的基石。这项计算练习将经典的 Lineweaver-Burk 线性化方法与统计上更为稳健的非线性回归方法进行对比，揭示不同分析方法可能导致结果差异的原因 ([@problem_id:2938278])。通过亲手实践，你将获得数据分析的经验，并学会批判性地评估不同拟合方法得出的动力学参数。", "problem": "您将获得在初始速率条件下，遵循结合与催化机制 $E + S \\rightleftharpoons ES \\rightarrow E + P$ 的单底物酶的初始速率测量值。从质量作用定律和准稳态假设出发，推导初始速度 $v$ 作为底物浓度 $[S]$ 和表征该酶促反应的两个参数的函数表达式。然后，实现并使用两种独立的估算程序，从给定的数据集中推断这两个参数：(i) 对推导出的速率定律进行直接非线性最小二乘回归，以及 (ii) 基于 Lineweaver–Burk (LB) 变换的线性回归。最后，对每个数据集，比较两种程序得到的估算值。\n\n推导的基本出发点：\n- 反应机理为 $E + S \\xrightleftharpoons[k_{-1}]{k_1} ES \\xrightarrow{k_2} E + P$，速率常数分别为 $k_1$、$k_{-1}$ 和 $k_2$。\n- 在初始速率条件下，产物积累可忽略不计，总酶浓度 $[E]_T$ 保持守恒。\n- 对复合物 $ES$ 的准稳态条件在反应早期成立。\n- 可观测的初始速率为 $v = \\dfrac{d[P]}{dt}$（在 $t \\to 0^+$ 时）。\n- 假设 $[S]_0 \\gg [E]_T$，因此在初始速率测量期间底物消耗可忽略不计。\n\n你的程序必须：\n1. 从上述基本出发点推导初始速率定律，并将其用作非线性回归模型来估算两个动力学参数。将最大速度记为 $V_{\\max}$（单位为 $\\mu \\mathrm{M}\\,\\mathrm{s}^{-1}$），米氏常数记为 $K_m$（单位为 $\\mu \\mathrm{M}$）。使用具有物理意义约束条件（$V_{\\max} > 0$，$K_m > 0$）的无权非线性最小二乘法。\n2. 独立地，应用 Lineweaver–Burk (LB) 变换，该变换将模型改写为参数线性的形式，并通过对变换后的变量进行普通最小二乘法来估算相同的参数。\n3. 对每个数据集，报告两组参数估算值。将 $V_{\\max}$ 以 $\\mu \\mathrm{M}\\,\\mathrm{s}^{-1}$ 为单位表示，$K_m$ 以 $\\mu \\mathrm{M}$ 为单位表示。将每个报告的数字四舍五入到四位有效数字。\n\n测试套件（所有 $[S]$ 值单位均为 $\\mu \\mathrm{M}$，所有 $v$ 值单位均为 $\\mu \\mathrm{M}\\,\\mathrm{s}^{-1}$）：\n- 数据集 A（$[S]$ 范围均衡）：$[S] = [2, 5, 10, 20, 40, 80, 160]$，$v = [0.162, 0.349, 0.641, 0.991, 1.441, 1.792, 2.118]$。\n- 数据集 B（密集于低 $[S]$ 区域）：$[S] = [0.5, 1, 2, 3, 4, 5, 8]$，$v = [0.106, 0.208, 0.335, 0.461, 0.522, 0.612, 0.727]$。\n- 数据集 C（密集于高 $[S]$ 区域）：$[S] = [10, 20, 50, 100, 200, 400, 800]$，$v = [0.040, 0.071, 0.165, 0.258, 0.409, 0.523, 0.648]$。\n- 数据集 D（包含一个轻微的高 $[S]$ 离群值）：$[S] = [5, 15, 30, 60, 120, 240]$，$v = [0.191, 0.492, 0.869, 1.329, 1.960, 2.270]$。\n\n算法要求和数值条件：\n- 对于非线性回归，使用一种不假设参数先验知识的稳健初始化策略，并强制执行 $V_{\\max} > 0$ 和 $K_m > 0$。\n- 对于 LB 方法，构建 $x = 1/[S]$ 和 $y = 1/v$，并对 $y = a x + b$ 执行普通最小二乘法。将拟合的斜率 $a$ 和截距 $b$ 转换为 $V_{\\max}$ 和 $K_m$。确保不会发生除零错误。\n- 对每个数据集，输出有序列表 $[V_{\\max}^{\\mathrm{NL}}, K_m^{\\mathrm{NL}}, V_{\\max}^{\\mathrm{LB}}, K_m^{\\mathrm{LB}}]$，其中上标表示估算方法（非线性与 Lineweaver–Burk）。所有值必须是四舍五入到四位有效数字的浮点数，单位如上所述。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含所有数据集的结果，格式为用方括号括起来的逗号分隔的列表的列表，例如 $[[x_{A1},x_{A2},x_{A3},x_{A4}],[x_{B1},x_{B2},x_{B3},x_{B4}],\\ldots]$，不含空格。", "solution": "该问题经过严格验证，被认为是有效的。这是一个在化学动力学领域有科学依据、适定且客观的问题。该任务要求从基本原理推导 Michaelis-Menten 方程，并使用两种标准回归技术——直接非线性最小二乘拟合和对 Lineweaver-Burk 变换数据进行线性回归——将其应用于实验数据分析。这是一个评估理论理解和实际数据分析技能的经典练习。\n\n解决方案分两部分进行：首先，正式推导速率定律；其次，描述用于从所提供的数据集估算动力学参数的计算方法。\n\n**1. Michaelis-Menten 速率定律的推导**\n\n该酶促反应由以下机理描述：\n$$\nE + S \\xrightleftharpoons[k_{-1}]{k_1} ES \\xrightarrow{k_2} E + P\n$$\n其中 $E$ 是酶，$S$ 是底物，$ES$ 是酶-底物复合物，$P$ 是产物。结合、解离和催化步骤的速率常数分别为 $k_1$、$k_{-1}$ 和 $k_2$。\n\n所涉及化学物质浓度的变化率由质量作用定律描述。对于酶-底物复合物 $[ES]$，其速率方程为：\n$$\n\\frac{d[ES]}{dt} = k_1 [E][S] - k_{-1}[ES] - k_2[ES] = k_1 [E][S] - (k_{-1} + k_2)[ES]\n$$\n\n总酶浓度 $[E]_T$ 在整个反应过程中是守恒的：\n$$\n[E]_T = [E] + [ES]\n$$\n这使得游离酶的浓度 $[E]$ 可以表示为 $[E] = [E]_T - [ES]$。\n\n应用准稳态假设 (QSSA)，该假设假定中间体 $[ES]$ 复合物的浓度迅速达到一个稳态，此时其生成速率与其分解速率相平衡。在数学上，这表示为：\n$$\n\\frac{d[ES]}{dt} \\approx 0\n$$\n将 QSSA 应用于 $[ES]$ 的速率方程，得到：\n$$\nk_1 [E][S] - (k_{-1} + k_2)[ES] = 0\n$$\n将 $[E] = [E]_T - [ES]$ 代入此方程：\n$$\nk_1 ([E]_T - [ES])[S] - (k_{-1} + k_2)[ES] = 0\n$$\n我们现在求解复合物的稳态浓度 $[ES]$：\n$$\nk_1 [E]_T [S] - k_1 [ES][S] - (k_{-1} + k_2)[ES] = 0\n$$\n$$\nk_1 [E]_T [S] = [ES] (k_1[S] + k_{-1} + k_2)\n$$\n$$\n[ES] = \\frac{k_1 [E]_T [S]}{k_1[S] + k_{-1} + k_2}\n$$\n将分子和分母同时除以 $k_1$，我们得到：\n$$\n[ES] = \\frac{[E]_T [S]}{[S] + \\frac{k_{-1} + k_2}{k_1}}\n$$\n\n反应的初始速度 $v$ 定义为产物的生成速率，它与 $ES$ 复合物的浓度成正比：\n$$\nv = \\frac{d[P]}{dt} = k_2 [ES]\n$$\n将 $[ES]$ 的表达式代入速度方程，得到：\n$$\nv = k_2 \\frac{[E]_T [S]}{[S] + \\frac{k_{-1} + k_2}{k_1}}\n$$\n这个表达式是在 QSSA 下的完整速率定律。为了将其简化为人们所熟知的 Michaelis-Menten 形式，我们定义两个关键参数：\n1.  最大速度 $V_{\\max}$，即当酶被底物完全饱和（$[S] \\to \\infty$）时反应的理论最大速率。在此极限下，$[ES] \\approx [E]_T$，速度变为 $v = k_2 [E]_T$。因此，我们定义：\n    $$\n    V_{\\max} = k_2 [E]_T\n    $$\n2.  米氏常数 $K_m$，它是一个复合常数，代表反应速度为 $V_{\\max}$ 一半时的底物浓度。我们将其定义为：\n    $$\n    K_m = \\frac{k_{-1} + k_2}{k_1}\n    $$\n\n将这两个参数 $V_{\\max}$ 和 $K_m$ 代入速率定律，得到 Michaelis-Menten 方程：\n$$\nv = \\frac{V_{\\max}[S]}{K_m + [S]}\n$$\n该方程将用作非线性回归分析的模型。\n\n**2. 参数估算程序**\n\n我们实现了两种独立的方法来从提供的数据集中估算 $V_{\\max}$ 和 $K_m$。\n\n**2.1. 直接非线性最小二乘 (NLS) 回归**\n\n此方法将 Michaelis-Menten 方程直接拟合到实验数据对 $([S]_i, v_i)$。目标是找到使残差平方和 (SSR) 最小化的参数值 $V_{\\max}$ 和 $K_m$：\n$$\n\\mathrm{SSR}(V_{\\max}, K_m) = \\sum_{i=1}^{n} \\left( v_i - \\frac{V_{\\max}[S]_i}{K_m + [S]_i} \\right)^2\n$$\n这是一个非线性优化问题。实现中利用了 `scipy.optimize.curve_fit` 函数。为确保稳健性和物理意义，应用了以下条件：\n-   生成参数的稳健初始猜测值：$V_{\\max, 0} = \\max(v_{\\text{data}})$ 和 $K_{m, 0} = \\mathrm{median}([S]_{\\text{data}})$。\n-   使用函数的 `bounds` 参数强制执行参数约束 $V_{\\max} > 0$ 和 $K_m > 0$。\n\n**2.2. Lineweaver-Burk (LB) 线性回归**\n\n此方法涉及将 Michaelis-Menten 方程变换为线性形式。通过对该方程两边取倒数：\n$$\n\\frac{1}{v} = \\frac{K_m + [S]}{V_{\\max}[S]} = \\frac{K_m}{V_{\\max}[S]} + \\frac{[S]}{V_{\\max}[S]}\n$$\n这可简化为一条直线方程，$y = ax + b$：\n$$\n\\frac{1}{v} = \\left(\\frac{K_m}{V_{\\max}}\\right) \\frac{1}{[S]} + \\frac{1}{V_{\\max}}\n$$\n其中 $y = 1/v$，$x = 1/[S]$，斜率为 $a = K_m / V_{\\max}$，y-截距为 $b = 1 / V_{\\max}$。\n\n实验数据被变换为 $(x_i, y_i) = (1/[S]_i, 1/v_i)$。对这些变换后的数据执行普通最小二乘线性回归，以找到最佳拟合斜率 $a$ 和截距 $b$。然后根据这些拟合值计算动力学参数：\n$$\nV_{\\max} = \\frac{1}{b}\n$$\n$$\nK_m = a \\cdot V_{\\max} = \\frac{a}{b}\n$$\n这种方法计算简单，但可能对低底物浓度下的测量误差敏感，因为这些点在线性拟合中具有高杠杆作用。\n\n以下程序为所有提供的数据集实现了这两种程序，并按要求格式化结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import curve_fit\nimport math\n\ndef solve():\n    \"\"\"\n    Derives Michaelis-Menten parameters using NLS and Lineweaver-Burk methods.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Dataset A\n        {'S': np.array([2, 5, 10, 20, 40, 80, 160], dtype=float), \n         'v': np.array([0.162, 0.349, 0.641, 0.991, 1.441, 1.792, 2.118], dtype=float)},\n        # Dataset B\n        {'S': np.array([0.5, 1, 2, 3, 4, 5, 8], dtype=float), \n         'v': np.array([0.106, 0.208, 0.335, 0.461, 0.522, 0.612, 0.727], dtype=float)},\n        # Dataset C\n        {'S': np.array([10, 20, 50, 100, 200, 400, 800], dtype=float), \n         'v': np.array([0.040, 0.071, 0.165, 0.258, 0.409, 0.523, 0.648], dtype=float)},\n        # Dataset D\n        {'S': np.array([5, 15, 30, 60, 120, 240], dtype=float), \n         'v': np.array([0.191, 0.492, 0.869, 1.329, 1.960, 2.270], dtype=float)},\n    ]\n\n    all_results = []\n\n    def michaelis_menten(S, Vmax, Km):\n        \"\"\"Michaelis-Menten model function.\"\"\"\n        return (Vmax * S) / (Km + S)\n\n    def round_to_sf(x, sf):\n        \"\"\"Rounds a number to a specified number of significant figures.\"\"\"\n        if x == 0:\n            return 0.0\n        sign = -1 if x  0 else 1\n        x = abs(x)\n        if x == 0:\n            return 0.0\n        \n        # Calculate rounding position\n        pos = sf - 1 - int(math.floor(math.log10(x)))\n        return sign * round(x, pos)\n\n    for case in test_cases:\n        S_data = case['S']\n        v_data = case['v']\n\n        # (i) Nonlinear Least-Squares Regression (NLS)\n        Vmax_nl, Km_nl = np.nan, np.nan\n        try:\n            # Robust initial guess for parameters: Vmax ~ max(v), Km ~ S at Vmax/2\n            p0 = [np.max(v_data), np.median(S_data)]\n            # Enforce physically meaningful constraints (Vmax  0, Km  0)\n            bounds = ([0, 0], [np.inf, np.inf])\n            popt_nl, _ = curve_fit(michaelis_menten, S_data, v_data, p0=p0, bounds=bounds)\n            Vmax_nl, Km_nl = popt_nl\n        except RuntimeError:\n            # This case occurs if the optimization fails to converge.\n            pass\n\n        # (ii) Lineweaver-Burk (LB) Linear Regression\n        Vmax_lb, Km_lb = np.nan, np.nan\n        try:\n            # Transform data: x = 1/[S], y = 1/v\n            # The problem statement guarantees S  0 and v  0.\n            x_lb = 1.0 / S_data\n            y_lb = 1.0 / v_data\n            \n            # Perform linear regression: y = a*x + b\n            # slope (a) = Km/Vmax, intercept (b) = 1/Vmax\n            slope, intercept = np.polyfit(x_lb, y_lb, 1)\n\n            # Check for physically meaningful results (positive slope and intercept)\n            if intercept  0 and slope  0:\n                Vmax_lb = 1.0 / intercept\n                Km_lb = slope / intercept\n        except (np.linalg.LinAlgError, ZeroDivisionError):\n            # This case occurs if linear algebra fails or if intercept is zero.\n            pass\n        \n        # Round all results to four significant figures\n        sf = 4\n        result = [\n            round_to_sf(Vmax_nl, sf),\n            round_to_sf(Km_nl, sf),\n            round_to_sf(Vmax_lb, sf),\n            round_to_sf(Km_lb, sf)\n        ]\n        all_results.append(result)\n\n    # Format the output string to be a list of lists with no spaces\n    # Example: [[v_a,k_a,v_a,k_a],[v_b,k_b,v_b,k_b]]\n    result_strings = [f\"[{r[0]},{r[1]},{r[2]},{r[3]}]\" for r in all_results]\n    final_output = f\"[{','.join(result_strings)}]\"\n    \n    print(final_output)\n\nsolve()\n```", "id": "2938278"}]}