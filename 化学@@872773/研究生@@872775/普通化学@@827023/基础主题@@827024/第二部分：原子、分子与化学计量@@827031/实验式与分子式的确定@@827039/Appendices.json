{"hands_on_practices": [{"introduction": "在元素分析中，并非所有元素都易于直接测量。例如，氧元素的含量常常通过“差减法”得到，即假设样品总质量为$100\\%$，减去所有其他直接测得元素的质量分数。这项实践 [@problem_id:2937650] 将引导您首先使用差减法数据来推导经验式，然后通过一个假设情景，定量分析该方法中存在的系统误差如何影响最终的原子比计算，从而培养对实验数据处理方法的批判性思维。", "problem": "对一种仅含碳、氢、氧的纯有机化合物进行元素分析。实验室直接测量了碳和氢的质量分数，并通过“差减法”报告了氧的质量分数。根据质量守恒定律，操作上将其定义为使样品总质量达到 $100\\,\\%$ 所需的剩余部分。报告结果如下：碳 $59.983\\,\\%$，氢 $4.475\\,\\%$，氧（差减法）$35.542\\,\\%$。使用以下标准原子量：$M_{\\mathrm{C}} = 12.011\\,\\mathrm{g\\,mol^{-1}}$，$M_{\\mathrm{H}} = 1.008\\,\\mathrm{g\\,mol^{-1}}$，$M_{\\mathrm{O}} = 15.999\\,\\mathrm{g\\,mol^{-1}}$。\n\n仅使用质量守恒定律以及质量分数、摩尔和实验式的定义：\n- 通过将质量分数转换为物质的量（摩尔），并约化为最简整数比，计算并论证报告数据所隐含的实验式。\n- 然后，假设对于此类化合物，通过差减法得到的氧值被系统性地高估了 $1.000$ 个质量百分点，而直接测量的碳和氢的值是无偏的。保持报告的碳质量分数不变，量化由报告的氧百分比计算出的氧碳原子比与由校正后的氧百分比计算出的氧碳原子比之间的相对偏差（以小数形式表示）。具体来说，计算\n$$\\left(\\frac{n_{\\mathrm{O}}}{n_{\\mathrm{C}}}\\right)_{\\text{reported}} \\Big/ \\left(\\frac{n_{\\mathrm{O}}}{n_{\\mathrm{C}}}\\right)_{\\text{corrected}} - 1,$$ \n并将最终数值结果表示为四舍五入到四位有效数字的小数。最终结果无需单位。", "solution": "首先对问题陈述进行验证。\n\n步骤1：提取已知条件。\n问题为一种仅含碳(C)、氢(H)和氧(O)的纯有机化合物提供了以下数据和定义：\n- 报告的碳质量分数：$w_{\\mathrm{C, rep}} = 59.983\\,\\% = 0.59983$\n- 报告的氢质量分数：$w_{\\mathrm{H, rep}} = 4.475\\,\\% = 0.04475$\n- 报告的氧质量分数：$w_{\\mathrm{O, rep}} = 35.542\\,\\% = 0.35542$\n- 氧的质量分数是通过“差减法”确定的，因此报告的质量分数之和为 $100\\,\\%$。确实，$59.983 + 4.475 + 35.542 = 100.000$。\n- 碳的标准原子量：$M_{\\mathrm{C}} = 12.011\\,\\mathrm{g\\,mol^{-1}}$\n- 氢的标准原子量：$M_{\\mathrm{H}} = 1.008\\,\\mathrm{g\\,mol^{-1}}$\n- 氧的标准原子量：$M_{\\mathrm{O}} = 15.999\\,\\mathrm{g\\,mol^{-1}}$\n\n该问题分为两个任务：\n1.  根据报告的数据确定实验式。\n2.  计算氧碳原子比的相对偏差，定义为 $\\left(\\frac{n_{\\mathrm{O}}}{n_{\\mathrm{C}}}\\right)_{\\text{reported}} \\Big/ \\left(\\frac{n_{\\mathrm{O}}}{n_{\\mathrm{C}}}\\right)_{\\text{corrected}} - 1$。\n对于第二个任务，一个假设的“校正”状态由以下规则定义：\n- 氧的质量分数通过从报告值中减去 $1.000$ 个百分点进行校正：$w_{\\mathrm{O, corrected}} = w_{\\mathrm{O, reported}} - 0.01000$。\n- 碳的质量分数保持不变：$w_{\\mathrm{C, corrected}} = w_{\\mathrm{C, reported}}$。\n\n步骤2：使用提取的已知条件进行验证。\n该问题科学上基于化学计量学和元素分析的原理。第一个任务是普通化学中的一个标准练习。第二个任务为了计算的目的引入了一个假设情景。如果同时假设氢的质量分数固定且所有质量分数之和必须为 $1$，那么定义“校正”状态的规则（$w_{\\mathrm{O, corrected}} = w_{\\mathrm{O, rep}} - 0.01$ 和 $w_{\\mathrm{C, corrected}} = w_{\\mathrm{C, rep}}$）在物理上是不一致的，因为这将违反质量守恒定律。然而，问题并未声称这个“校正”状态代表物理现实。它提出了一个定义明确的计算，旨在比较报告数据的结果与假设数据集的结果。指示清晰、无歧义，并包含了所有必要的信息。该问题并非不适定问题；它是一个在特定（尽管是人为设定的）条件下计算误差传播的正式练习。\n\n步骤3：结论与行动。\n问题被认为是有效的。将提供完整的解答。\n\n第1部分：确定实验式。\n为了找到实验式，我们将元素的质量分数转换为摩尔比。不失一般性地，我们可以假设样品质量为 $100\\,\\mathrm{g}$。那么各元素的质量在数值上就等于其百分比。\n- 碳的质量，$m_{\\mathrm{C}} = 59.983\\,\\mathrm{g}$\n- 氢的质量，$m_{\\mathrm{H}} = 4.475\\,\\mathrm{g}$\n- 氧的质量，$m_{\\mathrm{O}} = 35.542\\,\\mathrm{g}$\n\n接下来，我们使用公式 $n = \\frac{m}{M}$ 计算每种元素的物质的量（$n$），其中 $M$ 是摩尔质量（以原子量形式给出）。\n- 碳的摩尔数：$n_{\\mathrm{C}} = \\frac{59.983\\,\\mathrm{g}}{12.011\\,\\mathrm{g\\,mol^{-1}}} \\approx 4.9940\\,\\mathrm{mol}$\n- 氢的摩尔数：$n_{\\mathrm{H}} = \\frac{4.475\\,\\mathrm{g}}{1.008\\,\\mathrm{g\\,mol^{-1}}} \\approx 4.4395\\,\\mathrm{mol}$\n- 氧的摩尔数：$n_{\\mathrm{O}} = \\frac{35.542\\,\\mathrm{g}}{15.999\\,\\mathrm{g\\,mol^{-1}}} \\approx 2.2215\\,\\mathrm{mol}$\n\n为了找到最简整数比，我们将各摩尔数除以最小值，即 $n_{\\mathrm{O}}$。\n- C 的比值：$\\frac{n_{\\mathrm{C}}}{n_{\\mathrm{O}}} = \\frac{4.9940}{2.2215} \\approx 2.248$\n- H 的比值：$\\frac{n_{\\mathrm{H}}}{n_{\\mathrm{O}}} = \\frac{4.4395}{2.2215} \\approx 1.998$\n- O 的比值：$\\frac{n_{\\mathrm{O}}}{n_{\\mathrm{O}}} = 1$\n\n得到的比值约为 C: $2.25$，H: $2.00$，O: $1.00$。为了将它们转换为整数，我们必须将所有值乘以能够消去分数的最小整数。这里，$2.25 = \\frac{9}{4}$，所以我们乘以 $4$。\n- C: $2.25 \\times 4 = 9$\n- H: $2.00 \\times 4 = 8$\n- O: $1.00 \\times 4 = 4$\n\n因此，实验式为 $\\mathrm{C_9H_8O_4}$。\n\n第2部分：计算相对偏差。\n相对偏差 $B$ 定义为：\n$$B = \\frac{\\left(\\frac{n_{\\mathrm{O}}}{n_{\\mathrm{C}}}\\right)_{\\text{reported}}}{\\left(\\frac{n_{\\mathrm{O}}}{n_{\\mathrm{C}}}\\right)_{\\text{corrected}}} - 1$$\n氧摩尔数与碳摩尔数的比值 $\\frac{n_{\\mathrm{O}}}{n_{\\mathrm{C}}}$ 可以用质量分数 ($w$) 和摩尔质量 ($M$) 来表示：\n$$\\frac{n_{\\mathrm{O}}}{n_{\\mathrm{C}}} = \\frac{w_{\\mathrm{O}}/M_{\\mathrm{O}}}{w_{\\mathrm{C}}/M_{\\mathrm{C}}} = \\frac{w_{\\mathrm{O}}}{w_{\\mathrm{C}}} \\frac{M_{\\mathrm{C}}}{M_{\\mathrm{O}}}$$\n将此代入偏差 $B$ 的表达式中：\n$$B = \\frac{\\left(\\frac{w_{\\mathrm{O, rep}}}{w_{\\mathrm{C, rep}}}\\right) \\left(\\frac{M_{\\mathrm{C}}}{M_{\\mathrm{O}}}\\right)}{\\left(\\frac{w_{\\mathrm{O, corr}}}{w_{\\mathrm{C, corr}}}\\right) \\left(\\frac{M_{\\mathrm{C}}}{M_{\\mathrm{O}}}\\right)} - 1$$\n项 $\\frac{M_{\\mathrm{C}}}{M_{\\mathrm{O}}}$ 被消去。问题指定，对于此计算，我们必须保持碳的质量分数不变，即 $w_{\\mathrm{C, corrected}} = w_{\\mathrm{C, reported}}$。该项也被消去。偏差的表达式大大简化为：\n$$B = \\frac{w_{\\mathrm{O, rep}}}{w_{\\mathrm{C, rep}}} \\frac{w_{\\mathrm{C, corr}}}{w_{\\mathrm{O, corr}}} - 1 = \\frac{w_{\\mathrm{O, rep}}}{w_{\\mathrm{O, corr}}} - 1$$\n问题指出，校正后的氧质量分数是通过从报告值中减去 $1.000$ 个百分点（$0.01000$）得到的。\n- $w_{\\mathrm{O, reported}} = 0.35542$\n- $w_{\\mathrm{O, corrected}} = w_{\\mathrm{O, reported}} - 0.01000 = 0.35542 - 0.01000 = 0.34542$\n\n现在我们将这些值代入简化的偏差方程中：\n$$B = \\frac{0.35542}{0.34542} - 1$$\n进行计算：\n$$B \\approx 1.02895026 - 1 = 0.02895026$$\n问题要求结果为四舍五入到四位有效数字的小数。前四位有效数字是 $2$、$8$、$9$ 和 $5$。第五位后面的数字是 $0$，所以无需进位。\n$$B \\approx 0.02895$$\n这就是所求的相对偏差。", "answer": "$$\\boxed{0.02895}$$", "id": "2937650"}, {"introduction": "任何实验测量都伴随着随机误差，而这些不确定性会在后续的数据处理中被传递和放大。这项实践 [@problem_id:2937585] 模拟了一个更真实的分析场景，其中不仅给出了各元素质量分数的标准不确定度，还考虑了测量值之间的相关性。您需要应用严谨的不确定性传播理论，来计算关键化学计量比（氢碳原子比 $r = n_{\\mathrm{H}}/n_{\\mathrm{C}}$）的置信区间，这是评估实验结果可靠性的核心技能。", "problem": "某燃烧分析实验室报告了一种未知有机化合物的归一化质量分数如下：碳 $w_{\\mathrm{C}} = 0.6410$，氢 $w_{\\mathrm{H}} = 0.0535$，氮 $w_{\\mathrm{N}} = 0.0740$，以及氧 $w_{\\mathrm{O}} = 0.2315$，其中 $w_{\\mathrm{C}} + w_{\\mathrm{H}} + w_{\\mathrm{N}} + w_{\\mathrm{O}} = 1$。报告的标准不确定度（一个标准差）为 $u(w_{\\mathrm{C}}) = 0.0020$，$u(w_{\\mathrm{H}}) = 0.0006$ 和 $u(w_{\\mathrm{N}}) = 0.0010$。$u(w_{\\mathrm{O}})$ 未被报告，因为 $w_{\\mathrm{O}}$ 是通过差减法得到的。由于归一化处理，报告的 $w_{\\mathrm{C}}$ 和 $w_{\\mathrm{H}}$ 呈负相关，其协方差为 $\\operatorname{cov}(w_{\\mathrm{C}}, w_{\\mathrm{H}}) = -7.2 \\times 10^{-7}$。为进行本次计算，你可以将 $w_{\\mathrm{N}}$ 和 $w_{\\mathrm{O}}$ 视为与 $w_{\\mathrm{C}}$ 和 $w_{\\mathrm{H}}$ 不相关。\n\n假设摩尔质量为精确常数：$M_{\\mathrm{C}} = 12.011 \\, \\mathrm{g} \\, \\mathrm{mol}^{-1}$ 和 $M_{\\mathrm{H}} = 1.008 \\, \\mathrm{g} \\, \\mathrm{mol}^{-1}$。定义氢碳摩尔比 $r = n_{\\mathrm{H}}/n_{\\mathrm{C}}$，该比值可由一个 $1 \\, \\mathrm{g}$ 的假定样品中的这些质量分数推断得出。\n\n仅从质量分数、物质的量和标准不确定度的定义出发，并使用带有给定协方差的一阶（线性）不确定度传播方法，在大样本正态近似下，计算 $r$ 的双侧 $95 \\, \\%$ 置信区间半宽。将最终答案表示为一个无量纲数，并四舍五入至三位有效数字。最终答案中不要包含单位。", "solution": "所提出的问题是分析化学和统计分析领域一个定义明确的练习。它具有科学依据，内部一致，并包含了得出唯一解所需的所有信息。该问题要求基于实验测定的质量分数及其相关的不确定度和协方差，计算一个导出量——氢碳摩尔比的不确定度。我们将开始进行求解。\n\n首先，我们用所提供的基本量来定义我们感兴趣的量，即氢碳摩尔比 $r$。元素 $i$ 的物质的量 $n_i$（单位为摩尔）通过定义 $n_i = m_i / M_i$ 与其质量 $m_i$ 和摩尔质量 $M_i$ 相关联。在总质量为 $m_{total}$ 的样品中，元素 $i$ 的质量 $m_i$ 由其质量分数 $w_i$ 给出，即 $m_i = w_i \\cdot m_{total}$。\n\n结合这些定义，摩尔比 $r$ 表示为：\n$$ r = \\frac{n_{\\mathrm{H}}}{n_{\\mathrm{C}}} = \\frac{m_{\\mathrm{H}} / M_{\\mathrm{H}}}{m_{\\mathrm{C}} / M_{\\mathrm{C}}} = \\frac{(w_{\\mathrm{H}} \\cdot m_{total}) / M_{\\mathrm{H}}}{(w_{\\mathrm{C}} \\cdot m_{total}) / M_{\\mathrm{C}}} $$\n假定的总质量 $m_{total}$ 被消去，这证实了摩尔比是一个不依赖于样品大小的强度性质。$r$ 的最终表达式是质量分数 $w_{\\mathrm{C}}$ 和 $w_{\\mathrm{H}}$ 以及摩尔质量 $M_{\\mathrm{C}}$ 和 $M_{\\mathrm{H}}$ 的函数：\n$$ r(w_{\\mathrm{C}}, w_{\\mathrm{H}}) = \\frac{w_{\\mathrm{H}}}{w_{\\mathrm{C}}} \\frac{M_{\\mathrm{C}}}{M_{\\mathrm{H}}} $$\n摩尔质量 $M_{\\mathrm{C}}$ 和 $M_{\\mathrm{H}}$ 被说明是精确常数，意味着它们的不确定度为零。因此，$r$ 的不确定度完全源于测量的质量分数 $w_{\\mathrm{C}}$ 和 $w_{\\mathrm{H}}$ 的不确定度。\n\n为了确定 $r$ 的标准不确定度，记为 $u(r)$，我们采用一阶泰勒级数展开进行不确定度传播。对于两个相关变量 $x$ 和 $y$ 的函数 $f(x, y)$，其方差 $u^2(f)$ 由下式给出：\n$$ u^2(f) \\approx \\left(\\frac{\\partial f}{\\partial x}\\right)^2 u^2(x) + \\left(\\frac{\\partial f}{\\partial y}\\right)^2 u^2(y) + 2 \\frac{\\partial f}{\\partial x} \\frac{\\partial f}{\\partial y} \\operatorname{cov}(x, y) $$\n在我们的情况中，函数是 $r(w_{\\mathrm{C}}, w_{\\mathrm{H}})$。我们计算 $r$ 对 $w_{\\mathrm{C}}$ 和 $w_{\\mathrm{H}}$ 的偏导数：\n$$ \\frac{\\partial r}{\\partial w_{\\mathrm{C}}} = \\frac{\\partial}{\\partial w_{\\mathrm{C}}} \\left( \\frac{M_{\\mathrm{C}}}{M_{\\mathrm{H}}} \\frac{w_{\\mathrm{H}}}{w_{\\mathrm{C}}} \\right) = - \\frac{M_{\\mathrm{C}}}{M_{\\mathrm{H}}} \\frac{w_{\\mathrm{H}}}{w_{\\mathrm{C}}^2} = - \\frac{1}{w_{\\mathrm{C}}} \\left( \\frac{M_{\\mathrm{C}}}{M_{\\mathrm{H}}} \\frac{w_{\\mathrm{H}}}{w_{\\mathrm{C}}} \\right) = -\\frac{r}{w_{\\mathrm{C}}} $$\n$$ \\frac{\\partial r}{\\partial w_{\\mathrm{H}}} = \\frac{\\partial}{\\partial w_{\\mathrm{H}}} \\left( \\frac{M_{\\mathrm{C}}}{M_{\\mathrm{H}}} \\frac{w_{\\mathrm{H}}}{w_{\\mathrm{C}}} \\right) = \\frac{M_{\\mathrm{C}}}{M_{\\mathrm{H}}} \\frac{1}{w_{\\mathrm{C}}} = \\frac{1}{w_{\\mathrm{H}}} \\left( \\frac{M_{\\mathrm{C}}}{M_{\\mathrm{H}}} \\frac{w_{\\mathrm{H}}}{w_{\\mathrm{C}}} \\right) = \\frac{r}{w_{\\mathrm{H}}} $$\n将这些偏导数代入通用方差公式，我们得到 $r$ 的方差表达式：\n$$ u^2(r) \\approx \\left(-\\frac{r}{w_{\\mathrm{C}}}\\right)^2 u^2(w_{\\mathrm{C}}) + \\left(\\frac{r}{w_{\\mathrm{H}}}\\right)^2 u^2(w_{\\mathrm{H}}) + 2 \\left(-\\frac{r}{w_{\\mathrm{C}}}\\right) \\left(\\frac{r}{w_{\\mathrm{H}}}\\right) \\operatorname{cov}(w_{\\mathrm{C}}, w_{\\mathrm{H}}) $$\n$$ u^2(r) \\approx r^2 \\left[ \\left(\\frac{u(w_{\\mathrm{C}})}{w_{\\mathrm{C}}}\\right)^2 + \\left(\\frac{u(w_{\\mathrm{H}})}{w_{\\mathrm{H}}}\\right)^2 - \\frac{2 \\operatorname{cov}(w_{\\mathrm{C}}, w_{\\mathrm{H}})}{w_{\\mathrm{C}} w_{\\mathrm{H}}} \\right] $$\n这个方程将比值 $r$ 的方差与质量分数的方差和协方差联系起来。\n\n现在我们代入给定的数值来计算结果。\n给定的数据是：\n$w_{\\mathrm{C}} = 0.6410$\n$w_{\\mathrm{H}} = 0.0535$\n$M_{\\mathrm{C}} = 12.011$\n$M_{\\mathrm{H}} = 1.008$\n$u(w_{\\mathrm{C}}) = 0.0020$\n$u(w_{\\mathrm{H}}) = 0.0006$\n$\\operatorname{cov}(w_{\\mathrm{C}}, w_{\\mathrm{H}}) = -7.2 \\times 10^{-7}$\n\n首先，我们计算比值 $r$ 的中心值：\n$$ r = \\frac{0.0535}{0.6410} \\times \\frac{12.011}{1.008} \\approx 0.994553 $$\n接下来，我们计算相对方差 $(u(r)/r)^2$ 的各项：\n第一项：\n$$ \\left(\\frac{u(w_{\\mathrm{C}})}{w_{\\mathrm{C}}}\\right)^2 = \\left(\\frac{0.0020}{0.6410}\\right)^2 \\approx 9.735 \\times 10^{-6} $$\n第二项：\n$$ \\left(\\frac{u(w_{\\mathrm{H}})}{w_{\\mathrm{H}}}\\right)^2 = \\left(\\frac{0.0006}{0.0535}\\right)^2 \\approx 1.2578 \\times 10^{-4} $$\n第三项（协方差项）：\n$$ - \\frac{2 \\operatorname{cov}(w_{\\mathrm{C}}, w_{\\mathrm{H}})}{w_{\\mathrm{C}} w_{\\mathrm{H}}} = - \\frac{2 (-7.2 \\times 10^{-7})}{(0.6410)(0.0535)} \\approx \\frac{1.44 \\times 10^{-6}}{0.0342935} \\approx 4.199 \\times 10^{-5} $$\n将这些项相加，得到 $r$ 的相对方差：\n$$ \\left(\\frac{u(r)}{r}\\right)^2 \\approx (9.735 \\times 10^{-6}) + (1.2578 \\times 10^{-4}) + (4.199 \\times 10^{-5}) \\approx 1.7750 \\times 10^{-4} $$\n标准不确定度 $u(r)$ 则为：\n$$ u(r) = r \\sqrt{1.7750 \\times 10^{-4}} \\approx 0.994553 \\times \\sqrt{1.7750 \\times 10^{-4}} \\approx 0.994553 \\times 0.013323 \\approx 0.01325 $$\n问题要求在假定大样本正态分布的情况下，计算 $r$ 的双侧 $95 \\, \\%$ 置信区间的半宽。对于 $95 \\, \\%$ 的置信水平，来自标准正态分布的临界值为 $z = 1.96$。半宽 $W$ 计算如下：\n$$ W = z \\cdot u(r) $$\n$$ W \\approx 1.96 \\times 0.01325 \\approx 0.02597 $$\n按照要求将结果四舍五入到三位有效数字，我们得到置信区间半宽的最终值。\n$$ W \\approx 0.0260 $$\n这个值表示在 $95 \\, \\%$ 置信水平下，计算出的氢碳摩尔比的不确定度范围。", "answer": "$$\n\\boxed{0.0260}\n$$", "id": "2937585"}, {"introduction": "现代分析技术，特别是高分辨率质谱，能够为未知化合物提供包括精确质量在内的多维度、高精度信息。这使得我们可以从“正向计算”（由化学式计算性质）转变为“逆向求解”（由性质反推化学式）。这项具有挑战性的编程实践 [@problem_id:2937652] 模拟了这一前沿方法，要求您设计一个算法，在庞大的化学式组合空间中，根据精确质量、双键当量（DBE）和元素组成等多重约束，筛选出所有可能的分子式。", "problem": "实现一个程序，对元素 $\\{C,H,N,O,S,Cl\\}$ 的整数原子数进行一次全面但有界的搜索，以确定所有满足精确单同位素质量、双键当量（double bond equivalent (DBE)）和元素质量分数这几项同步约束的分子式。您的程序必须从基本定义和经过充分检验的公式开始：\n\n- 精确单同位素质量：对于一个候选的整数原子数向量 $\\mathbf{n} = [n_C,n_H,n_N,n_O,n_S,n_{Cl}]$，其精确质量 $m(\\mathbf{n})$ 是各项元素的原子数与其单同位素质量乘积之和。请使用以下单同位素质量（单位为统一原子质量单位，也称为道尔顿）：$m_C = 12.00000000000$, $m_H = 1.00782503223$, $m_N = 14.00307400443$, $m_O = 15.99491461957$, $m_S = 31.97207117440$, $m_{Cl} = 34.96885268200$。\n- 双键当量（DBE）：对于一个候选分子式 $\\mathbf{n}$，按如下公式计算基于氢亏损的DBE：\n$$\\mathrm{DBE}(\\mathbf{n}) = \\frac{2\\,n_C + 2 + n_N - n_H - n_{X}}{2},$$\n其中 $n_X$ 是单价卤素的总数。在本问题中，$n_X = n_{Cl}$。化学上有效的解必须满足 $\\mathrm{DBE}(\\mathbf{n})$ 是一个非负整数。\n- 元素 $E$ 的元素质量分数定义为 $w_E(\\mathbf{n}) = \\frac{n_E\\,m_E}{m(\\mathbf{n})}$。该分数必须与特定案例的闭区间进行比较。所有分数都必须以小数形式表示（不带百分号）。\n\n您的程序必须：\n\n1. 枚举所有 $\\mathbf{n}$，其中每个 $n_E$ 都受限于特定案例的整数边界 $0 \\le n_E \\le n_E^{\\max}$。\n2. 对每个 $\\mathbf{n}$，计算其 $m(\\mathbf{n})$、$\\mathrm{DBE}(\\mathbf{n})$ 以及所有元素 $E \\in \\{C,H,N,O,S,Cl\\}$ 的 $w_E(\\mathbf{n})$。\n3. 当且仅当以下所有条件同时成立时，才接受 $\\mathbf{n}$ 作为测试用例的解：\n   - 精确质量在指定的绝对公差范围内：$|m(\\mathbf{n}) - m_{\\mathrm{target}}| \\le \\Delta m$，其中 $m_{\\mathrm{target}}$ 和 $\\Delta m$ 均已提供。\n   - DBE 位于闭合整数区间 $[\\mathrm{DBE}_{\\min}, \\mathrm{DBE}_{\\max}]$ 内，并且是一个整数。\n   - 对于每个元素 $E$，其元素质量分数满足 $w_E^{\\min} \\le w_E(\\mathbf{n}) \\le w_E^{\\max}$，其中边界是按元素提供的。\n\n对于每个测试用例，将所有解以原子数列表 $[n_C,n_H,n_N,n_O,n_S,n_{Cl}]$ 的形式，按字典序排序后返回。\n\n物理和数值单位：精确质量和公差必须以道尔顿为单位处理。DBE是无单位的。元素质量分数是位于 $[0,1]$ 区间的无单位小数。\n\n角度单位在此无关紧要。\n\n最终输出格式：您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，不含空格。每个条目对应一个测试用例的解集，表示为一个整数列表的列表。例如，一个运行两个测试用例，第一个用例返回一个解，第二个用例无解的输出必须如下所示：$[[[2,5,1,2,0,0]],[]]$。\n\n测试套件和答案规范：使用以下四个案例，它们共同探测了一个典型的匹配案例、一个卤代案例、一个富含杂原子的案例以及一个不可行的边界案例。所有数值均为闭区间，且必须包含边界值。\n\n- 所有案例共用的常数：\n  - 单同位素质量（道尔顿）：$m_C = 12.00000000000$, $m_H = 1.00782503223$, $m_N = 14.00307400443$, $m_O = 15.99491461957$, $m_S = 31.97207117440$, $m_{Cl} = 34.96885268200$。\n\n- 案例1（氮氧小分子）：\n  - 目标质量和公差：$m_{\\mathrm{target}} = 75.03202840472$, $\\Delta m = 0.0005$。\n  - DBE 范围：$\\mathrm{DBE}_{\\min} = 1$, $\\mathrm{DBE}_{\\max} = 1$。\n  - 元素质量分数边界 $(w_E^{\\min},w_E^{\\max})$：\n    - $C$: $(0.319, 0.321)$,\n    - $H$: $(0.0665, 0.0680)$,\n    - $N$: $(0.186, 0.187)$,\n    - $O$: $(0.425, 0.428)$,\n    - $S$: $(0.000, 0.010)$,\n    - $Cl$: $(0.000, 0.010)$。\n  - 原子数上限 $n_E^{\\max}$：\n    - $C$: $10$, $H$: $20$, $N$: $4$, $O$: $10$, $S$: $2$, $Cl$: $2$。\n\n- 案例2（二卤代烃）：\n  - 目标质量和公差：$m_{\\mathrm{target}} = 97.96900549292$, $\\Delta m = 0.0005$。\n  - DBE 范围：$\\mathrm{DBE}_{\\min} = 0$, $\\mathrm{DBE}_{\\max} = 0$。\n  - 元素质量分数边界：\n    - $C$: $(0.245, 0.246)$,\n    - $H$: $(0.0410, 0.0415)$,\n    - $N$: $(0.000, 0.010)$,\n    - $O$: $(0.000, 0.010)$,\n    - $S$: $(0.000, 0.010)$,\n    - $Cl$: $(0.713, 0.7145)$。\n  - 原子数上限：\n    - $C$: $4$, $H$: $8$, $N$: $2$, $O$: $2$, $S$: $1$, $Cl$: $3$。\n\n- 案例3（硫化羰）：\n  - 目标质量和公差：$m_{\\mathrm{target}} = 59.96698579397$, $\\Delta m = 0.0005$。\n  - DBE 范围：$\\mathrm{DBE}_{\\min} = 2$, $\\mathrm{DBE}_{\\max} = 2$。\n  - 元素质量分数边界：\n    - $C$: $(0.200, 0.201)$,\n    - $H$: $(0.000, 0.010)$,\n    - $N$: $(0.000, 0.010)$,\n    - $O$: $(0.2663, 0.2670)$,\n    - $S$: $(0.533, 0.534)$,\n    - $Cl$: $(0.000, 0.010)$。\n  - 原子数上限：\n    - $C$: $3$, $H$: $2$, $N$: $2$, $O$: $3$, $S$: $2$, $Cl$: $1$。\n\n- 案例4（不可行边界）：\n  - 目标质量和公差：$m_{\\mathrm{target}} = 200.00000000000$, $\\Delta m = 0.0010$。\n  - DBE 范围：$\\mathrm{DBE}_{\\min} = 0$, $\\mathrm{DBE}_{\\max} = 5$。\n  - 元素质量分数边界：\n    - $C$: $(0.000, 1.000)$,\n    - $H$: $(0.000, 1.000)$,\n    - $N$: $(0.000, 1.000)$,\n    - $O$: $(0.000, 1.000)$,\n    - $S$: $(0.000, 1.000)$,\n    - $Cl$: $(0.000, 1.000)$。\n  - 原子数上限：\n    - $C$: $1$, $H$: $1$, $N$: $1$, $O$: $1$, $S$: $1$, $Cl$: $1$。\n\n您的程序必须按所列顺序评估这四个案例，并生成一个包含按该顺序排列的解集的单行内容，其格式如上所述，不含空格。每个独立的解都是一个包含六个整数的列表，元素顺序为 $\\{C,H,N,O,S,Cl\\}$。", "solution": "问题陈述已经过评估并被确定为有效。它提出了一个分析化学领域中定义明确的计算任务，具体涉及从质谱数据中确定分子式。该问题具有科学依据，内部一致，并要求实现一个受约束的穷举搜索算法。所提供的物理常数、数学公式和约束条件清晰且充分，足以推导出每个测试用例的唯一解集。在区间表示法上存在一个微小的歧义，即使用了圆括号表示法来表示明确定义为闭合、包含边界的区间。这只是表述上的一个微不足道的缺陷，而非逻辑错误，而关于包含性的明确说明提供了无歧义的澄清。我们将着手进行解答。\n\n该问题要求识别所有可能的分子式，这些分子式以原子计数的整数向量 $\\mathbf{n} = [n_C, n_H, n_N, n_O, n_S, n_{Cl}]$ 表示，并同时满足一组给定的关于精确质量、双键当量和元素质量分数的约束。每个元素 $E$ 的原子数 $n_E$ 的搜索空间由特定案例的上限 $0 \\le n_E \\le n_E^{\\max}$ 限定。这个搜索空间的有限性使得穷举搜索（或暴力枚举）成为一种可行且正确的策略。\n\n算法将按以下步骤进行：\n\n1.  **遍历测试用例**：程序将系统地处理提供的四个测试用例中的每一个。对于每个案例，使用特定的约束条件（$m_{\\mathrm{target}}$, $\\Delta m$, $[\\mathrm{DBE}_{\\min}, \\mathrm{DBE}_{\\max}]$, $\\{w_E^{\\min}, w_E^{\\max}\\}$ 和 $\\{n_E^{\\max}\\}$）。\n\n2.  **生成候选分子式**：对于给定的测试用例，生成所有可能的候选向量 $\\mathbf{n}$。这是一个组合问题，通过对每个 $n_C$ 从 $0$ 到 $n_C^{\\max}$、每个 $n_H$ 从 $0$ 到 $n_H^{\\max}$ 进行迭代，直至所有六种元素。这定义了一个六维整数点搜索网格。\n\n3.  **应用约束过滤器**：每个候选向量 $\\mathbf{n}$ 都将经过一系列验证检查。一个候选者必须通过所有检查才能被视为一个解。这些检查按顺序排列，以通过尽早排除不可行的候选者来最大化计算效率。\n\n    a. **质量过滤器**：使用提供的公式计算精确单同位素质量 $m(\\mathbf{n})$：\n    $$m(\\mathbf{n}) = \\sum_{E \\in \\{C,H,N,O,S,Cl\\}} n_E m_E$$\n    其中 $m_E$ 是给定的单同位素质量。只有当候选者的质量落在指定的公差窗口内时，才保留它以进行进一步处理：\n    $$|m(\\mathbf{n}) - m_{\\mathrm{target}}| \\le \\Delta m$$\n    总质量为 $m(\\mathbf{n})=0$ 的候选者（即空分子式 $\\mathbf{n}=[0,0,0,0,0,0]$）会被固有地拒绝，因为所有目标质量都是正数。此检查还可防止在后续的质量分数计算中出现除以零的情况。\n\n    b. **双键当量（DBE）过滤器**：对于通过质量过滤器的候选者，计算其 DBE：\n    $$\\mathrm{DBE}(\\mathbf{n}) = \\frac{2n_C + 2 + n_N - n_H - n_{Cl}}{2}$$\n    对于一个化学上有效的分子式，$\\mathrm{DBE}(\\mathbf{n})$ 必须是一个非负整数。这意味着分子 $2n_C + 2 + n_N - n_H - n_{Cl}$ 必须是一个非负偶数。此外，所得的 DBE 值必须位于指定的闭合范围 $[\\mathrm{DBE}_{\\min}, \\mathrm{DBE}_{\\max}]$ 内。\n\n    c. **元素质量分数过滤器**：对于同时通过质量和 DBE 过滤器的候选者，计算每个元素 $E$ 的元素质量分数 $w_E(\\mathbf{n})$：\n    $$w_E(\\mathbf{n}) = \\frac{n_E m_E}{m(\\mathbf{n})}$$\n    每个计算出的分数 $w_E(\\mathbf{n})$ 都必须落在其指定的闭合范围 $[w_E^{\\min}, w_E^{\\max}]$ 内。只有当这个条件对所有六个元素都成立时，候选者才被接受为最终解。\n\n4.  **收集并排序解**：将当前测试用例中满足所有三个过滤器的所有候选向量 $\\mathbf{n}$ 收集起来。然后按要求对此解列表进行字典序排序。\n\n5.  **格式化输出**：最终结果是一个列表，其中包含四个测试用例中每个用例的已排序解列表。此结果被格式化为单个无空白字符的字符串，严格遵守指定格式。对于没有产生解的用例，用一个空列表表示。\n\n这种系统的枚举和过滤方法保证了在定义的搜索空间内的所有解都能被找到，并且不会包含任何无效的分子式。实现将使用高精度浮点运算来确保数值的正确性。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport itertools\n\ndef solve():\n    \"\"\"\n    Performs an exhaustive search for molecular formulae satisfying constraints\n    on mass, DBE, and elemental composition.\n    \"\"\"\n    \n    # Fundamental constants\n    # Monoisotopic masses (daltons) for C, H, N, O, S, Cl\n    MONOISOTOPIC_MASSES = np.array([\n        12.00000000000,    # C\n        1.00782503223,     # H\n        14.00307400443,    # N\n        15.99491461957,    # O\n        31.97207117440,    # S\n        34.96885268200     # Cl\n    ])\n    \n    # Test cases defined as a list of dictionaries.\n    test_cases = [\n        # Case 1: nitrogen-oxygen small molecule\n        {\n            'm_target': 75.03202840472, 'delta_m': 0.0005,\n            'dbe_range': (1, 1),\n            'w_bounds': [\n                (0.319, 0.321),    # C\n                (0.0665, 0.0680),  # H\n                (0.186, 0.187),    # N\n                (0.425, 0.428),    # O\n                (0.000, 0.010),    # S\n                (0.000, 0.010)     # Cl\n            ],\n            'n_max': [10, 20, 4, 10, 2, 2]\n        },\n        # Case 2: dihalogenated hydrocarbon\n        {\n            'm_target': 97.96900549292, 'delta_m': 0.0005,\n            'dbe_range': (0, 0),\n            'w_bounds': [\n                (0.245, 0.246),    # C\n                (0.0410, 0.0415),  # H\n                (0.000, 0.010),    # N\n                (0.000, 0.010),    # O\n                (0.000, 0.010),    # S\n                (0.713, 0.7145)    # Cl\n            ],\n            'n_max': [4, 8, 2, 2, 1, 3]\n        },\n        # Case 3: carbonyl sulfide\n        {\n            'm_target': 59.96698579397, 'delta_m': 0.0005,\n            'dbe_range': (2, 2),\n            'w_bounds': [\n                (0.200, 0.201),    # C\n                (0.000, 0.010),    # H\n                (0.000, 0.010),    # N\n                (0.2663, 0.2670),  # O\n                (0.533, 0.534),    # S\n                (0.000, 0.010)     # Cl\n            ],\n            'n_max': [3, 2, 2, 3, 2, 1]\n        },\n        # Case 4: infeasible bounds\n        {\n            'm_target': 200.00000000000, 'delta_m': 0.0010,\n            'dbe_range': (0, 5),\n            'w_bounds': [\n                (0.000, 1.000),    # C\n                (0.000, 1.000),    # H\n                (0.000, 1.000),    # N\n                (0.000, 1.000),    # O\n                (0.000, 1.000),    # S\n                (0.000, 1.000)     # Cl\n            ],\n            'n_max': [1, 1, 1, 1, 1, 1]\n        }\n    ]\n\n    all_cases_results = []\n\n    for case in test_cases:\n        m_target, delta_m = case['m_target'], case['delta_m']\n        dbe_min, dbe_max = case['dbe_range']\n        w_bounds = case['w_bounds']\n        n_max = case['n_max']\n        \n        # Generate candidate atom counts using itertools.product\n        count_ranges = [range(n + 1) for n in n_max]\n        candidates = itertools.product(*count_ranges)\n        \n        found_solutions = []\n        \n        for counts_tuple in candidates:\n            # Trivial case of no atoms has zero mass and undefined fractions\n            if sum(counts_tuple) == 0:\n                continue\n\n            counts = np.array(counts_tuple)\n            \n            # --- Filter 1: Exact Mass ---\n            total_mass = np.dot(counts, MONOISOTOPIC_MASSES)\n            if not (m_target - delta_m = total_mass = m_target + delta_m):\n                continue\n                \n            # --- Filter 2: Double Bond Equivalent (DBE) ---\n            nC, nH, nN, nO, nS, nCl = counts_tuple\n            dbe_numerator = 2 * nC + 2 + nN - nH - nCl\n            \n            # DBE must be a non-negative integer\n            if dbe_numerator  0 or dbe_numerator % 2 != 0:\n                continue\n            \n            dbe = dbe_numerator // 2\n            if not (dbe_min = dbe = dbe_max):\n                continue\n            \n            # --- Filter 3: Elemental Mass Fractions ---\n            # This check is last as it's the most computationally expensive.\n            mass_fractions = (counts * MONOISOTOPIC_MASSES) / total_mass\n            \n            all_fractions_valid = True\n            for i in range(len(counts)):\n                w_min, w_max = w_bounds[i]\n                if not (w_min = mass_fractions[i] = w_max):\n                    all_fractions_valid = False\n                    break\n            \n            if all_fractions_valid:\n                found_solutions.append(list(counts))\n\n        # Sort solutions lexicographically\n        found_solutions.sort()\n        all_cases_results.append(found_solutions)\n        \n    # Format the final output string precisely as required (no spaces)\n    outer_parts = []\n    for case_solutions in all_cases_results:\n        if not case_solutions:\n            outer_parts.append('[]')\n        else:\n            inner_parts = []\n            for sol in case_solutions:\n                inner_parts.append(f\"[{','.join(map(str, sol))}]\")\n            outer_parts.append(f\"[{','.join(inner_parts)}]\")\n    \n    final_output = f\"[{','.join(outer_parts)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "2937652"}]}