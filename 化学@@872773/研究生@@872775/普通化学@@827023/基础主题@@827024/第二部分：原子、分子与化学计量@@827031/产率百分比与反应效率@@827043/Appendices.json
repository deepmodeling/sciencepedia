{"hands_on_practices": [{"introduction": "准确的产率计算是合成化学的基石。本练习超越了理想化的教科书案例，融入了真实世界的复杂性，例如使用已知浓度和密度的储备溶液作为反应物，以及分离得到的产物是水合物。掌握这类计算对于连接理论化学计量学与实验室实际操作至关重要，是评估合成方法成功与否的基本技能 [@problem_id:2949821]。", "problem": "通过氧化铜(II) $\\text{CuO}$ 与硫酸 $\\text{H}_2\\text{SO}_4$ 水溶液根据化学计量转化关系 $\\text{CuO} + \\text{H}_2\\text{SO}_4 \\rightarrow \\text{CuSO}_4 + \\text{H}_2\\text{O}$ 反应，制备了一批结晶状的五水合硫酸铜(II)，其化学式为 $\\text{CuSO}_4 \\cdot 5\\text{H}_2\\text{O}$。所用酸是以已知摩尔浓度 $M$ 和密度 $\\rho$ 的储备溶液形式提供的。将质量为 $8.500\\,\\text{g}$ 的 $\\text{CuO}$ 与 $45.00\\,\\text{g}$ 摩尔浓度为 $3.000\\,\\text{mol}\\,\\text{L}^{-1}$、密度为 $1.180\\,\\text{g}\\,\\text{mL}^{-1}$ 的 $\\text{H}_2\\text{SO}_4$ 储备溶液混合。在完全反应并从水中结晶后，分离得到 $24.850\\,\\text{g}$ 的 $\\text{CuSO}_4 \\cdot 5\\text{H}_2\\text{O}$。使用以下摩尔质量：$M(\\text{CuO}) = 79.545\\,\\text{g}\\,\\text{mol}^{-1}$，$M(\\text{CuSO}_4) = 159.607\\,\\text{g}\\,\\text{mol}^{-1}$，$M(\\text{H}_2\\text{O}) = 18.015\\,\\text{g}\\,\\text{mol}^{-1}$，以及 $M(\\text{CuSO}_4 \\cdot 5\\text{H}_2\\text{O}) = 249.682\\,\\text{g}\\,\\text{mol}^{-1}$。\n\n仅从核心定义出发，确定 $\\text{CuSO}_4$ 以无水物为基准的反应效率（分数产率），并对以下情况进行适当调整：(i) 反应物是以已知摩尔浓度 $M$ 和密度 $\\rho$ 的溶液形式提供的；(ii) 分离出的产物是五水合物 $\\text{CuSO}_4 \\cdot 5\\text{H}_2\\text{O}$。将最终的反应效率表示为小数（单位1的分数），并将答案四舍五入到四位有效数字。最终数值答案中不要包含任何单位。", "solution": "本题要求计算硫酸铜(II)合成的反应效率，也称为分数产率。反应效率用 $\\eta$ 表示，定义为实际产率与理论产率的比值。\n\n$$\n\\eta = \\frac{\\text{实际产率}}{\\text{理论产率}}\n$$\n\n实际产率和理论产率都必须用相同的单位表示，通常是摩尔或质量。用摩尔进行计算最直接。\n\n第一步是确定每种反应物的物质的量（以摩尔为单位）。配平的化学方程式为：\n$$\n\\text{CuO} + \\text{H}_2\\text{SO}_4 \\rightarrow \\text{CuSO}_4 + \\text{H}_2\\text{O}\n$$\n这表明反应物氧化铜(II)（$\\text{CuO}$）和硫酸（$\\text{H}_2\\text{SO}_4$）之间的化学计量摩尔比为 $1:1$。\n\n给定 $\\text{CuO}$ 的质量为 $m_{\\text{CuO}} = 8.500\\,\\text{g}$。$\\text{CuO}$ 的摩尔质量为 $M(\\text{CuO}) = 79.545\\,\\text{g}\\,\\text{mol}^{-1}$。$\\text{CuO}$ 的物质的量 $n_{\\text{CuO}}$ 计算如下：\n$$\nn_{\\text{CuO}} = \\frac{m_{\\text{CuO}}}{M(\\text{CuO})} = \\frac{8.500\\,\\text{g}}{79.545\\,\\text{g}\\,\\text{mol}^{-1}} \\approx 0.106859\\,\\text{mol}\n$$\n\n接下来，我们必须确定硫酸的物质的量 $n_{\\text{H}_2\\text{SO}_4}$。给定水溶液的质量 $m_{\\text{sol}} = 45.00\\,\\text{g}$，其密度 $\\rho_{\\text{sol}} = 1.180\\,\\text{g}\\,\\text{mL}^{-1}$，其摩尔浓度 $M_{\\text{H}_2\\text{SO}_4} = 3.000\\,\\text{mol}\\,\\text{L}^{-1}$。首先，我们根据其质量和密度计算溶液的体积 $V_{\\text{sol}}$。我们必须确保单位一致。\n$$\n\\rho_{\\text{sol}} = 1.180\\,\\frac{\\text{g}}{\\text{mL}} = 1.180\\,\\frac{\\text{g}}{\\text{mL}} \\times \\frac{1000\\,\\text{mL}}{1\\,\\text{L}} = 1180\\,\\text{g}\\,\\text{L}^{-1}\n$$\n$$\nV_{\\text{sol}} = \\frac{m_{\\text{sol}}}{\\rho_{\\text{sol}}} = \\frac{45.00\\,\\text{g}}{1180\\,\\text{g}\\,\\text{L}^{-1}} \\approx 0.0381356\\,\\text{L}\n$$\n现在，利用摩尔浓度，我们求出 $\\text{H}_2\\text{SO}_4$ 的物质的量：\n$$\nn_{\\text{H}_2\\text{SO}_4} = M_{\\text{H}_2\\text{SO}_4} \\times V_{\\text{sol}} = 3.000\\,\\text{mol}\\,\\text{L}^{-1} \\times \\left( \\frac{45.00}{1180} \\right)\\,\\text{L} \\approx 0.114407\\,\\text{mol}\n$$\n\n第二步是确定限量反应物。我们根据反应的化学计量关系比较反应物的物质的量。由于摩尔比为 $1:1$，我们只需比较物质的量。\n$$\nn_{\\text{CuO}} \\approx 0.106859\\,\\text{mol}\n$$\n$$\nn_{\\text{H}_2\\text{SO}_4} \\approx 0.114407\\,\\text{mol}\n$$\n因为 $n_{\\text{CuO}}  n_{\\text{H}_2\\text{SO}_4}$，所以氧化铜(II)是限量反应物。一旦所有的 $\\text{CuO}$ 被消耗完，反应就会停止。\n\n第三步是计算无水硫酸铜(II) $\\text{CuSO}_4$ 的理论产率。理论产率是可能形成的最大产物量，它由限量反应物的量决定。根据化学计量关系，一摩尔 $\\text{CuO}$ 产生一摩尔 $\\text{CuSO}_4$。因此，以摩尔为单位的理论产率 $n_{\\text{CuSO}_4, \\text{theo}}$ 等于限量反应物的物质的量。\n$$\nn_{\\text{CuSO}_4, \\text{theo}} = n_{\\text{CuO}} = \\frac{8.500}{79.545}\\,\\text{mol} \\approx 0.106859\\,\\text{mol}\n$$\n\n第四步是确定无水 $\\text{CuSO}_4$ 的实际产率。题目指出，分离出的产物是五水合物 $\\text{CuSO}_4 \\cdot 5\\text{H}_2\\text{O}$，质量为 $m_{\\text{actual}} = 24.850\\,\\text{g}$。五水合物的摩尔质量为 $M(\\text{CuSO}_4 \\cdot 5\\text{H}_2\\text{O}) = 249.682\\,\\text{g}\\,\\text{mol}^{-1}$。我们首先计算得到的含水盐的物质的量。\n$$\nn_{\\text{hydrate, actual}} = \\frac{m_{\\text{actual}}}{M(\\text{CuSO}_4 \\cdot 5\\text{H}_2\\text{O})} = \\frac{24.850\\,\\text{g}}{249.682\\,\\text{g}\\,\\text{mol}^{-1}} \\approx 0.099527\\,\\text{mol}\n$$\n根据定义，每摩尔 $\\text{CuSO}_4 \\cdot 5\\text{H}_2\\text{O}$ 含有一摩尔无水 $\\text{CuSO}_4$。因此，无水 $\\text{CuSO}_4$ 的实际摩尔产率 $n_{\\text{CuSO}_4, \\text{actual}}$ 等于分离出的含水盐的物质的量。\n$$\nn_{\\text{CuSO}_4, \\text{actual}} = n_{\\text{hydrate, actual}} \\approx 0.099527\\,\\text{mol}\n$$\n\n最后一步是通过将实际产率除以理论产率来计算反应效率 $\\eta$。\n$$\n\\eta = \\frac{n_{\\text{CuSO}_4, \\text{actual}}}{n_{\\text{CuSO}_4, \\text{theo}}} = \\frac{\\frac{24.850}{249.682}}{\\frac{8.500}{79.545}} = \\frac{0.09952659...}{0.10685903...} \\approx 0.931383\n$$\n题目要求答案四舍五入到四位有效数字。\n$$\n\\eta \\approx 0.9314\n$$\n这就是以无水物为基准的分数产率，或称反应效率。", "answer": "$$\\boxed{0.9314}$$", "id": "2949821"}, {"introduction": "传统的重量分析法在测定产率时有其局限性，例如在分离和纯化过程中不可避免的产物损失。本练习介绍了一种强大而现代的替代方法：定量核磁共振（qNMR）波谱法。通过向反应粗产物中加入内标物，该技术能够直接、精确地测定产物的量，从而无需分离产物，更真实地反映了反应本身的效率 [@problem_id:2949813]。", "problem": "一个单分子环化反应将限制性底物 $\\mathrm{A}$ 转化为单一有机产物 $\\mathrm{P}$，化学计量比为一对一。反应淬灭并后处理后，将全部粗产物定量转移至一个核磁共振管中。将一份精确称量的内标——二甲砜，加入到同一个管中。在接收器增益、脉冲角、温度和采集参数对所有共振峰都相同的条件下，采集了一张质子定量核磁共振（qNMR）谱；然而，弛豫延迟是有限的，因此必须应用与共振相关的响应因子。假设基线校正理想，无信号重叠，且没有其他物质对下述共振峰有贡献。\n\n以下是已知或测量的数据：\n- 反应中加入的 $\\mathrm{A}$ 的初始摩尔数（且为限制性底物）：$0.500\\,\\mathrm{mmol}$。\n- 核磁共振管中内标的摩尔数：$0.200\\,\\mathrm{mmol}$。\n- 产物 $\\mathrm{P}$ 显示一个由 $3$ 个等效质子产生的孤立甲基单峰。\n- 内标显示一个由 $6$ 个等效质子产生的孤立单峰。\n- 这些孤立共振峰的积分面积（任意单位）分别为：产物甲基单峰 $I_{\\mathrm{P}} = 180.0$，内标单峰 $I_{\\mathrm{IS}} = 200.0$。\n- 在相同采集条件下独立测定的这两个共振峰的响应因子（无量纲）分别为：$r_{\\mathrm{P}} = 0.950$ 和 $r_{\\mathrm{IS}} = 1.000$。\n\n从基本原理出发——即在质子qNMR中，一个非重叠共振峰的积分面积与该共振峰的吸收核数量乘以相应物质的摩尔数成正比，并带有一个与共振相关的响应因子——推导一个表达式，用以上数据求出管中 $\\mathrm{P}$ 的摩尔数。然后用它计算反应的百分比产率的小数形式，该产率定义为 $\\mathrm{P}$ 的实际摩尔数与由 $\\mathrm{A}$ 的一对一化学计量关系所隐含的 $\\mathrm{P}$ 的理论摩尔数之比。将最终产率表示为一个不带百分号的小数，并将最终答案四舍五入至四位有效数字。", "solution": "质子定量核磁共振（qNMR）的基本出发点是，一个非重叠共振峰 $i$ 的积分面积 $I_{i}$ 与在有效检测体积内对该共振峰有贡献的吸收自旋总数成正比。对于一个分子种类 $j$，其共振峰 $i$ 由每个分子的 $n_{H,i}$ 个等效质子产生，其物质的量为 $n_{j}$（单位：摩尔），可以写出：\n$$\nI_{i} = \\kappa\\, r_{i}\\, n_{H,i}\\, n_{j},\n$$\n其中 $\\kappa$ 是在相同条件下采集的所有共振峰所共有的一个仪器/样品常数，而 $r_{i}$ 是一个无量纲的响应因子，它解释了与理想行为的偏差（例如，由于有限的弛豫延迟导致的不完全弛豫、脉冲不完美或频率依赖性灵敏度）。\n\n考虑在同一次实验中采集的两个共振峰：一个来自产物 $\\mathrm{P}$，一个来自内标 $\\mathrm{IS}$。用 $I_{\\mathrm{P}}$ 和 $I_{\\mathrm{IS}}$ 表示它们的积分面积，用 $r_{\\mathrm{P}}$ 和 $r_{\\mathrm{IS}}$ 表示它们的响应因子，用 $n_{H,\\mathrm{P}}$ 和 $n_{H,\\mathrm{IS}}$ 分别表示对每个共振峰有贡献的等效质子数。管中每种物质的摩尔数分别为 $n_{\\mathrm{P}}$ 和 $n_{\\mathrm{IS}}$。于是有：\n$$\nI_{\\mathrm{P}} = \\kappa\\, r_{\\mathrm{P}}\\, n_{H,\\mathrm{P}}\\, n_{\\mathrm{P}}, \\qquad\nI_{\\mathrm{IS}} = \\kappa\\, r_{\\mathrm{IS}}\\, n_{H,\\mathrm{IS}}\\, n_{\\mathrm{IS}}.\n$$\n两式相比可以消去共同常数 $\\kappa$：\n$$\n\\frac{I_{\\mathrm{P}}}{I_{\\mathrm{IS}}} = \\frac{r_{\\mathrm{P}}\\, n_{H,\\mathrm{P}}\\, n_{\\mathrm{P}}}{r_{\\mathrm{IS}}\\, n_{H,\\mathrm{IS}}\\, n_{\\mathrm{IS}}}.\n$$\n以已知或测量的量求解该关系式中的 $n_{\\mathrm{P}}$ 可得：\n$$\nn_{\\mathrm{P}} = n_{\\mathrm{IS}} \\,\\frac{I_{\\mathrm{P}}}{I_{\\mathrm{IS}}}\\,\\frac{r_{\\mathrm{IS}}}{r_{\\mathrm{P}}}\\,\\frac{n_{H,\\mathrm{IS}}}{n_{H,\\mathrm{P}}}.\n$$\n\n我们已知：\n- $n_{\\mathrm{IS}} = 0.200\\,\\mathrm{mmol} = 0.000200\\,\\mathrm{mol}$，\n- $I_{\\mathrm{P}} = 180.0$，\n- $I_{\\mathrm{IS}} = 200.0$，\n- $r_{\\mathrm{IS}} = 1.000$，\n- $r_{\\mathrm{P}} = 0.950$，\n- $n_{H,\\mathrm{IS}} = 6$（内标单峰），\n- $n_{H,\\mathrm{P}} = 3$（产物甲基单峰）。\n\n代入这些数值：\n$$\nn_{\\mathrm{P}} = \\left(0.000200\\right)\\,\\frac{180.0}{200.0}\\,\\frac{1.000}{0.950}\\,\\frac{6}{3}.\n$$\n分步计算。首先，面积比：\n$$\n\\frac{I_{\\mathrm{P}}}{I_{\\mathrm{IS}}} = \\frac{180.0}{200.0} = 0.900.\n$$\n接下来，响应因子比：\n$$\n\\frac{r_{\\mathrm{IS}}}{r_{\\mathrm{P}}} = \\frac{1.000}{0.950} \\approx 1.0526315789.\n$$\n然后，质子数比：\n$$\n\\frac{n_{H,\\mathrm{IS}}}{n_{H,\\mathrm{P}}} = \\frac{6}{3} = 2.\n$$\n将这些因子相乘：\n$$\n0.900 \\times 1.0526315789 \\times 2 = 1.8947368421.\n$$\n因此，\n$$\nn_{\\mathrm{P}} = 0.000200 \\times 1.8947368421 = 0.0003789473684\\,\\text{mol}.\n$$\n\n反应中 $\\mathrm{A}$ 与 $\\mathrm{P}$ 的摩尔比为一对一，所以产物的理论摩尔数等于 $\\mathrm{A}$ 的初始摩尔数：\n$$\nn_{\\mathrm{theor}} = n_{\\mathrm{A},0} = 0.500\\,\\mathrm{mmol} = 0.000500\\,\\mathrm{mol}.\n$$\n以小数形式表示的产率（实际产出与理论产出之比）为：\n$$\nY = \\frac{n_{\\mathrm{P}}}{n_{\\mathrm{theor}}} = \\frac{0.0003789473684}{0.000500} = 0.7578947368.\n$$\n按要求四舍五入至四位有效数字：\n$$\nY = 0.7579.\n$$\n这是反应产率的最终小数形式，不带百分号。", "answer": "$$\\boxed{0.7579}$$", "id": "2949813"}, {"introduction": "高效的化学研究不仅在于测量已完成反应的产率，更在于预测和优化未来的反应结果。本计算实践将深入探讨反应效率的核心，通过动力学模型来分析目标反应与副反应之间的竞争。通过敏感性分析，您将学习如何识别哪些动力学参数和操作条件对最终产率影响最大，这是化学过程开发与优化的关键技能 [@problem_id:2949897]。", "problem": "一个充分混合、恒定体积、恒温的间歇式反应器中含有物种 $A$ 和 $B$，它们通过一个目标双分子反应和一个竞争性单分子副反应进行反应。目标反应为 $A + B \\rightarrow D$，非目标副反应为 $A \\rightarrow U$。假设采用质量作用动力学、速率常数服从阿伦尼乌斯温度依赖关系，且体积变化可忽略不计。动力学模型为\n- $\\dfrac{dC_{A}}{dt} = -k_{1}(T) C_{A} C_{B} - k_{2}(T) C_{A}$，\n- $\\dfrac{dC_{B}}{dt} = -k_{1}(T) C_{A} C_{B}$，\n- $\\dfrac{dC_{D}}{dt} = k_{1}(T) C_{A} C_{B}$，\n在 $t=0$ 时的初始条件为：$C_{A}(0) = C_{A,0}$，$C_{B}(0) = R\\, C_{A,0}$，$C_{D}(0)=0$。此处，$C_{i}$ 是浓度，单位为 $\\mathrm{mol\\cdot L^{-1}}$；时间 $t$ 的单位为 $\\mathrm{s}$；温度 $T$ 的单位为 $\\mathrm{K}$；$R$ 是初始摩尔比 $C_{B,0}/C_{A,0}$（无量纲）。速率常数遵循阿伦尼乌斯定律：\n- $k_{1}(T) = A_{1} \\exp\\!\\left(-\\dfrac{E_{1}}{R_{g} T}\\right)$，单位为 $\\mathrm{L\\cdot mol^{-1}\\cdot s^{-1}}$，\n- $k_{2}(T) = A_{2} \\exp\\!\\left(-\\dfrac{E_{2}}{R_{g} T}\\right)$，单位为 $\\mathrm{s^{-1}}$，\n其中 $A_{1}$ 和 $A_{2}$ 是指前因子，$E_{1}$ 和 $E_{2}$ 是活化能，单位为 $\\mathrm{J\\cdot mol^{-1}}$，$R_{g}$ 是通用气体常数。取 $R_{g} = 8.314462618\\ \\mathrm{J\\cdot mol^{-1}\\cdot K^{-1}}$。\n\n将产率定义为（以不带百分号的小数表示）在指定的最终时间 $t_{f}$ 时实际生成的 $D$ 的摩尔数，与在相同初始进料下，如果目标反应完全进行且无副反应发生时理论上可能生成的最大 $D$ 摩尔数之比。在恒定体积和上述化学计量关系下，该小数产率为\n$$y = \\frac{C_{D}(t_{f})}{\\min\\!\\left(C_{A,0},\\, C_{B,0}\\right)} = \\frac{C_{D}(t_{f})}{\\min\\!\\left(C_{A,0},\\, R\\,C_{A,0}\\right)}.$$\n\n速率常数、进料组成比和温度存在不确定性。通过对以下主要输入的独立正态分布来模拟这些不确定性：\n- $u_{1} = \\ln f_{1}$，其中 $f_{1}$ 在固定温度 $T$ 下对 $k_{1}$ 进行乘法缩放（因此有效 $k_{1}$ 为 $k_{1}(T)\\, e^{u_{1}}$），标准差为 $\\sigma_{u_{1}}$。\n- $u_{2} = \\ln f_{2}$，其中 $f_{2}$ 在固定温度 $T$ 下对 $k_{2}$ 进行乘法缩放（因此有效 $k_{2}$ 为 $k_{2}(T)\\, e^{u_{2}}$），标准差为 $\\sigma_{u_{2}}$。\n- $u_{3} = T$（单位为 $\\mathrm{K}$），标准差为 $\\sigma_{u_{3}}$。\n- $u_{4} = R$（无量纲），标准差为 $\\sigma_{u_{4}}$。\n\n假设这些输入在统计上是独立的且方差很小，因此一阶（线性）不确定性传播方法适用。使用在标称点 $(u_{1},u_{2},u_{3},u_{4}) = (0,0,T_{0},R_{0})$ 处的一阶泰勒展开，将 $y$ 的方差近似为\n$$\\operatorname{var}(y) \\approx \\sum_{i=1}^{4} \\left(\\frac{\\partial y}{\\partial u_{i}}\\right)^{2} \\sigma_{u_{i}}^{2},$$\n并将输入 $i$ 对输出方差的贡献定义为\n$$V_{i} = \\left(\\frac{\\partial y}{\\partial u_{i}}\\right)^{2} \\sigma_{u_{i}}^{2}.$$\n归一化贡献（一个分数）为 $p_{i} = V_{i} \\big/ \\sum_{j=1}^{4} V_{j}$。通过最大的 $p_{i}$ 确定主要贡献者。\n\n使用中心有限差分法在点 $(0,0,T_{0},R_{0})$ 周围数值估算偏导数，计算每个导数时保持其他输入固定。使用以下扰动步长：\n- 对于 $u_{1}$ 和 $u_{2}$：$h_{\\ln f} = 1.0\\times 10^{-4}$（无量纲）。\n- 对于 $u_{3}=T$：$h_{T} = 1.0\\times 10^{-2}\\ \\mathrm{K}$。\n- 对于 $u_{4}=R$：$h_{R} = 1.0\\times 10^{-4}$（无量纲）。\n\n使用能够处理刚性问题的求解器和严格的容差，将动力学常微分方程积分至 $t_{f}$，以使数值误差相对于不确定性效应可以忽略不计。使用绝对容差 $1.0\\times 10^{-12}$ 和相对容差 $1.0\\times 10^{-9}$。\n\n实现一个程序，对下面测试套件中的每一组参数，按此确切顺序计算对应于输入 $[u_{1},u_{2},u_{3},u_{4}] = [\\ln f_{1}, \\ln f_{2}, T, R]$ 的归一化方差贡献 $[p_{1},p_{2},p_{3},p_{4}]$。\n\n测试套件（每行定义一个案例；所有数值均采用指定的国际单位制单位）：\n- 案例 1：$A_{1} = 5.0\\times 10^{4}$，$E_{1} = 5.5\\times 10^{4}$，$A_{2} = 2.0\\times 10^{3}$，$E_{2} = 8.0\\times 10^{4}$，$T_{0} = 350$，$\\sigma_{u_{3}} = 1.0$，$C_{A,0} = 1.0$，$R_{0} = 1.0$，$\\sigma_{u_{4}} = 2.0\\times 10^{-2}$，$\\sigma_{u_{1}} = 1.0\\times 10^{-1}$，$\\sigma_{u_{2}} = 1.0\\times 10^{-1}$，$t_{f} = 100.0$。\n- 案例 2：$A_{1} = 3.0\\times 10^{4}$，$E_{1} = 6.0\\times 10^{4}$，$A_{2} = 1.0\\times 10^{3}$，$E_{2} = 7.0\\times 10^{4}$，$T_{0} = 330$，$\\sigma_{u_{3}} = 5.0\\times 10^{-1}$，$C_{A,0} = 2.0$，$R_{0} = 4.0\\times 10^{-1}$，$\\sigma_{u_{4}} = 1.0\\times 10^{-2}$，$\\sigma_{u_{1}} = 5.0\\times 10^{-2}$，$\\sigma_{u_{2}} = 5.0\\times 10^{-2}$，$t_{f} = 200.0$。\n- 案例 3：$A_{1} = 1.0\\times 10^{9}$，$E_{1} = 9.0\\times 10^{4}$，$A_{2} = 1.0\\times 10^{8}$，$E_{2} = 1.1\\times 10^{5}$，$T_{0} = 420$，$\\sigma_{u_{3}} = 2.0$，$C_{A,0} = 1.0$，$R_{0} = 1.2$，$\\sigma_{u_{4}} = 2.0\\times 10^{-2}$，$\\sigma_{u_{1}} = 3.0\\times 10^{-2}$，$\\sigma_{u_{2}} = 3.0\\times 10^{-2}$，$t_{f} = 100.0$。\n\n你的程序必须：\n- 使用上述物理模型和不确定性传播方法为每个案例计算 $[p_{1},p_{2},p_{3},p_{4}]$。\n- 在最终输出中将每个 $p_{i}$ 四舍五入到恰好六位小数，并确保它们按 $[\\ln f_{1}, \\ln f_{2}, T, R]$ 的顺序出现。\n- 生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个元素本身是针对一个测试案例的包含四个浮点数的列表（例如，`[[p_{1},p_{2},p_{3},p_{4}],\\,[\\cdots],\\,[\\cdots]]`）。\n\n所有量均以指定的国际单位制单位作答，并将产率和贡献表示为小数（不带百分号）。", "solution": "问题陈述经过验证，被认为是科学上合理的、适定的和完整的。它提出了一个化学反应工程中的标准问题，具体涉及反应器产率对不确定的动力学和操作参数的灵敏度分析。所采用的方法基于一阶不确定性传播和常微分方程（ODE）的数值解，是恰当且明确指定的。我们着手进行求解。\n\n该系统由一组耦合的非线性常微分方程控制，描述了在恒温、恒容的间歇式反应器中物种 $A$、$B$ 和 $D$ 的浓度变化率：\n$$\n\\begin{aligned}\n\\dfrac{dC_{A}}{dt} = -k_{1}(T) C_{A} C_{B} - k_{2}(T) C_{A} \\\\\n\\dfrac{dC_{B}}{dt} = -k_{1}(T) C_{A} C_{B} \\\\\n\\dfrac{dC_{D}}{dt} = -k_{1}(T) C_{A} C_{B}\n\\end{aligned}\n$$\n在时间 $t=0$ 时的初始条件为 $C_{A}(0) = C_{A,0}$，$C_{B}(0) = R \\cdot C_{A,0}$ 和 $C_{D}(0) = 0$。系统的状态是浓度向量 $[C_{A}(t), C_{B}(t), C_{D}(t)]$。\n\n速率常数 $k_{1}$ 和 $k_{2}$ 根据阿伦尼乌斯定律随温度变化：\n$$\nk_{1}(T) = A_{1} \\exp\\!\\left(-\\dfrac{E_{1}}{R_{g} T}\\right)\n$$\n$$\nk_{2}(T) = A_{2} \\exp\\!\\left(-\\dfrac{E_{2}}{R_{g} T}\\right)\n$$\n其中 $R_{g} = 8.314462618\\ \\mathrm{J\\cdot mol^{-1}\\cdot K^{-1}}$。\n\n我们关心的量是小数产率 $y$，定义为在最终时间 $t_{f}$ 时生成的目标产物 $D$ 的量与假设没有副反应发生时由限量反应物可能形成的最大 $D$ 的量之比。对于恒容系统，即为：\n$$\ny = \\frac{C_{D}(t_{f})}{\\min(C_{A,0}, C_{B,0})} = \\frac{C_{D}(t_{f})}{C_{A,0} \\min(1, R)}\n$$\n产率 $y$ 是系统参数和初始条件的函数。我们关心的是它对四个不确定输入的灵敏度：$u_{1} = \\ln f_{1}$（$k_{1}$ 上的对数因子）、$u_{2} = \\ln f_{2}$（$k_{2}$ 上的对数因子）、$u_{3} = T$（温度）和 $u_{4} = R$（初始摩尔比）。因此，产率函数表示为 $y(u_{1}, u_{2}, u_{3}, u_{4})$。问题指定乘法因子 $f_{1}$ 和 $f_{2}$ 应用于速率常数，使得有效速率常数为 $k_{1,eff} = k_{1}(T) \\exp(u_{1})$ 和 $k_{2,eff} = k_{2}(T) \\exp(u_{2})$。\n\n该分析采用一阶泰勒级数近似来计算产率的方差，这在不确定性较小的情况下是有效的。总方差通过来自每个独立输入的贡献之和来近似：\n$$\n\\operatorname{var}(y) \\approx \\sum_{i=1}^{4} V_{i}, \\quad \\text{其中} \\quad V_{i} = \\left(\\frac{\\partial y}{\\partial u_{i}}\\right)^{2} \\sigma_{u_{i}}^{2}\n$$\n偏导数在标称点 $(u_{1}, u_{2}, u_{3}, u_{4}) = (0, 0, T_{0}, R_{0})$ 处进行评估。来自输入 $i$ 的归一化贡献为：\n$$\np_{i} = \\frac{V_{i}}{\\sum_{j=1}^{4} V_{j}}\n$$\n\n求解策略如下：\n1.  对于每个测试案例，定义一个函数，用于计算给定输入集 $(u_{1}, u_{2}, T, R)$ 下的产率 $y$。我们称此函数为 `calculate_yield`，它将执行以下操作：\n    a. 使用给定的温度 $T$ 和对数因子 $u_{1}, u_{2}$ 计算有效速率常数 $k_{1,eff}$ 和 $k_{2,eff}$。\n    b. 设置初始条件 $[C_{A,0}, R \\cdot C_{A,0}, 0]$。请注意，$B$ 的初始浓度取决于输入 $R$。\n    c. 使用能够处理刚性问题的求解器（`scipy.integrate.solve_ivp`，方法为 `method='BDF'`）和指定的容差（`rtol=10^{-9}`，`atol=10^{-12}`），将常微分方程系统从 $t=0$ 积分到 $t=t_{f}$。\n    d. 从解中提取产物 $D$ 的最终浓度 $C_{D}(t_{f})$。\n    e. 根据其定义计算产率 $y$。关键是要注意，分母 $\\min(C_{A,0}, R \\cdot C_{A,0})$ 也取决于输入 $R$。在评估关于 $R$ 的导数时，必须正确处理这种依赖关系。\n\n2.  使用二阶中心有限差分格式在标称点 $(0, 0, T_{0}, R_{0})$ 处数值估算偏导数 $\\frac{\\partial y}{\\partial u_{i}}$。对于每个输入 $u_{i}$：\n    $$\n    \\frac{\\partial y}{\\partial u_{i}} \\approx \\frac{y(\\dots, u_{i,0} + h_{i}, \\dots) - y(\\dots, u_{i,0} - h_{i}, \\dots)}{2h_{i}}\n    $$\n    其中 $u_{i,0}$ 是输入的标称值，$h_i$ 是相应的指定步长（$h_{\\ln f}$，$h_T$ 或 $h_R$）。对于每个导数，只有一个输入被扰动，而其他输入则保持其标称值。例如，为了求 $\\frac{\\partial y}{\\partial T}$：\n    $$\n    \\frac{\\partial y}{\\partial T} \\approx \\frac{\\text{calculate\\_yield}(0, 0, T_{0}+h_{T}, R_{0}) - \\text{calculate\\_yield}(0, 0, T_{0}-h_{T}, R_{0})}{2h_{T}}\n    $$\n\n3.  计算出偏导数后，使用给定的标准差 $\\sigma_{u_{i}}$ 计算未缩放的方差贡献 $V_{i}$。\n\n4.  将各贡献相加，求得总近似方差 $\\sum V_{j}$。\n\n5.  计算归一化方差贡献 $p_{i} = V_{i} / \\sum V_{j}$。\n\n6.  对问题陈述中指定的每个测试案例重复此过程。最终结果按要求格式化。该实现将使用 `numpy` 进行数值运算，并使用 `scipy.integrate` 求解常微分方程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    It calculates the normalized variance contributions for the yield of a chemical reaction\n    with respect to uncertainties in kinetic and operational parameters.\n    \"\"\"\n    # Universal gas constant in J/(mol*K)\n    R_g = 8.314462618\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1\n        {'A1': 5.0e4, 'E1': 5.5e4, 'A2': 2.0e3, 'E2': 8.0e4, 'T0': 350.0, 'sigma_u3': 1.0, \n         'CA0': 1.0, 'R0': 1.0, 'sigma_u4': 2.0e-2, 'sigma_u1': 1.0e-1, 'sigma_u2': 1.0e-1, 'tf': 100.0},\n        # Case 2\n        {'A1': 3.0e4, 'E1': 6.0e4, 'A2': 1.0e3, 'E2': 7.0e4, 'T0': 330.0, 'sigma_u3': 0.5, \n         'CA0': 2.0, 'R0': 0.4, 'sigma_u4': 1.0e-2, 'sigma_u1': 5.0e-2, 'sigma_u2': 5.0e-2, 'tf': 200.0},\n        # Case 3\n        {'A1': 1.0e9, 'E1': 9.0e4, 'A2': 1.0e8, 'E2': 1.1e5, 'T0': 420.0, 'sigma_u3': 2.0, \n         'CA0': 1.0, 'R0': 1.2, 'sigma_u4': 2.0e-2, 'sigma_u1': 3.0e-2, 'sigma_u2': 3.0e-2, 'tf': 100.0}\n    ]\n\n    # Perturbation step sizes for finite differences\n    h_lnf = 1.0e-4\n    h_T = 1.0e-2\n    h_R = 1.0e-4\n\n    all_results = []\n\n    def ode_system(t, C, k1, k2):\n        \"\"\"Defines the ODE system for the reaction kinetics.\"\"\"\n        CA, CB, CD = C\n        dCA_dt = -k1 * CA * CB - k2 * CA\n        dCB_dt = -k1 * CA * CB\n        dCD_dt = k1 * CA * CB\n        return [dCA_dt, dCB_dt, dCD_dt]\n\n    def calculate_yield(u1, u2, T, R, case_params):\n        \"\"\"\n        Calculates the yield for a given set of inputs (u1, u2, T, R).\n        This function integrates the ODEs and computes the final yield.\n        \"\"\"\n        # Unpack parameters\n        A1, E1, A2, E2 = case_params['A1'], case_params['E1'], case_params['A2'], case_params['E2']\n        CA0, tf = case_params['CA0'], case_params['tf']\n\n        # Calculate effective rate constants\n        k1_base = A1 * np.exp(-E1 / (R_g * T))\n        k2_base = A2 * np.exp(-E2 / (R_g * T))\n        k1_eff = k1_base * np.exp(u1)\n        k2_eff = k2_base * np.exp(u2)\n\n        # Initial conditions\n        CB0 = R * CA0\n        C0 = [CA0, CB0, 0.0]\n\n        # Solve the ODE system\n        sol = solve_ivp(\n            ode_system, \n            [0, tf], \n            C0, \n            method='BDF', \n            args=(k1_eff, k2_eff), \n            rtol=1.0e-9, \n            atol=1.0e-12\n        )\n        \n        # Extract final concentration of desired product\n        CD_final = sol.y[2, -1]\n\n        # Calculate theoretical maximum moles of D\n        # Note: This denominator depends on the input R\n        theo_max_moles_D = np.min([CA0, CB0])\n        \n        # Handle case where denominator is zero\n        if theo_max_moles_D == 0:\n            return 0.0\n\n        yield_val = CD_final / theo_max_moles_D\n        return yield_val\n\n    for case in test_cases:\n        T0, R0 = case['T0'], case['R0']\n\n        # --- Calculate partial derivatives using central finite differences ---\n        \n        # Derivative wrt u1 = ln(f1)\n        y_plus_u1 = calculate_yield(h_lnf, 0, T0, R0, case)\n        y_minus_u1 = calculate_yield(-h_lnf, 0, T0, R0, case)\n        dyd_u1 = (y_plus_u1 - y_minus_u1) / (2 * h_lnf)\n\n        # Derivative wrt u2 = ln(f2)\n        y_plus_u2 = calculate_yield(0, h_lnf, T0, R0, case)\n        y_minus_u2 = calculate_yield(0, -h_lnf, T0, R0, case)\n        dyd_u2 = (y_plus_u2 - y_minus_u2) / (2 * h_lnf)\n\n        # Derivative wrt u3 = T\n        y_plus_u3 = calculate_yield(0, 0, T0 + h_T, R0, case)\n        y_minus_u3 = calculate_yield(0, 0, T0 - h_T, R0, case)\n        dyd_u3 = (y_plus_u3 - y_minus_u3) / (2 * h_T)\n\n        # Derivative wrt u4 = R\n        y_plus_u4 = calculate_yield(0, 0, T0, R0 + h_R, case)\n        y_minus_u4 = calculate_yield(0, 0, T0, R0 - h_R, case)\n        dyd_u4 = (y_plus_u4 - y_minus_u4) / (2 * h_R)\n\n        # --- Calculate variance contributions ---\n        \n        sensitivities = np.array([dyd_u1, dyd_u2, dyd_u3, dyd_u4])\n        sigmas = np.array([case['sigma_u1'], case['sigma_u2'], case['sigma_u3'], case['sigma_u4']])\n        \n        variances_V = (sensitivities**2) * (sigmas**2)\n        \n        total_variance = np.sum(variances_V)\n        \n        if total_variance > 0:\n            normalized_contributions_p = variances_V / total_variance\n        else:\n            normalized_contributions_p = np.array([0.0, 0.0, 0.0, 0.0])\n            \n        # Round results to 6 decimal places\n        p_rounded = [round(p, 6) for p in normalized_contributions_p]\n        all_results.append(p_rounded)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```", "id": "2949897"}]}