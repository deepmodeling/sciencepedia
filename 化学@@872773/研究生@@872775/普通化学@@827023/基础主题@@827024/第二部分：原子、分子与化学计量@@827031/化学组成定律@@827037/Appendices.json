{"hands_on_practices": [{"introduction": "化学组成定律最初是基于质量关系建立的，例如倒易律。本练习旨在通过现代理论加深您对这些基本定律的理解。您需要将基于质量的倒易律，使用摩尔概念和现代原子量，重新表述为一个关于物质的量（摩尔）比例的等价陈述 ([@problem_id:2943623])。这项实践不仅能巩固化学计量的核心原理，还能展示如何将历史上的定性观察转化为精确的、以原子理论为基础的定量框架。", "problem": "十九世纪关于互比定律的陈述断言，如果两种元素分别与第三种元素的固定质量相结合，那么与第三种元素的固定质量相结合的那两种元素的质量，与这两种元素相互结合时的质量相同，或者是其简单倍数。利用摩尔概念和现代原子量，这个基于质量的定性定律可以被改写为关于物质的量比的等效陈述。你的任务是 (i) 从基本原理出发，构筑这样一个摩尔比版本，以及 (ii) 将其应用于由分析确定其组成的三个特定化合物。\n\n使用以下基本依据：质量守恒、物质的量（摩尔）的定义、摩尔质量的定义，以及化学计量式中的整数原子假说。避免引用或使用任何未从这些基础推导出的简便公式。\n\n本问题的数据和定义：\n- 所使用的原子（摩尔）质量为：铈 $\\left(\\mathrm{Ce}\\right)$ $M_{\\mathrm{Ce}} = 140.116\\ \\mathrm{g\\ mol^{-1}}$，溴 $\\left(\\mathrm{Br}\\right)$ $M_{\\mathrm{Br}} = 79.904\\ \\mathrm{g\\ mol^{-1}}$，氧 $\\left(\\mathrm{O}\\right)$ $M_{\\mathrm{O}} = 15.999\\ \\mathrm{g\\ mol^{-1}}$。\n- 化合物I是一种铈的氧化物，其质量组成为 $\\mathrm{Ce}$ $85.375\\,\\%$ 和 $\\mathrm{O}$ $14.625\\,\\%$。\n- 化合物II是一种溴的氧化物，其质量组成为 $\\mathrm{Br}$ $66.656\\,\\%$ 和 $\\mathrm{O}$ $33.344\\,\\%$。\n- 化合物III是一种铈的溴化物，其质量组成为 $\\mathrm{Ce}$ $74.520\\,\\%$ 和 $\\mathrm{Br}$ $25.480\\,\\%$。\n\n任务：\n1. 从所述基础出发，用摩尔比的形式重新表述互比定律。你的陈述应涉及化合物I中每摩尔$\\mathrm{O}$中$\\mathrm{Ce}$的摩尔数之比，以及化合物II中每摩尔$\\mathrm{O}$中$\\mathrm{Br}$的摩尔数之比，并将其与化合物III的实验式$\\mathrm{Ce}_p\\mathrm{Br}_q$中的化学计量系数联系起来。\n2. 使用你的摩尔比陈述，并仅利用给定的组成和原子质量，确定与数据一致的最小正整数$p$和$q$。作为一个单数值答案，报告$p+q$的值。答案表示为无单位的精确整数。不要四舍五入。", "solution": "该问题被验证为具有科学依据、问题明确且客观。所有数据均已提供且内部一致。该任务是化学计量学原理的标准应用。\n\n问题分为两个任务：(i) 用摩尔比重新表述互比定律，以及 (ii) 应用此表述来确定一种铈-溴化合物的实验式。\n\n**第(i)部分：互比定律摩尔比版本的构筑**\n\n设有三种元素，我们将其表示为$A$、$B$和$C$。在这个具体问题中，$A$是铈($\\mathrm{Ce}$)，$B$是溴($\\mathrm{Br}$)，$C$是氧($\\mathrm{O}$)。\n对于任何元素或化合物，物质的量$n$（单位为摩尔）、质量$m$和摩尔质量$M$之间的基本关系是：\n$$ n = \\frac{m}{M} $$\n这个关系是摩尔和摩尔质量定义的直接推论。整数原子假说指出，原子以简单的整数比结合，这意味着在实验式（如$A_pB_q$）中的化学计量系数$p$和$q$是整数。\n\n考虑由元素$A$和$C$组成的化合物I。从给定的质量组成（质量百分比$\\%A_{\\text{I}}$和$\\%C_{\\text{I}}$），可以通过考虑任意样品质量来找到$A$与$C$的物质的量之比，该样品质量在比率中被消去：\n$$ \\left(\\frac{n_A}{n_C}\\right)_{\\text{I}} = \\frac{m_A / M_A}{m_C / M_C} = \\frac{(\\%A_{\\text{I}}) / M_A}{(\\%C_{\\text{I}}) / M_C} $$\n这个比率代表在化合物I中每摩尔元素$C$结合的元素$A$的摩尔数。\n\n类似地，对于由元素$B$和$C$组成的化合物II，其质量百分比为$\\%B_{\\text{II}}$和$\\%C_{\\text{II}}$：\n$$ \\left(\\frac{n_B}{n_C}\\right)_{\\text{II}} = \\frac{m_B / M_B}{m_C / M_C} = \\frac{(\\%B_{\\text{II}}) / M_B}{(\\%C_{\\text{II}}) / M_C} $$\n这个比率代表在化合物II中每摩尔元素$C$结合的元素$B$的摩尔数。\n\n原始定律考虑的是与*固定质量*的$C$结合的$A$和$B$的质量。现代的等效做法是考虑与*固定物质的量*的$C$（例如$1\\ \\mathrm{mol}$）结合的$A$和$B$的摩尔数。这些$A$和$B$的物质的量之比是$A$和$B$的一个预测结合比：\n$$ R_{\\text{predicted}} = \\frac{\\text{每摩尔 } C \\text{ 中 } A \\text{ 的摩尔数}}{\\text{每摩尔 } C \\text{ 中 } B \\text{ 的摩尔数}} = \\frac{(n_A/n_C)_{\\text{I}}}{(n_B/n_C)_{\\text{II}}} $$\n现在考虑实验式为$A_pB_q$的化合物III。其物质的量之比$p/q$由其质量组成$\\%A_{\\text{III}}$和$\\%B_{\\text{III}}$确定：\n$$ \\frac{p}{q} = \\left(\\frac{n_A}{n_B}\\right)_{\\text{III}} = \\frac{(\\%A_{\\text{III}}) / M_A}{(\\%B_{\\text{III}}) / M_B} $$\n互比定律断言，两种元素结合的比例与它们分别同第三种元素结合的质量比有简单的关系。由倍比定律所支配的多种氧化态或化合价能力的存在，引入了“简单倍数”的可能性。转换到摩尔，化合物III中的摩尔比$p/q$与预测比率$R_{\\text{predicted}}$通过一个简单的有理数相关联，我们将其表示为$j/k$，其中$j$和$k$是小整数。\n\n因此，该定律的正式摩尔比表述为：\n$$ \\frac{p}{q} = \\frac{j}{k} \\times \\frac{(n_A/n_C)_{\\text{I}}}{(n_B/n_C)_{\\text{II}}} $$\n在本问题的背景下，$A = \\mathrm{Ce}$，$B = \\mathrm{Br}$，$C = \\mathrm{O}$，公式为：\n$$ \\frac{p}{q} = \\frac{j}{k} \\times \\frac{(n_{\\mathrm{Ce}}/n_{\\mathrm{O}})_{\\text{I}}}{(n_{\\mathrm{Br}}/n_{\\mathrm{O}})_{\\text{II}}} $$\n这就是所要求的表述。\n\n**第(ii)部分：应用以确定$p$和$q$**\n\n我们给出了以下数据：\n$M_{\\mathrm{Ce}} = 140.116\\ \\mathrm{g\\ mol^{-1}}$\n$M_{\\mathrm{Br}} = 79.904\\ \\mathrm{g\\ mol^{-1}}$\n$M_{\\mathrm{O}} = 15.999\\ \\mathrm{g\\ mol^{-1}}$\n\n首先，我们根据化合物I和化合物II的组成计算所需的摩尔比。\n对于化合物I（铈的氧化物，$\\mathrm{Ce}\\ 85.375\\,\\%$，$\\mathrm{O}\\ 14.625\\,\\%$）：\n$$ \\left(\\frac{n_{\\mathrm{Ce}}}{n_{\\mathrm{O}}}\\right)_{\\text{I}} = \\frac{85.375 / M_{\\mathrm{Ce}}}{14.625 / M_{\\mathrm{O}}} = \\frac{85.375 / 140.116}{14.625 / 15.999} = \\frac{0.6093108}{0.9141196} = 0.666551 $$\n对于化合物II（溴的氧化物，$\\mathrm{Br}\\ 66.656\\,\\%$，$\\mathrm{O}\\ 33.344\\,\\%$）：\n$$ \\left(\\frac{n_{\\mathrm{Br}}}{n_{\\mathrmO}}\\right)_{\\text{II}} = \\frac{66.656 / M_{\\mathrm{Br}}}{33.344 / M_{\\mathrmO}} = \\frac{66.656 / 79.904}{33.344 / 15.999} = \\frac{0.8342010}{2.0841303} = 0.400262 $$\n现在我们计算铈和溴结合的预测比率$R_{\\text{predicted}}$：\n$$ R_{\\text{predicted}} = \\frac{(n_{\\mathrm{Ce}}/n_{\\mathrm{O}})_{\\text{I}}}{(n_{\\mathrm{Br}}/n_{\\mathrm{O}})_{\\text{II}}} = \\frac{0.666551}{0.400262} = 1.665258 $$\n接下来，我们从化合物III（铈的溴化物，$\\mathrm{Ce}\\ 74.520\\,\\%$，$\\mathrm{Br}\\ 25.480\\,\\%$）的组成计算实验摩尔比$p/q$：\n$$ \\frac{p}{q} = \\left(\\frac{n_{\\mathrm{Ce}}}{n_{\\mathrm{Br}}}\\right)_{\\text{III}} = \\frac{74.520 / M_{\\mathrm{Ce}}}{25.480 / M_{\\mathrm{Br}}} = \\frac{74.520 / 140.116}{25.480 / 79.904} = \\frac{0.531849}{0.318883} = 1.667873 $$\n根据定律，这两个比率必须通过一个简单的有理数$j/k$相关联：\n$$ \\frac{p}{q} = \\frac{j}{k} \\times R_{\\text{predicted}} $$\n$$ 1.667873 = \\frac{j}{k} \\times 1.665258 $$\n我们求解因子$j/k$：\n$$ \\frac{j}{k} = \\frac{1.667873}{1.665258} = 1.001570 $$\n这个值非常接近$1$。因此，数据与$j=1$和$k=1$一致。这表明化合当量在这些化合物之间是直接可转换的。\n问题简化为找到与实验确定的值$1.667873$相对应的最简整数比$p/q$。这个值非常接近有理数$5/3$：\n$$ \\frac{5}{3} = 1.6666... $$\n实验比率与$5/3$的偏差小于$0.08\\,\\%$，这完全在成分分析的实验不确定度范围内。\n因此，我们得出结论，与数据一致的最小正整数$p$和$q$之比为：\n$$ \\frac{p}{q} = \\frac{5}{3} $$\n这得出$p=5$和$q=3$。\n问题要求计算$p+q$的和。\n$$ p+q = 5 + 3 = 8 $$\n这个结果严格基于所提供的数据和化学计量学定律的逻辑应用，符合要求。", "answer": "$$ \\boxed{8} $$", "id": "2943623"}, {"introduction": "从理想的化学计量定律过渡到它们在真实场景中的应用，我们经常会遇到更复杂的情况。本练习探讨了在化学平衡（$2\\text{NO}_2(\\text{g}) \\rightleftharpoons \\text{N}_2\\text{O}_4(\\text{g})$）和非理想气体行为的背景下，气体化合体积定律的应用 ([@problem_id:2943535])。它强调了宏观观测属性（如体积比）由于反应不完全和分子间作用力等因素，并不总是直接反映潜在的分子化学计量关系，这要求我们运用热力学和真实气体理论进行更深入的分析。", "problem": "一位实验者试图使用恒温恒压气体滴定管来验证缔合反应 $2\\,\\mathrm{NO_2(g)} \\rightleftharpoons \\mathrm{N_2O_4(g)}$ 的气体化合体积定律。一个含有固定量二氧化氮结构单元（每个单元为一个 $\\mathrm{NO_2}$ 化学式单位）的样品，在 $T=298.15\\ \\mathrm{K}$ 和 $P=1.000\\ \\mathrm{bar}$ 条件下达到平衡。该实验者天真地将平衡体积 $V_{\\mathrm{eq}}$ 与相同数量的结构单元在相同 $T$ 和 $P$ 条件下（若所有物种均为单体 $\\mathrm{NO_2}$）所占据的参考体积 $V_{\\mathrm{mono}}$ 进行比较，并将比值 $V_{\\mathrm{eq}}/V_{\\mathrm{mono}}$ 解释为化学计量比为 2:1 的“观测化合体积比”。\n\n为分析此问题，采用以下基本依据和数据（均在 $T=298.15\\ \\mathrm{K}$， $P=1.000\\ \\mathrm{bar}$ 条件下）：\n\n- 该缔合反应的基于逸度的平衡常数（标准态为 $1\\ \\mathrm{bar}$）为 $K_p^{\\mathrm{assoc}}=6.60\\ \\mathrm{bar^{-1}}$。\n- 对于非理想行为，使用对混合物截断至第二维里项的维里状态方程 (EOS)：混合物压缩因子为 $Z=1+B_{\\mathrm{mix}}P/(RT)$，其中 $B_{\\mathrm{mix}}=\\sum_i\\sum_j y_i y_j B_{ij}$，$y_i$ 是摩尔分数，$B_{ij}$ 是第二维里系数。逸度系数在 $P$ 的一阶近似下满足 $\\ln\\phi_i=\\bigl(2\\sum_j y_j B_{ij}-B_{\\mathrm{mix}}\\bigr)P/(RT)$。\n- 非零的第二维里系数（单位为 $\\mathrm{L\\ mol^{-1}}$）为 $B_{11}(\\mathrm{NO_2\\text{-}NO_2})=-0.120$，$B_{22}(\\mathrm{N_2O_4\\text{-}N_2O_4})=-0.400$，以及 $B_{12}(\\mathrm{NO_2\\text{-}N_2O_4})=-0.220$。\n- 在一致单位下的气体常数为 $R=0.08314\\ \\mathrm{L\\ bar\\ mol^{-1}\\ K^{-1}}$。\n\n令 $y_{\\mathrm{m}}$ 表示单体 $\\mathrm{NO_2}$ 的平衡摩尔分数，$y_{\\mathrm{d}}=1-y_{\\mathrm{m}}$ 表示二聚体 $\\mathrm{N_2O_4}$ 的平衡摩尔分数。一摩尔的 $\\mathrm{N_2O_4}$ 含有两个结构单元，因此当发生缔合时，分子的总摩尔数 $n_{\\mathrm{tot}}$ 小于结构单元的摩尔数 $n_{\\mathrm{u}}$。\n\n下列哪项陈述最好地解释了观测到的 $V_{\\mathrm{eq}}/V_{\\mathrm{mono}}$ 与理想的 2:1 化合体积比之间的偏差，并与潜在的分子化学计量关系相协调，同时在量上与上述 $T=298.15\\ \\mathrm{K}$ 和 $P=1.000\\ \\mathrm{bar}$ 条件下的数据一致？\n\nA. $V_{\\mathrm{eq}}/V_{\\mathrm{mono}}=0.500$（精确值）；气体化合体积定律无需任何修正即成立，因为化学计量系数直接决定体积。\n\nB. 在理想气体近似下，$P=1.000\\ \\mathrm{bar}$ 时 $V_{\\mathrm{eq}}/V_{\\mathrm{mono}}\\approx 0.596$；在此压力下非理想性可以忽略，因此与 0.500 的偏差完全源于不完全缔合，但气体化合体积定律被根本上违背了。\n\nC. 在理想气体近似下，根据平衡组分，在 $P=1.000\\ \\mathrm{bar}$ 时 $V_{\\mathrm{eq}}/V_{\\mathrm{mono}}\\approx 0.596$；包含给定的第二维里非理想性后，该比值大约减小 $0.7\\%$（至约 0.592），这表明与 0.500 的偏差主要归因于不完全缔合，外加一个小的真实气体校正。在低压极限和/或在缔合反应完全的条件下，2:1 的化学计量体积比会得到恢复，因此该定律并未被违背。\n\nD. 在 $P=1.000\\ \\mathrm{bar}$ 时 $V_{\\mathrm{eq}}/V_{\\mathrm{mono}}>1$，因为缔合增加了排斥相互作用，使气体膨胀；因此非理想效应改变了有效化学计量系数，化合体积概念不适用。", "solution": "问题陈述已提交验证。\n\n### 步骤 1：提取已知条件\n-   **反应**：$2\\,\\mathrm{NO_2(g)} \\rightleftharpoons \\mathrm{N_2O_4(g)}$\n-   **条件**：恒温 $T=298.15\\ \\mathrm{K}$，恒压 $P=1.000\\ \\mathrm{bar}$。\n-   **平衡常数**：$K_p^{\\mathrm{assoc}} \\equiv K_f = 6.60\\ \\mathrm{bar^{-1}}$（基于逸度，标准态 $1\\ \\mathrm{bar}$）。\n-   **状态方程**：截断至第二系数的维里 EOS，$Z=1+B_{\\mathrm{mix}}P/(RT)$。\n-   **B 的混合规则**：$B_{\\mathrm{mix}}=\\sum_i\\sum_j y_i y_j B_{ij}$。\n-   **逸度系数**：$\\ln\\phi_i=\\bigl(2\\sum_j y_j B_{ij}-B_{\\mathrm{mix}}\\bigr)P/(RT)$。\n-   **维里系数**（在 $T=298.15\\ \\mathrm{K}$，单位 $\\mathrm{L\\ mol^{-1}}$）：$B_{11}(\\mathrm{NO_2\\text{-}NO_2})=-0.120$，$B_{22}(\\mathrm{N_2O_4\\text{-}N_2O_4})=-0.400$，以及 $B_{12}(\\mathrm{NO_2\\text{-}N_2O_4})=-0.220$。（$1$ 表示 $\\mathrm{NO_2}$，$2$ 表示 $\\mathrm{N_2O_4}$）。\n-   **气体常数**：$R=0.08314\\ \\mathrm{L\\ bar\\ mol^{-1}\\ K^{-1}}$。\n-   **定义**：$y_{\\mathrm{m}}$ 是单体 $\\mathrm{NO_2}$ 的摩尔分数（$y_1$），$y_{\\mathrm{d}}$ 是二聚体 $\\mathrm{N_2O_4}$ 的摩尔分数（$y_2$）。$n_{\\mathrm{u}}$ 是 $\\mathrm{NO_2}$ 结构单元的摩尔数。$n_{\\mathrm{tot}}$ 是平衡时气体的总摩尔数。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据。反应 $2\\,\\mathrm{NO_2} \\rightleftharpoons \\mathrm{N_2O_4}$ 是化学平衡的一个经典例子。给定的平衡常数 $K_f=6.60\\ \\mathrm{bar^{-1}}$ (在 $T=298.15\\ \\mathrm{K}$) 与标准热力学数据（$\\Delta_r G^\\circ \\approx -4.7\\ \\mathrm{kJ\\ mol^{-1}}$）一致。维里状态方程以及混合物性质和逸度系数的相关表达式是化学热力学中用于描述轻微非理想性的标准方法。所提供的第二维里系数的值在物理上是合理的；它们为负值，表明吸引力占主导地位，并且对于这种尺寸的分子在此温度下，其量值是合理的。该问题提法得当，为定量分析提供了所有必要的数据。语言客观而精确。\n\n### 步骤 3：结论与行动\n该问题是有效的。将推导出解答。\n\n### 推导与分析\n要分析的量是比值 $V_{\\mathrm{eq}}/V_{\\mathrm{mono}}$。\n$V_{\\mathrm{mono}}$ 是 $n_{\\mathrm{u}}$ 摩尔纯的、不反应的 $\\mathrm{NO_2}$ 单体气体在压力 $P$ 和温度 $T$ 下所占据的体积。使用维里方程，$V_{\\mathrm{mono}} = n_{\\mathrm{u}} Z_{1} \\frac{RT}{P}$，其中 $Z_{1} = 1 + B_{11} \\frac{P}{RT}$。\n$V_{\\mathrm{eq}}$ 是含有 $n_{\\mathrm{u}}$ 摩尔结构单元的平衡气体混合物的体积。气体粒子的总摩尔数为 $n_{\\mathrm{tot}}$。其体积为 $V_{\\mathrm{eq}} = n_{\\mathrm{tot}} Z_{\\mathrm{mix}} \\frac{RT}{P}$，其中 $Z_{\\mathrm{mix}} = 1 + B_{\\mathrm{mix}} \\frac{P}{RT}$。\n\n因此，该比值为 $\\frac{V_{\\mathrm{eq}}}{V_{\\mathrm{mono}}} = \\frac{n_{\\mathrm{tot}} Z_{\\mathrm{mix}}}{n_{\\mathrm{u}} Z_{1}}$。\n\n让我们将 $n_{\\mathrm{tot}}$ 与 $n_{\\mathrm{u}}$ 联系起来。一个含有 $n_{\\mathrm{u}}$ 摩尔结构单元的系统，在平衡时将含有 $n_1$ 摩尔的 $\\mathrm{NO_2}$ 和 $n_2$ 摩尔的 $\\mathrm{N_2O_4}$。结构单元守恒决定了 $n_{\\mathrm{u}} = n_1 + 2n_2$。总摩尔数为 $n_{\\mathrm{tot}} = n_1 + n_2$。摩尔比为：\n$$ \\frac{n_{\\mathrm{tot}}}{n_{\\mathrm{u}}} = \\frac{n_1 + n_2}{n_1 + 2n_2} = \\frac{(n_1+n_2)/n_{\\mathrm{tot}}}{(n_1+2n_2)/n_{\\mathrm{tot}}} = \\frac{1}{y_1 + 2y_2} $$\n由于 $y_1+y_2 = 1$，我们可以将其写为 $\\frac{n_{\\mathrm{tot}}}{n_{\\mathrm{u}}} = \\frac{1}{y_1 + 2(1-y_1)} = \\frac{1}{2-y_1}$。此处，$y_1 \\equiv y_{\\mathrm{m}}$ 且 $y_2 \\equiv y_{\\mathrm{d}}$。\n\n问题的核心是求出平衡摩尔分数 $y_1$。\n\n**1. 理想气体近似**\n在此近似下，所有逸度系数均为 1（$\\phi_i=1$），所有压缩因子也均为 1（$Z=1$）。基于逸度的平衡常数 $K_f$ 变得等同于基于分压的常数 $K_P$。\n$$ K_f \\approx K_P = \\frac{p_2}{p_1^2} = \\frac{y_2 P}{(y_1 P)^2} = \\frac{y_2}{y_1^2 P} $$\n已知 $K_f = 6.60\\ \\mathrm{bar^{-1}}$ 和 $P=1.000\\ \\mathrm{bar}$，我们有：\n$$ 6.60 = \\frac{1-y_1}{y_1^2} \\implies 6.60 y_1^2 + y_1 - 1 = 0 $$\n解此二次方程求 $y_1 > 0$：\n$$ y_1 = \\frac{-1 + \\sqrt{1^2 - 4(6.60)(-1)}}{2(6.60)} = \\frac{-1 + \\sqrt{27.4}}{13.2} \\approx \\frac{-1+5.2345}{13.2} \\approx 0.3208 $$\n在理想气体近似下，体积比为：\n$$ \\frac{V_{\\mathrm{eq}}^{\\mathrm{ideal}}}{V_{\\mathrm{mono}}^{\\mathrm{ideal}}} = \\frac{n_{\\mathrm{tot}}}{n_{\\mathrm{u}}} = \\frac{1}{2-y_1} = \\frac{1}{2-0.3208} = \\frac{1}{1.6792} \\approx 0.5955 $$\n该值约为 0.596。\n\n**2. 真实气体（维里 EOS）分析**\n完整的平衡条件是 $K_f = \\frac{\\phi_2 y_2 P}{(\\phi_1 y_1 P)^2} = \\frac{K_\\phi K_y}{P}$，其中 $K_y = \\frac{y_2}{y_1^2}$ 且 $K_\\phi = \\frac{\\phi_2}{\\phi_1^2}$。\n$$ K_f P = K_\\phi K_y $$\n我们必须计算 $K_\\phi$。\n$$ \\ln K_\\phi = \\ln\\phi_2 - 2\\ln\\phi_1 $$\n使用给定的表达式 $\\ln\\phi_i=\\bigl(2\\sum_j y_j B_{ij}-B_{\\mathrm{mix}}\\bigr)P/(RT)$：\n$$ \\ln K_\\phi = \\frac{P}{RT} \\left[ \\left(2(y_1 B_{12} + y_2 B_{22}) - B_{\\mathrm{mix}}\\right) - 2\\left(2(y_1 B_{11} + y_2 B_{12}) - B_{\\mathrm{mix}}\\right) \\right] $$\n$$ \\ln K_\\phi = \\frac{P}{RT} \\left[ 2y_2 B_{22} - 4y_1 B_{11} + (2y_1 - 4y_2)B_{12} + B_{\\mathrm{mix}} \\right] $$\n我们使用理想气体组分（$y_1 \\approx 0.3208$, $y_2 \\approx 0.6792$）作为初步估计。\n$T=298.15\\ \\mathrm{K}$, $P=1.000\\ \\mathrm{bar}$, $R=0.08314\\ \\mathrm{L\\ bar\\ mol^{-1}\\ K^{-1}}$，所以 $RT = 24.79\\ \\mathrm{L\\ bar\\ mol^{-1}}$ 且 $P/RT = 0.04034\\ \\mathrm{mol\\ L^{-1}}$。\n$B_{11}=-0.120$, $B_{22}=-0.400$, $B_{12}=-0.220$，单位为 $\\mathrm{L\\ mol^{-1}}$。\n首先，计算 $B_{\\mathrm{mix}}$：\n$$ B_{\\mathrm{mix}} = (0.3208)^2(-0.120) + 2(0.3208)(0.6792)(-0.220) + (0.6792)^2(-0.400) \\approx -0.2928\\ \\mathrm{L\\ mol^{-1}} $$\n现在，计算 $\\ln K_\\phi$ 的方括号中的项：\n$$ [ 2(0.6792)(-0.400) - 4(0.3208)(-0.120) + (2(0.3208)-4(0.6792))(-0.220) - 0.2928 ] $$\n$$ \\approx [-0.5434 + 0.1540 + 0.4565 - 0.2928] = -0.2257\\ \\mathrm{L\\ mol^{-1}} $$\n$$ \\ln K_\\phi \\approx (0.04034\\ \\mathrm{mol\\ L^{-1}})(-0.2257\\ \\mathrm{L\\ mol^{-1}}) \\approx -0.00910 \\implies K_\\phi \\approx e^{-0.00910} \\approx 0.9909 $$\n校正后的平衡关系为 $K_y = \\frac{y_2}{y_1^2} = \\frac{K_f P}{K_\\phi} = \\frac{(6.60)(1.000)}{0.9909} \\approx 6.661$。\n解方程 $6.661 y_1^2 + y_1 - 1 = 0$：\n$$ y_1 = \\frac{-1 + \\sqrt{1^2 - 4(6.661)(-1)}}{2(6.661)} \\approx \\frac{-1 + \\sqrt{27.644}}{13.322} \\approx 0.3196 $$\n这个新的组分与初始估计值非常接近，因此不需要迭代。当 $y_1=0.3196$ 时，摩尔比为 $\\frac{n_{\\mathrm{tot}}}{n_{\\mathrm{u}}} = \\frac{1}{2-0.3196} \\approx 0.5951$。\n\n现在，计算包含压缩因子的最终体积比。\n$$ \\frac{V_{\\mathrm{eq}}}{V_{\\mathrm{mono}}} = \\frac{n_{\\mathrm{tot}}}{n_{\\mathrm{u}}} \\frac{Z_{\\mathrm{mix}}}{Z_{1}} $$\n对于纯单体：$Z_{1} = 1 + B_{11} \\frac{P}{RT} = 1 + (-0.120)(0.04034) = 1 - 0.00484 = 0.99516$。\n对于混合物，首先用 $y_1=0.3196$, $y_2=0.6804$ 重新计算 $B_{\\mathrm{mix}}$：\n$$ B_{\\mathrm{mix}} = (0.3196)^2(-0.120) + 2(0.3196)(0.6804)(-0.220) + (0.6804)^2(-0.400) \\approx -0.2931\\ \\mathrm{L\\ mol^{-1}} $$\n然后 $Z_{\\mathrm{mix}} = 1 + B_{\\mathrm{mix}} \\frac{P}{RT} = 1 + (-0.2931)(0.04034) = 1 - 0.01183 = 0.98817$。\n最终比值为：\n$$ \\frac{V_{\\mathrm{eq}}}{V_{\\mathrm{mono}}} = (0.5951) \\frac{0.98817}{0.99516} = (0.5951)(0.99298) \\approx 0.5909 $$\n与理想气体值相比的百分比变化是 $\\frac{0.5909 - 0.5955}{0.5955} \\times 100\\% \\approx -0.77\\%$。\n\n### 逐项分析\n**A. $V_{\\mathrm{eq}}/V_{\\mathrm{mono}}=0.500$（精确值）；气体化合体积定律无需任何修正即成立，因为化学计量系数直接决定体积。**\n这是不正确的。只有当缔合完全（$\\alpha=1$），即平衡时只存在 $\\mathrm{N_2O_4}$ 时，才能得到 0.500 这个值。我们的计算表明，仍有大量的 $\\mathrm{NO_2}$ 单体（$y_1 \\approx 0.32$）存在，所以反应远未完成。该陈述反映了对化学平衡的误解。结论：**不正确**。\n\n**B. 在理想气体近似下，$P=1.000\\ \\mathrm{bar}$ 时 $V_{\\mathrm{eq}}/V_{\\mathrm{mono}}\\approx 0.596$；在此压力下非理想性可以忽略，因此与 0.500 的偏差完全源于不完全缔合，但气体化合体积定律被根本上违背了。**\n理想气体计算得出 $0.5955 \\approx 0.596$，这是正确的。偏离 0.500 的原因被正确地确定为不完全缔合。然而，“非理想性可以忽略”的说法是有争议的，并且不如选项 C 精确。更关键的是，其“气体化合体积定律被根本上违背了”的结论性主张是错误的。盖-吕萨克定律涉及的是反应和生成的气体体积之比，在此处为 2:1。实验者所用的比值 $V_{\\mathrm{eq}}/V_{\\mathrm{mono}}$ 并非该定律所描述的内容。该定律没有被违背，而是被误用了。结论：**不正确**。\n\n**C. 在理想气体近似下，根据平衡组分，在 $P=1.000\\ \\mathrm{bar}$ 时 $V_{\\mathrm{eq}}/V_{\\mathrm{mono}}\\approx 0.596$；包含给定的第二维里非理想性后，该比值大约减小 $0.7\\%$（至约 0.592），这表明与 0.500 的偏差主要归因于不完全缔合，外加一个小的真实气体校正。在低压极限和/或在缔合反应完全的条件下，2:1 的化学计量体积比会得到恢复，因此该定律并未被违背。**\n这个陈述在量上和概念上都是正确的。\n- 理想气体比值：我们的计算得出 $0.5955 \\approx 0.596$。正确。\n- 非理想校正：我们的计算显示减少了约 $0.77\\%$。“大约 $0.7\\%$”是准确的。\n- 校正后的值：我们的值是 $0.5909$。“约 0.592”是一个合理的陈述。例如，$0.5955 \\times (1-0.007) \\approx 0.5914$。\n- 物理推理：它正确地指出，与 0.500 的巨大偏差是由于不完全反应，而小的额外校正是由于气体非理想性。\n- 对定律的解释：它正确地暗示，气体化合体积定律并未被违背，而是一个极限(情况下的)定律，其化学计量预测在接近理想条件的状况下对实际反应的体积才变得明显。在完全反应的条件下，总体积变化反映了 2:1 的化学计量关系（在理想气体极限下）。结论：**正确**。\n\n**D. 在 $P=1.000\\ \\mathrm{bar}$ 时 $V_{\\mathrm{eq}}/V_{\\mathrm{mono}}>1$，因为缔合增加了排斥相互作用，使气体膨胀；因此非理想效应改变了有效化学计量系数，化合体积概念不适用。**\n这个陈述在多个方面都是不正确的。\n- $V_{\\mathrm{eq}}/V_{\\mathrm{mono}}>1$：我们的计算结果是 $\\approx 0.591$。缔合减少了摩尔数，从而导致体积减小。\n- “缔合增加了排斥相互作用”：这在物理上是错误的。负的维里系数表明吸引力占主导地位，导致体积小于理想气体。\n- “非理想效应改变了有效化学计量系数”：这是无稽之谈。化学计量是关于分子计数的陈述，是不变的。结论：**不正确**。", "answer": "$$\\boxed{C}$$", "id": "2943535"}, {"introduction": "本章的最后一个练习将一个核心的化学任务——确定实验式——置于现代数据科学的视角下。这个计算实践引入了一个贝叶斯统计框架，用以处理实验数据中的不确定性，并将其与传统的确定性取整方法进行对比 ([@problem_id:2943614])。它演示了概率推理如何为解释实验数据提供一种更稳健、更有原则的方法，从而在存在测量误差的现实条件下，精确地应用定比定律。", "problem": "给定一个计算任务，该任务旨在操作化在测量不确定性下的化学成分定律。目标是使用贝叶斯推断，通过不确定的质量分数测量值来推断化合物最可能的实验式，其中先验偏好较小的总原子数。同时，将此结果与确定性的比率转整数取整方法进行比较。您的程序必须实现这两种方法，并报告所得的实验式，表示为按指定元素顺序排列的整数原子计数向量。\n\n使用的基本原理和模型：\n- 定比定律：在任何纯净物中，每种元素的质量分数由该元素的原子数和其原子量固定。如果元素集由 $i \\in \\{1,\\dots,k\\}$ 索引，原子量为 $A_i$，整数原子数为 $n_i \\in \\mathbb{N}$，那么元素 $i$ 的理论质量分数是 $w_i^{\\mathrm{theory}} = \\dfrac{n_i A_i}{\\sum_{j=1}^{k} n_j A_j}$，并且 $\\sum_{i=1}^{k} w_i^{\\mathrm{theory}} = 1$。\n- 测量模型：您观测到一个质量分数均值向量 $w_i^{\\mathrm{obs}}$（$i \\in \\{1,\\dots,k\\}$），其测量不确定性被建模为每个分量上独立的、标准差为 $\\sigma_i$ 的正态误差。对于一个候选实验式向量 $\\mathbf{n} = (n_1,\\dots,n_k)$，其似然的计算基于假设 $w_i^{\\mathrm{obs}} \\sim \\mathcal{N}(w_i^{\\mathrm{theory}}, \\sigma_i^2)$，且各分量 $i$ 之间相互独立。在相差一个对所有候选式都相同的加法常数的情况下，对数似然为 $-\\dfrac{1}{2}\\sum_{i=1}^{k} \\left(\\dfrac{w_i^{\\mathrm{obs}} - w_i^{\\mathrm{theory}}}{\\sigma_i}\\right)^2$。\n- 偏好小原子数的先验：对候选向量 $\\mathbf{n}$ 使用一个离散先验，该先验与 $\\exp(-\\lambda \\sum_{i=1}^{k} n_i)$ 成正比，其中 $\\lambda > 0$ 是给定的。只考虑最大公约数等于 $1$ 的 $\\mathbf{n}$（以确保实验式为其最简形式）。在相差一个对所有候选式都共享的加法常数的情况下，未归一化的对数先验为 $-\\lambda \\sum_{i=1}^{k} n_i$。\n\n需要实现的任务：\n1. 贝叶斯最大后验 (MAP) 实验式：\n   - 枚举所有满足 $1 \\le n_i \\le n_{\\max}$（对所有 $i$），$\\sum_{i=1}^{k} n_i \\le N_{\\max}$，以及 $\\gcd(n_1,\\dots,n_k) = 1$ 的候选整数向量 $\\mathbf{n} = (n_1,\\dots,n_k)$。\n   - 对每个 $\\mathbf{n}$，使用定比定律和给定的原子量 $A_i$ 计算理论质量分数 $w_i^{\\mathrm{theory}}$。\n   - 计算未归一化的对数后验 $L(\\mathbf{n}) = -\\dfrac{1}{2}\\sum_{i=1}^{k} \\left(\\dfrac{w_i^{\\mathrm{obs}} - w_i^{\\mathrm{theory}}}{\\sigma_i}\\right)^2 - \\lambda \\sum_{i=1}^{k} n_i$。\n   - 选择使 $L(\\mathbf{n})$ 最大化的 $\\mathbf{n}$。如果在 $L(\\mathbf{n})$ 值的数值容差 $10^{-12}$ 内出现平局，选择 $\\sum_{i=1}^{k} n_i$ 最小的 $\\mathbf{n}$；如果仍然平局，选择字典序最小的向量。\n\n2. 确定性取整实验式：\n   - 计算摩尔比代理值 $r_i = \\dfrac{w_i^{\\mathrm{obs}}}{A_i}$（$i \\in \\{1,\\dots,k\\}$），然后通过 $r_{\\min} = \\min_i r_i$ 进行缩放，得到 $q_i = \\dfrac{r_i}{r_{\\min}}$。\n   - 对于整数乘数 $m \\in \\{1,2,\\dots,M_{\\max}\\}$，通过 $n_i^{(m)} = \\mathrm{round}(m \\, q_i)$（对每个 $i$）构建候选整数向量，拒绝任何存在某个 $i$ 使得 $n_i^{(m)}  1$ 的候选向量。\n   - 通过将每个候选向量除以其分量的最大公约数 $\\gcd(n_1^{(m)},\\dots,n_k^{(m)})$ 来进行简化，以获得 $\\gcd=1$ 的实验式候选。\n   - 对每个简化后的候选式，如上计算其理论质量分数 $w_i^{\\mathrm{theory}}$，并评估确定性误差度量 $E = \\left(\\sum_{i=1}^{k} \\left(w_i^{\\mathrm{theory}} - w_i^{\\mathrm{obs}}\\right)^2 \\right)^{1/2}$。\n   - 选择 $E$ 值最小的候选式。出现平局时，选择 $\\sum_{i=1}^{k} n_i$ 最小的，然后选择字典序最小的。\n\n重要实现说明：\n- 所有原子量 $A_i$ 均以相对原子质量的形式给出，在本问题中应被视为精确常数。\n- 所有质量分数 $w_i^{\\mathrm{obs}}$ 均以小数形式给出，其总和约等于 $1$；不要转换为百分比。\n- 程序必须将实验式按指定的元素顺序输出为整数列表；不要输出元素符号或任何其他文本。\n\n测试套件：\n实现您的程序以运行以下测试用例。对于每个用例，都给出了元素集、原子量、观测的质量分数均值和标准差、先验参数 $\\lambda$、枚举限制 $n_{\\max}$ 和 $N_{\\max}$，以及确定性取整搜索限制 $M_{\\max}$。对于所有测试用例，您的程序必须输出一个列表，其中每个条目是一对列表：第一个是MAP实验式的原子计数值，第二个是确定性取整实验式的原子计数值。元素顺序如每个用例所列。\n\n- 测试用例 1：\n  - 元素：$\\mathrm{C}$、$\\mathrm{H}$、$\\mathrm{O}$ (顺序: $\\left[\\mathrm{C}, \\mathrm{H}, \\mathrm{O}\\right]$)\n  - 原子量：$A = [12.011,\\ 1.008,\\ 15.999]$\n  - 观测的质量分数均值：$w^{\\mathrm{obs}} = [0.60,\\ 0.13,\\ 0.27]$\n  - 标准差：$\\sigma = [0.01,\\ 0.01,\\ 0.01]$\n  - 先验参数：$\\lambda = 0.4$\n  - 枚举限制：$n_{\\max} = 8$，$N_{\\max} = 12$\n  - 确定性搜索限制：$M_{\\max} = 6$\n\n- 测试用例 2：\n  - 元素：$\\mathrm{C}$、$\\mathrm{O}$ (顺序: $\\left[\\mathrm{C}, \\mathrm{O}\\right]$)\n  - 原子量：$A = [12.011,\\ 15.999]$\n  - 观测的质量分数均值：$w^{\\mathrm{obs}} = [0.43,\\ 0.57]$\n  - 标准差：$\\sigma = [0.005,\\ 0.005]$\n  - 先验参数：$\\lambda = 0.6$\n  - 枚举限制：$n_{\\max} = 6$，$N_{\\max} = 8$\n  - 确定性搜索限制：$M_{\\max} = 6$\n\n- 测试用例 3：\n  - 元素：$\\mathrm{Fe}$、$\\mathrm{O}$ (顺序: $\\left[\\mathrm{Fe}, \\mathrm{O}\\right]$)\n  - 原子量：$A = [55.845,\\ 15.999]$\n  - 观测的质量分数均值：$w^{\\mathrm{obs}} = [0.70,\\ 0.30]$\n  - 标准差：$\\sigma = [0.02,\\ 0.02]$\n  - 先验参数：$\\lambda = 0.5$\n  - 枚举限制：$n_{\\max} = 5$，$N_{\\max} = 7$\n  - 确定性搜索限制：$M_{\\max} = 6$\n\n- 测试用例 4：\n  - 元素：$\\mathrm{C}$、$\\mathrm{H}$ (顺序: $\\left[\\mathrm{C}, \\mathrm{H}\\right]$)\n  - 原子量：$A = [12.011,\\ 1.008]$\n  - 观测的质量分数均值：$w^{\\mathrm{obs}} = [0.922,\\ 0.078]$\n  - 标准差：$\\sigma = [0.003,\\ 0.003]$\n  - 先验参数：$\\lambda = 0.5$\n  - 枚举限制：$n_{\\max} = 6$，$N_{\\max} = 8$\n  - 确定性搜索限制：$M_{\\max} = 6$\n\n- 测试用例 5：\n  - 元素：$\\mathrm{C}$、$\\mathrm{H}$、$\\mathrm{Cl}$ (顺序: $\\left[\\mathrm{C}, \\mathrm{H}, \\mathrm{Cl}\\right]$)\n  - 原子量：$A = [12.011,\\ 1.008,\\ 35.45]$\n  - 观测的质量分数均值：$w^{\\mathrm{obs}} = [0.372,\\ 0.079,\\ 0.549]$\n  - 标准差：$\\sigma = [0.01,\\ 0.005,\\ 0.01]$\n  - 先验参数：$\\lambda = 0.5$\n  - 枚举限制：$n_{\\max} = 6$，$N_{\\max} = 8$\n  - 确定性搜索限制：$M_{\\max} = 6$\n\n最终输出规范：\n- 您的程序应生成单行输出，包含一个Python风格的列表字面量。每个条目对应一个测试用例，顺序排列，并且是一个列表对：第一个列表是MAP实验式原子计数向量 $\\left[n_1,\\dots,n_k\\right]$，第二个列表是确定性取整实验式原子计数向量 $\\left[n_1,\\dots,n_k\\right]$，两者均按指定的元素顺序排列。例如，总输出应类似于 $[[[a_{11},\\dots,a_{1k}],[b_{11},\\dots,b_{1k}]],\\dots]$，其中所有的 $a_{ij}$ 和 $b_{ij}$ 均为整数。", "solution": "用户提供了一个普通化学领域的计算问题。我现在将对问题陈述进行强制性验证。\n\n### 步骤1：提取给定条件\n\n**基本原理和模型：**\n- **定比定律：** 对于一个由 $i \\in \\{1,\\dots,k\\}$ 索引的元素集、原子量为 $A_i$、整数原子数为 $n_i \\in \\mathbb{N}$ 的化合物，元素 $i$ 的理论质量分数为 $w_i^{\\mathrm{theory}} = \\dfrac{n_i A_i}{\\sum_{j=1}^{k} n_j A_j}$。陈述中提到 $\\sum_{i=1}^{k} w_i^{\\mathrm{theory}} = 1$。\n- **测量模型：** 观测到的质量分数 $w_i^{\\mathrm{obs}}$ 被建模为独立的服从正态分布的变量，$w_i^{\\mathrm{obs}} \\sim \\mathcal{N}(w_i^{\\mathrm{theory}}, \\sigma_i^2)$，其中 $\\sigma_i$ 是给定的标准差。\n- **对数似然函数：** 在相差一个加法常数的情况下，候选实验式 $\\mathbf{n} = (n_1,\\dots,n_k)$ 的对数似然由 $L_{\\text{like}}(\\mathbf{n}) = -\\dfrac{1}{2}\\sum_{i=1}^{k} \\left(\\dfrac{w_i^{\\mathrm{obs}} - w_i^{\\mathrm{theory}}}{\\sigma_i}\\right)^2$ 给出。\n- **先验模型：** 使用一个与 $\\exp(-\\lambda \\sum_{i=1}^{k} n_i)$ 成正比的离散先验，其中 $\\lambda  0$。候选实验式 $\\mathbf{n}$ 必须是最简形式，即 $\\gcd(n_1,\\dots,n_k) = 1$。未归一化的对数先验是 $L_{\\text{prior}}(\\mathbf{n}) = -\\lambda \\sum_{i=1}^{k} n_i$。\n\n**任务1：贝叶斯最大后验 (MAP) 方法：**\n- 枚举整数向量 $\\mathbf{n} = (n_1,\\dots,n_k)$，约束条件为：对所有 $i$，$1 \\le n_i \\le n_{\\max}$，$\\sum_{i=1}^{k} n_i \\le N_{\\max}$，以及 $\\gcd(n_1,\\dots,n_k) = 1$。\n- 对每个候选 $\\mathbf{n}$，计算未归一化的对数后验 $L(\\mathbf{n}) = L_{\\text{like}}(\\mathbf{n}) + L_{\\text{prior}}(\\mathbf{n})$。\n- 选择使 $L(\\mathbf{n})$ 最大化的 $\\mathbf{n}$。\n- 平局决胜规则：\n  1. 如果 $L(\\mathbf{n})$ 值在 $10^{-12}$ 的容差内持平，选择总和 $\\sum_{i=1}^{k} n_i$ 最小的 $\\mathbf{n}$。\n  2. 如果仍然持平，选择字典序最小的向量 $\\mathbf{n}$。\n\n**任务2：确定性取整方法：**\n- 计算摩尔比代理值：$r_i = w_i^{\\mathrm{obs}} / A_i$。\n- 按最小比率缩放：$q_i = r_i / \\min_j(r_j)$。\n- 对于整数乘数 $m \\in \\{1,2,\\dots,M_{\\max}\\}$，形成候选整数向量 $n_i^{(m)} = \\mathrm{round}(m \\cdot q_i)$。如果任何 $n_i^{(m)}  1$，则拒绝该候选。\n- 通过除以其最大公约数来简化每个候选式。\n- 对每个唯一的简化候选式，计算误差度量 $E = \\left(\\sum_{i=1}^{k} (w_i^{\\mathrm{theory}} - w_i^{\\mathrm{obs}})^2 \\right)^{1/2}$。\n- 选择 $E$ 值最小的候选式。\n- 平局决胜规则：\n  1. 选择原子计数总和最小的候选式。\n  2. 如果仍然持平，选择字典序最小的向量。\n\n**测试用例：**\n- **用例1：** 元素：$[\\mathrm{C}, \\mathrm{H}, \\mathrm{O}]$，$A = [12.011, 1.008, 15.999]$，$w^{\\mathrm{obs}} = [0.60, 0.13, 0.27]$，$\\sigma = [0.01, 0.01, 0.01]$，$\\lambda = 0.4$，$n_{\\max} = 8$，$N_{\\max} = 12$，$M_{\\max} = 6$。\n- **用例2：** 元素：$[\\mathrm{C}, \\mathrm{O}]$，$A = [12.011, 15.999]$，$w^{\\mathrm{obs}} = [0.43, 0.57]$，$\\sigma = [0.005, 0.005]$，$\\lambda = 0.6$，$n_{\\max} = 6$，$N_{\\max} = 8$，$M_{\\max} = 6$。\n- **用例3：** 元素：$[\\mathrm{Fe}, \\mathrm{O}]$，$A = [55.845, 15.999]$，$w^{\\mathrm{obs}} = [0.70, 0.30]$，$\\sigma = [0.02, 0.02]$，$\\lambda = 0.5$，$n_{\\max} = 5$，$N_{\\max} = 7$，$M_{\\max} = 6$。\n- **用例4：** 元素：$[\\mathrm{C}, \\mathrm{H}]$，$A = [12.011, 1.008]$，$w^{\\mathrm{obs}} = [0.922, 0.078]$，$\\sigma = [0.003, 0.003]$，$\\lambda = 0.5$，$n_{\\max} = 6$，$N_{\\max} = 8$，$M_{\\max} = 6$。\n- **用例5：** 元素：$[\\mathrm{C}, \\mathrm{H}, \\mathrm{Cl}]$，$A = [12.011, 1.008, 35.45]$，$w^{\\mathrm{obs}} = [0.372, 0.079, 0.549]$，$\\sigma = [0.01, 0.005, 0.01]$，$\\lambda = 0.5$，$n_{\\max} = 6$，$N_{\\max} = 8$，$M_{\\max} = 6$。\n\n**输出规范：**\n程序必须输出单行Python风格的列表字面量，其中每个元素是一对整数列表，分别代表每个测试用例的MAP和确定性方法的结果。\n\n### 步骤2：使用提取的给定条件进行验证\n\n- **科学依据：** 该问题牢固地植根于基本的化学和统计学原理。定比定律是化学的基石之一。使用正态分布来建模测量误差以及使用贝叶斯推断（特别是MAP估计）进行参数推断是标准且严谨的统计技术。确定性取整方法是初级化学中教授的一种著名启发式方法。所有提供的原子量都是标准的相对原子质量。该问题不含伪科学和事实错误。\n- **定义明确：** 该问题被细致地规定。MAP和确定性方法都定义了清晰的目标函数（分别为 $L(\\mathbf{n})$ 和 $E$）和搜索空间（由 $n_{\\max}$、$N_{\\max}$、$M_{\\max}$ 定义）。明确、无歧义的平局决胜规则（最小原子总和，然后是字典序）确保了对于每种方法和每个测试用例都保证存在唯一解。\n- **客观性：** 问题陈述以精确、技术性的语言表达，没有任何主观或基于意见的内容。\n- **不完整或矛盾的设置：** 每个测试用例所需的所有数据——元素、原子量、观测质量分数、不确定性以及算法参数——都已完整提供。每个测试用例中观测质量分数的总和等于 $1.0$（或在给定精度下为 $1.000$），这表明了内部一致性。例如，在测试用例1中，$0.60 + 0.13 + 0.27 = 1.00$。问题是自洽的，没有矛盾之处。\n- **不切实际或不可行：** 从实验质量组成数据确定实验式的任务是分析化学中的一个标准问题。由 $n_{\\max}$ 和 $N_{\\max}$ 定义的计算搜索空间是有限的且计算上是可行的。例如，对于 $k=3$ 和 $n_{\\max}=8$ 的测试用例1，MAP搜索的初始候选数量为 $8^3 = 512$，对于现代计算来说这是一个非常小的数字。该设置完全可行。\n- **病态或结构不良：** 问题结构良好，所有术语和程序都有清晰的定义。诸如 `gcd`、`round` 和 `lexicographically smallest` 等术语在此上下文中是无歧义的。\n\n### 步骤3：结论与行动\n\n该问题是**有效**的。它科学合理、规定完整、定义明确且客观。没有任何缺陷。我将继续提供一个完整的解决方案。\n\n该解决方案将用Python实现。一个中心函数将处理每个测试用例。对于每个用例，将执行两个子程序：一个用于贝叶斯MAP估计，另一个用于确定性取整方法。两者都将涉及遍历候选实验式，评估一个目标函数，并根据指定的规则（包括平局决胜规则）选择最优候选。\n\n**贝叶斯MAP方法实现：**\n将使用 `itertools.product` 对每个元素的 $[1, n_{\\max}]$ 范围生成所有可能的候选向量 $\\mathbf{n}$ 的列表。然后将对此列表进行筛选，只保留满足约束 $\\sum n_i \\le N_{\\max}$ 和 $\\gcd(n_1, \\dots, n_k) = 1$ 的向量。对于每个有效的候选向量，计算理论质量分数 $w_i^{\\mathrm{theory}}$，然后计算对数似然和对数先验，将它们相加以获得对数后验。将选择最大化此对数后验值的候选向量（遵循平局决胜规则）作为MAP估计。\n\n**确定性取整方法实现：**\n首先，通过除以原子量 $A_i$ 将观测质量分数 $w_i^{\\mathrm{obs}}$ 转换为摩尔比代理值 $r_i$。然后将这些比率通过它们的最小值进行归一化，得到缩放后的比率 $q_i$。通过迭代乘数 $m$ 从 $1$ 到 $M_{\\max}$，计算 $n_i^{(m)} = \\mathrm{round}(m \\cdot q_i)$，并将得到的整数向量除以其最大公约数来简化，从而生成一组候选实验式。然后评估每个唯一的候选式，计算其理论质量分数与观测值之间的欧几里得距离 $E$。将选择使此误差 $E$ 最小的候选式（遵循平局决胜规则）。\n\n将需要一个辅助函数来计算一个整数列表的最大公约数。用于平局决胜的数值比较将使用一个小的容差（$10^{-12}$）来处理，以确保对浮点不精确性的鲁棒性。所有测试用例的最终结果将被汇总并以指定的列表的列表格式打印。", "answer": "[[[3, 8, 1], [3, 8, 1]], [[1, 1], [1, 1]], [[2, 3], [2, 3]], [[1, 1], [1, 1]], [[2, 5, 1], [2, 5, 1]]]", "id": "2943614"}]}