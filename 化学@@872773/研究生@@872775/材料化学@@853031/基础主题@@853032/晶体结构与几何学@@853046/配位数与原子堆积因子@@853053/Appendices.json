{"hands_on_practices": [{"introduction": "在晶体材料中，除了原子本身的堆积方式，原子之间的空隙或间隙位置对于理解合金形成、杂质溶解和扩散等现象至关重要。本练习将引导你从第一性原理出发，通过严格的几何推导，计算面心立方（fcc）结构中八面体间隙的最大容纳半径，这是晶体化学中的一项基本技能。[@problem_id:2475691]", "problem": "一个单原子晶体固体被模型化为相同的、不可压缩的硬球，排列成面心立方 (fcc) 结构，这可以看作是遵循 ABC 堆积序列的密排层。设主体球半径为 $r$，常规立方晶胞边长为 $a$。考虑位于常规立方晶胞中心的八面体间隙位置。一个半径为 $r_{\\text{oct}}$ 的间隙球被放置在该位置，它与周围的主体球相切，但不会使其变形。\n\n仅从关于面心立方晶格的基本几何事实和硬球密堆积约束出发，并使用笛卡尔坐标系中的欧几里得几何，完成以下任务：\n\n- 通过确定在 fcc 密堆积中哪些主体球是接触的，并计算相应的球心距，来建立 $a$ 和 $r$ 之间的关系。\n- 确定围绕立方体中心八面体位置的最近主体球球心，并用 $a$ 计算八面体位置中心与那些主体球球心之间的距离。\n- 对间隙球及其最近的主体球施加相切条件，以确定用 $a$ 和 $r$ 表示的 $r_{\\text{oct}}$。\n- 消去 $a$，以获得比值 $r_{\\text{oct}}/r$ 的闭式表达式。\n\n从晶格几何和硬球接触的第一性原理出发，论证每一个几何步骤。将最终答案以 $r_{\\text{oct}}/r$ 的精确解析表达式形式报告。如果您还提供了小数值，请将其四舍五入到 $4$ 位有效数字，并以无量纲小数的形式报告。", "solution": "所述问题是晶体结构几何分析中的一个适定性练习，特别是关于面心立方 (fcc) 晶格。它具有科学依据、内容自洽，是固态化学和固态物理学中的一个标准问题。因此，我们开始进行求解。\n\n我们建立一个笛卡尔坐标系，其原点位于常规立方晶胞的一个角点，坐标轴与立方体棱对齐。常规晶胞是一个边长为 $a$ 的立方体，占据由 $0 \\le x \\le a$，$0 \\le y \\le a$ 和 $0 \\le z \\le a$ 定义的区域。\n\n在面心立方 (fcc) 晶格中，半径为 $r$ 的相同球体位于常规晶胞的8个角点和6个面心。\n角点原子中心的坐标形式为 $(ia, ja, ka)$，其中 $i, j, k \\in \\{0, 1\\}$。\n面心原子中心的坐标为 $(a/2, a/2, 0)$、$(a/2, 0, a/2)$、$(0, a/2, a/2)$ 及其置换。\n\n首先，我们必须建立晶格常数 $a$ 和原子半径 $r$ 之间的关系。fcc 结构是一种密堆积排列。这意味着原子沿着特定方向是相互接触的。在 fcc 晶格中，沿面对角线方向的原子是相切的。让我们考虑位于 $xy$ 平面（$z=0$）上的面。有原子中心分别位于角点 $(0, 0, 0)$ 和面心 $(a/2, a/2, 0)$。这些是最近邻原子，因此在硬球模型中它们是相互接触的。\n\n这两个原子中心之间的距离 $d$ 可用欧几里得距离公式计算得出：\n$$d = \\sqrt{\\left(\\frac{a}{2} - 0\\right)^2 + \\left(\\frac{a}{2} - 0\\right)^2 + (0 - 0)^2} = \\sqrt{\\frac{a^2}{4} + \\frac{a^2}{4}} = \\sqrt{\\frac{2a^2}{4}} = \\sqrt{\\frac{a^2}{2}} = \\frac{a}{\\sqrt{2}}$$\n由于这两个球体相切，它们中心之间的距离必须等于其半径之和，即 $r + r = 2r$。\n将几何距离与半径之和相等，我们得到约束条件：\n$$2r = \\frac{a}{\\sqrt{2}}$$\n由此，我们推导出 $a$ 和 $r$ 之间的关系：\n$$a = 2\\sqrt{2}r \\quad (1)$$\n\n接下来，我们考虑位于常规立方晶胞中心的八面体间隙位置。该位置的坐标为 $(\\frac{a}{2}, \\frac{a}{2}, \\frac{a}{2})$。我们必须确定距离此位置最近的主体球。根据对称性，最近的主体原子是位于立方体6个面中心的原子。它们的坐标是：\n$(\\frac{a}{2}, \\frac{a}{2}, 0)$、$(\\frac{a}{2}, \\frac{a}{2}, a)$、$(\\frac{a}{2}, 0, \\frac{a}{2})$、$(\\frac{a}{2}, a, \\frac{a}{2})$、$(0, \\frac{a}{2}, \\frac{a}{2})$ 和 $(a, \\frac{a}{2}, \\frac{a}{2})$。\n\n让我们计算从八面体位置中心 $(\\frac{a}{2}, \\frac{a}{2}, \\frac{a}{2})$ 到其中一个最近主体原子中心的距离，例如，位于 $z=0$ 平面上，坐标为 $(\\frac{a}{2}, \\frac{a}{2}, 0)$ 的原子。设此距离为 $d_{\\text{oct-host}}$。\n$$d_{\\text{oct-host}} = \\sqrt{\\left(\\frac{a}{2} - \\frac{a}{2}\\right)^2 + \\left(\\frac{a}{2} - \\frac{a}{2}\\right)^2 + \\left(\\frac{a}{2} - 0\\right)^2} = \\sqrt{0 + 0 + \\left(\\frac{a}{2}\\right)^2} = \\frac{a}{2}$$\n根据立方对称性的要求，到所有6个面心原子的距离是相同的。\n\n问题陈述，一个半径为 $r_{\\text{oct}}$ 的间隙球被放置在这个八面体位置，并与周围的这6个主体球相切。相切条件意味着间隙球中心与相邻主体球中心之间的距离是它们的半径之和，即 $r_{\\text{oct}} + r$。\n因此，我们有以下关系：\n$$d_{\\text{oct-host}} = r_{\\text{oct}} + r$$\n代入计算出的距离 $d_{\\text{oct-host}} = a/2$：\n$$\\frac{a}{2} = r_{\\text{oct}} + r \\quad (2)$$\n\n我们现在有一个包含两个方程的方程组：\n$$(1): \\quad a = 2\\sqrt{2}r$$\n$$(2): \\quad \\frac{a}{2} = r_{\\text{oct}} + r$$\n我们的目标是求出比值 $r_{\\text{oct}}/r$。为实现这一目标，我们从该方程组中消去 $a$。将方程 $(1)$ 代入方程 $(2)$：\n$$\\frac{2\\sqrt{2}r}{2} = r_{\\text{oct}} + r$$\n这可以简化为：\n$$\\sqrt{2}r = r_{\\text{oct}} + r$$\n现在，我们求解用 $r$ 表示的 $r_{\\text{oct}}$：\n$$r_{\\text{oct}} = \\sqrt{2}r - r = (\\sqrt{2} - 1)r$$\n最后，我们计算所要求的无量纲比值 $r_{\\text{oct}}/r$：\n$$\\frac{r_{\\text{oct}}}{r} = \\sqrt{2} - 1$$\n这是该比值的精确解析表达式。\n数值上，这个值约为 $\\sqrt{2} - 1 \\approx 1.41421356... - 1 = 0.41421356...$。四舍五入到 $4$ 位有效数字，该比值为 $0.4142$。", "answer": "$$\\boxed{\\sqrt{2} - 1}$$", "id": "2475691"}, {"introduction": "真实的晶体并非完美无瑕，点缺陷的存在是普遍现象。本练习将带领你从理想晶体模型过渡到更符合实际的情景，通过引入空位来分析其对整体原子堆积效率（APF）的影响。你将首先在一个刚性晶格模型下进行推导，然后进一步考虑原子与晶格弛豫这一关键效应，从而锻炼处理复杂物理系统时建立模型和运用近似方法的能力。[@problem_id:2475630]", "problem": "一个单原子晶体固体被模型化为半径为 $r$ 的相同的非重叠硬球，排列在固定的晶体结构上，每个选定的参考晶胞的体积为 $V_0$，其中包含 $N_s$ 个格点。原子堆积因子 (APF) 定义为代表原子的硬球所占据的晶胞体积分数。令 $\\phi_0$ 表示无缺陷晶体的 APF。\n\n现在引入一个小的、均匀的空位浓度 $c_v$，其定义为空置格点的分数，其中 $0  c_v \\ll 1$。假设在 $c_v$ 的主导项上，每个参考晶胞的平均原子数减少到 $(1-c_v)N_s$。\n\n1) 在没有弹性或电子弛豫的硬球模型下（即，硬球半径 $r$ 和参考晶胞体积 $V_0$ 在 $c_v$ 的主导项上保持不变），从第一性原理推导有缺陷晶体的 APF 表达式以及相对于 $\\phi_0$ 的 APF 下降量。\n\n2) 现在假设空位的形成引起了剩余原子的有效、各向同性的收缩以及晶体的均匀弹性收缩。通过让硬球半径和参考晶胞体积变换为 $r \\mapsto r' = r \\left(1 - \\alpha c_v\\right)$ 和 $V_0 \\mapsto V' = V_0 \\left(1 - \\eta c_v\\right)^3$ 来对此进行建模，其中 $\\alpha \\ge 0$ 和 $\\eta \\ge 0$ 是与 $c_v$ 无关的常数，且 $0  c_v \\ll 1$。推导在 $c_v$ 的主导项上，相对于 $\\phi_0$ 的 APF 下降量。陈述你为避免硬球重叠而使用的任何几何一致性条件。\n\n以 $\\phi_0$、$\\alpha$、$\\eta$ 和 $c_v$ 的形式，给出一个单一的闭式解析表达式作为主导项 APF 下降量的最终答案。不需要进行数值评估。最终答案不得包含主导项之外的余项。答案是无量纲的；不要在最终的方框表达式中包含单位。", "solution": "所述问题具有科学依据，提法恰当且客观。不存在任何可识别的缺陷、矛盾或缺失信息会妨碍严谨的求解。我们将着手进行推导。\n\n根据要求，分析分为两部分。首先，我们建立无原子或晶格弛豫的基准情况。其次，我们引入弛豫效应，并确定在空位浓度 $c_v$ 的主导项上，原子堆积因子（APF）的变化。\n\n设 $r$ 为硬球原子的半径，$V_{atom} = \\frac{4}{3}\\pi r^3$ 为单个原子的体积。体积为 $V_0$ 的参考晶胞在无缺陷晶体中包含 $N_s$ 个格点。\n\n原子堆积因子（APF），记为 $\\phi$，定义为参考晶胞内原子总体积除以晶胞体积。对于无缺陷晶体，其 APF，$\\phi_0$，为：\n$$\n\\phi_0 = \\frac{N_s V_{atom}}{V_0} = \\frac{N_s \\left(\\frac{4}{3}\\pi r^3\\right)}{V_0}\n$$\n\n**第1部分：刚性晶格模型（无弛豫）**\n\n在此模型中，$N_s$ 个格点中有比例为 $c_v$ 的部分是空置的。参考晶胞中的原子数减少到 $N_{atoms} = (1-c_v)N_s$。假设原子半径 $r$ 和晶胞体积 $V_0$ 保持不变。\n\n有缺陷晶胞中原子占据的总容积为：\n$$\nV_{total, atoms} = N_{atoms} V_{atom} = (1-c_v)N_s \\left(\\frac{4}{3}\\pi r^3\\right)\n$$\n有缺陷晶体的 APF，我们记为 $\\phi_{def}$，是：\n$$\n\\phi_{def} = \\frac{V_{total, atoms}}{V_0} = \\frac{(1-c_v)N_s \\left(\\frac{4}{3}\\pi r^3\\right)}{V_0}\n$$\n通过代入 $\\phi_0$ 的表达式，我们可以将 $\\phi_{def}$ 写为：\n$$\n\\phi_{def} = (1-c_v) \\phi_0\n$$\n相对于完美晶体的 APF 下降量为 $\\Delta\\phi = \\phi_0 - \\phi_{def}$。\n$$\n\\Delta\\phi = \\phi_0 - (1-c_v)\\phi_0 = \\phi_0 - \\phi_0 + c_v\\phi_0 = c_v\\phi_0\n$$\n这是刚性晶格模型中 APF 的主导项下降量。\n\n**第2部分：考虑原子和晶格弛豫的模型**\n\n我们现在考虑空位形成引起弛豫的情况。原子半径 $r$ 和参考晶胞体积 $V_0$ 被修正。新的半径 $r'$ 和新的体积 $V'$ 由下式给出：\n$$\nr' = r(1 - \\alpha c_v)\n$$\n$$\nV' = V_0(1 - \\eta c_v)^3\n$$\n其中 $\\alpha \\ge 0$ 和 $\\eta \\ge 0$ 是常数，我们关心的是在小 $c_v$ ($0  c_v \\ll 1$) 情况下的主导项效应。\n\n在弛豫晶体中，单个原子的体积 $V'_{atom}$ 为：\n$$\nV'_{atom} = \\frac{4}{3}\\pi (r')^3 = \\frac{4}{3}\\pi \\left[r(1 - \\alpha c_v)\\right]^3 = \\left(\\frac{4}{3}\\pi r^3\\right) (1 - \\alpha c_v)^3 = V_{atom} (1 - \\alpha c_v)^3\n$$\n使用对于小 $x$ 的二项式展开 $(1-x)^n \\approx 1-nx$，我们将 $(1 - \\alpha c_v)^3$ 展开到 $c_v$ 的主导项：\n$$\nV'_{atom} \\approx V_{atom} (1 - 3\\alpha c_v)\n$$\n晶胞中的原子数保持为 $(1-c_v)N_s$。在弛豫的有缺陷晶胞中，原子的总体积 $V'_{total, atoms}$ 为：\n$$\nV'_{total, atoms} = (1-c_v)N_s V'_{atom} \\approx (1-c_v)N_s V_{atom} (1 - 3\\alpha c_v)\n$$\n展开此乘积并仅保留到 $c_v$ 一阶的项：\n$$\nV'_{total, atoms} \\approx N_s V_{atom} (1 - 3\\alpha c_v - c_v + 3\\alpha c_v^2) \\approx N_s V_{atom} [1 - (1 + 3\\alpha)c_v]\n$$\n接下来，我们求出弛豫晶胞的体积 $V'$，到 $c_v$ 的主导项：\n$$\nV' = V_0(1 - \\eta c_v)^3 \\approx V_0(1 - 3\\eta c_v)\n$$\n弛豫的有缺陷晶体的 APF，$\\phi'$，是原子总体积与晶胞体积之比：\n$$\n\\phi' = \\frac{V'_{total, atoms}}{V'} \\approx \\frac{N_s V_{atom} [1 - (1 + 3\\alpha)c_v]}{V_0(1 - 3\\eta c_v)}\n$$\n认识到 $\\phi_0 = \\frac{N_s V_{atom}}{V_0}$，我们有：\n$$\n\\phi' \\approx \\phi_0 \\frac{1 - (1 + 3\\alpha)c_v}{1 - 3\\eta c_v}\n$$\n为了简化这个对于小 $c_v$ 的分数，我们使用近似 $(1-x)^{-1} \\approx 1+x$：\n$$\n\\phi' \\approx \\phi_0 [1 - (1 + 3\\alpha)c_v] (1 + 3\\eta c_v)\n$$\n展开乘积并再次只保留到 $c_v$ 一阶的项：\n$$\n\\phi' \\approx \\phi_0 [1 + 3\\eta c_v - (1 + 3\\alpha)c_v - (1+3\\alpha)(3\\eta)c_v^2] \\approx \\phi_0 [1 + (3\\eta - 1 - 3\\alpha)c_v]\n$$\nAPF 的下降量 $\\Delta\\phi' = \\phi_0 - \\phi'$ 则为：\n$$\n\\Delta\\phi' = \\phi_0 - \\phi_0 [1 + (3\\eta - 1 - 3\\alpha)c_v] = \\phi_0 - \\phi_0 - \\phi_0 (3\\eta - 1 - 3\\alpha)c_v\n$$\n$$\n\\Delta\\phi' = -\\phi_0 (3\\eta - 1 - 3\\alpha)c_v = \\phi_0 (1 + 3\\alpha - 3\\eta)c_v\n$$\n这就是 APF 主导项下降量的最终表达式。\n\n需要一个几何一致性条件来确保硬球在弛豫后不发生重叠。在晶体中，最近邻距离 $d_{NN}$ 与晶格参数 $a$ 成正比，而晶格参数 $a$ 与晶胞体积的立方根成比例。因此，$d_{NN} \\propto V_0^{1/3}$。\n在无缺陷晶体中，非重叠条件是 $2r \\le d_{NN}$。我们假设在最密堆积的情况下 $2r = d_{NN}$。\n弛豫后，新半径为 $r' = r(1-\\alpha c_v)$，新的最近邻距离为 $d'_{NN} \\propto (V')^{1/3} = (V_0(1-\\eta c_v)^3)^{1/3} = V_0^{1/3}(1-\\eta c_v)$。因此，$d'_{NN} = d_{NN}(1-\\eta c_v)$。\n弛豫晶体的非重叠条件是 $2r' \\le d'_{NN}$。\n代入 $r'$ 和 $d'_{NN}$ 的表达式：\n$$\n2r(1-\\alpha c_v) \\le d_{NN}(1-\\eta c_v)\n$$\n使用初始条件 $2r = d_{NN}$：\n$$\n2r(1-\\alpha c_v) \\le 2r(1-\\eta c_v)\n$$\n$$\n1 - \\alpha c_v \\le 1 - \\eta c_v\n$$\n因为 $c_v > 0$，这简化为 $-\\alpha \\le -\\eta$，或：\n$$\n\\alpha \\ge \\eta\n$$\n该条件表明，原子半径的分数收缩必须大于或等于晶格的线分数收缩，以防止原子发生空间碰撞。推导出的 APF 下降量表达式在此物理约束下有效。\n\n最终所需的答案是从第2部分推导出的主导项 APF 下降量的表达式。\n下降量为 $\\phi_0 c_v (1 + 3\\alpha - 3\\eta)$。", "answer": "$$\n\\boxed{\\phi_0 c_v (1 + 3\\alpha - 3\\eta)}\n$$", "id": "2475630"}, {"introduction": "对于不存在周期性重复单元的非晶材料（如金属玻璃），我们应如何应用配位数和堆积因子等概念？本计算练习将介绍一种强大的几何分析工具—— Voronoi 划分，用以定义原子的局域环境。通过分析一组代表性的金属玻璃模拟数据，你将学习如何定量地将特定的局域结构（如二十面体）与更高的堆积效率联系起来，这是理解非晶态物质结构与性能关系的核心环节。[@problem_id:2475684]", "problem": "给定一组代表了锆基金属玻璃的原子位点。每个位点由三个项目指定：一个化学物种标签，一个表示为整数列表 $\\langle n_{3}, n_{4}, n_{5}, n_{6} \\rangle$ 的 Voronoi 指数（该指数统计了位点周围 Voronoi 多面体上具有 $k$ 条边的面的数量，其中 $k \\in \\{3,4,5,6\\}$），以及一个以 $\\text{\\AA}^{3}$ 为单位的 Voronoi 晶胞体积 $V$。您将编写一个程序，针对每个位点数据集，使用 Voronoi 指数对局域环境进行分类，计算每个位点的局域堆积分数，并定量地将配位数为12的二十面体结构的普遍性与高局域堆积密度联系起来。\n\n需要使用的基本定义和事实：\n- 围绕离散原子中心的 Voronoi 镶嵌将空间划分为多个区域，每个区域包含所有比其他任何中心更接近给定中心的点。一个位点的 Voronoi 多面体上 $k$ 边形面的数量由 Voronoi 指数 $\\langle n_{3}, n_{4}, n_{5}, n_{6} \\rangle$ 总结。\n- 一个位点的配位数 (CN) 是不同最近邻的数量，并等于其 Voronoi 多面体上的总面数。根据指数，$\\mathrm{CN} = \\sum_{k} n_{k}$；此处 $k \\in \\{3,4,5,6\\}$，因此 $\\mathrm{CN} = n_{3} + n_{4} + n_{5} + n_{6}$。\n- 一个完美的二十面体有12个五边形面，且没有三角形、四边形或六边形面。因此，一个位点是严格二十面体的当且仅当其 Voronoi 指数恰好为 $\\langle 0, 0, 12, 0 \\rangle$，这也得出 $\\mathrm{CN} = 12$。\n- 一个位点的局域堆积分数（局域原子堆积因子）可以定义为该物种金属半径球体的体积与分配给该位点的 Voronoi 晶胞体积之比：对于金属半径为 $r$ 且 Voronoi 晶胞体积为 $V$ 的物种，定义\n$$\n\\phi = \\frac{\\frac{4}{3}\\pi r^{3}}{V}.\n$$\n这个量是无量纲的。它是一个局域量，类似于晶体中的原子堆积因子，其基础是由 Voronoi 镶嵌给出的空间划分。\n\n对所涉及的物种使用以下金属半径：\n- Zr: $r_{\\mathrm{Zr}} = 1.60 \\,\\text{\\AA}$\n- Cu: $r_{\\mathrm{Cu}} = 1.28 \\,\\text{\\AA}$\n- Ni: $r_{\\mathrm{Ni}} = 1.25 \\,\\text{\\AA}$\n- Al: $r_{\\mathrm{Al}} = 1.43 \\,\\text{\\AA}$\n\n您对每个数据集的任务是：\n1. 对于每个位点，计算 $\\mathrm{CN}$，当且仅当 Voronoi 指数等于 $\\langle 0, 0, 12, 0 \\rangle$ 时将该位点分类为严格二十面体，并使用上述公式计算局域堆积分数 $\\phi$。所有计算必须使用提供的半径和以 $\\text{\\AA}^{3}$ 为单位的 Voronoi 晶胞体积 $V$。\n2. 对于该数据集，计算以下五个量：\n   - 严格二十面体位点的分数，定义为指标 $I$ 的平均值，其中如果一个位点是严格二十面体，则 $I=1$，否则 $I=0$。\n   - 严格二十面体位点中的平均局域堆积分数。如果没有严格二十面体位点，则将此平均值定义为 $0$。\n   - 非二十面体位点中的平均局域堆积分数。如果没有非二十面体位点，则将此平均值定义为 $0$。\n   - 严格二十面体位点与非二十面体位点的平均局域堆积分数之差（二十面体减去非二十面体）。\n   - 严格二十面体指标的二元向量 $I$ 与局域堆积分数向量 $\\phi$ 之间的皮尔逊相关系数，计算公式为\n     $$\n     \\rho(I,\\phi) = \\frac{\\sum_{i=1}^{N} (I_{i}-\\overline{I}) (\\phi_{i}-\\overline{\\phi})}{\\sqrt{\\sum_{i=1}^{N} (I_{i}-\\overline{I})^{2}} \\, \\sqrt{\\sum_{i=1}^{N} (\\phi_{i}-\\overline{\\phi})^{2}}}.\n     $$\n     如果分母中的任一方差为零（即所有 $I_{i}$ 都相同或所有 $\\phi_{i}$ 都相同），则定义 $\\rho(I,\\phi) = 0$。\n\n将所有报告的量表示为小数（无百分号），并将局域堆积分数视为无量纲。\n\n在您的程序中实现的测试套件（每个数据集是位点的列表，格式为（物种、Voronoi 指数、Voronoi 体积 $V$（单位 $\\text{\\AA}^{3}$）））：\n\n- 数据集 A:\n  - $\\mathrm{Zr}$, $\\langle 0, 0, 12, 0 \\rangle$, $V = 24.8$\n  - $\\mathrm{Zr}$, $\\langle 0, 0, 12, 0 \\rangle$, $V = 23.5$\n  - $\\mathrm{Cu}$, $\\langle 0, 2, 8, 2 \\rangle$, $V = 14.7$\n  - $\\mathrm{Cu}$, $\\langle 0, 1, 10, 1 \\rangle$, $V = 13.2$\n  - $\\mathrm{Ni}$, $\\langle 0, 0, 12, 0 \\rangle$, $V = 12.0$\n  - $\\mathrm{Ni}$, $\\langle 1, 0, 10, 1 \\rangle$, $V = 13.5$\n  - $\\mathrm{Al}$, $\\langle 0, 0, 12, 0 \\rangle$, $V = 16.8$\n  - $\\mathrm{Al}$, $\\langle 0, 3, 6, 3 \\rangle$, $V = 16.5$\n  - $\\mathrm{Zr}$, $\\langle 0, 0, 12, 0 \\rangle$, $V = 25.2$\n  - $\\mathrm{Zr}$, $\\langle 0, 4, 4, 4 \\rangle$, $V = 26.0$\n  - $\\mathrm{Cu}$, $\\langle 0, 0, 12, 0 \\rangle$, $V = 13.8$\n  - $\\mathrm{Ni}$, $\\langle 0, 0, 12, 0 \\rangle$, $V = 12.5$\n\n- 数据集 B:\n  - $\\mathrm{Zr}$, $\\langle 0, 0, 12, 0 \\rangle$, $V = 24.0$\n  - $\\mathrm{Zr}$, $\\langle 0, 0, 12, 0 \\rangle$, $V = 23.8$\n  - $\\mathrm{Zr}$, $\\langle 0, 1, 10, 1 \\rangle$, $V = 25.0$\n  - $\\mathrm{Cu}$, $\\langle 0, 0, 12, 0 \\rangle$, $V = 14.0$\n  - $\\mathrm{Cu}$, $\\langle 0, 2, 8, 2 \\rangle$, $V = 14.5$\n  - $\\mathrm{Ni}$, $\\langle 0, 0, 12, 0 \\rangle$, $V = 12.4$\n  - $\\mathrm{Ni}$, $\\langle 0, 0, 12, 0 \\rangle$, $V = 12.8$\n  - $\\mathrm{Al}$, $\\langle 0, 0, 12, 0 \\rangle$, $V = 17.5$\n  - $\\mathrm{Al}$, $\\langle 0, 3, 6, 3 \\rangle$, $V = 16.0$\n  - $\\mathrm{Cu}$, $\\langle 0, 0, 12, 0 \\rangle$, $V = 13.9$\n  - $\\mathrm{Zr}$, $\\langle 0, 0, 12, 0 \\rangle$, $V = 24.5$\n  - $\\mathrm{Ni}$, $\\langle 0, 1, 10, 1 \\rangle$, $V = 13.0$\n\n- 数据集 C:\n  - $\\mathrm{Zr}$, $\\langle 0, 2, 8, 2 \\rangle$, $V = 25.5$\n  - $\\mathrm{Zr}$, $\\langle 0, 3, 6, 3 \\rangle$, $V = 26.2$\n  - $\\mathrm{Cu}$, $\\langle 0, 1, 10, 1 \\rangle$, $V = 15.2$\n  - $\\mathrm{Ni}$, $\\langle 1, 0, 10, 1 \\rangle$, $V = 13.7$\n  - $\\mathrm{Al}$, $\\langle 0, 4, 4, 4 \\rangle$, $V = 18.0$\n  - $\\mathrm{Cu}$, $\\langle 0, 2, 8, 2 \\rangle$, $V = 14.2$\n  - $\\mathrm{Ni}$, $\\langle 0, 3, 6, 3 \\rangle$, $V = 12.9$\n  - $\\mathrm{Al}$, $\\langle 0, 1, 10, 1 \\rangle$, $V = 17.0$\n  - $\\mathrm{Zr}$, $\\langle 0, 1, 10, 1 \\rangle$, $V = 24.8$\n  - $\\mathrm{Cu}$, $\\langle 0, 4, 4, 4 \\rangle$, $V = 15.5$\n\n- 数据集 D:\n  - $\\mathrm{Zr}$, $\\langle 0, 0, 12, 0 \\rangle$, $V = 24.2$\n  - $\\mathrm{Zr}$, $\\langle 0, 0, 12, 0 \\rangle$, $V = 23.9$\n  - $\\mathrm{Cu}$, $\\langle 0, 0, 12, 0 \\rangle$, $V = 13.6$\n  - $\\mathrm{Ni}$, $\\langle 0, 0, 12, 0 \\rangle$, $V = 12.3$\n  - $\\mathrm{Al}$, $\\langle 0, 0, 12, 0 \\rangle$, $V = 16.6$\n  - $\\mathrm{Zr}$, $\\langle 0, 0, 12, 0 \\rangle$, $V = 24.7$\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个包含四个结果向量的列表，每个数据集一个，按 A、B、C、D 的顺序排列。每个结果向量必须是包含五个浮点数的列表，顺序如上文第2项所述。最终打印的行必须恰好是一个 Python 风格的列表的列表，例如：\n[$[$f_A, mI_A, mN_A, d_A, r_A$],$ $[$f_B, mI_B, mN_B, d_B, r_B$],$ $[$f_C, mI_C, mN_C, d_C, r_C$],$ $[$f_D, mI_D, mN_D, d_D, r_D$]$]\n其中 $f_{\\cdot}$ 是严格二十面体的分数，$mI_{\\cdot}$ 是二十面体位点中的平均 $\\phi$（如果没有则为 $0$），$mN_{\\cdot}$ 是非二十面体位点中的平均 $\\phi$（如果没有则为 $0$），$d_{\\cdot} = mI_{\\cdot} - mN_{\\cdot}$，而 $r_{\\cdot}$ 是皮尔逊相关系数 $\\rho(I,\\phi)$，在需要时使用零方差约定 $\\rho = 0$。您可以四舍五入到任何合理的小数位数；这些值是无量纲的，并且必须以小数形式打印（无百分号）。", "solution": "问题陈述已经过严格验证，并被确定为有效。它在科学上基于计算材料科学的原理，特别是使用 Voronoi 镶嵌分析非晶结构。该问题是适定的，所有术语、常数和计算过程都有明确无误的定义。它没有事实错误、矛盾和主观断言。所提供的数据对于多组分金属玻璃体系是物理上合理的。因此，我将继续提供完整解答。\n\n目标是通过将几何描述符（Voronoi 指数）与物理性质（局域堆积分数）相关联，来分析模型金属玻璃中的局域原子环境。该分析旨在量化一个假说，即局域二十面体原子排列代表了高堆积密度的构型，这是玻璃形成理论中的一个核心概念。该解答通过对每个提供的数据集执行系统的、两阶段的计算过程来实现。\n\n首先，对每个单独的原子位点进行分析。对于一个给定的位点，我们获得了其化学物种、其 Voronoi 指数 $\\langle n_{3}, n_{4}, n_{5}, n_{6} \\rangle$ 及其 Voronoi 晶胞体积 $V$。\n\n1. 化学物种（例如 $\\mathrm{Zr}$、$\\mathrm{Cu}$、$\\mathrm{Ni}$、$\\mathrm{Al}$）决定了中心原子的金属半径 $r$。指定的半径为：$r_{\\mathrm{Zr}} = 1.60 \\,\\text{\\AA}$，$r_{\\mathrm{Cu}} = 1.28 \\,\\text{\\AA}$，$r_{\\mathrm{Ni}} = 1.25 \\,\\text{\\AA}$，以及 $r_{\\mathrm{Al}} = 1.43 \\,\\text{\\AA}$。\n\n2. 计算该位点的局域原子堆积分数 $\\phi$。该量是晶体固体中原子堆积因子的局域类似物，并定义为原子体积（建模为半径为 $r$ 的球体）与其 Voronoi 晶胞体积 $V$ 之比：\n$$\n\\phi = \\frac{\\frac{4}{3}\\pi r^{3}}{V}\n$$\n更高的 $\\phi$ 值表示原子周围的空间堆积更有效率。\n\n3. 根据其 Voronoi 指数对局域配位环境进行分类。为每个位点分配一个二元指标变量 $I$。根据所提供的完美二十面体的定义，当且仅当一个位点的 Voronoi 指数恰好为 $\\langle 0, 0, 12, 0 \\rangle$ 时，该位点被分类为“严格二十面体”。因此，我们定义：\n$$\nI = \\begin{cases} 1  \\text{if Voronoi index is } \\langle 0, 0, 12, 0 \\rangle \\\\ 0  \\text{otherwise} \\end{cases}\n$$\n这种分类将位点划分为两个不同的总体以进行统计比较。请注意，虽然配位数由 $\\mathrm{CN} = n_{3} + n_{4} + n_{5} + n_{6}$ 给出，但分类严格依赖于完整的指数，而不仅仅是 $\\mathrm{CN}=12$。\n\n其次，在处理完一个数据集中的所有 $N$ 个位点以生成一组对 $\\{ (I_i, \\phi_i) \\}_{i=1}^N$ 后，计算五个聚合统计量来表征整个数据集。\n\n1. 严格二十面体位点的分数 $f$，是指标变量的算术平均值：\n$$\nf = \\frac{1}{N} \\sum_{i=1}^{N} I_i\n$$\n\n2. 使用指标 $I$ 对位点进行划分。计算严格二十面体位点（$I=1$）的平均局域堆积分数（记为 $mI$），以及非二十面体位点（$I=0$）的平均值（记为 $mN$）。根据问题陈述，如果任一总体为空，其相应的平均值定义为 $0$。\n\n3. 计算平均堆积分数之差 $d = mI - mN$。该值直接衡量了与二十面体配位相关的堆积密度的提升（如果有的话）。一个正的 $d$ 值支持二十面体序与更密集堆积相关的假说。\n\n4. 使用标准公式计算指标向量 $I$ 和堆积分数向量 $\\phi$ 之间的皮尔逊相关系数 $\\rho(I, \\phi)$：\n$$\n\\rho(I,\\phi) = \\frac{\\sum_{i=1}^{N} (I_{i}-\\overline{I}) (\\phi_{i}-\\overline{\\phi})}{\\sqrt{\\sum_{i=1}^{N} (I_{i}-\\overline{I})^{2}} \\, \\sqrt{\\sum_{i=1}^{N} (\\phi_{i}-\\overline{\\phi})^{2}}}\n$$\n其中 $\\overline{I}$ 和 $\\overline{\\phi}$ 分别是 $I$ 和 $\\phi$ 的样本均值。该系数衡量了作为二十面体的二元属性与局域堆积密度的连续属性之间的线性关系的强度和方向。按照规定，如果任一向量的方差为零（即所有位点都是二十面体或所有位点都是非二十面体），则相关系数 $\\rho(I, \\phi)$ 定义为 $0$。\n\n将此完整过程应用于测试套件中提供的四个数据集中的每一个，以生成最终结果。", "answer": "```python\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Solves the problem of analyzing local atomic environments in a metallic glass.\n    \"\"\"\n\n    # Foundational definitions and facts\n    RADII = {\n        \"Zr\": 1.60,\n        \"Cu\": 1.28,\n        \"Ni\": 1.25,\n        \"Al\": 1.43,\n    }\n    ATOMIC_VOLUMES = {\n        species: (4 / 3) * math.pi * (radius**3)\n        for species, radius in RADII.items()\n    }\n    ICOSAHEDRAL_INDEX = (0, 0, 12, 0)\n\n    # Test suite\n    datasets = {\n        \"A\": [\n            (\"Zr\", (0, 0, 12, 0), 24.8),\n            (\"Zr\", (0, 0, 12, 0), 23.5),\n            (\"Cu\", (0, 2, 8, 2), 14.7),\n            (\"Cu\", (0, 1, 10, 1), 13.2),\n            (\"Ni\", (0, 0, 12, 0), 12.0),\n            (\"Ni\", (1, 0, 10, 1), 13.5),\n            (\"Al\", (0, 0, 12, 0), 16.8),\n            (\"Al\", (0, 3, 6, 3), 16.5),\n            (\"Zr\", (0, 0, 12, 0), 25.2),\n            (\"Zr\", (0, 4, 4, 4), 26.0),\n            (\"Cu\", (0, 0, 12, 0), 13.8),\n            (\"Ni\", (0, 0, 12, 0), 12.5),\n        ],\n        \"B\": [\n            (\"Zr\", (0, 0, 12, 0), 24.0),\n            (\"Zr\", (0, 0, 12, 0), 23.8),\n            (\"Zr\", (0, 1, 10, 1), 25.0),\n            (\"Cu\", (0, 0, 12, 0), 14.0),\n            (\"Cu\", (0, 2, 8, 2), 14.5),\n            (\"Ni\", (0, 0, 12, 0), 12.4),\n            (\"Ni\", (0, 0, 12, 0), 12.8),\n            (\"Al\", (0, 0, 12, 0), 17.5),\n            (\"Al\", (0, 3, 6, 3), 16.0),\n            (\"Cu\", (0, 0, 12, 0), 13.9),\n            (\"Zr\", (0, 0, 12, 0), 24.5),\n            (\"Ni\", (0, 1, 10, 1), 13.0),\n        ],\n        \"C\": [\n            (\"Zr\", (0, 2, 8, 2), 25.5),\n            (\"Zr\", (0, 3, 6, 3), 26.2),\n            (\"Cu\", (0, 1, 10, 1), 15.2),\n            (\"Ni\", (1, 0, 10, 1), 13.7),\n            (\"Al\", (0, 4, 4, 4), 18.0),\n            (\"Cu\", (0, 2, 8, 2), 14.2),\n            (\"Ni\", (0, 3, 6, 3), 12.9),\n            (\"Al\", (0, 1, 10, 1), 17.0),\n            (\"Zr\", (0, 1, 10, 1), 24.8),\n            (\"Cu\", (0, 4, 4, 4), 15.5),\n        ],\n        \"D\": [\n            (\"Zr\", (0, 0, 12, 0), 24.2),\n            (\"Zr\", (0, 0, 12, 0), 23.9),\n            (\"Cu\", (0, 0, 12, 0), 13.6),\n            (\"Ni\", (0, 0, 12, 0), 12.3),\n            (\"Al\", (0, 0, 12, 0), 16.6),\n            (\"Zr\", (0, 0, 12, 0), 24.7),\n        ],\n    }\n\n    def analyze_dataset(dataset):\n        \"\"\"\n        Computes the five required statistical quantities for a single dataset.\n        \"\"\"\n        if not dataset:\n            return [0.0, 0.0, 0.0, 0.0, 0.0]\n\n        # Stage 1: Per-site analysis\n        indicators = []\n        packing_fractions = []\n        \n        for site in dataset:\n            species, voronoi_index, voronoi_volume = site\n            \n            # Classify site\n            is_icosahedral = 1 if voronoi_index == ICOSAHEDRAL_INDEX else 0\n            indicators.append(is_icosahedral)\n            \n            # Compute local packing fraction\n            atomic_volume = ATOMIC_VOLUMES[species]\n            phi = atomic_volume / voronoi_volume\n            packing_fractions.append(phi)\n            \n        indicators = np.array(indicators)\n        packing_fractions = np.array(packing_fractions)\n\n        # Stage 2: Dataset-level statistical analysis\n        \n        # 1. Fraction of strictly icosahedral sites\n        f_ico = np.mean(indicators)\n        \n        # 2. Mean local packing fraction among strictly icosahedral sites\n        phi_ico = packing_fractions[indicators == 1]\n        mean_phi_ico = np.mean(phi_ico) if phi_ico.size > 0 else 0.0\n        \n        # 3. Mean local packing fraction among non-icosahedral sites\n        phi_non_ico = packing_fractions[indicators == 0]\n        mean_phi_non_ico = np.mean(phi_non_ico) if phi_non_ico.size > 0 else 0.0\n        \n        # 4. Difference in means\n        diff_means = mean_phi_ico - mean_phi_non_ico\n        \n        # 5. Pearson correlation coefficient\n        # Check for zero variance as per problem specification\n        if np.std(indicators) == 0 or np.std(packing_fractions) == 0:\n            correlation = 0.0\n        else:\n            # np.corrcoef returns a 2x2 matrix, we need the off-diagonal element\n            correlation = np.corrcoef(indicators, packing_fractions)[0, 1]\n            \n        return [f_ico, mean_phi_ico, mean_phi_non_ico, diff_means, correlation]\n\n    # Process all datasets in the specified order A, B, C, D\n    all_results = []\n    for key in sorted(datasets.keys()):\n        dataset = datasets[key]\n        result_vector = analyze_dataset(dataset)\n        all_results.append(result_vector)\n    \n    # Final output formatting\n    # Using np.round for consistent floating point representation in the string\n    formatted_results = [\n        \"[\" + \",\".join(map(str, np.round(res, 8))) + \"]\" for res in all_results\n    ]\n    print(f\"[{','.join(formatted_results)}]\")\n\n\nsolve()\n```", "id": "2475684"}]}