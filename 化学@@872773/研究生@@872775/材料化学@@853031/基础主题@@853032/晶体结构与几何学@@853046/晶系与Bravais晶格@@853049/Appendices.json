{"hands_on_practices": [{"introduction": "晶体学的一个核心原则是，14种布拉维晶格代表了空间中点阵排列的所有独特方式。然而，为什么某些看似合理的晶格（如面心四方晶格）不在此列？本练习通过要求您证明一个面心四方（FCT）晶胞在数学上等同于一个更基本的体心四方（BCT）晶胞，从而揭示了传统晶胞选择背后的逻辑，这对于深刻理解布拉维晶格的唯一性至关重要 [@problem_id:2295783]。", "problem": "在固态化学中，晶格被分为14种独特的布拉维晶格，它们代表了在空间中具有平移对称性的所有可能的点排列方式。一位研究新型金属合金的晶体学家发现，其原子位置可以用一个晶胞来描述，该晶胞具有长度为 $a, a, c$ 的正交轴，并且在所有六个面的角点和中心都有格点。这被称为面心四方 (FCT) 晶格。然而，FCT 晶格不是14种传统布拉维晶格之一，因为它可以由一个更小、更基本的晶胞来表示。同一个格点晶格的传统表示是一个体心四方 (BCT) 晶胞，它有自己的一组长度为 $a'$ 和 $c'$ 的正交轴。\n\n你的任务是根据非传统 FCT 晶胞的参数 $a$ 和 $c$ 来确定传统 BCT 晶胞的晶格参数 $a'$ 和 $c'$。将你的最终答案表示为一个有序表达式对 $(a', c')$。", "solution": "设传统面心四方 (FCT) 晶胞具有正交基矢 $\\mathbf{A}_{1}=(a,0,0)$、$\\mathbf{A}_{2}=(0,a,0)$ 和 $\\mathbf{A}_{3}=(0,0,c)$。面心平移为 $\\mathbf{f}_{1}=\\left(0,\\frac{a}{2},\\frac{c}{2}\\right)$、$\\mathbf{f}_{2}=\\left(\\frac{a}{2},0,\\frac{c}{2}\\right)$ 和 $\\mathbf{f}_{3}=\\left(\\frac{a}{2},\\frac{a}{2},0\\right)$，因此布拉维晶格由 $\\mathbf{A}_{1},\\mathbf{A}_{2},\\mathbf{A}_{3}$ 以及这些中心平移矢量共同生成。\n\n定义一组新的正交基矢：\n$$\n\\mathbf{b}_{1}=\\frac{1}{2}\\left(\\mathbf{A}_{1}+\\mathbf{A}_{2}\\right)=\\left(\\frac{a}{2},\\frac{a}{2},0\\right),\\quad\n\\mathbf{b}_{2}=\\frac{1}{2}\\left(-\\mathbf{A}_{1}+\\mathbf{A}_{2}\\right)=\\left(-\\frac{a}{2},\\frac{a}{2},0\\right),\\quad\n\\mathbf{b}_{3}=\\mathbf{A}_{3}=(0,0,c).\n$$\n这些矢量满足 $\\mathbf{b}_{1}\\cdot\\mathbf{b}_{2}=0$、$\\mathbf{b}_{1}\\cdot\\mathbf{b}_{3}=0$ 和 $\\mathbf{b}_{2}\\cdot\\mathbf{b}_{3}=0$，因此它们构成一个正交四方基。它们的长度为\n$$\n|\\mathbf{b}_{1}|=\\sqrt{\\left(\\frac{a}{2}\\right)^{2}+\\left(\\frac{a}{2}\\right)^{2}}=\\frac{a}{\\sqrt{2}},\\quad\n|\\mathbf{b}_{2}|=\\frac{a}{\\sqrt{2}},\\quad\n|\\mathbf{b}_{3}|=c,\n$$\n所以相应的四方晶格参数为 $a'=\\frac{a}{\\sqrt{2}}$ 和 $c'=c$。\n\n为了确认其为体心结构，注意到该晶胞的体心矢量是\n$$\n\\frac{\\mathbf{b}_{1}+\\mathbf{b}_{2}+\\mathbf{b}_{3}}{2}=\\left(0,\\frac{a}{2},\\frac{c}{2}\\right)=\\mathbf{f}_{1},\n$$\n这是原始 FCT 晶格中存在的一个晶格平移；因此，由 $\\mathbf{b}_{i}$ 定义的传统晶胞是体心四方的。\n\n体积检验也是一致的：FCT 传统晶胞的体积是 $V_{\\mathrm{FCT}}=a^{2}c$，包含四个格点，所以原胞体积是 $\\frac{a^{2}c}{4}$。体心四方传统晶胞包含两个格点，其体积为\n$$\nV_{\\mathrm{BCT}}=a'^{2}c'=\\left(\\frac{a}{\\sqrt{2}}\\right)^{2}c=\\frac{a^{2}c}{2}=2\\times\\frac{a^{2}c}{4},\n$$\n正如所要求。\n\n因此，参数为 $(a,a,c)$ 的 FCT 晶格可以等效地由参数为 $(a',c')=\\left(\\frac{a}{\\sqrt{2}},\\,c\\right)$ 的 BCT 传统晶胞描述。", "answer": "$$\\boxed{\\left(\\frac{a}{\\sqrt{2}}, c\\right)}$$", "id": "2295783"}, {"introduction": "同一个晶格通常可以用不同的晶胞设置来描述，选择哪种设置取决于对称性和计算的便利性。本练习挑战您从第一性原理出发，通过矢量代数将一个菱方晶格从其原始菱面体设置转换为更常规的六方设置，从而掌握在不同晶体学坐标系之间进行转换的关键数学技能 [@problem_id:2477806]。这项技能对于解读文献和在不同软件之间转换结构数据至关重要。", "problem": "一个三方晶系中的三维布拉菲晶格，在原始菱方设置下，由三个长度相等（$|\\mathbf{a}_{i}|=a$）且轴间角相等（对于 $i\\neq j$，$\\angle(\\mathbf{a}_{i},\\mathbf{a}_{j})=\\alpha$）的原胞基矢 $\\mathbf{a}_{1}$、$\\mathbf{a}_{2}$、$\\mathbf{a}_{3}$ 描述。考虑 $\\alpha=\\beta=\\gamma=60^\\circ$ 且 $a=b=c=a$ 的特定情况。角度单位为度。\n\n仅使用布拉菲晶格的核心定义和 $\\mathbb{R}^{3}$ 中的欧几里得点积，通过将新的基矢定义为原始菱方基矢的线性组合，为同一晶格构建一个常规六方晶胞（六方常规晶胞中的菱方定心）：\n$$\n\\mathbf{A}_{1}=\\mathbf{a}_{2}-\\mathbf{a}_{3},\\quad\n\\mathbf{A}_{2}=\\mathbf{a}_{3}-\\mathbf{a}_{1},\\quad\n\\mathbf{A}_{3}=\\mathbf{a}_{1}+\\mathbf{a}_{2}+\\mathbf{a}_{3}.\n$$\n从第一性原理出发，推导底面晶格参数 $a_{h}=|\\mathbf{A}_{1}|=|\\mathbf{A}_{2}|$ 和 c 轴参数 $c_{h}=|\\mathbf{A}_{3}|$ 关于 $a$ 和 $\\alpha$ 的闭式表达式，然后将 $\\alpha=60^\\circ$ 代入以显式计算这些值，从而得到 $a_{h}$ 和 $c_{h}$ 作为 $a$ 的函数。\n\n以解析表达式的形式报告最终结果。无需进行数值四舍五入。最终答案中不包含单位。", "solution": "本推导的基础是欧几里得点积的定义。任意矢量 $\\mathbf{v}$ 的模的平方由 $|\\mathbf{v}|^2 = \\mathbf{v} \\cdot \\mathbf{v}$ 给出。任意两个原胞基矢 $\\mathbf{a}_{i}$ 和 $\\mathbf{a}_{j}$ 之间的点积可以用给定的参数 $a$ 和 $\\alpha$ 来表示。\n对于 $i = j$：\n$$\n\\mathbf{a}_{i} \\cdot \\mathbf{a}_{i} = |\\mathbf{a}_{i}|^2 = a^2\n$$\n对于 $i \\neq j$：\n$$\n\\mathbf{a}_{i} \\cdot \\mathbf{a}_{j} = |\\mathbf{a}_{i}| |\\mathbf{a}_{j}| \\cos(\\angle(\\mathbf{a}_{i}, \\mathbf{a}_{j})) = a \\cdot a \\cos(\\alpha) = a^2 \\cos(\\alpha)\n$$\n\n首先，我们推导底面晶格参数 $a_h = |\\mathbf{A}_1|$ 的表达式。我们计算其平方 $a_h^2$：\n$$\na_h^2 = |\\mathbf{A}_{1}|^2 = \\mathbf{A}_{1} \\cdot \\mathbf{A}_{1} = (\\mathbf{a}_{2} - \\mathbf{a}_{3}) \\cdot (\\mathbf{a}_{2} - \\mathbf{a}_{3})\n$$\n利用点积的分配律展开：\n$$\na_h^2 = \\mathbf{a}_{2} \\cdot \\mathbf{a}_{2} - \\mathbf{a}_{2} \\cdot \\mathbf{a}_{3} - \\mathbf{a}_{3} \\cdot \\mathbf{a}_{2} + \\mathbf{a}_{3} \\cdot \\mathbf{a}_{3}\n$$\n由于点积满足交换律（$\\mathbf{a}_{2} \\cdot \\mathbf{a}_{3} = \\mathbf{a}_{3} \\cdot \\mathbf{a}_{2}$），上式简化为：\n$$\na_h^2 = |\\mathbf{a}_{2}|^2 - 2(\\mathbf{a}_{2} \\cdot \\mathbf{a}_{3}) + |\\mathbf{a}_{3}|^2\n$$\n代入先前建立的点积关系：\n$$\na_h^2 = a^2 - 2(a^2 \\cos(\\alpha)) + a^2 = 2a^2 - 2a^2 \\cos(\\alpha) = 2a^2(1 - \\cos(\\alpha))\n$$\n使用半角三角恒等式 $1 - \\cos(\\alpha) = 2 \\sin^2(\\frac{\\alpha}{2})$：\n$$\na_h^2 = 2a^2 \\left( 2 \\sin^2\\left(\\frac{\\alpha}{2}\\right) \\right) = 4a^2 \\sin^2\\left(\\frac{\\alpha}{2}\\right)\n$$\n开平方根，我们得到 $a_h$ 关于 $a$ 和 $\\alpha$ 的通用表达式。由于对于菱方晶格有 $0  \\alpha  120^\\circ$，因此 $\\sin(\\alpha/2)$ 项总是正的。\n$$\na_h = \\sqrt{4a^2 \\sin^2\\left(\\frac{\\alpha}{2}\\right)} = 2a \\sin\\left(\\frac{\\alpha}{2}\\right)\n$$\n\n接下来，我们推导 c 轴参数 $c_h = |\\mathbf{A}_3|$ 的表达式。我们计算其平方 $c_h^2$：\n$$\nc_h^2 = |\\mathbf{A}_{3}|^2 = \\mathbf{A}_{3} \\cdot \\mathbf{A}_{3} = (\\mathbf{a}_{1} + \\mathbf{a}_{2} + \\mathbf{a}_{3}) \\cdot (\\mathbf{a}_{1} + \\mathbf{a}_{2} + \\mathbf{a}_{3})\n$$\n展开点积：\n$$\nc_h^2 = (\\mathbf{a}_{1} \\cdot \\mathbf{a}_{1} + \\mathbf{a}_{2} \\cdot \\mathbf{a}_{2} + \\mathbfa_{3} \\cdot \\mathbf{a}_{3}) + 2(\\mathbf{a}_{1} \\cdot \\mathbf{a}_{2} + \\mathbf{a}_{1} \\cdot \\mathbf{a}_{3} + \\mathbf{a}_{2} \\cdot \\mathbf{a}_{3})\n$$\n代入点积关系：\n$$\nc_h^2 = (a^2 + a^2 + a^2) + 2(a^2 \\cos(\\alpha) + a^2 \\cos(\\alpha) + a^2 \\cos(\\alpha))\n$$\n简化表达式：\n$$\nc_h^2 = 3a^2 + 6a^2 \\cos(\\alpha) = 3a^2(1 + 2\\cos(\\alpha))\n$$\n开平方根，我们得到 $c_h$ 关于 $a$ 和 $\\alpha$ 的通用表达式。平方根下的项必须为非负数，这将 $\\alpha$ 约束为 $\\cos(\\alpha) \\ge -1/2$，即 $\\alpha \\le 120^\\circ$。\n$$\nc_h = \\sqrt{3a^2(1 + 2\\cos(\\alpha))} = a\\sqrt{3(1 + 2\\cos(\\alpha))}\n$$\n\n现在，我们针对给定的特定情况 $\\alpha = 60^\\circ$ 计算这些通用表达式。\n我们有 $\\cos(60^\\circ) = \\frac{1}{2}$ 以及 $\\sin(\\frac{60^\\circ}{2}) = \\sin(30^\\circ) = \\frac{1}{2}$。\n\n对于底面参数 $a_h$：\n$$\na_h = 2a \\sin(30^\\circ) = 2a \\left(\\frac{1}{2}\\right) = a\n$$\n\n对于 c 轴参数 $c_h$：\n$$\nc_h = a\\sqrt{3(1 + 2\\cos(60^\\circ))} = a\\sqrt{3\\left(1 + 2\\left(\\frac{1}{2}\\right)\\right)} = a\\sqrt{3(1+1)} = a\\sqrt{3(2)} = a\\sqrt{6}\n$$\n\n对于具有 $a$ 和 $\\alpha = 60^\\circ$ 的菱方晶格，其六方晶格参数 $a_h$ 和 $c_h$ 的最终表达式为 $a_h = a$ 和 $c_h = a\\sqrt{6}$。", "answer": "$$\n\\boxed{\n(a, a\\sqrt{6})\n}\n$$", "id": "2477806"}, {"introduction": "晶格参数的精确确定是材料表征的基石，它直接将理论晶体学与实验测量（如X射线衍射）联系起来。这个实践练习将引导您完成一个真实的研究任务：从一组给定的衍射数据中，通过推导线性模型并应用加权线性回归分析，精确地提取四方晶系的晶格参数 $a$ 和 $c$ [@problem_id:2477827]。这项练习不仅巩固了您对倒易晶格的理解，还培养了处理实验数据和进行不确定性分析的关键能力。", "problem": "给定一个晶体固体中疑似四方相的指标化衍射。从一般布拉菲晶格的倒易晶格度规张量和四方晶系约束 $a=b\\neq c$ 出发，推导一个连接可测量的晶面间距与米勒指数的线性模型，并使用此模型通过加权线性回归估计晶格参数 $a$ 和 $c$ 及其标准不确定度。您的推导必须基于以下基本事实：(i) 晶面间距 $d_{hkl}$ 由晶格的倒易度规张量确定，(ii) 对于四方晶系，正空间度规张量有两个相等的面内参数 $a$ 和一个独立的面外参数 $c$，以及 (iii) 当不确定度足够小时，线性误差传播适用于参数的变换。除这些基础之外，不要假设任何专门的公式；请推导所有必要的关系。\n\n您的程序必须为每个测试用例实现以下步骤：\n- 推导可观测量 $y$（$d_{hkl}$ 的函数）的线性模型，该模型以 $h$、$k$ 和 $l$ 的二次项作为预测变量，其系数在四方晶系约束下是 $a$ 和 $c$ 的函数。\n- 使用提供的衍射数据 $\\{(h,k,l,d,\\sigma_d)\\}$，构建一个加权线性回归，其中权重是 $y$ 的方差的倒数，该方差通过一阶（线性）不确定度传播将 $d$ 的测量不确定度传播到 $y$ 的不确定度得到。\n- 从拟合的线性系数出发，通过解析变换得到 $a$ 和 $c$，并利用德尔塔方法传播参数协方差以获得 $a$ 和 $c$ 的标准不确定度。\n- 以数值形式输出 $a$ 和 $c$（单位为埃，符号 Å）及其一倍标准差不确定度，所有数值均四舍五入至 $6$ 位小数。\n\n测试套件：\n- 案例 $1$（一般类四方几何，$a$ 和 $c$ 不同）：使用以下衍射数据，其中 $d$ 的单位为埃，$\\sigma_d$ 的单位也为埃。衍射数据共八项，每项格式为 $(h,k,l,d,\\sigma_d)$：\n    - $(1,0,0,\\,4.00000000,\\,0.0020)$\n    - $(0,0,1,\\,5.00000000,\\,0.0015)$\n    - $(1,1,0,\\,2.82842712,\\,0.0025)$\n    - $(1,1,1,\\,2.46182982,\\,0.0018)$\n    - $(2,0,0,\\,2.00000000,\\,0.0022)$\n    - $(0,0,2,\\,2.50000000,\\,0.0016)$\n    - $(2,1,0,\\,1.78885438,\\,0.0021)$\n    - $(1,0,3,\\,1.53846154,\\,0.0019)$\n- 案例 $2$（接近立方对称的边界条件，其中 $a$ 和 $c$ 一致）：衍射数据\n    - $(1,0,0,\\,5.00000000,\\,0.0021)$\n    - $(0,0,1,\\,5.00000000,\\,0.0020)$\n    - $(1,1,0,\\,3.53553391,\\,0.0024)$\n    - $(1,1,1,\\,2.88675135,\\,0.0017)$\n    - $(2,0,0,\\,2.50000000,\\,0.0022)$\n    - $(0,0,2,\\,2.50000000,\\,0.0016)$\n    - $(2,1,0,\\,2.23606798,\\,0.0023)$\n    - $(2,2,0,\\,1.76776695,\\,0.0018)$\n- 案例 $3$（高各向异性，$a$ 和 $c$ 之间差异显著）：衍射数据\n    - $(1,0,0,\\,4.00000000,\\,0.0019)$\n    - $(0,0,1,\\,8.00000000,\\,0.0014)$\n    - $(1,1,0,\\,2.82842712,\\,0.0026)$\n    - $(1,1,1,\\,2.66666667,\\,0.0017)$\n    - $(2,0,0,\\,2.00000000,\\,0.0020)$\n    - $(0,0,2,\\,4.00000000,\\,0.0015)$\n    - $(2,1,0,\\,1.78885438,\\,0.0022)$\n    - $(1,0,3,\\,2.21880078,\\,0.0018)$\n\n算法和数值要求：\n- 对于每次衍射，通过将不确定度从 $d$ 解析传播到 $y$ 来定义响应 $y$ 及其标准不确定度 $\\sigma_y$。在加权最小二乘回归中使用得到的权重 $w = 1/\\sigma_y^2$ 来估计两个线性系数及其协方差矩阵。然后变换这些系数以获得 $a$ 和 $c$，并传播协方差以获得 $a$ 和 $c$ 的标准不确定度。\n- 将 $a$ 和 $c$ 以埃为单位表示，并四舍五入至 $6$ 位小数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序为\n$[a_1,c_1,u(a_1),u(c_1),a_2,c_2,u(a_2),u(c_2),a_3,c_3,u(a_3),u(c_3)]$，\n其中 $a_i$ 和 $c_i$ 是测试用例 $i$ 的估计晶格参数（单位为埃），$u(a_i)$ 和 $u(c_i)$ 是它们的一倍标准差不确定度（单位为埃），所有数值均保留 $6$ 位小数。\n\n角度单位不适用。除长度单位埃之外，不需要其他物理单位。最终输出格式必须是严格的一行，包含如上所述的列表（例如，$[a_1,c_1,u(a_1),u(c_1),\\dots]$）。", "solution": "解决方案分三个阶段展开：首先，推导关联晶格参数与衍射数据的线性模型；其次，构建加权线性回归的流程；第三，阐述将回归结果及其不确定度转换为最终晶格参数的方法。\n\n**1. 线性模型的推导**\n\n正空间和倒易空间之间的关系是基础。对于一组正晶格基矢 $\\{\\vec{a}_1, \\vec{a}_2, \\vec{a}_3\\}$，正空间度规张量定义为 $G_{ij} = \\vec{a}_i \\cdot \\vec{a}_j$。对于四方晶格，常规基矢是正交的，其长度受约束，使得 $|\\vec{a}_1| = |\\vec{a}_2| = a$ 且 $|\\vec{a}_3| = c$。不失一般性，我们可以将它们与笛卡尔坐标系对齐：$\\vec{a}_1 = (a, 0, 0)$，$\\vec{a}_2 = (0, a, 0)$，以及 $\\vec{a}_3 = (0, 0, c)$。因此，正度规张量 $G$ 是对角的：\n$$\nG = \n\\begin{pmatrix}\na^2  0  0 \\\\\n0  a^2  0 \\\\\n0  0  c^2\n\\end{pmatrix}\n$$\n倒易晶格基矢 $\\{\\vec{a}^*_1, \\vec{a}^*_2, \\vec{a}^*_3\\}$ 与正晶格基矢的关系为 $\\vec{a}_i \\cdot \\vec{a}^*_j = \\delta_{ij}$。倒易度规张量 $G^*$ 的元素为 $G^*_{ij} = \\vec{a}^*_i \\cdot \\vec{a}^*_j$，它是正度规张量的逆，即 $G^* = G^{-1}$。\n$$\nG^* = \n\\begin{pmatrix}\n1/a^2  0  0 \\\\\n0  1/a^2  0 \\\\\n0  0  1/c^2\n\\end{pmatrix}\n$$\n对于给定的衍射 $(hkl)$，倒易晶格矢量为 $\\vec{g}_{hkl} = h\\vec{a}^*_1 + k\\vec{a}^*_2 + l\\vec{a}^*_3$。该矢量的模长通过 $|\\vec{g}_{hkl}| = 1/d_{hkl}$ 与晶面间距 $d_{hkl}$ 相关。其模长的平方是使用倒易度规张量的二次型计算的：\n$$\n|\\vec{g}_{hkl}|^2 = \\left(\\frac{1}{d_{hkl}}\\right)^2 = \\begin{pmatrix} h  k  l \\end{pmatrix} G^* \\begin{pmatrix} h \\\\ k \\\\ l \\end{pmatrix}\n$$\n代入四方晶系的 $G^*$ 分量，得到中心方程：\n$$\n\\frac{1}{d_{hkl}^2} = h^2\\left(\\frac{1}{a^2}\\right) + k^2\\left(\\frac{1}{a^2}\\right) + l^2\\left(\\frac{1}{c^2}\\right)\n$$\n该方程可以重排为适合回归的线性形式：\n$$\n\\frac{1}{d_{hkl}^2} = \\left(h^2 + k^2\\right)\\frac{1}{a^2} + l^2\\frac{1}{c^2}\n$$\n这样就建立了所需的线性模型。我们定义响应变量 $y$、预测变量 $x_1$ 和 $x_2$ 以及系数 $\\beta_1$ 和 $\\beta_2$：\n- 响应：$y = 1/d_{hkl}^2$\n- 预测变量：$x_1 = h^2 + k^2$，$x_2 = l^2$\n- 系数：$\\beta_1 = 1/a^2$，$\\beta_2 = 1/c^2$\n\n线性模型为 $y = \\beta_1 x_1 + \\beta_2 x_2$。\n\n**2. 加权线性回归**\n\n给定一组 $N$ 个观测值 $\\{(h_i, k_i, l_i, d_i, \\sigma_{d_i})\\}_{i=1}^N$，我们可以将方程组写成矩阵形式 $\\mathbf{y} = \\mathbf{X}\\boldsymbol{\\beta} + \\boldsymbol{\\epsilon}$，其中 $\\mathbf{y}$ 是响应值的 $N \\times 1$ 向量，$\\mathbf{X}$ 是 $N \\times 2$ 的设计矩阵，$\\boldsymbol{\\beta}$ 是系数的 $2 \\times 1$ 向量，$\\boldsymbol{\\epsilon}$ 是误差向量。\n$$\n\\mathbf{y} = \\begin{pmatrix} 1/d_1^2 \\\\ \\vdots \\\\ 1/d_N^2 \\end{pmatrix}, \\quad\n\\mathbf{X} = \\begin{pmatrix} h_1^2+k_1^2  l_1^2 \\\\ \\vdots  \\vdots \\\\ h_N^2+k_N^2  l_N^2 \\end{pmatrix}, \\quad\n\\boldsymbol{\\beta} = \\begin{pmatrix} \\beta_1 \\\\ \\beta_2 \\end{pmatrix}\n$$\n$d_i$ 的测量具有相关的不确定度 $\\sigma_{d_i}$，这些不确定度会传播到响应变量 $y_i = d_i^{-2}$。使用一阶不确定度传播：\n$$\n\\sigma_{y_i}^2 \\approx \\left(\\frac{\\partial y_i}{\\partial d_i}\\right)^2 \\sigma_{d_i}^2 = \\left(-2d_i^{-3}\\right)^2 \\sigma_{d_i}^2 = \\frac{4\\sigma_{d_i}^2}{d_i^6}\n$$\n因此，观测值 $y_i$ 具有非均匀方差。为了获得 $\\boldsymbol{\\beta}$ 的有效无偏估计，我们必须使用加权最小二乘法 (WLS)。每个观测值的权重是其方差的倒数，$w_i = 1/\\sigma_{y_i}^2$。我们构建一个对角权重矩阵 $\\mathbf{W}$，其中 $W_{ii} = w_i$。$\\boldsymbol{\\beta}$ 的 WLS 估计由正规方程给出：\n$$\n\\hat{\\boldsymbol{\\beta}} = (\\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{W} \\mathbf{y}\n$$\n估计系数的协方差矩阵 $\\mathbf{C}_{\\beta} = \\text{Cov}(\\hat{\\boldsymbol{\\beta}})$ 为：\n$$\n\\mathbf{C}_{\\beta} = (\\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1} = \\begin{pmatrix} \\sigma_{\\beta_1}^2  \\text{cov}(\\beta_1, \\beta_2) \\\\ \\text{cov}(\\beta_1, \\beta_2)  \\sigma_{\\beta_2}^2 \\end{pmatrix}\n$$\n\n**3. 参数变换和不确定度传播**\n\n估计系数 $\\hat{\\boldsymbol{\\beta}} = [\\hat{\\beta}_1, \\hat{\\beta}_2]^T$ 与晶格参数 $a$ 和 $c$ 的关系如下：\n$$\na = 1/\\sqrt{\\hat{\\beta}_1} = \\hat{\\beta}_1^{-1/2}\n$$\n$$\nc = 1/\\sqrt{\\hat{\\beta}_2} = \\hat{\\beta}_2^{-1/2}\n$$\n通过使用德尔塔方法从 $\\hat{\\boldsymbol{\\beta}}$ 传播不确定度，可以确定 $a$ 和 $c$ 的不确定度。变换后参数的协方差矩阵 $\\mathbf{C}_p$（其中 $\\mathbf{p} = [a, c]^T$）由 $\\mathbf{C}_p \\approx \\mathbf{J} \\mathbf{C}_{\\beta} \\mathbf{J}^T$ 给出，其中 $\\mathbf{J}$ 是变换的雅可比矩阵：\n$$\n\\mathbf{J} = \\begin{pmatrix} \\frac{\\partial a}{\\partial \\beta_1}  \\frac{\\partial a}{\\partial \\beta_2} \\\\ \\frac{\\partial c}{\\partial \\beta_1}  \\frac{\\partial c}{\\partial \\beta_2} \\end{pmatrix} = \\begin{pmatrix} -\\frac{1}{2}\\beta_1^{-3/2}  0 \\\\ 0  -\\frac{1}{2}\\beta_2^{-3/2} \\end{pmatrix}\n$$\n因此，$a$ 和 $c$ 的方差，即 $\\mathbf{C}_p$ 的对角元素，为：\n$$\n\\sigma_a^2 = \\left(-\\frac{1}{2}\\hat{\\beta}_1^{-3/2}\\right)^2 \\sigma_{\\beta_1}^2 = \\frac{1}{4}\\hat{\\beta}_1^{-3} \\sigma_{\\beta_1}^2\n$$\n$$\n\\sigma_c^2 = \\left(-\\frac{1}{2}\\hat{\\beta}_2^{-3/2}\\right)^2 \\sigma_{\\beta_2}^2 = \\frac{1}{4}\\hat{\\beta}_2^{-3} \\sigma_{\\beta_2}^2\n$$\n标准不确定度 $u(a)$ 和 $u(c)$ 是这些方差的平方根：\n$$\nu(a) = \\sigma_a = \\frac{1}{2}\\hat{\\beta}_1^{-3/2} \\sigma_{\\beta_1}\n$$\n$$\nu(c) = \\sigma_c = \\frac{1}{2}\\hat{\\beta}_2^{-3/2} \\sigma_{\\beta_2}\n$$\n\n**算法步骤：**\n对于每个测试用例：\n1.  对于每次衍射 $(h_i, k_i, l_i, d_i, \\sigma_{d_i})$，计算 $y_i = d_i^{-2}$，$x_{i1} = h_i^2+k_i^2$，$x_{i2} = l_i^2$ 和 $w_i = d_i^6 / (4\\sigma_{d_i}^2)$。\n2.  构建矩阵 $\\mathbf{y}$、$\\mathbf{X}$ 和 $\\mathbf{W}$。\n3.  计算 $\\hat{\\boldsymbol{\\beta}} = (\\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{W} \\mathbf{y}$。\n4.  计算协方差矩阵 $\\mathbf{C}_{\\beta} = (\\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1}$。\n5.  从 $\\hat{\\boldsymbol{\\beta}}$ 和 $\\mathbf{C}_{\\beta}$ 中提取 $\\hat{\\beta}_1, \\hat{\\beta}_2$ 及其方差 $\\sigma_{\\beta_1}^2, \\sigma_{\\beta_2}^2$。\n6.  计算参数 $a = 1/\\sqrt{\\hat{\\beta}_1}$ 和 $c = 1/\\sqrt{\\hat{\\beta}_2}$。\n7.  计算标准不确定度 $u(a) = \\frac{1}{2}\\hat{\\beta}_1^{-3/2}\\sqrt{\\sigma_{\\beta_1}^2}$ 和 $u(c) = \\frac{1}{2}\\hat{\\beta}_2^{-3/2}\\sqrt{\\sigma_{\\beta_2}^2}$。\n8.  按要求格式化结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for tetragonal lattice parameters a and c and their uncertainties\n    using weighted linear regression, based on diffraction data.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: General tetragonal-like geometry\n        [\n            (1, 0, 0, 4.00000000, 0.0020),\n            (0, 0, 1, 5.00000000, 0.0015),\n            (1, 1, 0, 2.82842712, 0.0025),\n            (1, 1, 1, 2.46182982, 0.0018),\n            (2, 0, 0, 2.00000000, 0.0022),\n            (0, 0, 2, 2.50000000, 0.0016),\n            (2, 1, 0, 1.78885438, 0.0021),\n            (1, 0, 3, 1.53846154, 0.0019),\n        ],\n        # Case 2: Near cubic symmetry\n        [\n            (1, 0, 0, 5.00000000, 0.0021),\n            (0, 0, 1, 5.00000000, 0.0020),\n            (1, 1, 0, 3.53553391, 0.0024),\n            (1, 1, 1, 2.88675135, 0.0017),\n            (2, 0, 0, 2.50000000, 0.0022),\n            (0, 0, 2, 2.50000000, 0.0016),\n            (2, 1, 0, 2.23606798, 0.0023),\n            (2, 2, 0, 1.76776695, 0.0018),\n        ],\n        # Case 3: High anisotropy\n        [\n            (1, 0, 0, 4.00000000, 0.0019),\n            (0, 0, 1, 8.00000000, 0.0014),\n            (1, 1, 0, 2.82842712, 0.0026),\n            (1, 1, 1, 2.66666667, 0.0017),\n            (2, 0, 0, 2.00000000, 0.0020),\n            (0, 0, 2, 4.00000000, 0.0015),\n            (2, 1, 0, 1.78885438, 0.0022),\n            (1, 0, 3, 2.21880078, 0.0018),\n        ],\n    ]\n\n    results = []\n    \n    for case_data in test_cases:\n        # 1. Construct matrices for linear regression\n        y_list = []\n        X_list = []\n        w_list = []\n\n        for h, k, l, d, sigma_d in case_data:\n            # Response variable y = 1/d^2\n            y_i = 1.0 / (d * d)\n            y_list.append(y_i)\n            \n            # Predictor variables x1 = h^2 + k^2, x2 = l^2\n            x1_i = float(h**2 + k**2)\n            x2_i = float(l**2)\n            X_list.append([x1_i, x2_i])\n            \n            # Uncertainty in y, sigma_y^2 = (4 * sigma_d^2) / d^6\n            sigma_y_sq = (4.0 * sigma_d**2) / (d**6)\n            \n            # Weight w = 1 / sigma_y^2\n            w_i = 1.0 / sigma_y_sq\n            w_list.append(w_i)\n\n        y = np.array(y_list)\n        X = np.array(X_list)\n        W = np.diag(w_list)\n\n        # 2. Perform weighted least squares\n        # beta_hat = (X.T @ W @ X)^-1 @ X.T @ W @ y\n        XT_W_X = X.T @ W @ X\n        C_beta = np.linalg.inv(XT_W_X)\n        XT_W_y = X.T @ W @ y\n        beta_hat = C_beta @ XT_W_y\n\n        beta1_hat = beta_hat[0]\n        beta2_hat = beta_hat[1]\n\n        # 3. Extract variances of beta coefficients\n        var_beta1 = C_beta[0, 0]\n        var_beta2 = C_beta[1, 1]\n\n        # 4. Transform coefficients to lattice parameters\n        # a = 1 / sqrt(beta1), c = 1 / sqrt(beta2)\n        a = 1.0 / np.sqrt(beta1_hat)\n        c = 1.0 / np.sqrt(beta2_hat)\n        \n        # 5. Propagate uncertainties using the delta method\n        # u(a) = 0.5 * beta1^(-3/2) * u(beta1)\n        # u(c) = 0.5 * beta2^(-3/2) * u(beta2)\n        u_a = 0.5 * np.power(beta1_hat, -1.5) * np.sqrt(var_beta1)\n        u_c = 0.5 * np.power(beta2_hat, -1.5) * np.sqrt(var_beta2)\n\n        # 6. Append results, rounded to 6 decimal places\n        results.extend([\n            round(a, 6),\n            round(c, 6),\n            round(u_a, 6),\n            round(u_c, 6)\n        ])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2477827"}]}