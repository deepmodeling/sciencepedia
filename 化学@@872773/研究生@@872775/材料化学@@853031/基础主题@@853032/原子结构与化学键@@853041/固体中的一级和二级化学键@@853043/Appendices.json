{"hands_on_practices": [{"introduction": "理解材料的宏观属性始于对其原子间相互作用势能的微观描述。本练习采用广义的米氏势（Mie potential），这是一个描述原子间相互作用的强大理论模型，旨在让学生从第一性原理出发，推导出如平衡键长、结合能和刚度指数等关键的化学键特征。通过这个实践（[@problem_id:2515757]），你将能够深化对数学势能函数与材料刚度等物理性质之间内在联系的理解。", "problem": "一族晶体固体可以用对心力近似来建模，其最近邻之间的主键由广义米氏势描述：\n$$U(r)=A\\,r^{-n}-B\\,r^{-m},$$\n其中 $A0$，$B0$，且指数满足 $nm0$。假设平衡键长 $r_0$ 由 $U(r)$ 的最小值确定，并且围绕 $r_0$ 的小振动由谐振子近似描述，其刚度由二阶导数 $U''(r_0)$ 给出。为将指数 $(n,m)$ 与键刚度相对于内聚强度的内禀量度联系起来，定义无量纲刚度指数\n$$S(n,m)\\equiv \\frac{r_0^{2}\\,U''(r_0)}{|U(r_0)|}.$$\n仅从势能最小值的力学平衡定义（一阶导数为 0 且曲率为正）、小位移的谐振子近似以及给定的 $U(r)$ 出发，完成以下任务：\n- 推导平衡键长 $r_0$。\n- 推导结合能（势阱深度）$D\\equiv |U(r_0)|$。\n- 推导 $S(n,m)$，并利用其对 $(n,m)$ 的依赖关系，从原理上合理解释增加排斥壁的陡峭程度和长程吸引如何改变主键合固体与次级键合固体中内禀键刚度相对于内聚势阱深度的关系。\n\n将你的最终结果以单个行矩阵的形式报告，按顺序包含 $r_0$、$D$ 和 $S(n,m)$ 的表达式。最终答案仅用 $A$、$B$、$n$ 和 $m$ 的符号形式表示；不要附加单位。不需要进行数值取整。", "solution": "该问题陈述具有科学依据，表述清晰，客观且自洽。它是在材料物理学中将微积分应用于原子间势基本概念的一个标准练习。因此，该问题是有效的，并将提供解答。\n\n两个原子之间的对势能 $U(r)$ 由广义米氏势给出：\n$$U(r) = A r^{-n} - B r^{-m}$$\n给定约束条件 $A0$，$B0$ 和 $nm0$。第一项 $A r^{-n}$ 代表短程排斥相互作用，而第二项 $-B r^{-m}$ 代表长程吸引相互作用。条件 $nm$ 确保了在非常小的间距（$r \\to 0$）时排斥占主导地位，在较大的间距时吸引占主导地位，从而形成一个稳定的势能最小值。\n\n首先，我们必须求出势能 $U(r)$ 对原子间距 $r$ 的一阶和二阶导数。\n一阶导数为：\n$$U'(r) = \\frac{dU}{dr} = -n A r^{-n-1} - (-m) B r^{-m-1} = -n A r^{-n-1} + m B r^{-m-1}$$\n二阶导数为：\n$$U''(r) = \\frac{d^2U}{dr^2} = -n(-n-1) A r^{-n-2} + m(-m-1) B r^{-m-2} = n(n+1) A r^{-n-2} - m(m+1) B r^{-m-2}$$\n\n平衡键长 $r_0$ 位于势能曲线的最小值处。势能最小值的条件是一阶导数为零，$U'(r_0) = 0$，且二阶导数为正，$U''(r_0)  0$。\n令 $U'(r_0) = 0$：\n$$-n A r_0^{-n-1} + m B r_0^{-m-1} = 0$$\n$$m B r_0^{-m-1} = n A r_0^{-n-1}$$\n为了解出 $r_0$，我们可以重排方程。假设 $r_0 \\neq 0$，我们可以乘以 $r_0^{n+1}$：\n$$m B r_0^{n-m} = n A$$\n$$r_0^{n-m} = \\frac{n A}{m B}$$\n这给出了平衡键长的表达式：\n$$r_0 = \\left(\\frac{n A}{m B}\\right)^{\\frac{1}{n-m}}$$\n\n为确认这对应于一个稳定的最小值，我们必须检查 $U''(r_0)$ 的符号。根据平衡条件，我们可以用 $A$ 表示 $B$：$m B = n A r_0^{-(n-m)}$。将此代入 $U''(r)$ 的表达式中：\n$$U''(r_0) = n(n+1) A r_0^{-n-2} - (m+1) (m B) r_0^{-m-2}$$\n$$U''(r_0) = n(n+1) A r_0^{-n-2} - (m+1) (n A r_0^{-(n-m)}) r_0^{-m-2}$$\n$$U''(r_0) = n(n+1) A r_0^{-n-2} - n(m+1) A r_0^{-n-m-m-2} = n(n+1) A r_0^{-n-2} - n(m+1) A r_0^{-n-2}$$\n$$U''(r_0) = A n r_0^{-n-2} \\left[ (n+1) - (m+1) \\right]$$\n$$U''(r_0) = A n (n-m) r_0^{-n-2}$$\n因为 $A0$，$n0$，$r_00$，且给定 $nm$，所以项 $(n-m)$ 为正。因此，$U''(r_0)  0$，这证实了 $r_0$ 对应于一个稳定的平衡位置。\n\n接下来，我们推导结合能 $D$，即势阱的深度，定义为 $D \\equiv |U(r_0)|$。由于我们找到了一个稳定的最小值，$U(r_0)$ 将为负值，所以 $D = -U(r_0)$。\n$$U(r_0) = A r_0^{-n} - B r_0^{-m}$$\n我们可以利用平衡条件 $n A r_0^{-n} = m B r_0^{-m}$ 来简化这个表达式，得到 $A r_0^{-n} = \\frac{m}{n} B r_0^{-m}$。\n将此代入势能表达式：\n$$U(r_0) = \\left(\\frac{m}{n} B r_0^{-m}\\right) - B r_0^{-m} = B r_0^{-m} \\left(\\frac{m}{n} - 1\\right) = -B r_0^{-m} \\left(\\frac{n-m}{n}\\right)$$\n因此，结合能 $D$ 为：\n$$D = -U(r_0) = B \\left(\\frac{n-m}{n}\\right) r_0^{-m}$$\n为了仅用初始参数 $A$、$B$、$n$ 和 $m$ 来表示 $D$，我们代入 $r_0$ 的表达式：\n$$D = B \\left(\\frac{n-m}{n}\\right) \\left[ \\left(\\frac{n A}{m B}\\right)^{\\frac{1}{n-m}} \\right]^{-m} = B \\left(\\frac{n-m}{n}\\right) \\left(\\frac{n A}{m B}\\right)^{-\\frac{m}{n-m}}$$\n\n最后，我们推导无量纲刚度指数 $S(n, m)$，其定义为：\n$$S(n,m) \\equiv \\frac{r_0^2 U''(r_0)}{|U(r_0)|} = \\frac{r_0^2 U''(r_0)}{D}$$\n我们已经推导出了分子和分母的表达式。\n分子：$r_0^2 U''(r_0) = r_0^2 \\left( A n (n-m) r_0^{-n-2} \\right) = A n (n-m) r_0^{-n}$。\n分母：$D = -U(r_0)$。我们通过代入 $B r_0^{-m} = \\frac{n}{m} A r_0^{-n}$ 来使用 $U(r_0)$ 的另一种形式：\n$$U(r_0) = A r_0^{-n} - \\left(\\frac{n}{m} A r_0^{-n}\\right) = A r_0^{-n} \\left(1 - \\frac{n}{m}\\right) = -A r_0^{-n} \\left(\\frac{n-m}{m}\\right)$$\n所以，分母是 $D = A r_0^{-n} \\left(\\frac{n-m}{m}\\right)$。\n现在，我们计算 $S(n,m)$ 的比率：\n$$S(n,m) = \\frac{A n (n-m) r_0^{-n}}{A r_0^{-n} \\left(\\frac{n-m}{m}\\right)}$$\n只要 $n \\neq m$，项 $A$、$r_0^{-n}$ 和 $(n-m)$ 就会消去。\n$$S(n,m) = \\frac{n}{\\frac{1}{m}} = nm$$\n这个非常简单的结果为我们理解化学键的性质提供了洞见。指数 $S$ 是势阱曲率相对于其深度的量度。对于给定的结合能，较大的 $S$ 值意味着一个“更尖锐”或“更窄”的势阱，这对应于一个内禀刚度更大的键。\n\n结果 $S(n,m) = nm$ 表明，内禀刚度随着排斥指数 $n$ 和吸引指数 $m$ 的增加而增加。增加 $n$ 使排斥壁更陡峭。增加 $m$ 使吸引力随距离衰减得更快，从而有效地使相互作用的程更短。这两种效应都有助于使势阱变窄，从而增加相对刚度 $S$。\n这可以用来合理解释不同键合类型之间的差异。\n- **主键**（如共价键）具有高度的方向性和短程性，在此模型中对应于较大的 $n$ 和 $m$ 值，从而导致较大的 $S$ 值。这表示一个非常尖锐且明确的势能最小值。\n- **次级键**（如范德华力）较弱且程较长。其吸引部分源于感生偶极子，通常具有 $r^{-6}$ 的依赖关系，因此 $m=6$。排斥部分通常用 $n=12$ 来建模。这得到 $S = 12 \\times 6 = 72$。\n- **离子键**具有长程库仑吸引力，$r^{-1}$，因此 $m=1$。排斥指数 $n$ 通常在 $9$-$12$ 左右。对于 $n=9$，$m=1$，我们得到 $S = 9 \\times 1 = 9$。\n离子键模型的 $S$ 值比范德华力模型的 $S$ 值小，但这并不意味着离子键更弱；相反，其绝对刚度 $U''(r_0)$ 和结合能 $D$ 要大得多。这意味着由于库仑相互作用的长程 $1/r$ 性质，离子势阱相对于其深度非常宽。相比之下，程更短的范德华相互作用（$1/r^6$）导致了一个相对更窄的势阱，因此无量纲指数 $S$ 的值更大。因此，指数 $S=nm$ 正确地量化了由排斥和吸引指数决定的势阱的内禀“尖锐度”。\n\n将 $r_0$、$D$ 和 $S(n,m)$ 的最终表达式汇总为最终答案。\n$$r_0 = \\left(\\frac{nA}{mB}\\right)^{\\frac{1}{n-m}}$$\n$$D = B \\left(\\frac{n-m}{n}\\right) \\left(\\frac{nA}{mB}\\right)^{-\\frac{m}{n-m}}$$\n$$S(n,m) = nm$$", "answer": "$$ \\boxed{ \\begin{pmatrix} \\left(\\frac{nA}{mB}\\right)^{\\frac{1}{n-m}}  B\\left(\\frac{n-m}{n}\\right)\\left(\\frac{nA}{mB}\\right)^{-\\frac{m}{n-m}}  nm \\end{pmatrix} } $$", "id": "2515757"}, {"introduction": "在离子晶体中，主要的内聚能来源于长程的库仑相互作用，但对这种交错电荷阵列的直接求和在数学上是条件收敛的，处理起来极具挑战性。本练习（[@problem_id:2515797]）将指导你应用埃瓦尔德求和（Ewald summation）这一计算物理学中的基石技术，来精确计算马德隆常数。亲手实现该算法将为你提供处理条件收敛级数和理解周期性体系静电能的宝贵实践经验。", "problem": "您将编写一个完整、可运行的程序，通过使用埃瓦尔德求和法计算参考离子处的静电势，来计算岩盐（氯化钠）结构的无量纲马德隆常数。计算必须将贡献划分为实空间和与倒易空间和，并包含正确的自相互作用校正。您的任务是以数值稳定且快速收敛的方式实现此方法，并评估一组精心挑选的参数集测试套件，以探究关于埃瓦尔德分裂参数和求和截断的收敛性。\n\n基本原理与定义：\n- 考虑一个周期性、三维、电中性的离子晶体，它由一个布拉维晶格和一组有限的点电荷基元描述。某一点由于点电荷产生的静电势由库仑定律给出。对于交替符号电荷阵列，$1/r$ 的直接晶格求和是条件收敛的，必须进行正则化处理。埃瓦尔德求和技术是一种经过充分检验的标准方法，它通过加减一个高斯屏蔽电荷，将库仑核分解为一个快速收敛的实空间部分和一个快速收敛的倒易空间部分，外加一个自相互作用校正。当求和完全收敛时，得到的总和与人为引入的分裂参数无关。\n\n使用的几何结构：\n- 使用在边长为 $a$ 的常规立方晶胞中实现的岩盐结构。选择 $a = 2$，使得最近邻距离为 $a/2 = 1$，确保马德隆常数等于参考位点静电势的绝对值，因此是无量纲的。\n- 在原点 $(0,0,0)$ 放置一个电荷为 $+1$ 的参考离子。\n- 每个常规晶胞使用包含 8 个电荷的基元，其位置（每个坐标都在区间 $[0,a)$ 内）和电荷如下：\n  - 正电荷 $+1$ 位于 $(0,0,0)$、$(0,a/2,a/2)$、$(a/2,0,a/2)$、$(a/2,a/2,0)$。\n  - 负电荷 $-1$ 位于 $(a/2,0,0)$、$(0,a/2,0)$、$(0,0,a/2)$、$(a/2,a/2,a/2)$。\n- 布拉维晶格是简单立方晶格，其平移矢量为 $\\mathbf{T} = (i a, j a, k a)$，其中 $i,j,k \\in \\mathbb{Z}$。\n- 倒易晶格矢量为 $\\mathbf{k} = \\frac{2\\pi}{a}(m_x, m_y, m_z)$，其中 $m_x,m_y,m_z \\in \\mathbb{Z}$。\n- 晶胞体积为 $V = a^3$。\n\n目标量：\n- 设 $\\phi$ 为无限晶体中（无外场，无表面）所有其他离子在参考离子处产生的静电势。根据离子固体的惯例，将马德隆常数 $M$ 定义为正标量 $M = -\\phi$，其中最近邻距离等于 $1$。因为 $a=2$，最近邻距离为 $1$，所以 $M$ 精确等于计算出的参考离子处电势的绝对值。\n\n实现要求：\n- 通过将电势划分为对 $\\mathbf{T}$ 和基元电荷的实空间求和、对 $\\mathbf{k} \\neq \\mathbf{0}$ 的倒易空间求和，以及对参考位点点电荷的标准自相互作用校正，来实现埃瓦尔德求和。该体系每个晶胞是电中性的，因此没有 $\\mathbf{k}=\\mathbf{0}$ 项。您决不能在实空间求和中包含参考离子的自贡献项。\n- 高斯分裂参数是一个正实数，记为 $\\eta$（单位为长度的倒数）。在本问题中，所有长度都以最近邻距离为单位进行测量，因此一旦将 $a$ 固定为 $2$，$\\eta$ 就是无量纲的。\n- 通过将 $i,j,k$ 限制在 $\\{-N_r, \\ldots, N_r\\}$ 范围内来截断实空间求和，其中 $N_r$ 为整数截断值。\n- 通过将 $m_x,m_y,m_z$ 限制在 $\\{-N_k, \\ldots, N_k\\}$ 范围内来截断倒易空间求和，其中 $N_k$ 为整数截断值，并排除 $(m_x,m_y,m_z) = (0,0,0)$。\n- 您的程序必须为测试套件中的每个参数集计算 $M$ 并输出结果。\n\n数值细节：\n- 精确使用 $a = 2$。在实空间项中使用标准的互补误差函数，在倒易空间项中使用指数衰减。每种情况的最终结果是代表 $M$ 的单个浮点数。\n- 在此设置中，所有量都是无量纲的。不应报告任何物理单位。\n\n测试套件：\n按照以下精确顺序，为下列 $(\\eta, N_r, N_k)$ 集合计算马德隆常数 $M$：\n- 案例 $1$：$(\\eta, N_r, N_k) = (1.2, 6, 6)$。\n- 案例 $2$：$(\\eta, N_r, N_k) = (3.5, 6, 6)$。\n- 案例 $3$：$(\\eta, N_r, N_k) = (6.0, 12, 3)$。\n- 案例 $4$：$(\\eta, N_r, N_k) = (0.8, 3, 12)$。\n- 案例 $5$：$(\\eta, N_r, N_k) = (2.5, 1, 1)$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含五个案例的结果，格式为方括号内以逗号分隔的列表，每个数字四舍五入到恰好九位小数，例如 $[x_1,x_2,x_3,x_4,x_5]$。顺序必须与测试套件的顺序相匹配。", "solution": "所述问题是有效的。这是一个在计算材料物理学中定义明确、有科学依据的问题，要求使用标准的埃瓦尔德求和方法计算岩盐晶体结构的马德隆常数。所有必要的参数、几何定义和数值约束均已提供且内部一致。因此，我们将着手解决此问题。\n\n基本任务是计算在一个无限、周期性晶体中，所有其他离子在参考离子（我们将其置于原点 $\\mathbf{r}=\\mathbf{0}$）处产生的静电势 $\\phi$。马德隆常数 $M$ 由此电势定义。对于参考电荷 $q_{\\text{ref}}$ 和最近邻距离 $R$，定义为 $M = -\\frac{\\phi R}{q_{\\text{ref}}}$。该问题设定晶格参数 $a=2$，这使得最近邻距离为 $R=a/2=1$，参考离子电荷为 $q_{\\text{ref}}=+1$。所有量都是无量纲的。因此，马德隆常数就是 $M = -\\phi$。\n\n该电势由遍布整个晶格的所有离子电荷 $q_p$（位于位置 $\\mathbf{r}_p$）的直接求和给出：\n$$\n\\phi = \\sum_{p \\neq \\text{ref}} \\frac{q_p}{|\\mathbf{r}_p|}\n$$\n这个和是条件收敛的，在数值上难以处理。埃瓦尔德求和方法为其计算提供了一个稳健的程序，它将总和分为三个部分：一个快速收敛的实空间和 $\\phi_{\\text{real}}$，一个快速收敛的倒易空间和 $\\phi_{\\text{recip}}$，以及一个自相互作用校正项 $\\phi_{\\text{self}}$。\n$$\n\\phi = \\phi_{\\text{real}} + \\phi_{\\text{recip}} + \\phi_{\\text{self}}\n$$\n我们现在将定义每一项，并针对给定的岩盐结构进行特化。\n\n该晶体结构由参数为 $a=2$ 的简单立方布拉维晶格定义。晶格矢量为 $\\mathbf{T}_{ijk} = a(i, j, k)$，其中 $i,j,k$ 为整数。基元由常规晶胞内的 8 个离子组成，其电荷为 $q_p$，位置为 $\\mathbf{r}^{\\text{basis}}_p$。晶体中任意一个离子的位置为 $\\mathbf{r}_{ijk,p} = \\mathbf{T}_{ijk} + \\mathbf{r}^{\\text{basis}}_p$。参考离子是位于原点的 $p=1$ 离子。\n\n**1. 实空间和 ($\\phi_{\\text{real}}$)**\n此项解释了短程相互作用。它是对所有离子（不包括原点处的参考离子）的求和，其中库仑势 $1/r$ 被互补误差函数 $\\text{erfc}(x)$ 所屏蔽。分裂参数 $\\eta$ 控制了此相互作用的范围。\n$$\n\\phi_{\\text{real}} = \\sum_{i,j,k} \\sum_{p=1}^{8} ' \\; \\frac{q_p \\text{erfc}(\\eta |\\mathbf{r}_{ijk,p}|)}{|\\mathbf{r}_{ijk,p}|}\n$$\n带撇号的求和表示排除了参考离子本身（$i=j=k=0, p=1$）的项。对晶格矢量指数 $i,j,k$ 的求和被截断在 $[-N_r, N_r]$ 范围内。\n\n**2. 倒易空间和 ($\\phi_{\\text{recip}}$)**\n此项通过对倒易晶格的求和来解释电势的长程部分。对于简单立方晶格，倒易晶格矢量为 $\\mathbf{k}_{\\mathbf{m}} = \\frac{2\\pi}{a}(m_x, m_y, m_z)$，其中 $m_x, m_y, m_z$ 为整数。原点处的电势由以下公式给出：\n$$\n\\phi_{\\text{recip}} = \\frac{4\\pi}{V} \\sum_{\\mathbf{m} \\neq \\mathbf{0}} \\frac{e^{-k_{\\mathbf{m}}^2 / (4\\eta^2)}}{k_{\\mathbf{m}}^2} S(\\mathbf{k}_{\\mathbf{m}})\n$$\n其中 $V=a^3=8$ 是晶胞体积，$k_{\\mathbf{m}} = |\\mathbf{k}_{\\mathbf{m}}|$，并且对指数 $m_x, m_y, m_z$ 的求和被截断在 $[-N_k, N_k]$ 范围内。结构因子 $S(\\mathbf{k})$ 定义为：\n$$\nS(\\mathbf{k}) = \\sum_{p=1}^{8} q_p e^{-i \\mathbf{k} \\cdot \\mathbf{r}^{\\text{basis}}_p}\n$$\n对于给定的基元，其中 $\\mathbf{r}^{\\text{basis}}_p$ 以 $a$ 为单位，且 $\\mathbf{k}_{\\mathbf{m}} = (\\pi/1)(m_x, m_y, m_z)$，点积 $\\mathbf{k}_{\\mathbf{m}} \\cdot \\mathbf{r}^{\\text{basis}}_p$ 涉及诸如 $\\pi(m_x/2)$、$\\pi(m_y/2)$ 等项。仔细评估表明，结构因子可以简化为一个非常紧凑的形式：\n$$\nS(\\mathbf{k}_{\\mathbf{m}}) = (1 - (-1)^{m_x})(1 - (-1)^{m_y})(1 - (-1)^{m_z})\n$$\n这意味着只有当三个指数 $m_x, m_y, m_z$ 都为奇数时，$S(\\mathbf{k}_{\\mathbf{m}})$ 才非零，此时 $S(\\mathbf{k}_{\\mathbf{m}})=2 \\times 2 \\times 2 = 8$。对于所有其他指数组合，$S(\\mathbf{k}_{\\mathbf{m}})=0$。这极大地简化了求和过程。\n将 $V=8$，$S(\\mathbf{k}_{\\mathbf{m}})=8$ 和 $k_{\\mathbf{m}}^2 = (\\pi/a)^2 m^2 = (\\pi/2)^2 m^2$（其中 $m^2=m_x^2+m_y^2+m_z^2$）代入 $\\phi_{\\text{recip}}$ 的公式：\n$$\n\\phi_{\\text{recip}} = \\frac{4\\pi}{8} \\sum_{\\mathbf{m} \\text{ odd}} \\frac{e^{-(\\pi/2)^2 m^2 / (4\\eta^2)}}{(\\pi/2)^2 m^2} \\times 8 = \\frac{16}{\\pi} \\sum_{\\mathbf{m} \\text{ odd}} \\frac{e^{-\\pi^2 m^2 / (16\\eta^2)}}{m^2}\n$$\n等等，这里有个计算错误。让我们用 $a=2$ 重新推导。$\\mathbf{k}_{\\mathbf{m}} = \\pi(m_x, m_y, m_z)$，因此 $k_{\\mathbf{m}}^2 = \\pi^2 m^2$。\n$$\n\\phi_{\\text{recip}} = \\frac{4\\pi}{8} \\sum_{\\mathbf{m} \\text{ odd}} \\frac{e^{-\\pi^2 m^2 / (4\\eta^2)}}{\\pi^2 m^2} \\times 8 = \\frac{4}{\\pi} \\sum_{\\mathbf{m} \\text{ odd}} \\frac{e^{-\\pi^2 m^2 / (4\\eta^2)}}{m^2}\n$$\n这个修正后的公式将被实现。求和是对分量在 $[-N_k, N_k]$ 内的奇整数矢量 $\\mathbf{m}=(m_x, m_y, m_z)$ 进行的。\n\n**3. 自相互作用校正 ($\\phi_{\\text{self}}$)**\n此项移除了参考离子电荷与其自身屏蔽高斯电荷云之间的伪相互作用，该相互作用已隐含在倒易空间和中。对于参考电荷 $q_{\\text{ref}}=+1$：\n$$\n\\phi_{\\text{self}} = -\\frac{2\\eta q_{\\text{ref}}}{\\sqrt{\\pi}} = -\\frac{2\\eta}{\\sqrt{\\pi}}\n$$\n\n**最终计算**\n总电势为 $\\phi = \\phi_{\\text{real}} + \\phi_{\\text{recip}} + \\phi_{\\text{self}}$。马德隆常数为 $M = -\\phi$。程序将为每个给定的参数集 $(\\eta, N_r, N_k)$ 评估这三项，并将它们组合起来以找到相应的 $M$ 值。", "answer": "```python\nimport numpy as np\nfrom scipy.special import erfc\n\ndef solve():\n    \"\"\"\n    Main function to solve for Madelung constant for given test cases.\n    \"\"\"\n    test_cases = [\n        (1.2, 6, 6),\n        (3.5, 6, 6),\n        (6.0, 12, 3),\n        (0.8, 3, 12),\n        (2.5, 1, 1),\n    ]\n\n    results = []\n    for eta, N_r, N_k in test_cases:\n        M = calculate_madelung(eta, N_r, N_k)\n        results.append(f\"{M:.9f}\")\n\n    print(f\"[{','.join(results)}]\")\n\ndef calculate_madelung(eta, N_r, N_k):\n    \"\"\"\n    Computes the Madelung constant for the rock-salt structure using Ewald summation.\n\n    Args:\n        eta (float): The Ewald splitting parameter.\n        N_r (int): The cutoff for the real-space sum (sum over -N_r to N_r).\n        N_k (int): The cutoff for the reciprocal-space sum (sum over -N_k to N_k).\n\n    Returns:\n        float: The dimensionless Madelung constant.\n    \"\"\"\n    a = 2.0  # Lattice constant\n\n    # Basis charges and fractional positions for the 8 ions in the conventional cell\n    charges = np.array([1.0, 1.0, 1.0, 1.0, -1.0, -1.0, -1.0, -1.0])\n    positions_frac = np.array([\n        [0.0, 0.0, 0.0],  # +1 at origin\n        [0.0, 0.5, 0.5],\n        [0.5, 0.0, 0.5],\n        [0.5, 0.5, 0.0],\n        [0.5, 0.0, 0.0],  # -1\n        [0.0, 0.5, 0.0],\n        [0.0, 0.0, 0.5],\n        [0.5, 0.5, 0.5],\n    ])\n    positions = a * positions_frac\n    num_basis = len(charges)\n\n    # --- Real-space sum ---\n    phi_real = 0.0\n    # Create ranges for lattice vector indices i, j, k\n    ijk_range = np.arange(-N_r, N_r + 1)\n    \n    for i in ijk_range:\n        for j in ijk_range:\n            for k in ijk_range:\n                # Lattice translation vector T\n                T_vec = a * np.array([i, j, k])\n                for p in range(num_basis):\n                    # Exclude the reference ion at the origin (p=0 in cell 0,0,0)\n                    if i == 0 and j == 0 and k == 0 and p == 0:\n                        continue\n                    \n                    # Vector from origin to ion (p) in cell (i,j,k)\n                    r_vec = T_vec + positions[p]\n                    dist = np.linalg.norm(r_vec)\n                    \n                    if dist  1e-9:  # Avoid division by zero, though excluded term is the only case\n                        phi_real += charges[p] * erfc(eta * dist) / dist\n\n    # --- Reciprocal-space sum ---\n    phi_recip_sum_term = 0.0\n    # Create range for reciprocal lattice indices m_x, m_y, m_z\n    m_range = np.arange(-N_k, N_k + 1)\n\n    for mx in m_range:\n        for my in m_range:\n            for mz in m_range:\n                # Structure factor is non-zero only if all indices are odd\n                if mx % 2 == 0 or my % 2 == 0 or mz % 2 == 0:\n                    continue\n                \n                m_sq = float(mx*mx + my*my + mz*mz)\n                \n                exp_term = np.exp(-np.pi**2 * m_sq / (4.0 * eta**2))\n                phi_recip_sum_term += exp_term / m_sq\n\n    # Final prefactor for reciprocal sum\n    phi_recip = (4.0 / np.pi) * phi_recip_sum_term\n\n    # --- Self-interaction correction ---\n    # For the reference ion q_ref = +1\n    phi_self = -2.0 * eta / np.sqrt(np.pi)\n\n    # --- Total Potential and Madelung Constant ---\n    phi_total = phi_real + phi_recip + phi_self\n    \n    # M = -phi_total since q_ref=1 and nearest-neighbor distance R=1\n    M = -phi_total\n    \n    return M\n\nif __name__ == \"__main__\":\n    solve()\n\n```", "id": "2515797"}, {"introduction": "在基础的离子键点电荷模型之上，电子极化等次级效应为晶格提供了不可忽略的额外稳定性。本练习（[@problem_id:2515789]）采用简化的核-壳模型来估算极化能，这有助于洞察离子晶体中范德华力（van der Waals forces）的来源。通过这项实践，你将学会如何在基本模型的基础上，进一步融入更精细但至关重要的物理现象，从而更精确地描述材料行为。", "problem": "离子晶体的主导作用（一级近似）可以被建模为点离子间的库仑相互作用（主键）。次级稳定作用源于离子的电子极化。在离子的谐和核-壳模型中，电子壳层弹性地束缚在一个刚性核心上，并因局域电场而位移，从而感生出一个偶极矩，降低了能量。考虑一个具有岩盐结构的代表性卤化物——氯化钠，并在以下科学可控的近似条件下，估算每个离子对的晶格能的极化修正：\n- 将每个离子视为位于晶格点上的点电荷，电荷量大小为 $\\pm e$，其中 $e$ 是元电荷。\n- 在线性响应区内，用谐和核-壳模型来模拟每个离子的极化率，并通过极化率将感生偶极矩与局域电场联系起来。\n- 仅使用最近邻的阳离子-阴离子相互作用来产生离子上的局域电场；在岩盐结构中，每个离子的配位数为 $z=6$，最近邻间距为 $r_0=2.82\\,\\text{\\AA}$。\n- 忽略场矢量叠加产生的交叉项（即，将极化能近似为每个最近邻的电荷-感生偶极矩相互作用的独立加和）。\n- 忽略偶极-偶极相互作用以及任何对局域电场有影响的短程交叠效应。\n\n对于氯化钠，采用常见的“极化体积”约定来表示离子极化率，其定义为 $\\mathbf{p}=4\\pi\\varepsilon_0\\,\\tilde{\\alpha}\\,\\mathbf{E}$，其中 $\\tilde{\\alpha}$ 的单位为 $\\text{\\AA}^3$：\n- $\\tilde{\\alpha}_{\\mathrm{Na}^{+}}=0.18\\,\\text{\\AA}^3$,\n- $\\tilde{\\alpha}_{\\mathrm{Cl}^{-}}=3.25\\,\\text{\\AA}^3$.\n\n使用真空介电常数 $\\varepsilon_0=8.854\\,187\\,8128\\times 10^{-12}\\,\\mathrm{F\\,m^{-1}}$ 和元电荷 $e=1.602\\,176\\,634\\times 10^{-19}\\,\\mathrm{C}$。从静电学和谐和核-壳能量出发，严格推导感生偶极矩的能量公式，然后计算由六个最近邻产生的每个离子对的极化稳定能。用电子伏特表示你的最终答案，并四舍五入到三位有效数字。给出一个数值（负值表示稳定化）。", "solution": "问题陈述已经过验证，被认为是材料物理学中一个科学基础扎实、提法恰当的问题，尽管它使用了明确说明的强近似。我们将进行严格的求解。\n\n基本任务是计算氯化钠（$NaCl$）晶体中由离子极化引起的每个离子对的稳定能。该能量是对晶格能的次级贡献，补充了主要的马德隆（库仑）能量。\n\n首先，我们必须推导感生偶极矩的能量表达式。问题将每个离子建模为谐和核-壳系统。由于壳层相对于核心的位移 $\\mathbf{x}$，存储在振子中的势能为 $U_{osc} = \\frac{1}{2} k |\\mathbf{x}|^2$，其中 $k$ 是弹性系数。一个外部电场 $\\mathbf{E}$ 对壳层（电荷为 $q_{sh}$）施加一个力 $\\mathbf{F}_{elec} = q_{sh} \\mathbf{E}$。在平衡状态下，该力被恢复力 $\\mathbf{F}_{res} = -k\\mathbf{x}$ 所平衡。因此，平衡位移为 $\\mathbf{x}_{eq} = \\frac{q_{sh}}{k}\\mathbf{E}$。\n\n感生电偶极矩定义为 $\\mathbf{p} = q_{sh}\\mathbf{x}_{eq}$，这给出 $\\mathbf{p} = \\frac{q_{sh}^2}{k}\\mathbf{E}$。根据定义，极化率 $\\alpha$ 通过 $\\mathbf{p} = \\alpha\\mathbf{E}$ 将感生偶极矩与电场联系起来。因此，我们确定极化率为 $\\alpha = \\frac{q_{sh}^2}{k}$。\n\n当施加电场时，系统的总势能变化包括两部分：电场对壳层做的功，以及振子内能的变化。感生偶极矩在电场中的势能为 $U_{field} = -\\mathbf{p}\\cdot\\mathbf{E} = -\\alpha |\\mathbf{E}|^2$。储存在振子中的能量为 $U_{osc} = \\frac{1}{2} k |\\mathbf{x}_{eq}|^2 = \\frac{1}{2} k \\left| \\frac{\\mathbf{p}}{q_{sh}} \\right|^2 = \\frac{1}{2} k \\frac{\\alpha^2|\\mathbf{E}|^2}{q_{sh}^2} = \\frac{1}{2}\\alpha|\\mathbf{E}|^2$，这里使用了我们关于 $\\alpha$ 的表达式。\n\n总极化能 $U_{pol}$ 是这两部分贡献之和：\n$$U_{pol} = U_{osc} + U_{field} = \\frac{1}{2}\\alpha |\\mathbf{E}|^2 - \\alpha |\\mathbf{E}|^2 = -\\frac{1}{2}\\alpha |\\mathbf{E}|^2$$\n这个稳定能是我们计算的基础。\n\n接下来，我们将其应用于 $NaCl$ 晶体。我们需要求出每个离子对（$Na^+$，$Cl^-$）的极化能。问题指定我们只考虑来自 $z=6$ 个最近邻的电场，并且我们独立地对每个近邻相互作用产生的极化能进行求和。这种近似意味着我们计算每个近邻电场的能量贡献时，就好像它单独作用一样，然后将这些能量相加。这避免了在高对称性位点上会发生的场矢量抵消。\n\n让我们计算晶体的总极化能 $U_{total\\_pol}$，然后除以离子对的数量 $N$，以求得每对的能量 $U_{pair}$。总能量是晶体中每个离子的极化能之和。\n$$U_{total\\_pol} = \\sum_{\\text{ions } j} U_{pol, j} = \\sum_{j} \\left( -\\frac{1}{2} \\alpha_j \\left| \\mathbf{E}_{loc,j} \\right|^2 \\right)$$\n对于离子 $j$ 的局域电场能量项，指定的近似方法是对其最近邻 $i$ 进行求和：\n$$U_{pol,j} = \\sum_{i \\in NN(j)} -\\frac{1}{2}\\alpha_j |\\mathbf{E}_{i \\to j}|^2$$\n其中 $\\mathbf{E}_{i \\to j}$ 是离子 $i$ 在离子 $j$ 处产生的电场。对于 $NaCl$ 中的最近邻，距离为 $r_0$，电荷大小为 $e$。因此，任何一个最近邻产生的电场大小为：\n$$E_{NN} = \\frac{1}{4\\pi\\varepsilon_0} \\frac{e}{r_0^2}$$\n每个离子有 $z=6$ 个最近邻。因此，单个离子 $j$ 的极化能为：\n$$U_{pol,j} = z \\left( -\\frac{1}{2}\\alpha_j E_{NN}^2 \\right) = -\\frac{z}{2}\\alpha_j E_{NN}^2$$\n一个含有 $N$ 个 $Na^+$ 离子和 $N$ 个 $Cl^-$ 离子的晶体的总能量是所有这些离子的极化能之和：\n$$U_{total\\_pol} = \\sum_{j=1}^N U_{pol, Na_j^+} + \\sum_{j=1}^N U_{pol, Cl_j^-} = N \\left(-\\frac{z}{2}\\alpha_{Na^+} E_{NN}^2\\right) + N \\left(-\\frac{z}{2}\\alpha_{Cl^-} E_{NN}^2\\right)$$\n$$U_{total\\_pol} = -N \\frac{z}{2} (\\alpha_{Na^+} + \\alpha_{Cl^-}) E_{NN}^2$$\n每个离子对的极化能为 $U_{pair} = U_{total\\_pol} / N$：\n$$U_{pair} = -\\frac{z}{2} (\\alpha_{Na^+} + \\alpha_{Cl^-}) E_{NN}^2 = -\\frac{z}{2} (\\alpha_{Na^+} + \\alpha_{Cl^-}) \\left( \\frac{e}{4\\pi\\varepsilon_0 r_0^2} \\right)^2$$\n问题以“极化体积”的约定提供了极化率 $\\tilde{\\alpha}$，其中 $\\mathbf{p} = 4\\pi\\varepsilon_0 \\tilde{\\alpha} \\mathbf{E}$。将其与 $\\mathbf{p} = \\alpha \\mathbf{E}$ 比较，我们得到转换关系 $\\alpha = 4\\pi\\varepsilon_0 \\tilde{\\alpha}$。将此代入我们关于 $U_{pair}$ 的表达式中：\n$$U_{pair} = -\\frac{z}{2} (4\\pi\\varepsilon_0 \\tilde{\\alpha}_{Na^+} + 4\\pi\\varepsilon_0 \\tilde{\\alpha}_{Cl^-}) \\frac{e^2}{(4\\pi\\varepsilon_0)^2 r_0^4}$$\n$$U_{pair} = -\\frac{z e^2}{2(4\\pi\\varepsilon_0) r_0^4} (\\tilde{\\alpha}_{Na^+} + \\tilde{\\alpha}_{Cl^-})$$\n这是我们最终的符号表达式。现在，我们代入给定的数值：\n- 配位数 $z=6$。\n- 元电荷 $e=1.602\\,176\\,634\\times 10^{-19}\\,\\mathrm{C}$。\n- 真空介电常数 $\\varepsilon_0=8.854\\,187\\,8128\\times 10^{-12}\\,\\mathrm{F\\,m^{-1}}$。\n- 最近邻间距 $r_0=2.82\\,\\text{\\AA} = 2.82 \\times 10^{-10}\\,\\mathrm{m}$。\n- 极化体积 $\\tilde{\\alpha}_{\\mathrm{Na}^{+}}=0.18\\,\\text{\\AA}^3 = 0.18 \\times 10^{-30}\\,\\mathrm{m}^3$。\n- 极化体积 $\\tilde{\\alpha}_{\\mathrm{Cl}^{-}}=3.25\\,\\text{\\AA}^3 = 3.25 \\times 10^{-30}\\,\\mathrm{m}^3$。\n\n极化体积之和为 $\\tilde{\\alpha}_{sum} = \\tilde{\\alpha}_{Na^+} + \\tilde{\\alpha}_{Cl^-} = (0.18 + 3.25)\\,\\text{\\AA}^3 = 3.43\\,\\text{\\AA}^3 = 3.43 \\times 10^{-30}\\,\\mathrm{m}^3$。\n库仑常数为 $\\frac{1}{4\\pi\\varepsilon_0} \\approx 8.98755 \\times 10^9\\,\\mathrm{N\\,m^2\\,C^{-2}}$。\n\n我们以焦耳为单位计算能量：\n$$U_{pair} = -\\frac{6 \\times (1.602177 \\times 10^{-19}\\,\\mathrm{C})^2}{2 \\times 4\\pi(8.854188 \\times 10^{-12}\\,\\mathrm{F/m}) \\times (2.82 \\times 10^{-10}\\,\\mathrm{m})^4} \\times (3.43 \\times 10^{-30}\\,\\mathrm{m}^3)$$\n$$U_{pair} = - \\frac{1.54018 \\times 10^{-37}}{1.4050 \\times 10^{-48}} \\times (3.43 \\times 10^{-30})$$\n$$U_{pair} = - (1.0962 \\times 10^{11}) \\times (3.43 \\times 10^{-30}) = -3.760 \\times 10^{-19}\\,\\mathrm{J}$$\n\n为了以电子伏特（$eV$）表示，我们除以元电荷的大小：\n$$U_{pair}(\\mathrm{eV}) = \\frac{-3.760 \\times 10^{-19}\\,\\mathrm{J}}{1.602177 \\times 10^{-19}\\,\\mathrm{J/eV}} \\approx -2.3469\\,\\mathrm{eV}$$\n根据要求，将结果四舍五入到三位有效数字，得到 $-2.35\\,\\mathrm{eV}$。这个负值表示晶格的稳定化。", "answer": "$$\\boxed{-2.35}$$", "id": "2515789"}]}