## 引言
在[材料科学](@entry_id:152226)的前沿，对新材料的探索与设计日益依赖于我们从原子尺度上理解和预测其行为的能力。然而，直接求解包含大量[原子核](@entry_id:167902)与电子的真实材料体系的量子力学方程，在计算上是一项几乎不可能完成的任务，这构成了理论与实践之间的巨大鸿沟。[计算材料科学](@entry_id:145245)，特别是以密度泛函理论（DFT）为核心的[第一性原理方法](@entry_id:268553)，为我们提供了跨越这一鸿沟的强大桥梁。它将复杂的[量子多体问题](@entry_id:146763)转化为可行的计算方案，使我们能够在一个“虚拟实验室”中以前所未有的精度和效率来研究材料的性质。

本文旨在系统性地介绍[计算材料科学](@entry_id:145245)的基本原理及其应用。在接下来的内容中，读者将踏上一段从基础理论到实际应用的旅程。我们将在 **“原理与机制”** 一章中，深入剖析构成现代[材料模拟](@entry_id:176516)基石的理论基础，从[玻恩-奥本海默近似](@entry_id:146252)到[科恩-沈方法](@entry_id:263733)的精髓。随后，在 **“应用与跨学科[交叉](@entry_id:147634)”** 一章中，我们将展示这些理论工具如何被用来预测材料的[热力学](@entry_id:141121)、力学和动力学性质，并探讨其在[半导体](@entry_id:141536)、催化和数据科学等前沿领域的交叉应用。最后，在 **“动手实践”** 部分，我们将概述几个关键的计算工作流程，旨在将抽象的理论知识转化为解决具体问题的实践能力。通过这三个章节的学习，您将建立起对计算材料科学核心思想和能力的全面认识。

## 原理与机制

在理解和预测材料的宏观性质时，我们必须从其微观的电子和[原子核](@entry_id:167902)层面出发。本章旨在深入探讨[计算材料科学](@entry_id:145245)的核心理论基础，这些理论将复杂的[量子多体问题](@entry_id:146763)转化为可计算的模型，从而构成了现代[材料模拟](@entry_id:176516)的基石。我们将从描述材料系统的基本[哈密顿量](@entry_id:172864)出发，引入[玻恩-奥本海默近似](@entry_id:146252)，并在此基础上建立起连接电子结构与原子动力学的桥梁——[势能面](@entry_id:147441)。随后，我们将系统地阐述密度泛函理论（DFT）的 foundational principles，包括[Hohenberg-Kohn定理](@entry_id:139793)和[Kohn-Sham方法](@entry_id:263733)，并剖析其中关键的交换关联泛函的物理内涵。最后，我们将讨论实现这些理论所必需的实际近似与计算技术，如交换关联泛函的构造、[赝势](@entry_id:170389)的使用以及在周期性固体中的计算策略。

### 基本的多体问题

任何材料，无论其为分子、纳米结构还是晶体，本质上都是一个由[原子核](@entry_id:167902)和电子组成的复杂[量子多体系统](@entry_id:141221)。在非相对论框架下，描述这样一个系统的行为需要求解其[定态](@entry_id:137260)薛定谔方程 $\hat{H}\Psi = E\Psi$，其中 $\hat{H}$ 是系统的总[哈密顿量](@entry_id:172864)。该[哈密顿量](@entry_id:172864)包含了系统中所有粒子的动能以及它们之间的所有库仑相互作用。

由于[原子核](@entry_id:167902)的质量（$M_I$）远大于电子的质量（$m_e$），通常至少相差三个[数量级](@entry_id:264888)（例如，质子的质量约为电子质量的1836倍），它们的运动时间尺度也存在巨大差异。电子的运动非常迅速，其特征时间尺度约为 $10^{-16}$ 至 $10^{-15}$ 秒，而[原子核](@entry_id:167902)的[振动](@entry_id:267781)或平动则缓慢得多，[特征时间尺度](@entry_id:276738)在 $10^{-14}$ 至 $10^{-12}$ 秒之间。这种时间尺度的显著分离是**玻恩-奥本海默（Born-Oppenheimer, BO）近似**的物理基础。该近似假设，对于[原子核](@entry_id:167902)的任何瞬时构型，电子都能够“瞬间”适应并达到其[基态](@entry_id:150928)。这使得我们可以将总[波函数](@entry_id:147440) $\Psi(\mathbf{r}, \mathbf{R})$ 分解为仅依赖于[原子核](@entry_id:167902)坐标 $\mathbf{R}$ 的核[波函数](@entry_id:147440) $\chi(\mathbf{R})$ 和依赖于电子坐标 $\mathbf{r}$ 并参变地依赖于[原子核](@entry_id:167902)坐标 $\mathbf{R}$ 的电子[波函数](@entry_id:147440) $\psi_{e}(\mathbf{r};\mathbf{R})$ 的乘积：

$$ \Psi(\mathbf{r},\mathbf{R}) \approx \psi_{e}(\mathbf{r};\mathbf{R})\,\chi(\mathbf{R}) $$

在BO近似下，我们可以将复杂的全系统问题分解为两个相对简单的步骤：首先，将[原子核](@entry_id:167902)视为固定在空间中的[点电荷](@entry_id:263616)（即“钳制”[原子核](@entry_id:167902)），求解在该静态离子[势场](@entry_id:143025)中运动的电子的薛定谔方程；然后，再求解[原子核](@entry_id:167902)在由电子基态能量所构成的[有效势](@entry_id:142581)场中的运动。[@problem_id:2475267]

对于第一步，即求解给定[原子核](@entry_id:167902)构型 $\lbrace\mathbf{R}_I\rbrace$ 下的电子问题，我们需要构建[电子哈密顿量](@entry_id:177588) $\hat{H}_e$。对于一个包含 $N$ 个电子和 $M$ 个[原子核](@entry_id:167902)的周期性晶体，这个[哈密顿量](@entry_id:172864)由四部分构成 [@problem_id:2475257]：

1.  **电子动能** ($\hat{T}_e$)：所有电子[动能算符](@entry_id:265633)的总和。
    $$ \hat{T}_e = -\sum_{i=1}^{N} \frac{\hbar^2}{2m_e}\nabla_i^2 $$

2.  **[电子-电子相互作用](@entry_id:139900)势能** ($\hat{V}_{ee}$)：所有电子对之间的排斥作用。在周期性体系中，必须考虑一个电子与所有其他电子及其在所有[晶格](@entry_id:196752)原胞中的周期性映像之间的相互作用。这导致一个[条件收敛](@entry_id:147507)的[晶格](@entry_id:196752)求和。
    $$ \hat{V}_{ee} = \frac{1}{2} \sum_{i=1}^{N} \sum_{j=1}^{N} \sum_{\mathbf{R} \in \mathcal{L}}' \frac{e^2}{4\pi \epsilon_0 |\mathbf{r}_i - \mathbf{r}_j - \mathbf{R}|} $$
    这里的 $\mathcal{L}$ 代表布拉伐格点的集合，带撇的[求和符号](@entry_id:264401) $\sum'$ 表示排除了 $i=j$ 且[晶格矢量](@entry_id:161583) $\mathbf{R}=\mathbf{0}$ 的情况，以避免电子与自身的非物理相互作用。

3.  **电子-[原子核](@entry_id:167902)相互作用[势能](@entry_id:748988)** ($\hat{V}_{eN}$)：所有电子与所有[原子核](@entry_id:167902)及其周期性映像之间的吸引作用。
    $$ \hat{V}_{eN} = \sum_{i=1}^{N} \sum_{I=1}^{M} \sum_{\mathbf{R} \in \mathcal{L}} \left( - \frac{Z_I e^2}{4\pi \epsilon_0 |\mathbf{r}_i - \mathbf{R}_I - \mathbf{R}|} \right) $$
    其中 $Z_I$ 是第 $I$ 个[原子核](@entry_id:167902)的[电荷](@entry_id:275494)数。

4.  **[原子核](@entry_id:167902)-[原子核](@entry_id:167902)相互作用[势能](@entry_id:748988)** ($V_{NN}$)：由于[原子核](@entry_id:167902)位置在电子问题中是固定的，这一项是一个常数能量项，代表了所有[原子核](@entry_id:167902)点电荷（及其周期性映像）之间的静电排斥能。
    $$ V_{NN} = \frac{1}{2} \sum_{I=1}^{M} \sum_{J=1}^{M} \sum_{\mathbf{R} \in \mathcal{L}}' \frac{Z_I Z_J e^2}{4\pi \epsilon_0 |\mathbf{R}_I - \mathbf{R}_J - \mathbf{R}|} $$
    由于长程库仑相互作用导致的[晶格](@entry_id:196752)求和发散问题，通常需要使用**埃瓦尔德（Ewald）求和**等特殊技术来精确计算 $\hat{V}_{ee}$、$\hat{V}_{eN}$ 和 $V_{NN}$。

综上，对于固定的[原子核](@entry_id:167902)构型，电子的[定态](@entry_id:137260)薛定谔方程为 $\hat{H}_e \psi_e = E_{el} \psi_e$，其中[电子哈密顿量](@entry_id:177588)为 $\hat{H}_e = \hat{T}_e + \hat{V}_{ee} + \hat{V}_{eN}$。

### [势能面](@entry_id:147441)

求解上述[电子薛定谔方程](@entry_id:177999)，可以得到对应于特定[原子核](@entry_id:167902)构型 $\lbrace\mathbf{R}_I\rbrace$ 的电子基态能量 $E_{el}(\lbrace\mathbf{R}_I\rbrace)$。将这个电子能量与[原子核](@entry_id:167902)间的排斥能 $V_{NN}(\lbrace\mathbf{R}_I\rbrace)$ 相加，我们就得到了一个只依赖于[原子核](@entry_id:167902)坐标的函数，称为**[势能面](@entry_id:147441)（Potential Energy Surface, PES）** [@problem_id:2475297]：

$$ E(\lbrace\mathbf{R}_I\rbrace) = E_{el}(\lbrace\mathbf{R}_I\rbrace) + V_{NN}(\lbrace\mathbf{R}_I\rbrace) $$

这个[势能面](@entry_id:147441)是连接微观电子世界和宏观原子行为的核心桥梁。在BO近似的框架下，[原子核](@entry_id:167902)的运动可以被看作是在这个多维的能量“[地形图](@entry_id:202940)”上进行的。PES的形状决定了材料的结构、稳定性、动力学和化学反应性。

通过分析[势能面](@entry_id:147441)，我们可以预测多种[材料性质](@entry_id:146723)：

*   **结构与稳定性**：PES上的局域极小值点对应于材料的稳定或亚稳结构。计算中最常见的任务之一就是通过[优化算法](@entry_id:147840)（如共轭梯度法或[BFGS算法](@entry_id:263685)）寻找这些能量最低点，从而确定[平衡态](@entry_id:168134)的[键长](@entry_id:144592)、键角和晶格常数。优化的驱动力是作用在每个[原子核](@entry_id:167902)上的力，该力由[势能面](@entry_id:147441)的负梯度给出：$\mathbf{F}_I = -\nabla_{\mathbf{R}_I} E(\lbrace\mathbf{R}_J\rbrace)$。根据**海尔曼-费曼（Hellmann-Feynman）定理**，如果电子[波函数](@entry_id:147440)是精确的（例如，在[完备基组](@entry_id:200333)下），这个力可以直接通过计算[哈密顿量](@entry_id:172864)对[原子核](@entry_id:167902)坐标的[期望值](@entry_id:153208)导数得到，极大地简化了计算。[@problem_id:2475297]

*   **[振动](@entry_id:267781)性质**：在PES的一个极小值点（平衡结构）附近，我们可以将能量按原子位移做[泰勒展开](@entry_id:145057)。保留至二阶项，即为[谐振子近似](@entry_id:268588)。能量的[二阶导数](@entry_id:144508)矩阵，即**黑森（Hessian）矩阵** $H_{I\alpha, J\beta} = \frac{\partial^2 E}{\partial R_{I\alpha} \partial R_{J\beta}}$，描述了[势阱](@entry_id:151413)的曲率。通过求解质量加权的黑森矩阵的本征值问题，可以得到系统的简正[振动](@entry_id:267781)模式及其频率。例如，对于一个[双原子分子](@entry_id:148655)，其谐振频率 $\omega$ 与键力常数 $k$ (PES在[平衡点](@entry_id:272705)[二阶导数](@entry_id:144508)) 和[约化质量](@entry_id:152420) $\mu$ 的关系为 $\omega = \sqrt{k/\mu}$。在晶体中，这对应于[声子谱](@entry_id:753408)的计算。[@problem_id:2475297]

*   **[化学反应](@entry_id:146973)与[相变](@entry_id:147324)**：[化学反应](@entry_id:146973)或固态[相变](@entry_id:147324)可以被看作是系统在PES上从一个局域极小值（反应物）演化到另一个局域极小值（产物）的过程。连接这两个极小值的能量最低路径被称为**[最小能量路径](@entry_id:163618)（Minimum Energy Path, MEP）**。路径上能量最高的点是**过渡态**，它是一个[一阶鞍点](@entry_id:165164)——在沿着反应坐标的方向是能量极大值，而在所有其他垂直方向上是能量极小值。因此，过渡态的黑森矩阵有且仅有一个负[本征值](@entry_id:154894)，对应一个[虚振动频率](@entry_id:165180)，代表了跨越能垒的[不稳定模式](@entry_id:263056)。寻找过渡态和MEP是理解[反应速率](@entry_id:139813)和机制的关键，常用的算法包括**[微动弹性带](@entry_id:201656)（Nudged Elastic Band, NEB）**等[优化方法](@entry_id:164468)，它们在零温下寻找路径，而非模拟有限温度下的真实动力学轨迹。[@problem_id:2475297] [@problem_id:2475297]

*   **原子动力学**：通过在PES上求解[原子核](@entry_id:167902)的经典[运动方程](@entry_id:170720)，即**[玻恩-奥本海默分子动力学](@entry_id:187507)（BOMD）**，我们可以模拟材料在有限温度下的行为。在每个时间步，计算当前原子构型下的电子基态能量和原子间力，然后根据[牛顿第二定律](@entry_id:274217) $m_I \ddot{\mathbf{R}}_I = \mathbf{F}_I = -\nabla_{\mathbf{R}_I} E(\lbrace\mathbf{R}_J\rbrace)$ 来更新原子的位置和速度。如果电子始终保持在其瞬时[基态](@entry_id:150928)，那么系统的总能量（[原子核](@entry_id:167902)动能加[势能面](@entry_id:147441)能量）是守恒的。[@problem_id:2475297]

需要注意的是，BO近似和单[势能面](@entry_id:147441)的图像在某些情况下会失效，例如在[光化学](@entry_id:140933)或涉及电子态交叉的场景中。当两个或多个电子态能量变得简并或[近简并](@entry_id:172107)时（如在**锥形交叉**点附近），电子和[原子核](@entry_id:167902)的运动会发生强烈的耦合。此时，必须超越BO近似，考虑多个耦合的[势能面](@entry_id:147441)上的[核动力学](@entry_id:752701)。[@problem_id:2475297]

### [密度泛函理论](@entry_id:139027)：从[波函数](@entry_id:147440)到密度

尽管BO近似极大地简化了问题，但求解包含成百上千个电子的[电子薛定谔方程](@entry_id:177999)仍然是一项几乎不可能完成的任务。一个 $N$ 电子[波函数](@entry_id:147440)是 $3N$ 维的复杂函数，其计算和存储的复杂度随电子数呈指数增长。**密度泛函理论（Density Functional Theory, DFT）**提供了一条革命性的途径，它将计算的[焦点](@entry_id:174388)从高维的[波函数](@entry_id:147440)转移到三维的电子密度 $n(\mathbf{r})$ 上。

DFT的理论基石是二十世纪六十年代由Pierre Hohenberg和Walter Kohn提出的两个定理。[@problem_id:2475212]

**第一Hohenberg-Kohn (HK) 定理** 指出，对于一个处于非简并[基态](@entry_id:150928)的相互作用电子系统，其[基态](@entry_id:150928)电子密度 $n(\mathbf{r})$ 唯一地决定了系统的外势 $v_{ext}(\mathbf{r})$（最多相差一个无关紧要的常数）。这个定理的证明采用了优雅的反证法：假设存在两个不同的外势 $v_{ext}(\mathbf{r})$ 和 $v'_{ext}(\mathbf{r})$（其差异不只是一个常数），它们却对应于相同的基[态密度](@entry_id:147894) $n(\mathbf{r})$。根据变分原理，将一个系统的[基态](@entry_id:150928)[波函数](@entry_id:147440)作为另一个系统[哈密顿量](@entry_id:172864)的试探波函数，可以导出一个逻辑矛盾 $E+E'  E'+E$。因此，初始假设不成立。

这个定理的意义是深远的：由于外势 $v_{ext}(\mathbf{r})$（连同电子数 $N$）完全确定了系统的[哈密顿量](@entry_id:172864)，而[哈密顿量](@entry_id:172864)又决定了系统的所有性质，那么，既然基[态密度](@entry_id:147894) $n(\mathbf{r})$ 能唯一确定外势，它也就唯一地确定了系统的[哈密顿量](@entry_id:172864)，并因此包含了系统[基态](@entry_id:150928)的所有信息。换言之，系统的所有[基态](@entry_id:150928)性质都可以被看作是电子密度的泛函。

**第二Hohenberg-Kohn (HK) 定理** 在此基础上建立了一个能量的[变分原理](@entry_id:198028)。它断言，存在一个普适的[能量泛函](@entry_id:170311) $E_v[n]$，对于给定的外势 $v_{ext}(\mathbf{r})$，任何一个“可接受的”试探密度（即能够成为某个外势下的基态密度的密度，称为v-可表密度）所计算出的能量值，都将高于或等于由真实的基态密度 $n_0(\mathbf{r})$ 所计算出的真实[基态能量](@entry_id:263704) $E_0$。真实的基态密度使能量泛函达到最小值。

这个泛函可以写为：
$$ E_v[n] = F[n] + \int d\mathbf{r}\; v_{\text{ext}}(\mathbf{r})\, n(\mathbf{r}) $$
其中，$F[n] = T[n] + V_{ee}[n]$ 是一个**[普适泛函](@entry_id:140176)**，它包含了相互作用系统的动能和[电子-电子相互作用](@entry_id:139900)能，其形式不依赖于具体的外势，因此对所有电子系统都是相同的。

HK定理为基于电子密度计算材料性质提供了严格的理论依据。然而，它们并未给出[普适泛函](@entry_id:140176) $F[n]$ 的具体形式，特别是其中复杂的动能泛函 $T[n]$。此外，原始的HK定理在处理简并[基态](@entry_id:150928)和[磁场](@entry_id:153296)等情况时需要推广。例如，在存在[静态磁场](@entry_id:195560)时，仅靠电子密度不足以唯一确定外势，需要同时引入顺磁电流密度作为基本变量，这发展出了**电流密度泛函理论（CDFT）**。[@problem_id:2475212]

### [科恩-沈方法](@entry_id:263733)：一种实用的实现

为了克服寻找精确动能泛函 $T[n]$ 的困难，Walter Kohn和Lucius Sham于1965年提出了一种巧妙的间接方法，即**科恩-沈（Kohn-Sham, KS）方法**。其核心思想是，用一个虚构的、无相互作用的电子系统来辅助计算真实相互作用系统的基[态密度](@entry_id:147894)和能量。这个[辅助系统](@entry_id:142219)被精心设计，使其在某个有效的局域势 $v_{eff}(\mathbf{r})$ 中运动时，其基态密度恰好等于真实相互作用系统的基[态密度](@entry_id:147894)。[@problem_id:2475316]

由于[辅助系统](@entry_id:142219)是无相互作用的，其动能 $T_s[n]$ 可以通过求解一组单[电子薛定谔方程](@entry_id:177999)（即[Kohn-Sham方程](@entry_id:143968)）并对得到的[轨道](@entry_id:137151)动能求和来精确计算。此时，真实的能量泛函被重写为：
$$ E[n] = T_{s}[n] + \int d\mathbf{r}\; v_{\text{ext}}(\mathbf{r}) n(\mathbf{r}) + E_{H}[n] + E_{\text{xc}}[n] $$
这里，$E_{H}[n]$ 是电子密度的经典[静电排斥](@entry_id:162128)能（哈特里能），而所有复杂的量子[多体效应](@entry_id:173569)都被打包进了一个新的项——**交换关联能泛函（exchange-correlation functional）** $E_{\text{xc}}[n]$。根据其定义，$E_{\text{xc}}[n]$ 包含了以下几部分：
1.  真实相互作用系统的动能 $T$ 与KS[无相互作用系统](@entry_id:143064)动能 $T_s$ 之间的差值 $(T - T_s)$。
2.  [电子-电子相互作用](@entry_id:139900)能 $V_{ee}$ 中超出经典哈特里能 $E_H$ 的所有非经典部分。

$E_{\text{xc}}[n]$ 必须包含两个关键的物理效应[@problem_id:2475316]：
*   **交换（Exchange）**：这是源于[泡利不相容原理](@entry_id:141850)的纯粹量子效应。由于电子是[费米子](@entry_id:146235)，描述它们的总[波函数](@entry_id:147440)在交换任意两个电子的[坐标时](@entry_id:263720)必须反对称。这导致相同自旋的电子之间存在一个“交换洞”（或[费米洞](@entry_id:137389)），即在一个电子周围找到另一个同自旋电子的概率降低。交换能是这种关联带来的能量降低。它精确地抵消了哈特里能中包含的每个电子与其自身[电荷密度](@entry_id:144672)相互作用的非物理“[自相互作用](@entry_id:201333)”能。交换作用是自旋依赖的，它是导致原子中洪特规则和铁、钴、镍等材料中[巡游铁磁性](@entry_id:161376)的主要原因。
*   **关联（Correlation）**：这是除交换效应外，所有剩余的[电子-电子相互作用](@entry_id:139900)效应的总和。它描述了电子由于库仑排斥而产生的动态躲避行为。这种躲避行为不仅存在于同自旋电子之间，也存在于不同自旋的电子之间。它进一步降低了系统的总能量。关联效应对于描述许多现象至关重要，特别是那些由电子云瞬时涨落引起的弱相互作用，例如[范德华力](@entry_id:145564)或色散力，它们是石墨层间结合或稀有气体原子成键的主要驱动力。

通过对KS[能量泛函](@entry_id:170311)应用变分原理，可以导出一组自洽求解的单粒子方程，即**[Kohn-Sham方程](@entry_id:143968)**。对于一个自旋极化的系统，我们需要区分自旋向上 ($n_{\uparrow}$) 和自旋向下 ($n_{\downarrow}$) 的电子密度。总密度为 $n = n_{\uparrow} + n_{\downarrow}$，自旋磁化密度为 $m = n_{\uparrow} - n_{\downarrow}$。交换关联能 $E_{xc}$ 也成为这两种密度的泛函，即 $E_{xc}[n_{\uparrow}, n_{\downarrow}]$ 或等价地 $E_{xc}[n, m]$。通过对[自旋密度](@entry_id:267742)进行变分，可以得到自旋依赖的KS方程 [@problem_id:2475276]：

$$ \left[-\frac{\hbar^{2}}{2 m_{e}} \nabla^{2} + v_{\mathrm{eff},\sigma}(\mathbf{r})\right] \varphi_{i\sigma}(\mathbf{r}) = \varepsilon_{i\sigma} \varphi_{i\sigma}(\mathbf{r}) $$

其中，$\sigma$ 代表自旋（$\uparrow$ 或 $\downarrow$），$\varphi_{i\sigma}$ 是KS[轨道](@entry_id:137151)，$\varepsilon_{i\sigma}$ 是KS[本征值](@entry_id:154894)。自旋依赖的[有效势](@entry_id:142581) $v_{\mathrm{eff},\sigma}$ 为：

$$ v_{\mathrm{eff},\sigma}(\mathbf{r}) = v_{\mathrm{ext}}(\mathbf{r}) + v_{\mathrm{H}}[n](\mathbf{r}) + v_{\mathrm{xc},\sigma}[n,m](\mathbf{r}) - \mu_{\mathrm{B}}\, s_{\sigma}\, B_{\mathrm{ext}}(\mathbf{r}) $$

这里的 $v_H[n]$ 是不依赖自旋的哈特里势，$B_{ext}$ 是外[磁场](@entry_id:153296)，$s_{\sigma}$ 是自旋标签（$+1$ for $\uparrow$, $-1$ for $\downarrow$）。关键的交换关联势 $v_{\mathrm{xc},\sigma}$ 可以通过[链式法则](@entry_id:190743)从 $E_{xc}[n, m]$ 对 $n_{\sigma}$ 的泛函导数得到：

$$ v_{\mathrm{xc},\sigma}(\mathbf{r}) = \frac{\delta E_{\mathrm{xc}}}{\delta n_{\sigma}(\mathbf{r})} = \frac{\delta E_{\mathrm{xc}}}{\delta n(\mathbf{r})} + s_{\sigma} \frac{\delta E_{\mathrm{xc}}}{\delta m(\mathbf{r})} $$

这表明，自旋极化体系中的[有效势](@entry_id:142581)不仅包含对总密度的响应，还包含一个与自旋相关的项，它正比于交换关联能对磁化密度的响应，从而导致了自旋向上和自旋向下电子的不同能级，即自旋劈裂。

### 近似方法与实践考量

KS-DFT将多体问题的困难完全转移到了寻找精确的交换关联能泛函 $E_{xc}[n]$ 上。由于其精确形式未知，我们必须依赖于近似。

#### 交换关联近似

近似泛函的开发是DFT领域的核心。这些近似通常被构想为一个“[雅各布天梯](@entry_id:139901)”，每一级都引入更高层次的物理信息，以期获得更高的精度。

*   **[局域密度近似](@entry_id:138982)（Local Density Approximation, LDA）**：这是最简单也是最早的近似，它位于天梯的第一级。[LDA](@entry_id:138982)假设在一个真实非均匀体系中，某一点 $\mathbf{r}$ 的交换关联能密度只取决于该点的电子密度值 $n(\mathbf{r})$，并且其函数形式与密度为 $n(\mathbf{r})$ 的[均匀电子气](@entry_id:163911)（UEG）中的交换关联能密度相同。
    $$ E_{\text{xc}}^{\text{LDA}}[n] = \int n(\mathbf{r})\,\epsilon_{\text{xc}}^{\text{UEG}}(n(\mathbf{r}))\,\mathrm{d}\mathbf{r} $$
    其中 $\epsilon_{\text{xc}}^{\text{UEG}}(n)$ 是[均匀电子气](@entry_id:163911)的交换关联能密度，这是一个已知的（数值上）函数。[LDA](@entry_id:138982)在描述键合性质时存在系统性的偏差：它倾向于**过度键合**，导致预测的**[键长](@entry_id:144592)和[晶格常数](@entry_id:158935)偏短**，而**体弹模量**（描述材料抵抗压缩能力的物理量，与[势阱](@entry_id:151413)曲率相关）则**偏高**。[@problem_id:2475259]

*   **[广义梯度近似](@entry_id:274118)（Generalized Gradient Approximation, GGA）**：位于天梯的第二级，GGA旨在修正LDA的局域性缺陷。它不仅考虑了局域密度 $n(\mathbf{r})$，还引入了密度的局域梯度 $\nabla n(\mathbf{r})$ 作为变量，以感知电子密度的不[均匀性](@entry_id:152612)。
    $$ E_{\text{xc}}^{\text{GGA}}[n] = \int f(n(\mathbf{r}), \nabla n(\mathbf{r})) \,\mathrm{d}\mathbf{r} $$
    [GGA泛函](@entry_id:190164)的构造并非来自第一性原理推导，而是通过满足一系列已知的交换关联洞的数学约束来“工程化”设计的。相比于LDA，GGA通常能够显著**减轻过度键合**的趋势，给出更长、更接近实验值的[键长](@entry_id:144592)和[晶格常数](@entry_id:158935)，以及更小、更准确的体弹模量。[@problem_id:2475259]

#### 理解科恩-沈[本征值](@entry_id:154894)

在求解KS方程时，我们会得到一组[轨道能量](@entry_id:158481)，即KS[本征值](@entry_id:154894) $\varepsilon_{i\sigma}$。一个常见但错误的观念是直接将这些[本征值](@entry_id:154894)等同于电子的激发能或[电离能](@entry_id:136678)。实际上，KS系统是一个数学辅助工具，其[轨道](@entry_id:137151)和[本征值](@entry_id:154894)原则上没有直接的物理意义，它们只是产生正确基[态密度](@entry_id:147894)的中间产物。它们真正的身份是在约束变分过程中引入的**拉格朗日乘子**。[@problem_id:2475345]

然而，有一个重要的例外。在精确的DFT理论中，**最高占据分子[轨道](@entry_id:137151)（HOMO）的能量严格等于系统第一[电离势](@entry_id:198846)（IP）的负值**：
$$ \varepsilon_{\text{HOMO}} = -I = - (E(N-1) - E(N)) $$
这被称为[电离势定理](@entry_id:178221)。但是，对于**最低未占分子[轨道](@entry_id:137151)（LUMO）**，类似的等式 $\varepsilon_{\text{LUMO}} = -A$（其中 $A$ 是电子亲和能）通常**不成立**。这是因为交换关联势 $v_{xc}$ 作为电子数 $N$ 的函数，在 $N$ 穿过整数时存在一个不连续的跳变，即**[导数不连续性](@entry_id:136336)**。这个跳变使得真实的[基态](@entry_id:150928)[能隙](@entry_id:191975) $E_g = I-A$ 与KS[能隙](@entry_id:191975) $\varepsilon_{\text{LUMO}} - \varepsilon_{\text{HOMO}}$ 之间存在一个差值。

真正的[电子激发](@entry_id:190531)能，即从系统中移走或添加一个电子所需的能量，被称为**[准粒子](@entry_id:136584)（quasiparticle）能量**。这些能量在[多体微扰理论](@entry_id:168555)中被定义为相互作用体系[单粒子格林函数](@entry_id:140400)的极点，它们原则上对应于光电子能谱（PES）和反光[电子能谱](@entry_id:160814)（IPES）中可观测到的峰位。[@problem_id:2475345]

#### 冻芯近似与[赝势](@entry_id:170389)

对于包含[重元素](@entry_id:272514)的材料，全部电子（all-electron）计算的成本非常高昂。然而，[化学键合](@entry_id:138216)主要由最外层的价电子决定，而内层的芯电子则深埋在[原子核](@entry_id:167902)附近，能量极低，几乎不参与化学过程。**冻芯（frozen-core）近似**正是基于这种芯-价电子在能量和空间上的明确分离。该近似假设芯电子的[分布](@entry_id:182848)在原子形成化合物时保持其孤立原子时的状态不变，从而可以将它们从显式的自洽计算中移除。[@problem_id:2475331]

为了实现这一点，我们引入**[赝势](@entry_id:170389)（pseudopotential）**的概念。[赝势](@entry_id:170389)是一个[有效势](@entry_id:142581)，它替代了[原子核](@entry_id:167902)的强库仑势以及与芯电子的所有相互作用（包括[泡利排斥](@entry_id:143554)）。这个势被设计得比真实势更弱、更平滑，其作用对象仅为价电子。一个好的赝势必须满足关键条件：在某个[截断半径](@entry_id:136708) $r_c$ 之外，它对价电子产生的散射效应必须与原始的全电子原子势完全相同。这意味着，由赝势产生的赝[波函数](@entry_id:147440)在 $r_c$ 之外必须与真实价电子[波函数](@entry_id:147440)完全一致。散射性质的匹配通常通过确保对于每个角动量通道 $l$，赝势和全电子势的**[对数导数](@entry_id:169238)**在 $r_c$ 处对一系列[相关能](@entry_id:144432)量都相等来实现。[@problem_id:2475331]

为了提高赝势在不同化学环境中的**可移植性（transferability）**，现代[赝势](@entry_id:170389)构造还引入了**模守恒（norm-conservation）**条件，即要求 $r_c$ 内部的赝[波函数](@entry_id:147440)和真实[波函数](@entry_id:147440)的积分[电荷](@entry_id:275494)量相等。这等效于保证了[对数导数](@entry_id:169238)对能量的[一阶导数](@entry_id:749425)也匹配，从而在更宽的能量范围内保证了散射性质的准确性。[@problem_id:2475331]

冻芯和[赝势近似](@entry_id:167914)极大地降低了计算成本，但也存在局限性。当芯态和价态能量间隔很小（例如存在**半芯态**，如许多过渡金属的 $d$ 电子）或者在极高压力下原子间距变得非常小以至于芯电子云发生重叠时，冻芯近似就会失效，因为芯电子的极化和相互作用变得不可忽略。[@problem_id:2475331]

#### 周期性固体中的计算

当我们将[电子结构理论](@entry_id:172375)应用于晶体时，体系的周期性带来了新的[特征和](@entry_id:189446)计算要求。根据**布洛赫定理**，在周期性势场中，单电子[波函数](@entry_id:147440)的解具有如下形式：$\psi_{\mathbf{k}}(\mathbf{r}) = u_{\mathbf{k}}(\mathbf{r}) e^{i\mathbf{k} \cdot \mathbf{r}}$，其中 $u_{\mathbf{k}}(\mathbf{r})$ 是一个具有[晶格](@entry_id:196752)周期性的函数，而 $\mathbf{k}$ 是一个连续的[量子数](@entry_id:145558)，称为晶矢或[波矢](@entry_id:178620)。

这意味着对整个无限晶体的计算可以简化为对一个原胞的计算，但代价是必须对所有可能的晶矢 $\mathbf{k}$ 求解。这些 $\mathbf{k}$ 矢量位于[倒易空间](@entry_id:754151)中一个被称为**[第一布里渊区](@entry_id:269110)（First Brillouin Zone, BZ）**的基本区域内。[第一布里渊区](@entry_id:269110)被定义为[倒易空间](@entry_id:754151)中的**维格纳-赛兹（Wigner-Seitz）原胞**，即倒易空间中离原点比离任何其他倒易格点更近的所有点的集合。[@problem_id:2475322]

许多宏观性质，如总能量或电子密度，需要对[布里渊区](@entry_id:142395)内的所有电子态进行积分。在数值计算中，这个连续积分被一个在BZ内选取的离散网格点上的加权求和所替代。选择高效且收敛的 $k$ 点网格至关重要。一种广泛使用的方法是**Monkhorst-Pack (MP) 网格**。MP网格沿倒易晶格[基矢](@entry_id:199546)方向生成均匀间隔的点。一个 $N_1 \times N_2 \times N_3$ 的MP网格由以下形式的点构成：
$$ \mathbf{k}(\mathbf{m}) = \sum_{i=1}^3 u_{m_i} \mathbf{b}_i \quad \text{with} \quad u_{m_i} = \frac{2 m_i - N_i - 1}{2 N_i}, \quad m_i = 1, \dots, N_i $$
其中 $\mathbf{b}_i$ 是倒易晶格[基矢](@entry_id:199546)。在利用[晶体对称性](@entry_id:198772)约化之前，网格中每个点的权重都是相等的，为 $1/(N_1 N_2 N_3)$。这种构造确保了对低阶傅里叶分量的精确积分，从而能够以较少的点高效地获得收敛的结果。[@problem_id:2475322]