## 引言
在现代[计算材料科学](@entry_id:145245)领域，[密度泛函理论](@entry_id:139027)（DFT）已成为探索和设计新材料不可或缺的核心工具。它使我们能够在原子尺度上以前所未有的精度预测材料的电子、结构和磁学性质。然而，其强大功能的背后，是量子力学所面临的一个根本性难题：直接求解包含所有电子相互作用的多体薛定谔方程，对于绝大多数真实体系而言，计算上是不可行的。DFT通过将问题从求解极其复杂的[波函数](@entry_id:147440)转换为求解相对简单的电子密度，为这一难题提供了优雅且实用的出路。但这并非没有代价，我们必须依赖于对两个关键物理作用的近似处理：电子间的交换关联相互作用，以及价电子与离子实之间的相互作用。如何明智地选择和理解这些近似，是决定DFT计算成败的关键，也是本文旨在填补的知识鸿沟。

为了系统地构建这一理解，本文将分为三个紧密相连的部分。在第一章**“原理与机制”**中，我们将深入探究DFT的理论基石，从[Hohenberg-Kohn定理](@entry_id:139793)到[Kohn-Sham方程](@entry_id:143968)，并详细剖析交换关联泛函的“[雅各布天梯](@entry_id:139901)”以及赝势与[PAW方法](@entry_id:753811)的精妙之处。接下来的第二章**“应用与[交叉](@entry_id:147634)学科联系”**将理论与实践相结合，通过一系列具体案例展示不同的泛函和赝势选择如何影响对材料结构、[相变](@entry_id:147324)、电子性质乃至拓扑现象的预测，揭示理论选择背后的物理意义。最后，在第三章**“动手实践”**中，你将通过具体的计算练习，亲手构建[赝势](@entry_id:170389)、分析收敛性并探究DFT的内在局限，从而将理论知识转化为实践技能。让我们首先从支撑整个DFT大厦的**原理与机制**开始。

## 原理与机制

[密度泛函理论](@entry_id:139027) (DFT) 的核心思想在于，一个多电子体系的[基态](@entry_id:150928)性质完全由其[基态](@entry_id:150928)电子密度 $n_0(\mathbf{r})$ 唯一确定。这一深刻的见解为我们绕过求解复杂的、包含 $3N$ 个空间坐标的[多体波函数](@entry_id:203043) $\Psi(\mathbf{r}_1, \dots, \mathbf{r}_N)$ 提供了可能，转而专注于求解仅依赖于三个空间坐标的电子密度。本章旨在深入阐述支撑这一理论框架的核心原理，并剖析在实际计算中为实现这一构想而发展的关键机制，包括对电子-离子相互作用和电子-电子交换关联相互作用的近似处理方法。

### [密度泛函理论](@entry_id:139027)的基石：Hohenberg-Kohn 定理

[密度泛函理论](@entry_id:139027)的严格数学基础由 Hohenberg 和 Kohn 在 1964 年提出的两条定理奠定。这两条定理共同确立了以电子密度作为基本变量来描述[量子多体系统](@entry_id:141221)[基态](@entry_id:150928)的合法性。

第一条 **Hohenberg-Kohn (HK) 定理** 确立了从基态密度到系统[哈密顿量](@entry_id:172864)的唯一映射关系。该定理指出：对于一个处于非简并[基态](@entry_id:150928)的相互作用电子系统，其[基态](@entry_id:150928)电子密度 $n_0(\mathbf{r})$ 能够唯一地确定（最多相差一个无关紧要的常数）系统所处的外部势 $v_{\mathrm{ext}}(\mathbf{r})$。由于电子数 $N = \int n_0(\mathbf{r}) d\mathbf{r}$ 和电子间的相互作用形式（通常是库仑相互作用）是固定的，所以一旦 $v_{\mathrm{ext}}(\mathbf{r})$ 被确定，系统的[哈密顿算符](@entry_id:144286) $\hat{H} = \hat{T} + \hat{V}_{ee} + \hat{V}_{\mathrm{ext}}$也就完全确定了。随之，系统的[基态](@entry_id:150928)[波函数](@entry_id:147440) $\Psi_0$ 以及所有[基态](@entry_id:150928)[可观测量](@entry_id:267133)也都由 $n_0(\mathbf{r})$ 唯一确定。这为构造一个以密度为变量的能量泛函 $E[n]$ 提供了理论依据，因为系统的所有信息原则上都已蕴含在密度之中。

第二条 **Hohenberg-Kohn 定理** 提出了一个基于密度的变分原理。它断言存在一个[能量泛函](@entry_id:170311) $E_v[n]$，对于给定的外部势 $v_{\mathrm{ext}}$，该泛函的全局最小值即为系统的基态能量 $E_0$，并且只有当试探密度 $n(\mathbf{r})$ 等于真实的基[态密度](@entry_id:147894) $n_0(\mathbf{r})$ 时才能取到最小值。即：
$$
E_0 = \min_{n} E_v[n] = E_v[n_0]
$$
对于任何不等于 $n_0(\mathbf{r})$ 的试探密度 $n(\mathbf{r})$，都有 $E_v[n] > E_0$。这个[变分原理](@entry_id:198028)是 DFT 计算的核心，它允许我们通过最小化[能量泛函](@entry_id:170311)来寻找基态密度和能量。

然而，HK 定理的原始证明中存在一个微妙的限制，即所谓的 **v-[可表示性](@entry_id:635277) (v-representability)** 问题 [@problem_id:2480433]。原始证明假定变分原理中使用的所有试探密度都必须是某个局域势 $v'_{\mathrm{ext}}(\mathbf{r})$ 下的相互作用体系的基态密度。这是一个非常强的限制，而且一个密度是否满足 v-[可表示性](@entry_id:635277)的条件至今尚不明确，这给泛函的定义域带来了困难。

为了解决这个问题，Levy 和 Lieb 提出了 **约[束搜索](@entry_id:634146) (constrained-search)** 的构想，极大地拓宽了泛函的定义域。他们将[普适泛函](@entry_id:140176) $F[n]$ 定义为在所有能够产生密度 $n(\mathbf{r})$ 的[反对称波函数](@entry_id:153813) $\Psi$ 中，动能与[电子-电子相互作用](@entry_id:139900)能之和的最小值：
$$
F[n] = \min_{\Psi \to n} \langle \Psi | \hat{T} + \hat{V}_{ee} | \Psi \rangle
$$
通过这种方式，总能量泛函 $E_v[n] = F[n] + \int n(\mathbf{r}) v_{\mathrm{ext}}(\mathbf{r}) d\mathbf{r}$ 的定义域被扩展到所有 **N-可表示 (N-representable)** 的密度。一个密度是 N-可表示的，只要它能由某个反对称的 N-电子[波函数](@entry_id:147440)导出，其充要条件仅为 $n(\mathbf{r}) \ge 0$ 且 $\int n(\mathbf{r}) d\mathbf{r} = N$。这是一种比 v-[可表示性](@entry_id:635277)弱得多且更自然的约束，为 DFT 的变分原理提供了坚实而实用的基础 [@problem_id:2480433]。

### Kohn-Sham 方法：一种实用的计算方案

尽管 HK 定理证明了能量泛函的存在性，但其具体形式，尤其是[普适泛函](@entry_id:140176) $F[n]$ 中的动能部分 $T[n]$，是未知的，且直接近似它非常困难。Kohn 和 Sham 提出的方案巧妙地绕开了这个问题。他们引入一个虚拟的、无相互作用的电子体系，该体系的电子处在一个有效的局域势 $v_s(\mathbf{r})$ 中，并且其基态密度与真实相互作用体系的基态密度完全相同。

对于这个无相互作用的参考体系，动能 $T_s[n]$ 可以通过其单粒子[轨道](@entry_id:137151) $\{\phi_i\}$ 精确地表示：
$$
T_s[n] = \sum_{i=1}^{N} \langle \phi_i | -\frac{1}{2}\nabla^2 | \phi_i \rangle
$$
而密度则为 $n(\mathbf{r}) = \sum_{i=1}^{N} |\phi_i(\mathbf{r})|^2$。

然后，真实体系的总能量泛函被重新写为：
$$
E[n] = T_s[n] + \int v_{\mathrm{ext}}(\mathbf{r}) n(\mathbf{r}) d\mathbf{r} + E_H[n] + E_{xc}[n]
$$
这里，$T_s[n]$ 是上述无相互作用动能。$E_H[n]$ 是经典的电子-电子库仑排斥能，即 **哈特里 (Hartree) 能**：
$$
E_H[n] = \frac{1}{2} \iint \frac{n(\mathbf{r}) n(\mathbf{r}')}{|\mathbf{r}-\mathbf{r}'|} d\mathbf{r} d\mathbf{r}'
$$
所有复杂的[多体效应](@entry_id:173569)，包括真实动能与 $T_s[n]$ 的差值，以及所有非经典的[电子-电子相互作用](@entry_id:139900)（交换和关联），都被归入了一个新的项——**交换关联能** $E_{xc}[n]$。
$$
E_{xc}[n] = (T[n] - T_s[n]) + (V_{ee}[n] - E_H[n])
$$
Kohn-Sham (KS) 方法的巨大成功在于，$E_{xc}[n]$ 虽然形式未知，但它通常是一个较小的量，并且可以被各种近似（如后述的 [LDA](@entry_id:138982), GGA 等）较好地描述。

将总能量 $E[n]$ 对[轨道](@entry_id:137151) $\{\phi_i\}$ 进行变分求解，最终得到一组类似于单[电子薛定谔方程](@entry_id:177999)的 **Kohn-Sham 方程**：
$$
\left[ -\frac{1}{2}\nabla^2 + v_{s}(\mathbf{r}) \right] \phi_i(\mathbf{r}) = \epsilon_i \phi_i(\mathbf{r})
$$
其中，有效势 $v_s(\mathbf{r})$ 是一个局域的乘性势：
$$
v_s(\mathbf{r}) = v_{\mathrm{ext}}(\mathbf{r}) + v_H(\mathbf{r}) + v_{xc}(\mathbf{r})
$$
$v_H(\mathbf{r}) = \int \frac{n(\mathbf{r}')}{|\mathbf{r}-\mathbf{r}'|}d\mathbf{r}'$ 是哈特里势，$v_{xc}(\mathbf{r}) = \frac{\delta E_{xc}[n]}{\delta n(\mathbf{r})}$ 是交换关联系。由于[有效势](@entry_id:142581)依赖于电子密度，而电子密度又由 KS [轨道](@entry_id:137151)构成，因此 KS 方程必须通过自洽迭代的方式求解。

### 近似电子-离子相互作用：[赝势](@entry_id:170389)与[投影缀加波方法](@entry_id:753811)

在实际的材料计算中，KS 方程中的外部势 $v_{\mathrm{ext}}(\mathbf{r})$ 主要来自[原子核](@entry_id:167902)。[原子核](@entry_id:167902)及其周围紧密束缚的芯层电子共同构成了离子实。描述价电子与离子实之间的强[库仑相互作用](@entry_id:747947)是 DFT 计算面临的第一个挑战。

#### 赝势的动机

全电子 (all-electron) 计算需要同时处理体系中所有的电子，包括深能级的芯层电子和参与成键的价电子。这种方法在原理上最为精确，但在计算上代价极高，尤其当使用平面波 (plane-wave) [基组](@entry_id:160309)时。其根本原因在于价电子[波函数](@entry_id:147440)在靠近[原子核](@entry_id:167902)的芯区内的行为 [@problem_id:2480449]。

1.  **库仑奇异性与[波函数](@entry_id:147440)尖峰 (Cusp)**：在[原子核](@entry_id:167902)位置，电子感受到一个奇异的 ($-Z/r$) [库仑势](@entry_id:154276)。为了满足薛定谔方程，s-[轨道](@entry_id:137151)的[波函数](@entry_id:147440)在核位置 ($r=0$) 必须表现为一个尖峰，即其一阶导数不连续。
2.  **与芯态的正交性要求**：根据量子力学原理，能量较高的价电子轨道必须与能量较低的芯层[电子轨道](@entry_id:157718)保持正交。例如，一个原子的 $3s$ 价电子[波函数](@entry_id:147440)必须与 $1s$ 和 $2s$ 芯层[波函数](@entry_id:147440)正交。这迫使价电子[波函数](@entry_id:147440)在芯区内产生快速的、节状的[振荡](@entry_id:267781)，以构造出必要的节点。

这两个特征——尖峰和快速[振荡](@entry_id:267781)——意味着价电子[波函数](@entry_id:147440)的傅里叶展开式中必然包含大量高频（大波矢 $\mathbf{G}$）分量。在一个[平面波基组](@entry_id:178287)计算中，[基组](@entry_id:160309)的大小由[动能截断](@entry_id:186065) $E_{\mathrm{cut}} = \frac{\hbar^2 G_{\max}^2}{2m}$ 决定。要精确描述这些尖锐特征，就需要非常大的 $G_{\max}$，即极高的 $E_{\mathrm{cut}}$，这使得计算量变得难以承受。

然而，化学键合主要由价电子在原子间区域和尾部的行为决定。芯区内[波函数](@entry_id:147440)的复杂形态对化学性质的影响甚微。这启发了**赝勢 (pseudopotential)** 方法：用一个更平滑、更弱的有效势（赝势）来替代真实的离子实势，同时用一个平滑的、没有节点的**赝[波函数](@entry_id:147440) (pseudo-wavefunction)** 来替代真实的价电子[波函数](@entry_id:147440)。这个赝[波函数](@entry_id:147440)在芯区外与真实[波函数](@entry_id:147440)完全吻合，但在芯区内则是平滑的。由于赝[波函数](@entry_id:147440)非常平滑，其[平面波展开](@entry_id:152012)收敛得很快，从而允许使用低得多的 $E_{\mathrm{cut}}$，极大地提高了[计算效率](@entry_id:270255) [@problem_id:2480449]。

#### 芯-价划分与半芯态

[赝势方法](@entry_id:137874)的第一步是进行 **芯-价划分 (core-valence partitioning)**，即决定哪些电子被视为化学惰性的**芯层电子 (core electrons)**，将其效应“冻结”在[赝势](@entry_id:170389)中；哪些电子被视为[化学活性](@entry_id:141717)的**价电子 (valence electrons)**，需要通过 KS 方程显式求解 [@problem_id:2480426]。

这一划分的物理基础是**冻芯近似 (frozen-core approximation)**，即假设芯层电子的[波函数](@entry_id:147440)在原子形成化合物时保持不变。对于能级很深、空间分布很局域的芯层电子，这是一个很好的近似。然而，对于一些能量较高、空间分布较广的“芯层”[轨道](@entry_id:137151)，这个近似可能会失效。这些[轨道](@entry_id:137151)被称为**半芯态 (semicore states)**。

决定是否将半芯态作为价电子处理，是生成一个高质量赝势的关键。以下是几个重要的判断标准：

1.  **芯-价密度交叠**：如果外层价电子的密度与半芯态电子的密度在空间上有显著的交叠，那么冻芯近似就很可能失效。这是因为交换关联能 $E_{xc}[n]$ 是[非线性](@entry_id:637147)的，当芯-价密度交叠 ($n_c$ 和 $n_v$ 同时不为零的区域) 显著时，$E_{xc}[n_c + n_v]$ 不能被简单地分解。将半芯态包含进价电子，可以更准确地处理这种[非线性](@entry_id:637147)的芯-价交换关联耦合效应 [@problem_id:2480426]。

2.  **化学环境的极化效应**：对于一些元素，特别是主族阳离子（如 Ga, In）和过渡金属，半芯态很容易被化学环境极化。例如，在 GaN 中，Ga 的 $3d$ 半芯态虽然是满壳层的，但其能量与 N 的 $2p$ 价电子态相近。这导致了强烈的 $p-d$ 排斥和[轨道杂化](@entry_id:140298)，显著影响材料的晶格常数和[带隙](@entry_id:191975)。若将 Ga $3d$ 态冻结在芯层，[赝势](@entry_id:170389)将无法描述这种重要的物理效应，导致结果严重偏离实验。因此，当半芯态的能量较浅并可能与成键电子发生相互作用时，必须将其包含在价电子中 [@problem_id:2480426]。

3.  **可移植性与散射性质**：[赝势](@entry_id:170389)的**可移植性 (transferability)** 指的是在一个参考构型（通常是孤立原子）下生成的赝勢，能否准确地应用于其他化学环境（如分子、晶体、表面，或处于高压下）。一个严格的检验标准是比较赝原子和全电子原子对电子的散射性质。这通常通过比较[径向波函数](@entry_id:266233)在某个半径处的[对数导数](@entry_id:169238) $D_l(E) = \frac{d\ln R_{l,E}(r)}{dr}|_{r=r_c}$ 作为能量 $E$ 的函数来评估。如果一个[赝势](@entry_id:170389)（未包含半芯态）在价电子能量区间内的 $D_l(E)$ 与[全电子计算](@entry_id:170546)结果出现显著偏差，特别是在某些[共振能量](@entry_id:147349)附近，这表明该赝势无法正确描述散射过程。将相关的半芯态（例如过渡金属的 $(n-1)p$ 态）包含到价电子中，通常可以修复这种偏差，恢复赝势的可移植性 [@problem_id:2480426]。

#### 模守恒赝势

20 世纪 80 年代初发展的**模守恒[赝势](@entry_id:170389) (norm-conserving pseudopotentials, NCPP)** 是现代赝势理论的里程碑 [@problem_id:2480421]。其构造遵循以下几个关键条件：

1.  对于每个角动量通道 $l$，在某个[截断半径](@entry_id:136708) $r_c$ 之外，赝[波函数](@entry_id:147440)与全电子[波函数](@entry_id:147440)完全相同。
2.  在 $r_c$ 之外，[赝势](@entry_id:170389)与全电子势完全相同。
3.  全电子和赝原子参考态的本征能量 $\varepsilon_l$ 相同。
4.  **模守恒条件**：在 $r_c$ 之内，赝[波函数](@entry_id:147440)和全电子[波函数](@entry_id:147440)的积分[电荷](@entry_id:275494)（模的平方）必须相等：
    $$
    \int_0^{r_c} |u_l^{\mathrm{ps}}(r; \varepsilon_l)|^2 dr = \int_0^{r_c} |u_l^{\mathrm{AE}}(r; \varepsilon_l)|^2 dr
    $$
    其中 $u(r) = r R(r)$ 是[径向波函数](@entry_id:266233)。

模守恒条件是至关重要的，它保证了[赝势](@entry_id:170389)在参考能量 $\varepsilon_l$ 附近具有良好的可移植性。数学上，这个条件确保了在 $r_c$ 处，[波函数](@entry_id:147440)[对数导数](@entry_id:169238)的一阶[能量导数](@entry_id:170468)也是匹配的，这意味着赝势不仅能在参考能量点上，而且能在该能量点的一个小邻域内正确地描述散射性质。

在实际计算中，赝势通常被分解为一个局域部分 $V_{\mathrm{loc}}(r)$ 和一个非局域的、依赖于角动量的部分 $\hat{V}_{\mathrm{nl}}$。为了提高计算效率，Kleinman 和 Bylander 提出了将非局域部分写成可分离形式的方法：
$$
\hat{V}_{\mathrm{nl}} = \sum_{lm} |\chi_{lm}\rangle E_{lm} \langle \chi_{lm}|
$$
其中[投影算符](@entry_id:154142) $|\chi_{lm}\rangle$ 由参考赝[波函数](@entry_id:147440) $|\phi_{lm}\rangle$ 和势差 $(\hat{V}_l - \hat{V}_{\mathrm{loc}})$ 构造而来，即 $|\chi_{lm}\rangle = (\hat{V}_l - \hat{V}_{\mathrm{loc}})|\phi_{lm}\rangle$，而系数 $E_{lm}$ 是一个归一化因子。这种形式将对每个角动量通道分别进行的操作，转化成一系列投影操作，极大地加速了计算 [@problem_id:2480421]。

#### [超软赝势](@entry_id:144509)

模守恒赝势虽然大大提高了[计算效率](@entry_id:270255)，但对于一些具有局域[轨道](@entry_id:137151)的元素（如第一行元素、过渡金属），仍需要较高的 $E_{\mathrm{cut}}$。为了进一步降低[截断能](@entry_id:177594)，Vanderbilt 提出了**[超软赝势](@entry_id:144509) (ultrasoft pseudopotentials, USPP)** 的思想 [@problem_id:2480418]。

USPP 的核心在于**放弃模守恒条件**。通过允许芯区内的赝[电荷](@entry_id:275494)少于真实[电荷](@entry_id:275494)，赝[波函数](@entry_id:147440)可以被构造得异常平滑（“超软”），从而可以用更少的[平面波基](@entry_id:140187)函数来描述，对应极低的 $E_{\mathrm{cut}}$。

为了弥补芯区内缺失的[电荷](@entry_id:275494)并保持总电荷守恒，USPP 引入了**缀加[电荷](@entry_id:275494) (augmentation charges)** $Q_{ij}(\mathbf{r})$。总的价电子密度 $n(\mathbf{r})$ 不再是简单地由赝[波函数](@entry_id:147440)模平方给出，而是包含了缀加项：
$$
n(\mathbf{r}) = \sum_{n} f_n \left( |\psi_n(\mathbf{r})|^2 + \sum_{ij} Q_{ij}(\mathbf{r}) \langle \psi_n | \beta_i \rangle \langle \beta_j | \psi_n \rangle \right)
$$
其中 $\{|\beta_i\rangle\}$ 是与缀加[电荷](@entry_id:275494)相关的局域化投影算符。

这种复杂的[电荷密度](@entry_id:144672)形式导致了一个重要的后果：Kohn-Sham [轨道](@entry_id:137151)的正交归一条件不再是标准的 $\langle \psi_m | \psi_n \rangle = \delta_{mn}$，而是变成了一个广义的形式 $\langle \psi_m | \hat{S} | \psi_n \rangle = \delta_{mn}$，其中 $\hat{S}$ 是一个非单位的、正定的**重叠算符 (overlap operator)**。这使得标准的 KS 本征值问题变成了一个**广义[本征值问题](@entry_id:142153)**：
$$
\hat{H}_{\mathrm{KS}} |\psi_n\rangle = \epsilon_n \hat{S} |\psi_n\rangle
$$
尽管 USPP 的理论形式更复杂，但它带来的[计算效率](@entry_id:270255)提升是显著的，使其成为处理许多体系的标准方法之一 [@problem_id:2480418] [@problem_id:2480449]。

#### 投影缀加波（PAW）方法

**投影缀加波 (Projector Augmented-Wave, PAW)** 方法由 Blöchl 提出，它被认为是连接[赝势方法](@entry_id:137874)和全电子方法的一座桥梁，形式上比[赝势](@entry_id:170389)更为严谨 [@problem_id:2480449]。PAW 的核心思想是建立一个精确的[线性变换](@entry_id:149133) $\mathcal{T}$，将计算上易于处理的平滑赝[波函数](@entry_id:147440) $|\tilde{\psi}_n\rangle$ 精确地映射回物理上真实的全电子[波函数](@entry_id:147440) $|\psi_n\rangle$：
$$
|\psi_n\rangle = \mathcal{T} |\tilde{\psi}_n\rangle
$$
这个变换只在每个原子周围的缀加球 (augmentation sphere) 内非平凡。在缀加球内部，真实的[波函数](@entry_id:147440)可以通过平滑[波函数](@entry_id:147440)和一个局域的、原子中心的修正项来重建。这个修正项由全电子部分波 $(\phi_i)$ 和赝部分波 $(\tilde{\phi}_i)$ 的差值以及一组投影算符 $(\tilde{p}_i)$ 构成。

PAW 方法的优美之处在于，任何[可观测量](@entry_id:267133)的全电子[期望值](@entry_id:153208) $\langle A \rangle = \langle \psi_n | \hat{A} | \psi_n \rangle$ 都可以通过对赝[波函数](@entry_id:147440)计算一个[有效算符](@entry_id:183730) $\tilde{A} = \mathcal{T}^\dagger \hat{A} \mathcal{T}$ 的[期望值](@entry_id:153208)来获得。这个[有效算符](@entry_id:183730)同样可以分解为一个作用在平滑赝[波函数](@entry_id:147440)上的平滑部分，以及在缀加球内的局域修正。

这种方法使得我们既能享受到平滑[波函数](@entry_id:147440)带来的低[截断能](@entry_id:177594)的计算优势（类似于 USPP），又能随时重建全电子[波函数](@entry_id:147440)和密度，从而计算出精确的全电子性质。例如，当使用[非线性](@entry_id:637147)的交换关联泛函时，PAW 可以通过在缀加球内重建全电子密度及其梯度，来精确计算交换关联能，避免了冻芯近似和[非线性](@entry_id:637147)核心修正 (NLCC) 带来的误差 [@problem_id:2480476]。同样，当使用 [DFT+U](@entry_id:142114) 或杂化泛函时，PAW 框架也提供了严谨的方式来计算局域[轨道](@entry_id:137151)占据数或非局域的 Fock[交换算符](@entry_id:156554)矩阵元 [@problem_id:2480423] [@problem_id:2480482]。

### 交换关联泛函的層级

KS-DFT 的所有多体物理都被浓缩在交换关联泛函 $E_{xc}[n]$ 中。由于其精确形式未知，发展日益精确且计算可行的近似泛函是 DFT 领域的核心任务。这些近似通常被想象成一个“[雅各布天梯](@entry_id:139901) (Jacob's Ladder)”，每一级都引入更复杂的[密度依赖性](@entry_id:203727)，旨在获得更高的精度。

#### [局域密度近似](@entry_id:138982) ([LDA](@entry_id:138982))

梯子的最底层是 **[局域密度近似](@entry_id:138982) (Local Density Approximation, [LDA](@entry_id:138982))**。[LDA](@entry_id:138982) 的思想极其简单：它假设在空间中的每一点 $\mathbf{r}$，非[均匀电子气](@entry_id:163911)的交换关联能密度，与该点的电子密度 $n(\mathbf{r})$ 相同的**[均匀电子气](@entry_id:163911) (uniform electron gas, UEG)** 的交换关联能密度 $\epsilon_{xc}^{\mathrm{unif}}$ 相等。其表达式为：
$$
E_{xc}^{\mathrm{LDA}}[n] = \int n(\mathbf{r}) \epsilon_{xc}^{\mathrm{unif}}(n(\mathbf{r})) d\mathbf{r}
$$
$\epsilon_{xc}^{\mathrm{unif}}$ 的数值可以通过精确的[量子蒙特卡洛方法](@entry_id:753887)计算得到，并拟合成解析函数。[LDA](@entry_id:138982) 在构造上满足[均匀电子气](@entry_id:163911)极限和一些重要的标度关系 [@problem_id:2480476]。尽管思想简单，[LDA](@entry_id:138982) 在描述高密度和缓慢变化密度体系（如简单金属）的结构性质（如晶格常数、体弹模量）方面取得了惊人的成功。然而，它通常会过高地估计[化学键](@entry_id:138216)的键能（过结合），并严重低估[半导体](@entry_id:141536)和绝缘体的[带隙](@entry_id:191975)。

#### [广义梯度近似 (GGA)](@entry_id:140295)

为了超越 LDA，**[广义梯度近似](@entry_id:274118) (Generalized Gradient Approximations, GGA)** 登上了梯子的第二级。GGA 不仅考虑了局域密度 $n(\mathbf{r})$，还引入了密度的**局域梯度** $\nabla n(\mathbf{r})$ 作为变量，以描述电子密度的非均匀性。其通用形式为：
$$
E_{xc}^{\mathrm{GGA}}[n] = \int f(n(\mathbf{r}), |\nabla n(\mathbf{r})|) d\mathbf{r}
$$
在实际构造中，通常使用无量纲的简约密度梯度 $s \propto |\nabla n|/n^{4/3}$ 作为变量。与 LDA 一样，GGA 泛函也被设计用来满足一系列已知的精确约束，例如[均匀电子气](@entry_id:163911)极限和[交换能](@entry_id:137069)的[标度关系](@entry_id:273705) [@problem_id:2480476]。著名的 GGA 泛函包括 B88 (Becke 1988) 和 PBE (Perdew-Burke-Ernzerhof)。相比 LDA，GGA 显著改善了对原子、分子和固体中化学键的描述，通常能给出更准确的键能和几何结构。然而，GGA 仍然继承了 [LDA](@entry_id:138982) 的许多缺陷，例如自相互作用误差和无法描述[范德华相互作用](@entry_id:168429)。

#### 荟萃[广义梯度近似](@entry_id:274118) ([meta-GGA](@entry_id:191648))

梯子的第三级是 **荟萃[广义梯度近似](@entry_id:274118) ([meta-GGA](@entry_id:191648))**。除了密度 $n$ 和梯度 $\nabla n$ 之外，[meta-GGA](@entry_id:191648) 还引入了 KS [轨道](@entry_id:137151)的**动能密度** $\tau(\mathbf{r})$ 作为额外的半局域变量：
$$
\tau(\mathbf{r}) = \frac{1}{2} \sum_i^{\mathrm{occ}} |\nabla \phi_i(\mathbf{r})|^2
$$
其泛函形式为：
$$
E_{xc}^{\mathrm{mGGA}}[n] = \int f(n(\mathbf{r}), |\nabla n(\mathbf{r})|, \tau(\mathbf{r})) d\mathbf{r}
$$
引入 $\tau$ 的一个强大动机在于它能帮助泛函“识别”不同的化学环境 [@problem_id:2480476]。例如，在单[轨道](@entry_id:137151)主导的区域（如原子尾部或单电子体系），$\tau$ 与 von Weizsäcker 动能密度 $\tau_W \propto |\nabla n|^2/n$ 相等。而在[共价键](@entry_id:141465)区域，$\tau$ 则显著大于 $\tau_W$。通过构造一个依赖于 $\tau/\tau_W$ 或类似指标的因子，[meta-GGA](@entry_id:191648) 泛函原则上可以区分这些区域，并应用不同的物理模型。这使得 [meta-GGA](@entry_id:191648) 有可能在不引入[非局域性](@entry_id:140165)的情况下，满足一些 GGA 无法满足的精确条件，最著名的就是对单电子体系实现[自相互作用](@entry_id:201333)的完全消除。

#### 杂化泛函与广义 Kohn-Sham 框架

梯子的第四级通过引入**非局域的**[精确交换](@entry_id:178558)（即 Hartree-Fock 形式的交换）来显著改善近似。这类泛函被称为**[杂化泛函](@entry_id:164921) (hybrid functionals)** [@problem_id:2480482]。一个典型的**全局[杂化泛函](@entry_id:164921)**将一小部分（通常为 $a \approx 0.25$）的 GGA 交换替换为[精确交换](@entry_id:178558)：
$$
E_{xc}^{\mathrm{hyb}} = a E_x^{\mathrm{HF}} + (1-a) E_x^{\mathrm{GGA}} + E_c^{\mathrm{GGA}}
$$
[精确交换](@entry_id:178558)项 $E_x^{\mathrm{HF}}$ 是一个依赖于 KS [轨道](@entry_id:137151)的非局域项：
$$
E_x^{\mathrm{HF}}[\{\phi_i\}] = -\frac{1}{2} \sum_{i,j}^{\mathrm{occ}} \iint \frac{\phi_i^*(\mathbf{r}) \phi_j^*(\mathbf{r}') \phi_j(\mathbf{r}) \phi_i(\mathbf{r}')}{|\mathbf{r}-\mathbf{r}'|} d\mathbf{r} d\mathbf{r}'
$$
由于 $E_{xc}^{\mathrm{hyb}}$ 不再是密度的显式泛函，而是[轨道](@entry_id:137151)泛函，对它进行变分求解需要用到所谓的**广义 Kohn-Sham (GKS)** 框架。其结果是，KS 方程中的交换关联势不再是一个简单的局域[乘性](@entry_id:187940)势，而是包含了一个非局域的积分算符（Fock [交换算符](@entry_id:156554)）：
$$
\hat{v}_x^{\mathrm{HF}} \phi_i(\mathbf{r}) = \int K_x(\mathbf{r}, \mathbf{r}') \phi_i(\mathbf{r}') d\mathbf{r}' = -\sum_j^{\mathrm{occ}} \phi_j(\mathbf{r}) \int \frac{\phi_j^*(\mathbf{r}') \phi_i(\mathbf{r}')}{|\mathbf{r}-\mathbf{r}'|} d\mathbf{r}'
$$
[杂化泛函](@entry_id:164921)通过引入一部分[精确交换](@entry_id:178558)，显著减轻了半局域泛函的[自相互作用误差](@entry_id:139981)，从而能更准确地预测[半导体带隙](@entry_id:191250)、分子性质以及某些过渡金属氧化物的电子结构。为了降低非局域 Fock 交换带来的巨大计算成本，**[范围分离杂化泛函](@entry_id:184447) (range-separated hybrids)** (如 HSE) 被提出，它仅在短程使用 Fock 交换，而在长程恢复为计算代价较小的 GGA 交换，其交换核将 $1/|\mathbf{r}-\mathbf{r}'|$ 替换为如 $\mathrm{erfc}(\omega|\mathbf{r}-\mathbf{r}'|)/|\mathbf{r}-\mathbf{r}'|$ 的形式 [@problem_id:2480482]。

### 应对半局域泛函的特定失效

尽管泛函的层级不断提升，但即便是高级的半局域泛函（GGA, [meta-GGA](@entry_id:191648)）在处理某些关键物理问题时仍会遇到系统性的失败。针对这些问题，人们发展了特定的修正方案。

#### [自相互作用误差](@entry_id:139981)

**[自相互作用误差](@entry_id:139981) (Self-Interaction Error, SIE)** 是所有常用半局域泛函的根本缺陷之一 [@problem_id:2480465]。在一个真实的单电子体系中（例如氢原子），电子不应与自身发生相互作用。这意味着哈特里能 $E_H[n_{1e}]$ 必须被[交换能](@entry_id:137069) $E_x[n_{1e}]$ 精确抵消，而关联能 $E_c[n_{1e}]$ 必须为零。即，对于精确的泛函：
$$
E_x[n_{1e}] = -E_H[n_{1e}] \quad \text{and} \quad E_c[n_{1e}] = 0
$$
这进一步要求交换关联势 $v_{xc}(\mathbf{r})$ 精确抵消哈特里势 $v_H(\mathbf_r)$。然而，对于 [LDA](@entry_id:138982) 和 GGA 等半局域泛函，这种抵消是不完全的。其交换部分不足以抵消非局域的哈特里[自相互作用](@entry_id:201333)，导致一个虚假的、排斥性的自相互作用能 $\Delta_{\mathrm{SIE}} = E_H[n_{1e}] + E_{xc}^{\mathrm{approx}}[n_{1e}] > 0$。

这种误差的一个严重后果体现在[有效势](@entry_id:142581)的渐进行为上。对于一个中性原子，真实的有效 KS 势在远离[原子核](@entry_id:167902)处 ($|\mathbf{r}| \to \infty$) 应衰减为 $-1/|\mathbf{r}|$。但对于半局域泛函，由于 $v_H(\mathbf{r})$ 的 $+1/|\mathbf{r}|$ 尾部没有被 $v_{xc}(\mathbf{r})$ (它随指数衰减的密度而快速趋于零) 正确抵消，总的 KS 势过快地趋于零。这导致[势阱](@entry_id:151413)过浅，电子束缚不足，最高占据[轨道](@entry_id:137151) (HOMO) 的能量被系统性地高估（不够负） [@problem_id:2480465]。SIE 是导致半局域 DFT 低估[带隙](@entry_id:191975)、错误描述[电荷转移激发](@entry_id:174772)以及过度[离域](@entry_id:183327)化 $d/f$ 电子态的根源。

#### 强关联与 [DFT+U](@entry_id:142114) 方法

对于包含局域化 $d$ 或 $f$ 电子的体系，如许多过渡金属氧化物和稀土化合物，SIE 导致的电子过度离域问题尤为严重。半局域 DFT 常常错误地将这些体系预测为金属，而实验上它们是具有大[带隙](@entry_id:191975)的莫特绝緣体或[电荷转移绝缘体](@entry_id:137636)。

为了解决这个问题，**[DFT+U](@entry_id:142114) 方法** 被提出 [@problem_id:2480423]。它是一种在半局域 DFT 基础上附加一个哈勃 (Hubbard) 式库仑惩罚项的 pragmatic 方案。这个惩罚项 $E_U$ 只作用于预先指定的原子上的局域化[轨道](@entry_id:137151)[子空间](@entry_id:150286)（如 $d$ [轨道](@entry_id:137151)）。其目的是对该[子空间](@entry_id:150286)中的电子非整數占据施加能量惩罚，从而促使电子态局域化。在 **Dudarev 等人提出的旋转不变形式** 中，该能量项简洁地写为：
$$
E_U = \frac{U_{\mathrm{eff}}}{2} \sum_{I,\sigma} \left( \mathrm{Tr}\, n^{I\sigma} - \mathrm{Tr}\left[(n^{I\sigma})^2\right] \right)
$$
其中 $I$ 是原子指标，$\sigma$ 是自旋指标，$U_{\mathrm{eff}} = U-J$ 是有效的 onsite [库仑相互作用](@entry_id:747947)参数，$n^{I\sigma}$ 是该原子上局域[轨道](@entry_id:137151)的占据数矩阵。这个泛函形式巧妙地满足了几个重要条件：(1) 当[轨道](@entry_id:137151)被完全占据或完全空置时（$n^{I\sigma}$ 的[本征值](@entry_id:154894)为 0 或 1），能量校正为零；(2) 当[轨道](@entry_id:137151)被部分占据时，能量惩罚为正；(3) 能量在局域[轨道](@entry_id:137151)[子空间](@entry_id:150286)的幺正变换下保持不变。在 PAW 方法中，占据数矩阵 $n^{I\sigma}_{mm'}$ 通过将 KS [轨道](@entry_id:137151)投影到局域化的原子中心[轨道](@entry_id:137151) $|\varphi_m^I\rangle$上来计算，这一过程需要利用 PAW 投影算符和部分波进行精确的缀加重建 [@problem_id:2480423]。

#### [范德华相互作用](@entry_id:168429)与[色散校正](@entry_id:197264)

另一类重要的相互作用是 **范德华 (van der Waals, vdW) 力**，特别是其长程吸引部分，即**伦敦色散力 (London dispersion force)**。这种力起源于瞬时偶极矩涨落之间的量子关联，是一种固有的非局域效应。它对于描述分子晶体、层状材料、以及分子在表面的吸附等弱相互作用体系至关重要。

然而，所有的局域 ([LDA](@entry_id:138982)) 和半局域 (GGA, [meta-GGA](@entry_id:191648)) 泛函，由于其数学形式只依赖于局域的电子密度及其导数，从根本上无法描述两个空间上分离、密度无交叠的片段之间的长程关联 [@problem_id:2480419]。对于这类体系，半局域泛函预测的[相互作用能](@entry_id:264333)错误地趋于零。

为了弥补这一缺陷，人们发展了两类主流方法：

1.  **[经验色散校正](@entry_id:172581) (Empirical Dispersion Corrections, [DFT-D](@entry_id:172133))**：这类方法在标准的 DFT 总能量之上，直接添加一个经验性的、依赖于原子坐标的[色散能](@entry_id:261481)项。例如，在 [DFT-D](@entry_id:172133)3 方法中，这个能量项包含成对的 $C_6/R^6$ 项和 $C_8/R^8$ 项，以及[三体](@entry_id:265960)的 Axilrod-Teller-Muto 项。