{"hands_on_practices": [{"introduction": "赝势是简化密度泛函理论计算的关键工具，它通过用一个更平滑、更弱的有效势替代原子核及其内层电子的强库仑势来实现。这种替代使得价电子波函数在核心区域变得平滑，从而可以用更少的平面波基组进行精确描述。本练习将揭开赝势构造的神秘面纱，引导你为一个简单的类氢原子，逐步完成 Troullier-Martins 方法中的关键步骤。通过亲手实践，你将深刻理解范数守恒和平滑性等数学约束条件是如何确保赝势的可移植性和计算效率的。", "problem": "在密度泛函理论（DFT）的框架下，构建平滑模守恒赝势以替代核心区的全电子势，同时保持价电子的散射性质。考虑一个有效核电荷为 $Z=1$ 的类氢原子（在原子单位下），其 $s$ 轨道，即角动量 $l=0$ 的情况。其约化径向函数 $u_{ae}(r)=r\\,R_{ae}(r)$ 所满足的全电子径向薛定谔方程为\n$$\n-\\frac{1}{2}\\frac{d^{2}u_{ae}}{dr^{2}}+\\left[\\frac{l(l+1)}{2r^{2}}+V_{ae}(r)\\right]u_{ae}(r)=\\varepsilon_{ae}\\,u_{ae}(r),\n$$\n对于 $l=0$ 的情况，归一化的类氢原子基态解为\n$$\nR_{ae}(r)=2\\,\\exp(-r),\\quad u_{ae}(r)=2r\\,\\exp(-r),\\quad \\varepsilon_{ae}=-\\frac{1}{2}.\n$$\n遵循 Troullier–Martins 构造法，通过最小偶次多项式指数拟设，为 $0\\le r\\le r_{c}$（截断半径 $r_{c}=1$ 玻尔）定义一个赝波函数：\n$$\nu_{ps}(r)=r\\,\\exp\\!\\big(p(r)\\big),\\quad p(r)=c_{0}+c_{2}\\,r^{2},\n$$\n并在 $r\\ge r_{c}$ 时，令 $u_{ps}(r)=u_{ae}(r)$。在 $r=r_{c}$ 处施加平滑性约束，要求函数值及其一阶导数连续，即 $u_{ps}(r_{c})=u_{ae}(r_{c})$ 和 $u_{ps}'(r_{c})=u_{ae}'(r_{c})$。\n\n从径向薛定谔方程和上述定义出发，完成以下任务：\n\n1. 根据平滑性约束，推导出 $c_{2}$ 关于 $r_{c}$、$u_{ae}(r_{c})$ 和 $u_{ae}'(r_{c})$ 的表达式，然后计算在 $r_{c}=1$ 时类氢原子 $1s$ 态的 $c_{2}$ 值。\n\n2. 使用 $l=0$ 的径向薛定谔方程，将核心区内部的局域赝势 $V_{ps}(r)$ 表示为 $u_{ps}(r)$、其导数以及本征值 $\\varepsilon$ 的函数（为了可移植性，取 $\\varepsilon=\\varepsilon_{ae}$）。根据此拟设和已确定的 $c_{2}$ 值，计算其有限极限 $V_{ps}(0)$。\n\n请以哈特里（Hartree）为单位，给出 $V_{ps}(0)$ 的最终数值。无需进行任何四舍五入，请报告精确值。", "solution": "该问题陈述科学严谨、定义明确、客观，并包含足够的信息以获得唯一解。这是密度泛函理论中赝势构造的一个标准教学练习。该问题是有效的。我们开始求解。\n\n该问题要求基于为核电荷 $Z=1$ 的类氢原子（原子单位下）所提供的先验定义，进行两项主要推导。\n\n首先，我们根据在截断半径 $r_{c}=1$ 处对赝波函数 $u_{ps}(r)$ 施加的平滑性约束来确定系数 $c_2$。\n核心区域内部（$0 \\le r \\le r_{c}$）的赝波函数由以下拟设给出：\n$$u_{ps}(r)=r\\,\\exp\\!\\big(p(r)\\big), \\quad \\text{其中} \\quad p(r)=c_{0}+c_{2}\\,r^{2}$$\n我们需要 $u_{ps}(r)$ 的一阶导数来实施平滑性条件。使用乘法法则和链式法则：\n$$u_{ps}'(r) = \\frac{d}{dr}\\left[r\\,\\exp(p(r))\\right] = \\exp(p(r)) + r \\cdot p'(r)\\exp(p(r)) = \\left(1+r\\,p'(r)\\right)\\exp(p(r))$$\n由于 $p(r) = c_{0}+c_{2}\\,r^{2}$，其导数为 $p'(r)=2c_{2}r$。将其代入 $u_{ps}'(r)$ 的表达式中：\n$$u_{ps}'(r) = \\left(1+2c_{2}r^{2}\\right)\\exp(p(r))$$\n对于 $l=0$，全电子（ae）基态（1s）约化径向函数为：\n$$u_{ae}(r) = 2r\\,\\exp(-r)$$\n其导数为：\n$$u_{ae}'(r) = \\frac{d}{dr}\\left[2r\\,\\exp(-r)\\right] = 2\\exp(-r) - 2r\\exp(-r) = 2(1-r)\\exp(-r)$$\n在截断半径 $r_c$ 处应用平滑性约束：\n1.  函数值连续： $u_{ps}(r_{c}) = u_{ae}(r_{c})$\n    $$r_{c}\\,\\exp(p(r_{c})) = u_{ae}(r_{c}) \\quad (1)$$\n2.  一阶导数连续： $u_{ps}'(r_{c}) = u_{ae}'(r_{c})$\n    $$\\left(1+2c_{2}r_{c}^{2}\\right)\\exp(p(r_{c})) = u_{ae}'(r_{c}) \\quad (2)$$\n为了得到 $c_2$ 的表达式，我们可以用方程 $(2)$ 除以方程 $(1)$。首先，我们将 $(1)$ 式重排得到 $\\exp(p(r_{c})) = \\frac{u_{ae}(r_{c})}{r_{c}}$。将此代入 $(2)$ 式：\n$$\\left(1+2c_{2}r_{c}^{2}\\right) \\frac{u_{ae}(r_{c})}{r_{c}} = u_{ae}'(r_{c})$$\n解出 $c_2$：\n$$1+2c_{2}r_{c}^{2} = \\frac{r_{c}u_{ae}'(r_{c})}{u_{ae}(r_{c})}$$\n$$2c_{2}r_{c}^{2} = \\frac{r_{c}u_{ae}'(r_{c})}{u_{ae}(r_{c})} - 1$$\n$$c_{2} = \\frac{1}{2r_{c}^{2}}\\left(\\frac{r_{c}u_{ae}'(r_{c})}{u_{ae}(r_{c})} - 1\\right)$$\n这就是 $c_2$ 的通用表达式。现在，我们在 $r_{c}=1$ 处为类氢原子 $1s$ 态计算该值。\n在 $r_{c}=1$ 时：\n$$u_{ae}(1) = 2(1)\\exp(-1) = 2\\exp(-1)$$\n$$u_{ae}'(1) = 2(1-1)\\exp(-1) = 0$$\n将这些值代入 $c_2$ 的表达式：\n$$c_{2} = \\frac{1}{2(1)^{2}}\\left(\\frac{1 \\cdot 0}{2\\exp(-1)} - 1\\right) = \\frac{1}{2}(0-1) = -\\frac{1}{2}$$\n\n其次，我们确定赝势在原点的值 $V_{ps}(0)$。赝势 $V_{ps}(r)$ 必须满足 $u_{ps}(r)$ 的径向薛定谔方程，其中 $l=0$ 时的全电子本征值为 $\\varepsilon = \\varepsilon_{ae} = -\\frac{1}{2}$：\n$$-\\frac{1}{2}\\frac{d^{2}u_{ps}}{dr^{2}}+V_{ps}(r)u_{ps}(r)=\\varepsilon u_{ps}(r)$$\n解出 $V_{ps}(r)$：\n$$V_{ps}(r) = \\varepsilon + \\frac{1}{2}\\frac{u_{ps}''(r)}{u_{ps}(r)}$$\n我们必须计算二阶导数 $u_{ps}''(r)$。从 $u_{ps}'(r) = \\left(1+2c_{2}r^{2}\\right)\\exp(p(r))$ 开始：\n$$u_{ps}''(r) = \\frac{d}{dr}\\left[\\left(1+2c_{2}r^{2}\\right)\\exp(p(r))\\right] = (4c_{2}r)\\exp(p(r)) + \\left(1+2c_{2}r^{2}\\right)p'(r)\\exp(p(r))$$\n代入 $p'(r)=2c_{2}r$：\n$$u_{ps}''(r) = \\left[4c_{2}r + \\left(1+2c_{2}r^{2}\\right)(2c_{2}r)\\right]\\exp(p(r)) = \\left(4c_{2}r + 2c_{2}r + 4c_{2}^{2}r^{3}\\right)\\exp(p(r))$$\n$$u_{ps}''(r) = \\left(6c_{2}r + 4c_{2}^{2}r^{3}\\right)\\exp(p(r))$$\n现在我们构建 $V_{ps}(r)$ 所需的比值：\n$$\\frac{u_{ps}''(r)}{u_{ps}(r)} = \\frac{\\left(6c_{2}r + 4c_{2}^{2}r^{3}\\right)\\exp(p(r))}{r\\,\\exp(p(r))} = 6c_{2} + 4c_{2}^{2}r^{2}$$\n因此，核心区内部的赝势为：\n$$V_{ps}(r) = \\varepsilon + \\frac{1}{2}\\left(6c_{2} + 4c_{2}^{2}r^{2}\\right) = \\varepsilon + 3c_{2} + 2c_{2}^{2}r^{2}$$\n为求得原点处的值，我们取 $r \\to 0$ 的极限：\n$$V_{ps}(0) = \\lim_{r \\to 0} V_{ps}(r) = \\varepsilon + 3c_{2}$$\n我们已知 $\\varepsilon = \\varepsilon_{ae} = -\\frac{1}{2}$，并且我们已计算出 $c_{2}=-\\frac{1}{2}$。代入这些值：\n$$V_{ps}(0) = -\\frac{1}{2} + 3\\left(-\\frac{1}{2}\\right) = -\\frac{1}{2} - \\frac{3}{2} = -\\frac{4}{2} = -2$$\n赝势在原点的值为 $-2$ 哈特里。", "answer": "$$\\boxed{-2}$$", "id": "2480407"}, {"introduction": "理解了赝势的构造原理后，下一步便是如何在实际计算中应用它。在基于平面波的密度泛函理论计算中，平面波截断能 $E_{\\mathrm{cut}}$ 是决定计算精度与资源消耗之间平衡的最关键参数。本练习将建立一个总能量收敛性的解析模型，让你能够定量地分析并比较全电子计算和赝势计算对截断能的需求。你将通过计算发现，一个“更软”的赝势（即更平滑）如何能以更低（因而计算成本更小）的截断能达到与全电子计算同等的精度，从而揭示赝势设计的核心优势。[@problem_id:2480412]", "problem": "考虑在原子单位下，密度泛函理论 (DFT) 中 Kohn–Sham 轨道的平面波离散化，其中动能截断 $E_{\\mathrm{cut}}$ 在倒易空间中定义了一个半径为 $k_c$ 的球，且 $k_c = \\sqrt{2 E_{\\mathrm{cut}}}$。在 $k_c$ 处截断平面波基组会移除轨道的高频分量，并导致总能量发生变分性增加。假设主要的截断误差来源于被忽略的高 $k$ 尾部的动能贡献，并且交换相关和静电贡献足够光滑，以至于在渐近区域中，它们被忽略的尾部相比于动能贡献要么衰减得更快，要么可以忽略不计。\n\n使用以下经过充分检验的事实作为基本依据：\n(1) 在原子单位下，平面波分量 $\\mathbf{k}$ 的动能贡献与 $k^2$ 成正比。\n(2) 对于足够大的 $k_c$，通过对平面波振幅平方 $|c_{\\mathbf{k}}|^2$ 的高 $k$ 尾部进行积分，可以对截断倒易空间于 $k_c$ 处所产生的忽略误差进行建模。在许多物理相关的情形中，其渐近行为表现为幂律 $|c_{\\mathbf{k}}|^2 \\sim A k^{-p}$，其中 $p>3$ 且 $A>0$。\n(3) 对于库仑奇点附近的全电子轨道，Kato 尖点条件意味着存在非解析性，这会导致一个相对较慢的高 $k$ 衰减（一个代表性情况是 $p=4$）。然而，对于在一个选定的核心半径 $r_c$ 内具有足够光滑的赝波函数的保范赝势，移除核尖点和强制的光滑性会产生更快的高 $k$ 衰减（例如，当赝波函数在 $r_c$ 处至少二阶连续可微时，一个代表性情况是 $p=6$）。\n\n基于这些依据，通过将误差建模为对被忽略的倒易空间区域的积分，推导由 $k_c$ 截断引起的总能量误差 $\\Delta E(E_{\\mathrm{cut}})$ 关于 $p$ 和 $k_c$ 的渐近主阶标度关系。将所有几何与归一化常数视为被吸收到一个单一的正预因子 $K$ 中，该预因子依赖于材料的细节和赝势的构建（包括 $r_c$ 的选择），从而使您的推导得出对 $k_c$（并因此对 $E_{\\mathrm{cut}}$）的显式幂律依赖关系。\n\n然后，使用您推导出的表达式，实现一个算法，对于给定的 $(K,p,\\varepsilon)$ 且 $p>3$，计算满足渐近误差界 $\\Delta E(E_{\\mathrm{cut}}) \\le \\varepsilon$ 的最小 $E_{\\mathrm{cut}}$（以哈特里为单位）。角度不出现；所有能量必须以哈特里表示。返回的数值答案需四舍五入到六位小数。\n\n对于氧化镁 (MgO)，考虑以下测试套件，该套件捕捉了全电子参考与两种仅在核心半径 $r_c$ 选择上不同的保范赝势 (NCPP) 构建之间的比较。较大的 $r_c$ 对应于具有较小预因子 $K$ 的“软”赝势；较小的 $r_c$ 对应于具有较大预因子 $K$ 的“硬”赝势。使用给定的代表性指数 $p$。\n\n测试套件（所有能量单位均为哈特里）：\n- 案例 1 (MgO, 全电子参考): $p=4$, $K=0.01$, 目标容差 $\\varepsilon=1\\times 10^{-3}$。\n- 案例 2 (MgO, 较小 $r_c$ 的 NCPP [较硬]): $p=6$, $K=0.02$, 目标容差 $\\varepsilon=1\\times 10^{-3}$。\n- 案例 3 (MgO, 较大 $r_c$ 的 NCPP [较软]): $p=6$, $K=0.005$, 目标容差 $\\varepsilon=1\\times 10^{-3}$。\n- 案例 4 (MgO, 全电子参考, 更严容差): $p=4$, $K=0.01$, 目标容差 $\\varepsilon=1\\times 10^{-6}$。\n- 案例 5 (为稳健性测试假设的边界附近极限光滑度): $p=3.2$, $K=0.001$, 目标容差 $\\varepsilon=1\\times 10^{-3}$。\n\n您的程序必须：\n- 使用您推导的公式计算满足案例 1–5 容差的最小 $E_{\\mathrm{cut}}$ (以哈特里为单位)。\n- 此外，对于 $\\varepsilon=1\\times 10^{-3}$，使用案例 1–3 的结果计算比率 $E_{\\mathrm{cut}}^{\\mathrm{NCPP\\;small}\\;r_c} / E_{\\mathrm{cut}}^{\\mathrm{AE}}$ 和 $E_{\\mathrm{cut}}^{\\mathrm{NCPP\\;large}\\;r_c} / E_{\\mathrm{cut}}^{\\mathrm{AE}}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按以下顺序排列：\n  $[E_{\\mathrm{cut}}^{(1)},E_{\\mathrm{cut}}^{(2)},E_{\\mathrm{cut}}^{(3)},R_{\\mathrm{small}/\\mathrm{AE}},R_{\\mathrm{large}/\\mathrm{AE}},E_{\\mathrm{cut}}^{(4)},E_{\\mathrm{cut}}^{(5)}]$,\n  其中每个条目都四舍五入到六位小数，$E_{\\mathrm{cut}}^{(i)}$ 是案例 $i=1,\\dots,5$ 的最小截断能，而 $R_{\\mathrm{small}/\\mathrm{AE}}$ 和 $R_{\\mathrm{large}/\\mathrm{AE}}$ 是上面定义的两个比率。\n\n科学真实性和解释要求：\n- 根据上述第一性原理推导误差的标度关系，展示幂律中的指数如何依赖于 $p$ 以及 $r_c$ 如何定性地影响 $K$。\n- 确保您的算法明确涵盖数学边界条件 $p>3$；所提供的测试套件遵守此条件。\n- 所有能量均以哈特里表示，并提供四舍五入到六位小数的最终数值输出。", "solution": "所提出的问题是计算材料科学领域的一个有效练习，它基于密度泛函理论 (DFT) 的原理。该问题是适定的、客观的，并包含完整推导和求解所需的所有信息。我们将开始进行推导。\n\n主要目标是推导总能量截断误差 $\\Delta E$ 与平面波动能截断 $E_{\\mathrm{cut}}$ 之间的标度关系，然后应用此关系来计算给定误差容差 $\\varepsilon$ 所需的截断能。\n\n问题陈述指出，Kohn-Sham 轨道在平面波基组中展开。该基组被截断，只包含动能（在原子单位下为 $\\frac{1}{2}k^2$）小于截断能 $E_{\\mathrm{cut}}$ 的平面波 $\\mathbf{k}$。这在倒易空间中定义了一个半径为 $k_c$ 的球，使得 $\\frac{1}{2}k_c^2 = E_{\\mathrm{cut}}$，从而得出 $k_c = \\sqrt{2E_{\\mathrm{cut}}}$。\n\n根据问题陈述，截断误差 $\\Delta E$ 通过对被忽略的高 $k$ 分量的振幅平方 $|c_{\\mathbf{k}}|^2$ 进行积分来建模。这是一个作为前提提供的建模假设。\n$$\n\\Delta E(k_c) \\propto \\int_{|\\mathbf{k}| > k_c} |c_{\\mathbf{k}}|^2 \\, d^3k\n$$\n我们已知对于大的 $k = |\\mathbf{k}|$，振幅平方的渐近行为是 $|c_{\\mathbf{k}}|^2 \\sim A k^{-p}$，其中 $A > 0$ 且 $p > 3$。由于被积函数是球对称的，我们可以在倒易空间中转换到球坐标，其体积元为 $d^3k = 4\\pi k^2 dk$。积分变为：\n$$\n\\Delta E(k_c) \\propto \\int_{k_c}^{\\infty} (A k^{-p}) (4\\pi k^2 dk)\n$$\n我们将所有与 $\\mathbf{k}$ 无关的比例常数（如 $A$ 和 $4\\pi$）合并为问题中给出的单一预因子 $K$。因此，误差的渐近形式为：\n$$\n\\Delta E(k_c) \\propto K \\int_{k_c}^{\\infty} k^{-p} k^2 dk = K \\int_{k_c}^{\\infty} k^{2-p} dk\n$$\n此积分要求指数 $2-p  -1$，即 $p>3$ 才能收敛，这与问题陈述一致。积分计算结果为：\n$$\n\\int_{k_c}^{\\infty} k^{2-p} dk = \\left[ \\frac{k^{3-p}}{3-p} \\right]_{k_c}^{\\infty} = 0 - \\frac{k_c^{3-p}}{3-p} = \\frac{k_c^{3-p}}{p-3}\n$$\n因此，渐近误差的形式为：\n$$\n\\Delta E(k_c) = \\frac{K}{p-3} k_c^{3-p}\n$$\n现在，我们代入 $k_c = \\sqrt{2 E_{\\mathrm{cut}}}$：\n$$\n\\Delta E(E_{\\mathrm{cut}}) = \\frac{K}{p-3} \\left(\\sqrt{2 E_{\\mathrm{cut}}}\\right)^{3-p} = \\frac{K}{p-3} (2 E_{\\mathrm{cut}})^{\\frac{3-p}{2}}\n$$\n这就是推导出的标度定律。它正确地表明，对于更大的 $p$（更光滑的势），指数 $\\frac{3-p}{2}$ 的负值更大，导致误差随 $E_{\\mathrm{cut}}$ 的增加而衰减得更快。如预期的那样，较小的预因子 $K$（较软的势）在给定截断能下也会减少误差。\n\n为了找到满足目标容差 $\\varepsilon$ 的最小截断能 $E_{\\mathrm{cut}}$，我们令 $\\Delta E(E_{\\mathrm{cut}}) = \\varepsilon$ 并求解 $E_{\\mathrm{cut}}$：\n$$\n\\varepsilon = \\frac{K}{p-3} (2 E_{\\mathrm{cut}})^{\\frac{3-p}{2}}\n$$\n重新整理各项以分离出 $E_{\\mathrm{cut}}$：\n$$\n(2 E_{\\mathrm{cut}})^{\\frac{3-p}{2}} = \\frac{\\varepsilon (p-3)}{K}\n$$\n将两边同时取 $\\frac{2}{3-p}$ 次幂，这等于 $-\\frac{2}{p-3}$：\n$$\n2 E_{\\mathrm{cut}} = \\left( \\frac{\\varepsilon (p-3)}{K} \\right)^{\\frac{2}{3-p}} = \\left( \\left( \\frac{\\varepsilon (p-3)}{K} \\right)^{-1} \\right)^{\\frac{2}{p-3}} = \\left( \\frac{K}{\\varepsilon(p-3)} \\right)^{\\frac{2}{p-3}}\n$$\n最后，我们得到所需动能截断的表达式：\n$$\nE_{\\mathrm{cut}} = \\frac{1}{2} \\left(\\frac{K}{\\varepsilon(p-3)}\\right)^{\\frac{2}{p-3}}\n$$\n对于给定的条件 $p>3$以及正的先验常数 $K$ 和 $\\varepsilon$，此公式是良定义的。此表达式将用于实现问题的数值求解部分。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the minimum kinetic energy cutoff E_cut for given DFT convergence\n    parameters and calculates ratios between different potential types.\n    \"\"\"\n\n    # The formula for E_cut is derived from the asymptotic error model:\n    # Delta_E = (K / (p-3)) * (2 * E_cut)^((3-p)/2)\n    # Solving for E_cut for a given error tolerance epsilon gives:\n    # E_cut = (1/2) * (K / (epsilon * (p-3)))^(2 / (p-3))\n    def calculate_ecut(p, K, epsilon):\n        \"\"\"\n        Calculates the minimum kinetic energy cutoff in Hartree.\n\n        Args:\n            p (float): Power-law exponent for the decay of Fourier coefficients.\n            K (float): Prefactor related to the material and potential.\n            epsilon (float): Target energy tolerance in Hartree.\n\n        Returns:\n            float: The calculated E_cut in Hartree.\n        \"\"\"\n        if p = 3:\n            # This case should not be reached with the given valid problem statement.\n            return float('inf')\n        \n        p_minus_3 = p - 3.0\n        exponent = 2.0 / p_minus_3\n        base = K / (epsilon * p_minus_3)\n        \n        e_cut = 0.5 * (base ** exponent)\n        return e_cut\n\n    # Test suite from the problem statement: (p, K, epsilon)\n    test_cases = [\n        # Case 1: MgO, all-electron reference\n        (4.0, 0.01, 1e-3),\n        # Case 2: MgO, NCPP with smaller r_c (harder)\n        (6.0, 0.02, 1e-3),\n        # Case 3: MgO, NCPP with larger r_c (softer)\n        (6.0, 0.005, 1e-3),\n        # Case 4: MgO, all-electron reference, tighter tolerance\n        (4.0, 0.01, 1e-6),\n        # Case 5: Hypothetical limiting smoothness\n        (3.2, 0.001, 1e-3)\n    ]\n\n    # Calculate E_cut for all cases\n    e_cut_results = [calculate_ecut(p, K, eps) for p, K, eps in test_cases]\n\n    e_cut_1, e_cut_2, e_cut_3, e_cut_4, e_cut_5 = e_cut_results\n    \n    # Calculate required ratios using results from Cases 1-3\n    # Ratio of NCPP (small r_c, harder) to All-Electron cutoff\n    ratio_small_ae = e_cut_2 / e_cut_1\n    \n    # Ratio of NCPP (large r_c, softer) to All-Electron cutoff\n    ratio_large_ae = e_cut_3 / e_cut_1\n\n    # Assemble the final list of results in the specified order\n    final_results = [\n        e_cut_1,\n        e_cut_2,\n        e_cut_3,\n        ratio_small_ae,\n        ratio_large_ae,\n        e_cut_4,\n        e_cut_5\n    ]\n\n    # Format the results to six decimal places for the output string\n    formatted_results = [f'{val:.6f}' for val in final_results]\n    \n    # Print the final output in the exact required format\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2480412"}, {"introduction": "虽然赝势和收敛性测试对于获得可靠的计算结果至关重要，但理解理论框架的内在局限性也同等重要。标准 Kohn–Sham DFT 的一个著名缺陷是它常常严重低估材料的带隙。本练习使用一个可精确求解的哈伯德二聚体模型来深入探讨导致这一问题的根源——交换相关能的导数不连续性。你将分别计算该体系的真实基态能隙和 Kohn–Sham 能隙，亲身体验并量化两者之间的差异，从而理解为何标准 DFT 近似会系统性地低估这一关键的电子性质。[@problem_id:2480406]", "problem": "在材料化学中，密度泛函理论（DFT）中交换关联能的导数不连续性表现为精确的基本带隙与 Kohn–Sham（KS）单粒子带隙之间的不匹配。考虑一个对称的双位点 Hubbard 二聚体作为共价键的最小模型。其哈密顿量为\n$$\n\\hat{H} \\;=\\; -\\,t \\sum_{\\sigma\\in\\{\\uparrow,\\downarrow\\}} \\left( \\hat{c}_{1\\sigma}^{\\dagger} \\hat{c}_{2\\sigma} + \\hat{c}_{2\\sigma}^{\\dagger} \\hat{c}_{1\\sigma} \\right) \\;+\\; U \\sum_{i=1}^{2} \\hat{n}_{i\\uparrow} \\hat{n}_{i\\downarrow},\n$$\n其中，跃迁振幅 $t0$，在位排斥 $U\\ge 0$，且 $\\hat{n}_{i\\sigma}=\\hat{c}_{i\\sigma}^{\\dagger}\\hat{c}_{i\\sigma}$。研究半填充情况，即粒子数 $N=2$，且两位点之间无外部势不对称性。使用以下基本定义。\n\n- 固定粒子数 $N$ 下的基态能量为 $E(N)$。\n- 电离能为 $I \\equiv E(N-1)-E(N)$。\n- 电子亲和能为 $A \\equiv E(N)-E(N+1)$。\n- 基本带隙为 $E_{\\mathrm{g}} \\equiv I - A = E(N+1) + E(N-1) - 2 E(N)$。\n- Kohn–Sham (KS) 带隙是指能够再现精确基态位点占据数的非相互作用 KS 系统的最低未占据和最高占据 KS 单粒子本征值之差。\n\n任务：\n1) 对于对称二聚体，从哈密顿量导出 $E(1)$ 和 $E(2)$。对于此二分模型，根据粒子-空穴对称性，论证 $E(3)$ 和 $E(1)$ 之间的关系。结合这些结果，得到半填充情况下以 $t$ 和 $U$ 表示的 $E_{\\mathrm{g}}$ 的解析表达式。\n2) 仅根据 KS 系统需再现对称二聚体在半填充时的精确位点占据数这一要求，论证 KS 势不对称性必须为何值。确定 KS 轨道能量，并推导出以 $t$ 表示的 KS 带隙 $E_{\\mathrm{g}}^{\\mathrm{KS}}$。\n3) 将交换关联导数不连续性定义为 $\\Delta_{\\mathrm{xc}} \\equiv E_{\\mathrm{g}} - E_{\\mathrm{g}}^{\\mathrm{KS}}$。对于参数 $t = 1.25\\,\\text{eV}$ 和 $U = 6.00\\,\\text{eV}$，数值计算 $\\Delta_{\\mathrm{xc}}$。\n\n将最终答案四舍五入至四位有效数字。以 $\\text{eV}$ 为单位表示最终答案。仅提供 $\\Delta_{\\mathrm{xc}}$ 的数值作为最终答案。", "solution": "所述问题是有效的：它在科学上基于量子力学和密度泛函理论的原理，问题陈述清晰，客观且内部一致。我们将给出完整解法。\n\n问题要求计算对称双位点 Hubbard 二聚体在半填充（$N=2$ 个粒子）情况下的交换关联（xc）导数不连续性 $\\Delta_{\\mathrm{xc}}$。我们将按顺序完成各项任务。\n\n**1. 基本带隙 $E_{\\mathrm{g}}$ 的推导**\n\n基本带隙定义为 $E_{\\mathrm{g}} = E(N+1) + E(N-1) - 2E(N)$。对于我们半填充的情况，$N=2$，即为 $E_{\\mathrm{g}} = E(3) + E(1) - 2E(2)$。\n\n**$N=1$ 时的基态能量 $E(1)$：**\n对于单个粒子，在位相互作用项 $U \\sum_{i} \\hat{n}_{i\\uparrow} \\hat{n}_{i\\downarrow}$ 为零。哈密顿量简化为跃迁项。单个粒子（给定自旋为 $\\sigma$）的基态为 $|\\psi_1\\rangle = \\hat{c}_{1\\sigma}^{\\dagger}|0\\rangle$ 和 $|\\psi_2\\rangle = \\hat{c}_{2\\sigma}^{\\dagger}|0\\rangle$。在此基下，哈密顿量表示为矩阵：\n$$\nH^{(1)} = \\begin{pmatrix} 0  -t \\\\ -t  0 \\end{pmatrix}\n$$\n通过求解特征方程 $\\lambda^2 - t^2 = 0$ 找到本征值，得到 $\\lambda = \\pm t$。基态能量为较低的那个本征值。\n$$\nE(1) = -t\n$$\n这对应于粒子占据成键分子轨道。\n\n**$N=2$ 时的基态能量 $E(2)$：**\n对于两个粒子（半填充），我们求解单重态基态。使用分子轨道基最为高效。单粒子成键和反键产生算符分别为 $\\hat{b}_{\\sigma}^{\\dagger} = \\frac{1}{\\sqrt{2}}(\\hat{c}_{1\\sigma}^{\\dagger} + \\hat{c}_{2\\sigma}^{\\dagger})$ 和 $\\hat{a}_{\\sigma}^{\\dagger} = \\frac{1}{\\sqrt{2}}(\\hat{c}_{1\\sigma}^{\\dagger} - \\hat{c}_{2\\sigma}^{\\dagger})$，对应能量为 $-t$ 和 $+t$。在此基下重写哈密顿量。跃迁部分是对角的：$\\hat{H}_{\\mathrm{hop}} = \\sum_{\\sigma} (-t \\hat{n}_{b\\sigma} + t \\hat{n}_{a\\sigma})$。相互作用部分 $\\hat{H}_{U} = U \\sum_{i=1}^{2} \\hat{n}_{i\\uparrow} \\hat{n}_{i\\downarrow}$ 会混合不同的构型。\n单重态基态是两个电子都在成键轨道的状态 $|\\Psi_{bb}\\rangle = \\hat{b}_{\\uparrow}^{\\dagger} \\hat{b}_{\\downarrow}^{\\dagger} |0\\rangle$ 和两个电子都在反键轨道的状态 $|\\Psi_{aa}\\rangle = \\hat{a}_{\\uparrow}^{\\dagger} \\hat{a}_{\\downarrow}^{\\dagger} |0\\rangle$ 的叠加。这些态具有相同的对称性。\n对角矩阵元为：\n$$\n\\langle \\Psi_{bb} | \\hat{H} | \\Psi_{bb} \\rangle = -2t + \\langle \\Psi_{bb} | \\hat{H}_U | \\Psi_{bb} \\rangle = -2t + \\frac{U}{2}\n$$\n$$\n\\langle \\Psi_{aa} | \\hat{H} | \\Psi_{aa} \\rangle = 2t + \\langle \\Psi_{aa} | \\hat{H}_U | \\Psi_{aa} \\rangle = 2t + \\frac{U}{2}\n$$\n耦合这些态的非对角元为：\n$$\n\\langle \\Psi_{bb} | \\hat{H} | \\Psi_{aa} \\rangle = \\langle \\Psi_{bb} | \\hat{H}_U | \\Psi_{aa} \\rangle = \\frac{U}{2}\n$$\n在基 $\\{|\\Psi_{bb}\\rangle, |\\Psi_{aa}\\rangle\\}$ 下的哈密顿量为：\n$$\nH^{(2)} = \\begin{pmatrix} -2t + U/2  U/2 \\\\ U/2  2t + U/2 \\end{pmatrix}\n$$\n本征值 $\\lambda$ 可由方程 $(\\lambda - (U/2))^2 - (2t)^2 - (U/2)^2 = 0$ 解出，该方程可简化为 $\\lambda^2 - U\\lambda - 4t^2 = 0$。解为 $\\lambda = \\frac{1}{2}(U \\pm \\sqrt{U^2 + 16t^2})$。基态能量为较低的那个本征值：\n$$\nE(2) = \\frac{U}{2} - \\frac{1}{2}\\sqrt{U^2 + 16t^2}\n$$\n\n**$N=3$ 时的基态能量 $E(3)$：**\n二分晶格上的 Hubbard 模型具有粒子-空穴对称性。对于一个有 $M$ 个位点的系统，此对称性将 $N$ 个粒子的能谱与 $2M-N$ 个粒子的能谱联系起来。这里，$M=2$ 个位点，所以 $N=3$ 和 $N=2(2)-3=1$ 的能谱之间存在关系。一个形式化的粒子-空穴变换 $\\hat{c}_{i\\sigma} \\to (-1)^i \\hat{c}_{i\\sigma}^\\dagger$（将位点 1 视为偶数位点，位点 2 视为奇数位点）将哈密顿量 $\\hat{H}$ 映射为 $\\hat{H}' = \\hat{H} + U(N-M) = \\hat{H} + U(\\hat{N}-2)$。这意味着能量本征值 $E(N)$ 和 $E(2M-N)$ 之间存在关系。对于一个给定的本征态，$E = E' + U(N-2)$，其中 $E'$ 是变换后的（空穴）哈密顿量中对应态的能量，而变换后的哈密顿量与原始哈密顿量相同。这导致了关系式 $E(N) = E(2M-N) + U(N-M)$。对于我们的系统，$M=2$ 且 $N=3$，这给出：\n$$\nE(3) = E(4-3) + U(3-2) = E(1) + U\n$$\n使用 $E(1) = -t$，我们得到：\n$$\nE(3) = U - t\n$$\n\n**$E_{\\mathrm{g}}$ 的计算：**\n将 $E(1)$、$E(2)$ 和 $E(3)$ 的表达式代入基本带隙的公式中：\n$$\nE_{\\mathrm{g}} = E(3) + E(1) - 2E(2) = (U-t) + (-t) - 2\\left(\\frac{U}{2} - \\frac{1}{2}\\sqrt{U^2 + 16t^2}\\right)\n$$\n$$\nE_{\\mathrm{g}} = U - 2t - U + \\sqrt{U^2 + 16t^2}\n$$\n$$\nE_{\\mathrm{g}} = \\sqrt{U^2 + 16t^2} - 2t\n$$\n\n**2. Kohn–Sham 带隙 $E_{\\mathrm{g}}^{\\mathrm{KS}}$ 的推导**\n\nKohn-Sham (KS) 系统是一个非相互作用系统，其设计目的是再现相互作用系统的精确基态密度（此处为位点占据数）。\n对于对称的 Hubbard 二聚体，哈密顿量在位点指标交换 $1 \\leftrightarrow 2$ 下是不变的。因此，基态波函数必须具有明确的对称性，从而导致对称的位点占据数：$\\langle \\hat{n}_1 \\rangle = \\langle \\hat{n}_2 \\rangle$。由于总粒子数为 $N=2$，我们有 $\\langle \\hat{n}_1 \\rangle + \\langle \\hat{n}_2 \\rangle = 2$。因此，精确的位点占据数为：\n$$\n\\langle \\hat{n}_1 \\rangle = \\langle \\hat{n}_2 \\rangle = 1\n$$\n该二聚体的一般非相互作用 KS 哈密顿量为 $\\hat{H}_{\\mathrm{KS}} = -t \\sum_{\\sigma} (\\hat{c}_{1\\sigma}^{\\dagger} \\hat{c}_{2\\sigma} + \\text{h.c.}) + v_1 \\hat{n}_1 + v_2 \\hat{n}_2$。该系统的基态是通过将两个电子放入能量最低的单粒子轨道 $|\\phi_{\\mathrm{HOMO}}\\rangle = c_1|1\\rangle + c_2|2\\rangle$ 形成的。位点占据数为 $n_i^{\\mathrm{KS}} = 2|c_i|^2$。为了匹配精确的占据数，我们需要 $2|c_1|^2 = 1$ 和 $2|c_2|^2 = 1$，这意味着 $|c_1|^2 = |c_2|^2 = 1/2$。单粒子 KS 哈密顿矩阵 $H_{\\mathrm{KS}}^{(1)} = \\begin{pmatrix} v_1  -t \\\\ -t  v_2 \\end{pmatrix}$ 的最低能量本征态的系数大小必须相等。这只有在势是对称的情况下才可能，即 $v_1 = v_2$。势不对称性必须为零。任何常数偏移都可以设为零，因此我们取 $v_1 = v_2 = 0$。\n因此，KS 哈密顿量与简单的跃迁哈密顿量相同：\n$$\n\\hat{H}_{\\mathrm{KS}} = -t \\sum_{\\sigma} (\\hat{c}_{1\\sigma}^{\\dagger} \\hat{c}_{2\\sigma} + \\hat{c}_{2\\sigma}^{\\dagger} \\hat{c}_{1\\sigma})\n$$\nKS 单粒子轨道能量是第一部分中矩阵 $H^{(1)}$ 的本征值，即 $\\epsilon = \\pm t$。最高占据分子轨道（HOMO）的能量为 $\\epsilon_{\\mathrm{HOMO}}=-t$，最低未占据分子轨道（LUMO）的能量为 $\\epsilon_{\\mathrm{LUMO}}=+t$。\nKS 带隙是这些能量之差：\n$$\nE_{\\mathrm{g}}^{\\mathrm{KS}} = \\epsilon_{\\mathrm{LUMO}} - \\epsilon_{\\mathrm{HOMO}} = t - (-t) = 2t\n$$\n\n**3. 导数不连续性 $\\Delta_{\\mathrm{xc}}$ 的计算**\n\n交换关联导数不连续性定义为真实基本带隙与 KS 带隙之差：\n$$\n\\Delta_{\\mathrm{xc}} = E_{\\mathrm{g}} - E_{\\mathrm{g}}^{\\mathrm{KS}}\n$$\n代入我们推导出的表达式：\n$$\n\\Delta_{\\mathrm{xc}} = (\\sqrt{U^2 + 16t^2} - 2t) - (2t) = \\sqrt{U^2 + 16t^2} - 4t\n$$\n给定参数 $t = 1.25\\,\\text{eV}$ 和 $U = 6.00\\,\\text{eV}$。我们代入这些值：\n$$\n\\Delta_{\\mathrm{xc}} = \\sqrt{(6.00)^2 + 16(1.25)^2} - 4(1.25)\n$$\n$$\n\\Delta_{\\mathrm{xc}} = \\sqrt{36.00 + 16(1.5625)} - 5.00\n$$\n$$\n\\Delta_{\\mathrm{xc}} = \\sqrt{36.00 + 25.00} - 5.00\n$$\n$$\n\\Delta_{\\mathrm{xc}} = \\sqrt{61.00} - 5.00\n$$\n$$\n\\Delta_{\\mathrm{xc}} \\approx 7.8102496... - 5.00 = 2.8102496... \\, \\text{eV}\n$$\n四舍五入到四位有效数字，结果为 $2.810\\,\\text{eV}$。", "answer": "$$\\boxed{2.810}$$", "id": "2480406"}]}