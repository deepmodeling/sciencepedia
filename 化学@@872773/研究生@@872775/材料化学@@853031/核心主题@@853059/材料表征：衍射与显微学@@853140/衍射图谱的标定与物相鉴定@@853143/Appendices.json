{"hands_on_practices": [{"introduction": "我们从最基本的技能开始：手动标定一个简单的粉末衍射图谱。这项练习将强化布拉格定律、晶格几何关系与观测到的衍射峰位之间的联系，是掌握更复杂结构分析或自动化方法前必不可少的第一步。通过该练习 [@problem_id:2492901]，您将学会如何从原始的 $2\\theta$ 数据中推断出晶格类型和晶格常数。", "problem": "一个多晶样品使用波长为 $\\lambda = 1.5406$ Å 的铜 $\\text{K}\\alpha$ 辐射进行粉末X射线衍射（XRD）测量。在以下散射角处观察到四个衍射峰：$2\\theta = 44.54^{\\circ}$，$64.67^{\\circ}$，$82.00^{\\circ}$ 和 $98.60^{\\circ}$。角度以度为单位。\n\n仅从布拉格定律和立方晶体中晶面间距与晶格参数的几何关系出发，完成以下任务：\n- 假设为一级衍射（即 $n=1$），计算与每个测量的 $2\\theta_i$ 相对应的晶面间距 $d_i$。\n- 根据所得 $d$ 间距的规律，判断简单立方或体心立方标定是否与数据一致，并相应地为这四个峰指定米勒指数 $\\{hkl\\}$。\n- 根据你的标定，从每条谱线计算立方晶格参数 $a$ 的值，并以四条谱线计算值的算术平均值作为 $a$ 的最佳估计值报告。\n\n在你的推导过程中，从第一性原理出发，解释为什么在 $n\\lambda = 2 d \\sin\\theta$ 中允许 $n>1$ 的级数会导致粉末衍射中的错误标定，以及标准标定约定是如何避免这个问题的。\n\n将你最终报告的晶格参数四舍五入到四位有效数字。以埃（Å）为单位表示最终的晶格参数。最终答案必须是一个实数。", "solution": "该问题具有科学合理性，陈述清晰且客观。它要求进行三部分的计算和一项理论解释。首先，计算观测到的四个衍射峰的晶面间距 $d_i$。其次，通过标定图谱来确定晶体结构是简单立方（P）还是体心立方（BCC）。第三，根据标定结果计算晶格常数 $a$。最后，要求从第一性原理出发解释关于衍射级数 $n$ 的标定约定。\n\n**步骤1：计算晶面间距 $d_i$**\n\n布拉格定律描述了X射线在晶面上发生相长干涉的条件：\n$$n\\lambda = 2d\\sin\\theta$$\n其中，$n$ 是衍射级数（整数），$\\lambda$ 是入射X射线的波长，$d$ 是晶面间距，$\\theta$ 是衍射角。\n问题假设为一级衍射，因此 $n=1$。给定波长 $\\lambda = 1.5406$ Å。该定律简化为 $\\lambda = 2d\\sin\\theta$。我们可以解出晶面间距 $d$：\n$$d = \\frac{\\lambda}{2\\sin\\theta}$$\n实验数据以 $2\\theta$ 值的形式给出。我们必须首先为每个峰找到 $\\theta$。\n\n峰 1: $2\\theta_1 = 44.54^{\\circ} \\implies \\theta_1 = 22.27^{\\circ}$\n$$d_1 = \\frac{1.5406}{2\\sin(22.27^{\\circ})} \\approx 2.0324 \\text{ Å}$$\n\n峰 2: $2\\theta_2 = 64.67^{\\circ} \\implies \\theta_2 = 32.335^{\\circ}$\n$$d_2 = \\frac{1.5406}{2\\sin(32.335^{\\circ})} \\approx 1.4400 \\text{ Å}$$\n\n峰 3: $2\\theta_3 = 82.00^{\\circ} \\implies \\theta_3 = 41.00^{\\circ}$\n$$d_3 = \\frac{1.5406}{2\\sin(41.00^{\\circ})} \\approx 1.1741 \\text{ Å}$$\n\n峰 4: $2\\theta_4 = 98.60^{\\circ} \\implies \\theta_4 = 49.30^{\\circ}$\n$$d_4 = \\frac{1.5406}{2\\sin(49.30^{\\circ})} \\approx 1.0161 \\text{ Å}$$\n\n**步骤2：标定与结构确定**\n\n对于立方晶系，一组密勒指数为 $\\{hkl\\}$ 的晶面的晶面间距 $d_{hkl}$ 与晶格常数 $a$ 的关系如下：\n$$d_{hkl} = \\frac{a}{\\sqrt{h^2+k^2+l^2}}$$\n将其与布拉格定律（$n=1$）结合：\n$$\\frac{\\lambda}{2\\sin\\theta_{hkl}} = \\frac{a}{\\sqrt{h^2+k^2+l^2}}$$\n两边平方并重新整理，得到 $\\sin^2\\theta$ 与指数平方和之间的线性关系：\n$$\\sin^2\\theta_{hkl} = \\frac{\\lambda^2}{4a^2}(h^2+k^2+l^2)$$\n由于对于特定晶体的给定实验，$\\frac{\\lambda^2}{4a^2}$ 是一个常数，因此观测到的峰的 $\\sin^2\\theta_i$ 值必须与 $S_i = h_i^2+k_i^2+l_i^2$ 的值成正比，而后者是整数。\n或者，我们可以分析 $1/d_i^2$ 的比值：\n$$\\frac{1}{d_i^2} = \\frac{1}{a^2}(h_i^2+k_i^2+l_i^2)$$\n我们计算这四个峰的 $1/d_i^2$ 值：\n$1/d_1^2 \\approx 1/(2.0324)^2 \\approx 0.2421 \\text{ Å}^{-2}$\n$1/d_2^2 \\approx 1/(1.4400)^2 \\approx 0.4823 \\text{ Å}^{-2}$\n$1/d_3^2 \\approx 1/(1.1741)^2 \\approx 0.7251 \\text{ Å}^{-2}$\n$1/d_4^2 \\approx 1/(1.0161)^2 \\approx 0.9680 \\text{ Å}^{-2}$\n\n为了找到整数关系，我们将每个值除以最小值 $0.2421$：\n比值 1: $0.2421 / 0.2421 = 1.000$\n比值 2: $0.4823 / 0.2421 \\approx 1.992 \\approx 2$\n比值 3: $0.7251 / 0.2421 \\approx 2.995 \\approx 3$\n比值 4: $0.9680 / 0.2421 \\approx 3.998 \\approx 4$\n这四个峰的 $(h^2+k^2+l^2)$ 量的比值为 $1:2:3:4$。\n\n现在我们必须将这个序列与简单立方（P）和体心立方（BCC）晶格的允许衍射进行比较。\n- 对于**P-立方**（简单立方）晶格，所有 $\\{hkl\\}$ 衍射都是允许的。$S=h^2+k^2+l^2$ 的可能值为 $1, 2, 3, 4, 5, 6, 8, ...$（注意 $S=7$ 不能由三个整数的平方和构成）。其衍射峰的 $S$ 值比值序列应为 $1:2:3:4:5:6:8$。我们观测到的比值 $1:2:3:4$ 与此序列的开头部分一致。\n- 对于**BCC**晶格，只有当 $h+k+l$ 的和为偶数时，衍射才被允许。$S=h^2+k^2+l^2$ 的允许值为：\n  - $\\{110\\}: S = 1^2+1^2+0^2 = 2$\n  - $\\{200\\}: S = 2^2+0^2+0^2 = 4$\n  - $\\{211\\}: S = 2^2+1^2+1^2 = 6$\n  - $\\{220\\}: S = 2^2+2^2+0^2 = 8$\n  允许的 $S$ 值序列为 $2, 4, 6, 8, 10, ...$。这些值的比值为 $1:2:3:4:5...$。我们观测到的比值 $1:2:3:4$ 也与此序列的开头部分一致。\n\n实验数据在数学上与两种假设都相符。然而，这是一个物理科学问题，而非纯数学问题。简单立方晶体结构在元素中极为罕见，在标准条件下，只有钋是已知的例子。另一方面，体心立方结构非常普遍（例如，Fe、Cr、Mo、W）。根据BCC假设计算出的晶格常数（$a \\approx 2.87$ Å）是许多常见金属的特征，例如$\\alpha$-铁（$a=2.8665$ Å）。而P-立方假设得出的晶格常数要小得多（$a \\approx 2.03$ Å），对于金属元素来说，这在物理上不太合理。因此，基于物理和化学推理，BCC标定是正确的选择。\n\n密勒指数 $\\{hkl\\}$ 根据序列 $S = 2, 4, 6, 8$ 来指定：\n- 峰 1 ($S=2$): $\\{110\\}$\n- 峰 2 ($S=4$): $\\{200\\}$\n- 峰 3 ($S=6$): $\\{211\\}$\n- 峰 4 ($S=8$): $\\{220\\}$\n\n**步骤3：计算晶格常数 $a$**\n\n我们使用公式 $a_i = d_i \\sqrt{h_i^2+k_i^2+l_i^2}$ 从每条衍射谱线计算晶格常数 $a_i$。使用更精确的 $d_i$ 值：\n$a_1 = d_1 \\sqrt{2} = 2.03236 \\times \\sqrt{2} \\approx 2.8742$ Å\n$a_2 = d_2 \\sqrt{4} = 1.43999 \\times 2 \\approx 2.8800$ Å\n$a_3 = d_3 \\sqrt{6} = 1.17414 \\times \\sqrt{6} \\approx 2.8761$ Å\n$a_4 = d_4 \\sqrt{8} = 1.01605 \\times \\sqrt{8} \\approx 2.8738$ Å\n\n$a$ 的最佳估计值是这四个值的算术平均值：\n$$\\bar{a} = \\frac{a_1+a_2+a_3+a_4}{4} = \\frac{2.8742 + 2.8800 + 2.8761 + 2.8738}{4} = \\frac{11.5041}{4} \\approx 2.876025 \\text{ Å}$$\n按要求四舍五入到四位有效数字，晶格常数为 $a = 2.876$ Å。\n\n**关于$n$在布拉格定律和标定中作用的解释**\n\n布拉格定律是 $n\\lambda = 2d_{hkl}\\sin\\theta$。一个衍射峰可以由晶面族的密勒指数 $\\{hkl\\}$ 和衍射的整数级数 $n$ 的组合来描述。对于立方晶体，代入 $d_{hkl} = a/\\sqrt{h^2+k^2+l^2}$ 得到：\n$$n\\lambda = 2 \\frac{a}{\\sqrt{h^2+k^2+l^2}} \\sin\\theta$$\n这可以改写为：\n$$\\lambda = 2 \\left( \\frac{a}{n\\sqrt{h^2+k^2+l^2}} \\right) \\sin\\theta$$\n让我们定义一组新的密勒指数 $\\{h'k'l'\\} = \\{nh, nk, nl\\}$。这些假想晶面的晶面间距将是：\n$$d_{h'k'l'} = d_{nh,nk,nl} = \\frac{a}{\\sqrt{(nh)^2+(nk)^2+(nl)^2}} = \\frac{a}{n\\sqrt{h^2+k^2+l^2}} = \\frac{d_{hkl}}{n}$$\n将此代入改写后的布拉格定律，得到：\n$$\\lambda = 2 d_{h'k'l'} \\sin\\theta$$\n这个方程在数学上等同于来自一组密勒指数为 $\\{h'k'l'\\} = \\{nh, nk, nl\\}$ 的晶面的一级（$n=1$）衍射。\n\n这意味着来自 $\\{hkl\\}$ 晶面的 $n$ 级衍射在实验上与来自 $\\{nh, nk, nl\\}$ 晶面的一级衍射是无法区分的，因为两者都出现在相同的散射角 $\\theta$ 处。例如，来自 $(100)$ 晶面的二级衍射（$n=2, \\{hkl\\}=\\{100\\}$）与来自 $(200)$ 晶面的一级衍射（$n=1, \\{hkl\\}=\\{200\\}$）出现在完全相同的位置。\n\n如果在标定过程中允许 $n>1$ 作为一个独立变量，那么在角度 $\\theta$ 处的任何给定衍射峰都可以被赋予无限多种可能的 $(n, \\{hkl\\})$ 组合，导致问题变得完全模糊和不适定。为了解决这个问题，标准的晶体学惯例是*始终*假设为一级衍射（$n=1$）。分配给一个峰的密勒指数 $\\{hkl\\}$ 因而被理解为集合 $\\{nh_0, nk_0, nl_0\\}$，其中 $\\{h_0k_0l_0\\}$ 是基本指数（代表晶面方向的最简整数），而 $n$ 是衍射级数，它已被吸收到指数中。这个惯例使得标定过程唯一且系统化。", "answer": "$$\\boxed{2.876}$$", "id": "2492901"}, {"introduction": "仅仅标定出衍射峰的位置，只能告诉我们峰 *应该* 出现在哪里，但无法解释为何它们的强度各不相同。此练习 [@problem_id:2492870] 深入探讨了晶体结构因子，它决定了衍射峰的强度。理解结构因子对于区分具有相似峰位的不同晶体结构至关重要，是连接衍射指标定与完整物相分析的关键桥梁。", "problem": "一种未知的二元化合物结晶为面心立方布拉菲晶格，其常规立方晶胞中包含一个由A和B两种原子组成的双原子基元，分数坐标分别为 $\\left(0,0,0\\right)$ 和 $\\left(\\frac{1}{2},\\frac{1}{2},\\frac{1}{2}\\right)$。给定在X射线粉末衍射（XRD）所关注的低角度范围内，原子散射因子（形状因子）近似为常数，以经典电子散射强度为单位，其值分别为 $f_{\\mathrm{A}}=18.0$ 和 $f_{\\mathrm{B}}=6.0$。忽略热运动、吸收、消光、洛伦兹-偏振效应以及任何波长色散。假设定性粉末衍射强度与反射多重度和结构因子模的平方的乘积成正比，即 $I_{hkl}\\propto m_{hkl}\\,|F_{hkl}|^{2}$，其中立方晶体的多重度为 $m_{111}=8$、$m_{200}=6$ 和 $m_{220}=12$。\n\n仅从晶体结构因子 $F_{hkl}=\\sum_{j} f_{j}\\exp\\!\\left(2\\pi i\\left(hx_{j}+ky_{j}+lz_{j}\\right)\\right)$ 的定义以及面心立方晶格中倒易晶格平面的米勒指数定义出发，完成以下任务：\n\n1) 推导该结构中 $F_{hkl}$ 的一般形式，明确说明面心立方晶格的中心特性和双原子基元如何结合产生选择定则和一个依赖于奇偶性的干涉因子。清晰地陈述 $\\left(h,k,l\\right)$ 产生非零反射的条件。\n\n2) 使用你的结果，以 $f_{\\mathrm{A}}$ 和 $f_{\\mathrm{B}}$ 的形式符号化地计算最低指数的允许晶面族 $\\left(111\\right)$、$\\left(200\\right)$ 和 $\\left(220\\right)$ 的 $|F_{hkl}|^{2}$，然后使用 $f_{\\mathrm{A}}=18.0$ 和 $f_{\\mathrm{B}}=6.0$ 进行数值计算。\n\n3) 使用 $I_{hkl}\\propto m_{hkl}\\,|F_{hkl}|^{2}$，预测 $\\left(111\\right)$、$\\left(200\\right)$ 和 $\\left(220\\right)$ 之间的强度定性排序，这将有助于通过低角度粉末XRD扫描进行物相鉴定。\n\n4) 最后，在所述假设下计算强度比 $I_{200}/I_{111}$。将你的答案四舍五入至三位有效数字。将最终比值表示为无量纲数。", "solution": "该问题具有科学合理性，内容自洽，提法明确。获得唯一解所需的所有数据和条件均已提供。该问题是应用晶体学原理进行X射线衍射分析的一个标准练习。因此，我们将开始解答。\n\n该结构是一个面心立方（FCC）布拉菲晶格。一个常规晶胞包含四个格点，其分数坐标为 $(0,0,0)$、$(\\frac{1}{2},\\frac{1}{2},0)$、$(\\frac{1}{2},0,\\frac{1}{2})$ 和 $(0,\\frac{1}{2},\\frac{1}{2})$。该结构由一个双原子基元填充，其中A原子位于每个格点的 $(0,0,0)$ 位置，B原子位于相对于每个格点的 $(\\frac{1}{2},\\frac{1}{2},\\frac{1}{2})$ 位置。这对应于岩盐（NaCl）结构类型。因此，常规立方晶胞中所有原子的位置如下：\n- 4个A原子位于FCC格点上：$(0,0,0)$、$(\\frac{1}{2},\\frac{1}{2},0)$、$(\\frac{1}{2},0,\\frac{1}{2})$、$(0,\\frac{1}{2},\\frac{1}{2})$。\n- 4个B原子位于从FCC格点平移 $(\\frac{1}{2},\\frac{1}{2},\\frac{1}{2})$ 的位置。这些位置是 $(\\frac{1}{2},\\frac{1}{2},\\frac{1}{2})$、$(1,1,\\frac{1}{2})\\equiv(0,0,\\frac{1}{2})$、$(1,\\frac{1}{2},1)\\equiv(0,\\frac{1}{2},0)$ 和 $(\\frac{1}{2},1,1)\\equiv(\\frac{1}{2},0,0)$。\n\n晶体结构因子 $F_{hkl}$ 定义为对常规晶胞中所有 $N$ 个原子的求和：\n$$\nF_{hkl} = \\sum_{j=1}^{N} f_{j}\\exp\\!\\left(2\\pi i\\left(hx_{j}+ky_{j}+lz_{j}\\right)\\right)\n$$\n我们可以将求和分解为A原子和B原子的贡献。设FCC格点集合为 $\\mathbf{r}_{FCC}$。A原子的位置为 $\\mathbf{r}_{A,j} = \\mathbf{r}_{FCC,j}$，B原子的位置为 $\\mathbf{r}_{B,j} = \\mathbf{r}_{FCC,j} + (\\frac{1}{2},\\frac{1}{2},\\frac{1}{2})$。\n\\begin{align*}\nF_{hkl} &= \\sum_{j=1}^{4} f_{\\mathrm{A}}\\exp\\!\\left(2\\pi i\\left(hx_{A,j}+ky_{A,j}+lz_{A,j}\\right)\\right) + \\sum_{j=1}^{4} f_{\\mathrm{B}}\\exp\\!\\left(2\\pi i\\left(hx_{B,j}+ky_{B,j}+lz_{B,j}\\right)\\right) \\\\\n&= \\sum_{\\mathbf{r} \\in \\mathbf{r}_{FCC}} f_{\\mathrm{A}}\\exp\\!\\left(2\\pi i (h,k,l)\\cdot\\mathbf{r}\\right) + \\sum_{\\mathbf{r} \\in \\mathbf{r}_{FCC}} f_{\\mathrm{B}}\\exp\\!\\left(2\\pi i (h,k,l)\\cdot(\\mathbf{r}+(\\frac{1}{2},\\frac{1}{2},\\frac{1}{2}))\\right) \\\\\n&= \\sum_{\\mathbf{r} \\in \\mathbf{r}_{FCC}} \\exp\\!\\left(2\\pi i (h,k,l)\\cdot\\mathbf{r}\\right) \\left[ f_{\\mathrm{A}} + f_{\\mathrm{B}}\\exp\\!\\left(2\\pi i (h,k,l)\\cdot(\\frac{1}{2},\\frac{1}{2},\\frac{1}{2})\\right) \\right] \\\\\n&= \\left[1 + \\exp\\!\\left(\\pi i(h+k)\\right) + \\exp\\!\\left(\\pi i(h+l)\\right) + \\exp\\!\\left(\\pi i(k+l)\\right)\\right] \\times \\left[ f_{\\mathrm{A}} + f_{\\mathrm{B}}\\exp\\!\\left(\\pi i(h+k+l)\\right) \\right]\n\\end{align*}\n该表达式是FCC晶格因子和基元结构因子的乘积。\n\n1) 第一项，即晶格因子，决定了FCC晶格的系统消光。仅当密勒指数 $(h,k,l)$ 全为偶数或全为奇数（奇偶性一致）时，该项才非零。在这些情况下，$h+k$、$h+l$ 和 $k+l$ 的和均为偶数，导致每个指数项都为 $1$，晶格因子计算结果为 $1+1+1+1=4$。如果指数的奇偶性混合，则晶格因子为 $0$。因此，非零反射的选择定则是 $(h,k,l)$ 的奇偶性必须一致。\n\n第二项取决于和 $h+k+l$。\n- 如果 $h,k,l$ 均为偶数，它们的和 $h+k+l$ 也为偶数。此时 $\\exp(\\pi i(h+k+l)) = 1$。\n- 如果 $h,k,l$ 均为奇数，它们的和 $h+k+l$ 为奇数。此时 $\\exp(\\pi i(h+k+l)) = -1$。\n\n综合这些结果，我们得到 $F_{hkl}$ 的一般形式：\n$$\nF_{hkl} = \n\\begin{cases} \n4(f_{\\mathrm{A}} + f_{\\mathrm{B}}) & \\text{如果 } h,k,l \\text{ 均为偶数} \\\\\n4(f_{\\mathrm{A}} - f_{\\mathrm{B}}) & \\text{如果 } h,k,l \\text{ 均为奇数} \\\\\n0 & \\text{如果 } h,k,l \\text{ 的奇偶性混合}\n\\end{cases}\n$$\n$(h,k,l)$ 产生非零反射的条件是指数的奇偶性必须一致。来自基元的干涉因子 $f_{\\mathrm{A}} \\pm f_{\\mathrm{B}}$ 由指数和的奇偶性决定，它决定了A和B子晶格之间的干涉是相长干涉还是相消干涉。\n\n2) 现在我们使用符号表达式和数值 $f_{\\mathrm{A}}=18.0$ 和 $f_{\\mathrm{B}}=6.0$ 计算给定反射的 $|F_{hkl}|^2$。\n- 对于 $(111)$ 晶面族：指数均为奇数。\n$$ |F_{111}|^2 = |4(f_{\\mathrm{A}} - f_{\\mathrm{B}})|^2 = 16(f_{\\mathrm{A}} - f_{\\mathrm{B}})^2 $$\n数值计算：\n$$ |F_{111}|^2 = 16(18.0 - 6.0)^2 = 16(12.0)^2 = 16 \\times 144 = 2304 $$\n- 对于 $(200)$ 晶面族：指数均为偶数。\n$$ |F_{200}|^2 = |4(f_{\\mathrm{A}} + f_{\\mathrm{B}})|^2 = 16(f_{\\mathrm{A}} + f_{\\mathrm{B}})^2 $$\n数值计算：\n$$ |F_{200}|^2 = 16(18.0 + 6.0)^2 = 16(24.0)^2 = 16 \\times 576 = 9216 $$\n- 对于 $(220)$ 晶面族：指数均为偶数。\n$$ |F_{220}|^2 = |4(f_{\\mathrm{A}} + f_{\\mathrm{B}})|^2 = 16(f_{\\mathrm{A}} + f_{\\mathrm{B}})^2 $$\n数值计算：\n$$ |F_{220}|^2 = 16(18.0 + 6.0)^2 = 16(24.0)^2 = 16 \\times 576 = 9216 $$\n\n3) 为了预测定性强度排序，我们使用关系式 $I_{hkl} \\propto m_{hkl} |F_{hkl}|^2$ 以及给定的多重度 $m_{111}=8$、$m_{200}=6$ 和 $m_{220}=12$。\n- 对于 $(111)$: $I_{111} \\propto m_{111} |F_{111}|^2 = 8 \\times 2304 = 18432$。\n- 对于 $(200)$: $I_{200} \\propto m_{200} |F_{200}|^2 = 6 \\times 9216 = 55296$。\n- 对于 $(220)$: $I_{220} \\propto m_{220} |F_{220}|^2 = 12 \\times 9216 = 110592$。\n比较这些值，$18432  55296  110592$。因此，强度排序为 $I_{111}  I_{200}  I_{220}$。\n\n4) 最后，我们计算强度比 $I_{200}/I_{111}$。比例常数被消掉。\n$$ \\frac{I_{200}}{I_{111}} = \\frac{m_{200} |F_{200}|^2}{m_{111} |F_{111}|^2} $$\n代入符号形式：\n$$ \\frac{I_{200}}{I_{111}} = \\frac{m_{200} \\cdot 16(f_{\\mathrm{A}} + f_{\\mathrm{B}})^2}{m_{111} \\cdot 16(f_{\\mathrm{A}} - f_{\\mathrm{B}})^2} = \\frac{m_{200}}{m_{111}} \\left(\\frac{f_{\\mathrm{A}} + f_{\\mathrm{B}}}{f_{\\mathrm{A}} - f_{\\mathrm{B}}}\\right)^2 $$\n代入给定的数值：\n$$ \\frac{I_{200}}{I_{111}} = \\frac{6}{8} \\left(\\frac{18.0 + 6.0}{18.0 - 6.0}\\right)^2 = \\frac{3}{4} \\left(\\frac{24.0}{12.0}\\right)^2 = \\frac{3}{4} (2)^2 = \\frac{3}{4} \\times 4 = 3 $$\n或者，使用计算出的比例强度：\n$$ \\frac{I_{200}}{I_{111}} = \\frac{55296}{18432} = 3 $$\n问题要求答案保留三位有效数字。精确结果是 $3$。写作 $3.00$。", "answer": "$$\n\\boxed{3.00}\n$$", "id": "2492870"}, {"introduction": "此练习旨在弥合手动方法与真实世界中复杂、模糊的衍射数据分析之间的差距。通过引入一个基于最小二乘法拟合的计算流程 [@problem_id:2492876]，您不仅将学习如何标定图谱，更重要的是，如何统计性地确定最可能的晶系（例如立方、四方或正交）。这种方法反映了现代晶体学软件中采用的先进数据驱动策略。", "problem": "给定您三个粉末X射线衍射 (PXRD) 数据集，每个数据集包含恰好 $10$ 个测量的晶面间距 $d_i$ (单位为埃) 及其相关的单标准差不确定度 $\\sigma_{d,i}$ (单位为埃)。您的任务是，通过对动量传递变量 $Q_i$ 进行加权最小二乘拟合，以编程方式测试三种晶系（立方、四方、正交），从而执行指数化和物相鉴定。您必须根据约化卡方残差和模型的自由度为每个数据集选择最佳晶系。\n\n请使用以下基本原理来推导和实现您的方法：\n- 布拉格定律和散射矢量大小的定义意味着动量传递变量满足 $Q_i = (2\\pi/d_i)^2$ (对于衍射峰 $i$)。\n- 对于直角晶格，倒易度规形式给出了 $Q_{hkl}$ 与整数米勒指数之间的线性关系。特别地，将 $Q_{hkl}$ 写成一个过原点的线性模型 $Q_{hkl} = \\theta^\\top x_{hkl}$，其中 $x_{hkl}$ 是由晶系决定的整数平方组合的矢量：\n  - 立方晶系，晶格参数为 $a$：$Q_{hkl} = (2\\pi)^2 \\left( \\dfrac{h^2+k^2+l^2}{a^2} \\right)$。此模型对于单一参数 $\\alpha = (2\\pi)^2/a^2$ 是线性的，回归量为 $x_{hkl} = h^2+k^2+l^2$。\n  - 四方晶系，晶格参数为 $a,c$：$Q_{hkl} = (2\\pi)^2 \\left( \\dfrac{h^2+k^2}{a^2} + \\dfrac{l^2}{c^2} \\right)$。此模型对于参数 $\\alpha=(2\\pi)^2/a^2$ 和比率 $r = \\gamma/\\alpha = a^2/c^2$ 是线性的，回归量为 $x_{hkl} = (h^2+k^2) + r\\,l^2$。\n  - 正交晶系，晶格参数为 $a,b,c$：$Q_{hkl} = (2\\pi)^2 \\left( \\dfrac{h^2}{a^2} + \\dfrac{k^2}{b^2} + \\dfrac{l^2}{c^2} \\right)$。此模型对于参数 $\\alpha=(2\\pi)^2/a^2$ 和比率 $r_1=\\beta/\\alpha = a^2/b^2$、$r_2=\\gamma/\\alpha = a^2/c^2$ 是线性的，回归量为 $x_{hkl} = h^2 + r_1 k^2 + r_2 l^2$。\n- 从 $d_i$ 到 $Q_i$ 的不确定度传播遵循 $Q_i = (2\\pi)^2 d_i^{-2}$，得到 $\\sigma_{Q,i} = \\left| \\dfrac{dQ}{dd} \\right| \\sigma_{d,i} = 2(2\\pi)^2 \\, d_i^{-3} \\, \\sigma_{d,i}$。\n\n您必须实现以下算法决策，以确保您的程序结果是确定性的且可测试的：\n- 对于每个晶系，从非负米勒指数 $(h,k,l)$ (其中 $0 \\le h,k,l \\le H_{\\max}$，不包括平凡的 $(0,0,0)$) 生成唯一的回归量值 $x_{hkl}$ 的候选有序列表。对于本问题，使用 $H_{\\max} = 6$。\n  - 对于立方晶系，使用 $x_{hkl} = h^2 + k^2 + l^2$。\n  - 对于四方晶系，对于给定的候选比率 $r$，使用 $x_{hkl} = (h^2+k^2) + r\\,l^2$。\n  - 对于正交晶系，对于给定的候选比率 $r_1,r_2$，使用 $x_{hkl} = h^2 + r_1 k^2 + r_2 l^2$。\n- 对于每种晶系和每组固定的比率，将唯一的 $x_{hkl}$ 按升序排序，并取前 $N$ 个值，其中 $N=10$ 是观测到的衍射峰数量。这 $N$ 个值按顺序分配给 $N$ 个观测峰，假设观测峰已按 $Q_i$ 递增（等效于按 $d_i$ 递减）排序。\n- 对选定的回归量 $x_i$ 和观测到的 $Q_i$ 执行过原点的加权最小二乘法，以估计尺度因子 $\\alpha$，使用的权重为 $w_i = 1/\\sigma_{Q,i}^2$。零截距模型的加权最小二乘估计量为 $\\hat{\\alpha} = \\dfrac{\\sum_i w_i x_i Q_i}{\\sum_i w_i x_i^2}$。\n- 计算卡方 $ \\chi^2 = \\sum_i \\left( \\dfrac{Q_i - \\hat{\\alpha} x_i}{\\sigma_{Q,i}} \\right)^2 $ 和约化卡方 $ \\chi^2_{\\mathrm{red}} = \\chi^2/\\nu$，其中自由度为 $\\nu = N - p$，$p$ 等于模型自由参数的数量：立方晶系 $p = 1$，四方晶系 $p = 2$，正交晶系 $p = 3$。\n- 对于四方晶系，在比率网格 $r \\in \\{\\,0.50,\\,0.56,\\,0.5625,\\,0.60,\\,0.70,\\,0.80,\\,1.00,\\,1.50,\\,2.00,\\,3.00\\,\\}$上进行搜索，并保留网格中最小的 $ \\chi^2_{\\mathrm{red}}$。对于正交晶系，在网格 $r_1 \\in \\{\\,0.50,\\,1.00,\\,1.30,\\,1.34,\\,1.343,\\,1.50,\\,2.00\\,\\}$ 和 $r_2 \\in \\{\\,0.90,\\,1.30,\\,1.80,\\,2.00,\\,2.007,\\,2.20\\,\\}$ 上进行搜索，并保留其笛卡尔积网格中最小的 $ \\chi^2_{\\mathrm{red}}$。\n- 模型选择：选择使 $ \\chi^2_{\\mathrm{red}}$ 最小化的晶系。如果两个或多个晶系的 $ \\chi^2_{\\mathrm{red}}$ 值之差在 $10^{-9}$ 的容差范围内，则选择参数数量 $p$ 较少的晶系。\n\n输入测试套件包含三个数据集，每个数据集提供了 $10$ 个测量的晶面间距及其不确定度。$d$ 间距以埃为单位给出，不确定度 $\\sigma_d$ 也以埃为单位。列表按 $d$ 降序（因此 $Q$ 升序）提供。\n\n- 测试用例 1 (意为类四方晶系):\n  - $d = [\\,5.2000,\\,3.9000,\\,3.1206,\\,2.7577,\\,2.6000,\\,2.4359,\\,2.1629,\\,1.9500,\\,1.8918,\\,1.8264\\,]$\n  - $\\sigma_d = [\\,0.003,\\,0.003,\\,0.003,\\,0.003,\\,0.003,\\,0.003,\\,0.003,\\,0.003,\\,0.003,\\,0.003\\,]$\n\n- 测试用例 2 (意为类立方晶系):\n  - $d = [\\,4.0000,\\,2.8284,\\,2.3094,\\,2.0000,\\,1.7889,\\,1.6330,\\,1.4142,\\,1.3333,\\,1.2649,\\,1.2042\\,]$\n  - $\\sigma_d = [\\,0.003,\\,0.003,\\,0.003,\\,0.003,\\,0.003,\\,0.003,\\,0.003,\\,0.003,\\,0.003,\\,0.003\\,]$\n\n- 测试用例 3 (意为类正交晶系):\n  - $d = [\\,5.1000,\\,4.4000,\\,3.6000,\\,3.3315,\\,2.9409,\\,2.7870,\\,2.5500,\\,2.2030,\\,2.2000,\\,2.0800\\,]$\n  - $\\sigma_d = [\\,0.003,\\,0.003,\\,0.003,\\,0.003,\\,0.003,\\,0.003,\\,0.003,\\,0.003,\\,0.003,\\,0.003\\,]$\n\n由于仅使用 $d$ 间距，因此不需要角度单位。\n\n您的程序必须：\n- 对于每个测试用例，按规定计算三种晶系中每一种的约化卡方值。\n- 使用上述规则选择最佳晶系，并将其编码为整数：立方 $\\to 1$，四方 $\\to 2$，正交 $\\to 3$。\n- 将每个约化卡方值四舍五入到 $6$ 位小数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个由逗号分隔的包含三个项目（每个测试用例一个）的列表，每个项目本身都是一个包含四个值的列表，顺序为 $[\\,\\text{晶系代码},\\,\\chi^2_{\\mathrm{red}}(\\text{立方}),\\,\\chi^2_{\\mathrm{red}}(\\text{四方}),\\,\\chi^2_{\\mathrm{red}}(\\text{正交})\\,]$。例如，一个语法上有效的最终输出看起来像 $[[\\,2,\\,0.123456,\\,0.012345,\\,0.234567\\,],[\\,1,\\,\\ldots\\,],[\\,3,\\,\\ldots\\,]]$。", "solution": "问题陈述已经过严格验证，被认为是科学上合理、定义明确且客观的。它基于晶体学和统计分析的既定原则，提出了一个清晰、确定性的算法，用于标定粉末X射线衍射图谱。该问题提供了所有必要的数据、方程和约束条件，以得出一个唯一的、可验证的解。我们现在将按照规定的方法，给出一个完整的、合理的解答。\n\n目标是通过加权最小二乘法 (WLS) 拟合，为给定的三个数据集中的每一个确定最可能的晶系（立方、四方或正交）。选择标准是最小化约化卡方 $\\chi^2_{\\mathrm{red}}$，这是一个考虑了模型参数数量的标准拟合优度度量。\n\n首先，我们将实验数据从晶面间距 $d_i$ 转换为动量传递平方变量 $Q_i$。问题将此变量定义为：\n$$ Q_i = \\left(\\frac{2\\pi}{d_i}\\right)^2 $$\n相关的不确定度 $\\sigma_{Q,i}$ 是通过标准误差传播从d间距的不确定度 $\\sigma_{d,i}$ 确定的：\n$$ \\sigma_{Q,i} = \\left| \\frac{dQ_i}{dd_i} \\right| \\sigma_{d,i} = \\left| -2(2\\pi)^2 d_i^{-3} \\right| \\sigma_{d,i} = 2(2\\pi)^2 d_i^{-3} \\sigma_{d,i} $$\n这些不确定度用于定义WLS拟合的权重 $w_i = 1/\\sigma_{Q,i}^2$。因此，不确定度较小（即精度较高）的数据点对拟合的影响更大。每个数据集的输入 $d_i$ 值是按降序提供的，这确保了相应的 $Q_i$ 值是按升序排列的。\n\n分析的核心在于将每个晶系的理论 $Q_{hkl}$ 值建模为过原点的线性函数 $Q_{hkl} = \\alpha x_{hkl}$，其中 $h,k,l$ 是密勒指数。参数 $\\alpha$ 是一个与晶格参数相关的尺度因子，$x_{hkl}$ 是一个形式取决于晶系的回归量。\n\n对于每个晶系和每个数据集，分析步骤如下：\n1.  使用所有非平凡的密勒指数三元组 $(h,k,l)$（其中 $0 \\le h,k,l \\le H_{\\max}$ 且 $H_{\\max}=6$），生成一组理论回归量值 $x_{hkl}$。\n2.  从此集合中提取唯一值，按升序排序，并取前 $N=10$ 个值，记为 $\\{x_i\\}_{i=1}^{10}$。这些值对应于观测到的 $N=10$ 个衍射峰。\n3.  对模型 $Q_i = \\alpha x_i$ 执行WLS拟合。$\\alpha$ 的零截距WLS估计量由下式给出：\n    $$ \\hat{\\alpha} = \\frac{\\sum_{i=1}^{N} w_i x_i Q_i}{\\sum_{i=1}^{N} w_i x_i^2} $$\n4.  计算卡方统计量，它衡量观测数据与模型预测之间的总平方误差，并由数据不确定度加权：\n    $$ \\chi^2 = \\sum_{i=1}^{N} \\left( \\frac{Q_i - \\hat{\\alpha} x_i}{\\sigma_{Q,i}} \\right)^2 = \\sum_{i=1}^{N} w_i (Q_i - \\hat{\\alpha} x_i)^2 $$\n5.  通过将 $\\chi^2$ 除以自由度数 $\\nu = N - p$ 来计算约化卡方 $\\chi^2_{\\mathrm{red}}$。这里，$N=10$ 是数据点的数量，$p$ 是基础物理模型中的自由参数数量。\n    $$ \\chi^2_{\\mathrm{red}} = \\frac{\\chi^2}{\\nu} = \\frac{\\chi^2}{N-p} $$\n    约化卡方值接近1.0通常表示拟合良好，即模型误差与实验误差相当。\n\n我们现在详细说明三种晶系各自的过程。\n\n**1. 立方晶系 ($p=1$)**\n模型有一个参数，即晶格常数 $a$。关系式为：\n$$ Q_{hkl} = \\frac{(2\\pi)^2}{a^2}(h^2+k^2+l^2) $$\n此模型符合线性形式 $Q_{hkl} = \\alpha x_{hkl}$，其中 $\\alpha = (2\\pi)^2/a^2$，整数回归量为 $x_{hkl} = h^2+k^2+l^2$。模型参数数量为 $p=1$。自由度为 $\\nu = 10 - 1 = 9$。我们生成 $h^2+k^2+l^2$ 的前10个唯一的、非零的、排序后的值，并执行一次WLS拟合以找到相应的 $\\chi^2_{\\mathrm{red}}$。\n\n**2. 四方晶系 ($p=2$)**\n模型有两个参数，晶格常数 $a$ 和 $c$。关系式为：\n$$ Q_{hkl} = (2\\pi)^2 \\left( \\frac{h^2+k^2}{a^2} + \\frac{l^2}{c^2} \\right) $$\n这是一个关于两个变量 $(2\\pi)^2/a^2$ 和 $(2\\pi)^2/c^2$ 的线性模型。问题规定了网格搜索策略。通过定义 $\\alpha = (2\\pi)^2/a^2$ 和比率 $r = a^2/c^2$，方程变为：\n$$ Q_{hkl} = \\alpha \\left( (h^2+k^2) + r l^2 \\right) $$\n对于指定网格中的固定值 $r$，这是一个单参数线性模型，回归量为 $x_{hkl}(r) = (h^2+k^2) + r l^2$。对于网格 $\\{\\,0.50,\\,0.56,\\,0.5625,\\,0.60,\\,0.70,\\,0.80,\\,1.00,\\,1.50,\\,2.00,\\,3.00\\,\\}$ 中的每个 $r$，我们计算前10个唯一回归量，执行WLS拟合得到 $\\hat{\\alpha}(r)$，并计算得到的 $\\chi^2_{\\mathrm{red}}(r)$。四方晶系模型的物理参数数量为 $p=2$，因此自由度为 $\\nu = 10 - 2 = 8$。四方晶系的最终值是在整个网格搜索中找到的最小 $\\chi^2_{\\mathrm{red}}$：$\\min_{r} \\chi^2_{\\mathrm{red}}(r)$。\n\n**3. 正交晶系 ($p=3$)**\n模型有三个参数，$a$，$b$ 和 $c$。关系式为：\n$$ Q_{hkl} = (2\\pi)^2 \\left( \\frac{h^2}{a^2} + \\frac{k^2}{b^2} + \\frac{l^2}{c^2} \\right) $$\n使用类似的网格搜索策略，我们定义 $\\alpha = (2\\pi)^2/a^2$ 和比率 $r_1=a^2/b^2$ 及 $r_2=a^2/c^2$。模型变为：\n$$ Q_{hkl} = \\alpha ( h^2 + r_1 k^2 + r_2 l^2 ) $$\n我们在比率的二维网格 $r_1 \\in \\{\\,0.50,\\,1.00,\\,1.30,\\,1.34,\\,1.343,\\,1.50,\\,2.00\\,\\}$ 和 $r_2 \\in \\{\\,0.90,\\,1.30,\\,1.80,\\,2.00,\\,2.007,\\,2.20\\,\\}$ 上执行搜索。对于每对 $(r_1, r_2)$，我们生成回归量 $x_{hkl}(r_1,r_2) = h^2 + r_1 k^2 + r_2 l^2$，找到 $\\hat{\\alpha}(r_1,r_2)$，并计算 $\\chi^2_{\\mathrm{red}}(r_1,r_2)$。正交模型的参数数量为 $p=3$，因此自由度为 $\\nu = 10 - 3 = 7$。最终值是整个 $(r_1, r_2)$ 网格上的最小 $\\chi^2_{\\mathrm{red}}$。\n\n**模型选择**\n对于每个数据集，我们比较立方、四方和正交模型获得的最小 $\\chi^2_{\\mathrm{red}}$ 值。具有全局最小 $\\chi^2_{\\mathrm{red}}$ 的系统被选为最佳拟合。指定了一个决胜规则：如果两个或多个系统的 $\\chi^2_{\\mathrm{red}}$ 值之差在 $10^{-9}$ 的容差范围内，则选择参数数量 $p$ 较少的系统（即更简单的模型）。这遵循了简约原则，即奥卡姆剃刀定律。然后将选定的系统编码为整数（立方为1，四方为2，正交为3）。下面的程序实现了这一完整过程。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the PXRD indexing and phase identification problem for three test cases.\n    \"\"\"\n\n    # --- Problem constants and specified grids ---\n    H_MAX = 6\n    N_PEAKS = 10\n    TOLERANCE = 1e-9\n\n    # Grids for ratio searches\n    TETRAGONAL_R_GRID = [0.50, 0.56, 0.5625, 0.60, 0.70, 0.80, 1.00, 1.50, 2.00, 3.00]\n    ORTHORHOMBIC_R1_GRID = [0.50, 1.00, 1.30, 1.34, 1.343, 1.50, 2.00]\n    ORTHORHOMBIC_R2_GRID = [0.90, 1.30, 1.80, 2.00, 2.007, 2.20]\n\n    # Test cases data\n    test_cases = [\n        {\n            \"d\": np.array([5.2000, 3.9000, 3.1206, 2.7577, 2.6000, 2.4359, 2.1629, 1.9500, 1.8918, 1.8264]),\n            \"sigma_d\": np.array([0.003] * 10)\n        },\n        {\n            \"d\": np.array([4.0000, 2.8284, 2.3094, 2.0000, 1.7889, 1.6330, 1.4142, 1.3333, 1.2649, 1.2042]),\n            \"sigma_d\": np.array([0.003] * 10)\n        },\n        {\n            \"d\": np.array([5.1000, 4.4000, 3.6000, 3.3315, 2.9409, 2.7870, 2.5500, 2.2030, 2.2000, 2.0800]),\n            \"sigma_d\": np.array([0.003] * 10)\n        }\n    ]\n\n    # Generate Miller indices once\n    hkl_indices = []\n    for h in range(H_MAX + 1):\n        for k in range(H_MAX + 1):\n            for l in range(H_MAX + 1):\n                if h == 0 and k == 0 and l == 0:\n                    continue\n                hkl_indices.append((h, k, l))\n\n    def get_regressors(hkl_list, regressor_func):\n        \"\"\"Generates the first N unique, sorted regressor values.\"\"\"\n        all_x = [regressor_func(h,k,l) for h,k,l in hkl_list]\n        unique_x = sorted(list(set(all_x)))\n        return np.array(unique_x[:N_PEAKS])\n\n    def calculate_chi2_red(Q_obs, sigma_Q, x_theory, p):\n        \"\"\"Performs WLS fit and calculates reduced chi-square.\"\"\"\n        N = len(Q_obs)\n        if len(x_theory)  N:\n            return float('inf')\n        \n        nu = N - p\n        if nu = 0:\n            return float('inf')\n            \n        w = 1.0 / sigma_Q**2\n        \n        sum_w_x_Q = np.sum(w * x_theory * Q_obs)\n        sum_w_x_sq = np.sum(w * x_theory**2)\n        \n        if sum_w_x_sq == 0:\n             return float('inf')\n             \n        alpha_hat = sum_w_x_Q / sum_w_x_sq\n        \n        Q_pred = alpha_hat * x_theory\n        chi2 = np.sum(((Q_obs - Q_pred) / sigma_Q)**2)\n        chi2_red = chi2 / nu\n        \n        return chi2_red\n\n    # --- Main analysis loop ---\n    all_results = []\n    for case in test_cases:\n        d_obs = case[\"d\"]\n        sigma_d_obs = case[\"sigma_d\"]\n        \n        # Convert d to Q and propagate uncertainty\n        Q_obs = (2 * np.pi / d_obs)**2\n        sigma_Q_obs = 2 * (2 * np.pi)**2 * d_obs**(-3) * sigma_d_obs\n\n        # --- Cubic System (p=1) ---\n        p_cubic = 1\n        x_cubic = get_regressors(hkl_indices, lambda h,k,l: h**2 + k**2 + l**2)\n        chi2_red_cubic = calculate_chi2_red(Q_obs, sigma_Q_obs, x_cubic, p_cubic)\n\n        # --- Tetragonal System (p=2) ---\n        p_tetragonal = 2\n        min_chi2_red_tet = float('inf')\n        for r in TETRAGONAL_R_GRID:\n            reg_func = lambda h,k,l: (h**2 + k**2) + r * l**2\n            x_tetragonal = get_regressors(hkl_indices, reg_func)\n            chi2_red = calculate_chi2_red(Q_obs, sigma_Q_obs, x_tetragonal, p_tetragonal)\n            if chi2_red  min_chi2_red_tet:\n                min_chi2_red_tet = chi2_red\n        \n        # --- Orthorhombic System (p=3) ---\n        p_ortho = 3\n        min_chi2_red_ortho = float('inf')\n        for r1 in ORTHORHOMBIC_R1_GRID:\n            for r2 in ORTHORHOMBIC_R2_GRID:\n                reg_func = lambda h,k,l: h**2 + r1 * k**2 + r2 * l**2\n                x_ortho = get_regressors(hkl_indices, reg_func)\n                chi2_red = calculate_chi2_red(Q_obs, sigma_Q_obs, x_ortho, p_ortho)\n                if chi2_red  min_chi2_red_ortho:\n                    min_chi2_red_ortho = chi2_red\n                    \n        # --- Model Selection ---\n        results = [\n            (chi2_red_cubic, p_cubic, 1),\n            (min_chi2_red_tet, p_tetragonal, 2),\n            (min_chi2_red_ortho, p_ortho, 3)\n        ]\n        \n        min_chi_val = min(res[0] for res in results)\n        contenders = [res for res in results if abs(res[0] - min_chi_val) = TOLERANCE]\n        contenders.sort(key=lambda x: x[1]) # Sort contenders by p\n        \n        best_system_code = contenders[0][2]\n        \n        # Store results for final output\n        final_chi_squareds = {\n            1: chi2_red_cubic,\n            2: min_chi2_red_tet,\n            3: min_chi2_red_ortho\n        }\n\n        all_results.append([\n            best_system_code,\n            round(final_chi_squareds[1], 6),\n            round(final_chi_squareds[2], 6),\n            round(final_chi_squareds[3], 6)\n        ])\n        \n    # Format and print the final output\n    print(repr(all_results).replace(\" \", \"\"))\n\nsolve()\n```", "id": "2492876"}]}