{"hands_on_practices": [{"introduction": "晶界是根据其错向来分类的，其中具有高原子匹配度的特殊晶界拥有独特的性能。重位点阵（CSL）模型为描述这些特殊晶界提供了一个强大的几何框架。这个练习 [@problem_id:2511143] 让你能够将 CSL 理论应用于一个物理上至关重要的案例——FCC 金属中的 $\\Sigma3$ 共格孪晶界，从而将抽象的旋转几何与具体的晶体结构联系起来。", "problem": "一种面心立方（FCC）金属表现出晶粒间的取向差，其特征是绕晶体学方向 $[111]$ 进行 $60^{\\circ}$ 的刚性旋转。使用重合位置点阵（CSL）框架，并从基本定义（$\\Sigma$ 是 CSL 原胞体积与晶格原胞体积之比）以及立方晶格中经过充分检验的旋转几何表示出发，确定与此取向差相关的最小重合指数 $\\Sigma$。然后，通过援引 FCC 晶体中共格孪晶形成的能量和几何判据，确定共格孪晶界面，用其没有公因子的素密勒指数 $(hkl)$ 表示。\n\n将您的最终结果以包含四个整数 $[\\Sigma, h, k, l]$ 的单行矩阵形式报告。无需四舍五入。没有需要报告的物理单位。角度以度为单位给出。", "solution": "该问题要求确定面心立方（FCC）金属中特定晶粒取向差的重合指数 $\\Sigma$，并确定相关的共格孪晶界面 $(hkl)$。\n\n取向差被指定为绕晶体学方向 $[uvw] = [111]$ 的一个角度为 $\\theta = 60^{\\circ}$ 的刚性旋转。\n\n首先，我们确定重合指数 $\\Sigma$。重合位置点阵（CSL）是由两个晶格（其中一个相对于另一个旋转）共有的晶格点集合构成的。指数 $\\Sigma$ 定义为 CSL 原胞体积与晶格原胞体积之比，这等效于重合位置点密度的倒数。\n\n对于立方晶格中的旋转，我们可以首先确定旋转矩阵 $R$。旋转轴由向量 $\\mathbf{d} = [111]$ 指定，归一化的轴向量为 $\\hat{n} = \\frac{1}{\\sqrt{1^2+1^2+1^2}}[1,1,1] = \\frac{1}{\\sqrt{3}}(1,1,1)$。旋转角为 $\\theta=60^{\\circ}$。\n\n旋转矩阵 $R$ 可以使用罗德里格旋转公式构造：\n$$R = I \\cos\\theta + [\\hat{n}]_{\\times} \\sin\\theta + (1-\\cos\\theta) (\\hat{n} \\otimes \\hat{n})$$\n其中 $I$ 是 $3 \\times 3$ 单位矩阵，$[\\hat{n}]_{\\times}$ 是 $\\hat{n}$ 的叉积矩阵，$\\hat{n} \\otimes \\hat{n}$ 是 $\\hat{n}$ 与自身的外积。\n\n当 $\\theta = 60^{\\circ}$ 时，我们有 $\\cos(60^{\\circ}) = 1/2$ 和 $\\sin(60^{\\circ}) = \\sqrt{3}/2$。\n这些矩阵是：\n$$[\\hat{n}]_{\\times} = \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 0  -1  1 \\\\ 1  0  -1 \\\\ -1  1  0 \\end{pmatrix}$$\n$$\\hat{n} \\otimes \\hat{n} = \\hat{n}\\hat{n}^T = \\frac{1}{3} \\begin{pmatrix} 1  1  1 \\\\ 1  1  1 \\\\ 1  1  1 \\end{pmatrix}$$\n\n将这些代入罗德里格公式：\n$$R = \\frac{1}{2}I + \\frac{\\sqrt{3}}{2} \\left( \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 0  -1  1 \\\\ 1  0  -1 \\\\ -1  1  0 \\end{pmatrix} \\right) + \\left(1-\\frac{1}{2}\\right) \\left( \\frac{1}{3} \\begin{pmatrix} 1  1  1 \\\\ 1  1  1 \\\\ 1  1  1 \\end{pmatrix} \\right)$$\n$$R = \\frac{1}{2}I + \\frac{1}{2} \\begin{pmatrix} 0  -1  1 \\\\ 1  0  -1 \\\\ -1  1  0 \\end{pmatrix} + \\frac{1}{6} \\begin{pmatrix} 1  1  1 \\\\ 1  1  1 \\\\ 1  1  1 \\end{pmatrix}$$\n$$R = \\frac{1}{6} \\left( \\begin{pmatrix} 3  0  0 \\\\ 0  3  0 \\\\ 0  0  3 \\end{pmatrix} + \\begin{pmatrix} 0  -3  3 \\\\ 3  0  -3 \\\\ -3  3  0 \\end{pmatrix} + \\begin{pmatrix} 1  1  1 \\\\ 1  1  1 \\\\ 1  1  1 \\end{pmatrix} \\right) = \\frac{1}{6} \\begin{pmatrix} 4  -2  4 \\\\ 4  4  -2 \\\\ -2  4  4 \\end{pmatrix}$$\n$$R = \\frac{1}{3} \\begin{pmatrix} 2  -1  2 \\\\ 2  2  -1 \\\\ -1  2  2 \\end{pmatrix}$$\n\n一个晶格点，在常规立方晶胞基底下表示为整数向量 $\\mathbf{x} = (x,y,z)^T$，如果其在旋转后晶格中的对应位置也是一个晶格点，则该点为重合位置点。这意味着 $R^{-1}\\mathbf{x}$ 也必须是一个具有整数分量的向量（对于简单立方晶格）。矩阵 $R$ 是正交的，所以 $R^{-1}=R^T$。\n$$R^{-1} = R^T = \\frac{1}{3} \\begin{pmatrix} 2  2  -1 \\\\ -1  2  2 \\\\ 2  -1  2 \\end{pmatrix}$$\n为使 $R^{-1}\\mathbf{x}$ 成为整数向量，矩阵-向量乘积的各分量必须能被 $3$ 整除：\n$$2x + 2y - z \\equiv 0 \\pmod{3}$$\n$$-x + 2y + 2z \\equiv 0 \\pmod{3}$$\n$$2x - y + 2z \\equiv 0 \\pmod{3}$$\n将第二个和第三个同余式相加得到 $x + y + 4z \\equiv 0 \\pmod{3}$，简化为 $x+y+z \\equiv 0 \\pmod{3}$。将第一个和第二个同余式相加得到 $x+4y+z \\equiv 0 \\pmod{3}$，也简化为 $x+y+z \\equiv 0 \\pmod{3}$。所有三个同余式都是线性相关的，可以简化为单个条件，例如 $z \\equiv -x-y \\pmod{3}$，这与第一个同余式中的 $z \\equiv 2x+2y \\pmod{3}$ 相同。\n\n这个单一约束意味着，对于任意选择的整数 $x$ 和 $y$，$z$ 的三个可能整数值（模 $3$）中只有一个会满足该条件。因此，是重合位置点的晶格点所占的比例为 $1/3$。重合指数 $\\Sigma$ 是此比例的倒数。对于简单立方晶格，$\\Sigma_{prim} = 3$。\n\n对于像 FCC 这样的非简单晶格，$\\Sigma$ 必须进行调整。规则规定，如果 $\\Sigma_{prim}$ 是奇数，则 $\\Sigma_{FCC} = \\Sigma_{prim}$。如果 $\\Sigma_{prim}$ 是偶数，则可能需要乘以因子 $1/2$，具体取决于 CSL 与定心向量之间的关系。由于 $\\Sigma_{prim} = 3$ 是奇数，因此 FCC 晶格的重合指数也是 $3$。\n因此，$\\Sigma=3$。\n\n接下来，我们确定共格孪晶界面 $(hkl)$。问题明确地将此 $\\Sigma=3$ 取向差与共格孪晶的形成联系起来。\n共格晶界的能量判据是其界面能必须处于最小值。对于给定的 CSL 取向差，当晶界平面具有最高可能的重合位置点密度时，就会出现这种情况。\n几何判据是晶界对于两侧的晶体结构是一个镜面，从而形成高度有序的界面。在 FCC 晶体中，共格孪晶在密排面 $\\{111\\}$ 上形成。这是主孪生系。\n\n让我们分析 $\\Sigma=3$ CSL 在 $(111)$ 平面上的 CSL 点密度。如果 $x+y+z=k$（对于某个整数 $k$），则点 $(x,y,z)$ 位于 $(111)$ 族的一个平面上。根据前面导出的 CSL 条件，$x+y+z \\equiv 0 \\pmod{3}$。这意味着 CSL 点只能存在于 $x+y+z=k$ 的平面上，其中 $k$ 是 $3$ 的倍数。\n考虑这样一个平面上的一个点，例如 $x+y+z=0$。CSL 条件变为 $z = -x-y$，将其代入其中一个同余式，例如 $2x+2y-z \\equiv 0 \\pmod{3}$，得到 $2x+2y-(-x-y) = 3x+3y \\equiv 0 \\pmod{3}$。这对于任何整数 $x$ 和 $y$ 都始终成立。这意味着简单立方晶格在平面 $x+y+z=0$（以及平面 $x+y+z = 3k$）上的每个晶格点都是一个 CSL 点。\n因此，$(111)$ 平面具有最高可能的 CSL 点密度（该平面上简单晶格点的 $100\\%$）。这证实了对于 $\\Sigma = 3$ 的取向差，能量最低的共格孪晶界是 $(111)$ 平面。\n\n密勒指数为 $(hkl)=(111)$。这些指数是素的，因为它们的最大公约数为 $1$。\n\n最终结果是行矩阵 $[\\Sigma, h, k, l]$。\n当 $\\Sigma=3$ 且 $(hkl)=(111)$ 时，矩阵为 $[3, 1, 1, 1]$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n3  1  1  1\n\\end{pmatrix}\n}\n$$", "id": "2511143"}, {"introduction": "完美的晶体是一种理想化的概念；真实的材料包含位错，其行为主导着塑性变形。这些位错的结构可能很复杂，常常会分解成不全位错。这些不全位错之间的平衡分离距离，是由它们之间的弹性排斥力与它们所包围的层错的能量惩罚共同决定的。这项练习 [@problem_id:2511183] 要求你推导并计算这个分离距离，从而在基本材料常数（如剪切模量 $G$ 和层错能 $\\gamma_{SF}$）与缺陷的纳米尺度结构之间建立定量的联系。", "problem": "在面心立方晶体中，一个初始为纯螺型的全位错在 $\\{111\\}$ 晶面上分解为两个Shockley不全位错，并在其间形成一个内禀堆垛层错。假设各向同性线弹性、位错线是无限长直平行线，并且单位面积的堆垛层错能为常数 $\\gamma_{\\mathrm{SF}}$。全位错的伯格斯矢量大小为 $b$，类型为 $a/2\\langle 110\\rangle$，每个Shockley不全位错的类型为 $a/6\\langle 112\\rangle$。剪切模量为 $G$，泊松比为 $\\nu$。\n\n从直位错之间弹性相互作用的基本原理以及堆垛层错能是与层错面积成正比的能量惩罚的定义出发，推导在这种纯螺型情况下，两个Shockley不全位错之间的平衡间距 $d$ 的表达式，然后使用以下材料参数对其进行数值计算：\n- $G = 48\\ \\mathrm{GPa}$，\n- $\\nu = 0.34$，\n- $b = 0.2556\\ \\mathrm{nm}$，\n- $\\gamma_{\\mathrm{SF}} = 0.045\\ \\mathrm{J/m^2}$。\n\n以 $\\mathrm{nm}$ 为单位报告最终间距 $d$，并将答案四舍五入到三位有效数字。", "solution": "问题要求推导在面心立方（FCC）晶体中，一个全螺位错分解产生的两个Shockley不全位错之间的平衡间距 $d$，然后进行数值计算。\n\n首先，我们必须验证问题陈述的正确性。\n给定条件如下：\n- FCC晶体中的一个纯螺型全位错。\n- 在 {$111$} 晶面上发生分解。\n- 产物是两个Shockley不全位错和一个内禀堆垛层错。\n- 假设：各向同性线弹性；位错线为无限长直平行线。\n- 单位面积的堆垛层错能：$\\gamma_{\\mathrm{SF}}$ (常数)。\n- 全位错的伯格斯矢量类型：$a/2\\langle 110\\rangle$，大小为 $b$。\n- Shockley不全位错的伯格斯矢量类型：$a/6\\langle 112\\rangle$。\n- 材料参数：剪切模量 $G$，泊松比 $\\nu$。\n- 数值：$G = 48\\ \\mathrm{GPa}$，$\\nu = 0.34$，$b = 0.2556\\ \\mathrm{nm}$，$\\gamma_{\\mathrm{SF}} = 0.045\\ \\mathrm{J/m^2}$。\n\n该问题具有科学依据、提法得当且客观。所描述的现象是晶体材料位错理论的基石。例如，分解反应 $\\frac{a}{2}[1\\bar{1}0] \\rightarrow \\frac{a}{6}[2\\bar{1}\\bar{1}] + \\frac{a}{6}[1\\bar{2}1]$ 对于FCC晶格在 $(111)$ 滑移面上是正确的。初始位错是纯螺型，意味着其位错线方向 $\\vec{\\xi}$ 与其伯格斯矢量 $\\vec{b}_{\\text{total}}$ 平行。产生的Shockley不全位错是混合型的，具体为 $30^{\\circ}$ 位错，因为它们的伯格斯矢量与位错线方向之间的夹角为 $30^{\\circ}$。使用各向同性弹性是一个标准且有效的近似。所有必要的参数都已提供，可得出唯一解。该问题是有效的。\n\n当作用在不全位错上的两个单位长度力达到平衡时，便确立了平衡间距 $d$：一个是弹性排斥力 $F_{\\text{repulsive}}/L$，另一个是来自堆垛层错的吸引力 $F_{\\text{attractive}}/L$。\n\n堆垛层错产生一个与其面积成正比的能量惩罚。对于长度为 $L$、宽度为 $d$ 的一段，能量为 $E_{\\mathrm{SF}} = \\gamma_{\\mathrm{SF}} d L$。单位长度的吸引力是该能量对间距的负导数：\n$$ \\frac{F_{\\text{attractive}}}{L} = -\\frac{1}{L} \\frac{\\partial E_{\\mathrm{SF}}}{\\partial d} = -\\gamma_{\\mathrm{SF}} $$\n因此，这个恒定的单位长度吸引力的大小为 $\\gamma_{\\mathrm{SF}}$。\n\n必须计算两个平行的直不全位错之间的排斥力。问题指定了一个纯螺位错的分解。设总伯格斯矢量为 $\\vec{b}_{\\text{total}}$，大小为 $b$。位错线方向 $\\vec{\\xi}$ 平行于 $\\vec{b}_{\\text{total}}$。分解产生两个不全位错，其伯格斯矢量分别为 $\\vec{b}_{1}$ 和 $\\vec{b}_2$。\n全位错的伯格斯矢量大小 $b=|\\frac{a}{2}\\langle 110 \\rangle| = \\frac{a\\sqrt{2}}{2}$ 与不全位错的伯格斯矢量大小 $b_p=|\\frac{a}{6}\\langle 112 \\rangle| = \\frac{a\\sqrt{6}}{6}$ 之间的关系是 $b_p = b/\\sqrt{3}$。\n\n在滑移面中相距为 $d$ 的两个平行位错之间的单位长度力由下式给出：\n$$ \\frac{F_{\\text{repulsive}}}{L} = \\frac{G}{2\\pi d} \\left( b_{s1}b_{s2} + \\frac{\\vec{b}_{e1} \\cdot \\vec{b}_{e2}}{1-\\nu} \\right) $$\n其中 $b_{si}$ 是第 $i$ 个不全位错伯格斯矢量的螺型分量，$\\vec{b}_{ei}$ 是刃型分量矢量。\n对于纯螺位错的分解，不全位错的螺型分量是平行的，它们的和等于总伯格斯矢量，所以 $\\vec{b}_{s1}+\\vec{b}_{s2}=\\vec{b}_{\\text{total}}$。刃型分量相互抵消，所以 $\\vec{b}_{e1}+\\vec{b}_{e2}=0$，即 $\\vec{b}_{e2} = -\\vec{b}_{e1}$。这两个不全位错的位错特性相同，所以 $b_{s1}=b_{s2}=b_s$ 且 $|\\vec{b}_{e1}|=|\\vec{b}_{e2}|=b_e$。\n因此，$2b_s = b$，得出 $b_s=b/2$。\n不全位错的伯格斯矢量与位错线方向之间的夹角 $\\theta$ 是 $30^{\\circ}$。因此，刃型分量的大小是 $b_e = b_p \\sin(30^{\\circ}) = (\\frac{b}{\\sqrt{3}})(\\frac{1}{2}) = \\frac{b}{2\\sqrt{3}}$。\n将这些分量代入力方程：\n$$ \\frac{F_{\\text{repulsive}}}{L} = \\frac{G}{2\\pi d} \\left( \\left(\\frac{b}{2}\\right)\\left(\\frac{b}{2}\\right) + \\frac{-b_e^2}{1-\\nu} \\right) = \\frac{G}{2\\pi d} \\left( \\frac{b^2}{4} - \\frac{1}{1-\\nu}\\left(\\frac{b}{2\\sqrt{3}}\\right)^2 \\right) $$\n$$ \\frac{F_{\\text{repulsive}}}{L} = \\frac{G b^2}{2\\pi d} \\left( \\frac{1}{4} - \\frac{1}{12(1-\\nu)} \\right) = \\frac{G b^2}{2\\pi d} \\left( \\frac{3(1-\\nu) - 1}{12(1-\\nu)} \\right) $$\n$$ \\frac{F_{\\text{repulsive}}}{L} = \\frac{G b^2 (2-3\\nu)}{24\\pi d (1-\\nu)} $$\n在平衡状态下，这个排斥力与来自堆垛层错的吸引力相平衡：\n$$ \\frac{G b^2 (2-3\\nu)}{24\\pi d (1-\\nu)} = \\gamma_{\\mathrm{SF}} $$\n求解平衡间距 $d$：\n$$ d = \\frac{G b^2 (2-3\\nu)}{24\\pi \\gamma_{\\mathrm{SF}} (1-\\nu)} $$\n这就是所要求的解析表达式。\n\n现在，我们使用给定的参数对此表达式进行数值计算，确保所有单位都使用国际单位制（SI）。\n- $G = 48\\ \\mathrm{GPa} = 48 \\times 10^9\\ \\mathrm{N/m^2}$\n- $b = 0.2556\\ \\mathrm{nm} = 0.2556 \\times 10^{-9}\\ \\mathrm{m}$\n- $\\nu = 0.34$\n- $\\gamma_{\\mathrm{SF}} = 0.045\\ \\mathrm{J/m^2} = 0.045\\ \\mathrm{N/m}$\n\n首先计算无量纲项：\n$2-3\\nu = 2 - 3(0.34) = 2 - 1.02 = 0.98$\n$1-\\nu = 1 - 0.34 = 0.66$\n\n将数值代入 $d$ 的表达式：\n$$ d = \\frac{(48 \\times 10^9\\ \\mathrm{N/m^2}) (0.2556 \\times 10^{-9}\\ \\mathrm{m})^2 (0.98)}{24\\pi (0.045\\ \\mathrm{N/m}) (0.66)} $$\n$$ d = \\frac{48 \\times 10^9 \\times (0.2556)^2 \\times 10^{-18} \\times 0.98}{24 \\pi \\times 0.045 \\times 0.66}\\ \\mathrm{m} $$\n$$ d = \\frac{48 \\times 0.06533136 \\times 0.98}{24 \\pi \\times 0.045 \\times 0.66} \\times 10^{-9}\\ \\mathrm{m} $$\n$$ d = \\frac{3.070806}{2.235683} \\times 10^{-9}\\ \\mathrm{m} $$\n$$ d \\approx 1.37354 \\times 10^{-9}\\ \\mathrm{m} $$\n转换为纳米：\n$$ d \\approx 1.37354\\ \\mathrm{nm} $$\n问题要求答案四舍五入到三位有效数字。\n$$ d \\approx 1.37\\ \\mathrm{nm} $$", "answer": "$$\n\\boxed{1.37}\n$$", "id": "2511183"}, {"introduction": "理解晶界在应力下如何移动是预测材料行为（如再结晶和蠕变）的关键，而这种移动通常与剪切变形相耦合。台阶-位错模型将晶界运动描述为界面内线缺陷的集体运动，为剪切耦合提供了机理。这项高级练习 [@problem_id:2511150] 让你沉浸在现代计算材料科学中，要求你基于离散的能量最小化算法，通过编写一个模拟程序来测量剪切耦合因子。", "problem": "实现一个基于位错节模型的双晶中剪切耦合晶界迁移的离散、零温模拟，并计算剪切耦合因子。使用以下基本原理和定义。\n\n- 平面晶界被建模为一个一维界面，可以通过吸收位错节在法线方向上移动。一个位错节模式的特征在于切向伯氏矢量分量 $b_{\\parallel}$（每次事件的切向滑移）和台阶高度 $h$（每次事件的法向推进），每次事件都会产生核心能量成本 $E_{\\mathrm{c}}$。\n- 在双晶上施加切向剪切位移 $s$ 时，如果塑性滑移未能完全弛豫所施加的剪切，系统会储存弹性势能。对于由位错节贡献的总塑性滑移 $s_{\\mathrm{pl}}$，残余剪切失配为 $r = s - s_{\\mathrm{pl}}$。弹性势能被建模为具有有效刚度 $K$ 的二次惩罚项，因此在施加剪切为 $s$ 和位错节事件计数为 $\\{n_m\\}$ 时的总能量为\n  $$E\\left(s,\\{n_m\\}\\right) = \\tfrac{1}{2} K \\left(s - \\sum_m n_m b_{\\parallel,m}\\right)^2 + \\sum_m n_m E_{\\mathrm{c},m}.$$\n- 总塑性滑移为 $s_{\\mathrm{pl}} = \\sum_m n_m b_{\\parallel,m}$，晶界法向净位移为 $y = \\sum_m n_m h_m$。\n- 剪切耦合因子在运动学上定义为\n  $$\\beta = \\frac{\\Delta s_{\\mathrm{pl}}}{\\Delta y},$$\n  其中分子和分母分别是模拟过程中累积的总塑性切向位移和总法向迁移。这个 $\\beta$ 是无量纲的。\n\n您的程序必须实现以下协议。\n\n- 在零剪切下初始化，$s = 0$，不存在位错节，因此 $s_{\\mathrm{pl}} = 0$ 且 $y = 0$。\n- 以大小为 $\\Delta s$ 的 $N$ 个均匀增量演化 $s$，使得在步骤 $i$ 时，施加的剪切为 $s_i = s_{i-1} + \\Delta s$。\n- 在每个步骤 $i$，更新 $s$ 后，判断添加任何可用模式的单个位错节事件是否会降低总能量 $E\\left(s,\\{n_m\\}\\right)$。如果是，则不可逆地添加产生最大能量降低的事件（任意打破平局），更新 $\\{n_m\\}$、$s_{\\mathrm{pl}}$ 和 $y$，然后重新评估。重复此贪婪添加过程，直到没有单个事件的添加能够降低能量为止。然后进入下一个剪切增量。\n- 在 $N$ 个增量结束时，计算总塑性滑移 $s_{\\mathrm{pl,tot}}$ 和总法向位移 $y_{\\mathrm{tot}}$。将测量的剪切耦合因子定义为\n  $$\\beta_{\\mathrm{meas}} = \\begin{cases}\n  s_{\\mathrm{pl,tot}}/y_{\\mathrm{tot}},  \\text{if } y_{\\mathrm{tot}} \\neq 0,\\\\\n  0,  \\text{if } y_{\\mathrm{tot}} = 0.\n  \\end{cases}$$\n\n设计要求。\n\n- 算法必须严格执行上述能量最小化规则，使用所述能量 $E\\left(s,\\{n_m\\}\\right)$，不得引入任何额外的启发式方法。\n- 所有参数都是无量纲的，或在一致的任意单位制下处理，以使 $\\beta_{\\mathrm{meas}}$ 成为无量纲；不需要单位转换。\n- 不使用角度。不需要输出物理单位。\n\n测试套件。\n\n实现您的程序以运行以下四种情况。在每种情况下，有效刚度为 $K$，增量数为 $N$，增量大小为 $\\Delta s$，位错节模式列表为 $\\{(b_{\\parallel,m}, h_m, E_{\\mathrm{c},m})\\}$。\n\n- 案例A（单模式，正耦合）：\n  - $K = 1000$\n  - $N = 1000$\n  - $\\Delta s = 0.005$\n  - 模式： $\\{(0.25,\\, 0.125,\\, 0.02)\\}$\n- 案例B（两种竞争模式，可能选择混合耦合）：\n  - $K = 1000$\n  - $N = 1000$\n  - $\\Delta s = 0.005$\n  - 模式： $\\{(0.25,\\, 0.125,\\, 0.02),\\ (0.125,\\, 0.25,\\, 0.005)\\}$\n- 案例C（剪切载荷下未实现耦合）：\n  - $K = 1000$\n  - $N = 1000$\n  - $\\Delta s = 0.005$\n  - 模式： $\\{(0.0,\\, 0.125,\\, 0.02)\\}$\n- 案例D（反向剪切下的单模式，负耦合）：\n  - $K = 1000$\n  - $N = 1000$\n  - $\\Delta s = -0.004$\n  - 模式： $\\{(-0.2,\\, 0.1,\\, 0.01)\\}$\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序为 $\\left[\\beta_{\\mathrm{A}}, \\beta_{\\mathrm{B}}, \\beta_{\\mathrm{C}}, \\beta_{\\mathrm{D}}\\right]$，其中 $\\beta_{\\mathrm{X}}$ 是案例 $X \\in \\{\\mathrm{A}, \\mathrm{B}, \\mathrm{C}, \\mathrm{D}\\}$ 的测量剪切耦合因子。例如，输出格式必须与 $[\\beta_{\\mathrm{A}},\\beta_{\\mathrm{B}},\\beta_{\\mathrm{C}},\\beta_{\\mathrm{D}}]$ 完全相同，不含空格。", "solution": "所提出的问题是要求实现一个剪切耦合晶界迁移的离散、零温模拟。该问题具有科学依据，提法明确，并提供了所有必要的参数和定义，以实现一个完整且明确的计算解决方案。该模型基于材料科学中的既有概念，特别是用于晶界运动的位错节模型，并使用一个由弹性势能惩罚项和缺陷核心能量成本组成的标准能量泛函。算法过程以清晰、确定性的方式规定。因此，该问题被认为是有效的，并将提供解决方案。\n\n模拟的核心是一个贪婪能量最小化算法。在外部施加的剪切 $s$ 的每一步，系统状态通过添加位错节事件来更新。只有当模式 $m$ 的位错节事件导致系统总能量 $E$ 减少时，才会添加该事件。如果多种模式都能减少能量，则选择导致能量减少最多的那一种。此过程重复进行，直到不可能再进一步降低能量为止。\n\n系统的总能量由下式给出：\n$$E\\left(s,\\{n_m\\}\\right) = \\tfrac{1}{2} K \\left(s - \\sum_m n_m b_{\\parallel,m}\\right)^2 + \\sum_m n_m E_{\\mathrm{c},m}$$\n其中 $K$ 是有效刚度，$s$ 是施加的总剪切，对于每种模式 $m$，$n_m$ 是事件的数量，$b_{\\parallel,m}$ 是切向伯氏矢量分量，$E_{\\mathrm{c},m}$ 是核心能量。总塑性滑移为 $s_{\\mathrm{pl}} = \\sum_m n_m b_{\\parallel,m}$。\n\n我们必须评估在添加模式 $j$ 的单个位错节事件后能量的变化 $\\Delta E_j$。在事件发生前，状态由塑性滑移 $s_{\\mathrm{pl}}$ 和总核心能量 $E_{\\mathrm{core}}$ 来表征。能量为 $E_{\\mathrm{before}} = \\frac{1}{2}K(s - s_{\\mathrm{pl}})^2 + E_{\\mathrm{core}}$。添加一个模式 $j$ 的事件后，塑性滑移变为 $s_{\\mathrm{pl}} + b_{\\parallel,j}$，核心能量变为 $E_{\\mathrm{core}} + E_{\\mathrm{c},j}$。新的能量为 $E_{\\mathrm{after}} = \\frac{1}{2}K(s - (s_{\\mathrm{pl}} + b_{\\parallel,j}))^2 + E_{\\mathrm{core}} + E_{\\mathrm{c},j}$。\n\n能量变化 $\\Delta E_j = E_{\\mathrm{after}} - E_{\\mathrm{before}}$ 为：\n$$ \\Delta E_j = \\left[ \\frac{1}{2}K(s - s_{\\mathrm{pl}} - b_{\\parallel,j})^2 + E_{\\mathrm{core}} + E_{\\mathrm{c},j} \\right] - \\left[ \\frac{1}{2}K(s - s_{\\mathrm{pl}})^2 + E_{\\mathrm{core}} \\right] $$\n令残余剪切失配为 $r = s - s_{\\mathrm{pl}}$。展开二次项，我们得到：\n$$ \\Delta E_j = \\frac{1}{2}K \\left( (r - b_{\\parallel,j})^2 - r^2 \\right) + E_{\\mathrm{c},j} = \\frac{1}{2}K \\left( r^2 - 2rb_{\\parallel,j} + b_{\\parallel,j}^2 - r^2 \\right) + E_{\\mathrm{c},j} $$\n这可以简化为用于决策准则的表达式：\n$$ \\Delta E_j = E_{\\mathrm{c},j} - K r b_{\\parallel,j} + \\frac{1}{2} K b_{\\parallel,j}^2 $$\n如果 $\\Delta E_j  0$，则事件是有利的。算法选择使 $\\Delta E_j$ 最小化的模式 $j$，前提是该最小值为负。\n\n整个模拟过程如下：\n1. 初始化总施加剪切 $s=0$，总塑性滑移 $s_{\\mathrm{pl}}=0$，以及总法向位移 $y=0$。\n2. 循环 $N$ 个增量。在每个增量中：\n   a. 增加施加的剪切：$s \\leftarrow s + \\Delta s$。\n   b. 进入一个子循环，只要能找到有利事件就继续。在此子循环中：\n      i. 对于每个可用的位错节模式 $m$，使用当前的残余剪切 $r = s - s_{\\mathrm{pl}}$ 计算 $\\Delta E_m$。\n      ii. 找到产生最小 $\\Delta E_m$ 的模式 $m_{\\mathrm{best}}$。\n      iii. 如果 $\\Delta E_{m_{\\mathrm{best}}}  0$，则通过添加一个模式 $m_{\\mathrm{best}}$ 的事件来更新状态：\n         $s_{\\mathrm{pl}} \\leftarrow s_{\\mathrm{pl}} + b_{\\parallel, m_{\\mathrm{best}}}$\n         $y \\leftarrow y + h_{m_{\\mathrm{best}}}$\n      iv. 如果没有模式产生 $\\Delta E_m  0$，则退出子循环。\n3. 在 $N$ 个增量后，如果 $y \\neq 0$，计算测量的剪切耦合因子 $\\beta_{\\mathrm{meas}} = s_{\\mathrm{pl}}/y$，否则 $\\beta_{\\mathrm{meas}} = 0$。\n\n测试案例分析：\n案例A：单模式，$b_{\\parallel} = 0.25$, $h = 0.125$。运动学耦合因子为 $\\beta_{kin} = b_{\\parallel}/h = 0.25/0.125 = 2.0$。模拟将添加此模式的事件以弛豫施加的剪切。最终测量的因子 $\\beta_{\\mathrm{meas}}$ 预计将非常接近 $2.0$。\n\n案例B：两种竞争模式。模式0具有 $(b_{\\parallel,0}, h_0, E_{\\mathrm{c},0}) = (0.25, 0.125, 0.02)$，得出 $\\beta_0=2.0$。模式1具有 $(b_{\\parallel,1}, h_1, E_{\\mathrm{c},1}) = (0.125, 0.25, 0.005)$，得出 $\\beta_1=0.5$。模式1的核心能量 $E_{\\mathrm{c},1}$ 低得多，滑移量 $b_{\\parallel,1}$ 也较小。对能量变化 $\\Delta E_m$ 的分析表明，对于小的残余剪切 $r$，模式1首先变得有利。系统将激活模式1的事件，使 $r$ 保持在低水平，永远不会达到激活模式0的阈值。因此，只有模式1会被激活，$\\beta_{\\mathrm{meas}}$ 将约为 $0.5$。\n\n案例C：单模式，$b_{\\parallel}=0.0$。能量变化为 $\\Delta E = E_{\\mathrm{c},0} + 0 + 0 = 0.02$。由于 $\\Delta E$ 始终为正，因此永远不会发生位错节事件。因此，$s_{\\mathrm{pl,tot}}=0$ 且 $y_{\\mathrm{tot}}=0$。根据问题定义，$\\beta_{\\mathrm{meas}}$ 必须为 $0$。\n\n案例D：单模式，具有负剪切增量 $\\Delta s = -0.004$ 和负伯氏矢量分量 $b_{\\parallel} = -0.2$。台阶高度 $h$ 为正。这模拟了负剪切耦合。运动学因子为 $\\beta_{kin} = b_{\\parallel}/h = -0.2/0.1 = -2.0$。与案例A类似，模拟将通过添加具有负滑移的事件来弛豫负向累积的剪切，导致 $\\beta_{\\mathrm{meas}}$ 接近 $-2.0$。\n\n实现将精确遵循此逻辑，提供指定模型的数值实现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation for all test cases and print the results.\n    \"\"\"\n    \n    # Define test cases as per the problem statement.\n    # Format: (K, N, delta_s, modes)\n    # Modes format: [(b_parallel, h, E_c), ...]\n    test_cases = [\n        (1000, 1000, 0.005, np.array([[0.25, 0.125, 0.02]])), # Case A\n        (1000, 1000, 0.005, np.array([[0.25, 0.125, 0.02], [0.125, 0.25, 0.005]])), # Case B\n        (1000, 1000, 0.005, np.array([[0.0, 0.125, 0.02]])), # Case C\n        (1000, 1000, -0.004, np.array([[-0.2, 0.1, 0.01]])), # Case D\n    ]\n\n    results = []\n    for case in test_cases:\n        K, N, delta_s, modes = case\n        beta_meas = simulate_shear_coupling(K, N, delta_s, modes)\n        results.append(beta_meas)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef simulate_shear_coupling(K, N, delta_s, modes):\n    \"\"\"\n    Implements the discrete simulation of shear-coupled grain-boundary migration.\n\n    Args:\n        K (float): Effective stiffness.\n        N (int): Number of shear increments.\n        delta_s (float): Shear increment size.\n        modes (np.ndarray): A NumPy array where each row represents a disconnection\n                            mode as [b_parallel, h, E_c].\n\n    Returns:\n        float: The measured shear-coupling factor, beta_meas.\n    \"\"\"\n    s = 0.0  # Total imposed shear\n    s_pl = 0.0  # Total plastic slip\n    y = 0.0  # Total normal displacement\n\n    # Extract mode properties into separate vectors for efficient calculation\n    b_par_vec = modes[:, 0]\n    h_vec = modes[:, 1]\n    E_c_vec = modes[:, 2]\n\n    # Pre-calculate the constant part of the energy change equation\n    const_energy_term = E_c_vec + 0.5 * K * b_par_vec**2\n\n    # Main simulation loop over shear increments\n    for _ in range(N):\n        s += delta_s\n\n        # Inner loop for greedy energy minimization at the current shear s\n        while True:\n            # Calculate residual shear\n            r = s - s_pl\n\n            # Calculate energy change for adding one event of each mode\n            # Delta_E = E_c - K*r*b_par + 0.5*K*b_par^2\n            delta_E_vec = const_energy_term - K * r * b_par_vec\n\n            # Find the best mode to activate (most negative delta_E)\n            min_delta_E = np.min(delta_E_vec)\n            \n            if min_delta_E  0:\n                # An energetically favorable event exists. Add it.\n                best_mode_idx = np.argmin(delta_E_vec)\n                \n                # Update system state\n                s_pl += b_par_vec[best_mode_idx]\n                y += h_vec[best_mode_idx]\n            else:\n                # No event can lower the energy, so exit inner loop\n                break\n    \n    # Calculate the measured shear-coupling factor at the end of the simulation\n    if y != 0:\n        beta_meas = s_pl / y\n    else:\n        beta_meas = 0.0\n        \n    return beta_meas\n\nsolve()\n```", "id": "2511150"}]}