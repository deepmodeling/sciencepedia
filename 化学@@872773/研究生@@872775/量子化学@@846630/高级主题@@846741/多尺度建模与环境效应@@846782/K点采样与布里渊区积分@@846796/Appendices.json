{"hands_on_practices": [{"introduction": "本练习介绍了一项基本技能：如何系统地测试总能量相对于k点网格密度的收敛性。我们将实现一个基于理查森外推法（Richardson extrapolation）的方案，这是一种强大的技术，可以利用两个不同网格的计算结果来估计收敛值和数值误差。该练习提供了一种确保第一性原理计算中总能量可靠性的具体方法。[@problem_id:2901043]", "problem": "您需要设计并实现一个数值协议，用于在规定的容差 $\\epsilon$ 内，评估布里渊区每个原胞总能量的 $\\mathbf{k}$ 点收敛性。该协议需使用两个系统嵌套的 $\\mathbf{k}$ 点网格和一个外推程序。该协议必须基于光滑周期被积函数的布里渊区积分的定义，并且必须可针对二维正方晶格的布里渊区实现。\n\n基本原理与目标。在周期性固体中，每个原胞的总能量（不计一个无关紧要的常数）可以写成一个布里渊区平均值\n$$\nE = \\frac{1}{\\Omega_{\\mathrm{BZ}}} \\int_{\\mathrm{BZ}} F(\\mathbf{k}) \\, d^2 k,\n$$\n其中 $\\Omega_{\\mathrm{BZ}}$ 是布里渊区的体积，$F(\\mathbf{k})$ 是一个依赖于电子结构的 $\\mathbf{k}$ 周期被积函数，通常是按占据数加权的能带能量之和。对于具有大小为 $2\\pi$ 的原胞倒格矢的二维正方晶格，您可以将布里渊区视为方形区域 $\\left[-\\pi,\\pi\\right]^2$（角度以弧度为单位），对于该区域，归一化平均值可以计算为 $F(\\mathbf{k})$ 在均匀网格上的未加权平均值。\n\n离散化基础。一个沿每个方向有 $N$ 个点的、以 $\\Gamma$ 为中心的均匀 Monkhorst–Pack 网格由以下点定义\n$$\nk_{\\alpha}(i;N) = \\frac{(2 i - N - 1)\\,\\pi}{N}, \\quad i \\in \\{1,2,\\dots,N\\}, \\quad \\alpha \\in \\{x,y\\},\n$$\n因此，$N\\times N$ 网格是一维节点的笛卡尔积。由于区域和被积函数是周期性的，使用该网格对布里渊区平均值的数值近似是所有 $N^2$ 个 $\\mathbf{k}$ 点的算术平均值。\n\n收敛性评估基础。假设网格平均值存在一个 $p$ 阶的渐近误差模型，\n$$\nE_N = E_\\infty + C\\,N^{-p} + o(N^{-p}),\n$$\n其中 $E_N$ 表示在 $N\\times N$ 网格上获得的平均值，$E_\\infty$ 是无限网格极限，$C$ 是一个与 $N$ 无关的常数，而 $p>0$ 取决于 $F(\\mathbf{k})$ 的光滑度以及体系是绝缘体还是金属（可能存在展宽）。在具有弱展宽的金属情况下，费米面附近的陡峭梯度会有效降低 $p$ 值。\n\n您的任务。根据以上定义，给定一个收敛阶数 $p$，基于 $E_N$ 和 $E_{2N}$ 推导出一个 $E_\\infty$ 的双网格外推估计量，并仅基于 $E_N$、$E_{2N}$ 和 $p$ 推导出一个可计算的误差指标。然后实现以下协议：\n\n- 给定一个粗网格尺寸 $N$（沿每个方向），构造尺寸为 $2N$（沿每个方向）的嵌套细网格，计算 $E_N$ 和 $E_{2N}$ 作为 $F(\\mathbf{k})$ 在相应网格上的算术平均值，并使用您的外推估计量获得 $E_\\infty^{\\mathrm{est}}$ 和误差估计 $\\Delta$。\n- 如果 $\\Delta \\le \\epsilon$，则声明收敛，否则声明未收敛。\n\n物理和数值单位。角度以弧度为单位。所有能量必须以电子伏特（eV）报告。打印浮点数能量时，小数点后应精确到 $10$ 位。\n\n待使用的被积函数。为了可测试性，请实现以下模型被积函数 $F(\\mathbf{k})$，每个函数代表一种不同的物理情境：\n\n- 类绝缘体解析代理模型：\n$$\nF_{\\mathrm{ins}}(k_x,k_y) = E_0 + A \\exp\\!\\big(\\alpha \\cos k_x + \\beta \\cos k_y\\big),\n$$\n参数 $E_0$ 单位为 eV，$A$、$\\alpha$ 和 $\\beta$ 为无量纲参数。\n\n- 具有费米-狄拉克占据数的类金属单能带模型：\n$$\n\\varepsilon(k_x,k_y) = -2t\\left(\\cos k_x + \\cos k_y\\right), \\quad\nn(\\varepsilon;\\mu,\\sigma) = \\frac{1}{1 + \\exp\\!\\left(\\frac{\\varepsilon - \\mu}{\\sigma}\\right)}, \\quad\nF_{\\mathrm{met}}(k_x,k_y) = \\varepsilon(k_x,k_y)\\, n(\\varepsilon(k_x,k_y);\\mu,\\sigma),\n$$\n参数 $t$ 单位为 eV，化学势 $\\mu$ 单位为 eV，展宽参数 $\\sigma$ 单位为 eV。\n\n假设每种情况都有一个用户指定的收敛阶数 $p$，以反映预期的渐近行为：对类绝缘体解析被积函数使用较大的 $p$，对具有小而有限展宽的类金属情况使用较小的 $p$。\n\n测试套件。您的程序必须在没有任何用户输入的情况下，对以下四种情况运行该协议：\n\n- 情况 $\\mathbf{1}$（类绝缘体，光滑）：$F = F_{\\mathrm{ins}}$，参数 $E_0 = -5.0$ eV, $A = 0.2$ eV, $\\alpha = 0.3$, $\\beta = 0.4$，粗网格尺寸 $N = 8$，假定阶数 $p = 4$，容差 $\\epsilon = 1.0\\times 10^{-8}$ eV。\n- 情况 $\\mathbf{2}$（类金属，中等展宽）：$F = F_{\\mathrm{met}}$，参数 $t = 1.0$ eV, $\\mu = 0.0$ eV, $\\sigma = 0.05$ eV，粗网格尺寸 $N = 24$，假定阶数 $p = 2$，容差 $\\epsilon = 1.0\\times 10^{-6}$ eV。\n- 情况 $\\mathbf{3}$（类金属，弱展宽，严容差）：$F = F_{\\mathrm{met}}$，参数 $t = 1.0$ eV, $\\mu = 0.0$ eV, $\\sigma = 0.005$ eV，粗网格尺寸 $N = 16$，假定阶数 $p = 2$，容差 $\\epsilon = 1.0\\times 10^{-10}$ eV。\n- 情况 $\\mathbf{4}$（类绝缘体，非常光滑，低 $N$）：$F = F_{\\mathrm{ins}}$，参数 $E_0 = -2.0$ eV, $A = 0.5$ eV, $\\alpha = 0.9$, $\\beta = 0.7$，粗网格尺寸 $N = 6$，假定阶数 $p = 4$，容差 $\\epsilon = 1.0\\times 10^{-9}$ eV。\n\n要求的最终输出格式。您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表。其中每种情况贡献一个包含三个元素的列表：$[c,E_\\infty^{\\mathrm{est}},\\Delta]$，$c$ 是一个整数，如果收敛则为 $1$，否则为 $0$，$E_\\infty^{\\mathrm{est}}$ 和 $\\Delta$ 以 eV 为单位打印，小数点后精确到 $10$ 位。例如：\n$[[1,-4.8123456789,0.0000000042],[1,\\dots,\\dots],[0,\\dots,\\dots],[1,\\dots,\\dots]]$。", "solution": "问题陈述需经过验证。\n\n**第一步：提取已知条件**\n- **目标**：设计一个协议，以评估布里渊区（BZ）每个原胞总能量的 $\\mathbf{k}$ 点收敛性。\n- **能量定义**：$E = \\frac{1}{\\Omega_{\\mathrm{BZ}}} \\int_{\\mathrm{BZ}} F(\\mathbf{k}) \\, d^2 k$。\n- **布里渊区**：一个二维方形区域 $\\left[-\\pi,\\pi\\right]^2$。\n- **离散化**：大小为 $N \\times N$ 的、以 $\\Gamma$ 为中心的均匀 Monkhorst–Pack 网格。\n- **网格点**：$k_{\\alpha}(i;N) = \\frac{(2 i - N - 1)\\,\\pi}{N}$，其中 $i \\in \\{1,2,\\dots,N\\}$, $\\alpha \\in \\{x,y\\}$。\n- **数值平均**：$E_N$ 是 $F(\\mathbf{k})$ 在 $N \\times N$ 网格上所有值的算术平均值。\n- **渐近误差模型**：$E_N = E_\\infty + C\\,N^{-p} + o(N^{-p})$。\n- **任务**：推导一个基于双网格（$N$, $2N$）的外推估计量 $E_\\infty^{\\mathrm{est}}$ 和一个误差指标 $\\Delta$。实现一个检查 $\\Delta \\le \\epsilon$ 的协议。\n- **被积函数**：\n    1. $F_{\\mathrm{ins}}(k_x,k_y) = E_0 + A \\exp\\!\\big(\\alpha \\cos k_x + \\beta \\cos k_y\\big)$。\n    2. $F_{\\mathrm{met}}(k_x,k_y) = \\varepsilon(k_x,k_y)\\, n(\\varepsilon(k_x,k_y);\\mu,\\sigma)$，其中 $\\varepsilon(k_x,k_y) = -2t\\left(\\cos k_x + \\cos k_y\\right)$ 且 $n(\\varepsilon;\\mu,\\sigma) = \\frac{1}{1 + \\exp\\!\\left(\\frac{\\varepsilon - \\mu}{\\sigma}\\right)}$。\n- **测试用例**：提供了四个具体用例，包含所有必要参数（$E_0, A, \\alpha, \\beta, t, \\mu, \\sigma, N, p, \\epsilon$）。\n- **输出**：一行文本，包含所有用例的结果，格式为 $[[c_1,E_{\\infty,1}^{\\mathrm{est}},\\Delta_1],[c_2,E_{\\infty,2}^{\\mathrm{est}},\\Delta_2],\\dots]$，能量格式化为小数点后 $10$ 位。\n\n**第二步：验证提取的已知条件**\n该问题具有科学依据，提法明确，且客观。它描述了计算凝聚态物理中一种标准且重要的数值技术——即，使用 Richardson 外推法加速布里渊区积分的收敛并估计误差。其数学模型和定义精确且无矛盾。\n\n注意到一个微小的术语不精确之处。问题将大小为 $2N \\times 2N$ 的网格称为相对于 $N \\times N$ 网格是“嵌套的”。对于指定的以 $\\Gamma$ 为中心的网格公式 $k_{\\alpha}(i;N) = \\frac{(2 i - N - 1)\\,\\pi}{N}$，粗网格的点并非细网格点的子集。例如，对于 $N=2$，点集是 $\\{-\\pi/2, \\pi/2\\}$，而对于 $N=4$，点集是 $\\{-3\\pi/4, -\\pi/4, \\pi/4, 3\\pi/4\\}$。然而，这种非嵌套性并不会使外推程序失效。Richardson 外推的有效性依赖于离散化的系统性加密，而非严格的网格嵌套。问题提供了明确的网格生成公式，必须遵循该公式。因此，为了严谨性我们指出了这个术语问题，但这并不使原问题无效。\n\n**第三步：结论与行动**\n该问题被判定为**有效**。将提供一个完整的、有理有据的解决方案。\n\n**外推公式和误差估计量的推导**\n该协议的基础是数值近似 $E_N$ 对真实能量 $E_\\infty$ 的渐近误差模型：\n$$E_N = E_\\infty + C N^{-p} + o(N^{-p})$$\n其中 $p$ 是收敛阶数。我们有两个网格的结果，一个粗网格（大小 $N \\times N$）和一个细网格（大小 $2N \\times 2N$）。忽略高阶项 $o(N^{-p})$，我们可以为两个未知数 $E_\\infty$ 和 $C$ 写出一个方程组：\n$$E_N \\approx E_\\infty + C N^{-p} \\quad (1)$$\n$$E_{2N} \\approx E_\\infty + C (2N)^{-p} = E_\\infty + C N^{-p} 2^{-p} \\quad (2)$$\n为了找到 $E_\\infty$ 的估计值，我们必须消去常数 $C$。从方程（1）中，我们有 $C N^{-p} \\approx E_N - E_\\infty$。将此代入方程（2）得到：\n$$E_{2N} \\approx E_\\infty + (E_N - E_\\infty) 2^{-p}$$\n$$E_{2N} \\approx E_\\infty (1 - 2^{-p}) + E_N 2^{-p}$$\n解出 $E_\\infty$：\n$$E_\\infty (1 - 2^{-p}) \\approx E_{2N} - E_N 2^{-p}$$\n$$E_\\infty \\approx \\frac{E_{2N} - E_N 2^{-p}}{1 - 2^{-p}}$$\n将分子和分母同乘以 $2^p$ 可以得到一个更方便的形式。因此，我们对收敛能量的估计量 $E_\\infty^{\\mathrm{est}}$ 是：\n$$E_\\infty^{\\mathrm{est}} = \\frac{2^p E_{2N} - E_N}{2^p - 1}$$\n这是标准的 Richardson 外推公式。\n\n接下来，我们推导误差的估计量。更精确结果 $E_{2N}$ 的真实误差是 $|E_{2N} - E_\\infty|$。我们可以通过取真实值的最佳估计 $E_\\infty^{\\mathrm{est}}$ 与细网格结果 $E_{2N}$ 之间的差的绝对值来估计此误差。这作为我们的误差指标 $\\Delta$：\n$$\\Delta = |E_\\infty^{\\mathrm{est}} - E_{2N}|$$\n代入 $E_\\infty^{\\mathrm{est}}$ 的表达式：\n$$\\Delta = \\left| \\frac{2^p E_{2N} - E_N}{2^p - 1} - E_{2N} \\right|$$\n为了简化，我们将第二项通分：\n$$\\Delta = \\left| \\frac{2^p E_{2N} - E_N - (2^p - 1)E_{2N}}{2^p - 1} \\right| = \\left| \\frac{2^p E_{2N} - E_N - 2^p E_{2N} + E_{2N}}{2^p - 1} \\right|$$\n简化后得到：\n$$\\Delta = \\left| \\frac{E_{2N} - E_N}{2^p - 1} \\right|$$\n绝对值确保误差为非负。这就是我们可计算的误差指标，它仅依赖于计算出的能量 $E_N$ 和 $E_{2N}$ 以及假定的收敛阶数 $p$。\n\n**数值协议**\n推导出的公式为所需的数值协议提供了基础。对于问题陈述中指定的每个测试用例，执行以下步骤：\n1.  确定用例的参数：被积函数 $F(\\mathbf{k})$ 及其特定参数、粗网格尺寸 $N$、假定的收敛阶数 $p$ 以及收敛容差 $\\epsilon$。\n2.  使用公式 $k_{\\alpha}(i;N) = \\frac{(2 i - N - 1)\\,\\pi}{N}$ 为粗糙的 $N \\times N$ 网格生成 $N^2$ 个 k 点集。\n3.  通过计算 $F(\\mathbf{k})$ 在粗网格所有点上的算术平均值，来计算粗网格能量平均值 $E_N$。\n4.  为精细的 $2N \\times 2N$ 网格生成 $(2N)^2$ 个 k 点集。\n5.  通过在细网格上计算算术平均值，来计算细网格能量平均值 $E_{2N}$。\n6.  使用推导的公式计算外推能量 $E_\\infty^{\\mathrm{est}}$ 和误差估计 $\\Delta$。\n7.  将误差估计与容差进行比较：如果 $\\Delta \\le \\epsilon$，则声明计算收敛（状态 $c=1$）；否则，为未收敛（状态 $c=0$）。\n8.  将结果——收敛状态 $c$、外推能量 $E_\\infty^{\\mathrm{est}}$ 和误差估计 $\\Delta$——格式化并存储，以备最终输出。\n\n该协议将针对四个指定的测试用例实施，涵盖了具有不同参数的类绝缘体和类金属被积函数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the k-point convergence protocol for all test cases.\n    \"\"\"\n\n    def F_ins(kx, ky, E0, A, alpha, beta):\n        \"\"\"\n        Calculates the insulator-like integrand F_ins(k).\n        Args:\n            kx (np.ndarray): Grid of kx points.\n            ky (np.ndarray): Grid of ky points.\n            E0 (float): Energy offset in eV.\n            A (float): Amplitude in eV.\n            alpha (float): Dimensionless parameter.\n            beta (float): Dimensionless parameter.\n        Returns:\n            np.ndarray: Values of the integrand on the grid.\n        \"\"\"\n        return E0 + A * np.exp(alpha * np.cos(kx) + beta * np.cos(ky))\n\n    def F_met(kx, ky, t, mu, sigma):\n        \"\"\"\n        Calculates the metal-like integrand F_met(k).\n        Args:\n            kx (np.ndarray): Grid of kx points.\n            ky (np.ndarray): Grid of ky points.\n            t (float): Hopping parameter in eV.\n            mu (float): Chemical potential in eV.\n            sigma (float): Smearing parameter in eV.\n        Returns:\n            np.ndarray: Values of the integrand on the grid.\n        \"\"\"\n        epsilon = -2.0 * t * (np.cos(kx) + np.cos(ky))\n        # Add a small constant to sigma to prevent division by zero, although not\n        # strictly necessary with the given test cases.\n        if sigma == 0:\n            sigma = 1e-12 \n        n_fermi_dirac = 1.0 / (1.0 + np.exp((epsilon - mu) / sigma))\n        return epsilon * n_fermi_dirac\n    \n    def compute_energy_average(N_grid, F_func, f_params):\n        \"\"\"\n        Computes the Brillouin zone average energy on an N x N grid.\n        Args:\n            N_grid (int): Number of k-points along one direction.\n            F_func (function): The integrand function (F_ins or F_met).\n            f_params (dict): Dictionary of parameters for the integrand function.\n        Returns:\n            float: The calculated average energy.\n        \"\"\"\n        if N_grid == 0:\n            return 0.0\n        \n        # Generate 1D k-points based on the Monkhorst-Pack scheme\n        k_1d = (2.0 * np.arange(1, N_grid + 1) - N_grid - 1.0) * np.pi / N_grid\n        \n        # Create a 2D meshgrid of k-points\n        kx, ky = np.meshgrid(k_1d, k_1d)\n        \n        # Calculate integrand values over the grid\n        energy_values = F_func(kx, ky, **f_params)\n        \n        # The BZ average is the arithmetic mean for a uniform grid\n        return np.mean(energy_values)\n\n    def run_protocol(case):\n        \"\"\"\n        Executes the two-grid convergence protocol for a single test case.\n        Args:\n            case (dict): Dictionary containing all parameters for the case.\n        Returns:\n            list: A list [c, E_inf_est, Delta] with the results.\n        \"\"\"\n        N, p, epsilon = case['N'], case['p'], case['epsilon']\n        integrand_type = case['type']\n        \n        if integrand_type == 'ins':\n            F_func = F_ins\n            f_params = {k: case[k] for k in ['E0', 'A', 'alpha', 'beta']}\n        elif integrand_type == 'met':\n            F_func = F_met\n            f_params = {k: case[k] for k in ['t', 'mu', 'sigma']}\n        else:\n            # This case should not be reached with the given problem.\n            raise ValueError(f\"Unknown integrand type: {integrand_type}\")\n\n        # Calculate energy on the coarse grid (N x N)\n        E_N = compute_energy_average(N, F_func, f_params)\n        \n        # Calculate energy on the fine grid (2N x 2N)\n        E_2N = compute_energy_average(2 * N, F_func, f_params)\n\n        # Apply Richardson extrapolation to estimate E_infinity\n        # E_inf_est = (2^p * E_2N - E_N) / (2^p - 1)\n        power_of_2 = 2.0**p\n        E_inf_est = (power_of_2 * E_2N - E_N) / (power_of_2 - 1.0)\n        \n        # Estimate the error of the fine-grid result\n        # Delta = |E_2N - E_N| / (2^p - 1)\n        Delta = np.abs(E_2N - E_N) / (power_of_2 - 1.0)\n        \n        # Determine convergence status\n        converged = 1 if Delta = epsilon else 0\n        \n        return [converged, E_inf_est, Delta]\n\n    # Definition of the test cases from the problem statement.\n    test_cases = [\n        {'type': 'ins', 'E0': -5.0, 'A': 0.2, 'alpha': 0.3, 'beta': 0.4, 'N': 8, 'p': 4, 'epsilon': 1.0e-8},\n        {'type': 'met', 't': 1.0, 'mu': 0.0, 'sigma': 0.05, 'N': 24, 'p': 2, 'epsilon': 1.0e-6},\n        {'type': 'met', 't': 1.0, 'mu': 0.0, 'sigma': 0.005, 'N': 16, 'p': 2, 'epsilon': 1.0e-10},\n        {'type': 'ins', 'E0': -2.0, 'A': 0.5, 'alpha': 0.9, 'beta': 0.7, 'N': 6, 'p': 4, 'epsilon': 1.0e-9}\n    ]\n\n    results = []\n    for case in test_cases:\n        result_triplet = run_protocol(case)\n        results.append(result_triplet)\n\n    # Format the final output string exactly as required.\n    formatted_results = []\n    for c, e_inf, delta in results:\n        e_inf_str = f\"{e_inf:.10f}\"\n        delta_str = f\"{delta:.10f}\"\n        formatted_results.append(f\"[{c},{e_inf_str},{delta_str}]\")\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2901043"}, {"introduction": "在能量收敛的基础上，本练习将探讨力的收敛性问题，力对k点采样的敏感度通常更高，尤其是在金属中。我们将使用一个简单的金属模型，研究k点密度和涂抹宽度参数($\\sigma$)之间至关重要的相互作用。这项练习对于理解如何获得可靠的力以进行几何优化或分子动力学模拟至关重要。[@problem_id:2900974]", "problem": "您的任务是设计并实现一个用于简单金属能带模型中力的数值收敛性测试，该测试需要明确地探究对$\\mathbf{k}$点密度和电子展宽宽度的敏感性。您的实现必须是一个完整且可运行的程序，能够生成指定的输出格式，而无需任何外部输入。\n\n基本基础与模型设置：从Hellmann–Feynman定理出发，该定理指出，作用在沿标量坐标$u$发生微小位移的原子核上的力$F$由$F = -\\partial E_{\\text{tot}}/\\partial u$给出，其中$E_{\\text{tot}}$是总电子能量。对于一个处于金属性的、具有单条紧束缚能带的周期性一维晶体系统，每个原胞的总能量可以写为在布里渊区内对按电子占据数加权的能带能量的积分，而力则是该能量对$u$的导数。考虑一个一维布里渊区$k \\in [-\\pi,\\pi)$，并为实现无量纲化设置晶格常数$a=1$。设在微小位移$u$下的能带色散为\n$\\epsilon(k; u) = -2t \\cos k + g\\,u \\cos k$，\n其中常数$t  0$和$g  0$，化学势$\\mu = 0$（半满金属）。假设电子占据数由有限电子温度下的费米-狄拉克函数给出（此处用作展宽代理）：$f(\\epsilon;\\sigma) = \\left(1 + \\exp\\left(\\frac{\\epsilon - \\mu}{\\sigma}\\right)\\right)^{-1}$，其中$\\sigma  0$是您将要改变的展宽宽度。\n\n任务：仅使用上述基本定义，推导出一个在$u=0$时力的数值可计算表达式。该表达式应为一个布里渊区平均值，并可用$N_k$个点的均匀$\\mathbf{k}$点网格进行近似。实现以下收敛协议：\n\n1) 定义一个函数，对于给定的$(N_k, \\sigma)$，通过在$[-\\pi,\\pi)$上的$N_k$个点的均匀中点网格上离散化布里渊区积分，返回在$u=0$处计算的近似力$F(N_k,\\sigma)$。\n\n2) 使用一个具有$N_{\\mathrm{ref}}$个点的非常密集的网格和一个非常小的展宽宽度$\\sigma_{\\mathrm{ref}}$来定义一个高精度参考力$F_{\\mathrm{ref}}$。两者的选择应使得离散化误差和展宽误差对于给定模型可以忽略不计。\n\n3) 对于提供的测试套件中的每个测试用例$(N_k, \\sigma, \\tau)$，计算一个布尔值，以指示绝对误差$\\lvert F(N_k,\\sigma) - F_{\\mathrm{ref}} \\rvert$是否小于或等于容差$\\tau$。\n\n模型常数和数值选择：使用$t = 1$（无量纲），$g = 0.4$（无量纲），$\\mu = 0$（无量纲），$N_{\\mathrm{ref}} = 200000$（无量纲计数），以及$\\sigma_{\\mathrm{ref}} = 10^{-4}$（无量纲）。您的$\\mathbf{k}$点网格必须是$[-\\pi,\\pi)$上的均匀中点规则：如果$j \\in \\{0,1,\\dots,N_k-1\\}$，则中点为$k_j = -\\pi + (j + \\tfrac{1}{2}) \\,\\Delta k$，其中$\\Delta k = \\frac{2\\pi}{N_k}$。\n\n测试套件：您的程序必须评估以下用例，并汇总通过/失败的结果。\n\n- 用例 1：$N_k = 400$，$\\sigma = 5 \\times 10^{-2}$，$\\tau = 10^{-3}$。\n- 用例 2：$N_k = 8$，$\\sigma = 10^{-2}$，$\\tau = 10^{-3}$。\n- 用例 3：$N_k = 400$，$\\sigma = 5 \\times 10^{-1}$，$\\tau = 10^{-3}$。\n- 用例 4：$N_k = 100$，$\\sigma = 2 \\times 10^{-2}$，$\\tau = 7 \\times 10^{-4}$。\n- 用例 5：$N_k = 60$，$\\sigma = 10^{-1}$，$\\tau = 2 \\times 10^{-3}$。\n- 用例 6：$N_k = 2$，$\\sigma = 2 \\times 10^{-1}$，$\\tau = 5 \\times 10^{-2}$。\n\n角度单位：所有角度都是无量纲的；三角函数使用弧度作为参数。\n\n最终输出格式：您的程序应生成单行输出，其中包含六个布尔结果，以逗号分隔的列表形式并用方括号括起来（例如，\"[True,False,True,True,False,True]\"）。\n\n注意事项与约束：\n\n- 仅使用向量化的数值运算来评估布里渊区平均值，并通过安全地处理指数函数的大参数来确保费米-狄拉克函数在$\\sigma$非常小时的数值稳定性。\n- 由于模型已完全无量纲化，因此不需要物理单位。\n- 最终打印的输出必须与指定的单行格式完全匹配，不得包含任何额外文本。", "solution": "该问题已经过验证并被认定为有效。这是一个在计算凝聚态物理领域中定义明确的问题，它基于如Hellmann-Feynman定理、紧束缚模型和费米-狄拉克统计等既定原理。为获得唯一的数值解所需的所有参数和定义均已提供。\n\n然而，该问题在其“总电子能量”$E_{\\text{tot}}$的定义中存在一个微妙的歧义。在非零温度或有限电子展宽$\\sigma$下，其导数能产生力的热力学正确量是亥姆霍兹自由能$A = E_{\\text{band}} - \\mathcal{T}S_{\\text{el}}$，而不仅仅是占据的单粒子能量之和$E_{\\text{band}} = \\langle \\epsilon f \\rangle$。对$E_{\\text{band}}$进行简单的微分会漏掉一个与电子熵$S_{\\text{el}}$的导数相关的项。作用在集体坐标$u$上的力的标准且物理上正确的公式由哈密顿量导数的期望值给出，这等同于对自由能求导。我将采用这种严谨的表述进行推导。\n\n每个原胞的亥姆霍兹自由能由下式给出：\n$$ A(u) = E_{\\text{band}}(u) - \\sigma S_{\\text{el}}(u) $$\n其中$\\sigma$是展宽宽度（与温度$k_B \\mathcal{T}$成正比），$E_{\\text{band}}$是能带能量，而$S_{\\text{el}}$是电子熵。它们被定义为布里渊区（BZ）积分：\n$$ E_{\\text{band}}(u) = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} \\epsilon(k; u) f(\\epsilon(k; u) - \\mu; \\sigma) dk $$\n$$ S_{\\text{el}}(u) = -\\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} \\left[ f_k \\ln f_k + (1 - f_k) \\ln(1 - f_k) \\right] dk $$\n其中$f_k$是$f(\\epsilon(k; u) - \\mu; \\sigma)$的简写。力为$F = -\\partial A(u)/\\partial u$。\n$$ F(u) = -\\frac{\\partial E_{\\text{band}}}{\\partial u} + \\sigma \\frac{\\partial S_{\\text{el}}}{\\partial u} $$\n熵项的导数可以使用链式法则进行简化：\n$$ \\frac{\\partial S_{\\text{el}}}{\\partial u} = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} \\frac{d}{df_k}[-f_k \\ln f_k - (1-f_k)\\ln(1-f_k)] \\frac{\\partial f_k}{\\partial u} dk $$\n方括号内的导数是$\\ln(f_k/(1-f_k))$，它等于$(\\epsilon(k;u)-\\mu)/\\sigma$。因此：\n$$ \\sigma \\frac{\\partial S_{\\text{el}}}{\\partial u} = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} (\\epsilon(k;u)-\\mu) \\frac{\\partial f_k}{\\partial u} dk $$\n能带能量的导数是：\n$$ \\frac{\\partial E_{\\text{band}}}{\\partial u} = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} \\left[ \\frac{\\partial \\epsilon(k; u)}{\\partial u} f_k + \\epsilon(k;u) \\frac{\\partial f_k}{\\partial u} \\right] dk $$\n将这些组合起来，力就是：\n$$ F(u) = -\\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} \\left[ \\frac{\\partial \\epsilon}{\\partial u} f_k + \\epsilon \\frac{\\partial f_k}{\\partial u} - (\\epsilon-\\mu) \\frac{\\partial f_k}{\\partial u} \\right] dk = -\\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} \\left[ \\frac{\\partial \\epsilon}{\\partial u} f_k + \\mu \\frac{\\partial f_k}{\\partial u} \\right] dk $$\n问题指定了化学势$\\mu=0$。力的表达式显著简化为纯Hellmann-Feynman项：\n$$ F(u) = -\\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} \\frac{\\partial \\epsilon(k; u)}{\\partial u} f(\\epsilon(k; u); \\sigma) dk $$\n我们需要在$u=0$处评估力。能带色散为$\\epsilon(k; u) = -2t \\cos k + g u \\cos k$。它对$u$的导数是$\\frac{\\partial \\epsilon}{\\partial u} = g \\cos k$。\n在$u=0$时，色散为$\\epsilon(k; 0) = -2t \\cos k$。\n将这些代入力的表达式中：\n$$ F = -\\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} (g \\cos k) f(-2t \\cos k; \\sigma) dk $$\n代入费米-狄拉克函数的形式$f(\\epsilon;\\sigma) = (1 + \\exp(\\epsilon/\\sigma))^{-1}$：\n$$ F(\\sigma) = -\\frac{g}{2\\pi} \\int_{-\\pi}^{\\pi} \\frac{\\cos k}{1 + \\exp\\left(\\frac{-2t \\cos k}{\\sigma}\\right)} dk $$\n这就是力的最终解析表达式。\n\n为了进行数值计算，我们使用指定的$N_k$点中点规则在$[-\\pi, \\pi)$上对该积分进行离散化。k点为$k_j = -\\pi + (j + 1/2)\\Delta k$，其中$j \\in \\{0, \\dots, N_k-1\\}$，$\\Delta k = 2\\pi/N_k$。该积分通过求和来近似：\n$$ \\int_{-\\pi}^{\\pi} G(k) dk \\approx \\sum_{j=0}^{N_k-1} G(k_j) \\Delta k = \\sum_{j=0}^{N_k-1} G(k_j) \\frac{2\\pi}{N_k} $$\n将此应用于力的表达式：\n$$ F(N_k, \\sigma) \\approx -\\frac{g}{2\\pi} \\sum_{j=0}^{N_k-1} \\frac{\\cos k_j}{1 + \\exp\\left(\\frac{-2t \\cos k_j}{\\sigma}\\right)} \\frac{2\\pi}{N_k} $$\n$2\\pi$因子相互抵消，得到最终的计算公式：\n$$ F(N_k, \\sigma) = -\\frac{g}{N_k} \\sum_{j=0}^{N_k-1} \\frac{\\cos k_j}{1 + \\exp\\left(\\frac{-2t \\cos k_j}{\\sigma}\\right)} $$\n数值计算协议如下：\n1. 基于上述公式实现一个函数`compute_force(Nk, sigma)`。常数为$t=1$和$g=0.4$。费米-狄拉克函数的求值必须是数值鲁棒的；标准的`numpy`向量化操作通过在`exp`中返回`inf`来处理潜在的溢出，这正确地导致占据数为$0$。\n2. 使用提供的值$N_{\\mathrm{ref}} = 200000$和$\\sigma_{\\mathrm{ref}} = 10^{-4}$计算高精度参考力$F_{\\mathrm{ref}} = \\text{compute\\_force}(N_{\\mathrm{ref}}, \\sigma_{\\mathrm{ref}})$。\n3. 对于每个测试用例$(N_k, \\sigma, \\tau)$，计算$F(N_k, \\sigma)$并判断绝对误差$|F(N_k, \\sigma) - F_{\\mathrm{ref}}|$是否小于或等于指定的容差$\\tau$。\n4. 收集布尔结果并按要求格式化输出。\n此过程将在提供的Python脚本中实现。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the numerical convergence problem for forces in a simple metallic band model.\n    \"\"\"\n    # Model constants as defined in the problem statement\n    T_HOP = 1.0  # Hopping parameter t\n    G_COUPLING = 0.4  # Electron-displacement coupling g\n    \n    # Reference calculation parameters\n    N_REF = 200000  # Reference number of k-points\n    SIGMA_REF = 1e-4  # Reference smearing width\n\n    # Test suite from the problem statement\n    test_cases = [\n        # (Nk, sigma, tolerance)\n        (400, 5e-2, 1e-3),\n        (8, 1e-2, 1e-3),\n        (400, 5e-1, 1e-3),\n        (100, 2e-2, 7e-4),\n        (60, 1e-1, 2e-3),\n        (2, 2e-1, 5e-2),\n    ]\n\n    def compute_force(nk, sigma):\n        \"\"\"\n        Computes the force for a given number of k-points and smearing width.\n        \n        Args:\n            nk (int): Number of k-points in the uniform grid.\n            sigma (float): Smearing width (electronic temperature).\n\n        Returns:\n            float: The calculated force.\n        \"\"\"\n        if nk == 0:\n            return 0.0\n\n        # Create the uniform midpoint k-point grid on [-pi, pi)\n        # k_j = -pi + (j + 0.5) * delta_k\n        delta_k = 2.0 * np.pi / nk\n        k_points = -np.pi + (np.arange(nk) + 0.5) * delta_k\n        \n        cos_k = np.cos(k_points)\n        \n        # Calculate band energies at u=0\n        epsilon = -2.0 * T_HOP * cos_k\n        \n        # Argument for the exponential in the Fermi-Dirac function\n        exp_arg = epsilon / sigma\n        \n        # Calculate Fermi-Dirac occupation numbers.\n        # numpy handles overflow for large positive exp_arg by returning inf,\n        # and 1.0 / (1.0 + inf) correctly evaluates to 0.0.\n        # This ensures numerical stability without manual checks.\n        occupations = 1.0 / (1.0 + np.exp(exp_arg))\n        \n        # Calculate the force using the discretized formula\n        # F = - (g/Nk) * sum(cos(k_j) * f(epsilon_j))\n        force = -G_COUPLING / nk * np.sum(cos_k * occupations)\n        \n        return force\n\n    # Calculate the high-accuracy reference force\n    f_ref = compute_force(N_REF, SIGMA_REF)\n    \n    results = []\n    for nk_test, sigma_test, tau_test in test_cases:\n        # Calculate the force for the current test case\n        f_test = compute_force(nk_test, sigma_test)\n        \n        # Calculate the absolute error\n        error = abs(f_test - f_ref)\n        \n        # Check if the error is within the tolerance\n        is_converged = error = tau_test\n        results.append(is_converged)\n\n    # Format the final output as a comma-separated list of booleans\n    # e.g., [True,False,True,True,False,True]\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```", "id": "2900974"}, {"introduction": "在前面的练习中我们通过数值方法探索了涂抹效应，现在我们转向理论分析。本练习将引导您推导两种常见涂抹方案——费米-狄拉克（Fermi-Dirac）和一阶梅特菲塞尔-帕克斯顿（Methfessel-Paxton）——所引入的系统误差（偏差）。当需要高精度计算力或应力张量等性质时，理解这些误差的数学来源和阶数是做出明智选择的关键。[@problem_id:2901014]", "problem": "考虑一个三维周期性金属体系，其能带结构光滑，且在费米能级附近的单粒子态密度不为零且光滑。一个积分可观测量，例如Hellmann–Feynman力的一个笛卡尔分量或应力张量的一个分量，在零温下可以写成如下形式的能量积分：\n$$\nQ_0 \\;=\\; \\int_{-\\infty}^{+\\infty} g(\\varepsilon)\\,\\Theta\\!\\big(\\mu-\\varepsilon\\big)\\,d\\varepsilon,\n$$\n其中，$g(\\varepsilon)$ 是能带能量 $\\varepsilon$ 的一个光滑函数，它包含了在固定 $\\varepsilon$ 下该可观测量被积函数在布里渊区内的平均值（包括态密度的影响），$\\mu$ 是费米能级，$\\Theta$ 是Heaviside阶跃函数。在实际的布里渊区积分中，为了减少$k$点离散化误差，通常用一个宽度为 $\\sigma0$ 的展宽占据数 $s\\!\\left((\\varepsilon-\\mu)/\\sigma\\right)$ 来替代不连续的占据数。两种标准的选择是：\n- Fermi–Dirac展宽，它对应于一个有限的电子温度 $T$，其中 $\\sigma=k_{\\mathrm{B}}T$ 且 $s_{\\mathrm{FD}}(x) = \\big(1+\\mathrm{e}^{x}\\big)^{-1}$，以及\n- 一阶Methfessel–Paxton展宽，它使用基于高斯函数的厄米(Hermite)展开的累积函数来近似 $\\Theta$。\n\n定义展宽积分为\n$$\nQ_{\\sigma} \\;=\\; \\int_{-\\infty}^{+\\infty} g(\\varepsilon)\\,s\\!\\left(\\frac{\\varepsilon-\\mu}{\\sigma}\\right)\\,d\\varepsilon,\n$$\n以及展宽引入的偏差为\n$$\n\\delta Q(\\sigma) \\;=\\; Q_{\\sigma}-Q_{0}.\n$$\n假设：\n- $g(\\varepsilon)$ 在 $\\mu$ 的一个邻域内是解析的，且其直到足够高阶的导数都是有界的，\n- 在 $\\mu$ 处恰好没有能带交叉或van Hove奇异点，\n- 力或应力分量仅通过 $g(\\varepsilon)$ 进入表达式，因此在零温下唯一的非解析性是 $\\Theta$ 在 $\\mu$ 处的不连续性。\n\n在上述假设下，对于 $\\sigma \\to 0$ 的极限情况，以下哪种陈述最佳地比较了一阶Methfessel–Paxton展宽与Fermi–Dirac展宽在诸如力和应力等积分量中引入的系统偏差？\n\nA. 在Fermi–Dirac展宽下，$\\delta Q_{\\mathrm{FD}}(\\sigma)=C_{2}\\,\\sigma^{2}\\,g'(\\mu)+\\mathcal{O}\\!\\left(\\sigma^{4}\\right)$；而在一次Methfessel–Paxton展宽下，$\\delta Q_{\\mathrm{MP1}}(\\sigma)=C_{4}\\,\\sigma^{4}\\,g^{(3)}(\\mu)+\\mathcal{O}\\!\\left(\\sigma^{6}\\right)$。因此，对于光滑的金属被积函数，在 $\\sigma$ 较小时，一阶Methfessel–Paxton展宽表现出参数上更小的主导偏差。\n\nB. Fermi–Dirac展宽能够得到完全无偏的积分力和应力（对于任何 $\\sigma0$），因为它是变分的；而一阶Methfessel–Paxton展宽由于其核函数的不对称性，通常会产生一个线性偏差 $\\delta Q(\\sigma)=\\mathcal{O}(\\sigma)$。\n\nC. Fermi–Dirac展宽和一阶Methfessel–Paxton展宽的主导偏差均为 $\\delta Q(\\sigma)=\\mathcal{O}(\\sigma)$，因为唯一的非解析性是占据数在 $\\mu$ 处的跳变。\n\nD. 当 $g$ 光滑时，Fermi–Dirac展宽产生一个指数级小的偏差 $\\delta Q_{\\mathrm{FD}}(\\sigma)=\\mathcal{O}\\!\\big(\\mathrm{e}^{-c/\\sigma}\\big)$（对于某个 $c0$）；而一阶Methfessel–Paxton展宽具有代数偏差 $\\delta Q_{\\mathrm{MP1}}(\\sigma)=\\mathcal{O}\\!\\left(\\sigma^{2}\\right)$。", "solution": "问题陈述需要进行验证。\n\n**第一步：提取已知条件**\n- 零温下的一个积分可观测量由 $Q_0 = \\int_{-\\infty}^{+\\infty} g(\\varepsilon)\\,\\Theta(\\mu-\\varepsilon)\\,d\\varepsilon$ 给出。\n- $g(\\varepsilon)$ 是能带能量 $\\varepsilon$ 的一个光滑函数。\n- $\\mu$ 是费米能级。\n- $\\Theta$ 是Heaviside阶跃函数。\n- 使用宽度为 $\\sigma0$ 的展宽占据数 $s((\\varepsilon-\\mu)/\\sigma)$。\n- 展宽积分为 $Q_{\\sigma} = \\int_{-\\infty}^{+\\infty} g(\\varepsilon)\\,s((\\varepsilon-\\mu)/\\sigma)\\,d\\varepsilon$。\n- 展宽引入的偏差为 $\\delta Q(\\sigma) = Q_{\\sigma}-Q_{0}$。\n- 考虑两种展宽函数：Fermi-Dirac函数，$s_{\\mathrm{FD}}(x) = (1+\\mathrm{e}^{x})^{-1}$，其中 $\\sigma=k_{\\mathrm{B}}T$；以及一阶Methfessel-Paxton函数，$s_{\\mathrm{MP1}}$。\n- 假设：$g(\\varepsilon)$ 在 $\\mu$ 附近是解析的；其导数有界；在 $\\mu$ 处恰好没有能带交叉或van Hove奇异点；非解析性仅来自于 $\\Theta(\\mu-\\varepsilon)$。\n\n**第二步：使用提取的已知条件进行验证**\n该问题具有科学依据。它涉及计算固态物理和量子化学中一个标准且重要的话题：在金属的布里渊区积分中，使用展宽技术所引入的系统误差。其表述在数学上是精确的，并基于对这些方法的既有理论分析。所提供的假设对于此类推导是标准的。\n\n该问题是适定的。它要求在 $\\sigma \\to 0$ 时，对两种明确定义的方法所产生的偏差 $\\delta Q(\\sigma)$ 的主导阶渐近行为进行比较。从这些前提出发可以推导出一个唯一的答案。\n\n该问题是客观的。定义和问题都以清晰、明确的数学语言陈述。\n\n**第三步：结论与行动**\n问题有效。可以推导出严谨的解。\n\n我们首先将偏差 $\\delta Q(\\sigma)$ 表示成一个适合于按 $\\sigma$ 进行级数展开的形式，以此开始推导。令 $\\phi(\\varepsilon)$ 为 $g(\\varepsilon)$ 的一个原函数，使得 $\\phi'(\\varepsilon) = g(\\varepsilon)$。我们可以通过分部积分写出零温可观测量 $Q_0$：\n$$\nQ_0 = \\int_{-\\infty}^{+\\infty} \\phi'(\\varepsilon)\\,\\Theta(\\mu-\\varepsilon)\\,d\\varepsilon = \\big[\\phi(\\varepsilon)\\Theta(\\mu-\\varepsilon)\\big]_{-\\infty}^{+\\infty} - \\int_{-\\infty}^{+\\infty} \\phi(\\varepsilon) \\frac{d}{d\\varepsilon}\\Theta(\\mu-\\varepsilon)\\,d\\varepsilon\n$$\n假设当 $|\\varepsilon| \\to \\infty$ 时 $g(\\varepsilon)$ 足够快地趋于零，则边界项为零。使用 $\\frac{d}{d\\varepsilon}\\Theta(\\mu-\\varepsilon) = -\\delta(\\varepsilon-\\mu)$，我们得到 $Q_0 = \\phi(\\mu)$。\n\n展宽后的可观测量 $Q_{\\sigma}$ 由下式给出：\n$$\nQ_{\\sigma} = \\int_{-\\infty}^{+\\infty} g(\\varepsilon)\\,s\\left(\\frac{\\varepsilon-\\mu}{\\sigma}\\right)\\,d\\varepsilon = \\int_{-\\infty}^{+\\infty} \\phi'(\\varepsilon)\\,s\\left(\\frac{\\varepsilon-\\mu}{\\sigma}\\right)\\,d\\varepsilon\n$$\n再次进行分部积分：\n$$\nQ_{\\sigma} = \\left[\\phi(\\varepsilon)s\\left(\\frac{\\varepsilon-\\mu}{\\sigma}\\right)\\right]_{-\\infty}^{+\\infty} - \\int_{-\\infty}^{+\\infty} \\phi(\\varepsilon) \\frac{1}{\\sigma} s'\\left(\\frac{\\varepsilon-\\mu}{\\sigma}\\right)\\,d\\varepsilon\n$$\n展宽函数 $s(x)$ 具有性质 $s(-\\infty)=1$ 和 $s(+\\infty)=0$。假设 $\\phi(-\\infty)=0$（通过选择积分常数），则边界项消失。然后我们将积分变量改为 $x = (\\varepsilon-\\mu)/\\sigma$，这给出 $d\\varepsilon = \\sigma dx$：\n$$\nQ_{\\sigma} = - \\int_{-\\infty}^{+\\infty} \\phi(\\mu+\\sigma x)\\,s'(x)\\,dx\n$$\n现在我们将 $\\phi(\\mu+\\sigma x)$ 在 $\\mu$ 附近展开为泰勒级数，这是允许的，因为假设 $g(\\varepsilon)$（因此 $\\phi(\\varepsilon)$）在 $\\mu$ 处是解析的：\n$$\n\\phi(\\mu+\\sigma x) = \\sum_{k=0}^{\\infty} \\frac{\\phi^{(k)}(\\mu)}{k!} (\\sigma x)^k = \\phi(\\mu) + \\sum_{k=1}^{\\infty} \\frac{g^{(k-1)}(\\mu)}{k!} (\\sigma x)^k\n$$\n将此代入 $Q_{\\sigma}$ 的表达式中：\n$$\nQ_{\\sigma} = - \\int_{-\\infty}^{+\\infty} \\left(\\phi(\\mu) + \\sum_{k=1}^{\\infty} \\frac{g^{(k-1)}(\\mu)}{k!} (\\sigma x)^k\\right) s'(x)\\,dx\n$$\n$$\nQ_{\\sigma} = -\\phi(\\mu)\\int_{-\\infty}^{+\\infty} s'(x)\\,dx - \\sum_{k=1}^{\\infty} \\frac{g^{(k-1)}(\\mu)}{k!} \\sigma^k \\int_{-\\infty}^{+\\infty} x^k s'(x)\\,dx\n$$\n积分 $\\int_{-\\infty}^{+\\infty} s'(x)\\,dx = s(+\\infty) - s(-\\infty) = 0 - 1 = -1$。因此，第一项是 $\\phi(\\mu) = Q_0$。\n偏差则为 $\\delta Q(\\sigma) = Q_{\\sigma} - Q_0$：\n$$\n\\delta Q(\\sigma) = - \\sum_{k=1}^{\\infty} \\frac{g^{(k-1)}(\\mu)}{k!} \\sigma^k \\int_{-\\infty}^{+\\infty} x^k s'(x)\\,dx\n$$\n这个通用公式允许我们通过检查其导数的矩 $I_k = \\int_{-\\infty}^{+\\infty} x^k s'(x)\\,dx$ 来分析任何给定展宽函数 $s(x)$ 的偏差。\n\n**Fermi-Dirac展宽（$s_{\\mathrm{FD}}$）分析**\n展宽函数为 $s_{\\mathrm{FD}}(x) = (1+\\mathrm{e}^x)^{-1}$。其导数为 $s'_{\\mathrm{FD}}(x) = -\\mathrm{e}^x(1+\\mathrm{e}^x)^{-2}$。\n我们来检查其导数的对称性：\n$$\ns'_{\\mathrm{FD}}(-x) = -\\mathrm{e}^{-x}(1+\\mathrm{e}^{-x})^{-2} = -\\mathrm{e}^{-x} \\left(\\frac{\\mathrm{e}^x+1}{\\mathrm{e}^x}\\right)^{-2} = -\\mathrm{e}^{-x} \\frac{\\mathrm{e}^{2x}}{(\\mathrm{e}^x+1)^2} = -\\frac{\\mathrm{e}^x}{(1+\\mathrm{e}^x)^2} = s'_{\\mathrm{FD}}(x)\n$$\n导数 $s'_{\\mathrm{FD}}(x)$ 是一个偶函数。因此，其所有奇数阶矩都为零：当 $k=1, 3, 5, \\dots$ 时，$I_k = 0$。\n偏差展开式变为：\n$$\n\\delta Q_{\\mathrm{FD}}(\\sigma) = - \\frac{g'(\\mu)}{2!} \\sigma^2 I_2 - \\frac{g'''(\\mu)}{4!} \\sigma^4 I_4 - \\dots\n$$\n第一个不为零的矩是 $I_2 = \\int_{-\\infty}^{+\\infty} x^2 s'_{\\mathrm{FD}}(x)\\,dx$。这是Sommerfeld展开中的一个标准积分，其值为 $-\\pi^2/3$。\n因此，偏差的主导项是：\n$$\n\\delta Q_{\\mathrm{FD}}(\\sigma) = - \\frac{g'(\\mu)}{2} \\sigma^2 \\left(-\\frac{\\pi^2}{3}\\right) + \\mathcal{O}(\\sigma^4) = \\frac{\\pi^2}{6} \\sigma^2 g'(\\mu) + \\mathcal{O}(\\sigma^4)\n$$\nFermi-Dirac展宽的主导偏差是 $\\sigma^2$ 阶，并与 $g'(\\mu)$ 成正比。\n\n**一阶Methfessel–Paxton展宽（$s_{\\mathrm{MP1}}$）分析**\nMethfessel-Paxton展宽函数 $s_{\\mathrm{MP,N}}(x)$ 的构造方式使得对delta函数的近似 $\\tilde{\\delta}_N(x) = -s'_{\\mathrm{MP,N}}(x)$ 能够正确地再现真实delta函数的前 $2N+2$ 个矩。也就是说，对于 $m = 0, 1, \\dots, 2N+1$，有 $\\int_{-\\infty}^{+\\infty} x^m \\tilde{\\delta}_N(x) dx = \\delta_{m0}$。用 $s'$ 的矩来表示，这意味着对于 $m=0, \\dots, 2N+1$，$I_m = -\\delta_{m0}$。\n对于一阶MP展宽，$N=1$。条件是：\n- $I_0 = \\int s'_{\\mathrm{MP1}}(x) dx = -1$\n- $I_1 = \\int x s'_{\\mathrm{MP1}}(x) dx = 0$\n- $I_2 = \\int x^2 s'_{\\mathrm{MP1}}(x) dx = 0$\n- $I_3 = \\int x^3 s'_{\\mathrm{MP1}}(x) dx = 0$\n第一个不被约束为零的矩是 $I_4$。函数 $\\tilde{\\delta}_1(x)$ 是偶函数，所以其所有奇数阶矩都为零，这与 $I_1$ 和 $I_3$ 的条件是一致的。条件 $I_2=0$ 是相比于高斯展宽或Fermi-Dirac展宽等更简单方法的关键改进。\n\n将这些矩代入通用的偏差公式中：\n$$\n\\delta Q_{\\mathrm{MP1}}(\\sigma) = - \\sum_{k=1}^{\\infty} \\frac{g^{(k-1)}(\\mu)}{k!} \\sigma^k I_k\n$$\n因为 $I_1=I_2=I_3=0$，所以 $k=1, 2, 3$ 的项都为零。第一个不为零的项对应于 $k=4$：\n$$\n\\delta Q_{\\mathrm{MP1}}(\\sigma) = - \\frac{g^{(3)}(\\mu)}{4!} \\sigma^4 I_4 + \\mathcal{O}(\\sigma^6)\n$$\n由于根据构造 $I_4 \\neq 0$，一阶Methfessel-Paxton展宽的主导偏差是 $\\sigma^4$ 阶，并与三阶导数 $g'''(\\mu)$ 成正比。\n\n**逐项分析**\n\nA. 在Fermi-Dirac展宽下，$\\delta Q_{\\mathrm{FD}}(\\sigma)=C_{2}\\,\\sigma^{2}\\,g'(\\mu)+\\mathcal{O}\\!\\left(\\sigma^{4}\\right)$；而在一次Methfessel–Paxton展宽下，$\\delta Q_{\\mathrm{MP1}}(\\sigma)=C_{4}\\,\\sigma^{4}\\,g^{(3)}(\\mu)+\\mathcal{O}\\!\\left(\\sigma^{6}\\right)$。因此，对于光滑的金属被积函数，在 $\\sigma$ 较小时，一阶Methfessel–Paxton展宽表现出参数上更小的主导偏差。\n该陈述与我们的推导完全一致。我们发现 $\\delta Q_{\\mathrm{FD}}(\\sigma) \\propto \\sigma^2 g'(\\mu)$ 且 $\\delta Q_{\\mathrm{MP1}}(\\sigma) \\propto \\sigma^4 g'''(\\mu)$。对于小的 $\\sigma$，$\\mathcal{O}(\\sigma^4)$ 的偏差在参数上小于 $\\mathcal{O}(\\sigma^2)$ 的偏差。\n结论：**正确**。\n\nB. Fermi-Dirac展宽能够得到完全无偏的积分力和应力（对于任何 $\\sigma0$），因为它是变分的；而一阶Methfessel-Paxton展宽由于其核函数的不对称性，通常会产生一个线性偏差 $\\delta Q(\\sigma)=\\mathcal{O}(\\sigma)$。\n该陈述不正确。Fermi-Dirac展宽产生的偏差为 $\\mathcal{O}(\\sigma^2)$，并非零。Mermin自由能的变分性质并不意味着可以精确地恢复基态可观测量。此外，一阶Methfessel-Paxton展宽不会产生线性偏差；其相关的 $s'(x)$ 是一个偶函数，这保证了 $\\mathcal{O}(\\sigma)$ 项会消失。\n结论：**不正确**。\n\nC. Fermi-Dirac展宽和一阶Methfessel-Paxton展宽的主导偏差均为 $\\delta Q(\\sigma)=\\mathcal{O}(\\sigma)$，因为唯一的非解析性是占据数在 $\\mu$ 处的跳变。\n该陈述不正确。如推导所示，FD的主导偏差是 $\\mathcal{O}(\\sigma^2)$，而MP1的主导偏差是 $\\mathcal{O}(\\sigma^4)$。对于任何 $s'(x)$ 是偶函数的展宽方案，$\\mathcal{O}(\\sigma)$ 项都会消失，FD和MP方法都属于这种情况。\n结论：**不正确**。\n\nD. 当 $g$ 光滑时，Fermi-Dirac展宽产生一个指数级小的偏差 $\\delta Q_{\\mathrm{FD}}(\\sigma)=\\mathcal{O}\\!\\big(\\mathrm{e}^{-c/\\sigma}\\big)$（对于某个 $c0$）；而一阶Methfessel-Paxton展宽具有代数偏差 $\\delta Q_{\\mathrm{MP1}}(\\sigma)=\\mathcal{O}\\!\\left(\\sigma^{2}\\right)$。\n该陈述不正确。由Sommerfeld展开可知，Fermi-Dirac展宽的偏差是代数的，为 $\\mathcal{O}(\\sigma^2)$。一阶Methfessel-Paxton展宽的偏差是 $\\mathcal{O}(\\sigma^4)$，而不是 $\\mathcal{O}(\\sigma^2)$。\n结论：**不正确**。", "answer": "$$\\boxed{A}$$", "id": "2901014"}]}