{"hands_on_practices": [{"introduction": "虎克原子模型为我们提供了一个独特的理论实验室，其实部可解的特性使我们能够精确推导出其某些跃迁的能量。本练习旨在检验含时密度泛函理论（TDDFT）在理想情况下（即使用精确泛函时）能否重现这一精确解，并由此揭示对交换相关核的一个严格的非平凡约束。通过这个实践[@problem_id:2932929]，我们将加深对TDDFT形式理论结构的理解，特别是关于外部势与电子间相互作用如何解耦的重要定理。", "problem": "考虑一个被称为胡克原子的双电子体系：两个电子，每个电子的质量为 $1$、电荷为 $-1$，在频率为 $\\omega$ 的三维各向同性谐振子势阱中运动，并通过库仑排斥相互作用。在原子单位制下，哈密顿量为\n$$\n\\hat{H} = \\sum_{i=1}^{2}\\left(-\\frac{1}{2}\\nabla_{i}^{2} + \\frac{1}{2}\\,\\omega^{2}\\,|\\mathbf{r}_{i}|^{2}\\right) + \\frac{1}{|\\mathbf{r}_{1} - \\mathbf{r}_{2}|}.\n$$\n施加一个沿 $x$ 轴极化的、空间均匀、随时间变化的弱电场，其微扰为\n$$\n\\delta \\hat{V}(t) = - \\mathcal{E}\\,\\cos(\\Omega t)\\,\\sum_{i=1}^{2} x_{i},\n$$\n其中 $\\mathcal{E}$ 是一个小的实数振幅，$\\Omega$ 是驱动角频率。在电偶极近似下进行计算。\n\n1) 从含时薛定谔方程和未微扰哈密顿量的结构出发，使用质心坐标和相对坐标，从第一性原理论证，精确的最低偶极跃迁允许的激发能（沿 $x$ 轴的精确线性密度响应中的第一个极点）等于 $\\omega$，且与电子-电子相互作用强度无关。在推导过程中，请明确说明您使用的任何对易性质或可分离性质。\n\n2) 现在，在含时密度泛函理论（TDDFT）的线性响应机制下，对一个闭壳层基态，使用精确的科恩-沈（Kohn-Sham, KS）体系，分析相同的激发。令 $\\Delta \\varepsilon$ 表示与 $x$ 极化偶极算符耦合的第一个未占据空间轨道和最高已占据空间轨道之间的 KS 单粒子能量差。仅引用关于谐振子势阱的公认约束，将 $\\Delta \\varepsilon$ 与偶极跃迁允许响应的 $\\omega$ 联系起来。\n\n3) 在 TDDFT 的塔姆-丹可夫近似（Tamm-Dancoff Approximation, TDA）中，考虑由沿 $x$ 轴的主要 KS 跃迁 $| \\phi_{0} \\rangle \\to | \\phi_{1} \\rangle$ 所张成的单极点子空间。用 $K_{d}$ 表示该子空间的哈特里-交换-相关核的对角矩阵元（在跃迁密度度规下）。使用线性响应框架（不假设任何特定的近似泛函），将 TDDFT TDA 激发能 $\\omega_{\\mathrm{TDDFT}}$ 表示为 $\\Delta \\varepsilon$ 和 $K_{d}$ 的函数，然后通过使其与第 1 部分得到的精确结果一致来确定 $K_{d}$ 作为 $\\omega$ 的函数。\n\n请用哈特里（Hartree）单位表示您对 $K_{d}$ 的最终答案。无需四舍五入。", "solution": "本问题将首先被验证，若有效，则按要求分三部分进行解答。\n\n第一步是对问题陈述进行严格验证。\n\n逐字提取给定条件：\n- 体系：一个被称为胡克原子的双电子体系。\n- 粒子性质：两个电子，每个的质量为 $1$，电荷为 $-1$。\n- 外势：频率为 $\\omega$ 的三维各向同性谐振子势阱。\n- 相互作用：库仑排斥，势为 $1/|\\mathbf{r}_{1} - \\mathbf{r}_{2}|$。\n- 未微扰哈密顿量：$\\hat{H} = \\sum_{i=1}^{2}\\left(-\\frac{1}{2}\\nabla_{i}^{2} + \\frac{1}{2}\\,\\omega^{2}\\,|\\mathbf{r}_{i}|^{2}\\right) + \\frac{1}{|\\mathbf{r}_{1} - \\mathbf{r}_{2}|}$。\n- 微扰：$\\delta \\hat{V}(t) = - \\mathcal{E}\\,\\cos(\\Omega t)\\,\\sum_{i=1}^{2} x_{i}$。\n- 微扰性质：小实数振幅 $\\mathcal{E}$，驱动角频率 $\\Omega$。\n- 近似：电偶极近似。\n- 第 1 部分目标：从第一性原理论证精确的最低偶极跃迁允许的激发能为 $\\omega$。\n- 第 2 部分目标：在精确的科恩-沈（KS）理论框架内，将相关的 KS 轨道能隙 $\\Delta \\varepsilon$ 与 $\\omega$ 联系起来。\n- 第 3 部分目标：使用含时密度泛函理论（TDDFT）的塔姆-丹可夫近似（TDA），将激发能 $\\omega_{\\mathrm{TDDFT}}$ 表示为 $\\Delta \\varepsilon$ 和核矩阵元 $K_{d}$ 的函数。通过使其与精确结果一致来确定 $K_{d}(\\omega)$。\n\n验证结论：\n该问题具有科学依据，提法明确且客观。它基于量子力学和 TDDFT 的既定原理，并使用了一个标准模型体系（胡克原子）。问题逻辑结构清晰，包含了进行严谨推导所需的所有信息。这是一个理论化学中的非平凡问题，考验了对多体物理和电子结构理论的基本理解。问题有效。我们开始解答。\n\n第 1 部分：精确的偶极激发能\n\n通过将哈密顿量变换到质心（COM）和相对坐标来解决此问题。设两个电子的位置为 $\\mathbf{r}_{1}$ 和 $\\mathbf{r}_{2}$。\n质心坐标为 $\\mathbf{R} = \\frac{\\mathbf{r}_{1} + \\mathbf{r}_{2}}{2}$。\n相对坐标为 $\\mathbf{r} = \\mathbf{r}_{1} - \\mathbf{r}_{2}$。\n质量为 $m_{1}=m_{2}=1$（原子单位）。总质量为 $M = m_{1} + m_{2} = 2$，折合质量为 $\\mu = \\frac{m_{1}m_{2}}{m_{1}+m_{2}} = \\frac{1}{2}$。\n\n动能算符变换为：\n$$\n-\\frac{1}{2}\\nabla_{1}^{2} - \\frac{1}{2}\\nabla_{2}^{2} = -\\frac{1}{2M}\\nabla_{\\mathbf{R}}^{2} - \\frac{1}{2\\mu}\\nabla_{\\mathbf{r}}^{2} = -\\frac{1}{4}\\nabla_{\\mathbf{R}}^{2} - \\nabla_{\\mathbf{r}}^{2}\n$$\n谐振子势能项变换为：\n$$\n\\frac{1}{2}\\omega^{2}|\\mathbf{r}_{1}|^{2} + \\frac{1}{2}\\omega^{2}|\\mathbf{r}_{2}|^{2} = \\frac{1}{2}\\omega^{2}(|\\mathbf{R} + \\frac{1}{2}\\mathbf{r}|^{2} + |\\mathbf{R} - \\frac{1}{2}\\mathbf{r}|^{2}) = \\frac{1}{2}\\omega^{2}(2|\\mathbf{R}|^{2} + \\frac{1}{2}|\\mathbf{r}|^{2}) = \\omega^{2}|\\mathbf{R}|^{2} + \\frac{1}{4}\\omega^{2}|\\mathbf{r}|^{2}\n$$\n根据定义，库仑相互作用项仅依赖于相对坐标：$\\frac{1}{|\\mathbf{r}_{1} - \\mathbf{r}_{2}|} = \\frac{1}{|\\mathbf{r}|}$。\n\n总哈密顿量 $\\hat{H}$ 分离为质心部分和相对部分：\n$$\n\\hat{H} = \\left(-\\frac{1}{4}\\nabla_{\\mathbf{R}}^{2} + \\omega^{2}|\\mathbf{R}|^{2}\\right) + \\left(-\\nabla_{\\mathbf{r}}^{2} + \\frac{1}{4}\\omega^{2}|\\mathbf{r}|^{2} + \\frac{1}{|\\mathbf{r}|}\\right) = \\hat{H}_{\\mathrm{COM}}(\\mathbf{R}) + \\hat{H}_{\\mathrm{rel}}(\\mathbf{r})\n$$\n质心哈密顿量 $\\hat{H}_{\\mathrm{COM}} = -\\frac{1}{2(2)}\\nabla_{\\mathbf{R}}^{2} + \\frac{1}{2}(2)\\omega^{2}|\\mathbf{R}|^{2}$ 描述了一个质量为 $M=2$ 的单粒子在频率为 $\\omega$ 的三维各向同性谐振子势阱中的运动。$\\hat{H}_{\\mathrm{COM}}$ 的能量本征值为 $E_{\\mathrm{COM}} = (N + \\frac{3}{2})\\omega$，其中 $N=n_{X}+n_{Y}+n_{Z}$ 是总量子数。\n\n微扰由沿 $x$ 轴的电偶极算符 $\\hat{D}_{x} = \\sum_{i=1}^{2} x_{i}$ 描述。在新坐标系中，$x_{1} = X + \\frac{1}{2}x$ 和 $x_{2} = X - \\frac{1}{2}x$，因此算符变为：\n$$\n\\hat{D}_{x} = (X + \\frac{1}{2}x) + (X - \\frac{1}{2}x) = 2X\n$$\n偶极算符*仅*依赖于质心坐标 $X$。由于哈密顿量是可分离的，并且偶极算符仅作用于质心子系统，因此该算符引起的跃迁只能改变质心运动的量子态，而由 $\\hat{H}_{\\mathrm{rel}}$ 描述的相对运动的状态保持不变。这是广义科恩定理的一种体现。\n\n体系的基态为 $\\Psi_{0} = \\Phi_{0}(\\mathbf{R})\\psi_{0}(\\mathbf{r})$，其中 $\\Phi_{0}$ 是 $\\hat{H}_{\\mathrm{COM}}$ 的基态，$\\psi_{0}$ 是 $\\hat{H}_{\\mathrm{rel}}$ 的基态。态 $\\Phi_{0}$ 对应于 $N=0$（即 $n_{X}=n_{Y}=n_{Z}=0$），其能量为 $E_{\\mathrm{COM},0} = \\frac{3}{2}\\omega$。\n算符 $X$ 具有选择定则 $\\Delta n_{X} = \\pm 1$。因此，从基态出发的能量最低的偶极跃迁允许的跃迁，会将质心运动从 $n_{X}=0$ 激发到 $n_{X}=1$，而 $n_{Y}$ 和 $n_{Z}$ 保持为 $0$。最终的质心态的量子数为 $n_{X}=1, n_{Y}=0, n_{Z}=0$，因此 $N=1$。这个最终态的能量为 $E_{\\mathrm{COM},1} = (1 + \\frac{3}{2})\\omega = \\frac{5}{2}\\omega$。\n此跃迁的精确激发能是质心能量的差值，因为相对能量不变：\n$$\n\\Delta E = E_{\\mathrm{COM},1} - E_{\\mathrm{COM},0} = \\frac{5}{2}\\omega - \\frac{3}{2}\\omega = \\omega\n$$\n这个结果是精确的，并且无论电子-电子相互作用强度如何都成立。\n\n第 2 部分：科恩-沈轨道能量差\n\n在 TDDFT 中，相互作用体系的精确含时密度 $n(\\mathbf{r}, t)$ 可以由一个在有效含时 KS 势下演化的虚构的非相互作用科恩-沈（KS）体系再现。相互作用体系的线性密度响应必须与 KS 体系的线性密度响应相同。\n对于处于谐振子外势中的相互作用体系，由均匀电场激发的质心运动以裸势阱频率 $\\omega$ 振荡。这意味着精确的密度响应函数在 $\\omega$ 处有一个极点。\n为了再现这一点，KS 体系的响应也必须在 $\\omega$ 处有一个极点。裸 KS 响应函数 $\\chi_{s}(\\Omega)$ 的极点出现在 KS 轨道能量差 $\\varepsilon_{a} - \\varepsilon_{i}$ 处，其中 $\\varepsilon_{i}$ 是一个已占据轨道的能量，$\\varepsilon_{a}$ 是一个未占据轨道的能量。然后，TDDFT 线性响应方程通过哈特里-交换-相关（Hxc）核将这些极点移动到真实的激发能位置。\n然而，对于谐振子势阱中的偶极激发这一特定情况，一个被称为谐振子势定理（或 KS-科恩定理）的强约束要求精确的 Hxc 核对偶极振荡频率没有校正。因此，裸 KS 响应函数的相关极点必须已经位于精确的频率上。\n该体系是一个闭壳层双电子原子，因此最高已占分子轨道（HOMO）是一个球对称的 $s$ 型轨道。偶极算符 $x$ 具有奇宇称，根据选择定则，它会诱导向 $p$ 型对称轨道的跃迁。第一组未占据轨道（LUMO）是简并的 $p$ 轨道。问题将 $\\Delta \\varepsilon$ 定义为由 $x$ 极化偶极算符耦合的能量最低的已占据轨道和未占据轨道之间的 KS 能量差。这对应于 HOMO-LUMO 间隙，$\\Delta \\varepsilon = \\varepsilon_{\\mathrm{LUMO}} - \\varepsilon_{\\mathrm{HOMO}}$。\n为了满足谐振子势定理，精确 KS 体系中的这个能隙必须等于势阱频率：\n$$\n\\Delta \\varepsilon = \\omega\n$$\n\n第 3 部分：TDA 核元\n\n在塔姆-丹可夫近似（TDA）中，激发能 $\\omega_{\\mathrm{TDDFT}}$ 通过求解本征值问题 $\\mathbf{A} \\mathbf{F} = \\omega_{\\mathrm{TDDFT}} \\mathbf{F}$ 来找到，其中矩阵 $\\mathbf{A}$ 由 $A_{ia,jb} = \\delta_{ij}\\delta_{ab}(\\varepsilon_{a} - \\varepsilon_{i}) + K_{ia,jb}$ 给出。这里，$K_{ia,jb}$ 是 Hxc 核的矩阵元。\n问题要求考虑一个单极点子空间，这意味着我们只考虑从 HOMO（记为 $i$）到 LUMO（记为 $a$）的主要跃迁。矩阵 $\\mathbf{A}$ 变成一个 $1 \\times 1$ 的矩阵，即一个标量。本征值方程是平凡的：\n$$\n\\omega_{\\mathrm{TDDFT}} = (\\varepsilon_{a} - \\varepsilon_{i}) + K_{ia,ia}\n$$\n使用问题的符号，$\\Delta \\varepsilon = \\varepsilon_{a} - \\varepsilon_{i}$ 并且 $K_{d} = K_{ia,ia}$ 是此跃迁的对角核元。因此，TDA 激发能为：\n$$\n\\omega_{\\mathrm{TDDFT}} = \\Delta \\varepsilon + K_{d}\n$$\n现在，我们强制要求这个 TDDFT TDA 结果与第 1 部分推导出的精确激发能 $\\omega$ 一致。\n$$\n\\omega = \\Delta \\varepsilon + K_{d}\n$$\n根据第 2 部分的分析，对于精确的 KS 体系，我们有约束条件 $\\Delta \\varepsilon = \\omega$。将此代入方程得到：\n$$\n\\omega = \\omega + K_{d}\n$$\n此方程意味着核元必须为零。\n$$\nK_{d} = 0\n$$\n这个结果 $K_d = 0$ 意味着，对于精确的 Hxc 泛函，在谐振子势阱中，质心激发的 TDA 核的哈特里和交换相关贡献之和恰好为零。这种抵消是一个已知的性质，对于 TDDFT 在此类体系中恢复正确的偶极响应至关重要。任何不能实现这种抵消的近似泛函都会对此模式产生不正确的激发能。", "answer": "$$\n\\boxed{0}\n$$", "id": "2932929"}, {"introduction": "从理想化的精确泛函转向现实世界中的近似泛函后，我们必须面对一个事实：尽管功能强大，但基于绝热近似和半局域泛函的标准TDDFT方法存在着一些著名的系统性偏差。本练习[@problem_id:2932886]将我们置于计算化学家的角色，要求我们学习如何识别这些失效模式的“症状”（例如电荷转移激发能量的严重低估和双激发态的缺失），并掌握正确的诊断方法和补救措施。这是一项将理论知识转化为可靠计算结果的关键技能。", "problem": "一个给体-受体二聚体的中心相距为 $R$，使用线性响应含时密度泛函理论 (LR-TDDFT) 在绝热近似和半局域交换相关 (XC) 泛函下进行建模。计算出的吸收光谱显示，最低单重态特征峰的能量对 $R$ 的依赖性很弱，并且一些从高水平基准计算中已知的强特征峰缺失了。要求您基于 LR-TDDFT 线性响应的第一性原理，提出诊断性检查，以确定光谱是否受到电荷转移行为的污染或缺失双激发特性，并提出可靠的修正方案。下列哪项诊断-修正配对在这种情况下是有效的？\n\nA. 通过检查由 LR-TDDFT 响应向量构建的附着-脱附密度得到的空穴和粒子之间的空间分离来诊断电荷转移特性；大的电子-空穴分离和激发能对 $R$ 的弱依赖性是其标志。修正方案：改用范围分离杂化泛函，并通过非经验性调谐来满足电离势条件，和/或改用具有正确长程电子-空穴相互作用的方法，例如在格林函数乘以屏蔽库仑相互作用（$GW$）之上的 Bethe-Salpeter 方程。\n\nB. 通过比较长度规范和速度规范的振子强度来诊断缺失的双激发；显著的差异意味着存在双激发特性。修正方案：采用 Tamm-Dancoff 近似 (TDA)，因为它包含了双激发，而标准的 LR-TDDFT 则没有。\n\nC. 通过将大 $R$ 下计算的激发能与一个独立的、由总能量差得到的给体电离势和受体电子亲和能构建的估算值进行比较，来诊断电荷转移的低估；大的负偏差表明存在问题。修正方案：仅添加弥散基函数；仅此一项就能恢复正确的渐近电荷转移能量。\n\nD. 通过分析 LR-TDDFT 响应向量的单粒子-单空穴成分，并与运动方程耦合簇单双激发 (EOM-CCSD) 或代数图解构造 (ADC) 进行交叉验证来诊断缺失的双激发；如果该状态主要由双粒子-双空穴特性主导，并且在绝热 LR-TDDFT 中缺失，那么它是由于频率无关的 XC 核而缺失的。修正方案：使用带有频率相关核的修饰含时密度泛函理论、用于双自由基的自旋翻转含时密度泛函理论，或处理双激发的相关波函数方法。\n\nE. 通过泛函敏感性来诊断电荷转移与局域价激发特性：重新计算光谱，同时增加精确交换的比例；强烈的蓝移表示电荷转移特性，而局域价激发则不那么敏感。修正方案：采用范围分离杂化泛函，并通过非经验性调谐范围分离参数来强制执行正确的渐近势和电离势条件。\n\n选择所有适用项。从 LR-TDDFT 线性响应的第一性原理出发，论证您的选择，不要假设超出响应函数和激发能标准定义的任何“黑箱”公式。", "solution": "问题陈述是科学有效的。它描述了计算量子化学中一个常见且被充分理解的情景，即绝热、半局域的线性响应含时密度泛函理论 (LR-TDDFT) 失效。这些失效——对电荷转移 (CT) 激发的不正确描述和具有双激发特性的状态的缺失——是该理论水平的已知局限性。问题要求为这些问题提供有效的诊断和修正配对，并以 TDDFT 的原理为基础。\n\nLR-TDDFT 的核心是 Casida 方程，其单重态激发的矩阵形式为：\n$$\n\\begin{pmatrix} \\mathbf{A}  \\mathbf{B} \\\\ \\mathbf{B}^*  \\mathbf{A}^* \\end{pmatrix} \\begin{pmatrix} \\mathbf{X} \\\\ \\mathbf{Y} \\end{pmatrix} = \\omega \\begin{pmatrix} \\mathbf{1}  \\mathbf{0} \\\\ \\mathbf{0}  -\\mathbf{1} \\end{pmatrix} \\begin{pmatrix} \\mathbf{X} \\\\ \\mathbf{Y} \\end{pmatrix}\n$$\n这是激发能 $\\omega$ 的一个本征值方程。矩阵 $\\mathbf{A}$ 和 $\\mathbf{B}$ 依赖于 Kohn-Sham (KS) 轨道能级差以及涉及交换相关 (XC) 核 $f_{\\text{XC}}(\\mathbf{r}_1, \\mathbf{r}_2, \\omega) = \\delta V_{\\text{XC}}(\\mathbf{r}_1)/\\delta\\rho(\\mathbf{r}_2)$ 的积分。问题指出了两个关键近似：\n$1$. **绝热近似**：忽略了核的频率依赖性，$f_{\\text{XC}}(\\omega) \\to f_{\\text{XC}}(\\omega=0)$。这个近似是标准 LR-TDDFT 无法描述双激发的主要原因。\n$2$. 使用**半局域 XC 泛函**（例如，局域密度近似 LDA，或广义梯度近似 GGA）。对于这类泛函，XC 势 $V_{\\text{XC}}(\\mathbf{r})$ 仅依赖于点 $\\mathbf{r}$ 处的密度 $\\rho$ 及其梯度 $\\nabla\\rho$。因此，核 $f_{\\text{XC}}$ 在空间上是超局域的。这种局域性是电荷转移激发失效的原因。\n\n**电荷转移 (CT) 激发失效：**\n对于从相距较大距离 $R$ 的给体 (D) 到受体 (A) 的激发，初始 KS 轨道 $\\phi_i$ 在 D 上，最终轨道 $\\phi_a$ 在 A 上。它们之间的重叠可以忽略不计。激发能应渐近地表现为 $\\omega_{\\text{CT}} \\approx \\text{IP(D)} - \\text{EA(A)} - 1/R$，其中 $\\text{IP}$ 是电离势，$\\text{EA}$ 是电子亲和能。在 LR-TDDFT 中，激发能近似为 $\\omega_{ia} \\approx \\epsilon_a - \\epsilon_i + K_{ia,ia}$，其中 $K_{ia,ia}$ 是电子-空穴相互作用项。由于空间分离和半局域 $f_{\\text{XC}}$ 的局域性，核对 $K_{ia,ia}$ 的贡献消失了。此外，在半局域 DFT 中，$K_{ia,ia}$ 的库仑部分也从核的定义中缺失，这是自相互作用误差的一种表现。这导致 $\\omega_{\\text{CT}} \\approx \\epsilon_a - \\epsilon_i$，这个值仅依赖于 KS 轨道能，并且缺少正确的 $-1/R$ 依赖关系，从而导致对 CT 能量的严重低估。\n\n**双激发失效：**\nCasida 方程的响应向量 $(\\mathbf{X}, \\mathbf{Y})$ 将激发态描述为单粒子提升（从占据轨道 $i$ 到虚拟轨道 $a$）和降迁的线性组合。那些本质上由双粒子提升（例如，从 $i, j$ 到 $a, b$）主导的状态，在这个单激发空间中没有显著分量，因此不能作为绝热 LR-TDDFT 方程的解被找到。\n\n我们现在评估每个选项。\n\n**A. 通过检查由 LR-TDDFT 响应向量构建的附着-脱附密度得到的空穴和粒子之间的空间分离来诊断电荷转移特性；大的电子-空穴分离和激发能对 $R$ 的弱依赖性是其标志。修正方案：改用范围分离杂化泛函，并通过非经验性调谐来满足电离势条件，和/或改用具有正确长程电子-空穴相互作用的方法，例如在格林函数乘以屏蔽库仑相互作用（$GW$）之上的 Bethe-Salpeter 方程。**\n*   **诊断**：从响应向量 $\\mathbf{X}$ 和 $\\mathbf{Y}$ 构建附着/脱附密度，或更普遍地，跃迁密度，是一种标准的分析工具。脱附密度 $\\rho_{\\text{det}}(\\mathbf{r}) = \\sum_{ia} | (X_{ia}+Y_{ia}) \\phi_i(\\mathbf{r}) \\phi_a^*(\\mathbf{r}) |^2$ 代表“空穴”，而附着密度 $\\rho_{\\text{att}}$ 代表“粒子”。对于 CT 态，这两种密度将分别局域在空间上分离的给体和受体部分。计算它们质心之间的距离可以提供电荷分离的定量度量。这一点，再加上观察到的能量对 $R$ 的弱依赖性，是对伪 CT 态的明确诊断。该诊断是可靠的。\n*   **修正方案**：范围分离杂化 (RSH) 泛函包含一部分非局域的 Hartree-Fock (精确) 交换，尤其是在长程。相应的 $f_{\\text{XC}}$ 核中的这种非局域性纠正了半局域泛函的渐近失效，恢复了分离物种的正确电子-空穴相互作用。调谐范围分离参数 $\\gamma$ 以满足条件 $\\epsilon_{\\text{HOMO}} = -\\text{IP}_{\\Delta\\text{SCF}}$ 是一种强制执行正确物理行为的稳健、非经验性的方法。基于 $GW$ 计算的准粒子能量构建的 Bethe-Salpeter 方程 (BSE) (BSE@$GW$) 是一种更严格的多体方法，它能正确描述屏蔽的电子-空穴相互作用，并为局域和 CT 激发提供准确的能量。这两种修正方案都是最有效和理论上最可靠的解决方案之一。\n*   **结论**：**正确**。\n\n**B. 通过比较长度规范和速度规范的振子强度来诊断缺失的双激发；显著的差异意味着存在双激发特性。修正方案：采用 Tamm-Dancoff 近似 (TDA)，因为它包含了双激发，而标准的 LR-TDDFT 则没有。**\n*   **诊断**：Thomas-Reiche-Kuhn 求和规则以及长度 ($f_L$) 和速度 ($f_V$) 规范中振子强度的等价性仅对于精确波函数或特定的近似理论才满足。虽然 $f_L$ 和 $f_V$ 之间的巨大差异表明计算中存在不足（例如，基组不完备、近似泛函），但这并不是针对状态双激发特性的特定诊断。任何被不良描述的状态，包括 CT 态，都可能表现出规范不一致性。这种诊断不可靠且不具特异性。\n*   **修正方案**：Tamm-Dancoff 近似 (TDA) 涉及将 Casida 方程中的 $\\mathbf{B}$ 矩阵设置为零，这是对完整 LR-TDDFT 的进一步近似。它简化了方程，但仍完全处于单激发空间内。声称 TDA “包含双激发”在根本上是错误的。TDA 并没有为缺失的双激发提供解决方案。\n*   **结论**：**不正确**。\n\n**C. 通过将大 $R$ 下计算的激发能与一个独立的、由总能量差得到的给体电离势和受体电子亲和能构建的估算值进行比较，来诊断电荷转移的低估；大的负偏差表明存在问题。修正方案：仅添加弥散基函数；仅此一项就能恢复正确的渐近电荷转移能量。**\n*   **诊断**：在大的分离距离 $R$ 下，基准 CT 能量为 $\\omega_{\\text{CT}} \\approx \\text{IP(D)} - \\text{EA(A)} - 1/R$。通过总能量差（$\\Delta$SCF 方法）计算 $\\text{IP(D)}$ 和 $\\text{EA(A)}$ 是 DFT 中一种可靠的程序。将 LR-TDDFT 激发能与此基准进行比较是一种极好且广泛使用的诊断方法。一个大的负偏差（$\\omega_{\\text{LR-TDDFT}} \\ll \\omega_{\\text{benchmark}}$）是半局域泛函失效的预期特征。该诊断是可靠的。\n*   **修正方案**：半局域 TDDFT 对 CT 态的失效是 XC 泛函本身的根本缺陷，而不是基组的问题。虽然任何涉及电荷分离或阴离子的精确计算都需要一个包含弥散函数的充足基组，但仅仅添加更多的基函数无法纠正 $f_{\\text{XC}}$ 的不正确函数形式。该修正方案存在缺陷，没有解决问题的根源。\n*   **结论**：**不正确**。\n\n**D. 通过分析 LR-TDDFT 响应向量的单粒子-单空穴成分，并与运动方程耦合簇单双激发 (EOM-CCSD) 或代数图解构造 (ADC) 进行交叉验证来诊断缺失的双激发；如果该状态主要由双粒子-双空穴特性主导，并且在绝热 LR-TDDFT 中缺失，那么它是由于频率无关的 XC 核而缺失的。修正方案：使用带有频率相关核的修饰含时密度泛函理论、用于双自由基的自旋翻转含时密度泛函理论，或处理双激发的相关波函数方法。**\n*   **诊断**：一个缺失的状态无法在使其缺失的方法内部进行分析。正确的程序，如所述，是使用一种已知能包含双激发的高级理论（如 EOM-CCSD 或 ADC($2$)）进行计算。如果一个状态出现在这些方法的谱中，但不在 LR-TDDFT 谱中，则可以从高级计算的振幅或本征向量中分析其特性。如果该分析揭示了主要的双激发（耦合簇中的 $T_2$，ADC 中的双粒子-双空穴）特性，则诊断得到证实。所提供的理由——频率无关（绝热）的 XC 核——确实是此失效的正确理论根源。该诊断是可靠的。\n*   **修正方案**：在 TDDFT 框架内，使用频率相关的核 $f_{\\text{XC}}(\\omega)$ 是包含双激发的形式上途径。像“修饰”TDDFT 这样的方法是为此所做的具体尝试。自旋翻转 TDDFT 重新定义了参考态，使得某些相对于闭壳层单重态是双激发的状态，可以从三重态参考被描述为单激发。最后，切换到相关波函数方法（如 EOM-CCSD、CASPT2 或 ADC）是一种直接且常见的解决方案。所有三种提议的修正方案都是有效的策略。\n*   **结论**：**正确**。\n\n**E. 通过泛函敏感性来诊断电荷转移与局域价激发特性：重新计算光谱，同时增加精确交换的比例；强烈的蓝移表示电荷转移特性，而局域价激发则不那么敏感。修正方案：采用范围分离杂化泛函，并通过非经验性调谐范围分离参数来强制执行正确的渐近势和电离势条件。**\n*   **诊断**：用杂化泛函描述的 CT 态的能量对精确 (Hartree-Fock) 交换的比例 $\\alpha$ 高度敏感。这是因为精确交换抵消了困扰半局域泛函的自相互作用误差，并且其非局域性对于描述分离的电荷至关重要。随着 $\\alpha$ 的增加，CT 态的伪稳定性被消除，其能量显著增加（蓝移）向正确值靠拢。电子和空穴重叠的局域价激发对 $\\alpha$ 的敏感性要小得多。这种差异敏感性是识别 CT 特性的一个强大而实用的启发式方法。该诊断是可靠的。\n*   **修正方案**：此修正方案与选项 A 中提出的相同。如前所述，使用 RSH 泛函，特别是经过调谐以满足像电离势定理这样的基本物理约束的泛函，是解决 TDDFT 中 CT 问题的首选方案。该修正方案是可靠的。\n*   **结论**：**正确**。\n\n总之，基于电子结构理论的第一性原理，选项 A、D 和 E 中的诊断-修正配对是有效的。", "answer": "$$\\boxed{ADE}$$", "id": "2932886"}, {"introduction": "在学习了如何诊断电荷转移（CT）激发问题后，我们知道范围分离杂化（RSH）泛函是关键的解决方案。本练习[@problem_id:2932958]旨在将这一理论知识具体化，通过编程实现一个简化的RSH核模型来计算CT激发能。你将亲眼见证该模型如何通过引入长程相互作用项，成功地修正了传统泛函所缺失的、至关重要的 $-1/R$ 渐进行为，从而将抽象的理论转化为可触摸的计算结果。", "problem": "给定一个双片段施主-受主体系，其中心间距为 $R$（以玻尔为单位）。施主的电离势为 $I$（以哈特里为单位），受主的电子亲和能为 $A$（以哈特里为单位）。在含时密度泛函理论（TDDFT）的线性响应范围内，使用 Tamm–Dancoff 近似（TDA）和一个由施主最高占据轨道到受主最低未占轨道的跃迁主导的单极点模型进行研究。假设片段不重叠，并且在基态下片段间的电子交换可以忽略不计。\n\n从线性响应 Kohn–Sham 理论的基本基础和核的定义出发，按以下步骤进行：\n- 使用 Kohn–Sham (KS) 独立粒子跃迁能作为基本带隙，即施主电离势与受主电子亲和能之差 $I - A$，作为独立粒子贡献。使用关于精确 Kohn–Sham 势和基本带隙的经过充分检验的事实来证明这一点。\n- 通过范围分离杂化（RSH）交换相关核引入电子-空穴相互作用，其特征在于参数 $\\mu$（单位为 bohr$^{-1}$）和 $f_{\\mathrm{LR}}$（无量纲）。参数 $\\mu$ 设定了短程和长程物理之间的分离长度标度，而 $f_{\\mathrm{LR}}$ 是在长程部分应用的精确交换的比例。通过结合独立粒子项和长程核贡献，在单极点、非重叠极限下，推导电荷转移激发能 $\\Omega_{\\mathrm{RSH}}(R;\\mu,f_{\\mathrm{LR}})$ 的闭合形式解析模型。将你的推导建立在库仑相互作用的标准范围分离恒等式以及长程核在距离 $R$ 处产生电子-空穴吸引的解释之上。\n- 将电荷转移激发的精确长程渐近线定义为原子单位下的 $\\Omega_{\\mathrm{exact}}(R) = I - A - 1/R$。解释为什么对于大距离 $R$ 处的非重叠片段，这是正确的渐近线。\n\n实现一个程序，对下面的每个测试用例计算：\n1. 范围分离杂化模型的激发能 $\\Omega_{\\mathrm{RSH}}$（以哈特里为单位）。\n2. 精确的长程渐近线 $\\Omega_{\\mathrm{exact}}$（以哈特里为单位）。\n3. 差值 $\\Delta = \\Omega_{\\mathrm{RSH}} - \\Omega_{\\mathrm{exact}}$（以哈特里为单位）。\n\n所有能量必须以哈特里表示，并四舍五入到六位小数。距离 $R$ 必须以玻尔为单位，不涉及角度。你的程序必须生成单行输出，其中包含一个以逗号分隔的列表的列表形式的结果，每个内部列表的形式为 $[\\Omega_{\\mathrm{RSH}}, \\Omega_{\\mathrm{exact}}, \\Delta]$，顺序与测试套件相同。例如：\"[[x1,y1,z1],[x2,y2,z2],...]\"。\n\n使用以下测试套件（每个元组为 $(I, A, R, \\mu, f_{\\mathrm{LR}})$，其中 $I$ 和 $A$ 的单位是哈特里，$R$ 的单位是玻尔，$\\mu$ 的单位是 bohr$^{-1}$，$f_{\\mathrm{LR}}$ 是无量纲的）：\n- 案例 $1$（接近渐近分离且具有完整长程精确交换的理想情况）：$(\\,0.5,\\,0.1,\\,10.0,\\,0.3,\\,1.0\\,)$。\n- 案例 $2$（与案例 1 相同，但没有长程精确交换，以测试已知的缺陷）：$(\\,0.5,\\,0.1,\\,10.0,\\,0.3,\\,0.0\\,)$。\n- 案例 $3$（中等分离距离，大的 $\\mu$ 值导致有效的完整长程行为）：$(\\,0.6,\\,0.05,\\,3.0,\\,2.0,\\,1.0\\,)$。\n- 案例 $4$（短分离距离，以探究渐近模型的失效）：$(\\,0.6,\\,0.05,\\,1.0,\\,0.3,\\,1.0\\,)$。\n- 案例 $5$（部分长程精确交换）：$(\\,0.45,\\,0.2,\\,7.5,\\,0.5,\\,0.7\\,)$。\n\n你的程序应该生成单行输出，其中包含一个以方括号括起来的逗号分隔列表的结果（例如：\"[[result11,result12,result13],[result21,result22,result23],...]\"）。每个结果必须是四舍五入到六位小数的浮点数。", "solution": "问题陈述经过验证，被认为是有效的。它在科学上基于含时密度泛函理论（TDDFT）的原理，问题设定良好，提供了所有必要信息，并且表述客观。它需要一个非平凡的推导和随后的数值实现，构成了一个合法的科学问题。\n\n我们继续进行推导和求解。\n\n核心任务是为施主-受主体系中的最低电荷转移（CT）激发能 $\\Omega$ 建模。我们在 Tamm-Dancoff 近似（TDA）下，于线性响应 TDDFT 框架内进行工作。对于一个由占据轨道 $i$ 到虚拟轨道 $a$ 的单次跃迁主导的体系，激发能 $\\Omega$ 的 TDA 方程简化为：\n$$\n\\Omega = \\omega_{ia} + K_{ia,ia}\n$$\n这里，$\\omega_{ia} = \\epsilon_a - \\epsilon_i$ 是来自基态 Kohn-Sham (KS) 计算的轨道能级差，其中 $\\epsilon_i$ 是施主最高占据分子轨道（HOMO）的能量，$\\epsilon_a$ 是受主最低未占分子轨道（LUMO）的能量。$K_{ia,ia}$ 项是考虑了电子-空穴相互作用的耦合矩阵元。\n\n首先，我们处理独立粒子项 $\\omega_{ia}$。问题陈述要求使用基本带隙 $I - A$ 作为此项。通过考虑所涉物理量的物理意义，这一点是合理的。电离势 $I$ 是从施主移除一个电子所需的能量，$D \\rightarrow D^+ + e^-$。电子亲和能 $A$ 是一个电子附着到受主时释放的能量，$A + e^- \\rightarrow A^-$。因此，在无限分离的条件下，从中性对 $D \\dots A$ 创建一个分离的离子对 $D^+ \\dots A^-$ 所需的能量恰好是 $I - A$。在精确 KS 理论的背景下，体系的 HOMO 能量等于其电离势的负值，即 $\\epsilon_{\\mathrm{HOMO}} = -I$。虽然 LUMO 能量通常不以同样简单的方式与电子亲和能相关联，但对于大分离距离下的双片段体系，KS 轨道能级差 $\\epsilon_a - \\epsilon_i$ 趋近于 $I_D - A_A$。因此，近似 $\\omega_{ia} \\approx I - A$ 是建立 CT 激发模型的一个物理上合理的出发点。\n\n其次，我们推导相互作用项 $K_{ia,ia}$。该项源于交换相关核 $f_{xc}$ 和 Hartree 势。在 TDA 内部，耦合矩阵元为：\n$$\nK_{ia,ia} = \\iint \\phi_i^*(\\mathbf{r}_1)\\phi_a(\\mathbf{r}_1) \\left( \\frac{1}{|\\mathbf{r}_1 - \\mathbf{r}_2|} + f_{xc}(\\mathbf{r}_1, \\mathbf{r}_2) \\right) \\phi_i(\\mathbf{r}_2)\\phi_a^*(\\mathbf{r}_2) \\, d\\mathbf{r}_1 d\\mathbf{r}_2\n$$\n对于非重叠片段之间的 CT 激发，跃迁密度 $\\phi_i^*(\\mathbf{r})\\phi_a(\\mathbf{r})$ 基本上处处为零。对于传统的（半）局域密度泛函，其中 $f_{xc}$ 是密度的局域或半局域函数，这导致整个耦合项 $K_{ia,ia}$ 消失。这导致了此类泛函众所周知的失败，其预测 $\\Omega_{\\mathrm{CT}} \\approx I - A$，且与分离距离 $R$ 无关。\n\n范围分离杂化（RSH）泛函通过引入一部分非局域的精确（Hartree-Fock）交换来纠正这一缺陷，尤其是在长程部分。RSH 泛函的交换相关核包含一个源自精确交换算符的长程分量。精确交换对耦合矩阵的贡献由下式给出：\n$$\nK_{ia,ia}^{\\mathrm{x}} = - \\iint \\phi_i^*(\\mathbf{r}_1)\\phi_a(\\mathbf{r}_1) \\left( f_{\\mathrm{LR}} \\frac{\\mathrm{erf}(\\mu|\\mathbf{r}_1 - \\mathbf{r}_2|)}{|\\mathbf{r}_1 - \\mathbf{r}_2|} \\right) \\phi_a^*(\\mathbf{r}_2)\\phi_i(\\mathbf{r}_2) \\, d\\mathbf{r}_1 d\\mathbf{r}_2\n$$\n这是交换积分，通常表示为 $-(ia|ai)$。由于轨道 $i$ 和 $a$ 的非重叠性质，该积分计算的是由交换算符的长程部分所介导的、在空穴密度 $|\\phi_i(\\mathbf{r}_1)|^2$ 和电子密度 $|\\phi_a(\\mathbf{r}_2)|^2$ 之间的库仑吸引。\n$$\nK_{ia,ia} \\approx - f_{\\mathrm{LR}} \\iint |\\phi_i(\\mathbf{r}_1)|^2 \\left( \\frac{\\mathrm{erf}(\\mu|\\mathbf{r}_1 - \\mathbf{r}_2|)}{|\\mathbf{r}_1 - \\mathbf{r}_2|} \\right) |\\phi_a(\\mathbf{r}_2)|^2 \\, d\\mathbf{r}_1 d\\mathbf{r}_2\n$$\n对于以较大中心间距 $R$ 分离的片段，我们可以将空穴和电子密度近似为位于各自片段中心的点电荷。在此近似下，$|\\mathbf{r}_1 - \\mathbf{r}_2| \\approx R$，积分简化为：\n$$\nK_{ia,ia} \\approx -f_{\\mathrm{LR}} \\frac{\\mathrm{erf}(\\mu R)}{R}\n$$\n结合独立粒子项和相互作用项，我们得到了 RSH 电荷转移激发能的闭合形式模型：\n$$\n\\Omega_{\\mathrm{RSH}}(R; \\mu, f_{\\mathrm{LR}}) = I - A - f_{\\mathrm{LR}} \\frac{\\mathrm{erf}(\\mu R)}{R}\n$$\n\n第三，我们确定 CT 激发能的正确渐近形式。对于在较大分离距离 $R$ 处的两个非重叠片段，从中性基态 $DA$ 创建 CT 态 $D^+A^-$ 所需的能量可以由基本物理原理确定。该过程包括两个步骤：首先，在无限分离处生成离子对，这需要能量 $I - A$；其次，将点状离子 $D^+$ 和 $A^-$ 从无穷远处带到分离距离 $R$ 处，这会释放库仑吸引能。在原子单位（能量为哈特里，距离为玻尔）中，这个静电能是 $-1/R$。因此，总能量为：\n$$\n\\Omega_{\\mathrm{exact}}(R) = I - A - \\frac{1}{R}\n$$\n这是一个正确的理论必须恢复的精确渐近极限。我们推导的 RSH 模型在 $f_{\\mathrm{LR}}=1$ 且 $\\mu R \\gg 1$ 时可以做到这一点，因为当 $x \\to \\infty$ 时 $\\mathrm{erf}(x) \\to 1$。\n\n最后，模型与精确渐近线之间的差值 $\\Delta$ 是：\n$$\n\\Delta = \\Omega_{\\mathrm{RSH}} - \\Omega_{\\mathrm{exact}} = \\left( I - A - f_{\\mathrm{LR}} \\frac{\\mathrm{erf}(\\mu R)}{R} \\right) - \\left( I - A - \\frac{1}{R} \\right) = \\frac{1}{R} - f_{\\mathrm{LR}} \\frac{\\mathrm{erf}(\\mu R)}{R}\n$$\n\n该实现将为每个测试用例计算以下三个量：\n1.  $\\Omega_{\\mathrm{RSH}} = I - A - f_{\\mathrm{LR}} \\frac{\\mathrm{erf}(\\mu R)}{R}$\n2.  $\\Omega_{\\mathrm{exact}} = I - A - \\frac{1}{R}$\n3.  $\\Delta = \\frac{1}{R} \\left( 1 - f_{\\mathrm{LR}} \\, \\mathrm{erf}(\\mu R) \\right)$\n\n所有计算均在原子单位（哈特里和玻尔）下进行。", "answer": "```python\nimport numpy as np\nfrom scipy.special import erf\n\ndef solve():\n    \"\"\"\n    Computes charge-transfer excitation energies for a donor-acceptor system\n    using a simplified TDDFT model and compares them to the exact asymptote.\n    \"\"\"\n\n    # Test suite: (I, A, R, mu, f_LR)\n    # I: Ionization potential (Hartree)\n    # A: Electron affinity (Hartree)\n    # R: Donor-acceptor distance (bohr)\n    # mu: Range-separation parameter (bohr^{-1})\n    # f_LR: Fraction of long-range exact exchange (dimensionless)\n    test_cases = [\n        (0.5, 0.1, 10.0, 0.3, 1.0),\n        (0.5, 0.1, 10.0, 0.3, 0.0),\n        (0.6, 0.05, 3.0, 2.0, 1.0),\n        (0.6, 0.05, 1.0, 0.3, 1.0),\n        (0.45, 0.2, 7.5, 0.5, 0.7),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        I, A, R, mu, f_LR = case\n\n        # Ensure R is not zero to avoid division by zero\n        if R == 0:\n            raise ValueError(\"Distance R must be positive.\")\n\n        # Independent-particle energy (fundamental gap)\n        # This is the energy to create the ion pair at infinite separation.\n        omega_ia = I - A\n\n        # Calculate Omega_RSH using the derived model\n        # Omega_RSH = I - A - f_LR * erf(mu * R) / R\n        interaction_term_rsh = f_LR * erf(mu * R) / R\n        omega_rsh = omega_ia - interaction_term_rsh\n\n        # Calculate the exact long-range asymptotic energy\n        # Omega_exact = I - A - 1/R\n        interaction_term_exact = 1.0 / R\n        omega_exact = omega_ia - interaction_term_exact\n\n        # Calculate the difference Delta\n        # Delta = Omega_RSH - Omega_exact\n        delta = omega_rsh - omega_exact\n\n        # Round all results to six decimal places\n        rounded_omega_rsh = round(omega_rsh, 6)\n        rounded_omega_exact = round(omega_exact, 6)\n        rounded_delta = round(delta, 6)\n\n        results.append([rounded_omega_rsh, rounded_omega_exact, rounded_delta])\n\n    # Format the output string as a list of lists.\n    # e.g., \"[[result11,result12,result13],[result21,result22,result23],...]\"\n    output_str = \"[\" + \",\".join([f\"[{r[0]:.6f},{r[1]:.6f},{r[2]:.6f}]\" for r in results]) + \"]\"\n    \n    print(output_str)\n\nsolve()\n```", "id": "2932958"}]}