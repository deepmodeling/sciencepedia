{"hands_on_practices": [{"introduction": "在深入研究振动光谱的复杂性之前，我们必须首先掌握其最核心的理论模型。这个练习将引导你从第一性原理出发，推导在理想化的移位谐振子模型中，振动跃迁的强度分布规律。通过运用产生和湮灭算符的代数方法，你将亲手揭示弗兰克-康登（Franck-Condon）谱带强度遵循泊松分布的量子力学本质，为后续更复杂的分析奠定坚实的数学和概念基础 [@problem_id:2929680]。", "problem": "一个双原子分子发生电子吸收，从一个势能面近似为一维谐振子的电子基态跃迁到一个同样近似为一维谐振子的电子激发态。设约化质量为 $\\mu$，并假设两个电子态具有相同的谐振频率 $\\omega$ 且满足玻恩-奥本海默 (Born–Oppenheimer) 近似。基态的平衡键长为 $R_{e}''$，激发态的平衡键长为 $R_{e}'$，且 $R_{e}' < R_{e}''$（即，激发后平衡键长缩短）。该跃迁在 Franck–Condon (FC) 意义上是垂直的，并且 Condon 近似（即电子跃迁偶极矩与核坐标无关）适用。\n\n仅从以下几点出发：\n- FC 因子是核波函数重叠积分平方的定义，\n- 谐振子本征函数的形式，以及\n- 谐振子的正则对易关系，\n\n推导从基态振动能级 $v''=0$ 跃迁到激发态振动能流形 $v'=n$ 的解析、归一化的相对强度模式，将其表示为关于末态振动量子数 $n \\in \\{0,1,2,\\dots\\}$ 和两个谐振子势阱极小值点之间的无量纲位移的闭合形式函数 $I(n)$。你的最终答案应仅用 Huang–Rhys 因子 $S$ 表示，其中 $S$ 由物理参数定义为\n$$\nS \\equiv \\frac{\\mu\\,\\omega}{2\\hbar}\\,\\Delta R^{2}, \\quad \\Delta R \\equiv R_{e}''-R_{e}'.\n$$\n在推导过程中解释，为什么激发时平衡键长的缩短会导致一个振动电子跃迁谱带，其包络相对于光子能量中的 $0$–$0$ 谱线发生位移，并指出包络最大值的位置如何依赖于 $S$。你无需报告数值。请以单个闭合形式解析表达式 $I(n)$ 的形式给出最终答案，用 $S$ 表示。最终表达式中不需要单位，也无需进行舍入。", "solution": "所述问题具有科学依据、良定且客观。它提出了一个理论分子光谱学中的标准、可形式化的问题。所有必要的物理参数和数学约束均已提供。该问题是有效的，并将提供解答。\n\n从初态 $|\\Psi_{i}\\rangle$ 到末态 $|\\Psi_{f}\\rangle$ 的振动电子跃迁的相对强度 $I$ 与跃迁偶极矩积分的模平方成正比：\n$$\nI \\propto |\\langle \\Psi_f | \\hat{\\vec{\\mu}} | \\Psi_i \\rangle|^2\n$$\n其中 $\\hat{\\vec{\\mu}}$ 是电偶极算符。初态是电子基态和振动基态，即 $|\\Psi_i\\rangle = |\\Psi_g''\\rangle|\\chi_0''\\rangle$，其中 $v''=0$。末态处于电子激发态和第 $n$ 个振动能级，即 $|\\Psi_f\\rangle = |\\Psi_e'\\rangle|\\chi_n'\\rangle$，其中 $v'=n$。\n\n在玻恩-奥本海默近似下，总波函数可分离为电子和核部分。跃迁偶极矩变为：\n$$\n\\langle \\Psi_e'\\chi_n' | \\hat{\\vec{\\mu}} | \\Psi_g''\\chi_0'' \\rangle = \\langle \\chi_n' | \\langle \\Psi_e' | \\hat{\\vec{\\mu}} | \\Psi_g'' \\rangle_r | \\chi_0'' \\rangle_R\n$$\n其中内部积分是对电子坐标 $r$ 进行的，而外部积分是对核坐标 $R$ 进行的。Condon 近似指出，电子跃迁偶极矩 $\\vec{M}_{e'g''} (R) = \\langle \\Psi_e' | \\hat{\\vec{\\mu}} | \\Psi_g'' \\rangle_r$ 与核坐标 $R$ 无关。因此，它可以被视为一个常数并从核积分中提出：\n$$\nI(0 \\to n) \\propto |\\vec{M}_{e'g''}|^2 |\\langle \\chi_n' | \\chi_0'' \\rangle|^2\n$$\n核波函数的重叠积分平方 $|\\langle \\chi_n' | \\chi_0'' \\rangle|^2$ 是 Franck-Condon 因子 (FCF)。问题要求的是归一化的相对强度模式，对于从单一初态出发的跃迁，这等于每个末态 $n$ 的 FCF，并由所有可能末态的总和进行归一化：\n$$\nI(n) = \\frac{|\\langle \\chi_n' | \\chi_0'' \\rangle|^2}{\\sum_{k=0}^{\\infty} |\\langle \\chi_k' | \\chi_0'' \\rangle|^2}\n$$\n\n我们将两个势能面都建模为具有相同频率 $\\omega$ 但平衡位置不同的一维谐振子。设核坐标为 $x$。我们将原点设置在电子基态的平衡位置 $R_e''$ 处。因此，基态势能为 $V''(x) = \\frac{1}{2}\\mu\\omega^2 x^2$。激发态的平衡位置在 $R_e' < R_e''$。位移为 $\\Delta R = R_e'' - R_e' > 0$。激发态的势能极小值点在 $x_e' = R_e' - R_e'' = -\\Delta R$。其势能为 $V'(x) = \\frac{1}{2}\\mu\\omega^2(x-x_e')^2 = \\frac{1}{2}\\mu\\omega^2(x+\\Delta R)^2$。\n\n我们按照要求，使用梯算符的代数方法进行推导。\n\n对于由哈密顿量 $\\hat{H}'' = \\frac{\\hat{p}^2}{2\\mu} + \\frac{1}{2}\\mu\\omega^2 \\hat{x}^2$ 描述的基态振子，我们定义湮灭和产生算符：\n$$\n\\hat{a} = \\sqrt{\\frac{\\mu\\omega}{2\\hbar}}\\hat{x} + i\\frac{1}{\\sqrt{2\\mu\\hbar\\omega}}\\hat{p}\n$$\n$$\n\\hat{a}^\\dagger = \\sqrt{\\frac{\\mu\\omega}{2\\hbar}}\\hat{x} - i\\frac{1}{\\sqrt{2\\mu\\hbar\\omega}}\\hat{p}\n$$\n这些算符满足 $[\\hat{a}, \\hat{a}^\\dagger] = 1$。振动基态 $|\\chi_0''\\rangle$ 是该振子的真空态，由 $\\hat{a}|\\chi_0''\\rangle = 0$ 定义。\n\n对于哈密顿量为 $\\hat{H}' = \\frac{\\hat{p}^2}{2\\mu} + \\frac{1}{2}\\mu\\omega^2 (\\hat{x}+\\Delta R)^2$ 的激发态振子，我们定义一组新的梯算符。设位移后的坐标为 $\\hat{x}' = \\hat{x} + \\Delta R$。动量算符 $\\hat{p}$ 不变。新的算符为：\n$$\n\\hat{b} = \\sqrt{\\frac{\\mu\\omega}{2\\hbar}}\\hat{x}' + i\\frac{1}{\\sqrt{2\\mu\\hbar\\omega}}\\hat{p} = \\sqrt{\\frac{\\mu\\omega}{2\\hbar}}(\\hat{x}+\\Delta R) + i\\frac{1}{\\sqrt{2\\mu\\hbar\\omega}}\\hat{p}\n$$\n$$\n\\hat{b}^\\dagger = \\sqrt{\\frac{\\mu\\omega}{2\\hbar}}\\hat{x}' - i\\frac{1}{\\sqrt{2\\mu\\hbar\\omega}}\\hat{p} = \\sqrt{\\frac{\\mu\\omega}{2\\hbar}}(\\hat{x}+\\Delta R) - i\\frac{1}{\\sqrt{2\\mu\\hbar\\omega}}\\hat{p}\n$$\n这些算符也满足 $[\\hat{b}, \\hat{b}^\\dagger] = 1$。激发电子态的振动本征态是 $|\\chi_n'\\rangle$，其中 $|\\chi_n'\\rangle = \\frac{(\\hat{b}^\\dagger)^n}{\\sqrt{n!}}|\\chi_0'\\rangle$，且 $\\hat{b}|\\chi_0'\\rangle = 0$。\n\n我们通过将 $\\hat{a}$ 的定义代入 $\\hat{b}$ 的表达式中来关联这两组算符：\n$$\n\\hat{b} = \\left(\\sqrt{\\frac{\\mu\\omega}{2\\hbar}}\\hat{x} + i\\frac{1}{\\sqrt{2\\mu\\hbar\\omega}}\\hat{p}\\right) + \\sqrt{\\frac{\\mu\\omega}{2\\hbar}}\\Delta R = \\hat{a} + \\sqrt{\\frac{\\mu\\omega}{2\\hbar}}\\Delta R\n$$\n我们将无量纲位移参数与 Huang-Rhys 因子等同起来，即 $S = \\frac{\\mu\\omega}{2\\hbar}(\\Delta R)^2$。令 $\\alpha = \\sqrt{S} = \\sqrt{\\frac{\\mu\\omega}{2\\hbar}}\\Delta R$。由于 $\\Delta R > 0$，$\\alpha$ 是实数且为正。算符关系为：\n$$\n\\hat{b} = \\hat{a} + \\sqrt{S}, \\quad \\hat{b}^\\dagger = \\hat{a}^\\dagger + \\sqrt{S}\n$$\n由此，我们可以反解出 $\\hat{a} = \\hat{b} - \\sqrt{S}$。\n初态 $|\\chi_0''\\rangle$ 满足 $\\hat{a}|\\chi_0''\\rangle = 0$。代入 $\\hat{a}$ 的表达式：\n$$\n(\\hat{b} - \\sqrt{S})|\\chi_0''\\rangle = 0 \\implies \\hat{b}|\\chi_0''\\rangle = \\sqrt{S}|\\chi_0''\\rangle\n$$\n这是一个深刻的结果：电子基态的振动基态 $|\\chi_0''\\rangle$ 是电子激发态的湮灭算符 $\\hat{b}$ 的一个本征态。这意味着 $|\\chi_0''\\rangle$ 是激发态谐振子的一个相干态，其本征值为 $\\sqrt{S}$。\n\n一个由 $\\hat{b}|\\alpha\\rangle = \\alpha|\\alpha\\rangle$ 定义的归一化相干态 $|\\alpha\\rangle$ 可以在数基 $|n\\rangle$（此处为态 $|\\chi_n'\\rangle$）中展开为：\n$$\n|\\alpha\\rangle = \\exp(-\\frac{1}{2}|\\alpha|^2) \\sum_{n=0}^{\\infty} \\frac{\\alpha^n}{\\sqrt{n!}}|n\\rangle\n$$\n将此应用于我们的情况，其中态为 $|\\chi_0''\\rangle$，本征值为 $\\alpha = \\sqrt{S}$：\n$$\n|\\chi_0''\\rangle = \\exp(-\\frac{1}{2}(\\sqrt{S})^2) \\sum_{n=0}^{\\infty} \\frac{(\\sqrt{S})^n}{\\sqrt{n!}}|\\chi_n'\\rangle = \\exp(-S/2) \\sum_{n=0}^{\\infty} \\frac{S^{n/2}}{\\sqrt{n!}}|\\chi_n'\\rangle\n$$\n这个表达式给出了初态 $|\\chi_0''\\rangle$ 在末态振动正交归一基 $|\\chi_n'\\rangle$ 中的分解。重叠积分 $\\langle \\chi_n'|\\chi_0''\\rangle$ 可以通过向特定态 $\\langle\\chi_n'|$ 投影直接获得：\n$$\n\\langle \\chi_n' | \\chi_0'' \\rangle = \\exp(-S/2) \\frac{S^{n/2}}{\\sqrt{n!}}\n$$\nFranck-Condon 因子是此重叠积分的模平方：\n$$\nFCF(0 \\to n) = |\\langle \\chi_n' | \\chi_0'' \\rangle|^2 = \\left(\\exp(-S/2) \\frac{S^{n/2}}{\\sqrt{n!}}\\right)^2 = \\exp(-S) \\frac{S^n}{n!}\n$$\n这个结果是一个关于量子数 $n$ 的泊松分布，其均值为 $S$。为了找到归一化的强度 $I(n)$，我们必须用所有 FCF 的总和来除。基 $|\\chi_n'\\rangle$ 的完备性意味着概率总和必须为 1：\n$$\n\\sum_{n=0}^{\\infty}|\\langle \\chi_n' | \\chi_0'' \\rangle|^2 = \\langle\\chi_0'' | \\left(\\sum_{n=0}^{\\infty} |\\chi_n'\\rangle\\langle\\chi_n'|\\right) |\\chi_0''\\rangle = \\langle\\chi_0''|\\hat{1}|\\chi_0''\\rangle = 1\n$$\n或者，直接对我们推导出的表达式求和：\n$$\n\\sum_{n=0}^{\\infty} \\exp(-S) \\frac{S^n}{n!} = \\exp(-S) \\sum_{n=0}^{\\infty} \\frac{S^n}{n!} = \\exp(-S) \\exp(S) = 1\n$$\n由于总和为 1，归一化的相对强度与 Franck-Condon 因子相同：\n$$\nI(n) = \\exp(-S) \\frac{S^n}{n!}\n$$\n这就是强度模式的闭合形式解析表达式。\n\n现在，我们来讨论其物理解释。Franck-Condon 原理指出电子跃迁是“垂直的”，意味着它们发生的时间尺度远快于核运动，因此在跃迁过程中核位置不发生改变。分子起始于 $v''=0$ 态，其核概率分布 $|\\chi_0''(x)|^2$ 在平衡几何构型 $x=0$（或 $R=R_e''$）处达到峰值。这个分布被垂直投影到激发态势能面 $V'(x)$ 上。对于那些在 $x=0$ 附近区域具有显著波函数振幅的末态 $|\\chi_n'\\rangle$，其重叠积分 $|\\langle \\chi_n'|\\chi_0''\\rangle|$ 最大。\n\n由于激发态势阱的极小值点发生了位移（$R_e' < R_e''$，因此 $\\Delta R > 0$ 且 $S > 0$），$x=0$ 点并不对应于 $V'(x)$ 的极小值点，而是其排斥壁上的一个点。激发态振子的基态 $|\\chi_0'\\rangle$ 以 $x=-\\Delta R$ 为中心，在 $x=0$ 处的振幅很小。因此，0-0 跃迁（$n=0$）将会很弱。激发态中较高 $n$ 值的振动波函数 $|\\chi_n'\\rangle$ 在经典转折点附近具有最大振幅。对于跃迁到某个态 $v'=n$ 而言，如果其转折点靠近基态平衡几何构型 $x=0$，则强度将达到最大。\n\n最大强度的位置可以通过考察泊松分布 $I(n) = e^{-S}S^n/n!$ 来找到。为了找到最大值，我们考虑连续项的比率：$I(n)/I(n-1) = S/n$。只要 $S/n > 1$（即 $n < S$），强度就随 $n$ 增加。当 $n > S$ 时，强度减小。因此，强度包络的最大值出现在约等于 $S$ 的整数 $n$ 处。对于非整数的 $S$，最大值在 $n = \\lfloor S \\rfloor$ 处。这意味着更大的位移 $\\Delta R$（以及因此更大的 Huang-Rhys 因子 $S$）会导致更长的振动电子跃迁谱带，其最强峰会离 0-0 电子跃迁原点更远。吸收包络最大值在光子能量上偏离 0-0 谱线，是电子激发时平衡键长变化的直接结果。如果没有键长变化（$\\Delta R=0$），那么 $S=0$，且 $I(n) = \\delta_{n0}$，这意味着只能观察到 0-0 跃迁。", "answer": "$$\n\\boxed{\\exp(-S) \\frac{S^n}{n!}}\n$$", "id": "2929680"}, {"introduction": "理想模型为我们提供了简洁的图像，但真实分子的行为往往更为复杂。这个练习旨在挑战前一个练习中的核心假设之一：即电子激发前后振动频率保持不变。通过分析频率失配（$\\omega_e \\neq \\omega_g$）对弗兰克-康登因子的影响，你将探索宇称选择定则的出现、谱线包络的偏移和偏斜等重要现象，从而建立起对真实光谱更为精确的直觉 [@problem_id:2929619]。", "problem": "考虑一个一维简正坐标 $Q$（质量加权），它描述了一个在基态电子态和激发电子态之间的电子跃迁中活跃的单全对称振动模式。基态势能是谐振的，频率为 $\\omega_g$，最小值在 $Q=0$ 处，即 $V_g(Q)=\\tfrac{1}{2}\\,M\\,\\omega_g^2\\,Q^2$。激发态势能是谐振的，频率为 $\\omega_e$，最小值在 $Q=\\Delta Q$ 处，即 $V_e(Q)=E_{\\mathrm{vert}}+\\tfrac{1}{2}\\,M\\,\\omega_e^2\\,(Q-\\Delta Q)^2$，其中 $M$ 是该模式的有效质量，$E_{\\mathrm{vert}}$ 是一个不影响 Franck–Condon 因子的常数偏移。假设 Born–Oppenheimer 近似、Condon 近似（跃迁偶极矩与 $Q$ 无关），以及电子态之间简正坐标没有旋转（即 Duschinsky 旋转是单位矩阵）。将基态的谐振子振动本征态表示为 $\\lvert n_g\\rangle$，激发态的表示为 $\\lvert n_e\\rangle$，相应的坐标空间波函数表示为 $\\chi_n^{(g)}(Q)$ 和 $\\chi_n^{(e)}(Q)$。\n\n$0\\to n$ 跃迁的 Franck–Condon (FC) 因子为 $I_n=\\lvert\\langle n_e\\vert 0_g\\rangle\\rvert^2=\\left|\\int_{-\\infty}^{\\infty}\\chi_n^{(e)}(Q)\\,\\chi_0^{(g)}(Q)\\,dQ\\right|^2$。在 $\\omega_e=\\omega_g$（曲率相等）的特殊情况下，众所周知的位移谐振子极限会产生一个关于 $n$ 的泊松级数，其特征由 Huang–Rhys 参数 $S=(M\\,\\omega_g\\,\\Delta Q^2)/(2\\hbar)$ 决定。\n\n现在分析当激发态频率与基态频率不同（$\\omega_e\\neq \\omega_g$），但保持“简正坐标无旋转”的假设时，FC 因子如何变化。下列陈述中哪些是正确的？选择所有适用项。\n\nA. 当 $\\omega_e\\neq \\omega_g$ 但简正坐标没有旋转时，集合 $\\{I_n\\}$ 仍然是均值为 $S=(M\\,\\omega_g\\,\\Delta Q^2)/(2\\hbar)$ 的精确泊松分布，因此 $I_{n+1}/I_n=S/(n+1)$ 与 $n$ 无关。\n\nB. 如果 $\\Delta Q=0$ 但 $\\omega_e\\neq \\omega_g$，宇称性意味着对于所有奇数 $n$，$\\langle n_e\\vert 0_g\\rangle=0$，因此只有偶数 $n$ 的振动能级才有从基态振动能级跃迁而来的非零 FC 振幅。\n\nC. 对于 $\\Delta Q\\neq 0$ 和 $\\omega_e\\neq \\omega_g$ 的情况，$\\{I_n\\}$ 的包络相对于等频率情况通常是偏斜的：当 $\\omega_e>\\omega_g$ 时，最强跃迁会移动到比等频率 Huang–Rhys 预测值更大的 $n$；当 $\\omega_e<\\omega_g$ 时，则移动到更小的 $n$。\n\nD. 对于固定的 $\\Delta Q\\neq 0$，引入频率失配（$\\omega_e\\neq \\omega_g$）必然会相对于等频率情况（$\\omega_e=\\omega_g$）降低“零声子”强度 $I_0=\\lvert\\langle 0_e\\vert 0_g\\rangle\\rvert^2$。\n\nE. 在具有多个独立模式且简正坐标无旋转（Duschinsky 矩阵为单位矩阵）的多维推广中，总 FC 因子可分解为各模式的乘积；如果任何频率比 $\\omega_{e,k}/\\omega_{g,k}$ 不为 1，那么这些模式的 $0\\to n_k$ 分布就不是泊松分布，因此除非所有的 $\\omega_{e,k}=\\omega_{g,k}$，否则多维强度模式不是泊松分布的乘积。", "solution": "问题陈述已经过验证，被认为是有效的。所提出的物理模型涉及两个可能具有不同频率的位移谐振子，是分子光谱学中一个标准且适定的问题。各项假设（Born-Oppenheimer、Condon、无 Duschinsky 旋转）都已明确说明。在将 $Q$ 标准地解释为具有有效质量 $M$ 的简正坐标的前提下，势能、波函数和 Franck-Condon 因子的数学形式是正确的。我们可以开始解答。\n\n问题要求评估当基态（$\\omega_g$）和激发态（$\\omega_e$）电子态的振动频率不同时（即 $\\omega_e \\neq \\omega_g$），关于振动电子跃迁的 Franck-Condon (FC) 因子 $I_n=\\lvert\\langle n_e\\vert 0_g\\rangle\\rvert^2$ 行为的几个陈述。\n\n**选项 A 分析**\n\n这个陈述声称，对于 $\\omega_e\\neq \\omega_g$ 的情况，FC 因子 $\\{I_n\\}$ 仍然服从泊松分布。FC 因子的泊松分布 $I_n = e^{-S}S^n/n!$ 是一个特定的结果，它出现在一个简化的模型中，其中两个谐振势在形状上相同（$\\omega_e=\\omega_g$），但其最小值位置有位移（$\\Delta Q \\neq 0$）。这个结果的推导依赖于升降算符的使用，以及由于频率相同，激发态基矢可以相对简单地用基态基矢表示（反之亦然）这一事实。当 $\\omega_e \\neq \\omega_g$ 时，谐振子波函数的尺度参数 $\\alpha_g = \\sqrt{M\\omega_g/\\hbar}$ 和 $\\alpha_e = \\sqrt{M\\omega_e/\\hbar}$ 是不同的。这从根本上改变了重叠积分 $\\langle n_e\\vert 0_g\\rangle$ 的性质。得到的强度分布已知会显著偏离泊松形式。对于 $\\omega_e \\neq \\omega_g$ 的情况，存在重叠积分的递推关系，但它们比简单的关系式 $I_{n+1}/I_n=S/(n+1)$ 更复杂，并且不会产生泊松分布。声称分布保持*精确*的泊松分布是错误的。\n\n结论：**错误**。\n\n**选项 B 分析**\n\n这个陈述考虑的是没有位移（$\\Delta Q=0$）但频率不同（$\\omega_e\\neq \\omega_g$）的情况。势能为 $V_g(Q) = \\frac{1}{2} M \\omega_g^2 Q^2$ 和 $V_e(Q) = E_{\\mathrm{vert}} + \\frac{1}{2} M \\omega_e^2 Q^2$。两个势能都相对于原点 $Q=0$ 对称。它们是偶函数：$V(Q)=V(-Q)$。\n对称一维势的本征函数必须具有确定的宇称（偶或奇）。谐振子波函数 $\\chi_n(Q)$ 的宇称为 $(-1)^n$。\n基态波函数是 $\\chi_0^{(g)}(Q)$，对应于 $n=0$。它是一个偶函数。\n激发态波函数是 $\\chi_n^{(e)}(Q)$，当 $n$ 为偶数时是偶函数，当 $n$ 为奇数时是奇函数。\nFranck-Condon 振幅是重叠积分 $\\langle n_e\\vert 0_g\\rangle = \\int_{-\\infty}^{\\infty} \\chi_n^{(e)}(Q) \\chi_0^{(g)}(Q) dQ$。\n被积函数是 $\\chi_n^{(e)}(Q)$ 和 $\\chi_0^{(g)}(Q)$ 的乘积。\n- 如果 $n$ 是偶数，$\\chi_n^{(e)}(Q)$ 是偶函数。被积函数是 (偶函数) $\\times$ (偶函数) = 偶函数。一个非平凡的偶函数在对称区间 $[-\\infty, \\infty]$ 上的积分通常不为零。\n- 如果 $n$ 是奇数，$\\chi_n^{(e)}(Q)$ 是奇函数。被积函数是 (奇函数) $\\times$ (偶函数) = 奇函数。一个奇函数在对称区间 $[-\\infty, \\infty]$ 上的积分恒为零。\n因此，对于所有奇数 $n$，$\\langle n_e\\vert 0_g\\rangle = 0$。这意味着对于奇数 $n$，FC 因子 $I_n$ 为零。从振动基态只允许跃迁到激发态的偶数振动能级。这是一个基于宇称性的严格选择定则。\n\n结论：**正确**。\n\n**选项 C 分析**\n\n这个陈述涉及 $\\Delta Q\\neq 0$ 和 $\\omega_e\\neq \\omega_g$ 的情况。它声称 FC 因子的包络变得偏斜，并且其最大值发生移动。我们可以使用半经典的 Franck-Condon 原理。概率最高的跃迁（“垂直跃迁”）发生在从初态的平衡位置（对于振动基态是 $Q=0$）到激发态势能面上。激发态中最可能被占据的振动能级，是其能量最接近于激发态在该垂直构型（$Q=0$）下的势能的那个能级。\n在激发态势能面上 $Q=0$ 处的势能，相对于激发态势阱的最小值（在 $Q=\\Delta Q$ 处）测量，为 $\\Delta V = V_e(0) - V_e(\\Delta Q) = \\left(E_{\\mathrm{vert}} + \\frac{1}{2}M\\omega_e^2(0-\\Delta Q)^2\\right) - E_{\\mathrm{vert}} = \\frac{1}{2}M\\omega_e^2\\Delta Q^2$。\n激发态中第 $n$ 个振动能级的能量是 $E_n^{(e)} = (n+\\frac{1}{2})\\hbar\\omega_e$。\n将这两个能量相等，可以得到最概然量子数 $n_{\\text{max}}$ 的估计值：\n$(n_{\\text{max}}+\\frac{1}{2})\\hbar\\omega_e \\approx \\frac{1}{2}M\\omega_e^2\\Delta Q^2$\n$n_{\\text{max}} \\approx \\frac{M\\omega_e\\Delta Q^2}{2\\hbar} - \\frac{1}{2}$。\nHuang-Rhys 参数 $S = \\frac{M\\omega_g\\Delta Q^2}{2\\hbar}$ 对应于等频率情况（$\\omega_e=\\omega_g$）下强度分布的峰值。\n我们可以写成 $n_{\\text{max}} \\approx S \\cdot (\\omega_e/\\omega_g) - 1/2$。\n- 如果 $\\omega_e > \\omega_g$，那么 $\\omega_e/\\omega_g > 1$，并且 $n_{\\text{max}}$ 将大于等频率模型预测的 $S$ 值。\n- 如果 $\\omega_e < \\omega_g$，那么 $\\omega_e/\\omega_g < 1$，并且 $n_{\\text{max}}$ 将小于 $S$。\n这证实了最强跃迁的移动。与对称的泊松形状相比，频率的变化也导致强度包络出现不对称性（偏斜），这是一个有充分记录的现象。\n\n结论：**正确**。\n\n**选项 D 分析**\n\n这个陈述声称，对于固定的 $\\Delta Q \\neq 0$，频率失配（$\\omega_e\\neq \\omega_g$）*必然*会降低零声子线强度 $I_0 = \\lvert\\langle 0_e\\vert 0_g\\rangle\\rvert^2$。\n为了验证这一点，我们必须计算 $I_0$ 作为 $\\omega_e$ 的函数。重叠积分 $\\langle 0_e\\vert 0_g\\rangle$ 是两个高斯函数之间的积分：$\\chi_0^{(g)}(Q) \\propto \\exp(-\\alpha_g^2 Q^2 / 2)$ 和 $\\chi_0^{(e)}(Q) \\propto \\exp(-\\alpha_e^2 (Q-\\Delta Q)^2 / 2)$。这个标准积分的结果是：\n$\\lvert\\langle 0_e\\vert 0_g\\rangle\\rvert^2 = I_0 = \\frac{2\\alpha_g\\alpha_e}{\\alpha_g^2+\\alpha_e^2} \\exp\\left(-\\frac{\\alpha_g^2 \\alpha_e^2 \\Delta Q^2}{\\alpha_g^2+\\alpha_e^2}\\right)$。\n代入 $\\alpha_g^2 = M\\omega_g/\\hbar$ 和 $\\alpha_e^2 = M\\omega_e/\\hbar$，并使用 Huang-Rhys 参数 $S = M\\omega_g\\Delta Q^2/(2\\hbar)$ 的定义，我们得到：\n$I_0(\\omega_e) = \\frac{2\\sqrt{\\omega_g\\omega_e}}{\\omega_g+\\omega_e} \\exp\\left(-\\frac{M\\Delta Q^2}{\\hbar} \\frac{\\omega_g\\omega_e}{\\omega_g+\\omega_e}\\right) = \\frac{2\\sqrt{\\omega_g\\omega_e}}{\\omega_g+\\omega_e} \\exp\\left(-S \\frac{2\\omega_e}{\\omega_g+\\omega_e}\\right)$。\n令 $x = \\omega_e/\\omega_g$。需要分析的函数是 $I_0(x) = \\frac{2\\sqrt{x}}{1+x} \\exp\\left(-S \\frac{2x}{1+x}\\right)$。参考情况是 $x=1$，此时 $I_0(1) = e^{-S}$。该陈述声称对于所有 $x \\neq 1$，$I_0(x) \\le I_0(1)$。\n为了找到 $I_0(x)$ 的最大值，我们可以分析其对数 $h(x)=\\ln(I_0(x))$。其导数为 $h'(x) = \\frac{1-x^2-4Sx}{2x(1+x)^2}$。令 $h'(x)=0$ 得到极值的条件：$x^2 + 4Sx - 1 = 0$。\n对于 $x>0$，解为 $x_{\\text{max}} = \\sqrt{4S^2+1}-2S$。\n对于任何 $S>0$（因为 $\\Delta Q \\neq 0$），我们有 $\\sqrt{4S^2+1} < \\sqrt{4S^2+4S+1} = 2S+1$。这意味着 $x_{\\text{max}} = \\sqrt{4S^2+1}-2S < 1$。\n$I_0$ 的最大值出现在频率比 $x_{\\text{max}} < 1$ 处，这意味着 $\\omega_e < \\omega_g$。\n因此，从等频率情况（$\\omega_e=\\omega_g$，即 $x=1$）出发，如果通过*减小* $\\omega_e$ 来引入频率失配，强度 $I_0$ 最初会*增加*，直到在 $\\omega_e = \\omega_g \\cdot x_{\\text{max}}$ 处达到其最大值。声称强度“必然降低”是错误的。\n\n结论：**错误**。\n\n**选项 E 分析**\n\n这个陈述讨论了一个具有多个独立、无旋转的简正坐标 $Q_k$ 的多维系统。\n1.  **因子分解**：如果 Duschinsky 矩阵是单位矩阵，激发态的简正坐标与基态的简正坐标平行（只是有位移）。总势能是各模式之和：$V(\\mathbf{Q}) = \\sum_k V^{(k)}(Q_k)$。总振动波函数是单模波函数的乘积：$\\Psi(\\mathbf{Q}) = \\prod_k \\chi_{n_k}(Q_k)$。由于这种可分离性，总 FC 重叠积分可以因子分解为一维重叠积分的乘积：$\\langle \\Psi_e \\vert \\Psi_g \\rangle = \\prod_k \\langle n_{e,k} \\vert n_{g,k} \\rangle$。因此，总 FC 因子是各模式 FC 因子的乘积：$I_{\\mathbf{n}} = \\prod_k I_{n_k}^{(k)}$。这部分是正确的。\n2.  **单模分布**：如 A 的分析所确立的，单个模式 $k$ 的 FC 强度分布 $\\{I_{n_k}^{(k)}\\}$ 是泊松分布，当且仅当 $\\omega_{e,k} = \\omega_{g,k}$。如果 $\\omega_{e,k}/\\omega_{g,k} \\neq 1$，分布就不是泊松分布。这部分是正确的。\n3.  **结论**：多维泊松分布是单个泊松分布的乘积。总 FC 强度模式 $I_{\\mathbf{n}}$ 只有在*每个*单模因子 $I_{n_k}^{(k)}$ 都是泊松分布时，才能是泊松分布的乘积。这要求对所有模式 $k$ 都有 $\\omega_{e,k} = \\omega_{g,k}$。如果哪怕只有一个模式的频率发生变化，其贡献就不是泊松分布，因此总强度模式就不是泊松分布的乘积。这个陈述是从前面的几点得出的正确逻辑推论。\n\n结论：**正确**。", "answer": "$$\\boxed{BCE}$$", "id": "2929619"}, {"introduction": "理论推导为我们提供了分析工具，而将这些工具应用于多原子分子的实际计算则是量子化学研究的关键一步。本练习将引导你完成一个核心的计算任务：根据两个电子态的平衡构型和Hessian矩阵，构建描述其简正坐标之间线性变换的杜申斯基（Duschinsky）旋转矩阵和位移矢量。这不仅是将抽象理论付诸实践，更是理解和模拟复杂分子振动光谱的必经之路，让你亲身体验如何处理量子化学计算的直接输出 [@problem_id:2929663]。", "problem": "考虑Born–Oppenheimer近似以及两个电子态（一个初态和一个末态）的核运动的简谐正交模描述。在质量加权笛卡尔坐标中，围绕平衡构型的小位移的二次势能由一个对称Hessian矩阵确定。Franck–Condon (FC) 原理将振动电子强度与定义在两个电子态的正交模基中的简谐振子本征函数的交叠联系起来。两个正交模坐标系之间的线性变换由Duschinsky旋转矩阵和一个位移向量来表征。你的任务是纯粹根据质量加权正交模和对称正定Hessian矩阵的定义，推导、实现并验证这个变换。\n\n仅从以下基本事实出发：\n- 稳定平衡的质量加权Hessian矩阵是一个实对称正定矩阵。其特征分解定义了正交模的幺正基和一组角频率的平方。\n- 简正坐标是质量加权笛卡尔位移的幺正线性组合，质量加权Hessian矩阵的特征向量构成一个系数的幺正矩阵。\n- Duschinsky变换是两个幺正正交模基之间唯一的线性映射，它与一个恒定位移一起，将从初态平衡测量的位移映射到从末态平衡测量的位移。\n\n对下面列出的每个测试用例执行以下操作：\n- 设初态平衡构型为列向量 $\\mathbf{g}_i$，末态平衡构型为列向量 $\\mathbf{g}_f$，两者均在质量加权笛卡尔坐标系中。设相应的质量加权Hessian矩阵分别为 $\\mathbf{H}_i$ 和 $\\mathbf{H}_f$。\n- 对角化 $\\mathbf{H}_i$ 和 $\\mathbf{H}_f$ 以获得它们的幺正特征向量矩阵和非负特征值谱。使用这些来构建Duschinsky旋转矩阵 $\\mathbf{J}$ 和位移向量 $\\mathbf{K}$，该变换将初态简正坐标映射到末态简正坐标。\n- 通过计算 $\\mathbf{J}^\\top \\mathbf{J} - \\mathbf{I}$ 的Frobenius范数并检查其是否小于指定的容差 $\\varepsilon_{\\mathrm{orth}}$ 来验证正交性。使用 $\\varepsilon_{\\mathrm{orth}} = 10^{-10}$。\n- 通过检查 $\\mathbf{H}_i$ 和 $\\mathbf{H}_f$ 的所有特征值是否严格大于一个小的正阈值 $\\varepsilon_{\\mathrm{pos}}$ 来验证振动频率的正性。使用 $\\varepsilon_{\\mathrm{pos}} = 10^{-12}$。\n- 对于每个测试用例，当且仅当两个验证都通过时，返回一个布尔值true。\n\n所有输入都以质量加权笛卡尔坐标表示，因此单位被吸收到坐标定义中；布尔输出是无单位的。输入或输出中不使用角度。\n\n测试套件：\n- 用例 A:\n  - $\\mathbf{g}_i = \\begin{bmatrix} 0.0 \\\\ 0.0 \\end{bmatrix}$, $\\mathbf{g}_f = \\begin{bmatrix} 0.2 \\\\ -0.1 \\end{bmatrix}$\n  - $\\mathbf{H}_i = \\begin{bmatrix} 1.0  0.0 \\\\ 0.0  4.0 \\end{bmatrix}$\n  - $\\mathbf{H}_f = \\begin{bmatrix} 2.08733219254516  0.282321236697517 \\\\ 0.282321236697517  2.91266780745484 \\end{bmatrix}$\n- 用例 B:\n  - $\\mathbf{g}_i = \\begin{bmatrix} 0.1 \\\\ -0.2 \\\\ 0.3 \\end{bmatrix}$, $\\mathbf{g}_f = \\begin{bmatrix} 0.1 \\\\ -0.2 \\\\ 0.3 \\end{bmatrix}$\n  - $\\mathbf{H}_i = \\begin{bmatrix} 1.0  0.0  0.0 \\\\ 0.0  2.0  0.0 \\\\ 0.0  0.0  3.0 \\end{bmatrix}$\n  - $\\mathbf{H}_f = \\begin{bmatrix} 1.0  0.0  0.0 \\\\ 0.0  2.0  0.0 \\\\ 0.0  0.0  3.0 \\end{bmatrix}$\n- 用例 C:\n  - $\\mathbf{g}_i = \\begin{bmatrix} 0.0 \\\\ 0.0 \\end{bmatrix}$, $\\mathbf{g}_f = \\begin{bmatrix} 0.001 \\\\ -0.002 \\end{bmatrix}$\n  - $\\mathbf{H}_i = \\begin{bmatrix} 1.0\\times 10^{-6}  0.0 \\\\ 0.0  2.0 \\end{bmatrix}$\n  - $\\mathbf{H}_f = \\begin{bmatrix} 1.5  0.2 \\\\ 0.2  1.0 \\end{bmatrix}$\n- 用例 D:\n  - $\\mathbf{g}_i = \\begin{bmatrix} 0.0 \\\\ 0.0 \\end{bmatrix}$, $\\mathbf{g}_f = \\begin{bmatrix} 0.0 \\\\ 0.0 \\end{bmatrix}$\n  - $\\mathbf{H}_i = \\begin{bmatrix} 1.0  0.0 \\\\ 0.0  -0.1 \\end{bmatrix}$\n  - $\\mathbf{H}_f = \\begin{bmatrix} 2.0  0.0 \\\\ 0.0  2.5 \\end{bmatrix}$\n\n实现要求：\n- 你的程序必须如上所述从第一性原理构建 $\\mathbf{J}$ 和 $\\mathbf{K}$。\n- 使用 $\\varepsilon_{\\mathrm{orth}} = 10^{-10}$ 和 $\\varepsilon_{\\mathrm{pos}} = 10^{-12}$ 进行正交性和正性检查。\n- 对于每个用例，如果两个验证都通过则输出布尔值true，否则输出false。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔的结果列表，例如 $\\left[\\text{result}_A,\\text{result}_B,\\text{result}_C,\\text{result}_D\\right]$。条目必须是你的实现按照上述测试套件的顺序生成的布尔字面量，不含空格。", "solution": "问题陈述具有科学依据、适定、客观且自洽。它提出了一个来自计算量子化学的标准的、非平凡的任务：推导和数值验证两组简谐正交模之间的Duschinsky变换。所有必要的数据和定义都已提供。因此，该问题是有效的，并将提供解决方案。\n\n问题的核心是推导连接初电子态（用下标 $i$ 表示）的简正坐标与末电子态（用下标 $f$ 表示）的简正坐标的线性变换。这个变换被称为Duschinsky变换，是计算Franck-Condon因子和模拟振动电子光谱的基础。\n\n设 $\\mathbf{x}$ 为原子核的质量加权笛卡尔坐标的列向量。在电子态 $s \\in \\{i, f\\}$ 中，相对于平衡构型 $\\mathbf{g}_s$ 的位移由向量 $\\mathbf{q}_s$ 给出：\n$$ \\mathbf{q}_s = \\mathbf{x} - \\mathbf{g}_s $$\n两个态的位移向量之间的关系可以通过将一个表示为另一个来推导。坐标向量 $\\mathbf{x}$ 对两个定义都是通用的。因此，我们可以写出：\n$$ \\mathbf{q}_f = \\mathbf{x} - \\mathbf{g}_f = (\\mathbf{x} - \\mathbf{g}_i) + (\\mathbf{g}_i - \\mathbf{g}_f) = \\mathbf{q}_i - (\\mathbf{g}_f - \\mathbf{g}_i) $$\n这个方程连接了两个电子态中的笛卡尔位移。\n\n在简谐近似下，围绕平衡构型 $\\mathbf{g}_s$ 的势能面由质量加权Hessian矩阵 $\\mathbf{H}_s$ 描述：\n$$ V_s(\\mathbf{q}_s) = \\frac{1}{2}\\mathbf{q}_s^\\top \\mathbf{H}_s \\mathbf{q}_s $$\n对于一个稳定平衡，$\\mathbf{H}_s$ 是一个实、对称、正定矩阵。其谱分解产生一组特征值 $\\lambda_k^{(s)}$ 和相应的特征向量。特征值是正交模角频率的平方 $(\\omega_k^{(s)})^2$。特征向量构成了幺正矩阵 $\\mathbf{L}_s$ 的列，该矩阵定义了到简正坐标 $\\mathbf{Q}_s$ 的变换。\n$$ \\mathbf{H}_s \\mathbf{L}_s = \\mathbf{L}_s \\mathbf{\\Lambda}_s $$\n其中 $\\mathbf{\\Lambda}_s$ 是特征值 $\\lambda_k^{(s)}$ 的对角矩阵，$\\mathbf{L}_s$ 是满足 $\\mathbf{L}_s^\\top \\mathbf{L}_s = \\mathbf{L}_s \\mathbf{L}_s^\\top = \\mathbf{I}$ 的正交模的正交矩阵。\n\n简正坐标 $\\mathbf{Q}_s$ 定义为质量加权笛卡尔位移 $\\mathbf{q}_s$ 在正交模基上的投影：\n$$ \\mathbf{Q}_s = \\mathbf{L}_s^\\top \\mathbf{q}_s $$\n其逆变换为：\n$$ \\mathbf{q}_s = \\mathbf{L}_s \\mathbf{Q}_s $$\n\n为了推导Duschinsky变换 $\\mathbf{Q}_f = \\mathbf{J} \\mathbf{Q}_i + \\mathbf{K}$，我们从 $\\mathbf{Q}_f$ 的定义开始，并代入上面建立的关系：\n$$ \\mathbf{Q}_f = \\mathbf{L}_f^\\top \\mathbf{q}_f $$\n代入关系式 $\\mathbf{q}_f = \\mathbf{q}_i - (\\mathbf{g}_f - \\mathbf{g}_i)$：\n$$ \\mathbf{Q}_f = \\mathbf{L}_f^\\top \\left[ \\mathbf{q}_i - (\\mathbf{g}_f - \\mathbf{g}_i) \\right] $$\n接下来，使用 $\\mathbf{q}_i = \\mathbf{L}_i \\mathbf{Q}_i$ 将初态的笛卡尔位移 $\\mathbf{q}_i$ 用其简正坐标 $\\mathbf{Q}_i$ 表示：\n$$ \\mathbf{Q}_f = \\mathbf{L}_f^\\top \\left[ (\\mathbf{L}_i \\mathbf{Q}_i) - (\\mathbf{g}_f - \\mathbf{g}_i) \\right] $$\n将矩阵 $\\mathbf{L}_f^\\top$ 分配进去，得到最终形式：\n$$ \\mathbf{Q}_f = (\\mathbf{L}_f^\\top \\mathbf{L}_i) \\mathbf{Q}_i - \\mathbf{L}_f^\\top (\\mathbf{g}_f - \\mathbf{g}_i) $$\n通过将此结果与Duschinsky变换的一般形式 $\\mathbf{Q}_f = \\mathbf{J} \\mathbf{Q}_i + \\mathbf{K}$ 进行比较，我们确定了Duschinsky旋转矩阵 $\\mathbf{J}$ 和位移向量 $\\mathbf{K}$：\n$$ \\mathbf{J} = \\mathbf{L}_f^\\top \\mathbf{L}_i $$\n$$ \\mathbf{K} = - \\mathbf{L}_f^\\top (\\mathbf{g}_f - \\mathbf{g}_i) $$\n\n该问题要求对每个测试用例进行两次验证检查。\n\n1.  **频率的正性**：一个物理上稳定的分子必须具有实的振动频率。这转化为数学要求，即Hessian矩阵必须是正定的，意味着其所有特征值 $\\lambda_k^{(s)}$ 都必须严格为正。我们必须检查在两个态 $s \\in \\{i, f\\}$ 中的所有模式 $k$ 是否都满足 $\\lambda_k^{(s)} > \\varepsilon_{\\mathrm{pos}}$，其中给定的容差为 $\\varepsilon_{\\mathrm{pos}} = 10^{-12}$。一个负的特征值将意味着一个虚频，并对应于势能面上的一个鞍点，而不是一个极小值点。\n\n2.  **Duschinsky矩阵的正交性**：矩阵 $\\mathbf{J}$ 是由两个正交矩阵 $\\mathbf{L}_f^\\top$ 和 $\\mathbf{L}_i$ 的乘积构成的。正交矩阵的乘积本身也是正交的。一个正交矩阵必须满足条件 $\\mathbf{J}^\\top \\mathbf{J} = \\mathbf{I}$。由于浮点运算的限制，这个等式可能不会精确成立。因此，我们通过计算残差矩阵 $\\mathbf{J}^\\top \\mathbf{J} - \\mathbf{I}$ 的Frobenius范数，并确保其低于指定的容差 $\\varepsilon_{\\mathrm{orth}} = 10^{-10}$ 来验证数值上的正交性。矩阵 $\\mathbf{M}$ 的Frobenius范数定义为 $\\|\\mathbf{M}\\|_F = \\sqrt{\\sum_{j,k} |M_{jk}|^2}$。\n\n实现将首先为每个Hessian矩阵计算特征值和特征向量，然后执行这两个检查。一个测试用例当且仅当两个检查都通过时才有效。\n\n-   **用例A**：所有特征值均为正。$\\mathbf{L}_i$ 是单位矩阵，因此 $\\mathbf{J} = \\mathbf{L}_f^\\top$，是正交的。两个检查都通过。\n-   **用例B**：初态和末态相同的平凡情况。$\\mathbf{H}_i=\\mathbf{H}_f$，$\\mathbf{g}_i=\\mathbf{g}_f$。特征值为正。$\\mathbf{J}=\\mathbf{I}$，是完全正交的。两个检查都通过。\n-   **用例C**：$\\mathbf{H}_i$ 的特征值为 $1.0\\times 10^{-6}$ 和 $2.0$，均大于 $\\varepsilon_{\\mathrm{pos}} = 10^{-12}$。$\\mathbf{H}_f$ 的特征值也为正。正交性如用例A一样成立。两个检查都通过。\n-   **用例D**：Hessian矩阵 $\\mathbf{H}_i$ 有一个特征值为 $-0.1$。这违反了正性条件，因为 $-0.1 \\ngtr 10^{-12}$。检查失败。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Duschinsky transformation problem for a suite of test cases.\n    For each case, it derives the Duschinsky matrix J and vector K,\n    and validates the physical and mathematical consistency of the inputs.\n    \"\"\"\n\n    # Tolerances for validation checks\n    EPS_ORTH = 1e-10\n    EPS_POS = 1e-12\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"name\": \"Case A\",\n            \"gi\": np.array([0.0, 0.0]),\n            \"gf\": np.array([0.2, -0.1]),\n            \"Hi\": np.array([[1.0, 0.0], \n                            [0.0, 4.0]]),\n            \"Hf\": np.array([[2.08733219254516, 0.282321236697517],\n                            [0.282321236697517, 2.91266780745484]]),\n        },\n        {\n            \"name\": \"Case B\",\n            \"gi\": np.array([0.1, -0.2, 0.3]),\n            \"gf\": np.array([0.1, -0.2, 0.3]),\n            \"Hi\": np.array([[1.0, 0.0, 0.0],\n                            [0.0, 2.0, 0.0],\n                            [0.0, 0.0, 3.0]]),\n            \"Hf\": np.array([[1.0, 0.0, 0.0],\n                            [0.0, 2.0, 0.0],\n                            [0.0, 0.0, 3.0]]),\n        },\n        {\n            \"name\": \"Case C\",\n            \"gi\": np.array([0.0, 0.0]),\n            \"gf\": np.array([0.001, -0.002]),\n            \"Hi\": np.array([[1.0e-6, 0.0], \n                            [0.0, 2.0]]),\n            \"Hf\": np.array([[1.5, 0.2], \n                            [0.2, 1.0]]),\n        },\n        {\n            \"name\": \"Case D\",\n            \"gi\": np.array([0.0, 0.0]),\n            \"gf\": np.array([0.0, 0.0]),\n            \"Hi\": np.array([[1.0, 0.0], \n                            [0.0, -0.1]]),\n            \"Hf\": np.array([[2.0, 0.0], \n                            [0.0, 2.5]]),\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        gi, gf, Hi, Hf = case[\"gi\"], case[\"gf\"], case[\"Hi\"], case[\"Hf\"]\n\n        # Step 1: Diagonalize Hessians to get eigenvalues and eigenvectors (normal modes)\n        # numpy.linalg.eigh is used for symmetric matrices. It returns eigenvalues\n        # in ascending order and corresponding eigenvectors as columns of a matrix.\n        try:\n            lambda_i, L_i = np.linalg.eigh(Hi)\n            lambda_f, L_f = np.linalg.eigh(Hf)\n        except np.linalg.LinAlgError:\n            # This would catch non-converging algorithms, but eigh is robust for symmetric matrices.\n            results.append(False)\n            continue\n\n        # Step 2: Validate positivity of vibrational frequencies (eigenvalues)\n        positivity_valid_i = np.all(lambda_i > EPS_POS)\n        positivity_valid_f = np.all(lambda_f > EPS_POS)\n        positivity_valid = positivity_valid_i and positivity_valid_f\n\n        if not positivity_valid:\n            results.append(False)\n            continue\n\n        # Step 3: Construct the Duschinsky rotation matrix J and displacement vector K\n        # J = L_f^T * L_i\n        J = L_f.T @ L_i\n        \n        # d_g = g_f - g_i\n        # K = -L_f^T * d_g\n        # The calculation of K is included for completeness but not required for validation.\n        # d_g = gf - gi\n        # K = -L_f.T @ d_g\n\n        # Step 4: Validate orthogonality of the Duschinsky matrix J\n        # We check if the Frobenius norm of (J^T * J - I) is close to zero.\n        dim = J.shape[0]\n        identity_matrix = np.identity(dim)\n        residual_matrix = J.T @ J - identity_matrix\n        ortho_norm = np.linalg.norm(residual_matrix, 'fro')\n        \n        orthogonality_valid = ortho_norm  EPS_ORTH\n\n        # The result for the case is true if and only if both validations pass.\n        final_result = positivity_valid and orthogonality_valid\n        results.append(final_result)\n\n    # Final print statement in the exact required format.\n    # Python's str() for booleans produces \"True\" and \"False\".\n    print(f\"[{','.join(str(r).lower() for r in results)}]\")\n\nsolve()\n```", "id": "2929663"}]}