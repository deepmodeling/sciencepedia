{"hands_on_practices": [{"introduction": "理论的核心在于实践。第一个练习将引导我们处理一个基础但至关重要的模型：双态单维系统中的非绝热耦合。通过为一个典型的避开交叉模型（通常称为Landau-Zener模型）解析地推导导数耦合，你将掌握从第一性原理计算这些关键量的核心技能。这个练习将具体展示耦合强度如何依赖于能隙和哈密顿量的变化，并揭示其在核构型空间中为何会局域化。[@problem_id:2876944]", "problem": "考虑一个最小的$2$态非绝热模型，其具有单个核坐标 $R$、实值的且与 $R$ 无关的非绝热基矢 $\\{|\\chi_{1}\\rangle,|\\chi_{2}\\rangle\\}$ 和电子哈密顿量\n$$\nH(R)=\\begin{pmatrix} a\\,R  V \\\\ V  -a\\,R \\end{pmatrix},\n$$\n其中 $a0$ 和 $V0$ 是常数。在 Born-Huang 展开中，总分子波函数被写成对绝热电子态 $|\\Phi_{i}(R)\\rangle$ 的求和，这些态参数化地依赖于 $R$，并带有核振幅 $\\chi_{i}(R)$，而绝热态 $i$ 和 $j$ 之间的非绝热耦合矢量 (NACV) 定义为\n$$\n\\mathbf{d}_{ij}(R)=\\langle \\Phi_{i}(R)|\\nabla_{R} \\Phi_{j}(R)\\rangle.\n$$\n对于这个一维坐标 $R$，通过一个作用于非绝热基矢的、由混合角 $\\theta(R)$ 决定的实正交旋转来对角化 $H(R)$，从而确定绝热能量和绝热电子态。然后，从第一性原理出发，确定标量导数耦合 $d_{12}(R)=\\langle \\Phi_{1}(R)|\\frac{d}{dR}\\Phi_{2}(R)\\rangle$ 关于 $a$、$V$ 和 $R$ 的解析表达式。最后，分析其在 $|R|$ 较大时的渐近衰减行为以及在 $R=0$ 附近的行为，并解释这些行为如何从你得到的绝热能量和混合角的表达式中产生。\n\n作为你的最终答案，仅报告你找到的 $d_{12}(R)$ 的精确闭合形式表达式（无单位）。", "solution": "首先对问题陈述进行严格的验证。\n\n步骤1：提取已知条件\n- 系统：一个最小二态非绝热模型。\n- 核坐标：单个坐标 $R$。\n- 非绝熱基矢：$\\{|\\chi_{1}\\rangle,|\\chi_{2}\\rangle\\}$，是实值的且与 $R$ 无关。\n- 在非绝热基矢表象中的电子哈密顿量：\n$$\nH(R)=\\begin{pmatrix} a\\,R  V \\\\ V  -a\\,R \\end{pmatrix}\n$$\n其中 $a0$ 和 $V0$ 是实正常数。\n- 非绝热耦合矢量 (NACV) 定义：$\\mathbf{d}_{ij}(R)=\\langle \\Phi_{i}(R)|\\nabla_{R} \\Phi_{j}(R)\\rangle$。\n- 任务：确定标量导数耦合 $d_{12}(R)=\\langle \\Phi_{1}(R)|\\frac{d}{dR}\\Phi_{2}(R)\\rangle$ 并分析其行为。\n- 方法：通过一个涉及混合角 $\\theta(R)$ 的实正交旋转来对角化 $H(R)$。\n- 最终答案要求：$d_{12}(R)$ 的精确闭合形式表达式。\n\n步骤2：使用提取的已知条件进行验证\n所提出的问题是量子化学中的一个标准教科书模型，通常被称为 Landau-Zener 模型。\n- **科学上成立：** 非绝热和绝热表象、Born-Huang 展开以及非绝热耦合的概念是分子量子力学的基本原理。该哈密顿量描述了一个原型性的避免交叉情景，这是一个科学上合理且被广泛研究的模型。\n- **良定的：** 该问题是完全指定的。它提供了哈密顿量、基矢的性质以及待计算量的明确定义。解题路径已概述，并且可以确定一个唯一且有意义的答案。\n- **客观的：** 该问题使用精确、客观的数学和物理术语进行陈述。没有主观或模糊的元素。\n\n步骤3：结论和行动\n该问题是有效的。它科学上合理、良定且客观。现在将推导完整的解答。\n\n解答始于对电子哈密顿量 $H(R)$ 的对角化，以求得绝热能量（本征值）和绝热态（本征矢量）。绝热态 $|\\Phi_i(R)\\rangle$ 通过一个依赖于 $R$ 的正交变换（一个旋转）与非绝热态 $|\\chi_j\\rangle$ 相关联，我们用矩阵 $C(R)$ 表示该变换。\n设变换为：\n$$\n\\begin{pmatrix} |\\Phi_1(R)\\rangle \\\\ |\\Phi_2(R)\\rangle \\end{pmatrix} = \\begin{pmatrix} \\cos\\theta(R)  \\sin\\theta(R) \\\\ -\\sin\\theta(R)  \\cos\\theta(R) \\end{pmatrix} \\begin{pmatrix} |\\chi_1\\rangle \\\\ |\\chi_2\\rangle \\end{pmatrix}\n$$\n这意味着 $|\\Phi_1(R)\\rangle = \\cos\\theta(R)|\\chi_1\\rangle + \\sin\\theta(R)|\\chi_2\\rangle$ 且 $|\\Phi_2(R)\\rangle = -\\sin\\theta(R)|\\chi_1\\rangle + \\cos\\theta(R)|\\chi_2\\rangle$。对应的本征矢量分量矩阵为 $C(R) = \\begin{pmatrix} \\cos\\theta(R)  -\\sin\\theta(R) \\\\ \\sin\\theta(R)  \\cos\\theta(R) \\end{pmatrix}$。\n绝热哈密顿矩阵 $H_{ad}(R)$ 是对角矩阵，由 $H_{ad}(R) = C(R)^{\\dagger} H(R) C(R)$ 给出。由于基矢和哈密顿量是实值的，伴随矩阵即为转置矩阵，$C(R)^{\\dagger} = C(R)^{T}$。\n$$\nH_{ad}(R) = \\begin{pmatrix} \\cos\\theta  \\sin\\theta \\\\ -\\sin\\theta  \\cos\\theta \\end{pmatrix} \\begin{pmatrix} aR  V \\\\ V  -aR \\end{pmatrix} \\begin{pmatrix} \\cos\\theta  -\\sin\\theta \\\\ \\sin\\theta  \\cos\\theta \\end{pmatrix}\n$$\n要使 $H_{ad}(R)$ 为对角矩阵，其非对角元素必须为零。我们来计算乘积的 $(1,2)$ 元素：\n$$\n(H_{ad})_{12} = (\\cos\\theta(aR) + \\sin\\theta(V))(-\\sin\\theta) + (\\cos\\theta(V) + \\sin\\theta(-aR))(\\cos\\theta)\n$$\n$$\n(H_{ad})_{12} = -aR\\cos\\theta\\sin\\theta - V\\sin^2\\theta + V\\cos^2\\theta - aR\\sin\\theta\\cos\\theta\n$$\n$$\n(H_{ad})_{12} = V(\\cos^2\\theta - \\sin^2\\theta) - 2aR\\sin\\theta\\cos\\theta = V\\cos(2\\theta) - aR\\sin(2\\theta)\n$$\n将其设为零可得到混合角 $\\theta(R)$ 的条件：\n$$\nV\\cos(2\\theta) = aR\\sin(2\\theta) \\implies \\tan(2\\theta(R)) = \\frac{V}{aR}\n$$\n由此，我们可以定义角度 $\\theta(R) = \\frac{1}{2}\\arctan\\left(\\frac{V}{aR}\\right)$。$H_{ad}(R)$ 的对角元素即为绝热能量 $E_1(R)$ 和 $E_2(R)$。\n$$\nE_1(R) = (H_{ad})_{11} = aR\\cos(2\\theta) + V\\sin(2\\theta)\n$$\n$$\nE_2(R) = (H_{ad})_{22} = -aR\\cos(2\\theta) - V\\sin(2\\theta) = -E_1(R)\n$$\n使用直角三角形构造，其中 $\\tan(2\\theta) = V/(aR)$，斜边为 $\\sqrt{(aR)^2 + V^2}$。因此，我们找到 $\\sin(2\\theta)$ 和 $\\cos(2\\theta)$ 的表达式：\n$$\n\\sin(2\\theta) = \\frac{V}{\\sqrt{(aR)^2 + V^2}} \\quad , \\quad \\cos(2\\theta) = \\frac{aR}{\\sqrt{(aR)^2 + V^2}}\n$$\n将这些代入 $E_1(R)$ 的表达式中：\n$$\nE_1(R) = aR \\left(\\frac{aR}{\\sqrt{(aR)^2 + V^2}}\\right) + V \\left(\\frac{V}{\\sqrt{(aR)^2 + V^2}}\\right) = \\frac{(aR)^2 + V^2}{\\sqrt{(aR)^2 + V^2}} = \\sqrt{(aR)^2 + V^2}\n$$\n因此，绝热能量为 $E_1(R) = \\sqrt{(aR)^2 + V^2}$ 和 $E_2(R) = -\\sqrt{(aR)^2 + V^2}$。我们的态 $|\\Phi_1(R)\\rangle$ 对应于上绝热势能面，而 $|\\Phi_2(R)\\rangle$ 对应于下绝热势能面。\n\n接下来，我们计算非绝热导数耦合 $d_{12}(R) = \\langle\\Phi_1(R)|\\frac{d}{dR}|\\Phi_2(R)\\rangle$。\n绝热态为：\n$|\\Phi_1(R)\\rangle = \\cos\\theta(R)|\\chi_1\\rangle + \\sin\\theta(R)|\\chi_2\\rangle$\n$|\\Phi_2(R)\\rangle = -\\sin\\theta(R)|\\chi_1\\rangle + \\cos\\theta(R)|\\chi_2\\rangle$\n由于非绝热基矢 $\\{|\\chi_i\\rangle\\}$ 与 $R$ 无关，其对 $R$ 的导数为零。我们对 $|\\Phi_2(R)\\rangle$ 求导：\n$$\n\\frac{d}{dR}|\\Phi_2(R)\\rangle = -\\cos\\theta(R)\\frac{d\\theta}{dR}|\\chi_1\\rangle - \\sin\\theta(R)\\frac{d\\theta}{dR}|\\chi_2\\rangle = -\\frac{d\\theta}{dR}\\left(\\cos\\theta(R)|\\chi_1\\rangle + \\sin\\theta(R)|\\chi_2\\rangle\\right)\n$$\n注意到括号中的项是 $|\\Phi_1(R)\\rangle$，我们有：\n$$\n\\frac{d}{dR}|\\Phi_2(R)\\rangle = -\\frac{d\\theta}{dR}|\\Phi_1(R)\\rangle\n$$\n于是耦合为：\n$$\nd_{12}(R) = \\langle\\Phi_1(R)| \\left(-\\frac{d\\theta}{dR}|\\Phi_1(R)\\rangle\\right) = -\\frac{d\\theta}{dR}\\langle\\Phi_1(R)|\\Phi_1(R)\\rangle\n$$\n由于绝热态的正交归一性，$\\langle\\Phi_1(R)|\\Phi_1(R)\\rangle=1$，这使得耦合简化为：\n$$\nd_{12}(R) = -\\frac{d\\theta}{dR}\n$$\n现在，我们必须求出混合角 $\\theta(R)$ 的导数。从 $\\theta(R) = \\frac{1}{2}\\arctan\\left(\\frac{V}{aR}\\right)$ 开始：\n$$\n\\frac{d\\theta}{dR} = \\frac{d}{dR}\\left[\\frac{1}{2}\\arctan\\left(\\frac{V}{aR}\\right)\\right] = \\frac{1}{2} \\cdot \\frac{1}{1 + \\left(\\frac{V}{aR}\\right)^2} \\cdot \\frac{d}{dR}\\left(\\frac{V}{aR}\\right)\n$$\n$$\n\\frac{d\\theta}{dR} = \\frac{1}{2} \\cdot \\frac{1}{1 + \\frac{V^2}{a^2R^2}} \\cdot \\left(-\\frac{V}{aR^2}\\right) = \\frac{1}{2} \\cdot \\frac{a^2R^2}{a^2R^2 + V^2} \\cdot \\left(-\\frac{V}{aR^2}\\right) = -\\frac{aV}{2(a^2R^2 + V^2)}\n$$\n因此，非绝热耦合为：\n$$\nd_{12}(R) = - \\left(-\\frac{aV}{2(a^2R^2 + V^2)}\\right) = \\frac{aV}{2(a^2R^2 + V^2)}\n$$\n这个结果可以用 Hellmann-Feynman 定理来验证，该定理给出了非对角耦合元素的另一种表达式：\n$$\nd_{12}(R) = \\frac{\\langle\\Phi_1(R)|\\frac{dH}{dR}|\\Phi_2(R)\\rangle}{E_2(R) - E_1(R)}\n$$\n哈密顿量的导数为 $\\frac{dH}{dR} = \\begin{pmatrix} a  0 \\\\ 0  -a \\end{pmatrix}$。分子中的矩阵元为：\n$$\n\\langle\\Phi_1|\\frac{dH}{dR}|\\Phi_2\\rangle = \\begin{pmatrix} \\cos\\theta  \\sin\\theta \\end{pmatrix} \\begin{pmatrix} a  0 \\\\ 0  -a \\end{pmatrix} \\begin{pmatrix} -\\sin\\theta \\\\ \\cos\\theta \\end{pmatrix} = \\begin{pmatrix} a\\cos\\theta  -a\\sin\\theta \\end{pmatrix} \\begin{pmatrix} -\\sin\\theta \\\\ \\cos\\theta \\end{pmatrix} = -a\\sin\\theta\\cos\\theta - a\\sin\\theta\\cos\\theta = -a\\sin(2\\theta)\n$$\n能量分母是 $E_2(R) - E_1(R) = -2\\sqrt{(aR)^2 + V^2}$。因此：\n$$\nd_{12}(R) = \\frac{-a\\sin(2\\theta)}{-2\\sqrt{(aR)^2 + V^2}} = \\frac{a}{2\\sqrt{(aR)^2 + V^2}} \\left(\\frac{V}{\\sqrt{(aR)^2 + V^2}}\\right) = \\frac{aV}{2(a^2R^2 + V^2)}\n$$\n两种方法的结果相同，证实了我们表达式的正确性。\n\n最后，我们分析 $d_{12}(R)$ 的行为。该表达式是一个以 $R=0$ 为中心的洛伦兹函数。\n- **在 $R=0$ 附近的行为**：当 $R \\to 0$ 时，$d_{12}(R)$ 接近其最大值：\n$$\nd_{12}(0) = \\frac{aV}{2(0 + V^2)} = \\frac{a}{2V}\n$$\n这个峰值出现在避免交叉点，此处的绝热能隙 $\\Delta E(R) = E_1(R) - E_2(R) = 2\\sqrt{(aR)^2+V^2}$ 达到最小值 $2V$。在这一点，混合角 $\\theta(R)$ 变化最快。当 $R\\to 0^+$ 时，$V/(aR) \\to +\\infty$，所以 $2\\theta \\to \\pi/2$ 且 $\\theta \\to \\pi/4$。当 $R\\to 0^-$ 时，$V/(aR) \\to -\\infty$，所以 $2\\theta \\to -\\pi/2$ 且 $\\theta \\to -\\pi/4$。波函数性质的快速变化使得导数耦合最大化。\n\n- **$|R|$ 较大时的渐近行为**：当 $|R| \\to \\infty$ 时，分母中的 $a^2R^2$ 项占主导地位：\n$$\nd_{12}(R) \\approx \\frac{aV}{2a^2R^2} = \\frac{V}{2aR^2}\n$$\n耦合以 $R^{-2}$ 的形式衰减。这是因为当 $|R|$ 很大时，绝热态趋近于非绝热态。能隙 $\\Delta E(R) \\approx 2a|R|$ 线性增长，使得各态很好地分离，并降低了非绝热跃迁的倾向。混合角 $\\theta(R) \\approx \\frac{1}{2}\\frac{V}{aR}$ 趋近于零，因此其导数也消失，导致耦合的衰减。\n\n最终要求的答案是 $d_{12}(R)$ 的闭合形式表达式。", "answer": "$$\n\\boxed{\\frac{aV}{2(a^{2}R^{2} + V^{2})}}\n$$", "id": "2876944"}, {"introduction": "在避开交叉的基础上，我们进入一个更复杂且在化学中极为重要的情景：锥形交叉点。当电子态简并时，非绝热耦合会发散，产生深刻的拓扑效应。这个练习将通过一个经典的线性振动耦合模型，让你亲手揭示几何相（或称Berry相）的存在。你将理解为何实值电子波函数在全局范围内会失效，并直接计算出核波函数环绕锥形交叉点一周后获得的非平庸几何相，这是一个无法通过简单规范变换消除的物理效应。[@problem_id:2876959]", "problem": "考虑多原子分子在Born–Huang展开（保留了原子核动能耦合项的Born–Oppenheimer分离）下的一个振动耦合双电子态子空间。设原子核构型空间为坐标为$Q_{x}$和$Q_{y}$的平面，并设（在固定的非绝热基中）电子哈密顿量为实对称的 $2 \\times 2$ 矩阵\n$$\n\\hat{H}_{\\mathrm{el}}(Q_{x},Q_{y}) \\;=\\; k\n\\begin{pmatrix}\nQ_{x}  Q_{y} \\\\\nQ_{y}  -Q_{x}\n\\end{pmatrix},\n$$\n其中 $k0$ 为一个常数。该哈密顿量在 $Q_{x}=Q_{y}=0$ 处呈现一个锥形交叉。对于 $Q\\neq 0$，绝热电子本征态 $\\{\\,|\\phi_{+}(Q)\\rangle,|\\phi_{-}(Q)\\rangle\\,\\}$ 是非简并的，其本征值为 $E_{\\pm}(Q)$。\n\n在Born–Huang展开的绝热表象中，单个绝热面 $n\\in\\{+,-\\}$ 上的原子核运动与Berry–Mead–Truhlar（几何）矢量势发生最小耦合\n$$\n\\mathbf{A}_{n}(Q) \\;=\\; i\\,\\langle \\phi_{n}(Q)\\,|\\,\\nabla_{Q}\\,\\phi_{n}(Q)\\rangle,\n$$\n其中 $\\nabla_{Q}=(\\partial/\\partial Q_{x},\\partial/\\partial Q_{y})$。对于构型空间中的闭合原子核回路 $\\mathcal{C}$，相关的阿贝尔完整群定义为\n$$\nW_{n}(\\mathcal{C}) \\;=\\; \\exp\\!\\Big(i \\oint_{\\mathcal{C}} \\mathbf{A}_{n}(Q)\\cdot d\\mathbf{Q}\\Big).\n$$\n\n令 $\\rho0$ 为固定值，并通过圆 $Q_{x}(\\theta)=\\rho\\cos\\theta$, $Q_{y}(\\theta)=\\rho\\sin\\theta$ 定义回路 $\\mathcal{C}$，其中 $0\\le\\theta\\le 2\\pi$，方向为逆时针。关注较低的绝热面 $n=-$。仅使用基本定义（上述哈密顿量、本征值问题，以及 $\\mathbf{A}_{-}(Q)$ 和 $W_{-}(\\mathcal{C})$ 的定义），完成以下任务：\n\n1. 对 $Q\\neq 0$ 确定 $E_{\\pm}(Q)$，并为较低能量面在定义域 $0 \\le \\theta \\le 2\\pi$ 上构建一个实的、归一化的绝热本征矢量 $|\\phi_{-}(Q)\\rangle$。用 $\\rho$ 和 $\\theta$ 表示你的结果。\n\n2. 解释为何尽管哈密顿量是实的，但在整个圆上全局连续地选择实的 $|\\phi_{-}(Q)\\rangle$ 会失败。你的解释必须基于当 $\\theta$ 从 $0$ 推进到 $2\\pi$ 时，你明确给出的 $|\\phi_{-}(Q)\\rangle$ 的行为。\n\n3. 通过计算 $\\mathbf{A}_{-}(Q)$ 沿 $\\mathcal{C}$ 的线积分来计算与回路 $\\mathcal{C}$ 相关的完整群 $W_{-}(\\mathcal{C})$，如有必要可使用分片构造法。将你的最终答案表示为一个精确的无单位实标量。\n\n你最终报告的值必须是 $W_{-}(\\mathcal{C})$ 的精确值。不包括单位。无需四舍五入。", "solution": "在尝试任何解答之前，需对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 该系统是一个双电子态子空间，其原子核构型坐标为 $Q_x$ 和 $Q_y$。\n- 在非绝热基中，电子哈密顿量为 $\\hat{H}_{\\mathrm{el}}(Q_{x},Q_{y}) = k \\begin{pmatrix} Q_{x}  Q_{y} \\\\ Q_{y}  -Q_{x} \\end{pmatrix}$，其中 $k0$ 是一个常数。\n- 在 $Q_{x}=Q_{y}=0$ 处存在一个锥形交叉。\n- 绝热电子本征态记为 $|\\phi_{n}(Q)\\rangle$，其本征值为 $E_{n}(Q)$，其中 $n \\in \\{+,-\\}$。\n- Berry矢量势定义为 $\\mathbf{A}_{n}(Q) = i\\,\\langle \\phi_{n}(Q)\\,|\\,\\nabla_{Q}\\,\\phi_{n}(Q)\\rangle$，其中 $\\nabla_{Q}=(\\partial/\\partial Q_{x},\\partial/\\partial Q_{y})$。\n- 对于闭合回路 $\\mathcal{C}$ 的阿贝尔完整群为 $W_{n}(\\mathcal{C}) = \\exp\\!\\Big(i \\oint_{\\mathcal{C}} \\mathbf{A}_{n}(Q)\\cdot d\\mathbf{Q}\\Big)$。\n- 特定的回路 $\\mathcal{C}$ 是一个半径为 $\\rho0$ 的圆，参数化为 $Q_{x}(\\theta)=\\rho\\cos\\theta$，$Q_{y}(\\theta)=\\rho\\sin\\theta$，其中 $0\\le\\theta\\le 2\\pi$。\n- 任务是关注较低的绝热面，$n=-$，并完成以下工作：\n    1. 确定 $E_{\\pm}(Q)$ 和在定义域 $0 \\le \\theta \\le 2\\pi$ 上的一个实的、归一化的本征矢量 $|\\phi_{-}(Q)\\rangle$。\n    2. 解释为何选择实的 $|\\phi_{-}(Q)\\rangle$ 会导致全局连续性失效。\n    3. 计算完整群 $W_{-}(\\mathcal{C})$。\n- 最终答案必须是 $W_{-}(\\mathcal{C})$ 的精确标量值。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学基础**：该问题描述了一个线性振动耦合模型，具体来说是导致锥形交叉的 $E \\otimes e$ Jahn-Teller 模型。绝热态、Berry联络和Berry相（完整群）等概念是量子化学和物理学中的基本和标准概念。该问题在科学上是合理的。\n- **适定性**：该问题在数学上是适定的。哈密顿量已指定，任务具体，并提供了所有必要的定义。存在唯一、稳定且有意义的解。\n- **客观性**：该问题以精确、客观的数学语言陈述，没有歧义或主观内容。\n\n**步骤3：结论与行动**\n- **结论**：该问题有效。它是理论化学中一个标准的、适定的问题。\n- **行动**：开始解答。\n\n通过按顺序解决三个指定的任务来构建解答。\n\n**第1部分：本征能量和本征矢量**\n\n首先，我们通过求解特征方程 $\\det(\\hat{H}_{\\mathrm{el}} - E\\,\\mathbf{I}) = 0$ 来确定电子哈密顿量 $\\hat{H}_{\\mathrm{el}}$ 的本征值 $E_{\\pm}$。\n$$\n\\det \\begin{pmatrix} kQ_{x} - E  kQ_{y} \\\\ kQ_{y}  -kQ_{x} - E \\end{pmatrix} = 0\n$$\n$$\n(kQ_{x} - E)(-kQ_{x} - E) - (kQ_{y})^2 = 0\n$$\n$$\nE^2 - (kQ_{x})^2 - (kQ_{y})^2 = 0\n$$\n$$\nE^2 = k^2(Q_{x}^2 + Q_{y}^2)\n$$\n使用极坐标表示 $Q_{x} = \\rho\\cos\\theta$ 和 $Q_{y} = \\rho\\sin\\theta$，我们有 $Q_x^2 + Q_y^2 = \\rho^2$。因此，本征值为：\n$$\nE_{\\pm}(\\rho) = \\pm k \\sqrt{\\rho^2} = \\pm k\\rho\n$$\n较低的能量面对应于本征值 $E_{-} = -k\\rho$。\n\n接下来，我们通过求解本征值方程 $(\\hat{H}_{\\mathrm{el}} - E_{-}\\mathbf{I})|\\phi_{-}\\rangle = 0$ 来找到相应的本征矢量 $|\\phi_{-}\\rangle = \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix}$。\n$$\nk \\begin{pmatrix} Q_{x} - (- \\rho)  Q_{y} \\\\ Q_{y}  -Q_{x} - (-\\rho) \\end{pmatrix} \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix} = k \\begin{pmatrix} \\rho\\cos\\theta + \\rho  \\rho\\sin\\theta \\\\ \\rho\\sin\\theta  -\\rho\\cos\\theta + \\rho \\end{pmatrix} \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n从第一行开始，除以 $k\\rho$：\n$$\n(\\cos\\theta + 1)c_1 + (\\sin\\theta)c_2 = 0\n$$\n使用半角恒等式 $\\cos\\theta + 1 = 2\\cos^2(\\theta/2)$ 和 $\\sin\\theta = 2\\sin(\\theta/2)\\cos(\\theta/2)$，我们得到：\n$$\n2\\cos^2(\\theta/2) c_1 + 2\\sin(\\theta/2)\\cos(\\theta/2) c_2 = 0\n$$\n对于 $\\theta \\neq \\pi$（其中 $\\cos(\\theta/2) \\neq 0$），我们可以除以 $2\\cos(\\theta/2)$：\n$$\n\\cos(\\theta/2) c_1 + \\sin(\\theta/2) c_2 = 0\n$$\n满足此条件的一个实数解是 $c_1 = \\sin(\\theta/2)$ 和 $c_2 = -\\cos(\\theta/2)$。相应的矢量是归一化的，因为 $\\sin^2(\\theta/2) + (-\\cos(\\theta/2))^2 = 1$。此解对于 $\\theta=\\pi$ 也成立，可通过直接代入验证。\n因此，在定义域 $0 \\le \\theta \\le 2\\pi$ 上，较低绝热面的一个实的、归一化的本征矢量是：\n$$\n|\\phi_{-}(\\theta)\\rangle = \\begin{pmatrix} \\sin(\\theta/2) \\\\ -\\cos(\\theta/2) \\end{pmatrix}\n$$\n\n**第2部分：全局连续性的失效**\n\n在圆 $\\mathcal{C}$ 上的一个全局连续本征矢量场必须满足周期性条件 $|\\phi_{-}(\\theta=2\\pi)\\rangle = |\\phi_{-}(\\theta=0)\\rangle$，因为 $\\theta=0$ 和 $\\theta=2\\pi$ 代表构型空间中的同一点 $(Q_x, Q_y) = (\\rho, 0)$。\n让我们在区间 $[0, 2\\pi]$ 的边界处计算我们明确给出的实本征矢量：\n在 $\\theta=0$ 处：\n$$\n|\\phi_{-}(0)\\rangle = \\begin{pmatrix} \\sin(0) \\\\ -\\cos(0) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix}\n$$\n在 $\\theta \\to 2\\pi$ 的下极限下：\n$$\n|\\phi_{-}(2\\pi)\\rangle = \\begin{pmatrix} \\sin(\\pi) \\\\ -\\cos(\\pi) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n$$\n我们观察到 $|\\phi_{-}(2\\pi)\\rangle = -|\\phi_{-}(0)\\rangle$。本征矢量在完成回路后获得一个符号翻转。因为该矢量没有返回其初始值，所以不可能在整个圆上定义一个全局连续、单值的*实*本征矢量场。任何这样的选择都必然至少有一个不连续点。这种符号变化是环绕锥形交叉所伴随的几何相的一个决定性特征。\n\n**第3部分：完整群计算**\n\n完整群是 $W_{-}(\\mathcal{C}) = \\exp(i\\gamma_{-})$，其中 $\\gamma_{-} = \\oint_{\\mathcal{C}} \\mathbf{A}_{-}(Q) \\cdot d\\mathbf{Q}$ 是几何相。被积函数涉及Berry联络 $\\mathbf{A}_{-}(Q) = i\\,\\langle \\phi_{-}(Q)\\,|\\,\\nabla_{Q}\\,\\phi_{-}(Q)\\rangle$。\n如前所述，实本征矢量 $|\\phi_{-}(Q)\\rangle$ 在 $\\mathcal{C}$ 上不是单值的。使用一个多值态进行直接积分是微妙的。更严谨的方法是首先构造一个单值的、（必然是）复的本征矢量 $|\\psi_{-}(Q)\\rangle$，然后进行积分。我们可以通过将 $|\\phi_{-}(\\theta)\\rangle$ 乘以一个合适的相因子来构造这样的态。\n令 $|\\psi_{-}(\\theta)\\rangle = e^{-i\\theta/2} |\\phi_{-}(\\theta)\\rangle$。让我们检查它的周期性：\n$$\n|\\psi_{-}(0)\\rangle = e^{0} |\\phi_{-}(0)\\rangle = |\\phi_{-}(0)\\rangle\n$$\n$$\n|\\psi_{-}(2\\pi)\\rangle = e^{-i\\pi} |\\phi_{-}(2\\pi)\\rangle = (-1) \\cdot (-|\\phi_{-}(0)\\rangle) = |\\phi_{-}(0)\\rangle\n$$\n态 $|\\psi_{-}(\\theta)\\rangle$ 在圆 $\\mathcal{C}$ 上是单值且连续的。我们现在可以使用这个态来计算几何相。在极坐标中，线元是 $d\\mathbf{Q} = \\rho d\\theta \\,\\hat{\\theta}$，梯度是 $\\nabla_Q = \\hat{\\rho}\\frac{\\partial}{\\partial \\rho} + \\hat{\\theta}\\frac{1}{\\rho}\\frac{\\partial}{\\partial \\theta}$。线积分变为：\n$$\n\\gamma_{-} = \\oint_{\\mathcal{C}} i \\langle\\psi_{-}|\\nabla_Q\\psi_{-}\\rangle \\cdot d\\mathbf{Q} = i \\int_{0}^{2\\pi} \\langle\\psi_{-}| \\left( \\hat{\\rho}\\frac{\\partial}{\\partial \\rho} + \\hat{\\theta}\\frac{1}{\\rho}\\frac{\\partial}{\\partial \\theta} \\right) \\psi_{-}\\rangle \\cdot (\\rho d\\theta \\,\\hat{\\theta})\n$$\n$$\n\\gamma_{-} = i \\int_{0}^{2\\pi} \\langle\\psi_{-}(\\theta)| \\frac{\\partial\\psi_{-}(\\theta)}{\\partial \\theta} \\rangle d\\theta\n$$\n我们计算被积项 $\\langle\\psi_{-}|\\partial_{\\theta}\\psi_{-}\\rangle$：\n$$\n|\\psi_{-}(\\theta)\\rangle = e^{-i\\theta/2} \\begin{pmatrix} \\sin(\\theta/2) \\\\ -\\cos(\\theta/2) \\end{pmatrix} = \\begin{pmatrix} e^{-i\\theta/2}\\sin(\\theta/2) \\\\ -e^{-i\\theta/2}\\cos(\\theta/2) \\end{pmatrix}\n$$\n$$\n\\frac{\\partial\\psi_{-}(\\theta)}{\\partial\\theta} = \\begin{pmatrix} -\\frac{i}{2}e^{-i\\theta/2}\\sin(\\theta/2) + \\frac{1}{2}e^{-i\\theta/2}\\cos(\\theta/2) \\\\ \\frac{i}{2}e^{-i\\theta/2}\\cos(\\theta/2) + \\frac{1}{2}e^{-i\\theta/2}\\sin(\\theta/2) \\end{pmatrix}\n$$\n内积为 $\\langle\\psi_{-}(\\theta)|\\partial_{\\theta}\\psi_{-}(\\theta)\\rangle$：\n$$\n\\langle\\psi_{-}|\\partial_{\\theta}\\psi_{-}\\rangle = e^{i\\theta/2}\\sin(\\frac{\\theta}{2}) \\left(-\\frac{i}{2}e^{-i\\theta/2}\\sin\\frac{\\theta}{2} + \\frac{1}{2}e^{-i\\theta/2}\\cos\\frac{\\theta}{2}\\right) - e^{i\\theta/2}\\cos(\\frac{\\theta}{2}) \\left(\\frac{i}{2}e^{-i\\theta/2}\\cos\\frac{\\theta}{2} + \\frac{1}{2}e^{-i\\theta/2}\\sin\\frac{\\theta}{2}\\right)\n$$\n$$\n= \\left(-\\frac{i}{2}\\sin^2\\frac{\\theta}{2} + \\frac{1}{2}\\sin\\frac{\\theta}{2}\\cos\\frac{\\theta}{2}\\right) - \\left(\\frac{i}{2}\\cos^2\\frac{\\theta}{2} + \\frac{1}{2}\\cos\\frac{\\theta}{2}\\sin\\frac{\\theta}{2}\\right)\n$$\n$$\n= -\\frac{i}{2}\\left(\\sin^2\\frac{\\theta}{2} + \\cos^2\\frac{\\theta}{2}\\right) = -\\frac{i}{2}\n$$\n几何相就是这个常数的积分：\n$$\n\\gamma_{-} = i \\int_{0}^{2\\pi} \\left(-\\frac{i}{2}\\right) d\\theta = \\frac{1}{2} \\int_{0}^{2\\pi} d\\theta = \\frac{1}{2}(2\\pi) = \\pi\n$$\n最后，计算完整群 $W_{-}(\\mathcal{C})$：\n$$\nW_{-}(\\mathcal{C}) = \\exp(i\\gamma_{-}) = \\exp(i\\pi) = -1\n$$\n这个 $-1$ 的值是双能级系统中环绕锥形交叉的标志。它是一个规范不变的量。", "answer": "$$\n\\boxed{-1}\n$$", "id": "2876959"}, {"introduction": "从解析模型到计算实践，我们将理论付诸代码。锥形交叉点是光化学反应的中心“漏斗”，在势能面上定位它们是模拟光诱导过程的关键一步。这个动手实践要求你设计并实现一个计算方案，用于在一个多维模型中寻找最小能量锥形交叉点。通过应用拉格朗日乘子法等约束优化技术，你将构建一个在现代光化学研究中具有基础性地位的计算工具，深刻理解寻找这些关键几何结构的算法原理。[@problem_id:2876964]", "problem": "给定一个双态线性振动耦合模型，该模型源于玻恩-奥本海默电子哈密顿量及其玻恩-黄展开，并采用非绝热表象来描述两个耦合的电子态。设核坐标汇集于向量 $\\mathbf{Q} \\in \\mathbb{R}^d$ 中。非绝热哈密顿量定义为\n$$\n\\mathbf{H}_{\\mathrm{dia}}(\\mathbf{Q}) = \\begin{pmatrix}\n\\alpha(\\mathbf{Q})  \\beta(\\mathbf{Q}) \\\\\n\\beta(\\mathbf{Q})  -\\alpha(\\mathbf{Q})\n\\end{pmatrix} + V_{\\mathrm{avg}}(\\mathbf{Q}) \\, \\mathbf{I},\n$$\n其中\n$$\n\\alpha(\\mathbf{Q}) = \\boldsymbol{\\kappa}^{\\top} \\mathbf{Q} + \\varepsilon, \\quad \\beta(\\mathbf{Q}) = \\boldsymbol{\\lambda}^{\\top} \\mathbf{Q}, \\quad V_{\\mathrm{avg}}(\\mathbf{Q}) = \\tfrac{1}{2} \\mathbf{Q}^{\\top} \\mathbf{A} \\mathbf{Q}.\n$$\n此处 $\\boldsymbol{\\kappa}, \\boldsymbol{\\lambda} \\in \\mathbb{R}^d$，$\\varepsilon \\in \\mathbb{R}$，且 $\\mathbf{A} \\in \\mathbb{R}^{d \\times d}$ 是一个对称正定矩阵。绝热能量为\n$$\nE_{\\pm}(\\mathbf{Q}) = V_{\\mathrm{avg}}(\\mathbf{Q}) \\pm \\sqrt{\\alpha(\\mathbf{Q})^2 + \\beta(\\mathbf{Q})^2}.\n$$\n在此模型中，当简并条件 $E_{+}(\\mathbf{Q}) = E_{-}(\\mathbf{Q})$ 成立时，会出现锥形交叉线缝，这等价于 $\\alpha(\\mathbf{Q})$ 和 $\\beta(\\mathbf{Q})$ 同时为零。分支平面向量是梯度差向量 $\\mathbf{g} = \\nabla_{\\mathbf{Q}} \\alpha(\\mathbf{Q}) = \\boldsymbol{\\kappa}$ 和非绝热耦合向量代理 $\\mathbf{h} = \\nabla_{\\mathbf{Q}} \\beta(\\mathbf{Q}) = \\boldsymbol{\\lambda}$（在此线性模型中它们是常数）。一条位于线缝上并沿其延伸的曲线 $\\mathbf{Q}(s)$ 必须一阶满足简并约束和正交条件\n$$\n\\alpha(\\mathbf{Q}(s)) = 0, \\quad \\beta(\\mathbf{Q}(s)) = 0, \\quad \\mathbf{g}^{\\top} \\tfrac{d\\mathbf{Q}}{ds} = 0, \\quad \\mathbf{h}^{\\top} \\tfrac{d\\mathbf{Q}}{ds} = 0.\n$$\n设计一个计算方案，通过在简并约束下最小化 $V_{\\mathrm{avg}}(\\mathbf{Q})$ 来定位锥形交叉线缝上的最小能量点，并通过同时对分支平面向量施加正交条件来计算该点处位于线缝上的单位切线方向。你的方案必须从第一性原理推导，并实现为一个可运行的程序，该程序：\n1. 使用基于拉格朗日乘子的数学上合理的约束优化方法，求解在约束条件 $\\alpha(\\mathbf{Q}) = 0$ 和 $\\beta(\\mathbf{Q}) = 0$ 下 $V_{\\mathrm{avg}}(\\mathbf{Q})$ 的最小值。\n2. 在所定位的点上计算一个单位切向量 $\\mathbf{t}$，该向量在所有满足 $\\boldsymbol{\\kappa}^{\\top} \\mathbf{t} = 0$、$\\boldsymbol{\\lambda}^{\\top} \\mathbf{t} = 0$ 和 $\\lVert \\mathbf{t} \\rVert = 1$ 的方向中，使局部二次型 $\\mathbf{t}^{\\top} \\mathbf{A} \\mathbf{t}$ 最小化。\n3. 报告用于验证简并性和正交性约束的定量残差。\n\n所有量都是无量纲的。不出现角度。你的程序必须为每个测试案例输出四个浮点数\n$$\n\\left[ V_{\\mathrm{avg}}(\\mathbf{Q}_{\\ast}), \\; \\Delta E(\\mathbf{Q}_{\\ast}), \\; \\left\\lVert \\mathbf{C}\\mathbf{t} \\right\\rVert_2, \\; \\mathbf{t}^{\\top} \\mathbf{A} \\mathbf{t} \\right],\n$$\n其中 $\\mathbf{Q}_{\\ast}$ 是约束最小化点（线缝上的最小能量点），$\\Delta E(\\mathbf{Q}_{\\ast}) = E_{+}(\\mathbf{Q}_{\\ast}) - E_{-}(\\mathbf{Q}_{\\ast})$ 是解处的绝热能隙（数值上应接近于零），$\\mathbf{C} \\in \\mathbb{R}^{2 \\times d}$ 是通过将 $\\boldsymbol{\\kappa}^{\\top}$ 和 $\\boldsymbol{\\lambda}^{\\top}$ 作为行堆叠而成的，而 $\\mathbf{t}$ 是计算出的单位切向量。正交残差为 $\\left\\lVert \\mathbf{C}\\mathbf{t} \\right\\rVert_2$，其数值应接近于零。曲率度量 $\\mathbf{t}^{\\top} \\mathbf{A} \\mathbf{t}$ 量化了沿所选切线方向的二次能量上升。\n\n测试套件：\n- 测试案例 1（基线正交分支平面）：\n  - $d = 3$,\n  - $\\mathbf{A} = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}$,\n  - $\\boldsymbol{\\kappa} = (1, 0, 0)^{\\top}$,\n  - $\\boldsymbol{\\lambda} = (0, 1, 0)^{\\top}$,\n  - $\\varepsilon = 0$.\n- 测试案例 2（通用，各向异性曲率）：\n  - $d = 3$,\n  - $\\mathbf{A} = \\begin{pmatrix} 3  0.2  0.1 \\\\ 0.2  2  0.3 \\\\ 0.1  0.3  1.5 \\end{pmatrix}$,\n  - $\\boldsymbol{\\kappa} = (1, 1, 0)^{\\top}$,\n  - $\\boldsymbol{\\lambda} = (1, -1, 1)^{\\top}$,\n  - $\\varepsilon = 0.5$.\n- 测试案例 3（近共线分支平面向量，稳定性边界情况）：\n  - $d = 4$,\n  - $\\mathbf{A} = \\begin{pmatrix} 2.5  0.3  0.2  0.0 \\\\ 0.3  2.4  0.1  0.0 \\\\ 0.2  0.1  1.8  0.05 \\\\ 0.0  0.0  0.05  1.6 \\end{pmatrix}$,\n  - $\\boldsymbol{\\kappa} = (1, 0.99, 0, 0)^{\\top}$,\n  - $\\boldsymbol{\\lambda} = (0.99, 1, 0.01, 0)^{\\top}$,\n  - $\\varepsilon = -0.2$.\n\n你的程序应生成单行输出，其中包含三个测试案例的结果，形式为包含三个列表的列表，每个内部列表按如下顺序排列\n$$\n\\left[ V_{\\mathrm{avg}}(\\mathbf{Q}_{\\ast}), \\; \\Delta E(\\mathbf{Q}_{\\ast}), \\; \\left\\lVert \\mathbf{C}\\mathbf{t} \\right\\rVert_2, \\; \\mathbf{t}^{\\top} \\mathbf{A} \\mathbf{t} \\right],\n$$\n四舍五入到六位小数，没有多余的空格。例如，输出格式必须完全像\n\"[[v11,v12,v13,v14],[v21,v22,v23,v24],[v31,v32,v33,v34]]\"。", "solution": "我们从分子哈密顿量开始，在玻恩-奥本海默分离下，其表达式为 $\\hat{H} = \\hat{T}_{\\mathrm{nuc}} + \\hat{H}_{\\mathrm{el}}(\\mathbf{R})$，其中 $\\hat{T}_{\\mathrm{nuc}}$ 是核动能算符，$\\hat{H}_{\\mathrm{el}}(\\mathbf{R})$ 是由核坐标 $\\mathbf{R}$ 参数化的电子哈密顿量。玻恩-黄展开将总波函数表示为对电子态的求和，其中包含核波函数，并引入了通过核导数耦合绝热态的非绝热耦合项。在非绝热表象和双态模型中，非绝热耦合被封装到非对角非绝热耦合项中。线性振动耦合模型将两个态的非绝热哈密顿量表示为\n$$\n\\mathbf{H}_{\\mathrm{dia}}(\\mathbf{Q}) = \\begin{pmatrix}\n\\alpha(\\mathbf{Q})  \\beta(\\mathbf{Q}) \\\\\n\\beta(\\mathbf{Q})  -\\alpha(\\mathbf{Q})\n\\end{pmatrix} + V_{\\mathrm{avg}}(\\mathbf{Q}) \\, \\mathbf{I},\n$$\n其中 $\\alpha(\\mathbf{Q}) = \\boldsymbol{\\kappa}^{\\top} \\mathbf{Q} + \\varepsilon$ 和 $\\beta(\\mathbf{Q}) = \\boldsymbol{\\lambda}^{\\top} \\mathbf{Q}$，而 $\\mathbf{Q}$ 是质量加权核坐标。绝热能量为\n$$\nE_{\\pm}(\\mathbf{Q}) = V_{\\mathrm{avg}}(\\mathbf{Q}) \\pm \\sqrt{\\alpha(\\mathbf{Q})^2 + \\beta(\\mathbf{Q})^2}.\n$$\n简并条件 $E_{+} = E_{-}$ 等价于 $\\sqrt{\\alpha^2 + \\beta^2} = 0$，因此等价于 $\\alpha(\\mathbf{Q}) = 0$ 和 $\\beta(\\mathbf{Q}) = 0$。在此模型中，张成分支平面的梯度差向量和非绝热耦合向量代理为\n$$\n\\mathbf{g} = \\nabla_{\\mathbf{Q}} (E_{+} - E_{-}) \\bigg|_{\\alpha=\\beta=0} \\propto \\nabla_{\\mathbf{Q}} \\alpha(\\mathbf{Q}) = \\boldsymbol{\\kappa}, \\quad \\mathbf{h} \\propto \\nabla_{\\mathbf{Q}} \\beta(\\mathbf{Q}) = \\boldsymbol{\\lambda}.\n$$\n在线缝上的某一点，任何保持在线缝上的无穷小位移 $\\mathrm{d} \\mathbf{Q}$ 必须不能一阶地打开能隙。将简并约束 $\\alpha(\\mathbf{Q})=0$ 和 $\\beta(\\mathbf{Q})=0$ 线性化，得到\n$$\n\\mathrm{d}\\alpha = \\boldsymbol{\\kappa}^{\\top} \\mathrm{d}\\mathbf{Q} = 0, \\quad \\mathrm{d}\\beta = \\boldsymbol{\\lambda}^{\\top} \\mathrm{d}\\mathbf{Q} = 0.\n$$\n因此，线缝上任意一点的线缝切向量 $\\mathbf{t}$ 必须满足正交条件\n$$\n\\boldsymbol{\\kappa}^{\\top} \\mathbf{t} = 0, \\quad \\boldsymbol{\\lambda}^{\\top} \\mathbf{t} = 0.\n$$\n线缝上的最小能量锥形交叉点使平均非绝热势\n$$\nV_{\\mathrm{avg}}(\\mathbf{Q}) = \\tfrac{1}{2} \\mathbf{Q}^{\\top} \\mathbf{A} \\mathbf{Q}\n$$\n在简并约束下最小化。这是一个具有两个线性约束的光滑等式约束优化问题。使用拉格朗日乘子，我们构造\n$$\n\\mathcal{L}(\\mathbf{Q}, \\boldsymbol{\\mu}) = \\tfrac{1}{2} \\mathbf{Q}^{\\top} \\mathbf{A} \\mathbf{Q} + \\mu_{1} \\, (\\boldsymbol{\\kappa}^{\\top} \\mathbf{Q} + \\varepsilon) + \\mu_{2} \\, (\\boldsymbol{\\lambda}^{\\top} \\mathbf{Q}),\n$$\n其一阶最优性（Karush–Kuhn–Tucker）条件为\n$$\n\\nabla_{\\mathbf{Q}} \\mathcal{L} = \\mathbf{A} \\mathbf{Q} + \\mu_{1} \\boldsymbol{\\kappa} + \\mu_{2} \\boldsymbol{\\lambda} = \\mathbf{0}, \\quad \\boldsymbol{\\kappa}^{\\top} \\mathbf{Q} + \\varepsilon = 0, \\quad \\boldsymbol{\\lambda}^{\\top} \\mathbf{Q} = 0.\n$$\n通过定义约束矩阵将这些条件整合到一个分块线性系统中\n$$\n\\mathbf{C} = \\begin{pmatrix} \\boldsymbol{\\kappa}^{\\top} \\\\ \\boldsymbol{\\lambda}^{\\top} \\end{pmatrix}, \\quad \\mathbf{c} = \\begin{pmatrix} \\varepsilon \\\\ 0 \\end{pmatrix}, \\quad \\boldsymbol{\\mu} = \\begin{pmatrix} \\mu_{1} \\\\ \\mu_{2} \\end{pmatrix}.\n$$\nKKT 系统为\n$$\n\\begin{pmatrix}\n\\mathbf{A}  \\mathbf{C}^{\\top} \\\\\n\\mathbf{C}  \\mathbf{0}\n\\end{pmatrix}\n\\begin{pmatrix}\n\\mathbf{Q}_{\\ast} \\\\\n\\boldsymbol{\\mu}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\mathbf{0} \\\\\n-\\mathbf{c}\n\\end{pmatrix}.\n$$\n由于在适定情况（线性无关约束）下 $\\mathbf{A}$ 是正定的且 $\\mathbf{C}$ 是行满秩的，这个鞍点系统对于 $(\\mathbf{Q}_{\\ast}, \\boldsymbol{\\mu})$ 有唯一解，从而得到线缝上的最小能量点。\n\n为了量化解处的简并性，我们计算绝热能隙\n$$\n\\Delta E(\\mathbf{Q}_{\\ast}) = E_{+}(\\mathbf{Q}_{\\ast}) - E_{-}(\\mathbf{Q}_{\\ast}) = 2 \\sqrt{\\alpha(\\mathbf{Q}_{\\ast})^2 + \\beta(\\mathbf{Q}_{\\ast})^2},\n$$\n其数值上应接近于零。\n\n对于一个沿着线缝并同时满足正交条件的方向，我们要求 $\\mathbf{t}$ 满足 $\\mathbf{C} \\mathbf{t} = \\mathbf{0}$ 和 $\\lVert \\mathbf{t} \\rVert = 1$。在所有这样的方向中，一个使 $V_{\\mathrm{avg}}$ 局部增量最小化的自然选择是瑞利商的最小化者\n$$\n\\min_{\\mathbf{t} \\in \\mathbb{R}^{d}} \\; \\mathbf{t}^{\\top} \\mathbf{A} \\mathbf{t} \\quad \\text{subject to} \\quad \\mathbf{C} \\mathbf{t} = \\mathbf{0}, \\; \\lVert \\mathbf{t} \\rVert = 1.\n$$\n设 $\\mathbf{Z} \\in \\mathbb{R}^{d \\times (d-2)}$ 的各列是标准正交的，并张成 $\\mathbf{C}$ 的零空间，即 $\\mathbf{C} \\mathbf{Z} = \\mathbf{0}$ 且 $\\mathbf{Z}^{\\top} \\mathbf{Z} = \\mathbf{I}$。任何可行的 $\\mathbf{t}$ 都可以写成 $\\mathbf{t} = \\mathbf{Z} \\mathbf{y}$ 的形式，其中 $\\lVert \\mathbf{y} \\rVert = 1$。那么\n$$\n\\mathbf{t}^{\\top} \\mathbf{A} \\mathbf{t} = \\mathbf{y}^{\\top} \\left( \\mathbf{Z}^{\\top} \\mathbf{A} \\mathbf{Z} \\right) \\mathbf{y},\n$$\n通过选择 $\\mathbf{y}$ 为 $\\mathbf{Z}^{\\top} \\mathbf{A} \\mathbf{Z}$ 最小特征值对应的归一化特征向量，可以使该式最小化。根据构造，得到的 $\\mathbf{t}$ 与 $\\boldsymbol{\\kappa}$ 和 $\\boldsymbol{\\lambda}$ 均正交，并且相对于 $V_{\\mathrm{avg}}$ 具有最小的二次曲率。\n\n算法设计：\n1. 对于每个测试案例，读取 $\\mathbf{A}$、$\\boldsymbol{\\kappa}$、$\\boldsymbol{\\lambda}$ 和 $\\varepsilon$，并构造 $\\mathbf{C}$ 和 $\\mathbf{c}$。\n2. 使用直接线性求解器求解 KKT 系统，得到 $(\\mathbf{Q}_{\\ast}, \\boldsymbol{\\mu})$。这给出了线缝上的最小能量锥形交叉点。\n3. 计算 $V_{\\mathrm{avg}}(\\mathbf{Q}_{\\ast}) = \\tfrac{1}{2} \\mathbf{Q}_{\\ast}^{\\top} \\mathbf{A} \\mathbf{Q}_{\\ast}$、$\\alpha(\\mathbf{Q}_{\\ast}) = \\boldsymbol{\\kappa}^{\\top} \\mathbf{Q}_{\\ast} + \\varepsilon$、$\\beta(\\mathbf{Q}_{\\ast}) = \\boldsymbol{\\lambda}^{\\top} \\mathbf{Q}_{\\ast}$ 和绝热能隙 $\\Delta E(\\mathbf{Q}_{\\ast}) = 2 \\sqrt{\\alpha(\\mathbf{Q}_{\\ast})^2 + \\beta(\\mathbf{Q}_{\\ast})^2}$。\n4. 使用奇异值分解计算 $\\mathbf{C}$ 的零空间的标准正交基 $\\mathbf{Z}$：如果 $\\mathbf{C} = \\mathbf{U} \\boldsymbol{\\Sigma} \\mathbf{V}^{\\top}$，则 $\\mathbf{V}$ 中对应于零奇异值的列张成零空间。提取这些列以形成 $\\mathbf{Z}$。\n5. 形成降维矩阵 $\\mathbf{M} = \\mathbf{Z}^{\\top} \\mathbf{A} \\mathbf{Z}$ 并计算其最小特征对 $(\\lambda_{\\min}, \\mathbf{y}_{\\min})$。设置 $\\mathbf{t} = \\mathbf{Z} \\mathbf{y}_{\\min}$ 并归一化为单位长度。\n6. 评估正交残差 $\\lVert \\mathbf{C} \\mathbf{t} \\rVert_{2}$ 和曲率 $\\mathbf{t}^{\\top} \\mathbf{A} \\mathbf{t}$（归一化后等于 $\\lambda_{\\min}$）。\n7. 为每个测试案例输出列表 $[ V_{\\mathrm{avg}}(\\mathbf{Q}_{\\ast}), \\Delta E(\\mathbf{Q}_{\\ast}), \\lVert \\mathbf{C} \\mathbf{t} \\rVert_{2}, \\mathbf{t}^{\\top} \\mathbf{A} \\mathbf{t} ]$，四舍五入到六位小数。\n\n数值考量：\n- 当 $\\mathbf{A}$ 是正定的且 $\\mathbf{C}$ 是行满秩时，KKT 矩阵是不定的但却是良态的。对于这里使用的小型稠密系统，带主元选择的直接求解器就足够了。\n- 对于近共线的 $\\boldsymbol{\\kappa}$ 和 $\\boldsymbol{\\lambda}$，使用奇异值分解来稳健地确定零空间基，以避免数值不稳定性。\n- 将输出四舍五入到六位小数提供了一个稳定、可比较的表示，同时在数值容差内保留了物理上相关的零残差。\n\n所实现的程序遵循此协议处理指定的测试套件，并以所需格式打印包含三个结果列表的单行内容。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve_kkt(A, kappa, lam, eps):\n    \"\"\"\n    Solve the KKT system for minimizing 0.5 Q^T A Q subject to\n    kappa^T Q + eps = 0 and lam^T Q = 0.\n    Returns Q_star.\n    \"\"\"\n    d = A.shape[0]\n    C = np.vstack([kappa.reshape(1, -1), lam.reshape(1, -1)])  # 2 x d\n    c = np.array([eps, 0.0])\n    # Build KKT matrix and RHS:\n    KKT = np.block([[A, C.T],\n                    [C, np.zeros((2, 2))]])\n    rhs = np.concatenate([np.zeros(d), -c])\n    # Solve\n    sol = np.linalg.solve(KKT, rhs)\n    Q_star = sol[:d]\n    return Q_star\n\ndef adiabatic_gap_and_energy(Q, A, kappa, lam, eps):\n    \"\"\"\n    Compute V_avg(Q) and the adiabatic gap DeltaE at Q.\n    \"\"\"\n    Vavg = 0.5 * float(Q.T @ A @ Q)\n    alpha = float(kappa.T @ Q + eps)\n    beta = float(lam.T @ Q)\n    gap = 2.0 * np.sqrt(alpha**2 + beta**2)\n    return Vavg, gap, alpha, beta\n\ndef nullspace(C, rtol=1e-12):\n    \"\"\"\n    Compute an orthonormal basis for the null space of C using SVD.\n    Returns Z with shape (d, d - rank(C)).\n    \"\"\"\n    U, S, Vt = np.linalg.svd(C, full_matrices=True)\n    # Rank determination\n    tol = rtol * S.max() if S.size > 0 else 0.0\n    rank = int(np.sum(S > tol))\n    d = C.shape[1]\n    if rank > d:\n        # Should not happen, but guard anyway\n        rank = d\n    # Null space spanned by last d - rank rows of Vt\n    Z = Vt[rank:].T  # shape (d, d - rank)\n    return Z\n\ndef seam_tangent(A, kappa, lam):\n    \"\"\"\n    Compute a unit tangent vector t that lies on the seam (orthogonal to kappa and lam),\n    minimizing t^T A t subject to ||t||=1 and C t = 0.\n    Returns t (unit vector) and curvature value t^T A t.\n    \"\"\"\n    C = np.vstack([kappa.reshape(1, -1), lam.reshape(1, -1)])  # 2 x d\n    Z = nullspace(C)\n    # If nullspace is empty (degenerate case), raise error\n    if Z.size == 0 or Z.shape[1] == 0:\n        # Fall back: try to find any vector orthogonal to both using least squares\n        d = C.shape[1]\n        # Project identity onto nullspace numerically using QR of C^T\n        Qc, _ = np.linalg.qr(C.T)\n        # Build projector onto nullspace approx\n        P = np.eye(d) - Qc[:, :C.shape[0]] @ Qc[:, :C.shape[0]].T\n        # Choose a random vector and project\n        v = np.zeros(d)\n        v[-1] = 1.0\n        t = P @ v\n        nrm = np.linalg.norm(t)\n        if nrm  1e-14:\n            # As a last resort, return zeros to avoid crash; curvature is NaN\n            return np.zeros(d), np.nan\n        t = t / nrm\n        curv = float(t.T @ A @ t)\n        return t, curv\n    # Reduced matrix\n    M = Z.T @ A @ Z\n    # Smallest eigenpair\n    evals, evecs = np.linalg.eigh(M)\n    idx = np.argmin(evals)\n    y = evecs[:, idx]\n    t = Z @ y\n    # Normalize to unit length\n    nrm = np.linalg.norm(t)\n    if nrm  1e-14:\n        # Numerical issue; pick another direction\n        # Choose next eigenvector if available\n        if evecs.shape[1] > 1:\n            y = evecs[:, (idx + 1) % evecs.shape[1]]\n            t = Z @ y\n            nrm = np.linalg.norm(t)\n            if nrm  1e-14:\n                # Give up gracefully\n                return np.zeros(Z.shape[0]), np.nan\n        else:\n            return np.zeros(Z.shape[0]), np.nan\n    t = t / nrm\n    curv = float(t.T @ A @ t)\n    return t, curv\n\ndef format_results(results):\n    # Format as [[a,b,c,d],[...],...] with six decimals and no spaces\n    def fmt(x):\n        if np.isnan(x) or np.isinf(x):\n            return \"nan\"\n        return f\"{x:.6f}\"\n    inner = []\n    for lst in results:\n        inner.append(\"[\" + \",\".join(fmt(v) for v in lst) + \"]\")\n    return \"[\" + \",\".join(inner) + \"]\"\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Test case 1\n    A1 = np.array([[1.0, 0.0, 0.0],\n                   [0.0, 1.0, 0.0],\n                   [0.0, 0.0, 1.0]])\n    k1 = np.array([1.0, 0.0, 0.0])\n    l1 = np.array([0.0, 1.0, 0.0])\n    eps1 = 0.0\n\n    # Test case 2\n    A2 = np.array([[3.0, 0.2, 0.1],\n                   [0.2, 2.0, 0.3],\n                   [0.1, 0.3, 1.5]])\n    k2 = np.array([1.0, 1.0, 0.0])\n    l2 = np.array([1.0, -1.0, 1.0])\n    eps2 = 0.5\n\n    # Test case 3\n    A3 = np.array([[2.5, 0.3, 0.2, 0.0],\n                   [0.3, 2.4, 0.1, 0.0],\n                   [0.2, 0.1, 1.8, 0.05],\n                   [0.0, 0.0, 0.05, 1.6]])\n    k3 = np.array([1.0, 0.99, 0.0, 0.0])\n    l3 = np.array([0.99, 1.0, 0.01, 0.0])\n    eps3 = -0.2\n\n    test_cases = [\n        (A1, k1, l1, eps1),\n        (A2, k2, l2, eps2),\n        (A3, k3, l3, eps3),\n    ]\n\n    results = []\n    for A, kappa, lam, eps in test_cases:\n        Q_star = solve_kkt(A, kappa, lam, eps)\n        Vavg, gap, alpha, beta = adiabatic_gap_and_energy(Q_star, A, kappa, lam, eps)\n        t, curvature = seam_tangent(A, kappa, lam)\n        C = np.vstack([kappa.reshape(1, -1), lam.reshape(1, -1)])\n        orth_resid = float(np.linalg.norm(C @ t))\n        results.append([Vavg, gap, orth_resid, curvature])\n\n    # Final print statement in the exact required format.\n    print(format_results(results))\n\nsolve()\n```", "id": "2876964"}]}