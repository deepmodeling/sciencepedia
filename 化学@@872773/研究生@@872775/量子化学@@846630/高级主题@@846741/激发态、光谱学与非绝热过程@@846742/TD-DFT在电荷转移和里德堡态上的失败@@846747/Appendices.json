{"hands_on_practices": [{"introduction": "Hubbard二聚体是凝聚态物理和量子化学中的一个基石模型，为理解电子相关性提供了一个简化但功能强大的框架。本练习 [@problem_id:2878994] 深入探讨非对称双中心Hubbard模型，旨在从解析上推导含时密度泛函理论（TD-DFT）对于电荷转移（CT）激发的误差。通过对比精确的多体激发能和绝热局域密度近似（ALDA）的预测结果，你将揭示标准泛函在描述长程电荷转移时失效的核心原因。", "problem": "考虑一个包含两个电子的非对称双位点哈伯德二聚体，其哈密顿量定义为\n$$\n\\hat{H} \\;=\\; -t \\sum_{\\sigma}\\left(\\hat{c}_{1\\sigma}^{\\dagger}\\hat{c}_{2\\sigma} + \\hat{c}_{2\\sigma}^{\\dagger}\\hat{c}_{1\\sigma}\\right) \\;+\\; U \\sum_{i=1}^{2} \\hat{n}_{i\\uparrow}\\hat{n}_{i\\downarrow} \\;+\\; \\frac{\\Delta}{2}\\,(\\hat{n}_{1}-\\hat{n}_{2}),\n$$\n其中 $t0$ 是位点间跃迁参数，$U0$ 是在位相互作用参数，$\\Delta0$ 是位点能量不对称性，在位能量分别为 $\\varepsilon_{1}=+\\Delta/2$ 和 $\\varepsilon_{2}=-\\Delta/2$。$\\hat{c}_{i\\sigma}^{\\dagger}$ 在位点 $i$ 上产生一个自旋为 $\\sigma$ 的电子，且 $\\hat{n}_{i\\sigma}=\\hat{c}_{i\\sigma}^{\\dagger}\\hat{c}_{i\\sigma}$，$\\hat{n}_{i}=\\hat{n}_{i\\uparrow}+\\hat{n}_{i\\downarrow}$。在 $t \\to 0^{+}$ 的严格极限下进行研究，其中 $0  \\Delta  U$。\n\n1.  推导精确的多体基态能量 $E_{\\text{g}}$ 和最低单重态电荷转移激发能 $\\omega_{\\text{exact}}$。\n2.  推导采用绝热局域密度近似（ALDA）的线性响应含时密度泛函理论（TDDFT）对能够复现相互作用基态密度的精确科恩-尚（KS）参考体系的电荷转移激发能的预测结果 $\\omega_{\\text{ALDA}}$。\n3.  计算 TDDFT-ALDA 的误差，$\\text{Error} = \\omega_{\\text{exact}} - \\omega_{\\text{ALDA}}$。\n\n在您的最终答案中，仅报告精确的电荷转移激发能 $\\omega_{\\text{exact}}$。", "solution": "我们首先在 $t \\to 0^{+}$ 的严格极限下描述多体谱的特征。在此极限下，由于跃迁项消失，哈密顿量 $\\hat{H}$ 在位点占据数基矢下是对角的。对于两个电子，相关的粒子数态构型及其与相互作用无关的在位能量为：\n- 双占据的低能位点（位点2）：$|0,2\\rangle$，其能量为\n$$\nE(0,2) \\;=\\; 2\\varepsilon_{2} + U \\;=\\; 2\\left(-\\frac{\\Delta}{2}\\right) + U \\;=\\; -\\Delta + U.\n$$\n- 每个位点上有一个电子（单重态部分）：$|1,1\\rangle_{S}$，其能量为\n$$\nE(1,1) \\;=\\; \\varepsilon_{1} + \\varepsilon_{2} \\;=\\; \\frac{\\Delta}{2} + \\left(-\\frac{\\Delta}{2}\\right) \\;=\\; 0.\n$$\n- 双占据的高能位点（位点1）：$|2,0\\rangle$，其能量为\n$$\nE(2,0) \\;=\\; 2\\varepsilon_{1} + U \\;=\\; 2\\left(+\\frac{\\Delta}{2}\\right) + U \\;=\\; +\\Delta + U.\n$$\n\n给定 $0  \\Delta  U$，这些能量的顺序是\n$$\nE(0,2) \\;=\\; -\\Delta + U \\;\\; 0 \\quad \\text{and} \\quad E(2,0) \\;=\\; \\Delta + U \\;\\; 0,\n$$\n因此，能量最低的态是每个位点上有一个电子的态（以避免在位排斥），即\n$$\nE_{\\text{g}} \\;=\\; E(1,1) \\;=\\; 0.\n$$\n最低的电荷转移激发态对应于将一个电子转移到低能位点，在位点2上形成双占据，即 $|0,2\\rangle$，因为当 $\\Delta>0$ 时，$E(0,2)  E(2,0)$。因此，精确的多体电荷转移激发能为\n$$\n\\omega_{\\text{exact}} \\;=\\; E(0,2) - E_{\\text{g}} \\;=\\; (-\\Delta + U) - 0 \\;=\\; U - \\Delta.\n$$\n\n接下来，我们分析采用绝热局域密度近似（ALDA）的线性响应含时密度泛函理论（TDDFT）对能够复现相互作用基态密度的精确科恩-尚（KS）参考体系的预测。在 $0  \\Delta  U$ 和 $t \\to 0^{+}$ 极限下，基态密度为每个位点上恰好有一个电子，即 $n_1=1$ 和 $n_2=1$。精确的科恩-尚势必须复现该密度。对于一个非相互作用体系，要使每个位点上的密度相等，两个位点的在位能量必须是简并的，即 $\\varepsilon_1^{\\text{KS}} = \\varepsilon_2^{\\text{KS}}$。这导致了两个简并的 KS 轨道。在塔姆-丹可夫近似下，TDDFT 的激发能由下式给出\n$$\n\\omega_{ia} \\approx \\varepsilon_a - \\varepsilon_i + K_{ia,ia},\n$$\n其中 $K_{ia,ia}$ 是交换相关核矩阵元。电荷转移激发对应于从位点1的轨道到（或线性组合到）位点2的轨道的跃迁。由于科恩-尚轨道是简并的，轨道能差为 $\\varepsilon_a - \\varepsilon_i = 0$。此外，对于局域近似如 ALDA，当轨道 $i$ 和 $a$ 在空间上分离时（如在本极限中），核矩阵元 $K_{ia,ia} \\to 0$。因此，TDDFT-ALDA 的预测为\n$$\n\\omega_{\\text{ALDA}} \\;=\\; 0.\n$$\n这个灾难性的失败源于 ALDA 交换相关核的局域性，它无法描述长程电荷转移激发中电子-空穴的库仑吸引。因此，TDDFT 误差为\n$$\n\\text{Error} = \\omega_{\\text{exact}} - \\omega_{\\text{ALDA}} = (U-\\Delta) - 0 = U-\\Delta.\n$$\n最终答案是精确的电荷转移激发能。", "answer": "$$\\boxed{U-\\Delta}$$", "id": "2878994"}, {"introduction": "理解TD-DFT失效的理论根源是第一步，接下来是在实践中诊断这些问题。这个动手练习 [@problem_id:2878978] 将指导你通过分析激发引起的密度差 $\\Delta\\rho(x)$ 来量化电子激发的特征。通过编程实现并计算用于衡量电荷转移特性 ($f_{\\mathrm{CT}}$) 和里德堡特性 ($f_{\\mathrm{Ry}}$) 的简洁而强大的指标，你将掌握一项实用技能，用于识别那些可能被标准TD-DFT近似严重错误描述的激发态。", "problem": "您将使用一维归一化的电子密度作为占据轨道和虚拟轨道概率密度的代表，来建模和量化单电子激发中的电荷转移和里德堡特征。目的是将激发引起的密度变化的片段划分形式化，并计算两个无量纲的度量指标，用于标记已知会导致含时密度泛函理论（TD-DFT）失效的情景：长程电荷转移和弥散（类里德堡）特征。\n\n从以下基本依据开始：\n\n- 一维空间中单个电子的电子密度是一个非负函数 $\\rho(x)$，其积分结果为 1 个电子：\n$$\\int_{-\\infty}^{+\\infty} \\rho(x)\\, dx = 1.$$\n- 从密度为 $\\rho_i(x)$ 的占据态到密度为 $\\rho_a(x)$ 的虚拟态的单电子激发过程保持电子数守恒，其激发引起的差分密度定义为\n$$\\Delta \\rho(x) = \\rho_a(x) - \\rho_i(x), \\quad \\text{with} \\quad \\int_{-\\infty}^{+\\infty} \\Delta \\rho(x)\\, dx = 0.$$\n- 根据 $x$ 的符号将实轴划分为给体和受体片段：\n$$D = \\{ x \\in \\mathbb{R} \\, | \\, x \\le 0 \\}, \\quad A = \\{ x \\in \\mathbb{R} \\, | \\, x > 0 \\}.$$\n- 对于任意实数 $y$，定义其正部为 $[y]_+ = \\max(y, 0)$。\n\n定义以下定量度量指标：\n\n- 从给体到受体的电荷转移量（以电子为单位）为\n$$Q_A^+ = \\int_A [\\Delta \\rho(x)]_+ \\, dx, \\qquad Q_D^- = \\int_D [-\\Delta \\rho(x)]_+ \\, dx,$$\n电荷转移度量指标为\n$$f_{\\mathrm{CT}} = \\min\\left(Q_A^+,\\, Q_D^-\\right).$$\n对于一个理想的、纯粹的从给体到受体的电荷转移，$f_{\\mathrm{CT}}$ 接近 1 个电子；对于单个片段上的局域激发，$f_{\\mathrm{CT}}$ 接近 0。\n- 里德堡性（弥散度）由出现在渐近区域的增加电子密度的分数决定\n$$R = \\{ x \\in \\mathbb{R} \\, | \\, |x| \\ge R_c \\},$$\n如下：\n$$f_{\\mathrm{Ry}} = \\frac{\\int_R [\\Delta \\rho(x)]_+ \\, dx}{\\int_{-\\infty}^{+\\infty} [\\Delta \\rho(x)]_+ \\, dx}.$$\n较大的 $f_{\\mathrm{Ry}}$ 值表明增加的电子密度非常弥散，如同在里德堡激发中一样。\n\n在本问题中，用归一化的高斯密度（正态分布）来近似占据轨道和虚拟轨道的概率密度：\n$$\\rho(x; \\mu, \\sigma) = \\frac{1}{\\sigma \\sqrt{2\\pi}} \\exp\\!\\left( -\\frac{(x-\\mu)^2}{2\\sigma^2} \\right),$$\n其中平均位置为 $\\mu$（单位为玻尔），标准差为 $\\sigma$（单位为玻尔）。对于单次激发，设置 $\\rho_i(x) = \\rho(x; \\mu_i, \\sigma_i)$ 和 $\\rho_a(x) = \\rho(x; \\mu_a, \\sigma_a)$。\n\n数值计算说明：\n\n- 在 $x \\in [x_{\\min}, x_{\\max}]$ 上使用间距为 $\\Delta x$ 的均匀网格，并用黎曼和近似积分，\n$$\\int g(x)\\, dx \\approx \\sum_k g(x_k) \\, \\Delta x.$$\n- 使用给体区域 $D = \\{ x \\le 0 \\}$ 和受体区域 $A = \\{ x > 0 \\}$，以及一个渐近截断半径 $R_c$（所有距离均以玻尔为单位，记作 $a_0$）。\n- 所有输出均为无量纲，且必须报告为四舍五入到小数点后六位的小数。\n\n测试集：\n\n对于所有测试用例，使用 $x_{\\min} = -50\\, a_0$，$x_{\\max} = +50\\, a_0$，$\\Delta x = 0.01\\, a_0$ 和 $R_c = 4.0\\, a_0$。每个测试用例指定 $(\\mu_i, \\sigma_i, \\mu_a, \\sigma_a)$（单位为玻尔）：\n\n- 案例 1（给体上的局域激发）：$(\\mu_i, \\sigma_i, \\mu_a, \\sigma_a) = (-3.0, 0.5, -2.5, 0.6)$。\n- 案例 2（长程电荷转移）：$(\\mu_i, \\sigma_i, \\mu_a, \\sigma_a) = (-3.0, 0.5, +3.0, 0.5)$。\n- 案例 3（给体上的类里德堡激发）：$(\\mu_i, \\sigma_i, \\mu_a, \\sigma_a) = (-2.0, 0.6, -2.0, 3.0)$。\n- 案例 4（混合电荷转移和里德堡特征）：$(\\mu_i, \\sigma_i, \\mu_a, \\sigma_a) = (-2.5, 0.7, +2.0, 2.5)$。\n\n任务：\n\n- 编写一个完整程序，对于每个测试用例，在指定的网格上构建 $\\rho_i(x)$ 和 $\\rho_a(x)$，形成 $\\Delta \\rho(x)$，并计算上面定义的 $f_{\\mathrm{CT}}$ 和 $f_{\\mathrm{Ry}}$。\n- 如果 $f_{\\mathrm{Ry}}$ 中的分母在数值上为零（低于 $10^{-12}$），则设置 $f_{\\mathrm{Ry}} = 0$。\n- 将每个度量指标四舍五入到小数点后六位。\n\n最终输出格式：\n\n您的程序应生成一行输出，其中包含一个用逗号分隔、方括号括起来的结果列表，顺序如下\n$$[f_{\\mathrm{CT}}^{(1)}, f_{\\mathrm{Ry}}^{(1)}, f_{\\mathrm{CT}}^{(2)}, f_{\\mathrm{Ry}}^{(2)}, f_{\\mathrm{CT}}^{(3)}, f_{\\mathrm{Ry}}^{(3)}, f_{\\mathrm{CT}}^{(4)}, f_{\\mathrm{Ry}}^{(4)}],$$\n其中上标表示测试用例索引。例如，输出必须如下所示\n$$[0.123456,0.654321,0.111111,0.222222,0.333333,0.444444,0.555555,0.666666],$$\n包含恰好八个四舍五入到小数点后六位的小数。", "solution": "该问题要求计算一维模型系统中单电子激发的两个度量指标：电荷转移度量 $f_{\\mathrm{CT}}$ 和里德堡性度量 $f_{\\mathrm{Ry}}$。该问题在科学上是有效的、适定的，并为获得唯一的数值解提供了所有必要信息。该模型虽然经过简化，但正确地捕捉了电荷转移和里德堡激发的基本特征，这些是含时密度泛函理论中标准近似的已知问题案例。我们将根据所提供的定义进行直接的数值实现。\n\n这个问题的基础是单电子密度 $\\rho(x)$ 的概念，它是一个非负函数，归一化为 1 个电子：\n$$\n\\int_{-\\infty}^{+\\infty} \\rho(x)\\, dx = 1.\n$$\n激发被建模为从密度为 $\\rho_i(x)$ 的初始（占据）态到密度为 $\\rho_a(x)$ 的最终（虚拟）态的跃迁。电子密度的变化由差分密度 $\\Delta \\rho(x)$ 描述：\n$$\n\\Delta \\rho(x) = \\rho_a(x) - \\rho_i(x).\n$$\n由于 $\\rho_i(x)$ 和 $\\rho_a(x)$ 的归一化，$\\Delta \\rho(x)$ 在全空间上的积分为零，这表示总电子数守恒。\n\n对激发特征的分析是通过划分系统并对 $\\Delta \\rho(x)$ 的部分进行积分来执行的。实轴被划分为一个给体片段 $D = \\{ x \\in \\mathbb{R} \\, | \\, x \\le 0 \\}$ 和一个受体片段 $A = \\{ x \\in \\mathbb{R} \\, | \\, x > 0 \\}$。\n\n占据态和虚拟态的密度由归一化的高斯函数建模：\n$$\n\\rho(x; \\mu, \\sigma) = \\frac{1}{\\sigma \\sqrt{2\\pi}} \\exp\\!\\left( -\\frac{(x-\\mu)^2}{2\\sigma^2} \\right),\n$$\n其中 $\\mu$ 是平均位置，$\\sigma$ 是标准差。因此，$\\rho_i(x) = \\rho(x; \\mu_i, \\sigma_i)$ 和 $\\rho_a(x) = \\rho(x; \\mu_a, \\sigma_a)$。\n\n数值解将在离散的空间网格上构建。定义域指定为 $x \\in [-50, 50]\\,a_0$，网格间距为 $\\Delta x = 0.01\\,a_0$。这定义了一组离散点 $x_k = x_{\\min} + k \\Delta x$。积分被近似为黎曼和，例如 $\\int g(x) dx \\approx \\sum_k g(x_k) \\Delta x$。\n\n首先，我们计算电荷转移度量 $f_{\\mathrm{CT}}$。该度量量化了在给体和受体片段之间移动的电荷量。我们将实数 $y$ 的正部定义为 $[y]_+ = \\max(y, 0)$。受体获得的电荷量是 $\\Delta \\rho(x)$ 的正部在受体区域 $A$ 上的积分：\n$$\nQ_A^+ = \\int_A [\\Delta \\rho(x)]_+ \\, dx \\approx \\sum_{x_k > 0} [\\Delta \\rho(x_k)]_+ \\Delta x.\n$$\n类似地，给体失去的电荷量是 $-\\Delta \\rho(x)$ 的正部在给体区域 $D$ 上的积分：\n$$\nQ_D^- = \\int_D [-\\Delta \\rho(x)]_+ \\, dx \\approx \\sum_{x_k \\le 0} [-\\Delta \\rho(x_k)]_+ \\Delta x.\n$$\n然后，电荷转移度量被定义为这两个量中的较小者：\n$$\nf_{\\mathrm{CT}} = \\min(Q_A^+, Q_D^-).\n$$\n对于从完全包含在 $D$ 中的给体到完全包含在 $A$ 中的受体的纯电荷转移激发， $Q_A^+$ 和 $Q_D^-$ 都将接近 1，因此 $f_{\\mathrm{CT}}$ 也将接近 1。对于单个片段内的局域激发，这两个量中的一个将接近于零，使得 $f_{\\mathrm{CT}}$ 接近于 0。\n\n其次，我们计算里德堡性度量 $f_{\\mathrm{Ry}}$。该度量通过量化位于渐近区域 $R = \\{ x \\in \\mathbb{R} \\, | \\, |x| \\ge R_c \\}$ 内的增加电子密度 $[\\Delta \\rho(x)]_+$ 的分数来测量激发的弥散度。截断半径给定为 $R_c = 4.0\\,a_0$。该度量定义为以下比率：\n$$\nf_{\\mathrm{Ry}} = \\frac{\\int_R [\\Delta \\rho(x)]_+ \\, dx}{\\int_{-\\infty}^{+\\infty} [\\Delta \\rho(x)]_+ \\, dx}.\n$$\n对于单电子激发，总增加电荷（即分母）必须等于 1。在数值上，这计算如下：\n$$\n\\text{Numerator} = \\sum_{|x_k| \\ge R_c} [\\Delta \\rho(x_k)]_+ \\Delta x.\n$$\n$$\n\\text{Denominator} = \\sum_{\\text{all } k} [\\Delta \\rho(x_k)]_+ \\Delta x.\n$$\n如果分母小于 $10^{-12}$ 的数值阈值，$f_{\\mathrm{Ry}}$ 被设置为 0。较大的 $f_{\\mathrm{Ry}}$ 值表明虚拟轨道是弥散的，这是里德堡态的特征。\n\n该算法通过遍历所提供的四个测试用例来进行：\n1.  案例 1：$(\\mu_i, \\sigma_i, \\mu_a, \\sigma_a) = (-3.0, 0.5, -2.5, 0.6)$\n2.  案例 2：$(\\mu_i, \\sigma_i, \\mu_a, \\sigma_a) = (-3.0, 0.5, +3.0, 0.5)$\n3.  案例 3：$(\\mu_i, \\sigma_i, \\mu_a, \\sigma_a) = (-2.0, 0.6, -2.0, 3.0)$\n4.  案例 4：$(\\mu_i, \\sigma_i, \\mu_a, \\sigma_a) = (-2.5, 0.7, +2.0, 2.5)$\n\n对于每个案例，我们在网格上构建密度 $\\rho_i(x)$ 和 $\\rho_a(x)$，计算 $\\Delta \\rho(x)$，然后应用求和公式计算 $f_{\\mathrm{CT}}$ 和 $f_{\\mathrm{Ry}}$。最终结果按要求四舍五入到小数点后六位。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes charge-transfer (f_CT) and Rydbergness (f_Ry) metrics\n    for four test cases of a 1D single-electron excitation model.\n    \"\"\"\n    # Define the global numerical parameters.\n    # All units are in bohr (a_0) or are dimensionless.\n    x_min = -50.0\n    x_max = 50.0\n    dx = 0.01\n    R_c = 4.0\n    \n    # Generate the uniform spatial grid.\n    num_points = int((x_max - x_min) / dx) + 1\n    x = np.linspace(x_min, x_max, num_points)\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (mu_i, sigma_i, mu_a, sigma_a)\n    test_cases = [\n        (-3.0, 0.5, -2.5, 0.6),  # Case 1: local excitation on donor\n        (-3.0, 0.5, 3.0, 0.5),   # Case 2: long-range charge transfer\n        (-2.0, 0.6, -2.0, 3.0),  # Case 3: Rydberg-like on donor\n        (-2.5, 0.7, 2.0, 2.5),   # Case 4: mixed charge transfer and Rydberg\n    ]\n\n    results = []\n\n    def gaussian_density(x, mu, sigma):\n        \"\"\"\n        Calculates the normalized Gaussian density rho(x; mu, sigma).\n        \"\"\"\n        return (1.0 / (sigma * np.sqrt(2.0 * np.pi))) * \\\n               np.exp(-((x - mu)**2) / (2.0 * sigma**2))\n\n    for case in test_cases:\n        mu_i, sigma_i, mu_a, sigma_a = case\n\n        # 1. Construct densities and difference density\n        rho_i = gaussian_density(x, mu_i, sigma_i)\n        rho_a = gaussian_density(x, mu_a, sigma_a)\n        delta_rho = rho_a - rho_i\n\n        # 2. Calculate the charge-transfer metric f_CT\n        \n        # Positive part of delta_rho for acceptor region gain\n        pos_delta_rho = np.maximum(0, delta_rho)\n        # Positive part of -delta_rho for donor region loss\n        neg_delta_rho = np.maximum(0, -delta_rho)\n\n        # Create masks for donor (x = 0) and acceptor (x > 0) regions\n        donor_mask = x = 0\n        acceptor_mask = x > 0\n\n        # Integrate over the respective regions using Riemann sum\n        Q_A_plus = np.sum(pos_delta_rho[acceptor_mask]) * dx\n        Q_D_minus = np.sum(neg_delta_rho[donor_mask]) * dx\n        \n        f_ct = min(Q_A_plus, Q_D_minus)\n\n        # 3. Calculate the Rydbergness metric f_Ry\n        \n        # Create mask for the asymptotic region R = {x | |x| >= R_c}\n        asymptotic_mask = np.abs(x) >= R_c\n        \n        # Numerator: integral of added density in the asymptotic region\n        numerator = np.sum(pos_delta_rho[asymptotic_mask]) * dx\n        \n        # Denominator: integral of total added density over all space\n        denominator = np.sum(pos_delta_rho) * dx\n        \n        # Calculate f_Ry with the zero-denominator check\n        if denominator  1e-12:\n            f_ry = 0.0\n        else:\n            f_ry = numerator / denominator\n\n        # Append results for the current case, formatting to 6 decimal places\n        results.append(f\"{f_ct:.6f}\")\n        results.append(f\"{f_ry:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2878978"}, {"introduction": "里德堡态因其弥散的电子密度，对常规TD-DFT近似构成了另一大挑战。此问题 [@problem_id:2878981] 提供了一个诊断模型，以定量的方式探究此失效的根源。你将实现一个模型，该模型将TD-DFT的误差与局域/半局域泛函的两个根本缺陷联系起来：对最高占据分子轨道（HOMO）能量的低估，以及交换相关势错误的渐近行为——后者阻碍了正确的里德堡序列的形成。这个练习阐明了为什么这些态如此难以处理，并突出了范围分离泛函等修正方法的物理原理。", "problem": "您的任务是实现一个针对里德堡态激发能的量化诊断程序，该程序需阐明含时密度泛函理论（TD-DFT）在使用局域或半局域近似时众所周知的失效问题。您的程序必须针对几个测试用例，评估一个参考的里德堡-里兹公式与一个最小参数模型之间的差异。该模型体现了两个基本的误差来源：科恩-沈（KS）势的错误渐近衰减行为，以及对最高占据分子轨道（HOMO）能量大小的低估。\n\n基本原理：\n- 在一个电离能为 $I$（单位为电子伏特）的原子里德堡序列中，从基态跃迁到主量子数为 $n$、量子亏损为 $\\mu$ 的里德堡态所需的光子能量由里德堡-里兹表达式给出\n$$\nE_{\\text{true}}(n) \\;=\\; I \\;-\\; \\frac{R_{\\mathrm{H}}}{\\left(n - \\mu\\right)^{2}},\n$$\n其中 $R_{\\mathrm{H}}$ 是以能量单位表示的里德堡常数。请使用 $R_{\\mathrm{H}} = 13.605693 \\text{ eV}$。\n- 在精确的科恩-沈密度泛函理论（KS-DFT）中，HOMO 能量满足 $\\varepsilon_{\\mathrm{HOMO}} = -I$。在诸如局域密度近似（LDA）的局域或半局域近似中，KS 势呈指数衰减而非 $-1/r$ 形式，这导致了无法形成正常的束缚虚轨道里德堡序列，并低估了 $\\varepsilon_{\\mathrm{HOMO}}$ 的大小。对于电荷转移和里德堡跃迁等长程激发，由于密度交叠趋于零，绝热局域核的贡献很弱，因此激发能主要由 KS 能隙决定。\n\n用于诊断 TD-DFT 失效的最小模型：\n- 令 $q \\in [0,1]$ 参数化形成虚轨道能级的有效势的 $-1/r$ 渐近尾部的质量，其中 $q=1$ 代表正确的渐进行为，而 $q=0$ 代表没有里德堡序列的纯局域指数衰减势。\n- 令 $\\beta \\in (0,1]$ 参数化近似 HOMO 能量与精确条件之间的偏差，其中 $\\varepsilon_{\\mathrm{HOMO}}^{\\text{approx}} \\approx -\\beta I$。\n- 模型激发能为\n$$\nE_{\\text{model}}(n) \\;=\\; \\beta I \\;-\\; q\\,\\frac{R_{\\mathrm{H}}}{\\left(n - \\mu\\right)^{2}}.\n$$\n\n任务：\n- 对于每个测试用例，以及对于闭区间 $[n_{\\min}, n_{\\max}]$ 内的每个整数 $n$，计算\n$$\ne(n) \\;=\\; \\left|\\,E_{\\text{true}}(n) - E_{\\text{model}}(n)\\,\\right|.\n$$\n- 计算该范围内的平均绝对误差（MAE）：\n$$\n\\mathrm{MAE} \\;=\\; \\frac{1}{N}\\sum_{n=n_{\\min}}^{n_{\\max}} e(n), \\quad \\text{其中 } N = n_{\\max} - n_{\\min} + 1.\n$$\n- 确定 $[n_{\\min}, n_{\\max}]$ 中满足 $e(n) \\le \\tau$ 的最小 $n$，其中 $\\tau$ 是一个容差。如果不存在这样的 $n$，则返回 $-1$。\n\n物理和数值单位及报告：\n- 所有能量必须以电子伏特（eV）为单位进行计算和报告。\n- 报告的 MAE 需四舍五入到六位小数。\n- 将阈值索引 $n_{\\star}$ 报告为整数，其中 $n_{\\star}$ 是满足 $e(n) \\le \\tau$ 的最小 $n$；若不存在，则为 $-1$。\n\n测试套件：\n对于每个元组 $(I, \\mu, n_{\\min}, n_{\\max}, q, \\beta, \\tau)$，按上述说明计算数对 $[\\mathrm{MAE}, n_{\\star}]$。\n1. $(I, \\mu, n_{\\min}, n_{\\max}, q, \\beta, \\tau) = (\\,13.605693,\\, 0.0,\\, 3,\\, 8,\\, 1.0,\\, 1.0,\\, 0.001\\,)$。\n2. $(I, \\mu, n_{\\min}, n_{\\max}, q, \\beta, \\tau) = (\\,5.1391,\\, 1.35,\\, 5,\\, 12,\\, 0.0,\\, 0.7,\\, 0.05\\,)$。\n3. $(I, \\mu, n_{\\min}, n_{\\max}, q, \\beta, \\tau) = (\\,21.5645,\\, 0.05,\\, 5,\\, 10,\\, 0.5,\\, 0.9,\\, 0.02\\,)$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表。每个结果本身必须是一个双元素列表 $[\\mathrm{MAE}, n_{\\star}]$。例如：\n\"[ [mae1,nstar1],[mae2,nstar2],[mae3,nstar3] ]\"\n- 除此单行外，不要使用任何额外的文本或行。", "solution": "问题陈述已经过分析，并被确定为有效。它在科学上基于量子化学原理，特别是含时密度泛函理论（TD-DFT）。该问题定义明确、客观，并包含推导唯一解所需的所有必要信息。它提出了一个简化但在概念上合理的模型，用于诊断常见 TD-DFT 近似在处理里德堡激发时的两个主要失效之处：交换相关势的不正确渐进行为，以及对最高占据分子轨道（HOMO）能量的低估。\n\n任务是计算激发能的参考里德堡-里兹公式与代表近似 TD-DFT 的参数模型之间的差异。跃迁到主量子数为 $n$ 的里德堡态的参考能量由以下公式给出：\n$$\nE_{\\text{true}}(n) = I - \\frac{R_{\\mathrm{H}}}{\\left(n - \\mu\\right)^{2}}\n$$\n这里，$I$ 是电离能，$\\mu$ 是量子亏损，$R_{\\mathrm{H}} = 13.605693 \\text{ eV}$ 是里德堡常数。\n\n捕获上述 TD-DFT 误差的模型能量定义为：\n$$\nE_{\\text{model}}(n) = \\beta I - q \\frac{R_{\\mathrm{H}}}{\\left(n - \\mu\\right)^{2}}\n$$\n参数 $\\beta \\in (0,1]$ 模拟了对 HOMO 能量的低估，其中精确条件 $\\varepsilon_{\\mathrm{HOMO}} = -I$ 被近似为 $\\varepsilon_{\\mathrm{HOMO}}^{\\text{approx}} \\approx -\\beta I$。参数 $q \\in [0,1]$ 模拟了渐近势的质量，其中 $q=1$ 对应于正确的 $-1/r$ 衰减，而 $q=0$ 对应于不正确的、快速衰减的局域势。\n\n每个态 $n$ 的绝对误差是这两个能量之差的绝对值：\n$$\ne(n) = \\left| E_{\\text{true}}(n) - E_{\\text{model}}(n) \\right|\n$$\n代入 $E_{\\text{true}}(n)$ 和 $E_{\\text{model}}(n)$ 的表达式，可以得到一个更具洞察力的误差形式：\n$$\ne(n) = \\left| \\left(I - \\frac{R_{\\mathrm{H}}}{(n - \\mu)^{2}}\\right) - \\left(\\beta I - q \\frac{R_{\\mathrm{H}}}{(n - \\mu)^{2}}\\right) \\right|\n$$\n$$\ne(n) = \\left| (I - \\beta I) - \\left(\\frac{R_{\\mathrm{H}}}{(n - \\mu)^{2}} - q \\frac{R_{\\mathrm{H}}}{(n - \\mu)^{2}}\\right) \\right|\n$$\n$$\ne(n) = \\left| (1 - \\beta)I - (1 - q)\\frac{R_{\\mathrm{H}}}{(n - \\mu)^{2}} \\right|\n$$\n这个最终表达式清晰地分离了两个误差贡献项：$(1 - \\beta)I$ 来自不正确的 HOMO 能量，而 $(1 - q)\\frac{R_{\\mathrm{H}}}{(n - \\mu)^{2}}$ 来自因错误的势而导致的对里德堡序列的错误描述。\n\n对于每个测试用例，计算过程如下：\n1.  确定主量子数的范围，从 $n=n_{\\min}$ 到 $n=n_{\\max}$。总态数为 $N = n_{\\max} - n_{\\min} + 1$。\n2.  对于此范围内的每个整数 $n$，使用推导出的公式计算误差 $e(n)$。\n3.  通过平均各个误差来计算平均绝对误差（MAE）：$\\mathrm{MAE} = \\frac{1}{N} \\sum_{n=n_{\\min}}^{n_{\\max}} e(n)$。结果四舍五入到六位小数。\n4.  确定在范围 $[n_{\\min}, n_{\\max}]$ 内，误差 $e(n)$ 小于或等于给定容差 $\\tau$ 的最小整数 $n_{\\star}$。如果不存在这样的 $n$，则将 $n_{\\star}$ 赋值为 $-1$。\n\n我们现在将此过程应用于指定的测试用例。\n\n**测试用例 1:** $(I, \\mu, n_{\\min}, n_{\\max}, q, \\beta, \\tau) = (13.605693, 0.0, 3, 8, 1.0, 1.0, 0.001)$\n此情况代表了理想场景。当 $\\beta=1.0$ 且 $q=1.0$ 时，该模型等同于精确理论。\n$e(n) = \\left| (1 - 1.0)I - (1 - 1.0)\\frac{R_{\\mathrm{H}}}{(n - 0.0)^{2}} \\right| = |0 - 0| = 0$。\n对于所有 $n$，误差 $e(n)$ 均为 $0$。因此，MAE 为 $0.0$。对于范围 $[3, 8]$ 内的所有 $n$，条件 $e(n) \\le 0.001$ 均成立。满足条件的最小 $n$ 是 $n_{\\min}$。\n结果：$\\mathrm{MAE} = 0.000000$, $n_{\\star} = 3$。\n\n**测试用例 2:** $(I, \\mu, n_{\\min}, n_{\\max}, q, \\beta, \\tau) = (5.1391, 1.35, 5, 12, 0.0, 0.7, 0.05)$\n此情况模拟了一个具有严重缺陷的典型局域或半局域泛函：$q=0$ 表示势中没有里德堡序列，而 $\\beta=0.7$ 表示对电离能大小存在高达 $30\\%$ 的显著低估。\n$e(n) = \\left| (1 - 0.7) \\times 5.1391 - (1 - 0.0)\\frac{13.605693}{(n - 1.35)^{2}} \\right| = \\left| 1.54173 - \\frac{13.605693}{(n - 1.35)^{2}} \\right|$。\n计算 $n \\in [5, 12]$ 的误差 $e(n)$。在此范围内，最小误差出现在 $n=5$ 处，为 $e(5) \\approx 0.520665$。由于 $0.520665 > 0.05$，该范围内没有 $n$ 满足容差条件。所有 $e(n)$ 值的平均值即为 MAE。\n结果：$\\mathrm{MAE} \\approx 1.158602$, $n_{\\star} = -1$。\n\n**测试用例 3:** $(I, \\mu, n_{\\min}, n_{\\max}, q, \\beta, \\tau) = (21.5645, 0.05, 5, 10, 0.5, 0.9, 0.02)$\n此情况模拟了一个更复杂的泛函（可能是一个杂化泛函），它提供了部分校正。$q=0.5$ 表明势的尾部得到了部分校正，而 $\\beta=0.9$ 表明电离能的误差较小，为 $10\\%$。\n$e(n) = \\left| (1 - 0.9) \\times 21.5645 - (1 - 0.5)\\frac{13.605693}{(n - 0.05)^{2}} \\right| = \\left| 2.15645 - \\frac{6.8028465}{(n - 0.05)^{2}} \\right|$。\n计算 $n \\in [5, 10]$ 的误差 $e(n)$。最小误差出现在 $n=5$ 处，为 $e(5) \\approx 1.878824$。这远大于容差 $\\tau=0.02$，因此该范围内没有 $n$ 满足条件。通过平均这些误差来计算 MAE。\n结果：$\\mathrm{MAE} \\approx 2.011144$, $n_{\\star} = -1$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes a diagnostic for TD-DFT failures for Rydberg excitations\n    based on a minimal parametric model.\n    \"\"\"\n    # Define the Rydberg constant in eV.\n    R_H = 13.605693\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (I, mu, n_min, n_max, q, beta, tau)\n        (13.605693, 0.0, 3, 8, 1.0, 1.0, 0.001),\n        (5.1391, 1.35, 5, 12, 0.0, 0.7, 0.05),\n        (21.5645, 0.05, 5, 10, 0.5, 0.9, 0.02),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        I, mu, n_min, n_max, q, beta, tau = case\n\n        # Create an array of principal quantum numbers for the series.\n        n_values = np.arange(n_min, n_max + 1)\n\n        # Calculate the error e(n) for each n in the range.\n        # e(n) = |(1-beta)*I - (1-q) * R_H / (n-mu)^2|\n        term1 = (1 - beta) * I\n        term2 = (1 - q) * R_H / ((n_values - mu)**2)\n        errors = np.abs(term1 - term2)\n\n        # Compute the Mean Absolute Error (MAE).\n        mae = np.mean(errors)\n\n        # Find the smallest n for which e(n) = tau.\n        # np.where returns indices where the condition is true.\n        indices_below_tolerance = np.where(errors = tau)[0]\n        \n        n_star = -1\n        if len(indices_below_tolerance) > 0:\n            # The first index corresponds to the smallest n.\n            first_valid_index = indices_below_tolerance[0]\n            n_star = n_values[first_valid_index]\n\n        # Format the result pair [MAE, n_star]\n        # MAE is rounded to six decimal places.\n        # This formatting approach ensures the output string is exactly\n        # as required, without extra spaces from standard list-to-string conversion.\n        result_str = f\"[{mae:.6f},{n_star}]\"\n        results.append(result_str)\n\n    # Final print statement in the exact required format.\n    # The example [ [m,n],[m,n] ] is ambiguous about spacing.\n    # The format produced here, e.g., [[0.000000,3],[1.158602,-1]],\n    # is a standard, clean representation.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2878981"}]}