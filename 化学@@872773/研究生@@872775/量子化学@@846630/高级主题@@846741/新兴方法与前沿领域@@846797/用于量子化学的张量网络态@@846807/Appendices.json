{"hands_on_practices": [{"introduction": "在将张量网络方法应用于量子化学问题时，首要任务是将系统的哈密顿量高效地表示为矩阵乘积算符（MPO）。一个天真的构建方法可能导致MPO的键维数过大，从而使计算成本过高。本练习将探讨如何利用积分分解技术（如密度拟合或Cholesky分解）来显著压缩MPO，通过分析算符的施密特分解，推导在这种优化下可实现的最小理论键维数。[@problem_id:2929033]", "problem": "考虑一个由 $N$ 个自旋轨道组成的链，其费米子产生和湮灭算符为 $\\{\\hat{a}_{p}^{\\dagger},\\hat{a}_{p}\\}_{p=1}^{N}$，满足正则反对易关系，粒子数算符为 $\\hat{n}_{p}=\\hat{a}_{p}^{\\dagger}\\hat{a}_{p}$。二次量子化的电子哈密顿量被限制为单体项和密度-密度两体项，\n$$\n\\hat{H}=\\sum_{p=1}^{N}\\epsilon_{p}\\,\\hat{n}_{p}+\\frac{1}{2}\\sum_{\\substack{p,q=1\\\\p\\neq q}}^{N}V_{pq}\\,\\hat{n}_{p}\\hat{n}_{q},\n$$\n其中 $V_{pq}=V_{qp}$ 是实数。假设 $V_{pq}$ 是通过一个秩为 $R$ 的精确积分因子分解（例如，密度拟合或 Cholesky 分解）给出的，这意味着存在实向量 $\\{\\boldsymbol{x}^{(L)}\\}_{L=1}^{R}$，其分量为 $x_{p}^{(L)}$，使得\n$$\nV_{pq}=\\sum_{L=1}^{R}x_{p}^{(L)}x_{q}^{(L)}\\quad\\text{对所有 }p\\neq q.\n$$\n你将沿着轨道序号 $1,2,\\dots,N$ 把 $\\hat{H}$ 表示为矩阵乘积算符（MPO）。考虑对于某个满足 $1\\leq k\\leq N-1$ 的 $k$，位点 $k$ 和 $k+1$ 之间的二分划分（键）。假设 $R\\leq \\min\\{k,N-k\\}$ 并且受限族 $\\{(x_{p}^{(L)})_{p=1}^{k}\\}_{L=1}^{R}$ 和 $\\{(x_{q}^{(L)})_{q=k+1}^{N}\\}_{L=1}^{R}$ 分别在 $\\mathbb{R}^{k}$ 和 $\\mathbb{R}^{N-k}$ 中是线性无关的。在费米子数守恒的扇区内进行计算，并注意粒子数算符是互相对易的，因此密度项不需要宇称串。\n\n仅从哈密顿量、因子分解、二分划分的定义出发，并利用“MPO 在一个切割上的最小内部键维数等于该算符在该切割上的算符施密特秩”这一概念，推导当因子分解被最优利用时，跨越位点 $k$ 和 $k+1$ 之间键的最小可实现 MPO 键维数 $D_{\\min}(k)$。然后，对于中心切割，$N=20$，$k=10$ 和 $R=7$ 的情况，计算你的表达式的值。你的最终答案必须是一个实数。不要四舍五入。", "solution": "问题陈述定义良好且科学上合理，可以进行严格的推导。目标是确定给定哈密顿量 $\\hat{H}$ 在特定二分划分下的矩阵乘积算符（MPO）表示的最小键维数。这个最小键维数 $D_{\\min}(k)$ 等于 $\\hat{H}$ 在位点 $k$ 和 $k+1$ 之间切割上的算符施密特秩。\n\n哈密顿量由下式给出\n$$ \\hat{H}=\\sum_{p=1}^{N}\\epsilon_{p}\\,\\hat{n}_{p}+\\frac{1}{2}\\sum_{\\substack{p,q=1\\\\p\\neq q}}^{N}V_{pq}\\,\\hat{n}_{p}\\hat{n}_{q} $$\n我们将系统划分为两个子系统：$A = \\{1, 2, \\dots, k\\}$ 和 $B = \\{k+1, \\dots, N\\}$。哈密顿量可以分解为纯粹作用在 $A$ 内部的项、纯粹作用在 $B$ 内部的项，以及耦合 $A$ 和 $B$ 的项：\n$$ \\hat{H} = \\hat{H}_A + \\hat{H}_B + \\hat{H}_{AB} $$\n这里，$\\hat{H}_A$ 和 $\\hat{H}_B$ 分别是 $\\hat{H}$ 在子系统 $A$ 和 $B$ 内的位点上的限制。耦合项 $\\hat{H}_{AB}$ 由下式给出\n$$ \\hat{H}_{AB} = \\sum_{p=1}^{k} \\sum_{q=k+1}^{N} V_{pq} \\hat{n}_p \\hat{n}_q $$\n我们已知相互作用张量 $V_{pq} = \\sum_{L=1}^{R}x_{p}^{(L)}x_{q}^{(L)}$ 对于 $p \\neq q$ 的秩为 $R$ 的因子分解。将此代入耦合项得到：\n$$ \\hat{H}_{AB} = \\sum_{p=1}^{k} \\sum_{q=k+1}^{N} \\left(\\sum_{L=1}^{R}x_{p}^{(L)}x_{q}^{(L)}\\right) \\hat{n}_p \\hat{n}_q = \\sum_{L=1}^{R} \\left(\\sum_{p=1}^{k} x_p^{(L)} \\hat{n}_p\\right) \\left(\\sum_{q=k+1}^{N} x_q^{(L)} \\hat{n}_q\\right) $$\n我们定义作用在子系统 $A$ 和 $B$ 上的算符：\n$$ \\hat{O}_A^{(L)} = \\sum_{p=1}^{k} x_p^{(L)} \\hat{n}_p \\quad \\text{对于 } L=1, \\dots, R $$\n$$ \\hat{O}_B^{(L)} = \\sum_{q=k+1}^{N} x_q^{(L)} \\hat{n}_q \\quad \\text{对于 } L=1, \\dots, R $$\n总哈密顿量可以写成跨越二分划分 $(A,B)$ 的算符施密特分解形式：\n$$ \\hat{H} = \\hat{H}_A \\otimes \\hat{I}_B + \\hat{I}_A \\otimes \\hat{H}_B + \\sum_{L=1}^{R} \\hat{O}_A^{(L)} \\otimes \\hat{O}_B^{(L)} $$\n其中 $\\hat{I}_A$ 和 $\\hat{I}_B$ 分别是相应子系统上的单位算符。\n最小 MPO 键维数 $D_{\\min}(k)$ 是切割一侧（例如，左侧）的线性无关算符的数量。左算符集合是 $\\mathcal{S}_A = \\{\\hat{H}_A, \\hat{I}_A, \\hat{O}_A^{(1)}, \\dots, \\hat{O}_A^{(R)}\\}$。$D_{\\min}(k)$ 是由 $\\mathcal{S}_A$ 张成的向量空间的维数。\n\n为了找到这个维数，我们通过将一个任意线性组合设为零算符来检验线性无关性：\n$$ c_H \\hat{H}_A + c_I \\hat{I}_A + \\sum_{L=1}^{R} c_L \\hat{O}_A^{(L)} = \\hat{0} $$\n$\\mathcal{S}_A$ 中的所有算符在占据数基 $|s_1, \\dots, s_k\\rangle$（其中 $s_p \\in \\{0,1\\}$）下都是对角的。它们是关于粒子数算符 $\\{\\hat{n}_p\\}_{p=1}^k$ 的多项式。我们可以通过考虑它们在这些算符中的多项式次数来分析其线性无关性。\n- $\\hat{I}_A$ 是 0 次的。\n- $\\hat{O}_A^{(L)}$ 是 1 次的。\n- $\\hat{H}_A = \\sum_{p=1}^{k}\\epsilon_{p}\\,\\hat{n}_{p}+\\frac{1}{2}\\sum_{\\substack{p,q=1\\\\p\\neq q}}^{k}V_{pq}\\,\\hat{n}_{p}\\hat{n}_{q}$ 包含 1 次项和 2 次项。2 次部分是 $\\hat{H}_{A,2} = \\frac{1}{2}\\sum_{p \\neq q \\in A} V_{pq} \\hat{n}_p \\hat{n}_q$。\n\n具有不同多项式次数的算符空间是线性无关的。线性组合必须逐次消失。唯一的 2 次贡献是 $c_H \\hat{H}_{A,2}$。为了使组合为零，我们必须有 $c_H \\hat{H}_{A,2} = \\hat{0}$。这意味着要么 $c_H=0$ 要么 $\\hat{H}_{A,2}=\\hat{0}$。\n\n我们来判断 $\\hat{H}_{A,2}$ 是否可能为零算符。$\\hat{H}_{A,2} = \\hat{0}$ 当且仅当对于所有 $p,q \\in \\{1,\\dots,k\\}$ 且 $p \\neq q$ 都有 $V_{pq} = 0$。使用因子分解，这意味着 $\\sum_{L=1}^R x_p^{(L)} x_q^{(L)} = 0$。令 $\\boldsymbol{u}_p = (x_p^{(1)}, \\dots, x_p^{(R)}) \\in \\mathbb{R}^R$。条件是对于 $\\{1, \\dots, k\\}$ 中所有 $p \\neq q$ 都有 $\\boldsymbol{u}_p \\cdot \\boldsymbol{u}_q = 0$。这意味着 $k$ 个向量的集合 $\\{\\boldsymbol{u}_p\\}_{p=1}^k$ 在 $\\mathbb{R}^R$ 中是一个正交集。要使 $k$ 个非零向量在一个 $R$ 维空间中正交，必须满足 $k \\le R$。问题指定的参数为 $N=20$，$k=10$ 和 $R=7$。由于 $k > R$，因此 $\\mathbb{R}^7$ 中的 10 个向量 $\\{\\boldsymbol{u}_p\\}_{p=1}^{10}$ 不可能相互正交（假设它们非零，这对于相互作用的系统是一个物理上合理的假设）。因此，对于 $p,q \\in A$，至少有一个 $V_{pq} \\neq 0$，从而 $\\hat{H}_{A,2} \\neq \\hat{0}$。\n\n由于 $\\hat{H}_{A,2} \\neq \\hat{0}$，我们必须有 $c_H=0$。线性无关条件简化为：\n$$ c_I \\hat{I}_A + \\sum_{L=1}^{R} c_L \\hat{O}_A^{(L)} = \\hat{0} $$\n算符 $\\hat{I}_A$ 是 0 次的，而求和项是 1 次的。因此，它们是线性无关的，这迫使 $c_I=0$ 并且 $\\sum_{L=1}^{R} c_L \\hat{O}_A^{(L)} = \\hat{0}$。\n最终的条件是 $\\sum_{L=1}^{R} c_L \\left(\\sum_{p=1}^k x_p^{(L)} \\hat{n}_p\\right) = \\sum_{p=1}^k \\left(\\sum_{L=1}^R c_L x_p^{(L)}\\right) \\hat{n}_p = \\hat{0}$。粒子数算符 $\\{\\hat{n}_p\\}_{p=1}^k$ 是线性无关的。这要求它们的系数为零：\n$$ \\sum_{L=1}^{R} c_L x_p^{(L)} = 0 \\quad \\text{对所有 } p=1, \\dots, k. $$\n这是一个关于 $R$ 个未知数 $\\{c_L\\}$ 的 $k$ 个线性方程组。令 $\\mathbb{R}^k$ 中的向量为 $\\boldsymbol{y}^{(L)} = (x_1^{(L)}, \\dots, x_k^{(L)})$。该方程组为 $\\sum_{L=1}^R c_L \\boldsymbol{y}^{(L)} = \\boldsymbol{0}$。问题陈述中提到 $\\{(x_p^{(L)})_{p=1}^k\\}_{L=1}^R$ 族在 $\\mathbb{R}^k$ 中是线性无关的，这意味着向量 $\\{\\boldsymbol{y}^{(L)}\\}_{L=1}^R$ 是线性无关的。这意味着唯一的解是对于所有的 $L=1,\\dots,R$ 都有 $c_L=0$。\n\n由于所有系数 $c_H, c_I, c_L$ 都必须为零，所以这 $R+2$ 个算符的集合 $\\mathcal{S}_A = \\{\\hat{H}_A, \\hat{I}_A, \\hat{O}_A^{(1)}, \\dots, \\hat{O}_A^{(R)}\\}$ 是线性无关的。因此，由这些算符张成的空间的维数是 $R+2$。\n因此，最小 MPO 键维数是 $D_{\\min}(k) = R+2$。\n\n问题要求我们计算当 $N=20$，$k=10$ 和 $R=7$ 时此表达式的值。条件 $k > R$ ($10 > 7$) 得到满足，验证了我们的推导路径。\n$$ D_{\\min}(10) = R+2 = 7+2 = 9 $$\n此结果在问题指定的条件下成立，代表了通过最优地利用给定的两体相互作用张量的秩-R 因子分解可实现的最小键维数。", "answer": "$$\\boxed{9}$$", "id": "2929033"}, {"introduction": "构建了哈密顿量的MPO表示后，密度矩阵重整化群（DMRG）算法的核心在于对矩阵乘积态（MPS）波函数的变分优化。这个优化过程通过一系列的“扫掠”来迭代更新局域张量。本练习将引导你深入分析DMRG算法中关键步骤——双点更新——的计算复杂度，通过仔细追踪张量缩并的顺序，你可以精确推导出算法的标度行为，这对于预估计算资源和理解性能瓶颈至关重要。[@problem_id:2929047]", "problem": "在量子化学中，密度矩阵重整化群 (DMRG) 算法将费米子波函数表示为矩阵乘积态 (MPS) 形式，并将电子哈密顿量表示为矩阵乘积算符 (MPO) 形式。考虑一个在由 $L$ 个空间轨道组成的链上的二次量子化形式的量子化学哈密顿量，它被映射到一个具有均匀键维 $M$ 和局域物理维度 $d=4$（分别对应空轨道、自旋向上、自旋向下、双占据）的 MPS。假设一个双位点 DMRG 更新，其中双位点波函数张量为 $A_{l s_1 s_2 r}$，其中 $l,r \\in \\{1,\\dots,M\\}$ 且 $s_1,s_2 \\in \\{1,\\dots,d\\}$。该哈密顿量 MPO 具有均匀的键维 $w$，以及用于这两个位点的位点张量 $W^{(1)}_{a a_1 s_1' s_1}$ 和 $W^{(2)}_{a_1 b s_2' s_2}$，其中 $a,a_1,b \\in \\{1,\\dots,w\\}$，物理指标 $s_i,s_i' \\in \\{1,\\dots,d\\}$。设左、右环境张量分别为 $L_{l l' a}$ 和 $R_{b r r'}$。\n\n通过将 $L$、$W^{(1)}$、$W^{(2)}$ 和 $R$ 与 $A$ 进行张量缩并来定义有效哈密顿量在双位点张量上的作用，从而得到 $(H \\cdot A)_{l' s_1' s_2' r'}$。采用以下缩并顺序来以标量乘法次数为单位估算其算术成本：\n- 首先将 $A_{l s_1 s_2 r}$ 与 $R_{b r r'}$ 对指标 $r$ 进行缩并，形成一个具有指标 $(l,s_1,s_2,b,r')$ 的中间张量。\n- 接着将该中间张量与 $W^{(2)}_{a_1 b s_2' s_2}$ 对指标 $s_2$ 和 $b$ 进行缩并，形成 $(l,s_1,a_1,s_2',r')$。\n- 然后与 $W^{(1)}_{a a_1 s_1' s_1}$ 对指标 $s_1$ 和 $a_1$ 进行缩并，形成 $(l,a,s_1',s_2',r')$。\n- 最后与 $L_{l l' a}$ 对指标 $l$ 和 $a$ 进行缩并，得到 $(l',s_1',s_2',r')$。\n\n假设在每个双位点位置，通过使用 Krylov 方法应用 $n_{\\mathrm{K}}$ 次有效哈密顿量来求解局域线性问题，并且一次完整的双位点扫描会从左到右访问所有相邻位点对一次，因此每次扫描有 $L-1$ 个双位点位置。在计算成本时，仅计算标量乘法次数。忽略在主导阶上不与 $M$、$w$、$d$ 或 $L$ 成正比的成本，但保留上述缩并顺序所隐含的精确系数。\n\n任务：\n- 从 MPS、MPO 和张量缩并维度的定义出发，根据指定的缩并顺序，推导在固定位置将有效哈密顿量单次应用于双位点张量所需的标量乘法次数的主导阶精确表达式，该表达式是关于 $M$、$w$ 和 $d$ 的函数。\n- 利用此结果，推导在每个位置应用 $n_{\\mathrm{K}}$ 次哈密顿量的情况下，完成一次完整的双位点扫描所需的总标量乘法次数的闭式表达式，然后令 $d=4$。\n- 此外，估算同时存储所有位点的 MPS 核心张量、MPO 张量以及左右环境张量集所需的内存（以实数标量个数计算），用 $L$、$M$、$w$ 和 $d$ 表示。将此估算作为推导的一部分，但不要包含在最终答案中。\n\n请提供一个单一的闭式解析表达式作为最终答案，该表达式表示在 $d=4$ 的情况下，每次完整双位点扫描所需的总标量乘法次数，用 $L$、$M$、$w$ 和 $n_{\\mathrm{K}}$ 表示。", "solution": "所述问题具有科学依据、提法明确且客观。它描述了密度矩阵重整化群 (DMRG) 算法中的一个标准计算过程。所有必要的参数和规范都已提供，从而可以得出一个唯一的、可验证的解。因此，我们将着手进行推导。\n\n问题的核心是计算将有效哈密顿量应用于双位点波函数张量所需的算术成本，具体来说是标量乘法的次数。这一计算是 DMRG 扫描中的关键步骤，因为在基于 Krylov 子空间的本征求解器中，此操作会执行多次。我们将严格遵循指定的缩并顺序。各指标的维度给定为 $|l|=|r|=|l'|=|r'|=M$，$|s_1|=|s_2|=|s_1'|=|s_2'|=d$，以及 $|a|=|a_1|=|b|=w$。\n\n整个计算分解为四个张量缩并阶段。我们将分析每个阶段的成本。\n\n阶段1：双位点波函数张量与右环境张量的缩并。\n该操作是形成一个中间张量 $I^{(1)}$：\n$$I^{(1)}_{l s_1 s_2 b r'} = \\sum_{r=1}^{M} A_{l s_1 s_2 r} R_{b r r'}$$\n输入张量 $A$ 的尺寸为 $M \\times d \\times d \\times M$，$R$ 的尺寸为 $w \\times M \\times M$。得到的张量 $I^{(1)}$ 具有指标 $(l, s_1, s_2, b, r')$，其尺寸为 $M \\times d \\times d \\times w \\times M$。为计算 $I^{(1)}$ 的每个元素，需要对指标 $r$ 进行求和，这涉及到 $M$ 次乘法。$I^{(1)}$ 中的元素总数为 $M \\cdot d \\cdot d \\cdot w \\cdot M = M^2 d^2 w$。\n因此，该阶段的标量乘法次数为：\n$$C_1 = (M^2 d^2 w) \\times M = M^3 d^2 w$$\n\n阶段2：第一个中间张量与第二个 MPO 张量的缩并。\n下一个中间张量 $I^{(2)}$ 是通过将 $I^{(1)}$ 与 MPO 张量 $W^{(2)}$ 缩并形成的：\n$$I^{(2)}_{l s_1 a_1 s_2' r'} = \\sum_{s_2=1}^{d} \\sum_{b=1}^{w} I^{(1)}_{l s_1 s_2 b r'} W^{(2)}_{a_1 b s_2' s_2}$$\n输入张量 $I^{(1)}$ 的尺寸为 $M \\times d \\times d \\times w \\times M$，$W^{(2)}$ 的尺寸为 $w \\times w \\times d \\times d$。缩并的指标是 $s_2$（维度 $d$）和 $b$（维度 $w$）。得到的张量 $I^{(2)}$ 具有指标 $(l, s_1, a_1, s_2', r')$，其尺寸为 $M \\times d \\times w \\times d \\times M$。$I^{(2)}$ 中的元素数量为 $M \\cdot d \\cdot w \\cdot d \\cdot M = M^2 d^2 w$。对于每个这样的元素，我们执行一个对 $d \\times w$ 个乘积的求和。\n此阶段的成本是：\n$$C_2 = (M^2 d^2 w) \\times (d \\cdot w) = M^2 d^3 w^2$$\n\n阶段3：与第一个 MPO 张量的缩并。\n第三个中间张量 $I^{(3)}$ 是通过将 $I^{(2)}$ 与 MPO 张量 $W^{(1)}$ 缩并形成的：\n$$I^{(3)}_{l a s_1' s_2' r'} = \\sum_{s_1=1}^{d} \\sum_{a_1=1}^{w} I^{(2)}_{l s_1 a_1 s_2' r'} W^{(1)}_{a a_1 s_1' s_1}$$\n输入张量 $I^{(2)}$ 的尺寸为 $M \\times d \\times w \\times d \\times M$，$W^{(1)}$ 的尺寸为 $w \\times w \\times d \\times d$。缩并的指标是 $s_1$（维度 $d$）和 $a_1$（维度 $w$）。结果 $I^{(3)}$ 具有指标 $(l, a, s_1', s_2', r')$，其尺寸为 $M \\times w \\times d \\times d \\times M$。元素数量为 $M \\cdot w \\cdot d \\cdot d \\cdot M = M^2 d^2 w$。对于每个元素，会计算一个对 $d \\times w$ 个乘积的求和。\n此阶段的成本在形式上与前一阶段相同：\n$$C_3 = (M^2 d^2 w) \\times (d \\cdot w) = M^2 d^3 w^2$$\n\n阶段4：与左环境张量的最终缩并。\n最终结果，即双位点张量 $(H \\cdot A)$，是通过将 $I^{(3)}$ 与左环境张量 $L$ 缩并得到的：\n$$(H \\cdot A)_{l' s_1' s_2' r'} = \\sum_{l=1}^{M} \\sum_{a=1}^{w} I^{(3)}_{l a s_1' s_2' r'} L_{l l' a}$$\n输入张量 $I^{(3)}$ 的尺寸为 $M \\times w \\times d \\times d \\times M$，$L$ 的尺寸为 $M \\times M \\times w$。缩并的指标是 $l$（维度 $M$）和 $a$（维度 $w$）。得到的张量 $(H \\cdot A)$ 具有指标 $(l', s_1', s_2', r')$，其尺寸为 $M \\times d \\times d \\times M$。元素数量为 $M \\cdot d \\cdot d \\cdot M = M^2 d^2$。对于每个元素，会执行一个对 $M \\times w$ 个乘积的求和。\n这最后一个阶段的成本是：\n$$C_4 = (M^2 d^2) \\times (M \\cdot w) = M^3 d^2 w$$\n\n单次应用有效哈密顿量的总标量乘法次数 $C_{\\text{app}}$ 是这四个阶段成本的总和：\n$$C_{\\text{app}} = C_1 + C_2 + C_3 + C_4 = M^3 d^2 w + M^2 d^3 w^2 + M^2 d^3 w^2 + M^3 d^2 w$$\n$$C_{\\text{app}} = 2 M^3 d^2 w + 2 M^2 d^3 w^2 = 2 M^2 d^2 w (M + dw)$$\n这是单个位置所需的成本。\n\n接下来，我们计算一次完整的双位点扫描的总成本。一次扫描包括 $L-1$ 次双位点更新。在每个位置，有效哈密顿量在 Krylov 求解器中被应用 $n_{\\mathrm{K}}$ 次。\n一次扫描的总成本 $C_{\\text{sweep}}$ 为：\n$$C_{\\text{sweep}} = (L-1) \\times n_{\\mathrm{K}} \\times C_{\\text{app}} = (L-1) n_{\\mathrm{K}} (2 M^3 d^2 w + 2 M^2 d^3 w^2)$$\n问题指定了局域物理维度为 $d=4$，对应于费米子系统中的一个空间轨道。将 $d=4$ 代入表达式中：\n$$C_{\\text{sweep}} = (L-1) n_{\\mathrm{K}} (2 M^3 (4^2) w + 2 M^2 (4^3) w^2)$$\n$$C_{\\text{sweep}} = (L-1) n_{\\mathrm{K}} (2 M^3 (16) w + 2 M^2 (64) w^2)$$\n$$C_{\\text{sweep}} = (L-1) n_{\\mathrm{K}} (32 M^3 w + 128 M^2 w^2)$$\n提取公因式得到最终表达式：\n$$C_{\\text{sweep}} = 32 (L-1) n_{\\mathrm{K}} M^2 w (M + 4w)$$\n\n此外，我们被要求估算存储 MPS、MPO 和环境张量所需的内存。假设键维 $M$ 和 $w$ 是均匀的，并且我们同时存储所有 $L$ 个位点的所有张量以避免在扫描期间重新计算：\n1.  **MPS 张量**：有 $L$ 个单位点张量，每个尺寸为 $M \\times d \\times M$。MPS 的总内存为：$S_{\\text{MPS}} = L d M^2$。\n2.  **MPO 张量**：有 $L$ 个 MPO 张量，每个尺寸为 $w \\times d \\times d \\times w$。MPO 的总内存为：$S_{\\text{MPO}} = L d^2 w^2$。\n3.  **环境张量**：有 $L-1$ 个非平凡的左环境和 $L-1$ 个非平凡的右环境。每个左环境张量 $L_i$ 的尺寸为 $M \\times M \\times w$，每个右环境张量 $R_i$ 的尺寸为 $w \\times M \\times M$。存储所有这些张量的总内存约为 $S_{\\text{Env}} \\approx 2 L w M^2$。\n总内存需求 $S_{\\text{total}}$ 是这些贡献的总和：\n$$S_{\\text{total}} = S_{\\text{MPS}} + S_{\\text{MPO}} + S_{\\text{Env}} = L d M^2 + L d^2 w^2 + 2 L w M^2$$\n$$S_{\\text{total}} = L \\left( (d+2w)M^2 + d^2w^2 \\right)$$\n令 $d=4$：\n$$S_{\\text{total}} = L \\left( (4+2w)M^2 + 16w^2 \\right)$$\n该估算为算法的资源需求提供了背景信息，但不是最终答案的一部分。最终答案仅为每次扫描的计算成本。", "answer": "$$\n\\boxed{32(L-1)n_{\\mathrm{K}}M^2w(M+4w)}\n$$", "id": "2929047"}, {"introduction": "成功的DMRG计算不仅依赖于高效的算法实现，还取决于对计算结果的严谨分析。计算完成后，我们需要根据输出数据判断计算是否收敛，并估计相对于有限键维数的截断误差，从而外推出精确的基态能量。本练习模拟了这一典型的数据分析工作流程，通过处理一组假设的DMRG计算数据，你将亲手实践能量外推、收敛性判断以及从纠缠谱中提取关键信息等核心技能。[@problem_id:2929049]", "problem": "考虑在密度矩阵重整化群 (DMRG) 中使用矩阵乘积态 (MPS) 拟设进行电子结构的变分计算。在一个二分系统上，其状态可以进行 Schmidt 分解，得到奇异值 $\\{ s_i \\}_{i=1}^{\\chi_{\\max}}$，其中相应的概率为 $p_i = s_i^2$ 且满足 $\\sum_i p_i = 1$。截断至键维数 $\\chi$ 会保留 $\\chi$ 个最大的奇异值并舍弃其余部分，从而产生舍弃权重 $\\epsilon_\\chi = \\sum_{i > \\chi} p_i$。对于哈密顿量 $H$ 的一个近似本征态 $\\lvert \\psi \\rangle$，其能量方差为 $v = \\langle \\psi \\lvert H^2 \\rvert \\psi \\rangle - \\langle \\psi \\lvert H \\rvert \\psi \\rangle^2$，而对于精确本征态，$v = 0$。在接近收敛时，变分能通常与舍弃权重或方差近似线性相关。您的任务是仅使用上述基本定义以及通过最小化残差平方和推导出的最小二乘拟合，从第一性原理出发，实现有原则的收敛控制和误差估计。\n\n您必须编写一个程序来完成以下任务，并使用下面给出的确切数据。所有能量单位均为 Hartree，且必须以 Hartree 报告。所有对数均为自然对数。\n\n任务 A（能量对舍弃权重的外推）：给定在小 $\\epsilon$ 区域内近似线性的能量 $E$ 对舍弃权重 $\\epsilon$ 的样本，通过普通最小二乘法拟合一条直线 $E(\\epsilon)$，并计算其在 $\\epsilon = 0$ 处的值，从而得到舍弃权重为零时外推的基态能 $E_0$。使用以下数据：\n- 能量 (Hartree): $\\mathbf{E}^{(A)} = (-75.64301, -75.64309, -75.64315, -75.64318)$\n- 舍弃权重: $\\boldsymbol{\\epsilon}^{(A)} = (1.0 \\times 10^{-4}, 6.0 \\times 10^{-5}, 3.0 \\times 10^{-5}, 1.5 \\times 10^{-5})$\n报告以 Hartree 为单位的估算值 $E_0$，四舍五入到 8 位小数。\n\n任务 B（能量对能量方差的外推）：给定能量 $E$ 对能量方差 $v$ 的样本，通过普通最小二乘法拟合一条直线 $E(v)$，并计算其在 $v = 0$ 处的值，从而得到零方差外推能量 $E_0$。使用以下数据：\n- 能量 (Hartree): $\\mathbf{E}^{(B)} = (-1.13677, -1.13707, -1.13722, -1.137245)$\n- 方差: $\\mathbf{v}^{(B)} = (1.0 \\times 10^{-3}, 4.0 \\times 10^{-4}, 1.0 \\times 10^{-4}, 5.0 \\times 10^{-5})$\n报告以 Hartree 为单位的估算值 $E_0$，四舍五入到 8 位小数。\n\n任务 C（收敛判定准则）：实现一个基于以下两条标准的收敛判定准则，这两条标准必须同时满足：\n- 最后两次扫描中，每一次的最大舍弃权重均小于或等于目标阈值 $\\tau$。\n- 最后两次扫描之间的能量绝对变化量小于或等于阈值 $\\delta E$。\n使用以下数据：\n- 扫描能量 (Hartree): $\\mathbf{E}^{(\\mathrm{sweeps})} = (-40.12340000, -40.12348000, -40.12350000, -40.12350005)$\n- 扫描舍弃权重: $\\boldsymbol{\\epsilon}^{(\\mathrm{sweeps})} = (2.0 \\times 10^{-6}, 9.0 \\times 10^{-7}, 7.0 \\times 10^{-7}, 5.0 \\times 10^{-7})$\n- 阈值: $\\tau = 1.0 \\times 10^{-6}$ 和 $\\delta E = 1.0 \\times 10^{-7}$ Hartree\n根据此准则，报告一个布尔值，指示是否达到收敛。\n\n任务 D（满足目标舍弃权重的最小键维数）：给定一个二分系统的单键奇异值谱（已按非增序排列），计算使舍弃权重 $\\epsilon_\\chi$ 小于或等于目标容差 $\\tau$ 的最小键维数 $\\chi$。使用以下奇异值：\n- $\\mathbf{s} = \\big(\\sqrt{0.6}, \\sqrt{0.2}, \\sqrt{0.1}, \\sqrt{0.05}, \\sqrt{0.03}, \\sqrt{0.01}, \\sqrt{0.005}, \\sqrt{0.003}, \\sqrt{0.001}, \\sqrt{0.001}\\big)$\n和容差 $\\tau = 5.0 \\times 10^{-3}$。\n报告满足 $\\epsilon_\\chi \\le \\tau$ 的最小整数 $\\chi$。\n\n任务 E（纠缠熵）：对于与任务 D 中相同的谱，计算 von Neumann 纠缠熵 $S = - \\sum_i p_i \\ln p_i$，其中 $p_i = s_i^2$。报告 $S$ 的值，四舍五入到 6 位小数。\n\n任务 F（固定键维数下的舍弃权重）：对于与任务 D 中相同的谱，计算当 $\\chi = 7$ 时的舍弃权重 $\\epsilon_\\chi$。报告 $\\epsilon_\\chi$ 的值，四舍五入到 6 位小数。\n\n您可以使用的基本原理：\n- 变分原理意味着近似能量是精确基态能量的上界，且精确本征态的方差 $v = 0$。\n- 通过保留最大的 $\\chi$ 个奇异值得到的截断 MPS，其舍弃权重为 $\\epsilon_\\chi = \\sum_{i>\\chi} s_i^2$。\n- 普通最小二乘法通过最小化残差平方和来拟合一条直线；您可以推导并使用最佳拟合线的闭式解。\n\n您的程序必须根据所提供的数据计算答案，并按以下顺序和格式生成它们：\n- 顺序：$[A, B, C, D, E, F]$，其中 $A$ 和 $B$ 是以 Hartree 为单位、四舍五入到 8 位小数的浮点数，$C$ 是一个布尔值，$D$ 是一个整数，$E$ 和 $F$ 是四舍五入到 6 位小数的浮点数。\n- 最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $[x_1,x_2,x_3,x_4,x_5,x_6]$），不含空格。", "solution": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves a multi-part problem related to DMRG convergence and analysis.\n    \"\"\"\n\n    # --- Task A: Energy vs. Discarded Weight Extrapolation ---\n    def extrapolate_energy_ols(x_vals, e_vals):\n        \"\"\"\n        Performs ordinary least squares linear regression to find the intercept.\n        The model is E = m*x + c, where the intercept c is the extrapolated energy.\n        \"\"\"\n        x = np.array(x_vals)\n        y = np.array(e_vals)\n        \n        # Using numpy's polyfit for a degree 1 polynomial is equivalent to OLS\n        # It returns [slope, intercept]\n        m, c = np.polyfit(x, y, 1)\n        \n        return c\n\n    energies_A = [-75.64301, -75.64309, -75.64315, -75.64318]\n    weights_A = [1.0e-4, 6.0e-5, 3.0e-5, 1.5e-5]\n    result_A = extrapolate_energy_ols(weights_A, energies_A)\n\n    # --- Task B: Energy vs. Variance Extrapolation ---\n    energies_B = [-1.13677, -1.13707, -1.13722, -1.137245]\n    variances_B = [1.0e-3, 4.0e-4, 1.0e-4, 5.0e-5]\n    result_B = extrapolate_energy_ols(variances_B, energies_B)\n\n    # --- Task C: Convergence Decision Rule ---\n    sweep_energies = [-40.12340000, -40.12348000, -40.12350000, -40.12350005]\n    sweep_weights = [2.0e-6, 9.0e-7, 7.0e-7, 5.0e-7]\n    tau_conv = 1.0e-6\n    delta_E_conv = 1.0e-7\n\n    weight_cond = (sweep_weights[-1] = tau_conv) and (sweep_weights[-2] = tau_conv)\n    energy_cond = abs(sweep_energies[-1] - sweep_energies[-2]) = delta_E_conv\n    \n    result_C = weight_cond and energy_cond\n\n    # --- Data for Tasks D, E, F ---\n    s_vals = np.sqrt([0.6, 0.2, 0.1, 0.05, 0.03, 0.01, 0.005, 0.003, 0.001, 0.001])\n    p_vals = s_vals**2\n\n    # --- Task D: Minimal Bond Dimension ---\n    tau_discard = 5.0e-3\n    chi_max = len(p_vals)\n    result_D = -1 # Initialize with an invalid value\n    for chi in range(1, chi_max + 1):\n        # Discarded weight is sum of probabilities of states with index > chi\n        # In 0-based index, this corresponds to sum from index chi onwards\n        if chi == chi_max:\n             discarded_weight = 0.0\n        else:\n             discarded_weight = np.sum(p_vals[chi:])\n        \n        if discarded_weight = tau_discard:\n            result_D = chi\n            break\n\n    # --- Task E: Entanglement Entropy ---\n    # S = - sum(p_i * log(p_i))\n    # All p_i are > 0, so no need to check for log(0)\n    result_E = -np.sum(p_vals * np.log(p_vals))\n\n    # --- Task F: Discarded Weight for a Fixed Bond Dimension ---\n    chi_fixed = 7\n    # Discarded weight is sum of probabilities of states with index > 7.\n    # In 0-based index, sum from index 7 onwards.\n    result_F = np.sum(p_vals[chi_fixed:])\n    \n    # --- Format Results for Final Output ---\n    results_formatted = [\n        f\"{result_A:.8f}\",\n        f\"{result_B:.8f}\",\n        str(result_C),\n        str(result_D),\n        f\"{result_E:.6f}\",\n        f\"{result_F:.6f}\",\n    ]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results_formatted)}]\")\n\nsolve()\n```", "answer": "[-75.64321000,-1.13727000,True,7,1.488661,0.005000]", "id": "2929049"}]}