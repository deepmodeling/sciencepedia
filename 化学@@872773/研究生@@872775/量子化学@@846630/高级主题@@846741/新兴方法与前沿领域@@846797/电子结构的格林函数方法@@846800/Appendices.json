{"hands_on_practices": [{"introduction": "谱表示是连接可观测的谱函数 $A(\\omega)$ 和完整的解析格林函数 $G(z)$ 的基石。本练习将演示如何利用复分析，从实轴上的谱特征出发，重建整个格林函数。这是一项该领域的基础技能，有助于巩固对格林函数解析结构的理解。[@problem_id:2894546]", "problem": "考虑一个通过其谱表示描述的频域中的单粒子费米子格林函数 (GF)。设谱函数为一个归一化的洛伦兹函数，\n$$\nA(\\nu)=\\frac{1}{\\pi}\\,\\frac{\\gamma}{(\\nu-\\omega_{0})^{2}+\\gamma^{2}},\n$$\n其中心 $\\omega_{0}\\in\\mathbb{R}$ 为实数，半高宽 $\\gamma0$ 为正数。对于 $\\operatorname{Im}z\\neq 0$，复频格林函数 $G(z)$ 由谱表示定义\n$$\nG(z)=\\int_{-\\infty}^{+\\infty}\\frac{A(\\nu)}{z-\\nu}\\,d\\nu.\n$$\n仅使用解析函数的基本性质、柯西积分定理以及推迟格林函数作为从上半平面进行解析延拓的定义，执行以下步骤：\n\n- 对于 $\\operatorname{Im}z0$，进行实频积分，以获得 $G(z)$ 的闭合形式解析表达式。\n- 从虚频轴到实轴进行解析延拓，以获得推迟格林函数 $G^{R}(\\omega)=\\lim_{\\eta\\to 0^{+}}G(\\omega+i\\eta)$。\n\n将您的最终答案表示为关于 $\\omega,\\,\\omega_{0},\\,\\gamma$ 的单个闭合形式解析表达式。无需进行数值计算，也无需四舍五入。您的最终答案必须是单个解析表达式（而不是方程或不等式）。", "solution": "所述问题在科学上是合理的、提法恰当、客观，并包含获得唯一解所需的所有信息。这是将复分析应用于格林函数理论的一个标准练习。因此，我将开始解答。\n\n该问题要求解在复频域中的单粒子格林函数 $G(z)$，它由谱表示定义：\n$$\nG(z) = \\int_{-\\infty}^{+\\infty} \\frac{A(\\nu)}{z-\\nu} \\, d\\nu\n$$\n其中谱函数 $A(\\nu)$ 是一个归一化的洛伦兹函数：\n$$\nA(\\nu) = \\frac{1}{\\pi} \\frac{\\gamma}{(\\nu-\\omega_{0})^{2}+\\gamma^{2}}\n$$\n其中 $\\omega_{0} \\in \\mathbb{R}$ 且 $\\gamma  0$。$G(z)$ 的积分需在 $\\operatorname{Im}z  0$ 的条件下计算。\n\n我们将使用复分析中的留数定理来计算这个积分。让我们定义一个与被积函数相对应的复函数 $f(\\zeta)$：\n$$\nf(\\zeta) = \\frac{A(\\zeta)}{z-\\zeta} = \\frac{1}{z-\\zeta} \\cdot \\frac{1}{\\pi} \\frac{\\gamma}{(\\zeta-\\omega_{0})^{2}+\\gamma^{2}}\n$$\n复 $\\zeta$ 平面中 $f(\\zeta)$ 的极点位于 $\\zeta = z$ 以及 $A(\\zeta)$ 分母的根处。后者可由 $(\\zeta-\\omega_{0})^{2}+\\gamma^{2} = 0$ 求得，即 $\\zeta - \\omega_{0} = \\pm i\\gamma$。我们将这两个极点记为 $\\zeta_{1} = \\omega_{0} + i\\gamma$ 和 $\\zeta_{2} = \\omega_{0} - i\\gamma$。\n\n根据题目条件，$\\operatorname{Im}z  0$ 且 $\\gamma  0$。因此，极点 $\\zeta=z$ 和 $\\zeta_{1} = \\omega_{0} + i\\gamma$ 位于上半平面，而极点 $\\zeta_{2} = \\omega_{0} - i\\gamma$ 位于下半平面。\n\n为了计算沿实轴的积分，我们可以用一个位于上半平面或下半平面的大半圆来闭合积分路径。我们选择在下半平面闭合围道，因为这样只包含一个极点，计算上更为直接。我们定义一个围道 $\\mathcal{C}$，它由从 $-R$ 到 $R$ 的实轴和位于下半平面、半径为 $R$ 的半圆 $\\Gamma_{R}$ 组成，方向为顺时针。$f(\\zeta)$ 在这个闭合围道上的积分由留数定理给出。\n\n$$\n\\oint_{\\mathcal{C}} f(\\zeta) \\, d\\zeta = \\int_{-R}^{R} f(\\nu) \\, d\\nu + \\int_{\\Gamma_{R}} f(\\zeta) \\, d\\zeta = -2\\pi i \\sum_{k} \\operatorname{Res}(f, \\zeta_k^{\\text{inside}})\n$$\n负号 $-2\\pi i$ 是由于围道 $\\mathcal{C}$ 的顺时针方向。$\\mathcal{C}$ 内包含的唯一极点是 $\\zeta_{2} = \\omega_{0} - i\\gamma$。\n\n当 $R \\to \\infty$ 时，沿半圆 $\\Gamma_{R}$ 的积分趋于零，因为被积函数 $f(\\zeta)$ 以 $O(|\\zeta|^{-3})$ 的速度衰减，这比 $|\\zeta|^{-1}$ 更快。因此，在 $R\\to\\infty$ 的极限下，我们有：\n$$\nG(z) = \\int_{-\\infty}^{+\\infty} f(\\nu) \\, d\\nu = -2\\pi i \\operatorname{Res}(f, \\zeta_{2})\n$$\n现在我们计算 $f(\\zeta)$ 在单极点 $\\zeta_{2}$ 处的留数：\n$$\n\\operatorname{Res}(f, \\zeta_{2}) = \\lim_{\\zeta \\to \\zeta_{2}} (\\zeta-\\zeta_{2}) f(\\zeta) = \\lim_{\\zeta \\to \\zeta_{2}} (\\zeta - \\zeta_{2}) \\frac{1}{z-\\zeta} \\frac{1}{\\pi} \\frac{\\gamma}{(\\zeta-\\zeta_{1})(\\zeta-\\zeta_{2})}\n$$\n$$\n\\operatorname{Res}(f, \\zeta_{2}) = \\frac{1}{z-\\zeta_{2}} \\frac{1}{\\pi} \\frac{\\gamma}{\\zeta_{2}-\\zeta_{1}}\n$$\n代入 $\\zeta_{1} = \\omega_{0} + i\\gamma$ 和 $\\zeta_{2} = \\omega_{0} - i\\gamma$，我们得到 $\\zeta_{2} - \\zeta_{1} = -2i\\gamma$。因此，留数为：\n$$\n\\operatorname{Res}(f, \\zeta_{2}) = \\frac{1}{z-(\\omega_{0}-i\\gamma)} \\frac{1}{\\pi} \\frac{\\gamma}{-2i\\gamma} = -\\frac{1}{2\\pi i} \\frac{1}{z - \\omega_{0} + i\\gamma}\n$$\n最后，我们将此留数代回到 $G(z)$ 的表达式中：\n$$\nG(z) = -2\\pi i \\left( -\\frac{1}{2\\pi i} \\frac{1}{z - \\omega_{0} + i\\gamma} \\right) = \\frac{1}{z - \\omega_{0} + i\\gamma}\n$$\n这就是对于 $\\operatorname{Im}z  0$ 时 $G(z)$ 的闭合形式解析表达式。\n\n问题的第二部分要求通过从上半平面到实轴的解析延拓来求得推迟格林函数 $G^{R}(\\omega)$。它由以下极限定义：\n$$\nG^{R}(\\omega) = \\lim_{\\eta\\to 0^{+}} G(\\omega+i\\eta)\n$$\n其中 $\\omega \\in \\mathbb{R}$ 并且 $\\eta$ 是一个正无穷小量。我们将 $z = \\omega + i\\eta$ 代入 $G(z)$ 的表达式中：\n$$\nG(\\omega+i\\eta) = \\frac{1}{(\\omega+i\\eta) - \\omega_{0} + i\\gamma} = \\frac{1}{(\\omega - \\omega_{0}) + i(\\eta + \\gamma)}\n$$\n现在，我们取 $\\eta \\to 0^{+}$ 的极限。由于 $\\gamma  0$，分母不会变为奇异，因此可以通过直接代入 $\\eta = 0$ 来计算极限：\n$$\nG^{R}(\\omega) = \\frac{1}{(\\omega - \\omega_{0}) + i\\gamma}\n$$\n这就是实频轴上推迟格林函数的最终表达式。", "answer": "$$\n\\boxed{\\frac{1}{(\\omega - \\omega_{0}) + i\\gamma}}\n$$", "id": "2894546"}, {"introduction": "一旦知道了格林函数，就可以用它来计算各种物理性质。本练习展示了如何通过对谱函数进行积分来计算一个关键的可观测量——电子占据数，而谱函数直接从格林函数的虚部获得。这个练习将抽象的理论形式与具体的物理量联系起来。[@problem_id:2894526]", "problem": "考虑一个能量为 $\\varepsilon_{0} \\in \\mathbb{R}$ 的无自旋电子能级，该能级在宽带极限下与一个无特征的金属环境耦合，其耦合诱导的展宽为一常数 $\\Gamma  0$。推迟格林函数定义为 $G^{R}(\\omega) = \\left[\\omega - \\varepsilon_{0} + i \\Gamma\\right]^{-1}$，它在复数 $\\omega$ 平面的上半平面解析，并在 $\\omega = \\varepsilon_{0} - i \\Gamma$ 处有一个单极点。谱函数定义为 $A(\\omega) = -2\\,\\operatorname{Im} G^{R}(\\omega)$，在化学势为 $\\mu$ 时的零温占据数由以下基本表达式给出\n$$\nn(\\mu) \\;=\\; \\int_{-\\infty}^{\\mu} \\frac{d\\omega}{2\\pi}\\, A(\\omega).\n$$\n仅使用由因果性所蕴含的 $G^{R}(\\omega)$ 的解析性质，并结合标准的复分析与围道变形方法，求出 $n(\\mu)$ 关于 $\\mu$、$\\varepsilon_{0}$ 和 $\\Gamma$ 的精确闭式表达式。将最终答案表示为单个解析表达式。无需单位。请勿对答案进行近似或四舍五入。", "solution": "该问题要求计算耦合到金属环境中的单个电子能级的零温占据数 $n(\\mu)$。该计算必须利用推迟格林函数 $G^{R}(\\omega)$ 的解析性，通过复分析的方法进行。\n\n首先，我们必须验证问题的陈述。\n已知条件如下：\n- 一个能量为 $\\varepsilon_{0} \\in \\mathbb{R}$ 的无自旋电子能级。\n- 一个恒定的耦合诱导展宽 $\\Gamma  0$。\n- 推迟格林函数 $G^{R}(\\omega) = \\left[\\omega - \\varepsilon_{0} + i \\Gamma\\right]^{-1}$。\n- $G^{R}(\\omega)$ 的极点位于 $\\omega = \\varepsilon_{0} - i \\Gamma$，并且 $G^{R}(\\omega)$ 在复数 $\\omega$ 平面的上半平面是解析的。\n- 谱函数为 $A(\\omega) = -2\\,\\operatorname{Im} G^{R}(\\omega)$。\n- 零温占据数为 $n(\\mu) = \\int_{-\\infty}^{\\mu} \\frac{d\\omega}{2\\pi}\\, A(\\omega)$。\n\n该问题在科学上是成立的，描述了宽带极限下的一个标准共振能级模型。所有定义在量子多体物理中都是标准的。问题的设定是自洽、一致且适定的。极点位于下半平面与推迟传播子的因果性是一致的。因此，该问题是有效的，可以推导出解。\n\n占据数 $n(\\mu)$ 由谱函数 $A(\\omega)$ 积分到化学势 $\\mu$ 给出：\n$$\nn(\\mu) \\;=\\; \\int_{-\\infty}^{\\mu} \\frac{d\\omega}{2\\pi}\\, A(\\omega)\n$$\n谱函数 $A(\\omega)$ 是用推迟格林函数 $G^{R}(\\omega)$ 来定义的，其中 $G^{R}(\\omega) = \\left[\\omega - \\varepsilon_{0} + i \\Gamma\\right]^{-1}$。\n对于实数 $\\omega$，超前格林函数 $G^{A}(\\omega)$ 是推迟格林函数 $G^{R}(\\omega)$ 的复共轭：\n$$\nG^{A}(\\omega) = \\left(G^{R}(\\omega)\\right)^{*} = \\left[\\omega - \\varepsilon_{0} - i \\Gamma\\right]^{-1}\n$$\n$G^{R}(\\omega)$ 的虚部可以用 $G^{R}(\\omega)$ 和 $G^{A}(\\omega)$ 来表示：\n$$\n\\operatorname{Im} G^{R}(\\omega) = \\frac{G^{R}(\\omega) - \\left(G^{R}(\\omega)\\right)^{*}}{2i} = \\frac{G^{R}(\\omega) - G^{A}(\\omega)}{2i}\n$$\n将此代入谱函数 $A(\\omega) = -2\\,\\operatorname{Im} G^{R}(\\omega)$ 的定义中：\n$$\nA(\\omega) = -2 \\left( \\frac{G^{R}(\\omega) - G^{A}(\\omega)}{2i} \\right) = i \\left( G^{R}(\\omega) - G^{A}(\\omega) \\right)\n$$\n现在，将此 $A(\\omega)$ 的表达式代入占据数 $n(\\mu)$ 的公式中：\n$$\nn(\\mu) = \\int_{-\\infty}^{\\mu} \\frac{d\\omega}{2\\pi} \\left[ i \\left( G^{R}(\\omega) - G^{A}(\\omega) \\right) \\right] = \\frac{i}{2\\pi} \\int_{-\\infty}^{\\mu} \\left( G^{R}(\\omega) - G^{A}(\\omega) \\right) d\\omega\n$$\n为了避免在处理复对数时可能出现的微妙问题，我们将直接对实值谱函数进行积分。\n$$\nA(\\omega) = -2\\,\\operatorname{Im} G^{R}(\\omega) = -2\\,\\operatorname{Im}\\left(\\frac{1}{\\omega - \\varepsilon_{0} + i \\Gamma}\\right) = -2\\,\\operatorname{Im}\\left(\\frac{\\omega - \\varepsilon_{0} - i \\Gamma}{(\\omega - \\varepsilon_{0})^2 + \\Gamma^2}\\right) = -2\\left(\\frac{-\\Gamma}{(\\omega - \\varepsilon_{0})^2 + \\Gamma^2}\\right) = \\frac{2\\Gamma}{(\\omega - \\varepsilon_{0})^2 + \\Gamma^2}\n$$\n这是一个洛伦兹函数。问题简化为对该函数进行积分。\n$$\nn(\\mu) = \\int_{-\\infty}^{\\mu} \\frac{d\\omega}{2\\pi} \\frac{2\\Gamma}{(\\omega - \\varepsilon_{0})^2 + \\Gamma^2} = \\frac{\\Gamma}{\\pi} \\int_{-\\infty}^{\\mu} \\frac{d\\omega}{(\\omega - \\varepsilon_{0})^2 + \\Gamma^2}\n$$\n进行变量替换。设 $u = \\frac{\\omega - \\varepsilon_{0}}{\\Gamma}$，则 $d\\omega = \\Gamma du$。积分上下限变为 $-\\infty$ 和 $\\frac{\\mu - \\varepsilon_{0}}{\\Gamma}$。\n$$\nn(\\mu) = \\frac{\\Gamma}{\\pi} \\int_{-\\infty}^{(\\mu - \\varepsilon_0)/\\Gamma} \\frac{\\Gamma du}{(\\Gamma u)^2 + \\Gamma^2} = \\frac{\\Gamma^2}{\\pi\\Gamma^2} \\int_{-\\infty}^{(\\mu - \\varepsilon_0)/\\Gamma} \\frac{du}{u^2 + 1}\n$$\n积分现在是标准的：\n$$\nn(\\mu) = \\frac{1}{\\pi} \\left[ \\arctan(u) \\right]_{-\\infty}^{(\\mu - \\varepsilon_0)/\\Gamma}\n$$\n在积分上下限处求值，使用反正切函数的主值，其范围在 $(-\\pi/2, \\pi/2)$ 内：\n$$\nn(\\mu) = \\frac{1}{\\pi} \\left( \\arctan\\left(\\frac{\\mu - \\varepsilon_{0}}{\\Gamma}\\right) - \\lim_{u\\to-\\infty} \\arctan(u) \\right)\n$$\n极限是 $\\lim_{u\\to-\\infty} \\arctan(u) = -\\frac{\\pi}{2}$。\n$$\nn(\\mu) = \\frac{1}{\\pi} \\left( \\arctan\\left(\\frac{\\mu - \\varepsilon_{0}}{\\Gamma}\\right) - \\left(-\\frac{\\pi}{2}\\right) \\right) = \\frac{1}{\\pi} \\arctan\\left(\\frac{\\mu - \\varepsilon_{0}}{\\Gamma}\\right) + \\frac{1}{2}\n$$\n这个结果是连续的，并且具有正确的物理极限：当 $\\mu \\to -\\infty$ 时 $n(\\mu) \\to 0$，当 $\\mu \\to \\infty$ 时 $n(\\mu) \\to 1$，以及 $n(\\varepsilon_{0}) = 1/2$。\n\n占据数的最终表达式为：\n$$\nn(\\mu) = \\frac{1}{2} + \\frac{1}{\\pi} \\arctan\\left(\\frac{\\mu - \\varepsilon_{0}}{\\Gamma}\\right)\n$$", "answer": "$$\n\\boxed{\\frac{1}{2} + \\frac{1}{\\pi} \\arctan\\left(\\frac{\\mu - \\varepsilon_{0}}{\\Gamma}\\right)}\n$$", "id": "2894526"}, {"introduction": "超越简单的单能级模型，本练习旨在解决多体计算中的核心任务：求解戴森方程。通过为具有不同自能近似的多轨道系统寻找准粒子能量，这个具体的计算任务将理论与实际应用联系起来，让您亲手实践如何从理论走向计算。[@problem_id:2894544]", "problem": "要求您实现一个程序，用于求解在有限正交归一轨道基中，由单粒子推迟格林函数的矩阵戴森方程导出的准粒子方程。其基本出发点是推迟格林函数和戴森方程的定义。在交叠矩阵为单位矩阵的正交归一基中，单粒子推迟格林函数定义为\n$$\n\\mathbf{G}(\\omega) \\equiv \\left[ (\\omega + \\mu)\\,\\mathbf{I} - \\mathbf{H}_0 - \\mathbf{\\Sigma}(\\omega) \\right]^{-1},\n$$\n其中 $\\omega$ 是实频率，$\\mu$ 是化学势，$\\mathbf{I}$ 是单位矩阵，$\\mathbf{H}_0$ 是一个实对称的无相互作用哈密顿矩阵，而 $\\mathbf{\\Sigma}(\\omega)$ 是（通常与频率相关的）自能矩阵。准粒子能量是矩阵逆存在极点时的实频率 $\\omega$，等价地，其逆核的行列式为零，\n$$\n\\det\\!\\left[ (\\omega + \\mu)\\,\\mathbf{I} - \\mathbf{H}_0 - \\mathbf{\\Sigma}(\\omega) \\right] = 0.\n$$\n一般而言，这定义了一个关于 $\\omega$ 的非线性本征值问题。在特殊情况下，当 $\\mathbf{\\Sigma}(\\omega)$ 在与 $\\mathbf{H}_0$ 相同的基中是对角的，或者与 $\\mathbf{I}$ 成正比时，该问题会解耦为针对每个轨道的独立标量非线性方程。您的任务是利用这些原理，为几个具体的有限维测试用例计算准粒子能量。\n\n科学和计算要求：\n- 假设使用正交归一基，因此交叠矩阵为 $\\mathbf{I}$。\n- 以上述定义为出发点。准粒子能量是极点条件的实根 $\\omega$。\n- 对于 $\\mathbf{\\Sigma}(\\omega)$ 是标量且与 $\\mathbf{I}$ 成正比的测试用例，$\\mathbf{H}_0$ 的本征矢量不随 $\\omega$ 变化，本征值条件简化为针对 $\\mathbf{H}_0$ 的每个本征值的独立标量方程 $\\omega$。\n- 对于 $\\mathbf{\\Sigma}(\\omega)$ 在轨道基中是对角的且 $\\mathbf{H}_0$ 也是对角的测试用例，每个轨道都解耦成一个关于 $\\omega$ 的标量非线性方程。\n- 化学势 $\\mu = 0$，所有能量单位均为电子伏特。所有最终能量均以 $\\mathrm{eV}$ 表示，并四舍五入到六位小数。\n\n测试套件：\n实现程序以解决以下三个测试用例的准粒子方程。在所有用例中，均使用 $\\mu = 0$ 且能量单位为 $\\mathrm{eV}$。\n\n- 测试用例 1（具有非对角耦合的矩阵 $\\mathbf{H}_0$，静态标量自能）：\n  - $\\mathbf{H}_0 = \\begin{bmatrix} -1.0  0.2 \\\\ 0.2  0.5 \\end{bmatrix}$。\n  - $\\mathbf{\\Sigma}(\\omega) = s_0\\,\\mathbf{I}$，其中 $s_0 = -0.3$。\n  - 准粒子能量是 $\\det\\!\\left[\\omega\\,\\mathbf{I} - \\mathbf{H}_0 - s_0\\,\\mathbf{I}\\right]=0$ 的实根 $\\omega$。\n  - 报告两个准粒子能量，按升序排列，四舍五入到六位小数。\n\n- 测试用例 2（对角矩阵 $\\mathbf{H}_0$，对角频率线性自能）：\n  - $\\mathbf{H}_0 = \\mathrm{diag}(-2.0,\\,-0.5,\\,1.0)$。\n  - $\\mathbf{\\Sigma}(\\omega) = \\mathrm{diag}\\!\\big(a_1 + b_1\\,\\omega,\\; a_2 + b_2\\,\\omega,\\; a_3 + b_3\\,\\omega\\big)$，其中 $(a_1, b_1)=(-0.2,\\,0.2)$，$(a_2, b_2)=(0.1,\\,0.1)$，$(a_3, b_3)=(0.0,\\,-0.3)$。\n  - 对于每个轨道 $i$，标量方程为 $\\omega - \\varepsilon_i - a_i - b_i\\,\\omega = 0$，其中 $\\varepsilon_i$ 是 $\\mathbf{H}_0$ 的第 $i$ 个对角元素。\n  - 报告三个准粒子能量，按升序排列，四舍五入到六位小数。\n\n- 测试用例 3（对角矩阵 $\\mathbf{H}_0$，电子-玻色子耦合模型的对角极点自能）：\n  - $\\mathbf{H}_0 = \\mathrm{diag}(-1.5,\\,0.8)$。\n  - 对于每个轨道 $i$，自能为 $\\Sigma_i(\\omega) = \\Delta_i + \\dfrac{\\alpha_i^2}{\\omega - \\Omega_i}$，参数如下\n    - 轨道 1: $(\\Delta_1, \\alpha_1, \\Omega_1) = (-0.1,\\,0.4,\\,-0.5)$，\n    - 轨道 2: $(\\Delta_2, \\alpha_2, \\Omega_2) = (0.05,\\,0.3,\\,0.4)$。\n  - 对于每个轨道 $i$，求解关于实数 $\\omega$ 的标量非线性方程：\n    $$\n    \\omega - \\varepsilon_i - \\Delta_i - \\frac{\\alpha_i^2}{\\omega - \\Omega_i} = 0.\n    $$\n    化去分母后，该方程可简化为一个二次方程。对于所选参数，存在两个实根；选择物理上相关的准粒子根，即其值与相应的無相互作用能量 $\\varepsilon_i$ 最接近（绝对差最小）的那个根。\n  - 报告两个选定的准粒子能量，按升序排列，四舍五入到六位小数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个由三个测试用例结果列表组成的逗号分隔列表，每个内部列表本身是该用例的准粒子能量的逗号分隔列表，并用方括号括起来。\n- 具体来说，程序应打印如下单行内容\n  $$\n  [ [\\omega^{(1)}_1,\\omega^{(1)}_2], [\\omega^{(2)}_1,\\omega^{(2)}_2,\\omega^{(2)}_3], [\\omega^{(3)}_1,\\omega^{(3)}_2] ]\\,,\n  $$\n  其中上标索引测试用例，下标索引该用例内的能量。所有数值条目必须以 $\\mathrm{eV}$ 为单位，并四舍五入到六位小数。", "solution": "首先将对问题陈述进行严格验证。\n\n**问题验证**\n\n**步骤1：提取给定条件**\n\n给定条件是一组定义和三个用于计算准粒子能量的测试用例。\n\n*   **基本定义**：\n    *   正交归一基中的单粒子推迟格林函数：\n        $$\n        \\mathbf{G}(\\omega) \\equiv \\left[ (\\omega + \\mu)\\,\\mathbf{I} - \\mathbf{H}_0 - \\mathbf{\\Sigma}(\\omega) \\right]^{-1}\n        $$\n    *   准粒子能量 $\\omega$ 的条件：\n        $$\n        \\det\\!\\left[ (\\omega + \\mu)\\,\\mathbf{I} - \\mathbf{H}_0 - \\mathbf{\\Sigma}(\\omega) \\right] = 0\n        $$\n*   **全局条件**：\n    *   基是正交归一的，因此交叠矩阵为 $\\mathbf{I}$。\n    *   化学势为 $\\mu = 0$ eV。\n    *   所有能量单位均为电子伏特 ($\\mathrm{eV}$)，最终结果必须四舍五入到六位小数。\n\n*   **测试用例 1**：\n    *   无相互作用哈密顿量：$\\mathbf{H}_0 = \\begin{bmatrix} -1.0  0.2 \\\\ 0.2  0.5 \\end{bmatrix}$。\n    *   自能：$\\mathbf{\\Sigma}(\\omega) = s_0\\,\\mathbf{I}$，其中 $s_0 = -0.3$。\n    *   任务：找到两个实根 $\\omega$，按升序排列。\n\n*   **测试用例 2**：\n    *   无相互作用哈密顿量：$\\mathbf{H}_0 = \\mathrm{diag}(-2.0,\\,-0.5,\\,1.0)$。\n    *   自能：$\\mathbf{\\Sigma}(\\omega) = \\mathrm{diag}\\!\\big(a_1 + b_1\\,\\omega,\\; a_2 + b_2\\,\\omega,\\; a_3 + b_3\\,\\omega\\big)$。\n    *   参数：$(a_1, b_1)=(-0.2,\\,0.2)$，$(a_2, b_2)=(0.1,\\,0.1)$，$(a_3, b_3)=(0.0,\\,-0.3)$。\n    *   任务：对每个轨道 $i$ 求解标量方程 $\\omega - \\varepsilon_i - a_i - b_i\\,\\omega = 0$，并按升序报告三个准粒子能量。\n\n*   **测试用例 3**：\n    *   无相互作用哈密顿量：$\\mathbf{H}_0 = \\mathrm{diag}(-1.5,\\,0.8)$。\n    *   轨道 $i$ 的自能：$\\Sigma_i(\\omega) = \\Delta_i + \\dfrac{\\alpha_i^2}{\\omega - \\Omega_i}$。\n    *   轨道 1 的参数：$(\\Delta_1, \\alpha_1, \\Omega_1) = (-0.1,\\,0.4,\\,-0.5)$。\n    *   轨道 2 的参数：$(\\Delta_2, \\alpha_2, \\Omega_2) = (0.05,\\,0.3,\\,0.4)$。\n    *   任务：对每个轨道 $i$ 求解标量方程 $\\omega - \\varepsilon_i - \\Delta_i - \\frac{\\alpha_i^2}{\\omega - \\Omega_i} = 0$。从两个实根中，选择值与无相互作用能量 $\\varepsilon_i$最接近的那个。按升序报告两个选定的能量。\n\n**步骤2：使用提取的给定条件进行验证**\n\n根据有效性标准对问题进行审查。\n\n*   **科学依据**：该问题基于单粒子格林函数的Dyson方程，这是量子多体理论和计算量子化学中的一个核心概念。所提出的自能模型（静态、线性频率依赖和单极点展开）是常见且成熟的近似方法。该问题在科学上和事实上都是合理的。\n*   **适定性**：每个测试用例在数学上都是适定的。用例1描述了一个标准的线性本征值问题，它有一组唯一的本征值。用例2简化为三个独立的线性方程，每个方程都有唯一的解。用例3涉及求解两个独立的二次方程；问题为每种情况提供了清晰明确的标准来选择具有物理意义的根。因此，每个测试用例都存在唯一的解。\n*   **客观性**：该问题使用精确、客观的数学语言进行表述。它没有任何主观或模棱两可的陈述。\n*   **完整性和一致性**：所有需要的数据，包括矩阵、参数和像 $\\mu=0$ 这样的常数，都已明確提供。该问题是自洽且内部一致的。\n\n**步骤3：结论和行动**\n\n该问题是**有效的**。它具有科学依据、适定且完整。现在将阐述一个完整的、合理的解决方案。\n\n**解题詳述**\n\n准粒子能量 $\\omega$ 是格林函数的极点，由方程 $\\det\\!\\left[\\mathbf{M}(\\omega)\\right] = 0$ 的根确定，其中 $\\mathbf{M}(\\omega) = (\\omega + \\mu)\\mathbf{I} - \\mathbf{H}_0 - \\mathbf{\\Sigma}(\\omega)$。在给定条件 $\\mu=0$ 下，核矩阵为 $\\mathbf{M}(\\omega) = \\omega\\mathbf{I} - \\mathbf{H}_0 - \\mathbf{\\Sigma}(\\omega)$。我们针对每个测试用例求解根 $\\omega$。\n\n**测试用例 1**\n\n自能是静态且标量的：$\\mathbf{\\Sigma}(\\omega) = s_0\\,\\mathbf{I}$，其中 $s_0 = -0.3$。准粒子能量的条件变为：\n$$\n\\det\\!\\left[ \\omega\\mathbf{I} - \\mathbf{H}_0 - s_0\\mathbf{I} \\right] = 0\n$$\n这可以重写为一个标准的本征值问题：\n$$\n\\det\\!\\left[ \\omega\\mathbf{I} - (\\mathbf{H}_0 + s_0\\mathbf{I}) \\right] = 0\n$$\n准粒子能量 $\\omega$ 是有效哈密顿矩阵 $\\mathbf{H}' = \\mathbf{H}_0 + s_0\\mathbf{I}$ 的本征值。我们构建这个矩阵：\n$$\n\\mathbf{H}' = \\begin{bmatrix} -1.0  0.2 \\\\ 0.2  0.5 \\end{bmatrix} + (-0.3)\\begin{bmatrix} 1  0 \\\\ 0  1 \\end{bmatrix} = \\begin{bmatrix} -1.0 - 0.3  0.2 \\\\ 0.2  0.5 - 0.3 \\end{bmatrix} = \\begin{bmatrix} -1.3  0.2 \\\\ 0.2  0.2 \\end{bmatrix}\n$$\n计算这个 $2 \\times 2$ 实对称矩阵的本征值。其特征方程为 $(\\lambda - (-1.3))(\\lambda - 0.2) - (0.2)(0.2) = 0$，简化为 $\\lambda^2 + 1.1\\lambda - 0.3 = 0$。为保证精度，使用数值方法求解，得到的本征值约为 $\\omega_1 = -1.326204$ eV 和 $\\omega_2 = 0.226204$ eV。\n\n**测试用例 2**\n\n在这里，$\\mathbf{H}_0$ 和 $\\mathbf{\\Sigma}(\\omega)$ 都是对角矩阵。矩阵方程解耦为三个独立的标量方程，每个轨道 $i \\in \\{1, 2, 3\\}$ 对应一个。一般形式为 $\\omega - \\varepsilon_i - \\Sigma_{ii}(\\omega) = 0$，其中 $\\varepsilon_i$ 是 $\\mathbf{H}_0$ 的对角元素。\n自能分量是频率的线性函数：$\\Sigma_{ii}(\\omega) = a_i + b_i\\omega$。轨道 $i$ 的标量方程是：\n$$\n\\omega - \\varepsilon_i - (a_i + b_i\\omega) = 0\n$$\n这是一个关于 $\\omega$ 的线性方程，可以通过重新整理找到解：\n$$\n\\omega(1 - b_i) = \\varepsilon_i + a_i \\implies \\omega_i = \\frac{\\varepsilon_i + a_i}{1 - b_i}\n$$\n我们使用提供的参数对每个轨道应用此公式：\n*   对于 $i=1$：$\\varepsilon_1=-2.0$, $a_1=-0.2$, $b_1=0.2$。\n    $\\omega_1 = \\frac{-2.0 + (-0.2)}{1 - 0.2} = \\frac{-2.2}{0.8} = -2.75$ eV。\n*   对于 $i=2$：$\\varepsilon_2=-0.5$, $a_2=0.1$, $b_2=0.1$。\n    $\\omega_2 = \\frac{-0.5 + 0.1}{1 - 0.1} = \\frac{-0.4}{0.9} \\approx -0.444444$ eV。\n*   对于 $i=3$：$\\varepsilon_3=1.0$, $a_3=0.0$, $b_3=-0.3$。\n    $\\omega_3 = \\frac{1.0 + 0.0}{1 - (-0.3)} = \\frac{1.0}{1.3} \\approx 0.769231$ eV。\n结果按升序排列为 $\\{-2.75, -0.444444, 0.769231\\}$ eV。\n\n**测试用例 3**\n\n与用例2一样，矩阵是对角的，因此问题解耦。每个轨道 $i$ 的自能具有单极点结构：$\\Sigma_i(\\omega) = \\Delta_i + \\frac{\\alpha_i^2}{\\omega - \\Omega_i}$。关于 $\\omega$ 的标量方程是：\n$$\n\\omega - \\varepsilon_i - \\left(\\Delta_i + \\frac{\\alpha_i^2}{\\omega - \\Omega_i}\\right) = 0\n$$\n为求解此非线性方程，我们乘以 $(\\omega - \\Omega_i)$ 项以消除分母，假设 $\\omega \\neq \\Omega_i$：\n$$\n(\\omega - \\varepsilon_i - \\Delta_i)(\\omega - \\Omega_i) - \\alpha_i^2 = 0\n$$\n这是一个关于 $\\omega$ 的二次方程，形式为 $A\\omega^2 + B\\omega + C = 0$。展开表达式可得：\n$$\n\\omega^2 - (\\varepsilon_i + \\Delta_i + \\Omega_i)\\omega + ((\\varepsilon_i + \\Delta_i)\\Omega_i - \\alpha_i^2) = 0\n$$\n我们为每个轨道求解这个二次方程，并应用选择标准。\n\n*   对于轨道 1：$\\varepsilon_1 = -1.5$, $\\Delta_1 = -0.1$, $\\alpha_1 = 0.4$, $\\Omega_1 = -0.5$。\n    方程为 $\\omega^2 - (-1.5 - 0.1 - 0.5)\\omega + ((-1.5 - 0.1)(-0.5) - 0.4^2) = 0$。\n    这简化为 $\\omega^2 + 2.1\\omega + (0.8 - 0.16) = 0$，或 $\\omega^2 + 2.1\\omega + 0.64 = 0$。\n    两个根为 $\\omega \\approx -1.730074$ 和 $\\omega \\approx -0.369926$。\n    无相互作用能量为 $\\varepsilon_1 = -1.5$。我们找到更接近此值的根：\n    $|-1.730074 - (-1.5)| = 0.230074$。\n    $|-0.369926 - (-1.5)| = 1.130074$。\n    第一个根更接近。因此，选定的准粒子能量为 $\\omega_1 = -1.730074$ eV。\n\n*   对于轨道 2：$\\varepsilon_2 = 0.8$, $\\Delta_2 = 0.05$, $\\alpha_2 = 0.3$, $\\Omega_2 = 0.4$。\n    方程为 $\\omega^2 - (0.8 + 0.05 + 0.4)\\omega + ((0.8 + 0.05)(0.4) - 0.3^2) = 0$。\n    这简化为 $\\omega^2 - 1.25\\omega + (0.34 - 0.09) = 0$，或 $\\omega^2 - 1.25\\omega + 0.25 = 0$。\n    两个根为 $\\omega = 1.0$ 和 $\\omega = 0.25$。\n    无相互作用能量为 $\\varepsilon_2 = 0.8$。我们找到更接近此值的根：\n    $|1.0 - 0.8| = 0.2$。\n    $|0.25 - 0.8| = 0.55$。\n    第一个根更接近。因此，选定的准粒子能量为 $\\omega_2 = 1.0$ eV。\n\n结果按升序排列为 $\\{-1.730074, 1.0\\}$ eV。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for quasiparticle energies for three different test cases based on\n    the matrix Dyson equation.\n    \"\"\"\n\n    # --- Test Case 1: Matrix H0 with static scalar self-energy ---\n    H0_1 = np.array([\n        [-1.0, 0.2],\n        [0.2, 0.5]\n    ])\n    s0_1 = -0.3\n    # The quasiparticle energies are the eigenvalues of H' = H0 + s0*I\n    H_prime_1 = H0_1 + s0_1 * np.identity(2)\n    # Since H_prime_1 is real and symmetric, use eigvalsh\n    energies_1 = np.linalg.eigvalsh(H_prime_1)\n    energies_1.sort()\n    \n    # --- Test Case 2: Diagonal H0 with diagonal linear self-energy ---\n    epsilons_2 = np.array([-2.0, -0.5, 1.0])\n    params_2 = [\n        (-0.2, 0.2),  # (a1, b1)\n        (0.1, 0.1),   # (a2, b2)\n        (0.0, -0.3)   # (a3, b3)\n    ]\n    energies_2 = []\n    for i in range(3):\n        eps_i = epsilons_2[i]\n        a_i, b_i = params_2[i]\n        # omega(1 - b_i) = eps_i + a_i => omega = (eps_i + a_i) / (1 - b_i)\n        omega_i = (eps_i + a_i) / (1 - b_i)\n        energies_2.append(omega_i)\n    energies_2.sort()\n\n    # --- Test Case 3: Diagonal H0 with diagonal pole self-energy ---\n    epsilons_3 = np.array([-1.5, 0.8])\n    params_3 = [\n        (-0.1, 0.4, -0.5), # (Delta1, alpha1, Omega1)\n        (0.05, 0.3, 0.4)   # (Delta2, alpha2, Omega2)\n    ]\n    energies_3 = []\n    for i in range(2):\n        eps_i = epsilons_3[i]\n        Delta_i, alpha_i, Omega_i = params_3[i]\n        \n        # The equation is omega^2 - (eps_i + Delta_i + Omega_i) * omega +\n        # ((eps_i + Delta_i) * Omega_i - alpha_i^2) = 0\n        # This is a quadratic equation Ax^2 + Bx + C = 0 with A=1.\n        A = 1.0\n        B = -(eps_i + Delta_i + Omega_i)\n        C = (eps_i + Delta_i) * Omega_i - alpha_i**2\n        \n        roots = np.roots([A, B, C])\n        \n        # Select the root closest to the non-interacting energy eps_i\n        diffs = np.abs(roots - eps_i)\n        chosen_root = roots[np.argmin(diffs)]\n        energies_3.append(chosen_root)\n    energies_3.sort()\n\n    # --- Formatting the final output ---\n    def format_energies(energy_list):\n        return ','.join([f\"{e:.6f}\" for e in energy_list])\n\n    results_str = [\n        f\"[{format_energies(energies_1)}]\",\n        f\"[{format_energies(energies_2)}]\",\n        f\"[{format_energies(energies_3)}]\"\n    ]\n    \n    print(f\"[{','.join(results_str)}]\")\n\nsolve()\n```", "id": "2894544"}]}