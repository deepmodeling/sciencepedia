{"hands_on_practices": [{"introduction": "在应用道格拉斯-克罗尔-赫斯（DKH）变换等相对论方法之前，构建一个能够恰当描述电子相对论效应的基组是至关重要的一步。动能平衡（Kinetic Balance）条件确保了小分量基函数与大分量基函数之间的正确关联，这对于避免变分崩溃和精确求解狄拉克方程至关重要。本练习 [@problem_id:2887145] 将通过一个具体的计算，带你亲手实践如何利用严格动能平衡（Restricted Kinetic Balance, RKB）规则，从一个给定的高斯型大分量基函数出发，构建并归一化其对应的小分量基函数。", "problem": "在基于 Douglas–Kroll–Hess (DKH) 解耦的相对论量子化学处理中，限制性动能平衡 (RKB) 方案通过关系式 $\\chi_{S} \\propto \\left(\\boldsymbol{\\sigma}\\cdot\\mathbf{p}\\right)\\chi_{L}$ 从给定的大分量基函数构造小分量基函数，其中 $\\boldsymbol{\\sigma}$ 表示泡利矩阵的矢量，$\\mathbf{p}$ 是动量算符。考虑一个位于原点的单一归一化大分量旋量基函数，其空间部分由一个 $s$ 型高斯原函数和一个自旋向上的双分量旋量给出，\n$$\n\\chi_{L}(\\mathbf{r}) \\;=\\; g(\\mathbf{r})\\,\\xi,\\quad g(\\mathbf{r}) \\;=\\; N\\,\\exp\\!\\left(-\\alpha\\,r^{2}\\right),\\quad \\xi \\;=\\; \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix},\n$$\n其中 $\\alpha>0$ 是高斯指数，$N$ 是归一化常数。在原子单位制中进行计算，因此 $\\hbar = 1$，$m_{e} = 1$，动量算符为 $\\mathbf{p} = -\\,\\mathrm{i}\\,\\boldsymbol{\\nabla}$。通过下式定义 RKB 小分量基函数：\n$$\n\\chi_{S}(\\mathbf{r}) \\;=\\; \\kappa\\,\\left(\\boldsymbol{\\sigma}\\cdot\\mathbf{p}\\right)\\chi_{L}(\\mathbf{r}),\n$$\n其中 $\\kappa$ 是一个实数比例常数。确定 $\\kappa$ 的值，使得小分量基函数是归一化的，即\n$$\n\\int \\chi_{S}^{\\dagger}(\\mathbf{r})\\,\\chi_{S}(\\mathbf{r})\\,\\mathrm{d}^{3}\\mathbf{r} \\;=\\; 1.\n$$\n将最终答案表示为仅含 $\\alpha$ 的闭合形式解析表达式。使用原子单位，不要进行任何数值取整。最终答案必须是一个不带单位的单一表达式。", "solution": "该问题是有效的，因为它在相对论量子化学中有科学依据，问题阐述清晰，目标明确，并且是自洽的。我将开始解题。\n\n目标是确定实数比例常数 $\\kappa$，使得小分量旋量基函数 $\\chi_{S}(\\mathbf{r})$ 归一化为1。归一化条件由下式给出：\n$$\n\\int \\chi_{S}^{\\dagger}(\\mathbf{r})\\,\\chi_{S}(\\mathbf{r})\\,\\mathrm{d}^{3}\\mathbf{r} = 1\n$$\n首先，我们必须确定大分量基函数 $\\chi_{L}(\\mathbf{r})$ 的归一化常数 $N$。大分量由 $\\chi_{L}(\\mathbf{r}) = g(\\mathbf{r})\\xi$ 给出，其中 $g(\\mathbf{r}) = N\\exp(-\\alpha r^2)$ 且 $\\xi = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。$\\chi_L$ 的归一化条件是 $\\int \\chi_{L}^{\\dagger}(\\mathbf{r})\\chi_{L}(\\mathbf{r})\\,\\mathrm{d}^{3}\\mathbf{r} = 1$。\n被积函数是 $\\chi_{L}^{\\dagger}\\chi_{L} = (g^{*}(\\mathbf{r})\\xi^{\\dagger})(g(\\mathbf{r})\\xi) = |g(\\mathbf{r})|^2 (\\xi^{\\dagger}\\xi)$。由于 $g(\\mathbf{r})$ 是实数，$|g(\\mathbf{r})|^2 = g(\\mathbf{r})^2 = N^2 \\exp(-2\\alpha r^2)$。旋量部分是 $\\xi^{\\dagger}\\xi = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = 1$。\n因此，$\\chi_L$ 的归一化条件变为：\n$$\n\\int N^2 \\exp(-2\\alpha r^2) \\,\\mathrm{d}^{3}\\mathbf{r} = 1\n$$\n这是一个标准的三维高斯积分。$\\exp(-ar^2)$ 在全空间的积分是 $(\\pi/a)^{3/2}$。当 $a = 2\\alpha$ 时，我们有：\n$$\nN^2 \\left(\\frac{\\pi}{2\\alpha}\\right)^{3/2} = 1\n$$\n解出 $N^2$，我们得到大分量归一化常数的平方：\n$$\nN^2 = \\left(\\frac{2\\alpha}{\\pi}\\right)^{3/2}\n$$\n接下来，我们构造小分量函数 $\\chi_{S}(\\mathbf{r})$：\n$$\n\\chi_{S}(\\mathbf{r}) = \\kappa\\,(\\boldsymbol{\\sigma}\\cdot\\mathbf{p})\\chi_{L}(\\mathbf{r})\n$$\n使用原子单位制中的动量算符 $\\mathbf{p} = -\\mathrm{i}\\boldsymbol{\\nabla}$，我们得到：\n$$\n\\chi_{S}(\\mathbf{r}) = \\kappa (-\\mathrm{i}\\boldsymbol{\\sigma}\\cdot\\boldsymbol{\\nabla}) [N \\exp(-\\alpha r^2) \\xi] = -\\mathrm{i} \\kappa N [(\\boldsymbol{\\sigma}\\cdot\\boldsymbol{\\nabla})\\exp(-\\alpha r^2)] \\xi\n$$\n高斯函数的梯度是 $\\boldsymbol{\\nabla}\\exp(-\\alpha r^2) = -2\\alpha\\mathbf{r}\\exp(-\\alpha r^2)$。将此代入 $\\chi_S$ 的表达式中：\n$$\n\\chi_{S}(\\mathbf{r}) = -\\mathrm{i} \\kappa N [\\boldsymbol{\\sigma}\\cdot(-2\\alpha\\mathbf{r})] \\exp(-\\alpha r^2) \\xi = 2\\mathrm{i}\\alpha N \\kappa (\\boldsymbol{\\sigma}\\cdot\\mathbf{r}) \\exp(-\\alpha r^2) \\xi\n$$\n现在，我们建立 $\\chi_S$ 的归一化积分。首先，我们计算被积函数 $\\chi_{S}^{\\dagger}\\chi_{S}$。其伴随 $\\chi_{S}^{\\dagger}$ 是：\n$$\n\\chi_{S}^{\\dagger}(\\mathbf{r}) = [2\\mathrm{i}\\alpha N \\kappa (\\boldsymbol{\\sigma}\\cdot\\mathbf{r}) \\exp(-\\alpha r^2) \\xi]^{\\dagger} = -2\\mathrm{i}\\alpha N \\kappa \\exp(-\\alpha r^2) \\xi^{\\dagger} (\\boldsymbol{\\sigma}\\cdot\\mathbf{r})^{\\dagger}\n$$\n由于 $\\mathbf{r}$ 的分量是实数，泡利矩阵 $\\sigma_i$ 是厄米的，所以 $(\\boldsymbol{\\sigma}\\cdot\\mathbf{r})^{\\dagger} = \\boldsymbol{\\sigma}\\cdot\\mathbf{r}$。因此：\n$$\n\\chi_{S}^{\\dagger}(\\mathbf{r}) = -2\\mathrm{i}\\alpha N \\kappa \\exp(-\\alpha r^2) \\xi^{\\dagger} (\\boldsymbol{\\sigma}\\cdot\\mathbf{r})\n$$\n乘积 $\\chi_{S}^{\\dagger}\\chi_{S}$ 是：\n$$\n\\chi_{S}^{\\dagger}\\chi_{S} = (-2\\mathrm{i}\\alpha N \\kappa \\exp(-\\alpha r^2) \\xi^{\\dagger} (\\boldsymbol{\\sigma}\\cdot\\mathbf{r}))(2\\mathrm{i}\\alpha N \\kappa (\\boldsymbol{\\sigma}\\cdot\\mathbf{r}) \\exp(-\\alpha r^2) \\xi)\n$$\n$$\n\\chi_{S}^{\\dagger}\\chi_{S} = 4(\\alpha N \\kappa)^2 \\exp(-2\\alpha r^2) \\xi^{\\dagger} (\\boldsymbol{\\sigma}\\cdot\\mathbf{r})^2 \\xi\n$$\n我们使用恒等式 $(\\boldsymbol{\\sigma}\\cdot\\mathbf{A})(\\boldsymbol{\\sigma}\\cdot\\mathbf{B}) = (\\mathbf{A}\\cdot\\mathbf{B})I_2 + \\mathrm{i}\\boldsymbol{\\sigma}\\cdot(\\mathbf{A}\\times\\mathbf{B})$，其中 $I_2$ 是 $2 \\times 2$ 单位矩阵。对于 $\\mathbf{A} = \\mathbf{B} = \\mathbf{r}$，该式简化为 $(\\boldsymbol{\\sigma}\\cdot\\mathbf{r})^2 = (\\mathbf{r}\\cdot\\mathbf{r})I_2 + \\mathrm{i}\\boldsymbol{\\sigma}\\cdot(\\mathbf{r}\\times\\mathbf{r}) = r^2 I_2$，因为 $\\mathbf{r}\\times\\mathbf{r} = \\mathbf{0}$。\n将此代入 $\\chi_{S}^{\\dagger}\\chi_{S}$ 的表达式中：\n$$\n\\chi_{S}^{\\dagger}\\chi_{S} = 4(\\alpha N \\kappa)^2 \\exp(-2\\alpha r^2) \\xi^{\\dagger} (r^2 I_2) \\xi = 4(\\alpha N \\kappa)^2 r^2 \\exp(-2\\alpha r^2) (\\xi^{\\dagger}\\xi)\n$$\n由于 $\\xi^{\\dagger}\\xi = 1$，被积函数是一个标量函数：\n$$\n\\chi_{S}^{\\dagger}\\chi_{S} = 4\\alpha^2 N^2 \\kappa^2 r^2 \\exp(-2\\alpha r^2)\n$$\n因此，归一化条件是：\n$$\n\\int 4\\alpha^2 N^2 \\kappa^2 r^2 \\exp(-2\\alpha r^2) \\,\\mathrm{d}^{3}\\mathbf{r} = 1\n$$\n$$\n4\\alpha^2 N^2 \\kappa^2 \\int r^2 \\exp(-2\\alpha r^2) \\,\\mathrm{d}^{3}\\mathbf{r} = 1\n$$\n为了计算积分 $\\int r^2 \\exp(-ar^2) \\,\\mathrm{d}^{3}\\mathbf{r}$，其中 $a=2\\alpha$，我们可以对标准高斯积分关于参数 $a$ 求导：\n$$\n\\int \\exp(-ar^2)\\,\\mathrm{d}^{3}\\mathbf{r} = \\left(\\frac{\\pi}{a}\\right)^{3/2}\n$$\n$$\n\\int r^2 \\exp(-ar^2) \\,\\mathrm{d}^{3}\\mathbf{r} = -\\frac{\\mathrm{d}}{\\mathrm{d}a} \\int \\exp(-ar^2)\\,\\mathrm{d}^{3}\\mathbf{r} = -\\frac{\\mathrm{d}}{\\mathrm{d}a} \\left(\\pi^{3/2} a^{-3/2}\\right) = -\\pi^{3/2} \\left(-\\frac{3}{2} a^{-5/2}\\right) = \\frac{3\\pi^{3/2}}{2} a^{-5/2}\n$$\n代入 $a = 2\\alpha$，积分为 $\\frac{3\\pi^{3/2}}{2}(2\\alpha)^{-5/2}$。现在我们将此结果和 $N^2$ 的表达式代入归一化方程：\n$$\n4\\alpha^2 \\kappa^2 \\left(\\frac{2\\alpha}{\\pi}\\right)^{3/2} \\left(\\frac{3\\pi^{3/2}}{2}(2\\alpha)^{-5/2}\\right) = 1\n$$\n通过合并各项来简化表达式：\n$$\n4\\alpha^2 \\kappa^2 \\frac{(2\\alpha)^{3/2}}{\\pi^{3/2}} \\frac{3\\pi^{3/2}}{2} (2\\alpha)^{-5/2} = 1\n$$\n$\\pi^{3/2}$ 项相互抵消：\n$$\n4\\alpha^2 \\kappa^2 \\frac{3}{2} (2\\alpha)^{3/2 - 5/2} = 1\n$$\n$$\n4\\alpha^2 \\kappa^2 \\frac{3}{2} (2\\alpha)^{-1} = 1\n$$\n$$\n4\\alpha^2 \\kappa^2 \\frac{3}{2} \\frac{1}{2\\alpha} = 1\n$$\n$$\n\\frac{12\\alpha^2 \\kappa^2}{4\\alpha} = 1\n$$\n$$\n3\\alpha\\kappa^2 = 1\n$$\n最后，解出 $\\kappa$：\n$$\n\\kappa^2 = \\frac{1}{3\\alpha}\n$$\n由于 $\\kappa$ 是一个实常数且 $\\alpha>0$，按照归一化常数的惯例，我们取正实根：\n$$\n\\kappa = \\sqrt{\\frac{1}{3\\alpha}} = \\frac{1}{\\sqrt{3\\alpha}}\n$$", "answer": "$$\n\\boxed{\\frac{1}{\\sqrt{3\\alpha}}}\n$$", "id": "2887145"}, {"introduction": "当我们将哈密顿算符从四分量绘景变换到解耦的二分量绘景时，为了获得与实验可观测量一致的期望值，必须对相应的属性算符进行同样的变换。这一过程被称为“绘景变换”（Picture Change）。本练习 [@problem_id:2887184] 建立了一个简化的二维矩阵模型，用以阐明绘景变换的本质，并量化在二级DKH（DKH2）近似下忽略此效应所引入的误差，帮助你深刻理解在近似相对论计算中保持理论一致性的重要性。", "problem": "构建一个最小化的、自洽的计算任务，用于在使用二阶 Douglas-Kroll-Hess (DKH2) 解耦合变换时，量化单电子性质的绘景变换 (PC) 误差。从单电子狄拉克哈密顿量的块结构出发，\n$$\nH \\;=\\; \\beta\\,M \\;+\\; E \\;+\\; O,\n$$\n其中 $M \\equiv m c^2$ 是一个正标量，$\\beta$ 是对角元为 $+1$ 和 $-1$ 的 $2\\times 2$ 对角矩阵，$E$ 是偶部分（与 $\\beta$ 对易），因此是对角的，$O$ 是奇部分（与 $\\beta$ 反对易），因此是纯非对角的。设 $U=\\exp(W)$ 为幺正解耦合变换，其奇生成子 $W$ 的选择要使得在使用 Baker-Campbell-Hausdorff (BCH) 级数展开时，$H$ 的奇部分在小参数 $1/M$ 的一阶上被移除。在 $1/M$ 的二阶上进行一致的处理，以定义 DKH2 有效偶哈密顿量和相应的二阶变换后（绘景变换后）的性质算符。假设单电子性质算符 $A$ 是偶的（与 $\\beta$ 对易）。\n\n你的程序必须仅使用线性代数和对易子作为基本运算来实现以下内容，不依赖于本问题陈述中给出的任何简化公式：\n\n- 使用 $U^\\dagger H U$ 的 BCH 展开，其中选择奇生成子 $W$ 以抵消 $H$ 的一阶奇贡献，并保留至 $1/M$ 的二阶项以获得偶 DKH2 哈密顿量。使用此哈密顿量来确定在解耦合绘景中与上层双旋量分量对应的正能投影算符 $P_+ \\equiv (\\mathbf{1}+\\beta)/2$。\n\n- 使用相同的 BCH 展开至 $1/M$ 的二阶，将偶性质算符 $A$ 变换为其绘景变换形式，并将其投影到正能子空间上。将得到的正能性质值记为 $\\langle A\\rangle_{\\mathrm{PC}}$。\n\n- 通过将原始算符 $A$ 投影到由上述构建的 DKH2 哈密顿量的解耦合绘景中的正能子空间上，计算相应的未经变换的（非 PC）正能性质值 $\\langle A\\rangle_{\\mathrm{nonPC}}$。\n\n- 将忽略绘景变换所引入的 PC 误差量化为标量差\n$$\n\\Delta \\equiv \\langle A\\rangle_{\\mathrm{nonPC}} - \\langle A\\rangle_{\\mathrm{PC}}.\n$$\n\n将所有矩阵表示为一个与奇/偶结构一致的最小化 $2\\times 2$ 模型：\n- $\\beta = \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix}$。\n- $E = \\mathrm{diag}(e_u, e_l)$，其中 $e_u$ 和 $e_l$ 是实标量。\n- $O = \\begin{pmatrix} 0  t \\\\ t  0 \\end{pmatrix}$，其中 $t$ 是实标量耦合。\n- $A = \\mathrm{diag}(a_u, a_l)$，其中 $a_u$ 和 $a_l$ 是实标量。\n- $M > 0$ 是一个实标量。\n\n在本练习中，所有量均被视为无量纲，因此不需要物理单位。\n\n你的程序必须为以下五个测试用例中的每一个计算标量误差 $\\Delta$，每个测试用例由元组 $(M, t, e_u, e_l, a_u, a_l)$ 指定：\n- Case $1$: $(1000.0, 0.8, 0.2, 0.2, 0.5, 0.5)$。\n- Case $2$: $(100.0, 0.5, 0.0, 0.0, 1.0, 2.0)$。\n- Case $3$: $(50.0, 0.0, 0.3, -0.1, -1.0, 1.0)$。\n- Case $4$: $(10.0, 1.5, 0.0, 0.0, 0.0, 1.0)$。\n- Case $5$: $(20.0, 3.0, 1.0, 1.5, 2.0, 1.0)$。\n\n实现要求和指导：\n- 将对易子视为 $[X,Y] \\equiv XY - YX$。\n- 根据与 $\\beta$ 的（反）对易关系对算符进行奇偶分类。\n- 对哈密顿量和性质算符均使用 BCH 级数展开至 $1/M$ 的二阶，并强制所选的奇生成子 $W$ 消除 $H$ 的一阶奇数项。\n- 使用正能投影算符 $P_+ \\equiv (\\mathbf{1}+\\beta)/2$ 在解耦合绘景中提取正能值。\n\n你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，“[x1,x2,x3,x4,x5]”）。每个列表条目必须是对应于相应测试用例的 $\\Delta$ 值的浮点数，并具有合理的浮点格式。不应打印任何额外文本。", "solution": "所述问题具有科学依据、提法恰当且无矛盾。它提出了一个在相对论量子化学中的标准但简化的任务：在二阶 Douglas-Kroll-Hess (DKH2) 框架内推导单电子性质的绘景变换误差。我们将进行形式推导。\n\n目标是计算绘景变换误差 $\\Delta \\equiv \\langle A\\rangle_{\\mathrm{nonPC}} - \\langle A\\rangle_{\\mathrm{PC}}$。这需要推导 DKH2 解耦合变换及其对性质算符 $A$ 的影响。该分析将在展开参数 $1/M$ 的二阶上保持一致地进行。\n\n单电子狄拉克哈密顿量由 $H = \\beta M + E + O$ 给出，其中 $H_E = \\beta M + E$ 是偶部分，$H_O = O$ 是奇部分。解耦合变换是一个幺正算符 $U = \\exp(W)$，其中生成子 $W$ 是反厄米和奇的，即 $\\{W, \\beta\\} = 0$ 和 $W^\\dagger = -W$。变换后的哈密顿量是 $H' = U^\\dagger H U = e^{-W} H e^{W}$。我们使用 Baker-Campbell-Hausdorff (BCH) 展开：\n$$ H' = H + [H, W] + \\frac{1}{2!} [[H, W], W] + \\dots $$\n选择生成子 $W$ 以消除 $H$ 的最低阶奇部分。$H'$ 的奇部分在一阶上近似为 $H'_O \\approx O + [\\beta M + E, W]$。我们要求抵消主导项：\n$$ O + [\\beta M, W] = 0 $$\n由于 $W$ 是奇的，它与 $\\beta$ 反对易，所以 $[\\beta, W] = \\beta W - W \\beta = \\beta W - (-\\beta W) = 2\\beta W$。条件变为：\n$$ O + 2M\\beta W = 0 \\implies W = -\\frac{1}{2M} \\beta O $$\n该生成子 $W$ 是 $O(1/M)$ 阶的。由于 $O$ 和 $\\beta$ 是厄米的，$\\beta O$ 是反厄米的，因此 $W$ 也是反厄米的，符合要求。\n\n接下来，我们计算变换后的性质算符 $A' = U^\\dagger A U = e^{-W} A e^{W}$。由于算符 $A$ 是偶的，其 BCH 展开为：\n$$ A' = A + [A, W] + \\frac{1}{2!} [[A, W], W] + \\dots $$\n我们必须根据各项的奇偶性对其进行分类。$A$ 是偶的，$W$ 是奇的。\n- $A$：偶。\n- $[A, W]$：偶算符和奇算符的对易子是奇的。\n- $[[A, W], W]$：奇算符和奇算符的对易子是偶的。\n因此，$A'$ 的偶部分是 $A'_E = A + \\frac{1}{2}[[A, W], W] + \\dots$。\n为了在 $O(1/M^2)$ 阶上保持一致，我们只需要计算第二项，因为 $W$ 是 $O(1/M)$ 阶的。\n$$ [[A, W], W] = \\left[ \\left[A, -\\frac{1}{2M} \\beta O\\right], -\\frac{1}{2M} \\beta O \\right] = \\frac{1}{4M^2} [ [A, \\beta O], \\beta O ] $$\n由于 $A$ 是偶的，它与 $\\beta$ 对易，所以 $[A, \\beta O] = \\beta A O - \\beta O A = \\beta[A,O]$。代入此式：\n$$ [[A, W], W] = \\frac{1}{4M^2} [\\beta[A,O], \\beta O] $$\n因此，二阶绘景变换后的性质算符（偶部分）为：\n$$ A'_{E} = A + \\frac{1}{8M^2} [\\beta[A,O], \\beta O] $$\n绘景变换后的性质值 $\\langle A\\rangle_{\\mathrm{PC}}$ 是正能期望值，通过将 $A'_{E}$ 投影到由投影算符 $P_+ = (\\mathbf{1}+\\beta)/2$ 定义的正能子空间上获得。对于块对角结构，这对应于矩阵的左上角元素。\n\n非绘景变换值 $\\langle A\\rangle_{\\mathrm{nonPC}}$ 是通过将原始算符 $A$ 投影到同一正能子空间上获得的。在此基组下，这仅仅是 $A$ 的左上角元素。给定指定的矩阵形式：\n$A = \\begin{pmatrix} a_u  0 \\\\ 0  a_l \\end{pmatrix}$。\n投影产生标量值：\n$$ \\langle A\\rangle_{\\mathrm{nonPC}} = a_u $$\n\n为了求得 $\\langle A\\rangle_{\\mathrm{PC}}$，我们计算修正项的矩阵形式。所用矩阵为：\n$\\beta = \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix}$，$O = \\begin{pmatrix} 0  t \\\\ t  0 \\end{pmatrix}$。\n首先，我们计算对易子：\n$$ [A,O] = \\begin{pmatrix} a_u  0 \\\\ 0  a_l \\end{pmatrix} \\begin{pmatrix} 0  t \\\\ t  0 \\end{pmatrix} - \\begin{pmatrix} 0  t \\\\ t  0 \\end{pmatrix} \\begin{pmatrix} a_u  0 \\\\ 0  a_l \\end{pmatrix} = \\begin{pmatrix} 0  (a_u-a_l)t \\\\ -(a_u-a_l)t  0 \\end{pmatrix} $$\n$$ \\beta[A,O] = \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix} \\begin{pmatrix} 0  (a_u-a_l)t \\\\ -(a_u-a_l)t  0 \\end{pmatrix} = (a_u-a_l) \\begin{pmatrix} 0  t \\\\ t  0 \\end{pmatrix} = (a_u-a_l)O $$\n$$ \\beta O = \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix} \\begin{pmatrix} 0  t \\\\ t  0 \\end{pmatrix} = \\begin{pmatrix} 0  t \\\\ -t  0 \\end{pmatrix} $$\n现在计算外层对易子 $[\\beta[A,O], \\beta O]$：\n$$ [\\beta[A,O], \\beta O] = [(a_u-a_l)O, \\beta O] = (a_u-a_l)[O, \\beta O] $$\n$$ [O, \\beta O] = O(\\beta O) - (\\beta O)O = -\\beta O^2 - \\beta O^2 = -2\\beta O^2 $$\n$O^2 = \\begin{pmatrix} 0  t \\\\ t  0 \\end{pmatrix} \\begin{pmatrix} 0  t \\\\ t  0 \\end{pmatrix} = \\begin{pmatrix} t^2  0 \\\\ 0  t^2 \\end{pmatrix} = t^2\\mathbf{1}$。\n所以，$[O, \\beta O] = -2\\beta (t^2 \\mathbf{1}) = -2t^2\\beta$。\n完整的对易子是：\n$$ [\\beta[A,O], \\beta O] = (a_u-a_l)(-2t^2\\beta) = -2(a_u-a_l)t^2\\beta $$\n$A'_E$ 中的修正项是：\n$$ \\frac{1}{8M^2} [-2(a_u-a_l)t^2\\beta] = -\\frac{(a_u-a_l)t^2}{4M^2}\\beta $$\n绘景变换后的算符是：\n$$ A'_{E} = A - \\frac{(a_u-a_l)t^2}{4M^2}\\beta = \\begin{pmatrix} a_u  0 \\\\ 0  a_l \\end{pmatrix} - \\frac{(a_u-a_l)t^2}{4M^2}\\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix} $$\n正能投影（左上角元素）是：\n$$ \\langle A\\rangle_{\\mathrm{PC}} = a_u - \\frac{(a_u-a_l)t^2}{4M^2} $$\n最后，绘景变换误差 $\\Delta$ 计算为差值：\n$$ \\Delta = \\langle A\\rangle_{\\mathrm{nonPC}} - \\langle A\\rangle_{\\mathrm{PC}} = a_u - \\left( a_u - \\frac{(a_u-a_l)t^2}{4M^2} \\right) $$\n$$ \\Delta = \\frac{(a_u-a_l)t^2}{4M^2} $$\n这是在给定模型中，对绘景变换误差在 $1/M$ 的二阶上的最终解析表达式。来自算符 $E$ 的参数 $e_u$ 和 $e_l$ 没有出现在 $\\Delta$ 的最终表达式中，因为它们只对 DKH2 哈密顿量有贡献，而在此阶次上对算符 $A$ 的绘景变换没有贡献。我们现在将使用此公式计算给定测试用例的结果。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the picture-change (PC) error for a one-electron property\n    using the second-order Douglas-Kroll-Hess (DKH2) decoupling transformation\n    within a simplified 2x2 model.\n    \"\"\"\n\n    # Test cases are provided as tuples: (M, t, e_u, e_l, a_u, a_l)\n    test_cases = [\n        (1000.0, 0.8, 0.2, 0.2, 0.5, 0.5), # Case 1\n        (100.0, 0.5, 0.0, 0.0, 1.0, 2.0), # Case 2\n        (50.0, 0.0, 0.3, -0.1, -1.0, 1.0), # Case 3\n        (10.0, 1.5, 0.0, 0.0, 0.0, 1.0), # Case 4\n        (20.0, 3.0, 1.0, 1.5, 2.0, 1.0), # Case 5\n    ]\n\n    results = []\n    for case in test_cases:\n        M, t, e_u, e_l, a_u, a_l = case\n\n        # The picture-change error Delta is derived from first principles using\n        # the Baker-Campbell-Hausdorff expansion for the transformed property\n        # operator A' = U_dagger * A * U, consistent to second order in 1/M.\n        # The final analytical expression for the error Delta is:\n        # Delta = (a_u - a_l) * t^2 / (4 * M^2)\n        \n        if M == 0:\n            # Avoid division by zero, though not expected in test cases.\n            # Assign infinity if numerator is non-zero, else 0.\n            delta = float('inf') if (a_u - a_l) * t**2 != 0 else 0.0\n        else:\n            delta = (a_u - a_l) * t**2 / (4 * M**2)\n        \n        results.append(delta)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2887184"}, {"introduction": "道格拉斯-克罗尔-赫斯（DKH）方法本质上是一种近似理论，其精度取决于展开的阶数。为了深入理解DKH2近似的准确性及其局限，本练习 [@problem_id:2887177] 设计了一个可精确求解的双原子分子模型。通过在这个模型中直接比较DKH2方法与精确二分量（X2C）方法计算的能量梯度，你可以直观地看到DKH2近似的来源和大小，从而更好地评估其在计算分子力、几何优化等属性时的可靠性。", "problem": "一个极简的、可精确求解的模型可以分离出单电子、重元素双原子分子在原子单位下，Douglas-Kroll-Hess (DKH) 和精确两分量 (X2C) 框架中的解耦和图像变换内容。考虑一个由 2x2 类狄拉克哈密顿量 $H(R)$ 描述的、具有对称匹配的单电子态，该哈密顿量依赖于核间距 $R$（以玻尔为单位）：\n$$\nH(R) \\;=\\; \\begin{pmatrix}\nV(R) + m c^2  T(R) \\\\\nT(R)  V(R) - m c^2\n\\end{pmatrix},\n$$\n其中，$m$ 是电子质量，$c$ 是光速，$V(R)$ 是一个模拟双中心电子-原子核吸引的标量势，$T(R)$ 是一个随 $R$ 衰减的有效非对角大-小分量耦合。使用原子单位制，其中 $m = 1$，并定义：\n- $V(R) = -\\dfrac{Z}{R}$，其中 $Z$ 是有效核电荷（无量纲），\n- $T(R) = \\tau_0 \\exp(-\\alpha R)$，其中 $\\tau_0 > 0$ 且 $\\alpha > 0$（二者均为原子单位）。\n\n在此模型中，精确两分量 (X2C) 解耦对应于通过对角化 $H(R)$ 得到的精确正能量本征值分支 $E_+(R)$。二阶 Douglas-Kroll-Hess (DKH2) 近似对应于将单电子幺正解耦在 $1/c^2$ 阶截断，在此模型中这相当于对正能量本征值进行 $1/c$ 的二阶展开。在 Hellmann-Feynman 意义下（忽略轨道弛豫，这与单能级模型一致），Born-Oppenheimer 电子梯度由 $g(R) = \\mathrm{d}E/\\mathrm{d}R$ 给出。\n\n您的任务是：\n- 从第一性原理出发，基于哈密顿量 $H(R)$ 和上述定义，推导出所述阶数的 X2C 梯度 $g_{\\mathrm{X2C}}(R)$ 和 DKH2 梯度 $g_{\\mathrm{DKH2}}(R)$。推导过程必须只假设 $H(R)$ 的狄拉克形式、$V(R)$ 和 $T(R)$ 的定义、X2C 分支的精确对角化以及 DKH2 分支的 $1/c$ 级数展开。使用链式法则和 Hellmann-Feynman 定理来获得 $g(R) = \\mathrm{d}E/\\mathrm{d}R$。\n- 用代码实现这两种梯度，并针对下面的测试集计算差值 $\\Delta g(R) = g_{\\mathrm{DKH2}}(R) - g_{\\mathrm{X2C}}(R)$（单位为哈特里/玻尔）。将任何观察到的非零 $\\Delta g(R)$ 归因于 DKH2 相对于 X2C 固有的特定算符变换近似，并验证其极限行为。\n\n使用以下参数集 $(Z,\\tau_0,\\alpha,R,c)$ 组成的测试集：\n- 情况 A（重元素，近平衡态）：$(Z,\\tau_0,\\alpha,R,c)=\\left(80,600,1.2,2.5,137.035999084\\right)$。\n- 情况 B（更重的元素和更短的键，更强的耦合）：$(Z,\\tau_0,\\alpha,R,c)=\\left(92,800,1.5,1.5,137.035999084\\right)$。\n- 情况 C（长键，弱耦合）：$(Z,\\tau_0,\\alpha,R,c)=\\left(70,400,1.0,5.0,137.035999084\\right)$。\n- 情况 D（非相对论极限，与情况 A 相同但 $c$ 值非常大）：$(Z,\\tau_0,\\alpha,R,c)=\\left(80,600,1.2,2.5,10^6\\right)$。\n- 情况 E（无大-小分量耦合）：$(Z,\\tau_0,\\alpha,R,c)=\\left(80,0,1.2,2.5,137.035999084\\right)$。\n\n所有梯度和差值必须以原子单位表示，即哈特里/玻尔。您的程序应生成单行输出，其中包含情况 A 到 E 的五个数值结果 $\\Delta g(R)$，形式为用方括号括起来的逗号分隔列表（例如，“[x1,x2,x3,x4,x5]”）。", "solution": "所给出的问题陈述是相对论量子化学中一个提法恰当且具有科学依据的练习，尽管它使用了一个简化的单电子、双态模型。所有定义、参数和目标都已明确说明，从而可以得出一个严谨且唯一的解。因此，该问题被认为是有效的。我们着手进行推导和计算。\n\n单电子、双态模型的哈密顿量为：\n$$\nH(R) = \\begin{pmatrix}\nV(R) + m c^2  T(R) \\\\\nT(R)  V(R) - m c^2\n\\end{pmatrix}\n$$\n在原子单位制中，电子质量 $m=1$。因此，哈密顿矩阵为：\n$$\nH(R) = \\begin{pmatrix}\nV(R) + c^2  T(R) \\\\\nT(R)  V(R) - c^2\n\\end{pmatrix}\n$$\n该矩阵的本征值 $\\lambda$ 可通过求解特征方程 $\\det(H(R) - \\lambda I) = 0$ 得到：\n$$\n(V(R) + c^2 - \\lambda)(V(R) - c^2 - \\lambda) - T(R)^2 = 0\n$$\n$$\n(V(R) - \\lambda)^2 - c^4 - T(R)^2 = 0\n$$\n$$\n(V(R) - \\lambda)^2 = c^4 + T(R)^2\n$$\n这会产生两个本征值分支：\n$$\n\\lambda_{\\pm}(R) = V(R) \\pm \\sqrt{c^4 + T(R)^2}\n$$\n问题明确将精确两分量 (X2C) 能量定义为“精确正能量本征值分支 $E_+(R)$”。鉴于 $c$ 很大，$\\sqrt{c^4 + T(R)^2}$ 是一个大的正数。标量势 $V(R) = -Z/R$ 是负的，但其量级通常远小于 $c^2$。因此，正能量本征值明确为 $\\lambda_+(R)$。\n$$\nE_{\\mathrm{X2C}}(R) = \\lambda_+(R) = V(R) + \\sqrt{c^4 + T(R)^2}\n$$\n电子梯度是能量对核间距 $R$ 的导数，$g(R) = \\mathrm{d}E/\\mathrm{d}R$。问题陈述允许使用 Hellmann-Feynman 定理，但对于此模型，直接对代数本征值表达式求导是等效且更直接的方法。我们通过对 $E_{\\mathrm{X2C}}(R)$ 求导来找到 X2C 梯度 $g_{\\mathrm{X2C}}(R)$：\n$$\ng_{\\mathrm{X2C}}(R) = \\frac{\\mathrm{d}E_{\\mathrm{X2C}}}{\\mathrm{d}R} = \\frac{\\mathrm{d}V}{\\mathrm{d}R} + \\frac{\\mathrm{d}}{\\mathrm{d}R}\\left(c^4 + T(R)^2\\right)^{1/2}\n$$\n使用链式法则，可得：\n$$\ng_{\\mathrm{X2C}}(R) = \\frac{\\mathrm{d}V}{\\mathrm{d}R} + \\frac{1}{2}\\left(c^4 + T(R)^2\\right)^{-1/2} \\cdot \\left(2T(R)\\frac{\\mathrm{d}T}{\\mathrm{d}R}\\right) = \\frac{\\mathrm{d}V}{\\mathrm{d}R} + \\frac{T(R)\\frac{\\mathrm{d}T}{\\mathrm{d}R}}{\\sqrt{c^4 + T(R)^2}}\n$$\n我们计算给定势函数和耦合函数的导数：\n$$\nV(R) = -\\frac{Z}{R} \\implies \\frac{\\mathrm{d}V}{\\mathrm{d}R} = \\frac{Z}{R^2}\n$$\n$$\nT(R) = \\tau_0 \\exp(-\\alpha R) \\implies \\frac{\\mathrm{d}T}{\\mathrm{d}R} = -\\alpha \\tau_0 \\exp(-\\alpha R) = -\\alpha T(R)\n$$\n将这些代入 $g_{\\mathrm{X2C}}(R)$ 的表达式中：\n$$\ng_{\\mathrm{X2C}}(R) = \\frac{Z}{R^2} - \\frac{\\alpha T(R)^2}{\\sqrt{c^4 + T(R)^2}}\n$$\n这是该模型中指定能量分支的精确梯度。\n\n接下来，我们推导二阶 Douglas-Kroll-Hess (DKH2) 能量和梯度。问题指出，这对应于对同一正能量本征值 $E_{\\mathrm{X2C}}(R)$ 进行 $1/c$ 的二阶展开。我们对大 $c$ 展开 $E_{\\mathrm{X2C}}(R)$：\n$$\nE_{\\mathrm{X2C}}(R) = V(R) + c^2\\left(1 + \\frac{T(R)^2}{c^4}\\right)^{1/2}\n$$\n使用二项式展开 $(1+x)^{1/2} \\approx 1 + \\frac{1}{2}x - \\frac{1}{8}x^2 + \\dots$，其中 $x = T(R)^2/c^4$：\n$$\nE_{\\mathrm{X2C}}(R) = V(R) + c^2\\left(1 + \\frac{1}{2}\\frac{T(R)^2}{c^4} - \\frac{1}{8}\\frac{T(R)^4}{c^8} + O(c^{-12})\\right)\n$$\n$$\nE_{\\mathrm{X2C}}(R) = V(R) + c^2 + \\frac{T(R)^2}{2c^2} - \\frac{T(R)^4}{8c^6} + \\dots\n$$\nDKH 形式主义构建了一个有效的电子哈密顿量，因此去除了发散的静止质量项 $c^2$。将展开式在 $1/c^2$ 阶截断，得到 DKH2 能量：\n$$\nE_{\\mathrm{DKH2}}(R) = V(R) + \\frac{T(R)^2}{2c^2}\n$$\n我们通过对此表达式求导来找到 DKH2 梯度 $g_{\\mathrm{DKH2}}(R)$：\n$$\ng_{\\mathrm{DKH2}}(R) = \\frac{\\mathrm{d}E_{\\mathrm{DKH2}}}{\\mathrm{d}R} = \\frac{\\mathrm{d}V}{\\mathrm{d}R} + \\frac{1}{2c^2}\\frac{\\mathrm{d}}{\\mathrm{d}R}(T(R)^2) = \\frac{\\mathrm{d}V}{\\mathrm{d}R} + \\frac{T(R)\\frac{\\mathrm{d}T}{\\mathrm{d}R}}{c^2}\n$$\n代入导数 $\\mathrm{d}V/\\mathrm{d}R$ 和 $\\mathrm{d}T/\\mathrm{d}R$：\n$$\ng_{\\mathrm{DKH2}}(R) = \\frac{Z}{R^2} - \\frac{\\alpha T(R)^2}{c^2}\n$$\n任务是计算差值 $\\Delta g(R) = g_{\\mathrm{DKH2}}(R) - g_{\\mathrm{X2C}}(R)$：\n$$\n\\Delta g(R) = \\left(\\frac{Z}{R^2} - \\frac{\\alpha T(R)^2}{c^2}\\right) - \\left(\\frac{Z}{R^2} - \\frac{\\alpha T(R)^2}{\\sqrt{c^4 + T(R)^2}}\\right)\n$$\n$$\n\\Delta g(R) = \\alpha T(R)^2 \\left(\\frac{1}{\\sqrt{c^4 + T(R)^2}} - \\frac{1}{c^2}\\right)\n$$\n为获得更好的数值稳定性和更深的理解，此表达式可重写为：\n$$\n\\Delta g(R) = \\frac{\\alpha T(R)^2}{c^2} \\left(\\frac{1}{\\sqrt{1 + T(R)^2/c^4}} - 1\\right)\n$$\n这是梯度差值的最终表达式。$\\Delta g(R)$ 的非零值源于 DKH2 方法的基本近似：它是精确解耦变换的截断级数展开。虽然 X2C 在该模型中是精确的，但 DKH2 忽略了有效单电子哈密顿量中 $1/c^4$ 及更高阶的项。能量误差的量级为 $T(R)^4/c^6$，其对 $R$ 的导数给出了梯度误差中的主导项，$\\Delta g(R) \\approx -\\alpha T(R)^4 / (2c^6)$，这与我们推导的公式一致。\n\n极限情况的分析证实了该推导的有效性：\n- 对于 $c \\to \\infty$（情况 D），项 $T(R)^2/c^4 \\to 0$，导致括号中的项趋近于 0。因此 $\\Delta g(R) \\to 0$，这正确地表明 DKH2 在非相对论极限下变得精确。\n- 对于 $\\tau_0 \\to 0$（情况 E），$T(R) \\to 0$，这直接导致 $\\Delta g(R) = 0$。在没有大-小分量耦合的情况下，由 $T(R)$ 建模的相对论校正消失，两种方法都得到相同的（非相对论）梯度。\n\n我们现在实现 $\\Delta g(R)$ 的最终公式，以计算给定测试集的结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the difference between DKH2 and X2C electronic gradients for a\n    simplified two-state Dirac-like model.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (Z, tau0, alpha, R, c)\n    test_cases = [\n        # Case A (heavy-element, near-equilibrium)\n        (80.0, 600.0, 1.2, 2.5, 137.035999084),\n        # Case B (heavier and shorter bond, stronger coupling)\n        (92.0, 800.0, 1.5, 1.5, 137.035999084),\n        # Case C (long bond, weak coupling)\n        (70.0, 400.0, 1.0, 5.0, 137.035999084),\n        # Case D (nonrelativistic limit, same as Case A but very large c)\n        (80.0, 600.0, 1.2, 2.5, 1.0e6),\n        # Case E (no large-small coupling)\n        (80.0, 0.0, 1.2, 2.5, 137.035999084),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        _Z, tau0, alpha, R, c = case\n        \n        # Handle the trivial case of τ₀ = 0, where T(R) is always 0.\n        if tau0 == 0.0:\n            delta_g = 0.0\n            results.append(delta_g)\n            continue\n        \n        # Calculate the coupling term T(R)\n        # T(R) = τ₀ * exp(-α * R)\n        T_R = tau0 * np.exp(-alpha * R)\n\n        # The derived formula for the gradient difference is:\n        # Δg(R) = α * T(R)² * ( 1/√(c⁴ + T(R)²) - 1/c² )\n        # A numerically more stable form is used for implementation:\n        # Δg(R) = (α * T(R)² / c²) * ( 1/√(1 + T(R)²/c⁴) - 1 )\n\n        c2 = c * c\n        \n        # Pre-compute factors for clarity\n        T2 = T_R * T_R\n        \n        # The first part of the expression\n        factor1 = alpha * T2 / c2\n        \n        # The second part of the expression in parentheses\n        # This part is sensitive to precision issues if T²  c⁴\n        x = T2 / (c2 * c2) # x = T(R)²/c⁴\n        \n        # (1 + x)^(-1/2) - 1 is computed. \n        # For small x, this is approx -x/2. Direct computation is fine with double precision.\n        factor2 = (1.0 / np.sqrt(1.0 + x)) - 1.0\n        \n        delta_g = factor1 * factor2\n        results.append(delta_g)\n\n    # Final print statement in the exact required format.\n    # Example format: [x1,x2,x3,x4,x5]\n    # Standard string conversion of floats is sufficient.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2887177"}]}