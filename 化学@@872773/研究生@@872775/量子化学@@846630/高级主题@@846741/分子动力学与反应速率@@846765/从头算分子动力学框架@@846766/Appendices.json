{"hands_on_practices": [{"introduction": "任何分子动力学模拟都始于一个基本决策：选择积分时间步长。通过计算水分子中最快振动模式的周期，您将确定为保证数值稳定性和准确性所允许的最大时间步长。这项练习 [@problem_id:2452055] 突显了在计算成本与忠实再现分子运动之间的关键权衡，这是设计高效可靠的从头算分子动力学模拟的基石。", "problem": "我们将使用速度-Verlet积分器，在Born–Oppenheimer框架下，对$300\\,\\mathrm{K}$的液态水进行一次第一性原理分子动力学（AIMD）模拟，其中不施加完整约束（例如，所有的$\\mathrm{O\\!-\\!H}$键伸缩都是自由的）。系统中最高的振动波数是$\\mathrm{O\\!-\\!H}$伸缩振动，其值为$\\tilde{\\nu} = 3600\\,\\mathrm{cm^{-1}}$。真空中的光速为$c = 2.998\\times 10^{10}\\,\\mathrm{cm\\,s^{-1}}$。为控制离散化误差和能量漂移，您采用的要求是：对于最快的振动模式，每个周期至少使用$20$个时间步长。您的计算预算最多允许$2.0\\times 10^{5}$个AIMD时间步长（每步都涉及一次自洽电子结构计算及相关的力评估）。考虑候选的时间步长$\\Delta t \\in \\{2.0\\,\\mathrm{fs},\\,1.0\\,\\mathrm{fs},\\,0.5\\,\\mathrm{fs},\\,0.25\\,\\mathrm{fs}\\}$。\n\n下列陈述中哪些是正确的？\n\nA. $\\Delta t = 2.0\\,\\mathrm{fs}$ 满足每个周期$20$步的要求，因为$\\mathrm{O\\!-\\!H}$振动周期约为$0.5\\,\\mathrm{fs}$。\n\nB. $\\Delta t = 1.0\\,\\mathrm{fs}$ 满足每个周期$20$步的要求，因为$\\mathrm{O\\!-\\!H}$振动周期约为$9\\,\\mathrm{fs}$，这大约是每个周期$9$步。\n\nC. $\\Delta t = 0.5\\,\\mathrm{fs}$ 不满足对最快模式每个周期$20$步的要求。\n\nD. $\\Delta t = 0.25\\,\\mathrm{fs}$ 满足要求，并且在预算下，可以得到$50\\,\\mathrm{ps}$的模拟物理总时间。\n\nE. 在给定的候选项中，$\\Delta t = 0.25\\,\\mathrm{fs}$ 在遵守每个周期$20$步要求的同时，最大化了模拟总时间；选择更小的$\\Delta t$将在固定预算下减少采样，而不会改善对所述要求的遵守情况。", "solution": "对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- 模拟类型：液态水的第一性原理分子动力学（AIMD）。\n- 温度：$T = 300\\,\\mathrm{K}$。\n- 积分器：速度-Verlet。\n- 框架：Born–Oppenheimer，无完整约束。\n- 最高振动波数：$\\tilde{\\nu} = 3600\\,\\mathrm{cm^{-1}}$（对应于O-H伸缩振动）。\n- 真空中的光速：$c = 2.998\\times 10^{10}\\,\\mathrm{cm\\,s^{-1}}$。\n- 离散化要求：最快振动模式的每个周期至少$20$个时间步长。\n- 计算预算：最多$2.0\\times 10^{5}$个AIMD时间步长。\n- 候选时间步长：$\\Delta t \\in \\{2.0\\,\\mathrm{fs},\\,1.0\\,\\mathrm{fs},\\,0.5\\,\\mathrm{fs},\\,0.25\\,\\mathrm{fs}\\}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，因为它描述了计算化学模拟（水的AIMD）的标准设置。提供的O-H伸缩振动波数和光速值在事实上是正确的。该问题是适定的；它提供了计算时间步长约束和评估给定选项所需的所有信息。语言客观而精确。问题是自洽的，没有矛盾。\n\n### 步骤 3：结论与行动\n问题陈述有效。我将继续进行推导和评估。\n\n### 推导\n分子动力学数值积分方案（例如速度-Verlet算法）的稳定性和准确性由时间步长$\\Delta t$决定。时间步长必须足够小，以精确采样系统中最快的运动。问题给出这个最快的运动是$\\mathrm{O\\!-\\!H}$键振动，其波数为$\\tilde{\\nu} = 3600\\,\\mathrm{cm^{-1}}$。\n\n首先，我们必须计算此振动的周期$T_{OH}$。频率$\\nu$通过光速$c$与波数$\\tilde{\\nu}$相关：\n$$ \\nu = c \\tilde{\\nu} $$\n周期$T$是频率的倒数：\n$$ T_{OH} = \\frac{1}{\\nu} = \\frac{1}{c \\tilde{\\nu}} $$\n代入给定值：\n$$ T_{OH} = \\frac{1}{(2.998\\times 10^{10}\\,\\mathrm{cm\\,s^{-1}}) \\times (3600\\,\\mathrm{cm^{-1}})} = \\frac{1}{1.07928 \\times 10^{14}\\,\\mathrm{s^{-1}}} \\approx 9.2654 \\times 10^{-15}\\,\\mathrm{s} $$\n由于$1\\,\\mathrm{fs} = 10^{-15}\\,\\mathrm{s}$，周期为：\n$$ T_{OH} \\approx 9.2654\\,\\mathrm{fs} $$\n\n问题陈述要求每个周期至少$20$个时间步长。设$N_{steps}$为每个周期的步数。条件是：\n$$ N_{steps} = \\frac{T_{OH}}{\\Delta t} \\ge 20 $$\n这对可接受的时间步长施加了一个上限$\\Delta t_{max}$：\n$$ \\Delta t \\le \\frac{T_{OH}}{20} $$\n使用我们计算出的周期：\n$$ \\Delta t_{max} \\approx \\frac{9.2654\\,\\mathrm{fs}}{20} \\approx 0.4633\\,\\mathrm{fs} $$\n任何选择的时间步长$\\Delta t$都必须小于或等于此值。我们现在根据此标准评估给定的选项。\n\n### 逐项分析\n\n**A. $\\Delta t = 2.0\\,\\mathrm{fs}$ 满足每个周期$20$步的要求，因为$\\mathrm{O\\!-\\!H}$振动周期约为$0.5\\,\\mathrm{fs}$。**\n关于$\\mathrm{O\\!-\\!H}$振动周期约为$0.5\\,\\mathrm{fs}$的说法是完全错误的。我们的计算表明周期是$T_{OH} \\approx 9.27\\,\\mathrm{fs}$。$0.5\\,\\mathrm{fs}$的周期对应于大约$66700\\,\\mathrm{cm^{-1}}$的波数，这属于X射线范围，与分子振动无关。此外，当$\\Delta t = 2.0\\,\\mathrm{fs}$时，每个周期的步数将是$T_{OH} / \\Delta t \\approx 9.27 / 2.0 \\approx 4.6$，远低于要求的$20$步。\n结论：**错误**。\n\n**B. $\\Delta t = 1.0\\,\\mathrm{fs}$ 满足每个周期$20$步的要求，因为$\\mathrm{O\\!-\\!H}$振动周期约为$9\\,\\mathrm{fs}$，这大约是每个周期$9$步。**\n将周期近似为$9\\,\\mathrm{fs}$是合理的。使用这个近似值，当$\\Delta t = 1.0\\,\\mathrm{fs}$时，每个周期的步数确实是$9\\,\\mathrm{fs} / 1.0\\,\\mathrm{fs} = 9$。然而，该陈述接着声称这满足了每个周期至少$20$步的要求。由于$9  20$，这个要求显然没有被满足。该陈述包含逻辑矛盾。\n结论：**错误**。\n\n**C. $\\Delta t = 0.5\\,\\mathrm{fs}$ 不满足对最快模式每个周期$20$步的要求。**\n我们必须检查$\\Delta t = 0.5\\,\\mathrm{fs}$是否小于或等于我们计算出的最大值$\\Delta t_{max} \\approx 0.4633\\,\\mathrm{fs}$。由于$0.5\\,\\mathrm{fs} > 0.4633\\,\\mathrm{fs}$，这个时间步长太大了，违反了要求。每个周期的步数将是$T_{OH} / \\Delta t \\approx 9.27 / 0.5 \\approx 18.5$，小于$20$。因此，该陈述在事实上是正确的。\n结论：**正确**。\n\n**D. $\\Delta t = 0.25\\,\\mathrm{fs}$ 满足要求，并且在预算下，可以得到$50\\,\\mathrm{ps}$的模拟物理总时间。**\n首先，我们检查$\\Delta t = 0.25\\,\\mathrm{fs}$是否满足要求。由于$0.25\\,\\mathrm{fs}  \\Delta t_{max} \\approx 0.4633\\,\\mathrm{fs}$，该要求被满足。其次，我们使用$2.0 \\times 10^{5}$步的最大预算来计算模拟总时间：\n$$ t_{total} = (\\text{number of steps}) \\times \\Delta t = (2.0 \\times 10^{5}) \\times (0.25\\,\\mathrm{fs}) = 5.0 \\times 10^{4}\\,\\mathrm{fs} $$\n将其转换为皮秒（$1\\,\\mathrm{ps} = 1000\\,\\mathrm{fs}$）：\n$$ t_{total} = 5.0 \\times 10^{4}\\,\\mathrm{fs} \\times \\frac{1\\,\\mathrm{ps}}{1000\\,\\mathrm{fs}} = 50\\,\\mathrm{ps} $$\n该陈述的两个部分都是正确的。\n结论：**正确**。\n\n**E. 在给定的候选项中，$\\Delta t = 0.25\\,\\mathrm{fs}$ 在遵守每个周期$20$步要求的同时，最大化了模拟总时间；选择更小的$\\Delta t$将在固定预算下减少采样，而不会改善对所述要求的遵守情况。**\n我们将此陈述分为两部分进行分析。\n首先，我们确定候选时间步长$\\{2.0\\,\\mathrm{fs},\\,1.0\\,\\mathrm{fs},\\,0.5\\,\\mathrm{fs},\\,0.25\\,\\mathrm{fs}\\}$中哪些遵守了$\\Delta t \\le 0.4633\\,\\mathrm{fs}$的要求。只有$\\Delta t = 0.25\\,\\mathrm{fs}$是有效的。由于它是唯一有效的选项，因此它理所当然地是在有效候选项中最大化模拟总时间的那个。对于固定的步数，模拟总时间与$\\Delta t$成正比，因此总是倾向于选择最大的有效$\\Delta t$来最大化采样。\n其次，该陈述讨论了选择一个更小的$\\Delta t$（不在列表中的）的后果。一个更小的$\\Delta t$（例如，$0.1\\,\\mathrm{fs}$）仍然会合规。然而，对于$2.0 \\times 10^{5}$步的固定预算，模拟总时间会减少，导致对系统相空间的采样减少。“而不会改善遵守情况”这个说法也是正确的；对“至少$20$步”条件的遵守是一种二元状态（是/否）。一旦条件满足（例如，使用$\\Delta t = 0.25\\,\\mathrm{fs}$），使时间步长更小并不会将遵守状态从“是”变为“更是”。这个推理是合理的，并反映了模拟设计的一个关键原则：选择一个“恰到好处”的时间步长——足够小以保证稳定性和准确性，但又足够大以最大化计算效率和采样。\n结论：**正确**。", "answer": "$$\\boxed{CDE}$$", "id": "2452055"}, {"introduction": "在运行模拟之后，下一步是从生成的轨迹中提取物理可观测量。这个动手编程练习将指导您完成从模拟的时间序列数据中计算振动光谱（红外和拉曼）以及电子-声子耦合常数的过程。通过实现基于维纳-辛钦定理的傅里叶分析 [@problem_id:2872074]，您将学会如何将从头算分子动力学模拟中的原始原子运动转化为可与实验进行比较的光谱数据和关键的理论量。", "problem": "您将实现一个程序，该程序给定代表从头算分子动力学（Ab Initio Molecular Dynamics, AIMD）输出的合成一维简正模轨迹，计算基于线性响应理论和涨落-耗散关系的振动光谱和电子-声子耦合度量，这些理论和关系在量子化学中是基础性的。目标概念是红外（IR）和拉曼（Raman）活性，以及在质量加权坐标中的模式分辨电子-声子耦合。您的实现必须基于第一性原理，使用广泛接受的事实：时间相关函数与谱密度之间的傅里叶变换关系，以及关于质量加权简正坐标的导数定义。\n\n从以下基本基础开始：\n- 线性响应：响应谱与某个随时间变化的观测量对应的平衡相关函数的傅里叶变换有关。例如，红外（IR）吸收的经典表达式涉及偶极矩，而拉曼强度涉及极化率张量。\n- Wiener–Khinchin 定理：功率谱密度是平稳过程自相关函数的傅里叶变换。\n- Born–Oppenheimer 分离：一个简正模坐标的电子-声子耦合常数是电子能级能量相对于质量加权简正坐标的导数。\n- 离散傅里叶变换和加窗：实际的数值估计使用带有时间步长的离散采样和窗函数来减轻频谱泄漏。\n\n精确地说，假设一个单一谐振简正模，其坐标为 $x(t) = A \\cos(2\\pi \\nu t)$，其中 $t$ 是以秒为单位的时间，$A$ 是以埃为单位的小振幅，$\\nu$ 是以赫兹为单位的频率，通过 $\\nu = c\\,\\tilde{\\nu}$ 与以逆厘米为单位的波数 $\\tilde{\\nu}$ 相关，其中 $c$ 是光速。速度是 $v(t) = \\frac{dx}{dt}$。标量偶极矩是 $\\mu(t) = q\\, x(t)$，其中 $q$ 是任意单位的标量有效偶极系数，各向同性极化率是 $\\alpha(t) = \\alpha_{1}\\, x(t)$，其中 $\\alpha_{1}$ 是任意单位的标量导数。电子能级能量随位移线性变化，$E_{\\mathrm{el}}(x) = E_{0} + k\\, x$，其中 $k$ 是以电子伏特每埃为单位的斜率。质量加权简正坐标是 $Q = \\sqrt{m}\\, x$，其中 $m$ 以原子质量单位为单位，$x$ 以埃为单位。沿此模式的电子-声子耦合常数定义为 $g_{Q} = \\frac{dE_{\\mathrm{el}}}{dQ}$。\n\n基于这些基础，实现以下数值程序：\n- 使用 $N$ 个样本和以飞秒为单位的均匀时间步长 $\\Delta t$ 来构建 $x(t_{n})$、$v(t_{n})$、$\\mu(t_{n})$ 和 $\\alpha(t_{n})$ 的离散时间序列，其中 $t_{n} = n\\,\\Delta t$ 转换为秒，$\\nu = c\\,\\tilde{\\nu}$，其中 $c$ 以厘米每秒为单位，$\\tilde{\\nu}$ 以逆厘米为单位。使用 $c = 2.99792458\\times 10^{10}$ 厘米每秒。\n- 对每个时间序列使用 Hann 窗以减轻频谱泄漏。计算每个观测量的单边离散傅里叶变换幅值谱。\n- 使用离散傅里叶变换返回的以赫兹为单位的频率轴，通过除以 $c$ 将其转换为以逆厘米为单位的波数，即 $\\tilde{\\nu} = \\nu / c$。\n- 定义三个谱估计量：\n  - 振动谱估计量 $S_{\\mathrm{vib}}(\\tilde{\\nu})$，作为 $v(t)$ 的功率谱密度。\n  - 红外（IR）强度估计量 $I_{\\mathrm{IR}}(\\tilde{\\nu})$，作为 $(2\\pi \\nu)^{2}$ 乘以 $\\mu(t)$ 的功率谱密度，其中 $\\nu$ 以赫兹为单位。该因子捕捉了在经典极限下，IR 吸收与偶极矩时间导数的平方成正比。\n  - 拉曼强度估计量 $I_{\\mathrm{R}}(\\tilde{\\nu})$，作为 $\\alpha(t)$ 的功率谱密度。\n- 对于这三个估计量中的每一个，通过定位严格正频率箱的最大值来找到主峰波数。如果严格正频率箱的光谱恒等于零，则该峰返回 $0.0$。\n- 通过质量加权导数计算电子-声子耦合常数 $g_{Q} = \\frac{dE_{\\mathrm{el}}}{dQ} = \\frac{k}{\\sqrt{m}}$，其中 $k$ 以电子伏特每埃为单位，$m$ 以原子质量单位为单位，得到的单位是电子伏特每埃每平方根原子质量单位。\n\n单位和数值输出要求：\n- 使用 $c = 2.99792458\\times 10^{10}$ 厘米每秒。\n- 对所有情况使用 $\\Delta t = 0.5$ 飞秒和 $N = 65536$ 个样本。\n- 所有报告的波数均以逆厘米表示，四舍五入到一位小数。\n- $g_{Q}$ 以电子伏特每埃每平方根原子质量单位表示，四舍五入到六位小数。\n\n测试套件：\n为以下三个参数集计算四个请求的输出。每个参数集是一个元组 $(m, \\tilde{\\nu}, A, q, \\alpha_{1}, k)$，其中 $m$ 以原子质量单位为单位，$\\tilde{\\nu}$ 以逆厘米为单位，$A$ 以埃为单位，$q$ 无量纲（任意），$\\alpha_{1}$ 无量纲（任意），$k$ 以电子伏特每埃为单位。\n\n- 案例 $1$ (典型的红外和拉曼活性，非零耦合): $(12.0, 1600.0, 0.02, 1.0, 2.0, 0.5)$。\n- 案例 $2$ (红外非活性，拉曼活性，零耦合): $(1.0, 3000.0, 0.01, 0.0, 1.5, 0.0)$。\n- 案例 $3$ (低频模式，拉曼非活性，负耦合): $(32.0, 50.0, 0.03, 0.8, 0.0, -0.2)$。\n\n对于每个案例，您的程序必须生成列表 $[\\tilde{\\nu}_{\\mathrm{vib}}, \\tilde{\\nu}_{\\mathrm{IR}}, \\tilde{\\nu}_{\\mathrm{Raman}}, g_{Q}]$：\n- $\\tilde{\\nu}_{\\mathrm{vib}}$ 是 $S_{\\mathrm{vib}}$ 的主峰，单位为逆厘米，四舍五入到一位小数。\n- $\\tilde{\\nu}_{\\mathrm{IR}}$ 是 $I_{\\mathrm{IR}}$ 的主峰，单位为逆厘米，四舍五入到一位小数（如果严格正频率的强度为零，则返回 $0.0$）。\n- $\\tilde{\\nu}_{\\mathrm{Raman}}$ 是 $I_{\\mathrm{R}}$ 的主峰，单位为逆厘米，四舍五入到一位小数（如果严格正频率的强度为零，则返回 $0.0$）。\n- $g_{Q}$ 是电子-声子耦合常数，单位为电子伏特每埃每平方根原子质量单位，四舍五入到六位小数。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含结果，形式为三个案例结果的逗号分隔列表，每个结果本身是按指定顺序排列的四个浮点数的列表。例如，打印的输出必须如下所示：\n`[[a_1,b_1,c_1,d_1],[a_2,b_2,c_2,d_2],[a_3,b_3,c_3,d_3]]`\n除了所示空格外，不需要额外的空格，也没有附加文本。", "solution": "我们通过结合线性响应理论、Wiener–Khinchin 定理以及质量加权坐标的定义，构建一个有原则的解决方案，该方案特化于模拟从头算分子动力学（Ab Initio Molecular Dynamics, AIMD）输出的一维谐振简正模。谐振位移为 $x(t) = A \\cos(2\\pi \\nu t)$，频率为 $\\nu = c\\,\\tilde{\\nu}$，其中 $\\tilde{\\nu}$ 是以逆厘米为单位的波数，$c$ 是以厘米每秒为单位的光速。速度为 $v(t) = \\frac{dx}{dt} = -A\\,(2\\pi \\nu)\\,\\sin(2\\pi \\nu t)$。偶极矩和极化率分别为 $\\mu(t) = q\\,x(t)$ 和 $\\alpha(t) = \\alpha_{1}\\,x(t)$。电子能量为 $E_{\\mathrm{el}}(x) = E_{0} + k\\,x$。\n\n所需的光谱量推导如下。\n\n- 振动谱估计量。在经典动力学中，振动态密度与速度自相关函数的傅里叶变换成正比。根据 Wiener–Khinchin 定理，速度时间序列 $v(t)$ 的功率谱密度与此变换成正比。因此，计算 $v(t)$ 的离散傅里叶变换并取其幅值的平方，可以得到一个估计量 $S_{\\mathrm{vib}}(\\nu)$，其主峰位于物理振动频率 $\\nu$，等效于波数 $\\tilde{\\nu} = \\nu / c$ 处的峰。\n\n- 红外（IR）强度估计量。在线性响应理论框架内，IR 吸收与偶极-偶极时间相关函数的傅里叶变换成正比。由于吸收探测的是偶极矩的时间导数，一个经典的估计量是 $I_{\\mathrm{IR}}(\\nu) \\propto \\nu^{2}\\,S_{\\mu}(\\nu)$，其中 $S_{\\mu}(\\nu)$ 是 $\\mu(t)$ 的功率谱密度。写作 $(2\\pi \\nu)^{2} \\, |\\mathcal{F}\\{\\mu(t)\\}|^{2}$（其中 $\\mathcal{F}$ 是傅里叶变换）可以确保正确的角频率缩放。$I_{\\mathrm{IR}}(\\nu)$ 中的主峰（转换为 $\\tilde{\\nu}$）提供了红外活性波数。如果 $q = 0$，则 $\\mu(t) \\equiv 0$，光谱的严格正频率部分恒等于零，根据构造，报告的峰值为 $0.0$。\n\n- 拉曼强度估计量。各向同性拉曼活性与极化率自相关的傅里叶变换成正比。在简单模型 $\\alpha(t) = \\alpha_{1} x(t)$ 中，该估计量简化为 $\\alpha(t)$ 的功率谱密度。如果 $\\alpha_{1} = 0$，则严格正频率内容消失，根据相同规则，报告的峰值为 $0.0$。\n\n- 电子-声子耦合。质量加权简正坐标为 $Q = \\sqrt{m}\\,x$，其中 $m$ 以原子质量单位为单位。模式分辨的电子-声子耦合常数为 $g_{Q} = \\frac{dE_{\\mathrm{el}}}{dQ}$。根据链式法则，$g_{Q} = \\frac{dE_{\\mathrm{el}}}{dx} \\cdot \\frac{dx}{dQ} = \\frac{k}{\\sqrt{m}}$，在当前单位下，其单位为电子伏特每埃每平方根原子质量单位。这仅仅依赖于质量加权坐标的定义和 $E_{\\mathrm{el}}(x)$ 的线性依赖关系。\n\n离散实现的算法设计细节：\n\n- 时间离散化。使用 $N$ 个样本和以飞秒为单位的时间步长 $\\Delta t$。为进行频率计算，将其转换为秒，$t_{n} = n\\,\\Delta t \\times 10^{-15}$。以赫兹为单位的频率网格由单边离散傅里叶变换的频率箱给出，$\\nu_{k} = \\frac{k}{N\\,\\Delta t_{\\mathrm{s}}}$，其中 $k$ 从 $0$ 到 $N/2$，$\\Delta t_{\\mathrm{s}}$ 以秒为单位。通过 $\\tilde{\\nu}_{k} = \\nu_{k} / c$ 将其转换为波数，其中 $c = 2.99792458\\times 10^{10}$ 厘米每秒。\n\n- 加窗和谱。为减轻频谱泄漏，在进行离散傅里叶变换之前，将每个离散时间序列乘以一个 Hann 窗 $w_{n} = \\frac{1}{2}\\left(1 - \\cos\\left(\\frac{2\\pi n}{N-1}\\right)\\right)$。通过实数输入快速傅里叶变换计算单边离散傅里叶变换 $\\mathcal{F}\\{s\\}(\\nu_{k})$，并取其幅值的平方以形成功率谱密度估计量 $| \\mathcal{F}\\{s\\}(\\nu_{k}) |^{2}$。对于 IR 估计量，需乘以 $(2\\pi \\nu_{k})^{2}$。\n\n- 寻峰。对于每个估计量，考虑严格正频率箱（$k \\ge 1$）。如果这些箱上估计量的最大值为零（在数值容差内），则相应峰值返回 $0.0$。否则，返回最大值出现的波数，并四舍五入到所需精度。\n\n- 耦合。直接计算 $g_{Q} = \\frac{k}{\\sqrt{m}}$ 并四舍五入到所需精度。\n\n数值设置和预期行为：\n- 当 $\\Delta t = 0.5$ 飞秒且 $N = 65536$ 时，总时间为 $T \\approx 3.2768 \\times 10^{-11}$ 秒，频率分辨率为 $\\Delta \\nu \\approx 3.05176 \\times 10^{10}$ 赫兹。除以 $c$ 得到波数分辨率 $\\Delta \\tilde{\\nu} \\approx 1.0176$ 逆厘米。因此，峰值位置将与真实波数相差约一逆厘米。\n- 案例 1，$\\tilde{\\nu} = 1600.0$ 逆厘米，非零 $q$ 和 $\\alpha_{1}$，以及 $k = 0.5$ 电子伏特每埃，应在所有三个光谱中产生接近 $1600.0$ 逆厘米的峰，且 $g_{Q} \\approx \\frac{0.5}{\\sqrt{12.0}} \\approx 0.144337$ 电子伏特每埃每平方根原子质量单位。\n- 案例 2，$\\tilde{\\nu} = 3000.0$ 逆厘米，$q = 0.0$，非零 $\\alpha_{1}$，以及 $k = 0.0$，将得到一个位于 $0.0$ 逆厘米的 IR 峰（因为严格正频率的 IR 光谱恒等于零），一个接近 $3000.0$ 逆厘米的拉曼峰，以及 $g_{Q} = 0.0$。\n- 案例 3，$\\tilde{\\nu} = 50.0$ 逆厘米，$\\alpha_{1} = 0.0$，以及 $k = -0.2$ 电子伏特每埃，将得到一个接近 $50.0$ 逆厘米的振动峰，一个位于 $0.0$ 逆厘米的拉曼峰，以及 $g_{Q} \\approx \\frac{-0.2}{\\sqrt{32.0}} \\approx -0.035355$ 电子伏特每埃每平方根原子质量单位。\n\n最终程序为每个案例构建时间序列，通过加窗计算相应的光谱，识别以逆厘米为单位的主峰位置，通过质量加权导数计算 $g_{Q}$，四舍五入到所需精度，并打印一个单行列表 $[ [\\tilde{\\nu}_{\\mathrm{vib}}, \\tilde{\\nu}_{\\mathrm{IR}}, \\tilde{\\nu}_{\\mathrm{Raman}}, g_{Q}], \\ldots ]$，汇总测试套件中的所有案例。", "answer": "```python\nimport numpy as np\n\n# Constants\nC_CM_PER_S = 2.99792458e10  # speed of light in cm/s\n\ndef hann_window(N: int) - np.ndarray:\n    \"\"\"Return a Hann window of length N.\"\"\"\n    n = np.arange(N)\n    return 0.5 * (1.0 - np.cos(2.0 * np.pi * n / (N - 1)))\n\ndef rfft_power_spectrum(signal: np.ndarray, dt_s: float) - tuple[np.ndarray, np.ndarray]:\n    \"\"\"\n    Compute one-sided power spectrum |FFT|^2 of a real signal using a Hann window.\n    Returns (freqs_Hz, power).\n    \"\"\"\n    N = signal.size\n    # Subtract mean to avoid spurious DC components\n    sig = signal - np.mean(signal)\n    window = hann_window(N)\n    windowed = sig * window\n    # Real FFT\n    fft_vals = np.fft.rfft(windowed)\n    power = np.abs(fft_vals) ** 2\n    freqs = np.fft.rfftfreq(N, d=dt_s)\n    return freqs, power\n\ndef dominant_peak_wavenumber(freqs_hz: np.ndarray, power: np.ndarray) - float:\n    \"\"\"\n    Find dominant peak wavenumber (cm^-1) for strictly positive frequencies.\n    If all strictly positive frequency power is zero, return 0.0.\n    \"\"\"\n    # Exclude zero frequency bin\n    if freqs_hz.size = 1:\n        return 0.0\n    pos_freqs = freqs_hz[1:]\n    pos_power = power[1:]\n    # Numerical check for nonzero content\n    if not np.any(pos_power  0.0):\n        return 0.0\n    idx_max = np.argmax(pos_power)\n    freq_hz_peak = pos_freqs[idx_max]\n    wnum_peak = freq_hz_peak / C_CM_PER_S\n    return wnum_peak\n\ndef synthesize_time_series(n_samples: int, dt_fs: float, nu_cm1: float, A_ang: float,\n                           q_eff: float, alpha1: float) - dict:\n    \"\"\"\n    Synthesize time series for x(t), v(t), mu(t), alpha(t) for a 1D harmonic mode.\n    \"\"\"\n    t_s = np.arange(n_samples) * dt_fs * 1e-15  # time in seconds\n    freq_hz = C_CM_PER_S * nu_cm1  # Hz\n    phase = 2.0 * np.pi * freq_hz * t_s\n    x = A_ang * np.cos(phase)\n    v = -A_ang * (2.0 * np.pi * freq_hz) * np.sin(phase)  # derivative of x(t)\n    mu = q_eff * x\n    alpha = alpha1 * x  # isotropic scalar polarizability\n    return {\"t_s\": t_s, \"x\": x, \"v\": v, \"mu\": mu, \"alpha\": alpha}\n\ndef compute_observable_peaks(n_samples: int, dt_fs: float, params: tuple) - list[float]:\n    \"\"\"\n    For given parameters (m_amu, nu_cm1, A_ang, q_eff, alpha1, k_eV_per_A),\n    compute:\n      - dominant vibrational wavenumber from velocity power spectrum,\n      - dominant IR wavenumber from (2*pi*f)^2 * dipole power spectrum,\n      - dominant Raman wavenumber from polarizability power spectrum,\n      - electron-phonon coupling g_Q = k / sqrt(m).\n    Returns list [nu_vib_cm1, nu_IR_cm1, nu_Raman_cm1, gQ].\n    \"\"\"\n    m_amu, nu_cm1, A_ang, q_eff, alpha1, k_eV_per_A = params\n    series = synthesize_time_series(n_samples, dt_fs, nu_cm1, A_ang, q_eff, alpha1)\n    dt_s = dt_fs * 1e-15\n\n    # Vibrational spectrum from velocity\n    freqs_v, power_v = rfft_power_spectrum(series[\"v\"], dt_s)\n    vib_peak_cm1 = dominant_peak_wavenumber(freqs_v, power_v)\n\n    # IR intensity: (2*pi*f)^2 * power_spectrum(mu)\n    freqs_mu, power_mu = rfft_power_spectrum(series[\"mu\"], dt_s)\n    omega_factor = (2.0 * np.pi * freqs_mu) ** 2\n    ir_intensity = omega_factor * power_mu\n    ir_peak_cm1 = dominant_peak_wavenumber(freqs_mu, ir_intensity)\n\n    # Raman intensity: power_spectrum(alpha)\n    freqs_a, power_a = rfft_power_spectrum(series[\"alpha\"], dt_s)\n    raman_peak_cm1 = dominant_peak_wavenumber(freqs_a, power_a)\n\n    # Electron-phonon coupling in eV/(A * sqrt(amu))\n    gQ = k_eV_per_A / np.sqrt(m_amu)\n\n    # Rounding as specified\n    vib_peak_cm1 = float(np.round(vib_peak_cm1, 1))\n    ir_peak_cm1 = float(np.round(ir_peak_cm1, 1))\n    raman_peak_cm1 = float(np.round(raman_peak_cm1, 1))\n    gQ = float(np.round(gQ, 6))\n\n    return [vib_peak_cm1, ir_peak_cm1, raman_peak_cm1, gQ]\n\ndef solve():\n    # Global settings\n    dt_fs = 0.5\n    n_samples = 65536\n\n    # Test suite cases: (m_amu, nu_cm1, A_ang, q_eff, alpha1, k_eV_per_A)\n    test_cases = [\n        (12.0, 1600.0, 0.02, 1.0, 2.0, 0.5),\n        (1.0, 3000.0, 0.01, 0.0, 1.5, 0.0),\n        (32.0, 50.0, 0.03, 0.8, 0.0, -0.2),\n    ]\n\n    results = []\n    for case in test_cases:\n        res = compute_observable_peaks(n_samples, dt_fs, case)\n        results.append(res)\n\n    # Exact required format: single line list of lists\n    # We will ensure formatting with default Python list string representation.\n    print(str(results).replace(\" \", \"\"))\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2872074"}, {"introduction": "许多关键的化学过程，例如光化学反应，涉及电子态之间的跃迁，此时玻恩-奥本海默近似失效。这项高级实践通过要求您模拟经典的朗道-齐纳（Landau-Zener）曲线穿越问题，深入探讨了非绝热动力学的核心。通过数值积分含时薛定谔方程并将其结果与解析公式进行比较 [@problem_id:2872065]，您将对非绝热跃迁背后的原理以及诸如“最少切换表面跳跃”（fewest-switches surface hopping）等算法的基础获得具体的理解。", "problem": "考虑一个用于启发从头算分子动力学中最少切换表面跳跃（FSSH）算法的两态非绝热交叉模型。设单个核坐标 $x$ 以恒定速率 $v$ 经典地通过一个交叉区域，其演化过程为 $x(t) = x_{0} + v t$，其中 $t \\in \\mathbb{R}$。在透热基 $\\{ \\lvert 1 \\rangle, \\lvert 2 \\rangle \\}$ 中，取含时电子哈密顿量为\n$$\n\\hat{H}(t) =\n\\begin{pmatrix}\n\\frac{\\Delta(t)}{2}  V \\\\\nV  -\\frac{\\Delta(t)}{2}\n\\end{pmatrix}, \\quad \\Delta(t) = \\kappa\\, v\\, t,\n$$\n其中 $V$ 是一个恒定的透热耦合，$\\kappa$ 是透热能量相对于 $x$ 的斜率的恒定差值，因此有 $d\\Delta/dt = \\kappa v$。全文假设使用原子单位，即 $\\hbar = 1$，能量单位为哈特里（Hartree），时间单位为原子时间单位，距离单位为玻尔（Bohr）。\n\n耦合的含时电子振幅 $c(t) = (c_{1}(t), c_{2}(t))^{\\top}$ 遵循含时薛定谔方程演化\n$$\n\\mathrm{i}\\, \\frac{d}{dt}\\, c(t) = \\hat{H}(t)\\, c(t).\n$$\n通过对角化定义 $\\hat{H}(t)$ 的瞬时绝热本征态 $\\{ \\lvert \\phi_{-}(t) \\rangle, \\lvert \\phi_{+}(t) \\rangle \\}$，其本征值为 $E_{-}(t) \\le E_{+}(t)$。考虑从大的负时间到大的正时间的单次穿越过程，系统在足够早的时刻 $t = -T$ 初始化在较低的绝热态上，其中 $T$ 的选择要使得 $\\lvert \\Delta(-T) \\rvert \\gg \\lvert V \\rvert$ 成立，在 $t=+T$ 时同样如此。为确保具体性和可复现性，设置\n$$\nT \\equiv R_{\\mathrm{end}} \\, \\frac{\\max(V, V_{\\mathrm{floor}})}{\\lvert \\kappa v \\rvert}, \\quad R_{\\mathrm{end}} = 20, \\quad V_{\\mathrm{floor}} = 10^{-4}.\n$$\n\n任务：\n- 仅从含时薛定谔方程、上述绝热/透热定义以及具有恒定速率 $v$ 的单次线性交叉的假设出发，推导绝热态之间单次穿越非绝热跃迁概率的解析表达式（即在初始状态为 $\\lvert \\phi_{-}(-T) \\rangle$ 的条件下，最终处于 $\\lvert \\phi_{+}(+T) \\rangle$ 状态的概率）。你的推导必须从给定的基本定义开始，通过逻辑上完备的步骤将其简化为一个具有线性时间依赖性的可解两能级问题；不要假设任何直接给出目标结果的公式。\n- 设计一个算法，该算法 (i) 在初始条件为 $c(-T) = \\lvert \\phi_{-}(-T) \\rangle$ 的情况下，对两能级系统的含时薛定谔方程进行从 $t=-T$ 到 $t=+T$ 的数值积分，以及 (ii) 计算最终的非绝热跃迁概率 $P_{\\mathrm{num}} = \\lvert \\langle \\phi_{+}(+T) \\vert c(+T) \\rangle \\rvert^{2}$。同时，计算从你的推导中得到的解析预测值 $P_{\\mathrm{LZ}}$。\n- 你的程序必须为每个测试用例输出概率对 $[P_{\\mathrm{num}}, P_{\\mathrm{LZ}}]$。最终的程序输出必须是单行，包含一个用方括号括起来的逗号分隔列表，其中每个元素是双元素列表 $[P_{\\mathrm{num}},P_{\\mathrm{LZ}}]$。输出行中任何地方都不能有空格。每个浮点数必须四舍五入到小数点后六位。\n\n角度单位不适用。所有输出均为 $[0,1]$ 范围内的无量纲概率。\n\n测试套件：\n使用以下四组参数集 $(V,\\kappa,v)$，如上所述以原子单位表示：\n- 情况 A（边界情况，精确的透热交叉）：$(V,\\kappa,v) = (0, 0.05, 0.3)$。\n- 情况 B（快速穿越，弱耦合）：$(V,\\kappa,v) = (0.01, 0.02, 0.5)$。\n- 情况 C（中等穿越速率，强耦合）：$(V,\\kappa,v) = (0.1, 0.02, 0.5)$。\n- 情况 D（慢速穿越，中等耦合）：$(V,\\kappa,v) = (0.02, 0.05, 0.01)$。\n\n你的程序应生成单行输出，包含按 A、B、C、D 顺序排列的指定结果。每个情况的答案必须是双元素列表 $[P_{\\mathrm{num}}, P_{\\mathrm{LZ}}]$，其中每个条目是四舍五入到小数点后六位的浮点数，且整行是这四个列表组成的单个列表，不含空格，例如：`[[P_num_A,P_LZ_A],[P_num_B,P_LZ_B],[P_num_C,P_LZ_C],[P_num_D,P_LZ_D]]`。", "solution": "我们从透热基中电子振幅的含时薛定谔方程开始，\n$$\n\\mathrm{i}\\, \\frac{d}{dt}\n\\begin{pmatrix}\nc_{1}(t)\\\\ c_{2}(t)\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{\\Delta(t)}{2}  V \\\\\nV  -\\frac{\\Delta(t)}{2}\n\\end{pmatrix}\n\\begin{pmatrix}\nc_{1}(t)\\\\ c_{2}(t)\n\\end{pmatrix},\n\\quad \\Delta(t) = \\kappa v t,\n$$\n其中使用原子单位，因此 $\\hbar = 1$。绝热态被定义为哈密顿量的瞬时本征矢量，\n$$\n\\hat{H}(t) \\lvert \\phi_{\\pm}(t) \\rangle = E_{\\pm}(t) \\lvert \\phi_{\\pm}(t) \\rangle,\\quad\nE_{\\pm}(t) = \\pm \\sqrt{ \\left( \\frac{\\Delta(t)}{2} \\right)^{2} + V^{2} }.\n$$\n初始条件为 $c(-T) = \\lvert \\phi_{-}(-T) \\rangle$，当 $\\lvert \\Delta(-T) \\rvert \\gg \\lvert V \\rvert$ 时，这是无歧义的；同样地，当 $\\lvert \\Delta(+T) \\rvert \\gg \\lvert V \\rvert$ 时，$\\lvert \\phi_{+}(+T) \\rangle$ 是良定义的。由于 $x(t)$ 是 $t$ 的线性函数，速率 $v$ 恒定，因此透热能隙 $\\Delta(t)$ 也是 $t$ 的线性函数，其斜率为 $d\\Delta/dt = \\kappa v$。\n\n为了推导单次穿越的非绝热跃迁概率的解析形式，我们将此问题映射到典范的 Landau–Zener 模型。典范的两能级含时哈密顿量为\n$$\n\\hat{H}_{\\mathrm{LZ}}(t) = \n\\begin{pmatrix}\n\\alpha t/2  V \\\\\nV  -\\alpha t/2\n\\end{pmatrix},\n$$\n其中 $\\alpha = d\\Delta/dt$。这与我们的模型完全一致，其中 $\\alpha = \\kappa v$。在渐近极限 $t \\to \\pm \\infty$ 时，绝热态和透热态在相差一个相位因子的意义上是重合的。Landau–Zener 问题有以抛物柱函数表示的精确解，对于从 $t \\to -\\infty$ 时的较低绝热态开始的单次线性穿越，绝热态之间的非绝热跃迁概率由下式给出：\n$$\nP_{\\mathrm{LZ}} = \\exp\\!\\left( - 2 \\pi \\, \\Gamma \\right), \\quad \\Gamma \\equiv \\frac{V^{2}}{\\hbar \\, \\lvert d\\Delta/dt \\rvert}.\n$$\n在原子单位中 $\\hbar = 1$，且 $d\\Delta/dt = \\kappa v$，上式简化为\n$$\nP_{\\mathrm{LZ}} = \\exp\\!\\left( - \\frac{2 \\pi \\, V^{2}}{ \\lvert \\kappa v \\rvert } \\right).\n$$\n这个概率是在绝热态之间发生跃迁的概率（即从 $\\lvert \\phi_{-}(-\\infty) \\rangle$ 开始，最终到达 $\\lvert \\phi_{+}(+\\infty) \\rangle$）。在透热图像中，它是在穿越交叉点时保持在同一透热态上的概率；这种对应关系源于绝热特性在避开交叉点处的交换。其极限行为与物理直觉一致：当 $\\lvert \\kappa v \\rvert \\to \\infty$（突跃）或 $V \\to 0$ 时，$P_{\\mathrm{LZ}} \\to 1$；当 $\\lvert \\kappa v \\rvert \\to 0$（绝热穿越）或 $V \\to \\infty$ 时，$P_{\\mathrm{LZ}} \\to 0$。\n\n用于数值验证的算法设计：\n- 将哈密顿量 $\\hat{H}(t)$ 表示为一个函数，该函数返回一个 $2 \\times 2$ 的复厄米矩阵，其中 $\\Delta(t) = \\kappa v t$。\n- 根据参数确定性地计算 $T$：\n$$\nT = R_{\\mathrm{end}} \\, \\frac{\\max(V, V_{\\mathrm{floor}})}{\\lvert \\kappa v \\rvert}, \\quad R_{\\mathrm{end}} = 20, \\quad V_{\\mathrm{floor}} = 10^{-4}.\n$$\n这确保了当 $V0$ 时，$\\lvert \\Delta(\\pm T) \\rvert / (2 \\lvert V \\rvert) \\gtrsim R_{\\mathrm{end}}/2$，从而使得边界处的非对角混合可以忽略，并且在 $V=0$ 的特殊情况下它保持有限值。\n- 通过对角化 $\\hat{H}(-T)$ 来计算初始绝热态 $\\lvert \\phi_{-}(-T) \\rangle$（使用厄米本征求解器获得本征值 $E_{-}(-T) \\le E_{+}(-T)$ 对应的标准正交本征矢量），并设置 $c(-T) = \\lvert \\phi_{-}(-T) \\rangle$。\n- 使用高精度显式 Runge–Kutta 方法对含时薛定谔方程 $\\mathrm{i}\\, \\dot{c}(t) = \\hat{H}(t) c(t)$ 从 $t=-T$ 到 $t=+T$ 进行积分。在代码中，设置 $c'(t) = -\\mathrm{i}\\, \\hat{H}(t) c(t)$ 并进行演化，选择绝对和相对容差来控制幺正性误差（例如，$\\mathrm{rtol} = 10^{-9}$，$\\mathrm{atol} = 10^{-12}$）。对于这些参数，哈密顿量是光滑的，系统是非刚性的；误差控制可以在数值容差范围内保持概率守恒。\n- 在 $t=+T$ 时，对角化 $\\hat{H}(+T)$ 以获得绝热本征矢量。选择对应于较大本征值 $E_{+}(+T)$ 的较高绝热本征矢量 $\\lvert \\phi_{+}(+T) \\rangle$，并计算\n$$\nP_{\\mathrm{num}} = \\left\\lvert \\langle \\phi_{+}(+T) \\vert c(+T) \\rangle \\right\\rvert^{2}.\n$$\n- 计算解析的 Landau–Zener 预测值\n$$\nP_{\\mathrm{LZ}} = \\exp\\!\\left( - \\frac{2 \\pi \\, V^{2}}{ \\lvert \\kappa v \\rvert } \\right).\n$$\n- 对于每个测试用例 $(V,\\kappa,v)$，返回四舍五入到小数点后六位的概率对 $[P_{\\mathrm{num}}, P_{\\mathrm{LZ}}]$。按指定顺序组合这四对，并以精确的括号格式打印单行，不含空格。\n\n边界情况与覆盖范围：\n- 情况 A 中 $V=0$ 是一个精确的透热交叉。数值积分得出 $P_{\\mathrm{num}} = 1$，因为状态保持在其初始透热分量上，而在 $t=+T$ 时该分量映射到相反的绝热态；解析公式给出 $P_{\\mathrm{LZ}} = \\exp(0) = 1$。\n- 情况 B 测试弱耦合下的快速穿越，得到接近于 $1$ 的 $P_{\\mathrm{LZ}}$；数值积分结果应与之匹配。\n- 情况 C 测试中等速率下的强耦合，产生较小的 $P_{\\mathrm{LZ}}$；数值计算能捕捉到这种小的跃迁概率。\n- 情况 D 测试慢速穿越，同样产生较小的 $P_{\\mathrm{LZ}}$；长的演化区间确保了在边界处的绝热解耦。\n\n该设计将基本原理（含时薛定谔动力学、绝热/透热变换、线性交叉近似）与一个可验证的数值算法和一个基于精确 Landau–Zener 解的解析基准相结合，而 Landau–Zener 解是在线性化轨道下 FSSH 类型框架中计算跳跃概率的标准基础。", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef landau_zener_probability(V, kappa, v):\n    # Atomic units: ħ = 1\n    rate = abs(kappa * v)\n    # Avoid division by zero; if rate == 0, treat as infinitely slow (adiabatic) - P_LZ = exp(-∞) = 0 if V0, or 1 if V=0.\n    if rate == 0.0:\n        return 1.0 if V == 0.0 else 0.0\n    return float(np.exp(-2.0 * np.pi * (V ** 2) / rate))\n\ndef hamiltonian(t, V, kappa, v):\n    Delta = kappa * v * t\n    return np.array([[0.5 * Delta, V],\n                     [V, -0.5 * Delta]], dtype=np.complex128)\n\ndef adiabatic_eigensystem(t, V, kappa, v):\n    H = hamiltonian(t, V, kappa, v)\n    # eigh returns ascending eigenvalues and the corresponding eigenvectors as columns\n    evals, evecs = np.linalg.eigh(H)\n    return evals, evecs\n\ndef propagate_two_level(V, kappa, v, R_end=20.0, V_floor=1e-4):\n    rate = abs(kappa * v)\n    if rate == 0.0:\n        # No time dependence; if V==0, Hamiltonian is identically zero - trivial.\n        # Define T finite to avoid zero interval; choose T=1 for definiteness.\n        T = 1.0\n    else:\n        T = R_end * max(V, V_floor) / rate\n\n    t0 = -T\n    tf = +T\n\n    # Initial state: lower adiabatic eigenvector at t0\n    evals0, evecs0 = adiabatic_eigensystem(t0, V, kappa, v)\n    # Lower is index 0 due to ascending order\n    c0 = evecs0[:, 0].astype(np.complex128)\n\n    def rhs(t, y):\n        H = hamiltonian(t, V, kappa, v)\n        return (-1j) * H.dot(y)\n\n    # Integrate Schrödinger equation\n    sol = solve_ivp(\n        fun=rhs,\n        t_span=(t0, tf),\n        y0=c0,\n        method=\"RK45\",\n        rtol=1e-9,\n        atol=1e-12,\n        dense_output=False,\n        vectorized=False,\n        max_step=np.inf\n    )\n\n    c_tf = sol.y[:, -1]\n\n    # Final adiabatic upper state at tf\n    evals_f, evecs_f = adiabatic_eigensystem(tf, V, kappa, v)\n    # Upper is index 1\n    phi_plus = evecs_f[:, 1]\n\n    # Probability to be on upper adiabatic state\n    P_num = float(abs(np.vdot(phi_plus, c_tf))**2)\n\n    # Analytic Landau-Zener\n    P_LZ = landau_zener_probability(V, kappa, v)\n\n    # Numerical errors may slightly push outside [0,1]\n    P_num = min(max(P_num, 0.0), 1.0)\n    return P_num, P_LZ\n\ndef format_results(results):\n    # Format as [[a,b],[c,d],...] with exactly six decimals and no spaces\n    inner = []\n    for a, b in results:\n        inner.append(f\"[{a:.6f},{b:.6f}]\")\n    return \"[\" + \",\".join(inner) + \"]\"\n\ndef solve():\n    # Test cases: (V, kappa, v) in atomic units\n    test_cases = [\n        (0.0, 0.05, 0.3),   # Case A: exact diabatic crossing\n        (0.01, 0.02, 0.5),  # Case B: fast passage, weak coupling\n        (0.1, 0.02, 0.5),   # Case C: stronger coupling\n        (0.02, 0.05, 0.01), # Case D: slow passage\n    ]\n\n    results = []\n    for V, kappa, v in test_cases:\n        P_num, P_LZ = propagate_two_level(V, kappa, v)\n        results.append((P_num, P_LZ))\n\n    print(format_results(results))\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2872065"}]}