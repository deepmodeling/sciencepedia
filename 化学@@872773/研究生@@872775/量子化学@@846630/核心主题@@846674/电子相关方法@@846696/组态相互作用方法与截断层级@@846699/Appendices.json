{"hands_on_practices": [{"introduction": "构型相互作用 (CI) 方法的核心思想是在一个由斯莱特行列式构成的多电子基组中展开波函数，这些行列式是通过电子从参考态激发而产生的。这个练习将通过推导从一个闭壳层参考态产生单激发和双激发组态的最基本公式，来为我们理解 CI 空间的结构和规模打下坚实的数学基础。掌握这种组合计数是理解 CI 方法计算成本的第一步。[@problem_id:2881652]", "problem": "在组态相互作用（CI）理论中，多电子波函数在一个由单电子自旋轨道基构建的斯莱特行列式基上展开。考虑一个从使用有限自旋轨道基的限制性Hartree-Fock（RHF）计算中获得的闭壳层参考斯莱特行列式。设参考行列式恰好占据 $n_o$ 个自旋轨道，而剩余的 $n_v$ 个自旋轨道是未占据的（虚轨道）。完全在自旋轨道表象下进行推导，并假设没有施加点群对称性或自旋匹配约束；根据反对称性的要求，计算不同斯莱特行列式的数量（相差一个总体符号的行列式视为相同）。\n\n从斯莱特行列式的定义和Pauli不相容原理出发，并仅使用关于不可区分电子和反对称性的组合推理，推导以下数量的闭式表达式（用 $n_o$ 和 $n_v$ 表示）：\n- 通过从一个占据自旋轨道激发恰好1个电子到一个虚自旋轨道而形成的唯一单激发行列式的数量 $N_{\\mathrm{S}}$，以及\n- 通过从占据自旋轨道激发恰好2个电子到虚自旋轨道而形成的唯一双激发行列式的数量 $N_{\\mathrm{D}}$。\n\n以闭式行矩阵 $\\begin{pmatrix}N_{\\mathrm{S}}  N_{\\mathrm{D}}\\end{pmatrix}$ 的形式表示你的最终答案。除了反对称性之外，不要假设任何进一步的对称性，并且不包含任何能量或矩阵元。无需数值计算；仅提供符号表达式。", "solution": "所述问题在科学上是合理的、定义明确的且客观的。它是量子化学中组态相互作用理论框架下的一个基本组合问题。因此，将提供一个解答。\n\n这个问题的基本前提在于斯莱特行列式的性质。对于一个$N$电子体系，一个斯莱特行列式由一组$N$个自旋轨道 $\\{\\chi_{p_1}, \\chi_{p_2}, ..., \\chi_{p_N}\\}$ 构建。由于费米子要求反对称性（这一要求在数学上由行列式结构强制实现），交换任意两个电子（或等价地，行列式的任意两行）会导致波函数变号。行列式结构的一个更直接的推论是Pauli不相容原理：如果集合中的任意两个自旋轨道相同（即，对于 $i \\neq j$ 有 $\\chi_{p_i} = \\chi_{p_j}$），则行列式为零。这意味着每个自旋轨道最多只能被一个电子占据。\n\n关键在于，由于电子是不可区分的粒子，一个斯莱特行列式由其占据的自旋轨道*集合*唯一确定（在相差一个无关紧要的总体相位因子，通常选为一个符号的意义下）。问题正确地指出，我们必须计算不同斯莱特行列式的数量（相差一个总体符号的行列式视为相同）。这将任务简化为一个组合问题，即计算选择不同占据自旋轨道集合的方式数量。\n\n我们给定一个参考态，它是一个由 $n_o$ 个占据自旋轨道构成的单一斯莱特行列式 $\\Phi_0$。总基组由这 $n_o$ 个占据自旋轨道和另外 $n_v$ 个未占据（虚）自旋轨道组成。\n\n首先，我们推导单激发行列式的数量 $N_{\\mathrm{S}}$。一个单激发行列式，记为 $\\Phi_{i}^{a}$，是通过将一个电子从一个占据自旋轨道 $\\chi_i$ 提升到一个虚自旋轨道 $\\chi_a$ 而形成的。这等价于通过从初始占据集合中移除一个自旋轨道并从虚轨道集合中添加一个自旋轨道来创建一个新的占据自旋轨道集合。这个过程可以分解为两个独立的选择：\n\n1.  选择要退布居的占据自旋轨道。有 $n_o$ 个可用的占据自旋轨道。从这个集合中恰好选择1个自旋轨道的方式数由二项式系数 $\\binom{n_o}{1}$ 给出。\n$$\n\\binom{n_o}{1} = \\frac{n_o!}{1!(n_o - 1)!} = n_o\n$$\n\n2.  选择要布居的虚自旋轨道。有 $n_v$ 个可用的虚自旋轨道。从这个集合中恰好选择1个自旋轨道的方式数由二项式系数 $\\binom{n_v}{1}$ 给出。\n$$\n\\binom{n_v}{1} = \\frac{n_v!}{1!(n_v - 1)!} = n_v\n$$\n\n由于对占据轨道的每一种选择都可以与对虚轨道的任意一种选择相结合，形成一个唯一的单激发行列式，因此这类行列式的总数 $N_{\\mathrm{S}}$ 是每一步选择数量的乘积。这是组合学中乘法法则的应用。\n$$\nN_{\\mathrm{S}} = \\binom{n_o}{1} \\times \\binom{n_v}{1} = n_o n_v\n$$\n\n接下来，我们推导双激发行列式的数量 $N_{\\mathrm{D}}$。一个双激发行列式，记为 $\\Phi_{ij}^{ab}$，是通过将两个电子从两个不同的占据自旋轨道 $\\chi_i$ 和 $\\chi_j$ 提升到两个不同的虚自旋轨道 $\\chi_a$ 和 $\\chi_b$ 而形成的。问题在于计算能以这种方式形成的唯一占据自旋轨道集合的数量。这个过程可以分解为两个独立的选择：\n\n1.  选择要退布居的两个占据自旋轨道。我们必须从 $n_o$ 个可用的占据自旋轨道中选择一个包含2个自旋轨道的集合。由于最终的行列式是由轨道集合指定的，选择的顺序无关紧要（即，选择 $\\{\\chi_i, \\chi_j\\}$ 与选择 $\\{\\chi_j, \\chi_i\\}$ 相同）。这样做的方式数由二项式系数 $\\binom{n_o}{2}$ 给出。\n$$\n\\binom{n_o}{2} = \\frac{n_o!}{2!(n_o - 2)!} = \\frac{n_o(n_o - 1)}{2}\n$$\n\n2.  选择要布居的两个虚自旋轨道。类似地，我们必须从 $n_v$ 个可用的虚自旋轨道中选择一个包含2个自旋轨道的集合。选择的顺序不重要。方式数由二项式系数 $\\binom{n_v}{2}$ 给出。\n$$\n\\binom{n_v}{2} = \\frac{n_v!}{2!(n_v - 2)!} = \\frac{n_v(n_v - 1)}{2}\n$$\n\n对占据轨道对的每一种选择都可以与对虚轨道对的任意一种选择相结合，形成一个唯一的双激发行列式。因此，这类行列式的总数 $N_{\\mathrm{D}}$ 是选择数量的乘积。\n$$\nN_{\\mathrm{D}} = \\binom{n_o}{2} \\times \\binom{n_v}{2} = \\frac{n_o(n_o-1)}{2} \\times \\frac{n_v(n_v-1)}{2} = \\frac{n_o(n_o-1)n_v(n_v-1)}{4}\n$$\n此推导过程完全按照问题的要求，仅使用了基于斯莱特行列式基本性质的组合推理。$N_{\\mathrm{S}}$ 和 $N_{\\mathrm{D}}$ 的表达式是关于 $n_o$ 和 $n_v$ 的闭式函数。\n\n最终答案应表示为包含 $N_{\\mathrm{S}}$ 和 $N_{\\mathrm{D}}$ 的行矩阵。\n$$\n\\begin{pmatrix} N_{\\mathrm{S}}  N_{\\mathrm{D}} \\end{pmatrix} = \\begin{pmatrix} n_o n_v  \\frac{n_o(n_o-1)n_v(n_v-1)}{4} \\end{pmatrix}\n$$\n这构成了完整的解答。", "answer": "$$\n\\boxed{\\begin{pmatrix} n_o n_v  \\frac{n_o(n_o-1)n_v(n_v-1)}{4} \\end{pmatrix}}\n$$", "id": "2881652"}, {"introduction": "上一个练习揭示了 CI 空间的组合特性，而这个练习将通过一个具体例子来展示其惊人的增长速度。我们将为一个简单的分子模型计算 CIS、CISD 和 CISDT 空间的维度，从而直观地感受所谓的“指数墙”问题。这个计算将清晰地表明，为何对于大多数体系而言，进行全 CI (FCI) 计算是不现实的，以及为何必须采用截断的 CI 方法。[@problem_id:2881654]", "problem": "考虑一个在自旋轨道基组中，由哈特里-福克 (Hartree–Fock, HF) 行列式构建的单参考组态相互作用 (Configuration Interaction, CI) 展开。令 $n_o$ 表示一个活性空间中占据自旋轨道的数量，$n_v$ 表示同一空间中虚拟自旋轨道的数量。一个秩为 $k$ 的激发用 $k$ 个不同的虚拟自旋轨道替换 $k$ 个不同的占据自旋轨道，从而生成一个新的斯莱特行列式 (Slater determinant)。假设行列式是直接在自旋轨道表象中构建的（没有自旋匹配），并且给定截断秩的 CI 空间包括 HF 参考行列式以及所有激发秩直到该截断秩的不同的斯莱特行列式。\n\n从二次量子化中斯莱特行列式和电子激发的标准定义出发，推导一个用 $n_o$ 和 $n_v$ 表示的、计算不同 $k$ 重激发行列式数量的通用表达式，并由此获得在单激发 (Configuration Interaction Singles, CIS)、单双激发 (Configuration Interaction Singles and Doubles, CISD) 和单双三激发 (Configuration Interaction Singles, Doubles, and Triples, CISDT) 水平下截断 CI 空间的总维数。\n\n然后，对于一个具有 $n_o=5$ 个占据自旋轨道和 $n_v=10$ 个虚拟自旋轨道的有效活性空间水分子模型，以精确整数的形式数值计算 CIS、CISD 和 CISDT 的维数。最后，简要讨论这些维数对 CI 中哈密顿量构建和对角化的计算影响。\n\n提供 CIS、CISD 和 CISDT 维数的最终数值结果，这三个结果应为精确整数。不需要四舍五入。最终答案必须只包含这三个值。", "solution": "对问题陈述进行验证。\n\n**第一步：提取已知条件**\n- 系统是基于自旋轨道基组中的哈特里-福克 (Hartree–Fock, HF) 行列式的单参考组态相互作用 (Configuration Interaction, CI) 展开。\n- $n_o$：活性空间中占据自旋轨道的数量。\n- $n_v$：活性空间中虚拟自旋轨道的数量。\n- 秩为 $k$ 的激发用 $k$ 个不同的虚拟自旋轨道替换 $k$ 个不同的占据自旋轨道。\n- 行列式在自旋轨道表象中构建，无需自旋匹配。\n- 给定秩的截断 CI 空间包括 HF 参考行列式和所有激发秩最高到该秩的斯莱特行列式。\n- 给定一个具体的活性空间模型，$n_o=5$ 且 $n_v=10$。\n- 任务是：\n    1. 推导计算 $k$ 重激发行列式数量的通用表达式。\n    2. 推导 CIS、CISD 和 CISDT 空间维数的表达式。\n    3. 对给定模型，数值计算这些维数。\n    4. 讨论计算上的影响。\n\n**第二步：使用提取的已知条件进行验证**\n- **科学性**：该问题基于量子化学的基本原理，特别是组态相互作用理论。所有术语和概念都是标准的、定义明确的。问题在科学上是合理的。\n- **适定性**：该问题是适定的。它提供了所有必要的定义和数值，以推导所需的表达式并计算最终答案。所提问题具有唯一的、可推导的解。\n- **客观性**：问题以精确、客观的语言陈述，没有歧义或主观看法。\n\n**第三步：结论与行动**\n问题是有效的，因为它在科学上合理、适定、客观且完整。将提供解答。\n\n组态相互作用的基础是将精确的多电子波函数在一组斯莱特行列式基上展开。这些行列式由一组单电子自旋轨道构建，这些自旋轨道被划分为占据自旋轨道（在参考的哈特里-福克行列式 $|\\Psi_0\\rangle$ 中）和虚拟（未占据）自旋轨道。\n\n一个秩为 $k$ 的激发态行列式是通过将 $k$ 个电子从 $k$ 个不同的占据自旋轨道提升到 $k$ 个不同的虚拟自旋轨道而形成的。我们需要求出对于给定的激发秩 $k$ 可以生成的唯一斯莱特行列式的数量。设这个数量为 $N_k$。\n\n创建一个 $k$ 重激发行列式的过程涉及两个独立的选择：\n1.  选择要移出电子的 $k$ 个占据自旋轨道。\n2.  选择要填入电子的 $k$ 个虚拟自旋轨道。\n\n给定 $n_o$ 个占据自旋轨道，从这个集合中选择 $k$ 个不同自旋轨道的方法数由二项式系数 $\\binom{n_o}{k}$ 给出。\n$$ \\binom{n_o}{k} = \\frac{n_o!}{k!(n_o - k)!} $$\n该表达式在 $0 \\le k \\le n_o$ 时有效。\n\n类似地，给定 $n_v$ 个虚拟自旋轨道，选择 $k$ 个不同自旋轨道来放置激发电子的方法数由二项式系数 $\\binom{n_v}{k}$ 给出。\n$$ \\binom{n_v}{k} = \\frac{n_v!}{k!(n_v - k)!} $$\n这在 $0 \\le k \\le n_v$ 时有效。\n\n由于占据轨道的选择和虚拟轨道的选择是独立的，不同 $k$ 重激发行列式的总数 $N_k$ 是这两个组合因子的乘积。\n$$ N_k = \\binom{n_o}{k} \\binom{n_v}{k} $$\n这就是在自旋轨道基组中，计算不同 $k$ 重激发行列式数量的通用表达式。注意，对于 $k=0$，我们有 $N_0 = \\binom{n_o}{0}\\binom{n_v}{0} = 1 \\times 1 = 1$，这代表单个哈特里-福克参考行列式本身。\n\n一个截断 CI 空间的总维数是每个包含的激发级别上行列式数量的总和。\nCIS (Configuration Interaction Singles) 空间包括参考行列式 ($k=0$) 和所有单激发 ($k=1$)。其维数 $D_{CIS}$ 为：\n$$ D_{CIS} = N_0 + N_1 = 1 + \\binom{n_o}{1}\\binom{n_v}{1} = 1 + n_o n_v $$\n\nCISD (Configuration Interaction Singles and Doubles) 空间包括参考、单激发和双激发 ($k=2$)。其维数 $D_{CISD}$ 为：\n$$ D_{CISD} = N_0 + N_1 + N_2 = 1 + \\binom{n_o}{1}\\binom{n_v}{1} + \\binom{n_o}{2}\\binom{n_v}{2} = D_{CIS} + \\binom{n_o}{2}\\binom{n_v}{2} $$\n\nCISDT (Configuration Interaction Singles, Doubles, and Triples) 空间包括参考、单激发、双激发和三激发 ($k=3$)。其维数 $D_{CISDT}$ 为：\n$$ D_{CISDT} = N_0 + N_1 + N_2 + N_3 = 1 + \\binom{n_o}{1}\\binom{n_v}{1} + \\binom{n_o}{2}\\binom{n_v}{2} + \\binom{n_o}{3}\\binom{n_v}{3} = D_{CISD} + \\binom{n_o}{3}\\binom{n_v}{3} $$\n\n现在，我们为给定的活性空间模型（$n_o=5$ 和 $n_v=10$）计算这些维数。\n\n对于 CIS：\n$$ D_{CIS} = 1 + n_o n_v = 1 + (5)(10) = 1 + 50 = 51 $$\n\n对于 CISD：\n首先，我们计算双激发的数量 $N_2$。\n$$ N_2 = \\binom{n_o}{2}\\binom{n_v}{2} = \\binom{5}{2}\\binom{10}{2} $$\n$$ \\binom{5}{2} = \\frac{5 \\times 4}{2 \\times 1} = 10 $$\n$$ \\binom{10}{2} = \\frac{10 \\times 9}{2 \\times 1} = 45 $$\n$$ N_2 = 10 \\times 45 = 450 $$\nCISD 空间的维数是：\n$$ D_{CISD} = D_{CIS} + N_2 = 51 + 450 = 501 $$\n\n对于 CISDT：\n首先，我们计算三激发的数量 $N_3$。\n$$ N_3 = \\binom{n_o}{3}\\binom{n_v}{3} = \\binom{5}{3}\\binom{10}{3} $$\n$$ \\binom{5}{3} = \\frac{5 \\times 4 \\times 3}{3 \\times 2 \\times 1} = 10 $$\n$$ \\binom{10}{3} = \\frac{10 \\times 9 \\times 8}{3 \\times 2 \\times 1} = 10 \\times 3 \\times 4 = 120 $$\n$$ N_3 = 10 \\times 120 = 1200 $$\nCISDT 空间的维数是：\n$$ D_{CISDT} = D_{CISD} + N_3 = 501 + 1200 = 1701 $$\n\n维数分别为 $D_{CIS}=51$，$D_{CISD}=501$ 和 $D_{CISDT}=1701$。\n\n最后，需要简要讨论计算上的影响。CI 空间的维数 $D_{CI}$ 决定了必须构建和对角化的哈密顿矩阵 $\\mathbf{H}$ 的大小。该矩阵的维数是 $D_{CI} \\times D_{CI}$。CI 计算的计算成本有两个主要组成部分：\n1. 构建哈密顿矩阵元 $H_{IJ} = \\langle \\Psi_I | \\hat{H} | \\Psi_J \\rangle$。此类矩阵元的数量约为 $\\frac{1}{2}D_{CI}^2$。\n2. 对角化矩阵 $\\mathbf{H}$ 以获得其本征值（能量）和本征向量（波函数）。标准对角化算法的标度为 $O(D_{CI}^3)$。对于大问题，采用诸如 Davidson 算法之类的迭代方法，每个根的成本大致标度为 $O(N_{iter} D_{CI}^2)$，其中 $N_{iter}$ 是达到收敛所需的迭代次数。\n\n推导出的表达式表明，$D_{CI}$ 随着激发水平 $k$ 呈组合增长，并随着轨道数（$n_o$ 和 $n_v$）呈多项式增长。具体来说，对于固定的较大 $k$，$N_k \\sim O(n_o^k n_v^k)$。这种快速的、类似阶乘的增长被称为量子化学的“指数墙”。从我们的计算（$51 \\to 501 \\to 1701$）可以看出，即使对于小体系和低激发水平，CI 矩阵的维数也会急剧增加。这使得高阶 CI 方法除了对最小的分子体系外，在计算上都变得不切实际，因此有必要使用计算效率更高、更近似的方法。", "answer": "$$\\boxed{\\begin{pmatrix} 51  501  1701 \\end{pmatrix}}$$", "id": "2881654"}]}