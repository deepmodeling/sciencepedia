## 引言
在[量子化学](@entry_id:140193)的宏伟蓝图中，[多组态自洽场](@entry_id:188517)（Multiconfigurational Self-consistent Field, [MCSCF](@entry_id:175254)）方法是理解复杂分子[电子结构](@entry_id:145158)的一块关键基石。当传统的单参考方法，如[Hartree-Fock理论](@entry_id:160358)，在面对化学键断裂、电子激发态或过渡金属[配合物](@entry_id:156661)等挑战时捉襟见肘，[MCSCF](@entry_id:175254)方法便应运而生。这些复杂情况的共同特征是存在“静态关联”——即多个电子组态因能量相近而必须被同等对待，这是单一[行列式](@entry_id:142978)[波函数](@entry_id:147440)无法克服的根本缺陷。本文旨在系统性地填补这一知识空白。我们将首先在“原理与机制”一章中，深入剖析[MCSCF](@entry_id:175254)的理论基础，揭示其如何通过同时优化[轨道](@entry_id:137151)和组态系数来捕获静态关联。接着，在“应用与交叉学科联系”一章，我们将通过具体的化学实例，展示[MCSCF](@entry_id:175254)在光化学、[反应动力学](@entry_id:150220)和[光谱学](@entry_id:141940)中的强大应用。最后，“动手实践”部分将提供练习，帮助读者巩固理论知识。现在，让我们从其核心原理出发，踏上探索[MCSCF](@entry_id:175254)方法的旅程。

## 原理与机制

在非相对论性、固定[原子核](@entry_id:167902)（Born-Oppenheimer 近似）的[电子结构理论](@entry_id:172375)框架下，一个分子的电子行为由其电子[哈密顿算符](@entry_id:144286) $\hat{H}$ 及其本征态——即电子[波函数](@entry_id:147440) $|\Psi\rangle$——所支配。变分原理是求解近似[波函数](@entry_id:147440)的基石，它指出对于任何归一化的试验[波函数](@entry_id:147440)，其[能量期望值](@entry_id:174035) $E[\Psi]=\langle \Psi|\hat{H}|\Psi\rangle$ 都是真实[基态能量](@entry_id:263704) $E_0$ 的一个上界。[Hartree-Fock](@entry_id:142303) (HF) 理论通过将试验[波函数](@entry_id:147440)限制为单一[斯莱特行列式](@entry_id:139034)，提供了一个计算上易于处理的[平均场近似](@entry_id:144121)。然而，这种简化也带来了其固有的局限性，特别是在处理被称为电子关联的现象时。本章旨在深入探讨[多组态自洽场](@entry_id:188517) (Multiconfigurational Self-consistent Field, [MCSCF](@entry_id:175254)) 方法的原理与机制，这是一种超越单一参考框架、旨在系统性地处理特定类型电子关联的强大理论。

### 单参考方法的局限性：静态关联的起源

电子关联能通常定义为精确的非相对论性能量与 [Hartree-Fock](@entry_id:142303) 极限能量之差。它源于电子之间瞬时排斥作用的复杂[多体效应](@entry_id:173569)，而这在平均[场模](@entry_id:189270)型中被忽略了。这种关联效应可以概念性地分为两种类型：**动态关联**和**静态关联**（或称非动态关联）。

**动态关联**是一种普遍存在的短程效应，它描述了电子为避免瞬时[库仑排斥](@entry_id:181876)而采取的精细、相关的运动。这种效应体现在[波函数](@entry_id:147440)中，需要大量（通常是无穷多）的、具有微小系数的组态来精确描述电子间的“库仑空穴”。

相比之下，**静态关联**则是一种更为剧烈的、定性上的效应，它发生在[基态](@entry_id:150928)电子结构本质上无法由单个[斯莱特行列式](@entry_id:139034)正确描述的情形中。这种情况通常源于多个电子组态之间的**[近简并](@entry_id:172107)**（near-degeneracy），即它们在能量上非常接近，以至于必须以相当大的权重组合在一起，才能构成一个定性正确的零阶[波函数](@entry_id:147440)。

一个典型的例子是[氢分子](@entry_id:148239) $\mathrm{H}_2$ 在键长拉伸时的解离过程 [@problem_id:2906823]。在平衡[键长](@entry_id:144592)附近，限制性 Hartree-Fock (RHF) 方法提供了一个合理的描述，其中两个电子以相反自旋占据[成键分子轨道](@entry_id:183240) $\sigma_g$。然而，当[键长](@entry_id:144592) $R \to \infty$ 时，正确的解离极限是两个中性的氢原子，每个原子带一个电子，总能量为 $2E_{\mathrm{H}(1s)}$。RHF [波函数](@entry_id:147440)却无法描述这一物理现实。其空间[波函数](@entry_id:147440) $\Psi_{\text{RHF}}(1,2) = \sigma_g(1)\sigma_g(2)$ 在用原子轨道展开时，会包含等量的“共价”项（$\phi_A(1)\phi_B(2) + \phi_B(1)\phi_A(2)$）和“离子”项（$\phi_A(1)\phi_A(2) + \phi_B(1)\phi_B(2)$）。这些离子项对应于 $\mathrm{H}^+ \cdots \mathrm{H}^-$ 结构，其能量在长程时远高于两个中性原子，因此它们的出现是完全非物理的。

这种定性失败的根源在于，随着 $R$ 的增大，[成键轨道](@entry_id:165952) $\sigma_g$ 和[反键轨道](@entry_id:178754) $\sigma_u$ 之间的能量差趋近于零，它们变得[近简并](@entry_id:172107)。这意味着仅包含 $\sigma_g^2$ 组态的 RHF [波函数](@entry_id:147440)是不充分的。为了消除非物理的离子项，必须引入另一个重要的组态，即双激发的 $\sigma_u^2$ 组态。一个由 $\sigma_g^2$ 和 $\sigma_u^2$ 组态构成的特定[线性组合](@entry_id:154743)（具体为 $\Psi \propto \sigma_g^2 - \sigma_u^2$）可以完美地抵消离子项，从而恢复正确的共价解离极限 [@problem_id:2906823]。这种由[轨道](@entry_id:137151)[近简并](@entry_id:172107)性引发的、需要多个[行列式](@entry_id:142978)才能定性描述电子结构的现象，正是静态关联的本质。

### [多组态波函数](@entry_id:165035)：一种更灵活的[变分形式](@entry_id:166033)

为了克服单参考方法的局限性，[MCSCF](@entry_id:175254) 方法采用了一种更灵活的[波函数](@entry_id:147440)[拟设](@entry_id:184384)（ansatz）。它将试验[波函数](@entry_id:147440)展开为一组反对称化的组态[基函数](@entry_id:170178) $|\Phi_I \rangle$ 的线性组合：
$$
|\Psi_{\text{MCSCF}} \rangle = \sum_I c_I |\Phi_I \rangle
$$
这里的关键之处在于，[MCSCF](@entry_id:175254) 方法不仅将线性组合系数 $\mathbf{c} = \{c_I\}$ 作为变分参数，还将构建这些组态 $|\Phi_I \rangle$ 的单电子轨道本身作为变分参数 [@problem_id:2653944]。

我们可以通过对比来理解 [MCSCF](@entry_id:175254) 的独特之处：
*   **[Hartree-Fock](@entry_id:142303) (HF) 方法**：变分空间仅限于单个[斯莱特行列式](@entry_id:139034)。优化过程在于寻找一组[轨道](@entry_id:137151)，使得由它们构成的单个[行列式能量](@entry_id:183560)最低。这相当于在 [MCSCF](@entry_id:175254) 展开中固定只有一个 $c_I=1$，其余为零。
*   **[组态相互作用 (CI)](@entry_id:198914) 方法**：变分空间是给定的一组固定[轨道](@entry_id:137151)所生成的多个[行列式](@entry_id:142978)的线性组合。优化过程只涉及线性系数 $\mathbf{c}$。
*   **[多组态自洽场](@entry_id:188517) ([MCSCF](@entry_id:175254)) 方法**：变分空间同时涵盖了组态的[线性组合](@entry_id:154743)和[轨道](@entry_id:137151)的[非线性](@entry_id:637147)变化。通过同时优化 $\mathbf{c}$ 和[轨道](@entry_id:137151)，[MCSCF](@entry_id:175254) 方法可以在一个更广阔的[函数空间](@entry_id:143478)中寻找能量极小点。

根据变分原理，一个更大的变分空间总能得到一个更低（或相等）的能量。因此，对于同一个组态列表，[MCSCF](@entry_id:175254) 方法得到的能量总是低于或等于从任意固定的[轨道](@entry_id:137151)集（如 HF [轨道](@entry_id:137151)）出发的 CI 方法所得到的能量：$E_{\text{MCSCF}} \le E_{\text{CI}}$ [@problem_id:2653944]。等号成立的条件是，进行 CI 计算时所用的固定[轨道](@entry_id:137151)恰好已经是该 CI 展开的最佳[轨道](@entry_id:137151)。

### 保证[自旋纯度](@entry_id:178603)：从[斯莱特行列式](@entry_id:139034)到[组态态函数](@entry_id:164365)

由于非相对论电子[哈密顿算符](@entry_id:144286)不依赖于自旋，它与[总自旋](@entry_id:153335)平方算符 $\hat{S}^2$ 和总[自旋[磁量子](@entry_id:163355)数](@entry_id:145584)算符 $\hat{S}_z$ 对易。这意味着精确的电子[波函数](@entry_id:147440)必须是这两个算符的共同本征函数，具有确定的总[自旋量子数](@entry_id:142550) $S$ 和[磁量子数](@entry_id:145584) $M_S$。在近似计算中保持这种**[自旋纯度](@entry_id:178603)**是至关重要的。

构建[反对称波函数](@entry_id:153813)最直接的方法是使用**斯莱特行列式**。一个斯莱特行列式总是 $\hat{S}_z$ 的[本征函数](@entry_id:154705)，其[本征值](@entry_id:154894)为 $M_S = \frac{1}{2}(N_\alpha - N_\beta)$，其中 $N_\alpha$ 和 $N_\beta$ 分别是 $\alpha$ 自旋和 $\beta$ 自旋电子的数目。然而，对于一般的[开壳层体系](@entry_id:168723)，单个斯莱特行列式通常不是 $\hat{S}^2$ 的本征函数，即它会混合多个不同[总自旋](@entry_id:153335) $S$ 的分量，造成所谓的**[自旋污染](@entry_id:268792)** (spin contamination) [@problem_id:2906793]。

为了解决这个问题，实践中通常使用**自旋匹配的[组态态函数](@entry_id:164365)** (spin-adapted Configuration State Functions, **CSFs**)。一个 CSF 被定义为一个预先构造好的、具有确定 $S$ 和 $M_S$ 值的斯莱特行列式的[线性组合](@entry_id:154743)。例如，对于两个不同空间[轨道](@entry_id:137151)上的两个电子，其 $S=0, M_S=0$ 的单重态 CSF 是两个[行列式](@entry_id:142978)的组合：$\frac{1}{\sqrt{2}}(|\phi_a\alpha \phi_b\beta| - |\phi_a\beta \phi_b\alpha|)$。

在 [MCSCF](@entry_id:175254) 计算中使用 CSF [基组](@entry_id:160309)有几个显著的优势 [@problem_id:2906793]：
1.  **保证[自旋纯度](@entry_id:178603)**：由于每个 CSF [基函数](@entry_id:170178)都具有确定的[总自旋](@entry_id:153335) $S$，它们的任意[线性组合](@entry_id:154743)（即 [MCSCF](@entry_id:175254) [波函数](@entry_id:147440)）也将具有相同的总自旋 $S$，从而从根本上消除了[自旋污染](@entry_id:268792)。
2.  **降低计算成本**：对于给定的空间[轨道](@entry_id:137151)占据模式，多个[斯莱特行列式](@entry_id:139034)通过[自旋耦合](@entry_id:180500)被“折叠”成数量更少的 CSF。这减少了需要变分优化的线性系数 $c_I$ 的数量。
3.  **提高数值效率**：由于[哈密顿算符](@entry_id:144286)在两个不同总自旋 $S$ 的 CSF 之间的[矩阵元](@entry_id:186505)为零（$\langle \text{CSF}_I(S) | \hat{H} | \text{CSF}_J(S') \rangle = 0 \text{ if } S \neq S'$），哈密顿矩阵在使用 CSF 基时会呈现[块对角结构](@entry_id:746869)。这意味着可以独立地求解每个[自旋多重度](@entry_id:263865)的电子态，将一个大矩阵的[对角化](@entry_id:147016)[问题分解](@entry_id:272624)为几个小矩阵的问题，从而大大提高了[计算效率](@entry_id:270255)和数值稳定性。

值得注意的是，存在一个特殊情况：如果一个[行列式](@entry_id:142978)的所有单占据[轨道](@entry_id:137151)都具有相同的自旋（例如，全为 $\alpha$ 自旋），那么这个[行列式](@entry_id:142978)本身就是一个[高自旋态](@entry_id:750320)，并且已经是 $\hat{S}^2$ 的本征函数，其 $S=n/2$（$n$ 为单占据电子数）。在这种情况下，单个[行列式](@entry_id:142978)就是一个 CSF [@problem_id:2906793]。

### 完备活性空间自洽场 (CASSCF) 方法

原则上，[MCSCF](@entry_id:175254) [波函数](@entry_id:147440)可以包含任意选择的组态。然而，为了系统性和[可复现性](@entry_id:151299)，最流行的方法是**完备活性空间[自洽场](@entry_id:136549) (Complete Active Space Self-Consistent Field, CASSCF)**。CASSCF 方法通过将[轨道空间](@entry_id:148658)划分为三个互不相交的[子空间](@entry_id:150286)来系统地定义组态展开 [@problem_id:2906859]：
1.  **非活性[轨道](@entry_id:137151) (Inactive/Core Orbitals)**：这些是能量较低的[轨道](@entry_id:137151)，在所有包含于[波函数](@entry_id:147440)展开的组态中，它们始终被双电子占据。
2.  **活性[轨道](@entry_id:137151) (Active Orbitals)**：这些是能量居中的[轨道](@entry_id:137151)，其占据数是可变的。它们通常是化学过程（如键断裂、激发）中最重要的[轨道](@entry_id:137151)。
3.  **[虚轨道](@entry_id:188499) (Virtual/Secondary Orbitals)**：这些是能量较高的[轨道](@entry_id:137151)，在所有组态中它们始终是空的。

一个 CASSCF 计算由两个数字定义，记作 **CAS(n, m)**，它表示将 **$n$ 个活性电子** 以所有可能的方式[分布](@entry_id:182848)在 **$m$ 个活性空间[轨道](@entry_id:137151)**上。这等同于在活性空间内部进行了一次**[全组态相互作用](@entry_id:172539) (Full Configuration Interaction, FCI)** 计算。因此，[CASSCF](@entry_id:271786) [波函数](@entry_id:147440)包含了描述[活性空间](@entry_id:263213)内静态关联所需的所有组态。

这种设计使得 CASSCF 成为处理静态关联的理想工具。然而，它也有一个固有的局限性：它完全忽略了涉及非活性[轨道](@entry_id:137151)或[虚轨道](@entry_id:188499)的电子激发。这些激发描述的是电子的瞬时躲避行为，即动态关联。用投影算符的语言来说，如果 $\hat{P}$ 是投影到 CAS 模型空间（[活性空间](@entry_id:263213)）的算符，$\hat{Q}$ 是投影到其外部空间（涉及非活性和[虚轨道](@entry_id:188499)的激发）的算符，那么 [CASSCF](@entry_id:271786) [波函数](@entry_id:147440) $|\Psi_0 \rangle$ 完全位于 $\hat{P}$ 空间内。它与 $\hat{Q}$ 空间没有混合，而动态关联能量主要来自于 $\hat{P}$ 和 $\hat{Q}$ 空间之间的弱但数量庞大的耦合。因此，[CASSCF](@entry_id:271786) 精确地捕捉了静态关联，但却遗漏了绝大部分的动态关联 [@problem_id:2653997]。这解释了为什么在实际应用中，通常需要在 CASSCF 计算之后再进行一步“后-[CASSCF](@entry_id:271786)”计算，例如使用**二级微扰理论 ([CASPT2](@entry_id:177918))** 或**[多参考组态相互作用](@entry_id:199629) (MRCI)**，以将动态关联的贡献添加回来。

### 优化的机制：耦合方程与自洽迭代

[MCSCF](@entry_id:175254) 中的“自洽场”一词揭示了其求解过程的本质。变分最小化 [MCSCF](@entry_id:175254) 能量 $E(\mathbf{c}, \boldsymbol{\kappa})$（其中 $\boldsymbol{\kappa}$ 是[参数化](@entry_id:272587)[轨道](@entry_id:137151)旋转的[非线性](@entry_id:637147)参数）需要能量对所有变分参数（$\mathbf{c}$ 和 $\boldsymbol{\kappa}$）的导数都为零。这导出了两组必须同时满足的方程 [@problem_id:2653995] [@problem_id:2906790]：

1.  **CI 方程**：在[轨道](@entry_id:137151)固定（$\boldsymbol{\kappa}$ 固定）时，对线性系数 $\mathbf{c}$ 求变分，得到一个标准的 CI 本征方程：
    $$
    \mathbf{H}(\boldsymbol{\kappa})\mathbf{c} = E\mathbf{c}
    $$
    其中 $\mathbf{H}(\boldsymbol{\kappa})$ 是在当前[轨道](@entry_id:137151)基上的哈密顿矩阵。这个方程的解给出了在当前[轨道](@entry_id:137151)下最优的 CI 系数。

2.  **[轨道](@entry_id:137151)优化方程**：在 CI 系数固定（$\mathbf{c}$ 固定）时，对[轨道](@entry_id:137151)旋转参数 $\boldsymbol{\kappa}$ 求变分。这个条件被称为**广义[布里渊定理](@entry_id:166170) (Generalized Brillouin's Theorem, GBT)**。它规定，在能量[驻点](@entry_id:136617)，对于所有非冗余的[轨道](@entry_id:137151)旋转（即改变[波函数](@entry_id:147440)能量的旋转），能量梯度必须为零。其算符形式为 [@problem_id:2458994]：
    $$
    \langle \Psi | [\hat{H}, \hat{E}_{pq} - \hat{E}_{qp}] | \Psi \rangle = 0
    $$
    其中 $\hat{E}_{pq} = \hat{a}^{\dagger}_{p} \hat{a}_{q}$ 是一个单电子激发算符。这个条件等价于说，由当前 CI 向量构建的广义 Fock 矩阵的特定块（连接不同[子空间](@entry_id:150286)，如非活性-活性、活性-[虚轨道](@entry_id:188499)的块）必须为零。

这两组方程是**[非线性](@entry_id:637147)耦合**的：CI 方程中的 $\mathbf{H}$ 矩阵取决于[轨道](@entry_id:137151)，而[轨道](@entry_id:137151)优化方程（GBT）的条件取决于由 CI 系数 $\mathbf{c}$ 决定的单粒子和双粒子[约化密度矩阵](@entry_id:146315)。它们无法独立求解。

在实践中，几乎所有的 [MCSCF](@entry_id:175254) 程序都采用一种**交替优化**的迭代方案，也称为**宏观迭代 (macro-iteration)** [@problem_id:2653995]。在每次宏观迭代中：
1.  **CI 步**：固定当前[轨道](@entry_id:137151)，求解 CI 本征方程，得到新的 CI 系数 $\mathbf{c}$。
2.  **[轨道](@entry_id:137151)优化步**：固定当前 CI 系数，利用广义[布里渊定理](@entry_id:166170)构建[轨道](@entry_id:137151)梯度和（近似的）Hessian 矩阵，更新[轨道](@entry_id:137151)。

这个过程反复进行，直到能量、CI 系数和[轨道](@entry_id:137151)梯度都收敛到预设的阈值以下，达到自洽。这种分步迭代的策略避免了构造和求解一个包含所有参数的巨大且通常是病态的完全耦合 Hessian 矩阵，从而在计算上更加可行和稳健。

在 [CASSCF](@entry_id:271786) 中，[轨道](@entry_id:137151)旋转可以进一步细分。在非活性、活性或[虚轨道](@entry_id:188499)[子空间](@entry_id:150286)内部的旋转是冗余的，因为它们不会改变 [CASSCF](@entry_id:271786) 能量。只有连接不同[子空间](@entry_id:150286)的旋转（非活性-活性，非活性-虚，活性-虚）才是需要优化的非[冗余参数](@entry_id:171802) [@problem_id:2906859]。对于一个包含 $n_i$ 个非活性[轨道](@entry_id:137151)、$n_a$ 个活性[轨道](@entry_id:137151)和 $n_v$ 个[虚轨道](@entry_id:188499)的体系，非冗余[轨道](@entry_id:137151)参数的总数为 $n_i n_a + n_i n_v + n_a n_v$ [@problem_id:2906790]。

### [波函数分析](@entry_id:262946)：自然[轨道](@entry_id:137151)及其占据数

一个收敛的 [MCSCF](@entry_id:175254) [波函数](@entry_id:147440)通常包含大量的组态，直接解读可能非常困难。一个极其有用的分析工具是**[单粒子约化密度矩阵](@entry_id:197968) ([1-RDM](@entry_id:183172))**，其矩阵元为 $\gamma_{pq} = \sum_{\sigma} \langle \Psi | \hat{a}^{\dagger}_{q\sigma} \hat{a}_{p\sigma} | \Psi \rangle$。

通过对 [1-RDM](@entry_id:183172) 矩阵进行对角化，可以得到一组新的正交[轨道](@entry_id:137151)基，称为**自然[轨道](@entry_id:137151) (natural orbitals)**。对应的[本征值](@entry_id:154894)则被称为**自然[轨道](@entry_id:137151)占据数 (natural orbital occupation numbers)** [@problem_id:2906837]。自然[轨道](@entry_id:137151)是使 [1-RDM](@entry_id:183172) 呈[对角形式](@entry_id:264850)的唯一[轨道](@entry_id:137151)基，而占据数则表示在该[轨道](@entry_id:137151)上找到电子的[期望值](@entry_id:153208)。

自然[轨道](@entry_id:137151)及其占据数为诊断[波函数](@entry_id:147440)的[电子结构](@entry_id:145158)和关联效应提供了深刻的见解：
*   对于一个单参考闭壳层[波函数](@entry_id:147440)（如 RHF），占据数严格为整数：占据[轨道](@entry_id:137151)为 2，[虚轨道](@entry_id:188499)为 0。
*   任何偏离整数 2 或 0 的占据数都表明存在电子关联。
*   当一个或多个自然[轨道](@entry_id:137151)的占据数显著偏离 2 或 0 时（例如，1.8 和 0.2，或者在 $\mathrm{H}_2$ 解离的例子中，两个占据数都接近 1.0），这清楚地表明了存在强烈的**静态关联**，并且该体系具有显著的**[多参考特征](@entry_id:180987)** [@problem_id:2906837]。占据数接近 2 的[轨道](@entry_id:137151)可以被认为是“类非活性”的，而占据数接近 0 的[轨道](@entry_id:137151)则是“类虚”的。那些占据数介于两者之间的[轨道](@entry_id:137151)，则是真正体现化学过程核心的“活性”[轨道](@entry_id:137151)。

### 扩展与应用：[RASSCF](@entry_id:163121) 和态平均 [CASSCF](@entry_id:271786)

虽然 CASSCF 功能强大，但其计算成本随活性空间大小呈[指数增长](@entry_id:141869)，限制了其应用范围。为了处理更大的[活性空间](@entry_id:263213)，**[限制性活性空间自洽场](@entry_id:173576) (Restricted Active Space SCF, [RASSCF](@entry_id:163121))** 方法应运而生 [@problem_id:2654006]。[RASSCF](@entry_id:163121) 将[活性空间](@entry_id:263213)进一步细分为三个[子空间](@entry_id:150286)：RAS1、RAS2 和 RAS3。它通过施加额外的限制来裁剪 FCI 空间：允许从 RAS1 中激发出有限数量的“空穴”，并允许向 RAS3 中激发有限数量的“粒子”，而 RAS2 空间内部则没有限制。通过调整这些限制，[RASSCF](@entry_id:163121) 可以在计算成本和精度之间进行权衡，提供了一种比 CASSCF 更灵活的方案。变分上，[RASSCF](@entry_id:163121) 的能量总是高于或等于在相同总活性空间上的 [CASSCF](@entry_id:271786) 能量。

[MCSCF](@entry_id:175254) 方法的另一个重要应用是处理[电子激发](@entry_id:190531)态和[势能面](@entry_id:147441)交叉。对单个[激发态](@entry_id:261453)进行状态特定的优化常常会遇到所谓的**根交换 (root-flipping)** 问题：在[几何优化](@entry_id:151817)过程中，算法可能会在不同的电子态之间来回跳跃，导致[势能面](@entry_id:147441)不连续和收敛困难，尤其是在（避免）[交叉点](@entry_id:147634)附近。

**态平均 CASSCF (State-Averaged CASSCF, SA-[CASSCF](@entry_id:271786))** 方法通过优化一组对多个电子态（例如，[基态](@entry_id:150928)和几个低[激发态](@entry_id:261453)）都“足够好”的共同[轨道](@entry_id:137151)来解决这个问题 [@problem_id:2654044]。这是通过最小化一个加权的能量平均值来实现的：
$$
E_{\text{av}} = \sum_{k=1}^{m} w_k E_k
$$
其中 $w_k$ 是预设的权重。通过优化一组公共[轨道](@entry_id:137151)，SA-CASSCF 提供了一个平滑且稳定的参考框架，即使各个态的能量顺序发生变化，也能避免根交换。这种方法的代价是，得到的[轨道](@entry_id:137151)对于任何单个态来说都不是最优的，因此每个态的能量和性质的精度可能会略低于状态特定的计算。然而，这种稳定性对于研究光化学过程至关重要，特别是在定位**锥形交叉 (conical intersections)** 点时。SA-[CASSCF](@entry_id:271786) (通常使用等权重，如 $w_1=w_2=0.5$) 能够均衡地描述[近简并](@entry_id:172107)的态，从而稳定地计算定位[交叉点](@entry_id:147634)所需知的梯度差和[非绝热耦合](@entry_id:198018)矢量 [@problem_id:2654044]。