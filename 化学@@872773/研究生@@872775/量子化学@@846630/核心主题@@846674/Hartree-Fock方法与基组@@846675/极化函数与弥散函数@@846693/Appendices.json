{"hands_on_practices": [{"introduction": "分子极化率是衡量分子电子云在电场作用下响应能力的物理量。为了准确描述这种响应，理论计算中必须使用极化函数，它们为电子密度提供了变形所需的角向灵活性。本练习将通过一个简化的双能级微扰模型，定量地揭示增加一个 $d$ 轨道如何直接增强水分子的极化率，从而加深对极化函数物理本质的理解 [@problem_id:2916115]。", "problem": "考虑在一个水分子的氧中心上添加一个角动量为$d$的单极化函数时，其静态偶极极化率的变化，该模型按如下方式进行最小化构建。计算在哈特里原子单位（a.u.）下进行，其中基本电荷、约化普朗克常数和电子质量均设为$1$，偶极矩的单位为玻尔（$a_0$），能量的单位为哈特里（$E_h$），极化率的单位为$a_0^3$。\n\n从静态偶极极化率张量$\\alpha_{ij}$的定义出发，即电子基态能量$E$相对于均匀电场分量$\\mathcal{E}_i$的二阶导数，并在零场下取值，$\\alpha_{ij} = -\\left.\\frac{\\partial^2 E}{\\partial \\mathcal{E}_i \\partial \\mathcal{E}_j}\\right|_{\\mathcal{E}=0}$。使用非简并定态瑞利-薛定谔微扰理论和标准的态求和表示作为基本依据，推导当通过添加一个单一、正交归一化的笛卡尔d型高斯型轨道（GTO）引入一个新的以氧为中心的虚轨道通道时，沿固定分子轴$k$的单个张量分量$\\Delta \\alpha_{kk}$的变化的最低阶表达式。\n\n为使问题明确且可进行数值检验，采用以下具有物理动机且自洽的建模假设，除此处列出的近似外，不引入任何其他近似：\n- 变化$\\Delta \\alpha_{kk}$主要由一个具有p特征、以氧为中心的类孤对电子已占据分子轨道$\\lvert p\\rangle$与新引入的d型GTO所支持的虚轨道构型$\\lvert d\\rangle$之间的混合所主导。所有其他已占据-虚轨道通道均被假定为不变，因此在差值中相互抵消。\n- 这两个构型之间的能隙是一个正常数$\\Delta E = E_d - E_p > 0$，每个测试用例中以$E_h$为单位指定。\n- 沿$k$轴的跃迁偶极矩矩阵元与所添加的笛卡尔d型GTO的空间延展成比例。具体来说，取矩阵元的大小为$\\mu_{pd}^{(k)} = S\\,\\zeta_d^{-1/2}$，其中$\\zeta_d > 0$是d函数的高斯指数，单位为$a_0^{-2}$，$S > 0$是一个无量纲振幅，捕捉了氧上沿$k$轴的有效p特征和角耦合。\n- 假设所涉及的态是正交归一的，并忽略超过电场一阶的弛豫，这与线性响应理论一致。\n\n您的任务是：\n1. 仅使用所述的基本依据和建模假设，推导$\\Delta \\alpha_{kk}$关于$\\Delta E$、$\\zeta_d$和$S$的显式表达式，并确定其符号。您的推导必须基于一阶微扰密度观点和态求和图像，并且必须在逻辑上将$\\mu_{pd}^{(k)}$的标度关系与观察到的$\\Delta \\alpha_{kk}$对$\\zeta_d$和$\\Delta E$的依赖性联系起来。\n2. 实现一个程序，为下面给出的一小组参数三元组$(\\Delta E, \\zeta_d, S)$评估您推导的表达式。为每个测试用例生成$\\Delta \\alpha_{kk}$的数值，单位为$a_0^3$。\n3. 最终输出必须是包含测试用例结果的单行Python列表字面量，顺序与所列顺序相同，每个值四舍五入到$6$位小数，例如$[x_1,x_2,x_3]$。\n4. 您需要以$a_0^3$为单位表示结果。\n\n测试套件（每个三元组为$(\\Delta E, \\zeta_d, S)$，其中$\\Delta E$的单位为$E_h$，$\\zeta_d$的单位为$a_0^{-2}$，$S$为无量纲）：\n- 用例A（常规理想情况）：$(0.6, 1.5, 1.1)$。\n- 用例B（紧凑的d函数，类边界行为）：$(1.5, 6.0, 1.1)$。\n- 用例C（弥散的d函数，边缘情况行为）：$(0.3, 0.5, 1.1)$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如$[r_1,r_2,r_3]$）的结果，其中每个$r_i$是对应测试用例计算出的$\\Delta \\alpha_{kk}$（单位为$a_0^3$），四舍五入到$6$位小数。", "solution": "首先对问题陈述进行验证。\n\n步骤1：提取的已知条件。\n- 静态偶极极化率张量的定义是 $\\alpha_{ij} = -\\left.\\frac{\\partial^2 E}{\\partial \\mathcal{E}_i \\partial \\mathcal{E}_j}\\right|_{\\mathcal{E}=0}$。\n- 理论基础是非简并定态瑞利-薛定谔微扰理论和态求和表示。\n- 关注的量是在水分子的氧原子上添加一个笛卡尔d型高斯型轨道（GTO）后，极化率张量分量$\\Delta \\alpha_{kk}$的变化。\n- 假设1：变化$\\Delta \\alpha_{kk}$完全由引入一个新的激发通道引起，该通道涉及一个已占据的p型分子轨道（MO）$\\lvert p\\rangle$和一个新的虚d型MO $\\lvert d\\rangle$。\n- 假设2：这两个态之间的能隙是一个正常数$\\Delta E = E_d - E_p > 0$。\n- 假设3：沿$k$轴，这两个态之间的跃迁偶极矩矩阵元的大小由模型$\\mu_{pd}^{(k)} = S\\,\\zeta_d^{-1/2}$给出，其中$\\zeta_d > 0$是GTO指数，$S > 0$是一个无量纲振幅。\n- 假设4：这些态是正交归一的，并且忽略超过一阶的电子弛豫效应。\n- 所有计算均在哈特里原子单位下进行，极化率以$a_0^3$为单位表示。\n- $(\\Delta E, \\zeta_d, S)$的测试用例：用例A $(0.6, 1.5, 1.1)$；用例B $(1.5, 6.0, 1.1)$；用例C $(0.3, 0.5, 1.1)$。\n\n步骤2：验证。\n该问题具有科学依据，基于量子化学的标准原理（微扰理论、基组、分子性质）。其简化假设虽然大胆，但为了创建一个可解模型而具有物理动机，并且被明确陈述。问题是适定、客观且自洽的，为推导唯一表达式和计算所需数值提供了所有必要信息。它没有违反任何基本定律，也不是无关紧要或不明确的。\n\n步骤3：结论。\n问题有效。将提供一个合理的解答。\n\n推导从静态偶极极化率的态求和（SOS）表达式开始，这是将二阶瑞利-薛定谔微扰理论应用于静电场中分子的直接结果。对于对角分量$\\alpha_{kk}$，SOS表达式为：\n$$\n\\alpha_{kk} = 2 \\sum_{n \\neq 0} \\frac{|\\langle \\Psi_0 | \\hat{\\mu}_k | \\Psi_n \\rangle|^2}{E_n - E_0}\n$$\n其中$\\Psi_0$是能量为$E_0$的电子基态，$\\{\\Psi_n\\}_{n \\neq 0}$是能量为$E_n$的所有激发电子态的集合，$\\hat{\\mu}_k$是电偶极算符的$k$分量。所有量均采用原子单位。\n\n问题陈述指出，添加一个新的d型GTO会引入一个涉及已占据轨道$\\lvert p \\rangle$和新虚轨道$\\lvert d \\rangle$的单一新虚通道。所有其他已占据-虚轨道通道均被假定不受影响。因此，极化率的变化$\\Delta \\alpha_{kk}$就是这个新项对态求和的贡献：\n$$\n\\Delta \\alpha_{kk} = 2 \\frac{|\\langle \\Psi_0 | \\hat{\\mu}_k | \\Psi_{p \\to d} \\rangle|^2}{E_{p \\to d} - E_0}\n$$\n其中$\\Psi_{p \\to d}$是新近可及的激发态，对应于一个电子从$\\lvert p \\rangle$跃迁到$\\lvert d \\rangle$。\n\n现在我们应用建模假设来评估这个表达式。\n1. 能量分母$E_{p \\to d} - E_0$是激发能。在分子轨道图像中，这近似于轨道能量之差。问题直接将其作为能隙$\\Delta E = E_d - E_p$提供。\n2. 分子包含平方跃迁偶极矩，$|\\langle \\Psi_0 | \\hat{\\mu}_k | \\Psi_{p \\to d} \\rangle|^2$。在单粒子模型中，这个态间矩阵元与轨道矩阵元$\\mu_{pd}^{(k)} = \\langle p | \\hat{\\mu}_k | d \\rangle$成正比。问题为这个有效跃迁矩的大小提供了一个模型：$|\\mu_{pd}^{(k)}| = S \\zeta_d^{-1/2}$。\n\n将这些模型参数代入$\\Delta \\alpha_{kk}$的表达式中：\n$$\n\\Delta \\alpha_{kk} = 2 \\frac{(S \\zeta_d^{-1/2})^2}{\\Delta E}\n$$\n这简化为最终表达式：\n$$\n\\Delta \\alpha_{kk} = \\frac{2 S^2}{\\Delta E \\cdot \\zeta_d}\n$$\n这是$\\Delta \\alpha_{kk}$关于给定参数$\\Delta E$、$\\zeta_d$和$S$的显式表达式。\n\n为确定$\\Delta \\alpha_{kk}$的符号，我们注意到根据定义$S > 0$，因此$S^2 > 0$。能隙$\\Delta E > 0$和高斯指数$\\zeta_d > 0$也作为正常数给出。由于表达式中的所有因子都是正的，因此极化率的变化$\\Delta \\alpha_{kk}$必须是正的。这在物理上是正确的：为电子密度响应外部电场增加一个极化通道，必须增加系统的极化率。\n\n该推导也阐明了$\\Delta \\alpha_{kk}$对模型参数的依赖性。与能隙的反比关系$\\Delta \\alpha_{kk} \\propto 1/\\Delta E$是二阶微扰理论的特征：较小的能隙导致更强的耦合和更大的响应。与指数的反比关系$\\Delta \\alpha_{kk} \\propto 1/\\zeta_d$源于跃迁偶极矩的标度关系。较小的指数$\\zeta_d$意味着一个空间上更弥散的GTO。一个弥散的函数具有更大的空间延展，这导致依赖于位置的偶极算符的矩阵元$\\mu_{pd}^{(k)}$具有更大的值。这个更大的跃迁矩反过来又对极化率产生更大的贡献，这与已知的事实相符，即弥散基函数对于准确描述极化率至关重要。\n\n现在，问题简化为使用推导出的公式对给定的测试用例进行数值计算。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the change in static dipole polarizability based on a derived\n    two-level model and provided test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is (delta_E, zeta_d, S)\n    test_cases = [\n        (0.6, 1.5, 1.1),  # Case A: General happy path\n        (1.5, 6.0, 1.1),  # Case B: Tight d function, boundary-like behavior\n        (0.3, 0.5, 1.1),  # Case C: Diffuse d function, edge-case behavior\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack parameters for the current case\n        delta_E, zeta_d, S = case\n\n        # The derived formula for the change in polarizability is:\n        # delta_alpha_kk = (2 * S^2) / (delta_E * zeta_d)\n        # All inputs are in Hartree atomic units, so the result is in the\n        # atomic unit of polarizability, which is a_0^3.\n        delta_alpha_kk = (2 * S**2) / (delta_E * zeta_d)\n\n        # Append the result formatted to 6 decimal places as required.\n        results.append(f\"{delta_alpha_kk:.6f}\")\n\n    # Final print statement in the exact required format: [r1,r2,r3]\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2916115"}, {"introduction": "在超分子化学和药物设计等领域，精确计算分子间相互作用能至关重要。使用不完备基组会引入一种被称为基组叠加误差 (Basis Set Superposition Error, BSSE) 的人为误差，尤其是在描述需要弥散函数的弱相互作用体系中。本练习将引导你通过代数推导和数值计算，使用半反演校正 (half-CP) 方法来分解和理解相互作用能的误差来源，从而阐明弥散函数在减轻BSSE和提高精度中的作用 [@problem_id:2916061]。", "problem": "给定一个卤化物-水复合物的超分子描述，以及一组使用不同基组（包含和不包含弥散增广）计算出的绝对电子能量。目标是使用半衡消（half-CP）框架，将相互作用能误差分解为一个可归因于基组重叠误差（BSSE）的组分，和一个可归因于基组不完备性（有时称为基组不完备性误差）的组分。\n\n从以下基本事实和定义开始，这些是量子化学中的标准内容，源于变分原理和超分子能量定义：\n- 令 $E_{AB}^{AB}$ 表示在二聚体基组中计算的二聚体的电子能量。\n- 令 $E_{A}^{A}$ 和 $E_{B}^{B}$ 表示在各自单体基组中计算的单体的电子能量。\n- 令 $E_{A}^{AB}$ 和 $E_{B}^{AB}$ 表示在伙伴基函数作为鬼原子存在的情况下计算的单体能量（即使用一个鬼原子的“二聚体基组”），根据变分原理，它们满足 $E_{A}^{AB} \\le E_{A}^{A}$ 和 $E_{B}^{AB} \\le E_{B}^{B}$。\n- 原始（未校正的）超分子相互作用能为\n$$\nI_{\\mathrm{raw}} \\equiv E_{AB}^{AB} - E_{A}^{A} - E_{B}^{B}.\n$$\n- 根据 Boys–Bernardi 衡消法，衡消（CP）校正的相互作用能为\n$$\nI_{\\mathrm{CP}} \\equiv E_{AB}^{AB} - E_{A}^{AB} - E_{B}^{AB}.\n$$\n- 半衡消（half-CP）相互作用能是平均值\n$$\nI_{1/2} \\equiv \\tfrac{1}{2}\\left(I_{\\mathrm{raw}} + I_{\\mathrm{CP}}\\right).\n$$\n- CP 位移（基组重叠误差（BSSE）的标准估计量）是\n$$\n\\Delta_{\\mathrm{CP}} \\equiv \\left(E_{A}^{AB} - E_{A}^{A}\\right) + \\left(E_{B}^{AB} - E_{B}^{B}\\right),\n$$\n其满足 $I_{\\mathrm{CP}} = I_{\\mathrm{raw}} - \\Delta_{\\mathrm{CP}}$。\n\n假设参考（完备基）相互作用能为 $I_{\\mathrm{ref}}$，并将半CP相互作用能误差定义为\n$$\n\\varepsilon_{1/2} \\equiv I_{1/2} - I_{\\mathrm{ref}}.\n$$\n\n你的任务是：\n1) 仅使用上述定义，将 $\\varepsilon_{1/2}$ 在代数上表示为两个贡献项之和，其中一个依赖于 $\\Delta_{\\mathrm{CP}}$，另一个仅依赖于 $I_{\\mathrm{CP}} - I_{\\mathrm{ref}}$。将这两项分别解释为“半CP中的残余BSSE贡献”和“半CP中的基组不完备性贡献”。除给定定义外，不要引入任何额外假设。\n2) 在一个程序中实现这些表达式，为每个测试用例计算这两个贡献项及其总和。\n3) 使用转换因子 $1\\,\\text{hartree} = 2625.49962\\,\\text{kJ}\\,\\text{mol}^{-1}$，将所有最终报告的量从哈特里转换为千焦/摩尔。\n4) 所有最终数值答案以 $\\text{kJ}\\,\\text{mol}^{-1}$ 为单位，并四舍五入到六位小数。\n\n使用以下参数集测试套件，每个参数集提供以哈特里为单位的 $\\left(E_{AB}^{AB}, E_{A}^{A}, E_{B}^{B}, E_{A}^{AB}, E_{B}^{AB}\\right)$，以及一个对应于相同复合物几何构型的通用参考相互作用能 $I_{\\mathrm{ref}}$（以哈特里为单位）：\n\n- 测试用例1（非增广、极化、类双ζ）：\n  - $E_{AB}^{AB} = -536.490000$\n  - $E_{A}^{A} = -460.180000$\n  - $E_{B}^{B} = -76.280000$\n  - $E_{A}^{AB} = -460.186000$\n  - $E_{B}^{AB} = -76.284000$\n- 测试用例2（非增广、极化、类三ζ）：\n  - $E_{AB}^{AB} = -536.526666$\n  - $E_{A}^{A} = -460.200000$\n  - $E_{B}^{B} = -76.300000$\n  - $E_{A}^{AB} = -460.205000$\n  - $E_{B}^{AB} = -76.302000$\n- 测试用例3（弥散增广、极化、类三ζ）：\n  - $E_{AB}^{AB} = -536.542800$\n  - $E_{A}^{A} = -460.210000$\n  - $E_{B}^{B} = -76.310000$\n  - $E_{A}^{AB} = -460.211500$\n  - $E_{B}^{AB} = -76.310800$\n- 测试用例4（弥散增广、极化、类四ζ）：\n  - $E_{AB}^{AB} = -536.550700$\n  - $E_{A}^{A} = -460.215000$\n  - $E_{B}^{B} = -76.315000$\n  - $E_{A}^{AB} = -460.215200$\n  - $E_{B}^{AB} = -76.315100$\n\n对所有用例使用相同的参考相互作用能：\n- $I_{\\mathrm{ref}} = -0.020500$ 哈特里。\n\n对于每个测试用例，你的程序必须计算并返回一个三元组\n$$\n\\left[\\varepsilon_{1/2},\\ \\varepsilon_{\\mathrm{BSSE}}^{(1/2)},\\ \\varepsilon_{\\mathrm{inc}}^{(1/2)}\\right],\n$$\n其中每个条目都以 $\\text{kJ}\\,\\text{mol}^{-1}$ 为单位表示，并四舍五入到六位小数，其中 $\\varepsilon_{1/2}$ 是总的半CP相互作用能误差，$\\varepsilon_{\\mathrm{BSSE}}^{(1/2)}$ 是半CP中的残余BSSE贡献，$\\varepsilon_{\\mathrm{inc}}^{(1/2)}$ 是半CP中的基组不完备性贡献，使得\n$$\n\\varepsilon_{1/2} = \\varepsilon_{\\mathrm{BSSE}}^{(1/2)} + \\varepsilon_{\\mathrm{inc}}^{(1/2)}.\n$$\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含一个JSON格式的列表的列表，每个内部列表对应一个测试用例，按上述顺序排列。例如：\n- \n  [[x11,x12,x13],[x21,x22,x23],[x31,x32,x33],[x41,x42,x43]]\n- \n其中每个 $x_{ij}$ 均以 $\\text{kJ}\\,\\text{mol}^{-1}$ 为单位，四舍五入到六位小数，并且不包含任何附加文本。\n\n角度单位不适用。所有提供的能量均以哈特里为单位，所有要求的输出必须以 $\\text{kJ}\\,\\text{mol}^{-1}$ 为单位。", "solution": "该问题陈述经过了严格验证，被认为是科学上合理、表述清晰且内部一致的。所有给出的定义在量子化学领域都是标准的，并且数值数据在物理上是现实的，并遵循变分原理，即 $E_{X}^{XY} \\le E_{X}^{X}$。因此，我们可以着手求解。\n\n主要任务是将半衡消（half-CP）相互作用能的总误差 $\\varepsilon_{1/2}$ 分解为两个具有物理意义的组分：一个残余的基组重叠误差（BSSE）贡献 $\\varepsilon_{\\mathrm{BSSE}}^{(1/2)}$，和一个基组不完备性贡献 $\\varepsilon_{\\mathrm{inc}}^{(1/2)}$。这个分解必须从所提供的基本定义中通过代数推导得出。\n\n我们从半CP相互作用能误差的定义开始：\n$$\n\\varepsilon_{1/2} \\equiv I_{1/2} - I_{\\mathrm{ref}}\n$$\n半CP相互作用能 $I_{1/2}$ 定义为原始相互作用能和完全衡消校正相互作用能的算术平均值：\n$$\nI_{1/2} \\equiv \\frac{1}{2}\\left(I_{\\mathrm{raw}} + I_{\\mathrm{CP}}\\right)\n$$\n将此式代入 $\\varepsilon_{1/2}$ 的表达式中，得到：\n$$\n\\varepsilon_{1/2} = \\frac{1}{2}\\left(I_{\\mathrm{raw}} + I_{\\mathrm{CP}}\\right) - I_{\\mathrm{ref}}\n$$\n问题给出了原始相互作用能 $I_{\\mathrm{raw}}$、CP校正相互作用能 $I_{\\mathrm{CP}}$ 和CP位移 $\\Delta_{\\mathrm{CP}}$ 之间的关系为 $I_{\\mathrm{CP}} = I_{\\mathrm{raw}} - \\Delta_{\\mathrm{CP}}$。我们可以重新整理这个关系，用 $I_{\\mathrm{CP}}$ 和 $\\Delta_{\\mathrm{CP}}$ 来表示 $I_{\\mathrm{raw}}$：\n$$\nI_{\\mathrm{raw}} = I_{\\mathrm{CP}} + \\Delta_{\\mathrm{CP}}\n$$\n现在我们将这个 $I_{\\mathrm{raw}}$ 的表达式代入我们关于 $\\varepsilon_{1/2}$ 的方程中：\n$$\n\\varepsilon_{1/2} = \\frac{1}{2}\\left((I_{\\mathrm{CP}} + \\Delta_{\\mathrm{CP}}) + I_{\\mathrm{CP}}\\right) - I_{\\mathrm{ref}}\n$$\n合并括号内的项，得到：\n$$\n\\varepsilon_{1/2} = \\frac{1}{2}\\left(2I_{\\mathrm{CP}} + \\Delta_{\\mathrm{CP}}\\right) - I_{\\mathrm{ref}}\n$$\n分配因子 $\\frac{1}{2}$ 并重新排列各项以分离出所需的依赖关系，我们得到：\n$$\n\\varepsilon_{1/2} = I_{\\mathrm{CP}} + \\frac{1}{2}\\Delta_{\\mathrm{CP}} - I_{\\mathrm{ref}} = \\left(I_{\\mathrm{CP}} - I_{\\mathrm{ref}}\\right) + \\frac{1}{2}\\Delta_{\\mathrm{CP}}\n$$\n这个表达式提供了所需的分解。我们现在可以识别出这两个贡献项。\n\n第一项 $(I_{\\mathrm{CP}} - I_{\\mathrm{ref}})$ 代表了完全CP校正的相互作用能与精确参考值之间的偏差。CP校正旨在消除BSSE。因此，$I_{\\mathrm{CP}}$ 中任何剩余的误差都归因于所选基组的内在缺陷或不完备性。我们将其定义为基组不完备性贡献：\n$$\n\\varepsilon_{\\mathrm{inc}}^{(1/2)} \\equiv I_{\\mathrm{CP}} - I_{\\mathrm{ref}}\n$$\n第二项 $\\frac{1}{2}\\Delta_{\\mathrm{CP}}$ 正是总CP校正量的一半，而总CP校正量是BSSE大小的标准估计量。根据其构造，半CP方法仅校正了估计BSSE的一半。因此，将这第二项解释为在半CP方案中未被校正的残余BSSE是合乎逻辑的：\n$$\n\\varepsilon_{\\mathrm{BSSE}}^{(1/2)} \\equiv \\frac{1}{2}\\Delta_{\\mathrm{CP}}\n$$\n如推导所示，总的半CP误差是这两个组分之和，即 $\\varepsilon_{1/2} = \\varepsilon_{\\mathrm{BSSE}}^{(1/2)} + \\varepsilon_{\\mathrm{inc}}^{(1/2)}$。\n\n每个测试用例的计算步骤如下。给定一组以哈特里为单位的能量 $\\left(E_{AB}^{AB}, E_{A}^{A}, E_{B}^{B}, E_{A}^{AB}, E_{B}^{AB}\\right)$ 和以哈特里为单位的参考相互作用能 $I_{\\mathrm{ref}}$：\n1.  计算CP位移 $\\Delta_{\\mathrm{CP}}$（单位：哈特里）：\n    $$\n    \\Delta_{\\mathrm{CP}} = (E_{A}^{AB} - E_{A}^{A}) + (E_{B}^{AB} - E_{B}^{B})\n    $$\n2.  计算CP校正的相互作用能 $I_{\\mathrm{CP}}$（单位：哈特里）：\n    $$\n    I_{\\mathrm{CP}} = E_{AB}^{AB} - E_{A}^{AB} - E_{B}^{AB}\n    $$\n3.  计算两个误差组分（单位：哈特里）：\n    $$\n    \\varepsilon_{\\mathrm{BSSE}}^{(1/2)} = \\frac{1}{2}\\Delta_{\\mathrm{CP}}\n    $$\n    $$\n    \\varepsilon_{\\mathrm{inc}}^{(1/2)} = I_{\\mathrm{CP}} - I_{\\mathrm{ref}}\n    $$\n4.  将它们相加，计算总的半CP误差 $\\varepsilon_{1/2}$（单位：哈特里）：\n    $$\n    \\varepsilon_{1/2} = \\varepsilon_{\\mathrm{BSSE}}^{(1/2)} + \\varepsilon_{\\mathrm{inc}}^{(1/2)}\n    $$\n5.  使用给定的转换因子 $1\\,\\text{hartree} = 2625.49962\\,\\text{kJ}\\,\\text{mol}^{-1}$，将这三个量从哈特里转换为 $\\text{kJ}\\,\\text{mol}^{-1}$。\n6.  将最终结果（单位：$\\text{kJ}\\,\\text{mol}^{-1}$）四舍五入到六位小数。\n\n此过程将被实现并应用于四个提供的测试用例。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and partitions the half-CP interaction energy error for a series of\n    quantum chemical calculations on a halide-water complex.\n    \"\"\"\n\n    # Conversion factor from Hartree to kJ/mol as specified.\n    H_TO_KJ_MOL = 2625.49962\n\n    # Reference interaction energy in Hartree, common to all test cases.\n    I_ref_hartree = -0.020500\n\n    # Test cases: (E_AB_AB, E_A_A, E_B_B, E_A_AB, E_B_AB) in Hartree.\n    test_cases = [\n        # Test Case 1 (non-augmented, polarized, double-zeta-like)\n        (-536.490000, -460.180000, -76.280000, -460.186000, -76.284000),\n        # Test Case 2 (non-augmented, polarized, triple-zeta-like)\n        (-536.526666, -460.200000, -76.300000, -460.205000, -76.302000),\n        # Test Case 3 (diffuse-augmented, polarized, triple-zeta-like)\n        (-536.542800, -460.210000, -76.310000, -460.211500, -76.310800),\n        # Test Case 4 (diffuse-augmented, polarized, quadruple-zeta-like)\n        (-536.550700, -460.215000, -76.315000, -460.215200, -76.315100),\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        E_AB_AB, E_A_A, E_B_B, E_A_AB, E_B_AB = case\n\n        # 1. Calculate CP shift (Delta_CP) in Hartree.\n        # This is the standard estimator for the Basis Set Superposition Error (BSSE).\n        delta_cp_hartree = (E_A_AB - E_A_A) + (E_B_AB - E_B_B)\n\n        # 2. Calculate CP-corrected interaction energy (I_CP) in Hartree.\n        I_cp_hartree = E_AB_AB - E_A_AB - E_B_AB\n\n        # 3. Calculate the error components in Hartree based on the derivation.\n        # Residual BSSE contribution in half-CP scheme.\n        eps_bsse_half_cp_hartree = 0.5 * delta_cp_hartree\n        # Basis-set incompleteness contribution in half-CP scheme.\n        eps_inc_half_cp_hartree = I_cp_hartree - I_ref_hartree\n        # Total half-CP error, being the sum of the two components.\n        eps_half_cp_hartree = eps_bsse_half_cp_hartree + eps_inc_half_cp_hartree\n\n        # 4. Convert all quantities to kJ/mol.\n        eps_half_cp_kjmol = eps_half_cp_hartree * H_TO_KJ_MOL\n        eps_bsse_half_cp_kjmol = eps_bsse_half_cp_hartree * H_TO_KJ_MOL\n        eps_inc_half_cp_kjmol = eps_inc_half_cp_hartree * H_TO_KJ_MOL\n\n        # 5. Round to six decimal places as required.\n        result_triple = [\n            round(eps_half_cp_kjmol, 6),\n            round(eps_bsse_half_cp_kjmol, 6),\n            round(eps_inc_half_cp_kjmol, 6),\n        ]\n        \n        all_results.append(result_triple)\n\n    # 6. Format the output as a JSON-like string of a list of lists.\n    # The format requires no spaces and specific bracketing.\n    case_strings = [f\"[{res[0]},{res[1]},{res[2]}]\" for res in all_results]\n    final_output = f\"[{','.join(case_strings)}]\"\n    \n    # Print the final formatted string.\n    print(final_output)\n\nsolve()\n```", "id": "2916061"}, {"introduction": "电子激发可以区分为紧凑的价层激发和空间扩展的里德堡激发，后者对于理解光化学和光谱学至关重要。在计算上，若没有包含足够弥散的基函数，描述里德堡态是不可能的。本练习提供了一种定量的、动手实践的方法，通过计算目标轨道的空间尺寸（二阶矩 $\\langle r^2 \\rangle$）和弥散组分，来明确区分这两种类型的激发，并展示弥散函数在其中扮演的关键角色 [@problem_id:2916133]。", "problem": "要求您设计并实现一个数学上自洽的程序，通过检查在有和没有弥散函数增广的情况下氨的玩具模型中的附着密度和轨道特征，来区分价激发和里德堡激发。整个过程使用原子单位，其中长度以玻尔（bohr）为单位，指数以 bohr$^{-2}$ 为单位。所有最终的二阶矩半径必须以 $\\text{bohr}^{2}$ 表示。\n\n该模型如下。考虑一个由归一化的 $s$ 型高斯型轨道（GTO）组成的单中心基组，每个轨道形式为 $\\chi_{p}(\\mathbf{r}) = N(\\alpha_{p}) \\exp(-\\alpha_{p} r^{2})$，中心在原点，其中 $r = \\|\\mathbf{r}\\|$，归一化因子为 $N(\\alpha) = \\left(\\dfrac{2\\alpha}{\\pi}\\right)^{3/4}$。一个分子轨道 $\\phi(\\mathbf{r})$ 是这些基函数的线性组合，$\\phi(\\mathbf{r}) = \\sum_{p=1}^{M} c_{p} \\chi_{p}(\\mathbf{r})$，其中 $M$ 是基元的数量。从一个已占轨道到一个虚拟轨道的单电子激发的附着密度被定义为 $|\\phi_{\\mathrm{virt}}(\\mathbf{r})|^{2}$，它编码了激发后电子的空间特征。\n\n您可以使用的、针对同一中心 $s$ 型函数的基本高斯积分结果如下：\n- 重叠积分 $S_{pq} = \\int \\chi_{p}(\\mathbf{r}) \\chi_{q}(\\mathbf{r}) \\, d^{3}r = \\left(\\dfrac{2\\sqrt{\\alpha_{p}\\alpha_{q}}}{\\alpha_{p}+\\alpha_{q}}\\right)^{3/2}$。\n- 二阶矩积分 $R^{(2)}_{pq} = \\int r^{2}\\,\\chi_{p}(\\mathbf{r}) \\chi_{q}(\\mathbf{r}) \\, d^{3}r = S_{pq}\\,\\dfrac{3}{2(\\alpha_{p}+\\alpha_{q})}$。\n\n给定一个系数向量 $\\mathbf{c} \\in \\mathbb{R}^{M}$ 以及矩阵 $S = [S_{pq}]$ 和 $R^{(2)} = [R^{(2)}_{pq}]$，附着密度（等同于虚拟轨道）的二阶矩为\n$$\\langle r^{2} \\rangle_{\\mathrm{attach}} = \\frac{\\mathbf{c}^{\\mathsf{T}} R^{(2)} \\mathbf{c}}{\\mathbf{c}^{\\mathsf{T}} S \\mathbf{c}},$$\n其结果必须以 $\\text{bohr}^{2}$ 报告。一个轨道在指定的弥散基元索引集 $\\mathcal{D}$ 上的类马利肯弥散分数的定义为\n$$ f_{\\mathrm{diffuse}} = \\frac{\\sum_{p\\in \\mathcal{D}} \\sum_{q=1}^{M} c_{p}\\,c_{q}\\,S_{pq}}{\\sum_{p=1}^{M} \\sum_{q=1}^{M} c_{p}\\,c_{q}\\,S_{pq}}. $$\n\n对于下面的每个测试用例，您将获得：\n- 一组纯价指数集 $\\{\\alpha_{v}\\}$。\n- 一组增广的弥散指数集 $\\{\\alpha_{d}\\}$，它将被附加到价集上以形成增广基组。\n- 增广基组中的两个未归一化系数列表：一个用于已占价分子轨道 $\\mathbf{c}_{\\mathrm{occ}}^{\\mathrm{aug}}$，另一个用于虚拟目标轨道 $\\mathbf{c}_{\\mathrm{virt}}^{\\mathrm{aug}}$。\n- 两个阈值 $r^{2}_{\\mathrm{cut}}$（单位为 $\\text{bohr}^{2}$）和 $f_{\\mathrm{cut}}$（无单位，以小数表示）。\n\n您的程序必须为每个测试用例执行以下操作：\n1. 通过拼接 $\\{\\alpha_{v}\\}$ 和 $\\{\\alpha_{d}\\}$（先价指数，后弥散指数）来构建增广基组。使用上述公式为该增广基组构建 $S$ 和 $R^{(2)}$。\n2. 根据 $S$ 度量对 $\\mathbf{c}_{\\mathrm{occ}}^{\\mathrm{aug}}$ 和 $\\mathbf{c}_{\\mathrm{virt}}^{\\mathrm{aug}}$ 进行归一化，即缩放 $\\mathbf{c}$ 以使 $\\mathbf{c}^{\\mathsf{T}} S \\mathbf{c} = 1$。\n3. 使用与附加的弥散基元相对应的弥散索引集 $\\mathcal{D}$，从归一化的 $\\mathbf{c}_{\\mathrm{virt}}^{\\mathrm{aug}}$ 计算增广情况下的附着二阶矩 $\\langle r^{2} \\rangle_{\\mathrm{attach}}^{\\mathrm{aug}}$ 和弥散分数 $f_{\\mathrm{diffuse}}^{\\mathrm{aug}}$。\n4. 通过丢弃弥散基元并将系数向量截断至价块来构建非增广（纯价）基组，然后使用纯价重叠矩阵重新归一化。计算非增广情况下的附着二阶矩 $\\langle r^{2} \\rangle_{\\mathrm{attach}}^{\\mathrm{noaug}}$。定义 $f_{\\mathrm{diffuse}}^{\\mathrm{noaug}} = 0$，因为不存在弥散基元。\n5. 当且仅当 $\\langle r^{2} \\rangle_{\\mathrm{attach}}^{\\mathrm{aug}} \\ge r^{2}_{\\mathrm{cut}}$ 且 $f_{\\mathrm{diffuse}}^{\\mathrm{aug}} \\ge f_{\\mathrm{cut}}$ 时，将增广基组中的激发分类为“里德堡”（Rydberg）。否则，将其分类为“价”（valence）。以整数形式报告此分类，里德堡为 $1$，价为 $0$。\n6. 计算 $\\Delta r^{2} = \\langle r^{2} \\rangle_{\\mathrm{attach}}^{\\mathrm{aug}} - \\langle r^{2} \\rangle_{\\mathrm{attach}}^{\\mathrm{noaug}}$，单位为 $\\text{bohr}^{2}$。\n\n测试套件。使用以下四个测试用例；每个列表按（价指数、弥散指数、增广基组中的已占轨道系数、增广基组中的虚拟轨道系数、$r^{2}_{\\mathrm{cut}}$、$f_{\\mathrm{cut}}$）的顺序列出：\n- 案例 1（理想情况，增广后呈强里德堡特征）：\n  - $\\{\\alpha_{v}\\} = \\{1.6, 0.5\\}$, $\\{\\alpha_{d}\\} = \\{0.08, 0.03\\}$,\n  - $\\mathbf{c}_{\\mathrm{occ}}^{\\mathrm{aug}} = (0.8, 1.0, 0.05, 0.02)$,\n  - $\\mathbf{c}_{\\mathrm{virt}}^{\\mathrm{aug}} = (0.1, 0.2, 1.0, 0.9)$,\n  - $r^{2}_{\\mathrm{cut}} = 8.0$ $\\text{bohr}^{2}$, $f_{\\mathrm{cut}} = 0.6$.\n- 案例 2（类价虚拟轨道，存在增广但不重要）：\n  - $\\{\\alpha_{v}\\} = \\{1.6, 0.6\\}$, $\\{\\alpha_{d}\\} = \\{0.1\\}$,\n  - $\\mathbf{c}_{\\mathrm{occ}}^{\\mathrm{aug}} = (0.9, 1.0, 0.0)$,\n  - $\\mathbf{c}_{\\mathrm{virt}}^{\\mathrm{aug}} = (0.7, 0.8, 0.1)$,\n  - $r^{2}_{\\mathrm{cut}} = 6.0$ $\\text{bohr}^{2}$, $f_{\\mathrm{cut}} = 0.5$.\n- 案例 3（价特征和弥散特征的临界混合）：\n  - $\\{\\alpha_{v}\\} = \\{1.2, 0.4\\}$, $\\{\\alpha_{d}\\} = \\{0.08\\}$,\n  - $\\mathbf{c}_{\\mathrm{occ}}^{\\mathrm{aug}} = (0.9, 1.1, 0.05)$,\n  - $\\mathbf{c}_{\\mathrm{virt}}^{\\mathrm{aug}} = (0.45, 0.50, 0.45)$,\n  - $r^{2}_{\\mathrm{cut}} = 6.0$ $\\text{bohr}^{2}$, $f_{\\mathrm{cut}} = 0.5$.\n- 案例 4（具有极度弥散增广的边缘情况）：\n  - $\\{\\alpha_{v}\\} = \\{1.8\\}$, $\\{\\alpha_{d}\\} = \\{0.02\\}$,\n  - $\\mathbf{c}_{\\mathrm{occ}}^{\\mathrm{aug}} = (1.0, 0.01)$,\n  - $\\mathbf{c}_{\\mathrm{virt}}^{\\mathrm{aug}} = (0.05, 1.0)$,\n  - $r^{2}_{\\mathrm{cut}} = 12.0$ $\\text{bohr}^{2}$, $f_{\\mathrm{cut}} = 0.8$.\n\n最终输出格式。您的程序必须生成单行，其中包含一个列表，其条目按顺序对应每个测试用例：\n- $\\langle r^{2} \\rangle_{\\mathrm{attach}}^{\\mathrm{aug}}$ (浮点数，单位 $\\text{bohr}^{2}$)，\n- $f_{\\mathrm{diffuse}}^{\\mathrm{aug}}$ (浮点数，无单位)，\n- $\\langle r^{2} \\rangle_{\\mathrm{attach}}^{\\mathrm{noaug}}$ (浮点数，单位 $\\text{bohr}^{2}$)，\n- $f_{\\mathrm{diffuse}}^{\\mathrm{noaug}}$ (浮点数，恒为 $0$)，\n- $\\Delta r^{2}$ (浮点数，单位 $\\text{bohr}^{2}$)，\n- 分类整数（里德堡为 $1$，价为 $0$）。\n\n因此，对于这 4 个案例，程序应打印出形如 $[x_{1},x_{2},\\dots,x_{24}]$ 的单行，其中条目按上述顺序排列。所有二阶矩量必须以 $\\text{bohr}^{2}$ 为单位，所有分数必须是小数（无百分号）。此问题不涉及角度。计算必须是完全确定性的，并且不需要任何用户输入。", "solution": "所提出的问题是计算量子化学中一个有效且自洽的练习。它要求实现一个简化模型，根据目标分子轨道的空间范围来分析和分类电子激发。该模型虽然是一个玩具表示，但建立在量子力学的可靠和标准原理之上，即使用高斯型轨道（GTO）作为基组，并从在此基组中构建的波函数计算电子性质。所有必要的定义、公式和数据均已提供，逻辑上没有矛盾或含糊之处。我们开始进行解答。\n\n该模型的基本组成部分是原子基函数、分子轨道（MO）以及物理性质的算符。该基组由归一化的、单中心的 $s$ 型 GTO $\\chi_{p}(\\mathbf{r})$ 组成，由指数 $\\alpha_{p}$ 定义：\n$$ \\chi_{p}(\\mathbf{r}) = \\left(\\frac{2\\alpha_{p}}{\\pi}\\right)^{3/4} \\exp(-\\alpha_{p} r^{2}) $$\n一个分子轨道 $\\phi(\\mathbf{r})$ 是这些基函数的线性组合：\n$$ \\phi(\\mathbf{r}) = \\sum_{p=1}^{M} c_{p} \\chi_{p}(\\mathbf{r}) $$\n其中 $\\mathbf{c} = (c_1, c_2, \\dots, c_M)^{\\mathsf{T}}$ 是在 $M$ 个 GTO 基组中的分子轨道系数向量。\n\n轨道性质的分析需要在 GTO 基组中计算算符的矩阵元。问题提供了重叠矩阵 $S$ 和二阶矩半径矩阵 $R^{(2)}$ 的必要解析公式：\n$$ S_{pq} = \\int \\chi_{p}(\\mathbf{r}) \\chi_{q}(\\mathbf{r}) \\, d^{3}r = \\left(\\frac{2\\sqrt{\\alpha_{p}\\alpha_{q}}}{\\alpha_{p}+\\alpha_{q}}\\right)^{3/2} $$\n$$ R^{(2)}_{pq} = \\int r^{2}\\,\\chi_{p}(\\mathbf{r}) \\chi_{q}(\\mathbf{r}) \\, d^{3}r = S_{pq}\\,\\frac{3}{2(\\alpha_{p}+\\alpha_{q})} $$\n对于由系数向量 $\\mathbf{c}$ 描述的轨道，其半径平方的期望值 $\\langle r^2 \\rangle$ 由非正交基中的期望值通用公式给出：\n$$ \\langle r^{2} \\rangle = \\frac{\\int \\phi^{*}(\\mathbf{r}) r^2 \\phi(\\mathbf{r}) \\, d^3r}{\\int \\phi^{*}(\\mathbf{r}) \\phi(\\mathbf{r}) \\, d^3r} = \\frac{\\mathbf{c}^{\\mathsf{T}} R^{(2)} \\mathbf{c}}{\\mathbf{c}^{\\mathsf{T}} S \\mathbf{c}} $$\n分母 $\\mathbf{c}^{\\mathsf{T}} S \\mathbf{c}$ 是分子轨道的模方。对于一个归一化的轨道，此分母为 $1$，从而简化了表达式。归一化条件是 $\\mathbf{c}^{\\mathsf{T}} S \\mathbf{c} = 1$。一个未归一化的系数向量 $\\mathbf{c}_{\\mathrm{unnorm}}$ 通过缩放进行归一化：$\\mathbf{c}_{\\mathrm{norm}} = \\mathbf{c}_{\\mathrm{unnorm}} / \\sqrt{\\mathbf{c}_{\\mathrm{unnorm}}^{\\mathsf{T}} S \\mathbf{c}_{\\mathrm{unnorm}}}$。\n\n该问题通过关注虚拟（目标）轨道 $\\phi_{\\mathrm{virt}}$ 的特征来模拟电子激发。附着密度定义为 $|\\phi_{\\mathrm{virt}}(\\mathbf{r})|^2$，其空间范围由 $\\langle r^2 \\rangle_{\\text{attach}} = \\langle r^2 \\rangle_{\\phi_{\\text{virt}}}$ 量化，作为一个主要度量标准。大的 $\\langle r^2 \\rangle$ 表示一个弥散的、类里德堡轨道，而较小的 $\\langle r^2 \\rangle$ 则表明一个更紧凑的、类价轨道。\n\n第二个度量标准，即弥散分数 $f_{\\mathrm{diffuse}}$，量化了指定的一组弥散基函数（那些具有小指数 $\\alpha_p$ 的函数）对分子轨道的贡献。所给出的定义是总电子密度的一个类马利肯划分：\n$$ f_{\\mathrm{diffuse}} = \\frac{\\sum_{p\\in \\mathcal{D}} \\sum_{q=1}^{M} c_{p}\\,c_{q}\\,S_{pq}}{\\mathbf{c}^{\\mathsf{T}} S \\mathbf{c}} $$\n其中 $\\mathcal{D}$ 是弥散基元的索引集。对于一个归一化的分子轨道，分母为 $1$。分子可以高效计算：令 $\\mathbf{v} = S \\mathbf{c}$；则分子为 $\\sum_{p \\in \\mathcal{D}} c_p v_p$。\n\n每个测试用例的计算过程如下：\n1.  **构建基组和矩阵**：通过拼接价指数 $\\{\\alpha_v\\}$ 和弥散指数 $\\{\\alpha_d\\}$ 形成增广基组。设 $N_v$ 是价函数的数量，$M$ 是函数的总数。构建大小为 $M \\times M$ 的增广重叠矩阵 $S^{\\mathrm{aug}}$ 和二阶矩矩阵 $(R^{(2)})^{\\mathrm{aug}}$。纯价矩阵 $S^{\\mathrm{noaug}}$ 和 $(R^{(2)})^{\\mathrm{noaug}}$ 是增广矩阵的左上角 $N_v \\times N_v$ 子块。\n\n2.  **处理轨道**：问题为已占轨道和虚拟轨道提供了未归一化的系数向量 $\\mathbf{c}_{\\mathrm{occ}}^{\\mathrm{aug}}$ 和 $\\mathbf{c}_{\\mathrm{virt}}^{\\mathrm{aug}}$。指令要求对两者都进行归一化。必须注意，只有虚拟轨道的性质用于最终的分类和输出。对已占轨道的处理按指令执行，但仅作为程序性检查。\n    \n    对于虚拟轨道：\n    a.  **增广情况**：使用 $S^{\\mathrm{aug}}$ 对向量 $\\mathbf{c}_{\\mathrm{virt}}^{\\mathrm{aug}}$ 进行归一化。使用归一化后的向量，计算 $\\langle r^{2} \\rangle_{\\mathrm{attach}}^{\\mathrm{aug}}$ 和 $f_{\\mathrm{diffuse}}^{\\mathrm{aug}}$。用于弥散分数的集合 $\\mathcal{D}$ 由对应于 $\\{\\alpha_d\\}$ 的索引组成。\n    b.  **非增广情况**：将向量 $\\mathbf{c}_{\\mathrm{virt}}^{\\mathrm{aug}}$ 截断为其前 $N_v$ 个分量，得到 $\\mathbf{c}_{\\mathrm{virt}}^{\\mathrm{noaug}}$。使用 $S^{\\mathrm{noaug}}$ 对该向量进行重新归一化。然后，计算 $\\langle r^{2} \\rangle_{\\mathrm{attach}}^{\\mathrm{noaug}}$。根据定义，由于该基组中没有弥散函数，因此 $f_{\\mathrm{diffuse}}^{\\mathrm{noaug}} = 0$。\n\n3.  **分类和报告**：当且仅当 $\\langle r^{2} \\rangle_{\\mathrm{attach}}^{\\mathrm{aug}} \\ge r^{2}_{\\mathrm{cut}}$ 且 $f_{\\mathrm{diffuse}}^{\\mathrm{aug}} \\ge f_{\\mathrm{cut}}$ 时，将激发分类为里德堡（输出 $1$）。否则，将其分类为价（输出 $0$）。计算二阶矩的变化量 $\\Delta r^{2} = \\langle r^{2} \\rangle_{\\mathrm{attach}}^{\\mathrm{aug}} - \\langle r^{2} \\rangle_{\\mathrm{attach}}^{\\mathrm{noaug}}$。对每个案例，将最终的六个量——$\\langle r^{2} \\rangle_{\\mathrm{attach}}^{\\mathrm{aug}}$、$f_{\\mathrm{diffuse}}^{\\mathrm{aug}}$、$\\langle r^{2} \\rangle_{\\mathrm{attach}}^{\\mathrm{noaug}}$、$f_{\\mathrm{diffuse}}^{\\mathrm{noaug}}$、$\\Delta r^{2}$ 和分类整数——进行汇总。\n\n将基本的量子化学原理系统地应用于所提供的数据，可以得到一个确定性且可验证的解。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the quantum chemistry problem for all test cases.\n    \"\"\"\n    \n    test_cases = [\n        # Case 1 (happy path, strongly Rydberg under augmentation)\n        {\n            \"alpha_v\": [1.6, 0.5], \"alpha_d\": [0.08, 0.03],\n            \"c_occ_aug\": [0.8, 1.0, 0.05, 0.02],\n            \"c_virt_aug\": [0.1, 0.2, 1.0, 0.9],\n            \"r2_cut\": 8.0, \"f_cut\": 0.6\n        },\n        # Case 2 (valence-like virtual, augmentation present but unimportant)\n        {\n            \"alpha_v\": [1.6, 0.6], \"alpha_d\": [0.1],\n            \"c_occ_aug\": [0.9, 1.0, 0.0],\n            \"c_virt_aug\": [0.7, 0.8, 0.1],\n            \"r2_cut\": 6.0, \"f_cut\": 0.5\n        },\n        # Case 3 (borderline mixture of valence and diffuse character)\n        {\n            \"alpha_v\": [1.2, 0.4], \"alpha_d\": [0.08],\n            \"c_occ_aug\": [0.9, 1.1, 0.05],\n            \"c_virt_aug\": [0.45, 0.50, 0.45],\n            \"r2_cut\": 6.0, \"f_cut\": 0.5\n        },\n        # Case 4 (edge case with extremely diffuse augmentation)\n        {\n            \"alpha_v\": [1.8], \"alpha_d\": [0.02],\n            \"c_occ_aug\": [1.0, 0.01],\n            \"c_virt_aug\": [0.05, 1.0],\n            \"r2_cut\": 12.0, \"f_cut\": 0.8\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        case_results = process_case(case)\n        results.extend(case_results)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef build_matrices(alphas):\n    \"\"\"\n    Constructs overlap (S) and second-moment-radius (R2) matrices.\n    \n    Args:\n        alphas (list of float): List of Gaussian exponents.\n        \n    Returns:\n        (np.ndarray, np.ndarray): The S and R2 matrices.\n    \"\"\"\n    n = len(alphas)\n    S = np.zeros((n, n))\n    R2 = np.zeros((n, n))\n    \n    for i in range(n):\n        for j in range(n):\n            ap = alphas[i]\n            aq = alphas[j]\n            \n            S_pq = (2 * np.sqrt(ap * aq) / (ap + aq))**1.5\n            R2_pq = S_pq * 1.5 / (ap + aq)\n            \n            S[i, j] = S_pq\n            R2[i, j] = R2_pq\n            \n    return S, R2\n\ndef normalize_coeffs(c, S):\n    \"\"\"Normalizes a coefficient vector with respect to the overlap matrix S.\"\"\"\n    norm_sq = c.T @ S @ c\n    if norm_sq == 0: # Should not happen with valid positive definite S\n        raise ValueError(\"Non-positive norm squared.\")\n    return c / np.sqrt(norm_sq)\n\ndef process_case(case_data):\n    \"\"\"\n    Processes a single test case according to the problem specification.\n    \n    Args:\n        case_data (dict): A dictionary containing all data for one test case.\n        \n    Returns:\n        list of float: The 6 result values for the case.\n    \"\"\"\n    alpha_v = case_data[\"alpha_v\"]\n    alpha_d = case_data[\"alpha_d\"]\n    c_occ_aug_unnorm = np.array(case_data[\"c_occ_aug\"])\n    c_virt_aug_unnorm = np.array(case_data[\"c_virt_aug\"])\n    r2_cut = case_data[\"r2_cut\"]\n    f_cut = case_data[\"f_cut\"]\n\n    n_v = len(alpha_v)\n    n_d = len(alpha_d)\n    M = n_v + n_d\n    \n    alpha_aug = alpha_v + alpha_d\n    \n    # 1. Build augmented basis matrices\n    S_aug, R2_aug = build_matrices(alpha_aug)\n\n    # Extract non-augmented (valence-only) sub-matrices\n    S_noaug = S_aug[:n_v, :n_v]\n    R2_noaug = R2_aug[:n_v, :n_v]\n    \n    # 2. Normalize both occupied and virtual orbitals (as per instructions)\n    # The occupied orbital calculations are performed for procedural completeness\n    # but are not used in the final output values.\n    _ = normalize_coeffs(c_occ_aug_unnorm, S_aug)\n    c_occ_noaug_unnorm = c_occ_aug_unnorm[:n_v]\n    if n_v > 0:\n        _ = normalize_coeffs(c_occ_noaug_unnorm, S_noaug)\n\n    # Process the virtual orbital for the required outputs\n    # Augmented case\n    c_virt_aug_norm = normalize_coeffs(c_virt_aug_unnorm, S_aug)\n    \n    # 3. Compute augmented-case metrics\n    r2_attach_aug = c_virt_aug_norm.T @ R2_aug @ c_virt_aug_norm\n    \n    # Denominator for f_diffuse is 1 due to normalization\n    norm_check_aug = c_virt_aug_norm.T @ S_aug @ c_virt_aug_norm\n    \n    # Numerator of f_diffuse\n    v_vec = S_aug @ c_virt_aug_norm\n    diffuse_indices = range(n_v, M)\n    f_diffuse_num = np.dot(c_virt_aug_norm[diffuse_indices], v_vec[diffuse_indices])\n    f_diffuse_aug = f_diffuse_num / norm_check_aug\n\n    # 4. Compute non-augmented case metrics\n    c_virt_noaug_unnorm = c_virt_aug_unnorm[:n_v]\n    if n_v > 0:\n        c_virt_noaug_norm = normalize_coeffs(c_virt_noaug_unnorm, S_noaug)\n        r2_attach_noaug = c_virt_noaug_norm.T @ R2_noaug @ c_virt_noaug_norm\n    else: # Should not happen based on test cases\n        r2_attach_noaug = 0.0\n\n    f_diffuse_noaug = 0.0\n    \n    # 5. Classify the excitation\n    is_rydberg = (r2_attach_aug >= r2_cut and f_diffuse_aug >= f_cut)\n    classification = 1 if is_rydberg else 0\n    \n    # 6. Compute delta r^2\n    delta_r2 = r2_attach_aug - r2_attach_noaug\n\n    return [\n        r2_attach_aug,\n        f_diffuse_aug,\n        r2_attach_noaug,\n        f_diffuse_noaug,\n        delta_r2,\n        classification\n    ]\n\nsolve()\n```", "id": "2916133"}]}