{"hands_on_practices": [{"introduction": "在将相互作用能分解为其物理组分之前，我们必须首先获得一个可靠的总相互作用能数值。这个基础实践旨在解决基组叠加误差（Basis Set Superposition Error, BSSE）的挑战，这是一种会人为地夸大结合能的计算赝象。通过应用Boys-Bernardi反势校正方法，您将学习如何分离并消除这种误差，这是任何有意义的能量分解分析都不可或缺的关键第一步。[@problem_id:2889721]", "problem": "在Born–Oppenheimer近似下，研究了一个由片段$\\mathrm{A}$和$\\mathrm{B}$组成的模型二聚体，其几何构型固定。在相同的电子结构理论水平上，对复合物和孤立片段分别使用片段局域基组和二聚体增广基组，获得了单点电子能量（单位为哈特里），以探究基组叠加误差（BSSE）。提供了以下量：\n- 在二聚体基组下的复合物能量：$E_{\\mathrm{AB}} = -152.438765$。\n- 在各自单体基组下的片段能量：$E_{\\mathrm{A}}^{\\mathrm{A}} = -76.211345$，$E_{\\mathrm{B}}^{\\mathrm{B}} = -76.120987$。\n- 在包含鬼函数（Boys–Bernardi反势校正方案）的完整二聚体基组下的片段能量：$E_{\\mathrm{A}}^{\\mathrm{AB}} = -76.223456$，$E_{\\mathrm{B}}^{\\mathrm{AB}} = -76.132001$。\n\n从超分子相互作用能的基本定义和基组叠加误差的物理起源出发，构建一个逻辑一致的方案，用于报告经过和未经反势校正的相互作用能。然后，将此方案应用于上述数值，以获得两个值：未校正的超分子相互作用能和经Boys–Bernardi反势校正的相互作用能。使用精确转换关系 $1$ 哈特里 $= 2625.49962\\ \\mathrm{kJ\\,mol^{-1}}$，将两个答案均以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位表示，并将每个值四舍五入至四位有效数字。\n\n在你的推导过程中，用不超过一个简短段落的篇幅进行论证，将你的方案与能量分解分析（EDA）的一般目标联系起来，并解释报告经过与未经反势校正的相互作用能在解释上的差异，重点说明校正减轻了何种物理效应以及可能仍然存在哪些潜在偏差。\n\n将你的最终两个数值结果以有序对 $\\big(E_{\\mathrm{int}}^{\\text{uncorrected}},\\ E_{\\mathrm{int}}^{\\text{CP}}\\big)$ 的形式报告，单位为 $\\mathrm{kJ\\,mol^{-1}}$，并按要求四舍五入。在最终的方框答案中不要包含单位。", "solution": "该问题具有科学依据，提法明确，并为得到唯一解提供了所有必要信息。所提供的能量值与变分原理一致，即在更大的基组中计算时，片段的能量会降低（$E_{\\mathrm{A}}^{\\mathrm{AB}}  E_{\\mathrm{A}}^{\\mathrm{A}}$ 且 $E_{\\mathrm{B}}^{\\mathrm{AB}}  E_{\\mathrm{B}}^{\\mathrm{B}}$）。因此，我将继续进行分析。\n\n根本目标是确定超分子相互作用能 $E_{\\mathrm{int}}$，其定义为由孤立、不相互作用的片段 $\\mathrm{A}$ 和 $\\mathrm{B}$ 形成复合物 $\\mathrm{AB}$ 时的能量变化：\n$$E_{\\mathrm{int}} = E(\\text{复合物}) - \\sum E(\\text{孤立片段})$$\n在量子化学中，由于使用有限的、以原子为中心的基组，该量的计算变得复杂，并由此产生了基组叠加误差（BSSE）。该方案必须解决这一人为误差。\n\n首先，我们构建未校正的相互作用能 $E_{\\mathrm{int}}^{\\text{uncorrected}}$。这是该定义最直接但也是最朴素的应用。在这种方法中，将在完整二聚体基组中计算的复合物能量 $E_{\\mathrm{AB}}$（复合体系上的上标 $\\mathrm{AB}$ 是隐含的）与孤立片段能量之和 $E_{\\mathrm{A}}^{\\mathrm{A}} + E_{\\mathrm{B}}^{\\mathrm{B}}$ 进行比较，其中每个片段的能量仅使用其自身的以单体为中心的基组进行计算。\n其公式为：\n$$E_{\\mathrm{int}}^{\\text{uncorrected}} = E_{\\mathrm{AB}} - (E_{\\mathrm{A}}^{\\mathrm{A}} + E_{\\mathrm{B}}^{\\mathrm{B}})$$\n这种方法存在根本性缺陷，因为与在超分子复合物中相比，孤立的片段 $\\mathrm{A}$ 和 $\\mathrm{B}$ 是用更小、灵活性更差的基组来描述的。在复合物内部，片段 $\\mathrm{A}$ 可以“借用”片段 $\\mathrm{B}$ 的基函数来降低其能量，反之亦然。这是一种非物理的稳定化效应，是基组不完备性导致的人为误差，称为BSSE。\n\n为了纠正这一点，我们构建了经Boys–Bernardi反势（CP）校正的相互作用能 $E_{\\mathrm{int}}^{\\text{CP}}$。该方案的逻辑是在*完全相同*的基组——即完整二聚体的基组——内评估所有物质（$E_{\\mathrm{AB}}$、$E_{\\mathrm{A}}$、$E_{\\mathrm{B}}$）的能量。这是通过在片段 $\\mathrm{B}$ 的基函数（称为“鬼”轨道，没有原子核或电子）存在的情况下计算片段 $\\mathrm{A}$ 的能量，得到 $E_{\\mathrm{A}}^{\\mathrm{AB}}$，并对片段 $\\mathrm{B}$ 进行类似操作以获得 $E_{\\mathrm{B}}^{\\mathrm{AB}}$ 来实现的。这确保了复合物和片段的基组是平衡的，从而消除了由BSSE引起的人为稳定化效应。\n经CP校正的公式为：\n$$E_{\\mathrm{int}}^{\\text{CP}} = E_{\\mathrm{AB}} - (E_{\\mathrm{A}}^{\\mathrm{AB}} + E_{\\mathrm{B}}^{\\mathrm{AB}})$$\n\n这个确定可靠相互作用能的方案是任何能量分解分析（EDA）方案必需的第一步。EDA方法将总相互作用能 $E_{\\mathrm{int}}$ 分解为物理上不同的组分，例如静电、交换-排斥、诱导/极化和色散/电荷转移。使用未校正的能量 $E_{\\mathrm{int}}^{\\text{uncorrected}}$ 作为EDA的输入将是一个严重错误，因为它将真实的物理相互作用与BSSE人为误差混为一谈，导致对结合能的高估和对其组分的错误解释。经反势校正的值 $E_{\\mathrm{int}}^{\\text{CP}}$ 通过减轻基组不平衡问题，为相互作用能提供了一个在物理上更为合理的估计。然而，必须指出，即使是 $E_{\\mathrm{int}}^{\\text{CP}}$ 也是一个依赖于模型的量，其准确性受所选理论水平和基组的限制，并且校正方案本身也并非完美。固定的几何构型约束也忽略了将单体变形为其在复合物中构型所需的能量。\n\n我们现在将此方案应用于给定数据。转换因子为 $C = 2625.49962\\ \\mathrm{kJ\\,mol^{-1}}\\,\\mathrm{hartree^{-1}}$。\n给定的能量（单位为哈特里）是：\n$E_{\\mathrm{AB}} = -152.438765$\n$E_{\\mathrm{A}}^{\\mathrm{A}} = -76.211345$\n$E_{\\mathrm{B}}^{\\mathrm{B}} = -76.120987$\n$E_{\\mathrm{A}}^{\\mathrm{AB}} = -76.223456$\n$E_{\\mathrm{B}}^{\\mathrm{AB}} = -76.132001$\n\n未校正相互作用能的计算：\n$$E_{\\mathrm{int}}^{\\text{uncorrected}} = -152.438765 - (-76.211345 + (-76.120987))$$\n$$E_{\\mathrm{int}}^{\\text{uncorrected}} = -152.438765 - (-152.332332) = -0.106433\\ \\text{hartree}$$\n以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位：\n$$E_{\\mathrm{int}}^{\\text{uncorrected}} = -0.106433 \\times 2625.49962 = -279.4310... \\approx -279.4\\ \\mathrm{kJ\\,mol^{-1}}$$\n\n反势校正后相互作用能的计算：\n$$E_{\\mathrm{int}}^{\\text{CP}} = -152.438765 - (-76.223456 + (-76.132001))$$\n$$E_{\\mathrm{int}}^{\\text{CP}} = -152.438765 - (-152.355457) = -0.083308\\ \\text{hartree}$$\n以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位：\n$$E_{\\mathrm{int}}^{\\text{CP}} = -0.083308 \\times 2625.49962 = -218.7186... \\approx -218.7\\ \\mathrm{kJ\\,mol^{-1}}$$\n\n需要报告的两个值是 $E_{\\mathrm{int}}^{\\text{uncorrected}} = -279.4\\ \\mathrm{kJ\\,mol^{-1}}$ 和 $E_{\\mathrm{int}}^{\\text{CP}} = -218.7\\ \\mathrm{kJ\\,mol^{-1}}$。BSSE的大小是两者之差，约为 $60.7\\ \\mathrm{kJ\\,mol^{-1}}$，这突显了该校正的至关重要性。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-279.4  -218.7\n\\end{pmatrix}\n}\n$$", "id": "2889721"}, {"introduction": "能量分解分析为我们讨论分子间作用力提供了一套有力的语汇，但抽象的术语有时可能会掩盖其背后的物理实质。本练习通过将量子力学中的诱导能组分 $E_{\\mathrm{ind}}^{(2)}$ 与一个具体的经典静电模型联系起来，从而架起一座沟通的桥梁。通过为一个模型化的水二聚体计算诱导能，您将为相互极化如何促成分子结合建立起具体的物理直觉。[@problem_id:2889700]", "problem": "在量子化学的能量分解分析中，对称匹配微扰理论 (SAPT) 划分将一个记为 $E_{\\mathrm{ind}}^{(2)}$ 的二阶诱导项，归因于相互作用单体相互极化所产生的稳定化作用。考虑一个氢键连接的水二聚体，它被模拟为两个刚性单体 $A$ 和 $B$，并理想化为位于其中心的点永久偶极子，沿着分子间的氧-氧轴共线排列。分子间距为 $R = 2.98\\,\\text{\\AA}$，且两个永久偶极矩矢量均与该轴共线。假设每个单体的永久偶极矩大小为 $\\mu_{A} = \\mu_{B} = 1.85\\,\\mathrm{D}$，各向同性静态极化率为 $\\alpha_{A} = \\alpha_{B} = 1.45\\,\\text{\\AA}^{3}$。忽略所有高阶多极子、交换-诱导、穿透和阻尼效应，并将极化响应视为线性的。\n\n从经典静电学和线性响应出发，将相互极化模拟至领头阶，并推导二聚体的二阶诱导能 $E_{\\mathrm{ind}}^{(2)}$ 关于 $\\alpha$、$\\mu$ 和 $R$ 的表达式。使用原子单位对场-偶极子相互作用进行数值计算，然后转换为摩尔能量单位。使用以下转换数据：\n- $1\\,\\mathrm{D} = 0.393430307$ 原子单位偶极矩，\n- $1\\,\\text{\\AA} = 1.889726125\\,a_{0}$，\n- $1\\,\\text{\\AA}^{3} = (1.889726125)^{3}\\,a_{0}^{3}$，\n- $1\\,\\text{hartree} = 2625.49962\\,\\mathrm{kJ\\,mol^{-1}}$。\n\n仅供定性参考，文献中报道的处于平衡位置附近氢键水二聚体的 SAPT 二阶诱导能的典型值在 $-4$ 到 $-8\\,\\mathrm{kJ\\,mol^{-1}}$ 范围内。\n\n计算此模型的 $E_{\\mathrm{ind}}^{(2)}$ 的数值。以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位表示你的最终答案，并四舍五入到三位有效数字。", "solution": "首先对问题进行验证。\n\n**步骤1：提取已知条件**\n- **系统**：氢键连接的水二聚体，被模拟为两个刚性单体 $A$ 和 $B$。\n- **模型**：位于其中心的点永久偶极子，沿分子间的氧-氧轴共线排列。\n- **分子间距**：$R = 2.98\\,\\text{\\AA}$。\n- **永久偶极矩大小**：$\\mu_{A} = \\mu_{B} = 1.85\\,\\mathrm{D}$。\n- **各向同性静态极化率**：$\\alpha_{A} = \\alpha_{B} = 1.45\\,\\text{\\AA}^{3}$。\n- **近似**：忽略高阶多极子、交换-诱导、穿透和阻尼效应。将极化响应视为线性的。\n- **目标**：推导二阶诱导能 $E_{\\mathrm{ind}}^{(2)}$ 的表达式，并计算其数值，单位为 $\\mathrm{kJ\\,mol^{-1}}$，四舍五入到三位有效数字。\n- **转换数据**：\n    - $1\\,\\mathrm{D} = 0.393430307$ 原子单位偶极矩 ($e\\,a_0$)。\n    - $1\\,\\text{\\AA} = 1.889726125\\,a_{0}$。\n    - $1\\,\\text{\\AA}^{3} = (1.889726125)^{3}\\,a_{0}^{3}$。\n    - $1\\,\\text{hartree} = 2625.49962\\,\\mathrm{kJ\\,mol^{-1}}$。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：问题使用了一个简化但标准的经典静电模型来近似一个量子力学能量分量。在物理化学中，这是一种用于教学目的和解释计算结果的常用且有效的方法。该模型基于静电学的基本原理。\n- **良构性**：问题是自洽的，提供了所有必要的物理量和转换因子。目标陈述清晰。可以从所提供的信息中确定一个唯一的解。\n- **客观性**：问题以精确的技术语言陈述，没有主观性或歧义。\n- **结论**：问题具有科学依据、良构性、客观性，并且不包含可辨别的缺陷。因此，它被认为是 **有效的**。\n\n**步骤3：推导与求解**\n在此模型中，二阶诱导能 $E_{\\mathrm{ind}}^{(2)}$ 是每个单体因另一个单体的静电场极化而产生的稳定化能之和。我们将在原子单位制中进行推导，其中库仑常数 $\\frac{1}{4\\pi\\epsilon_0}$ 等于 $1$。\n\n设单体 $A$ 位于原点，单体 $B$ 位于沿z轴距离 $R$ 处。问题陈述了永久偶极矩 $\\vec{\\mu}_A$ 和 $\\vec{\\mu}_B$ 与分子间轴共线。由单体 $A$ 的永久偶极子在单体 $B$ 的位置产生的电场 $\\vec{\\mathcal{E}}_B$ 由偶极子轴线上场强的公式给出：\n$$\n\\vec{\\mathcal{E}}_B = \\frac{2\\vec{\\mu}_A}{R^3}\n$$\n这个电场在单体 $B$ 上感生一个偶极矩 $\\vec{\\mu}_{\\mathrm{ind},B}$。根据线性响应近似，此为：\n$$\n\\vec{\\mu}_{\\mathrm{ind},B} = \\alpha_B \\vec{\\mathcal{E}}_B = \\frac{2\\alpha_B \\vec{\\mu}_A}{R^3}\n$$\n这个感生偶极子在产生它的场中的能量，即单体 $B$ 的诱导能，由下式给出：\n$$\nE_{\\mathrm{ind}, B \\leftarrow A} = -\\frac{1}{2}\\alpha_B |\\vec{\\mathcal{E}}_B|^2\n$$\n因子 $\\frac{1}{2}$ 源于极化单体所需的功。代入电场的表达式：\n$$\nE_{\\mathrm{ind}, B \\leftarrow A} = -\\frac{1}{2}\\alpha_B \\left( \\frac{2\\mu_A}{R^3} \\right)^2 = -\\frac{2\\alpha_B \\mu_A^2}{R^6}\n$$\n根据对称性，由单体 $B$ 在单体 $A$ 位置产生的电场 $\\vec{\\mathcal{E}}_A$ 具有相同的形式，并且在单体 $A$ 上产生的诱导能为：\n$$\nE_{\\mathrm{ind}, A \\leftarrow B} = -\\frac{1}{2}\\alpha_A |\\vec{\\mathcal{E}}_A|^2 = -\\frac{1}{2}\\alpha_A \\left( \\frac{2\\mu_B}{R^3} \\right)^2 = -\\frac{2\\alpha_A \\mu_B^2}{R^6}\n$$\n总的二阶诱导能 $E_{\\mathrm{ind}}^{(2)}$ 是这两个贡献之和，正如该SAPT项的定义所要求的那样，该定义在此阶忽略了相互诱导反馈：\n$$\nE_{\\mathrm{ind}}^{(2)} = E_{\\mathrm{ind}, B \\leftarrow A} + E_{\\mathrm{ind}, A \\leftarrow B} = -\\frac{2\\alpha_B \\mu_A^2}{R^6} - \\frac{2\\alpha_A \\mu_B^2}{R^6}\n$$\n鉴于单体是相同的，$\\mu_A = \\mu_B = \\mu$ 且 $\\alpha_A = \\alpha_B = \\alpha$。表达式简化为：\n$$\nE_{\\mathrm{ind}}^{(2)} = -\\frac{4\\alpha \\mu^2}{R^6}\n$$\n现在我们计算数值。所有物理量都必须转换为原子单位（长度为 $a_0$，偶极矩为 $e\\,a_0$，极化率体积为 $a_0^3$）。\n给定值为：\n$\\mu = 1.85\\,\\mathrm{D}$\n$\\alpha = 1.45\\,\\text{\\AA}^{3}$\n$R = 2.98\\,\\text{\\AA}$\n\n转换为原子单位为：\n$$\n\\mu_{\\mathrm{a.u.}} = 1.85 \\times 0.393430307 = 0.727846068\\, e\\,a_0\n$$\n$$\n\\alpha_{\\mathrm{a.u.}} = 1.45 \\times (1.889726125)^3 = 1.45 \\times 6.748334424 = 9.785084915\\, a_0^3\n$$\n$$\nR_{\\mathrm{a.u.}} = 2.98 \\times 1.889726125 = 5.631383853\\, a_0\n$$\n将这些值代入推导出的公式，得到以哈特里 ($E_h$) 为单位的能量：\n$$\nE_{\\mathrm{ind}}^{(2)} = - \\frac{4 \\times (9.785084915) \\times (0.727846068)^2}{(5.631383853)^6}\n$$\n$$\nE_{\\mathrm{ind}}^{(2)} = - \\frac{4 \\times 9.785084915 \\times 0.529760120}{31899.65084} = - \\frac{20.7335606}{31899.65084} = -0.000649962\\,E_h\n$$\n最后，我们使用提供的转换因子将此能量转换为摩尔单位：\n$$\nE_{\\mathrm{ind}}^{(2)} (\\mathrm{kJ\\,mol^{-1}}) = -0.000649962\\,E_h \\times 2625.49962\\,\\mathrm{kJ\\,mol^{-1}}\\,E_h^{-1}\n$$\n$$\nE_{\\mathrm{ind}}^{(2)} = -1.70642\\,\\mathrm{kJ\\,mol^{-1}}\n$$\n按要求四舍五入到三位有效数字：\n$$\nE_{\\mathrm{ind}}^{(2)} \\approx -1.71\\,\\mathrm{kJ\\,mol^{-1}}\n$$\n该值的量值小于能量最低水二聚体的典型文献值，这是预料之中的，因为该模型采用了高度理想化的几何构型并忽略了其他物理效应。", "answer": "$$\n\\boxed{-1.71}\n$$", "id": "2889700"}, {"introduction": "虽然经典模型对于建立直觉很有用，但要精确量化能量分解分析的各个组分，则需要严格的量子力学处理。这个高级实践将带您深入现代能量分解分析方案的计算引擎核心，来计算极化能。您将基于线性响应理论实现一个数值计算方案，通过求解耦合微扰方程来观察片段的电子密度如何响应外电场，从而对极化能的理论基础获得更深刻的理解。[@problem_id:2889710]", "problem": "设计并实现一个与能量分解分析（EDA）一致的完整数值方案，以使用耦合微扰Hartree-Fock（CPHF）或线性响应密度泛函理论（LR-DFT）来计算极化能。目标是计算一个片段的极化能，该能量在EDA中定义为：在其伙伴片段的冻结静电场中，由于该片段自身电子密度的内部弛豫（不包括片段间电荷转移）而导致的能量降低。您的实现必须基于以下基础且广为接受的原理。\n\n从电子能量泛函 $E[\\rho]$ 的Rayleigh–Ritz变分原理及其二次展开式开始，该展开式针对由代表伙伴片段嵌入场的外部微扰势 $ \\delta v $ 引起的微小密度变化 $ \\delta \\rho $。在正交归一的分子轨道基中，将密度变化限制在片段内部的占据轨道到虚拟轨道的旋转，这种旋转强制执行无电荷转移约束，并通过一个实数向量 $ \\mathbf{t} $（轨道旋转振幅）进行参数化，该向量涵盖所有允许的占据-虚拟轨道对。用正则分子轨道表示未受微扰的片段，其占据轨道 $i$ 和虚拟轨道 $a$ 之间的轨道能级差为 $ \\Delta_{ai} = \\varepsilon_{a} - \\varepsilon_{i} $。在受限的响应子空间中，通过一个对称正定Hessian矩阵 $ \\mathbf{H} = \\mathbf{D} + \\mathbf{K} $ 来模拟二次能量展开，其中 $ \\mathbf{D} = \\mathrm{diag}(\\Delta_{ai}) $，$ \\mathbf{K} $ 是编码理论水平的屏蔽核：对于CPHF，它包含库仑-交换耦合；对于LR-DFT，它包含Hartree和交换相关核的贡献。设广义力（右侧项）为嵌入势 $ \\delta v $ 的占据-虚拟轨道投影向量 $ \\mathbf{f} $。\n\n您的程序必须通过求解耦合微扰线性系统以获得振幅 $ \\mathbf{t} $，然后评估相应的二阶能量降低（该能量降低定义了EDA极化能），从而在数值上实现该线性响应方案。该方案必须：\n- 仅使用所提供的 $ \\Delta_{ai} $ 值、对称矩阵 $ \\mathbf{K} $ 和向量 $ \\mathbf{f} $。不引入任何额外的经验参数。\n- 求解由响应平稳性条件所蕴含的、适定的对称线性系统以获得 $ \\mathbf{t} $。\n- 根据二次能量展开式中收敛的振幅和广义力，计算二阶极化能，单位为Hartree。\n- 确保对于正定的Hessian矩阵，得到的极化能为非正值（能量降低或为零）。\n\n物理单位：所有能量必须以Hartree表示。不使用角度。将每个极化能以浮点数形式输出，单位为Hartree。\n\n测试套件：\n对于以下每种情况，激发空间由占据-虚拟轨道对枚举，数据以数值数组形式提供：\n- 情况1（单激发，屏蔽的类CPHF/LR-DFT）：\n  - $ \\Delta = [\\,0.6\\,] $\n  - $ \\mathbf{K} = \\begin{bmatrix} 0.2 \\end{bmatrix} $\n  - $ \\mathbf{f} = [\\,0.05\\,] $\n- 情况2（双激发，对角核）：\n  - $ \\Delta = [\\,0.5,\\,1.0\\,] $\n  - $ \\mathbf{K} = \\begin{bmatrix} 0.1  0 \\\\ 0  0.2 \\end{bmatrix} $\n  - $ \\mathbf{f} = [\\,0.04,\\,0.02\\,] $\n- 情况3（双激发，非对角耦合）：\n  - $ \\Delta = [\\,0.7,\\,0.9\\,] $\n  - $ \\mathbf{K} = \\begin{bmatrix} 0.3  0.05 \\\\ 0.05  0.25 \\end{bmatrix} $\n  - $ \\mathbf{f} = [\\,0.03,\\,0.025\\,] $\n- 情况4（小带隙的边界条件，无屏蔽）：\n  - $ \\Delta = [\\,0.05\\,] $\n  - $ \\mathbf{K} = \\begin{bmatrix} 0.0 \\end{bmatrix} $\n  - $ \\mathbf{f} = [\\,0.01\\,] $\n\n最终输出格式：\n您的程序应生成单行输出，其中包含四种情况下的极化能，形式为一个用方括号括起来的逗号分隔列表，例如 $[x_1,x_2,x_3,x_4]$，其中每个 $x_k$ 是您的方案计算出的浮点数，单位为Hartree。不应打印任何额外文本。", "solution": "该问题要求在一个标准的能量分解分析（EDA）框架内，实现一个计算极化能 $E_{\\text{pol}}$ 的数值方案。其理论基础是，在存在外部静电势 $\\delta v$ 的情况下，对片段电子能量的二次近似进行变分最小化。\n\n片段的总能量，包括其与外部场的相互作用，是轨道旋转振幅（由向量 $\\mathbf{t}$ 表示）的函数。这些振幅参数化了片段内部的密度弛豫 $\\delta \\rho$，同时禁止了片段间的电荷转移。由这种极化引起的能量变化，截至 $\\mathbf{t}$ 的二阶，由以下模型给出：\n$$ E_{\\text{pol}}(\\mathbf{t}) = \\frac{1}{2} \\mathbf{t}^T \\mathbf{H} \\mathbf{t} + \\mathbf{f}^T \\mathbf{t} $$\n在此，$\\mathbf{f}$ 是广义力向量，表示微扰 $\\delta v$ 与一阶密度响应之间的耦合。矩阵 $\\mathbf{H}$ 是孤立片段的电子Hessian矩阵，它被提供为轨道能隙的对角矩阵 $\\mathbf{D} = \\mathrm{diag}(\\Delta_{ai})$ 和一个屏蔽核 $\\mathbf{K}$ 的和。Hessian矩阵 $\\mathbf{H} = \\mathbf{D} + \\mathbf{K}$ 是对称且正定的，反映了未受微扰基态的稳定性。\n\n根据 Rayleigh–Ritz 变分原理，物理响应对应于使 $E_{\\text{pol}}(\\mathbf{t})$ 最小化的振幅 $\\mathbf{t}$。通过将能量对 $\\mathbf{t}$ 的梯度设为零来找到这个最小值：\n$$ \\nabla_{\\mathbf{t}} E_{\\text{pol}}(\\mathbf{t}) = \\mathbf{H} \\mathbf{t} + \\mathbf{f} = \\mathbf{0} $$\n该条件导出了一个用于求解最优响应向量 $\\mathbf{t}$ 的线性方程组：\n$$ \\mathbf{H} \\mathbf{t} = -\\mathbf{f} $$\n因为 $\\mathbf{H}$ 是对称且正定的，所以存在唯一的解 $\\mathbf{t} = -\\mathbf{H}^{-1}\\mathbf{f}$，并且该解对应一个稳定的能量最小值。\n\n极化能是在此最优 $\\mathbf{t}$ 下的 $E_{\\text{pol}}(\\mathbf{t})$ 的值。通过将条件 $\\mathbf{H}\\mathbf{t} = -\\mathbf{f}$ 代回到能量表达式中，可以得到一个计算上方便的公式：\n$$ E_{\\text{pol}} = \\frac{1}{2} \\mathbf{t}^T (\\mathbf{H}\\mathbf{t}) + \\mathbf{f}^T \\mathbf{t} = \\frac{1}{2} \\mathbf{t}^T (-\\mathbf{f}) + \\mathbf{f}^T \\mathbf{t} = -\\frac{1}{2} \\mathbf{f}^T \\mathbf{t} + \\mathbf{f}^T \\mathbf{t} = \\frac{1}{2} \\mathbf{f}^T \\mathbf{t} $$\n这个表达式 $E_{\\text{pol}} = \\frac{1}{2} \\mathbf{f} \\cdot \\mathbf{t}$ 确立了数值方案的最后一步。极化能的非正性是得到保证的，因为代入 $\\mathbf{t} = -\\mathbf{H}^{-1}\\mathbf{f}$ 会得到 $E_{\\text{pol}} = -\\frac{1}{2}\\mathbf{f}^T\\mathbf{H}^{-1}\\mathbf{f}$。对于正定矩阵 $\\mathbf{H}$，其逆矩阵 $\\mathbf{H}^{-1}$ 也是正定的，这意味着二次型 $\\mathbf{f}^T\\mathbf{H}^{-1}\\mathbf{f} \\ge 0$，因此 $E_{\\text{pol}} \\le 0$。\n\n所需的数值方案如下：\n1. 对于每个测试用例，通过将提供的屏蔽核 $\\mathbf{K}$ 与由轨道能级差 $\\Delta_{ai}$ 构成的对角矩阵 $\\mathbf{D}$ 相加，来构建Hessian矩阵 $\\mathbf{H}$。\n2. 求解线性系统 $\\mathbf{H}\\mathbf{t} = -\\mathbf{f}$ 以获得响应向量 $\\mathbf{t}$。\n3. 使用公式 $E_{\\text{pol}} = \\frac{1}{2} \\mathbf{f}^T \\mathbf{t}$ 计算极化能，单位为Hartree。\n此过程将应用于所提供的每个测试用例。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes polarization energies for a series of test cases based on\n    a linear-response model (CPHF/LR-DFT) within an EDA framework.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"delta\": np.array([0.6]),\n            \"K\": np.array([[0.2]]),\n            \"f\": np.array([0.05])\n        },\n        {\n            \"delta\": np.array([0.5, 1.0]),\n            \"K\": np.array([[0.1, 0.0], [0.0, 0.2]]),\n            \"f\": np.array([0.04, 0.02])\n        },\n        {\n            \"delta\": np.array([0.7, 0.9]),\n            \"K\": np.array([[0.3, 0.05], [0.05, 0.25]]),\n            \"f\": np.array([0.03, 0.025])\n        },\n        {\n            \"delta\": np.array([0.05]),\n            \"K\": np.array([[0.0]]),\n            \"f\": np.array([0.01])\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        # Extract data for the current case\n        delta_vals = case[\"delta\"]\n        K_matrix = case[\"K\"]\n        f_vector = case[\"f\"]\n        \n        # 1. Construct the Hessian matrix H = D + K.\n        # D is the diagonal matrix of orbital energy differences.\n        D_matrix = np.diag(delta_vals)\n        H_matrix = D_matrix + K_matrix\n        \n        # 2. Solve the linear system H * t = -f for the response vector t.\n        # The right-hand side of the linear equation is the negative of the force vector.\n        rhs = -f_vector\n        t_vector = np.linalg.solve(H_matrix, rhs)\n        \n        # 3. Compute the polarization energy E_pol = 0.5 * f^T * t.\n        # This is implemented as a dot product between f and t.\n        polarization_energy = 0.5 * np.dot(f_vector, t_vector)\n        \n        results.append(polarization_energy)\n\n    # Final print statement in the exact required format.\n    # The output is a comma-separated list of floating-point numbers in square brackets.\n    result_str = \",\".join(map(str, results))\n    print(f\"[{result_str}]\")\n\nsolve()\n```", "id": "2889710"}]}