{"hands_on_practices": [{"introduction": "将复杂的波函数转化为化学上直观的概念（如原子电荷）是波函数分析的核心任务。本练习将对比两种基础的布居分析方法：Mulliken布居和Löwdin布居 [@problem_id:2936252]。通过对一个给定的三原子体系进行手动计算，您将亲身体验这两种方案在计算上的差异，并理解为何对于同一个波函数，它们会得出不同的原子电荷结论，从而深化对非正交基组中电子密度划分问题的认识。", "problem": "考虑一个由标记为 $A$–$B$–$C$ 的原子组成的线性三原子链，每个原子有一个实的、归一化的原子轨道，这些轨道构成一个非正交的原子轨道基组。在此原子轨道基组中，给定重叠矩阵 $S$ 和单粒子密度矩阵 $P$（闭壳层）如下：\n$$\nS \\;=\\; \\begin{pmatrix}\n1  0.2  0 \\\\\n0.2  1  0.2 \\\\\n0  0.2  1\n\\end{pmatrix}, \n\\qquad\nP \\;=\\; \\begin{pmatrix}\n1.6  0.4  0 \\\\\n0.4  0.48  0.4 \\\\\n0  0.4  1.6\n\\end{pmatrix}.\n$$\n假设采用 Born–Oppenheimer 近似和单行列式描述。从以下基本定义出发：在非正交基组中，总电子数为 $N=\\mathrm{Tr}(P S)$；Mulliken 总轨道布居来自于在原子间平均分配重叠布居；Löwdin 布居来自于基组的对称正交化。仅利用这些基础，完成以下任务：\n\n1. 通过计算 $N=\\mathrm{Tr}(P S)$ 来验证电子数。\n2. 从第一性原理推导 Mulliken 和 Löwdin 总轨道布居的构建方法，并应用它们计算在每种方案下中心原子 $B$ 上的总电子布居。\n3. 令 $\\Delta$ 表示原子 $B$ 上的 Mulliken 总布居与 Löwdin 总布居之差，定义为\n$$\n\\Delta \\;=\\; N_{B}^{\\mathrm{Mulliken}} \\;-\\; N_{B}^{\\mathrm{Löwdin}}.\n$$\n给出 $\\Delta$ 作为你的最终答案。\n\n你的最终答案必须是单个闭合形式的解析表达式。不包含单位。如果你选择在中间步骤进行数值近似，请确保你报告的闭合形式在根式上是精确的（最终表达式中无小数截断）。在你的推理中，定性地解释在给定 $S$ 和 $P$ 的情况下，Mulliken 和 Löwdin 方案如何以及为何会对该体系给出不同的原子布居。", "solution": "首先对问题陈述进行严格验证。\n\n**步骤 1：提取已知条件**\n已知条件如下：\n- 一个线性三原子链 $A$–$B$–$C$。\n- 每个原子有一个实的、归一化的原子轨道，构成一个非正交基组。\n- 重叠矩阵 $S$：\n$$\nS \\;=\\; \\begin{pmatrix}\n1  0.2  0 \\\\\n0.2  1  0.2 \\\\\n0  0.2  1\n\\end{pmatrix}\n$$\n- 闭壳层体系的单粒子密度矩阵 $P$：\n$$\nP \\;=\\; \\begin{pmatrix}\n1.6  0.4  0 \\\\\n0.4  0.48  0.4 \\\\\n0  0.4  1.6\n\\end{pmatrix}\n$$\n- 总电子数的定义：$N=\\mathrm{Tr}(P S)$。\n- Mulliken 和 Löwdin 总轨道布居的定义。\n- 待计算量：$\\Delta = N_{B}^{\\mathrm{Mulliken}} - N_{B}^{\\mathrm{Löwdin}}$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，涉及量子化学中的标准概念（非正交基组中的布居分析）。语言客观且精确。为检查自洽性，我们计算乘积矩阵 $PS$：\n$$\nPS = \\begin{pmatrix}\n1.6  0.4  0 \\\\\n0.4  0.48  0.4 \\\\\n0  0.4  1.6\n\\end{pmatrix}\n\\begin{pmatrix}\n1  0.2  0 \\\\\n0.2  1  0.2 \\\\\n0  0.2  1\n\\end{pmatrix}\n= \\begin{pmatrix}\n1.6 \\times 1 + 0.4 \\times 0.2   1.6 \\times 0.2 + 0.4 \\times 1   0.4 \\times 0.2 \\\\\n0.4 \\times 1 + 0.48 \\times 0.2   0.4 \\times 0.2 + 0.48 \\times 1 + 0.4 \\times 0.2   0.48 \\times 0.2 + 0.4 \\times 1 \\\\\n0.4 \\times 0.2   0.4 \\times 1 + 1.6 \\times 0.2   0.4 \\times 0.2 + 1.6 \\times 1\n\\end{pmatrix}\n$$\n$$\nPS = \\begin{pmatrix}\n1.68   0.72   0.08 \\\\\n0.496  0.64   0.496 \\\\\n0.08   0.72   1.68\n\\end{pmatrix}\n$$\n迹为 $\\mathrm{Tr}(PS) = 1.68 + 0.64 + 1.68 = 4.00$。总电子数 $N=4$ 是一个整数，这对于一个闭壳层体系在物理上是合理的。该问题提法恰当且内部一致。\n\n**步骤 3：结论与行动**\n该问题有效。我们开始求解。\n\n求解过程需要进行三次计算：$N$，$N_{B}^{\\mathrm{Mulliken}}$ 和 $N_{B}^{\\mathrm{Löwdin}}$。\n\n1.  **电子数验证**\n    根据验证过程中的计算，总电子数 $N$ 为：\n    $$\n    N = \\mathrm{Tr}(PS) = \\mathrm{Tr} \\begin{pmatrix}\n    1.68   0.72   0.08 \\\\\n    0.496  0.64   0.496 \\\\\n    0.08   0.72   1.68\n    \\end{pmatrix} = 1.68 + 0.64 + 1.68 = 4\n    $$\n    该体系包含 $4$ 个电子。\n\n2.  **原子布居的推导与计算**\n\n    **Mulliken 布居分析**\n    Mulliken 方案通过将电子密度分配给各个原子轨道来划分总电子数 $N = \\sum_{\\mu, \\nu} P_{\\nu\\mu} S_{\\mu\\nu}$。原子轨道 $\\mu$ 上的总布居定义为迹表达式中所有涉及该轨道的项之和：\n    $$\n    N_{\\mu}^{\\mathrm{Mulliken}} = \\sum_{\\nu} P_{\\mu\\nu} S_{\\nu\\mu} = (PS)_{\\mu\\mu}\n    $$\n    这对应于取乘积矩阵 $PS$ 的对角元。对于原子 $B$（对应于轨道 2），总布居为：\n    $$\n    N_{B}^{\\mathrm{Mulliken}} = (PS)_{22}\n    $$\n    根据我们之前对 $PS$ 的计算：\n    $$\n    N_{B}^{\\mathrm{Mulliken}} = (PS)_{22} = 0.4 \\times 0.2 + 0.48 \\times 1 + 0.4 \\times 0.2 = 0.08 + 0.48 + 0.08 = 0.64\n    $$\n    用精确分数形式表示，$N_{B}^{\\mathrm{Mulliken}} = \\frac{64}{100} = \\frac{16}{25}$。\n\n    **Löwdin 布居分析**\n    Löwdin 方案首先通过对称正交化将非正交原子轨道基组 $\\{|\\chi_{\\mu}\\rangle\\}$ 变换为正交归一基组 $\\{|\\phi_{\\mu}\\rangle\\}$：$|\\phi\\rangle = |\\chi\\rangle S^{-1/2}$。在这个新基组中，重叠矩阵是单位矩阵，因此轨道 $\\mu$ 上的电子布居就是变换后密度矩阵 $P'$ 的相应对角元。密度矩阵的变换规则是 $P' = S^{1/2} P S^{1/2}$。迹的不变性 $N = \\mathrm{Tr}(P') = \\mathrm{Tr}(S^{1/2} P S^{1/2}) = \\mathrm{Tr}(PS)$ 得到满足。\n    因此，原子 $B$ 上的 Löwdin 布居为：\n    $$\n    N_{B}^{\\mathrm{Löwdin}} = (P')_{22} = (S^{1/2} P S^{1/2})_{22} = \\sum_{k=1}^{3} \\sum_{l=1}^{3} (S^{1/2})_{2k} P_{kl} (S^{1/2})_{l2}\n    $$\n    为了计算这个值，我们必须求出 $S^{1/2}$。这可以通过对角化 $S$ 来实现。$S = UDU^T$，其中 $D$ 是特征值的对角矩阵，$U$ 是特征向量的正交矩阵。那么 $S^{1/2} = UD^{1/2}U^T$。\n    $S$ 的特征方程为 $\\det(S - \\lambda I) = 0$：\n    $$\n    (1-\\lambda)((1-\\lambda)^2 - (0.2)^2) - 0.2(0.2(1-\\lambda)) = (1-\\lambda)((1-\\lambda)^2 - 0.04 - 0.04) = (1-\\lambda)((1-\\lambda)^2 - 0.08) = 0\n    $$\n    特征值为 $\\lambda_2 = 1$ 和 $1-\\lambda = \\pm\\sqrt{0.08} = \\pm \\frac{2\\sqrt{2}}{10} = \\pm \\frac{\\sqrt{2}}{5}$。因此，特征值为 $\\lambda_1 = 1 - \\frac{\\sqrt{2}}{5}$，$\\lambda_2 = 1$ 和 $\\lambda_3 = 1 + \\frac{\\sqrt{2}}{5}$。\n    相应的归一化特征向量为：\n    $$\n    v_1 = \\begin{pmatrix} \\frac{1}{2} \\\\ -\\frac{\\sqrt{2}}{2} \\\\ \\frac{1}{2} \\end{pmatrix}, \\quad v_2 = \\begin{pmatrix} \\frac{1}{\\sqrt{2}} \\\\ 0 \\\\ -\\frac{1}{\\sqrt{2}} \\end{pmatrix}, \\quad v_3 = \\begin{pmatrix} \\frac{1}{2} \\\\ \\frac{\\sqrt{2}}{2} \\\\ \\frac{1}{2} \\end{pmatrix}\n    $$\n    特征向量矩阵为 $U = (v_1, v_2, v_3)$。矩阵 $S^{1/2}$ 经过计算，但为了找到 $(P')_{22}$，我们可以展开求和。由于体系的对称性，$S^{1/2}$ 具有形式 $\\begin{pmatrix} x   y   z \\\\ y   w   y \\\\ z   y   x \\end{pmatrix}$。\n    我们需要的项是 $(P')_{22} = (S^{1/2} P S^{1/2})_{22} = \\sum_{k,l} (S^{1/2})_{2k} P_{kl} (S^{1/2})_{l2}$。\n    $$\n    (P')_{22} = (S^{1/2})_{21} \\sum_l P_{1l}(S^{1/2})_{l2} + (S^{1/2})_{22} \\sum_l P_{2l}(S^{1/2})_{l2} + (S^{1/2})_{23} \\sum_l P_{3l}(S^{1/2})_{l2}\n    $$\n    使用 $(S^{1/2})_{21}=y, (S^{1/2})_{22}=w, (S^{1/2})_{23}=y$ 以及 $P$ 的结构：\n    $$\n    (P')_{22} = y[P_{11}(S^{1/2})_{12} + P_{12}(S^{1/2})_{22}] + w[P_{21}(S^{1/2})_{12} + P_{22}(S^{1/2})_{22} + P_{23}(S^{1/2})_{32}] + y[P_{32}(S^{1/2})_{22} + P_{33}(S^{1/2})_{32}]\n    $$\n    由于 $(S^{1/2})_{12}=(S^{1/2})_{32}=y$ 且 $(S^{1/2})_{22}=w$，以及 $P_{11}=P_{33}$，$P_{12}=P_{21}=P_{23}=P_{32}$：\n    $$\n    (P')_{22} = y[P_{11}y + P_{12}w] + w[P_{12}y + P_{22}w + P_{12}y] + y[P_{12}w + P_{11}y]\n    $$\n    $$\n    (P')_{22} = 2P_{11}y^2 + 4P_{12}yw + P_{22}w^2\n    $$\n    我们需要计算 $y^2$、$w^2$ 和 $yw$。令 $S_h = S^{1/2}$。$w = (S_h)_{22} = \\sum_i (v_i)_2^2 \\sqrt{\\lambda_i} = (-\\frac{\\sqrt{2}}{2})^2 \\sqrt{\\lambda_1} + (0)^2\\sqrt{\\lambda_2} + (\\frac{\\sqrt{2}}{2})^2\\sqrt{\\lambda_3} = \\frac{1}{2}(\\sqrt{\\lambda_1} + \\sqrt{\\lambda_3})$。\n    $y = (S_h)_{12} = \\sum_i (v_i)_1 (v_i)_2 \\sqrt{\\lambda_i} = (\\frac{1}{2})(-\\frac{\\sqrt{2}}{2})\\sqrt{\\lambda_1} + 0 + (\\frac{1}{2})(\\frac{\\sqrt{2}}{2})\\sqrt{\\lambda_3} = \\frac{\\sqrt{2}}{4}(-\\sqrt{\\lambda_1} + \\sqrt{\\lambda_3})$。\n    令 $a = \\sqrt{\\lambda_1} = \\sqrt{1 - \\frac{\\sqrt{2}}{5}}$ 和 $b = \\sqrt{\\lambda_3} = \\sqrt{1 + \\frac{\\sqrt{2}}{5}}$。\n    $w = \\frac{a+b}{2}$ 且 $y = \\frac{\\sqrt{2}}{4}(b-a)$。\n    $w^2 = \\frac{1}{4}(a^2+b^2+2ab) = \\frac{1}{4}(1-\\frac{\\sqrt{2}}{5} + 1+\\frac{\\sqrt{2}}{5} + 2\\sqrt{1-\\frac{2}{25}}) = \\frac{1}{4}(2 + \\frac{2\\sqrt{23}}{5}) = \\frac{1}{2} + \\frac{\\sqrt{23}}{10}$。\n    $y^2 = \\frac{2}{16}(b-a)^2 = \\frac{1}{8}(a^2+b^2-2ab) = \\frac{1}{8}(2 - \\frac{2\\sqrt{23}}{5}) = \\frac{1}{4} - \\frac{\\sqrt{23}}{20}$。\n    $yw = \\frac{\\sqrt{2}}{8}(b-a)(b+a) = \\frac{\\sqrt{2}}{8}(b^2-a^2) = \\frac{\\sqrt{2}}{8}( (1+\\frac{\\sqrt{2}}{5}) - (1-\\frac{\\sqrt{2}}{5})) = \\frac{\\sqrt{2}}{8}(\\frac{2\\sqrt{2}}{5}) = \\frac{4}{40} = \\frac{1}{10}$。\n    布居数为 $P_{11}=1.6 = \\frac{8}{5}$，$P_{12}=0.4=\\frac{2}{5}$，$P_{22}=0.48=\\frac{12}{25}$。\n    $$\n    N_{B}^{\\mathrm{Löwdin}} = 2\\left(\\frac{8}{5}\\right)\\left(\\frac{1}{4} - \\frac{\\sqrt{23}}{20}\\right) + 4\\left(\\frac{2}{5}\\right)\\left(\\frac{1}{10}\\right) + \\left(\\frac{12}{25}\\right)\\left(\\frac{1}{2} + \\frac{\\sqrt{23}}{10}\\right)\n    $$\n    $$\n    = \\left(\\frac{16}{20} - \\frac{16\\sqrt{23}}{100}\\right) + \\frac{8}{50} + \\left(\\frac{12}{50} + \\frac{12\\sqrt{23}}{250}\\right)\n    $$\n    $$\n    = \\left(\\frac{4}{5} - \\frac{4\\sqrt{23}}{25}\\right) + \\frac{4}{25} + \\left(\\frac{6}{25} + \\frac{6\\sqrt{23}}{125}\\right)\n    $$\n    $$\n    = \\frac{4}{5} + \\frac{10}{25} + \\sqrt{23}\\left(-\\frac{4}{25} + \\frac{6}{125}\\right) = \\frac{20+10}{25} + \\sqrt{23}\\left(\\frac{-20+6}{125}\\right) = \\frac{30}{25} - \\frac{14\\sqrt{23}}{125}\n    $$\n    $$\n    N_{B}^{\\mathrm{Löwdin}} = \\frac{6}{5} - \\frac{14\\sqrt{23}}{125}\n    $$\n\n3.  **差值 $\\Delta$ 的计算与定性讨论**\n    差值 $\\Delta$ 定义为 $N_{B}^{\\mathrm{Mulliken}} - N_{B}^{\\mathrm{Löwdin}}$。\n    $$\n    \\Delta = \\frac{16}{25} - \\left(\\frac{6}{5} - \\frac{14\\sqrt{23}}{125}\\right) = \\frac{16}{25} - \\frac{30}{25} + \\frac{14\\sqrt{23}}{125} = -\\frac{14}{25} + \\frac{14\\sqrt{23}}{125}\n    $$\n    提取公因式 $\\frac{14}{125}$：\n    $$\n    \\Delta = \\frac{14}{125}(-5 + \\sqrt{23}) = \\frac{14(\\sqrt{23}-5)}{125}\n    $$\n    Mulliken 分析和 Löwdin 分析之间的差异源于它们在存在轨道重叠的情况下划分电子密度的根本不同方法。总电子密度可以用密度矩阵和基函数来表示。总电子数为 $N = \\sum_{\\mu\\nu} P_{\\mu\\nu} S_{\\nu\\mu}$。\n    Mulliken 方案是一种局域的、权宜的划分方法。它将在位密度 $P_{\\mu\\mu}$ 分配给原子 $\\mu$，并将由 $\\mu\\neq\\nu$ 的项（如 $2P_{\\mu\\nu}S_{\\nu\\mu}$）所代表的重叠密度在原子 $\\mu$ 和 $\\nu$ 之间平均分配。如前所示，这可以通过简单地取乘积矩阵 $PS$ 的对角元来实现。这种方法很简单，但可能不可靠，特别是对于弥散基函数，甚至可能产生不合物理的负布居数。\n    Löwdin 方案是一种更严谨的全局方法。它使用矩阵 $S^{-1/2}$ 将整个基组变换为一个正交归一的基组。这种变换混合了所有原始的原子轨道。一个正交化轨道 $\\phi_\\mu$ 是所有原始轨道 $\\chi_\\nu$ 的线性组合。因此，电子密度以一种由 $S^{-1/2}$ 结构决定的非局域方式在新基组上重新分布。由于基组现在是正交的，布居数就简单地是新密度矩阵 $P'$ 的对角元。这个过程确保布居数总是正的，并且通常被认为更稳健。\n    在这个问题中，尽管原子 $A$ 和原子 $C$ 不直接重叠（$S_{13}=0$），Löwdin 正交化过程却因为 $(S^{-1/2})_{13} \\neq 0$ 而在它们之间引入了有效的耦合。因此，原子 $B$ 上的布居数以一种比 Mulliken 方案更复杂的方式受到整个分子环境的影响，而 Mulliken 方案只考虑原子 $B$ 与其邻居的直接重叠。这种对重叠密度的全局处理与局域处理的对比，正是产生差异 $\\Delta$ 的根源。", "answer": "$$\n\\boxed{\\frac{14(\\sqrt{23}-5)}{125}}\n$$", "id": "2936252"}, {"introduction": "Mulliken布居分析因其计算简单而广泛应用，但它对基组选择的敏感性也臭名昭著，尤其是在使用弥散函数或过完备基组时。本练习旨在揭示这种敏感性的数学根源，将其与基组的重叠和近线性相关问题联系起来 [@problem_id:2936268]。通过推导布居表达式并分析其在有问题的基组中的行为，您将学会识别Mulliken电荷不可靠的关键警示信号，这是进行严谨计算化学研究的一项重要实践技能。", "problem": "波函数分析中的一个核心任务是将电子密度划分到各个原子上。在 Mulliken 布居分析中，这种划分依赖于原子轨道 (AO) 基组的非正交性。考虑一个闭壳层双原子分子 AB，它有一个已占据分子轨道 (MO)，该分子轨道由两个分别位于每个原子上的实、非正交、归一化的原子轨道构成。设原子轨道重叠矩阵为 $S$，其矩阵元为 $S_{\\mu \\nu} = \\langle \\chi_{\\mu} \\vert \\chi_{\\nu} \\rangle$，其中 $\\mu,\\nu \\in \\{A,B\\}$ 且 $S_{AA} = S_{BB} = 1$, $S_{AB} = S_{BA} = s$，满足 $0  s  1$。设在原子轨道基组中，该已占据分子轨道的系数矢量为 $c = (c_A, c_B)^{\\mathrm{T}}$，在非正交度规下归一化，使得 $c^{\\mathrm{T}} S c = 1$。对于一个具有此单双占据分子轨道的闭壳层行列式，其在原子轨道基组中的单粒子密度矩阵为 $P = 2 c c^{\\mathrm{T}}$。原子 $X$ 上的 Mulliken 总布居定义为 $g_X = \\sum_{\\mu \\in X} \\sum_{\\nu} P_{\\mu \\nu} S_{\\nu \\mu}$，Mulliken 净电荷为 $q_X = Z_X - g_X$，其中 $Z_X$ 是原子 $X$ 的核电荷。\n\n任务：\n1) 仅从这些定义出发，推导 $g_A$ 关于 $c_A$、$c_B$ 和 $s$ 的显式表达式，并证明对于这个闭壳层单分子轨道模型，$g_A + g_B = 2$。\n2) 使用 $g_A$ 的表达式，从第一性原理出发，论证为何 Mulliken 总布居对原子轨道重叠 $s$ 和原子轨道基组的选择敏感。然后定性地考虑，如果增加一个以原子 A 为中心的高度弥散的原子轨道，使得增广后的原子轨道重叠矩阵获得一个非常小的本征值 $\\varepsilon \\ll 1$（近线性相关，即过完备基组），会发生什么。解释为何即使底层波函数基本不变，这种情况也可能使 Mulliken 电荷在数值上不稳定。\n3) 根据你的分析，选择以下所有可作为有效诊断指标的陈述，这些指标表明 Mulliken 布居在弥散或过完备基组中是不可靠的（选择所有适用项）：\n\nA. 原子轨道重叠矩阵 $S$ 的最小本征值非常小（例如，小于 $10^{-6}$），表示存在近线性相关；这标志着 Mulliken 布居不可靠。\n\nB. 如果所有原子上的 Mulliken 电荷之和在机器精度内等于总分子电荷，那么即使在高度弥散的基组中，Mulliken 布居也是可靠的。\n\nC. 如果在进行对称 Löwdin 正交化（即使用 $S^{-1/2}$ 对原子轨道进行正交化而不改变波函数）后重新计算布居，Mulliken 原子电荷发生显著变化，这表明原始的 Mulliken 布居强烈依赖于基组且不可靠。\n\nD. 随着向所有原子均匀地增加越来越弥散的基函数，Mulliken 电荷应单调变化并趋于一个极限；任何非单调行为都标志着自洽场 (SCF) 程序的失败，而不是 Mulliken 分析的局限性。\n\nE. 出现大量基函数的 Mulliken 布居为强负值或大于 2 个电子，这是一个关于过完备性和原子电荷不可靠的实用警示信号。\n\nF. 如果在一个位于 $6\\,\\text{\\AA}$ 远的虚原子中心（一个没有原子核或电子的基函数中心）上增加一个非常弥散的 s 型函数，导致附近原子的 Mulliken 电荷变化超过约 0.3 个基本电荷单位，这表明 Mulliken 分析中存在基组赝象。\n\n答案格式：选择所有正确选项。", "solution": "对问题陈述进行验证。\n\n**步骤 1：提取已知条件**\n-   体系：一个闭壳层双原子分子 AB。\n-   分子轨道空间：一个双占据分子轨道 (MO)。\n-   原子轨道基组：两个实、归一化的原子轨道 (AO)，$\\chi_A$ 在原子 A 上，$\\chi_B$ 在原子 B 上。\n-   重叠矩阵：$S = \\begin{pmatrix} S_{AA}   S_{AB} \\\\ S_{BA}   S_{BB} \\end{pmatrix}$，其中 $S_{AA} = S_{BB} = 1$ 且 $S_{AB} = S_{BA} = s$，满足 $0  s  1$。\n-   分子轨道系数矢量：$c = (c_A, c_B)^{\\mathrm{T}}$。\n-   归一化条件：$c^{\\mathrm{T}} S c = 1$。\n-   单粒子密度矩阵：$P = 2 c c^{\\mathrm{T}}$。\n-   Mulliken 总布居：$g_X = \\sum_{\\mu \\in X} \\sum_{\\nu} P_{\\mu \\nu} S_{\\nu \\mu}$。\n-   Mulliken 净电荷：$q_X = Z_X - g_X$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，使用了量子化学中标准、正确的公式来定义 Mulliken 布居分析。该模型体系是一个简单、标准的教科书例子（例如，对 $\\mathrm{H}_2$ 的最小基组描述）。所有术语都定义精确，并且整个设置是自洽和一致的。所提出的问题表述清晰，需要对所提供的定义进行直接应用和概念延伸。没有科学上的缺陷、模糊或矛盾之处。\n\n**步骤 3：结论与行动**\n问题陈述是**有效的**。将推导解答。\n\n***\n\n**任务 1：总布居的推导与电子数守恒**\n\n首先，我们明确写出矩阵 $S$ 和 $P$。\n重叠矩阵为 $S = \\begin{pmatrix} 1   s \\\\ s   1 \\end{pmatrix}$。\n单个双占据分子轨道的密度矩阵为 $P = 2 c c^{\\mathrm{T}}$。\n$$P = 2 \\begin{pmatrix} c_A \\\\ c_B \\end{pmatrix} \\begin{pmatrix} c_A   c_B \\end{pmatrix} = 2 \\begin{pmatrix} c_A^2   c_A c_B \\\\ c_A c_B   c_B^2 \\end{pmatrix}$$\nMulliken 布居公式需要矩阵乘积 $(PS)$。\n$$(PS) = \\left( 2 \\begin{pmatrix} c_A^2   c_A c_B \\\\ c_A c_B   c_B^2 \\end{pmatrix} \\right) \\begin{pmatrix} 1   s \\\\ s   1 \\end{pmatrix} = 2 \\begin{pmatrix} c_A^2 \\cdot 1 + c_A c_B \\cdot s   c_A^2 \\cdot s + c_A c_B \\cdot 1 \\\\ c_A c_B \\cdot 1 + c_B^2 \\cdot s   c_A c_B \\cdot s + c_B^2 \\cdot 1 \\end{pmatrix}$$\n$$(PS) = 2 \\begin{pmatrix} c_A^2 + s c_A c_B   s c_A^2 + c_A c_B \\\\ c_A c_B + s c_B^2   s c_A c_B + c_B^2 \\end{pmatrix}$$\n原子 $X$ 上的 Mulliken 总布居 $g_X$ 是 $(PS)$ 矩阵中对应于以 $X$ 为中心的基函数的对角元素之和。\n对于原子 A，只有一个基函数，因此我们取 $(PS)$ 的第一个对角元素：\n$$g_A = (PS)_{AA} = 2(c_A^2 + s c_A c_B)$$\n对于原子 B，我们取第二个对角元素：\n$$g_B = (PS)_{BB} = 2(c_B^2 + s c_A c_B)$$\n现在，我们必须证明 $g_A + g_B = 2$。\n$$g_A + g_B = 2(c_A^2 + s c_A c_B) + 2(c_B^2 + s c_A c_B) = 2(c_A^2 + 2 s c_A c_B + c_B^2)$$\n我们使用给定的分子轨道在非正交基组下的归一化条件：$c^{\\mathrm{T}} S c = 1$。\n$$c^{\\mathrm{T}} S c = \\begin{pmatrix} c_A   c_B \\end{pmatrix} \\begin{pmatrix} 1   s \\\\ s   1 \\end{pmatrix} \\begin{pmatrix} c_A \\\\ c_B \\end{pmatrix} = \\begin{pmatrix} c_A   c_B \\end{pmatrix} \\begin{pmatrix} c_A + s c_B \\\\ s c_A + c_B \\end{pmatrix}$$\n$$c^{\\mathrm{T}} S c = c_A(c_A + s c_B) + c_B(s c_A + c_B) = c_A^2 + s c_A c_B + s c_A c_B + c_B^2 = c_A^2 + 2 s c_A c_B + c_B^2$$\n由于 $c^{\\mathrm{T}} S c = 1$，因此 $c_A^2 + 2 s c_A c_B + c_B^2 = 1$。\n将此结果代入 $g_A + g_B$ 的表达式：\n$$g_A + g_B = 2(1) = 2$$\n这是正确的。总布居之和等于系统中的总电子数（单个双占据分子轨道中的 2 个电子）。\n\n**任务 2：敏感性分析**\n\n$g_A = 2(c_A^2 + s c_A c_B)$ 这个表达式揭示了 Mulliken 分析问题的根源。布居不仅仅是与基函数 $\\chi_A$ 相关联的电子数（这会与 $2c_A^2$ 有关），还包含一个项 $2 s c_A c_B$。该项源于“重叠布居” $2(P_{AB}S_{BA} + P_{BA}S_{AB}) = 4 s c_A c_B$，Mulliken 的方案将其在原子 A 和 B 之间平分。这种划分是任意的，没有严格的物理依据。原子 A 上的布居直接依赖于重叠积分 $s$。由于 $s$ 是一个对所选原子轨道基函数（它们的类型、指数和相对位置）敏感的函数，因此 Mulliken 布居本质上是依赖于基组的。\n\n现在，考虑近线性相关的情况，其标志是增广后的重叠矩阵 $S$ 有一个非常小的本征值 $\\varepsilon \\ll 1$。这种情况在两个或多个基函数在空间位置上几乎相同时出现，例如，通过添加一个与其它函数广泛重叠的非常弥散的函数。\n小本征值表明矩阵 $S$ 近似奇异。分子轨道系数 $c$ 是通过求解广义本征值问题 $(F - \\epsilon S)c=0$ 得到的，其中 $F$ 是 Fock 矩阵。数值求解通常涉及矩阵 $S^{-1/2}$，如果 $S$ 有非常小的本征值，该矩阵将会有非常大的元素。这会在求解系数 $c$ 时引入数值不稳定性。\n即使总波函数 $\\Psi = \\sum_\\mu c_\\mu \\chi_\\mu$ 表现良好且稳定，其在近线性相关基组中的表示也不是唯一的。一个微小的扰动可能导致近冗余基函数的系数发生大的、相互补偿的变化，而总的 $\\Psi$ 几乎保持不变。\n由于 Mulliken 布居 $g_X$ 依赖于*单个*密度矩阵元 $P_{\\mu\\nu} = 2 \\sum_i^{occ} c_{i\\mu} c_{i\\nu}$ 和重叠元 $S_{\\nu\\mu}$，它对系数的这些波动极其敏感。这会导致一种非物理的划分：一个以原子 A 为中心的弥散函数可能在空间上覆盖了原子 B，但 Mulliken 方案会将其与 B 函数重叠布居的一半分配回原子 A，从而导致荒谬的电荷。这种由病态基组驱动的不稳定性，使得 Mulliken 电荷不可靠。\n\n**任务 3：评估诊断性陈述**\n\n**A. 原子轨道重叠矩阵 S 的最小本征值非常小（例如，小于 $10^{-6}$），表示存在近线性相关；这标志着 Mulliken 布居不可靠。**\n重叠矩阵的小本征值是基组中近线性相关的数学定义。如任务 2 所分析，Mulliken 布居对此类情况病态敏感，因为电子密度的划分与波函数的一个病态且不唯一的表示相关联。因此， $S$ 的小本征值是一个直接且标准的指标，表明像 Mulliken 这样对基组表示非不变的布居分析将是不可靠的。\n**结论：正确。**\n\n**B. 如果所有原子上的 Mulliken 电荷之和在机器精度内等于总分子电荷，那么即使在高度弥散的基组中，Mulliken 布居也是可靠的。**\n总电子数为 $N = \\text{Tr}(PS)$。总布居之和为 $\\sum_X g_X = \\sum_X \\sum_{\\mu \\in X} (PS)_{\\mu\\mu} = \\sum_{\\mu} (PS)_{\\mu\\mu} = \\text{Tr}(PS) = N$。净电荷之和为 $\\sum_X q_X = \\sum_X (Z_X - g_X) = \\sum_X Z_X - \\sum_X g_X = Z_{tot} - N = Q_{mol}$。这个等式是一个代数恒等式，是 Mulliken 分析定义中内嵌的。无论基组质量或单个电荷的物理意义如何，它都成立。因此，这个条件对于划分的可靠性不提供任何信息。\n**结论：错误。**\n\n**C. 如果在进行对称 Löwdin 正交化（即使用 $S^{-1/2}$ 对原子轨道进行正交化而不改变波函数）后重新计算布居，Mulliken 原子电荷发生显著变化，这表明原始的 Mulliken 布居强烈依赖于基组且不可靠。**\nMulliken 和 Löwdin 分析是两种不同的电子密度划分方案。Mulliken 在原始的非正交原子轨道基组中工作，而 Löwdin 分析等价于在通过变换 $S^{-1/2}$ 得到的对称正交化基组上进行的 Mulliken 分析。这两种方法结果的巨大差异表明，计算出的电荷高度敏感于用于划分的具体数学程序，而不是反映内在的物理性质。在具有大重叠或近线性相关的基组中，这种敏感性会加剧，而这些恰恰是划分方案变得任意的条件。因此，一个大的变化是原始 Mulliken 电荷不可靠和基组依赖性的明确信号。\n**结论：正确。**\n\n**D. 随着向所有原子均匀地增加越来越弥散的基函数，Mulliken 电荷应单调变化并趋于一个极限；任何非单调行为都标志着自洽场 (SCF) 程序的失败，而不是 Mulliken 分析的局限性。**\n这是错误的。增加越来越弥散的函数会使基组逐渐变得更加过完备和线性相关。如前所述，Mulliken 分析在这种基组中存在严重缺陷。电荷会表现出不稳定的、非单调的行为，并且不会收敛到一个有物理意义的极限。这种行为是 *Mulliken 分析方法本身* 的一个众所周知的缺陷，而不一定是 SCF 程序的失败，因为 SCF 程序很可能收敛到稳定的总能量和密度。\n**结论：错误。**\n\n**E. 出现大量基函数的 Mulliken 布居为强负值或大于 2 个电子，这是一个关于过完备性和原子电荷不可靠的实用警示信号。**\n量 $(PS)_{\\mu\\mu}$ 可以解释为单个基函数 $\\chi_\\mu$ 的布居。虽然总布居必须为正，但这些单独的组分可能变为负值，或者在多电子体系中变得非常大。负的电子布居在根本上是非物理的。单个原子轨道中的布居数大于 2 在概念上也违反了泡利不相容原理，因而是非物理的，即使它是一个数学赝象。这种单个原子轨道布居的非物理值是典型的、实用的症状，表明数学划分已经失效，这是将 Mulliken 分析应用于过完备或病态基组的常见结果。\n**结论：正确。**\n\n**F. 如果在一个位于 $6\\,\\text{\\AA}$ 远的虚原子中心（一个没有原子核或电子的基函数中心）上增加一个非常弥散的 s 型函数，导致附近原子的 Mulliken 电荷变化超过约 0.3 个基本电荷单位，这表明 Mulliken 分析中存在基组赝象。**\n一个稳健的物理可观测量或一个可靠的派生量应该对微小的、物理上无关的扰动不敏感，例如在远离分子的空间点上增加一个基函数。然而，一个非常弥散的函数会与分子上的基函数有非零重叠。Mulliken 方案会因此将分子电子密度的一部分分配给这个遥远的虚原子中心，从而改变实际原子上的电荷。一个大的变化（如 0.3 e）表明布居分析方法对基组的具体构成病态敏感。这揭示了该方法的结果是计算的赝象，而不是底层物理的反映。这是检验布居分析方法稳定性的一个标准测试，而 Mulliken 分析已知会通不过这个测试。\n**结论：正确。**", "answer": "$$\\boxed{ACEF}$$", "id": "2936268"}, {"introduction": "除了计算原子电荷，我们常常更希望量化特定轨道间的稳定化相互作用，例如超共轭效应。本练习介绍了一种基于二级微扰理论的强大分析方法，它构成了自然键轨道（NBO）等分析方法的核心 [@problem_id:2936296]。通过编写算法来识别并量化给定的局域化轨道之间的相互作用能，您将把抽象的量子理论与具体的化学概念联系起来，学会如何剖析波函数，揭示分子稳定性和结构的电子根源。", "problem": "您获得了一个用于波函数分析的简化模型，该模型用于分析在与量子化学相关的定域、正交轨道基中的超共轭相互作用。考虑一组有限的定域轨道，其单电子能量为 $\\{\\varepsilon_{p}\\}$ (单位为哈特里)，分数占据数为 $\\{n_{p}\\}$ (单位为电子)，其中 $0 \\le n_{p} \\le 2$。非对角矩阵元 $F_{pq}$ (单位为哈特里) 描述了轨道 $p$ 和 $q$ 通过一个有效单电子算符 (例如，在正交定域基中的 Fock 或 Kohn–Sham 算符) 之间的相互作用。假设 $F_{pq} = F_{qp}$ 且 $F_{pp} = 0$。一个超共轭给体-受体相互作用被理想化为具有 $n_{i}$ 个电子和较低能量 $\\varepsilon_{i}$ 的给体轨道 $i$ 与一个占据数接近于零且能量较高 $\\varepsilon_{a}$ 的受体轨道 $a$ 之间的耦合，其中 $\\varepsilon_{a} > \\varepsilon_{i}$。\n\n仅从不含时、非简并的 Rayleigh–Schrödinger 微扰理论和占据数的物理意义出发，推导如何计算由给体 $i$ 和受体 $a$ 通过 $F_{ia}$ 和能隙 $\\Delta_{ia} = \\varepsilon_{a} - \\varepsilon_{i}$ 混合引起的二阶能量降低，然后实现一个算法来执行以下操作：\n\n- 将 $n_{i} \\ge \\tau_{\\mathrm{d}}$ 的轨道识别为给体，将 $n_{a} \\le \\tau_{\\mathrm{a}}$ 的轨道识别为受体，其中 $\\tau_{\\mathrm{d}}$ 和 $\\tau_{\\mathrm{a}}$ 是每个测试用例提供的阈值参数。\n- 对于每个满足 $\\varepsilon_{a} - \\varepsilon_{i} > 0$ 的有序给体-受体对 $(i,a)$，使用哈特里到千卡每摩尔的转换因子 $1\\,\\mathrm{hartree} = 627.509474\\,\\mathrm{kcal}\\,\\mathrm{mol}^{-1}$，计算二阶稳定化能量贡献 (单位为千卡每摩尔)。您必须将稳定化能的大小视为非负值。\n- 如果相互作用 $(i,a)$ 的稳定化能量大小至少为 $\\theta$ 千卡每摩尔，则将其分类为“关键”相互作用，其中 $\\theta$ 是特定于测试用例的阈值。\n- 对于每个测试用例，输出三个量：关键相互作用的整数计数，关键相互作用稳定化能的总和 (单位为千卡每摩尔，四舍五入到小数点后 $3$ 位)，以及最大关键相互作用稳定化能 (单位为千卡每摩尔，四舍五入到小数点后 $3$ 位) (如果不存在关键相互作用，则使用 $0$)。\n\n您的程序必须为以下测试套件实现上述逻辑。每个测试用例提供能量列表 $\\{\\varepsilon_{p}\\}$ (单位为哈特里)、占据数列表 $\\{n_{p}\\}$ (单位为电子)、对称耦合矩阵 $F$ (单位为哈特里)、给体阈值 $\\tau_{\\mathrm{d}}$、受体阈值 $\\tau_{\\mathrm{a}}$ 以及关键相互作用阈值 $\\theta$ (单位为千卡每摩尔)：\n\n- 测试用例 1 (正常情况，多个给体和受体，中等大小的能隙和耦合)：\n  - 能量 $\\left[-0.50,\\,-0.45,\\,0.10,\\,0.15\\right]$\n  - 占据数 $\\left[1.98,\\,1.90,\\,0.05,\\,0.02\\right]$\n  - $F = \\begin{bmatrix}\n  0   0.02   0.04   0.01\\\\\n  0.02   0   0.03   0.02\\\\\n  0.04   0.03   0   0.01\\\\\n  0.01   0.02   0.01   0\n  \\end{bmatrix}$\n  - $\\tau_{\\mathrm{d}} = 1.50$, $\\tau_{\\mathrm{a}} = 0.50$, $\\theta = 0.50$\n- 测试用例 2 (零耦合的边界情况)：\n  - 能量 $\\left[-0.40,\\,0.12\\right]$\n  - 占据数 $\\left[2.00,\\,0.00\\right]$\n  - $F = \\begin{bmatrix}0   0\\\\ 0   0\\end{bmatrix}$\n  - $\\tau_{\\mathrm{d}} = 1.50$, $\\tau_{\\mathrm{a}} = 0.50$, $\\theta = 0.10$\n- 测试用例 3 (导致大稳定化能的小能隙)：\n  - 能量 $\\left[-0.20,\\,-0.18,\\,-0.05\\right]$\n  - 占据数 $\\left[1.99,\\,1.70,\\,0.01\\right]$\n  - $F = \\begin{bmatrix}\n  0   0   0.05\\\\\n  0   0   0.04\\\\\n  0.05   0.04   0\n  \\end{bmatrix}$\n  - $\\tau_{\\mathrm{d}} = 1.50$, $\\tau_{\\mathrm{a}} = 0.50$, $\\theta = 5.00$\n- 测试用例 4 (耦合的符号不变性；负非对角元)：\n  - 能量 $\\left[-0.60,\\,-0.50,\\,0.05,\\,0.20\\right]$\n  - 占据数 $\\left[2.00,\\,1.60,\\,0.10,\\,0.00\\right]$\n  - $F = \\begin{bmatrix}\n  0   -0.01   -0.02   0.00\\\\\n  -0.01   0   0.03   -0.02\\\\\n  -0.02   0.03   0   -0.01\\\\\n  0.00   -0.02   -0.01   0\n  \\end{bmatrix}$\n  - $\\tau_{\\mathrm{d}} = 1.50$, $\\tau_{\\mathrm{a}} = 0.50$, $\\theta = 0.60$\n- 测试用例 5 (阈值处的分类边界情况)：\n  - 能量 $\\left[-0.30,\\,0.02\\right]$\n  - 占据数 $\\left[1.49,\\,0.50\\right]$\n  - $F = \\begin{bmatrix}0   0.03\\\\ 0.03   0\\end{bmatrix}$\n  - $\\tau_{\\mathrm{d}} = 1.50$, $\\tau_{\\mathrm{a}} = 0.50$, $\\theta = 0.01$\n\n角度单位不适用。所有提供的能量单位均为哈特里。您的程序必须使用转换因子 $1\\,\\mathrm{hartree} = 627.509474\\,\\mathrm{kcal}\\,\\mathrm{mol}^{-1}$ 将稳定化能转换为千卡每摩尔，并且必须在最终输出中将每个测试用例的总和与最大值四舍五入到小数点后 $3$ 位。最终输出格式必须是单行，包含一个用方括号括起来的逗号分隔列表，形式为 $\\left[\\text{count}_{1},\\,\\text{sum}_{1},\\,\\text{max}_{1},\\,\\text{count}_{2},\\,\\text{sum}_{2},\\,\\text{max}_{2},\\,\\dots\\right]$，其中条目按测试用例的顺序出现。不应打印任何其他文本。", "solution": "所述问题在科学上是合理的、自洽的且定义明确。它提出了一个用于量子化学中分析轨道相互作用 (特别是超共轭) 的标准模型 (尽管经过简化)，该模型基于微扰理论的视角。所有必要的数据和参数都已提供，可得到唯一且可验证的解。因此，我们将进行形式推导和算法实现。\n\n我们的目标是推导给体轨道和受体轨道之间的二阶稳定化能公式，然后将此公式应用于一组测试用例。\n\n**理论推导**\n\n我们从不含时、非简并的 Rayleigh–Schrödinger 微扰理论开始。该系统由一组正交定域轨道 $\\{|\\psi_p\\rangle\\}$ 组成，它们是未微扰单电子哈密顿算符 $H^{(0)}$ 的本征态。有效单电子算符 $F$ 的对角元是 $H^{(0)}$ 的本征值，即轨道能量 $\\{\\varepsilon_p\\}$。\n\n$$\nH^{(0)} |\\psi_p\\rangle = \\varepsilon_p |\\psi_p\\rangle\n$$\n\n微扰 $V$ 由 $F$ 的非对角元表示。$V$ 的矩阵元为 $V_{pq} = \\langle \\psi_p | V | \\psi_q \\rangle = F_{pq}$ (当 $p \\neq q$ 时)，且 $V_{pp} = F_{pp} = 0$。\n\n我们考虑一个特定的相互作用，发生于单个给体轨道 (记为 $|i\\rangle$，代表 $|\\psi_i\\rangle$) 和单个受体轨道 (记为 $|a\\rangle$，代表 $|\\psi_a\\rangle$) 之间。未微扰能量分别为 $\\varepsilon_i$ 和 $\\varepsilon_a$。\n\n对未微扰态 $|n\\rangle$ 的二阶能量校正由以下通用公式给出：\n$$\nE_n^{(2)} = \\sum_{k \\neq n} \\frac{|\\langle\\psi_k|V|\\psi_n\\rangle|^2}{E_n^{(0)} - E_k^{(0)}}\n$$\n其中 $E_n^{(0)}$ 和 $E_k^{(0)}$ 是未微扰能量本征值。\n\n将此应用于给体轨道 $|i\\rangle$，并仅考虑其与受体轨道 $|a\\rangle$ 的相互作用，求和可简化为单项。对给体轨道能级的二阶校正为：\n$$\nE_i^{(2)} = \\frac{|\\langle a|V|i\\rangle|^2}{\\varepsilon_i - \\varepsilon_a}\n$$\n考虑到矩阵元是实数 ($F_{pq} \\in \\mathbb{R}$) 且对称 ($F_{ai} = F_{ia}$)，并且问题指定 $\\varepsilon_a > \\varepsilon_i$，我们可以写出：\n$$\nE_i^{(2)} = \\frac{F_{ia}^2}{\\varepsilon_i - \\varepsilon_a} = - \\frac{F_{ia}^2}{\\varepsilon_a - \\varepsilon_i}\n$$\n这表示给体轨道能级的能量降低，这符合稳定化相互作用的预期。\n\n总的能量稳定化必须考虑轨道的电子占据情况。给体轨道 $|i\\rangle$ 被 $n_i$ 个电子占据。这对相互作用的稳定化能贡献是每个电子的能量变化乘以给体轨道中的电子数。受体轨道 $|a\\rangle$ 的占据数接近于零 ($n_a \\approx 0$)，因此其能量升高 ($E_a^{(2)} = +F_{ia}^2/(\\varepsilon_a - \\varepsilon_i)$) 对总能量变化的贡献可以忽略不计。\n\n因此，给体-受体对 $(i, a)$ 的总二阶稳定化能为：\n$$\n\\Delta E_{ia}^{(2)} = n_i E_i^{(2)} = - n_i \\frac{F_{ia}^2}{\\varepsilon_a - \\varepsilon_i}\n$$\n问题要求的是稳定化能的大小，我们将其表示为 $S_{ia}$。该值必须为非负。\n$$\nS_{ia} = |\\Delta E_{ia}^{(2)}| = n_i \\frac{F_{ia}^2}{\\varepsilon_a - \\varepsilon_i}\n$$\n这就是需要实现的最终公式。$F_{ia}^2$ 项正确地处理了耦合元符号的不变性，因为稳定化能取决于其大小的平方。\n\n**算法流程**\n\n对于每个测试用例，执行以下算法：\n\n1.  **初始化**：将轨道能量 $\\{\\varepsilon_p\\}$、占据数 $\\{n_p\\}$、相互作用矩阵 $F$、阈值 $\\tau_{\\mathrm{d}}$ 和 $\\tau_{\\mathrm{a}}$ 以及关键相互作用阈值 $\\theta$ 作为输入。定义转换因子 $C = 627.509474\\,\\mathrm{kcal}\\,\\mathrm{mol}^{-1}/\\mathrm{hartree}$。\n\n2.  **轨道分类**：\n    -   创建一个给体索引集合 $D$，包含所有满足 $n_i \\ge \\tau_{\\mathrm{d}}$ 的索引 $i$。\n    -   创建一个受体索引集合 $A$，包含所有满足 $n_a \\le \\tau_{\\mathrm{a}}$ 的索引 $a$。\n\n3.  **相互作用分析**：创建一个空列表 `key_stabilizations`，用于存储关键相互作用的能量值。\n    -   遍历每个给体索引 $i \\in D$。\n    -   对每个给体，遍历每个受体索引 $a \\in A$。\n    -   对每对 $(i, a)$，检查条件 $\\varepsilon_a - \\varepsilon_i > 0$ 以确保是有效的给体-受体能量顺序。\n    -   如果条件满足，使用推导的公式计算稳定化能的大小 $S_{ia}$ (单位为哈特里)：\n        $$\n        S_{ia} [\\mathrm{hartree}] = n_i \\frac{(F_{ia})^2}{\\varepsilon_a - \\varepsilon_i}\n        $$\n    -   将能量转换为千卡每摩尔：\n        $$\n        S_{ia} [\\mathrm{kcal}\\,\\mathrm{mol}^{-1}] = S_{ia} [\\mathrm{hartree}] \\times C\n        $$\n    -   将此稳定化能与阈值 $\\theta$ 进行比较。如果 $S_{ia} [\\mathrm{kcal}\\,\\mathrm{mol}^{-1}] \\ge \\theta$，则该相互作用被分类为“关键”相互作用，并将其值附加到 `key_stabilizations` 列表中。\n\n4.  **结果汇总**：在评估完所有对之后：\n    -   关键相互作用的总数是 `key_stabilizations` 中的元素数量。\n    -   关键稳定化能的总和是 `key_stabilizations` 中所有元素的和。\n    -   最大关键稳定化能是 `key_stabilizations` 中的最大值。\n    -   如果 `key_stabilizations` 为空，则计数、总和和最大值均为 $0$。\n\n5.  **输出格式化**：为最终输出字符串准备好关键相互作用的计数 (一个整数)、它们的能量总和 (四舍五入到小数点后 $3$ 位) 以及最大能量 (四舍五入到小数点后 $3$ 位)。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the quantum chemistry problem for all test cases.\n    \"\"\"\n    HARTREE_TO_KCAL_MOL = 627.509474\n\n    test_cases = [\n        # Test case 1\n        {\n            \"energies\": np.array([-0.50, -0.45, 0.10, 0.15]),\n            \"occupations\": np.array([1.98, 1.90, 0.05, 0.02]),\n            \"F_matrix\": np.array([\n                [0, 0.02, 0.04, 0.01],\n                [0.02, 0, 0.03, 0.02],\n                [0.04, 0.03, 0, 0.01],\n                [0.01, 0.02, 0.01, 0]\n            ]),\n            \"tau_d\": 1.50, \"tau_a\": 0.50, \"theta\": 0.50\n        },\n        # Test case 2\n        {\n            \"energies\": np.array([-0.40, 0.12]),\n            \"occupations\": np.array([2.00, 0.00]),\n            \"F_matrix\": np.array([\n                [0, 0],\n                [0, 0]\n            ]),\n            \"tau_d\": 1.50, \"tau_a\": 0.50, \"theta\": 0.10\n        },\n        # Test case 3\n        {\n            \"energies\": np.array([-0.20, -0.18, -0.05]),\n            \"occupations\": np.array([1.99, 1.70, 0.01]),\n            \"F_matrix\": np.array([\n                [0, 0, 0.05],\n                [0, 0, 0.04],\n                [0.05, 0.04, 0]\n            ]),\n            \"tau_d\": 1.50, \"tau_a\": 0.50, \"theta\": 5.00\n        },\n        # Test case 4\n        {\n            \"energies\": np.array([-0.60, -0.50, 0.05, 0.20]),\n            \"occupations\": np.array([2.00, 1.60, 0.10, 0.00]),\n            \"F_matrix\": np.array([\n                [0, -0.01, -0.02, 0.00],\n                [-0.01, 0, 0.03, -0.02],\n                [-0.02, 0.03, 0, -0.01],\n                [0.00, -0.02, -0.01, 0]\n            ]),\n            \"tau_d\": 1.50, \"tau_a\": 0.50, \"theta\": 0.60\n        },\n        # Test case 5\n        {\n            \"energies\": np.array([-0.30, 0.02]),\n            \"occupations\": np.array([1.49, 0.50]),\n            \"F_matrix\": np.array([\n                [0, 0.03],\n                [0.03, 0]\n            ]),\n            \"tau_d\": 1.50, \"tau_a\": 0.50, \"theta\": 0.01\n        }\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        energies = case[\"energies\"]\n        occupations = case[\"occupations\"]\n        F = case[\"F_matrix\"]\n        tau_d = case[\"tau_d\"]\n        tau_a = case[\"tau_a\"]\n        theta = case[\"theta\"]\n        \n        num_orbitals = len(energies)\n        \n        # Identify donor and acceptor orbitals by their indices\n        donor_indices = [i for i in range(num_orbitals) if occupations[i] >= tau_d]\n        acceptor_indices = [a for a in range(num_orbitals) if occupations[a] = tau_a]\n\n        key_stabilizations = []\n\n        for i in donor_indices:\n            for a in acceptor_indices:\n                # Ensure donor energy is lower than acceptor energy\n                energy_gap = energies[a] - energies[i]\n                if energy_gap > 0:\n                    # Calculate stabilization energy in hartree\n                    coupling_sq = F[i, a]**2\n                    stabilization_hartree = occupations[i] * coupling_sq / energy_gap\n                    \n                    # Convert to kcal/mol\n                    stabilization_kcal_mol = stabilization_hartree * HARTREE_TO_KCAL_MOL\n                    \n                    # Check if it's a key interaction\n                    if stabilization_kcal_mol >= theta:\n                        key_stabilizations.append(stabilization_kcal_mol)\n        \n        if not key_stabilizations:\n            count_keys = 0\n            sum_keys = 0.0\n            max_key = 0.0\n        else:\n            count_keys = len(key_stabilizations)\n            sum_keys = sum(key_stabilizations)\n            max_key = max(key_stabilizations)\n        \n        all_results.append(str(count_keys))\n        all_results.append(f\"{sum_keys:.3f}\")\n        all_results.append(f\"{max_key:.3f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n```", "id": "2936296"}]}