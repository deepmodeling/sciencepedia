## 引言
在[量子化学](@entry_id:140193)计算中，[波函数](@entry_id:147440)或电子密度矩阵以复杂的数学形式包含了分子的全部[电子结构](@entry_id:145158)信息。然而，为了将这些信息转化为化学家所熟悉的直观概念，如[原子电荷](@entry_id:204820)、键级和化学[键的极性](@entry_id:139145)，我们需要一种系统性的解释工具。核心的挑战在于，如何将[分布](@entry_id:182848)在整个分子中的电子密度，特别是在非正交[原子轨道](@entry_id:140819)[基组](@entry_id:160309)中存在的“重叠”部分，合理地分配给各个原子中心。这正是布居分析（Population Analysis）试图解决的根本问题。

本文将聚焦于两种最具开创性和基础性的布居分析方法：[Mulliken布居分析](@entry_id:164573)和Löwdin布居分析。我们将首先在“原理与机制”一章中，深入剖析这两种方法背后的数学形式和物理思想，揭示它们在处理[重叠布居](@entry_id:276854)问题上的根本差异，并探讨其各自的优势与内在缺陷，尤其是广为人知的[基组依赖性](@entry_id:197523)问题。接着，在“应用与交叉学科联系”一章中，我们将通过丰富的实例展示这些分析方法如何被应用于解释化学成键、诊断计算问题、以及在固态物理和[生物模拟](@entry_id:264183)等前沿领域的交叉应用。最后，“动手实践”部分将提供一系列精心设计的计算练习，帮助读者将理论知识付诸实践，加深对这两种分析方法的理解和掌握。

## 原理与机制

在分子轨道理论的框架内，分子的电子结构是通过一组[原子轨道](@entry_id:140819)（Atomic Orbitals, AOs）的[线性组合](@entry_id:154743)来描述的。在自洽场（Self-Consistent Field, SCF）计算中，这种描述最终被编码在一个关键的数学对象中：[密度矩阵](@entry_id:139892)。然而，从[密度矩阵](@entry_id:139892)中提取化学家所熟悉的、直观的概念，如[原子电荷](@entry_id:204820)或[键级](@entry_id:142548)，并非易事。其根本挑战在于，原子轨道[基组](@entry_id:160309)通常是非正交的，这意味着不同原子上的[轨道](@entry_id:137151)存在空间上的重叠。本章将深入探讨两种最基础且具开创性的布居分析方法——[Mulliken布居分析](@entry_id:164573)和Löwdin布居分析——的原理、机制及其内在局限性。

### 电子密度的划分问题

在一个非正交的[原子轨道](@entry_id:140819)[基组](@entry_id:160309) $\{\chi_{\mu}\}$ 中，分子的总电子密度 $\rho(\mathbf{r})$ 可以表示为：

$$
\rho(\mathbf{r}) = \sum_{\mu,\nu} D_{\mu\nu} \chi_{\mu}(\mathbf{r}) \chi_{\nu}^{*}(\mathbf{r})
$$

其中，$D_{\mu\nu}$ 是在原子轨道[基组](@entry_id:160309)表示下的[单粒子密度矩阵](@entry_id:201498)的元素。通过对整个空间的电子密度进行积分，我们可以得到体系的总电子数 $N$：

$$
N = \int \rho(\mathbf{r}) d\mathbf{r} = \sum_{\mu,\nu} D_{\mu\nu} \int \chi_{\mu}(\mathbf{r}) \chi_{\nu}^{*}(\mathbf{r}) d\mathbf{r} = \sum_{\mu,\nu} D_{\mu\nu} S_{\nu\mu} = \mathrm{Tr}(\mathbf{DS})
$$

这里，$S_{\nu\mu} = \int \chi_{\nu}(\mathbf{r}) \chi_{\mu}^{*}(\mathbf{r}) d\mathbf{r}$ 是[重叠矩阵](@entry_id:268881) $\mathbf{S}$ 的矩阵元。这个表达式清晰地揭示了问题的核心：总电子数 $N$ 不仅仅是密度矩阵对角元 $D_{\mu\mu}$（常被称为“净布居”）的总和，还包含了大量的非对角项 $D_{\mu\nu}S_{\nu\mu}$（$\mu \neq \nu$）。这些非对角项源于不同原子轨道之间的重叠，它们所代表的“[重叠布居](@entry_id:276854)”（overlap population）在空间上属于多个原子，无法被唯一地归属于任何一个原子中心。

布居分析的本质，就是提出一种系统性的方案，将这些[重叠布居](@entry_id:276854)分配到各个原子上，从而将总电子数 $N$ 划分为各个原子的贡献之和，即[原子电荷](@entry_id:204820)。

### [Mulliken布居分析](@entry_id:164573)：一种直观但任意的划分

[Mulliken布居分析](@entry_id:164573)是最早被提出且概念上最简单的方法之一。它的核心思想是采取一种看似公平的策略：将任意一对[原子轨道](@entry_id:140819) $\chi_\mu$ 和 $\chi_\nu$ 之间的[重叠布居](@entry_id:276854)（对于实[轨道](@entry_id:137151)，其贡献为 $2D_{\mu\nu}S_{\mu\nu}$）在两者之间进行**平均分配** [@problem_id:1382546]。

#### 形式化表述

根据这个平均分配原则，[轨道](@entry_id:137151) $\chi_\mu$ 的总电子布居，即**总[轨道](@entry_id:137151)布居**（gross orbital population）$g_\mu$，等于其自身的净布居 $D_{\mu\mu}$（假设[轨道](@entry_id:137151)已归一化，$S_{\mu\mu}=1$）加上它从所有其他[轨道](@entry_id:137151) $\chi_\nu$ 的[重叠布居](@entry_id:276854)中分得的一半：

$$
g_\mu = D_{\mu\mu} + \sum_{\nu \neq \mu} D_{\mu\nu} S_{\nu\mu}
$$

将净布居项 $D_{\mu\mu}$ 写为 $D_{\mu\mu}S_{\mu\mu}$，上式可以合并成一个更为简洁的矩阵形式：

$$
g_\mu = \sum_{\nu} D_{\mu\nu} S_{\nu\mu} = (\mathbf{DS})_{\mu\mu}
$$

因此，Mulliken总[轨道](@entry_id:137151)布居就是矩阵乘积 $\mathbf{DS}$ 的对角元。一个原子 $A$ 的**总原子布居**（gross atomic population）$G_A$ 就是其上所有[原子轨道](@entry_id:140819)总布居之和，$G_A = \sum_{\mu \in A} g_\mu$。最后，Mulliken[原子电荷](@entry_id:204820) $q_A$ 定义为[原子核](@entry_id:167902)[电荷](@entry_id:275494) $Z_A$ 与总原子布居之差：$q_A = Z_A - G_A$ [@problem_id:2777441]。

#### 电子数守恒

Mulliken方案的一个重要特性是它严格保证了总电子数守恒。所有总原子布居之和等于总电子数 $N$：

$$
\sum_A G_A = \sum_\mu g_\mu = \sum_\mu (\mathbf{DS})_{\mu\mu} = \mathrm{Tr}(\mathbf{DS}) = N
$$

这一性质是任何合理的布居分析方案都必须满足的基本要求 [@problem_id:2906540]。

#### 划分的任意性

尽管Mulliken的平均分配原则非常直观，但我们必须认识到，这只是一种数学上的规定，缺乏严格的物理依据。事实上，我们可以设想一个更广义的[划分方案](@entry_id:635750)，其中[重叠布居](@entry_id:276854) $2D_{\mu\nu}S_{\mu\nu}$ 按权重 $w_{\mu\nu}$ 和 $w_{\nu\mu}$ 分配给[轨道](@entry_id:137151) $\mu$ 和 $\nu$，只要满足 $w_{\mu\nu} + w_{\nu\mu} = 1$ 即可保证电子数守恒。Mulliken方案仅仅是选择了 $w_{\mu\nu} = 1/2$ 这一特殊情况。

我们可以考虑另一种划分方式，例如，根据每个[轨道](@entry_id:137151)上已有的净布居大小来分配[重叠布居](@entry_id:276854)，即 $w_{\mu\nu} = D_{\mu\mu} / (D_{\mu\mu} + D_{\nu\nu})$。这种方案会倾向于将更多的[重叠布居](@entry_id:276854)分配给电子密度更高的原子。在一个简单的[异核双原子分子](@entry_id:145325)的计算示例中可以证明，采用这种权重方案会得到与标准Mulliken分析显著不同的[原子电荷](@entry_id:204820)，这有力地说明了Mulliken方法乃至所有基于[轨道重叠](@entry_id:143431)划分的方法所固有的任意性 [@problem_id:2906486]。

### Löwdin布居分析：在[正交基](@entry_id:264024)中的划分

Löwdin布居分析提出了一种更为精巧的思路，它从根源上回避了如何划分[重叠布居](@entry_id:276854)这一难题。其核心策略是：在进行布居分析**之前**，首先通过一个数学变换将原始的非正交[原子轨道](@entry_id:140819)[基组](@entry_id:160309)转化为一个全新的**正交**[原子轨道](@entry_id:140819)[基组](@entry_id:160309)。

#### [对称正交化](@entry_id:167626)

Löwdin采用的变换被称为**[对称正交化](@entry_id:167626)**（symmetric orthogonalization）。对于一个给定的[非正交基组](@entry_id:190211) $|\chi\rangle$ 及其[重叠矩阵](@entry_id:268881) $\mathbf{S}$，新的正交基组 $|\tilde{\chi}\rangle$ 通过以下方式构建：

$$
|\tilde{\chi}\rangle = |\chi\rangle \mathbf{S}^{-1/2}
$$

其中 $\mathbf{S}^{-1/2}$ 是[重叠矩阵](@entry_id:268881) $\mathbf{S}$ 的逆平方根。这个变换得到的[基组](@entry_id:160309)是正交的，即其[重叠矩阵](@entry_id:268881) $\tilde{\mathbf{S}}$ 为[单位矩阵](@entry_id:156724) $\mathbf{I}$。[对称正交化](@entry_id:167626)的一个重要特性是，在所有可能的[正交化](@entry_id:149208)方案中，它所产生的正交[轨道](@entry_id:137151)在最小二乘意义上与原始的原子轨道最为接近，因此在化学上保留了最大程度的“原子”特性。

#### 形式化表述

当[基组](@entry_id:160309)从非正交的 $\{\chi_\mu\}$ 变换为正交的 $\{\tilde{\chi}_\mu\}$ 时，密度矩阵也必须进行相应的变换，以保证总电子密度等物理可观测量不变。正确的密度矩阵变换关系为：

$$
\tilde{\mathbf{D}} = \mathbf{S}^{1/2} \mathbf{D} \mathbf{S}^{1/2}
$$
[@problem_id:2906524] [@problem_id:2905908]

在这个新的[正交基](@entry_id:264024)中，[重叠布居](@entry_id:276854)已不复存在。因此，布居分析变得异常简单：[轨道](@entry_id:137151) $\tilde{\chi}_\mu$ 的布居就是其对应的[密度矩阵](@entry_id:139892)对角元 $\tilde{D}_{\mu\mu}$。Löwdin总原子布居 $G_A^{\mathrm{L}}$ 就是与原子 $A$ 相关的所有正交化[轨道](@entry_id:137151)的布居之和：

$$
G_A^{\mathrm{L}} = \sum_{\mu \in A} \tilde{D}_{\mu\mu} = \sum_{\mu \in A} (\mathbf{S}^{1/2} \mathbf{D} \mathbf{S}^{1/2})_{\mu\mu}
$$

从概念上讲，Löwdin分析等价于在[对称正交化](@entry_id:167626)的[基组](@entry_id:160309)中进行Mulliken分析。因为在新[基组](@entry_id:160309)中 $\tilde{\mathbf{S}}=\mathbf{I}$，Mulliken公式 $(\tilde{\mathbf{D}}\tilde{\mathbf{S}})_{\mu\mu}$ 就直接简化为了 $\tilde{D}_{\mu\mu}$ [@problem_id:2906524]。同样，利用迹的循环不变性，可以证明Löwdin分析也严格遵守电子数守恒 [@problem_id:2906540]：

$$
\sum_A G_A^{\mathrm{L}} = \mathrm{Tr}(\tilde{\mathbf{D}}) = \mathrm{Tr}(\mathbf{S}^{1/2} \mathbf{D} \mathbf{S}^{1/2}) = \mathrm{Tr}(\mathbf{D} \mathbf{S}^{1/2} \mathbf{S}^{1/2}) = \mathrm{Tr}(\mathbf{DS}) = N
$$

尽管在[正交基](@entry_id:264024)的极限情况下（例如在理想的Hückel模型中，$\mathbf{S}=\mathbf{I}$），Mulliken和Löwdin分析会给出完全相同的结果 [@problem_id:2777441]，但在普遍的[非正交基组](@entry_id:190211)中，这两种方法计算出的[原子电荷](@entry_id:204820)通常是不同的。一个对线性对称[三原子分子](@entry_id:155569)的具体计算可以清晰地展示出这两种方法所得[电荷](@entry_id:275494)的数值差异 [@problem_id:1382535]。

### 性质、缺陷与实践考量

Mulliken和Löwdin分析不仅在概念上有所不同，在实际应用中也表现出迥异的性质和稳定性。

#### 物理边界与[基组依赖性](@entry_id:197523)

一个关键的差异在于布居数是否符合物理直觉。根据[泡利不相容原理](@entry_id:141850)，一个[自旋轨道](@entry_id:274032)最多只能容纳一个电子，因此任何一个（自旋加和的）空间[轨道](@entry_id:137151)的电子布居数都应该在 $[0, 2]$ 的物理区间内。

- **Mulliken分析的缺陷**：Mulliken布居数 $(\mathbf{DS})_{\mu\mu}$ 可能会出现小于0或大于2的**非物理值**。其数学根源在于，矩阵 $\mathbf{DS}$ 通常是非厄米（non-Hermitian）的，它的对角元不受其[特征值](@entry_id:154894)的约束。当[基组](@entry_id:160309)中存在弥散函数（diffuse functions）导致大的轨道重叠，或出现特定的正负号组合的键级（$D_{\mu\nu}$）和重叠积分（$S_{\nu\mu}$）时，就可能导致总[轨道](@entry_id:137151)布居超出物理范围 [@problem_id:2449508]。

- **Löwdin分析的稳健性**：与此相反，Löwdin布居数 $\tilde{D}_{\mu\mu}$ **总是**位于 $[0, 2]$ 的物理区间内。这是因为变换后的[密度矩阵](@entry_id:139892) $\tilde{\mathbf{D}}$ 是一个[厄米矩阵](@entry_id:155147)，它代表了在一个[正交基](@entry_id:264024)中的[密度算符](@entry_id:138151)。对于任何合理的[波函数](@entry_id:147440)，该[密度算符](@entry_id:138151)的[本征值](@entry_id:154894)（自然[轨道](@entry_id:137151)占据数）都必须在 $[0, 2]$ 区间内。根据线性代数的基本定理，厄米矩阵的对角元必然介于其最小和最大[本征值](@entry_id:154894)之间，从而保证了Löwdin布居数的物理意义 [@problem_id:2449508]。

这种稳健性的差异在[基组](@entry_id:160309)接近**线性相关**（linear dependence）时表现得尤为突出。当[基组](@entry_id:160309)包含两个或多个在空间上非常相似的函数时，[重叠矩阵](@entry_id:268881) $\mathbf{S}$ 会出现接近于零的[本征值](@entry_id:154894)。在这种情况下：

- **[Mulliken电荷](@entry_id:269216)**会表现出极端的**不稳定性**。对分子[轨道](@entry_id:137151)系数的微小扰动可能会导致[Mulliken电荷](@entry_id:269216)发生剧烈甚至发散性的变化，结果完全失去参考价值。
- **Löwdin[电荷](@entry_id:275494)**则表现出好得多的**稳定性**。通过[对称正交化](@entry_id:167626)过程，Löwdin方法能够平滑地处理近[线性相关](@entry_id:185830)问题，得到的[电荷](@entry_id:275494)值随[基组](@entry_id:160309)变化更加连续和可控 [@problem_id:2906503]。

在实际计算中，[Mulliken电荷](@entry_id:269216)对[基组](@entry_id:160309)的选择极为敏感，特别是当从一个小的[基组](@entry_id:160309)（如 `6-31G`）变到一个包含[弥散函数](@entry_id:267705)（如 `6-31+G(d)`）或多组极化函数的大[基组](@entry_id:160309)时，其[电荷](@entry_id:275494)值可能发生剧烈[振荡](@entry_id:267781)甚至符号反转，尤其对于阴离子体系更是如此 [@problem_id:2916437] [@problem_id:1382544]。Löwdin[电荷](@entry_id:275494)虽然也依赖于[基组](@entry_id:160309)，但其收敛行为通常更为平稳和可靠。

#### 方法的拓展与其他替代方案

由于Mulliken和Löwdin分析（尤其是前者）存在明显的缺陷，研究者们发展了许多更为先进和稳健的布居分析方法。这些方法，如**自然布居分析**（Natural Population Analysis, NPA）、**内禀[原子轨道](@entry_id:140819)**（Intrinsic Atomic Orbitals, IAO）分析，以及基于[实空间](@entry_id:754128)电子密度划分的**Hirshfeld方法**等，其共同目标是获得对基[组选择](@entry_id:175784)不敏感、且具有更清晰物理意义的[原子电荷](@entry_id:204820)。它们通常通过将计算得到的[波函数](@entry_id:147440)[信息投影](@entry_id:265841)到一个化学意义明确的、稳定的最小原子轨道空间，或直接在三维空间中划分电子密度，从而有效克服了Mulliken和Löwdin分析的诸多困难 [@problem_id:2916437]。

此外，这些布居分析的框架也可以被拓展。例如，在处理[开壳层体系](@entry_id:168723)时，只需将总密度矩阵定义为 $\alpha$ 自旋和 $\beta$ 自旋密度矩阵之和（$\mathbf{D}^{\text{total}} = \mathbf{D}^{\alpha} + \mathbf{D}^{\beta}$）即可应用相同的分析流程 [@problem_id:2777441]。布居分析的概念也被用于定义**键级**（bond order），例如在Löwdin框架中，著名的[Wiberg键级指数](@entry_id:189435)就是通过变换后的[密度矩阵](@entry_id:139892) $\tilde{\mathbf{D}}$ 的非对角元来定义的 [@problem_id:2905908]。

总之，Mulliken和Löwdin布居分析为从[量子化学](@entry_id:140193)计算中提取化学概念提供了基础性的方法论。理解它们的原理、差异和局限性，是评判和选用更现代的[电荷](@entry_id:275494)分析方案、并正确解读[计算化学](@entry_id:143039)结果的关键一步。