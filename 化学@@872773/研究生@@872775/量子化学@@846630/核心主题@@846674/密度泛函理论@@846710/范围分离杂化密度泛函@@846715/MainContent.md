## 引言
[密度泛函理论(DFT)](@entry_id:186519)已成为现代[量子化学](@entry_id:140193)和[材料科学](@entry_id:152226)中应用最广泛的[电子结构计算](@entry_id:748901)方法之一。凭借其在计算成本与精度之间的卓越平衡，DFT在预测分子几何、[反应能](@entry_id:143747)和许多[基态](@entry_id:150928)性质方面取得了巨大成功。然而，标准近似泛函，如局部密度近似(LDA)和[广义梯度近似](@entry_id:274118)(GGA)，在处理涉及长程电子相互作用的问题时会遭遇系统性困难。这些困难源于其固有的[自相互作用误差](@entry_id:139981)和错误的[交换相关势](@entry_id:180254)渐进行为，导致在预测[电离势](@entry_id:198846)、[带隙](@entry_id:191975)、里德堡激发和[电荷转移](@entry_id:155270)过程时出现严重偏差。

为了克服这些根本性缺陷，[范围分离杂化](@entry_id:165056)(RSH)泛函应运而生，它为系统性地改进密度泛函提供了一条强大而灵活的途径。RSH的核心思想是将电子间的[库仑相互作用](@entry_id:747947)精确地划分为短程和长程两个区域，并为每个区域量身定制不同的理论描述，从而“扬长避短”，在保持计算效率的同时显著提升理论的预测能力。

本文旨在对[范围分离杂化泛函](@entry_id:184447)进行全面而深入的介绍。在接下来的章节中，我们将首先在 **“原理与机制”** 中，深入探讨范围分离的数学基础、物理动机以及广义Kohn-Sham框架下的泛函构造。随后，我们将在 **“应用与[交叉](@entry_id:147634)学科联系”** 中，展示[RSH泛函](@entry_id:184447)如何在[分子光谱学](@entry_id:148164)、[光化学](@entry_id:140933)、凝聚态物理等多个领域解决关键科学问题，并讨论不同类型[RSH泛函](@entry_id:184447)的适用场景。最后， **“动手实践”** 部分将提供具体问题，帮助读者巩固对核心概念的理解。通过本系列的学习，读者将掌握[RSH泛函](@entry_id:184447)背后的深刻物理思想，并了解其作为前沿计算工具的巨大潜力。

## 原理与机制

在[密度泛函理论](@entry_id:139027) (Density Functional Theory, DFT) 的框架中，交换相关 (exchange-correlation, XC) 泛函的近似形式是决定其预测能力的核心。尽管如局部密度近似 (Local Density Approximation, [LDA](@entry_id:138982)) 和[广义梯度近似](@entry_id:274118) (Generalized Gradient Approximation, GGA) 等半定域泛函在许多应用中取得了显著成功，但它们也存在一些固有的系统性缺陷。这些缺陷主要源于对电子间相互作用的长程部分的描述不准确，导致了[自相互作用误差](@entry_id:139981) (self-interaction error, SIE) 和[交换相关势](@entry_id:180254)的错误渐进行为等问题。[范围分离杂化](@entry_id:165056) (Range-Separated Hybrid, RSH) 泛函的提出，正是为了系统性地解决这些长程相互作用问题，从而在保持[计算效率](@entry_id:270255)的同时，显著提升 DFT 的准确性和可靠性。本章将深入探讨[范围分离杂化泛函](@entry_id:184447)的基本原理与核心机制。

### [库仑算符](@entry_id:178946)的数学划分

范围分离思想的数学基础是将电子间的[库仑相互作用](@entry_id:747947)算符 $1/r$ 精确地划分为短程 (short-range, SR) 和长程 (long-range, LR) 两个部分。这种划分可以通过多种方式实现，其中最常用和最成熟的方法是利用[误差函数](@entry_id:176269) (error function, $\operatorname{erf}$) 及其互补函数 (complementary error function, $\operatorname{erfc}$) [@problem_id:2919420]。

根据定义，$\operatorname{erf}(x) + \operatorname{erfc}(x) = 1$ 对任意实数 $x$ 恒成立。令 $x = \omega r$，其中 $r$ 是电子间距离，$ \omega $ 是一个可调的正常数，称为**范围分离参数**，其量纲为长度的倒数。利用此恒等式，我们可以将[库仑算符](@entry_id:178946)精确地写为：

$$
\frac{1}{r} = \frac{1 \cdot (\operatorname{erf}(\omega r) + \operatorname{erfc}(\omega r))}{r} = \frac{\operatorname{erf}(\omega r)}{r} + \frac{\operatorname{erfc}(\omega r)}{r}
$$

这个等式对于任意 $\omega > 0$ 和 $r > 0$ 都是严格成立的。现在我们来分析这两个部分的物理意义。我们定义长程部分为 $w^{\text{lr}}(r) = \frac{\operatorname{erf}(\omega r)}{r}$，短程部分为 $w^{\text{sr}}(r) = \frac{\operatorname{erfc}(\omega r)}{r}$。

为了理解它们的“长程”与“短程”特性，我们考察它们在 $r \to 0$ 和 $r \to \infty$ 时的极限行为 [@problem_id:2919420]。

*   对于短程部分 $w^{\text{sr}}(r) = \frac{\operatorname{erfc}(\omega r)}{r}$：
    *   当 $r \to 0^+$ 时，$\omega r \to 0^+$，而已知 $\operatorname{erfc}(0) = 1$，因此 $w^{\text{sr}}(r) \approx 1/r$。这意味着该项在短距离处重现了[库仑算符](@entry_id:178946)的 $1/r$ 奇异性。
    *   当 $r \to \infty$ 时，$\omega r \to \infty$，而已知 $\operatorname{erfc}(\infty) = 0$。实际上，$\operatorname{erfc}(x)$ 的衰减速度是高斯型的（快于任何 $r$ 的负幂次），因此 $w^{\text{sr}}(r)$ 在长距离处迅速趋于零。
    这种在短程处行为正常、在长程处迅速衰减的特性，正是**[短程相互作用](@entry_id:145678)**的定义。

*   对于长程部分 $w^{\text{lr}}(r) = \frac{\operatorname{erf}(\omega r)}{r}$：
    *   当 $r \to \infty$ 时，$\omega r \to \infty$，而已知 $\operatorname{erf}(\infty) = 1$，因此 $w^{\text{lr}}(r) \to 1/r$。这意味着该项在长距离处正确地恢复了完整的库仑相互作用。
    *   当 $r \to 0^+$ 时，这是一个 $0/0$ 型的[不定式](@entry_id:144301)。利用[洛必达法则](@entry_id:147503)和 $\frac{d}{dx}\operatorname{erf}(x) = \frac{2}{\sqrt{\pi}}\exp(-x^2)$，可以得到 $\lim_{r\to 0^+} \frac{\operatorname{erf}(\omega r)}{r} = \frac{2\omega}{\sqrt{\pi}}$，这是一个有限的常数。
    这种在短程处非奇异、在长程处恢复完整相互作用的特性，正是**[长程相互作用](@entry_id:140725)**的定义。

范围分离参数 $\omega$ 控制着短程和长程之间的过渡尺度，[特征长度](@entry_id:265857)可以认为是 $\ell \approx 1/\omega$。通过考察 $\omega$ 的极限情况，我们可以更清楚地理解其作用 [@problem_id:2919420]：

*   当 $\omega \to 0^+$ 时，$w^{\text{lr}}(r) \to 0$，$w^{\text{sr}}(r) \to 1/r$。此时，整个库仑相互作用都被视为“短程”，范围分离失效。这对应于一个纯粹的半定域 DFT 泛函。
*   当 $\omega \to \infty$ 时，$w^{\text{lr}}(r) \to 1/r$，$w^{\text{sr}}(r) \to 0$。此时，整个库仑相互作用都被视为“长程”。

因此，对于固定的距离 $r$，增大 $\omega$ 会使得[短程相互作用](@entry_id:145678)的范围变小，并将更多的相互作用权重从短程部分转移到长程部分。

从[动量空间](@entry_id:148936)的角度看，这种划分有更深刻的物理解释 [@problem_id:2919453]。实空间中的长距离对应于[动量空间](@entry_id:148936)中的[小波](@entry_id:636492)矢 $q$，而短距离对应于大[波矢](@entry_id:178620) $q$。利用[傅里叶变换](@entry_id:142120)和卷积定理可以证明，长程算符 $w^{\text{lr}}(r)$ 在[动量空间](@entry_id:148936)中的形式为：

$$
w^{\text{lr}}(q) = \frac{4\pi}{q^2} \exp\left(-\frac{q^2}{4\omega^2}\right)
$$

而短程算符的形式为：

$$
w^{\text{sr}}(q) = \frac{4\pi}{q^2} \left[1 - \exp\left(-\frac{q^2}{4\omega^2}\right)\right]
$$

这里的 $\frac{4\pi}{q^2}$ 是完整[库仑算符](@entry_id:178946) $1/r$ 的[傅里叶变换](@entry_id:142120)。可以看出，长程部分通过一个高斯型因子 $\exp(-q^2/(4\omega^2))$ 抑制了高[波矢](@entry_id:178620) ($q \gg 2\omega$) 的分量，保留了低波矢分量，相当于一个**低通滤波器**。相反，短程部分抑制了低波矢分量，保留了高波矢分量，相当于一个**[高通滤波器](@entry_id:274953)**。这再次说明，参数 $\omega$ 设定了[动量空间](@entry_id:148936)中的一个特征截止[波矢](@entry_id:178620) $q_c \approx 2\omega$，从而在实空间中定义了特征过渡长度 $\ell \approx 1/q_c \sim 1/\omega$ [@problem_id:2919453]。

### 物理动机：修正标准DFT的缺陷

范围分离的强大之处在于，它允许我们对短程和长程的电子相互作用采用不同的理论方法来处理，从而“扬长避短”，结合不同近似方法的优势。其核心物理动机是为了修正标准半定域泛函（如[LDA](@entry_id:138982)和GGA）中的两个关键缺陷：自相互作用误差和错误的渐进行为。

#### 单电子自相互作用误差

对于一个单电子体系，电子不应与自身发生相互作用。在精确的理论中，哈特里 (Hartree) 能量 $E_H[n]$（即电子密度与其自身的经典[库仑排斥](@entry_id:181876)能）必须被[交换相关能](@entry_id:138029) $E_{xc}[n]$ 完全抵消。因此，对于任何单电子密度 $n$，精确的[交换相关泛函](@entry_id:142042)必须满足 $E_H[n] + E_{xc}[n] = 0$。任何偏离零的残[余能](@entry_id:192009)量都被称为**单电子[自相互作用误差](@entry_id:139981) (SIE)** [@problem_id:2919392]。

标准的半定域泛函严重违反了这一条件，导致了许多非物理的结果。例如，在拉伸 $H_2^+$ 分子的过程中，半定域泛函会错误地将单个电子平均分配在两个相距很远的质子上，每个质子带有 $+0.5$ 的分数[电荷](@entry_id:275494)，而不是正确地将[电子定域](@entry_id:261499)在其中一个质子上，得到 $H + H^+$ 的解离极限。这种错误被称为**[离域误差](@entry_id:166117) (delocalization error)**，是 SIE 的直接后果 [@problem_id:2919445]。

[范围分离杂化泛函](@entry_id:184447)通过在长程部分引入精确的 Hartree-Fock (HF) 交换来解决这个问题。对于一个单电子体系，其 HF 交换能 $E_x^{\text{HF}}$ 恰好等于其[哈特里能量](@entry_id:167303)的负值，即 $E_x^{\text{HF}} = -E_H[n]$。因此，HF 理论是无单电子 SIE 的。

在 RSH 框架下，我们将[哈特里能量](@entry_id:167303)和交换能都分解为长程和短程部分。对于单电子密度，长程 HF 交换能 $E_x^{\text{lr,HF}}$ 被证明可以精确地抵消长程[哈特里能量](@entry_id:167303) $E_H^{\text{lr}}[n]$ [@problem_id:2919392]：

$$
E_H^{\text{lr}}[n] + E_x^{\text{lr,HF}}[n] = 0
$$

这意味着，通过使用长程 HF 交换，我们**完全消除了单电子[自相互作用误差](@entry_id:139981)的长程部分**。残余的 SIE 被限制在短程区域，而短程 SIE 的影响通常要小得多。这种对长程 SIE 的消除，正是 RSH 泛函能够正确描述 $H_2^+$ 解离、避免分数[电荷](@entry_id:275494)问题、并显著减轻[离域误差](@entry_id:166117)的根本原因 [@problem_id:2919445]。

#### [交换相关势](@entry_id:180254)的渐进行为

对于一个有限的、中性的 N 电子体系，当一个电子远离体系时（即 $r \to \infty$），它所感受到的有效势应该来自于一个带有 $+1$ 净[电荷](@entry_id:275494)的 $(N-1)$ 电子体系。因此，精确的[交换相关势](@entry_id:180254) $v_{xc}(\mathbf{r})$ 在 $r \to \infty$ 时必须具有 $-1/r$ 的渐进行为。

然而，半定域泛函的 $v_{xc}$ 是随电子密度 $\rho(\mathbf{r})$ 指数衰减的，这在物理上是错误的。这种错误的渐进行为导致对里德堡 (Rydberg) 态、电荷转移 (charge-transfer, CT) 激发以及[电离势](@entry_id:198846)的描述出现严重偏差。

RSH 泛函通过引入长程 HF 交换，可以完美地修正这一缺陷。可以严格证明，对于一个中性体系，在一个包含长程 HF 交换的 RSH 泛函中，有效单电子势在 $r \to \infty$ 时的渐进行为恰好是 $-1/r$ [@problem_id:2919459]。其推导思路如下：
1.  **外部势 $v_{\text{ext}}(\mathbf{r})$**：来自总[电荷](@entry_id:275494)为 $Z$ 的[原子核](@entry_id:167902)，其渐进行为是 $-Z/r$。
2.  **哈特里势 $v_H(\mathbf{r})$**：来自总[电荷](@entry_id:275494)为 $N$ 的电子云，其渐进行为是 $N/r$。
3.  **短程[交换相关势](@entry_id:180254) $v_{xc}^{\text{sr}}(\mathbf{r})$**：其衰减速度快于 $1/r$，对渐进行为的贡献为 $0$。
4.  **长程 HF [交换算符](@entry_id:156554) $K_{\omega}^{\text{LR}}$**：这是一个非定域算符，但其在 $r \to \infty$ 时对一个[轨道](@entry_id:137151) $\phi_i(\mathbf{r})$ 的有效作用可以证明是等效于一个定域势 $-1/r$。

将这些项加和，并利用中性体系的条件 $Z=N$，总的渐进势为：

$$
V_{\text{asym}}(r) = -\frac{Z}{r} + \frac{N}{r} + 0 - \frac{1}{r} = \frac{N-Z-1}{r} = -\frac{1}{r}
$$

正确的 $-1/r$ 渐进势的恢复，是 RSH 泛函能够准确计算里德堡态、长程 CT 激发能以及满足[电离势定理](@entry_id:178221)的基础。

### 泛函的构造与理论框架

基于上述的数学划分和物理动机，我们可以构造出 RSH [交换相关泛函](@entry_id:142042)。标准的**长程修正 (long-range corrected, LC)** 泛函的构造策略如下 [@problem_id:2919424]：

$$
E_{xc}^{\text{RSH}}[n, \{\phi_i\}] = E_x^{\text{lr,HF}}[\{\phi_i\}] + E_x^{\text{sr,DFT}}[n] + E_c^{\text{DFT}}[n]
$$

其中：
*   $E_x^{\text{lr,HF}}[\{\phi_i\}]$ 是利用[长程相互作用](@entry_id:140725)算符 $w^{\text{lr}}(r)$ 构建的[轨道](@entry_id:137151)依赖的 HF [交换能](@entry_id:137069)。
*   $E_x^{\text{sr,DFT}}[n]$ 是利用[短程相互作用](@entry_id:145678)算符 $w^{\text{sr}}(r)$ 构建的密度泛函形式的短程交换能。
*   $E_c^{\text{DFT}}[n]$ 是[相关能](@entry_id:144432)，通常采用一个完整的（未分离的）或仅短程的半定域密度泛函来近似。

由于包含了[轨道](@entry_id:137151)依赖的非定域 HF 交换项，这种泛函不能在标准的 Kohn-Sham (KS) 框架下求解，后者要求有效势必须是定域的乘法算符。取而代之的是，我们需要采用**广义 Kohn-Sham (Generalized Kohn-Sham, GKS)** 框架 [@problem_id:2919397]。GKS 允许单粒子有效[哈密顿算符](@entry_id:144286)是一个厄米的、但不必是定域乘法形式的算符。

在一个典型的 RSH-GKS 方案中，求解的单粒子方程为 $\hat{F}\phi_i = \varepsilon_i \phi_i$，其中 GKS 算符 $\hat{F}$ 的具体形式为 [@problem_id:2919401]：

$$
\hat{F} = \hat{h} + \hat{J}[n] + \hat{K}^{\text{lr}}[\{\phi_j\}] + v_{xc}^{\text{sr}}[n]
$$

各个算符的定义如下：
*   $\hat{h} = -\frac{1}{2}\nabla^2 + v_{ne}(\mathbf{r})$ 是单电子核心[哈密顿算符](@entry_id:144286)，包含动能和核-电子吸引势。
*   $\hat{J}[n]$ 是经典的哈特里[排斥势](@entry_id:185622)算符，它是一个定域的乘法势，由总电子密度 $n$ 决定。
*   $\hat{K}^{\text{lr}}[\{\phi_j\}]$ 是**非定域**的长程[交换算符](@entry_id:156554)。它作用在一个[轨道](@entry_id:137151) $\phi_i$ 上时，会产生一个依赖于所有占据[轨道](@entry_id:137151) $\{\phi_j\}$ 的积分项，这正是其[非定域性](@entry_id:140165)的体现。
*   $v_{xc}^{\text{sr}}[n]$ 是一个定域的乘法势，由短程[交换相关能](@entry_id:138029)量泛函对密度求泛函导数得到。

GKS 框架的优点在于，它能够直接通过[变分法](@entry_id:163656)最小化[轨道](@entry_id:137151)依赖的能量泛函，而无需构造一个等效但复杂的定域势（即所谓的优化[有效势](@entry_id:142581)，OEP），从而为包含[精确交换](@entry_id:178558)的杂化泛函提供了坚实而实用的理论基础 [@problem_id:2919397]。

从更形式化的角度看，RSH 的构造也可以通过**范围分离[绝热连接](@entry_id:199259) (range-separated adiabatic connection)** 路径来严格导出 [@problem_id:2919438]。通过只对[长程相互作用](@entry_id:140725)部分引入一个耦合常数 $\lambda$ 并进行积分，总的哈特里-交换-[相关能](@entry_id:144432)量可以精确地分解为一个对[长程相互作用](@entry_id:140725)[期望值](@entry_id:153208)的积分，外加一个互补的短程泛函。这为 RSH 泛函的“混合”形式提供了第一性原理的理论依据。

### 关键性质与应用

RSH 泛函通过修正标准 DFT 的长程缺陷，带来了一系列重要的性质改进和应用扩展。

#### [电离势定理](@entry_id:178221)与参数调优

在精确的 DFT 理论中，**[电离势](@entry_id:198846) (IP) 定理**指出，体系的最高占据分子[轨道](@entry_id:137151) (Highest Occupied Molecular Orbital, HOMO) 的能量 $\varepsilon_{\text{HOMO}}$ 精确等于其负的垂直[电离势](@entry_id:198846) $-I$。这个定理的理论基础是，[基态能量](@entry_id:263704) $E$ 作为电子数 $N$ 的函数，在整数之间是分段线性的。

对于 LDA/GGA 等近似泛函，由于 SIE 的存在，$E(N)$ 曲线是伪凸的，导致 $\varepsilon_{\text{HOMO}}$ 严重偏离 $-I$。RSH 泛函，特别是包含 $100\%$ 长程 HF 交换的 LC 型泛函，通过恢复正确的 $-1/r$ 渐进势，极大地改善了 $E(N)$ 的线性行为。然而，要使 IP 定理近似满足，范围分离参数 $\omega$ 的取值至关重要。

一种被称为**最优调优 (optimal tuning)** 的现代方法，通过非经验的方式为特定体系确定最佳的 $\omega$ 值 [@problem_id:2919411]。其核心思想是，调整 $\omega$ 使得通过 HOMO 能量计算的 IP 与通过 $\Delta$SCF 方法（即 $I = E(N-1) - E(N)$）计算的 IP 相等。当这个条件满足时，可以认为泛函在该体系上近似恢复了分段线性行为，从而显著减小了[离域误差](@entry_id:166117)，并能准确预测与[电荷](@entry_id:275494)增减相关的各种性质。

#### LC 与 HSE 泛函的对比

尽管我们主要讨论了长程修正 (LC) 型的 RSH，但另一类重要的 RSH 泛函是**屏蔽交换 (screened-exchange)** 泛函，其代表是 Heyd–Scuseria–Ernzerhof (HSE) 泛函 [@problem_id:2919430]。这两种泛函采用的是相反的范围分离策略：

*   **LC 型泛函 (如 LC-PBE, $\omega$PBEh)**：在长程使用 HF 交换，在短程使用半定域 DFT 交换。
    *   **优点**：能够修正 $v_{xc}$ 的渐进行为，正确描述分子体系的[电离势](@entry_id:198846)、里德堡态和长程[电荷转移激发](@entry_id:174772)。
    *   **缺点**：对于具有高[介电屏蔽](@entry_id:266074)的周期性固体，未屏蔽的长程 HF 交换会过高地估计[带隙](@entry_id:191975)。

*   **HSE 型泛函 (如 HSE06)**：在短程使用一部分 HF 交换，在长程完全使用半定域 DFT 交换。
    *   **优点**：由于长程部分是半定域的，它有效地“屏蔽”了交换作用，更接近固体中的物理现实。因此，HSE 在计算[半导体](@entry_id:141536)和绝缘体的[带隙](@entry_id:191975)方面非常成功，是固态物理计算中的标准方法之一。
    *   **缺点**：由于长程部分仍是半定域的，它继承了半定域泛函的长程缺陷，即 $v_{xc}$ 渐进行为错误，无法通过参数调优来满足 IP 定理。

综上所述，[范围分离杂化泛函](@entry_id:184447)通过对[库仑算符](@entry_id:178946)的精巧划分，并结合不同理论方法的优势，为解决传统密度泛函理论中的长程相互作用问题提供了一条系统而有效的途径。它不仅深化了我们对[交换相关泛函](@entry_id:142042)的理解，也极大地扩展了 DFT 在[量子化学](@entry_id:140193)和[材料科学](@entry_id:152226)中的应用范围和预测能力。