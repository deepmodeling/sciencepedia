{"hands_on_practices": [{"introduction": "在近似密度泛函理论中，自相互作用误差是一个核心挑战。对于单电子体系，Hartree能量项中虚假的电子自身排斥必须被交换相关泛函精确抵消。这项练习 [@problem_id:2903585] 旨在检验您对这一精确条件的理解，并评估您判断哪些类型的泛函因其构造原理能够满足该条件的能力。", "problem": "在科恩-沈密度泛函理论 (DFT) 中，总能泛函写为\n$$\nE[n] = T_{\\mathrm{s}}[n] + \\int \\mathrm{d}\\mathbf{r}\\, v_{\\mathrm{ext}}(\\mathbf{r})\\, n(\\mathbf{r}) + E_{\\mathrm{H}}[n] + E_{\\mathrm{xc}}[n],\n$$\n其中 $T_{\\mathrm{s}}[n]$ 是无相互作用动能，$v_{\\mathrm{ext}}(\\mathbf{r})$ 是外势，$E_{\\mathrm{H}}[n]$ 是哈特里能量，$E_{\\mathrm{xc}}[n]$ 是交换相关能量。哈特里能量为\n$$\nE_{\\mathrm{H}}[n] = \\frac{1}{2}\\int \\mathrm{d}\\mathbf{r}\\int \\mathrm{d}\\mathbf{r}'\\, \\frac{n(\\mathbf{r})\\, n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}.\n$$\n考虑一个具有 $N=1$ 个电子的体系，其自旋密度为 $n_\\alpha(\\mathbf{r})=n(\\mathbf{r})$ 和 $n_\\beta(\\mathbf{r})=0$。从上述科恩-沈表达式出发，并基于一个真实的 $N=1$ 体系除了包含在 $E_{\\mathrm{H}}[n]$ 中的非物理自相互作用之外没有电子-电子相互作用这一物理事实，论证对于任何单电子密度 $n(\\mathbf{r})$，$E_{\\mathrm{H}}[n]$ 和 $E_{\\mathrm{xc}}[n]$ 之间必须满足什么精确约束。然后，根据不同密度泛函近似的形式结构，判断关于各类泛函满足此单电子约束的能力的陈述哪些是正确的。选择所有适用的选项。\n\nA. 任何能够恢复均匀电子气极限的局域或半局域近似（例如，局域密度近似（LDA）、广义梯度近似（GGA）或meta-GGA），根据其构造，对于每个单电子密度 $n(\\mathbf{r})$ 都会满足 $E_{\\mathrm{xc}}[n] = -E_{\\mathrm{H}}[n]$。\n\nB. 任何将非零分数 $a$（$0<a<1$）的精确交换与半局域交换相关部分混合的全局杂化泛函，对于单电子密度都会满足 $E_{\\mathrm{xc}}[n] = -E_{\\mathrm{H}}[n]$；$a$ 的值仅在 $N>1$ 时才重要。\n\nC. 只有那些以轨道依赖方式使用 $100\\%$ 精确交换的泛函（例如哈特里-福克交换或通过优化有效势（OEP）方法求解的科恩-沈精确交换），或通过显式的 Perdew–Zunger 自相互作用修正（SIC）增强的泛函，才能对所有单电子密度满足 $E_{\\mathrm{xc}}[n] = -E_{\\mathrm{H}}[n]$；标准的局域、半局域和部分交换的杂化近似通常不能满足。\n\nD. 一个仅在长程电子-电子距离处使用 $100\\%$ 精确交换的范围分离杂化泛函，对于任何单电子密度都会自动满足 $E_{\\mathrm{xc}}[n] = -E_{\\mathrm{H}}[n]$，而与短程半局域近似无关。\n\nE. 双杂化泛函对于单电子密度总是满足 $E_{\\mathrm{xc}}[n] = -E_{\\mathrm{H}}[n]$，因为当 $N=1$ 时，微扰相关项（例如，二阶 Møller–Plesset）为零。", "solution": "问题陈述在科学上是合理且表述清晰的。它展示了科恩-沈密度泛函理论的一个标准公式，并要求推导单电子体系的精确约束，然后评估不同类别的泛函是否满足该约束。\n\n首先，我们必须推导精确约束。对于任何量子体系，总能量是哈密顿量的期望值。对于只有一个电子（$N=1$）的体系，不存在电子-电子相互作用。哈密顿量仅包含动能算符 $\\hat{T}$ 和外势算符 $\\hat{V}_{\\mathrm{ext}}$。因此，精确的总能量为：\n$$E_{\\mathrm{exact}} = \\langle \\Psi | \\hat{T} + \\hat{V}_{\\mathrm{ext}} | \\Psi \\rangle$$\n其中 $\\Psi$ 是单电子波函数。用电子密度 $n(\\mathbf{r})=|\\Psi(\\mathbf{r})|^2$ 表示，即为 $E_{\\mathrm{exact}}[n] = T[n] + \\int \\mathrm{d}\\mathbf{r}\\, v_{\\mathrm{ext}}(\\mathbf{r})\\, n(\\mathbf{r})$，其中 $T[n]$ 是真实的有相互作用的动能。\n\n科恩-沈（KS）能量泛函表示为：\n$$E[n] = T_{\\mathrm{s}}[n] + \\int \\mathrm{d}\\mathbf{r}\\, v_{\\mathrm{ext}}(\\mathbf{r})\\, n(\\mathbf{r}) + E_{\\mathrm{H}}[n] + E_{\\mathrm{xc}}[n]$$\n对于单电子体系，虚构的无相互作用KS体系与真实体系相同。单个KS轨道就是精确的波函数，其密度就是精确密度。因此，无相互作用动能 $T_{\\mathrm{s}}[n]$ 精确等于真实动能 $T[n]$。\n为了使KS能量与精确能量相匹配，动能和外势能之外的所有项之和必须为零。在现实中，电子-电子相互作用为零，因此在KS公式中为处理此问题而引入的项对于 $N=1$ 必须相互抵消。这给出了条件：\n$$E_{\\mathrm{H}}[n] + E_{\\mathrm{xc}}[n] = 0$$\n对于任何有效的单电子密度 $n(\\mathbf{r})$，此式都必须成立。\n因此，精确约束为 $E_{\\mathrm{xc}}[n] = -E_{\\mathrm{H}}[n]$。\n项 $E_{\\mathrm{H}}[n] = \\frac{1}{2}\\int \\mathrm{d}\\mathbf{r}\\int \\mathrm{d}\\mathbf{r}'\\, \\frac{n(\\mathbf{r})\\, n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}$ 是电子密度与其自身的非物理自相互作用。交换相关泛函必须精确抵消这一项。\n此外，相关能 $E_{\\mathrm{c}}[n]$ 源于两个或更多电子的关联运动。对于单电子体系，精确相关能必须为零：$E_{\\mathrm{c}}[n] = 0$。由于 $E_{\\mathrm{xc}}[n] = E_{\\mathrm{x}}[n] + E_{\\mathrm{c}}[n]$，对于任何单电子密度，对交换和相关泛函的精确约束可以分为两个条件：\n1. $E_{\\mathrm{x}}[n] = -E_{\\mathrm{H}}[n]$\n2. $E_{\\mathrm{c}}[n] = 0$\n\n未能满足这些条件的泛函存在自相互作用误差（SIE）。我们现在根据这些条件评估每个选项。\n\nA. 任何能够恢复均匀电子气极限的局域或半局域近似（例如，局域密度近似（LDA）、广义梯度近似（GGA）或meta-GGA），根据其构造，对于每个单电子密度 $n(\\mathbf{r})$ 都会满足 $E_{\\mathrm{xc}}[n] = -E_{\\mathrm{H}}[n]$。\n\n这个陈述是错误的。局域和半局域泛函是根据均匀电子气（UEG）的性质构建的，均匀电子气是一个在无限体积内包含无限多电子的理想化体系。一个单电子体系，例如氢原子，具有高度不均匀、局域化的密度。将为UEG设计的泛函应用于此类体系会导致显著的不准确性。对于这些泛函，$E_{\\mathrm{x}}^{\\mathrm{approx}}[n]$ 不能抵消 $-E_{\\mathrm{H}}[n]$，并且 $E_{\\mathrm{c}}^{\\mathrm{approx}}[n]$ 会虚假地不为零。例如，对于氢原子，$E_{\\mathrm{H}} \\approx 0.3125$ Hartree，而LDA交换能为 $E_{\\mathrm{x}}^{\\mathrm{LDA}} \\approx -0.268$ Hartree。这种不完全的抵消是LDA和GGA中众所周知的自相互作用误差的来源。认为恢复UEG极限就能保证对单电子情况的正确性这一前提是根本错误的。\n结论：**错误**。\n\nB. 任何将非零分数 $a$（$0<a<1$）的精确交换与半局域交换相关部分混合的全局杂化泛函，对于单电子密度都会满足 $E_{\\mathrm{xc}}[n] = -E_{\\mathrm{H}}[n]$；$a$ 的值仅在 $N>1$ 时才重要。\n\n这个陈述是错误的。全局杂化泛函的形式为 $E_{\\mathrm{xc}}^{\\mathrm{hybrid}} = a E_{\\mathrm{x}}^{\\mathrm{EXX}} + (1-a) E_{\\mathrm{x}}^{\\mathrm{sl}} + E_{\\mathrm{c}}^{\\mathrm{sl}}$。精确交换泛函 $E_{\\mathrm{x}}^{\\mathrm{EXX}}$ 在单电子轨道密度上求值时，满足 $E_{\\mathrm{x}}^{\\mathrm{EXX}}[n] = -E_{\\mathrm{H}}[n]$。对于单电子体系，杂化泛函变为：\n$$E_{\\mathrm{xc}}^{\\mathrm{hybrid}}[n] = a(-E_{\\mathrm{H}}[n]) + (1-a) E_{\\mathrm{x}}^{\\mathrm{sl}}[n] + E_{\\mathrm{c}}^{\\mathrm{sl}}[n]$$\n要使其等于 $-E_{\\mathrm{H}}[n]$，我们需要 $(1-a) E_{\\mathrm{x}}^{\\mathrm{sl}}[n] + E_{\\mathrm{c}}^{\\mathrm{sl}}[n] = -(1-a)E_{\\mathrm{H}}[n]$。正如在（A）中所述，半局域泛函不满足这样的关系。由于 $a<1$，只有一部分自哈特里能量被精确交换部分抵消，而剩余的半局域部分不能正确抵消其余部分。因此，具有 $a<1$ 的全局杂化泛函并非没有自相互作用误差。$a$ 的值至关重要；只有当 $a=1$（并且相关泛函对于 $N=1$ 为零）时，条件才能满足。\n结论：**错误**。\n\nC. 只有那些以轨道依赖方式使用 $100\\%$ 精确交换的泛函（例如哈特里-福克交换或通过优化有效势（OEP）方法求解的科恩-沈精确交换），或通过显式的 Perdew–Zunger 自相互作用修正（SIC）增强的泛函，才能对所有单电子密度满足 $E_{\\mathrm{xc}}[n] = -E_{\\mathrm{H}}[n]$；标准的局域、半局域和部分交换的杂化近似通常不能满足。\n\n这个陈述是正确的。它指出了消除单电子自相互作用误差的两种主要方法。\n1.  **包含 $100\\%$ 精确交换的泛函**：如果交换部分完全是精确（类哈特里-福克）交换，$E_{\\mathrm{x}}[n] = E_{\\mathrm{x}}^{\\mathrm{EXX}}[n]$，那么对于任何单电子密度，都有 $E_{\\mathrm{x}}[n] = -E_{\\mathrm{H}}[n]$。在这种情况下，当且仅当相关泛函 $E_{\\mathrm{c}}[n]$ 对任何单电子密度都为零时，总条件 $E_{\\mathrm{xc}}[n] = -E_{\\mathrm{H}}[n]$ 才成立。哈特里-福克理论本身没有相关能（$E_{\\mathrm{c}}=0$），因此完全没有自相互作用。许多与 $100\\%$ 精确交换一起使用的高级相关泛函也被设计为对单电子体系为零。该陈述正确地识别了这类泛函。\n2.  **Perdew-Zunger SIC**：此方法通过显式减去对每个占据轨道用该近似泛函计算出的自相互作用来修正近似泛函 $E_{\\mathrm{xc}}^{\\mathrm{approx}}$。对于自旋非极化体系，修正后的泛函为 $E_{\\mathrm{xc}}^{\\mathrm{SIC}}[n] = E_{\\mathrm{xc}}^{\\mathrm{approx}}[n] - \\sum_{i} \\{ E_{\\mathrm{H}}[n_i] + E_{\\mathrm{xc}}^{\\mathrm{approx}}[n_i] \\}$。对于密度为 $n = n_1$ 的单电子体系，这变为 $E_{\\mathrm{xc}}^{\\mathrm{SIC}}[n] = E_{\\mathrm{xc}}^{\\mathrm{approx}}[n] - (E_{\\mathrm{H}}[n] + E_{\\mathrm{xc}}^{\\mathrm{approx}}[n]) = -E_{\\mathrm{H}}[n]$。这种修正通过构造强制满足了精确条件。\n最后一句，即标准的局域、半局域和部分交换的杂化泛函通常不能满足该条件，也是正确的，如（A）和（B）的分析所示。\n结论：**正确**。\n\nD. 一个仅在长程电子-电子距离处使用 $100\\%$ 精确交换的范围分离杂化泛函，对于任何单电子密度都会自动满足 $E_{\\mathrm{xc}}[n] = -E_{\\mathrm{H}}[n]$，而与短程半局域近似无关。\n\n这个陈述是错误的。范围分离杂化泛函将库仑算符 $1/r_{12}$ 分割为短程（SR）和长程（LR）部分。一种常见的方案是对短程交换使用半局域泛函，对长程交换使用精确交换：$E_{\\mathrm{x}} = E_{\\mathrm{x}}^{\\mathrm{SR-sl}} + E_{\\mathrm{x}}^{\\mathrm{LR-EXX}}$。对于单电子体系，长程精确交换精确地抵消了自哈特里能量的长程部分，$E_{\\mathrm{x}}^{\\mathrm{LR-EXX}} = -E_{\\mathrm{H}}^{\\mathrm{LR}}$。泛函变为 $E_{\\mathrm{xc}}[n] = E_{\\mathrm{x}}^{\\mathrm{SR-sl}}[n] - E_{\\mathrm{H}}^{\\mathrm{LR}}[n] + E_{\\mathrm{c}}^{\\mathrm{sl}}[n]$。要使其等于 $-E_{\\mathrm{H}}[n] = -E_{\\mathrm{H}}^{\\mathrm{SR}}[n]-E_{\\mathrm{H}}^{\\mathrm{LR}}[n]$，我们需要半局域部分满足 $E_{\\mathrm{x}}^{\\mathrm{SR-sl}}[n] + E_{\\mathrm{c}}^{\\mathrm{sl}}[n] = -E_{\\mathrm{H}}^{\\mathrm{SR}}[n]$。半局域泛函不满足此条件。自相互作用误差残留在短程部分。该泛函并非没有自相互作用，其准确性严重依赖于短程部分。\n结论：**错误**。\n\nE. 双杂化泛函对于单电子密度总是满足 $E_{\\mathrm{xc}}[n] = -E_{\\mathrm{H}}[n]$，因为当 $N=1$ 时，微扰相关项（例如，二阶 Møller–Plesset）为零。\n\n这个陈述是错误的。双杂化泛函将一部分精确交换和一部分微扰相关（如MP2）与半局域交换和相关混合。其形式为 $E_{\\mathrm{xc}}^{\\mathrm{DH}} = a E_{\\mathrm{x}}^{\\mathrm{EXX}} + (1-a) E_{\\mathrm{x}}^{\\mathrm{sl}} + b E_{\\mathrm{c}}^{\\mathrm{PT2}} + (1-b) E_{\\mathrm{c}}^{\\mathrm{sl}}$。虽然对于单电子体系，MP2相关能 $E_{\\mathrm{c}}^{\\mathrm{PT2}}$ 确实为零，但泛函简化为 $E_{\\mathrm{xc}}^{\\mathrm{DH}} = a E_{\\mathrm{x}}^{\\mathrm{EXX}} + (1-a) E_{\\mathrm{x}}^{\\mathrm{sl}} + (1-b) E_{\\mathrm{c}}^{\\mathrm{sl}}$。这只是一个具有重新标度的半局域相关的全局杂化泛函。正如在（B）中所述，由于精确交换的分数 $a$ 小于1，该泛函并非没有自相互作用误差。MP2部分的消失并不能解决杂化交换相关部分固有的自相互作用误差。\n结论：**错误**。", "answer": "$$\\boxed{C}$$", "id": "2903585"}, {"introduction": "理解了局域和半局域泛函存在自相互作用误差之后，下一个关键问题是探究其根源。广义梯度近似 (GGA) 建立在电子密度缓慢变化的假设之上，该假设的有效性可以通过无量纲的约化密度梯度 $s(\\mathbf{r})$ 来量化。这项练习 [@problem_id:2903617] 提供了一种直接的解析方法，让您在最简单的氢原子体系上检验这一基本假设，从而揭示这些泛函失效的核心原因之一。", "problem": "考虑真空中的非相对论性基态氢原子。其精确的科恩-沈（Kohn–Sham, KS）单电子轨道等于实的氢原子 $1s$ 轨道。设空间坐标为 $\\mathbf{r}$，其中 $r = |\\mathbf{r}|$，玻尔半径为 $a_{0}$。归一化的 $1s$ 轨道为 $\\psi_{1s}(\\mathbf{r}) = \\frac{1}{\\sqrt{\\pi}\\,a_{0}^{3/2}} \\exp\\!\\left(-\\frac{r}{a_{0}}\\right)$。相应的电子密度为 $\\rho(\\mathbf{r}) = |\\psi_{1s}(\\mathbf{r})|^{2}$。在广义梯度近似（GGA）中使用的约化密度梯度定义为\n\n$$\ns(\\mathbf{r}) \\equiv \\frac{|\\nabla \\rho(\\mathbf{r})|}{2\\,k_{F}(\\mathbf{r})\\,\\rho(\\mathbf{r})}, \\quad\\text{with}\\quad k_{F}(\\mathbf{r}) \\equiv \\big(3\\pi^{2}\\rho(\\mathbf{r})\\big)^{1/3}.\n$$\n\n仅使用这些定义和球坐标系下的标准矢量微积分，推导氢原子 $1s$ 密度的 $s(r)$ 的显式解析表达式。然后，仅根据作为梯度展开基础的小 $s$ 判据，论证对于此单电子密度，半局域广义梯度近似是否应在整个空间中都接近局域密度近似（LDA）。在你的推理中明确说明你所考虑的任何极限情况。你最终报告的答案必须是 $s(r)$ 的显式闭合形式表达式。最终答案中不要包含单位，也不要提供任何评论。", "solution": "所述问题具有科学依据，提法恰当，客观，并包含了完整推导和合理论证所需的所有信息。因此，该问题被认定为有效。我们开始进行解答。\n\n该问题要求推导基态氢原子的约化密度梯度 $s(r)$，并分析其行为，以评估广义梯度近似（GGA）相对于局域密度近似（LDA）的适用性。\n\n首先，我们根据给定的 $1s$ 轨道 $\\psi_{1s}(\\mathbf{r})$ 确定电子密度 $\\rho(\\mathbf{r})$。该轨道为：\n$$\n\\psi_{1s}(\\mathbf{r}) = \\frac{1}{\\sqrt{\\pi}\\,a_{0}^{3/2}} \\exp\\left(-\\frac{r}{a_{0}}\\right)\n$$\n其中 $r = |\\mathbf{r}|$，$a_0$ 是玻尔半径。由于轨道是实值函数，电子密度 $\\rho(\\mathbf{r}) = |\\psi_{1s}(\\mathbf{r})|^{2}$ 可简化为 $\\rho(\\mathbf{r}) = \\psi_{1s}(\\mathbf{r})^{2}$。该密度是球对称的，因此我们将其表示为 $\\rho(r)$：\n$$\n\\rho(r) = \\left( \\frac{1}{\\sqrt{\\pi}\\,a_{0}^{3/2}} \\exp\\left(-\\frac{r}{a_{0}}\\right) \\right)^{2} = \\frac{1}{\\pi a_{0}^{3}} \\exp\\left(-\\frac{2r}{a_{0}}\\right)\n$$\n\n接下来，我们计算密度的梯度 $\\nabla \\rho(r)$。在球坐标系中，对于一个只依赖于径向坐标 $r$ 的函数，其梯度简化为 $\\nabla\\rho(r) = \\frac{d\\rho}{dr}\\hat{\\mathbf{r}}$，其中 $\\hat{\\mathbf{r}}$ 是径向单位矢量。我们计算 $\\rho(r)$ 对 $r$ 的导数：\n$$\n\\frac{d\\rho}{dr} = \\frac{d}{dr} \\left[ \\frac{1}{\\pi a_{0}^{3}} \\exp\\left(-\\frac{2r}{a_{0}}\\right) \\right] = \\frac{1}{\\pi a_{0}^{3}} \\left(-\\frac{2}{a_{0}}\\right) \\exp\\left(-\\frac{2r}{a_{0}}\\right) = -\\frac{2}{a_{0}} \\rho(r)\n$$\n因此，梯度为 $\\nabla \\rho(r) = -\\frac{2}{a_{0}}\\rho(r)\\hat{\\mathbf{r}}$。\n\n$s(r)$ 的分子需要梯度的模 $|\\nabla \\rho(r)|$。由于 $\\rho(r)$ 总是正的且 $|\\hat{\\mathbf{r}}|=1$：\n$$\n|\\nabla \\rho(r)| = \\left| -\\frac{2}{a_{0}}\\rho(r)\\hat{\\mathbf{r}} \\right| = \\frac{2}{a_{0}}\\rho(r)\n$$\n\n现在，我们确定局域托马斯-费米波矢 $k_{F}(r)$，其定义为 $k_{F}(r) = (3\\pi^{2}\\rho(r))^{1/3}$。代入 $\\rho(r)$ 的表达式：\n$$\nk_{F}(r) = \\left[ 3\\pi^{2} \\left( \\frac{1}{\\pi a_{0}^{3}} \\exp\\left(-\\frac{2r}{a_{0}}\\right) \\right) \\right]^{1/3} = \\left[ \\frac{3\\pi}{a_{0}^{3}} \\exp\\left(-\\frac{2r}{a_{0}}\\right) \\right]^{1/3} = \\frac{(3\\pi)^{1/3}}{a_{0}} \\exp\\left(-\\frac{2r}{3a_{0}}\\right)\n$$\n\n最后，我们使用其定义来组装约化密度梯度 $s(r)$：\n$$\ns(r) = \\frac{|\\nabla \\rho(r)|}{2\\,k_{F}(r)\\,\\rho(r)}\n$$\n代入 $|\\nabla \\rho(r)|$ 和 $k_{F}(r)$ 的表达式：\n$$\ns(r) = \\frac{\\frac{2}{a_{0}}\\rho(r)}{2 \\left[ \\frac{(3\\pi)^{1/3}}{a_{0}} \\exp\\left(-\\frac{2r}{3a_{0}}\\right) \\right] \\rho(r)}\n$$\n项 $2$、$\\rho(r)$ 和 $a_{0}$相互抵消，剩下：\n$$\ns(r) = \\frac{1}{(3\\pi)^{1/3} \\exp\\left(-\\frac{2r}{3a_{0}}\\right)} = \\frac{1}{(3\\pi)^{1/3}} \\exp\\left(\\frac{2r}{3a_{0}}\\right)\n$$\n这就是氢原子 $1s$ 密度的 $s(r)$ 的显式解析表达式。\n\n对于问题的第二部分，我们必须论证对于该体系，GGA 泛函是否应接近 LDA。在交换相关泛函中包含密度梯度的理论基础是梯度展开，它是关于密度梯度的泰勒级数。这种展开仅在密度“缓慢变化”时有效。约化密度梯度 $s(\\mathbf{r})$ 是量化这种变化的无量纲参数。密度缓慢变化的条件，也即梯度展开有效的条件，是 $s(\\mathbf{r}) \\ll 1$。在满足此条件的区域，预期 GGA 是对 LDA 的一个小修正，它们的结果应该相似。\n\n我们现在分析我们推导出的氢原子的 $s(r)$ 在整个空间中的行为。其表达式为 $s(r) = (3\\pi)^{-1/3} \\exp(2r/(3a_0))$。\n我们考虑两个重要的极限：\n$1$. 在原子核附近，当 $r \\to 0$ 时：\n$$\n\\lim_{r\\to 0} s(r) = \\frac{1}{(3\\pi)^{1/3}} \\exp(0) = \\frac{1}{(3\\pi)^{1/3}} \\approx 0.473\n$$\n这个值是一个量级为 1 的常数；它并不远小于 $1$。\n$2$. 在远离原子核的尾部区域，当 $r \\to \\infty$ 时：\n$$\n\\lim_{r\\to \\infty} s(r) = \\frac{1}{(3\\pi)^{1/3}} \\lim_{r\\to \\infty} \\exp\\left(\\frac{2r}{3a_{0}}\\right) = \\infty\n$$\n$s(r)$ 的值在密度衰减区域呈指数增长并发散。\n\n对于氢原子，“小 $s$”判据 $s(r) \\ll 1$ 在空间的任何地方都不满足。$s(r)$ 的值在原子核处最小，约为 $0.473$，并随着 $r$ 的增大而无界增长。因此，氢原子的密度在梯度展开要求精确的意义上并非缓慢变化的。因此，不应期望半局域 GGA 会接近 LDA。与 $s \\ll 1$ 条件的显著偏离，特别是在尾部区域的发散，表明这个单电子体系对于任何基于小梯度假设的泛函都是一个具有挑战性的案例。这是自相互作用问题的体现，该问题对于 LDA 和标准 GGA 中的单电子密度尤为严重。", "answer": "$$\n\\boxed{\\frac{1}{(3\\pi)^{1/3}} \\exp\\left(\\frac{2r}{3a_{0}}\\right)}\n$$", "id": "2903617"}, {"introduction": "认识到半局域泛函的局限性后，我们转向一种实用的解决方案：杂化泛函。通过混入一部分精确的 Hartree-Fock 交换，杂化泛函旨在修正自相互作用误差，但最佳的混合比例 $a$ 并非普适。这项计算实践 [@problem_id:2903641] 利用一个简化模型，让您亲手验证在调整精确交换比例时，热化学精度与反应能垒预测之间的著名权衡关系，这对任何DFT实践者都是一个至关重要的概念。", "problem": "考虑密度泛函理论的 Kohn–Sham 方法 (Kohn–Sham DFT)，其中具有电子密度 $\\rho(\\mathbf{r})$ 的电子系统的基态总能量由无相互作用动能、经典电子-电子排斥能、外势能以及交换-相关能的总和给出。在广义杂化泛函近似中，交换-相关能被建模为精确 Hartree–Fock 交换和一个半局域交换加上一个半局域相关的凸组合，由分数参数 $a \\in [0,1]$ 控制。在冻结密度近似下（忽略密度相对于 $a$ 的弛豫），物种 $S$ 的总能量可以写为\n$$\nE_{\\mathrm{tot}}(S;a) \\approx E_{\\mathrm{sl}}(S) + a \\,\\Delta_x(S),\n$$\n其中 $E_{\\mathrm{sl}}(S)$ 是在参考半局域泛函（具有半局域交换-相关）下的总能量，而 $\\Delta_x(S) = E_x^{\\mathrm{HF}}(S) - E_x^{\\mathrm{sl}}(S)$ 是精确 Hartree–Fock 交换与半局域交换之间的差值，两者都在参考密度下进行评估。这个线性模型被广泛用于概念性分析当改变 $a$ 时热化学准确性与能垒高度之间的权衡。\n\n您的任务是实现这个模型，以计算一个小测试集上的原子化能和一个原型能垒高度，作为精确交换分数 $a$ 的函数。然后，通过与提供的高水平参考值进行比较来量化这种权衡。所有能量必须以哈特里（hartree）为单位表示。\n\n定义：\n- 一个由组分原子 $\\{A_i\\}$ 构成的分子 $M$ 的原子化能是\n$$\nD_e(M;a) = \\sum_i E_{\\mathrm{tot}}(A_i;a) - E_{\\mathrm{tot}}(M;a).\n$$\n- 氢交换反应 $ \\mathrm{H} + \\mathrm{H}_2 \\rightleftharpoons \\mathrm{H}_3^{\\ddagger} \\to \\mathrm{H} + \\mathrm{H}_2$ 的能垒高度建模为\n$$\nB(a) = E_{\\mathrm{tot}}(\\mathrm{H}_3^{\\ddagger};a) - \\left[E_{\\mathrm{tot}}(\\mathrm{H};a) + E_{\\mathrm{tot}}(\\mathrm{H}_2;a)\\right].\n$$\n- 对于一组分子 $\\{M_j\\}_{j=1}^N$ 和参考值 $\\{D_e^{\\mathrm{ref}}(M_j)\\}$，原子化能的平均绝对误差是\n$$\n\\mathrm{MAE}(a) = \\frac{1}{N}\\sum_{j=1}^N \\left| D_e(M_j;a) - D_e^{\\mathrm{ref}}(M_j) \\right|.\n$$\n\n使用以下物种的数据集，其 $E_{\\mathrm{sl}}(S)$ 和 $\\Delta_x(S)$ 值以哈特里为单位：\n- 原子：\n  - $\\mathrm{H}$: $E_{\\mathrm{sl}}(\\mathrm{H}) = -0.500$, $\\Delta_x(\\mathrm{H}) = -0.025$.\n  - $\\mathrm{C}$: $E_{\\mathrm{sl}}(\\mathrm{C}) = -37.600$, $\\Delta_x(\\mathrm{C}) = -0.500$.\n  - $\\mathrm{O}$: $E_{\\mathrm{sl}}(\\mathrm{O}) = -74.800$, $\\Delta_x(\\mathrm{O}) = -0.650$.\n- 分子：\n  - $\\mathrm{H}_2$: $E_{\\mathrm{sl}}(\\mathrm{H}_2) = -1.174$, $\\Delta_x(\\mathrm{H}_2) = -0.030$.\n  - $\\mathrm{CH}_4$: $E_{\\mathrm{sl}}(\\mathrm{CH}_4) = -40.235$, $\\Delta_x(\\mathrm{CH}_4) = -0.400$.\n  - $\\mathrm{H}_2\\mathrm{O}$: $E_{\\mathrm{sl}}(\\mathrm{H}_2\\mathrm{O}) = -76.180$, $\\Delta_x(\\mathrm{H}_2\\mathrm{O}) = -0.500$.\n- 过渡态：\n  - $\\mathrm{H}_3^{\\ddagger}$: $E_{\\mathrm{sl}}(\\mathrm{H}_3^{\\ddagger}) = -1.664$, $\\Delta_x(\\mathrm{H}_3^{\\ddagger}) = -0.020$.\n\n使用以下参考原子化能，以哈特里为单位：\n- $D_e^{\\mathrm{ref}}(\\mathrm{H}_2) = 0.1746$,\n- $D_e^{\\mathrm{ref}}(\\mathrm{CH}_4) = 0.6250$,\n- $D_e^{\\mathrm{ref}}(\\mathrm{H}_2\\mathrm{O}) = 0.3700$.\n\n使用以下参考能垒高度，以哈特里为单位：\n- $B^{\\mathrm{ref}} = 0.0150$.\n\n对于测试套件 $\\{0.0,\\,0.15,\\,0.25,\\,0.50,\\,1.00\\}$ 中的每一个 $a$ 计算：\n- 分子集 $\\{\\mathrm{H}_2,\\,\\mathrm{CH}_4,\\,\\mathrm{H}_2\\mathrm{O}\\}$ 的平均绝对误差 $\\mathrm{MAE}(a)$。\n- 通过 $\\mathrm{H}_3^{\\ddagger}$ 和 $\\mathrm{H} + \\mathrm{H}_2$ 建模的氢交换反应的能垒高度绝对误差 $\\left|B(a) - B^{\\mathrm{ref}}\\right|$。\n\n您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序如下：对于给定测试套件中的每个 $a$，依次附加两个浮点数 $\\mathrm{MAE}(a)$ 和 $\\left|B(a) - B^{\\mathrm{ref}}\\right|$。所有输出都必须以哈特里为单位，每个值四舍五入到 $6$ 位小数。例如，输出格式必须完全是\n$$\n[\\mathrm{MAE}(a_1),|B(a_1)-B^{\\mathrm{ref}}|,\\mathrm{MAE}(a_2),|B(a_2)-B^{\\mathrm{ref}}|,\\ldots].\n$$\n除了这个单行列表外，不应打印任何其他文本。", "solution": "该问题已经过验证，被认为是科学上合理、表述清晰且客观的。它提出了一个来自量子化学的标准（尽管是简化的）模型，用于分析杂化密度泛函。所有必需的数据和定义均已提供，任务是直接应用这些原理。因此，我们可以进行严谨的求解。\n\n核心任务是分析一个简化的杂化泛函模型在热化学（原子化能）和动力学（反应能垒）性质方面的表现。物种 $S$ 的总能量被建模为精确交换分数 $a$ 的线性函数：\n$$\nE_{\\mathrm{tot}}(S;a) = E_{\\mathrm{sl}}(S) + a \\cdot \\Delta_x(S)\n$$\n其中 $E_{\\mathrm{sl}}(S)$ 是来自参考半局域泛函的能量，$\\Delta_x(S)$ 是交换校正项。\n\n步骤 1：原子化能模型的推导\n由原子 $\\{A_i\\}$ 构成的分子 $M$ 的原子化能 $D_e(M;a)$ 定义为组分原子与分子之间的能量差：\n$$\nD_e(M;a) = \\sum_i E_{\\mathrm{tot}}(A_i;a) - E_{\\mathrm{tot}}(M;a)\n$$\n将线性模型代入每一项：\n$$\nD_e(M;a) = \\sum_i \\left( E_{\\mathrm{sl}}(A_i) + a \\cdot \\Delta_x(A_i) \\right) - \\left( E_{\\mathrm{sl}}(M) + a \\cdot \\Delta_x(M) \\right)\n$$\n通过按 $a$ 的幂次重新排列和分组，我们得到原子化能的线性模型：\n$$\nD_e(M;a) = \\left( \\sum_i E_{\\mathrm{sl}}(A_i) - E_{\\mathrm{sl}}(M) \\right) + a \\cdot \\left( \\sum_i \\Delta_x(A_i) - \\Delta_x(M) \\right)\n$$\n我们定义半局域原子化能 $D_e^{\\mathrm{sl}}(M)$ 和相应的交换校正项 $\\Delta D_x(M)$：\n$$\nD_e^{\\mathrm{sl}}(M) = \\sum_i E_{\\mathrm{sl}}(A_i) - E_{\\mathrm{sl}}(M)\n$$\n$$\n\\Delta D_x(M) = \\sum_i \\Delta_x(A_i) - \\Delta_x(M)\n$$\n模型简化为：\n$$\nD_e(M;a) = D_e^{\\mathrm{sl}}(M) + a \\cdot \\Delta D_x(M)\n$$\n\n步骤 2：能垒高度模型的推导\n反应 $\\mathrm{H} + \\mathrm{H}_2 \\to \\mathrm{H}_3^{\\ddagger}$ 的能垒高度 $B(a)$ 定义为过渡态与反应物之间的能量差：\n$$\nB(a) = E_{\\mathrm{tot}}(\\mathrm{H}_3^{\\ddagger};a) - \\left( E_{\\mathrm{tot}}(\\mathrm{H};a) + E_{\\mathrm{tot}}(\\mathrm{H}_2;a) \\right)\n$$\n代入线性模型：\n$$\nB(a) = \\left( E_{\\mathrm{sl}}(\\mathrm{H}_3^{\\ddagger}) + a \\cdot \\Delta_x(\\mathrm{H}_3^{\\ddagger}) \\right) - \\left[ \\left( E_{\\mathrm{sl}}(\\mathrm{H}) + a \\cdot \\Delta_x(\\mathrm{H}) \\right) + \\left( E_{\\mathrm{sl}}(\\mathrm{H}_2) + a \\cdot \\Delta_x(\\mathrm{H}_2) \\right) \\right]\n$$\n重新排列各项可得到能垒高度的线性模型：\n$$\nB(a) = \\left( E_{\\mathrm{sl}}(\\mathrm{H}_3^{\\ddagger}) - E_{\\mathrm{sl}}(\\mathrm{H}) - E_{\\mathrm{sl}}(\\mathrm{H}_2) \\right) + a \\cdot \\left( \\Delta_x(\\mathrm{H}_3^{\\ddagger}) - \\Delta_x(\\mathrm{H}) - \\Delta_x(\\mathrm{H}_2) \\right)\n$$\n我们定义半局域能垒高度 $B^{\\mathrm{sl}}$ 及其交换校正项 $\\Delta B_x$：\n$$\nB^{\\mathrm{sl}} = E_{\\mathrm{sl}}(\\mathrm{H}_3^{\\ddagger}) - E_{\\mathrm{sl}}(\\mathrm{H}) - E_{\\mathrm{sl}}(\\mathrm{H}_2)\n$$\n$$\n\\Delta B_x = \\Delta_x(\\mathrm{H}_3^{\\ddagger}) - \\Delta_x(\\mathrm{H}) - \\Delta_x(\\mathrm{H}_2)\n$$\n能垒高度的模型变为：\n$$\nB(a) = B^{\\mathrm{sl}} + a \\cdot \\Delta B_x\n$$\n\n步骤 3：模型参数的计算\n使用所提供的数据，我们计算线性模型的参数。所有能量单位均为哈特里。\n\n对于 $\\mathrm{H}_2$：\n$D_e^{\\mathrm{sl}}(\\mathrm{H}_2) = 2 \\cdot E_{\\mathrm{sl}}(\\mathrm{H}) - E_{\\mathrm{sl}}(\\mathrm{H}_2) = 2 \\cdot (-0.500) - (-1.174) = 0.174$\n$\\Delta D_x(\\mathrm{H}_2) = 2 \\cdot \\Delta_x(\\mathrm{H}) - \\Delta_x(\\mathrm{H}_2) = 2 \\cdot (-0.025) - (-0.030) = -0.020$\n$D_e(\\mathrm{H}_2; a) = 0.174 - 0.020 \\cdot a$\n\n对于 $\\mathrm{CH}_4$：\n$D_e^{\\mathrm{sl}}(\\mathrm{CH}_4) = E_{\\mathrm{sl}}(\\mathrm{C}) + 4 \\cdot E_{\\mathrm{sl}}(\\mathrm{H}) - E_{\\mathrm{sl}}(\\mathrm{CH}_4) = -37.600 + 4 \\cdot (-0.500) - (-40.235) = 0.635$\n$\\Delta D_x(\\mathrm{CH}_4) = \\Delta_x(\\mathrm{C}) + 4 \\cdot \\Delta_x(\\mathrm{H}) - \\Delta_x(\\mathrm{CH}_4) = -0.500 + 4 \\cdot (-0.025) - (-0.400) = -0.200$\n$D_e(\\mathrm{CH}_4; a) = 0.635 - 0.200 \\cdot a$\n\n对于 $\\mathrm{H}_2\\mathrm{O}$：\n$D_e^{\\mathrm{sl}}(\\mathrm{H}_2\\mathrm{O}) = 2 \\cdot E_{\\mathrm{sl}}(\\mathrm{H}) + E_{\\mathrm{sl}}(\\mathrm{O}) - E_{\\mathrm{sl}}(\\mathrm{H}_2\\mathrm{O}) = 2 \\cdot (-0.500) - 74.800 - (-76.180) = 0.380$\n$\\Delta D_x(\\mathrm{H}_2\\mathrm{O}) = 2 \\cdot \\Delta_x(\\mathrm{H}) + \\Delta_x(\\mathrm{O}) - \\Delta_x(\\mathrm{H}_2\\mathrm{O}) = 2 \\cdot (-0.025) - 0.650 - (-0.500) = -0.200$\n$D_e(\\mathrm{H}_2\\mathrm{O}; a) = 0.380 - 0.200 \\cdot a$\n\n对于反应能垒：\n$B^{\\mathrm{sl}} = E_{\\mathrm{sl}}(\\mathrm{H}_3^{\\ddagger}) - E_{\\mathrm{sl}}(\\mathrm{H}) - E_{\\mathrm{sl}}(\\mathrm{H}_2) = -1.664 - (-0.500) - (-1.174) = 0.010$\n$\\Delta B_x = \\Delta_x(\\mathrm{H}_3^{\\ddagger}) - \\Delta_x(\\mathrm{H}) - \\Delta_x(\\mathrm{H}_2) = -0.020 - (-0.025) - (-0.030) = 0.035$\n$B(a) = 0.010 + 0.035 \\cdot a$\n\n步骤 4：测试套件误差的计算\n我们现在对每个 $a \\in \\{0.0, 0.15, 0.25, 0.50, 1.00\\}$ 计算原子化能的平均绝对误差 ($\\mathrm{MAE}(a)$) 和能垒高度的绝对误差 ($|B(a) - B^{\\mathrm{ref}}|$)。\n\n对于 $a=0.0$：\n$D_e(\\mathrm{H}_2; 0.0) = 0.174$，误差 = $|0.174 - 0.1746| = 0.0006$\n$D_e(\\mathrm{CH}_4; 0.0) = 0.635$，误差 = $|0.635 - 0.6250| = 0.0100$\n$D_e(\\mathrm{H}_2\\mathrm{O}; 0.0) = 0.380$，误差 = $|0.380 - 0.3700| = 0.0100$\n$\\mathrm{MAE}(0.0) = (0.0006 + 0.0100 + 0.0100) / 3 \\approx 0.006867$\n$B(0.0) = 0.010$，误差 = $|0.010 - 0.0150| = 0.0050$\n\n对于 $a=0.15$：\n$D_e(\\mathrm{H}_2; 0.15) = 0.171$，误差 = $|0.171 - 0.1746| = 0.0036$\n$D_e(\\mathrm{CH}_4; 0.15) = 0.605$，误差 = $|0.605 - 0.6250| = 0.0200$\n$D_e(\\mathrm{H}_2\\mathrm{O}; 0.15) = 0.350$，误差 = $|0.350 - 0.3700| = 0.0200$\n$\\mathrm{MAE}(0.15) = (0.0036 + 0.0200 + 0.0200) / 3 \\approx 0.014533$\n$B(0.15) = 0.01525$，误差 = $|0.01525 - 0.0150| = 0.00025$\n\n对于 $a=0.25$：\n$D_e(\\mathrm{H}_2; 0.25) = 0.169$，误差 = $|0.169 - 0.1746| = 0.0056$\n$D_e(\\mathrm{CH}_4; 0.25) = 0.585$，误差 = $|0.585 - 0.6250| = 0.0400$\n$D_e(\\mathrm{H}_2\\mathrm{O}; 0.25) = 0.330$，误差 = $|0.330 - 0.3700| = 0.0400$\n$\\mathrm{MAE}(0.25) = (0.0056 + 0.0400 + 0.0400) / 3 \\approx 0.028533$\n$B(0.25) = 0.01875$，误差 = $|0.01875 - 0.0150| = 0.00375$\n\n对于 $a=0.50$：\n$D_e(\\mathrm{H}_2; 0.50) = 0.164$，误差 = $|0.164 - 0.1746| = 0.0106$\n$D_e(\\mathrm{CH}_4; 0.50) = 0.535$，误差 = $|0.535 - 0.6250| = 0.0900$\n$D_e(\\mathrm{H}_2\\mathrm{O}; 0.50) = 0.280$，误差 = $|0.280 - 0.3700| = 0.0900$\n$\\mathrm{MAE}(0.50) = (0.0106 + 0.0900 + 0.0900) / 3 \\approx 0.063533$\n$B(0.50) = 0.0275$，误差 = $|0.0275 - 0.0150| = 0.0125$\n\n对于 $a=1.00$：\n$D_e(\\mathrm{H}_2; 1.00) = 0.154$，误差 = $|0.154 - 0.1746| = 0.0206$\n$D_e(\\mathrm{CH}_4; 1.00) = 0.435$，误差 = $|0.435 - 0.6250| = 0.1900$\n$D_e(\\mathrm{H}_2\\mathrm{O}; 1.00) = 0.180$，误差 = $|0.180 - 0.3700| = 0.1900$\n$\\mathrm{MAE}(1.00) = (0.0206 + 0.1900 + 0.1900) / 3 \\approx 0.133533$\n$B(1.00) = 0.045$，误差 = $|0.045 - 0.0150| = 0.0300$\n\n结果说明了杂化 DFT 中众所周知的权衡关系：较低的 $a$ 值（例如，$a=0$）更适合热化学（较小的 $\\mathrm{MAE}$），而需要较高的 $a$ 值来校正困扰半局域泛函的自相互作用误差，该误差导致系统性地低估能垒高度。对于该系统，能垒高度误差在 $a=0.15$ 附近最小化，而热化学误差在 $a=0.0$ 时最小化。这种冲突是设计普适性密度泛函的一个根本挑战。\n现在将基于这些计算进行实现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes atomization and barrier height errors for a simplified hybrid DFT model.\n    \"\"\"\n    \n    # ------------------\n    # Step 1: Define Givens\n    # ------------------\n\n    # Dataset of E_sl and Delta_x values for each species in hartree.\n    species_data = {\n        'H':       {'E_sl': -0.500, 'Delta_x': -0.025},\n        'C':       {'E_sl': -37.600, 'Delta_x': -0.500},\n        'O':       {'E_sl': -74.800, 'Delta_x': -0.650},\n        'H2':      {'E_sl': -1.174, 'Delta_x': -0.030},\n        'CH4':     {'E_sl': -40.235, 'Delta_x': -0.400},\n        'H2O':     {'E_sl': -76.180, 'Delta_x': -0.500},\n        'H3_ts':   {'E_sl': -1.664, 'Delta_x': -0.020},\n    }\n\n    # Constituent atoms for each molecule.\n    molecule_composition = {\n        'H2':  {'H': 2},\n        'CH4': {'C': 1, 'H': 4},\n        'H2O': {'H': 2, 'O': 1},\n    }\n\n    # Reference values for atomization energies and barrier height in hartree.\n    ref_values = {\n        'D_e_H2':  0.1746,\n        'D_e_CH4': 0.6250,\n        'D_e_H2O': 0.3700,\n        'B':       0.0150,\n    }\n\n    # Test suite of exact exchange fractions.\n    a_values = [0.0, 0.15, 0.25, 0.50, 1.00]\n    \n    # ------------------\n    # Step 2: Define Calculation Functions\n    # ------------------\n\n    def get_total_energy(species_name, a):\n        \"\"\"Calculates the total energy E_tot(S; a) for a given species and 'a'.\"\"\"\n        data = species_data[species_name]\n        return data['E_sl'] + a * data['Delta_x']\n\n    def get_atomization_energy(molecule_name, a):\n        \"\"\"Calculates the atomization energy D_e(M; a) for a given molecule and 'a'.\"\"\"\n        e_mol = get_total_energy(molecule_name, a)\n        \n        e_atoms = 0.0\n        for atom, count in molecule_composition[molecule_name].items():\n            e_atoms += count * get_total_energy(atom, a)\n            \n        return e_atoms - e_mol\n\n    def get_barrier_height(a):\n        \"\"\"Calculates the H-exchange barrier height B(a) for a given 'a'.\"\"\"\n        e_h3_ts = get_total_energy('H3_ts', a)\n        e_h = get_total_energy('H', a)\n        e_h2 = get_total_energy('H2', a)\n        \n        return e_h3_ts - (e_h + e_h2)\n\n    # ------------------\n    # Step 3: Perform Calculations and Collect Results\n    # ------------------\n    \n    results = []\n    molecules_for_mae = ['H2', 'CH4', 'H2O']\n    num_molecules = len(molecules_for_mae)\n\n    for a in a_values:\n        # Calculate Mean Absolute Error (MAE) for atomization energies\n        atomization_errors = []\n        d_e_h2 = get_atomization_energy('H2', a)\n        atomization_errors.append(abs(d_e_h2 - ref_values['D_e_H2']))\n        \n        d_e_ch4 = get_atomization_energy('CH4', a)\n        atomization_errors.append(abs(d_e_ch4 - ref_values['D_e_CH4']))\n\n        d_e_h2o = get_atomization_energy('H2O', a)\n        atomization_errors.append(abs(d_e_h2o - ref_values['D_e_H2O']))\n\n        mae = sum(atomization_errors) / num_molecules\n        results.append(mae)\n\n        # Calculate absolute error for the barrier height\n        barrier_height = get_barrier_height(a)\n        barrier_error = abs(barrier_height - ref_values['B'])\n        results.append(barrier_error)\n\n    # ------------------\n    # Step 4: Format and Print the Final Output\n    # ------------------\n\n    # Format each result to 6 decimal places and join into a single string.\n    output_string = f\"[{','.join([f'{res:.6f}' for res in results])}]\"\n    print(output_string)\n\nsolve()\n```", "id": "2903641"}]}