## 引言
[密度泛函理论](@entry_id:139027)（Density Functional Theory, DFT）是现代[量子化学](@entry_id:140193)和凝聚态物理中最为成功和应用广泛的计算方法之一。它的核心思想极具革命性：一个多电子体系的[基态](@entry_id:150928)性质，无需通过求解极其复杂的[多体波函数](@entry_id:203043)来获得，而是可以由一个更简单的三维函数——[基态](@entry_id:150928)电子密度——完全确定。这一突破性的见解从根本上改变了我们处理[量子多体问题](@entry_id:146763)的方式，使得对复杂分子和材料进行第一性原理计算成为可能。

然而，从这一优雅的理论原理到精确的实际计算之间存在着巨大的鸿沟。薛定谔方程的直接求解对于多电子体系而言计算上是不可行的，而[Hohenberg-Kohn定理](@entry_id:139793)虽然证明了[普适泛函](@entry_id:140176)的存在性，却没有给出其具体形式。如何将电子密度作为基本变量的承诺转化为一个可行的计算方案，并准确地描述电子间的交换与关联效应，构成了DFT发展的核心挑战。

本文旨在系统性地引导读者深入DFT的理论殿堂。我们将从第一章“原理与机制”开始，奠定[Hohenberg-Kohn定理](@entry_id:139793)这一理论基石，并阐明[Kohn-Sham方法](@entry_id:263733)如何巧妙地将问题转化为实践上可解的形式。接着，在第二章“应用与跨学科联系”中，我们将展示该理论如何应用于计算真实世界的分子和[材料性质](@entry_id:146723)，并探讨其在不同学科领域的推广与联系。最后，第三章“动手实践”将通过具体的计算练习，帮助读者巩固对核心概念的理解。本章程将带领你从基本原理出发，逐步掌握DFT的精髓及其在科学研究中的强大威力。

## 原理与机制

本章旨在深入探讨密度泛函理论 (DFT) 的理论基石。我们将从[Hohenberg-Kohn定理](@entry_id:139793)出发，建立电子密度作为基本变量的核心地位，然后通过[Levy-Lieb约束搜索](@entry_id:145975)方法解决理论中的关键难题。在此基础上，我们将详细阐述[Kohn-Sham方法](@entry_id:263733)的巧妙构思，该方法将一个难以解决的相互作用多体问题转化为一个可计算的非相互作用体系问题。最后，我们将探讨精确[交换相关泛函](@entry_id:142042)所具备的一些深刻性质，例如[绝热连接](@entry_id:199259)和[导数不连续性](@entry_id:136336)，这些性质为开发更精确的近似泛函指明了方向。

### Hohenberg-Kohn 定理：理论基石

量子力学为我们提供了描述原子和分子行为的精确数学框架——薛定谔方程。然而，对于任何包含两个以上电子的体系，该方程的复杂性使得直接求解变得不切实际。密度泛函理论的革命性贡献在于，它证明了体系的所有性质都可以由一个更简单的量——[基态](@entry_id:150928)电子密度 $n(\mathbf{r})$——唯一确定。这一核心思想由 Walter Kohn 和 Pierre Hohenberg 在1964年提出的两项定理奠定。

#### 第一 Hohenberg-Kohn 定理 (HK1)

**第一[Hohenberg-Kohn定理](@entry_id:139793)**指出，对于一个给定的非简并[基态](@entry_id:150928)，其电子密度 $n(\mathbf{r})$ 唯一地确定了体系的外部势 $v_{\text{ext}}(\mathbf{r})$，两者之间只相差一个无关紧要的常数。

这个定理的意义是深远的。由于外部势 $v_{\text{ext}}(\mathbf{r})$（在玻恩-奥本海默近似下，通常指[原子核](@entry_id:167902)对电子的库仑吸引势）和电子数 $N$ 共同定义了体系的[哈密顿算符](@entry_id:144286)，因此，基态密度 $n(\mathbf{r})$ 实际上蕴含了体系的全部信息。一旦 $n(\mathbf{r})$ 已知，[哈密顿算符](@entry_id:144286)就随之确定，原则上，体系的所有性质，包括总能量、[激发态](@entry_id:261453)、偶极矩等，都成为了 $n(\mathbf{r})$ 的泛函（即函数的函数）。

该定理的证明过程非常巧妙，采用了反证法。假设存在两个不同的外部势 $v_1(\mathbf{r})$ 和 $v_2(\mathbf{r})$（它们相差不止一个常数），但它们却对应于同一个基态密度 $n(\mathbf{r})$。设它们各自的[哈密顿算符](@entry_id:144286)为 $\hat{H}_1$ 和 $\hat{H}_2$，归一化的[基态](@entry_id:150928)[波函数](@entry_id:147440)为 $\Psi_1$ 和 $\Psi_2$，[基态能量](@entry_id:263704)为 $E_1$ 和 $E_2$。

根据变分原理，将 $\Psi_2$ 作为 $\hat{H}_1$ 的试探波函数，我们得到：
$E_1  \langle \Psi_2 | \hat{H}_1 | \Psi_2 \rangle = \langle \Psi_2 | \hat{H}_2 + \hat{V}_1 - \hat{V}_2 | \Psi_2 \rangle = E_2 + \int (v_1(\mathbf{r}) - v_2(\mathbf{r})) n(\mathbf{r}) d^3\mathbf{r}$
这里的严格小于号成立，因为我们假设 $\Psi_1$ 和 $\Psi_2$ 是不同的（由不同的[哈密顿算符](@entry_id:144286)产生）。

同样，将 $\Psi_1$ 作为 $\hat{H}_2$ 的试探波函数，我们得到：
$E_2  \langle \Psi_1 | \hat{H}_2 | \Psi_1 \rangle = \langle \Psi_1 | \hat{H}_1 + \hat{V}_2 - \hat{V}_1 | \Psi_1 \rangle = E_1 + \int (v_2(\mathbf{r}) - v_1(\mathbf{r})) n(\mathbf{r}) d^3\mathbf{r}$

将上述两个不等式相加，我们得到一个荒谬的结论：
$E_1 + E_2  E_2 + E_1$
这个矛盾证明了我们的初始假设是错误的。因此，对于一个非简并[基态](@entry_id:150928)，其电子密度 $n(\mathbf{r})$ 必须唯一地确定外部势 $v_{\text{ext}}(\mathbf{r})$。

**对简并[基态](@entry_id:150928)的推广**
上述证明依赖于[基态](@entry_id:150928)的非简并性。如果[基态](@entry_id:150928)是简并的，例如一个原子处于 $L>0$ 的态，那么多个不同的[基态](@entry_id:150928)[波函数](@entry_id:147440) $\Psi_k$ 可能对应不同的电子密度 $n_k(\mathbf{r})$。更复杂的情况是，两个不同的势 $v_1$ 和 $v_2$ 可能共享同一个基态密度。为了解决这个问题，需要将理论推广到**系综**的框架 [@problem_id:2634147]。

考虑一个具有 $g$ 重简并[基态](@entry_id:150928)的体系，其能量为 $E_0$，对应的正交归一的本征态为 $\{\Psi_k\}_{k=1}^g$。我们可以构建一个系综，由[密度算符](@entry_id:138151) $\hat{\Gamma} = \sum_{k=1}^g w_k |\Psi_k\rangle\langle\Psi_k|$ 描述，其中权重 $w_k \ge 0$ 且 $\sum_k w_k = 1$。该系综的密度为 $n(\mathbf{r}) = \text{Tr}[\hat{\Gamma}\hat{n}(\mathbf{r})] = \sum_k w_k \langle\Psi_k|\hat{n}(\mathbf{r})|\Psi_k\rangle$。

通过将反证法推广到系综[密度算符](@entry_id:138151)，可以证明，如果两个外部势 $v(\mathbf{r})$ 和 $v'(\mathbf{r})$（它们相差不止一个常数）产生了相同的系综基[态密度](@entry_id:147894) $n(\mathbf{r})$，那么它们必然拥有完全相同的[基态](@entry_id:150928)[子空间](@entry_id:150286)。这意味着，从一个系综基态密度到外部势的映射仍然是唯一的（相差一个常数）。这个推广对于确保DFT理论的普遍有效性至关重要 [@problem_id:2634147]。

### 第二 Hohenberg-Kohn 定理与表象问题

#### 第二 Hohenberg-Kohn 定理 (HK2)

HK1 确立了密度作为基本变量的合法性，而 **第二[Hohenberg-Kohn定理](@entry_id:139793)** 则提供了一个通过变分法求解[基态能量](@entry_id:263704)和密度的方法。该定理定义了一个不依赖于外部势的**普适[能量泛函](@entry_id:170311)** $F[n]$：
$F[n] = \langle \Psi[n] | \hat{T} + \hat{W}_{\text{ee}} | \Psi[n] \rangle$
其中 $\hat{T}$ 是电子[动能算符](@entry_id:265633)，$\hat{W}_{\text{ee}}$ 是[电子-电子相互作用](@entry_id:139900)算符，而 $\Psi[n]$ 是产生密度 $n(\mathbf{r})$ 的[波函数](@entry_id:147440)。

体系的总能量可以表示为：
$E_v[n] = F[n] + \int v_{\text{ext}}(\mathbf{r}) n(\mathbf{r}) d^3\mathbf{r}$

HK2 定理断言：对于一个给定的外部势 $v_{\text{ext}}(\mathbf{r})$，正确的基态能量 $E_0$ 是通过在所有“可接受的”密度上最小化能量泛函 $E_v[n]$ 得到的。达到最小值的密度 $n_0(\mathbf{r})$ 就是该体系的基[态密度](@entry_id:147894)。
$E_0 = \min_{n} E_v[n] = E_v[n_0]$

#### $v$-可表象性问题

HK2 的表述中，“可接受的”密度是一个微妙且关键的问题。在原始的Hohenberg-Kohn框架中，这个集合被假定为**$v$-可表象密度**的集合——即，对于某个外部势 $v'(\mathbf{r})$，一个密度是其相互作用体系的基态密度。这立即导致了一个悖论：为了通过变分法寻找一个势 $v$ 的基态密度，我们需要在一个所有可能的基态密度（对应于所有可能的势 $v'$）构成的集合上进行搜索。然而，我们并没有一个简单的方法来判断一个给定的密度函数是否是 $v$-可表象的 [@problem_id:2634161]。这个定义域的不明确性给[变分原理](@entry_id:198028)的实际应用带来了巨大的理论障碍。

#### Levy-Lieb 约[束搜索](@entry_id:634146)：解决方案

为了克服 $v$-可表象性问题，Levy 和 Lieb 提出了一种更为严谨和通用的**约[束搜索](@entry_id:634146) (constrained-search)** 公式 [@problem_id:2634162] [@problem_id:2634161]。此方法通过扩大泛函的定义域来解决问题。

首先，定义一个更广泛的密度集合，称为**$N$-可表象密度**。一个密度 $n(\mathbf{r})$ 是 $N$-可表象的，如果它来自某个（纯态或混合态）反对称的 $N$ 电子[波函数](@entry_id:147440)，而这个[波函数](@entry_id:147440)不必须是任何[哈密顿量](@entry_id:172864)的[基态](@entry_id:150928)。这个集合的条件要宽松得多，基本上只要求密度非负、积分为 $N$ 且具有有限的动能。

然后，[普适泛函](@entry_id:140176) $F[n]$ 被重新定义为在一个给定密度 $n$ 的约束下，对所有产生该密度的[波函数](@entry_id:147440) $\Psi$ 搜索动能和相互作用能之和的最小值：
$F[n] = \min_{\Psi \to n} \langle \Psi | \hat{T} + \hat{W}_{\text{ee}} | \Psi \rangle$

这个定义完全不依赖于任何外部势，也与 $v$-可表象性无关。$F[n]$ 的定义域现在是所有 $N$-可表象密度的集合。有了这个明确定义的泛函，变分原理就可以在一个坚实的数学基础上进行：
$E_0 = \inf_{n \in \mathcal{D}_N} \left\{ F[n] + \int v_{\text{ext}}(\mathbf{r}) n(\mathbf{r}) d^3\mathbf{r} \right\}$
其中 $\mathcal{D}_N$ 是 $N$-可表象密度的集合。这种表述将 DFT 的[变分原理](@entry_id:198028)与量子力学中更为人熟知的 Rayleigh-Ritz [变分原理](@entry_id:198028)（在波函数空间中搜索）联系起来，并保证了两者求得的能量下确界是相等的 [@problem_id:2634162]。

#### 纯态、系综与表象性

为了进一步完善理论，我们需要区分不同的表象性类别 [@problem_id:2634171]。
- **纯态 $v$-可表象**：一个密度，它来自某个势 $v(\mathbf{r})$ 的一个**纯的**（非混合的）[基态](@entry_id:150928)[波函数](@entry_id:147440)。
- **系综 $v$-可表象**：一个密度，它来自某个势 $v(\mathbf{r})$ 的**简并[基态](@entry_id:150928)的系综**（即多个简并[基态](@entry_id:150928)[波函数](@entry_id:147440)的加权平均）。
- **$N$-可表象**：一个密度，它来自某个反对称 $N$ 电子态（纯态或系综），该态不必是任何[哈密顿量](@entry_id:172864)的[基态](@entry_id:150928)。

一个典型的例子可以阐明这些区别。考虑一个简谐势中的4个非相互作用电子。[基态](@entry_id:150928)构型是 $(1s)^2(1p)^2$。由于 $1p$ [轨道](@entry_id:137151)是三重简并的（$p_x, p_y, p_z$），任何将2个电子放入这三个[轨道](@entry_id:137151)中的单一斯莱特行列式（例如，占据 $1p_x$ 和 $1p_y$）都会产生一个非球对称的密度。这种密度是**纯态非相互作用 $v$-可表象的**。然而，我们可以构建一个系综，将2个电子平均分配到三个 $p$ [轨道](@entry_id:137151)上（每个空间[轨道](@entry_id:137151)占据数为 $2/3$）。这会产生一个球对称的密度。这个球对称密度是**系综非相互作用 $v$-可表象的**，但它**不是**纯态非相互作用 $v$-可表象的，因为任何单一的[斯莱特行列式](@entry_id:139034)都无法产生这种分数占据的密度[分布](@entry_id:182848) [@problem_id:2634171]。

将泛函的定义域从纯态 $N$-可表象密度推广到系综 $N$-可表象密度，可以证明[普适泛函](@entry_id:140176) $F[n]$ 是一个凸泛函。[凸性](@entry_id:138568)是一个至关重要的数学性质，它保证了在变分过程中能量最小值的存在，并为泛函求导提供了严格的数学工具（次梯度），这对于后续推导[Kohn-Sham方程](@entry_id:143968)至关重要 [@problem_id:2634161]。

### Kohn-Sham 方法：从原理到实践

Hohenberg-Kohn 定理虽然在理论上是精确的，但它们并没有给出如何构建[普适泛函](@entry_id:140176) $F[n]$ 的具体方案，尤其是其中最复杂的部分——动能泛函 $T[n]$。1965年，Walter Kohn 和 Lu Jeu Sham 提出了一种天才的间接方法来处理这个问题，这便是**Kohn-Sham (KS) DFT**。

#### 核心思想

KS方法的核心思想是引入一个**虚拟的非相互作用电子体系**，这个体系被巧妙地设计，使其[基态](@entry_id:150928)电子密度与我们感兴趣的**真实相互作用体系**的基态密度完全相同。

对于非相互作用体系，动能可以精确地写成[轨道](@entry_id:137151)动能之和，[多体波函数](@entry_id:203043)就是一个斯莱特行列式。通过这种方式，真实体系动能的主要部分被精确计算，而将复杂的[多体效应](@entry_id:173569)打包到一个更小的、更容易近似的项中。

#### [能量泛函](@entry_id:170311)的分解

KS方法将[普适泛函](@entry_id:140176) $F[n]$ 分解为三部分 [@problem_id:2634167] [@problem_id:2634168]：
$F[n] = T_s[n] + E_H[n] + E_{xc}[n]$

总能量泛函相应地写为：
$E[n] = T_s[n] + E_H[n] + E_{xc}[n] + \int v_{\text{ext}}(\mathbf{r}) n(\mathbf{r}) d^3\mathbf{r}$

我们来逐一审视这些项：
1.  **非相互作用动能 $T_s[n]$**：这是那个与真实体系具有相同密度的虚拟非相互作用体系的动能。如果该体系由一组[轨道](@entry_id:137151) $\{\phi_i\}$ 描述，其密度为 $n(\mathbf{r}) = \sum_i f_i |\phi_i(\mathbf{r})|^2$（$f_i$为[轨道](@entry_id:137151)占据数），则其动能为 $T_s[n] = \sum_i f_i \langle \phi_i | -\frac{1}{2}\nabla^2 | \phi_i \rangle$。这是总动能中最大的一部分。

2.  **哈特里 (Hartree) 能量 $E_H[n]$**：这是电子密度作为经典电荷分布与其自身相互作用的经典[静电排斥](@entry_id:162128)能。
    $E_H[n] = \frac{1}{2} \iint \frac{n(\mathbf{r}) n(\mathbf{r}')}{|\mathbf{r}-\mathbf{r}'|} d^3\mathbf{r} d^3\mathbf{r}'$
    这个表达式包含了一个虚假的电子“自相互作用”，即一个电子与其自身所在电荷分布的相互作用。

3.  **交换-相关 (Exchange-Correlation) 能量 $E_{xc}[n]$**：这是一个“万能”项，它被**定义**为包含了所有被前两项忽略的复杂[多体效应](@entry_id:173569)。通过将总能量的精确表达式与KS分解式进行比较，我们可以得到 $E_{xc}[n]$ 的严格定义 [@problem_id:2634167] [@problem_id:2634168]。
    令 $\Psi_n$ 为产生密度 $n$ 的真实相互作用体系的[波函数](@entry_id:147440)，$\Phi_n$ 为产生相同密度 $n$ 的非相互作用KS体系的斯莱特行列式。那么：
    $E_{xc}[n] = (\langle \Psi_n | \hat{T} | \Psi_n \rangle - T_s[n]) + (\langle \Psi_n | \hat{W}_{\text{ee}} | \Psi_n \rangle - E_H[n])$

    这个定义清晰地揭示了 $E_{xc}[n]$ 的两个组成部分：
    -   **动能[相关能](@entry_id:144432) $T_c[n] = \langle \Psi_n | \hat{T} | \Psi_n \rangle - T_s[n]$**：这是真实体系的动能与非相互作用KS体系动能之间的差值。它源于电子为了避免[库仑排斥](@entry_id:181876)而采取的关联运动，这种运动改变了它们的动能。
    -   **[势能](@entry_id:748988)交换-[相关能](@entry_id:144432)**：这是真实[电子-电子相互作用](@entry_id:139900)能 $\langle \hat{W}_{\text{ee}} \rangle$ 与经典哈特里能 $E_H[n]$ 的差值。它包含了两个效应：(1) **交换效应**，源于[泡利不相容原理](@entry_id:141850)，使得同自旋电子相互回避，这修正了经典的哈特里排斥（包括消除了自相互作用）；(2) **库仑相关效应**，即所有电子（无论自旋）因库仑排斥而产生的相互回避。

DFT的全部挑战和精髓就在于寻找对这个未知的 $E_{xc}[n]$ 的精确近似。

#### Kohn-Sham 方程

将KS能量泛函 $E[n]$ 对密度 $n(\mathbf{r})$（或等价地，对[轨道](@entry_id:137151) $\phi_i^*$）进行变分最小化，同时保持[轨道](@entry_id:137151)归一化，便可得到一组类似于单[电子薛定谔方程](@entry_id:177999)的方程，即**[Kohn-Sham方程](@entry_id:143968)**：
$\left( -\frac{1}{2}\nabla^2 + v_s(\mathbf{r}) \right) \phi_i(\mathbf{r}) = \varepsilon_i \phi_i(\mathbf{r})$

这里的 $\varepsilon_i$ 是[Kohn-Sham轨道](@entry_id:171979)能，而 $v_s(\mathbf{r})$ 是**Kohn-Sham有效势**，所有复杂的[多体效应](@entry_id:173569)都通过这个局域势体现出来。它由三部分组成：
$v_s(\mathbf{r}) = v_{\text{ext}}(\mathbf{r}) + v_H(\mathbf{r}) + v_{xc}(\mathbf{r})$

其中：
-   $v_{\text{ext}}(\mathbf{r})$ 是外部势。
-   $v_H(\mathbf{r}) = \frac{\delta E_H[n]}{\delta n(\mathbf{r})} = \int \frac{n(\mathbf{r}')}{|\mathbf{r}-\mathbf{r}'|} d^3\mathbf{r}'$ 是哈特里势。
-   $v_{xc}(\mathbf{r}) = \frac{\delta E_{xc}[n]}{\delta n(\mathbf{r})}$ 是交换-相关势。

这些方程必须自洽求解：从一个初始的密度猜测开始，计算出有效势 $v_s$，求解KS方程得到一组新[轨道](@entry_id:137151)，由新[轨道](@entry_id:137151)构建新的密度，然后重复此过程，直到密度和能量收敛。

要从一个给定的交换-相关[能量泛函](@entry_id:170311) $E_{xc}[n]$ 得到对应的势 $v_{xc}(\mathbf{r})$，需要进行泛函求导。例如，对于局域密度近似 (LDA) 中的[交换能](@entry_id:137069) $E_x[n] = -C_x \int n(\mathbf{r})^{4/3} d^3\mathbf{r}$，其势为 $v_x(\mathbf{r}) = -\frac{4}{3}C_x n(\mathbf{r})^{1/3}$ [@problem_id:2884931]。对于更复杂的包含密度梯度的泛函，如[广义梯度近似 (GGA)](@entry_id:140295)，求导过程会更复杂，需要用到分部积分 [@problem_id:2884926]。例如，对于一个形式为 $E_{xc}[n] = \int f(n, |\nabla n|) d^3\mathbf{r}$ 的泛函，其势由[欧拉-拉格朗日方程](@entry_id:137827)给出：
$v_{xc}(\mathbf{r}) = \frac{\partial f}{\partial n} - \nabla \cdot \left( \frac{\partial f}{\partial (\nabla n)} \right)$

### [精确交换](@entry_id:178558)-相关泛函的性质

尽管精确的 $E_{xc}[n]$ 形式未知，但我们知道它必须满足一些严格的条件和性质。这些性质为设计和检验近似泛函提供了重要的指导。

#### [绝热连接](@entry_id:199259)与耦合常数积分

一个理解 $E_{xc}[n]$ 的强大理论工具是**[绝热连接](@entry_id:199259) (adiabatic connection)**。它构建了一条从非相互作用的KS体系到真实相互作用体系的[连续路径](@entry_id:187361)。我们引入一个耦合常数 $\lambda$，它平滑地“打开”电子间的相互作用，[哈密顿算符](@entry_id:144286)变为 $\hat{H}_\lambda = \hat{T} + v_{\text{ext}}^\lambda(\mathbf{r}) + \lambda \hat{W}_{\text{ee}}$。在这里，外部势 $v_{\text{ext}}^\lambda(\mathbf{r})$ 也随 $\lambda$ 变化，以保持体系密度始终为真实的基态密度 $n(\mathbf{r})$。

根据[Hellmann-Feynman定理](@entry_id:173798)，可以推导出交换-[相关能](@entry_id:144432)的精确表达式，即**[耦合常数](@entry_id:747980)积分公式** [@problem_id:2884922]：
$E_{xc}[n] = \int_0^1 d\lambda \, \langle \Psi_\lambda | \hat{W}_{\text{ee}} | \Psi_\lambda \rangle - E_H[n]$
其中 $\Psi_\lambda$ 是在[耦合强度](@entry_id:275517)为 $\lambda$ 时，保持密度为 $n(\mathbf{r})$ 的[基态](@entry_id:150928)[波函数](@entry_id:147440)。这个公式将 $E_{xc}[n]$ 与在不同相互作用强度下的[电子-电子排斥](@entry_id:154978)能的[期望值](@entry_id:153208)联系起来。它也可以写成：
$E_{xc}[n] = \int_0^1 W_\lambda[n] \, d\lambda$
其中 $W_\lambda[n] = \langle \Psi_\lambda | \hat{W}_{\text{ee}} | \Psi_\lambda \rangle - E_H[n]$ 是[绝热连接](@entry_id:199259)的被积函数。$\lambda=0$ 的极限对应于[交换能](@entry_id:137069) $E_x[n]$，而积分的其余部分则定义了相关能 $E_c[n]$。

#### 分数[电荷](@entry_id:275494)、分段线性与[导数不连续性](@entry_id:136336)

精确泛函的另一个深刻性质体现在它如何处理非整数电子数。对于一个孤立的有限体系，在精确理论中，总能量 $E$ 作为电子数 $N$ 的函数，在整数之间是**[分段线性](@entry_id:201467)**的 [@problem_id:2884925]。对于 $N+\alpha$ 个电子（$N$为整数，$0  \alpha  1$），其能量是 $N$ 电子和 $N+1$ 电子体系能量的[线性组合](@entry_id:154743)：
$E(N+\alpha) = (1-\alpha)E(N) + \alpha E(N+1)$

这个性质导致化学势 $\mu = \partial E / \partial N$ 在整数 $N$ 处存在一个**[导数不连续性](@entry_id:136336) (derivative discontinuity)** [@problem_id:2884936]。从左边趋近整数 $N$（即移除电子），化学势为：
$\mu^- = \frac{E(N) - E(N-1)}{N - (N-1)} = -(E(N-1) - E(N)) = -I$
其中 $I$ 是体系的[电离能](@entry_id:136678)。

从右边趋近整数 $N$（即加入电子），化学势为：
$\mu^+ = \frac{E(N+1) - E(N)}{(N+1) - N} = E(N+1) - E(N) = -A$
其中 $A$ 是体系的电子亲和能。

在精确的DFT中，[电离能](@entry_id:136678)定理指出 $I = -\varepsilon_H$，其中 $\varepsilon_H$ 是最高占据KS[轨道](@entry_id:137151) (HOMO) 的能量。然而，[电子亲和能](@entry_id:147520) $A$ **不等于** 最低未占KS[轨道](@entry_id:137151) (LUMO) 的能量的负值，即 $A \neq -\varepsilon_L$。这是因为交换-相关势 $v_{xc}(\mathbf{r})$ 本身在电子数穿过整数时会发生一个不连续的跳变。这个跳变，记为 $\Delta_{xc}$，修正了LUMO能量与电子亲和能的关系：
$A = -(\varepsilon_L + \Delta_{xc})$

将这些关系结合起来，我们得到了一个关于**基本[能隙](@entry_id:191975)** $E_g = I - A$ 的重要表达式：
$E_g = I - A = (-\varepsilon_H) - (-(\varepsilon_L + \Delta_{xc})) = (\varepsilon_L - \varepsilon_H) + \Delta_{xc}$

这个公式表明，真实体系的基本[能隙](@entry_id:191975)等于[Kohn-Sham轨道](@entry_id:171979)[能隙](@entry_id:191975) $(\varepsilon_L - \varepsilon_H)$ 加上交换-相关势的[导数不连续性](@entry_id:136336) $\Delta_{xc}$。大多数近似泛函（如[LDA](@entry_id:138982)和GGA）缺乏这种不连续性，导致它们的KS[能隙](@entry_id:191975)系统性地低估了真实的基本[能隙](@entry_id:191975)，这是一个众所周知的缺陷。例如，对于一个实验测得 $I=7.90$ eV, $A=1.20$ eV，且其精确KS[轨道](@entry_id:137151)能为 $\varepsilon_H = -7.90$ eV, $\varepsilon_L = -1.50$ eV 的体系，其基本[能隙](@entry_id:191975)为 $E_g = 6.70$ eV，而KS[能隙](@entry_id:191975)仅为 $6.40$ eV。这 $0.30$ eV 的差异完全来自于[导数不连续性](@entry_id:136336) $\Delta_{xc}$ [@problem_id:2884936]。

同样，大多数近似泛函对分数[电荷](@entry_id:275494)体系的能量描述也不是[分段线性](@entry_id:201467)的，而是呈现出错误的曲率，这会导致严重的“[离域误差](@entry_id:166117)”，使得电子倾向于不物理地分散到多个原子或分子上 [@problem_id:2884925]。理解和模拟这些精确性质是现代[DFT泛函](@entry_id:182582)发展的一个核心研究方向。