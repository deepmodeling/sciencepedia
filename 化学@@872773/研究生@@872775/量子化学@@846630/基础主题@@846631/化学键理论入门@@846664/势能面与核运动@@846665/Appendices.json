{"hands_on_practices": [{"introduction": "为了模拟原子核如何运动，我们首先需要计算作用于其上的力，这些力被定义为势能面的负梯度。当使用附着在原子上的基组（例如高斯型轨道）时，一个常常被忽视但至关重要的力的贡献源于基函数本身随原子核一起移动。本练习将引导你推导这个“Pulay力”，从而深入理解现代量子化学软件中如何计算精确的力。[@problem_id:2917146]", "problem": "在 Born–Oppenheimer 近似中，固定原子核位置下的电子能量 $E$ 是通过求解一个稳态变分问题得到的，该问题在非正交原子轨道 (AO) 基组中对分子轨道 (MO) 系数施加了正交归一化约束。考虑一个带有正交归一化约束 $C^{\\top} S C = I$ 的 Hartree–Fock (HF) 或 Kohn-Sham 密度泛函理论 (DFT) 拉格朗日量，其中 $C$ 是 AO 到 MO 的系数矩阵，$S$ 是 AO 重叠矩阵。坐标 $R$ 处原子核上的力为 $F = -\\partial E / \\partial R$，并且在位置依赖的基组（例如高斯函数）中，它包含一个依赖于 $\\partial S/\\partial R$ 的 Pulay 项。\n\n任务1（推导）：从一个带有正交归一化约束的稳态拉格朗日量出发，并且仅使用 (i) 在自洽时电子能量对轨道变分是稳定的，以及 (ii) 基组通过 $S(R)$ 依赖于 $R$ 这两个条件，推导沿原子核坐标 $R$ 的 Pulay 力贡献，其形式为包含重叠矩阵导数的迹。您的推导必须用能量加权密度矩阵 $E_{\\mu\\nu}^{\\mathrm{AO}}$ 和 $\\partial S_{\\mu\\nu}/\\partial R$ 来表示 Pulay 力，而不能引用任何预先记忆的最终力公式。\n\n任务2（对最小双函数高斯模型的特例化）：考虑一个单电子同核双原子阳离子，它有两个相同的、归一化的 s 型原始高斯原子轨道 (AO) $\\{\\chi_A,\\chi_B\\}$，具有相同的指数 $\\alpha$，并放置在 x 轴上的 $\\pm R/2$ 位置。假设：\n- AO 重叠为 $S(R) = \\exp(-\\alpha R^{2}/2)$。\n- 导数为 $\\frac{dS}{dR} = -\\alpha R \\exp(-\\alpha R^{2}/2)$。\n- 使用 Wolfsberg–Helmholtz (WH) 近似来处理 AO 哈密顿矩阵，$H_{AB}(R) = K\\,S(R)\\,[H_{AA}(R) + H_{BB}(R)]/2$，并取同核常数单电子对角元 $H_{AA}(R) = H_{BB}(R) = h$，因此 $H(R) = \\begin{pmatrix} h  k\\,S(R) \\\\ k\\,S(R)  h \\end{pmatrix}$，其中 $k = K h$。\n- 求解广义本征值问题 $(H - \\varepsilon S)c = 0$ 以得到成键态，并使用归一化的对称分子轨道。\n\n基于这些假设，将沿核间距 $R$ 的 Pulay 力完全用 $h$、$k$、$\\alpha$ 和 $S(R)$ 表示。\n\n任务3（数值计算）：使用原子单位（能量单位为 Hartree，长度单位为 bohr），在以下几何构型和参数下，计算沿 $R$ 的 Pulay 力：\n- $\\alpha = 1.0\\,\\mathrm{bohr}^{-2}$,\n- $h = -0.500\\,\\mathrm{Hartree}$,\n- $K = 1.75$ 所以 $k = K h$,\n- $R = 2.000\\,\\mathrm{bohr}$。\n将 Pulay 力的最终数值答案四舍五入到四位有效数字。力以原子单位 (Hartree/bohr) 表示。最终答案必须是单个数字。", "solution": "所提出的问题是量子化学中解析导数理论的一个标准练习。它在科学上是合理的，在数学上是适定的，并包含了解决该问题所需的所有信息。我们将按要求进行推导和计算。\n\n原子核上的力是总电子能量相对于原子核坐标的负梯度，$F_A = -\\nabla_A E$。能量 $E$ 相对于原子核坐标 $R$ 的全导数由链式法则给出。能量是分子轨道系数 $C$ 的函数（$C$ 依赖于 $R$），并且通过用于构建哈密顿矩阵 $H$ 和重叠矩阵 $S$ 的基函数也显式地依赖于 $R$。\n$$\n\\frac{dE}{dR} = \\frac{\\partial E}{\\partial R} + \\sum_{\\mu, i} \\frac{\\partial E}{\\partial C_{\\mu i}} \\frac{dC_{\\mu i}}{dR}\n$$\n问题指明，在自洽时能量对轨道变分是稳定的。这个条件意味着依赖于 MO 系数对微扰响应的第二项为零。然而，这仅在变分参数 $C$ 不受约束时才成立。在非正交基组中，MO 系数受到正交归一化约束 $C^{\\dagger}SC = I$ 的限制。处理此类约束优化的正确方法是拉格朗日乘子法。\n\n任务1：Pulay 力的推导\n我们为能量最小化构建拉格朗日量 $\\mathcal{L}$，并用拉格朗日乘子 $\\varepsilon_{ji}$ 引入正交归一化约束：\n$$\n\\mathcal{L} = E(C, H) - \\sum_{i,j}^{\\text{occ}} \\varepsilon_{ji} \\left(\\sum_{\\mu,\\nu} C_{\\mu i}^* S_{\\mu\\nu} C_{\\nu j} - \\delta_{ij}\\right)\n$$\n在自洽场 (SCF) 解处，拉格朗日量对 MO 系数的变分是稳定的，即 $\\partial \\mathcal{L} / \\partial C = 0$。此条件导致 Hartree-Fock 或 Kohn-Sham 方程。此外，在解点处，拉格朗日量的值等于电子能量，$E = \\mathcal{L}$。\n\n为了求原子核力，我们计算能量对原子核坐标 $R$ 的全导数。因为对于任何 $R$，在解处都有 $E=\\mathcal{L}$，所以我们可以对 $\\mathcal{L}$ 求导：\n$$\n\\frac{dE}{dR} = \\frac{d\\mathcal{L}}{dR} = \\frac{\\partial \\mathcal{L}}{\\partial R} + \\sum_{\\mu, i} \\frac{\\partial \\mathcal{L}}{\\partial C_{\\mu i}} \\frac{dC_{\\mu i}}{dR} + \\sum_{\\mu, i} \\frac{\\partial \\mathcal{L}}{\\partial C_{\\mu i}^*} \\frac{dC_{\\mu i}^*}{dR}\n$$\n由于稳定性条件，涉及系数导数的项 $\\partial \\mathcal{L} / \\partial C$ 和 $\\partial \\mathcal{L} / \\partial C^*$ 均为零。力的表达式大大简化，这个结果被称为约束变分下的 Hellmann-Feynman 定理：\n$$\n\\frac{dE}{dR} = \\frac{\\partial \\mathcal{L}}{\\partial R}\n$$\n偏导数 $\\partial/\\partial R$ 仅作用于显式依赖于 $R$ 的量，即哈密顿量 $H$ 和重叠矩阵 $S$。在此偏导数下，MO 系数 $C$ 被视为常数。\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial R} = \\frac{\\partial E}{\\partial R} - \\sum_{i,j}^{\\text{occ}} \\varepsilon_{ji} \\frac{\\partial}{\\partial R}\\left(C_i^{\\dagger} S C_j\\right) = \\frac{\\partial E}{\\partial R} - \\sum_{i,j}^{\\text{occ}} \\varepsilon_{ji} \\left(C_i^{\\dagger} \\frac{\\partial S}{\\partial R} C_j\\right)\n$$\n$\\partial E / \\partial R$ 项考虑了构成哈密顿矩阵的单电子和双电子积分的导数。这产生了标准的 Hellmann-Feynman 力。第二项纯粹源于基函数重叠对原子核坐标的依赖性。这就是 Pulay 力的来源。\n\n在收敛时，拉格朗日乘子矩阵 $\\varepsilon$（在正则 MO 基中）是对角的，对角线上是轨道能，即 $\\varepsilon_{ji} = \\varepsilon_i \\delta_{ij}$。表达式变为：\n$$\n\\frac{dE}{dR} = \\frac{\\partial E}{\\partial R} - \\sum_{i}^{\\text{occ}} \\varepsilon_i \\left(C_i^{\\dagger} \\frac{\\partial S}{\\partial R} C_i\\right)\n$$\n对能量梯度的 Pulay 贡献是第二项：\n$$\n\\left(\\frac{dE}{dR}\\right)_{\\text{Pulay}} = - \\sum_{i}^{\\text{occ}} \\varepsilon_i \\left(C_i^{\\dagger} \\frac{\\partial S}{\\partial R} C_i\\right)\n$$\n这可以写成一个迹。为简单起见，我们假设系数为实数，$C_i^\\top$。\n$$\n\\left(\\frac{dE}{dR}\\right)_{\\text{Pulay}} = - \\sum_{i}^{\\text{occ}} \\varepsilon_i \\text{Tr}\\left(C_i^{\\top} \\frac{\\partial S}{\\partial R} C_i\\right) = - \\sum_{i}^{\\text{occ}} \\varepsilon_i \\text{Tr}\\left(\\frac{\\partial S}{\\partial R} C_i C_i^{\\top}\\right)\n$$\n利用迹的线性性质，我们交换求和与迹算符：\n$$\n\\left(\\frac{dE}{dR}\\right)_{\\text{Pulay}} = - \\text{Tr}\\left(\\frac{\\partial S}{\\partial R} \\sum_{i}^{\\text{occ}} \\varepsilon_i C_i C_i^{\\top}\\right)\n$$\n我们识别出能量加权密度矩阵，在问题陈述中记为 $E^{\\mathrm{AO}}$（通常记为 $W$），其矩阵元为 $E_{\\mu\\nu}^{\\mathrm{AO}} = \\sum_{i}^{\\text{occ}} \\varepsilon_i C_{\\mu i} C_{\\nu i}$。以矩阵形式表示，$E^{\\mathrm{AO}} = \\sum_i^{\\text{occ}} \\varepsilon_i C_i C_i^{\\top}$。\n因此，对梯度的 Pulay 贡献为：\n$$\n\\left(\\frac{dE}{dR}\\right)_{\\text{Pulay}} = - \\text{Tr}\\left(\\frac{\\partial S}{\\partial R} E^{\\mathrm{AO}}\\right)\n$$\n力是梯度的负值，所以 Pulay 力是：\n$$\nF_{\\text{Pulay}} = + \\text{Tr}\\left(E^{\\mathrm{AO}} \\frac{\\partial S}{\\partial R}\\right) = \\sum_{\\mu,\\nu} E_{\\mu\\nu}^{\\mathrm{AO}} \\left(\\frac{\\partial S}{\\partial R}\\right)_{\\nu\\mu}\n$$\n这就完成了任务1的推导。\n\n任务2：对最小模型的特例化\n我们给定一个具有 $2 \\times 2$ 哈密顿矩阵 $H$ 和重叠矩阵 $S$ 的单电子体系。矩阵为：\n$$\nH = \\begin{pmatrix} h  kS(R) \\\\ kS(R)  h \\end{pmatrix}, \\quad S = \\begin{pmatrix} 1  S(R) \\\\ S(R)  1 \\end{pmatrix}\n$$\n其中 $S(R)$ 表示非对角重叠元 $S_{AB}(R)$。首先，我们求解广义本征值问题 $(H-\\varepsilon S)c = 0$ 来找到轨道能和系数。久期方程为 $\\det(H-\\varepsilon S) = 0$：\n$$\n\\det\\begin{pmatrix} h-\\varepsilon  kS(R)-\\varepsilon S(R) \\\\ kS(R)-\\varepsilon S(R)  h-\\varepsilon \\end{pmatrix} = (h-\\varepsilon)^2 - (kS(R)-\\varepsilon S(R))^2 = 0\n$$\n这给出了能量 $\\varepsilon$ 的两个解：\n$$\nh-\\varepsilon = \\pm S(R)(k-\\varepsilon) \\implies \\varepsilon = \\frac{h \\mp kS(R)}{1 \\mp S(R)}\n$$\n问题要求的是成键态，它对应于原子轨道的对称组合 ($c_A=c_B$)。这对应于较低的能量根，即 $\\varepsilon_1 = \\frac{h+kS(R)}{1+S(R)}$。\n\n相应的本征矢量是 $C_1 = c \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。我们从条件 $C_1^{\\top} S C_1 = 1$ 中找到归一化常数 $c$：\n$$\nc^2 \\begin{pmatrix} 1  1 \\end{pmatrix} \\begin{pmatrix} 1  S(R) \\\\ S(R)  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = c^2 (1+S(R)+S(R)+1) = 2c^2(1+S(R)) = 1\n$$\n所以，$c = \\frac{1}{\\sqrt{2(1+S(R))}}$。占据轨道的系数矢量是 $C_1 = \\frac{1}{\\sqrt{2(1+S(R))}}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n\n该体系有一个电子，因此只有这个成键轨道被占据。能量加权密度矩阵 $E^{\\mathrm{AO}}$（或 $W$）是：\n$$\nE^{\\mathrm{AO}} = \\varepsilon_1 C_1 C_1^{\\top} = \\left(\\frac{h+kS(R)}{1+S(R)}\\right) \\left(\\frac{1}{2(1+S(R))}\\right) \\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix} = \\frac{h+kS(R)}{2(1+S(R))^2} \\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix}\n$$\n重叠矩阵对 $R$ 的导数是：\n$$\n\\frac{\\partial S}{\\partial R} = \\begin{pmatrix} 0  \\frac{dS(R)}{dR} \\\\ \\frac{dS(R)}{dR}  0 \\end{pmatrix} = \\begin{pmatrix} 0  -\\alpha R S(R) \\\\ -\\alpha R S(R)  0 \\end{pmatrix}\n$$\n现在我们使用任务1中推导的迹公式来计算 Pulay 力。为简洁起见，我们用 $S$ 代替 $S(R)$。\n$$\nF_{\\text{Pulay}} = \\text{Tr}\\left(E^{\\mathrm{AO}} \\frac{\\partial S}{\\partial R}\\right) = \\text{Tr}\\left( \\frac{h+kS}{2(1+S)^2} \\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix} \\begin{pmatrix} 0  -\\alpha R S \\\\ -\\alpha R S  0 \\end{pmatrix} \\right)\n$$\n$$\nF_{\\text{Pulay}} = \\frac{h+kS}{2(1+S)^2} \\text{Tr}\\left( \\begin{pmatrix} -\\alpha R S  -\\alpha R S \\\\ -\\alpha R S  -\\alpha R S \\end{pmatrix} \\right)\n$$\n所得矩阵的迹是 $(-\\alpha R S) + (-\\alpha R S) = -2\\alpha R S$。\n$$\nF_{\\text{Pulay}} = \\frac{h+kS}{2(1+S)^2} (-2\\alpha R S) = -\\frac{\\alpha R S(R) [h+kS(R)]}{[1+S(R)]^2}\n$$\n这是用给定参数表示的 Pulay 力的最终表达式。\n\n任务3：数值计算\n我们被给予以下原子单位下的参数：\n- $\\alpha = 1.0\\,\\mathrm{bohr}^{-2}$\n- $h = -0.500\\,\\mathrm{Hartree}$\n- $K = 1.75$ (无量纲)\n- $R = 2.000\\,\\mathrm{bohr}$\n\n首先，我们计算 $k$ 和 $S(R)$：\n$k = K h = 1.75 \\times (-0.500) = -0.875\\,\\mathrm{Hartree}$。\n$S(R) = \\exp(-\\alpha R^2 / 2) = \\exp(-1.0 \\times (2.000)^2 / 2) = \\exp(-2.0)$。\n$S(2.000) \\approx 0.135335$。\n\n现在，我们将这些值代入 Pulay 力的表达式中：\n$$\nF_{\\text{Pulay}} = -\\frac{(1.0)(2.000)(0.135335) [-0.500 + (-0.875)(0.135335)]}{[1+0.135335]^2}\n$$\n$$\nF_{\\text{Pulay}} = -\\frac{(0.27067) [-0.500 - 0.118418]}{[1.135335]^2}\n$$\n$$\nF_{\\text{Pulay}} = -\\frac{(0.27067)(-0.618418)}{1.288985}\n$$\n$$\nF_{\\text{Pulay}} = \\frac{0.16739}{1.288985} \\approx 0.129862\\,\\mathrm{Hartree}/\\mathrm{bohr}\n$$\n将结果四舍五入到四位有效数字，我们得到 Pulay 力的数值。\n$$\nF_{\\text{Pulay}} \\approx 0.1299\\,\\text{Hartree/bohr}\n$$", "answer": "$$\\boxed{0.1299}$$", "id": "2917146"}, {"introduction": "势能面的主要用途之一是预测和解释分子光谱，光谱为我们提供了观察原子核运动的窗口。本练习涉及一个变分计算，用以确定双原子分子在给定势能面上的转动-振动能级。通过这个实践，你将探索坐标选择的实际影响以及确保计算收敛的过程，这些都是进行任何定量光谱分析的关键技能。[@problem_id:2917094]", "problem": "你需要实现并验证一种对双原子分子在模型势能面上的转动-振动能级的变分计算，此计算使用两种坐标选择，并评估计算结果相对于基组大小和坐标选择的收敛性。计算应在 Born–Oppenheimer (BO) 近似下进行，其中核运动在固定的电子势能面上演化。\n\n起点和建模假设：\n- 考虑一个被约束在平面内的双原子分子，其内部曲线极坐标为 $(r,\\phi)$，其中 $r$ 是核间距，$\\phi$ 是平面转动角（以弧度为单位）。\n- 在 BO 近似中，核哈密顿量是动能算符和势能算符之和。动能由所选坐标系中的拉普拉斯算符构建。势能面采用 Morse 势。\n- 计算采用原子单位（因此 $\\hbar=1$），并将最终能量转换为波数，单位为 $\\text{cm}^{-1}$。\n\n推导与计算目标：\n- 从二维极坐标中的标准拉普拉斯算符和 BO 核薛定谔方程出发，在乘积拟设 $\\Psi(r,\\phi)=R_m(r)\\,\\mathrm{e}^{\\mathrm{i} m \\phi}$ 下，推导给定整数角量子数 $m$ 的径向函数的分离方程。\n- 展示如何通过变换 $R_m(r)=u_m(r)/\\sqrt{r}$ 消除径向一阶导数，从而得到一个关于 $u_m(r)$ 的一维类薛定谔方程，该方程含有一个有效的、依赖于 $m$ 的离心项。\n- 定义需要实现的两种坐标选择：\n  1. 曲线“极坐标”选择：保留由极坐标中的 Laplace–Beltrami 算符得出的离心项中完整的对 $r$ 的依赖性。\n  2. 线性化选择：将转动动能近似为一个在平衡键长处计算的恒定附加项，从而忽略其对 $r$ 的依赖性以及由曲线几何形状引起的度规修正。\n- 在有限径向区间 $[r_{\\min},r_{\\max}]$ 上，由 $N$ 个正弦函数构建一个变分基组，该基组对 $u_m(r)$ 在端点处强制施加齐次 Dirichlet 边界条件。将哈密顿矩阵构建为动能矩阵（在此基组中为对角矩阵）和通过求积得到的势能矩阵之和，其中势能矩阵使用 Morse 势，并且在曲线坐标情况下，使用依赖于 $m$ 的离心项作为有效势。对于线性化选择，在径向哈密顿量对角化之后，将转动能作为一个恒定平移项加入。\n\n使用的数值参数：\n- 约化质量 $\\mu = 918.076$（原子单位）。\n- Morse 势参数：解离能 $D_e = 0.1745$ (Hartree)，范围参数 $a=1.02$ (Bohr$^{-1}$)，以及平衡键长 $r_e = 1.4$ (Bohr)。\n- 径向域 $[r_{\\min},r_{\\max}] = [0.2,6.0]$ (Bohr)。角度 $\\phi$ 以弧度为单位。\n- 从 Hartree 到 $\\text{cm}^{-1}$ 的转换因子：$1\\,\\text{Hartree} = 219474.6313705\\,\\text{cm}^{-1}$。\n\n变分基组和求积要求：\n- 使用作用于变换后的径向函数 $u_m(r)$ 的基函数 $\\{\\phi_n(r)\\}_{n=1}^{N}$，其中 $\\phi_n(r)=\\sqrt{2/L}\\,\\sin\\!\\big(n\\pi (r-r_{\\min})/L\\big)$ 且 $L=r_{\\max}-r_{\\min}$。\n- 通过在 $[r_{\\min},r_{\\max}]$ 上进行精确的数值求积（例如，Gauss–Legendre 求积法）来计算所有与势相关的矩阵元，确保有足够的节点以安全地处理远离 $r=0$ 处的 $1/r^2$ 行为。\n- 对角化对称的哈密顿矩阵，以获得最低本征值，该值作为指定 $m$ 的最低转振能的变分上界。\n\n需要精确实现的两种坐标选择：\n- 极坐标：包含由极坐标中的曲线动能算符自然产生的完整离心项。\n- 线性化：用在 $r=r_e$ 处计算的恒定转动能替换依赖于 $r$ 的转动项，并省略由曲线坐标变换引起的度规修正；将此常数加到从纯径向哈密顿量获得的振动本征值上。\n\n测试组：\n对于下面的每个参数三元组 $(N,m,\\text{coord})$，计算最低能级（单位为 $\\text{cm}^{-1}$，四舍五入到两位小数），其中 $\\text{coord}$ 是字符串 $\"polar\"$（用于曲线坐标情况）或 $\"linearized\"$（用于恒定转动近似）：\n- 情况 1：$N=8$, $m=0$, $\\text{coord}=\"polar\"$。\n- 情况 2：$N=24$, $m=0$, $\\text{coord}=\"polar\"$。\n- 情况 3：$N=48$, $m=0$, $\\text{coord}=\"polar\"$。\n- 情况 4：$N=48$, $m=5$, $\\text{coord}=\"polar\"$。\n- 情况 5：$N=48$, $m=5$, $\\text{coord}=\"linearized\"$。\n- 情况 6：$N=64$, $m=15$, $\\text{coord}=\"polar\"$。\n- 情况 7：$N=64$, $m=15$, $\\text{coord}=\"linearized\"$。\n\n输出规格：\n- 你的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表，其中包含按上述顺序列出的七个情况的结果，例如，$[\\text{result}_1,\\text{result}_2,\\dots,\\text{result}_7]$。\n- 每个 $\\text{result}_k$ 必须是对应情况的最低能量（单位为 $\\text{cm}^{-1}$），四舍五入到两位小数，输出行中不显示单位。\n\n不得使用提示或快捷公式；所有必要的表达式都应从开头指定的基本定义中推导得出。所有相关的角度量必须以弧度为单位，所有最终能量必须按规定以 $\\text{cm}^{-1}$ 为单位报告，并四舍五入到两位小数。", "solution": "所提出的问题是计算分子量子力学中的一个标准练习。它具有科学依据，问题陈述清晰，并包含了获得唯一解所需的所有必要信息。因此，该问题被认为是有效的。我们开始进行求解。\n\n目标是在 Born-Oppenheimer 近似下计算平面双原子分子的转动-振动能级。核运动由二维极坐标 $(r, \\phi)$ 中的不含时薛定谔方程 $\\hat{H}\\Psi(r, \\phi) = E\\Psi(r, \\phi)$ 描述。哈密顿算符 $\\hat{H}$ 是动能算符 $\\hat{T}$ 和势能算符 $\\hat{V}$ 的和。在原子单位中（$\\hbar=1$），表达式为：\n$$ \\hat{H} = -\\frac{1}{2\\mu}\\nabla^2 + V(r) $$\n此处，$\\mu$ 是分子的约化质量。极坐标中的拉普拉斯算符由下式给出：\n$$ \\nabla^2 = \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r\\frac{\\partial}{\\partial r}\\right) + \\frac{1}{r^2}\\frac{\\partial^2}{\\partial\\phi^2} = \\frac{\\partial^2}{\\partial r^2} + \\frac{1}{r}\\frac{\\partial}{\\partial r} + \\frac{1}{r^2}\\frac{\\partial^2}{\\partial\\phi^2} $$\n势能 $V(r)$ 由 Morse 势建模：\n$$ V(r) = D_e \\left( 1 - e^{-a(r-r_e)} \\right)^2 $$\n其中 $D_e$ 是解离能，$a$ 是范围参数，$r_e$ 是平衡键长。\n\n由于势的柱对称性，波函数可以使用乘积拟设 $\\Psi(r, \\phi) = R_m(r)\\Phi(\\phi)$ 分离为径向和角向分量。角向部分 $\\Phi(\\phi)$ 必须是角动量算符的本征函数，这导致其形式为 $\\Phi(\\phi) \\propto e^{im\\phi}$，其中 $m$ 是一个整数量子数。应用拉普拉斯算符的角向部分，$\\frac{\\partial^2}{\\partial\\phi^2}e^{im\\phi} = -m^2 e^{im\\phi}$。将该拟设代入薛定谔方程并分离变量，得到关于 $R_m(r)$ 的径向方程：\n$$ \\left[ -\\frac{1}{2\\mu}\\left(\\frac{d^2}{dr^2} + \\frac{1}{r}\\frac{d}{dr}\\right) + \\frac{m^2}{2\\mu r^2} + V(r) \\right] R_m(r) = E R_m(r) $$\n\n这个方程包含一个一阶导数项，这对许多数值方法来说很不方便。为了获得标准的一维类薛定谔形式，我们引入变换 $R_m(r) = u_m(r)/\\sqrt{r}$。作用于 $R_m(r)$ 的径向动能算符变为：\n$$ \\left(\\frac{d^2}{dr^2} + \\frac{1}{r}\\frac{d}{dr}\\right) \\frac{u_m(r)}{\\sqrt{r}} = \\frac{1}{\\sqrt{r}} \\frac{d^2 u_m(r)}{dr^2} - \\frac{1}{4r^2} \\frac{u_m(r)}{\\sqrt{r}} $$\n将此代回径向方程，并两边同乘以 $\\sqrt{r}$，即可消去一阶导数项，得到变换后径向函数 $u_m(r)$ 的方程：\n$$ -\\frac{1}{2\\mu}\\frac{d^2u_m(r)}{dr^2} + \\left( V(r) + \\frac{m^2}{2\\mu r^2} - \\frac{1}{8\\mu r^2} \\right) u_m(r) = E u_m(r) $$\n这可以更紧凑地写为：\n$$ -\\frac{1}{2\\mu}\\frac{d^2u_m(r)}{dr^2} + V_{\\text{eff}}^{(m)}(r) u_m(r) = E u_m(r) $$\n其中有效势依赖于 $m$：\n$$ V_{\\text{eff}}^{(m)}(r) = V(r) + \\frac{\\hbar^2(m^2 - 1/4)}{2\\mu r^2} $$\n在原子单位中（$\\hbar=1$），此为 $V_{\\text{eff}}^{(m)}(r) = V(r) + \\frac{m^2 - 1/4}{2\\mu r^2}$。$\\frac{m^2}{2\\mu r^2}$ 项是我们熟悉的离心势，而 $\\frac{-1/4}{2\\mu r^2}$ 项是源于曲线坐标系体积元（或度规）的修正项。\n\n我们现在定义要比较的两种计算模型：\n1.  **极坐标模型**：此模型对给定的量子数 $m$ 使用上面推导的精确有效势：\n    $$ V_{\\text{polar}}^{(m)}(r) = D_e \\left( 1 - e^{-a(r-r_e)} \\right)^2 + \\frac{m^2 - 1/4}{2\\mu r^2} $$\n2.  **线性化模型**：此模型将转动能近似为一个常数，并忽略转动与振动之间的耦合。首先，通过设置 $m=0$ 并省略度规引起的修正项来求解纯振动能。势就是简单的 Morse 势，$V_{\\text{vib}}(r) = V(r)$。得到的最低本征值 $E_{\\text{vib},0}$ 对应于振动基态。然后，通过加上在平衡距离 $r_e$ 处计算的刚性转子能量来近似转振能：\n    $$ E_{\\text{linearized}}^{(m)} = E_{\\text{vib},0} + \\frac{\\hbar^2 m^2}{2\\mu r_e^2} $$\n\n为求解 $u_m(r)$ 的一维薛定谔方程，我们采用变分法。函数 $u_m(r)$ 在一个由 $N$ 个函数组成的基组 $\\{\\phi_n(r)\\}_{n=1}^N$ 中展开，该基组定义在长度为 $L=r_{\\max}-r_{\\min}$ 的有限径向区间 $[r_{\\min}, r_{\\max}]$ 上：\n$$ u_m(r) = \\sum_{n=1}^{N} c_n \\phi_n(r) $$\n基函数选择为“箱中粒子”的基函数，它们是标准正交的，并满足齐次 Dirichlet 边界条件（$u_m(r_{\\min})=u_m(r_{\\max})=0$）：\n$$ \\phi_n(r) = \\sqrt{\\frac{2}{L}} \\sin\\left(\\frac{n\\pi(r-r_{\\min})}{L}\\right) $$\n问题随后简化为求解矩阵本征值方程 $\\mathbf{H}\\mathbf{c} = E\\mathbf{c}$，其中 $\\mathbf{H}$ 是 $N \\times N$ 的哈密顿矩阵，其矩阵元为 $H_{n'n} = \\langle \\phi_{n'}|\\hat{H}_{\\text{eff}}|\\phi_n\\rangle$。该矩阵是动能部分 $\\mathbf{T}$ 和势能部分 $\\mathbf{V}$ 的和。\n\n动能矩阵元由下式给出：\n$$ T_{n'n} = \\langle \\phi_{n'} | -\\frac{1}{2\\mu}\\frac{d^2}{dr^2} | \\phi_n \\rangle $$\n由于基函数是二阶导数算符的本征函数，$\\frac{d^2}{dr^2}\\phi_n = -(\\frac{n\\pi}{L})^2\\phi_n$，因此动能矩阵是对角的：\n$$ T_{n'n} = \\frac{1}{2\\mu}\\left(\\frac{n\\pi}{L}\\right)^2 \\delta_{n'n} $$\n\n势能矩阵元是非对角的，通过数值积分计算：\n$$ V_{n'n} = \\langle \\phi_{n'} | V_{\\text{eff}}(r) | \\phi_n \\rangle = \\int_{r_{\\min}}^{r_{\\max}} \\phi_{n'}(r) V_{\\text{eff}}(r) \\phi_n(r) dr $$\n其中 $V_{\\text{eff}}(r)$ 对应于极坐标模型或线性化模型的有效势。我们对此积分使用 Gauss-Legendre 求积法，将积分域 $[r_{\\min}, r_{\\max}]$ 变换到 $[-1, 1]$，并将积分近似为在求积格点上的加权和。\n\n对于每个测试用例，步骤如下：\n1.  构建 $N \\times N$ 的动能矩阵 $\\mathbf{T}$。\n2.  根据坐标选择（`polar` 或 `linearized`）和量子数 $m$ 选择合适的有效势 $V_{\\text{eff}}(r)$。\n3.  使用数值求积构建 $N \\times N$ 的势能矩阵 $\\mathbf{V}$。\n4.  构成完整的哈密顿矩阵 $\\mathbf{H} = \\mathbf{T} + \\mathbf{V}$。\n5.  对角化对称矩阵 $\\mathbf{H}$ 以找到其本征值。最低的本征值是在给定势中基态能量的变分估计。\n6.  对于 `linearized` 模型，将恒定的转动能项 $\\frac{m^2}{2\\mu r_e^2}$ 加到获得的本征值上。\n7.  将最终能量从 Hartrees 转换为波数（cm$^{-1}$）并四舍五入到两位小数。\n\n此程序针对问题陈述中指定的七个测试用例中的每一个进行实现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import roots_legendre\n\ndef solve():\n    \"\"\"\n    Computes ro-vibrational energy levels of a diatomic molecule\n    using a variational method with a sine basis set.\n    \"\"\"\n    # Define physical and numerical constants from the problem statement.\n    MU = 918.076  # Reduced mass in atomic units\n    DE = 0.1745    # Morse potential dissociation energy in Hartree\n    A = 1.02       # Morse potential range parameter in 1/Bohr\n    RE = 1.4       # Morse potential equilibrium distance in Bohr\n    R_MIN = 0.2    # Minimum of radial domain in Bohr\n    R_MAX = 6.0    # Maximum of radial domain in Bohr\n    HARTREE_TO_CM = 219474.6313705  # Conversion factor\n\n    # Derived constants\n    L = R_MAX - R_MIN  # Length of the radial domain\n    N_QUAD = 256       # Number of Gauss-Legendre quadrature points\n\n    # Pre-calculate quadrature points and weights for the interval [-1, 1]\n    quad_points_std, quad_weights = roots_legendre(N_QUAD)\n    \n    # Map quadrature points to the radial domain [r_min, r_max]\n    r_quad = (L / 2) * quad_points_std + (R_MAX + R_MIN) / 2\n\n    # Define the potential functions\n    def morse_potential(r):\n        return DE * (1 - np.exp(-A * (r - RE)))**2\n\n    # Cache for the purely vibrational energy needed for the linearized model\n    vibrational_energies_cache = {}\n\n    def get_lowest_energy(N, m, coord):\n        \"\"\"\n        Calculates the lowest energy for a given set of parameters.\n        \"\"\"\n        # --- Kinetic Energy Matrix (T) ---\n        # T is diagonal in the sine basis.\n        T = np.zeros((N, N))\n        n_indices = np.arange(1, N + 1)\n        T_diag = (n_indices * np.pi / L)**2 / (2 * MU)\n        np.fill_diagonal(T, T_diag)\n        \n        # --- Potential Energy Matrix (V) ---\n        if coord == \"polar\":\n            v_eff_quad = morse_potential(r_quad) + (m**2 - 0.25) / (2 * MU * r_quad**2)\n        elif coord == \"linearized\":\n            # For the linearized model, we need the ground vibrational energy.\n            # This corresponds to m=0 and no Langer correction.\n            # We can cache this calculation as it's the same for all linearized cases with same N.\n            if N in vibrational_energies_cache:\n                energy_vib_hartree = vibrational_energies_cache[N]\n                rotational_energy = m**2 / (2 * MU * RE**2)\n                total_energy_hartree = energy_vib_hartree + rotational_energy\n                return total_energy_hartree * HARTREE_TO_CM\n\n            v_eff_quad = morse_potential(r_quad)\n        else:\n            raise ValueError(f\"Unknown coordinate choice: {coord}\")\n\n        # Evaluate basis functions at the quadrature points\n        # phi_vals[n-1, k] corresponds to phi_n(r_quad[k])\n        phi_vals = np.sqrt(2 / L) * np.sin(n_indices[:, np.newaxis] \\\n                   * np.pi * (r_quad - R_MIN) / L)\n        \n        # Construct the potential matrix V using numerical quadrature\n        V = np.zeros((N, N))\n        for i in range(N):\n            for j in range(i, N):\n                integrand = phi_vals[i, :] * phi_vals[j, :] * v_eff_quad\n                integral = np.sum(quad_weights * integrand)\n                V[i, j] = (L / 2) * integral\n                if i != j:\n                    V[j, i] = V[i, j]\n\n        # --- Diagonalization ---\n        H = T + V\n        eigenvalues = np.linalg.eigh(H)[0]\n        lowest_energy_hartree = eigenvalues[0]\n\n        # --- Final Energy Calculation ---\n        if coord == \"linearized\":\n            vibrational_energies_cache[N] = lowest_energy_hartree\n            rotational_energy = m**2 / (2 * MU * RE**2)\n            total_energy_hartree = lowest_energy_hartree + rotational_energy\n        else:\n            total_energy_hartree = lowest_energy_hartree\n\n        return total_energy_hartree * HARTREE_TO_CM\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, m, coord)\n        (8, 0, \"polar\"),\n        (24, 0, \"polar\"),\n        (48, 0, \"polar\"),\n        (48, 5, \"polar\"),\n        (48, 5, \"linearized\"),\n        (64, 15, \"polar\"),\n        (64, 15, \"linearized\"),\n    ]\n\n    results = []\n    for case in test_cases:\n        N, m, coord = case\n        energy_cm = get_lowest_energy(N, m, coord)\n        results.append(f\"{energy_cm:.2f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2917094"}, {"introduction": "量子隧穿效应允许粒子穿过在经典力学中无法逾越的势垒，这一现象在许多化学反应和大振幅运动中至关重要。本计算练习要求你计算对称双势阱中的隧穿分裂，这是此类过程的经典模型。通过将数值精确解与强大的Wentzel-Kramers-Brillouin (WKB) 半经典近似进行比较，你将更深刻地理解势能面形貌与非经典核动力学之间的相互作用。[@problem_id:2917145]", "problem": "考虑在一个由四次形式 $V(x) = a \\,(x^2 - b^2)^2$ 定义的对称双势阱势能面上的一维核运动，单位为原子单位（a.u.），其中约化普朗克常数 $\\hbar = 1$，电子质量 $m_e = 1$，能量以哈特里（hartree）为单位，长度以玻尔（bohr）为单位。核质量 $m$ 在哈密顿量 $H = -\\dfrac{1}{2 m}\\dfrac{d^2}{dx^2} + V(x)$ 中被视为一个标量参数。势阱极小值位于 $x = \\pm b$，其中 $V(\\pm b) = 0$，中心势垒位于 $x = 0$，其高度为 $V(0) = a b^4$。任务是计算最低振动双重态的隧穿分裂，并将解析半经典估计与精确数值结果进行比较。\n\n从不含时薛定谔方程和 Wentzel–Kramers–Brillouin (WKB) 近似的基本定义出发，推导一种计算方法，对于给定的参数集 $(m,a,b)$，该方法应执行以下操作：\n\n- 在极小值点 $x = b$ 处构建局域谐振子近似，以从 $V''(b)$ 和 $m$ 估计单势阱基态能量 $E_0$ 和小振幅角频率 $\\omega_0$。\n- 使用一维 WKB 势垒穿透分析，通过计算能量为 $E_0$ 时内转折点之间经典禁区的虚经典作用量，来估计最低双重态的隧穿分裂 $\\Delta_{\\text{WKB}}$。\n- 通过在均匀网格上使用有限差分法 (FDM) 对哈密顿量进行数值对角化，并在有限区间 $[-L,L]$ 上施加 Dirichlet 边界条件，来计算精确分裂 $\\Delta_{\\text{exact}}$。使用二阶中心差分动能算符构成一个对称三对角哈密顿矩阵，并求得两个最低的本征值 $E_0^{\\text{exact}}$ 和 $E_1^{\\text{exact}}$；然后设 $\\Delta_{\\text{exact}} = E_1^{\\text{exact}} - E_0^{\\text{exact}}$。\n\n您的程序必须实现这两种方法，并为每个测试用例报告：\n- $\\Delta_{\\text{exact}}$，以哈特里为单位，\n- $\\Delta_{\\text{WKB}}$，以哈特里为单位，\n- 绝对差 $|\\Delta_{\\text{exact}} - \\Delta_{\\text{WKB}}|$，以哈特里为单位。\n\n所有能量必须以哈特里表示，并且报告的每个浮点数必须四舍五入到 $8$ 位小数。\n\n您必须自己实现作用量积分的数值积分和三对角哈密顿量的对角化，使用科学标准算法，但您可以使用经过充分测试的数值库例程来进行求根、求积和对称三对角本征求解。\n\n测试套件和离散化细节：\n- 对所有测试用例使用相同的网格和计算区域：$L = 6.0$ 玻尔，以及一个包含 $N = 2000$ 个总点的均匀网格；通过将哈密顿量限制在 $N-2$ 个内部点上，在 $x = \\pm L$ 处施加 Dirichlet 边界条件。\n- 使用以下 $3$ 组参数集 $(m,a,b)$，其选择旨在探测不同的势垒区域，同时保持科学真实性和数值稳定性：\n  - 情况 A（中到高势垒）：$(m,a,b) = (1.0, 1.0, 1.5)$。\n  - 情况 B（中等势垒）：$(m,a,b) = (1.0, 3.0, 1.0)$。\n  - 情况 C（近阈值势垒，WKB 压力测试）：$(m,a,b) = (1.0, 20.0, 0.7)$。\n  \n对于每种情况，确保势垒高度 $a b^4$ 超过局域谐振子零点能估计 $E_0$，以便为 WKB 分析存在经典禁区。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个浮点数的平坦列表，按顺序为 $[\\Delta_{\\text{exact}}^{(A)}, \\Delta_{\\text{WKB}}^{(A)}, |\\Delta_{\\text{exact}}^{(A)} - \\Delta_{\\text{WKB}}^{(A)}|, \\Delta_{\\text{exact}}^{(B)}, \\Delta_{\\text{WKB}}^{(B)}, |\\Delta_{\\text{exact}}^{(B)} - \\Delta_{\\text{WKB}}^{(B)}|, \\Delta_{\\text{exact}}^{(C)}, \\Delta_{\\text{WKB}}^{(C)}, |\\Delta_{\\text{exact}}^{(C)} - \\Delta_{\\text{WKB}}^{(C)}|]$，四舍五入到 $8$ 位小数，并用方括号括起来，值之间用逗号分隔，单行共 $9$ 个浮点数。\n\n本问题不涉及角度单位。本问题不涉及百分比。输出中出现的所有物理量必须以哈特里为单位，并四舍五入到 $8$ 位小数。不得打印任何其他文本。", "solution": "所提出的问题是计算量子力学中的一个标准练习，并且是有效的。它具有科学依据，问题明确，客观，并包含获得唯一解所需的所有信息。任务涉及求解质量为 $m$ 的粒子在对称双势阱势 $V(x) = a (x^2 - b^2)^2$ 中的一维不含时薛定谔方程。目标是计算基态双重态的能量分裂 $\\Delta E$，该分裂源于通过中心势垒的量子隧穿。这将通过两种不同的方法来完成：半经典的 Wentzel–Kramers–Brillouin (WKB) 近似和使用有限差分法 (FDM) 的数值精确对角化。将对两种方法的结果进行比较。我们在原子单位中进行计算，其中 $\\hbar = 1$。哈密顿量由下式给出：\n$$\nH = -\\dfrac{1}{2 m}\\dfrac{d^2}{dx^2} + V(x)\n$$\n\n首先，我们推导 WKB 近似的计算步骤。该方法提供了一个解析估计，在高而宽的势垒极限下是准确的。\n\n对称双势阱势中最低双重态的能量分裂的 WKB 公式为：\n$$\n\\Delta_{\\text{WKB}} = \\frac{\\hbar \\omega_0}{\\pi} e^{-S/\\hbar}\n$$\n在原子单位中，这变为 $\\Delta_{\\text{WKB}} = \\frac{\\omega_0}{\\pi} e^{-S}$。这里，$\\omega_0$ 是单个势阱内小幅振荡的经典角频率，$S$ 是在势垒下隧穿的经典作用量。\n\n为了找到 $\\omega_0$，我们在势 $V(x)$ 的一个极小值点（例如 $x=b$）附近进行谐振子近似。将势在 $x=b$ 附近展开到二阶泰勒级数：\n$V(x) \\approx V(b) + V'(b)(x-b) + \\frac{1}{2}V''(b)(x-b)^2$。\n势的定义使得 $V(b) = 0$ 且 $V'(x) = 4ax(x^2-b^2)$，所以 $V'(b)=0$。二阶导数为 $V''(x) = 4a(3x^2 - b^2)$，这给出 $V''(b) = 4a(3b^2 - b^2) = 8ab^2$。\n近似的谐振子势为 $V_{\\text{HO}}(x) = \\frac{1}{2}(8ab^2)(x-b)^2$。这对应于一个劲度系数为 $k = 8ab^2$ 的谐振子。因此角频率为 $\\omega_0 = \\sqrt{k/m} = \\sqrt{8ab^2/m}$。\n\n在这种单势阱谐振子近似下的基态能量是零点能 $E_0 = \\frac{1}{2}\\hbar\\omega_0$。当 $\\hbar=1$ 时，我们有：\n$$\nE_0 = \\frac{1}{2}\\omega_0 = \\sqrt{\\frac{2ab^2}{m}}\n$$\n在 WKB 计算中，这个能量 $E_0$ 被用作隧穿粒子的能级。\n\n作用量积分 $S$，也称为 Gamow 因子指数，是在经典禁区内计算的：\n$$\nS = \\int_{-c}^{c} |p(x)| \\, dx = \\int_{-c}^{c} \\sqrt{2m(V(x) - E_0)} \\, dx\n$$\n积分限 $\\pm c$ 是内经典转折点，在这些点上能量 $E_0$ 等于势能 $V(x)$。它们通过求解方程 $V(x) = E_0$ 来找到：\n$a(x^2 - b^2)^2 = E_0 \\implies x^2 - b^2 = \\pm\\sqrt{E_0/a} \\implies x^2 = b^2 \\pm \\sqrt{E_0/a}$。\n内转折点对应于 $x^2$ 的较小正解，因此我们取负号：$c^2 = b^2 - \\sqrt{E_0/a}$，这给出 $c = \\sqrt{b^2 - \\sqrt{E_0/a}}$。$c$ 的实数解的存在性由问题条件保证，即势垒高度 $V(0) = ab^4$ 大于 $E_0$。对于这个势，$S$ 的积分没有简单的解析解，必须进行数值计算。\n\n接下来，我们详细介绍使用有限差分法 (FDM) 的数值精确方法。该方法将连续的微分薛定谔方程转化为一个离散的矩阵本征值问题。\n\n空间域 $[-L, L]$ 被离散化为一个包含 $N$ 个点 $x_i = -L + i \\cdot \\Delta x$（其中 $i=0, \\dots, N-1$）的均匀网格，网格间距为 $\\Delta x = 2L/(N-1)$。波函数 $\\psi(x)$ 由其在这些网格点上的值的向量 $\\vec{\\psi} = (\\psi_0, \\psi_1, \\dots, \\psi_{N-1})^T$ 表示。\n\n动能算符中的二阶导数由二阶中心差分近似：\n$$\n\\frac{d^2\\psi}{dx^2}\\bigg|_{x_i} \\approx \\frac{\\psi(x_{i+1}) - 2\\psi(x_i) + \\psi(x_{i-1})}{(\\Delta x)^2}\n$$\n问题指定了 Dirichlet 边界条件，即 $\\psi(-L) = \\psi(L) = 0$，这转化为 $\\psi_0 = 0$ 和 $\\psi_{N-1} = 0$。这意味着我们只需要求解在 $N-2$ 个内部点（从 $x_1$ 到 $x_{N-2}$）上的波函数。在内部点 $x_j$（其中 $j=1, \\dots, N-2$）处的薛定谔方程变为：\n$$\n-\\frac{1}{2m} \\left( \\frac{\\psi_{j+1} - 2\\psi_j + \\psi_{j-1}}{(\\Delta x)^2} \\right) + V(x_j)\\psi_j = E \\psi_j\n$$\n这可以重排为一个矩阵方程 $\\mathbf{H}\\vec{\\psi'} = E\\vec{\\psi'}$，其中 $\\vec{\\psi'}$ 是内部点上波函数值的向量，$\\mathbf{H}$ 是一个 $(N-2) \\times (N-2)$ 的对称三对角矩阵。该矩阵的元素为：\n- 对角元：$H_{jj} = \\frac{1}{m(\\Delta x)^2} + V(x_{j})$\n- 非对角元：$H_{j,j+1} = H_{j+1,j} = -\\frac{1}{2m(\\Delta x)^2}$\n\n这个矩阵本征值问题可以通过数值求解来找到本征值 $E_n$。两个最低的本征值，$E_0^{\\text{exact}}$ 和 $E_1^{\\text{exact}}$，对应于基态和第一激发态，它们构成了隧穿双重态。数值精确的分裂则为：\n$$\n\\Delta_{\\text{exact}} = E_1^{\\text{exact}} - E_0^{\\text{exact}}\n$$\n\n提供的程序实现了这两种方法。对于 WKB 计算，它首先计算 $\\omega_0$ 和 $E_0$，然后使用求根算法（`scipy.optimize.brentq`）找到转折点 $c$，最后使用数值求积（`scipy.integrate.quad`）计算作用量积分 $S$。对于 FDM 计算，它构造了三对角哈密顿矩阵，并使用专门的本征求解器（`scipy.linalg.eigh_tridiagonal`）来高效地找到两个最低的本征值。然后，程序为每个测试用例计算并报告所需的量。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate, linalg, optimize\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases and print the results.\n    \"\"\"\n    # Discretization and simulation box parameters as specified.\n    L = 6.0\n    N = 2000\n\n    # Test cases: (m, a, b) parameter sets.\n    test_cases = [\n        # Case A (moderate-to-high barrier)\n        (1.0, 1.0, 1.5),\n        # Case B (moderate barrier)\n        (1.0, 3.0, 1.0),\n        # Case C (near-threshold barrier, WKB stress test)\n        (1.0, 20.0, 0.7),\n    ]\n\n    # List to store all 9 final results.\n    final_results = []\n\n    for m, a, b in test_cases:\n        delta_exact, delta_wkb, abs_diff = calculate_splitting(m, a, b, L, N)\n        final_results.extend([\n            round(delta_exact, 8),\n            round(delta_wkb, 8),\n            round(abs_diff, 8)\n        ])\n\n    # Print the results in the exact specified format.\n    print(f\"[{','.join(map(str, final_results))}]\")\n\ndef calculate_splitting(m, a, b, L, N):\n    \"\"\"\n    Calculates the tunneling splitting using both FDM and WKB methods.\n\n    Args:\n        m (float): Mass of the particle.\n        a (float): Parameter 'a' of the potential V(x).\n        b (float): Parameter 'b' of the potential V(x), defines minima at +/- b.\n        L (float): Half-width of the simulation box [-L, L].\n        N (int): Number of grid points.\n\n    Returns:\n        tuple: A tuple containing (delta_exact, delta_wkb, abs_diff).\n    \"\"\"\n\n    # --- Part 1: Numerical \"Exact\" Calculation using Finite Difference Method ---\n\n    # Define the potential energy function.\n    def V(x):\n        return a * (x**2 - b**2)**2\n\n    # Set up the spatial grid. We only consider N-2 interior points.\n    x_grid = np.linspace(-L, L, N)\n    dx = x_grid[1] - x_grid[0]\n    x_interior = x_grid[1:-1] # Grid points from x_1 to x_{N-2}\n\n    # Construct the tridiagonal Hamiltonian matrix elements.\n    # Diagonal elements: 1/(m*dx^2) + V(x_i)\n    diag_elements = (1.0 / (m * dx**2)) + V(x_interior)\n\n    # Off-diagonal elements: -1/(2*m*dx^2)\n    # There are N-3 off-diagonal elements for an (N-2)x(N-2) matrix.\n    offdiag_elements = -1.0 / (2.0 * m * dx**2) * np.ones(N - 3)\n\n    # Diagonalize the tridiagonal matrix to find the two lowest eigenvalues.\n    # `eigh_tridiagonal` returns eigenvalues in ascending order.\n    # select='i' and select_range=(0, 1) requests the first two eigenvalues (indices 0 and 1).\n    eigenvalues = linalg.eigh_tridiagonal(diag_elements, offdiag_elements, select='i', select_range=(0, 1))[0]\n    E0_exact, E1_exact = eigenvalues\n\n    # Calculate the \"exact\" tunneling splitting.\n    delta_exact = E1_exact - E0_exact\n\n    # --- Part 2: Semiclassical WKB Calculation ---\n\n    # Calculate the harmonic frequency at the well minimum.\n    # k = V''(b) = 8*a*b^2. omega0 = sqrt(k/m).\n    omega0 = np.sqrt(8 * a * b**2 / m)\n\n    # Estimate the ground state energy E0 using the harmonic approximation (ZPE).\n    # In atomic units (hbar=1), E0 = 0.5 * omega0.\n    E0_harmonic = 0.5 * omega0\n\n    # Find the inner classical turning points +/- c by solving V(x) = E0_harmonic.\n    # This is equivalent to finding the root of f(x) = V(x) - E0 = 0.\n    def turning_point_eq(x):\n        return V(x) - E0_harmonic\n\n    # We search for the positive root 'c' in the interval [0, b].\n    # brentq is a robust root-finding algorithm.\n    c = optimize.brentq(turning_point_eq, 0, b)\n    \n    # Define the integrand for the action integral S.\n    def action_integrand(x):\n        return np.sqrt(2 * m * (V(x) - E0_harmonic))\n    \n    # Numerically integrate from -c to c to find the action S.\n    # We use scipy.integrate.quad for this.\n    S, _ = integrate.quad(action_integrand, -c, c)\n    \n    # Calculate the WKB tunneling splitting.\n    # delta_wkb = (omega0 / pi) * exp(-S) since hbar=1.\n    delta_wkb = (omega0 / np.pi) * np.exp(-S)\n    \n    # Calculate the absolute difference between the two methods.\n    abs_diff = np.abs(delta_exact - delta_wkb)\n\n    return delta_exact, delta_wkb, abs_diff\n\n# Execute the main function when the script is run.\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2917145"}]}