{"hands_on_practices": [{"introduction": "在深入研究复杂的微扰计算之前，我们首先探讨一个基本但至关重要的原则：对称性。本练习 [@problem_id:1212254] 将向您展示，如何利用系统的对称性（在这里是宇称）来预测微扰的结果，甚至在不进行任何积分计算的情况下，就能确定一级能量校正是否为零。掌握这种基于对称性的论证是发展物理直觉和简化量子力学问题的关键技能。", "problem": "考虑一个在三维空间中的无自旋粒子，其由未微扰哈密顿量描述\n$$H_0 = -\\frac{\\hbar^2}{2m}\\nabla^2 + U(\\mathbf{r}),$$  \n其中势 $U(\\mathbf{r})$ 在空间反演（宇称）下不变，$U(-\\mathbf{r}) = U(\\mathbf{r})$。因此，$H_0$ 的每个非简并本征态 $|n\\rangle$ 满足\n$$H_0|n\\rangle = E_n^{(0)}|n\\rangle,\\qquad P|n\\rangle = \\pi_n|n\\rangle,\\quad \\pi_n=\\pm1,$$  \n其中 $P$ 是宇称算符，其作用为 $(P\\psi)(\\mathbf{r})=\\psi(-\\mathbf{r})$。\n\n现在引入一个小的微扰\n$$V(\\mathbf{r}),\\quad V(-\\mathbf{r})=-V(\\mathbf{r}),$$  \n它在宇称变换下是奇的。使用一阶非简并微扰理论，判断一阶能量修正\n$$E_n^{(1)}=\\langle n|V|n\\rangle$$  \n是否恒为零。用 1 (真) 或 0 (假) 回答。", "solution": "一阶能量修正由下式给出：\n\n$$\nE_n^{(1)} = \\langle n | V | n \\rangle\n$$\n\n其中 $ |n\\rangle $ 是 $ H_0 $ 的一个具有确定宇称的非简并本征态，$ P|n\\rangle = \\pi_n |n\\rangle $ 且 $ \\pi_n = \\pm 1 $。微扰 $ V $ 在宇称变换下是奇的，因此 $ V(-\\mathbf{r}) = -V(\\mathbf{r}) $，这意味着算符关系为：\n\n$$\nP V P^{-1} = -V\n$$\n\n由于 $ P $ 是幺正且厄米的（$ P^\\dagger = P $）并满足 $ P^2 = I $，我们有 $ P^{-1} = P $。因此：\n\n$$\nP V P = -V\n$$\n\n现在我们计算 $ E_n^{(1)} $。由于 $P$ 是幺正的，我们可以将 $I = P^\\dagger P$ 插入到矩阵元中而不改变其值：\n$$\nE_n^{(1)} = \\langle n | V | n \\rangle = \\langle n | P^\\dagger P V | n \\rangle\n$$\n由于 $\\langle n|$ 是 $P$ 的本征矢，$\\langle n| P^\\dagger = \\langle n| P = \\pi_n^* \\langle n| = \\pi_n \\langle n|$ (因为宇称的本征值是实的)。\n$$\nE_n^{(1)} = \\pi_n \\langle n | P V | n \\rangle\n$$\n利用宇称算符的反交换关系 $PV = -VP$ (由 $PVP=-V$ 和 $P^2=I$ 得到)，我们可以替换 $PV$：\n$$\nE_n^{(1)} = \\pi_n \\langle n | (-VP) | n \\rangle = -\\pi_n \\langle n | V P | n \\rangle\n$$\n再次应用 $P|n\\rangle = \\pi_n|n\\rangle$：\n$$\nE_n^{(1)} = -\\pi_n \\langle n | V (\\pi_n |n\\rangle) = -\\pi_n^2 \\langle n | V | n \\rangle\n$$\n由于宇称本征值的平方 $\\pi_n^2 = (\\pm 1)^2 = 1$，我们得到：\n$$\nE_n^{(1)} = - (1) \\langle n | V | n \\rangle = -E_n^{(1)}\n$$\n所以：\n$$\n2 E_n^{(1)} = 0 \\quad \\Rightarrow \\quad E_n^{(1)} = 0\n$$\n因此，对于任何具有确定宇称的非简并本征态 $ |n\\rangle $，一阶能量修正恒为零。另一种更直观的解释是，积分 $\\langle n | V | n \\rangle = \\int \\psi_n^*(\\mathbf{r}) V(\\mathbf{r}) \\psi_n(\\mathbf{r}) d^3r$ 的被积函数是一个宇称为奇的函数（因为 $\\psi_n^*\\psi_n$ 是偶函数，而 $V$ 是奇函数），在一个对称的积分区间（整个空间）上的积分为零。", "answer": "$$ \\boxed{1} $$", "id": "1212254"}, {"introduction": "许多量子系统的能级是简并的，这使得标准的非简并微扰理论不再适用。本练习 [@problem_id:222600] 将引导您处理这种情况，以一个二维无限深方势阱中的粒子为例，这是一个具有简并能级的经典模型。您将学习如何建立和对角化微扰哈密顿矩阵，以确定微扰如何解除简并并导致能级分裂，这是处理简并态微扰理论的核心步骤。", "problem": "一个质量为 $m$ 的粒子被限制在势能为 $V(x,y)$ 的二维无限深方势阱中。在 $0  x  L$ 和 $0  y  L$ 的区域内势能为零，其他区域为无穷大。系统的未微扰哈密顿量为 $H_0 = -\\frac{\\hbar^2}{2m}\\left(\\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2}\\right)$。其本征函数和本征值由 $\\psi^{(0)}_{n_x, n_y}(x,y) = \\frac{2}{L} \\sin\\left(\\frac{n_x \\pi x}{L}\\right) \\sin\\left(\\frac{n_y \\pi y}{L}\\right)$ 和 $E^{(0)}_{n_x, n_y} = \\frac{\\pi^2 \\hbar^2}{2mL^2}(n_x^2 + n_y^2)$ 给出，其中 $n_x, n_y$ 是正整数。\n\n该系统受到一个弱微扰，由哈密顿量 $H' = \\lambda \\delta(x-y)$ 描述，其中 $\\lambda$ 是一个小的实常数，$\\delta(z)$ 是狄拉克 $\\delta$ 函数。\n\n使用一级简并微扰理论，确定系统第一激发能级的能量分裂。", "solution": "1.  **确定未微扰的简并态**：系统的基态是 $(n_x, n_y) = (1,1)$，它是非简并的。第一激发态是简并的，对应于 $(n_x, n_y) = (1,2)$ 和 $(2,1)$，它们具有相同的能量 $E_{1,2}^{(0)} = E_{2,1}^{(0)} = \\frac{5\\pi^2\\hbar^2}{2mL^2}$。简并子空间的基函数是：\n    $$\n    \\psi_{1,2}^{(0)}(x,y)=\\frac{2}{L}\\sin\\left(\\frac{\\pi x}{L}\\right)\\sin\\left(\\frac{2\\pi y}{L}\\right)\n    $$\n    $$\n    \\psi_{2,1}^{(0)}(x,y)=\\frac{2}{L}\\sin\\left(\\frac{2\\pi x}{L}\\right)\\sin\\left(\\frac{\\pi y}{L}\\right)\n    $$\n\n2.  **构建微扰矩阵**：我们需要计算微扰哈密顿量 $H'$ 在这个二维简并子空间中的矩阵元 $H'_{ij} = \\langle \\psi_i^{(0)} | H' | \\psi_j^{(0)} \\rangle$。\n    $$\n    H'_{ij}=\\lambda\\int_0^L \\int_0^L \\psi_i^{(0)}(x,y)^* \\delta(x-y) \\psi_j^{(0)}(x,y) \\,dx\\,dy = \\lambda\\int_0^L \\psi_i^{(0)}(x,x)^* \\psi_j^{(0)}(x,x) \\,dx\n    $$\n    由于波函数是实函数，我们有：\n    $H'_{11} = \\lambda \\int_0^L \\left(\\psi_{1,2}^{(0)}(x,x)\\right)^2 dx$\n    $H'_{22} = \\lambda \\int_0^L \\left(\\psi_{2,1}^{(0)}(x,x)\\right)^2 dx$\n    $H'_{12} = H'_{21} = \\lambda \\int_0^L \\psi_{1,2}^{(0)}(x,x) \\psi_{2,1}^{(0)}(x,x) dx$\n\n3.  **计算矩阵元**：\n    我们注意到 $\\psi_{1,2}^{(0)}(x,x) = \\frac{2}{L}\\sin\\left(\\frac{\\pi x}{L}\\right)\\sin\\left(\\frac{2\\pi x}{L}\\right)$ 和 $\\psi_{2,1}^{(0)}(x,x) = \\frac{2}{L}\\sin\\left(\\frac{2\\pi x}{L}\\right)\\sin\\left(\\frac{\\pi x}{L}\\right)$ 是相同的。因此，所有四个矩阵元都相等。我们计算这个共同的积分值，记为 $\\alpha$：\n    $$\n    \\alpha = \\int_{0}^{L}\\left(\\frac{2}{L}\\sin\\frac{\\pi x}{L}\\sin\\frac{2\\pi x}{L}\\right)^{2}dx = \\frac{4}{L^{2}}\\int_{0}^{L}\\sin^{2}\\frac{\\pi x}{L}\\sin^{2}\\frac{2\\pi x}{L}dx\n    $$\n    使用恒等式 $\\sin^2\\theta = \\frac{1-\\cos(2\\theta)}{2}$，被积函数变为：\n    $$\n    \\frac{4}{L^2} \\int_0^L \\left(\\frac{1-\\cos\\frac{2\\pi x}{L}}{2}\\right) \\left(\\frac{1-\\cos\\frac{4\\pi x}{L}}{2}\\right) dx = \\frac{1}{L^2}\\int_0^L \\left(1 - \\cos\\frac{2\\pi x}{L} - \\cos\\frac{4\\pi x}{L} + \\cos\\frac{2\\pi x}{L}\\cos\\frac{4\\pi x}{L}\\right) dx\n    $$\n    在区间 $[0, L]$ 上，$\\cos(2n\\pi x/L)$ 的积分为零。$\\cos A \\cos B$ 项可以用积化和差公式展开，同样得到在 $[0,L]$ 上积分为零的余弦项。唯一非零的贡献来自常数项 $1$。\n    $$\n    \\alpha = \\frac{1}{L^2} \\int_0^L 1 \\,dx = \\frac{L}{L^2} = \\frac{1}{L}\n    $$\n\n4.  **对角化微扰矩阵**：现在我们有了微扰矩阵：\n    $$\n    \\mathbf{H'} = \\lambda \\begin{pmatrix} \\alpha  \\alpha \\\\ \\alpha  \\alpha \\end{pmatrix} = \\frac{\\lambda}{L} \\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix}\n    $$\n    为了找到一阶能量修正，我们求解这个矩阵的本征值 $E^{(1)}$：\n    $$\n    \\det(\\mathbf{H'} - E^{(1)}\\mathbf{I}) = \\det\\begin{pmatrix} \\frac{\\lambda}{L} - E^{(1)}  \\frac{\\lambda}{L} \\\\ \\frac{\\lambda}{L}  \\frac{\\lambda}{L} - E^{(1)} \\end{pmatrix} = 0\n    $$\n    $$\n    \\left(\\frac{\\lambda}{L} - E^{(1)}\\right)^2 - \\left(\\frac{\\lambda}{L}\\right)^2 = 0\n    $$\n    这给出两个解：$E^{(1)}_- = 0$ 和 $E^{(1)}_+ = \\frac{2\\lambda}{L}$。\n\n5.  **确定能量分裂**：微扰导致原来的简并能级分裂成两个能级。它们的一阶能量修正是 $0$ 和 $\\frac{2\\lambda}{L}$。因此，能级之间的能量分裂 $\\Delta E$ 是这两个修正值之差：\n    $$\n    \\Delta E = E^{(1)}_+ - E^{(1)}_- = \\frac{2\\lambda}{L} - 0 = \\frac{2\\lambda}{L}\n    $$", "answer": "$$\\boxed{\\frac{2\\lambda}{L}}$$", "id": "222600"}, {"introduction": "微扰理论并非只有一种形式，不同的方法在不同情况下各有优劣。本练习 [@problem_id:2933735] 要求您从第一性原理出发，推导并以编程方式实现两种重要的微扰理论——Rayleigh-Schrödinger (RS) 和 Brillouin-Wigner (BW) 微扰理论。通过在一个简单的双能级模型中比较这两种理论与精确解的差异，特别是在近简并情况下，您将深刻理解它们的适用范围和局限性，这是连接理论与计算化学实践的重要一步。", "problem": "考虑一个以原子单位（哈特里原子单位制）表示的双态电子模型，其由一个与时间无关的哈密顿量表示，该哈密顿量可划分为 $H(\\lambda) = H_0 + \\lambda V$，其中 $H_0$ 是精确可解的，$V$ 是一个由无量纲参数 $\\lambda$ 缩放的小微扰。设在 $H_0$ 的未微扰本征基 $\\{\\lvert 1 \\rangle, \\lvert 2 \\rangle\\}$ 下，未微扰哈密顿量和微扰由以下公式给出\n- $H_0 = \\mathrm{diag}(E_1, E_2)$，其中 $E_1  E_2$，\n- $V = \\begin{pmatrix} 0  v \\\\ v  0 \\end{pmatrix}$，其中 $v$ 为实数，\n并在所有数值评估中取 $\\lambda = 1$。当 $\\lvert E_1 - E_2 \\rvert$ 相对于 $\\lvert v \\rvert$ 较小时，这是一个近简并模型。\n\n您的任务是根据与时间无关的微扰理论的第一性原理，实现数值程序来：\n- 为每个测试用例构建精确的哈密顿量 $H(\\lambda)$，并通过精确对角化获得其较低的精确本征值 $E_{\\mathrm{exact,lower}}$，\n- 推导并实现针对态 $\\lvert 1 \\rangle$ 的非简并 Rayleigh–Schrödinger (RS) 微扰理论能量近似（到 $\\lambda$ 的二阶），使用上述定义的基，并在 $\\lambda = 1$ 处求值以产生 $E_{\\mathrm{RS}}$，\n- 推导并实现针对相同态的 Brillouin–Wigner (BW) 微扰理论自洽能量方程，并求解该方程以获得对应于较低根的 BW 能量 $E_{\\mathrm{BW,lower}}$，\n- 通过计算绝对误差 $\\lvert E_{\\mathrm{RS}} - E_{\\mathrm{exact,lower}} \\rvert$ 和 $\\lvert E_{\\mathrm{BW,lower}} - E_{\\mathrm{exact,lower}} \\rvert$ 来量化每种近似与精确对角化的偏差。\n\n您的推导必须严格基于与时间无关的薛定谔方程 $H(\\lambda)\\lvert \\psi(\\lambda) \\rangle = E(\\lambda)\\lvert \\psi(\\lambda) \\rangle$、$\\lambda$ 的幂次微扰展开的定义、厄米矩阵的线性代数性质，以及将薛定谔方程投影到未微扰本征基上。不要假定任何预先给定的微扰理论公式；相反，从这些基本原理出发进行推理，以获得实现所需的工作表达式。\n\n使用原子单位，其中所有能量，包括 $E_1$、$E_2$、$v$ 以及任何类似能量的输出，都必须以哈特里 (Hartree) 为单位表示。以哈特里 (Hartree) 为单位报告绝对误差。不涉及角度。\n\n实现您的程序以评估以下参数三元组 $(E_1, E_2, v)$ 的测试套件：\n- 测试 $1$：$(E_1, E_2, v) = (-0.05, 0.05, 0.02)$，\n- 测试 $2$：$(E_1, E_2, v) = (-0.005, 0.005, 0.02)$，\n- 测试 $3$：$(E_1, E_2, v) = (-0.5, 0.5, 0.02)$，\n- 测试 $4$：$(E_1, E_2, v) = (-0.1, 0.1, 0.0)$，\n- 测试 $5$：$(E_1, E_2, v) = (0.10, 0.11, 0.003)$，\n- 测试 $6$：$(E_1, E_2, v) = (0.0, 10^{-6}, 5\\times 10^{-4})$。\n\n对于每个测试用例，您的程序必须输出一个包含两个浮点数的列表 $[\\lvert E_{\\mathrm{RS}} - E_{\\mathrm{exact,lower}} \\rvert, \\lvert E_{\\mathrm{BW,lower}} - E_{\\mathrm{exact,lower}} \\rvert]$，单位为哈特里 (Hartree)。将所有测试用例的结果聚合到单行中，格式为方括号括起来的逗号分隔列表，其中每个元素是针对一个测试用例的包含两个浮点数的列表。例如，输出必须看起来像 $[[x_1,y_1],[x_2,y_2],\\ldots,[x_6,y_6]]$，不含额外的空格或文本。\n\n您的程序应生成单行输出，其中包含结果，格式为方括号括起来的逗号分隔列表（例如 $[[\\text{result}_{1,1},\\text{result}_{1,2}],[\\text{result}_{2,1},\\text{result}_{2,2}],\\ldots]$）。", "solution": "所提出的问题是量子力学微扰理论中一个标准的、适定的练习。我们将对其进行验证并随后求解。\n\n**问题验证**\n\n首先，我们必须提取已知条件。该问题定义了一个由哈密顿量 $H(\\lambda) = H_0 + \\lambda V$ 控制的双态系统。在未微扰本征态基矢 $\\{\\lvert 1 \\rangle, \\lvert 2 \\rangle\\}$ 中，未微扰哈密顿量 $H_0$ 和微扰 $V$ 如下：\n$$\nH_0 = \\begin{pmatrix} E_1  0 \\\\ 0  E_2 \\end{pmatrix}, \\quad E_1  E_2\n$$\n$$\nV = \\begin{pmatrix} 0  v \\\\ v  0 \\end{pmatrix}, \\quad v \\in \\mathbb{R}\n$$\n在所有数值计算中，微扰参数 $\\lambda$ 设为 $1$。任务是找到源于态 $\\lvert 1 \\rangle$ 的较低精确本征值、二阶 Rayleigh-Schrödinger (RS) 能量和 Brillouin-Wigner (BW) 能量，并计算这些近似的绝对误差。所有推导都必须从第一性原理出发。\n\n该问题在科学上是合理的，因为它基于双能级系统的与时间无关的薛定谔方程，这是量子力学的基石之一。它是一个适定问题，提供了找到唯一解所需的所有矩阵和参数。其语言客观而精确。该问题是完整的、一致的且计算上可行的。它没有违反任何验证标准。因此，该问题被认为是有效的。我们现在开始推导所需的表达式。\n\n**1. 精确本征值**\n\n当 $\\lambda=1$ 时，完整的哈密顿量为 $H = H_0 + V$。在给定的基中，其矩阵表示为：\n$$\nH = \\begin{pmatrix} E_1  v \\\\ v  E_2 \\end{pmatrix}\n$$\n本征值 $E$ 是特征方程 $\\det(H - E I) = 0$ 的根：\n$$\n\\det \\begin{pmatrix} E_1 - E  v \\\\ v  E_2 - E \\end{pmatrix} = 0\n$$\n$$\n(E_1 - E)(E_2 - E) - v^2 = 0\n$$\n$$\nE^2 - (E_1 + E_2)E + E_1 E_2 - v^2 = 0\n$$\n这是一个关于 $E$ 的二次方程。应用二次公式，我们求得两个精确本征值：\n$$\nE_{\\pm} = \\frac{(E_1 + E_2) \\pm \\sqrt{(E_1 + E_2)^2 - 4(E_1 E_2 - v^2)}}{2}\n$$\n$$\nE_{\\pm} = \\frac{(E_1 + E_2) \\pm \\sqrt{E_1^2 + 2E_1E_2 + E_2^2 - 4E_1E_2 + 4v^2}}{2}\n$$\n$$\nE_{\\pm} = \\frac{(E_1 + E_2) \\pm \\sqrt{(E_1 - E_2)^2 + 4v^2}}{2}\n$$\n问题要求较低的精确本征值，我们记为 $E_{\\mathrm{exact,lower}}$。这对应于公式中的负号，因为平方根项始终为非负。\n$$\nE_{\\mathrm{exact,lower}} = \\frac{1}{2}\\left( (E_1 + E_2) - \\sqrt{(E_2 - E_1)^2 + 4v^2} \\right)\n$$\n这个表达式是精确的，将用作我们近似方法的基准。\n\n**2. Rayleigh-Schrödinger (RS) 微扰理论**\n\n我们从与时间无关的薛定谔方程 $H(\\lambda)\\lvert \\psi(\\lambda) \\rangle = E(\\lambda)\\lvert \\psi(\\lambda) \\rangle$ 出发。我们将能量 $E(\\lambda)$ 和态 $\\lvert \\psi(\\lambda) \\rangle$ 展开为 $\\lambda$ 的幂级数：\n$$\nE(\\lambda) = E^{(0)} + \\lambda E^{(1)} + \\lambda^2 E^{(2)} + \\mathcal{O}(\\lambda^3)\n$$\n$$\n\\lvert \\psi(\\lambda) \\rangle = \\lvert \\psi^{(0)} \\rangle + \\lambda \\lvert \\psi^{(1)} \\rangle + \\lambda^2 \\lvert \\psi^{(2)} \\rangle + \\mathcal{O}(\\lambda^3)\n$$\n我们关心的是从未微扰态 $\\lvert 1 \\rangle$ 演化而来的状态。因此，我们设 $\\lvert \\psi^{(0)} \\rangle = \\lvert 1 \\rangle$ 且 $E^{(0)} = E_1$。将展开式代入薛定谔方程：\n$$\n(H_0 + \\lambda V)(\\lvert 1 \\rangle + \\lambda \\lvert \\psi^{(1)} \\rangle + \\dots) = (E_1 + \\lambda E^{(1)} + \\lambda^2 E^{(2)} + \\dots)(\\lvert 1 \\rangle + \\lambda \\lvert \\psi^{(1)} \\rangle + \\dots)\n$$\n我们收集 $\\lambda$ 的同阶项。\n零阶方程 $H_0 \\lvert 1 \\rangle = E_1 \\lvert 1 \\rangle$ 根据定义是满足的。\n\n对于一阶项 ($\\mathcal{O}(\\lambda^1)$)：\n$$\nH_0 \\lvert \\psi^{(1)} \\rangle + V \\lvert 1 \\rangle = E_1 \\lvert \\psi^{(1)} \\rangle + E^{(1)} \\lvert 1 \\rangle\n$$\n为求一阶能量修正 $E^{(1)}$，我们将此方程投影到 $\\langle 1 \\rvert$ 上：\n$$\n\\langle 1 \\rvert H_0 \\lvert \\psi^{(1)} \\rangle + \\langle 1 \\rvert V \\lvert 1 \\rangle = E_1 \\langle 1 \\rvert \\psi^{(1)} \\rangle + E^{(1)} \\langle 1 \\rvert 1 \\rangle\n$$\n由于 $H_0$ 是厄米算符且 $\\langle 1 \\rvert H_0 = E_1 \\langle 1 \\rvert$，左边的第一项变为 $E_1 \\langle 1 \\rvert \\psi^{(1)} \\rangle$。由于 $\\langle 1 \\rvert 1 \\rangle = 1$，方程简化为：\n$$\nE_1 \\langle 1 \\rvert \\psi^{(1)} \\rangle + V_{11} = E_1 \\langle 1 \\rvert \\psi^{(1)} \\rangle + E^{(1)}\n$$\n$$\nE^{(1)} = V_{11}\n$$\n根据问题定义，$V$ 的对角元素为零，所以 $V_{11} = 0$。因此，$E^{(1)} = 0$。\n\n对于二阶项 ($\\mathcal{O}(\\lambda^2)$)：\n$$\nH_0 \\lvert \\psi^{(2)} \\rangle + V \\lvert \\psi^{(1)} \\rangle = E_1 \\lvert \\psi^{(2)} \\rangle + E^{(1)} \\lvert \\psi^{(1)} \\rangle + E^{(2)} \\lvert 1 \\rangle\n$$\n投影到 $\\langle 1 \\rvert$ 上：\n$$\n\\langle 1 \\rvert H_0 \\lvert \\psi^{(2)} \\rangle + \\langle 1 \\rvert V \\lvert \\psi^{(1)} \\rangle = E_1 \\langle 1 \\rvert \\psi^{(2)} \\rangle + E^{(1)} \\langle 1 \\rvert \\psi^{(1)} \\rangle + E^{(2)} \\langle 1 \\rvert 1 \\rangle\n$$\n两边的第一项相互抵消，剩下：\n$$\nE^{(2)} = \\langle 1 \\rvert V \\lvert \\psi^{(1)} \\rangle - E^{(1)} \\langle 1 \\rvert \\psi^{(1)} \\rangle\n$$\n因为 $E^{(1)} = 0$，这简化为 $E^{(2)} = \\langle 1 \\rvert V \\lvert \\psi^{(1)} \\rangle$。我们必须首先找到一阶波函数修正 $\\lvert \\psi^{(1)} \\rangle$。从一阶方程重新整理得到：\n$$\n(H_0 - E_1) \\lvert \\psi^{(1)} \\rangle = (E^{(1)} - V) \\lvert 1 \\rangle = -V \\lvert 1 \\rangle\n$$\n我们在未微扰基中展开 $\\lvert \\psi^{(1)} \\rangle$：$\\lvert \\psi^{(1)} \\rangle = c_{11} \\lvert 1 \\rangle + c_{12} \\lvert 2 \\rangle$。RS 理论中的标准约定设定 $\\langle 1 \\rvert \\psi^{(1)} \\rangle = 0$，这意味着 $c_{11} = 0$。所以，$\\lvert \\psi^{(1)} \\rangle = c_{12} \\lvert 2 \\rangle$。将关于 $\\lvert \\psi^{(1)} \\rangle$ 的方程投影到 $\\langle 2 \\rvert$ 上：\n$$\n\\langle 2 \\rvert (H_0 - E_1) (c_{12} \\lvert 2 \\rangle) = -\\langle 2 \\rvert V \\lvert 1 \\rangle\n$$\n$$\nc_{12} \\langle 2 \\rvert (E_2 - E_1) \\lvert 2 \\rangle = -V_{21}\n$$\n$$\nc_{12} (E_2 - E_1) = -v\n$$\n$$\nc_{12} = \\frac{-v}{E_2 - E_1}\n$$\n因此，$\\lvert \\psi^{(1)} \\rangle = \\frac{-v}{E_2 - E_1} \\lvert 2 \\rangle$。现在我们可以计算 $E^{(2)}$：\n$$\nE^{(2)} = \\langle 1 \\rvert V \\left( \\frac{-v}{E_2 - E_1} \\lvert 2 \\rangle \\right) = \\frac{-v}{E_2 - E_1} \\langle 1 \\rvert V \\lvert 2 \\rangle = \\frac{-v}{E_2 - E_1} V_{12}\n$$\n由于 $V_{12} = v$，我们得到：\n$$\nE^{(2)} = -\\frac{v^2}{E_2 - E_1}\n$$\n近似到二阶的 RS 能量为 $E_{\\mathrm{RS}} = E^{(0)} + \\lambda E^{(1)} + \\lambda^2 E^{(2)}$。在 $\\lambda = 1$ 处求值：\n$$\nE_{\\mathrm{RS}} = E_1 + 0 - \\frac{v^2}{E_2 - E_1}\n$$\n\n**3. Brillouin-Wigner (BW) 微扰理论**\n\nBW 公式避免了在方程内部展开能量 $E$。我们再次从薛定谔方程出发，设 $\\lambda=1$：$(H_0 + V) \\lvert \\psi \\rangle = E \\lvert \\psi \\rangle$。我们可以将其写为：\n$$\n(E - H_0) \\lvert \\psi \\rangle = V \\lvert \\psi \\rangle\n$$\n让我们在未微扰基中表示未知态 $\\lvert \\psi \\rangle$：$\\lvert \\psi \\rangle = c_1 \\lvert 1 \\rangle + c_2 \\lvert 2 \\rangle$。将此代入薛定谔方程的矩阵形式：\n$$\n\\begin{pmatrix} E_1  v \\\\ v  E_2 \\end{pmatrix} \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix} = E \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix}\n$$\n这给出了一个由两个线性方程组成的方程组：\n$$\nE_1 c_1 + v c_2 = E c_1  \\quad \\implies \\quad (E - E_1) c_1 = v c_2\n$$\n$$\nv c_1 + E_2 c_2 = E c_2  \\quad \\implies \\quad v c_1 = (E - E_2) c_2\n$$\nBW 理论使用中间归一化，对于从 $\\lvert 1 \\rangle$ 演化而来的状态，这意味着我们将其沿 $\\lvert 1 \\rangle$ 的分量固定为 1。也就是说，我们设 $c_1 = 1$。方程变为：\n$$\nE - E_1 = v c_2\n$$\n$$\nv = (E - E_2) c_2\n$$\n从第二个方程，我们把 $c_2$ 表示为 $c_2 = \\frac{v}{E - E_2}$。然后我们将其代入第一个方程：\n$$\nE - E_1 = v \\left( \\frac{v}{E - E_2} \\right)\n$$\n这就得到了关于 BW 能量 $E$ 的自洽方程：\n$$\nE = E_1 + \\frac{v^2}{E - E_2}\n$$\n为了求解 $E$，我们将其重新整理成多项式形式：\n$$\n(E - E_1)(E - E_2) = v^2\n$$\n$$\nE^2 - (E_1 + E_2)E + E_1 E_2 - v^2 = 0\n$$\n这恰好是为求精确本征值而得到的相同特征方程。在 BW 形式体系中，$E$ 的解就是系统的精确能量。对于双能级系统，这是一个已知的结果。问题要求较低的根 $E_{\\mathrm{BW,lower}}$，它必须等于 $E_{\\mathrm{exact,lower}}$：\n$$\nE_{\\mathrm{BW,lower}} = \\frac{1}{2}\\left( (E_1 + E_2) - \\sqrt{(E_2 - E_1)^2 + 4v^2} \\right)\n$$\n\n**4. 误差计算**\n绝对误差计算如下：\n$$\n\\text{Error}_{\\mathrm{RS}} = \\lvert E_{\\mathrm{RS}} - E_{\\mathrm{exact,lower}} \\rvert\n$$\n$$\n\\text{Error}_{\\mathrm{BW}} = \\lvert E_{\\mathrm{BW,lower}} - E_{\\mathrm{exact,lower}} \\rvert\n$$\n从我们的推导中可以清楚地看出，对于这个特定问题，$E_{\\mathrm{BW,lower}} = E_{\\mathrm{exact,lower}}$，因此对于所有测试用例，$\\text{Error}_{\\mathrm{BW}}$ 都将恒等于零。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes absolute errors for Rayleigh-Schrödinger and Brillouin-Wigner\n    perturbation theories for a two-level system against exact diagonalization.\n    \"\"\"\n    \n    # Test cases are given as tuples (E1, E2, v) in Hartree atomic units.\n    # E1, E2 are unperturbed energies; v is the off-diagonal coupling.\n    test_cases = [\n        (-0.05, 0.05, 0.02),      # Test 1\n        (-0.005, 0.005, 0.02),    # Test 2\n        (-0.5, 0.5, 0.02),        # Test 3\n        (-0.1, 0.1, 0.0),         # Test 4\n        (0.10, 0.11, 0.003),      # Test 5\n        (0.0, 1e-6, 5e-4),        # Test 6\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        e1, e2, v = case\n\n        # The unperturbed energy difference, delta_e = E2 - E1.\n        delta_e = e2 - e1\n\n        # 1. Calculation of the lower exact eigenvalue from the characteristic equation.\n        # E_exact_lower = 0.5 * ( (e1 + e2) - sqrt((e2 - e1)^2 + 4*v^2) )\n        sqrt_term = np.sqrt(delta_e**2 + 4 * v**2)\n        e_exact_lower = 0.5 * (e1 + e2 - sqrt_term)\n\n        # 2. Calculation of the Rayleigh-Schrödinger energy to second order.\n        # E_RS = E1 - v^2 / (E2 - E1)\n        # This formula is valid as E1 != E2 in all test cases.\n        e_rs = e1 if delta_e == 0 else e1 - (v**2) / delta_e\n\n        # 3. Calculation of the Brillouin-Wigner energy for the lower root.\n        # For a two-level system, the BW self-consistent equation yields a quadratic\n        # equation identical to the exact secular equation. Thus, its roots are the exact energies.\n        e_bw_lower = e_exact_lower\n\n        # 4. Computation of absolute errors for both theories.\n        error_rs = np.abs(e_rs - e_exact_lower)\n        error_bw = np.abs(e_bw_lower - e_exact_lower)  # This is analytically 0.0\n\n        all_results.append([error_rs, error_bw])\n\n    # Format the final output string as a list of lists: [[err1,err2],[err3,err4],...].\n    # The format must be exact, with no whitespace inside the inner brackets.\n    result_str = \"[\" + \",\".join([f\"[{res[0]},{res[1]}]\" for res in all_results]) + \"]\"\n    \n    print(result_str)\n\nsolve()\n```", "id": "2933735"}]}