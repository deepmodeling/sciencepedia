{"hands_on_practices": [{"introduction": "标度分析是量子力学中的一个强大工具，尤其在原子单位制下更能彰显其威力。通过巧妙的坐标变换，我们可以从薛定谔方程的结构中提取出深刻的物理洞见，而无需进行复杂的求解。本练习将引导你推导类氢原子的$Z$标度律，揭示能量和空间分布等基本性质如何依赖于原子核电荷$Z$ [@problem_id:2874935]。这不仅是一项重要的解析技巧训练，也深刻体现了物理定律的普适性。", "problem": "在原子单位（a.u.）中，定义电子质量 $m_{e}=1$、元电荷 $e=1$、约化普朗克常数 $\\hbar=1$ 以及库仑常数 $1/(4\\pi\\varepsilon_{0})=1$。考虑核电荷为 $Z>0$ 的非相对论单电子库仑问题。其束缚态在位置表象下的定态薛定谔方程为\n$$\n\\left[-\\frac{1}{2}\\nabla_{r}^{2}-\\frac{Z}{r}\\right]\\psi_{Z}(\\mathbf{r})=E_{Z}\\,\\psi_{Z}(\\mathbf{r}).\n$$\n完全在原子单位内进行计算。\n\n仅从此方程以及坐标变换和归一化的标准性质出发，完成以下任务：\n\n1. 引入一个标度化坐标 $\\boldsymbol{\\rho}=Z\\,\\mathbf{r}$，并用它将薛定谔方程改写为一个与 $Z$ 无关的形式。由此推导出能量 $E_{Z}$ 和归一化的束缚态波函数 $\\psi_{Z}(\\mathbf{r})$ 相对于 $Z=1$ 问题随 $Z$ 变化的标度关系。\n\n2. 专门针对球对称基态，利用你的标度结果，为矩 $\\langle r^{k}\\rangle_{Z}\\equiv\\int_{\\mathbb{R}^{3}} r^{k}\\,|\\psi_{Z}(\\mathbf{r})|^{2}\\,d^{3}\\mathbf{r}$ 获得一个闭合形式的表达式。该表达式是实数 $k$ 的函数（积分在此 $k$ 值下收敛），用 $Z$ 和伽马函数 $\\Gamma(\\cdot)$ 表示。你可以假定标准积分 $\\int_{0}^{\\infty} x^{\\alpha-1}\\exp(-\\beta x)\\,dx=\\Gamma(\\alpha)\\,\\beta^{-\\alpha}$（其中 $\\operatorname{Re}(\\alpha)>0, \\operatorname{Re}(\\beta)>0$）以及一个经过充分检验的事实：$Z=1$ 的基态波函数为 $\\psi_{1s}(\\mathbf{r})=(1/\\sqrt{\\pi})\\exp(-r)$。\n\n以 $Z$ 和 $k$ 表示的单个闭合形式解析表达式给出 $\\langle r^{k}\\rangle_{Z}$ 的最终结果。请用原子单位表示你的答案，不要包含单位。无需进行数值取整。", "solution": "所述问题是有效的。这是一个结构良好、有科学依据的练习，旨在将标度原理应用于量子力学中的库仑问题，这是一个基础课题。所有提供的信息都是自洽的，足以推导出唯一解。\n\n我们将按要求分两部分进行。首先，我们推导能量和波函数的标度律。其次，我们应用这些定律计算基态的期望值 $\\langle r^{k}\\rangle_{Z}$。\n\n第1部分：推导标度关系\n\n在原子单位中，核电荷为 $Z$ 的单电子原子的定态薛定谔方程如下所示：\n$$\n\\left[-\\frac{1}{2}\\nabla_{r}^{2}-\\frac{Z}{r}\\right]\\psi_{Z}(\\mathbf{r})=E_{Z}\\,\\psi_{Z}(\\mathbf{r})\n$$\n我们引入标度化坐标 $\\boldsymbol{\\rho} = Z\\mathbf{r}$。这意味着 $\\mathbf{r} = \\frac{1}{Z}\\boldsymbol{\\rho}$，因此 $r = |\\mathbf{r}| = \\frac{1}{Z}|\\boldsymbol{\\rho}| = \\frac{\\rho}{Z}$。梯度算符根据链式法则进行变换。对于任意分量 $i \\in \\{x, y, z\\}$，我们有 $\\frac{\\partial}{\\partial r_i} = \\frac{\\partial \\rho_i}{\\partial r_i}\\frac{\\partial}{\\partial \\rho_i} = Z \\frac{\\partial}{\\partial \\rho_i}$。因此，梯度向量变换为 $\\nabla_{r} = Z\\nabla_{\\rho}$，拉普拉斯算符变换为 $\\nabla_{r}^{2} = \\nabla_{r} \\cdot \\nabla_{r} = (Z\\nabla_{\\rho}) \\cdot (Z\\nabla_{\\rho}) = Z^{2}\\nabla_{\\rho}^{2}$。\n\n将这些变换代入薛定谔方程：\n$$\n\\left[-\\frac{1}{2}(Z^{2}\\nabla_{\\rho}^{2})-\\frac{Z}{(\\rho/Z)}\\right]\\psi_{Z}\\left(\\frac{\\boldsymbol{\\rho}}{Z}\\right)=E_{Z}\\,\\psi_{Z}\\left(\\frac{\\boldsymbol{\\rho}}{Z}\\right)\n$$\n化简势能项得到：\n$$\n\\left[-\\frac{Z^{2}}{2}\\nabla_{\\rho}^{2}-\\frac{Z^{2}}{\\rho}\\right]\\psi_{Z}\\left(\\frac{\\boldsymbol{\\rho}}{Z}\\right)=E_{Z}\\,\\psi_{Z}\\left(\\frac{\\boldsymbol{\\rho}}{Z}\\right)\n$$\n我们可以从左侧的哈密顿算符中提出因子 $Z^2$：\n$$\nZ^{2}\\left[-\\frac{1}{2}\\nabla_{\\rho}^{2}-\\frac{1}{\\rho}\\right]\\psi_{Z}\\left(\\frac{\\boldsymbol{\\rho}}{Z}\\right)=E_{Z}\\,\\psi_{Z}\\left(\\frac{\\boldsymbol{\\rho}}{Z}\\right)\n$$\n将整个方程除以 $Z^{2}$，我们得到：\n$$\n\\left[-\\frac{1}{2}\\nabla_{\\rho}^{2}-\\frac{1}{\\rho}\\right]\\psi_{Z}\\left(\\frac{\\boldsymbol{\\rho}}{Z}\\right)=\\frac{E_{Z}}{Z^{2}}\\,\\psi_{Z}\\left(\\frac{\\boldsymbol{\\rho}}{Z}\\right)\n$$\n该方程在坐标系 $\\boldsymbol{\\rho}$ 下的形式与氢原子（$Z=1$）的薛定谔方程完全相同。氢原子的方程为：\n$$\n\\left[-\\frac{1}{2}\\nabla_{\\rho}^{2}-\\frac{1}{\\rho}\\right]\\psi_{1}(\\boldsymbol{\\rho}) = E_{1}\\,\\psi_{1}(\\boldsymbol{\\rho})\n$$\n通过比较这两个方程，我们推导出两个标度关系。首先，对于能量本征值：\n$$\n\\frac{E_{Z}}{Z^{2}} = E_{1} \\implies E_{Z} = Z^{2}E_{1}\n$$\n能量与核电荷的平方成标度关系。其次，本征函数之间必定存在函数关系。函数 $\\psi_{Z}(\\boldsymbol{\\rho}/Z)$ 必须是 $Z=1$ 哈密顿算符的一个本征函数。因此，它必须与 $\\psi_{1}(\\boldsymbol{\\rho})$ 成正比。我们将此关系写作 $\\psi_{Z}(\\mathbf{r}) = N \\psi_{1}(Z\\mathbf{r})$，其中 $N$ 是一个归一化常数。\n\n为了求出 $N$，我们强制执行归一化条件 $\\int |\\psi_{Z}(\\mathbf{r})|^{2}\\,d^{3}\\mathbf{r} = 1$。\n$$\n\\int |N \\psi_{1}(Z\\mathbf{r})|^{2}\\,d^{3}\\mathbf{r} = 1 \\implies |N|^{2} \\int |\\psi_{1}(Z\\mathbf{r})|^{2}\\,d^{3}\\mathbf{r} = 1\n$$\n我们在积分中进行变量替换，从 $\\mathbf{r}$ 换到 $\\boldsymbol{\\rho} = Z\\mathbf{r}$。体积元变换为 $d^{3}\\boldsymbol{\\rho} = Z^{3}d^{3}\\mathbf{r}$，所以 $d^{3}\\mathbf{r} = Z^{-3}d^{3}\\boldsymbol{\\rho}$。\n$$\n|N|^{2} \\int |\\psi_{1}(\\boldsymbol{\\rho})|^{2}\\,(Z^{-3}d^{3}\\boldsymbol{\\rho}) = 1\n$$\n$$\n|N|^{2}Z^{-3} \\int |\\psi_{1}(\\boldsymbol{\\rho})|^{2}\\,d^{3}\\boldsymbol{\\rho} = 1\n$$\n由于 $\\psi_{1}$ 是一个归一化的波函数，其归一化积分为 $1$。\n$$\n|N|^{2}Z^{-3} = 1 \\implies |N|^{2} = Z^{3}\n$$\n为该常数选择常规的实数正值，我们得到 $N = Z^{3/2}$。因此，归一化波函数的标度关系为：\n$$\n\\psi_{Z}(\\mathbf{r}) = Z^{3/2}\\psi_{1}(Z\\mathbf{r})\n$$\n\n第2部分：计算矩 $\\langle r^{k}\\rangle_{Z}$\n\n我们需要计算球对称基态的径向矩 $\\langle r^{k}\\rangle_{Z} = \\int_{\\mathbb{R}^{3}} r^{k}\\,|\\psi_{Z}(\\mathbf{r})|^{2}\\,d^{3}\\mathbf{r}$。我们使用上面推导出的波函数标度关系。\n$$\n|\\psi_{Z}(\\mathbf{r})|^{2} = |Z^{3/2}\\psi_{1}(Z\\mathbf{r})|^{2} = Z^{3}|\\psi_{1}(Z\\mathbf{r})|^{2}\n$$\n问题指出 $Z=1$ 的基态波函数是 $\\psi_{1}(\\mathbf{r}) = (1/\\sqrt{\\pi})\\exp(-r)$。这是一个球对称函数，仅依赖于模 $r=|\\mathbf{r}|$。因此，$|\\psi_{1}(Z\\mathbf{r})|^{2} = |\\psi_{1}(|Z\\mathbf{r}|)|^{2} = |\\psi_{1}(Zr)|^{2}$。\n$$\n|\\psi_{1}(Zr)|^{2} = \\left(\\frac{1}{\\sqrt{\\pi}}\\exp(-Zr)\\right)^{2} = \\frac{1}{\\pi}\\exp(-2Zr)\n$$\n将这些表达式代入矩的积分中：\n$$\n\\langle r^{k}\\rangle_{Z} = \\int_{\\mathbb{R}^{3}} r^{k} \\left(Z^{3} \\frac{1}{\\pi}\\exp(-2Zr)\\right) d^{3}\\mathbf{r}\n$$\n我们变换到球坐标系，其中 $d^{3}\\mathbf{r} = r^{2}\\sin\\theta\\,dr\\,d\\theta\\,d\\phi$。由于被积函数是球对称的，角度积分产生一个因子 $4\\pi$。\n$$\n\\langle r^{k}\\rangle_{Z} = \\frac{Z^{3}}{\\pi} \\int_{0}^{\\infty} r^{k}\\exp(-2Zr)\\,(4\\pi r^{2}\\,dr) = 4Z^{3} \\int_{0}^{\\infty} r^{k+2}\\exp(-2Zr)\\,dr\n$$\n这个积分是标准形式 $\\int_{0}^{\\infty} x^{\\alpha-1}\\exp(-\\beta x)\\,dx=\\Gamma(\\alpha)\\,\\beta^{-\\alpha}$。我们通过将我们的积分与此形式比较来确定参数。令 $x=r$。$r$ 的指数是 $k+2$，它必须等于 $\\alpha-1$。因此，$\\alpha = k+3$。指数中的系数是 $2Z$，它必须等于 $\\beta$。对于实数 $k$，当 $\\alpha > 0$ 时积分收敛，这意味着 $k+3 > 0$，即 $k > -3$。积分的值是 $\\Gamma(k+3)(2Z)^{-(k+3)}$。\n\n将此结果代回到我们关于 $\\langle r^{k}\\rangle_{Z}$ 的表达式中：\n$$\n\\langle r^{k}\\rangle_{Z} = 4Z^{3} \\left[ \\Gamma(k+3)(2Z)^{-(k+3)} \\right]\n$$\n我们化简前面的系数：\n$$\n\\langle r^{k}\\rangle_{Z} = 4Z^{3} \\Gamma(k+3) 2^{-(k+3)} Z^{-(k+3)}\n$$\n$$\n\\langle r^{k}\\rangle_{Z} = (2^{2}) (2^{-k-3}) (Z^{3}) (Z^{-k-3}) \\Gamma(k+3)\n$$\n$$\n\\langle r^{k}\\rangle_{Z} = 2^{2-k-3} Z^{3-k-3} \\Gamma(k+3)\n$$\n$$\n\\langle r^{k}\\rangle_{Z} = 2^{-k-1} Z^{-k} \\Gamma(k+3)\n$$\n这可以写成一个更有条理的形式：\n$$\n\\langle r^{k}\\rangle_{Z} = \\frac{\\Gamma(k+3)}{2^{k+1}Z^{k}}\n$$\n这是核电荷为 $Z$ 的类氢原子基态的矩 $\\langle r^{k}\\rangle_{Z}$ 的最终闭合形式表达式，对实数 $k > -3$ 有效。", "answer": "$$\n\\boxed{\\frac{\\Gamma(k+3)}{2^{k+1}Z^{k}}}\n$$", "id": "2874935"}, {"introduction": "检验是否真正理解一个概念的有效方法，是将其应用于新的情境中。这个问题挑战你从第一性原理出发，在一个假想的二维宇宙中构建一套原子单位体系 [@problem_id:2450254]。通过完成这个思想实验，你将实践无量纲化的核心逻辑，并理解基本物理常数如何决定一个物理系统的特征尺度，无论该系统的维度为何。", "problem": "考虑一个假设的二维（$2$D）宇宙，其中电子被严格限制在一个平面内，而电磁作用遵循限制在该平面上的常规三维库仑定律。位于该平面内、电荷为 $+e$ 的点状原子核，对于一个平面距离为 $r$ 的电子，产生一个势能 $V(r)=-\\dfrac{e^{2}}{4\\pi \\varepsilon_{0}\\,r}$。对于一个约化质量为 $\\mu$ 的非相对论性单电子、单原子核系统，你希望构建一个二维原子单位制，使得单电子哈密顿量不包含任何显式的有量纲常数。\n\n通过指明在这个宇宙中哪些基本常数被设为 $1$ 来定义这个二维原子单位制。然后，从非相对论性量子力学中粒子在中心势场中的第一性原理出发，确定二维玻尔半径 $a_{\\mathrm{2D}}$ 的精确解析表达式，其定义为在这些原子单位下，通过相应的坐标缩放使哈密顿量无量纲化的特征长度尺度。\n\n以用 $\\hbar$、$\\mu$、$e$、$\\varepsilon_{0}$ 和 $\\pi$ 表示的关于 $a_{\\mathrm{2D}}$ 的单个封闭形式表达式给出你的最终答案。不要代入数值。最终答案中不要包含任何单位。如果你在任何步骤中选择近似，你的最终答案仍必须是一个精确的符号表达式。", "solution": "首先对问题陈述进行严格验证。\n\n**第1步：提取已知条件**\n- 系统存在于一个二维（$2$D）宇宙中。\n- 电子被限制在一个平面内。\n- 电磁作用遵循限制在该平面上的三维库仑定律。\n- 对于距离电荷为 $+e$ 的点状原子核为 $r$ 的电子，其势能为 $V(r)=-\\dfrac{e^{2}}{4\\pi \\varepsilon_{0}\\,r}$。\n- 该系统是一个约化质量为 $\\mu$ 的非相对论性单电子、单原子核系统。\n- 任务是构建一个二维原子单位制，其中哈密顿量不包含任何显式的有量纲常数。\n- 必须通过指明哪些基本常数被设为 $1$ 来定义该系统。\n- 必须确定二维玻尔半径 $a_{\\mathrm{2D}}$ 的精确解析表达式。它被定义为使哈密顿量无量纲化的特征长度尺度。\n- $a_{\\mathrm{2D}}$ 的表达式必须用 $\\hbar$、$\\mu$、$e$、$\\varepsilon_{0}$ 和 $\\pi$ 表示。\n\n**第2步：使用提取的已知条件进行验证**\n- **科学上合理：** 该问题描述了一个假设的物理系统，但使用既定的非相对论性量子力学原理和指定的势能定律对其进行分析。这类“玩具模型”是理论物理学中用于理解基本概念的标准工具。在其自身定义的背景下，该问题没有伪科学或事实错误。\n- **适定性：** 该问题陈述清晰。它提供了构建哈密顿量所需的所有必要信息（动能和势能的形式）。对物理方程进行无量纲化以寻找特征尺度是一个标准且明确定义的数学过程，能够得出一个唯一的解。\n- **客观性：** 语言精确、量化，没有任何主观或模棱两可的术语。\n\n该问题被认定为有效。这是一个自洽、一致且适定的理论物理问题，可以通过直接应用量子力学原理和量纲分析来解决。\n\n**第3步：结论与行动**\n问题有效。继续求解。\n\n目标是通过对系统的哈密顿量进行无量纲化来推导出特征长度尺度，即二维玻尔半径 $a_{\\mathrm{2D}}$。该系统的定态薛定谔方程为 $\\hat{H}\\psi = E\\psi$。\n\n哈密顿算符 $\\hat{H}$ 是动能算符 $\\hat{T}$ 和势能算符 $\\hat{V}$ 的和。在二维平面中，使用笛卡尔坐标 $(x, y)$，一个约化质量为 $\\mu$ 的粒子的动能算符是：\n$$\n\\hat{T} = -\\frac{\\hbar^{2}}{2\\mu}\\nabla^{2}_{2D} = -\\frac{\\hbar^{2}}{2\\mu}\\left(\\frac{\\partial^{2}}{\\partial x^{2}} + \\frac{\\partial^{2}}{\\partial y^{2}}\\right)\n$$\n势能由下式给出：\n$$\n\\hat{V}(r) = -\\frac{e^{2}}{4\\pi \\varepsilon_{0} r}\n$$\n其中 $r = \\sqrt{x^{2} + y^{2}}$。\n\n完整的哈密顿量是：\n$$\n\\hat{H} = -\\frac{\\hbar^{2}}{2\\mu}\\nabla^{2}_{2D} - \\frac{e^{2}}{4\\pi \\varepsilon_{0} r}\n$$\n为了构建原子单位制，我们寻求将该哈密顿量重写为无量纲形式，其中算符的系数是数量级为1的纯数。这通过引入一个特征长度尺度来实现，问题将其定义为二维玻尔半径 $a_{\\mathrm{2D}}$。我们定义无量纲坐标 $\\vec{r}' = (x', y')$，使得 $\\vec{r} = a_{\\mathrm{2D}}\\vec{r}'$。因此，$x=a_{\\mathrm{2D}}x'$，$y=a_{\\mathrm{2D}}y'$，且径向距离为 $r = a_{\\mathrm{2D}}r'$。\n\n导数也必须进行变换：\n$$\n\\frac{\\partial}{\\partial x} = \\frac{\\partial x'}{\\partial x}\\frac{\\partial}{\\partial x'} = \\frac{1}{a_{\\mathrm{2D}}}\\frac{\\partial}{\\partial x'}\n$$\n因此，拉普拉斯算符变换为：\n$$\n\\nabla^{2}_{2D} = \\frac{1}{a_{\\mathrm{2D}}^{2}}\\nabla'^{2}_{2D}\n$$\n其中 $\\nabla'^{2}_{2D} = \\frac{\\partial^{2}}{\\partial x'^{2}} + \\frac{\\partial^{2}}{\\partial y'^{2}}$。\n\n将这些缩放后的变量代入哈密顿量，得到：\n$$\n\\hat{H} = -\\frac{\\hbar^{2}}{2\\mu a_{\\mathrm{2D}}^{2}}\\nabla'^{2}_{2D} - \\frac{e^{2}}{4\\pi \\varepsilon_{0} a_{\\mathrm{2D}} r'}\n$$\n该表达式仍然具有能量的量纲。我们引入一个特征能量尺度，即二维哈特里能量 $E_{\\mathrm{h,2D}}$，并定义一个无量纲哈密顿量 $\\hat{H}' = \\hat{H} / E_{\\mathrm{h,2D}}$。\n$$\n\\hat{H}' = \\frac{1}{E_{\\mathrm{h,2D}}}\\left(-\\frac{\\hbar^{2}}{2\\mu a_{\\mathrm{2D}}^{2}}\\nabla'^{2}_{2D} - \\frac{e^{2}}{4\\pi \\varepsilon_{0} a_{\\mathrm{2D}} r'}\\right) = \\left(-\\frac{\\hbar^{2}}{2\\mu a_{\\mathrm{2D}}^{2} E_{\\mathrm{h,2D}}}\\right)\\nabla'^{2}_{2D} - \\left(\\frac{e^{2}}{4\\pi \\varepsilon_{0} a_{\\mathrm{2D}} E_{\\mathrm{h,2D}}}\\right)\\frac{1}{r'}\n$$\n原子单位制是通过将无量纲哈密顿量中的系数设置为简单的数值来定义的。能够产生最简形式的标准惯例是，令无量纲哈密顿量为：\n$$\n\\hat{H}' = -\\frac{1}{2}\\nabla'^{2}_{2D} - \\frac{1}{r'}\n$$\n为使此式成立，系数必须满足以下条件：\n1. 动能项的系数：$\\dfrac{\\hbar^{2}}{2\\mu a_{\\mathrm{2D}}^{2} E_{\\mathrm{h,2D}}} = \\dfrac{1}{2} \\implies \\dfrac{\\hbar^{2}}{\\mu a_{\\mathrm{2D}}^{2} E_{\\mathrm{h,2D}}} = 1$\n2. 势能项的系数：$\\dfrac{e^{2}}{4\\pi \\varepsilon_{0} a_{\\mathrm{2D}} E_{\\mathrm{h,2D}}} = 1$\n\n这给出了一个包含两个未知数 $a_{\\mathrm{2D}}$ 和 $E_{\\mathrm{h,2D}}$ 的方程组。问题要求给出 $a_{\\mathrm{2D}}$ 的表达式。\n\n从第二个方程，我们解出能量单位 $E_{\\mathrm{h,2D}}$：\n$$\nE_{\\mathrm{h,2D}} = \\frac{e^{2}}{4\\pi \\varepsilon_{0} a_{\\mathrm{2D}}}\n$$\n现在，将 $E_{\\mathrm{h,2D}}$ 的这个表达式代入第一个方程：\n$$\n\\frac{\\hbar^{2}}{\\mu a_{\\mathrm{2D}}^{2} \\left(\\frac{e^{2}}{4\\pi \\varepsilon_{0} a_{\\mathrm{2D}}}\\right)} = 1\n$$\n简化左边的表达式：\n$$\n\\frac{\\hbar^{2} (4\\pi \\varepsilon_{0} a_{\\mathrm{2D}})}{\\mu a_{\\mathrm{2D}}^{2} e^{2}} = \\frac{4\\pi \\varepsilon_{0} \\hbar^{2}}{\\mu e^{2} a_{\\mathrm{2D}}} = 1\n$$\n最后，我们解出 $a_{\\mathrm{2D}}$：\n$$\na_{\\mathrm{2D}} = \\frac{4\\pi \\varepsilon_{0} \\hbar^{2}}{\\mu e^{2}}\n$$\n这个表达式就是二维玻尔半径。它在形式上与标准的三维玻尔半径相同，只是电子质量被约化质量 $\\mu$ 替代了。这是势能与三维情况一样具有相同的 $1/r$ 依赖关系的直接结果。\n\n问题还要求定义原子单位制。根据无量纲化的过程，二维原子单位制是一个将以下基本常数设为1的系统：\n- 约化质量：$\\mu = 1$\n- 基本电荷：$e = 1$\n- 约化普朗克常数：$\\hbar = 1$\n- 库仑常数因子：$4\\pi\\varepsilon_{0} = 1$\n\n在这个系统中，长度单位是 $a_{\\mathrm{2D}}$，其值为 $1$。推导出的表达式给出了它用基本常数表示的值。", "answer": "$$\n\\boxed{\\frac{4 \\pi \\varepsilon_{0} \\hbar^{2}}{\\mu e^{2}}}\n$$", "id": "2450254"}, {"introduction": "原子单位的主要优点之一在于它极大地简化了用于计算建模的方程，从而在理论与实践之间架起了一座桥梁。本练习将带领你实现分裂算符法 (split-operator method)，这是一种广泛用于求解含时薛定谔方程的数值算法 [@problem_id:2857777]。你将亲身体会到，在原子单位制下形式简洁的哈密顿量如何直接转化为一个优雅且高效的数值模拟方案，并学习如何通过误差分析来验证算法的精度。", "problem": "实现一个程序，使用基于二阶特罗特（斯特朗）分解的分裂算符法求解一维含时薛定谔方程，并数值分析全局误差随时间步长的标度关系。从基本定律 $i\\hbar \\frac{\\partial}{\\partial t}\\psi(x,t)=H\\psi(x,t)$ 开始，其中哈密顿量分裂为 $H=H_T+H_V$，$H_T$ 是动能算符，$H_V$ 是势能算符。使用哈特里原子单位制，其中 $\\hbar=1$ 且电子质量 $m=1$；因此，在该单位制中所有量均为无量纲量。定义 $H_T = -\\frac{1}{2}\\frac{\\partial^2}{\\partial x^2}$ 和 $H_V=V(x)$，这样 $H_T$ 在动量空间中是对角化的，而 $H_V$ 在位置空间中是对角化的。二阶特罗特分解将一个时间步的演化近似为\n$$\ne^{-i(H_T+H_V)\\Delta t}\\approx e^{-iH_V\\Delta t/2}\\,e^{-iH_T\\Delta t}\\,e^{-iH_V\\Delta t/2},\n$$\n该近似是幺正的，其局域误差为 $\\mathcal{O}(\\Delta t^3)$ 阶。\n\n您必须使用快速傅里叶变换（FFT）来实现此近似，以便在动量空间中应用 $e^{-iH_T\\Delta t}$，在位置空间中应用 $e^{-iH_V\\Delta t/2}$。对于收敛性研究，限定于谐振子势 $V(x)=\\frac{1}{2}\\omega^2 x^2$，并选择谐振子的精确归一化基态作为初始态，\n$$\n\\psi_0(x)=\\left(\\frac{\\omega}{\\pi}\\right)^{1/4}\\exp\\!\\left(-\\frac{\\omega x^2}{2}\\right).\n$$\n在原子单位制中，基态能量为 $E_0=\\frac{\\omega}{2}$，因此在时间 $t$ 的精确波函数为 $\\psi_{\\text{exact}}(x,t)=\\psi_0(x)\\,e^{-iE_0 t}$。\n\n使用 FFT 所隐含的周期性边界条件，在长度为 $L$ 的区域上，将空间离散化为 $N$ 个点的均匀网格。设网格间距为 $\\Delta x=L/N$，坐标选择为 $x_j=-L/2 + j\\,\\Delta x$，其中 $j\\in\\{0,1,\\dots,N-1\\}$。为每个时间步长 $\\Delta t$ 实现以下步骤：\n- 在位置空间中应用势能半步：$\\psi(x)\\leftarrow e^{-iV(x)\\Delta t/2}\\psi(x)$。\n- 在动量空间中应用动能全步：$\\tilde{\\psi}(k)=\\mathcal{F}[\\psi(x)]$，然后 $\\tilde{\\psi}(k)\\leftarrow e^{-ik^2\\Delta t/2}\\tilde{\\psi}(k)$，接着 $\\psi(x)=\\mathcal{F}^{-1}[\\tilde{\\psi}(k)]$，其中 $k$ 是由 FFT 频率约定定义的角波数，而 $k^2$ 源于原子单位制中的 $H_T$。\n- 在位置空间中再次应用势能半步。\n\n对于每个指定的 $\\Delta t$，使用 $n=T/\\Delta t$ 个步长（假设 $n$ 为整数）将初始态演化总时间 $T$，并计算在时间 $T$ 的离散 $L^2$ 误差：\n$$\nE(\\Delta t)=\\left(\\sum_{j=0}^{N-1}\\left|\\psi_{\\text{num}}(x_j,T)-\\psi_{\\text{exact}}(x_j,T)\\right|^2\\,\\Delta x\\right)^{1/2}.\n$$\n对初始态进行数值归一化，使得 $\\sum_j|\\psi_0(x_j)|^2\\,\\Delta x=1$。在所有计算中，使用双精度复数运算。\n\n通过对给定的一组 $\\Delta t$ 值，对 $\\log E(\\Delta t)$ 与 $\\log \\Delta t$ 的关系进行线性拟合来分析全局误差的标度关系，并报告斜率 $s$。该斜率应反映二阶精度，即 $E(\\Delta t)\\propto \\Delta t^2$ 意味着 $s\\approx 2$。为了进行额外的定量检验，还需计算连续误差比 $E(\\Delta t)/E(\\Delta t/2)$。\n\n使用以下三个测试用例。对于每个用例，所有参数必须完全按照给定值实现。所有量均采用原子单位制。\n\n- 测试用例 1 (一般情况):\n  - 角频率为 $\\omega=1.0$ 的谐振子。\n  - 空间区域长度 $L=20.0$，网格点数 $N=4096$。\n  - 总演化时间 $T=1.0$。\n  - 时间步长 $\\Delta t\\in\\{0.2,\\,0.1,\\,0.05,\\,0.025\\}$。\n  - 此用例需报告的输出：\n    - 对 $\\log E(\\Delta t)$ 与 $\\log \\Delta t$ 进行线性回归得到的拟合斜率 $s_1$。\n    - 三个连续误差比 $r_{1a}=E(0.2)/E(0.1)$、$r_{1b}=E(0.1)/E(0.05)$ 和 $r_{1c}=E(0.05)/E(0.025)$。\n\n- 测试用例 2 (更强束缚):\n  - 角频率为 $\\omega=2.0$ 的谐振子。\n  - 空间区域长度 $L=20.0$，网格点数 $N=4096$。\n  - 总演化时间 $T=1.0$。\n  - 时间步长 $\\Delta t\\in\\{0.2,\\,0.1,\\,0.05,\\,0.025\\}$。\n  - 需报告的输出：拟合斜率 $s_2$。\n\n- 测试用例 3 (更长时间):\n  - 角频率为 $\\omega=1.0$ 的谐振子。\n  - 空间区域长度 $L=20.0$，网格点数 $N=4096$。\n  - 总演化时间 $T=2.0$。\n  - 时间步长 $\\Delta t\\in\\{0.2,\\,0.1,\\,0.05,\\,0.025\\}$。\n  - 需报告的输出：拟合斜率 $s_3$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果的顺序和四舍五入规则如下：\n- $[s_1,\\,r_{1a},\\,r_{1b},\\,r_{1c},\\,s_2,\\,s_3]$,\n- 其中每个数字都四舍五入到小数点后恰好 $6$ 位。\n\n所有数学量在原子单位制中都是无量纲的。不报告任何角度，所有最终输出都是不带单位的纯数。确保空间离san化足够精确，以使观察到的标度关系主要由指定参数下的时间离散化误差决定。您的实现必须是自包含的，并且不得需要任何外部输入文件。", "solution": "所提出的问题是计算量子力学中的一个标准练习，被认为是有效的。它具有科学依据，问题定义良好，客观，并包含了获得唯一解所需的所有信息。我们将着手阐述解决方案。\n\n基本任务是求解势场 $V(x)$ 中粒子的一维含时薛定谔方程 (TDSE)。在哈特里原子单位制中，约化普朗克常数 $\\hbar$ 和电子质量 $m$ 均为 1，TDSE 由下式给出：\n$$\ni \\frac{\\partial}{\\partial t}\\psi(x,t) = \\hat{H}\\psi(x,t)\n$$\n哈密顿算符 $\\hat{H}$ 是动能算符 $\\hat{H}_T$ 和势能算符 $\\hat{H}_V$ 的和：\n$$\n\\hat{H} = \\hat{H}_T + \\hat{H}_V = -\\frac{1}{2}\\frac{\\partial^2}{\\partial x^2} + V(x)\n$$\n波函数 $\\psi(x,t)$ 从时间 $t$ 到 $t+\\Delta t$ 演化的形式解通过时间演化算符 $\\hat{U}(\\Delta t) = e^{-i\\hat{H}\\Delta t}$ 表示：\n$$\n\\psi(x, t+\\Delta t) = e^{-i\\hat{H}\\Delta t} \\psi(x,t)\n$$\n直接数值应用此指数算符是困难的，因为动能算符 $\\hat{H}_T$ 和势能算符 $\\hat{H}_V$ 不对易，即 $[\\hat{H}_T, \\hat{H}_V] \\neq 0$。这种非对易性阻止了简单的分解 $e^{-i(\\hat{H}_T + \\hat{H}_V)\\Delta t} = e^{-i\\hat{H}_T\\Delta t} e^{-i\\hat{H}_V\\Delta t}$。\n\n为规避此问题，我们采用分裂算符法，该方法基于特罗特-铃木乘积公式。所要求的具体变体是二阶对称斯特朗分裂，它将小时间步长 $\\Delta t$ 的演化算符近似为：\n$$\n\\hat{U}(\\Delta t) = e^{-i(\\hat{H}_T + \\hat{H}_V)\\Delta t} \\approx e^{-i\\hat{H}_V\\Delta t/2} \\, e^{-i\\hat{H}_T\\Delta t} \\, e^{-i\\hat{H}_V\\Delta t/2}\n$$\n此近似是幺正的，保持波函数的范数不变，并且局域误差为 $\\mathcal{O}(\\Delta t^3)$ 阶。将系统演化总时间 $T$ 需要 $n = T/\\Delta t$ 步，导致的全局误差为 $\\mathcal{O}(\\Delta t^2)$ 阶。这就是我们必须验证的标度行为。\n\n该方法的威力在于其实现方式。算符 $\\hat{H}_V$ 在位置表象中是对角的（其作用是简单地乘以函数 $V(x)$），而算符 $\\hat{H}_T$ 在动量表象中是对角的。快速傅里叶变换 (FFT) 提供了一种在位置表象和动量表象之间高效转换波函数的数值方法。\n\n假设波函数表示在由 $N$ 个点 $\\{x_j\\}$ 组成的离散空间网格上，格点间距为 $\\Delta x = L/N$。相应的动量（波数）网格 $\\{k_j\\}$ 由离散傅里叶变换的性质决定。将波函数 $\\psi(x)$ 演化一个时间步长 $\\Delta t$ 的算法如下：\n\n1.  **第一个势能半步**：波函数处于位置表象。我们应用前半部分势能传播算符，这是一个简单的乘法操作：\n    $$\n    \\psi(x_j, t + \\Delta t/2) = e^{-iV(x_j)\\Delta t/2} \\psi(x_j, t)\n    $$\n    对于指定的谐振子势，$V(x) = \\frac{1}{2}\\omega^2 x^2$。\n\n2.  **动能全步**：为了应用动能传播算符，我们使用 FFT 将波函数变换到动量表象：\n    $$\n    \\tilde{\\psi}(k_j, t + \\Delta t/2) = \\mathcal{F}[\\psi(x_j, t + \\Delta t/2)]\n    $$\n    在动量空间中，算符 $\\hat{H}_T = \\hat{p}^2/2$ 变为乘以函数 $k^2/2$（因为在我们的单位制中 $p=k$）。因此动能演化为：\n    $$\n    \\tilde{\\psi}(k_j, t + \\Delta t/2)_{\\text{after}} = e^{-ik_j^2\\Delta t/2} \\tilde{\\psi}(k_j, t + \\Delta t/2)\n    $$\n    然后使用逆 FFT (iFFT) 将波函数变换回位置表象：\n    $$\n    \\psi'(x_j, t + \\Delta t/2) = \\mathcal{F}^{-1}[\\tilde{\\psi}(k_j, t + \\Delta t/2)_{\\text{after}}]\n    $$\n\n3.  **第二个势能半步**：最后一步是在位置表象中应用后半部分势能传播算符：\n    $$\n    \\psi(x_j, t + \\Delta t) = e^{-iV(x_j)\\Delta t/2} \\psi'(x_j, t + \\Delta t/2)\n    $$\n\n这个三步序列将状态从 $t$推进到 $t + \\Delta t$。重复 $n = T/\\Delta t$ 次以达到最终时间 $T$。\n\n对于收敛性分析，我们使用量子谐振子的精确基态作为初始态，$\\psi(x,0) = \\psi_0(x)$。这是哈密顿量的本征态，能量为 $E_0 = \\omega/2$。因此，精确的时间演化态是解析已知的：\n$$\n\\psi_{\\text{exact}}(x,t) = \\psi_0(x) \\, e^{-iE_0 t}\n$$\n在最终时间 $T$ 获得数值解 $\\psi_{\\text{num}}(x_j, T)$ 后，我们计算离散 $L^2$ 误差：\n$$\nE(\\Delta t) = \\left(\\sum_{j=0}^{N-1} |\\psi_{\\text{num}}(x_j, T) - \\psi_{\\text{exact}}(x_j, T)|^2 \\Delta x\\right)^{1/2}\n$$\n收敛阶数通过分析关系式 $E(\\Delta t) \\propto (\\Delta t)^s$ 来确定。在对数尺度下，这变成 $\\log E = s \\log \\Delta t + C$，这是一个线性关系。我们对 $(\\log \\Delta t, \\log E)$ 数据点进行线性回归以找到斜率 $s$，其值应约等于 $2$。此外，对于一个 $s$ 阶方法，连续步长的误差比 $E(\\Delta t) / E(\\Delta t/2)$ 应趋近于 $2^s$。当 $s=2$ 时，该比值为 $4$。\n\n因此，计算流程如下：对于每个测试用例，我们设置空间网格，定义并归一化初始波函数，并预先计算在时间 $T$ 的精确解。然后，我们遍历指定的时间步长列表 $\\Delta t$。对于每个 $\\Delta t$，我们运行分裂算符模拟并计算最终误差 $E(\\Delta t)$。最后，我们使用收集到的误差数据来计算所需的斜率和误差比。整个过程封装在提供的 Python 代码中。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import linregress\n\ndef run_simulation(omega, L, N, T, delta_t_list):\n    \"\"\"\n    Runs a simulation for a given set of parameters and returns the error analysis.\n\n    Args:\n        omega (float): Angular frequency of the harmonic oscillator.\n        L (float): Length of the spatial domain.\n        N (int): Number of grid points.\n        T (float): Total propagation time.\n        delta_t_list (list of float): List of time steps for the convergence study.\n\n    Returns:\n        tuple: A tuple containing the fitted slope (float) and a list of error ratios (list of float).\n    \"\"\"\n\n    # 1. Setup spatial and momentum grids\n    dx = L / N\n    x = -L / 2 + np.arange(N) * dx\n    k = 2 * np.pi * np.fft.fftfreq(N, d=dx)\n\n    # 2. Define initial and exact final wavefunctions\n    # The initial state is the analytic ground state of the harmonic oscillator.\n    # We ensure it is a complex array for subsequent calculations.\n    psi0_analytic = ((omega / np.pi)**0.25 * np.exp(-omega * x**2 / 2)).astype(np.complex128)\n\n    # Numerically normalize the initial state on the discrete grid.\n    norm_factor = np.sqrt(np.sum(np.abs(psi0_analytic)**2) * dx)\n    psi0 = psi0_analytic / norm_factor\n\n    # The exact state at time T is the initial state multiplied by a phase factor.\n    # We use the numerically normalized psi0 for consistency.\n    E0 = omega / 2\n    psi_exact_T = psi0 * np.exp(-1j * E0 * T)\n\n    errors = []\n    \n    # Define the potential energy operator V(x)\n    V = 0.5 * omega**2 * x**2\n\n    # 3. Time evolution loop for each delta_t\n    for dt in delta_t_list:\n        n_steps = int(round(T / dt))\n        psi_current = psi0.copy()\n        \n        # Pre-compute time-evolution operators for this dt\n        exp_V_half = np.exp(-1j * V * dt / 2)\n        exp_T_full = np.exp(-1j * k**2 * dt / 2)\n        \n        for _ in range(n_steps):\n            # Apply first potential half-step in position space\n            psi_current *= exp_V_half\n            \n            # Apply kinetic full-step in momentum space\n            psi_k = np.fft.fft(psi_current)\n            psi_k *= exp_T_full\n            psi_current = np.fft.ifft(psi_k)\n            \n            # Apply second potential half-step in position space\n            psi_current *= exp_V_half\n            \n        # 4. Compute L2 error\n        error = np.sqrt(np.sum(np.abs(psi_current - psi_exact_T)**2) * dx)\n        errors.append(error)\n\n    # 5. Analyze error scaling\n    log_dt = np.log(delta_t_list)\n    log_E = np.log(errors)\n    \n    # Fit a line to log(E) vs log(dt) to find the slope\n    slope, _, _, _, _ = linregress(log_dt, log_E)\n    \n    # Compute successive error ratios\n    ratios = [errors[i] / errors[i+1] for i in range(len(errors) - 1)]\n    \n    return slope, ratios\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the final results.\n    \"\"\"\n    \n    # Common Parameters\n    L = 20.0\n    N = 4096\n    delta_t_list = [0.2, 0.1, 0.05, 0.025]\n\n    # Test Case 1: General case\n    omega1 = 1.0\n    T1 = 1.0\n    s1, ratios1 = run_simulation(omega1, L, N, T1, delta_t_list)\n    r1a, r1b, r1c = ratios1[0], ratios1[1], ratios1[2]\n    \n    # Test Case 2: Stronger confinement\n    omega2 = 2.0\n    T2 = 1.0\n    s2, _ = run_simulation(omega2, L, N, T2, delta_t_list)\n\n    # Test Case 3: Longer time\n    omega3 = 1.0\n    T3 = 2.0\n    s3, _ = run_simulation(omega3, L, N, T3, delta_t_list)\n    \n    # Consolidate and format results\n    results = [s1, r1a, r1b, r1c, s2, s3]\n    formatted_results = [f\"{num:.6f}\" for num in results]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2857777"}]}