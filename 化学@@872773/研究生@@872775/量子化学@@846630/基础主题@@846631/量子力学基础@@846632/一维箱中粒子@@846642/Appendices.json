{"hands_on_practices": [{"introduction": "变分原理是量子化学中功能最强大的近似方法之一，它为我们提供了一种系统地估算体系基态能量上限的方法。虽然一维无限深势阱可以精确求解，但将其作为应用变分原理的模型，可以极好地帮助我们理解该方法的工作机制并评估其准确性。在此练习中，您将使用一个简单的抛物线型试探波函数，通过变分法计算基态能量，并将其与精确解进行比较 ([@problem_id:1410510])。", "problem": "一个质量为 $m$ 的粒子被限制在一个长度为 $L$ 的一维盒子中。势能 $V(x)$ 在 $0  x  L$ 范围内为零，在其他地方为无穷大。该系统的定态薛定谔方程为 $\\hat{H}\\psi = E\\psi$，其中哈密顿算符在盒子内部为 $\\hat{H} = -\\frac{\\hbar^2}{2m}\\frac{d^2}{dx^2}$。\n\n变分原理提供了一种寻找量子系统基态能量上限的方法。考虑盒子中粒子的以下未归一化试探波函数：\n$$\n\\phi(x) = x(L-x) \\quad \\text{for} \\quad 0 \\le x \\le L\n$$\n这个函数正确地满足了边界条件 $\\phi(0) = 0$ 和 $\\phi(L) = 0$。\n\n使用变分原理，计算该试探波函数的能量期望值 $E_{var}$。你的任务是确定这个变分能量超过系统真实基态能量 $E_1 = \\frac{\\pi^2 \\hbar^2}{2mL^2}$ 的因子。将你的答案表示为一个数值，即比率 $\\frac{E_{var}}{E_1}$，并四舍五入到四位有效数字。", "solution": "对于一个在无穷深势阱壁处为零的实试探函数 $\\phi(x)$，其变分能量为\n$$\nE_{var}=\\frac{\\langle \\phi|\\hat{H}|\\phi\\rangle}{\\langle \\phi|\\phi\\rangle}\n=-\\frac{\\hbar^{2}}{2m}\\frac{\\int_{0}^{L}\\phi(x)\\,\\frac{d^{2}\\phi}{dx^{2}}\\,dx}{\\int_{0}^{L}\\phi^{2}(x)\\,dx}.\n$$\n使用分部积分法，并利用 $\\phi(0)=\\phi(L)=0$ 可得\n$$\n\\int_{0}^{L}\\phi\\,\\frac{d^{2}\\phi}{dx^{2}}\\,dx=\\left.\\phi\\,\\frac{d\\phi}{dx}\\right|_{0}^{L}-\\int_{0}^{L}\\left(\\frac{d\\phi}{dx}\\right)^{2}dx=-\\int_{0}^{L}\\left(\\frac{d\\phi}{dx}\\right)^{2}dx,\n$$\n所以\n$$\nE_{var}=\\frac{\\hbar^{2}}{2m}\\frac{\\int_{0}^{L}\\left(\\frac{d\\phi}{dx}\\right)^{2}dx}{\\int_{0}^{L}\\phi^{2}(x)\\,dx}.\n$$\n对于 $\\phi(x)=x(L-x)=Lx-x^{2}$，我们有\n$$\n\\frac{d\\phi}{dx}=L-2x,\\qquad \\left(\\frac{d\\phi}{dx}\\right)^{2}=L^{2}-4Lx+4x^{2},\\qquad \\phi^{2}=x^{2}(L-x)^{2}=L^{2}x^{2}-2Lx^{3}+x^{4}.\n$$\n计算所需的积分：\n$$\n\\int_{0}^{L}\\left(\\frac{d\\phi}{dx}\\right)^{2}dx=\\int_{0}^{L}\\left(L^{2}-4Lx+4x^{2}\\right)dx\n=\\left[L^{2}x-2Lx^{2}+\\frac{4}{3}x^{3}\\right]_{0}^{L}=\\frac{1}{3}L^{3},\n$$\n$$\n\\int_{0}^{L}\\phi^{2}(x)\\,dx=\\int_{0}^{L}\\left(L^{2}x^{2}-2Lx^{3}+x^{4}\\right)dx\n=\\left[\\frac{L^{2}}{3}x^{3}-\\frac{L}{2}x^{4}+\\frac{1}{5}x^{5}\\right]_{0}^{L}\n=\\left(\\frac{1}{3}-\\frac{1}{2}+\\frac{1}{5}\\right)L^{5}=\\frac{1}{30}L^{5}.\n$$\n因此\n$$\nE_{var}=\\frac{\\hbar^{2}}{2m}\\frac{\\frac{1}{3}L^{3}}{\\frac{1}{30}L^{5}}\n=\\frac{\\hbar^{2}}{2m}\\cdot\\frac{30}{3}\\cdot\\frac{1}{L^{2}}\n=\\frac{5\\hbar^{2}}{mL^{2}}.\n$$\n精确的基态能量为 $E_{1}=\\frac{\\pi^{2}\\hbar^{2}}{2mL^{2}}$。因此，比率为\n$$\n\\frac{E_{var}}{E_{1}}=\\frac{\\frac{5\\hbar^{2}}{mL^{2}}}{\\frac{\\pi^{2}\\hbar^{2}}{2mL^{2}}}=\\frac{10}{\\pi^{2}}.\n$$\n数值上，四舍五入到四位有效数字，\n$$\n\\frac{E_{var}}{E_{1}} \\approx 1.013.\n$$", "answer": "$$\\boxed{1.013}$$", "id": "1410510"}, {"introduction": "量子系统如何响应其哈密顿量的瞬时变化？这个问题在理解超快化学过程和量子动力学中至关重要。瞬时近似（sudden approximation）提供了一个理论框架来解决此类问题。这个练习 [@problem_id:1410506] 构建了一个思想实验：一个处于激发态的电子，其所处的“盒子”被瞬间压缩。您将计算在该瞬时变化后，在新的、更小的盒子中找到该电子处于基态的概率。", "problem": "一个电子被限制在长度为 $L$ 的一维量子线中，该量子线可以被建模为一个在 $x=0$ 和 $x=L$ 处有边界的无限深势阱。该电子最初处于第二激发态，对应于主量子数 $n=3$。在一个快速的制备过程中，该量子线被瞬间缩短，使得电子被限制在一个从 $x=0$ 到 $x=L/2$ 的新的、更小的势阱中。在这次突然压缩之后，立即测量，发现在新的、更小的势阱的基态（主量子数 $m=1$）上找到该电子的概率是多少？\n\n将你的答案表示为关于 $\\pi$ 的无量纲解析表达式。", "solution": "初始势阱是区间 $[0, L]$，电子处于 $n=3$ 的态。其归一化波函数为：\n$$\n\\psi_{n=3}^{\\text{old}}(x) = \\sqrt{\\frac{2}{L}}\\sin\\left(\\frac{3\\pi x}{L}\\right)\n$$\n在瞬时压缩后，新的势阱是区间 $[0, L/2]$。新势阱的基态 ($m=1$) 归一化波函数为：\n$$\n\\phi_{m=1}^{\\text{new}}(x) = \\sqrt{\\frac{2}{L/2}}\\sin\\left(\\frac{1\\pi x}{L/2}\\right) = \\sqrt{\\frac{4}{L}}\\sin\\left(\\frac{2\\pi x}{L}\\right)\n$$\n根据瞬时近似，压缩后瞬间的波函数仍然是 $\\psi_{n=3}^{\\text{old}}(x)$。电子在新基态 $\\phi_{m=1}^{\\text{new}}(x)$ 上被发现的概率幅 $c_1$ 是初始态投影到新基态上的系数，由重叠积分给出：\n$$\nc_1 = \\langle \\phi_{1}^{\\text{new}} | \\psi_{3}^{\\text{old}} \\rangle = \\int_0^{L/2} (\\phi_{1}^{\\text{new}}(x))^* \\psi_{3}^{\\text{old}}(x) \\,dx\n$$\n积分的上限是 $L/2$，因为新势阱只存在于此区间内。\n$$\nc_1 = \\int_0^{L/2} \\left(\\sqrt{\\frac{4}{L}}\\sin\\left(\\frac{2\\pi x}{L}\\right)\\right) \\left(\\sqrt{\\frac{2}{L}}\\sin\\left(\\frac{3\\pi x}{L}\\right)\\right) \\,dx = \\frac{\\sqrt{8}}{L} \\int_0^{L/2} \\sin\\left(\\frac{2\\pi x}{L}\\right)\\sin\\left(\\frac{3\\pi x}{L}\\right) \\,dx\n$$\n我们使用三角恒等式 $\\sin(A)\\sin(B) = \\frac{1}{2}[\\cos(A-B) - \\cos(A+B)]$：\n$$\n\\sin\\left(\\frac{2\\pi x}{L}\\right)\\sin\\left(\\frac{3\\pi x}{L}\\right) = \\frac{1}{2}\\left[\\cos\\left(\\frac{\\pi x}{L}\\right) - \\cos\\left(\\frac{5\\pi x}{L}\\right)\\right]\n$$\n代入积分表达式：\n$$\nc_1 = \\frac{2\\sqrt{2}}{L} \\cdot \\frac{1}{2} \\int_0^{L/2} \\left[\\cos\\left(\\frac{\\pi x}{L}\\right) - \\cos\\left(\\frac{5\\pi x}{L}\\right)\\right] \\,dx\n$$\n$$\nc_1 = \\frac{\\sqrt{2}}{L} \\left[ \\frac{L}{\\pi}\\sin\\left(\\frac{\\pi x}{L}\\right) - \\frac{L}{5\\pi}\\sin\\left(\\frac{5\\pi x}{L}\\right) \\right]_0^{L/2}\n$$\n计算定积分在上下限的值：\n$$\nc_1 = \\frac{\\sqrt{2}}{L} \\left[ \\left(\\frac{L}{\\pi}\\sin\\left(\\frac{\\pi (L/2)}{L}\\right) - \\frac{L}{5\\pi}\\sin\\left(\\frac{5\\pi (L/2)}{L}\\right)\\right) - (0 - 0) \\right]\n$$\n$$\nc_1 = \\frac{\\sqrt{2}}{L} \\left[ \\frac{L}{\\pi}\\sin\\left(\\frac{\\pi}{2}\\right) - \\frac{L}{5\\pi}\\sin\\left(\\frac{5\\pi}{2}\\right) \\right] = \\sqrt{2} \\left[ \\frac{1}{\\pi}(1) - \\frac{1}{5\\pi}(1) \\right]\n$$\n$$\nc_1 = \\sqrt{2} \\left( \\frac{1}{\\pi} - \\frac{1}{5\\pi} \\right) = \\sqrt{2} \\left( \\frac{4}{5\\pi} \\right) = \\frac{4\\sqrt{2}}{5\\pi}\n$$\n所求的概率是概率幅的模平方，$P = |c_1|^2$：\n$$\nP = \\left(\\frac{4\\sqrt{2}}{5\\pi}\\right)^2 = \\frac{16 \\cdot 2}{25\\pi^2} = \\frac{32}{25\\pi^2}\n$$", "answer": "$$\\boxed{\\frac{32}{25\\pi^{2}}}$$", "id": "1410506"}, {"introduction": "虽然一维势阱模型可以解析求解，但大多数真实的量子化学问题必须依赖数值方法。将微分方程转化为矩阵本征值问题是计算科学的一项基本技能。本练习 [@problem_id:2792822] 将指导您使用有限差分法来离散化一维盒子中的薛定谔方程，构建哈密顿量矩阵，并通过数值计算得到其能量本征值。这为您从解析理论走向现代计算化学实践奠定了基础。", "problem": "考虑一个质量为 $m$ 的非相对论粒子，被限制在区间 $[0,L]$ 上的一维无限深势阱（也称为无限深方势盒）中。势阱内部势能为零，外部势能为无穷大。施加狄利克雷边界条件 $\\psi(0)=0$ 和 $\\psi(L)=0$。在原子单位制下进行计算，其中约化普朗克常数设为 $\\hbar=1$，电子质量设为 $m=1$。势阱内部的不含时薛定谔方程为 $-\\frac{\\hbar^2}{2m}\\frac{d^2\\psi}{dx^2}=E\\psi$。\n\n任务：使用二阶中心有限差分近似二阶导数，在包含 $N$ 个内部点的均匀网格上对哈密顿量进行离散化。构建离散哈密顿矩阵 $H$，该矩阵通过将端点从未知数集合中排除来强制施加狄利克雷边界条件 $\\psi(0)=0$ 和 $\\psi(L)=0$。对每个测试用例，数值计算最低的 $M$ 个本征值（能量），并通过与无限深方势阱的精确连续谱能量进行比较来量化离散化精度。具体而言，对于每个测试用例，计算前 $M$ 个态中的最大相对误差，其定义为 $\\max_{1\\le n\\le M}\\left|\\frac{E^{\\mathrm{num}}_n - E^{\\mathrm{exact}}_n}{E^{\\mathrm{exact}}_n}\\right|$。除了此处明确说明的值之外，您不得假定任何其他值，并且必须通过构造矩阵 $H$ 的方式来施加狄利克雷边界条件。\n\n您可以使用的基本原理：\n- 阱内的不含时薛定谔方程 $-\\frac{\\hbar^2}{2m}\\frac{d^2\\psi}{dx^2}=E\\psi$，以及边界条件 $\\psi(0)=0$ 和 $\\psi(L)=0$。\n- 在均匀网格上二阶导数的二阶中心有限差分公式。\n- 对称矩阵及其本征分解的标准性质。\n\n实现要求：\n- 在 $(0,L)$ 上使用包含 $N$ 个内部点的均匀网格，网格间距为 $h=L/(N+1)$。\n- 使用二阶中心有限差分在内部网格点上近似 $d^2\\psi/dx^2$。\n- 组装对称三对角哈密顿矩阵 $H$，该矩阵在原子单位制下（即 $\\hbar=1$, $m=1$）表示 $-\\frac{\\hbar^2}{2m}\\frac{d^2}{dx^2}$，并通过排除端点来满足狄利克雷边界条件。\n- 计算 $H$ 的最低 $M$ 个本征值，并将它们与连续无限深方势阱问题的精确能量进行比较。据此计算前 $M$ 个态的最大相对误差。\n- 所有计算均在原子单位制下完成。报告的误差是无量纲实数。\n\n测试集：\n为以下每组参数 $(L,N,M)$ 提供最大相对误差：\n- 情况 1：$(L,N,M)=(1.0,5,1)$。\n- 情况 2：$(L,N,M)=(1.0,50,3)$。\n- 情况 3：$(L,N,M)=(1.0,200,3)$。\n- 情况 4：$(L,N,M)=(2.5,200,2)$。\n- 情况 5：$(L,N,M)=(0.75,150,4)$。\n\n答案规格：\n- 对于每个测试用例，输出一个浮点数，其值等于前 $M$ 个本征值的最大相对误差。\n- 将每个输出的浮点数四舍五入到八位小数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表内容为按上述测试集顺序排列的结果，例如 $[a_1,a_2,a_3,a_4,a_5]$，其中每个 $a_i$ 都四舍五入到八位小数。", "solution": "经过严格审查，该问题在科学上是有效且适定的。它构成了计算量子力学中的一个典型练习：数值求解一维无限深势阱中粒子的薛定谔方程。所有参数和方法都有明确定义，任务清晰无歧义。我们将着手解决此问题。\n\n该系统是一个质量为 $m$ 的粒子，被限制在长度为 $L$ 的一维盒子中，由不含时薛定谔方程描述。在原子单位制中，约化普朗克常数 $\\hbar=1$ 且粒子质量 $m=1$，盒子内部（势能 $V(x)=0$）的方程为：\n$$\n\\hat{H}\\psi(x) = -\\frac{1}{2}\\frac{d^2\\psi(x)}{dx^2} = E\\psi(x)\n$$\n边界条件为狄利克雷边界条件 $\\psi(0)=0$ 和 $\\psi(L)=0$。\n\n能量本征值的精确解析解是已知的，可作为我们数值计算的基准。它们由以下公式给出：\n$$\nE^{\\mathrm{exact}}_n = \\frac{n^2 \\pi^2 \\hbar^2}{2mL^2} = \\frac{n^2 \\pi^2}{2L^2}\n$$\n其中主量子数 $n = 1, 2, 3, \\dots$。\n\n为了数值求解该问题，我们将空间域 $[0, L]$ 离散化。我们定义一个包含 $N+2$ 个点的均匀网格， $x_i = i \\cdot h$，其中 $i=0, 1, \\dots, N+1$。该网格包含 $N$ 个内部点，网格间距 $h$ 由 $h = \\frac{L}{N+1}$ 给出。波函数 $\\psi(x)$ 由其在这些网格点上的值 $\\psi_i \\equiv \\psi(x_i)$ 表示。边界条件规定了 $\\psi_0 = 0$ 和 $\\psi_{N+1} = 0$。\n\n二阶导数算符 $\\frac{d^2}{dx^2}$ 在每个内部网格点 $x_i$ 上使用二阶中心有限差分公式进行近似：\n$$\n\\frac{d^2\\psi}{dx^2}\\bigg|_{x=x_i} \\approx \\frac{\\psi(x_i - h) - 2\\psi(x_i) + \\psi(x_i + h)}{h^2} = \\frac{\\psi_{i-1} - 2\\psi_i + \\psi_{i+1}}{h^2}\n$$\n\n将此近似代入内部点 $x_i$（$i \\in \\{1, \\dots, N\\}$）的薛定谔方程，得到：\n$$\n-\\frac{1}{2} \\left( \\frac{\\psi_{i-1} - 2\\psi_i + \\psi_{i+1}}{h^2} \\right) = E \\psi_i\n$$\n重新整理该表达式，得到每个点 $i$ 的离散方程：\n$$\n-\\frac{1}{2h^2}\\psi_{i-1} + \\frac{1}{h^2}\\psi_i - \\frac{1}{2h^2}\\psi_{i+1} = E \\psi_i\n$$\n\n我们可以将这个包含 $N$ 个线性代数方程的系统表示为矩阵形式 $H\\vec{\\psi} = E\\vec{\\psi}$，其中 $\\vec{\\psi}$ 是一个列向量，由 $N$ 个内部点上的波函数值组成，即 $\\vec{\\psi} = [\\psi_1, \\psi_2, \\dots, \\psi_N]^T$。边界条件通过构造来强制施加。对于第一个方程（$i=1$），项 $\\psi_0$ 被设为零。对于最后一个方程（$i=N$），项 $\\psi_{N+1}$ 被设为零。\n\n这个过程生成了哈密顿算符的一个 $N \\times N$ 矩阵表示。这个离散哈密顿矩阵 $H$ 是一个对称三对角矩阵，其元素如下：\n$$\nH_{ij} =\n\\begin{cases}\n\\frac{1}{h^2}  \\text{for } i = j \\\\\n-\\frac{1}{2h^2}  \\text{for } |i - j| = 1 \\\\\n0  \\text{otherwise}\n\\end{cases}\n$$\n或者，更明确地说，\n$$\nH = \\frac{1}{2h^2}\n\\begin{pmatrix}\n2  -1  0  \\cdots  0 \\\\\n-1  2  -1  \\cdots  0 \\\\\n0  -1  2  \\ddots  \\vdots \\\\\n\\vdots  \\vdots  \\ddots  \\ddots  -1 \\\\\n0  0  \\cdots  -1  2\n\\end{pmatrix}\n$$\n该矩阵作用于内部点上的波函数值向量。此矩阵的本征值 $E_n^{\\mathrm{num}}$ 是真实能量本征值的数值近似。\n\n计算任务是为每组参数 $(L, N, M)$ 构建该矩阵 $H$，并计算其最低的 $M$ 个本征值。通过使用针对对称三对角矩阵优化的数值线性代数库，可以高效地完成此任务。\n\n最后，我们通过计算前 $M$ 个能级中的最大相对误差来量化离散化精度。对于每个测试用例，需要报告的值是：\n$$\n\\text{Error} = \\max_{1 \\le n \\le M} \\left| \\frac{E^{\\mathrm{num}}_n - E^{\\mathrm{exact}}_n}{E^{\\mathrm{exact}}_n} \\right|\n$$\n其中 $E^{\\mathrm{num}}_n$ 是通过 $H$ 的数值对角化得到的排序后的本征值，而 $E^{\\mathrm{exact}}_n$ 是来自精确解析公式的相应能量。下面的程序精确地实现了所描述的逻辑。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh_tridiagonal\n\ndef solve():\n    \"\"\"\n    Solves the discretized 1D particle-in-a-box problem for a series of test cases.\n\n    For each case (L, N, M), it constructs the finite-difference Hamiltonian,\n    computes the lowest M eigenvalues, compares them to the exact analytical\n    energies, and finds the maximum relative error.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each tuple is (L, N, M) where:\n    # L: length of the box\n    # N: number of interior grid points\n    # M: number of lowest eigenvalues to check\n    test_cases = [\n        (1.0, 5, 1),\n        (1.0, 50, 3),\n        (1.0, 200, 3),\n        (2.5, 200, 2),\n        (0.75, 150, 4),\n    ]\n\n    results = []\n    for L, N, M in test_cases:\n        # Step 1: Set up the grid and constants.\n        # Atomic units are used (hbar=1, m=1).\n        # Grid spacing h for N interior points.\n        h = L / (N + 1)\n        \n        # Step 2: Construct the tridiagonal Hamiltonian matrix H.\n        # The TISE is (-1/2) * d^2(psi)/dx^2 = E * psi.\n        # The finite difference approximation for the second derivative is\n        # (psi_{i-1} - 2*psi_i + psi_{i+1}) / h^2.\n        # This leads to the discrete equation:\n        # (-1/(2*h^2)) * psi_{i-1} + (1/h^2) * psi_i + (-1/(2*h^2)) * psi_{i+1} = E * psi_i.\n        \n        # Main diagonal elements of H\n        diag_elements = np.full(N, 1.0 / h**2)\n        \n        # Off-diagonal elements of H\n        off_diag_elements = np.full(N - 1, -0.5 / h**2)\n\n        # Step 3: Compute the lowest M eigenvalues of H.\n        # eigh_tridiagonal is highly efficient for this matrix structure.\n        # It returns eigenvalues sorted in ascending order.\n        # We request the first M eigenvalues using select='i' and select_range.\n        # The function returns (eigenvalues, eigenvectors). We only need the eigenvalues.\n        numerical_eigenvalues, _ = eigh_tridiagonal(\n            diag_elements, \n            off_diag_elements,\n            select='i',\n            select_range=(0, M - 1)\n        )\n\n        # Step 4: Compute the exact analytical eigenvalues.\n        # E_n = (n^2 * pi^2) / (2 * L^2) for n=1, 2, 3, ...\n        n_values = np.arange(1, M + 1)\n        exact_eigenvalues = (n_values**2 * np.pi**2) / (2 * L**2)\n\n        # Step 5: Calculate the maximum relative error.\n        relative_errors = np.abs((numerical_eigenvalues - exact_eigenvalues) / exact_eigenvalues)\n        max_relative_error = np.max(relative_errors)\n        \n        results.append(max_relative_error)\n\n    # Final print statement in the exact required format.\n    # Results are rounded to eight decimal places.\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```", "id": "2792822"}]}