## 引言
在量子世界中，薛定谔方程是描述系统行为的根本法则。然而，除了少数极简化的模型外，该方程对于绝大多数原子和分子系统都无法精确求解。这一现实催生了对强大近似方法的需求，而变分原理正是其中最深刻、最普适的基石之一。它不仅为我们提供了一种系统性逼近量子系统[基态能量](@entry_id:263704)的严谨途径，也构成了现代计算化学的理论核心。

本文旨在全面剖析变分原理。在第一章“原理与机制”中，我们将深入探讨[变分定理](@entry_id:184487)的[数学证明](@entry_id:137161)，学习如何通过参数化试探波函数来寻找能量的最小值，并介绍强大的[线性变分法](@entry_id:150058)。随后，在第二章“应用和跨学科联系”中，我们将展示该原理如何应用于解释[原子结构](@entry_id:137190)、[化学键形成](@entry_id:149227)，乃至作为高级计算方法（如Hartree-Fock和CI）的理论基础，并揭示其与物理学其他领域的深刻联系。最后，第三章“动手实践”将通过具体的计算练习，巩固您对[变分法](@entry_id:163656)的理解和应用能力。

让我们首先从这一原理的核心——[变分定理](@entry_id:184487)及其背后的机制开始。

## 原理与机制

对于除了少数几个高度简化的模型之外的绝大多数量子系统，薛定谔方程都无法精确求解。因此，开发强大的近似方法对于将量子力学应用于现实世界的化学和物理问题至关重要。变分原理是这些方法中最基本、最深刻的支柱之一，它为我们估算系统的基态能量提供了一个严格的上限。本章将详细阐述变分原理的理论基础、实际应用机制及其对[激发态](@entry_id:261453)的扩展。

### [变分定理](@entry_id:184487)：基态能量的上限

[变分定理](@entry_id:184487)是量子力学中的一个基本结论。它指出，对于一个由[哈密顿算符](@entry_id:144286) $\hat{H}$ 描述的系统，其真实的基态能量为 $E_0$。如果我们选取任何一个表现良好（well-behaved）的归一化[试探波函数](@entry_id:142892) $\psi_{trial}$，通过该函数计算出的[能量期望值](@entry_id:174035) $E_{trial}$ 将永远不会低于真实的基态能量 $E_0$。这个关系可以简洁地表示为：

$$ E_{trial} = \langle \psi_{trial} | \hat{H} | \psi_{trial} \rangle \ge E_0 $$

这个定理的强大之处在于，它适用于任何合理的试探波函数，无论这个函数与真实的[基态](@entry_id:150928)[波函数](@entry_id:147440) $\psi_0$ 相差多远。这意味着我们可以通过“猜测”[波函数](@entry_id:147440)的形式来系统地逼近[基态能量](@entry_id:263704)，而无需担心会得到一个低于真实值的、具有误导性的结果。

那么，这个原理的理论基础是什么呢？其证明过程巧妙地利用了量子力学的一个核心假设：任何一个给定系统的[哈密顿算符](@entry_id:144286) $\hat{H}$，其所有本征函数 $\{\psi_n\}$ 构成一个完备的正交归一集。这意味着任何一个表现良好的试探波函数 $\psi_{trial}$ 都可以被唯一地展开为这些本征函数的线性叠加 [@problem_id:2144180]：

$$ \psi_{trial} = \sum_{n=0}^{\infty} c_n \psi_n $$

其中，$\hat{H}\psi_n = E_n\psi_n$，并且[能量本征值](@entry_id:144381)按大小排序为 $E_0 \le E_1 \le E_2 \le \dots$。如果 $\psi_{trial}$ 是归一化的，那么展开系数 $c_n$ 必须满足[归一化条件](@entry_id:156486) $\sum_n |c_n|^2 = 1$。

现在，我们来计算 $E_{trial}$：

$$ E_{trial} = \langle \sum_m c_m \psi_m | \hat{H} | \sum_n c_n \psi_n \rangle = \sum_{m,n} c_m^* c_n \langle \psi_m | \hat{H} | \psi_n \rangle $$

利用 $\hat{H}\psi_n = E_n\psi_n$ 以及[本征函数的正交性](@entry_id:150712) $\langle \psi_m | \psi_n \rangle = \delta_{mn}$，上式可以简化为：

$$ E_{trial} = \sum_{m,n} c_m^* c_n E_n \delta_{mn} = \sum_n |c_n|^2 E_n $$

这个表达式的物理意义是，试探态的能量是系统各个本征能量的加权平均，权重为 $|c_n|^2$（即在试探态中找到系统处于本征态 $\psi_n$ 的概率）。由于 $E_0$ 是所有[能量本征值](@entry_id:144381)中最小的一个，即对于所有的 $n$ 都有 $E_n \ge E_0$，我们可以得到：

$$ E_{trial} = \sum_n |c_n|^2 E_n \ge \sum_n |c_n|^2 E_0 = E_0 \sum_n |c_n|^2 = E_0 $$

这就证明了[变分定理](@entry_id:184487)。这个不等式中的等号何时成立呢？等号成立的条件是，在上述求和中，所有能量高于 $E_0$ 的项的系数都必须为零。也就是说，除了 $|c_0|^2$ 之外，所有 $|c_n|^2$ ($n > 0$) 都为零。由于 $\sum_n |c_n|^2 = 1$，这必然意味着 $|c_0|^2 = 1$，并且 $\psi_{trial}$ 与 $\psi_0$ 最多相差一个相位因子。因此，[变分定理](@entry_id:184487)的等号仅在[试探波函数](@entry_id:142892)恰好是真实的[基态](@entry_id:150928)[波函数](@entry_id:147440)时成立 [@problem_id:2144200]。这是一个非常重要的结论：如果我们幸运地或凭借深刻的物理洞察力猜中了确切的[基态](@entry_id:150928)[波函数](@entry_id:147440)，变分计算将给出确切的[基态能量](@entry_id:263704)。

在实际计算中，我们通常使用一个更通用的表达式，称为**瑞利商 (Rayleigh quotient)**，来计算变分能，该表达式适用于未归一化的试探波函数 $\phi$：

$$ E[\phi] = \frac{\langle \phi | \hat{H} | \phi \rangle}{\langle \phi | \phi \rangle} $$

这个表达式有一个非常便利的特性：它对[试探波函数](@entry_id:142892)的归一化不敏感。如果我们用一个常数 $c$ 去缩放试探波函数，即 $\phi' = c\phi$，那么[瑞利商](@entry_id:137794)的值保持不变：

$$ E[\phi'] = \frac{\langle c\phi | \hat{H} | c\phi \rangle}{\langle c\phi | c\phi \rangle} = \frac{|c|^2 \langle \phi | \hat{H} | \phi \rangle}{|c|^2 \langle \phi | \phi \rangle} = E[\phi] $$

这意味着我们在进行变分计算时，可以专注于选择一个具有正确函数形式的[试探波函数](@entry_id:142892)，而无需在计算能量之前费心将其归一化 [@problem_id:1416059]。归一化因子在瑞利商的分子和分母中自动抵消了。

### 实践中的[变分法](@entry_id:163656)：参数化[试探函数](@entry_id:756165)

[变分定理](@entry_id:184487)为我们提供了一个强大的策略来近似求解量子问题：
1.  基于对系统的物理理解，选择一个包含一个或多个可调参数（$\alpha, \beta, \dots$）的试探波函数 $\psi(\alpha, \beta, \dots)$。
2.  计算该[试探函数](@entry_id:756165)的变分能 $E(\alpha, \beta, \dots)$。
3.  将 $E$ 视为参数的函数，通过标准微积分方法找到使其最小化的参数值。即[求解方程组](@entry_id:152624) $\frac{\partial E}{\partial \alpha} = 0, \frac{\partial E}{\partial \beta} = 0, \dots$。
4.  将最优参数值 $\alpha_{opt}, \beta_{opt}, \dots$ 代回能量表达式，得到的 $E_{min} = E(\alpha_{opt}, \beta_{opt}, \dots)$ 就是在该函数形式下对基态能量的最佳近似。

例如，假设对于某个模型系统，我们经过计算得到变分能与参数 $\alpha$ 的关系为 $E(\alpha) = A \alpha^2 + \frac{B}{\alpha}$，其中 $A$ 和 $B$ 是与系统物理属性相关的正常数 [@problem_id:1416091]。为了找到最佳近似能量，我们对 $E(\alpha)$ 求导并令其为零：

$$ \frac{dE}{d\alpha} = 2A\alpha - \frac{B}{\alpha^2} = 0 $$

解这个方程可以得到最优参数 $\alpha_{opt} = (\frac{B}{2A})^{1/3}$。将此值代回即可得到该[试探函数](@entry_id:756165)所能给出的最低能量。

这个过程也为我们提供了一个评估不同[试探函数](@entry_id:756165)“好坏”的客观标准。根据[变分定理](@entry_id:184487)，变分能越接近真实的基态能量 $E_0$（即能量值越低），我们的试探波函数就越“好”，因为它在某种意义上更接近真实的[基态](@entry_id:150928)[波函数](@entry_id:147440)。例如，如果我们用[高斯函数](@entry_id:261394)和[洛伦兹函数](@entry_id:199503)作为[试探波函数](@entry_id:142892)来估算同一个系统的[基态能量](@entry_id:263704)，并经过优化后分别得到能量 $E_G$ 和 $E_L$。如果发现 $E_L  E_G$，我们就可以得出结论，对于这个特定的系统，[洛伦兹函数](@entry_id:199503)形式是比高斯函数形式更好的近似 [@problem_id:2144152]。

当然，要使变分计算有意义，我们选择的试探波函数必须是“物理上合理的”。这意味着它必须满足一些基本条件，例如在全空间内是单值、连续且平方可积的。此外，它还必须满足由系统势能决定的特定边界条件。一个典型的例子是“[一维无限深势阱](@entry_id:271157)”中的粒子，其势能在 $x=0$ 和 $x=L$ 处为无穷大。对于这样的系统，任何合理的[试探波函数](@entry_id:142892)都必须在边界上为零，即 $\psi(0) = 0$ 和 $\psi(L) = 0$。其根本的数学原因在于[哈密顿算符](@entry_id:144286) $\hat{H} = -\frac{\hbar^2}{2m} \frac{d^2}{dx^2}$ 包含[二阶导数](@entry_id:144508)。如果[波函数](@entry_id:147440)在边界处不为零，它将在无穷高的势垒处发生突变，导致其[二阶导数](@entry_id:144508)趋于无穷大。这会使得动能[期望值](@entry_id:153208) $\langle \psi | \hat{H} | \psi \rangle$ 发散，从而得到一个无意义的无限大的能量 [@problem_id:1416081]。因此，满足边界条件是确保变分能有限且有意义的前提。

### [线性变分法](@entry_id:150058)

直接选择一个带有[非线性](@entry_id:637147)参数的复杂函数并进行优化可能在数学上非常困难。一种更系统、更具扩展性的方法是**[线性变分法](@entry_id:150058)**。其核心思想是，将试探波函数构建为一组预先选定的、[线性无关](@entry_id:148207)的**[基函数](@entry_id:170178)** $\{\phi_i\}$ 的线性组合：

$$ \psi_{trial} = \sum_{i=1}^{N} c_i \phi_i $$

在这里，变分参数不再是嵌入在函数形式中的[非线性](@entry_id:637147)参数（如 $\alpha$），而是线性的展开系数 $\{c_i\}$。我们的任务是找到一组最佳的系数 $\{c_i\}$，使得瑞利商最小化。

将上述[试探函数](@entry_id:756165)代入[瑞利商](@entry_id:137794)表达式，并对任意系数 $c_k$ 求偏导并令其为零，经过一系列推导，可以得到一组线性[代数方程](@entry_id:272665)，称为**[久期方程](@entry_id:200202) (secular equations)**：

$$ \sum_{j=1}^{N} (H_{ij} - E S_{ij}) c_j = 0 \quad (i = 1, 2, \dots, N) $$

这可以写成更紧凑的矩阵形式 $(\mathbf{H} - E\mathbf{S})\mathbf{c} = 0$。其中：
-   $\mathbf{H}$ 是**[哈密顿矩阵](@entry_id:136233)**，其[矩阵元](@entry_id:186505)为 $H_{ij} = \langle \phi_i | \hat{H} | \phi_j \rangle$。
-   $\mathbf{S}$ 是**[重叠矩阵](@entry_id:268881)**，其矩阵元为 $S_{ij} = \langle \phi_i | \phi_j \rangle$。
-   $\mathbf{c}$ 是系数构成的列向量。

这是一个广义[本征值问题](@entry_id:142153)。为了得到非零解（即 $c_j$ 不全为零），系数[矩阵的[行列](@entry_id:148198)式](@entry_id:142978)必须为零：

$$ \det(\mathbf{H} - E\mathbf{S}) = 0 $$

解这个 $N$ 阶的**[久期行列式](@entry_id:274608)**，我们会得到 $N$ 个能量的实数解 $E_1, E_2, \dots, E_N$。根据变分原理，这些解中的最低者，我们记为 $E_{min}$，必然是真实基态能量 $E_0$ 的一个上限，即 $E_{min} \ge E_0$ [@problem_id:1416060]。

[线性变分法](@entry_id:150058)的一个极其重要的特性是其系统可改进性。假设我们用 $N$ 个[基函数](@entry_id:170178)进行计算，得到最低能量为 $E_N$。然后，我们通过增加[基函数](@entry_id:170178)来扩大[基组](@entry_id:160309)，形成一个包含 $M$ 个[基函数](@entry_id:170178) ($M > N$) 的新[基组](@entry_id:160309)，并进行新的计算，得到最低能量 $E_M$。由于新的、更大的函数空间（由 $M$ 个[基函数](@entry_id:170178)张成）完全包含了旧的、较小的[函数空间](@entry_id:143478)，因此在新空间中寻找能量最小值的结果，必然不会比在旧空间中的结果更差。换句话说，通过扩大[基组](@entry_id:160309)，我们为系统提供了更多的变分自由度来更好地描述[基态](@entry_id:150928)，因此得到的能量近似值只能变得更好（更低）或保持不变。这一结论可表示为 $E_M \le E_N$ [@problem_id:1416117]。这一特性是现代[量子化学](@entry_id:140193)计算的基石，它解释了为什么使用更大的[基组](@entry_id:160309)通常会得到更准确的计算结果。

### [激发态](@entry_id:261453)的近似

标准的变分原理只保证了对基态能量的上限。那么我们如何估算[激发态](@entry_id:261453)的能量呢？一个重要的推广定理指出：如果一个归一化的试探波函数 $\phi$ 与所有能量比它低的真实[本征态](@entry_id:149904)都正交，那么它的变分能将是相应[激发态](@entry_id:261453)能量的上限。

具体来说，如果我们能找到一个与真实[基态](@entry_id:150928)[波函数](@entry_id:147440) $\psi_0$ 正交的试探波函数 $\phi_1$（即 $\langle \phi_1 | \psi_0 \rangle = 0$），那么：

$$ E_{trial,1} = \langle \phi_1 | \hat{H} | \phi_1 \rangle \ge E_1 $$

其中 $E_1$ 是第一[激发态](@entry_id:261453)的真实能量。这个定理的证明思路与[基态](@entry_id:150928)的证明类似，只是展开式中不包含[基态](@entry_id:150928)项 $c_0\psi_0$。

在实践中，我们通常不知道真实的[基态](@entry_id:150928)[波函数](@entry_id:147440) $\psi_0$。但有两种常用策略可以绕过这个问题：

1.  **显式正交化**：我们可以先用变分法找到一个对[基态](@entry_id:150928)[波函数](@entry_id:147440)的良好近似 $\phi_0$，然后构建一个与 $\phi_0$ 显式正交的[试探函数](@entry_id:756165) $\phi_1$ 来近似第一[激发态](@entry_id:261453)。例如，在处理一维势箱问题时，我们可以选取一个简单的、类似[基态](@entry_id:150928)的函数（如 $\phi_0(x) = x(L-x)$），然后构造一个与之正交的[激发态](@entry_id:261453)[试探函数](@entry_id:756165)（如 $\phi_1(x) = x(L-x)(2x-L)$）来计算第一[激发态](@entry_id:261453)能量的上限 [@problem_id:1416104]。

2.  **利用对称性**：这是一个更优雅且强大的方法。如果系统的[哈密顿算符](@entry_id:144286)具有某种对称性（例如，对于像谐振子这样的[对称势](@entry_id:148561)，$V(x) = V(-x)$），那么它的[本征函数](@entry_id:154705)必然具有确定的对称性（例如，偶宇称或奇宇称）。谐振子的[基态](@entry_id:150928)[波函数](@entry_id:147440)是偶函数。因此，任何奇函数都自动与它正交。这意味着如果我们选择一个[奇函数](@entry_id:173259)作为[试探波函数](@entry_id:142892)，例如 $\psi_t(x) = C x \exp(-ax^2)$，那么根据推广的变分原理，它计算出的变分能必然是能量最低的那个奇宇称态（即第一[激发态](@entry_id:261453)）能量的上限 [@problem_id:2144162]。在某些幸运的情况下，例如对于[谐振子](@entry_id:155622)问题，选择这种形式的[试探函数](@entry_id:756165)并优化参数 $a$ 后，得到的结果恰好就是精确的第一[激发态](@entry_id:261453)能量 $\frac{3}{2}\hbar\omega$。

最后值得一提的是，[线性变分法](@entry_id:150058)本身就为计算[激发态](@entry_id:261453)提供了一个系统性的框架。求解[久期方程](@entry_id:200202) $\det(\mathbf{H} - E\mathbf{S}) = 0$ 会得到 $N$ 个能量值。根据**[Hylleraas-Undheim-MacDonald定理](@entry_id:202609)**，这些能量根 $E_k$ 不仅为[基态](@entry_id:150928)提供了上限，也为[激发态](@entry_id:261453)提供了上限。具体来说，将这些能量从低到高排序 $E^{(1)} \le E^{(2)} \le \dots \le E^{(N)}$，则对于每一个 $k$，都有 $E^{(k)} \ge E_{k-1}$，其中 $E_{k-1}$ 是第 $k-1$ 个[激发态](@entry_id:261453)的真实能量。这使得[线性变分法](@entry_id:150058)成为同时近似计算多个能级的强大工具。