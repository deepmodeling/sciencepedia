{"hands_on_practices": [{"introduction": "科恩-沈（Kohn-Sham, KS）方法的核心思想是通过一组虚拟的、无相互作用的电子轨道来构建真实体系的电子密度。这个练习将带你实践最基本的一步：如何从给定的占据KS轨道出发，正确地写出体系的总电子密度表达式。掌握这一点是理解KS-DFT计算流程的基石。", "problem": "考虑一个包含四个电子的假想分子系统。其电子结构在密度泛函理论 (DFT) 的 Kohn-Sham 框架内进行描述。该系统处于基态，所有四个电子占据了能量最低的两个空间 Kohn-Sham 轨道，记作 $\\phi_1(\\mathbf{r})$ 和 $\\phi_2(\\mathbf{r})$。这些轨道中的每一个都被自旋配对的电子双重占据。\n\n基于此信息，请用给定的轨道写出该系统总电子密度 $\\rho(\\mathbf{r})$ 的数学表达式。", "solution": "在 Kohn-Sham 密度泛函理论中，总电子密度 $\\rho(\\mathbf{r})$ 定义为所有占据轨道的概率密度之和，并按其各自的占据数进行加权。对于一个含有 $N$ 个电子的系统，其通用公式为：\n$$\n\\rho(\\mathbf{r}) = \\sum_{i} n_{i} |\\phi_i(\\mathbf{r})|^2\n$$\n在此方程中，求和遍及所有 Kohn-Sham 空间轨道 $\\phi_i(\\mathbf{r})$。项 $n_i$ 表示第 $i$ 个轨道的占据数，而 $|\\phi_i(\\mathbf{r})|^2$ 是与该轨道在空间中一点 $\\mathbf{r}$ 相关联的概率密度。请注意， $|\\phi_i(\\mathbf{r})|^2$ 等价于 $\\phi_i^*(\\mathbf{r})\\phi_i(\\mathbf{r})$，这在轨道是复值函数时很重要。\n\n根据题目描述，该系统有四个电子，且这些电子只占据两个空间轨道：$\\phi_1(\\mathbf{r})$ 和 $\\phi_2(\\mathbf{r})$。所有其他轨道均未被占据。因此，求和将只包含 $i=1$ 和 $i=2$ 的项。\n\n题目明确指出这两个轨道中的每一个都被“双重占据”。这意味着每个空间轨道包含两个电子，一个自旋向上，一个自旋向下（自旋配对）。这使得每个占据轨道的占据数都为 2。\n- 对于轨道 $\\phi_1(\\mathbf{r})$，占据数为 $n_1 = 2$。\n- 对于轨道 $\\phi_2(\\mathbf{r})$，占据数为 $n_2 = 2$。\n- 对于所有其他轨道 $\\phi_i$（其中 $i > 2$），占据数为 $n_i = 0$，因此它们对密度没有贡献。\n\n将这些值代入电子密度的通用公式，我们得到：\n$$\n\\rho(\\mathbf{r}) = n_1 |\\phi_1(\\mathbf{r})|^2 + n_2 |\\phi_2(\\mathbf{r})|^2\n$$\n$$\n\\rho(\\mathbf{r}) = 2 |\\phi_1(\\mathbf{r})|^2 + 2 |\\phi_2(\\mathbf{r})|^2\n$$\n\n通过提取公因数 2，这个表达式可以写得更紧凑：\n$$\n\\rho(\\mathbf{r}) = 2 \\left( |\\phi_1(\\mathbf{r})|^2 + |\\phi_2(\\mathbf{r})|^2 \\right)\n$$\n这就是该系统总电子密度的最终表达式。我们可以通过对该密度在整个空间上进行积分来验证其是否等于总电子数：\n$\\int \\rho(\\mathbf{r}) d\\mathbf{r} = 2 \\int |\\phi_1(\\mathbf{r})|^2 d\\mathbf{r} + 2 \\int |\\phi_2(\\mathbf{r})|^2 d\\mathbf{r}$。由于 Kohn-Sham 轨道是归一化的，所以 $\\int |\\phi_i(\\mathbf{r})|^2 d\\mathbf{r} = 1$。因此，$\\int \\rho(\\mathbf{r}) d\\mathbf{r} = 2(1) + 2(1) = 4$，这正确地等于系统中的总电子数。", "answer": "$$\\boxed{\\rho(\\mathbf{r}) = 2\\left(|\\phi_{1}(\\mathbf{r})|^{2} + |\\phi_{2}(\\mathbf{r})|^{2}\\right)}$$", "id": "1407885"}, {"introduction": "在构建了电子密度之后，科恩-沈自洽循环的下一步是利用这个密度来更新有效的KS势。本练习将KS势分解为其经典的静电部分：来自原子核的外势和来自电子云自身排斥的哈特里（Hartree）势。你将通过对一个氦原子模型的具体计算，亲手推导这些势的表达式，从而加深对“密度决定势”这一核心概念的理解。[@problem_id:1407885]", "problem": "在科恩-沈密度泛函理论 (DFT) 的框架下，多电子体系中单个电子所感受到的有效势由几个分量构成。本题涉及一个中性氦原子简化模型中的这两个分量。\n\n考虑一个孤立的中性氦原子，其原子核（电荷为 $+2e$）固定在原点。在此模型中，两个电子的总电子密度 $n(r)$ 由以下球对称函数近似：\n$$n(r) = \\frac{2\\zeta^3}{\\pi} \\exp(-2\\zeta r)$$\n其中，$r$ 是离原子核的径向距离，$\\zeta$ 是一个量纲为长度倒数的正常数，$e$ 是元电荷，$\\pi$ 是数学常数。\n\n有效科恩-沈势 $v_{eff}(\\mathbf{r})$ 包括外势 $v_{ext}(\\mathbf{r})$ 和哈特里势 $v_H(\\mathbf{r})$。\n外势 $v_{ext}(\\mathbf{r})$ 表示电子与原子核相互作用产生的静电势能。\n哈特里势 $v_H(\\mathbf{r})$ 描述了电子因受到总电子密度分布排斥而产生的经典静电势能。它由以下表达式给出：\n$$v_H(\\mathbf{r}) = \\frac{e^2}{4\\pi\\epsilon_0} \\int \\frac{n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|} d^3\\mathbf{r}'$$\n其中 $\\epsilon_0$ 是真空介电常数。\n\n由于问题的球对称性，这两个势都将仅依赖于径向距离 $r$。你的任务是确定外势 $v_{ext}(r)$ 和哈特里势 $v_H(r)$ 的显式数学表达式。\n\n请按顺序给出 $v_{ext}(r)$ 和 $v_H(r)$ 的答案，表示为 $r$、$\\zeta$、$e$ 和 $\\epsilon_0$ 的解析表达式。", "solution": "外部科恩-沈势是电子因位于原点的电荷为 $+2e$ 的原子核而产生的静电势能。原子核产生的静电势为 $\\phi_{\\text{nuc}}(r) = \\frac{1}{4\\pi\\epsilon_{0}} \\frac{2e}{r}$。在此势中，一个电荷为 $-e$ 的电子的势能为\n$$\nv_{ext}(r) = (-e)\\,\\phi_{\\text{nuc}}(r) = -\\frac{2 e^{2}}{4\\pi\\epsilon_{0}\\,r}.\n$$\n\n对于哈特里势，我们从给定的表达式开始\n$$\nv_{H}(\\mathbf{r}) = \\frac{e^{2}}{4\\pi\\epsilon_{0}} \\int \\frac{n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\,d^{3}\\mathbf{r}'.\n$$\n对于球对称情况，使用标准恒等式（基于高斯定律）可将其简化为径向积分\n$$\n\\int \\frac{n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\,d^{3}\\mathbf{r}' = 4\\pi\\left[\\frac{1}{r}\\int_{0}^{r} r'^{2} n(r')\\,dr' + \\int_{r}^{\\infty} r' n(r')\\,dr'\\right].\n$$\n代入 $n(r') = A \\exp(-a r')$，其中 $A = \\frac{2\\zeta^{3}}{\\pi}$ 且 $a = 2\\zeta$。定义\n$$\nI_{1}(r) = \\int_{0}^{r} r'^{2} \\exp(-a r')\\,dr', \\qquad I_{2}(r) = \\int_{r}^{\\infty} r' \\exp(-a r')\\,dr'.\n$$\n通过分部积分法计算这些积分，\n$$\nI_{1}(r) = \\left[\\exp(-a r')\\left(-\\frac{r'^{2}}{a} - \\frac{2 r'}{a^{2}} - \\frac{2}{a^{3}}\\right)\\right]_{0}^{r} = \\frac{2}{a^{3}} - \\exp(-a r)\\left(\\frac{r^{2}}{a} + \\frac{2 r}{a^{2}} + \\frac{2}{a^{3}}\\right),\n$$\n$$\nI_{2}(r) = \\left[\\exp(-a r')\\left(-\\frac{r'}{a} - \\frac{1}{a^{2}}\\right)\\right]_{r}^{\\infty} = \\exp(-a r)\\left(\\frac{r}{a} + \\frac{1}{a^{2}}\\right).\n$$\n因此，\n$$\n\\int \\frac{n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\,d^{3}\\mathbf{r}' = 4\\pi A\\left[\\frac{1}{r} I_{1}(r) + I_{2}(r)\\right].\n$$\n将 $I_1(r)$ 和 $I_2(r)$ 的结果代入并化简，\n$$\n\\frac{1}{r} I_{1}(r) + I_{2}(r) = \\frac{1}{r} \\left[\\frac{2}{a^{3}} - \\exp(-a r)\\left(\\frac{r^{2}}{a} + \\frac{2 r}{a^{2}} + \\frac{2}{a^{3}}\\right)\\right] + \\exp(-a r)\\left(\\frac{r}{a} + \\frac{1}{a^{2}}\\right) = \\frac{2}{a^{3} r} - \\exp(-a r)\\left(\\frac{1}{a^{2}} + \\frac{2}{a^{3} r}\\right).\n$$\n使用 $4\\pi A = 8\\zeta^{3}$ 和 $a = 2\\zeta$ 进行化简，\n$$\n\\int \\frac{n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\,d^{3}\\mathbf{r}' = 8\\zeta^{3}\\left[\\frac{2}{(2\\zeta)^{3} r} - \\exp(-2\\zeta r)\\left(\\frac{1}{(2\\zeta)^{2}} + \\frac{2}{(2\\zeta)^{3} r}\\right)\\right] = \\frac{2}{r} - e^{-2\\zeta r} \\left(\\frac{2\\zeta^2}{\\zeta^2} + \\frac{2\\zeta^3}{\\zeta^3 r}\\right) = \\frac{2}{r} - e^{-2\\zeta r} \\left(2 + \\frac{2}{r}\\right).\n$$\n将此结果代入 $v_H(r)$ 的表达式，我们得到\n$$\nv_{H}(r) = \\frac{e^{2}}{4\\pi\\epsilon_{0}}\\left[\\frac{2}{r} - \\frac{2}{r}e^{-2\\zeta r} - 2\\zeta e^{-2\\zeta r} \\right] = \\frac{e^{2}}{4\\pi\\epsilon_{0}}\\left[\\frac{2(1 - e^{-2\\zeta r})}{r} - 2\\zeta e^{-2\\zeta r}\\right].\n$$\n一个等价的紧凑形式是\n$$\nv_{H}(r) = \\frac{e^{2}}{4\\pi\\epsilon_{0}}\\,\\frac{2}{r}\\left[1 - \\left(1 + \\zeta r\\right)e^{-2\\zeta r}\\right].\n$$\n两种形式在代数上是等价的。\n\n因此，所需的解析表达式为\n$$\nv_{ext}(r) = -\\frac{2 e^{2}}{4\\pi\\epsilon_{0}\\,r}, \\qquad\nv_{H}(r) = \\frac{e^{2}}{4\\pi\\epsilon_{0}}\\left[\\frac{2(1 - e^{-2\\zeta r})}{r} - 2\\zeta e^{-2\\zeta r}\\right].\n$$", "answer": "$$\\boxed{\n\\begin{aligned}\nv_{ext}(r) = -\\frac{2 e^{2}}{4\\pi\\epsilon_{0}r} \\\\\nv_{H}(r) = \\frac{e^{2}}{4\\pi\\epsilon_{0}}\\left[\\frac{2(1 - e^{-2\\zeta r})}{r} - 2\\zeta e^{-2\\zeta r}\\right]\n\\end{aligned}\n}$$", "id": "1407884"}, {"introduction": "哈特里势虽然描述了电子间的平均排斥，但也引入了一个非物理的问题：电子的自相互作用。神秘的交换相关势的一个关键任务就是修正这个错误，并包含所有其他复杂的量子效应。这个概念性问题将通过最简单的单电子体系，探讨交换相关势必须满足的条件，以确保KS理论能够得到精确解，从而揭示其核心物理意义。", "problem": "密度泛函理论（DFT）的 Kohn-Sham 公式为近似多电子系统的电子结构提供了一种强有力的方法。它通过将复杂的相互作用系统映射到一个虚构的、能够产生相同基态电子密度 $n(\\mathbf{r})$ 的无相互作用电子系统来实现这一点。\n\n在 Kohn-Sham 形式中，对于给定的电子密度 $n(\\mathbf{r})$，总基态能量由能量泛函表示：\n$$E_{KS}[n] = T_s[n] + E_{ext}[n] + J[n] + E_{xc}[n]$$\n此处，$T_s[n]$ 是无相互作用参考系统的动能，$E_{ext}[n] = \\int v_{ext}(\\mathbf{r}) n(\\mathbf{r}) d\\mathbf{r}$ 是由外势 $v_{ext}(\\mathbf{r})$（通常是电子-原子核吸引）引起的能量，$J[n]$ 是电子密度与其自身的经典库仑排斥能（Hartree 能量），而 $E_{xc}[n]$ 是交换相关能，它包含了所有剩余的量子力学效应。\n\n单电子 Kohn-Sham 方程通过有效势 $v_{KS}(\\mathbf{r}) = v_{ext}(\\mathbf{r}) + v_H(\\mathbf{r}) + v_{xc}(\\mathbf{r})$ 求解，其中 Hartree 势 $v_H(\\mathbf{r})$ 和交换相关势 $v_{xc}(\\mathbf{r})$ 分别是 $J[n]$ 和 $E_{xc}[n]$ 对密度 $n(\\mathbf{r})$ 的泛函导数。\n\nDFT 的一个基本原理是，对于精确的交换相关泛函，在真实基态密度下计算的总能量 $E_{KS}[n]$ 必须等于系统的真实基态能量。\n\n考虑一个简单的单电子系统（例如，氢原子或类氢离子）。对于这样的系统，定态 Schrödinger 方程可以精确求解，并且不存在电子-电子相互作用。如果 Kohn-Sham DFT 形式对于该系统是精确的，那么交换相关势 $v_{xc}(\\mathbf{r})$ 和 Hartree 势 $v_{H}(\\mathbf{r})$ 之间必须满足什么特定的关系？\n\nA) $v_{xc}(\\mathbf{r}) = v_{H}(\\mathbf{r})$\n\nB) $v_{xc}(\\mathbf{r}) = -v_{H}(\\mathbf{r})$\n\nC) $v_{xc}(\\mathbf{r}) = 0$\n\nD) $v_{xc}(\\mathbf{r}) = -v_{ext}(\\mathbf{r})$\n\nE) 在没有为交换相关泛函选择特定近似的情况下，无法确定该关系。", "solution": "目标是在 Kohn-Sham 密度泛函理论（DFT）形式能够得出精确基态能量的条件下，确定单电子系统中交换相关势 $v_{xc}(\\mathbf{r})$ 和 Hartree 势 $v_H(\\mathbf{r})$ 之间的关系。\n\n步骤 1：写下单电子系统的精确基态能量。\n对于只有一个电子的系统，其定态 Schrödinger 方程为：\n$$ \\left( -\\frac{\\hbar^2}{2m_e}\\nabla^2 + v_{ext}(\\mathbf{r}) \\right) \\psi(\\mathbf{r}) = E_{true} \\psi(\\mathbf{r}) $$\n真实的基态能量 $E_{true}$ 是哈密顿量的期望值，该哈密顿量仅包含动能算符 $\\hat{T}$ 和外势能算符 $\\hat{V}_{ext}$。没有电子-电子相互作用项。\n$$E_{true} = \\langle \\psi | \\hat{T} + \\hat{V}_{ext} | \\psi \\rangle$$\n\n步骤 2：写下 Kohn-Sham 能量泛函。\n如问题陈述中所给，Kohn-Sham 能量泛函为：\n$$E_{KS}[n] = T_s[n] + E_{ext}[n] + J[n] + E_{xc}[n]$$\n\n步骤 3：应用 DFT 必须精确的条件。\n问题指出，对于精确的泛函，在真实基态电子密度 $n(\\mathbf{r}) = |\\psi(\\mathbf{r})|^2$ 下计算的 Kohn-Sham 表达式的能量必须等于系统的真实能量。\n$$E_{KS}[n] = E_{true}$$\n\n步骤 4：分析单电子系统的 Kohn-Sham 泛函的各项。\n- **动能：** Kohn-Sham 动能 $T_s[n]$ 定义为一个无相互作用电子系统的动能。由于单电子系统没有其他电子与之相互作用，它本质上就是一个“无相互作用”的系统。因此，其真实动能与 Kohn-Sham 无相互作用动能相同：$T_{true} = T_s[n]$。\n- **外势能：** 与外势（原子核）的相互作用在真实系统和 Kohn-Sham 描述中是相同的：$V_{ext, true} = E_{ext}[n]$。\n\n步骤 5：将能量表达式相等并简化。\n系统的真实能量为 $E_{true} = T_{true} + V_{ext, true}$。使用步骤 4 中的等价关系，我们可以将其写为 $E_{true} = T_s[n] + E_{ext}[n]$。\n现在，我们将其与完整的 Kohn-Sham 能量表达式相等：\n$$T_s[n] + E_{ext}[n] = T_s[n] + E_{ext}[n] + J[n] + E_{xc}[n]$$\n从两边减去 $T_s[n] + E_{ext}[n]$，揭示了对剩余项的一个关键约束：\n$$0 = J[n] + E_{xc}[n]$$\n这意味着对于单电子系统，精确的交换相关能必须恰好是 Hartree 能量的负值：\n$$E_{xc}[n] = -J[n]$$\n这是一个精确的条件。Hartree 能量 $J[n]$ 代表了电子电荷密度与其自身的虚假自相互作用，这在单个电子的真实量子力学描述中是不存在的。因此，交换相关能 $E_{xc}[n]$ 必须精确地抵消这个非物理的自相互作用项。\n\n步骤 6：将能量泛函与其对应的势能关联起来。\nHartree 势 $v_H(\\mathbf{r})$ 和交换相关势 $v_{xc}(\\mathbf{r})$ 定义为它们各自的能量泛函对电子密度 $n(\\mathbf{r})$ 的泛函导数：\n$$v_H(\\mathbf{r}) = \\frac{\\delta J[n]}{\\delta n(\\mathbf{r})}$$\n$$v_{xc}(\\mathbf{r}) = \\frac{\\delta E_{xc}[n]}{\\delta n(\\mathbf{r})}$$\n对关系式 $E_{xc}[n] = -J[n]$ 关于 $n(\\mathbf{r})$ 求泛函导数，得到：\n$$\\frac{\\delta E_{xc}[n]}{\\delta n(\\mathbf{r})} = -\\frac{\\delta J[n]}{\\delta n(\\mathbf{r})}$$\n代入势的定义，我们得到最终关系：\n$$v_{xc}(\\mathbf{r}) = -v_H(\\mathbf{r})$$\n\n这个结果表明，对于单电子系统，交换相关势必须精确地抵消 Hartree 势（自相互作用势）。这确保了总的 Kohn-Sham 有效势 $v_{KS}(\\mathbf{r}) = v_{ext}(\\mathbf{r}) + v_H(\\mathbf{r}) + v_{xc}(\\mathbf{r})$ 简化为 $v_{KS}(\\mathbf{r}) = v_{ext}(\\mathbf{r})$。因此，单电子系统的 Kohn-Sham 方程在数学上变得与 Schrödinger 方程完全相同，从而正确地得出精确的能量和波函数。\n\n基于此推导，正确选项是 B。", "answer": "$$\\boxed{B}$$", "id": "1407873"}]}