{"hands_on_practices": [{"introduction": "在进行从头算化学计算时，首要任务之一是选择一个合适的基组。基组是构建分子轨道的数学函数“积木”，其选择直接影响计算的精度和成本。这个练习将探讨一个关键概念：为什么在基组中加入更高角动量的函数（例如在碳原子上加入d轨道）对于准确描述分子成键至关重要，即使这些原子的价层电子通常只占据s和p轨道。通过理解极化函数的作用 [@problem_id:1351255]，你将能更明智地为你的计算选择基组。", "problem": "在计算化学领域，从头算 (*ab initio*) 方法被用于求解分子的电子薛定谔方程。这些方法将分子轨道近似为以每个原子为中心的预定义基函数的线性组合，这一概念被称为原子轨道线性组合 (LCAO) 近似。这些函数的集合被称为基组。\n\n一名学生需要计算已知为平面构型的甲醛分子 ($\\text{CH}_2\\text{O}$) 的平衡几何构型。他们使用 Hartree-Fock 方法进行了两次计算。第一次计算使用 6-31G 基组。第二次使用 6-31G(d) 基组，该基组与 6-31G 相同，但在重原子（非氢原子）碳和氧上增加了一组 d-型极化函数。学生观察到，使用 6-31G(d) 基组的计算得到的几何构型和总能量与实验数据更加吻合。\n\n尽管基态碳原子的价壳层只包含 s 轨道和 p 轨道，但在碳原子上引入 d-型函数对于改善计算至关重要。下列哪个陈述为此提供了最准确的物理学上的合理解释？\n\nA. d-轨道对于准确描述碳原子的 1s 芯电子至关重要，因为 s 和 p 函数无法恰当地捕捉其高能特性。\n\nB. 引入 d-轨道主要是为了让模型能够描述非平面振动，这些振动虽然不是平衡结构的一部分，但对总能量很重要。\n\nC. 添加 d-轨道是为了解释电子相关性，这是一种描述电子间瞬时排斥的效应，在使用更简单的 6-31G 基组时被完全忽略了。\n\nD. d-轨道提供了必要的数学灵活性，以扭曲碳原子周围的電子密度分布，使其能够响应化学键的不对称环境而发生极化。\n\nE. d-轨道是必需的，因为甲醛中的碳原子是 $\\text{sp}^3$ 杂化的，这种构型需要 d-轨道的参与才能正确形成。", "solution": "在 Hartree-Fock 方法中，电子波函数被近似为一个由分子轨道构成的单一 Slater 行列式，其中每个分子轨道都展开为基函数的线性组合。如果基函数集为 $\\{\\chi_{\\mu}\\}$，则每个分子轨道的形式为\n$$\n\\psi_{i}(\\mathbf{r})=\\sum_{\\mu} c_{\\mu i}\\,\\chi_{\\mu}(\\mathbf{r}).\n$$\nRayleigh-Ritz 变分原理保证了扩大 $\\{\\chi_{\\mu}\\}$ 的张成空间不会使 Hartree-Fock 能量升高，即\n$$\nE_{\\text{HF}}^{\\text{6-31G(d)}} \\leq E_{\\text{HF}}^{\\text{6-31G}}.\n$$\n然而，除了能量降低这一数学事实之外，使用 6-31G(d) 基组改善几何构型和能量的物理原因在于重原子上的 d-型极化函数提供了额外的角向灵活性。\n\n甲醛中的局域电子环境是高度各向异性的：在一个平面骨架内，碳原子同时参与一个极化的 $\\text{C}=\\text{O}$ $\\pi$ 键和两个 $\\text{C}-\\text{H}$ $\\sigma$ 键。这种各向异性要求碳原子周围的电子密度 $\\rho(\\mathbf{r})$ 相对于球对称或柱对称分布发生扭曲。在基组的图像中，高斯基函数可以看作是多项式前因子 $x^{a}y^{b}z^{c}$ 乘以一个径向高斯函数 $\\exp(-\\alpha r^{2})$，其中 $a+b+c=l$ 对应于角动量 $l$。仅包含 $l=0$ (s) 和 $l=1$ (p) 会限制电子密度的角向变化。添加 $l=2$ (d) 函数提供了四极矩角向分量，有效扩大了可用于表示 $\\rho(\\mathbf{r})$ 的球谐函数 $Y_{lm}(\\theta,\\phi)$ 的张成空间。这种额外的角向灵活性使得平均场 Hartree-Fock 轨道能够响应不对称的分子场而发生极化，从而改善了对化学键的描述和平衡几何构型。\n\n这解释了为什么选项 D 是正确的：d-型函数作为极化函数，使得碳原子在化学不对称环境中的电子密度能够发生扭曲。\n\n其他选项不正确的原因如下：\n- A 是不正确的，因为 1s 芯电子由紧凑的 s-型函数描述；在第二周期原子中，描述芯电子不需要 d-型函数。\n- B 是不正确的，因为在平衡构型下，其主要好处是改善了对各向异性成键电子密度的表示，而非特指非平面振动。\n- C 是不正确的，因为 Hartree-Fock 方法在其构造中就忽略了电子相关性；添加极化函数改善了 Hartree-Fock 平均场描述，但并未包含真实的电子相关性，后者需要后 Hartree-Fock 方法或密度泛函方法来处理。\n- E 是不正确的，因为甲醛中的碳通常被描述为 $\\text{sp}^{2}$ 杂化，且第二周期原子的 $\\text{sp}^{n}$ 杂化轨道不需要 d 轨道的参与；此外，基组中 d 函数的作用是提供变分灵活性，而不是字面上的占据或与物理 d 轨道发生杂化。\n\n因此，在碳原子上引入 d 函数至关重要，因为它为各向异性成键环境中的电子密度极化提供了必要的角向灵活性，从而在 Hartree-Fock 方法框架内改善了计算得到的能量和几何构型。", "answer": "$$\\boxed{D}$$", "id": "1351255"}, {"introduction": "选择了合适的基组后，我们还需要警惕计算过程中可能出现的系统误差。当计算分子间弱相互作用能时，一个常见的“陷阱”是基组重叠误差（Basis Set Superposition Error, BSSE）。这个练习将引导你理解BSSE的来源，并应用Boys和Bernardi提出的对偶校正（counterpoise correction）方案 [@problem_id:1351245]，这是修正此类误差的标准方法。掌握这一技术对于准确预测和分析分子复合物的稳定性至关重要。", "problem": "在计算量子化学中，弱分子间相互作用（例如稀有气体二聚体中的范德华力）的计算对基组的选择高度敏感。当使用有限的、以原子为中心的基组时，一个常见的问题是基组重叠误差（Basis Set Superposition Error, BSSE）。这个误差会导致分子复合物的人为稳定，因为每个单体都可以“借用”其伙伴的基函数来改善自身的电子描述，而孤立的单体则无法获得这种效应。\n\n为了校正这个问题，由Boys和Bernardi提出的衡消（counterpoise, CP）校正方案被广泛使用。假设一个学生在固定的核间距下对氩二聚体 $Ar_2$ 进行 *ab initio*（从头算）计算。得到了以下能量：\n\n1.  $Ar_2$ 二聚体的总能量，使用两个氩原子（我们称之为 A 和 B）上的基函数计算得出：\n    $E_{Ar_2}$\n\n2.  孤立氩原子的能量，使用其自身的基组计算得出：\n    $E_{Ar}$\n\n3.  一个氩原子（A）的能量，在另一个原子（B）的基函数存在的情况下计算得出，其中 B 是一个“鬼原子”（即，其基函数存在于其二聚体位置，但其原子核和电子不存在）：\n    $E_{Ar(ghost)}$\n\n该学生想要找出氩二聚体的经BSSE校正的相互作用能 $\\Delta E_{CP}$。以下哪个表达式正确地表示了 $\\Delta E_{CP}$？\n\nA. $E_{Ar_2} - 2 E_{Ar}$\n\nB. $2(E_{Ar} - E_{Ar(ghost)})$\n\nC. $E_{Ar_2} - 2 E_{Ar(ghost)}$\n\nD. $E_{Ar_2} - 2 E_{Ar} + (E_{Ar} - E_{Ar(ghost)})$\n\nE. $E_{Ar} - E_{Ar(ghost)}$", "solution": "使用在各自基组中计算的单体，将未校正的超分子相互作用能定义为\n$$\n\\Delta E_{\\text{uncorr}} = E_{Ar_2} - 2 E_{Ar}。\n$$\n当使用有限的、以原子为中心的基组时，二聚体中的每个单体都会受益于其伙伴的基函数；这导致了基组重叠误差（BSSE）。在Boys和Bernardi的衡消（CP）校正中，通过引入鬼原子，在完整的二聚体基组中计算单体能量。将一个氩原子在另一个鬼基组存在下的能量表示为 $E_{Ar(\\text{ghost})}$。对于同核二聚体，两个单体具有相同的鬼基组能量，因此 $E_{A}^{*} = E_{B}^{*} = E_{Ar(\\text{ghost})}$。\n\nCP校正的相互作用能定义为，将相互作用能表达式中的单体能量替换为在二聚体基组中计算的值：\n$$\n\\Delta E_{CP} = E_{Ar_2} - \\left(E_{A}^{*} + E_{B}^{*}\\right) = E_{Ar_2} - 2 E_{Ar(\\text{ghost})}.\n$$\n等效地，用未校正的相互作用能和BSSE校正项表示，\n$$\n\\Delta E_{CP} = \\left(E_{Ar_2} - 2 E_{Ar}\\right) + 2\\left(E_{Ar} - E_{Ar(\\text{ghost})}\\right).\n$$\n根据这些定义，选项中正确的表达式是 $E_{Ar_2} - 2 E_{Ar(\\text{ghost})}$，这对应于选项 C。\n\n为澄清其他选项：\n- A 是未校正的相互作用能。\n- B 等于要加到 A 上的 BSSE 校正项，而不是校正后的相互作用能本身。\n- D 只将 BSSE 校正的一半加到了 A 上。\n- E 是一个单体的 BSSE 贡献，而不是完整的相互作用能。", "answer": "$$\\boxed{C}$$", "id": "1351245"}, {"introduction": "从头算方法的核心是自洽场（Self-Consistent Field, SCF）迭代过程，但这个过程有时会收敛缓慢甚至不收敛。为了解决这个实际问题，计算化学家发展了多种收敛加速算法，其中最著名和最有效的就是迭代子空间直接求逆（Direct Inversion in the Iterative Subspace, DIIS）方法。这个练习将揭开DIIS的神秘面纱，让你亲手执行一步DIIS外推计算 [@problem_id:1351239]，从而深入理解它如何利用前几步迭代的信息来“智能地”猜测一个更好的解，并最终加速收敛。", "problem": "在分子的Hartree-Fock自洽场（SCF）计算中，收敛有时可能缓慢或振荡。迭代子空间直接求逆（Direct Inversion in the Iterative Subspace, DIIS）方法是用于加速收敛的一种强大技术。它的工作原理是通过对先前迭代中的Fock矩阵进行线性组合来外推出一个新的Fock矩阵，该线性组合的选择是为了最小化一个误差度量。\n\n考虑一个在最小基组内进行的限制性Hartree-Fock计算，目前处于第 $k+1$ 次迭代。给出了最后两次迭代可用的Fock矩阵及其对应的误差向量。为简便起见，我们将它们标记为属于DIIS子空间的第1次和第2次迭代。\n\nFock矩阵为：\n$$\n\\mathbf{F}_1 = \\begin{pmatrix} -1.20  0.40 \\\\ 0.40  -0.80 \\end{pmatrix}\n\\quad \\text{和} \\quad\n\\mathbf{F}_2 = \\begin{pmatrix} -1.10  0.50 \\\\ 0.50  -0.90 \\end{pmatrix}\n$$\n\n相应的误差向量（其本身也是矩阵）在此问题中定义为 $\\mathbf{e}_i$：\n$$\n\\mathbf{e}_1 = \\begin{pmatrix} 0.0  -0.10 \\\\ 0.10  0.0 \\end{pmatrix}\n\\quad \\text{和} \\quad\n\\mathbf{e}_2 = \\begin{pmatrix} 0.0  0.20 \\\\ -0.20  0.0 \\end{pmatrix}\n$$\n\nDIIS过程通过先前矩阵的线性组合找到一个外推的Fock矩阵 $\\mathbf{F}_{\\text{DIIS}}$：\n$$\n\\mathbf{F}_{\\text{DIIS}} = \\sum_{i=1}^{m} c_i \\mathbf{F}_i\n$$\n其中 $m$ 是所考虑的先前迭代的次数（在本例中为 $m=2$）。系数 $c_i$ 通过求解以下线性方程组来确定，该方程组在约束条件 $\\sum_{i=1}^{m} c_i = 1$ 下最小化误差向量组合 $\\sum_{i=1}^{m} c_i \\mathbf{e}_i$ 的范数：\n$$\n\\begin{pmatrix}\nB_{11}  \\dots  B_{1m}  -1 \\\\\n\\vdots  \\ddots  \\vdots  \\vdots \\\\\nB_{m1}  \\dots  B_{mm}  -1 \\\\\n1  \\dots  1  0\n\\end{pmatrix}\n\\begin{pmatrix}\nc_1 \\\\\n\\vdots \\\\\nc_m \\\\\n\\lambda\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\\n\\vdots \\\\\n0 \\\\\n1\n\\end{pmatrix}\n$$\n这里，矩阵元素由误差向量乘积的迹给出，$B_{ij} = \\text{Tr}(\\mathbf{e}_i^\\text{T} \\mathbf{e}_j)$，而 $\\lambda$ 是归一化约束的拉格朗日乘子。\n\n使用最近两次迭代的给定数据，计算新的外推Fock矩阵的非对角元素 $(\\mathbf{F}_{\\text{DIIS}})_{12}$ 的值。报告你的答案，并四舍五入至三位有效数字。", "solution": "我们使用DIIS的定义，其中误差内积为 $B_{ij}=\\text{Tr}(\\mathbf{e}_{i}^{\\text{T}}\\mathbf{e}_{j})$。对于给定的误差矩阵\n$$\n\\mathbf{e}_1=\\begin{pmatrix}0  -0.10 \\\\ 0.10  0\\end{pmatrix},\\quad\n\\mathbf{e}_2=\\begin{pmatrix}0  0.20 \\\\ -0.20  0\\end{pmatrix},\n$$\n弗罗贝尼乌斯内积为：\n$$\nB_{11}=\\text{Tr}(\\mathbf{e}_1^{\\text{T}}\\mathbf{e}_1)=0^{2}+(-0.10)^{2}+(0.10)^{2}+0^{2}=0.02,\n$$\n$$\nB_{22}=\\text{Tr}(\\mathbf{e}_2^{\\text{T}}\\mathbf{e}_2)=0^{2}+(0.20)^{2}+(-0.20)^{2}+0^{2}=0.08,\n$$\n$$\nB_{12}=B_{21}=\\text{Tr}(\\mathbf{e}_1^{\\text{T}}\\mathbf{e}_2)=0\\cdot 0+(-0.10)\\cdot 0.20+(0.10)\\cdot(-0.20)+0\\cdot 0=-0.04.\n$$\n关于 $c_{1},c_{2}$ 和拉格朗日乘子 $\\lambda$ 的DIIS线性系统是\n$$\n\\begin{pmatrix}\n0.02  -0.04  -1 \\\\\n-0.04  0.08  -1 \\\\\n1  1  0\n\\end{pmatrix}\n\\begin{pmatrix}\nc_{1} \\\\ c_{2} \\\\ \\lambda\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\ 0 \\\\ 1\n\\end{pmatrix}.\n$$\n根据前两个方程，\n$$\n0.02c_{1}-0.04c_{2}-\\lambda=0,\\qquad -0.04c_{1}+0.08c_{2}-\\lambda=0,\n$$\n因此消去 $\\lambda$ 得到\n$$\n0.02c_{1}-0.04c_{2}=-0.04c_{1}+0.08c_{2}\\;\\Rightarrow\\;0.06c_{1}=0.12c_{2}\\;\\Rightarrow\\;c_{1}=2c_{2}.\n$$\n使用归一化约束 $c_{1}+c_{2}=1$，我们得到\n$$\n2c_{2}+c_{2}=1\\;\\Rightarrow\\;c_{2}=\\frac{1}{3},\\quad c_{1}=\\frac{2}{3}.\n$$\n外推的Fock矩阵为 $\\mathbf{F}_{\\text{DIIS}}=c_{1}\\mathbf{F}_{1}+c_{2}\\mathbf{F}_{2}$。其非对角元素为\n$$\n(\\mathbf{F}_{\\text{DIIS}})_{12}=c_{1}(\\mathbf{F}_{1})_{12}+c_{2}(\\mathbf{F}_{2})_{12}\n=\\frac{2}{3}\\cdot 0.40+\\frac{1}{3}\\cdot 0.50=\\frac{1.30}{3}=0.433333\\ldots,\n$$\n四舍五入至三位有效数字后为 $0.433$。", "answer": "$$\\boxed{0.433}$$", "id": "1351239"}]}