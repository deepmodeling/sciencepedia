{"hands_on_practices": [{"introduction": "虽然混合泛函通常能提供比广义梯度近似（GGA）等纯泛函更高的精度，但这种提升是有代价的：计算成本显著增加。本练习旨在量化这种成本差异。我们将通过一个实际案例，探讨GGA和混合泛函的计算时间如何随体系大小（以基函数数量衡量）而变化，这是规划任何计算化学研究时都必须考虑的关键因素。[@problem_id:1373556]", "problem": "一个计算化学研究小组正在研究一系列新合成的聚合物链的电子性质。在进行大规模研究之前，他们对一个小的单体单元进行了基准计算，以比较不同理论方法的计算成本。该单体系统使用由 $N_{small} = 400$ 个基函数组成的基组来描述。\n\n该小组对这个单体进行了两次单点能计算：\n1.  使用广义梯度近似 (GGA) 泛函，计算耗时 $T_{GGA, small} = 5.00$ 分钟完成。\n2.  使用混合泛函，其中包含一部分精确的 Hartree-Fock (HF) 交换，计算耗时 $T_{Hybrid, small} = 24.0$ 分钟完成。\n\n对于所研究的这类分子和所使用的软件，已知 GGA 计算的计算时间大约与基函数数量的立方 ($N^3$) 成正比，而混合泛函计算的时间主要由精确交换部分决定，与基函数数量的四次方 ($N^4$) 成正比。\n\n该小组现在希望研究该系列中一个更大的低聚物，这需要一个包含 $N_{large} = 2000$ 个基函数的基组。根据基准测试结果和已知的标度行为，计算这个更大体系中混合泛函与 GGA 泛函的计算时间之比，即 $T_{Hybrid, large} / T_{GGA, large}$。\n\n将您的最终答案四舍五入到三位有效数字。", "solution": "设 GGA 的时间标度为 $T_{\\mathrm{GGA}}(N)=A N^{3}$，混合泛函的时间标度为 $T_{\\mathrm{Hybrid}}(N)=B N^{4}$，其中 $A$ 和 $B$ 是依赖于方法和代码的比例因子。\n\n根据小体系（基函数数量为 $N_{\\mathrm{small}}$）的基准测试结果，\n$$\nA=\\frac{T_{\\mathrm{GGA,small}}}{N_{\\mathrm{small}}^{3}},\\qquad B=\\frac{T_{\\mathrm{Hybrid,small}}}{N_{\\mathrm{small}}^{4}}.\n$$\n对于大体系（基函数数量为 $N_{\\mathrm{large}}$），其时间比为\n$$\n\\frac{T_{\\mathrm{Hybrid,large}}}{T_{\\mathrm{GGA,large}}}\n=\\frac{B N_{\\mathrm{large}}^{4}}{A N_{\\mathrm{large}}^{3}}\n=\\frac{B}{A}N_{\\mathrm{large}}\n=\\left(\\frac{T_{\\mathrm{Hybrid,small}}/N_{\\mathrm{small}}^{4}}{T_{\\mathrm{GGA,small}}/N_{\\mathrm{small}}^{3}}\\right) N_{\\mathrm{large}}\n=\\left(\\frac{T_{\\mathrm{Hybrid,small}}}{T_{\\mathrm{GGA,small}}}\\right)\\left(\\frac{N_{\\mathrm{large}}}{N_{\\mathrm{small}}}\\right).\n$$\n代入给定值 $T_{\\mathrm{Hybrid,small}}=24.0$，$T_{\\mathrm{GGA,small}}=5.00$，$N_{\\mathrm{large}}=2000$ 和 $N_{\\mathrm{small}}=400$，\n$$\n\\frac{T_{\\mathrm{Hybrid,large}}}{T_{\\mathrm{GGA,large}}}\n=\\left(\\frac{24.0}{5.00}\\right)\\left(\\frac{2000}{400}\\right)=4.8\\times 5=24.0.\n$$\n四舍五入到三位有效数字，结果是 $24.0$。", "answer": "$$\\boxed{24.0}$$", "id": "1373556"}, {"introduction": "了解了计算成本的权衡之后，我们来探讨混合泛函的核心优势之一。本练习将深入研究“离域误差”这一概念，它源于近似泛函对分数电子数体系能量描述的偏差。你将通过定量计算，比较GGA和混合泛函在描述氯原子获得一个电子的过程中的表现，从而理解为何混合泛函能提供更符合物理真实的描述，这也是其性能更优越的关键原因之一。[@problem_id:1373539]", "problem": "在密度泛函理论（DFT）中，体系的总能量作为电子数 $N$ 的函数 $E(N)$，理想情况下应为分段线性函数，并在整数电子数处存在突折。然而，许多近似的交换关联泛函，例如基于广义梯度近似（GGA）的泛函，表现出一种虚假的凸性。这种“离域误差”人为地偏好分离片段上的分数电子数。包含一部分精确交换的混合泛函通常会减小这种误差。\n\n考虑一个氯（Cl）单原子。对于 $N \\in [17, 18]$ 范围内的分数电子数，设电子数表示为 $N = 17 + \\delta$，其中 $\\delta \\in [0, 1]$。我们将GGA泛函和混合泛函计算的总能量建模如下：\n$$E_{\\text{GGA}}(17+\\delta) = (1-\\delta)E(17) + \\delta E(18) - C_{\\text{GGA}}\\delta(1-\\delta)$$\n$$E_{\\text{hyb}}(17+\\delta) = (1-\\delta)E(17) + \\delta E(18) - C_{\\text{hyb}}\\delta(1-\\delta)$$\n其中，$E(17)$ 和 $E(18)$ 分别是中性Cl原子和Cl$^{-}$阴离子的精确总能量。正常数 $C_{\\text{GGA}}$ 和 $C_{\\text{hyb}}$ 量化了每种泛函的凸性，即离域误差的严重程度。\n\n这些参数的值如下：\n- 中性氯原子的能量，$E(17) = -459.642 \\text{ Hartree}$\n- 氯阴离子的能量，$E(18) = -459.775 \\text{ Hartree}$\n- GGA凸性参数，$C_{\\text{GGA}} = 0.210 \\text{ Hartree}$\n- 混合泛函凸性参数，$C_{\\text{hyb}} = 0.055 \\text{ Hartree}$\n\n现在，考虑一个由两个相同且无相互作用的氯原子组成的体系。如果向这个双原子体系添加一个电子，正确的基态对应于电子定域在其中一个原子上，形成一个 [Cl, Cl$^-$] 对。然而，由于离域误差，一种近似泛函可能会错误地预测一个能量更低的状态，在该状态下，电子离域在两个原子上，从而形成一个 [Cl$^{-0.5}$, Cl$^{-0.5}$] 体系。\n\n计算GGA泛函与混合泛函的虚假离域稳定化能的比值。虚假离域稳定化能定义为离域态 [Cl$^{-0.5}$, Cl$^{-0.5}$] 的能量减去正确定域态 [Cl, Cl$^-$] 的能量。将最终答案四舍五入到三位有效数字。", "solution": "对于一个 $N=17+\\delta$ 的单原子，由凸性参数 $C$ 表征的给定泛函所计算的近似能量为\n$$\nE_{\\text{fun}}(17+\\delta)=(1-\\delta)E(17)+\\delta E(18)-C\\,\\delta(1-\\delta).\n$$\n对于两个带有一个额外电子的无相互作用的氯原子，定域态 [Cl, Cl$^{-}$] 中一个原子处于 $\\delta=0$，另一个处于 $\\delta=1$，因此其总能量为\n$$\nE_{\\text{loc}}=E_{\\text{fun}}(17)+E_{\\text{fun}}(18)=E(17)+E(18).\n$$\n离域态 [Cl$^{-0.5}$, Cl$^{-0.5}$] 中每个原子都处于 $\\delta=\\frac{1}{2}$，其单个原子的能量为\n$$\nE_{\\text{fun}}(17+\\tfrac{1}{2})=\\tfrac{1}{2}E(17)+\\tfrac{1}{2}E(18)-C\\left(\\tfrac{1}{2}\\right)\\left(1-\\tfrac{1}{2}\\right)=\\tfrac{1}{2}E(17)+\\tfrac{1}{2}E(18)-\\tfrac{C}{4}.\n$$\n因此，离域态的总能量为\n$$\nE_{\\text{deloc}}=2E_{\\text{fun}}(17+\\tfrac{1}{2})=E(17)+E(18)-\\tfrac{C}{2}.\n$$\n因此，虚假离域稳定化能（离域态能量减去定域态能量）为\n$$\n\\Delta E_{\\text{fun}}=E_{\\text{deloc}}-E_{\\text{loc}}=-\\tfrac{C}{2}.\n$$\n因此，GGA与混合泛函的稳定化能之比为\n$$\nR=\\frac{\\Delta E_{\\text{GGA}}}{\\Delta E_{\\text{hyb}}}=\\frac{-\\tfrac{C_{\\text{GGA}}}{2}}{-\\tfrac{C_{\\text{hyb}}}{2}}=\\frac{C_{\\text{GGA}}}{C_{\\text{hyb}}}.\n$$\n代入给定值，\n$$\nR=\\frac{0.210}{0.055}=\\frac{210}{55}=\\frac{42}{11}\\approx 3.81818\\ldots\n$$\n四舍五入到三位有效数字，结果是 $3.82$。", "answer": "$$\\boxed{3.82}$$", "id": "1373539"}, {"introduction": "混合泛函不仅能修正体系的基态能量，还能改善对其他电子性质的描述，例如电子自旋。本练习将探讨在开壳层分子计算中普遍存在的“自旋污染”问题。通过本题的计算，你将理解引入精确交换成分如何帮助我们获得一个具有更清晰物理意义的自旋态波函数。[@problem_id:1373583]", "problem": "在对噻吩自由基阳离子（$C_4H_4S^+$），一个开壳层双重态体系的计算研究中，其电子结构采用非限制性Kohn-Sham (UKS) 形式理论进行建模。在该方法中，α-自旋和β-自旋轨道被独立处理。对于该自由基阳离子的基态，有 $N_\\alpha = 22$ 个α电子和 $N_\\beta = 21$ 个β电子。\n\n非限制性方法的一个已知问题是自旋污染，即计算得到的自旋平方算符 $\\hat{S}^2$ 的本征态不是一个纯自旋态。计算得到的期望值 $\\langle S^2 \\rangle$ 会偏离其精确的理论值 $S(S+1)$，其中 $S$ 是总自旋量子数。自旋污染的程度 $\\Delta S^2$ 定义为该偏差：$\\Delta S^2 = \\langle S^2 \\rangle - S(S+1)$。对于UKS计算，该污染由表达式 $\\Delta S^2 = N_\\beta - \\mathcal{O}$ 给出，其中 $\\mathcal{O}$ 表示α和β空间轨道集之间的总平方重叠。\n\n首先，使用纯广义梯度近似 (GGA) 泛函进行了一次计算。该计算得到的总轨道平方重叠为 $\\mathcal{O}_{GGA} = 20.315$。\n\n接下来，使用杂化泛函进行了第二次计算。该泛函通过混合一定比例 $a_{HF}$ 的精确Hartree-Fock交换，对纯GGA泛函进行了改进。对于所使用的杂化泛函，其 $a_{HF} = 0.25$。已知引入精确交换可以减少自旋污染。对于噻吩自由基阳离子，一个计算模型表明自旋污染会根据关系式 $\\Delta S^2_{hybrid} = \\Delta S^2_{GGA} \\times (1 - a_{HF}^{1/3})$ 减少。\n\n利用这些信息，计算通过杂化泛函计算得到的期望值 $\\langle S^2 \\rangle$。将最终答案四舍五入至三位有效数字。", "solution": "对于一个具有 $N_{\\alpha}=22$ 和 $N_{\\beta}=21$ 的非限制性Kohn-Sham双重态，其总自旋为 $S=\\frac{N_{\\alpha}-N_{\\beta}}{2}=\\frac{1}{2}$，因此精确的自旋期望值为\n$$\nS(S+1)=\\frac{3}{4}=0.75.\n$$\n在UKS计算中，自旋污染定义为 $\\Delta S^{2}=\\langle S^{2}\\rangle - S(S+1)$，并且对于某次特定的计算，它由下式给出\n$$\n\\Delta S^{2}=N_{\\beta}-\\mathcal{O}.\n$$\n对于GGA计算结果，$\\mathcal{O}_{GGA}=20.315$，\n$$\n\\Delta S^{2}_{GGA}=N_{\\beta}-\\mathcal{O}_{GGA}=21-20.315=0.685.\n$$\n对于杂化泛函，$a_{HF}=0.25$，模型给出\n$$\n\\Delta S^{2}_{hybrid}=\\Delta S^{2}_{GGA}\\left(1-a_{HF}^{1/3}\\right)=0.685\\left(1-0.25^{1/3}\\right).\n$$\n计算 $0.25^{1/3}=4^{-1/3}\\approx 0.6299605249$，我们得到\n$$\n\\Delta S^{2}_{hybrid}\\approx 0.685\\times 0.3700394751\\approx 0.2534770404.\n$$\n因此，杂化泛函计算的期望值为\n$$\n\\langle S^{2}\\rangle_{hybrid}=S(S+1)+\\Delta S^{2}_{hybrid}\\approx 0.75+0.2534770404\\approx 1.0034770404.\n$$\n四舍五入到三位有效数字得到 $1.00$。", "answer": "$$\\boxed{1.00}$$", "id": "1373583"}]}