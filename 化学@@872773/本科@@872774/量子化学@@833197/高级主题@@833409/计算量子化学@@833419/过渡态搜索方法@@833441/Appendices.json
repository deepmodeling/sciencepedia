{"hands_on_practices": [{"introduction": "在计算化学中，仅仅找到势能面上的一个驻点（梯度为零的点）是不够的。我们必须对其进行表征，以确定它是一个能量极小点（如反应物或产物）还是一个鞍点（过渡态）。本练习 [@problem_id:1419207] 将引导你运用验证过渡态最明确的计算判据：简正振动模式的特征。理解这一特征是正确解读反应机理的第一步。", "problem": "一位计算化学专业的学生正在研究将氰化氢（HCN）转化为异氰化氢（HNC）的异构化反应。使用量子力学方法，该学生在这个三原子体系的势能面（PES）上找到了三个不同的驻点。对每个驻点都进行了振动频率分析。计算得到的谐振频率组如下所列。根据所用软件的惯例，由负的力常数产生的虚频被报告为负实数。\n\n- **A组：** {-1268, 676, 2182} 单位 $\\text{cm}^{-1}$\n- **B组：** {713, 713, 2097, 3311} 单位 $\\text{cm}^{-1}$\n- **C组：** {464, 464, 2029, 3653} 单位 $\\text{cm}^{-1}$\n\n根据计算化学中表征势能面上各点的基本原理，请确定哪一组频率对应于该异构化反应的过渡态结构。\n\nA. A组\n\nB. B组\n\nC. C组\n\nD. B组和C组都代表过渡态。\n\nE. 没有一组代表过渡态。", "solution": "该问题要求我们从三组给定的振动频率中，找出HCN到HNC异构化反应的过渡态。这一识别过程依赖于对势能面（PES）上驻点如何被表征的理解。\n\n势能面上的驻点是指每个原子上的净力均为零的几何构型，这意味着能量对所有原子坐标的一阶导数均为零。这些点可以是能量极小点（反应物、产物或稳定中间体）或鞍点（过渡态）。\n\n为了区分这些类型的驻点，必须检查该点处势能面的曲率，这由能量的二阶导数描述。这些二阶导数构成一个称为Hessian矩阵的矩阵。(质量加权的)Hessian矩阵的本征值与分子的振动频率相关。具体来说，振动频率 $\\nu_i$ 与相应Hessian本征值 $\\lambda_i$ 的平方根成正比。\n\n对于一个稳定分子（对应于势能面上的一个能量极小点），任何原子的微小位移都必须导致势能增加。这意味着势能面在所有方向上都是向上“弯曲”的。在数学上，这要求Hessian矩阵的所有本征值都为正。因此，所有的振动频率都将是正实数。\n\n对于一个过渡态（它是一个一阶鞍点），其结构对应于沿且仅沿一个方向（反应坐标）的能量极大值，以及沿所有其他垂直方向的能量极小值。这种独特的数学性质意味着过渡态的Hessian矩阵有且仅有一个负本征值，而所有其他本征值均为正。\n\n由于振动频率与本征值的平方根有关，一个负本征值 $\\lambda_k  0$ 会导致一个虚频率，$\\nu_k \\propto \\sqrt{\\lambda_k} = i\\sqrt{|\\lambda_k|}$。如问题中所述，计算化学程序通常将这些虚频报告为负实数。\n\n因此，一阶鞍点（即过渡态）的明确标志是存在且仅存在一个虚（报告为负数）振动频率。\n\n现在，我们来分析给定的几组频率：\n\n- **A组：** {-1268, 676, 2182} $\\text{cm}^{-1}$。该组包含一个负频率（-1268 $\\text{cm}^{-1}$）和两个正频率。存在且仅存在一个负频率是过渡态的特征标志。这表明该结构在反应坐标方向上（对应于-1268 $\\text{cm}^{-1}$的振动模式）是能量极大值，而在所有其他振动坐标方向上是能量极小值。\n\n- **B组：** {713, 713, 2097, 3311} $\\text{cm}^{-1}$。该组中的所有频率均为正数。这表明相应的结构是势能面上的一个能量极小点，代表一个稳定物种（反应物HCN或产物HNC）。\n\n- **C组：** {464, 464, 2029, 3653} $\\text{cm}^{-1}$。该组中的所有频率也均为正数。与B组一样，这对应于势能面上的一个能量极小点，代表反应中的另一个稳定物种。\n\n基于此分析，只有A组表现出过渡态所需的特征。另外两组，B组和C组，代表了对应于反应物和产物的稳定能量极小点。", "answer": "$$\\boxed{A}$$", "id": "1419207"}, {"introduction": "确认一个结构是过渡态（即具有且仅具有一个虚频）后，下一个关键问题是：它对应于何种物理过程？一个过渡态可能代表着键的断裂与形成（化学反应），也可能仅仅是分子内部的旋转（构象变化）。本练习 [@problem_id:2466332] 将挑战你超越简单地计数虚频，去深入分析与虚频相关联的振动本征向量，这是区分不同类型过渡过程的核心技能。", "problem": "一名高年级本科研究者使用线性同步转换（LST）和二次同步转换（QST）方法生成过渡态（TS）的初始猜测结构，然后在一个由核坐标 $\\mathbf{R}$ 的电子能量函数 $E(\\mathbf{R})$ 给出的光滑势能面（PES）上，通过特征向量跟随法对其进行优化。在假定的过渡态位置进行了频率计算，得到了简正模式频率和质量加权的笛卡尔坐标特征向量。由于资源有限，无法计算内禀反应坐标（IRC）。仅使用势能面上驻点的定义、Hessian矩阵以及简正模式的物理意义，请判断哪个标准能最好地区分真正的化学反应过渡态（涉及成键连接性改变）和构象过渡态（主要由内旋转主导，连接性保持不变），且只使用频率计算的输出结果。\n\n在这些限制条件下，以下哪一项是最可靠和最通用的程序？\n\nA. 要求恰好有 $1$ 个虚频，且其大小超过 $500\\,\\mathrm{cm}^{-1}$；如果两个条件都满足，则该过渡态是化学反应过渡态而非构象过渡态。\n\nB. 检查与单个虚频相关的质量加权特征向量，并将其投影到内坐标上；如果该模式主要由键伸缩组分主导，并显著改变了预期形成或断裂化学键的原子间的距离，则将其归类为化学反应过渡态；如果它主要由二面角（扭转）组分主导，且键长几乎保持不变，则将其归类为构象过渡态。\n\nC. 通过二次同步转换（QST）或线性同步转换（LST）扫描验证路径是否经过此点；如果经过，则该过渡态是化学反应过渡态，否则是构象过渡态。\n\nD. 确认Hessian指数为 $1$（恰好有 $1$ 个负特征值）；仅此一点即可保证是化学反应过渡态，而非构象过渡态。", "solution": "问题要求找到一个最可靠的标准，用以区分化学反应过渡态（TS）和构象过渡态，且仅使用在假定驻点上进行的频率计算的输出结果。该驻点是使用特征向量跟随法，在势能面（PES）$E(\\mathbf{R})$上定位的，其初始猜测结构由线性同步转换（LST）或二次同步转换（QST）生成。内禀反应坐标（IRC）计算无法进行。\n\n一个过渡态，无论是化学反应类型还是构象类型，在数学上都定义为势能面上的一个一阶鞍点。这意味着能量对核坐标 $\\mathbf{R}$ 的梯度为零，$\\nabla E(\\mathbf{R}) = \\mathbf{0}$，并且Hessian矩阵 $H_{ij} = \\frac{\\partial^2 E}{\\partial R_i \\partial R_j}$ 恰好有一个负特征值。Hessian指数为 $1$。\n\n频率计算涉及对质量加权的Hessian矩阵进行对角化。该矩阵的特征值 $\\lambda_k$ 与简正模式振动频率 $\\nu_k$ 相关。一个负特征值 $\\lambda_k  0$ 对应一个虚频，因为 $\\nu_k \\propto \\sqrt{\\lambda_k}$。因此，任何有效的过渡态都必须表现出恰好一个虚频。与该虚频对应的特征向量，被称为过渡向量，描述了在过渡态处沿反应坐标的原子位移。\n\n这两种过渡态之间的根本区别在于这种运动的性质：\n1.  **化学反应过渡态** 涉及化学键的断裂和/或形成。因此，沿反应坐标的运动必须对应于形成或断裂化学键的原子间距离的显著变化。在反应过程中，分子的成键连接性发生改变。\n2.  **构象过渡态** 涉及保持化学键不变的重排，例如围绕单键的旋转。沿反应坐标的运动主要由二面角（扭转角）的变化主导，而键长和键角基本保持不变。\n\n任务是评估哪个选项提供了最可靠的程序来做出这种区分，且仅依据频率计算的数据（频率和特征向量）。\n\nA. **要求恰好有 $1$ 个虚频，且其大小超过 $500\\,\\mathrm{cm}^{-1}$；如果两个条件都满足，则该过渡态是化学反应过渡态而非构象过渡态。**\n该标准包含两部分。第一部分，要求恰好有 $1$ 个虚频，是*任何*一阶鞍点的必要条件。它确认了该驻点是一个过渡态，但并不能区分它是化学反应过渡态还是构象过渡态。第二部分使用了虚频的大小 $|\\nu_{imag}|$，并设定了 $500\\,\\mathrm{cm}^{-1}$ 的阈值。虽然人们普遍观察到，键的断裂/形成过程通常具有高能垒，因此虚频的绝对值也较大，而构象变化通常能垒较低，虚频绝对值也较小，但这仅仅是一种相关性，并非严格的规则。一些容易进行的化学反应（例如，某些质子或氢负离子转移）可能具有低能垒和相应的小虚频（例如，$500\\,\\mathrm{cm}^{-1}$）。反之，一个空间位阻很大的旋转可能具有足够高的能垒，产生超过 $500\\,\\mathrm{cm}^{-1}$ 的虚频。$500\\,\\mathrm{cm}^{-1}$ 这个值的选择是任意的，没有基于任何基本原理。因此，这个标准不具有普遍性或可靠性。\n**结论：不正确。**\n\nB. **检查与单个虚频相关的质量加权特征向量，并将其投影到内坐标上；如果该模式主要由键伸缩组分主导，并显著改变了预期形成或断裂化学键的原子间的距离，则将其归类为化学反应过渡态；如果它主要由二面角（扭转）组分主导，且键长几乎保持不变，则将其归类为构象过渡态。**\n该程序解决了两种过程之间根本的物理差异。虚频的特征向量直接代表了使系统“翻越”能垒“山丘”的运动。通过分析这个向量，可以确定反应过程中结构上发生了什么。\n- 如果分析（可以通过可视化或通过到内坐标上的形式投影来完成）表明，主导运动是键被拉伸至断裂点，或是两个未成键原子被压缩至新的键长，那么根据定义，这是一个化学反应。\n- 如果分析表明，主导运动是二面角（扭转角）的变化，而键长保持不变，那么根据定义，这是一个构象变化。\n这种方法直接与过渡向量的物理意义相关联，不依赖于任意的数值截断。这是计算化学中用来表征过渡态性质的标准且最严谨的程序。\n**结论：正确。**\n\nC. **通过二次同步转换（QST）或线性同步转换（LST）扫描验证路径是否经过此点；如果经过，则该过渡态是化学反应过渡态，否则是构象过渡态。**\n这个选项包含有缺陷的逻辑。LST和QST是生成路径和过渡态初始猜测的方法。它们既可以应用于化学反应（连接反应物和产物），也可以应用于构象变化（连接两个构象异构体）。因此，从LST/QST猜测开始找到一个过渡态这一事实，并不能提供任何信息来区分其类型。人们可以使用QST2方法，以一个反应物构象和一个产物构象为输入，来寻找一个构象过渡态的猜测结构。因此，声称以这种方式找到的过渡态*必然*是化学反应过渡态的说法是错误的。此外，问题将分析限制在频率计算的输出。这个选项追溯到路径生成方法，而这不属于所要求的分析范围。\n**结论：不正确。**\n\nD. **确认Hessian指数为 $1$（恰好有 $1$ 个负特征值）；仅此一点即可保证是化学反应过渡态，而非构象过渡态。**\n这种说法从根本上是错误的。Hessian指数为 $1$ 的条件（等同于恰好有一个虚频）是一阶鞍点的数学定义。化学反应过渡态和构象过渡态都是一阶鞍点。因此，这两种类型的过渡态都必须满足这个条件。它用于验证该结构是一个过渡态，但完全没有提供区分这两类的辨别力。声称这个条件*本身就能保证*是化学反应过渡态的断言是错误的。\n**结论：不正确。**", "answer": "$$\\boxed{B}$$", "id": "2466332"}, {"introduction": "理论学习的最终目的是应用于实践。本练习 [@problem_id:2466338] 旨在通过一个编码任务，将抽象的过渡态搜索概念具体化。你将为一个简单的解析势能面函数实现线性同步转变（LST）方法，这是一种生成反应路径和过渡态初始猜测的常用技术。通过这个练习，你将亲手实现寻找路径能量最大点的过程，并应用前面学到的Hessian矩阵分析方法来表征该点，从而完整体验从路径生成到过渡态分析的简化工作流程。", "problem": "给定两个解析的二维势能面（PES）和一组以笛卡尔坐标表示的端点对。对于每对端点，将连接端点的直线插值定义为线性同步转变（LST）路径，并确定在该路径上势能面达到其最大值的点。具体而言，对于起始点 $\\mathbf{A} = (x_0,y_0)$ 和终点 $\\mathbf{B} = (x_1,y_1)$，设路径为 $\\mathbf{r}(t) = \\mathbf{A} + t(\\mathbf{B}-\\mathbf{A})$，其中 $t \\in [0,1]$。对于每个测试用例，找到使 $E(\\mathbf{r}(t))$ 最大化的值 $t^\\star \\in [0,1]$，计算相应的能量 $E(\\mathbf{r}(t^\\star))$，并通过在点 $\\mathbf{r}(t^\\star)$ 处的 $E$ 的 Hessian 矩阵的负特征值数量 $m$ 对该点进行分类。这种分类与特征向量跟随方法中使用的一阶鞍点概念相关。报告 $t^\\star$ 和 $E(\\mathbf{r}(t^\\star))$，四舍五入到六位小数，以及整数 $m$。\n\n背景定义：\n- 线性同步转变（LST）是由两个结构之间的直线插值定义的路径。\n- 二次同步转变（QST）使用由两个端点和一个可选猜测点约束的二次插值。\n- 特征向量跟随是一种利用 Hessian 矩阵的特征结构来收敛到过渡态的方法，对于势能面上的一个一阶过渡态，它是一个其 Hessian 矩阵恰好有一个负特征值的驻点。\n\n所使用的势能面函数为：\n1. $E_a(x,y;\\alpha,\\beta,\\gamma,\\delta) = \\left(x^2 - 1\\right)^2 + \\alpha y^2 + \\beta x y + \\gamma x + \\delta y$。\n2. $E_b(x,y) = x^2 + \\left(y^2 - 1\\right)^2$。\n\n设 Hessian 矩阵为 $E(x,y)$ 关于 $(x,y)$ 的二阶偏导数矩阵，并设 $m$ 为在所考虑点处 Hessian 矩阵的严格负特征值的数量。\n\n精度和输出要求：\n- 在 $t \\in [0,1]$ 上确定 $E(\\mathbf{r}(t))$ 的全局最大化子 $t^\\star$，其在 $t$ 上的绝对精度为 $10^{-6}$（通过任何数学上有效的方法达到此精度均可接受）。\n- 计算 $E(\\mathbf{r}(t^\\star))$，绝对精度至少为 $10^{-8}$。\n- 精确计算 $m$ 作为负特征值的数量（仅将小于 $-10^{-8}$ 的特征值计为负值）。\n- 最终输出格式：单行输出，包含一个由方括号括起来的逗号分隔的扁平数字列表。对于每个测试用例，输出三元组 $[t^\\star, E(\\mathbf{r}(t^\\star)), m]$，其中 $t^\\star$ 和 $E(\\mathbf{r}(t^\\star))$ 各自四舍五入到六位小数，$m$ 为整数，并按顺序连接这些三元组。例如，对于两个测试用例，输出将如下所示：$[t_1^\\star,E_1^\\star,m_1,t_2^\\star,E_2^\\star,m_2]$。\n\n测试套件（按此顺序评估）：\n- 用例 1：$E_a$，参数为 $(\\alpha,\\beta,\\gamma,\\delta) = (1,0,0,0)$；$\\mathbf{A} = (-1,0)$；$\\mathbf{B} = (1,0)$。\n- 用例 2：$E_a$，参数为 $(\\alpha,\\beta,\\gamma,\\delta) = (1,0,0,0)$；$\\mathbf{A} = (-1,0)$；$\\mathbf{B} = (-2,0)$。\n- 用例 3：$E_a$，参数为 $(\\alpha,\\beta,\\gamma,\\delta) = (1,0.4,0,0)$；$\\mathbf{A} = (-1,0.5)$；$\\mathbf{B} = (1,-0.5)$。\n- 用例 4：$E_b$；$\\mathbf{A} = (0,-1)$；$\\mathbf{B} = (0,1)$。\n- 用例 5：$E_a$，参数为 $(\\alpha,\\beta,\\gamma,\\delta) = (1,0,0,0)$；$\\mathbf{A} = (2,0)$；$\\mathbf{B} = (1,0)$。\n\n您的程序应生成单行输出，其中包含按测试用例确切顺序排列的结果，格式为方括号括起来的逗号分隔列表：$[t_1^\\star,E_1^\\star,m_1,t_2^\\star,E_2^\\star,m_2,t_3^\\star,E_3^\\star,m_3,t_4^\\star,E_4^\\star,m_4,t_5^\\star,E_5^\\star,m_5]$。本问题中不需要物理单位。", "solution": "所述问题是有效的。它在科学上基于计算化学的原理，特别是势能面（PES）的探索。该问题是适定的，提供了所有必要的数学定义、函数和参数，以得出一个唯一的、可验证的解。语言客观，要求明确。因此，我们可以着手求解。\n\n问题的核心是在指定的线性路径段上找到给定二维势能函数 $E(x,y)$ 的最大值。这条路径被称为线性同步转变（LST）路径，它连接起始分子构型 $\\mathbf{A}$ 和终末分子构型 $\\mathbf{B}$。\n\n设起始点为 $\\mathbf{A} = (x_0, y_0)$，终点为 $\\mathbf{B} = (x_1, y_1)$。LST 路径 $\\mathbf{r}(t)$ 通过标量 $t \\in [0,1]$ 进行参数化，作为线性插值：\n$$\n\\mathbf{r}(t) = \\mathbf{A} + t(\\mathbf{B} - \\mathbf{A}) = (1-t)\\mathbf{A} + t\\mathbf{B}\n$$\n路径的分量由以下公式给出：\n$$\nx(t) = x_0 + t(x_1 - x_0)\n$$\n$$\ny(t) = y_0 + t(y_1 - y_0)\n$$\n将这些路径方程代入势能函数 $E(x,y)$，得到一个关于参数 $t$ 的一维函数，我们将其表示为 $f(t) = E(\\mathbf{r}(t))$。对于所提供的两个势能面 $E_a(x,y;\\alpha,\\beta,\\gamma,\\delta)$ 和 $E_b(x,y)$，这个函数 $f(t)$ 是一个关于 $t$ 的多项式。具体来说，由于 $E_a$ 和 $E_b$ 中的最高次项都是四次项（例如 $(x^2)^2 = x^4$），而 $x(t)$ 是 $t$ 的线性函数，因此得到的函数 $f(t)$ 是一个形如 $f(t) = c_4 t^4 + c_3 t^3 + c_2 t^2 + c_1 t + c_0$ 的四次多项式。\n\n为了在闭区间 $[0,1]$ 上找到使 $f(t)$ 最大化的值 $t^\\star$，我们应用极值定理。最大值必须出现在区间的端点 $t=0$ 和 $t=1$ 处，或者在开区间 $(0,1)$ 内的临界点处。临界点是导数 $f'(t)$ 为零的 $t$ 值。\n\n四次多项式 $f(t)$ 的导数 $f'(t)$ 是一个三次多项式。这个三次多项式的根可以通过代数方法或数值方法找到。设这些根为 $t_c$。最大值位置 $t^\\star$ 的候选集合是 $\\{0, 1\\} \\cup \\{ t_c \\mid f'(t_c)=0 \\text{ and } t_c \\in (0,1) \\}$。我们对这个集合中的每个候选 $t$ 值计算 $f(t)$，并确定产生全局最大值的 $t$ 值。这个值就是 $t^\\star$，最大能量为 $E^\\star = f(t^\\star)$。\n\n一旦确定了 $t^\\star$，我们就找到路径上相应的点 $\\mathbf{r}(t^\\star) = (x^\\star, y^\\star)$。最后一步是通过分析在 $(x^\\star, y^\\star)$ 处计算的势能的 Hessian 矩阵 $H$ 来表征该点。Hessian 矩阵是二阶偏导数矩阵：\n$$\nH(x,y) = \\begin{pmatrix} \\frac{\\partial^2 E}{\\partial x^2}  \\frac{\\partial^2 E}{\\partial x \\partial y} \\\\ \\frac{\\partial^2 E}{\\partial y \\partial x}  \\frac{\\partial^2 E}{\\partial y^2} \\end{pmatrix}\n$$\n对于给定的势能面：\n1.  对于 $E_a(x,y;\\alpha,\\beta,\\gamma,\\delta) = \\left(x^2 - 1\\right)^2 + \\alpha y^2 + \\beta x y + \\gamma x + \\delta y$，其 Hessian 矩阵为：\n    $$\n    H_a(x,y) = \\begin{pmatrix} 12x^2 - 4  \\beta \\\\ \\beta  2\\alpha \\end{pmatrix}\n    $$\n2.  对于 $E_b(x,y) = x^2 + \\left(y^2 - 1\\right)^2$，其 Hessian 矩阵为：\n    $$\n    H_b(x,y) = \\begin{pmatrix} 2  0 \\\\ 0  12y^2 - 4 \\end{pmatrix}\n    $$\n我们计算在 $(x^\\star, y^\\star)$ 处评估的 Hessian 矩阵的特征值。量 $m$ 是这些特征值中严格为负的数量。对应于过渡态的一阶鞍点，其特征是 $m=1$。\n\n每个测试用例的算法步骤如下：\n1.  构建 $x(t)$ 和 $y(t)$ 的多项式表示。\n2.  使用这些多项式构建四次多项式 $f(t) = E(\\mathbf{r}(t))$。\n3.  计算导数多项式 $f'(t)$。\n4.  求解 $f'(t)=0$ 的根。筛选出位于区间 $(0,1)$ 内的实数根。\n5.  形成 $t^\\star$ 的候选集，包括 $0$、$1$ 和筛选出的根。\n6.  在所有候选点上评估 $f(t)$，以找到最大值 $E^\\star$ 和相应的 $t^\\star$。\n7.  计算坐标 $\\mathbf{r}(t^\\star) = (x^\\star, y^\\star)$。\n8.  在 $(x^\\star, y^\\star)$ 处评估相应的 Hessian 矩阵 $H_a$ 或 $H_b$。\n9.  计算这个 $2 \\times 2$ 矩阵的特征值。\n10. 统计小于 $-10^{-8}$ 的特征值数量 $m$。\n11. 以指定格式报告三元组 $[t^\\star, E^\\star, m]$。\n\n此过程通过使用数值多项式处理和求根来实现，为问题提供了稳健而精确的解决方案。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the LST path optimization problem for a given set of test cases.\n    \"\"\"\n\n    def get_hessian_a(x, y, alpha, beta, gamma, delta):\n        \"\"\"Computes the Hessian matrix for PES E_a.\"\"\"\n        return np.array([\n            [12 * x**2 - 4, beta],\n            [beta, 2 * alpha]\n        ])\n\n    def get_hessian_b(x, y):\n        \"\"\"Computes the Hessian matrix for PES E_b.\"\"\"\n        return np.array([\n            [2, 0],\n            [0, 12 * y**2 - 4]\n        ])\n\n    test_cases = [\n        {'pes': 'a', 'params': (1.0, 0.0, 0.0, 0.0), 'A': (-1.0, 0.0), 'B': (1.0, 0.0)},\n        {'pes': 'a', 'params': (1.0, 0.0, 0.0, 0.0), 'A': (-1.0, 0.0), 'B': (-2.0, 0.0)},\n        {'pes': 'a', 'params': (1.0, 0.4, 0.0, 0.0), 'A': (-1.0, 0.5), 'B': (1.0, -0.5)},\n        {'pes': 'b', 'params': None, 'A': (0.0, -1.0), 'B': (0.0, 1.0)},\n        {'pes': 'a', 'params': (1.0, 0.0, 0.0, 0.0), 'A': (2.0, 0.0), 'B': (1.0, 0.0)},\n    ]\n\n    all_results = []\n    for case in test_cases:\n        pes_id = case['pes']\n        params = case['params']\n        A = np.array(case['A'])\n        B = np.array(case['B'])\n        \n        V = B - A\n        \n        # Path parameterization: r(t) = A + t*V\n        # x(t) = A[0] + t*V[0], y(t) = A[1] + t*V[1]\n        x_poly = np.poly1d([V[0], A[0]])\n        y_poly = np.poly1d([V[1], A[1]])\n        \n        # Energy along path f(t) = E(r(t))\n        if pes_id == 'a':\n            alpha, beta, gamma, delta = params\n            x2_minus_1 = x_poly**2 - 1.0\n            f_poly = x2_minus_1**2 + alpha * y_poly**2 + beta * x_poly * y_poly + gamma * x_poly + delta * y_poly\n        else:  # pes_id == 'b'\n            y2_minus_1 = y_poly**2 - 1.0\n            f_poly = x_poly**2 + y2_minus_1**2\n            \n        # Find critical points by finding roots of the derivative f'(t)\n        f_prime_poly = f_poly.deriv()\n        critical_points = np.roots(f_prime_poly)\n        \n        # Filter for real roots in the open interval (0, 1)\n        real_critical_points = [\n            t.real for t in critical_points if np.isclose(t.imag, 0) and 0  t.real  1\n        ]\n        \n        # Candidate values for t are endpoints and interior critical points\n        t_candidates = [0.0, 1.0] + real_critical_points\n        \n        # Evaluate energy at each candidate to find the maximum\n        energies = f_poly(t_candidates)\n        max_idx = np.argmax(energies)\n        \n        t_star = t_candidates[max_idx]\n        E_star = energies[max_idx]\n        \n        # Coordinates of the maximum energy point\n        r_star = A + t_star * V\n        x_star, y_star = r_star[0], r_star[1]\n        \n        # Hessian analysis at (x_star, y_star)\n        if pes_id == 'a':\n            hessian = get_hessian_a(x_star, y_star, *params)\n        else: # pes_id == 'b'\n            hessian = get_hessian_b(x_star, y_star)\n            \n        eigenvalues = np.linalg.eigvals(hessian)\n        \n        # Count number of negative eigenvalues\n        m = np.sum(eigenvalues  -1e-8)\n        \n        # Store formatted results for this case\n        all_results.extend([f\"{t_star:.6f}\", f\"{E_star:.6f}\", str(int(m))])\n\n    # Print the final list of results\n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n```", "id": "2466338"}]}