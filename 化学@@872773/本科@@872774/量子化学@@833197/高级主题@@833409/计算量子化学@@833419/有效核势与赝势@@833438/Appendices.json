{"hands_on_practices": [{"introduction": "理论是重要的，但将理论付诸实践是掌握任何科学工具的关键。使用有效核势 (ECP) 的第一步就是确定计算中将明确处理哪些电子。这个练习将带你完成对一个常见分子（五氟化磷）的分析，让你亲手实践如何根据元素在周期表中的位置来区分核心电子和价电子。", "problem": "在现代计算化学中，一种简化多电子分子计算的常用技术是使用有效核势（ECP）。ECP近似了化学惰性的内层电子的静电效应，从而使量子力学计算能够只关注具有化学活性的价电子。\n\n考虑分子五氟化磷（PF$_5$）。在其一项量子化学计算中，对中心的磷原子以及五个氟原子都使用了标准的ECP。对于像磷和氟这样的主族元素，“标准”ECP的构建是为了取代由元素周期表中紧邻该元素之前的稀有气体的电子构型所定义的内层电子。\n\n已知磷（P）的原子序数为 15，氟（F）的原子序数为 9，请确定在这次量子力学处理中，整个 PF$_5$ 分子中有多少电子被明确包含在内。", "solution": "有效核势（ECP）取代了与元素之前紧邻的稀有气体相对应的内层电子，只留下价电子进行显式处理。\n\n设 $Z_{\\mathrm{P}}=15$ 和 $Z_{\\mathrm{F}}=9$ 分别是原子序数。磷前面的稀有气体是氖，其 $Z_{\\mathrm{Ne}}=10$；氟前面的稀有气体是氦，其 $Z_{\\mathrm{He}}=2$。\n\n每个原子被显式处理的电子数（价电子数）可以通过减去稀有气体核来得到：\n$$\nN_{\\mathrm{val}}(\\mathrm{P})=Z_{\\mathrm{P}}-Z_{\\mathrm{Ne}}=15-10=5\n$$\n$$\nN_{\\mathrm{val}}(\\mathrm{F})=Z_{\\mathrm{F}}-Z_{\\mathrm{He}}=9-2=7\n$$\n对于 PF$_5$，有一个磷原子和五个氟原子，因此明确包含的总电子数为\n$$\nN_{\\mathrm{QM}}=N_{\\mathrm{val}}(\\mathrm{P})+5 N_{\\mathrm{val}}(\\mathrm{F})=5+5 \\times 7=40.\n$$\n等效地，从总电子数开始，减去所有的内层电子，\n$$\n(Z_{\\mathrm{P}}+5 Z_{\\mathrm{F}})-(Z_{\\mathrm{Ne}}+5 Z_{\\mathrm{He}})=(15+5 \\times 9)-(10+5 \\times 2)=60-20=40,\n$$\n这也证实了结果。", "answer": "$$\\boxed{40}$$", "id": "1364323"}, {"introduction": "在计算化学中，ECP 方法是一种近似，但这并不意味着它对所有物理量的影响都是微小的。ECP 通过忽略核心电子来简化计算。本练习将探讨这种简化对一个基本量——体系总能量——产生的系统性影响，通过比较全电子计算和 ECP 计算的能量，你将深入理解这两种方法在能量构成上的根本区别。", "problem": "在计算量子化学中，计算含有重元素的分子的电子结构有两种常用方法：全电子 (AE) 计算和使用有效核势 (ECPs) 的方法。AE 计算显式地处理体系中的每一个电子。相比之下，ECP 计算用一个有效势取代了化学惰性的核心电子和强的核势，只显式地处理价电子。这显著降低了计算成本。\n\n考虑四氢化锡分子 SnH$_4$。锡原子 (Sn) 的原子序数为 50。令 $E_{\\text{AE}}$ 表示通过 AE 计算得到的 SnH$_4$ 的总电子基态能量，令 $E_{\\text{ECP}}$ 表示通过用标准 ECP 替换锡原子的核心电子的计算所得到的总电子基态能量。\n\n基于这两种方法的基本原理，以下哪个陈述正确地比较了这两种计算的总能量并提供了正确的理由？\n\nA. $E_{\\text{ECP}}  E_{\\text{AE}}$，因为 ECP 近似在计算上更高效，这使得价电子能量的计算可以更精确，从而导致更低的总能量。\n\nB. $E_{\\text{ECP}} > E_{\\text{AE}}$，因为 ECP 计算显式地忽略了核心电子巨大的、为负值的结合能，而全电子计算中则包含了这部分能量。\n\nC. $E_{\\text{ECP}} > E_{\\text{AE}}$，因为取代核心电子的有效势对价电子平均而言是排斥的，从而增加了体系的总能量。\n\nD. $E_{\\text{ECP}}  E_{\\text{AE}}$，因为全电子计算通过包含核心-价电子排斥而高估了电子-电子排斥，导致了更高的（负值更小的）能量。\n\nE. $E_{\\text{ECP}} = E_{\\text{AE}}$，因为一个构建良好的 ECP 旨在完美地再现价电子的性质，所以总能量应该匹配。", "solution": "我们比较通过两种方法得到的总电子基态能量：一种是显式处理所有电子的全电子 (AE) 计算，另一种是用有效势替换 Sn 原子的核心电子并只显式处理价电子的有效核势 (ECP) 计算。\n\n我们将电子自由度划分为核心电子 $C$（在 Sn 上）和价电子 $V$。非相对论电子哈密顿算符可以写为\n$$\n\\hat{H}=\\hat{T}+\\hat{V}_{en}+\\hat{V}_{ee},\n$$\nAE 总能量为\n$$\nE_{\\text{AE}}=\\langle \\Psi_{\\text{AE}}|\\hat{H}|\\Psi_{\\text{AE}}\\rangle.\n$$\n按电子子集分解可得\n$$\nE_{\\text{AE}}=E_{C}+E_{V}+E_{CV},\n$$\n其中 $E_{C}$ 包含所有仅涉及核心电子的项（它们的动能、与 Sn 和其他原子核的电子-核吸引以及核心-核心电子排斥），$E_{V}$ 只包含价电子项，而 $E_{CV}$ 包含核心-价电子相互作用项。对于像 Sn 这样的重原子，核心电子被紧密地束缚在原子核上，因此 $E_{C}$ 中的电子-核吸引占主导地位，并且\n$$\nE_{C}=\\langle \\Psi_{\\text{AE}}|\\hat{T}_{C}+\\hat{V}_{en}^{C}+\\hat{V}_{ee}^{CC}|\\Psi_{\\text{AE}}\\rangle \\ll 0,\n$$\n即 $E_{C}$ 的绝对值很大且为负值。\n\n在 ECP 方法中，用于显式处理的电子的哈密顿算符是\n$$\n\\hat{H}_{\\text{ECP}}=\\hat{T}_{V}+\\hat{V}_{\\text{ECP}}^{\\text{Sn}}+\\hat{V}_{en}^{V,\\text{H}}+\\hat{V}_{ee}^{VV},\n$$\n其中 $\\hat{V}_{\\text{ECP}}^{\\text{Sn}}$ 是一个有效的单电子算符，它取代了价电子所感受到的、来自 Sn 的显式核心电子和强核势，$\\hat{V}_{en}^{V,\\text{H}}$ 是价电子与氢原子核的吸引力（以及任何对 Sn 的价电子贡献），而 $\\hat{V}_{ee}^{VV}$ 是价-价电子排斥。相应的总能量是\n$$\nE_{\\text{ECP}}=\\langle \\Psi_{\\text{ECP}}|\\hat{H}_{\\text{ECP}}|\\Psi_{\\text{ECP}}\\rangle.\n$$\n根据其构造原理，一个构建良好的 ECP 可以再现核心对价电子能量学的影响，因此我们可以写出\n$$\nE_{\\text{ECP}}=(E_{V}+E_{CV})+\\delta,\n$$\n其中 $\\delta$ 表示由 ECP 近似引起的（通常很小的）模型误差，并且重要的是，纯粹的核心能量 $E_{C}$ 不包括在内。\n\n因此，\n$$\nE_{\\text{ECP}}-E_{\\text{AE}}=\\delta-E_{C}.\n$$\n由于 $E_{C}\\ll 0$ 且对于一个好的 ECP 而言 $|\\delta|$ 很小，因此可以得出\n$$\nE_{\\text{ECP}}-E_{\\text{AE}}>0 \\quad \\Rightarrow \\quad E_{\\text{ECP}}>E_{\\text{AE}}.\n$$\n\n这直接支持了选项 B。其他选项不正确的原因如下：\n- A 不正确，因为计算效率本身不会降低变分能量；此外，ECP 能量省略了核心贡献，使其负值更小。\n- C 不正确，因为有效势平均而言不是排斥的；它的构建是为了再现核心对价电子的吸引作用。\n- D 不正确，因为 AE 计算不会错误地高估电子-电子排斥；它包含了物理上真实的核心-价电子相互作用以及占主导地位的核心-核吸引。\n- E 不正确，因为尽管 ECP 旨在再现价电子性质，但它们不包括巨大的负值核心结合能；因此总能量不匹配。", "answer": "$$\\boxed{B}$$", "id": "1364281"}, {"introduction": "任何计算模型都有其适用范围，了解其局限性与了解其优势同样重要。我们已经知道 ECP 方法通过替换核心电子来提高计算效率，但这种替换并非没有代价。这个高级练习通过一个简化的数学模型，让你亲手证明为什么 ECP 方法不能用于计算依赖于原子核附近电子密度的性质，你将具体地看到赝势波函数在核心区域的物理不准确性如何导致计算结果的系统性失效。", "problem": "你需要在一个数学上受控的环境中，论证为什么尝试使用有效芯势 (ECP) 计算依赖于芯层电子密度的性质会导致无意义的结果。整个过程完全使用原子单位，其中玻尔半径为 $a_0 = 1$。考虑一个核电荷为 $Z$ 的单电子、类氢原子 $1s$ 态，其归一化的全电子径向波函数为 $\\psi_{1s}(r) = \\left(\\dfrac{Z^3}{\\pi}\\right)^{1/2} e^{-Z r}$，其电子密度为 $\\rho_{\\mathrm{AE}}(r;Z) = \\left|\\psi_{1s}(r)\\right|^2 = \\dfrac{Z^3}{\\pi} e^{-2 Z r}$。定义一个“弥散接触”可观测量（作为费米接触超精细相互作用的替代）为半径为 $r_s$ 的小球内的平均电子密度：\n$$\n\\overline{\\rho}_{\\mathrm{AE}}(Z,r_s) = \\frac{3}{r_s^3} \\int_{0}^{r_s} \\rho_{\\mathrm{AE}}(r;Z)\\, r^2 \\, dr.\n$$\n现在采用一个简化的 ECP 模型，该模型通过在芯区半径 $r_c$ 内将赝密度设为零来移除芯层电子密度：\n$$\n\\rho_{\\mathrm{ECP}}(r;Z,r_c) = \n\\begin{cases}\n0,  0 \\le r \\le r_c,\\\\\n\\rho_{\\mathrm{AE}}(r;Z),  r > r_c.\n\\end{cases}\n$$\n定义相应的弥散 ECP 可观测量：\n$$\n\\overline{\\rho}_{\\mathrm{ECP}}(Z,r_c,r_s) = \\frac{3}{r_s^3} \\int_{\\max(0,r_c)}^{r_s} \\rho_{\\mathrm{AE}}(r;Z)\\, r^2 \\, dr,\n$$\n需要理解的是，如果 $r_c \\ge r_s$，则积分为零。你的任务是：\n- 从给定的定义和标准积分出发，推导比值\n$$\nR(Z,r_c,r_s) = \\frac{\\overline{\\rho}_{\\mathrm{ECP}}(Z,r_c,r_s)}{\\overline{\\rho}_{\\mathrm{AE}}(Z,r_s)}.\n$$\n的闭合形式表达式。\n- 实现一个程序，用于计算下面每个测试用例的 $R(Z,r_c,r_s)$（以原子单位计）。程序不应需要外部输入。\n\n测试套件（每个元组为 $(Z,r_c,r_s)$）：\n- $(1, 0.05, 0.2)$\n- $(1, 0.2, 0.2)$\n- $(6, 0.02, 0.2)$\n- $(10, 0.05, 0.2)$\n- $(2, 0.0, 0.2)$\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$[\\text{result}_1,\\text{result}_2,\\dots]$）。每个结果必须是四舍五入到 $6$ 位小数的浮点数。可观测量的期望单位是 $a_0^{-3}$，但由于要求返回比值 $R(Z,r_c,r_s)$，最终报告的数字是无量纲的。在你的解释中，说明为什么当用于近似依赖于芯层电子密度的性质（如原子核处的电场梯度或费米接触项）时，这个简化的基于 ECP 的可观测量是无意义的。", "solution": "所提出的问题经过验证，被认为是科学上可靠、定义明确且客观的。它构成了一个有效的练习，用以展示有效芯势 (ECP) 方法在计算化学中的一个根本局限性。因此，我们着手进行完整的解析推导和计算实现。\n\n任务是为一个简化的类氢体系推导并计算比值 $R(Z,r_c,r_s) = \\overline{\\rho}_{\\mathrm{ECP}} / \\overline{\\rho}_{\\mathrm{AE}}$。我们首先推导这两个可观测量的表达式。\n\n首先，我们评估全电子 (AE) 弥散接触可观测量 $\\overline{\\rho}_{\\mathrm{AE}}(Z,r_s)$。这需要计算半径为 $r_s$ 的球内径向概率密度 $4\\pi r^2 \\rho_{\\mathrm{AE}}(r;Z)$ 的积分。所提供的定义是 $\\overline{\\rho}_{\\mathrm{AE}}(Z,r_s) = \\frac{3}{r_s^3} \\int_{0}^{r_s} \\rho_{\\mathrm{AE}}(r;Z)\\, r^2 \\, dr$。给定 $\\rho_{\\mathrm{AE}}(r;Z) = \\frac{Z^3}{\\pi} e^{-2 Z r}$，积分部分为：\n$$\nI_{\\mathrm{AE}} = \\int_{0}^{r_s} \\rho_{\\mathrm{AE}}(r;Z)\\, r^2 \\, dr = \\frac{Z^3}{\\pi} \\int_{0}^{r_s} r^2 e^{-2 Z r} dr\n$$\n为了求解这个积分，我们利用不定积分的标准形式：\n$$\n\\int r^2 e^{ar} dr = e^{ar} \\left( \\frac{r^2}{a} - \\frac{2r}{a^2} + \\frac{2}{a^3} \\right)\n$$\n通过代换 $a = -2Z$，我们得到：\n$$\n\\int r^2 e^{-2Zr} dr = -e^{-2Zr} \\left( \\frac{r^2}{2Z} + \\frac{2r}{4Z^2} + \\frac{2}{8Z^3} \\right) = -\\frac{e^{-2Zr}}{4Z^3} (2Z^2r^2 + 2Zr + 1)\n$$\n计算从 $0$ 到 $r_s$ 的定积分：\n$$\n\\int_{0}^{r_s} r^2 e^{-2Zr} dr = \\left[ -\\frac{e^{-2Zr}}{4Z^3} \\left( 2Z^2r^2 + 2Zr + 1 \\right) \\right]_{0}^{r_s}\n$$\n$$\n= \\left( -\\frac{e^{-2Zr_s}}{4Z^3} \\left( 2Z^2r_s^2 + 2Zr_s + 1 \\right) \\right) - \\left( -\\frac{e^{0}}{4Z^3} (0 + 0 + 1) \\right)\n$$\n$$\n= \\frac{1}{4Z^3} \\left( 1 - e^{-2Zr_s} \\left( 2Z^2r_s^2 + 2Zr_s + 1 \\right) \\right)\n$$\n将此结果代回 $I_{\\mathrm{AE}}$ 的表达式，然后再代入 $\\overline{\\rho}_{\\mathrm{AE}}(Z,r_s)$：\n$$\nI_{\\mathrm{AE}} = \\frac{Z^3}{\\pi} \\frac{1}{4Z^3} \\left( 1 - e^{-2Zr_s} (2Z^2r_s^2 + 2Zr_s + 1) \\right) = \\frac{1}{4\\pi} \\left( 1 - e^{-2Zr_s} (2Z^2r_s^2 + 2Zr_s + 1) \\right)\n$$\n$$\n\\overline{\\rho}_{\\mathrm{AE}}(Z,r_s) = \\frac{3}{r_s^3} I_{\\mathrm{AE}} = \\frac{3}{4\\pi r_s^3} \\left( 1 - e^{-2Zr_s} (2Z^2r_s^2 + 2Zr_s + 1) \\right)\n$$\n接下来，我们评估 ECP 可观测量 $\\overline{\\rho}_{\\mathrm{ECP}}(Z,r_c,r_s)$。ECP 模型将 $r \\le r_c$ 的密度设为零。因此，积分从下限 $r_c$ 开始。\n$$\n\\overline{\\rho}_{\\mathrm{ECP}}(Z,r_c,r_s) = \\frac{3}{r_s^3} \\int_{r_c}^{r_s} \\rho_{\\mathrm{AE}}(r;Z)\\, r^2 \\, dr\n$$\n这适用于 $0 \\le r_c  r_s$ 的情况。如果 $r_c \\ge r_s$，积分区间为空或长度为零，积分严格为零。对于 $r_c  r_s$，我们使用与之前相同的不定积分，但使用新的积分限：\n$$\nI_{\\mathrm{ECP}} = \\int_{r_c}^{r_s} \\rho_{\\mathrm{AE}}(r;Z)\\, r^2 \\, dr = \\frac{Z^3}{\\pi} \\left[ -\\frac{e^{-2Zr}}{4Z^3} \\left( 2Z^2r^2 + 2Zr + 1 \\right) \\right]_{r_c}^{r_s}\n$$\n$$\nI_{\\mathrm{ECP}} = \\frac{1}{4\\pi} \\left[ -e^{-2Zr} \\left( 2Z^2r^2 + 2Zr + 1 \\right) \\right]_{r_c}^{r_s}\n$$\n$$\nI_{\\mathrm{ECP}} = \\frac{1}{4\\pi} \\left( e^{-2Zr_c}(2Z^2r_c^2 + 2Zr_c + 1) - e^{-2Zr_s}(2Z^2r_s^2 + 2Zr_s + 1) \\right)\n$$\n比值 $R(Z,r_c,r_s)$ 为 $\\overline{\\rho}_{\\mathrm{ECP}} / \\overline{\\rho}_{\\mathrm{AE}} = I_{\\mathrm{ECP}} / I_{\\mathrm{AE}}$，因为前置因子 $\\frac{3}{r_s^3}$ 完全抵消了。\n$$\nR(Z,r_c,r_s) = \\frac{e^{-2Zr_c}(2Z^2r_c^2 + 2Zr_c + 1) - e^{-2Zr_s}(2Z^2r_s^2 + 2Zr_s + 1)}{1 - e^{-2Zr_s}(2Z^2r_s^2 + 2Zr_s + 1)} \\quad \\text{for } r_c  r_s\n$$\n在 $r_c \\ge r_s$ 的情况下，我们有 $\\overline{\\rho}_{\\mathrm{ECP}} = 0$，这意味着 $R(Z,r_c,r_s) = 0$。\n一个特殊的平凡情况是 $r_c = 0$。此时，分子变为 $e^0(0+0+1) - e^{-2Zr_s}(...)$，与分母相同，得到 $R(Z,0,r_s)=1$。这是正确的，因为芯区半径为零的 ECP 等同于全电子计算。\n\n这个 $R(Z,r_c,r_s)$ 的闭合形式表达式被实现用于评估指定的测试用例。\n\n物理释义展示了这种简化 ECP 方法的失败之处。有效芯势的构建是为了重现价层性质，例如轨道能量和远离原子核的电子密度空间分布。它们通过用较弱的赝势取代强的库仑势和芯层电子的复杂效应来实现这一点。此过程产生无节点的价层赝波函数，这些函数在计算上很方便，但在芯区 ($r  r_c$) 在物理上是不正确的。\n\n诸如费米接触相互作用、原子核处的电场梯度和 Mössbauer 异构体位移等性质，都关键地依赖于原子核处或非常靠近原子核 ($r \\to 0$) 的电子密度及其梯度。ECP 模型通过其设计本身，移除了芯层电子并将该关键区域的电子密度设置为零。正如我们在 $(Z, r_c, r_s) = (1, 0.2, 0.2)$ 案例的计算中所示，如果采样半径 $r_s$ 小于或等于芯区半径 $r_c$，基于 ECP 的可观测量恰好为零。这是一个灾难性的失败，与非零的全电子结果相比，产生了无限的相对误差。\n\n即使当 $r_c  r_s$ 时，ECP 的结果也对人为参数 $r_c$ 高度敏感。对于具有较大 $Z$ 的重原子（例如，$Z=10$），芯层密度更集中在原子核附近。即使对于一个很小的 $r_c$（例如，$0.05$ 原子单位），移除这部分密度也会导致严重错误的结果，正如在测试用例 $(10, 0.05, 0.2)$ 中所见，其误差超过 $10\\%$。$r_c$ 的值是一个计算便利性的参数，而不是一个物理可观测量。任何强烈依赖于 $r_c$ 的计算性质，根据定义，都是一种不符合物理的假象。结论是不可避免的：ECP 从根本上不适用于计算依赖于芯区内部电子密度的性质。试图这样做是对该方法的误用，并会导致无意义的、任意的结果。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of computing the ratio R(Z, r_c, r_s) for a set of test cases.\n    \"\"\"\n\n    test_cases = [\n        (1, 0.05, 0.2),  # Z, r_c, r_s in atomic units\n        (1, 0.2, 0.2),\n        (6, 0.02, 0.2),\n        (10, 0.05, 0.2),\n        (2, 0.0, 0.2),\n    ]\n\n    def calculate_R(Z, r_c, r_s):\n        \"\"\"\n        Calculates the ratio R for a given set of parameters Z, r_c, and r_s.\n\n        The ratio is defined as:\n        R = [exp(-2*Z*r_c)*P(r_c) - exp(-2*Z*r_s)*P(r_s)] / [1 - exp(-2*Z*r_s)*P(r_s)]\n        where P(r) = (2*Z^2*r^2 + 2*Z*r + 1).\n\n        Args:\n            Z (float): Nuclear charge.\n            r_c (float): Core radius.\n            r_s (float): Smearing radius.\n\n        Returns:\n            float: The calculated ratio R.\n        \"\"\"\n        # If the core radius is greater than or equal to the smearing radius,\n        # the ECP observable integral becomes zero.\n        if r_c >= r_s:\n            return 0.0\n\n        # Define a helper function for the polynomial term P(r) = 2*Z^2*r^2 + 2*Z*r + 1\n        def poly(r, Z_val):\n            term1 = 2 * (Z_val * r)**2\n            term2 = 2 * Z_val * r\n            return term1 + term2 + 1\n\n        # Calculate exponential terms\n        exp_rc = np.exp(-2 * Z * r_c)\n        exp_rs = np.exp(-2 * Z * r_s)\n        \n        # Calculate polynomial terms\n        poly_rc = poly(r_c, Z)\n        poly_rs = poly(r_s, Z)\n\n        # Numerator of the ratio R\n        numerator = exp_rc * poly_rc - exp_rs * poly_rs\n        \n        # Denominator of the ratio R\n        denominator = 1.0 - exp_rs * poly_rs\n\n        # It is a mathematical certainty that for r_s > 0 the denominator is non-zero.\n        # The integrated probability inside the sphere must be less than 1, so\n        # 4*pi*I_AE  1, which implies 1 - exp(...)*P(...) > 0.\n        if denominator == 0:\n            # This case physically corresponds to r_s -> infinity, where R->1.\n            # For finite r_s, this should not happen. It might indicate a precision issue\n            # if r_s is extremely large, but is safe to handle.\n            # A special case is r_c = 0 where num=den, so R=1.\n            if numerator == denominator:\n                return 1.0\n            else: # Should not be reached with valid inputs.\n                return np.nan\n\n        return numerator / denominator\n\n    results = []\n    for case in test_cases:\n        Z, r_c, r_s = case\n        result = calculate_R(Z, r_c, r_s)\n        results.append(f\"{result:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n\n```", "id": "2454650"}]}