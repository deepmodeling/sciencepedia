{"hands_on_practices": [{"introduction": "Gillespie 算法的核心在于回答两个基本问题：“下一个反应何时发生？”以及“发生的是哪个反应？”。本练习将侧重于第一个问题，通过一个简单的蛋白质降解模型，我们将学习如何计算系统的总倾向性（total propensity）$a_0$，这个量决定了系统演化的时间尺度。我们还将计算第一个反应事件的期望等待时间 $\\langle \\tau \\rangle$，这是理解随机模拟中时间步长动态的关键。[@problem_id:1518727]", "problem": "在对单个生物细胞内基因表达的研究中，随机效应变得至关重要。考虑一个简化模型，其中一种我们标记为 $P$ 的特定蛋白质会发生自发降解。这个过程可以被建模为一个一级化学反应：\n$$\nP \\xrightarrow{k} \\emptyset\n$$\n其中 $\\emptyset$ 代表降解状态。在时间 $t=0$ 时，细胞内恰好含有 $N_P(0) = 25$ 个蛋白质 $P$ 分子。单个 $P$ 分子降解的随机速率常数给定为 $k = 0.05 \\text{ s}^{-1}$。\n\n随机模拟，例如 Gillespie 算法，依赖于反应倾向（reaction propensity）的概念，即单位时间内某一特定反应发生的概率。对于一个具有多个反应通道的系统，总倾向是所有单个通道倾向的总和。\n\n计算该系统在初始时间 $t=0$ 时的两个基本量：\n1. 初始总倾向 $a_0$。\n2. 直到第一次降解事件发生时的期望时间 $\\langle \\tau \\rangle$。\n\n将您的最终答案表示为一对数值 $(a_0, \\langle \\tau \\rangle)$。$a_0$ 的值以 $\\text{s}^{-1}$ 为单位，$\\langle \\tau \\rangle$ 的值以 $\\text{s}$ 为单位。将两个数值都四舍五入到三位有效数字。", "solution": "对于单分子降解反应 $P \\xrightarrow{k} \\emptyset$，随机质量作用公式给出的反应通道倾向为 $a_{1}(t) = k N_{P}(t)$，其中 $N_{P}(t)$ 是时间 $t$ 时的 $P$ 分子数，$k$ 是单位为 $\\text{s}^{-1}$ 的随机速率常数。由于只有一个反应通道，总倾向是所有通道倾向的总和，所以 $a_{0}(t) = a_{1}(t)$。\n\n在 $t=0$ 时，我们有 $N_{P}(0) = 25$，因此符号上表示为 $a_{0}(0) = k N_{P}(0)$。代入给定的数值可得\n$$\na_{0} = k N_{P}(0) = 0.05 \\times 25 = 1.25 \\ \\text{s}^{-1}.\n$$\n\n在 Gillespie 框架中，到下一次反应的等待时间 $\\tau$ 服从参数为 $a_{0}$ 的指数分布，即其密度函数为 $f(\\tau) = a_{0} \\exp(-a_{0} \\tau)$（对于 $\\tau \\geq 0$）。期望等待时间是\n$$\n\\langle \\tau \\rangle = \\int_{0}^{\\infty} \\tau a_{0} \\exp(-a_{0} \\tau) \\, d\\tau = \\frac{1}{a_{0}}.\n$$\n使用计算出的 $a_{0}$，\n$$\n\\langle \\tau \\rangle = \\frac{1}{1.25} = 0.800 \\ \\text{s},\n$$\n四舍五入到三位有效数字。\n\n因此，在指定单位下，所求的数值对为 $(a_{0}, \\langle \\tau \\rangle) = (1.25, 0.800)$。", "answer": "$$\\boxed{\\begin{pmatrix} 1.25  0.800 \\end{pmatrix}}$$", "id": "1518727"}, {"introduction": "在确定了下一个反应发生的时间之后，算法的下一步是决定在所有可能的反应中具体哪一个会发生。这个选择过程不是确定性的，而是概率性的，倾向性越高的反应被选中的机会越大。本练习将引导你完成这一关键的选择步骤，展示如何使用一个随机数和各个反应的倾向性来确定下一个发生的化学事件。[@problem_id:1518714]", "problem": "在生物化学网络的研究中，Gillespie 算法提供了一种随机模拟化学反应系统时间演化的方法。考虑一个蛋白质的简化模型，该蛋白质可以处于非激活态 $S$ 或激活态 $S^*$。该蛋白质可以通过两个基元反应在这两种状态之间切换：\n\n*   **反应 1 (激活):** $S \\to S^*$\n*   **反应 2 (失活):** $S^* \\to S$\n\n在某个特定时刻，测得激活反应的倾向性为 $a_1 = 2.0 \\, \\text{s}^{-1}$，失活反应的倾向性为 $a_2 = 3.0 \\, \\text{s}^{-1}$。反应的倾向性可以理解为其瞬时发生概率速率。\n\nGillespie 算法是分步进行的。在每一步中，它决定下一个将发生哪个反应。这个选择是通过将一个在区间 $(0, 1)$ 上均匀分布的随机数 $r_2$ 与倾向性的累积和进行比较来做出的。具体来说，下一个发生的反应是满足不等式 $\\sum_{j=1}^{\\mu} a_j  r_2 a_0$ 的最小索引 $\\mu$ 所对应的反应，其中 $a_0$ 是所有反应倾向性之和。\n\n已知在当前模拟步骤中，用于选择反应的随机数为 $r_2 = 0.50$，那么下一个被选中的反应是哪个？\n\nA. 反应 1 (激活)\n\nB. 反应 2 (失活)\n\nC. 两个反应同时发生。\n\nD. 在这一步中没有反应发生。\n\nE. 根据所给信息无法确定结果。", "solution": "我们已知两个反应的倾向性 $a_{1}$ 和 $a_{2}$，以及在 Gillespie 算法中用于选择反应的随机数 $r_{2}$。选择规则是：选择满足以下条件的最小索引 $\\mu$\n$$\n\\sum_{j=1}^{\\mu} a_{j}  r_{2} a_{0},\n$$\n其中\n$$\na_{0} = \\sum_{j=1}^{2} a_{j}.\n$$\n给定的倾向性为 $a_{1} = 2.0\\,\\text{s}^{-1}$ 和 $a_{2} = 3.0\\,\\text{s}^{-1}$，所以\n$$\na_{0} = a_{1} + a_{2} = 2.0\\,\\text{s}^{-1} + 3.0\\,\\text{s}^{-1} = 5.0\\,\\text{s}^{-1}.\n$$\n当 $r_{2} = 0.50$ 时，计算阈值：\n$$\nr_{2} a_{0} = 0.50 \\times 5.0\\,\\text{s}^{-1} = 2.5\\,\\text{s}^{-1}.\n$$\n现在计算累积和：\n$$\n\\sum_{j=1}^{1} a_{j} = a_{1} = 2.0\\,\\text{s}^{-1}.\n$$\n对 $\\mu=1$ 检验不等式：\n$$\n2.0\\,\\text{s}^{-1}  2.5\\,\\text{s}^{-1} \\quad \\text{为假}。\n$$\n接下来，\n$$\n\\sum_{j=1}^{2} a_{j} = a_{1} + a_{2} = 5.0\\,\\text{s}^{-1}.\n$$\n对 $\\mu=2$ 检验不等式：\n$$\n5.0\\,\\text{s}^{-1}  2.5\\,\\text{s}^{-1} \\quad \\text{为真}。\n$$\n因此，满足选择准则的最小索引 $\\mu$ 是 $\\mu=2$，它对应于反应 2 (失活)。在 Gillespie 算法中，只要倾向性是有限的并且随机数在开区间 $(0,1)$ 内，每一步都恰好只有一个反应发生，因此同时发生或没有反应发生的情况在这里不适用。", "answer": "$$\\boxed{B}$$", "id": "1518714"}, {"introduction": "前面的练习都提供了现成的倾向性函数，但在实际研究中，我们需要能为任意给定的化学反应推导出其倾向性函数。本练习将深入探讨倾向性的基础，指导你为一个涉及多个反应物的复杂反应（$2A + B \\rightarrow C$）推导其倾向性函数。正确处理涉及多个相同分子的反应的组合因子，是构建精确随机模型的关键一步。[@problem_id:1518692]", "problem": "考虑一个体积为 $V$ 的固定、充分混合的化学系统，其中包含两种分子种类：A 和 B。系统中可能发生一个化学反应，其中两个 A 分子和一个 B 分子结合，生成一个产物 C 分子。该反应的化学计量式为 $2A + B \\rightarrow C$。\n\n该系统当前包含 $n_A$ 个 A 种类的分子和 $n_B$ 个 B 种类的分子。\n\n设 $c$ 为基本随机速率常数。该常数表示一个特定的、预先选定的反应物三联体（即一对特定的 A 分子和一个特定的 B 分子）在单位时间内发生反应的概率。\n\n你的任务是确定该反应的总倾向函数 $a(n_A, n_B)$。倾向函数的定义是，在下一个无穷小时间间隔 $[t, t+dt)$ 内，反应 $2A + B \\rightarrow C$ 在体积 $V$ 内某处发生的概率为 $a(n_A, n_B) \\, dt$。\n\n请用 $n_A$、$n_B$ 和常数 $c$ 来表示你的答案，形式为一个闭式解析表达式。", "solution": "倾向函数的定义是，$a(n_{A},n_{B})\\,dt$ 等于在 $[t,t+dt)$ 内发生一次反应事件的概率。根据基本随机速率常数 $c$ 的定义，一个特定的、预先选定的反应物三联体（一对特定的 A 分子和一个特定的 B 分子）在时间间隔 $[t,t+dt)$ 内发生反应的概率为 $c\\,dt$。\n\n在一个有 $n_{A}$ 个 A 分子和 $n_{B}$ 个 B 分子的充分混合系统中，不同的反应物三联体的总数等于选择一个无序的 A 分子对的方法数乘以选择一个 B 分子的方法数。A 的无序对的数量是 $\\binom{n_{A}}{2}$，而 B 的选择数量是 $n_{B}$。因此，不同三联体的总数为\n$$\n\\binom{n_{A}}{2}\\,n_{B}.\n$$\n对于一个无穷小的 $dt$，两个或更多这样的三联体发生反应的概率是 $dt^{2}$ 阶的，可以忽略不计。因此，在 $[t,t+dt)$ 内这些三联体中任意一个发生反应的总概率是它们各自概率的总和：\n$$\na(n_{A},n_{B})\\,dt \\;=\\; \\left[c \\times \\binom{n_{A}}{2}\\,n_{B}\\right] dt.\n$$\n所以，倾向函数是\n$$\na(n_{A},n_{B}) \\;=\\; c\\,\\binom{n_{A}}{2}\\,n_{B} \\;=\\; c\\,\\frac{n_{A}(n_{A}-1)}{2}\\,n_{B}.\n$$\n如果 $n_A  2$ 或 $n_B  1$，这个表达式通过二项式系数正确地得到零。", "answer": "$$\\boxed{c\\,\\binom{n_{A}}{2}\\,n_{B}}$$", "id": "1518692"}]}