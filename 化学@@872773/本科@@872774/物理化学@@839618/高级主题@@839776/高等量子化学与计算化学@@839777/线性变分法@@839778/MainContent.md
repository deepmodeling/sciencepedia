## 引言
在量子力学的世界里，精确求解多电子体系的薛定谔方程是一项艰巨的挑战。为了克服这一障碍，科学家们发展了一系列强大的近似方法，其中，[线性变分法](@entry_id:150058)无疑是[量子化学](@entry_id:140193)中应用最广泛、最具影响力的工具之一。它不仅为我们理解化学键、分子结构和反应性提供了坚实的理论框架，也构成了现代计算化学方法的数学心脏。本文旨在深入剖析[线性变分法](@entry_id:150058)，揭示其如何将一个看似无解的[微分方程](@entry_id:264184)问题，转化为一个系统、可解的代数问题。

本文将引导读者完成一次从理论到应用的全面探索。在第一章“原理与机制”中，我们将奠定该方法的数学和物理基础，从[变分原理](@entry_id:198028)出发，逐步构建[久期方程](@entry_id:200202)和[久期行列式](@entry_id:274608)。接下来，在“应用与交叉学科联系”一章中，我们将见证该方法的巨大威力，看它如何作为[分子轨道理论](@entry_id:137049)的基石，解释[光谱](@entry_id:185632)现象，并驱动着复杂的[计算模拟](@entry_id:146373)。最后，“动手实践”部分将提供具体的计算练习，帮助读者将理论知识转化为实践技能。通过这趟旅程，你将掌握一把能够开启众多现代理论物理和化学分支大门的钥匙。

## 原理与机制

在本章中，我们将深入探讨[线性变分法](@entry_id:150058)的数学框架和物理内涵。变分法是[量子化学](@entry_id:140193)中求解近似解最强大和最普适的工具之一。其核心思想是，通过构建一个包含可调参数的“[试探波函数](@entry_id:142892)”，并利用变分原理系统地优化这些参数，我们可以获得对体系[基态能量](@entry_id:263704)以及[激发态](@entry_id:261453)能量的精确近似。

### [变分原理](@entry_id:198028)与线性[试探波函数](@entry_id:142892)

变分法的理论基石是**[变分原理](@entry_id:198028)** (Variational Principle)。该原理指出，对于一个由[哈密顿算符](@entry_id:144286) $\hat{H}$ 描述的体系，其真实的基态能量为 $E_0$。如果我们使用任何一个归一化的、表现良好的[试探波函数](@entry_id:142892) $\Psi$ 来计算体系的[能量期望值](@entry_id:174035)，那么这个计算出的能量 $E$ 永远不会低于真实的基态能量 $E_0$：

$$
E = \frac{\int \Psi^{*} \hat{H} \Psi d\tau}{\int \Psi^{*} \Psi d\tau} \ge E_0
$$

上式中的[能量期望值](@entry_id:174035)表达式被称为**[瑞利商](@entry_id:137794)** (Rayleigh quotient)。变分原理的强大之处在于，它为我们提供了一个明确的优化方向：通过调整试探波函数 $\Psi$ 中的参数，使其对应的[能量期望值](@entry_id:174035) $E$ 最小化，我们就能得到对真实基态能量的最佳近似。[试探波函数](@entry_id:142892)越接近真实的[基态](@entry_id:150928)[波函数](@entry_id:147440)，计算出的能量就越接近真实的基态能量。

在**[线性变分法](@entry_id:150058)** (Linear Variation Method) 中，我们采用一种特别方便且功能强大的[试探波函数](@entry_id:142892)形式。我们将[试探波函数](@entry_id:142892) $\Psi$ 构建为一组已知的、[线性无关](@entry_id:148207)的**[基函数](@entry_id:170178)** (basis functions) $\{\phi_i\}$ 的线性组合：

$$
\Psi = \sum_{i=1}^{n} c_i \phi_i = c_1 \phi_1 + c_2 \phi_2 + \dots + c_n \phi_n
$$

在这里，$\{c_i\}$ 是**线性变分系数** (linear variational coefficients)，它们是我们在此方法中需要优化的参数。[基函数](@entry_id:170178) $\{\phi_i\}$ 的选择非常灵活，它们可以是[原子轨道](@entry_id:140819)、平面波，甚至是满足特定边界条件的多项式函数 [@problem_id:1408535]。

为了应用变分原理，我们需要将这个线性组合代入瑞利商。为简单起见，我们先考虑一个由两个实函[数基](@entry_id:634389)底 $\phi_1$ 和 $\phi_2$ 构成的体系。试探波函数为 $\Psi = c_1 \phi_1 + c_2 \phi_2$。

[瑞利商](@entry_id:137794)的分母是[波函数](@entry_id:147440)的归一化积分 $\langle \Psi | \Psi \rangle$。展开后得到：

$$
\langle \Psi | \Psi \rangle = \int (c_1 \phi_1 + c_2 \phi_2)^2 d\tau = c_1^2 \int \phi_1^2 d\tau + c_2^2 \int \phi_2^2 d\tau + 2c_1 c_2 \int \phi_1 \phi_2 d\tau
$$

我们通常选择归一化的[基函数](@entry_id:170178)，即 $\int \phi_i^2 d\tau = 1$。而不同[基函数](@entry_id:170178)之间的积分 $\int \phi_i \phi_j d\tau$ (对于 $i \neq j$) 则不一定为零。我们将其定义为**重叠积分** (overlap integral) $S_{ij}$。因此，[归一化条件](@entry_id:156486) $\langle \Psi | \Psi \rangle = 1$ 要求系数满足以下关系 [@problem_id:1408479]：

$$
c_1^2 + c_2^2 + 2c_1 c_2 S_{12} = 1
$$

类似地，[瑞利商](@entry_id:137794)的分子是[哈密顿量](@entry_id:172864)的[期望值](@entry_id:153208) $\langle \Psi | \hat{H} | \Psi \rangle$。展开后得到：

$$
\langle \Psi | \hat{H} | \Psi \rangle = c_1^2 \int \phi_1 \hat{H} \phi_1 d\tau + c_2^2 \int \phi_2 \hat{H} \phi_2 d\tau + 2c_1 c_2 \int \phi_1 \hat{H} \phi_2 d\tau
$$

这些积分定义了**[哈密顿矩阵元](@entry_id:201928)** (Hamiltonian matrix elements) $H_{ij} = \int \phi_i \hat{H} \phi_j d\tau$。因此，[能量期望值](@entry_id:174035)可以写成：

$$
E(c_1, c_2) = \frac{c_1^2 H_{11} + c_2^2 H_{22} + 2c_1 c_2 H_{12}}{c_1^2 S_{11} + c_2^2 S_{22} + 2c_1 c_2 S_{12}}
$$

其中 $S_{11} = S_{22} = 1$。我们的任务就是通过调整 $c_1$ 和 $c_2$ 来最小化 $E$。

### [久期方程](@entry_id:200202)与[久期行列式](@entry_id:274608)

为了找到使能量 $E$ 最小化的系数 $\{c_i\}$，我们对能量 $E$ 分别关于每个系数求[偏导数](@entry_id:146280)，并令其为零：$\frac{\partial E}{\partial c_i} = 0$。对于包含 $n$ 个[基函数](@entry_id:170178)的体系，这个最小化过程会产生一个包含 $n$ 个联立[线性方程](@entry_id:151487)的[方程组](@entry_id:193238)，称为**[久期方程](@entry_id:200202)** (secular equations)：

$$
\sum_{j=1}^{n} (H_{ij} - E S_{ij}) c_j = 0, \quad \text{for } i = 1, 2, \dots, n
$$

这个[方程组](@entry_id:193238)可以更紧凑地写成矩阵形式，即**广义本征值问题** (generalized eigenvalue problem) [@problem_id:2014797]：

$$
\mathbf{H}\mathbf{c} = E \mathbf{S}\mathbf{c}
$$

其中：
- $\mathbf{H}$ 是**哈密顿矩阵**，其元素为 $H_{ij} = \langle \phi_i | \hat{H} | \phi_j \rangle$。
- $\mathbf{S}$ 是**[重叠矩阵](@entry_id:268881)**，其元素为 $S_{ij} = \langle \phi_i | \phi_j \rangle$。对于归一化但非正交的[基函数](@entry_id:170178)，其对角元素为1，非对角元素为重叠积分。
- $\mathbf{c}$ 是由待求系数组成的**列向量**。

对于一个由两个[基函数](@entry_id:170178)构成的体系，这些矩阵和向量的具体形式为：

$$
\mathbf{H} = \begin{pmatrix} H_{11} & H_{12} \\ H_{21} & H_{22} \end{pmatrix}, \quad \mathbf{S} = \begin{pmatrix} S_{11} & S_{12} \\ S_{21} & S_{22} \end{pmatrix} = \begin{pmatrix} 1 & S_{12} \\ S_{21} & 1 \end{pmatrix}, \quad \mathbf{c} = \begin{pmatrix} c_1 \\ c_2 \end{pmatrix}
$$

[久期方程组](@entry_id:200202) $(\mathbf{H} - E\mathbf{S})\mathbf{c} = \mathbf{0}$ 只有在系数 $\{c_i\}$ 不全为零（即所谓的“非平庸解”）时才有物理意义。线性代数告诉我们，这种情况发生的充要条件是其系数矩阵的[行列式](@entry_id:142978)为零。这个条件被称为**[久期行列式](@entry_id:274608)** (secular determinant)：

$$
\det(\mathbf{H} - E\mathbf{S}) = 0
$$

对于一个 $n$ 阶的体系，展开这个[行列式](@entry_id:142978)会得到一个关于能量 $E$ 的 $n$ 次多项式方程。这个方程的 $n$ 个根 $E_1, E_2, \dots, E_n$ 就是我们通过[变分法](@entry_id:163656)得到的体系能量的近似值。根据**[Hylleraas-Undheim-MacDonald定理](@entry_id:202609)**，这些根为体系真实能级 $\epsilon_k$ 提供了一个[上界](@entry_id:274738)，即 $E_k \ge \epsilon_k$。其中最小的根 $E_1$ 是对[基态能量](@entry_id:263704)的最佳近似。

例如，对于一个2x2系统，[久期行列式](@entry_id:274608)展开后是一个关于 $E$ 的[二次方程](@entry_id:163234) [@problem_id:1408498]：

$$
\det \begin{pmatrix} H_{11} - E S_{11} & H_{12} - E S_{12} \\ H_{21} - E S_{21} & H_{22} - E S_{22} \end{pmatrix} = 0
$$

$$
(S_{11}S_{22} - S_{12}S_{21})E^2 + (H_{12}S_{21} + H_{21}S_{12} - H_{11}S_{22} - H_{22}S_{11})E + (H_{11}H_{22} - H_{12}H_{21}) = 0
$$

解这个[二次方程](@entry_id:163234)即可得到两个能量近似值。

### [矩阵元](@entry_id:186505)的物理解释

为了深刻理解[线性变分法](@entry_id:150058)的结果，我们必须明白构成[哈密顿矩阵](@entry_id:136233)和[重叠矩阵](@entry_id:268881)的各个元素的物理意义。

**[重叠积分](@entry_id:175831) $S_{ij}$**：[重叠积分](@entry_id:175831) $S_{ij} = \langle \phi_i | \phi_j \rangle$ 是对[基函数](@entry_id:170178) $\phi_i$ 和 $\phi_j$ 在空间中重叠程度的度量。
- 对于归一化的[基函数](@entry_id:170178)，$S_{ii} = 1$。
- 如果[基函数](@entry_id:170178)是**正交的** (orthogonal)，则 $S_{ij} = 0$ ($i \neq j$)。此时[重叠矩阵](@entry_id:268881) $\mathbf{S}$ 是一个[单位矩阵](@entry_id:156724) $\mathbf{I}$。
- 根据柯西-施瓦茨不等式，对于归一化[基函数](@entry_id:170178)，必然有 $|S_{ij}| \le 1$。当且仅当两个[基函数](@entry_id:170178)[线性相关](@entry_id:185830)时，等号成立。例如，如果计算发现 $S_{12} = 1$，这意味着 $\phi_2(x) = \phi_1(x)$（对于实函数）。在这种情况下，两个[基函数](@entry_id:170178)实际上是同一个函数，它们是线性相关的，无法构成一个有效的二维基底来扩展函数空间，这使得它们成为一个糟糕的基[组选择](@entry_id:175784) [@problem_id:2014828]。

**对角[哈密顿矩阵元](@entry_id:201928) $H_{ii}$**：这个积分 $H_{ii} = \langle \phi_i | \hat{H} | \phi_i \rangle$ 代表了当体系的状态完全由单个[基函数](@entry_id:170178) $\phi_i$ 描述时，体系的[能量期望值](@entry_id:174035) [@problem_id:2014852]。在[分子轨道理论](@entry_id:137049)中，如果 $\phi_i$ 是一个[原子轨道](@entry_id:140819)，那么 $H_{ii}$（常记作 $\alpha_i$）通常被称为**[库仑积分](@entry_id:275345)** (Coulomb integral)，粗略地对应于电子处于该原子轨道上的能量。

**非对角[哈密顿矩阵元](@entry_id:201928) $H_{ij}$**：积分 $H_{ij} = \langle \phi_i | \hat{H} | \phi_j \rangle$（对于 $i \neq j$，常记作 $\beta_{ij}$）代表了状态 $\phi_i$ 和 $\phi_j$ 之间的[能量耦合](@entry_id:137595)或相互作用。它也被称为**[共振积分](@entry_id:273868)** (resonance integral)。这个项是[量子化学](@entry_id:140193)中最为关键的概念之一，因为它描述了电子在不同[基函数](@entry_id:170178)（例如，不同[原子轨道](@entry_id:140819)）之间移动的可能性。正是这个非零的耦合项导致了[基函数](@entry_id:170178)的混合，并产生了[化学键](@entry_id:138216)的稳定化能。如果假设 $H_{12} = 0$，即使[原子轨道](@entry_id:140819)之间存在空间重叠（$S_{12} \neq 0$），体系也不会获得任何由电子共享（即共振）带来的能量降低，从而无法形成稳定的[共价键](@entry_id:141465) [@problem_id:1408505]。

### 应用与实例分析

让我们通过几个具体的例子来展示[线性变分法](@entry_id:150058)的应用。

#### 情形一：[正交基](@entry_id:264024)组

当所选的[基函数](@entry_id:170178)是**正交归一** (orthonormal) 的，即 $S_{ij} = \delta_{ij}$（$\delta_{ij}$ 是克罗内克符号），计算会得到极大的简化。此时[重叠矩阵](@entry_id:268881) $\mathbf{S}$ 变为单位矩阵 $\mathbf{I}$，广义[本征值问题](@entry_id:142153) $\mathbf{H}\mathbf{c} = E\mathbf{S}\mathbf{c}$ 退化为标准的**本征值问题** [@problem_id:1408499]：

$$
\mathbf{H}\mathbf{c} = E\mathbf{c}
$$

[久期行列式](@entry_id:274608)也相应简化为 $\det(\mathbf{H} - E\mathbf{I}) = 0$。

考虑一个由两个正交[轨道](@entry_id:137151) $\phi_1, \phi_2$ 描述的体系，其[库仑积分](@entry_id:275345)分别为 $\alpha_1=H_{11}$ 和 $\alpha_2=H_{22}$，[共振积分](@entry_id:273868)为 $H_{12}$。[久期方程](@entry_id:200202)为：

$$
\det \begin{pmatrix} \alpha_1 - E & H_{12} \\ H_{12} & \alpha_2 - E \end{pmatrix} = (\alpha_1 - E)(\alpha_2 - E) - H_{12}^2 = 0
$$

解得两个[能量本征值](@entry_id:144381)：
$$
E_{\pm} = \frac{\alpha_1 + \alpha_2}{2} \pm \frac{1}{2}\sqrt{(\alpha_1 - \alpha_2)^2 + 4H_{12}^2}
$$

这两个新能级之间的能量差，即**能级分裂** (energy splitting)，完全由初始能级差 $(\alpha_1 - \alpha_2)$ 和[耦合强度](@entry_id:275517) $H_{12}$ 决定 [@problem_id:2014818]：

$$
\Delta E = E_+ - E_- = \sqrt{(\alpha_1 - \alpha_2)^2 + 4H_{12}^2}
$$

这表明，即使初始能级相同（$\alpha_1 = \alpha_2$），只要存在耦合（$H_{12} \neq 0$），体系就会分裂成两个新的能级，能量分裂大小为 $2|H_{12}|$。

#### 情形二：[同核双原子分子](@entry_id:155474)的LCAO-M[O模](@entry_id:186318)型

这是一个经典的[非正交基组](@entry_id:190211)的例子。我们用两个相同的、归一化的[原子轨道](@entry_id:140819) $\phi_A$ 和 $\phi_B$ 来构建分子[轨道](@entry_id:137151)。矩阵元为：$H_{AA} = H_{BB} = \alpha$（[库仑积分](@entry_id:275345)），$H_{AB} = H_{BA} = \beta$（[共振积分](@entry_id:273868)），$S_{AB} = S_{BA} = S$（[重叠积分](@entry_id:175831)）。[久期行列式](@entry_id:274608)为：

$$
\det \begin{pmatrix} \alpha - E & \beta - ES \\ \beta - ES & \alpha - E \end{pmatrix} = (\alpha - E)^2 - (\beta - ES)^2 = 0
$$

该方程的解为两个能级：
$$
E_+ = \frac{\alpha + \beta}{1 + S} \quad \text{(成键轨道能量)}
$$
$$
E_- = \frac{\alpha - \beta}{1 - S} \quad \text{(反键轨道能量)}
$$

由于 $\alpha$ 和 $\beta$ 通常是负值，而 $S$ 是正值，因此 $E_+$ 的能量低于 $\alpha$，而 $E_-$ 的能量高于 $\alpha$。较低的能量 $E_+$ 对应于[成键分子轨道](@entry_id:183240)，较高的能量 $E_-$ 对应于[反键分子轨道](@entry_id:192768)。

例如，在一个假设的体系中，给定 $H_{AA} = H_{BB} = -13.60 \text{ eV}$， $H_{AB} = -4.15 \text{ eV}$ 以及 $S_{AB} = 0.250$ [@problem_id:1408533]。通过变分法计算得到的两个能级为：

$$
E_{\text{成键}} = \frac{-13.60 - 4.15}{1 + 0.250} = \frac{-17.75}{1.250} = -14.20 \text{ eV}
$$

$$
E_{\text{反键}} = \frac{-13.60 - (-4.15)}{1 - 0.250} = \frac{-9.45}{0.750} = -12.60 \text{ eV}
$$

根据[变分原理](@entry_id:198028)，这两个解中能量较低的 $-14.20 \text{ eV}$ 是对该体系基态能量的最佳近似。值得注意的是，由于分母中 $(1-S)$ 的存在，[反键轨道](@entry_id:178754)的能量相对于 $\alpha$ 的升高程度要大于成键轨道的能量降低程度。

#### 情形三：一维势箱中的粒子

[线性变分法](@entry_id:150058)的普适性在于它不局限于原子轨道[基组](@entry_id:160309)。例如，我们可以用一组满足边界条件（在 $x=0$ 和 $x=L$ 处为零）的多项式函数来近似一维势箱的本征函数 [@problem_id:1408535]。假设我们使用两个函数 $\phi_1(u) = u(1-u)$ 和 $\phi_2(u) = u(1-u)(1-2u)$（其中 $u=x/L$）作为[基组](@entry_id:160309)。通过计算相应的 $H_{ij}$ 和 $S_{ij}$ 矩阵元并求解[久期方程](@entry_id:200202)，我们可以得到体系能级的近似值。例如，对于这个特定的[基组](@entry_id:160309)，计算结果表明 $H_{12}$ 和 $S_{12}$ 都恰好为零，这意味着问题被简化为两个独立的单函数[变分问题](@entry_id:756445)。计算出的前两个能级近似值为 $E_1 = 10 \mathcal{E}_0$ 和 $E_2 = 42 \mathcal{E}_0$，其中 $\mathcal{E}_0 = \frac{\hbar^2}{2mL^2}$。而一维势箱的精确能级为 $E_n^{\text{exact}} = n^2 \pi^2 \mathcal{E}_0 / 2$。因此，精确的前两个能级是 $\epsilon_1 \approx 4.93 \mathcal{E}_0$ 和 $\epsilon_2 \approx 19.74 \mathcal{E}_0$。我们的近似值 $E_1$ 和 $E_2$ 确实都高于相应的精确值，这与 Hylleraas-Undheim-MacDonald 定理的预测完全一致。

### [基组](@entry_id:160309)的完备性与计算结果的收敛

[变分法](@entry_id:163656)的一个核心优势是其结果具有**系统可改进性**。理论上，如果我们选择的[基函数](@entry_id:170178)集合 $\{\phi_i\}$ 构成一个**完备集** (complete set)，那么任何函数（包括真实的[波函数](@entry_id:147440)）都可以精确地表示为这组[基函数](@entry_id:170178)的线性组合。在这种极限情况下，[线性变分法](@entry_id:150058)将给出精确的能量和[波函数](@entry_id:147440)。

在实践中，我们总是使用有限大小的[基组](@entry_id:160309)。然而，[变分原理](@entry_id:198028)保证了，当我们向[基组](@entry_id:160309)中增加新的、线性无关的函数时，计算得到的基态能量近似值只会变得更好（即更低）或保持不变，绝不会变差。

考虑一个例子，我们使用一个三函数正交基组来计算一个体系的能量 [@problem_id:2014845]。哈密顿矩阵为：
$$
H = \epsilon \begin{pmatrix} 5 & -1 & 0 \\ -1 & 5 & -1 \\ 0 & -1 & 5 \end{pmatrix}
$$
如果我们首先只用前两个[基函数](@entry_id:170178) $\{\phi_1, \phi_2\}$ 进行计算，相当于求解左上角的 $2 \times 2$ 矩阵的[本征值](@entry_id:154894)。其最低[本征值](@entry_id:154894)为 $4\epsilon$。

接着，我们使用完整的三个函数基组 $\{\phi_1, \phi_2, \phi_3\}$ 进行计算，即求解 $3 \times 3$ 矩阵的[本征值](@entry_id:154894)。计算可得，其最低[本征值](@entry_id:154894)为 $(5 - \sqrt{2})\epsilon \approx 3.586\epsilon$。

正如预期的那样，$3.586\epsilon < 4\epsilon$。通过扩大[基组](@entry_id:160309)，我们获得了对[基态能量](@entry_id:263704)更低的、因此也更准确的近似。这个特性是现代计算化学的基石：通过系统地增大[基组](@entry_id:160309)的规模，我们可以逐步逼近所谓的**哈特里-福克极限** ([Hartree-Fock](@entry_id:142303) limit)，从而获得对体系性质越来越精确的理论预测。