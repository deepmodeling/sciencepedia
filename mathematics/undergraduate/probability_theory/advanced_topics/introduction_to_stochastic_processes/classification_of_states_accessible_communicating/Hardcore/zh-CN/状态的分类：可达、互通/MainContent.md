## 引言
[马尔可夫链](@entry_id:150828)是描述随机系统演化的强大数学工具，其魅力不仅在于预测下一步的走向，更在于揭示系统的[长期行为](@entry_id:192358)。然而，系统中的每个状态并非生而平等：有些只是匆匆过客，有些则是最终归宿。要理解这种差异，我们必须首先对状态进行系统性的分类，但这正是许多初学者面临的知识缺口。本文旨在填补这一空白，引导读者深入探索马尔可夫链状态空间的内在结构。

在接下来的三个章节中，我们将：
*   在“**原理与机制**”中，建立可达性、互通性与[互通类](@entry_id:267280)的基本概念，学习如何将复杂的[状态空间分解](@entry_id:175473)为更易于分析的[子集](@entry_id:261956)。
*   在“**应用与跨学科联系**”中，探索这些理论如何在物理、工程、经济等多个领域大放异彩，揭示真实世界系统的内在动态。
*   通过“**动手实践**”中的具体问题，将理论知识转化为解决问题的能力，巩固所学。

现在，让我们从最基础的原理开始，揭开[状态分类](@entry_id:276397)的神秘面纱。

## 原理与机制

在对[马尔可夫链的长期行为](@entry_id:272323)进行分析之前，我们必须首先理解其状态空间的结构。并非所有状态都具有相同的行为特性。一些状态可能是暂时的停留点，而另一些则可能是最终归宿。为了系统地描述这些差异，我们引入了可达性、互通性以及[互通类](@entry_id:267280)的概念。这些工具使我们能够将[状态空间分解](@entry_id:175473)为更小的、内部行为一致的[子集](@entry_id:261956)，从而为进一步分析（如周期性、常返性和暂留性）奠定基础。

### [可达性](@entry_id:271693)：状态间的路径

在[马尔可夫链](@entry_id:150828)中，我们首先关心的问题是：从一个状态出发，我们能否到达另一个状态？这个概念被称为**[可达性](@entry_id:271693)**（accessibility）。

形式上，如果从状态 $i$ 出发，经过有限步（$n \ge 1$）之后有大于零的概率到达状态 $j$，我们就说状态 $j$ 是从状态 $i$ **可达**的。我们用符号 $i \to j$ 来表示。在数学上，这等价于存在某个整数 $n \ge 1$，使得 $n$ 步转移概率 $P_{ij}^{(n)} > 0$。

需要强调的是，[可达性](@entry_id:271693)是一种有向关系，它不一定是对称的。即 $i \to j$ 并不意味着 $j \to i$。许多现实世界的过程都表现出这种单[向性](@entry_id:144651)。

例如，考虑一个简单的[疾病传播](@entry_id:170042)模型，其中人群的状态由感染人数定义。假设一个群体最初是完全健康的（状态 $S_0$，0人感染）。由于存在感染的风险，系统有可能在下一步变为有1人感染的状态（$S_1$）。因此，状态 $S_1$ 是从状态 $S_0$ 可达的，即 $S_0 \to S_1$。然而，如果模型规定一旦被感染就无法康复，那么感染人数永远不会减少。这意味着从有1人感染的状态 $S_1$ 永远不可能回到完全健康的状态 $S_0$。因此，$S_0$ 从 $S_1$ 是不可达的。

同样地，在[群体遗传学](@entry_id:146344)的一个简化模型中，我们追踪一个植物谱系的基因型。一个[杂合子](@entry_id:276964)（Aa）亲本通过自花[授粉](@entry_id:140665)，有 $\frac{1}{4}$ 的概率产生纯合显性（AA）后代。因此，状态 AA 是从状态 Aa 可达的（$Aa \to AA$）。但是，一个纯合显性（AA）亲本只会产生 AA 后代，它永远不可能产生 Aa 后代。于是，状态 Aa 从状态 AA 是不可达的。在这种情况下，状态 AA（以及类似的 aa）就像一个陷阱，一旦进入就无法离开，我们称之为**吸收态**（absorbing state）。

### 互通性：双向可达

当两个状态可以相互到达时，我们称它们**互通**（communicate）。

状态 $i$ 和状态 $j$ 互通，记作 $i \leftrightarrow j$，当且仅当 $i \to j$ 并且 $j \to i$。与可达性不同，互通性是一种**等价关系**。这意味着它满足三个关键属性：
1.  **[自反性](@entry_id:137262)**：任何状态 $i$ 都与自身互通（$i \leftrightarrow i$），只要它有可能在有限步后返回自身。
2.  **对称性**：如果 $i \leftrightarrow j$，那么 $j \leftrightarrow i$（这由定义直接得出）。
3.  **[传递性](@entry_id:141148)**：如果 $i \leftrightarrow j$ 且 $j \leftrightarrow k$，那么 $i \leftrightarrow k$。这是因为从 $i$ 到 $k$ 的路径可以通过 $i \to j \to k$ 构成，而从 $k$ 到 $i$ 的路径可以通过 $k \to j \to i$ 构成。

互通的概念对于理解[马尔可夫链](@entry_id:150828)的结构至关重要。我们可以通过一个简单的人工语言[生成模型](@entry_id:177561)来说明。假设模型只有两个状态：$S_V$（刚生成一个元音）和 $S_C$（刚生成一个辅音）。规则是：元音后面必须跟一个辅音，而辅音后面可以跟元音（概率为 $p$）或另一个辅音（概率为 $1-p$），其中 $0  p  1$。
从状态 $S_V$ 出发，下一步必然是 $S_C$，所以 $S_V \to S_C$。
从状态 $S_C$ 出发，由于 $p>0$，有正的概率在下一步生成一个元音，从而转移到 $S_V$，所以 $S_C \to S_V$。
由于两个状态可以相互到达，我们说 $S_V$ 和 $S_C$ 互通 ($S_V \leftrightarrow S_C$)。

可达性并不总是需要一步完成。考虑一个简化的天气模型，包含三个状态：晴天（S）、阴天（C）和雨天（R）。假设转移规则是：
*   晴天只能变为晴天或阴天。
*   阴天可以变为晴天、阴天或雨天。
*   雨天只能变为阴天或雨天。
在这个模型中，从晴天到雨天不可能一步完成（$P_{SR}=0$）。但是，我们可以通过阴天作为中介：从晴天到阴天，再从阴天到雨天。由于 $P_{SC} > 0$ 且 $P_{CR} > 0$，路径 $S \to C \to R$ 是可能的，因此 $S \to R$。同样，从雨天到晴天也不能一步完成，但路径 $R \to C \to S$ 是可能的，因此 $R \to S$。由于 S、C、R 两两之间都可以相互到达，它们都互通。

### [互通类](@entry_id:267280)与不可约性

互通关系作为一种等价关系，自然地将马尔可夫链的整个状态空间 $S$ **划分**（partition）为若干个不相交的[子集](@entry_id:261956)，这些[子集](@entry_id:261956)被称为**[互通类](@entry_id:267280)**（communicating classes）。在同一个[互通类](@entry_id:267280)中，所有状态都相互互通。而对于不同[互通类](@entry_id:267280)中的两个状态，它们必然不互通。

*   当整个[状态空间](@entry_id:177074)只形成一个[互通类](@entry_id:267280)时，我们称这个[马尔可夫链](@entry_id:150828)是**不可约的**（irreducible）。在一个不可约的[马尔可夫链](@entry_id:150828)中，从任何状态出发，都有可能到达任何其他状态。我们上面讨论的天气模型就是一个不[可约链](@entry_id:200553)的例子。

*   如果[马尔可夫链](@entry_id:150828)至少有两个[互通类](@entry_id:267280)，则称其为**可约的**（reducible）。

让我们看几个[可约链](@entry_id:200553)的例子。
考虑一个[确定性系统](@entry_id:174558)，其状态为 $\{0, 1, \dots, 9\}$，演化规则为 $X_{n+1} = (X_n + 2) \pmod{10}$。如果从一个偶数状态（如 0）开始，序列将是 $0 \to 2 \to 4 \to 6 \to 8 \to 0 \to \dots$。如果从一个奇数状态（如 1）开始，序列将是 $1 \to 3 \to 5 \to 7 \to 9 \to 1 \to \dots$。显然，偶数状态永远无法到达奇数状态，反之亦然。因此，状态空间被划分为两个[互通类](@entry_id:267280)：偶数集 $\{0, 2, 4, 6, 8\}$ 和奇数集 $\{1, 3, 5, 7, 9\}$。

另一个更复杂的例子是城市交通网络。假设一个系统有红、蓝、绿三条地铁线。红线和蓝线在“中心站”交汇，乘客可以在此换乘，因此所有红线和蓝线上的车站（包括中心站）都相互连通，构成一个大的[互通类](@entry_id:267280)。现在，假设有一条从蓝线 B3 站到绿线 C1 站的单向巴士，并且绿线自身内部的站点是相连的。这意味着，从红/蓝线网络中的任何一站出发，都可以到达绿线上的任何一站。然而，由于巴士是单向的，且没有其他方式离开绿线，一旦进入绿线网络，就无法返回红/蓝线网络。因此，绿线上的所有站点构成了另一个独立的[互通类](@entry_id:267280)。这个交通系统被划分为两个[互通类](@entry_id:267280)。

### [互通类](@entry_id:267280)的性质：封闭、[常返与暂留](@entry_id:265162)

将[状态空间](@entry_id:177074)划分为[互通类](@entry_id:267280)后，我们可以进一步研究这些类的性质，这与[马尔可夫链的长期行为](@entry_id:272323)密切相关。

一个[互通类](@entry_id:267280) $C$ 如果一旦进入就无法离开，则称其为**封闭的**（closed）。形式上，对于任何状态 $i \in C$ 和任何状态 $j \notin C$，[一步转移概率](@entry_id:272678) $P_{ij}$ 必须为 0。

*   在上述交通模型中，绿线站点的集合是一个封闭类，因为没有从绿线到其他线路的出口。
*   在网站导航模型中，假设状态 {1, 2, 3} 分别代表主页、功能页和价格页，它们相互之间可以跳转。但从主页有一定概率会进入错误页（状态 4），而错误页是一个[吸收态](@entry_id:161036)（即 $P_{44}=1$）。这里，[互通类](@entry_id:267280) $\{1, 2, 3\}$ 不是封闭的，因为存在从状态 1 到状态 4 的“逃逸”路径。而[互通类](@entry_id:267280) $\{4\}$ 本身是封闭的。
*   在另一个由[有向图](@entry_id:272310)定义的模型中，状态 $\{1, 2, 3\}$ 形成一个循环，但存在从 $3 \to 4$ 的转移。而状态 $\{4, 5\}$ 形成另一个循环，且没有向外的转移。因此，类 $\{1, 2, 3\}$ 不是封闭的，而类 $\{4, 5\}$ 是封闭的。

[互通类](@entry_id:267280)的封闭性直接关系到其中状态的**常返性**（recurrence）和**暂留性**（transience）。一个状态 $i$ 被称为**常返的**，如果从 $i$ 出发，最终返回 $i$ 的概率为 1。反之，如果返回的概率小于 1，则该状态被称为**暂留的**。

一个基本而强大的定理是：**在一个[互通类](@entry_id:267280)中，所有状态的性质都是相同的**。也就是说，如果一个状态是常返的，那么该类中所有其他状态也都是常返的（我们称之为**[常返类](@entry_id:273689)**）。如果一个状态是暂留的，那么该类中所有其他状态也都是暂留的（我们称之为**暂留类**）。

对于**有限状态[马尔可夫链](@entry_id:150828)**，我们有另一个关键结论：
*   一个[互通类](@entry_id:267280)是**常返的，当且仅当它是封闭的**。
*   因此，一个[互通类](@entry_id:267280)是**暂留的，当且仅当它不是封闭的**。

让我们将此应用于之前的例子：
*   在网站导航模型中，类 $\{1, 2, 3\}$ 不封闭，因此它是暂留类。这意味着用户最终会离开这些页面并陷入错误页，不会无限次地在它们之间浏览。类 $\{4\}$ 是封闭的，因此是[常返类](@entry_id:273689)。
*   在一个 $N \times N$ 网格上移动的粒[子模](@entry_id:148922)型中，所有网格点都相互可达，构成一个大的[互通类](@entry_id:267280)。但如果粒子在对角线上的点有一定概率 $p0$ 被转移到一个特殊的吸收态 $S_A$，那么这个大的网格类就不是封闭的。因此，尽管网格内部是连通的，但所有网格点都是暂留状态。粒子迟早会离开网格进入[吸收态](@entry_id:161036) $S_A$。而[吸收态](@entry_id:161036) $\{S_A\}$ 本身构成一个封闭的[常返类](@entry_id:273689)。

### 特例与无限[状态空间](@entry_id:177074)

对于无限状态空间，情况会变得更加微妙。“封闭”不再直接等同于“常返”。然而，可达性和互通性的基本定义仍然是分析的基石。

考虑一个在正整数 $\mathbb{Z}^+$ 上运动的过程。规则如下：1 是[吸收态](@entry_id:161036)；任何偶数 $k1$ 转移到 $k/2$；任何奇数 $k1$ 转移到 $k-1$ 或 $k+1$。
首先，状态 1 是一个[吸收态](@entry_id:161036)，它自身构成一个封闭的、常返的[互通类](@entry_id:267280) $\{1\}$。
对于任何其他状态 $k  1$，我们发现系统的状态值具有明确的下降趋势。从偶数 $k$ 出发，下一步是 $k/2$，值减小。从奇数 $k  1$ 出发，下一步是 $k-1$ 或 $k+1$（均为偶数），再下一步则是 $(k-1)/2$ 或 $(k+1)/2$，这两个值都严格小于 $k$。这意味着从任何状态 $k1$ 出发的任何路径，其状态值最终必然会减小，永远无法返回到 $k$。因此，不可能存在包含 $k1$ 的回路。
没有回路意味着对于任何两个不同的状态 $i, j  1$，它们不可能互通。因此，对于所有 $k1$，每个状态 $\{k\}$ 都自成一个[互通类](@entry_id:267280)。由于从 $k$ 出发永远不会返回 $k$，这些 singleton 类都是暂留的。最终，过程将不可避免地到达状态 1。这个例子展示了[状态空间](@entry_id:177074)可以被划分为一个[常返类](@entry_id:273689)和无穷多个暂留类。

通过可达性、互通性和[互通类](@entry_id:267280)的概念，我们能够将复杂的马尔可夫链分解为结构上更简单的组成部分。识别这些类以及它们的封闭性，是判断状态是暂留还是常返的第一步，也是理解马尔可夫链长期动态行为的关键。