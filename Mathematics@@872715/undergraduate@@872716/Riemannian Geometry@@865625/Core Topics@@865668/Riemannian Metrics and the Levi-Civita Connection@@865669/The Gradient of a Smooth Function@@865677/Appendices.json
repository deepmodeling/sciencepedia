{"hands_on_practices": [{"introduction": "Understanding abstract concepts often begins by connecting them to familiar territory. This first exercise [@problem_id:3071952] serves as a bridge between the vector calculus gradient and its more general definition in Riemannian geometry. By considering a simple radial function on the Euclidean plane, we use the fundamental identity $g(\\nabla f, X) = df(X)$ to re-derive a result you might already know intuitively: the gradient points in the radial direction. This practice reinforces that the Riemannian framework is a consistent generalization of Euclidean concepts and helps build confidence in applying its core definitions.", "problem": "Consider the smooth manifold $\\mathbb{R}^{2}$ equipped with the standard Euclidean Riemannian metric. Introduce polar coordinates $(r,\\theta)$ on $\\mathbb{R}^{2}$, with the coordinate transformation $x=r\\cos\\theta$ and $y=r\\sin\\theta$, and recall that the Euclidean metric in these coordinates is $g=dr^{2}+r^{2}d\\theta^{2}$. Let $f:\\mathbb{R}^{2}\\setminus\\{0\\}\\to\\mathbb{R}$ be a smooth radial function, meaning $f(p)$ depends only on the radius $r$ of $p$ and can be written as $f(r)$ for $r>0$.\n\nStarting from the defining property of the gradient on a Riemannian manifold, namely that for every vector field $X$, the gradient $\\nabla f$ is characterized by the identity $g(\\nabla f,X)=df(X)$, derive an explicit expression for $\\nabla f$ in terms of the Cartesian coordinates $(x,y)$. Then, using your expression, justify from first principles that $\\nabla f$ is directed along the radial direction and determine its magnitude in terms of $f'(r)$ and the metric $g$.\n\nProvide your final answer as the two Cartesian components of $\\nabla f$ written purely in terms of $x$ and $y$ and the derivative $f'$, as a single analytic expression. No rounding is required.", "solution": "The problem statement is self-contained, mathematically sound, and well-posed. It requests the derivation of the gradient of a radial function on the Euclidean plane from first principles, a standard exercise in differential geometry. All terms are clearly defined, and the premises are consistent with established mathematical theory. The problem is therefore valid.\n\nWe begin by formally deriving the expression for the gradient, $\\nabla f$, of a smooth function $f$ on a Riemannian manifold $(M,g)$. The gradient vector field $\\nabla f$ is uniquely defined by the relation:\n$$\ng(\\nabla f, X) = df(X)\n$$\nfor every smooth vector field $X$ on $M$.\n\nThe manifold under consideration is $\\mathbb{R}^{2}$ with the standard Euclidean metric, which in Cartesian coordinates $(x,y)$ is given by $g = dx^2 + dy^2$. In this coordinate system, the local basis for the tangent space at any point is $\\{\\frac{\\partial}{\\partial x}, \\frac{\\partial}{\\partial y}\\}$. The components of the metric tensor are $g_{xx} = 1$, $g_{yy} = 1$, and $g_{xy} = g_{yx} = 0$.\n\nLet us express the gradient vector field $\\nabla f$ and an arbitrary test vector field $X$ in terms of their Cartesian components:\n$$\n\\nabla f = (\\nabla f)^x \\frac{\\partial}{\\partial x} + (\\nabla f)^y \\frac{\\partial}{\\partial y}\n$$\n$$\nX = X^x \\frac{\\partial}{\\partial x} + X^y \\frac{\\partial}{\\partial y}\n$$\nThe left-hand side of the defining identity becomes:\n$$\ng(\\nabla f, X) = g\\left( (\\nabla f)^x \\frac{\\partial}{\\partial x} + (\\nabla f)^y \\frac{\\partial}{\\partial y}, X^x \\frac{\\partial}{\\partial x} + X^y \\frac{\\partial}{\\partial y} \\right)\n$$\nBy the bilinearity of the metric, and using the component values $g(\\frac{\\partial}{\\partial x}, \\frac{\\partial}{\\partial x}) = 1$, $g(\\frac{\\partial}{\\partial y}, \\frac{\\partial}{\\partial y}) = 1$, and $g(\\frac{\\partial}{\\partial x}, \\frac{\\partial}{\\partial y}) = 0$, we have:\n$$\ng(\\nabla f, X) = (\\nabla f)^x X^x + (\\nabla f)^y X^y\n$$\n\nThe right-hand side of the defining identity involves the differential $df$ of the function $f$. In Cartesian coordinates, the differential is given by:\n$$\ndf = \\frac{\\partial f}{\\partial x} dx + \\frac{\\partial f}{\\partial y} dy\n$$\nApplying $df$ to the vector field $X$ yields:\n$$\ndf(X) = \\left( \\frac{\\partial f}{\\partial x} dx + \\frac{\\partial f}{\\partial y} dy \\right) \\left( X^x \\frac{\\partial}{\\partial x} + X^y \\frac{\\partial}{\\partial y} \\right) = \\frac{\\partial f}{\\partial x} X^x + \\frac{\\partial f}{\\partial y} X^y\n$$\n\nEquating the expressions for $g(\\nabla f, X)$ and $df(X)$:\n$$\n(\\nabla f)^x X^x + (\\nabla f)^y X^y = \\frac{\\partial f}{\\partial x} X^x + \\frac{\\partial f}{\\partial y} X^y\n$$\nThis identity must hold for all choices of components $X^x$ and $X^y$. By choosing $X = \\frac{\\partial}{\\partial x}$ (i.e., $X^x=1, X^y=0$) and then $X = \\frac{\\partial}{\\partial y}$ (i.e., $X^x=0, X^y=1$), we can individually equate the coefficients:\n$$\n(\\nabla f)^x = \\frac{\\partial f}{\\partial x}\n$$\n$$\n(\\nabla f)^y = \\frac{\\partial f}{\\partial y}\n$$\nThus, for the Euclidean metric in Cartesian coordinates, the gradient vector field is simply $\\nabla f = \\frac{\\partial f}{\\partial x} \\frac{\\partial}{\\partial x} + \\frac{\\partial f}{\\partial y} \\frac{\\partial}{\\partial y}$.\n\nThe problem specifies that $f$ is a smooth radial function, meaning $f$ depends only on the radius $r = \\sqrt{x^2 + y^2}$. We write this as $f(x,y) = f(r(x,y))$. We denote the derivative of $f$ with respect to its argument $r$ by $f'(r) = \\frac{df}{dr}$. To find the Cartesian components of $\\nabla f$, we must compute the partial derivatives $\\frac{\\partial f}{\\partial x}$ and $\\frac{\\partial f}{\\partial y}$ using the chain rule.\n\nFirst, we compute the partial derivatives of $r$:\n$$\n\\frac{\\partial r}{\\partial x} = \\frac{\\partial}{\\partial x} (x^2 + y^2)^{1/2} = \\frac{1}{2}(x^2 + y^2)^{-1/2}(2x) = \\frac{x}{\\sqrt{x^2+y^2}} = \\frac{x}{r}\n$$\n$$\n\\frac{\\partial r}{\\partial y} = \\frac{\\partial}{\\partial y} (x^2 + y^2)^{1/2} = \\frac{1}{2}(x^2 + y^2)^{-1/2}(2y) = \\frac{y}{\\sqrt{x^2+y^2}} = \\frac{y}{r}\n$$\nNote that these expressions are well-defined on the domain $\\mathbb{R}^2\\setminus\\{0\\}$, where $r > 0$.\n\nNow, applying the chain rule to $f$:\n$$\n(\\nabla f)^x = \\frac{\\partial f}{\\partial x} = \\frac{df}{dr} \\frac{\\partial r}{\\partial x} = f'(r) \\frac{x}{r}\n$$\n$$\n(\\nabla f)^y = \\frac{\\partial f}{\\partial y} = \\frac{df}{dr} \\frac{\\partial r}{\\partial y} = f'(r) \\frac{y}{r}\n$$\nThe gradient vector field can thus be written as:\n$$\n\\nabla f = \\left(f'(r) \\frac{x}{r}\\right) \\frac{\\partial}{\\partial x} + \\left(f'(r) \\frac{y}{r}\\right) \\frac{\\partial}{\\partial y} = \\frac{f'(r)}{r} \\left(x \\frac{\\partial}{\\partial x} + y \\frac{\\partial}{\\partial y}\\right)\n$$\nSubstituting $r=\\sqrt{x^2+y^2}$ gives the components purely in terms of $x$ and $y$:\n$$\n(\\nabla f)^x = \\frac{f'(\\sqrt{x^2+y^2})}{\\sqrt{x^2+y^2}} x\n$$\n$$\n(\\nabla f)^y = \\frac{f'(\\sqrt{x^2+y^2})}{\\sqrt{x^2+y^2}} y\n$$\nThis is the explicit expression for $\\nabla f$ in Cartesian coordinates.\n\nNext, we justify that $\\nabla f$ is directed along the radial direction. The vector component of $\\nabla f$ is $x \\frac{\\partial}{\\partial x} + y \\frac{\\partial}{\\partial y}$. At a point $p=(x,y)$, this vector corresponds to the tuple $(x,y)$, which is the position vector of the point $p$ relative to the origin. The direction of the position vector is, by definition, the radial direction. Since $\\nabla f$ is a scalar multiple, $\\frac{f'(r)}{r}$, of this radial vector field, $\\nabla f$ is itself directed along the radial direction at every point.\n\nFinally, we determine the magnitude of $\\nabla f$, denoted $\\|\\nabla f\\|_g$. The magnitude squared is given by $\\|\\nabla f\\|_g^2 = g(\\nabla f, \\nabla f)$. Using the Cartesian components we derived:\n$$\n\\|\\nabla f\\|_g^2 = \\left(f'(r) \\frac{x}{r}\\right)^2 + \\left(f'(r) \\frac{y}{r}\\right)^2 = \\frac{(f'(r))^2}{r^2} (x^2 + y^2)\n$$\nSince $r^2 = x^2 + y^2$, the expression simplifies to:\n$$\n\\|\\nabla f\\|_g^2 = \\frac{(f'(r))^2}{r^2} (r^2) = (f'(r))^2\n$$\nThe magnitude of the gradient is the square root of this value:\n$$\n\\|\\nabla f\\|_g = \\sqrt{(f'(r))^2} = |f'(r)|\n$$\nThis demonstrates that the magnitude of the gradient of a radial function depends only on the rate of change of the function with respect to the radius.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{f'(\\sqrt{x^2+y^2})}{\\sqrt{x^2+y^2}} x & \\frac{f'(\\sqrt{x^2+y^2})}{\\sqrt{x^2+y^2}} y \\end{pmatrix}}\n$$", "id": "3071952"}, {"introduction": "What does \"direction of steepest ascent\" truly mean? This question lies at the heart of Riemannian geometry. This practice [@problem_id:3071958] provides a striking and computationally clear illustration that the gradient's direction is not an intrinsic property of a function, but is fundamentally determined by the metric used to measure lengths and angles. By calculating the gradient of the same linear function with respect to two different metrics—the familiar Euclidean metric and a simple anisotropic one—you will see firsthand how the geometry dictates the path of greatest change.", "problem": "Let $\\mathbb{R}^{2}$ be endowed with two Riemannian metrics: the standard Euclidean metric $g_{0}$ given by the usual dot product, and an anisotropic metric $g$ defined at every point by the constant positive-definite bilinear form with matrix\n$$\nA = \\begin{pmatrix} 1 & 0 \\\\ 0 & 4 \\end{pmatrix}\n$$\nin the standard coordinates. Consider the smooth function $f:\\mathbb{R}^{2}\\to\\mathbb{R}$ given by $f(x,y)=x+2y$. Using only the defining property of the gradient with respect to a Riemannian metric—namely, that for any vector field $X$, the gradient $\\nabla^{g} f$ is the unique vector field satisfying $g\\left(\\nabla^{g} f, X\\right)=df(X)$—do the following:\n\n- Compute the gradient $\\nabla^{g_{0}} f$ with respect to the Euclidean metric $g_{0}$.\n- Compute the gradient $\\nabla^{g} f$ with respect to the anisotropic metric $g$.\n- Using the standard Euclidean notion of angle in $\\mathbb{R}^{2}$, compute the angle $\\theta$ (in radians) between the vectors $\\nabla^{g_{0}} f$ and $\\nabla^{g} f$.\n\nExpress the final answer as a single exact analytic expression for $\\theta$ in radians (do not approximate or round). The purpose is to exhibit explicitly that changing the metric to an anisotropic one modifies the direction of $\\nabla f$ for this fixed $f$.", "solution": "The problem requires the computation of the gradient of a smooth function with respect to two different Riemannian metrics on $\\mathbb{R}^{2}$ and the angle between the resulting gradient vectors. The core of the problem is to use the fundamental definition of the gradient vector field.\n\nLet $f: \\mathbb{R}^{2} \\to \\mathbb{R}$ be a smooth function and $g$ a Riemannian metric on $\\mathbb{R}^{2}$. The gradient of $f$ with respect to $g$, denoted $\\nabla^{g} f$, is the unique vector field that satisfies the relation\n$$g\\left(\\nabla^{g} f, X\\right) = df(X)$$\nfor any arbitrary vector field $X$ on $\\mathbb{R}^{2}$. Here, $df$ is the differential of $f$, which is a $1$-form.\n\nThe given function is $f(x,y) = x+2y$. Its differential is\n$$df = \\frac{\\partial f}{\\partial x} dx + \\frac{\\partial f}{\\partial y} dy = 1 \\cdot dx + 2 \\cdot dy$$\nLet us consider a general vector field $X$ on $\\mathbb{R}^{2}$. In the standard coordinate basis $\\{\\partial_x, \\partial_y\\}$, we can write $X$ as $X = X^1 \\partial_x + X^2 \\partial_y$. The action of the $1$-form $df$ on $X$ is\n$$df(X) = (dx + 2dy)(X^1 \\partial_x + X^2 \\partial_y) = X^1 dx(\\partial_x) + X^2 dx(\\partial_y) + 2X^1 dy(\\partial_x) + 2X^2 dy(\\partial_y)$$\nUsing the property that $dx^i(\\partial_j) = \\delta^i_j$ (where $x^1=x, x^2=y$), we get\n$$df(X) = X^1(1) + X^2(0) + 2X^1(0) + 2X^2(1) = X^1 + 2X^2$$\n\nFirst, we compute the gradient $\\nabla^{g_{0}} f$ with respect to the standard Euclidean metric $g_{0}$.\nThe metric $g_{0}$ is represented by the identity matrix $I = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}$ in the standard basis. This means $g_{0}(\\partial_x, \\partial_x) = 1$, $g_{0}(\\partial_y, \\partial_y) = 1$, and $g_{0}(\\partial_x, \\partial_y) = 0$.\nLet the gradient vector field be written in coordinates as $\\nabla^{g_{0}} f = G_0^1 \\partial_x + G_0^2 \\partial_y$. We must find the components $G_0^1$ and $G_0^2$. Using the defining property:\n$$g_{0}(\\nabla^{g_{0}} f, X) = g_{0}(G_0^1 \\partial_x + G_0^2 \\partial_y, X^1 \\partial_x + X^2 \\partial_y)$$\nBy the bilinearity of the metric, this expands to:\n$$g_{0}(\\nabla^{g_{0}} f, X) = G_0^1 X^1 g_{0}(\\partial_x, \\partial_x) + G_0^1 X^2 g_{0}(\\partial_x, \\partial_y) + G_0^2 X^1 g_{0}(\\partial_y, \\partial_x) + G_0^2 X^2 g_{0}(\\partial_y, \\partial_y)$$\n$$g_{0}(\\nabla^{g_{0}} f, X) = G_0^1 X^1 (1) + G_0^1 X^2 (0) + G_0^2 X^1 (0) + G_0^2 X^2 (1) = G_0^1 X^1 + G_0^2 X^2$$\nEquating this with $df(X)$, we have:\n$$G_0^1 X^1 + G_0^2 X^2 = X^1 + 2X^2$$\nSince this equality must hold for all choices of $X^1$ and $X^2$, we can equate coefficients:\n$$G_0^1 = 1 \\quad \\text{and} \\quad G_0^2 = 2$$\nTherefore, the gradient with respect to the Euclidean metric is $\\nabla^{g_{0}} f = 1 \\cdot \\partial_x + 2 \\cdot \\partial_y$. As a vector in $\\mathbb{R}^{2}$, this is $(1, 2)$.\n\nNext, we compute the gradient $\\nabla^{g} f$ with respect to the anisotropic metric $g$.\nThe metric $g$ is represented by the matrix $A = \\begin{pmatrix} 1 & 0 \\\\ 0 & 4 \\end{pmatrix}$ in the standard basis. This means $g(\\partial_x, \\partial_x) = 1$, $g(\\partial_y, \\partial_y) = 4$, and $g(\\partial_x, \\partial_y) = 0$.\nLet the gradient vector field be $\\nabla^{g} f = G^1 \\partial_x + G^2 \\partial_y$.\nUsing the defining property:\n$$g(\\nabla^{g} f, X) = g(G^1 \\partial_x + G^2 \\partial_y, X^1 \\partial_x + X^2 \\partial_y)$$\n$$g(\\nabla^{g} f, X) = G^1 X^1 g(\\partial_x, \\partial_x) + G^1 X^2 g(\\partial_x, \\partial_y) + G^2 X^1 g(\\partial_y, \\partial_x) + G^2 X^2 g(\\partial_y, \\partial_y)$$\n$$g(\\nabla^{g} f, X) = G^1 X^1 (1) + G^1 X^2 (0) + G^2 X^1 (0) + G^2 X^2 (4) = G^1 X^1 + 4G^2 X^2$$\nEquating this with $df(X)$, we have:\n$$G^1 X^1 + 4G^2 X^2 = X^1 + 2X^2$$\nSince this must hold for all $X^1$ and $X^2$, we equate coefficients:\n$$G^1 = 1 \\quad \\text{and} \\quad 4G^2 = 2 \\implies G^2 = \\frac{1}{2}$$\nTherefore, the gradient with respect to the anisotropic metric is $\\nabla^{g} f = 1 \\cdot \\partial_x + \\frac{1}{2} \\cdot \\partial_y$. As a vector in $\\mathbb{R}^{2}$, this is $(1, \\frac{1}{2})$.\n\nFinally, we compute the angle $\\theta$ between the two gradient vectors $\\nabla^{g_{0}} f$ and $\\nabla^{g} f$. The problem specifies to use the standard Euclidean notion of angle, which corresponds to the dot product of $\\mathbb{R}^2$ (i.e., the metric $g_0$).\nLet $V_0 = \\nabla^{g_{0}} f = (1, 2)$ and $V = \\nabla^{g} f = (1, \\frac{1}{2})$.\nThe angle $\\theta$ between two vectors $V_0$ and $V$ in Euclidean space is given by the formula:\n$$\\cos(\\theta) = \\frac{V_0 \\cdot V}{\\|V_0\\|_{g_0} \\|V\\|_{g_0}}$$\nwhere $\\cdot$ denotes the standard dot product and $\\| \\cdot \\|_{g_0}$ is the standard Euclidean norm.\nThe dot product is:\n$$V_0 \\cdot V = (1)(1) + (2)\\left(\\frac{1}{2}\\right) = 1 + 1 = 2$$\nThe Euclidean norms are:\n$$\\|V_0\\|_{g_0} = \\sqrt{1^2 + 2^2} = \\sqrt{1+4} = \\sqrt{5}$$\n$$\\|V\\|_{g_0} = \\sqrt{1^2 + \\left(\\frac{1}{2}\\right)^2} = \\sqrt{1+\\frac{1}{4}} = \\sqrt{\\frac{5}{4}} = \\frac{\\sqrt{5}}{2}$$\nNow, we compute $\\cos(\\theta)$:\n$$\\cos(\\theta) = \\frac{2}{\\sqrt{5} \\cdot \\frac{\\sqrt{5}}{2}} = \\frac{2}{\\frac{5}{2}} = \\frac{4}{5}$$\nThe angle $\\theta$ is the principal value of the arccosine of this result.\n$$\\theta = \\arccos\\left(\\frac{4}{5}\\right)$$\nThis is an exact analytic expression for the angle in radians.", "answer": "$$\\boxed{\\arccos\\left(\\frac{4}{5}\\right)}$$", "id": "3071958"}, {"introduction": "Having explored the conceptual foundations, we now turn to developing computational fluency. This exercise [@problem_id:3071960] challenges you to calculate the squared norm of a gradient in a more complex scenario, involving a non-trivial, position-dependent metric. Successfully navigating this problem requires correctly applying the full coordinate-based formula for $|\\nabla f|^2$, which involves computing inverse metric components and managing several terms. This practice is designed to solidify your understanding of how the components of the metric, its inverse, and the function's partial derivatives all combine to define the gradient's magnitude at every point.", "problem": "Let $M=\\mathbb{R}^{2}$ with global coordinates $(x,y)$ and a Riemannian metric $g$ whose coordinate components are\n$$\ng_{11}(x,y)=1+x^{2},\\quad g_{12}(x,y)=g_{21}(x,y)=x\\,y,\\quad g_{22}(x,y)=1+y^{2}.\n$$\nConsider the smooth function $f:M\\to\\mathbb{R}$ defined by\n$$\nf(x,y)=x^{3}y+\\ln\\!\\big(1+x^{2}+y^{2}\\big).\n$$\nUsing only the defining property of the gradient on a Riemannian manifold, namely that the gradient $\\nabla f$ is the unique vector field satisfying $g(\\nabla f,X)=\\mathrm{d}f(X)$ for all vector fields $X$, derive the coordinate expression for the squared norm of the gradient, $|\\nabla f|^{2}=g(\\nabla f,\\nabla f)$, for the given metric and function. Explicitly compute the inverse metric components and the needed derivatives, and assemble them to obtain $|\\nabla f|^{2}$ in terms of $x$ and $y$. Then briefly explain the geometric meaning of $|\\nabla f|^{2}$ in this context. Express your final answer as a single closed-form analytic expression in terms of $x$ and $y$. No rounding is required and no units are involved.", "solution": "The problem asks for the derivation of the squared norm of the gradient of a given function $f$ on a Riemannian manifold $(M,g)$.\n\nFirst, we validate the problem. The manifold is $M=\\mathbb{R}^2$ with global coordinates $(x,y)$. The components of the metric tensor $g$ are given as $g_{11}=1+x^2$, $g_{12}=g_{21}=xy$, and $g_{22}=1+y^2$. Let's form the metric matrix $G$:\n$$\nG = \\begin{pmatrix} g_{11} & g_{12} \\\\ g_{21} & g_{22} \\end{pmatrix} = \\begin{pmatrix} 1+x^2 & xy \\\\ xy & 1+y^2 \\end{pmatrix}\n$$\nA metric tensor must be positive-definite. We check this using Sylvester's criterion. The first principal minor is $g_{11}=1+x^2$, which is strictly greater than $0$ for all $(x,y) \\in \\mathbb{R}^2$. The determinant of $G$ is:\n$$\n\\det(G) = g_{11}g_{22} - g_{12}^2 = (1+x^2)(1+y^2) - (xy)^2 = 1+y^2+x^2+x^2y^2 - x^2y^2 = 1+x^2+y^2\n$$\nSince $x^2 \\ge 0$ and $y^2 \\ge 0$, $\\det(G) = 1+x^2+y^2 \\ge 1$. Thus, the determinant is strictly positive. Since both principal minors are positive, the metric $g$ is indeed positive-definite for all points on $M$ and is a valid Riemannian metric. The function $f(x,y)=x^3y+\\ln(1+x^2+y^2)$ is smooth on $M$ because the argument of the logarithm, $1+x^2+y^2$, is always greater than or equal to $1$. The problem is therefore scientifically sound, well-posed, and all necessary information is provided.\n\nWe now proceed with the solution. The gradient of a smooth function $f$, denoted $\\nabla f$, is the unique vector field that satisfies the relation $g(\\nabla f, X) = \\mathrm{d}f(X)$ for any vector field $X$. In a local coordinate system $\\{x^i\\}$, a vector field $X$ is written as $X = X^i \\frac{\\partial}{\\partial x^i}$ and the gradient is $\\nabla f = (\\nabla f)^j \\frac{\\partial}{\\partial x^j}$. The differential $\\mathrm{d}f$ is the 1-form $\\mathrm{d}f = \\frac{\\partial f}{\\partial x^k} \\mathrm{d}x^k$. The defining relation in coordinates becomes:\n$$\ng\\left( (\\nabla f)^j \\frac{\\partial}{\\partial x^j}, X^i \\frac{\\partial}{\\partial x^i} \\right) = \\left(\\frac{\\partial f}{\\partial x^k} \\mathrm{d}x^k\\right) \\left(X^i \\frac{\\partial}{\\partial x^i}\\right)\n$$\n$$\ng_{ji} (\\nabla f)^j X^i = \\frac{\\partial f}{\\partial x^k} X^k\n$$\nSince this must hold for any vector field $X$, the components $X^i$ are arbitrary. By relabeling the summation index $k$ to $i$, we can equate the coefficients of $X^i$:\n$$\ng_{ji} (\\nabla f)^j = \\frac{\\partial f}{\\partial x^i}\n$$\nTo solve for the components of the gradient, $(\\nabla f)^j$, we multiply by the inverse metric components $g^{ik}$:\n$$\ng^{ik} g_{ji} (\\nabla f)^j = g^{ik} \\frac{\\partial f}{\\partial x^i}\n$$\nUsing the property $g^{ik} g_{ji} = \\delta^k_j$ (the Kronecker delta), we obtain:\n$$\n(\\nabla f)^k = g^{ki} \\frac{\\partial f}{\\partial x^i}\n$$\nThe squared norm of the gradient is $|\\nabla f|^2 = g(\\nabla f, \\nabla f)$. Applying the defining property for $X = \\nabla f$, we get:\n$$\n|\\nabla f|^2 = g(\\nabla f, \\nabla f) = \\mathrm{d}f(\\nabla f) = \\left(\\frac{\\partial f}{\\partial x^k} \\mathrm{d}x^k\\right)\\left((\\nabla f)^j \\frac{\\partial}{\\partial x^j}\\right) = \\frac{\\partial f}{\\partial x^j} (\\nabla f)^j\n$$\nSubstituting the expression for $(\\nabla f)^j$:\n$$\n|\\nabla f|^2 = \\frac{\\partial f}{\\partial x^j} g^{ji} \\frac{\\partial f}{\\partial x^i}\n$$\nThis is the general coordinate expression for the squared norm of the gradient. Now, we compute the specific quantities for this problem. The coordinates are $(x^1, x^2) = (x,y)$.\n\nFirst, we compute the inverse metric components $g^{ij}$. The inverse of a $2 \\times 2$ matrix $G = \\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix}$ is $G^{-1} = \\frac{1}{ad-bc} \\begin{pmatrix} d & -b \\\\ -c & a \\end{pmatrix}$.\n$$\nG^{-1} = \\frac{1}{1+x^2+y^2} \\begin{pmatrix} 1+y^2 & -xy \\\\ -xy & 1+x^2 \\end{pmatrix}\n$$\nSo, the components of the inverse metric are:\n$$\ng^{11} = \\frac{1+y^2}{1+x^2+y^2}, \\quad g^{12}=g^{21} = \\frac{-xy}{1+x^2+y^2}, \\quad g^{22} = \\frac{1+x^2}{1+x^2+y^2}\n$$\nNext, we compute the partial derivatives of $f(x,y)=x^3y+\\ln(1+x^2+y^2)$:\n$$\n\\frac{\\partial f}{\\partial x} = 3x^2y + \\frac{2x}{1+x^2+y^2}\n$$\n$$\n\\frac{\\partial f}{\\partial y} = x^3 + \\frac{2y}{1+x^2+y^2}\n$$\nWe now assemble these components into the expression for $|\\nabla f|^2 = g^{11}(\\frac{\\partial f}{\\partial x})^2 + 2g^{12}\\frac{\\partial f}{\\partial x}\\frac{\\partial f}{\\partial y} + g^{22}(\\frac{\\partial f}{\\partial y})^2$.\nTo manage the algebraic complexity, we use the compact notation where $D=1+x^2+y^2$, and use a matrix formula `$(\\mathrm{d}h)^T G^{-1} (\\mathrm{d}h)` where $\\mathrm{d}h$ is the row vector of partial derivatives. A particularly elegant way for this specific metric is to use the Sherman-Morrison identity, as $G = I + \\mathbf{r}\\mathbf{r}^T$ where $\\mathbf{r}=(x,y)^T$. The inverse is $G^{-1} = I - \\frac{\\mathbf{r}\\mathbf{r}^T}{1+\\mathbf{r}^T\\mathbf{r}} = I - \\frac{\\mathbf{r}\\mathbf{r}^T}{D}$.\nSo $|\\nabla f|^2 = (\\mathrm{d}f) G^{-1} (\\mathrm{d}f)^T = (\\mathrm{d}f) (I - \\frac{\\mathbf{r}\\mathbf{r}^T}{D}) (\\mathrm{d}f)^T = |\\mathrm{d}f|^2_{\\text{euc}} - \\frac{((\\mathrm{d}f)\\mathbf{r})^2}{D}$, where $|\\mathrm{d}f|^2_{\\text{euc}} = (\\frac{\\partial f}{\\partial x})^2 + (\\frac{\\partial f}{\\partial y})^2$ and $(\\mathrm{d}f)\\mathbf{r} = x\\frac{\\partial f}{\\partial x} + y\\frac{\\partial f}{\\partial y}$.\n\nLet's decompose $f = f_1 + f_2$ where $f_1=x^3y$ and $f_2=\\ln(1+x^2+y^2) = \\ln(D)$.\nThe formula for $|\\nabla f|^2$ becomes $|\\nabla f_1 + \\nabla f_2|^2 = |\\nabla f_1|^2 + |\\nabla f_2|^2 + 2g(\\nabla f_1, \\nabla f_2)$.\n\nTerm 1: $|\\nabla f_1|^2$ for $f_1=x^3y$.\n$\\frac{\\partial f_1}{\\partial x} = 3x^2y$, $\\frac{\\partial f_1}{\\partial y} = x^3$.\n$|\\mathrm{d}f_1|^2_{\\text{euc}} = (3x^2y)^2 + (x^3)^2 = 9x^4y^2 + x^6$.\n$(\\mathrm{d}f_1)\\mathbf{r} = x(3x^2y) + y(x^3) = 4x^3y$.\n$|\\nabla f_1|^2 = (9x^4y^2+x^6) - \\frac{(4x^3y)^2}{D} = x^6+9x^4y^2 - \\frac{16x^6y^2}{1+x^2+y^2} = \\frac{(x^6+9x^4y^2)(1+x^2+y^2) - 16x^6y^2}{1+x^2+y^2} = \\frac{x^8-6x^6y^2+x^6+9x^4y^4+9x^4y^2}{1+x^2+y^2}$.\n\nTerm 2: $|\\nabla f_2|^2$ for $f_2=\\ln(D)$.\n$\\frac{\\partial f_2}{\\partial x} = \\frac{2x}{D}$, $\\frac{\\partial f_2}{\\partial y} = \\frac{2y}{D}$.\n$|\\mathrm{d}f_2|^2_{\\text{euc}} = (\\frac{2x}{D})^2+(\\frac{2y}{D})^2 = \\frac{4(x^2+y^2)}{D^2}$.\n$(\\mathrm{d}f_2)\\mathbf{r} = x(\\frac{2x}{D}) + y(\\frac{2y}{D}) = \\frac{2(x^2+y^2)}{D}$.\n$|\\nabla f_2|^2 = \\frac{4(x^2+y^2)}{D^2} - \\frac{1}{D}\\left(\\frac{2(x^2+y^2)}{D}\\right)^2 = \\frac{4(x^2+y^2)}{D^2} - \\frac{4(x^2+y^2)^2}{D^3} = \\frac{4(x^2+y^2)(D - (x^2+y^2))}{D^3} = \\frac{4(x^2+y^2)}{(1+x^2+y^2)^3}$.\n\nTerm 3: $2g(\\nabla f_1, \\nabla f_2)$.\n$g(\\nabla f_1, \\nabla f_2) = (\\mathrm{d}f_1) G^{-1} (\\mathrm{d}f_2)^T = (\\mathrm{d}f_1 \\cdot \\mathrm{d}f_2)_{\\text{euc}} - \\frac{((\\mathrm{d}f_1)\\mathbf{r})((\\mathrm{d}f_2)\\mathbf{r})}{D}$.\n$(\\mathrm{d}f_1 \\cdot \\mathrm{d}f_2)_{\\text{euc}} = (3x^2y)(\\frac{2x}{D}) + (x^3)(\\frac{2y}{D}) = \\frac{8x^3y}{D}$.\n$g(\\nabla f_1, \\nabla f_2) = \\frac{8x^3y}{D} - \\frac{(4x^3y)(2(x^2+y^2)/D)}{D} = \\frac{8x^3y(D-(x^2+y^2))}{D^2} = \\frac{8x^3y}{(1+x^2+y^2)^2}$.\nSo, $2g(\\nabla f_1, \\nabla f_2) = \\frac{16x^3y}{(1+x^2+y^2)^2}$.\n\nSumming the three terms gives the final expression for $|\\nabla f|^2$:\n$$\n|\\nabla f|^2 = \\frac{x^8-6x^6y^2+x^6+9x^4y^4+9x^4y^2}{1+x^2+y^2} + \\frac{16x^3y}{(1+x^2+y^2)^2} + \\frac{4(x^2+y^2)}{(1+x^2+y^2)^3}\n$$\n\nGeometric meaning of $|\\nabla f|^2$:\nOn a Riemannian manifold $(M,g)$, the gradient vector $\\nabla f$ at a point $p \\in M$ is the direction of steepest ascent of the function $f$, where direction and steepness are measured by the metric $g$. The norm of the gradient, $|\\nabla f|_p = \\sqrt{g_p(\\nabla f, \\nabla f)}$, represents the rate of change of $f$ in this direction of steepest ascent. Consequently, the squared norm $|\\nabla f|^2$ represents the square of this maximal rate of change. It is a scalar field on $M$ that quantifies at each point the square of the maximum possible directional derivative of $f$, where the directional derivative is defined with respect to arc length as determined by the metric $g$.", "answer": "$$\n\\boxed{\\frac{x^8-6x^6y^2+x^6+9x^4y^4+9x^4y^2}{1+x^2+y^2} + \\frac{16x^3y}{(1+x^2+y^2)^2} + \\frac{4(x^2+y^2)}{(1+x^2+y^2)^3}}\n$$", "id": "3071960"}]}