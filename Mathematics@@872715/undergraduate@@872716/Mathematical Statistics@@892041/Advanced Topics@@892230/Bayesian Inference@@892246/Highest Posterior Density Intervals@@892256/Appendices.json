{"hands_on_practices": [{"introduction": "Let's begin with a foundational application of Highest Posterior Density Intervals. This exercise guides you through calculating an HPDI in a common scenario involving a normal distribution, where the posterior is symmetric. Understanding this case is the first step toward mastering HPDIs, as it connects directly to the familiar concept of a central credible interval. [@problem_id:1921068]", "problem": "A manufacturer produces high-precision resistors. The resistance of these components is known to be normally distributed with a mean $\\mu$ and a known standard deviation of $\\sigma = 10.0$ Ohms, a value established from extensive historical data. Before testing a new production batch, an engineer's prior belief about the mean resistance $\\mu$ is modeled by a normal distribution with a mean of $\\mu_0 = 1000.0$ Ohms and a standard deviation of $\\tau = 4.0$ Ohms.\n\nA random sample of $n=25$ resistors is selected from the new batch, and the average resistance is measured to be $\\bar{x} = 998.5$ Ohms.\n\nBased on this sample and the engineer's prior belief, determine the 99% highest density interval for the true mean resistance $\\mu (in Ohms)$ of this batch. Express the lower and upper bounds of the interval, and round your final answers to four significant figures.", "solution": "The sampling model has known standard deviation $\\sigma$, so the sample mean $\\bar{X}$ satisfies $\\bar{X}\\mid\\mu\\sim\\mathcal{N}\\!\\left(\\mu,\\frac{\\sigma^{2}}{n}\\right)$. The prior is $\\mu\\sim\\mathcal{N}(\\mu_{0},\\tau^{2})$. By normal-normal conjugacy, the posterior is $\\mu\\mid\\bar{x}\\sim\\mathcal{N}(m_{n},v_{n})$ with\n$$\nv_{n}=\\left(\\frac{1}{\\tau^{2}}+\\frac{1}{\\sigma^{2}/n}\\right)^{-1},\\qquad\nm_{n}=v_{n}\\left(\\frac{\\mu_{0}}{\\tau^{2}}+\\frac{\\bar{x}}{\\sigma^{2}/n}\\right).\n$$\nSubstituting $\\sigma=10.0$, $n=25$, $\\mu_{0}=1000.0$, $\\tau=4.0$, and $\\bar{x}=998.5$, we have $\\sigma^{2}/n=\\frac{100}{25}=4$, hence\n$$\nv_{n}=\\left(\\frac{1}{16}+\\frac{1}{4}\\right)^{-1}=\\left(\\frac{1}{16}+\\frac{4}{16}\\right)^{-1}=\\left(\\frac{5}{16}\\right)^{-1}=\\frac{16}{5}=3.2,\\qquad \\sqrt{v_{n}}=\\frac{4}{\\sqrt{5}}.\n$$\nFor the mean,\n$$\nm_{n}=v_{n}\\left(\\frac{1000.0}{16}+\\frac{998.5}{4}\\right)=\\frac{16}{5}\\left(62.5+249.625\\right)=\\frac{16}{5}\\cdot 312.125=\\frac{4994}{5}=998.8.\n$$\nSince the posterior is normal and symmetric, the 99% highest density interval equals the central 99% credible interval,\n$$\n\\left[m_{n}-z_{0.995}\\sqrt{v_{n}},\\;m_{n}+z_{0.995}\\sqrt{v_{n}}\\right],\n$$\nwhere $z_{0.995}$ is the standard normal $0.995$ quantile. Using $z_{0.995}\\approx 2.575829$, the half-width is\n$$\nz_{0.995}\\sqrt{v_{n}}\\approx 2.575829\\cdot\\frac{4}{\\sqrt{5}}\\approx 4.60778354.\n$$\nTherefore, the 99% highest density interval bounds are\n$$\n998.8-4.60778354\\approx 994.19221646,\\qquad 998.8+4.60778354\\approx 1003.40778354.\n$$\nRounding each bound to four significant figures gives $994.2$ and $1003$.", "answer": "$$\\boxed{\\begin{pmatrix} 994.2 & 1003 \\end{pmatrix}}$$", "id": "1921068"}, {"introduction": "While HPDIs are simple for symmetric posteriors, their true utility shines with skewed distributions where the HPDI is not the same as an equal-tailed interval. This next practice challenges you to apply the formal definition of an HPDI to a Beta posterior. You will focus on identifying the two key mathematical conditions that uniquely define the interval's endpoints, reinforcing the core principles of what makes an interval the \"highest density\" region. [@problem_id:1921049]", "problem": "A Bayesian statistical analysis is performed to estimate an unknown population proportion, represented by the parameter $p$, where $0 < p < 1$. After collecting and analyzing data, the resulting posterior distribution for $p$ is identified as a Beta distribution with parameters $\\alpha=3$ and $\\beta=9$.\n\nRecall that the probability density function (PDF) for a parameter $\\theta$ following a Beta distribution with shape parameters $\\alpha$ and $\\beta$, denoted $\\text{Beta}(\\alpha, \\beta)$, is given by:\n$$f(\\theta | \\alpha, \\beta) = \\frac{\\theta^{\\alpha-1}(1-\\theta)^{\\beta-1}}{B(\\alpha, \\beta)}$$\nfor $0 < \\theta < 1$. Here, $B(\\alpha, \\beta)$ is the Beta function, which serves as a normalizing constant.\n\nWe want to find the 95% Highest Posterior Density Interval (HPDI) for the parameter $p$. A 95% HPDI is defined as the interval $[L, U]$ which contains 95% of the posterior probability mass and has the shortest possible length. For a unimodal posterior distribution like the one given, this implies a specific relationship between the posterior density at the lower bound $L$ and the upper bound $U$.\n\nWhich of the following pairs of equations correctly and completely defines the endpoints $L$ and $U$ for the 95% HPDI of the posterior distribution $\\text{Beta}(3, 9)$?\n\nA. $\\int_L^U p^2 (1-p)^8 \\, dp = 0.95$ and $U - L = 0.95$\nB. $\\int_L^U \\frac{p^2 (1-p)^8}{B(3,9)} \\, dp = 0.95$ and $L^2 (1-L)^8 = U^2 (1-U)^8$\nC. $\\int_0^L \\frac{p^2 (1-p)^8}{B(3,9)} \\, dp = 0.025$ and $\\int_U^1 \\frac{p^2 (1-p)^8}{B(3,9)} \\, dp = 0.025$\nD. $\\int_L^U p^2 (1-p)^8 \\, dp = 0.95$ and $L = 0.025$\nE. $\\int_L^U \\frac{p^2 (1-p)^8}{B(3,9)} \\, dp = 0.95$ and $L=U$", "solution": "The posterior density for $p$ under $\\text{Beta}(3,9)$ is\n$$\nf(p)=\\frac{p^{2}(1-p)^{8}}{B(3,9)}, \\quad 0<p<1.\n$$\nA 95% Highest Posterior Density Interval (HPDI) for a unimodal posterior is defined as the interval $[L,U]$ that:\n1) Contains probability mass 0.95, which requires\n$$\n\\int_{L}^{U} f(p)\\,dp=\\int_{L}^{U} \\frac{p^{2}(1-p)^{8}}{B(3,9)}\\,dp=0.95,\n$$\nbecause the integral of the normalized density over the interval must equal the desired posterior probability.\n2) Has endpoints at equal posterior density (constant-density threshold defining the HPDI), which requires\n$$\nf(L)=f(U) \\quad \\Longleftrightarrow \\quad \\frac{L^{2}(1-L)^{8}}{B(3,9)}=\\frac{U^{2}(1-U)^{8}}{B(3,9)} \\quad \\Longleftrightarrow \\quad L^{2}(1-L)^{8}=U^{2}(1-U)^{8}.\n$$\nThese two equations together uniquely define $L$ and $U$ for the 95% HPDI. This corresponds exactly to option B. Options A and D incorrectly omit the normalizing constant in the probability condition (and include incorrect additional constraints), option C gives equal-tailed rather than highest-density conditions, and option E is degenerate.", "answer": "$$\\boxed{B}$$", "id": "1921049"}, {"introduction": "In modern Bayesian statistics, we often approximate posterior distributions with a large set of samples from methods like Markov Chain Monte Carlo (MCMC). How do we find the HPDI from just a list of numbers? This final exercise bridges theory and practice by asking you to identify the correct algorithm for estimating an HPDI from posterior samples, a crucial skill for any applied statistician or data scientist. [@problem_id:1921054]", "problem": "A researcher is using Bayesian inference to study a parameter $\\theta$, which represents the average effectiveness of a new learning algorithm. After running a Markov Chain Monte Carlo (MCMC) simulation, she obtains a large number of samples, $\\{\\theta_1, \\theta_2, \\dots, \\theta_N\\}$, drawn from the posterior distribution of $\\theta$. For her analysis, she needs to compute the 95% Highest Posterior Density Interval (HPDI). The HPDI is defined as the shortest possible interval that contains 95% of the posterior probability mass.\n\nGiven that she has the set of $N$ posterior samples, which of the following algorithms correctly estimates the 95% HPDI?\n\nA.\n1. Sort the samples in ascending order to get $\\{\\theta_{(1)}, \\theta_{(2)}, \\dots, \\theta_{(N)}\\}$.\n2. Let $k = \\lceil 0.95 \\times N \\rceil$.\n3. Consider all intervals of the form $[\\theta_{(i)}, \\theta_{(i+k-1)}]$ for $i=1, \\dots, N-k+1$.\n4. Choose the interval for which the width, $\\theta_{(i+k-1)} - \\theta_{(i)}$, is minimized.\n\nB.\n1. Sort the samples in ascending order to get $\\{\\theta_{(1)}, \\theta_{(2)}, \\dots, \\theta_{(N)}\\}$.\n2. Calculate the lower bound index $l = \\lfloor 0.025 \\times N \\rfloor$ and the upper bound index $u = \\lceil 0.975 \\times N \\rceil$.\n3. The interval is given by $[\\theta_{(l)}, \\theta_{(u)}]$.\n\nC.\n1. Calculate the sample mean $\\bar{\\theta} = \\frac{1}{N} \\sum_{i=1}^N \\theta_i$ and the sample standard deviation $s = \\sqrt{\\frac{1}{N-1} \\sum_{i=1}^N (\\theta_i - \\bar{\\theta})^2}$.\n2. The interval is given by $[\\bar{\\theta} - 1.96 s, \\bar{\\theta} + 1.96 s]$.\n\nD.\n1. Sort the samples and find the median, $\\theta_{\\text{median}} = \\theta_{(\\lceil N/2 \\rceil)}$.\n2. Find the smallest value $w$ such that the interval $[\\theta_{\\text{median}} - w, \\theta_{\\text{median}} + w]$ contains exactly 95% of the samples.\n\nE.\n1. Estimate the mode (the value with the highest frequency) of the samples, $\\theta_{\\text{mode}}$.\n2. Find the smallest value $w$ such that the interval $[\\theta_{\\text{mode}} - w, \\theta_{\\text{mode}} + w]$ contains exactly 95% of the samples.", "solution": "We are given posterior samples $\\{\\theta_{1},\\dots,\\theta_{N}\\}$ from the posterior distribution of $\\theta$. The 95% Highest Posterior Density Interval (HPDI) is, by definition, the interval of minimal width that contains posterior probability mass 0.95. For a continuous unimodal posterior density $p(\\theta\\mid\\text{data})$, the HPDI can be characterized as\n$$\nI^{\\ast}=\\arg\\min_{I:\\ \\int_{I} p(\\theta\\mid\\text{data})\\,d\\theta=0.95}\\ \\text{length}(I),\n$$\nand the HPDI consists of all points where the density exceeds a threshold chosen so that the mass inside equals $0.95$. With posterior samples, we approximate this by finding the shortest interval that contains a fraction 0.95 of the samples.\n\nTo implement this from samples, proceed as follows.\n\n1. Sort the samples to obtain order statistics $\\{\\theta_{(1)},\\dots,\\theta_{(N)}\\}$.\n\n2. Let $k=\\lceil 0.95 N\\rceil$. Any interval that contains at least $0.95$ of the posterior mass should, under the empirical distribution of the samples, contain at least $k$ samples. Among all such empirical intervals, the shortest candidate intervals are precisely those whose endpoints are adjacent order statistics spanning exactly $k$ samples, i.e., intervals of the form $[\\theta_{(i)},\\theta_{(i+k-1)}]$ for $i=1,\\dots,N-k+1$.\n\n3. For each $i$, compute the width\n$$\nw_{i}=\\theta_{(i+k-1)}-\\theta_{(i)}.\n$$\nSelect the interval with minimal $w_{i}$. This interval is the empirical shortest interval containing at least 0.95 of the samples, which is the standard sample-based estimator of the 95% HPDI.\n\nThis procedure is exactly Algorithm A.\n\nNow we verify why the other options do not generally produce the HPDI.\n\n- Option B constructs the equal-tailed interval using empirical quantiles at $0.025$ and $0.975$. This yields a central or equal-tailed credible interval, which is not guaranteed to be the shortest interval covering probability $0.95$ when the posterior is asymmetric or multimodal. Therefore it is not, in general, the HPDI.\n\n- Option C uses $\\bar{\\theta}\\pm 1.96\\,s$, which assumes approximate normality and constructs a symmetric interval centered at the mean. This is a normal-approximation credible interval, not the HPDI in general, especially for non-normal or skewed posteriors.\n\n- Option D centers the interval at the median and enforces symmetry. The HPDI need not be symmetric nor centered at the median; enforcing symmetry can produce a wider interval than necessary, so this is not the general HPDI.\n\n- Option E centers the interval at the mode and enforces symmetry. While the HPDI often includes the mode for unimodal posteriors, it is not necessarily symmetric unless the posterior itself is symmetric. Enforcing symmetry can again make the interval suboptimal in width, so this is not the general HPDI.\n\nTherefore, only Algorithm A correctly estimates the 95% HPDI from posterior samples in general.", "answer": "$$\\boxed{A}$$", "id": "1921054"}]}