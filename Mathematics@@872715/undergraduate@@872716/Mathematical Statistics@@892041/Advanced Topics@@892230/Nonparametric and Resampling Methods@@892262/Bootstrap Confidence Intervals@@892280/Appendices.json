{"hands_on_practices": [{"introduction": "This first practice serves as a foundational exercise, focusing on the core concept of the bootstrap percentile interval. By directly using pre-calculated percentiles from a bootstrap simulation, you will see how the empirical distribution of a statistic, such as the coefficient of variation, is used to form confidence bounds [@problem_id:1901798]. This problem emphasizes interpreting the output of a bootstrap procedure to construct the final interval.", "problem": "A quality control engineer is assessing the consistency of a manufacturing process for resistors. A sample of six resistors is taken, and their resistances are measured in Ohms ($\\Omega$). The measurements are:\n$$ [48.2, 51.5, 49.8, 52.1, 47.9, 50.7] $$\nThe engineer is interested in the coefficient of variation, defined as the ratio of the population standard deviation to the population mean ($\\frac{\\sigma}{\\mu}$), as a measure of relative variability. To estimate this quantity, a percentile bootstrap procedure is used. A computer simulation generates a large number of bootstrap samples from the original data. For each bootstrap sample, the coefficient of variation is calculated. From the resulting distribution of these bootstrap statistics, the 2.5th percentile is found to be $0.01673$ and the 97.5th percentile is found to be $0.05598$.\n\nBased on this information, determine the 95% percentile bootstrap confidence interval for the true coefficient of variation of the resistance. Provide the lower and upper bounds of this interval as a pair of numbers. Round each bound to three significant figures.", "solution": "The target parameter is the coefficient of variation $\\theta=\\sigma/\\mu$. The percentile bootstrap confidence interval at level $1-\\alpha$ uses the empirical quantiles of the bootstrap sampling distribution of the statistic. Specifically, if $\\hat{\\theta}^{*(p)}$ denotes the $p$-quantile of the bootstrap distribution of the statistic, then the percentile bootstrap interval is\n$$\n\\left[\\hat{\\theta}^{*\\left(\\frac{\\alpha}{2}\\right)},\\ \\hat{\\theta}^{*\\left(1-\\frac{\\alpha}{2}\\right)}\\right].\n$$\nFor a $95$ percent interval, $\\alpha=0.05$, so the bounds are the $0.025$ and $0.975$ quantiles. The simulation provides these as $0.01673$ and $0.05598$, respectively.\n\nRounding each bound to three significant figures:\n- For $0.01673$, the first three significant digits are $1,6,7$ and the next digit is $3$, so it rounds to $0.0167$.\n- For $0.05598$, the first three significant digits are $5,5,9$ and the next digit is $8$, so it rounds up to $0.0560$ to preserve three significant figures.\n\nTherefore, the $95$ percent percentile bootstrap confidence interval is\n$$\n\\left[0.0167,\\ 0.0560\\right].\n$$", "answer": "$$\\boxed{\\begin{pmatrix}0.0167  0.0560\\end{pmatrix}}$$", "id": "1901798"}, {"introduction": "Building on the previous concept, this exercise requires you to take a more hands-on role in the construction of the interval. Given a set of bootstrap replicates for the median, you will determine the confidence interval by calculating the correct ranks and selecting the corresponding values from the sorted list [@problem_id:1901792]. This task highlights the bootstrap's utility for creating confidence intervals for robust statistics like the median, especially in scenarios with small sample sizes.", "problem": "A molecular biologist is studying the expression level of a specific gene, 'Gene-X', under a certain condition. The expression level is measured as a normalized fluorescence intensity. Due to the high cost of the experiment, only a small sample of five measurements could be obtained. The observed expression levels were:\n$$\n3.1, 4.5, 2.8, 5.9, 3.4\n$$\nTo estimate the variability of the population median expression level, the biologist employs a non-parametric bootstrap procedure. A large number of bootstrap samples are created by resampling the original five data points with replacement. For each bootstrap sample, the median is calculated. After generating 20 such bootstrap medians and sorting them in ascending order, the following list of ordered medians is obtained:\n$$\n2.8, 2.9, 3.1, 3.1, 3.1, 3.2, 3.3, 3.4, 3.4, 3.4, 3.5, 3.6, 3.9, 4.1, 4.2, 4.5, 4.5, 4.5, 4.8, 5.1\n$$\nUsing the percentile method on this set of 20 sorted bootstrap medians, construct a 90% confidence interval for the population median expression level. Which of the following represents the correct interval?\n\nA. [2.8, 4.8]\n\nB. [2.9, 5.1]\n\nC. [2.8, 5.1]\n\nD. [3.1, 4.5]\n\nE. [2.9, 4.8]", "solution": "We seek a percentile bootstrap confidence interval for the population median using the sorted bootstrap medians. For a confidence level of $1-\\alpha=0.90$, the percentile method uses the empirical quantiles at probabilities $\\alpha/2=0.05$ and $1-\\alpha/2=0.95$ of the bootstrap distribution.\n\nLet $B=20$ be the number of bootstrap medians, and denote the ordered bootstrap medians by $m_{(1)} \\leq m_{(2)} \\leq \\cdots \\leq m_{(20)}$. Using the nearest-rank definition of empirical quantiles, the rank corresponding to probability $p$ is\n$$\nr(p)=\\lceil B p \\rceil.\n$$\nThus,\n$$\nr(0.05)=\\lceil 20 \\times 0.05 \\rceil=\\lceil 1 \\rceil=1,\\quad r(0.95)=\\lceil 20 \\times 0.95 \\rceil=\\lceil 19 \\rceil=19.\n$$\nTherefore, the $90\\%$ percentile interval is\n$$\n\\left[m_{(1)},\\,m_{(19)}\\right].\n$$\nFrom the given sorted list, $m_{(1)}=2.8$ and $m_{(19)}=4.8$, so the interval is $[2.8, 4.8]$, which corresponds to option A.", "answer": "$$\\boxed{A}$$", "id": "1901792"}, {"introduction": "Our final practice explores an advanced application, demonstrating the bootstrap's power and flexibility in the context of linear regression. You will work with the output of a wild bootstrap, a specialized technique used to generate reliable confidence intervals for regression coefficients when the assumption of constant error variance (homoscedasticity) may be violated [@problem_id:1901772]. This problem illustrates how bootstrap methods provide robust and indispensable tools for modern statistical modeling.", "problem": "A materials engineer is investigating the properties of a new polymer composite. She studies the relationship between the concentration of a novel hardening agent and the resulting tensile strength of the material. A linear relationship is hypothesized: $S_i = \\beta_0 + \\beta_1 C_i + \\epsilon_i$, where $S_i$ is the tensile strength in Gigapascals (GPa), $C_i$ is the hardener concentration in percent (%), and $\\epsilon_i$ are the error terms. The engineer is particularly interested in the coefficient $\\beta_1$, which represents the marginal increase in GPa of tensile strength for each additional percentage point of hardener.\n\nAfter collecting data, a preliminary analysis suggests that the variance of the error terms $\\epsilon_i$ may not be constant across different concentration levels, a condition which would invalidate the standard confidence interval for $\\beta_1$. To obtain a more reliable interval, a robust computational method is employed. This method involves the following steps to generate a distribution of plausible slope estimates:\n1.  An initial Ordinary Least Squares (OLS) regression is performed on the original data to find the estimated coefficients $\\hat{\\beta}_0, \\hat{\\beta}_1$ and the residuals $\\hat{\\epsilon}_i = S_i - (\\hat{\\beta}_0 + \\hat{\\beta}_1 C_i)$.\n2.  A large number, $B$, of new \"bootstrap\" datasets are generated. For each replication $b \\in \\{1, \\dots, B\\}$, a new set of pseudo-errors is created as $\\epsilon_{i,b}^* = \\hat{\\epsilon}_i \\cdot v_{i,b}$, where each $v_{i,b}$ is an independent random draw from a distribution with a mean of 0 and a variance of 1.\n3.  New pseudo-responses are constructed using the original fitted values: $S_{i,b}^* = (\\hat{\\beta}_0 + \\hat{\\beta}_1 C_i) + \\epsilon_{i,b}^*$.\n4.  For each replication $b$, a new slope coefficient, $\\hat{\\beta}_{1,b}^*$, is estimated by performing an OLS regression of $S_b^*$ on the original concentrations $C$.\n\nThis procedure was conducted for $B=4999$ replications. The resulting $4999$ slope estimates, $\\{\\hat{\\beta}_{1,b}^*\\}$, were then sorted in ascending order. The analysis yielded the following key values from the sorted list:\n- The 125th value is $2.18$.\n- The OLS estimate from the original data is $\\hat{\\beta}_1 = 2.51$.\n- The 4875th value is $2.93$.\n\nBased on this information, determine the 95% bootstrap percentile confidence interval for the slope coefficient $\\beta_1$. Express your answer as a row matrix `[lower_bound, upper_bound]`, with values given in units of GPa/%. The provided values are already at the required precision, so no further rounding is necessary.", "solution": "We are asked for a 95 percent bootstrap percentile confidence interval for the slope coefficient $\\beta_{1}$, based on $B=4999$ bootstrap slope estimates. Let the sorted bootstrap slopes be denoted by the order statistics $\\hat{\\beta}_{1,(1)}^{*} \\leq \\cdots \\leq \\hat{\\beta}_{1,(B)}^{*}$.\n\nFor a nominal two-sided confidence level $1-\\alpha=0.95$ with $\\alpha=0.05$, the percentile method takes the empirical $\\alpha/2$ and $1-\\alpha/2$ quantiles of the bootstrap distribution. Using the standard $(B+1)$ indexing rule, the quantile indices are\n$$\nk_{\\ell} = \\alpha/2 \\cdot (B+1), \\qquad k_{u} = (1-\\alpha/2) \\cdot (B+1).\n$$\nWith $B=4999$ and $\\alpha=0.05$,\n$$\nk_{\\ell} = 0.025 \\cdot 5000 = 125, \\qquad k_{u} = 0.975 \\cdot 5000 = 4875.\n$$\nTherefore, the 95 percent bootstrap percentile confidence interval is\n$$\n\\left[\\, \\hat{\\beta}_{1,(125)}^{*},\\ \\hat{\\beta}_{1,(4875)}^{*} \\,\\right].\n$$\nFrom the provided sorted bootstrap outputs, $\\hat{\\beta}_{1,(125)}^{*} = 2.18$ and $\\hat{\\beta}_{1,(4875)}^{*} = 2.93$. Hence, the 95 percent bootstrap percentile confidence interval is\n$$\n[\\,2.18,\\ 2.93\\,].\n$$\nThe original OLS estimate $\\hat{\\beta}_{1}=2.51$ is not needed for the percentile interval construction; it is reported for context.", "answer": "$$\\boxed{\\begin{pmatrix} 2.18  2.93 \\end{pmatrix}}$$", "id": "1901772"}]}