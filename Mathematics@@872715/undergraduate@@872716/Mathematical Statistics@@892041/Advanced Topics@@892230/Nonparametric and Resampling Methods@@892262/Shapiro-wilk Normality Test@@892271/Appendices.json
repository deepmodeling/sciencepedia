{"hands_on_practices": [{"introduction": "The Shapiro-Wilk test often serves as a crucial checkpoint before applying other statistical methods that require normally distributed data. This first exercise places you in a common real-world scenario: verifying the assumptions of a linear regression model. Mastering the interpretation of the test's p-value is a fundamental skill that ensures the validity of your subsequent statistical inferences. [@problem_id:1954981]", "problem": "A data scientist is building a linear regression model to predict the monthly energy consumption of commercial buildings. For the standard statistical inferences of the model (such as confidence intervals and hypothesis tests for the model coefficients) to be reliable, a key assumption is that the model's residuals are drawn from a normal distribution. To assess this assumption, the data scientist performs a Shapiro-Wilk test on the set of residuals obtained from the model. The test yields a p-value of $0.02$. A significance level of $\\alpha = 0.05$ is used for the test.\n\nBased on this outcome, which of the following is the most accurate practical conclusion?\n\nA. There is sufficient evidence to conclude that the residuals are normally distributed, thus satisfying the model assumption.\n\nB. The evidence suggests that the assumption of normally distributed residuals is violated.\n\nC. The p-value of $0.02$ indicates that there is a $2\\%$ probability that the residuals are actually normally distributed.\n\nD. The model is proven to be a good predictive model because the test result is statistically significant.\n\nE. The test is inconclusive because the p-value is very small, and a larger p-value would be needed to make a decision.", "solution": "The linear regression inference for coefficients typically assumes that the residuals $e_{i}$ are independent and identically distributed as $e_{i} \\sim \\mathcal{N}(0,\\sigma^{2})$. To assess normality, the Shapiro–Wilk test is applied.\n\nFormulate the hypotheses:\n$$\nH_{0}:\\ \\text{the residuals are drawn from a normal distribution},\\quad\nH_{1}:\\ \\text{the residuals are not drawn from a normal distribution}.\n$$\n\nThe test provides a p-value $p=0.02$ and the chosen significance level is $\\alpha=0.05$. The decision rule is:\n$$\n\\text{Reject }H_{0}\\ \\text{if}\\ p \\leq \\alpha.\n$$\nSince $0.02 < 0.05$, we reject $H_{0}$. The practical conclusion is that there is statistical evidence that the residuals are not normally distributed; thus, the normality assumption is likely violated.\n\nInterpretation of options:\n- A is incorrect because rejecting $H_{0}$ contradicts concluding normality.\n- B is correct because rejection indicates evidence against normality.\n- C is incorrect because a p-value is not the probability that $H_{0}$ is true; it is the probability, under $H_{0}$, of observing a test statistic at least as extreme as the one observed.\n- D is incorrect because significance here reflects deviation from normality, not predictive performance.\n- E is incorrect because a small p-value leads to a clear decision to reject $H_{0}$ at the stated $\\alpha$.\n\nTherefore, the most accurate practical conclusion is B.", "answer": "$$\\boxed{B}$$", "id": "1954981"}, {"introduction": "After learning to interpret the test's conclusion, it is natural to wonder how that conclusion is reached. This practice peels back the curtain on the Shapiro-Wilk test, guiding you through the direct calculation of the core statistic, $W$. By working with a carefully constructed dataset, you will develop a tangible understanding of how the test quantifies departures from a normal distribution, revealing its sensitivity to more than just asymmetry. [@problem_id:1954943]", "problem": "In the quality control of a new generation of Micro-Electro-Mechanical Systems (MEMS), a materials scientist measures the resonant frequency of a small batch of six prototype resonators. The goal is to assess whether the frequencies can be modeled by a normal distribution, which is a key assumption for subsequent statistical process control methods. The measured frequencies, in kilohertz (kHz), are:\n$$ \\{11.2, 13.2, 11.2, 13.2, 11.2, 13.2\\} $$\nThe scientist decides to use the Shapiro-Wilk test for normality. The Shapiro-Wilk statistic, $W$, is calculated using the formula:\n$$ W = \\frac{b^2}{S^2} $$\nwhere $S^2$ is the sum of squared deviations from the sample mean, given by $S^2 = \\sum_{j=1}^{n} (x_j - \\bar{x})^2$. The term $b$ is a weighted sum of differences between symmetric order statistics, calculated as $b = \\sum_{i=1}^{k} a_i (x_{(n-i+1)} - x_{(i)})$, where $x_{(j)}$ is the $j$-th smallest value in the sample. For a sample of size $n=6$, the integer $k$ is $3$, and the required coefficients $a_i$ are:\n$a_1 = 0.6431$\n$a_2 = 0.2806$\n$a_3 = 0.0875$\n\nCalculate the value of the Shapiro-Wilk statistic $W$ for this dataset. The statistic $W$ is a dimensionless quantity. Round your final answer to four significant figures.", "solution": "The problem asks us to compute the Shapiro-Wilk statistic $W$ for a given dataset of six measurements. The dataset is $X = \\{11.2, 13.2, 11.2, 13.2, 11.2, 13.2\\}$.\n\nStep 1: Determine the sample size and calculate the sample mean.\nThe sample size is $n=6$.\nThe sample mean $\\bar{x}$ is the sum of all observations divided by the sample size.\n$$ \\bar{x} = \\frac{11.2 + 13.2 + 11.2 + 13.2 + 11.2 + 13.2}{6} = \\frac{3 \\times 11.2 + 3 \\times 13.2}{6} = \\frac{33.6 + 39.6}{6} = \\frac{73.2}{6} = 12.2 $$\nThe sample mean is $\\bar{x} = 12.2$ kHz.\n\nStep 2: Calculate the sum of squared deviations, $S^2$.\n$S^2$ is the denominator of the $W$ statistic.\nThe deviations from the mean $(x_j - \\bar{x})$ for the each data point are:\nFor the three values of $11.2$: $11.2 - 12.2 = -1.0$\nFor the three values of $13.2$: $13.2 - 12.2 = 1.0$\nNow, we sum the squares of these deviations:\n$$ S^2 = \\sum_{j=1}^{6} (x_j - \\bar{x})^2 = 3 \\times (-1.0)^2 + 3 \\times (1.0)^2 = 3 \\times 1 + 3 \\times 1 = 6 $$\nSo, $S^2 = 6$.\n\nStep 3: Determine the order statistics of the sample.\nThe order statistics, $x_{(i)}$, are the sample values sorted in ascending order.\n$x_{(1)} = 11.2$\n$x_{(2)} = 11.2$\n$x_{(3)} = 11.2$\n$x_{(4)} = 13.2$\n$x_{(5)} = 13.2$\n$x_{(6)} = 13.2$\n\nStep 4: Calculate the term $b$.\nThe formula for $b$ for $n=6$ is $b = \\sum_{i=1}^{3} a_i (x_{(6-i+1)} - x_{(i)})$.\nThis expands to:\n$$ b = a_1 (x_{(6)} - x_{(1)}) + a_2 (x_{(5)} - x_{(2)}) + a_3 (x_{(4)} - x_{(3)}) $$\nUsing the provided coefficients and the order statistics:\n$a_1 = 0.6431$\n$a_2 = 0.2806$\n$a_3 = 0.0875$\n\nThe differences in order statistics are:\n$x_{(6)} - x_{(1)} = 13.2 - 11.2 = 2.0$\n$x_{(5)} - x_{(2)} = 13.2 - 11.2 = 2.0$\n$x_{(4)} - x_{(3)} = 13.2 - 11.2 = 2.0$\n\nNow, substitute these values into the expression for $b$:\n$$ b = 0.6431 \\times (2.0) + 0.2806 \\times (2.0) + 0.0875 \\times (2.0) $$\n$$ b = (0.6431 + 0.2806 + 0.0875) \\times 2.0 $$\n$$ b = (1.0112) \\times 2.0 = 2.0224 $$\n\nStep 5: Calculate the Shapiro-Wilk statistic $W$.\nThe formula is $W = b^2 / S^2$.\n$$ W = \\frac{(2.0224)^2}{6} = \\frac{4.09006176}{6} = 0.68167696 $$\n\nStep 6: Round the result to four significant figures.\nThe calculated value is $0.68167696...$. The first four significant figures are 6, 8, 1, 6. The fifth significant figure is 7, which is 5 or greater, so we round up the fourth digit.\n$$ W \\approx 0.6817 $$", "answer": "$$\\boxed{0.6817}$$", "id": "1954943"}, {"introduction": "A statistical test is a tool, and understanding its effectiveness is key to using it wisely. This final practice introduces the concept of statistical power—a measure of the test's ability to correctly detect a true effect. You will explore how Monte Carlo simulation, a powerful computational technique, can be used to estimate the power of the Shapiro-Wilk test, providing insight into its reliability when faced with specific types of non-normal data. [@problem_id:1954950]", "problem": "A data scientist is investigating the sensitivity of the Shapiro-Wilk normality test. Specifically, they want to estimate the statistical power of the test to detect deviations from normality when the underlying data actually follows a chi-squared distribution.\n\nThe null hypothesis ($H_0$) for the Shapiro-Wilk test is that a sample is drawn from a normally distributed population. For this study, the specific alternative hypothesis ($H_A$) is that the sample is drawn from a chi-squared distribution with $k=3$ degrees of freedom.\n\nThe data scientist decides to use a Monte Carlo simulation with the following parameters:\n- Sample size per trial: $n = 20$\n- Significance level for the test: $\\alpha = 0.05$\n- Total number of Monte Carlo trials: $N = 10000$\n\nIn each of the $N$ trials, a random sample of size $n$ is generated from a chi-squared distribution with $k=3$ degrees of freedom. The Shapiro-Wilk test is then applied to this sample, and its p-value is computed. The simulation revealed that the p-value was less than the significance level $\\alpha$ in a total of $M = 4572$ trials.\n\nBased on the results of this simulation, calculate the estimated statistical power of the Shapiro-Wilk test for these specific conditions. Express your answer as a decimal rounded to three significant figures.", "solution": "Statistical power is defined as $\\Pr(\\text{reject } H_{0} \\mid H_{A}\\ \\text{true})$. In a Monte Carlo simulation with $N$ independent trials where the alternative hypothesis holds, an unbiased estimator of the power is the sample proportion of rejections:\n$$\\widehat{\\text{Power}}=\\frac{M}{N},$$\nwhere $M$ is the number of trials with a p-value less than $\\alpha$.\n\nGiven $M=4572$ and $N=10000$,\n$$\\widehat{\\text{Power}}=\\frac{4572}{10000}=0.4572.$$\n\nRounding this estimate to three significant figures gives $0.457$.", "answer": "$$\\boxed{0.457}$$", "id": "1954950"}]}