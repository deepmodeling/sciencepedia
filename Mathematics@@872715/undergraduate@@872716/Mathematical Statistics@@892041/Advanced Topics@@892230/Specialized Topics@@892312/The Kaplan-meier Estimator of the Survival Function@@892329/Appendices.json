{"hands_on_practices": [{"introduction": "Before we can apply the Kaplan-Meier formula, raw survival data must be systematically organized. This foundational exercise guides you through summarizing a dataset into a life table format, which is the first practical step in any survival analysis [@problem_id:1961488]. You will learn to track the number of subjects at risk ($Y_j$), the number of events ($d_j$), and the number of censored subjects between event times, building the essential structure for calculating the survival function.", "problem": "A clinical trial is conducted to evaluate the efficacy of a new drug, \"Neurostabil,\" in preventing the recurrence of a neurological symptom. Fifteen subjects participate in the study, which is planned for a duration of 12 months. For each subject, the data is recorded as a pair `(time, status)`, where `time` is the number of months until either the symptom recurs (an event) or the subject is censored, and `status` is an indicator variable (1 for an event, 0 for censored). A subject is censored if they drop out of the study or if the study ends before they experience an event.\n\nThe data for the 15 subjects are as follows:\n(3, 1), (5, 1), (12, 0), (7, 1), (4, 0), (9, 1), (7, 1), (10, 0), (11, 1), (12, 0), (3, 1), (7, 1), (8, 0), (5, 0), (9, 1)\n\nTo prepare for a Kaplan-Meier survival analysis, you are asked to summarize this data. Let $t_1  t_2  \\dots  t_k$ be the sequence of unique, ordered event times. For each distinct event time $t_j$ (where $j=1, \\dots, k$), we define the following quantities:\n- $Y_j$: The number of subjects at risk just prior to time $t_j$. A subject is considered at risk if they have not yet had an event or been censored before time $t_j$.\n- $d_j$: The number of subjects who experience an event at time $t_j$.\n- $c_j$: The number of subjects who are censored in the time interval $[t_{j-1}, t_j)$, where $t_0 = 0$.\n\nDetermine the sequence of triples $(Y_j, d_j, c_j)$ for all distinct event times. Present your answer as a matrix where the $j$-th row contains the triple for the $j$-th event time.", "solution": "We have a total of 15 subjects. Let the distinct ordered event times be $t_{1}t_{2}\\dotst_{k}$. From the data, the times with events (status equal to 1) are $3,5,7,9,11$. Sorting and counting multiplicities gives:\n- $t_{1}=3$ with $d_{1}=2$ events,\n- $t_{2}=5$ with $d_{2}=1$ event,\n- $t_{3}=7$ with $d_{3}=3$ events,\n- $t_{4}=9$ with $d_{4}=2$ events,\n- $t_{5}=11$ with $d_{5}=1$ event.\nThus $k=5$ and $(d_{1},d_{2},d_{3},d_{4},d_{5})=(2,1,3,2,1)$.\n\nCensoring times (status equal to 0) are $4,5,8,10,12,12$. By definition, for each $j$, $c_{j}$ counts the number censored in the interval $[t_{j-1},t_{j})$, where $t_{0}=0$. Therefore:\n- $c_{1}$ counts censoring in $[0,3)$: none, so $c_{1}=0$.\n- $c_{2}$ counts censoring in $[3,5)$: time $4$ only, so $c_{2}=1$.\n- $c_{3}$ counts censoring in $[5,7)$: time $5$ only, so $c_{3}=1$.\n- $c_{4}$ counts censoring in $[7,9)$: time $8$ only, so $c_{4}=1$.\n- $c_{5}$ counts censoring in $[9,11)$: time $10$ only, so $c_{5}=1$.\nCensorings at time $12$ lie in $[11,\\infty)$ and thus do not contribute to any $c_{j}$ for $j=1,\\dots,5$.\n\nBy definition, $Y_{j}$ is the number at risk just prior to $t_{j}$. Using $n=15$ and the recursive update that removes events at $t_{j-1}$ and censorings in $[t_{j-1},t_{j})$, we have:\n$$\nY_{1}=n-c_{1}=15-0=15,\n$$\nand for $j\\geq 2$,\n$$\nY_{j}=Y_{j-1}-d_{j-1}-c_{j}.\n$$\nCompute successively:\n- $Y_{2}=Y_{1}-d_{1}-c_{2}=15-2-1=12$,\n- $Y_{3}=Y_{2}-d_{2}-c_{3}=12-1-1=10$,\n- $Y_{4}=Y_{3}-d_{3}-c_{4}=10-3-1=6$,\n- $Y_{5}=Y_{4}-d_{4}-c_{5}=6-2-1=3$.\n\nCollecting $(Y_{j},d_{j},c_{j})$ for $j=1,\\dots,5$ in the order of event times $t_{j}=(3,5,7,9,11)$ yields the matrix with rows\n$(15,2,0)$, $(12,1,1)$, $(10,3,1)$, $(6,2,1)$, $(3,1,1)$.", "answer": "$$\\boxed{\\begin{pmatrix}\n15  2  0 \\\\\n12  1  1 \\\\\n10  3  1 \\\\\n6  2  1 \\\\\n3  1  1\n\\end{pmatrix}}$$", "id": "1961488"}, {"introduction": "Once the data is properly ordered, we can compute the survival function using the product-limit formula. This practice problem provides a direct application of the Kaplan-Meier estimator, requiring you to calculate the survival probability $\\hat{S}(t)$ at a specific event time [@problem_id:1961438]. By working through this calculation, you will solidify your understanding of how the estimator accounts for both events and censored data in a step-by-step, multiplicative process.", "problem": "A materials science research group is testing the durability of a new type of biodegradable electronic component. A total of 8 components are subjected to an accelerated aging test. An \"event\" is defined as the component failing. Due to limitations in the testing apparatus, some tests are stopped before the component fails; these are considered \"censored\" observations. The study recorded the following data, where each pair represents (time in hours, status), with status '1' indicating a failure and status '0' indicating the observation was censored at that time:\n\n(15, 1), (25, 1), (40, 1), (30, 0), (50, 1), (35, 0), (55, 0), (20, 1)\n\nCalculate the Kaplan-Meier estimate of the survival function, $\\hat{S}(t)$, evaluated at the exact time of the second observed failure event in the study. Express your answer as a decimal rounded to three significant figures.", "solution": "The problem asks for the Kaplan-Meier estimate of the survival function, $\\hat{S}(t)$, at a specific time. The Kaplan-Meier estimator is a non-parametric statistic used to estimate the survival function from lifetime data, which may be censored. The formula for the estimator is the product-limit formula:\n$$ \\hat{S}(t) = \\prod_{i: t_i \\le t} \\left( 1 - \\frac{d_i}{n_i} \\right) $$\nwhere $t_i$ are the distinct times at which an event (failure) occurs, $d_i$ is the number of events at time $t_i$, and $n_i$ is the number of individuals at risk (i.e., components still under observation and not having failed) just prior to time $t_i$.\n\nFirst, we must organize the data chronologically. The dataset consists of 8 components with their event/censoring times: (15, 1), (25, 1), (40, 1), (30, 0), (50, 1), (35, 0), (55, 0), (20, 1). Sorting these by time gives:\n\n1.  Time 15: Failure (Event)\n2.  Time 20: Failure (Event)\n3.  Time 25: Failure (Event)\n4.  Time 30: Censored\n5.  Time 35: Censored\n6.  Time 40: Failure (Event)\n7.  Time 50: Failure (Event)\n8.  Time 55: Censored\n\nThe problem asks for the estimate $\\hat{S}(t)$ at the time of the *second observed failure event*. From the ordered list, the first failure event occurs at $t=15$ hours, and the second failure event occurs at $t=20$ hours. Therefore, we need to calculate $\\hat{S}(20)$.\n\nThe calculation involves taking a product over all distinct event times up to and including $t=20$. The relevant event times are $t_1 = 15$ and $t_2 = 20$.\n\nAt the beginning of the study, at $t=0$, all 8 components are at risk.\n\n**Step 1: Calculate the survival factor for the first event at $t_1 = 15$.**\n- The number of components at risk just before $t=15$ is $n_1 = 8$.\n- The number of failures at $t=15$ is $d_1 = 1$.\n- The survival probability estimate just after this event is calculated. The factor for this step is $\\left(1 - \\frac{d_1}{n_1}\\right) = \\left(1 - \\frac{1}{8}\\right) = \\frac{7}{8}$.\n- The Kaplan-Meier estimate for any time $t$ in the interval $[15, 20)$ is $\\hat{S}(t) = \\frac{7}{8}$.\n\n**Step 2: Calculate the survival factor for the second event at $t_2 = 20$.**\n- To find the number of components at risk just before $t=20$, we start with the number at risk before the previous event ($n_1=8$) and subtract all individuals who had an event or were censored between that time and the current time. One component failed at $t=15$. No components were censored between $t=15$ and $t=20$.\n- So, the number of components at risk just before $t=20$ is $n_2 = 8 - 1 = 7$.\n- The number of failures at $t=20$ is $d_2 = 1$.\n- The factor for this step is $\\left(1 - \\frac{d_2}{n_2}\\right) = \\left(1 - \\frac{1}{7}\\right) = \\frac{6}{7}$.\n\n**Step 3: Combine the factors to find $\\hat{S}(20)$.**\nThe value of the Kaplan-Meier estimator at $t=20$ is the product of all survival factors for events occurring at or before this time.\n$$ \\hat{S}(20) = \\prod_{i: t_i \\le 20} \\left( 1 - \\frac{d_i}{n_i} \\right) = \\left(1 - \\frac{d_1}{n_1}\\right) \\times \\left(1 - \\frac{d_2}{n_2}\\right) $$\n$$ \\hat{S}(20) = \\left(\\frac{7}{8}\\right) \\times \\left(\\frac{6}{7}\\right) $$\nThe '7' terms cancel out:\n$$ \\hat{S}(20) = \\frac{6}{8} = \\frac{3}{4} $$\nAs a decimal, this is $0.75$.\n\nThe problem requires the answer to be rounded to three significant figures. To express $0.75$ with three significant figures, we add a trailing zero.\n\nTherefore, the Kaplan-Meier estimate is $0.750$.", "answer": "$$\\boxed{0.750}$$", "id": "1961438"}, {"introduction": "The Kaplan-Meier survival curve is a step function, where the probability of survival only decreases at the precise moments events occur. This exercise focuses on the dynamics of these changes by asking you to calculate the magnitude of a single \"drop\" in the curve [@problem_id:1961458]. Understanding how this drop is determined by the number of individuals at risk and the number of events provides deeper insight into the conditional probability logic that underpins the entire method.", "problem": "In a clinical trial for a new medication, researchers are tracking the time to disease relapse for a group of patients. The data is analyzed using the Kaplan-Meier estimator to determine the survival function, $S(t)$, which represents the probability of a patient remaining relapse-free beyond time $t$ (measured in weeks).\n\nAt the beginning of week 15, there are 20 patients who have not yet relapsed and are still being monitored in the study (i.e., they are 'at risk'). Based on the data collected up to, but not including, week 15, the Kaplan-Meier estimate of the survival probability is $S(15^{-}) = 0.850$.\n\nDuring week 15, it is observed that exactly three patients suffer a relapse. There are no other events (like patients dropping out of the study) recorded at week 15.\n\nCalculate the magnitude of the drop in the Kaplan-Meier estimate of the survival function at time $t=15$ weeks. Round your final answer to three significant figures.", "solution": "The Kaplan-Meier estimator for the survival function, $S(t)$, is a non-parametric statistic that changes its value only at times when an event (in this case, a relapse) occurs. The general formula for the estimator is a product over the event times $t_i$ up to time $t$:\n$$S(t) = \\prod_{t_i \\le t} \\left(1 - \\frac{d_i}{n_i}\\right)$$\nwhere $d_i$ is the number of events at time $t_i$ and $n_i$ is the number of subjects at risk just before time $t_i$.\n\nLet's denote the time of interest as $t_k = 15$ weeks. The Kaplan-Meier estimate of the survival function is a step function. Its value just before the event at time $t_k$ is denoted by $S(t_k^{-})$, and its value at the time of the event is $S(t_k)$.\n\nThe value of the estimator at time $t_k$ is calculated by multiplying the value just before $t_k$ by the conditional probability of surviving past $t_k$, given survival up to $t_k$.\n$$S(t_k) = S(t_k^{-}) \\times \\left(1 - \\frac{d_k}{n_k}\\right)$$\nHere, $d_k$ is the number of events at time $t_k$, and $n_k$ is the number of individuals at risk just before time $t_k$.\n\nThe problem asks for the magnitude of the drop in the survival function at $t=15$. This drop is the difference between the survival probability just before the event and the survival probability at the time of the event.\n$$\\text{Drop} = S(t_k^{-}) - S(t_k)$$\n\nWe can substitute the expression for $S(t_k)$ into the equation for the drop:\n$$\\text{Drop} = S(t_k^{-}) - \\left[ S(t_k^{-}) \\times \\left(1 - \\frac{d_k}{n_k}\\right) \\right]$$\n\nNow, we can factor out the common term $S(t_k^{-})$:\n$$\\text{Drop} = S(t_k^{-}) \\left[ 1 - \\left(1 - \\frac{d_k}{n_k}\\right) \\right]$$\n\nSimplifying the expression inside the brackets gives:\n$$\\text{Drop} = S(t_k^{-}) \\left[ 1 - 1 + \\frac{d_k}{n_k} \\right]$$\n$$\\text{Drop} = S(t_k^{-}) \\frac{d_k}{n_k}$$\n\nFrom the problem statement, we are given the following values for the event at $t_k = 15$ weeks:\n- The number of patients at risk just before week 15: $n_{15} = 20$.\n- The number of patients who relapsed at week 15: $d_{15} = 3$.\n- The Kaplan-Meier estimate just before week 15: $S(15^{-}) = 0.850$.\n\nSubstituting these values into our derived formula for the drop:\n$$\\text{Drop} = 0.850 \\times \\frac{3}{20}$$\n$$\\text{Drop} = 0.850 \\times 0.15$$\n$$\\text{Drop} = 0.1275$$\n\nThe problem requires the answer to be rounded to three significant figures. The first three significant figures are 1, 2, and 7. The fourth significant figure is 5, so we round up the third digit.\n$$\\text{Drop} \\approx 0.128$$", "answer": "$$\\boxed{0.128}$$", "id": "1961458"}]}