{"hands_on_practices": [{"introduction": "This exercise takes us back to the very definition of a discrete logarithm. By systematically calculating the powers of a base element, we directly search for the exponent that yields our target value. This brute-force method [@problem_id:3089871], while computationally intensive for large primes, provides a concrete understanding of the problem and highlights the importance of the base being a primitive root to ensure a unique solution exists within the group.", "problem": "Let $p=43$ be a prime and consider the multiplicative group $\\mathbb{Z}_{p}^{\\times}$ of units modulo $p$. Let $g=3$. The discrete logarithm $\\log_{g}(a)$ modulo $p$ is defined to be an integer $x$ such that $g^{x}\\equiv a \\pmod{p}$, interpreted as a residue class modulo the order of $g$ in $\\mathbb{Z}_{p}^{\\times}$. Using only the definition of $\\mathbb{Z}_{p}^{\\times}$ and Fermat’s little theorem (which states $a^{p-1}\\equiv 1 \\pmod{p}$ for any $a$ not divisible by $p$), determine the integer $x$ with $0 \\le x  42$ satisfying $g^{x}\\equiv 5 \\pmod{43}$ by explicitly enumerating powers of $g$ modulo $p$. Then, justify from first principles why this solution is unique modulo $42$ by analyzing the order of $g$ in $\\mathbb{Z}_{43}^{\\times}$. Your final answer must be the single integer value of $x$.", "solution": "The problem asks to find an integer $x$ in the range $0 \\le x  42$ that satisfies the congruence $g^x \\equiv 5 \\pmod{p}$, where $p=43$ and $g=3$. The problem specifies that this is to be done by explicitly enumerating the powers of $g$ modulo $p$.\n\nThe congruence to be solved is:\n$$3^x \\equiv 5 \\pmod{43}$$\n\nWe compute the powers of $3$ modulo $43$ systematically.\n$3^1 \\equiv 3 \\pmod{43}$\n$3^2 \\equiv 9 \\pmod{43}$\n$3^3 \\equiv 27 \\pmod{43}$\n$3^4 \\equiv 3^3 \\cdot 3 \\equiv 27 \\cdot 3 = 81 \\equiv 38 \\pmod{43}$\n$3^5 \\equiv 3^4 \\cdot 3 \\equiv 38 \\cdot 3 = 114 \\equiv 2 \\cdot 43 + 28 \\equiv 28 \\pmod{43}$\n$3^6 \\equiv 3^5 \\cdot 3 \\equiv 28 \\cdot 3 = 84 \\equiv 1 \\cdot 43 + 41 \\equiv 41 \\pmod{43}$\n$3^7 \\equiv 3^6 \\cdot 3 \\equiv 41 \\cdot 3 = 123 \\equiv 2 \\cdot 43 + 37 \\equiv 37 \\pmod{43}$\n$3^8 \\equiv 3^7 \\cdot 3 \\equiv 37 \\cdot 3 = 111 \\equiv 2 \\cdot 43 + 25 \\equiv 25 \\pmod{43}$\n$3^9 \\equiv 3^8 \\cdot 3 \\equiv 25 \\cdot 3 = 75 \\equiv 1 \\cdot 43 + 32 \\equiv 32 \\pmod{43}$\n$3^{10} \\equiv 3^9 \\cdot 3 \\equiv 32 \\cdot 3 = 96 \\equiv 2 \\cdot 43 + 10 \\equiv 10 \\pmod{43}$\n$3^{11} \\equiv 3^{10} \\cdot 3 \\equiv 10 \\cdot 3 = 30 \\pmod{43}$\n$3^{12} \\equiv 3^{11} \\cdot 3 \\equiv 30 \\cdot 3 = 90 \\equiv 2 \\cdot 43 + 4 \\equiv 4 \\pmod{43}$\n$3^{13} \\equiv 3^{12} \\cdot 3 \\equiv 4 \\cdot 3 = 12 \\pmod{43}$\n$3^{14} \\equiv 3^{13} \\cdot 3 \\equiv 12 \\cdot 3 = 36 \\pmod{43}$\n$3^{15} \\equiv 3^{14} \\cdot 3 \\equiv 36 \\cdot 3 = 108 \\equiv 2 \\cdot 43 + 22 \\equiv 22 \\pmod{43}$\n$3^{16} \\equiv 3^{15} \\cdot 3 \\equiv 22 \\cdot 3 = 66 \\equiv 1 \\cdot 43 + 23 \\equiv 23 \\pmod{43}$\n$3^{17} \\equiv 3^{16} \\cdot 3 \\equiv 23 \\cdot 3 = 69 \\equiv 1 \\cdot 43 + 26 \\equiv 26 \\pmod{43}$\n$3^{18} \\equiv 3^{17} \\cdot 3 \\equiv 26 \\cdot 3 = 78 \\equiv 1 \\cdot 43 + 35 \\equiv 35 \\pmod{43}$\n$3^{19} \\equiv 3^{18} \\cdot 3 \\equiv 35 \\cdot 3 = 105 \\equiv 2 \\cdot 43 + 19 \\equiv 19 \\pmod{43}$\n$3^{20} \\equiv 3^{19} \\cdot 3 \\equiv 19 \\cdot 3 = 57 \\equiv 1 \\cdot 43 + 14 \\equiv 14 \\pmod{43}$\n$3^{21} \\equiv 3^{20} \\cdot 3 \\equiv 14 \\cdot 3 = 42 \\equiv -1 \\pmod{43}$\n$3^{22} \\equiv 3^{21} \\cdot 3 \\equiv 42 \\cdot 3 = 126 \\equiv 2 \\cdot 43 + 40 \\equiv 40 \\pmod{43}$\n$3^{23} \\equiv 3^{22} \\cdot 3 \\equiv 40 \\cdot 3 = 120 \\equiv 2 \\cdot 43 + 34 \\equiv 34 \\pmod{43}$\n$3^{24} \\equiv 3^{23} \\cdot 3 \\equiv 34 \\cdot 3 = 102 \\equiv 2 \\cdot 43 + 16 \\equiv 16 \\pmod{43}$\n$3^{25} \\equiv 3^{24} \\cdot 3 \\equiv 16 \\cdot 3 = 48 \\equiv 1 \\cdot 43 + 5 \\equiv 5 \\pmod{43}$\n\nThe enumeration shows that for $x=25$, we have $3^{25} \\equiv 5 \\pmod{43}$. Since $0 \\le 25  42$, this is the desired integer solution.\n\nNext, we must justify from first principles why this solution is unique modulo $42$ by analyzing the order of $g=3$ in the multiplicative group $\\mathbb{Z}_{43}^{\\times}$.\nThe order of the group $\\mathbb{Z}_{p}^{\\times}$ is given by Euler's totient function, $|\\mathbb{Z}_{p}^{\\times}| = \\phi(p)$. Since $p=43$ is a prime number, $\\phi(43) = 43 - 1 = 42$.\nBy Lagrange's theorem, the order of any element in a finite group must divide the order of the group. Therefore, the order of $g=3$ in $\\mathbb{Z}_{43}^{\\times}$, denoted $\\text{ord}_{43}(3)$, must be a divisor of $42$. The divisors of $42$ are $1, 2, 3, 6, 7, 14, 21, 42$.\nTo show that $\\text{ord}_{43}(3) = 42$, we must show that $3^k \\not\\equiv 1 \\pmod{43}$ for any proper divisor $k$ of $42$. It is sufficient to check this for the maximal proper divisors, which are obtained by dividing $42$ by its prime factors ($2, 3, 7$).\nWe check:\n1. $k = 42/2 = 21$: From our earlier calculation, $3^{21} \\equiv 42 \\equiv -1 \\pmod{43}$. This is not congruent to $1$.\n2. $k = 42/3 = 14$: From our earlier calculation, $3^{14} \\equiv 36 \\pmod{43}$. This is not congruent to $1$.\n3. $k = 42/7 = 6$: From our earlier calculation, $3^{6} \\equiv 41 \\pmod{43}$. This is not congruent to $1$.\nSince the order of $3$ is not any of the proper divisors of $42$, it must be that $\\text{ord}_{43}(3) = 42$. An element whose order is equal to the order of the group is called a primitive root. Thus, $g=3$ is a primitive root modulo $43$.\n\nNow we prove the uniqueness of the solution $x$ modulo $42$. Suppose there exist two integers, $x_1$ and $x_2$, that both satisfy the congruence.\n$$g^{x_1} \\equiv 5 \\pmod{p} \\quad \\text{and} \\quad g^{x_2} \\equiv 5 \\pmod{p}$$\nThis implies that $g^{x_1} \\equiv g^{x_2} \\pmod{p}$.\nSince $g \\in \\mathbb{Z}_{p}^{\\times}$, its inverse $g^{-1}$ exists. We can multiply both sides of the congruence by $(g^{x_2})^{-1} = g^{-x_2}$:\n$$g^{x_1} \\cdot g^{-x_2} \\equiv g^{x_2} \\cdot g^{-x_2} \\pmod{p}$$\n$$g^{x_1 - x_2} \\equiv g^0 \\equiv 1 \\pmod{p}$$\nBy the definition of the order of an element, if $g^k \\equiv 1 \\pmod{p}$, then the order of $g$ must divide $k$. In our case, this means that $\\text{ord}_p(g)$ must divide $x_1 - x_2$.\nWe have established that $\\text{ord}_{43}(3) = 42$. Therefore, $42$ must divide $x_1 - x_2$.\nThis is precisely the definition of congruence modulo $42$:\n$$x_1 \\equiv x_2 \\pmod{42}$$\nThis shows that any solution to $3^x \\equiv 5 \\pmod{43}$ must be unique modulo $42$. The problem asks for the solution in the specific interval $0 \\le x  42$. Since the integers from $0$ to $41$ form a complete set of residues modulo $42$, there can be only one solution in this interval. Our calculated value $x=25$ is that unique solution.", "answer": "$$\n\\boxed{25}\n$$", "id": "3089871"}, {"introduction": "Direct enumeration becomes impractical as numbers grow larger, making it essential to learn more efficient methods. The Baby-Step Giant-Step (BSGS) algorithm offers a much more efficient, deterministic solution by employing a classic time-space tradeoff. This practice [@problem_id:3089883] walks you through this \"meet-in-the-middle\" strategy, where you will build a table of small steps (\"baby steps\") and then take large leaps (\"giant steps\") to find a collision, drastically reducing the search time from $O(p)$ to roughly $O(\\sqrt{p})$.", "problem": "Let $p=59$ be a prime and let $g=2$ be a primitive root modulo $p$. Consider the discrete logarithm problem in the multiplicative group $\\left(\\mathbb{Z}/p\\mathbb{Z}\\right)^{\\times}$: find the least nonnegative integer $x \\in \\{0,1,\\dots,p-2\\}$ such that $g^{x} \\equiv 13 \\pmod{p}$. Use the baby-step giant-step (BSGS) method to determine $x$, and then verify your result by a direct congruence computation using properties of powers modulo a prime. Report your final answer as a single integer in the range $0 \\le x \\le p-2$.", "solution": "To solve the discrete logarithm problem $2^x \\equiv 13 \\pmod{59}$ using the baby-step giant-step (BSGS) algorithm, we first set up the parameters. The order of the group $(\\mathbb{Z}/59\\mathbb{Z})^{\\times}$ is $n = 59-1 = 58$. We choose $m = \\lceil \\sqrt{58} \\rceil = 8$. We seek a solution of the form $x = im + j = 8i+j$, where $0 \\le i, j  8$.\n\nThe original congruence $2^{8i+j} \\equiv 13 \\pmod{59}$ can be rearranged to find a \"meet-in-the-middle\" collision: $2^j \\equiv 13 \\cdot (2^8)^{-i} \\pmod{59}$.\n\nFirst, we compute the \"giant step\" multiplier. The giant step size is $g^m = 2^8 \\equiv 20 \\pmod{59}$. Its inverse, needed for the right side of the equation, is found using the Extended Euclidean Algorithm: $20^{-1} \\equiv 3 \\pmod{59}$. Let this inverse be $c=3$.\n\n**Baby Steps:**\nWe build a lookup table of pairs $(g^j \\pmod{59}, j)$ for $j=0, 1, \\dots, 7$:\n- $2^0 \\equiv 1 \\pmod{59} \\implies (1, 0)$\n- $2^1 \\equiv 2 \\pmod{59} \\implies (2, 1)$\n- $2^2 \\equiv 4 \\pmod{59} \\implies (4, 2)$\n- $2^3 \\equiv 8 \\pmod{59} \\implies (8, 3)$\n- $2^4 \\equiv 16 \\pmod{59} \\implies (16, 4)$\n- $2^5 \\equiv 32 \\pmod{59} \\implies (32, 5)$\n- $2^6 \\equiv 5 \\pmod{59} \\implies (5, 6)$\n- $2^7 \\equiv 10 \\pmod{59} \\implies (10, 7)$\nThe table maps values $\\{1, 2, 4, 8, 16, 32, 5, 10\\}$ to their corresponding exponents.\n\n**Giant Steps:**\nWe now compute $y_i = h \\cdot c^i = 13 \\cdot 3^i \\pmod{59}$ for $i=0, 1, \\dots, 7$ and check if $y_i$ is in our table of baby step values.\n- $i=0: y_0 = 13 \\cdot 3^0 \\equiv 13$. No match.\n- $i=1: y_1 = 13 \\cdot 3 \\equiv 39$. No match.\n- $i=2: y_2 = 39 \\cdot 3 \\equiv 117 \\equiv 58$. No match.\n- $i=3: y_3 = 58 \\cdot 3 \\equiv 174 \\equiv 56$. No match.\n- $i=4: y_4 = 56 \\cdot 3 \\equiv 168 \\equiv 50$. No match.\n- $i=5: y_5 = 50 \\cdot 3 \\equiv 150 \\equiv 32$. **Match!** The value $32$ is in our baby steps table, corresponding to $j=5$.\n\nWe have found a collision with $i=5$ and $j=5$. The solution is $x = im + j = 5 \\cdot 8 + 5 = 45$.\n\n**Verification:**\nTo verify the result, we compute $2^{45} \\pmod{59}$ using binary exponentiation.\n$45 = 32+8+4+1$.\n$2^1 \\equiv 2$\n$2^4 \\equiv 16$\n$2^8 \\equiv 16^2 = 256 \\equiv 20$\n$2^{16} \\equiv 20^2 = 400 \\equiv 46$\n$2^{32} \\equiv 46^2 = 2116 \\equiv 51 \\pmod{59}$.\nSo, $2^{45} = 2^{32} \\cdot 2^8 \\cdot 2^4 \\cdot 2^1 \\equiv 51 \\cdot 20 \\cdot 16 \\cdot 2 \\pmod{59}$.\n$51 \\cdot 20 = 1020 \\equiv 17 \\pmod{59}$.\n$17 \\cdot 16 = 272 \\equiv 36 \\pmod{59}$.\n$36 \\cdot 2 = 72 \\equiv 13 \\pmod{59}$.\nThe calculation confirms $2^{45} \\equiv 13 \\pmod{59}$, so our solution is correct.", "answer": "$$\\boxed{45}$$", "id": "3089883"}, {"introduction": "For cases where the group's order has a favorable structure (i.e., is a \"smooth number\" with small prime factors), the Pohlig-Hellman algorithm provides a remarkably efficient \"divide and conquer\" strategy. Instead of tackling the large problem head-on, it cleverly breaks the discrete logarithm problem into several smaller, independent problems corresponding to the prime factors of the group's order. This exercise [@problem_id:3089854] demonstrates how to solve these simpler congruences and then skillfully reconstruct the final answer using the Chinese Remainder Theorem, showcasing a powerful synergy between different number-theoretic tools.", "problem": "Let $p=191$ be prime and consider the multiplicative group $(\\mathbb{Z}/p\\mathbb{Z})^{\\times}$, which is cyclic of order $p-1$. Let $m=p-1=190$, whose prime factorization is $190=2\\cdot 5\\cdot 19$. Take the base $g=21\\in(\\mathbb{Z}/191\\mathbb{Z})^{\\times}$ and the target $h=83\\in(\\mathbb{Z}/191\\mathbb{Z})^{\\times}$. Use the Pohlig–Hellman algorithm to determine the discrete logarithm $x\\in\\{0,1,\\dots,m-1\\}$ such that $g^{x}\\equiv h\\pmod{p}$. In your work, derive $x \\pmod 2$, $x \\pmod 5$, and $x \\pmod{19}$ by working in the corresponding prime-order subgroups, and then recover $x \\pmod{190}$ via the Chinese Remainder Theorem (CRT). Explicitly verify each component solution by showing the necessary exponentiations and congruence checks. Conclude with the single integer $x$ in the range $\\{0, 1, \\dots, 189\\}$ that satisfies $21^{x}\\equiv 83\\pmod{191}$. No rounding is required; report the exact integer value.", "solution": "We are asked to solve the congruence $21^x \\equiv 83 \\pmod{191}$ using the Pohlig-Hellman algorithm. The modulus is a prime $p=191$, so we work in the multiplicative group $(\\mathbb{Z}/191\\mathbb{Z})^{\\times}$, which has order $m = p-1 = 190$. The prime factorization of the order is $m = 2 \\cdot 5 \\cdot 19$. The algorithm proceeds by finding the value of the exponent $x$ modulo each of these prime factors ($2, 5, 19$) and then combining the results using the Chinese Remainder Theorem.\n\nFor a unique solution to exist, the base $g=21$ must be a generator of the group. This is true if $g^{m/q} \\not\\equiv 1 \\pmod p$ for each prime factor $q$ of $m$. We can verify this:\n- $21^{190/2} = 21^{95} \\equiv \\left(\\frac{21}{191}\\right) = -1 \\pmod{191}$.\n- $21^{190/5} = 21^{38} \\equiv 184 \\pmod{191}$.\n- $21^{190/19} = 21^{10} \\equiv 30 \\pmod{191}$.\nSince none of these are 1, $g=21$ is a generator.\n\n**1. Determine $x \\pmod 2$**\nWe raise the original congruence to the power of $m/2 = 95$:\n$(21^x)^{95} \\equiv 83^{95} \\pmod{191}$\nLet $x \\equiv x_1 \\pmod 2$. This reduces to $(21^{95})^{x_1} \\equiv 83^{95} \\pmod{191}$.\nWe compute the terms:\n- $\\gamma_1 = 21^{95} \\equiv -1 \\pmod{191}$ (as shown above).\n- $\\eta_1 = 83^{95} \\equiv \\left(\\frac{83}{191}\\right) = -1 \\pmod{191}$.\nThe congruence becomes $(-1)^{x_1} \\equiv -1 \\pmod{191}$, which implies $x_1=1$.\nTherefore, $x \\equiv 1 \\pmod 2$.\n\n**2. Determine $x \\pmod 5$**\nWe raise the original congruence to the power of $m/5 = 38$:\n$(21^x)^{38} \\equiv 83^{38} \\pmod{191}$\nLet $x \\equiv x_2 \\pmod 5$. This reduces to $(21^{38})^{x_2} \\equiv 83^{38} \\pmod{191}$.\n- $\\gamma_2 = 21^{38} \\equiv 184 \\pmod{191}$.\n- $\\eta_2 = 83^{38} \\equiv 39 \\pmod{191}$.\nWe need to solve $184^{x_2} \\equiv 39 \\pmod{191}$. We test values for $x_2 \\in \\{0, 1, 2, 3, 4\\}$:\n$184^0 \\equiv 1$, $184^1 \\equiv 184$, $184^2 \\equiv 49$, $184^3 \\equiv 49 \\cdot 184 \\equiv 39 \\pmod{191}$.\nWe find $x_2 = 3$.\nTherefore, $x \\equiv 3 \\pmod 5$.\n\n**3. Determine $x \\pmod{19}$**\nWe raise the original congruence to the power of $m/19 = 10$:\n$(21^x)^{10} \\equiv 83^{10} \\pmod{191}$\nLet $x \\equiv x_3 \\pmod{19}$. This reduces to $(21^{10})^{x_3} \\equiv 83^{10} \\pmod{191}$.\n- $\\gamma_3 = 21^{10} \\equiv 30 \\pmod{191}$.\n- $\\eta_3 = 83^{10} \\equiv 180 \\pmod{191}$.\nWe need to solve $30^{x_3} \\equiv 180 \\pmod{191}$. By trial, we find $30^9 \\equiv 180 \\pmod{191}$.\nWe find $x_3 = 9$.\nTherefore, $x \\equiv 9 \\pmod{19}$.\n\n**4. Recover $x$ using the Chinese Remainder Theorem**\nWe now solve the system of congruences:\n$$ x \\equiv 1 \\pmod 2 $$\n$$ x \\equiv 3 \\pmod 5 $$\n$$ x \\equiv 9 \\pmod{19} $$\nFrom the first two, $x \\equiv 3 \\pmod{10}$.\nNow we solve $x \\equiv 3 \\pmod{10}$ and $x \\equiv 9 \\pmod{19}$.\nLet $x = 10k + 3$. Then $10k+3 \\equiv 9 \\pmod{19}$, which simplifies to $10k \\equiv 6 \\pmod{19}$.\nThe inverse of $10$ modulo $19$ is $2$ (since $10 \\cdot 2 = 20 \\equiv 1 \\pmod{19}$).\nMultiplying by $2$, we get $k \\equiv 6 \\cdot 2 = 12 \\pmod{19}$.\nSo $k = 19j + 12$ for some integer $j$.\nSubstituting back into the expression for $x$:\n$x = 10(19j+12) + 3 = 190j + 120 + 3 = 190j + 123$.\nThus, $x \\equiv 123 \\pmod{190}$.\n\nThe unique solution in the range $\\{0, 1, \\dots, 189\\}$ is $x=123$.\nA final check verifies that $21^{123} \\equiv 83 \\pmod{191}$.", "answer": "$$\\boxed{123}$$", "id": "3089854"}]}