{"hands_on_practices": [{"introduction": "The power of modular exponentiation lies not just in its correctness but in its remarkable efficiency, which is crucial for applications handling immense numbers. This practice moves beyond simply executing the algorithm to analyzing its performance. By examining the binary representation of a large exponent, you will determine the exact number of modular multiplications required, providing a concrete understanding of why repeated squaring is indispensable for modern cryptography and number theory [@problem_id:3087339].", "problem": "Let $e = 10^{6}$ be the exponent in the modular exponentiation problem $a^{e} \\bmod n$, where $a$ and $n$ are fixed integers with $n \\geq 2$ and $a \\geq 1$. \n\nFirst, compute the binary expansion of $e$, that is, write $e$ uniquely in the form $e = \\sum_{i=0}^{t-1} b_{i} 2^{i}$ with $b_{i} \\in \\{0,1\\}$ and $b_{t-1} = 1$. Then, consider the standard left-to-right square-and-multiply method for modular exponentiation, defined as follows: initialize $r \\leftarrow a$, then scan the remaining bits of $e$ from the next most significant down to the least significant; at each step, replace $r$ by $r^{2} \\bmod n$, and if the current bit is $1$, additionally replace $r$ by $r \\cdot a \\bmod n$. \n\nAssume the cost model in which each modular squaring and each modular multiplication by $a$ is counted as one modular multiplication. Using the binary expansion of $e$, determine the total number of modular multiplications required by this method to compute $a^{e} \\bmod n$. Express your final answer as a single integer. Do not compute $a^{e} \\bmod n$ itself.", "solution": "The problem is valid as it is scientifically grounded in computational number theory, well-posed with a clear algorithmic description and cost model, and objectively stated.\n\nThe problem requires us to determine the total number of modular multiplications needed to compute $a^{e} \\bmod n$ using a specific version of the left-to-right square-and-multiply algorithm, for the exponent $e = 10^{6}$. The cost model counts each modular squaring and each modular multiplication by $a$ as one modular multiplication.\n\nFirst, let's analyze the given algorithm and its associated cost. The exponent $e$ has a unique binary expansion $e = \\sum_{i=0}^{t-1} b_{i} 2^{i}$, where $b_{i} \\in \\{0,1\\}$ and the most significant bit is $b_{t-1} = 1$. The number of bits in this representation is $t$. This number is given by $t = \\lfloor \\log_{2}(e) \\rfloor + 1$.\n\nThe algorithm is defined as follows:\n1. Initialize $r \\leftarrow a$. This step corresponds to the most significant bit $b_{t-1}=1$ and, according to the problem description, is an initialization that does not incur a cost.\n2. Scan the remaining bits of $e$ from the next most significant down to the least significant. These are the bits $b_{t-2}, b_{t-3}, \\dots, b_0$. The number of such bits is $(t-2) - 0 + 1 = t-1$.\n3. At each step, a modular squaring is performed: $r$ is replaced by $r^{2} \\bmod n$. Since there are $t-1$ steps in the loop (one for each bit from $b_{t-2}$ to $b_0$), the total number of modular squarings is $t-1$.\n4. At each step, if the current bit is $1$, an additional modular multiplication is performed: $r$ is replaced by $r \\cdot a \\bmod n$. The number of these additional multiplications is equal to the number of set bits (bits equal to $1$) among $b_{t-2}, b_{t-3}, \\dots, b_0$.\n\nLet $H(e)$ denote the Hamming weight of $e$, which is the total number of bits equal to $1$ in its binary expansion. Since we know $b_{t-1}=1$, the number of set bits in the remaining part of the expansion ($b_{t-2}, \\dots, b_0$) is $H(e)-1$.\n\nThe total number of modular multiplications, denoted by $C$, is the sum of the number of squarings and the number of additional multiplications by $a$.\nNumber of squarings = $t-1 = (\\lfloor \\log_{2}(e) \\rfloor + 1) - 1 = \\lfloor \\log_{2}(e) \\rfloor$.\nNumber of multiplications by $a = H(e)-1$.\nTherefore, the total cost is $C = (\\lfloor \\log_{2}(e) \\rfloor) + (H(e)-1)$.\n\nWe are given the exponent $e = 10^{6}$. To find the cost $C$, we need to compute $\\lfloor \\log_{2}(10^{6}) \\rfloor$ and $H(10^{6})$.\n\nFirst, let's compute $\\lfloor \\log_{2}(10^{6}) \\rfloor$:\n$\\log_{2}(10^{6}) = 6 \\log_{2}(10)$. We know that $2^{3} = 8$ and $2^{4} = 16$, so $3 < \\log_{2}(10) < 4$.\nTherefore, $6 \\times 3 < 6 \\log_{2}(10) < 6 \\times 4$, which means $18 < \\log_{2}(10^{6}) < 24$.\nFor a more precise calculation:\n$2^{19} = 524288$\n$2^{20} = 1048576$\nSince $2^{19} < 10^{6} < 2^{20}$, it follows that $19 < \\log_{2}(10^{6}) < 20$.\nThus, the floor is $\\lfloor \\log_{2}(10^{6}) \\rfloor = 19$.\nThis means the binary representation of $e=10^6$ has $t = 19+1 = 20$ bits. The number of squarings is $t-1 = 19$.\n\nNext, we need to find the binary representation of $e=10^{6}$ to determine its Hamming weight, $H(10^{6})$. We can do this by repeatedly dividing by $2$:\n$1000000 = 2 \\times 500000 + 0$\n$500000 = 2 \\times 250000 + 0$\n$250000 = 2 \\times 125000 + 0$\n$125000 = 2 \\times 62500 + 0$\n$62500 = 2 \\times 31250 + 0$\n$31250 = 2 \\times 15625 + 0$\n$15625 = 2 \\times 7812 + 1$\n$7812 = 2 \\times 3906 + 0$\n$3906 = 2 \\times 1953 + 0$\n$1953 = 2 \\times 976 + 1$\n$976 = 2 \\times 488 + 0$\n$488 = 2 \\times 244 + 0$\n$244 = 2 \\times 122 + 0$\n$122 = 2 \\times 61 + 0$\n$61 = 2 \\times 30 + 1$\n$30 = 2 \\times 15 + 0$\n$15 = 2 \\times 7 + 1$\n$7 = 2 \\times 3 + 1$\n$3 = 2 \\times 1 + 1$\n$1 = 2 \\times 0 + 1$\nReading the remainders from bottom to top, the binary representation of $10^{6}$ is:\n$e = (11110100001001000000)_2$.\nThis is a $20$-bit number, which is consistent with our calculation of $t=20$.\nThe Hamming weight, $H(10^{6})$, is the number of $1$s in this representation:\n$H(10^{6}) = 1+1+1+1+1+1+1 = 7$.\n\nNow we can calculate the total number of modular multiplications using our formula:\n$C = (\\lfloor \\log_{2}(10^{6}) \\rfloor) + (H(10^{6})-1)$.\n$C = 19 + (7 - 1) = 19 + 6 = 25$.\n\nThe total number of modular multiplications required is the sum of $19$ squarings and $6$ multiplications by $a$. This gives a total of $25$ operations.", "answer": "$$\n\\boxed{25}\n$$", "id": "3087339"}, {"introduction": "While the repeated squaring algorithm is efficient, a sharp number theorist always looks for structural shortcuts. This exercise explores the elegant patterns that emerge when the base $a$ is congruent to $1$ or $-1$ modulo $n$. By deriving these patterns, you will learn to solve seemingly complex exponentiations with enormous exponents almost instantly, reinforcing the fundamental properties of modular arithmetic [@problem_id:3087411].", "problem": "Consider integers $a$, $e$, and $n$ with $n \\geq 2$. Starting from the definition of congruence modulo $n$ and the algorithm of modular exponentiation by repeated squaring, analyze the structure of $a^{e} \\bmod n$ in the two special cases $a \\equiv 1 \\pmod{n}$ and $a \\equiv -1 \\pmod{n}$. Derive closed-form patterns that distinguish the outcomes for even and odd exponents $e$ in each case, using repeated squaring as your computational framework rather than any ad hoc shortcuts.\n\nThen, apply your conclusions to evaluate the following large modular expression using $n = 2026$:\n$$\n(n - 1)^{\\,3^{100} + 2^{300} + 7} \\cdot (n + 1)^{\\,5^{120} - 1} \\bmod n.\n$$\nExpress the final answer as the least nonnegative residue modulo $n$. No rounding is required.", "solution": "The foundational base is the definition of congruence and the structure of modular exponentiation by repeated squaring. Two well-tested facts we will use are:\n1. If $x \\equiv y \\pmod{n}$, then for any integer $k \\geq 1$, $x^{k} \\equiv y^{k} \\pmod{n}$.\n2. The repeated squaring algorithm computes $a^{e} \\bmod n$ by writing $e$ in base $2$ as $e = \\sum_{j=0}^{m} b_{j} 2^{j}$ with $b_{j} \\in \\{0,1\\}$, then forming\n$$\na^{e} \\equiv \\prod_{j=0}^{m} \\left(a^{2^{j}}\\right)^{b_{j}} \\pmod{n},\n$$\nwhere each $a^{2^{j}} \\bmod n$ is obtained by successive squaring modulo $n$.\n\nWe first analyze the special bases $a \\equiv 1 \\pmod{n}$ and $a \\equiv -1 \\pmod{n}$.\n\nCase 1: $a \\equiv 1 \\pmod{n}$. By the first fact,\n$$\na^{e} \\equiv 1^{e} \\equiv 1 \\pmod{n}\n$$\nfor every integer $e \\geq 1$. Under repeated squaring, $a^{2^{j}} \\equiv 1$ for all $j$, so the product of selected factors is $1$ regardless of the bits $b_{j}$ of $e$. Thus the closed-form pattern is $a^{e} \\equiv 1 \\pmod{n}$ for all $e$.\n\nCase 2: $a \\equiv -1 \\pmod{n}$. Using the repeated squaring structure, compute\n$$\na^{2} \\equiv (-1)^{2} \\equiv 1 \\pmod{n}, \\quad a^{4} \\equiv \\left(a^{2}\\right)^{2} \\equiv 1^{2} \\equiv 1 \\pmod{n},\n$$\nand by induction $a^{2^{j}} \\equiv 1 \\pmod{n}$ for all $j \\geq 1$, while $a^{2^{0}} = a \\equiv -1 \\pmod{n}$. Therefore, with $e = \\sum_{j=0}^{m} b_{j} 2^{j}$,\n$$\na^{e} \\equiv \\prod_{j=0}^{m} \\left(a^{2^{j}}\\right)^{b_{j}} \\equiv \\left((-1)^{1}\\right)^{b_{0}} \\cdot \\prod_{j=1}^{m} 1^{b_{j}} \\equiv (-1)^{b_{0}} \\pmod{n}.\n$$\nSince $b_{0}$ is the least significant bit of $e$, it encodes the parity of $e$: $b_{0} = 0$ if $e$ is even and $b_{0} = 1$ if $e$ is odd. Hence the closed-form pattern is\n$$\na^{e} \\equiv \\begin{cases}\n1 \\pmod{n}, & \\text{if $e$ is even},\\\\\n-1 \\pmod{n}, & \\text{if $e$ is odd}.\n\\end{cases}\n$$\nEquivalently, $a^{e} \\equiv (-1)^{e} \\pmod{n}$.\n\nWe now apply these conclusions to the specific expression with $n = 2026$:\n$$\n(n - 1)^{\\,3^{100} + 2^{300} + 7} \\cdot (n + 1)^{\\,5^{120} - 1} \\bmod n \\quad \\text{where} \\quad n = 2026.\n$$\nObserve that $n - 1 = 2025 \\equiv -1 \\pmod{2026}$ and $n + 1 = 2027 \\equiv 1 \\pmod{2026}$.\n\nFirst factor: $(n - 1)^{\\,3^{100} + 2^{300} + 7} \\bmod n$ with base congruent to $-1$. By the pattern, the value depends solely on the parity of the exponent $E_{1} = 3^{100} + 2^{300} + 7$. Determine $E_{1} \\bmod 2$:\n- $3$ is odd, so $3^{100}$ is odd; thus $3^{100} \\equiv 1 \\pmod{2}$.\n- $2$ is even, so $2^{300}$ is even; thus $2^{300} \\equiv 0 \\pmod{2}$.\n- $7$ is odd; thus $7 \\equiv 1 \\pmod{2}$.\nTherefore,\n$$\nE_{1} \\equiv 1 + 0 + 1 \\equiv 0 \\pmod{2},\n$$\nso $E_{1}$ is even and $(n - 1)^{E_{1}} \\equiv 1 \\pmod{n}$.\n\nSecond factor: $(n + 1)^{\\,5^{120} - 1} \\bmod n$ with base congruent to $1$. By the pattern for $a \\equiv 1 \\pmod{n}$, this is $1$ modulo $n$ for any exponent. Concretely,\n$$\n(n + 1)^{\\,5^{120} - 1} \\equiv 1 \\pmod{n}.\n$$\n\nCombining both factors,\n$$\n\\left[(n - 1)^{\\,3^{100} + 2^{300} + 7}\\right] \\cdot \\left[(n + 1)^{\\,5^{120} - 1}\\right] \\equiv 1 \\cdot 1 \\equiv 1 \\pmod{n}.\n$$\nThe least nonnegative residue modulo $n = 2026$ is therefore $1$.", "answer": "$$\\boxed{1}$$", "id": "3087411"}, {"introduction": "A powerful tool related to modular exponentiation is Euler's totient theorem, which allows for the reduction of large exponents, but its power comes with a critical prerequisite. This hands-on practice illustrates the breakdown that occurs when this condition—that the base and modulus are coprime—is not met. By directly comparing the correct result with the incorrect one obtained by misapplying the theorem, you will gain a firsthand appreciation for its theoretical boundaries and avoid common pitfalls [@problem_id:3087438].", "problem": "Let $n=45$ be a composite modulus, let $a=9$ be a base with $\\gcd(a,n)\\neq 1$, and let $e=120$ be an exponent. Using modular exponentiation by repeated squaring, compute the residue $r\\equiv a^{e}\\pmod{n}$ without appealing to any theorem that presumes $a$ is a unit modulo $n$. Separately, compute $\\varphi(n)$ and form the reduced exponent $e'\\equiv e\\pmod{\\varphi(n)}$, then compute $r'\\equiv a^{e'}\\pmod{n}$ (again by repeated squaring). Report the integer difference $\\Delta=r-r'$ as your final answer. In your explanation, starting from the foundational definitions of congruence, Euler’s totient function $\\varphi(n)$, and the multiplicative group of units modulo $n$, justify why reducing $e$ modulo $\\varphi(n)$ presumes an assumption that fails in this setup with $\\gcd(a,n)\\neq 1$.", "solution": "The problem is deemed valid as it is self-contained, scientifically grounded in number theory, and well-posed. We proceed with the solution.\n\nThe problem asks for several computations and a theoretical justification regarding modular exponentiation. We address each part systematically.\n\nFirst, we compute $r \\equiv a^e \\pmod{n}$ for $a=9$, $e=120$, and $n=45$ using modular exponentiation by repeated squaring. The exponent in binary representation is $e=120_{10} = 64 + 32 + 16 + 8 = 2^6 + 2^5 + 2^4 + 2^3$, which is $1111000_2$. We need to compute $a^{120} = a^{64} a^{32} a^{16} a^8 \\pmod{n}$.\n\nWe compute the required powers of $a=9$ modulo $n=45$:\n$$9^1 \\equiv 9 \\pmod{45}$$\n$$9^2 = 81 \\equiv 36 \\pmod{45}$$\n$$9^4 = (9^2)^2 \\equiv 36^2 = 1296 \\pmod{45}$$\nTo reduce $1296 \\pmod{45}$, we divide $1296$ by $45$. $1296 = 28 \\times 45 + 36$. Thus,\n$$9^4 \\equiv 36 \\pmod{45}$$\nWe observe that once we obtain the value $36$, squaring it repeatedly will yield $36$ again modulo $45$:\n$$36^2 \\equiv 36 \\pmod{45}$$\nTherefore, for any integer $k \\ge 1$:\n$$9^{2^k} \\equiv 36 \\pmod{45}$$\nThis applies to $9^4, 9^8, 9^{16}, 9^{32}, 9^{64}$.\n$$9^8 \\equiv (9^4)^2 \\equiv 36^2 \\equiv 36 \\pmod{45}$$\n$$9^{16} \\equiv (9^8)^2 \\equiv 36^2 \\equiv 36 \\pmod{45}$$\n$$9^{32} \\equiv (9^{16})^2 \\equiv 36^2 \\equiv 36 \\pmod{45}$$\n$$9^{64} \\equiv (9^{32})^2 \\equiv 36^2 \\equiv 36 \\pmod{45}$$\n\nNow we can compute $r$:\n$$r \\equiv 9^{120} \\pmod{45}$$\n$$r \\equiv 9^{64+32+16+8} \\pmod{45}$$\n$$r \\equiv 9^{64} \\cdot 9^{32} \\cdot 9^{16} \\cdot 9^8 \\pmod{45}$$\n$$r \\equiv 36 \\cdot 36 \\cdot 36 \\cdot 36 \\pmod{45}$$\nSince $36 \\cdot 36 \\equiv 36 \\pmod{45}$, this simplifies to:\n$$r \\equiv (36 \\cdot 36) \\cdot (36 \\cdot 36) \\equiv 36 \\cdot 36 \\equiv 36 \\pmod{45}$$\nSo, the correct residue is $r=36$.\n\nSecond, we compute Euler's totient function, $\\varphi(n)$, for $n=45$. The prime factorization of $n$ is $45 = 3^2 \\cdot 5^1$. The totient function is multiplicative for relatively prime arguments, so:\n$$\\varphi(45) = \\varphi(3^2) \\cdot \\varphi(5)$$\nUsing the formula $\\varphi(p^k) = p^k - p^{k-1}$:\n$$\\varphi(3^2) = 3^2 - 3^1 = 9 - 3 = 6$$\n$$\\varphi(5) = 5^1 - 5^0 = 5 - 1 = 4$$\nTherefore:\n$$\\varphi(45) = 6 \\cdot 4 = 24$$\n\nThird, we compute the reduced exponent $e' \\equiv e \\pmod{\\varphi(n)}$.\n$$e' \\equiv 120 \\pmod{24}$$\nSince $120 = 5 \\times 24 + 0$, we have $e' \\equiv 0 \\pmod{24}$. We choose the representative $e'=0$.\n\nFourth, we compute $r' \\equiv a^{e'} \\pmod{n}$.\n$$r' \\equiv 9^0 \\pmod{45}$$\nBy definition, for any non-zero base, $x^0=1$. Thus:\n$$r' = 1$$\n\nFifth, we calculate the difference $\\Delta = r - r'$.\n$$\\Delta = 36 - 1 = 35$$\n\nFinally, we provide the justification for why reducing the exponent $e$ modulo $\\varphi(n)$ is invalid in this case, starting from foundational definitions.\n\nThe relation of congruence modulo $n$, denoted by $a \\equiv b \\pmod{n}$, signifies that $n$ divides the difference $a-b$. This relation partitions the integers $\\mathbb{Z}$ into $n$ equivalence classes, forming the ring of integers modulo $n$, denoted $\\mathbb{Z}_n$ or $\\mathbb{Z}/n\\mathbb{Z}$.\n\nEuler's totient function, $\\varphi(n)$, counts the number of positive integers less than or equal to $n$ that are relatively prime to $n$. These integers correspond to the equivalence classes $[a]_n$ in $\\mathbb{Z}_n$ for which $\\gcd(a,n)=1$.\n\nThe set of these particular equivalence classes forms the multiplicative group of units modulo $n$, denoted $(\\mathbb{Z}/n\\mathbb{Z})^\\times$. An element $[a]_n$ is a \"unit\" because it has a multiplicative inverse modulo $n$, a property guaranteed if and only if $\\gcd(a,n)=1$. The order of this group (its number of elements) is precisely $|\\left(\\mathbb{Z}/n\\mathbb{Z}\\right)^\\times| = \\varphi(n)$.\n\nEuler's totient theorem is a statement about this group. It asserts that for any integer $a$ such that $\\gcd(a,n)=1$, it holds that:\n$$a^{\\varphi(n)} \\equiv 1 \\pmod{n}$$\nThis is a direct consequence of Lagrange's theorem from group theory, which states that the order of any element of a finite group divides the order of the group. For an element $[a]_n \\in (\\mathbb{Z}/n\\mathbb{Z})^\\times$, its order must divide $\\varphi(n)$, which implies $a^{\\varphi(n)} \\equiv 1 \\pmod n$.\n\nThe procedure for reducing an exponent $e$ modulo $\\varphi(n)$ is predicated entirely on Euler's theorem. If we wish to compute $a^e \\pmod n$, we can write $e = q\\varphi(n) + e'$, where $e' = e \\pmod{\\varphi(n)}$ and $q$ is an integer. The computation proceeds as:\n$$a^e = a^{q\\varphi(n) + e'} = (a^{\\varphi(n)})^q \\cdot a^{e'}$$\nIf $\\gcd(a,n)=1$, then $a^{\\varphi(n)} \\equiv 1 \\pmod{n}$, and we can substitute this into the equation:\n$$a^e \\equiv 1^q \\cdot a^{e'} \\equiv a^{e'} \\pmod{n}$$\nThis substitution is the critical step that justifies reducing the exponent.\n\nIn the given problem, $a=9$ and $n=45$. We compute the greatest common divisor:\n$$\\gcd(9, 45) = 9$$\nSince $\\gcd(9, 45) = 9 \\neq 1$, the integer $a=9$ is not relatively prime to the modulus $n=45$. Consequently, the congruence class $[9]_{45}$ is not an element of the multiplicative group of units $(\\mathbb{Z}/45\\mathbb{Z})^\\times$. Euler's totient theorem does not apply to this base $a$.\n\nThe premise for the exponent reduction, $a^{\\varphi(n)} \\equiv 1 \\pmod{n}$, is not guaranteed to hold. In fact, we can show it is false. We calculated $\\varphi(45)=24$. Let's compute $9^{24} \\pmod{45}$:\n$$9^{24} = 9^{16+8} = 9^{16} \\cdot 9^8 \\pmod{45}$$\nFrom our earlier work, $9^{16} \\equiv 36 \\pmod{45}$ and $9^8 \\equiv 36 \\pmod{45}$.\n$$9^{24} \\equiv 36 \\cdot 36 \\equiv 36 \\pmod{45}$$\nClearly, $9^{24} \\not\\equiv 1 \\pmod{45}$. The fundamental assumption required for the simplification fails. Therefore, the procedure of reducing the exponent $e=120$ to $e'=0$ modulo $\\varphi(45)=24$ is mathematically invalid. This explains why the result $r'=1$ obtained through this flawed method differs from the correct result $r=36$ obtained by direct computation.", "answer": "$$\\boxed{35}$$", "id": "3087438"}]}