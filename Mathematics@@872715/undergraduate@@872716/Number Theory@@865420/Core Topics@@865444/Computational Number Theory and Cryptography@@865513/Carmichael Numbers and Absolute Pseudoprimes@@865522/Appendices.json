{"hands_on_practices": [{"introduction": "To truly grasp the specific requirements for a Carmichael number, it's often helpful to examine a number that comes close but ultimately fails the test. This exercise focuses on $n=341$, a number famous for being a pseudoprime to base 2, and asks you to use Korselt's criterion to pinpoint exactly why it is not an absolute pseudoprime [@problem_id:3082766]. By finding the smallest base $a$ that reveals its composite nature, you will gain a practical understanding of the difference between a simple pseudoprime and a true Carmichael number.", "problem": "Let $n$ be a composite integer. A Carmichael number (also called an absolute pseudoprime) is a composite $n$ with the property that $a^{n-1} \\equiv 1 \\pmod{n}$ for every integer $a$ satisfying $\\gcd(a,n)=1$. Equivalently, by Korselt’s criterion, a composite integer $n$ is Carmichael if and only if $n$ is squarefree and, for every prime $p$ dividing $n$, one has $(p-1)\\mid(n-1)$.\n\nConsider $n=341$. Determine whether $n$ is a Carmichael number starting from the definitions above and standard results such as Fermat’s little theorem and basic properties of congruences. If $n$ is not Carmichael, explain precisely where Korselt’s criterion fails. Then identify the least integer $a \\ge 2$ with $\\gcd(a,341)=1$ for which $a^{340} \\not\\equiv 1 \\pmod{341}$, and compute $a^{340} \\bmod 341$ to explicitly demonstrate the failure.\n\nProvide as your final answer only the value of the least such $a$ (no words, no units).", "solution": "The problem requires us to determine if the integer $n=341$ is a Carmichael number, and if not, to find the smallest integer $a \\ge 2$ with $\\gcd(a,341)=1$ that violates the condition $a^{n-1} \\equiv 1 \\pmod{n}$. We will use Korselt's criterion, which states that a composite integer $n$ is a Carmichael number if and only if $n$ is square-free and for every prime $p$ dividing $n$, it holds that $(p-1) \\mid (n-1)$.\n\nFirst, we must determine the prime factorization of $n=341$. The integer $341$ is not divisible by $2$, $3$, or $5$. Testing subsequent primes, we find $341 = 11 \\times 31$. Both $11$ and $31$ are prime numbers. Since $341$ is a product of distinct primes, it is a composite number.\n\nWe now check the two conditions of Korselt's criterion for $n=341$.\n1.  **Square-free condition**: The prime factorization of $n$ is $341 = 11^1 \\times 31^1$. Since no prime factor appears with an exponent greater than $1$, $n$ is square-free. This condition is satisfied.\n\n2.  **Divisibility condition**: We must check if $(p-1) \\mid (n-1)$ for every prime factor $p$ of $n$. Here, $n-1 = 341 - 1 = 340$. The prime factors are $p_1=11$ and $p_2=31$.\n    -   For $p_1=11$, we check if $(p_1-1) \\mid (n-1)$, which is $10 \\mid 340$. Since $340 = 10 \\times 34$, this condition is satisfied.\n    -   For $p_2=31$, we check if $(p_2-1) \\mid (n-1)$, which is $30 \\mid 340$. Performing the division, we get $340 = 30 \\times 11 + 10$. Since the remainder is non-zero, $30$ does not divide $340$. This condition fails.\n\nSince one of the conditions of Korselt's criterion is not met, the integer $n=341$ is not a Carmichael number. The failure occurs because for the prime factor $p=31$, the quantity $p-1=30$ does not divide $n-1=340$.\n\nNext, we must find the least integer $a \\ge 2$ with $\\gcd(a,341)=1$ such that $a^{340} \\not\\equiv 1 \\pmod{341}$. By the Chinese Remainder Theorem, the congruence $a^{340} \\equiv 1 \\pmod{341}$ is equivalent to the system of congruences:\n$$\n\\begin{cases}\na^{340} \\equiv 1 \\pmod{11} \\\\\na^{340} \\equiv 1 \\pmod{31}\n\\end{cases}\n$$\nWe analyze each congruence for an integer $a$ such that $\\gcd(a,341)=1$, which implies $\\gcd(a,11)=1$ and $\\gcd(a,31)=1$.\n\nFor the first congruence, by Fermat's Little Theorem, $a^{10} \\equiv 1 \\pmod{11}$. Since $340 = 10 \\times 34$, we have:\n$$a^{340} = (a^{10})^{34} \\equiv 1^{34} \\equiv 1 \\pmod{11}$$\nThis congruence holds for any $a$ not divisible by $11$.\n\nFor the second congruence, by Fermat's Little Theorem, $a^{30} \\equiv 1 \\pmod{31}$. We write $340$ in terms of $30$: $340 = 30 \\times 11 + 10$. Thus:\n$$a^{340} = a^{30 \\times 11 + 10} = (a^{30})^{11} a^{10} \\equiv 1^{11} a^{10} \\equiv a^{10} \\pmod{31}$$\nSo, the condition $a^{340} \\equiv 1 \\pmod{31}$ is equivalent to $a^{10} \\equiv 1 \\pmod{31}$.\n\nThe overall congruence $a^{340} \\equiv 1 \\pmod{341}$ holds if and only if $a^{10} \\equiv 1 \\pmod{31}$. We are looking for the smallest integer $a \\ge 2$ with $\\gcd(a,341)=1$ for which this fails, i.e., $a^{10} \\not\\equiv 1 \\pmod{31}$. We test values of $a$ in increasing order.\n\n-   Let $a=2$. We have $\\gcd(2,341)=1$. We test $2^{10} \\pmod{31}$:\n    $2^5 = 32 \\equiv 1 \\pmod{31}$.\n    Therefore, $2^{10} = (2^5)^2 \\equiv 1^2 \\equiv 1 \\pmod{31}$.\n    The condition holds for $a=2$, so $2^{340} \\equiv 1 \\pmod{341}$. Thus $a=2$ is not the witness we seek. In fact, this shows that $341$ is a Fermat pseudoprime to base $2$.\n\n-   Let $a=3$. We have $\\gcd(3,341)=1$. We test $3^{10} \\pmod{31}$:\n    $3^1 = 3$\n    $3^2 = 9$\n    $3^3 = 27 \\equiv -4 \\pmod{31}$\n    $3^4 \\equiv 9 \\times 9 = 81 = 2 \\times 31 + 19 \\equiv 19 \\pmod{31}$\n    $3^5 = 3 \\times 19 = 57 = 1 \\times 31 + 26 \\equiv 26 \\equiv -5 \\pmod{31}$\n    $3^{10} = (3^5)^2 \\equiv (-5)^2 = 25 \\pmod{31}$.\n    Since $25 \\not\\equiv 1 \\pmod{31}$, the condition $a^{340} \\equiv 1 \\pmod{341}$ fails for $a=3$.\n    Therefore, the least integer $a \\ge 2$ satisfying the requirements is $a=3$.\n\nFinally, to explicitly demonstrate the failure, we compute $3^{340} \\bmod 341$. We need to solve the system:\n$$\n\\begin{cases}\nx \\equiv 3^{340} \\pmod{11} \\\\\nx \\equiv 3^{340} \\pmod{31}\n\\end{cases}\n$$\nFrom our previous analysis, we have:\n$3^{340} \\equiv 1 \\pmod{11}$.\n$3^{340} \\equiv 3^{10} \\equiv 25 \\pmod{31}$.\nSo we solve:\n$$\n\\begin{cases}\nx \\equiv 1 \\pmod{11} \\\\\nx \\equiv 25 \\pmod{31}\n\\end{cases}\n$$\nFrom the first congruence, $x = 11k+1$ for some integer $k$. Substituting this into the second congruence:\n$$11k+1 \\equiv 25 \\pmod{31}$$\n$$11k \\equiv 24 \\pmod{31}$$\nTo solve for $k$, we find the modular inverse of $11$ modulo $31$. Using the Extended Euclidean Algorithm: $1 = 5 \\cdot 31 - 14 \\cdot 11$. This implies $-14 \\cdot 11 \\equiv 1 \\pmod{31}$. Since $-14 \\equiv 17 \\pmod{31}$, the inverse of $11$ is $17$.\nMultiplying by $17$:\n$$k \\equiv 24 \\times 17 \\pmod{31}$$\n$$k \\equiv 408 \\pmod{31}$$\nSince $408 = 13 \\times 31 + 5$, we have $k \\equiv 5 \\pmod{31}$. The simplest integer solution is $k=5$.\nSubstituting back into the expression for $x$:\n$$x = 11(5) + 1 = 56$$\nSo, $3^{340} \\equiv 56 \\pmod{341}$. Since $56 \\not\\equiv 1 \\pmod{341}$, this explicitly demonstrates that $a=3$ is a witness to the fact that $341$ is not a Carmichael number.\n\nThe least integer $a \\ge 2$ with $\\gcd(a,341)=1$ for which the congruence fails is $3$.", "answer": "$$\n\\boxed{3}\n$$", "id": "3082766"}, {"introduction": "After analyzing a case of failure, let's apply our understanding to a positive example. This practice guides you through the verification of $n=8911$ as a Carmichael number by systematically checking the conditions of Korselt's criterion [@problem_id:3082779]. Successfully completing this check will solidify your understanding of the defining properties—being square-free and satisfying the divisibility condition for each prime factor—that characterize these elusive numbers.", "problem": "A positive integer $n$ is called a Carmichael number (also known as an absolute pseudoprime) if it is composite and satisfies a set of divisibility conditions on the exponents relative to each of its prime factors. Consider $n=8911$ with the given factorization $8911=7\\cdot 19\\cdot 67$. Without restating any characterization theorems in the problem statement, use the appropriate necessary and sufficient condition for Carmichael numbers to decide whether $n$ is a Carmichael number.\n\nDefine the indicator function $C(n)$ by $C(n)=1$ if $n$ is a Carmichael number and $C(n)=0$ otherwise. Compute $C(8911)$. Provide only the value of $C(8911)$ as your final answer. No rounding is necessary and no units are required.", "solution": "The problem requires us to determine if the integer $n=8911$ is a Carmichael number and, based on this determination, compute the value of the indicator function $C(8911)$. The problem provides the prime factorization of $n$ as $8911 = 7 \\cdot 19 \\cdot 67$.\n\nA composite number $n$ is a Carmichael number if and only if it satisfies Korselt's criterion. This criterion states two conditions:\n1. The number $n$ must be square-free, which means it is not divisible by the square of any prime number.\n2. For every prime factor $p$ of $n$, the divisibility relation $(p-1) | (n-1)$ must hold.\n\nWe will systematically verify these conditions for $n=8911$.\n\nFirst, we establish that $n$ is a composite number. The given factorization $n = 7 \\cdot 19 \\cdot 67$ shows that $n$ is a product of three distinct prime numbers. Since it has more than one prime factor, $n$ is composite.\n\nNext, we verify the first condition of Korselt's criterion: that $n$ must be square-free.\nThe prime factorization of $n$ is $7^1 \\cdot 19^1 \\cdot 67^1$. Each prime factor appears with an exponent of $1$. Therefore, $n$ is not divisible by the square of any prime. This means $n=8911$ is square-free, satisfying the first condition.\n\nNow, we verify the second condition of Korselt's criterion. We must check if $(p-1) | (n-1)$ for each prime factor $p$ of $n=8911$.\nThe value of $n-1$ is $8911 - 1 = 8910$.\nThe prime factors of $n$ are $p_1 = 7$, $p_2 = 19$, and $p_3 = 67$.\n\nFor the prime factor $p_1 = 7$:\nWe must check if $(p_1 - 1) | (n-1)$, which is $6 | 8910$.\nA number is divisible by $6$ if it is divisible by both $2$ and $3$.\nThe number $8910$ is even, so it is divisible by $2$.\nThe sum of the digits of $8910$ is $8+9+1+0 = 18$. Since $18$ is divisible by $3$, the number $8910$ is divisible by $3$.\nBecause $8910$ is divisible by both $2$ and $3$, it is divisible by $6$. The calculation confirms this: $8910 \\div 6 = 1485$.\nThus, the condition holds for $p_1 = 7$.\n\nFor the prime factor $p_2 = 19$:\nWe must check if $(p_2 - 1) | (n-1)$, which is $18 | 8910$.\nA number is divisible by $18$ if it is divisible by both $2$ and $9$.\nWe already know $8910$ is divisible by $2$.\nThe sum of the digits of $8910$ is $18$. Since $18$ is divisible by $9$, the number $8910$ is divisible by $9$.\nBecause $8910$ is divisible by both $2$ and $9$, it is divisible by $18$. The calculation confirms this: $8910 \\div 18 = 495$.\nThus, the condition holds for $p_2 = 19$.\n\nFor the prime factor $p_3 = 67$:\nWe must check if $(p_3 - 1) | (n-1)$, which is $66 | 8910$.\nA number is divisible by $66$ if it is divisible by both $6$ and $11$, as $\\gcd(6, 11)=1$.\nWe have already shown that $8910$ is divisible by $6$.\nTo check for divisibility by $11$, we compute the alternating sum of the digits of $8910$: $0 - 1 + 9 - 8 = 0$. Since the result is $0$, which is divisible by $11$, the number $8910$ is divisible by $11$.\nBecause $8910$ is divisible by both $6$ and $11$, it is divisible by $66$. The calculation confirms this: $8910 \\div 66 = 135$.\nThus, the condition holds for $p_3 = 67$.\n\nSince $n=8911$ is a composite, square-free number, and for all its prime factors $p$, the condition $(p-1) | (n-1)$ is satisfied, we conclude that $n=8911$ is a Carmichael number.\n\nThe problem defines the indicator function $C(n)$ as $C(n)=1$ if $n$ is a Carmichael number and $C(n)=0$ otherwise. As we have demonstrated that $8911$ is a Carmichael number, the value of the indicator function is $C(8911)=1$.", "answer": "$$\\boxed{1}$$", "id": "3082779"}, {"introduction": "Carmichael numbers are significant because they expose the limitations of the Fermat primality test. This final practice explores this crucial point by focusing on $n=561$, the smallest Carmichael number. You will see how, despite fooling the Fermat test for every valid base, its composite nature is revealed by the more powerful strong probable prime (Miller-Rabin) test, demonstrating why such advanced algorithms are essential in modern number theory and cryptography [@problem_id:3082805].", "problem": "Let $n=561$. Recall the following standard notions.\n- A composite integer $n$ is a Carmichael number if for every integer $a$ with $\\gcd(a,n)=1$, one has $a^{n-1}\\equiv 1 \\pmod{n}$.\n- For an odd integer $n1$, write $n-1=2^{s}d$ with $d$ odd. For an integer $a$ with $\\gcd(a,n)=1$, the number $n$ is called a strong probable prime to base $a$ if either $a^{d}\\equiv 1 \\pmod{n}$ or there exists an integer $r$ with $0\\le rs$ such that $a^{2^{r}d}\\equiv -1 \\pmod{n}$.\n\nUsing only these definitions and standard properties of modular arithmetic (including the Chinese Remainder Theorem), determine the smallest integer base $a$ with $2\\le a\\le 100$ and $\\gcd(a,561)=1$ for which $n=561$ fails the strong probable prime test to base $a$. In other words, find the least such $a$ for which $a^{d}\\not\\equiv 1 \\pmod{561}$ and $a^{2^{r}d}\\not\\equiv -1 \\pmod{561}$ for every integer $r$ with $0\\le rs$, where $561-1=2^{s}d$ with $d$ odd.\n\nAdditionally, to underscore the increased strength over Fermat’s test, verify for your chosen base $a$ that $a^{560}\\equiv 1 \\pmod{561}$.\n\nYour final answer should be the single integer $a$. No rounding is required.", "solution": "The problem requires finding the smallest integer base $a$ in the range $2 \\le a \\le 100$ with $\\gcd(a, 561)=1$ for which $n=561$ fails the strong probable prime test.\n\nFirst, we analyze the given number $n=561$ and determine the parameters for the strong probable prime test. The prime factorization of $n$ is $561 = 3 \\times 11 \\times 17$. This confirms that $n$ is a composite number.\n\nThe test requires writing $n-1$ in the form $2^s d$, where $d$ is an odd integer.\nWe have $n-1 = 561-1 = 560$.\nFactoring $560$ into powers of $2$ and an odd part, we get $560 = 16 \\times 35 = 2^4 \\times 35$.\nThus, we have $s=4$ and $d=35$.\n\nAccording to the definition provided, $n$ is a strong probable prime to base $a$ if either:\n1. $a^d \\equiv 1 \\pmod{n}$\n2. There exists an integer $r$ with $0 \\le r  s$ such that $a^{2^r d} \\equiv -1 \\pmod{n}$.\n\nFor our specific case, with $n=561$, $d=35$, and $s=4$, the number $561$ is a strong probable prime to base $a$ if either $a^{35} \\equiv 1 \\pmod{561}$ or if $a^{35 \\cdot 2^r} \\equiv -1 \\pmod{561}$ for some $r \\in \\{0, 1, 2, 3\\}$.\n\nWe are looking for the smallest integer $a \\ge 2$ for which $n=561$ *fails* this test. A failure occurs if *both* of the following conditions are met:\n1. $a^{35} \\not\\equiv 1 \\pmod{561}$\n2. $a^{35 \\cdot 2^r} \\not\\equiv -1 \\pmod{561}$ for all $r \\in \\{0, 1, 2, 3\\}$.\n\nWe must search for the smallest integer $a$ in the specified range, starting from $a=2$.\n\nLet's test $a=2$. First, we check the precondition $\\gcd(a, n)=1$.\n$\\gcd(2, 561) = \\gcd(2, 3 \\times 11 \\times 17) = 1$, since $561$ is odd. Thus, $a=2$ is a valid base for the test.\n\nNow, we perform the strong probable prime test for $n=561$ and base $a=2$. We need to compute the sequence of values $2^{35}$, $2^{70}$, $2^{140}$, and $2^{280}$ modulo $561$. We will use the Chinese Remainder Theorem (CRT) for these computations, working modulo the prime factors $3$, $11$, and $17$.\n\nCalculation of $2^{35} \\pmod{561}$:\nLet $x \\equiv 2^{35} \\pmod{561}$. This is equivalent to the system of congruences:\n- $x \\equiv 2^{35} \\pmod{3}$. Since $2 \\equiv -1 \\pmod{3}$, we have $2^{35} \\equiv (-1)^{35} \\equiv -1 \\equiv 2 \\pmod{3}$.\n- $x \\equiv 2^{35} \\pmod{11}$. By Fermat's Little Theorem, $2^{10} \\equiv 1 \\pmod{11}$. So, $2^{35} = (2^{10})^3 \\cdot 2^5 \\equiv 1^3 \\cdot 32 \\equiv 32 \\equiv 10 \\pmod{11}$.\n- $x \\equiv 2^{35} \\pmod{17}$. By Fermat's Little Theorem, $2^{16} \\equiv 1 \\pmod{17}$. So, $2^{35} = (2^{16})^2 \\cdot 2^3 \\equiv 1^2 \\cdot 8 \\equiv 8 \\pmod{17}$.\n\nWe need to solve the system:\n$x \\equiv 2 \\pmod{3}$\n$x \\equiv 10 \\pmod{11}$\n$x \\equiv 8 \\pmod{17}$\n\nFrom $x \\equiv 10 \\pmod{11}$, we can write $x = 11k + 10$ for some integer $k$.\nSubstituting this into the first congruence: $11k + 10 \\equiv 2 \\pmod{3} \\implies 2k + 1 \\equiv 2 \\pmod{3} \\implies 2k \\equiv 1 \\pmod{3}$. Multiplying by $2$, we get $4k \\equiv 2 \\pmod{3} \\implies k \\equiv 2 \\pmod{3}$. So, $k = 3j+2$ for some integer $j$.\nSubstituting back: $x = 11(3j+2) + 10 = 33j + 22 + 10 = 33j + 32$.\nNow, using the third congruence: $33j + 32 \\equiv 8 \\pmod{17} \\implies -j - 2 \\equiv 8 \\pmod{17} \\implies -j \\equiv 10 \\pmod{17} \\implies j \\equiv -10 \\equiv 7 \\pmod{17}$. So, $j = 17m+7$ for some integer $m$.\nFinally, $x = 33(17m+7) + 32 = 561m + 231 + 32 = 561m + 263$.\nThus, $2^{35} \\equiv 263 \\pmod{561}$.\n\nNow we check the conditions for test failure for $a=2$:\n1. Is $a^d \\equiv 1 \\pmod n$? We have $2^{35} \\equiv 263 \\pmod{561}$. This is not $1$. So the first condition for failure is met.\n2. We now check the sequence $a^{d \\cdot 2^r} \\pmod n$ for $r \\in \\{0, 1, 2, 3\\}$.\n- For $r=0$: $2^{35} \\equiv 263 \\pmod{561}$. This is not $-1 \\pmod{561}$ (as $-1 \\equiv 560$).\n- For $r=1$: $2^{70} = (2^{35})^2 \\equiv 263^2 = 69169 \\pmod{561}$.\n$69169 = 123 \\times 561 + 166$. So, $2^{70} \\equiv 166 \\pmod{561}$. This is not $-1 \\pmod{561}$.\n- For $r=2$: $2^{140} = (2^{70})^2 \\equiv 166^2 = 27556 \\pmod{561}$.\n$27556 = 49 \\times 561 + 67$. So, $2^{140} \\equiv 67 \\pmod{561}$. This is not $-1 \\pmod{561}$.\n- For $r=3$: $2^{280} = (2^{140})^2 \\equiv 67^2 = 4489 \\pmod{561}$.\n$4489 = 8 \\times 561 + 1$. So, $2^{280} \\equiv 1 \\pmod{561}$. This is not $-1 \\pmod{561}$.\n\nThe sequence of values $\\{a^d, a^{2d}, a^{4d}, a^{8d}\\}$ modulo $561$ is $\\{263, 166, 67, 1\\}$.\nNone of these values is congruent to $-1 \\pmod{561}$, and the first term $a^d$ is not congruent to $1 \\pmod{561}$. Therefore, $n=561$ fails the strong probable prime test for the base $a=2$.\n\nSince we are seeking the smallest such integer $a \\ge 2$, and we have found that $a=2$ meets the criteria, $2$ is the answer.\n\nFinally, we perform the additional verification required by the problem: for our chosen base $a=2$, we must verify that $a^{560} \\equiv 1 \\pmod{561}$.\nWe have $a^{n-1} = 2^{560}$.\nThe exponent is $560 = 2 \\times 280$. Using our previous calculation:\n$2^{560} = (2^{280})^2 \\equiv 1^2 \\equiv 1 \\pmod{561}$.\nThe verification holds. This result is expected because $n=561$ is a Carmichael number. By definition, for any integer $a$ with $\\gcd(a, n)=1$, the congruence $a^{n-1} \\equiv 1 \\pmod{n}$ is satisfied. The problem demonstrates that while $n=561$ passes Fermat's test for base $2$, it fails the stronger Miller-Rabin test, which correctly reveals its composite nature.\n\nThe smallest integer base $a$ for which $n=561$ fails the strong probable prime test is $2$.", "answer": "$$\\boxed{2}$$", "id": "3082805"}]}