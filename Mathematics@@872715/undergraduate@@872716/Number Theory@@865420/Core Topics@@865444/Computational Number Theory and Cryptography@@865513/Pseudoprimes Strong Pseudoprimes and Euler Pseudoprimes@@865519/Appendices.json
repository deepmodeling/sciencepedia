{"hands_on_practices": [{"introduction": "Fermat's Little Theorem, which states that $a^{p-1} \\equiv 1 \\pmod{p}$ for a prime $p$ not dividing $a$, provides a powerful initial test for primality. However, some composite numbers, known as Fermat pseudoprimes, also satisfy this congruence, making them 'impostors' that can fool the test. This first exercise challenges you to find the smallest composite number $n$ that satisfies $2^{n-1} \\equiv 1 \\pmod{n}$, a foundational task that requires a systematic search using tools like the Chinese Remainder Theorem and the concept of multiplicative order. [@problem_id:3088873]", "problem": "Let $a$ be an integer with $a \\geq 2$. A composite integer $n$ is called a Fermat pseudoprime to base $a$ if $a^{n-1} \\equiv 1 \\pmod{n}$. For base $a = 2$, determine the smallest composite integer $n$ that satisfies $2^{n-1} \\equiv 1 \\pmod{n}$. Your reasoning must begin from the following foundational facts: Fermat’s little theorem, the concept of multiplicative order in the multiplicative group of units modulo a prime power, and the Chinese remainder theorem. You must justify why no smaller composite $n$ can satisfy the defining congruence by using order divisibility constraints at prime and prime-power moduli, and you must explicitly compute $2^{n-1} \\bmod n$ to verify the pseudoprime property of your candidate.\n\nInstructions and requirements:\n- Use the definition of multiplicative order $\\operatorname{ord}_m(2)$, namely the least positive integer $t$ such that $2^t \\equiv 1 \\pmod{m}$ when $\\gcd(2,m)=1$.\n- Argue why any such $n$ must be odd and, for all candidates below your final $n$, eliminate the possibilities systematically by combining the order constraints modulo each prime divisor with the Chinese remainder theorem.\n- When a prime square $p^2$ divides a candidate $n$, use order considerations modulo $p^2$ to determine whether this can occur for base $2$ in the size range relevant to the search.\n- After determining the smallest such composite $n$, verify $2^{n-1} \\bmod n$ by explicit congruence computations.\n- Express the final answer as the value of $n$ only. No rounding is required, and no units apply.", "solution": "The problem asks for the smallest composite integer $n$ that satisfies the congruence $2^{n-1} \\equiv 1 \\pmod{n}$. Such an integer is known as a Fermat pseudoprime to base $2$. Our solution will be developed from foundational principles of number theory, including Fermat's little theorem, the concept of multiplicative order, and the Chinese remainder theorem, as required.\n\nFirst, we establish that any such integer $n$ must be odd.\nLet $n$ be a composite number satisfying $2^{n-1} \\equiv 1 \\pmod{n}$. This congruence implies that $n$ must divide $2^{n-1} - 1$. If $n$ were an even number, then $2$ would be a divisor of $n$. Consequently, $2$ would have to divide $2^{n-1} - 1$. However, for any integer $n \\ge 2$, $n-1 \\ge 1$, which means $2^{n-1}$ is an even integer, and thus $2^{n-1}-1$ is an odd integer. An odd integer is not divisible by $2$. This is a contradiction. Therefore, any candidate for $n$ must be an odd composite integer.\n\nThe core of the problem is the condition $2^{n-1} \\equiv 1 \\pmod n$. Let the prime factorization of $n$ be $n = p_1^{k_1} p_2^{k_2} \\cdots p_r^{k_r}$. By the Chinese remainder theorem, the congruence $2^{n-1} \\equiv 1 \\pmod n$ is equivalent to the system of congruences $2^{n-1} \\equiv 1 \\pmod{p_i^{k_i}}$ for each $i \\in \\{1, 2, \\dots, r\\}$.\nThis condition, in turn, is equivalent to requiring that the multiplicative order of $2$ modulo each prime power factor $p_i^{k_i}$, denoted $\\operatorname{ord}_{p_i^{k_i}}(2)$, must divide the exponent $n-1$. That is, $\\operatorname{ord}_{p_i^{k_i}}(2) \\mid (n-1)$ for all $i$.\n\nWe now conduct a systematic search for the smallest odd composite $n$, eliminating candidates by applying these order divisibility constraints. We categorize candidates by their prime factorization structure.\n\nCase 1: $n$ is a power of a single prime, $n = p^k$ with $k \\ge 2$.\nFor $n=p^k$ to be a pseudoprime, we require $\\operatorname{ord}_{p^k}(2) \\mid (p^k - 1)$.\nFor an odd prime $p$, the order $\\operatorname{ord}_{p^k}(2)$ is related to $\\operatorname{ord}_p(2)$. A standard result from the theory of orders (related to the lifting-the-exponent lemma) states that if $p$ is an odd prime such that $2^{\\operatorname{ord}_p(2)} \\not\\equiv 1 \\pmod{p^2}$, then $\\operatorname{ord}_{p^k}(2) = p^{k-1} \\operatorname{ord}_p(2)$. Primes $p$ for which $2^{p-1} \\equiv 1 \\pmod{p^2}$ are called Wieferich primes; the only known ones are $1093$ and $3511$. For any prime $p  1093$, we can assume $2^{p-1} \\not\\equiv 1 \\pmod{p^2}$. This simplifies the analysis for small $n$.\nSpecifically, if $p$ is not a Wieferich prime, then for $k \\ge 2$, $\\operatorname{ord}_{p^k}(2)$ is a multiple of $p$.\nSo, for $n=p^k$ to be a pseudoprime, we would need $p \\mid \\operatorname{ord}_{p^k}(2)$, which would imply $p \\mid (p^k-1)$. But $p^k-1 \\equiv -1 \\pmod p$, so $p$ does not divide $p^k-1$. This is a contradiction.\nTherefore, no power $p^k$ (with $k \\ge 2$) of a non-Wieferich prime $p$ can be a Fermat pseudoprime to base $2$. Since the smallest odd composite numbers that are prime powers are $9=3^2$, $25=5^2$, $27=3^3$, $49=7^2$, etc., and all primes involved are less than $1093$, none of these can be pseudoprimes to base $2$. For instance, for $n=9=3^2$, $\\operatorname{ord}_9(2)=6$. We require $6 \\mid (9-1)=8$, which is false. For $n=25=5^2$, $\\operatorname{ord}_{25}(2)=20$. We require $20 \\mid (25-1)=24$, which is false.\n\nCase 2: $n$ is a product of two distinct primes, $n = pq$ with $p  q$.\nThe condition $2^{n-1} \\equiv 1 \\pmod n$ becomes $\\operatorname{ord}_p(2) \\mid (pq-1)$ and $\\operatorname{ord}_q(2) \\mid (pq-1)$.\nUsing the fact that $\\operatorname{ord}_p(2) \\mid (p-1)$ from Fermat's little theorem, and that $pq-1 = q(p-1) + (q-1)$, the condition $\\operatorname{ord}_p(2) \\mid (pq-1)$ simplifies to $\\operatorname{ord}_p(2) \\mid (q-1)$.\nSymmetrically, $\\operatorname{ord}_q(2) \\mid (p-1)$.\nWe test odd composite numbers of this form:\n- $n=15=3 \\times 5$: $p=3, q=5$. We need $\\operatorname{ord}_5(2) \\mid (3-1)=2$. But $\\operatorname{ord}_5(2)=4$, and $4 \\nmid 2$. Fails.\n- $n=21=3 \\times 7$: $p=3, q=7$. We need $\\operatorname{ord}_7(2) \\mid (3-1)=2$. But $\\operatorname{ord}_7(2)=3$, and $3 \\nmid 2$. Fails.\n- $n=33=3 \\times 11$: $p=3, q=11$. We need $\\operatorname{ord}_{11}(2) \\mid (3-1)=2$. But $\\operatorname{ord}_{11}(2)=10$, and $10 \\nmid 2$. Fails.\n- $n=35=5 \\times 7$: $p=5, q=7$. We need $\\operatorname{ord}_5(2) \\mid (7-1)=6$. $\\operatorname{ord}_5(2)=4$, and $4 \\mid 6$ is false. Fails.\nSystematic investigation of all products $n=pq  341$ shows they all fail these conditions. For instance, $51, 57, 69, \\dots$ fail because $p=3$ requires $\\operatorname{ord}_q(2) \\mid 2$, which implies $q=3$, contradicting $pq$. Other examples: $n=65=5 \\times 13$ fails as $\\operatorname{ord}_{13}(2)=12 \\nmid (5-1)=4$. $n=91=7 \\times 13$ fails as $\\operatorname{ord}_{13}(2)=12 \\nmid (7-1)=6$. This continues for all such composites.\n\nCase 3: $n$ has three or more distinct prime factors.\nThe smallest such number is $n = 3 \\times 5 \\times 7 = 105$. The condition is $2^{104} \\equiv 1 \\pmod{105}$. This requires $\\operatorname{ord}_3(2) \\mid 104$, $\\operatorname{ord}_5(2) \\mid 104$, and $\\operatorname{ord}_7(2) \\mid 104$.\n- $\\operatorname{ord}_3(2)=2$, and $2 \\mid 104$. (Holds)\n- $\\operatorname{ord}_5(2)=4$, and $4 \\mid 104$. (Holds)\n- $\\operatorname{ord}_7(2)=3$, but $3 \\nmid 104$ (since the sum of digits $1+0+4=5$ is not divisible by $3$). Fails.\nThe next such number is $n=3 \\times 5 \\times 11=165$. We require $2^{164} \\equiv 1 \\pmod{165}$. This requires $\\operatorname{ord}_{11}(2)=10 \\mid 164$, which is false.\n\nCase 4: $n$ is not square-free and has multiple prime factors.\nSmallest is $n=45=3^2 \\times 5$. Requires $2^{44} \\equiv 1 \\pmod 9$ and $2^{44} \\equiv 1 \\pmod 5$.\nThe first congruence requires $\\operatorname{ord}_9(2) \\mid 44$. We know $\\operatorname{ord}_9(2)=6$, and $6 \\nmid 44$. Fails.\nNext is $n=63=3^2 \\times 7$. Requires $\\operatorname{ord}_9(2) \\mid 62$. $6 \\nmid 62$. Fails.\nA thorough check of all odd composite integers up to $340$ confirms that none satisfy the pseudoprime condition.\n\nNow, we test the number $n=341$.\n$n = 341 = 11 \\times 31$. This is a composite number of the form $pq$ with $p=11, q=31$. We apply our derived conditions:\n1. $\\operatorname{ord}_p(2) \\mid (q-1)$: We need $\\operatorname{ord}_{11}(2) \\mid (31-1)=30$. The powers of $2$ modulo $11$ are $2, 4, 8, 5, 10(-1), \\dots$. The order is $\\operatorname{ord}_{11}(2)=10$. Since $10 \\mid 30$, this condition holds.\n2. $\\operatorname{ord}_q(2) \\mid (p-1)$: We need $\\operatorname{ord}_{31}(2) \\mid (11-1)=10$. The powers of $2$ modulo $31$ are $2, 4, 8, 16, 32 \\equiv 1$. The order is $\\operatorname{ord}_{31}(2)=5$. Since $5 \\mid 10$, this condition also holds.\nSince both divisibility conditions are met, $n=341$ is indeed a Fermat pseudoprime to base $2$.\n\nFinally, as required, we explicitly verify the congruence $2^{340} \\equiv 1 \\pmod{341}$.\nUsing the Chinese Remainder Theorem, we verify the congruence modulo its prime factors, $11$ and $31$.\n- Modulo $11$: By Fermat's little theorem, $2^{10} \\equiv 1 \\pmod{11}$. Then $2^{340} = (2^{10})^{34} \\equiv 1^{34} \\equiv 1 \\pmod{11}$.\n- Modulo $31$: We found $\\operatorname{ord}_{31}(2)=5$. Then $2^{340} = (2^5)^{68} \\equiv 1^{68} \\equiv 1 \\pmod{31}$.\nSince $2^{340}-1$ is divisible by both $11$ and $31$, and since $\\gcd(11, 31)=1$, it must be divisible by their product $341$. Thus, $2^{340} \\equiv 1 \\pmod{341}$.\n\nOur systematic elimination of all smaller odd composite integers ($9, 15, 21, 25, \\dots, 339$) shows that $341$ is the smallest such integer.", "answer": "$$\n\\boxed{341}\n$$", "id": "3088873"}, {"introduction": "While the Fermat test is a good first step, its fallibility motivates the search for more discerning criteria. Euler's criterion offers such a refinement, leading to the definition of Euler pseudoprimes, which must satisfy the stricter congruence $a^{(n-1)/2} \\equiv (\\frac{a}{n}) \\pmod{n}$. This practice builds directly on the previous one by asking you to determine the smallest composite number that passes this more rigorous test for base 2, demonstrating how we can filter out some of the 'impostors' identified by the simpler Fermat test. [@problem_id:3088835]", "problem": "Let $n$ be an odd composite integer with $\\gcd(2,n)=1$. The Jacobi symbol $(\\frac{a}{n})$ for odd $n$ is defined by factorizing $n=\\prod_{i} p_{i}^{e_{i}}$ into odd primes and setting $(\\frac{a}{n})=\\prod_{i} (\\frac{a}{p_{i}})^{e_{i}}$, where $(\\frac{a}{p})$ is the Legendre symbol modulo an odd prime $p$. Recall the following two well-tested facts: for any odd prime $p$, Euler’s criterion gives $a^{\\frac{p-1}{2}} \\equiv \\left(\\frac{a}{p}\\right) \\pmod{p}$, and specifically for $a=2$ one has $\\left(\\frac{2}{p}\\right)=(-1)^{\\frac{p^{2}-1}{8}}$. An odd composite $n$ with $\\gcd(2,n)=1$ is called an Euler pseudoprime to base $2$ if \n$$\n2^{\\frac{n-1}{2}} \\equiv \\left(\\frac{2}{n}\\right) \\pmod{n}.\n$$\nDetermine the smallest Euler pseudoprime to base $2$. Your justification must explicitly compute the Jacobi symbol $\\left(\\frac{2}{n}\\right)$ using prime factorization and the parity formula $\\left(\\frac{2}{p}\\right)=(-1)^{\\frac{p^{2}-1}{8}}$, and must verify the congruence $2^{\\frac{n-1}{2}} \\bmod n$ via modular exponentiation and the Chinese Remainder Theorem (CRT). Express your final answer as the integer $n$. No rounding is necessary.", "solution": "We begin from the definition: an odd composite integer $n$ with $\\gcd(2,n)=1$ is an Euler pseudoprime to base $2$ if and only if\n$$\n2^{\\frac{n-1}{2}} \\equiv \\left(\\frac{2}{n}\\right) \\pmod{n}.\n$$\nLet $s \\equiv 2^{\\frac{n-1}{2}} \\pmod{n}$. Since $\\left(\\frac{2}{n}\\right) \\in \\{-1,1\\}$, the defining congruence implies $s \\equiv \\pm 1 \\pmod{n}$. Squaring both sides yields\n$$\n2^{n-1} \\equiv s^{2} \\equiv 1 \\pmod{n}.\n$$\nTherefore, any Euler pseudoprime to base $2$ must also satisfy $2^{n-1} \\equiv 1 \\pmod{n}$, that is, it must be a base-$2$ Fermat pseudoprime (also called a Poulet number).\n\nWe will test the smallest base-$2$ Fermat pseudoprimes as candidates. It is a well-tested fact that the smallest base-$2$ Fermat pseudoprimes are $341$ and $561$; thus, any smaller Euler pseudoprime must be among these. We will show that $341$ fails the Euler condition while $561$ satisfies it, hence $561$ is the smallest Euler pseudoprime to base $2$.\n\nFirst candidate $n=341=11 \\cdot 31$. Compute the Jacobi symbol $\\left(\\frac{2}{341}\\right)$ via prime factorization:\n$$\n\\left(\\frac{2}{341}\\right) = \\left(\\frac{2}{11}\\right)\\left(\\frac{2}{31}\\right).\n$$\nUsing $\\left(\\frac{2}{p}\\right) = (-1)^{\\frac{p^{2}-1}{8}}$, we have for $p=11$,\n$$\n\\frac{11^{2}-1}{8} = \\frac{121-1}{8} = \\frac{120}{8} = 15 \\quad \\Rightarrow \\quad \\left(\\frac{2}{11}\\right) = (-1)^{15} = -1,\n$$\nand for $p=31$,\n$$\n\\frac{31^{2}-1}{8} = \\frac{961-1}{8} = \\frac{960}{8} = 120 \\quad \\Rightarrow \\quad \\left(\\frac{2}{31}\\right) = (-1)^{120} = 1.\n$$\nHence $\\left(\\frac{2}{341}\\right) = (-1)(1) = -1$.\n\nNow evaluate $2^{\\frac{341-1}{2}} = 2^{170} \\bmod 341$ using the Chinese Remainder Theorem (CRT). This reduces to checking modulo $11$ and modulo $31$:\n- Modulo $11$: By Fermat’s little theorem, $2^{10} \\equiv 1 \\pmod{11}$. Therefore $2^{170} = (2^{10})^{17} \\equiv 1^{17} \\equiv 1 \\pmod{11}$.\n- Modulo $31$: Similarly, $2^{5} = 32 \\equiv 1 \\pmod{31}$, so the order of $2$ modulo $31$ divides $5$. Consequently $2^{170} = (2^{5})^{34} \\equiv 1^{34} \\equiv 1 \\pmod{31}$.\n\nThus $2^{170} \\equiv 1 \\pmod{11}$ and $2^{170} \\equiv 1 \\pmod{31}$, hence $2^{170} \\equiv 1 \\pmod{341}$ by the Chinese Remainder Theorem. This contradicts the required Euler congruence $2^{170} \\equiv \\left(\\frac{2}{341}\\right) = -1 \\pmod{341}$. Therefore, $341$ is not an Euler pseudoprime to base $2$.\n\nSecond candidate $n=561=3 \\cdot 11 \\cdot 17$. Compute the Jacobi symbol:\n$$\n\\left(\\frac{2}{561}\\right) = \\left(\\frac{2}{3}\\right)\\left(\\frac{2}{11}\\right)\\left(\\frac{2}{17}\\right).\n$$\nEvaluate each factor with $\\left(\\frac{2}{p}\\right) = (-1)^{\\frac{p^{2}-1}{8}}$:\n- For $p=3$: $\\frac{3^{2}-1}{8} = \\frac{9-1}{8} = 1$, so $\\left(\\frac{2}{3}\\right) = (-1)^{1} = -1$.\n- For $p=11$: As above, $\\left(\\frac{2}{11}\\right) = -1$.\n- For $p=17$: $\\frac{17^{2}-1}{8} = \\frac{289-1}{8} = \\frac{288}{8} = 36$, so $\\left(\\frac{2}{17}\\right) = (-1)^{36} = 1$.\n\nTherefore,\n$$\n\\left(\\frac{2}{561}\\right) = (-1)(-1)(1) = 1.\n$$\n\nNext compute $2^{\\frac{561-1}{2}} = 2^{280} \\bmod 561$ using CRT. Reduce modulo each prime factor:\n- Modulo $3$: $2 \\equiv -1 \\pmod{3}$, so $2^{280} \\equiv (-1)^{280} \\equiv 1 \\pmod{3}$.\n- Modulo $11$: $2^{10} \\equiv 1 \\pmod{11}$, and $280$ is divisible by $10$, hence $2^{280} \\equiv 1 \\pmod{11}$.\n- Modulo $17$: Note that $2^{4} = 16 \\equiv -1 \\pmod{17}$, so $2^{8} \\equiv 1 \\pmod{17}$. Since $280$ is divisible by $8$ (indeed $280 = 8 \\cdot 35$), we have $2^{280} \\equiv 1 \\pmod{17}$.\n\nCombining these congruences via the Chinese Remainder Theorem, we obtain\n$$\n2^{280} \\equiv 1 \\pmod{561}.\n$$\nSince $\\left(\\frac{2}{561}\\right) = 1$, the Euler pseudoprime congruence\n$$\n2^{\\frac{561-1}{2}} \\equiv \\left(\\frac{2}{561}\\right) \\pmod{561}\n$$\nholds. Because $341$ is the only smaller base-$2$ Fermat pseudoprime and it fails the Euler condition, and any Euler pseudoprime to base $2$ must be a base-$2$ Fermat pseudoprime, it follows that $561$ is the smallest Euler pseudoprime to base $2$.\n\nTherefore, the smallest Euler pseudoprime to base $2$ is $561$.", "answer": "$$\\boxed{561}$$", "id": "3088835"}, {"introduction": "The existence of Euler pseudoprimes shows that we can still strengthen our primality tests. The Miller-Rabin test, a cornerstone of modern computational number theory, provides a highly effective probabilistic method based on the concept of strong pseudoprimes. In this culminating exercise, you will apply the Miller-Rabin criteria to find the smallest strong pseudoprime to base 2, witnessing firsthand the dramatic increase in the test's reliability by seeing how much larger a number must be to pass it. [@problem_id:3088867]", "problem": "Let $n$ be an odd composite integer and write $n-1=2^{s} d$ with $d$ odd. By definition, $n$ is a strong pseudoprime to base $a$ if either $a^{d}\\equiv 1 \\pmod{n}$ or there exists an integer $r$ with $0\\le r\\le s-1$ such that $a^{2^{r} d}\\equiv -1 \\pmod{n}$. The Miller–Rabin primality test to base $a$ declares $n$ “probably prime” precisely when this strong pseudoprime condition holds for base $a$.\n\nUsing only the fundamental definitions above, determine the smallest strong pseudoprime to base $2$. Justify minimality by noting that any strong pseudoprime to base $2$ must be a Fermat pseudoprime to base $2$ (that is, must satisfy $2^{n-1}\\equiv 1 \\pmod{n}$), and then checking the Miller–Rabin chain for each odd base-$2$ Fermat pseudoprime below your candidate. You may use that the complete list of odd base-$2$ Fermat pseudoprimes less than $2050$ is $\\{341,561,645,1105,1387,1729,1905,2047\\}$.\n\nConfirm your final candidate by explicitly exhibiting the Miller–Rabin chain starting with $x_{0}\\equiv 2^{d}\\pmod{n}$ and iterating $x_{r+1}\\equiv x_{r}^{2}\\pmod{n}$ for $r=0,1,\\dots,s-1$.\n\nYour final answer must be the integer $n$ only. No rounding is required.", "solution": "The problem asks for the smallest strong pseudoprime to base $2$. We are given that any strong pseudoprime to a base $a$ must also be a Fermat pseudoprime to base $a$. A number $n$ is a Fermat pseudoprime to base $a$ if it is a composite number such that $a^{n-1} \\equiv 1 \\pmod{n}$. This implies that the smallest strong pseudoprime to base $2$ must be present in the provided list of the smallest odd Fermat pseudoprimes to base $2$: $\\{341, 561, 645, 1105, 1387, 1729, 1905, 2047\\}$. We will test each of these composite numbers, in increasing order, against the definition of a strong pseudoprime.\n\nAn odd composite integer $n$ is a strong pseudoprime to base $a$ if, with $n-1 = 2^s d$ where $d$ is odd, one of the following conditions holds:\n1. $a^d \\equiv 1 \\pmod{n}$\n2. $a^{2^r d} \\equiv -1 \\pmod{n}$ for some integer $r$ in the range $0 \\le r \\le s-1$.\n\nThe sequence of values $x_r \\equiv a^{2^r d} \\pmod{n}$ for $r=0, 1, \\dots, s-1$ is the Miller-Rabin chain. The test passes if $x_0 \\equiv 1 \\pmod n$ or if any $x_r \\equiv -1 \\pmod n$.\n\nLet's test the candidates with base $a=2$:\n\n1.  For $n=341$:\n    $n=341 = 11 \\times 31$ is composite.\n    $n-1 = 340 = 4 \\times 85 = 2^2 \\times 85$. Thus, $s=2$ and $d=85$.\n    We compute the Miller-Rabin chain for $r=0, 1$:\n    $x_0 \\equiv 2^d \\pmod{n} \\equiv 2^{85} \\pmod{341}$.\n    Since $2^{10} = 1024 = 3 \\times 341 + 1 \\equiv 1 \\pmod{341}$, we have $2^{85} = 2^{10 \\times 8 + 5} = (2^{10})^8 \\times 2^5 \\equiv 1^8 \\times 32 \\equiv 32 \\pmod{341}$.\n    $x_0 \\equiv 32 \\not\\equiv 1 \\pmod{341}$ and $x_0 \\not\\equiv -1 \\pmod{341}$.\n    $x_1 \\equiv x_0^2 \\pmod{n} \\equiv 32^2 = 1024 \\equiv 1 \\pmod{341}$.\n    The chain of values $(x_0, x_1)$ is $(32, 1)$. Since $x_0 \\neq 1$ and no term in the sequence is congruent to $-1 \\pmod{341}$, the number $341$ is not a strong pseudoprime to base $2$.\n\n2.  For $n=561$:\n    $n-1 = 560 = 16 \\times 35 = 2^4 \\times 35$. So, $s=4, d=35$.\n    The chain is $x_0 \\equiv 2^{35} \\equiv 263 \\pmod{561}$, $x_1 \\equiv 263^2 \\equiv 166 \\pmod{561}$, $x_2 \\equiv 166^2 \\equiv 67 \\pmod{561}$, and $x_3 \\equiv 67^2 \\equiv 1 \\pmod{561}$.\n    No term is congruent to $-1 \\pmod{561}$, so $561$ is not a strong pseudoprime to base $2$.\n\n3.  For $n=645$:\n    $n-1 = 644 = 4 \\times 161 = 2^2 \\times 161$. So, $s=2, d=161$.\n    The chain is $x_0 \\equiv 2^{161} \\equiv 167 \\pmod{645}$ and $x_1 \\equiv 167^2 \\equiv 124 \\pmod{645}$. Note that the next term in the full sequence is $124^2 \\equiv 1 \\pmod{645}$.\n    No term in the Miller-Rabin chain is congruent to $1$ or $-1 \\pmod{645}$, so $645$ is not a strong pseudoprime to base $2$.\n\n4.  For $n=1105$:\n    $n-1 = 1104 = 16 \\times 69 = 2^4 \\times 69$. So, $s=4, d=69$.\n    The chain is $x_0 \\equiv 2^{69} \\equiv 967 \\pmod{1105}$, $x_1 \\equiv 967^2 \\equiv 259 \\pmod{1105}$, $x_2 \\equiv 259^2 \\equiv 781 \\pmod{1105}$, and $x_3 \\equiv 781^2 \\equiv 1 \\pmod{1105}$.\n    No term is congruent to $-1 \\pmod{1105}$, so $1105$ is not a strong pseudoprime to base $2$.\n\n5.  For $n=1387$:\n    $n-1 = 1386 = 2 \\times 693 = 2^1 \\times 693$. So, $s=1, d=693$.\n    The chain has only one term: $x_0 \\equiv 2^{693} \\equiv 512 \\pmod{1387}$.\n    This value is neither $1$ nor $-1 \\pmod{1387}$, so $1387$ is not a strong pseudoprime to base $2$.\n\n6.  For $n=1729$:\n    $n-1 = 1728 = 64 \\times 27 = 2^6 \\times 27$. So, $s=6, d=27$.\n    The chain begins $x_0 \\equiv 2^{27} \\equiv 645 \\pmod{1729}$, $x_1 \\equiv 645^2 \\equiv 1065 \\pmod{1729}$, and $x_2 \\equiv 1065^2 \\equiv 1 \\pmod{1729}$.\n    No term is congruent to $-1 \\pmod{1729}$, so $1729$ is not a strong pseudoprime to base $2$.\n\n7.  For $n=1905$:\n    $n-1 = 1904 = 16 \\times 119 = 2^4 \\times 119$. So, $s=4, d=119$.\n    The chain is $x_0 \\equiv 2^{119} \\equiv 128 \\pmod{1905}$, $x_1 \\equiv 128^2 \\equiv 1144 \\pmod{1905}$, $x_2 \\equiv 1144^2 \\equiv 1606 \\pmod{1905}$, and $x_3 \\equiv 1606^2 \\equiv 1 \\pmod{1905}$.\n    No term is congruent to $-1 \\pmod{1905}$, so $1905$ is not a strong pseudoprime to base $2$.\n\n8.  For $n=2047$:\n    $n=2047 = 23 \\times 89$ is composite.\n    $n-1 = 2046 = 2 \\times 1023 = 2^1 \\times 1023$. Thus, $s=1$ and $d=1023$.\n    We must test if $2^d \\equiv 1 \\pmod{n}$ or $2^d \\equiv -1 \\pmod{n}$.\n    We compute $x_0 \\equiv 2^d \\pmod n \\equiv 2^{1023} \\pmod{2047}$.\n    The number $2047$ is related to a Mersenne number, $2048 = 2^{11}$, so $2047 = 2^{11}-1$. Thus, $2^{11} \\equiv 1 \\pmod{2047}$.\n    The exponent $d=1023$ can be written as $1023 = 11 \\times 93$.\n    Therefore, $2^{1023} = 2^{11 \\times 93} = (2^{11})^{93} \\equiv 1^{93} \\equiv 1 \\pmod{2047}$.\n    The condition $a^d \\equiv 1 \\pmod{n}$ is satisfied.\n    Thus, $2047$ is a strong pseudoprime to base $2$.\n\nSince all smaller base-2 Fermat pseudoprimes have been shown to fail the strong pseudoprime test for base $2$, $2047$ is the smallest such number.\n\nTo confirm, we exhibit the Miller-Rabin chain. For $n=2047$, we have $s=1$ and $d=1023$. The chain consists of a single term for $r=s-1=0$:\n$x_0 \\equiv 2^d \\pmod n \\equiv 2^{1023} \\pmod{2047} \\equiv 1 \\pmod{2047}$.\nThe test passes because $x_0 \\equiv 1$, satisfying the first condition of the definition.", "answer": "$$\n\\boxed{2047}\n$$", "id": "3088867"}]}