{"hands_on_practices": [{"introduction": "This first practice is the cornerstone of the Gambler's Ruin problem. We will derive the general formula for the probability of ruin when the game is potentially unfair ($p \\neq q$), a crucial result with wide applications. Mastering the method of setting up and solving the recurrence relation presented here is key to understanding the dynamics of this classic random walk [@problem_id:7867].", "problem": "A gambler, Alice, plays a sequential game of chance. She starts with an initial fortune of $i$ dollars, where $i$ is an integer. Her goal is to reach a total fortune of $N$ dollars, where $N  i$. If her fortune ever drops to $0$ dollars, she is ruined and must stop playing.\n\nIn each round of the game, she bets a single dollar. She wins the round with a constant probability $p$ (increasing her fortune by $1 dollar) and loses with a probability $q = 1-p$ (decreasing her fortune by $1 dollar). The game is played with an unfair coin, meaning that $p \\neq q$.\n\nLet $P_k$ be the probability that Alice is eventually ruined (i.e., her fortune reaches $0$) given that she currently has $k$ dollars. You are tasked with finding the probability of ruin given her initial fortune, $P_i$.\n\nDerive a closed-form expression for the probability of ruin, $P_i$, in terms of her initial fortune $i$, the target fortune $N$, and the probabilities $p$ and $q$.", "solution": "Let $P_k$ be the probability that the gambler's fortune reaches $0$ before it reaches $N$, given a starting fortune of $k$. We are looking for $P_i$. The range of possible fortunes is the set of integers $\\{0, 1, 2, ..., N\\}$.\n\nFirst, we establish the boundary conditions for the problem.\nIf the starting fortune is $k=0$, the gambler is already ruined. Therefore, the probability of ruin is $1$.\n$$\nP_0 = 1\n$$\nIf the starting fortune is $k=N$, the gambler has reached her target and the game is over. The probability of being ruined from this state is $0$.\n$$\nP_N = 0\n$$\n\nFor any intermediate fortune $k$ such that $0  k  N$, we can establish a recurrence relation for $P_k$ by conditioning on the outcome of the very next round.\n- With probability $p$, the gambler wins the next round, and her fortune becomes $k+1$. The probability of ruin from this new state is $P_{k+1}$.\n- With probability $q$, she loses the next round, and her fortune becomes $k-1$. The probability of ruin from this new state is $P_{k-1}$.\n\nBy the law of total probability, $P_k$ is the weighted average of these two outcomes:\n$$\nP_k = p P_{k+1} + q P_{k-1}\n$$\nSince $p+q=1$, we can rewrite $P_k$ as $(p+q)P_k = pP_k + qP_k$. Substituting this into the relation:\n$$\np P_k + q P_k = p P_{k+1} + q P_{k-1}\n$$\nRearranging the terms, we group the $p$'s and $q$'s:\n$$\nq (P_k - P_{k-1}) = p (P_{k+1} - P_k)\n$$\nLet's define the difference in probabilities between consecutive states as $\\Delta_k = P_k - P_{k-1}$. The equation becomes:\n$$\nq \\Delta_k = p \\Delta_{k+1}\n$$\nThis yields a simple relationship for the differences:\n$$\n\\Delta_{k+1} = \\frac{q}{p} \\Delta_k\n$$\nThis shows that the differences $\\Delta_k$ form a geometric progression with a common ratio $r = q/p$. We can express any difference $\\Delta_k$ in terms of the first difference, $\\Delta_1 = P_1 - P_0$:\n$$\n\\Delta_k = \\left(\\frac{q}{p}\\right)^{k-1} \\Delta_1\n$$\nNow, we can express $P_k$ by summing these differences starting from $P_0$:\n$$\nP_k = P_0 + \\sum_{j=1}^{k} (P_j - P_{j-1}) = P_0 + \\sum_{j=1}^{k} \\Delta_j\n$$\nSubstituting the expression for $\\Delta_j$:\n$$\nP_k = P_0 + \\sum_{j=1}^{k} \\left(\\frac{q}{p}\\right)^{j-1} \\Delta_1 = P_0 + \\Delta_1 \\sum_{j=0}^{k-1} \\left(\\frac{q}{p}\\right)^j\n$$\nThe sum is a finite geometric series. Since the problem states $p \\neq q$, the ratio $r=q/p \\neq 1$. The sum of a geometric series is $\\sum_{j=0}^{n} r^j = \\frac{1-r^{n+1}}{1-r}$. Applying this formula:\n$$\nP_k = P_0 + \\Delta_1 \\left( \\frac{1 - (q/p)^k}{1 - q/p} \\right)\n$$\nWe have two unknowns, $P_0$ and $\\Delta_1$. We use our boundary conditions to solve for them. We already know $P_0=1$. We can also express $\\Delta_1$ as $P_1-P_0 = P_1 - 1$.\nSo, $\\Delta_1$ is an unknown constant we need to determine. Let's use the other boundary condition, $P_N=0$:\n$$\n0 = P_N = P_0 + \\Delta_1 \\left( \\frac{1 - (q/p)^N}{1 - q/p} \\right)\n$$\nSubstituting $P_0=1$:\n$$\n0 = 1 + \\Delta_1 \\left( \\frac{1 - (q/p)^N}{1 - q/p} \\right)\n$$\nSolving for $\\Delta_1$:\n$$\n\\Delta_1 = - \\frac{1 - q/p}{1 - (q/p)^N}\n$$\nNow we substitute this expression for $\\Delta_1$ back into our equation for $P_k$:\n$$\nP_k = P_0 + \\left( - \\frac{1 - q/p}{1 - (q/p)^N} \\right) \\left( \\frac{1 - (q/p)^k}{1 - q/p} \\right)\n$$\nAgain, using $P_0=1$ and simplifying by canceling the $(1-q/p)$ terms:\n$$\nP_k = 1 - \\frac{1 - (q/p)^k}{1 - (q/p)^N}\n$$\nTo get a single fractional term, we find a common denominator:\n$$\nP_k = \\frac{(1 - (q/p)^N) - (1 - (q/p)^k)}{1 - (q/p)^N} = \\frac{1 - (q/p)^N - 1 + (q/p)^k}{1 - (q/p)^N}\n$$\nThis simplifies to the general solution for the probability of ruin starting from a fortune of $k$:\n$$\nP_k = \\frac{(q/p)^k - (q/p)^N}{1 - (q/p)^N}\n$$\nThe problem asks for the probability of ruin starting with an initial fortune of $i$. We simply set $k=i$ in the general solution.\n$$\nP_i = \\frac{(q/p)^i - (q/p)^N}{1 - (q/p)^N}\n$$\nThis is the final expression for the probability of ruin.", "answer": "$$\n\\boxed{\\frac{\\left(\\frac{q}{p}\\right)^i - \\left(\\frac{q}{p}\\right)^N}{1 - \\left(\\frac{q}{p}\\right)^N}}\n$$", "id": "7867"}, {"introduction": "Beyond knowing the probability of ruin, we are often interested in how long the game is expected to last. This exercise shifts our focus from the ultimate outcome to the game's duration, introducing the concept of the expected number of steps until absorption. You will set up and solve a new, non-homogeneous recurrence relation to find the expected length of the game, providing a deeper understanding of the process's temporal characteristics [@problem_id:7857].", "problem": "A gambler starts with an initial fortune of $i$ integer units of money. The gambler plays a series of games. The objective is to reach a total fortune of $N$ units, where $N  i  0$. The game stops if the gambler's fortune reaches $N$ (a win) or $0$ (ruin).\n\nIn each game, a fair coin is tossed. If it's heads, the gambler wins $1$ unit. If it's tails, the gambler loses $1$ unit. Let $p$ be the probability of winning a game and $q$ be the probability of losing a game. For a fair coin, $p = q = \\frac{1}{2}$.\n\nLet $E_i$ represent the expected number of games that will be played until the game ends (either by ruin or by reaching the target fortune $N$), given the gambler's initial fortune is $i$.\n\nThe expected number of games $E_i$ for $0  i  N$ can be related to the expected number of games from adjacent states by considering the outcome of the very next game. After one game (which adds $1$ to the total game count), the gambler's fortune becomes $i+1$ with probability $p$ or $i-1$ with probability $q$. Therefore, the expected number of *additional* games from this new state is $E_{i+1}$ or $E_{i-1}$, respectively. This leads to the recurrence relation:\n$$E_i = 1 + p E_{i+1} + q E_{i-1}$$\nIf the gambler's fortune is $0$ or $N$, the game has already ended, so no more games are played. The boundary conditions are therefore $E_0 = 0$ and $E_N = 0$.\n\nDerive the expression for $E_i$ in terms of the initial fortune $i$ and the target fortune $N$ for the case of a fair coin.", "solution": "We have for $0iN$ the recurrence from one step of the fair game:\n$$E_i = 1 + \\tfrac12 E_{i+1} + \\tfrac12 E_{i-1}.$$\nMultiply by 2:\n$$2E_i = 2 + E_{i+1} + E_{i-1}\n\\quad\\Longrightarrow\\quad\nE_{i+1}-2E_i+E_{i-1} = -2.$$\nThe homogeneous solution is $E_i^{(h)} = A + Bi$.\nFor a particular solution, we try the form $E_i^{(p)} = Ci^2$. Substituting this into the recurrence gives $C(i+1)^2 - 2Ci^2 + C(i-1)^2 = -2$, which simplifies to $2C = -2$, so $C=-1$.\nHence the general solution is\n$$E_i = A + Bi - i^2.$$\nApply the boundary conditions $E_0=0$ and $E_N=0$:\n$$E_0 = A = 0,\\qquad E_N = BN - N^2 = 0\\;\\Rightarrow\\;B=N.$$\nTherefore\n$$E_i = N i - i^2 = i\\,(N - i).$$", "answer": "$$\\boxed{i(N - i)}$$", "id": "7857"}, {"introduction": "Real-world financial models often deviate from the simple \"win 1, lose 1\" paradigm. This practice challenges you to generalize the Gambler's Ruin framework to a situation with asymmetric step sizesâ€”a profit of $2$ versus a loss of $1$. Solving this problem requires adapting the fundamental recurrence relation, which leads to a different characteristic equation, demonstrating the power and flexibility of this analytical approach for more complex stochastic processes [@problem_id:1398199].", "problem": "An algorithmic trading firm is testing a new automated strategy. The algorithm starts with an initial capital of $k_0$ dollars and executes a series of independent trades. Each trade is categorized as either a \"high-yield success,\" which nets a profit of $2$ dollars, or a \"minor setback,\" which results in a loss of $1$ dollar. A high-yield success occurs with probability $p$, and a minor setback occurs with probability $1-p$. The algorithm runs as long as its capital is positive. If the capital ever reaches zero, the algorithm is terminated, and the strategy is deemed a failure (ruin).\n\nGiven that the probability of a high-yield success is $p = \\frac{2}{5}$ and the initial capital is $k_0 = 4$ dollars, determine the exact probability that the algorithm will eventually be terminated due to ruin. Express your answer as a single closed-form analytic expression.", "solution": "Let $u(k)$ denote the probability that the algorithm is eventually ruined (hits capital $0$) given current capital $k \\geq 0$. By definition, $u(0)=1$. For $k \\geq 1$, applying first-step analysis yields\n$$\nu(k) = p\\,u(k+2) + (1-p)\\,u(k-1).\n$$\nWith $p=\\frac{2}{5}$ and $1-p=\\frac{3}{5}$, this becomes\n$$\nu(k) = \\frac{2}{5}\\,u(k+2) + \\frac{3}{5}\\,u(k-1), \\quad k \\geq 1,\n$$\nwith boundary condition $u(0)=1$ and the requirement that $u(k)$ be a probability taking values in $[0,1]$.\n\nSeek solutions of the form $u(k)=\\lambda^{k}$. Substituting gives\n$$\n\\lambda^{k} = \\frac{2}{5}\\,\\lambda^{k+2} + \\frac{3}{5}\\,\\lambda^{k-1}.\n$$\nDividing by $\\lambda^{k-1}$ (for $\\lambda \\neq 0$) yields the characteristic equation\n$$\n\\lambda = \\frac{2}{5}\\,\\lambda^{3} + \\frac{3}{5}\n\\;\\;\\Longleftrightarrow\\;\\;\n2\\lambda^{3} - 5\\lambda + 3 = 0.\n$$\nFactoring,\n$$\n2\\lambda^{3} - 5\\lambda + 3 = (\\lambda - 1)\\left(2\\lambda^{2} + 2\\lambda - 3\\right),\n$$\nso the roots are\n$$\n\\lambda_{1} = 1, \n\\quad\n\\lambda_{2} = \\frac{-1 + \\sqrt{7}}{2},\n\\quad\n\\lambda_{3} = \\frac{-1 - \\sqrt{7}}{2}.\n$$\nNumerically, $|\\lambda_{2}|1$ and $|\\lambda_{3}|1$. The general solution to the linear recurrence that is bounded as $k \\to \\infty$ therefore has the form\n$$\nu(k) = A \\cdot 1^{k} + B \\left(\\frac{-1 + \\sqrt{7}}{2}\\right)^{k},\n$$\nsince the term with $\\lambda_{3}$ must be excluded to maintain boundedness.\n\nBecause the expected increment per trade is $2p - (1-p) = 3p - 1 = \\frac{1}{5} > 0$, the process has positive drift, and the probability of eventual ruin must satisfy $\\lim_{k \\to \\infty} u(k) = 0$. Hence $A=0$, leaving\n$$\nu(k) = B \\left(\\frac{-1 + \\sqrt{7}}{2}\\right)^{k}.\n$$\nImposing $u(0)=1$ gives $B=1$. Thus\n$$\nu(k) = \\left(\\frac{-1 + \\sqrt{7}}{2}\\right)^{k}.\n$$\nFor the initial capital $k_{0}=4$, the ruin probability is\n$$\nu(4) = \\left(\\frac{-1 + \\sqrt{7}}{2}\\right)^{4}.\n$$\nSimplify:\n$$\n\\left(\\frac{-1 + \\sqrt{7}}{2}\\right)^{2} = \\frac{4 - \\sqrt{7}}{2},\n\\quad\n\\left(\\frac{-1 + \\sqrt{7}}{2}\\right)^{4} = \\left(\\frac{4 - \\sqrt{7}}{2}\\right)^{2} = \\frac{23 - 8\\sqrt{7}}{4}.\n$$\nTherefore, the exact probability of eventual ruin is $\\frac{23 - 8\\sqrt{7}}{4}$.", "answer": "$$\\boxed{\\frac{23 - 8\\sqrt{7}}{4}}$$", "id": "1398199"}]}