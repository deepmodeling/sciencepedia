{"hands_on_practices": [{"introduction": "Mastering the theory of quadratic residues begins with proficiency in calculating the Legendre symbol. This exercise provides direct, hands-on practice with this fundamental tool, challenging you to find the smallest quadratic non-residue for various primes. By systematically applying the law of quadratic reciprocity and its supplements, you will build computational fluency and develop a concrete intuition for the distribution of residues and non-residues [@problem_id:3021794].", "problem": "Let $p$ be an odd prime and let the Legendre symbol $(\\frac{a}{p})$ be defined for integers $a$ by $(\\frac{a}{p}) = 1$ if $a$ is a quadratic residue modulo $p$, $(\\frac{a}{p}) = -1$ if $a$ is a quadratic non-residue modulo $p$, and $(\\frac{a}{p}) = 0$ if $p$ divides $a$. Define $n(p)$ to be the least positive integer $n \\geq 2$ such that $(\\frac{n}{p}) = -1$. Using only the foundational properties of Legendre symbols, including Euler’s criterion and quadratic reciprocity, determine explicit numerical bounds $b_{p}$ with $n(p) \\leq b_{p}$ for each prime $p$ in the set $P = \\{3, 5, 7, 11, 13, 17, 19, 23, 29, 31\\}$ by directly evaluating $(\\frac{a}{p})$ for successive integers $a$ beginning at $a=2$. Then compute the single number $B = \\max_{p \\in P} b_{p}$. Provide your final value of $B$ exactly as an integer; no rounding is required.", "solution": "The user wants me to find the least quadratic non-residue $n(p)$ for a given set of primes $p$.\n\n**Problem Breakdown:**\n\n1.  **Define $n(p)$**: For an odd prime $p$, $n(p)$ is the smallest positive integer $n \\ge 2$ such that $n$ is a quadratic non-residue modulo $p$. This means $(\\frac{n}{p}) = -1$.\n2.  **Set of Primes**: $P = \\{3, 5, 7, 11, 13, 17, 19, 23, 29, 31\\}$.\n3.  **Task**:\n    *   For each prime $p \\in P$, find $n(p)$. The problem statement refers to this as finding a bound $b_p$ such that $n(p) \\leq b_p$. The method specified is to directly evaluate $(\\frac{a}{p})$ for $a=2, 3, 4, ...$ until a non-residue is found. This means the first non-residue found *is* $n(p)$. So, $b_p$ is just $n(p)$.\n    *   Compute $B = \\max_{p \\in P} n(p)$.\n4.  **Tools**:\n    *   Legendre symbol $(\\frac{a}{p})$.\n    *   Euler's criterion: $(\\frac{a}{p}) \\equiv a^{(p-1)/2} \\pmod p$.\n    *   Law of Quadratic Reciprocity (LQR): For distinct odd primes $p, q$, $(\\frac{p}{q}) (\\frac{q}{p}) = (-1)^{((p-1)/2)((q-1)/2)}$.\n    *   Properties of the Legendre symbol:\n        *   $(\\frac{ab}{p}) = (\\frac{a}{p})(\\frac{b}{p})$.\n        *   $(\\frac{a^2}{p}) = 1$ if $p \\nmid a$.\n        *   $(\\frac{-1}{p}) = (-1)^{(p-1)/2}$.\n        *   $(\\frac{2}{p}) = (-1)^{(p^2-1)/8}$.\n\n**Validation Phase:**\n\n1.  **Extract Givens**:\n    *   $p$ is an odd prime.\n    *   Legendre symbol $(\\frac{a}{p})$ is defined as $1$ for quadratic residues, $-1$ for quadratic non-residues, and $0$ for $p|a$.\n    *   $n(p)$ is the least positive integer $n \\ge 2$ with $(\\frac{n}{p}) = -1$.\n    *   $b_p$ is an upper bound for $n(p)$, determined by finding the first non-residue. So $b_p = n(p)$.\n    *   $P = \\{3, 5, 7, 11, 13, 17, 19, 23, 29, 31\\}$.\n    *   $B = \\max_{p \\in P} b_p$.\n    *   The tools to be used are \"foundational properties of Legendre symbols, including Euler’s criterion and quadratic reciprocity\".\n    *   The method is to evaluate $(\\frac{a}{p})$ for successive integers $a$ starting from $a=2$.\n\n2.  **Validate**:\n    *   **Scientifically Grounded**: Yes, the problem is firmly within number theory, a branch of mathematics. The concepts of quadratic residues, Legendre symbols, Euler's criterion, and quadratic reciprocity are standard and well-established.\n    *   **Well-Posed**: Yes. For any odd prime $p$, there are exactly $(p-1)/2$ quadratic non-residues, so a least positive non-residue $n(p)$ must exist. The set $P$ is finite, so the maximum value $B$ must also exist and be unique. The procedure is well-defined.\n    *   **Objective**: Yes, the language is precise and mathematical.\n    *   **Scientific or Factual Unsoundness**: None.\n    *   **Non-Formalizable or Irrelevant**: The problem is formal and relevant to number theory.\n    *   **Incomplete or Contradictory Setup**: The setup is complete and consistent. The statement \"determine explicit numerical bounds $b_p$ with $n(p) \\leq b_p$\" might seem a bit convoluted, but the next part clarifies that this is done \"by directly evaluating $(\\frac{a}{p})$ for successive integers a...\". This means the first non-residue we find for $a \\geq 2$ will be $n(p)$. So, we are simply finding $n(p)$ for each $p$, and we can set $b_p=n(p)$. The problem is not contradictory.\n    *   **Unrealistic or Infeasible**: The calculations are feasible.\n    *   **Ill-Posed or Poorly Structured**: No, the problem is well-structured.\n    *   **Pseudo-Profound, Trivial, or Tautological**: No, this is a standard computational problem in elementary number theory.\n    *   **Outside Scientific Verifiability**: The results are mathematically verifiable.\n\n**Verdict**: The problem is valid.\n\n**Solution Phase - Step-by-step Calculation:**\n\nI need to find $n(p)$ for each $p \\in P$. I will check $a=2, 3, 4, ...$ in order.\n\n*   **For $p=3$**:\n    *   We need the least $n \\ge 2$ such that $(\\frac{n}{3}) = -1$.\n    *   Let's check $n=2$.\n    *   $(\\frac{2}{3})$. Using the rule $(\\frac{2}{p}) = (-1)^{(p^2-1)/8}$:\n        *   $(\\frac{2}{3}) = (-1)^{(3^2-1)/8} = (-1)^{8/8} = (-1)^1 = -1$.\n    *   So, $n(3) = 2$. Let $b_3 = 2$.\n\n*   **For $p=5$**:\n    *   We need the least $n \\ge 2$ such that $(\\frac{n}{5}) = -1$.\n    *   Check $n=2$: $(\\frac{2}{5}) = (-1)^{(5^2-1)/8} = (-1)^{24/8} = (-1)^3 = -1$.\n    *   So, $n(5) = 2$. Let $b_5 = 2$.\n\n*   **For $p=7$**:\n    *   We need the least $n \\ge 2$ such that $(\\frac{n}{7}) = -1$.\n    *   Check $n=2$: $(\\frac{2}{7}) = (-1)^{(7^2-1)/8} = (-1)^{48/8} = (-1)^6 = 1$. So $2$ is a quadratic residue mod $7$.\n    *   Check $n=3$: $(\\frac{3}{7})$. Using LQR:\n        *   $(\\frac{3}{7})(\\frac{7}{3}) = (-1)^{((3-1)/2)((7-1)/2)} = (-1)^{(1)(3)} = -1$.\n        *   $(\\frac{7}{3}) = (\\frac{1}{3}) = 1$.\n        *   So, $(\\frac{3}{7}) \\cdot 1 = -1 \\implies (\\frac{3}{7}) = -1$.\n    *   So, $n(7) = 3$. Let $b_7 = 3$.\n\n*   **For $p=11$**:\n    *   We need the least $n \\ge 2$ such that $(\\frac{n}{11}) = -1$.\n    *   Check $n=2$: $(\\frac{2}{11}) = (-1)^{(11^2-1)/8} = (-1)^{120/8} = (-1)^{15} = -1$.\n    *   So, $n(11) = 2$. Let $b_{11} = 2$.\n\n*   **For $p=13$**:\n    *   We need the least $n \\ge 2$ such that $(\\frac{n}{13}) = -1$.\n    *   Check $n=2$: $(\\frac{2}{13}) = (-1)^{(13^2-1)/8} = (-1)^{168/8} = (-1)^{21} = -1$.\n    *   So, $n(13) = 2$. Let $b_{13} = 2$.\n\n*   **For $p=17$**:\n    *   We need the least $n \\ge 2$ such that $(\\frac{n}{17}) = -1$.\n    *   Check $n=2$: $(\\frac{2}{17}) = (-1)^{(17^2-1)/8} = (-1)^{288/8} = (-1)^{36} = 1$. So $2$ is a QR mod $17$.\n    *   Check $n=3$: $(\\frac{3}{17})$. Using LQR:\n        *   $(\\frac{3}{17})(\\frac{17}{3}) = (-1)^{((3-1)/2)((17-1)/2)} = (-1)^{(1)(8)} = 1$.\n        *   $(\\frac{17}{3}) = (\\frac{17 \\pmod 3}{3}) = (\\frac{2}{3}) = -1$.\n        *   So, $(\\frac{3}{17}) \\cdot (-1) = 1 \\implies (\\frac{3}{17}) = -1$.\n    *   So, $n(17) = 3$. Let $b_{17} = 3$.\n\n*   **For $p=19$**:\n    *   We need the least $n \\ge 2$ such that $(\\frac{n}{19}) = -1$.\n    *   Check $n=2$: $(\\frac{2}{19}) = (-1)^{(19^2-1)/8} = (-1)^{360/8} = (-1)^{45} = -1$.\n    *   So, $n(19) = 2$. Let $b_{19} = 2$.\n\n*   **For $p=23$**:\n    *   We need the least $n \\ge 2$ such that $(\\frac{n}{23}) = -1$.\n    *   Check $n=2$: $(\\frac{2}{23}) = (-1)^{(23^2-1)/8} = (-1)^{528/8} = (-1)^{66} = 1$. So $2$ is a QR mod $23$.\n    *   Check $n=3$: $(\\frac{3}{23})$. Using LQR:\n        *   $(\\frac{3}{23})(\\frac{23}{3}) = (-1)^{((3-1)/2)((23-1)/2)} = (-1)^{(1)(11)} = -1$.\n        *   $(\\frac{23}{3}) = (\\frac{2}{3}) = -1$.\n        *   So, $(\\frac{3}{23}) \\cdot (-1) = -1 \\implies (\\frac{3}{23}) = 1$. So $3$ is a QR mod $23$.\n    *   Check $n=4$: $4 = 2^2$, so $(\\frac{4}{23}) = (\\frac{2^2}{23}) = 1$.\n    *   Check $n=5$: $(\\frac{5}{23})$. Using LQR:\n        *   $(\\frac{5}{23})(\\frac{23}{5}) = (-1)^{((5-1)/2)((23-1)/2)} = (-1)^{(2)(11)} = 1$.\n        *   $(\\frac{23}{5}) = (\\frac{3}{5})$.\n        *   $(\\frac{3}{5})(\\frac{5}{3}) = (-1)^{((3-1)/2)((5-1)/2)} = (-1)^{(1)(2)} = 1$.\n        *   $(\\frac{5}{3}) = (\\frac{2}{3}) = -1$.\n        *   So, $(\\frac{3}{5}) \\cdot (-1) = 1 \\implies (\\frac{3}{5}) = -1$.\n        *   Back to $(\\frac{5}{23})(\\frac{23}{5}) = 1$, we have $(\\frac{5}{23})(\\frac{3}{5}) = 1$, so $(\\frac{5}{23})(-1) = 1 \\implies (\\frac{5}{23}) = -1$.\n    *   So, $n(23) = 5$. Let $b_{23} = 5$.\n\n*   **For $p=29$**:\n    *   We need the least $n \\ge 2$ such that $(\\frac{n}{29}) = -1$.\n    *   Check $n=2$: $(\\frac{2}{29}) = (-1)^{(29^2-1)/8} = (-1)^{840/8} = (-1)^{105} = -1$.\n    *   So, $n(29) = 2$. Let $b_{29} = 2$.\n\n*   **For $p=31$**:\n    *   We need the least $n \\ge 2$ such that $(\\frac{n}{31}) = -1$.\n    *   Check $n=2$: $(\\frac{2}{31}) = (-1)^{(31^2-1)/8} = (-1)^{960/8} = (-1)^{120} = 1$. So $2$ is a QR mod $31$.\n    *   Check $n=3$: $(\\frac{3}{31})$. Using LQR:\n        *   $(\\frac{3}{31})(\\frac{31}{3}) = (-1)^{((3-1)/2)((31-1)/2)} = (-1)^{(1)(15)} = -1$.\n        *   $(\\frac{31}{3}) = (\\frac{1}{3}) = 1$.\n        *   So, $(\\frac{3}{31}) \\cdot 1 = -1 \\implies (\\frac{3}{31}) = -1$.\n    *   So, $n(31) = 3$. Let $b_{31} = 3$.\n\n**Summary of $n(p)$ values (which are the $b_p$ values):**\n*   $n(3) = 2$\n*   $n(5) = 2$\n*   $n(7) = 3$\n*   $n(11) = 2$\n*   $n(13) = 2$\n*   $n(17) = 3$\n*   $n(19) = 2$\n*   $n(23) = 5$\n*   $n(29) = 2$\n*   $n(31) = 3$\n\n**Final Calculation**:\nNow, I need to compute $B = \\max_{p \\in P} b_p = \\max_{p \\in P} n(p)$.\nThe set of $n(p)$ values is $\\{2, 2, 3, 2, 2, 3, 2, 5, 2, 3\\}$.\nThe maximum value in this set is $5$.\nSo, $B=5$.", "answer": "$$\n\\boxed{5}\n$$", "id": "3021794"}, {"introduction": "While the Legendre symbol is defined for prime moduli, many practical problems involve composite numbers. This practice bridges that gap by demonstrating how to determine the number of solutions to a quadratic congruence modulo a composite number $n=pq$. By combining your understanding of Legendre symbols with the powerful framework of the Chinese Remainder Theorem, you will learn a crucial technique for extending results from prime fields to integer rings [@problem_id:3021799].", "problem": "Let $p$ and $q$ be distinct odd primes and let $n = pq$. For $a \\in \\mathbb{Z}$, consider the congruence $x^{2} \\equiv a \\pmod{n}$. Starting from the definitions of quadratic residues modulo an odd prime and the Chinese Remainder Theorem (CRT), derive the exact number of solutions $x \\in \\mathbb{Z}/n\\mathbb{Z}$ to $x^{2} \\equiv a \\pmod{n}$ in the following two cases:\n\n- Case (i): $\\gcd(a,n) = 1$ (that is, $a$ is a unit modulo $n$).\n- Case (ii): $p \\mid a$ and $q \\nmid a$.\n\nYour derivation must be explicit and self-contained, beginning from the foundational facts that for an odd prime $r$, the congruence $x^{2} \\equiv b \\pmod{r}$ has either zero, one, or two solutions in $\\mathbb{Z}/r\\mathbb{Z}$ depending on whether $b$ is a quadratic non-residue modulo $r$, whether $b \\equiv 0 \\pmod{r}$, or whether $b$ is a quadratic residue modulo $r$, respectively; and that the Chinese Remainder Theorem (CRT) identifies $\\mathbb{Z}/n\\mathbb{Z} \\cong \\mathbb{Z}/p\\mathbb{Z} \\times \\mathbb{Z}/q\\mathbb{Z}$. Express your final answers in closed form using the Legendre symbols $\\left( \\frac{a}{p} \\right)$ and $\\left( \\frac{a}{q} \\right)$. No numerical approximation is required.", "solution": "The problem asks for the number of solutions to the congruence $x^2 \\equiv a \\pmod{n}$, where $n=pq$ for distinct odd primes $p$ and $q$, under two different conditions on $a \\in \\mathbb{Z}$. The derivation will be based on the foundational principles specified: the Chinese Remainder Theorem (CRT) and the properties of quadratic residues modulo an odd prime.\n\nLet $N$ denote the number of solutions $x \\in \\mathbb{Z}/n\\mathbb{Z}$. The congruence $x^2 \\equiv a \\pmod{n}$ is equivalent to the system of simultaneous congruences:\n$$\n\\begin{cases}\nx^2 \\equiv a \\pmod{p} \\\\\nx^2 \\equiv a \\pmod{q}\n\\end{cases}\n$$\nThe Chinese Remainder Theorem establishes an isomorphism of rings $\\mathbb{Z}/n\\mathbb{Z} \\cong \\mathbb{Z}/p\\mathbb{Z} \\times \\mathbb{Z}/q\\mathbb{Z}$. This implies that for each pair of solutions $(x_p, x_q)$, where $x_p$ is a solution to the first congruence and $x_q$ is a solution to the second, there exists a unique solution $x \\pmod{n}$ that satisfies both. Therefore, the total number of solutions $N$ is the product of the number of solutions to each individual congruence. Let $N_p$ be the number of solutions to $x^2 \\equiv a \\pmod{p}$ and $N_q$ be the number of solutions to $x^2 \\equiv a \\pmod{q}$. Then, $N = N_p \\times N_q$.\n\nWe are given the rule for the number of solutions to $x^2 \\equiv b \\pmod{r}$ for an odd prime $r$. This number can be conveniently expressed using the Legendre symbol, $\\left(\\frac{b}{r}\\right)$. The Legendre symbol is defined as:\n$$\n\\left(\\frac{b}{r}\\right) =\n\\begin{cases}\n1 & \\text{if } b \\text{ is a quadratic residue modulo } r \\text{ and } r \\nmid b \\\\\n-1 & \\text{if } b \\text{ is a quadratic non-residue modulo } r \\\\\n0 & \\text{if } r \\mid b\n\\end{cases}\n$$\nThe number of solutions to $x^2 \\equiv b \\pmod{r}$ is precisely $1 + \\left(\\frac{b}{r}\\right)$. This formula holds for all three cases:\n- If $b$ is a quadratic residue modulo $r$, there are $2$ solutions, and $1 + \\left(\\frac{b}{r}\\right) = 1 + 1 = 2$.\n- If $b$ is a quadratic non-residue modulo $r$, there are $0$ solutions, and $1 + \\left(\\frac{b}{r}\\right) = 1 + (-1) = 0$.\n- If $r \\mid b$, there is $1$ solution ($x \\equiv 0 \\pmod{r}$), and $1 + \\left(\\frac{b}{r}\\right) = 1 + 0 = 1$.\n\nApplying this to our system, we have $N_p = 1 + \\left(\\frac{a}{p}\\right)$ and $N_q = 1 + \\left(\\frac{a}{q}\\right)$.\nThus, the total number of solutions to $x^2 \\equiv a \\pmod{n}$ is given by the general formula:\n$$\nN = \\left(1 + \\left(\\frac{a}{p}\\right)\\right) \\left(1 + \\left(\\frac{a}{q}\\right)\\right)\n$$\nWe now analyze the two specified cases using this formula.\n\nCase (i): $\\gcd(a, n) = 1$.\nThe condition $\\gcd(a, n) = 1$ is equivalent to $\\gcd(a, pq) = 1$. Since $p$ and $q$ are prime, this implies that $p \\nmid a$ and $q \\nmid a$.\nAs a result, $a \\not\\equiv 0 \\pmod{p}$ and $a \\not\\equiv 0 \\pmod{q}$.\nThis means that the Legendre symbols $\\left(\\frac{a}{p}\\right)$ and $\\left(\\frac{a}{q}\\right)$ cannot be $0$; they must be either $1$ or $-1$.\nThe number of solutions $N$ is given directly by our general formula. There is no further simplification required, as this expression provides the exact number of solutions based on the quadratic character of $a$ with respect to $p$ and $q$.\nThe number of solutions is $N = \\left(1 + \\left(\\frac{a}{p}\\right)\\right) \\left(1 + \\left(\\frac{a}{q}\\right)\\right)$.\nFor example, if $a$ is a quadratic residue modulo both $p$ and $q$, then $\\left(\\frac{a}{p}\\right) = 1$ and $\\left(\\frac{a}{q}\\right) = 1$, so $N = (1+1)(1+1) = 4$. If $a$ is a quadratic non-residue modulo either $p$ or $q$ (or both), then at least one of the factors is $1-1=0$, making $N=0$.\n\nCase (ii): $p \\mid a$ and $q \\nmid a$.\nWe again use the general formula for $N$.\nThe condition $p \\mid a$ signifies that $a \\equiv 0 \\pmod{p}$. By the definition of the Legendre symbol, this implies $\\left(\\frac{a}{p}\\right) = 0$.\nThe number of solutions to $x^2 \\equiv a \\pmod{p}$ is $N_p = 1 + \\left(\\frac{a}{p}\\right) = 1 + 0 = 1$. This corresponds to the single solution $x \\equiv 0 \\pmod{p}$.\nThe condition $q \\nmid a$ signifies that $a \\not\\equiv 0 \\pmod{q}$. Therefore, the Legendre symbol $\\left(\\frac{a}{q}\\right)$ is either $1$ or $-1$.\nThe number of solutions to $x^2 \\equiv a \\pmod{q}$ is $N_q = 1 + \\left(\\frac{a}{q}\\right)$. This evaluates to $2$ if $a$ is a quadratic residue modulo $q$, and $0$ if $a$ is a quadratic non-residue modulo $q$.\nThe total number of solutions is the product $N = N_p \\times N_q$.\nSubstituting the values for $N_p$ and $N_q$:\n$$\nN = 1 \\times \\left(1 + \\left(\\frac{a}{q}\\right)\\right) = 1 + \\left(\\frac{a}{q}\\right)\n$$\nThis is the final closed-form expression for the number of solutions in this case. The number of solutions is $2$ if $\\left(\\frac{a}{q}\\right) = 1$ and $0$ if $\\left(\\frac{a}{q}\\right) = -1$.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\left(1 + \\left(\\frac{a}{p}\\right)\\right) \\left(1 + \\left(\\frac{a}{q}\\right)\\right) & 1 + \\left(\\frac{a}{q}\\right) \\end{pmatrix}}\n$$", "id": "3021799"}, {"introduction": "Knowing that a number is a quadratic residue is one thing; efficiently computing its square root is another, more complex challenge. This problem guides you through the derivation and implementation of Cipolla's algorithm, an elegant method that finds square roots by temporarily working in the larger field $\\mathbb{F}_{p^2}$. This advanced practice not only provides a powerful computational tool but also beautifully illustrates the interplay between elementary number theory and the abstract algebra of finite fields [@problem_id:3021789].", "problem": "Let $p$ be an odd prime and let $\\mathbb{F}_{p}$ denote the finite field of $p$ elements. An element $a \\in \\mathbb{F}_{p}$ is called a quadratic residue modulo $p$ if there exists $x \\in \\mathbb{F}_{p}$ such that $x^{2} \\equiv a \\ (\\mathrm{mod}\\ p)$. The Legendre symbol $\\left( \\frac{a}{p} \\right)$ is defined for $a \\in \\mathbb{F}_{p}^{\\times}$ by $\\left( \\frac{a}{p} \\right) = 1$ if $a$ is a quadratic residue and $\\left( \\frac{a}{p} \\right) = -1$ otherwise, and by $\\left( \\frac{0}{p} \\right) = 0$. Euler’s criterion asserts that for $a \\in \\mathbb{F}_{p}^{\\times}$, $a^{(p-1)/2} \\equiv \\left( \\frac{a}{p} \\right) \\ (\\mathrm{mod}\\ p)$.\n\nStarting from the foundational properties of finite fields, quadratic residues, Euler’s criterion, and the Frobenius endomorphism, derive an algorithm that, when $a$ is a quadratic residue modulo $p$, computes a square root of $a$ by working in the quadratic extension field $\\mathbb{F}_{p^2}$ constructed from $\\mathbb{F}_{p}$ via adjoining a root of an irreducible quadratic over $\\mathbb{F}_{p}$. Your derivation must begin with the core definitions and laws and proceed to a complete, logically sound method that transforms the problem of extracting square roots in $\\mathbb{F}_{p}$ into exponentiation within $\\mathbb{F}_{p^2}$. Establish the correctness of your method purely from first principles of field theory in characteristic $p$, including the action of the Frobenius endomorphism on $\\mathbb{F}_{p^2}$, and justify why the output lies in $\\mathbb{F}_{p}$ when $a$ is a quadratic residue.\n\nAnalyze the expected running time of your algorithm under the standard bit-complexity model for arithmetic in $\\mathbb{Z}/p\\mathbb{Z}$, and prove that the algorithm runs in expected time that is polynomial in $\\log p$, by quantifying both the expected number of trials required to find a suitable quadratic non-residue and the cost of exponentiation in $\\mathbb{F}_{p^2}$.\n\nThen implement the derived algorithm as a program. The program must:\n- Accept no input and use the following fixed test suite of pairs $(a,p)$ with $p$ an odd prime:\n  1. $(0,3)$,\n  2. $(2,3)$,\n  3. $(10,13)$,\n  4. $(2,13)$,\n  5. $(643499475,1000000007)$,\n  6. $(5,11)$,\n  7. $(3,11)$.\n- For each test case, compute one square root $r \\in \\{0,1,\\dots,p-1\\}$ of $a$ modulo $p$ if it exists, and output the smaller of the two roots $r$ and $p-r$ when $a \\neq 0$. If no square root exists in $\\mathbb{F}_{p}$, output $-1$. For the case $a=0$, output $0$.\n- Produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the same order as the test suite, with no spaces. For example, the format must be like \"[r_1,r_2,\\dots,r_7]\" where each $r_i$ is the integer result for the $i$-th test case.\n\nYour reasoning must avoid heuristic shortcuts and must be grounded in the stated base of definitions and properties. No physical quantities are involved, and there is no angle unit. All numeric answers in the test suite are integers. The final program’s output must be in the exact single-line format specified above.", "solution": "The problem requires the derivation, complexity analysis, and implementation of an algorithm to find the square root of a number $a$ in a finite field $\\mathbb{F}_{p}$ where $p$ is an odd prime. The method must be based on arithmetic in the quadratic extension field $\\mathbb{F}_{p^2}$. The algorithm in question is commonly known as Cipolla's algorithm.\n\nFirst, we must determine if a square root of $a \\in \\mathbb{F}_p$ exists. The element $a=0$ has the unique square root $x=0$. For a non-zero element $a \\in \\mathbb{F}_p^\\times$, a square root exists if and only if $a$ is a quadratic residue modulo $p$. This can be efficiently tested using Euler's criterion, which states that $\\left( \\frac{a}{p} \\right) \\equiv a^{(p-1)/2} \\pmod p$. If $a^{(p-1)/2} \\equiv 1 \\pmod p$, $a$ is a quadratic residue. If $a^{(p-1)/2} \\equiv -1 \\pmod p$, $a$ is a quadratic non-residue and no square root exists in $\\mathbb{F}_p$.\n\nAssuming $a$ is a non-zero quadratic residue, we proceed to find a square root.\n\n**1. Derivation of the Algorithm**\n\nThe core idea is to find an element in an extension field $\\mathbb{F}_{p^2}$ whose square is $a$, and then show that this element must lie in the base field $\\mathbb{F}_p$.\n\n**1.1. Constructing the Field Extension $\\mathbb{F}_{p^2}$**\nA quadratic extension $\\mathbb{F}_{p^2}$ can be constructed as a quotient ring $\\mathbb{F}_p[x] / (f(x))$, where $f(x)$ is an irreducible quadratic polynomial over $\\mathbb{F}_p$. A simple choice for such a polynomial is $f(x) = x^2 - n$, where $n$ is a quadratic non-residue in $\\mathbb{F}_p$. The irreducibility of $x^2-n$ is guaranteed if it has no roots in $\\mathbb{F}_p$, which is true if and only if $n$ is not a square in $\\mathbb{F}_p$, i.e., $n$ is a quadratic non-residue. We represent $\\mathbb{F}_{p^2}$ as the set of elements $\\{u + v\\omega \\mid u, v \\in \\mathbb{F}_p\\}$, where $\\omega$ is a formal root of $x^2-n$, so $\\omega^2 = n$.\n\nThe algorithm begins by finding an element $t \\in \\mathbb{F}_p$ such that $n = t^2 - a$ is a quadratic non-residue. Such a $t$ is guaranteed to exist and can be found efficiently by randomly choosing values for $t$ and testing if $\\left(\\frac{t^2-a}{p}\\right) = -1$ using Euler's criterion. With $n = t^2 - a$ being a non-residue, we construct $\\mathbb{F}_{p^2} \\cong \\mathbb{F}_p[x] / (x^2 - n)$.\n\n**1.2. The Square Root Formula**\nThe algorithm asserts that a square root of $a$ is given by the element $x = (t + \\omega)^{(p+1)/2}$ in $\\mathbb{F}_{p^2}$. We must prove two things: first, that $x^2 = a$, and second, that $x \\in \\mathbb{F}_p$.\n\n**Proof that $x^2 = a$:**\nWe compute $x^2$:\n$$x^2 = \\left((t + \\omega)^{(p+1)/2}\\right)^2 = (t + \\omega)^{p+1} = (t + \\omega)^p (t + \\omega)$$\nTo evaluate $(t + \\omega)^p$, we use the properties of the Frobenius endomorphism $\\phi(z) = z^p$ in a field of characteristic $p$. For any $u, v \\in \\mathbb{F}_p$, we have $(u+v)^p = u^p + v^p$. Since elements of $\\mathbb{F}_p$ are fixed by the Frobenius map (by Fermat's Little Theorem, $u^p=u$), we have:\n$$(t + \\omega)^p = t^p + \\omega^p = t + \\omega^p$$\nNow we must evaluate $\\omega^p$. We know $\\omega^2 = n$.\n$$\\omega^p = \\omega \\cdot \\omega^{p-1} = \\omega \\cdot (\\omega^2)^{(p-1)/2} = \\omega \\cdot n^{(p-1)/2}$$\nBy our choice of $n=t^2-a$, it is a quadratic non-residue modulo $p$. Therefore, by Euler's criterion, $n^{(p-1)/2} \\equiv -1 \\pmod p$.\nSubstituting this back, we get $\\omega^p = \\omega \\cdot (-1) = -\\omega$.\nThus, the action of the Frobenius endomorphism on our element is $(t + \\omega)^p = t - \\omega$.\nNow we can complete the computation of $x^2$:\n$$x^2 = (t - \\omega)(t + \\omega) = t^2 - \\omega^2$$\nBy definition of $\\omega$, we have $\\omega^2 = n = t^2 - a$.\n$$x^2 = t^2 - (t^2 - a) = a$$\nThis proves that $x = (t + \\omega)^{(p+1)/2}$ is indeed a square root of $a$ in the field $\\mathbb{F}_{p^2}$.\n\n**Proof that $x \\in \\mathbb{F}_p$:**\nAn element $z$ of the extension field $\\mathbb{F}_{p^2}$ belongs to the base field $\\mathbb{F}_p$ if and only if it is fixed by the Frobenius endomorphism, i.e., $z^p = z$. Let's compute $x^p$:\n$$x^p = \\left((t + \\omega)^{(p+1)/2}\\right)^p = ((t+\\omega)^p)^{(p+1)/2}$$\nWe already established that $(t+\\omega)^p = t - \\omega$. So,\n$$x^p = (t - \\omega)^{(p+1)/2}$$\nTo show this equals $x$, consider that $(t - \\omega)(t + \\omega) = t^2 - \\omega^2 = a$. Thus, $t-\\omega = a(t+\\omega)^{-1}$.\n$$x^p = \\left(a(t+\\omega)^{-1}\\right)^{(p+1)/2} = a^{(p+1)/2} \\cdot \\left((t+\\omega)^{-1}\\right)^{(p+1)/2} = a^{(p+1)/2} \\cdot \\left((t+\\omega)^{(p+1)/2}\\right)^{-1} = a^{(p+1)/2} \\cdot x^{-1}$$\nWe have $a^{(p+1)/2} = a \\cdot a^{(p-1)/2}$. Since $a$ is a quadratic residue, $a^{(p-1)/2} = 1$. So, $a^{(p+1)/2} = a$.\nThis gives $x^p = a \\cdot x^{-1}$. Multiplying by $x$, we get $x^{p+1} = a$.\nThis is not directly what we need. Let us use a more direct approach. We have shown $x^2=a$. Thus, $x^{p-1} = (x^2)^{(p-1)/2} = a^{(p-1)/2}$. As $a$ is a quadratic residue, $a^{(p-1)/2}=1$. Therefore, $x^{p-1}=1$. Multiplying by $x$ (since $a \\neq 0$, $x \\neq 0$), we get $x^p = x$. This confirms that $x$ is in the base field $\\mathbb{F}_p$.\n\nThus, the algorithm correctly computes a square root of $a$ in $\\mathbb{F}_p$. The other root is $-x \\equiv p-x \\pmod p$.\n\n**2. Complexity Analysis**\n\nThe algorithm consists of three main steps:\n1.  Checking if $a$ is a quadratic residue.\n2.  Finding an element $t$ such that $n = t^2 - a$ is a quadratic non-residue.\n3.  Performing an exponentiation in $\\mathbb{F}_{p^2}$.\n\nThe complexity is analyzed in the standard bit-complexity model, where arithmetic operations on integers of size $p$ take time polynomial in $\\log p$. A multiplication or division modulo $p$ takes $O((\\log p)^2)$ time.\n\n**Step 1:** Checking $\\left(\\frac{a}{p}\\right)$ via $a^{(p-1)/2} \\pmod p$ requires modular exponentiation, which can be done in $O(\\log((p-1)/2)) = O(\\log p)$ modular multiplications. The total time for this step is $O((\\log p)^3)$.\n\n**Step 2:** Finding $t$. We iterate through $t=1, 2, 3, \\dots$, calculate $n=t^2-a$, and check if $n$ is a non-residue using Euler's criterion. The number of values of $t \\in \\mathbb{F}_p$ for which $t^2-a$ is a quadratic non-residue is approximately $(p-1)/2$. This means the probability of a randomly chosen $t$ being successful is approximately $1/2$. Therefore, the expected number of trials to find a suitable $t$ is approximately $2$.\nEach trial involves one squaring, one subtraction, and one modular exponentiation to test $n$. The cost of each trial is dominated by the exponentiation, taking $O((\\log p)^3)$ time. The expected time for this step is thus $O((\\log p)^3)$.\n\n**Step 3:** Exponentiation in $\\mathbb{F}_{p^2}$. We compute $x=(t+\\omega)^{(p+1)/2}$. This is a modular exponentiation in $\\mathbb{F}_{p^2}$ with an exponent of size $O(p)$, which takes $O(\\log p)$ multiplications in $\\mathbb{F}_{p^2}$.\nAn arithmetic operation in $\\mathbb{F}_{p^2}$ is more costly than in $\\mathbb{F}_p$. A multiplication of two elements $(u_1 + v_1\\omega)$ and $(u_2 + v_2\\omega)$ is $(u_1u_2 + v_1v_2n) + (u_1v_2 + u_2v_1)\\omega$.\nThis takes $4$ multiplications and $2$ additions in $\\mathbb{F}_p$ (or $3$ multiplications using Karatsuba's method). The cost of one $\\mathbb{F}_{p^2}$ multiplication is $O((\\log p)^2)$.\nThe total time for the exponentiation is $O(\\log p) \\times O((\\log p)^2) = O((\\log p)^3)$.\n\n**Total Complexity:** The expected running time of the algorithm is the sum of the complexities of these steps, which is dominated by modular exponentiations. The total expected time complexity is $O((\\log p)^3)$, which is polynomial in the input size $\\log p$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\n\ndef solve():\n    \"\"\"\n    Solves the problem for a fixed test suite of (a, p) pairs.\n    It computes a square root of a modulo p if one exists.\n    \"\"\"\n\n    test_cases = [\n        (0, 3),\n        (2, 3),\n        (10, 13),\n        (2, 13),\n        (643499475, 1000000007),\n        (5, 11),\n        (3, 11),\n    ]\n\n    def sqrt_mod_p(a, p):\n        \"\"\"\n        Computes a square root of a modulo p using Cipolla's algorithm.\n        Returns the smaller root, or -1 if no root exists.\n        \"\"\"\n        a %= p\n        if a == 0:\n            return 0\n        if p == 2:\n            return a\n\n        # Step 1: Check if a is a quadratic residue using Euler's criterion.\n        legendre = pow(a, (p - 1) // 2, p)\n        if legendre == p - 1:\n            return -1  # a is a quadratic non-residue\n\n        # If p = 3 (mod 4), there's a simpler formula.\n        # But this problem asks for the F_p^2 based derivation which works for all odd p.\n        # We will implement the general Cipolla's algorithm as required.\n        \n        # Step 2: Find t such that t^2 - a is a quadratic non-residue.\n        t = 1\n        while True:\n            n = (t * t - a) % p\n            if pow(n, (p - 1) // 2, p) == p - 1:\n                break\n            t += 1\n\n        # We need to perform arithmetic in F_p^2 = F_p[x] / (x^2 - n)\n        # An element is represented as a tuple (u, v) for u + v*omega.\n        \n        def f_p2_mul(x, y, n_val, p_val):\n            \"\"\"\n            Multiplies two numbers in F_p^2.\n            x = (x_u, x_v), y = (y_u, y_v)\n            \"\"\"\n            # (x_u + x_v*w) * (y_u + y_v*w) = x_u*y_u + (x_u*y_v + x_v*y_u)*w + x_v*y_v*w^2\n            # = (x_u*y_u + x_v*y_v*n) + (x_u*y_v + x_v*y_u)*w\n            res_u = (x[0] * y[0] + x[1] * y[1] * n_val) % p_val\n            res_v = (x[0] * y[1] + x[1] * y[0]) % p_val\n            return (res_u, res_v)\n        \n        def f_p2_pow(base, exp, n_val, p_val):\n            \"\"\"\n            Exponentiation in F_p^2 using binary exponentiation (exponentiation by squaring).\n            \"\"\"\n            res = (1, 0) # Multiplicative identity in F_p^2\n            while exp > 0:\n                if exp % 2 == 1:\n                    res = f_p2_mul(res, base, n_val, p_val)\n                base = f_p2_mul(base, base, n_val, p_val)\n                exp //= 2\n            return res\n\n        # Step 3: Compute x = (t + omega)^((p+1)/2).\n        # The base is (t, 1) which represents t + omega.\n        # The exponent is (p + 1) // 2.\n        base = (t, 1)\n        exponent = (p + 1) // 2\n        \n        root_pair = f_p2_pow(base, exponent, n, p)\n\n        # The result must be in F_p, so its imaginary part is 0.\n        # The root is the real part.\n        r1 = root_pair[0]\n        \n        # The other root is p - r1.\n        r2 = p - r1\n\n        # The problem asks for the smaller of the two roots.\n        return min(r1, r2)\n        \n    results = []\n    for a, p in test_cases:\n        result = sqrt_mod_p(a, p)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "3021789"}]}