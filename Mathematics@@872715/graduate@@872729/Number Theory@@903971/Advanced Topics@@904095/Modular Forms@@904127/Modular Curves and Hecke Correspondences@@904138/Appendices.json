{"hands_on_practices": [{"introduction": "The compact modular curve $X_0(N)$ is formed by adding a finite set of points, known as cusps, to the open curve $Y_0(N)$. These cusps represent the 'points at infinity' and are crucial for understanding the curve's geometry and the space of modular forms. This exercise provides a direct, hands-on method for classifying and counting these essential boundary points, connecting the abstract definition of cusps as $\\Gamma_0(N)$-orbits to a concrete calculation involving the divisors of $N$. [@problem_id:3018127]", "problem": "Let $N$ be a positive integer and let $\\Gamma_{0}(N)$ denote the congruence subgroup of the Special Linear group of degree two over the integers ($\\mathrm{SL}_{2}(\\mathbb{Z})$) consisting of all matrices $\\begin{pmatrix} a  b \\\\ c  d \\end{pmatrix}$ with $c \\equiv 0 \\pmod{N}$. The modular curve $X_{0}(N)$ has cusps corresponding to the set of $\\Gamma_{0}(N)$-orbits in the rational projective line $\\mathbb{P}^{1}(\\mathbb{Q})$ under the usual fractional linear action. The width of a cusp $\\kappa$ is defined as the minimal positive integer $w$ such that, after conjugating by any matrix $\\sigma \\in \\mathrm{SL}_{2}(\\mathbb{Z})$ with $\\sigma \\cdot \\infty = \\kappa$, the translation matrix $T^{w} = \\begin{pmatrix} 1  w \\\\ 0  1 \\end{pmatrix}$ lies in $\\sigma^{-1} \\Gamma_{0}(N) \\sigma$.\n\nStarting from the fundamental definitions above and the interpretation of cusps as elements of the double coset space $\\Gamma_{0}(N) \\backslash \\mathbb{P}^{1}(\\mathbb{Q})$, derive a classification of the cusps of $X_{0}(N)$ and a formula for their widths. Then, for the specific level $N = 60$, compute the total number of cusps and the multiset of their widths. Express the final answer as a single row matrix whose first entry is the total number of cusps and whose remaining entries are the widths of all cusps written in nondecreasing order. Provide exact integers; no rounding is required.", "solution": "The problem asks for a derivation of the classification and widths of cusps for the modular curve $X_{0}(N)$, followed by a specific calculation for the case $N = 60$.\n\n### Part 1: General Theory of Cusps for $\\Gamma_0(N)$\n\n**1. Classification of Cusps**\n\nThe cusps of the modular curve $X_{0}(N)$ are the equivalence classes of the rational projective line $\\mathbb{P}^{1}(\\mathbb{Q}) = \\mathbb{Q} \\cup \\{\\infty\\}$ under the action of the congruence subgroup $\\Gamma_{0}(N)$. The action is by fractional linear transformations.\n\nAny element of $\\mathbb{P}^{1}(\\mathbb{Q})$ can be written as a fraction $a/c$ in lowest terms, i.e., with $\\gcd(a,c)=1$. The point at infinity, $\\infty$, is identified with $1/0$.\n\nLet $\\kappa_{1} = a_{1}/c_{1}$ and $\\kappa_{2} = a_{2}/c_{2}$ be two cusps, with $\\gcd(a_{1},c_{1})=1$ and $\\gcd(a_{2},c_{2})=1$. They are $\\Gamma_{0}(N)$-equivalent if there exists a matrix $\\gamma = \\begin{pmatrix} \\alpha  \\beta \\\\ \\delta_N  \\epsilon \\end{pmatrix} \\in \\Gamma_{0}(N)$ such that $\\gamma(\\kappa_{1}) = \\kappa_{2}$. The condition for being in $\\Gamma_{0}(N)$ is $\\delta_N \\equiv 0 \\pmod{N}$.\n\nThe action gives:\n$$ \\frac{a_{2}}{c_{2}} = \\frac{\\alpha a_{1} + \\beta c_{1}}{\\delta_N a_{1} + \\epsilon c_{1}} $$\nSince the fraction $a_{2}/c_{2}$ is in lowest terms, the denominator $c_{2}$ must be a divisor of $\\delta_N a_{1} + \\epsilon c_{1}$. Thus, up to a sign, we can write $c_{2} = \\delta_N a_{1} + \\epsilon c_{1}$.\n\nLet's analyze the quantity $\\gcd(c, N)$ for a cusp representative $a/c$. For two equivalent cusps, we have:\n$$ \\gcd(c_{2}, N) = \\gcd(\\delta_N a_{1} + \\epsilon c_{1}, N) = \\gcd(\\epsilon c_{1}, N) $$\nSince $\\alpha\\epsilon - \\beta\\delta_N = 1$, we have $\\gcd(\\epsilon, \\delta_N)=1$, which implies $\\gcd(\\epsilon, N) = 1$. Therefore:\n$$ \\gcd(c_{2}, N) = \\gcd(c_{1}, N) $$\nThis shows that $d = \\gcd(c, N)$ is an invariant of the $\\Gamma_{0}(N)$-orbit of any cusp $a/c$. This means that cusps with different values of $\\gcd(c,N)$ belong to distinct equivalence classes.\n\nThe standard classification, which can be derived from this observation, states that the cusps of $X_{0}(N)$ are in one-to-one correspondence with pairs $(d, u)$ where $d$ is a positive divisor of $N$, and $u$ is an integer defined modulo $\\gcd(d, N/d)$ such that $\\gcd(u,d)=1$. A representative fraction for such a cusp is $u/d$.\n\nFor each positive divisor $d$ of $N$, the number of distinct cusps associated with it is given by the number of choices for $u$. The number of integers $u$ such that $1 \\le u \\le \\gcd(d, N/d)$ and $\\gcd(u, \\gcd(d,N/d))=1$ (which implies $\\gcd(u,d)=1$) is $\\phi(\\gcd(d, N/d))$, where $\\phi$ is Euler's totient function.\n\nThe total number of cusps for $X_{0}(N)$ is the sum over all positive divisors of $N$:\n$$ \\text{Number of cusps} = \\sum_{d|N, d>0} \\phi(\\gcd(d, N/d)) $$\n\n**2. Width of Cusps**\n\nThe width $w$ of a cusp $\\kappa$ is the minimal positive integer such that the translation matrix $T^{w} = \\begin{pmatrix} 1  w \\\\ 0  1 \\end{pmatrix}$ lies in the group $\\sigma^{-1} \\Gamma_{0}(N) \\sigma$, where $\\sigma \\in \\mathrm{SL}_{2}(\\mathbb{Z})$ is any matrix that maps $\\infty$ to $\\kappa$. This is equivalent to finding the smallest $w>0$ such that $\\sigma T^w \\sigma^{-1} \\in \\Gamma_0(N)$.\n\nLet the cusp be represented by $\\kappa = a/c$ with $\\gcd(a,c)=1$. We can choose a matrix $\\sigma \\in \\mathrm{SL}_{2}(\\mathbb{Z})$ such that $\\sigma(\\infty) = a/c$. By the property of $\\mathrm{SL}_{2}(\\mathbb{Z})$, there exist integers $b, d'$ such that $ad' - bc = 1$. So we can take $\\sigma = \\begin{pmatrix} a  b \\\\ c  d' \\end{pmatrix}$. Note that the bottom-left entry of $\\sigma$ is $c$.\n\nLet's compute the matrix product $\\sigma T^w \\sigma^{-1}$:\n$$ \\sigma T^w \\sigma^{-1} = \\begin{pmatrix} a  b \\\\ c  d' \\end{pmatrix} \\begin{pmatrix} 1  w \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} d'  -b \\\\ -c  a \\end{pmatrix} $$\n$$ = \\begin{pmatrix} a  aw+b \\\\ c  cw+d' \\end{pmatrix} \\begin{pmatrix} d'  -b \\\\ -c  a \\end{pmatrix} = \\begin{pmatrix} a d' - c(aw+b)  -ab + a(aw+b) \\\\ c d' - c(cw+d')  -cb + a(cw+d') \\end{pmatrix} $$\nUsing $ad' - bc = 1$:\n$$ = \\begin{pmatrix} (ad'-bc) - acw  a^2 w \\\\ -c^2 w  (ad'-bc) + acw \\end{pmatrix} = \\begin{pmatrix} 1 - acw  a^2 w \\\\ -c^2 w  1 + acw \\end{pmatrix} $$\nFor this matrix to be in $\\Gamma_{0}(N)$, its bottom-left entry must be congruent to $0 \\pmod{N}$.\n$$ -c^2 w \\equiv 0 \\pmod{N} \\quad \\text{or} \\quad c^2 w \\equiv 0 \\pmod{N} $$\nWe seek the smallest positive integer $w$ satisfying this congruence. This is given by:\n$$ w = \\frac{\\operatorname{lcm}(c^2, N)}{c^2} = \\frac{c^2 N}{c^2 \\gcd(c^2, N)} = \\frac{N}{\\gcd(c^2, N)} $$\nThis formula gives the width of the cusp represented by $a/c$. As shown earlier, $\\gcd(c,N)$ is related to the cusp class, and this width formula depends on $c$ only through $\\gcd(c^2, N)$, which is also an invariant of the $\\Gamma_0(N)$-orbit.\nFor a cusp class corresponding to a divisor $d$ of $N$, we can use the representative $1/d$ (since $\\gcd(1,d)=1$). In this case, $c=d$, and the width is:\n$$ w_d = \\frac{N}{\\gcd(d^2, N)} $$\n\n### Part 2: Application to $N = 60$\n\nWe apply the derived formulas to the specific case $N = 60 = 2^2 \\cdot 3 \\cdot 5$.\n\nThe positive divisors of $60$ are $1, 2, 3, 4, 5, 6, 10, 12, 15, 20, 30, 60$. There are $12$ divisors in total. For each divisor $d$, we will compute the number of associated cusps, $\\phi(\\gcd(d, 60/d))$, and their common width, $w_d = 60/\\gcd(d^2, 60)$.\n\n-   $d=1$:\n    -   Number of cusps: $\\phi(\\gcd(1, 60)) = \\phi(1) = 1$.\n    -   Width: $w_1 = 60/\\gcd(1^2, 60) = 60/1 = 60$.\n-   $d=2$:\n    -   Number of cusps: $\\phi(\\gcd(2, 30)) = \\phi(2) = 1$.\n    -   Width: $w_2 = 60/\\gcd(2^2, 60) = 60/\\gcd(4, 60) = 60/4 = 15$.\n-   $d=3$:\n    -   Number of cusps: $\\phi(\\gcd(3, 20)) = \\phi(1) = 1$.\n    -   Width: $w_3 = 60/\\gcd(3^2, 60) = 60/\\gcd(9, 60) = 60/3 = 20$.\n-   $d=4$:\n    -   Number of cusps: $\\phi(\\gcd(4, 15)) = \\phi(1) = 1$.\n    -   Width: $w_4 = 60/\\gcd(4^2, 60) = 60/\\gcd(16, 60) = 60/4 = 15$.\n-   $d=5$:\n    -   Number of cusps: $\\phi(\\gcd(5, 12)) = \\phi(1) = 1$.\n    -   Width: $w_5 = 60/\\gcd(5^2, 60) = 60/\\gcd(25, 60) = 60/5 = 12$.\n-   $d=6$:\n    -   Number of cusps: $\\phi(\\gcd(6, 10)) = \\phi(2) = 1$.\n    -   Width: $w_6 = 60/\\gcd(6^2, 60) = 60/\\gcd(36, 60) = 60/12 = 5$.\n-   $d=10$:\n    -   Number of cusps: $\\phi(\\gcd(10, 6)) = \\phi(2) = 1$.\n    -   Width: $w_{10} = 60/\\gcd(10^2, 60) = 60/\\gcd(100, 60) = 60/20 = 3$.\n-   $d=12$:\n    -   Number of cusps: $\\phi(\\gcd(12, 5)) = \\phi(1) = 1$.\n    -   Width: $w_{12} = 60/\\gcd(12^2, 60) = 60/\\gcd(144, 60) = 60/12 = 5$.\n-   $d=15$:\n    -   Number of cusps: $\\phi(\\gcd(15, 4)) = \\phi(1) = 1$.\n    -   Width: $w_{15} = 60/\\gcd(15^2, 60) = 60/\\gcd(225, 60) = 60/15 = 4$.\n-   $d=20$:\n    -   Number of cusps: $\\phi(\\gcd(20, 3)) = \\phi(1) = 1$.\n    -   Width: $w_{20} = 60/\\gcd(20^2, 60) = 60/\\gcd(400, 60) = 60/20 = 3$.\n-   $d=30$:\n    -   Number of cusps: $\\phi(\\gcd(30, 2)) = \\phi(2) = 1$.\n    -   Width: $w_{30} = 60/\\gcd(30^2, 60) = 60/\\gcd(900, 60) = 60/60 = 1$.\n-   $d=60$:\n    -   Number of cusps: $\\phi(\\gcd(60, 1)) = \\phi(1) = 1$.\n    -   Width: $w_{60} = 60/\\gcd(60^2, 60) = 60/60 = 1$.\n\n**Summary for N=60:**\n\nThe total number of cusps is the sum of the number of cusps for each divisor class: $1 \\times 12 = 12$.\n\nThe multiset of widths is obtained by collecting all the calculated widths:\n$\\{60, 15, 20, 15, 12, 5, 3, 5, 4, 3, 1, 1\\}$.\n\nArranging these widths in nondecreasing order, we get:\n$\\{1, 1, 3, 3, 4, 5, 5, 12, 15, 15, 20, 60\\}$.\n\nThe final answer is a row matrix whose first entry is the total number of cusps ($12$), and the remaining entries are the sorted widths.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n12  1  1  3  3  4  5  5  12  15  15  20  60\n\\end{pmatrix}\n}\n$$", "id": "3018127"}, {"introduction": "Having explored the static geometry of the modular curve, we now turn to the dynamic operators that act upon it. Hecke operators are central to the theory, but their algebraic definition can be opaque. This practice illuminates the beautiful geometry underlying the Hecke correspondence $T_p$ by interpreting it through the moduli space of elliptic curves and their isogenies, providing a clear reason why its degree is fundamentally related to the number of order-$p$ subgroups of an elliptic curve. [@problem_id:3018113]", "problem": "Let $N \\geq 1$ be an integer and let $p$ be a prime with $p \\nmid N$. Consider the complex modular curve $X_{0}(N)$, viewed as the coarse moduli space parameterizing isomorphism classes of pairs $(E,C)$, where $E$ is an elliptic curve over $\\mathbb{C}$ and $C \\subset E$ is a cyclic subgroup of order $N$. Define the Hecke correspondence $T_{p}$ on $X_{0}(N)$ by the moduli problem that assigns to a point $(E,C)$ the set of isogenies $\\phi \\colon E \\to E'$ of degree $p$ such that $\\phi(C)$ is a cyclic subgroup of $E'$ of order $N$. Equivalently, $T_{p}$ can be described as the set of triples $(E,C,G)$, where $G \\subset E$ is a cyclic subgroup of order $p$, together with the induced pair $(E/G,(C+G)/G)$ on the quotient elliptic curve $E/G$, noting that $p \\nmid N$ ensures $C \\cap G = \\{0\\}$ and that the image $(C+G)/G$ in $E/G$ is cyclic of order $N$. The correspondence $T_{p}$ comes equipped with two finite morphisms (the projection maps)\n- $p_{1} \\colon T_{p} \\to X_{0}(N)$ sending $(E,C,G)$ to $(E,C)$, and\n- $p_{2} \\colon T_{p} \\to X_{0}(N)$ sending $(E,C,G)$ to $(E/G,(C+G)/G)$.\n\nStarting from the modular interpretation of $X_{0}(N)$ and the Hecke correspondence $T_{p}$, and using only foundational facts such as the structure of the $p$-torsion subgroup $E[p]$ of an elliptic curve and the existence of dual isogenies, derive from first principles a computation of the degrees of the finite maps $p_{1}$ and $p_{2}$ when $p \\nmid N$, and justify why these degrees coincide. Express your final answer as a single exact symbolic expression in terms of $p$; no rounding is required.", "solution": "The problem asks for the computation of the degrees of the two projection maps, $p_{1}$ and $p_{2}$, associated with the Hecke correspondence $T_{p}$ on the modular curve $X_{0}(N)$, for a prime $p$ not dividing $N$. We are to derive this from first principles and justify why the degrees coincide.\n\nLet $f: X \\to Y$ be a finite surjective morphism of algebraic curves over $\\mathbb{C}$. The degree of $f$, denoted $\\deg(f)$, is the number of points in the fiber $f^{-1}(y)$ for a generic point $y \\in Y$. The maps $p_{1}$ and $p_{2}$ are finite morphisms, so we can compute their degrees by counting the elements in a generic fiber.\n\nFirst, we compute the degree of $p_{1} \\colon T_{p} \\to X_{0}(N)$. The map $p_{1}$ is defined by sending the isomorphism class of a triple $(E,C,G)$ to the isomorphism class of the pair $(E,C)$. To find the degree of $p_{1}$, we must determine the size of the fiber $p_{1}^{-1}(x)$ for a generic point $x \\in X_{0}(N)$.\n\nLet $x = [(E,C)]$ be the isomorphism class of a pair where $E$ is an elliptic curve over $\\mathbb{C}$ and $C$ is a cyclic subgroup of order $N$. A point in the fiber $p_{1}^{-1}(x)$ is an isomorphism class of a triple $(E',C',G')$ such that $[(E',C')] = x$. We can choose a representative $(E,C)$ for the class $x$. The fiber then consists of isomorphism classes of triples of the form $(E,C,G)$, where $G$ is a cyclic subgroup of $E$ of order $p$. For a generic elliptic curve $E$, its automorphism group is just $\\{\\pm 1\\}$, and these automorphisms preserve any subgroup $G$. Thus, counting the number of non-isomorphic triples essentially reduces to counting the number of distinct subgroups $G$.\n\nThe task is therefore to count the number of distinct cyclic subgroups of order $p$ in the elliptic curve $E$. These subgroups are generated by elements of order $p$. The set of points of order dividing $p$ on $E$ is the $p$-torsion subgroup, denoted $E[p]$. For an elliptic curve over the complex numbers $\\mathbb{C}$ (or any field of characteristic not $p$), the $p$-torsion subgroup is an abelian group isomorphic to $(\\mathbb{Z}/p\\mathbb{Z}) \\times (\\mathbb{Z}/p\\mathbb{Z})$.\n$$E[p] \\cong (\\mathbb{Z}/p\\mathbb{Z})^{2}$$\nThis group has $p^{2}$ elements. It can be viewed as a two-dimensional vector space over the finite field $\\mathbb{F}_{p}$. A cyclic subgroup of order $p$ is a one-dimensional subspace of this vector space.\n\nThe number of non-zero vectors in $E[p]$ is $p^{2}-1$. Each one-dimensional subspace is generated by any of its non-zero vectors. Since a one-dimensional subspace over $\\mathbb{F}_{p}$ contains $p$ elements, it has $p-1$ non-zero elements (generators). Therefore, the number of distinct cyclic subgroups of order $p$ is the number of non-zero elements divided by the number of generators per subgroup:\n$$ \\text{Number of subgroups } G = \\frac{p^{2}-1}{p-1} = p+1 $$\nFor a generic point $[(E,C)]$, there are exactly $p+1$ distinct cyclic subgroups $G_i$ of order $p$ in $E$, leading to $p+1$ distinct points $[(E,C,G_i)]$ in the fiber of $p_1$. Thus, the degree of $p_{1}$ is $p+1$.\n$$ \\deg(p_{1}) = p+1 $$\n\nNext, we compute the degree of $p_{2} \\colon T_{p} \\to X_{0}(N)$. The map $p_{2}$ is defined by sending the isomorphism class of a triple $(E,C,G)$ to the isomorphism class of the pair $(E/G, (C+G)/G)$. To find the degree of $p_{2}$, we determine the size of the fiber $p_{2}^{-1}(y)$ for a generic point $y \\in X_{0}(N)$.\n\nLet $y = [(E',C')]$ be the isomorphism class of a pair where $E'$ is an elliptic curve and $C'$ is a cyclic subgroup of order $N$. A point in the fiber $p_{2}^{-1}(y)$ corresponds to an isomorphism class of a triple $(E,C,G)$ such that $[(E/G, (C+G)/G)] = y$. This means there is an isomorphism of pairs $i: (E/G, (C+G)/G) \\to (E', C')$.\nLet $\\pi:E \\to E/G$ be the canonical projection isogeny, which has degree $p$. The composition $\\phi = i \\circ \\pi: E \\to E'$ is an isogeny of degree $p$. The condition $(C+G)/G$ maps to $C'$ means that $\\phi(C)=C'$.\nSo, a point in the fiber over $[(E',C')]$ corresponds to a pair $(E,C)$ and a degree-$p$ isogeny $\\phi:E \\to E'$ such that $\\phi(C)=C'$. The problem is to count how many such pairs $(E,C)$ (up to isomorphism) give rise to the same $(E',C')$.\n\nWe can use the theory of dual isogenies. For any isogeny $\\phi: E \\to E'$ of degree $p$, there exists a unique dual isogeny $\\hat{\\phi}: E' \\to E$ also of degree $p$. The existence of such a $\\phi$ is therefore equivalent to the existence of its dual $\\hat{\\phi}$. The isogeny $\\hat{\\phi}:E' \\to E$ is determined (up to composing with an automorphism of $E$) by its kernel, $\\ker(\\hat{\\phi})$, which must be a cyclic subgroup of $E'$ of order $p$. As established before, there are $p+1$ such subgroups in $E'$.\n\nLet us fix the generic pair $(E',C')$ and enumerate the points in the fiber of $p_2$ over $[(E',C')]$. Each point corresponds to a choice of a cyclic subgroup $K \\subset E'$ of order $p$.\n1.  For each of the $p+1$ cyclic subgroups $K \\subset E'$ of order $p$, let $\\psi_K: E' \\to E'/K$ be the quotient isogeny.\n2.  Define the elliptic curve $E_K := E'/K$. For generic $E'$, different choices of $K$ lead to non-isomorphic elliptic curves $E_K$.\n3.  Let $\\phi_K = \\hat{\\psi}_K: E_K \\to E'$ be the dual isogeny to $\\psi_K$. This is an isogeny of degree $p$.\n4.  The kernel of $\\phi_K$, let's call it $G_K$, is a cyclic subgroup of $E_K$ of order $p$. By construction, $(E_K)/G_K \\cong E'$.\n5.  We need to find a subgroup $C_K \\subset E_K$ such that $\\phi_K(C_K) = C'$. Since the degree of $\\phi_K$ is $p$ and $p \\nmid N$, the isogeny $\\phi_K$ acts as an isomorphism on subgroups of order $N$. Thus, there exists a unique cyclic subgroup $C_K \\subset E_K$ of order $N$ given by $C_K = \\phi_K^{-1}(C')$.\n6.  With these definitions, the triple $(E_K, C_K, G_K)$ maps under $p_2$ to $[(E_K/G_K, (C_K+G_K)/G_K)]$. The isogeny $\\phi_K$ provides the isomorphism $E_K/G_K \\cong E'$. Under this isomorphism, the subgroup $(C_K+G_K)/G_K \\cong \\phi_K(C_K)$ is mapped to $C'$. Thus, we have constructed a point in the fiber of $p_2$.\n\nThis construction establishes a one-to-one correspondence between the cyclic subgroups $K$ of order $p$ in $E'$ and the points in the fiber of $p_2$ over $[(E',C')]$. Since there are $p+1$ such subgroups, the size of the fiber is $p+1$.\n$$ \\deg(p_{2}) = p+1 $$\n\nThe degrees of the finite maps $p_1$ and $p_2$ coincide because their computation, from first principles, reduces to the same combinatorial problem: counting the number of cyclic subgroups of order $p$ within an elliptic curve. The degree of $p_1$ is the number of such subgroups in the source curve $E$. The degree of $p_2$, through the lens of dual isogenies, is the number of such subgroups in the target curve $E'$. In both cases, the structure of the $p$-torsion group $E[p] \\cong (\\mathbb{Z}/p\\mathbb{Z})^2$ dictates that this number is $p+1$.\n\nThe degrees are equal: $\\deg(p_1) = \\deg(p_2) = p+1$. The final answer is this value.", "answer": "$$\\boxed{p+1}$$", "id": "3018113"}, {"introduction": "This final practice reveals the profound payoff of the entire theory: the deep connection between the arithmetic of Hecke eigenforms and the geometry of their associated abelian varieties. The Eichler-Shimura construction provides a bridge from analysis to geometry, and this problem demonstrates how arithmetic data encoded in a newform's Fourier coefficients can determine the structure of the corresponding variety $A_f$ and its endomorphism algebra. This exercise showcases how the spectral theory of Hecke operators becomes a powerful tool in arithmetic geometry. [@problem_id:3018138]", "problem": "Let $N$ be a positive integer and let $f$ be a normalized weight $2$ newform on $X_0(N)$ with trivial nebentypus. Suppose the Fourier coefficients of $f$ generate the real quadratic Hecke field $K=\\mathbb{Q}(\\sqrt{5})$. Assume that $f$ has no Complex Multiplication (CM) and no nontrivial inner twists. Let $J_0(N)$ denote the Jacobian of the modular curve $X_0(N)$ and let $\\mathbb{T}$ denote the full Hecke algebra acting on $J_0(N)$. Let $A_f$ be the $f$-isotypic abelian subvariety of $J_0(N)$ associated to $f$ via the Eichler–Shimura construction.\n\nStarting from fundamental facts about the Hecke action on $J_0(N)$, the Eichler–Shimura construction, multiplicity one for Hecke eigenforms, and the classification of endomorphism algebras of simple abelian varieties up to isogeny, perform the following:\n\n- Derive the isogeny decomposition structure of $A_f$ over $\\mathbb{Q}$, i.e., determine whether $A_f$ is $\\mathbb{Q}$-simple or isogenous to a power $B^m$ of a lower-dimensional simple abelian variety $B$.\n- Determine the $\\mathbb{Q}$-algebra $\\mathrm{End}^0(A_f)=\\mathrm{End}_{\\mathbb{Q}}(A_f)\\otimes_{\\mathbb{Z}}\\mathbb{Q}$.\n\nConclude by computing the dimension $\\dim_{\\mathbb{Q}}\\mathrm{End}^0(A_f)$. Give your final answer as a single integer. No rounding is required.", "solution": "The problem asks for the dimension of the $\\mathbb{Q}$-algebra of endomorphisms of the abelian variety $A_f$ associated with a specific newform $f$.\n\n1.  **Identify the Properties of $A_f$**:\n    The abelian variety $A_f$ is constructed via the Eichler-Shimura correspondence. For a newform $f$ without complex multiplication (CM), a fundamental result by Shimura states that the dimension of $A_f$ over $\\mathbb{C}$ (and thus over $\\mathbb{Q}$) is equal to the degree of the Hecke field $K_f = \\mathbb{Q}(\\{a_n(f)\\}_{n\\ge 1})$ over $\\mathbb{Q}$.\n    Given that $K_f = \\mathbb{Q}(\\sqrt{5})$, we have:\n    $$ \\dim(A_f) = [K_f : \\mathbb{Q}] = [\\mathbb{Q}(\\sqrt{5}) : \\mathbb{Q}] = 2 $$\n\n2.  **Determine the Endomorphism Algebra $\\mathrm{End}^0(A_f)$**:\n    The endomorphism algebra $\\mathrm{End}^0(A_f) = \\mathrm{End}_{\\mathbb{Q}}(A_f) \\otimes_{\\mathbb{Z}} \\mathbb{Q}$ contains the Hecke field $K_f$ as a subalgebra. A deep theorem by Ribet characterizes this algebra precisely under the given conditions. Ribet's theorem states that for a newform $f$ of weight 2 without CM, the algebra $\\mathrm{End}^0_{\\mathbb{Q}}(A_f)$ is isomorphic to the Hecke field $K_f$ if and only if $f$ has no nontrivial inner twists.\n    The problem explicitly states that $f$ has no CM and no nontrivial inner twists. Therefore, we can directly apply Ribet's result to conclude:\n    $$ \\mathrm{End}^0_{\\mathbb{Q}}(A_f) = K_f = \\mathbb{Q}(\\sqrt{5}) $$\n\n3.  **Check the Isogeny Structure**:\n    An abelian variety $A$ is simple over a field $k$ if its endomorphism algebra $\\mathrm{End}_k^0(A)$ is a division algebra. If $A$ is isogenous to a product $B^m$ of a simple abelian variety $B$, then its endomorphism algebra is a matrix algebra $M_m(\\mathrm{End}_k^0(B))$.\n    In our case, $\\mathrm{End}^0_{\\mathbb{Q}}(A_f) = \\mathbb{Q}(\\sqrt{5})$ is a field, which is a division algebra. For this to be isomorphic to a matrix algebra $M_m(D)$, we must have $m=1$ and $D$ must be a field. This confirms that $A_f$ is a simple abelian variety over $\\mathbb{Q}$ and is not isogenous to a power of a lower-dimensional variety.\n\n4.  **Compute the Final Dimension**:\n    The question asks for the dimension of $\\mathrm{End}^0(A_f)$ as a vector space over $\\mathbb{Q}$.\n    $$ \\dim_{\\mathbb{Q}}(\\mathrm{End}^0(A_f)) = \\dim_{\\mathbb{Q}}(\\mathbb{Q}(\\sqrt{5})) $$\n    The field $\\mathbb{Q}(\\sqrt{5})$ is a degree-2 extension of $\\mathbb{Q}$, with a basis given by $\\{1, \\sqrt{5}\\}$.\n    Therefore, its dimension as a $\\mathbb{Q}$-vector space is 2.", "answer": "$$\\boxed{2}$$", "id": "3018138"}]}