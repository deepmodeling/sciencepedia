{"hands_on_practices": [{"introduction": "To build a robust understanding of the analytic class number formula, we first ground our study in the foundational case of the rational numbers, $K = \\mathbb{Q}$. This exercise connects the modern adelic framework of Tate's thesis to the classical Riemann zeta function, $\\zeta(s)$. By explicitly calculating the global zeta integral for a specific Schwartz–Bruhat function and applying the Poisson summation formula, you will derive the residue of $\\zeta(s)$ at $s=1$ from the Tamagawa number of the multiplicative group $\\mathbb{G}_m$, thereby demonstrating the power and consistency of the general theory in a familiar context [@problem_id:3024644].", "problem": "Let $K=\\mathbb{Q}$, let $\\mathbb{A}$ denote the ring of adeles of $\\mathbb{Q}$, and let $\\mathbb{A}^{\\times}$ be the ideles. Fix the standard additive character $\\psi:\\mathbb{A}\\to \\mathbb{C}^{\\times}$ that is trivial on $\\mathbb{Q}$, given at the archimedean place by $\\psi_{\\infty}(x_{\\infty})=\\exp(2\\pi i x_{\\infty})$ and at each finite place $p$ by the unique unramified additive character. Normalize the additive Haar measure $dx=\\prod_{v}dx_{v}$ to be self-dual with respect to $\\psi$, and define the multiplicative Haar measure $d^{\\times}x=\\prod_{v}d^{\\times}x_{v}$ so that at each finite place $p$ one has $\\int_{\\mathbb{Z}_{p}^{\\times}} d^{\\times}x_{p}=1$, and at the archimedean place $d^{\\times}x_{\\infty}=dx_{\\infty}/|x_{\\infty}|_{\\infty}$. Let $\\mathcal{S}(\\mathbb{A})$ be the Schwartz–Bruhat space on $\\mathbb{A}$, and let $\\widehat{\\phi}$ denote the Fourier transform of $\\phi\\in\\mathcal{S}(\\mathbb{A})$ with respect to $\\psi$ and the chosen self-dual measure.\n\nConsider the function $\\phi=\\phi_{\\infty}\\otimes\\bigotimes_{p}\\phi_{p}\\in\\mathcal{S}(\\mathbb{A})$ defined by $\\phi_{\\infty}(x_{\\infty})=\\exp(-\\pi x_{\\infty}^{2})$ and $\\phi_{p}=\\mathbf{1}_{\\mathbb{Z}_{p}}$. For $\\operatorname{Re}(s)1$, define the global Tate zeta integral\n$$\nZ(\\phi,s)\\;=\\;\\int_{\\mathbb{A}^{\\times}}\\phi(x)\\,|x|_{\\mathbb{A}}^{s}\\,d^{\\times}x\\,.\n$$\nUsing only the foundational definitions above (adeles, ideles, Haar measures, Fourier transform, and Poisson summation on $\\mathbb{Q}\\subset\\mathbb{A}$) and the following widely accepted facts:\n- the product formula for $\\mathbb{Q}$,\n- the Euler factorization of $Z(\\phi,s)$ into local zeta integrals when $\\phi$ is a pure tensor,\n- the Poisson summation formula on $\\mathbb{A}$ for $\\mathbb{Q}$ with self-dual measures,\n- the Tamagawa number $\\tau(\\mathbb{G}_{m})$ of the multiplicative group $\\mathbb{G}_{m}$ over $\\mathbb{Q}$ equals $1$,\nderive, from first principles, the polar behavior of $Z(\\phi,s)$ at $s=1$ and relate it to the residue at $s=1$ of the Riemann zeta function $\\zeta(s)$.\n\nConcretely, carry out the following steps within your derivation:\n1. Factor $Z(\\phi,s)$ as a product of local integrals $Z_{v}(\\phi_{v},s)=\\int_{\\mathbb{Q}_{v}^{\\times}}\\phi_{v}(x_{v})\\,|x_{v}|_{v}^{s}\\,d^{\\times}x_{v}$ and compute each factor explicitly for $v=p$ and for $v=\\infty$ with the normalizations above.\n2. Using the Poisson summation formula on $\\mathbb{A}$ applied to $\\phi$ and the multiplicative decomposition of $\\mathbb{A}^{\\times}$ by idelic norm, show that the meromorphic continuation of $Z(\\phi,s)$ has a simple pole at $s=1$ whose residue equals $\\tau(\\mathbb{G}_{m})\\cdot\\phi(0)$.\n3. Combine your results and use $\\tau(\\mathbb{G}_{m})=1$ and the value of the archimedean factor at $s=1$ to determine the value of $\\operatorname{Res}_{s=1}\\zeta(s)$.\n\nYour final answer must be a single real number, given in exact form (no approximation). If you perform any approximations en route, clearly justify that they do not affect the exact final value. State only the final numerical value in your answer.", "solution": "The problem requires the derivation of the residue of the Riemann zeta function at $s=1$ by analyzing the Tate zeta integral $Z(\\phi,s)$ for a specific function $\\phi \\in \\mathcal{S}(\\mathbb{A})$ over the field of rational numbers $K=\\mathbb{Q}$. The derivation will proceed in three steps as outlined in the problem description.\n\nThe Tate zeta integral is defined for $\\operatorname{Re}(s)1$ as\n$$\nZ(\\phi,s)\\;=\\;\\int_{\\mathbb{A}^{\\times}}\\phi(x)\\,|x|_{\\mathbb{A}}^{s}\\,d^{\\times}x\n$$\nwhere $\\mathbb{A}$ is the adele ring of $\\mathbb{Q}$, $\\mathbb{A}^{\\times}$ is the idele group, $|x|_{\\mathbb{A}}$ is the adelic norm, and $d^{\\times}x$ is the multiplicative Haar measure with the specified normalizations. The function $\\phi$ is the pure tensor $\\phi=\\phi_{\\infty}\\otimes\\bigotimes_{p}\\phi_{p}$ with $\\phi_{\\infty}(x_{\\infty})=\\exp(-\\pi x_{\\infty}^{2})$ and $\\phi_{p}=\\mathbf{1}_{\\mathbb{Z}_{p}}$.\n\n**Step 1: Euler Factorization and Computation of Local Integrals**\n\nFor a pure tensor function $\\phi = \\bigotimes_{v} \\phi_v$, the global zeta integral factors into a product of local zeta integrals over all places $v$ of $\\mathbb{Q}$:\n$$\nZ(\\phi,s) = \\prod_{v} Z_{v}(\\phi_{v},s) \\quad \\text{where} \\quad Z_{v}(\\phi_{v},s)=\\int_{\\mathbb{Q}_{v}^{\\times}}\\phi_{v}(x_{v})\\,|x_{v}|_{v}^{s}\\,d^{\\times}x_{v}\n$$\nWe compute these local integrals for the archimedean place $v=\\infty$ and the finite places $v=p$.\n\nFor the archimedean place $v=\\infty$, $\\mathbb{Q}_\\infty = \\mathbb{R}$. We have $\\phi_{\\infty}(x_{\\infty})=\\exp(-\\pi x_{\\infty}^{2})$ and the measure is $d^{\\times}x_{\\infty} = dx_{\\infty}/|x_{\\infty}|_{\\infty}$. The absolute value is the standard one, $|x|_\\infty = |x|$.\n\\begin{align*}\nZ_{\\infty}(\\phi_{\\infty},s) = \\int_{\\mathbb{R}^{\\times}} \\exp(-\\pi x_{\\infty}^{2}) |x_{\\infty}|^{s} \\frac{dx_{\\infty}}{|x_{\\infty}|} \\\\\n= \\int_{-\\infty}^{\\infty} \\exp(-\\pi x_{\\infty}^{2}) |x_{\\infty}|^{s-1} dx_{\\infty} \\\\\n= 2 \\int_{0}^{\\infty} \\exp(-\\pi x^{2}) x^{s-1} dx\n\\end{align*}\nWe perform the substitution $u = \\pi x^{2}$, which implies $x = (u/\\pi)^{1/2}$ and $dx = \\frac{1}{2\\sqrt{\\pi u}}du$.\n\\begin{align*}\nZ_{\\infty}(\\phi_{\\infty},s) = 2 \\int_{0}^{\\infty} e^{-u} \\left(\\frac{u}{\\pi}\\right)^{(s-1)/2} \\frac{1}{2\\sqrt{\\pi u}} du \\\\\n= \\frac{1}{\\pi^{(s-1)/2}} \\frac{1}{\\sqrt{\\pi}} \\int_{0}^{\\infty} e^{-u} u^{(s-1)/2} u^{-1/2} du \\\\\n= \\pi^{-s/2} \\int_{0}^{\\infty} e^{-u} u^{s/2 - 1} du \\\\\n= \\pi^{-s/2} \\Gamma\\left(\\frac{s}{2}\\right)\n\\end{align*}\nwhere $\\Gamma(z)$ is the gamma function. This is the archimedean factor of the completed Riemann zeta function.\n\nFor a finite place $v=p$, $\\mathbb{Q}_p$ is the field of $p$-adic numbers. We have $\\phi_{p}(x_{p})=\\mathbf{1}_{\\mathbb{Z}_{p}}(x_p)$, the characteristic function of the $p$-adic integers $\\mathbb{Z}_p$. The integral is over $\\mathbb{Q}_p^\\times$. Since $\\phi_p$ is supported on $\\mathbb{Z}_p$, the integral is restricted to $\\mathbb{Z}_p \\setminus \\{0\\}$. We decompose this set into disjoint annuli: $\\mathbb{Z}_p \\setminus \\{0\\} = \\bigsqcup_{k=0}^{\\infty} p^k \\mathbb{Z}_p^\\times$.\n\\begin{align*}\nZ_{p}(\\phi_{p},s) = \\int_{\\mathbb{Z}_{p} \\setminus \\{0\\}} |x_{p}|_{p}^{s} d^{\\times}x_{p} \\\\\n= \\sum_{k=0}^{\\infty} \\int_{p^k \\mathbb{Z}_p^\\times} |x_{p}|_{p}^{s} d^{\\times}x_{p}\n\\end{align*}\nFor any $x_p \\in p^k \\mathbb{Z}_p^\\times$, $|x_p|_p = p^{-k}$. The measure $d^\\times x_p$ is translation invariant on the multiplicative group $\\mathbb{Q}_p^\\times$, so $\\int_{p^k \\mathbb{Z}_p^\\times} d^{\\times}x_{p} = \\int_{\\mathbb{Z}_p^\\times} d^{\\times}x_{p}$. The problem states this measure is normalized so that $\\int_{\\mathbb{Z}_p^\\times} d^{\\times}x_{p} = 1$.\nThus,\n$$\nZ_{p}(\\phi_{p},s) = \\sum_{k=0}^{\\infty} (p^{-k})^{s} \\cdot 1 = \\sum_{k=0}^{\\infty} (p^{-s})^{k}\n$$\nThis is a geometric series which converges for $\\operatorname{Re}(s)0$ (and specifically for our initial domain $\\operatorname{Re}(s)1$) to:\n$$\nZ_{p}(\\phi_{p},s) = \\frac{1}{1-p^{-s}}\n$$\nThis is the Euler $p$-factor of the Riemann zeta function.\n\nCombining all local factors, we obtain the global zeta integral:\n$$\nZ(\\phi,s) = Z_{\\infty}(\\phi_{\\infty},s) \\prod_{p} Z_{p}(\\phi_{p},s) = \\pi^{-s/2} \\Gamma\\left(\\frac{s}{2}\\right) \\prod_{p} \\frac{1}{1-p^{-s}}\n$$\nThe product over all primes is the definition of the Riemann zeta function $\\zeta(s)$. Therefore, for $\\operatorname{Re}(s)1$,\n$$\nZ(\\phi,s) = \\pi^{-s/2} \\Gamma\\left(\\frac{s}{2}\\right) \\zeta(s)\n$$\nThis expression relates the Tate zeta integral for our choice of $\\phi$ to the completed Riemann zeta function.\n\n**Step 2: Meromorphic Continuation and Pole Structure**\n\nThe general theory of Tate's thesis, which relies fundamentally on the Poisson summation formula on the adele group $\\mathbb{A}$ with respect to the discrete subgroup $\\mathbb{Q}$, establishes the meromorphic continuation of $Z(\\phi,s)$ to the entire complex plane. The theory states that $Z(\\phi,s)$ is holomorphic everywhere except for simple poles at $s=0$ and $s=1$. The residues are given by:\n\\begin{align*}\n\\operatorname{Res}_{s=1} Z(\\phi, s) = \\widehat{\\phi}(0) \\cdot \\tau(\\mathbb{G}_{m}) \\\\\n\\operatorname{Res}_{s=0} Z(\\phi, s) = -\\phi(0) \\cdot \\tau(\\mathbb{G}_{m})\n\\end{align*}\nwhere $\\tau(\\mathbb{G}_{m}) = \\operatorname{vol}(\\mathbb{A}^{\\times,1}/\\mathbb{Q}^\\times)$ is the Tamagawa number of the multiplicative group $\\mathbb{G}_m$ over $\\mathbb{Q}$ with respect to the measure induced by the chosen Haar measures. The problem postulates this fact as derived from Poisson summation.\n\nThe derivation of the problem's claim that the residue at $s=1$ is $\\tau(\\mathbb{G}_{m})\\cdot\\phi(0)$ requires showing $\\widehat{\\phi}(0) = \\phi(0)$. Let us verify this for the given $\\phi$.\nFirst, we compute $\\phi(0)$:\n$$\n\\phi(0) = \\phi_{\\infty}(0) \\prod_{p} \\phi_{p}(0) = \\exp(-\\pi \\cdot 0^2) \\prod_{p} \\mathbf{1}_{\\mathbb{Z}_{p}}(0) = 1 \\cdot \\prod_{p} 1 = 1\n$$\nNext, we compute the Fourier transform $\\widehat{\\phi} = \\bigotimes_v \\widehat{\\phi}_v$.\nFor $v=\\infty$, the Fourier transform of $\\phi_\\infty(x) = \\exp(-\\pi x^2)$ with respect to the character $\\psi_\\infty(y) = \\exp(2\\pi i y)$ is well-known to be itself:\n$$\n\\widehat{\\phi}_{\\infty}(y) = \\int_{\\mathbb{R}} \\exp(-\\pi x^2) \\exp(2\\pi i xy) dx = \\exp(-\\pi y^2) = \\phi_{\\infty}(y)\n$$\nFor a finite place $v=p$, the Fourier transform of $\\phi_p = \\mathbf{1}_{\\mathbb{Z}_p}$ is computed with respect to the self-dual measure $dx_p$ (for which $\\int_{\\mathbb{Z}_p} dx_p = 1$) and the character $\\psi_p$.\n$$\n\\widehat{\\phi}_{p}(y) = \\int_{\\mathbb{Q}_p} \\mathbf{1}_{\\mathbb{Z}_p}(x) \\psi_p(xy) dx_p = \\int_{\\mathbb{Z}_p} \\psi_p(xy) dx_p\n$$\nIf $y \\in \\mathbb{Z}_p$, then for any $x \\in \\mathbb{Z}_p$, the product $xy \\in \\mathbb{Z}_p$. Since $\\psi_p$ is unramified (trivial on $\\mathbb{Z}_p$), $\\psi_p(xy)=1$. The integral becomes $\\int_{\\mathbb{Z}_p} 1 \\, dx_p = 1 = \\phi_p(y)$.\nIf $y \\notin \\mathbb{Z}_p$, the map $x \\mapsto \\psi_p(xy)$ is a non-trivial character of the compact additive group $\\mathbb{Z}_p$, so its integral is $0$. In this case, $\\phi_p(y) = \\mathbf{1}_{\\mathbb{Z}_p}(y) = 0$.\nThus, $\\widehat{\\phi}_{p}(y) = \\phi_{p}(y)$ for all $y \\in \\mathbb{Q}_p$.\nSince $\\widehat{\\phi}_v = \\phi_v$ for all places $v$, we have $\\widehat{\\phi} = \\phi$. Consequently, $\\widehat{\\phi}(0) = \\phi(0) = 1$.\nThe general residue formula for $s=1$ then becomes:\n$$\n\\operatorname{Res}_{s=1} Z(\\phi, s) = \\widehat{\\phi}(0) \\cdot \\tau(\\mathbb{G}_{m}) = \\phi(0) \\cdot \\tau(\\mathbb{G}_{m})\n$$\nas claimed in the problem statement.\n\n**Step 3: Determination of the Residue of the Riemann Zeta Function**\n\nNow we combine the results from the previous two steps.\nFrom Step 2, using the value $\\phi(0)=1$ and the given fact $\\tau(\\mathbb{G}_{m})=1$, we find the residue of the Tate integral:\n$$\n\\operatorname{Res}_{s=1} Z(\\phi, s) = 1 \\cdot 1 = 1\n$$\nFrom Step 1, we have the expression $Z(\\phi,s) = \\pi^{-s/2} \\Gamma(s/2) \\zeta(s)$. We can compute the residue of this product at $s=1$. The function $\\zeta(s)$ has a simple pole at $s=1$, while the factor $f(s) = \\pi^{-s/2} \\Gamma(s/2)$ is analytic and non-zero at $s=1$. The residue of the product is therefore the value of the analytic part at $s=1$ multiplied by the residue of the pole part:\n\\begin{align*}\n\\operatorname{Res}_{s=1} Z(\\phi, s) = \\operatorname{Res}_{s=1} \\left( \\left(\\pi^{-s/2} \\Gamma\\left(\\frac{s}{2}\\right)\\right) \\zeta(s) \\right) \\\\\n= \\left(\\lim_{s\\to 1} \\pi^{-s/2} \\Gamma\\left(\\frac{s}{2}\\right)\\right) \\cdot \\left(\\operatorname{Res}_{s=1} \\zeta(s)\\right)\n\\end{align*}\nWe evaluate the limit of the analytic factor:\n$$\n\\lim_{s\\to 1} \\pi^{-s/2} \\Gamma\\left(\\frac{s}{2}\\right) = \\pi^{-1/2} \\Gamma\\left(\\frac{1}{2}\\right)\n$$\nUsing the well-known value $\\Gamma(1/2) = \\sqrt{\\pi}$, this becomes:\n$$\n\\pi^{-1/2} \\cdot \\sqrt{\\pi} = 1\n$$\nTherefore, we have\n$$\n\\operatorname{Res}_{s=1} Z(\\phi, s) = 1 \\cdot \\operatorname{Res}_{s=1} \\zeta(s) = \\operatorname{Res}_{s=1} \\zeta(s)\n$$\nEquating our two computations for the residue of $Z(\\phi,s)$ at $s=1$:\n$$\n\\operatorname{Res}_{s=1} \\zeta(s) = 1\n$$\nThis concludes the derivation. The residue of the Riemann zeta function at $s=1$ is $1$.", "answer": "$$\\boxed{1}$$", "id": "3024644"}, {"introduction": "Having established the theoretical framework, we now move to a complete, concrete application: the calculation of the class number for a real quadratic field. This practice is a classic exercise that synthesizes the core components of the analytic class number formula. You will determine the fundamental algebraic invariants of $K = \\mathbb{Q}(\\sqrt{3})$, compute its regulator $R_K$ via the fundamental unit, evaluate the special value of the associated Dirichlet $L$-function $L(1,\\chi_{\\Delta_K})$, and combine these pieces to find the class number $h_K$ [@problem_id:3024661].", "problem": "Let $K=\\mathbb{Q}(\\sqrt{d})$ be a real quadratic field with $d0$ squarefree. Consider the specific case $d=3$. Work from fundamental definitions and well-tested formulas to determine the class number $h_K$.\n\nTasks:\n1. Determine the ring of integers $\\mathcal{O}_K$ of $K$ and its discriminant $\\Delta_K$.\n2. Using the continued fraction method for $\\sqrt{d}$ or Pell-type arguments, find the minimal positive integer solution $(x,y)$ to $x^{2}-d y^{2}=1$ for $d=3$, and thereby a fundamental unit $\\varepsilon \\in \\mathcal{O}_K^{\\times}$ with $N_{K/\\mathbb{Q}}(\\varepsilon)=1$. Compute the regulator $R_K=\\log \\varepsilon$.\n3. Let $\\chi_{\\Delta_K}$ be the primitive quadratic Dirichlet character (Kronecker symbol) modulo $|\\Delta_K|$ associated to $K$, and let $L(s,\\chi_{\\Delta_K})$ be its Dirichlet $L$-function. Evaluate $L(1,\\chi_{\\Delta_K})$ from its Dirichlet series definition by organizing the series according to residue classes modulo $|\\Delta_K|$.\n4. Use the analytic class number formula to determine $h_K$ from your computed regulator and $L(1,\\chi_{\\Delta_K})$. Express your final answer as a single integer.\n\nNote: Do not assume or quote any specialized closed-form identities for $L(1,\\chi_{\\Delta_K})$ beyond its defining Dirichlet series and standard properties of Dirichlet characters. You may use the factorization $\\zeta_K(s)=\\zeta(s)\\,L(s,\\chi_{\\Delta_K})$ and the general residue formula for the Dedekind zeta function at $s=1$ in terms of $h_K$ and the regulator. No rounding instruction is necessary since the final answer is an integer.", "solution": "The problem is subjected to validation and is deemed valid as it is scientifically grounded in algebraic number theory, well-posed, and objective. It consists of a standard, verifiable calculation. We proceed with the solution by following the four specified tasks.\n\nThe problem centers on the real quadratic field $K = \\mathbb{Q}(\\sqrt{d})$ for the specific case where $d=3$.\n\nTask 1: Determination of the ring of integers $\\mathcal{O}_K$ and discriminant $\\Delta_K$.\nFor a quadratic field $K = \\mathbb{Q}(\\sqrt{d})$ where $d$ is a squarefree integer, the ring of integers $\\mathcal{O}_K$ is given by $\\mathbb{Z}[\\omega]$, where $\\omega = \\sqrt{d}$ if $d \\equiv 2$ or $3 \\pmod 4$, and $\\omega = \\frac{1+\\sqrt{d}}{2}$ if $d \\equiv 1 \\pmod 4$. The field discriminant $\\Delta_K$ is $4d$ in the first case and $d$ in the second.\nIn our case, $d=3$, which satisfies $3 \\equiv 3 \\pmod 4$. Therefore, the ring of integers of $K = \\mathbb{Q}(\\sqrt{3})$ is $\\mathcal{O}_K = \\mathbb{Z}[\\sqrt{3}]$. The discriminant is $\\Delta_K = 4d = 4 \\times 3 = 12$.\n\nTask 2: Computation of the fundamental unit $\\varepsilon$ and the regulator $R_K$.\nThe fundamental unit of a real quadratic field is related to the minimal positive integer solution of a Pell's equation. For $K = \\mathbb{Q}(\\sqrt{3})$, we analyze the equation $x^2 - 3y^2 = \\pm 1$. The problem suggests using the continued fraction expansion of $\\sqrt{3}$.\nThe expansion is:\n$$ \\sqrt{3} = 1 + (\\sqrt{3}-1) = 1 + \\frac{1}{\\frac{1}{\\sqrt{3}-1}} = 1 + \\frac{1}{\\frac{\\sqrt{3}+1}{2}} = 1 + \\frac{1}{1 + \\frac{\\sqrt{3}-1}{2}} = 1 + \\frac{1}{1 + \\frac{1}{\\sqrt{3}+1}} = 1 + \\frac{1}{1 + \\frac{1}{2 + (\\sqrt{3}-1)}} $$\nThe process repeats, so the continued fraction expansion of $\\sqrt{3}$ is periodic: $\\sqrt{3} = [1; \\overline{1, 2}]$. The period length is $r=2$. The convergents are $c_0 = \\frac{1}{1}$, $c_1 = 1+\\frac{1}{1} = \\frac{2}{1}$, $c_2 = 1+\\frac{1}{1+\\frac{1}{2}} = \\frac{5}{3}$, and so on.\nThe fundamental solution $(x,y)$ to $x^2 - 3y^2 = (-1)^r = (-1)^2 = 1$ is given by the numerator and denominator of the $(r-1)$-th convergent, which is $c_{2-1}=c_1=2/1$. Thus, the minimal positive integer solution is $(x,y)=(2,1)$. A quick check confirms that $2^2 - 3(1^2) = 4-3=1$.\nThe units in $\\mathcal{O}_K = \\mathbb{Z}[\\sqrt{3}]$ are of the form $a+b\\sqrt{3}$ where $a,b \\in \\mathbb{Z}$ and $N_{K/\\mathbb{Q}}(a+b\\sqrt{3}) = a^2-3b^2 = \\pm 1$. The equation $a^2-3b^2 = -1$ has no integer solutions, as this would imply $a^2 \\equiv -1 \\pmod 3$, which is impossible. Therefore, all units have norm $1$. The fundamental unit $\\varepsilon$ is the smallest unit greater than $1$. It corresponds to the minimal positive solution of $x^2 - 3y^2 = 1$, so $\\varepsilon = 2+\\sqrt{3}$.\nThe regulator of $K$ is defined as $R_K = \\ln|\\varepsilon_{fund}|$, where $\\varepsilon_{fund}$ is the fundamental unit. For $K=\\mathbb{Q}(\\sqrt{3})$, we have one fundamental unit $\\varepsilon = 2+\\sqrt{3}$, so the regulator is $R_K = \\ln(2+\\sqrt{3})$.\n\nTask 3: Evaluation of $L(1, \\chi_{\\Delta_K})$.\nThe discriminant is $\\Delta_K = 12$. The associated primitive quadratic Dirichlet character is the Kronecker symbol $\\chi_{12}(n) = (\\frac{12}{n})$. The conductor of this character is $12$. Its values for $n$ coprime to $12$ are:\n$\\chi_{12}(1) = (\\frac{12}{1}) = 1$\n$\\chi_{12}(5) = (\\frac{12}{5}) = (\\frac{2}{5}) = -1$\n$\\chi_{12}(7) = (\\frac{12}{7}) = (\\frac{5}{7}) = -1$\n$\\chi_{12}(11) = (\\frac{12}{11}) = (\\frac{1}{11}) = 1$\nFor any integer $n$ not coprime to $12$, $\\chi_{12}(n)=0$.\nThe Dirichlet $L$-function is $L(s, \\chi_{12}) = \\sum_{n=1}^{\\infty} \\frac{\\chi_{12}(n)}{n^s}$. We must evaluate this at $s=1$.\n$$ L(1, \\chi_{12}) = \\sum_{n=1}^{\\infty} \\frac{\\chi_{12}(n)}{n} = 1 - \\frac{1}{5} - \\frac{1}{7} + \\frac{1}{11} + \\frac{1}{13} - \\frac{1}{17} - \\frac{1}{19} + \\frac{1}{23} - \\dots $$\nWe can group the terms based on their residues modulo $12$:\n$$ L(1, \\chi_{12}) = \\sum_{k=0}^{\\infty} \\left( \\frac{1}{12k+1} - \\frac{1}{12k+5} - \\frac{1}{12k+7} + \\frac{1}{12k+11} \\right) $$\nUsing the identity $\\frac{1}{m} = \\int_0^1 x^{m-1} dx$, we can write the sum as an integral:\n$$ L(1, \\chi_{12}) = \\int_0^1 \\sum_{k=0}^{\\infty} \\left( x^{12k} - x^{12k+4} - x^{12k+6} + x^{12k+10} \\right) dx $$\nSumming the geometric series inside the integral gives:\n$$ L(1, \\chi_{12}) = \\int_0^1 \\frac{1-x^4-x^6+x^{10}}{1-x^{12}} dx = \\int_0^1 \\frac{(1-x^4)(1-x^6)}{(1-x^6)(1+x^6)} dx = \\int_0^1 \\frac{1-x^4}{1+x^6} dx $$\nThe denominator can be factored as $1+x^6 = (1+x^2)(1-x^2+x^4)$. The integrand becomes:\n$$ \\frac{(1-x^2)(1+x^2)}{(1+x^2)(x^4-x^2+1)} = \\frac{1-x^2}{x^4-x^2+1} $$\nSo we evaluate $I = \\int_0^1 \\frac{1-x^2}{x^4-x^2+1} dx$. We divide the numerator and denominator by $x^2$:\n$$ I = \\int_0^1 \\frac{\\frac{1}{x^2}-1}{x^2-1+\\frac{1}{x^2}} dx = \\int_0^1 \\frac{\\frac{1}{x^2}-1}{\\left(x+\\frac{1}{x}\\right)^2-3} dx $$\nLet $t = x+\\frac{1}{x}$. Then $dt = (1-\\frac{1}{x^2})dx$. The limits of integration for $t$ are from $x=0^+$ to $x=1$. As $x \\to 0^+$, $t \\to \\infty$. As $x \\to 1$, $t \\to 2$.\n$$ I = \\int_{\\infty}^{2} \\frac{-dt}{t^2-3} = \\int_2^{\\infty} \\frac{dt}{t^2-3} $$\nUsing partial fraction decomposition, $\\frac{1}{t^2-3} = \\frac{1}{2\\sqrt{3}}\\left(\\frac{1}{t-\\sqrt{3}}-\\frac{1}{t+\\sqrt{3}}\\right)$.\n$$ I = \\frac{1}{2\\sqrt{3}} \\left[ \\ln|t-\\sqrt{3}| - \\ln|t+\\sqrt{3}| \\right]_2^{\\infty} = \\frac{1}{2\\sqrt{3}} \\left[ \\ln\\left|\\frac{t-\\sqrt{3}}{t+\\sqrt{3}}\\right| \\right]_2^{\\infty} $$\nEvaluating at the limits:\n$$ I = \\lim_{t\\to\\infty} \\frac{1}{2\\sqrt{3}} \\ln\\left|\\frac{1-\\frac{\\sqrt{3}}{t}}{1+\\frac{\\sqrt{3}}{t}}\\right| - \\frac{1}{2\\sqrt{3}} \\ln\\left(\\frac{2-\\sqrt{3}}{2+\\sqrt{3}}\\right) = 0 - \\frac{1}{2\\sqrt{3}} \\ln\\left(\\frac{(2-\\sqrt{3})^2}{4-3}\\right) $$\n$$ I = -\\frac{1}{2\\sqrt{3}} \\ln\\left((2-\\sqrt{3})^2\\right) = -\\frac{2}{2\\sqrt{3}} \\ln(2-\\sqrt{3}) = -\\frac{1}{\\sqrt{3}} \\ln\\left(\\frac{1}{2+\\sqrt{3}}\\right) = \\frac{\\ln(2+\\sqrt{3})}{\\sqrt{3}} $$\nThus, $L(1, \\chi_{12}) = \\frac{\\ln(2+\\sqrt{3})}{\\sqrt{3}}$.\n\nTask 4: Calculation of the class number $h_K$.\nThe analytic class number formula states that the residue of the Dedekind zeta function $\\zeta_K(s)$ at $s=1$ is given by:\n$$ \\lim_{s\\to 1} (s-1)\\zeta_K(s) = \\frac{2^{r_1}(2\\pi)^{r_2}h_K R_K}{w_K\\sqrt{|\\Delta_K|}} $$\nFor $K=\\mathbb{Q}(\\sqrt{3})$, we have two real embeddings and no complex embeddings, so $r_1=2$ and $r_2=0$. The number of roots of unity in a real quadratic field is $w_K=2$ (namely $\\pm 1$). We have $\\Delta_K = 12$ and $R_K = \\ln(2+\\sqrt{3})$.\nSubstituting these values into the formula:\n$$ \\operatorname{Res}_{s=1}(\\zeta_K(s)) = \\frac{2^2 (2\\pi)^0 h_K \\ln(2+\\sqrt{3})}{2\\sqrt{12}} = \\frac{4 h_K \\ln(2+\\sqrt{3})}{2(2\\sqrt{3})} = \\frac{h_K \\ln(2+\\sqrt{3})}{\\sqrt{3}} $$\nThe problem provides the factorization $\\zeta_K(s) = \\zeta(s) L(s, \\chi_{\\Delta_K})$. Taking the residue at $s=1$:\n$$ \\operatorname{Res}_{s=1}(\\zeta_K(s)) = \\lim_{s\\to 1} (s-1)\\zeta(s) L(s, \\chi_{\\Delta_K}) = \\left(\\lim_{s\\to 1} (s-1)\\zeta(s)\\right) \\left(\\lim_{s\\to 1} L(s, \\chi_{\\Delta_K})\\right) $$\nSince the residue of the Riemann zeta function $\\zeta(s)$ at $s=1$ is $1$, and $L(s, \\chi_{12})$ is continuous at $s=1$, this simplifies to:\n$$ \\operatorname{Res}_{s=1}(\\zeta_K(s)) = 1 \\cdot L(1, \\chi_{12}) = L(1, \\chi_{12}) $$\nEquating the two expressions for the residue:\n$$ \\frac{h_K \\ln(2+\\sqrt{3})}{\\sqrt{3}} = L(1, \\chi_{12}) $$\nSubstituting our computed value for $L(1, \\chi_{12})$:\n$$ \\frac{h_K \\ln(2+\\sqrt{3})}{\\sqrt{3}} = \\frac{\\ln(2+\\sqrt{3})}{\\sqrt{3}} $$\nSince $\\ln(2+\\sqrt{3}) \\neq 0$, we can cancel the term $\\frac{\\ln(2+\\sqrt{3})}{\\sqrt{3}}$ from both sides, which yields:\n$$ h_K = 1 $$\nThe class number of the field $\\mathbb{Q}(\\sqrt{3})$ is $1$.", "answer": "$$\\boxed{1}$$", "id": "3024661"}, {"introduction": "The analytic class number formula provides a profound link between algebraic invariants and the value of an analytic function, often an $L$-series at $s=1$. This final practice bridges the gap between theoretical expressions and practical computation. You will develop an algorithm to approximate the value of $L(1, \\chi_d)$ by truncating its defining series and rigorously bound the truncation error using the Pólya–Vinogradov inequality, gaining insight into the \"analytic\" nature of the formula and the numerical methods essential for its application [@problem_id:3024687].", "problem": "Consider the real-valued Dirichlet series at the point $s=1$ attached to the primitive quadratic Dirichlet character $\\chi_d$ associated to a fundamental discriminant $d \\in \\mathbb{Z}$. The Dirichlet series is defined by the series $L(1,\\chi_d) = \\sum_{n \\ge 1} \\chi_d(n) n^{-1}$, where $\\chi_d(n)$ is the quadratic character given by the Kronecker symbol $(d/n)$.\n\nYour task is to design an algorithm that approximates $L(1,\\chi_d)$ by truncating the series at a finite cutoff $N$ and to bound the truncation error using partial summation together with a uniform estimate for the character sum $S(x) = \\sum_{n \\le x} \\chi_d(n)$.\n\nThe requirements are:\n\n1. Use the Kronecker symbol $(d/n)$ to define $\\chi_d(n)$ for $n \\in \\mathbb{Z}_{\\ge 1}$ and fundamental discriminant $d$. You may rely on the standard properties of the Kronecker symbol, including its multiplicativity, its extension of the Jacobi symbol on odd moduli, and the evaluation at the prime $2$ via residue classes modulo $8$.\n\n2. Let $q$ denote the conductor of $\\chi_d$. For fundamental discriminants $d$, you may take $q = |d|$. Define $S(x) = \\sum_{n \\le x} \\chi_d(n)$ and use partial summation to express the tail\n   $$\\sum_{n  N} \\frac{\\chi_d(n)}{n}$$\n   in terms of $S(x)$. Then, using a well-tested estimate for character sums (the Pólya–Vinogradov inequality), adopt the explicit bound\n   $$|S(x)| \\le C \\sqrt{q} \\log q \\quad \\text{for all } x \\ge 1,$$\n   with a fixed numerical constant $C = 2$. Deduce from partial summation that the truncation error is bounded by\n   $$\\left|\\sum_{n  N} \\frac{\\chi_d(n)}{n}\\right| \\le \\frac{C \\sqrt{q} \\log q}{N}.$$\n\n3. Implement an efficient computation of the truncated sum\n   $$L_N(1,\\chi_d) = \\sum_{n=1}^{N} \\frac{\\chi_d(n)}{n},$$\n   leveraging the periodicity of $\\chi_d$ modulo $q$ to reduce computational cost. Your implementation must handle both negative (imaginary quadratic) and positive (real quadratic) fundamental discriminants.\n\n4. For each test case $(d,N)$ in the test suite below, compute two quantities:\n   - The truncated approximation $L_N(1,\\chi_d)$ as a floating point number.\n   - The rigorous upper bound $E(d,N) = C \\sqrt{q} \\log q / N$ on the truncation error as a floating point number.\n\n5. Test suite:\n   - $(d,N) = (-4, 100000)$\n   - $(d,N) = (-7, 200000)$\n   - $(d,N) = (5, 200000)$\n   - $(d,N) = (8, 250000)$\n   - $(d,N) = (-163, 800000)$\n   - $(d,N) = (-3, 300000)$\n\n6. Final output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the precise order of the test suite above, where for each test case you output the pair $(L_N(1,\\chi_d), E(d,N))$ flattened into the list. Concretely, the output must have the form\n   $$[L_N(1,\\chi_{-4}),E(-4,100000),L_N(1,\\chi_{-7}),E(-7,200000),\\dots,L_N(1,\\chi_{-3}),E(-3,300000)].$$\nAll numbers must be printed as decimal floating point values with Python's default string conversion. No physical units are involved.", "solution": "The problem is assessed to be valid as it is scientifically grounded in established principles of analytic number theory, is well-posed, and is stated in objective, formal language. The problem requires the implementation of an algorithm to approximate a Dirichlet L-series and to compute an error bound, based on standard mathematical formulas and concepts.\n\n### 1. Theoretical Framework\n\nThe problem revolves around the Dirichlet L-series associated with a primitive quadratic character $\\chi_d$, defined as:\n$$L(s, \\chi_d) = \\sum_{n=1}^{\\infty} \\frac{\\chi_d(n)}{n^s}$$\nWe are interested in the value at $s=1$, i.e., $L(1, \\chi_d)$. The character $\\chi_d$ is associated with a fundamental discriminant $d \\in \\mathbb{Z}$ and is given by the Kronecker symbol $\\chi_d(n) = (d/n)$. For a fundamental discriminant $d$, the conductor of the character $\\chi_d$ is $q = |d|$.\n\n### 2. Truncated Sum and Error Bound\n\nThe value $L(1, \\chi_d)$ is approximated by a truncated sum, or partial sum, up to a cutoff $N$:\n$$L_N(1, \\chi_d) = \\sum_{n=1}^{N} \\frac{\\chi_d(n)}{n}$$\nThe error of this approximation is the tail of the series:\n$$\\text{Error} = L(1, \\chi_d) - L_N(1, \\chi_d) = \\sum_{n=N+1}^{\\infty} \\frac{\\chi_d(n)}{n}$$\nTo bound this error, we use partial summation (also known as Abel's summation formula). Let $S(x) = \\sum_{k=1}^{\\lfloor x \\rfloor} \\chi_d(k)$. The formula states that for a sequence $(a_n)$ and a differentiable function $f(x)$:\n$$\\sum_{n=M+1}^{N} a_n f(n) = S_N f(N) - S_M f(M) - \\int_M^N S(t)f'(t)dt$$\nwhere $S_k = \\sum_{i=1}^k a_i$.\nApplying this to our tail sum with $a_n = \\chi_d(n)$ and $f(n) = 1/n$:\n$$\\sum_{n=N+1}^{\\infty} \\frac{\\chi_d(n)}{n} = \\lim_{M \\to \\infty} \\left( \\frac{S(M)}{M} - \\frac{S(N)}{N} - \\int_{N}^{M} S(t) \\left(-\\frac{1}{t^2}\\right) dt \\right) = -\\frac{S(N)}{N} + \\int_{N}^{\\infty} \\frac{S(t)}{t^2} dt$$\nThis uses the fact that $|S(x)|$ grows slower than $x$, so $\\lim_{M \\to \\infty} S(M)/M = 0$.\n\nThe problem provides the Pólya–Vinogradov inequality to bound the character sum $S(x)$:\n$$|S(x)| = \\left|\\sum_{n=1}^{\\lfloor x \\rfloor} \\chi_d(n)\\right| \\le C \\sqrt{q} \\log q$$\nwith the constant $C=2$ and conductor $q=|d|$. Using this bound, we can estimate the magnitude of the error:\n$$\\left|\\sum_{n  N} \\frac{\\chi_d(n)}{n}\\right| \\le \\left|-\\frac{S(N)}{N}\\right| + \\left|\\int_{N}^{\\infty} \\frac{S(t)}{t^2} dt\\right| \\le \\frac{|S(N)|}{N} + \\int_{N}^{\\infty} \\frac{|S(t)|}{t^2} dt$$\nSubstituting the bound for $|S(t)|$:\n$$\\left|\\sum_{n  N} \\frac{\\chi_d(n)}{n}\\right| \\le \\frac{C \\sqrt{q} \\log q}{N} + \\int_{N}^{\\infty} \\frac{C \\sqrt{q} \\log q}{t^2} dt = \\frac{C \\sqrt{q} \\log q}{N} + C \\sqrt{q} \\log q \\left[-\\frac{1}{t}\\right]_{N}^{\\infty}$$\n$$\\left|\\sum_{n  N} \\frac{\\chi_d(n)}{n}\\right| \\le \\frac{C \\sqrt{q} \\log q}{N} + \\frac{C \\sqrt{q} \\log q}{N} = \\frac{2C \\sqrt{q} \\log q}{N}$$\nThe problem statement provides a slightly tighter bound, $E(d,N) = \\frac{C \\sqrt{q} \\log q}{N}$, which arises from a more careful application of partial summation. We will adhere to the provided formula for the error bound $E(d,N)$.\n\n### 3. Algorithm Design\n\nThe main computational tasks are to compute the truncated sum $L_N(1, \\chi_d)$ and the error bound $E(d,N)$.\n\n#### 3.1. Computing the Character $\\chi_d(n)$\n\nThe character $\\chi_d(n)$ is given by the Kronecker symbol $(d/n)$. For a fundamental discriminant $d$, the character $\\chi_d$ is primitive with conductor $q=|d|$. Its values are determined as follows:\n1.  If $\\gcd(n, q)  1$, then $\\chi_d(n) = 0$.\n2.  If $\\gcd(n, q) = 1$, then $\\chi_d(n)$ is given by the Kronecker symbol $(d/n)$, which is either $1$ or $-1$.\n\nWe implement a function `chi(d, n)` to compute this value. This function first checks if $\\gcd(n, |d|)  1$. If so, it returns $0$. Otherwise, it computes the Kronecker symbol using an iterative algorithm based on the law of quadratic reciprocity and its supplements. The algorithm handles the signs of $d$ and the prime factorization of $n$ (specifically, factors of $2$) to correctly evaluate the symbol.\n\n#### 3.2. Computing the Truncated Sum $L_N(1, \\chi_d)$\n\nA direct summation from $n=1$ to $N$ would require $N$ calls to the `chi(d, n)` function. To optimize this, as suggested by the problem, we leverage the periodicity of the character $\\chi_d$. Since $\\chi_d$ has period $q=|d|$, the value $\\chi_d(n)$ depends only on $n \\pmod q$.\n\nThe algorithm is as follows:\n1.  Set $q = |d|$.\n2.  Pre-compute an array, `chi_values`, of length $q$, where `chi_values[j] = chi(d, j)` for $j \\in \\{0, 1, \\dots, q-1\\}$.\n3.  Initialize a sum `L_N = 0.0$.\n4.  Iterate $n$ from $1$ to $N$. In each step, add `chi_values[n % q] / n` to the sum `L_N`.\n\nThis approach significantly reduces the computational cost, as the potentially expensive `chi` calculation is performed only $q$ times, and the main loop involves only a simple array lookup and arithmetic operations.\n\n#### 3.3. Computing the Error Bound $E(d,N)$\n\nThe error bound is calculated directly from the given formula:\n$$E(d,N) = \\frac{C \\sqrt{q} \\log q}{N}$$\nwhere $C=2$, $q=|d|$, and $\\log$ is the natural logarithm. We use `numpy` functions for the square root and logarithm for numerical precision.\n\nThe final implementation will process each $(d,N)$ pair from the test suite, compute the pair of values $(L_N(1,\\chi_d), E(d,N))$, and format the output as a single flattened list.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport math\n\n# Do not import any other libraries.\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    It computes the truncated L-series sum and its error bound for each case.\n    \"\"\"\n\n    def chi(d, n):\n        \"\"\"\n        Computes the quadratic character chi_d(n) for a fundamental discriminant d.\n        This is implemented using the Kronecker symbol (d/n).\n        \"\"\"\n        # The character is periodic with conductor q = |d|.\n        q = abs(d)\n\n        # For a primitive character, chi_d(n) = 0 if gcd(n, q)  1.\n        if math.gcd(n, q)  1:\n            return 0\n        \n        # Now, compute the Kronecker symbol (d/n) for gcd(n, q) = 1.\n        # This implementation follows the standard iterative algorithm.\n        \n        if n == 0:\n            return 1 if q == 1 else 0\n        if n == 1:\n            return 1\n        \n        # Factor out powers of 2 from n: n = 2^k * m\n        k = 0\n        while n % 2 == 0:\n            k += 1\n            n //= 2\n        \n        # Contribution from (d/2)^k\n        if k % 2 == 0:\n            res = 1\n        else:\n            d_mod_8 = d % 8\n            if d_mod_8 == 1 or d_mod_8 == 7:\n                res = 1\n            elif d_mod_8 == 3 or d_mod_8 == 5:\n                res = -1\n            else: # d is even, but gcd(n,d)=1 implies n is odd, so k=0.\n                  # This branch should not be reached for valid inputs.\n                res = 0\n\n        # If the odd part of n is 1, we are done.\n        if n == 1:\n            return res\n\n        # Contribution from (d/m) for m odd\n        # Using quadratic reciprocity for the Jacobi symbol.\n        if d  0:\n            if n % 4 == 3:\n                res *= -1\n            d = -d\n\n        while d != 0:\n            # Factor out powers of 2 from d\n            v = 0\n            while d % 2 == 0:\n                v += 1\n                d //= 2\n            \n            if v % 2 == 1:\n                n_mod_8 = n % 8\n                if n_mod_8 == 3 or n_mod_8 == 5:\n                    res *= -1\n            \n            if d == 1:\n                break\n                \n            # Apply quadratic reciprocity rule\n            if d % 4 == 3 and n % 4 == 3:\n                res *= -1\n            \n            # Swap roles and reduce\n            d, n = n % d, d\n            \n        return res\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (-4, 100000),\n        (-7, 200000),\n        (5, 200000),\n        (8, 250000),\n        (-163, 800000),\n        (-3, 300000)\n    ]\n\n    results = []\n    for d, N in test_cases:\n        q = abs(d)\n        \n        # Pre-compute character values for one period\n        chi_values = np.array([chi(d, j) for j in range(q)])\n        \n        # Compute the truncated sum L_N(1, chi_d)\n        # We use a vectorized operation for better performance where possible,\n        # but a simple loop is clear and efficient enough here.\n        n_vals = np.arange(1, N + 1)\n        # Using the pre-computed values via modulus operator to leverage periodicity\n        chi_d_of_n = chi_values[n_vals % q]\n        l_sum = np.sum(chi_d_of_n / n_vals)\n        \n        # Compute the error bound E(d, N)\n        C = 2.0\n        # For d = -1, q = 1, log(1)=0. Must handle this, though not in test cases.\n        if q == 1:\n            error_bound = 0.0\n        else:\n            error_bound = (C * np.sqrt(q) * np.log(q)) / N\n        \n        results.append(l_sum)\n        results.append(error_bound)\n\n    # Final print statement in the exact required format.\n    # The map(str, ...) converts all numbers to strings using Python's default float representation.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "3024687"}]}