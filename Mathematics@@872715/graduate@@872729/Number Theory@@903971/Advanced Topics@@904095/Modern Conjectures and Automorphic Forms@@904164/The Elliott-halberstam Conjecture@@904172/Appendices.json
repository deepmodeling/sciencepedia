{"hands_on_practices": [{"introduction": "Before delving into the abstract theory, a hands-on computational approach can provide invaluable intuition. This first practice asks you to compute the Chebyshev function $\\psi(x;q,a)$ for various arithmetic progressions and compare it to its expected value. By implementing this calculation, you will gain a concrete understanding of the error term $E(x;q,a)$ and be able to numerically test the \"square-root cancellation\" heuristic that underpins much of the theory surrounding the distribution of primes [@problem_id:3025852].", "problem": "Let $q$ be a positive integer, let $a$ be an integer residue class modulo $q$, and let $\\Lambda(n)$ denote the von Mangoldt function defined by $$\\Lambda(n)=\\begin{cases}\\log p  \\text{if } n=p^k \\text{ for some prime } p \\text{ and integer } k\\geq 1,\\\\ 0  \\text{otherwise.}\\end{cases}$$ Define the Chebyshev function in arithmetic progressions by $$\\psi(x;q,a)=\\sum_{\\substack{1\\leq n\\leq x\\\\ n\\equiv a\\ (\\mathrm{mod}\\ q)}}\\Lambda(n).$$ Let $\\varphi(q)$ be Euler's totient function, and define the expected main term $$M(x;q,a)=\\begin{cases}\\dfrac{x}{\\varphi(q)}  \\text{if } \\gcd(a,q)=1,\\\\ 0  \\text{if } \\gcd(a,q)1.\\end{cases}$$ Define the discrepancy $$E(x;q,a)=\\psi(x;q,a)-M(x;q,a).$$ The Elliott-Halberstam conjecture (EH) concerns the average size of such discrepancies over moduli $q$ up to $x^{1-\\varepsilon}$, and heuristics suggest square-root cancellation scales such as $|E(x;q,a)|$ being comparable to $\\sqrt{x}$ on average in many settings.\n\nYour task is to implement a computational model of $\\Lambda(n)$ using the natural logarithm and compute $\\psi(x;q,a)$, the discrepancy $E(x;q,a)$, and compare $|E(x;q,a)|$ against the heuristic size $\\sqrt{x}$ for the specified test suite. For each test case, you must output the list $$\\big[\\psi(x;q,a),\\ E(x;q,a),\\ |E(x;q,a)|/\\sqrt{x},\\ |E(x;q,a)|\\leq \\sqrt{x}\\big],$$ where the last entry is a boolean indicating whether the observed discrepancy is at most the heuristic benchmark.\n\nUse only purely mathematical and algorithmic reasoning; do not rely on any external data. All logarithms must be natural logarithms. No physical units are involved. Angles are not involved. All percentages, if any, must be expressed as decimals or fractions, but none are required here.\n\nThe required test suite consists of the following parameter sets:\n- Happy path, prime modulus and reduced residue classes: $(x,q,a)=(10^4,5,1)$, $(10^4,5,2)$, $(10^4,5,3)$, $(10^4,5,4)$.\n- Boundary condition with minimal $x$: $(x,q,a)=(1,5,1)$.\n- Edge case with a non-coprime residue class: $(x,q,a)=(100,5,0)$.\n- Composite modulus with both coprime and non-coprime residues: $(x,q,a)=(10^4,8,1)$ and $(10^4,8,2)$.\n- Alternate prime modulus: $(x,q,a)=(10^3,7,3)$.\n- Large modulus relative to $x$: $(x,q,a)=(200,97,1)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case in the same order as listed above, and each element is itself a comma-separated list in square brackets of the form $[\\psi,E,|E|/\\sqrt{x},\\text{boolean}]$. For example, the output format must be $$\\big[[\\cdots],[\\cdots],\\ldots,[\\cdots]\\big],$$ with no additional text.", "solution": "The problem is valid. It is a well-posed computational problem in analytic number theory based on standard, universally accepted definitions and a famous conjecture. All necessary data and definitions are provided, and the problem is self-contained and objective.\n\n### **Problem Validation**\n\n#### **Step 1: Extract Givens**\n-   **Von Mangoldt function, $\\Lambda(n)$**:\n    $$\\Lambda(n)=\\begin{cases}\\log p  \\text{if } n=p^k \\text{ for some prime } p \\text{ and integer } k\\geq 1,\\\\ 0  \\text{otherwise.}\\end{cases}$$\n-   **Chebyshev function, $\\psi(x;q,a)$**:\n    $$\\psi(x;q,a)=\\sum_{\\substack{1\\leq n\\leq x\\\\ n\\equiv a\\ (\\mathrm{mod}\\ q)}}\\Lambda(n).$$\n-   **Euler's totient function, $\\varphi(q)$**.\n-   **Expected main term, $M(x;q,a)$**:\n    $$M(x;q,a)=\\begin{cases}\\dfrac{x}{\\varphi(q)}  \\text{if } \\gcd(a,q)=1,\\\\ 0  \\text{if } \\gcd(a,q)1.\\end{cases}$$\n-   **Discrepancy, $E(x;q,a)$**:\n    $$E(x;q,a)=\\psi(x;q,a)-M(x;q,a).$$\n-   **Heuristic benchmark**: $|E(x;q,a)|$ is compared against $\\sqrt{x}$.\n-   **Required output per test case**: A list of four values:\n    $$\\big[\\psi(x;q,a),\\ E(x;q,a),\\ |E(x;q,a)|/\\sqrt{x},\\ |E(x;q,a)|\\leq \\sqrt{x}\\big].$$\n-   **Test suite**:\n    1.  $(x,q,a)=(10^4,5,1)$\n    2.  $(x,q,a)=(10^4,5,2)$\n    3.  $(x,q,a)=(10^4,5,3)$\n    4.  $(x,q,a)=(10^4,5,4)$\n    5.  $(x,q,a)=(1,5,1)$\n    6.  $(x,q,a)=(100,5,0)$\n    7.  $(x,q,a)=(10^4,8,1)$\n    8.  $(x,q,a)=(10^4,8,2)$\n    9.  $(x,q,a)=(10^3,7,3)$\n    10. $(x,q,a)=(200,97,1)$\n\n#### **Step 2: Validate Using Extracted Givens**\n-   **Scientifically Grounded**: The problem is based on fundamental concepts of analytic number theory: the von Mangoldt function, the Chebyshev psi function for arithmetic progressions, and Euler's totient function. The reference to the Elliott-Halberstam conjecture and the square-root cancellation heuristic are central topics in the study of prime number distribution. All definitions and principles are scientifically sound.\n-   **Well-Posed**: For any valid set of inputs $(x,q,a)$, the quantities to be computed are uniquely defined. The computational task is clear and has a single, verifiable solution for each test case.\n-   **Objective**: The problem is stated using precise mathematical language and definitions, free of any subjectivity or ambiguity.\n\nThe problem does not exhibit any of the invalidity flaws. It is a well-defined computational task within the domain of number theory.\n\n#### **Step 3: Verdict and Action**\nThe problem statement is **valid**. A solution will be provided.\n\n### **Methodology and Solution**\n\nThe objective is to compute four quantities for each test case $(x,q,a)$: $\\psi(x;q,a)$, $E(x;q,a)$, the ratio $|E(x;q,a)|/\\sqrt{x}$, and a boolean comparison $|E(x;q,a)| \\le \\sqrt{x}$. This requires the implementation of several number-theoretic functions.\n\n#### **1. Pre-computation of the von Mangoldt function $\\Lambda(n)$**\n\nTo efficiently calculate $\\psi(x;q,a)$, which involves a sum of $\\Lambda(n)$ values, it is best to pre-compute $\\Lambda(n)$ for all integers $n$ up to the maximum value of $x$ in the test suite, which is $10^4$. A sieve-based method, analogous to the Sieve of Eratosthenes, is suitable for this purpose.\n\nThe algorithm is as follows:\n1.  Initialize an array `lambda_vals` of size $x_{max}+1$ with zeros, where $x_{max} = 10^4$.\n2.  Initialize a boolean array `is_prime` of size $x_{max}+1$ to `True` for all entries from $2$ onwards. Mark $0$ and $1$ as not prime.\n3.  Iterate through integers $p$ from $2$ up to $x_{max}$.\n4.  If `is_prime[p]` is `True`, then $p$ is a prime number.\n    a.  First, mark all multiples of $p$ ($2p, 3p, ...$) as not prime in the `is_prime` array.\n    b.  Next, calculate $\\log p$. This value is assigned to $\\Lambda(n)$ for all powers of this prime, $n = p^k$. Iterate through powers $p^k = p, p^2, p^3, \\dots$ as long as $p^k \\le x_{max}$, and set `lambda_vals[p^k] = log(p)`.\n\nThis process efficiently populates the `lambda_vals` array. For any composite number $n$ that is not a prime power, `lambda_vals[n]` will remain $0$, consistent with the definition of $\\Lambda(n)$.\n\n#### **2. Computation of Auxiliary Functions**\n\nThe calculation of the main term $M(x;q,a)$ requires Euler's totient function $\\varphi(q)$ and the greatest common divisor $\\gcd(a,q)$.\n\n**Euler's totient function $\\varphi(q)$:**\nFor an integer $q  1$, $\\varphi(q)$ is the number of positive integers up to $q$ that are relatively prime to $q$. It can be calculated using its product formula over the distinct prime factors of $q$:\n$$ \\varphi(q) = q \\prod_{p|q, p \\text{ is prime}} \\left(1 - \\frac{1}{p}\\right) $$\nAn effective algorithm to compute this is:\n1.  Initialize `result = q`.\n2.  Iterate through prime candidates $p$ starting from $2$.\n3.  If $p$ divides the remaining part of $q$, update the result by `result = result - result/p` and divide out all factors of $p$ from $q$.\n4.  Repeat until the remaining part of $q$ is $1$ or the square of $p$ exceeds it. If a prime factor greater than $\\sqrt{q}$ remains, one final update is needed for that factor.\n\n**Greatest common divisor $\\gcd(a,q)$:**\nThis is computed using the standard Euclidean algorithm, which is available in Python's `math` library. For the test case $(100, 5, 0)$, we note that $\\gcd(0,q) = q$.\n\n#### **3. Calculation of Principal Quantities**\n\nFor each test case $(x,q,a)$:\n\n1.  **Chebyshev function $\\psi(x;q,a)$**:\n    $$\\psi(x;q,a)=\\sum_{\\substack{1\\leq n\\leq x\\\\ n\\equiv a\\ (\\mathrm{mod}\\ q)}}\\Lambda(n)$$\n    This sum is computed by iterating through all integers $n$ from $1$ to $x$ that satisfy the congruence $n \\equiv a \\pmod{q}$. An efficient way to do this is to establish the first term of the arithmetic progression, $n_{start}$, which is the smallest positive integer such that $n_{start} \\equiv a \\pmod{q}$. This can be calculated as $n_{start} = (a-1) \\pmod q + 1$. The sum then becomes an iteration over $n = n_{start}, n_{start}+q, n_{start}+2q, \\dots$ up to $x$, summing the pre-computed `lambda_vals[n]`.\n\n2.  **Expected main term $M(x;q,a)$**:\n    $$M(x;q,a)=\\begin{cases}\\dfrac{x}{\\varphi(q)}  \\text{if } \\gcd(a,q)=1,\\\\ 0  \\text{if } \\gcd(a,q)1.\\end{cases}$$\n    First, compute $g = \\gcd(a,q)$. If $g=1$, compute $\\varphi_q = \\varphi(q)$ and set $M(x;q,a) = x / \\varphi_q$. Otherwise, $M(x;q,a)=0$.\n\n3.  **Discrepancy $E(x;q,a)$**:\n    This is the direct difference: $E(x;q,a) = \\psi(x;q,a) - M(x;q,a)$.\n\n4.  **Ratio and Heuristic Check**:\n    The final two values are derived from $E(x;q,a)$:\n    -   The ratio is $|E(x;q,a)| / \\sqrt{x}$.\n    -   The boolean check is the result of the comparison $|E(x;q,a)| \\le \\sqrt{x}$.\n\nThis structured approach ensures that each component is calculated correctly and efficiently, leading to the final four-element list for each test case. The results from all test cases are then aggregated into a single list of lists for the final output.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport math\n\ndef sieve_for_lambda(limit):\n    \"\"\"\n    Computes von Mangoldt function Lambda(n) for n up to limit using a sieve.\n    \"\"\"\n    lambda_vals = np.zeros(limit + 1)\n    is_prime = np.ones(limit + 1, dtype=bool)\n    is_prime[0] = is_prime[1] = False\n    for p in range(2, limit + 1):\n        if is_prime[p]:\n            log_p = np.log(p)\n            # Sieve out multiples\n            for multiple in range(2 * p, limit + 1, p):\n                is_prime[multiple] = False\n            # Assign log(p) to powers of p\n            p_power = p\n            while p_power = limit:\n                lambda_vals[p_power] = log_p\n                # Prevent overflow before multiplication\n                if p_power  limit // p:\n                    break\n                p_power *= p\n    return lambda_vals\n\ndef phi(q):\n    \"\"\"\n    Computes Euler's totient function phi(q).\n    \"\"\"\n    if q == 1:\n        return 1\n    result = q\n    p = 2\n    temp_q = q\n    while p * p = temp_q:\n        if temp_q % p == 0:\n            while temp_q % p == 0:\n                temp_q //= p\n            result -= result // p\n        p += 1\n    if temp_q  1:\n        result -= result // temp_q\n    return result\n\ndef calculate_psi(x, q, a, lambda_vals):\n    \"\"\"\n    Computes the Chebyshev function psi(x; q, a).\n    \"\"\"\n    x_int = int(x)\n    psi_val = 0.0\n    \n    # Start iteration from the first positive integer n = a (mod q)\n    # The formula (a-1)%q + 1 works for a = 0 in Python.\n    # e.g., a=5, q=5 - (4%5)+1 = 5. a=0, q=5 - (-1%5)+1 = 4+1=5. a=1, q=5 - (0%5)+1=1.\n    n_start = (a - 1) % q + 1\n    \n    for n in range(n_start, x_int + 1, q):\n        psi_val += lambda_vals[n]\n        \n    return psi_val\n\ndef solve():\n    \"\"\"\n    Main solver function to process test cases and produce the final output.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (10**4, 5, 1),\n        (10**4, 5, 2),\n        (10**4, 5, 3),\n        (10**4, 5, 4),\n        (1, 5, 1),\n        (100, 5, 0),\n        (10**4, 8, 1),\n        (10**4, 8, 2),\n        (10**3, 7, 3),\n        (200, 97, 1),\n    ]\n\n    max_x = 0\n    if test_cases:\n        max_x = int(max(tc[0] for tc in test_cases))\n\n    # Pre-compute Lambda values\n    lambda_vals = sieve_for_lambda(max_x)\n    \n    results = []\n    for x, q, a in test_cases:\n        # 1. Compute psi(x; q, a)\n        psi = calculate_psi(x, q, a, lambda_vals)\n        \n        # 2. Compute M(x; q, a)\n        g = math.gcd(a, q)\n        if g == 1:\n            phi_q = phi(q)\n            m_xaq = x / phi_q\n        else:\n            m_xaq = 0.0\n            \n        # 3. Compute E(x; q, a)\n        e_xaq = psi - m_xaq\n        \n        # 4. Compute ratio and boolean check\n        sqrt_x = np.sqrt(x)\n        ratio = np.abs(e_xaq) / sqrt_x if sqrt_x  0 else 0.0\n        is_le_heuristic = np.abs(e_xaq) = sqrt_x\n        \n        results.append([psi, e_xaq, ratio, is_le_heuristic])\n\n    # Final print statement in the exact required format without spaces.\n    inner_strings = []\n    for r in results:\n        # Convert boolean to lowercase 'true'/'false' if required, but str(bool) gives 'True'/'False'\n        # The example format [...,boolean] suggests str(bool) is fine.\n        inner_strings.append(f\"[{r[0]},{r[1]},{r[2]},{r[3]}]\")\n    \n    print(f\"[{','.join(inner_strings)}]\")\n\nsolve()\n```", "id": "3025852"}, {"introduction": "To move from numerical observation to rigorous proof, we must employ the powerful tools of analytic number theory. The central technique for analyzing sums over arithmetic progressions is to transform them into sums involving Dirichlet characters, which can be thought of as the Fourier analysis of the group $(\\mathbb{Z}/q\\mathbb{Z})^\\times$. This practice guides you through this fundamental translation, revealing how bounds on character sums directly imply bounds on the average error in the distribution of primes in residue classes [@problem_id:3025892].", "problem": "Let $q \\geq 1$ be an integer and let $\\varphi(q)$ denote Euler's totient function. For a Dirichlet character modulo $q$, write $\\chi \\pmod q$, and denote the principal character by $\\chi_{0}$. Define the Chebyshev function twisted by a character by\n$$\n\\psi(x,\\chi) \\;=\\; \\sum_{n \\leq x} \\Lambda(n)\\,\\chi(n),\n$$\nand the Chebyshev function in the reduced residue class $a \\pmod q$ (with $(a,q)=1$) by\n$$\n\\psi(x;q,a) \\;=\\; \\sum_{\\substack{n \\leq x \\\\ n \\equiv a \\,(\\bmod q)}} \\Lambda(n).\n$$\nDefine the error term in the prime number theorem for arithmetic progressions by\n$$\nE(x;q,a) \\;=\\; \\psi(x;q,a) \\;-\\; \\frac{x}{\\varphi(q)}.\n$$\n\nAssume the orthogonality of Dirichlet characters:\n$$\n\\frac{1}{\\varphi(q)} \\sum_{\\chi \\,(\\bmod q)} \\overline{\\chi}(a)\\,\\chi(n)\n\\;=\\;\n\\begin{cases}\n1,  \\text{if } n \\equiv a \\pmod q \\text{ and } (n,q)=1, \\\\\n0,  \\text{otherwise},\n\\end{cases}\n$$\nand suppose that for some function $\\mathcal{B}(x,Q)$ and for all moduli $q \\leq Q$ one has the uniform bound\n$$\n\\sum_{\\chi \\,(\\bmod q)} \\big|\\psi(x,\\chi)\\big| \\;\\leq\\; \\mathcal{B}(x,Q).\n$$\n\nUsing only these inputs and fundamental properties of Dirichlet characters and the von Mangoldt function, derive an average bound for the error term of the shape\n$$\n\\frac{1}{\\varphi(q)} \\sum_{\\substack{a \\,(\\bmod q) \\\\ (a,q)=1}} \\big|E(x;q,a)\\big|\n\\;\\leq\\; C(q)\\, \\sum_{\\substack{\\chi \\,(\\bmod q) \\\\ \\chi \\neq \\chi_{0}}} \\big|\\psi(x,\\chi)\\big| \\;+\\; \\text{(explicit principal-character correction)},\n$$\nidentifying the exact multiplicative constant $C(q)$ that arises deterministically from the translation between residue-class sums and character sums. Compute $C(q)$ explicitly as a closed-form expression in $q$.\n\nYour final answer must be only the expression for $C(q)$, with no units. If you choose to simplify, provide an exact symbolic expression (no numerical approximation).", "solution": "The problem is to derive a bound for the average of the error term in the prime number theorem for arithmetic progressions and to determine the multiplicative constant $C(q)$ that arises.\n\nFirst, we express the Chebyshev function for an arithmetic progression, $\\psi(x;q,a)$, in terms of the twisted Chebyshev functions, $\\psi(x,\\chi)$. The problem provides the orthogonality relation for Dirichlet characters modulo $q$: for $(a,q)=1$,\n$$\n\\frac{1}{\\varphi(q)} \\sum_{\\chi \\,(\\bmod q)} \\overline{\\chi}(a)\\,\\chi(n)\n\\;=\\;\n\\begin{cases}\n1,  \\text{if } n \\equiv a \\pmod q,\\\\\n0,  \\text{otherwise}.\n\\end{cases}\n$$\nNote that for $n \\equiv a \\pmod q$ with $(a,q)=1$, it is necessary that $(n,q)=1$. The von Mangoldt function $\\Lambda(n)$ is zero unless $n$ is a prime power, $n=p^k$. For a character $\\chi \\pmod q$, it is standard to define $\\chi(n)=0$ if $(n,q)1$. Thus, the sum $\\sum_{n \\leq x} \\Lambda(n)\\chi(n)$ implicitly includes the condition $(n,q)=1$ for any term to be non-zero, unless $q$ is a prime power and $n$ is a power of that prime. However, with the standard definition of characters induced from primitive characters, $\\chi(n) = 0$ for $(n,q)1$ for all characters $\\chi \\pmod q$ except possibly when $q=1$. The problem statement implies we are using characters defined on $\\mathbb{Z}$ in this standard way.\n\nUsing the orthogonality relation, we can write $\\psi(x;q,a)$ as:\n$$\n\\psi(x;q,a) \\;=\\; \\sum_{\\substack{n \\leq x \\\\ n \\equiv a \\,(\\bmod q)}} \\Lambda(n) \\;=\\; \\sum_{n \\leq x} \\Lambda(n) \\left( \\frac{1}{\\varphi(q)} \\sum_{\\chi \\,(\\bmod q)} \\overline{\\chi}(a)\\chi(n) \\right).\n$$\nWe can swap the order of summation:\n$$\n\\psi(x;q,a) \\;=\\; \\frac{1}{\\varphi(q)} \\sum_{\\chi \\,(\\bmod q)} \\overline{\\chi}(a) \\sum_{n \\leq x} \\Lambda(n)\\chi(n) \\;=\\; \\frac{1}{\\varphi(q)} \\sum_{\\chi \\,(\\bmod q)} \\overline{\\chi}(a) \\psi(x,\\chi).\n$$\n\nNext, we form the error term $E(x;q,a)$:\n$$\nE(x;q,a) \\;=\\; \\psi(x;q,a) \\;-\\; \\frac{x}{\\varphi(q)} \\;=\\; \\frac{1}{\\varphi(q)} \\sum_{\\chi \\,(\\bmod q)} \\overline{\\chi}(a) \\psi(x,\\chi) \\;-\\; \\frac{x}{\\varphi(q)}.\n$$\nWe separate the contribution from the principal character, $\\chi_0$. Since $(a,q)=1$, we have $\\overline{\\chi_0}(a)=1$.\n$$\nE(x;q,a) \\;=\\; \\frac{1}{\\varphi(q)} \\left( \\overline{\\chi_0}(a)\\psi(x,\\chi_0) + \\sum_{\\substack{\\chi \\,(\\bmod q) \\\\ \\chi \\neq \\chi_0}} \\overline{\\chi}(a)\\psi(x,\\chi) \\right) \\;-\\; \\frac{x}{\\varphi(q)}\n$$\n$$\nE(x;q,a) \\;=\\; \\frac{1}{\\varphi(q)} \\sum_{\\substack{\\chi \\,(\\bmod q) \\\\ \\chi \\neq \\chi_0}} \\overline{\\chi}(a)\\psi(x,\\chi) \\;+\\; \\frac{\\psi(x,\\chi_0) - x}{\\varphi(q)}.\n$$\nThe problem requires deriving a bound for the average of $|E(x;q,a)|$ over all reduced residue classes $a \\pmod q$. The required form of the bound is a sum of two terms, which suggests using the triangle inequality $|A+B| \\leq |A|+|B|$.\n$$\n|E(x;q,a)| \\;\\leq\\; \\left| \\frac{1}{\\varphi(q)} \\sum_{\\substack{\\chi \\,(\\bmod q) \\\\ \\chi \\neq \\chi_0}} \\overline{\\chi}(a)\\psi(x,\\chi) \\right| \\;+\\; \\left| \\frac{\\psi(x,\\chi_0) - x}{\\varphi(q)} \\right|.\n$$\nNow, we average this inequality over the $\\varphi(q)$ values of $a$ such that $(a,q)=1$:\n$$\n\\frac{1}{\\varphi(q)} \\sum_{\\substack{a \\,(\\bmod q) \\\\ (a,q)=1}} |E(x;q,a)| \\;\\leq\\; \\frac{1}{\\varphi(q)} \\sum_{\\substack{a \\,(\\bmod q) \\\\ (a,q)=1}} \\left| \\frac{1}{\\varphi(q)} \\sum_{\\substack{\\chi \\,(\\bmod q) \\\\ \\chi \\neq \\chi_0}} \\overline{\\chi}(a)\\psi(x,\\chi) \\right| \\;+\\; \\frac{|\\psi(x,\\chi_0) - x|}{\\varphi(q)}.\n$$\nThe second term, $\\frac{|\\psi(x,\\chi_0) - x|}{\\varphi(q)}$, is the \"explicit principal-character correction\" mentioned in the problem statement, as its average over $a$ is itself.\n\nWe now focus on an upper bound for the first term, which must take the form $C(q) \\sum_{\\chi \\neq \\chi_0} |\\psi(x,\\chi)|$. Let this term be denoted by $M$:\n$$\nM \\;=\\; \\frac{1}{\\varphi(q)} \\sum_{\\substack{a \\,(\\bmod q) \\\\ (a,q)=1}} \\left| \\frac{1}{\\varphi(q)} \\sum_{\\substack{\\chi \\,(\\bmod q) \\\\ \\chi \\neq \\chi_0}} \\overline{\\chi}(a)\\psi(x,\\chi) \\right| \\;=\\; \\frac{1}{\\varphi(q)^2} \\sum_{\\substack{a \\,(\\bmod q) \\\\ (a,q)=1}} \\left| \\sum_{\\substack{\\chi \\,(\\bmod q) \\\\ \\chi \\neq \\chi_0}} \\overline{\\chi}(a)\\psi(x,\\chi) \\right|.\n$$\nTo obtain a bound in terms of $\\sum |\\psi(x,\\chi)|$, we apply the triangle inequality to the inner sum over characters:\n$$\n\\left| \\sum_{\\substack{\\chi \\,(\\bmod q) \\\\ \\chi \\neq \\chi_0}} \\overline{\\chi}(a)\\psi(x,\\chi) \\right| \\;\\leq\\; \\sum_{\\substack{\\chi \\,(\\bmod q) \\\\ \\chi \\neq \\chi_0}} |\\overline{\\chi}(a)\\psi(x,\\chi)|.\n$$\nSince $|\\overline{\\chi}(a)| = 1$ for any character $\\chi$ and any $a$ with $(a,q)=1$, this simplifies to:\n$$\n\\left| \\sum_{\\substack{\\chi \\,(\\bmod q) \\\\ \\chi \\neq \\chi_0}} \\overline{\\chi}(a)\\psi(x,\\chi) \\right| \\;\\leq\\; \\sum_{\\substack{\\chi \\,(\\bmod q) \\\\ \\chi \\neq \\chi_0}} |\\psi(x,\\chi)|.\n$$\nSubstituting this back into the expression for $M$:\n$$\nM \\;\\leq\\; \\frac{1}{\\varphi(q)^2} \\sum_{\\substack{a \\,(\\bmod q) \\\\ (a,q)=1}} \\left( \\sum_{\\substack{\\chi \\,(\\bmod q) \\\\ \\chi \\neq \\chi_0}} |\\psi(x,\\chi)| \\right).\n$$\nThe inner sum over $\\chi \\neq \\chi_0$ does not depend on $a$. The outer sum over $a$ consists of $\\varphi(q)$ identical terms.\n$$\nM \\;\\leq\\; \\frac{1}{\\varphi(q)^2} \\cdot \\varphi(q) \\left( \\sum_{\\substack{\\chi \\,(\\bmod q) \\\\ \\chi \\neq \\chi_0}} |\\psi(x,\\chi)| \\right) \\;=\\; \\frac{1}{\\varphi(q)} \\sum_{\\substack{\\chi \\,(\\bmod q) \\\\ \\chi \\neq \\chi_0}} |\\psi(x,\\chi)|.\n$$\nThis derivation yields a bound of the required form. By comparing this result with the target expression\n$$\nM \\leq C(q)\\, \\sum_{\\substack{\\chi \\,(\\bmod q) \\\\ \\chi \\neq \\chi_{0}}} \\big|\\psi(x,\\chi)\\big|,\n$$\nwe can identify the constant $C(q)$ that arises \"deterministically\" from this standard sequence of steps.\nThe constant is:\n$$\nC(q) \\;=\\; \\frac{1}{\\varphi(q)}.\n$$\nThe full inequality derived is:\n$$\n\\frac{1}{\\varphi(q)} \\sum_{\\substack{a \\,(\\bmod q) \\\\ (a,q)=1}} |E(x;q,a)| \\;\\leq\\; \\frac{1}{\\varphi(q)} \\sum_{\\substack{\\chi \\,(\\bmod q) \\\\ \\chi \\neq \\chi_0}} |\\psi(x,\\chi)| \\;+\\; \\frac{|\\psi(x,\\chi_0) - x|}{\\varphi(q)}.\n$$\nThe problem asks for the explicit closed-form expression for $C(q)$, which we have found.", "answer": "$$\\boxed{\\frac{1}{\\varphi(q)}}$$", "id": "3025892"}, {"introduction": "The proofs of major theorems in this area, from Bombieri-Vinogradov to Zhang's work on prime gaps, ultimately rely on controlling certain \"bilinear\" or \"Type II\" sums that arise from combinatorial decompositions of $\\Lambda(n)$. This exercise presents a model of such a sum, allowing you to see how the large sieve inequality naturally leads to the famous $\\theta=1/2$ \"square-root barrier\". Furthermore, it provides a framework to quantitatively measure the gap between what is known unconditionally and the full strength of the Elliott-Halberstam conjecture [@problem_id:3025896].", "problem": "Let $x$ be a large real parameter and let $\\rho \\in (0,1)$ and $\\theta \\in \\left[\\tfrac{1}{2},1\\right]$ be fixed constants. Define $y := x^{\\rho}$ and let $\\mathcal{Q} := \\{q \\le x^{\\theta} : \\text{$q$ is $y$-smooth}\\}$. Consider a balanced model for a Type II bilinear dispersion sum with smoothness constraints: choose integers $M,N$ with $MN = x$ and $M = N = x^{1/2}$, and complex weights $\\{\\alpha_{m}\\}_{m \\le M}$ and $\\{\\beta_{n}\\}_{n \\le N}$ satisfying the normalizations\n$$\n\\sum_{m \\le M} |\\alpha_{m}|^{2} \\le M\n\\quad\\text{and}\\quad\n\\sum_{n \\le N} |\\beta_{n}|^{2} \\le N.\n$$\nFor $q \\in \\mathcal{Q}$ and $(a,q)=1$, let\n$$\n\\Delta(q,a) \\;:=\\; \\sum_{m \\le M} \\alpha_{m} \\sum_{n \\le N} \\beta_{n}\\,\\mathbf{1}_{mn \\equiv a \\, (\\bmod\\, q)} \\;-\\; \\frac{1}{\\varphi(q)} \\sum_{\\substack{m \\le M,\\, n \\le N\\\\ (mn,q)=1}} \\alpha_{m}\\beta_{n},\n$$\nand define the $L^{1}$-average bilinear discrepancy over smooth moduli\n$$\n\\mathcal{B}(\\theta,\\rho;\\alpha,\\beta) \\;:=\\; \\sum_{q \\in \\mathcal{Q}} \\sum_{\\substack{a \\,(\\bmod\\, q)\\\\ (a,q)=1}} \\bigl|\\Delta(q,a)\\bigr|.\n$$\n\nYou may use as a foundational fact the multiplicative large sieve inequality: for any complex sequence $\\{c_{k}\\}$ supported on $k \\le X$,\n$$\n\\sum_{q \\le Q} \\frac{q}{\\varphi(q)} \\sum_{\\substack{\\chi \\,(\\bmod\\, q)\\\\ \\chi \\text{ primitive}}} \\left|\\sum_{k \\le X} c_{k}\\,\\chi(k)\\right|^{2} \\;\\ll\\; \\bigl(Q^{2}+X\\bigr)\\sum_{k \\le X} |c_{k}|^{2},\n$$\nwith an absolute implied constant. You may also use the de Bruijn–Dickman density statement that the proportion of $y$-smooth integers up to $Q=x^{\\theta}$ is $\\rho\\!\\left(\\frac{\\log Q}{\\log y}\\right)$, where $\\rho(\\cdot)$ is the Dickman–de Bruijn function, which is a positive constant depending only on $\\theta/\\rho$ and does not affect powers of $x$.\n\n(a) Using the large sieve and Cauchy–Schwarz, show that, up to factors of $x^{o(1)}$ and constants depending only on $\\rho$ and $\\theta$, one has the model bound\n$$\n\\mathcal{B}(\\theta,\\rho;\\alpha,\\beta) \\;\\ll\\; Q\\,\\bigl(Q^{2}+X\\bigr)^{1/2}\\,X^{1/2},\n$$\nwhere $Q := x^{\\theta}$ and $X := MN = x$. Conclude that, when $M = N = x^{1/2}$, the threshold at which one can hope for $\\mathcal{B}(\\theta,\\rho;\\alpha,\\beta) = o\\!\\bigl(QX\\bigr)$ is $Q \\asymp X^{1/2}$, i.e., $\\theta = \\tfrac{1}{2}$.\n\n(b) In this model, define the saving exponent associated with a level $\\theta$ by\n$$\n\\Delta(\\theta) \\;:=\\; \\theta - \\tfrac{1}{2},\n$$\nthat is, the excess of the admissible level over the barrier $\\tfrac{1}{2}$. Suppose Zhang’s smooth-moduli method provides, for some small $\\eta0$, the admissible level $\\theta_{Z} = \\tfrac{1}{2}+\\eta$ for $q \\in \\mathcal{Q}$, while the Elliott–Halberstam conjecture (EH) postulates the admissible level $\\theta_{\\mathrm{EH}} = 1$. Let $\\Delta_{Z} := \\Delta(\\theta_{Z})$ and $\\Delta_{\\mathrm{EH}} := \\Delta(\\theta_{\\mathrm{EH}})$.\n\nCompute the quantitative comparison\n$$\n\\mathcal{R}(\\eta) \\;:=\\; \\frac{\\Delta_{Z}}{\\Delta_{\\mathrm{EH}}}\n$$\nas a closed-form expression in $\\eta$. Provide your final answer as a simplified analytic expression. No rounding is required, and no physical units are involved.", "solution": "The problem is assessed to be valid as it is scientifically grounded in established principles of analytic number theory, is well-posed, objective, and contains sufficient information for a unique solution.\n\n### Part (a)\n\nWe are asked to establish a model bound for the bilinear discrepancy sum $\\mathcal{B}(\\theta,\\rho;\\alpha,\\beta)$ and determine the threshold for achieving a non-trivial estimate.\n\nFirst, we express the discrepancy $\\Delta(q,a)$ using Dirichlet characters. The condition $mn \\equiv a \\pmod q$ for $(a,q)=1$ can be written using the character orthogonality relation:\n$$\n\\mathbf{1}_{mn \\equiv a \\, (\\bmod\\, q)} = \\frac{1}{\\varphi(q)} \\sum_{\\chi \\,(\\bmod\\, q)} \\chi(mn)\\overline{\\chi(a)}.\n$$\nSubstituting this into the definition of $\\Delta(q,a)$, we have\n$$\n\\Delta(q,a) = \\frac{1}{\\varphi(q)} \\sum_{\\chi \\,(\\bmod\\, q)} \\overline{\\chi(a)} \\left(\\sum_{m \\le M} \\alpha_m \\chi(m)\\right) \\left(\\sum_{n \\le N} \\beta_n \\chi(n)\\right) - \\frac{1}{\\varphi(q)} \\sum_{\\substack{m \\le M,\\, n \\le N\\\\ (mn,q)=1}} \\alpha_{m}\\beta_{n}.\n$$\nThe second term corresponds to the contribution from the principal character $\\chi_0 \\pmod q$. If we write $A(\\chi) = \\sum_{m \\le M} \\alpha_m \\chi(m)$ and $B(\\chi) = \\sum_{n \\le N} \\beta_n \\chi(n)$, the expression for $\\Delta(q,a)$ becomes, up to details concerning the coprimality condition $(mn,q)=1$ which are typically absorbed into $x^{o(1)}$ factors,\n$$\n\\Delta(q,a) = \\frac{1}{\\varphi(q)} \\sum_{\\substack{\\chi \\,(\\bmod\\, q) \\\\ \\chi \\ne \\chi_0}} \\overline{\\chi(a)} A(\\chi) B(\\chi).\n$$\nThe quantity to be bounded is $\\mathcal{B} = \\sum_{q \\in \\mathcal{Q}} \\sum_{a \\,(\\bmod\\, q), (a,q)=1} |\\Delta(q,a)|$.\nWe apply the Cauchy-Schwarz inequality, first to the sum over $a$, then to the sum over $q$.\n$$\n\\mathcal{B} \\le \\sum_{q \\in \\mathcal{Q}} \\left( \\sum_{a \\,(\\bmod\\, q), (a,q)=1} 1 \\right)^{1/2} \\left( \\sum_{a \\,(\\bmod\\, q), (a,q)=1} |\\Delta(q,a)|^2 \\right)^{1/2} = \\sum_{q \\in \\mathcal{Q}} (\\varphi(q))^{1/2} \\left( \\sum_{a}^* |\\Delta(q,a)|^2 \\right)^{1/2}.\n$$\nThe sum over $a$ can be computed using character orthogonality:\n$$\n\\sum_{a}^* |\\Delta(q,a)|^2 = \\sum_a^* \\frac{1}{\\varphi(q)^2} \\left| \\sum_{\\chi \\ne \\chi_0} \\overline{\\chi(a)} A(\\chi)B(\\chi) \\right|^2 = \\frac{1}{\\varphi(q)} \\sum_{\\chi \\ne \\chi_0} |A(\\chi)B(\\chi)|^2.\n$$\nSo, $\\mathcal{B} \\le \\sum_{q \\in \\mathcal{Q}} \\left(\\sum_{\\chi \\ne \\chi_0} |A(\\chi)B(\\chi)|^2\\right)^{1/2}$. Applying the Cauchy-Schwarz inequality to the sum over $q$ yields\n$$\n\\mathcal{B}^2 \\le \\left(\\sum_{q \\in \\mathcal{Q}} 1 \\right) \\left(\\sum_{q \\in \\mathcal{Q}} \\sum_{\\chi \\ne \\chi_0} |A(\\chi)B(\\chi)|^2 \\right) \\le |\\mathcal{Q}| \\sum_{q \\in \\mathcal{Q}} \\left( \\max_{\\psi \\ne \\psi_0 \\pmod q} |A(\\psi)|^2 \\right) \\left( \\sum_{\\chi \\ne \\chi_0} |B(\\chi)|^2 \\right).\n$$\nThis path is complicated. A more direct route is to use Cauchy-Schwarz on the character sums inside the expression for $\\mathcal{B}$ first.\n$$\n|\\Delta(q,a)| \\le \\frac{1}{\\varphi(q)} \\sum_{\\chi \\ne \\chi_0} |A(\\chi)B(\\chi)| \\le \\frac{1}{\\varphi(q)} \\left(\\sum_{\\chi \\ne \\chi_0} |A(\\chi)|^2\\right)^{1/2} \\left(\\sum_{\\chi \\ne \\chi_0} |B(\\chi)|^2\\right)^{1/2}.\n$$\nThe bound is independent of $a$, so summing over $a$ gives a factor of $\\varphi(q)$:\n$$\n\\mathcal{B} \\le \\sum_{q \\in \\mathcal{Q}} \\left(\\sum_{\\chi \\ne \\chi_0} |A(\\chi)|^2\\right)^{1/2} \\left(\\sum_{\\chi \\ne \\chi_0} |B(\\chi)|^2\\right)^{1/2}.\n$$\nApplying the Cauchy-Schwarz inequality again, this time to the sum over $q$:\n$$\n\\mathcal{B} \\le \\left(\\sum_{q \\in \\mathcal{Q}} \\sum_{\\chi \\ne \\chi_0} |A(\\chi)|^2\\right)^{1/2} \\left(\\sum_{q \\in \\mathcal{Q}} \\sum_{\\chi \\ne \\chi_0} |B(\\chi)|^2\\right)^{1/2}.\n$$\nLet's analyze the first factor, $\\mathcal{S}_A = \\sum_{q \\in \\mathcal{Q}} \\sum_{\\chi \\ne \\chi_0} |A(\\chi)|^2$. We can drop the smoothness constraint on $q$ to get an upper bound.\n$$\n\\mathcal{S}_A \\le \\sum_{q \\le Q} \\sum_{\\chi \\ne \\chi_0} |A(\\chi)|^2 = \\sum_{q \\le Q} \\sum_{\\chi \\ne \\chi_0} \\left|\\sum_{m \\le M} \\alpha_m \\chi(m)\\right|^2.\n$$\nA standard version of the large sieve inequality states that\n$$\n\\sum_{q \\le Q} \\sum_{\\chi \\pmod q, \\chi \\ne \\chi_0} \\left|\\sum_{m \\le M} c_m \\chi(m)\\right|^2 \\ll (Q^2 + M) \\sum_{m \\le M} |c_m|^2 \\quad (\\text{up to } x^{o(1)} \\text{ factors}).\n$$\nUsing this (which can be derived from the given large sieve for primitive characters together with summation by parts), and the normalization $\\sum |\\alpha_m|^2 \\le M$, we get:\n$$\n\\mathcal{S}_A \\ll (Q^2+M)M.\n$$\nSimilarly, for the $\\beta_n$ sequence,\n$$\n\\mathcal{S}_B = \\sum_{q \\in \\mathcal{Q}} \\sum_{\\chi \\ne \\chi_0} |B(\\chi)|^2 \\ll (Q^2+N)N.\n$$\nSubstituting these back into the bound for $\\mathcal{B}$, we get\n$$\n\\mathcal{B} \\ll \\left( (Q^2+M)M \\right)^{1/2} \\left( (Q^2+N)N \\right)^{1/2}.\n$$\nGiven $M=N=x^{1/2}$, $X=x$, and $Q=x^\\theta$:\n$$\n\\mathcal{B} \\ll \\left( (x^{2\\theta}+x^{1/2})x^{1/2} \\right)^{1/2} \\left( (x^{2\\theta}+x^{1/2})x^{1/2} \\right)^{1/2} = (x^{2\\theta}+x^{1/2})x^{1/2}.\n$$\nThe problem asks to show $\\mathcal{B} \\ll Q(Q^2+X)^{1/2}X^{1/2} = x^\\theta(x^{2\\theta}+x)^{1/2}x^{1/2}$. For the given range $\\theta \\in [\\frac{1}{2}, 1]$, we have $x^\\theta \\ge x^{1/2}$, so $x^{2\\theta} \\ge x$.\nOur derived bound is approximately $(x^{2\\theta})x^{1/2} = x^{2\\theta+1/2}$.\nThe model bound is approximately $x^\\theta(x^{2\\theta})^{1/2}x^{1/2} = x^\\theta x^\\theta x^{1/2} = x^{2\\theta+1/2}$.\nThe two bounds have the same order of magnitude in terms of powers of $x$ for $\\theta \\ge 1/2$. The stated model bound is a standard variant, and we proceed by adopting it.\n\nA non-trivial bound for $\\mathcal{B}$ means it is a saving over the main term, i.e., $\\mathcal{B} = o(QX)$. $Q=x^\\theta$ and $X=x$. We test when the model bound satisfies this condition.\n$$\nQ(Q^2+X)^{1/2}X^{1/2} = o(QX).\n$$\nDividing by $QX^{1/2}$ (which is positive), we get\n$$\n(Q^2+X)^{1/2} = o(X^{1/2}).\n$$\nSquaring both sides,\n$$\nQ^2+X = o(X),\n$$\nwhich simplifies to $Q^2 = o(X)$ since $X$ is positive. Substituting $Q=x^\\theta$ and $X=x$:\n$$\nx^{2\\theta} = o(x).\n$$\nThis condition holds if and only if $2\\theta  1$, or $\\theta  \\frac{1}{2}$. Thus, a saving is achieved for $\\theta  \\frac{1}{2}$. The value $\\theta = \\frac{1}{2}$ represents the threshold or 'barrier,' at which point the bound is of the same order of magnitude as the main term, and no power saving is guaranteed by this method. This matches the known \"square-root barrier\" in similar problems like the Bombieri-Vinogradov theorem.\n\n### Part (b)\n\nWe are asked to compute the ratio $\\mathcal{R}(\\eta) = \\frac{\\Delta_Z}{\\Delta_{EH}}$.\nThe saving exponent is defined as $\\Delta(\\theta) := \\theta - \\frac{1}{2}$.\n\nFirst, we compute the saving exponent $\\Delta_Z$ corresponding to Zhang's method level, $\\theta_Z = \\frac{1}{2} + \\eta$.\n$$\n\\Delta_Z = \\Delta(\\theta_Z) = \\theta_Z - \\frac{1}{2} = \\left(\\frac{1}{2} + \\eta\\right) - \\frac{1}{2} = \\eta.\n$$\nNext, we compute the saving exponent $\\Delta_{EH}$ corresponding to the Elliott-Halberstam conjecture's level, $\\theta_{EH} = 1$.\n$$\n\\Delta_{EH} = \\Delta(\\theta_{EH}) = \\theta_{EH} - \\frac{1}{2} = 1 - \\frac{1}{2} = \\frac{1}{2}.\n$$\nFinally, we compute the ratio $\\mathcal{R}(\\eta)$:\n$$\n\\mathcal{R}(\\eta) = \\frac{\\Delta_Z}{\\Delta_{EH}} = \\frac{\\eta}{\\frac{1}{2}} = 2\\eta.\n$$\nThis provides a quantitative comparison of the \"strength\" of Zhang's result relative to the full Elliott-Halberstam conjecture, in terms of the admissible level of distribution beyond the $\\theta=\\frac{1}{2}$ barrier.", "answer": "$$\\boxed{2\\eta}$$", "id": "3025896"}]}