{
    "hands_on_practices": [
        {
            "introduction": "We begin our hands-on exploration by connecting the abstract mathematics of continuum mechanics to a tangible physical scenario: a simple uniaxial stretch. This fundamental exercise will guide you through the process of constructing the deformation gradient ($\\mathbf{F}$) from a given motion and then deriving the essential tensors that characterize the resulting strain, such as the Right Cauchy–Green tensor ($\\mathbf{C}$) and the Green–Lagrange strain ($\\mathbf{E}$) . Mastering this process is the first crucial step toward analyzing more complex material behaviors.",
            "id": "3798588",
            "problem": "A homogeneous deformation mapping in three dimensions describes a uniaxial stretch along the material basis direction $\\mathbf{e}_{1}$ by a stretch ratio $\\lambda>0$, while leaving the transverse directions unchanged. Let the reference position be $\\mathbf{X}=X_{1}\\mathbf{e}_{1}+X_{2}\\mathbf{e}_{2}+X_{3}\\mathbf{e}_{3}$ and the motion be defined by $\\boldsymbol{\\varphi}:\\mathbf{X}\\mapsto \\mathbf{x}$ with $\\mathbf{x}=\\boldsymbol{\\varphi}(\\mathbf{X})=\\lambda X_{1}\\mathbf{e}_{1}+X_{2}\\mathbf{e}_{2}+X_{3}\\mathbf{e}_{3}$.\n\nStarting from the fundamental definitions in finite deformation kinematics, construct the deformation gradient $\\mathbf{F}$ associated with this mapping and, from it, derive the Right Cauchy–Green deformation tensor $\\mathbf{C}$, the Green–Lagrange strain tensor $\\mathbf{E}$, and the Jacobian determinant $J$.\n\nReport your final answer as a single row matrix containing, in this order, the diagonal components of $\\mathbf{C}$, the diagonal components of $\\mathbf{E}$, and $J$, that is,\n$\\left(C_{11},\\,C_{22},\\,C_{33},\\,E_{11},\\,E_{22},\\,E_{33},\\,J\\right)$.\n\nNo numerical rounding is required; leave your answer in exact symbolic form in terms of $\\lambda$.",
            "solution": "The deformation mapping is given by $\\mathbf{x}=\\boldsymbol{\\varphi}(\\mathbf{X})=\\lambda X_{1}\\mathbf{e}_{1}+X_{2}\\mathbf{e}_{2}+X_{3}\\mathbf{e}_{3}$. The deformation gradient $\\mathbf{F}$ is defined as the material gradient of the motion,\n$$\n\\mathbf{F}=\\nabla_{\\! \\mathbf{X}}\\boldsymbol{\\varphi}(\\mathbf{X}) \\, ,\n$$\nwith components $F_{iJ}=\\partial x_{i}/\\partial X_{J}$ in a fixed orthonormal basis $\\{\\mathbf{e}_{1},\\mathbf{e}_{2},\\mathbf{e}_{3}\\}$. From the mapping components $x_{1}=\\lambda X_{1}$, $x_{2}=X_{2}$, $x_{3}=X_{3}$, we compute\n$$\n\\frac{\\partial x_{1}}{\\partial X_{1}}=\\lambda,\\quad \\frac{\\partial x_{2}}{\\partial X_{2}}=1,\\quad \\frac{\\partial x_{3}}{\\partial X_{3}}=1,\n$$\nand all mixed partial derivatives vanish. Therefore,\n$$\n\\mathbf{F}=\\mathrm{diag}\\!\\left(\\lambda,\\,1,\\,1\\right).\n$$\n\nThe Right Cauchy–Green deformation tensor is defined by\n$$\n\\mathbf{C}=\\mathbf{F}^{\\top}\\mathbf{F}.\n$$\nFor a diagonal $\\mathbf{F}$, we have $\\mathbf{F}^{\\top}=\\mathbf{F}$ and the product is diagonal with squared entries:\n$$\n\\mathbf{C}=\\mathrm{diag}\\!\\left(\\lambda^{2},\\,1,\\,1\\right).\n$$\n\nThe Green–Lagrange strain tensor is defined as\n$$\n\\mathbf{E}=\\frac{1}{2}\\left(\\mathbf{C}-\\mathbf{I}\\right),\n$$\nwhere $\\mathbf{I}$ is the identity tensor. Substituting the $\\mathbf{C}$ just obtained,\n$$\n\\mathbf{E}=\\frac{1}{2}\\,\\mathrm{diag}\\!\\left(\\lambda^{2}-1,\\,0,\\,0\\right)=\\mathrm{diag}\\!\\left(\\frac{\\lambda^{2}-1}{2},\\,0,\\,0\\right).\n$$\n\nThe Jacobian determinant is the determinant of the deformation gradient,\n$$\nJ=\\det\\mathbf{F}.\n$$\nFor a diagonal matrix, the determinant is the product of the diagonal entries. Hence,\n$$\nJ=\\lambda\\cdot 1\\cdot 1=\\lambda.\n$$\n\nCollecting the requested quantities in the specified order, the diagonal components are $C_{11}=\\lambda^{2}$, $C_{22}=1$, $C_{33}=1$, $E_{11}=(\\lambda^{2}-1)/2$, $E_{22}=0$, $E_{33}=0$, and the Jacobian is $J=\\lambda$.",
            "answer": "$$\\boxed{\\begin{pmatrix}\\lambda^{2} & 1 & 1 & \\frac{\\lambda^{2}-1}{2} & 0 & 0 & \\lambda\\end{pmatrix}}$$"
        },
        {
            "introduction": "Having established the tools for a static deformation, we now turn to the kinematics of a body in motion. This practice examines a steady simple shear flow, a common scenario in fluid dynamics and material processing simulations . You will compute the velocity gradient ($\\mathbf{L}$), decompose it into the rate-of-deformation ($\\mathbf{D}$) and spin ($\\mathbf{W}$) tensors, and then integrate the fundamental evolution equation $\\dot{\\mathbf{F}} = \\mathbf{L}\\mathbf{F}$ to track the deformation over time, providing a critical link between Eulerian and Lagrangian viewpoints.",
            "id": "3798628",
            "problem": "In a coarse-grained continuum representation of a steady, homogeneous simple shear flow extracted from a nonequilibrium molecular dynamics simulation, the Eulerian velocity field is given by $\\,\\mathbf{v}(\\mathbf{x}) = (\\dot{\\gamma}\\,x_{2},\\,0,\\,0)\\,$, where $\\,\\dot{\\gamma}\\,$ is a constant shear rate and $\\,\\mathbf{x} = (x_{1},x_{2},x_{3})\\,$ denotes the current spatial coordinates. Consider a material point moving with the flow and the associated deformation mapping with deformation gradient $\\,\\mathbf{F}(t)\\,$, initialized by $\\,\\mathbf{F}(0)=\\mathbf{I}\\,$, where $\\,\\mathbf{I}\\,$ is the identity tensor. Using only core kinematic definitions and standard linear ordinary differential equation theory, do the following:\n- Compute the velocity gradient $\\,\\mathbf{L} := \\nabla_{\\mathbf{x}}\\mathbf{v}\\,$, the rate-of-deformation tensor $\\,\\mathbf{D} := \\tfrac{1}{2}\\left(\\mathbf{L}+\\mathbf{L}^{\\top}\\right)\\,$, and the spin tensor $\\,\\mathbf{W} := \\tfrac{1}{2}\\left(\\mathbf{L}-\\mathbf{L}^{\\top}\\right)\\,$.\n- Integrate the kinematic evolution equation $\\,\\dot{\\mathbf{F}} = \\mathbf{L}\\,\\mathbf{F}\\,$ subject to $\\,\\mathbf{F}(0)=\\mathbf{I}\\,$ to obtain a closed-form expression for $\\,\\mathbf{F}(t)\\,$.\n\nExpress your final answers symbolically in terms of $\\,\\dot{\\gamma}\\,$ and $\\,t\\,$. No numerical evaluation or rounding is required. Provide the final expressions for $\\,\\mathbf{L}\\,$, $\\,\\mathbf{D}\\,$, $\\,\\mathbf{W}\\,$, and $\\,\\mathbf{F}(t)\\,$.",
            "solution": "The task is to compute the velocity gradient and related kinematic tensors from the given Eulerian velocity field, and then integrate the evolution equation for the deformation gradient. The fundamental bases used are the core definitions of the velocity gradient, rate-of-deformation, and spin tensors in continuum kinematics, along with standard linear ordinary differential equation theory for constant-coefficient systems.\n\nStep 1: Compute the velocity gradient.\nBy definition, the velocity gradient $\\,\\mathbf{L}\\,$ is the spatial gradient of the velocity field with respect to the current coordinates, i.e., $\\,L_{ij} = \\partial v_{i}/\\partial x_{j}\\,$. The given velocity field is $\\,\\mathbf{v}(\\mathbf{x}) = (\\dot{\\gamma}\\,x_{2},\\,0,\\,0)\\,$. Its components are $\\,v_{1}=\\dot{\\gamma}\\,x_{2}\\,$, $\\,v_{2}=0\\,$, and $\\,v_{3}=0\\,$. Therefore,\n- $\\,\\partial v_{1}/\\partial x_{1} = 0\\,$,\n- $\\,\\partial v_{1}/\\partial x_{2} = \\dot{\\gamma}\\,$,\n- $\\,\\partial v_{1}/\\partial x_{3} = 0\\,$,\n- $\\,\\partial v_{2}/\\partial x_{j} = 0\\,$ for all $\\,j\\,$,\n- $\\,\\partial v_{3}/\\partial x_{j} = 0\\,$ for all $\\,j\\,$.\nThus,\n$$\n\\mathbf{L} = \\begin{pmatrix}\n0 & \\dot{\\gamma} & 0 \\\\\n0 & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n$$\n\nStep 2: Compute the rate-of-deformation and spin tensors.\nBy definition,\n$$\n\\mathbf{D} = \\tfrac{1}{2}\\left(\\mathbf{L}+\\mathbf{L}^{\\top}\\right), \\qquad\n\\mathbf{W} = \\tfrac{1}{2}\\left(\\mathbf{L}-\\mathbf{L}^{\\top}\\right).\n$$\nFirst compute the transpose:\n$$\n\\mathbf{L}^{\\top} = \\begin{pmatrix}\n0 & 0 & 0 \\\\\n\\dot{\\gamma} & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n$$\nThen,\n$$\n\\mathbf{D} = \\tfrac{1}{2}\\begin{pmatrix}\n0 & \\dot{\\gamma} & 0 \\\\\n0 & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n+\\tfrac{1}{2}\\begin{pmatrix}\n0 & 0 & 0 \\\\\n\\dot{\\gamma} & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 & \\tfrac{\\dot{\\gamma}}{2} & 0 \\\\\n\\tfrac{\\dot{\\gamma}}{2} & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n$$\nand\n$$\n\\mathbf{W} = \\tfrac{1}{2}\\begin{pmatrix}\n0 & \\dot{\\gamma} & 0 \\\\\n0 & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n-\\tfrac{1}{2}\\begin{pmatrix}\n0 & 0 & 0 \\\\\n\\dot{\\gamma} & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 & \\tfrac{\\dot{\\gamma}}{2} & 0 \\\\\n-\\tfrac{\\dot{\\gamma}}{2} & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n$$\n\nStep 3: Integrate the evolution equation for the deformation gradient.\nThe kinematic evolution equation is\n$$\n\\dot{\\mathbf{F}}(t) = \\mathbf{L}\\,\\mathbf{F}(t), \\qquad \\mathbf{F}(0)=\\mathbf{I}.\n$$\nHere $\\,\\mathbf{L}\\,$ is constant in space and time for the given steady simple shear. For a constant matrix $\\,\\mathbf{L}\\,$, the unique solution of $\\,\\dot{\\mathbf{F}}=\\mathbf{L}\\mathbf{F}\\,$ with $\\,\\mathbf{F}(0)=\\mathbf{I}\\,$ is given by the matrix exponential\n$$\n\\mathbf{F}(t) = \\exp\\!\\left(\\mathbf{L}\\,t\\right).\n$$\nTo evaluate this exponential, use the series definition\n$$\n\\exp\\!\\left(\\mathbf{L}\\,t\\right) = \\mathbf{I} + t\\,\\mathbf{L} + \\tfrac{t^{2}}{2!}\\mathbf{L}^{2} + \\tfrac{t^{3}}{3!}\\mathbf{L}^{3} + \\cdots.\n$$\nNote that $\\,\\mathbf{L}\\,$ is nilpotent of index $\\,2\\,$, because $\\,\\mathbf{L}\\,$ has only a single nonzero superdiagonal entry and therefore\n$$\n\\mathbf{L}^{2} = \\mathbf{0}.\n$$\nConsequently, all powers $\\,\\mathbf{L}^{n}\\,$ for $\\,n\\geq 2\\,$ vanish, and the series truncates exactly:\n$$\n\\exp\\!\\left(\\mathbf{L}\\,t\\right) = \\mathbf{I} + t\\,\\mathbf{L}.\n$$\nTherefore,\n$$\n\\mathbf{F}(t) = \\mathbf{I} + t\\,\\mathbf{L}\n= \\begin{pmatrix}\n1 & 0 & 0 \\\\\n0 & 1 & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}\n+\nt\\begin{pmatrix}\n0 & \\dot{\\gamma} & 0 \\\\\n0 & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1 & \\dot{\\gamma}\\,t & 0 \\\\\n0 & 1 & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}\n$$\n\nStep 4: Consistency checks.\nThe trace $\\,\\operatorname{tr}(\\mathbf{L})=0\\,$, so $\\,\\det\\mathbf{F}(t)=1\\,$, consistent with incompressibility of the simple shear flow. The symmetric and skew-symmetric parts $\\,\\mathbf{D}\\,$ and $\\,\\mathbf{W}\\,$ respectively capture the extensional and rotational contributions induced by the shear rate $\\,\\dot{\\gamma}\\,$.\n\nCollecting the results:\n$$\n\\mathbf{L} = \\begin{pmatrix}\n0 & \\dot{\\gamma} & 0 \\\\\n0 & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}, \\quad\n\\mathbf{D} = \\begin{pmatrix}\n0 & \\tfrac{\\dot{\\gamma}}{2} & 0 \\\\\n\\tfrac{\\dot{\\gamma}}{2} & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}, \\quad\n\\mathbf{W} = \\begin{pmatrix}\n0 & \\tfrac{\\dot{\\gamma}}{2} & 0 \\\\\n-\\tfrac{\\dot{\\gamma}}{2} & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}, \\quad\n\\mathbf{F}(t) = \\begin{pmatrix}\n1 & \\dot{\\gamma}\\,t & 0 \\\\\n0 & 1 & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}.\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}\n\\begin{pmatrix}\n0 & \\dot{\\gamma} & 0\\\\\n0 & 0 & 0\\\\\n0 & 0 & 0\n\\end{pmatrix} &\n\\begin{pmatrix}\n0 & \\tfrac{\\dot{\\gamma}}{2} & 0\\\\\n\\tfrac{\\dot{\\gamma}}{2} & 0 & 0\\\\\n0 & 0 & 0\n\\end{pmatrix} &\n\\begin{pmatrix}\n0 & \\tfrac{\\dot{\\gamma}}{2} & 0\\\\\n-\\tfrac{\\dot{\\gamma}}{2} & 0 & 0\\\\\n0 & 0 & 0\n\\end{pmatrix} &\n\\begin{pmatrix}\n1 & \\dot{\\gamma} t & 0\\\\\n0 & 1 & 0\\\\\n0 & 0 & 1\n\\end{pmatrix}\n\\end{pmatrix}}$$"
        },
        {
            "introduction": "Our final practice bridges the gap between analytical theory and computational implementation, a critical step in modern materials simulation. While simple flows may allow for exact solutions, most real-world scenarios involve complex, time-dependent velocity gradients that require numerical integration . In this exercise, you will implement and compare two different numerical schemes to solve the evolution equation $\\dot{\\mathbf{F}}=\\mathbf{L}(t)\\mathbf{F}$, gaining firsthand insight into the challenges of accuracy, stability, and the necessity of 'structure-preserving' algorithms for handling large rotations.",
            "id": "3798581",
            "problem": "You are given the rate equation of the deformation gradient in continuum kinematics, which arises from the motion mapping of a deforming body in multiscale materials simulation. Let $\\boldsymbol{\\varphi}(\\mathbf{X},t)$ denote the motion mapping from the reference configuration to the current configuration, where $\\mathbf{x}=\\boldsymbol{\\varphi}(\\mathbf{X},t)$. The deformation gradient is defined as $\\mathbf{F}(\\mathbf{X},t)=\\partial \\mathbf{x}/\\partial \\mathbf{X}$, and the spatial velocity is $\\mathbf{v}(\\mathbf{x},t)=\\partial \\boldsymbol{\\varphi}/\\partial t$. The spatial velocity gradient is $\\mathbf{L}(\\mathbf{x},t)=\\nabla \\mathbf{v}(\\mathbf{x},t)$. Under the usual smoothness assumptions, the transport of $\\mathbf{F}$ satisfies the ordinary differential equation (ODE) $\\dot{\\mathbf{F}}=\\mathbf{L}(t)\\mathbf{F}$ along material trajectories.\n\nYour task is to develop a program that numerically integrates the matrix ODE $\\dot{\\mathbf{F}}=\\mathbf{L}(t)\\mathbf{F}$ for specified time-dependent and time-independent $\\mathbf{L}(t)$, and computes well-defined accuracy and structure-preservation metrics. You must implement two distinct time-stepping schemes:\n- A first-order explicit scheme based on a forward time discretization at $t_k$.\n- A second-order structure-preserving scheme that uses the matrix exponential evaluated at the midpoint $t_{k+\\frac{1}{2}}$.\n\nYou may use a standard matrix exponential routine for the second-order scheme. You must derive your implementation from core definitions and properties of $\\mathbf{F}$ and $\\mathbf{L}$, without assuming any shortcut formulas not implied by those definitions.\n\nAngles must be treated in radians, and time in seconds. All physical quantities in the test suite below use these units.\n\nDefine the skew-symmetric matrix $\\mathbf{W}(\\boldsymbol{\\omega})$ associated with an angular velocity vector $\\boldsymbol{\\omega}=[\\omega_x,\\omega_y,\\omega_z]^T$ by\n$$\n\\mathbf{W}(\\boldsymbol{\\omega})=\\begin{bmatrix}\n0 & -\\omega_z & \\omega_y \\\\\n\\omega_z & 0 & -\\omega_x \\\\\n-\\omega_y & \\omega_x & 0\n\\end{bmatrix}.\n$$\n\nImplement the following three test cases with the initial condition $\\mathbf{F}(0)=\\mathbf{I}$, where $\\mathbf{I}$ is the identity matrix. In all cases, use a uniform time step $\\Delta t=T/N$.\n\n- Test Case $1$ (pure large rotation, time-independent): Let $\\boldsymbol{\\omega}(t)=[0,0,\\omega]^T$ with $\\omega$ constant. Set $\\omega=200\\,\\text{rad/s}$, $T=0.05\\,\\text{s}$, and $N=200$. Define $\\mathbf{L}(t)=\\mathbf{W}(\\boldsymbol{\\omega})$. Compute the final deformation gradient $\\mathbf{F}(T)$ by both schemes. For a time-independent $\\mathbf{L}$, the exact solution is $\\mathbf{F}_{\\text{exact}}(T)=\\exp(T\\mathbf{L})$. For this test, compute the Frobenius norm errors $e_{\\mathrm{E}}=\\lVert \\mathbf{F}_{\\mathrm{E}}(T)-\\mathbf{F}_{\\text{exact}}(T)\\rVert_F$ and $e_{\\mathrm{M}}=\\lVert \\mathbf{F}_{\\mathrm{M}}(T)-\\mathbf{F}_{\\text{exact}}(T)\\rVert_F$, where $\\mathbf{F}_{\\mathrm{E}}$ and $\\mathbf{F}_{\\mathrm{M}}$ denote the forward explicit and exponential-midpoint solutions, respectively.\n\n- Test Case $2$ (combined rotation and stretch, time-independent): Let $\\boldsymbol{\\omega}(t)=[0,0,\\omega]^T$ with $\\omega=120\\,\\text{rad/s}$, and let $\\mathbf{D}=\\mathrm{diag}(0.3,-0.15,-0.15)\\,\\text{s}^{-1}$, which is symmetric and has zero trace. Define $\\mathbf{L}(t)=\\mathbf{W}(\\boldsymbol{\\omega})+\\mathbf{D}$. Set $T=0.03\\,\\text{s}$ and $N=300$. Compute $\\mathbf{F}(T)$ by both schemes and the exact solution $\\mathbf{F}_{\\text{exact}}(T)=\\exp(T\\mathbf{L})$. Report $e_{\\mathrm{E}}=\\lVert \\mathbf{F}_{\\mathrm{E}}(T)-\\mathbf{F}_{\\text{exact}}(T)\\rVert_F$ and $e_{\\mathrm{M}}=\\lVert \\mathbf{F}_{\\mathrm{M}}(T)-\\mathbf{F}_{\\text{exact}}(T)\\rVert_F$.\n\n- Test Case $3$ (time-dependent large rotation with volume-preserving stretch): Let $\\boldsymbol{\\omega}(t)=[0,0,\\omega_0\\cos(\\alpha t)]^T$ with $\\omega_0=180\\,\\text{rad/s}$ and $\\alpha=60\\,\\text{s}^{-1}$. Let $\\mathbf{D}(t)=\\mathrm{diag}(d(t),-d(t)/2,-d(t)/2)$ with $d(t)=0.4\\cos(20 t)\\,\\text{s}^{-1}$. Define $\\mathbf{L}(t)=\\mathbf{W}(\\boldsymbol{\\omega}(t))+\\mathbf{D}(t)$. Set $T=0.05\\,\\text{s}$ and $N=1000$. For this time-dependent and traceless $\\mathbf{L}(t)$, the exact Jacobian determinant satisfies $\\det\\mathbf{F}(T)=1$ if integrated exactly. Compute the determinant deviations $\\delta_{\\mathrm{E}}=\\lvert \\det\\mathbf{F}_{\\mathrm{E}}(T)-1\\rvert$ and $\\delta_{\\mathrm{M}}=\\lvert \\det\\mathbf{F}_{\\mathrm{M}}(T)-1\\rvert$.\n\nYour program must produce a single line of output containing the results for all three tests and both schemes as a comma-separated list enclosed in square brackets:\n$[e_{\\mathrm{E}}^{(1)},e_{\\mathrm{M}}^{(1)},e_{\\mathrm{E}}^{(2)},e_{\\mathrm{M}}^{(2)},\\delta_{\\mathrm{E}}^{(3)},\\delta_{\\mathrm{M}}^{(3)}]$.\nHere, the superscripts denote the test case number. Each entry must be a floating-point number. Angles must be in radians and time in seconds. No other text should be printed.",
            "solution": "The problem presented is valid. It is a well-posed initial value problem grounded in the fundamental principles of continuum mechanics, specifically finite-strain kinematics. All parameters and objectives are clearly and objectively defined, and the computational tasks are feasible.\n\nThe core of the problem is the numerical integration of the matrix ordinary differential equation (ODE) governing the evolution of the deformation gradient, $\\mathbf{F}$. This equation is given as:\n$$\n\\frac{d\\mathbf{F}}{dt} = \\dot{\\mathbf{F}} = \\mathbf{L}(t)\\mathbf{F}(t)\n$$\nHere, $\\mathbf{F}$ is the deformation gradient, and $\\mathbf{L}$ is the spatial velocity gradient. The initial condition for all test cases is an undeformed state, $\\mathbf{F}(0) = \\mathbf{I}$, where $\\mathbf{I}$ is the $3 \\times 3$ identity matrix. We are tasked with implementing two numerical schemes to solve for $\\mathbf{F}(T)$ over a time interval $[0, T]$ using $N$ uniform time steps of size $\\Delta t = T/N$.\n\nLet $\\mathbf{F}_k$ denote the numerical approximation of $\\mathbf{F}$ at time $t_k = k\\Delta t$. The two required schemes are derived as follows.\n\n**Scheme 1: First-Order Explicit Forward Time Discretization**\n\nThis scheme, commonly known as the forward Euler method, is derived by approximating the time derivative at time $t_k$ using a first-order forward difference:\n$$\n\\frac{\\mathbf{F}_{k+1} - \\mathbf{F}_k}{\\Delta t} \\approx \\dot{\\mathbf{F}}(t_k)\n$$\nSubstituting the governing ODE, we have:\n$$\n\\frac{\\mathbf{F}_{k+1} - \\mathbf{F}_k}{\\Delta t} = \\mathbf{L}(t_k)\\mathbf{F}_k\n$$\nRearranging for $\\mathbf{F}_{k+1}$ yields the iterative update rule. Letting $\\mathbf{L}_k = \\mathbf{L}(t_k)$:\n$$\n\\mathbf{F}_{k+1} = \\mathbf{F}_k + \\Delta t \\, \\mathbf{L}_k \\mathbf{F}_k = (\\mathbf{I} + \\Delta t \\, \\mathbf{L}_k)\\mathbf{F}_k\n$$\nThis is a first-order accurate method. It is computationally simple but generally does not preserve the geometric structure of the solution. For instance, if $\\mathbf{L}$ is skew-symmetric, $\\mathbf{F}$ should remain a rotation matrix (orthogonal with determinant $1$), but the update matrix $(\\mathbf{I} + \\Delta t \\, \\mathbf{L}_k)$ is not orthogonal, introducing numerical errors that violate this property.\n\n**Scheme 2: Second-Order Structure-Preserving Midpoint Scheme**\n\nThis scheme leverages the matrix exponential to provide a more accurate and stable integration. The exact solution to the ODE over a small interval $[t_k, t_{k+1}]$, if $\\mathbf{L}$ were constant over that interval, would be $\\mathbf{F}(t_{k+1}) = \\exp(\\Delta t \\, \\mathbf{L}) \\mathbf{F}(t_k)$. To achieve second-order accuracy for a time-varying $\\mathbf{L}(t)$, we approximate $\\mathbf{L}$ by its value at the midpoint of the time interval, $t_{k+1/2} = t_k + \\Delta t/2$.\nLet $\\mathbf{L}_{k+1/2} = \\mathbf{L}(t_{k+1/2})$. The update rule is:\n$$\n\\mathbf{F}_{k+1} = \\exp(\\Delta t \\, \\mathbf{L}_{k+1/2}) \\mathbf{F}_k\n$$\nThis method is known as an exponential midpoint rule or a first-order Magnus integrator. It is second-order accurate. Crucially, it is \"structure-preserving\" because the matrix exponential map, $\\mathbf{A} \\mapsto \\exp(\\mathbf{A})$, maps elements from a Lie algebra to the corresponding Lie group. For instance:\n- If $\\mathbf{L}(t)$ is skew-symmetric (i.e., belongs to the Lie algebra $\\mathfrak{so}(3)$), then $\\exp(\\Delta t \\, \\mathbf{L}_{k+1/2})$ is a special orthogonal matrix (a rotation, in $SO(3)$). This conserves the rotational nature of $\\mathbf{F}$.\n- If $\\mathbf{L}(t)$ is traceless (i.e., belongs to the Lie algebra $\\mathfrak{sl}(3)$), then $\\det(\\exp(\\Delta t \\, \\mathbf{L}_{k+1/2})) = \\exp(\\mathrm{tr}(\\Delta t \\, \\mathbf{L}_{k+1/2})) = \\exp(0) = 1$. This conserves the volume, since $\\det(\\mathbf{F}_{k+1}) = \\det(\\exp(\\dots))\\det(\\mathbf{F}_k) = \\det(\\mathbf{F}_k)$.\n\nWe now apply these schemes to the three test cases.\n\n**Test Case $1$: Time-Independent Pure Rotation**\n- Parameters: $\\boldsymbol{\\omega} = [0, 0, 200]^T\\,\\text{rad/s}$, $T = 0.05\\,\\text{s}$, $N = 200$.\n- The velocity gradient is constant: $\\mathbf{L}(t) = \\mathbf{W}(\\boldsymbol{\\omega})$.\n- The exact solution at time $T$ is $\\mathbf{F}_{\\text{exact}}(T) = \\exp(T\\mathbf{L})$.\n- The midpoint scheme's update is $\\mathbf{F}_{k+1} = \\exp(\\Delta t \\, \\mathbf{L})\\mathbf{F}_k$. After $N$ steps, $\\mathbf{F}_{\\mathrm{M}}(T) = (\\exp(\\Delta t \\, \\mathbf{L}))^N \\mathbf{I} = \\exp(N\\Delta t \\, \\mathbf{L}) = \\exp(T\\mathbf{L}) = \\mathbf{F}_{\\text{exact}}(T)$. Thus, the error $e_{\\mathrm{M}}$ is expected to be near machine precision. The forward Euler scheme will accumulate error due to its non-orthogonality.\n\n**Test Case $2$: Time-Independent Rotation and Stretch**\n- Parameters: $\\boldsymbol{\\omega} = [0, 0, 120]^T\\,\\text{rad/s}$, $\\mathbf{D} = \\mathrm{diag}(0.3, -0.15, -0.15)\\,\\text{s}^{-1}$, $T = 0.03\\,\\text{s}$, $N = 300$.\n- The velocity gradient is constant: $\\mathbf{L}(t) = \\mathbf{W}(\\boldsymbol{\\omega}) + \\mathbf{D}$.\n- The logic is identical to Test Case $1$. The exact solution is $\\mathbf{F}_{\\text{exact}}(T) = \\exp(T\\mathbf{L})$, and the midpoint scheme should reproduce this result with high fidelity, yielding a very small error $e_{\\mathrm{M}}$.\n\n**Test Case $3$: Time-Dependent Rotation and Stretch**\n- Parameters: $\\boldsymbol{\\omega}(t) = [0, 0, 180\\cos(60t)]^T\\,\\text{rad/s}$, $\\mathbf{D}(t) = \\mathrm{diag}(d(t), -d(t)/2, -d(t)/2)$ with $d(t) = 0.4\\cos(20t)\\,\\text{s}^{-1}$, $T = 0.05\\,\\text{s}$, $N = 1000$.\n- The velocity gradient $\\mathbf{L}(t) = \\mathbf{W}(\\boldsymbol{\\omega}(t)) + \\mathbf{D}(t)$ is time-dependent.\n- A key property is that $\\mathrm{tr}(\\mathbf{L}(t)) = d(t) - d(t)/2 - d(t)/2 = 0$ for all $t$. This signifies a volume-preserving (isochoric) flow. The exact solution must satisfy $\\det(\\mathbf{F}(T)) = \\det(\\mathbf{F}(0)) = \\det(\\mathbf{I}) = 1$.\n- We assess the schemes by their ability to preserve this property. The determinant deviation for each scheme, $\\delta = |\\det(\\mathbf{F}(T)) - 1|$, is calculated. Due to its structure-preserving nature, the midpoint scheme is expected to maintain $\\det(\\mathbf{F}_k) = 1$ throughout the integration, resulting in $\\delta_{\\mathrm{M}}$ being near machine precision. The forward Euler scheme is not expected to preserve this property, leading to a larger $\\delta_{\\mathrm{E}}$.\n\nThe implementation will proceed by iterating through the time steps for each case, applying the respective update rules, and finally computing the specified metrics.",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the final results.\n    \"\"\"\n\n    # Helper function to create the skew-symmetric matrix W\n    def make_W(omega_vec):\n        wx, wy, wz = omega_vec\n        return np.array([\n            [0.0, -wz, wy],\n            [wz, 0.0, -wx],\n            [-wy, wx, 0.0]\n        ])\n\n    def solve_case_1():\n        \"\"\"\n        Solves Test Case 1: pure large rotation, time-independent.\n        \"\"\"\n        omega_val = 200.0\n        T = 0.05\n        N = 200\n        dt = T / N\n\n        omega_vec = np.array([0.0, 0.0, omega_val])\n        L = make_W(omega_vec)\n\n        # Scheme 1: Forward Explicit (FE)\n        F_E = np.identity(3)\n        integrator_E = np.identity(3) + dt * L\n        for _ in range(N):\n            F_E = integrator_E @ F_E\n\n        # Scheme 2: Exponential Midpoint (EM)\n        F_M = np.identity(3)\n        integrator_M = expm(dt * L)\n        for _ in range(N):\n            F_M = integrator_M @ F_M\n\n        # Exact Solution\n        F_exact = expm(T * L)\n\n        # Compute Frobenius norm errors\n        e_E = np.linalg.norm(F_E - F_exact, 'fro')\n        e_M = np.linalg.norm(F_M - F_exact, 'fro')\n\n        return e_E, e_M\n\n    def solve_case_2():\n        \"\"\"\n        Solves Test Case 2: combined rotation and stretch, time-independent.\n        \"\"\"\n        omega_val = 120.0\n        D = np.diag([0.3, -0.15, -0.15])\n        T = 0.03\n        N = 300\n        dt = T / N\n\n        omega_vec = np.array([0.0, 0.0, omega_val])\n        W = make_W(omega_vec)\n        L = W + D\n\n        # Scheme 1: Forward Explicit (FE)\n        F_E = np.identity(3)\n        integrator_E = np.identity(3) + dt * L\n        for _ in range(N):\n            F_E = integrator_E @ F_E\n\n        # Scheme 2: Exponential Midpoint (EM)\n        F_M = np.identity(3)\n        integrator_M = expm(dt * L)\n        for _ in range(N):\n            F_M = integrator_M @ F_M\n        \n        # Exact Solution\n        F_exact = expm(T * L)\n\n        # Compute Frobenius norm errors\n        e_E = np.linalg.norm(F_E - F_exact, 'fro')\n        e_M = np.linalg.norm(F_M - F_exact, 'fro')\n\n        return e_E, e_M\n\n    def solve_case_3():\n        \"\"\"\n        Solves Test Case 3: time-dependent rotation and volume-preserving stretch.\n        \"\"\"\n        omega0 = 180.0\n        alpha = 60.0\n        d_amp = 0.4\n        d_freq = 20.0\n        T = 0.05\n        N = 1000\n        dt = T / N\n\n        # Define L(t) as a function\n        def get_L(t):\n            wz_t = omega0 * np.cos(alpha * t)\n            d_t = d_amp * np.cos(d_freq * t)\n            omega_vec_t = np.array([0.0, 0.0, wz_t])\n            W_t = make_W(omega_vec_t)\n            D_t = np.diag([d_t, -d_t / 2.0, -d_t / 2.0])\n            return W_t + D_t\n\n        # Scheme 1: Forward Explicit (FE)\n        F_E = np.identity(3)\n        for k in range(N):\n            t_k = k * dt\n            L_k = get_L(t_k)\n            F_E = (np.identity(3) + dt * L_k) @ F_E\n\n        # Scheme 2: Exponential Midpoint (EM)\n        F_M = np.identity(3)\n        for k in range(N):\n            t_k_half = (k + 0.5) * dt\n            L_k_half = get_L(t_k_half)\n            F_M = expm(dt * L_k_half) @ F_M\n\n        # Compute determinant deviations\n        delta_E = abs(np.linalg.det(F_E) - 1.0)\n        delta_M = abs(np.linalg.det(F_M) - 1.0)\n\n        return delta_E, delta_M\n\n    # Run all test cases\n    e_E1, e_M1 = solve_case_1()\n    e_E2, e_M2 = solve_case_2()\n    delta_E3, delta_M3 = solve_case_3()\n    \n    # Collate results\n    results = [e_E1, e_M1, e_E2, e_M2, delta_E3, delta_M3]\n    \n    # Print in the required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}