{
    "hands_on_practices": [
        {
            "introduction": "理解原子间相互作用的第一步是掌握描述弱非共价键的经典模型。本练习将引导你使用伦纳德-琼斯（Lennard-Jones）势来模拟稀有气体原子间的范德华力（van der Waals force）。通过从其数学形式中推导平衡分离距离和结合能等关键物理量，你将亲身体验一个简洁的对势如何捕捉到短程排斥和长程吸引的物理本质，并学会如何将其预测与实验数据进行比较。",
            "id": "3817684",
            "problem": "在多尺度材料模拟中，对于弱原子间键合的粗粒化描述，例如稀有气体原子之间的 van der Waals 相互作用，通常采用 Lennard-Jones (LJ) 对势。考虑两个 argon 原子通过 Lennard-Jones (LJ) 势相互作用\n$$\nV(R)=4\\epsilon\\left[\\left(\\frac{\\sigma}{R}\\right)^{12}-\\left(\\frac{\\sigma}{R}\\right)^{6}\\right],\n$$\n为 argon 校准的参数值为 $\\sigma = 3.405\\,\\text{\\AA}$ 和 $\\epsilon/k_{B} = 119.8\\,\\text{K}$，其中 $k_{B}$ 是 Boltzmann 常数。取无穷远分离处为能量零点，因此 $V(\\infty)=0$。假设二聚体结合能的大小由 $|V(R_{\\mathrm{eq}})|$ 给出，其中 $R_{\\mathrm{eq}}$ 是使 $V(R)$ 最小化的平衡间距。\n\n对于 argon 二聚体的实验参考数据，取平衡间距 $R_{\\mathrm{exp}}=3.760\\,\\text{\\AA}$ 和势阱深度 $D_{e}/k_{B}=99.0\\,\\text{K}$。\n\n仅使用微积分和给定的势函数，首先确定 LJ 模型预测的 $R_{\\mathrm{eq}}$ 和结合能大小的解析表达式。然后，使用所提供的数值，计算 LJ 预测值与实验值之间的均方根相对偏差，其定义为\n$$\n\\Delta_{\\mathrm{RMS}}=\\sqrt{\\frac{1}{2}\\left[\\left(\\frac{|R_{\\mathrm{eq}}-R_{\\mathrm{exp}}|}{R_{\\mathrm{exp}}}\\right)^{2}+\\left(\\frac{|\\epsilon-D_{e}|}{D_{e}}\\right)^{2}\\right]}。\n$$\n将最终答案表示为一个纯数（无单位），并四舍五入至四位有效数字。",
            "solution": "第一步是确定 Lennard-Jones (LJ) 模型预测的平衡间距 $R_{\\mathrm{eq}}$ 和结合能的解析表达式。平衡间距是使势函数 $V(R)$ 最小化的 $R$ 值。这可以通过将势函数对 $R$ 的一阶导数设为零来求得。\n\nLJ 势由下式给出：\n$$\nV(R) = 4\\epsilon\\left[\\left(\\frac{\\sigma}{R}\\right)^{12}-\\left(\\frac{\\sigma}{R}\\right)^{6}\\right] = 4\\epsilon[\\sigma^{12}R^{-12} - \\sigma^{6}R^{-6}]\n$$\n我们求导数 $\\frac{dV}{dR}$：\n$$\n\\frac{dV}{dR} = 4\\epsilon[-12\\sigma^{12}R^{-13} - (-6)\\sigma^{6}R^{-7}] = 24\\epsilon [-\\frac{2\\sigma^{12}}{R^{13}} + \\frac{\\sigma^{6}}{R^{7}}]\n$$\n将导数设为零以求极值：\n$$\n\\frac{dV}{dR} = 0\n$$\n$$\n-\\frac{2\\sigma^{12}}{R^{13}} + \\frac{\\sigma^{6}}{R^{7}} = 0\n$$\n$$\n\\frac{\\sigma^{6}}{R^{7}} = \\frac{2\\sigma^{12}}{R^{13}}\n$$\n假设 $R \\neq 0$ 且 $\\sigma \\neq 0$，我们可以简化为：\n$$\nR^{6} = 2\\sigma^{6}\n$$\n解出 $R$ 得到平衡间距 $R_{\\mathrm{eq}}$：\n$$\nR_{\\mathrm{eq}} = (2)^{1/6}\\sigma\n$$\n为确认这是一个最小值，二阶导数 $\\frac{d^2V}{dR^2}$ 在 $R=R_{\\mathrm{eq}}$ 时必须为正。经计算表明情况确实如此。\n\n接下来，我们确定在此间距下的势能 $V(R_{\\mathrm{eq}})$。我们将 $R_{\\mathrm{eq}} = 2^{1/6}\\sigma$ 代入势能表达式：\n$$\nV(R_{\\mathrm{eq}}) = 4\\epsilon\\left[\\left(\\frac{\\sigma}{2^{1/6}\\sigma}\\right)^{12}-\\left(\\frac{\\sigma}{2^{1/6}\\sigma}\\right)^{6}\\right]\n$$\n$$\nV(R_{\\mathrm{eq}}) = 4\\epsilon\\left[(2^{-1/6})^{12}-(2^{-1/6})^{6}\\right] = 4\\epsilon[2^{-2} - 2^{-1}]\n$$\n$$\nV(R_{\\mathrm{eq}}) = 4\\epsilon\\left[\\frac{1}{4} - \\frac{1}{2}\\right] = 4\\epsilon\\left[-\\frac{1}{4}\\right] = -\\epsilon\n$$\n问题将结合能大小定义为 $|V(R_{\\mathrm{eq}})|$。因此，LJ 模型预测的结合能为：\n$$\n|V(R_{\\mathrm{eq}})| = |-\\epsilon| = \\epsilon\n$$\n这证实了 LJ 势中的参数 $\\epsilon$ 正是势阱深度（即结合能的大小）。均方根相对偏差 $\\Delta_{\\mathrm{RMS}}$ 的公式正确地使用 $\\epsilon$ 作为与实验势阱深度 $D_e$ 进行比较的理论值。\n\n解析表达式为 $R_{\\mathrm{eq}} = 2^{1/6}\\sigma$ 和 $|V(R_{\\mathrm{eq}})| = \\epsilon$。\n\n现在我们进行数值计算。给定的值为：\n- $\\sigma = 3.405\\,\\text{\\AA}$\n- $\\epsilon/k_{B} = 119.8\\,\\text{K}$\n- $R_{\\mathrm{exp}} = 3.760\\,\\text{\\AA}$\n- $D_{e}/k_{B} = 99.0\\,\\text{K}$\n\n首先，我们计算 LJ 预测的平衡间距：\n$$\nR_{\\mathrm{eq}} = 2^{1/6}\\sigma = (2)^{1/6} \\times (3.405\\,\\text{\\AA}) \\approx 1.122462048 \\times 3.405\\,\\text{\\AA} \\approx 3.82198027\\,\\text{\\AA}\n$$\nLJ 预测的势阱深度（以开尔文为单位）直接给出为 $\\epsilon/k_{B} = 119.8\\,\\text{K}$。\n\n接下来，我们计算间距的相对偏差 $\\delta_R$：\n$$\n\\delta_R = \\frac{|R_{\\mathrm{eq}}-R_{\\mathrm{exp}}|}{R_{\\mathrm{exp}}} = \\frac{|3.82198027\\,\\text{\\AA} - 3.760\\,\\text{\\AA}|}{3.760\\,\\text{\\AA}} = \\frac{0.06198027}{3.760} \\approx 0.01648411\n$$\n然后，我们计算能量的相对偏差 $\\delta_E$。我们可以使用能量除以 $k_B$ 后的值进行计算：\n$$\n\\delta_E = \\frac{|\\epsilon-D_{e}|}{D_{e}} = \\frac{|\\epsilon/k_B - D_{e}/k_B|}{D_{e}/k_B} = \\frac{|119.8\\,\\text{K} - 99.0\\,\\text{K}|}{99.0\\,\\text{K}} = \\frac{20.8}{99.0} \\approx 0.21010101...\n$$\n最后，我们计算均方根相对偏差 $\\Delta_{\\mathrm{RMS}}$：\n$$\n\\Delta_{\\mathrm{RMS}} = \\sqrt{\\frac{1}{2}\\left[\\delta_R^2 + \\delta_E^2\\right]}\n$$\n$$\n\\Delta_{\\mathrm{RMS}} = \\sqrt{\\frac{1}{2}\\left[(0.01648411)^2 + (0.21010101...)^2\\right]}\n$$\n$$\n\\Delta_{\\mathrm{RMS}} = \\sqrt{\\frac{1}{2}\\left[0.0002717259... + 0.0441424344...\\right]}\n$$\n$$\n\\Delta_{\\mathrm{RMS}} = \\sqrt{\\frac{1}{2}\\left[0.0444141603...\\right]}\n$$\n$$\n\\Delta_{\\mathrm{RMS}} = \\sqrt{0.0222070801...} \\approx 0.14902040\n$$\n将结果四舍五入到四位有效数字得到 $0.1490$。",
            "answer": "$$\n\\boxed{0.1490}\n$$"
        },
        {
            "introduction": "在超越简单对势之后，我们需要更深入地探究化学键的本质，特别是其离子性和共价性。本练习将带你从第一性原理出发，探讨原子得失电子的趋势（通过电离能和电子亲和能来量化）如何引出电负性这一核心概念。你将推导并比较两种经典的电负性标度——马利肯（Mulliken）标度和类鲍林（Pauling-type）标度——并运用它们来预测不同原子对之间键的极性，这对于参数化多尺度模型中的电荷转移至关重要。",
            "id": "3817616",
            "problem": "在多尺度材料模拟中，原子间键极性是用于参数化电荷转移和极化率的介观模型的关键描述符。两种广泛使用的、以原子为中心且能表征键极性的度量是Mulliken电负性和Pauling电负性差。考虑三种原子种类 $A$、$B$ 和 $C$，其孤立原子的电子能量学分别代表类碱金属原子、类氧原子和类卤素原子。给定以下经过充分检验的电离势和电子亲和能（垂直，气相）作为输入数据：\n- $A$：$E_{\\mathrm{IP}} = 5.20\\,\\mathrm{eV}$，$E_{\\mathrm{EA}} = 0.60\\,\\mathrm{eV}$，\n- $B$：$E_{\\mathrm{IP}} = 13.60\\,\\mathrm{eV}$，$E_{\\mathrm{EA}} = 1.50\\,\\mathrm{eV}$，\n- $C$：$E_{\\mathrm{IP}} = 13.00\\,\\mathrm{eV}$，$E_{\\mathrm{EA}} = 3.60\\,\\mathrm{eV}$。\n\n此外，还给定异核双原子分子的轨道耦合强度（紧束缚价电子混合积分）：\n- $|V_{AB}| = 1.20\\,\\mathrm{eV}$， $|V_{AC}| = 1.20\\,\\mathrm{eV}$， $|V_{BC}| = 0.90\\,\\mathrm{eV}$。\n\n假设以下建模基础和近似：\n1. 利用孤立原子总能量 $E(N)$ 对电子数 $N$ 的分段线性依赖关系，以及电离势 $I$ 和电子亲和能 $A$ 作为 $E(N)$ 有限差分的定义，结合绝对电负性 $\\chi$ 是电子化学势负值的认定，推导出用 $I$ 和 $A$ 表示 $\\chi$ 的表达式（Mulliken电负性）。计算 $\\chi_{A}$、$\\chi_{B}$ 和 $\\chi_{C}$ 以及对 $AB$、$AC$ 和 $BC$ 各对的相应差值 $|\\Delta\\chi|$，并根据这种基于Mulliken的度量预测的键极性进行排序。\n2. 将每个异核双原子分子 $XY$ ($X,Y\\in\\{A,B,C\\}$) 建模为一个由一个共价构型和其两个电荷转移离子构型 $X^{+}Y^{-}$ 及 $X^{-}Y^{+}$ 所张成的两态系统。使用用于组态相互作用的二阶非简并微扰理论，将由离子-共价混合引起的 $XY$ 的额外稳定化能近似为一系列项的和，这些项与电荷转移的能量成本成反比，其中电荷转移能隙用 $I$ 和 $A$ 表示为 $I_{X}-A_{Y}$ 和 $I_{Y}-A_{X}$，耦合强度为 $|V_{XY}|$。推导超额稳定化能 $\\Delta E_{\\mathrm{mix}}(XY)$ 对 $|V_{XY}|$、$I$ 和 $A$ 的主导阶依赖关系，并论证如何定义一个与 $\\sqrt{\\Delta E_{\\mathrm{mix}}(XY)}$ 成比例的Pauling型电负性差 $|\\chi_{X}-\\chi_{Y}|$ 来对键极性进行排序。使用给定的 $|V_{XY}|$ 以及上述 $I$ 和 $A$ 的值，评估并根据这种基于Pauling的度量对 $AB$、$AC$ 和 $BC$ 的键极性进行排序。\n\n忽略局域两态混合之外的长程库仑稳定作用和特定环境的极化，并将所有量以电子伏特为单位处理。根据Mulliken度量和从混合模型推导出的Pauling型度量，哪个选项正确地陈述了这三对原子间键极性的排序？\n\nA. Mulliken和Pauling度量都预测 $AC$ 是极性最强的键，$AB$ 居中，$BC$ 是极性最弱的键。\n\nB. Mulliken度量预测 $AC$ 是极性最强的键，而Pauling度量预测 $AB$ 是极性最强的键；两者都认为 $BC$ 是极性最弱的键。\n\nC. Mulliken度量预测 $AB$ 是极性最强的键，而Pauling度量预测 $AC$ 是极性最强的键；两者都认为 $BC$ 是极性最弱的键。\n\nD. Mulliken和Pauling度量都预测 $BC$ 是极性最强的键，$AC$ 居中，$AB$ 是极性最弱的键。",
            "solution": "解答过程根据问题陈述的规定分两部分进行。\n\n**第一部分：Mulliken电负性与键极性排序**\n\n问题要求基于原子能量 $E$ 作为电子数 $N$ 的函数的​​分段线性模型，推导Mulliken电负性 $\\chi$ 的表达式。电离势（$I$ 或 $E_{\\mathrm{IP}}$）和电子亲和能（$A$ 或 $E_{\\mathrm{EA}}$）被定义为具有 $N_0$ 个电子的中性原子的总能量的有限差分：\n$$I = E(N_0 - 1) - E(N_0)$$\n$$A = E(N_0) - E(N_0 + 1)$$\n电子化学势 $\\mu$ 定义为 $\\mu = (\\partial E / \\partial N)$。对于分段线性函数，我们可以通过平均左右导数来近似 $N=N_0$ 处的这个导数。\n右导数（增加一个电子）是 $\\mu_+ = E(N_0+1) - E(N_0) = -A$。\n左导数（移去一个电子）是 $\\mu_- = E(N_0) - E(N_0-1) = -I$。\n化学势是平均值：$\\mu = (\\mu_+ + \\mu_-)/2 = (-A - I)/2$。\n绝对电负性 $\\chi$ 定义为化学势的负值，即 $\\chi = -\\mu$。因此，Mulliken电负性为：\n$$\\chi = \\frac{I + A}{2}$$\n使用所提供的数据：\n- A类原子：$I_A = 5.20\\,\\mathrm{eV}$，$A_A = 0.60\\,\\mathrm{eV}$\n  $$\\chi_A = \\frac{5.20\\,\\mathrm{eV} + 0.60\\,\\mathrm{eV}}{2} = 2.90\\,\\mathrm{eV}$$\n- B类原子：$I_B = 13.60\\,\\mathrm{eV}$，$A_B = 1.50\\,\\mathrm{eV}$\n  $$\\chi_B = \\frac{13.60\\,\\mathrm{eV} + 1.50\\,\\mathrm{eV}}{2} = 7.55\\,\\mathrm{eV}$$\n- C类原子：$I_C = 13.00\\,\\mathrm{eV}$，$A_C = 3.60\\,\\mathrm{eV}$\n  $$\\chi_C = \\frac{13.00\\,\\mathrm{eV} + 3.60\\,\\mathrm{eV}}{2} = 8.30\\,\\mathrm{eV}$$\n\n在Mulliken方案中，键极性根据电负性差的大小 $|\\Delta\\chi_{XY}| = |\\chi_X - \\chi_Y|$ 进行排序。\n- 对于键 $AB$：$|\\Delta\\chi_{AB}| = |\\chi_A - \\chi_B| = |2.90 - 7.55|\\,\\mathrm{eV} = 4.65\\,\\mathrm{eV}$\n- 对于键 $AC$：$|\\Delta\\chi_{AC}| = |\\chi_A - \\chi_C| = |2.90 - 8.30|\\,\\mathrm{eV} = 5.40\\,\\mathrm{eV}$\n- 对于键 $BC$：$|\\Delta\\chi_{BC}| = |\\chi_B - \\chi_C| = |7.55 - 8.30|\\,\\mathrm{eV} = 0.75\\,\\mathrm{eV}$\n\n比较这些值：$5.40 > 4.65 > 0.75$。\n根据Mulliken度量，键极性的排序是：$AC > AB > BC$。\n\n**第二部分：Pauling型电负性与键极性排序**\n\n这部分涉及双原子分子 $XY$ 的两态组态相互作用模型。基态是纯共价构型 $|XY\\rangle$ 和两个电荷转移离子构型 $|X^+Y^-\\rangle$、$|X^-Y^+\\rangle$ 的混合态。我们使用二阶非简并微扰理论来计算稳定化能。\n\n设共价态 $|XY\\rangle$ 的能量为参考能量 $E_{\\mathrm{cov}} = 0$。忽略长程库仑相互作用，离子态的能量是形成离子的能量成本：\n- $|X^+Y^-\\rangle$ 的能量是 $E(X^+Y^-) = I_X - A_Y$。\n- $|X^-Y^+\\rangle$ 的能量是 $E(X^-Y^+) = I_Y - A_X$。\n\n共价态通过价电子混合积分 $|V_{XY}|$ 与离子态耦合。基态的稳定化能 $\\Delta E_{\\mathrm{mix}}$ 是由与更高能量的离子态混合所产生的二阶微扰修正之和：\n$$\\Delta E_{\\mathrm{mix}}(XY) = -\\left( \\frac{|\\langle XY | H | X^+Y^- \\rangle|^2}{E_{\\mathrm{cov}} - E(X^+Y^-)} + \\frac{|\\langle XY | H | X^-Y^+ \\rangle|^2}{E_{\\mathrm{cov}} - E(X^-Y^+)} \\right)$$\n$$\\Delta E_{\\mathrm{mix}}(XY) = -\\left( \\frac{|V_{XY}|^2}{0 - (I_X - A_Y)} + \\frac{|V_{XY}|^2}{0 - (I_Y - A_X)} \\right)$$\n$$\\Delta E_{\\mathrm{mix}}(XY) = \\frac{|V_{XY}|^2}{I_X - A_Y} + \\frac{|V_{XY}|^2}{I_Y - A_X}$$\n这是由于离子-共价混合所产生的超额稳定化能。\n\nPauling关于电负性差 $|\\chi_X - \\chi_Y|$ 的原始概念与超额离子共振能 $\\Delta$ 相关，关系为 $\\Delta \\propto (|\\chi_X - \\chi_Y|)^2$。因此，我们可以基于 $\\Delta E_{\\mathrm{mix}}(XY)$ 对键极性进行排序，其中更大的稳定化能意味着更大的极性。\n\n现在我们计算每一对的 $\\Delta E_{\\mathrm{mix}}$：\n- **$AB$对：** $I_A=5.20, A_B=1.50, I_B=13.60, A_A=0.60, |V_{AB}|=1.20$（单位均为 $\\mathrm{eV}$）\n  $$\\Delta E_{\\mathrm{mix}}(AB) = \\frac{(1.20)^2}{5.20 - 1.50} + \\frac{(1.20)^2}{13.60 - 0.60} = \\frac{1.44}{3.70} + \\frac{1.44}{13.00} \\approx 0.3892 + 0.1108 = 0.500\\,\\mathrm{eV}$$\n\n- **$AC$对：** $I_A=5.20, A_C=3.60, I_C=13.00, A_A=0.60, |V_{AC}|=1.20$（单位均为 $\\mathrm{eV}$）\n  $$\\Delta E_{\\mathrm{mix}}(AC) = \\frac{(1.20)^2}{5.20 - 3.60} + \\frac{(1.20)^2}{13.00 - 0.60} = \\frac{1.44}{1.60} + \\frac{1.44}{12.40} = 0.9000 + 0.1161 \\approx 1.016\\,\\mathrm{eV}$$\n\n- **$BC$对：** $I_B=13.60, A_C=3.60, I_C=13.00, A_B=1.50, |V_{BC}|=0.90$（单位均为 $\\mathrm{eV}$）\n  $$\\Delta E_{\\mathrm{mix}}(BC) = \\frac{(0.90)^2}{13.60 - 3.60} + \\frac{(0.90)^2}{13.00 - 1.50} = \\frac{0.81}{10.00} + \\frac{0.81}{11.50} = 0.0810 + 0.0704 \\approx 0.151\\,\\mathrm{eV}$$\n\n比较这些值：$1.016 > 0.500 > 0.151$。\n根据Pauling型度量，键极性的排序是：$AC > AB > BC$。\n\n**结论与选项评估**\n\n- **Mulliken排序：** $AC$ 极性最强，$AB$ 居中，$BC$ 极性最弱。\n- **Pauling型排序：** $AC$ 极性最强，$AB$ 居中，$BC$ 极性最弱。\n\n两种度量得出了相同的键极性排序。\n\n现在我们评估给出的选项：\n\nA. **Mulliken和Pauling度量都预测 $AC$ 是极性最强的键，$AB$ 居中，$BC$ 是极性最弱的键。**\n该陈述与从两个模型推导出的结果完全匹配。\n**结论：正确**\n\nB. **Mulliken度量预测 $AC$ 是极性最强的键，而Pauling度量预测 $AB$ 是极性最强的键；两者都认为 $BC$ 是极性最弱的键。**\n这是不正确的。我们对Pauling型度量的计算表明 $\\Delta E_{\\mathrm{mix}}(AC) \\approx 1.016\\,\\mathrm{eV}$ 且 $\\Delta E_{\\mathrm{mix}}(AB) \\approx 0.500\\,\\mathrm{eV}$。由于 $\\Delta E_{\\mathrm{mix}}(AC) > \\Delta E_{\\mathrm{mix}}(AB)$，Pauling模型预测 $AC$ 的极性比 $AB$ 更强。\n**结论：不正确**\n\nC. **Mulliken度量预测 $AB$ 是极性最强的键，而Pauling度量预测 $AC$ 是极性最强的键；两者都认为 $BC$ 是极性最弱的键。**\n这是不正确的。我们对Mulliken度量的计算表明 $|\\Delta\\chi_{AC}| = 5.40\\,\\mathrm{eV}$ 且 $|\\Delta\\chi_{AB}| = 4.65\\,\\mathrm{eV}$。由于 $|\\Delta\\chi_{AC}| > |\\Delta\\chi_{AB}|$，Mulliken模型预测 $AC$ 的极性比 $AB$ 更强。\n**结论：不正确**\n\nD. **Mulliken和Pauling度量都预测 $BC$ 是极性最强的键，$AC$ 居中，$AB$ 是极性最弱的键。**\n这是不正确的。我们推导出的两个排序都表明 $BC$ 键是三者中极性*最弱*的，而不是最强的。\n**结论：不正确**\n\n因此，只有选项 A 与基于所提供模型和数据的计算结果一致。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "真实分子间的相互作用是多种物理效应复杂交织的结果。本练习提供了一个高级的综合实践，要求你为一个水二聚体实现一个可极化力场。你将学习如何将总相互作用能分解为物理上清晰的组成部分：静电、诱导（极化）、色散和交换排斥作用。这项任务不仅能让你掌握构建和验证复杂分子模型的实用技能，还能加深你对氢键等重要相互作用背后多种驱动力的理解。",
            "id": "3817618",
            "problem": "您需要实现一个用于两个水分子体系的可极化对加和力场，并计算结合能分解为具有明确物理动机的各个贡献项。该计算必须严格遵循源于经典静电学、线性响应极化以及标准短程和色散模型的定义。目标是从第一性原理推导表达式，然后对一个指定的水二聚体构型进行数值评估。所有能量必须以 $\\text{kJ/mol}$ 为单位，角度必须以度为单位。\n\n定义和假设：\n- 考虑两个刚性水单体，每个单体由三个点位组成：一个氧原子（$\\mathrm{O}$）和两个氢原子（$\\mathrm{H}$）。设单体 $A$ 的位点位置为 $\\{\\mathbf{r}_i^{A}\\}$，单体 $B$ 的位点位置为 $\\{\\mathbf{r}_j^{B}\\}$，其中 $i,j \\in \\{\\mathrm{O},\\mathrm{H}_1,\\mathrm{H}_2\\}$。设位点间位移向量为 $\\mathbf{r}_{ij} = \\mathbf{r}_j^{B} - \\mathbf{r}_i^{A}$，其模为 $R_{ij} = \\|\\mathbf{r}_{ij}\\|$。\n- 设位点电荷为 $q_{\\mathrm{O}} = -0.834$ 和 $q_{\\mathrm{H}} = +0.417$，单位为基本电荷 $e$。库仑相互作用使用库仑常数 $k_e = 13.8935456 \\ \\text{kJ/mol} \\cdot \\text{Å} \\cdot e^{-2}$ 进行计算，因此距离单位为 $\\text{Å}$，电荷单位为 $e$。\n- 诱导作用通过各向同性极化率 $\\alpha_{\\mathrm{O}}$ 和 $\\alpha_{\\mathrm{H}}$ 建模，单位为 $e^2 \\text{ Å}^2 \\cdot (\\text{kJ/mol})^{-1}$，采用线性响应。某一位点上的外电场由另一单体的永久电荷产生。对场强应用一个 Thole 型阻尼因子，以避免不物理的短程发散。\n- 色散作用采用带有 Tang-Toennies 阻尼 $f_6(R)$ 的 $C_6/R^6$ 形式建模，以确保物理上真实的短程行为。\n- 交换-排斥作用采用 Born-Mayer 指数形式建模。\n\n推导并实现以下能量贡献项：\n1. 静电能。从库仑定律出发，单体间的静电能为\n$$\nE_{\\mathrm{es}} = \\sum_{i \\in A} \\sum_{j \\in B} \\frac{k_e \\, q_i \\, q_j}{R_{ij}}.\n$$\n2. 诱导（极化）能。在线性响应下，位点 $i$ 上的诱导偶极为 $\\boldsymbol{\\mu}_i^{\\mathrm{ind}} = \\alpha_i \\mathbf{E}_i$，其中外电场 $\\mathbf{E}_i$ 是由另一单体上的永久电荷产生的，并由一个 Thole 因子进行阻尼。利用线性诱导偶极的能量，诱导能为\n$$\nE_{\\mathrm{ind}} = -\\frac{1}{2} \\sum_{i \\in A} \\alpha_i \\|\\mathbf{E}_i^{(B)}\\|^2 - \\frac{1}{2} \\sum_{j \\in B} \\alpha_j \\|\\mathbf{E}_j^{(A)}\\|^2,\n$$\n其中\n$$\n\\mathbf{E}_i^{(B)} = \\sum_{j \\in B} k_e \\, q_j \\, f_{\\mathrm{th}}(R_{ij}) \\frac{\\mathbf{r}_{ij}}{R_{ij}^3}, \\quad\n\\mathbf{E}_j^{(A)} = \\sum_{i \\in A} k_e \\, q_i \\, f_{\\mathrm{th}}(R_{ij}) \\frac{\\mathbf{r}_{ji}}{R_{ij}^3},\n$$\n以及 Thole 阻尼\n$$\nf_{\\mathrm{th}}(R) = 1 - \\exp(-a_t R^3),\n$$\n其中 $a_t$ 的单位为 $\\text{Å}^{-3}$。此形式确保当 $R \\to 0$ 时 $f_{\\mathrm{th}}(R) \\to 0$，当 $R$ 很大时 $f_{\\mathrm{th}}(R) \\to 1$，以简化的方式捕捉短程屏蔽效应。\n3. 色散能。使用带有 Tang-Toennies 阻尼的对加和 London 色散，\n$$\nE_{\\mathrm{disp}} = -\\sum_{i \\in A} \\sum_{j \\in B} f_6(R_{ij}) \\frac{C_{6,ij}}{R_{ij}^6}, \\quad C_{6,ij} = \\sqrt{C_{6,i} C_{6,j}},\n$$\n以及\n$$\nf_6(R) = 1 - \\exp(-b_d R) \\sum_{k=0}^{6} \\frac{(b_d R)^k}{k!},\n$$\n其中 $b_d$ 的单位为 $\\text{Å}^{-1}$，$C_{6,i}$ 的单位为 $\\text{kJ/mol} \\cdot \\text{Å}^6$。\n4. 交换-排斥能。采用 Born-Mayer 形式和简单的组合规则，\n$$\nE_{\\mathrm{exch}} = \\sum_{i \\in A} \\sum_{j \\in B} A_{ij} \\exp(-b_{ij} R_{ij}), \\quad\nA_{ij} = \\sqrt{A_i A_j}, \\quad b_{ij} = \\frac{b_i + b_j}{2},\n$$\n其中 $A_i$ 的单位为 $\\text{kJ/mol}$，$b_i$ 的单位为 $\\text{Å}^{-1}$。\n\n结合能是这些贡献项的总和：\n$$\nE_{\\mathrm{bind}} = E_{\\mathrm{es}} + E_{\\mathrm{ind}} + E_{\\mathrm{disp}} + E_{\\mathrm{exch}}.\n$$\n\n水单体几何结构与二聚体构建：\n- 每个水单体都是刚性的，其 $\\mathrm{O}$–$\\mathrm{H}$ 键长为 $r_{\\mathrm{OH}} = 0.9572 \\ \\text{Å}$，$\\mathrm{H}$–$\\mathrm{O}$–$\\mathrm{H}$ 键角为 $\\theta_{\\mathrm{HOH}} = 104.52^\\circ$。\n- 将单体 $A$ 的氧原子置于原点 $\\mathbf{r}_{\\mathrm{O}}^{A} = (0,0,0)$，位于 $x$–$y$ 平面内，其角平分线指向 $+x$ 方向。使用\n$$\n\\begin{aligned}\n\\mathbf{r}_{\\mathrm{H}_1}^{A} = \\left(r_{\\mathrm{OH}} \\cos(\\theta_{\\mathrm{HOH}}/2), \\ \\ r_{\\mathrm{OH}} \\sin(\\theta_{\\mathrm{HOH}}/2), \\ \\ 0\\right), \\\\\n\\mathbf{r}_{\\mathrm{H}_2}^{A} = \\left(r_{\\mathrm{OH}} \\cos(\\theta_{\\mathrm{HOH}}/2), \\ \\ -r_{\\mathrm{OH}} \\sin(\\theta_{\\mathrm{HOH}}/2), \\ \\ 0\\right).\n\\end{aligned}\n$$\n- 将单体 $B$ 的氧原子置于 $\\mathbf{r}_{\\mathrm{O}}^{B} = (R_{\\mathrm{OO}}, 0, 0)$，并将其角平分线朝向 $-x$ 方向，其氢原子的位置类似地确定：\n$$\n\\begin{aligned}\n\\mathbf{r}_{\\mathrm{H}_1}^{B} = \\left(R_{\\mathrm{OO}} - r_{\\mathrm{OH}} \\cos(\\theta_{\\mathrm{HOH}}/2), \\ \\ r_{\\mathrm{OH}} \\sin(\\theta_{\\mathrm{HOH}}/2), \\ \\ 0\\right), \\\\\n\\mathbf{r}_{\\mathrm{H}_2}^{B} = \\left(R_{\\mathrm{OO}} - r_{\\mathrm{OH}} \\cos(\\theta_{\\mathrm{HOH}}/2), \\ \\ -r_{\\mathrm{OH}} \\sin(\\theta_{\\mathrm{HOH}}/2), \\ \\ 0\\right).\n\\end{aligned}\n$$\n- 最后，将整个单体 $B$ 绕 $z$ 轴刚性旋转一个角度 $\\phi$（单位为度）。此旋转通过以下矩阵变换每个 $\\mathbf{r}^{B}$：\n$$\n\\mathbf{R}_z(\\phi) = \\begin{pmatrix}\n\\cos \\phi  -\\sin \\phi  0\\\\\n\\sin \\phi  \\cos \\phi  0\\\\\n0  0  1\n\\end{pmatrix},\n$$\n其中 $\\phi$ 在内部计算时需转换为弧度。这用于测试相互作用的取向依赖性。\n\n使用的参数：\n- 库仑常数：$k_e = 13.8935456 \\ \\text{kJ/mol} \\cdot \\text{Å} \\cdot e^{-2}$。\n- 电荷：$q_{\\mathrm{O}} = -0.834$，$q_{\\mathrm{H}} = +0.417$（单位为 $e$）。\n- 极化率：$\\alpha_{\\mathrm{O}} = 0.8$，$\\alpha_{\\mathrm{H}} = 0.3$（单位为 $e^2 \\text{ Å}^2 \\cdot (\\text{kJ/mol})^{-1}$）。\n- Thole 阻尼：$f_{\\mathrm{th}}(R) = 1 - \\exp(-a_t R^3)$，其中 $a_t = 0.3 \\ \\text{Å}^{-3}$。\n- 色散：$C_{6,\\mathrm{O}} = 500 \\ \\text{kJ/mol} \\cdot \\text{Å}^6$，$C_{6,\\mathrm{H}} = 50 \\ \\text{kJ/mol} \\cdot \\text{Å}^6$，阻尼 $b_d = 3.0 \\ \\text{Å}^{-1}$，以及混合规则 $C_{6,ij} = \\sqrt{C_{6,i} C_{6,j}}$。\n- 交换-排斥：$A_{\\mathrm{O}} = 25000 \\ \\text{kJ/mol}$，$A_{\\mathrm{H}} = 1000 \\ \\text{kJ/mol}$，$b_{\\mathrm{O}} = 4.0 \\ \\text{Å}^{-1}$，$b_{\\mathrm{H}} = 3.5 \\ \\text{Å}^{-1}$，以及组合规则 $A_{ij} = \\sqrt{A_i A_j}$，$b_{ij} = \\frac{b_i + b_j}{2}$。\n- 几何常数：$r_{\\mathrm{OH}} = 0.9572 \\ \\text{Å}$，$\\theta_{\\mathrm{HOH}} = 104.52^\\circ$。\n\n测试套件：\n- 提供以下四个测试用例，每个由 $(R_{\\mathrm{OO}}, \\phi)$ 定义：\n    1. $(2.9, 0)$：一个典型的氢键距离，角平分线对齐（一般情况）。\n    2. $(2.5, 0)$：一个较短的距离，用于探测强交换-排斥作用（边界情况）。\n    3. $(4.0, 0)$：一个较长的距离，用于探测渐近区域（边缘情况）。\n    4. $(2.9, 90)$：旋转 $90^\\circ$ 以探测取向依赖性（边缘情况）。\n\n要求输出：\n- 对于每个测试用例，计算并返回一个包含五个浮点数的列表 $[E_{\\mathrm{bind}}, E_{\\mathrm{es}}, E_{\\mathrm{ind}}, E_{\\mathrm{disp}}, E_{\\mathrm{exch}}]$，每个值以 $\\text{kJ/mol}$ 为单位，保留六位小数。\n- 您的程序应生成单行输出，其中包含这些五元素列表组成的列表，以逗号分隔，并用方括号括起来。示例格式：\n$$\n\\texttt{[[E\\_bind\\_1,E\\_es\\_1,E\\_ind\\_1,E\\_disp\\_1,E\\_exch\\_1],[E\\_bind\\_2,...],...]}\n$$\n\n不允许用户输入；所有常数和测试用例必须按上述规定进行硬编码。解决方案必须是完全自包含的，并且可以在任何支持给定库的数值计算的现代编程环境中执行。",
            "solution": "该问题要求计算两个刚性水分子之间的相互作用能，并将其分解为静电能（$E_{\\mathrm{es}}$）、诱导能（$E_{\\mathrm{ind}}$）、色散能（$E_{\\mathrm{disp}}$）和交换-排斥能（$E_{\\mathrm{exch}}$）四个部分。为此，我们将遵循问题中定义的物理模型和数学公式，分步进行实现。\n\n### 1. 概念框架与算法设计\n\n总结合能 $E_{\\mathrm{bind}}$ 是四个物理上截然不同的贡献项的总和。对于每个给定的测试用例 $(R_{\\mathrm{OO}}, \\phi)$，算法将分三个主要阶段进行：\n1.  **几何结构生成**：根据指定的内禀几何结构和由 O-O 距离 $R_{\\mathrm{OO}}$ 及旋转角 $\\phi$ 定义的相对取向，构建所有六个原子（每个水单体三个）的笛卡尔坐标。\n2.  **能量计算**：应用所提供的数学公式和参数，计算四个能量分量中的每一个。\n3.  **汇总**：将各分量相加得到总结合能，并按要求格式化结果。\n\n### 2. 几何结构生成\n\n首先，我们建立一个坐标系。每个水单体具有固定的内禀几何结构，由 O-H 键长 $r_{\\mathrm{OH}} = 0.9572 \\ \\text{Å}$ 和 H-O-H 键角 $\\theta_{\\mathrm{HOH}} = 104.52^\\circ$ 定义。所有角度在使用三角函数前必须转换为弧度。\n\n**单体 A**：氧原子置于原点，$\\mathbf{r}_{\\mathrm{O}}^{A} = (0, 0, 0)$。分子位于 $xy$-平面，其角平分线沿正 $x$-轴方向。\n令 $\\theta_h = \\theta_{\\mathrm{HOH}} / 2$。\n$$ \\mathbf{r}_{\\mathrm{H}_1}^{A} = (r_{\\mathrm{OH}} \\cos(\\theta_h), \\ r_{\\mathrm{OH}} \\sin(\\theta_h), \\ 0) $$\n$$ \\mathbf{r}_{\\mathrm{H}_2}^{A} = (r_{\\mathrm{OH}} \\cos(\\theta_h), -r_{\\mathrm{OH}} \\sin(\\theta_h), \\ 0) $$\n\n**单体 B**：单体 B 首先在一个参考取向上构建，然后进行旋转。初始时，其氧原子置于 $\\mathbf{r}_{\\mathrm{O}}^{B} = (R_{\\mathrm{OO}}, 0, 0)$，其角平分线与负 $x$-轴对齐。\n$$ \\mathbf{r}_{\\mathrm{H}_1}^{B, \\text{init}} = (R_{\\mathrm{OO}} - r_{\\mathrm{OH}} \\cos(\\theta_h), \\ r_{\\mathrm{OH}} \\sin(\\theta_h), \\ 0) $$\n$$ \\mathbf{r}_{\\mathrm{H}_2}^{B, \\text{init}} = (R_{\\mathrm{OO}} - r_{\\mathrm{OH}} \\cos(\\theta_h), -r_{\\mathrm{OH}} \\sin(\\theta_h), \\ 0) $$\n接下来，整个单体 B 绕 $z$-轴逆时针旋转一个角度 $\\phi$。\n\n### 3. 能量分量计算\n\n在确定所有六个原子的坐标后，我们可以计算四个能量贡献项。这涉及到遍历所有 $3 \\times 3 = 9$ 个单体间位点对 $(i, j)$，其中 $i \\in A$ 且 $j \\in B$。\n\n**静电、交换-排斥和色散**：这三项被表述为直接的对加和。对于每个对 $(i, j)$，计算位移向量 $\\mathbf{r}_{ij}$ 和距离 $R_{ij}$，然后根据公式累加能量。\n\n**诱导能 ($E_{\\mathrm{ind}}$)**：此项需要计算每个位点所受的总电场。\n1.  对于每个位点 $i \\in A$，我们计算由所有位点 $j \\in B$ 产生的电场 $\\mathbf{E}_i^{(B)}$，其中短程作用由 Thole 函数 $f_{\\mathrm{th}}(R)$ 进行阻尼。\n2.  类似地，对于每个位点 $j \\in B$，计算来自所有位点 $i \\in A$ 的电场 $\\mathbf{E}_j^{(A)}$。\n3.  总诱导能是每个位点上诱导偶极能量的总和：\n    $$ E_{\\mathrm{ind}} = -\\frac{1}{2} \\sum_{i \\in A} \\alpha_i \\|\\mathbf{E}_i^{(B)}\\|^2 - \\frac{1}{2} \\sum_{j \\in B} \\alpha_j \\|\\mathbf{E}_j^{(A)}\\|^2 $$\n\n### 4. 汇总与最终输出\n\n最后，总结合能是四个分量的总和：\n$$ E_{\\mathrm{bind}} = E_{\\mathrm{es}} + E_{\\mathrm{ind}} + E_{\\mathrm{disp}} + E_{\\mathrm{exch}} $$\n对于每个测试用例，将五个得到的能量值按要求格式化并汇总。一个稳健的实现将利用 NumPy 进行高效和准确的向量和矩阵运算。",
            "answer": "```\n[[-20.443152,-28.948259,-4.673238,-8.705888,21.884233],[111.455010,-31.604616,-20.913076,-30.347571,194.320273],[-4.661073,-4.938885,-0.601723,-2.329241,3.208777],[-11.233081,-5.590130,-1.498420,-11.298953,7.154422]]\n```"
        }
    ]
}