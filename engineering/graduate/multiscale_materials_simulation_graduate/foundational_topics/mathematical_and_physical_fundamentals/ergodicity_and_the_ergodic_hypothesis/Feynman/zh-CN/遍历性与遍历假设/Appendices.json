{
    "hands_on_practices": [
        {
            "introduction": "经典谐振子是物理学的一个基石，可用于模拟从原子振动到电磁场的各种现象。本练习通过要求您直接计算并比较一个可观测量的时间平均和微正则系综平均，为您提供了对遍历性的基础性审视。通过解决这个问题 ，您将具体理解为何一个系统可以在其能量曲面上是遍历的，但在整个相空间中却是非遍历的——这是正确应用遍历性假设的一个关键区别。",
            "id": "3807113",
            "problem": "考虑一个晶体固体中原子的粗粒化振动模式，该模式被建模为一个一维经典谐振子，其质量为 $m$，胡克刚度为 $k>0$。其哈密顿量为 $H(x,p)=\\frac{p^{2}}{2m}+\\frac{1}{2}k x^{2}$，角频率为 $\\omega=\\sqrt{\\frac{k}{m}}$。在多尺度材料模拟中，根据遍历性假说，通常使用分子动力学（MD, Molecular Dynamics）计算的时间平均来替代系综平均。设可观测量为 $A(x,p)=x^{2}$。\n\n从牛顿第二定律和哈密顿力学出发，不使用任何简便公式，完成以下任务：\n\n1. 对于一条总能量为固定值 $E>0$ 的轨迹，推导 $A$ 沿此轨迹的长时间平均值，\n$$\\overline{A}_{t}=\\lim_{T\\to\\infty}\\frac{1}{T}\\int_{0}^{T}x(t)^{2}\\,dt,$$\n用 $E$、$k$、$m$ 和 $\\omega$（在适当的情况下）的符号形式表示。\n\n2. 使用相空间上的刘维尔测度和能量为 $E$ 的微正则系综，推导限制在能量面 $H(x,p)=E$ 上的 $A$ 的系综平均值，\n$$\\langle A\\rangle_{\\text{mc}}(E)=\\frac{\\int_{\\Gamma_{E}}A(x,p)\\,\\mathrm{d}\\mu_{E}(x,p)}{\\int_{\\Gamma_{E}}\\mathrm{d}\\mu_{E}(x,p)},$$\n其中 $\\Gamma_{E}=\\{(x,p)\\in\\mathbb{R}^{2}:H(x,p)=E\\}$ 且 $\\mathrm{d}\\mu_{E}$ 是由刘维尔测度在 $\\Gamma_{E}$ 上诱导的不变测度。\n\n3. 利用遍历性和运动不变量的定义，解释为什么谐振子流相对于整个相空间 $\\mathbb{R}^{2}$ 上的勒贝格测度是非遍历的，并讨论在多尺度材料模拟中用系综平均替代时间平均来建模振动可观测量时的意义。\n\n以最简闭合形式给出这两个平均值的共同符号值。无需报告单位。无需四舍五入。",
            "solution": "按要求分三部分解决此问题。\n\n**第一部分：时间平均的推导**\n\n一维谐振子的运动遵循牛顿第二定律，对于弹簧-质量系统，其形式为 $m\\ddot{x} = -kx$。运动方程为：\n$$\n\\ddot{x} + \\frac{k}{m}x = 0\n$$\n根据角频率的定义 $\\omega = \\sqrt{\\frac{k}{m}}$，方程变为 $\\ddot{x} + \\omega^{2}x = 0$。位置 $x(t)$ 作为时间 $t$ 的函数的通解是：\n$$\nx(t) = C\\cos(\\omega t + \\phi)\n$$\n其中 $C$ 是振幅，$\\phi$ 是相位常数，由初始条件决定。相应的动量 $p(t) = m\\dot{x}(t)$ 是：\n$$\np(t) = -m\\omega C\\sin(\\omega t + \\phi)\n$$\n对于给定的轨迹，谐振子的总能量 $E$ 是恒定的。我们可以用哈密顿量 $H(x,p)$ 来表示 $E$：\n$$\nE = H(x(t), p(t)) = \\frac{p(t)^{2}}{2m} + \\frac{1}{2}kx(t)^{2}\n$$\n代入 $x(t)$ 和 $p(t)$ 的表达式：\n$$\nE = \\frac{(-m\\omega C\\sin(\\omega t + \\phi))^{2}}{2m} + \\frac{1}{2}k(C\\cos(\\omega t + \\phi))^{2}\n$$\n$$\nE = \\frac{m^{2}\\omega^{2}C^{2}}{2m}\\sin^{2}(\\omega t + \\phi) + \\frac{1}{2}kC^{2}\\cos^{2}(\\omega t + \\phi)\n$$\n使用关系式 $k = m\\omega^{2}$，我们简化表达式：\n$$\nE = \\frac{1}{2}kC^{2}\\sin^{2}(\\omega t + \\phi) + \\frac{1}{2}kC^{2}\\cos^{2}(\\omega t + \\phi) = \\frac{1}{2}kC^{2}(\\sin^{2}(\\omega t + \\phi) + \\cos^{2}(\\omega t + \\phi))\n$$\n$$\nE = \\frac{1}{2}kC^{2}\n$$\n这使我们能够用总能量 $E$ 和刚度 $k$ 来表示振幅的平方 $C^{2}$：\n$$\nC^{2} = \\frac{2E}{k}\n$$\n可观测量是 $A = x^{2}$，所以我们关心的是 $x(t)^{2}$ 的长时间平均。\n$$\n\\overline{A}_{t} = \\lim_{T\\to\\infty}\\frac{1}{T}\\int_{0}^{T}x(t)^{2}\\,dt = \\lim_{T\\to\\infty}\\frac{1}{T}\\int_{0}^{T} C^{2}\\cos^{2}(\\omega t + \\phi)\\,dt\n$$\n由于被积函数是周期函数，周期为 $\\tau = \\frac{2\\pi}{\\omega}$，因此长时间平均等于在一个周期内的平均值：\n$$\n\\overline{A}_{t} = \\frac{1}{\\tau}\\int_{0}^{\\tau} C^{2}\\cos^{2}(\\omega t + \\phi)\\,dt\n$$\n使用三角恒等式 $\\cos^{2}\\theta = \\frac{1}{2}(1 + \\cos(2\\theta))$：\n$$\n\\overline{A}_{t} = \\frac{C^{2}}{\\tau}\\int_{0}^{\\tau} \\frac{1}{2}(1 + \\cos(2(\\omega t + \\phi)))\\,dt\n$$\n$$\n\\overline{A}_{t} = \\frac{C^{2}}{2\\tau}\\left[\\int_{0}^{\\tau}dt + \\int_{0}^{\\tau}\\cos(2\\omega t + 2\\phi)\\,dt\\right]\n$$\n第一个积分是 $\\tau$。第二个积分是在余弦函数的两个完整周期上进行的，其值为零：\n$$\n\\int_{0}^{\\tau}\\cos(2\\omega t + 2\\phi)\\,dt = \\left[\\frac{\\sin(2\\omega t + 2\\phi)}{2\\omega}\\right]_{0}^{\\tau} = \\frac{\\sin(2\\omega\\tau + 2\\phi) - \\sin(2\\phi)}{2\\omega} = \\frac{\\sin(4\\pi + 2\\phi) - \\sin(2\\phi)}{2\\omega} = 0\n$$\n因此，时间平均值为：\n$$\n\\overline{A}_{t} = \\frac{C^{2}}{2\\tau}[\\tau + 0] = \\frac{C^{2}}{2}\n$$\n代入 $C^{2}$ 的表达式：\n$$\n\\overline{A}_{t} = \\frac{1}{2}\\left(\\frac{2E}{k}\\right) = \\frac{E}{k}\n$$\n\n**第二部分：微正则系综平均的推导**\n\n在固定能量 $E$ 下，一个可观测量 $A$ 的微正则系综平均由常能量面 $\\Gamma_{E}$ 上的相空间积分之比给出。一个方便的计算方法是使用狄拉克 $\\delta$ 函数将积分限制在曲面 $H(x,p)=E$ 上：\n$$\n\\langle A\\rangle_{\\text{mc}}(E)=\\frac{\\int\\int A(x,p)\\delta(H(x,p)-E)\\,\\mathrm{d}x\\,\\mathrm{d}p}{\\int\\int \\delta(H(x,p)-E)\\,\\mathrm{d}x\\,\\mathrm{d}p}\n$$\n我们首先计算分母，即状态密度 $\\Omega(E)$：\n$$\n\\Omega(E) = \\int_{-\\infty}^{\\infty}\\int_{-\\infty}^{\\infty} \\delta\\left(\\frac{p^{2}}{2m}+\\frac{1}{2}k x^{2} - E\\right)\\,\\mathrm{d}p\\,\\mathrm{d}x\n$$\n我们先对 $p$ 进行积分。对于一个固定的 $x$，$\\delta$ 函数的宗量在 $p = \\pm\\sqrt{2m(E - \\frac{1}{2}kx^{2})}$ 处有根。这些根是实数，当且仅当 $E - \\frac{1}{2}kx^{2} \\ge 0$，这意味着 $|x| \\le \\sqrt{2E/k}$。\n使用性质 $\\int g(y)\\delta(f(y))dy = \\sum_{i} \\frac{g(y_i)}{|f'(y_i)|}$，其中 $y_i$ 是 $f(y)$ 的根，我们有 $f(p) = \\frac{p^2}{2m} + \\frac{1}{2}kx^2 - E$ 和 $f'(p) = \\frac{p}{m}$。\n对 $p$ 的积分变为：\n$$\n\\int_{-\\infty}^{\\infty} \\delta\\left(\\frac{p^{2}}{2m}+\\frac{1}{2}k x^{2} - E\\right)\\,\\mathrm{d}p = \\frac{1}{|p/m|}\\Bigg|_{p=\\sqrt{...}} + \\frac{1}{|-p/m|}\\Bigg|_{p=\\sqrt{...}} = \\frac{2m}{p_0} = \\frac{2m}{\\sqrt{2m(E-\\frac{1}{2}kx^2)}} = \\frac{\\sqrt{2m}}{\\sqrt{E-\\frac{1}{2}kx^2}}\n$$\n现在，我们将此结果在 $x$ 的允许范围内积分：\n$$\n\\Omega(E) = \\int_{-\\sqrt{2E/k}}^{\\sqrt{2E/k}} \\frac{\\sqrt{2m}}{\\sqrt{E-\\frac{1}{2}kx^2}}\\,\\mathrm{d}x\n$$\n我们进行换元 $x = \\sqrt{\\frac{2E}{k}}\\sin\\theta$，因此 $\\mathrm{d}x = \\sqrt{\\frac{2E}{k}}\\cos\\theta\\,\\mathrm{d}\\theta$。$\\theta$ 的积分限变为 $-\\pi/2$ 到 $\\pi/2$。\n$$\n\\Omega(E) = \\int_{-\\pi/2}^{\\pi/2} \\frac{\\sqrt{2m}}{\\sqrt{E - \\frac{1}{2}k\\left(\\frac{2E}{k}\\sin^{2}\\theta\\right)}} \\left(\\sqrt{\\frac{2E}{k}}\\cos\\theta\\right)\\,\\mathrm{d}\\theta\n$$\n$$\n\\Omega(E) = \\int_{-\\pi/2}^{\\pi/2} \\frac{\\sqrt{2m}}{\\sqrt{E(1-\\sin^{2}\\theta)}} \\sqrt{\\frac{2E}{k}}\\cos\\theta\\,\\mathrm{d}\\theta = \\int_{-\\pi/2}^{\\pi/2} \\frac{\\sqrt{2m}}{\\sqrt{E}\\cos\\theta} \\sqrt{\\frac{2E}{k}}\\cos\\theta\\,\\mathrm{d}\\theta\n$$\n$$\n\\Omega(E) = \\int_{-\\pi/2}^{\\pi/2} \\sqrt{\\frac{4m}{k}} \\,\\mathrm{d}\\theta = 2\\sqrt{\\frac{m}{k}} [\\theta]_{-\\pi/2}^{\\pi/2} = 2\\sqrt{\\frac{m}{k}}\\pi = \\frac{2\\pi}{\\omega}\n$$\n接下来，我们计算 $A=x^{2}$ 时的分子：\n$$\nZ_{A}(E) = \\int\\int x^{2}\\delta(H(x,p)-E)\\,\\mathrm{d}x\\,\\mathrm{d}p = \\int_{-\\sqrt{2E/k}}^{\\sqrt{2E/k}} x^{2} \\left(\\frac{\\sqrt{2m}}{\\sqrt{E-\\frac{1}{2}kx^2}}\\right) \\,\\mathrm{d}x\n$$\n使用同样的换元 $x = \\sqrt{\\frac{2E}{k}}\\sin\\theta$：\n$$\nZ_{A}(E) = \\int_{-\\pi/2}^{\\pi/2} \\left(\\frac{2E}{k}\\sin^{2}\\theta\\right) \\left(\\frac{\\sqrt{2m}}{\\sqrt{E}\\cos\\theta}\\right) \\left(\\sqrt{\\frac{2E}{k}}\\cos\\theta\\right)\\,\\mathrm{d}\\theta\n$$\n$$\nZ_{A}(E) = \\frac{2E}{k} \\sqrt{\\frac{4m}{k}} \\int_{-\\pi/2}^{\\pi/2} \\sin^{2}\\theta\\,\\mathrm{d}\\theta = \\frac{4E}{k\\omega} \\int_{-\\pi/2}^{\\pi/2} \\frac{1-\\cos(2\\theta)}{2}\\,\\mathrm{d}\\theta\n$$\n$$\nZ_{A}(E) = \\frac{2E}{k\\omega} \\left[\\theta - \\frac{\\sin(2\\theta)}{2}\\right]_{-\\pi/2}^{\\pi/2} = \\frac{2E}{k\\omega} \\left(\\frac{\\pi}{2} - (-\\frac{\\pi}{2})\\right) = \\frac{2\\pi E}{k\\omega}\n$$\n系综平均是分子与分母之比：\n$$\n\\langle A\\rangle_{\\text{mc}}(E) = \\langle x^{2}\\rangle_{\\text{mc}}(E) = \\frac{Z_{A}(E)}{\\Omega(E)} = \\frac{2\\pi E / (k\\omega)}{2\\pi / \\omega} = \\frac{E}{k}\n$$\n时间平均和微正则系综平均是相同的，这对于在其能量面上是遍历的系统中的可观测量是预期的结果。\n\n**第三部分：全相空间的非遍历性及其意义**\n\n一个动力学系统在某个流形上是遍历的，当且仅当唯一的守恒量（运动不变量）是该流形上的常数函数。遍历系统的轨迹在流形中是稠密的。\n\n对于谐振子，其全相空间是二维平面 $\\mathbb{R}^{2}$。哈密顿量 $H(x,p) = \\frac{p^{2}}{2m} + \\frac{1}{2}kx^{2}$ 是一个运动不变量，因为 $\\{H,H\\} = 0$。对于任何初始条件 $(x_0, p_0)$，系统沿着能量恒定的轨迹演化：$H(x,p) = E = H(x_0,p_0)$。这些轨迹是相空间中以原点为中心的椭圆。\n\n函数 $H(x,p)$ 在整个相空间 $\\mathbb{R}^{2}$ 上不是常数；它可以取任何非负值。由于存在一个非平凡的运动不变量，该系统相对于 $\\mathbb{R}^{2}$ 上的勒贝格测度是**非遍历的**。一条始于能量 $E_1$ 的轨迹将永远被限制在由 $H(x,p)=E_1$ 定义的一维椭圆上。它永远不会访问具有不同能量 $E_2 \\neq E_1$ 的相空间区域。因此，没有任何一条单独的轨迹在二维相空间中是稠密的。相空间 $\\mathbb{R}^2$ 分解为一个由不相交的不变集组成的连续族，这些不变集就是等能椭圆。\n\n**对多尺度材料模拟的意义：**\n遍历性假说假定，对于一个混沌系统，一个可观测量沿单一轨迹的长时间平均等于该可观测量在统计系综上的平均值。这一原理为使用单次、长时间的分子动力学（MD）模拟来计算宏观属性提供了依据，而不是对大量不同的初始条件进行平均。\n\n谐振子在全相空间 $\\mathbb{R}^2$ 上的非遍历性凸显了一个关键的微妙之处：系综的选择至关重要。时间平均是沿着具有固定能量 $E$ 的轨迹计算的。为了等价，系综平均必须在正确的系综上进行，即限制在包含该轨迹的等能面 $\\Gamma_E$ 上的微正则（NVE）系综。\n\n谐振子流虽然在 $\\mathbb{R}^2$ 上是非遍历的，但在每个单独的能量面 $\\Gamma_E$ 上（对于 $E > 0$）*是*遍历的。轨迹就是整个椭圆，因此它在自身中是平凡稠密的。这就是为什么我们在第一部分和第二部分中的计算得出了相同的结果：$\\overline{A}_{t} = \\langle A\\rangle_{\\text{mc}}(E)$。\n\n对于模拟固体中的振动模式而言，其意义在于，用系综平均替代来自NVE模拟的时间平均是有效的，前提是该系综是处于相同能量 $E$ 的微正则系综。例如，我们不能将单一轨迹的时间平均等同于正则（NVT）系综平均，因为后者涉及对所有能量进行平均，并由玻尔兹曼因子加权。在更大的相空间上的非遍历性强制要求动力学约束（例如，恒定的 $E$）与所选系综的统计约束之间存在对应关系。",
            "answer": "$$\\boxed{\\frac{E}{k}}$$"
        },
        {
            "introduction": "遍历性假设为我们用单个模拟中更易于计算的时间平均来替代复杂的系综平均提供了理论依据。本实践  通过分析正则系综中的能量涨落，深入探讨了这一理论依据的统计基础。您将推导出一个联系能量方差和热容的基本关系，并进而证明在大型系统中相对涨落会趋于消失，从而阐明了使得分子动力学模拟如此有效的自平均（self-averaging）和典型性（typicality）概念。",
            "id": "3807172",
            "problem": "在原子和粗粒化多尺度材料模拟中，系综平均通常通过在长分子动力学（MD）轨迹上计算的时间平均来近似，当涨落是自平均的（self-averaging）时，这种方法可以通过遍历性和遍历性假说得到证明。考虑一个经典正则系综，它包含在固定体积的$3$维空间中的$N$个相同的、无相互作用的单原子点粒子，其绝对温度为$T$，玻尔兹曼常数为$k_B$。令能量表示为$E$，令$Z(\\beta)$为正则配分函数，其中$\\beta = 1/(k_B T)$。仅从正则概率$P(E_i) \\propto \\exp(-\\beta E_i)$、配分函数$Z(\\beta)$的定义以及系综平均$\\langle \\cdot \\rangle$出发，首先从第一性原理推导能量方差$\\mathrm{Var}(E)$的表达式，用$T$和定容热容$C_V = \\left(\\partial \\langle E \\rangle/\\partial T\\right)_V$来表示。然后，将其特化到能量均分定理成立的经典单原子理想气体情况，并确定无量纲相对方差$\\mathrm{Var}(E)/\\langle E \\rangle^2$作为$N$的函数的闭式表达式。你的最终答案必须是仅含$N$的单个简化符号表达式。不要进行数值计算，也不要包含单位。无需四舍五入。清楚地解释$N$标度关系如何在多尺度材料模拟的背景下与自平均和典型性相关联。",
            "solution": "该问题要求推导正则系综中系统的能量方差$\\mathrm{Var}(E)$，然后将此结果特化到经典单原子理想气体以求得相对方差。我们从正则系综的基本原理开始。\n\n在固定的体积$V$、粒子数$N$和温度$T$下，系统处于能量为$E_i$的微观态$i$的概率$P(E_i)$由玻尔兹曼分布给出：\n$$P(E_i) = \\frac{\\exp(-\\beta E_i)}{Z(\\beta)}$$\n其中$\\beta = \\frac{1}{k_B T}$是逆温度，而$k_B$是玻尔兹曼常数。正则配分函数$Z(\\beta)$作为归一化常数，定义为对所有可能微观态$i$的求和：\n$$Z(\\beta) = \\sum_i \\exp(-\\beta E_i)$$\n\n任意可观测量$A$的系综平均由$\\langle A \\rangle = \\sum_i A_i P(E_i)$给出。因此，能量的系综平均$\\langle E \\rangle$为：\n$$\\langle E \\rangle = \\sum_i E_i P(E_i) = \\frac{1}{Z(\\beta)} \\sum_i E_i \\exp(-\\beta E_i)$$\n我们可以将分子中的和式表示为配分函数对$\\beta$的导数：\n$$\\sum_i E_i \\exp(-\\beta E_i) = -\\frac{\\partial}{\\partial \\beta} \\sum_i \\exp(-\\beta E_i) = -\\frac{\\partial Z(\\beta)}{\\partial \\beta}$$\n将此代入$\\langle E \\rangle$的表达式，得到一个简洁的公式：\n$$\\langle E \\rangle = -\\frac{1}{Z(\\beta)} \\frac{\\partial Z(\\beta)}{\\partial \\beta} = -\\frac{\\partial \\ln(Z(\\beta))}{\\partial \\beta}$$\n\n接下来，我们推导能量方差的表达式，$\\mathrm{Var}(E) = \\langle E^2 \\rangle - \\langle E \\rangle^2$。首先，我们以类似的方式表示能量的均方值$\\langle E^2 \\rangle$：\n$$\\langle E^2 \\rangle = \\sum_i E_i^2 P(E_i) = \\frac{1}{Z(\\beta)} \\sum_i E_i^2 \\exp(-\\beta E_i)$$\n分子中的和式可以与$Z(\\beta)$的二阶导数相关联：\n$$\\sum_i E_i^2 \\exp(-\\beta E_i) = \\frac{\\partial^2}{\\partial \\beta^2} \\sum_i \\exp(-\\beta E_i) = \\frac{\\partial^2 Z(\\beta)}{\\partial \\beta^2}$$\n因此，$\\langle E^2 \\rangle = \\frac{1}{Z(\\beta)} \\frac{\\partial^2 Z(\\beta)}{\\partial \\beta^2}$。虽然我们可以将此代入方差公式，但一个更直接的方法是对$\\langle E \\rangle$求关于$\\beta$的导数：\n$$\\frac{\\partial \\langle E \\rangle}{\\partial \\beta} = \\frac{\\partial}{\\partial \\beta} \\left( -\\frac{\\partial \\ln(Z(\\beta))}{\\partial \\beta} \\right) = -\\frac{\\partial^2 \\ln(Z(\\beta))}{\\partial \\beta^2}$$\n使用对数二阶导数的商法则，$\\frac{d^2}{dx^2} \\ln(f) = \\frac{f f'' - (f')^2}{f^2}$，我们得到：\n$$\\frac{\\partial \\langle E \\rangle}{\\partial \\beta} = -\\left( \\frac{Z \\frac{\\partial^2 Z}{\\partial \\beta^2} - \\left(\\frac{\\partial Z}{\\partial \\beta}\\right)^2}{Z^2} \\right) = \\frac{1}{Z^2} \\left(\\frac{\\partial Z}{\\partial \\beta}\\right)^2 - \\frac{1}{Z} \\frac{\\partial^2 Z}{\\partial \\beta^2}$$\n认识到$\\langle E \\rangle = -\\frac{1}{Z} \\frac{\\partial Z}{\\partial \\beta}$和$\\langle E^2 \\rangle = \\frac{1}{Z} \\frac{\\partial^2 Z}{\\partial \\beta^2}$，我们可以将它们代回：\n$$\\frac{\\partial \\langle E \\rangle}{\\partial \\beta} = \\langle E \\rangle^2 - \\langle E^2 \\rangle = -(\\langle E^2 \\rangle - \\langle E \\rangle^2) = -\\mathrm{Var}(E)$$\n这就得出了能量涨落的基本结果：$\\mathrm{Var}(E) = -\\frac{\\partial \\langle E \\rangle}{\\partial \\beta}$。\n\n问题要求用温度$T$和定容热容$C_V$表示方差。我们使用链式法则将变量从$\\beta$转换为$T$。给定$\\beta = (k_B T)^{-1}$，我们有$\\frac{d\\beta}{dT} = -\\frac{1}{k_B T^2}$。因此：\n$$\\frac{\\partial \\langle E \\rangle}{\\partial T} = \\frac{\\partial \\langle E \\rangle}{\\partial \\beta} \\frac{d\\beta}{dT} = \\left(-\\mathrm{Var}(E)\\right) \\left(-\\frac{1}{k_B T^2}\\right) = \\frac{\\mathrm{Var}(E)}{k_B T^2}$$\n根据定义，定容热容是$C_V = \\left(\\frac{\\partial \\langle E \\rangle}{\\partial T}\\right)_V$。令导数的两个表达式相等，我们得到能量方差和热容之间的关系：\n$$\\mathrm{Var}(E) = k_B T^2 C_V$$\n这完成了推导的第一部分。\n\n现在，我们将此结果特化到$N$个粒子在$3$维空间中的经典单原子理想气体。对于这个系统，能量完全是动能。根据能量均分定理，每个二次自由度贡献的平均能量为$\\frac{1}{2} k_B T$。每个单原子粒子有$3$个平动自由度，因此系统哈密顿量中总共有$3N$个二次自由度。于是，平均能量为：\n$$\\langle E \\rangle = \\frac{3}{2} N k_B T$$\n定容热容则通过对$\\langle E \\rangle$求关于$T$的导数得到：\n$$C_V = \\left(\\frac{\\partial \\langle E \\rangle}{\\partial T}\\right)_V = \\frac{\\partial}{\\partial T}\\left(\\frac{3}{2} N k_B T\\right) = \\frac{3}{2} N k_B$$\n\n我们现在可以求出这个特定系统的能量方差：\n$$\\mathrm{Var}(E) = k_B T^2 C_V = k_B T^2 \\left(\\frac{3}{2} N k_B\\right) = \\frac{3}{2} N (k_B T)^2$$\n问题要求的是无量纲相对方差$\\frac{\\mathrm{Var}(E)}{\\langle E \\rangle^2}$。我们计算这个比值：\n$$\\frac{\\mathrm{Var}(E)}{\\langle E \\rangle^2} = \\frac{\\frac{3}{2} N (k_B T)^2}{\\left(\\frac{3}{2} N k_B T\\right)^2} = \\frac{\\frac{3}{2} N (k_B T)^2}{\\frac{9}{4} N^2 (k_B T)^2} = \\frac{3/2}{9/4} \\frac{N}{N^2} = \\left(\\frac{3}{2}\\right)\\left(\\frac{4}{9}\\right)\\frac{1}{N} = \\frac{2}{3N}$$\n\n最终结果$\\frac{\\mathrm{Var}(E)}{\\langle E \\rangle^2} = \\frac{2}{3N}$对统计力学及其在多尺度模拟中的应用具有深远的影响。能量的相对标准差$\\frac{\\sigma_E}{\\langle E \\rangle} = \\sqrt{\\frac{\\mathrm{Var}(E)}{\\langle E \\rangle^2}}$，其标度关系为$N^{-1/2}$：\n$$\\frac{\\sigma_E}{\\langle E \\rangle} = \\sqrt{\\frac{2}{3N}} \\propto \\frac{1}{\\sqrt{N}}$$\n这种标度关系展示了**自平均**（self-averaging）原理。当系统中的粒子数$N$趋于热力学极限（$N \\to \\infty$）时，能量涨落的相对大小变得无穷小。对于宏观系统，能量实际上是恒定的，等于系综平均值$\\langle E \\rangle$。这一观察也引出了**典型性**（typicality）的概念。它意味着在一个大系统中，绝大多数可及的微观态的能量都与平均能量$\\langle E \\rangle$无法区分。任何随机选择的微观态几乎肯定是一个“典型”的微观态。\n\n在多尺度材料模拟，特别是分子动力学（MD）的背景下，这个结果提供了一个关键的理论依据。MD模拟跟踪一个由$N$个粒子组成的单一系统在相空间中的轨迹。遍历性假说假定，对于足够长的时间，可观测量的这种时间平均等价于系综平均。自平均性质确保了对于一个具有大$N$的系统（正如模拟中常见的那样），系统的瞬时能量$E(t)$将仅在系综平均值$\\langle E \\rangle$附近表现出微小的涨落。因此，时间平均能有效地收敛到一个稳定值，该值精确地代表了热力学平均。典型态的主导地位意味着，只要单个模拟轨迹足够长以探索相空间的相关区域，它就足以对系统的宏观性质进行取样，从而验证了使用MD计算能量、压力和热容等系综平均量的整个方法。",
            "answer": "$$\\boxed{\\frac{2}{3N}}$$"
        },
        {
            "introduction": "许多真实世界的系统，从蛋白质折叠到相变，都表现出亚稳态特性，即系统会在多个稳定状态中的某一个里停留很长时间。这个问题  使用双势阱中的粒子模型来探讨此类系统中的遍历性。您将研究相空间如何被分解为不同的遍历分量，并确定系统在各个状态中的长期存在概率，这为理解遍历性破缺系统和进行粗粒化（coarse-graining）分析提供了一个重要框架。",
            "id": "3807138",
            "problem": "在多尺度材料模拟中，通常通过将构型空间划分为由鞍点位置 $x_s$ 分隔的左势阱 $W_A$ 和右势阱 $W_B$ 来对动力学进行粗粒化。这种做法的理论基础在于系统的遍历性破缺，使得相空间分解为两个遍历分量，其稳态占据概率（混合权重）分别为 $p_A$ 和 $p_B$。请推导由这两个概率组成的权重向量 $(p_A, p_B)$ 的表达式，并以行向量形式给出。",
            "solution": "用户希望找到一个粒子处于双稳态势的左势阱 ($W_A$) 或右势阱 ($W_B$) 中的稳态概率 $p_A$ 和 $p_B$。系统的动力学由一个过阻尼朗之万方程控制，并且问题设定在稀有跃迁（高势垒）区域。\n\n由给定的随机微分方程描述的系统的稳态分布是吉布斯-玻尔兹曼分布，其概率密度函数 $\\rho(x)$ 由下式给出\n$$\ndx_t = -\\frac{1}{\\gamma} V'(x_t) dt + \\sqrt{\\frac{2}{\\beta \\gamma}} dW_t\n$$\n$$\n\\rho(x) = \\frac{1}{Z} \\exp(-\\beta V(x))\n$$\n其中 $Z = \\int_{-\\infty}^{\\infty} \\exp(-\\beta V(x)) dx$ 是总配分函数。\n\n混合权重 $p_A$ 和 $p_B$ 代表在相应势阱 $W_A = (-\\infty, x_s)$ 和 $W_B = (x_s, \\infty)$ 中找到系统的稳态概率，其中 $x_s$ 是势垒的位置。这些概率通过对每个势阱上的稳态密度进行积分来定义：\n$$\np_A = \\int_{W_A} \\rho(x) dx = \\frac{1}{Z} \\int_{-\\infty}^{x_s} \\exp(-\\beta V(x)) dx = \\frac{Z_A}{Z}\n$$\n$$\np_B = \\int_{W_B} \\rho(x) dx = \\frac{1}{Z} \\int_{x_s}^{\\infty} \\exp(-\\beta V(x)) dx = \\frac{Z_B}{Z}\n$$\n其中 $Z_A$ 和 $Z_B$ 分别是势阱 A 和 B 的受限配分函数。\n从它们的定义可以清楚地看出，$p_A + p_B = (Z_A + Z_B)/Z \\approx 1$（因为在高势垒极限下，鞍点 $x_s$ 周围区域的概率质量可以忽略不计）。概率可以表示为：\n$$\np_A = \\frac{Z_A}{Z_A + Z_B} = \\frac{1}{1 + Z_B/Z_A}, \\qquad p_B = \\frac{Z_B}{Z_A + Z_B} = \\frac{Z_B/Z_A}{1 + Z_B/Z_A}\n$$\n问题的核心是计算比率 $Z_B/Z_A$。\n\n条件 $\\beta \\lambda a^4 / 4 \\gg 1$ 意味着势垒高度远大于热能 $1/\\beta$，这为使用拉普拉斯（或鞍点）近似来计算积分 $Z_A$ 和 $Z_B$ 提供了依据。被积函数 $\\exp(-\\beta V(x))$ 在势能 $V(x)$ 的局部极小点周围呈尖峰状。对于在 $x_0$ 处有尖锐极小点的 $\\int e^{-f(x)} dx$ 形式的积分，其近似值为 $\\int e^{-f(x)} dx \\approx e^{-f(x_0)} \\sqrt{2\\pi/f''(x_0)}$。在我们的问题中，$f(x) = \\beta V(x)$。\n\n首先，我们找到势能 $V(x) = \\frac{\\lambda}{4}(x^2 - a^2)^2 + \\delta x$ 的极小点。通过将导数 $V'(x)$ 设为零来找到极值点：\n$$\nV'(x) = \\lambda x(x^2-a^2) + \\delta = \\lambda x^3 - \\lambda a^2 x + \\delta = 0\n$$\n给定条件 $|\\delta| \\ll \\lambda a^3$，我们可以将 $\\delta$ 视为一个小微扰，从而找到两个极小点 ($x_A^*$, $x_B^*$) 和鞍点 ($x_s^*$) 的近似位置。\n当 $\\delta=0$ 时，极小点在 $x=\\pm a$，鞍点在 $x=0$。\n设左极小点为 $x_A^* = -a + \\epsilon_A$。代入 $V'(x)=0$：\n$\\lambda(-a+\\epsilon_A)^3 - \\lambda a^2(-a+\\epsilon_A) + \\delta \\approx \\lambda(-a^3+3a^2\\epsilon_A) - \\lambda a^2(-a+\\epsilon_A) + \\delta = 2\\lambda a^2 \\epsilon_A + \\delta = 0 \\implies \\epsilon_A = -\\frac{\\delta}{2\\lambda a^2}$。\n所以，$x_A^* \\approx -a - \\frac{\\delta}{2\\lambda a^2}$。\n同样，对于右极小点 $x_B^* = a + \\epsilon_B$：\n$\\lambda(a+\\epsilon_B)^3 - \\lambda a^2(a+\\epsilon_B) + \\delta \\approx 2\\lambda a^2 \\epsilon_B + \\delta = 0 \\implies \\epsilon_B = -\\frac{\\delta}{2\\lambda a^2}$。\n所以，$x_B^* \\approx a - \\frac{\\delta}{2\\lambda a^2}$。\n\n接下来，我们计算这些极小点处的势能。在主阶上，我们可以近似为 $V(x_{A/B}^*) \\approx V(\\mp a)$。\n$V(-a) = \\frac{\\lambda}{4}((-a)^2 - a^2)^2 + \\delta(-a) = -a\\delta$。\n$V(a) = \\frac{\\lambda}{4}(a^2 - a^2)^2 + \\delta(a) = a\\delta$。\n极小点之间的势能差为 $\\Delta V = V(x_B^*) - V(x_A^*) \\approx V(a) - V(-a) = a\\delta - (-a\\delta) = 2a\\delta$。一个更仔细的展开证实了主阶上的这个结果。\n\n拉普拉斯近似还需要势能的二阶导数，$V''(x) = 3\\lambda x^2 - \\lambda a^2$。我们在极小点处计算它：\n$V''(x_A^*) \\approx V''(-a) = 3\\lambda(-a)^2 - \\lambda a^2 = 2\\lambda a^2$。\n$V''(x_B^*) \\approx V''(a) = 3\\lambda(a)^2 - \\lambda a^2 = 2\\lambda a^2$。\n在主阶上，两个极小点处的曲率是相同的。\n\n现在我们将拉普拉斯近似应用于 $Z_A$ 和 $Z_B$：\n$$\nZ_A = \\int_{-\\infty}^{x_s} \\exp(-\\beta V(x)) dx \\approx \\exp(-\\beta V(x_A^*)) \\sqrt{\\frac{2\\pi}{\\beta V''(x_A^*)}}\n$$\n$$\nZ_B = \\int_{x_s}^{\\infty} \\exp(-\\beta V(x)) dx \\approx \\exp(-\\beta V(x_B^*)) \\sqrt{\\frac{2\\pi}{\\beta V''(x_B^*)}}\n$$\n我们计算比率 $Z_B/Z_A$：\n$$\n\\frac{Z_B}{Z_A} \\approx \\frac{\\exp(-\\beta V(x_B^*)) \\sqrt{2\\pi/(\\beta V''(x_B^*))}}{\\exp(-\\beta V(x_A^*)) \\sqrt{2\\pi/(\\beta V''(x_A^*))}}\n$$\n由于 $V''(x_A^*) \\approx V''(x_B^*)$，平方根项（指前因子）相互抵消。\n$$\n\\frac{Z_B}{Z_A} \\approx \\exp(-\\beta (V(x_B^*) - V(x_A^*)))\n$$\n代入势能差 $\\Delta V \\approx 2a\\delta$：\n$$\n\\frac{Z_B}{Z_A} \\approx \\exp(-2\\beta a \\delta)\n$$\n最后，我们将这个比率代回到 $p_A$ 和 $p_B$ 的表达式中：\n$$\np_A = \\frac{1}{1 + Z_B/Z_A} = \\frac{1}{1 + \\exp(-2\\beta a \\delta)}\n$$\n$$\np_B = \\frac{Z_B/Z_A}{1 + Z_B/Z_A} = \\frac{\\exp(-2\\beta a \\delta)}{1 + \\exp(-2\\beta a \\delta)}\n$$\n这些就是混合权重作为 $\\beta$、$a$ 和 $\\delta$ 的函数的显式闭式表达式。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{1 + \\exp(-2\\beta a \\delta)} & \\frac{\\exp(-2\\beta a \\delta)}{1 + \\exp(-2\\beta a \\delta)}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}