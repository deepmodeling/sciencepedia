{
    "hands_on_practices": [
        {
            "introduction": "配分函数是连接微观细节（如哈密顿量）与宏观热力学性质（如能量和热容）的桥梁。本练习将通过一个具体实例来巩固这一核心概念。我们将为一个处于特定（尽管是假设的）势能函数下的单粒子系统计算其正则配分函数，并最终推导出其定域热容，从而锻炼应用统计力学原理所需的核心数学技能 。",
            "id": "147569",
            "problem": "一个质量为 $m$ 的经典粒子被限制在二维平面内，并与温度恒为 $T$ 的热库处于热平衡状态。该粒子的势能由函数 $U(x,y) = c(|x|+|y|)$ 给出，其中 $c$ 是一个单位为力的正常数。\n\n二维空间中单个粒子的经典正则配分函数 $Q_1$ 由下式给出：\n$$\nQ_1(T, A) = \\frac{1}{h^2} \\iint_{A} dx dy \\iint_{-\\infty}^{\\infty} dp_x dp_y e^{-\\beta H(x,y,p_x,p_y)}\n$$\n其中 $H$ 是系统的经典哈密顿量，$\\beta = (k_B T)^{-1}$，$k_B$ 是玻尔兹曼常数，$h$ 是普朗克常数，积分范围是可及区域 $A$ 和所有可能的动量。对于此势能，粒子被限制在原点附近，因此可以假设区域 $A$ 实际上是无限的，即 $x$ 和 $y$ 的积分限为从 $-\\infty$ 到 $\\infty$。\n\n定面积热容 $C_A$ 与平均能量 $\\langle E \\rangle$ 的关系为 $C_A = (\\partial \\langle E \\rangle / \\partial T)_A$，其中平均能量可以通过配分函数由 $\\langle E \\rangle = -(\\partial \\ln Q_1 / \\partial \\beta)_A$ 求得。\n\n推导该粒子的定面积热容 $C_A$ 的表达式。",
            "solution": "1. 正则配分函数可以分解为动量部分和构型部分：\n$$\nQ_1=\\frac{1}{h^2}\\iint_{-\\infty}^{\\infty}dp_x\\,dp_y\\,e^{-\\beta\\frac{p_x^2+p_y^2}{2m}}\n\\iint_{-\\infty}^{\\infty}dx\\,dy\\,e^{-\\beta c(|x|+|y|)}\\,.\n$$\n\n2. 动量积分：\n$$\n\\iint dp_x\\,dp_y\\,e^{-\\beta\\frac{p_x^2+p_y^2}{2m}}\n=\\left(\\int_{-\\infty}^{\\infty}e^{-\\beta\\frac{p^2}{2m}}dp\\right)^2\n=\\left(\\sqrt{\\frac{2\\pi m}{\\beta}}\\right)^2\n=\\frac{2\\pi m}{\\beta}\\,.\n$$\n\n3. 构型积分：\n$$\n\\int_{-\\infty}^{\\infty}e^{-\\beta c|x|}dx\n=2\\int_{0}^{\\infty}e^{-\\beta c x}dx\n=\\frac{2}{\\beta c}\\,,\n$$\n所以\n$$\n\\iint dx\\,dy\\,e^{-\\beta c(|x|+|y|)}\n=\\frac{2}{\\beta c}\\cdot\\frac{2}{\\beta c}\n=\\frac{4}{(\\beta c)^2}\\,.\n$$\n\n4. 因此\n$$\nQ_1\n=\\frac{1}{h^2}\\,\\frac{2\\pi m}{\\beta}\\,\\frac{4}{(\\beta c)^2}\n=\\frac{8\\pi m}{h^2c^2}\\,\\beta^{-3}\\,,\n$$\n且\n$$\n\\ln Q_1\n=\\ln\\left(\\frac{8\\pi m}{h^2c^2}\\right)-3\\ln\\beta\\,.\n$$\n\n5. 平均能量为\n$$\n\\langle E\\rangle\n=-\\frac{\\partial\\ln Q_1}{\\partial\\beta}\n=-\\left(-3\\beta^{-1}\\right)\n=\\frac{3}{\\beta}\n=3k_B T\\,.\n$$\n\n6. 最后，定面积热容为\n$$\nC_A\n=\\frac{\\partial\\langle E\\rangle}{\\partial T}\n=3k_B\\,.\n$$",
            "answer": "$$\\boxed{3k_B}$$"
        },
        {
            "introduction": "在处理完单粒子系统后，我们将转向多粒子系统，其中一个关键挑战是如何处理相同粒子的不可区分性——这是一个具有深远影响的概念。这个练习将从第一性原理出发，在微正则系综中推导理想气体的熵，并揭示关键的 $1/N!$ 修正因子如何解决了著名的吉布斯佯谬。 这不仅是一次计算，更是一次深入理解统计力学基础和熵的本质的旅程。",
            "id": "3853579",
            "problem": "在多尺度材料模拟中，粗粒化热力学量必须与其原子统计力学定义相一致。考虑一个三维经典单原子理想气体，由$N$个质量为$m$的相同原子组成，被限制在固定体积$V$内，总能量为$E$。假设在热力学极限下，$N$很大且粒子密度保持有限。\n\n从微正则系综的定义出发，熵$S$由$S = k_B \\ln \\Omega$给出，其中$\\Omega$是在固定能量$E$下可及微观状态的相空间测度。通过以下步骤计算微观状态数：\n- 使用因子$1/N!$对不可区分性进行修正，\n- 使用元胞体积$h^{3N}$对相空间进行粗粒化，其中$h$是普朗克常数，\n- 在与固定能量$E$一致的位置和动量上计算相空间积分。\n\n仅使用基本定义和经过充分检验的数学事实，包括$D$维超球体的体积和表面积测度，以及适用于大自变量的斯特林近似。推导出一个关于$k_B$、$N$、$V$、$E$、$m$和$h$的熵$S$的显式闭式解析表达式，精确到$N$的次广延性项。\n\n接着，考虑移除两个子系统之间的一个隔板，每个子系统最初都包含处于相同温度和压力下的相同经典单原子理想气体，其状态分别为$\\left(N_1, V_1, E_1\\right)$和$\\left(N_2, V_2, E_2\\right)$，其中$N_1 = N_2 = N/2$，$V_1 = V_2 = V/2$，$E_1 = E_2 = E/2$。在保持总能量$E$和总体积$V$不变的情况下移除隔板。使用你推导出的熵，确定在热力学极限下，仅由混合相同气体引起的熵变是非零还是零，并解释不可区分性修正是如何解决Gibbs佯谬的。除上述指定定义外，不要假定任何目标公式。\n\n作为你的最终答案，提供你推导出的关于$k_B$、$N$、$V$、$E$、$m$和$h$的熵$S$的闭式解析表达式。不要提供数值计算结果。最终答案必须是单个解析表达式。",
            "solution": "该问题被认为是有效的，因为它具有科学依据、提法明确且客观，代表了统计力学中的一个标准推导和应用。\n\n该问题要求在微正则系综中推导经典单原子理想气体的熵$S$，并将其应用于Gibbs佯谬。系统由$N$个质量为$m$的相同原子组成，处于体积$V$中，总能量为$E$。熵定义为$S = k_B \\ln \\Omega$，其中$\\Omega$是可及微观状态的数量。\n\n一个微观状态由所有$N$个粒子的位置$\\mathbf{q}_i$和动量$\\mathbf{p}_i$定义。所有可能状态的集合构成一个$6N$维相空间。微观状态数$\\Omega$通过计算相空间中可及区域的体积，并除以单个微观状态的体积来求得，由于粗粒化，后者取为$h^{3N}$。对于相同的粒子，我们还必须除以$N!$以修正对物理上不可区分的状态的重复计数。\n能量不高于$E$的微观状态数由相空间体积$\\Phi(E, V, N)$给出：\n$$\n\\Phi(E, V, N) = \\frac{1}{N! h^{3N}} \\int d^{3N}q \\int d^{3N}p\n$$\n积分范围是体积$V$内的所有位置和总能量小于或等于$E$的所有动量。对于单原子理想气体，能量纯粹是动能：\n$$\nH(\\mathbf{q}, \\mathbf{p}) = \\sum_{i=1}^{N} \\frac{|\\mathbf{p}_i|^2}{2m} = E_k \\le E\n$$\n位置积分是对每个粒子在体积$V$内进行的，结果为$V^N$：\n$$\n\\int d^{3N}q = \\left( \\int_V d^3q \\right)^N = V^N\n$$\n动量积分是在由能量约束定义的$3N$维超球体的体积上进行的。让我们通过将所有动量分量组合成一个$3N$维向量来重写该约束：\n$$\n\\sum_{j=1}^{3N} p_j^2 \\le 2mE\n$$\n这在$3N$维动量空间中定义了一个半径为$R_p = \\sqrt{2mE}$的超球体。半径为$R$的$D$维球体的体积由以下公式给出：\n$$\n\\mathcal{V}_D(R) = \\frac{\\pi^{D/2}}{\\Gamma(\\frac{D}{2} + 1)} R^D\n$$\n在我们的情况下，维度是$D = 3N$，半径是$R_p = \\sqrt{2mE}$。动量空间体积为：\n$$\n\\int d^{3N}p = \\mathcal{V}_{3N}(\\sqrt{2mE}) = \\frac{\\pi^{3N/2}}{\\Gamma(\\frac{3N}{2} + 1)} (2mE)^{3N/2}\n$$\n结合所有部分，总相空间体积为：\n$$\n\\Phi(E, V, N) = \\frac{V^N}{N! h^{3N}} \\frac{\\pi^{3N/2}}{\\Gamma(\\frac{3N}{2} + 1)} (2mE)^{3N/2}\n$$\n问题将$\\Omega$定义为固定能量$E$下的状态测度，这对应于超球体的表面。然而，在热力学极限（$N \\rightarrow \\infty$）下，球壳体积的对数$\\ln(\\omega(E)\\delta E)$等价于总球体体积的对数$\\ln(\\Phi(E))$，两者之差为次广延性项。这是因为$\\Phi(E) \\propto E^{3N/2}$，所以$\\omega(E) = \\frac{d\\Phi}{dE} = \\frac{3N}{2E}\\Phi(E)$。取对数后，$\\ln(\\omega(E)) = \\ln(\\Phi(E)) + \\ln(\\frac{3N}{2E})$，其中第二项是次广延性的。因此，我们可以近似为$S = k_B \\ln \\Phi(E, V, N)$。\n\n我们现在对$\\Phi$取对数：\n$$\n\\ln \\Phi = N \\ln V - \\ln(N!) - 3N \\ln h + \\frac{3N}{2} \\ln(\\pi) + \\frac{3N}{2} \\ln(2mE) - \\ln\\left(\\Gamma\\left(\\frac{3N}{2} + 1\\right)\\right)\n$$\n对于大的$N$，我们使用斯特林近似来处理阶乘和伽马函数：$\\ln(x!) \\approx x \\ln x - x$和$\\ln \\Gamma(z+1) \\approx z \\ln z - z$。\n$$\n\\ln(N!) \\approx N \\ln N - N\n$$\n$$\n\\ln\\left(\\Gamma\\left(\\frac{3N}{2} + 1\\right)\\right) \\approx \\frac{3N}{2} \\ln\\left(\\frac{3N}{2}\\right) - \\frac{3N}{2}\n$$\n将这些近似代入$\\ln \\Phi$的表达式中：\n$$\n\\ln \\Phi \\approx N \\ln V - (N \\ln N - N) - 3N \\ln h + \\frac{3N}{2} \\ln(2\\pi mE) - \\left(\\frac{3N}{2} \\ln\\left(\\frac{3N}{2}\\right) - \\frac{3N}{2}\\right)\n$$\n让我们收集并简化这些项：\n$$\n\\ln \\Phi \\approx N \\ln V - N \\ln N + N - 3N \\ln h + \\frac{3N}{2} \\ln(2\\pi mE) - \\frac{3N}{2} (\\ln(3N) - \\ln(2)) + \\frac{3N}{2}\n$$\n$$\n\\ln \\Phi \\approx N \\ln V - N \\ln N + \\frac{5N}{2} - 3N \\ln h + \\frac{3N}{2} \\ln(2\\pi mE) - \\frac{3N}{2} \\ln(3N) + \\frac{3N}{2} \\ln(2)\n$$\n我们可以将对数项组合起来：\n$$\n\\ln \\Phi \\approx N\\left(\\ln V - \\ln N\\right) + \\frac{3N}{2}\\left(\\ln(2\\pi mE) - \\ln(3N) + \\ln 2\\right) - 3N \\ln h + \\frac{5N}{2}\n$$\n$$\n\\ln \\Phi \\approx N\\ln\\left(\\frac{V}{N}\\right) + \\frac{3N}{2}\\ln\\left(\\frac{4\\pi mE}{3N}\\right) - \\frac{3N}{2}\\ln(h^2) + \\frac{5N}{2}\n$$\n$$\n\\ln \\Phi \\approx N\\ln\\left(\\frac{V}{N}\\right) + \\frac{3N}{2}\\ln\\left(\\frac{4\\pi mE}{3N h^2}\\right) + \\frac{5N}{2}\n$$\n因此，熵$S = k_B \\ln \\Phi$为：\n$$\nS(N,V,E) = N k_B \\left[ \\ln\\left(\\frac{V}{N}\\right) + \\frac{3}{2} \\ln\\left(\\frac{4\\pi mE}{3N h^2}\\right) + \\frac{5}{2} \\right]\n$$\n这就是Sackur-Tetrode方程。它是一个广延量：如果我们将系统按比例因子$\\lambda$进行缩放（即$N \\to \\lambda N$，$V \\to \\lambda V$，$E \\to \\lambda E$），内涵比率$V/N$和$E/N$保持不变，整个表达式随$N$缩放，因此$S \\to \\lambda S$。\n\n现在，我们分析Gibbs佯谬。考虑两个相同的系统，每个系统都处于热和力学平衡状态，参数为$(N/2, V/2, E/2)$。总初始熵为$S_{initial} = S_1 + S_2$。\n$$\nS_1 = S\\left(\\frac{N}{2}, \\frac{V}{2}, \\frac{E}{2}\\right) = \\frac{N}{2} k_B \\left[ \\ln\\left(\\frac{V/2}{N/2}\\right) + \\frac{3}{2} \\ln\\left(\\frac{4\\pi m(E/2)}{3(N/2)h^2}\\right) + \\frac{5}{2} \\right]\n$$\n$$\nS_1 = \\frac{N}{2} k_B \\left[ \\ln\\left(\\frac{V}{N}\\right) + \\frac{3}{2} \\ln\\left(\\frac{4\\pi mE}{3Nh^2}\\right) + \\frac{5}{2} \\right]\n$$\n由于子系统是相同的，$S_1 = S_2$。总初始熵为：\n$$\nS_{initial} = 2 \\times S_1 = N k_B \\left[ \\ln\\left(\\frac{V}{N}\\right) + \\frac{3}{2} \\ln\\left(\\frac{4\\pi mE}{3Nh^2}\\right) + \\frac{5}{2} \\right]\n$$\n移除隔板后，我们得到一个参数为$(N, V, E)$的单一系统。最终熵为：\n$$\nS_{final} = S(N, V, E) = N k_B \\left[ \\ln\\left(\\frac{V}{N}\\right) + \\frac{3}{2} \\ln\\left(\\frac{4\\pi mE}{3Nh^2}\\right) + \\frac{5}{2} \\right]\n$$\n熵变为$\\Delta S = S_{final} - S_{initial} = 0$。这个结果在物理上是正确的：在相同温度和压力下，两个相同气体的可逆混合不应产生熵变。\n\n如果省略粒子不可区分性因子$1/N!$，就会出现Gibbs佯谬。没有这个因子，熵$S'$将比我们计算的结果少一个$-k_B \\ln(N!) \\approx -k_B(N \\ln N - N)$项。换句话说，正确的熵是$S = S' - k_B \\ln(N!)$，其中$S'$是可区分粒子的熵。$S'$中的关键项将是$N \\ln V$而不是$N \\ln(V/N)$，这使得$S'$成为一个非广延量。将这个非广延熵应用于混合问题，会得出一个虚假的混合熵，$\\Delta S' = N k_B \\ln 2$。混合相同气体时出现的这种自相矛盾的熵增，通过使用$1/N!$因子正确地考虑粒子不可区分性而得到解决。这个修正确保了熵是系统的广延性质，从而导致$\\Delta S = 0$，这符合涉及相同物质的可逆过程的要求。\n\n最终要求回答的是推导出的熵$S$的闭式解析表达式。",
            "answer": "$$\n\\boxed{N k_B \\left[ \\ln\\left(\\frac{V}{N}\\right) + \\frac{3}{2} \\ln\\left(\\frac{4 \\pi m E}{3 N h^2}\\right) + \\frac{5}{2} \\right]}\n$$"
        },
        {
            "introduction": "真实材料的性质是由其组成粒子间的相互作用决定的。最后的这个实践将我们从无相互作用的理想气体模型带入更真实的流体模型，其中粒子通过经典的 Lennard-Jones 势相互作用。您将首先推导表征真实气体对理想气体行为一阶偏离的第二维里系数，然后通过编写程序进行数值计算。 这项练习完美地连接了抽象的统计理论与实用的计算模拟，是现代材料模拟领域的一项关键技能。",
            "id": "3853604",
            "problem": "给定一个经典的三维平衡系统，其中包含在正则系综中、温度为 $T$ 的不可区分粒子。粒子通过成对相加的 Lennard–Jones (LJ) 势相互作用。你的任务是从正则组态配分函数和集团展开中使用的 Mayer $f$-函数的定义出发，在不假定任何预先推导的维里表达式的情况下，推导出一个各向同性对势的第二维里系数 $B_2(T)$ 的一维径向积分表达式。然后，使用此表达式，通过设置一个径向截断上限来估算相应 Mayer 函数 $f(r)$ 的积分，从而实现一个数值方案来近似 Lennard–Jones 势的 $B_2(T)$，并评估其在不同温度下的收敛性。\n\n使用的基本原理：\n- 正则系综定义：经典正则组态积分、不可区分性因子，以及玻尔兹曼权重 $\\exp(-\\beta U)$，其中 $\\beta = 1/(k_{\\mathrm{B}} T)$，$k_{\\mathrm{B}}$ 为玻尔兹曼常数。\n- 集团展开（Mayer 展开）：在足以识别第二维里系数如何从双粒子贡献中以 Mayer $f$-函数的形式出现的层面上，其中对于对势 $u(r)$，$f_{ij} = \\exp(-\\beta u(r_{ij})) - 1$。\n- 在各向同性条件下，从三维空间积分到一维径向积分的几何简化。\n\n系统详情：\n- 对势为 Lennard–Jones (LJ) 势 $u(r) = 4 \\varepsilon \\left[ \\left( \\dfrac{\\sigma}{r} \\right)^{12} - \\left( \\dfrac{\\sigma}{r} \\right)^{6} \\right]$，其中 $\\varepsilon$ 和 $\\sigma$ 分别是 LJ 能量和长度标度。\n- 引入约化变量 $T^\\star = \\dfrac{k_{\\mathrm{B}} T}{\\varepsilon}$ 和 $x = \\dfrac{r}{\\sigma}$，并将无量纲的第二维里系数 $B_2^\\star(T^\\star) = \\dfrac{B_2(T)}{\\sigma^3}$ 完全用 $T^\\star$ 和 $x$ 表示。\n\n数值近似要求：\n- 用有限截断值 $x_{\\max}$ 替换径向积分中的无限上限，并数值计算截断后的积分以近似 $B_2^\\star(T^\\star)$。\n- 解释 Lennard–Jones 势尾部对应的 Mayer $f$-函数的渐进行为如何为关于 $x_{\\max}$ 的收敛性提供信息，并以此证明你的收敛性评估的合理性。\n\n测试组：\n- 使用约化温度 $T^\\star \\in \\{0.5, 1.0, 2.0, 5.0\\}$。\n- 对每个 $T^\\star$，在三个截断上限 $x_{\\max} \\in \\{6, 8, 10\\}$ 下计算截断的 $B_2^\\star(T^\\star)$。\n- 对每个 $T^\\star$，报告三个数值：\n  1. 使用 $x_{\\max} = 10$ 计算的 $B_2^\\star(T^\\star)$ 值。\n  2. 绝对差 $\\Delta_{10,8} = \\left| B_2^\\star(T^\\star; x_{\\max}=10) - B_2^\\star(T^\\star; x_{\\max}=8) \\right|$。\n  3. 绝对差 $\\Delta_{8,6} = \\left| B_2^\\star(T^\\star; x_{\\max}=8) - B_2^\\star(T^\\star; x_{\\max}=6) \\right|$。\n\n单位和数值规范：\n- 将 $B_2^\\star$ 报告为无量纲数（等效于以 $\\sigma^3$ 为单位的 $B_2$）。\n- 输出中不需要物理单位。\n- 不涉及角度。\n- 不得使用百分比；所有比率（如有）必须以小数形式给出。\n\n最终程序输出格式：\n- 你的程序必须生成单行输出，其中包含一个用方括号括起来的、由逗号分隔的列表，列表包含四个对应于不同温度的三元组。例如：$[[a_1,b_1,c_1],[a_2,b_2,c_2],[a_3,b_3,c_3],[a_4,b_4,c_4]]$，其中每个 $a_i$、$b_i$ 和 $c_i$ 都是一个浮点数，按顺序对应于 $T^\\star \\in \\{0.5, 1.0, 2.0, 5.0\\}$。\n\n你必须交付的内容：\n- 根据指定的第一性原理，推导你将要实现的积分表达式。\n- 解释数值积分和收敛性评估的算法选择。\n- 实现计算并按上述指定的确切格式生成最终输出。最终输出必须是你的程序打印的唯一一行。",
            "solution": "我们从包含 $N$ 个不可区分粒子、温度为 $T$ 的经典正则系综系统开始。其组态配分函数为：\n$$\nZ_N^{\\text{conf}} = \\frac{1}{N!} \\int d\\mathbf{r}_1 \\cdots d\\mathbf{r}_N e^{-\\beta U(\\mathbf{r}^N)}\n$$\n其中 $\\beta = 1/(k_B T)$，总势能 $U(\\mathbf{r}^N) = \\sum_{1 \\le i  j \\le N} u(r_{ij})$ 是成对相加的。\n\n维里状态方程将压力 $P$ 与粒子数密度 $\\rho = N/V$ 以幂级数形式关联起来：\n$$\n\\frac{P}{\\rho k_B T} = 1 + B_2(T)\\rho + B_3(T)\\rho^2 + \\dots\n$$\n其中 $B_2(T)$ 是第二维里系数，它描述了由粒子间成对相互作用引起的对理想气体行为的一阶偏离。\n\n通过集团展开（Mayer expansion），可以将 $B_2(T)$ 与 Mayer $f$-函数关联起来。Mayer函数定义为 $f_{ij} = e^{-\\beta u(r_{ij})} - 1$。第二维里系数由以下积分给出：\n$$\nB_2(T) = -\\frac{1}{2} \\int f(\\mathbf{r}) d\\mathbf{r}\n$$\n这个积分是在单个粒子的坐标系下，对第二个粒子的所有可能位置进行的。对于各向同性的对势 $u(r)$，积分可以转换到球坐标系中：\n$$\nB_2(T) = -\\frac{1}{2} \\int_0^\\infty (e^{-\\beta u(r)} - 1) 4\\pi r^2 dr = -2\\pi \\int_0^\\infty (e^{-\\beta u(r)} - 1) r^2 dr\n$$\n这是我们将要实现的积分表达式。\n\n为了进行数值计算，我们引入约化（无量纲）单位：\n- 约化温度: $T^\\star = k_B T / \\varepsilon$\n- 约化距离: $x = r / \\sigma$\n- 约化第二维里系数: $B_2^\\star = B_2 / \\sigma^3$\n\n将这些代入积分表达式中：\n$$\nB_2^\\star(T^\\star) = \\frac{B_2(T)}{\\sigma^3} = \\frac{-2\\pi}{\\sigma^3} \\int_0^\\infty \\left(e^{-\\frac{u(x\\sigma)}{\\varepsilon T^\\star}} - 1\\right) (x\\sigma)^2 d(x\\sigma)\n$$\nLJ势的约化形式为 $u(x\\sigma) / \\varepsilon = 4(x^{-12} - x^{-6})$。代入后可得：\n$$\nB_2^\\star(T^\\star) = -2\\pi \\int_0^\\infty \\left( \\exp\\left[-\\frac{4}{T^\\star}(x^{-12} - x^{-6})\\right] - 1 \\right) x^2 dx\n$$\n这个无量纲的积分表达式只依赖于约化温度 $T^\\star$。\n\n**算法选择与收敛性评估：**\n- **数值积分**：我们使用 `scipy.integrate.quad` 函数，这是一种自适应正交积分方法。它能够高效地处理被积函数在某些区域（例如LJ势的排斥核部分）的剧烈变化，通过在需要处增加采样点来保证积分的精度。\n- **收敛性评估**：积分的上限是无穷大，在数值计算中必须用一个有限的截断值 $x_{\\max}$ 代替。我们需要评估这个截断引入的误差。在 $r \\to \\infty$（即 $x \\to \\infty$）时，Lennard-Jones势 $u(r) \\to 0$。我们可以对 Mayer 函数做泰勒展开：$f(r) = e^{-\\beta u(r)} - 1 \\approx -\\beta u(r)$。对于LJ势，在远距离处 $u(r) \\approx -4\\varepsilon(\\sigma/r)^6$。因此，被积函数的尾部行为是 $x^2 \\cdot f(x) \\propto x^2 \\cdot (-\\frac{1}{T^\\star}) \\cdot (-4x^{-6}) \\propto x^{-4}$。截断误差正比于从 $x_{\\max}$ 到 $\\infty$ 的积分，即 $\\int_{x_{\\max}}^\\infty x^{-4} dx \\propto x_{\\max}^{-3}$。这意味着随着截断值 $x_{\\max}$ 的增加，计算结果会以 $x_{\\max}^{-3}$ 的速率收敛到真实值。通过比较 $x_{\\max} = 6, 8, 10$ 时的结果差异，我们可以验证这种收敛行为，并确认当 $x_{\\max}$ 足够大时，截断误差可以忽略不计。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef b2_star_truncated(T_star: float, x_max: float) - float:\n    \"\"\"\n    Compute the truncated dimensionless second virial coefficient B2* for the\n    Lennard–Jones potential at reduced temperature T_star and upper limit x_max.\n\n    B2* = -2*pi * integral_0^{x_max} [exp(-4/T* * (x^-12 - x^-6)) - 1] * x^2 dx\n    \"\"\"\n    inv_T = 1.0 / T_star\n\n    def integrand(x):\n        # Guard against x=0 and extremely small x to avoid overflow in x**-12\n        if x  1e-8:\n            # Mayer f - -1 for x-0 (repulsive core), so g(x) ~ -x^2\n            return -x * x\n        invx = 1.0 / x\n        invx2 = invx * invx\n        invx6 = invx2 * invx2 * invx2\n        invx12 = invx6 * invx6\n        expo = -4.0 * inv_T * (invx12 - invx6)\n        # For large negative expo, exp(expo) - 0 safely; for small |expo|, it's fine.\n        f = np.exp(expo) - 1.0\n        return f * (x * x)\n\n    # Adaptive quadrature over [0, x_max]\n    # Use tight tolerances; increase limit (max subintervals) to handle sharp features\n    val, err = quad(integrand, 0.0, x_max, epsabs=1e-11, epsrel=1e-11, limit=500)\n    return -2.0 * np.pi * val\n\ndef compute_results():\n    # Test suite: reduced temperatures and cutoffs\n    T_stars = [0.5, 1.0, 2.0, 5.0]\n    x_max_list = [6.0, 8.0, 10.0]\n\n    results = []\n    for T in T_stars:\n        vals = []\n        for x_max in x_max_list:\n            b2 = b2_star_truncated(T, x_max)\n            # Round to reduce representation noise while keeping high precision\n            vals.append(float(f\"{b2:.12f}\"))\n        # Prepare the triplet [B2*(10), |B2*(10)-B2*(8)|, |B2*(8)-B2*(6)|]\n        b2_6, b2_8, b2_10 = vals[0], vals[1], vals[2]\n        d10_8 = abs(b2_10 - b2_8)\n        d8_6 = abs(b2_8 - b2_6)\n        results.append([float(f\"{b2_10:.12f}\"),\n                        float(f\"{d10_8:.12f}\"),\n                        float(f\"{d8_6:.12f}\")])\n    return results\n\ndef serialize_no_spaces(obj):\n    \"\"\"\n    Serialize Python lists of floats/ints/bools into a bracketed comma-separated\n    string with no spaces, suitable for the required single-line output.\n    \"\"\"\n    if isinstance(obj, list):\n        return \"[\" + \",\".join(serialize_no_spaces(x) for x in obj) + \"]\"\n    if isinstance(obj, bool):\n        return \"True\" if obj else \"False\"\n    if isinstance(obj, float):\n        # Use a compact representation while preserving the given decimal places\n        # Keep trailing zeros if present by formatting to 12 decimals.\n        return f\"{obj:.12f}\".rstrip('0').rstrip('.') if '.' in f\"{obj:.12f}\" else f\"{obj:.12f}\"\n    return str(obj)\n\ndef solve():\n    results = compute_results()\n    print(serialize_no_spaces(results))\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}