{
    "hands_on_practices": [
        {
            "introduction": "Understanding macroscopic properties like entropy from microscopic principles is a cornerstone of statistical mechanics. This fundamental exercise  guides you through the process of counting microstates for a classical ideal gas to derive the famous Sackur-Tetrode equation. By correctly accounting for the indistinguishability of particles, you will see how this framework resolves the historical Gibbs paradox, demonstrating the profound link between particle identity and thermodynamic extensivity.",
            "id": "3853579",
            "problem": "In multiscale materials simulation, coarse-grained thermodynamic quantities must be consistent with their atomistic statistical-mechanical definitions. Consider a $3$-dimensional classical monatomic ideal gas of $N$ identical atoms of mass $m$, confined in a fixed volume $V$ with total energy $E$. Assume the thermodynamic limit where $N$ is large and the particle density remains finite.\n\nStarting from the microcanonical ensemble definition that the entropy $S$ is given by $S = k_B \\ln \\Omega$, where $\\Omega$ is the phase-space measure of accessible microstates at fixed $E$, count the microstates by:\n- correcting for indistinguishability with a factor $1/N!$,\n- coarse-graining phase space with a cell volume $h^{3N}$, where $h$ is the Planck constant,\n- evaluating the phase-space integral over positions and momenta consistent with the fixed energy $E$.\n\nUse only fundamental definitions and well-tested mathematical facts, including the volume and surface measure of a hypersphere in $D$ dimensions and Stirling’s approximation valid for large arguments. Derive an explicit closed-form analytic expression for the entropy $S$ in terms of $k_B$, $N$, $V$, $E$, $m$, and $h$ up to terms subextensive in $N$.\n\nThen, consider removing a partition between two subsystems, each initially containing the same classical monatomic ideal gas at the same temperature and pressure, with $\\left(N_1, V_1, E_1\\right)$ and $\\left(N_2, V_2, E_2\\right)$, where $N_1 = N_2 = N/2$, $V_1 = V_2 = V/2$, and $E_1 = E_2 = E/2$. The partition is removed while keeping the total energy $E$ and total volume $V$ fixed. Using your derived entropy, determine whether the entropy change due solely to mixing identical gases is nonzero or zero in the thermodynamic limit, and explain how the indistinguishability correction resolves the Gibbs paradox. Do not assume any target formula beyond the definitions specified above.\n\nProvide, as your final answer, the closed-form analytic expression you derive for $S$ in terms of $k_B$, $N$, $V$, $E$, $m$, and $h$. Do not provide a numerical evaluation. The final answer must be a single analytical expression.",
            "solution": "The problem is found to be valid as it is scientifically grounded, well-posed, and objective, representing a standard derivation and application in statistical mechanics.\n\nThe problem asks for the derivation of the entropy $S$ for a classical monatomic ideal gas in the microcanonical ensemble and its application to the Gibbs paradox. The system consists of $N$ identical atoms of mass $m$ in a volume $V$ with a total energy $E$. The entropy is defined as $S = k_B \\ln \\Omega$, where $\\Omega$ is the number of accessible microstates.\n\nA microstate is defined by the positions $\\mathbf{q}_i$ and momenta $\\mathbf{p}_i$ of all $N$ particles. The set of all possible states forms a $6N$-dimensional phase space. The number of microstates $\\Omega$ is found by calculating the volume of the accessible region of phase space and dividing by the volume of a single microstate, which is taken to be $h^{3N}$ due to coarse-graining. For identical particles, we must also divide by $N!$ to correct for the overcounting of states that are physically indistinguishable.\nThe number of microstates with energy up to $E$ is given by the phase-space volume $\\Phi(E, V, N)$:\n$$\n\\Phi(E, V, N) = \\frac{1}{N! h^{3N}} \\int d^{3N}q \\int d^{3N}p\n$$\nThe integration is over all positions within volume $V$ and all momenta such that the total energy is less than or equal to $E$. For a monatomic ideal gas, the energy is purely kinetic:\n$$\nH(\\mathbf{q}, \\mathbf{p}) = \\sum_{i=1}^{N} \\frac{|\\mathbf{p}_i|^2}{2m} = E_k \\le E\n$$\nThe position integral is over the volume $V$ for each of the $N$ particles, which yields $V^N$:\n$$\n\\int d^{3N}q = \\left( \\int_V d^3q \\right)^N = V^N\n$$\nThe momentum integral is over the volume of a $3N$-dimensional hypersphere defined by the energy constraint. Let's rewrite the constraint by combining all momentum components into a single $3N$-dimensional vector:\n$$\n\\sum_{j=1}^{3N} p_j^2 \\le 2mE\n$$\nThis defines a hypersphere of radius $R_p = \\sqrt{2mE}$ in a $3N$-dimensional momentum space. The volume of a $D$-dimensional ball of radius $R$ is given by the formula:\n$$\n\\mathcal{V}_D(R) = \\frac{\\pi^{D/2}}{\\Gamma(\\frac{D}{2} + 1)} R^D\n$$\nIn our case, the dimension is $D = 3N$ and the radius is $R_p = \\sqrt{2mE}$. The momentum-space volume is:\n$$\n\\int d^{3N}p = \\mathcal{V}_{3N}(\\sqrt{2mE}) = \\frac{\\pi^{3N/2}}{\\Gamma(\\frac{3N}{2} + 1)} (2mE)^{3N/2}\n$$\nCombining all parts, the total phase-space volume is:\n$$\n\\Phi(E, V, N) = \\frac{V^N}{N! h^{3N}} \\frac{\\pi^{3N/2}}{\\Gamma(\\frac{3N}{2} + 1)} (2mE)^{3N/2}\n$$\nThe problem defines $\\Omega$ as the measure of states at fixed energy $E$, which corresponds to the surface of the hypersphere. However, in the thermodynamic limit ($N \\rightarrow \\infty$), the logarithm of the shell volume, $\\ln(\\omega(E)\\delta E)$, is equivalent to the logarithm of the total ball volume, $\\ln(\\Phi(E))$, up to sub-extensive terms. This is because $\\Phi(E) \\propto E^{3N/2}$, so $\\omega(E) = \\frac{d\\Phi}{dE} = \\frac{3N}{2E}\\Phi(E)$. Taking the logarithm, $\\ln(\\omega(E)) = \\ln(\\Phi(E)) + \\ln(\\frac{3N}{2E})$, where the second term is sub-extensive. Therefore, we can approximate $S = k_B \\ln \\Phi(E, V, N)$.\n\nWe now take the logarithm of $\\Phi$:\n$$\n\\ln \\Phi = N \\ln V - \\ln(N!) - 3N \\ln h + \\frac{3N}{2} \\ln(\\pi) + \\frac{3N}{2} \\ln(2mE) - \\ln\\left(\\Gamma\\left(\\frac{3N}{2} + 1\\right)\\right)\n$$\nFor large $N$, we use Stirling's approximation for the factorial and the Gamma function: $\\ln(x!) \\approx x \\ln x - x$ and $\\ln \\Gamma(z+1) \\approx z \\ln z - z$.\n$$\n\\ln(N!) \\approx N \\ln N - N\n$$\n$$\n\\ln\\left(\\Gamma\\left(\\frac{3N}{2} + 1\\right)\\right) \\approx \\frac{3N}{2} \\ln\\left(\\frac{3N}{2}\\right) - \\frac{3N}{2}\n$$\nSubstituting these approximations into the expression for $\\ln \\Phi$:\n$$\n\\ln \\Phi \\approx N \\ln V - (N \\ln N - N) - 3N \\ln h + \\frac{3N}{2} \\ln(2\\pi mE) - \\left(\\frac{3N}{2} \\ln\\left(\\frac{3N}{2}\\right) - \\frac{3N}{2}\\right)\n$$\nLet's collect and simplify the terms:\n$$\n\\ln \\Phi \\approx N \\ln V - N \\ln N + N - 3N \\ln h + \\frac{3N}{2} \\ln(2\\pi mE) - \\frac{3N}{2} (\\ln(3N) - \\ln(2)) + \\frac{3N}{2}\n$$\n$$\n\\ln \\Phi \\approx N \\ln V - N \\ln N + \\frac{5N}{2} - 3N \\ln h + \\frac{3N}{2} \\ln(2\\pi mE) - \\frac{3N}{2} \\ln(3N) + \\frac{3N}{2} \\ln(2)\n$$\nWe can group the logarithmic terms:\n$$\n\\ln \\Phi \\approx N\\left(\\ln V - \\ln N\\right) + \\frac{3N}{2}\\left(\\ln(2\\pi mE) - \\ln(3N) + \\ln 2\\right) - 3N \\ln h + \\frac{5N}{2}\n$$\n$$\n\\ln \\Phi \\approx N\\ln\\left(\\frac{V}{N}\\right) + \\frac{3N}{2}\\ln\\left(\\frac{2\\pi mE \\cdot 2}{3N}\\right) - \\frac{3N}{2}\\ln(h^2) + \\frac{5N}{2}\n$$\n$$\n\\ln \\Phi \\approx N\\ln\\left(\\frac{V}{N}\\right) + \\frac{3N}{2}\\ln\\left(\\frac{4\\pi mE}{3N h^2}\\right) + \\frac{5N}{2}\n$$\nThe entropy $S = k_B \\ln \\Phi$ is therefore:\n$$\nS(N,V,E) = N k_B \\left[ \\ln\\left(\\frac{V}{N}\\right) + \\frac{3}{2} \\ln\\left(\\frac{4\\pi mE}{3N h^2}\\right) + \\frac{5}{2} \\right]\n$$\nThis is the Sackur-Tetrode equation. It is an extensive quantity: if we scale the system by a factor $\\lambda$ (i.e., $N \\to \\lambda N$, $V \\to \\lambda V$, $E \\to \\lambda E$), the intensive ratios $V/N$ and $E/N$ remain unchanged, and the overall expression scales with $N$, so $S \\to \\lambda S$.\n\nNow, we analyze the Gibbs paradox. Consider two identical systems, each with $(N/2, V/2, E/2)$, in thermal and mechanical equilibrium. The total initial entropy is $S_{initial} = S_1 + S_2$.\n$$\nS_1 = S\\left(\\frac{N}{2}, \\frac{V}{2}, \\frac{E}{2}\\right) = \\frac{N}{2} k_B \\left[ \\ln\\left(\\frac{V/2}{N/2}\\right) + \\frac{3}{2} \\ln\\left(\\frac{4\\pi m(E/2)}{3(N/2)h^2}\\right) + \\frac{5}{2} \\right]\n$$\n$$\nS_1 = \\frac{N}{2} k_B \\left[ \\ln\\left(\\frac{V}{N}\\right) + \\frac{3}{2} \\ln\\left(\\frac{4\\pi mE}{3Nh^2}\\right) + \\frac{5}{2} \\right]\n$$\nSince the subsystems are identical, $S_1 = S_2$. The total initial entropy is:\n$$\nS_{initial} = 2 \\times S_1 = N k_B \\left[ \\ln\\left(\\frac{V}{N}\\right) + \\frac{3}{2} \\ln\\left(\\frac{4\\pi mE}{3Nh^2}\\right) + \\frac{5}{2} \\right]\n$$\nAfter removing the partition, we have a single system with $(N, V, E)$. The final entropy is:\n$$\nS_{final} = S(N, V, E) = N k_B \\left[ \\ln\\left(\\frac{V}{N}\\right) + \\frac{3}{2} \\ln\\left(\\frac{4\\pi mE}{3Nh^2}\\right) + \\frac{5}{2} \\right]\n$$\nThe change in entropy is $\\Delta S = S_{final} - S_{initial} = 0$. This result is physically correct: the reversible mixing of two identical bodies of gas at the same temperature and pressure should not produce an entropy change.\n\nThe Gibbs paradox arises if the particle indistinguishability factor $1/N!$ is omitted. Without this factor, the entropy $S'$ would contain a term $-k_B \\ln(N!) \\approx -k_B(N \\ln N - N)$ less than what we calculated. In other words, the correct entropy is $S = S' - k_B \\ln(N!)$, where $S'$ is the entropy for distinguishable particles. The crucial term in $S'$ would be $N \\ln V$ instead of $N \\ln(V/N)$, making $S'$ a non-extensive quantity. Applying this non-extensive entropy to the mixing problem yields a spurious entropy of mixing, $\\Delta S' = N k_B \\ln 2$. This paradoxical increase in entropy for mixing identical gases is resolved by correctly accounting for particle indistinguishability with the $1/N!$ factor. This correction ensures that the entropy is an extensive property of the system, leading to $\\Delta S = 0$ as required for a reversible process involving identical substances.\n\nThe final requested answer is the derived closed-form analytic expression for the entropy $S$.",
            "answer": "$$\n\\boxed{N k_B \\left[ \\ln\\left(\\frac{V}{N}\\right) + \\frac{3}{2} \\ln\\left(\\frac{4 \\pi m E}{3 N h^2}\\right) + \\frac{5}{2} \\right]}\n$$"
        },
        {
            "introduction": "Real materials are defined by the interactions between their constituent particles, a feature absent in the ideal gas model. This practice introduces the cluster expansion, a systematic method for incorporating these effects into the thermodynamic description of a fluid. By deriving the second virial coefficient $B_2(T)$ for the simple but instructive hard-sphere model , you will gain a first-principles understanding of how repulsive forces lead to deviations from ideal gas behavior.",
            "id": "3853584",
            "problem": "A classical monatomic fluid of $N$ identical hard spheres of diameter $\\sigma$ is confined to a volume $V$ and maintained at temperature $T$ under the canonical ensemble (CE). The pairwise additive interaction potential $u(r)$ between two spheres is defined by $u(r) = +\\infty$ for $0 \\leq r < \\sigma$ and $u(r) = 0$ for $r \\geq \\sigma$. Let $k_B$ denote the Boltzmann constant. Define $\\beta = 1/(k_B T)$ and the Mayer $f$-function $f(\\mathbf{r}) = \\exp\\!\\big(-\\beta u(|\\mathbf{r}|)\\big) - 1$. Starting from the canonical partition function and using only fundamental definitions and the low-density cluster expansion consistent with the configuration integral, derive the expression for the second virial coefficient $B_2(T)$ for this hard-sphere fluid, and briefly explain how this coefficient modifies the pressure relative to the ideal gas at the same number density $\\rho = N/V$ and temperature $T$ when truncating the equation of state at order $\\rho^2$. \n\nExpress your final answer as a closed-form analytic expression for $B_2(T)$ in terms of $\\sigma$. If units are to be assigned, use cubic meters, but do not include units in your boxed final answer. No numerical evaluation or rounding is required.",
            "solution": "The problem is subjected to validation and is confirmed to be valid. It is scientifically grounded, well-posed, and all necessary information for a unique solution is provided. The problem asks for the derivation of the second virial coefficient, $B_2(T)$, for a classical hard-sphere fluid starting from the canonical partition function and utilizing the cluster expansion.\n\nThe canonical partition function, $Q(N, V, T)$, for a system of $N$ identical, classical, monatomic particles in a volume $V$ at temperature $T$ is given by:\n$$ Q(N, V, T) = \\frac{1}{N! h^{3N}} \\int \\exp(-\\beta H(\\mathbf{r}^N, \\mathbf{p}^N)) \\,d\\mathbf{r}^N d\\mathbf{p}^N $$\nwhere $h$ is Planck's constant, $\\beta = 1/(k_B T)$ with $k_B$ being the Boltzmann constant, and $H(\\mathbf{r}^N, \\mathbf{p}^N)$ is the classical Hamiltonian of the system. The Hamiltonian is the sum of the kinetic energy $K(\\mathbf{p}^N)$ and the potential energy $U(\\mathbf{r}^N)$: $H = K + U$. For monatomic particles, $K = \\sum_{i=1}^N \\frac{|\\mathbf{p}_i|^2}{2m}$. The potential energy for a pairwise additive system is $U = \\sum_{1 \\le i < j \\le N} u(r_{ij})$, where $r_{ij} = |\\mathbf{r}_i - \\mathbf{r}_j|$.\n\nThe partition function can be separated into kinetic and configurational parts:\n$$ Q(N, V, T) = \\frac{1}{N! h^{3N}} \\left( \\int \\exp(-\\beta K) \\,d\\mathbf{p}^N \\right) \\left( \\int \\exp(-\\beta U) \\,d\\mathbf{r}^N \\right) $$\nThe momentum integral evaluates to:\n$$ \\int \\exp\\left(-\\beta \\sum_{i=1}^N \\frac{|\\mathbf{p}_i|^2}{2m}\\right) \\,d\\mathbf{p}^N = \\left( \\int \\exp\\left(-\\frac{\\beta p^2}{2m}\\right) \\,d^3p \\right)^N = \\left( \\frac{2\\pi m}{\\beta} \\right)^{3N/2} $$\nDefining the thermal de Broglie wavelength $\\Lambda = h / \\sqrt{2\\pi m k_B T} = h \\sqrt{\\beta/(2\\pi m)}$, the partition function becomes:\n$$ Q(N, V, T) = \\frac{1}{N! \\Lambda^{3N}} Z_N $$\nwhere $Z_N$ is the configuration integral:\n$$ Z_N = \\int_V \\dots \\int_V \\exp\\left(-\\beta \\sum_{1 \\le i < j \\le N} u(r_{ij})\\right) \\,d\\mathbf{r}_1 \\dots d\\mathbf{r}_N $$\nTo handle the sum in the exponent, we introduce the Mayer $f$-function, defined in the problem as $f_{ij} = f(|\\mathbf{r}_i - \\mathbf{r}_j|) = \\exp(-\\beta u(r_{ij})) - 1$. This allows us to write $\\exp(-\\beta u(r_{ij})) = 1 + f_{ij}$. The exponential of the total potential energy is then:\n$$ \\exp(-\\beta U) = \\prod_{1 \\le i < j \\le N} (1 + f_{ij}) $$\nFor a low-density system, we can expand this product and keep only the lowest order terms in the particle density. The expansion is:\n$$ \\prod_{1 \\le i < j \\le N} (1 + f_{ij}) = 1 + \\sum_{1 \\le i < j \\le N} f_{ij} + \\sum_{\\text{distinct pairs } (i,j), (k,l)} f_{ij}f_{kl} + \\dots $$\nSubstituting this into the configuration integral gives the cluster expansion of $Z_N$:\n$$ Z_N = \\int_V \\dots \\int_V \\left(1 + \\sum_{1 \\le i < j \\le N} f_{ij} + \\dots\\right) \\,d\\mathbf{r}_1 \\dots d\\mathbf{r}_N $$\nThe first term gives $\\int d\\mathbf{r}^N = V^N$, which corresponds to an ideal gas. The second term involves one pair interaction:\n$$ \\int_V \\dots \\int_V \\sum_{1 \\le i < j \\le N} f_{ij} \\,d\\mathbf{r}^N $$\nThere are $\\binom{N}{2} = \\frac{N(N-1)}{2}$ identical terms in this sum. Considering one such term, e.g., $f_{12}$:\n$$ \\int f_{12} \\,d\\mathbf{r}_1 \\dots d\\mathbf{r}_N = \\left(\\int d\\mathbf{r}_3 \\dots d\\mathbf{r}_N\\right) \\left(\\int_V \\int_V f_{12} \\,d\\mathbf{r}_1 d\\mathbf{r}_2\\right) = V^{N-2} \\int_V \\int_V f(|\\mathbf{r}_1 - \\mathbf{r}_2|) \\,d\\mathbf{r}_1 d\\mathbf{r}_2 $$\nBy changing variables to the center of mass and relative coordinate, and assuming the interaction range is much smaller than the system size, the integral over the relative coordinate becomes independent of the center of mass, yielding a factor of $V$: $\\int_V \\int_V f_{12} \\,d\\mathbf{r}_1 d\\mathbf{r}_2 \\approx V \\int_V f(|\\mathbf{r}|) \\,d\\mathbf{r}$.\nSo, to first order in the density, the configuration integral is:\n$$ Z_N \\approx V^N + \\binom{N}{2} V^{N-1} \\int f(\\mathbf{r}) \\,d\\mathbf{r} $$\nFor large $N$, $\\binom{N}{2} \\approx N^2/2$. Thus:\n$$ Z_N \\approx V^N \\left( 1 + \\frac{N^2}{2V} \\int f(\\mathbf{r}) \\,d\\mathbf{r} \\right) $$\nThe pressure $P$ is found from the Helmholtz free energy $A = -k_B T \\ln Q$:\n$$ A = -k_B T \\ln\\left( \\frac{Z_N}{N!\\Lambda^{3N}} \\right) = -k_B T (\\ln Z_N - \\ln(N!) - 3N\\ln\\Lambda) $$\nUsing $\\ln(1+x) \\approx x$ for small $x$:\n$$ \\ln Z_N \\approx \\ln\\left(V^N\\right) + \\ln\\left(1 + \\frac{N^2}{2V} \\int f(\\mathbf{r}) \\,d\\mathbf{r}\\right) \\approx N\\ln V + \\frac{N^2}{2V} \\int f(\\mathbf{r}) \\,d\\mathbf{r} $$\nThe pressure is $P = -(\\partial A / \\partial V)_{N,T}$:\n$$ P = k_B T \\left( \\frac{\\partial \\ln Z_N}{\\partial V} \\right)_{N,T} \\approx k_B T \\frac{\\partial}{\\partial V} \\left( N\\ln V + \\frac{N^2}{2V} \\int f(\\mathbf{r}) \\,d\\mathbf{r} \\right) $$\n$$ P \\approx k_B T \\left( \\frac{N}{V} - \\frac{N^2}{2V^2} \\int f(\\mathbf{r}) \\,d\\mathbf{r} \\right) $$\nDividing by $k_B T$ and using the number density $\\rho = N/V$:\n$$ \\frac{P}{k_B T} \\approx \\rho - \\frac{\\rho^2}{2} \\int f(\\mathbf{r}) \\,d\\mathbf{r} $$\nThe virial equation of state is $P/(k_B T) = \\rho + B_2(T)\\rho^2 + B_3(T)\\rho^3 + \\dots$. By comparing our derived pressure expression with the virial expansion truncated at order $\\rho^2$, we identify the second virial coefficient:\n$$ B_2(T) = -\\frac{1}{2} \\int f(\\mathbf{r}) \\,d\\mathbf{r} $$\nNow, we must evaluate this integral for the hard-sphere potential:\n$$ u(r) = \\begin{cases} +\\infty & \\text{if } 0 \\leq r < \\sigma \\\\ 0 & \\text{if } r \\geq \\sigma \\end{cases} $$\nThe corresponding Mayer $f$-function is:\n$$ f(r) = \\exp(-\\beta u(r)) - 1 = \\begin{cases} \\exp(-\\infty) - 1 = -1 & \\text{if } 0 \\leq r < \\sigma \\\\ \\exp(0) - 1 = 0 & \\text{if } r \\geq \\sigma \\end{cases} $$\nThe integral for $B_2(T)$ is performed in spherical coordinates, where $d\\mathbf{r} = 4\\pi r^2 dr$:\n$$ B_2(T) = -\\frac{1}{2} \\int_0^\\infty 4\\pi r^2 f(r) \\,dr $$\nSubstituting the piecewise expression for $f(r)$:\n$$ B_2(T) = -\\frac{1}{2} \\left[ \\int_0^\\sigma 4\\pi r^2 (-1) \\,dr + \\int_\\sigma^\\infty 4\\pi r^2 (0) \\,dr \\right] $$\nThe second integral is zero. The first integral becomes:\n$$ B_2(T) = -\\frac{1}{2} (-4\\pi) \\int_0^\\sigma r^2 \\,dr = 2\\pi \\left[ \\frac{r^3}{3} \\right]_0^\\sigma $$\n$$ B_2(T) = 2\\pi \\left( \\frac{\\sigma^3}{3} - 0 \\right) = \\frac{2}{3}\\pi\\sigma^3 $$\nNote that for the hard-sphere potential, $B_2$ is independent of temperature $T$.\n\nTo explain how this coefficient modifies the pressure, we use the truncated virial equation of state:\n$$ P = \\rho k_B T (1 + B_2(T) \\rho) $$\nThe ideal gas law is $P_{ideal} = \\rho k_B T$. The pressure of the hard-sphere fluid is therefore $P = P_{ideal}(1 + B_2 \\rho)$. Since $B_2 = \\frac{2}{3}\\pi\\sigma^3$ is a positive constant, the term $B_2 \\rho$ is positive. This means that the pressure of the hard-sphere fluid is greater than the pressure of an ideal gas at the same number density and temperature. The physical reason for this increase is the repulsive nature of the hard-sphere interaction. The finite size of the particles creates an \"excluded volume\" around each particle that is inaccessible to the centers of other particles. This reduces the effective volume available for the particles to move in, leading to a higher frequency of collisions with the container walls and thus a higher pressure compared to non-interacting point particles.",
            "answer": "$$ \\boxed{\\frac{2}{3}\\pi\\sigma^3} $$"
        },
        {
            "introduction": "Connecting theoretical statistical mechanics to practical simulation requires translating analytical expressions into computational algorithms. In this exercise , you will apply the virial expansion framework to the Lennard-Jones potential, a workhorse model for molecular simulation that captures both attraction and repulsion. This problem develops your skills in numerically calculating the second virial coefficient $B_2(T)$ and assessing convergence, an essential task in computational materials science.",
            "id": "3853604",
            "problem": "You are given a classical, three-dimensional equilibrium system of indistinguishable particles at temperature $T$ in the canonical ensemble. Particles interact via a pairwise additive Lennard–Jones (LJ) potential. Your task is to start from the canonical configurational partition function and the definition of the Mayer $f$-function used in the cluster expansion and, without assuming any pre-derived virial expressions, derive a one-dimensional radial integral expression for the second virial coefficient $B_2(T)$ for an isotropic pair potential. Then, using this expression, implement a numerical scheme to approximate $B_2(T)$ for the Lennard–Jones potential by estimating the integral of the corresponding Mayer function $f(r)$ with an upper radial cutoff and assess convergence across temperatures.\n\nFundamental base to use:\n- Canonical ensemble definitions: the classical canonical configurational integral, indistinguishability factor, and Boltzmann weight $\\exp(-\\beta U)$ with $\\beta = 1/(k_{\\mathrm{B}} T)$, where $k_{\\mathrm{B}}$ is the Boltzmann constant.\n- Cluster expansion (Mayer expansion) at the level needed to identify how the second virial coefficient emerges from the two-particle contribution in terms of the Mayer $f$-function, with $f_{ij} = \\exp(-\\beta u(r_{ij})) - 1$ for a pairwise potential $u(r)$.\n- Geometric reduction from a $3$-dimensional spatial integral to a one-dimensional radial integral under isotropy.\n\nSystem specifics:\n- The pair potential is the Lennard–Jones (LJ) potential $u(r) = 4 \\varepsilon \\left[ \\left( \\dfrac{\\sigma}{r} \\right)^{12} - \\left( \\dfrac{\\sigma}{r} \\right)^{6} \\right]$, where $\\varepsilon$ and $\\sigma$ are the LJ energy and length scales, respectively.\n- Introduce reduced variables $T^\\star = \\dfrac{k_{\\mathrm{B}} T}{\\varepsilon}$ and $x = \\dfrac{r}{\\sigma}$, and express the dimensionless second virial coefficient $B_2^\\star(T^\\star) = \\dfrac{B_2(T)}{\\sigma^3}$ entirely in terms of $T^\\star$ and $x$.\n\nNumerical approximation requirement:\n- Replace the infinite upper limit in the radial integral by a finite cutoff $x_{\\max}$ and compute the truncated integral numerically to approximate $B_2^\\star(T^\\star)$.\n- Explain how the asymptotic behavior of the Mayer $f$-function for the Lennard–Jones tail informs the convergence with respect to $x_{\\max}$, and use that to justify your convergence assessment.\n\nTest suite:\n- Use reduced temperatures $T^\\star \\in \\{0.5, 1.0, 2.0, 5.0\\}$.\n- For each $T^\\star$, compute the truncated $B_2^\\star(T^\\star)$ at three upper cutoffs $x_{\\max} \\in \\{6, 8, 10\\}$.\n- For each $T^\\star$, report three numbers:\n  1. The value $B_2^\\star(T^\\star)$ computed with $x_{\\max} = 10$.\n  2. The absolute difference $\\Delta_{10,8} = \\left| B_2^\\star(T^\\star; x_{\\max}=10) - B_2^\\star(T^\\star; x_{\\max}=8) \\right|$.\n  3. The absolute difference $\\Delta_{8,6} = \\left| B_2^\\star(T^\\star; x_{\\max}=8) - B_2^\\star(T^\\star; x_{\\max}=6) \\right|$.\n\nUnits and numerical specifications:\n- Report $B_2^\\star$ as a dimensionless number (equivalently, $B_2$ in units of $\\sigma^3$).\n- No physical units are required in the output.\n- Angles are not involved.\n- Percentages must not be used; all ratios, if any, must be given as decimals.\n\nFinal program output format:\n- Your program must produce a single line containing a comma-separated list of the four per-temperature triplets, enclosed in square brackets. For example: $[[a_1,b_1,c_1],[a_2,b_2,c_2],[a_3,b_3,c_3],[a_4,b_4,c_4]]$, where each $a_i$, $b_i$, and $c_i$ is a floating-point number corresponding to $T^\\star \\in \\{0.5, 1.0, 2.0, 5.0\\}$ in that order.\n\nWhat you must deliver:\n- Derive, from first principles as specified, the integral expression you will implement.\n- Explain the algorithmic choices for numerical integration and convergence assessment.\n- Implement the computation and produce the final output in the exact format specified above. The final output must be the only line printed by your program.",
            "solution": "We begin with a classical system of $N$ indistinguishable particles at temperature $T$ in the canonical ensemble. The canonical configurational partition function is\n$$\nZ_{N}^{\\mathrm{conf}}(\\beta, V) = \\frac{1}{N!} \\int \\cdots \\int \\mathrm{d}\\mathbf{r}_1 \\cdots \\mathrm{d}\\mathbf{r}_N \\, \\exp\\left( -\\beta U(\\mathbf{r}^N) \\right),\n$$\nwhere $\\beta = 1/(k_{\\mathrm{B}} T)$, $V$ is the volume, and $U(\\mathbf{r}^N)$ is the total potential energy. For a pairwise additive potential,\n$$\nU(\\mathbf{r}^N) = \\sum_{1 \\le i < j \\le N} u(r_{ij}), \\quad r_{ij} = \\lVert \\mathbf{r}_i - \\mathbf{r}_j \\rVert.\n$$\nThe cluster (Mayer) expansion expresses the product of Boltzmann factors as\n$$\n\\exp\\left( -\\beta \\sum_{i<j} u(r_{ij}) \\right) = \\prod_{i<j} \\left[ 1 + f_{ij} \\right], \\quad f_{ij} = \\exp\\left( -\\beta u(r_{ij}) \\right) - 1,\n$$\nwhere $f_{ij}$ is the Mayer $f$-function. The virial expansion of the equation of state relates the compressibility factor to number density $\\rho = N/V$ via\n$$\nZ \\equiv \\frac{\\beta p}{\\rho} = 1 + B_2(T) \\rho + B_3(T) \\rho^2 + \\cdots,\n$$\nand $B_2(T)$ can be identified from the $\\mathcal{O}(\\rho^2)$ contribution arising from the two-particle cluster integral. A standard result of the cluster expansion at second order, derived by integrating out center-of-mass and considering indistinguishability, is\n$$\nB_2(T) = -\\frac{1}{2} \\int f(\\mathbf{r}) \\, \\mathrm{d}\\mathbf{r},\n$$\nwhere $f(\\mathbf{r}) = \\exp\\left( -\\beta u(r) \\right) - 1$ and $u(r)$ depends only on $r = \\lVert \\mathbf{r} \\rVert$, assuming an isotropic pair potential and homogeneity. Exploiting spherical symmetry, $\\mathrm{d}\\mathbf{r} = 4 \\pi r^2 \\mathrm{d}r$, we obtain the one-dimensional radial integral\n$$\nB_2(T) = -2 \\pi \\int_{0}^{\\infty} \\left[ \\exp\\left( -\\beta u(r) \\right) - 1 \\right] r^2 \\, \\mathrm{d}r.\n$$\n\nFor the Lennard–Jones (LJ) potential,\n$$\nu(r) = 4 \\varepsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^{6} \\right].\n$$\nIntroduce reduced variables $x = r/\\sigma$ and $T^\\star = k_{\\mathrm{B}} T / \\varepsilon$. Then $\\beta u(r) = \\frac{1}{T^\\star} \\cdot 4 \\left( x^{-12} - x^{-6} \\right)$, and the dimensionless second virial coefficient $B_2^\\star(T^\\star) = B_2(T)/\\sigma^3$ becomes\n$$\nB_2^\\star(T^\\star) = -2\\pi \\int_{0}^{\\infty} \\left[ \\exp\\left( -\\frac{4}{T^\\star}\\left( x^{-12} - x^{-6} \\right) \\right) - 1 \\right] x^2 \\, \\mathrm{d}x.\n$$\n\nConvergence considerations:\n- As $x \\to 0$, the repulsive term dominates, $u(r) \\to +\\infty$, so $\\exp(-\\beta u) \\to 0$, and $f(r) \\to -1$. The integrand behaves as $-x^2$, which is integrable at the origin.\n- As $x \\to \\infty$, $u(r) \\sim -4 \\varepsilon x^{-6}$, hence $f(r) = \\exp\\left( \\frac{4}{T^\\star} x^{-6} \\right) - 1 \\approx \\frac{4}{T^\\star} x^{-6}$ for large $x$. The integrand behaves as $\\sim \\frac{4}{T^\\star} x^{-4}$, so the tail integral from $x_{\\max}$ to $\\infty$ decays as $\\sim \\mathcal{O}(x_{\\max}^{-3})$. Therefore, increasing $x_{\\max}$ reduces the truncation error rapidly, with stronger tails at smaller $T^\\star$.\n\nNumerical algorithm:\n- Define the integrand\n$$\ng(x; T^\\star) = \\left[ \\exp\\left( -\\frac{4}{T^\\star}\\left( x^{-12} - x^{-6} \\right) \\right) - 1 \\right] x^2,\n$$\nand compute the truncated integral\n$$\nI(T^\\star; x_{\\max}) = \\int_{0}^{x_{\\max}} g(x; T^\\star) \\, \\mathrm{d}x.\n$$\n- Approximate $B_2^\\star(T^\\star; x_{\\max}) = -2\\pi \\, I(T^\\star; x_{\\max})$.\n- Use an adaptive quadrature scheme with tight absolute and relative tolerances to handle the rapidly varying region near $x \\approx 1$ and the gentle tail. Near $x = 0$, use the limiting behavior $g(x) \\approx -x^2$ to avoid floating-point overflow; equivalently, guard the evaluation for very small $x$.\n- Assess convergence by computing the absolute differences $\\Delta_{10,8} = \\left| B_2^\\star(T^\\star; 10) - B_2^\\star(T^\\star; 8) \\right|$ and $\\Delta_{8,6} = \\left| B_2^\\star(T^\\star; 8) - B_2^\\star(T^\\star; 6) \\right|$ for each $T^\\star$.\n\nTest suite and output:\n- Compute for $T^\\star \\in \\{0.5, 1.0, 2.0, 5.0\\}$ and $x_{\\max} \\in \\{6, 8, 10\\}$.\n- For each $T^\\star$, output the triplet $[B_2^\\star(T^\\star; 10), \\Delta_{10,8}, \\Delta_{8,6}]$.\n- Print a single line of the form $[[a_1,b_1,c_1],[a_2,b_2,c_2],[a_3,b_3,c_3],[a_4,b_4,c_4]]$ corresponding to the temperatures in the order $[0.5,1.0,2.0,5.0]$.\n- All reported values are dimensionless.\n\nThis approach connects the canonical ensemble and the cluster expansion to a computable radial integral for the second virial coefficient. The Lennard–Jones long-range behavior implies that the truncation error scales as $\\mathcal{O}(x_{\\max}^{-3})$, so differences between $x_{\\max} = 8$ and $x_{\\max} = 10$ should be smaller than those between $x_{\\max} = 6$ and $x_{\\max} = 8$, especially at larger $T^\\star$ where the attractive tail is weaker.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef b2_star_truncated(T_star: float, x_max: float) -> float:\n    \"\"\"\n    Compute the truncated dimensionless second virial coefficient B2* for the\n    Lennard–Jones potential at reduced temperature T_star and upper limit x_max.\n\n    B2* = -2*pi * integral_0^{x_max} [exp(-4/T* * (x^-12 - x^-6)) - 1] * x^2 dx\n    \"\"\"\n    inv_T = 1.0 / T_star\n\n    def integrand(x):\n        # Guard against x=0 and extremely small x to avoid overflow in x**-12\n        if x <= 1e-8:\n            # Mayer f -> -1 for x->0 (repulsive core), so g(x) ~ -x^2\n            return -x * x\n        invx = 1.0 / x\n        invx2 = invx * invx\n        invx6 = invx2 * invx2 * invx2\n        invx12 = invx6 * invx6\n        expo = -4.0 * inv_T * (invx12 - invx6)\n        # For large negative expo, exp(expo) -> 0 safely; for small |expo|, it's fine.\n        f = np.exp(expo) - 1.0\n        return f * (x * x)\n\n    # Adaptive quadrature over [0, x_max]\n    # Use tight tolerances; increase limit (max subintervals) to handle sharp features\n    val, err = quad(integrand, 0.0, x_max, epsabs=1e-11, epsrel=1e-11, limit=500)\n    return -2.0 * np.pi * val\n\ndef compute_results():\n    # Test suite: reduced temperatures and cutoffs\n    T_stars = [0.5, 1.0, 2.0, 5.0]\n    x_max_list = [6.0, 8.0, 10.0]\n\n    results = []\n    for T in T_stars:\n        vals = []\n        for x_max in x_max_list:\n            b2 = b2_star_truncated(T, x_max)\n            # Round to reduce representation noise while keeping high precision\n            vals.append(float(f\"{b2:.12f}\"))\n        # Prepare the triplet [B2*(10), |B2*(10)-B2*(8)|, |B2*(8)-B2*(6)|]\n        b2_6, b2_8, b2_10 = vals[0], vals[1], vals[2]\n        d10_8 = abs(b2_10 - b2_8)\n        d8_6 = abs(b2_8 - b2_6)\n        results.append([float(f\"{b2_10:.12f}\"),\n                        float(f\"{d10_8:.12f}\"),\n                        float(f\"{d8_6:.12f}\")])\n    return results\n\ndef serialize_no_spaces(obj):\n    \"\"\"\n    Serialize Python lists of floats/ints/bools into a bracketed comma-separated\n    string with no spaces, suitable for the required single-line output.\n    \"\"\"\n    if isinstance(obj, list):\n        return \"[\" + \",\".join(serialize_no_spaces(x) for x in obj) + \"]\"\n    if isinstance(obj, bool):\n        return \"True\" if obj else \"False\"\n    if isinstance(obj, float):\n        # Use a compact representation while preserving the given decimal places\n        # Keep trailing zeros if present by formatting to 12 decimals.\n        return f\"{obj:.12f}\".rstrip('0').rstrip('.') if '.' in f\"{obj:.12f}\" else f\"{obj:.12f}\"\n    return str(obj)\n\ndef solve():\n    results = compute_results()\n    print(serialize_no_spaces(results))\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}