{
    "hands_on_practices": [
        {
            "introduction": "经典配分函数是连接微观态与宏观热力学的基石。本练习将通过一个特定的非平凡势能模型，为您提供计算配分函数的基本实践。通过推导热容，您将巩固从配分函数中提取热力学可观测量的方法，并加深对能量均分定理的理解。",
            "id": "147569",
            "problem": "一个质量为 $m$ 的经典粒子被限制在二维平面内，并与恒定温度为 $T$ 的热库处于热平衡状态。该粒子的势能由函数 $U(x,y) = c(|x|+|y|)$ 给出，其中 $c$ 是一个单位为力的正常数。\n\n二维空间中单个粒子的经典正则配分函数 $Q_1$ 由下式给出：\n$$\nQ_1(T, A) = \\frac{1}{h^2} \\iint_{A} dx dy \\iint_{-\\infty}^{\\infty} dp_x dp_y e^{-\\beta H(x,y,p_x,p_y)}\n$$\n其中 $H$ 是系统的经典哈密顿量，$\\beta = (k_B T)^{-1}$，$k_B$ 是玻尔兹曼常数，$h$ 是普朗克常数，积分范围是可及面积 $A$ 和所有可能的动量。对于此势能，粒子被限制在原点附近，因此可以假设面积 $A$ 实际上是无限的，即 $x$ 和 $y$ 的积分限为 $-\\infty$ 到 $\\infty$。\n\n定容热容 $C_A$ 与平均能量 $\\langle E \\rangle$ 的关系为 $C_A = (\\partial \\langle E \\rangle / \\partial T)_A$，其中平均能量可以通过配分函数求得：$\\langle E \\rangle = -(\\partial \\ln Q_1 / \\partial \\beta)_A$。\n\n推导该粒子的定容热容 $C_A$ 的表达式。",
            "solution": "1. 正则配分函数可分解为动量部分和构型部分：\n$$\nQ_1=\\frac{1}{h^2}\\iint_{-\\infty}^{\\infty}dp_x\\,dp_y\\,e^{-\\beta\\frac{p_x^2+p_y^2}{2m}}\n\\iint_{-\\infty}^{\\infty}dx\\,dy\\,e^{-\\beta c(|x|+|y|)}\\,.\n$$\n\n2. 动量积分：\n$$\n\\iint dp_x\\,dp_y\\,e^{-\\beta\\frac{p_x^2+p_y^2}{2m}}\n=\\Bigl(\\int_{-\\infty}^{\\infty}e^{-\\beta\\frac{p^2}{2m}}dp\\Bigr)^2\n=\\Bigl(\\sqrt{\\frac{2\\pi m}{\\beta}}\\Bigr)^2\n=\\frac{2\\pi m}{\\beta}\\,.\n$$\n\n3. 构型积分：\n$$\n\\int_{-\\infty}^{\\infty}e^{-\\beta c|x|}dx\n=2\\int_{0}^{\\infty}e^{-\\beta c x}dx\n=\\frac{2}{\\beta c}\\,,\n$$\n所以\n$$\n\\iint dx\\,dy\\,e^{-\\beta c(|x|+|y|)}\n=\\frac{2}{\\beta c}\\cdot\\frac{2}{\\beta c}\n=\\frac{4}{(\\beta c)^2}\\,.\n$$\n\n4. 因此\n$$\nQ_1\n=\\frac{1}{h^2}\\,\\frac{2\\pi m}{\\beta}\\,\\frac{4}{(\\beta c)^2}\n=\\frac{8\\pi m}{h^2c^2}\\,\\beta^{-3}\\,,\n$$\n且\n$$\n\\ln Q_1\n=\\ln\\!\\Bigl(\\frac{8\\pi m}{h^2c^2}\\Bigr)-3\\ln\\beta\\,.\n$$\n\n5. 平均能量为\n$$\n\\langle E\\rangle\n=-\\frac{\\partial\\ln Q_1}{\\partial\\beta}\n=-\\bigl(-3\\beta^{-1}\\bigr)\n=\\frac{3}{\\beta}\n=3k_B T\\,.\n$$\n\n6. 最后，定容热容为\n$$\nC_A\n=\\frac{\\partial\\langle E\\rangle}{\\partial T}\n=3k_B\\,.\n$$",
            "answer": "$$\\boxed{3k_B}$$"
        },
        {
            "introduction": "从单粒子系统过渡到多体系统会引入新的概念性挑战，其中最突出的就是全同粒子的不可区分性。本练习将引导您直接通过对微观态的计数，完成对经典理想气体熵（即Sackur-Tetrode方程）的基础推导。这一过程不仅揭示了不可区分性修正因子（$1/N!$）的深远影响，也为解决著名的吉布斯佯谬提供了钥匙。",
            "id": "3853579",
            "problem": "在多尺度材料模拟中，粗粒化热力学量必须与其原子尺度的统计力学定义保持一致。考虑一个由$N$个质量为$m$的相同原子组成的$3$维经典单原子理想气体，被限制在固定体积$V$内，总能量为$E$。假设在热力学极限下，$N$很大且粒子密度保持有限。\n\n从微正则系综的定义出发，熵$S$由$S = k_B \\ln \\Omega$给出，其中$\\Omega$是在固定能量$E$下可及微观状态的相空间测度。通过以下方式计算微观状态数：\n- 使用因子$1/N!$对不可区分性进行修正，\n- 使用元胞体积$h^{3N}$对相空间进行粗粒化，其中$h$是普朗克常数，\n- 计算在固定能量$E$约束下的位置和动量的相空间积分。\n\n仅使用基本定义和经过充分检验的数学事实，包括$D$维超球体的体积和表面积测度，以及适用于大宗量的斯特林近似。推导出一个关于$k_B$、$N$、$V$、$E$、$m$和$h$的熵$S$的显式闭式解析表达式，精确到对$N$而言次广延的项。\n\n然后，考虑移除两个子系统之间的一个隔板，每个子系统最初都包含处于相同温度和压力下的同种经典单原子理想气体，其状态分别为$\\left(N_1, V_1, E_1\\right)$和$\\left(N_2, V_2, E_2\\right)$，其中$N_1 = N_2 = N/2$，$V_1 = V_2 = V/2$，$E_1 = E_2 = E/2$。在保持总能量$E$和总体积$V$固定的情况下移除隔板。使用你推导出的熵，判断在热力学极限下，仅由混合相同气体引起的熵变是非零还是零，并解释不可区分性修正是如何解决吉布斯佯谬的。除上述指定的定义外，不要假定任何目标公式。\n\n作为你的最终答案，提供你推导出的关于$k_B$、$N$、$V$、$E$、$m$和$h$的熵$S$的闭式解析表达式。不要提供数值计算结果。最终答案必须是一个单一的解析表达式。",
            "solution": "该问题要求在微正则系综中推导经典单原子理想气体的熵$S$，并将其应用于吉布斯佯谬。该系统由$N$个质量为$m$的相同原子组成，处于体积$V$中，总能量为$E$。熵定义为$S = k_B \\ln \\Omega$，其中$\\Omega$是可及微观状态的数量。\n\n一个微观状态由所有$N$个粒子的位置$\\mathbf{q}_i$和动量$\\mathbf{p}_i$定义。所有可能状态的集合构成一个$6N$维相空间。微观状态数$\\Omega$通过计算相空间中可及区域的体积，再除以单个微观状态的体积来得到。由于粗粒化，单个微观状态的体积取为$h^{3N}$。对于全同粒子，我们还必须除以$N!$以修正因物理上不可区分的状态而被重复计数的问题。\n能量不高于$E$的微观状态数由相空间体积$\\Phi(E, V, N)$给出：\n$$\n\\Phi(E, V, N) = \\frac{1}{N! h^{3N}} \\int d^{3N}q \\int d^{3N}p\n$$\n积分范围是体积$V$内的所有位置，以及总能量小于或等于$E$的所有动量。对于单原子理想气体，能量纯粹是动能：\n$$\nH(\\mathbf{q}, \\mathbf{p}) = \\sum_{i=1}^{N} \\frac{|\\mathbf{p}_i|^2}{2m} = E_k \\le E\n$$\n位置积分是对每个粒子在体积$V$内进行的，结果为$V^N$：\n$$\n\\int d^{3N}q = \\left( \\int_V d^3q \\right)^N = V^N\n$$\n动量积分是在由能量约束定义的$3N$维超球体的体积上进行的。让我们将所有动量分量组合成一个$3N$维向量来重写该约束：\n$$\n\\sum_{j=1}^{3N} p_j^2 \\le 2mE\n$$\n这定义了在$3N$维动量空间中一个半径为$R_p = \\sqrt{2mE}$的超球体。一个半径为$R$的$D$维球体的体积由以下公式给出：\n$$\n\\mathcal{V}_D(R) = \\frac{\\pi^{D/2}}{\\Gamma(\\frac{D}{2} + 1)} R^D\n$$\n在我们的例子中，维度是$D = 3N$，半径是$R_p = \\sqrt{2mE}$。动量空间体积为：\n$$\n\\int d^{3N}p = \\mathcal{V}_{3N}(\\sqrt{2mE}) = \\frac{\\pi^{3N/2}}{\\Gamma(\\frac{3N}{2} + 1)} (2mE)^{3N/2}\n$$\n结合所有部分，总相空间体积为：\n$$\n\\Phi(E, V, N) = \\frac{V^N}{N! h^{3N}} \\frac{\\pi^{3N/2}}{\\Gamma(\\frac{3N}{2} + 1)} (2mE)^{3N/2}\n$$\n问题将$\\Omega$定义为固定能量$E$下的状态测度，这对应于超球体的表面。然而，在热力学极限下（$N \\rightarrow \\infty$），壳层体积的对数$\\ln(\\omega(E)\\delta E)$与总球体体积的对数$\\ln(\\Phi(E))$是等价的，相差的仅是次广延项。这是因为$\\Phi(E) \\propto E^{3N/2}$，所以$\\omega(E) = \\frac{d\\Phi}{dE} = \\frac{3N}{2E}\\Phi(E)$。取对数后，$\\ln(\\omega(E)) = \\ln(\\Phi(E)) + \\ln(\\frac{3N}{2E})$，其中第二项是次广延的。因此，我们可以近似为$S = k_B \\ln \\Phi(E, V, N)$。\n\n我们现在对$\\Phi$取对数：\n$$\n\\ln \\Phi = N \\ln V - \\ln(N!) - 3N \\ln h + \\frac{3N}{2} \\ln(\\pi) + \\frac{3N}{2} \\ln(2mE) - \\ln\\left(\\Gamma\\left(\\frac{3N}{2} + 1\\right)\\right)\n$$\n对于大的$N$，我们使用斯特林近似来处理阶乘和伽马函数：$\\ln(x!) \\approx x \\ln x - x$ 和 $\\ln \\Gamma(z+1) \\approx z \\ln z - z$。\n$$\n\\ln(N!) \\approx N \\ln N - N\n$$\n$$\n\\ln\\left(\\Gamma\\left(\\frac{3N}{2} + 1\\right)\\right) \\approx \\frac{3N}{2} \\ln\\left(\\frac{3N}{2}\\right) - \\frac{3N}{2}\n$$\n将这些近似代入$\\ln \\Phi$的表达式中：\n$$\n\\ln \\Phi \\approx N \\ln V - (N \\ln N - N) - 3N \\ln h + \\frac{3N}{2} \\ln(2\\pi mE) - \\left(\\frac{3N}{2} \\ln\\left(\\frac{3N}{2}\\right) - \\frac{3N}{2}\\right)\n$$\n让我们收集并简化这些项：\n$$\n\\ln \\Phi \\approx N \\ln V - N \\ln N + N - 3N \\ln h + \\frac{3N}{2} \\ln(2\\pi mE) - \\frac{3N}{2} (\\ln(3N) - \\ln(2)) + \\frac{3N}{2}\n$$\n$$\n\\ln \\Phi \\approx N \\ln V - N \\ln N + \\frac{5N}{2} - 3N \\ln h + \\frac{3N}{2} \\ln(2\\pi mE) - \\frac{3N}{2} \\ln(3N) + \\frac{3N}{2} \\ln(2)\n$$\n我们可以对对数项进行分组：\n$$\n\\ln \\Phi \\approx N\\left(\\ln V - \\ln N\\right) + \\frac{3N}{2}\\left(\\ln(2\\pi mE) - \\ln(3N) + \\ln 2\\right) - 3N \\ln h + \\frac{5N}{2}\n$$\n$$\n\\ln \\Phi \\approx N\\ln\\left(\\frac{V}{N}\\right) + \\frac{3N}{2}\\ln\\left(\\frac{4\\pi mE}{3N}\\right) - \\frac{3N}{2}\\ln(h^2) + \\frac{5N}{2}\n$$\n$$\n\\ln \\Phi \\approx N\\ln\\left(\\frac{V}{N}\\right) + \\frac{3N}{2}\\ln\\left(\\frac{4\\pi mE}{3N h^2}\\right) + \\frac{5N}{2}\n$$\n因此，熵$S = k_B \\ln \\Phi$为：\n$$\nS(N,V,E) = N k_B \\left[ \\ln\\left(\\frac{V}{N}\\right) + \\frac{3}{2} \\ln\\left(\\frac{4\\pi mE}{3N h^2}\\right) + \\frac{5}{2} \\right]\n$$\n这就是萨克-特特罗德方程。它是一个广延量：如果我们按因子$\\lambda$缩放系统（即$N \\to \\lambda N$，$V \\to \\lambda V$，$E \\to \\lambda E$），强度比$V/N$和$E/N$保持不变，整个表达式随$N$缩放，因此$S \\to \\lambda S$。\n\n现在，我们分析吉布斯佯谬。考虑两个相同的系统，每个系统的状态为$(N/2, V/2, E/2)$，处于热和力学平衡状态。总的初始熵为$S_{\\text{initial}} = S_1 + S_2$。\n$$\nS_1 = S\\left(\\frac{N}{2}, \\frac{V}{2}, \\frac{E}{2}\\right) = \\frac{N}{2} k_B \\left[ \\ln\\left(\\frac{V/2}{N/2}\\right) + \\frac{3}{2} \\ln\\left(\\frac{4\\pi m(E/2)}{3(N/2)h^2}\\right) + \\frac{5}{2} \\right]\n$$\n$$\nS_1 = \\frac{N}{2} k_B \\left[ \\ln\\left(\\frac{V}{N}\\right) + \\frac{3}{2} \\ln\\left(\\frac{4\\pi mE}{3Nh^2}\\right) + \\frac{5}{2} \\right]\n$$\n由于子系统是相同的，$S_1 = S_2$。总的初始熵为：\n$$\nS_{\\text{initial}} = 2 \\times S_1 = N k_B \\left[ \\ln\\left(\\frac{V}{N}\\right) + \\frac{3}{2} \\ln\\left(\\frac{4\\pi mE}{3Nh^2}\\right) + \\frac{5}{2} \\right]\n$$\n移除隔板后，我们得到一个状态为$(N, V, E)$的单一系统。最终的熵为：\n$$\nS_{\\text{final}} = S(N, V, E) = N k_B \\left[ \\ln\\left(\\frac{V}{N}\\right) + \\frac{3}{2} \\ln\\left(\\frac{4\\pi mE}{3Nh^2}\\right) + \\frac{5}{2} \\right]\n$$\n熵变为$\\Delta S = S_{\\text{final}} - S_{\\text{initial}} = 0$。这个结果在物理上是正确的：在相同温度和压力下，两个相同气体的可逆混合不应产生熵变。\n\n如果忽略了粒子不可区分性因子$1/N!$，就会出现吉布斯佯谬。没有这个因子，可区分粒子的熵$S'$ 将不包含我们计算中源于$-k_B \\ln(N!) \\approx -k_B(N \\ln N - N)$的项。换句话说，正确的熵是$S = S' - k_B \\ln(N!)$，其中$S'$是可区分粒子的熵。$S'$中的关键项将是$N \\ln V$而不是$N \\ln(V/N)$，这使得$S'$成为一个非广延量。将这个非广延熵应用于混合问题，会得出一个虚假的混合熵，$\\Delta S' = N k_B \\ln 2$。通过使用$1/N!$因子正确地考虑粒子不可区分性，这个混合相同气体时熵悖论性增加的问题得到了解决。这一修正确保了熵是系统的广延性质，从而导致$\\Delta S = 0$，这对于涉及相同物质的可逆过程是必需的。\n\n最终要求的答案是推导出的熵$S$的闭式解析表达式。",
            "answer": "$$\n\\boxed{N k_B \\left[ \\ln\\left(\\frac{V}{N}\\right) + \\frac{3}{2} \\ln\\left(\\frac{4 \\pi m E}{3 N h^2}\\right) + \\frac{5}{2} \\right]}\n$$"
        },
        {
            "introduction": "理想气体模型虽具启发性，但真实材料的行为受制于复杂的分子间相互作用，而维里展开为系统地处理这些相互作用提供了途径。这项动手实践旨在连接理论统计力学与实际的计算模拟。您将首先推导第二维里系数的表达式，它量化了系统对理想气体行为的初始偏离，然后针对材料模拟中的标准模型——Lennard-Jones势，实施数值计算方案。",
            "id": "3853604",
            "problem": "给定一个经典的、三维的平衡系统，其中包含处于正则系综中、温度为 $T$ 的全同粒子。粒子间通过对势可加的伦纳德-琼斯 (Lennard–Jones, LJ) 势相互作用。您的任务是，从正则组态配分函数和集团展开中使用的迈耶 (Mayer) $f$-函数的定义出发，在不预先假设任何已推导的维里表达式的情况下，为一个各向同性的对势推导出第二维里系数 $B_2(T)$ 的一维径向积分表达式。然后，使用该表达式，通过估算相应迈耶函数 $f(r)$ 在一个径向截断上限内的积分，实现一个数值方案来近似计算伦纳德-琼斯势的 $B_2(T)$，并评估其在不同温度下的收敛性。\n\n使用的基本原理：\n- 正则系综定义：经典的正则组态积分、全同性因子以及玻尔兹曼权重 $\\exp(-\\beta U)$，其中 $\\beta = 1/(k_{\\mathrm{B}} T)$，$k_{\\mathrm{B}}$ 是玻尔兹曼常数。\n- 集团展开（迈耶展开）：仅需理解到第二维里系数是如何从两粒子贡献中以迈耶 $f$-函数的形式出现的，其中对于对势 $u(r)$，$f_{ij} = \\exp(-\\beta u(r_{ij})) - 1$。\n- 几何简化：在各向同性条件下，从三维空间积分简化为一维径向积分。\n\n系统具体信息：\n- 对势为伦纳德-琼斯 (LJ) 势 $u(r) = 4 \\varepsilon \\left[ \\left( \\dfrac{\\sigma}{r} \\right)^{12} - \\left( \\dfrac{\\sigma}{r} \\right)^{6} \\right]$，其中 $\\varepsilon$ 和 $\\sigma$ 分别是 LJ 的能量和长度尺度。\n- 引入约化变量 $T^\\star = \\dfrac{k_{\\mathrm{B}} T}{\\varepsilon}$ 和 $x = \\dfrac{r}{\\sigma}$，并将无量纲的第二维里系数 $B_2^\\star(T^\\star) = \\dfrac{B_2(T)}{\\sigma^3}$ 完全用 $T^\\star$ 和 $x$ 表示。\n\n数值近似要求：\n- 将径向积分中的无穷上限替换为有限的截断值 $x_{\\max}$，并数值计算该截断积分来近似 $B_2^\\star(T^\\star)$。\n- 解释伦纳德-琼斯势尾部对应的迈耶 $f$-函数的渐进行为如何影响关于 $x_{\\max}$ 的收敛性，并以此来证明您的收敛性评估的合理性。\n\n测试套件：\n- 使用约化温度 $T^\\star \\in \\{0.5, 1.0, 2.0, 5.0\\}$。\n- 对于每个 $T^\\star$，在三个截断上限 $x_{\\max} \\in \\{6, 8, 10\\}$ 下计算截断的 $B_2^\\star(T^\\star)$。\n- 对于每个 $T^\\star$，报告三个数值：\n  1. 使用 $x_{\\max} = 10$ 计算出的 $B_2^\\star(T^\\star)$ 值。\n  2. 绝对差 $\\Delta_{10,8} = \\left| B_2^\\star(T^\\star; x_{\\max}=10) - B_2^\\star(T^\\star; x_{\\max}=8) \\right|$。\n  3. 绝对差 $\\Delta_{8,6} = \\left| B_2^\\star(T^\\star; x_{\\max}=8) - B_2^\\star(T^\\star; x_{\\max}=6) \\right|$。\n\n单位与数值规范：\n- 将 $B_2^\\star$ 报告为无量纲数（等效于以 $\\sigma^3$ 为单位的 $B_2$）。\n- 输出中无需物理单位。\n- 不涉及角度。\n- 不得使用百分比；任何比率（如有）必须以小数形式给出。\n\n最终程序输出格式：\n- 您的程序必须生成单一行，其中包含一个由方括号括起来的、逗号分隔的四个温度三元组列表。例如：$[[a_1,b_1,c_1],[a_2,b_2,c_2],[a_3,b_3,c_3],[a_4,b_4,c_4]]$，其中每个 $a_i$、$b_i$ 和 $c_i$ 都是浮点数，按顺序对应于 $T^\\star \\in \\{0.5, 1.0, 2.0, 5.0\\}$。\n\n您必须交付的内容：\n- 按照规定，从第一性原理推导您将要实现的积分表达式。\n- 解释数值积分和收敛性评估的算法选择。\n- 实现计算，并按上述指定的确切格式生成最终输出。最终输出必须是您的程序打印的唯一一行。",
            "solution": "**1. 理论推导**\n\n我们从一个包含 $N$ 个全同粒子、温度为 $T$ 的经典正则系综系统开始。正则组态配分函数为\n$$\nZ_{N}^{\\text{conf}}(\\beta, V) = \\frac{1}{N!} \\int \\cdots \\int d\\mathbf{r}_1 \\cdots d\\mathbf{r}_N \\, \\exp\\left( -\\beta U(\\mathbf{r}^N) \\right),\n$$\n其中 $\\beta = 1/(k_{\\mathrm{B}} T)$，$V$ 是体积，$U(\\mathbf{r}^N)$ 是总势能。对于对势可加的系统，总势能为 $U(\\mathbf{r}^N) = \\sum_{1 \\le i  j \\le N} u(r_{ij})$，其中 $u(r_{ij})$ 是粒子 $i$ 和 $j$ 之间的对势。\n\n玻尔兹曼因子可以利用迈耶 $f$-函数 $f_{ij} = e^{-\\beta u(r_{ij})} - 1$ 展开：\n$$\ne^{-\\beta U(\\mathbf{r}^N)} = \\prod_{1 \\le i  j \\le N} e^{-\\beta u(r_{ij})} = \\prod_{1 \\le i  j \\le N} (1 + f_{ij})\n$$\n对于低密度气体，我们可以将此乘积展开，并只保留对集团积分有最低阶贡献的项。维里物态方程将压力 $P$ 展开为密度 $\\rho = N/V$ 的幂级数：\n$$\n\\frac{P}{k_{\\mathrm{B}} T} = \\rho + B_2(T) \\rho^2 + B_3(T) \\rho^3 + \\dots\n$$\n第二维里系数 $B_2(T)$ 捕捉了对理想气体行为的最低阶偏离，这源于成对粒子间的相互作用。它与迈耶函数的关系可以通过集团展开理论推导，其标准结果是：\n$$\nB_2(T) = -\\frac{1}{2} \\int f(\\mathbf{r}) \\, d\\mathbf{r}\n$$\n其中积分是在整个三维空间上进行的。对于各向同性的对势 $u(r)$，迈耶函数也只依赖于距离 $r = |\\mathbf{r}|$。我们可以将三维空间积分转换为球坐标下的一维径向积分：\n$$\n\\int f(\\mathbf{r}) \\, d\\mathbf{r} = \\int_0^\\infty 4\\pi r^2 f(r) \\, dr\n$$\n因此，第二维里系数的表达式为：\n$$\nB_2(T) = -\\frac{1}{2} \\int_0^\\infty 4\\pi r^2 (\\exp(-\\beta u(r)) - 1) \\, dr = -2\\pi \\int_0^\\infty r^2 (\\exp(-\\beta u(r)) - 1) \\, dr\n$$\n这就是我们将要进行数值计算的积分表达式。\n\n**2. 无量纲化**\n\n为了方便计算，我们引入约化单位。令 $x = r/\\sigma$，$T^\\star = k_{\\mathrm{B}} T / \\varepsilon$。伦纳德-琼斯势变为：\n$$\nu(r) = 4\\varepsilon (x^{-12} - x^{-6})\n$$\n于是，指数项为 $\\beta u(r) = \\frac{1}{k_{\\mathrm{B}} T} u(r) = \\frac{\\varepsilon}{k_{\\mathrm{B}} T} \\frac{u(r)}{\\varepsilon} = \\frac{1}{T^\\star} (4(x^{-12} - x^{-6})) = \\frac{4}{T^\\star} (x^{-12} - x^{-6})$。\n\n将 $r = x\\sigma$ 和 $dr = \\sigma dx$ 代入 $B_2(T)$ 的表达式：\n$$\nB_2(T) = -2\\pi \\int_0^\\infty (x\\sigma)^2 \\left( \\exp\\left(-\\frac{4}{T^\\star}(x^{-12} - x^{-6})\\right) - 1 \\right) \\sigma \\, dx\n$$\n$$\nB_2(T) = -2\\pi \\sigma^3 \\int_0^\\infty x^2 \\left( \\exp\\left(-\\frac{4}{T^\\star}(x^{-12} - x^{-6})\\right) - 1 \\right) \\, dx\n$$\n定义无量纲的第二维里系数 $B_2^\\star(T^\\star) = B_2(T) / \\sigma^3$，我们得到最终的积分形式：\n$$\nB_2^\\star(T^\\star) = -2\\pi \\int_0^\\infty x^2 \\left[ \\exp\\left(-\\frac{4}{T^\\star}\\left(\\frac{1}{x^{12}} - \\frac{1}{x^6}\\right)\\right) - 1 \\right] \\, dx\n$$\n\n**3. 数值方案与收敛性分析**\n\n**算法选择**: 我们将通过数值积分来计算上述定积分。由于积分上限是无穷大，我们用一个有限的截断半径 $x_{\\max}$ 来近似它。积分可以由 `scipy.integrate.quad` 这类自适应辛普森或高斯求积方法高效计算，它们能很好地处理被积函数在某些区域的剧烈变化。\n\n**收敛性分析**: 积分的收敛性取决于被积函数在大 $x$ 处的行为。当 $x \\to \\infty$ 时，$u(r) \\approx -4\\varepsilon(\\sigma/r)^6 = -4\\varepsilon x^{-6}$。这是一个弱吸引势。此时 $\\beta u(r)$ 很小，我们可以对迈耶函数做泰勒展开：\n$$\nf(x) = \\exp(-\\beta u(x)) - 1 \\approx -\\beta u(x) = \\frac{4\\varepsilon}{k_B T}x^{-6} = \\frac{4}{T^\\star}x^{-6}\n$$\n因此，被积函数在大 $x$ 处的渐进行为是：\n$$\nx^2 f(x) \\approx x^2 \\left(\\frac{4}{T^\\star}x^{-6}\\right) = \\frac{4}{T^\\star}x^{-4}\n$$\n截断误差，即从 $x_{\\max}$ 到 $\\infty$ 的积分贡献，可以近似估算为：\n$$\n\\text{Error} \\approx \\left| -2\\pi \\int_{x_{\\max}}^\\infty \\frac{4}{T^\\star}x^{-4} \\, dx \\right| = \\frac{8\\pi}{T^\\star} \\left[ -\\frac{1}{3}x^{-3} \\right]_{x_{\\max}}^\\infty = \\frac{8\\pi}{3T^\\star} \\frac{1}{x_{\\max}^3}\n$$\n截断误差随 $x_{\\max}^{-3}$ 衰减。这意味着随着截断半径 $x_{\\max}$ 的增加，计算结果会收敛到真值。通过比较在不同 $x_{\\max}$（如6, 8, 10）下的计算结果，我们可以观察到差值 $\\Delta$ 减小，从而验证收敛性。例如，我们预期 $\\Delta_{10,8}$ 会显著小于 $\\Delta_{8,6}$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef b2_star_truncated(T_star: float, x_max: float) - float:\n    \"\"\"\n    Compute the truncated dimensionless second virial coefficient B2* for the\n    Lennard–Jones potential at reduced temperature T_star and upper limit x_max.\n\n    B2* = -2*pi * integral_0^{x_max} [exp(-4/T* * (x^-12 - x^-6)) - 1] * x^2 dx\n    \"\"\"\n    inv_T = 1.0 / T_star\n\n    def integrand(x):\n        # Guard against x=0 and extremely small x to avoid overflow in x**-12\n        if x  1e-8:\n            # Mayer f -> -1 for x->0 (repulsive core), so g(x) ~ -x^2\n            return -x * x\n        invx = 1.0 / x\n        invx2 = invx * invx\n        invx6 = invx2 * invx2 * invx2\n        invx12 = invx6 * invx6\n        expo = -4.0 * inv_T * (invx12 - invx6)\n        # For large negative expo, exp(expo) -> 0 safely; for small |expo|, it's fine.\n        f = np.exp(expo) - 1.0\n        return f * (x * x)\n\n    # Adaptive quadrature over [0, x_max]\n    # Use tight tolerances; increase limit (max subintervals) to handle sharp features\n    val, err = quad(integrand, 0.0, x_max, epsabs=1e-11, epsrel=1e-11, limit=500)\n    return -2.0 * np.pi * val\n\ndef compute_results():\n    # Test suite: reduced temperatures and cutoffs\n    T_stars = [0.5, 1.0, 2.0, 5.0]\n    x_max_list = [6.0, 8.0, 10.0]\n\n    results = []\n    for T in T_stars:\n        vals = []\n        for x_max in x_max_list:\n            b2 = b2_star_truncated(T, x_max)\n            # Round to reduce representation noise while keeping high precision\n            vals.append(float(f\"{b2:.12f}\"))\n        # Prepare the triplet [B2*(10), |B2*(10)-B2*(8)|, |B2*(8)-B2*(6)|]\n        b2_6, b2_8, b2_10 = vals[0], vals[1], vals[2]\n        d10_8 = abs(b2_10 - b2_8)\n        d8_6 = abs(b2_8 - b2_6)\n        results.append([float(f\"{b2_10:.12f}\"),\n                        float(f\"{d10_8:.12f}\"),\n                        float(f\"{d8_6:.12f}\")])\n    return results\n\ndef serialize_no_spaces(obj):\n    \"\"\"\n    Serialize Python lists of floats/ints/bools into a bracketed comma-separated\n    string with no spaces, suitable for the required single-line output.\n    \"\"\"\n    if isinstance(obj, list):\n        return \"[\" + \",\".join(serialize_no_spaces(x) for x in obj) + \"]\"\n    if isinstance(obj, bool):\n        return \"True\" if obj else \"False\"\n    if isinstance(obj, float):\n        # Use a compact representation while preserving the given decimal places\n        # Keep trailing zeros if present by formatting to 12 decimals.\n        return f\"{obj:.12f}\".rstrip('0').rstrip('.') if '.' in f\"{obj:.12f}\" else f\"{obj:.12f}\"\n    return str(obj)\n\ndef solve():\n    results = compute_results()\n    print(serialize_no_spaces(results))\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}