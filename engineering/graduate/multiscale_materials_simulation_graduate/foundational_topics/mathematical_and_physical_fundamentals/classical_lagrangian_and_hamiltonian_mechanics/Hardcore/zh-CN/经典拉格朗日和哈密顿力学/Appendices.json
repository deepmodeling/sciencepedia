{
    "hands_on_practices": [
        {
            "introduction": "单摆是经典力学中的一个原型系统。本练习将引导你完成一个基本但至关重要的过程：从牛顿力学的笛卡尔坐标出发，系统地构建拉格朗日量和哈密顿量，并推导出运动方程 。掌握这一流程是运用这些高级形式主义对任何力学系统（从单个分子到粗粒化模型）进行建模的基础。",
            "id": "3814041",
            "problem": "在多尺度材料模拟中，一个粗粒化单元通常可以由一个受到完整约束的单一转动自由度来表示。考虑一个长度为 $l$、质量为 $m$ 的平面摆，它悬挂在一个无摩擦的枢轴上，并处于大小为 $g$ 的匀强引力场中。摆锤在竖直平面内运动，其位形可以用广义坐标 $\\theta$ 来描述，$\\theta$ 定义为摆杆与向下的竖直线之间的夹角。取摆动最低点为势能零点。假设摆杆是无质量的刚性杆，摆锤是一个质点。\n\n仅使用基本原理，即牛顿第二定律、动能的定义、完整约束、广义坐标的定义以及驻定作用量原理，完成以下任务：\n- 将摆锤的笛卡尔坐标表示为 $\\theta$ 和 $l$ 的函数，并通过对时间求导得到速度分量。\n- 根据这些运动学关系构建动能 $T$ 和势能 $U$。\n- 用 $\\theta$ 和 $\\dot{\\theta}$ 表示拉格朗日量 $L = T - U$。\n- 将欧拉-拉格朗日方程应用于 $L$ 以推导运动方程。\n- 定义正则动量 $p_{\\theta}$，并通过勒让德变换构建哈密顿量 $H$。证明哈密顿方程能够重现从欧拉-拉格朗日方程得到的相同运动方程，并且在消除了张力约束力后，与牛顿第二定律的切向分量等价。\n\n为了评分，只需报告你得到的拉格朗日量 $L(\\theta,\\dot{\\theta})$ 的单一闭合形式表达式。最终方框内的答案不要包含单位。如果选择引入任何数值常数，它们必须是精确的；不需要也不允许四舍五入。",
            "solution": "问题陈述已经过验证，被认为是合理的。这是一个经典力学中的标准练习，具体涉及将拉格朗日和哈密顿形式体系应用于单摆。给定条件是完整、一致且有科学依据的。我们可以进行完整的推导。\n\n该问题要求从笛卡尔坐标和基本原理出发，进行系统性推导，得出拉格朗日量、通过欧拉-拉格朗日方程得到的运动方程，并使用哈密顿形式体系进行并行推导。\n\n让我们建立一个坐标系，其中无摩擦枢轴位于原点 $(0, 0)$。我们将 y 轴与向下的竖直方向对齐，x 轴水平。广义坐标 $\\theta$ 是摆杆与这个向下的竖直 y 轴之间的夹角。\n\n**1. 笛卡尔坐标与速度**\n\n质量为 $m$ 的摆锤位于长度为 $l$ 的摆杆末端，其位置由笛卡尔坐标 $(x, y)$ 给出。根据 $\\theta$ 的几何定义：\n$$x(\\theta) = l \\sin(\\theta)$$\n$$y(\\theta) = l \\cos(\\theta)$$\n为求速度分量，我们使用链式法则（$\\dot{\\theta} = \\frac{d\\theta}{dt}$）对这些表达式关于时间 $t$ 求导：\n$$\\dot{x} = \\frac{dx}{dt} = \\frac{d}{dt}(l \\sin(\\theta)) = l \\cos(\\theta) \\dot{\\theta}$$\n$$\\dot{y} = \\frac{dy}{dt} = \\frac{d}{dt}(l \\cos(\\theta)) = -l \\sin(\\theta) \\dot{\\theta}$$\n\n**2. 动能与势能**\n\n动能 $T$ 由 $T = \\frac{1}{2} m v^2$ 给出，其中 $v^2 = \\dot{x}^2 + \\dot{y}^2$。代入速度分量：\n$$T = \\frac{1}{2} m ( (l \\cos(\\theta) \\dot{\\theta})^2 + (-l \\sin(\\theta) \\dot{\\theta})^2 )$$\n$$T = \\frac{1}{2} m ( l^2 \\cos^2(\\theta) \\dot{\\theta}^2 + l^2 \\sin^2(\\theta) \\dot{\\theta}^2 )$$\n$$T = \\frac{1}{2} m l^2 \\dot{\\theta}^2 (\\cos^2(\\theta) + \\sin^2(\\theta))$$\n使用三角恒等式 $\\cos^2(\\theta) + \\sin^2(\\theta) = 1$，动能简化为：\n$$T(\\dot{\\theta}) = \\frac{1}{2} m l^2 \\dot{\\theta}^2$$\n势能 $U$ 是由大小为 $g$ 的匀强引力场引起的。引力为 $\\vec{F}_g = m\\vec{g}$。在我们的坐标系中，$\\vec{g}$ 指向 y 轴正方向，因此力为 $(0, mg)$。势能 $U$ 的定义满足 $\\vec{F}_g = -\\nabla U$。这得出 $U = -mgy + C$，其中 $C$ 是一个积分常数。\n问题指定势能零点在摆动的最低点。这发生在 $\\theta = 0$ 时，对应位置为 $y = l \\cos(0) = l$。\n在 $y=l$ 处设 $U=0$：\n$$0 = -mg(l) + C \\implies C = mgl$$\n因此，势能作为 $y$ 的函数是 $U(y) = mg(l-y)$。代入 $y = l \\cos(\\theta)$，我们得到势能作为广义坐标 $\\theta$ 的函数：\n$$U(\\theta) = mgl(1 - \\cos(\\theta))$$\n\n**3. 拉格朗日形式**\n\n拉格朗日量 $L$ 定义为 $L = T - U$。\n$$L(\\theta, \\dot{\\theta}) = \\frac{1}{2} m l^2 \\dot{\\theta}^2 - mgl(1 - \\cos(\\theta))$$\n这就是所要求的拉格朗日量表达式。\n\n**4. 欧拉-拉格朗日运动方程**\n\n运动方程由坐标 $\\theta$ 的欧拉-拉格朗日方程导出：\n$$\\frac{d}{dt}\\left(\\frac{\\partial L}{\\partial \\dot{\\theta}}\\right) - \\frac{\\partial L}{\\partial \\theta} = 0$$\n我们计算所需的偏导数：\n$$\\frac{\\partial L}{\\partial \\dot{\\theta}} = \\frac{\\partial}{\\partial \\dot{\\theta}} \\left( \\frac{1}{2} m l^2 \\dot{\\theta}^2 - mgl(1 - \\cos(\\theta)) \\right) = m l^2 \\dot{\\theta}$$\n$$\\frac{\\partial L}{\\partial \\theta} = \\frac{\\partial}{\\partial \\theta} \\left( \\frac{1}{2} m l^2 \\dot{\\theta}^2 - mgl(1 - \\cos(\\theta)) \\right) = -mgl(0 - (-\\sin(\\theta))) = -mgl \\sin(\\theta)$$\n将这些代入欧拉-拉格朗日方程：\n$$\\frac{d}{dt}(m l^2 \\dot{\\theta}) - (-mgl \\sin(\\theta)) = 0$$\n$$m l^2 \\ddot{\\theta} + mgl \\sin(\\theta) = 0$$\n两边除以 $ml^2$（因为 $m \\neq 0$ 且 $l \\neq 0$），得到运动方程：\n$$\\ddot{\\theta} + \\frac{g}{l} \\sin(\\theta) = 0$$\n\n**5. 哈密顿形式**\n\n首先，我们定义与坐标 $\\theta$ 共轭的正则动量 $p_{\\theta}$：\n$$p_{\\theta} = \\frac{\\partial L}{\\partial \\dot{\\theta}} = m l^2 \\dot{\\theta}$$\n哈密顿量 $H$ 通过拉格朗日量的勒让德变换构建：$H = p_{\\theta}\\dot{\\theta} - L$。为了将 $H$ 表示为相空间变量 $(\\theta, p_{\\theta})$ 的函数，我们必须消去 $\\dot{\\theta}$。根据 $p_{\\theta}$ 的定义，我们有 $\\dot{\\theta} = \\frac{p_{\\theta}}{ml^2}$。\n$$H = p_{\\theta}\\left(\\frac{p_{\\theta}}{ml^2}\\right) - \\left( \\frac{1}{2} m l^2 \\left(\\frac{p_{\\theta}}{ml^2}\\right)^2 - mgl(1 - \\cos(\\theta)) \\right)$$\n$$H = \\frac{p_{\\theta}^2}{ml^2} - \\left( \\frac{1}{2} m l^2 \\frac{p_{\\theta}^2}{m^2 l^4} - mgl(1 - \\cos(\\theta)) \\right)$$\n$$H = \\frac{p_{\\theta}^2}{ml^2} - \\frac{p_{\\theta}^2}{2ml^2} + mgl(1 - \\cos(\\theta))$$\n$$H(\\theta, p_{\\theta}) = \\frac{p_{\\theta}^2}{2ml^2} + mgl(1 - \\cos(\\theta))$$\n注意到 $H = T+U$，即系统的总能量。\n\n**6. 哈密顿方程及其等价性**\n\n哈密顿运动方程是：\n$$\\dot{\\theta} = \\frac{\\partial H}{\\partial p_{\\theta}} \\quad \\text{and} \\quad \\dot{p}_{\\theta} = -\\frac{\\partial H}{\\partial \\theta}$$\n让我们计算这些：\n$$\\dot{\\theta} = \\frac{\\partial}{\\partial p_{\\theta}} \\left( \\frac{p_{\\theta}^2}{2ml^2} + mgl(1 - \\cos(\\theta)) \\right) = \\frac{2p_{\\theta}}{2ml^2} = \\frac{p_{\\theta}}{ml^2}$$\n这恢复了正则动量的定义，$p_{\\theta} = m l^2 \\dot{\\theta}$。\n$$\\dot{p}_{\\theta} = -\\frac{\\partial}{\\partial \\theta} \\left( \\frac{p_{\\theta}^2}{2ml^2} + mgl(1 - \\cos(\\theta)) \\right) = -mgl(0 - (-\\sin(\\theta))) = -mgl \\sin(\\theta)$$\n为了得到关于 $\\theta$ 的二阶微分方程，我们将 $p_{\\theta} = ml^2 \\dot{\\theta}$ 对时间求导，得到 $\\dot{p}_{\\theta} = ml^2 \\ddot{\\theta}$。令 $\\dot{p}_{\\theta}$ 的两个表达式相等：\n$$ml^2 \\ddot{\\theta} = -mgl \\sin(\\theta)$$\n$$ml^2 \\ddot{\\theta} + mgl \\sin(\\theta) = 0 \\implies \\ddot{\\theta} + \\frac{g}{l} \\sin(\\theta) = 0$$\n这与从拉格朗日形式体系推导出的运动方程完全相同。\n\n最后，我们证明它与牛顿第二定律 $\\vec{F}_{\\text{net}} = m\\vec{a}$ 的切向分量等价。\n作用力有张力 $\\vec{F}_T$（径向，指向枢轴）和引力 $\\vec{F}_g = (0, mg)$。在以枢轴为中心、$\\hat{r}$ 指向质量的极坐标基 $(\\hat{r}, \\hat{\\theta})$ 中，$\\vec{F}_T = -|\\vec{F}_T|\\hat{r}$ 且 $\\vec{F}_g = (mg\\cos\\theta)\\hat{r} - (mg\\sin\\theta)\\hat{\\theta}$。\n在该基底下，半径为 $l$ 的圆周运动的加速度为 $\\vec{a} = -l\\dot{\\theta}^2\\hat{r} + l\\ddot{\\theta}\\hat{\\theta}$。\n$\\vec{F}_{\\text{net}} = m\\vec{a}$ 的切向分量是 $F_{\\text{net},\\theta} = m a_{\\theta}$。\n张力 $\\vec{F}_T$ 是纯径向的，所以没有切向分量。引力的切向分量是 $-mg\\sin\\theta$。\n因此，我们有：\n$$-mg\\sin\\theta = m(l\\ddot{\\theta})$$\n$$ml\\ddot{\\theta} + mg\\sin\\theta = 0 \\implies \\ddot{\\theta} + \\frac{g}{l}\\sin(\\theta) = 0$$\n这证实了拉格朗日和哈密顿形式体系正确地重现了牛顿定律对于无约束自由度的描述，并自动消除了张力这一约束力。\n最后的任务是报告拉格朗日量。",
            "answer": "$$\\boxed{\\frac{1}{2} m l^2 \\dot{\\theta}^2 - mgl(1 - \\cos(\\theta))}$$"
        },
        {
            "introduction": "一旦我们能够构建拉格朗日量，下一步就是分析系统在平衡点附近的行为。本练习探讨了耦合振子系统的简正模，这是理解材料中集体运动（如声子）的关键 。通过求解广义特征值问题 $K\\phi=\\omega^2 M\\phi$，你将学会如何解耦复杂的运动，并识别出系统固有的振动频率和模式。",
            "id": "3796152",
            "problem": "考虑一个代表多尺度材料系统微小振动的粗粒化三自由度晶格。广义坐标汇集在向量 $q(t)\\in\\mathbb{R}^3$ 中。动能为 $T=\\tfrac{1}{2}\\dot{q}^\\top M \\dot{q}$，势能为 $V=\\tfrac{1}{2}q^\\top K q$，其中 $M\\in\\mathbb{R}^{3\\times 3}$ 是对称正定质量矩阵，$K\\in\\mathbb{R}^{3\\times 3}$ 是对称正定刚度矩阵。从拉格朗日量 $L=T-V$ 出发，推导运动方程，并证明寻求形如 $q(t)=\\phi\\cos(\\omega t)$ 的简正模解将导出广义特征值问题 $K\\phi=\\omega^2 M\\phi$。证明不同本征模关于由 $\\langle u,v\\rangle_M=u^\\top M v$ 定义的 $M$-内积是正交的。然后，对于下述参数集，计算简正模频率，并数值验证关于 $M$-内积的正交性。\n\n在整个过程中必须遵守物理单位：质量单位为千克（$\\mathrm{kg}$），刚度单位为牛顿每米（$\\mathrm{N/m}$），角频率必须以弧度每秒（$\\mathrm{rad/s}$）为单位报告。若有角度，则必须以弧度为单位。\n\n对每组参数，如下构造 $M$ 和 $K$。质量矩阵 $M$ 是对角矩阵或弱耦合（对称）矩阵，以反映惯性交叉耦合。刚度矩阵由接地弹簧和两两耦合构建。设 $q=[q_1,q_2,q_3]^\\top$。势能为\n$$\nV=\\tfrac{1}{2}k_{g1}q_1^2+\\tfrac{1}{2}k_{g2}q_2^2+\\tfrac{1}{2}k_{g3}q_3^2+\\tfrac{1}{2}k_{12}(q_1-q_2)^2+\\tfrac{1}{2}k_{23}(q_2-q_3)^2+\\tfrac{1}{2}k_{13}(q_1-q_3)^2,\n$$\n由此可得对称刚度矩阵\n$$\nK=\\begin{bmatrix}\nk_{g1}+k_{12}+k_{13} & -k_{12} & -k_{13} \\\\\n-k_{12} & k_{g2}+k_{12}+k_{23} & -k_{23} \\\\\n-k_{13} & -k_{23} & k_{g3}+k_{23}+k_{13}\n\\end{bmatrix}.\n$$\n\n测试套件：\n- 情况 A（基准，对角质量）：\n  - 质量：$m_1=1.5\\times 10^{-3}\\ \\mathrm{kg}$，$m_2=1.0\\times 10^{-3}\\ \\mathrm{kg}$，$m_3=1.2\\times 10^{-3}\\ \\mathrm{kg}$。\n  - 刚度：$k_{g1}=120\\ \\mathrm{N/m}$，$k_{g2}=80\\ \\mathrm{N/m}$，$k_{g3}=100\\ \\mathrm{N/m}$。\n  - 耦合：$k_{12}=300\\ \\mathrm{N/m}$，$k_{23}=200\\ \\mathrm{N/m}$，$k_{13}=50\\ \\mathrm{N/m}$。\n  - $M=\\mathrm{diag}(m_1,m_2,m_3)$。\n- 情况 B（惯性耦合，对称质量）：\n  - 质量：$m_1=1.2\\times 10^{-3}\\ \\mathrm{kg}$，$m_2=1.6\\times 10^{-3}\\ \\mathrm{kg}$，$m_3=1.1\\times 10^{-3}\\ \\mathrm{kg}$。\n  - 惯性耦合：$c_{12}=1.0\\times 10^{-5}\\ \\mathrm{kg}$，$c_{23}=0.8\\times 10^{-5}\\ \\mathrm{kg}$。\n  - 刚度：$k_{g1}=90\\ \\mathrm{N/m}$，$k_{g2}=120\\ \\mathrm{N/m}$，$k_{g3}=110\\ \\mathrm{N/m}$。\n  - 耦合：$k_{12}=400\\ \\mathrm{N/m}$，$k_{23}=350\\ \\mathrm{N/m}$，$k_{13}=70\\ \\mathrm{N/m}$。\n  - $M=\\begin{bmatrix} m_1 & c_{12} & 0 \\\\ c_{12} & m_2 & c_{23} \\\\ 0 & c_{23} & m_3 \\end{bmatrix}$。\n- 情况 C（近简并谱，弱惯性耦合）：\n  - 质量：$m_1=1.0\\times 10^{-3}\\ \\mathrm{kg}$，$m_2=1.0\\times 10^{-3}\\ \\mathrm{kg}$，$m_3=1.1\\times 10^{-3}\\ \\mathrm{kg}$。\n  - 惯性耦合：$c_{12}=2.0\\times 10^{-6}\\ \\mathrm{kg}$，$c_{23}=2.0\\times 10^{-6}\\ \\mathrm{kg}$。\n  - 刚度：$k_{g1}=60\\ \\mathrm{N/m}$，$k_{g2}=60\\ \\mathrm{N/m}$，$k_{g3}=60\\ \\mathrm{N/m}$。\n  - 耦合：$k_{12}=100\\ \\mathrm{N/m}$，$k_{23}=100\\ \\mathrm{N/m}$，$k_{13}=0\\ \\mathrm{N/m}$。\n  - $M=\\begin{bmatrix} m_1 & c_{12} & 0 \\\\ c_{12} & m_2 & c_{23} \\\\ 0 & c_{23} & m_3 \\end{bmatrix}$。\n\n对于每种情况：\n1. 求解 $K\\phi=\\omega^2 M\\phi$ 以获得三个非负特征值 $\\omega_i^2$ 及对应的特征向量 $\\phi_i$。\n2. 计算角频率 $\\omega_i=\\sqrt{\\omega_i^2}$ 并按升序排序。所有频率以 $\\mathrm{rad/s}$ 为单位表示，并四舍五入到六位小数。\n3. 对特征向量进行归一化，使得对每个 $i$ 都有 $\\phi_i^\\top M \\phi_i=1$。\n4. 通过计算矩阵 $S=\\Phi^\\top M \\Phi$ 来验证正交性，其中 $\\Phi=[\\phi_1,\\phi_2,\\phi_3]$。返回一个布尔值，表示是否满足 $\\max_{i\\neq j}|S_{ij}| < \\tau$，容差 $\\tau=10^{-9}$。\n\n你的程序应产生单行输出，其中包含一个由方括号括起来的逗号分隔列表。每个测试用例的结果必须是一个列表，包含三个排序后的角频率（单位为 $\\mathrm{rad/s}$）和一个表示正交性的布尔值，例如 $[[\\omega_1,\\omega_2,\\omega_3,\\mathrm{bool}_A],[\\omega_1,\\omega_2,\\omega_3,\\mathrm{bool}_B],[\\omega_1,\\omega_2,\\omega_3,\\mathrm{bool}_C]]$。",
            "solution": "该问题要求对一个保守力学系统的运动方程及其简正模进行理论推导，然后通过数值实现来求解特定参数集下的这些模态。该问题在科学上基于经典拉格朗日力学，是适定的，并为获得唯一解提供了所有必要信息。因此，它被认为是一个有效的问题。\n\n解答分为两部分：首先是按要求进行的理论推导，其次是将在最终代码中实现的数值计算。\n\n### 理论推导\n\n该系统由一组广义坐标 $q(t) \\in \\mathbb{R}^3$ 描述。动能和势能以二次型形式给出：\n$$\nT = \\frac{1}{2}\\dot{q}^\\top M \\dot{q} \\quad \\text{和} \\quad V = \\frac{1}{2}q^\\top K q\n$$\n其中 $M$ 是对称正定质量矩阵，$K$ 是对称正定刚度矩阵。系统的拉格朗日量为 $L = T - V$。\n\n**1. 运动方程**\n\n系统的动力学由欧拉-拉格朗日方程决定：\n$$\n\\frac{d}{dt}\\left(\\frac{\\partial L}{\\partial \\dot{q}_k}\\right) - \\frac{\\partial L}{\\partial q_k} = 0, \\quad k=1,2,3\n$$\n其中 $q_k$ 是向量 $q$ 的第 $k$ 个分量。\n\n我们以向量形式计算所需的偏导数。拉格朗日量为：\n$$\nL(q, \\dot{q}) = \\frac{1}{2}\\sum_{i,j} M_{ij}\\dot{q}_i\\dot{q}_j - \\frac{1}{2}\\sum_{i,j} K_{ij}q_i q_j\n$$\n\n关于 $\\dot{q}_k$ 的偏导数为：\n$$\n\\frac{\\partial L}{\\partial \\dot{q}_k} = \\frac{\\partial}{\\partial \\dot{q}_k} \\left(\\frac{1}{2}\\sum_{i,j} M_{ij}\\dot{q}_i\\dot{q}_j\\right) = \\frac{1}{2}\\sum_{i,j} M_{ij}(\\delta_{ik}\\dot{q}_j + \\dot{q}_i\\delta_{jk}) = \\frac{1}{2}\\left(\\sum_j M_{kj}\\dot{q}_j + \\sum_i M_{ik}\\dot{q}_i\\right)\n$$\n由于 $M$ 是对称的（$M_{ij} = M_{ji}$），这可以简化为 $\\sum_j M_{kj}\\dot{q}_j$。在矩阵表示法中，这是向量 $M\\dot{q}$ 的第 $k$ 个分量。因此，$\\frac{\\partial L}{\\partial \\dot{q}} = M\\dot{q}$。\n\n求全时间导数，并注意到 $M$ 是一个常数矩阵：\n$$\n\\frac{d}{dt}\\left(\\frac{\\partial L}{\\partial \\dot{q}}\\right) = \\frac{d}{dt}(M\\dot{q}) = M\\ddot{q}\n$$\n\n关于 $q_k$ 的偏导数为：\n$$\n\\frac{\\partial L}{\\partial q_k} = -\\frac{\\partial V}{\\partial q_k} = -\\frac{\\partial}{\\partial q_k} \\left(\\frac{1}{2}\\sum_{i,j} K_{ij}q_i q_j\\right) = -\\frac{1}{2}\\left(\\sum_j K_{kj}q_j + \\sum_i K_{ik}q_i\\right)\n$$\n由于 $K$ 是对称的（$K_{ij} = K_{ji}$），这可以简化为 $-\\sum_j K_{kj}q_j$。在矩阵表示法中，这是向量 $-Kq$ 的第 $k$ 个分量。因此，$\\frac{\\partial L}{\\partial q} = -Kq$。\n\n将这些代入向量形式的欧拉-拉格朗日方程，得到：\n$$\nM\\ddot{q} - (-Kq) = 0 \\implies M\\ddot{q} + Kq = 0\n$$\n这是描述系统微小振动的耦合线性常微分方程组。\n\n**2. 简正模分析**\n\n简正模是同步解，其中系统的所有部分都以相同的频率和相位振动。我们寻求以下形式的解：\n$$\nq(t) = \\phi \\cos(\\omega t + \\delta)\n$$\n其中 $\\phi \\in \\mathbb{R}^3$ 是常数模态振型向量，$\\omega$ 是角频率，$\\delta$ 是相位常数。不失一般性，我们可以设 $\\delta=0$（或使用复指数表示 $q(t) = \\text{Re}(\\phi e^{i\\omega t})$）。我们使用 $q(t) = \\phi \\cos(\\omega t)$。\n\n其导数为：\n$$\n\\dot{q}(t) = -\\omega \\phi \\sin(\\omega t)\n$$\n$$\n\\ddot{q}(t) = -\\omega^2 \\phi \\cos(\\omega t) = -\\omega^2 q(t)\n$$\n\n将 $\\ddot{q}(t) = -\\omega^2 q(t)$ 代入运动方程：\n$$\nM(-\\omega^2 q(t)) + Kq(t) = 0 \\implies (K - \\omega^2 M)q(t) = 0\n$$\n代入 $q(t) = \\phi \\cos(\\omega t)$:\n$$\n(K - \\omega^2 M)\\phi \\cos(\\omega t) = 0\n$$\n对于非平凡解，该方程必须对所有 $t$ 成立，且 $\\phi$ 不能是零向量。这要求括号中的项为零：\n$$\n(K - \\omega^2 M)\\phi = 0 \\implies K\\phi = \\omega^2 M\\phi\n$$\n这是关于特征对 $(\\omega^2, \\phi)$ 的广义特征值问题。特征值 $\\lambda_i = \\omega_i^2$ 给出简正模频率的平方，相应的特征向量 $\\phi_i$ 是简正模振型。\n\n**3. 本征模的 M-正交性**\n\n设 $(\\omega_i^2, \\phi_i)$ 和 $(\\omega_j^2, \\phi_j)$ 为系统的两个特征对，且特征值不同，即 $\\omega_i^2 \\neq \\omega_j^2$。它们满足：\n1. $K\\phi_i = \\omega_i^2 M\\phi_i$\n2. $K\\phi_j = \\omega_j^2 M\\phi_j$\n\n用 $\\phi_j^\\top$ 左乘方程 (1)：\n$$\n\\phi_j^\\top K \\phi_i = \\omega_i^2 \\phi_j^\\top M \\phi_i\n$$\n对对方程 (2) 取转置。由于 $K$ 和 $M$ 是对称的（$K=K^\\top$, $M=M^\\top$）：\n$$\n(K\\phi_j)^\\top = (\\omega_j^2 M\\phi_j)^\\top \\implies \\phi_j^\\top K^\\top = \\omega_j^2 \\phi_j^\\top M^\\top \\implies \\phi_j^\\top K = \\omega_j^2 \\phi_j^\\top M\n$$\n用 $\\phi_i$ 右乘此结果：\n$$\n\\phi_j^\\top K \\phi_i = \\omega_j^2 \\phi_j^\\top M \\phi_i\n$$\n通过令 $\\phi_j^\\top K \\phi_i$ 的两个表达式相等，我们得到：\n$$\n\\omega_i^2 \\phi_j^\\top M \\phi_i = \\omega_j^2 \\phi_j^\\top M \\phi_i \\implies (\\omega_i^2 - \\omega_j^2)(\\phi_j^\\top M \\phi_i) = 0\n$$\n由于特征值不同，$\\omega_i^2 \\neq \\omega_j^2$，所以第一项非零。因此，第二项必须为零：\n$$\n\\phi_j^\\top M \\phi_i = 0\n$$\n这个关系式 $\\langle \\phi_i, \\phi_j \\rangle_M = 0$ (当 $i \\neq j$ 时) 即为特征向量关于质量矩阵 $M$ 的正交性（M-正交性）。\n\n对于问题的数值部分，我们将为每个测试用例构建 $M$ 和 $K$ 矩阵，使用数值库求解广义特征值问题 $K\\phi=\\omega^2 M\\phi$，对所得特征向量进行归一化使得 $\\phi_i^\\top M \\phi_i = 1$，并数值验证 M-正交性。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef solve():\n    \"\"\"\n    Solves the normal mode problem for three different parameter sets of a\n    three-degree-of-freedom mechanical system.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"comment\": \"Case A (baseline, diagonal mass)\",\n            \"M_params\": (1.5e-3, 1.0e-3, 1.2e-3), # (m1, m2, m3)\n            \"K_params\": (120, 80, 100, 300, 200, 50) # (kg1, kg2, kg3, k12, k23, k13)\n        },\n        {\n            \"comment\": \"Case B (inertial coupling, symmetric mass)\",\n            \"M_params\": (1.2e-3, 1.6e-3, 1.1e-3, 1.0e-5, 0.8e-5), # (m1, m2, m3, c12, c23)\n            \"K_params\": (90, 120, 110, 400, 350, 70) # (kg1, kg2, kg3, k12, k23, k13)\n        },\n        {\n            \"comment\": \"Case C (near-degenerate spectrum, weak inertial coupling)\",\n            \"M_params\": (1.0e-3, 1.0e-3, 1.1e-3, 2.0e-6, 2.0e-6), # (m1, m2, m3, c12, c23)\n            \"K_params\": (60, 60, 60, 100, 100, 0) # (kg1, kg2, kg3, k12, k23, k13)\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        M_params = case[\"M_params\"]\n        K_params = case[\"K_params\"]\n        \n        # Construct the mass matrix M\n        if len(M_params) == 3: # Diagonal mass matrix (Case A)\n            m1, m2, m3 = M_params\n            M = np.diag([m1, m2, m3])\n        else: # Symmetric mass matrix with inertial coupling (Cases B, C)\n            m1, m2, m3, c12, c23 = M_params\n            M = np.array([\n                [m1, c12, 0],\n                [c12, m2, c23],\n                [0, c23, m3]\n            ])\n\n        # Construct the stiffness matrix K\n        kg1, kg2, kg3, k12, k23, k13 = K_params\n        K = np.array([\n            [kg1 + k12 + k13, -k12, -k13],\n            [-k12, kg2 + k12 + k23, -k23],\n            [-k13, -k23, kg3 + k23 + k13]\n        ])\n\n        # 1. Solve the generalized eigenvalue problem K*phi = omega^2 * M*phi\n        # scipy.linalg.eigh is used for symmetric/Hermitian matrices.\n        # It returns eigenvalues sorted in ascending order.\n        eigenvalues, eigenvectors = eigh(K, M)\n\n        # 2. Compute angular frequencies\n        # Frequencies are sorted automatically as eigenvalues are sorted.\n        angular_frequencies = np.sqrt(eigenvalues)\n\n        # 3. Normalize eigenvectors such that phi_i^T * M * phi_i = 1\n        normalized_eigenvectors = []\n        for i in range(eigenvectors.shape[1]):\n            v = eigenvectors[:, i]\n            # M-norm squared: v.T @ M @ v\n            norm_factor_sq = v.T.dot(M.dot(v))\n            # Normalize vector\n            normalized_v = v / np.sqrt(norm_factor_sq)\n            normalized_eigenvectors.append(normalized_v)\n        \n        # Matrix of normalized eigenvectors\n        Phi = np.column_stack(normalized_eigenvectors)\n\n        # 4. Verify orthogonality\n        # S = Phi^T * M * Phi. Should be the identity matrix.\n        S = Phi.T.dot(M.dot(Phi))\n        \n        # Check if the maximum absolute off-diagonal element is below the tolerance.\n        S_off_diagonal = S.copy()\n        np.fill_diagonal(S_off_diagonal, 0.0)\n        max_off_diagonal_abs = np.max(np.abs(S_off_diagonal))\n        \n        tolerance = 1e-9\n        is_orthogonal = max_off_diagonal_abs  tolerance\n\n        # Format the results as per requirements\n        rounded_frequencies = [round(w, 6) for w in angular_frequencies]\n        case_result = rounded_frequencies + [is_orthogonal]\n        results.append(case_result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "上一个练习中得到的振动频率不仅仅是理论上的概念，它们直接决定了数值模拟的实际限制。本练习将分析广泛使用的 Störmer-Verlet 积分算法的稳定性，揭示系统的最快内部运动（最高频率 $\\omega_0$）如何对模拟的时间步长 $\\Delta t$ 施加严格的上限 。这项实践将理论力学与多尺度模拟的计算现实直接联系起来。",
            "id": "3796146",
            "problem": "在一个多尺度材料模拟中，考虑一个键合二聚体，它被用作一个粗粒化代理，来代表嵌入在更大分子动力学（MD）区域中的刚性原子相互作用。这两个粗粒化位点具有质量 $m_{1}$ 和 $m_{2}$，并通过一个刚度为 $k_{b}$ 的谐波键合势相互作用，使得储存在键中的细尺度能量由键伸长的二次型表示。将该二聚体建模为一个孤立的哈密顿子系统，其正则坐标为 $(x_{1},p_{1})$ 和 $(x_{2},p_{2})$，其哈密顿量包括每个质量的动能和一个取决于键伸长量 $x_{2}-x_{1}$ 的谐波势。假设在 MD 求解器中，对此键合相互作用的显式时间积分是使用直接应用于该子系统正则运动方程的 Störmer–Verlet（也称为速度 Verlet）辛算法来执行的。利用经典拉格朗日和哈密顿力学的第一性原理，在一个能够捕捉刚性键合振动的单一内坐标中重新表述动力学，推导出 Störmer–Verlet 算法的相关线性离散更新映射，并通过确定单步递推的放大因子对此映射进行线性稳定性分析。根据此分析，确定显式积分的最大稳定时间步长，并以 $m_{1}$、$m_{2}$ 和 $k_{b}$ 的闭式解析表达式表示。\n\n您的答案只需提供最大稳定时间步长的最终表达式。您不需要代入数值或包含单位。取整说明不适用。",
            "solution": "问题陈述需经过验证。\n\n### 步骤1：提取已知条件\n-   系统是一个键合二聚体，包含两个粗粒化位点，质量分别为 $m_{1}$ 和 $m_{2}$。\n-   相互作用是刚度为 $k_{b}$ 的谐波键合势。\n-   势能是键伸长的二次型。\n-   系统被建模为一个孤立的哈密顿子系统，正则坐标为 $(x_{1},p_{1})$ 和 $(x_{2},p_{2})$。\n-   哈密顿量包含每个质量的动能以及一个依赖于键伸长量 $x_{2}-x_{1}$ 的谐波势。\n-   时间积分使用 Störmer–Verlet（速度 Verlet）辛算法执行。\n-   任务是：将动力学在一个单一内坐标中重新表述，推导 Störmer–Verlet 算法的离散更新映射，进行线性稳定性分析，并以 $m_{1}$、$m_{2}$ 和 $k_{b}$ 的闭式解析表达式求出最大稳定时间步长 $\\Delta t$。\n\n### 步骤2：使用提取的已知条件进行验证\n-   **科学依据**：该问题是计算经典力学中的一个标准练习，特别是关于分子动力学数值积分器的分析。模型（谐波二聚体）和算法（Störmer-Verlet）是该领域的基本概念。其原理是公认的。\n-   **适定性**：问题定义清晰。参数已给出，目标是根据这些参数找到一个特定量（$\\Delta t_{max}$）。存在一个唯一、稳定且有意义的解。\n-   **客观性**：语言精确且无偏见。所有术语如“谐波势”、“Störmer-Verlet”和“线性稳定性分析”都有严格的数学定义。\n-   问题是自洽且一致的。它没有表现出验证标准中列出的任何缺陷。它与多尺度模拟中的经典力学主题直接相关。\n\n### 步骤3：结论与行动\n问题有效。将提供一个完整的、有理有据的解答。\n\n### 解答\n系统由两个粒子组成，质量分别为 $m_{1}$ 和 $m_{2}$，位置分别为 $x_{1}$ 和 $x_{2}$。哈密顿量由下式给出\n$$\nH(x_{1}, p_{1}, x_{2}, p_{2}) = \\frac{p_{1}^{2}}{2m_{1}} + \\frac{p_{2}^{2}}{2m_{2}} + V(x_{2}-x_{1})\n$$\n其中势能 $V$ 是键伸长的谐波函数。设平衡键长为 $l_{0}$。势能为 $V = \\frac{1}{2} k_{b} (x_{2}-x_{1}-l_{0})^{2}$。\n\n通过变换到质心坐标和相对坐标，可以分离出刚性键合振动问题。质心为 $X = \\frac{m_{1}x_{1} + m_{2}x_{2}}{m_{1}+m_{2}}$，相对坐标为 $q = x_{2}-x_{1}$。由于系统是孤立的，质心的运动是自由粒子的运动。内部振动的动力学由相对坐标 $q$ 控制。\n\n系统的动能可以分解为质心运动和相对运动的贡献：\n$$\nT = \\frac{1}{2} (m_{1}+m_{2}) \\dot{X}^{2} + \\frac{1}{2} \\mu \\dot{q}^{2}\n$$\n其中 $\\mu = \\frac{m_{1}m_{2}}{m_{1}+m_{2}}$ 是二聚体的折合质量。\n\n势能仅取决于相对坐标 $q$。令 $r = q - l_{0}$ 为键长与其平衡值的偏差。那么 $\\dot{r} = \\dot{q}$，势能为 $V(r) = \\frac{1}{2}k_{b}r^{2}$。内部振动自由度的拉格朗日量为\n$$\nL_{r}(\\dot{r}, r) = \\frac{1}{2}\\mu \\dot{r}^{2} - \\frac{1}{2}k_{b}r^{2}\n$$\n欧拉-拉格朗日方程 $\\frac{d}{dt}\\frac{\\partial L_{r}}{\\partial \\dot{r}} - \\frac{\\partial L_{r}}{\\partial r} = 0$ 得出内部振动的运动方程：\n$$\n\\mu \\ddot{r} + k_{b}r = 0\n$$\n这是一个简谐振子的方程，可以写成 $\\ddot{r} + \\omega_{0}^{2}r = 0$，其中 $\\omega_{0} = \\sqrt{\\frac{k_{b}}{\\mu}}$ 是振动的固有频率。\n\n我们现在分析 Störmer-Verlet（速度 Verlet）积分方案对此方程的稳定性。设 $r_{n}$ 和 $v_{n}$ 分别为时间 $t_{n} = n\\Delta t$ 时的位置和速度，其中 $\\Delta t$ 是时间步长。加速度为 $a_{n} = \\ddot{r}(t_{n}) = -\\omega_{0}^{2} r_{n}$。速度 Verlet 算法的步骤如下：\n1. 更新位置：$r_{n+1} = r_{n} + v_{n}\\Delta t + \\frac{1}{2}a_{n}(\\Delta t)^{2}$\n2. 计算新加速度：$a_{n+1} = -\\omega_{0}^{2}r_{n+1}$\n3. 更新速度：$v_{n+1} = v_{n} + \\frac{1}{2}(a_{n} + a_{n+1})\\Delta t$\n\n为了进行线性稳定性分析，我们将此更新表示为对状态向量 $\\mathbf{z}_{n} = \\begin{pmatrix} r_{n} \\\\ v_{n} \\end{pmatrix}$ 的矩阵变换。\n将 $a_{n} = -\\omega_{0}^{2} r_{n}$ 代入位置更新公式：\n$$\nr_{n+1} = r_{n} + v_{n}\\Delta t - \\frac{1}{2}\\omega_{0}^{2}r_{n}(\\Delta t)^{2} = \\left(1 - \\frac{\\omega_{0}^{2}(\\Delta t)^{2}}{2}\\right)r_{n} + (\\Delta t)v_{n}\n$$\n将 $a_{n}$ 和 $a_{n+1}$ 代入速度更新公式：\n$$\nv_{n+1} = v_{n} + \\frac{1}{2}(-\\omega_{0}^{2}r_{n} - \\omega_{0}^{2}r_{n+1})\\Delta t = v_{n} - \\frac{\\omega_{0}^{2}\\Delta t}{2}(r_{n} + r_{n+1})\n$$\n现在，将 $r_{n+1}$ 的表达式代入速度更新方程：\n$$\nv_{n+1} = v_{n} - \\frac{\\omega_{0}^{2}\\Delta t}{2}\\left(r_{n} + \\left(1 - \\frac{\\omega_{0}^{2}(\\Delta t)^{2}}{2}\\right)r_{n} + (\\Delta t)v_{n}\\right)\n$$\n$$\nv_{n+1} = v_{n} - \\frac{\\omega_{0}^{2}\\Delta t}{2}\\left(2 - \\frac{\\omega_{0}^{2}(\\Delta t)^{2}}{2}\\right)r_{n} - \\frac{\\omega_{0}^{2}(\\Delta t)^{2}}{2}v_{n}\n$$\n$$\nv_{n+1} = -\\left(\\omega_{0}^{2}\\Delta t - \\frac{\\omega_{0}^{4}(\\Delta t)^{3}}{4}\\right)r_{n} + \\left(1 - \\frac{\\omega_{0}^{2}(\\Delta t)^{2}}{2}\\right)v_{n}\n$$\n更新过程可以写成 $\\mathbf{z}_{n+1} = \\mathbf{A} \\mathbf{z}_{n}$，其中 $\\mathbf{A}$ 是放大矩阵（或转移矩阵）：\n$$\n\\mathbf{A} = \\begin{pmatrix} 1 - \\frac{\\omega_{0}^{2}(\\Delta t)^{2}}{2}  \\Delta t \\\\ -\\omega_{0}^{2}\\Delta t \\left(1 - \\frac{\\omega_{0}^{2}(\\Delta t)^{2}}{4}\\right)  1 - \\frac{\\omega_{0}^{2}(\\Delta t)^{2}}{2} \\end{pmatrix}\n$$\n为使数值积分稳定，放大矩阵 $\\mathbf{A}$ 的特征值 $\\lambda$ 的模必须小于或等于 1，即 $|\\lambda| \\leq 1$。特征值是特征方程 $\\det(\\mathbf{A} - \\lambda \\mathbf{I}) = 0$ 的根。\n特征方程为 $\\lambda^{2} - \\mathrm{Tr}(\\mathbf{A})\\lambda + \\det(\\mathbf{A}) = 0$。\n$\\mathbf{A}$ 的迹为：\n$$\n\\mathrm{Tr}(\\mathbf{A}) = \\left(1 - \\frac{\\omega_{0}^{2}(\\Delta t)^{2}}{2}\\right) + \\left(1 - \\frac{\\omega_{0}^{2}(\\Delta t)^{2}}{2}\\right) = 2 - \\omega_{0}^{2}(\\Delta t)^{2}\n$$\n$\\mathbf{A}$ 的行列式为：\n$$\n\\det(\\mathbf{A}) = \\left(1 - \\frac{\\omega_{0}^{2}(\\Delta t)^{2}}{2}\\right)^{2} - (\\Delta t)\\left(-\\omega_{0}^{2}\\Delta t \\left(1 - \\frac{\\omega_{0}^{2}(\\Delta t)^{2}}{4}\\right)\\right)\n$$\n$$\n\\det(\\mathbf{A}) = 1 - \\omega_{0}^{2}(\\Delta t)^{2} + \\frac{\\omega_{0}^{4}(\\Delta t)^{4}}{4} + \\omega_{0}^{2}(\\Delta t)^{2} - \\frac{\\omega_{0}^{4}(\\Delta t)^{4}}{4} = 1\n$$\n正如对线性系统应用辛积分器所预期的那样，行列式为 $1$。特征方程变为 $\\lambda^{2} - (2 - \\omega_{0}^{2}(\\Delta t)^{2})\\lambda + 1 = 0$。\n根为 $\\lambda_{\\pm} = \\frac{(2 - \\omega_{0}^{2}(\\Delta t)^{2}) \\pm \\sqrt{(2 - \\omega_{0}^{2}(\\Delta t)^{2})^{2} - 4}}{2}$。\n为使根的模为 $|\\lambda|=1$（中性稳定），判别式必须为非正：\n$$\n(2 - \\omega_{0}^{2}(\\Delta t)^{2})^{2} - 4 \\leq 0\n$$\n$$\n(2 - \\omega_{0}^{2}(\\Delta t)^{2})^{2} \\leq 4\n$$\n两边取平方根：\n$$\n|2 - \\omega_{0}^{2}(\\Delta t)^{2}| \\leq 2\n$$\n此不等式等价于 $-2 \\leq 2 - \\omega_{0}^{2}(\\Delta t)^{2} \\leq 2$。\n右边的不等式 $2 - \\omega_{0}^{2}(\\Delta t)^{2} \\leq 2$ 意味着 $-\\omega_{0}^{2}(\\Delta t)^{2} \\leq 0$，这总是成立的。\n左边的不等式 $-2 \\leq 2 - \\omega_{0}^{2}(\\Delta t)^{2}$ 意味着 $\\omega_{0}^{2}(\\Delta t)^{2} \\leq 4$。\n由于 $\\omega_{0}$ 和 $\\Delta t$ 均为正，这给出了稳定性条件：\n$$\n\\omega_{0} \\Delta t \\leq 2\n$$\n因此，最大稳定时间步长 $\\Delta t_{max}$ 由等式给出：\n$$\n\\Delta t_{max} = \\frac{2}{\\omega_{0}}\n$$\n最后，我们用给定的参数 $m_{1}$、$m_{2}$ 和 $k_{b}$ 来表示这个结果。代入 $\\omega_{0} = \\sqrt{k_{b}/\\mu}$ 和 $\\mu = \\frac{m_{1}m_{2}}{m_{1}+m_{2}}$：\n$$\n\\Delta t_{max} = 2\\sqrt{\\frac{\\mu}{k_{b}}} = 2\\sqrt{\\frac{1}{k_{b}} \\frac{m_{1}m_{2}}{m_{1}+m_{2}}}\n$$\n这就是最大稳定时间步长的闭式解析表达式。",
            "answer": "$$\n\\boxed{2\\sqrt{\\frac{m_{1}m_{2}}{k_{b}(m_{1}+m_{2})}}}\n$$"
        }
    ]
}