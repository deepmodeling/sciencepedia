{
    "hands_on_practices": [
        {
            "introduction": "Understanding the connections between different formulations of classical mechanics is a cornerstone of advanced physical modeling. This exercise guides you through the process of deriving the equations of motion for a simple pendulum, a classic model for a constrained rotational degree of freedom. By starting from Cartesian coordinates and systematically building the Lagrangian, and then the Hamiltonian, you will solidify your understanding of generalized coordinates, the principle of stationary action, and the Legendre transformation. This practice  reinforces the fundamental equivalence of the Newtonian, Lagrangian, and Hamiltonian approaches.",
            "id": "3814041",
            "problem": "A coarse-grained element in multiscale materials simulation can often be represented by a single rotational degree of freedom subjected to a holonomic constraint. Consider a planar pendulum of length $l$ and mass $m$ attached to a frictionless pivot in a uniform gravitational field of magnitude $g$. The bob moves in a vertical plane, and the configuration can be described by the generalized coordinate $\\theta$, defined as the angle between the rod and the downward vertical. Take the zero of potential energy at the lowest point of the swing. Assume the rod is massless and rigid and the bob is a point mass.\n\nUsing only fundamental principles, namely Newton's second law, the definition of kinetic energy, holonomic constraints, the definition of generalized coordinates, and the principle of stationary action, carry out the following tasks:\n- Express the Cartesian coordinates of the bob as functions of $\\theta$ and $l$, and use time differentiation to obtain the velocity components.\n- Construct the kinetic energy $T$ and potential energy $U$ from these kinematic relations.\n- Form the Lagrangian $L = T - U$ in terms of $\\theta$ and $\\dot{\\theta}$.\n- Derive the equation of motion by applying the Euler–Lagrange equation to $L$.\n- Define the canonical momentum $p_{\\theta}$ and construct the Hamiltonian $H$ by a Legendre transform. Show that Hamilton's equations reproduce the same equation of motion obtained from the Euler–Lagrange equation and are equivalent to the tangential component of Newton's second law once the tension constraint force is eliminated.\n\nFor grading, report only the Lagrangian $L(\\theta,\\dot{\\theta})$ you obtain as a single closed-form expression. Do not include units inside the final boxed answer. If you choose to introduce any numerical constants, they must be exact; no rounding is required or permitted.",
            "solution": "The problem statement has been validated and is deemed sound. It presents a standard exercise in classical mechanics, specifically the application of Lagrangian and Hamiltonian formalisms to a simple pendulum. The givens are complete, consistent, and scientifically grounded. We may proceed with a full derivation.\n\nThe problem requires a systematic derivation starting from Cartesian coordinates and fundamental principles, leading to the Lagrangian, the equation of motion via the Euler-Lagrange equation, and a parallel derivation using the Hamiltonian formalism.\n\nLet us establish a coordinate system where the frictionless pivot is at the origin $(0, 0)$. We align the y-axis with the downward vertical direction and the x-axis horizontally. The generalized coordinate $\\theta$ is the angle the rod makes with this downward vertical y-axis.\n\n**1. Cartesian Coordinates and Velocity**\n\nThe position of the bob of mass $m$ at the end of the rod of length $l$ is given by its Cartesian coordinates $(x, y)$. From the geometric definition of $\\theta$:\n$$x(\\theta) = l \\sin(\\theta)$$\n$$y(\\theta) = l \\cos(\\theta)$$\nTo find the velocity components, we differentiate these expressions with respect to time $t$, using the chain rule ($\\dot{\\theta} = \\frac{d\\theta}{dt}$):\n$$\\dot{x} = \\frac{dx}{dt} = \\frac{d}{dt}(l \\sin(\\theta)) = l \\cos(\\theta) \\dot{\\theta}$$\n$$\\dot{y} = \\frac{dy}{dt} = \\frac{d}{dt}(l \\cos(\\theta)) = -l \\sin(\\theta) \\dot{\\theta}$$\n\n**2. Kinetic and Potential Energy**\n\nThe kinetic energy $T$ is given by $T = \\frac{1}{2} m v^2$, where $v^2 = \\dot{x}^2 + \\dot{y}^2$. Substituting the velocity components:\n$$T = \\frac{1}{2} m ( (l \\cos(\\theta) \\dot{\\theta})^2 + (-l \\sin(\\theta) \\dot{\\theta})^2 )$$\n$$T = \\frac{1}{2} m ( l^2 \\cos^2(\\theta) \\dot{\\theta}^2 + l^2 \\sin^2(\\theta) \\dot{\\theta}^2 )$$\n$$T = \\frac{1}{2} m l^2 \\dot{\\theta}^2 (\\cos^2(\\theta) + \\sin^2(\\theta))$$\nUsing the trigonometric identity $\\cos^2(\\theta) + \\sin^2(\\theta) = 1$, the kinetic energy simplifies to:\n$$T(\\dot{\\theta}) = \\frac{1}{2} m l^2 \\dot{\\theta}^2$$\nThe potential energy $U$ is due to the uniform gravitational field of magnitude $g$. The gravitational force is $\\vec{F}_g = m\\vec{g}$. In our coordinate system, $\\vec{g}$ points in the positive y-direction, so the force is $(0, mg)$. The potential energy $U$ is defined such that $\\vec{F}_g = -\\nabla U$. This gives $U = -mgy + C$, where $C$ is a constant of integration.\nThe problem specifies that the zero of potential energy is at the lowest point of the swing. This occurs when $\\theta = 0$, which corresponds to the position $y = l \\cos(0) = l$.\nSetting $U=0$ at $y=l$:\n$$0 = -mg(l) + C \\implies C = mgl$$\nThus, the potential energy as a function of $y$ is $U(y) = mg(l-y)$. Substituting $y = l \\cos(\\theta)$, we obtain the potential energy as a function of the generalized coordinate $\\theta$:\n$$U(\\theta) = mg(l - l \\cos(\\theta)) = mgl(1 - \\cos(\\theta))$$\n\n**3. Lagrangian Formulation**\n\nThe Lagrangian $L$ is defined as $L = T - U$.\n$$L(\\theta, \\dot{\\theta}) = \\frac{1}{2} m l^2 \\dot{\\theta}^2 - mgl(1 - \\cos(\\theta))$$\nThis is the required expression for the Lagrangian.\n\n**4. Euler-Lagrange Equation of Motion**\n\nThe equation of motion is derived from the Euler-Lagrange equation for the coordinate $\\theta$:\n$$\\frac{d}{dt}\\left(\\frac{\\partial L}{\\partial \\dot{\\theta}}\\right) - \\frac{\\partial L}{\\partial \\theta} = 0$$\nWe compute the required partial derivatives:\n$$\\frac{\\partial L}{\\partial \\dot{\\theta}} = \\frac{\\partial}{\\partial \\dot{\\theta}} \\left( \\frac{1}{2} m l^2 \\dot{\\theta}^2 - mgl(1 - \\cos(\\theta)) \\right) = m l^2 \\dot{\\theta}$$\n$$\\frac{\\partial L}{\\partial \\theta} = \\frac{\\partial}{\\partial \\theta} \\left( \\frac{1}{2} m l^2 \\dot{\\theta}^2 - mgl(1 - \\cos(\\theta)) \\right) = -mgl(0 - (-\\sin(\\theta))) = -mgl \\sin(\\theta)$$\nSubstituting these into the Euler-Lagrange equation:\n$$\\frac{d}{dt}(m l^2 \\dot{\\theta}) - (-mgl \\sin(\\theta)) = 0$$\n$$m l^2 \\ddot{\\theta} + mgl \\sin(\\theta) = 0$$\nDividing by $ml^2$ (since $m \\neq 0$ and $l \\neq 0$) yields the equation of motion:\n$$\\ddot{\\theta} + \\frac{g}{l} \\sin(\\theta) = 0$$\n\n**5. Hamiltonian Formulation**\n\nFirst, we define the canonical momentum $p_{\\theta}$ conjugate to the coordinate $\\theta$:\n$$p_{\\theta} = \\frac{\\partial L}{\\partial \\dot{\\theta}} = m l^2 \\dot{\\theta}$$\nThe Hamiltonian $H$ is constructed via the Legendre transformation of the Lagrangian: $H = p_{\\theta}\\dot{\\theta} - L$. To express $H$ as a function of the phase space variables $(\\theta, p_{\\theta})$, we must eliminate $\\dot{\\theta}$. From the definition of $p_{\\theta}$, we have $\\dot{\\theta} = \\frac{p_{\\theta}}{ml^2}$.\n$$H = p_{\\theta}\\left(\\frac{p_{\\theta}}{ml^2}\\right) - \\left( \\frac{1}{2} m l^2 \\left(\\frac{p_{\\theta}}{ml^2}\\right)^2 - mgl(1 - \\cos(\\theta)) \\right)$$\n$$H = \\frac{p_{\\theta}^2}{ml^2} - \\left( \\frac{1}{2} m l^2 \\frac{p_{\\theta}^2}{m^2 l^4} - mgl(1 - \\cos(\\theta)) \\right)$$\n$$H = \\frac{p_{\\theta}^2}{ml^2} - \\frac{p_{\\theta}^2}{2ml^2} + mgl(1 - \\cos(\\theta))$$\n$$H(\\theta, p_{\\theta}) = \\frac{p_{\\theta}^2}{2ml^2} + mgl(1 - \\cos(\\theta))$$\nNote that $H = T+U$, which is the total energy of the system.\n\n**6. Hamilton's Equations and Equivalence**\n\nHamilton's equations of motion are:\n$$\\dot{\\theta} = \\frac{\\partial H}{\\partial p_{\\theta}} \\quad \\text{and} \\quad \\dot{p}_{\\theta} = -\\frac{\\partial H}{\\partial \\theta}$$\nLet's compute these:\n$$\\dot{\\theta} = \\frac{\\partial}{\\partial p_{\\theta}} \\left( \\frac{p_{\\theta}^2}{2ml^2} + mgl(1 - \\cos(\\theta)) \\right) = \\frac{2p_{\\theta}}{2ml^2} = \\frac{p_{\\theta}}{ml^2}$$\nThis recovers the definition of the canonical momentum, $p_{\\theta} = m l^2 \\dot{\\theta}$.\n$$\\dot{p}_{\\theta} = -\\frac{\\partial}{\\partial \\theta} \\left( \\frac{p_{\\theta}^2}{2ml^2} + mgl(1 - \\cos(\\theta)) \\right) = -mgl(0 - (-\\sin(\\theta))) = -mgl \\sin(\\theta)$$\nTo obtain the second-order differential equation for $\\theta$, we differentiate $p_{\\theta} = ml^2 \\dot{\\theta}$ with respect to time, yielding $\\dot{p}_{\\theta} = ml^2 \\ddot{\\theta}$. Equating the two expressions for $\\dot{p}_{\\theta}$:\n$$ml^2 \\ddot{\\theta} = -mgl \\sin(\\theta)$$\n$$ml^2 \\ddot{\\theta} + mgl \\sin(\\theta) = 0 \\implies \\ddot{\\theta} + \\frac{g}{l} \\sin(\\theta) = 0$$\nThis is identical to the equation of motion derived from the Lagrangian formalism.\n\nFinally, we show its equivalence to the tangential component of Newton's second law, $\\vec{F}_{\\text{net}} = m\\vec{a}$.\nThe forces are tension $\\vec{F}_T$ (radial, towards the pivot) and gravity $\\vec{F}_g = (0, mg)$. In a polar basis $(\\hat{r}, \\hat{\\theta})$ centered at the pivot, with $\\hat{r}$ pointing from pivot to mass, $\\vec{F}_T = -|\\vec{F}_T|\\hat{r}$ and $\\vec{F}_g = (mg\\cos\\theta)\\hat{r} - (mg\\sin\\theta)\\hat{\\theta}$.\nThe acceleration in this basis for circular motion at radius $l$ is $\\vec{a} = -l\\dot{\\theta}^2\\hat{r} + l\\ddot{\\theta}\\hat{\\theta}$.\nThe tangential component of $\\vec{F}_{\\text{net}} = m\\vec{a}$ is $F_{\\text{net},\\theta} = m a_{\\theta}$.\nThe tension force $\\vec{F}_T$ is purely radial, so it has no tangential component. The tangential component of gravity is $-mg\\sin\\theta$.\nTherefore, we have:\n$$-mg\\sin\\theta = m(l\\ddot{\\theta})$$\n$$ml\\ddot{\\theta} + mg\\sin\\theta = 0 \\implies \\ddot{\\theta} + \\frac{g}{l}\\sin(\\theta) = 0$$\nThis confirms that the Lagrangian and Hamiltonian formalisms correctly reproduce Newton's law for the unconstrained degree of freedom, automatically eliminating the constraint force of tension.\nThe final task is to report the Lagrangian.",
            "answer": "$$\\boxed{\\frac{1}{2} m l^2 \\dot{\\theta}^2 - mgl(1 - \\cos(\\theta))}$$"
        },
        {
            "introduction": "Many complex systems in materials science, from crystal lattices to polymer chains, exhibit collective vibrations. Normal mode analysis is a powerful technique that decomposes these coupled motions into a set of independent harmonic oscillators, each with a characteristic frequency and shape. This practice  tasks you with applying the Lagrangian formalism to a small oscillating system to derive and solve the generalized eigenvalue problem, connecting the abstract mass ($M$) and stiffness ($K$) matrices to the physical normal modes and their frequencies. By working through this problem, you will develop the essential skill of diagnosing the vibrational behavior of a mechanical system.",
            "id": "3796152",
            "problem": "Consider a coarse-grained three-degree-of-freedom lattice representative of a multiscale materials system in small oscillations. The generalized coordinates are collected in the vector $q(t)\\in\\mathbb{R}^3$. The kinetic energy is $T=\\tfrac{1}{2}\\dot{q}^\\top M \\dot{q}$ and the potential energy is $V=\\tfrac{1}{2}q^\\top K q$, where $M\\in\\mathbb{R}^{3\\times 3}$ is the symmetric positive definite mass matrix and $K\\in\\mathbb{R}^{3\\times 3}$ is the symmetric positive definite stiffness matrix. Starting from the Lagrangian $L=T-V$, derive the equations of motion, and show that seeking normal mode solutions of the form $q(t)=\\phi\\cos(\\omega t)$ leads to the generalized eigenvalue problem $K\\phi=\\omega^2 M\\phi$. Establish the orthogonality of distinct eigenmodes with respect to the $M$-inner product, defined by $\\langle u,v\\rangle_M=u^\\top M v$. Then, for the parameter sets below, compute the normal mode frequencies and numerically verify the orthogonality with respect to the $M$-inner product.\n\nThe physical units must be respected throughout: masses are in kilograms ($\\mathrm{kg}$), stiffnesses are in newtons per meter ($\\mathrm{N/m}$), and angular frequencies must be reported in radians per second ($\\mathrm{rad/s}$). Angles, if any, must be in radians.\n\nFor each parameter set, construct $M$ and $K$ as follows. The mass matrix $M$ is either diagonal or weakly coupled (symmetric) to reflect inertial cross-coupling. The stiffness matrix is built from ground springs and pairwise couplings. Let $q=[q_1,q_2,q_3]^\\top$. The potential energy is\n$$\nV=\\tfrac{1}{2}k_{g1}q_1^2+\\tfrac{1}{2}k_{g2}q_2^2+\\tfrac{1}{2}k_{g3}q_3^2+\\tfrac{1}{2}k_{12}(q_1-q_2)^2+\\tfrac{1}{2}k_{23}(q_2-q_3)^2+\\tfrac{1}{2}k_{13}(q_1-q_3)^2,\n$$\nwhich yields the symmetric stiffness matrix\n$$\nK=\\begin{bmatrix}\nk_{g1}+k_{12}+k_{13} & -k_{12} & -k_{13} \\\\\n-k_{12} & k_{g2}+k_{12}+k_{23} & -k_{23} \\\\\n-k_{13} & -k_{23} & k_{g3}+k_{23}+k_{13}\n\\end{bmatrix}.\n$$\n\nTest Suite:\n- Case A (baseline, diagonal mass):\n  - Masses: $m_1=1.5\\times 10^{-3}\\ \\mathrm{kg}$, $m_2=1.0\\times 10^{-3}\\ \\mathrm{kg}$, $m_3=1.2\\times 10^{-3}\\ \\mathrm{kg}$.\n  - Stiffnesses: $k_{g1}=120\\ \\mathrm{N/m}$, $k_{g2}=80\\ \\mathrm{N/m}$, $k_{g3}=100\\ \\mathrm{N/m}$.\n  - Couplings: $k_{12}=300\\ \\mathrm{N/m}$, $k_{23}=200\\ \\mathrm{N/m}$, $k_{13}=50\\ \\mathrm{N/m}$.\n  - $M=\\mathrm{diag}(m_1,m_2,m_3)$.\n- Case B (inertial coupling, symmetric mass):\n  - Masses: $m_1=1.2\\times 10^{-3}\\ \\mathrm{kg}$, $m_2=1.6\\times 10^{-3}\\ \\mathrm{kg}$, $m_3=1.1\\times 10^{-3}\\ \\mathrm{kg}$.\n  - Inertial couplings: $c_{12}=1.0\\times 10^{-5}\\ \\mathrm{kg}$, $c_{23}=0.8\\times 10^{-5}\\ \\mathrm{kg}$.\n  - Stiffnesses: $k_{g1}=90\\ \\mathrm{N/m}$, $k_{g2}=120\\ \\mathrm{N/m}$, $k_{g3}=110\\ \\mathrm{N/m}$.\n  - Couplings: $k_{12}=400\\ \\mathrm{N/m}$, $k_{23}=350\\ \\mathrm{N/m}$, $k_{13}=70\\ \\mathrm{N/m}$.\n  - $M=\\begin{bmatrix} m_1 & c_{12} & 0 \\\\ c_{12} & m_2 & c_{23} \\\\ 0 & c_{23} & m_3 \\end{bmatrix}$.\n- Case C (near-degenerate spectrum, weak inertial coupling):\n  - Masses: $m_1=1.0\\times 10^{-3}\\ \\mathrm{kg}$, $m_2=1.0\\times 10^{-3}\\ \\mathrm{kg}$, $m_3=1.1\\times 10^{-3}\\ \\mathrm{kg}$.\n  - Inertial couplings: $c_{12}=2.0\\times 10^{-6}\\ \\mathrm{kg}$, $c_{23}=2.0\\times 10^{-6}\\ \\mathrm{kg}$.\n  - Stiffnesses: $k_{g1}=60\\ \\mathrm{N/m}$, $k_{g2}=60\\ \\mathrm{N/m}$, $k_{g3}=60\\ \\mathrm{N/m}$.\n  - Couplings: $k_{12}=100\\ \\mathrm{N/m}$, $k_{23}=100\\ \\mathrm{N/m}$, $k_{13}=0\\ \\mathrm{N/m}$.\n  - $M=\\begin{bmatrix} m_1 & c_{12} & 0 \\\\ c_{12} & m_2 & c_{23} \\\\ 0 & c_{23} & m_3 \\end{bmatrix}$.\n\nFor each case:\n1. Solve $K\\phi=\\omega^2 M\\phi$ to obtain three nonnegative eigenvalues $\\omega_i^2$ and corresponding eigenvectors $\\phi_i$.\n2. Compute the angular frequencies $\\omega_i=\\sqrt{\\omega_i^2}$ and sort them in ascending order. Express all frequencies in $\\mathrm{rad/s}$ and round each to six decimal places.\n3. Normalize the eigenvectors so that $\\phi_i^\\top M \\phi_i=1$ for each $i$.\n4. Verify orthogonality by computing the matrix $S=\\Phi^\\top M \\Phi$, where $\\Phi=[\\phi_1,\\phi_2,\\phi_3]$. Return a boolean indicating whether $\\max_{i\\neq j}|S_{ij}|<\\tau$ with tolerance $\\tau=10^{-9}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The result for each test case must be a list containing the three sorted angular frequencies in $\\mathrm{rad/s}$ followed by the orthogonality boolean, for example $[[\\omega_1,\\omega_2,\\omega_3,\\mathrm{bool}_A],[\\omega_1,\\omega_2,\\omega_3,\\mathrm{bool}_B],[\\omega_1,\\omega_2,\\omega_3,\\mathrm{bool}_C]]$.",
            "solution": "The problem requires a theoretical derivation of the equations of motion for a conservative mechanical system and its normal modes, followed by a numerical implementation to solve for these modes for specific parameter sets. The problem is scientifically grounded in classical Lagrangian mechanics, is well-posed, and provides all necessary information for a unique solution. Therefore, it is deemed a valid problem.\n\nThe solution is presented in two parts: first, the theoretical derivation as requested, and second, the numerical computation which will be implemented in the final code.\n\n### Theoretical Derivation\n\nThe system is described by a set of generalized coordinates $q(t) \\in \\mathbb{R}^3$. The kinetic and potential energies are given in quadratic form:\n$$\nT = \\frac{1}{2}\\dot{q}^\\top M \\dot{q} \\quad \\text{and} \\quad V = \\frac{1}{2}q^\\top K q\n$$\nwhere $M$ is the symmetric positive definite mass matrix and $K$ is the symmetric positive definite stiffness matrix. The Lagrangian of the system is $L = T - V$.\n\n**1. Equations of Motion**\n\nThe dynamics of the system are governed by the Euler-Lagrange equations:\n$$\n\\frac{d}{dt}\\left(\\frac{\\partial L}{\\partial \\dot{q}_k}\\right) - \\frac{\\partial L}{\\partial q_k} = 0, \\quad k=1,2,3\n$$\nwhere $q_k$ is the $k$-th component of the vector $q$.\n\nLet's compute the required partial derivatives in vector form. The Lagrangian is:\n$$\nL(q, \\dot{q}) = \\frac{1}{2}\\sum_{i,j} M_{ij}\\dot{q}_i\\dot{q}_j - \\frac{1}{2}\\sum_{i,j} K_{ij}q_i q_j\n$$\n\nThe partial derivative with respect to $\\dot{q}_k$ is:\n$$\n\\frac{\\partial L}{\\partial \\dot{q}_k} = \\frac{\\partial}{\\partial \\dot{q}_k} \\left(\\frac{1}{2}\\sum_{i,j} M_{ij}\\dot{q}_i\\dot{q}_j\\right) = \\frac{1}{2}\\sum_{i,j} M_{ij}(\\delta_{ik}\\dot{q}_j + \\dot{q}_i\\delta_{jk}) = \\frac{1}{2}\\left(\\sum_j M_{kj}\\dot{q}_j + \\sum_i M_{ik}\\dot{q}_i\\right)\n$$\nSince $M$ is symmetric ($M_{ij} = M_{ji}$), this simplifies to $\\sum_j M_{kj}\\dot{q}_j$. In matrix notation, this is the $k$-th component of the vector $M\\dot{q}$. Thus, $\\frac{\\partial L}{\\partial \\dot{q}} = M\\dot{q}$.\n\nTaking the total time derivative, and noting that $M$ is a matrix of constants:\n$$\n\\frac{d}{dt}\\left(\\frac{\\partial L}{\\partial \\dot{q}}\\right) = \\frac{d}{dt}(M\\dot{q}) = M\\ddot{q}\n$$\n\nThe partial derivative with respect to $q_k$ is:\n$$\n\\frac{\\partial L}{\\partial q_k} = -\\frac{\\partial V}{\\partial q_k} = -\\frac{\\partial}{\\partial q_k} \\left(\\frac{1}{2}\\sum_{i,j} K_{ij}q_i q_j\\right) = -\\frac{1}{2}\\left(\\sum_j K_{kj}q_j + \\sum_i K_{ik}q_i\\right)\n$$\nSince $K$ is symmetric ($K_{ij} = K_{ji}$), this simplifies to $-\\sum_j K_{kj}q_j$. In matrix notation, this is the $k$-th component of the vector $-Kq$. Thus, $\\frac{\\partial L}{\\partial q} = -Kq$.\n\nSubstituting these into the Euler-Lagrange equation in vector form yields:\n$$\nM\\ddot{q} - (-Kq) = 0 \\implies M\\ddot{q} + Kq = 0\n$$\nThis is the system of coupled linear ordinary differential equations describing the small oscillations of the system.\n\n**2. Normal Mode Analysis**\n\nNormal modes are synchronous solutions where all parts of the system oscillate with the same frequency and phase. We seek solutions of the form:\n$$\nq(t) = \\phi \\cos(\\omega t + \\delta)\n$$\nwhere $\\phi \\in \\mathbb{R}^3$ is the constant mode shape vector, $\\omega$ is the angular frequency, and $\\delta$ is a phase constant. Without loss of generality, we can set $\\delta=0$ (or use a complex exponential representation $q(t) = \\text{Re}(\\phi e^{i\\omega t})$). Let's use $q(t) = \\phi \\cos(\\omega t)$.\n\nThe derivatives are:\n$$\n\\dot{q}(t) = -\\omega \\phi \\sin(\\omega t)\n$$\n$$\n\\ddot{q}(t) = -\\omega^2 \\phi \\cos(\\omega t) = -\\omega^2 q(t)\n$$\n\nSubstituting $\\ddot{q}(t) = -\\omega^2 q(t)$ into the equation of motion:\n$$\nM(-\\omega^2 q(t)) + Kq(t) = 0 \\implies (K - \\omega^2 M)q(t) = 0\n$$\nSubstituting $q(t) = \\phi \\cos(\\omega t)$:\n$$\n(K - \\omega^2 M)\\phi \\cos(\\omega t) = 0\n$$\nFor a non-trivial solution, this equation must hold for all $t$, and $\\phi$ cannot be the zero vector. This requires the term in the parenthesis to be zero:\n$$\n(K - \\omega^2 M)\\phi = 0 \\implies K\\phi = \\omega^2 M\\phi\n$$\nThis is the generalized eigenvalue problem for the eigenpair $(\\omega^2, \\phi)$. The eigenvalues $\\lambda_i = \\omega_i^2$ give the squares of the normal mode frequencies, and the corresponding eigenvectors $\\phi_i$ are the normal mode shapes.\n\n**3. M-Orthogonality of Eigenmodes**\n\nLet $(\\omega_i^2, \\phi_i)$ and $(\\omega_j^2, \\phi_j)$ be two eigenpairs for the system, with distinct eigenvalues $\\omega_i^2 \\neq \\omega_j^2$. They satisfy:\n1. $K\\phi_i = \\omega_i^2 M\\phi_i$\n2. $K\\phi_j = \\omega_j^2 M\\phi_j$\n\nLeft-multiply equation (1) by $\\phi_j^\\top$:\n$$\n\\phi_j^\\top K \\phi_i = \\omega_i^2 \\phi_j^\\top M \\phi_i\n$$\nTake the transpose of equation (2). Since $K$ and $M$ are symmetric ($K=K^\\top$, $M=M^\\top$):\n$$\n(K\\phi_j)^\\top = (\\omega_j^2 M\\phi_j)^\\top \\implies \\phi_j^\\top K^\\top = \\omega_j^2 \\phi_j^\\top M^\\top \\implies \\phi_j^\\top K = \\omega_j^2 \\phi_j^\\top M\n$$\nRight-multiply this result by $\\phi_i$:\n$$\n\\phi_j^\\top K \\phi_i = \\omega_j^2 \\phi_j^\\top M \\phi_i\n$$\nBy equating the two expressions for $\\phi_j^\\top K \\phi_i$, we obtain:\n$$\n\\omega_i^2 \\phi_j^\\top M \\phi_i = \\omega_j^2 \\phi_j^\\top M \\phi_i \\implies (\\omega_i^2 - \\omega_j^2)(\\phi_j^\\top M \\phi_i) = 0\n$$\nSince the eigenvalues are distinct, $\\omega_i^2 \\neq \\omega_j^2$, so the first term is non-zero. Therefore, the second term must be zero:\n$$\n\\phi_j^\\top M \\phi_i = 0\n$$\nThis relation, $\\langle \\phi_i, \\phi_j \\rangle_M = 0$ for $i \\neq j$, is the property of orthogonality of the eigenvectors with respect to the mass matrix $M$ (M-orthogonality).\n\nFor the numerical part of the problem, we will construct the $M$ and $K$ matrices for each test case, solve the generalized eigenvalue problem $K\\phi=\\omega^2 M\\phi$ using a numerical library, normalize the resulting eigenvectors such that $\\phi_i^\\top M \\phi_i = 1$, and verify the M-orthogonality property numerically.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef solve():\n    \"\"\"\n    Solves the normal mode problem for three different parameter sets of a\n    three-degree-of-freedom mechanical system.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"comment\": \"Case A (baseline, diagonal mass)\",\n            \"M_params\": (1.5e-3, 1.0e-3, 1.2e-3), # (m1, m2, m3)\n            \"K_params\": (120, 80, 100, 300, 200, 50) # (kg1, kg2, kg3, k12, k23, k13)\n        },\n        {\n            \"comment\": \"Case B (inertial coupling, symmetric mass)\",\n            \"M_params\": (1.2e-3, 1.6e-3, 1.1e-3, 1.0e-5, 0.8e-5), # (m1, m2, m3, c12, c23)\n            \"K_params\": (90, 120, 110, 400, 350, 70) # (kg1, kg2, kg3, k12, k23, k13)\n        },\n        {\n            \"comment\": \"Case C (near-degenerate spectrum, weak inertial coupling)\",\n            \"M_params\": (1.0e-3, 1.0e-3, 1.1e-3, 2.0e-6, 2.0e-6), # (m1, m2, m3, c12, c23)\n            \"K_params\": (60, 60, 60, 100, 100, 0) # (kg1, kg2, kg3, k12, k23, k13)\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        M_params = case[\"M_params\"]\n        K_params = case[\"K_params\"]\n        \n        # Construct the mass matrix M\n        if len(M_params) == 3: # Diagonal mass matrix (Case A)\n            m1, m2, m3 = M_params\n            M = np.diag([m1, m2, m3])\n        else: # Symmetric mass matrix with inertial coupling (Cases B, C)\n            m1, m2, m3, c12, c23 = M_params\n            M = np.array([\n                [m1, c12, 0],\n                [c12, m2, c23],\n                [0, c23, m3]\n            ])\n\n        # Construct the stiffness matrix K\n        kg1, kg2, kg3, k12, k23, k13 = K_params\n        K = np.array([\n            [kg1 + k12 + k13, -k12, -k13],\n            [-k12, kg2 + k12 + k23, -k23],\n            [-k13, -k23, kg3 + k23 + k13]\n        ])\n\n        # 1. Solve the generalized eigenvalue problem K*phi = omega^2 * M*phi\n        # scipy.linalg.eigh is used for symmetric/Hermitian matrices.\n        # It returns eigenvalues sorted in ascending order.\n        eigenvalues, eigenvectors = eigh(K, M)\n\n        # 2. Compute angular frequencies\n        # Frequencies are sorted automatically as eigenvalues are sorted.\n        angular_frequencies = np.sqrt(eigenvalues)\n\n        # 3. Normalize eigenvectors such that phi_i^T * M * phi_i = 1\n        normalized_eigenvectors = []\n        for i in range(eigenvectors.shape[1]):\n            v = eigenvectors[:, i]\n            # M-norm squared: v.T @ M @ v\n            norm_factor_sq = v.T.dot(M.dot(v))\n            # Normalize vector\n            normalized_v = v / np.sqrt(norm_factor_sq)\n            normalized_eigenvectors.append(normalized_v)\n        \n        # Matrix of normalized eigenvectors\n        Phi = np.column_stack(normalized_eigenvectors)\n\n        # 4. Verify orthogonality\n        # S = Phi^T * M * Phi. Should be the identity matrix.\n        S = Phi.T.dot(M.dot(Phi))\n        \n        # Check if the maximum absolute off-diagonal element is below the tolerance.\n        S_off_diagonal = S.copy()\n        np.fill_diagonal(S_off_diagonal, 0.0)\n        max_off_diagonal_abs = np.max(np.abs(S_off_diagonal))\n        \n        tolerance = 1e-9\n        is_orthogonal = max_off_diagonal_abs  tolerance\n\n        # Format the results as per requirements\n        rounded_frequencies = [round(w, 6) for w in angular_frequencies]\n        case_result = rounded_frequencies + [is_orthogonal]\n        results.append(case_result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The theoretical equations of motion derived from Lagrangian or Hamiltonian mechanics are continuous in time, but computer simulations must solve them using discrete time steps. The choice of numerical integrator and time step size is critical for the accuracy and stability of any molecular dynamics simulation. This problem  delves into the linear stability analysis of the widely used Störmer-Verlet algorithm, a symplectic integrator. By analyzing a model of a stiff molecular bond, you will determine the maximum stable time step, providing a crucial link between the system's physical properties (mass and stiffness) and the practical limits of its numerical simulation.",
            "id": "3796146",
            "problem": "In a multiscale materials simulation, consider a bonded dimer used as a coarse-grained surrogate for a stiff atomistic interaction embedded in a larger Molecular Dynamics (MD) region. The two coarse-grained sites have masses $m_{1}$ and $m_{2}$ and interact via a harmonic bonded potential with stiffness $k_{b}$ so that the fine-scale energy stored in the bond is represented by a quadratic form in the bond stretch. Model the dimer as an isolated Hamiltonian subsystem with canonical coordinates $(x_{1},p_{1})$ and $(x_{2},p_{2})$ and a Hamiltonian comprising kinetic energy of each mass and a harmonic potential depending on the bond extension $x_{2}-x_{1}$. Assume that the explicit time integration in the MD solver for this bonded interaction is performed using the Störmer–Verlet (also called velocity Verlet) symplectic scheme applied directly to the canonical equations of motion for this subsystem. Using first principles of classical Lagrangian and Hamiltonian mechanics, reformulate the dynamics in a single internal coordinate that captures the stiff bonded vibration, derive the associated linear discrete update map for the Störmer–Verlet scheme, and perform a linear stability analysis of this map by determining the amplification factors of the one-step recurrence. From this analysis, determine the largest stable timestep for explicit integration as a closed-form analytic expression in terms of $m_{1}$, $m_{2}$, and $k_{b}$.\n\nProvide only the final expression for the maximum stable timestep as your answer. You do not need to substitute numerical values or include units. Round-off instructions are not applicable.",
            "solution": "The problem statement is subjected to validation.\n\n### Step 1: Extract Givens\n-   The system is a bonded dimer with two coarse-grained sites of masses $m_{1}$ and $m_{2}$.\n-   The interaction is a harmonic bonded potential with stiffness $k_{b}$.\n-   The potential energy is a quadratic form in the bond stretch.\n-   The system is modeled as an isolated Hamiltonian subsystem with canonical coordinates $(x_{1},p_{1})$ and $(x_{2},p_{2})$.\n-   The Hamiltonian consists of kinetic energy for each mass and a harmonic potential dependent on the bond extension $x_{2}-x_{1}$.\n-   Time integration is performed using the Störmer–Verlet (velocity Verlet) symplectic scheme.\n-   The task is to reformulate the dynamics into a single internal coordinate, derive the discrete update map for the Störmer–Verlet scheme, perform a linear stability analysis, and find the largest stable timestep $\\Delta t$ as a closed-form analytic expression in terms of $m_{1}$, $m_{2}$, and $k_{b}$.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem is a standard exercise in computational classical mechanics, specifically the analysis of numerical integrators for molecular dynamics. The model (a harmonic dimer) and the algorithm (Störmer-Verlet) are fundamental concepts in this field. The principles are well-established.\n-   **Well-Posed**: The problem is clearly defined. The parameters are given, and the objective is to find a specific quantity ($\\Delta t_{max}$) based on these parameters. A unique, stable, and meaningful solution exists.\n-   **Objective**: The language is precise and unbiased. All terms like \"harmonic potential\", \"Störmer-Verlet\", and \"linear stability analysis\" have rigorous mathematical definitions.\n-   The problem is self-contained and consistent. It does not exhibit any of the flaws listed in the validation criteria. It is directly relevant to the topic of classical mechanics within multiscale simulation.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete, reasoned solution will be provided.\n\n### Solution\nThe system consists of two particles with masses $m_{1}$ and $m_{2}$ at positions $x_{1}$ and $x_{2}$. The Hamiltonian is given by\n$$\nH(x_{1}, p_{1}, x_{2}, p_{2}) = \\frac{p_{1}^{2}}{2m_{1}} + \\frac{p_{2}^{2}}{2m_{2}} + V(x_{2}-x_{1})\n$$\nwhere the potential energy $V$ is a harmonic function of the bond extension. Let the equilibrium bond length be $l_{0}$. The potential is $V = \\frac{1}{2} k_{b} (x_{2}-x_{1}-l_{0})^{2}$.\n\nThe problem of the stiff bonded vibration can be isolated by transforming to center-of-mass and relative coordinates. The center of mass is $X = \\frac{m_{1}x_{1} + m_{2}x_{2}}{m_{1}+m_{2}}$ and the relative coordinate is $q = x_{2}-x_{1}$. The motion of the center of mass is that of a free particle, as the system is isolated. The dynamics of the internal vibration are governed by the relative coordinate $q$.\n\nThe kinetic energy of the system separates into contributions from the center-of-mass motion and the relative motion:\n$$\nT = \\frac{1}{2} (m_{1}+m_{2}) \\dot{X}^{2} + \\frac{1}{2} \\mu \\dot{q}^{2}\n$$\nwhere $\\mu = \\frac{m_{1}m_{2}}{m_{1}+m_{2}}$ is the reduced mass of the dimer.\n\nThe potential energy depends only on the relative coordinate $q$. Let $r = q - l_{0}$ be the deviation of the bond length from its equilibrium value. Then $\\dot{r} = \\dot{q}$, and the potential energy is $V(r) = \\frac{1}{2}k_{b}r^{2}$. The Lagrangian for the internal vibrational degree of freedom is\n$$\nL_{r}(\\dot{r}, r) = \\frac{1}{2}\\mu \\dot{r}^{2} - \\frac{1}{2}k_{b}r^{2}\n$$\nThe Euler-Lagrange equation, $\\frac{d}{dt}\\frac{\\partial L_{r}}{\\partial \\dot{r}} - \\frac{\\partial L_{r}}{\\partial r} = 0$, yields the equation of motion for the internal vibration:\n$$\n\\mu \\ddot{r} + k_{b}r = 0\n$$\nThis is the equation for a simple harmonic oscillator, which can be written as $\\ddot{r} + \\omega_{0}^{2}r = 0$, where $\\omega_{0} = \\sqrt{\\frac{k_{b}}{\\mu}}$ is the natural frequency of the vibration.\n\nWe now analyze the stability of the Störmer-Verlet (velocity Verlet) integration scheme for this equation. Let $r_{n}$ and $v_{n}$ be the position and velocity at time $t_{n} = n\\Delta t$, where $\\Delta t$ is the timestep. The acceleration is $a_{n} = \\ddot{r}(t_{n}) = -\\omega_{0}^{2} r_{n}$. The velocity Verlet algorithm proceeds as:\n1. Update position: $r_{n+1} = r_{n} + v_{n}\\Delta t + \\frac{1}{2}a_{n}(\\Delta t)^{2}$\n2. Calculate new acceleration: $a_{n+1} = -\\omega_{0}^{2}r_{n+1}$\n3. Update velocity: $v_{n+1} = v_{n} + \\frac{1}{2}(a_{n} + a_{n+1})\\Delta t$\n\nTo perform a linear stability analysis, we express this update as a matrix transformation on the state vector $\\mathbf{z}_{n} = \\begin{pmatrix} r_{n} \\\\ v_{n} \\end{pmatrix}$.\nSubstituting $a_{n} = -\\omega_{0}^{2} r_{n}$ into the position update:\n$$\nr_{n+1} = r_{n} + v_{n}\\Delta t - \\frac{1}{2}\\omega_{0}^{2}r_{n}(\\Delta t)^{2} = \\left(1 - \\frac{\\omega_{0}^{2}(\\Delta t)^{2}}{2}\\right)r_{n} + (\\Delta t)v_{n}\n$$\nSubstituting $a_{n}$ and $a_{n+1}$ into the velocity update:\n$$\nv_{n+1} = v_{n} + \\frac{1}{2}(-\\omega_{0}^{2}r_{n} - \\omega_{0}^{2}r_{n+1})\\Delta t = v_{n} - \\frac{\\omega_{0}^{2}\\Delta t}{2}(r_{n} + r_{n+1})\n$$\nNow, substitute the expression for $r_{n+1}$ into the velocity update equation:\n$$\nv_{n+1} = v_{n} - \\frac{\\omega_{0}^{2}\\Delta t}{2}\\left(r_{n} + \\left(1 - \\frac{\\omega_{0}^{2}(\\Delta t)^{2}}{2}\\right)r_{n} + (\\Delta t)v_{n}\\right)\n$$\n$$\nv_{n+1} = v_{n} - \\frac{\\omega_{0}^{2}\\Delta t}{2}\\left(2 - \\frac{\\omega_{0}^{2}(\\Delta t)^{2}}{2}\\right)r_{n} - \\frac{\\omega_{0}^{2}(\\Delta t)^{2}}{2}v_{n}\n$$\n$$\nv_{n+1} = -\\left(\\omega_{0}^{2}\\Delta t - \\frac{\\omega_{0}^{4}(\\Delta t)^{3}}{4}\\right)r_{n} + \\left(1 - \\frac{\\omega_{0}^{2}(\\Delta t)^{2}}{2}\\right)v_{n}\n$$\nThe update can be written as $\\mathbf{z}_{n+1} = \\mathbf{A} \\mathbf{z}_{n}$, where $\\mathbf{A}$ is the amplification matrix (or transfer matrix):\n$$\n\\mathbf{A} = \\begin{pmatrix} 1 - \\frac{\\omega_{0}^{2}(\\Delta t)^{2}}{2}  \\Delta t \\\\ -\\omega_{0}^{2}\\Delta t \\left(1 - \\frac{\\omega_{0}^{2}(\\Delta t)^{2}}{4}\\right)  1 - \\frac{\\omega_{0}^{2}(\\Delta t)^{2}}{2} \\end{pmatrix}\n$$\nFor the numerical integration to be stable, the eigenvalues $\\lambda$ of the amplification matrix $\\mathbf{A}$ must have a magnitude less than or equal to one, i.e., $|\\lambda| \\leq 1$. The eigenvalues are the roots of the characteristic equation $\\det(\\mathbf{A} - \\lambda \\mathbf{I}) = 0$.\nThe characteristic equation is $\\lambda^{2} - \\mathrm{Tr}(\\mathbf{A})\\lambda + \\det(\\mathbf{A}) = 0$.\nThe trace of $\\mathbf{A}$ is:\n$$\n\\mathrm{Tr}(\\mathbf{A}) = \\left(1 - \\frac{\\omega_{0}^{2}(\\Delta t)^{2}}{2}\\right) + \\left(1 - \\frac{\\omega_{0}^{2}(\\Delta t)^{2}}{2}\\right) = 2 - \\omega_{0}^{2}(\\Delta t)^{2}\n$$\nThe determinant of $\\mathbf{A}$ is:\n$$\n\\det(\\mathbf{A}) = \\left(1 - \\frac{\\omega_{0}^{2}(\\Delta t)^{2}}{2}\\right)^{2} - (\\Delta t)\\left(-\\omega_{0}^{2}\\Delta t \\left(1 - \\frac{\\omega_{0}^{2}(\\Delta t)^{2}}{4}\\right)\\right)\n$$\n$$\n\\det(\\mathbf{A}) = 1 - \\omega_{0}^{2}(\\Delta t)^{2} + \\frac{\\omega_{0}^{4}(\\Delta t)^{4}}{4} + \\omega_{0}^{2}(\\Delta t)^{2} - \\frac{\\omega_{0}^{4}(\\Delta t)^{4}}{4} = 1\n$$\nAs expected for a symplectic integrator applied to a linear system, the determinant is $1$. The characteristic equation becomes $\\lambda^{2} - (2 - \\omega_{0}^{2}(\\Delta t)^{2})\\lambda + 1 = 0$.\nThe roots are $\\lambda_{\\pm} = \\frac{(2 - \\omega_{0}^{2}(\\Delta t)^{2}) \\pm \\sqrt{(2 - \\omega_{0}^{2}(\\Delta t)^{2})^{2} - 4}}{2}$.\nFor the magnitudes of the roots to be $|\\lambda|=1$ (neutral stability), the discriminant must be non-positive:\n$$\n(2 - \\omega_{0}^{2}(\\Delta t)^{2})^{2} - 4 \\leq 0\n$$\n$$\n(2 - \\omega_{0}^{2}(\\Delta t)^{2})^{2} \\leq 4\n$$\nTaking the square root of both sides:\n$$\n|2 - \\omega_{0}^{2}(\\Delta t)^{2}| \\leq 2\n$$\nThis inequality is equivalent to $-2 \\leq 2 - \\omega_{0}^{2}(\\Delta t)^{2} \\leq 2$.\nThe right-hand side inequality, $2 - \\omega_{0}^{2}(\\Delta t)^{2} \\leq 2$, implies $-\\omega_{0}^{2}(\\Delta t)^{2} \\leq 0$, which is always true.\nThe left-hand side inequality, $-2 \\leq 2 - \\omega_{0}^{2}(\\Delta t)^{2}$, implies $\\omega_{0}^{2}(\\Delta t)^{2} \\leq 4$.\nSince $\\omega_{0}$ and $\\Delta t$ are positive, this gives the stability condition:\n$$\n\\omega_{0} \\Delta t \\leq 2\n$$\nThe largest stable timestep $\\Delta t_{max}$ is thus given by the equality:\n$$\n\\Delta t_{max} = \\frac{2}{\\omega_{0}}\n$$\nFinally, we express this result in terms of the given parameters $m_{1}$, $m_{2}$, and $k_{b}$. Substituting $\\omega_{0} = \\sqrt{k_{b}/\\mu}$ and $\\mu = \\frac{m_{1}m_{2}}{m_{1}+m_{2}}$:\n$$\n\\Delta t_{max} = 2\\sqrt{\\frac{\\mu}{k_{b}}} = 2\\sqrt{\\frac{1}{k_{b}} \\frac{m_{1}m_{2}}{m_{1}+m_{2}}}\n$$\nThis is the closed-form analytic expression for the maximum stable timestep.",
            "answer": "$$\n\\boxed{2\\sqrt{\\frac{m_{1}m_{2}}{k_{b}(m_{1}+m_{2})}}}\n$$"
        }
    ]
}