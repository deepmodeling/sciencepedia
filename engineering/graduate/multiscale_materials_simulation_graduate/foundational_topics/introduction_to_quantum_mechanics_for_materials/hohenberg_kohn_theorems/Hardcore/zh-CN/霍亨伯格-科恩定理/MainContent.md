## 引言
霍恩伯格-科恩（Hohenberg-Kohn, HK）定理是现代量子力学中一项革命性的理论成就，它为[密度泛函理论](@entry_id:139027)（DFT）——当今计算物理、[计算化学](@entry_id:143039)和材料科学领域最强大的工具之一——奠定了坚实的理论基石。传统量子力学方法依赖于求解[多体薛定谔方程](@entry_id:1127611)以获得系统的[波函数](@entry_id:201714)，但随着电子数量的增加，[波函数](@entry_id:201714)的维度呈指数级增长，导致所谓的“维度灾难”，使得精确求解变得几乎不可能。HK定理正是为了解决这一根本性难题而提出的，它大胆地断言，系统的所有基态性质都可以由一个简单得多的物理量——三维电子密度——唯一确定。

本文旨在深入剖析霍恩伯格-[科恩定理](@entry_id:143958)的深刻内涵及其广泛影响。在“原则与机理”一章中，我们将详细阐述两个HK定理的内容，通过严谨的[数学证明](@entry_id:137161)揭示其如何将电子密度确立为系统的基本变量，并探讨v-[可表示性](@entry_id:635277)等关键概念以及Levy-Lieb等后续的理论完善。接下来，在“应用与跨学科联系”一章中，我们将展示这些抽象的理论如何催生了实用的科恩-沈（Kohn-Sham）计算框架，并探讨其在[第一性原理分子动力学](@entry_id:1125018)、多尺度模拟以及处理自旋、磁场和有限温度等复杂物理情境中的核心作用。最后，通过“动手实践”环节，读者将有机会通过具体的计算问题，加深对HK定理适用边界和核心思想的理解。

## 原则与机理

在本章中，我们将深入探讨构成密度泛函理论（DFT）理论基石的Hohenberg-[Kohn定理](@entry_id:143958)。这些定理不仅为理论提供了严格的数学基础，而且从根本上改变了我们对多电子体系量子力学问题的看法。我们将从基本思想出发，逐步揭示这些定理的深刻内涵、内在机理及其形式上的完善过程。

### 基本变量：从[波函数](@entry_id:201714)到电子密度

在传统的量子力学方法中，一个包含 $N$ 个电子的系统由其总[波函数](@entry_id:201714) $\Psi$ 完全描述。这个[波函数](@entry_id:201714)是一个复杂的数学对象，它包含了系统中所有电子的位置（以及自旋）坐标。对于一个忽略自旋的 $N$ 电子体系，[波函数](@entry_id:201714)是 $3N$ 个空间变量的函数：$\Psi(\mathbf{r}_{1}, \mathbf{r}_{2}, \ldots, \mathbf{r}_{N})$。

这种描述方式的复杂性会随着电子数的增加而急剧增长。例如，考虑一个处于基态的孤立中性氪原子（Krypton），它有36个电子。要完全描述其（忽略自旋的）电子[波函数](@entry_id:201714)，我们需要一个依赖于 $3 \times 36 = 108$ 个独立空间变量的函数。求解这样一个[高维偏微分方程](@entry_id:750280)——即[多体薛定谔方程](@entry_id:1127611)——在计算上是一项几乎不可能完成的任务，这被称为“维度灾难”。

[密度泛函理论](@entry_id:139027)的革命性思想在于，它提出可以使用一个在物理上更直观、在数学上更简单的量来替代高维[波函数](@entry_id:201714)，这个量就是**电子密度** $n(\mathbf{r})$。电子密度是一个仅依赖于三个空间变量 $\mathbf{r} = (x, y, z)$ 的[标量场](@entry_id:151443)，无论系统包含多少电子。对于上述的氪原子，其电子密度 $n(\mathbf{r})$ 仍然只是一个三维空间中的函数。从108个变量到3个变量的缩减，是DFT理论在计算上取得成功的根本原因。 那么，这个简单的三维函数真的足以描述整个复杂的量子系统吗？Hohenberg-[Kohn定理](@entry_id:143958)给出了肯定的回答。

### 数学预备：函数与泛函

在深入探讨Hohenberg-[Kohn定理](@entry_id:143958)之前，我们必须澄清一个关键的数学概念：**函数（function）**与**泛函（functional）**的区别。

一个**函数**通常被理解为一个规则，它将一个或多个变量（例如一个空间点）映射到一个数值。例如，原子核对电子产生的外部静电势 $v(\mathbf{r})$ 是一个函数。对于空间中的每一个点 $\mathbf{r}$，它都给出一个对应的势能值。数学上，它可以表示为 $v: \mathbb{R}^{3} \to \mathbb{R}$。

而**泛函**则是一个“函数的函数”，即它的输入是整个函数，输出则是一个数值。在DFT中，总电子能量 $E[n]$ 就是一个电子密度 $n(\mathbf{r})$ 的泛函。它将一个描述电子在空间中分布的完[整函数](@entry_id:176232) $n(\mathbf{r})$ 作为输入，然后返回整个系统的总能量这个单一的标量值。我们用方括号 $E[n]$ 来表示能量是密度 $n$ 的泛函。 这种区别至关重要，因为Hohenberg-[Kohn定理](@entry_id:143958)的核心就是建立关于能量泛函及其性质的精确陈述。

### 第一Hohenberg-[Kohn定理](@entry_id:143958)：唯一性

第一Hohenberg-Kohn (HK) 定理奠定了电子密度作为基本变量的合法性。其核心内容可以表述为：

**对于一个处于非简并基态的N电子体系，其基态电子密度 $n_0(\mathbf{r})$ 唯一地决定了（除一个无关紧要的附加常数外）系统所处的外部势 $v(\mathbf{r})$。**

由于外部势 $v(\mathbf{r})$、电子数 $N$ 和电子间的相互作用（通常是[库仑相互作用](@entry_id:747947)，被认为是普适的）共同定义了系统的哈密顿量 $\hat{H}$，这一定理意味着基[态密度](@entry_id:147894) $n_0(\mathbf{r})$ 实际上决定了整个系统的哈密顿量，从而也唯一地决定了系统的基态[波函数](@entry_id:201714) $\Psi_0$ 以及所有其他基态性质。换言之，所有基态性质都是基态密度的唯一泛函。

这个看似惊人的结论可以通过一个优雅的[归谬法](@entry_id:276604)证明。该证明巧妙地运用了量子力学中的**变分原理**。

**证明**：
假设存在两个不同的外部势 $v_1(\mathbf{r})$ 和 $v_2(\mathbf{r})$，它们之间的差异不仅仅是一个常数（即 $v_1(\mathbf{r}) \neq v_2(\mathbf{r}) + \text{const}$），但它们却对应着完全相同的基[态密度](@entry_id:147894) $n_0(\mathbf{r})$。

1.  设这两个势对应的哈密顿量分别为 $\hat{H}_1$ 和 $\hat{H}_2$，基态[波函数](@entry_id:201714)为 $\Psi_1$ 和 $\Psi_2$，基态能量为 $E_1$ 和 $E_2$。
    $$ \hat{H}_1 = \hat{T} + \hat{W} + \hat{V}_1 $$
    $$ \hat{H}_2 = \hat{T} + \hat{W} + \hat{V}_2 $$
    其中 $\hat{T}$ 是[动能算符](@entry_id:265633)，$\hat{W}$ 是电子间相互作用算符，$\hat{V}_1$ 和 $\hat{V}_2$ 是外部势能算符。由于 $v_1$ 和 $v_2$ 不同，$\Psi_1$ 和 $\Psi_2$ 也必然是不同的[波函数](@entry_id:201714)。

2.  根据变分原理，将非基态[波函数](@entry_id:201714) $\Psi_2$ 作为哈密顿量 $\hat{H}_1$ 的[试探波函数](@entry_id:142892)，其[能量期望值](@entry_id:174035)必然严格大于 $\hat{H}_1$ 的基态能量 $E_1$（这里的严格大于号正是依赖于基态的非简并性）。
    $$ E_1 \lt \langle \Psi_2 | \hat{H}_1 | \Psi_2 \rangle = \langle \Psi_2 | \hat{H}_2 - \hat{V}_2 + \hat{V}_1 | \Psi_2 \rangle $$
    $$ E_1 \lt \langle \Psi_2 | \hat{H}_2 | \Psi_2 \rangle + \langle \Psi_2 | \hat{V}_1 - \hat{V}_2 | \Psi_2 \rangle $$
    因为 $\Psi_2$ 是 $\hat{H}_2$ 的基态，所以 $\langle \Psi_2 | \hat{H}_2 | \Psi_2 \rangle = E_2$。势能项的[期望值](@entry_id:150961)可以写成与密度的积分：
    $$ E_1 \lt E_2 + \int [v_1(\mathbf{r}) - v_2(\mathbf{r})] n_0(\mathbf{r}) d^3\mathbf{r} \quad (1) $$

3.  同理，将 $\Psi_1$ 作为 $\hat{H}_2$ 的[试探波函数](@entry_id:142892)：
    $$ E_2 \lt \langle \Psi_1 | \hat{H}_2 | \Psi_1 \rangle = \langle \Psi_1 | \hat{H}_1 - \hat{V}_1 + \hat{V}_2 | \Psi_1 \rangle $$
    $$ E_2 \lt E_1 + \int [v_2(\mathbf{r}) - v_1(\mathbf{r})] n_0(\mathbf{r}) d^3\mathbf{r} \quad (2) $$

4.  将不等式 (1) 和 (2) 相加，我们得到：
    $$ E_1 + E_2 \lt E_2 + E_1 + \int [v_1(\mathbf{r}) - v_2(\mathbf{r}) + v_2(\mathbf{r}) - v_1(\mathbf{r})] n_0(\mathbf{r}) d^3\mathbf{r} $$
    $$ E_1 + E_2 \lt E_1 + E_2 $$
    这个 $0 \lt 0$ 的结果是一个明显的矛盾。因此，我们最初的假设——两个不同的外部势可以产生相同的基[态密度](@entry_id:147894)——是错误的。

这个证明中，**基态非简并**的假设至关重要。因为如果基态是简并的，那么 $\Psi_2$ 有可能恰好也是 $\hat{H}_1$ 的一个基态[波函数](@entry_id:201714)（只是与 $\Psi_1$ 不同）。在这种情况下，[变分原理](@entry_id:198028)只保证 $E_1 \le \langle \Psi_2 | \hat{H}_1 | \Psi_2 \rangle$，等号是可能成立的，这就无法导出矛盾。 我们将在后面的进阶主题中讨论如何处理简并情况。

第一HK定理的一个直接而深刻的推论是，基态电子密度包含了系统的全部信息。例如，对于一个分子，外部势 $v(\mathbf{r})$ 是由其原子核的位置 $\{\mathbf{R}_\alpha\}$ 和电荷 $\{Z_\alpha\}$ 决定的[库仑势](@entry_id:154276)：
$$ v(\mathbf{r}) = \sum_{\alpha} \frac{-Z_\alpha e^2}{4\pi\epsilon_0 |\mathbf{r} - \mathbf{R}_\alpha|} $$
由于基[态密度](@entry_id:147894) $n_0(\mathbf{r})$ 唯一地确定了 $v(\mathbf{r})$，它也就唯一地确定了所有原子核的种类和空间排布。换句话说，仅通过观察电子云的分布，原则上我们就可以推断出其背后的整个分子骨架。例如，电子密度在原子核位置处会呈现出尖点（cusp），这些[尖点](@entry_id:636792)的形状和位置直接关联到核电荷和核位置。

### 第二Hohenberg-[Kohn定理](@entry_id:143958)：变分原理

第一HK定理确立了密度作为基本变量的地位，而第二HK定理则指明了如何利用这一变量来确定系统的基态能量。该定理陈述如下：

**存在一个普适的[能量泛函](@entry_id:170311) $F[n]$，它对于任何N电子体系都是相同的，与具体的外部势 $v(\mathbf{r})$ 无关。对于一个给定的外部势 $v(\mathbf{r})$，总能量泛函可以写为 $E_v[n] = F[n] + \int v(\mathbf{r}) n(\mathbf{r}) d^3\mathbf{r}$。对于任何满足基本物理约束（例如，$n(\mathbf{r}) \ge 0$ 且 $\int n(\mathbf{r})d^3\mathbf{r} = N$）的试探密度 $n(\mathbf{r})$，其计算出的能量值必然大于或等于真实的[基态能量](@entry_id:263704) $E_0$。等号仅在 $n(\mathbf{r})$ 等于真实的基态密度 $n_0(\mathbf{r})$ 时成立。**

$$ E_0 = \min_{n} E_v[n] = E_v[n_0] $$

这一定理本质上是一个针对电子密度的**变分原理**。它将求解[多体薛定谔方程](@entry_id:1127611)这个极其复杂的任务，转化为了一个在三维空间中寻找使能量[泛函最小化](@entry_id:184561)的密度函数的优化问题。

[普适泛函](@entry_id:140176) $F[n]$ 通常被认为包含了系统的动能 $T[n]$ 和[电子-电子相互作用](@entry_id:139900)能 $V_{ee}[n]$。它的“普适性”意味着，无论是氢原子、水分子还是[硅晶体](@entry_id:160659)，$F[n]$ 的数学形式都是完全一样的。

这一原理的意义是巨大的。设想一下，如果有一天理论物理学家发现并给出了 $F[n]$ 的精确解析形式，那么对于任何原子、分子或固体，只要我们知道其原子核构成的外部势 $v_{\text{ext}}(\mathbf{r})$，我们就可以通过最小化总能量泛函 $E_v[n]$ 来精确地计算出其基态电子密度 $n_0(\mathbf{r})$ 和[基态能量](@entry_id:263704) $E_0$。这将意味着我们从根本上解决了所有体系的基态[电子结构](@entry_id:145158)问题。 当然，现实是 $F[n]$ 的精确形式是未知的，整个DFT领域的中心任务就是为这个神秘的[普适泛函](@entry_id:140176)寻找并发展越来越精确的近似形式。

### 进阶主题与形式化完善

Hohenberg和Kohn的原始论文为DFT奠定了概念基础，但其中一些微妙的数学问题直到后来的工作中才得到严格处理。这些完善对于将DFT发展成一个严谨的理论框架至关重要。

#### v-[可表示性](@entry_id:635277)问题

在HK定理的原始表述中，存在一个隐含的但非常棘手的问题，即**v-[可表示性](@entry_id:635277) (v-representability)** 问题。

我们首先定义两个相关的概念：
- **[N-可表示性](@entry_id:189302) (N-representability)**：一个密度函数 $n(\mathbf{r})$ 如果可以由某个符合[反对称原理](@entry_id:137331)的 $N$ 电子[波函数](@entry_id:201714)（纯态或系综）产生，则称其为 N-可表示的。这通常只要求 $n(\mathbf{r}) \ge 0$ 且积分等于 $N$，外加一些保证动能有限的平滑性条件。这是一个相对宽松、易于检查的条件。

- **v-[可表示性](@entry_id:635277) (v-representability)**：一个密度函数 $n(\mathbf{r})$ 如果是某个外部势 $v(\mathbf{r})$ 下的**基态**密度，则称其为 v-可表示的。这是一个非常苛刻的条件。

HK[变分原理](@entry_id:198028)的搜索空间——即所有“可接受的”试探密度——应该是哪个集合？原始证明似乎暗示我们应该在所有 v-可表示的密度中进行搜索。但这带来了一个逻辑困境：为了知道一个密度是否 v-可表示，我们首先需要找到一个势使其成为基[态密度](@entry_id:147894)，但这几乎等同于解决了我们想要解决的问题。我们缺乏一个先验的、简单的判据来判断一个给定的试探密度是否 v-可表示。 这就是所谓的“v-[可表示性](@entry_id:635277)问题”。

#### [Levy-Lieb约束搜索](@entry_id:145975)与[普适泛函](@entry_id:140176)

对 v-[可表示性](@entry_id:635277)问题的优雅解决方案由M. Levy和E. Lieb提出，被称为**约[束搜索](@entry_id:634146) (constrained search)** 方法。它为[普适泛函](@entry_id:140176) $F[n]$ 提供了一个不依赖于 v-[可表示性](@entry_id:635277)的、具有建设性的定义。

[Levy-Lieb泛函](@entry_id:145888) $F[n]$ 定义为：
$$ F[n] = \inf_{\Psi \to n} \langle \Psi | \hat{T} + \hat{W} | \Psi \rangle $$
这个定义的含义是：对于一个给定的 N-可表示密度 $n(\mathbf{r})$，我们搜索所有能够产生该密度的[波函数](@entry_id:201714) $\Psi$，并找出其中使动能与[相互作用能](@entry_id:264333)之和 $\langle \Psi | \hat{T} + \hat{W} | \Psi \rangle$ 最小的那个值，该最小值就是 $F[n]$。

这个定义有几个巨大的优势：
1.  **定义域清晰**：$F[n]$ 的定义域被扩展到了所有 N-可表示密度，这是一个明确且易于描述的函数集合，从而彻底解决了 v-[可表示性](@entry_id:635277)问题。
2.  **普适性明确**：定义中完全没有外部势 $v(\mathbf{r})$ 的身影，其普适性是自洽的。
3.  **变分原理的严格化**：通过约[束搜索](@entry_id:634146)，可以严格证明，在所有 N-可表示密度上最小化 Levy-Lieb 能量泛函 $E_v[n]$，等价于在所有 N-电子[波函数](@entry_id:201714)上最小化哈密顿量的[期望值](@entry_id:150961)。即：
    $$ \min_{n \in \mathcal{D}_{N}} E_{v}[n] = \min_{\Psi \in \mathcal{W}_{N}} \langle \Psi | \hat{H}_{v} | \Psi \rangle = E_{0} $$
    这里 $\mathcal{D}_{N}$ 是 N-可表示密度集，$\mathcal{W}_{N}$ 是 N-电子[波函数](@entry_id:201714)集。这在两个看似不同的变分原理之间建立了一座坚实的桥梁。

这种严谨的定义对于现代DFT的应用，例如多尺度模拟，至关重要。在多尺度耦合中，从[粗粒化](@entry_id:141933)模型得到的电子密度可能不是任何一个简单势的基[态密度](@entry_id:147894)，但它仍然是 N-可表示的。有了Levy-Lieb的定义，我们依然可以为这个密度计算一个能量，并保证这个能量是真实[基态能量](@entry_id:263704)的一个[上界](@entry_id:274738)，从而实现能量守恒的、自洽的耦合。

#### 简并基态与系综

HK定理的原始证明依赖于基态非简并的假设。当系统由于对称性等原因出现基态简并时，情况会变得复杂。一个外部势 $v(\mathbf{r})$ 可能对应多个不同的基态[波函数](@entry_id:201714) $\{\Psi_i\}$，而这些[波函数](@entry_id:201714)可能产生不同的纯[态密度](@entry_id:147894) $\{n_i(\mathbf{r})\}$。此时，从势到密度的映射不再是单值的。

为了处理这种情况，需要将第一HK定理推广到**系综 (ensembles)**。我们可以定义一个系综基态密度，它是所有简并基态密度的加权平均：
$$ n(\mathbf{r}) = \sum_{i=1}^{g} w_i n_i(\mathbf{r}) \quad \left( w_i \ge 0, \sum_{i=1}^{g} w_i = 1 \right) $$
其中 $g$ 是[基态简并度](@entry_id:141614)。

经过推广后的第一HK定理指出：**任何一个系综基[态密度](@entry_id:147894) $n(\mathbf{r})$ 唯一地决定了（除一个附加常数外）外部势 $v(\mathbf{r})$**。证明思路与非简并情况类似，只需将[变分原理](@entry_id:198028)应用于系综的[密度算符](@entry_id:138151)即可，同样可以导出矛盾。 进一步地，Lieb的数学工作表明，通过将约[束搜索](@entry_id:634146)推广到系综（混合态），得到的泛函 $F[n]$ 具有良好的[凸性](@entry_id:138568)，这为变分原理的稳定性提供了重要的数学保证。

综上所述，Hohenberg-[Kohn定理](@entry_id:143958)及其后续的数学完善，共同构建了一个强大而严谨的理论框架。它将一个棘手的、高维的[量子多体问题](@entry_id:146763)，巧妙地转化为一个原则上可解的、在三维空间中对密度泛函进行优化的[变分问题](@entry_id:756445)，为过去半个世纪里计算物理、计算化学和材料科学的飞速发展开辟了道路。