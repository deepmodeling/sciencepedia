## 引言
[量子力学中的变分原理](@entry_id:184917)是现代[计算材料科学](@entry_id:1122793)的理论基石之一，为我们理解和预测物质的微观行为提供了强大而优雅的工具。对于任何包含多个相互作用粒子的真实材料体系，精确求解其薛定谔方程几乎是不可能的，这构成了[理论物理学](@entry_id:154070)和化学中的一个核心挑战。[变分原理](@entry_id:198028)恰好填补了这一空白，它将一个难以处理的[微分](@entry_id:158422)方程本征值问题，巧妙地转化为一个更易于管理的[函数最小化](@entry_id:138381)问题，从而为获得高精度的近似解开辟了道路。

本文旨在系统性地剖析[变分原理](@entry_id:198028)的内涵及其在[多尺度材料模拟](@entry_id:1128334)中的广泛应用。在接下来的内容中，我们将首先在“**原理与机制**”一章中，深入探讨变分原理的数学表述、瑞利-里兹方法，以及它如何推广至激发态并成为密度泛函理论（DFT）的理论基础。随后，在“**应用与跨学科交叉**”一章中，我们将展示该原理如何应用于处理[多体系统](@entry_id:144006)、计算晶体[电子结构](@entry_id:145158)，并从微观计算中提取宏观[材料性质](@entry_id:146723)，连接物理、化学与工程等多个学科。最后，“**动手实践**”部分将提供一系列计算练习，帮助读者将理论知识应用于解决实际的数值问题，加深对变分计算中核心挑战的理解。通过本次学习，读者将能够掌握[变分原理](@entry_id:198028)的精髓，并理解其在现代科学研究中的核心作用。

## 原理与机制

在“引言”章节之后，我们现在深入探讨变分原理的数学形式和物理内涵。本章将系统地阐述[量子力学中的变分原理](@entry_id:184917)，从其最基本的定理出发，逐步扩展到它在现代计算材料科学中的实际应用，包括其在求解激发态、处理[多体系统](@entry_id:144006)以及作为[密度泛函理论](@entry_id:139027)（DFT）的理论基石等方面的关键作用。

### 基态变分原理

量子力学的一个核心任务是求解定态薛定谔方程 $H|\psi\rangle = E|\psi\rangle$，其中 $H$ 是体系的哈密顿算符，其本征值 $E$ 对应体系的允许能级，[本征函数](@entry_id:154705) $|\psi\rangle$ 对应体系的定态[波函数](@entry_id:201714)。在[多尺度材料模拟](@entry_id:1128334)中，我们通常关心的是体系的基态性质，即最低[能量本征值](@entry_id:144381) $E_0$ 和对应的基态[波函数](@entry_id:201714) $|\psi_0\rangle$。然而，对于任何现实的材料体系，精确求解这个方程几乎是不可能的。变分原理为此提供了一个强大而灵活的近似途径。

变分原理的核心思想极为简洁而深刻。它指出，对于一个由厄米[哈密顿算符](@entry_id:144286) $H$ 描述的量子体系，其谱（[能量本征值](@entry_id:144381)集合）有下界，基态能量为 $E_0$。对于定义在 $H$ 算符定义域内的任意一个非零的“[试探波函数](@entry_id:142892)” $|\psi\rangle$，其能量的[期望值](@entry_id:150961)绝不会低于真实的[基态能量](@entry_id:263704) $E_0$。

为了更精确地表述，我们引入 **[瑞利商](@entry_id:137794)（Rayleigh Quotient）**，它定义为[试探函数](@entry_id:756165) $|\psi\rangle$ 下[哈密顿量](@entry_id:144286)的[期望值](@entry_id:150961)：

$E[\psi] = \frac{\langle\psi|H|\psi\rangle}{\langle\psi|\psi\rangle}$

变分原理可以表述为：

**对于任意非零[试探函数](@entry_id:756165) $|\psi\rangle$，[瑞利商](@entry_id:137794) $E[\psi]$ 总是真实[基态能量](@entry_id:263704) $E_0$ 的一个上界，即 $E[\psi] \ge E_0$。等号成立的充分必要条件是，[试探函数](@entry_id:756165) $|\psi\rangle$ 本身就是体系的一个基态[波函数](@entry_id:201714)（或者处于简并的基态子空间中）。** 

这个原理的证明是直观的。根据[谱定理](@entry_id:136620)，一个[厄米算符](@entry_id:153410) $H$ 拥有一套完备的、正交归一的[本征函数](@entry_id:154705)系 $\{|\phi_n\rangle\}$，其对应的本征值为 $\{E_n\}$，并且 $E_0 \le E_1 \le E_2 \le \dots$。任何一个[试探函数](@entry_id:756165) $|\psi\rangle$ 都可以用这个[完备基](@entry_id:143908)展开：

$|\psi\rangle = \sum_n c_n |\phi_n\rangle$

其中展开系数 $c_n = \langle\phi_n|\psi\rangle$。我们将这个展开式代入[瑞利商](@entry_id:137794)的表达式中。

分子项为：
$\langle\psi|H|\psi\rangle = \left\langle \sum_m c_m \phi_m \right| H \left| \sum_n c_n \phi_n \right\rangle = \sum_m \sum_n c_m^* c_n \langle\phi_m|H|\phi_n\rangle = \sum_m \sum_n c_m^* c_n E_n \delta_{mn} = \sum_n |c_n|^2 E_n$

分母项为：
$\langle\psi|\psi\rangle = \sum_m \sum_n c_m^* c_n \langle\phi_m|\phi_n\rangle = \sum_n |c_n|^2$

因此，[瑞利商](@entry_id:137794)可以写成所有能级的加权平均：
$E[\psi] = \frac{\sum_n |c_n|^2 E_n}{\sum_n |c_n|^2}$

由于 $E_n \ge E_0$ 对所有 $n$ 都成立，我们显然有：
$\sum_n |c_n|^2 E_n \ge \sum_n |c_n|^2 E_0 = E_0 \left( \sum_n |c_n|^2 \right)$

两边同除以 $\sum_n |c_n|^2$（对于非零函数，此项大于零），便得到 $E[\psi] \ge E_0$。

等号成立的条件是 $\sum_n |c_n|^2 (E_n - E_0) = 0$。因为求和的每一项都是非负的（$|c_n|^2 \ge 0$ 且 $E_n - E_0 \ge 0$），所以该式成立的唯一可能是，对于所有 $n$，只要 $|c_n|^2 \ne 0$，就必须有 $E_n - E_0 = 0$。这意味着[试探函数](@entry_id:756165) $|\psi\rangle$ 的展开式中只包含那些能量为 $E_0$ 的[本征态](@entry_id:149904)的贡献，换言之，$|\psi\rangle$ 必须位于基态子空间内。

值得注意的是，[瑞利商](@entry_id:137794)是[尺度不变的](@entry_id:178566)。如果将[试探函数](@entry_id:756165)乘以一个任意非零复数 $\alpha$，即 $|\psi'\rangle = \alpha|\psi\rangle$，[瑞利商](@entry_id:137794)的值保持不变。这意味着我们通常可以方便地使用归一化的[试探函数](@entry_id:756165)（$\langle\psi|\psi\rangle = 1$），此时 $E[\psi] = \langle\psi|H|\psi\rangle$。

### 瑞利-里兹方法：从原理到实践

变分原理的美妙之处在于它将一个困难的[微分](@entry_id:158422)方程[本征值问题](@entry_id:142153)，转化为一个相对容易处理的[函数最小化](@entry_id:138381)问题。我们可以通过构造一个依赖于一组参数 $\{\alpha_k\}$ 的[试探函数](@entry_id:756165)族 $|\psi(\{\alpha_k\})\rangle$，然后寻找使[能量期望值](@entry_id:174035) $E[\{\alpha_k\}]$ 最小的参数组合，从而得到基态能量 $E_0$ 的最佳近似值。

在计算科学中，最常用和最系统的方法是**瑞利-里兹（Rayleigh-Ritz）方法**。该方法的核心思想是将无限维的希尔伯特空间限制在一个有限维的子空间中进行变分。我们选取一组[线性无关](@entry_id:148207)的 **基函数** $\{\phi_i\}_{i=1}^N$，并在这个由基函数张成的子空间中寻找最优的[试探函数](@entry_id:756165)。任何该子空间中的[试探函数](@entry_id:756165)都可以写成基函数的线性组合：

$|\psi\rangle = \sum_{i=1}^N c_i |\phi_i\rangle$

这里的变分参数就是展开系数 $\{c_i\}$。现在，我们的任务是找到一组系数 $\{c_i\}$，使得[瑞利商](@entry_id:137794) $E[\{c_i\}]$ 最小。

我们将线性展开式代入[瑞利商](@entry_id:137794)的表达式。分子为：
$\langle\psi|H|\psi\rangle = \sum_{i,j=1}^N c_i^* c_j \langle\phi_i|H|\phi_j\rangle = \sum_{i,j=1}^N c_i^* H_{ij} c_j = \mathbf{c}^\dagger H \mathbf{c}$

分母为：
$\langle\psi|\psi\rangle = \sum_{i,j=1}^N c_i^* c_j \langle\phi_i|\phi_j\rangle = \sum_{i,j=1}^N c_i^* S_{ij} c_j = \mathbf{c}^\dagger S \mathbf{c}$

这里，我们定义了两个重要的矩阵：
1.  **[哈密顿矩阵](@entry_id:136233) $H$**：其矩阵元为 $H_{ij} = \langle\phi_i|H|\phi_j\rangle$。
2.  **交叠矩阵（或[重叠矩阵](@entry_id:268881)）$S$**：其矩阵元为 $S_{ij} = \langle\phi_i|\phi_j\rangle$。

由于哈密顿算符 $H$ 是厄米的，矩阵 $H$ 也是[厄米矩阵](@entry_id:155147)（$H=H^\dagger$）。同理，矩阵 $S$ 也是[厄米矩阵](@entry_id:155147)。

若基函数是**正交归一**的（orthonormal），即 $S_{ij} = \delta_{ij}$，那么交叠矩阵 $S$ 就是[单位矩阵](@entry_id:156724) $I$。[瑞利商](@entry_id:137794)简化为 $E[\mathbf{c}] = \frac{\mathbf{c}^\dagger H \mathbf{c}}{\mathbf{c}^\dagger \mathbf{c}}$。对所有系数 $c_k^*$ 求导并令其为零（$\frac{\partial E}{\partial c_k^*} = 0$），将直接导出一个标准的矩阵[本征值问题](@entry_id:142153)：
$H\mathbf{c} = E\mathbf{c}$

然而，在[多尺度材料模拟](@entry_id:1128334)中，例如使用原子轨道或[有限元基函数](@entry_id:749279)时，基函数通常是**非正交**的 。在这种更普遍的情况下，交叠矩阵 $S$ 不是单位矩阵。此时的[瑞利商](@entry_id:137794)为：
$E[\mathbf{c}] = \frac{\mathbf{c}^\dagger H \mathbf{c}}{\mathbf{c}^\dagger S \mathbf{c}}$

对其进行最小化（对 $c_k^*$ 求导），我们得到如下的 **广义本征值问题（generalized eigenvalue problem）**：
$H\mathbf{c} = E S \mathbf{c}$

由于基函数是[线性无关](@entry_id:148207)的，交叠矩阵 $S$ 是正定的（positive-definite），这意味着它总是可逆的。求解这个广义[本征值问题](@entry_id:142153)，会得到 $N$ 个本征值 $E^{(k)}$ 和对应的本征矢量 $\mathbf{c}^{(k)}$。根据变分原理，这些本征值都是真实[能谱](@entry_id:181780)中对应能级的[上界](@entry_id:274738)。其中最小的本征值 $E^{(0)}$ 就是我们对基态能量 $E_0$ 的最佳变分近似。

### 系统性收敛：[完备基组](@entry_id:200333)的角色

瑞利-里兹方法为我们提供了一个在有限基组下逼近真实解的系统性框架。一个自然的问题是：我们如何保证随着计算资源的投入，近似解能够稳定地、可控地趋近于精确解？答案在于基组的 **完备性（completeness）** 和 **系统性构造（systematic construction）**。

一个基组 $\{\phi_j\}_{j=1}^\infty$ 在一个[希尔伯特空间](@entry_id:261193) $\mathcal{H}$ 中是**完备**的，如果其所有有限[线性组合](@entry_id:154743)构成的集合在该空间中是稠密的。这意味着对于空间中的任意函数 $|\psi\rangle$，我们总能找到一个有限的线性组合 $|\psi_N\rangle = \sum_{j=1}^N c_j |\phi_j\rangle$，使得它与 $|\psi\rangle$ 之间的“距离”（范数）小于任意给定的正数 $\epsilon$ 。完备性是保证变分计算能够收敛到精确解的数学前提。

在实践中，我们通过构造一系列不断扩大的、**嵌套的（nested）** 有限维子空间来逼近整个希尔伯特空间：
$\mathcal{S}_1 \subset \mathcal{S}_2 \subset \dots \subset \mathcal{S}_n \subset \dots \subset \mathcal{H}$

其中每个子空间 $\mathcal{S}_n$ 由一个有限基组张成。设在子空间 $\mathcal{S}_n$ 中通过瑞利-里兹方法得到的变分基态能量为 $E_n$。由于 $\mathcal{S}_n \subset \mathcal{S}_{n+1}$，在 $\mathcal{S}_{n+1}$ 中进行变分搜索的空间比在 $\mathcal{S}_n$ 中更大，因此找到的能量最小值只可能更低或保持不变。这保证了能量序列是单调非增的：
$E_1 \ge E_2 \ge \dots \ge E_n \ge \dots \ge E_0$

如果这个基组族是完备的，即 $\overline{\bigcup_n \mathcal{S}_n} = \mathcal{H}$，那么这个单调的能量序列将从上方收敛于真实的基态能量 $E_0$ 。这种可控的、单调的收敛性是衡量计算方法可靠性的黄金标准。

在[材料模拟](@entry_id:176516)中，有几类重要的系统性基组层次：
- **[平面波基组](@entry_id:178287)**：常用于周期性体系的计算。通过一个[动能截断](@entry_id:186065)参数 $E_{\text{cut}}$ 来定义基组，包含所有满足 $\frac{|\mathbf{G}|^2}{2} \le E_{\text{cut}}$ 的[倒格矢](@entry_id:263351) $\mathbf{G}$ 对应的[平面波](@entry_id:189798)。随着 $E_{\text{cut}}$ 的增大，基组系统性地扩大，保证了收敛性 。
- **[高斯型轨道](@entry_id:175800)（GTO）基组**：常用于量子化学和[分子模拟](@entry_id:1128112)。通过系统地增加基函数的数量（如从 cc-pVDZ 到 [cc-pVTZ](@entry_id:176016) 到 cc-pVQZ）和增加描述电子云极化与弥散的函数，可以构造出嵌套的子空间。尽管它们是非正交的，但广义[本征值问题](@entry_id:142153)的解同样表现出单调收敛性 。
- **有限元方法（FEM）基组**：通过不断细化空间网格的尺寸 $h$ 或提高每个单元上多项式的阶数 $p$，可以系统性地提高解的精度，同样形成嵌套的函数空间，保证能量的单调收敛。

### [谱定理](@entry_id:136620)与激发态

[变分原理](@entry_id:198028)的威力远不止于估算[基态能量](@entry_id:263704)。通过精巧的推广，它同样可以用来表征和计算体系的激发态能量。这深刻地依赖于[厄米算符](@entry_id:153410)的[谱定理](@entry_id:136620)。

一个直接的想法是，一旦我们求得了基态 $|\phi_0\rangle$，我们可以通过在与 $|\phi_0\rangle$ **正交**的子空间中进行变分来寻找第一激发态 $|\phi_1\rangle$ 的能量 $E_1$。这个原理可以被**依次**推广：第 $k$ 个激发态的能量 $E_k$ 可以通过在与所有能量更低的本征态 $\{|\phi_0\rangle, \dots, |\phi_{k-1}\rangle\}$ 张成的子空间正交的希尔伯特空间中，最小化[瑞利商](@entry_id:137794)得到 。
$E_k = \min_{\psi \perp \text{span}\{|\phi_0\rangle, \dots, |\phi_{k-1}\rangle\}} R[\psi]$

这个方法在理论上是完美的，但在实践中有一个明显缺点：它依赖于对低能级本征态的精确**了解**。

一个更强大且不依赖于低能级知识的表述是 **Courant-Fischer-Weyl 最小-最大原理 (min-max principle)**。它直接给出了第 $k$ 个本征值 $E_k$ 的变分表达式（此处索引从 $k=0$ 开始）：
$E_k = \min_{\mathcal{S}_{k+1}} \max_{\psi \in \mathcal{S}_{k+1}, \psi \ne 0} R[\psi]$

其中，外层的 $\min$ 操作遍历[希尔伯特空间](@entry_id:261193)中所有 $(k+1)$ 维的子空间 $\mathcal{S}_{k+1}$，而内层的 $\max$ 操作在每个给定的子空间中寻找[瑞利商](@entry_id:137794)的最大值。这个原理的直观理解是，任何一个 $(k+1)$ 维的子空间必然会与由前 $(k+1)$ 个真实[本征态](@entry_id:149904) $\{|\phi_0\rangle, \dots, |\phi_k\rangle\}$ 张成的空间有交集，因此在该子空间中总能找到一个函数，其[能量期望值](@entry_id:174035)至少为 $E_k$。

最小-最大原理有一个对偶形式，即 **最大-最小原理 (max-min principle)** ：
$E_k = \max_{\mathcal{T}_k} \min_{\psi \perp \mathcal{T}_k, \psi \ne 0} R[\psi]$

这里 $\max$ 操作遍历所有 $k$ 维的子空间 $\mathcal{T}_k$。

这些原理是极其深刻的，它们为瑞利-里兹方法的收敛性提供了坚实的理论基础。当我们将变分搜索限制在一个有限维子空间 $\mathcal{S}_m$ 时，得到的第 $k$ 个近似本征值（或称[里兹值](@entry_id:145862)）$\lambda_k^{(m)}$ 同样满足最小-最大原理，只是搜索范围被限制在 $\mathcal{S}_m$ 内部。由于这个搜索范围小于整个希尔伯特空间，我们立即得到一个至关重要的结论：
$\lambda_k^{(m)} \ge E_k$

即，瑞利-里兹方法得到的**所有**近似本征值都是对应真实本征值的**上界** 。

此外，对于前面提到的嵌套子空间序列 $\mathcal{S}_m \subset \mathcal{S}_{m+1}$，最小-最大原理同样可以证明，不仅基态能量近似值是单调收敛的，所有激发态的能量近似值也都是单调非增的 ：
$\lambda_k^{(m+1)} \le \lambda_k^{(m)}$

更进一步，**[柯西交错定理](@entry_id:155328)（Cauchy Interlacing Theorem）** 给出了相邻两个嵌套子空间（$\dim \mathcal{S}_{m+1} = \dim \mathcal{S}_m + 1$）的[里兹值](@entry_id:145862)之间的精确关系 ：
$\lambda_k^{(m+1)} \le \lambda_k^{(m)} \le \lambda_{k+1}^{(m+1)}$
这个定理表明，在基组中增加一个基函数后，新的谱的每个本征值都“插入”到旧的谱的相邻本征值之间。

当体系的某个能级 $E_k$ 具有 $m$ 度简并时（即 $E_k = E_{k+1} = \dots = E_{k+m-1}$），[变分原理](@entry_id:198028)同样适用。最小-最大原理将重复地给出相同的能量值 $E_k$。在变分计算中，我们会得到 $m$ 个[线性无关](@entry_id:148207)的本征矢量，它们共同张成了这个简并子空间的一个近似 。

### 费米子体系的[波函数](@entry_id:201714)容许性条件

到目前为止，我们的讨论具有普适性。然而，在[电子结构计算](@entry_id:748901)中，我们处理的是电子——一种[费米子](@entry_id:146235)。这为变分[试探波函数](@entry_id:142892)施加了额外的、至关重要的物理约束。一个“容许的”（admissible）多电子[试探波函数](@entry_id:142892) $\Psi(\mathbf{r}_1 s_1, \dots, \mathbf{r}_N s_N)$ 必须满足以下严格条件 ：

1.  **属于哈密顿量的定义域**：为了使[能量期望值](@entry_id:174035) $\langle\Psi|H|\Psi\rangle$ 有限，[试探波函数](@entry_id:142892)必须是平方可积的，并且其梯度也必须是平方可积的（即属于[索伯列夫空间](@entry_id:141995) $H^1$）。这保证了动能[期望值](@entry_id:150961)有限。不满足此条件的函数（如在节点处有[尖点](@entry_id:636792)或不连续）会给出无限大的能量，在[变分法](@entry_id:166033)中是无用的。

2.  **[泡利反对称原理](@entry_id:187043)**：这是对费米子体系最核心的要求。多电子总[波函数](@entry_id:201714)在交换任意两个电子的全部坐标（空间坐标 $\mathbf{r}_i$ 和自旋坐标 $s_i$）时必须反号：
    $\Psi(\dots, \mathbf{x}_i, \dots, \mathbf{x}_j, \dots) = -\Psi(\dots, \mathbf{x}_j, \dots, \mathbf{x}_i, \dots)$
    其中 $\mathbf{x}_i = (\mathbf{r}_i, s_i)$。任何不满足此对称性的[试探函数](@entry_id:756165)描述的都是一个不同的物理系统（玻色子或[任意子](@entry_id:143753)），其变分结果与真实的电子体系无关。这一原理直接导致了[波函数](@entry_id:201714)的**[节点结构](@entry_id:151019)**，即在某些多[电子构型](@entry_id:272104)下[波函数](@entry_id:201714)值为零。

3.  **边界条件**：对于在有限元胞中模拟的晶体等周期性体系，[试探波函数](@entry_id:142892)必须满足由[布洛赫定理](@entry_id:137461)决定的边界条件。例如，对于总[晶格动量](@entry_id:143609)为 $\mathbf{k}$ 的状态，[波函数](@entry_id:201714)在元胞边界上满足特定的[扭转边界条件](@entry_id:756246)。

4.  **其他对称性**：哈密顿量通常具有[点群对称性](@entry_id:141230)和[自旋对称性](@entry_id:197993)。为了找到特定对称性（如特定的[总自旋](@entry_id:153335) $S$）的基态或激发态，[试探波函数](@entry_id:142892)必须从一开始就构造为相应[不可约表示](@entry_id:263310)的基函数。变分法本身不会自动“选择”正确的对称性；它只会在你提供的函数空间内寻找能量最低点。

只有同时满足以上所有条件的[试探函数](@entry_id:756165)，其变分计算结果才具有物理意义，才能保证得到的能量是真实[费米子](@entry_id:146235)体系能级的一个可靠上界。

### 变分原理：[密度泛函理论](@entry_id:139027)的基石

[变分原理](@entry_id:198028)不仅是[波函数](@entry_id:201714)方法（如[Hartree-Fock](@entry_id:142303)和[组态相互作用](@entry_id:195713)）的理论核心，它也构成了现代[电子结构计算](@entry_id:748901)中最流行的理论——**密度泛函理论（Density Functional Theory, DFT）**的基石。DFT巧妙地将变分对象从极其复杂的[多体波函数](@entry_id:203043) $\Psi(\mathbf{x}_1, \dots, \mathbf{x}_N)$ 转移到了相对简单的三维函数——电子密度 $n(\mathbf{r})$。这一转变的合法性由 **Hohenberg-Kohn (HK) 定理** 保证。

**第一HK定理** ：对于一个非简并的基态，体系的基态电子密度 $n_0(\mathbf{r})$ 唯一地决定了外部势 $v_{\text{ext}}(\mathbf{r})$（只相差一个无关紧要的常数）。由于外势决定了[哈密顿算符](@entry_id:144286)，这意味着 $n_0(\mathbf{r})$ 唯一地决定了体系的所有性质，包括[多体波函数](@entry_id:203043)。这个定理的证明本身就是一个精彩的[变分法](@entry_id:166033)应用，通过[反证法](@entry_id:276604)证明两个不同的外势不可能对应同一个基[态密度](@entry_id:147894)。

**第二HK定理** ：定义一个普适的能量泛函 $E_v[n] = F[n] + \int v_{\text{ext}}(\mathbf{r}) n(\mathbf{r}) d\mathbf{r}$，其中 $F[n]$ 是一个只依赖于密度 $n$ 的[普适泛函](@entry_id:140176)（与具体体系的外势无关）。该定理指出，对于真实的外势 $v_{\text{ext}}$，[能量泛函](@entry_id:170311) $E_v[n]$ 的最小值就是体系的基态能量，并且这个最小值在且仅在真实基[态密度](@entry_id:147894) $n_0(\mathbf{r})$ 处取得。

这第二个定理将原来在波[函数空间](@entry_id:143478)中的[变分问题](@entry_id:756445)，转化为了在所有“$N$-可表示”密度（即来源于某个[反对称波函数](@entry_id:153813)的密度）空间中的[变分问题](@entry_id:756445)：
$E_0 = \min_{n(\mathbf{r})} E_v[n(\mathbf{r})]$
约束条件为 $\int n(\mathbf{r}) d\mathbf{r} = N$ 和 $n(\mathbf{r}) \ge 0$。

在实践中（如[Kohn-Sham DFT](@entry_id:172809)），能量泛函被分解为几项：
$E[n] = T_s[n] + E_{\text{H}}[n] + E_{\text{xc}}[n] + \int v_{\text{ext}}(\mathbf{r}) n(\mathbf{r}) d\mathbf{r}$

其中 $T_s[n]$ 是无相互作用电子体系的动能，$E_{\text{H}}[n]$ 是经典的哈特里[静电能](@entry_id:267406)，$E_{\text{xc}}[n]$ 是神秘而关键的交换关联能。对此能量泛函在粒子数守恒约束下进行变分，便可得到描述体系的[欧拉-拉格朗日方程](@entry_id:137827) ：
$\frac{\delta E[n]}{\delta n(\mathbf{r})} = \frac{\delta T_s[n]}{\delta n(\mathbf{r})} + v_{\text{H}}(\mathbf{r}) + v_{\text{xc}}(\mathbf{r}) + v_{\text{ext}}(\mathbf{r}) = \mu$

这里 $\mu$ 是作为拉格朗日乘子出现的化学势。

更深入的数学分析表明，DFT的变分结构依赖于[普适泛函](@entry_id:140176) $F[n]$ 的 **[凸性](@entry_id:138568)（convexity）** 。在由Lieb建立的严格DFT形式中，$F[n]$ 被证明是一个凸泛函。[凸性](@entry_id:138568)是保证泛函存在唯一最小值的关键性质（对于给定的外势，基[态密度](@entry_id:147894)是唯一的）。即使泛函在某些点不可微，[凸分析](@entry_id:273238)理论也保证了 **[次梯度](@entry_id:142710)（subgradient）** 的存在，从而可以写出更广义的欧拉-拉格朗日条件（一个包含关系而非等式），确保了理论的普遍适用性 。泛函的 **下半连续性（lower semicontinuity）** 则是应用[变分法](@entry_id:166033)直接方法证明最小值存在的另一个关键技术要素。正是这些深刻的数学性质，为DFT的变分原理提供了坚实的理论保障。

总之，从估算单个能级到支撑整个现代[电子结构理论](@entry_id:172375)，[变分原理](@entry_id:198028)是贯穿于量子力学及其计算应用的一条核心主线，为我们理解和预测材料性质提供了强大而优雅的理论工具。