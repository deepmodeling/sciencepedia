{
    "hands_on_practices": [
        {
            "introduction": "The concept of the exchange-correlation hole is central to understanding how electron-electron interactions are modeled beyond the mean-field Hartree approximation. This exercise provides a direct link between a theoretical model of the correlation hole, such as one might obtain from a high-level Quantum Monte Carlo simulation, and the resulting correlation energy. By working through the derivation , you will gain a concrete understanding of how the spatial distribution of electrons around a reference electron determines this crucial energy contribution.",
            "id": "3804520",
            "problem": "A three-dimensional homogeneous electron gas (HEG) of number density $n$ is simulated within the jellium model at zero temperature. A Diffusion Quantum Monte Carlo (QMC) analysis provides a spin-summed correlation hole model that is consistent with the particle-conservation sum rule and the expected short-range screening:\n$$\n\\Delta g_{c}(r) \\;=\\; A\\left(\\exp(-\\lambda r) \\;-\\; \\left(\\frac{\\mu}{\\lambda}\\right)^{3} \\exp(-\\mu r)\\right),\n$$\nwith parameters $\\mu>\\lambda>0$ and $A>0$. The electron-electron interaction is the Coulomb potential $v(r)=\\frac{e^{2}}{4\\pi \\varepsilon_{0} r}$, where $e$ is the elementary charge and $\\varepsilon_{0}$ is the vacuum permittivity. The two-particle density is related to the pair distribution function by $\\rho^{(2)}(\\mathbf{r}_{1},\\mathbf{r}_{2})=n^{2} g(|\\mathbf{r}_{1}-\\mathbf{r}_{2}|)$.\n\nStarting from the definition of the electron-electron interaction energy in terms of the two-particle density and invoking the neutralizing background of jellium to remove the Hartree contribution associated with $g(r)=1$, derive the correlation energy per electron $\\varepsilon_{c}$ as the contribution to the interaction energy coming solely from $\\Delta g_{c}(r)$.\n\nProvide a single closed-form analytic expression for $\\varepsilon_{c}$ in terms of $n$, $A$, $\\lambda$, $\\mu$, $e$, and $\\varepsilon_{0}$, fully simplified. Express the final energy in Joules. Do not substitute numerical values for constants and do not perform any rounding.",
            "solution": "The problem asks for the correlation energy per electron, $\\varepsilon_c$, for a homogeneous electron gas described by the jellium model. This energy is the contribution to the electron-electron interaction energy arising from the given correlation hole model, $\\Delta g_c(r)$.\n\nThe total potential energy of interaction in a system of particles with pair potential $v(r)$ is given by the general formula:\n$$\nE_{int} = \\frac{1}{2} \\iint \\rho^{(2)}(\\mathbf{r}_{1}, \\mathbf{r}_{2}) v(|\\mathbf{r}_{1} - \\mathbf{r}_{2}|) d^3r_{1} d^3r_{2}\n$$\nThe problem states that the two-particle density $\\rho^{(2)}(\\mathbf{r}_{1}, \\mathbf{r}_{2})$ is related to the electron number density $n$ and the pair distribution function $g(r)$ by $\\rho^{(2)}(\\mathbf{r}_{1}, \\mathbf{r}_{2}) = n^{2} g(|\\mathbf{r}_{1} - \\mathbf{r}_{2}|)$. Substituting this into the energy expression gives:\n$$\nE_{int} = \\frac{1}{2} n^{2} \\iint g(|\\mathbf{r}_{1} - \\mathbf{r}_{2}|) v(|\\mathbf{r}_{1} - \\mathbf{r}_{2}|) d^3r_{1} d^3r_{2}\n$$\nFor a homogeneous system of volume $V$, we can perform a change of variables to relative coordinates $\\mathbf{r} = \\mathbf{r}_{2} - \\mathbf{r}_{1}$ and center-of-mass coordinates. The integral over the center-of-mass coordinate throughout the volume $V$ yields a factor of $V$. Thus, the expression simplifies to:\n$$\nE_{int} = \\frac{1}{2} n^{2} V \\int g(r) v(r) d^3r\n$$\nThe total number of electrons in the system is $N = nV$. The interaction energy per electron, $\\varepsilon_{int} = E_{int}/N$, is therefore:\n$$\n\\varepsilon_{int} = \\frac{E_{int}}{nV} = \\frac{1}{2} n \\int g(r) v(r) d^3r\n$$\nThe pair distribution function can be written as $g(r) = 1 + h(r)$, where $h(r)$ is the pair-correlation function representing the deviation from a uniform, uncorrelated gas. The term $g(r) = 1$ corresponds to the classical electrostatic energy of the electrons with themselves (the Hartree energy). The problem specifies that in the jellium model, this term is exactly canceled by the interaction with the uniform positive background. We are asked to find the correlation energy $\\varepsilon_c$, which is the contribution arising from the correlation hole, $\\Delta g_c(r)$. This means we replace $g(r)$ in the integral with the provided model $\\Delta g_c(r)$:\n$$\n\\varepsilon_{c} = \\frac{1}{2} n \\int \\Delta g_{c}(r) v(r) d^3r\n$$\nThe integration is over all space. We use spherical coordinates, where the differential volume element is $d^3r = 4\\pi r^2 dr$. The given functions are:\n$$\n\\Delta g_{c}(r) \\;=\\; A\\left(\\exp(-\\lambda r) \\;-\\; \\left(\\frac{\\mu}{\\lambda}\\right)^{3} \\exp(-\\mu r)\\right)\n$$\n$$\nv(r) = \\frac{e^{2}}{4\\pi \\varepsilon_{0} r}\n$$\nSubstituting these into the expression for $\\varepsilon_c$:\n$$\n\\varepsilon_{c} = \\frac{1}{2} n \\int_{0}^{\\infty} \\left[ A\\left(\\exp(-\\lambda r) - \\left(\\frac{\\mu}{\\lambda}\\right)^{3} \\exp(-\\mu r)\\right) \\right] \\left( \\frac{e^{2}}{4\\pi \\varepsilon_{0} r} \\right) (4\\pi r^{2} dr)\n$$\nWe can simplify the expression by canceling the $4\\pi$ factors and taking the constants outside the integral:\n$$\n\\varepsilon_{c} = \\frac{1}{2} n A \\frac{e^{2}}{\\varepsilon_{0}} \\int_{0}^{\\infty} \\left[ \\exp(-\\lambda r) - \\left(\\frac{\\mu}{\\lambda}\\right)^{3} \\exp(-\\mu r) \\right] r \\, dr\n$$\nThe integral can be evaluated by splitting it into two parts:\n$$\nI = \\int_{0}^{\\infty} r \\exp(-\\lambda r) dr - \\left(\\frac{\\mu}{\\lambda}\\right)^{3} \\int_{0}^{\\infty} r \\exp(-\\mu r) dr\n$$\nWe use the standard definite integral formula $\\int_{0}^{\\infty} x^{k} \\exp(-ax) dx = \\frac{k!}{a^{k+1}}$. For $k=1$, this gives $\\int_{0}^{\\infty} x \\exp(-ax) dx = \\frac{1}{a^{2}}$.\nApplying this formula to our integrals:\n$$\n\\int_{0}^{\\infty} r \\exp(-\\lambda r) dr = \\frac{1}{\\lambda^{2}}\n$$\n$$\n\\int_{0}^{\\infty} r \\exp(-\\mu r) dr = \\frac{1}{\\mu^{2}}\n$$\nSubstituting these results back into the expression for $I$:\n$$\nI = \\frac{1}{\\lambda^{2}} - \\left(\\frac{\\mu}{\\lambda}\\right)^{3} \\frac{1}{\\mu^{2}} = \\frac{1}{\\lambda^{2}} - \\frac{\\mu^{3}}{\\lambda^{3}\\mu^{2}} = \\frac{1}{\\lambda^{2}} - \\frac{\\mu}{\\lambda^{3}}\n$$\nTo combine these terms, we use a common denominator of $\\lambda^{3}$:\n$$\nI = \\frac{\\lambda}{\\lambda^{3}} - \\frac{\\mu}{\\lambda^{3}} = \\frac{\\lambda - \\mu}{\\lambda^{3}}\n$$\nFinally, we substitute the result for the integral $I$ back into the expression for $\\varepsilon_c$:\n$$\n\\varepsilon_{c} = \\frac{1}{2} n A \\frac{e^{2}}{\\varepsilon_{0}} \\left( \\frac{\\lambda - \\mu}{\\lambda^{3}} \\right)\n$$\nThis can be written as a single, fully simplified fraction, which is the final closed-form expression for the correlation energy per electron in Joules.\n$$\n\\varepsilon_{c} = \\frac{n A e^{2} (\\lambda - \\mu)}{2 \\varepsilon_{0} \\lambda^{3}}\n$$\nGiven the condition $\\mu > \\lambda > 0$, the term $(\\lambda - \\mu)$ is negative. All other quantities ($n$, $A$, $e$, $\\varepsilon_0$, $\\lambda$) are positive. Thus, $\\varepsilon_c$ is negative, which is physically correct for a correlation energy, as it represents a lowering of the system's energy due to electron-electron correlations.",
            "answer": "$$\\boxed{\\frac{n A e^{2} (\\lambda - \\mu)}{2 \\varepsilon_{0} \\lambda^{3}}}$$"
        },
        {
            "introduction": "While theoretical models provide physical insight, practical simulations rely on the numerical evaluation of exchange-correlation functionals for a given electron density. This hands-on coding exercise  guides you through the implementation of a numerical quadrature scheme to compute the total exchange-correlation energy within the Local Density Approximation ($LDA$). Mastering this task is fundamental for understanding the inner workings of DFT codes and for appreciating the numerical challenges involved, such as ensuring convergence and correctly handling regions of vanishing electron density.",
            "id": "3804514",
            "problem": "Consider the computation of the electron exchange and correlation energy in atomic units (Hartree) within the Local Density Approximation (LDA) for spin-unpolarized systems. The exchange-correlation energy functional is defined as $E_{xc}[n] = \\int d^3\\mathbf{r}\\, n(\\mathbf{r})\\, \\varepsilon_{xc}(n(\\mathbf{r}))$, where $n(\\mathbf{r})$ is the electron number density and $\\varepsilon_{xc}(n)$ is the exchange-correlation energy per electron in a uniform electron gas of density $n$. In LDA, the exchange energy per electron is given by the well-established formula for the uniform electron gas derived from Hartree-Fock theory, namely $\\varepsilon_{x}(n) = -\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3} n^{1/3}$, and the high-density limiting form of the correlation energy per electron is modeled as $\\varepsilon_{c}(r_s) = \\gamma \\ln(r_s) + \\beta$, with $r_s = \\left(\\frac{3}{4\\pi n}\\right)^{1/3}$, $\\gamma = 0.031091$, and $\\beta = -0.048$, which are widely used constants consistent with many-body theory of the uniform electron gas.\n\nYou will implement a numerical quadrature for spherically symmetric densities using spherical coordinates so that $E_{xc}[n] = 4\\pi \\int_{0}^{R_{\\max}} dr\\, r^2\\, n(r)\\, \\varepsilon_{xc}(n(r))$. The fundamental base for this computation is the definition of $E_{xc}[n]$ as an integral over space in spherical coordinates and the known expressions for $\\varepsilon_{x}(n)$ and $\\varepsilon_{c}(r_s)$ provided above.\n\nThe integral shall be evaluated numerically with the composite Simpson’s rule on a uniform radial grid. To ensure a valid Simpson stencil, when constructing the grid for a requested spacing $h$ over the domain $[0,R_{\\max}]$, use the minimal number of intervals $M$ that both (i) satisfies $M \\ge \\lceil R_{\\max}/h \\rceil$ and (ii) is an even integer, and then set the actual spacing to $h_{\\text{eff}} = R_{\\max}/M$. This guarantees an even number of intervals while keeping $h_{\\text{eff}} \\le h$. For regions with vanishing density, the correlation energy per electron $\\varepsilon_{c}(r_s)$ formally diverges as $n \\to 0$ through $r_s \\to \\infty$. However, the integrand $n\\,\\varepsilon_c(r_s(n))$ remains integrable since $n \\ln(n)$ tends to zero as $n \\to 0$. Numerically, to avoid evaluating $\\ln(0)$, you must set a lower bound $n_{\\min} = 10^{-12}$ on density when computing $r_s$; that is, use $n_{\\text{corr}}(r) = \\max(n(r), n_{\\min})$ inside $\\varepsilon_c$ while always multiplying by the true $n(r)$ in the final integrand.\n\nFor testing, consider the following spherically symmetric densities $n(r)$ expressed in atomic units:\n- Smooth Gaussian density: $n(r) = n_0\\, e^{-\\alpha r^2}$ with $n_0 = 0.05$, $\\alpha = 0.3$, and truncation radius $R_{\\max} = 12$.\n- Uniform sphere density: $n(r) = n_s$ for $0 \\le r \\le R_s$ and $n(r) = 0$ for $r > R_s$, with $n_s = 0.02$, $R_s = 6$, and truncation radius $R_{\\max} = 12$.\n- Exponential cusp density: $n(r) = n_c\\, e^{-\\beta r}$ with $n_c = 0.1$, $\\beta = 1.2$, and truncation radius $R_{\\max} = 30$.\n\nFor the exchange energy, the integral admits the following exact analytic forms, which you must use for error assessment:\n- Gaussian: $E_{x}^{\\text{exact}} = -C_x\\, n_0^{4/3}\\, \\pi^{3/2}\\, \\left( \\frac{4}{3}\\alpha \\right)^{-3/2}$, where $C_x = \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}$.\n- Uniform sphere: $E_{x}^{\\text{exact}} = -C_x\\, n_s^{4/3}\\, \\frac{4}{3}\\pi R_s^3$.\n- Exponential cusp: $E_{x}^{\\text{exact}} = -C_x\\, \\frac{8\\pi\\, n_c^{4/3}}{\\left( \\frac{4}{3}\\beta \\right)^3}$.\n\nFor the correlation energy, the uniform sphere case admits an exact analytic form under the high-density model used here because $n(r)$ is constant where nonzero:\n- Uniform sphere: $E_{c}^{\\text{exact}} = n_s\\, \\varepsilon_c\\!\\left( \\left(\\frac{3}{4\\pi n_s}\\right)^{1/3} \\right)\\, \\frac{4}{3}\\pi R_s^3$.\n\nNumerically approximate the required integrals using composite Simpson’s rule with the grid construction described above. Use the following test suite of requested spacings:\n- For the Gaussian density, use $h \\in \\{0.4, 0.2, 0.1\\}$ on $[0, R_{\\max}]$ and compute the absolute exchange energy errors $|E_{x}^{\\text{num}} - E_{x}^{\\text{exact}}|$ for each $h$.\n- For the uniform sphere density, use $h = 0.1$ on $[0, R_{\\max}]$ and compute two absolute errors: the exchange energy error $|E_{x}^{\\text{num}} - E_{x}^{\\text{exact}}|$ and the correlation energy error $|E_{c}^{\\text{num}} - E_{c}^{\\text{exact}}|$.\n- For the exponential cusp density, use $h = 0.1$ on $[0, R_{\\max}]$ and compute the absolute exchange energy error $|E_{x}^{\\text{num}} - E_{x}^{\\text{exact}}|$.\n\nAll energies and errors must be expressed in Hartree. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the following order: the three Gaussian exchange errors for $h = 0.4$, $h = 0.2$, $h = 0.1$, then the two uniform sphere errors (exchange and correlation) for $h = 0.1$, followed by the exponential cusp exchange error for $h = 0.1$, that is, $[e_{G,0.4}, e_{G,0.2}, e_{G,0.1}, e_{U,x,0.1}, e_{U,c,0.1}, e_{E,0.1}]$.",
            "solution": "The problem requires the numerical computation of the exchange and correlation energy, $E_{xc}$, for various spherically symmetric electron densities, $n(r)$, within the framework of the Local Density Approximation (LDA). The results are to be compared against exact analytical solutions to assess the error of the numerical method.\n\nThe total exchange-correlation energy functional in LDA is given by:\n$$\nE_{xc}[n] = \\int d^3\\mathbf{r}\\, n(\\mathbf{r})\\, \\varepsilon_{xc}(n(\\mathbf{r}))\n$$\nwhere $\\varepsilon_{xc}(n)$ is the exchange-correlation energy per particle of a uniform electron gas of density $n$. This energy is a sum of exchange and correlation components, $\\varepsilon_{xc}(n) = \\varepsilon_{x}(n) + \\varepsilon_{c}(n)$.\n\nFor spherically symmetric systems, the integral simplifies to:\n$$\nE_{xc}[n] = 4\\pi \\int_{0}^{R_{\\max}} dr\\, r^2\\, n(r)\\, \\varepsilon_{xc}(n(r))\n$$\nwhere $r$ is the radial distance and $R_{\\max}$ is a cutoff radius beyond which the density is considered negligible.\n\nThe specific forms for $\\varepsilon_{x}(n)$ and $\\varepsilon_{c}(n)$ are provided:\nThe exchange energy per particle is given by the Hartree-Fock result for the uniform electron gas:\n$$\n\\varepsilon_{x}(n) = -C_x n^{1/3} \\quad \\text{where} \\quad C_x = \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}\n$$\nThe correlation energy per particle is given by the high-density (low-$r_s$) limiting form:\n$$\n\\varepsilon_{c}(r_s) = \\gamma \\ln(r_s) + \\beta\n$$\nwhere $\\gamma = 0.031091$, $\\beta = -0.048$, and $r_s$ is the Wigner-Seitz radius, related to the density $n$ by:\n$$\nr_s = \\left(\\frac{3}{4\\pi n}\\right)^{1/3}\n$$\n\nThe numerical evaluation of the integral will be performed using the composite Simpson's rule. A specific procedure for grid generation is mandated. For a given integration domain $[0, R_{\\max}]$ and a requested grid spacing $h$, the number of intervals, $M$, is determined as the smallest even integer such that $M \\ge \\lceil R_{\\max}/h \\rceil$. This ensures that the grid, which consists of $M+1$ points, is suitable for the composite Simpson's rule, which requires an odd number of points (i.e., an even number of intervals). The effective grid spacing is then $h_{\\text{eff}} = R_{\\max}/M$. The radial grid points are $r_i = i \\cdot h_{\\text{eff}}$ for $i = 0, 1, \\dots, M$.\n\nA numerical challenge arises in the correlation energy term, as $n \\to 0$ implies $r_s \\to \\infty$ and $\\varepsilon_c(r_s) \\to \\infty$. Although the product $n\\,\\varepsilon_c(n)$ correctly converges to $0$, floating-point evaluation of $\\ln(\\infty)$ must be avoided. The problem specifies a regularization procedure: when computing $r_s$ for the correlation energy, the density $n(r)$ is floored at a minimum value $n_{\\min} = 10^{-12}$. That is, one computes $\\varepsilon_c(n_{\\text{corr}}(r))$ where $n_{\\text{corr}}(r) = \\max(n(r), n_{\\min})$. The full integrand for the correlation energy at a radial point $r$ is then $4\\pi r^2 n(r)\\, \\varepsilon_c(n_{\\text{corr}}(r))$.\n\nThe solution is implemented by following these steps:\n1.  Define all physical constants ($C_x, \\gamma, \\beta, n_{\\min}$) and parameters for the three given density profiles (Gaussian, uniform sphere, exponential cusp).\n2.  Implement functions for each density profile $n(r)$.\n3.  Define the integrands for the exchange and correlation energies. The exchange integrand at radius $r$ is $I_x(r) = 4\\pi r^2 n(r) \\varepsilon_x(n(r)) = -4\\pi C_x r^2 [n(r)]^{4/3}$. The correlation integrand is $I_c(r) = 4\\pi r^2 n(r) \\varepsilon_c(n_{\\text{corr}}(r))$.\n4.  Implement a main calculation routine that, for each test case:\n    a. Determines the number of intervals $M$ and constructs the radial grid $r$ from $0$ to $R_{\\max}$ with $M+1$ points.\n    b. Evaluates the density $n(r)$ and the corresponding integrand ($I_x(r)$ or $I_c(r)$) at each grid point.\n    c. Uses a numerical integration library function, specifically `scipy.integrate.simpson`, to compute the definite integral from the arrays of integrand values and grid points. This function correctly implements the composite Simpson's rule.\n    d. Calculates the exact analytical energy using the provided formulae.\n    e. Computes the absolute error between the numerical and exact values.\n5.  The computed errors for all test cases are collected and formatted into the specified output string.\n\nThe calculations are performed for the following cases:\n- **Gaussian density**: $n(r) = n_0\\, e^{-\\alpha r^2}$ with $n_0 = 0.05$, $\\alpha = 0.3$, $R_{\\max} = 12$. The absolute exchange energy error $|E_{x}^{\\text{num}} - E_{x}^{\\text{exact}}|$ is computed for requested spacings $h \\in \\{0.4, 0.2, 0.1\\}$.\n- **Uniform sphere density**: $n(r) = n_s$ for $r \\le R_s$ and $0$ otherwise, with $n_s = 0.02$, $R_s = 6$, $R_{\\max} = 12$. The absolute exchange error $|E_{x}^{\\text{num}} - E_{x}^{\\text{exact}}|$ and correlation error $|E_{c}^{\\text{num}} - E_{c}^{\\text{exact}}|$ are computed for $h = 0.1$.\n- **Exponential cusp density**: $n(r) = n_c\\, e^{-\\beta r}$ with $n_c = 0.1$, $\\beta = 1.2$, $R_{\\max} = 30$. The absolute exchange error $|E_{x}^{\\text{num}} - E_{x}^{\\text{exact}}|$ is computed for $h = 0.1$.\n\nThe values are then assembled in the prescribed order for the final output.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import simpson\n\ndef solve():\n    \"\"\"\n    Computes exchange and correlation energy errors for various density profiles\n    using the Local Density Approximation (LDA) and Simpson's rule integration.\n    \"\"\"\n\n    # --- Constants and Physical Parameters ---\n    C_x = (3/4) * (3 / np.pi)**(1/3)\n    GAMMA = 0.031091\n    BETA_CORR = -0.048\n    N_MIN = 1e-12\n\n    # --- Energy, Density, and Integrand Functions ---\n\n    def eps_c(n):\n        \"\"\"Correlation energy per particle.\"\"\"\n        n_corr = np.maximum(n, N_MIN)\n        # Suppress divide-by-zero warnings for n=0, though np.maximum prevents it.\n        with np.errstate(divide='ignore'):\n            rs = (3 / (4 * np.pi * n_corr))**(1/3)\n        return GAMMA * np.log(rs) + BETA_CORR\n\n    # --- Analytical Solutions ---\n\n    def exact_Ex_gaussian(n0, alpha):\n        return -C_x * n0**(4/3) * np.pi**(3/2) * (4/3 * alpha)**(-3/2)\n\n    def exact_Ex_uniform_sphere(ns, Rs):\n        return -C_x * ns**(4/3) * (4/3 * np.pi * Rs**3)\n\n    def exact_Ec_uniform_sphere(ns, Rs):\n        rs_val = (3 / (4 * np.pi * ns))**(1/3)\n        eps_c_val = GAMMA * np.log(rs_val) + BETA_CORR\n        return ns * eps_c_val * (4/3 * np.pi * Rs**3)\n\n    def exact_Ex_exp_cusp(nc, beta_exp):\n        return -C_x * (8 * np.pi * nc**(4/3)) / ((4/3 * beta_exp)**3)\n\n    # --- Numerical Integration and Error Calculation ---\n    \n    def compute_numerical_errors(config):\n        \"\"\"\n        Main function to compute numerical integrals and errors for a given configuration.\n        \"\"\"\n        errors = []\n        \n        density_type = config['type']\n        params = config['params']\n        R_max = config['R_max']\n        h_values = config['h_values']\n        tasks = config['tasks']\n\n        for h in h_values:\n            # 1. Grid construction\n            if h <= 0:\n                # Avoid division by zero, although not expected from problem statement\n                raise ValueError(\"Grid spacing h must be positive.\")\n            M = int(np.ceil(R_max / h))\n            if M % 2 != 0:\n                M += 1\n            if M == 0: # Handle R_max = 0 case\n                M = 2\n            \n            r_grid = np.linspace(0, R_max, M + 1)\n\n            # 2. Density evaluation\n            if density_type == 'gaussian':\n                n0, alpha = params['n0'], params['alpha']\n                n_r = n0 * np.exp(-alpha * r_grid**2)\n            elif density_type == 'uniform_sphere':\n                ns, Rs = params['ns'], params['Rs']\n                n_r = np.where(r_grid <= Rs, ns, 0.0)\n            elif density_type == 'exp_cusp':\n                nc, beta_exp = params['nc'], params['beta']\n                n_r = nc * np.exp(-beta_exp * r_grid)\n\n            # 3. Perform integration for each task (exchange/correlation)\n            for task in tasks:\n                if task == 'exchange':\n                    integrand = -4 * np.pi * C_x * r_grid**2 * n_r**(4/3)\n                    E_num = simpson(integrand, r_grid)\n                    \n                    if density_type == 'gaussian':\n                        E_exact = exact_Ex_gaussian(params['n0'], params['alpha'])\n                    elif density_type == 'uniform_sphere':\n                        E_exact = exact_Ex_uniform_sphere(params['ns'], params['Rs'])\n                    elif density_type == 'exp_cusp':\n                        E_exact = exact_Ex_exp_cusp(params['nc'], params['beta'])\n                \n                elif task == 'correlation':\n                    # This task is only for the uniform sphere case\n                    eps_c_r = eps_c(n_r)\n                    integrand = 4 * np.pi * r_grid**2 * n_r * eps_c_r\n                    E_num = simpson(integrand, r_grid)\n                    E_exact = exact_Ec_uniform_sphere(params['ns'], params['Rs'])\n\n                errors.append(abs(E_num - E_exact))\n        \n        return errors\n        \n    # --- Test Case Definitions ---\n    test_configs = [\n        {\n            'type': 'gaussian',\n            'params': {'n0': 0.05, 'alpha': 0.3},\n            'R_max': 12,\n            'h_values': [0.4, 0.2, 0.1],\n            'tasks': ['exchange']\n        },\n        {\n            'type': 'uniform_sphere',\n            'params': {'ns': 0.02, 'Rs': 6},\n            'R_max': 12,\n            'h_values': [0.1],\n            'tasks': ['exchange', 'correlation']\n        },\n        {\n            'type': 'exp_cusp',\n            'params': {'nc': 0.1, 'beta': 1.2},\n            'R_max': 30,\n            'h_values': [0.1],\n            'tasks': ['exchange']\n        }\n    ]\n    \n    # --- Main Execution ---\n    all_results = []\n    for config in test_configs:\n        results_for_case = compute_numerical_errors(config)\n        all_results.extend(results_for_case)\n\n    # --- Final Output Formatting ---\n    print(f\"[{','.join(f'{res:.12e}' for res in all_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The predictive power of multiscale simulations often hinges on accurately connecting electronic structure information to macroscopic material properties. This problem  demonstrates a classic example of this connection by showing how the exchange-correlation energy functional directly contributes to a material's bulk modulus, a key measure of its stiffness. By deriving this relationship, you will see how the curvature of the energy-density landscape at the quantum level dictates the mechanical response at the continuum scale.",
            "id": "3804516",
            "problem": "In multiscale materials simulation, a common coupling strategy links a continuum mechanical description of deformation to a quantum-mechanical description of electronic energetics through the electron exchange-correlation (XC) energy. Consider a spin-unpolarized, homogeneous electron gas used as the local reference for the exchange-correlation energy density in the Local Density Approximation (LDA) within Density Functional Theory (DFT). Let the electronic number density in the undeformed reference configuration be uniform and equal to $n_{0}$, and let the body undergo a spatially uniform hydrostatic deformation characterized by a Jacobian $J$, where $J$ is the determinant of the deformation gradient from the reference to the current configuration. Define the scalar volumetric strain by $\\theta$ via $J=1+\\theta$, and assume small volumetric strains.\n\nUse the following foundational ingredients:\n\n- Mass conservation implies $n = n_{0}/J$ for the current electron density $n$ under a purely volumetric deformation.\n- The macroscopic XC free-energy density per unit reference volume is obtained by mapping the current energy density to the reference configuration, so that $W_{\\mathrm{xc}}(\\theta) = J \\, e_{\\mathrm{xc}}(n)$ with $n=n_{0}/J$.\n- For the exchange part of a uniform electron gas in atomic units (Hartree for energy and bohr for length), the exchange energy density is $e_{x}(n) = - C_{x} \\, n^{4/3}$, where $C_{x} = \\frac{3}{4} \\left( \\frac{3}{\\pi} \\right)^{1/3}$.\n- For the correlation part in the high-density Gell-Mann–Brueckner limit, the correlation energy per electron is $\\varepsilon_{c}(n) = A \\ln r_{s} + B$, where $A$ and $B$ are constants, and $r_{s} = \\left( \\frac{3}{4 \\pi n} \\right)^{1/3}$. The correlation energy density is $e_{c}(n) = n \\, \\varepsilon_{c}(n)$.\n\nStarting from these principles, derive the closed-form analytic expression for the incremental bulk modulus contribution from exchange-correlation,\n$$\nK_{\\mathrm{xc}}(n_{0}) \\equiv \\left. \\frac{d^{2} W_{\\mathrm{xc}}}{d \\theta^{2}} \\right|_{\\theta=0},\n$$\nas a function of $n_{0}$ and the constants $A$ and $\\pi$. You may treat $B$ as an arbitrary constant. Express your final answer in atomic units as a single simplified analytical expression. Do not include units in your final boxed expression.",
            "solution": "The quantity to be derived is the incremental bulk modulus contribution from exchange-correlation, defined as:\n$$\nK_{\\mathrm{xc}}(n_{0}) \\equiv \\left. \\frac{d^{2} W_{\\mathrm{xc}}}{d \\theta^{2}} \\right|_{\\theta=0}\n$$\nThe exchange-correlation (XC) free-energy density per unit reference volume, $W_{\\mathrm{xc}}(\\theta)$, is given by:\n$$\nW_{\\mathrm{xc}}(\\theta) = J \\, e_{\\mathrm{xc}}(n)\n$$\nwhere $J = 1+\\theta$ is the Jacobian of the deformation and $n = n_{0}/J = n_{0}/(1+\\theta)$ is the electron number density in the deformed configuration. The XC energy density $e_{\\mathrm{xc}}(n)$ is the sum of the exchange and correlation parts, $e_{\\mathrm{xc}}(n) = e_{x}(n) + e_{c}(n)$.\n\nWe can thus decompose $W_{\\mathrm{xc}}(\\theta)$ into exchange and correlation contributions:\n$$\nW_{\\mathrm{xc}}(\\theta) = W_{x}(\\theta) + W_{c}(\\theta)\n$$\nwhere $W_{x}(\\theta) = J \\, e_{x}(n)$ and $W_{c}(\\theta) = J \\, e_{c}(n)$. The bulk modulus will be the sum of the contributions from these two parts:\n$$\nK_{\\mathrm{xc}}(n_{0}) = \\left. \\frac{d^{2} W_{x}}{d \\theta^{2}} \\right|_{\\theta=0} + \\left. \\frac{d^{2} W_{c}}{d \\theta^{2}} \\right|_{\\theta=0}\n$$\n\nFirst, we derive the exchange contribution, $K_{x}(n_{0})$. The exchange energy density is given as $e_{x}(n) = -C_{x} n^{4/3}$.\nThe exchange energy density per unit reference volume is:\n$$\nW_{x}(\\theta) = J e_{x}(n(\\theta)) = (1+\\theta) \\left[ -C_{x} \\left( \\frac{n_{0}}{1+\\theta} \\right)^{4/3} \\right]\n$$\nSimplifying this expression, we get:\n$$\nW_{x}(\\theta) = -C_{x} n_{0}^{4/3} (1+\\theta)^{1} (1+\\theta)^{-4/3} = -C_{x} n_{0}^{4/3} (1+\\theta)^{-1/3}\n$$\nNow, we compute the first and second derivatives with respect to $\\theta$:\n$$\n\\frac{dW_{x}}{d\\theta} = -C_{x} n_{0}^{4/3} \\frac{d}{d\\theta}(1+\\theta)^{-1/3} = -C_{x} n_{0}^{4/3} \\left(-\\frac{1}{3}\\right) (1+\\theta)^{-4/3} = \\frac{1}{3} C_{x} n_{0}^{4/3} (1+\\theta)^{-4/3}\n$$\n$$\n\\frac{d^{2}W_{x}}{d\\theta^{2}} = \\frac{1}{3} C_{x} n_{0}^{4/3} \\frac{d}{d\\theta}(1+\\theta)^{-4/3} = \\frac{1}{3} C_{x} n_{0}^{4/3} \\left(-\\frac{4}{3}\\right) (1+\\theta)^{-7/3} = -\\frac{4}{9} C_{x} n_{0}^{4/3} (1+\\theta)^{-7/3}\n$$\nEvaluating the second derivative at $\\theta=0$ gives the exchange contribution to the bulk modulus:\n$$\nK_{x}(n_{0}) = \\left. \\frac{d^{2}W_{x}}{d\\theta^{2}} \\right|_{\\theta=0} = -\\frac{4}{9} C_{x} n_{0}^{4/3}\n$$\n\nNext, we derive the correlation contribution, $K_{c}(n_{0})$. The correlation energy density is given by $e_{c}(n) = n \\, \\varepsilon_{c}(n)$, where $\\varepsilon_{c}(n) = A \\ln r_{s} + B$ is the correlation energy per electron.\nThe correlation energy density per unit reference volume is:\n$$\nW_{c}(\\theta) = J e_{c}(n(\\theta)) = (1+\\theta) \\left[ n(\\theta) \\, \\varepsilon_{c}(n(\\theta)) \\right]\n$$\nSubstituting $n(\\theta) = n_{0}/(1+\\theta)$:\n$$\nW_{c}(\\theta) = (1+\\theta) \\left[ \\frac{n_{0}}{1+\\theta} \\, \\varepsilon_{c}\\left(\\frac{n_{0}}{1+\\theta}\\right) \\right] = n_{0} \\, \\varepsilon_{c}(n(\\theta))\n$$\nWe need to express $\\varepsilon_{c}$ as a function of $\\theta$. The Wigner-Seitz radius $r_{s}$ is related to the density $n$ by $r_{s} = \\left( \\frac{3}{4 \\pi n} \\right)^{1/3}$.\nSubstituting $n = n_{0}/(1+\\theta)$:\n$$\nr_{s}(\\theta) = \\left( \\frac{3(1+\\theta)}{4 \\pi n_{0}} \\right)^{1/3} = \\left( \\frac{3}{4 \\pi n_{0}} \\right)^{1/3} (1+\\theta)^{1/3} = r_{s,0} (1+\\theta)^{1/3}\n$$\nwhere $r_{s,0} = \\left( \\frac{3}{4 \\pi n_{0}} \\right)^{1/3}$ is the radius in the reference state.\nNow, substituting this into the expression for $\\varepsilon_{c}$:\n$$\n\\varepsilon_{c}(n(\\theta)) = A \\ln(r_{s,0} (1+\\theta)^{1/3}) + B = A (\\ln r_{s,0} + \\ln((1+\\theta)^{1/3})) + B = A \\ln r_{s,0} + \\frac{A}{3} \\ln(1+\\theta) + B\n$$\nSo, the correlation energy density per reference volume is:\n$$\nW_{c}(\\theta) = n_{0} \\left( A \\ln r_{s,0} + \\frac{A}{3} \\ln(1+\\theta) + B \\right) = (n_{0}A \\ln r_{s,0} + n_{0}B) + \\frac{n_{0}A}{3} \\ln(1+\\theta)\n$$\nThe first term is a constant with respect to $\\theta$. We compute the derivatives:\n$$\n\\frac{dW_{c}}{d\\theta} = \\frac{d}{d\\theta} \\left(\\frac{n_{0}A}{3} \\ln(1+\\theta)\\right) = \\frac{n_{0}A}{3} \\frac{1}{1+\\theta}\n$$\n$$\n\\frac{d^{2}W_{c}}{d\\theta^{2}} = \\frac{n_{0}A}{3} \\frac{d}{d\\theta}(1+\\theta)^{-1} = \\frac{n_{0}A}{3} (-1) (1+\\theta)^{-2} = -\\frac{n_{0}A}{3} (1+\\theta)^{-2}\n$$\nEvaluating at $\\theta=0$:\n$$\nK_{c}(n_{0}) = \\left. \\frac{d^{2}W_{c}}{d\\theta^{2}} \\right|_{\\theta=0} = -\\frac{n_{0}A}{3}\n$$\n\nFinally, we sum the exchange and correlation contributions to obtain $K_{\\mathrm{xc}}(n_{0})$:\n$$\nK_{\\mathrm{xc}}(n_{0}) = K_{x}(n_{0}) + K_{c}(n_{0}) = -\\frac{4}{9} C_{x} n_{0}^{4/3} - \\frac{n_{0}A}{3}\n$$\nThe problem provides the constant $C_{x} = \\frac{3}{4} \\left( \\frac{3}{\\pi} \\right)^{1/3}$. Substituting this into the expression:\n$$\nK_{\\mathrm{xc}}(n_{0}) = -\\frac{4}{9} \\left[ \\frac{3}{4} \\left( \\frac{3}{\\pi} \\right)^{1/3} \\right] n_{0}^{4/3} - \\frac{n_{0}A}{3}\n$$\n$$\nK_{\\mathrm{xc}}(n_{0}) = -\\frac{1}{3} \\left( \\frac{3}{\\pi} \\right)^{1/3} n_{0}^{4/3} - \\frac{n_{0}A}{3}\n$$\nFactoring out the common term $-\\frac{1}{3}$, we arrive at the final simplified expression:\n$$\nK_{\\mathrm{xc}}(n_{0}) = -\\frac{1}{3} \\left[ \\left( \\frac{3}{\\pi} \\right)^{1/3} n_{0}^{4/3} + A n_{0} \\right]\n$$\nThis expression is a function of $n_{0}$, $A$, and $\\pi$ as required. The constant $B$ correctly does not appear in the final result as it corresponds to a rigid shift in the energy.",
            "answer": "$$\n\\boxed{-\\frac{1}{3} \\left( \\left(\\frac{3}{\\pi}\\right)^{1/3} n_{0}^{4/3} + A n_{0} \\right)}\n$$"
        }
    ]
}