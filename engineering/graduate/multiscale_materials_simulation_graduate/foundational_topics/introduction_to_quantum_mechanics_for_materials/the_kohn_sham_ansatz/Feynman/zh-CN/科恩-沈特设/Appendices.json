{
    "hands_on_practices": [
        {
            "introduction": "这个练习将引导你完成科恩-尚姆理论中的一个基础性计算。通过为一个简单的双电子体系推导精确交换能，你将揭示在此特殊情况下科恩-尚姆和哈特里-福克交换形式之间的精确关系，从而阐明密度泛函理论中“精确交换”的含义。",
            "id": "3847211",
            "problem": "考虑一个在密度泛函理论的科恩-沈 (KS) 拟设内建模的自旋非极化双电子体系，其中无相互作用的参考体系能够再现精确的物理电子密度。假设两个电子以相反的自旋（一个单重态）占据同一个归一化的球对称空间轨道，该轨道由斯莱特型函数 (Slater-type function) 描述\n$$\\varphi(\\mathbf{r})=\\left(\\frac{\\zeta^{3}}{\\pi}\\right)^{\\frac{1}{2}}\\exp(-\\zeta r),$$\n其中 $r=|\\mathbf{r}|$ 且 $\\zeta>0$ 是一个变分逆长度标度参数。因此，物理电子密度为\n$$n(\\mathbf{r})=2|\\varphi(\\mathbf{r})|^{2}= \\frac{2\\zeta^{3}}{\\pi}\\exp(-2\\zeta r)。$$\n全程使用原子单位，并以哈特里 (Hartree) 为单位表示最终能量。\n\n从哈特里能量泛函的基本定义\n$$E_{H}[n]=\\frac{1}{2}\\int d^{3}\\mathbf{r}\\int d^{3}\\mathbf{r}'\\;\\frac{n(\\mathbf{r})\\,n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|},$$\n以及单个斯莱特行列式的交换能（源于费米子反对称性）出发，\n严格推导在 KS 单行列式近似下给定密度的精确交换能 $E_{x}^{\\mathrm{KS}}$。然后，使用单个斯莱特行列式的哈特里-福克 (HF) 交换能定义，推导相同状态下的 $E_{x}^{\\mathrm{HF}}$ 并比较两者。\n\n您的推导必须：\n- 从所述的定义和 KS 拟设出发，不使用任何针对双电子体系交换能的预给快捷恒等式。\n- 利用球对称性来显式计算所有必需的积分，并获得一个以 $\\zeta$ 表示的闭式表达式。\n- 为该体系的交换能值提供一个同时适用于 $E_{x}^{\\mathrm{KS}}$ 和 $E_{x}^{\\mathrm{HF}}$ 的单一最终解析表达式。\n\n以 $\\zeta$ 的单一闭式表达式形式给出最终答案。无需四舍五入。以哈特里为单位表示最终能量。",
            "solution": "首先验证问题，以确保其科学上合理、良定且完整。\n\n### 第1步：提取已知条件\n- **体系：** 一个自旋非极化的$2$电子体系。\n- **模型：** 密度泛函理论的科恩-沈 (KS) 拟设。\n- **条件：** KS 无相互作用参考体系能够再现精确的物理电子密度。\n- **状态：** 一个单重态，其中两个电子以相反的自旋占据同一个归一化的、球对称的空间轨道 $\\varphi(\\mathbf{r})$。\n- **轨道函数：** $\\varphi(\\mathbf{r})=\\left(\\frac{\\zeta^{3}}{\\pi}\\right)^{\\frac{1}{2}}\\exp(-\\zeta r)$，其中 $r=|\\mathbf{r}|$ 且 $\\zeta>0$。\n- **电子密度：** $n(\\mathbf{r})=2|\\varphi(\\mathbf{r})|^{2}= \\frac{2\\zeta^{3}}{\\pi}\\exp(-2\\zeta r)$。\n- **原子单位：** 所有计算均在原子单位（$\\hbar=m_e=e=4\\pi\\epsilon_0=1$）下进行，能量以哈特里 (Hartree) 表示。\n- **哈特里能量泛函：** $$E_{H}[n]=\\frac{1}{2}\\int d^{3}\\mathbf{r}\\int d^{3}\\mathbf{r}'\\;\\frac{n(\\mathbf{r})\\,n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}$$。\n- **任务：** 严格推导给定状态的精确 KS 交换能 $E_{x}^{\\mathrm{KS}}$ 和哈特里-福克交换能 $E_{x}^{\\mathrm{HF}}$，证明它们是相同的，并提供一个以 $\\zeta$ 表示的单一闭式表达式。推导必须从基本定义开始。\n\n### 第2步：使用提取的已知条件进行验证\n- **科学依据：** 该问题是量子化学中的一个标准、经典的练习题，旨在探讨哈特里-福克 (HF) 理论与密度泛函理论 (DFT) 在一个简单的、可解析求解的体系（类氦原子）中的关系。所有概念、定义和函数都是该领域的基础。\n- **良定性：** 问题提供了所有必要信息：量子态（来自一个双占据轨道的单个斯莱特行列式）、轨道的函数形式以及待计算能量项的定义。目标明确，且存在唯一解。\n- **客观性：** 问题以精确、客观和标准的科学语言陈述。\n- **完整性与一致性：** 问题是自洽的，没有矛盾。给定的轨道已正确归一化，并且密度对于一个双占据轨道是正确定义的。\n\n### 第3步：结论与行动\n该问题是**有效的**。将提供一个完整的、带推理过程的解答。\n\n### 推导\n\n该问题要求计算一个处于单重态的 $2$ 电子体系的交换能，该体系由单个斯莱特行列式描述。两个自旋轨道为 $\\psi_1(\\mathbf{x}_1) = \\varphi(\\mathbf{r}_1)\\alpha(\\omega_1)$ 和 $\\psi_2(\\mathbf{x}_2) = \\varphi(\\mathbf{r}_2)\\beta(\\omega_2)$，其中 $\\mathbf{x}=(\\mathbf{r}, \\omega)$ 表示空间-自旋坐标。空间轨道 $\\varphi(\\mathbf{r})$ 如下所示：\n$$ \\varphi(\\mathbf{r})=\\left(\\frac{\\zeta^{3}}{\\pi}\\right)^{\\frac{1}{2}}\\exp(-\\zeta r) $$\n$N$电子总波函数是斯莱特行列式 $\\Psi(\\mathbf{x}_1, \\mathbf{x}_2) = \\frac{1}{\\sqrt{2}}|\\psi_1(\\mathbf{x}_1) \\psi_2(\\mathbf{x}_2)|$。\n\n首先，我们建立哈特里-福克 ($E_{x}^{\\mathrm{HF}}$) 和科恩-沈 ($E_{x}^{\\mathrm{KS}}$) 交换能的形式体系。\n\n对于一组占据的自旋轨道 $\\{\\psi_i\\}$，哈特里-福克交换能由以下通用公式给出（以原子单位计）：\n$$ E_{x}^{\\mathrm{HF}} = -\\frac{1}{2} \\sum_{i,j}^{\\mathrm{occ}} \\iint d^3\\mathbf{r}_1 d^3\\mathbf{r}_2 \\frac{\\psi_i^*(\\mathbf{x}_1)\\psi_j^*(\\mathbf{x}_2)\\psi_j(\\mathbf{x}_1)\\psi_i(\\mathbf{x}_2)}{|\\mathbf{r}_1-\\mathbf{r}_2|} $$\n对自旋坐标积分后，上式变为：\n$$ E_{x}^{\\mathrm{HF}} = -\\frac{1}{2} \\sum_{i,j}^{\\mathrm{occ}} \\delta_{\\sigma_i, \\sigma_j} \\iint d^3\\mathbf{r}_1 d^3\\mathbf{r}_2 \\frac{\\varphi_i^*(\\mathbf{r}_1)\\varphi_j^*(\\mathbf{r}_2)\\varphi_j(\\mathbf{r}_1)\\varphi_i(\\mathbf{r}_2)}{|\\mathbf{r}_1-\\mathbf{r}_2|} $$\n其中 $\\varphi_i, \\varphi_j$ 是轨道的空间部分，$\\sigma_i, \\sigma_j$ 是它们的自旋。\n\n对于给定的 $2$ 电子单重态，我们有两个占据的自旋轨道：\n1. $i=1$：$\\varphi_1(\\mathbf{r})=\\varphi(\\mathbf{r})$，自旋为 $\\sigma_1 = \\alpha$（自旋向上）。\n2. $i=2$：$\\varphi_2(\\mathbf{r})=\\varphi(\\mathbf{r})$，自旋为 $\\sigma_2 = \\beta$（自旋向下）。\n\n对 $i,j \\in \\{1,2\\}$ 的求和有 $4$ 项。克罗内克 $\\delta$ 函数 $\\delta_{\\sigma_i, \\sigma_j}$ 仅在自旋相同时非零，即对于项 $(i,j)=(1,1)$ 和 $(i,j)=(2,2)$。交叉项 $(1,2)$ 和 $(2,1)$ 为零，因为 $\\delta_{\\alpha,\\beta}=0$。\n对于 $(i,j)=(1,1)$：$\\delta_{\\alpha,\\alpha}=1$。积分为 $\\iint d^3\\mathbf{r}_1 d^3\\mathbf{r}_2 \\frac{\\varphi^*(\\mathbf{r}_1)\\varphi^*(\\mathbf{r}_2)\\varphi(\\mathbf{r}_1)\\varphi(\\mathbf{r}_2)}{|\\mathbf{r}_1-\\mathbf{r}_2|}$。\n对于 $(i,j)=(2,2)$：$\\delta_{\\beta,\\beta}=1$。积分相同。\n因此，HF 交换能为：\n$$ E_{x}^{\\mathrm{HF}} = -\\frac{1}{2} \\left[ \\iint \\frac{|\\varphi(\\mathbf{r}_1)|^2 |\\varphi(\\mathbf{r}_2)|^2}{|\\mathbf{r}_1-\\mathbf{r}_2|}d^3\\mathbf{r}_1 d^3\\mathbf{r}_2 + \\iint \\frac{|\\varphi(\\mathbf{r}_1)|^2 |\\varphi(\\mathbf{r}_2)|^2}{|\\mathbf{r}_1-\\mathbf{r}_2|}d^3\\mathbf{r}_1 d^3\\mathbf{r}_2 \\right] $$\n$$ E_{x}^{\\mathrm{HF}} = - \\iint \\frac{|\\varphi(\\mathbf{r}_1)|^2 |\\varphi(\\mathbf{r}_2)|^2}{|\\mathbf{r}_1-\\mathbf{r}_2|}d^3\\mathbf{r}_1 d^3\\mathbf{r}_2 $$\n该表达式表示对应于单个轨道 $\\rho_\\varphi(\\mathbf{r}) = |\\varphi(\\mathbf{r})|^2$ 的电荷分布的经典静电自排斥能的负值。\n\n科恩-沈交换能 $E_{x}^{\\mathrm{KS}}$ 定义为虚构的无相互作用 KS 参考体系的哈特里-福克交换能。根据构造，KS 体系的轨道能产生相互作用体系的精确密度 $n(\\mathbf{r})$。对于这个 $2$ 电子单重态体系，密度 $n(\\mathbf{r}) = 2|\\varphi(\\mathbf{r})|^2$ 是可以通过单个双占据的 KS 空间轨道 $\\varphi_{\\mathrm{KS}}(\\mathbf{r})$ 实现的无相互作用 $v_S$-可表示的。问题陈述，具有轨道 $\\varphi(\\mathbf{r})$ 的无相互作用体系再现了物理密度，因此我们可以确定 $\\varphi_{\\mathrm{KS}}(\\mathbf{r})=\\varphi(\\mathbf{r})$。所以，$E_{x}^{\\mathrm{KS}}$ 的计算与 $E_{x}^{\\mathrm{HF}}$ 的计算完全相同。\n$$ E_{x}^{\\mathrm{KS}} = E_{x}^{\\mathrm{HF}} = - \\iint \\frac{|\\varphi(\\mathbf{r}_1)|^2 |\\varphi(\\mathbf{r}_2)|^2}{|\\mathbf{r}_1-\\mathbf{r}_2|}d^3\\mathbf{r}_1 d^3\\mathbf{r}_2 $$\n对于这个特定体系，HF 交换能与精确的 KS 交换能相同。因此，问题简化为计算这个单一积分。我们定义轨道电荷密度 $\\rho(\\mathbf{r}) = |\\varphi(\\mathbf{r})|^2 = \\frac{\\zeta^3}{\\pi}\\exp(-2\\zeta r)$。需要计算的积分是：\n$$ I = \\iint \\frac{\\rho(\\mathbf{r}_1) \\rho(\\mathbf{r}_2)}{|\\mathbf{r}_1-\\mathbf{r}_2|} d^3\\mathbf{r}_1 d^3\\mathbf{r}_2 $$\n这个积分是电荷分布 $\\rho(\\mathbf{r})$ 的静电自能。它可以计算为 $I = \\int \\rho(\\mathbf{r}_1) V(\\mathbf{r}_1) d^3\\mathbf{r}_1$，其中 $V(\\mathbf{r}_1)$ 是由 $\\rho(\\mathbf{r}_2)$ 产生的静电势：\n$$ V(\\mathbf{r}_1) = \\int \\frac{\\rho(\\mathbf{r}_2)}{|\\mathbf{r}_1 - \\mathbf{r}_2|} d^3\\mathbf{r}_2 $$\n由于 $\\rho(\\mathbf{r})$ 的球对称性，电势 $V(\\mathbf{r})$ 也将是球对称的。我们使用 $1/|\\mathbf{r}_1 - \\mathbf{r}_2|$ 的球谐函数展开式，在对 $\\mathbf{r}_2$ 进行角度积分后，只有 $l=0$ 项会保留下来：\n$$ \\frac{1}{|\\mathbf{r}_1 - \\mathbf{r}_2|} \\rightarrow \\frac{1}{r_>} = \\frac{1}{\\max(r_1, r_2)} $$\n因此，$V(r_1)$ 变为：\n$$ V(r_1) = \\int_0^{2\\pi}\\int_0^\\pi\\int_0^\\infty \\frac{\\rho(r_2)}{r_>} r_2^2 \\sin\\theta_2 dr_2 d\\theta_2 d\\phi_2 = 4\\pi \\int_0^\\infty \\frac{\\rho(r_2)}{r_>} r_2^2 dr_2 $$\n代入 $\\rho(r_2) = \\frac{\\zeta^3}{\\pi}\\exp(-2\\zeta r_2)$：\n$$ V(r_1) = 4\\pi \\frac{\\zeta^3}{\\pi} \\int_0^\\infty \\frac{\\exp(-2\\zeta r_2)}{\\max(r_1, r_2)} r_2^2 dr_2 = 4\\zeta^3 \\left[ \\frac{1}{r_1}\\int_0^{r_1} r_2^2 e^{-2\\zeta r_2}dr_2 + \\int_{r_1}^\\infty r_2 e^{-2\\zeta r_2}dr_2 \\right] $$\n我们使用标准积分：\n$\\int x^2 e^{-ax} dx = -e^{-ax}(\\frac{x^2}{a} + \\frac{2x}{a^2} + \\frac{2}{a^3})$\n$\\int x e^{-ax} dx = -e^{-ax}(\\frac{x}{a} + \\frac{1}{a^2})$\n令 $a=2\\zeta$：\n第一个积分项：\n$$ \\frac{1}{r_1}\\left[ -e^{-2\\zeta r_2}\\left(\\frac{r_2^2}{2\\zeta} + \\frac{2r_2}{4\\zeta^2} + \\frac{2}{8\\zeta^3}\\right) \\right]_0^{r_1} = \\frac{1}{r_1}\\left[ -e^{-2\\zeta r_1}\\left(\\frac{r_1^2}{2\\zeta} + \\frac{r_1}{2\\zeta^2} + \\frac{1}{4\\zeta^3}\\right) + \\frac{1}{4\\zeta^3} \\right] $$\n第二个积分项：\n$$ \\left[ -e^{-2\\zeta r_2}\\left(\\frac{r_2}{2\\zeta} + \\frac{1}{4\\zeta^2}\\right) \\right]_{r_1}^\\infty = 0 - \\left( -e^{-2\\zeta r_1}\\left(\\frac{r_1}{2\\zeta} + \\frac{1}{4\\zeta^2}\\right) \\right) = e^{-2\\zeta r_1}\\left(\\frac{r_1}{2\\zeta} + \\frac{1}{4\\zeta^2}\\right) $$\n合并并乘以 $4\\zeta^3$：\n$$ V(r_1) = 4\\zeta^3 \\left[ \\frac{1}{4\\zeta^3 r_1} - \\frac{e^{-2\\zeta r_1}}{r_1}\\left(\\frac{r_1^2}{2\\zeta} + \\frac{r_1}{2\\zeta^2} + \\frac{1}{4\\zeta^3}\\right) + e^{-2\\zeta r_1}\\left(\\frac{r_1}{2\\zeta} + \\frac{1}{4\\zeta^2}\\right) \\right] $$\n$$ V(r_1) = \\frac{1}{r_1} - e^{-2\\zeta r_1}\\left(2\\zeta^2 r_1 + 2\\zeta + \\frac{1}{r_1}\\right) + e^{-2\\zeta r_1}\\left(2\\zeta^2 r_1 + \\zeta\\right) $$\n$$ V(r_1) = \\frac{1}{r_1} + e^{-2\\zeta r_1} \\left( -2\\zeta^2 r_1 - 2\\zeta - \\frac{1}{r_1} + 2\\zeta^2 r_1 + \\zeta \\right) = \\frac{1}{r_1} - e^{-2\\zeta r_1} \\left( \\zeta + \\frac{1}{r_1} \\right) $$\n现在我们计算最终积分 $I = \\int \\rho(r_1) V(r_1) d^3\\mathbf{r}_1$：\n$$ I = \\int_0^\\infty \\left( \\frac{\\zeta^3}{\\pi} e^{-2\\zeta r_1} \\right) \\left( \\frac{1}{r_1} - \\left(\\zeta + \\frac{1}{r_1}\\right)e^{-2\\zeta r_1} \\right) 4\\pi r_1^2 dr_1 $$\n$$ I = 4\\zeta^3 \\int_0^\\infty \\left( r_1 e^{-2\\zeta r_1} - (\\zeta r_1^2 + r_1)e^{-4\\zeta r_1} \\right) dr_1 $$\n我们使用伽马函数积分 $\\int_0^\\infty x^n e^{-ax} dx = \\frac{n!}{a^{n+1}}$ 来评估这些项：\n- 第一项：$\\int_0^\\infty r_1 e^{-2\\zeta r_1} dr_1 = \\frac{1!}{(2\\zeta)^{1+1}} = \\frac{1}{4\\zeta^2}$。\n- 第二项：$\\int_0^\\infty \\zeta r_1^2 e^{-4\\zeta r_1} dr_1 = \\zeta \\frac{2!}{(4\\zeta)^{2+1}} = \\zeta \\frac{2}{64\\zeta^3} = \\frac{1}{32\\zeta^2}$。\n- 第三项：$\\int_0^\\infty r_1 e^{-4\\zeta r_1} dr_1 = \\frac{1!}{(4\\zeta)^{1+1}} = \\frac{1}{16\\zeta^2}$。\n对积分部分求和：\n$$ \\int_0^\\infty (\\dots) dr_1 = \\frac{1}{4\\zeta^2} - \\left( \\frac{1}{32\\zeta^2} + \\frac{1}{16\\zeta^2} \\right) = \\frac{1}{4\\zeta^2} - \\frac{3}{32\\zeta^2} = \\frac{8-3}{32\\zeta^2} = \\frac{5}{32\\zeta^2} $$\n最后，我们乘以预因子 $4\\zeta^3$：\n$$ I = 4\\zeta^3 \\left( \\frac{5}{32\\zeta^2} \\right) = \\frac{20\\zeta^3}{32\\zeta^2} = \\frac{5}{8}\\zeta $$\n交换能为 $E_x = -I$。\n$$ E_{x}^{\\mathrm{KS}} = E_{x}^{\\mathrm{HF}} = -\\frac{5}{8}\\zeta $$\n这个单一表达式就是最终答案，对于这个精确定义的体系，它对 KS 和 HF 交换能都有效。",
            "answer": "$$\n\\boxed{-\\frac{5}{8}\\zeta}\n$$"
        },
        {
            "introduction": "近似密度泛函理论中一个众所周知的挑战是“带隙问题”，即科恩-尚姆本征值带隙会系统性地低估真实的基态带隙。本练习使用一个简化但强大的模型来探究这种差异的根本原因：交换关联泛函的导数不连续性。这个练习将帮助你理解为何科恩-尚姆本征值通常不等于物理上的电离能或电子亲和能。",
            "id": "3847241",
            "problem": "考虑在Kohn-Sham密度泛函理论 (Kohn-Sham DFT) 中一个绝缘有限体系的基本能隙。Hohenberg-Kohn定理指出，基态能量是密度的泛函，而Kohn-Sham拟设将相互作用的基态映射到一个无相互作用的体系，该体系具有与相互作用体系密度相匹配的单粒子轨道。电离能定义为 $I = E(N-1) - E(N)$，电子亲和能定义为 $A = E(N) - E(N+1)$，其中 $E(N)$ 是在整数粒子数 $N$ 时的精确基态总能量。基本能隙为 $E_{\\mathrm{g}} = I - A = E(N+1) + E(N-1) - 2E(N)$。Kohn-Sham本征值能隙定义为 $E_{\\mathrm{g}}^{\\mathrm{KS}} = \\varepsilon_{\\mathrm{LUMO}}(N) - \\varepsilon_{\\mathrm{HOMO}}(N)$，其中 $\\varepsilon_{\\mathrm{LUMO}}(N)$ 和 $\\varepsilon_{\\mathrm{HOMO}}(N)$ 分别是 $N$ 电子基态的最低未占据和最高占据Kohn-Sham轨道能量。差值 $E_{\\mathrm{g}} - E_{\\mathrm{g}}^{\\mathrm{KS}}$ 是交换相关导数不连续性。\n\n假设一个简单的、有限的、非金属体系的模型如下：\n- Kohn-Sham轨道能量是一个固定的、有序的集合 $\\{\\varepsilon_i\\}_{i=1}^{M}$（单位为电子伏特），与 $N$ 无关，并排序为 $\\varepsilon_1 \\le \\varepsilon_2 \\le \\cdots \\le \\varepsilon_M$。\n- 对于整数 $N$ 且 $1 \\le N \\le M$，无相互作用总能量为 $E_0(N) = \\sum_{i=1}^{N} \\varepsilon_i$。\n- 在整数 $N$ 时的相互作用多体总能量由恒定相互作用形式 $E(N) = E_0(N) + \\tfrac{1}{2} U (N - N_0)^2 + C$ 建模，其中 $U \\ge 0$（单位为电子伏特）是一个充电能参数，$N_0$ 是中性电子数且 $1 \\le N_0 \\le M-1$，$C$ 是一个在能量差中会抵消的无关常数。所有能量都必须以电子伏特 (eV) 表示。\n\n任务：\n- 仅从上述 $I$、$A$、$E_{\\mathrm{g}}$ 和 $E_{\\mathrm{g}}^{\\mathrm{KS}}$ 的定义以及给定的 $E(N)$ 模型出发，实现一个计算方案，对每个参数集计算：\n  1. 通过总能量差 $E(N_0+1) + E(N_0-1) - 2E(N_0)$ 计算基本能隙 $E_{\\mathrm{g}}$。\n  2. 计算Kohn-Sham本征值能隙 $E_{\\mathrm{g}}^{\\mathrm{KS}}$ 为 $\\varepsilon_{N_0+1} - \\varepsilon_{N_0}$。\n  3. 计算交换相关导数不连续性 $\\Delta_{\\mathrm{xc}} = E_{\\mathrm{g}} - E_{\\mathrm{g}}^{\\mathrm{KS}}$。\n- 所有输出必须以电子伏特 (eV) 为单位，并四舍五入到六位小数。\n\n测试套件：\n对于每个案例，使用元组 $(\\{\\varepsilon_i\\}, N_0, U)$，能量单位为eV。\n- 案例1 (理想情况，无充电)：$\\{\\varepsilon_i\\} = \\{-5.0,-1.0,3.0,7.0\\}$, $N_0 = 2$, $U = 0.0$。\n- 案例2 (有限充电)：$\\{\\varepsilon_i\\} = \\{-5.0,-1.0,3.0,7.0\\}$, $N_0 = 2$, $U = 2.5$。\n- 案例3 (小Kohn-Sham能隙)：$\\{\\varepsilon_i\\} = \\{-1.0,-0.2,0.1,2.0\\}$, $N_0 = 2$, $U = 1.0$。\n- 案例4 (简并Kohn-Sham边缘)：$\\{\\varepsilon_i\\} = \\{-2.0,0.0,0.0,1.0\\}$, $N_0 = 2$, $U = 0.8$。\n- 案例5 (近零充电，稳定性边缘)：$\\{\\varepsilon_i\\} = \\{-3.0,-0.1,0.0,0.2,1.5\\}$, $N_0 = 3$, $U = 0.000001$。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，包含一个嵌套列表，其中每个内部列表对应一个测试案例，并按顺序包含三个条目 $[E_{\\mathrm{g}}, E_{\\mathrm{g}}^{\\mathrm{KS}}, \\Delta_{\\mathrm{xc}}]$，所有值均以eV为单位，每个值四舍五入到六位小数。该行必须是一个格式化为例如 $[[x_{11},x_{12},x_{13}],[x_{21},x_{22},x_{23}],\\dots]$ 的单个字符串，不含空格。",
            "solution": "我们从基于Kohn-Sham密度泛函理论 (Kohn-Sham DFT) 的定义开始。对于一个 $N$ 电子体系，电离能为 $I = E(N-1) - E(N)$，电子亲和能为 $A = E(N) - E(N+1)$。因此，基本能隙为 $E_{\\mathrm{g}} = I - A = E(N+1) + E(N-1) - 2E(N)$。Kohn-Sham本征值能隙为 $E_{\\mathrm{g}}^{\\mathrm{KS}} = \\varepsilon_{\\mathrm{LUMO}}(N) - \\varepsilon_{\\mathrm{HOMO}}(N)$，对于一个非简并的有序Kohn-Sham本征值集合，对于 $N$ 电子基态，这等于 $\\varepsilon_{N+1} - \\varepsilon_{N}$。\n\n我们采用一个简单且广泛使用的恒定相互作用模型来表示整数 $N$ 时的相互作用总能量：\n$$\nE(N) = E_0(N) + \\frac{1}{2} U (N - N_0)^2 + C,\n$$\n其中 $E_0(N) = \\sum_{i=1}^{N} \\varepsilon_i$ 是无相互作用（Kohn-Sham）的已占据能级之和，$U \\ge 0$ 是一个充电能参数，它概括了超出无相互作用参考体系部分的电子-电子相互作用代价，$N_0$ 是中性电子数，$C$ 是一个在能量差中会抵消的恒定偏移量。所有 $\\varepsilon_i$ 的单位都是电子伏特，且 $1 \\le N_0 \\le M-1$ 确保最高占据分子轨道 (HOMO) 和最低未占据分子轨道 (LUMO) 都存在。\n\n我们的第一性原理推导仅使用这些定义：\n1. 通过总能量的显式有限差分计算基本能隙：\n$$\nE_{\\mathrm{g}} = E(N_0+1) + E(N_0-1) - 2 E(N_0).\n$$\n代入$E(N)$的模型：\n$$\n\\begin{aligned}\nE_{\\mathrm{g}} = \\Big(E_0(N_0+1) + \\tfrac{1}{2} U (N_0+1 - N_0)^2\\Big) + \\Big(E_0(N_0-1) + \\tfrac{1}{2} U (N_0-1 - N_0)^2\\Big) \\\\\n\\quad - 2 \\Big(E_0(N_0) + \\tfrac{1}{2} U (N_0 - N_0)^2\\Big).\n\\end{aligned}\n$$\n因为 $(N_0+1-N_0)^2 = 1$，$(N_0-1-N_0)^2 = 1$，以及 $(N_0 - N_0)^2 = 0$，二次项得以简化，得到：\n$$\nE_{\\mathrm{g}} = \\big(E_0(N_0+1) + E_0(N_0-1) - 2 E_0(N_0)\\big) + U.\n$$\n\n2. 化简无相互作用能量的组合项。因为 $E_0(N) = \\sum_{i=1}^{N} \\varepsilon_i$，我们有 $E_0(N_0+1) = E_0(N_0) + \\varepsilon_{N_0+1}$ 和 $E_0(N_0-1) = E_0(N_0) - \\varepsilon_{N_0}$。因此：\n$$\nE_0(N_0+1) + E_0(N_0-1) - 2 E_0(N_0) = \\varepsilon_{N_0+1} - \\varepsilon_{N_0}.\n$$\n\n3. 识别在 $N_0$ 电子数时的Kohn-Sham本征值能隙：\n$$\nE_{\\mathrm{g}}^{\\mathrm{KS}} = \\varepsilon_{N_0+1} - \\varepsilon_{N_0}.\n$$\n因此，基本能隙变为：\n$$\nE_{\\mathrm{g}} = E_{\\mathrm{g}}^{\\mathrm{KS}} + U.\n$$\n\n4. 交换相关导数不连续性定义为：\n$$\n\\Delta_{\\mathrm{xc}} = E_{\\mathrm{g}} - E_{\\mathrm{g}}^{\\mathrm{KS}} = U.\n$$\n\n这些关系直接从 $I$、$A$ 和Kohn-Sham本征值能隙的定义以及恒定相互作用能量模型中推导出来。重要的是，常数 $C$ 在所有需要的差分计算中都被抵消，与计算的量无关。\n\n为每个测试案例实现的算法流程：\n- 输入有序列表 $\\{\\varepsilon_i\\}$、中性电子数 $N_0$ 和充电参数 $U$。\n- 通过对最低的 $N$ 个本征值求和，计算 $N \\in \\{N_0-1, N_0, N_0+1\\}$ 时的 $E_0(N)$。\n- 使用 $E(N) = E_0(N) + \\tfrac{1}{2} U (N - N_0)^2$ 计算这些 $N$ 对应的 $E(N)$。\n- 计算 $E_{\\mathrm{g}} = E(N_0+1) + E(N_0-1) - 2 E(N_0)$。\n- 计算 $E_{\\mathrm{g}}^{\\mathrm{KS}} = \\varepsilon_{N_0+1} - \\varepsilon_{N_0}$。\n- 计算 $\\Delta_{\\mathrm{xc}} = E_{\\mathrm{g}} - E_{\\mathrm{g}}^{\\mathrm{KS}}$。\n- 将 $E_{\\mathrm{g}}$、$E_{\\mathrm{g}}^{\\mathrm{KS}}$ 和 $\\Delta_{\\mathrm{xc}}$ 各自四舍五入到六位小数，并以电子伏特 (eV) 为单位报告。\n\n在所提供的案例上进行验证：\n- 案例1：$\\{\\varepsilon_i\\} = \\{-5.0,-1.0,3.0,7.0\\}$, $N_0=2$, $U=0.0$。那么 $E_{\\mathrm{g}}^{\\mathrm{KS}} = 3.0 - (-1.0) = 4.0$, $E_{\\mathrm{g}} = 4.0 + 0.0 = 4.0$, $\\Delta_{\\mathrm{xc}} = 0.0$。\n- 案例2：相同本征值, $U=2.5$。那么 $E_{\\mathrm{g}}^{\\mathrm{KS}} = 4.0$, $E_{\\mathrm{g}} = 6.5$, $\\Delta_{\\mathrm{xc}} = 2.5$。\n- 案例3：$\\{\\varepsilon_i\\} = \\{-1.0,-0.2,0.1,2.0\\}$, $N_0=2$, $U=1.0$。那么 $E_{\\mathrm{g}}^{\\mathrm{KS}} = 0.1 - (-0.2) = 0.3$, $E_{\\mathrm{g}} = 1.3$, $\\Delta_{\\mathrm{xc}} = 1.0$。\n- 案例4：$\\{\\varepsilon_i\\} = \\{-2.0,0.0,0.0,1.0\\}$, $N_0=2$, $U=0.8$。那么 $E_{\\mathrm{g}}^{\\mathrm{KS}} = 0.0 - 0.0 = 0.0$, $E_{\\mathrm{g}} = 0.8$, $\\Delta_{\\mathrm{xc}} = 0.8$。\n- 案例5：$\\{\\varepsilon_i\\} = \\{-3.0,-0.1,0.0,0.2,1.5\\}$, $N_0=3$, $U=0.000001$。那么 $E_{\\mathrm{g}}^{\\mathrm{KS}} = 0.2 - 0.0 = 0.2$, $E_{\\mathrm{g}} = 0.200001$, $\\Delta_{\\mathrm{xc}} = 0.000001$。\n\n实现应输出一个格式化为嵌套列表 $[[E_{\\mathrm{g}}^{(1)},E_{\\mathrm{g}}^{\\mathrm{KS},(1)},\\Delta_{\\mathrm{xc}}^{(1)}],\\dots]$ 的单行字符串，所有值都以eV为单位，四舍五入到六位小数，且不含空格。",
            "answer": "[[4.000000,4.000000,0.000000],[6.500000,4.000000,2.500000],[1.300000,0.300000,1.000000],[0.800000,0.000000,0.800000],[0.200001,0.200000,0.000001]]"
        },
        {
            "introduction": "从理论模型转向真实世界的材料模拟，需要仔细关注计算参数以确保结果的准确性。本练习旨在解决一个关键任务：通过系统地选择k点网格密度和平面波能量截断，来收敛周期性固体的总能量。通过实现一个基于理论误差模型的收敛方案，你将在任何可靠的密度泛函理论计算的基础步骤中获得实践经验。",
            "id": "3847246",
            "problem": "您的任务是，在密度泛函理论（DFT）的Kohn-Sham ansatz框架内，为硅原胞形式化、论证并算法化地选择一个布里渊区（BZ）采样网格和一个平面波动能截断。您的程序必须基于误差控制，使用受第一性原理启发且经过充分检验的数值事实（关于数值积分和傅里叶尾部截断）来实现有原则的选择。其根本目标是实现总能量收敛至$1$ meV/原子以内，并在最终输出中以meV/原子为单位表示。您的方法必须基于以下科学上合理的基础：\n\n- Kohn-Sham ansatz将一个相互作用的多电子系统映射为在有效势中运动的无相互作用电子，该有效势依赖于电子密度，总能量由电子密度的泛函给出。周期性体系中总能量的评估涉及对倒易空间布里渊区（BZ）的积分，以及在基组中对波函数的表示。\n- 对于绝缘硅（金刚石结构），一个均匀的、以$\\Gamma$为中心的$N\\times N\\times N$点Monkhorst-Pack（MP）网格是常用于BZ积分的数值积分方法。对于BZ中的光滑被积函数，等权重格点积分产生的误差会随着每个方向上的点数呈幂律衰减。一个广泛使用且得到充分支持的模型是形如$\\Delta E_k \\le C_k N^{-p}$的误差界，其中$p \\ge 2$，常数$C_k$由被积函数的曲率决定。\n- 对于保范赝势，光滑的赝电荷密度和赝波函数的傅里叶分量在$|\\mathbf{G}|$中会快速衰减，通常建模为类高斯衰减。在动能截断$E_{\\mathrm{cut}}$处截断平面波基组，相当于丢弃$|\\mathbf{G}| > G_{\\mathrm{cut}}$的傅里叶分量，其中$E_{\\mathrm{cut}} = \\frac{\\hbar^2 G_{\\mathrm{cut}}^2}{2 m_e}$。一个保守且有物理动机的尾部误差界被建模为$\\Delta E_{\\mathrm{pw}} \\le C_G \\,\\mathrm{erfc}\\!\\left(\\sqrt{\\alpha}\\, G_{\\mathrm{cut}}\\right)$，其中$\\alpha > 0$是一个光滑度参数（单位为$\\text{\\AA}^2$），$C_G$是一个能量标度（单位为eV），$\\mathrm{erfc}(\\cdot)$是捕获$G_{\\mathrm{cut}}$之外高斯尾的互补误差函数。\n\n使用这些基础，实施以下选择流程：\n\n1. 采用一个以$\\Gamma$为中心的、尺寸为$N\\times N\\times N$的均匀Monkhorst-Pack网格，其中$N$为正整数。\n2. 采用一个以eV为单位的平面波动能截断$E_{\\mathrm{cut}}$，通过$E_{\\mathrm{cut}} = \\frac{\\hbar^2 G_{\\mathrm{cut}}^2}{2 m_e}$将其与倒易空间半径$G_{\\mathrm{cut}}$（以$\\text{\\AA}^{-1}$表示）关联起来。使用$\\hbar$（单位为$\\mathrm{J\\cdot s}$）和$m_e$（单位为$\\mathrm{kg}$），并一致地在eV和J之间进行转换。\n3. 对于每个测试场景，在指定的搜索范围内确定最小的对$(N,E_{\\mathrm{cut}})$，使得组合的每原子能量误差界\n$$\n\\Delta E_{\\text{tot}}(N, E_{\\mathrm{cut}}) \\equiv \\Delta E_k(N) + \\Delta E_{\\mathrm{pw}}(E_{\\mathrm{cut}}) \\le \\delta,\n$$\n满足目标容差$\\delta = 0.001$ eV（即$1$ meV/原子），其中$\\Delta E_k(N) = C_k N^{-p}$且$\\Delta E_{\\mathrm{pw}}(E_{\\mathrm{cut}}) = C_G \\,\\mathrm{erfc}\\!\\left(\\sqrt{\\alpha}\\, G_{\\mathrm{cut}}\\right)$。如果$\\Delta E_k(N) > \\delta$，则没有任何$E_{\\mathrm{cut}}$的选择能满足容差，因为$\\Delta E_{\\mathrm{pw}} \\ge 0$。在所有情况下，选择满足容差的字典序最小对$(N,E_{\\mathrm{cut}})$，即首先最小化$N$，然后最小化$E_{\\mathrm{cut}}$。\n\n用于单位换算的物理常数必须是：\n- $\\hbar = 1.054\\,571\\,817 \\times 10^{-34}$ J·s,\n- $m_e = 9.109\\,383\\,7015 \\times 10^{-31}$ kg,\n- $1$ eV $= 1.602\\,176\\,634 \\times 10^{-19}$ J.\n\n您的程序必须为以下测试套件实施并解决问题，每个案例都是针对单个原子并使用上述误差界：\n\n- 案例A（软赝势，中等k点敏感度）：$\\alpha = 0.20$ $\\text{\\AA}^2$, $C_k = 0.020$ eV, $p = 2$, $C_G = 0.005$ eV；搜索范围：$N \\in \\{2,3,\\dots,32\\}$，$E_{\\mathrm{cut}} \\in \\{50,51,\\dots,1000\\}$ eV。\n- 案例B（硬赝势）：$\\alpha = 0.050$ $\\text{\\AA}^2$, $C_k = 0.030$ eV, $p = 2$, $C_G = 0.020$ eV；搜索范围：$N \\in \\{2,3,\\dots,32\\}$，$E_{\\mathrm{cut}} \\in \\{50,51,\\dots,1000\\}$ eV。\n- 案例C（k点敏感的被积函数）：$\\alpha = 0.150$ $\\text{\\AA}^2$, $C_k = 0.100$ eV, $p = 2$, $C_G = 0.010$ eV；搜索范围：$N \\in \\{2,3,\\dots,32\\}$，$E_{\\mathrm{cut}} \\in \\{50,51,\\dots,1000\\}$ eV。\n- 案例D（非常光滑，低k点敏感度）：$\\alpha = 0.350$ $\\text{\\AA}^2$, $C_k = 0.010$ eV, $p = 2$, $C_G = 0.004$ eV；搜索范围：$N \\in \\{2,3,\\dots,32\\}$，$E_{\\mathrm{cut}} \\in \\{50,51,\\dots,1000\\}$ eV。\n\n您的程序必须：\n- 通过上述关系式从$E_{\\mathrm{cut}}$计算$G_{\\mathrm{cut}}$（单位为$\\text{\\AA}^{-1}$）。\n- 以eV为单位评估$\\Delta E_k(N)$和$\\Delta E_{\\mathrm{pw}}(E_{\\mathrm{cut}})$，求和得到以eV为单位的$\\Delta E_{\\text{tot}}(N, E_{\\mathrm{cut}})$，并以meV/原子为单位报告最终误差，四舍五入到三位小数。\n- 判断是否满足容差$\\delta = 0.001$ eV，并报告一个布尔值表示收敛性。\n\n本任务不涉及角度单位。所有与能量相关的输出必须按规定以eV或meV/原子表示。对于每个测试用例，输出所选的$N$（整数）、$E_{\\mathrm{cut}}$（以eV为单位的整数）、最终组合误差（以meV/原子为单位的浮点数，四舍五入到三位小数）和收敛布尔值。您的程序应生成单行输出，其中包含一个逗号分隔的四元组列表，每个测试用例一个，并用方括号括起来。例如：$[[N_1,E_{\\mathrm{cut},1},\\text{err}_{1},\\text{conv}_{1}],[N_2,E_{\\mathrm{cut},2},\\text{err}_{2},\\text{conv}_{2}],\\dots]$，其中$\\text{err}_i$的单位是meV/原子。",
            "solution": "问题陈述经评估是有效的。它在科学上基于密度泛函理论（DFT）的既定原则，特别是针对周期性体系的Kohn-Sham ansatz。该问题是适定的，提供了所有必要的物理常数、收敛误差的数学模型，以及寻找唯一解的清晰、客观的流程。参数和搜索范围对于材料模拟是符合实际的。\n\n任务是基于已建立的误差模型，先验地为DFT计算确定一组计算参数。目标是找到计算成本最低的参数——即布里渊区采样网格和平面波能量截断——以达到总能量的目标精度。这是确保第一性原理模拟可靠性的一项基础任务。\n\n在Kohn-Sham框架内，周期性固体的总能量是通过求解单粒子Kohn-Sham方程获得的。数值求解需要两个关键的离散化步骤：\n1. 倒易晶格的第一个布里渊区（BZ）上的积分被替换为在一组离散点（称为k点网格）上的有限求和。此处使用尺寸为$N \\times N \\times N$的均匀、以$\\Gamma$为中心的Monkhorst-Pack网格。与该数值积分相关的误差$\\Delta E_k$被建模为随每个维度的点数$N$呈幂律衰减：\n$$\n\\Delta E_k(N) = C_k N^{-p}\n$$\n其中$C_k$是一个能量标度，指数$p$（给定为$p=2$）取决于被积能带的光滑度。该模型基于周期函数的格点积分理论。\n\n2. Kohn-Sham轨道在基组中展开。对于周期性体系，平面波基组是很自然的选择。基组被截断，仅包含动能$\\frac{\\hbar^2 |\\mathbf{G}|^2}{2m_e}$低于指定截断能$E_{\\mathrm{cut}}$的平面波$\\exp(i\\mathbf{G}\\cdot\\mathbf{r})$。截断该基组所带来的误差$\\Delta E_{\\mathrm{pw}}$，通过假设波函数系数在倒易空间中呈类高斯衰减来建模：\n$$\n\\Delta E_{\\mathrm{pw}}(E_{\\mathrm{cut}}) = C_G \\,\\mathrm{erfc}\\!\\left(\\sqrt{\\alpha}\\, G_{\\mathrm{cut}}\\right)\n$$\n此处，$C_G$是一个能量标度，$\\alpha$是与赝波函数光滑度相关的参数（单位为$\\text{\\AA}^2$，较硬的赝势具有较小的$\\alpha$），而$\\mathrm{erfc}(\\cdot)$是互补误差函数。$G_{\\mathrm{cut}}$是基组中包含的最大倒易晶格矢量的模，单位为$\\text{\\AA}^{-1}$。\n\n动能截断$E_{\\mathrm{cut}}$（单位eV）与倒易空间截断半径$G_{\\mathrm{cut}}$（单位$\\text{\\AA}^{-1}$）之间的关系源自基本的平面波动能公式$E_{\\mathrm{cut}} = \\frac{\\hbar^2 G_{\\mathrm{cut}}^2}{2 m_e}$，并需仔细注意单位。使用提供的物理常数：\n- 普朗克常数：$\\hbar = 1.054571817 \\times 10^{-34}$ J·s\n- 电子质量：$m_e = 9.1093837015 \\times 10^{-31}$ kg\n- 电子伏特到焦耳转换：$1 \\text{ eV} = e \\text{ J}$，其中 $e = 1.602176634 \\times 10^{-19}$ C。\n我们有$E_{\\mathrm{cut}} [\\text{J}] = \\frac{\\hbar^2 (G_{\\mathrm{cut}}[\\text{m}^{-1}])^2}{2 m_e}$。将单位转换为eV和$\\text{\\AA}^{-1}$：\n$E_{\\mathrm{cut}} [\\text{eV}] \\cdot e = \\frac{\\hbar^2 (G_{\\mathrm{cut}} [\\text{\\AA}^{-1}] \\cdot 10^{10})^2}{2 m_e}$\n解出$G_{\\mathrm{cut}} [\\text{\\AA}^{-1}]$可得：\n$$\nG_{\\mathrm{cut}} [\\text{\\AA}^{-1}] = \\left( \\frac{\\sqrt{2 m_e e / \\hbar^2}}{10^{10}} \\right) \\sqrt{E_{\\mathrm{cut}} [\\text{eV}]} \\approx 0.51231685 \\sqrt{E_{\\mathrm{cut}} [\\text{eV}]}\n$$\n该转换因子将用于从给定的$E_{\\mathrm{cut}}$计算$G_{\\mathrm{cut}}$。\n\n总收敛误差是这两项贡献之和：\n$$\n\\Delta E_{\\text{tot}}(N, E_{\\mathrm{cut}}) = \\Delta E_k(N) + \\Delta E_{\\mathrm{pw}}(E_{\\mathrm{cut}})\n$$\n我们的目标是从指定的搜索范围（$N \\in \\{2,3,\\dots,32\\}$, $E_{\\mathrm{cut}} \\in \\{50,51,\\dots,1000\\}$ eV）中找到字典序最小的对$(N, E_{\\mathrm{cut}})$，使得总误差低于容差$\\delta = 0.001$ eV/原子。\n\n找到最优对$(N, E_{\\mathrm{cut}})$的算法流程如下：\n1. 从$N=2$开始，按升序遍历$N$。\n2. 对每个$N$，计算k点采样误差$\\Delta E_k(N) = C_k N^{-p}$。\n3. 检查是否仅$\\Delta E_k(N)$就已超过总误差容差$\\delta$。如果$\\Delta E_k(N) > \\delta$，则没有任何$E_{\\mathrm{cut}}$值能满足收敛标准，因为$\\Delta E_{\\mathrm{pw}}(E_{\\mathrm{cut}})$始终为非负。在这种情况下，我们必须继续处理下一个更大的$N$值。\n4. 如果$\\Delta E_k(N) \\le \\delta$，则可能存在解。平面波基组所需的误差$\\Delta E_{\\mathrm{pw}}$必须小于或等于剩余的误差预算$\\delta_{\\mathrm{pw}} = \\delta - \\Delta E_k(N)$。\n5. 由于$\\Delta E_{\\mathrm{pw}}(E_{\\mathrm{cut}})$是$E_{\\mathrm{cut}}$的单调递减函数，我们可以通过从50 eV开始按升序遍历$E_{\\mathrm{cut}}$来找到满足标准的最小整数$E_{\\mathrm{cut}}$。\n6. 对每个$E_{\\mathrm{cut}}$，我们计算$G_{\\mathrm{cut}}$，然后是$\\Delta E_{\\mathrm{pw}}(E_{\\mathrm{cut}})$，最后是总误差$\\Delta E_{\\text{tot}}(N, E_{\\mathrm{cut}})$。\n7. 第一个满足$\\Delta E_{\\text{tot}}(N, E_{\\mathrm{cut}}) \\le \\delta$的对$(N, E_{\\mathrm{cut}})$就是字典序最小的解。\n8. 对提供的四个测试用例中的每一个都重复此过程，使用它们各自的$\\alpha$、$C_k$、$p$和$C_G$参数。收集最终结果并按规定格式化。总误差以meV/原子为单位报告，即$1000 \\times \\Delta E_{\\text{tot}}[\\text{eV/原子}]$。",
            "answer": "[[5,50,0.902,true],[6,316,1.000,true],[11,80,0.997,true],[4,50,0.648,true]]"
        }
    ]
}