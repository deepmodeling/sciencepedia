{
    "hands_on_practices": [
        {
            "introduction": "波恩-奥本海默近似的核心成果是势能面（对于双原子分子而言是势能曲线），它描述了原子核在电子云产生的有效势场中的运动。这个练习将指导您如何使用一个常见的解析模型——莫尔斯势，来拟合从量子化学计算中获得的势能曲线的局部性质 。通过这种方式，您可以将精确但离散的数值数据转化为一个简洁的解析函数，这对于后续的光谱分析和动力学模拟至关重要。",
            "id": "204375",
            "problem": "在玻恩-奥本海默近似的框架下，对于给定的电子态，双原子分子的电子能量定义了一条势能曲线（PEC），$U(R)$，它是核间距 $R$ 的函数。用于此势能曲线的一个广泛使用的解析模型是莫尔斯势，其表达式为：\n$$ V(R) = D_e \\left(1 - e^{-a(R - R_e)}\\right)^2 $$\n此处，$D_e$ 是相对于势阱最小值的解离能，$R_e$ 是平衡键长，$a$ 是一个控制势阱曲率的参数。\n\n对一个双原子分子进行了高精度的量子化学计算，得到了势能曲线 $U(R)$。通常，通过表征势能在其最小值附近的性质，比对大量数据点进行拟合更为方便。从计算得到的势能曲线中确定了以下几个量：\n1. 平衡键长 $R_e$。\n2. 简谐力常数 $k_f = \\frac{d^2U}{dR^2}\\bigg|_{R=R_e}$。\n3. 三次非谐性常数 $\\gamma = \\frac{d^3U}{dR^3}\\bigg|_{R=R_e}$。\n\n你的任务是找到莫尔斯势的参数，使其能最好地再现计算得到的势能曲线在其最小值附近的性质。通过将莫尔斯势 $V(R)$ 在 $R=R_e$ 处的二阶和三阶导数与给定的常数 $k_f$ 和 $\\gamma$ 相匹配，确定解离能 $D_e$ 关于 $k_f$ 和 $\\gamma$ 的解析表达式。",
            "solution": "莫尔斯势为\n$$V(R)=D_e\\bigl(1-e^{-a(R-R_e)}\\bigr)^2.\\quad\\text{令 }x=R-R_e.$$\n展开并求导：\n$$V(R)=D_e\\bigl(1-2e^{-ax}+e^{-2ax}\\bigr).$$\n一阶导数：\n$$V'(R)=D_e\\bigl(2a e^{-ax}-2a e^{-2ax}\\bigr).$$\n二阶导数：\n$$V''=D_e\\bigl(-2a^2 e^{-ax}+4a^2 e^{-2ax}\\bigr)=2a^2D_e\\bigl(-e^{-ax}+2e^{-2ax}\\bigr).$$\n在平衡位置（$x=0$）处：\n$$V''(0)=2a^2D_e=k_f.\\quad(1)$$\n三阶导数：\n$$V'''=D_e\\bigl(2a^3 e^{-ax}-8a^3 e^{-2ax}\\bigr)=2a^3D_e\\bigl(e^{-ax}-4e^{-2ax}\\bigr).$$\n在 $x=0$ 处：\n$$V'''(0)=-6a^3D_e=\\gamma.\\quad(2)$$\n由 (2)/(1) 可得：\n$$\\frac{\\gamma}{k_f}=\\frac{-6a^3D_e}{2a^2D_e}=-3a\\quad\\Longrightarrow\\quad a=-\\frac{\\gamma}{3k_f}.$$\n代入 (1) 中：\n$$D_e=\\frac{k_f}{2a^2}\n=\\frac{k_f}{2\\bigl(\\frac{\\gamma^2}{9k_f^2}\\bigr)}\n=\\frac{9k_f^3}{2\\gamma^2}.$$",
            "answer": "$$\\boxed{\\frac{9k_f^3}{2\\gamma^2}}$$"
        },
        {
            "introduction": "波恩-奥本海默近似并非总是有效，尤其是在不同电子态的能量变得非常接近时（即所谓的“避免交叉”区域）。这个练习将引导您推导一个描述此类情况的典型双态模型中的非绝热耦合项 。理解并计算这个耦合项是超越波恩-奥本海默近似、研究光化学、电荷转移等非绝热过程的第一步。",
            "id": "3844478",
            "problem": "在多尺度材料模拟中，玻恩-奥本海默（BO）近似通过在固定的原子核坐标下求解电子本征问题，将快速的电子运动与缓慢的原子核运动分离开来。考虑一个双态避开交叉，它在一个与标量原子核坐标$R$无关的透热基$\\{|\\chi_{1}\\rangle,|\\chi_{2}\\rangle\\}$中进行描述。在该透热基中，电子哈密顿量为\n$$\nH_{d}(R)=\\begin{pmatrix} a R  \\Delta \\\\ \\Delta  -a R \\end{pmatrix},\n$$\n其中$a$和$\\Delta$是与$R$无关的实参数，$R$是一个实原子核坐标。绝热电子态$\\{|\\phi_{1}(R)\\rangle,|\\phi_{2}(R)\\rangle\\}$被定义为$H_{d}(R)$在固定$R$下的标准正交本征矢量，并选择为关于$R$的实数且连续的函数。非绝热导数耦合定义为\n$$\nd_{12}(R)=\\langle \\phi_{1}(R)|\\partial_{R}\\phi_{2}(R)\\rangle.\n$$\n仅从绝热态作为$H_{d}(R)$本征矢量的定义以及上述导数耦合的定义出发，推导耦合强度$|d_{12}(R)|$作为$R$，$a$和$\\Delta$的函数的闭式表达式，除了线性代数和微分之外，不引用任何特殊情况的公式。请用一个关于$R$，$a$和$\\Delta$的解析表达式表示你的最终答案。不需要进行数值计算，也不需要四舍五入。",
            "solution": "绝热态$|\\phi_k(R)\\rangle$及其对应的能量$E_k(R)$由固定原子核坐标$R$下的不含时电子薛定谔方程定义：\n$$H_{d}(R) |\\phi_k(R)\\rangle = E_k(R) |\\phi_k(R)\\rangle$$\n其中$k \\in \\{1, 2\\}$。这些态是标准正交的，即$\\langle\\phi_j(R)|\\phi_k(R)\\rangle = \\delta_{jk}$。\n\n为了找到非绝热导数耦合$d_{12}(R) = \\langle \\phi_1(R)|\\partial_R\\phi_2(R)\\rangle$的表达式，我们首先对$|\\phi_2(R)\\rangle$的本征值方程关于$R$求导：\n$$\\frac{\\partial}{\\partial R} \\left( H_d(R) |\\phi_2(R)\\rangle \\right) = \\frac{\\partial}{\\partial R} \\left( E_2(R) |\\phi_2(R)\\rangle \\right)$$\n应用微分的乘积法则可得：\n$$\\left(\\partial_R H_d(R)\\right) |\\phi_2(R)\\rangle + H_d(R) \\left(\\partial_R |\\phi_2(R)\\rangle\\right) = \\left(\\partial_R E_2(R)\\right) |\\phi_2(R)\\rangle + E_2(R) \\left(\\partial_R |\\phi_2(R)\\rangle\\right)$$\n为了分离出包含$\\partial_R |\\phi_2(R)\\rangle$的项，我们将整个方程投影到态$\\langle \\phi_1(R)|$上：\n$$\\langle \\phi_1(R)| \\left(\\partial_R H_d(R)\\right) |\\phi_2(R)\\rangle + \\langle \\phi_1(R)| H_d(R) |\\partial_R \\phi_2(R)\\rangle = (\\partial_R E_2(R)) \\langle \\phi_1(R)|\\phi_2(R)\\rangle + E_2(R) \\langle \\phi_1(R)|\\partial_R \\phi_2(R)\\rangle$$\n我们可以利用绝热态的性质来简化这个表达式。首先，由于标准正交性，$\\langle \\phi_1(R)|\\phi_2(R)\\rangle = 0$。其次，由于$H_d(R)$是一个实对称（因此也是厄米）矩阵，它从左侧作用于其自身的左矢本征矢量，即$\\langle \\phi_1(R)| H_d(R) = E_1(R) \\langle \\phi_1(R)|$。应用这两个性质，方程变为：\n$$\\langle \\phi_1(R)| \\partial_R H_d(R) |\\phi_2(R)\\rangle + E_1(R) \\langle \\phi_1(R)|\\partial_R \\phi_2(R)\\rangle = E_2(R) \\langle \\phi_1(R)|\\partial_R \\phi_2(R)\\rangle$$\n根据定义，$d_{12}(R) = \\langle \\phi_1(R)|\\partial_R\\phi_2(R)\\rangle$。将此代入方程，我们得到：\n$$\\langle \\phi_1(R)| \\partial_R H_d(R) |\\phi_2(R)\\rangle + E_1(R) d_{12}(R) = E_2(R) d_{12}(R)$$\n对于$E_1(R) \\neq E_2(R)$的非简并情况，我们可以重新整理以解出$d_{12}(R)$：\n$$d_{12}(R) = \\frac{\\langle \\phi_1(R)| \\partial_R H_d(R) |\\phi_2(R)\\rangle}{E_2(R) - E_1(R)}$$\n1.  **本征值之差：** 本征值$E(R)$是特征方程$\\det(H_d(R) - E I) = 0$的根：\n    $$\n    \\det \\begin{pmatrix} a R - E  \\Delta \\\\ \\Delta  -a R - E \\end{pmatrix} = (aR - E)(-aR - E) - \\Delta^2 = 0\n    $$\n    $$E^2 - (aR)^2 - \\Delta^2 = 0 \\implies E^2 = a^2R^2 + \\Delta^2$$\n    两个本征值为$E(R) = \\pm \\sqrt{a^2R^2 + \\Delta^2}$。我们定义$E_2(R)$为高能态，$E_1(R)$为低能态：\n    $$E_1(R) = -\\sqrt{a^2R^2 + \\Delta^2} \\quad \\text{和} \\quad E_2(R) = \\sqrt{a^2R^2 + \\Delta^2}$$\n    因此，能量差为：\n    $$E_2(R) - E_1(R) = 2\\sqrt{a^2R^2 + \\Delta^2}$$\n\n2.  **哈密顿量的导数：** 哈密顿量为$H_{d}(R)=\\begin{pmatrix} a R  \\Delta \\\\ \\Delta  -a R \\end{pmatrix}$。其关于$R$的导数为：\n    $$\\partial_R H_d(R) = \\frac{d}{dR} \\begin{pmatrix} a R  \\Delta \\\\ \\Delta  -a R \\end{pmatrix} = \\begin{pmatrix} a  0 \\\\ 0  -a \\end{pmatrix}$$\n\n3.  **矩阵元：** 为了计算$\\langle \\phi_1(R)| \\partial_R H_d(R) |\\phi_2(R)\\rangle$，我们必须首先找到本征矢量$|\\phi_1(R)\\rangle$和$|\\phi_2(R)\\rangle$的表达式。一个$2 \\times 2$实对称矩阵的一组通用实数、标准正交的本征矢量可以用混合角$\\theta(R)$来表示：\n    $$|\\phi_1(R)\\rangle = \\begin{pmatrix} -\\sin\\theta(R) \\\\ \\cos\\theta(R) \\end{pmatrix}, \\quad |\\phi_2(R)\\rangle = \\begin{pmatrix} \\cos\\theta(R) \\\\ \\sin\\theta(R) \\end{pmatrix}$$\n    于是矩阵元为：\n    $$\\langle \\phi_1(R)| \\partial_R H_d(R) |\\phi_2(R)\\rangle = \\begin{pmatrix} -\\sin\\theta(R)  \\cos\\theta(R) \\end{pmatrix} \\begin{pmatrix} a  0 \\\\ 0  -a \\end{pmatrix} \\begin{pmatrix} \\cos\\theta(R) \\\\ \\sin\\theta(R) \\end{pmatrix}$$\n    $$= \\begin{pmatrix} -\\sin\\theta(R)  \\cos\\theta(R) \\end{pmatrix} \\begin{pmatrix} a\\cos\\theta(R) \\\\ -a\\sin\\theta(R) \\end{pmatrix} = -a\\sin\\theta(R)\\cos\\theta(R) - a\\cos\\theta(R)\\sin\\theta(R)$$\n    $$= -2a\\sin\\theta(R)\\cos\\theta(R) = -a\\sin(2\\theta(R))$$\n    为了求出$\\sin(2\\theta(R))$，我们可以将$\\theta(R)$与$H_d(R)$的分量联系起来。$|\\phi_2(R)\\rangle$的本征矢量方程给出：\n    $$\\begin{pmatrix} aR  \\Delta \\\\ \\Delta  -aR \\end{pmatrix} \\begin{pmatrix} \\cos\\theta \\\\ \\sin\\theta \\end{pmatrix} = E_2 \\begin{pmatrix} \\cos\\theta \\\\ \\sin\\theta \\end{pmatrix}$$\n    根据第一行：$aR\\cos\\theta + \\Delta\\sin\\theta = E_2\\cos\\theta \\implies \\Delta\\sin\\theta = (E_2 - aR)\\cos\\theta$。\n    根据第二行：$\\Delta\\cos\\theta - aR\\sin\\theta = E_2\\sin\\theta \\implies \\Delta\\cos\\theta = (E_2 + aR)\\sin\\theta$。\n    将这两个方程相除可得：$\\frac{\\Delta\\sin\\theta}{\\Delta\\cos\\theta} = \\frac{(E_2 - aR)\\cos\\theta}{(E_2 + aR)\\sin\\theta} \\implies \\tan^2\\theta = \\frac{E_2 - aR}{E_2 + aR}$。\n    另一种方法是考虑$H_d(R) = aR\\sigma_z + \\Delta\\sigma_x$，其中$\\sigma_z, \\sigma_x$是泡利矩阵。使该哈密顿量对角化的旋转由x-z平面内的一个轴定义。角度$2\\theta$对应于矢量$( \\Delta, aR)$的极角。因此，我们有$\\tan(2\\theta(R)) = \\frac{\\Delta}{aR}$。\n    根据这个关系，我们可以通过考虑一个对边为$\\Delta$、邻边为$aR$的直角三角形来确定$\\sin(2\\theta(R))$。斜边是$\\sqrt{(aR)^2 + \\Delta^2} = \\sqrt{a^2R^2 + \\Delta^2}$。\n    $$\\sin(2\\theta(R)) = \\frac{\\text{对边}}{\\text{斜边}} = \\frac{\\Delta}{\\sqrt{a^2R^2 + \\Delta^2}}$$\n    将此代入矩阵元的表达式中：\n    $$\\langle \\phi_1(R)| \\partial_R H_d(R) |\\phi_2(R)\\rangle = -a \\left( \\frac{\\Delta}{\\sqrt{a^2R^2 + \\Delta^2}} \\right)$$\n\n最后，我们将各部分组合成$d_{12}(R)$的表达式：\n$$d_{12}(R) = \\frac{\\langle \\phi_1| \\partial_R H_d |\\phi_2\\rangle}{E_2 - E_1} = \\frac{-a \\frac{\\Delta}{\\sqrt{a^2R^2 + \\Delta^2}}}{2\\sqrt{a^2R^2 + \\Delta^2}} = \\frac{-a\\Delta}{2(a^2R^2 + \\Delta^2)}$$\n问题要求的是这个耦合的大小（模）：\n$$|d_{12}(R)| = \\left| \\frac{-a\\Delta}{2(a^2R^2 + \\Delta^2)} \\right|$$\n由于$a$和$\\Delta$是实参数且$R$是实坐标，$a^2R^2 + \\Delta^2 \\ge 0$。等号仅在$a=0$或$R=0$且$\\Delta=0$时成立，这是一个平凡情况。因此，分母为正。\n$$|d_{12}(R)| = \\frac{|a\\Delta|}{2(a^2R^2 + \\Delta^2)}$$",
            "answer": "$$\n\\boxed{\\frac{|a\\Delta|}{2(a^2R^2 + \\Delta^2)}}\n$$"
        },
        {
            "introduction": "即使在远离避免交叉的情况下，波恩-奥本海默近似仍然是一个近似。对角波恩-奥本海默修正（DBOC）是对其最重要的一阶修正，它为原子核的有效势能添加了一个微小的、与质量相关的能量项 。本练习将指导您从第一性原理出发，推导并计算一个包含轻元素的高熵合金模型中的DBOC，从而让您对何时需要考虑此类修正及其对材料振动性质的潜在影响有一个定量的认识。",
            "id": "3760537",
            "problem": "考虑一个含有轻元素的高熵合金（HEA）的简化原子模型，用于评估因玻恩-奥本海默（BO）分离在核运动中失效而产生的对角玻恩-奥本海默修正（DBOC）的大小。该高熵合金包含五种原子：铝（Al）、铬（Cr）、铁（Fe）、镍（Ni）和硼（B）。目标是计算特定振动简正模的DBOC能量贡献，并评估其相对于谐振声子能量子的大小。计算必须从第一性原理出发，始于电子和核自由度的量子力学分离以及核动能算符，而不依赖任何预先给定的简化表达式。其基本依据是：总分子哈密顿量是核动能与电子哈密顿量之和，BO分离假设存在一个由核坐标参数化的电子基态，并且核动能算符作用于核坐标，并在电子态参数化地依赖于核位置时引入修正。\n\n您需要一致地使用以下给定的物理常数和单位换算：\n- 约化普朗克常数：$\\hbar$。\n- 电子伏特到焦耳：$1\\ \\text{eV} = 1.602176634 \\times 10^{-19}\\ \\text{J}$。\n- 埃到米：$1\\ \\text{\\AA} = 1.0 \\times 10^{-10}\\ \\text{m}$。\n- 原子质量单位到千克：$1\\ \\text{amu} = 1.66053906660 \\times 10^{-27}\\ \\text{kg}$。\n- 频率（太赫兹）到角频率：$\\omega = 2\\pi f$，其中 $f$ 的单位为 $\\text{THz}$，$\\omega$ 的单位为 $\\text{rad/s}$。\n\nHEA各组分的原子质量（视为精确输入）：\n- Al: $26.9815\\ \\text{amu}$，\n- Cr: $51.9961\\ \\text{amu}$，\n- Fe: $55.845\\ \\text{amu}$，\n- Ni: $58.6934\\ \\text{amu}$，\n- B: $10.81\\ \\text{amu}$。\n\n对于每个振动模式，您会得到：\n- 相对于基态的电子激发能隙列表 $\\Delta E_n$（单位为 $\\text{eV}$）。\n- 一组对于每个原子和每个激发态，沿简正模方向投影的电子结构耦合强度，记作 $c_{A,n}$（单位为 $\\text{eV}/\\text{\\AA}$）。它表示电子哈密顿量相对于原子 $A$ 的核坐标的梯度，在基态和第 $n$ 个激发态之间求值，并投影到所选简正模方向上的标量值。\n- 振动频率 $f$（单位为 $\\text{THz}$）。\n\n您的任务是：\n1. 从BO分离和核动能算符出发，使用给定的 $c_{A,n}$ 和 $\\Delta E_n$ 推导单个简正模的有效势能面中DBOC贡献的表达式。您的推导必须严格从基本的哈密顿量结构和核动能算符对参数化电子基态的作用开始，并通过电子激发态的完备性关系和适当的微扰推理，来表示电子基态相对于核坐标的导数。\n2. 实现该推导出的表达式，以计算每个模式的DBOC能量，确保所有量在内部都转换为一致的国际单位制（SI）单位，并且最终的DBOC能量以 $\\text{eV}$ 为单位报告。\n3. 计算每个模式的谐振声子能量子 $\\hbar \\omega$（单位为 $\\text{eV}$）。\n4. 对每个模式，计算无量纲比值 $r = E_{\\text{DBOC}} / (\\hbar \\omega)$，并将其作为最终的数值结果报告。\n\n将每个测试用例的所有最终数值结果表示为四舍五入到六位小数的浮点数。角度不出现；不需要角度单位。能量必须以 $\\text{eV}$ 表示。最终程序的输出必须是单行，包含一个用方括号括起来的逗号分隔列表，例如 $[r_1,r_2,r_3]$。\n\n测试套件：\n使用以下模式和参数集。每个模式都使用铝、铬、铁、镍和硼这五种原子。所有 $c_{A,n}$ 值的单位为 $\\text{eV}/\\text{\\AA}$；所有 $\\Delta E_n$ 的单位为 $\\text{eV}$；所有 $f$ 的单位为 $\\text{THz}$。\n\n- 模式 $1$ (B局域化高频模式):\n    - $\\Delta E_n = [2.0, 3.5, 4.8]$。\n    - $f = 18.0$。\n    - $c_{\\text{Al},n} = [0.20, 0.10, 0.05]$,\n      $c_{\\text{Cr},n} = [0.18, 0.09, 0.04]$,\n      $c_{\\text{Fe},n} = [0.15, 0.08, 0.04]$,\n      $c_{\\text{Ni},n} = [0.15, 0.07, 0.03]$,\n      $c_{\\text{B},n} = [0.90, 0.60, 0.30]$。\n- 模式 $2$ (类声学重原子模式):\n    - $\\Delta E_n = [2.5, 3.0, 3.5]$。\n    - $f = 3.0$。\n    - $c_{\\text{Al},n} = [0.30, 0.20, 0.10]$,\n      $c_{\\text{Cr},n} = [0.28, 0.18, 0.09]$,\n      $c_{\\text{Fe},n} = [0.25, 0.16, 0.08]$,\n      $c_{\\text{Ni},n} = [0.24, 0.15, 0.08]$,\n      $c_{\\text{B},n} = [0.05, 0.02, 0.01]$。\n- 模式 $3$ (边界情况：近零耦合):\n    - $\\Delta E_n = [2.0, 3.0]$。\n    - $f = 5.0$。\n    - $c_{\\text{Al},n} = [0.0, 0.0]$,\n      $c_{\\text{Cr},n} = [0.0, 0.0]$,\n      $c_{\\text{Fe},n} = [0.0, 0.0]$,\n      $c_{\\text{Ni},n} = [0.0, 0.0]$,\n      $c_{\\text{B},n} = [0.0, 0.0]$。\n- 模式 $4$ (有轻元素参与的小带隙模式):\n    - $\\Delta E_n = [0.5, 2.0, 2.5]$。\n    - $f = 10.0$。\n    - $c_{\\text{Al},n} = [0.25, 0.15, 0.10]$,\n      $c_{\\text{Cr},n} = [0.22, 0.14, 0.09]$,\n      $c_{\\text{Fe},n} = [0.20, 0.13, 0.08]$,\n      $c_{\\text{Ni},n} = [0.19, 0.12, 0.07]$,\n      $c_{\\text{B},n} = [0.80, 0.30, 0.20]$。\n\n您的程序应生成单行输出，其中包含四个模式的比率，以逗号分隔列表的形式用方括号括起来，每个比率四舍五入到六位小数，例如：$[r_1,r_2,r_3,r_4]$。",
            "solution": "根据问题要求，我们首先从第一性原理推导对角玻恩-奥本海默修正（DBOC）的表达式。总哈密顿量为 $H = T_N + H_e(\\mathbf{r}; \\mathbf{R})$，其中核动能算符为 $T_N = \\sum_A -\\frac{\\hbar^2}{2 M_A} \\nabla_A^2$。在玻恩-奥本海默框架下，总波函数近似为 $\\Psi(\\mathbf{r}, \\mathbf{R}) \\approx \\chi(\\mathbf{R}) \\phi_0(\\mathbf{r}; \\mathbf{R})$，其中 $\\phi_0$ 是电子基态。\n\n将核动能算符 $T_N$ 作用于波函数乘积，我们会得到一个修正项，即对角玻恩-奥本海默修正，它表现为对原子核有效势能的附加项：\n$$ E_{\\text{DBOC}}(\\mathbf{R}) = \\sum_A -\\frac{\\hbar^2}{2 M_A} \\langle \\phi_0 | \\nabla_A^2 \\phi_0 \\rangle_{\\mathbf{r}} $$\n对于实数波函数，此表达式可以重写为：\n$$ E_{\\text{DBOC}}(\\mathbf{R}) = \\sum_A \\frac{\\hbar^2}{2 M_A} \\langle \\nabla_A \\phi_0 | \\nabla_A \\phi_0 \\rangle_{\\mathbf{r}} $$\n使用微扰理论，电子基态对核坐标的导数可以根据激发态 $\\phi_n$ 展开：\n$$ \\nabla_A \\phi_0 = \\sum_{n \\neq 0} \\phi_n \\frac{\\langle \\phi_n | \\nabla_A H_e | \\phi_0 \\rangle}{E_0 - E_n} $$\n代入上式，并利用电子本征态的正交归一性，我们得到DBOC的最终计算表达式：\n$$ E_{\\text{DBOC}} = \\sum_A \\frac{\\hbar^2}{2 M_A} \\sum_{n \\neq 0} \\frac{|\\langle \\phi_n | \\nabla_A H_e | \\phi_0 \\rangle|^2}{(E_n - E_0)^2} $$\n根据问题定义，我们使用给定的参数：激发能隙 $\\Delta E_n = E_n - E_0$ 和耦合强度 $c_{A,n} = |\\langle \\phi_n | \\nabla_A H_e | \\phi_0 \\rangle|$。因此，\n$$ E_{\\text{DBOC}} = \\sum_{A} \\sum_{n} \\frac{\\hbar^2}{2 M_A} \\frac{c_{A,n}^2}{(\\Delta E_n)^2} $$\n其中对 $A$ 的求和包括Al、Cr、Fe、Ni和B，对 $n$ 的求和是针对每种模式指定的激发态。\n\n接下来，计算谐振声子能量子：\n$$ E_{\\text{phonon}} = \\hbar \\omega = \\hbar (2\\pi f) $$\n最后，计算无量纲比值 $r$：\n$$ r = \\frac{E_{\\text{DBOC}}}{E_{\\text{phonon}}} $$\n这些公式将用于对每个测试用例进行数值计算，所有单位都将转换为国际单位制（SI）以确保一致性。",
            "answer": "```python\nimport numpy as np\nimport scipy.constants\n\ndef solve():\n    \"\"\"\n    Calculates the ratio of the Diagonal Born-Oppenheimer Correction (DBOC) energy\n    to the harmonic phonon energy for several vibrational modes in a model HEA.\n    \"\"\"\n    # Physical constants\n    HBAR = scipy.constants.hbar  # J s\n    EV_TO_J = 1.602176634e-19\n    A_TO_M = 1.0e-10\n    AMU_TO_KG = 1.66053906660e-27\n\n    # Atomic masses in amu\n    atomic_masses_amu = {\n        'Al': 26.9815,\n        'Cr': 51.9961,\n        'Fe': 55.845,\n        'Ni': 58.6934,\n        'B': 10.81,\n    }\n\n    # Convert masses to SI units (kg)\n    atomic_masses_kg = {\n        atom: mass * AMU_TO_KG for atom, mass in atomic_masses_amu.items()\n    }\n\n    # Test suite data\n    test_cases = [\n        {\n            \"mode_name\": \"Mode 1 (B-localized high-frequency mode)\",\n            \"delta_E_n_ev\": [2.0, 3.5, 4.8],\n            \"f_thz\": 18.0,\n            \"c_An_ev_per_a\": {\n                'Al': [0.20, 0.10, 0.05],\n                'Cr': [0.18, 0.09, 0.04],\n                'Fe': [0.15, 0.08, 0.04],\n                'Ni': [0.15, 0.07, 0.03],\n                'B': [0.90, 0.60, 0.30],\n            },\n        },\n        {\n            \"mode_name\": \"Mode 2 (acoustic-like heavy-atom mode)\",\n            \"delta_E_n_ev\": [2.5, 3.0, 3.5],\n            \"f_thz\": 3.0,\n            \"c_An_ev_per_a\": {\n                'Al': [0.30, 0.20, 0.10],\n                'Cr': [0.28, 0.18, 0.09],\n                'Fe': [0.25, 0.16, 0.08],\n                'Ni': [0.24, 0.15, 0.08],\n                'B': [0.05, 0.02, 0.01],\n            },\n        },\n        {\n            \"mode_name\": \"Mode 3 (edge case: near-zero coupling)\",\n            \"delta_E_n_ev\": [2.0, 3.0],\n            \"f_thz\": 5.0,\n            \"c_An_ev_per_a\": {\n                'Al': [0.0, 0.0],\n                'Cr': [0.0, 0.0],\n                'Fe': [0.0, 0.0],\n                'Ni': [0.0, 0.0],\n                'B': [0.0, 0.0],\n            },\n        },\n        {\n            \"mode_name\": \"Mode 4 (small-gap mode with light-element participation)\",\n            \"delta_E_n_ev\": [0.5, 2.0, 2.5],\n            \"f_thz\": 10.0,\n            \"c_An_ev_per_a\": {\n                'Al': [0.25, 0.15, 0.10],\n                'Cr': [0.22, 0.14, 0.09],\n                'Fe': [0.20, 0.13, 0.08],\n                'Ni': [0.19, 0.12, 0.07],\n                'B': [0.80, 0.30, 0.20],\n            },\n        },\n    ]\n\n    results = []\n\n    for case in test_cases:\n        delta_E_n_J = np.array(case[\"delta_E_n_ev\"]) * EV_TO_J\n        c_An = case[\"c_An_ev_per_a\"]\n        f_hz = case[\"f_thz\"] * 1e12\n\n        # 1. Calculate DBOC energy in Joules\n        e_dboc_J = 0.0\n        for atom, mass_kg in atomic_masses_kg.items():\n            if atom in c_An:\n                c_An_atom_SI = np.array(c_An[atom]) * EV_TO_J / A_TO_M\n                \n                # Sum over excited states n for the current atom A\n                # Formula: sum_n (c_An^2 / (Delta E_n)^2)\n                term_for_atom = np.sum(c_An_atom_SI**2 / delta_E_n_J**2)\n                \n                # Add atom's contribution to total DBOC energy\n                e_dboc_J += (HBAR**2 / (2 * mass_kg)) * term_for_atom\n\n        # 2. Calculate phonon energy in Joules\n        omega = 2 * np.pi * f_hz\n        e_phonon_J = HBAR * omega\n\n        # 3. Calculate the dimensionless ratio r\n        # If phonon energy is zero (for a non-vibrating mode), the ratio is undefined.\n        # But for the given test cases, f > 0, so e_phonon_J > 0.\n        # If DBOC is 0 (as in Mode 3), the ratio is 0.\n        if e_phonon_J == 0:\n            if e_dboc_J == 0:\n                ratio = 0.0\n            else:\n                ratio = np.inf # Or handle as an error\n        else:\n            ratio = e_dboc_J / e_phonon_J\n        \n        results.append(f\"{ratio:.6f}\")\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}