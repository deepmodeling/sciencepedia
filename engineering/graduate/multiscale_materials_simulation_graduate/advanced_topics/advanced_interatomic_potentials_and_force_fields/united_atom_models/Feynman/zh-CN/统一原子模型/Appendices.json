{
    "hands_on_practices": [
        {
            "introduction": "在构建联合原子（UA）模型时，首要步骤是精确定义粗粒化珠子的物理属性。本练习  演示了如何将一个原子团（如甲基 $\\mathrm{CH}_3$）视为一个刚体，并计算其总质量和惯性张量，从而保留其平动和转动特性。这个过程是确保粗粒化模型在动力学模拟中能够正确响应外力和力矩的基础。",
            "id": "3857545",
            "problem": "联合原子 (UA) 模型将一组原子粗粒化为一个单一的相互作用位点，以减少自由度，同时保留其基本的质量和转动特性。考虑一个在刚性基团假设下代表甲基 $\\mathrm{CH}_3$ 的UA位点。碳原子位于原点，三个氢原子以平衡碳-氢键长 $r = 1.090$ $\\mathrm{\\AA}$ 成键，并围绕 $z$ 轴（与碳-取代基键轴重合）呈三重旋转对称排列。其几何构型为四面体：每个碳-氢键与 $z$ 轴形成相同的极角 $\\theta$，其中 $\\cos \\theta = -\\frac{1}{3}$，并且三个氢原子的方位角为 $\\phi_k \\in \\{0, \\frac{2\\pi}{3}, \\frac{4\\pi}{3}\\}$。原子质量分别为 $m_{\\mathrm{C}} = 12.011$ 原子质量单位和 $m_{\\mathrm{H}} = 1.00784$ 原子质量单位。\n\n使用刚体力学的第一性原理，计算：\n1. 通过聚集组分原子得到的UA位点的总质量 $M$。\n2. 刚性 $\\mathrm{CH}_3$ 基团关于其质心的转动惯量张量 $\\mathbf{I}$，在与所述对称性对齐的主轴坐标系中表示（因此 $\\mathbf{I}$ 是对角的，且 $I_{xx} = I_{yy} \\neq I_{zz}$）。\n\n将最终结果表示为行矩阵 $\\begin{pmatrix} M  I_{xx}  I_{yy}  I_{zz} \\end{pmatrix}$。将您的答案四舍五入到四位有效数字。质量以原子质量单位 (amu) 表示，每个转动惯量分量以 $\\mathrm{amu} \\cdot \\mathrm{\\AA}^{2}$ 表示。",
            "solution": "问题陈述已经过验证，被认为是有效的。它具有科学依据、良定、客观，并包含计算唯一解所需的所有必要信息。我们应用刚体力学的原理来求解。\n\n该问题要求计算甲基 $\\mathrm{CH}_3$ 的联合原子 (UA) 模型的两个量：总质量 $M$ 和关于质心的转动惯量张量 $\\mathbf{I}$。\n\n首先，我们定义组分原子的坐标和质量。碳原子位于原点，$\\mathbf{r}_{\\mathrm{C}} = (0, 0, 0)$，质量为 $m_{\\mathrm{C}} = 12.011$ amu。三个氢原子，对于 $k \\in \\{1, 2, 3\\}$ 记为 $\\mathrm{H}_k$，每个氢原子的质量为 $m_{\\mathrm{H}} = 1.00784$ amu。它们的位置在以碳原子为中心的球坐标系中给出，径向距离为 $r = 1.090$ $\\mathrm{\\AA}$，公共极角 $\\theta$ 满足 $\\cos \\theta = -1/3$，方位角分别为 $\\phi_1 = 0$, $\\phi_2 = 2\\pi/3$ 和 $\\phi_3 = 4\\pi/3$。\n\n为了处理这些位置，我们将其转换为笛卡尔坐标 $(x_k, y_k, z_k)$。所有氢原子的极角 $\\theta$ 是恒定的。我们从 $\\cos \\theta$ 求出 $\\sin \\theta$：\n$$ \\sin \\theta = \\sqrt{1 - \\cos^2 \\theta} = \\sqrt{1 - \\left(-\\frac{1}{3}\\right)^2} = \\sqrt{1 - \\frac{1}{9}} = \\sqrt{\\frac{8}{9}} = \\frac{2\\sqrt{2}}{3} $$\n所有三个氢原子的 $z$ 坐标是相同的：\n$$ z_{\\mathrm{H}} = r \\cos \\theta = -\\frac{1}{3} r $$\n每个氢原子 $\\mathrm{H}_k$ 的 $x$ 和 $y$ 坐标为：\n$$ x_k = r \\sin \\theta \\cos \\phi_k $$\n$$ y_k = r \\sin \\theta \\sin \\phi_k $$\n具体来说，坐标是：\n对于 $\\mathrm{H}_1$ ($\\phi_1=0$)：$\\mathbf{r}_{\\mathrm{H}_1} = (r \\sin \\theta, 0, r \\cos \\theta)$\n对于 $\\mathrm{H}_2$ ($\\phi_2=2\\pi/3$)：$\\mathbf{r}_{\\mathrm{H}_2} = (r \\sin \\theta \\cos(2\\pi/3), r \\sin \\theta \\sin(2\\pi/3), r \\cos \\theta) = (r \\sin \\theta (-\\frac{1}{2}), r \\sin \\theta (\\frac{\\sqrt{3}}{2}), r \\cos \\theta)$\n对于 $\\mathrm{H}_3$ ($\\phi_3=4\\pi/3$)：$\\mathbf{r}_{\\mathrm{H}_3} = (r \\sin \\theta \\cos(4\\pi/3), r \\sin \\theta \\sin(4\\pi/3), r \\cos \\theta) = (r \\sin \\theta (-\\frac{1}{2}), r \\sin \\theta (-\\frac{\\sqrt{3}}{2}), r \\cos \\theta)$\n\n**1. 总质量 $M$**\n\nUA位点的总质量 $M$ 是组分原子质量的总和：\n$$ M = m_{\\mathrm{C}} + 3 m_{\\mathrm{H}} $$\n代入给定值：\n$$ M = 12.011 \\text{ amu} + 3 \\times 1.00784 \\text{ amu} = 12.011 + 3.02352 = 15.03452 \\text{ amu} $$\n\n**2. 转动惯量张量 $\\mathbf{I}$**\n\n为了求出关于质心 (CM) 的转动惯量张量，我们首先定位质心，然后计算关于一个方便的原点（碳原子）的转动惯量张量，最后使用平行轴定理将其平移到质心。\n\n**A. 质心 $\\mathbf{R}_{\\mathrm{CM}}$**\n质心的位置由下式给出：\n$$ \\mathbf{R}_{\\mathrm{CM}} = \\frac{1}{M} \\sum_i m_i \\mathbf{r}_i = \\frac{1}{M} (m_{\\mathrm{C}}\\mathbf{r}_{\\mathrm{C}} + m_{\\mathrm{H}}\\mathbf{r}_{\\mathrm{H}_1} + m_{\\mathrm{H}}\\mathbf{r}_{\\mathrm{H}_2} + m_{\\mathrm{H}}\\mathbf{r}_{\\mathrm{H}_3}) $$\n由于 $\\mathbf{r}_{\\mathrm{C}} = (0,0,0)$，这可以简化为：\n$$ \\mathbf{R}_{\\mathrm{CM}} = \\frac{m_{\\mathrm{H}}}{M} (\\mathbf{r}_{\\mathrm{H}_1} + \\mathbf{r}_{\\mathrm{H}_2} + \\mathbf{r}_{\\mathrm{H}_3}) $$\n氢原子位置之和的分量为：\n$$ \\sum_{k=1}^3 x_k = r \\sin \\theta (\\cos(0) + \\cos(2\\pi/3) + \\cos(4\\pi/3)) = r \\sin \\theta (1 - \\frac{1}{2} - \\frac{1}{2}) = 0 $$\n$$ \\sum_{k=1}^3 y_k = r \\sin \\theta (\\sin(0) + \\sin(2\\pi/3) + \\sin(4\\pi/3)) = r \\sin \\theta (0 + \\frac{\\sqrt{3}}{2} - \\frac{\\sqrt{3}}{2}) = 0 $$\n$$ \\sum_{k=1}^3 z_k = 3 z_{\\mathrm{H}} = 3 r \\cos \\theta $$\n因此，质心位于 $z$ 轴上：$\\mathbf{R}_{\\mathrm{CM}} = (0, 0, Z_{\\mathrm{CM}})$，其中\n$$ Z_{\\mathrm{CM}} = \\frac{m_{\\mathrm{H}}}{M} (3 r \\cos \\theta) = \\frac{3 m_{\\mathrm{H}}}{M} r \\cos \\theta $$\n数值上：\n$$ Z_{\\mathrm{CM}} = \\frac{3 \\times 1.00784}{15.03452} \\times 1.090 \\times \\left(-\\frac{1}{3}\\right) = -\\frac{1.00784 \\times 1.090}{15.03452} \\approx -0.073070 \\text{ } \\mathrm{\\AA} $$\n\n**B. 关于原点的转动惯量张量 $\\mathbf{I}_{\\mathrm{O}}$**\n对于一个质点系，其关于原点的转动惯量张量的分量由 $I_{ij} = \\sum_k m_k (\\delta_{ij} |\\mathbf{r}_k|^2 - x_{k,i} x_{k,j})$ 给出。位于原点的碳原子没有贡献。求和遍及三个氢原子。\n由于三重对称性，非对角惯性积为零：$I_{\\mathrm{O},xy} = I_{\\mathrm{O},xz} = I_{\\mathrm{O},yz} = 0$。\n对角分量为：\n$$ I_{\\mathrm{O},xx} = \\sum_{k=1}^3 m_{\\mathrm{H}} (y_k^2 + z_k^2) = m_{\\mathrm{H}} \\left( \\sum y_k^2 + \\sum z_k^2 \\right) $$\n$$ I_{\\mathrm{O},yy} = \\sum_{k=1}^3 m_{\\mathrm{H}} (x_k^2 + z_k^2) = m_{\\mathrm{H}} \\left( \\sum x_k^2 + \\sum z_k^2 \\right) $$\n$$ I_{\\mathrm{O},zz} = \\sum_{k=1}^3 m_{\\mathrm{H}} (x_k^2 + y_k^2) = m_{\\mathrm{H}} \\sum (r \\sin \\theta)^2 = 3 m_{\\mathrm{H}} r^2 \\sin^2 \\theta $$\n我们需要坐标的平方和：\n$$ \\sum x_k^2 = (r \\sin \\theta)^2 \\sum \\cos^2 \\phi_k = (r \\sin \\theta)^2 (1^2 + (-\\frac{1}{2})^2 + (-\\frac{1}{2})^2) = \\frac{3}{2} (r \\sin \\theta)^2 $$\n$$ \\sum y_k^2 = (r \\sin \\theta)^2 \\sum \\sin^2 \\phi_k = (r \\sin \\theta)^2 (0^2 + (\\frac{\\sqrt{3}}{2})^2 + (-\\frac{\\sqrt{3}}{2})^2) = \\frac{3}{2} (r \\sin \\theta)^2 $$\n$$ \\sum z_k^2 = 3 z_{\\mathrm{H}}^2 = 3 (r \\cos \\theta)^2 $$\n将这些代入转动惯量张量的分量中：\n$$ I_{\\mathrm{O},zz} = 3 m_{\\mathrm{H}} r^2 \\sin^2\\theta = 3 m_{\\mathrm{H}} r^2 \\left(\\frac{8}{9}\\right) = \\frac{8}{3} m_{\\mathrm{H}} r^2 $$\n$$ I_{\\mathrm{O},xx} = m_{\\mathrm{H}} \\left( \\frac{3}{2} (r \\sin \\theta)^2 + 3 (r \\cos \\theta)^2 \\right) = m_{\\mathrm{H}} r^2 \\left( \\frac{3}{2} \\sin^2\\theta + 3 \\cos^2\\theta \\right) $$\n$$ I_{\\mathrm{O},xx} = m_{\\mathrm{H}} r^2 \\left( \\frac{3}{2} \\frac{8}{9} + 3 \\frac{1}{9} \\right) = m_{\\mathrm{H}} r^2 \\left( \\frac{4}{3} + \\frac{1}{3} \\right) = \\frac{5}{3} m_{\\mathrm{H}} r^2 $$\n根据对称性，$I_{\\mathrm{O},yy} = I_{\\mathrm{O},xx}$。\n\n**C. 关于质心的转动惯量张量 $\\mathbf{I}$**\n我们使用平行轴定理：$I_{\\mathrm{O},ij} = I_{ij} + M(\\delta_{ij}|\\mathbf{R}_{\\mathrm{CM}}|^2 - R_{\\mathrm{CM},i}R_{\\mathrm{CM},j})$，其中 $\\mathbf{I}$ 是关于质心的转动惯量张量。\n给定 $\\mathbf{R}_{\\mathrm{CM}} = (0, 0, Z_{\\mathrm{CM}})$：\n$$ I_{xx} = I_{\\mathrm{O},xx} - M(Z_{\\mathrm{CM}}^2 - 0) = I_{\\mathrm{O},xx} - M Z_{\\mathrm{CM}}^2 $$\n$$ I_{yy} = I_{\\mathrm{O},yy} - M(Z_{\\mathrm{CM}}^2 - 0) = I_{\\mathrm{O},yy} - M Z_{\\mathrm{CM}}^2 $$\n$$ I_{zz} = I_{\\mathrm{O},zz} - M(Z_{\\mathrm{CM}}^2 - Z_{\\mathrm{CM}}^2) = I_{\\mathrm{O},zz} $$\n关于质心的主轴平行于原始坐标轴，因此 $\\mathbf{I}$ 是对角的。\n\n**数值计算**\n我们现在代入数值 $m_{\\mathrm{H}}=1.00784$ amu, $r=1.090$ $\\mathrm{\\AA}$ ($r^2=1.1881$ $\\mathrm{\\AA}^2$), $M=15.03452$ amu, 和 $Z_{\\mathrm{CM}}=-0.073070$ $\\mathrm{\\AA}$。\n\n$I_{zz} = I_{\\mathrm{O},zz} = \\frac{8}{3} m_{\\mathrm{H}} r^2 = \\frac{8}{3} \\times 1.00784 \\times 1.1881 \\approx 3.19299 \\text{ amu}\\cdot\\mathrm{\\AA}^2$\n\n$I_{\\mathrm{O},xx} = \\frac{5}{3} m_{\\mathrm{H}} r^2 = \\frac{5}{3} \\times 1.00784 \\times 1.1881 \\approx 1.99569 \\text{ amu}\\cdot\\mathrm{\\AA}^2$\n\n接下来，我们求平行轴定理的修正项：\n$M Z_{\\mathrm{CM}}^2 = 15.03452 \\times (-0.073070)^2 \\approx 15.03452 \\times 0.0053392 \\approx 0.080265 \\text{ amu}\\cdot\\mathrm{\\AA}^2$\n\n最后，我们计算 $I_{xx}$ 和 $I_{yy}$：\n$I_{xx} = I_{yy} = I_{\\mathrm{O},xx} - M Z_{\\mathrm{CM}}^2 \\approx 1.99569 - 0.080265 = 1.915425 \\text{ amu}\\cdot\\mathrm{\\AA}^2$\n\n**最终结果**\n将所需值四舍五入到四位有效数字：\n$M = 15.03452 \\approx 15.03$ amu\n$I_{xx} = 1.915425 \\approx 1.915$ amu$\\cdot\\mathrm{\\AA}^2$\n$I_{yy} = 1.915425 \\approx 1.915$ amu$\\cdot\\mathrm{\\AA}^2$\n$I_{zz} = 3.19299 \\approx 3.193$ amu$\\cdot\\mathrm{\\AA}^2$\n\n最终结果表示为行矩阵 $\\begin{pmatrix} M  I_{xx}  I_{yy}  I_{zz} \\end{pmatrix}$。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 15.03  1.915  1.915  3.193 \\end{pmatrix} } $$"
        },
        {
            "introduction": "为了提高计算效率，分子模拟通常会引入截断半径，但这会给能量等热力学性质的计算带来误差。本练习  将指导你推导Lennard-Jones流体中由于势能截断而产生的构型能量长程校正项。掌握这项技能对于提高UA模拟的准确性至关重要，是计算物理化学中的一项基本功。",
            "id": "3857547",
            "problem": "考虑一个由相同的联合原子（UA）相互作用位点组成的均匀、各向同性的流体，其中每个位点通过Lennard-Jones $12\\text{–}6$ 对势 $u(r) = 4\\varepsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6}\\right]$进行相互作用，其能量参数为 $\\varepsilon$，长度参数为 $\\sigma$。该系统在模拟过程中使用距离为 $r_{c}$ 的球形截断，且没有进行势函数平移或尾部校正，因此当 $r > r_{c}$ 时，对势被截断为零。假设数密度为 $\\rho$，且径向分布函数 $g(r)$ 在 $r > r_{c}$ 时满足 $g(r) = 1$。\n\n从均匀流体中每个粒子的构型势能（用对势和径向分布函数表示）的基本定义出发，推导用于解释被忽略的超出 $r_{c}$ 范围的相互作用的、对每个粒子构型能量的长程尾部校正的解析表达式。请用 $\\rho$、$\\varepsilon$、$\\sigma$ 和 $r_{c}$ 表示您的最终结果，形式为一个封闭表达式。\n\n使用国际单位制（SI）：$\\rho$ 的单位为 $\\mathrm{m}^{-3}$，$r_{c}$ 和 $\\sigma$ 的单位为 $\\mathrm{m}$，$\\varepsilon$ 的单位为 $\\mathrm{J}$。最终的每个粒子的能量以 $\\mathrm{J}$ 为单位表示。不要进行数值计算；仅提供精确的解析表达式。",
            "solution": "该问题被认为是有效的，因为它科学地基于统计力学和分子模拟的原理，问题阐述清晰，目标明确，信息充分，并且语言客观。它代表了该领域的一个标准推导。\n\n一个由 $N$ 个粒子组成的、处于体积 $V$ 中的均匀、各向同性流体的总构型势能 $U$，可以用对势 $u(r)$ 和径向分布函数 $g(r)$ 来表示。每个粒子的构型能量 $U/N$ 的表达式为：\n$$\n\\frac{U}{N} = \\frac{1}{2} \\rho \\int_{0}^{\\infty} u(r) g(r) 4\\pi r^2 dr = 2\\pi\\rho \\int_{0}^{\\infty} u(r) g(r) r^2 dr\n$$\n其中 $\\rho = N/V$ 是流体的数密度。\n\n在带有球形截断半径 $r_c$ 的分子模拟中，对势被截断，这意味着只计算粒子间距 $r \\le r_c$ 时的相互作用。因此，在这种模拟中直接计算的能量 $(U/N)_{sim}$ 为：\n$$\n\\left(\\frac{U}{N}\\right)_{sim} = 2\\pi\\rho \\int_{0}^{r_c} u(r) g(r) r^2 dr\n$$\n长程尾部校正（我们记作 $U_{tail}$）是模拟过程中被忽略的、来自截断半径以外的相互作用对能量的贡献。该校正是真实总能量与模拟计算的能量之差：\n$$\nU_{tail} = \\frac{U}{N} - \\left(\\frac{U}{N}\\right)_{sim} = 2\\pi\\rho \\int_{r_c}^{\\infty} u(r) g(r) r^2 dr\n$$\n问题提供了计算此积分所需的必要组成部分。首先，对势是Lennard-Jones $12\\text{–}6$ 势：\n$$\nu(r) = 4\\varepsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6}\\right]\n$$\n其次，对于积分中 $r > r_c$ 的长程部分，我们假设流体是无关联的，即径向分布函数为1：\n$$\ng(r) = 1 \\quad \\text{for } r > r_c\n$$\n将这些表达式代入尾部校正的积分中，得到：\n$$\nU_{tail} = 2\\pi\\rho \\int_{r_c}^{\\infty} \\left( 4\\varepsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6}\\right] \\right) (1) r^2 dr\n$$\n我们可以将常数提到积分符号外面：\n$$\nU_{tail} = 8\\pi\\rho\\varepsilon \\int_{r_c}^{\\infty} \\left[ \\frac{\\sigma^{12}}{r^{12}} - \\frac{\\sigma^{6}}{r^{6}} \\right] r^2 dr\n$$\n接下来，我们合并 $r$ 的幂：\n$$\nU_{tail} = 8\\pi\\rho\\varepsilon \\int_{r_c}^{\\infty} \\left( \\sigma^{12}r^{-10} - \\sigma^{6}r^{-4} \\right) dr\n$$\n现在，我们逐项进行积分：\n$$\n\\int \\left( \\sigma^{12}r^{-10} - \\sigma^{6}r^{-4} \\right) dr = \\sigma^{12}\\frac{r^{-9}}{-9} - \\sigma^{6}\\frac{r^{-3}}{-3} + C = -\\frac{\\sigma^{12}}{9r^9} + \\frac{\\sigma^{6}}{3r^3} + C\n$$\n计算从 $r_c$ 到 $\\infty$ 的定积分：\n$$\nU_{tail} = 8\\pi\\rho\\varepsilon \\left[ -\\frac{\\sigma^{12}}{9r^9} + \\frac{\\sigma^{6}}{3r^3} \\right]_{r_c}^{\\infty}\n$$\n在上限 $r \\to \\infty$ 处，由于 $r^{-9} \\to 0$ 和 $r^{-3} \\to 0$，两项的计算结果都为零。然后我们减去在下限 $r=r_c$ 处的值：\n$$\nU_{tail} = 8\\pi\\rho\\varepsilon \\left( 0 - \\left[ -\\frac{\\sigma^{12}}{9r_c^9} + \\frac{\\sigma^{6}}{3r_c^3} \\right] \\right)\n$$\n$$\nU_{tail} = 8\\pi\\rho\\varepsilon \\left( \\frac{\\sigma^{12}}{9r_c^9} - \\frac{\\sigma^{6}}{3r_c^3} \\right)\n$$\n这个表达式可以通过提取公因式来整理成更常规的形式。提取出 $\\frac{1}{3}$ 以及包含 $\\sigma$ 和 $r_c$ 的项，得到：\n$$\nU_{tail} = \\frac{8\\pi\\rho\\varepsilon}{3} \\left( \\frac{\\sigma^{12}}{3r_c^9} - \\frac{\\sigma^{6}}{r_c^3} \\right)\n$$\n这可以进一步用无量纲比率 $(\\sigma/r_c)$ 来表示：\n$$\nU_{tail} = \\frac{8\\pi\\rho\\varepsilon\\sigma^3}{3} \\left( \\frac{1}{3}\\frac{\\sigma^9}{r_c^9} - \\frac{\\sigma^3}{r_c^3} \\right) = \\frac{8\\pi\\rho\\varepsilon\\sigma^3}{3} \\left[ \\frac{1}{3}\\left(\\frac{\\sigma}{r_c}\\right)^9 - \\left(\\frac{\\sigma}{r_c}\\right)^3 \\right]\n$$\n这就是每个粒子构型能量的长程尾部校正的最终封闭形式表达式。",
            "answer": "$$\\boxed{\\frac{8\\pi\\rho\\varepsilon\\sigma^3}{3} \\left[ \\frac{1}{3}\\left(\\frac{\\sigma}{r_c}\\right)^9 - \\left(\\frac{\\sigma}{r_c}\\right)^3 \\right]}$$"
        },
        {
            "introduction": "联合原子模型的一个关键目标是准确再现系统的长时间动力学行为。本练习  探讨了如何校准Langevin恒温器中的摩擦系数，以确保UA模型的扩散系数与高精度全原子模拟的目标值相匹配。这个过程通过涨落-耗散定理将简化模型的动力学与物理实际联系起来，是实现可靠动态预测的核心步骤。",
            "id": "3857599",
            "problem": "要求您设计并实现一种 Langevin 恒温器中摩擦系数的校准方法，以在给定温度下复现联合原子（UA）流体的指定全原子目标扩散系数。该问题借鉴了基础统计力学和随机动力学的知识。考虑一个代表粗粒化原子团的单个 UA 珠子。在使用 Langevin 恒温器对此珠子进行分子动力学（MD）模拟时，珠子的速度遵循 Langevin 方程，该方程强制执行涨落-耗散定理（FDT）以在期望温度下维持热平衡。\n\n假设一个处于 Langevin 恒温器下的自由粒子，其质量为 $m$，摩擦系数为 $\\gamma$（单位为 $\\mathrm{s}^{-1}$），并受到热噪声的影响。其速度的运动方程为\n$$\nm \\frac{d v(t)}{d t} = - m \\gamma v(t) + \\sqrt{2 m \\gamma k_{\\mathrm{B}} T}\\,\\xi(t),\n$$\n其中 $v(t)$ 是速度，$T$ 是绝对温度，$k_{\\mathrm{B}}$ 是 Boltzmann 常数，$\\xi(t)$ 是一个均值为零且相关性如下的高斯白噪声过程\n$$\n\\langle \\xi_i(t)\\,\\xi_j(t') \\rangle = \\delta_{ij}\\,\\delta(t-t').\n$$\n扩散系数 $D$ 通过 $d$ 维空间中均方根位移（MSD）的长时间极限来定义，\n$$\nD = \\lim_{t \\to \\infty} \\frac{1}{2 d t} \\left\\langle \\left\\| x(t) - x(0) \\right\\|^2 \\right\\rangle.\n$$\n另外，根据 Green-Kubo 关系，$D$ 可以表示为速度自相关函数的时间积分，\n$$\nD = \\int_0^{\\infty} \\left\\langle v(0)\\,v(t) \\right\\rangle dt.\n$$\n\n任务：\n1. 从 Langevin 方程和上述定义出发，推导以 $m$、$\\gamma$、$k_{\\mathrm{B}}$ 和 $T$ 表示的长时间扩散系数 $D$ 的显式表达式。您不能使用任何预先给出的简化公式；推导必须从随机方程及其所蕴含的平衡统计性质出发。\n2. 基于您推导的表达式，提出一种数学上精确的校准方法来选择 $\\gamma$，使得模拟的 UA 珠子能在温度 $T$ 下复现指定的全部原子目标扩散系数 $D_{\\mathrm{AA}}$。您的方法必须确保 $\\gamma$ 的单位为 $\\mathrm{s}^{-1}$ 并且严格为正。\n3. 实现一个程序，为几个测试用例计算 $\\gamma$。在每个测试用例中，输入参数为：\n   - 绝对温度 $T$，单位为 $\\mathrm{K}$。\n   - UA 珠子的摩尔质量 $M$，单位为 $\\mathrm{g/mol}$。\n   - 目标扩散系数 $D_{\\mathrm{AA}}$，单位为 $\\mathrm{m^2/s}$。\n   您必须使用 Avogadro 常数 $N_{\\mathrm{A}}$ 将摩尔质量 $M$ 转换为单个珠子的质量 $m$，通过公式 $m = (M \\times 10^{-3}) / N_{\\mathrm{A}}$，其中 $N_{\\mathrm{A}} = 6.02214076 \\times 10^{23}\\,\\mathrm{mol}^{-1}$。使用 $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}\\,\\mathrm{J/K}$。将摩擦系数 $\\gamma$ 以 $\\mathrm{s}^{-1}$ 为单位表示为浮点数。\n4. 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $[x_1,x_2,x_3]$），其中每个 $x_i$ 是相应测试用例的校准后 $\\gamma$ 值。\n\n测试套件：\n使用以下科学上合理的 UA 流体测试用例，涵盖典型和边缘场景：\n- 案例 1（正常路径）：$T = 300$, $M = 15.034$, $D_{\\mathrm{AA}} = 1.0 \\times 10^{-9}$。\n- 案例 2（中等重量珠子，较高温度）：$T = 350$, $M = 44.000$, $D_{\\mathrm{AA}} = 2.0 \\times 10^{-9}$。\n- 案例 3（边缘案例，极慢扩散）：$T = 300$, $M = 100.000$, $D_{\\mathrm{AA}} = 1.0 \\times 10^{-12}$。\n- 案例 4（轻珠子，快速扩散）：$T = 500$, $M = 14.000$, $D_{\\mathrm{AA}} = 1.0 \\times 10^{-8}$。\n\n所有温度 $T$ 的单位必须是 $\\mathrm{K}$，所有摩尔质量 $M$ 的单位必须是 $\\mathrm{g/mol}$，所有扩散系数 $D_{\\mathrm{AA}}$ 的单位必须是 $\\mathrm{m^2/s}$，最终校准的摩擦系数必须以 $\\mathrm{s}^{-1}$ 为单位报告为浮点数。最终输出格式必须是单行：$[\\gamma_1,\\gamma_2,\\gamma_3,\\gamma_4]$。",
            "solution": "该问题要求为联合原子（UA）珠子模拟中使用的 Langevin 恒温器的摩擦系数 $\\gamma$ 推导一种校准方法。其目标是复现从相应的全原子模拟中获得的目标扩散系数 $D_{\\mathrm{AA}}$。推导必须从基本的 Langevin 方程和统计力学中的定义出发。\n\n### 第 1 部分：扩散系数 $D$ 的推导\n\n分析始于质量为 $m$ 的粒子速度 $v(t)$ 的一维 Langevin 方程，该粒子受到摩擦阻力和随机热力的作用。对于速度矢量的一个分量，方程给出如下：\n$$\nm \\frac{d v(t)}{d t} = - m \\gamma v(t) + F_R(t)\n$$\n其中 $F_R(t) = \\sqrt{2 m \\gamma k_{\\mathrm{B}} T}\\,\\xi(t)$ 是随机力。项 $\\gamma$ 是摩擦系数，单位为时间的倒数，$k_{\\mathrm{B}}$ 是 Boltzmann 常数，$T$ 是绝对温度，$\\xi(t)$ 是一个均值为零且具有 delta 相关的 高斯白噪声过程：$\\langle \\xi(t) \\rangle = 0$ 和 $\\langle \\xi(t)\\,\\xi(t') \\rangle = \\delta(t-t')$。对于多维系统，假设各向同性，则速度分量是独立的，该方程对每个分量都成立。\n\n我们可以将该方程重写为标准的一阶线性常微分方程：\n$$\n\\frac{d v(t)}{d t} + \\gamma v(t) = \\frac{1}{m} F_R(t)\n$$\n此方程的解可以通过使用积分因子 $e^{\\gamma t}$ 求得。将方程乘以该因子可得：\n$$\ne^{\\gamma t} \\left(\\frac{d v(t)}{d t} + \\gamma v(t)\\right) = \\frac{d}{dt}\\left(v(t) e^{\\gamma t}\\right) = \\frac{1}{m} e^{\\gamma t} F_R(t)\n$$\n从时间 $0$ 积分到 $t$：\n$$\nv(t) e^{\\gamma t} - v(0) e^0 = \\frac{1}{m} \\int_0^t e^{\\gamma s} F_R(s) ds\n$$\n求解 $v(t)$，我们得到：\n$$\nv(t) = v(0) e^{-\\gamma t} + \\frac{1}{m} \\int_0^t e^{-\\gamma (t-s)} F_R(s) ds\n$$\n该表达式给出了时间 $t$ 处的速度，用其初始值和随机力的历史来表示。\n\n下一步是计算速度自相关函数（VACF），定义为 $C_{vv}(t) = \\langle v(0) v(t) \\rangle$。平均值是在处于热平衡状态的粒子系综上计算的。\n$$\n\\langle v(0) v(t) \\rangle = \\left\\langle v(0) \\left( v(0) e^{-\\gamma t} + \\frac{1}{m} \\int_0^t e^{-\\gamma (t-s)} F_R(s) ds \\right) \\right\\rangle\n$$\n$$\n\\langle v(0) v(t) \\rangle = \\langle v(0)^2 \\rangle e^{-\\gamma t} + \\frac{1}{m} \\int_0^t e^{-\\gamma (t-s)} \\langle v(0) F_R(s) \\rangle ds\n$$\n在一个处于热平衡的系统中，时间 $t=0$ 时的速度 $v(0)$ 由 $s  0$ 时的随机力历史决定。噪声过程 $\\xi(s)$ 是无记忆的（白噪声），因此在时间 $s>0$ 时的随机力 $F_R(s)$ 与速度 $v(0)$ 不相关。因此，对于 $s \\ge 0$，有 $\\langle v(0) F_R(s) \\rangle = \\langle v(0) \\rangle \\langle F_R(s) \\rangle = 0$，因为 $\\langle F_R(s) \\rangle = 0$。所以积分项为零。\n\nVACF 简化为：\n$$\nC_{vv}(t) = \\langle v(0)^2 \\rangle e^{-\\gamma t}\n$$\n均方速度 $\\langle v(0)^2 \\rangle$ 由统计力学的能量均分定理确定。对于处于热平衡的粒子，与每个自由度相关的平均动能为 $\\frac{1}{2} k_{\\mathrm{B}} T$。对于一维运动：\n$$\n\\frac{1}{2} m \\langle v^2 \\rangle = \\frac{1}{2} k_{\\mathrm{B}} T \\implies \\langle v^2 \\rangle = \\frac{k_{\\mathrm{B}} T}{m}\n$$\n将此代入 VACF 表达式：\n$$\nC_{vv}(t) = \\langle v(0) v(t) \\rangle = \\frac{k_{\\mathrm{B}} T}{m} e^{-\\gamma t}\n$$\n最后，我们使用 Green-Kubo 关系来求扩散系数 $D$。问题提供了公式 $D = \\int_0^{\\infty} \\left\\langle v(0)\\,v(t) \\right\\rangle dt$。当 $v(t)$ 被解释为速度矢量的一个分量（例如 $v_x(t)$）时，此形式给出了一个系统（即使在三维空间中，假设各向同性）的扩散系数。\n$$\nD = \\int_0^\\infty \\left( \\frac{k_{\\mathrm{B}} T}{m} e^{-\\gamma t} \\right) dt\n$$\n计算该积分：\n$$\nD = \\frac{k_{\\mathrm{B}} T}{m} \\int_0^\\infty e^{-\\gamma t} dt = \\frac{k_{\\mathrm{B}} T}{m} \\left[ -\\frac{1}{\\gamma} e^{-\\gamma t} \\right]_0^\\infty\n$$\n$$\nD = \\frac{k_{\\mathrm{B}} T}{m} \\left( \\lim_{t\\to\\infty} \\left(-\\frac{1}{\\gamma}e^{-\\gamma t}\\right) - \\left(-\\frac{1}{\\gamma}e^0\\right) \\right) = \\frac{k_{\\mathrm{B}} T}{m} \\left( 0 + \\frac{1}{\\gamma} \\right)\n$$\n这得出了扩散系数的最终表达式：\n$$\nD = \\frac{k_{\\mathrm{B}} T}{m \\gamma}\n$$\n这个结果是 Einstein-Smoluchowski-Sutherland 关系的一种特殊形式，其中关系式 $D=k_{\\mathrm{B}}T/\\zeta$ 中的摩擦系数 $\\zeta$ 在此由 $\\zeta = m\\gamma$ 给出。\n\n### 第 2 部分：$\\gamma$ 的校准方法\n\n推导出的关系 $D = \\frac{k_{\\mathrm{B}} T}{m \\gamma}$ 提供了微观模拟参数 $\\gamma$ 与宏观可观测量 $D$ 之间的直接联系。任务是选择一个 $\\gamma$ 值，使得 UA 珠子模拟能够复现一个从更详细的模拟或实验中已知的目标扩散系数 $D_{\\mathrm{AA}}$。\n\n设 $D = D_{\\mathrm{AA}}$，我们可以通过代数方法解出 $\\gamma$：\n$$\nD_{\\mathrm{AA}} = \\frac{k_{\\mathrm{B}} T}{m \\gamma} \\implies \\gamma = \\frac{k_{\\mathrm{B}} T}{m D_{\\mathrm{AA}}}\n$$\n该方程构成了所提出的校准方法。为使其有效，必须满足两个条件：\n1.  **严格为正**：$\\gamma$ 必须严格为正。由于 $k_{\\mathrm{B}}$、$T$、$m$ 和 $D_{\\mathrm{AA}}$ 都是正的物理量，它们在公式中的组合保证了 $\\gamma > 0$。\n2.  **正确的单位**：$\\gamma$ 的单位必须是 $\\mathrm{s}^{-1}$。量纲分析证实了这一点：\n$$\n[\\gamma] = \\frac{[k_{\\mathrm{B}}] [T]}{[m] [D_{\\mathrm{AA}}]} = \\frac{(\\mathrm{J} \\cdot \\mathrm{K}^{-1}) \\cdot (\\mathrm{K})}{(\\mathrm{kg}) \\cdot (\\mathrm{m}^2 \\cdot \\mathrm{s}^{-1})} = \\frac{\\mathrm{J}}{\\mathrm{kg} \\cdot \\mathrm{m}^2 \\cdot \\mathrm{s}^{-1}}\n$$\n回顾一下，焦耳（Joule）是国际单位制（SI）中的能量单位，其定义为 $\\mathrm{J} = \\mathrm{kg} \\cdot \\mathrm{m}^2 \\cdot \\mathrm{s}^{-2}$：\n$$\n[\\gamma] = \\frac{\\mathrm{kg} \\cdot \\mathrm{m}^2 \\cdot \\mathrm{s}^{-2}}{\\mathrm{kg} \\cdot \\mathrm{m}^2 \\cdot \\mathrm{s}^{-1}} = \\mathrm{s}^{-1}\n$$\n单位与要求一致。因此，该校准方法是良定义且物理上合理的。\n\n### 第 3 部分：实现策略\n\n实现需要一个程序来为一组给定的测试用例计算 $\\gamma$。每个用例的流程如下：\n1.  接受输入参数：温度 $T$（单位为开尔文），摩尔质量 $M$（单位为 $\\mathrm{g/mol}$），以及目标扩散系数 $D_{\\mathrm{AA}}$（单位为 $\\mathrm{m^2/s}$）。\n2.  使用提供的物理常数：$k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}\\,\\mathrm{J/K}$ 和 $N_{\\mathrm{A}} = 6.02214076 \\times 10^{23}\\,\\mathrm{mol}^{-1}$。\n3.  将摩尔质量 $M$ 转换为单个 UA 珠子的质量 $m$，单位为国际单位制（千克）。从 $\\mathrm{g/mol}$ 到 $\\mathrm{kg/bead}$ 的转换如下：\n    $$ m = \\frac{M \\, (\\mathrm{g/mol}) \\times 10^{-3} \\, (\\mathrm{kg/g})}{N_{\\mathrm{A}} \\, (\\mathrm{mol}^{-1})} $$\n4.  应用推导出的校准公式计算 $\\gamma$：\n    $$ \\gamma = \\frac{k_{\\mathrm{B}} T}{m D_{\\mathrm{AA}}} $$\n5.  $\\gamma$ 的结果单位将是 $\\mathrm{s}^{-1}$，应将其存储。\n6.  对所有测试用例重复此过程，并将最终结果格式化为用方括号括起来的单行逗号分隔列表。\n\n这个系统性的流程确保了 Langevin 摩擦参数的校准既准确又可复现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the Langevin friction coefficient gamma required to match a target\n    diffusion coefficient for a United-Atom (UA) bead.\n    \"\"\"\n    \n    # Define physical constants in SI units.\n    # Boltzmann constant in J/K.\n    k_B = 1.380649e-23\n    # Avogadro's constant in mol^-1.\n    N_A = 6.02214076e23\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (T in K, M in g/mol, D_AA in m^2/s)\n    test_cases = [\n        # Case 1 (happy path)\n        (300.0, 15.034, 1.0e-9),\n        # Case 2 (moderately heavy bead, higher temperature)\n        (350.0, 44.000, 2.0e-9),\n        # Case 3 (edge case, very slow diffusion)\n        (300.0, 100.000, 1.0e-12),\n        # Case 4 (light bead, fast diffusion)\n        (500.0, 14.000, 1.0e-8),\n    ]\n\n    results = []\n\n    def calculate_gamma(T, M, D_AA):\n        \"\"\"\n        Computes the friction coefficient gamma based on the derived formula.\n\n        Args:\n            T (float): Absolute temperature in Kelvin (K).\n            M (float): Molar mass of the UA bead in grams per mole (g/mol).\n            D_AA (float): Target all-atom diffusion coefficient in m^2/s.\n\n        Returns:\n            float: The calibrated friction coefficient gamma in s^-1.\n        \"\"\"\n        # Convert molar mass M from g/mol to particle mass m in kg.\n        # The factor 1e-3 converts grams to kilograms.\n        m = (M * 1e-3) / N_A\n        \n        # Calculate the thermal energy k_B * T.\n        k_B_T = k_B * T\n        \n        # Apply the derived calibration formula: gamma = (k_B * T) / (m * D_AA)\n        # This formula is derived from the Einstein-Smoluchowski relation D = k_B*T / (m*gamma).\n        gamma = k_B_T / (m * D_AA)\n        \n        return gamma\n\n    for case in test_cases:\n        T, M, D_AA = case\n        gamma_val = calculate_gamma(T, M, D_AA)\n        results.append(gamma_val)\n\n    # Final print statement in the exact required format.\n    # The map(str, ...) converts each float result to its string representation.\n    # ','.join(...) creates the comma-separated string.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}