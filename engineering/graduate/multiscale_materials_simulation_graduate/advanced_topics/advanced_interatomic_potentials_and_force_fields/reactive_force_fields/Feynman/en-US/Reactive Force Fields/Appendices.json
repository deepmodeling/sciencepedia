{
    "hands_on_practices": [
        {
            "introduction": "This exercise provides a foundational, hands-on calculation of a system's total potential energy using a simplified ReaxFF-like model. By manually summing the bond, valence angle, electrostatic, and van der Waals energy terms for a small molecule, you will gain a concrete understanding of how a reactive force field constructs the potential energy surface from first principles . This practice is essential for demystifying the complex energy expressions and developing an intuition for the magnitude of different contributions.",
            "id": "4256259",
            "problem": "A triatomic system with atoms $A$, $B$, and $C$ lies in the $xy$-plane. The atomic coordinates in ångströms are $A:(0,0,0)$, $B:(1.40,0,0)$, and $C:(1.8104,1.1276,0)$, yielding bond distances $r_{AB} = 1.40$ ångström and $r_{BC} = 1.20$ ångström. The valence angle at $B$ is $\\theta_{ABC} = 110$ degrees. The bond orders are $B_{AB} = 0.85$ and $B_{BC} = 0.65$. The partial charges (in units of the elementary charge) are $q_A = +0.4$, $q_B = -0.3$, and $q_C = -0.1$. Using the following reactive force field energy decomposition and functional forms, compute the total potential energy $E_{\\text{tot}}$:\n\nThe total energy is defined as $E_{\\text{tot}} = E_{\\text{bond}} + E_{\\text{val}} + E_{\\text{coul}} + E_{\\text{vdW}}$, where:\n\n1. The bond energy is\n$$\nE_{\\text{bond}} = \\sum_{\\langle i,j\\rangle} \\left( - D_{ij} \\, B_{ij} \\, \\exp\\!\\left[-\\alpha_{ij} \\left(r_{ij} - r_{0,ij}\\right)\\right] \\right),\n$$\nwith parameters $D_{AB} = 250$ kJ/mol, $D_{BC} = 220$ kJ/mol, $\\alpha_{AB} = 3.0$ ångström$^{-1}$, $\\alpha_{BC} = 3.2$ ångström$^{-1}$, $r_{0,AB} = 1.30$ ångström, and $r_{0,BC} = 1.25$ ångström.\n\n2. The valence angle energy is\n$$\nE_{\\text{val}} = k_{\\theta} \\, B_{AB} \\, B_{BC} \\left(\\theta_{ABC} - \\theta_{0}\\right)^{2},\n$$\nwith $k_{\\theta} = 40$ kJ/mol/radian², and $\\theta_{0} = 115$ degrees. Use radians in the computation of this term.\n\n3. The electrostatic (Coulomb) energy uses shielded pairwise interactions\n$$\nE_{\\text{coul}} = \\sum_{i<j} \\frac{1}{4\\pi \\epsilon_{0}} \\frac{(q_i e)(q_j e)}{r_{ij} + \\gamma_{ij}},\n$$\nwith the vacuum permittivity $\\epsilon_{0} = 8.8541878128 \\times 10^{-12}$ farad/meter, the elementary charge $e = 1.602176634 \\times 10^{-19}$ coulomb, $\\gamma_{ij} = 0.20$ ångström for all pairs, and $r_{ij}$ in ångström converted to meters using 1 ångström = $10^{-10}$ meter. Convert the energy to kJ/mol using the Avogadro constant $N_{A} = 6.02214076 \\times 10^{23}$ mol$^{-1}$ and $1$ kJ $= 10^{3}$ J.\n\n4. The van der Waals energy is a shielded Lennard–Jones form\n$$\nE_{\\text{vdW}} = \\sum_{i<j} \\epsilon_{ij} \\left[\\left(\\frac{r_{0,ij}}{r_{ij} + \\delta_{ij}}\\right)^{12} - 2 \\left(\\frac{r_{0,ij}}{r_{ij} + \\delta_{ij}}\\right)^{6}\\right],\n$$\nwith $\\delta_{ij} = 2.0$ ångström for all pairs, and parameters $\\epsilon_{AB} = 0.50$ kJ/mol, $\\epsilon_{BC} = 0.45$ kJ/mol, $\\epsilon_{AC} = 0.48$ kJ/mol; $r_{0,AB} = 3.20$ ångström, $r_{0,BC} = 3.10$ ångström, and $r_{0,AC} = 3.20$ ångström.\n\nThe interatomic distance $r_{AC}$ should be obtained from the given coordinates. All computations must be internally consistent with the stated units.\n\nCompute $E_{\\text{tot}}$ and express the final energy in kJ/mol. Round your answer to four significant figures.",
            "solution": "The problem is validated as self-contained, scientifically grounded, and well-posed. The data provided are consistent and sufficient for a unique solution. We proceed to calculate the total potential energy, $E_{\\text{tot}}$, by summing its four constituent components: $E_{\\text{bond}}$, $E_{\\text{val}}$, $E_{\\text{coul}}$, and $E_{\\text{vdW}}$.\n\nFirst, we must calculate the non-bonded distance $r_{AC}$ using the provided atomic coordinates $A:(0,0,0)$ and $C:(1.8104, 1.1276, 0)$. All coordinates are in ångströms.\n$$\nr_{AC} = \\sqrt{(x_C - x_A)^2 + (y_C - y_A)^2 + (z_C - z_A)^2}\n$$\n$$\nr_{AC} = \\sqrt{(1.8104 - 0)^2 + (1.1276 - 0)^2 + (0 - 0)^2} = \\sqrt{3.27754816 + 1.27158176} = \\sqrt{4.54912992}\n$$\n$$\nr_{AC} \\approx 2.1328689 \\, \\text{ångström}\n$$\nThe other distances are given as $r_{AB} = 1.40$ ångström and $r_{BC} = 1.20$ ångström.\n\nThe total energy is $E_{\\text{tot}} = E_{\\text{bond}} + E_{\\text{val}} + E_{\\text{coul}} + E_{\\text{vdW}}$.\n\n1.  **Bond Energy ($E_{\\text{bond}}$)**\n    The bond energy is the sum of contributions from the two bonds, $A-B$ and $B-C$:\n    $$\n    E_{\\text{bond}} = E_{\\text{bond, AB}} + E_{\\text{bond, BC}}\n    $$\n    $$\n    E_{\\text{bond, AB}} = -D_{AB} B_{AB} \\exp\\left[-\\alpha_{AB} (r_{AB} - r_{0,AB})\\right]\n    $$\n    Substituting the given values: $D_{AB} = 250$ kJ/mol, $B_{AB} = 0.85$, $\\alpha_{AB} = 3.0$ ångström$^{-1}$, $r_{AB} = 1.40$ ångström, and $r_{0,AB} = 1.30$ ångström.\n    $$\n    E_{\\text{bond, AB}} = -250 \\times 0.85 \\times \\exp[-3.0 \\times (1.40 - 1.30)] = -212.5 \\times \\exp[-0.3] \\approx -157.4239 \\, \\text{kJ/mol}\n    $$\n    $$\n    E_{\\text{bond, BC}} = -D_{BC} B_{BC} \\exp\\left[-\\alpha_{BC} (r_{BC} - r_{0,BC})\\right]\n    $$\n    Substituting the given values: $D_{BC} = 220$ kJ/mol, $B_{BC} = 0.65$, $\\alpha_{BC} = 3.2$ ångström$^{-1}$, $r_{BC} = 1.20$ ångström, and $r_{0,BC} = 1.25$ ångström.\n    $$\n    E_{\\text{bond, BC}} = -220 \\times 0.65 \\times \\exp[-3.2 \\times (1.20 - 1.25)] = -143 \\times \\exp[0.16] \\approx -167.8111 \\, \\text{kJ/mol}\n    $$\n    The total bond energy is:\n    $$\n    E_{\\text{bond}} \\approx -157.4239 - 167.8111 = -325.2350 \\, \\text{kJ/mol}\n    $$\n\n2.  **Valence Angle Energy ($E_{\\text{val}}$)**\n    The valence angle energy is given by:\n    $$\n    E_{\\text{val}} = k_{\\theta} B_{AB} B_{BC} (\\theta_{ABC} - \\theta_{0})^2\n    $$\n    The angles must be in radians for the calculation. The given angles are $\\theta_{ABC} = 110^{\\circ}$ and $\\theta_{0} = 115^{\\circ}$.\n    The angle difference is $\\Delta\\theta = \\theta_{ABC} - \\theta_{0} = 110^{\\circ} - 115^{\\circ} = -5^{\\circ}$.\n    Converting to radians: $\\Delta\\theta_{\\text{rad}} = -5 \\times \\frac{\\pi}{180} = -\\frac{\\pi}{36}$ radians.\n    Substituting the values $k_{\\theta} = 40$ kJ/mol/radian², $B_{AB} = 0.85$, and $B_{BC} = 0.65$:\n    $$\n    E_{\\text{val}} = 40 \\times 0.85 \\times 0.65 \\times \\left(-\\frac{\\pi}{36}\\right)^2 = 22.1 \\times \\left(-\\frac{\\pi}{36}\\right)^2 \\approx 0.1683 \\, \\text{kJ/mol}\n    $$\n\n3.  **Electrostatic (Coulomb) Energy ($E_{\\text{coul}}$)**\n    The Coulomb energy is summed over all unique pairs ($A-B$, $A-C$, $B-C$):\n    $$\n    E_{\\text{coul}} = \\sum_{i<j} \\frac{1}{4\\pi\\epsilon_{0}} \\frac{(q_i e)(q_j e)}{r_{ij} + \\gamma_{ij}}\n    $$\n    To obtain the energy in kJ/mol with distances in ångström, we use a conversion factor, $k_C$:\n    $$\n    k_C = \\frac{N_A e^2}{4\\pi\\epsilon_0} \\times \\frac{1 \\text{ kJ}}{1000 \\text{ J}} \\times \\frac{10^{10} \\text{ ångström}}{1 \\text{ m}}\n    $$\n    $$\n    k_C \\approx 1389.354 \\, \\frac{\\text{kJ} \\cdot \\text{ångström}}{\\text{mol}}\n    $$\n    The energy expression becomes:\n    $$\n    E_{\\text{coul}} = k_C \\left(\\frac{q_A q_B}{r_{AB} + \\gamma} + \\frac{q_A q_C}{r_{AC} + \\gamma} + \\frac{q_B q_C}{r_{BC} + \\gamma}\\right)\n    $$\n    Using $q_A = +0.4$, $q_B = -0.3$, $q_C = -0.1$, and $\\gamma = 0.20$ ångström:\n    $$\n    E_{\\text{coul}} \\approx 1389.354 \\left(\\frac{(0.4)(-0.3)}{1.40 + 0.20} + \\frac{(0.4)(-0.1)}{2.1328689 + 0.20} + \\frac{(-0.3)(-0.1)}{1.20 + 0.20}\\right)\n    $$\n    $$\n    E_{\\text{coul}} \\approx 1389.354 \\left(\\frac{-0.12}{1.60} + \\frac{-0.04}{2.3328689} + \\frac{0.03}{1.40}\\right)\n    $$\n    $$\n    E_{\\text{coul}} \\approx 1389.354 (-0.075 - 0.0171463 + 0.0214286) = 1389.354 (-0.0707177) \\approx -98.2465 \\, \\text{kJ/mol}\n    $$\n\n4.  **Van der Waals Energy ($E_{\\text{vdW}}$)**\n    The van der Waals energy is also summed over all unique pairs:\n    $$\n    E_{\\text{vdW}} = \\sum_{i<j} \\epsilon_{ij} \\left[\\left(\\frac{r_{0,ij}}{r_{ij} + \\delta_{ij}}\\right)^{12} - 2 \\left(\\frac{r_{0,ij}}{r_{ij} + \\delta_{ij}}\\right)^{6}\\right]\n    $$\n    With $\\delta_{ij} = 2.0$ ångström for all pairs.\n    For the $A-B$ pair:\n    $$\n    E_{\\text{vdW, AB}} = 0.50 \\left[\\left(\\frac{3.20}{1.40 + 2.0}\\right)^{12} - 2 \\left(\\frac{3.20}{1.40 + 2.0}\\right)^{6}\\right] = 0.50 \\left[\\left(\\frac{3.20}{3.40}\\right)^{12} - 2 \\left(\\frac{3.20}{3.40}\\right)^{6}\\right] \\approx -0.4565 \\, \\text{kJ/mol}\n    $$\n    For the $B-C$ pair:\n    $$\n    E_{\\text{vdW, BC}} = 0.45 \\left[\\left(\\frac{3.10}{1.20 + 2.0}\\right)^{12} - 2 \\left(\\frac{3.10}{1.20 + 2.0}\\right)^{6}\\right] = 0.45 \\left[\\left(\\frac{3.10}{3.20}\\right)^{12} - 2 \\left(\\frac{3.10}{3.20}\\right)^{6}\\right] \\approx -0.4362 \\, \\text{kJ/mol}\n    $$\n    For the $A-C$ pair:\n    $$\n    E_{\\text{vdW, AC}} = 0.48 \\left[\\left(\\frac{3.20}{2.1328689 + 2.0}\\right)^{12} - 2 \\left(\\frac{3.20}{2.1328689 + 2.0}\\right)^{6}\\right] = 0.48 \\left[\\left(\\frac{3.20}{4.1328689}\\right)^{12} - 2 \\left(\\frac{3.20}{4.1328689}\\right)^{6}\\right] \\approx -0.1846 \\, \\text{kJ/mol}\n    $$\n    The total van der Waals energy is:\n    $$\n    E_{\\text{vdW}} \\approx -0.4565 - 0.4362 - 0.1846 = -1.0773 \\, \\text{kJ/mol}\n    $$\n\n5.  **Total Energy ($E_{\\text{tot}}$)**\n    Summing all the components:\n    $$\n    E_{\\text{tot}} = E_{\\text{bond}} + E_{\\text{val}} + E_{\\text{coul}} + E_{\\text{vdW}}\n    $$\n    $$\n    E_{\\text{tot}} \\approx -325.2350 + 0.1683 - 98.2465 - 1.0773 \\approx -424.3905 \\, \\text{kJ/mol}\n    $$\n    Rounding the result to four significant figures gives $-424.4$ kJ/mol.",
            "answer": "$$\n\\boxed{-424.4}\n$$"
        },
        {
            "introduction": "The cornerstone of any reactive force field is its ability to smoothly describe the energetics of bond formation and breaking. This problem focuses directly on this capability by examining how the bond energy term explicitly depends on the bond order, $BO_{ij}$ . You will calculate the energy change associated with weakening a chemical bond, connecting the abstract mathematical form of the potential to the tangible chemical concept of bond dissociation energy.",
            "id": "3837640",
            "problem": "Consider the Reactive Force Field (ReaxFF) bond energy contribution for a single covalent bond modeled as an explicit function of the bond order. The instantaneous bond energy is given by the parameterization\n$$\nE_{\\text{bond}}(BO_{ij}) = -D_{e}\\,S(BO_{ij})\\,BO_{ij},\n$$\nwhere $D_{e}$ is the dissociation energy scale, $BO_{ij}$ is the bond order between atoms $i$ and $j$, and $S(BO_{ij})$ is a smooth switching function that modulates how the bond energy weakens as the bond order decreases. Assume the following scientifically standard choices for parameters and functional form:\n- The switching function is\n$$\nS(BO_{ij}) = \\exp\\!\\big(-\\gamma\\,(1-BO_{ij})\\big),\n$$\nwith dimensionless parameter $\\gamma = 2.0$.\n- The dissociation energy scale is $D_{e} = 400\\,\\text{kJ mol}^{-1}$.\n\nSuppose a bond is weakened during a reaction coordinate such that the bond order decreases from $BO_{ij} = 1.0$ to $BO_{ij} = 0.2$. Using the above definitions and standard energy bookkeeping, compute the change in bond energy\n$$\n\\Delta E_{\\text{bond}} = E_{\\text{bond}}(0.2) - E_{\\text{bond}}(1.0).\n$$\nRound your final numerical answer to four significant figures and express the result in $\\text{kJ mol}^{-1}$. In addition, briefly interpret the chemical meaning of the sign and magnitude of $\\Delta E_{\\text{bond}}$ in terms of bond weakening within ReaxFF, but note that only the numerical value of $\\Delta E_{\\text{bond}}$ is required as the final answer.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of computational chemistry, specifically reactive force fields, and is well-posed with all necessary information provided for a unique solution.\n\nThe problem asks for the change in bond energy, $\\Delta E_{\\text{bond}}$, as the bond order, $BO_{ij}$, between two atoms decreases from an initial value to a final value. The bond energy, $E_{\\text{bond}}$, is given as a function of $BO_{ij}$:\n$$\nE_{\\text{bond}}(BO_{ij}) = -D_{e}\\,S(BO_{ij})\\,BO_{ij}\n$$\nThe switching function, $S(BO_{ij})$, is defined as:\n$$\nS(BO_{ij}) = \\exp(-\\gamma\\,(1-BO_{ij}))\n$$\nThe provided parameters are the dissociation energy scale, $D_e = 400\\,\\text{kJ mol}^{-1}$, and the dimensionless parameter, $\\gamma = 2.0$. The bond order changes from an initial state $BO_{\\text{initial}} = 1.0$ to a final state $BO_{\\text{final}} = 0.2$.\n\nThe change in bond energy is defined as the final energy minus the initial energy:\n$$\n\\Delta E_{\\text{bond}} = E_{\\text{bond}}(BO_{\\text{final}}) - E_{\\text{bond}}(BO_{\\text{initial}})\n$$\nFirst, we calculate the initial bond energy, $E_{\\text{bond}}(BO_{\\text{initial}})$, where $BO_{\\text{initial}} = 1.0$.\nThe switching function at this bond order is:\n$$\nS(1.0) = \\exp(-\\gamma\\,(1-1.0)) = \\exp(0) = 1\n$$\nThe initial bond energy is therefore:\n$$\nE_{\\text{bond}}(1.0) = -D_e \\times S(1.0) \\times 1.0 = -D_e \\times 1 \\times 1.0 = -D_e\n$$\nSubstituting the value of $D_e$:\n$$\nE_{\\text{bond}}(1.0) = -400\\,\\text{kJ mol}^{-1}\n$$\nThis result is physically meaningful: for a single bond ($BO_{ij} = 1.0$), the bond energy is equal to the negative of the bond dissociation energy scale, representing a stable, fully formed bond.\n\nNext, we calculate the final bond energy, $E_{\\text{bond}}(BO_{\\text{final}})$, where $BO_{\\text{final}} = 0.2$.\nThe switching function at this bond order is:\n$$\nS(0.2) = \\exp(-\\gamma\\,(1-0.2)) = \\exp(-2.0\\,(0.8)) = \\exp(-1.6)\n$$\nThe final bond energy is therefore:\n$$\nE_{\\text{bond}}(0.2) = -D_e \\times S(0.2) \\times 0.2 = -D_e \\times \\exp(-1.6) \\times 0.2\n$$\nNow, we can compute the change in bond energy, $\\Delta E_{\\text{bond}}$:\n$$\n\\Delta E_{\\text{bond}} = E_{\\text{bond}}(0.2) - E_{\\text{bond}}(1.0) = \\big(-D_e \\times 0.2 \\times \\exp(-1.6)\\big) - (-D_e)\n$$\n$$\n\\Delta E_{\\text{bond}} = D_e - 0.2 \\times D_e \\times \\exp(-1.6)\n$$\nFactoring out $D_e$:\n$$\n\\Delta E_{\\text{bond}} = D_e \\left(1 - 0.2 \\times \\exp(-1.6)\\right)\n$$\nSubstituting the value $D_e = 400\\,\\text{kJ mol}^{-1}$:\n$$\n\\Delta E_{\\text{bond}} = 400 \\left(1 - 0.2 \\times \\exp(-1.6)\\right) \\,\\text{kJ mol}^{-1}\n$$\nWe evaluate the numerical expression:\nThe value of $\\exp(-1.6)$ is approximately $0.2018965$.\n$$\n\\Delta E_{\\text{bond}} \\approx 400 \\left(1 - 0.2 \\times 0.2018965\\right) \\,\\text{kJ mol}^{-1}\n$$\n$$\n\\Delta E_{\\text{bond}} \\approx 400 \\left(1 - 0.0403793\\right) \\,\\text{kJ mol}^{-1}\n$$\n$$\n\\Delta E_{\\text{bond}} \\approx 400 \\left(0.9596207\\right) \\,\\text{kJ mol}^{-1}\n$$\n$$\n\\Delta E_{\\text{bond}} \\approx 383.84828 \\,\\text{kJ mol}^{-1}\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\n\\Delta E_{\\text{bond}} = 383.8\\,\\text{kJ mol}^{-1}\n$$\nThe chemical interpretation of this result is as follows. The sign of $\\Delta E_{\\text{bond}}$ is positive, which indicates that the energy of the system has increased. This is consistent with the process of bond weakening or breaking, which requires an input of energy. The magnitude, $383.8\\,\\text{kJ mol}^{-1}$, represents the energy cost to reduce the bond order from a full single bond ($BO_{ij} = 1.0$) to a very weak, nearly dissociated state ($BO_{ij} = 0.2$). This value is close to the full dissociation energy scale $D_e = 400\\,\\text{kJ mol}^{-1}$, which is logical because the bond has been almost completely broken. In the ReaxFF energy landscape, this corresponds to moving from an energy minimum (stable bond) significantly uphill toward the dissociation limit.",
            "answer": "$$\n\\boxed{383.8}\n$$"
        },
        {
            "introduction": "In a real molecular dynamics simulation, forces must be computed accurately at every time step to ensure conservation of energy. This practice explores a critical numerical challenge in ReaxFF simulations: the impact of the charge equilibration (QEq) solver's convergence on long-term energy stability . Through a simplified but insightful numerical experiment, you will investigate how the interplay between the QEq tolerance and the integration time step can introduce non-physical energy drift, a crucial consideration for ensuring the validity of simulation results.",
            "id": "3800917",
            "problem": "You are asked to design and implement a numerical experiment that emulates the energy conservation behavior of Reactive Force Field (ReaxFF) molecular dynamics under charge equilibration when the charge solution is not fully converged. Consider a single particle moving in one spatial dimension with position $x(t)$ and velocity $v(t)$, mass $m$, and a mechanical spring of stiffness $k_{\\mathrm{s}}$. The particle carries an environment-dependent charge $q$ computed by Charge Equilibration (QEq), where the QEq energy is\n$$\nE_{\\mathrm{QEq}}(q,x) = \\chi(x)\\,q + \\frac{1}{2}J\\,q^2,\n$$\nwith electronegativity $\\chi(x)$ and hardness $J$. Assume $\\chi(x)$ is linear in position, $\\chi(x) = c\\,x$, where $c$ is a constant. The physically consistent charge $q^\\star(x)$ at each configuration $(x)$ is defined as the minimizer of $E_{\\mathrm{QEq}}(q,x)$ with respect to $q$.\n\nThe time evolution follows Newton's second law,\n$$\nm\\,\\ddot{x}(t) = F(x,q),\n$$\nand is to be integrated using the velocity-Verlet method. The mechanical potential is $U_{\\mathrm{mech}}(x) = \\frac{1}{2}k_{\\mathrm{s}}x^2$. The force used during integration is the negative gradient of the sum of the mechanical potential and the QEq energy, but in practice it is computed with an approximate charge $q_{\\mathrm{approx}}(x)$ produced by an iterative solver terminated at a prescribed absolute tolerance $\\tau$. Model the incomplete convergence as\n$$\nq_{\\mathrm{approx}}(x) = q^\\star(x) + \\delta,\n$$\nwith a worst-case fixed residual $\\delta = \\tau$ that does not change sign over the trajectory. During integration, compute forces using $q_{\\mathrm{approx}}(x)$, but evaluate the system energy using the physically consistent $q^\\star(x)$ to assess non-conservative work introduced by the approximate charge.\n\nYour program must numerically integrate the system from initial conditions $x(0) = x_0$ and $v(0) = v_0$ using velocity-Verlet over a total simulation time $T_{\\mathrm{total}}$, with constant time step $\\Delta t$. At every step:\n- Use $q_{\\mathrm{approx}}(x)$ to compute the instantaneous force $F(x,q_{\\mathrm{approx}})$.\n- Update $(x,v)$ using velocity-Verlet.\n- For energy bookkeeping, compute the total energy with the physically consistent charge $q^\\star(x)$:\n$$\nE(t) = \\frac{1}{2}m\\,v(t)^2 + \\frac{1}{2}k_{\\mathrm{s}}\\,x(t)^2 + E_{\\mathrm{QEq}}(q^\\star(x(t)),x(t)).\n$$\n\nDefine the energy drift rate as\n$$\nD = \\frac{E(T_{\\mathrm{total}}) - E(0)}{T_{\\mathrm{total}}}.\n$$\nAn acceptable tolerance is one that yields $|D| \\le D_{\\max}$ for a long trajectory. For this problem, use the following constants and initial conditions:\n- $m = 1$,\n- $k_{\\mathrm{s}} = 1$,\n- $J = 4$,\n- $c = 1/2$,\n- $x_0 = 1/2$,\n- $v_0 = 0$,\n- $T_{\\mathrm{total}} = 200$,\n- $D_{\\max} = 10^{-4}$.\n\nAll variables and numbers above are dimensionless, and all outputs must be reported in dimensionless units. Angles do not appear in this problem. The trajectory length $T_{\\mathrm{total}}$ must be realized by an integer number of steps $N = \\lfloor T_{\\mathrm{total}}/\\Delta t \\rfloor$, and the effective simulated time equals $N\\,\\Delta t$. The velocity-Verlet scheme must be applied in its standard two-stage form.\n\nTest Suite:\nCompute the energy drift rate $D$ and the acceptability boolean for each of the following $(\\Delta t,\\tau)$ pairs:\n- Case $1$: $(\\Delta t,\\tau) = (1/2,10^{-5})$,\n- Case $2$: $(\\Delta t,\\tau) = (1/10,10^{-6})$,\n- Case $3$: $(\\Delta t,\\tau) = (2,10^{-3})$,\n- Case $4$: $(\\Delta t,\\tau) = (1/100,10^{-2})$,\n- Case $5$: $(\\Delta t,\\tau) = (1,10^{-8})$.\n\nOutput Specification:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case result must itself be a two-element list in the form $[D,\\mathrm{acceptable}]$, where $D$ is a floating-point number and $\\mathrm{acceptable}$ is a boolean. For example, the output format must look like $[[d_1,b_1],[d_2,b_2],\\ldots]$ with no extra text.",
            "solution": "The user requests a numerical experiment to analyze energy conservation in a simplified reactive force field (ReaxFF) model. This involves simulating a particle's motion where the force is computed using an approximately converged charge, while energy is tracked using the physically correct, fully converged charge. The analysis requires deriving the governing equations, implementing a numerical integrator, and evaluating the energy drift for several test cases.\n\n### Theoretical Framework\n\nFirst, we establish the mathematical model of the system. The total potential energy $U_{\\mathrm{total}}(x,q)$ is the sum of the mechanical spring potential $U_{\\mathrm{mech}}(x)$ and the charge equilibration energy $E_{\\mathrm{QEq}}(q,x)$.\n$$\nU_{\\mathrm{mech}}(x) = \\frac{1}{2}k_{\\mathrm{s}}x^2\n$$\n$$\nE_{\\mathrm{QEq}}(q,x) = \\chi(x)\\,q + \\frac{1}{2}J\\,q^2\n$$\nGiven the position-dependent electronegativity $\\chi(x) = c\\,x$, the QEq energy is:\n$$\nE_{\\mathrm{QEq}}(q,x) = c\\,x\\,q + \\frac{1}{2}J\\,q^2\n$$\n\nThe physically consistent charge, $q^\\star(x)$, is found by minimizing $E_{\\mathrm{QEq}}(q,x)$ with respect to $q$:\n$$\n\\frac{\\partial E_{\\mathrm{QEq}}}{\\partial q} = c\\,x + J\\,q = 0 \\implies q^\\star(x) = -\\frac{c\\,x}{J}\n$$\nThe \"true\" energy of the system, which should be conserved in an ideal simulation, is evaluated with this consistent charge. The potential energy component from the QEq term at this minimum is:\n$$\nE_{\\mathrm{QEq}}(q^\\star(x), x) = c\\,x\\left(-\\frac{c\\,x}{J}\\right) + \\frac{1}{2}J\\left(-\\frac{c\\,x}{J}\\right)^2 = -\\frac{c^2x^2}{J} + \\frac{1}{2}\\frac{c^2x^2}{J} = -\\frac{1}{2}\\frac{c^2x^2}{J}\n$$\nThe total conservative potential energy, which we denote as $U_{\\mathrm{true}}(x)$, is the sum of the mechanical and minimized QEq energies:\n$$\nU_{\\mathrm{true}}(x) = U_{\\mathrm{mech}}(x) + E_{\\mathrm{QEq}}(q^\\star(x), x) = \\frac{1}{2}k_{\\mathrm{s}}x^2 - \\frac{1}{2}\\frac{c^2}{J}x^2 = \\frac{1}{2}\\left(k_{\\mathrm{s}} - \\frac{c^2}{J}\\right)x^2\n$$\nThe total conserved energy of the system is therefore:\n$$\nE(t) = \\frac{1}{2}m\\,v(t)^2 + U_{\\mathrm{true}}(x(t)) = \\frac{1}{2}m\\,v(t)^2 + \\frac{1}{2}\\left(k_{\\mathrm{s}} - \\frac{c^2}{J}\\right)x(t)^2\n$$\nThis is the energy expression used for bookkeeping.\n\nIn the numerical simulation, the charge is not fully converged. It is approximated as $q_{\\mathrm{approx}}(x) = q^\\star(x) + \\delta$, where the charge residual $\\delta$ is modeled as the constant tolerance $\\tau$.\n$$\nq_{\\mathrm{approx}}(x) = -\\frac{c\\,x}{J} + \\tau\n$$\nThe force used to propagate the dynamics, $F_{\\mathrm{dyn}}(x)$, is the negative partial derivative of the total potential energy $U_{\\mathrm{total}}(x,q) = U_{\\mathrm{mech}}(x) + E_{\\mathrm{QEq}}(q,x)$ with respect to $x$, evaluated at $q=q_{\\mathrm{approx}}(x)$. This treatment assumes $q$ is an independent parameter during differentiation with respect to $x$.\n$$\nF(x,q) = -\\frac{\\partial}{\\partial x}\\left(\\frac{1}{2}k_{\\mathrm{s}}x^2 + c\\,x\\,q + \\frac{1}{2}J\\,q^2\\right) = -k_{\\mathrm{s}}x - c\\,q\n$$\nSubstituting $q_{\\mathrm{approx}}(x)$ yields the force for the simulation:\n$$\nF_{\\mathrm{dyn}}(x) = F(x, q_{\\mathrm{approx}}(x)) = -k_{\\mathrm{s}}x - c\\left(-\\frac{c\\,x}{J} + \\tau\\right) = -\\left(k_{\\mathrm{s}} - \\frac{c^2}{J}\\right)x - c\\,\\tau\n$$\nThe conservative force corresponding to $U_{\\mathrm{true}}(x)$ is $F_{\\mathrm{true}}(x) = -\\frac{dU_{\\mathrm{true}}}{dx} = -\\left(k_{\\mathrm{s}} - \\frac{c^2}{J}\\right)x$. The force used in the simulation contains an additional non-conservative component, $F_{\\mathrm{nc}} = -c\\,\\tau$, which is constant and causes the total energy $E(t)$ to drift.\n\n### Numerical Integration and Analysis\n\nThe equation of motion is $m\\,\\ddot{x}(t) = F_{\\mathrm{dyn}}(x)$. We integrate this using the velocity-Verlet algorithm. Given the position $x_i$, velocity $v_i$, and acceleration $a_i = F_{\\mathrm{dyn}}(x_i)/m$ at time step $i$, the state at step $i+1$ is found by:\n1.  Update position: $x_{i+1} = x_i + v_i\\Delta t + \\frac{1}{2}a_i(\\Delta t)^2$.\n2.  Calculate new acceleration: $a_{i+1} = F_{\\mathrm{dyn}}(x_{i+1})/m$.\n3.  Update velocity: $v_{i+1} = v_i + \\frac{1}{2}(a_i + a_{i+1})\\Delta t$.\n\nThe simulation starts from initial conditions $x(0) = x_0$ and $v(0) = v_0$. It runs for a number of steps $N = \\lfloor T_{\\mathrm{total}}/\\Delta t \\rfloor$, giving an effective total simulation time of $T_{\\mathrm{eff}} = N\\Delta t$.\n\nThe energy drift rate $D$ is calculated by evaluating the true energy $E(t)$ at the beginning and end of the trajectory:\n$$\nD = \\frac{E(T_{\\mathrm{eff}}) - E(0)}{T_{\\mathrm{eff}}}\n$$\nA tolerance $\\tau$ is deemed acceptable if $|D| \\le D_{\\max}$.\n\nThe specific dimensionless parameters for this problem are:\n- Mass: $m = 1$\n- Spring stiffness: $k_{\\mathrm{s}} = 1$\n- Hardness: $J = 4$\n- Electronegativity constant: $c = 1/2 = 0.5$\n- Initial position: $x_0 = 1/2 = 0.5$\n- Initial velocity: $v_0 = 0$\n- Total simulation time: $T_{\\mathrm{total}} = 200$\n- Maximum drift rate: $D_{\\max} = 10^{-4}$\n\nUsing these values, the acceleration function becomes:\n$$\na(x) = \\frac{F_{\\mathrm{dyn}}(x)}{m} = -\\left(1 - \\frac{(0.5)^2}{4}\\right)x - 0.5\\tau = -\\frac{15}{16}x - \\frac{1}{2}\\tau\n$$\nAnd the energy function for bookkeeping is:\n$$\nE(x,v) = \\frac{1}{2}(1)v^2 + \\frac{1}{2}\\left(1 - \\frac{(0.5)^2}{4}\\right)x^2 = \\frac{1}{2}v^2 + \\frac{15}{32}x^2\n$$\nThe following algorithm will be implemented for each $(\\Delta t, \\tau)$ pair from the test suite to compute the drift rate and its acceptability.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the ReaxFF energy drift problem by numerically integrating\n    the equation of motion for a single particle and analyzing energy conservation.\n    \"\"\"\n    # Define physical and simulation constants from the problem statement.\n    m = 1.0\n    k_s = 1.0\n    J = 4.0\n    c = 0.5\n    x0 = 0.5\n    v0 = 0.0\n    T_total = 200.0\n    D_max = 1e-4\n\n    # Define the test cases as a list of (delta_t, tau) pairs.\n    test_cases = [\n        (1.0/2.0, 1e-5),\n        (1.0/10.0, 1e-6),\n        (2.0, 1e-3),\n        (1.0/100.0, 1e-2),\n        (1.0, 1e-8),\n    ]\n\n    # Pre-calculate effective constants for efficiency\n    # Effective spring constant for the dynamics: k_eff_dyn = k_s - c^2/J\n    k_eff_dyn = k_s - c**2 / J\n    \n    # Energy is calculated using the true conservative potential\n    # U_true = 0.5 * (k_s - c^2/J) * x^2. This constant is for the energy calculation.\n    k_eff_energy_factor = 0.5 * k_eff_dyn\n\n    # Function to calculate acceleration based on the force used for dynamics\n    # a(x) = F_dyn(x)/m = (-k_eff_dyn * x - c*tau) / m\n    def get_acceleration(x, tau):\n        return (-k_eff_dyn * x - c * tau) / m\n\n    # Function to calculate the \"true\" total energy for bookkeeping\n    # E(x,v) = 0.5*m*v^2 + U_true(x)\n    def get_energy(x, v):\n        return 0.5 * m * v**2 + k_eff_energy_factor * x**2\n\n    results = []\n    for dt, tau in test_cases:\n        # Determine the number of steps and the effective simulation time\n        num_steps = int(T_total / dt)\n        if num_steps == 0:\n            # Handle cases where the time step is larger than the total time\n            results.append([0.0, True])\n            continue\n            \n        effective_T = num_steps * dt\n\n        # Initialize position, velocity, and acceleration\n        x = x0\n        v = v0\n        a = get_acceleration(x, tau)\n\n        # Calculate initial energy\n        E0 = get_energy(x, v)\n\n        # Standard velocity-Verlet integration loop\n        for _ in range(num_steps):\n            # Update position\n            x_new = x + v * dt + 0.5 * a * dt**2\n            # Compute new acceleration\n            a_new = get_acceleration(x_new, tau)\n            # Update velocity\n            v_new = v + 0.5 * (a + a_new) * dt\n            \n            # Update state for the next iteration\n            x, v, a = x_new, v_new, a_new\n\n        # Calculate final energy\n        Ef = get_energy(x, v)\n\n        # Calculate energy drift rate\n        D = (Ef - E0) / effective_T\n\n        # Determine if the drift is within the acceptable limit\n        is_acceptable = abs(D) = D_max\n\n        # Append the result for this test case\n        results.append([D, is_acceptable])\n\n    # Final print statement in the exact required format.\n    # The `str` representation for Python lists and booleans is used as per the problem's boilerplate.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}