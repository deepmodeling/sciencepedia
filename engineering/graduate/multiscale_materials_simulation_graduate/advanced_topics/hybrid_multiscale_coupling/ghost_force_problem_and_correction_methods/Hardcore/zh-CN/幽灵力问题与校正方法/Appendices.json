{
    "hands_on_practices": [
        {
            "introduction": "在本练习中，我们将通过一个最简单的一维谐振子链模型，来剖析“鬼力”的根本来源。通过人为地切断原子间的键来模拟一个简陋的原子-连续介质界面，我们将直接计算在均匀应变下产生的非物理力。这个练习揭示了鬼力的力学本质：界面处不平衡的相互作用。",
            "id": "3812134",
            "problem": "考虑一个无限长的一维原子链，其参考晶格间距为 $a>0$，原子由索引 $i\\in\\mathbb{Z}$ 标记。每对最近邻原子 $(i,i+1)$ 通过一个刚度为 $k>0$、静止长度为 $a$ 的谐振子弹簧相互作用。对于一个形变后位置为 $y_i$ 的构型，其总原子势能为\n$$\n\\mathcal{E}_{\\mathrm{atom}}(y)=\\sum_{i\\in\\mathbb{Z}}\\frac{k}{2}\\left(\\left(y_{i+1}-y_i\\right)-a\\right)^{2}.\n$$\n在一个模拟突变界面的朴素原子-连续介质耦合构造中，假设所有跨越原子 $i=0$ 和 $i=1$ 之间界面的键都被删除（即，最近邻键 $(0,1)$ 被移除），而所有其他键保持不变。不存在外力。采用准静态设置，因此力来自于势能相对于位置的梯度。\n\n现在施加一个均匀的仿射位移场 $u_i=\\epsilon\\, i\\, a$，其中 $\\epsilon\\in\\mathbb{R}$ 是一个固定的微小应变，因此形变后的构型为 $y_i=x_i+u_i=(1+\\epsilon)\\,i\\,a$，其中 $x_i=i\\,a$ 是参考位置。将内部节点力 $f_i(y)$ 定义为总能量相对于 $y_i$ 的负梯度。\n\n仅使用上述定义和标准的力学原理（力是能量的负梯度；谐振子弹簧的胡克定律），明确地构造这个反例，并计算由于断键而在界面节点 $i=0$ 处产生的精确残余内力。根据正方向力作用于正晶格方向（从较小的 $i$ 指向较大的 $i$）的约定来指定力的符号。用 $k$、$a$ 和 $\\epsilon$ 表示你的最终答案，形式为一个封闭的符号表达式。如果要指定单位，设 $k$ 的单位为牛顿/米 (N/m)，$a$ 的单位为米 (m)，并注意 $\\epsilon$ 是无量纲的，因此力的单位将是牛顿 (N)。不要代入数值。",
            "solution": "用户要求我解决一个关于在简化的一维原子模型中计算“鬼力”的问题。\n\n### 步骤1：问题验证\n\n首先，我将根据用户的指示验证问题陈述。\n\n#### 提取已知条件\n\n*   **系统**：一个无限长的一维原子链，原子由索引 $i \\in \\mathbb{Z}$ 标记。\n*   **参考构型**：参考晶格间距为 $a > 0$，参考位置为 $x_i = i a$。\n*   **势能**：对于一个完整（未切割）的链，原子势能为 $\\mathcal{E}_{\\mathrm{atom}}(y)=\\sum_{i\\in\\mathbb{Z}}\\frac{k}{2}\\left(\\left(y_{i+1}-y_i\\right)-a\\right)^{2}$。相互作用通过刚度为 $k > 0$、静止长度为 $a$ 的最近邻谐振子弹簧实现。\n*   **模型修改**：最近邻键 $(0,1)$ 被删除。所有其他键保持不变。这定义了需要计算力的系统。\n*   **力学条件**：不存在外力。系统处于准静态设置中。\n*   **位移场**：施加一个均匀仿射位移 $u_i=\\epsilon\\, i\\, a$，其中应变 $\\epsilon \\in \\mathbb{R}$ 为常数。\n*   **形变构型**：原子位置由 $y_i = x_i + u_i = (1+\\epsilon)\\,i\\,a$ 给出。\n*   **力的定义**：原子 $i$ 上的内部节点力为 $f_i(y) = -\\frac{\\partial \\mathcal{E}}{\\partial y_i}$，其中 $\\mathcal{E}$ 是修改后系统的总势能。\n*   **目标**：计算界面节点 $i=0$ 处的残余内力。\n*   **符号约定**：正方向力作用于正晶格方向（$i$ 增大的方向）。\n*   **输出格式**：答案应为关于 $k$、$a$ 和 $\\epsilon$ 的封闭形式符号表达式。\n\n#### 使用提取的已知条件进行验证\n\n1.  **科学依据**：该问题在科学上是合理的。它采用了一维晶格的标准谐波势，这是固态物理学中的一个基本模型。通过删除键来创建界面，并在均匀变形下计算由此产生的伪“鬼力”的概念，是多尺度材料模拟领域一个成熟的课题，尤其是在准连续介质（QC）方法的背景下。所使用的原理（势能，力作为能量的负梯度）是经典力学的基石。\n\n2.  **适定性**：该问题是适定的。它提供了系统势能（修改后）的完整描述、原子的具体构型，以及待计算量（原子0上的力）的精确定义。所有必要的参数（$k$，$a$，$\\epsilon$）都已定义。计算将导出一个唯一且有意义的结果。\n\n3.  **客观性**：该问题以精确、客观和数学化的语言陈述，没有任何主观或模棱两可的术语。\n\n4.  **缺陷清单**：该问题没有表现出任何列出的缺陷。它不是科学上不合理、不相关、不完整、矛盾、不切实际、不适定或琐碎的。这是一个标准的、可解的问题，旨在说明计算模型中的一个特定物理伪影。\n\n#### 结论\n\n该问题是**有效的**。我现在将继续进行解答。\n\n### 步骤2：求解推导\n\n系统的总势能 $\\mathcal{E}_{\\text{cut}}$ 由所有存在的键的总和定义。由于原子 $i=0$ 和 $i=1$ 之间的键被删除，对应于该键的项从总能量和中移除。能量为：\n$$\n\\mathcal{E}_{\\text{cut}}(y) = \\sum_{j \\in \\mathbb{Z}, j \\neq 0} \\frac{k}{2} \\left( (y_{j+1} - y_j) - a \\right)^2\n$$\n这个和可以分为两部分：一部分是切口左侧的半无限链，另一部分是切口右侧的半无限链：\n$$\n\\mathcal{E}_{\\text{cut}}(y) = \\sum_{j=-\\infty}^{-1} \\frac{k}{2} \\left( (y_{j+1} - y_j) - a \\right)^2 + \\sum_{j=1}^{\\infty} \\frac{k}{2} \\left( (y_{j+1} - y_j) - a \\right)^2\n$$\n原子 $i=0$ 上的内力定义为总势能相对于位置 $y_0$ 的负梯度：\n$$\nf_0 = -\\frac{\\partial \\mathcal{E}_{\\text{cut}}}{\\partial y_0}\n$$\n为了计算这个导数，我们必须在能量表达式 $\\mathcal{E}_{\\text{cut}}$ 中找出所有依赖于 $y_0$ 的项。检查求和式，位置 $y_0$ 仅出现在连接原子 $i=-1$ 和原子 $i=0$ 的键中。这对应于索引 $j$ 满足 $j+1=0$ 的项，即 $j=-1$。对于键 $(0,1)$ 的项，本应对应于 $j=0$ 并且也涉及 $y_0$，但已从求和中明确移除。\n\n因此，只有 $j=-1$ 的项对关于 $y_0$ 的导数有贡献：\n$$\nf_0 = -\\frac{\\partial}{\\partial y_0} \\left[ \\frac{k}{2} \\left( (y_0 - y_{-1}) - a \\right)^2 \\right]\n$$\n应用链式法则进行微分，我们得到：\n$$\nf_0 = - \\frac{k}{2} \\cdot 2 \\left( (y_0 - y_{-1}) - a \\right) \\cdot \\frac{\\partial}{\\partial y_0} \\left( y_0 - y_{-1} - a \\right)\n$$\n$$\nf_0 = -k \\left( (y_0 - y_{-1}) - a \\right) \\cdot (1)\n$$\n$$\nf_0 = -k \\left( y_0 - y_{-1} - a \\right)\n$$\n现在，我们将给定的形变位置 $y_i = (1+\\epsilon)ia$ 代入这个力表达式中。\n对于原子 $i=0$：\n$$\ny_0 = (1+\\epsilon)(0)a = 0\n$$\n对于原子 $i=-1$：\n$$\ny_{-1} = (1+\\epsilon)(-1)a = -(1+\\epsilon)a\n$$\n将这些值代回 $f_0$ 的表达式中：\n$$\nf_0 = -k \\left( 0 - (-(1+\\epsilon)a) - a \\right)\n$$\n$$\nf_0 = -k \\left( (1+\\epsilon)a - a \\right)\n$$\n$$\nf_0 = -k \\left( a + \\epsilon a - a \\right)\n$$\n$$\nf_0 = -k (\\epsilon a)\n$$\n因此，原子 $i=0$ 上残余力的最终表达式为：\n$$\nf_0 = -k a \\epsilon\n$$\n这个非零力是朴素耦合方案产生的一种伪影。在一个完美的、未切割的晶格中，在相同的均匀应变下，任何原子上的力都将为零，因为来自左右相邻键的力会完全抵消。通过切断键 $(0,1)$，我们移除了原子 $1$ 本会对原子 $0$ 施加的力，从而留下了来自原子 $-1$ 的不平衡力。对于正应变 $\\epsilon > 0$，弹簧 $(-1,0)$ 被拉伸，它会向负方向拉动原子 $0$，这与最终结果中的负号一致。",
            "answer": "$$\n\\boxed{-k a \\epsilon}\n$$"
        },
        {
            "introduction": "在理解了鬼力如何产生后，我们将视角从特定应变场提升到一个更基本的物理原理：刚体不变性。任何有效的物理模型都必须在刚体运动（如平移）下保持不变。本练习将展示，一个构造不当的耦合方案会违背这一原则，即便在无应变的纯平移下也会产生鬼力，从而揭示了数值方法中一个更深层次的误差来源。",
            "id": "3812118",
            "problem": "考虑一个一维晶体链，其参考位置为 $X_i = i a$，最近邻相互作用由刚度为 $k$ 的谐波对势描述。令 $u = \\{u_i\\}_{i=1}^{N}$ 表示位移场。纯原子能量定义为 $E^{\\text{a}}(u) = \\frac{1}{2} k \\sum_{i=1}^{N-1} (u_{i+1} - u_i)^2$，因此原子作用力通过 $F^{\\text{a}}_j(u) = -\\frac{\\partial E^{\\text{a}}}{\\partial u_j}$ 获得。在原子-连续介质（A/C）耦合中，力算符在一个依赖于节点的线性离散算符的界面集 $\\mathcal{I} \\subset \\{2,\\dots,N-1\\}$ 中被修改，\n$$\nF^{\\text{couple}}_j(u) = k \\left( a_j u_j - b_j u_{j-1} - c_j u_{j+1} \\right), \\quad j \\in \\mathcal{I},\n$$\n而在 $\\mathcal{I}$ 之外，保留原子算符 $F^{\\text{a}}_j(u)$。假设由于与 Cauchy–Born 有限元代理模型混合，系数 $a_j$、$b_j$ 和 $c_j$ 是正的，并且在 $\\mathcal{I}$ 上随 $j$ 平滑变化。\n\n从基本原理出发，即刚体平移使物理能量保持不变，并且在 $u_i = \\alpha$（对于任何常数 $\\alpha$）（刚体不变性）下，力必须为零，推导系数 $a_j$、$b_j$ 和 $c_j$ 必须满足的充分必要条件，使得对于所有 $j \\in \\mathcal{I}$ 和所有 $\\alpha \\in \\mathbb{R}$，都有 $F_j^{\\text{couple}}(\\alpha \\mathbf{1}) = 0$，其中 $\\mathbf{1}$ 表示全一向量。然后，考虑一个特定的界面节点 $j^{\\star} \\in \\mathcal{I}$，其系数为 $a_{j^{\\star}} = 2.05$，$b_{j^{\\star}} = 1.00$，$c_{j^{\\star}} = 1.00$，刚度 $k = 100$ in $\\text{N}/\\text{m}$，以及均匀平移 $u_i = \\alpha$，其中 $\\alpha = 1.0 \\times 10^{-2}$ in $\\text{m}$。计算由于违反刚体不变性而在 $j^{\\star}$ 处产生的鬼力 $F_{j^{\\star}}^{\\text{ghost}}$，并以 $\\text{N}$ 为单位表示结果。将你的答案四舍五入到四位有效数字。",
            "solution": "用户希望我解决一个关于原子-连续介质耦合中鬼力的问题。\n\n**第一部分：问题验证**\n\n首先，我必须验证问题陈述。\n\n**第一步：提取已知条件**\n- **系统：** 一个一维晶体链，其参考位置为 $X_i = i a$。\n- **相互作用：** 刚度为 $k$ 的最近邻谐波对势。\n- **位移场：** $u = \\{u_i\\}_{i=1}^{N}$。\n- **原子能量：** $E^{\\text{a}}(u) = \\frac{1}{2} k \\sum_{i=1}^{N-1} (u_{i+1} - u_i)^2$。\n- **原子作用力定义：** $F^{\\text{a}}_j(u) = -\\frac{\\partial E^{\\text{a}}}{\\partial u_j}$。\n- **界面集：** $\\mathcal{I} \\subset \\{2,\\dots,N-1\\}$。\n- **耦合力算符：** 对于 $j \\in \\mathcal{I}$，$F^{\\text{couple}}_j(u) = k \\left( a_j u_j - b_j u_{j-1} - c_j u_{j+1} \\right)$。\n- **界面外的力：** 对于 $j \\notin \\mathcal{I}$，力为 $F^{\\text{a}}_j(u)$。\n- **系数属性：** $a_j$、$b_j$ 和 $c_j$ 是正的，并且在 $\\mathcal{I}$ 上随 $j$ 平滑变化。\n- **支配原理：** 刚体不变性要求对于恒定位移场 $u_i = \\alpha$（对于任何常数 $\\alpha$），力为零。这表示为 $F_j(\\alpha \\mathbf{1}) = 0$。\n- **任务1：** 推导系数 $a_j$、$b_j$、$c_j$ 必须满足的充分必要条件，使得对于所有 $j \\in \\mathcal{I}$ 和所有 $\\alpha \\in \\mathbb{R}$，都有 $F_j^{\\text{couple}}(\\alpha \\mathbf{1}) = 0$。\n- **特定节点数据：** 在节点 $j^{\\star} \\in \\mathcal{I}$，系数为 $a_{j^{\\star}} = 2.05$，$b_{j^{\\star}} = 1.00$，$c_{j^{\\star}} = 1.00$。\n- **特定参数：** 刚度 $k = 100 \\text{ N/m}$ 和均匀平移 $\\alpha = 1.0 \\times 10^{-2} \\text{ m}$。\n- **任务2：** 计算在 $j^{\\star}$ 处的鬼力 $F_{j^{\\star}}^{\\text{ghost}}$ 并将结果四舍五入到四位有效数字。\n\n**第二步：使用提取的已知条件进行验证**\n该问题在计算材料科学领域，特别是在多尺度建模方面，具有科学依据。在原子-连续介质耦合方案中，因违反刚体不变性（也称为“斑图检验”）而产生鬼力的概念是一个标准且关键的课题。数学模型，即一维谐波链，是用于阐释基本原理的常用且合适的模型系统。该问题提法严谨、客观且自洽，为推导和后续计算提供了所有必要的定义和数据。没有矛盾、歧义或依赖伪科学之处。该问题直接针对一个核心概念，既不琐碎也不人为复杂。\n\n**第三步：结论与行动**\n问题有效。我将继续进行解答。\n\n**第二部分：解答**\n\n问题的第一个部分要求推导确保刚体不变性的系数 $a_j$、$b_j$ 和 $c_j$ 所需的条件。刚体不变性原理指出，整个系统的均匀平移不应引起任何内力。在数学上，这意味着当位移场为常数，即对于所有 $i$ 都有 $u_i = \\alpha$（其中 $\\alpha$ 是任意常数）时，任何原子 $j$ 上的力必须为零。\n\n对于一个节点 $j \\in \\mathcal{I}$，力由耦合算符给出：\n$$\nF^{\\text{couple}}_j(u) = k \\left( a_j u_j - b_j u_{j-1} - c_j u_{j+1} \\right)\n$$\n我们通过将 $u_{j-1} = \\alpha$、$u_j = \\alpha$ 和 $u_{j+1} = \\alpha$ 代入此表达式来应用刚体不变性条件。在此条件下，我们记为 $F_j^{\\text{couple}}(\\alpha \\mathbf{1})$ 的力必须为零。\n$$\nF_j^{\\text{couple}}(\\alpha \\mathbf{1}) = k \\left( a_j (\\alpha) - b_j (\\alpha) - c_j (\\alpha) \\right)\n$$\n将常数位移 $\\alpha$ 因子提出，我们得到：\n$$\nF_j^{\\text{couple}}(\\alpha \\mathbf{1}) = k \\alpha (a_j - b_j - c_j)\n$$\n为使此力对于任意常数位移 $\\alpha \\in \\mathbb{R}$ 和非零刚度 $k > 0$ 均为零，括号中的项必须恒为零。因此，系数的充分必要条件是：\n$$\na_j - b_j - c_j = 0 \\quad \\text{或} \\quad a_j = b_j + c_j\n$$\n这个条件是一阶一致性要求的一个具体实例，它确保数值方案能够精确地再现恒定位移场，而不会产生伪力。\n\n问题的第二部分要求计算在违反此条件的特定界面节点 $j^{\\star}$ 处的“鬼力”。鬼力是当一个基本的一致性条件（如刚体不变性）未被满足时，由数值方案产生的非零、非物理的力。它正是在方案未能通过此测试时，为均匀平移计算出的力。\n\n节点 $j^{\\star}$ 的给定数据如下：\n- $a_{j^{\\star}} = 2.05$\n- $b_{j^{\\star}} = 1.00$\n- $c_{j^{\\star}} = 1.00$\n- $k = 100 \\text{ N/m}$\n- $\\alpha = 1.0 \\times 10^{-2} \\text{ m}$\n\n首先，我们检查不变性条件在 $j^{\\star}$ 处是否满足：\n$$\na_{j^{\\star}} \\stackrel{?}{=} b_{j^{\\star}} + c_{j^{\\star}}\n$$\n$$\n2.05 \\neq 1.00 + 1.00 = 2.00\n$$\n由于条件不满足，在均匀平移 $u_i = \\alpha$ 下会产生一个非零的鬼力。鬼力 $F_{j^{\\star}}^{\\text{ghost}}$ 使用恒定位移的一般力表达式计算：\n$$\nF_{j^{\\star}}^{\\text{ghost}} = k \\alpha (a_{j^{\\star}} - b_{j^{\\star}} - c_{j^{\\star}})\n$$\n代入给定的数值：\n$$\nF_{j^{\\star}}^{\\text{ghost}} = (100 \\text{ N/m}) \\times (1.0 \\times 10^{-2} \\text{ m}) \\times (2.05 - 1.00 - 1.00)\n$$\n$$\nF_{j^{\\star}}^{\\text{ghost}} = (1 \\text{ N}) \\times (2.05 - 2.00)\n$$\n$$\nF_{j^{\\star}}^{\\text{ghost}} = (1 \\text{ N}) \\times (0.05)\n$$\n$$\nF_{j^{\\star}}^{\\text{ghost}} = 0.05 \\text{ N}\n$$\n问题要求答案四舍五入到四位有效数字。计算值 $0.05$ 可以写成 $5.000 \\times 10^{-2}$，因此用四位有效数字表示为 $0.05000$。",
            "answer": "$$\n\\boxed{0.05000}\n$$"
        },
        {
            "introduction": "最后的练习将我们从一维解析模型带入更接近实际的二维数值模拟中。我们将学习如何设计和实施“膜片检验”（patch test），这是一种验证多尺度耦合方案一致性的标准程序。通过在一个二维三角晶格上比较产生鬼力的朴素方法和消除鬼力的修正方法，本练习让我们能够用实际的量化指标来评估和验证耦合模型的正确性。",
            "id": "3812139",
            "problem": "考虑一个二维三角布拉维格子，其原胞矢量为 $d_1 = (a,0)$ 和 $d_2 = \\left(\\frac{a}{2}, \\frac{\\sqrt{3}a}{2}\\right)$。格点由整数对 $(i,j)$ 索引，其位置为 $x_{i,j} = i\\,d_1 + j\\,d_2$。每个原子通过中心对势 $\\phi(r) = \\frac{k}{2}(r - a)^2$ 与其六个最近邻相互作用，其中 $r$ 是形变键长，$a$ 是参考键长，$k$ 是刚度。一个均匀形变 $F \\in \\mathbb{R}^{2 \\times 2}$ 将参考键矢量 $b$ 映射为形变键矢量 $v = F\\,b$。在形变 $F$ 下，沿着一个键传递的力是中心力 $f(F,b) = k\\left(\\lVert F\\,b \\rVert - a\\right)\\frac{F\\,b}{\\lVert F\\,b \\rVert}$，该力作用于原点原子，方向指向其形变后的邻居。\n\n将格子索引空间中的六个最近邻偏移量定义为 $\\Delta = \\{(1,0),(0,1),(-1,1),(-1,0),(0,-1),(1,-1)\\}$，对应于参考键矢量 $b(\\delta) = \\delta_1\\,d_1 + \\delta_2\\,d_2$，其中 $\\delta = (\\delta_1,\\delta_2) \\in \\Delta$。\n\n我们在一个具有 $N_x$ 列和 $N_y$ 行的有限矩形格子上设计一个准连续介质 (QC) 耦合，其中 $j$ 方向为周期性边界条件，$i$ 方向为自由边界。令原子区域 $\\mathcal{A}$ 由索引条件 $i < I$ 定义，连续介质区域 $\\mathcal{C}$ 由 $i \\ge I$ 定义，其中 $I$ 是一个整数界面索引，满足 $1 \\le I \\le N_x - 1$。我们考虑两种 QC 耦合变体：\n\n1. 朴素的基于能量的混合 (类 QCE)：将连接区域 $\\mathcal{A}$ 中的原子与区域 $\\mathcal{C}$ 中的原子的键去除。也就是说，对于任何原子 $(i,j) \\in \\mathcal{A}$ 和邻居偏移量 $\\delta \\in \\Delta$，如果 $(i+\\delta_1,j+\\delta_2) \\in \\mathcal{C}$，则键力贡献 $f(F,b(\\delta))$ 被省略。\n\n2. 元检验一致性修正：对于每个从 $\\mathcal{A}$ 跨越到 $\\mathcal{C}$ 的被去除的键，一个等于 $f(F,b(\\delta))$ 的外部修正力被施加到原子 $(i,j) \\in \\mathcal{A}$ 上。在均匀形变 $F$ 下，这模拟了来自 $\\mathcal{C}$ 的柯西-玻恩牵引，并恢复了力平衡。\n\n定义原子 $(i,j)$ 处的节点残差为 $R_{i,j} = \\sum_{\\delta \\in \\Delta} \\mathcal{W}_{i,j}(\\delta)$，其中如果 $(i+\\delta_1,j+\\delta_2) \\in \\mathcal{A}$，则 $\\mathcal{W}_{i,j}(\\delta)$ 等于 $f(F,b(\\delta))$；如果邻居索引 $(i+\\delta_1)$ 超出 $[0,N_x-1]$ 的范围，则等于 $0$；对于跨入 $\\mathcal{C}$ 的键，在朴素混合变体中等于 $0$，或在元检验一致性修正变体中等于 $f(F,b(\\delta))$。残差仅针对 $i = I - 1$ (与界面相邻的原子列) 的原子 $(i,j) \\in \\mathcal{A}$ 进行评估，并且周期性意味着索引 $j+\\delta_2$ 应取模 $N_y$。\n\n将在均匀形变 $F$ 下，朴素混合变体的界面牵引力跳跃定义为单位界面长度上的净缺失牵引力的大小。令 $\\mathcal{B}_{\\mathrm{cut}}$ 为从 $i=I-1$ 的原子 $(i,j) \\in \\mathcal{A}$ 跨越到 $\\mathcal{C}$ 中邻居的键的集合。那么牵引力跳跃为\n$$\nT = \\frac{\\left\\lVert \\sum_{(i,j)\\in \\mathcal{A},\\, i=I-1}\\; \\sum_{\\delta \\in \\Delta:\\, i+\\delta_1 \\ge I} f(F,b(\\delta)) \\right\\rVert}{L_{\\mathrm{int}}},\n$$\n其中 $L_{\\mathrm{int}} = N_y\\,\\lVert d_2 \\rVert$ 是平行于 $d_2$ 的界面段的物理长度。对于元检验一致性修正，根据构造 $T=0$；对于纯原子格子（无连续介质区域），$T=0$ 且在均匀形变 $F$ 下所有残差都消失。\n\n本问题中的所有量都是无量纲的。您的任务是为此设置实现一个数值元检验，并为每个测试案例计算两个可观察的指标：\n- 界面相邻原子列中原子的最大节点残差大小，即 $\\max_{j} \\lVert R_{I-1,j} \\rVert$。\n- 如上定义的界面牵引力跳跃大小 $T$。\n\n从牛顿定律和中心力相互作用开始推导，并利用 $F$ 的均匀性和格子对称性来论证纯原子和修正后的 QC 情况下的预期行为。\n\n您的程序应评估以下参数 $(N_x,N_y,I,k,a,F,\\text{mode})$ 测试套件的指标，其中 $\\text{mode} \\in \\{\\text{atomistic},\\text{naive},\\text{corrected}\\}$：\n\n- 测试 1 (正常情况，纯原子): $(20,20,10,1.0,1.0,F=\\begin{pmatrix}1.05 & 0\\\\0 & 1.05\\end{pmatrix},\\text{atomistic})$。\n- 测试 2 (存在鬼力，各向同性拉伸下的朴素混合): $(20,20,10,1.0,1.0,F=\\begin{pmatrix}1.05 & 0\\\\0 & 1.05\\end{pmatrix},\\text{naive})$。\n- 测试 3 (鬼力已修正，各向同性拉伸): $(20,20,10,1.0,1.0,F=\\begin{pmatrix}1.05 & 0\\\\0 & 1.05\\end{pmatrix},\\text{corrected})$。\n- 测试 4 (边界情况，单位形变): $(20,20,10,1.0,1.0,F=\\begin{pmatrix}1 & 0\\\\0 & 1\\end{pmatrix},\\text{naive})$。\n- 测试 5 (剪切形变，存在鬼力): $(30,12,15,1.0,1.0,F=\\begin{pmatrix}1 & 0.1\\\\0 & 1\\end{pmatrix},\\text{naive})$。\n- 测试 6 (剪切形变，鬼力已修正): $(30,12,15,1.0,1.0,F=\\begin{pmatrix}1 & 0.1\\\\0 & 1\\end{pmatrix},\\text{corrected})$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，顺序为 $[\\text{res}_1,\\text{trac}_1,\\text{res}_2,\\text{trac}_2,\\dots,\\text{res}_6,\\text{trac}_6]$，其中 $\\text{res}_t$ 是测试 $t$ 的最大节点残差大小，$\\text{trac}_t$ 是测试 $t$ 的牵引力跳跃大小，每个都表示为浮点数。",
            "solution": "该问题要求为一个在均匀形变下的二维三角格子的准连续介质 (QC) 模型计算两个指标——最大节点残差和界面牵引力跳跃。分析针对三种耦合变体进行：全原子模型、朴素的基于能量的 QC 耦合以及元检验一致性修正的 QC 耦合。\n\n### 1. 基本原理：平衡与中心力\n\n根据牛顿第一定律，一个物体要处于静力平衡状态，作用在其任何组成粒子上的合力必须为零。在我们的格子系统中，每个由 $\\alpha$ 索引的原子通过中心对力 $f_{\\alpha\\beta}$ 与其邻居 $\\beta$ 相互作用。作用在原子 $\\alpha$ 上的总力是其所有邻居力的矢量和：\n$$\nF_{\\alpha} = \\sum_{\\beta} f_{\\alpha\\beta}\n$$\n对于静态构型，或处于匀速运动（包括均匀形变）的构型，对于不受外部体力作用的每个原子 $\\alpha$，这个合力 $F_{\\alpha}$ 必须为零。\n\n在一个均匀形变梯度 $F$ 下，一个邻居（其参考位置由键矢量 $b$ 描述）施加在原点原子上的力由以下公式给出：\n$$\nf(F,b) = k\\left(\\lVert F\\,b \\rVert - a\\right)\\frac{F\\,b}{\\lVert F\\,b \\rVert}\n$$\n这里，$k$ 是键刚度，$a$ 是参考键长（等于参考构型中的最近邻距离），$F\\,b$ 是形变后的键矢量。\n\n### 2. 元检验与完美晶格\n\n任何多尺度方法的一个基本一致性检验是“元检验”。它断言，如果整个系统承受的形变状态可以被粗粒化（连续介质）模型精确表示，那么耦合方法必须无误地再现此状态。对于原子-连续介质耦合，最简单的此类状态是均匀形变 $F$。\n\n在一个承受均匀形变 $F$ 的完美无限晶格中，原子位置根据连续介质形变进行映射，这一概念被称为柯西-玻恩法则。作用在任何原子上的净力是来自其所有邻居的力之和：\n$$\nF_{total} = \\sum_{\\delta \\in \\Delta} f(F, b(\\delta))\n$$\n其中 $\\Delta$ 是六个最近邻的索引偏移量集合。对于三角格子，参考键矢量集合 $\\{b(\\delta) | \\delta \\in \\Delta\\}$ 是中心对称的。这意味着对于集合中的每个键矢量 $b$，其负矢量 $-b$ 也在集合中。具体来说，邻居以三个相反的对出现：$(\\delta_1,\\delta_2)$ 和 $(-\\delta_1,-\\delta_2)$。例如，$\\delta=(1,0)$ 与 $\\delta=(-1,0)$ 配对。力函数具有性质 $f(F,-b) = -f(F,b)$，因为 $\\lVert F(-b) \\rVert = \\lVert F b \\rVert$。因此，在一个中心对称邻域上的力之和为零：\n$$\nF_{total} = \\sum_{k=1}^{3} \\left[ f(F, b_k) + f(F, -b_k) \\right] = \\sum_{k=1}^{3} \\left[ f(F, b_k) - f(F, b_k) \\right] = 0\n$$\n因此，在一个完全`atomistic`（原子）的计算域中，任何远离自由边界的原子（“内部”原子）都受到零净力作用，其节点残差为零。这轻松地通过了元检验。\n\n### 3. 准连续介质界面与鬼力\n\nQC 方法将系统划分为原子区域 $\\mathcal{A}$ 和连续介质区域 $\\mathcal{C}$。`naive`（朴素的，类 QCE）耦合方案通过简单地丢弃从 $\\mathcal{A}$ 中的原子到 $\\mathcal{C}$ 中邻居的相互作用（键）来处理界面。\n\n考虑一个位于界面边界上的原子 $(i,j)$，其 $i=I-1$。它的邻域不再完整；力的总和仅对同样在 $\\mathcal{A}$ 中的邻居（或在物理域之外，贡献零力）进行。\n$$\nR_{i,j} = \\sum_{\\delta: (i+\\delta_1, j+\\delta_2) \\in \\mathcal{A}} f(F, b(\\delta))\n$$\n由于求和现在是针对一个不完整的、非中心对称的邻居集合，所以总和通常不为零。这个非零的节点残差 $R_{i,j}$ 是不一致耦合方案的一种伪影，被称为“鬼力”。它表示界面处力学平衡的破坏，并表明朴素方法未能通过元检验。\n\n`界面牵引力跳跃` $T$ 量化了这种不一致性的大小。它是所有被丢弃键的合力，并由界面长度 $L_{\\mathrm{int}} = N_y \\lVert d_2 \\rVert = N_y a$ 进行归一化。\n$$\nT = \\frac{\\left\\lVert \\sum_{\\text{cut bonds}} f(F,b(\\delta)) \\right\\rVert}{L_{\\mathrm{int}}}\n$$\n界面原子上的鬼力之和恰好是被切断键的力之和的负值，因为所有键（切断和未切断）的总力必须为零。\n\n### 4. 元检验一致性修正\n\n`corrected`（修正的）QC 方案解决了鬼力问题。对于`naive`方案中从 $\\mathcal{A}$ 中的原子到 $\\mathcal{C}$ 中邻居的每个被移除的键，一个等于该键本应承载的力 $f(F,b(\\delta))$ 的外力被施加到 $\\mathcal{A}$ 中的原子上。这个修正力精确地模拟了连续介质区域根据柯西-玻恩法则应施加在原子区域上的牵引力。\n\n通过此修正，界面原子的节点残差 $(i,j)$变为：\n$$\nR_{i,j} = \\left( \\sum_{\\delta: \\text{neighbor in } \\mathcal{A}} f(F, b(\\delta)) \\right) + \\left( \\sum_{\\delta: \\text{neighbor in } \\mathcal{C}} f(F, b(\\delta)) \\right) = \\sum_{\\delta \\in \\Delta} f(F, b(\\delta)) = 0\n$$\n力平衡被完美恢复，鬼力被消除，节点残差为零，`corrected` 方法通过了元检验。根据构造，`traction jump`（牵引力跳跃） $T$ 也为零。\n\n### 5. 算法设计\n\n数值实现通过直接应用定义来进行。对于每个测试案例，我们设置参数 $(N_x, N_y, I, k, a, F, \\text{mode})$。由于形变的均匀性和 $j$ 方向的周期性，对于所有界面原子 $j \\in [0, N_y-1]$，节点残差 $R_{I-1,j}$ 和缺失键力的集合是相同的。这就带来了显著的简化：我们可以为单个代表性原子（例如，在 $j=0$ 处）计算残差和缺失力，并将牵引力跳跃的结果乘以 $N_y$ 进行缩放。\n\n单个测试案例的算法如下：\n1.  将节点残差矢量和每个原子的缺失力矢量初始化为零。\n2.  定义原胞矢量 $d_1, d_2$ 并构造六个最近邻参考键矢量集合 $\\{b(\\delta)\\}$。\n3.  遍历六个邻居偏移量 $\\delta \\in \\Delta$ 中的每一个。\n    a. 计算在给定形变 $F$ 下该键将承载的力矢量 $f(F,b(\\delta))$。\n    b. 确定邻居原子相对于界面索引 $I$ 的位置。\n    c. 应用与模拟`mode`（`atomistic`、`naive`或`corrected`）相对应的逻辑，以确定要加到节点残差上的力贡献。\n    d. 对于`naive`模式，如果一个键被切断（即其力贡献被设置为零），则将计算出的力矢量 $f(F,b(\\delta))$ 添加到每个原子的缺失力累加器中。\n4.  遍历完所有六个邻居后，最终节点残差矢量的大小是第一个指标。\n5.  对于`naive`模式，第二个指标，即牵引力跳跃 $T$，计算为每个原子的缺失力矢量的大小除以参考键长 $a$。对于`atomistic`和`corrected`模式，$T$为零。\n\n对每个测试案例执行此过程以生成所需的输出。对于`atomistic`和`corrected`模式，计算出的残差应为零（或在机器精度范围内），从而验证了理论分析。",
            "answer": "$$[0.000000000000, 0.000000000000, 0.052500000000, 0.052500000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.000000000000, 0.007469032746, 0.007469032746, 0.000000000000, 0.000000000000]$$"
        }
    ]
}