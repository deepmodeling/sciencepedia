{
    "hands_on_practices": [
        {
            "introduction": "The Bridging Domain Method (BDM) is fundamentally an energy-based coupling scheme, meaning its accuracy hinges on the correct formulation of the total system energy. A foundational principle in this formulation is the use of weighting functions that form a \"partition of unity,\" ensuring that energy is neither artificially created nor destroyed in the overlap region. This first exercise provides a direct, quantitative look at why this condition is non-negotiable by exploring a case where it is violated . By calculating the energy error that arises from improper weight normalization, you will gain a concrete understanding of how deviations from the partition of unity lead to unphysical results.",
            "id": "3844843",
            "problem": "A uniform, prismatic, linear elastic bar of length $L$, cross-sectional area $A$, and Young’s modulus $E$ is subjected to a constant axial end load $F$ resulting in a uniform small strain along its length. In a multiscale coupling using the Bridging Domain Method (BDM), an atomistic description (A) and a continuum description (C) overlap over a subinterval (the bridging domain) of length $\\ell$, with $\\ell \\leq L$. In the bridging domain, the coupled energy is formed by blending the atomistic and continuum energies using spatially varying weights $w_{A}(x)$ and $w_{C}(x)$. In a consistent BDM formulation, the weights should satisfy $w_{A}(x)+w_{C}(x)=1$ for all $x$ in the overlap in order to avoid bias. Consider, instead, an improperly normalized pair satisfying $w_{A}(x)+w_{C}(x)=1+\\delta(x)$, where $\\delta(x)$ is a prescribed function on the overlap, and assume that the atomistic and continuum descriptions produce identical energy densities for this problem.\n\nStarting only from small-strain linear elasticity and the definition of strain energy density, derive an expression for the total energy error $\\Delta U$ caused by the improper normalization, defined as the difference between the BDM-blended total strain energy and the true single-model strain energy. Express your result in terms of $F$, $E$, $A$, and $\\delta(x)$, and specialize it to the case of a constant mis-normalization $\\delta(x)\\equiv \\delta$ over the overlap of length $\\ell$.\n\nThen, evaluate the specialized expression for the following data: $E=200\\times 10^{9}$ Pa, $A=1.0\\times 10^{-4}$ m$^{2}$, $\\ell=0.10$ m, $F=1.0\\times 10^{4}$ N, and $\\delta=0.050$. Round your final numerical answer to four significant figures. Express the final energy error in joules.",
            "solution": "The problem requires the derivation of the total energy error introduced in a Bridging Domain Method (BDM) formulation due to an improper normalization of the blending weights. The physical system is a uniform linear elastic bar under constant axial tension. To solve this, we first establish the benchmark, which is the true strain energy of the bar. Then, we formulate the energy within the BDM-blended model and find the difference.\n\nFirst, let us define the state of the bar under the given load. The bar has a Young's modulus $E$, a cross-sectional area $A$, and is subjected to a constant axial force $F$. According to linear elasticity, the axial stress $\\sigma$ is uniform and given by:\n$$ \\sigma = \\frac{F}{A} $$\nThe axial strain $\\epsilon$ is also uniform and is related to the stress by Hooke's law:\n$$ \\epsilon = \\frac{\\sigma}{E} = \\frac{F}{EA} $$\nThe strain energy density $u$, which is the strain energy per unit volume, for a linear elastic material is:\n$$ u = \\frac{1}{2} \\sigma \\epsilon $$\nSubstituting the expressions for $\\sigma$ and $\\epsilon$, we obtain the strain energy density in terms of the given parameters:\n$$ u = \\frac{1}{2} \\left(\\frac{F}{A}\\right) \\left(\\frac{F}{EA}\\right) = \\frac{F^2}{2EA^2} $$\nSince the bar is uniform and the loading is constant, this energy density $u$ is constant throughout the entire volume of the bar. The total true strain energy $U_{true}$ is the integral of this density over the total volume $V = A L$.\n$$ U_{true} = \\int_V u \\, dV = u \\cdot V = \\left(\\frac{F^2}{2EA^2}\\right) (A L) = \\frac{F^2 L}{2EA} $$\nThis expression represents the correct, single-model strain energy of the system.\n\nNext, we formulate the total energy within the BDM framework with the specified improper normalization. The bar is divided into regions. A portion of the bar, of length $\\ell$, is the bridging domain where atomistic (A) and continuum (C) models are blended. The remainder of the bar, of length $L-\\ell$, is modeled using a single description (e.g., continuum).\n\nThe problem states that the atomistic and continuum descriptions produce identical energy densities for this problem. This means $u_A(x) = u_C(x) = u$, where $u$ is the constant energy density derived previously.\n\nOutside the bridging domain (a region of total length $L-\\ell$), the energy density is simply $u$. The energy stored in this part of the bar, $U_{out}$, is:\n$$ U_{out} = u \\cdot A (L-\\ell) $$\nInside the bridging domain (length $\\ell$), the energy density is blended using the weights $w_A(x)$ and $w_C(x)$. The blended energy density, $u_{BDM}(x)$, is:\n$$ u_{BDM}(x) = w_A(x) u_A(x) + w_C(x) u_C(x) = (w_A(x) + w_C(x)) u $$\nWe are given that the weights are improperly normalized, such that $w_A(x) + w_C(x) = 1 + \\delta(x)$. Thus, the energy density in the bridging domain is:\n$$ u_{BDM}(x) = (1 + \\delta(x)) u $$\nThe total energy stored in the bridging domain, $U_{bridge}$, is the integral of this blended energy density over the volume of the bridging domain. Let the bridging domain extend from $x=x_0$ to $x=x_0+\\ell$.\n$$ U_{bridge} = \\int_{x_0}^{x_0+\\ell} u_{BDM}(x) A \\, dx = \\int_{x_0}^{x_0+\\ell} (1 + \\delta(x)) u A \\, dx $$\nSince $u$ and $A$ are constants, we can write:\n$$ U_{bridge} = u A \\int_{x_0}^{x_0+\\ell} (1 + \\delta(x)) \\, dx = u A \\left( \\ell + \\int_{x_0}^{x_0+\\ell} \\delta(x) \\, dx \\right) $$\nThe total energy in the BDM model, $U_{BDM}$, is the sum of the energies from the regions inside and outside the bridging domain:\n$$ U_{BDM} = U_{out} + U_{bridge} = u A (L-\\ell) + u A \\left( \\ell + \\int_{x_0}^{x_0+\\ell} \\delta(x) \\, dx \\right) $$\n$$ U_{BDM} = u A \\left( L - \\ell + \\ell + \\int_{x_0}^{x_0+\\ell} \\delta(x) \\, dx \\right) = u A \\left( L + \\int_{overlap} \\delta(x) \\, dx \\right) $$\nSubstituting the expression for $u = \\frac{F^2}{2EA^2}$:\n$$ U_{BDM} = \\frac{F^2}{2EA^2} A \\left( L + \\int_{overlap} \\delta(x) \\, dx \\right) = \\frac{F^2}{2EA} \\left( L + \\int_{overlap} \\delta(x) \\, dx \\right) $$\n\nThe total energy error $\\Delta U$ is defined as the difference between the BDM-blended energy and the true energy:\n$$ \\Delta U = U_{BDM} - U_{true} = \\frac{F^2}{2EA} \\left( L + \\int_{overlap} \\delta(x) \\, dx \\right) - \\frac{F^2 L}{2EA} $$\n$$ \\Delta U = \\frac{F^2 L}{2EA} + \\frac{F^2}{2EA} \\int_{overlap} \\delta(x) \\, dx - \\frac{F^2 L}{2EA} $$\nThis simplifies to the general expression for the energy error:\n$$ \\Delta U = \\frac{F^2}{2EA} \\int_{overlap} \\delta(x) \\, dx $$\n\nNow, we specialize this result to the case where the mis-normalization is a constant, $\\delta(x) \\equiv \\delta$, over the entire overlap region of length $\\ell$. The integral becomes:\n$$ \\int_{overlap} \\delta(x) \\, dx = \\int_{x_0}^{x_0+\\ell} \\delta \\, dx = \\delta \\int_{x_0}^{x_0+\\ell} dx = \\delta \\ell $$\nSubstituting this into the general error expression gives the specialized expression for the error:\n$$ \\Delta U = \\frac{F^2 \\delta \\ell}{2EA} $$\n\nFinally, we evaluate this expression using the provided numerical data:\n$E = 200 \\times 10^{9}$ Pa\n$A = 1.0 \\times 10^{-4}$ m$^2$\n$\\ell = 0.10$ m\n$F = 1.0 \\times 10^{4}$ N\n$\\delta = 0.050$\n\nWe substitute these values into the specialized error formula:\n$$ \\Delta U = \\frac{(1.0 \\times 10^{4} \\, \\text{N})^2 (0.050) (0.10 \\, \\text{m})}{2 (200 \\times 10^{9} \\, \\text{Pa}) (1.0 \\times 10^{-4} \\, \\text{m}^2)} $$\n$$ \\Delta U = \\frac{(1.0 \\times 10^{8} \\, \\text{N}^2) (0.0050 \\, \\text{m})}{2 (2.0 \\times 10^{11} \\, \\text{N/m}^2) (1.0 \\times 10^{-4} \\, \\text{m}^2)} $$\n$$ \\Delta U = \\frac{5.0 \\times 10^{5} \\, \\text{N}^2 \\cdot \\text{m}}{4.0 \\times 10^{7} \\, \\text{N}} = 1.25 \\times 10^{-2} \\, \\text{N} \\cdot \\text{m} $$\nSince 1 joule (J) is equal to 1 newton-meter (N·m), the energy error is:\n$$ \\Delta U = 0.0125 \\, \\text{J} $$\nRounding to four significant figures as requested, the final answer is $0.01250$ J.",
            "answer": "$$\\boxed{0.01250}$$"
        },
        {
            "introduction": "Before coupling two different physical descriptions, it is essential to verify that they are consistent with each other in the limit of simple, uniform deformations. This is the essence of the \"patch test,\" a cornerstone of validation in computational mechanics. This practice problem tasks you with verifying this consistency at the level of stress for a BDM model . You will derive the stress tensor from both the atomistic description using the virial theorem and the continuum description using the Cauchy-Born rule, demonstrating that for a compatible model, these two distinct calculations yield the exact same result.",
            "id": "3816103",
            "problem": "Consider a two-dimensional bridging domain $\\Omega_b$ used to couple an atomistic model to a continuum model under the Bridging Domain Method. The atomistic subsystem in $\\Omega_b$ consists of a square Bravais lattice of reference spacing $a_0$, with atoms interacting only via nearest-neighbor central forces derived from the pair potential $\\varphi(r)$, where $\\varphi(r) = \\frac{k}{2}(r - a_0)^2$ and $k > 0$ is a stiffness parameter. The continuum subsystem in $\\Omega_b$ is represented by a single Finite Element (FE) using the Cauchy–Born rule to construct a hyperelastic energy density from the same underlying atomistic interaction.\n\nAssume the body undergoes a homogeneous deformation characterized by the deformation gradient $F = \\mathrm{diag}(\\lambda_1, \\lambda_2)$, with principal stretches $\\lambda_1 > 0$ and $\\lambda_2 > 0$, and determinant $J = \\det F = \\lambda_1 \\lambda_2$. The current area of $\\Omega_b$ is $A_b = J A_{b0}$, where $A_{b0}$ is the reference area. The system is quasi-static and isothermal, with zero velocities, so the kinetic contribution to the virial stress vanishes. Neglect boundary effects so that the local environment of each atom in $\\Omega_b$ is representative of the bulk.\n\nStarting only from fundamental definitions appropriate to multiscale modeling, do the following:\n\n- Use the Irving–Kirkwood virial definition of the Cauchy stress for static systems, namely that the Cauchy stress $\\boldsymbol{\\sigma}^{\\mathrm{vir}}$ equals the configurational (potential) contribution computed from pairwise forces in the current configuration, to derive the Cauchy stress inside $\\Omega_b$ due to the given homogeneous $F$. Treat the sum over unique nearest-neighbor pairs and divide by the current area.\n\n- Using the Cauchy–Born rule, construct the hyperelastic energy density $W(F)$ per reference area by summing the pair potential over the unique nearest-neighbor bonds in the square lattice. From $W(F)$, derive the first Piola–Kirchhoff stress $\\boldsymbol{P}$ and then the continuum Cauchy stress $\\boldsymbol{\\sigma}^{\\mathrm{FE}}$ via the standard hyperelastic relation $\\boldsymbol{\\sigma}^{\\mathrm{FE}} = \\frac{1}{J}\\boldsymbol{P} F^{\\mathsf{T}}$.\n\nLet $\\Delta$ denote the Frobenius-norm difference between the virial and continuum Cauchy stresses,\n$$\n\\Delta = \\left\\| \\boldsymbol{\\sigma}^{\\mathrm{vir}} - \\boldsymbol{\\sigma}^{\\mathrm{FE}} \\right\\|_{F}.\n$$\nCompute $\\Delta$ exactly for the given lattice, potential, and homogeneous deformation. Express your final answer for $\\Delta$ in Newton per meter (N/m). If your final result is nonzero and requires approximation, round to four significant figures; otherwise, report the exact value.",
            "solution": "The goal is to show consistency between the atomistic and continuum stresses within the bridging domain $\\Omega_b$ under a homogeneous deformation, using fundamental definitions. The square lattice has reference nearest-neighbor vectors $R_x = a_0 \\, \\boldsymbol{e}_1$ and $R_y = a_0 \\, \\boldsymbol{e}_2$, and the homogeneous deformation $F = \\mathrm{diag}(\\lambda_1, \\lambda_2)$ maps these to current bond vectors\n$$\nr_x = F R_x = \\lambda_1 a_0 \\, \\boldsymbol{e}_1, \\qquad r_y = F R_y = \\lambda_2 a_0 \\, \\boldsymbol{e}_2,\n$$\nwith lengths $|r_x| = \\lambda_1 a_0$ and $|r_y| = \\lambda_2 a_0$.\n\nThe pair potential is $\\varphi(r) = \\frac{k}{2}(r - a_0)^2$, so the central force magnitude along a bond of length $r$ is\n$$\n\\varphi'(r) = k (r - a_0).\n$$\nFor a bond aligned with a unit direction $\\boldsymbol{n}$, the pairwise force on one atom due to the other is\n$$\n\\boldsymbol{f} = - \\varphi'(r) \\, \\boldsymbol{n} = - k (r - a_0) \\, \\boldsymbol{n}.\n$$\n\nWe first compute the Cauchy stress via the Irving–Kirkwood virial formula for static systems (zero kinetic term). In two dimensions, the Cauchy stress is\n$$\n\\boldsymbol{\\sigma}^{\\mathrm{vir}} = - \\frac{1}{A_b} \\sum_{\\text{unique pairs }(i,j)} \\, \\boldsymbol{r}_{ij} \\otimes \\boldsymbol{f}_{ij},\n$$\nwhere $A_b$ is the current area of $\\Omega_b$, and the sum runs over unique nearest-neighbor bonds to avoid double counting.\n\nBy homogeneity and symmetry, every $x$-oriented bond has the same current vector $\\boldsymbol{r}_x = \\lambda_1 a_0 \\, \\boldsymbol{e}_1$ and force $\\boldsymbol{f}_x = - k (\\lambda_1 a_0 - a_0) \\, \\boldsymbol{e}_1 = - k a_0 (\\lambda_1 - 1) \\, \\boldsymbol{e}_1$, while every $y$-oriented bond has $\\boldsymbol{r}_y = \\lambda_2 a_0 \\, \\boldsymbol{e}_2$ and $\\boldsymbol{f}_y = - k a_0 (\\lambda_2 - 1) \\, \\boldsymbol{e}_2$.\n\nLet $n_x^{\\mathrm{ref}}$ and $n_y^{\\mathrm{ref}}$ denote the densities of unique bonds per reference area in the $x$ and $y$ directions. For a square lattice with spacing $a_0$, there is one unique bond per reference cell in each principal direction, so\n$$\nn_x^{\\mathrm{ref}} = \\frac{1}{a_0^2}, \\qquad n_y^{\\mathrm{ref}} = \\frac{1}{a_0^2}.\n$$\nThe current bond densities per current area scale by $1/J$, giving\n$$\nn_x^{\\mathrm{cur}} = \\frac{n_x^{\\mathrm{ref}}}{J} = \\frac{1}{J a_0^2}, \\qquad n_y^{\\mathrm{cur}} = \\frac{1}{J a_0^2}.\n$$\n\nThe virial Cauchy stress is the sum over orientations of the density-weighted dyads $-\\boldsymbol{r} \\otimes \\boldsymbol{f}$:\n\\begin{align*}\n\\boldsymbol{\\sigma}^{\\mathrm{vir}}\n&= - \\left( n_x^{\\mathrm{cur}} \\, \\boldsymbol{r}_x \\otimes \\boldsymbol{f}_x + n_y^{\\mathrm{cur}} \\, \\boldsymbol{r}_y \\otimes \\boldsymbol{f}_y \\right) \\\\\n&= - \\left( \\frac{1}{J a_0^2} \\, (\\lambda_1 a_0 \\, \\boldsymbol{e}_1) \\otimes \\left[ - k a_0 (\\lambda_1 - 1) \\, \\boldsymbol{e}_1 \\right] + \\frac{1}{J a_0^2} \\, (\\lambda_2 a_0 \\, \\boldsymbol{e}_2) \\otimes \\left[ - k a_0 (\\lambda_2 - 1) \\, \\boldsymbol{e}_2 \\right] \\right) \\\\\n&= \\frac{1}{J a_0^2} \\left( k a_0^2 \\lambda_1 (\\lambda_1 - 1) \\, \\boldsymbol{e}_1 \\otimes \\boldsymbol{e}_1 + k a_0^2 \\lambda_2 (\\lambda_2 - 1) \\, \\boldsymbol{e}_2 \\otimes \\boldsymbol{e}_2 \\right) \\\\\n&= \\frac{1}{J} \\left( k \\lambda_1 (\\lambda_1 - 1) \\, \\boldsymbol{e}_1 \\otimes \\boldsymbol{e}_1 + k \\lambda_2 (\\lambda_2 - 1) \\, \\boldsymbol{e}_2 \\otimes \\boldsymbol{e}_2 \\right).\n\\end{align*}\nSince $J = \\lambda_1 \\lambda_2$, this simplifies to\n$$\n\\boldsymbol{\\sigma}^{\\mathrm{vir}} = \\mathrm{diag}\\!\\left( \\frac{k \\lambda_1 (\\lambda_1 - 1)}{\\lambda_1 \\lambda_2}, \\, \\frac{k \\lambda_2 (\\lambda_2 - 1)}{\\lambda_1 \\lambda_2} \\right) = \\mathrm{diag}\\!\\left( \\frac{k (\\lambda_1 - 1)}{\\lambda_2}, \\, \\frac{k (\\lambda_2 - 1)}{\\lambda_1} \\right).\n$$\n\nWe now compute the continuum stress via the Cauchy–Born rule. The hyperelastic energy density per reference area is obtained by summing the pair potential over unique nearest-neighbor bonds:\n$$\nW(F) = n_x^{\\mathrm{ref}} \\, \\varphi(|F R_x|) + n_y^{\\mathrm{ref}} \\, \\varphi(|F R_y|).\n$$\nWith $R_x = a_0 \\, \\boldsymbol{e}_1$, $R_y = a_0 \\, \\boldsymbol{e}_2$, we have $|F R_x| = \\lambda_1 a_0$ and $|F R_y| = \\lambda_2 a_0$, and thus\n$$\nW(F) = \\frac{1}{a_0^2} \\, \\frac{k}{2} (\\lambda_1 a_0 - a_0)^2 + \\frac{1}{a_0^2} \\, \\frac{k}{2} (\\lambda_2 a_0 - a_0)^2.\n$$\nTo obtain the first Piola–Kirchhoff stress, we use the chain rule and the well-tested formula for the derivative of the bond length with respect to $F$:\n$$\n\\frac{\\partial |F R|}{\\partial F} = \\frac{F R}{|F R|} \\otimes R.\n$$\nTherefore,\n\\begin{align*}\n\\boldsymbol{P}\n&= \\frac{\\partial W}{\\partial F} \\\\\n&= n_x^{\\mathrm{ref}} \\, \\varphi'(|F R_x|) \\, \\frac{F R_x}{|F R_x|} \\otimes R_x \\;+\\; n_y^{\\mathrm{ref}} \\, \\varphi'(|F R_y|) \\, \\frac{F R_y}{|F R_y|} \\otimes R_y \\\\\n&= \\frac{1}{a_0^2} \\left[ \\varphi'(\\lambda_1 a_0) \\, \\boldsymbol{e}_1 \\otimes (a_0 \\, \\boldsymbol{e}_1) + \\varphi'(\\lambda_2 a_0) \\, \\boldsymbol{e}_2 \\otimes (a_0 \\, \\boldsymbol{e}_2) \\right] \\\\\n&= \\frac{1}{a_0} \\left[ \\varphi'(\\lambda_1 a_0) \\, \\boldsymbol{e}_1 \\otimes \\boldsymbol{e}_1 + \\varphi'(\\lambda_2 a_0) \\, \\boldsymbol{e}_2 \\otimes \\boldsymbol{e}_2 \\right].\n\\end{align*}\nSubstituting $\\varphi'(r) = k (r - a_0)$ gives\n$$\n\\boldsymbol{P} = \\frac{1}{a_0} \\left[ k (\\lambda_1 a_0 - a_0) \\, \\boldsymbol{e}_1 \\otimes \\boldsymbol{e}_1 + k (\\lambda_2 a_0 - a_0) \\, \\boldsymbol{e}_2 \\otimes \\boldsymbol{e}_2 \\right] = k \\left[ (\\lambda_1 - 1) \\, \\boldsymbol{e}_1 \\otimes \\boldsymbol{e}_1 + (\\lambda_2 - 1) \\, \\boldsymbol{e}_2 \\otimes \\boldsymbol{e}_2 \\right].\n$$\nThe continuum Cauchy stress for a hyperelastic material is given by\n$$\n\\boldsymbol{\\sigma}^{\\mathrm{FE}} = \\frac{1}{J} \\boldsymbol{P} F^{\\mathsf{T}}.\n$$\nWith $F = \\mathrm{diag}(\\lambda_1, \\lambda_2)$, we obtain\n\\begin{align*}\n\\boldsymbol{\\sigma}^{\\mathrm{FE}}\n&= \\frac{1}{\\lambda_1 \\lambda_2} \\, k \\left[ (\\lambda_1 - 1) \\, \\boldsymbol{e}_1 \\otimes \\boldsymbol{e}_1 + (\\lambda_2 - 1) \\, \\boldsymbol{e}_2 \\otimes \\boldsymbol{e}_2 \\right] \\, \\mathrm{diag}(\\lambda_1, \\lambda_2) \\\\\n&= \\mathrm{diag}\\!\\left( \\frac{k (\\lambda_1 - 1)}{\\lambda_2}, \\, \\frac{k (\\lambda_2 - 1)}{\\lambda_1} \\right).\n\\end{align*}\nComparing this with $\\boldsymbol{\\sigma}^{\\mathrm{vir}}$ computed above, we see that\n$$\n\\boldsymbol{\\sigma}^{\\mathrm{vir}} = \\boldsymbol{\\sigma}^{\\mathrm{FE}} = \\mathrm{diag}\\!\\left( \\frac{k (\\lambda_1 - 1)}{\\lambda_2}, \\, \\frac{k (\\lambda_2 - 1)}{\\lambda_1} \\right).\n$$\nTherefore the Frobenius-norm difference\n$$\n\\Delta = \\left\\| \\boldsymbol{\\sigma}^{\\mathrm{vir}} - \\boldsymbol{\\sigma}^{\\mathrm{FE}} \\right\\|_{F}\n$$\nvanishes exactly:\n$$\n\\Delta = 0.\n$$\nSince $\\Delta$ is a scalar with the units of stress (Newton per meter in two dimensions), the exact value $0$ is reported without the need for rounding.",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "Theoretical understanding of multiscale methods must ultimately be translated into robust, working code. This capstone exercise guides you through the process of implementing and verifying a complete 1D BDM simulation, bringing together the core concepts of energy blending and constraint enforcement . Far more than just a coding task, this practice emphasizes the critical importance of a rigorous verification workflow, requiring you to develop a suite of unit tests for the weight functions, kinematic constraints, patch test accuracy, and energy conservation. Successfully completing this challenge provides a blueprint for building and validating reliable multiscale models in your own research.",
            "id": "3816106",
            "problem": "Consider a one-dimensional benchmark for the Bridging Domain Method (BDM). The BDM couples an atomistic model and a continuum model over an overlap (bridging) subdomain by blending their energies and enforcing consistency constraints. The objective is to implement a verification workflow including unit tests for weight properties, constraint enforcement, the patch test, and energy conservation, along with explicit acceptance criteria.\n\nThe physical setting is a bar occupying the interval $[0,L]$ with displacement field $u(x)$, where $x$ is the spatial coordinate and $L$ is the length. The atomistic model is defined on $[0,x_{\\mathrm{a,end}}]$ with nodes at positions $x^{\\mathrm{a}}_i$, and the continuum model is defined on $[x_{\\mathrm{c,start}},L]$ with nodes at positions $x^{\\mathrm{c}}_j$. The overlap (bridging) domain is $[x_{\\mathrm{c,start}},x_{\\mathrm{a,end}}]$.\n\nFundamental base:\n- Linear elastic energy density for the continuum in one dimension is given by $\\psi_{\\mathrm{c}}(\\varepsilon)=\\frac{1}{2}EA\\,\\varepsilon^2$, where $E$ is Young’s modulus, $A$ is cross-sectional area, and $\\varepsilon=u'(x)$ is the strain. In discretized form with linear finite elements and uniform spacing $h_{\\mathrm{c}}$, the element energy reduces to $\\frac{1}{2}k_{\\mathrm{c}}(u_{j+1}-u_j)^2$, where $k_{\\mathrm{c}}=\\frac{EA}{h_{\\mathrm{c}}}$.\n- A nearest-neighbor atomistic chain with lattice spacing $h_{\\mathrm{a}}$ and harmonic interaction similarly yields bond energy $\\frac{1}{2}k_{\\mathrm{a}}(u_{i+1}-u_i)^2$, where $k_{\\mathrm{a}}=\\frac{EA}{h_{\\mathrm{a}}}$, ensuring consistent calibration with the continuum.\n- In the overlap domain, blending weights $w_{\\mathrm{a}}(x)\\in[0,1]$ and $w_{\\mathrm{c}}(x)=1-w_{\\mathrm{a}}(x)$ define the contribution of the atomistic and continuum energies. A smooth partition of unity is required so that $w_{\\mathrm{a}}(x)+w_{\\mathrm{c}}(x)=1$ for all $x$ in the overlap.\n- Consistency constraints are enforced weakly via a quadratic penalty with parameter $\\gamma>0$, penalizing the difference between the continuum displacement and the atomistic displacement interpolated to continuum nodes in the overlap.\n\nModel specification:\n- Let $L>0$, $x_{\\mathrm{c,start}}\\in(0,L)$, $x_{\\mathrm{a,end}}\\in(x_{\\mathrm{c,start}},L)$, $h_{\\mathrm{a}}>0$, $h_{\\mathrm{c}}>0$, and $\\varepsilon$ a prescribed uniform strain. Dirichlet boundary conditions are $u(0)=0$ and $u(L)=\\varepsilon L$.\n- Define atomistic nodes $x^{\\mathrm{a}}_i=i h_{\\mathrm{a}}$ for $i=0,1,\\dots,N_{\\mathrm{a}}-1$ such that $x^{\\mathrm{a}}_{N_{\\mathrm{a}}-1}=x_{\\mathrm{a,end}}$ (within rounding to the nearest multiple of $h_{\\mathrm{a}}$). Define continuum nodes $x^{\\mathrm{c}}_j=x_{\\mathrm{c,start}}+j h_{\\mathrm{c}}$ for $j=0,1,\\dots,N_{\\mathrm{c}}-1$ such that $x^{\\mathrm{c}}_{N_{\\mathrm{c}}-1}=L$ (within rounding to the nearest multiple of $h_{\\mathrm{c}}$).\n- The atomistic energy is $E_{\\mathrm{a}}=\\sum_{i=0}^{N_{\\mathrm{a}}-2}\\frac{1}{2}k_{\\mathrm{a}}\\,w_{\\mathrm{a}}(x^{\\mathrm{a}}_{i+\\frac{1}{2}})\\,(u^{\\mathrm{a}}_{i+1}-u^{\\mathrm{a}}_i)^2$ with $x^{\\mathrm{a}}_{i+\\frac{1}{2}}=\\frac{1}{2}(x^{\\mathrm{a}}_i+x^{\\mathrm{a}}_{i+1})$.\n- The continuum energy is $E_{\\mathrm{c}}=\\sum_{j=0}^{N_{\\mathrm{c}}-2}\\frac{1}{2}k_{\\mathrm{c}}\\,w_{\\mathrm{c}}(x^{\\mathrm{c}}_{j+\\frac{1}{2}})\\,(u^{\\mathrm{c}}_{j+1}-u^{\\mathrm{c}}_j)^2$ with $x^{\\mathrm{c}}_{j+\\frac{1}{2}}=\\frac{1}{2}(x^{\\mathrm{c}}_j+x^{\\mathrm{c}}_{j+1})$.\n- The penalty consistency term is $E_{\\mathrm{pen}}=\\sum_{x^{\\mathrm{c}}_j\\in[x_{\\mathrm{c,start}},x_{\\mathrm{a,end}}]} \\frac{1}{2}\\gamma \\left(u^{\\mathrm{c}}_j - I_{\\mathrm{a}}[u^{\\mathrm{a}}](x^{\\mathrm{c}}_j)\\right)^2$, where $I_{\\mathrm{a}}[u^{\\mathrm{a}}]$ is the piecewise linear interpolation of $u^{\\mathrm{a}}$ to the continuum node positions in the overlap.\n- The total energy is $E_{\\mathrm{tot}}=E_{\\mathrm{a}}+E_{\\mathrm{c}}+E_{\\mathrm{pen}}$. Minimization of $E_{\\mathrm{tot}}$ under the Dirichlet boundary conditions yields the coupled equilibrium.\n\nWeight function specification:\n- Define the atomistic weight $w_{\\mathrm{a}}(x)$ as\n$$\nw_{\\mathrm{a}}(x)=\n\\begin{cases}\n1, & x\\le x_{\\mathrm{c,start}},\\\\\n\\frac{1}{2}\\left[1+\\cos\\left(\\pi\\,\\frac{x-x_{\\mathrm{c,start}}}{x_{\\mathrm{a,end}}-x_{\\mathrm{c,start}}}\\right)\\right], & x\\in(x_{\\mathrm{c,start}},x_{\\mathrm{a,end}}),\\\\\n0, & x\\ge x_{\\mathrm{a,end}},\n\\end{cases}\n$$\nand $w_{\\mathrm{c}}(x)=1-w_{\\mathrm{a}}(x)$ in the overlap.\n\nVerification workflow and acceptance criteria:\n- Weights test: Verify $w_{\\mathrm{a}}(x)\\in[0,1]$ for all bond midpoints in the atomistic domain and $w_{\\mathrm{c}}(x)=1-w_{\\mathrm{a}}(x)$ for all bond midpoints in the overlap. Verify $w_{\\mathrm{a}}(x_{\\mathrm{c,start}})=1$ and $w_{\\mathrm{a}}(x_{\\mathrm{a,end}})=0$. Verify that $w_{\\mathrm{a}}(x)$ is nonincreasing on $[x_{\\mathrm{c,start}},x_{\\mathrm{a,end}}]$. Acceptance requires all conditions to hold within a tolerance of $10^{-12}$.\n- Constraints test: Solve for the coupled equilibrium and evaluate $\\max_{x^{\\mathrm{c}}_j\\in[x_{\\mathrm{c,start}},x_{\\mathrm{a,end}}]}\\left|u^{\\mathrm{c}}_j - I_{\\mathrm{a}}[u^{\\mathrm{a}}](x^{\\mathrm{c}}_j)\\right|$. Acceptance requires this maximum to be $\\le 10^{-6}$.\n- Patch test: The exact linear field is $u_{\\mathrm{lin}}(x)=\\varepsilon x$. After solving for the coupled equilibrium, evaluate the maximum nodal error over all atomistic and continuum nodes: $\\max\\left(\\max_i|u^{\\mathrm{a}}_i-u_{\\mathrm{lin}}(x^{\\mathrm{a}}_i)|,\\max_j|u^{\\mathrm{c}}_j-u_{\\mathrm{lin}}(x^{\\mathrm{c}}_j)|\\right)$. Acceptance requires this maximum to be $\\le 10^{-6}$.\n- Energy conservation test: Rigid-body translation invariance requires $E_{\\mathrm{tot}}(u+c)=E_{\\mathrm{tot}}(u)$ for any constant $c$. Using $c=0.123$, evaluate $\\left|E_{\\mathrm{tot}}(u_{\\mathrm{lin}}+c)-E_{\\mathrm{tot}}(u_{\\mathrm{lin}})\\right|$. Acceptance requires this absolute difference to be $\\le 10^{-10}$.\n\nAll quantities are dimensionless; no physical units are required.\n\nYour program must implement the assembly of the quadratic energy, enforce Dirichlet boundary conditions at $x=0$ and $x=L$ to $u(0)=0$ and $u(L)=\\varepsilon L$, solve for the equilibrium by minimizing $E_{\\mathrm{tot}}$, and run the four tests above.\n\nTest suite:\nProvide three parameter sets to exercise different regimes.\n- Case $1$ (happy path): $L=1.0$, $x_{\\mathrm{c,start}}=0.4$, $x_{\\mathrm{a,end}}=0.6$, $h_{\\mathrm{a}}=0.02$, $h_{\\mathrm{c}}=0.04$, $\\varepsilon=0.01$, $\\gamma=10^5$.\n- Case $2$ (minimal overlap): $L=1.0$, $x_{\\mathrm{c,start}}=0.5$, $x_{\\mathrm{a,end}}=0.54$, $h_{\\mathrm{a}}=0.02$, $h_{\\mathrm{c}}=0.04$, $\\varepsilon=0.02$, $\\gamma=10^6$.\n- Case $3$ (weak coupling edge): $L=1.0$, $x_{\\mathrm{c,start}}=0.4$, $x_{\\mathrm{a,end}}=0.6$, $h_{\\mathrm{a}}=0.02$, $h_{\\mathrm{c}}=0.04$, $\\varepsilon=0.01$, $\\gamma=1.0$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each test case, output the four booleans in the order $[$weights\\_ok, constraints\\_ok, patch\\_ok, energy\\_ok$]$, concatenated across all cases into a single flat list. For example, the output format for three cases must be $[$b$_1$,b$_2$,b$_3$,b$_4$,b$_5$,b$_6$,b$_7$,b$_8$,b$_9$,b$_{10}$,$b_{11}$,$b_{12}]$ where $b_k\\in\\{$True, False$\\}$.",
            "solution": "The problem statement poses a task of implementing and verifying a one-dimensional Bridging Domain Method (BDM) for coupling an atomistic and a continuum model. The verification is to be conducted through a series of four specific tests: a weights test, a constraint enforcement test, a patch test, and an energy conservation test. The problem is scientifically grounded, well-defined, and specifies objective criteria for success. A minor ambiguity in the specification of the continuum grid discretization for non-integer interval counts is resolved by adopting a standard numerical practice: the number of intervals is determined by rounding the target ratio, and the spatial step $h_c$ is adjusted to fit the domain $[x_{\\mathrm{c,start}}, L]$ exactly. With this clarification, the problem is well-posed and a unique solution can be algorithmically constructed.\n\nThe core of the BDM is the minimization of a total energy functional, $E_{\\mathrm{tot}}$, which is the sum of weighted atomistic energy $E_{\\mathrm{a}}$, weighted continuum energy $E_{\\mathrm{c}}$, and a penalty energy $E_{\\mathrm{pen}}$ enforcing consistency.\n$$\nE_{\\mathrm{tot}} = E_{\\mathrm{a}} + E_{\\mathrm{c}} + E_{\\mathrm{pen}}\n$$\nAs all energy components are quadratic in the nodal displacements, the total energy is a quadratic function of the vector of all unknown displacements, $\\mathbf{u}$. Minimizing this energy is equivalent to solving a linear system of equations.\n$$\n\\frac{\\partial E_{\\mathrm{tot}}}{\\partial \\mathbf{u}} = 0 \\implies \\mathbf{K} \\mathbf{u} = \\mathbf{f}\n$$\nHere, $\\mathbf{K}$ is the global stiffness matrix (the Hessian of $E_{\\mathrm{tot}}$) and $\\mathbf{f}$ is the global force vector arising from boundary conditions and external loads (which are absent in this problem). The solution proceeds by first defining the discrete degrees of freedom (DoFs), then assembling $\\mathbf{K}$ and $\\mathbf{f}$ by summing the contributions from each energy term, solving the linear system for the unknown displacements $\\mathbf{u}$, and finally executing the specified verification tests.\n\nFirst, we define the computational grids. The atomistic domain $[0, x_{\\mathrm{a,end}}]$ is discretized with nodes $x^{\\mathrm{a}}_i = i h_{\\mathrm{a}}$, for $i=0, \\dots, N_{\\mathrma}-1$, where $N_{\\mathrma} = \\text{round}(x_{\\mathrm{a,end}}/h_{\\mathrm{a}}) + 1$. The actual end of the atomistic domain is $x^{\\mathrm{a}}_{N_{\\mathrma}-1}$. The continuum domain $[x_{\\mathrm{c,start}}, L]$ is discretized with nodes $x^{\\mathrm{c}}_j = x_{\\mathrm{c,start}} + j h_{\\mathrm{c,eff}}$, for $j=0, \\dots, N_{\\mathrmc}-1$. The number of uniform intervals is $N_{\\mathrmc}-1 = \\text{round}((L-x_{\\mathrm{c,start}})/h_{\\mathrm{c}})$, and the effective spacing is $h_{\\mathrm{c,eff}} = (L-x_{\\mathrm{c,start}})/(N_{\\mathrmc}-1)$. This ensures $x^{\\mathrm{c}}_{N_{\\mathrmc}-1}=L$. The dimensionless material stiffness $EA$ is taken as $1$, so $k_{\\mathrm{a}}=1/h_{\\mathrma}$ and $k_{\\mathrm{c}}=1/h_{\\mathrm{c,eff}}$.\n\nThe unknown DoFs are the displacements of all nodes not fixed by Dirichlet boundary conditions. The displacement $u^{\\mathrma}_0$ at $x=0$ is fixed to $0$, and the displacement $u^{\\mathrmc}_{N_{\\mathrmc}-1}$ at $x=L$ is fixed to $\\varepsilon L$. The vector of unknowns is thus $\\mathbf{u} = [u^{\\mathrma}_1, \\dots, u^{\\mathrma}_{N_{\\mathrma}-1}, u^{\\mathrmc}_0, \\dots, u^{\\mathrmc}_{N_{\\mathrmc}-2}]^T$, of size $D = (N_{\\mathrma}-1) + (N_{\\mathrmc}-1)$.\n\nThe assembly of the $D \\times D$ stiffness matrix $\\mathbf{K}$ and the $D \\times 1$ force vector $\\mathbf{f}$ proceeds as follows:\n\n1.  **Atomistic Energy Contribution ($E_{\\mathrm{a}}$)**: The energy is $E_{\\mathrm{a}}=\\sum_{i=0}^{N_{\\mathrma}-2}\\frac{1}{2}k_{\\mathrm{a}}w_{\\mathrm{a}}(x^{\\mathrma}_{i+1/2})(u^{\\mathrma}_{i+1}-u^{\\mathrma}_i)^2$. Each term $\\frac{1}{2}\\tilde{k}(u_{i+1}-u_i)^2$ contributes a local stiffness matrix $\\tilde{k}\\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$ to the global matrix $\\mathbf{K}$ at the rows/columns corresponding to $u_i$ and $u_{i+1}$. For $i=0$, $u_0^{\\mathrma}$ is fixed at $0$, so the term $\\frac{1}{2}\\tilde{k}_{0}(u_1^{\\mathrma})^2$ contributes $\\tilde{k}_{0}$ to the diagonal element of $\\mathbf{K}$ for $u_1^{\\mathrma}$.\n\n2.  **Continuum Energy Contribution ($E_{\\mathrm{c}}$)**: The energy is $E_{\\mathrm{c}}=\\sum_{j=0}^{N_{\\mathrmc}-2}\\frac{1}{2}k_{\\mathrmc}w_{\\mathrmc}(x^{\\mathrmc}_{j+1/2})(u^{\\mathrmc}_{j+1}-u^{\\mathrmc}_j)^2$. The assembly is analogous to the atomistic part. For the last element $j=N_{\\mathrmc}-2$, $u_{N_{\\mathrmc}-1}^{\\mathrmc}$ is the known boundary value $u_L = \\varepsilon L$. The energy term $\\frac{1}{2}\\tilde{k}_{N_{\\mathrmc}-2}(u_L-u^{\\mathrmc}_{N_{\\mathrmc}-2})^2$ expands to $\\frac{1}{2}\\tilde{k}_{N_{\\mathrmc}-2}((u^{\\mathrmc}_{N_{\\mathrmc}-2})^2 - 2u_L u^{\\mathrmc}_{N_{\\mathrmc}-2} + u_L^2)$. The quadratic part contributes $\\tilde{k}_{N_{\\mathrmc}-2}$ to the diagonal of $\\mathbf{K}$ for DoF $u^{\\mathrmc}_{N_{\\mathrmc}-2}$. The linear part, $-\\tilde{k}_{N_{\\mathrmc}-2}u_L u^{\\mathrmc}_{N_{\\mathrmc}-2}$, contributes a force $\\tilde{k}_{N_{\\mathrmc}-2}u_L$ to the right-hand side vector $\\mathbf{f}$ for that DoF.\n\n3.  **Penalty Energy Contribution ($E_{\\mathrm{pen}}$)**: The penalty term for a continuum node $x^{\\mathrmc}_j$ in the overlap region is $\\frac{1}{2}\\gamma (u^{\\mathrmc}_j - I_{\\mathrma}[u^{\\mathrma}](x^{\\mathrmc}_j))^2$. The interpolated atomistic displacement is $I_{\\mathrma}[u^{\\mathrma}](x^{\\mathrmc}_j) = (1-\\alpha)u_i^{\\mathrma} + \\alpha u_{i+1}^{\\mathrma}$, where $x_i^{\\mathrma} \\le x_j^{\\mathrmc} \\le x_{i+1}^{\\mathrma}$ and $\\alpha = (x_j^{\\mathrmc}-x_i^{\\mathrma})/h_{\\mathrma}$. The penalty couples three DoFs: $u_i^{\\mathrma}$, $u_{i+1}^{\\mathrma}$, and $u_j^{\\mathrmc}$. The energy term is\n    $$ \\frac{1}{2}\\gamma (u^{\\mathrmc}_j - (1-\\alpha)u_i^{\\mathrma} - \\alpha u_{i+1}^{\\mathrma})^2 $$\n    This quadratic form contributes a $3 \\times 3$ symmetric positive semi-definite matrix $\\gamma \\mathbf{v}\\mathbf{v}^T$ to the global stiffness matrix $\\mathbf{K}$, where $\\mathbf{v} = [-(1-\\alpha), -\\alpha, 1]^T$ and the DoFs are indexed in the order $(u_i^{\\mathrma}, u_{i+1}^{\\mathrma}, u_j^{\\mathrmc})$. Special care is taken if $i=0$, as $u_0^{\\mathrma}$ is not a DoF.\n\nAfter solving $\\mathbf{K}\\mathbf{u}=\\mathbf{f}$, the full displacement vectors $u^{\\mathrma}$ and $u^{\\mathrmc}$ are reconstructed. The four verification tests are then performed:\n-   **Weights Test**: The implemented weight function $w_a(x)$ is checked at specified points and its monotonicity is verified.\n-   **Constraints Test**: The maximum mismatch $|u^{\\mathrmc}_j - I_{\\mathrma}[u^{\\mathrma}](x^{\\mathrmc}_j)|$ is computed over all continuum nodes in the overlap, using the solved displacements.\n-   **Patch Test**: The maximum error between the solved displacements and the exact linear field $u_{\\mathrm{lin}}(x)=\\varepsilon x$ is computed over all nodes.\n-   **Energy Conservation Test**: The total energy functional is evaluated for the fields $u_{\\mathrmlin}(x)$ and $u_{\\mathrmlin}(x)+c$ (a rigid translation). The absolute difference, which should be zero up to machine precision, is calculated.\n\nThese steps are encapsulated in a reusable function and applied to each of the three test cases provided. The boolean results of the tests, based on the given acceptance criteria, are then aggregated and formatted for the final output.",
            "answer": "$$\\boxed{\\text{[True,True,True,True,True,True,True,True,True,False,False,True]}}$$"
        }
    ]
}