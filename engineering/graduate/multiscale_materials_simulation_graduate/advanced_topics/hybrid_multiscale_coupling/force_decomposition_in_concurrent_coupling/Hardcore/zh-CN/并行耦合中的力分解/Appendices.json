{
    "hands_on_practices": [
        {
            "introduction": "在多尺度模拟中，一个核心的挑战是如何在不同尺度的描述之间建立联系。这个练习将引导你通过虚功原理，将离散原子受到的力映射到连续介质有限元模型的节点力上 。掌握这种从细观到宏观的力投影方法，是构建能量守恒的混合模型的关键第一步。",
            "id": "3809183",
            "problem": "在一维弹性杆的并行原子-连续介质耦合中，一个重叠区域同时由原子和单个双节点线性有限元(FE)离散化来表示，该单元从位置 $x=0$ 的左节点延伸到位置 $x=L$ 的右节点。杆的轴线取为 $x$ 方向，所有运动学量和力学量均与该轴共线。重叠区域中的三个原子，其相对于左节点的位置分别为 $x_1$、$x_2$ 和 $x_3$，由于原子间的相互作用和施加的载荷，它们沿 $x$ 方向受到原子力 $f_1$、$f_2$ 和 $f_3$。\n\n假设数据如下：单元长度 $L=2$ nm，原子位置 $x_1=0.2$ nm，$x_2=0.8$ nm，$x_3=1.5$ nm，相应的原子力为 $f_1=0.5$ nN，$f_2=-1.2$ nN，$f_3=0.9$ nN。\n\n从虚功原理和单元内虚位移场的标准 $C^0$ 线性拉格朗日插值出发，推导将原子力 $\\{f_i\\}$ 映射到左节点处粗粒化有限元节点力的表达式，然后利用上述数据计算其数值。将您的答案四舍五入至四位有效数字，并以纳牛顿为单位表示最终的节点力。您的最终答案必须是一个数字。",
            "solution": "本题要求基于作用在一维单元内单个原子上的力，推导该单元左节点处有限元(FE)节点力的表达式。推导必须从虚功原理出发。\n\n虚功原理应用于耦合的原子-连续介质系统时，在两个尺度之间建立了能量和力的一致性。它指出，对于任何运动学上容许的虚位移场，由粗粒化有限元节点力所做的虚功 $\\delta W_{\\text{FE}}$ 必须等于由微观原子力所做的虚功 $\\delta W_{\\text{at}}$。\n$$ \\delta W_{\\text{FE}} = \\delta W_{\\text{at}} $$\n\n分别作用于左节点（$x=0$）和右节点（$x=L$）的有限元节点力 $F_1$ 和 $F_2$ 所做的虚功由下式给出：\n$$ \\delta W_{\\text{FE}} = F_1 \\delta U_1 + F_2 \\delta U_2 $$\n其中 $\\delta U_1$ 和 $\\delta U_2$ 分别是左、右节点的虚位移。\n\n作用于位置为 $\\{x_i\\}$ 的原子上的离散原子力 $\\{f_i\\}$ 所做的虚功为：\n$$ \\delta W_{\\text{at}} = \\sum_{i=1}^{3} f_i \\delta u_i $$\n其中 $\\delta u_i$ 是第 $i$ 个原子的虚位移。\n\n连续介质尺度和原子尺度之间的联系是通过位移场的有限元插值建立的。该问题指定了一个具有标准 $C^0$ 拉格朗日插值函数（或形函数）$N_1(x)$ 和 $N_2(x)$ 的双节点线性单元。对于一个长度为 $L$ 且节点位于 $x=0$ 和 $x=L$ 的一维单元，这些形函数为：\n$$ N_1(x) = 1 - \\frac{x}{L} $$\n$$ N_2(x) = \\frac{x}{L} $$\n单元内任意位置 $x$ 处的虚位移场 $\\delta u(x)$ 是由节点虚位移 $\\delta U_1$ 和 $\\delta U_2$ 插值得到的：\n$$ \\delta u(x) = N_1(x) \\delta U_1 + N_2(x) \\delta U_2 $$\n位于位置 $x_i$ 的第 $i$ 个原子的虚位移，是通过在该位置计算插值场得到的：\n$$ \\delta u_i = \\delta u(x_i) = N_1(x_i) \\delta U_1 + N_2(x_i) \\delta U_2 $$\n\n将 $\\delta u_i$ 的表达式代入 $\\delta W_{\\text{at}}$ 的方程中：\n$$ \\delta W_{\\text{at}} = \\sum_{i=1}^{3} f_i \\left( N_1(x_i) \\delta U_1 + N_2(x_i) \\delta U_2 \\right) $$\n通过重新排列求和项，我们可以将乘以 $\\delta U_1$ 和 $\\delta U_2$ 的项分组：\n$$ \\delta W_{\\text{at}} = \\left( \\sum_{i=1}^{3} f_i N_1(x_i) \\right) \\delta U_1 + \\left( \\sum_{i=1}^{3} f_i N_2(x_i) \\right) \\delta U_2 $$\n\n现在，我们令 $\\delta W_{\\text{FE}}$ 和 $\\delta W_{\\text{at}}$ 的表达式相等：\n$$ F_1 \\delta U_1 + F_2 \\delta U_2 = \\left( \\sum_{i=1}^{3} f_i N_1(x_i) \\right) \\delta U_1 + \\left( \\sum_{i=1}^{3} f_i N_2(x_i) \\right) \\delta U_2 $$\n由于此等式必须对任意独立的节点虚位移 $\\delta U_1$ 和 $\\delta U_2$ 均成立，因此方程两边 $\\delta U_1$ 和 $\\delta U_2$ 的系数必须相等。这就得出了从原子力到有限元节点力的映射关系：\n$$ F_1 = \\sum_{i=1}^{3} f_i N_1(x_i) $$\n$$ F_2 = \\sum_{i=1}^{3} f_i N_2(x_i) $$\n\n问题要求解左节点处粗粒化有限元节点力 $F_1$ 的表达式和数值。将形函数 $N_1(x)$ 的具体形式代入 $F_1$ 的表达式，我们得到所需的公式：\n$$ F_1 = \\sum_{i=1}^{3} f_i \\left( 1 - \\frac{x_i}{L} \\right) $$\n\n我们已知以下数据：\n- 单元长度：$L=2$ nm\n- 原子位置：$x_1=0.2$ nm，$x_2=0.8$ nm，$x_3=1.5$ nm\n- 原子力：$f_1=0.5$ nN，$f_2=-1.2$ nN，$f_3=0.9$ nN\n\n现在我们可以计算 $F_1$ 的数值：\n$$ F_1 = f_1 \\left( 1 - \\frac{x_1}{L} \\right) + f_2 \\left( 1 - \\frac{x_2}{L} \\right) + f_3 \\left( 1 - \\frac{x_3}{L} \\right) $$\n$$ F_1 = (0.5 \\, \\text{nN}) \\left( 1 - \\frac{0.2 \\, \\text{nm}}{2 \\, \\text{nm}} \\right) + (-1.2 \\, \\text{nN}) \\left( 1 - \\frac{0.8 \\, \\text{nm}}{2 \\, \\text{nm}} \\right) + (0.9 \\, \\text{nN}) \\left( 1 - \\frac{1.5 \\, \\text{nm}}{2 \\, \\text{nm}} \\right) $$\n$$ F_1 = 0.5 \\left( 1 - 0.1 \\right) - 1.2 \\left( 1 - 0.4 \\right) + 0.9 \\left( 1 - 0.75 \\right) $$\n$$ F_1 = 0.5 \\left( 0.9 \\right) - 1.2 \\left( 0.6 \\right) + 0.9 \\left( 0.25 \\right) $$\n$$ F_1 = 0.45 - 0.72 + 0.225 $$\n$$ F_1 = -0.27 + 0.225 $$\n$$ F_1 = -0.045 \\, \\text{nN} $$\n\n问题要求答案保留四位有效数字。计算值为 $-0.045$。为了用四位有效数字表示，我们将其写为 $-0.04500$。",
            "answer": "$$\\boxed{-0.04500}$$"
        },
        {
            "introduction": "在定义了跨尺度的力之后，我们需要在原子和连续介质的重叠区域中平滑地混合它们。这个练习探讨了一种直接的力混合方案，其中总力是原子尺度力（MD）和连续介质力（FEM）的加权平均 。通过分析这种混合力场在界面处的平滑性，你将揭示这类简单方案可能引入的伪影，这对于理解更复杂耦合方法的动机至关重要。",
            "id": "3809188",
            "problem": "考虑一个多尺度材料模拟中的一维并行原子-连续介质耦合，其中分子动力学 (MD) 和有限元法 (FEM) 在一个重叠区域内使用单位分解权函数进行混合。设重叠区域为区间 $x \\in [-L, L]$，其中 $L>0$。权函数由下式给出\n$$\nw(x)=\\frac{1}{2}\\left[1+\\cos\\left(\\frac{\\pi x}{L}\\right)\\right],\n$$\n并且满足 $0 \\leq w(x) \\leq 1$，$w(0)=1$ 和 $w(\\pm L)=0$。在重叠区域之外，权重被假定为常数（在纯MD区域中 $w(x)=1$，在纯FEM区域中 $w(x)=0$）。\n\n假设遵循以下原理：\n- 牛顿第二定律 $m\\,\\ddot{u}(x)=F^{\\text{tot}}(x)$，其中 $F^{\\text{tot}}(x)$ 是作用在位置 $x$ 处的总力密度。\n- 纯子域中的一致性：在 $w(x)=1$ 的区域，总力必须等于MD力 $F_{\\text{MD}}(x)$；在 $w(x)=0$ 的区域，总力必须等于FEM力 $F_{\\text{FEM}}(x)$。\n- 重叠区内的单位分解和线性叠加：来自MD和FEM的贡献以和为一的权重进行线性组合，且不引入伪功。\n\n给定均匀的力预测值 $F_{\\text{MD}}(x)=F_0$ 和 $F_{\\text{FEM}}(x)=2F_0$，其中 $F_0$ 是一个以牛顿（N）为单位的常数，推导重叠区域内总力 $F^{\\text{tot}}(x)$ 的解析表达式。然后，使用您的表达式，通过计算其一阶和二阶空间导数并评估它们在 $x=\\pm L$ 处的值，来分析 $F^{\\text{tot}}(x)$ 在界面 $x=\\pm L$ 处的光滑性。\n\n以 $x$、$L$ 和 $F_0$ 的函数形式，给出 $F^{\\text{tot}}(x)$ 的最终闭合形式表达式。无需四舍五入。以牛顿表示 $F_0$；在最终的方框答案中不要包含单位。",
            "solution": "经评估，该问题陈述具有科学依据、适定、客观且内部一致。它描述了一种用于并行多尺度模拟中的典型一维基于力的混合方案。所提供的数据和原理足以推导出唯一且有意义的解。因此，该问题是有效的。\n\n在重叠区域推导总力 $F^{\\text{tot}}(x)$ 的核心原理是基于单位分解的力的线性叠加。问题指明了权函数 $w(x)$，并陈述在 $w(x)=1$ 的区域，力为分子动力学 (MD) 力 $F_{\\text{MD}}(x)$，而在 $w(x)=0$ 的区域，力为有限元法 (FEM) 力 $F_{\\text{FEM}}(x)$。这意味着 $w(x)$ 是分配给MD贡献的权重。在一个双组分混合（MD和FEM）中，单位分解原理要求权重之和为一。因此，FEM贡献的权重必须是 $1-w(x)$。\n\n因此，重叠区域的总力密度 $F^{\\text{tot}}(x)$ 是MD和FEM力密度的加权平均：\n$$\nF^{\\text{tot}}(x) = w(x) F_{\\text{MD}}(x) + [1 - w(x)] F_{\\text{FEM}}(x)\n$$\n我们已知以下表达式：\n权函数：\n$$\nw(x) = \\frac{1}{2}\\left[1+\\cos\\left(\\frac{\\pi x}{L}\\right)\\right]\n$$\nMD力：\n$$\nF_{\\text{MD}}(x) = F_0\n$$\nFEM力：\n$$\nF_{\\text{FEM}}(x) = 2F_0\n$$\n首先，我们来求FEM权重 $1 - w(x)$ 的表达式：\n$$\n1 - w(x) = 1 - \\frac{1}{2}\\left[1+\\cos\\left(\\frac{\\pi x}{L}\\right)\\right] = 1 - \\frac{1}{2} - \\frac{1}{2}\\cos\\left(\\frac{\\pi x}{L}\\right) = \\frac{1}{2} - \\frac{1}{2}\\cos\\left(\\frac{\\pi x}{L}\\right) = \\frac{1}{2}\\left[1-\\cos\\left(\\frac{\\pi x}{L}\\right)\\right]\n$$\n现在，将给定的函数代入总力表达式：\n$$\nF^{\\text{tot}}(x) = \\left(\\frac{1}{2}\\left[1+\\cos\\left(\\frac{\\pi x}{L}\\right)\\right]\\right) F_0 + \\left(\\frac{1}{2}\\left[1-\\cos\\left(\\frac{\\pi x}{L}\\right)\\right]\\right) (2F_0)\n$$\n我们可以展开各项并化简：\n$$\nF^{\\text{tot}}(x) = \\frac{F_0}{2} + \\frac{F_0}{2}\\cos\\left(\\frac{\\pi x}{L}\\right) + F_0 - F_0\\cos\\left(\\frac{\\pi x}{L}\\right)\n$$\n合并同类项得出在重叠区域 $x \\in [-L, L]$ 中总力的最终解析表达式：\n$$\nF^{\\text{tot}}(x) = \\frac{3F_0}{2} - \\frac{F_0}{2}\\cos\\left(\\frac{\\pi x}{L}\\right) = F_0\\left(\\frac{3}{2} - \\frac{1}{2}\\cos\\left(\\frac{\\pi x}{L}\\right)\\right)\n$$\n接下来，我们分析 $F^{\\text{tot}}(x)$ 在界面 $x = \\pm L$ 处的光滑性。光滑性由函数及其导数在这些点的连续性决定。我们必须将重叠区域内的 $F^{\\text{tot}}(x)$ 及其导数的值与相邻纯FEM区域中的值进行比较。\n\n问题陈述 $w(\\pm L) = 0$。这意味着 $|x| \\ge L$ 的区域是纯FEM区域，其中 $F(x) = F_{\\text{FEM}}(x) = 2F_0$。在这些区域，力是恒定的，所以其空间导数为零：\n$$\n\\frac{d}{dx}F_{\\text{FEM}}(x) = 0 \\quad \\text{和} \\quad \\frac{d^2}{dx^2}F_{\\text{FEM}}(x) = 0 \\quad \\text{对于 } |x| \\ge L\n$$\n为了实现平滑过渡，混合力及其导数必须在边界 $x=\\pm L$ 处与这些值相匹配。\n\n首先，我们计算重叠区域内 $F^{\\text{tot}}(x)$ 的一阶和二阶空间导数。\n一阶导数是：\n$$\n\\frac{d}{dx}F^{\\text{tot}}(x) = \\frac{d}{dx}\\left[F_0\\left(\\frac{3}{2} - \\frac{1}{2}\\cos\\left(\\frac{\\pi x}{L}\\right)\\right)\\right] = -\\frac{F_0}{2} \\left(-\\sin\\left(\\frac{\\pi x}{L}\\right) \\cdot \\frac{\\pi}{L}\\right) = \\frac{\\pi F_0}{2L}\\sin\\left(\\frac{\\pi x}{L}\\right)\n$$\n二阶导数是：\n$$\n\\frac{d^2}{dx^2}F^{\\text{tot}}(x) = \\frac{d}{dx}\\left[\\frac{\\pi F_0}{2L}\\sin\\left(\\frac{\\pi x}{L}\\right)\\right] = \\frac{\\pi F_0}{2L} \\left(\\cos\\left(\\frac{\\pi x}{L}\\right) \\cdot \\frac{\\pi}{L}\\right) = \\frac{\\pi^2 F_0}{2L^2}\\cos\\left(\\frac{\\pi x}{L}\\right)\n$$\n现在，我们计算函数及其导数在界面 $x=\\pm L$ 处的值。\n\n在 $x=L$ 处：\n$F^{\\text{tot}}(L) = F_0\\left(\\frac{3}{2} - \\frac{1}{2}\\cos(\\pi)\\right) = F_0\\left(\\frac{3}{2} - \\frac{1}{2}(-1)\\right) = 2F_0$。这与 $F_{\\text{FEM}}(x)$ 相匹配，因此函数是连续的 ($C^0$)。\n$\\frac{d}{dx}F^{\\text{tot}}(x)\\Big|_{x=L} = \\frac{\\pi F_0}{2L}\\sin(\\pi) = 0$。这与 $F_{\\text{FEM}}(x)$ 的导数相匹配，因此一阶导数是连续的 ($C^1$)。\n$\\frac{d^2}{dx^2}F^{\\text{tot}}(x)\\Big|_{x=L} = \\frac{\\pi^2 F_0}{2L^2}\\cos(\\pi) = -\\frac{\\pi^2 F_0}{2L^2}$。这与 $F_{\\text{FEM}}(x)$ 的二阶导数（为0）不匹配。\n\n在 $x=-L$ 处：\n$F^{\\text{tot}}(-L) = F_0\\left(\\frac{3}{2} - \\frac{1}{2}\\cos(-\\pi)\\right) = F_0\\left(\\frac{3}{2} - \\frac{1}{2}(-1)\\right) = 2F_0$。这与 $F_{\\text{FEM}}(x)$ 相匹配。连续 ($C^0$)。\n$\\frac{d}{dx}F^{\\text{tot}}(x)\\Big|_{x=-L} = \\frac{\\pi F_0}{2L}\\sin(-\\pi) = 0$。这与 $F_{\\text{FEM}}(x)$ 的导数相匹配。连续 ($C^1$)。\n$\\frac{d^2}{dx^2}F^{\\text{tot}}(x)\\Big|_{x=-L} = \\frac{\\pi^2 F_0}{2L^2}\\cos(-\\pi) = -\\frac{\\pi^2 F_0}{2L^2}$。这与 $F_{\\text{FEM}}(x)$ 的二阶导数不匹配。\n\n分析表明，总力函数 $F^{\\text{tot}}(x)$ 在界面 $x=\\pm L$ 上是 $C^1$ 连续的，但不是 $C^2$ 连续的。二阶导数是不连续的，这是这类线性力混合方案的一个已知特征。这种不连续性意味着在界面处存在“鬼力”，尽管在实践中它们通常很小。\n\n问题要求的是 $F^{\\text{tot}}(x)$ 的闭合形式表达式。这是推导的主要结果。",
            "answer": "$$\n\\boxed{F_0\\left(\\frac{3}{2} - \\frac{1}{2}\\cos\\left(\\frac{\\pi x}{L}\\right)\\right)}\n$$"
        },
        {
            "introduction": "在构建基于能量的耦合方案时，能量的混合方式至关重要。一个看似直观的逐点能量混合，可能会因为破坏了力的平衡而引入非物理的“鬼力”（ghost force）。这个练习将通过一个一维原子链模型，对比一个直接的力混合方案和一个逐点能量混合方案 。你将通过计算证明，在这个特定例子中，直接的力混合能够通过“斑块检验”（patch test），而逐点的能量混合则会产生非物理的残余力，从而揭示了正确构造能量泛函的重要性。",
            "id": "3809201",
            "problem": "考虑一个一维(1D)原子链，其原子由索引 $i \\in \\mathbb{Z}$ 标记，参考位置为 $X_i = i a$，其中 $a > 0$ 是晶格间距。在恒定应变 $\\epsilon$ 的均匀形变下，形变后的位置为 $x_i = i a (1 + \\epsilon)$，因此每个最近邻键的长度为 $r = x_{i+1} - x_i = a (1 + \\epsilon)$。原子模型使用最近邻对相互作用，其每键能量为\n$$\nE^{\\text{MD}}(r) = \\frac{1}{2} k \\left(r - a\\right)^{2} + \\frac{1}{3} \\alpha \\left(r - a\\right)^{3},\n$$\n其中 $k > 0$ 和 $\\alpha$ 是材料参数。连续介质粗化模型使用小应变有限元方法（Finite Element Method (FEM)）作为代理，其每键能量为\n$$\nE^{\\text{FEM}}(r) = \\frac{1}{2} k \\left(r - a\\right)^{2}.\n$$\n定义一个混合区域，在该区域中，逐点混合权重 $w_i \\in [0,1]$ 随索引 $i$ 线性变化，使得在整个混合区域内 $w_{i+1} - w_i = s$ 为常数，其中 $s$ 是一个给定的斜率参数。考虑两种耦合策略：\n\n1. 基于力的混合：对每个原子 $i$，混合力为 $F_i^{\\text{tot}} = w_i F_i^{\\text{MD}} + (1 - w_i) F_i^{\\text{FEM}}$，其中 $F_i^{\\text{MD}}$ 和 $F_i^{\\text{FEM}}$ 分别是来自相应模型的力。\n\n2. 基于能量的混合：总能量通过逐点方式定义为\n$$\nE^{\\text{tot}} = \\sum_{i} \\left[ w_i E_i^{\\text{MD}} + (1 - w_i) E_i^{\\text{FEM}} \\right],\n$$\n其中每点能量将相邻键能的一半分配给每个位点，\n$$\nE_i^{\\text{MD}} = \\frac{1}{2} E^{\\text{MD}}(x_i - x_{i-1}) + \\frac{1}{2} E^{\\text{MD}}(x_{i+1} - x_i), \\quad\nE_i^{\\text{FEM}} = \\frac{1}{2} E^{\\text{FEM}}(x_i - x_{i-1}) + \\frac{1}{2} E^{\\text{FEM}}(x_{i+1} - x_i).\n$$\n\n从第一性原理出发——即牛顿第二定律和力是能量负梯度的定义——完成以下任务：\n\n(a) 证明在均匀形变 $x_i = i a (1 + \\epsilon)$ 下，基于力的混合方法对混合区域中的每个原子 $i$ 产生的力 $F_i^{\\text{tot}} = 0$。\n\n(b) 对于基于能量的混合，计算在相同均匀形变下，作用在混合区域内原子 $j$ 上的残余鬼力 $F_j^{\\text{ghost}}$。将 $F_j^{\\text{ghost}}$ 表示为包含 $s$、$a$、$\\epsilon$、$k$ 和 $\\alpha$ 的闭式解析表达式。提供对应于 $+x$ 方向的符号。无需进行数值代入；仅报告符号表达式。为清晰起见，力的物理单位是牛顿(N)，但最终的方框答案中不要包含单位。",
            "solution": "在尝试解答之前，将对问题进行验证。\n\n### 问题验证\n\n#### 步骤1：提取已知条件\n- **系统**：一维(1D)原子链，原子索引为 $i \\in \\mathbb{Z}$。\n- **参考位置**：$X_i = i a$，其中 $a > 0$ 是晶格间距。\n- **形变**：恒定应变 $\\epsilon$ 的均匀形变，导致形变后位置为 $x_i = i a (1 + \\epsilon)$。\n- **键长**：最近邻键长是恒定的，$r = x_{i+1} - x_i = a (1 + \\epsilon)$。\n- **原子模型 (MD)**：每键能量为 $E^{\\text{MD}}(r) = \\frac{1}{2} k \\left(r - a\\right)^{2} + \\frac{1}{3} \\alpha \\left(r - a\\right)^{3}$，其中 $k > 0$。\n- **连续介质模型 (FEM)**：每键能量为 $E^{\\text{FEM}}(r) = \\frac{1}{2} k \\left(r - a\\right)^{2}$。\n- **混合方案**：逐点混合权重 $w_i \\in [0,1]$ 随索引 $i$ 线性变化，使得 $w_{i+1} - w_i = s$ 为一个恒定斜率。\n- **耦合策略1 (基于力)**：原子 $i$ 上的总力为 $F_i^{\\text{tot}} = w_i F_i^{\\text{MD}} + (1 - w_i) F_i^{\\text{FEM}}$。\n- **耦合策略2 (基于能量)**：总能量为 $E^{\\text{tot}} = \\sum_{i} \\left[ w_i E_i^{\\text{MD}} + (1 - w_i) E_i^{\\text{FEM}} \\right]$。\n- **每点能量**：$E_i^{\\text{MD}} = \\frac{1}{2} E^{\\text{MD}}(x_i - x_{i-1}) + \\frac{1}{2} E^{\\text{MD}}(x_{i+1} - x_i)$ 和 $E_i^{\\text{FEM}} = \\frac{1}{2} E^{\\text{FEM}}(x_i - x_{i-1}) + \\frac{1}{2} E^{\\text{FEM}}(x_{i+1} - x_i)$。\n- **原理**：力是能量的负梯度，$F = -\\nabla E$。\n- **任务 (a)**：证明对于基于力的混合，在指定的均匀形变下，混合区域中每个原子的 $F_i^{\\text{tot}} = 0$。\n- **任务 (b)**：对于基于能量的混合，计算在相同形变下，混合区域中原子 $j$ 上的残余鬼力 $F_j^{\\text{ghost}}$，作为 $s$、$a$、$\\epsilon$、$k$ 和 $\\alpha$ 的函数。\n\n#### 步骤2：使用提取的已知条件进行验证\n1.  **科学依据**：该问题根植于计算材料科学这一成熟领域，特别是并行多尺度模拟。所用的模型（谐波势和非谐波势）和耦合方案（基于力与基于能量）是标准的教科书示例，用于解释准连续介质(QC)等方法中的“鬼力”概念。其表述在物理上和数学上都是合理的。\n2.  **适定性**：问题定义清晰，包含了所有必要的参数和函数。它要求证明并推导一个特定量，这会根据所提供的信息得出一个唯一的解析表达式。\n3.  **客观性**：问题以精确、客观的数学和物理语言陈述。没有主观或模糊的术语。\n4.  **完整性**：问题是自洽的。解答所需的所有变量、函数和条件都已明确提供。\n5.  **一致性**：给定的条件内部一致，没有矛盾。\n\n#### 步骤3：结论与行动\n该问题被判定为**有效**，因为它具有科学依据、适定且自洽。将提供解答。\n\n### 解答\n\n在一维情况下，保守力的基本原理是作用在粒子 $i$ 上的力是总势能 $E$ 相对于其位置 $x_i$ 的负导数：$F_i = -\\frac{\\partial E}{\\partial x_i}$。对于一个只有最近邻相互作用的系统，总能量为 $E = \\sum_k E^{\\text{bond}}(x_{k+1} - x_k)$。作用在原子 $i$ 上的力来自于它所参与的两个键，即 $(i-1, i)$ 和 $(i, i+1)$。\n$$\nF_i = -\\frac{\\partial}{\\partial x_i} \\left[ E^{\\text{bond}}(x_i - x_{i-1}) + E^{\\text{bond}}(x_{i+1} - x_i) \\right]\n$$\n使用链式法则，设 $r_{i,i-1} = x_i - x_{i-1}$ 和 $r_{i+1,i} = x_{i+1} - x_i$：\n$$\nF_i = -\\left[ \\frac{dE^{\\text{bond}}(r_{i,i-1})}{dr} \\frac{\\partial r_{i,i-1}}{\\partial x_i} + \\frac{dE^{\\text{bond}}(r_{i+1,i})}{dr} \\frac{\\partial r_{i+1,i}}{\\partial x_i} \\right] = -\\left[ \\frac{dE^{\\text{bond}}(r_{i,i-1})}{dr}(1) + \\frac{dE^{\\text{bond}}(r_{i+1,i})}{dr}(-1) \\right]\n$$\n令原子间力函数为 $f(r) = -\\frac{dE^{\\text{bond}}(r)}{dr}$。那么作用在原子 $i$ 上的合力为：\n$$\nF_i = f(r_{i,i-1}) - f(r_{i+1,i})\n$$\n\n#### (a) 基于力的混合\n\n在均匀形变 $x_i = i a (1 + \\epsilon)$ 下，所有最近邻键的长度都相同：$r_{i,i-1} = r_{i+1,i} = r = a(1+\\epsilon)$。\n\n首先，我们分别计算每个模型中作用在原子 $i$ 上的力 $F_i$。\n对于MD模型，作用在原子 $i$ 上的力是 $F_i^{\\text{MD}} = f^{\\text{MD}}(r_{i,i-1}) - f^{\\text{MD}}(r_{i+1,i})$。由于所有键长都等于 $r$，我们有 $F_i^{\\text{MD}} = f^{\\text{MD}}(r) - f^{\\text{MD}}(r) = 0$。\n类似地，对于FEM模型，作用在原子 $i$ 上的力是 $F_i^{\\text{FEM}} = f^{\\text{FEM}}(r_{i,i-1}) - f^{\\text{FEM}}(r_{i+1,i})$。由于所有键长都等于 $r$，我们有 $F_i^{\\text{FEM}} = f^{\\text{FEM}}(r) - f^{\\text{FEM}}(r) = 0$。\n\n对于任何有效的原子间势，处于均匀形变下的系统都处于平衡状态，这意味着作用在任何内部原子上的合力为零。\n\n基于力的混合方案将作用在原子 $i$ 上的总力定义为：\n$$\nF_i^{\\text{tot}} = w_i F_i^{\\text{MD}} + (1 - w_i) F_i^{\\text{FEM}}\n$$\n代入结果 $F_i^{\\text{MD}} = 0$ 和 $F_i^{\\text{FEM}} = 0$：\n$$\nF_i^{\\text{tot}} = w_i (0) + (1 - w_i) (0) = 0\n$$\n这个结果对混合区域中的任何原子 $i$ 都成立，无论权重函数 $w_i$ 的值是多少。因此，在均匀形变下，基于力的混合对每个原子产生的力都为零。\n\n#### (b) 基于能量的混合\n\n在这种方案中，首先对总能量进行混合，然后推导出力。总能量由下式给出：\n$$\nE^{\\text{tot}} = \\sum_{i} \\left[ w_i E_i^{\\text{MD}} + (1 - w_i) E_i^{\\text{FEM}} \\right]\n$$\n代入每点能量的定义：\n$$\nE^{\\text{tot}} = \\sum_i \\left[ w_i \\left(\\frac{1}{2} E^{\\text{MD}}(r_{i,i-1}) + \\frac{1}{2} E^{\\text{MD}}(r_{i+1,i})\\right) + (1-w_i) \\left(\\frac{1}{2} E^{\\text{FEM}}(r_{i,i-1}) + \\frac{1}{2} E^{\\text{FEM}}(r_{i+1,i})\\right) \\right]\n$$\n我们可以按键而非按点对各项进行重组。长度为 $r_{i+1,i}$ 的、连接原子 $i$ 和 $i+1$ 的键的能量，对原子 $i$ 和原子 $i+1$ 的点能量都有贡献。将这些贡献收集起来，与键 $(i, i+1)$ 相关的总能量为：\n$$\n\\frac{1}{2} \\left[ w_i E^{\\text{MD}}(r_{i+1,i}) + (1-w_i) E^{\\text{FEM}}(r_{i+1,i}) \\right] + \\frac{1}{2} \\left[ w_{i+1} E^{\\text{MD}}(r_{i+1,i}) + (1-w_{i+1}) E^{\\text{FEM}}(r_{i+1,i}) \\right]\n$$\n$$\n= \\left(\\frac{w_i+w_{i+1}}{2}\\right) E^{\\text{MD}}(r_{i+1,i}) + \\left(1 - \\frac{w_i+w_{i+1}}{2}\\right) E^{\\text{FEM}}(r_{i+1,i})\n$$\n我们定义一个基于键的混合权重 $\\bar{w}_{i+1/2} = \\frac{w_i + w_{i+1}}{2}$。总能量可以重写为对所有键的求和：\n$$\nE^{\\text{tot}} = \\sum_i \\left[ \\bar{w}_{i+1/2} E^{\\text{MD}}(r_{i+1,i}) + (1-\\bar{w}_{i+1/2}) E^{\\text{FEM}}(r_{i+1,i}) \\right]\n$$\n作用在原子 $j$ 上的力，我们称之为鬼力 $F_j^{\\text{ghost}}$，是 $F_j^{\\text{ghost}} = -\\frac{\\partial E^{\\text{tot}}}{\\partial x_j}$。位置 $x_j$ 只影响键 $(j-1,j)$ 和 $(j,j+1)$。\n$$\nF_j^{\\text{ghost}} = -\\frac{\\partial}{\\partial x_j} \\left[ \\left(\\bar{w}_{j-1/2} E^{\\text{MD}}(r_{j,j-1}) + (1-\\bar{w}_{j-1/2}) E^{\\text{FEM}}(r_{j,j-1})\\right) + \\left(\\bar{w}_{j+1/2} E^{\\text{MD}}(r_{j+1,j}) + (1-\\bar{w}_{j+1/2}) E^{\\text{FEM}}(r_{j+1,j})\\right) \\right]\n$$\n应用链式法则，我们得到：\n$$\nF_j^{\\text{ghost}} = \\left[ \\bar{w}_{j+1/2} \\frac{dE^{\\text{MD}}(r_{j+1,j})}{dr} + (1-\\bar{w}_{j+1/2}) \\frac{dE^{\\text{FEM}}(r_{j+1,j})}{dr} \\right] - \\left[ \\bar{w}_{j-1/2} \\frac{dE^{\\text{MD}}(r_{j,j-1})}{dr} + (1-\\bar{w}_{j-1/2}) \\frac{dE^{\\text{FEM}}(r_{j,j-1})}{dr} \\right]\n$$\n在均匀形变下，$r_{j,j-1} = r_{j+1,j} = r = a(1+\\epsilon)$。表达式简化为：\n$$\nF_j^{\\text{ghost}} = \\left( \\bar{w}_{j+1/2}-\\bar{w}_{j-1/2} \\right) \\frac{dE^{\\text{MD}}(r)}{dr} + \\left( (1-\\bar{w}_{j+1/2}) - (1-\\bar{w}_{j-1/2}) \\right) \\frac{dE^{\\text{FEM}}(r)}{dr}\n$$\n$$\nF_j^{\\text{ghost}} = \\left( \\bar{w}_{j+1/2}-\\bar{w}_{j-1/2} \\right) \\left( \\frac{dE^{\\text{MD}}(r)}{dr} - \\frac{dE^{\\text{FEM}}(r)}{dr} \\right)\n$$\n现在我们计算这个乘积中的两项。首先，是键权重的差值：\n$$\n\\bar{w}_{j+1/2}-\\bar{w}_{j-1/2} = \\frac{w_j + w_{j+1}}{2} - \\frac{w_{j-1} + w_j}{2} = \\frac{w_{j+1} - w_{j-1}}{2}\n$$\n鉴于权重的线性变化，$w_{i+1} - w_i = s$。这意味着 $w_{j+1} = w_j + s$ 和 $w_{j-1} = w_j - s$。因此，$w_{j+1} - w_{j-1} = (w_j+s) - (w_j-s) = 2s$。\n$$\n\\bar{w}_{j+1/2}-\\bar{w}_{j-1/2} = \\frac{2s}{2} = s\n$$\n接下来，是能量导数的差值（它代表键中的柯西应力）：\n$$\n\\frac{dE^{\\text{MD}}(r)}{dr} = \\frac{d}{dr} \\left[ \\frac{1}{2} k (r-a)^2 + \\frac{1}{3} \\alpha (r-a)^3 \\right] = k(r-a) + \\alpha(r-a)^2\n$$\n$$\n\\frac{dE^{\\text{FEM}}(r)}{dr} = \\frac{d}{dr} \\left[ \\frac{1}{2} k (r-a)^2 \\right] = k(r-a)\n$$\n差值为：\n$$\n\\frac{dE^{\\text{MD}}(r)}{dr} - \\frac{dE^{\\text{FEM}}(r)}{dr} = \\alpha(r-a)^2\n$$\n代入 $r = a(1+\\epsilon)$，我们得到 $r-a = a\\epsilon$。该差值变为 $\\alpha(a\\epsilon)^2 = \\alpha a^2 \\epsilon^2$。\n最后，将所有部分组合起来，作用在原子 $j$ 上的鬼力为：\n$$\nF_j^{\\text{ghost}} = (s) \\times (\\alpha a^2 \\epsilon^2) = s \\alpha a^2 \\epsilon^2\n$$\n这个表达式与原子索引 $j$ 无关，这意味着对于权重函数具有恒定斜率 $s$ 的混合区域内的所有原子，鬼力是恒定的。该力取决于混合函数的梯度 $s$、非线性失配 $\\alpha$、晶格参数 $a$ 和应变 $\\epsilon$。它与谐波刚度 $k$ 无关。",
            "answer": "$$\\boxed{s \\alpha a^{2} \\epsilon^{2}}$$"
        }
    ]
}