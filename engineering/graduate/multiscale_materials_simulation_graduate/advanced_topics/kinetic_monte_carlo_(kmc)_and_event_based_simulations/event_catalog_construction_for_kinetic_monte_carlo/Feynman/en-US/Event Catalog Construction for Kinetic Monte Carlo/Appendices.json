{
    "hands_on_practices": [
        {
            "introduction": "The foundation of a physically meaningful Kinetic Monte Carlo catalog is its adherence to the principles of thermodynamic equilibrium. This exercise reinforces the concept of detailed balance, which ensures that the ratio of forward and reverse transition rates correctly reproduces the Boltzmann distribution of states. By working through this problem , you will derive the crucial relationship between the activation barriers for a transition and its reverse, a cornerstone for constructing self-consistent event catalogs.",
            "id": "3807561",
            "problem": "In event catalog construction for Kinetic Monte Carlo (KMC), each transition between two metastable states must have a rate expression that satisfies equilibrium thermodynamics and microscopic reversibility. Consider two local minima, labeled $i$ and $j$, with Helmholtz free energies $F_i$ and $F_j$ at temperature $T$. The free energy difference is defined as $\\Delta F = F_j - F_i$. From a Nudged Elastic Band (NEB) calculation, you have obtained the activation free energy barrier for the transition $j \\rightarrow i$, denoted $E_a^{j \\rightarrow i}$. Using canonical Transition State Theory (TST) and the condition of detailed balance in the canonical ensemble, derive the expression for the activation free energy barrier for the transition $i \\rightarrow j$, denoted $E_a^{i \\rightarrow j}$, in terms of $\\Delta F$, $E_a^{j \\rightarrow i}$, and the ratio of the TST vibrational prefactors. Then evaluate $E_a^{i \\rightarrow j}$ numerically for the following physically consistent data:\n- Temperature $T = 600\\,\\text{K}$,\n- Free energy difference $\\Delta F = 0.128\\,\\text{eV}$,\n- Activation barrier $E_a^{j \\rightarrow i} = 0.746\\,\\text{eV}$,\n- Assume the TST vibrational attempt frequencies for both directions are equal due to similar local vibrational spectra.\n\nExpress the final energy in eV and round your answer to four significant figures. In your reasoning, state clearly any assumptions about the prefactors and their implications for detailed balance.",
            "solution": "The problem requires the derivation of an expression for an activation free energy barrier and its subsequent numerical evaluation. This is a valid problem grounded in the principles of statistical mechanics and chemical kinetics.\n\nThe rate of a thermally activated transition between two states, say from state $A$ to state $B$, can be described by canonical Transition State Theory (TST). The rate constant, $k_{A \\rightarrow B}$, is given by the Arrhenius-like expression:\n$$k_{A \\rightarrow B} = \\nu_{A \\rightarrow B} \\exp\\left(-\\frac{E_a^{A \\rightarrow B}}{k_B T}\\right)$$\nwhere $\\nu_{A \\rightarrow B}$ is the attempt frequency or pre-exponential factor, $E_a^{A \\rightarrow B}$ is the activation free energy barrier for the transition, $k_B$ is the Boltzmann constant, and $T$ is the absolute temperature.\n\nFor the specific transitions between states $i$ and $j$, the forward ($i \\rightarrow j$) and reverse ($j \\rightarrow i$) rates are:\n$$k_{i \\rightarrow j} = \\nu_{i \\rightarrow j} \\exp\\left(-\\frac{E_a^{i \\rightarrow j}}{k_B T}\\right)$$\n$$k_{j \\rightarrow i} = \\nu_{j \\rightarrow i} \\exp\\left(-\\frac{E_a^{j \\rightarrow i}}{k_B T}\\right)$$\n\nAt thermodynamic equilibrium, the principle of detailed balance must hold. This principle states that the total rate of transitions from state $i$ to state $j$ is equal to the total rate of transitions from state $j$ to state $i$. In the canonical ensemble, this is expressed as:\n$$P_i k_{i \\rightarrow j} = P_j k_{j \\rightarrow i}$$\nwhere $P_i$ and $P_j$ are the equilibrium probabilities of the system being in state $i$ and state $j$, respectively. The probability of occupying a state with Helmholtz free energy $F$ is proportional to the Boltzmann factor, $\\exp(-F / (k_B T))$. Therefore, the ratio of the probabilities is:\n$$\\frac{P_j}{P_i} = \\frac{\\exp\\left(-\\frac{F_j}{k_B T}\\right)}{\\exp\\left(-\\frac{F_i}{k_B T}\\right)} = \\exp\\left(-\\frac{F_j - F_i}{k_B T}\\right)$$\nUsing the given definition $\\Delta F = F_j - F_i$, this becomes:\n$$\\frac{P_j}{P_i} = \\exp\\left(-\\frac{\\Delta F}{k_B T}\\right)$$\n\nFrom the detailed balance equation, we can write the ratio of the rate constants as:\n$$\\frac{k_{i \\rightarrow j}}{k_{j \\rightarrow i}} = \\frac{P_j}{P_i} = \\exp\\left(-\\frac{\\Delta F}{k_B T}\\right)$$\n\nNow, we substitute the TST expressions for the rates into this equation:\n$$\\frac{\\nu_{i \\rightarrow j} \\exp\\left(-\\frac{E_a^{i \\rightarrow j}}{k_B T}\\right)}{\\nu_{j \\rightarrow i} \\exp\\left(-\\frac{E_a^{j \\rightarrow i}}{k_B T}\\right)} = \\exp\\left(-\\frac{\\Delta F}{k_B T}\\right)$$\n\nWe can rearrange the terms to group the exponentials:\n$$\\frac{\\nu_{i \\rightarrow j}}{\\nu_{j \\rightarrow i}} \\exp\\left(-\\frac{E_a^{i \\rightarrow j} - E_a^{j \\rightarrow i}}{k_B T}\\right) = \\exp\\left(-\\frac{\\Delta F}{k_B T}\\right)$$\n\nTo solve for $E_a^{i \\rightarrow j}$, we take the natural logarithm of both sides:\n$$\\ln\\left(\\frac{\\nu_{i \\rightarrow j}}{\\nu_{j \\rightarrow i}}\\right) - \\frac{E_a^{i \\rightarrow j} - E_a^{j \\rightarrow i}}{k_B T} = -\\frac{\\Delta F}{k_B T}$$\n\nMultiplying through by $-k_B T$ gives:\n$$-k_B T \\ln\\left(\\frac{\\nu_{i \\rightarrow j}}{\\nu_{j \\rightarrow i}}\\right) + E_a^{i \\rightarrow j} - E_a^{j \\rightarrow i} = \\Delta F$$\n\nFinally, we isolate $E_a^{i \\rightarrow j}$ to obtain the general expression:\n$$E_a^{i \\rightarrow j} = E_a^{j \\rightarrow i} + \\Delta F + k_B T \\ln\\left(\\frac{\\nu_{i \\rightarrow j}}{\\nu_{j \\rightarrow i}}\\right)$$\nThis expression relates the activation barriers for the forward and reverse transitions to the overall free energy change and the ratio of pre-exponential factors.\n\nThe problem makes a specific assumption: \"the TST vibrational attempt frequencies for both directions are equal due to similar local vibrational spectra.\" This implies $\\nu_{i \\rightarrow j} = \\nu_{j \\rightarrow i}$. Under this assumption, the ratio of the prefactors is $\\frac{\\nu_{i \\rightarrow j}}{\\nu_{j \\rightarrow i}} = 1$. The logarithmic term thus becomes $\\ln(1) = 0$. This simplification is common when the local atomic environments of the initial and final states are very similar, leading to nearly identical vibrational density of states around the minima.\nWith this assumption, the expression for the activation barrier simplifies to:\n$$E_a^{i \\rightarrow j} = E_a^{j \\rightarrow i} + \\Delta F$$\nThis relationship is a direct consequence of detailed balance and is often depicted in reaction coordinate diagrams, where the difference in activation barriers must equal the difference in the energies of the initial and final states.\n\nNow, we perform the numerical evaluation using the provided data:\n- Free energy difference $\\Delta F = 0.128\\,\\text{eV}$\n- Activation barrier $E_a^{j \\rightarrow i} = 0.746\\,\\text{eV}$\n\nSubstituting these values into the simplified expression:\n$$E_a^{i \\rightarrow j} = 0.746\\,\\text{eV} + 0.128\\,\\text{eV}$$\n$$E_a^{i \\rightarrow j} = 0.874\\,\\text{eV}$$\n\nThe problem requires the answer to be expressed in eV and rounded to four significant figures. The calculated value is $0.874$. To express this to four significant figures, we append a zero, yielding $0.8740$. The temperature $T = 600\\,\\text{K}$ was not needed for the final calculation due to the assumption of equal prefactors but was necessary for the complete theoretical context.",
            "answer": "$$\n\\boxed{0.8740}\n$$"
        },
        {
            "introduction": "While transition state theory provides the framework for event rates, the activation barriers themselves must be computed from an underlying atomistic model, often using methods like the Nudged Elastic Band (NEB). This practice provides a hands-on look at a critical data processing step: extracting a precise activation barrier from the discrete energy profile generated by an NEB calculation. By applying numerical interpolation, you will learn how to overcome the limitations of a discretized reaction path and obtain a robust estimate for the saddle point energy .",
            "id": "3807534",
            "problem": "A discretized minimum energy path computed by the Nudged Elastic Band (NEB) method for a point-defect hop in a crystalline solid has been converged to small perpendicular forces along the path. The reaction coordinate $s$ has been normalized to the interval $[0,1]$. The event catalog in Kinetic Monte Carlo (KMC) requires the activation barrier for the hop, defined theoretically as the difference between the saddle-point energy along the minimum energy path and the energy of the initial state. Starting from the perspective of Transition State Theory (TST) and the definition of a minimum energy path, use the given NEB data to determine the barrier.\n\nYou are given the following discrete image positions $s_i$ and their corresponding energies $E(s_i)$ relative to the initial state:\n\n- $i=0$: $s_0=0.00$, $E(s_0)=0.000\\,\\text{eV}$\n- $i=1$: $s_1=0.07$, $E(s_1)=0.118\\,\\text{eV}$\n- $i=2$: $s_2=0.15$, $E(s_2)=0.255\\,\\text{eV}$\n- $i=3$: $s_3=0.25$, $E(s_3)=0.410\\,\\text{eV}$\n- $i=4$: $s_4=0.37$, $E(s_4)=0.570\\,\\text{eV}$\n- $i=5$: $s_5=0.52$, $E(s_5)=0.690\\,\\text{eV}$\n- $i=6$: $s_6=0.66$, $E(s_6)=0.755\\,\\text{eV}$\n- $i=7$: $s_7=0.77$, $E(s_7)=0.780\\,\\text{eV}$\n- $i=8$: $s_8=0.86$, $E(s_8)=0.770\\,\\text{eV}$\n- $i=9$: $s_9=0.93$, $E(s_9)=0.720\\,\\text{eV}$\n- $i=10$: $s_{10}=1.00$, $E(s_{10})=0.695\\,\\text{eV}$\n\nTo mitigate the effect of finite image discretization, estimate the continuous maximum energy along the band by performing a local quadratic interpolation using the three highest-energy images in the vicinity of the peak. Then compute the activation barrier as the difference between this interpolated maximum energy and the initial state energy.\n\nAdditionally, in your derivation, discuss a principled way to estimate the uncertainty in the barrier due to finite discretization of images, starting from smoothness assumptions on $E(s)$ near the maximum and expressing any bounds in terms of the local curvature and the image spacing.\n\nExpress the final barrier in electronvolts (eV) and round your answer to four significant figures.",
            "solution": "The problem requires the calculation of an activation barrier for a point-defect hop using discrete energy-path data from a Nudged Elastic Band (NEB) calculation. The activation barrier, $E_{barrier}$, is defined within Transition State Theory (TST) as the energy difference between the saddle point of the minimum energy path (MEP), $E_{saddle}$, and the initial stable state, $E_{initial}$.\n$$ E_{barrier} = E_{saddle} - E_{initial} $$\nThe provided data consists of a set of $N=11$ discrete points, or images, $(s_i, E(s_i))$, where $s_i$ is the normalized reaction coordinate and $E(s_i)$ is the energy relative to the initial state. The initial state is given as image $i=0$, for which $s_0=0.00$ and $E(s_0)=0.000\\,\\text{eV}$. Therefore, $E_{initial} = 0.000\\,\\text{eV}$, and the activation barrier is numerically equal to the saddle point energy, $E_{barrier} = E_{saddle}$.\n\nThe saddle point corresponds to the maximum energy along the MEP. Since the path is represented by a discrete set of images, the true maximum might lie between images. The problem specifies a local quadratic interpolation using the three highest-energy images to estimate the continuous maximum.\n\nFirst, we identify the three images with the highest energies from the provided data:\n- Image $i=6$: $(s_6, E_6) = (0.66, 0.755\\,\\text{eV})$\n- Image $i=7$: $(s_7, E_7) = (0.77, 0.780\\,\\text{eV})$\n- Image $i=8$: $(s_8, E_8) = (0.86, 0.770\\,\\text{eV})$\n\nImage $i=7$ has the highest energy of all discrete points, so the true saddle point is expected to be in its vicinity. We will fit a quadratic polynomial, $E(s) = A s^2 + B s + C$, to these three points.\n\nFor computational convenience, we shift the coordinate system so that the middle point, $(s_7, E_7)$, is at the origin of the new coordinate $s'$. Let $s' = s - s_7 = s - 0.77$. The three points in the $(s', E)$ coordinate system are:\n- $(s_6 - s_7, E_6) = (0.66 - 0.77, 0.755) = (-0.11, 0.755)$\n- $(s_7 - s_7, E_7) = (0, 0.780)$\n- $(s_8 - s_7, E_8) = (0.86 - 0.77, 0.770) = (0.09, 0.770)$\n\nThe interpolating parabola is now $E(s') = A (s')^2 + B s' + C$. Using the point $(0, 0.780)$, we immediately find $C = 0.780\\,\\text{eV}$.\nWe use the other two points to form a system of two linear equations for $A$ and $B$:\n$$\n\\begin{cases}\nA(-0.11)^2 + B(-0.11) + 0.780 = 0.755 \\\\\nA(0.09)^2 + B(0.09) + 0.780 = 0.770\n\\end{cases}\n$$\nThis simplifies to:\n$$\n\\begin{cases}\n0.0121 A - 0.11 B = -0.025 \\\\\n0.0081 A + 0.09 B = -0.010\n\\end{cases}\n$$\nTo solve this system, we can multiply the first equation by $0.09$ and the second equation by $0.11$:\n$$\n\\begin{cases}\n0.001089 A - 0.0099 B = -0.00225 \\\\\n0.000891 A + 0.0099 B = -0.00110\n\\end{cases}\n$$\nAdding the two new equations eliminates $B$:\n$$ (0.001089 + 0.000891) A = -0.00225 - 0.00110 $$\n$$ 0.00198 A = -0.00335 $$\n$$ A = -\\frac{0.00335}{0.00198} \\approx -1.691919... $$\nNow, we substitute $A$ back into the second equation to find $B$:\n$$ B = \\frac{-0.010 - 0.0081 A}{0.09} = \\frac{-0.010 - 0.0081(-1.691919...)}{0.09} = \\frac{-0.010 + 0.013704545...}{0.09} $$\n$$ B = \\frac{0.003704545...}{0.09} \\approx 0.041161616... $$\nThe vertex of the parabola $E(s') = A(s')^2 + B s' + C$ occurs at $s'_{max} = -B/(2A)$, and the maximum energy is $E_{saddle} = E(s'_{max}) = C - B^2/(4A)$.\nPlugging in the values for $A$, $B$, and $C$:\n$$ E_{saddle} = 0.780 - \\frac{(0.041161616...)^2}{4(-1.691919...)} = 0.780 - \\frac{0.00169427...}{-6.767676...} $$\n$$ E_{saddle} = 0.780 + 0.00025033... \\approx 0.78025033\\,\\text{eV} $$\nThe activation barrier is then:\n$$ E_{barrier} = E_{saddle} - E_{initial} = 0.78025033\\,\\text{eV} - 0.000\\,\\text{eV} = 0.78025033\\,\\text{eV} $$\nRounding to four significant figures, we get $E_{barrier} = 0.7803\\,\\text{eV}$.\n\nThe problem also asks for a discussion on estimating the uncertainty due to finite discretization. The error in estimating the saddle point energy arises because the true energy profile $E(s)$ is generally not a perfect quadratic function. The deviation from a quadratic form can be understood by considering the Taylor series of $E(s)$ around the true saddle point $s_{sp}$:\n$$ E(s) = E(s_{sp}) + \\frac{1}{2} E''(s_{sp})(s-s_{sp})^2 + \\frac{1}{6} E'''(s_{sp})(s-s_{sp})^3 + \\frac{1}{24} E^{(4)}(s_{sp})(s-s_{sp})^4 + \\dots $$\nAt the saddle point, $E'(s_{sp})=0$. The quadratic interpolation is exact if $E(s)$ is purely quadratic (i.e., all derivatives of order $3$ and higher are zero). The error in the interpolated saddle energy, $\\Delta E_{error} = E_{saddle}^{interp} - E(s_{sp})$, is therefore dependent on these higher-order derivatives. Assuming the path is reasonably symmetric near the saddle, the cubic term $E'''(s_{sp})$ is small, and the dominant source of error comes from the quartic term, characterized by $E^{(4)}(s_{sp})$.\n\nA formal analysis shows that the error of the quadratic interpolation method scales with the fourth power of the image spacing, $\\Delta s$. Specifically, the error is proportional to the product of the fourth derivative of the energy and the fourth power of the spacing:\n$$ \\Delta E_{error} \\propto E^{(4)}(s_{sp}) (\\Delta s)^4 $$\nThis provides a principled basis for uncertainty estimation: the error is smaller for smoother potentials (smaller $E^{(4)}$) and for denser image discretization (smaller $\\Delta s$).\n\nA practical, robust method to estimate this uncertainty is to perform a convergence study. One would recompute the barrier with a higher density of images, for instance, by halving the spacing to $\\Delta s/2$ in the vicinity of the saddle point. Let the barrier computed with spacing $\\Delta s$ be $E_{barrier}(\\Delta s)$ and with spacing $\\Delta s/2$ be $E_{barrier}(\\Delta s/2)$. The true barrier is $E_{true}$. The errors are:\n$$ E_{barrier}(\\Delta s) - E_{true} \\approx K (\\Delta s)^4 $$\n$$ E_{barrier}(\\Delta s/2) - E_{true} \\approx K (\\Delta s/2)^4 = \\frac{1}{16} K (\\Delta s)^4 $$\nThe difference between the two computed values is:\n$$ E_{barrier}(\\Delta s) - E_{barrier}(\\Delta s/2) \\approx \\frac{15}{16} K (\\Delta s)^4 $$\nThe error in the more accurate calculation, $\\epsilon(\\Delta s/2) = E_{barrier}(\\Delta s/2) - E_{true}$, can thus be estimated using Richardson extrapolation:\n$$ \\epsilon(\\Delta s/2) \\approx \\frac{1}{15} \\left( E_{barrier}(\\Delta s) - E_{barrier}(\\Delta s/2) \\right) $$\nThis result provides a quantitative estimate of the discretization error, grounded in the smoothness of the energy function $E(s)$ and the systematic convergence of the interpolation scheme.",
            "answer": "$$\\boxed{0.7803}$$"
        },
        {
            "introduction": "An event catalog is more than just a list of barriers; it is a map that connects every possible local atomic environment to the set of events that can occur from it. This exercise walks you through the systematic construction of such a catalog for a model system, demonstrating how to enumerate and classify local configurations, or motifs, by leveraging lattice symmetry. You will then associate these unique motifs with their corresponding events and calculate their rates, completing the workflow for building a foundational KMC event catalog from scratch .",
            "id": "3807512",
            "problem": "Consider a two-dimensional square lattice and the construction of an event catalog for Kinetic Monte Carlo (KMC). The central task is to enumerate local atomic neighborhood motifs up to a geometric cutoff and associate each motif with allowed vacancy-exchange events and their rates. Base your derivation and algorithm on fundamental definitions from Transition State Theory (TST) and lattice symmetry. \n\nFundamental base:\n- Transition State Theory (TST): the event rate is $k = \\nu \\exp\\!\\big(-E_b/(k_B T)\\big)$, where $\\nu$ is the attempt frequency, $E_b$ is the activation barrier, $k_B$ is the Boltzmann constant, and $T$ is the temperature.\n- Lattice symmetry: the square lattice has the dihedral symmetry group of order eight ($D_4$), consisting of four rotations ($0^\\circ$, $90^\\circ$, $180^\\circ$, $270^\\circ$) and four reflections (e.g., a reflection across the $x$-axis composed with each rotation). Two local motifs related by an element of $D_4$ are physically equivalent and must be treated as the same class in the catalog.\n\nGeometry and representation:\n- Consider the central lattice site to be a vacancy. Define a geometric cutoff $r_c = \\sqrt{2}$ (in lattice units), which includes the first and second neighbor shells around the central site:\n  - First shell (distance $1$): positions with displacement vectors $\\{(0,1),(1,0),(0,-1),(-1,0)\\}$.\n  - Second shell (distance $\\sqrt{2}$): positions with displacement vectors $\\{(1,1),(1,-1),(-1,-1),(-1,1)\\}$.\n- Represent a local motif $\\mathbf{m}$ as an $8$-component binary vector $\\mathbf{m} = (m_0,m_1,m_2,m_3,m_4,m_5,m_6,m_7)$, indicating occupancy of these neighbor positions, ordered as $\\{(0,1),(1,0),(0,-1),(-1,0),(1,1),(1,-1),(-1,-1),(-1,1)\\}$ respectively, where $m_i \\in \\{0,1\\}$ denotes unoccupied or occupied.\n- Motif equivalence under $D_4$: define the action of each symmetry operation on the displacement vectors and permute the components of $\\mathbf{m}$ accordingly. The canonical representative of a motif class is defined as the lexicographically smallest vector among all $8$ symmetry-transformed variants of $\\mathbf{m}$.\n\nEvents and barriers:\n- Allowed events are vacancy exchanges between the central vacancy and any occupied first-shell neighbor. That is, for each first-shell direction $d \\in \\{(0,1),(1,0),(0,-1),(-1,0)\\}$ where the corresponding component of $\\mathbf{m}$ is $1$, an event is allowed.\n- Assign activation barriers using a physically motivated local crowding model:\n  - For a hop in direction $d$, let $n_2(d)$ be the number of occupied second-shell neighbors adjacent to the hop path, and let $n_1^{\\parallel}(d)$ be the number of occupied first-shell neighbors lateral to the hop path. Specifically:\n    - For $d=(0,1)$ (north), adjacent second neighbors are $(1,1)$ and $(-1,1)$, and lateral first neighbors are $(1,0)$ and $(-1,0)$.\n    - For $d=(1,0)$ (east), adjacent second neighbors are $(1,1)$ and $(1,-1)$, and lateral first neighbors are $(0,1)$ and $(0,-1)$.\n    - For $d=(0,-1)$ (south), adjacent second neighbors are $(1,-1)$ and $(-1,-1)$, and lateral first neighbors are $(1,0)$ and $(-1,0)$.\n    - For $d=(-1,0)$ (west), adjacent second neighbors are $(-1,1)$ and $(-1,-1)$, and lateral first neighbors are $(0,1)$ and $(0,-1)$.\n  - Use the barrier model $E_b(d) = E_0 + \\alpha\\, n_2(d) + \\beta\\, n_1^{\\parallel}(d)$, with constants $E_0 = 0.6\\,\\mathrm{eV}$, $\\alpha = 0.05\\,\\mathrm{eV}$, $\\beta = 0.02\\,\\mathrm{eV}$.\n- The event rate is $k(d) = \\nu \\exp\\!\\big(-E_b(d)/(k_B T)\\big)$, with $\\nu = 10^{13}\\,\\mathrm{s}^{-1}$ and $k_B = 8.617333262145\\times 10^{-5}\\,\\mathrm{eV}/\\mathrm{K}$. Express all rates in $\\mathrm{s}^{-1}$.\n\nProgram requirements:\n- For each test case, you are given a set of motifs (as lists of eight binary entries in the fixed order above) and a temperature $T$ (in $\\mathrm{K}$). Your program must:\n  $1.$ Canonicalize each motif under $D_4$ and count the number of distinct motif classes present.\n  $2.$ Enumerate all allowed events (vacancy exchanges with occupied first-shell neighbors) across the motifs and count the total number of events.\n  $3.$ Compute the sum of the event rates $k(d)$ across all allowed events in all motifs.\n- Final output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each test case, output three numbers in order: the integer number of distinct motif classes, the integer number of allowed events, and the summed event rate rounded to six decimal places in $\\mathrm{s}^{-1}$. Concatenate these triples for all test cases into a single list. For example, a valid output may look like $[a_1,b_1,c_1,a_2,b_2,c_2,\\dots]$.\n\nTest suite:\n- Use the following test cases (each motif listed in the fixed order $\\{(0,1),(1,0),(0,-1),(-1,0),(1,1),(1,-1),(-1,-1),(-1,1)\\}$):\n  $1.$ Temperature $T=300\\,\\mathrm{K}$ with motifs:\n    - $\\mathbf{m}^{(1)} = (0,0,0,0,0,0,0,0)$\n    - $\\mathbf{m}^{(2)} = (1,0,0,0,0,0,0,0)$\n    - $\\mathbf{m}^{(3)} = (0,1,0,0,0,0,0,0)$\n    - $\\mathbf{m}^{(4)} = (0,0,0,0,1,0,0,1)$\n  $2.$ Temperature $T=600\\,\\mathrm{K}$ with motifs:\n    - $\\mathbf{m}^{(5)} = (1,1,1,1,0,0,0,0)$\n    - $\\mathbf{m}^{(6)} = (1,1,0,0,1,0,1,0)$\n    - $\\mathbf{m}^{(7)} = (1,0,1,0,0,1,0,1)$\n  $3.$ Temperature $T=1000\\,\\mathrm{K}$ with motifs:\n    - $\\mathbf{m}^{(8)} = (1,0,1,0,1,1,1,1)$\n    - $\\mathbf{m}^{(9)} = (0,0,0,0,1,0,1,0)$\n    - $\\mathbf{m}^{(10)} = (1,1,1,0,0,1,0,1)$\n\nAnswer specification:\n- Units: All rates must be reported in $\\mathrm{s}^{-1}$.\n- Angle unit: All rotations are understood in radians internally, but the description uses degrees; no angle values are part of the program output.\n- Percentages: Not applicable.\n- Output rounding: Round each summed rate to six decimal places before output.\n- Final output format: A single line, containing a bracketed comma-separated list with the three results per test case sequenced as $[a_1,b_1,c_1,a_2,b_2,c_2,a_3,b_3,c_3]$.",
            "solution": "The problem is assessed to be valid as it is scientifically grounded, self-contained, well-posed, and free of contradictions or ambiguities. It presents a standard, albeit detailed, problem in the field of computational materials science, specifically related to the setup of Kinetic Monte Carlo (KMC) simulations. We shall proceed with a complete solution.\n\nThe solution involves three main steps for each test case:\n1.  **Symmetry Canonicalization**: For each given local atomic configuration (motif), we must find its canonical representation. This is achieved by applying all symmetry operations of the square lattice's point group, $D_4$, and selecting the lexicographically smallest resulting configuration. This process allows us to identify and count the number of unique physical motif classes.\n2.  **Event Enumeration**: We must identify all possible physical events for each motif. The problem defines events as exchanges between the central vacancy and an occupied nearest-neighbor atom.\n3.  **Rate Calculation**: For each identified event, we calculate its rate using the provided Transition State Theory (TST) formula, $k = \\nu \\exp(-E_b/(k_B T))$, and the specified physical model for the activation energy barrier, $E_b$.\n\nWe will now detail the implementation of these steps.\n\n### 1. Symmetry Operations and Canonicalization\n\nThe local neighborhood is represented by an $8$-component binary vector $\\mathbf{m} = (m_0, \\dots, m_7)$, where each component corresponds to the occupancy of a specific neighbor site. The sites are ordered as:\n- $m_0$: N $(0,1)$\n- $m_1$: E $(1,0)$\n- $m_2$: S $(0,-1)$\n- $m_3$: W $(-1,0)$\n- $m_4$: NE $(1,1)$\n- $m_5$: SE $(1,-1)$\n- $m_6$: SW $(-1,-1)$\n- $m_7$: NW $(-1,1)$\n\nThe symmetry group of the square lattice is the dihedral group $D_4$, which has $8$ elements: four rotations ($R_0, R_{90}, R_{180}, R_{270}$) and four reflections. We define the action of each symmetry operation as a permutation on the indices $\\{0, \\dots, 7\\}$ of the motif vector $\\mathbf{m}$. An operation transforms a motif $\\mathbf{m}$ into a new motif $\\mathbf{m}'$ where the atom at site $i$ in $\\mathbf{m}$ is moved to site $p(i)$ in $\\mathbf{m}'$. This corresponds to the permutation rule $\\mathbf{m}'_{p(i)} = \\mathbf{m}_i$. The $8$ permutations $(p_0, \\dots, p_7)$ are derived by considering the geometric transformation of the neighbor coordinates:\n\n- $R_0$ (Identity, $0^\\circ$ rotation): $(x,y) \\to (x,y)$. Permutation: $(0, 1, 2, 3, 4, 5, 6, 7)$.\n- $R_{90}$ ($90^\\circ$ counter-clockwise rotation): $(x,y) \\to (-y,x)$. Permutation: $(3, 0, 1, 2, 7, 4, 5, 6)$.\n- $R_{180}$ ($180^\\circ$ rotation): $(x,y) \\to (-x,-y)$. Permutation: $(2, 3, 0, 1, 6, 7, 4, 5)$.\n- $R_{270}$ ($270^\\circ$ counter-clockwise rotation): $(x,y) \\to (y,-x)$. Permutation: $(1, 2, 3, 0, 5, 6, 7, 4)$.\n- $S_x$ (Reflection across x-axis): $(x,y) \\to (x,-y)$. Permutation: $(2, 1, 0, 3, 5, 4, 7, 6)$.\n- $S_x \\circ R_{90}$ (Reflection across $y=-x$ line): Permutation: $(3, 2, 1, 0, 6, 5, 4, 7)$.\n- $S_x \\circ R_{180}$ (Reflection across y-axis, $S_y$): Permutation: $(0, 3, 2, 1, 7, 6, 5, 4)$.\n- $S_x \\circ R_{270}$ (Reflection across $y=x$ line): Permutation: $(1, 0, 3, 2, 4, 7, 6, 5)$.\n\nFor any given motif $\\mathbf{m}$, we generate all $8$ (not necessarily unique) variants by applying these permutations. The canonical representative for the class to which $\\mathbf{m}$ belongs is the lexicographically smallest among these $8$ variants. To count the number of distinct motif classes in a test case, we canonicalize each input motif and count the number of unique canonical forms using a set data structure.\n\n### 2. and 3. Event Enumeration and Rate Calculation\n\nAn event is a jump of an atom from an occupied first-neighbor site into the central vacancy. The first-neighbor sites correspond to indices $0, 1, 2, 3$ in the motif vector. Thus, for a given motif $\\mathbf{m}$, we iterate through $i \\in \\{0, 1, 2, 3\\}$. If $m_i=1$, an event is allowed. The total number of events is the sum of such allowed jumps over all motifs provided in a test case.\n\nThe rate for each event is given by $k = \\nu \\exp(-E_b / (k_B T))$. The constants are given as $\\nu = 10^{13}\\,\\mathrm{s}^{-1}$ and $k_B=8.617333262145 \\times 10^{-5}\\,\\mathrm{eV/K}$. The activation barrier $E_b$ depends on the local environment via the formula $E_b(d) = E_0 + \\alpha\\, n_2(d) + \\beta\\, n_1^{\\parallel}(d)$, with $E_0=0.6\\,\\mathrm{eV}$, $\\alpha=0.05\\,\\mathrm{eV}$, and $\\beta=0.02\\,\\mathrm{eV}$. Here, $d$ is the hop direction, $n_2(d)$ is the number of occupied second-shell neighbors adjacent to the hop path, and $n_1^{\\parallel}(d)$ is the number of occupied first-shell neighbors lateral to it.\n\nWe implement this by defining the neighbor relationships in terms of vector indices:\n- **Hop N (direction of site 0)**:\n  - $n_1^{\\parallel}$: sites E(1) and W(3). $n_1^{\\parallel} = m_1 + m_3$.\n  - $n_2$: sites NE(4) and NW(7). $n_2 = m_4 + m_7$.\n- **Hop E (direction of site 1)**:\n  - $n_1^{\\parallel}$: sites N(0) and S(2). $n_1^{\\parallel} = m_0 + m_2$.\n  - $n_2$: sites NE(4) and SE(5). $n_2 = m_4 + m_5$.\n- **Hop S (direction of site 2)**:\n  - $n_1^{\\parallel}$: sites E(1) and W(3). $n_1^{\\parallel} = m_1 + m_3$.\n  - $n_2$: sites SE(5) and SW(6). $n_2 = m_5 + m_6$.\n- **Hop W (direction of site 3)**:\n  - $n_1^{\\parallel}$: sites N(0) and S(2). $n_1^{\\parallel} = m_0 + m_2$.\n  - $n_2$: sites SW(6) and NW(7). $n_2 = m_6 + m_7$.\n\nFor each motif in a test case, we check for allowed events. For each allowed event, we calculate its specific barrier $E_b$ based on the motif's full configuration, compute the corresponding rate $k$, and add it to a running total for the test case.\n\n### 3. Final Algorithm\n\nThe overall procedure for each test case is:\n1.  Initialize a set for canonical classes `canonical_classes`, an integer for event count `total_events = 0`, and a float for the rate sum `total_rate = 0.0`.\n2.  For each motif $\\mathbf{m}$ in the input list:\n    a. Determine the canonical form of $\\mathbf{m}$ by generating all $8$ symmetric variants and finding the lexicographical minimum. Add this canonical form to `canonical_classes`.\n    b. Check the first four components of $\\mathbf{m}$ ($m_0, m_1, m_2, m_3$).\n    c. For each $m_i=1$ where $i \\in \\{0,1,2,3\\}$:\n        i. Increment `total_events`.\n        ii. Calculate $n_1^{\\parallel}$ and $n_2$ according to the hop direction $i$.\n        iii. Calculate $E_b = E_0 + \\alpha n_2 + \\beta n_1^{\\parallel}$.\n        iv. Calculate $k = \\nu \\exp(-E_b / (k_B T))$.\n        v. Add $k$ to `total_rate`.\n3.  The results for the test case are: the size of `canonical_classes`, the final `total_events`, and `total_rate` rounded to six decimal places. These three values are appended to a global results list.\n4. After processing all test cases, the final output is a single formatted string containing all collected results.",
            "answer": "[3,2,168.807804,3,8,133319011.603375,3,5,1529559515.186362]"
        }
    ]
}