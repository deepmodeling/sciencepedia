{
    "hands_on_practices": [
        {
            "introduction": "在构建动力学蒙特卡洛（KMC）模拟时，一个关键的优化步骤是将对称等价的微观事件归为一个事件类别，以减小事件目录的规模并提高计算效率。这个练习将指导您应用群论中的概念来确定一个事件类型的多重性因子，并推导出其在模拟中使用的有效速率。通过这个实践，您将掌握在自适应 KMC 中处理对称性的基本技能，这是确保模拟既准确又高效的重要一步 。",
            "id": "3789841",
            "problem": "考虑一个带有“在线事件发现”（On-The-Fly Event Discovery）功能的自适应动力学蒙特卡洛（AKMC）模拟，其中系统是一个晶格常数为 $a$ 的二维方格晶格表面，在原点处有一个吸附原子。在没有外场的情况下，局域位点对称性为点群 $C_{4v}$，但一个沿 $y$ 方向施加的单轴应变场将剩余位点对称性降低为作用于吸附原子局域邻域的点群 $C_{2v}$。剩余的 $C_{2v}$ 群包含恒等元 $E$、绕原点的二重旋转 $C_{2}$ 以及分别穿过 $x$ 轴和 $y$ 轴的镜面反射 $\\sigma_{x}$ 和 $\\sigma_{y}$。\n\n“在线事件发现”找到了吸附原子沿 $x$ 方向（从 $(0,0)$ 到 $(a,0)$ 或 $(-a,0)$）越过桥式鞍点的最近邻跃迁的过渡态。在给定的剩余 $C_{2v}$ 对称性和施加的应变场下，所有沿 $\\pm x$ 方向的此类跃迁都是对称等价的，它们具有相同的势垒高度和指前因子。沿 $y$ 方向的跃迁不被视为此事件类型，因为应变各向异性使它们不等价，它们被归类为不同的事件类型。\n\n从连续时间马尔可夫跳跃过程（指数等待时间，总风险率等于微观事件风险率之和）和活化过程的谐波过渡态理论（TST）的基本描述出发，完成以下任务：\n\n1. 根据剩余位点对称群作用于一个代表性实例所产生的不同但对称等价的微观实例的数量，定义所考虑事件类型的多重性因子 $g_{i}$。使用轨道-稳定子定理，明确计算在 $C_{2v}$ 群作用下从 $(0,0)$ 到 $(a,0)$ 的跃迁的 $g_{i}$。\n\n2. 使用单个微观跃迁速率的 TST 表达式 $k_{i}=\\nu_{i}\\exp\\!\\left(-E_{i}/(k_{B}T)\\right)$，其中 $\\nu_{i}$ 是尝试频率，$E_{i}$ 是活化能垒，$k_{B}$ 是玻尔兹曼常数，$T$ 是绝对温度，推导出当 AKMC 将对称等价的微观实例分组为一个类别进行选择时，该事件类型的有效选择速率。\n\n3. 在 $T=350\\,\\mathrm{K}$ 条件下，给定 $\\nu_{i}=1.0\\times 10^{12}\\,\\mathrm{s}^{-1}$ 和 $E_{i}=0.25\\,\\mathrm{eV}$，计算沿 $x$ 方向跃迁事件类型的有效速率的数值。使用 $k_{B}=8.617333262145\\times 10^{-5}\\,\\mathrm{eV\\,K^{-1}}$ 以避免单位转换。最终速率以 $\\mathrm{s}^{-1}$ 表示，并将答案四舍五入到三位有效数字。",
            "solution": "该问题经证实具有科学依据、提法明确且客观。这是一个计算材料科学领域的标准问题，涉及自适应动力学蒙特卡洛（AKMC）、过渡态理论（TST）和群论。所有必要的数据和定义均已提供。我们按照要求分三部分进行解答。\n\n### 第一部分：多重性因子 $g_{i}$\n\n多重性因子，对于事件类型 $i$ 记作 $g_{i}$，是指因对称性而被认为是等价的、并因此在动力学蒙特卡洛目录中归为同一事件类别的不同微观物理事件的数量。\n\n为确定沿 $x$ 方向最近邻跃迁的 $g_{i}$，我们使用轨道-稳定子定理。该定理指出，对于作用于集合 $X$ 的群 $G$，元素 $x \\in X$ 的轨道大小，记作 $|G(x)|$，等于群的阶数与 $x$ 的稳定子群的阶数之比：$|G(x)| = |G| / |G_x|$。\n\n相关的对称群是剩余位点对称群 $G = C_{2v}$。问题陈述该群包含四个元素：恒等元 $E$、绕原点的二重旋转 $C_{2}$ 以及分别穿过 $x$ 轴和 $y$ 轴的镜面反射 $\\sigma_{x}$ 和 $\\sigma_{y}$。该群的阶数为 $|C_{2v}| = 4$。\n\n群作用于可能的最近邻跃迁事件集合上。我们可以用位移矢量 $\\mathbf{v} = (a,0)$ 来表示代表性事件，即从原点 $(0,0)$ 到相邻位点 $(a,0)$ 的跃迁。我们必须找到该矢量在 $C_{2v}$ 群作用下的轨道。每个群元对点 $(x,y)$ 的作用如下：\n- $E(x,y) = (x,y)$\n- $C_{2}(x,y) = (-x,-y)$\n- $\\sigma_{x}(x,y) = (x,-y)$ （关于x轴的反射）\n- $\\sigma_{y}(x,y) = (-x,y)$ （关于y轴的反射）\n\n将这些变换应用于我们的代表性矢量 $\\mathbf{v} = (a,0)$：\n- $E(\\mathbf{v}) = (a,0)$\n- $C_{2}(\\mathbf{v}) = (-a,0)$\n- $\\sigma_{x}(\\mathbf{v}) = (a,-0) = (a,0)$\n- $\\sigma_{y}(\\mathbf{v}) = (-a,0)$\n\n$\\mathbf{v}$ 的轨道 $G(\\mathbf{v})$ 是由此作用生成的所有不同矢量的集合：\n$$\nG(\\mathbf{v}) = \\{(a,0), (-a,0)\\}\n$$\n轨道的大小是不同元素的数量，即 2。这就是多重性因子 $g_{i}$。\n$$\ng_{i} = |G(\\mathbf{v})| = 2\n$$\n这两个微观事件是向右跃迁（位移 $(a,0)$）和向左跃迁（位移 $(-a,0)$）。\n\n或者，形式上使用轨道-稳定子定理，我们首先确定稳定子群 $G_{\\mathbf{v}}$，它包含所有使 $\\mathbf{v}$ 保持不变（$g(\\mathbf{v})=\\mathbf{v}$）的群元 $g \\in G$。根据我们上面的分析，这些元素是 $E$ 和 $\\sigma_{x}$。\n$$\nG_{\\mathbf{v}} = \\{E, \\sigma_{x}\\}\n$$\n稳定子群的阶数为 $|G_{\\mathbf{v}}| = 2$。\n应用该定理：\n$$\ng_{i} = |G(\\mathbf{v})| = \\frac{|C_{2v}|}{|G_{\\mathbf{v}}|} = \\frac{4}{2} = 2\n$$\n这证实了结果。“沿 $x$ 方向跃迁”事件类型的多重性因子为 2。\n\n### 第二部分：有效选择速率\n\n该模拟框架是一个连续时间马尔可夫跳跃过程。在此过程中，系统停留在一个状态，直到一个随机事件使其跃迁到一个新状态。每个可能的微观事件 $j$ 都有一个相关联的速率（或风险率）$k_{j}$。离开当前状态的总速率是所有单个微观速率的总和，$K_{total} = \\sum_{j} k_{j}$。到下一个事件发生的时间是从一个参数为 $K_{total}$ 的指数分布中抽取的。\n\n谐波过渡态理论（TST）提供了单个微观活化事件 $i$ 的速率表达式：\n$$\nk_{i} = \\nu_{i} \\exp\\left(-\\frac{E_{i}}{k_{B}T}\\right)\n$$\n其中 $\\nu_{i}$ 是尝试频率，$E_{i}$ 是活化能垒，$k_{B}$ 是玻尔兹曼常数，$T$ 是绝对温度。\n\n在 AKMC 模拟中，对称等价的微观事件被归为单一的事件类型或类别。一个事件类型的有效选择速率，我们可以记作 $K_{\\text{type}}$，是该类别内所有微观事件对总逃逸速率的贡献总和。这仅仅是所有组成微观事件速率的总和。\n\n对于“沿 $x$ 方向跃迁”事件类型，我们在第一部分中发现它包含 $g_{i}=2$ 个微观事件：向右跃迁和向左跃迁。问题陈述它们是对称等价的，这意味着它们具有相同的活化能垒 $E_{i}$ 和指前因子 $\\nu_{i}$。因此，它们的各自速率是相同的：\n$$\nk_{\\text{right}} = k_{\\text{left}} = k_{i} = \\nu_{i} \\exp\\left(-\\frac{E_{i}}{k_{B}T}\\right)\n$$\n此事件类型的有效选择速率，我们称之为 $K_{x}$，是这些单个速率的总和：\n$$\nK_{x} = k_{\\text{right}} + k_{\\text{left}} = k_{i} + k_{i} = 2k_{i}\n$$\n更一般地，对于一个由 $g_{i}$ 个对称等价的微观事件（每个事件速率为 $k_{i}$）组成的事件类型，其有效速率为：\n$$\nK_{\\text{type}} = g_{i} k_{i}\n$$\n代入 TST 表达式，沿 $x$ 方向跃迁事件类型的有效选择速率为：\n$$\nK_{x} = g_{i} \\nu_{i} \\exp\\left(-\\frac{E_{i}}{k_{B}T}\\right)\n$$\n\n### 第三部分：数值计算\n\n我们被要求使用推导出的公式和给定的参数来计算有效速率 $K_{x}$ 的数值。\n公式为：\n$$\nK_{x} = g_{i} \\nu_{i} \\exp\\left(-\\frac{E_{i}}{k_{B}T}\\right)\n$$\n给定的数值为：\n- 多重性 $g_{i} = 2$ （来自第一部分）\n- 尝试频率 $\\nu_{i} = 1.0 \\times 10^{12}\\,\\mathrm{s}^{-1}$\n- 活化能 $E_{i} = 0.25\\,\\mathrm{eV}$\n- 绝对温度 $T = 350\\,\\mathrm{K}$\n- 玻尔兹曼常数 $k_{B} = 8.617333262145 \\times 10^{-5}\\,\\mathrm{eV\\,K^{-1}}$\n\n首先，我们计算玻尔兹曼常数和温度的乘积，它代表热能：\n$$\nk_{B}T = (8.617333262145 \\times 10^{-5}\\,\\mathrm{eV\\,K^{-1}}) \\times (350\\,\\mathrm{K}) \\approx 0.030160666\\,\\mathrm{eV}\n$$\n接下来，我们计算指数函数的参数。这是一个无量纲的量，因为能量单位相互抵消：\n$$\n\\frac{E_{i}}{k_{B}T} = \\frac{0.25\\,\\mathrm{eV}}{0.030160666\\,\\mathrm{eV}} \\approx 8.28890\n$$\n现在我们可以计算指数项：\n$$\n\\exp\\left(-\\frac{E_{i}}{k_{B}T}\\right) = \\exp(-8.28890) \\approx 2.51283 \\times 10^{-4}\n$$\n最后，我们将所有数值代回有效速率 $K_{x}$ 的表达式中：\n$$\nK_{x} = (2) \\times (1.0 \\times 10^{12}\\,\\mathrm{s}^{-1}) \\times (2.51283 \\times 10^{-4})\n$$\n$$\nK_{x} \\approx 5.02566 \\times 10^{8}\\,\\mathrm{s}^{-1}\n$$\n问题要求将答案四舍五入到三位有效数字。\n$$\nK_{x} \\approx 5.03 \\times 10^{8}\\,\\mathrm{s}^{-1}\n$$",
            "answer": "$$\\boxed{5.03 \\times 10^{8}}$$"
        },
        {
            "introduction": "为了避免为每个原子构型都进行昂贵的“在线”势垒搜索，自适应 KMC 的一个核心策略是在相似的环境中重用已知的跃迁事件。这个练习深入探讨了该自适应策略的核心，要求您通过量化重用事件所引入的速率误差，来建立一个决定何时可以安全重用事件的准则。通过这个推导，您将理解如何在计算效率和模拟精度之间做出权衡，这是 AKMC 方法性能的关键 。",
            "id": "3789810",
            "problem": "考虑在温度为 $T$ 的晶体固体中进行具有在线事件发现功能的自适应动力学蒙特卡罗 (AKMC) 模拟。一个局域原子环境由描述符向量 $\\boldsymbol{\\phi} \\in \\mathbb{R}^{m}$ 表示，该向量由半径为 $r_{\\mathrm{c}}$ 的球内的平滑截断的径向和角度邻域函数构建。设 $\\mathbf{W} \\in \\mathbb{R}^{m \\times m}$ 是一个对称正定权重矩阵，用于对描述符分量进行无量纲化和缩放。定义两个具有描述符 $\\boldsymbol{\\phi}$ 和 $\\boldsymbol{\\phi}^{\\star}$ 的局域环境之间的距离为\n$$\nd\\!\\left(\\boldsymbol{\\phi},\\boldsymbol{\\phi}^{\\star}\\right) \\equiv \\left\\|\\mathbf{W}\\left(\\boldsymbol{\\phi}-\\boldsymbol{\\phi}^{\\star}\\right)\\right\\|_{2}\n$$。\n一个目录中为参考环境 $\\boldsymbol{\\phi}^{\\star}$ 保存了一个先前发现的事件，该事件的特征是活化能垒 $E_{b}^{\\star}$ 和指前因子 $\\nu^{\\star}$。对于一个新的环境 $\\boldsymbol{\\phi}$，真实事件的活化能垒为 $E_{b}(\\boldsymbol{\\phi})$，指前因子为 $\\nu(\\boldsymbol{\\phi})$。假设以下经过充分检验的物理基础：\n- 根据谐波过渡态理论 (HTST)，速率为 $k(\\boldsymbol{\\phi})=\\nu(\\boldsymbol{\\phi})\\exp\\!\\left(-\\beta E_{b}(\\boldsymbol{\\phi})\\right)$，其中 $\\beta \\equiv 1/(k_{B}T)$，$k_{B}$ 是玻尔兹曼常数。\n- 在与重用相关的小邻域 $d\\!\\left(\\boldsymbol{\\phi},\\boldsymbol{\\phi}^{\\star}\\right) \\leq d_{\\max}$ 内，指前因子近似恒定，即 $\\nu(\\boldsymbol{\\phi}) \\approx \\nu^{\\star}$，并且能垒在度量 $d$ 上是 Lipschitz 的，即 $\\left|E_{b}(\\boldsymbol{\\phi})-E_{b}^{\\star}\\right| \\leq L\\, d\\!\\left(\\boldsymbol{\\phi},\\boldsymbol{\\phi}^{\\star}\\right)$，其中 $L>0$ 是通过校准确定的某个常数。\n当 $d\\!\\left(\\boldsymbol{\\phi},\\boldsymbol{\\phi}^{\\star}\\right) \\leq d_{\\mathrm{thr}}$ 时，代码会为 $\\boldsymbol{\\phi}$ 重用在 $\\boldsymbol{\\phi}^{\\star}$ 处编目的事件，用 $k^{\\mathrm{cat}}(\\boldsymbol{\\phi}) \\equiv \\nu^{\\star}\\exp\\!\\left(-\\beta E_{b}^{\\star}\\right)$ 替代真实速率 $k(\\boldsymbol{\\phi})$。定义相对速率误差为 $r(\\boldsymbol{\\phi}) \\equiv \\left|k(\\boldsymbol{\\phi})-k^{\\mathrm{cat}}(\\boldsymbol{\\phi})\\right|/k(\\boldsymbol{\\phi})$。\n(a) 从 HTST 和 Lipschitz 假设出发，推导出一个最坏情况误差界 $r_{\\max}(d)$，它作为 $d \\equiv d\\!\\left(\\boldsymbol{\\phi},\\boldsymbol{\\phi}^{\\star}\\right)$ 的函数，并推导出一个相应的形式为 $d \\leq d_{\\mathrm{thr}}$ 的接受准则，该准则确保误差不超过预设容差 $\\tau \\in (0,1)$。\n(b) 假设在距离为 $d$ 的条件下，能垒失配 $\\Delta E_{b} \\equiv E_{b}^{\\star} - E_{b}(\\boldsymbol{\\phi})$ 是一个在区间 $[-L d, L d]$ 上均匀分布的随机变量，推导一个关于 $d$、$L$ 和 $\\beta$ 的期望相对速率误差 $\\mathbb{E}[r \\mid d]$ 的闭式解析表达式。",
            "solution": "该问题要求分析在自适应动力学蒙特卡罗 (AKMC) 模拟中重用目录中的跃迁速率时所产生的误差。问题分为两部分：(a) 推导最坏情况误差界和接受准则，以及 (b) 在一个统计模型下计算期望误差。\n\n首先，我们形式化相对速率误差 $r(\\boldsymbol{\\phi})$。根据谐波过渡态理论 (HTST)，真实速率由 $k(\\boldsymbol{\\phi}) = \\nu(\\boldsymbol{\\phi})\\exp(-\\beta E_{b}(\\boldsymbol{\\phi}))$ 给出，其中 $\\beta = 1/(k_{B}T)$。目录中的速率是一个近似值，为 $k^{\\mathrm{cat}}(\\boldsymbol{\\phi}) = \\nu^{\\star}\\exp(-\\beta E_{b}^{\\star})$。问题指出，对于我们感兴趣的局域邻域，指前因子可视为常数，即 $\\nu(\\boldsymbol{\\phi}) \\approx \\nu^{\\star}$。\n\n使用这个近似，相对速率误差 $r(\\boldsymbol{\\phi})$ 为：\n$$\nr(\\boldsymbol{\\phi}) = \\frac{|k(\\boldsymbol{\\phi}) - k^{\\mathrm{cat}}(\\boldsymbol{\\phi})|}{k(\\boldsymbol{\\phi})} \\approx \\frac{|\\nu^{\\star}\\exp(-\\beta E_{b}(\\boldsymbol{\\phi})) - \\nu^{\\star}\\exp(-\\beta E_{b}^{\\star})|}{\\nu^{\\star}\\exp(-\\beta E_{b}(\\boldsymbol{\\phi}))}\n$$\n指前因子 $\\nu^{\\star}$ 被消去：\n$$\nr(\\boldsymbol{\\phi}) \\approx \\frac{|\\exp(-\\beta E_{b}(\\boldsymbol{\\phi})) - \\exp(-\\beta E_{b}^{\\star})|}{\\exp(-\\beta E_{b}(\\boldsymbol{\\phi}))} = |1 - \\exp(-\\beta (E_{b}^{\\star} - E_{b}(\\boldsymbol{\\phi})))|\n$$\n我们定义能垒失配为 $\\Delta E_{b}(\\boldsymbol{\\phi}) \\equiv E_{b}^{\\star} - E_{b}(\\boldsymbol{\\phi})$。相对误差便可简洁地表示为：\n$$\nr(\\boldsymbol{\\phi}) \\approx |1 - \\exp(-\\beta \\Delta E_{b}(\\boldsymbol{\\phi}))|\n$$\n\n(a) 最坏情况误差界与接受准则的推导。\n\n问题指出活化能垒在度量 $d \\equiv d(\\boldsymbol{\\phi}, \\boldsymbol{\\phi}^{\\star})$ 上是 Lipschitz 的，这意味着：\n$$\n|E_{b}(\\boldsymbol{\\phi}) - E_{b}^{\\star}| \\leq L d\n$$\n用我们定义的失配 $\\Delta E_{b}(\\boldsymbol{\\phi})$ 表示，这等价于 $|\\Delta E_{b}(\\boldsymbol{\\phi})| \\leq L d$，即 $-L d \\leq \\Delta E_{b}(\\boldsymbol{\\phi}) \\leq L d$。\n\n为了找到最坏情况误差 $r_{\\max}(d)$，我们必须在区间 $x \\in [-L d, L d]$ 上最大化函数 $f(x) = |1 - \\exp(-\\beta x)|$。该函数的行为取决于 $x$ 的符号。\n- 如果 $x > 0$，$f(x) = 1 - \\exp(-\\beta x)$。由于 $\\beta > 0$，$f(x)$ 是 $x$ 的增函数。\n- 如果 $x < 0$，$f(x) = \\exp(-\\beta x) - 1$。由于 $\\beta > 0$，$f(x)$ 是 $x$ 的减函数。\n乍一看，函数 $f(x)$ 似乎是 $x$ 的偶函数，但事实并非如此。我们来检查区间 $[-L d, L d]$ 的端点。\n在 $x = L d$ 处：$r = |1 - \\exp(-\\beta L d)| = 1 - \\exp(-\\beta L d)$ (因为 $\\beta L d \\ge 0$)。\n在 $x = -L d$ 处：$r = |1 - \\exp(-\\beta (-L d))| = |1 - \\exp(\\beta L d)| = \\exp(\\beta L d) - 1$ (因为 $\\beta L d \\ge 0$)。\n\n为了确定哪个值更大，我们比较 $\\exp(y) - 1$ 和 $1 - \\exp(-y)$，其中 $y = \\beta L d > 0$。考虑函数 $g(y) = (\\exp(y) - 1) - (1 - \\exp(-y)) = \\exp(y) + \\exp(-y) - 2$。其导数为 $g'(y) = \\exp(y) - \\exp(-y) > 0$ (对于 $y > 0$)。由于 $g(0) = 0$，我们有 $g(y) > 0$ (对于所有 $y > 0$)。因此，对于 $d > 0$，$\\exp(\\beta L d) - 1 > 1 - \\exp(-\\beta L d)$。\n\n最大误差发生在 $\\Delta E_{b} = -L d$ 时，这对应于真实能垒 $E_{b}(\\boldsymbol{\\phi}) = E_{b}^{\\star} + L d$ 最大程度地高于目录中的能垒。这使得真实速率 $k(\\boldsymbol{\\phi})$ 非常小，从而导致较大的相对误差。最坏情况误差界为：\n$$\nr_{\\max}(d) = \\exp(\\beta L d) - 1\n$$\n为保证相对误差 $r(\\boldsymbol{\\phi})$ 不超过预设容差 $\\tau \\in (0,1)$，我们必须对最坏情况误差施加条件：\n$$\nr_{\\max}(d) \\leq \\tau\n$$\n$$\n\\exp(\\beta L d) - 1 \\leq \\tau\n$$\n$$\n\\exp(\\beta L d) \\leq 1 + \\tau\n$$\n对两边取自然对数，得到：\n$$\n\\beta L d \\leq \\ln(1 + \\tau)\n$$\n$$\nd \\leq \\frac{\\ln(1 + \\tau)}{\\beta L}\n$$\n这定义了接受准则 $d \\leq d_{\\mathrm{thr}}$，其阈值为 $d_{\\mathrm{thr}} = \\frac{\\ln(1 + \\tau)}{\\beta L}$。\n\n(b) 期望相对速率误差的计算。\n\n给定一个统计模型，其中能垒失配 $\\Delta E_{b}$，在距离 $d$ 的条件下，是一个在区间 $[-L d, L d]$ 上均匀分布的随机变量。令 $X = \\Delta E_{b}$。$X$ 的概率密度函数 (PDF) 是：\n$$\np(x) = \\begin{cases} \\frac{1}{2Ld}  \\text{if } x \\in [-L d, L d] \\\\ 0  \\text{otherwise} \\end{cases}\n$$\n期望相对速率误差 $\\mathbb{E}[r \\mid d]$ 是函数 $r(X) = |1 - \\exp(-\\beta X)|$ 的期望：\n$$\n\\mathbb{E}[r \\mid d] = \\int_{-\\infty}^{\\infty} r(x) p(x) dx = \\frac{1}{2Ld} \\int_{-Ld}^{Ld} |1 - \\exp(-\\beta x)| dx\n$$\n我们在 $x=0$ 处分割积分，因为被积函数的形式在此改变：\n$$\n\\int_{-Ld}^{Ld} |1 - \\exp(-\\beta x)| dx = \\int_{-Ld}^{0} (\\exp(-\\beta x) - 1) dx + \\int_{0}^{Ld} (1 - \\exp(-\\beta x)) dx\n$$\n我们分别计算每个积分。\n第一个积分：\n$$\n\\int_{-Ld}^{0} (\\exp(-\\beta x) - 1) dx = \\left[ -\\frac{1}{\\beta}\\exp(-\\beta x) - x \\right]_{-Ld}^{0}\n$$\n$$\n= \\left( -\\frac{1}{\\beta}\\exp(0) - 0 \\right) - \\left( -\\frac{1}{\\beta}\\exp(-\\beta(-Ld)) - (-Ld) \\right) = -\\frac{1}{\\beta} + \\frac{1}{\\beta}\\exp(\\beta L d) - Ld\n$$\n第二个积分：\n$$\n\\int_{0}^{Ld} (1 - \\exp(-\\beta x)) dx = \\left[ x + \\frac{1}{\\beta}\\exp(-\\beta x) \\right]_{0}^{Ld}\n$$\n$$\n= \\left( Ld + \\frac{1}{\\beta}\\exp(-\\beta Ld) \\right) - \\left( 0 + \\frac{1}{\\beta}\\exp(0) \\right) = Ld + \\frac{1}{\\beta}\\exp(-\\beta Ld) - \\frac{1}{\\beta}\n$$\n将两个积分的结果相加：\n$$\n\\left( \\frac{1}{\\beta}\\exp(\\beta L d) - \\frac{1}{\\beta} - Ld \\right) + \\left( \\frac{1}{\\beta}\\exp(-\\beta Ld) - \\frac{1}{\\beta} + Ld \\right)\n$$\n$$\n= \\frac{1}{\\beta}(\\exp(\\beta L d) + \\exp(-\\beta L d)) - \\frac{2}{\\beta}\n$$\n使用双曲余弦函数的定义 $\\cosh(y) = \\frac{\\exp(y) + \\exp(-y)}{2}$，和变为：\n$$\n= \\frac{2}{\\beta}\\cosh(\\beta L d) - \\frac{2}{\\beta} = \\frac{2}{\\beta}(\\cosh(\\beta L d) - 1)\n$$\n最后，我们乘以归一化因子 $\\frac{1}{2Ld}$ 得到期望值：\n$$\n\\mathbb{E}[r \\mid d] = \\frac{1}{2Ld} \\cdot \\frac{2}{\\beta}(\\cosh(\\beta L d) - 1)\n$$\n$$\n\\mathbb{E}[r \\mid d] = \\frac{\\cosh(\\beta L d) - 1}{\\beta L d}\n$$\n这就是期望相对速率误差作为 $d$、$L$ 和 $\\beta$ 的函数的闭式解析表达式。",
            "answer": "$$\\boxed{\\frac{\\cosh(\\beta L d) - 1}{\\beta L d}}$$"
        },
        {
            "introduction": "在线事件发现中使用的鞍点搜索算法有时可能会收敛到非物理的驻点，例如具有负激活能或多个虚频模式的位形，这会威胁到模拟的稳定性。本练习旨在解决对算法鲁棒性的关键需求，挑战您构建一个形式化的数学“安全卫士”。您需要运用过渡态理论（TST）的原理，将物理上的有效性条件转化为一个单一的解析表达式，以确保只有物理上合理的跃迁事件才会被纳入 KMC 模拟中 。",
            "id": "3789854",
            "problem": "一种带有在线事件发现功能的自适应动力学蒙特卡洛 (KMC) 方案，试图在势能面上识别鞍点，以生成热激活跃迁。然而，发现的鞍点可能是非物理的，例如表现出负激活势垒，或由于存在多个不稳定模式而产生虚尝试频率。考虑一个具有 $N$ 个自由度的系统，其势能 $E(\\mathbf{q})$ 定义在质量加权坐标上。令 $\\mathbf{q}_{\\min}$ 表示一个局域极小值点，$\\mathbf{q}_{\\sad}$ 表示由鞍点搜索算法（例如，最小模式跟踪法或二聚体方法）找到的候选鞍点。将势垒定义为 $\\Delta E \\equiv E(\\mathbf{q}_{\\sad}) - E(\\mathbf{q}_{\\min})$。令 $\\mathbf{H}_{\\min}$ 和 $\\mathbf{H}_{\\sad}$ 分别表示在 $\\mathbf{q}_{\\min}$ 和 $\\mathbf{q}_{\\sad}$ 处的 Hessian 矩阵，并令 $\\{ \\lambda_{i}^{\\min} \\}_{i=1}^{N}$ 和 $\\{ \\lambda_{i}^{\\sad} \\}_{i=1}^{N}$ 为它们的特征值。假设在极小值点处，对所有 $i$ 都有 $\\lambda_{i}^{\\min} > 0$。在一个物理上有效的一阶鞍点处，$\\mathbf{H}_{\\sad}$ 的特征值中恰好有一个为负，其余 $N-1$ 个为正。\n\n在线鞍点搜索产生一条连接 $\\mathbf{q}_{\\min} = \\mathbf{q}_{0}$ 到 $\\mathbf{q}_{\\sad} = \\mathbf{q}_{M}$ 的离散路径 $\\{ \\mathbf{q}_{j} \\}_{j=0}^{M}$。令 $E_{j} \\equiv E(\\mathbf{q}_{j})$ 表示该路径上的能量。一个物理上合理的搜索过程应在上升路径上表现出能量非递减的特性，即对于 $j = 1, \\dots, M$，有 $E_{j} - E_{j-1} \\geq 0$。\n\n以谐振近似下的经典过渡态理论 (TST) 为基本出发点，为带保护措施的速率泛函 $r_{\\text{safe}}$ 构造一个单一的闭式解析表达式，该表达式满足：\n- 当 $\\Delta E \\geq 0$、鞍点处恰好有一个负特征值、且所发现路径上的能量非递减时，该表达式简化为谐振 TST 速率前置因子乘以阿伦尼乌斯因子，\n- 否则恒等于零。\n\n保护措施必须使用亥维赛阶跃函数 $\\Theta(x)$ 来强制执行 Hessian 检查和能量单调性，其中 $\\Theta(x)$ 定义为：当 $x \\geq 0$ 时 $\\Theta(x) = 1$，当 $x < 0$ 时 $\\Theta(x) = 0$。为确保前置因子的实数性质，请用 Hessian 特征值来构建表达式，使得当保护措施通过时，表达式保持为实值；当保护措施失败时，表达式变为零。\n\n用以下符号表示您最终的速率泛函 $r_{\\text{safe}}$：一个代表 TST 动力学前置因子尺度的正常数 $C$、玻尔兹曼常数 $k_{B}$、绝对温度 $T$、势垒 $\\Delta E$、特征值集合 $\\{ \\lambda_{i}^{\\min} \\}_{i=1}^{N}$ 和 $\\{ \\lambda_{i}^{\\sad} \\}_{i=1}^{N}$，以及路径能量 $\\{ E_{j} \\}_{j=0}^{M}$。您可以使用对指数的求和与求积来编码逻辑条件。您的最终答案必须是一个单一的闭式解析表达式。不需要进行数值计算，也不需要四舍五入。最终表达式中不要包含单位。",
            "solution": "该问题要求基于谐振近似下的经典过渡态理论 (TST)，为带保护措施的速率泛函 $r_{\\text{safe}}$ 构造一个单一的闭式解析表达式。该泛函必须仅在一组物理有效性条件得到满足时，其值才等于标准 TST 速率，否则恒等于零。这些有效性条件与激活势垒、鞍点处的 Hessian 符号差以及从极小值点到鞍点的能量路径的单调性有关。\n\n带保护措施的速率的结构将是谐振 TST 速率 $r_{\\text{HTST}}$ 与一系列无量纲保护因子的乘积，这些保护因子将使用给定的亥维赛阶跃函数 $\\Theta(x)$ 构建，其中 $\\Theta(x)$ 定义为：当 $x \\geq 0$ 时 $\\Theta(x) = 1$，当 $x < 0$ 时 $\\Theta(x) = 0$。\n\n首先，我们在所有有效性条件均得到满足的假设下，建立速率 $r_{\\text{HTST}}$ 的表达式。根据谐振 TST，速率由尝试频率乘以阿伦尼乌斯因子给出。尝试频率可以用在极小值点处的 Hessian 矩阵 $\\mathbf{H}_{\\min}$ 和在鞍点处的 Hessian 矩阵 $\\mathbf{H}_{\\sad}$ 的特征值来表示。令 $\\{ \\lambda_{i}^{\\min} \\}_{i=1}^{N}$ 为极小值点处的特征值，$\\{ \\lambda_{i}^{\\sad} \\}_{i=1}^{N}$ 为鞍点处的特征值。问题陈述坐标是质量加权的，因此 Hessian 特征值的平方根对应于振动频率。谐振 TST 速率为：\n$$\nr_{\\text{HTST}} = C \\frac{\\prod_{i=1}^{N} \\sqrt{\\lambda_{i}^{\\min}}}{\\prod_{\\lambda_{k}^{\\sad}>0} \\sqrt{\\lambda_{k}^{\\sad}}} \\exp\\left(-\\frac{\\Delta E}{k_{B}T}\\right)\n$$\n其中常数 $C$ 代表 TST 动力学前置因子尺度，$\\Delta E$ 是激活势垒，$k_{B}$ 是玻尔兹曼常数，$T$ 是绝对温度。分母中的乘积是针对一个有效的一阶鞍点的 $N-1$ 个正特征值进行的。给定极小值点处的特征值 $\\lambda_{i}^{\\min}$ 全部为正。\n\n为了便于简洁表达，我们将 $\\mathbf{H}_{\\sad}$ 的特征值按非递减顺序排序，记为 $\\lambda_{(1)}^{\\sad} \\leq \\lambda_{(2)}^{\\sad} \\leq \\dots \\leq \\lambda_{(N)}^{\\sad}$。如果鞍点是一个有效的一阶过渡态，那么 $\\lambda_{(1)}^{\\sad}$ 是唯一的负特征值，其余的 $N-1$ 个特征值 $\\lambda_{(2)}^{\\sad}, \\dots, \\lambda_{(N)}^{\\sad}$ 均为正。在这种情况下，对正特征值的乘积变为 $\\prod_{i=2}^{N} \\lambda_{(i)}^{\\sad}$。因此，TST 速率可以写为：\n$$\nr_{\\text{HTST}} = C \\frac{\\sqrt{\\prod_{i=1}^{N} \\lambda_{i}^{\\min}}}{\\sqrt{\\prod_{i=2}^{N} \\lambda_{(i)}^{\\sad}}} \\exp\\left(-\\frac{\\Delta E}{k_{B}T}\\right)\n$$\n该表达式仅在物理条件得到满足时才有效。我们现在构造保护因子来强制执行这些条件。最终速率将是 $r_{\\text{safe}} = r_{\\text{HTST}} \\times (\\text{保护因子})$。\n\n1.  **非负激活势垒：** 激活势垒 $\\Delta E$ 必须为非负，即 $\\Delta E \\geq 0$。这个条件可以直接由亥维赛函数 $\\Theta(\\Delta E)$ 强制执行。如果 $\\Delta E \\geq 0$，该因子为 $1$，否则为 $0$。\n\n2.  **单调能量路径：** 沿发现的离散路径 $\\{ E_j \\}_{j=0}^M$ 的能量必须非递减，即对于所有 $j \\in \\{1, \\dots, M\\}$，有 $E_j - E_{j-1} \\geq 0$。这是一组 $M$ 个同步条件。亥维赛函数的乘积可以强制执行这一点：$\\prod_{j=1}^{M} \\Theta(E_j - E_{j-1})$。如果路径的任何一段能量下降，乘积中的一项将为零，从而使整个乘积为零。\n\n3.  **鞍点处的 Hessian 指数：** 鞍点必须是真正的一阶鞍点，这意味着 $\\mathbf{H}_{\\sad}$ 的特征值中恰好有一个为负，其余 $N-1$ 个为正。这意味着没有零特征值。用排序后的特征值表示，这等价于两个条件：$\\lambda_{(1)}^{\\sad} < 0$ 和 $\\lambda_{(2)}^{\\sad} > 0$。\n    为了使用给定的 $\\Theta(x)$ 强制执行这些严格不等式，我们可以为严格正性和严格负性构造指示函数。\n    -   对于 $x < 0$ 的指示函数，我们称之为 $I_{<0}(x)$，如果 $x < 0$ 则为 $1$，否则为 $0$。它可以构造为 $\\Theta(-x)(1 - \\Theta(x))$。\n    -   对于 $x > 0$ 的指示函数，我们称之为 $I_{>0}(x)$，如果 $x > 0$ 则为 $1$，否则为 $0$。它可以构造为 $\\Theta(x)(1 - \\Theta(-x))$。\n    因此，Hessian 保护措施是应用于前两个排序特征值的两个此类指示函数的乘积：$I_{<0}(\\lambda_{(1)}^{\\sad}) \\times I_{>0}(\\lambda_{(2)}^{\\sad})$。当且仅当 $\\lambda_{(1)}^{\\sad} < 0$ 且 $\\lambda_{(2)}^{\\sad} > 0$ 时，该乘积为 $1$，而在任何其他情况下（例如，极小值点、高阶鞍点或具有零频模式的状态），该乘积为 $0$。该保护措施还确保了前置因子中的分母 $\\sqrt{\\prod_{i=2}^{N} \\lambda_{(i)}^{\\sad}}$ 是良定义且为实数，因为它强制所有 $i \\geq 2$ 的 $\\lambda_{(i)}^{\\sad}$ 均为正。\n\n将基础 TST 速率与所有三个保护因子结合起来，即可得到带保护措施的速率泛函 $r_{\\text{safe}}$ 的最终表达式。\n\n$$\nr_{\\text{safe}} = C \\frac{\\sqrt{\\prod_{i=1}^{N} \\lambda_{i}^{\\min}}}{\\sqrt{\\prod_{i=2}^{N} \\lambda_{(i)}^{\\sad}}} \\exp\\left(-\\frac{\\Delta E}{k_{B}T}\\right) \\times \\Theta(\\Delta E) \\times \\left( \\prod_{j=1}^{M} \\Theta(E_j - E_{j-1}) \\right) \\times \\left( \\Theta(-\\lambda_{(1)}^{\\sad})(1 - \\Theta(\\lambda_{(1)}^{\\sad})) \\Theta(\\lambda_{(2)}^{\\sad})(1 - \\Theta(-\\lambda_{(2)}^{\\sad})) \\right)\n$$\n这是一个单一的闭式表达式，当所有条件满足时，它正确地简化为谐振 TST 速率，否则恒等于零，符合要求。",
            "answer": "$$\n\\boxed{C \\frac{\\sqrt{\\prod_{i=1}^{N} \\lambda_{i}^{\\min}}}{\\sqrt{\\prod_{i=2}^{N} \\lambda_{(i)}^{\\sad}}} \\exp\\left(-\\frac{\\Delta E}{k_{B}T}\\right) \\Theta(\\Delta E) \\left( \\prod_{j=1}^{M} \\Theta(E_{j} - E_{j-1}) \\right) \\Theta(-\\lambda_{(1)}^{\\sad})(1 - \\Theta(\\lambda_{(1)}^{\\sad})) \\Theta(\\lambda_{(2)}^{\\sad})(1 - \\Theta(-\\lambda_{(2)}^{\\sad}))}\n$$"
        }
    ]
}