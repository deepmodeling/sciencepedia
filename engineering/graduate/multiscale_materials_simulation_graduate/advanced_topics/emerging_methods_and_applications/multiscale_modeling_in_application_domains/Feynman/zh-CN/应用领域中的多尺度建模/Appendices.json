{
    "hands_on_practices": [
        {
            "introduction": "任何可靠的连续介质模型，尤其是在多尺度框架中使用的模型，都必须与热力学定律保持一致。这项实践将指导您推导一个化学-力学耦合系统的熵产生，这是确保模型不违反热力学第二定律的一项基本检验。通过运用 Coleman-Noll 程序，您将掌握一种系统性的方法来确保复杂本构关系的物理真实性，这是构建预测性模型的关键第一步。",
            "id": "3825509",
            "problem": "一个处于均匀温度 $T0$ 下的小应变化学-力学材料的等温代表性体积单元，包含一种浓度为 $c(\\mathbf{x},t)$、化学势为 $\\mu(\\mathbf{x},t)$ 的单一扩散物质。其运动学由无穷小应变张量 $\\varepsilon = \\tfrac{1}{2}(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{\\top})$ 及其率 $\\dot{\\varepsilon}$ 描述。假设该物质满足标准质量平衡方程，且无热传导和外部热源。设单位体积的亥姆霍兹自由能密度为 $\\psi(\\varepsilon,c)$，并将平衡（可逆）本构响应定义为 $\\sigma_{\\mathrm{eq}} = \\partial \\psi / \\partial \\varepsilon$ 和 $\\mu_{\\mathrm{eq}} = \\partial \\psi / \\partial c$。扩散通量遵循与线性不可逆热力学 (LIT) 兼容的定律，$J = - M \\nabla \\mu$，其中迁移率 $M0$。总柯西应力可加性分解为 $\\sigma = \\sigma_{\\mathrm{eq}} + \\sigma_{\\mathrm{d}}$，其中耗散应力是纯粘性的，由 $\\sigma_{\\mathrm{d}} = \\mathbb{L} : \\dot{\\varepsilon}$ 给出。其中 $\\mathbb{L}$ 是一个四阶粘度张量，它在 $\\dot{\\varepsilon} : \\mathbb{L} : \\dot{\\varepsilon} \\ge 0$ 对所有 $\\dot{\\varepsilon}$ 成立的意义上是对称且半正定的。\n\n从针对等温过程特化的热力学第一和第二定律出发，并使用 Coleman–Noll 步骤，推导单位体积的局域熵产生率 $\\xi$（用 $M$、$\\nabla \\mu$、$\\mathbb{L}$、$\\dot{\\varepsilon}$ 和 $T$ 表示）。然后，在给定 $M0$ 且 $\\mathbb{L}$ 是半正定的条件下，验证对于所有容许过程都有 $\\xi \\ge 0$。将最终的熵产生率密度表示为单位为 $\\mathrm{W}\\,\\mathrm{K}^{-1}\\,\\mathrm{m}^{-3}$ 的单个闭式解析表达式。在最终的方框表达式中不要包含单位。",
            "solution": "本问题要求推导等温化学-力学系统的单位体积局域熵产生率 $\\xi$。此推导将基于不可逆热力学原理和 Coleman–Noll 步骤。\n\n分析始于热力学第一和第二定律组合的局域形式，即针对存在质量输运的材料体积的克劳修斯-杜亥姆不等式。对于温度为 $T$ 的等温过程，其中单位体积的亥姆霍兹自由能密度 $\\psi$ 是状态变量（在此情况下为无穷小应变张量 $\\varepsilon$ 和物质浓度 $c$）的函数，单位体积的耗散率 $\\mathcal{D}$ 必须为非负。这表示为：\n$$\n\\mathcal{D} = \\sigma : \\dot{\\varepsilon} - \\dot{\\psi} - \\mathbf{J} \\cdot \\nabla\\mu \\ge 0\n$$\n此处，$\\sigma$ 是柯西应力张量，$\\dot{\\varepsilon}$ 是应变率，$\\dot{\\psi}$ 是亥姆霍兹自由能密度的物质时间导数，$\\mathbf{J}$ 是物质的扩散通量，$\\nabla\\mu$ 是化学势的梯度。$\\sigma:\\dot{\\varepsilon}$ 项代表应力功率，$\\dot{\\psi}$ 是储能变化率，而 $\\mathbf{J} \\cdot \\nabla\\mu$ 是与沿化学势梯度扩散相关的耗散。局域熵产生率 $\\xi$ 通过 $\\mathcal{D} = T\\xi$ 与耗散率相关。因此，该不等式等价于 $T\\xi \\ge 0$。\n\n问题陈述亥姆霍兹自由能密度是应变和浓度的函数，$\\psi = \\psi(\\varepsilon, c)$。使用链式法则，其物质时间导数为：\n$$\n\\dot{\\psi} = \\frac{\\partial \\psi}{\\partial \\varepsilon} : \\dot{\\varepsilon} + \\frac{\\partial \\psi}{\\partial c} \\dot{c}\n$$\n在无化学反应的情况下，物质质量平衡方程由 $\\dot{c} + \\nabla \\cdot \\mathbf{J} = 0$ 给出。\n\n为应用 Coleman–Noll 步骤，我们将 $\\dot{\\psi}$ 的表达式代入耗散不等式。标准步骤始于一个包含所有潜在依赖关系的不等式。从第一性原理推导出的更完整的耗散不等式形式为：\n$$\n\\mathcal{D} = \\sigma : \\dot{\\varepsilon} + \\mu\\dot{c} - \\dot{\\psi} - \\mathbf{J} \\cdot \\nabla\\mu \\ge 0\n$$\n代入 $\\dot{\\psi}$ 的链式法则表达式：\n$$\n\\mathcal{D} = \\sigma : \\dot{\\varepsilon} + \\mu\\dot{c} - \\left( \\frac{\\partial \\psi}{\\partial \\varepsilon} : \\dot{\\varepsilon} + \\frac{\\partial \\psi}{\\partial c} \\dot{c} \\right) - \\mathbf{J} \\cdot \\nabla\\mu \\ge 0\n$$\n我们按率 $\\dot{\\varepsilon}$ 和 $\\dot{c}$ 对各项进行分组：\n$$\n\\mathcal{D} = \\left( \\sigma - \\frac{\\partial \\psi}{\\partial \\varepsilon} \\right) : \\dot{\\varepsilon} + \\left( \\mu - \\frac{\\partial \\psi}{\\partial c} \\right) \\dot{c} - \\mathbf{J} \\cdot \\nabla\\mu \\ge 0\n$$\nColeman–Noll 步骤假定该不等式必须对任何容许的热力学过程都成立，即对率 $\\dot{\\varepsilon}$ 和 $\\dot{c}$ 以及梯度 $\\nabla\\mu$ 的任何选择都成立。乘以可任意变化的率的项必须为零，以防止不等式被违反。率 $\\dot{\\varepsilon}$ 和 $\\dot{c}$ 独立于当前状态 $(\\varepsilon, c)$ 和空间梯度。如果 $\\dot{c}$ 的系数 $(\\mu - \\partial\\psi/\\partial c)$ 不为零，则可以选择一个过程，其中 $\\dot{\\varepsilon} = \\mathbf{0}$ 且 $\\nabla\\mu = \\mathbf{0}$，但 $\\dot{c}$ 很大且其符号与 $(\\mu - \\partial\\psi/\\partial c)$ 相反，这将违反不等式 $\\mathcal{D} \\ge 0$。因此，为使所有过程都满足第二定律，其系数必须为零：\n$$\n\\mu - \\frac{\\partial \\psi}{\\partial c} = 0 \\implies \\mu = \\frac{\\partial \\psi}{\\partial c}\n$$\n这就确定了驱动扩散的化学势 $\\mu$ 即为问题中定义的平衡化学势 $\\mu_{\\mathrm{eq}} = \\partial \\psi / \\partial c$。\n\n基于此结果，耗散不等式简化为所谓的*残余耗散不等式*：\n$$\n\\mathcal{D} = \\left( \\sigma - \\frac{\\partial \\psi}{\\partial \\varepsilon} \\right) : \\dot{\\varepsilon} - \\mathbf{J} \\cdot \\nabla\\mu \\ge 0\n$$\n问题将平衡应力定义为 $\\sigma_{\\mathrm{eq}} = \\partial \\psi / \\partial \\varepsilon$，并将总应力定义为一个加性分解 $\\sigma = \\sigma_{\\mathrm{eq}} + \\sigma_{\\mathrm{d}}$，其中 $\\sigma_{\\mathrm{d}}$ 是耗散（粘性）应力。因此，括号中的项正是耗散应力：\n$$\n\\sigma - \\frac{\\partial \\psi}{\\partial \\varepsilon} = \\sigma - \\sigma_{\\mathrm{eq}} = \\sigma_{\\mathrm{d}}\n$$\n将此代入残余不等式，得到：\n$$\n\\mathcal{D} = \\sigma_{\\mathrm{d}} : \\dot{\\varepsilon} - \\mathbf{J} \\cdot \\nabla\\mu \\ge 0\n$$\n该表达式将耗散分为两个贡献：一个来自机械粘性（$\\sigma_{\\mathrm{d}} : \\dot{\\varepsilon}$），另一个来自化学扩散（$-\\mathbf{J} \\cdot \\nabla\\mu$）。\n\n现在，我们引入给定的耗散现象本构定律：\n1.  粘性应力：$\\sigma_{\\mathrm{d}} = \\mathbb{L} : \\dot{\\varepsilon}$\n2.  扩散通量：$\\mathbf{J} = - M \\nabla \\mu$\n\n将这些形式代入 $\\mathcal{D}$ 的表达式中：\n$$\n\\mathcal{D} = (\\mathbb{L} : \\dot{\\varepsilon}) : \\dot{\\varepsilon} - (-M \\nabla \\mu) \\cdot \\nabla \\mu\n$$\n使用标准的张量和矢量表示法，这变为：\n$$\n\\mathcal{D} = \\dot{\\varepsilon} : \\mathbb{L} : \\dot{\\varepsilon} + M |\\nabla \\mu|^2\n$$\n单位体积的局域熵产生率 $\\xi$ 由 $\\xi = \\mathcal{D}/T$ 给出。因此：\n$$\n\\xi = \\frac{1}{T} \\left( \\dot{\\varepsilon} : \\mathbb{L} : \\dot{\\varepsilon} + M |\\nabla \\mu|^2 \\right)\n$$\n这就是局域熵产生率的最终表达式。\n\n最后，我们必须验证对于所有容许过程，$\\xi \\ge 0$。问题提供了必要的条件：\n-   温度为正：$T  0$。\n-   迁移率为正：$M  0$。\n-   四阶粘度张量 $\\mathbb{L}$ 是半正定的，根据定义，这意味着对于任何对称二阶张量 $\\dot{\\varepsilon}$，二次型 $\\dot{\\varepsilon} : \\mathbb{L} : \\dot{\\varepsilon} \\ge 0$。\n-   项 $|\\nabla \\mu|^2 = \\nabla \\mu \\cdot \\nabla \\mu$ 是一个矢量的模的平方，它总是非负的：$|\\nabla \\mu|^2 \\ge 0$。\n\n综合这些事实：\n-   机械耗散项 $\\dot{\\varepsilon} : \\mathbb{L} : \\dot{\\varepsilon}$ 是非负的。\n-   化学耗散项 $M |\\nabla \\mu|^2$ 是一个正数（$M$）和一个非负数（$|\\nabla \\mu|^2$）的乘积，因此它也是非负的。\n-   两个非负项之和 $(\\dot{\\varepsilon} : \\mathbb{L} : \\dot{\\varepsilon} + M |\\nabla \\mu|^2)$ 是非负的。\n-   由于 $T  0$，用 $T$ 除以这个和会保持其非负性。\n\n因此，$\\xi \\ge 0$ 得到保证，这证实了给定的本构模型与热力学第二定律是一致的。",
            "answer": "$$\n\\boxed{\\frac{1}{T} \\left( \\dot{\\varepsilon} : \\mathbb{L} : \\dot{\\varepsilon} + M |\\nabla \\mu|^2 \\right)}\n$$"
        },
        {
            "introduction": "多尺度建模的核心在于建立不同尺度之间的联系，其中“自下而上”的参数化是一种关键方法。本练习提供了一个具体的实例，展示了如何从原子尺度计算中提取信息，为描述微观结构演化的相场模型校准参数。您将学习如何将原子尺度的物理量，如界面能和迁移激活能，与连续介质模型中的梯度能量系数和动力学系数联系起来，从而使介观尺度的模拟具有预测能力。",
            "id": "3825459",
            "problem": "一种工程合金在介观尺度上通过非守恒序参量相场（Allen-Cahn）描述进行建模，以捕捉在两相之间小的体自由能密度驱动力作用下迁移的平面界面。介观尺度的自由能泛函为\n$$\nF[\\phi]=\\int_{\\mathbb{R}} \\left[ \\frac{W}{4}\\left(\\phi^{2}-1\\right)^{2}+\\frac{\\kappa}{2}\\left(\\partial_{x}\\phi\\right)^{2} - \\Delta f\\, h(\\phi)\\right]\\,\\mathrm{d}x,\n$$\n其中 $\\phi$ 是一个无量纲序参量，其体相极小值位于 $\\phi=\\pm 1$，$W$ 是一个正的能垒参数，$\\kappa$ 是梯度能量系数，$\\Delta f$ 是一个有利于某一相的微小体自由能密度差，$h(\\phi)$ 是一个光滑插值函数，其选择满足 $h(1)-h(-1)=1$。动力学遵循 Allen-Cahn 方程 $\\partial_{t}\\phi=-L \\,\\delta F/\\delta \\phi$，其中 $L$ 是待校准的动力学系数。\n\n在原子尺度上，在温度 $T$ 下获得以下信息：穿过界面的界面结构剖面可以很好地用 $\\phi(x)\\approx \\tanh(x/\\ell)$ 拟合，其中 $\\ell$ 是特征宽度参数；界面自由能（表面张力）为 $\\sigma$；界面迁移由过渡态理论（TST）控制，每个格点的尝试频率为 $\\nu_{0}$，活化能垒为 $E_{m}$。在每个原子存在微小化学势偏置 $\\Delta \\mu$（其中 $\\Delta f=\\Delta \\mu/\\Omega$，$\\Omega$ 是原子体积）的情况下，每个格点的净反应速率遵循 TST 的线性响应。界面格点密度为 $1/a^{2}$，其中 $a^{2}$ 是每个界面格点的面积。\n\n在温度 $T$ 下，一个特定应用领域（面心立方合金中的平面共格沉淀相-基体边界）的数据如下：\n- 温度 $T = 800\\,\\mathrm{K}$，\n- 电子伏特-焦耳转换 $1\\,\\mathrm{eV}=1.602176634\\times 10^{-19}\\,\\mathrm{J}$，\n- 玻尔兹曼常数 $k_{B}=1.380649\\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$，\n- 活化能垒 $E_{m}=0.75\\,\\mathrm{eV}$，\n- 尝试频率 $\\nu_{0}=1.0\\times 10^{13}\\,\\mathrm{s^{-1}}$，\n- 原子体积 $\\Omega=1.18\\times 10^{-29}\\,\\mathrm{m^{3}}$，\n- 界面格点面积 $a^{2}=6.5\\times 10^{-20}\\,\\mathrm{m^{2}}$，\n- 表面张力 $\\sigma=0.25\\,\\mathrm{J\\,m^{-2}}$，\n- Tanh 拟合宽度参数 $\\ell=3.5\\times 10^{-10}\\,\\mathrm{m}$。\n\n仅从基本原理和核心定义（静态界面剖面的变分平衡、表面张力定义为单位面积的过剩自由能、能量-体积关系 $\\Delta f=\\Delta\\mu/\\Omega$ 的守恒，以及具有线性响应的过渡态理论）出发，执行以下操作：\n\n1. 推导梯度能量系数 $\\kappa$ 关于 $\\sigma$ 和 $\\ell$ 的表达式。\n2. 使用给定的每个格点的物理量，通过 TST 推导尖锐界面迁移率 $m_{\\text{int}}$，它通过 $v=m_{\\text{int}}\\,\\Delta f$ 将界面速度 $v$ 与驱动压力 $\\Delta f$ 联系起来。\n3. 使用给定 $h(\\phi)$ 归一化下 Allen-Cahn 动力学行波解的可解性条件，推导 Allen-Cahn 动力学系数 $L$ 和尖锐界面迁移率 $m_{\\text{int}}$ 之间的关系，并得到 $L$ 关于 $m_{\\text{int}}$ 和 $\\ell$ 的表达式。\n\n使用上述数据计算 $L$ 和 $\\kappa$ 的数值。将 $L$ 以 $\\mathrm{m^{3}\\,J^{-1}\\,s^{-1}}$ 为单位表示，$\\kappa$ 以 $\\mathrm{J\\,m^{-1}}$ 为单位表示。将两者均四舍五入到三位有效数字。将最终数值答案以单行矩阵 $\\big(L,\\kappa\\big)$ 的形式报告。",
            "solution": "我们从基本原理出发。\n\n首先，我们通过在无驱动力（即 $\\Delta f=0$）的情况下最小化自由能来获得静态一维界面剖面。Euler-Lagrange 方程为\n$$\n\\frac{\\delta F}{\\delta \\phi}= \\frac{\\partial f_{0}}{\\partial \\phi}-\\kappa\\,\\partial_{x}^{2}\\phi=0,\n$$\n其中 $f_{0}(\\phi)=\\frac{W}{4}\\left(\\phi^{2}-1\\right)^{2}$。两边乘以 $\\partial_{x}\\phi$ 并积分一次，得到第一积分\n$$\n\\kappa \\left(\\partial_{x}\\phi\\right)^{2}=2 f_{0}(\\phi)=\\frac{W}{2}\\left(\\phi^{2}-1\\right)^{2},\n$$\n这里我们使用了当 $x\\to \\pm \\infty$ 时 $\\partial_{x}\\phi\\to 0$ 和 $f_{0}\\to 0$。分离变量，\n$$\n\\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}=\\sqrt{\\frac{W}{2\\kappa}}\\left(1-\\phi^{2}\\right).\n$$\n积分得到标准的 tanh-kink 解\n$$\n\\phi_{0}(x)=\\tanh\\!\\left(\\frac{x}{\\ell}\\right),\\quad \\ell=\\sqrt{\\frac{2\\kappa}{W}}.\n$$\n\n表面张力 $\\sigma$ 是与平衡界面相关的单位面积的过剩自由能：\n$$\n\\sigma=\\int_{-\\infty}^{\\infty}\\left[\\frac{W}{4}\\left(\\phi_{0}^{2}-1\\right)^{2}+\\frac{\\kappa}{2}\\left(\\partial_{x}\\phi_{0}\\right)^{2}\\right]\\mathrm{d}x.\n$$\n使用第一积分 $\\kappa (\\partial_{x}\\phi_{0})^{2}=2 f_{0}(\\phi_{0})$，我们发现\n$$\n\\sigma=\\int_{-\\infty}^{\\infty} \\left[f_{0}(\\phi_{0})+\\frac{1}{2}\\kappa (\\partial_{x}\\phi_{0})^{2}\\right]\\mathrm{d}x=\\int_{-\\infty}^{\\infty} 2 f_{0}(\\phi_{0})\\,\\mathrm{d}x.\n$$\n通过 $\\mathrm{d}x=\\mathrm{d}\\phi/(\\partial_{x}\\phi)$ 将变量从 $x$ 切换到 $\\phi$，并代入 $\\partial_{x}\\phi=\\sqrt{\\frac{W}{2\\kappa}}(1-\\phi^{2})$，得到\n$$\n\\sigma=2\\int_{-1}^{1} f_{0}(\\phi)\\,\\frac{\\mathrm{d}\\phi}{\\partial_{x}\\phi}=2\\int_{-1}^{1} \\frac{\\frac{W}{4}(\\phi^{2}-1)^{2}}{\\sqrt{\\frac{W}{2\\kappa}}(1-\\phi^{2})}\\,\\mathrm{d}\\phi\n= \\sqrt{2\\kappa W}\\int_{-1}^{1} \\frac{1-\\phi^{2}}{2}\\,\\mathrm{d}\\phi.\n$$\n计算该积分，\n$$\n\\int_{-1}^{1} \\frac{1-\\phi^{2}}{2}\\,\\mathrm{d}\\phi=\\left.\\frac{\\phi}{2}-\\frac{\\phi^{3}}{6}\\right|_{-1}^{1}=\\left(\\frac{1}{2}-\\frac{1}{6}\\right)-\\left(-\\frac{1}{2}+\\frac{1}{6}\\right)=\\frac{2}{3}.\n$$\n因此，\n$$\n\\sigma=\\sqrt{2\\kappa W}\\,\\frac{2}{3}=\\frac{2\\sqrt{2}}{3}\\sqrt{\\kappa W}.\n$$\n使用 $\\ell=\\sqrt{\\frac{2\\kappa}{W}}$，我们消去 $W$ 以获得 $\\sigma$、$\\kappa$ 和 $\\ell$ 之间的直接关系。由 $\\ell=\\sqrt{\\frac{2\\kappa}{W}}$ 可得 $W=\\frac{2\\kappa}{\\ell^{2}}$，因此\n$$\n\\sigma=\\frac{2\\sqrt{2}}{3}\\sqrt{\\kappa \\cdot \\frac{2\\kappa}{\\ell^{2}}}=\\frac{4}{3}\\frac{\\kappa}{\\ell}\\quad \\Rightarrow \\quad \\kappa=\\frac{3}{4}\\,\\sigma\\,\\ell.\n$$\n\n接下来，我们将原子动力学与尖锐界面迁移率联系起来。设每个格点的正向和反向反应速率由过渡态理论（TST）给出，其中尝试频率为 $\\nu_{0}$，能垒为 $E_{m}$。在有利于某一相的微小单原子化学势偏置 $\\Delta \\mu$ 下，细致平衡原理在一阶近似 $\\Delta \\mu/(k_{B}T)$ 下，得到净的单位格点反应速率\n$$\nr_{\\text{net}}=\\nu_{0}\\,\\exp\\!\\left(-\\frac{E_{m}}{k_{B}T}\\right)\\,\\frac{\\Delta \\mu}{k_{B}T}.\n$$\n界面格点的面密度为 $1/a^{2}$。单位面积单位时间内的总净反应事件数为 $(1/a^{2})\\,r_{\\text{net}}$。每个净事件使一个原子体积 $\\Omega$ 穿过界面；在平面区域 $A$ 上的体积守恒给出 $v A=\\Omega \\times (\\text{穿过 }A \\text{ 的单位时间净事件数})$，因此沿法线方向的界面速度 $v$ 为\n$$\nv=\\Omega \\left(\\frac{1}{a^{2}}\\,r_{\\text{net}}\\right)=\\frac{\\nu_{0}\\,\\exp\\!\\left(-\\frac{E_{m}}{k_{B}T}\\right)\\,\\Omega}{a^{2}}\\,\\frac{\\Delta \\mu}{k_{B}T}.\n$$\n使用 $\\Delta f=\\Delta \\mu/\\Omega$，我们在 $v=m_{\\text{int}}\\,\\Delta f$ 中确定尖锐界面迁移率 $m_{\\text{int}}$ 为\n$$\nm_{\\text{int}}=\\frac{\\nu_{0}\\,\\exp\\!\\left(-\\frac{E_{m}}{k_{B}T}\\right)\\,\\Omega^{2}}{a^{2}\\,k_{B}T}.\n$$\n\n最后，我们通过在小驱动力下，对于选定的归一化条件 $h(1)-h(-1)=1$ 的行波解的可解性条件，将 Allen-Cahn 动力学系数 $L$ 与 $m_{\\text{int}}$ 联系起来。考虑一个具有微小速度 $v$ 的行波解 $\\phi(x,t)=\\phi_{0}(x-vt)$。将其代入 $\\partial_{t}\\phi=-L\\left(\\frac{\\partial f_{0}}{\\partial \\phi}-\\kappa \\partial_{x}^{2}\\phi-\\Delta f\\, h'(\\phi)\\right)$，两边乘以 $\\partial_{x}\\phi_{0}$，并对 $x$ 积分，得到\n$$\nv\\int_{-\\infty}^{\\infty}\\left(\\partial_{x}\\phi_{0}\\right)^{2}\\mathrm{d}x\n= L\\,\\Delta f \\int_{-\\infty}^{\\infty} h'(\\phi_{0})\\,\\partial_{x}\\phi_{0}\\,\\mathrm{d}x\n= L\\,\\Delta f \\left[h(\\phi_{0})\\right]_{-\\infty}^{\\infty}=L\\,\\Delta f\\,\\big(h(1)-h(-1)\\big)=L\\,\\Delta f,\n$$\n其中与 $\\frac{\\partial f_{0}}{\\partial \\phi}-\\kappa \\partial_{x}^{2}\\phi$ 成正比的项因平衡方程而消失。对于 $\\phi_{0}(x)=\\tanh(x/\\ell)$，我们有 $\\partial_{x}\\phi_{0}=(1/\\ell)\\,\\mathrm{sech}^{2}(x/\\ell)$，所以\n$$\n\\int_{-\\infty}^{\\infty}\\left(\\partial_{x}\\phi_{0}\\right)^{2}\\mathrm{d}x\n=\\int_{-\\infty}^{\\infty}\\frac{1}{\\ell^{2}}\\,\\mathrm{sech}^{4}\\!\\left(\\frac{x}{\\ell}\\right)\\mathrm{d}x\n=\\frac{1}{\\ell}\\int_{-\\infty}^{\\infty}\\mathrm{sech}^{4} u\\,\\mathrm{d}u=\\frac{1}{\\ell}\\cdot \\frac{4}{3}=\\frac{4}{3\\ell},\n$$\n这里我们使用了标准积分 $\\int_{-\\infty}^{\\infty}\\mathrm{sech}^{4}u\\,\\mathrm{d}u=\\frac{4}{3}$。因此，\n$$\nv=\\frac{L\\,\\Delta f}{\\int (\\partial_{x}\\phi_{0})^{2}\\mathrm{d}x}=L\\,\\Delta f \\cdot \\frac{3\\ell}{4}.\n$$\n与尖锐界面形式 $v=m_{\\text{int}}\\,\\Delta f$ 相匹配，得到\n$$\nm_{\\text{int}}=L\\,\\frac{3\\ell}{4}\\quad \\Rightarrow \\quad L=\\frac{4}{3\\ell}\\,m_{\\text{int}}.\n$$\n\n现在我们使用所提供的数据数值计算 $\\kappa$ 和 $L$。\n\n从 $\\kappa=\\frac{3}{4}\\sigma \\ell$ 计算 $\\kappa$：\n- $\\sigma=0.25\\,\\mathrm{J\\,m^{-2}}$,\n- $\\ell=3.5\\times 10^{-10}\\,\\mathrm{m}$,\n所以\n$$\n\\kappa=\\frac{3}{4}\\times 0.25 \\times 3.5\\times 10^{-10}\n=\\frac{0.75\\times 3.5\\times 10^{-10}}{4}\n=\\frac{2.625\\times 10^{-10}}{4}\n=6.5625\\times 10^{-11}\\,\\mathrm{J\\,m^{-1}}.\n$$\n\n计算 $m_{\\text{int}}$：\n- 将 $E_{m}$ 转换为焦耳：$E_{m}=0.75\\times 1.602176634\\times 10^{-19}=1.2016324755\\times 10^{-19}\\,\\mathrm{J}$，\n- $k_{B}T=1.380649\\times 10^{-23}\\times 800=1.1045192\\times 10^{-20}\\,\\mathrm{J}$，\n- 阿伦尼乌斯因子 $\\exp\\!\\left(-\\frac{E_{m}}{k_{B}T}\\right)=\\exp(-10.88)\\approx 1.883\\times 10^{-5}$，\n- 尝试频率 $\\nu_{0}=1.0\\times 10^{13}\\,\\mathrm{s^{-1}}$，所以无偏置速率因子 $\\nu_{0}\\exp(-E_{m}/k_{B}T)\\approx 1.883\\times 10^{8}\\,\\mathrm{s^{-1}}$，\n- $\\Omega=1.18\\times 10^{-29}\\,\\mathrm{m^{3}}\\Rightarrow \\Omega^{2}=1.3924\\times 10^{-58}\\,\\mathrm{m^{6}}$，\n- $a^{2}k_{B}T=6.5\\times 10^{-20}\\times 1.1045192\\times 10^{-20}=7.1793748\\times 10^{-40}\\,\\mathrm{J\\,m^{2}}$。\n\n因此\n$$\nm_{\\text{int}}=\\frac{\\nu_{0}\\exp(-E_{m}/k_{B}T)\\,\\Omega^{2}}{a^{2}k_{B}T}\n=\\frac{1.883\\times 10^{8}\\times 1.3924\\times 10^{-58}}{7.1793748\\times 10^{-40}}\n=3.654\\times 10^{-11}\\,\\mathrm{m^{4}\\,J^{-1}\\,s^{-1}}.\n$$\n\n最后，使用 $\\ell=3.5\\times 10^{-10}\\,\\mathrm{m}$ 计算 $L=\\frac{4}{3\\ell}m_{\\text{int}}$：\n$$\nL=\\frac{4}{3\\times 3.5\\times 10^{-10}}\\times 3.654\\times 10^{-11}\n=\\frac{4\\times 3.654\\times 10^{-11}}{1.05\\times 10^{-9}}\n=\\frac{1.4616\\times 10^{-10}}{1.05\\times 10^{-9}}\n=0.1392\\,\\mathrm{m^{3}\\,J^{-1}\\,s^{-1}}.\n$$\n\n四舍五入到三位有效数字，\n$$\nL=0.139\\,\\mathrm{m^{3}\\,J^{-1}\\,s^{-1}},\\quad \\kappa=6.56\\times 10^{-11}\\,\\mathrm{J\\,m^{-1}}.\n$$\n\n以行矩阵 $\\big(L,\\kappa\\big)$ 的形式报告。",
            "answer": "$$\\boxed{\\begin{pmatrix}0.139  6.56 \\times 10^{-11}\\end{pmatrix}}$$"
        },
        {
            "introduction": "在将模型应用于复杂的未知系统之前，验证其准确性是建模工作流程中至关重要的一步。本练习将指导您构建一个用于均匀化方法的基准问题，这是一种常见的验证策略。您将推导出一个简单层状复合材料的有效热导率的解析解，并将其与直接解析微观结构的数值模拟结果进行比较，从而验证数值实现和均匀化假设的正确性。",
            "id": "3825528",
            "problem": "考虑一个通过周期性层状复合杆的一维稳态热传导问题。该杆由重复的单元组成，每个单元由两层不同的均质材料构成，其热导率分别为 $k_1$ 和 $k_2$（单位为 $\\mathrm{W/(m\\cdot K)}$），层厚度分别为 $t_1$ 和 $t_2$（单位为 $\\mathrm{m}$）。单元长度为 $p = t_1 + t_2$。该杆由 $N$ 个相同的单元沿热流方向堆叠而成，因此总长度为 $L = N p$。横截面积为 $A$（单位为 $\\mathrm{m^2}$）。边界温度为 $T(0) = T_\\text{left}$ 和 $T(L) = T_\\text{right}$（单位为 $\\mathrm{K}$）。热流方向垂直于各层。\n\n您的任务是构建具有解析解的层状介质均匀化基准问题，并用它们来跨尺度验证数值实现。验证必须通过将均匀化的宏观尺度热通量预测与一个使用有限体积离散化解析各层的微观尺度数值计算进行比较来执行。\n\n请基于基本定律进行推导：使用傅里叶热传导定律（稳态），$q(x) = - k(x) \\frac{d T}{d x}$，其中 $q(x)$ 是局部热通量（单位为 $\\mathrm{W/m^2}$）；以及稳态下的能量守恒定律，$\\frac{d}{d x} \\left( k(x) \\frac{d T}{d x} \\right) = 0$，这意味着沿 $x$ 方向的热通量是恒定的。不要预先假设任何目标均匀化公式。\n\n任务：\n\n1. 从第一性原理推导在垂直于各层的热流作用下，一个单元的有效热导率 $k_\\text{eff}$ 的解析表达式。仅用 $k_1$、$k_2$、$t_1$ 和 $t_2$ 表示 $k_\\text{eff}$，不要引用任何已知的混合法则。然后，用 $k_\\text{eff}$、$L$ 以及施加的温差 $\\Delta T = T_\\text{left} - T_\\text{right}$ 来表示整个杆的均匀化宏观热通量 $q_\\text{eff}$（单位为 $\\mathrm{W/m^2}$）。\n\n2. 使用有限体积法（FVM）实现一个数值微观尺度模型。将长度为 $L$ 的杆离散为 $n_\\text{cells} = c_p \\, N$ 个大小均匀的控制体积，其中 $c_p$ 是每个周期（单元）的单元数。对于每个中心坐标为 $x_i$ 的控制体积 $i$，根据周期性分层为其分配局部热导率 $k_i$：如果 $x_i \\pmod p  t_1$，则 $k_i = k_1$，否则 $k_i = k_2$。通过对每个单元的热阻 $r_i = \\frac{\\Delta x}{k_i A}$求和，计算总热阻 $R_\\text{num}$（单位为 $\\mathrm{K/W}$），其中 $\\Delta x = \\frac{L}{n_\\text{cells}}$ 是均匀的单元长度。根据 $R_\\text{num}$ 计算数值热通量 $q_\\text{num}$（单位为 $\\mathrm{W/m^2}$）。用指定的单位表示所有量。\n\n3. 计算宏观尺度均匀化预测与微观尺度数值计算之间的相对误差 $e$（无量纲），公式为 $e = \\frac{| q_\\text{num} - q_\\text{eff} |}{| q_\\text{eff} |}$。该量评估了跨尺度的验证。报告每个测试用例的 $e$。\n\n最终程序必须实现上述计算，并为以下测试套件生成结果。对于每个测试用例，请严格按照提供的参数进行，并保持所有单位如指定。每个测试用例的输出是相对误差 $e$（无量纲），一个浮点数。\n\n测试套件：\n\n- 用例 $1$（一般对比度，中等离散化）：$k_1 = 1$ $\\mathrm{W/(m\\cdot K)}$, $k_2 = 10$ $\\mathrm{W/(m\\cdot K)}$, $t_1 = 0.003$ $\\mathrm{m}$, $t_2 = 0.008$ $\\mathrm{m}$, $N = 50$, $A = 1$ $\\mathrm{m^2}$, $T_\\text{left} = 300$ $\\mathrm{K}$, $T_\\text{right} = 200$ $\\mathrm{K}$, $c_p = 10$。\n\n- 用例 $2$（边界条件：相同材料）：$k_1 = 5$ $\\mathrm{W/(m\\cdot K)}$, $k_2 = 5$ $\\mathrm{W/(m\\cdot K)}$, $t_1 = 0.004$ $\\mathrm{m}$, $t_2 = 0.006$ $\\mathrm{m}$, $N = 40$, $A = 1$ $\\mathrm{m^2}$, $T_\\text{left} = 350$ $\\mathrm{K}$, $T_\\text{right} = 310$ $\\mathrm{K}$, $c_p = 7$。\n\n- 用例 $3$（极端对比度，粗糙离散化）：$k_1 = 1000$ $\\mathrm{W/(m\\cdot K)}$, $k_2 = 0.1$ $\\mathrm{W/(m\\cdot K)}$, $t_1 = 0.005$ $\\mathrm{m}$, $t_2 = 0.005$ $\\mathrm{m}$, $N = 60$, $A = 0.5$ $\\mathrm{m^2}$, $T_\\text{left} = 400$ $\\mathrm{K}$, $T_\\text{right} = 300$ $\\mathrm{K}$, $c_p = 9$。\n\n- 用例 $4$（薄高导热层）：$k_1 = 200$ $\\mathrm{W/(m\\cdot K)}$, $k_2 = 2$ $\\mathrm{W/(m\\cdot K)}$, $t_1 = 0.001$ $\\mathrm{m}$, $t_2 = 0.009$ $\\mathrm{m}$, $N = 30$, $A = 2$ $\\mathrm{m^2}$, $T_\\text{left} = 350$ $\\mathrm{K}$, $T_\\text{right} = 330$ $\\mathrm{K}$, $c_p = 13$。\n\n- 用例 $5$（收敛性检查，用例 $1$ 的精细离散化）：$k_1 = 1$ $\\mathrm{W/(m\\cdot K)}$, $k_2 = 10$ $\\mathrm{W/(m\\cdot K)}$, $t_1 = 0.003$ $\\mathrm{m}$, $t_2 = 0.008$ $\\mathrm{m}$, $N = 50$, $A = 1$ $\\mathrm{m^2}$, $T_\\text{left} = 300$ $\\mathrm{K}$, $T_\\text{right} = 200$ $\\mathrm{K}$, $c_p = 200$。\n\n- 用例 $6$（每个周期单个单元，用例 $3$ 的最强粗尺度混叠）：$k_1 = 1000$ $\\mathrm{W/(m\\cdot K)}$, $k_2 = 0.1$ $\\mathrm{W/(m\\cdot K)}$, $t_1 = 0.005$ $\\mathrm{m}$, $t_2 = 0.005$ $\\mathrm{m}$, $N = 60$, $A = 0.5$ $\\mathrm{m^2}$, $T_\\text{left} = 400$ $\\mathrm{K}$, $T_\\text{right} = 300$ $\\mathrm{K}$, $c_p = 1$。\n\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$[ \\text{result}_1, \\text{result}_2, \\text{result}_3, \\ldots ]$），其中每个 $\\text{result}_i$ 是相应测试用例的相对误差 $e$。将每个 $\\text{result}_i$ 表示为一个无单位（无量纲）的浮点数。",
            "solution": "该问题要求推导并比较一维稳态热传导通过周期性复合材料的解析解和数值解。此过程可作为多尺度建模的验证测试，其中均匀化的宏观模型通过与细粒度的微观模拟进行对比来验证。\n\n### 第1部分：解析均匀化与宏观热通量\n\n控制物理原理是傅里叶热传导定律和稳态下的能量守恒。对于一维系统，这些表示为：\n\n1.  傅里叶定律：局部热通量 $q(x)$ 与温度梯度成正比：\n    $$q(x) = -k(x) \\frac{dT}{dx}$$\n    其中 $k(x)$ 是空间变化的热导率，$T(x)$ 是温度。\n\n2.  能量守恒：在没有热源或热汇的稳态下，热通量的散度为零：\n    $$\\frac{d}{dx} q(x) = 0$$\n    代入傅里叶定律得到控制微分方程：\n    $$\\frac{d}{dx} \\left( k(x) \\frac{dT}{dx} \\right) = 0$$\n\n对能量守恒方程关于 $x$ 积分一次，表明热通量 $q(x)$ 沿杆的长度必须是恒定的。我们用 $q$ 表示这个恒定的通量。\n$$q = -k(x) \\frac{dT}{dx}$$\n我们可以重新整理这个方程来表示温度梯度：\n$$\\frac{dT}{dx} = -\\frac{q}{k(x)}$$\n\n为了找到有效热导率 $k_\\text{eff}$，我们分析一个长度为 $p = t_1 + t_2$ 的重复单元。通过对温度梯度从 $x=0$ 到 $x=p$ 积分，可以找到跨越该单元的温降 $\\Delta T_\\text{cell}$：\n$$\\Delta T_\\text{cell} = T(p) - T(0) = \\int_{0}^{p} \\frac{dT}{dx} dx = \\int_{0}^{p} -\\frac{q}{k(x)} dx$$\n由于 $q$ 是常数，而 $k(x)$ 是分段常数（当 $0 \\le x  t_1$ 时 $k(x) = k_1$，当 $t_1 \\le x  p$ 时 $k(x) = k_2$），我们可以将积分拆分：\n$$\\Delta T_\\text{cell} = -q \\left( \\int_{0}^{t_1} \\frac{1}{k_1} dx + \\int_{t_1}^{p} \\frac{1}{k_2} dx \\right) = -q \\left( \\frac{t_1}{k_1} + \\frac{t_2}{k_2} \\right)$$\n项 $\\frac{t_1}{k_1} + \\frac{t_2}{k_2}$ 表示单元的总热阻（单位面积），即两个串联层的热阻之和。\n\n在均匀化模型中，该单元被视为由具有有效热导率 $k_\\text{eff}$ 的均质材料构成的单层。跨越这种有效材料的温降将由傅里叶定律给出：\n$$\\Delta T_\\text{cell} = -q \\frac{p}{k_\\text{eff}}$$\n通过令两个 $\\Delta T_\\text{cell}$ 的表达式相等，我们可以解出 $k_\\text{eff}$：\n$$-q \\frac{p}{k_\\text{eff}} = -q \\left( \\frac{t_1}{k_1} + \\frac{t_2}{k_2} \\right)$$\n$$\\frac{p}{k_\\text{eff}} = \\frac{t_1}{k_1} + \\frac{t_2}{k_2}$$\n代入 $p = t_1+t_2$ 并解出 $k_\\text{eff}$，得到有效热导率的解析表达式：\n$$k_\\text{eff} = \\frac{t_1 + t_2}{\\frac{t_1}{k_1} + \\frac{t_2}{k_2}}$$\n这是热导率的调和平均值，按各自的厚度加权。\n\n使用这个 $k_\\text{eff}$，整个长度为 $L = Np$ 的杆可以被视为一个均匀介质。在施加的温差 $\\Delta T = T_\\text{left} - T_\\text{right}$ 下，宏观热通量 $q_\\text{eff}$ 由下式给出：\n$$q_\\text{eff} = -k_\\text{eff} \\frac{T(L) - T(0)}{L} = -k_\\text{eff} \\frac{T_\\text{right} - T_\\text{left}}{L} = k_\\text{eff} \\frac{T_\\text{left} - T_\\text{right}}{L}$$\n\n### 第2部分：数值微观尺度模型\n\n微观尺度模型采用有限体积法（FVM），将长度为 $L$ 的杆离散为 $n_\\text{cells} = c_p N$ 个均匀的控制体积，每个长度为 $\\Delta x = L/n_\\text{cells}$。杆的总热阻是这些串联的单个体积的热阻之和。\n\n单个控制体积 $i$ 的热阻 $r_i$ 由下式给出：\n$$r_i = \\frac{\\Delta x}{k_i A}$$\n其中 $k_i$ 是单元 $i$ 中心处材料的热导率，$A$ 是横截面积。杆的总数值热阻 $R_\\text{num}$ 是这些单个热阻的和：\n$$R_\\text{num} = \\sum_{i=0}^{n_\\text{cells}-1} r_i = \\sum_{i=0}^{n_\\text{cells}-1} \\frac{\\Delta x}{k_i A}$$\n每个单元的热导率 $k_i$ 是根据其中心位置 $x_i = (i + 0.5)\\Delta x$ 确定的。在一个重复单元内的位置 $x_\\text{local} = x_i \\pmod p$ 决定了材料。\n$$k_i = \\begin{cases} k_1  \\text{若 } x_i \\pmod p  t_1 \\\\ k_2  \\text{若 } x_i \\pmod p \\ge t_1 \\end{cases}$$\n通过杆的总热流率（单位：瓦特）$Q_\\text{num}$ 然后使用总热阻和总温差计算：\n$$Q_\\text{num} = \\frac{\\Delta T}{R_\\text{num}} = \\frac{T_\\text{left} - T_\\text{right}}{R_\\text{num}}$$\n最后，数值热通量（单位：$\\mathrm{W/m^2}$）$q_\\text{num}$ 是单位面积的热流率：\n$$q_\\text{num} = \\frac{Q_\\text{num}}{A} = \\frac{T_\\text{left} - T_\\text{right}}{A \\cdot R_\\text{num}} = \\frac{T_\\text{left} - T_\\text{right}}{A \\sum_{i=0}^{n_\\text{cells}-1} \\frac{\\Delta x}{k_i A}} = \\frac{T_\\text{left} - T_\\text{right}}{\\sum_{i=0}^{n_\\text{cells}-1} \\frac{\\Delta x}{k_i}}$$\n该数值方法使用中点法则来近似 $1/k(x)$ 在整个域上的积分，其精度取决于离散化的精细程度，由 $c_p$ 控制。\n\n### 第3部分：相对误差计算\n\n通过将数值结果与解析均匀化预测进行比较来完成验证。相对误差 $e$ 计算如下：\n$$e = \\frac{| q_\\text{num} - q_\\text{eff} |}{| q_\\text{eff} |}$$\n这个误差量化了由均匀化近似和数值离散化共同引入的差异。对于一个一致的数值格式，当每个周期的单元数 $c_p$ 增加时，这个误差应趋于零。非零误差突显了微观结构解析模型与简化的宏观模型之间的差异。\n\n以下代码为指定的测试用例实现了这些计算。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves a series of benchmark problems for homogenization in a 1D layered composite bar.\n    For each case, it computes an analytical effective heat flux and a numerical\n    heat flux from a Finite Volume Method (FVM) simulation, then reports the relative error.\n    \"\"\"\n    \n    test_cases = [\n        # Case 1: general contrast, moderate discretization\n        {'k1': 1.0, 'k2': 10.0, 't1': 0.003, 't2': 0.008, 'N': 50, 'A': 1.0, 'T_left': 300.0, 'T_right': 200.0, 'cp': 10},\n        # Case 2: boundary condition: identical materials\n        {'k1': 5.0, 'k2': 5.0, 't1': 0.004, 't2': 0.006, 'N': 40, 'A': 1.0, 'T_left': 350.0, 'T_right': 310.0, 'cp': 7},\n        # Case 3: extreme contrast, coarse discretization\n        {'k1': 1000.0, 'k2': 0.1, 't1': 0.005, 't2': 0.005, 'N': 60, 'A': 0.5, 'T_left': 400.0, 'T_right': 300.0, 'cp': 9},\n        # Case 4: thin high-conductivity layer\n        {'k1': 200.0, 'k2': 2.0, 't1': 0.001, 't2': 0.009, 'N': 30, 'A': 2.0, 'T_left': 350.0, 'T_right': 330.0, 'cp': 13},\n        # Case 5: convergence check, fine discretization of Case 1\n        {'k1': 1.0, 'k2': 10.0, 't1': 0.003, 't2': 0.008, 'N': 50, 'A': 1.0, 'T_left': 300.0, 'T_right': 200.0, 'cp': 200},\n        # Case 6: single cell per period, strongest coarse-scale aliasing for Case 3\n        {'k1': 1000.0, 'k2': 0.1, 't1': 0.005, 't2': 0.005, 'N': 60, 'A': 0.5, 'T_left': 400.0, 'T_right': 300.0, 'cp': 1},\n    ]\n\n    results = []\n    for params in test_cases:\n        error = calculate_error_for_case(**params)\n        results.append(error)\n\n    # Format output as a single-line comma-separated list in brackets\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef calculate_error_for_case(k1, k2, t1, t2, N, A, T_left, T_right, cp):\n    \"\"\"\n    Calculates the relative error between analytical and numerical heat flux for a single case.\n    \"\"\"\n    \n    # Common parameters\n    p = t1 + t2  # Unit cell length\n    L = N * p    # Total bar length\n    delta_T = T_left - T_right\n\n    # --- Task 1: Analytical Homogenized Solution (q_eff) ---\n    # Effective thermal conductivity\n    k_eff = (t1 + t2) / (t1 / k1 + t2 / k2)\n    \n    # Homogenized (effective) heat flux\n    q_eff = k_eff * delta_T / L\n\n    # --- Task 2: Numerical Microscale Solution (q_num) ---\n    n_cells = cp * N\n    delta_x = L / n_cells\n    \n    # Determine the conductivity for each finite volume cell\n    # Cell centers are at x_i = (i + 0.5) * delta_x\n    cell_indices = np.arange(n_cells)\n    cell_centers = (cell_indices + 0.5) * delta_x\n    \n    # Position within the unit cell\n    x_local = np.fmod(cell_centers, p)\n    \n    # Assign conductivity based on position\n    # k_values[i] = k1 if x_local[i]  t1, else k2\n    k_values = np.where(x_local  t1, k1, k2)\n    \n    # Calculate total thermal resistance using the FVM discretization\n    # r_i = delta_x / (k_i * A)\n    # R_num = sum(r_i)\n    total_resistance_num = np.sum(delta_x / (k_values * A))\n    \n    # Numerical heat flow rate (Q_num) and heat flux (q_num)\n    if total_resistance_num == 0:\n        # Avoid division by zero if resistance is zero (e.g., infinite conductivity)\n        # This case is unlikely with the given problem constraints.\n        Q_num = np.inf if delta_T > 0 else -np.inf if delta_T  0 else 0\n    else:\n        Q_num = delta_T / total_resistance_num\n        \n    q_num = Q_num / A\n\n    # --- Task 3: Relative Error Calculation ---\n    if q_eff == 0:\n        # If q_eff is zero (only if delta_T is 0), error is 0 if q_num is also 0.\n        error = 0.0 if q_num == 0.0 else np.inf\n    else:\n        error = np.abs(q_num - q_eff) / np.abs(q_eff)\n        \n    return error\n\n# Execute the simulation\nsolve()\n```"
        }
    ]
}