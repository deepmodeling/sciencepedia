{
    "hands_on_practices": [
        {
            "introduction": "We begin our exploration with the high-energy, short-timescale limit, known as the impulse approximation. This exercise demonstrates how, for a dilute gas, the dynamic structure factor $S(q,\\omega)$ provides a direct window into the particles' thermal motion, with its shape reflecting the Maxwell-Boltzmann velocity distribution . By deriving and computing $S(q,\\omega)$ in this regime, you will establish a fundamental link between microscopic dynamics and the scattering spectrum.",
            "id": "3794892",
            "problem": "Consider a dilute, monoatomic classical gas in equilibrium at temperature $T$ (in $\\mathrm{K}$), composed of particles of mass $m$ (in $\\mathrm{kg}$). Let $\\mathbf{q}$ be a scattering wavevector of magnitude $q$ (in $\\mathrm{m}^{-1}$), and let $\\omega$ be an angular frequency (in $\\mathrm{rad}\\,\\mathrm{s}^{-1}$). The dynamic structure factor $S(q,\\omega)$ is defined as the time-Fourier transform of the intermediate scattering function, which itself is based on the density–density correlation in the system. In the high-$q$ limit, the impulse approximation is applicable: the scattering event is sufficiently brief that particle motion is effectively ballistic over the scattering time, and interactions during the event can be neglected. Use the following foundational bases:\n\n- The intermediate scattering function $F(q,t)$ is defined from the density field as an ensemble average of phase factors over classical trajectories, and the dynamic structure factor $S(q,\\omega)$ is the time-Fourier transform of $F(q,t)$ with angular frequency $\\omega$.\n- For a dilute gas in equilibrium, particle velocities are distributed according to the Maxwell–Boltzmann distribution, which is isotropic and depends on the mass $m$ and temperature $T$ through the Boltzmann constant $k_{\\mathrm{B}}$.\n\nStarting from these bases, and working within the classical high-$q$ impulse approximation regime, derive an expression for $S(q,\\omega)$ in terms of $q$, $\\omega$, $m$, $T$, and $k_{\\mathrm{B}}$. Your derivation must proceed from first principles without assuming any closed-form expression for $S(q,\\omega)$.\n\nOnce you have derived the expression, implement a program that, for each test case below, evaluates $S(q,\\omega)$ numerically. Use the Boltzmann constant $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}\\,\\mathrm{J}\\,\\mathrm{K}^{-1}$. The program must treat all quantities in the International System of Units, with $\\omega$ in $\\mathrm{rad}\\,\\mathrm{s}^{-1}$, $q$ in $\\mathrm{m}^{-1}$, $m$ in $\\mathrm{kg}$, $T$ in $\\mathrm{K}$, and must output $S(q,\\omega)$ in $\\mathrm{s}$. You must produce numerical results for the following test suite:\n\n- Case $1$ (happy path): $m = 6.63 \\times 10^{-26}\\,\\mathrm{kg}$, $T = 3.00 \\times 10^{2}\\,\\mathrm{K}$, $q = 8.00 \\times 10^{10}\\,\\mathrm{m}^{-1}$, $\\omega = 0.00\\,\\mathrm{rad}\\,\\mathrm{s}^{-1}$.\n- Case $2$ (frequency tail): $m = 6.63 \\times 10^{-26}\\,\\mathrm{kg}$, $T = 3.00 \\times 10^{2}\\,\\mathrm{K}$, $q = 8.00 \\times 10^{10}\\,\\mathrm{m}^{-1}$, $\\omega = 1.00 \\times 10^{12}\\,\\mathrm{rad}\\,\\mathrm{s}^{-1}$.\n- Case $3$ (low-$q$ boundary check): $m = 6.63 \\times 10^{-26}\\,\\mathrm{kg}$, $T = 3.00 \\times 10^{2}\\,\\mathrm{K}$, $q = 1.00 \\times 10^{8}\\,\\mathrm{m}^{-1}$, $\\omega = 1.00 \\times 10^{9}\\,\\mathrm{rad}\\,\\mathrm{s}^{-1}$.\n- Case $4$ (heavy and cold gas): $m = 1.00 \\times 10^{-25}\\,\\mathrm{kg}$, $T = 5.00 \\times 10^{1}\\,\\mathrm{K}$, $q = 5.00 \\times 10^{10}\\,\\mathrm{m}^{-1}$, $\\omega = 2.00 \\times 10^{12}\\,\\mathrm{rad}\\,\\mathrm{s}^{-1}$.\n- Case $5$ (very high-$q$ scaling): $m = 6.63 \\times 10^{-26}\\,\\mathrm{kg}$, $T = 3.00 \\times 10^{2}\\,\\mathrm{K}$, $q = 2.00 \\times 10^{11}\\,\\mathrm{m}^{-1}$, $\\omega = 0.00\\,\\mathrm{rad}\\,\\mathrm{s}^{-1}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[result1,result2,result3]$). Each $result$ must be a floating-point number representing $S(q,\\omega)$ in $\\mathrm{s}$ for the corresponding test case, computed using your derived expression.",
            "solution": "### Derivation of the Dynamic Structure Factor $S(q, \\omega)$\n\nThe dynamic structure factor $S(q, \\omega)$ is defined as the time-Fourier transform of the intermediate scattering function, $F(q, t)$. We begin by deriving the form of $F(q,t)$ under the specified conditions.\n\n$1$. The intermediate scattering function $F(\\mathbf{q}, t)$ is defined for a system of $N$ particles as the autocorrelation function of the microscopic density fluctuations:\n$$\nF(\\mathbf{q}, t) = \\frac{1}{N} \\left\\langle \\sum_{j=1}^{N} \\sum_{k=1}^{N} e^{-i \\mathbf{q} \\cdot \\mathbf{r}_j(0)} e^{i \\mathbf{q} \\cdot \\mathbf{r}_k(t)} \\right\\rangle\n$$\nwhere $\\mathbf{r}_j(t)$ is the position of the $j$-th particle at time $t$, and $\\langle \\dots \\rangle$ denotes an ensemble average.\n\n$2$. For a dilute gas, the positions and velocities of different particles are uncorrelated. Consequently, the cross-terms ($j \\neq k$) in the double summation average to zero. The function is dominated by the \"self\" part ($j = k$), which describes the motion of individual particles. Since all particles are identical, we can consider a single representative particle:\n$$\nF(q, t) \\approx F_s(q, t) = \\left\\langle e^{i \\mathbf{q} \\cdot (\\mathbf{r}(t) - \\mathbf{r}(0))} \\right\\rangle\n$$\nThe function depends only on the magnitude $q=|\\mathbf{q}|$ due to the isotropy of the gas.\n\n$3$. We now apply the impulse approximation, which is valid in the high-$q$ limit. This limit corresponds to probing the system over very short time and length scales. On such scales, the particle's motion is effectively ballistic and unaffected by interatomic potentials. The trajectory is given by:\n$$\n\\mathbf{r}(t) = \\mathbf{r}(0) + \\mathbf{v}t\n$$\nwhere $\\mathbf{v}$ is the particle's initial velocity, which is constant over the brief scattering duration. Substituting this into the expression for $F_s(q,t)$:\n$$\nF_s(q, t) = \\left\\langle e^{i \\mathbf{q} \\cdot (\\mathbf{v}t)} \\right\\rangle = \\left\\langle e^{i t (\\mathbf{q} \\cdot \\mathbf{v})} \\right\\rangle\n$$\n\n$4$. The ensemble average becomes an average over the velocity distribution of the particles. For a classical gas in thermal equilibrium at temperature $T$, this distribution is the Maxwell-Boltzmann distribution, $P(\\mathbf{v})$:\n$$\nP(\\mathbf{v}) = \\left(\\frac{m}{2\\pi k_{\\mathrm{B}} T}\\right)^{3/2} \\exp\\left(-\\frac{m |\\mathbf{v}|^2}{2 k_{\\mathrm{B}} T}\\right)\n$$\nThe intermediate scattering function is then:\n$$\nF_s(q, t) = \\int d^3v \\, P(\\mathbf{v}) \\, e^{i t (\\mathbf{q} \\cdot \\mathbf{v})}\n$$\n\n$5$. To evaluate this integral, we align our coordinate system such that the wavevector $\\mathbf{q}$ is parallel to the $z$-axis, so $\\mathbf{q} = (0, 0, q)$. Then, $\\mathbf{q} \\cdot \\mathbf{v} = q v_z$. The integral separates into components:\n$$\nF_s(q, t) = \\left(\\frac{m}{2\\pi k_{\\mathrm{B}} T}\\right)^{3/2} \\int dv_x e^{-\\frac{m v_x^2}{2 k_{\\mathrm{B}} T}} \\int dv_y e^{-\\frac{m v_y^2}{2 k_{\\mathrm{B}} T}} \\int dv_z e^{-\\frac{m v_z^2}{2 k_{\\mathrm{B}} T}} e^{i t q v_z}\n$$\nThe integrals over $v_x$ and $v_y$ are standard Gaussian integrals that, with the prefactors, normalize the distribution for those components, each yielding $\\sqrt{2\\pi k_{\\mathrm{B}} T/m}$. We are left with the integral over $v_z$:\n$$\nF_s(q, t) = \\left(\\frac{m}{2\\pi k_{\\mathrm{B}} T}\\right)^{1/2} \\int_{-\\infty}^{\\infty} dv_z \\, \\exp\\left(-\\frac{m v_z^2}{2 k_{\\mathrm{B}} T}\\right) e^{i (tq) v_z}\n$$\nThis is the Fourier transform of a Gaussian function of $v_z$. The result is a Gaussian function of the transform variable, which is $tq$. Using the standard integral result $\\int_{-\\infty}^{\\infty} e^{-ax^2+bx} dx = \\sqrt{\\pi/a} e^{b^2/4a}$, with $x=v_z$, $a = \\frac{m}{2k_{\\mathrm{B}}T}$, and $b = itq$:\n$$\nF_s(q, t) = \\left(\\frac{m}{2\\pi k_{\\mathrm{B}} T}\\right)^{1/2} \\sqrt{\\frac{2\\pi k_{\\mathrm{B}} T}{m}} \\exp\\left(\\frac{(itq)^2}{4(m/2k_{\\mathrm{B}}T)}\\right) = \\exp\\left(-\\frac{q^2 t^2 k_{\\mathrm{B}} T}{2m}\\right)\n$$\n\n$6$. Finally, we obtain the dynamic structure factor $S(q, \\omega)$ by taking the time-Fourier transform of $F_s(q, t)$, using the convention established in the main text for consistency across the article:\n$$\nS(q, \\omega) = \\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} dt \\, F_s(q,t) e^{i \\omega t} = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} dt \\, \\exp\\left(-\\frac{q^2 k_{\\mathrm{B}} T}{2m} t^2\\right) e^{i \\omega t}\n$$\nThis is again a Fourier transform of a Gaussian. Let $a = \\frac{q^2 k_{\\mathrm{B}} T}{2m}$. We evaluate $\\frac{1}{2\\pi}\\int_{-\\infty}^{\\infty} e^{-at^2} e^{i \\omega t} dt$. The integral is a standard result, $\\sqrt{\\pi/a}e^{-\\omega^2/4a}$.\n$$\nS(q, \\omega) = \\frac{1}{2\\pi} \\sqrt{\\frac{\\pi}{a}} \\exp\\left(\\frac{-\\omega^2}{4a}\\right) = \\frac{1}{2\\sqrt{\\pi a}} \\exp\\left(\\frac{-\\omega^2}{4a}\\right)\n$$\nSubstituting the expression for $a$:\n$$\nS(q, \\omega) = \\frac{1}{2\\sqrt{\\pi \\frac{q^2 k_{\\mathrm{B}} T}{2m}}} \\exp\\left(-\\frac{\\omega^2}{4 \\left(\\frac{q^2 k_{\\mathrm{B}} T}{2m}\\right)}\\right)\n$$\nSimplifying this expression yields the final result:\n$$\nS(q, \\omega) = \\frac{1}{q}\\sqrt{\\frac{m}{2\\pi k_{\\mathrm{B}} T}} \\exp\\left(-\\frac{m \\omega^2}{2 q^2 k_{\\mathrm{B}} T}\\right)\n$$\nThis expression gives the dynamic structure factor as a Gaussian function of $\\omega$ centered at $\\omega=0$, with a width determined by the Doppler broadening due to thermal motion. This is the expression to be implemented numerically.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the dynamic structure factor S(q, ω) for a series of test cases\n    based on the derived formula for a dilute gas in the impulse approximation.\n    \"\"\"\n\n    # Define the Boltzmann constant in SI units (J/K)\n    k_B = 1.380649e-23\n\n    # Define the test cases from the problem statement.\n    # Each tuple contains (m, T, q, omega) in SI units.\n    # m: kg, T: K, q: m^-1, omega: rad/s\n    test_cases = [\n        # Case 1 (happy path)\n        (6.63e-26, 3.00e2, 8.00e10, 0.00),\n        # Case 2 (frequency tail)\n        (6.63e-26, 3.00e2, 8.00e10, 1.00e12),\n        # Case 3 (low-q boundary check)\n        (6.63e-26, 3.00e2, 1.00e8, 1.00e9),\n        # Case 4 (heavy and cold gas)\n        (1.00e-25, 5.00e1, 5.00e10, 2.00e12),\n        # Case 5 (very high-q scaling)\n        (6.63e-26, 3.00e2, 2.00e11, 0.00),\n    ]\n\n    def calculate_S_q_omega(m, T, q, omega):\n        \"\"\"\n        Computes S(q, ω) using the derived formula:\n        S(q, ω) = (1/q) * sqrt(m / (2*pi*k_B*T)) * exp(-m*ω^2 / (2*k_B*T*q^2))\n        \n        Args:\n            m (float): Particle mass in kg.\n            T (float): Temperature in K.\n            q (float): Wavevector magnitude in m^-1.\n            omega (float): Angular frequency in rad/s.\n        \n        Returns:\n            float: The value of S(q, ω) in seconds.\n        \"\"\"\n        # Ensure q is non-zero to avoid division by zero.\n        if q == 0.0:\n            return np.inf\n\n        # Common term in denominator and exponent\n        thermal_term = k_B * T\n        \n        # Calculate the prefactor\n        prefactor_arg = m / (2 * np.pi * thermal_term)\n        prefactor = (1 / q) * np.sqrt(prefactor_arg)\n\n        # Calculate the argument of the exponential function\n        exponent_arg = -(m * omega**2) / (2 * thermal_term * q**2)\n        \n        # Calculate the exponential term\n        exp_term = np.exp(exponent_arg)\n\n        # The final result is the product of the prefactor and the exponential term\n        s_q_omega = prefactor * exp_term\n        \n        return s_q_omega\n\n    results = []\n    for case in test_cases:\n        m, T, q, omega = case\n        result = calculate_S_q_omega(m, T, q, omega)\n        results.append(f\"{result:.6e}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Moving from ballistic to constrained motion, we now consider the diffusive regime typical of dense liquids at long times. This practice focuses on the mathematical heart of the matter: the Fourier transform relationship between the intermediate scattering function $F_s(\\mathbf{q}, t)$ and the dynamic structure factor $S_s(\\mathbf{q}, \\omega)$ . You will solidify your understanding of Fourier transform conventions and derive the classic Lorentzian lineshape that characterizes diffusive processes.",
            "id": "3794909",
            "problem": "Consider a single-component classical fluid simulated via Molecular Dynamics (MD) at equilibrium. Let the coarse-grained number density field be denoted by $\\rho(\\mathbf{x}, t)$, and define its spatial Fourier component $\\rho(\\mathbf{q}, t)$ for a fixed wavevector $\\mathbf{q}$. The normalized intermediate scattering function (self part) is defined as $F_{s}(\\mathbf{q}, t) = \\langle \\rho(\\mathbf{q}, t)\\rho(-\\mathbf{q}, 0)\\rangle / \\langle \\rho(\\mathbf{q}, 0)\\rho(-\\mathbf{q}, 0)\\rangle$, so that $F_{s}(\\mathbf{q}, 0) = 1$. In the diffusive hydrodynamic regime (small $|\\mathbf{q}|$ and long times), assume the self intermediate scattering function takes the form\n$$\nF_{s}(\\mathbf{q}, t) = \\exp\\!\\big(-D|\\mathbf{q}|^{2}|t|\\big),\n$$\nwhere $D$ is the self-diffusion coefficient. The dynamic structure factor $S_{s}(\\mathbf{q}, \\omega)$ is defined as the temporal Fourier transform of $F_{s}(\\mathbf{q}, t)$ with an unknown normalization constant, namely\n$$\nS_{s}(\\mathbf{q}, \\omega) = A \\int_{-\\infty}^{\\infty} \\exp\\!\\big(i \\omega t\\big) F_{s}(\\mathbf{q}, t) \\, dt,\n$$\nwhere $A$ is a real constant to be fixed by the requirement that the inverse transform recovers $F_{s}(\\mathbf{q}, t)$:\n$$\nF_{s}(\\mathbf{q}, t) = \\int_{-\\infty}^{\\infty} \\exp\\!\\big(-i \\omega t\\big) S_{s}(\\mathbf{q}, \\omega) \\, d\\omega.\n$$\nStarting from these definitions and fundamental properties of the Dirac delta distribution, determine the correct value of $A$ and derive a closed-form expression for $S_{s}(\\mathbf{q}, \\omega)$.\n\nFor reporting, introduce the dimensionless frequency $\\Omega = \\omega / \\big(D|\\mathbf{q}|^{2}\\big)$ and the scaled, dimensionless dynamic structure factor\n$$\n\\widehat{S}_{s}(\\mathbf{q}, \\Omega) = \\big(D|\\mathbf{q}|^{2}\\big) \\, S_{s}(\\mathbf{q}, \\omega).\n$$\nExpress your final answer as a single closed-form analytic expression for $\\widehat{S}_{s}(\\mathbf{q}, \\Omega)$. No numerical evaluation or rounding is required. The final expression is dimensionless, so do not include any physical units in your answer.",
            "solution": "The problem is validated as being scientifically grounded, well-posed, objective, and complete. All definitions and relationships are standard in the field of statistical mechanics and condensed matter physics. We may proceed with the solution.\n\nThe primary task is to determine the dynamic structure factor $S_{s}(\\mathbf{q}, \\omega)$ which is related to the intermediate scattering function $F_{s}(\\mathbf{q}, t)$ via a Fourier transform pair. The definitions provided are:\n$$\nS_{s}(\\mathbf{q}, \\omega) = A \\int_{-\\infty}^{\\infty} \\exp(i \\omega t) F_{s}(\\mathbf{q}, t) \\, dt\n$$\n$$\nF_{s}(\\mathbf{q}, t) = \\int_{-\\infty}^{\\infty} \\exp(-i \\omega t) S_{s}(\\mathbf{q}, \\omega) \\, d\\omega\n$$\nwhere $A$ is an unknown normalization constant.\n\nFirst, we determine the value of the constant $A$ by substituting the first equation into the second. This constitutes performing a Fourier transform followed by its inverse, which should recover the original function, scaled by any factors introduced by the transform definitions.\n$$\nF_{s}(\\mathbf{q}, t) = \\int_{-\\infty}^{\\infty} \\exp(-i \\omega t) \\left( A \\int_{-\\infty}^{\\infty} \\exp(i \\omega t') F_{s}(\\mathbf{q}, t') \\, dt' \\right) d\\omega\n$$\nAssuming the functions are well-behaved, we can interchange the order of integration (Fubini's theorem):\n$$\nF_{s}(\\mathbf{q}, t) = A \\int_{-\\infty}^{\\infty} F_{s}(\\mathbf{q}, t') \\left( \\int_{-\\infty}^{\\infty} \\exp(i \\omega (t' - t)) \\, d\\omega \\right) dt'\n$$\nThe inner integral is a representation of the Dirac delta function, $\\delta(x)$. Specifically, the integral representation is $\\int_{-\\infty}^{\\infty} \\exp(ikx) \\, dk = 2\\pi \\delta(x)$. In our case, the integration variable is $\\omega$ and the argument is $t' - t$. Therefore:\n$$\n\\int_{-\\infty}^{\\infty} \\exp(i \\omega (t' - t)) \\, d\\omega = 2\\pi \\delta(t' - t)\n$$\nSubstituting this back into the expression for $F_{s}(\\mathbf{q}, t)$:\n$$\nF_{s}(\\mathbf{q}, t) = A \\int_{-\\infty}^{\\infty} F_{s}(\\mathbf{q}, t') (2\\pi \\delta(t' - t)) \\, dt'\n$$\nUsing the sifting property of the Dirac delta function, $\\int_{-\\infty}^{\\infty} f(x) \\delta(x-a) \\, dx = f(a)$, we evaluate the integral:\n$$\nF_{s}(\\mathbf{q}, t) = A (2\\pi) F_{s}(\\mathbf{q}, t)\n$$\nFor this identity to hold for any non-trivial $F_{s}(\\mathbf{q}, t)$, we must have:\n$$\n1 = 2\\pi A \\implies A = \\frac{1}{2\\pi}\n$$\nNow that the normalization constant is known, we can compute $S_{s}(\\mathbf{q}, \\omega)$. The definition becomes:\n$$\nS_{s}(\\mathbf{q}, \\omega) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\exp(i \\omega t) F_{s}(\\mathbf{q}, t) \\, dt\n$$\nWe are given the functional form of the self intermediate scattering function in the diffusive limit:\n$$\nF_{s}(\\mathbf{q}, t) = \\exp(-D|\\mathbf{q}|^{2}|t|)\n$$\nLet's introduce the parameter $\\alpha = D|\\mathbf{q}|^2$ to simplify the notation. The integral is:\n$$\nS_{s}(\\mathbf{q}, \\omega) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\exp(i \\omega t) \\exp(-\\alpha |t|) \\, dt\n$$\nDue to the absolute value in $|t|$, we must split the integral into two parts: from $-\\infty$ to $0$ (where $|t| = -t$) and from $0$ to $\\infty$ (where $|t| = t$):\n$$\nS_{s}(\\mathbf{q}, \\omega) = \\frac{1}{2\\pi} \\left[ \\int_{-\\infty}^{0} \\exp(i \\omega t) \\exp(\\alpha t) \\, dt + \\int_{0}^{\\infty} \\exp(i \\omega t) \\exp(-\\alpha t) \\, dt \\right]\n$$\nCombine the exponents in each term:\n$$\nS_{s}(\\mathbf{q}, \\omega) = \\frac{1}{2\\pi} \\left[ \\int_{-\\infty}^{0} \\exp((\\alpha + i\\omega)t) \\, dt + \\int_{0}^{\\infty} \\exp(-(\\alpha - i\\omega)t) \\, dt \\right]\n$$\nWe can now evaluate these standard exponential integrals. For the integral to converge, we require $\\alpha > 0$, which is physically guaranteed since the diffusion coefficient $D > 0$ and we consider a non-zero wavevector $|\\mathbf{q}| > 0$.\n$$\n\\int_{-\\infty}^{0} \\exp((\\alpha + i\\omega)t) \\, dt = \\left[ \\frac{\\exp((\\alpha + i\\omega)t)}{\\alpha + i\\omega} \\right]_{-\\infty}^{0} = \\frac{1}{\\alpha + i\\omega} (1 - 0) = \\frac{1}{\\alpha + i\\omega}\n$$\n$$\n\\int_{0}^{\\infty} \\exp(-(\\alpha - i\\omega)t) \\, dt = \\left[ \\frac{\\exp(-(\\alpha - i\\omega)t)}{-(\\alpha - i\\omega)} \\right]_{0}^{\\infty} = \\frac{-1}{\\alpha - i\\omega} (0 - 1) = \\frac{1}{\\alpha - i\\omega}\n$$\nSumming these two results:\n$$\nS_{s}(\\mathbf{q}, \\omega) = \\frac{1}{2\\pi} \\left[ \\frac{1}{\\alpha + i\\omega} + \\frac{1}{\\alpha - i\\omega} \\right]\n$$\nTo combine the terms, we find a common denominator:\n$$\nS_{s}(\\mathbf{q}, \\omega) = \\frac{1}{2\\pi} \\left[ \\frac{(\\alpha - i\\omega) + (\\alpha + i\\omega)}{(\\alpha + i\\omega)(\\alpha - i\\omega)} \\right] = \\frac{1}{2\\pi} \\left[ \\frac{2\\alpha}{\\alpha^2 - (i\\omega)^2} \\right] = \\frac{1}{2\\pi} \\frac{2\\alpha}{\\alpha^2 + \\omega^2}\n$$\n$$\nS_{s}(\\mathbf{q}, \\omega) = \\frac{1}{\\pi} \\frac{\\alpha}{\\alpha^2 + \\omega^2}\n$$\nThis is a Lorentzian function of $\\omega$. Substituting back $\\alpha = D|\\mathbf{q}|^2$:\n$$\nS_{s}(\\mathbf{q}, \\omega) = \\frac{1}{\\pi} \\frac{D|\\mathbf{q}|^2}{(D|\\mathbf{q}|^2)^2 + \\omega^2}\n$$\nThe final step is to express this result in terms of the dimensionless quantities $\\Omega = \\omega / (D|\\mathbf{q}|^2)$ and $\\widehat{S}_{s}(\\mathbf{q}, \\Omega) = (D|\\mathbf{q}|^2) S_{s}(\\mathbf{q}, \\omega)$.\nStarting from the definition of the scaled structure factor:\n$$\n\\widehat{S}_{s}(\\mathbf{q}, \\Omega) = (D|\\mathbf{q}|^2) S_{s}(\\mathbf{q}, \\omega) = (D|\\mathbf{q}|^2) \\left[ \\frac{1}{\\pi} \\frac{D|\\mathbf{q}|^2}{(D|\\mathbf{q}|^2)^2 + \\omega^2} \\right]\n$$\n$$\n\\widehat{S}_{s}(\\mathbf{q}, \\Omega) = \\frac{1}{\\pi} \\frac{(D|\\mathbf{q}|^2)^2}{(D|\\mathbf{q}|^2)^2 + \\omega^2}\n$$\nTo make the right-hand side dimensionless, we can divide the numerator and denominator by $(D|\\mathbf{q}|^2)^2$:\n$$\n\\widehat{S}_{s}(\\mathbf{q}, \\Omega) = \\frac{1}{\\pi} \\frac{1}{1 + \\frac{\\omega^2}{(D|\\mathbf{q}|^2)^2}} = \\frac{1}{\\pi} \\frac{1}{1 + \\left(\\frac{\\omega}{D|\\mathbf{q}|^2}\\right)^2}\n$$\nUsing the definition of the dimensionless frequency $\\Omega = \\omega / (D|\\mathbf{q}|^2)$, we obtain the final expression:\n$$\n\\widehat{S}_{s}(\\mathbf{q}, \\Omega) = \\frac{1}{\\pi} \\frac{1}{1 + \\Omega^2}\n$$\nThis expression is dimensionless and depends only on the dimensionless frequency $\\Omega$, as required.",
            "answer": "$$\n\\boxed{\\frac{1}{\\pi (1 + \\Omega^2)}}\n$$"
        },
        {
            "introduction": "Our final practice explores the rich structure of $S(q,\\omega)$ in the hydrodynamic limit, where collective phenomena dominate. By starting from the fundamental conservation laws of fluid dynamics, you will derive the celebrated Rayleigh-Brillouin triplet—a direct spectral signature of thermal diffusion and propagating sound waves . This exercise connects the microscopic fluctuations to macroscopic transport coefficients like viscosity and thermal diffusivity, showcasing the power of scattering theory.",
            "id": "3794908",
            "problem": "Consider a simple compressible Newtonian fluid in the long-wavelength, low-frequency hydrodynamic regime where density and momentum fluctuations are governed by conservation laws and linear irreversible thermodynamics. The goal is to derive and compute the dynamic structure factor (DSF), defined as $S(\\mathbf{k},\\omega)$, for density fluctuations at wavevector $\\mathbf{k}$ and angular frequency $\\omega$, and to identify the emergence of the Rayleigh-Brillouin triplet: one central peak associated with thermal diffusion and two symmetrically displaced side peaks associated with sound propagation.\n\nStart from the following fundamental and widely accepted bases:\n- Mass conservation (continuity equation): $\\partial_t \\rho + \\nabla \\cdot (\\rho \\mathbf{v}) = 0$, linearized about a uniform equilibrium.\n- Momentum conservation (linearized Navier-Stokes for a Newtonian fluid): $\\rho_0 \\partial_t \\mathbf{v} = -\\nabla p + \\eta \\nabla^2 \\mathbf{v} + \\left(\\zeta + \\frac{\\eta}{3}\\right)\\nabla (\\nabla \\cdot \\mathbf{v})$, where $\\rho_0$ is the equilibrium mass density, $p$ is the pressure, $\\eta$ is the shear viscosity, and $\\zeta$ is the bulk viscosity.\n- Energy conservation and Fourier’s law of heat conduction, linearized to obtain thermal diffusion dynamics for temperature fluctuations with thermal diffusivity $D_T$.\n- Thermodynamic relations linking fluctuations of pressure, density, and temperature, including the ratio of specific heats $\\gamma = c_p/c_v$ and the adiabatic speed of sound $c_s = \\sqrt{\\left(\\frac{\\partial p}{\\partial \\rho}\\right)_s}$.\n\nDefine the Dynamic Structure Factor (DSF) as the frequency-domain density fluctuation spectrum,\n$$\nS(\\mathbf{k},\\omega) = \\frac{1}{2\\pi N}\\int_{-\\infty}^{\\infty} dt\\, e^{i\\omega t} \\left\\langle \\delta \\rho_{\\mathbf{k}}(t)\\, \\delta \\rho_{-\\mathbf{k}}(0) \\right\\rangle,\n$$\nwhere $N$ is the number of particles and $\\delta \\rho_{\\mathbf{k}}(t)$ is the spatial Fourier component of the density fluctuation at wavevector $\\mathbf{k}$. In the hydrodynamic limit $|\\mathbf{k}|\\to 0$ with $|\\omega|$ small compared to microscopic frequencies, show that $S(\\mathbf{k},\\omega)$ is composed of three line shapes corresponding to one diffusive thermal mode and two propagating sound modes. Using the above fundamental bases, derive their centers, widths, and relative weights in terms of $|\\mathbf{k}|$, $\\gamma$, $c_s$, $D_T$, and the longitudinal kinematic viscosity $\\nu_L = \\dfrac{4\\eta/3 + \\zeta}{\\rho_0}$.\n\nThen, design an algorithm to compute the following seven quantitative outputs for a given parameter set $(|\\mathbf{k}|, \\gamma, c_s, D_T, \\nu_L)$, in the precise units indicated:\n1. The full width at half maximum (FWHM) of the central Rayleigh peak in $\\text{rad}\\,\\text{s}^{-1}$.\n2. The full width at half maximum (FWHM) of each Brillouin side peak in $\\text{rad}\\,\\text{s}^{-1}$.\n3. The Brillouin peak center angular frequency $|\\omega_B|$ in $\\text{rad}\\,\\text{s}^{-1}$.\n4. The dimensionless integrated weight (area fraction) of the central Rayleigh peak.\n5. The dimensionless integrated weight (area fraction) of one Brillouin side peak.\n6. The on-peak value of the normalized DSF at $\\omega=0$ (the center of the Rayleigh peak), expressed as a dimensionless float, with the DSF normalized so that its integral over all $\\omega$ equals $1$.\n7. The on-peak value of the normalized DSF at $\\omega=+\\omega_B$ (the center of the right Brillouin peak), expressed as a dimensionless float, with the same normalization as above.\n\nYour program must implement this algorithm and produce results for the following test suite of parameter sets. Use the given values exactly, and treat $|\\mathbf{k}|$ in $\\text{m}^{-1}$, $\\gamma$ dimensionless, $c_s$ in $\\text{m}\\,\\text{s}^{-1}$, $D_T$ in $\\text{m}^2\\,\\text{s}^{-1}$, and $\\nu_L$ in $\\text{m}^2\\,\\text{s}^{-1}$:\n- Test Case 1 (typical liquid-like, moderate $|\\mathbf{k}|$): $|\\mathbf{k}| = 1.0\\times 10^{7}$, $\\gamma = 1.01$, $c_s = 1500.0$, $D_T = 1.4\\times 10^{-7}$, $\\nu_L = 2.0\\times 10^{-6}$.\n- Test Case 2 (boundary small wavenumber): $|\\mathbf{k}| = 1.0\\times 10^{3}$, $\\gamma = 1.01$, $c_s = 1500.0$, $D_T = 1.4\\times 10^{-7}$, $\\nu_L = 2.0\\times 10^{-6}$.\n- Test Case 3 (monatomic gas-like parameters): $|\\mathbf{k}| = 1.0\\times 10^{5}$, $\\gamma = 5.0/3.0$, $c_s = 343.0$, $D_T = 2.2\\times 10^{-5}$, $\\nu_L = 2.5\\times 10^{-5}$.\n- Test Case 4 (isothermal limit of $\\gamma \\to 1$ to suppress the Rayleigh weight): $|\\mathbf{k}| = 5.0\\times 10^{6}$, $\\gamma = 1.0$, $c_s = 2000.0$, $D_T = 1.0\\times 10^{-7}$, $\\nu_L = 1.0\\times 10^{-6}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case’s seven outputs are grouped into a sublist. The final output format must be:\n$[ [r_1, r_2, r_3, r_4, r_5, r_6, r_7], [\\dots], [\\dots], [\\dots] ]$\nwhere for each test case $r_1$ through $r_7$ are floats in the order specified above.",
            "solution": "The objective is to compute the dynamic structure factor, $S(\\mathbf{k},\\omega)$, which describes the spectrum of spontaneous density fluctuations in a fluid. In the hydrodynamic limit (small wavevector $|\\mathbf{k}|=k$ and small angular frequency $\\omega$), the dynamics are governed by the linearized equations of mass, momentum, and energy conservation. The analysis of these coupled linear equations reveals the collective modes of the fluid, which manifest as distinct peaks in $S(k,\\omega)$.\n\nThe derivation starts from the Fourier-transformed linearized hydrodynamic equations for the fluctuations of density ($\\delta\\rho_{\\mathbf{k}}$), longitudinal velocity ($v_{\\mathbf{k}}$), and temperature ($\\delta T_{\\mathbf{k}}$). This system of algebraic equations has non-trivial solutions only when the determinant of its coefficient matrix is zero. The roots of this characteristic equation determine the dispersion relations $\\omega(k)$ of the hydrodynamic modes. For a simple compressible fluid, three such modes are found:\n\n$1$. A pair of counter-propagating, damped sound modes. These arise from the interplay of pressure and inertia. They correspond to the Brillouin peaks in the spectrum. Their dispersion relation is approximately:\n$$ \\omega = \\pm c_s k - i\\Gamma_S(k) $$\nHere, $c_s$ is the adiabatic speed of sound, which gives the peak positions at $\\omega_B = \\pm c_s k$. The imaginary part describes the damping of the sound waves, with a half-width at half-maximum (HWHM), $\\Gamma_S(k)$, given by:\n$$ \\Gamma_S(k) = \\frac{1}{2} \\left[ \\nu_L + (\\gamma - 1) D_T \\right] k^2 $$\nwhere $\\nu_L$ is the longitudinal kinematic viscosity, $D_T$ is the thermal diffusivity, and $\\gamma = c_p/c_v$ is the ratio of specific heats. The damping arises from viscous losses (via $\\nu_L$) and thermal relaxation (via $D_T$).\n\n$2$. One non-propagating, diffusive thermal mode. This mode describes the diffusion of entropy (or temperature) fluctuations at constant pressure. It corresponds to the central Rayleigh peak. Its dispersion relation is:\n$$ \\omega = -i\\Gamma_R(k) $$\nThe peak is centered at $\\omega = 0$ and has an HWHM, $\\Gamma_R(k)$, given by:\n$$ \\Gamma_R(k) = D_T k^2 $$\nThe width of this peak is solely determined by thermal diffusion.\n\nThe dynamic structure factor $S(k,\\omega)$ is the sum of the spectral signatures of these modes. Assuming the peaks are well-separated ($c_s k \\gg \\Gamma_S(k), \\Gamma_R(k)$), $S(k,\\omega)$ can be modeled as a sum of three Lorentzian functions. Normalizing the total integrated intensity to unity ($\\int_{-\\infty}^{\\infty} S_{norm}(k, \\omega) d\\omega = 1$), the DSF is given by:\n$$ S_{norm}(k, \\omega) = \\left(1 - \\frac{1}{\\gamma}\\right) \\frac{1}{\\pi}\\frac{\\Gamma_R(k)}{\\omega^2 + \\Gamma_R(k)^2} + \\frac{1}{2\\gamma} \\left( \\frac{1}{\\pi}\\frac{\\Gamma_S(k)}{(\\omega - c_s k)^2 + \\Gamma_S(k)^2} + \\frac{1}{\\pi}\\frac{\\Gamma_S(k)}{(\\omega + c_s k)^2 + \\Gamma_S(k)^2} \\right) $$\nThe prefactors $(1 - 1/\\gamma)$ and $1/(2\\gamma)$ are the integrated weights of the central peak and one side peak, respectively. Their sum is $(1 - 1/\\gamma) + 2(1/(2\\gamma)) = 1$. The ratio of the integrated central intensity to the total Brillouin intensity is $(\\gamma-1)$, a result known as the Landau-Placzek ratio.\n\nFrom this theoretical basis, we can derive the seven required quantities for a given parameter set ($k, \\gamma, c_s, D_T, \\nu_L$). Let $k = |\\mathbf{k}|$.\n\n$1$. The FWHM of the Rayleigh peak, $W_R$, is twice its HWHM, $\\Gamma_R(k)$:\n$$ W_R = 2 \\Gamma_R(k) = 2 D_T k^2 $$\n\n$2$. The FWHM of each Brillouin peak, $W_S$, is twice its HWHM, $\\Gamma_S(k)$:\n$$ W_S = 2 \\Gamma_S(k) = \\left( \\nu_L + (\\gamma - 1) D_T \\right) k^2 $$\n\n$3$. The Brillouin peak center angular frequency, $|\\omega_B|$, is determined by the sound dispersion:\n$$ |\\omega_B| = c_s k $$\n\n$4$. The dimensionless integrated weight of the central Rayleigh peak, $I_R$, is the prefactor of the Rayleigh Lorentzian term:\n$$ I_R = 1 - \\frac{1}{\\gamma} $$\n\n$5$. The dimensionless integrated weight of one Brillouin side peak, $I_S$, is the prefactor of a single Brillouin Lorentzian term:\n$$ I_S = \\frac{1}{2\\gamma} $$\n\n$6$. The on-peak value of the normalized DSF at $\\omega=0$ is found by substituting $\\omega=0$ into the full expression for $S_{norm}(k, \\omega)$. This includes the peak of the Rayleigh component and the contribution from the tails of the Brillouin components:\n$$ S_{norm}(k, 0) = \\frac{1}{\\pi} \\left[ \\left(1 - \\frac{1}{\\gamma}\\right) \\frac{1}{\\Gamma_R(k)} + \\frac{1}{\\gamma} \\frac{\\Gamma_S(k)}{(c_s k)^2 + \\Gamma_S(k)^2} \\right] $$\n\n$7$. The on-peak value of the normalized DSF at $\\omega = \\omega_B = c_s k$ is found by substituting $\\omega = c_s k$ into the full expression for $S_{norm}(k, \\omega)$. This includes the peak of one Brillouin component and the tails of the Rayleigh and the other Brillouin component:\n$$ S_{norm}(k, c_s k) = \\frac{1}{\\pi} \\left[ \\left(1 - \\frac{1}{\\gamma}\\right) \\frac{\\Gamma_R(k)}{(c_s k)^2 + \\Gamma_R(k)^2} + \\frac{1}{2\\gamma} \\left( \\frac{1}{\\Gamma_S(k)} + \\frac{\\Gamma_S(k)}{(2 c_s k)^2 + \\Gamma_S(k)^2} \\right) \\right] $$\n\nThe algorithm implemented in the final answer uses these exact formulae.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the properties of the dynamic structure factor for given test cases.\n    \"\"\"\n\n    # Test cases parameters:\n    # (|k| [m^-1], gamma, c_s [m/s], D_T [m^2/s], nu_L [m^2/s])\n    test_cases = [\n        (1.0e7, 1.01, 1500.0, 1.4e-7, 2.0e-6),\n        (1.0e3, 1.01, 1500.0, 1.4e-7, 2.0e-6),\n        (1.0e5, 5.0/3.0, 343.0, 2.2e-5, 2.5e-5),\n        (5.0e6, 1.0, 2000.0, 1.0e-7, 1.0e-6),\n    ]\n\n    all_results = []\n    for case in test_cases:\n        result = calculate_dsf_properties(case)\n        all_results.append(result)\n\n    # Format the final output string as per problem specification.\n    # e.g., [[r1,r2,...],[...],...]\n    sublist_strings = []\n    for res in all_results:\n        sublist_strings.append(f\"[{','.join(map(str, res))}]\")\n    final_output = f\"[{','.join(sublist_strings)}]\"\n\n    print(final_output)\n\ndef calculate_dsf_properties(params):\n    \"\"\"\n    Calculates the seven specified quantitative outputs for the DSF.\n\n    Args:\n        params (tuple): A tuple containing the physical parameters:\n                        (k_val, gamma, c_s, D_T, nu_L)\n\n    Returns:\n        list: A list of seven float values corresponding to the required outputs.\n    \"\"\"\n    k_val, gamma, c_s, D_T, nu_L = params\n    k_sq = k_val**2\n\n    # Calculate Half-Width at Half-Maximum (HWHM) for Rayleigh and Brillouin peaks\n    hwhm_R = D_T * k_sq\n    hwhm_S = 0.5 * (nu_L + (gamma - 1.0) * D_T) * k_sq\n\n    # 1. FWHM of the central Rayleigh peak\n    fwhm_R = 2.0 * hwhm_R\n\n    # 2. FWHM of each Brillouin side peak\n    fwhm_S = 2.0 * hwhm_S\n\n    # 3. Brillouin peak center angular frequency\n    omega_B = c_s * k_val\n\n    # Handle the gamma = 1 case to avoid division by zero in weight calculation\n    # and to ensure the formula remains physically meaningful (isothermal limit).\n    if gamma == 1.0:\n        weight_R = 0.0\n    else:\n        # 4. Integrated weight of the central Rayleigh peak\n        weight_R = 1.0 - 1.0 / gamma\n    \n    # 5. Integrated weight of one Brillouin side peak\n    weight_S = 1.0 / (2.0 * gamma)\n\n    # 6. On-peak value of the normalized DSF at omega = 0\n    # S_norm(k, 0) = (1/pi) * [ weight_R/hwhm_R + (2*weight_S) * hwhm_S / (omega_B^2 + hwhm_S^2) ]\n    # This must handle the case where gamma = 1, in which case the first term is 0.\n    # It must also handle the case where hwhm_R = 0, which can happen if D_T=0.\n    \n    term1_peak_R = 0.0\n    if weight_R > 0 and hwhm_R > 0:\n        term1_peak_R = weight_R / hwhm_R\n        \n    term2_peak_R = (2.0 * weight_S) * hwhm_S / (omega_B**2 + hwhm_S**2)\n    peak_val_R = (1.0 / np.pi) * (term1_peak_R + term2_peak_R)\n\n    # 7. On-peak value of the normalized DSF at omega = +omega_B\n    # S_norm(k, omega_B) = (1/pi) * [ weight_R*hwhm_R/(omega_B^2+hwhm_R^2) + \n    #                                weight_S*(1/hwhm_S + hwhm_S/((2*omega_B)^2+hwhm_S^2)) ]\n    \n    term1_peak_S = 0.0\n    if weight_R > 0:\n        term1_peak_S = weight_R * hwhm_R / (omega_B**2 + hwhm_R**2)\n\n    term2_peak_S_main = 0.0\n    if hwhm_S > 0:\n        term2_peak_S_main = 1.0 / hwhm_S\n        \n    term2_peak_S_tail = hwhm_S / ((2.0 * omega_B)**2 + hwhm_S**2)\n    \n    peak_val_S = (1.0 / np.pi) * (term1_peak_S + weight_S * (term2_peak_S_main + term2_peak_S_tail))\n\n    return [fwhm_R, fwhm_S, omega_B, weight_R, weight_S, peak_val_R, peak_val_S]\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}