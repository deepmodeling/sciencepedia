{
    "hands_on_practices": [
        {
            "introduction": "尺度定律通常源自于无量纲参数之间的关系。第一个练习  将介绍一个识别这些参数的基础工具：白金汉Pi定理。你将应用这种强大的量纲分析方法，来确定控制弹性波在多孔固体中传播速度的一组无量纲参数，从而在进行完整的力学推导之前，洞察问题的核心物理本质。",
            "id": "3839296",
            "problem": "一相速度为 $c$ 的弹性压缩波在一种均匀、各向同性、干燥的多孔固体中传播，在所关注的尺度上，其有效行为由质量密度 $\\rho$、有效弹性模量 $E$、孔隙度 $\\phi$ 和一个量化代表性孔隙尺寸的特征微观结构长度 $L$ 所表征。假设在所关注的频率范围内，没有额外的物理效应（如粘性阻力或流固耦合）起作用，因此唯一相关的基本量纲是质量、长度和时间。利用量纲齐次性原理和 Buckingham π 定理，推导控制波速对这些变量依赖关系的最小独立无量纲数组。\n\n您的推导必须：\n- 识别变量集及其以质量、长度和时间表示的量纲。\n- 确定独立无量纲数组的数量。\n- 在基本量纲空间中选择一组具有满秩的合适的重复变量。\n- 构建独立的无量纲数组并验证其独立性。\n\n以单行矩阵的形式报告最终的最小独立无量纲数组，其中第一项选择为基于所列变量的无量纲波速。无需进行数值计算，所报告的矩阵中也不应包含任何单位。",
            "solution": "该问题经验证具有科学依据、适定且客观。它是量纲分析在连续介质力学和材料科学领域中的一个标准应用。未发现任何缺陷。\n\n目标是推导控制压缩波相速度 $c$ 与多孔固体性质（质量密度 $\\rho$、弹性模量 $E$、孔隙度 $\\phi$ 和特征长度 $L$）之间关系的最小独立无量纲数组。我们将使用 Buckingham π 定理。\n\n首先，我们识别相关变量及其以质量（$M$）、长度（$L$）和时间（$T$）表示的基本量纲。总共有 $n=5$ 个变量。\n1.  相速度，$c$：$[c] = L T^{-1}$\n2.  质量密度，$\\rho$：$[\\rho] = M L^{-3}$\n3.  有效弹性模量，$E$：$[E] = M L^{-1} T^{-2}$（因为模量的单位是应力，即力/面积）\n4.  孔隙度，$\\phi$：$[\\phi] = 1$（无量纲，因为它是体积之比）\n5.  特征长度，$L$：$[L] = L$\n\n接下来，我们确定基本量纲的数量，即 $k=3$（质量 $M$、长度 $L$ 和时间 $T$）。根据 Buckingham π 定理，独立的无量纲数组（记为 Π 组）的数量由 $p = n - r$ 给出，其中 $r$ 是量纲矩阵的秩。变量 $\\{c, \\rho, E, L, \\phi\\}$ 的量纲矩阵为：\n$$\n\\begin{array}{c|ccccc}\n  & c & \\rho & E & L & \\phi \\\\\n\\hline\nM & 0 & 1 & 1 & 0 & 0 \\\\\nL & 1 & -3 & -1 & 1 & 0 \\\\\nT & -1 & 0 & -2 & 0 & 0\n\\end{array}\n$$\n该矩阵的秩 $r$ 是线性无关的行或列的数量。我们可以通过选择一个子矩阵并检查其行列式来求秩。对于变量集 $\\{\\rho, E, L\\}$ 的子矩阵是：\n$$\n\\begin{pmatrix} 1 & 1 & 0 \\\\ -3 & -1 & 1 \\\\ 0 & -2 & 0 \\end{pmatrix}\n$$\n行列式为 $1(0 - (-2)) - 1(0 - 0) + 0 = 2 \\neq 0$。因此，量纲矩阵的秩为 $r=3$。独立的无量纲数组的数量为 $p = n-r = 5-3=2$。\n\n为了构建这两个数组，我们选择 $r=3$ 个重复变量。所选的重复变量集必须是量纲无关的（即，它们的量纲子矩阵的秩必须为 $3$）。根据上述计算，集合 $\\{\\rho, E, L\\}$ 是一个有效的选择。这些变量代表了系统的基本物理方面：质量、刚度和几何。剩余的变量是 $c$ 和 $\\phi$。我们将为这两个变量各构成一个 Π 组。\n\n第一个无量纲数组 $\\Pi_1$ 是由相速度 $c$ 构成的。问题指定该数组应为一个无量纲波速。\n$$\n\\Pi_1 = c^1 \\rho^a E^b L^d\n$$\n为了使 $\\Pi_1$ 无量纲，等式右侧的量纲必须相互抵消。我们写出量纲方程：\n$$\n[ \\Pi_1 ] = M^0 L^0 T^0 = (L T^{-1})^1 (M L^{-3})^a (M L^{-1} T^{-2})^b (L)^d\n$$\n我们令每个基本量纲的指数相等：\n- $M$ 的指数：$0 = a + b$\n- $L$ 的指数：$0 = 1 - 3a - b + d$\n- $T$ 的指数：$0 = -1 - 2b$\n\n解此线性方程组：\n由 $T$ 方程， $2b = -1 \\implies b = -\\frac{1}{2}$。\n由 $M$ 方程，$a = -b \\implies a = \\frac{1}{2}$。\n由 $L$ 方程，$d = 3a + b - 1 = 3(\\frac{1}{2}) + (-\\frac{1}{2}) - 1 = \\frac{3}{2} - \\frac{1}{2} - 1 = 1 - 1 = 0$。\n将这些指数代回 $\\Pi_1$ 的表达式中：\n$$\n\\Pi_1 = c^1 \\rho^{1/2} E^{-1/2} L^0 = c \\sqrt{\\frac{\\rho}{E}}\n$$\n该数组表示波速 $c$ 与介质中弹性波的特征速度 $\\sqrt{E/\\rho}$ 之比。这满足了对无量纲波速的要求。\n\n第二个无量纲数组 $\\Pi_2$ 是由剩余变量 $\\phi$（孔隙度）构成的。\n$$\n\\Pi_2 = \\phi^1 \\rho^a E^b L^d\n$$\n由于 $\\phi$ 本身就是无量纲的（$[\\phi]=1$），要使 $\\Pi_2$ 无量纲，重复变量的乘积也必须是无量纲的。由于 $\\{\\rho, E, L\\}$ 是量纲无关的，这只有在它们的指数全为零时才可能实现。\n$$\n[\\Pi_2] = 1 = (1)^1 (M L^{-3})^a (M L^{-1} T^{-2})^b (L)^d\n$$\n这要求 $a=0$, $b=0$ 且 $d=0$。因此，第二个无量纲数组就是孔隙度本身：\n$$\n\\Pi_2 = \\phi\n$$\n\n控制该系统的最小独立无量纲数组集为 $\\{\\Pi_1, \\Pi_2\\}$。函数关系可以表示为 $f(\\Pi_1, \\Pi_2) = 0$ 或 $\\Pi_1 = g(\\Pi_2)$，这意味着 $c \\sqrt{\\rho/E} = g(\\phi)$。这是一个具有物理意义的结果，表明归一化波速是材料孔隙度的函数。然而，问题中还包含一个特征长度 $L$，我们选择的重复变量也是 $L$。这意味着 $L$ 被用作构建 $\\Pi_1$ 的基础。如果特征微观结构长度用不同的符号表示，例如 $d$，那么另一个无量纲数组 $d/L$ 就会出现。由于问题中将微观结构长度和基本重复变量长度都称为 $L$，我们的推导严格遵循了这一符号选择。如果我们将变量列表中的 $L$ 解释为微观结构长度，并使用新的基本变量，例如 $\\{c, \\rho, E\\}$，那么 $p=5-3=2$ 个 $\\Pi$ 组将被找到，其中一个将是 $L$ 的函数。但我们选择的 $\\{ \\rho, E, L\\}$ 是有效的。\n实际上，由于孔隙度 $\\phi$ 已经无量纲，且问题中给定的微观结构长度为 $L$，而我们又选择了 $L$ 作为重复变量，导致 $\\Pi_2 = \\phi$ 而没有出现长度比。如果我们选择 $\\{\\rho, E, c\\}$ 作为重复变量，则会得到 $\\Pi_1 = L \\sqrt{E/\\rho} / c$ 和 $\\Pi_2 = \\phi$。这在物理上是等价的。我们的选择更直接。\n\n推导出的两个数组 $\\Pi_1 = c \\sqrt{\\rho/E}$ 和 $\\Pi_2 = \\phi$ 是独立的。最终的最小独立无量纲数组集为 $\\{ c \\sqrt{\\frac{\\rho}{E}}, \\phi \\}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} c \\sqrt{\\frac{\\rho}{E}} & \\phi \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "虽然量纲分析能够识别出相关的无量纲群，但要推导其间的具体函数关系则需要建立物理模型。本练习  将引导你解决一个微观力学中的经典问题：推导复合材料的有效模量。通过在稀疏极限下分析单个夹杂物的行为，你将了解宏观性能如何随体积分数等微观结构特征而发生尺度变化，这是多尺度材料建模的基石。",
            "id": "3839249",
            "problem": "考虑一个二维周期性复合材料的代表性体积单元（RVE），它由一个单位正方形周期性晶胞构成，其中嵌入了一个半径为 $a$ 的居中圆形夹杂物。设基体的反平面剪切模量（等效于标量电导率）为常数 $\\mu_{m}>0$，夹杂物的反平面剪切模量为常数 $\\mu_{i}>0$。用 $\\phi=\\pi a^{2}$ 表示夹杂物的面积分数，并假设在稀疏极限 $\\phi \\to 0$ 下，每个晶胞含有一个夹杂物。\n\n在微观尺度上，平面外位移 $u(x)$（等效于标量势）满足准静态线性动量平衡（等效于稳态传导），\n$$\n\\nabla \\cdot \\left(\\mu\\left(\\frac{x}{\\varepsilon}\\right) \\nabla u(x)\\right)=0 \\quad \\text{in } \\mathbb{R}^{2},\n$$\n其中 $\\mu(y)$ 是 $Y$-周期的，周期晶胞为 $Y=[0,1]^{2}$，在以晶胞中心为圆心、半径为 $a$ 的圆盘内部等于 $\\mu_{i}$，在周围的基体中等于 $\\mu_{m}$，且 $\\varepsilon>0$ 是小尺度参数。均匀化（有效）模量 $\\mu^{\\ast}$ 由标准的周期性均匀化晶胞问题定义：对于给定的宏观单位梯度 $e \\in \\mathbb{R}^{2}$，求解均值为零的 $Y$-周期校正子 $w^{e}(y)$，使其满足\n$$\n\\nabla_{y} \\cdot \\left( \\mu(y) \\left( e + \\nabla_{y} w^{e}(y) \\right) \\right) = 0 \\quad \\text{in } Y,\n$$\n并定义\n$$\n\\mu^{\\ast} e = \\int_{Y} \\mu(y) \\left( e + \\nabla_{y} w^{e}(y) \\right) \\, \\mathrm{d}y,\n$$\n在此设置下，由于对称性，这简化为一个与 $e$ 无关的标量 $\\mu^{\\ast}$。\n\n从上述定义和控制方程出发，仅使用调和场的基本性质和界面条件（位移和牵引力的连续性），通过将周期性阵列替换为嵌入在无限大基体中、受到均匀远场单位梯度 $e = e_{1}$ 作用的单个圆形夹杂物来分析稀疏极限 $\\phi \\to 0$。求解相应的传输问题，并确定 $\\mu^{\\ast}$ 对 $\\phi$ 的主阶依赖关系。\n\n具体来说，证明存在一个常数 $C(\\mu_{m},\\mu_{i})$，使得\n$$\n\\mu^{\\ast}(\\phi) = \\mu_{m} + C(\\mu_{m},\\mu_{i}) \\, \\phi + o(\\phi) \\quad \\text{as } \\phi \\to 0,\n$$\n并计算系数 $C(\\mu_{m},\\mu_{i})$ 的闭式解析表达式。\n\n您的最终答案必须是 $C(\\mu_{m},\\mu_{i})$ 的单一表达式。不需要进行数值计算。最终答案无需单位。",
            "solution": "该问题是有效的，因为它具有科学依据、适定性且自洽。将提供完整解答。\n\n### 解答推导\n\n我们的目标是确定有效模量 $\\mu^{\\ast}$ 关于夹杂物面积分数 $\\phi$ 的一阶展开系数 $C(\\mu_m, \\mu_i)$。根据问题描述，我们采用稀疏极限近似，即考虑一个位于无限大基体中的单个圆形夹杂物，该系统受到远场均匀梯度 $e = e_1$ 的作用，其中 $e_1 = (1, 0)$。在这种反平面剪切问题中，位移场 $u(y)$ 是一个标量，且满足拉普拉斯方程的变体。\n\n**1. 场方程与边界条件**\n\n在基体（$|y| > a$）和夹杂物（$|y|  a$）中，位移场 $u(y)$ 均满足 $\\nabla \\cdot (\\mu \\nabla u) = 0$。由于 $\\mu$ 是分段常数，这简化为 $\\nabla^2 u = 0$。我们使用极坐标 $(r, \\theta)$。\n远场条件要求当 $r \\to \\infty$ 时，$u(y) \\to e_1 \\cdot y = y_1 = r \\cos\\theta$。\n\n我们为基体和夹杂物中的场设定如下形式的解：\n- **夹杂物内部 ($r \\le a$)**: $u_i(r, \\theta) = A r \\cos\\theta$。此解在原点处是良态的。\n- **基体外部 ($r > a$)**: $u_m(r, \\theta) = r \\cos\\theta + B \\frac{\\cos\\theta}{r}$。此解满足远场条件，并包含一个由夹杂物引起的扰动项。\n\n在界面 $r=a$ 处，位移和牵引力必须是连续的：\n- 位移连续性: $u_i(a, \\theta) = u_m(a, \\theta)$\n- 牵引力连续性: $\\mu_i \\frac{\\partial u_i}{\\partial r}\\Big|_{r=a} = \\mu_m \\frac{\\partial u_m}{\\partial r}\\Big|_{r=a}$\n\n**2. 求解未知系数**\n\n将解的形式代入连续性条件：\n- 从位移连续性: $A a \\cos\\theta = a \\cos\\theta + \\frac{B}{a} \\cos\\theta \\implies A = 1 + \\frac{B}{a^2}$\n- 从牵引力连续性: $\\mu_i (A \\cos\\theta) = \\mu_m ( \\cos\\theta - \\frac{B}{a^2} \\cos\\theta ) \\implies \\mu_i A = \\mu_m (1 - \\frac{B}{a^2})$\n\n这是一个关于 $A$ 和 $B$ 的线性方程组。将第一个方程的 $B/a^2 = A-1$ 代入第二个方程：\n$\\mu_i A = \\mu_m (1 - (A-1)) = \\mu_m (2-A)$\n$\\mu_i A + \\mu_m A = 2\\mu_m$\n$A = \\frac{2\\mu_m}{\\mu_i + \\mu_m}$\n\n**3. 计算有效模量**\n\n根据问题中给出的均匀化定义，对于单位体积（$|Y|=1$）：\n$\\mu^{\\ast} e = \\int_Y \\mu(y) \\nabla u(y) \\, \\mathrm{d}y$\n其中 $u(y)$ 是局域解。在稀疏极限下，我们可以将积分分解为基体和单个夹杂物的贡献。一个更直接的方法是利用平均场理论的结果，对于稀疏极限，有效模量可以展开为：\n$\\mu^{\\ast} = \\mu_m + (\\mu_i - \\mu_m) \\phi \\frac{\\langle \\nabla_y u \\rangle_i \\cdot e}{|e|^2} + O(\\phi^2)$\n这里 $\\langle \\nabla_y u \\rangle_i$ 是夹杂物内部的平均梯度。由于夹杂物内部的场是均匀的 $u_i = A r \\cos\\theta = A y_1$，其梯度为 $\\nabla_y u_i = A e_1$。因此，$\\langle \\nabla_y u \\rangle_i = A e_1 = A e$。\n\n将此代入展开式：\n$\\mu^{\\ast} = \\mu_m + \\phi (\\mu_i - \\mu_m) \\frac{(A e) \\cdot e}{|e|^2} = \\mu_m + \\phi (\\mu_i - \\mu_m) A$\n\n最后，代入我们求得的 $A$ 的表达式：\n$\\mu^{\\ast} = \\mu_m + \\phi (\\mu_i - \\mu_m) \\left( \\frac{2\\mu_m}{\\mu_i + \\mu_m} \\right)$\n$\\mu^{\\ast} = \\mu_m + \\phi \\frac{2\\mu_m(\\mu_i - \\mu_m)}{\\mu_i + \\mu_m}$\n\n将此结果与目标形式 $\\mu^{\\ast}(\\phi) = \\mu_{m} + C(\\mu_{m},\\mu_{i}) \\, \\phi + o(\\phi)$ 进行比较，我们得到系数 $C$：\n$C(\\mu_{m},\\mu_{i}) = \\frac{2\\mu_{m}(\\mu_{i}-\\mu_{m})}{\\mu_{i}+\\mu_{m}}$\n\n这与Maxwell在1873年为电导率问题首次推导出的结果形式相同。",
            "answer": "$$ \\boxed{\\frac{2\\mu_{m}(\\mu_{i}-\\mu_{m})}{\\mu_{i}+\\mu_{m}}} $$"
        },
        {
            "introduction": "理论上的尺度定律通常描述的是理想化的无限大系统，而计算模拟则不可避免地在有限尺寸的体系中进行。最后的这个练习  旨在弥合这一差距，让你掌握计算材料科学中的一项核心技能：有限尺寸标度分析。你将需要从第一性原理出发，设计并实现一种统计方法，来分析不同尺寸体系下带有噪声的模拟数据，并将结果外推至宏观体积极限，从而揭示真实的材料属性。",
            "id": "3839284",
            "problem": "考虑在周期性边界条件下的平衡态分子动力学 (MD) 模拟中的有限尺寸效应。由于流体动力学模式的量子化和长程相关性，在线性尺寸为 $L$ 或粒子数为 $N$ 的有限模拟区域中测量的许多热物理性质，与其体相（无限尺寸）极限值存在差异。在Lennard-Jones约化单位（无量纲）下，假设主导的有限尺寸偏差由一个小的单一参数决定，该参数与线性尺寸的倒数 $1/L$ 或粒子数的倒数 $1/N$ 成标度关系。此外，对于某些输运系数，次级修正项涉及由高阶流体动力学贡献产生的 $1/L^3$。根据中心极限定理，在不同尺寸下观测到的MD估计值 $y_i$ 由于有限采样而具有独立的、近似高斯的标准不确定度 $\\sigma_i$。\n\n你的任务是从基本原理出发，通过使用适当的标度变量来消除主导的有限尺寸偏差，从而推导出一个用于体相性质 $y_{\\infty}$ 的统计一致估计量。你必须假设以下几点：\n- 对于每个数据集，在主导修正项起作用的邻域内，测量的性质与所选的标度变量之间存在一个潜在的线性关系。\n- 报告的标准误差 $\\sigma_i$ 是已知的，并且对应于 $y_i$ 上的独立高斯噪声。\n- 目标是估计当标度变量趋于零时，该线性关系的y轴截距 $y_{\\infty}$。\n\n你必须设计一个算法，对于下述的每一种情况，该算法能够在标度变量中构建合适的线性设计矩阵，在高斯噪声假设下对 $y_{\\infty}$ 进行统计最优估计，并根据估计量的抽样分布给出 $y_{\\infty}$ 的不确定度。你的最终程序必须计算并为每个测试案例返回一个包含估计值 $y_{\\infty}$ 及其标准不确定度的数值对。所有量都应被视为无量纲（Lennard-Jones约化单位），因此不需要进行物理单位转换。\n\n以下测试套件定义了五个案例。每个案例都指定了要使用的标度形式，并提供了原始MD估计值及其不确定度：\n- 案例 A (使用 $1/L$ 标度)：尺寸 $L \\in \\{\\,10,12,16,20,24,32\\,\\}$，测量值 $y \\in \\{\\,0.2062,\\,0.1921,\\,0.1739,\\,0.1658,\\,0.1580,\\,0.1509\\,\\}$，标准误差 $\\sigma \\in \\{\\,0.0040,\\,0.0035,\\,0.0030,\\,0.0025,\\,0.0022,\\,0.0020\\,\\}$。\n- 案例 B (使用 $1/N$ 标度)：粒子数 $N \\in \\{\\,500,\\,1000,\\,2000,\\,4000,\\,8000\\,\\}$，测量值 $y \\in \\{\\,7.38,\\,6.23,\\,5.58,\\,5.31,\\,5.16\\,\\}$，标准误差 $\\sigma \\in \\{\\,0.060,\\,0.050,\\,0.045,\\,0.040,\\,0.040\\,\\}$。\n- 案例 C (使用 $1/L$ 和 $1/L^3$ 组合标度)：尺寸 $L \\in \\{\\,8,\\,10,\\,12,\\,14,\\,16,\\,20,\\,24\\,\\}$，测量值 $y \\in \\{\\,2.2840,\\,2.3020,\\,2.2960,\\,2.2930,\\,2.2860,\\,2.2710,\\,2.2620\\,\\}$，标准误差 $\\sigma \\in \\{\\,0.0060,\\,0.0060,\\,0.0055,\\,0.0050,\\,0.0050,\\,0.0045,\\,0.0045\\,\\}$。\n- 案例 D (边缘案例，数据量最少；使用 $1/L$ 标度)：尺寸 $L \\in \\{\\,40,\\,60\\,\\}$，测量值 $y \\in \\{\\,1.5200,\\,1.5140\\,\\}$，标准误差 $\\sigma \\in \\{\\,0.0100,\\,0.0100\\,\\}$。\n- 案例 E (使用 $1/N$ 标度且呈递增趋势)：粒子数 $N \\in \\{\\,200,\\,400,\\,800,\\,1600\\,\\}$，测量值 $y \\in \\{\\,0.2600,\\,0.5100,\\,0.6200,\\,0.6890\\,\\}$，标准误差 $\\sigma \\in \\{\\,0.0200,\\,0.0150,\\,0.0120,\\,0.0100\\,\\}$。\n\n对于每种情况，在所选的标度变量中构建一个以 $y_{\\infty}$ 为截距的线性模型：\n- 对于 $1/L$ 标度，使用回归量 $[\\,1,\\,1/L\\,]$。\n- 对于 $1/N$ 标度，使用回归量 $[\\,1,\\,1/N\\,]$。\n- 对于 $L$ 的组合标度，使用回归量 $[\\,1,\\,1/L,\\,1/L^3\\,]$。\n\n假设每个 $y_i$ 都有独立的、标准差为 $\\sigma_i$ 的已知高斯误差，并从第一性原理出发推导 $y_{\\infty}$ 的最大似然估计量及其标准不确定度，不要引用任何预先推导出的简化公式。然后相应地实现该估计量。\n\n你的程序必须在没有任何用户输入的情况下执行，并按指定顺序处理所有五个案例。最终输出格式必须是单行，包含一个有五个条目的列表，每个案例一个条目。每个条目是一个双元素列表 $[\\,y_{\\infty},\\,u(y_{\\infty})\\,]$，其中两个数字都精确到小数点后六位。例如，一个有效的整体输出格式为 $[\\,[\\,0.123456,0.000789\\,],\\,[\\,\\dots\\,],\\,[\\,\\dots\\,],\\,[\\,\\dots\\,],\\,[\\,\\dots\\,]\\,]$。",
            "solution": "该问题要求从一系列有限尺寸的分子动力学模拟出发，推导并实现一个统计最优估计量，用于将物理性质外推至无限尺寸极限（$y_{\\infty}$）。该问题定义明确，并在统计力学和估计理论的原理上有坚实的科学基础。\n\n所提供的数据包含一组在不同系统尺寸下进行的测量 $\\{y_i\\}$，这些尺寸由线性维度 $L_i$ 或粒子数 $N_i$ 来表征。每次测量 $y_i$ 都有一个已知的、独立的高斯不确定度 $\\sigma_i$。有限尺寸效应由一个关于特定标度变量（从 $L_i$ 或 $N_i$ 导出）的线性模型来描述。该线性模型的一般形式为：\n$$ y_i = \\beta_0 + \\sum_{j=1}^{p-1} \\beta_j x_{ij} + \\epsilon_i $$\n在这里，$\\beta_0$ 代表所求的体相性质 $y_{\\infty}$，$\\{x_{ij}\\}$ 是第 $i$ 次测量的 $p-1$ 个标度变量的值，$\\{\\beta_j\\}_{j=1}^{p-1}$ 是相应的标度系数，而 $\\epsilon_i$ 是第 $i$ 次测量的随机误差。问题陈述中指出 $\\epsilon_i \\sim \\mathcal{N}(0, \\sigma_i^2)$，其中 $\\mathcal{N}$ 表示正态分布。\n\n对于 $n$ 个观测值，用矩阵表示法，该模型可表达为：\n$$ \\mathbf{y} = \\mathbf{X}\\boldsymbol{\\beta} + \\boldsymbol{\\epsilon} $$\n其中 $\\mathbf{y} = [y_1, \\dots, y_n]^T$ 是观测值的 $n \\times 1$ 维向量，$\\mathbf{X}$ 是 $n \\times p$ 维设计矩阵，其行向量为 $[1, x_{i1}, \\dots, x_{i,p-1}]$，$\\boldsymbol{\\beta} = [\\beta_0, \\beta_1, \\dots, \\beta_{p-1}]^T$ 是待估计参数的 $p \\times 1$ 维向量，$\\boldsymbol{\\epsilon} = [\\epsilon_1, \\dots, \\epsilon_n]^T$ 是独立随机误差的向量。误差的协方差矩阵 $\\text{Cov}(\\boldsymbol{\\epsilon})$ 是一个对角矩阵，其对角元素为 $\\text{Cov}(\\boldsymbol{\\epsilon})_{ii} = \\sigma_i^2$。\n\n为了从第一性原理推导出一个统计最优估计量，我们采用最大似然估计（MLE）方法。给定参数 $\\boldsymbol{\\beta}$ 时，单个观测值 $y_i$ 的概率密度函数（PDF）为：\n$$ f(y_i|\\boldsymbol{\\beta}, \\sigma_i) = \\frac{1}{\\sqrt{2\\pi\\sigma_i^2}} \\exp\\left( -\\frac{(y_i - (\\mathbf{X}\\boldsymbol{\\beta})_i)^2}{2\\sigma_i^2} \\right) $$\n由于观测值的独立性，整个数据集 $\\mathbf{y}$ 的联合似然函数是各独立PDF的乘积：\n$$ \\mathcal{L}(\\boldsymbol{\\beta}|\\mathbf{y}) = \\prod_{i=1}^n f(y_i|\\boldsymbol{\\beta}, \\sigma_i) = \\left( \\prod_{i=1}^n \\frac{1}{\\sqrt{2\\pi\\sigma_i^2}} \\right) \\exp\\left( -\\frac{1}{2} \\sum_{i=1}^n \\frac{(y_i - (\\mathbf{X}\\boldsymbol{\\beta})_i)^2}{\\sigma_i^2} \\right) $$\n最大化似然函数 $\\mathcal{L}(\\boldsymbol{\\beta})$ 等价于最大化其对数，即对数似然函数 $\\ln \\mathcal{L}(\\boldsymbol{\\beta})$：\n$$ \\ln \\mathcal{L}(\\boldsymbol{\\beta}) = \\text{const} - \\frac{1}{2} \\sum_{i=1}^n \\left( \\frac{y_i - (\\mathbf{X}\\boldsymbol{\\beta})_i}{\\sigma_i} \\right)^2 $$\n为了最大化 $\\ln \\mathcal{L}(\\boldsymbol{\\beta})$，我们必须最小化加权残差平方和 $\\chi^2$：\n$$ \\chi^2(\\boldsymbol{\\beta}) = \\sum_{i=1}^n w_i (y_i - (\\mathbf{X}\\boldsymbol{\\beta})_i)^2 $$\n其中权重为 $w_i = 1/\\sigma_i^2$。这就是加权最小二乘法（WLS）的原理。以矩阵形式，定义一个对角权重矩阵 $\\mathbf{W}$，其元素为 $W_{ii} = w_i$，则表达式变为：\n$$ \\chi^2(\\boldsymbol{\\beta}) = (\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\beta})^T \\mathbf{W} (\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\beta}) $$\n为了找到最小化 $\\chi^2$ 的参数向量 $\\hat{\\boldsymbol{\\beta}}$，我们对 $\\boldsymbol{\\beta}$ 求导并将梯度设为零：\n$$ \\frac{\\partial \\chi^2}{\\partial \\boldsymbol{\\beta}} = -2 \\mathbf{X}^T \\mathbf{W} \\mathbf{y} + 2 \\mathbf{X}^T \\mathbf{W} \\mathbf{X} \\boldsymbol{\\beta} = \\mathbf{0} $$\n这得到了WLS正规方程组：\n$$ (\\mathbf{X}^T \\mathbf{W} \\mathbf{X}) \\hat{\\boldsymbol{\\beta}} = \\mathbf{X}^T \\mathbf{W} \\mathbf{y} $$\n估计参数的解为：\n$$ \\hat{\\boldsymbol{\\beta}} = (\\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{W} \\mathbf{y} $$\n这个 $\\hat{\\boldsymbol{\\beta}}$ 就是最大似然估计量。其第一个分量 $\\hat{\\beta}_0$ 是我们对 $y_{\\infty}$ 的估计值。\n\n接下来，我们推导该估计量的不确定度。不确定度由参数的标准差给出，即参数协方差矩阵 $\\text{Cov}(\\hat{\\boldsymbol{\\beta}})$ 对角元素的平方根。\n$$ \\hat{\\boldsymbol{\\beta}} = (\\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{W} \\mathbf{y} = (\\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{W} (\\mathbf{X}\\boldsymbol{\\beta} + \\boldsymbol{\\epsilon}) = \\boldsymbol{\\beta} + (\\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{W} \\boldsymbol{\\epsilon} $$\n$\\hat{\\boldsymbol{\\beta}}$ 的协方差矩阵是 $\\text{Cov}(\\hat{\\boldsymbol{\\beta}}) = \\mathbb{E}[(\\hat{\\boldsymbol{\\beta}}-\\boldsymbol{\\beta})(\\hat{\\boldsymbol{\\beta}}-\\boldsymbol{\\beta})^T]$。代入 $\\hat{\\boldsymbol{\\beta}}-\\boldsymbol{\\beta}$ 的表达式：\n$$ \\text{Cov}(\\hat{\\boldsymbol{\\beta}}) = \\mathbb{E}[ ( (\\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{W} \\boldsymbol{\\epsilon} ) ( ( \\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{W} \\boldsymbol{\\epsilon} )^T ] $$\n$$ \\text{Cov}(\\hat{\\boldsymbol{\\beta}}) = (\\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{W} \\mathbb{E}[\\boldsymbol{\\epsilon}\\boldsymbol{\\epsilon}^T] \\mathbf{W}^T \\mathbf{X} ((\\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1})^T $$\n根据定义，误差的协方差矩阵 $\\mathbb{E}[\\boldsymbol{\\epsilon}\\boldsymbol{\\epsilon}^T]$ 是 $\\mathbf{W}^{-1}$。由于 $\\mathbf{W}$ 是对角矩阵，$\\mathbf{W}^T = \\mathbf{W}$，并且 $\\mathbf{X}^T \\mathbf{W} \\mathbf{X}$ 是对称的，因此它的逆矩阵也是对称的。\n$$ \\text{Cov}(\\hat{\\boldsymbol{\\beta}}) = (\\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{W} (\\mathbf{W}^{-1}) \\mathbf{W} \\mathbf{X} (\\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1} $$\n$$ \\text{Cov}(\\hat{\\boldsymbol{\\beta}}) = (\\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1} (\\mathbf{X}^T \\mathbf{W} \\mathbf{X}) (\\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1} $$\n$$ \\text{Cov}(\\hat{\\boldsymbol{\\beta}}) = (\\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1} $$\n这个基本结果给出了估计参数的协方差矩阵。体相性质的估计值为 $y_{\\infty} = \\hat{\\beta}_0$，其标准不确定度为 $u(y_{\\infty}) = \\sqrt{\\text{Cov}(\\hat{\\boldsymbol{\\beta}})_{00}}$。\n\n需要实现的算法如下：\n1. 对于每种情况，根据指定的标度变量构建观测值向量 $\\mathbf{y}$、标准误差向量 $\\boldsymbol{\\sigma}$ 和设计矩阵 $\\mathbf{X}$。\n2. 构建对角权重矩阵 $\\mathbf{W}$，其元素为 $W_{ii} = 1/\\sigma_i^2$。\n3. 计算矩阵 $\\mathbf{A} = \\mathbf{X}^T \\mathbf{W} \\mathbf{X}$ 和向量 $\\mathbf{b} = \\mathbf{X}^T \\mathbf{W} \\mathbf{y}$。\n4. 计算 $\\mathbf{A}$ 的逆矩阵，即协方差矩阵：$\\mathbf{C} = \\mathbf{A}^{-1} = (\\mathbf{X}^T \\mathbf{W} \\mathbf{X})^{-1}$。\n5. 计算参数向量的估计值：$\\hat{\\boldsymbol{\\beta}} = \\mathbf{C} \\mathbf{b}$。\n6. 体相性质的估计值是 $\\hat{\\boldsymbol{\\beta}}$ 的第一个元素，$y_{\\infty} = \\hat{\\beta}_0$。\n7. 该估计值的不确定度是 $\\mathbf{C}$ 的第一个对角元素的平方根，$u(y_{\\infty}) = \\sqrt{C_{00}}$。\n此过程将应用于所有五个测试案例。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the bulk property and its uncertainty for five different cases\n    of finite-size scaling in molecular dynamics simulations.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: 1/L scaling\n        {\n            \"scaling_vars\": [\"1/L\"],\n            \"L\": np.array([10, 12, 16, 20, 24, 32]),\n            \"N\": None,\n            \"y\": np.array([0.2062, 0.1921, 0.1739, 0.1658, 0.1580, 0.1509]),\n            \"sigma\": np.array([0.0040, 0.0035, 0.0030, 0.0025, 0.0022, 0.0020]),\n        },\n        # Case B: 1/N scaling\n        {\n            \"scaling_vars\": [\"1/N\"],\n            \"L\": None,\n            \"N\": np.array([500, 1000, 2000, 4000, 8000]),\n            \"y\": np.array([7.38, 6.23, 5.58, 5.31, 5.16]),\n            \"sigma\": np.array([0.060, 0.050, 0.045, 0.040, 0.040]),\n        },\n        # Case C: 1/L and 1/L^3 scaling\n        {\n            \"scaling_vars\": [\"1/L\", \"1/L^3\"],\n            \"L\": np.array([8, 10, 12, 14, 16, 20, 24]),\n            \"N\": None,\n            \"y\": np.array([2.2840, 2.3020, 2.2960, 2.2930, 2.2860, 2.2710, 2.2620]),\n            \"sigma\": np.array([0.0060, 0.0060, 0.0055, 0.0050, 0.0050, 0.0045, 0.0045]),\n        },\n        # Case D: edge case, 1/L scaling\n        {\n            \"scaling_vars\": [\"1/L\"],\n            \"L\": np.array([40, 60]),\n            \"N\": None,\n            \"y\": np.array([1.5200, 1.5140]),\n            \"sigma\": np.array([0.0100, 0.0100]),\n        },\n        # Case E: 1/N scaling with increasing trend\n        {\n            \"scaling_vars\": [\"1/N\"],\n            \"L\": None,\n            \"N\": np.array([200, 400, 800, 1600]),\n            \"y\": np.array([0.2600, 0.5100, 0.6200, 0.6890]),\n            \"sigma\": np.array([0.0200, 0.0150, 0.0120, 0.0100]),\n        },\n    ]\n\n    results_list = []\n    \n    for case in test_cases:\n        y_obs = case[\"y\"]\n        sigmas = case[\"sigma\"]\n        n_points = len(y_obs)\n\n        # Construct the Design Matrix X\n        num_params = 1 + len(case[\"scaling_vars\"])\n        X = np.zeros((n_points, num_params))\n        X[:, 0] = 1.0  # Intercept term\n\n        col_idx = 1\n        for var in case[\"scaling_vars\"]:\n            if var == \"1/L\":\n                X[:, col_idx] = 1.0 / case[\"L\"]\n            elif var == \"1/N\":\n                X[:, col_idx] = 1.0 / case[\"N\"]\n            elif var == \"1/L^3\":\n                X[:, col_idx] = 1.0 / (case[\"L\"] ** 3)\n            col_idx += 1\n\n        # Construct the Weight Matrix W\n        W = np.diag(1.0 / sigmas**2)\n\n        # Apply the Weighted Least Squares (WLS) formulas derived from MLE\n        # Covariance matrix of parameters is (X^T * W * X)^-1\n        XT_W_X = X.T @ W @ X\n        cov_beta = np.linalg.inv(XT_W_X)\n        \n        # Parameter estimates are (X^T * W * X)^-1 * X^T * W * y\n        XT_W_y = X.T @ W @ y_obs\n        beta_hat = cov_beta @ XT_W_y\n\n        # The estimated bulk property y_inf is the first parameter (intercept)\n        y_inf = beta_hat[0]\n        \n        # The uncertainty is the square root of the first diagonal element of the covariance matrix\n        u_y_inf = np.sqrt(cov_beta[0, 0])\n\n        results_list.append([y_inf, u_y_inf])\n\n    # Format the final output string as required\n    formatted_output = [f\"[{y:.6f},{u:.6f}]\" for y, u in results_list]\n    print(f\"[{','.join(formatted_output)}]\")\n\nsolve()\n```"
        }
    ]
}