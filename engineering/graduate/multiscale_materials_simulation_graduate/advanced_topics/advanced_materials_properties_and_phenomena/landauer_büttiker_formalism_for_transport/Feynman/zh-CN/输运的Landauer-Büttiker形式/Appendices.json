{
    "hands_on_practices": [
        {
            "introduction": "这个实践是介观物理学的基石。你将推导著名的兰道尔公式，它在线性响应范围内，将量子导体的微观透射概率 $T(E)$ 与其宏观可测的电导 $G$ 直接联系起来。掌握这一推导对于理解量子力学如何主导纳米尺度上的电子流动至关重要。",
            "id": "3819239",
            "problem": "考虑一个连接两个大电子库的相位相干一维导体，这两个电子库处于相同的绝对温度 $\\Theta$，但化学势略有不同，分别为 $\\mu_L=\\mu+eV/2$ 和 $\\mu_R=\\mu-eV/2$，其中 $e$ 是正基本电荷，且 $|eV| \\ll k_B \\Theta$。该导体的特征是其透射概率 $T(E)$ 依赖于能量，并且在 $E=\\mu$ 的邻域内，在 $k_B \\Theta$ 的尺度上是能量的光滑函数。假设磁场为零，自旋简并度为 $g_s=2$，并忽略导体中的非弹性散射。\n\n使用相干输运的 Landauer 图像，并在小偏压 $V$ 的线性阶上一致地进行推导，得出从左到右流动的净电流 $I$ 的一个闭合形式解析表达式，用 $e$、$h$、$V$ 和 $T(\\mu)$ 表示。你可以假设在 $E=\\mu$ 附近，$T(E)$ 的变化足够缓慢，以至于在任何由费米-狄拉克分布的导数加权的能量积分中，可以用其在 $E=\\mu$ 处的值来代替它。请将你的最终答案表示为一个解析表达式。最终表达式中不要包含单位。",
            "solution": "首先根据指定标准对问题进行验证。\n\n### 第1步：提取已知条件\n-   **系统**：一个连接两个大电子库的相位相干一维导体。\n-   **电子库温度**：两个电子库都处于相同的绝对温度 $\\Theta$。\n-   **电子库化学势**：$\\mu_L = \\mu+eV/2$ 和 $\\mu_R = \\mu-eV/2$。\n-   **电荷**：$e$ 是正基本电荷。\n-   **偏压条件**：小偏压电压 $V$，使得 $|eV| \\ll k_B \\Theta$。\n-   **透射概率**：一个依赖于能量的函数 $T(E)$，在 $E=\\mu$ 附近 $k_B \\Theta$ 的尺度上是平滑的。\n-   **磁场**：零。\n-   **自旋简并度**：$g_s=2$。\n-   **散射**：导体中的非弹性散射可以忽略不计。\n-   **任务**：推导从左到右的净电流 $I$ 的闭合形式解析表达式。\n-   **近似**：推导必须在 $V$ 的线性阶上一致。\n-   **简化**：在任何由费米-狄拉克分布导数加权的积分中，可以用 $T(E)$ 在 $E=\\mu$ 处的值来代替它。\n-   **最终表达式**：电流 $I$ 必须用 $e$、$h$、$V$ 和 $T(\\mu)$ 表示。\n\n### 第2步：使用提取的已知条件进行验证\n该问题具有科学依据，因为它描述了介观物理学中的基本理论——Landauer-Büttiker 形式论的典型设置。所有的假设，如相干输运、化学势的形式以及线性响应条件 $|eV| \\ll k_B \\Theta$，都是标准的且物理上合理的。该问题是适定的；它提供了所有必要的信息和明确的目标，从而导出一个唯一的、明确定义的解（线性响应电导）。所使用的语言是客观和精确的。该问题是一个标准的教科书练习题，不违反任何无效性标准。\n\n### 第3步：结论和行动\n问题有效。将推导完整解答。\n\n流经导体的净电流 $I$ 是从左边电子库流向右边的电流 $I_{L \\to R}$ 与从右边电子库流向左边的电流 $I_{R \\to L}$ 之差。\n\nLandauer 公式给出了来自每个电子库的电流贡献的表达式。来自左边电子库的电流由电荷通量对所有能量的积分给出。在给定能量 $E$ 下的电荷通量是以下各项的乘积：基本电荷 $e$、可用输运通道数（包括自旋，$g_s=2$）、每个通道单位能量的状态通量（$1/h$）、源电子库中一个状态被占据的概率（$f(E, \\mu_L)$）以及一个电子透射通过导体的概率（$T(E)$）。\n\n因此，从左到右的电流是：\n$$\nI_{L \\to R} = \\frac{g_s e}{h} \\int_{-\\infty}^{\\infty} T(E) f(E, \\mu_L) dE\n$$\n类似地，从右到左的电流是：\n$$\nI_{R \\to L} = \\frac{g_s e}{h} \\int_{-\\infty}^{\\infty} T(E) f(E, \\mu_R) dE\n$$\n这里，$f(E, \\mu')$ 是费米-狄拉克分布函数：\n$$\nf(E, \\mu') = \\frac{1}{1 + \\exp\\left(\\frac{E-\\mu'}{k_B \\Theta}\\right)}\n$$\n净电流 $I$ 是差值 $I = I_{L \\to R} - I_{R \\to L}$：\n$$\nI = \\frac{g_s e}{h} \\int_{-\\infty}^{\\infty} T(E) \\left[f(E, \\mu_L) - f(E, \\mu_R)\\right] dE\n$$\n我们已知 $\\mu_L = \\mu + eV/2$ 和 $\\mu_R = \\mu - eV/2$。问题指明所施加的偏压 $V$ 很小，对应于线性响应区，其中 $|eV| \\ll k_B \\Theta$。在此极限下，我们可以在平均化学势 $\\mu$ 附近对费米-狄拉克分布的差值进行泰勒展开。\n\n设 $\\Delta f = f(E, \\mu + eV/2) - f(E, \\mu - eV/2)$。对于一个小的微扰 $\\delta\\mu$，$f(E, \\mu+\\delta\\mu) \\approx f(E,\\mu) + \\frac{\\partial f}{\\partial \\mu} \\delta\\mu$。利用性质 $\\frac{\\partial f}{\\partial \\mu} = -\\frac{\\partial f}{\\partial E}$，我们有 $f(E, \\mu+\\delta\\mu) \\approx f(E,\\mu) - \\frac{\\partial f}{\\partial E} \\delta\\mu$。\n\n将此应用于我们的化学势：\n$$\nf(E, \\mu_L) \\approx f(E, \\mu) - \\frac{\\partial f(E, \\mu)}{\\partial E} \\left(\\frac{eV}{2}\\right)\n$$\n$$\nf(E, \\mu_R) \\approx f(E, \\mu) - \\frac{\\partial f(E, \\mu)}{\\partial E} \\left(-\\frac{eV}{2}\\right) = f(E, \\mu) + \\frac{\\partial f(E, \\mu)}{\\partial E} \\left(\\frac{eV}{2}\\right)\n$$\n在 $V$ 的线性阶上，差值为：\n$$\nf(E, \\mu_L) - f(E, \\mu_R) \\approx \\left[f(E, \\mu) - \\frac{\\partial f}{\\partial E}\\frac{eV}{2}\\right] - \\left[f(E, \\mu) + \\frac{\\partial f}{\\partial E}\\frac{eV}{2}\\right] = -eV \\frac{\\partial f(E, \\mu)}{\\partial E}\n$$\n将此线性近似代入净电流 $I$ 的积分中：\n$$\nI \\approx \\frac{g_s e}{h} \\int_{-\\infty}^{\\infty} T(E) \\left(-eV \\frac{\\partial f(E, \\mu)}{\\partial E}\\right) dE\n$$\n$$\nI \\approx -\\frac{g_s e^2 V}{h} \\int_{-\\infty}^{\\infty} T(E) \\frac{\\partial f(E, \\mu)}{\\partial E} dE\n$$\n项 $-\\frac{\\partial f}{\\partial E}$ 是一个在 $E=\\mu$ 处有尖峰的函数，其特征宽度约为 $k_B\\Theta$。在零温下，它变成一个狄拉克 $\\delta$ 函数，$-\\frac{\\partial f}{\\partial E} = \\delta(E-\\mu)$。在有限但低温下，它充当费米能量周围的一个窄采样窗口。\n\n问题指出，$T(E)$ 在 $k_B\\Theta$ 的尺度上是一个平滑函数，并且在此积分中可以用其在 $E=\\mu$ 处的值来代替。这是一个标准的低温/小偏压近似。因此，我们将 $T(\\mu)$ 从积分中提出来：\n$$\nI \\approx -\\frac{g_s e^2 V}{h} T(\\mu) \\int_{-\\infty}^{\\infty} \\frac{\\partial f(E, \\mu)}{\\partial E} dE\n$$\n剩余的积分可以使用微积分基本定理精确计算：\n$$\n\\int_{-\\infty}^{\\infty} \\frac{\\partial f(E, \\mu)}{\\partial E} dE = [f(E, \\mu)]_{E=-\\infty}^{E=\\infty}\n$$\n费米-狄拉克分布的极限是：\n$$\n\\lim_{E \\to \\infty} f(E, \\mu) = \\lim_{E \\to \\infty} \\frac{1}{1 + \\exp\\left(\\frac{E-\\mu}{k_B \\Theta}\\right)} = 0\n$$\n$$\n\\lim_{E \\to -\\infty} f(E, \\mu) = \\lim_{E \\to -\\infty} \\frac{1}{1 + \\exp\\left(\\frac{E-\\mu}{k_B \\Theta}\\right)} = 1\n$$\n因此，该积分的计算结果为：\n$$\n\\int_{-\\infty}^{\\infty} \\frac{\\partial f(E, \\mu)}{\\partial E} dE = 0 - 1 = -1\n$$\n将此结果代回电流的表达式中：\n$$\nI \\approx -\\frac{g_s e^2 V}{h} T(\\mu) (-1) = \\frac{g_s e^2 V}{h} T(\\mu)\n$$\n最后，代入给定的自旋简并度 $g_s=2$：\n$$\nI = \\frac{2 e^2 V}{h} T(\\mu)\n$$\n这个表达式将线性响应区中的净电流 $I$ 与所施加的电压 $V$ 联系起来，定义了电导为 $G = I/V = \\frac{2e^2}{h}T(\\mu)$。结果用所需的常数和函数 $e$、$h$、$V$ 和 $T(\\mu)$ 表示。",
            "answer": "$$\\boxed{\\frac{2e^{2}T(\\mu)}{h}V}$$"
        },
        {
            "introduction": "在单通道公式的基础上，我们现在将研究在支持多种传输模式的系统中电导的行为。这个实践  将演示兰道尔-布蒂克形式主义如何自然地解释在量子点接触中观察到的电导量子化台阶现象。你将探索理想通道如何贡献电导量子 $G_0 = 2e^2/h$，以及现实世界中的不完美（通过透射概率 $T_n \\lt 1$ 建模）如何抑制这些台阶的高度。",
            "id": "3819275",
            "problem": "在一个多尺度工作流中，一个弹道纳米结（量子点接触）被模拟为一个连接两个大电子库的两端器件。该纳米结在费米能级支持多种横向传播模式，并且金属电极与纳米结非完美匹配，因此每个模式在接触处都会经历有限的反射。假设处于低温条件，使得 $k_{B} T \\ll e V$；并假设在小的源漏偏压 $V$ 下为线性响应，输运过程为弹性的、相位相干的。设自旋简并度为 $g_{s} = 2$。\n\n从散射中的概率守恒（即每个模式的散射矩阵是幺正的，因此 $T_{n}(E) + R_{n}(E) = 1$）、粒子流定义为占据态的净通量，以及两个电子库之间的费米-狄拉克分布差异出发，推导接触处的有限反射如何用费米能 $E_{F}$ 处的模式分辨透射系数 $T_{n}(E_{F})$ 来改变量子化电导平台的高度。然后，使用推导出的表达式，计算一个支持四种模式的接触的两端线性响应电导。这些模式在费米能 $E_{F}$ 附近的透射率与能量无关，具体如下：\n$$\nT_{1} = 0.93,\\quad T_{2} = 0.71,\\quad T_{3} = 0.33,\\quad T_{4} = 0.04.\n$$\n使用精确值 $e = 1.602176634 \\times 10^{-19}$ 库仑和 $h = 6.62607015 \\times 10^{-34}$ 焦耳·秒。最终电导以微西门子为单位表示，并将答案四舍五入到四位有效数字。",
            "solution": "该问题是有效的，因为它在科学上基于介观物理学的原理，在数学上是适定的，并为获得唯一解提供了所有必要信息。\n\n相位相干导体的两端线性响应电导 $G$ 由 Landauer-Büttiker 形式理论描述。净电流 $I$ 是从源极（左电子库，L）流向漏极（右电子库，R）的电子通量与反向流动的电子通量之差。总电流是对所有可用输运通道（或模式）求和，这些通道用索引 $n$ 标记。\n\n设左右电子库的化学势分别为 $\\mu_1$ 和 $\\mu_2$。对于一个小的外加偏压 $V$，我们有一个势能差 $e V = \\mu_1 - \\mu_2$，其中 $e$ 是元电荷。我们可以设定 $\\mu_1 = E_F + eV/2$ 和 $\\mu_2 = E_F - eV/2$，其中 $E_F$ 是平衡费米能。假设电子库处于热平衡状态，电子态的占据由费米-狄拉克分布 $f(E, \\mu)$ 描述。\n\n对于源自左电子库的电子，单个模式 $n$ 和单个自旋方向的电流贡献由对所有能量 $E$ 的电荷通量积分给出。在能量区间 $dE$ 内的电荷通量是电荷 $e$、群速度 $v_n(E)$、该模式的一维态密度 $D_{1D,n}(E) = 1/(h v_n(E))$、占据概率 $f(E, \\mu_1)$ 和该模式的透射概率 $T_n(E)$ 的乘积。速度项相互抵消，因此来自左侧的电流贡献为：\n$$ I_{n,L \\to R}^{(1 \\text{ spin})} = \\frac{e}{h} \\int T_n(E) f(E, \\mu_1) \\, dE $$\n类似地，从右电子库流向左侧的电流为：\n$$ I_{n,R \\to L}^{(1 \\text{ spin})} = \\frac{e}{h} \\int T_n(E) f(E, \\mu_2) \\, dE $$\n这里，我们利用了时间反演对称性保证了从左到右的透射概率与从右到左的透射概率相同这一事实。模式 $n$ 和单个自旋的净电流是两者之差：\n$$ I_n^{(1 \\text{ spin})} = I_{n,L \\to R}^{(1 \\text{ spin})} - I_{n,R \\to L}^{(1 \\text{ spin})} = \\frac{e}{h} \\int T_n(E) [f(E, \\mu_1) - f(E, \\mu_2)] \\, dE $$\n总电流 $I$ 是通过对所有模式 $n$ 求和并考虑自旋简并度 $g_s = 2$ 得到的。\n$$ I = \\sum_n g_s I_n^{(1 \\text{ spin})} = \\frac{2e}{h} \\sum_n \\int T_n(E) [f(E, \\mu_1) - f(E, \\mu_2)] \\, dE $$\n问题指定了低温极限（$k_B T \\approx 0$）和线性响应（小 $V$）。在零温下，费米-狄拉克分布是一个阶跃函数：$f(E, \\mu) = \\Theta(\\mu - E)$。差值 $[f(E, \\mu_1) - f(E, \\mu_2)]$ 仅在 $\\mu_2$ 和 $\\mu_1$ 之间的能量窗口内非零。具体来说，当 $E \\in [\\mu_2, \\mu_1]$ 时，它等于 $1$，否则为 $0$。积分简化为：\n$$ I = \\frac{2e}{h} \\sum_n \\int_{\\mu_2}^{\\mu_1} T_n(E) \\, dE $$\n对于一个小的偏压 $V$，能量窗口 $\\mu_1 - \\mu_2 = eV$ 是无穷小窄的。因此，我们可以假设透射函数 $T_n(E)$ 在此区间内是常数，等于其在费米能 $E_F$ 处的值 $T_n(E_F)$。积分变为：\n$$ I \\approx \\frac{2e}{h} \\sum_n T_n(E_F) \\int_{\\mu_2}^{\\mu_1} dE = \\frac{2e}{h} \\sum_n T_n(E_F) (\\mu_1 - \\mu_2) $$\n代入 $\\mu_1 - \\mu_2 = eV$：\n$$ I = \\left(\\frac{2e^2}{h} \\sum_n T_n(E_F)\\right) V $$\n线性响应电导 $G$ 定义为 $G = I/V$。因此，\n$$ G = \\frac{2e^2}{h} \\sum_n T_n(E_F) $$\n这个表达式将电导与费米能级上所有模式的透射概率之和联系起来。项 $G_0 = 2e^2/h$ 是电导量子。\n\n现在，我们来讨论有限反射如何改变电导平台。在一个理想的量子点接触中，随着宽度增加（例如，通过栅极电压），模式会逐一变为传播模式。对于一个理想通道，每个完全打开的模式都有完美的透射，即 $T_n = 1$。总电导为 $G = N G_0$，其中 $N$ 是打开的模式数量。这导致了高度为 $G_0$ 的量子化电导平台。\n\n在存在有限反射 $R_n > 0$（由非完美匹配的接触引起）的情况下，每个模式的透射概率会降低。对于一个两端器件，S矩阵的幺正性要求每个模式的透射概率和反射概率之和为1：$T_n(E) + R_n(E) = 1$。因此，$T_n(E) = 1 - R_n(E) \\le 1$。当一个新模式（比如模式 $m$）变得可传播时，总电导增加 $\\Delta G = G_0 T_m(E_F)$。因为 $T_m  1$，电导平台的高度从理想值 $G_0$ 减小到 $T_m G_0$。因此，有限反射抑制了量子化电导平台的高度。\n\n我们现在的任务是计算一个支持四种模式的器件的总电导，其在费米能附近的透射系数为：$T_1 = 0.93$，$T_2 = 0.71$，$T_3 = 0.33$ 和 $T_4 = 0.04$。\n\n总透射率是各个模式透射率之和：\n$$ \\sum_{n=1}^4 T_n = 0.93 + 0.71 + 0.33 + 0.04 = 2.01 $$\n总电导由下式给出：\n$$ G = \\frac{2e^2}{h} \\sum_{n=1}^4 T_n $$\n我们使用提供的元电荷 $e$ 和普朗克常数 $h$ 的值：\n$e = 1.602176634 \\times 10^{-19}$ C\n$h = 6.62607015 \\times 10^{-34}$ J$\\cdot$s\n\n电导量子 $G_0 = 2e^2/h$ 为：\n$$ G_0 = \\frac{2 \\times (1.602176634 \\times 10^{-19})^2}{6.62607015 \\times 10^{-34}} \\text{ S} \\approx 7.748091729 \\times 10^{-5} \\text{ S} $$\n现在，我们计算总电导 $G$：\n$$ G = G_0 \\times \\sum_{n=1}^4 T_n = (7.748091729 \\times 10^{-5} \\text{ S}) \\times 2.01 $$\n$$ G \\approx 1.5573664375 \\times 10^{-4} \\text{ S} $$\n问题要求结果以微西门子（$\\mu$S）为单位，其中 $1 \\text{ S} = 10^6 \\text{ } \\mu\\text{S}$。\n$$ G \\approx 1.5573664375 \\times 10^{-4} \\times 10^6 \\text{ } \\mu\\text{S} = 155.73664375 \\text{ } \\mu\\text{S} $$\n将结果四舍五入到四位有效数字，我们得到：\n$$ G \\approx 155.7 \\text{ } \\mu\\text{S} $$",
            "answer": "$$ \\boxed{155.7} $$"
        },
        {
            "introduction": "我们之前的练习都假设透射概率 $T(E)$ 是一个已知量。这最后一个高级实践将深入探讨计算该值的核心计算方法：非平衡格林函数（NEGF）形式主义。通过实现费希尔-李关系 ，你将从器件的格林函数计算出完整的散射矩阵，从而获得现代输运模拟工具的实践经验，并验证诸如幺正性等基本物理原理。",
            "id": "3819272",
            "problem": "你需要在一个一维无序紧束缚器件与两根半无限长导线耦合的系统中，在 Landauer–Büttiker 输运的框架下，使用 Fisher-Lee 关系对散射矩阵的幺正性进行数值验证。你的程序必须构建器件的哈密顿量，利用导线的自能推导开放器件的推迟格林函数，从基本定义出发以第一性原理推导 Fisher-Lee 关系，计算散射 (S) 矩阵的矩阵元，并对幺正性进行数值验证。所有计算都是无量纲的。\n\n从以下基本基础和经过充分检验的事实出发：\n1. 器件由一个最近邻紧束缚哈密顿量建模，其尺寸为 $N \\times N$，跳跃振幅为 $t_{\\mathrm{dev}}$，在位能 $\\varepsilon_n$ 包含从 $[-W/2, W/2]$ 均匀抽取的对角无序。哈密顿矩阵 $H$ 是实对称的，其中 $H_{n,n} = \\varepsilon_n$ 且 $H_{n,n\\pm 1} = t_{\\mathrm{dev}}$。\n2. 开放系统的推迟格林函数由包含导线自能的有效非厄米哈密顿量的预解式定义：\n$$\nG^r(E) = \\big[(E + i\\eta) I - H - \\Sigma_L^r(E) - \\Sigma_R^r(E)\\big]^{-1},\n$$\n其中 $I$ 是单位矩阵，$\\eta$ 是一个小的正无穷小量，$\\Sigma_{\\alpha}^r(E)$ 是推迟的导线自能。\n3. 对于一个跳跃为 $t_{\\mathrm{lead}}$、在位能设为零的半无限长最近邻一维导线，其推迟表面格林函数 $g_{\\mathrm{surf}}^r(E)$ 必须通过解析延拓和选择正确的推迟分支来获得，从而保证因果性（对于导线能带内的能量，虚部为负）。导线-器件通过器件端点处的跳跃 $t_{c,\\alpha}$ 进行耦合，这导致一个推迟自能 $\\Sigma_{\\alpha}^r(E)$，它是一个仅在相应器件端点索引上非零的秩一矩阵。\n4. 能级宽度矩阵（也称为耦合函数）定义为\n$$\n\\Gamma_{\\alpha}(E) = i\\left[\\Sigma_{\\alpha}^r(E) - \\Sigma_{\\alpha}^a(E)\\right],\n$$\n其中 $G^a(E) = \\left(G^r(E)\\right)^\\dagger$ 且 $\\Sigma_{\\alpha}^a(E) = \\left(\\Sigma_{\\alpha}^r(E)\\right)^\\dagger$。\n5. 在弹性、相位相干的输运中，散射矩阵 $S(E)$ 是幺正的。使用渐近散射态的定义、电流守恒以及 Lippmann–Schwinger 方程来推导一个 Fisher-Lee 型关系，该关系将 $S(E)$ 与 $G^r(E)$ 和能级宽度矩阵 $\\Gamma_{\\alpha}(E)$ 联系起来。将你的推导具体化到单模一维导线耦合到器件的第一个和最后一个格点的情况。不要假设一个已知的公式；推导一个用 $G^r(E)$ 和由 $\\Gamma_{\\alpha}(E)$ 编码的端点耦合来表示反射和透射振幅的关系。\n\n实现要求：\n- 对于给定的 $N$、$t_{\\mathrm{dev}}$ 和无序宽度 $W$，构建 $H$。使用固定的伪随机数生成器种子以确保不同运行之间的可复现性。\n- 从跳跃为 $t_{\\mathrm{lead}}$ 且分别在第一个和最后一个器件格点处耦合强度为 $t_{c,L}$ 和 $t_{c,R}$ 的一维半无限长导线计算 $\\Sigma_L^r(E)$ 和 $\\Sigma_R^r(E)$。使用一个小的 $+\\eta$ 来确保选择正确的推迟分支以强制执行因果性。\n- 计算 $G^r(E)$，然后使用你推导的 Fisher-Lee 关系计算单模左、右导线的 $2 \\times 2$ 散射矩阵 $S(E)$。从 $S(E)$ 中，提取从左到右的透射振幅 $t_{RL}$ 和左反射振幅 $r_{LL}$。\n- 通过计算与单位矩阵偏差的弗罗贝尼乌斯范数来数值验证幺正性：\n$$\n\\Delta_U = \\left\\| S^\\dagger S - I_2 \\right\\|_F,\n$$\n其中 $I_2$ 是 $2 \\times 2$ 的单位矩阵，$\\|\\cdot\\|_F$ 表示弗罗贝尼乌斯范数。\n- 使用两种方法独立计算透射概率并报告它们的一致性：\n  1. 根据振幅，$T_{\\mathrm{amp}} = |t_{RL}|^2$。\n  2. 根据 Caroli 表达式（一个可从上述定义推导出的经过充分检验的恒等式），\n  $$\n  T_{\\mathrm{Caroli}} = \\mathrm{Tr}\\left[\\Gamma_L G^r \\Gamma_R G^a\\right].\n  $$\n  报告绝对差值 $\\Delta_T = \\left|T_{\\mathrm{amp}} - T_{\\mathrm{Caroli}}\\right|$。\n\n测试套件：\n使用以下参数集，并使用固定的伪随机种子 $s = 13579$ 来生成无序。所有量均为无量纲。对于每种情况，无序的在位能都使用相同的种子从 $[-W/2, W/2]$ 中独立均匀采样，并在该情况下按原样使用。\n\n- 情况 A (理想路径): $N=8$, $t_{\\mathrm{dev}}=1.0$, $W=1.0$, $E=0.3$, $t_{\\mathrm{lead}}=1.0$, $t_{c,L}=1.0$, $t_{c,R}=1.0$, $\\eta=10^{-12}$。\n- 情况 B (靠近能带边缘): $N=8$, $t_{\\mathrm{dev}}=1.0$, $W=0.2$, $E=1.99$, $t_{\\mathrm{lead}}=1.0$, $t_{c,L}=1.0$, $t_{c,R}=0.8$, $\\eta=10^{-12}$。\n- 情况 C (在传播能带之外): $N=8$, $t_{\\mathrm{dev}}=1.0$, $W=1.5$, $E=2.5$, $t_{\\mathrm{lead}}=1.0$, $t_{c,L}=1.0$, $t_{c,R}=1.0$, $\\eta=10^{-12}$。\n- 情况 D (强无序): $N=12$, $t_{\\mathrm{dev}}=1.0$, $W=4.0$, $E=0.0$, $t_{\\mathrm{lead}}=1.0$, $t_{c,L}=1.0$, $t_{c,R}=1.0$, $\\eta=10^{-12}$。\n\n输出规格：\n- 对于每种情况，计算如上定义的 $\\Delta_U$ 和 $\\Delta_T$。\n- 你的程序应生成单行输出，其中包含一个逗号分隔的列表的列表形式的结果，每个内部列表包含两个浮点数 $[\\Delta_U, \\Delta_T]$，并精确到八位小数。例如：\n\"[[0.00000001,0.00000002],[...],...]\"。",
            "solution": "用户提供的问题是计算凝聚态物理领域中一个定义明确且科学严谨的练习，具体涉及介观系统中的量子输运。它要求对一维紧束缚模型的 Landauer-Büttiker 形式理论的基本原理进行数值验证。该问题是有效的，因为它是自洽的、客观的，并且基于已建立的物理理论。所有必需的参数和验证指标都已明确定义。\n\n解决方案分为两个主要阶段：首先，根据问题中陈述的基本原理推导必要的理论公式；其次，在一个数值算法中实现这些公式，以计算指定测试用例所需的验证指标。\n\n**1. 理论阐述**\n\n我们建立一个中心器件区域连接到两个半无限长的一维导线（左，L，和右，R）的模型。\n\n**1.1. 器件哈密顿量, $H$**\n该器件由一个 $N \\times N$ 的实对称紧束缚哈密顿矩阵 $H$ 描述。在位能 $H_{n,n} = \\varepsilon_n$ 包含对角无序，其中每个 $\\varepsilon_n$ 从均匀分布 $U[-W/2, W/2]$ 中抽取。最近邻跳跃为 $H_{n,n\\pm1} = t_{\\mathrm{dev}}$。\n\n**1.2. 导线自能, $\\Sigma_\\alpha^r(E)$**\n器件与半无限长导线耦合的效应由推迟自能矩阵 $\\Sigma_L^r(E)$ 和 $\\Sigma_R^r(E)$ 捕捉。对于一个最近邻跳跃为 $t_{\\mathrm{lead}}$、在位能为 $0$ 的导线 $\\alpha \\in \\{L, R\\}$，它通过耦合强度 $t_{c,\\alpha}$ 连接到器件格点 $p_\\alpha$，其自能是一个仅在耦合格点处非零的秩一矩阵。\n$$\n\\Sigma_{\\alpha}^r(E) = |t_{c,\\alpha}|^2 g_{\\mathrm{surf}}^r(E) |p_\\alpha\\rangle\\langle p_\\alpha|\n$$\n这里， $|p_L\\rangle$ 是第一个格点（$0$），$|p_R\\rangle$ 是最后一个格点（$N-1$）。$g_{\\mathrm{surf}}^r(E)$ 是半无限长导线的推迟表面格林函数。它可以通过考虑导线戴森方程的递归结构来推导。设 $z = E + i\\eta$，其中 $\\eta \\to 0^+$ 强制执行因果性。表面格林函数被发现是：\n$$\ng_{\\mathrm{surf}}^r(E) = \\frac{z - \\sqrt{z^2 - 4t_{\\mathrm{lead}}^2}}{2t_{\\mathrm{lead}}^2}\n$$\n平方根的分支被选择，以使得到的格林函数对应于出射波，这意味着对于导线导通带内的能量（$|E|  2|t_{\\mathrm{lead}}|$），其虚部必须为负。数值库中实现的复数平方根的主分支确保了这一点。\n\n**1.3. 开放系统格林函数, $G^r(E)$**\n当器件与导线耦合时，其推迟格林函数由有效哈密顿量的逆给出：\n$$\nG^r(E) = \\left[ (E + i\\eta)I - H - \\Sigma_L^r(E) - \\Sigma_R^r(E) \\right]^{-1}\n$$\n其中 $I$ 是 $N \\times N$ 的单位矩阵。超前格林函数是其伴随矩阵：$G^a(E) = \\left(G^r(E)\\right)^\\dagger$。\n\n**1.4. 能级宽度矩阵, $\\Gamma_\\alpha(E)$**\n能级宽度矩阵 $\\Gamma_\\alpha(E)$ 描述了电子从器件逃逸到导线 $\\alpha$ 的速率。它与自能的反厄米部分有关：\n$$\n\\Gamma_\\alpha(E) = i\\left[\\Sigma_\\alpha^r(E) - \\Sigma_\\alpha^a(E)\\right] = i\\left[\\Sigma_\\alpha^r(E) - (\\Sigma_\\alpha^r(E))^\\dagger\\right]\n$$\n代入 $\\Sigma_\\alpha^r(E)$ 的表达式并注意 $t_{c,\\alpha}$ 是实数：\n$$\n\\Gamma_\\alpha(E) = i |t_{c,\\alpha}|^2 \\left[g_{\\mathrm{surf}}^r(E) - (g_{\\mathrm{surf}}^r(E))^*\\right] |p_\\alpha\\rangle\\langle p_\\alpha| = -2 |t_{c,\\alpha}|^2 \\mathrm{Im}[g_{\\mathrm{surf}}^r(E)] |p_\\alpha\\rangle\\langle p_\\alpha|\n$$\n由于对于推迟格林函数 $\\mathrm{Im}[g_{\\mathrm{surf}}^r(E)] \\le 0$，所以 $\\Gamma_\\alpha(E)$ 的对角元是非负的。\n\n**1.5. Fisher-Lee 关系与散射矩阵, $S(E)$**\nFisher-Lee 关系将散射矩阵 $S(E)$ 与器件的格林函数联系起来。对于一个具有单模导线的两端器件，其 $2 \\times 2$ S-矩阵元 $S_{\\beta\\alpha}$（表示从导线 $\\alpha$ 散射到 $\\beta$）由下式给出：\n$$\nS_{\\beta\\alpha}(E) = -\\delta_{\\beta\\alpha} + i \\sqrt{\\Gamma_{\\beta, p_\\beta p_\\beta}} G^r_{p_\\beta, p_\\alpha}(E) \\sqrt{\\Gamma_{\\alpha, p_\\alpha p_\\alpha}}\n$$\n这里，$\\Gamma_{\\alpha, p_\\alpha p_\\alpha}$ 是 $\\Gamma_\\alpha$ 矩阵的唯一非零对角元，而 $G^r_{p_\\beta, p_\\alpha}$ 是连接两个耦合格点的完整器件格林函数的元素。克罗内克符号 $-\\delta_{\\beta\\alpha}$ 的反直觉符号源于渐近散射态的特定相位约定，并且是确保幺正性的必要条件。这一点可以通过将此关系代数代换到幺正性条件 $S^\\dagger S = I$ 中，并使用恒等式 $G^r - G^a = i G^r (\\Gamma_L + \\Gamma_R) G^a$ 来证明。\n\nS-矩阵元则为：\n$r_{LL} \\equiv S_{LL} = -1 + i \\Gamma_{L,00} G^r_{0,0}$\n$t_{LR} \\equiv S_{LR} = i \\sqrt{\\Gamma_{L,00} \\Gamma_{R,N-1,N-1}} G^r_{0,N-1}$\n$t_{RL} \\equiv S_{RL} = i \\sqrt{\\Gamma_{R,N-1,N-1} \\Gamma_{L,00}} G^r_{N-1,0}$\n$r_{RR} \\equiv S_{RR} = -1 + i \\Gamma_{R,N-1,N-1} G^r_{N-1,N-1}$\n\n**2. 验证指标**\n\n**2.1. 幺正性检验, $\\Delta_U$**\n对于弹性散射，S-矩阵必须是幺正的，即 $S^\\dagger S = I$。我们通过计算与单位矩阵偏差的弗罗贝尼乌斯范数来数值验证这一点：\n$$\n\\Delta_U = \\left\\| S^\\dagger S - I_2 \\right\\|_F = \\sqrt{\\sum_{i,j=1}^{2} |(S^\\dagger S - I_2)_{ij}|^2}\n$$\n\n**2.2. 透射一致性, $\\Delta_T$**\n从导线 L 到 R 的透射概率可以通过两种方式计算。首先，根据透射振幅：\n$$\nT_{\\mathrm{amp}} = |t_{RL}|^2\n$$\n其次，使用 Caroli 公式，这是 NEGF 形式理论的直接推论：\n$$\nT_{\\mathrm{Caroli}} = \\mathrm{Tr}\\left[\\Gamma_L G^r \\Gamma_R G^a\\right]\n$$\n对于我们的特定设置，此迹简化为 $\\Gamma_{L,00} \\Gamma_{R,N-1,N-1} |G^r_{0,N-1}|^2$。快速检查表明，$T_{\\mathrm{amp}}$ 是 $|i \\sqrt{\\Gamma_{R} \\Gamma_{L}} G^r_{N-1,0}|^2 = \\Gamma_R \\Gamma_L |G^r_{N-1,0}|^2$。由于 $H$ 是实对称的，$G^r$ 也是对称的 ($G^r_{N-1,0} = G^r_{0,N-1}$)，从而证实了该恒等式。我们计算绝对差值：\n$$\n\\Delta_T = |T_{\\mathrm{amp}} - T_{\\mathrm{Caroli}}|\n$$\n\n**3. 数值实现**\n算法流程如下：\n1.  对于每个测试用例，将伪随机数生成器种子设置为指定值。\n2.  构建具有无序在位能的 $N \\times N$ 器件哈密顿矩阵 $H$。\n3.  计算导线的推迟表面格林函数 $g_{\\mathrm{surf}}^r(E)$。\n4.  构建 $N \\times N$ 自能矩阵 $\\Sigma_L^r(E)$ 和 $\\Sigma_R^r(E)$。\n5.  通过矩阵求逆计算完整的器件推迟格林函数 $G^r(E)$。\n6.  从自能计算标量能级宽度 $\\Gamma_L$ 和 $\\Gamma_R$。\n7.  使用 Fisher-Lee 关系组装 $2 \\times 2$ 散射矩阵 $S(E)$。\n8.  计算幺正性偏差 $\\Delta_U$ 和透射一致性误差 $\\Delta_T$。\n9.  存储并按要求格式化结果。\n\n对问题陈述中提供的每个参数集执行此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation for all test cases and print the results.\n    \"\"\"\n    # Test cases defined in the problem statement.\n    test_cases = [\n        # Case A (happy path)\n        {'N': 8, 't_dev': 1.0, 'W': 1.0, 'E': 0.3, 't_lead': 1.0, 't_c_L': 1.0, 't_c_R': 1.0, 'eta': 1e-12, 'seed': 13579},\n        # Case B (near band edge)\n        {'N': 8, 't_dev': 1.0, 'W': 0.2, 'E': 1.99, 't_lead': 1.0, 't_c_L': 1.0, 't_c_R': 0.8, 'eta': 1e-12, 'seed': 13579},\n        # Case C (outside the propagating band)\n        {'N': 8, 't_dev': 1.0, 'W': 1.5, 'E': 2.5, 't_lead': 1.0, 't_c_L': 1.0, 't_c_R': 1.0, 'eta': 1e-12, 'seed': 13579},\n        # Case D (strong disorder)\n        {'N': 12, 't_dev': 1.0, 'W': 4.0, 'E': 0.0, 't_lead': 1.0, 't_c_L': 1.0, 't_c_R': 1.0, 'eta': 1e-12, 'seed': 13579},\n    ]\n\n    results = []\n    for params in test_cases:\n        result = _calculate_transport_metrics(**params)\n        results.append(result)\n\n    # Format the output as specified: \"[[val, val], [val, val], ...]\" with 8 decimal places.\n    formatted_results = [f\"[{res[0]:.8f},{res[1]:.8f}]\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef _calculate_transport_metrics(N, t_dev, W, E, t_lead, t_c_L, t_c_R, eta, seed):\n    \"\"\"\n    Performs the transport calculation for a single set of parameters.\n    \"\"\"\n    # 1. Construct the device Hamiltonian H\n    np.random.seed(seed)\n    # On-site energies with disorder\n    onsite_energies = (np.random.rand(N) - 0.5) * W\n    H = np.diag(onsite_energies)\n    # Hopping terms\n    off_diag = np.full(N - 1, t_dev)\n    H += np.diag(off_diag, k=1) + np.diag(off_diag, k=-1)\n\n    # 2. Compute lead self-energy\n    z = E + 1j * eta\n    # Note: np.sqrt handles the complex branch cut correctly for the principal root.\n    # The formula is derived from the recursive solution for a semi-infinite chain.\n    # This choice of branch ensures Im(g_surf_r) = 0, which is required for a retarded GF.\n    sqrt_term = np.sqrt(z**2 - (2 * t_lead)**2 + 0j) # add 0j to ensure complex result even if z^2 - 4t^2 is real\n    g_surf_r = (z - sqrt_term) / (2 * t_lead**2)\n\n    # 3. Construct self-energy matrices\n    Sigma_L_r = np.zeros((N, N), dtype=complex)\n    Sigma_R_r = np.zeros((N, N), dtype=complex)\n    Sigma_L_r[0, 0] = t_c_L**2 * g_surf_r\n    Sigma_R_r[N - 1, N - 1] = t_c_R**2 * g_surf_r\n\n    # 4. Compute the retarded Green's function G_r\n    I = np.eye(N)\n    H_eff_inv = z * I - H - Sigma_L_r - Sigma_R_r\n    G_r = np.linalg.inv(H_eff_inv)\n\n    # 5. Compute level-width matrices Gamma_L and Gamma_R\n    Sigma_L_a = Sigma_L_r.conj().T\n    Gamma_L_matrix = 1j * (Sigma_L_r - Sigma_L_a)\n    \n    Sigma_R_a = Sigma_R_r.conj().T\n    Gamma_R_matrix = 1j * (Sigma_R_r - Sigma_R_a)\n    \n    # We only need the scalar values since Gamma is diagonal\n    gamma_L = Gamma_L_matrix[0, 0].real\n    gamma_R = Gamma_R_matrix[N - 1, N - 1].real\n\n    # 6. Compute S-matrix using the Fisher-Lee relation\n    G_r_00 = G_r[0, 0]\n    G_r_0N = G_r[0, N - 1]\n    G_r_N0 = G_r[N - 1, 0]\n    G_r_NN = G_r[N - 1, N - 1]\n    \n    # S_beta,alpha = -delta_beta,alpha + i * sqrt(gamma_beta) * G_r_beta,alpha * sqrt(gamma_alpha)\n    r_LL = -1 + 1j * gamma_L * G_r_00\n    t_LR = 1j * np.sqrt(gamma_L * gamma_R) * G_r_0N\n    t_RL = 1j * np.sqrt(gamma_R * gamma_L) * G_r_N0\n    r_RR = -1 + 1j * gamma_R * G_r_NN\n\n    S = np.array([[r_LL, t_LR], [t_RL, r_RR]])\n\n    # 7. Verify unitarity\n    S_dagger_S = S.conj().T @ S\n    I2 = np.eye(2)\n    delta_U = np.linalg.norm(S_dagger_S - I2, 'fro')\n\n    # 8. Verify transmission\n    # T from scattering amplitude\n    T_amp = np.abs(t_RL)**2\n    \n    # T from Caroli formula: Tr[Gamma_L * G_r * Gamma_R * G_a]\n    G_a = G_r.conj().T\n    T_caroli = np.trace(Gamma_L_matrix @ G_r @ Gamma_R_matrix @ G_a).real\n    \n    delta_T = np.abs(T_amp - T_caroli)\n\n    return delta_U, delta_T\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}