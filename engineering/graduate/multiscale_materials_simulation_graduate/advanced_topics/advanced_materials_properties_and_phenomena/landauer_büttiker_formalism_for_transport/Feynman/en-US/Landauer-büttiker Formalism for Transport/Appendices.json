{
    "hands_on_practices": [
        {
            "introduction": "The cornerstone of the Landauer-Büttiker formalism is the profound idea that electrical conductance is fundamentally a measure of quantum mechanical transmission. This first practice guides you through the derivation of this relationship in the linear response regime. By considering the net flow of electrons between two reservoirs at slightly different chemical potentials, you will derive the celebrated Landauer formula, which expresses conductance in terms of the transmission probability $T(E)$ at the Fermi energy, providing a direct link between a microscopic scattering property and a macroscopic transport measurement .",
            "id": "3819239",
            "problem": "Consider a phase-coherent one-dimensional conductor connecting two large electron reservoirs held at the same absolute temperature $T$ and at slightly different chemical potentials $\\mu_L=\\mu+eV/2$ and $\\mu_R=\\mu-eV/2$, where $e$ is the positive elementary charge and $|eV| \\ll k_B T$. The conductor is characterized by an energy-dependent transmission probability $T(E)$, which is a smooth function of energy on the scale of $k_B T$ in a neighborhood of $E=\\mu$. Assume zero magnetic field and spin degeneracy $g_s=2$, and neglect inelastic scattering in the conductor.\n\nUsing the Landauer picture for coherent transport and working consistently to linear order in the small bias $V$, derive a closed-form analytic expression for the net current $I$ flowing from left to right in terms of $e$, $h$, $V$, and $T(\\mu)$. You may assume that $T(E)$ varies slowly enough near $E=\\mu$ to justify replacing it by its value at $E=\\mu$ in any energy integral weighted by the derivative of a Fermi-Dirac distribution. Express your final answer as an analytic expression. Do not include units in your final expression.",
            "solution": "The problem is first validated against the specified criteria.\n\n### Step 1: Extract Givens\n-   **System**: A phase-coherent one-dimensional conductor connecting two large electron reservoirs.\n-   **Reservoir Temperature**: Both reservoirs are at the same absolute temperature $T$.\n-   **Reservoir Chemical Potentials**: $\\mu_L = \\mu+eV/2$ and $\\mu_R = \\mu-eV/2$.\n-   **Charge**: $e$ is the positive elementary charge.\n-   **Bias Condition**: Small bias voltage $V$ such that $|eV| \\ll k_B T$.\n-   **Transmission Probability**: An energy-dependent function $T(E)$, which is smooth on the scale of $k_B T$ near $E=\\mu$.\n-   **Magnetic Field**: Zero.\n-   **Spin Degeneracy**: $g_s=2$.\n-   **Scattering**: Inelastic scattering is negligible in the conductor.\n-   **Task**: Derive a closed-form analytic expression for the net current $I$ from left to right.\n-   **Approximation**: The derivation must be consistently to linear order in $V$.\n-   **Simplification**: It is permissible to replace $T(E)$ with its value at $E=\\mu$ inside any integral weighted by the derivative of a Fermi-Dirac distribution.\n-   **Final Expression**: The current $I$ must be expressed in terms of $e$, $h$, $V$, and $T(\\mu)$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, as it describes the canonical setup for the Landauer-Büttiker formalism, a fundamental theory in mesoscopic physics. All assumptions, such as coherent transport, the form of the chemical potentials, and the linear response condition $|eV| \\ll k_B T$, are standard and physically sound. The problem is well-posed; it provides all necessary information and a clear objective, leading to a unique, well-defined solution (the linear-response conductance). The language used is objective and precise. The problem is a standard textbook exercise and does not violate any of the invalidity criteria.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full solution will be derived.\n\nThe net current $I$ flowing through the conductor is the difference between the current moving from the left reservoir to the right, $I_{L \\to R}$, and the current moving from the right reservoir to the left, $I_{R \\to L}$.\n\nThe Landauer formula provides an expression for the current contribution from each reservoir. The current from the left reservoir is given by the integral over all energies of the charge flux. The charge flux at a given energy $E$ is the product of the elementary charge $e$, the number of available transport channels (including spin, $g_s=2$), the flux of states per channel per unit energy ($1/h$), the probability that a state is occupied in the source reservoir ($f(E, \\mu_L)$), and the probability that an electron will transmit through the conductor ($T(E)$).\n\nThus, the current from left to right is:\n$$\nI_{L \\to R} = \\frac{g_s e}{h} \\int_{-\\infty}^{\\infty} T(E) f(E, \\mu_L) dE\n$$\nSimilarly, the current from right to left is:\n$$\nI_{R \\to L} = \\frac{g_s e}{h} \\int_{-\\infty}^{\\infty} T(E) f(E, \\mu_R) dE\n$$\nHere, $f(E, \\mu')$ is the Fermi-Dirac distribution function:\n$$\nf(E, \\mu') = \\frac{1}{1 + \\exp\\left(\\frac{E-\\mu'}{k_B T}\\right)}\n$$\nThe net current $I$ is the difference $I = I_{L \\to R} - I_{R \\to L}$:\n$$\nI = \\frac{g_s e}{h} \\int_{-\\infty}^{\\infty} T(E) \\left[f(E, \\mu_L) - f(E, \\mu_R)\\right] dE\n$$\nWe are given $\\mu_L = \\mu + eV/2$ and $\\mu_R = \\mu - eV/2$. The problem specifies that the applied bias $V$ is small, corresponding to the linear response regime where $|eV| \\ll k_B T$. In this limit, we can perform a Taylor expansion of the Fermi-Dirac distribution difference around the average chemical potential $\\mu$.\n\nLet $\\Delta f = f(E, \\mu + eV/2) - f(E, \\mu - eV/2)$. For a small perturbation $\\delta\\mu$, $f(E, \\mu+\\delta\\mu) \\approx f(E,\\mu) + \\frac{\\partial f}{\\partial \\mu} \\delta\\mu$. Using the property $\\frac{\\partial f}{\\partial \\mu} = -\\frac{\\partial f}{\\partial E}$, we have $f(E, \\mu+\\delta\\mu) \\approx f(E,\\mu) - \\frac{\\partial f}{\\partial E} \\delta\\mu$.\n\nApplying this to our chemical potentials:\n$$\nf(E, \\mu_L) \\approx f(E, \\mu) - \\frac{\\partial f(E, \\mu)}{\\partial E} \\left(\\frac{eV}{2}\\right)\n$$\n$$\nf(E, \\mu_R) \\approx f(E, \\mu) - \\frac{\\partial f(E, \\mu)}{\\partial E} \\left(-\\frac{eV}{2}\\right) = f(E, \\mu) + \\frac{\\partial f(E, \\mu)}{\\partial E} \\left(\\frac{eV}{2}\\right)\n$$\nThe difference, to linear order in $V$, is:\n$$\nf(E, \\mu_L) - f(E, \\mu_R) \\approx \\left[f(E, \\mu) - \\frac{\\partial f}{\\partial E}\\frac{eV}{2}\\right] - \\left[f(E, \\mu) + \\frac{\\partial f}{\\partial E}\\frac{eV}{2}\\right] = -eV \\frac{\\partial f(E, \\mu)}{\\partial E}\n$$\nSubstituting this linear approximation into the integral for the net current $I$:\n$$\nI \\approx \\frac{g_s e}{h} \\int_{-\\infty}^{\\infty} T(E) \\left(-eV \\frac{\\partial f(E, \\mu)}{\\partial E}\\right) dE\n$$\n$$\nI \\approx -\\frac{g_s e^2 V}{h} \\int_{-\\infty}^{\\infty} T(E) \\frac{\\partial f(E, \\mu)}{\\partial E} dE\n$$\nThe term $-\\frac{\\partial f}{\\partial E}$ is a function sharply peaked at $E=\\mu$ with a characteristic width of the order of $k_B T$. At zero temperature, it becomes a Dirac delta function, $-\\frac{\\partial f}{\\partial E} = \\delta(E-\\mu)$. At finite but low temperatures, it serves as a narrow sampling window around the Fermi energy.\n\nThe problem states that $T(E)$ is a smooth function on the scale of $k_B T$ and can be replaced by its value at $E=\\mu$ in this integral. This is a standard low-temperature/small-bias approximation. We therefore pull $T(\\mu)$ out of the integral:\n$$\nI \\approx -\\frac{g_s e^2 V}{h} T(\\mu) \\int_{-\\infty}^{\\infty} \\frac{\\partial f(E, \\mu)}{\\partial E} dE\n$$\nThe remaining integral can be evaluated exactly using the fundamental theorem of calculus:\n$$\n\\int_{-\\infty}^{\\infty} \\frac{\\partial f(E, \\mu)}{\\partial E} dE = [f(E, \\mu)]_{E=-\\infty}^{E=\\infty}\n$$\nThe limits of the Fermi-Dirac distribution are:\n$$\n\\lim_{E \\to \\infty} f(E, \\mu) = \\lim_{E \\to \\infty} \\frac{1}{1 + \\exp\\left(\\frac{E-\\mu}{k_B T}\\right)} = 0\n$$\n$$\n\\lim_{E \\to -\\infty} f(E, \\mu) = \\lim_{E \\to -\\infty} \\frac{1}{1 + \\exp\\left(\\frac{E-\\mu}{k_B T}\\right)} = 1\n$$\nTherefore, the integral evaluates to:\n$$\n\\int_{-\\infty}^{\\infty} \\frac{\\partial f(E, \\mu)}{\\partial E} dE = 0 - 1 = -1\n$$\nSubstituting this result back into the expression for the current:\n$$\nI \\approx -\\frac{g_s e^2 V}{h} T(\\mu) (-1) = \\frac{g_s e^2 V}{h} T(\\mu)\n$$\nFinally, substituting the given spin degeneracy $g_s=2$:\n$$\nI = \\frac{2 e^2 V}{h} T(\\mu)\n$$\nThis expression relates the net current $I$ to the applied voltage $V$ in the linear response regime, defining the electrical conductance as $G = I/V = \\frac{2e^2}{h}T(\\mu)$. The result is in terms of the required constants and functions $e$, $h$, $V$, and $T(\\mu)$.",
            "answer": "$$\\boxed{\\frac{2e^{2}T(\\mu)}{h}V}$$"
        },
        {
            "introduction": "Building upon the single-channel Landauer formula, we now explore how the formalism describes transport in more realistic systems that support multiple conduction pathways, or modes. This exercise demonstrates how the total conductance is the sum of contributions from all available modes, each weighted by its own transmission probability $T_n$. This multi-mode picture is essential for understanding the iconic experimental observation of quantized conductance steps in quantum point contacts, and this practice will clarify how imperfections, which reduce transmission below unity, affect these steps .",
            "id": "3819275",
            "problem": "A ballistic nanoconstriction (quantum point contact) is simulated within a multiscale workflow as a two-terminal device bridging two large electron reservoirs. The constriction supports multiple transverse propagating modes at the Fermi energy, and the metallic contacts are imperfectly matched to the nanoconstriction so that each mode experiences finite reflection at the contact. Assume low temperature and linear response with a small source-drain bias $V$, and assume elastic, phase-coherent transport. Let the spin degeneracy be $g_{s} = 2$.\n\nStarting from conservation of probability in scattering (unitarity of the scattering matrix for each mode, so that $T_{n}(E) + R_{n}(E) = 1$), the definition of particle current as the net flux of occupied states, and the Fermi–Dirac distribution difference between reservoirs, derive how finite reflection at the contact modifies the height of the quantized conductance steps in terms of the mode-resolved transmission coefficients $T_{n}(E_{F})$ at the Fermi energy $E_{F}$. Then, using the derived expression, compute the two-terminal linear-response conductance for a contact that supports four modes with energy-independent transmissions near $E_{F}$:\n$$\nT_{1} = 0.93,\\quad T_{2} = 0.71,\\quad T_{3} = 0.33,\\quad T_{4} = 0.04.\n$$\nUse the exact values $e = 1.602176634 \\times 10^{-19}$ coulomb and $h = 6.62607015 \\times 10^{-34}$ joule-second. Express the final conductance in microSiemens and round your answer to four significant figures.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of mesoscopic physics, is mathematically well-posed, and provides all necessary information for a unique solution.\n\nThe two-terminal linear-response conductance $G$ of a phase-coherent conductor is described by the Landauer-Büttiker formalism. The net electrical current $I$ is the difference between the flux of electrons moving from the source (left reservoir, L) to the drain (right reservoir, R) and the flux moving in the opposite direction. The total current is a sum over all available transport channels, or modes, labeled by the index $n$.\n\nLet the chemical potentials of the left and right reservoirs be $\\mu_1$ and $\\mu_2$, respectively. For a small applied bias voltage $V$, we have a potential energy difference of $e V = \\mu_1 - \\mu_2$, where $e$ is the elementary charge. We can set $\\mu_1 = E_F + eV/2$ and $\\mu_2 = E_F - eV/2$, where $E_F$ is the equilibrium Fermi energy. The reservoirs are assumed to be in thermal equilibrium, and the occupation of electronic states is described by the Fermi-Dirac distribution, $f(E, \\mu)$.\n\nThe current contribution from a single mode $n$ and a single spin direction for electrons originating from the left reservoir is given by the integral over all energies $E$ of the charge flux. The charge flux in an energy interval $dE$ is the product of the charge $e$, the group velocity $v_n(E)$, the one-dimensional density of states for that mode $D_{1D,n}(E) = 1/(h v_n(E))$, the occupation probability $f(E, \\mu_1)$, and the transmission probability $T_n(E)$ for that mode. The velocity terms cancel, so the current contribution from the left is:\n$$ I_{n,L \\to R}^{(1 \\text{ spin})} = \\frac{e}{h} \\int T_n(E) f(E, \\mu_1) \\, dE $$\nSimilarly, the current from the right reservoir flowing to the left is:\n$$ I_{n,R \\to L}^{(1 \\text{ spin})} = \\frac{e}{h} \\int T_n(E) f(E, \\mu_2) \\, dE $$\nHere, we have used the fact that time-reversal symmetry ensures the transmission probability from left-to-right is the same as from right-to-left. The net current for mode $n$ and one spin is the difference:\n$$ I_n^{(1 \\text{ spin})} = I_{n,L \\to R}^{(1 \\text{ spin})} - I_{n,R \\to L}^{(1 \\text{ spin})} = \\frac{e}{h} \\int T_n(E) [f(E, \\mu_1) - f(E, \\mu_2)] \\, dE $$\nThe total current $I$ is obtained by summing over all modes $n$ and accounting for spin degeneracy, $g_s = 2$.\n$$ I = \\sum_n g_s I_n^{(1 \\text{ spin})} = \\frac{2e}{h} \\sum_n \\int T_n(E) [f(E, \\mu_1) - f(E, \\mu_2)] \\, dE $$\nThe problem specifies the low temperature limit ($k_B T \\approx 0$) and linear response (small $V$). At zero temperature, the Fermi-Dirac distribution is a step function: $f(E, \\mu) = \\Theta(\\mu - E)$. The difference $[f(E, \\mu_1) - f(E, \\mu_2)]$ is non-zero only in the energy window between $\\mu_2$ and $\\mu_1$. Specifically, it is equal to $1$ for $E \\in [\\mu_2, \\mu_1]$ and $0$ otherwise. The integral simplifies to:\n$$ I = \\frac{2e}{h} \\sum_n \\int_{\\mu_2}^{\\mu_1} T_n(E) \\, dE $$\nFor a small bias voltage $V$, the energy window $\\mu_1 - \\mu_2 = eV$ is infinitesimally narrow. We can therefore assume that the transmission function $T_n(E)$ is constant over this interval and equal to its value at the Fermi energy, $T_n(E_F)$. The integral becomes:\n$$ I \\approx \\frac{2e}{h} \\sum_n T_n(E_F) \\int_{\\mu_2}^{\\mu_1} dE = \\frac{2e}{h} \\sum_n T_n(E_F) (\\mu_1 - \\mu_2) $$\nSubstituting $\\mu_1 - \\mu_2 = eV$:\n$$ I = \\left(\\frac{2e^2}{h} \\sum_n T_n(E_F)\\right) V $$\nThe linear-response conductance $G$ is defined as $G = I/V$. Therefore,\n$$ G = \\frac{2e^2}{h} \\sum_n T_n(E_F) $$\nThis expression relates the conductance to the sum of transmission probabilities of all modes at the Fermi energy. The term $G_0 = 2e^2/h$ is the quantum of conductance.\n\nNow, we address how finite reflection modifies the conductance steps. In an ideal quantum point contact, as the width is increased (e.g., by a gate voltage), modes become propagating one by one. For an ideal channel, each fully open mode has perfect transmission, $T_n = 1$. The total conductance is $G = N G_0$, where $N$ is the number of open modes. This leads to quantized conductance steps of height $G_0$.\n\nIn the presence of finite reflection $R_n > 0$, as stipulated by imperfectly matched contacts, the transmission probability for each mode is reduced. The unitarity of the S-matrix for a two-terminal device requires that the sum of transmission and reflection probabilities for each mode is unity: $T_n(E) + R_n(E) = 1$. Therefore, $T_n(E) = 1 - R_n(E) < 1$. When a new mode, say mode $m$, becomes accessible, the total conductance increases by $\\Delta G = G_0 T_m(E_F)$. Because $T_m < 1$, the height of the conductance step is reduced from the ideal value of $G_0$ to $T_m G_0$. Finite reflection thus suppresses the height of the quantized conductance steps.\n\nWe are now tasked with calculating the total conductance for a device supporting four modes with given transmission coefficients near the Fermi energy: $T_1 = 0.93$, $T_2 = 0.71$, $T_3 = 0.33$, and $T_4 = 0.04$.\n\nThe total transmission is the sum of the individual mode transmissions:\n$$ \\sum_{n=1}^4 T_n = 0.93 + 0.71 + 0.33 + 0.04 = 2.01 $$\nThe total conductance is given by:\n$$ G = \\frac{2e^2}{h} \\sum_{n=1}^4 T_n $$\nWe use the provided values for the elementary charge $e$ and Planck's constant $h$:\n$e = 1.602176634 \\times 10^{-19}$ C\n$h = 6.62607015 \\times 10^{-34}$ J$\\cdot$s\n\nThe quantum of conductance $G_0 = 2e^2/h$ is:\n$$ G_0 = \\frac{2 \\times (1.602176634 \\times 10^{-19})^2}{6.62607015 \\times 10^{-34}} \\text{ S} \\approx 7.748091729 \\times 10^{-5} \\text{ S} $$\nNow, we calculate the total conductance $G$:\n$$ G = G_0 \\times \\sum_{n=1}^4 T_n = (7.748091729 \\times 10^{-5} \\text{ S}) \\times 2.01 $$\n$$ G \\approx 1.5573664375 \\times 10^{-4} \\text{ S} $$\nThe problem asks for the result in microSiemens ($\\mu$S), where $1 \\text{ S} = 10^6 \\text{ } \\mu\\text{S}$.\n$$ G \\approx 1.5573664375 \\times 10^{-4} \\times 10^6 \\text{ } \\mu\\text{S} = 155.73664375 \\text{ } \\mu\\text{S} $$\nRounding the result to four significant figures, we get:\n$$ G \\approx 155.7 \\text{ } \\mu\\text{S} $$",
            "answer": "$$ \\boxed{155.7} $$"
        },
        {
            "introduction": "Having established how to use transmission probabilities, we now turn to the practical question of how to compute them for a complex device. This advanced computational exercise introduces the powerful Non-Equilibrium Green's Function (NEGF) method, a standard tool in nanoscale device simulation. You will use the Fisher-Lee relation to connect the device's Green's function, which accounts for disorder and coupling to leads, directly to the scattering matrix elements, and thereby calculate the transmission. Verifying fundamental principles like S-matrix unitarity provides a crucial check on the physical consistency of your numerical model .",
            "id": "3819272",
            "problem": "You are to implement a numerical verification of scattering matrix unitarity using the Fisher–Lee relation within the context of Landauer–Büttiker transport for a one-dimensional disordered tight-binding device coupled to two semi-infinite leads. Your program must construct the device Hamiltonian, derive the retarded Green’s function for the open device using self-energies of the leads, derive the Fisher–Lee relation from first principles starting from fundamental definitions, compute the scattering (S) matrix elements, and verify unitarity numerically. All calculations are dimensionless.\n\nStart from the following fundamental base and well-tested facts:\n1. The device is modeled by a nearest-neighbor tight-binding Hamiltonian of size $N \\times N$ with hopping amplitude $t_{\\mathrm{dev}}$ and on-site energies $\\varepsilon_n$ that include diagonal disorder drawn uniformly from $[-W/2, W/2]$. The Hamiltonian matrix $H$ is real symmetric with $H_{n,n} = \\varepsilon_n$ and $H_{n,n\\pm 1} = t_{\\mathrm{dev}}$.\n2. The open system retarded Green’s function is defined by the resolvent of the effective non-Hermitian Hamiltonian including self-energies of the leads: \n$$\nG^r(E) = \\big[(E + i\\eta) I - H - \\Sigma_L^r(E) - \\Sigma_R^r(E)\\big]^{-1},\n$$\nwhere $I$ is the identity, $\\eta$ is a small positive infinitesimal, and $\\Sigma_{\\alpha}^r(E)$ are the retarded lead self-energies.\n3. For a semi-infinite nearest-neighbor one-dimensional lead with hopping $t_{\\mathrm{lead}}$ and on-site energy set to zero, the retarded surface Green’s function $g_{\\mathrm{surf}}^r(E)$ must be obtained via analytic continuation and the correct retarded branch choice, so that causality is respected (negative imaginary part for energies within the lead band). The lead-device coupling is via a hopping $t_{c,\\alpha}$ at the device endpoint, leading to a retarded self-energy $\\Sigma_{\\alpha}^r(E)$ that is a rank-one matrix supported on the corresponding device endpoint index.\n4. The level-width matrix (also called coupling function) is defined by \n$$\n\\Gamma_{\\alpha}(E) = i\\left[\\Sigma_{\\alpha}^r(E) - \\Sigma_{\\alpha}^a(E)\\right],\n$$\nwith $G^a(E) = \\left(G^r(E)\\right)^\\dagger$ and $\\Sigma_{\\alpha}^a(E) = \\left(\\Sigma_{\\alpha}^r(E)\\right)^\\dagger$.\n5. The scattering matrix $S(E)$ is unitary in elastic, phase-coherent transport. Use the definitions of asymptotic scattering states, current conservation, and the Lippmann–Schwinger equation to derive a Fisher–Lee-type relation that connects $S(E)$ with $G^r(E)$ and the level-width matrices $\\Gamma_{\\alpha}(E)$. Specialize your derivation to the case of single-mode one-dimensional leads coupled to the first and last device sites. Do not assume a pre-known formula; derive a relation expressing reflection and transmission amplitudes in terms of $G^r(E)$ and the endpoint couplings encoded by $\\Gamma_{\\alpha}(E)$.\n\nImplementation requirements:\n- Construct $H$ for a given $N$, $t_{\\mathrm{dev}}$, and disorder width $W$. Use a fixed pseudorandom number generator seed to ensure reproducibility across runs.\n- Compute $\\Sigma_L^r(E)$ and $\\Sigma_R^r(E)$ from the one-dimensional semi-infinite leads with hopping $t_{\\mathrm{lead}}$ and couplings $t_{c,L}$ and $t_{c,R}$ at the first and last device sites, respectively. Ensure the correct retarded branch using a small $+\\eta$ to enforce causality.\n- Compute $G^r(E)$, then use your derived Fisher–Lee relation to compute the $2 \\times 2$ scattering matrix $S(E)$ for single-mode left and right leads. From $S(E)$, extract the left-to-right transmission amplitude $t_{RL}$ and the left reflection amplitude $r_{LL}$.\n- Verify unitarity numerically by computing the Frobenius norm of the deviation from the identity:\n$$\n\\Delta_U = \\left\\| S^\\dagger S - I_2 \\right\\|_F,\n$$\nwhere $I_2$ is the $2 \\times 2$ identity matrix and $\\|\\cdot\\|_F$ denotes the Frobenius norm.\n- Independently compute the transmission probability using two methods and report their agreement:\n  1. From the amplitude, $T_{\\mathrm{amp}} = |t_{RL}|^2$.\n  2. From the Caroli expression (a well-tested identity following from the definitions above), \n  $$\n  T_{\\mathrm{Caroli}} = \\mathrm{Tr}\\left[\\Gamma_L G^r \\Gamma_R G^a\\right].\n  $$\n  Report the absolute difference $\\Delta_T = \\left|T_{\\mathrm{amp}} - T_{\\mathrm{Caroli}}\\right|$.\n\nTest suite:\nUse the following parameter sets, with a fixed pseudorandom seed $s = 13579$ for generating the disorder. All quantities are dimensionless. For each case, the disorder on-site energies are independently sampled uniformly from $[-W/2, W/2]$ using the same seed and then used as is for that case.\n\n- Case A (happy path): $N=8$, $t_{\\mathrm{dev}}=1.0$, $W=1.0$, $E=0.3$, $t_{\\mathrm{lead}}=1.0$, $t_{c,L}=1.0$, $t_{c,R}=1.0$, $\\eta=10^{-12}$.\n- Case B (near band edge): $N=8$, $t_{\\mathrm{dev}}=1.0$, $W=0.2$, $E=1.99$, $t_{\\mathrm{lead}}=1.0$, $t_{c,L}=1.0$, $t_{c,R}=0.8$, $\\eta=10^{-12}$.\n- Case C (outside the propagating band): $N=8$, $t_{\\mathrm{dev}}=1.0$, $W=1.5$, $E=2.5$, $t_{\\mathrm{lead}}=1.0$, $t_{c,L}=1.0$, $t_{c,R}=1.0$, $\\eta=10^{-12}$.\n- Case D (strong disorder): $N=12$, $t_{\\mathrm{dev}}=1.0$, $W=4.0$, $E=0.0$, $t_{\\mathrm{lead}}=1.0$, $t_{c,L}=1.0$, $t_{c,R}=1.0$, $\\eta=10^{-12}$.\n\nOutput specification:\n- For each case, compute $\\Delta_U$ and $\\Delta_T$ as defined above.\n- Your program should produce a single line of output containing the results as a comma-separated list of lists, with each inner list containing the two floats $[\\Delta_U, \\Delta_T]$, rounded to exactly eight decimal places. For example: \n[[0.00000001, 0.00000002], [...], ...].",
            "solution": "The user-provided problem is a well-posed and scientifically sound exercise in computational condensed matter physics, specifically regarding quantum transport in mesoscopic systems. It requests the numerical verification of fundamental principles of the Landauer-Büttiker formalism for a one-dimensional tight-binding model. The problem is valid as it is self-contained, objective, and grounded in established physical theory. All required parameters and verification metrics are clearly defined.\n\nThe solution proceeds in two main stages: first, the derivation of the necessary theoretical formulas from the fundamental principles stated in the problem, and second, the implementation of these formulas in a numerical algorithm to compute the required verification metrics for the specified test cases.\n\n**1. Theoretical Formulation**\n\nWe model a central device region connected to two semi-infinite, one-dimensional leads (left, $L$, and right, $R$).\n\n**1.1. Device Hamiltonian, $H$**\nThe device is described by an $N \\times N$ real symmetric tight-binding Hamiltonian matrix $H$. The on-site energies, $H_{n,n} = \\varepsilon_n$, include diagonal disorder, where each $\\varepsilon_n$ is drawn from a uniform distribution $U[-W/2, W/2]$. The nearest-neighbor hopping is $H_{n,n\\pm1} = t_{\\mathrm{dev}}$.\n\n**1.2. Lead Self-Energy, $\\Sigma_\\alpha^r(E)$**\nThe effect of coupling the device to semi-infinite leads is captured by the retarded self-energy matrices, $\\Sigma_L^r(E)$ and $\\Sigma_R^r(E)$. For a lead $\\alpha \\in \\{L, R\\}$ with nearest-neighbor hopping $t_{\\mathrm{lead}}$ and on-site energy $0$, coupled to a device site $p_\\alpha$ with coupling strength $t_{c,\\alpha}$, the self-energy is a rank-one matrix non-zero only at the coupling site.\n$$\n\\Sigma_{\\alpha}^r(E) = |t_{c,\\alpha}|^2 g_{\\mathrm{surf}}^r(E) |p_\\alpha\\rangle\\langle p_\\alpha|\n$$\nHere, $|p_L\\rangle$ is the first site ($0$) and $|p_R\\rangle$ is the last site ($N-1$). $g_{\\mathrm{surf}}^r(E)$ is the retarded surface Green's function of the semi-infinite lead. It can be derived by considering the recursive structure of the lead's Dyson equation. Let $z = E + i\\eta$, where $\\eta \\to 0^+$ enforces causality. The surface Green's function is found to be:\n$$\ng_{\\mathrm{surf}}^r(E) = \\frac{z - \\sqrt{z^2 - 4t_{\\mathrm{lead}}^2}}{2t_{\\mathrm{lead}}^2}\n$$\nThe branch of the square root is chosen such that the resulting Green's function corresponds to an outgoing wave, which means it must have a negative imaginary part for energies inside the lead's conducting band ($|E| < 2|t_{\\mathrm{lead}}|$). The principal branch of the complex square root, as implemented in numerical libraries, ensures this.\n\n**1.3. Open System Green's Function, $G^r(E)$**\nThe retarded Green's function of the device, when coupled to the leads, is given by the inversion of the effective Hamiltonian:\n$$\nG^r(E) = \\left[ (E + i\\eta)I - H - \\Sigma_L^r(E) - \\Sigma_R^r(E) \\right]^{-1}\n$$\nwhere $I$ is the $N \\times N$ identity matrix. The advanced Green's function is its adjoint: $G^a(E) = \\left(G^r(E)\\right)^\\dagger$.\n\n**1.4. Level-Width Matrix, $\\Gamma_\\alpha(E)$**\nThe level-width matrix, $\\Gamma_\\alpha(E)$, describes the rate at which electrons can escape from the device into lead $\\alpha$. It is related to the anti-Hermitian part of the self-energy:\n$$\n\\Gamma_\\alpha(E) = i\\left[\\Sigma_\\alpha^r(E) - \\Sigma_\\alpha^a(E)\\right] = i\\left[\\Sigma_\\alpha^r(E) - (\\Sigma_\\alpha^r(E))^\\dagger\\right]\n$$\nSubstituting the expression for $\\Sigma_\\alpha^r(E)$ and noting that $t_{c,\\alpha}$ is real:\n$$\n\\Gamma_\\alpha(E) = i |t_{c,\\alpha}|^2 \\left[g_{\\mathrm{surf}}^r(E) - (g_{\\mathrm{surf}}^r(E))^*\\right] |p_\\alpha\\rangle\\langle p_\\alpha| = -2 |t_{c,\\alpha}|^2 \\mathrm{Im}[g_{\\mathrm{surf}}^r(E)] |p_\\alpha\\rangle\\langle p_\\alpha|\n$$\nSince $\\mathrm{Im}[g_{\\mathrm{surf}}^r(E)] \\le 0$ for a retarded Green's function, the diagonal elements of $\\Gamma_\\alpha(E)$ are non-negative.\n\n**1.5. Fisher–Lee Relation and the Scattering Matrix, $S(E)$**\nThe Fisher–Lee relation connects the scattering matrix $S(E)$ to the Green's function of the device. For a two-terminal device with single-mode leads, the $2 \\times 2$ S-matrix elements $S_{\\beta\\alpha}$ (for scattering from lead $\\alpha$ to $\\beta$) are given by:\n$$\nS_{\\beta\\alpha}(E) = -\\delta_{\\beta\\alpha} + i \\sqrt{\\Gamma_{\\beta, p_\\beta p_\\beta}} G^r_{p_\\beta, p_\\alpha}(E) \\sqrt{\\Gamma_{\\alpha, p_\\alpha p_\\alpha}}\n$$\nHere, $\\Gamma_{\\alpha, p_\\alpha p_\\alpha}$ is the single non-zero diagonal element of the $\\Gamma_\\alpha$ matrix, and $G^r_{p_\\beta, p_\\alpha}$ is the element of the full device Green's function connecting the two coupling sites. The counter-intuitive sign of the Kronecker delta, $-\\delta_{\\beta\\alpha}$, arises from a specific phase convention for the asymptotic scattering states and is necessary to ensure unitarity, as proven by algebraic substitution of this relation into the unitarity condition $S^\\dagger S = I$ and using the identity $G^r - G^a = i G^r (\\Gamma_L + \\Gamma_R) G^a$.\n\nThe S-matrix elements are then:\n$r_{LL} \\equiv S_{LL} = -1 + i \\Gamma_{L,00} G^r_{0,0}$\n$t_{LR} \\equiv S_{LR} = i \\sqrt{\\Gamma_{L,00} \\Gamma_{R,N-1,N-1}} G^r_{0,N-1}$\n$t_{RL} \\equiv S_{RL} = i \\sqrt{\\Gamma_{R,N-1,N-1} \\Gamma_{L,00}} G^r_{N-1,0}$\n$r_{RR} \\equiv S_{RR} = -1 + i \\Gamma_{R,N-1,N-1} G^r_{N-1,N-1}$\n\n**2. Verification Metrics**\n\n**2.1. Unitarity Check, $\\Delta_U$**\nFor elastic scattering, the S-matrix must be unitary, i.e., $S^\\dagger S = I$. We verify this numerically by computing the Frobenius norm of the deviation from the identity matrix:\n$$\n\\Delta_U = \\left\\| S^\\dagger S - I_2 \\right\\|_F = \\sqrt{\\sum_{i,j=1}^{2} |(S^\\dagger S - I_2)_{ij}|^2}\n$$\n\n**2.2. Transmission Consistency, $\\Delta_T$**\nThe transmission probability from lead $L$ to $R$ can be computed in two ways. First, from the transmission amplitude:\n$$\nT_{\\mathrm{amp}} = |t_{RL}|^2\n$$\nSecond, using the Caroli formula, which is a direct consequence of the NEGF formalism:\n$$\nT_{\\mathrm{Caroli}} = \\mathrm{Tr}\\left[\\Gamma_L G^r \\Gamma_R G^a\\right]\n$$\nFor our specific setup, this trace reduces to $\\Gamma_{L,00} \\Gamma_{R,N-1,N-1} |G^r_{0,N-1}|^2$. A quick check shows that $T_{\\mathrm{amp}}$ is $|i \\sqrt{\\Gamma_{R} \\Gamma_{L}} G^r_{N-1,0}|^2 = \\Gamma_R \\Gamma_L |G^r_{N-1,0}|^2$. Since $H$ is real symmetric, $G^r$ is symmetric ($G^r_{N-1,0} = G^r_{0,N-1}$), confirming the identity. We compute the absolute difference:\n$$\n\\Delta_T = |T_{\\mathrm{amp}} - T_{\\mathrm{Caroli}}|\n$$\n\n**3. Numerical Implementation**\nThe algorithm proceeds as follows:\n1.  For each test case, set the pseudorandom number generator seed to the specified value.\n2.  Construct the $N \\times N$ device Hamiltonian matrix $H$ with disordered on-site energies.\n3.  Calculate the retarded surface Green's function $g_{\\mathrm{surf}}^r(E)$ for the leads.\n4.  Construct the $N \\times N$ self-energy matrices $\\Sigma_L^r(E)$ and $\\Sigma_R^r(E)$.\n5.  Compute the full device retarded Green's function $G^r(E)$ by matrix inversion.\n6.  Calculate the scalar level widths $\\Gamma_L$ and $\\Gamma_R$ from the self-energies.\n7.  Assemble the $2 \\times 2$ scattering matrix $S(E)$ using the Fisher-Lee relation.\n8.  Compute the unitarity deviation $\\Delta_U$ and the transmission consistency error $\\Delta_T$.\n9.  Store and format the results as required.\n\nThis procedure is carried out for each parameter set provided in the problem statement.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation for all test cases and print the results.\n    \"\"\"\n    # Test cases defined in the problem statement.\n    test_cases = [\n        # Case A (happy path)\n        {'N': 8, 't_dev': 1.0, 'W': 1.0, 'E': 0.3, 't_lead': 1.0, 't_c_L': 1.0, 't_c_R': 1.0, 'eta': 1e-12, 'seed': 13579},\n        # Case B (near band edge)\n        {'N': 8, 't_dev': 1.0, 'W': 0.2, 'E': 1.99, 't_lead': 1.0, 't_c_L': 1.0, 't_c_R': 0.8, 'eta': 1e-12, 'seed': 13579},\n        # Case C (outside the propagating band)\n        {'N': 8, 't_dev': 1.0, 'W': 1.5, 'E': 2.5, 't_lead': 1.0, 't_c_L': 1.0, 't_c_R': 1.0, 'eta': 1e-12, 'seed': 13579},\n        # Case D (strong disorder)\n        {'N': 12, 't_dev': 1.0, 'W': 4.0, 'E': 0.0, 't_lead': 1.0, 't_c_L': 1.0, 't_c_R': 1.0, 'eta': 1e-12, 'seed': 13579},\n    ]\n\n    results = []\n    for params in test_cases:\n        result = _calculate_transport_metrics(**params)\n        results.append(result)\n\n    # Format the output as specified: \"[[val, val], [val, val], ...]\" with 8 decimal places.\n    formatted_results = [f\"[{res[0]:.8f},{res[1]:.8f}]\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef _calculate_transport_metrics(N, t_dev, W, E, t_lead, t_c_L, t_c_R, eta, seed):\n    \"\"\"\n    Performs the transport calculation for a single set of parameters.\n    \"\"\"\n    # 1. Construct the device Hamiltonian H\n    np.random.seed(seed)\n    # On-site energies with disorder\n    onsite_energies = (np.random.rand(N) - 0.5) * W\n    H = np.diag(onsite_energies)\n    # Hopping terms\n    off_diag = np.full(N - 1, t_dev)\n    H += np.diag(off_diag, k=1) + np.diag(off_diag, k=-1)\n\n    # 2. Compute lead self-energy\n    z = E + 1j * eta\n    # Note: np.sqrt handles the complex branch cut correctly for the principal root.\n    # The formula is derived from the recursive solution for a semi-infinite chain.\n    # This choice of branch ensures Im(g_surf_r) <= 0, which is required for a retarded GF.\n    sqrt_term = np.sqrt(z**2 - 4 * t_lead**2)\n    g_surf_r = (z - sqrt_term) / (2 * t_lead**2)\n\n    # 3. Construct self-energy matrices\n    Sigma_L_r = np.zeros((N, N), dtype=complex)\n    Sigma_R_r = np.zeros((N, N), dtype=complex)\n    Sigma_L_r[0, 0] = t_c_L**2 * g_surf_r\n    Sigma_R_r[N - 1, N - 1] = t_c_R**2 * g_surf_r\n\n    # 4. Compute the retarded Green's function G_r\n    I = np.eye(N)\n    H_eff_inv = z * I - H - Sigma_L_r - Sigma_R_r\n    G_r = np.linalg.inv(H_eff_inv)\n\n    # 5. Compute level-width matrices Gamma_L and Gamma_R\n    Sigma_L_a = Sigma_L_r.conj().T\n    Gamma_L_matrix = 1j * (Sigma_L_r - Sigma_L_a)\n    \n    Sigma_R_a = Sigma_R_r.conj().T\n    Gamma_R_matrix = 1j * (Sigma_R_r - Sigma_R_a)\n    \n    # We only need the scalar values since Gamma is diagonal\n    gamma_L = Gamma_L_matrix[0, 0].real\n    gamma_R = Gamma_R_matrix[N - 1, N - 1].real\n\n    # 6. Compute S-matrix using the Fisher-Lee relation\n    G_r_00 = G_r[0, 0]\n    G_r_0N = G_r[0, N - 1]\n    G_r_N0 = G_r[N - 1, 0]\n    G_r_NN = G_r[N - 1, N - 1]\n    \n    # S_beta,alpha = -delta_beta,alpha + i * sqrt(gamma_beta) * G_r_beta,alpha * sqrt(gamma_alpha)\n    r_LL = -1 + 1j * gamma_L * G_r_00\n    t_LR = 1j * np.sqrt(gamma_L * gamma_R) * G_r_0N\n    t_RL = 1j * np.sqrt(gamma_R * gamma_L) * G_r_N0\n    r_RR = -1 + 1j * gamma_R * G_r_NN\n\n    S = np.array([[r_LL, t_LR], [t_RL, r_RR]])\n\n    # 7. Verify unitarity\n    S_dagger_S = S.conj().T @ S\n    I2 = np.eye(2)\n    delta_U = np.linalg.norm(S_dagger_S - I2, 'fro')\n\n    # 8. Verify transmission\n    # T from scattering amplitude\n    T_amp = np.abs(t_RL)**2\n    \n    # T from Caroli formula: Tr[Gamma_L * G_r * Gamma_R * G_a]\n    G_a = G_r.conj().T\n    T_caroli = np.trace(Gamma_L_matrix @ G_r @ Gamma_R_matrix @ G_a).real\n    \n    delta_T = np.abs(T_amp - T_caroli)\n\n    return delta_U, delta_T\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}