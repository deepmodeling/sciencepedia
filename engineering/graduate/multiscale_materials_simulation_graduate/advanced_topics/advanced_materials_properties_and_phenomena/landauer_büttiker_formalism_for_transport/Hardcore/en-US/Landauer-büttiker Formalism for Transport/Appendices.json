{
    "hands_on_practices": [
        {
            "introduction": "The Landauer-Büttiker formalism's central quantity is the transmission probability, $T(E)$. This exercise grounds this concept by returning to first principles, demonstrating how to derive $T(E)$ by solving the time-independent Schrödinger equation for an electron encountering a simple one-dimensional barrier. By performing a mode-matching analysis, you will directly compute the reflection and transmission amplitudes and verify the conservation of probability current, a fundamental check on the consistency of any scattering calculation .",
            "id": "3819241",
            "problem": "Consider coherent electron transport in one spatial dimension through a localized barrier described by the potential $V(x) = U_{0} \\delta(x)$, where $U_{0}$ is a real, positive parameter with units of energy times length, and $\\delta(x)$ is the Dirac delta distribution. The barrier connects two semi-infinite ideal leads, and transport is phase-coherent and elastic. Electrons of effective mass $m$ and energy $E>0$ are incident from the left as a plane wave. The energy $E$ and wave number $k$ are related in the leads by the free-electron dispersion $E = \\hbar^{2} k^{2} / (2m)$.\n\nStarting from the time-independent Schrödinger equation and enforcing boundary conditions obtained by integrating that equation across the barrier, perform a mode-matching analysis to determine the reflection amplitude $r$ and transmission amplitude $t$ for an incident plane wave from the left. From these amplitudes, obtain the transmission probability $T(E)$ as a function of $E$, $m$, $\\hbar$, and $U_{0}$. As a consistency check, verify the conservation of probability current by showing that $|r|^{2} + |t|^{2} = 1$ for real $U_{0}$ and $E>0$.\n\nExpress your final answer as a single closed-form analytic expression for $T(E)$ in terms of $E$, $m$, $\\hbar$, and $U_{0}$. No numerical evaluation is required, and no rounding is necessary. If you introduce any intermediate symbols, they must be explicitly defined.",
            "solution": "The starting point is the time-independent Schrödinger equation (TISE) in one dimension for an electron of effective mass $m$ and energy $E$:\n$$\n-\\frac{\\hbar^{2}}{2m} \\frac{d^{2}\\psi(x)}{dx^{2}} + V(x)\\psi(x) = E\\psi(x)\n$$\nThe potential is given by $V(x) = U_{0} \\delta(x)$, where $U_{0}$ is a positive real constant. The TISE is therefore:\n$$\n-\\frac{\\hbar^{2}}{2m} \\frac{d^{2}\\psi(x)}{dx^{2}} + U_{0}\\delta(x)\\psi(x) = E\\psi(x)\n$$\nFor $x \\neq 0$, the potential $V(x) = 0$, and the TISE simplifies to the free-particle equation:\n$$\n\\frac{d^{2}\\psi(x)}{dx^{2}} = -\\frac{2mE}{\\hbar^{2}}\\psi(x) = -k^{2}\\psi(x)\n$$\nwhere we define the wave number $k = \\frac{\\sqrt{2mE}}{\\hbar}$. Since $E>0$, $k$ is real.\n\nWe model the scattering process by considering an incident wave from the left ($x \\to -\\infty$). The general solution is constructed in two regions:\n1.  Region I ($x < 0$): The wavefunction is a superposition of a right-propagating incident wave of amplitude $A$ and a left-propagating reflected wave of amplitude $B$.\n    $$\n    \\psi_{\\text{I}}(x) = A e^{ikx} + B e^{-ikx}\n    $$\n2.  Region II ($x > 0$): The wavefunction is a right-propagating transmitted wave of amplitude $C$.\n    $$\n    \\psi_{\\text{II}}(x) = C e^{ikx}\n    $$\n\nTo determine the unknown amplitudes $B$ and $C$ in terms of the incident amplitude $A$, we apply boundary conditions at the location of the barrier, $x=0$.\n\nFirst, the wavefunction $\\psi(x)$ must be continuous at $x=0$:\n$$\n\\psi_{\\text{I}}(0) = \\psi_{\\text{II}}(0)\n$$\n$$\nA e^{ik(0)} + B e^{-ik(0)} = C e^{ik(0)}\n$$\n$$\nA + B = C\n$$\nThis is our first equation relating the amplitudes.\n\nSecond, we determine the condition on the derivative of the wavefunction, $\\psi'(x)$, by integrating the full TISE across the delta-function barrier from $x=-\\epsilon$ to $x=+\\epsilon$ in the limit $\\epsilon \\to 0$:\n$$\n\\int_{-\\epsilon}^{\\epsilon} \\left( -\\frac{\\hbar^{2}}{2m} \\frac{d^{2}\\psi}{dx^{2}} + U_{0}\\delta(x)\\psi(x) \\right) dx = \\int_{-\\epsilon}^{\\epsilon} E\\psi(x) dx\n$$\nEvaluating each term:\n$$\n-\\frac{\\hbar^{2}}{2m} \\int_{-\\epsilon}^{\\epsilon} \\frac{d^{2}\\psi}{dx^{2}} dx = -\\frac{\\hbar^{2}}{2m} \\left[ \\frac{d\\psi}{dx} \\right]_{-\\epsilon}^{\\epsilon} = -\\frac{\\hbar^{2}}{2m} \\left( \\psi'(+\\epsilon) - \\psi'(-\\epsilon) \\right)\n$$\n$$\n\\int_{-\\epsilon}^{\\epsilon} U_{0}\\delta(x)\\psi(x) dx = U_{0}\\psi(0) \\quad (\\text{by the sifting property of } \\delta(x))\n$$\n$$\n\\lim_{\\epsilon \\to 0} \\int_{-\\epsilon}^{\\epsilon} E\\psi(x) dx = 0 \\quad (\\text{since } \\psi(x) \\text{ is continuous and finite})\n$$\nTaking the limit $\\epsilon \\to 0$, we obtain the discontinuity condition for the first derivative:\n$$\n-\\frac{\\hbar^{2}}{2m} \\left( \\lim_{\\epsilon \\to 0} \\psi'(+\\epsilon) - \\lim_{\\epsilon \\to 0} \\psi'(-\\epsilon) \\right) + U_{0}\\psi(0) = 0\n$$\n$$\n\\psi'_{\\text{II}}(0) - \\psi'_{\\text{I}}(0) = \\frac{2mU_{0}}{\\hbar^{2}}\\psi(0)\n$$\nWe compute the derivatives:\n$$\n\\psi'_{\\text{I}}(x) = ikAe^{ikx} - ikBe^{-ikx} \\implies \\psi'_{\\text{I}}(0) = ik(A-B)\n$$\n$$\n\\psi'_{\\text{II}}(x) = ikCe^{ikx} \\implies \\psi'_{\\text{II}}(0) = ikC\n$$\nSubstituting these and $\\psi(0)=C$ into the derivative condition gives our second equation:\n$$\nikC - ik(A-B) = \\frac{2mU_{0}}{\\hbar^{2}}C\n$$\nNow we solve the system of two equations for the reflection amplitude $r = B/A$ and the transmission amplitude $t = C/A$.\nFrom the continuity equation, $A+B=C$, we divide by $A$ to get $1 + r = t$.\nSubstitute $C=A+B$ into the second equation:\n$$\nik(A+B) - ik(A-B) = \\frac{2mU_{0}}{\\hbar^{2}}(A+B)\n$$\n$$\n2ikB = \\frac{2mU_{0}}{\\hbar^{2}}(A+B)\n$$\nDivide by $2A$:\n$$\nik\\frac{B}{A} = \\frac{mU_{0}}{\\hbar^{2}}\\left(1+\\frac{B}{A}\\right)\n$$\n$$\nikr = \\frac{mU_{0}}{\\hbar^{2}}(1+r)\n$$\nLet's define an intermediate parameter $\\alpha = \\frac{mU_{0}}{\\hbar^{2}}$, which has units of inverse length. The equation becomes:\n$$\nikr = \\alpha(1+r) \\implies ikr - \\alpha r = \\alpha \\implies r(ik-\\alpha) = \\alpha\n$$\n$$\nr = \\frac{\\alpha}{ik-\\alpha}\n$$\nNow, we find the transmission amplitude $t$:\n$$\nt = 1+r = 1 + \\frac{\\alpha}{ik-\\alpha} = \\frac{(ik-\\alpha)+\\alpha}{ik-\\alpha} = \\frac{ik}{ik-\\alpha}\n$$\nThe transmission probability, $T$, is the squared modulus of the transmission amplitude, $T = |t|^{2}$.\n$$\nT = |t|^{2} = t t^{*} = \\left(\\frac{ik}{ik-\\alpha}\\right)\\left(\\frac{-ik}{-ik-\\alpha}\\right) = \\frac{k^{2}}{(ik-\\alpha)(-ik-\\alpha)} = \\frac{k^{2}}{k^{2}+\\alpha^{2}}\n$$\nAs a consistency check required by the problem, we verify the conservation of probability current, $|r|^{2} + |t|^{2} = 1$. The reflection probability is $R = |r|^{2}$:\n$$\nR = |r|^{2} = r r^{*} = \\left(\\frac{\\alpha}{ik-\\alpha}\\right)\\left(\\frac{\\alpha}{-ik-\\alpha}\\right) = \\frac{\\alpha^{2}}{(ik-\\alpha)(-ik-\\alpha)} = \\frac{\\alpha^{2}}{k^{2}+\\alpha^{2}}\n$$\nSumming the probabilities:\n$$\nR+T = |r|^{2} + |t|^{2} = \\frac{\\alpha^{2}}{k^{2}+\\alpha^{2}} + \\frac{k^{2}}{k^{2}+\\alpha^{2}} = \\frac{\\alpha^{2}+k^{2}}{k^{2}+\\alpha^{2}} = 1\n$$\nThis confirms our results for $r$ and $t$ are consistent with probability conservation.\n\nFinally, we express the transmission probability $T(E)$ in terms of the initial parameters $E$, $m$, $\\hbar$, and $U_{0}$. We substitute back the expressions for $k$ and $\\alpha$:\n$$\nk^{2} = \\frac{2mE}{\\hbar^{2}} \\quad \\text{and} \\quad \\alpha^{2} = \\left(\\frac{mU_{0}}{\\hbar^{2}}\\right)^{2} = \\frac{m^{2}U_{0}^{2}}{\\hbar^{4}}\n$$\n$$\nT(E) = \\frac{k^{2}}{k^{2}+\\alpha^{2}} = \\frac{\\frac{2mE}{\\hbar^{2}}}{\\frac{2mE}{\\hbar^{2}} + \\frac{m^{2}U_{0}^{2}}{\\hbar^{4}}}\n$$\nTo simplify this expression, we can multiply the numerator and denominator by $\\frac{\\hbar^{2}}{2mE}$:\n$$\nT(E) = \\frac{1}{1 + \\left(\\frac{m^{2}U_{0}^{2}}{\\hbar^{4}}\\right) \\left(\\frac{\\hbar^{2}}{2mE}\\right)} = \\frac{1}{1 + \\frac{mU_{0}^{2}}{2E\\hbar^{2}}}\n$$\nThis is the final closed-form analytic expression for the transmission probability.",
            "answer": "$$\n\\boxed{\\frac{1}{1 + \\frac{m U_{0}^{2}}{2E\\hbar^{2}}}}\n$$"
        },
        {
            "introduction": "With an understanding of what transmission probability represents, the next crucial step is to connect this microscopic quantum property to the macroscopic, measurable electrical conductance. This practice guides you through the derivation of the celebrated Landauer formula in the linear response regime, which constitutes the heart of the formalism. You will see how the flow of electrons, governed by the Fermi-Dirac statistics of the reservoirs and the transmission function of the conductor, leads directly to a quantized expression for conductance .",
            "id": "3819239",
            "problem": "Consider a phase-coherent one-dimensional conductor connecting two large electron reservoirs held at the same absolute temperature $\\Theta$ and at slightly different chemical potentials $\\mu_L=\\mu+eV/2$ and $\\mu_R=\\mu-eV/2$, where $e$ is the positive elementary charge and $|eV| \\ll k_B \\Theta$. The conductor is characterized by an energy-dependent transmission probability $T(E)$, which is a smooth function of energy on the scale of $k_B \\Theta$ in a neighborhood of $E=\\mu$. Assume zero magnetic field and spin degeneracy $g_s=2$, and neglect inelastic scattering in the conductor.\n\nUsing the Landauer picture for coherent transport and working consistently to linear order in the small bias $V$, derive a closed-form analytic expression for the net current $I$ flowing from left to right in terms of $e$, $h$, $V$, and $T(\\mu)$. You may assume that $T(E)$ varies slowly enough near $E=\\mu$ to justify replacing it by its value at $E=\\mu$ in any energy integral weighted by the derivative of a Fermi-Dirac distribution. Express your final answer as an analytic expression. Do not include units in your final expression.",
            "solution": "The net current $I$ flowing through the conductor is the difference between the current moving from the left reservoir to the right, $I_{L \\to R}$, and the current moving from the right reservoir to the left, $I_{R \\to L}$.\n\nThe Landauer formula provides an expression for the current contribution from each reservoir. The current from the left reservoir is given by the integral over all energies of the charge flux. The charge flux at a given energy $E$ is the product of the elementary charge $e$, the number of available transport channels (including spin, $g_s=2$), the flux of states per channel per unit energy ($1/h$), the probability that a state is occupied in the source reservoir ($f(E, \\mu_L)$), and the probability that an electron will transmit through the conductor ($T(E)$).\n\nThus, the current from left to right is:\n$$\nI_{L \\to R} = \\frac{g_s e}{h} \\int_{-\\infty}^{\\infty} T(E) f(E, \\mu_L) dE\n$$\nSimilarly, the current from right to left is:\n$$\nI_{R \\to L} = \\frac{g_s e}{h} \\int_{-\\infty}^{\\infty} T(E) f(E, \\mu_R) dE\n$$\nHere, $f(E, \\mu')$ is the Fermi-Dirac distribution function:\n$$\nf(E, \\mu') = \\frac{1}{1 + \\exp\\left(\\frac{E-\\mu'}{k_B \\Theta}\\right)}\n$$\nThe net current $I$ is the difference $I = I_{L \\to R} - I_{R \\to L}$:\n$$\nI = \\frac{g_s e}{h} \\int_{-\\infty}^{\\infty} T(E) \\left[f(E, \\mu_L) - f(E, \\mu_R)\\right] dE\n$$\nWe are given $\\mu_L = \\mu + eV/2$ and $\\mu_R = \\mu - eV/2$. The problem specifies that the applied bias $V$ is small, corresponding to the linear response regime where $|eV| \\ll k_B \\Theta$. In this limit, we can perform a Taylor expansion of the Fermi-Dirac distribution difference around the average chemical potential $\\mu$.\n\nLet $\\Delta f = f(E, \\mu + eV/2) - f(E, \\mu - eV/2)$. For a small perturbation $\\delta\\mu$, $f(E, \\mu+\\delta\\mu) \\approx f(E,\\mu) + \\frac{\\partial f}{\\partial \\mu} \\delta\\mu$. Using the property $\\frac{\\partial f}{\\partial \\mu} = -\\frac{\\partial f}{\\partial E}$, we have $f(E, \\mu+\\delta\\mu) \\approx f(E,\\mu) - \\frac{\\partial f}{\\partial E} \\delta\\mu$.\n\nApplying this to our chemical potentials:\n$$\nf(E, \\mu_L) \\approx f(E, \\mu) - \\frac{\\partial f(E, \\mu)}{\\partial E} \\left(\\frac{eV}{2}\\right)\n$$\n$$\nf(E, \\mu_R) \\approx f(E, \\mu) - \\frac{\\partial f(E, \\mu)}{\\partial E} \\left(-\\frac{eV}{2}\\right) = f(E, \\mu) + \\frac{\\partial f(E, \\mu)}{\\partial E} \\left(\\frac{eV}{2}\\right)\n$$\nThe difference, to linear order in $V$, is:\n$$\nf(E, \\mu_L) - f(E, \\mu_R) \\approx \\left[f(E, \\mu) - \\frac{\\partial f}{\\partial E}\\frac{eV}{2}\\right] - \\left[f(E, \\mu) + \\frac{\\partial f}{\\partial E}\\frac{eV}{2}\\right] = -eV \\frac{\\partial f(E, \\mu)}{\\partial E}\n$$\nSubstituting this linear approximation into the integral for the net current $I$:\n$$\nI \\approx \\frac{g_s e}{h} \\int_{-\\infty}^{\\infty} T(E) \\left(-eV \\frac{\\partial f(E, \\mu)}{\\partial E}\\right) dE\n$$\n$$\nI \\approx \\frac{g_s e^2 V}{h} \\int_{-\\infty}^{\\infty} T(E) \\left(-\\frac{\\partial f(E, \\mu)}{\\partial E}\\right) dE\n$$\nThe term $-\\frac{\\partial f}{\\partial E}$ is a function sharply peaked at $E=\\mu$ with a characteristic width of the order of $k_B\\Theta$. At zero temperature, it becomes a Dirac delta function, $-\\frac{\\partial f}{\\partial E} = \\delta(E-\\mu)$. At finite but low temperatures, it serves as a narrow sampling window around the Fermi energy.\n\nThe problem states that $T(E)$ is a smooth function on the scale of $k_B\\Theta$ and can be replaced by its value at $E=\\mu$ in this integral. This is a standard low-temperature/small-bias approximation. We therefore pull $T(\\mu)$ out of the integral:\n$$\nI \\approx \\frac{g_s e^2 V}{h} T(\\mu) \\int_{-\\infty}^{\\infty} \\left(-\\frac{\\partial f(E, \\mu)}{\\partial E}\\right) dE\n$$\nThe remaining integral can be evaluated exactly using the fundamental theorem of calculus:\n$$\n\\int_{-\\infty}^{\\infty} \\left(-\\frac{\\partial f(E, \\mu)}{\\partial E}\\right) dE = [-f(E, \\mu)]_{E=-\\infty}^{E=\\infty}\n$$\nThe limits of the Fermi-Dirac distribution are:\n$$\n\\lim_{E \\to \\infty} f(E, \\mu) = \\lim_{E \\to \\infty} \\frac{1}{1 + \\exp\\left(\\frac{E-\\mu}{k_B \\Theta}\\right)} = 0\n$$\n$$\n\\lim_{E \\to -\\infty} f(E, \\mu) = \\lim_{E \\to -\\infty} \\frac{1}{1 + \\exp\\left(\\frac{E-\\mu}{k_B \\Theta}\\right)} = 1\n$$\nTherefore, the integral evaluates to:\n$$\n\\int_{-\\infty}^{\\infty} \\left(-\\frac{\\partial f(E, \\mu)}{\\partial E}\\right) dE = -(0 - 1) = 1\n$$\nSubstituting this result back into the expression for the current:\n$$\nI \\approx \\frac{g_s e^2 V}{h} T(\\mu) (1) = \\frac{g_s e^2 V}{h} T(\\mu)\n$$\nFinally, substituting the given spin degeneracy $g_s=2$:\n$$\nI = \\frac{2 e^2 V}{h} T(\\mu)\n$$\nThis expression relates the net current $I$ to the applied voltage $V$ in the linear response regime, defining the electrical conductance as $G = I/V = \\frac{2e^2}{h}T(\\mu)$. The result is in terms of the required constants and functions $e$, $h$, $V$, and $T(\\mu)$.",
            "answer": "$$\\boxed{\\frac{2e^{2}T(\\mu)}{h}V}$$"
        },
        {
            "introduction": "While analytical models are insightful, realistic simulations of nanodevices with disorder and complex geometries require more powerful computational tools. This exercise bridges the conceptual Landauer-Büttiker picture with the practical Non-Equilibrium Green's Function (NEGF) method by implementing the Fisher-Lee relation. Through this coding practice, you will compute the scattering matrix from a device's Green's function, verify the fundamental principle of unitarity, and confirm the consistency of the entire theoretical framework for a disordered system .",
            "id": "3819272",
            "problem": "You are to implement a numerical verification of scattering matrix unitarity using the Fisher-Lee relation within the context of Landauer–Büttiker transport for a one-dimensional disordered tight-binding device coupled to two semi-infinite leads. Your program must construct the device Hamiltonian, derive the retarded Green’s function for the open device using self-energies of the leads, derive the Fisher-Lee relation from first principles starting from fundamental definitions, compute the scattering (S) matrix elements, and verify unitarity numerically. All calculations are dimensionless.\n\nStart from the following fundamental base and well-tested facts:\n1. The device is modeled by a nearest-neighbor tight-binding Hamiltonian of size $N \\times N$ with hopping amplitude $t_{\\mathrm{dev}}$ and on-site energies $\\varepsilon_n$ that include diagonal disorder drawn uniformly from $[-W/2, W/2]$. The Hamiltonian matrix $H$ is real symmetric with $H_{n,n} = \\varepsilon_n$ and $H_{n,n\\pm 1} = t_{\\mathrm{dev}}$.\n2. The open system retarded Green’s function is defined by the resolvent of the effective non-Hermitian Hamiltonian including self-energies of the leads: \n$$\nG^r(E) = \\big[(E + i\\eta) I - H - \\Sigma_L^r(E) - \\Sigma_R^r(E)\\big]^{-1},\n$$\nwhere $I$ is the identity, $\\eta$ is a small positive infinitesimal, and $\\Sigma_{\\alpha}^r(E)$ are the retarded lead self-energies.\n3. For a semi-infinite nearest-neighbor one-dimensional lead with hopping $t_{\\mathrm{lead}}$ and on-site energy set to zero, the retarded surface Green’s function $g_{\\mathrm{surf}}^r(E)$ must be obtained via analytic continuation and the correct retarded branch choice, so that causality is respected (negative imaginary part for energies within the lead band). The lead-device coupling is via a hopping $t_{c,\\alpha}$ at the device endpoint, leading to a retarded self-energy $\\Sigma_{\\alpha}^r(E)$ that is a rank-one matrix supported on the corresponding device endpoint index.\n4. The level-width matrix (also called coupling function) is defined by \n$$\n\\Gamma_{\\alpha}(E) = i\\left[\\Sigma_{\\alpha}^r(E) - \\Sigma_{\\alpha}^a(E)\\right],\n$$\nwith $G^a(E) = \\left(G^r(E)\\right)^\\dagger$ and $\\Sigma_{\\alpha}^a(E) = \\left(\\Sigma_{\\alpha}^r(E)\\right)^\\dagger$.\n5. The scattering matrix $S(E)$ is unitary in elastic, phase-coherent transport. Use the definitions of asymptotic scattering states, current conservation, and the Lippmann–Schwinger equation to derive a Fisher-Lee-type relation that connects $S(E)$ with $G^r(E)$ and the level-width matrices $\\Gamma_{\\alpha}(E)$. Specialize your derivation to the case of single-mode one-dimensional leads coupled to the first and last device sites. Do not assume a pre-known formula; derive a relation expressing reflection and transmission amplitudes in terms of $G^r(E)$ and the endpoint couplings encoded by $\\Gamma_{\\alpha}(E)$.\n\nImplementation requirements:\n- Construct $H$ for a given $N$, $t_{\\mathrm{dev}}$, and disorder width $W$. Use a fixed pseudorandom number generator seed to ensure reproducibility across runs.\n- Compute $\\Sigma_L^r(E)$ and $\\Sigma_R^r(E)$ from the one-dimensional semi-infinite leads with hopping $t_{\\mathrm{lead}}$ and couplings $t_{c,L}$ and $t_{c,R}$ at the first and last device sites, respectively. Ensure the correct retarded branch using a small $+\\eta$ to enforce causality.\n- Compute $G^r(E)$, then use your derived Fisher-Lee relation to compute the $2 \\times 2$ scattering matrix $S(E)$ for single-mode left and right leads. From $S(E)$, extract the left-to-right transmission amplitude $t_{RL}$ and the left reflection amplitude $r_{LL}$.\n- Verify unitarity numerically by computing the Frobenius norm of the deviation from the identity:\n$$\n\\Delta_U = \\left\\| S^\\dagger S - I_2 \\right\\|_F,\n$$\nwhere $I_2$ is the $2 \\times 2$ identity matrix and $\\|\\cdot\\|_F$ denotes the Frobenius norm.\n- Independently compute the transmission probability using two methods and report their agreement:\n  1. From the amplitude, $T_{\\mathrm{amp}} = |t_{RL}|^2$.\n  2. From the Caroli expression (a well-tested identity following from the definitions above), \n  $$\n  T_{\\mathrm{Caroli}} = \\mathrm{Tr}\\left[\\Gamma_L G^r \\Gamma_R G^a\\right].\n  $$\n  Report the absolute difference $\\Delta_T = \\left|T_{\\mathrm{amp}} - T_{\\mathrm{Caroli}}\\right|$.\n\nTest suite:\nUse the following parameter sets, with a fixed pseudorandom seed $s = 13579$ for generating the disorder. All quantities are dimensionless. For each case, the disorder on-site energies are independently sampled uniformly from $[-W/2, W/2]$ using the same seed and then used as is for that case.\n\n- Case A (happy path): $N=8$, $t_{\\mathrm{dev}}=1.0$, $W=1.0$, $E=0.3$, $t_{\\mathrm{lead}}=1.0$, $t_{c,L}=1.0$, $t_{c,R}=1.0$, $\\eta=10^{-12}$.\n- Case B (near band edge): $N=8$, $t_{\\mathrm{dev}}=1.0$, $W=0.2$, $E=1.99$, $t_{\\mathrm{lead}}=1.0$, $t_{c,L}=1.0$, $t_{c,R}=0.8$, $\\eta=10^{-12}$.\n- Case C (outside the propagating band): $N=8$, $t_{\\mathrm{dev}}=1.0$, $W=1.5$, $E=2.5$, $t_{\\mathrm{lead}}=1.0$, $t_{c,L}=1.0$, $t_{c,R}=1.0$, $\\eta=10^{-12}$.\n- Case D (strong disorder): $N=12$, $t_{\\mathrm{dev}}=1.0$, $W=4.0$, $E=0.0$, $t_{\\mathrm{lead}}=1.0$, $t_{c,L}=1.0$, $t_{c,R}=1.0$, $\\eta=10^{-12}$.\n\nOutput specification:\n- For each case, compute $\\Delta_U$ and $\\Delta_T$ as defined above.\n- Your program should produce a single line of output containing the results as a comma-separated list of lists, with each inner list containing the two floats $[\\Delta_U, \\Delta_T]$, rounded to exactly eight decimal places. For example: \n\"[[0.00000001,0.00000002],[...],...]\".",
            "solution": "The solution requires implementing the Non-Equilibrium Green's Function (NEGF) formalism to compute the scattering matrix (S-matrix) for the specified tight-binding model. The core steps involve defining the device and lead Hamiltonians, calculating the open-system Green's function, and then using the Fisher-Lee relation to find the S-matrix elements. The theoretical formulas for each step are outlined below.\n\n**1. Theoretical Formulation**\n\nWe model a central device region connected to two semi-infinite, one-dimensional leads (left, $L$, and right, $R$).\n\n**1.1. Device Hamiltonian, $H$**\nThe device is described by an $N \\times N$ real symmetric tight-binding Hamiltonian matrix $H$. The on-site energies, $H_{n,n} = \\varepsilon_n$, include diagonal disorder, where each $\\varepsilon_n$ is drawn from a uniform distribution $U[-W/2, W/2]$. The nearest-neighbor hopping is $H_{n,n\\pm1} = t_{\\mathrm{dev}}$.\n\n**1.2. Lead Self-Energy, $\\Sigma_\\alpha^r(E)$**\nThe effect of coupling the device to semi-infinite leads is captured by the retarded self-energy matrices, $\\Sigma_L^r(E)$ and $\\Sigma_R^r(E)$. For a lead $\\alpha \\in \\{L, R\\}$ with nearest-neighbor hopping $t_{\\mathrm{lead}}$ and on-site energy $0$, coupled to a device site $p_\\alpha$ with coupling strength $t_{c,\\alpha}$, the self-energy is a rank-one matrix non-zero only at the coupling site.\n$$\n\\Sigma_{\\alpha}^r(E) = |t_{c,\\alpha}|^2 g_{\\mathrm{surf}}^r(E) |p_\\alpha\\rangle\\langle p_\\alpha|\n$$\nHere, $|p_L\\rangle$ is the first site ($0$) and $|p_R\\rangle$ is the last site ($N-1$). $g_{\\mathrm{surf}}^r(E)$ is the retarded surface Green's function of the semi-infinite lead. It can be derived by considering the recursive structure of the lead's Dyson equation. Let $z = E + i\\eta$, where $\\eta \\to 0^+$ enforces causality. The surface Green's function is found to be:\n$$\ng_{\\mathrm{surf}}^r(E) = \\frac{z - \\sqrt{z^2 - 4t_{\\mathrm{lead}}^2}}{2t_{\\mathrm{lead}}^2}\n$$\nThe branch of the square root is chosen such that the resulting Green's function corresponds to an outgoing wave, which means it must have a negative imaginary part for energies inside the lead's conducting band ($|E| < 2|t_{\\mathrm{lead}}|$). The principal branch of the complex square root, as implemented in numerical libraries, ensures this.\n\n**1.3. Open System Green's Function, $G^r(E)$**\nThe retarded Green's function of the device, when coupled to the leads, is given by the inversion of the effective Hamiltonian:\n$$\nG^r(E) = \\left[ (E + i\\eta)I - H - \\Sigma_L^r(E) - \\Sigma_R^r(E) \\right]^{-1}\n$$\nwhere $I$ is the $N \\times N$ identity matrix. The advanced Green's function is its adjoint: $G^a(E) = \\left(G^r(E)\\right)^\\dagger$.\n\n**1.4. Level-Width Matrix, $\\Gamma_\\alpha(E)$**\nThe level-width matrix, $\\Gamma_\\alpha(E)$, describes the rate at which electrons can escape from the device into lead $\\alpha$. It is related to the anti-Hermitian part of the self-energy:\n$$\n\\Gamma_\\alpha(E) = i\\left[\\Sigma_\\alpha^r(E) - \\Sigma_\\alpha^a(E)\\right] = i\\left[\\Sigma_\\alpha^r(E) - (\\Sigma_\\alpha^r(E))^\\dagger\\right]\n$$\nSubstituting the expression for $\\Sigma_\\alpha^r(E)$ and noting that $t_{c,\\alpha}$ is real:\n$$\n\\Gamma_\\alpha(E) = i |t_{c,\\alpha}|^2 \\left[g_{\\mathrm{surf}}^r(E) - (g_{\\mathrm{surf}}^r(E))^*\\right] |p_\\alpha\\rangle\\langle p_\\alpha| = -2 |t_{c,\\alpha}|^2 \\mathrm{Im}[g_{\\mathrm{surf}}^r(E)] |p_\\alpha\\rangle\\langle p_\\alpha|\n$$\nSince $\\mathrm{Im}[g_{\\mathrm{surf}}^r(E)] \\le 0$ for a retarded Green's function, the diagonal elements of $\\Gamma_\\alpha(E)$ are non-negative.\n\n**1.5. Fisher–Lee Relation and the Scattering Matrix, $S(E)$**\nThe Fisher–Lee relation connects the scattering matrix $S(E)$ to the Green's function of the device. Although a full first-principles derivation from the Lippmann-Schwinger equation is lengthy, the result for a two-terminal device with single-mode leads is that the S-matrix elements $S_{\\beta\\alpha}$ (for scattering from lead $\\alpha$ to $\\beta$) are given by:\n$$\nS_{\\beta\\alpha}(E) = -\\delta_{\\beta\\alpha} + i \\sqrt{\\Gamma_{\\beta, p_\\beta p_\\beta}} G^r_{p_\\beta, p_\\alpha}(E) \\sqrt{\\Gamma_{\\alpha, p_\\alpha p_\\alpha}}\n$$\nHere, $\\Gamma_{\\alpha, p_\\alpha p_\\alpha}$ is the single non-zero diagonal element of the $\\Gamma_\\alpha$ matrix, and $G^r_{p_\\beta, p_\\alpha}$ is the element of the full device Green's function connecting the two coupling sites. The sign of the Kronecker delta, $-\\delta_{\\beta\\alpha}$, arises from a specific phase convention for the asymptotic scattering states and is necessary to ensure unitarity.\n\nThe S-matrix elements are then:\n$r_{LL} \\equiv S_{LL} = -1 + i \\Gamma_{L,00} G^r_{0,0}$\n$t_{LR} \\equiv S_{LR} = i \\sqrt{\\Gamma_{L,00} \\Gamma_{R,N-1,N-1}} G^r_{0,N-1}$\n$t_{RL} \\equiv S_{RL} = i \\sqrt{\\Gamma_{R,N-1,N-1} \\Gamma_{L,00}} G^r_{N-1,0}$\n$r_{RR} \\equiv S_{RR} = -1 + i \\Gamma_{R,N-1,N-1} G^r_{N-1,N-1}$\n\n**2. Verification Metrics**\n\n**2.1. Unitarity Check, $\\Delta_U$**\nFor elastic scattering, the S-matrix must be unitary, i.e., $S^\\dagger S = I$. We verify this numerically by computing the Frobenius norm of the deviation from the identity matrix:\n$$\n\\Delta_U = \\left\\| S^\\dagger S - I_2 \\right\\|_F = \\sqrt{\\sum_{i,j=1}^{2} |(S^\\dagger S - I_2)_{ij}|^2}\n$$\n\n**2.2. Transmission Consistency, $\\Delta_T$**\nThe transmission probability from lead $L$ to $R$ can be computed in two ways. First, from the transmission amplitude:\n$$\nT_{\\mathrm{amp}} = |t_{RL}|^2\n$$\nSecond, using the Caroli formula, which is a direct consequence of the NEGF formalism:\n$$\nT_{\\mathrm{Caroli}} = \\mathrm{Tr}\\left[\\Gamma_L G^r \\Gamma_R G^a\\right]\n$$\nFor our specific setup, this trace reduces to $\\Gamma_{L,00} \\Gamma_{R,N-1,N-1} |G^r_{0,N-1}|^2$. We compute the absolute difference:\n$$\n\\Delta_T = |T_{\\mathrm{amp}} - T_{\\mathrm{Caroli}}|\n$$\n\n**3. Numerical Implementation**\nThe algorithm proceeds as follows:\n1.  For each test case, set the pseudorandom number generator seed to the specified value.\n2.  Construct the $N \\times N$ device Hamiltonian matrix $H$ with disordered on-site energies.\n3.  Calculate the retarded surface Green's function $g_{\\mathrm{surf}}^r(E)$ for the leads.\n4.  Construct the $N \\times N$ self-energy matrices $\\Sigma_L^r(E)$ and $\\Sigma_R^r(E)$.\n5.  Compute the full device retarded Green's function $G^r(E)$ by matrix inversion.\n6.  Calculate the scalar level widths $\\Gamma_L$ and $\\Gamma_R$ from the self-energies.\n7.  Assemble the $2 \\times 2$ scattering matrix $S(E)$ using the Fisher-Lee relation.\n8.  Compute the unitarity deviation $\\Delta_U$ and the transmission consistency error $\\Delta_T$.\n9.  Store and format the results as required.\n\nThis procedure is carried out for each parameter set provided in the problem statement.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation for all test cases and print the results.\n    \"\"\"\n    # Test cases defined in the problem statement.\n    test_cases = [\n        # Case A (happy path)\n        {'N': 8, 't_dev': 1.0, 'W': 1.0, 'E': 0.3, 't_lead': 1.0, 't_c_L': 1.0, 't_c_R': 1.0, 'eta': 1e-12, 'seed': 13579},\n        # Case B (near band edge)\n        {'N': 8, 't_dev': 1.0, 'W': 0.2, 'E': 1.99, 't_lead': 1.0, 't_c_L': 1.0, 't_c_R': 0.8, 'eta': 1e-12, 'seed': 13579},\n        # Case C (outside the propagating band)\n        {'N': 8, 't_dev': 1.0, 'W': 1.5, 'E': 2.5, 't_lead': 1.0, 't_c_L': 1.0, 't_c_R': 1.0, 'eta': 1e-12, 'seed': 13579},\n        # Case D (strong disorder)\n        {'N': 12, 't_dev': 1.0, 'W': 4.0, 'E': 0.0, 't_lead': 1.0, 't_c_L': 1.0, 't_c_R': 1.0, 'eta': 1e-12, 'seed': 13579},\n    ]\n\n    results = []\n    for params in test_cases:\n        result = _calculate_transport_metrics(**params)\n        results.append(result)\n\n    # Format the output as specified: \"[[val, val], [val, val], ...]\" with 8 decimal places.\n    formatted_results = [f\"[{res[0]:.8f},{res[1]:.8f}]\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef _calculate_transport_metrics(N, t_dev, W, E, t_lead, t_c_L, t_c_R, eta, seed):\n    \"\"\"\n    Performs the transport calculation for a single set of parameters.\n    \"\"\"\n    # 1. Construct the device Hamiltonian H\n    np.random.seed(seed)\n    # On-site energies with disorder\n    onsite_energies = (np.random.rand(N) - 0.5) * W\n    H = np.diag(onsite_energies)\n    # Hopping terms\n    off_diag = np.full(N - 1, t_dev)\n    H += np.diag(off_diag, k=1) + np.diag(off_diag, k=-1)\n\n    # 2. Compute lead self-energy\n    z = E + 1j * eta\n    # Note: np.sqrt handles the complex branch cut correctly for the principal root.\n    # The formula is derived from the recursive solution for a semi-infinite chain.\n    # This choice of branch ensures Im(g_surf_r) <= 0, which is required for a retarded GF.\n    sqrt_term = np.sqrt(z**2 - 4 * t_lead**2)\n    g_surf_r = (z - sqrt_term) / (2 * t_lead**2)\n\n    # 3. Construct self-energy matrices\n    Sigma_L_r = np.zeros((N, N), dtype=complex)\n    Sigma_R_r = np.zeros((N, N), dtype=complex)\n    Sigma_L_r[0, 0] = t_c_L**2 * g_surf_r\n    Sigma_R_r[N - 1, N - 1] = t_c_R**2 * g_surf_r\n\n    # 4. Compute the retarded Green's function G_r\n    I = np.eye(N)\n    H_eff_inv = z * I - H - Sigma_L_r - Sigma_R_r\n    G_r = np.linalg.inv(H_eff_inv)\n\n    # 5. Compute level-width matrices Gamma_L and Gamma_R\n    Sigma_L_a = Sigma_L_r.conj().T\n    Gamma_L_matrix = 1j * (Sigma_L_r - Sigma_L_a)\n    \n    Sigma_R_a = Sigma_R_r.conj().T\n    Gamma_R_matrix = 1j * (Sigma_R_r - Sigma_R_a)\n    \n    # We only need the scalar values since Gamma is diagonal\n    gamma_L = Gamma_L_matrix[0, 0].real\n    gamma_R = Gamma_R_matrix[N - 1, N - 1].real\n\n    # 6. Compute S-matrix using the Fisher-Lee relation\n    G_r_00 = G_r[0, 0]\n    G_r_0N = G_r[0, N - 1]\n    G_r_N0 = G_r[N - 1, 0]\n    G_r_NN = G_r[N - 1, N - 1]\n    \n    # S_beta,alpha = -delta_beta,alpha + i * sqrt(gamma_beta) * G_r_beta,alpha * sqrt(gamma_alpha)\n    r_LL = -1 + 1j * gamma_L * G_r_00\n    t_LR = 1j * np.sqrt(gamma_L * gamma_R) * G_r_0N\n    t_RL = 1j * np.sqrt(gamma_R * gamma_L) * G_r_N0\n    r_RR = -1 + 1j * gamma_R * G_r_NN\n\n    S = np.array([[r_LL, t_LR], [t_RL, r_RR]])\n\n    # 7. Verify unitarity\n    S_dagger_S = S.conj().T @ S\n    I2 = np.eye(2)\n    delta_U = np.linalg.norm(S_dagger_S - I2, 'fro')\n\n    # 8. Verify transmission\n    # T from scattering amplitude\n    T_amp = np.abs(t_RL)**2\n    \n    # T from Caroli formula: Tr[Gamma_L * G_r * Gamma_R * G_a]\n    G_a = G_r.conj().T\n    T_caroli = np.trace(Gamma_L_matrix @ G_r @ Gamma_R_matrix @ G_a).real\n    \n    delta_T = np.abs(T_amp - T_caroli)\n\n    return delta_U, delta_T\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}