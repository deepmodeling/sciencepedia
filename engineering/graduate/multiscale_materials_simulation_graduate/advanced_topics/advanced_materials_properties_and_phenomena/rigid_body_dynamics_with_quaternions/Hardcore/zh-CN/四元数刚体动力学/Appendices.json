{
    "hands_on_practices": [
        {
            "introduction": "要掌握使用四元数进行刚体动力学模拟，首先必须理解其核心代数运算——汉密尔顿积。这个练习将引导您从基本定义出发，推导两个四元数相乘的完整公式，并揭示其几何意义。通过这项实践，您将深刻理解四元数代数如何巧妙地捕捉三维旋转的非交换性，这是所有动力学更新和姿态合成的基础。",
            "id": "3838903",
            "problem": "在多尺度材料模拟中，中尺度刚性夹杂物（代表原子的粗粒化团簇）的取向通常通过将预先存在的取向与由微观尺度力矩引起的微小增量旋转进行复合来更新。三维旋转的一种常用表示是四元数形式，其中四元数写作 $q = q_{0} + q_{1}\\mathbf{i} + q_{2}\\mathbf{j} + q_{3}\\mathbf{k}$，或等价地进行标量-矢量分解为 $q = (q_{0}, \\mathbf{q})$，其中 $\\mathbf{q} = (q_{1}, q_{2}, q_{3}) \\in \\mathbb{R}^{3}$。四元数基底遵循哈密顿法则 $\\mathbf{i}^{2} = \\mathbf{j}^{2} = \\mathbf{k}^{2} = \\mathbf{i}\\mathbf{j}\\mathbf{k} = -1$，以及 $\\mathbf{i}\\mathbf{j} = \\mathbf{k}$，$\\mathbf{j}\\mathbf{k} = \\mathbf{i}$，$\\mathbf{k}\\mathbf{i} = \\mathbf{j}$，连同反对易关系 $\\mathbf{j}\\mathbf{i} = -\\mathbf{k}$，$\\mathbf{k}\\mathbf{j} = -\\mathbf{i}$，$\\mathbf{i}\\mathbf{k} = -\\mathbf{j}$。\n\n设 $p = (p_{0}, \\mathbf{p})$ 表示一个微小的增量旋转（可能源于微观尺度力矩），设 $q = (q_{0}, \\mathbf{q})$ 表示中尺度上刚体的当前取向。$p$ 和 $q$ 都是单位四元数，表示特殊正交群 $\\mathrm{SO}(3)$ 中的元素。更新后的取向是四元数积 $r = p \\otimes q$，其中 $\\otimes$ 表示哈密顿积。\n\n任务：仅从上述基本四元数乘法法则出发，推导 $r = p \\otimes q$ 的标量-矢量分解表达式，用 $p_{0}, p_{1}, p_{2}, p_{3}$ 和 $q_{0}, q_{1}, q_{2}, q_{3}$ 表示，并将分量 $(r_{0}, r_{1}, r_{2}, r_{3})$ 表示为单个行矩阵。然后，在刚体旋转复合的背景下对结果进行几何解释：说明标量部分和矢量部分编码了关于先进行 $q$ 旋转再进行 $p$ 旋转这一顺序作用的什么信息，并评论矢量部分的结构如何反映三维旋转的非对易性。\n\n你的最终答案必须是 $(r_{0}, r_{1}, r_{2}, r_{3})$ 作为单个行矩阵的派生解析表达式。不需要四舍五入，最终答案中不应包含物理单位。如果在你的解释中讨论到角度，应理解为以弧度为单位。",
            "solution": "问题陈述经评估有效。它在科学上基于四元数代数及其在刚体动力学中应用的既定原理。该问题提法恰当、客观、自成体系，并要求进行标准的推导和解释，这是对基本理解的有效检验。\n\n任务是推导四元数积 $r = p \\otimes q$ 的分量，并对结果提供几何解释。给定两个四元数 $p = (p_{0}, \\mathbf{p})$ 和 $q = (q_{0}, \\mathbf{q})$，我们可以将其完整的代数形式写为：\n$$p = p_{0} + p_{1}\\mathbf{i} + p_{2}\\mathbf{j} + p_{3}\\mathbf{k}$$\n$$q = q_{0} + q_{1}\\mathbf{i} + q_{2}\\mathbf{j} + q_{3}\\mathbf{k}$$\n积 $r = p \\otimes q$ 是通过应用乘法对加法的分配律计算得出的，仅从所提供的哈密顿法则开始：$\\mathbf{i}^{2} = \\mathbf{j}^{2} = \\mathbf{k}^{2} = \\mathbf{i}\\mathbf{j}\\mathbf{k} = -1$，以及基矢量 $\\mathbf{i}, \\mathbf{j}, \\mathbf{k}$ 的循环/反循环关系。\n\n设 $r = r_{0} + r_{1}\\mathbf{i} + r_{2}\\mathbf{j} + r_{3}\\mathbf{k}$。积 $p \\otimes q$ 为：\n$$r = (p_{0} + p_{1}\\mathbf{i} + p_{2}\\mathbf{j} + p_{3}\\mathbf{k}) \\otimes (q_{0} + q_{1}\\mathbf{i} + q_{2}\\mathbf{j} + q_{3}\\mathbf{k})$$\n我们逐项展开这个乘积：\n$$r = p_{0}(q_{0} + q_{1}\\mathbf{i} + q_{2}\\mathbf{j} + q_{3}\\mathbf{k}) + p_{1}\\mathbf{i}(q_{0} + q_{1}\\mathbf{i} + q_{2}\\mathbf{j} + q_{3}\\mathbf{k}) + p_{2}\\mathbf{j}(q_{0} + q_{1}\\mathbf{i} + q_{2}\\mathbf{j} + q_{3}\\mathbf{k}) + p_{3}\\mathbf{k}(q_{0} + q_{1}\\mathbf{i} + q_{2}\\mathbf{j} + q_{3}\\mathbf{k})$$\n分配每一项：\n$$r = (p_{0}q_{0} + p_{0}q_{1}\\mathbf{i} + p_{0}q_{2}\\mathbf{j} + p_{0}q_{3}\\mathbf{k})$$\n$$+ (p_{1}q_{0}\\mathbf{i} + p_{1}q_{1}\\mathbf{i}^{2} + p_{1}q_{2}\\mathbf{i}\\mathbf{j} + p_{1}q_{3}\\mathbf{i}\\mathbf{k})$$\n$$+ (p_{2}q_{0}\\mathbf{j} + p_{2}q_{1}\\mathbf{j}\\mathbf{i} + p_{2}q_{2}\\mathbf{j}^{2} + p_{2}q_{3}\\mathbf{j}\\mathbf{k})$$\n$$+ (p_{3}q_{0}\\mathbf{k} + p_{3}q_{1}\\mathbf{k}\\mathbf{i} + p_{3}q_{2}\\mathbf{k}\\mathbf{j} + p_{3}q_{3}\\mathbf{k}^{2})$$\n现在，我们应用哈密顿法则来简化基矢量的乘积：\n$$r = (p_{0}q_{0} + p_{0}q_{1}\\mathbf{i} + p_{0}q_{2}\\mathbf{j} + p_{0}q_{3}\\mathbf{k})$$\n$$+ (p_{1}q_{0}\\mathbf{i} - p_{1}q_{1} + p_{1}q_{2}\\mathbf{k} - p_{1}q_{3}\\mathbf{j})$$\n$$+ (p_{2}q_{0}\\mathbf{j} - p_{2}q_{1}\\mathbf{k} - p_{2}q_{2} + p_{2}q_{3}\\mathbf{i})$$\n$$+ (p_{3}q_{0}\\mathbf{k} + p_{3}q_{1}\\mathbf{j} - p_{3}q_{2}\\mathbf{i} - p_{3}q_{3})$$\n下一步是收集与标量部分（$1$）和矢量部分（$\\mathbf{i}, \\mathbf{j}, \\mathbf{k}$）相对应的项。\n\n标量分量 $r_{0}$ 是所有不含矢量基元素的项之和：\n$$r_{0} = p_{0}q_{0} - p_{1}q_{1} - p_{2}q_{2} - p_{3}q_{3}$$\n这可以使用标量-矢量分解表示法 $p = (p_{0}, \\mathbf{p})$ 和 $q = (q_{0}, \\mathbf{q})$ 紧凑地写出，其中 $\\mathbf{p} = (p_{1}, p_{2}, p_{3})$ 且 $\\mathbf{q} = (q_{1}, q_{2}, q_{3})$。$r_{0}$ 的表达式等价于：\n$$r_{0} = p_{0}q_{0} - \\mathbf{p} \\cdot \\mathbf{q}$$\n其中 $\\mathbf{p} \\cdot \\mathbf{q}$ 是标准的欧几里得点积。\n\n$\\mathbf{i}$ 的系数，即 $r_{1}$，是：\n$$r_{1} = p_{0}q_{1} + p_{1}q_{0} + p_{2}q_{3} - p_{3}q_{2}$$\n$\\mathbf{j}$ 的系数，即 $r_{2}$，是：\n$$r_{2} = p_{0}q_{2} - p_{1}q_{3} + p_{2}q_{0} + p_{3}q_{1}$$\n$\\mathbf{k}$ 的系数，即 $r_{3}$，是：\n$$r_{3} = p_{0}q_{3} + p_{1}q_{2} - p_{2}q_{1} + p_{3}q_{0}$$\n我们可以组合 $r$ 的矢量部分，即 $\\mathbf{r} = (r_{1}, r_{2}, r_{3})$，并从矢量运算的角度识别其结构。为了清晰起见，我们重新组织这些项：\n$$r_{1} = (p_{1}q_{0} + p_{0}q_{1}) + (p_{2}q_{3} - p_{3}q_{2})$$\n$$r_{2} = (p_{2}q_{0} + p_{0}q_{2}) + (p_{3}q_{1} - p_{1}q_{3})$$\n$$r_{3} = (p_{3}q_{0} + p_{0}q_{3}) + (p_{1}q_{2} - p_{2}q_{1})$$\n第一个括号中的项对应于 $q_{0}\\mathbf{p} + p_{0}\\mathbf{q}$ 的分量。第二个括号中的项是叉积 $\\mathbf{p} \\times \\mathbf{q}$ 的分量。因此，矢量部分 $\\mathbf{r}$ 可以写为：\n$$\\mathbf{r} = q_{0}\\mathbf{p} + p_{0}\\mathbf{q} + \\mathbf{p} \\times \\mathbf{q}$$\n结合标量和矢量部分，四元数积的标量-矢量形式为：\n$$r = p \\otimes q = (p_{0}q_{0} - \\mathbf{p} \\cdot \\mathbf{q}, \\quad p_{0}\\mathbf{q} + q_{0}\\mathbf{p} + \\mathbf{p} \\times \\mathbf{q})$$\n因此，分量 $(r_{0}, r_{1}, r_{2}, r_{3})$ 就被确定了。\n\n现在进行几何解释。四元数 $p$ 和 $q$ 是表示旋转的单位四元数。乘积 $r = p \\otimes q$ 表示先应用旋转 $q$ 然后再应用旋转 $p$ 所得到的复合旋转。\n一个表示绕单位轴矢量 $\\mathbf{u}_{q}$ 旋转角度 $\\theta_{q}$ 的单位四元数 $q$ 由 $q = (\\cos(\\theta_{q}/2), \\sin(\\theta_{q}/2)\\mathbf{u}_{q})$ 给出。因此，$q_{0} = \\cos(\\theta_{q}/2)$ 且矢量部分为 $\\mathbf{q} = \\sin(\\theta_{q}/2)\\mathbf{u}_{q}$。对于带有角度 $\\theta_{p}$ 和轴 $\\mathbf{u}_{p}$ 的 $p$ 也存在类似的表示。\n\n复合四元数的标量部分，$r_{0} = \\cos(\\theta_{r}/2)$，是：\n$$r_{0} = p_{0}q_{0} - \\mathbf{p} \\cdot \\mathbf{q} = \\cos(\\frac{\\theta_{p}}{2})\\cos(\\frac{\\theta_{q}}{2}) - (\\sin(\\frac{\\theta_{p}}{2})\\mathbf{u}_{p}) \\cdot (\\sin(\\frac{\\theta_{q}}{2})\\mathbf{u}_{q})$$\n$$r_{0} = \\cos(\\frac{\\theta_{p}}{2})\\cos(\\frac{\\theta_{q}}{2}) - \\sin(\\frac{\\theta_{p}}{2})\\sin(\\frac{\\theta_{q}}{2})(\\mathbf{u}_{p} \\cdot \\mathbf{u}_{q})$$\n这个表达式是球面余弦定律的一种形式，它决定了复合旋转的角度 $\\theta_{r}$。它表明，所得角度不仅取决于单个旋转角 $\\theta_{p}$ 和 $\\theta_{q}$，还取决于它们轴的相对取向，这由点积 $\\mathbf{u}_{p} \\cdot \\mathbf{u}_{q}$ 体现。\n\n矢量部分 $\\mathbf{r} = \\sin(\\theta_{r}/2)\\mathbf{u}_{r}$，即 $\\mathbf{r} = p_{0}\\mathbf{q} + q_{0}\\mathbf{p} + \\mathbf{p} \\times \\mathbf{q}$，决定了复合旋转的轴 $\\mathbf{u}_{r}$ 和大小 $\\sin(\\theta_{r}/2)$。这个矢量部分的结构明确地展示了三维旋转的非对易性。要理解这一点，考虑逆序的乘积 $q \\otimes p$。得到的标量部分将是 $q_{0}p_{0} - \\mathbf{q} \\cdot \\mathbf{p}$，它与 $p \\otimes q$ 的标量部分相同，因为标量乘法和点积都是可交换的。这意味着复合旋转角的大小 $|\\theta_r|$ 与应用顺序无关。然而，$q \\otimes p$ 的矢量部分将是：\n$$\\mathbf{r}' = q_{0}\\mathbf{p} + p_{0}\\mathbf{q} + \\mathbf{q} \\times \\mathbf{p}$$\n将其与 $p \\otimes q$ 的矢量部分 $\\mathbf{r} = p_{0}\\mathbf{q} + q_{0}\\mathbf{p} + \\mathbf{p} \\times \\mathbf{q}$进行比较，我们看到了差异。由于叉积是反对易的，$\\mathbf{q} \\times \\mathbf{p} = -(\\mathbf{p} \\times \\mathbf{q})$。这两个矢量部分 $\\mathbf{r}$ 和 $\\mathbf{r}'$ 通常是不同的，除非 $\\mathbf{p} \\times \\mathbf{q} = \\mathbf{0}$，这种情况只在旋转轴平行（即 $\\mathbf{u}_{p}$ 和 $\\mathbf{u}_{q}$ 共线）时发生。因此，项 $\\mathbf{p} \\times \\mathbf{q}$ 是四元数积中非对易性的来源。交换乘法顺序会使该项的符号反转，导致一个不同的矢量部分，这对应于一个不同的复合旋转轴。四元数乘法的这种代数性质准确地反映了三维空间中有限旋转不可交换这一基本几何特性。\n\n所要求的 $(r_{0}, r_{1}, r_{2}, r_{3})$ 作为单个行矩阵的最终解析表达式是根据上面推导的分量表达式构建的。\n$r_{0} = p_{0}q_{0} - p_{1}q_{1} - p_{2}q_{2} - p_{3}q_{3}$\n$r_{1} = p_{0}q_{1} + p_{1}q_{0} + p_{2}q_{3} - p_{3}q_{2}$\n$r_{2} = p_{0}q_{2} + p_{2}q_{0} + p_{3}q_{1} - p_{1}q_{3}$\n$r_{3} = p_{0}q_{3} + p_{3}q_{0} + p_{1}q_{2} - p_{2}q_{1}$\n这种形式很清晰，并直接关联到矢量形式 $\\mathbf{r} = p_{0}\\mathbf{q} + q_{0}\\mathbf{p} + \\mathbf{p} \\times \\mathbf{q}$。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} p_{0}q_{0} - p_{1}q_{1} - p_{2}q_{2} - p_{3}q_{3} & p_{0}q_{1} + p_{1}q_{0} + p_{2}q_{3} - p_{3}q_{2} & p_{0}q_{2} + p_{2}q_{0} + p_{3}q_{1} - p_{1}q_{3} & p_{0}q_{3} + p_{3}q_{0} + p_{1}q_{2} - p_{2}q_{1} \\end{pmatrix} } $$"
        },
        {
            "introduction": "在多尺度模拟中，虽然四元数因其数值稳定性和避免奇异点的能力而成为积分姿态的首选，但我们经常需要与其他使用旋转矩阵的工具或数据格式进行交互。本练习旨在训练一项至关重要的实用技能：将一个给定的旋转矩阵 $\\mathbf{R}$ 转换回其对应的单位四元数 $q$。这项任务还包括处理当旋转角接近 $\\pi$ 时出现的数值计算挑战，这对于开发稳健的模拟代码至关重要。",
            "id": "3838909",
            "problem": "在一个刚性晶体夹杂物嵌入连续介质的多尺度材料模拟中，取向在粗尺度上由单位四元数表示，以确保数值稳定的插值和时间积分。一个粗尺度单元报告了以下正常正交旋转矩阵 $\\mathbf{R} \\in \\mathrm{SO}(3)$，它将晶格坐标系映射到实验室坐标系：\n$$\n\\mathbf{R} \\;=\\;\n\\begin{pmatrix}\n-\\frac{6}{7} & \\frac{2}{7} & \\frac{3}{7} \\\\\n\\frac{2}{7} & -\\frac{3}{7} & \\frac{6}{7} \\\\\n\\frac{3}{7} & \\frac{6}{7} & \\frac{2}{7}\n\\end{pmatrix}.\n$$\n从三维向量 $\\mathbf{v} \\in \\mathbb{R}^{3}$ 作为纯虚四元数 $(0,\\mathbf{v})$ 的基本表示出发，以及单位四元数 $q = (q_{0},q_{1},q_{2},q_{3})$ 通过四元数共轭 $(0,\\mathbf{v}^{\\prime}) = q\\,(0,\\mathbf{v})\\,q^{-1}$ 对 $\\mathbf{v}$ 的作用，推导旋转矩阵各项用 $q$ 表示的表达式，并说明当矩阵的迹不为正时，如何使用矩阵的迹从 $\\mathbf{R}$ 构造 $q$ 并进行适当的个案处理以保证数值稳定性。然后，将您的推导应用于给定的 $\\mathbf{R}$，并计算相应的单位四元数 $q$。\n\n施加符号约定 $q_{0} \\ge 0$，如果 $q_{0} = 0$，则要求 $(q_{1},q_{2},q_{3})$ 中的第一个非零分量为非负数。将最终的四元数表示为单个行向量 $(q_{0},q_{1},q_{2},q_{3})$，并使用最简精确根式形式。不要进行四舍五入。",
            "solution": "问题陈述已经过验证，被认为是具有科学依据、适定、客观和完整的。它描述了刚体动力学中的一个标准问题，涉及将特殊正交群 $\\mathrm{SO}(3)$ 中的旋转矩阵转换为其对应的单位四元数表示。所提供的矩阵 $\\mathbf{R}$ 已被验证为正常正交矩阵，满足 $\\mathbf{R}^T\\mathbf{R} = \\mathbf{I}$ 和 $\\det(\\mathbf{R})=1$。该问题要求从第一性原理进行推导，并随后应用推导出的公式，这构成了一项有效且实质性的任务。我们可以着手解决。\n\n该问题分三部分解决：\n$1$. 从单位四元数 $q$ 推导旋转矩阵 $\\mathbf{R}$。\n$2$. 推导逆关系，即从 $\\mathbf{R}$ 求 $q$，包括为保证数值稳定性而对特殊情况的处理。\n$3$. 将这些公式应用于给定的矩阵 $\\mathbf{R}$，以求得特定的四元数 $q$。\n\n设单位四元数为 $q = (q_0, q_1, q_2, q_3) = q_0 + q_1\\mathbf{i} + q_2\\mathbf{j} + q_3\\mathbf{k}$，其中 $q_0$ 是标量部分，$\\mathbf{q} = (q_1, q_2, q_3)$ 是向量部分。$q$ 是单位四元数的条件是 $q_0^2 + q_1^2 + q_2^2 + q_3^2 = 1$。一个向量 $\\mathbf{v} \\in \\mathbb{R}^3$ 被表示为一个纯四元数 $v = (0, \\mathbf{v}) = v_x\\mathbf{i} + v_y\\mathbf{j} + v_z\\mathbf{k}$。\n\n**第1部分：从 $q$ 推导 $\\mathbf{R}$**\n\n向量 $\\mathbf{v}$ 到 $\\mathbf{v}'$ 的旋转由四元数共轭给出：\n$$ v' = q v q^{-1} $$\n其中 $v'=(0, \\mathbf{v}')$。对于单位四元数，其逆是其共轭，$q^{-1} = q^* = q_0 - \\mathbf{q}$。两个四元数 $a=(a_0, \\mathbf{a})$ 和 $b=(b_0, \\mathbf{b})$ 的乘法为 $ab = (a_0 b_0 - \\mathbf{a} \\cdot \\mathbf{b}, a_0 \\mathbf{b} + b_0 \\mathbf{a} + \\mathbf{a} \\times \\mathbf{b})$。\n\n首先，我们计算乘积 $qv$：\n$$ qv = (q_0, \\mathbf{q})(0, \\mathbf{v}) = (q_0(0) - \\mathbf{q} \\cdot \\mathbf{v}, q_0\\mathbf{v} + 0\\mathbf{q} + \\mathbf{q} \\times \\mathbf{v}) = (-\\mathbf{q} \\cdot \\mathbf{v}, q_0\\mathbf{v} + \\mathbf{q} \\times \\mathbf{v}) $$\n接下来，我们将此结果乘以 $q^{-1} = (q_0, -\\mathbf{q})$：\n$$ v' = (qv)q^{-1} = (-\\mathbf{q} \\cdot \\mathbf{v}, q_0\\mathbf{v} + \\mathbf{q} \\times \\mathbf{v})(q_0, -\\mathbf{q}) $$\n$v'$ 的标量部分是：\n$$ s' = (-\\mathbf{q} \\cdot \\mathbf{v})q_0 - (q_0\\mathbf{v} + \\mathbf{q} \\times \\mathbf{v}) \\cdot (-\\mathbf{q}) = -q_0(\\mathbf{q} \\cdot \\mathbf{v}) + q_0(\\mathbf{v} \\cdot \\mathbf{q}) + (\\mathbf{q} \\times \\mathbf{v}) \\cdot \\mathbf{q} = 0 $$\n这是预期的，因为旋转后的向量必须保持为纯四元数。向量部分 $\\mathbf{v}'$ 是：\n$$ \\mathbf{v}' = (-\\mathbf{q} \\cdot \\mathbf{v})(-\\mathbf{q}) + q_0(q_0\\mathbf{v} + \\mathbf{q} \\times \\mathbf{v}) + (q_0\\mathbf{v} + \\mathbf{q} \\times \\mathbf{v}) \\times (-\\mathbf{q}) $$\n$$ \\mathbf{v}' = (\\mathbf{q} \\cdot \\mathbf{v})\\mathbf{q} + q_0^2\\mathbf{v} + q_0(\\mathbf{q} \\times \\mathbf{v}) - q_0(\\mathbf{v} \\times \\mathbf{q}) - (\\mathbf{q} \\times \\mathbf{v}) \\times \\mathbf{q} $$\n使用叉积的反交换律 $\\mathbf{v} \\times \\mathbf{q} = -(\\mathbf{q} \\times \\mathbf{v})$ 和向量三重积恒等式 $\\mathbf{a} \\times (\\mathbf{b} \\times \\mathbf{c}) = (\\mathbf{a}\\cdot\\mathbf{c})\\mathbf{b} - (\\mathbf{a}\\cdot\\mathbf{b})\\mathbf{c}$，我们简化得到：\n$$ \\mathbf{v}' = (\\mathbf{q} \\cdot \\mathbf{v})\\mathbf{q} + q_0^2\\mathbf{v} + 2q_0(\\mathbf{q} \\times \\mathbf{v}) - [(\\mathbf{q}\\cdot\\mathbf{q})\\mathbf{v} - (\\mathbf{q}\\cdot\\mathbf{v})\\mathbf{q}] $$\n$$ \\mathbf{v}' = (q_0^2 - \\mathbf{q}\\cdot\\mathbf{q})\\mathbf{v} + 2(\\mathbf{q}\\cdot\\mathbf{v})\\mathbf{q} + 2q_0(\\mathbf{q} \\times \\mathbf{v}) $$\n使用单位范数条件 $q_0^2 + \\mathbf{q}\\cdot\\mathbf{q} = 1$，我们可以写出 $q_0^2 - \\mathbf{q}\\cdot\\mathbf{q} = q_0^2 - (1 - q_0^2) = 2q_0^2 - 1$。\n变换为 $\\mathbf{v}' = \\mathbf{R}\\mathbf{v}$，其中旋转算子 $\\mathbf{R}$ 可以用张量和向量积表示：\n$$ \\mathbf{R} = (2q_0^2 - 1)\\mathbf{I} + 2\\mathbf{q}\\otimes\\mathbf{q} + 2q_0[\\mathbf{q}]_\\times $$\n这里 $\\mathbf{I}$ 是单位矩阵，$\\mathbf{q}\\otimes\\mathbf{q}$ 是外积 $\\mathbf{q}\\mathbf{q}^T$，$[\\mathbf{q}]_\\times$ 是与 $\\mathbf{q}$ 进行叉积的斜对称矩阵表示。以分量形式，这给出了旋转矩阵：\n$$ \\mathbf{R} = \\begin{pmatrix} q_0^2+q_1^2-q_2^2-q_3^2 & 2(q_1q_2 - q_0q_3) & 2(q_1q_3 + q_0q_2) \\\\ 2(q_1q_2 + q_0q_3) & q_0^2-q_1^2+q_2^2-q_3^2 & 2(q_2q_3 - q_0q_1) \\\\ 2(q_1q_3 - q_0q_2) & 2(q_2q_3 + q_0q_1) & q_0^2-q_1^2-q_2^2+q_3^2 \\end{pmatrix} $$\n或者，使用 $q_0^2+q_1^2+q_2^2+q_3^2=1$：\n$$ \\mathbf{R} = \\begin{pmatrix} 1-2(q_2^2+q_3^2) & 2(q_1q_2 - q_0q_3) & 2(q_1q_3 + q_0q_2) \\\\ 2(q_1q_2 + q_0q_3) & 1-2(q_1^2+q_3^2) & 2(q_2q_3 - q_0q_1) \\\\ 2(q_1q_3 - q_0q_2) & 2(q_2q_3 + q_0q_1) & 1-2(q_1^2+q_2^2) \\end{pmatrix} $$\n\n**第2部分：从 $\\mathbf{R}$ 推导 $q$**\n\n$\\mathbf{R}$ 的迹是其对角元素之和：\n$$ \\mathrm{Tr}(\\mathbf{R}) = R_{11} + R_{22} + R_{33} = (q_0^2+q_1^2-q_2^2-q_3^2) + (q_0^2-q_1^2+q_2^2-q_3^2) + (q_0^2-q_1^2-q_2^2+q_3^2) $$\n$$ \\mathrm{Tr}(\\mathbf{R}) = 3q_0^2 - q_1^2 - q_2^2 - q_3^2 = 3q_0^2 - (1 - q_0^2) = 4q_0^2 - 1 $$\n这给出了 $q_0^2$ 的一个直接表达式：\n$$ 4q_0^2 = \\mathrm{Tr}(\\mathbf{R}) + 1 \\implies q_0 = \\frac{1}{2}\\sqrt{\\mathrm{Tr}(\\mathbf{R}) + 1} $$\n由于问题的符号约定 $q_0 \\ge 0$，我们选择正根。其他分量可以从非对角项中找到：\n$$ R_{32} - R_{23} = 4q_0q_1 \\implies q_1 = \\frac{R_{32} - R_{23}}{4q_0} $$\n$$ R_{13} - R_{31} = 4q_0q_2 \\implies q_2 = \\frac{R_{13} - R_{31}}{4q_0} $$\n$$ R_{21} - R_{12} = 4q_0q_3 \\implies q_3 = \\frac{R_{21} - R_{12}}{4q_0} $$\n如果 $\\mathrm{Tr}(\\mathbf{R})$ 接近 $-1$，这种方法是数值不稳定的，这对应于接近 $\\pi$ 的旋转角，使得 $q_0$ 接近 $0$。\n\n为了得到一个数值稳定的算法，我们必须处理迹不为正的情况。一般策略是先计算 $q$ 中模最大的分量，然后用它来求解其他分量。我们从 $\\mathbf{R}$ 的对角元素构造以下关系：\n$$ 4q_0^2 = 1 + R_{11} + R_{22} + R_{33} = 1 + \\mathrm{Tr}(\\mathbf{R}) $$\n$$ 4q_1^2 = 1 + R_{11} - R_{22} - R_{33} $$\n$$ 4q_2^2 = 1 - R_{11} + R_{22} - R_{33} $$\n$$ 4q_3^2 = 1 - R_{11} - R_{22} + R_{33} $$\n该算法通过识别右侧中的最大值来继续，该最大值对应于 $q$ 的最大分量。\n如果 $q_0$ 最大（即，在相关项中 $\\mathrm{Tr}(\\mathbf{R})$ 最大，通常在 $\\mathrm{Tr}(\\mathbf{R})>0$ 时），我们使用上述公式。\n如果 $\\mathrm{Tr}(\\mathbf{R}) \\le 0$ 且 $R_{11}$ 是最大的对角项，那么 $|q_1|$ 是最大的分量。我们计算 $q_1 = \\frac{1}{2}\\sqrt{1 + R_{11} - R_{22} - R_{33}}$（根据约定或其他值选择符号），然后求解其他分量：\n$q_0 = \\frac{R_{32}-R_{23}}{4q_1}$，$q_2 = \\frac{R_{12}+R_{21}}{4q_1}$，$q_3 = \\frac{R_{13}+R_{31}}{4q_1}$。\n如果 $R_{22}$ 或 $R_{33}$ 是最大的对角元素，也存在类似的公式。\n\n**第3部分：应用于给定矩阵**\n\n给定的旋转矩阵是：\n$$ \\mathbf{R} = \\begin{pmatrix} -\\frac{6}{7} & \\frac{2}{7} & \\frac{3}{7} \\\\ \\frac{2}{7} & -\\frac{3}{7} & \\frac{6}{7} \\\\ \\frac{3}{7} & \\frac{6}{7} & \\frac{2}{7} \\end{pmatrix} $$\n首先，我们计算迹：\n$$ \\mathrm{Tr}(\\mathbf{R}) = -\\frac{6}{7} - \\frac{3}{7} + \\frac{2}{7} = \\frac{-7}{7} = -1 $$\n迹不为正，表明旋转角为 $\\theta = \\pi$。我们应用稳定方法。从 $\\mathrm{Tr}(\\mathbf{R}) = -1$ 我们发现：\n$$ q_0 = \\frac{1}{2}\\sqrt{-1+1} = 0 $$\n由于 $q_0=0$，我们必须使用对角元素来找到向量分量。\n$$ 4q_1^2 = 1 + R_{11} - R_{22} - R_{33} = 1 - \\frac{6}{7} - (-\\frac{3}{7}) - \\frac{2}{7} = \\frac{7-6+3-2}{7} = \\frac{2}{7} \\implies q_1^2 = \\frac{1}{14} $$\n$$ 4q_2^2 = 1 - R_{11} + R_{22} - R_{33} = 1 - (-\\frac{6}{7}) - \\frac{3}{7} - \\frac{2}{7} = \\frac{7+6-3-2}{7} = \\frac{8}{7} \\implies q_2^2 = \\frac{2}{7} $$\n$$ 4q_3^2 = 1 - R_{11} - R_{22} + R_{33} = 1 - (-\\frac{6}{7}) - (-\\frac{3}{7}) + \\frac{2}{7} = \\frac{7+6+3+2}{7} = \\frac{18}{7} \\implies q_3^2 = \\frac{9}{14} $$\n模为 $|q_1| = \\frac{1}{\\sqrt{14}}$， $|q_2| = \\sqrt{\\frac{2}{7}}$，和 $|q_3| = \\frac{3}{\\sqrt{14}}$。\n为了确定符号，我们使用 $\\mathbf{R}$ 的非对角元素。当 $q_0=0$ 时：\n$$ R_{12} = 2q_1q_2 = \\frac{2}{7} \\implies q_1q_2 = \\frac{1}{7} $$\n$$ R_{13} = 2q_1q_3 = \\frac{3}{7} \\implies q_1q_3 = \\frac{3}{14} $$\n$$ R_{23} = 2q_2q_3 = \\frac{6}{7} \\implies q_2q_3 = \\frac{3}{7} $$\n由于所有乘积 $q_iq_j$ 都是正的，分量 $q_1, q_2, q_3$ 必须都具有相同的符号（要么全为正，要么全为负）。\n问题施加了符号约定：如果 $q_0=0$，则 $(q_1, q_2, q_3)$ 中的第一个非零分量必须为非负数。由于 $q_1$ 非零，我们必须有 $q_1 > 0$。这也意味着 $q_2 > 0$ 和 $q_3 > 0$。\n因此我们取模的正根：\n$$ q_1 = \\sqrt{\\frac{1}{14}} = \\frac{1}{\\sqrt{14}} = \\frac{\\sqrt{14}}{14} $$\n$$ q_2 = \\sqrt{\\frac{2}{7}} = \\frac{\\sqrt{2}}{\\sqrt{7}} = \\frac{\\sqrt{14}}{7} $$\n$$ q_3 = \\sqrt{\\frac{9}{14}} = \\frac{3}{\\sqrt{14}} = \\frac{3\\sqrt{14}}{14} $$\n最终的四元数是 $q=(q_0, q_1, q_2, q_3)$。\n$$ q = \\left(0, \\frac{\\sqrt{14}}{14}, \\frac{\\sqrt{14}}{7}, \\frac{3\\sqrt{14}}{14}\\right) $$\n最后的检验确认了范数：$q_0^2+q_1^2+q_2^2+q_3^2 = 0 + \\frac{1}{14} + \\frac{2}{7} + \\frac{9}{14} = \\frac{1+4+9}{14} = \\frac{14}{14} = 1$。解答是一致的。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & \\frac{\\sqrt{14}}{14} & \\frac{\\sqrt{14}}{7} & \\frac{3\\sqrt{14}}{14}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在模拟刚体从一个方向演化到另一个方向时，准确描述其中间的姿态路径至关重要。本练习探讨了两种不同的姿态插值方法：几何上精确的球面线性插值（SLERP）和一种概念上更简单但有缺陷的归一化线性插值（LERP）。通过计算在特定插值点上两种方法产生的旋转矩阵之间的差异，您将具体地体会到为什么SLERP是生成平滑、匀速旋转路径的标准方法，这对动力学分析和动画都至关重要。",
            "id": "3838922",
            "problem": "考虑一个代表嵌入在多尺度材料模拟中的晶体夹杂物的粗粒化刚性域。该域的取向由单位四元数 $q(t)$ 表示，它在两个取向 $q_{0}$ 和 $q_{1}$ 之间演化，是与介观耦合场相关的标量参数 $t \\in [0,1]$ 的函数。要求您使用两种不同的插值策略计算在 $t = \\frac{1}{4}$ 时的中间取向，并比较它们在三维特殊正交群 (SO(3)) 中得到的旋转矩阵。\n\n设 $q_{0} = \\left(1, 0, 0, 0\\right)$ 和 $q_{1} = \\left(\\frac{1}{2}, \\frac{1}{2}, \\frac{1}{2}, \\frac{1}{2}\\right)$，其中四元数按 $(w, x, y, z)$ 排序，$w$ 为标量部分，$(x,y,z)$ 为矢量部分。这些单位四元数代表域的刚体取向。\n\n任务：\n- 使用单位四元数的刚体运动学第一性原理和单位3-球面上的测地线定义，推导通过球面线性插值 (SLERP) 在 $t = \\frac{1}{4}$ 时得到的中间单位四元数 $q_{\\mathrm{slerp}}(t)$。\n- 根据纯虚四元数 $v$ 的四元数作用于向量的定义 $v' = q \\, v \\, q^{-1}$，推导旋转矩阵 $R\\!\\left(q_{\\mathrm{slerp}}(t)\\right) \\in \\mathrm{SO}(3)$（用四元数分量表示），并计算其在 $t = \\frac{1}{4}$ 时的值。\n- 定义一种朴素的逐分量插值 $q_{\\mathrm{lin}}(t)$，通过线性插值四元数分量得到 $q_{\\mathrm{lin,raw}}(t) = (1-t) q_{0} + t q_{1}$，然后归一化到单位长度：$q_{\\mathrm{lin}}(t) = \\frac{q_{\\mathrm{lin,raw}}(t)}{\\|q_{\\mathrm{lin,raw}}(t)\\|}$。推导相应的旋转矩阵 $R\\!\\left(q_{\\mathrm{lin}}(t)\\right)$。\n- 计算在 $t = \\frac{1}{4}$ 时两个旋转矩阵之差的弗罗贝尼乌斯范数 $\\| R\\!\\left(q_{\\mathrm{slerp}}(t)\\right) - R\\!\\left(q_{\\mathrm{lin}}(t)\\right) \\|_{F}$。\n\n将最终结果表示为单个精确的解析表达式。无需四舍五入。由于结果是矩阵范数，它是无量纲的。",
            "solution": "问题陈述经评估具有科学依据、适定、客观且自洽。它包含了基于已建立的刚体动力学和数学原理获得唯一解所需的所有数据和定义。该问题是有效的。\n\n该问题要求比较两种四元数插值方法：球面线性插值 (SLERP) 和归一化线性插值 (LERP)。给定初始取向为单位四元数 $q_0 = (1, 0, 0, 0)$（代表无旋转），最终取向为 $q_1 = (\\frac{1}{2}, \\frac{1}{2}, \\frac{1}{2}, \\frac{1}{2})$。插值参数为 $t=\\frac{1}{4}$。四元数记为 $q = (w, x, y, z)$。\n\n**1. 球面线性插值 (SLERP)**\n\nSLERP 提供了沿单位四元数3-球面上的大圆弧的匀速运动。这对应于具有固定轴和均匀变化角度的旋转。两个单位四元数 $q_0$ 和 $q_1$ 之间的 SLERP 公式为：\n$$q_{\\mathrm{slerp}}(t) = \\frac{\\sin((1-t)\\Omega)}{\\sin(\\Omega)} q_0 + \\frac{\\sin(t\\Omega)}{\\sin(\\Omega)} q_1$$\n其中 $\\Omega$ 是四维空间中四元数之间的夹角，由 $\\cos(\\Omega) = q_0 \\cdot q_1$ 定义。首先，我们计算 $\\Omega$：\n$$q_0 \\cdot q_1 = (1)\\left(\\frac{1}{2}\\right) + (0)\\left(\\frac{1}{2}\\right) + (0)\\left(\\frac{1}{2}\\right) + (0)\\left(\\frac{1}{2}\\right) = \\frac{1}{2}$$\n因此，$\\cos(\\Omega) = \\frac{1}{2}$，这意味着 $\\Omega = \\frac{\\pi}{3}$ 弧度。\n现在我们在 $t=\\frac{1}{4}$ 处计算 $q_{\\mathrm{slerp}}(t)$ 的值：\n$$q_{\\mathrm{slerp}}\\left(\\frac{1}{4}\\right) = \\frac{\\sin\\left(\\left(1-\\frac{1}{4}\\right)\\frac{\\pi}{3}\\right)}{\\sin\\left(\\frac{\\pi}{3}\\right)} q_0 + \\frac{\\sin\\left(\\frac{1}{4}\\frac{\\pi}{3}\\right)}{\\sin\\left(\\frac{\\pi}{3}\\right)} q_1 = \\frac{\\sin\\left(\\frac{\\pi}{4}\\right)}{\\sin\\left(\\frac{\\pi}{3}\\right)} q_0 + \\frac{\\sin\\left(\\frac{\\pi}{12}\\right)}{\\sin\\left(\\frac{\\pi}{3}\\right)} q_1$$\n我们使用标准三角函数值：$\\sin(\\frac{\\pi}{3}) = \\frac{\\sqrt{3}}{2}$，$\\sin(\\frac{\\pi}{4}) = \\frac{\\sqrt{2}}{2}$，以及 $\\sin(\\frac{\\pi}{12}) = \\sin(15^{\\circ}) = \\frac{\\sqrt{6}-\\sqrt{2}}{4}$。\n系数为：\n$$ \\frac{\\sin(\\frac{\\pi}{4})}{\\sin(\\frac{\\pi}{3})} = \\frac{\\frac{\\sqrt{2}}{2}}{\\frac{\\sqrt{3}}{2}} = \\frac{\\sqrt{2}}{\\sqrt{3}} = \\frac{\\sqrt{6}}{3} $$\n$$ \\frac{\\sin(\\frac{\\pi}{12})}{\\sin(\\frac{\\pi}{3})} = \\frac{\\frac{\\sqrt{6}-\\sqrt{2}}{4}}{\\frac{\\sqrt{3}}{2}} = \\frac{\\sqrt{6}-\\sqrt{2}}{2\\sqrt{3}} = \\frac{\\sqrt{18}-\\sqrt{6}}{6} = \\frac{3\\sqrt{2}-\\sqrt{6}}{6} $$\n将这些系数代入 SLERP 方程，其中 $q_0 = (1,0,0,0)$ 和 $q_1 = (\\frac{1}{2}, \\frac{1}{2}, \\frac{1}{2}, \\frac{1}{2})$：\n$$ q_{\\mathrm{slerp}}\\left(\\frac{1}{4}\\right) = \\frac{\\sqrt{6}}{3}(1,0,0,0) + \\frac{3\\sqrt{2}-\\sqrt{6}}{6}\\left(\\frac{1}{2}, \\frac{1}{2}, \\frac{1}{2}, \\frac{1}{2}\\right) $$\n$q_s = q_{\\mathrm{slerp}}(\\frac{1}{4}) = (w_s, x_s, y_s, z_s)$ 的分量是：\n$$ w_s = \\frac{\\sqrt{6}}{3} + \\frac{3\\sqrt{2}-\\sqrt{6}}{12} = \\frac{4\\sqrt{6} + 3\\sqrt{2} - \\sqrt{6}}{12} = \\frac{3\\sqrt{6} + 3\\sqrt{2}}{12} = \\frac{\\sqrt{6}+\\sqrt{2}}{4} $$\n$$ x_s = y_s = z_s = \\frac{3\\sqrt{2}-\\sqrt{6}}{6} \\cdot \\frac{1}{2} = \\frac{3\\sqrt{2}-\\sqrt{6}}{12} $$\n所以，$q_s = \\left(\\frac{\\sqrt{6}+\\sqrt{2}}{4}, \\frac{3\\sqrt{2}-\\sqrt{6}}{12}, \\frac{3\\sqrt{2}-\\sqrt{6}}{12}, \\frac{3\\sqrt{2}-\\sqrt{6}}{12}\\right)$。\n\n**2. 四元数到旋转矩阵的转换**\n\n通过单位四元数 $q$ 将向量 $\\mathbf{v}$ 旋转到 $\\mathbf{v'}$ 的过程由作用 $v' = qvq^{-1}$ 给出，其中 $v=(0, \\mathbf{v})$ 和 $v'=(0, \\mathbf{v'})$ 是纯四元数。对 $q=(w,x,y,z)$ 和 $v=(0,v_x,v_y,v_z)$ 展开此乘积，得到一个作用于 $\\mathbf{v}$ 分量的线性变换，这定义了旋转矩阵 $R(q) \\in \\mathrm{SO}(3)$。该矩阵的标准结果是：\n$$ R(q) = \\begin{pmatrix} 1 - 2(y^2 + z^2) & 2(xy - wz) & 2(xz + wy) \\\\ 2(xy + wz) & 1 - 2(x^2 + z^2) & 2(yz - wx) \\\\ 2(xz - wy) & 2(yz + wx) & 1 - 2(x^2 + y^2) \\end{pmatrix} $$\n\n**3. 归一化线性插值 (LERP)**\n\nLERP 首先对四元数分量进行线性插值，然后将结果归一化以确保其为单位四元数。\n$$ q_{\\mathrm{lin,raw}}(t) = (1-t) q_0 + t q_1 $$\n在 $t=\\frac{1}{4}$ 时：\n$$ q_{\\mathrm{lin,raw}}\\left(\\frac{1}{4}\\right) = \\frac{3}{4}(1,0,0,0) + \\frac{1}{4}\\left(\\frac{1}{2}, \\frac{1}{2}, \\frac{1}{2}, \\frac{1}{2}\\right) = \\left(\\frac{3}{4}+\\frac{1}{8}, \\frac{1}{8}, \\frac{1}{8}, \\frac{1}{8}\\right) = \\left(\\frac{7}{8}, \\frac{1}{8}, \\frac{1}{8}, \\frac{1}{8}\\right) $$\n接下来，我们归一化这个四元数。其范数的平方是：\n$$ \\left\\|q_{\\mathrm{lin,raw}}\\left(\\frac{1}{4}\\right)\\right\\|^2 = \\left(\\frac{7}{8}\\right)^2 + \\left(\\frac{1}{8}\\right)^2 + \\left(\\frac{1}{8}\\right)^2 + \\left(\\frac{1}{8}\\right)^2 = \\frac{49+1+1+1}{64} = \\frac{52}{64} = \\frac{13}{16} $$\n范数为 $\\|\\cdot\\| = \\sqrt{\\frac{13}{16}} = \\frac{\\sqrt{13}}{4}$。\n归一化得到 LERP 四元数 $q_l = q_{\\mathrm{lin}}(\\frac{1}{4}) = (w_l, x_l, y_l, z_l)$：\n$$ q_l = \\frac{1}{\\frac{\\sqrt{13}}{4}} \\left(\\frac{7}{8}, \\frac{1}{8}, \\frac{1}{8}, \\frac{1}{8}\\right) = \\frac{4}{\\sqrt{13}} \\frac{1}{8}(7,1,1,1) = \\frac{1}{2\\sqrt{13}}(7,1,1,1) $$\n所以，$q_l = \\left(\\frac{7}{2\\sqrt{13}}, \\frac{1}{2\\sqrt{13}}, \\frac{1}{2\\sqrt{13}}, \\frac{1}{2\\sqrt{13}}\\right)$。\n\n**4. 弗罗贝尼乌斯范数计算**\n\n两个旋转矩阵 $R_s = R(q_s)$ 和 $R_l = R(q_l)$ 之差的弗罗贝尼乌斯范数由 $\\|R_s - R_l\\|_F = \\sqrt{\\mathrm{Tr}\\left((R_s-R_l)^T(R_s-R_l)\\right)}$ 给出。\n利用旋转矩阵的正交性（$R^T R = I$）和迹的性质，可简化为：\n$$ \\|R_s - R_l\\|_F^2 = 6 - 2 \\mathrm{Tr}(R_s^T R_l) = 6 - 2 \\mathrm{Tr}(R(q_s^{-1})R(q_l)) = 6 - 2 \\mathrm{Tr}(R(q_s^{-1}q_l)) $$\n来自四元数 $q=(w,x,y,z)$ 的旋转矩阵的迹是 $\\mathrm{Tr}(R(q)) = 4w^2-1$。设 $q_{diff} = q_s^{-1}q_l$，其标量部分为 $w_d$。则：\n$$ \\|R_s - R_l\\|_F^2 = 6 - 2(4w_d^2 - 1) = 8 - 8w_d^2 = 8(1-w_d^2) $$\n两个四元数乘积 $q_a^{-1} q_b$ 的标量部分是它们的点积 $q_a \\cdot q_b$。所以，$w_d = q_s \\cdot q_l$。\n$$ w_d = w_s w_l + x_s x_l + y_s y_l + z_s z_l $$\n使用 $q_s$ 和 $q_l$ 的分量：\n$$ w_s = \\frac{\\sqrt{6}+\\sqrt{2}}{4} \\quad \\text{和} \\quad x_s=y_s=z_s = \\frac{3\\sqrt{2}-\\sqrt{6}}{12} $$\n$$ w_l = \\frac{7}{2\\sqrt{13}} \\quad \\text{和} \\quad x_l=y_l=z_l = \\frac{1}{2\\sqrt{13}} $$\n$$ w_d = \\left(\\frac{\\sqrt{6}+\\sqrt{2}}{4}\\right)\\left(\\frac{7}{2\\sqrt{13}}\\right) + 3\\left(\\frac{3\\sqrt{2}-\\sqrt{6}}{12}\\right)\\left(\\frac{1}{2\\sqrt{13}}\\right) $$\n$$ w_d = \\frac{7\\sqrt{6}+7\\sqrt{2}}{8\\sqrt{13}} + \\frac{3\\sqrt{2}-\\sqrt{6}}{8\\sqrt{13}} = \\frac{7\\sqrt{6}+7\\sqrt{2}+3\\sqrt{2}-\\sqrt{6}}{8\\sqrt{13}} = \\frac{6\\sqrt{6}+10\\sqrt{2}}{8\\sqrt{13}} = \\frac{3\\sqrt{6}+5\\sqrt{2}}{4\\sqrt{13}} $$\n现在我们计算 $w_d^2$：\n$$ w_d^2 = \\left(\\frac{3\\sqrt{6}+5\\sqrt{2}}{4\\sqrt{13}}\\right)^2 = \\frac{(3\\sqrt{6})^2 + 2(3\\sqrt{6})(5\\sqrt{2}) + (5\\sqrt{2})^2}{16 \\times 13} = \\frac{54 + 30\\sqrt{12} + 50}{208} = \\frac{104 + 60\\sqrt{3}}{208} = \\frac{26+15\\sqrt{3}}{52} $$\n最后，我们计算弗罗贝尼乌斯范数：\n$$ \\|R_s - R_l\\|_F^2 = 8(1 - w_d^2) = 8\\left(1 - \\frac{26+15\\sqrt{3}}{52}\\right) = 8\\left(\\frac{52 - 26 - 15\\sqrt{3}}{52}\\right) = 8\\left(\\frac{26 - 15\\sqrt{3}}{52}\\right) $$\n$$ \\|R_s - R_l\\|_F^2 = \\frac{2 \\times (26 - 15\\sqrt{3})}{13} = \\frac{52 - 30\\sqrt{3}}{13} = 4 - \\frac{30\\sqrt{3}}{13} $$\n最终结果是该值的平方根。\n$$ \\| R(q_{\\mathrm{slerp}}) - R(q_{\\mathrm{lin}}) \\|_{F} = \\sqrt{4 - \\frac{30\\sqrt{3}}{13}} $$",
            "answer": "$$\\boxed{\\sqrt{4 - \\frac{30\\sqrt{3}}{13}}}$$"
        }
    ]
}