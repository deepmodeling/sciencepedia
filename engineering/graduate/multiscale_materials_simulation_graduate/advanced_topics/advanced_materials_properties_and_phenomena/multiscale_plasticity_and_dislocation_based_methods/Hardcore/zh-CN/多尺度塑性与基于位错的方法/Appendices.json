{
    "hands_on_practices": [
        {
            "introduction": "位错是晶体材料中塑性变形的基本载体，其几何特征——即位错线方向与伯格斯矢量之间的夹角——决定了其属性，并直接影响其在晶格中的运动能力。本练习将通过一个具体的计算，帮助您掌握如何从晶体学矢量（伯格斯矢量 $\\mathbf{b}$ 和位错线方向 $\\mathbf{l}$）出发，确定位错的特征角 $\\theta$ 。这一基本技能是理解和构建介观尺度模型（如离散位错动力学）的关键一步。",
            "id": "3825957",
            "problem": "考虑面心立方（FCC）晶体中的一个直位错段，其滑移系为 $\\{111\\}\\langle 110\\rangle$。设晶格常数为 $a$，并采用与晶体学坐标轴 $[100]$、$[010]$ 和 $[001]$ 对齐的正交笛卡尔基。该位错的伯氏矢量为 $\\mathbf{b}=\\frac{a}{2}[1\\,\\,-1\\,\\,0]$，位于 $(1\\,\\,1\\,\\,1)$ 滑移面内，位错线方向平行于 $[1\\,\\,0\\,\\,-1]$。位错线方向的单位矢量为 $\\mathbf{l}=\\frac{1}{\\sqrt{2}}[1\\,\\,0\\,\\,-1]$。\n\n从两个矢量之间夹角的几何定义以及位错的基本运动学（伯氏矢量、位错线方向和滑移面兼容性）出发，推导 $\\mathbf{b}$ 和 $\\mathbf{l}$ 之间的位错混合角 $\\theta$。使用 $\\theta$ 是 $\\mathbf{b}$ 和 $\\mathbf{l}$ 之间夹角的定义，并以弧度表示 $\\theta$。请给出精确值。\n\n然后，利用 Peach–Koehler 力和一个与位错混合角相关的线性拖曳定律，解释在介观尺度描述中（例如离散位错动力学，DDD; Discrete Dislocation Dynamics），位错混合角如何影响滑移迁移率。假设螺型和刃型位错的拖曳系数分别为 $B_{\\mathrm{s}}$ 和 $B_{\\mathrm{e}}$，并且单位长度的功率耗散在螺型和刃型分量上是可加的。不需要对迁移率进行数值计算。\n\n最终角度以弧度表示。无需四舍五入，请给出精确值。",
            "solution": "位错由其伯氏矢量 $\\mathbf{b}$ 和位错线方向 $\\mathbf{l}$ 来表征。位错混合角 $\\theta$ 定义为 $\\mathbf{b}$ 和 $\\mathbf{l}$ 之间的夹角。根据基本矢量几何学，矢量 $\\mathbf{u}$ 和 $\\mathbf{v}$ 之间的夹角 $\\theta$ 由下式给出\n$$\n\\cos(\\theta)=\\frac{\\mathbf{u}\\cdot\\mathbf{v}}{\\|\\mathbf{u}\\|\\,\\|\\mathbf{v}\\|}.\n$$\n将此应用于位错，令 $\\mathbf{u}=\\mathbf{b}$ 和 $\\mathbf{v}=\\mathbf{l}$，我们得到\n$$\n\\cos(\\theta)=\\frac{\\mathbf{b}\\cdot\\mathbf{l}}{\\|\\mathbf{b}\\|\\,\\|\\mathbf{l}\\|}.\n$$\n根据定义，$\\mathbf{l}$ 是一个单位矢量，因此 $\\|\\mathbf{l}\\|=1$。所以，\n$$\n\\cos(\\theta)=\\frac{\\mathbf{b}\\cdot\\mathbf{l}}{\\|\\mathbf{b}\\|}.\n$$\n\n我们现在明确地计算 $\\mathbf{b}\\cdot\\mathbf{l}$ 和 $\\|\\mathbf{b}\\|$。在所选的正交基中，写作\n$$\n\\mathbf{b}=\\frac{a}{2}\\begin{pmatrix}1\\\\-1\\\\0\\end{pmatrix},\\qquad\n\\mathbf{l}=\\frac{1}{\\sqrt{2}}\\begin{pmatrix}1\\\\0\\\\-1\\end{pmatrix}.\n$$\n点积为\n$$\n\\mathbf{b}\\cdot\\mathbf{l}=\\left(\\frac{a}{2}\\right)\\left(\\frac{1}{\\sqrt{2}}\\right)\\left(1\\cdot 1+(-1)\\cdot 0+0\\cdot(-1)\\right)=\\frac{a}{2\\sqrt{2}}\\cdot 1=\\frac{a}{2\\sqrt{2}}.\n$$\n$\\mathbf{b}$ 的模为\n$$\n\\|\\mathbf{b}\\|=\\left\\|\\frac{a}{2}\\begin{pmatrix}1\\\\-1\\\\0\\end{pmatrix}\\right\\|=\\frac{a}{2}\\sqrt{1^{2}+(-1)^{2}+0^{2}}=\\frac{a}{2}\\sqrt{2}=\\frac{a\\sqrt{2}}{2}.\n$$\n因此，\n$$\n\\cos(\\theta)=\\frac{\\frac{a}{2\\sqrt{2}}}{\\frac{a\\sqrt{2}}{2}}=\\frac{a}{2\\sqrt{2}}\\cdot\\frac{2}{a\\sqrt{2}}=\\frac{1}{2}.\n$$\n于是，\n$$\n\\theta=\\arccos\\!\\left(\\frac{1}{2}\\right)=\\frac{\\pi}{3}.\n$$\n位错混合角的精确值为 $\\theta=\\frac{\\pi}{3}$ 弧度。这对应于一个混合型位错：既非纯螺型（$\\theta=0$），也非纯刃型（$\\theta=\\frac{\\pi}{2}$）。\n\n从第一性原理看对迁移率的影响：在应力张量为 $\\boldsymbol{\\sigma}$ 的应力场中，作用于线方向为 $\\boldsymbol{\\xi}=\\mathbf{l}$、伯氏矢量为 $\\mathbf{b}$ 的位错上的单位长度 Peach–Koehler 力为\n$$\n\\mathbf{f}_{\\mathrm{PK}}=(\\boldsymbol{\\sigma}\\cdot\\mathbf{b})\\times\\boldsymbol{\\xi}.\n$$\n对于在滑移系上由分解切应力 $\\tau$ 引起的纯滑移，单位长度 Peach–Koehler 力的滑移分量大小为\n$$\nf_{\\mathrm{glide}}=\\tau\\,\\|\\mathbf{b}\\|.\n$$\n在线性拖曳区，滑移速度 $v$ 的动力学关系由功率平衡决定：外部功率输入 $f_{\\mathrm{glide}}\\,v$ 等于耗散功率。如果位错具有混合特征，其螺型分量比例为 $\\cos(\\theta)$，刃型分量比例为 $\\sin(\\theta)$，且螺型和刃型位错的拖曳系数分别为 $B_{\\mathrm{s}}$ 和 $B_{\\mathrm{e}}$，一个常用的介观尺度可加耗散模型（该模型与将速度投影到特征分量上并将其耗散相加的方式一致）给出的单位长度总耗散功率为\n$$\nP_{\\mathrm{diss}}=B_{\\mathrm{s}}\\,v^{2}\\cos^{2}(\\theta)+B_{\\mathrm{e}}\\,v^{2}\\sin^{2}(\\theta).\n$$\n令 $f_{\\mathrm{glide}}\\,v=P_{\\mathrm{diss}}$ 得到有效拖曳系数\n$$\nB_{\\mathrm{eff}}(\\theta)=B_{\\mathrm{s}}\\cos^{2}(\\theta)+B_{\\mathrm{e}}\\sin^{2}(\\theta),\n$$\n并因此得到有效迁移率 $M_{\\mathrm{eff}}(\\theta)=\\frac{1}{B_{\\mathrm{eff}}(\\theta)}$，于是\n$$\nv=M_{\\mathrm{eff}}(\\theta)\\,f_{\\mathrm{glide}}=\\frac{\\tau\\,\\|\\mathbf{b}\\|}{B_{\\mathrm{s}}\\cos^{2}(\\theta)+B_{\\mathrm{e}}\\sin^{2}(\\theta)}.\n$$\n对于已确定的位错混合角 $\\theta=\\frac{\\pi}{3}$，我们有 $\\cos^{2}(\\theta)=\\left(\\frac{1}{2}\\right)^{2}=\\frac{1}{4}$ 和 $\\sin^{2}(\\theta)=1-\\frac{1}{4}=\\frac{3}{4}$，从而得到\n$$\nB_{\\mathrm{eff}}\\!\\left(\\frac{\\pi}{3}\\right)=\\frac{B_{\\mathrm{s}}}{4}+\\frac{3B_{\\mathrm{e}}}{4}.\n$$\n因此，如果 $B_{\\mathrm{e}}B_{\\mathrm{s}}$，此混合型位错在其耗散权重中更接近于刃型主导，导致在相同 $\\tau$ 下其迁移率低于螺型位错段。相反，如果 $B_{\\mathrm{s}}B_{\\mathrm{e}}$（如在体心立方晶体中由于非平面螺型位错核心而经常观察到的那样），则迁移率更多地受到螺型分量的限制。在面心立方晶体中，在中等温度下，$B_{\\mathrm{s}}$ 和 $B_{\\mathrm{e}}$ 的值可能相当，使得像 $\\theta=\\frac{\\pi}{3}$ 这样的混合型位错段具有中等迁移率；然而，非零的螺型分量也会影响诸如交滑移等机制，而交滑移严格要求 $\\theta=0$。从多尺度角度来看，拖曳和核心结构的原子尺度计算为与位错混合角相关的 $B_{\\mathrm{s}}$ 和 $B_{\\mathrm{e}}$ 提供了信息，这些参数随后通过 $B_{\\mathrm{eff}}(\\theta)$ 进入介观尺度的离散位错动力学中，其中 $\\theta$ 是如上所示由 $\\mathbf{b}$ 和 $\\mathbf{l}$ 计算得出的。",
            "answer": "$$\\boxed{\\frac{\\pi}{3}}$$"
        },
        {
            "introduction": "尽管塑性变形源于大量位错的集体运动，但在宏观工程应用中，我们通常使用能描述材料平均行为的连续介质模型。本练习的核心是实现“径向回归”算法，这是在计算塑性力学中用于积分诸如von Mises等唯象屈服准则的基石 。通过这个实践，您将深刻理解在大型工程有限元软件中塑性本构关系是如何被数值求解的，从而连接起理论屈服面与实际的应力更新计算。",
            "id": "3825969",
            "problem": "实现一个具有线性各向同性硬化的小应变单轴弹塑性应力更新，该更新使用隐式后向欧拉步和特化到一维的径向返回映射逻辑，并计算更新后的 Cauchy 应力。从率无关相关联塑性的第一性原理出发，推导更新方程，然后在一个程序中实现这些方程，以评估指定的测试套件。所有应力以帕斯卡 (Pa) 为单位，所有应变为无量纲量。您的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，列表中的每个条目都是一个以帕斯卡为单位、四舍五入到六位小数的浮点数。\n\n使用以下基础理论。\n- 运动学：对于小应变，总应变满足加法分解 $ \\varepsilon = \\varepsilon^{\\mathrm{e}} + \\varepsilon^{\\mathrm{p}} $。\n- 弹性力学：在单轴形式下，Cauchy 应力为 $ \\sigma = E \\varepsilon^{\\mathrm{e}} $，其中 $ E $ 是杨氏模量。\n- 屈服准则：使用特化到一维的 von Mises (也称为 $ J_2 $) 准则，$f(\\sigma, \\alpha) = |\\sigma| - ( \\sigma_{y0} + H \\alpha ) \\le 0$，其中 $ \\sigma_{y0} $ 是初始屈服应力，$ H $ 是线性各向同性硬化模量，$ \\alpha $ 是与一维塑性应变度量一致的累积硬化变量。\n- 流动法则和硬化定律：假设相关联流动，$\\dot{\\varepsilon}^{\\mathrm{p}} = \\dot{\\gamma} \\operatorname{sgn}(\\sigma)$ 和 $\\dot{\\alpha} = \\dot{\\gamma}$，其中 $\\dot{\\gamma} \\ge 0$。一致性条件为 $f \\le 0$，$ \\dot{\\gamma} \\ge 0 $ 和 $ \\dot{\\gamma} f = 0 $。\n- 时间积分：在一个应变增量 $ \\Delta \\varepsilon $ 上，对非弹性演化方程应用隐式后向欧拉更新。\n\n给定材料参数 $ E $、$ \\sigma_{y0} $ 和 $ H $，以及时间 $ t_n $ 时的先前状态 $ \\sigma_n $ 和 $ \\alpha_n $，以及从 $ t_n $ 到 $ t_{n+1} $ 的总应变增量 $ \\Delta \\varepsilon $，从上述基础理论中推导出一个特化到一维的鲁棒径向返回更新算法，用于计算更新后的 Cauchy 应力 $ \\sigma_{n+1} $（以帕斯卡为单位）和更新后的硬化变量 $ \\alpha_{n+1} $。然后实现该算法，为下面的每个测试用例计算 $ \\sigma_{n+1} $。\n\n使用以下测试套件。对于每个用例，所有应力均以帕斯卡 (Pa) 为单位，所有应变均为无量纲量，输出必须是更新后的 Cauchy 应力 $ \\sigma_{n+1} $，以帕斯卡 (Pa) 为单位，并四舍五入到六位小数。\n- 用例 $1$ (弹性加载)：$ E = 210 \\times 10^{9} $，$ \\sigma_{y0} = 250 \\times 10^{6} $，$ H = 1 \\times 10^{9} $，$ \\sigma_{n} = 200 \\times 10^{6} $，$ \\alpha_{n} = 0 $，$ \\Delta \\varepsilon = 1 \\times 10^{-4} $。\n- 用例 $2$ (屈服开始)：$ E = 210 \\times 10^{9} $，$ \\sigma_{y0} = 250 \\times 10^{6} $，$ H = 1 \\times 10^{9} $，$ \\sigma_{n} = 200 \\times 10^{6} $，$ \\alpha_{n} = 0 $，$ \\Delta \\varepsilon = \\dfrac{50 \\times 10^{6}}{210 \\times 10^{9}} $。\n- 用例 $3$ (带硬化的塑性加载)：$ E = 210 \\times 10^{9} $，$ \\sigma_{y0} = 250 \\times 10^{6} $，$ H = 1 \\times 10^{9} $，$ \\sigma_{n} = 200 \\times 10^{6} $，$ \\alpha_{n} = 0 $，$ \\Delta \\varepsilon = 5 \\times 10^{-4} $。\n- 用例 $4$ (理想塑性极限)：$ E = 210 \\times 10^{9} $，$ \\sigma_{y0} = 250 \\times 10^{6} $，$ H = 0 $，$ \\sigma_{n} = 200 \\times 10^{6} $，$ \\alpha_{n} = 0 $，$ \\Delta \\varepsilon = 5 \\times 10^{-4} $。\n- 用例 $5$ (硬化后的弹性反向加载)：$ E = 210 \\times 10^{9} $，$ \\sigma_{y0} = 250 \\times 10^{6} $，$ H = 2 \\times 10^{9} $，$ \\sigma_{n} = 260 \\times 10^{6} $，$ \\alpha_{n} = 1 \\times 10^{-2} $，$ \\Delta \\varepsilon = -1 \\times 10^{-4} $。\n- 用例 $6$ (塑性压缩)：$ E = 210 \\times 10^{9} $，$ \\sigma_{y0} = 250 \\times 10^{6} $，$ H = 1 \\times 10^{9} $，$ \\sigma_{n} = 0 $，$ \\alpha_{n} = 0 $，$ \\Delta \\varepsilon = -2 \\times 10^{-3} $。\n\n最终输出格式要求：\n- 您的程序应产生单行输出，其中包含一个按用例 $1$ 到 $6$ 顺序排列、用方括号括起来的逗号分隔列表，例如 $[\\text{result1},\\text{result2},\\dots]$。每个条目必须是四舍五入到六位小数的浮点数，单位为帕斯卡。",
            "solution": "问题陈述经评估有效。它在科学上基于已建立的率无关连续介质塑性力学理论，在数学上是适定的，并以客观、明确的方式呈现。所有必要的参数和条件都已提供，以便为每个测试用例确定唯一解。该问题要求推导和实现计算固体力学中的一个标准、典型的算法。\n\n任务是为一个具有线性各向同性硬化的一维小应变弹塑性模型推导并实现一个应力更新算法。本构方程在有限时间步上的积分是使用隐式后向欧拉格式执行的，这导出了径向返回映射算法。\n\n在时间 $t_n$ 的材料状态是已知的，由 Cauchy 应力 $\\sigma_n$ 和累积硬化变量 $\\alpha_n$ 定义。在时间间隔 $[t_n, t_{n+1}]$ 内，材料承受一个总应变增量 $\\Delta \\varepsilon$。目标是计算更新后的应力 $\\sigma_{n+1}$ 和硬化变量 $\\alpha_{n+1}$。\n\n该过程分为三个主要步骤：弹性试算、屈服检查和可能的塑性校正步。\n\n**1. 弹性试算步**\n\n首先，我们假设整个应变增量 $\\Delta \\varepsilon$ 是纯弹性的。这意味着在该增量期间，塑性状态变量没有变化。\n$$ \\Delta \\varepsilon^{\\mathrm{p}} = 0 \\implies \\varepsilon_{n+1}^{\\mathrm{p}} = \\varepsilon_n^{\\mathrm{p}} $$\n$$ \\Delta \\alpha = 0 \\implies \\alpha_{n+1} = \\alpha_n $$\n时间 $t_{n+1}$ 的总应变为 $\\varepsilon_{n+1} = \\varepsilon_n + \\Delta \\varepsilon$。使用应变的加法分解 $\\varepsilon = \\varepsilon^{\\mathrm{e}} + \\varepsilon^{\\mathrm{p}}$，在 $t_{n+1}$ 时的试算弹性应变为：\n$$ \\varepsilon_{n+1}^{\\mathrm{e, trial}} = \\varepsilon_{n+1} - \\varepsilon_{n+1}^{\\mathrm{p}} = (\\varepsilon_n^{\\mathrm{e}} + \\varepsilon_n^{\\mathrm{p}}) + \\Delta \\varepsilon - \\varepsilon_n^{\\mathrm{p}} = \\varepsilon_n^{\\mathrm{e}} + \\Delta \\varepsilon $$\n试算应力 $\\sigma_{n+1}^{\\mathrm{trial}}$ 是使用线性弹性定律 $\\sigma = E \\varepsilon^{\\mathrm{e}}$ 计算的：\n$$ \\sigma_{n+1}^{\\mathrm{trial}} = E \\, \\varepsilon_{n+1}^{\\mathrm{e, trial}} = E (\\varepsilon_n^{\\mathrm{e}} + \\Delta \\varepsilon) $$\n由于 $\\sigma_n = E \\varepsilon_n^{\\mathrm{e}}$，这可以简化为从先前应力状态的直接更新：\n$$ \\sigma_{n+1}^{\\mathrm{trial}} = \\sigma_n + E \\Delta \\varepsilon $$\n\n**2. 屈服检查**\n\n只有当所得的试算应力状态不违反屈服条件时，弹性试算假设才有效。屈服函数由 $f(\\sigma, \\alpha) = |\\sigma| - \\sigma_y(\\alpha)$ 给出，其中当前屈服应力为 $\\sigma_y(\\alpha) = \\sigma_{y0} + H \\alpha$。我们在试算状态 $(\\sigma_{n+1}^{\\mathrm{trial}}, \\alpha_n)$ 下评估屈服函数：\n$$ f^{\\mathrm{trial}} = f(\\sigma_{n+1}^{\\mathrm{trial}}, \\alpha_n) = |\\sigma_{n+1}^{\\mathrm{trial}}| - (\\sigma_{y0} + H \\alpha_n) $$\n有两种可能性：\n- 如果 $f^{\\mathrm{trial}} \\le 0$，则试算状态在屈服面内或屈服面上。弹性变形的假设是正确的。最终更新状态即为试算状态：\n  $$ \\sigma_{n+1} = \\sigma_{n+1}^{\\mathrm{trial}} $$\n  $$ \\alpha_{n+1} = \\alpha_n $$\n- 如果 $f^{\\mathrm{trial}}  0$，则试算状态位于屈服面之外，这在物理上是不允许的。弹性假设是错误的，并且必然发生了塑性变形。需要一个塑性校正步将应力状态返回到更新后的屈服面上。\n\n**3. 塑性校正步 (径向返回)**\n\n当 $f^{\\mathrm{trial}}  0$ 时，发生塑性流动。在 $t_{n+1}$ 的状态必须满足使用隐式后向欧拉格式积分的整套本构方程。塑性应变和硬化变量的增量为：\n$$ \\Delta \\varepsilon^{\\mathrm{p}} = \\varepsilon_{n+1}^{\\mathrm{p}} - \\varepsilon_n^{\\mathrm{p}} = \\Delta\\gamma \\, \\operatorname{sgn}(\\sigma_{n+1}) $$\n$$ \\Delta \\alpha = \\alpha_{n+1} - \\alpha_n = \\Delta\\gamma $$\n其中 $\\Delta\\gamma \\ge 0$ 是有限时间步的一致性参数或塑性乘子增量。\n\n在 $t_{n+1}$ 时的应力-应变关系为：\n$$ \\sigma_{n+1} = E \\varepsilon_{n+1}^{\\mathrm{e}} = E(\\varepsilon_{n+1} - \\varepsilon_{n+1}^{\\mathrm{p}}) = E(\\varepsilon_n + \\Delta\\varepsilon - (\\varepsilon_n^{\\mathrm{p}} + \\Delta\\varepsilon^{\\mathrm{p}})) $$\n$$ \\sigma_{n+1} = E(\\varepsilon_n^{\\mathrm{e}} + \\Delta\\varepsilon - \\Delta\\varepsilon^{\\mathrm{p}}) = \\sigma_n + E\\Delta\\varepsilon - E\\Delta\\varepsilon^{\\mathrm{p}} $$\n识别出试算应力项 $\\sigma_{n+1}^{\\mathrm{trial}} = \\sigma_n + E \\Delta \\varepsilon$，我们有：\n$$ \\sigma_{n+1} = \\sigma_{n+1}^{\\mathrm{trial}} - E \\Delta\\varepsilon^{\\mathrm{p}} $$\n代入流动法则：\n$$ \\sigma_{n+1} = \\sigma_{n+1}^{\\mathrm{trial}} - E \\Delta\\gamma \\, \\operatorname{sgn}(\\sigma_{n+1}) $$\n此方程表明，最终应力 $\\sigma_{n+1}$ 是从试算应力 $\\sigma_{n+1}^{\\mathrm{trial}}$ “返回”得到的。对于塑性步，最终状态必须位于扩展后的屈服面上，满足一致性条件 $f(\\sigma_{n+1}, \\alpha_{n+1}) = 0$：\n$$ |\\sigma_{n+1}| - (\\sigma_{y0} + H \\alpha_{n+1}) = 0 $$\n代入硬化定律 $\\alpha_{n+1} = \\alpha_n + \\Delta\\gamma$：\n$$ |\\sigma_{n+1}| = \\sigma_{y0} + H(\\alpha_n + \\Delta\\gamma) = (\\sigma_{y0} + H\\alpha_n) + H\\Delta\\gamma $$\n\n我们现在有一个包含两个方程的方程组，用于求解两个未知数 $\\sigma_{n+1}$ 和 $\\Delta\\gamma$。一个关键的观察是，返回路径不改变应力的符号，因此 $\\operatorname{sgn}(\\sigma_{n+1}) = \\operatorname{sgn}(\\sigma_{n+1}^{\\mathrm{trial}})$。对应力返回方程取绝对值（并注意 $|\\operatorname{sgn}(\\sigma_{n+1})| = 1$）：\n$$ |\\sigma_{n+1}| = |\\sigma_{n+1}^{\\mathrm{trial}} - E \\Delta\\gamma \\, \\operatorname{sgn}(\\sigma_{n+1})| = |\\sigma_{n+1}^{\\mathrm{trial}}| - E \\Delta\\gamma $$\n将此与屈服条件相等：\n$$ |\\sigma_{n+1}^{\\mathrm{trial}}| - E \\Delta\\gamma = (\\sigma_{y0} + H\\alpha_n) + H\\Delta\\gamma $$\n求解 $\\Delta\\gamma$：\n$$ |\\sigma_{n+1}^{\\mathrm{trial}}| - (\\sigma_{y0} + H\\alpha_n) = (E+H)\\Delta\\gamma $$\n左边的项正是试算屈服函数值 $f^{\\mathrm{trial}}$。因此，塑性乘子确定为：\n$$ \\Delta\\gamma = \\frac{f^{\\mathrm{trial}}}{E+H} $$\n由于我们处于塑性情况，$f^{\\mathrm{trial}}  0$。因为 $E  0$ 且 $H \\ge 0$，所以 $\\Delta\\gamma  0$，这与其定义一致。\n\n在 $\\Delta\\gamma$ 已知后，就可以计算最终的状态变量。\n更新后的应力为：\n$$ \\sigma_{n+1} = \\sigma_{n+1}^{\\mathrm{trial}} - E \\Delta\\gamma \\, \\operatorname{sgn}(\\sigma_{n+1}^{\\mathrm{trial}}) $$\n更新后的硬化变量为：\n$$ \\alpha_{n+1} = \\alpha_n + \\Delta\\gamma $$\n\n**算法总结**\n对于给定的状态 $(\\sigma_n, \\alpha_n)$、材料参数 $(E, \\sigma_{y0}, H)$ 和应变增量 $\\Delta \\varepsilon$：\n1.  计算试算应力：$\\sigma_{n+1}^{\\mathrm{trial}} = \\sigma_n + E \\Delta \\varepsilon$。\n2.  计算增量开始时的屈服应力：$\\sigma_y(\\alpha_n) = \\sigma_{y0} + H \\alpha_n$。\n3.  通过评估试算屈服函数来检查是否屈服：$f^{\\mathrm{trial}} = |\\sigma_{n+1}^{\\mathrm{trial}}| - \\sigma_y(\\alpha_n)$。\n4.  如果 $f^{\\mathrm{trial}} \\le 0$ (弹性步)：\n    -   $\\sigma_{n+1} = \\sigma_{n+1}^{\\mathrm{trial}}$\n    -   $\\alpha_{n+1} = \\alpha_n$\n5.  如果 $f^{\\mathrm{trial}}  0$ (塑性步)：\n    -   计算塑性乘子：$\\Delta\\gamma = f^{\\mathrm{trial}} / (E+H)$。\n    -   更新应力：$\\sigma_{n+1} = \\sigma_{n+1}^{\\mathrm{trial}} - E \\Delta\\gamma \\operatorname{sgn}(\\sigma_{n+1}^{\\mathrm{trial}})$。\n    -   更新硬化变量：$\\alpha_{n+1} = \\alpha_n + \\Delta\\gamma$。\n该算法被实现用来评估所提供的测试套件。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the updated Cauchy stress for a series of uniaxial elastoplastic\n    test cases using a 1D radial return mapping algorithm.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a dictionary of parameters.\n    test_cases = [\n        # Case 1 (elastic loading)\n        {\"E\": 210e9, \"sigma_y0\": 250e6, \"H\": 1e9, \"sigma_n\": 200e6, \"alpha_n\": 0, \"delta_eps\": 1e-4},\n        # Case 2 (onset of yielding)\n        {\"E\": 210e9, \"sigma_y0\": 250e6, \"H\": 1e9, \"sigma_n\": 200e6, \"alpha_n\": 0, \"delta_eps\": 50e6 / 210e9},\n        # Case 3 (plastic loading with hardening)\n        {\"E\": 210e9, \"sigma_y0\": 250e6, \"H\": 1e9, \"sigma_n\": 200e6, \"alpha_n\": 0, \"delta_eps\": 5e-4},\n        # Case 4 (perfect plasticity limit)\n        {\"E\": 210e9, \"sigma_y0\": 250e6, \"H\": 0, \"sigma_n\": 200e6, \"alpha_n\": 0, \"delta_eps\": 5e-4},\n        # Case 5 (elastic reverse loading after hardening)\n        {\"E\": 210e9, \"sigma_y0\": 250e6, \"H\": 2e9, \"sigma_n\": 260e6, \"alpha_n\": 1e-2, \"delta_eps\": -1e-4},\n        # Case 6 (plastic compression)\n        {\"E\": 210e9, \"sigma_y0\": 250e6, \"H\": 1e9, \"sigma_n\": 0, \"alpha_n\": 0, \"delta_eps\": -2e-3},\n    ]\n\n    results = []\n    for case in test_cases:\n        # Extract parameters for the current case\n        E = case[\"E\"]\n        sigma_y0 = case[\"sigma_y0\"]\n        H = case[\"H\"]\n        sigma_n = case[\"sigma_n\"]\n        alpha_n = case[\"alpha_n\"]\n        delta_eps = case[\"delta_eps\"]\n\n        # Step 1: Elastic Trial Step\n        # Compute the trial stress\n        sigma_trial = sigma_n + E * delta_eps\n\n        # Step 2: Yield Check\n        # Compute the current yield stress based on the state at step n\n        sigma_y_n = sigma_y0 + H * alpha_n\n        \n        # Evaluate the yield function at the trial state\n        f_trial = abs(sigma_trial) - sigma_y_n\n\n        # Step 3  4: Determine Final State (Elastic or Plastic)\n        if f_trial = 0:\n            # Elastic step: The trial state is the final state.\n            sigma_np1 = sigma_trial\n            # alpha_np1 = alpha_n # No change in hardening variable\n        else:\n            # Plastic step: Apply plastic corrector (radial return)\n            # The denominator (E+H) can be zero if E=-H, which is not physically\n            # realistic for this model. For H=0 (perfect plasticity), E+H=E > 0.\n            # Handle the case where H is zero to prevent division by zero if E were zero.\n            # However, E > 0 is a physical requirement for elastic materials.\n            if E + H == 0:\n                raise ValueError(\"E + H must be positive.\")\n\n            # Calculate the plastic multiplier increment\n            delta_gamma = f_trial / (E + H)\n\n            # Update stress using the radial return formula\n            sigma_np1 = sigma_trial - E * delta_gamma * np.sign(sigma_trial)\n            \n            # Update the hardening variable\n            # alpha_np1 = alpha_n + delta_gamma\n\n        # Round the final stress to six decimal places as required\n        rounded_result = round(sigma_np1, 6)\n        results.append(rounded_result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "多尺度建模的一个核心问题是：我们需要模拟多大尺寸的材料，才能准确捕捉其等效的宏观性能？本练习将带您直面这一挑战，引入并实践“代表性体积单元”（RVE）的概念 。您将通过一个计算实验，生成基于位错密度场的随机微观结构，并对其力学响应进行统计分析以确定RVE的尺寸，从而亲身体验如何从非均匀的微观世界过渡到均匀的宏观世界。",
            "id": "3825950",
            "problem": "您的任务是构建一个计算程序，通过量化均质化响应的方差如何随着采样体积尺寸的增加而减小，来确定塑性代表性体积单元（RVE）的大小。此过程将使用多个微观结构实现。设定是在二维域中，材料具有标量弹塑性行为并承受单轴应变，其局部塑性屈服由基于位错的定律控制。基本理论基础包括线性弹性的胡克定律、线性各向同性硬化法则、泰勒位错强化关系以及标准的均质化定义。\n\n请从以下原理和定义开始：\n- 胡克定律（线性弹性，一维）：对于局部应变 $\\varepsilon$ 和局部弹性模量 $E$，局部应力 $\\sigma$ 为 $\\sigma = E\\varepsilon$，直到发生屈服。\n- 线性各向同性硬化：屈服后，局部应力演变为 $\\sigma = \\sigma_y + H(\\varepsilon - \\sigma_y / E)$，其中 $H$ 是恒定的塑性切线模量，$\\sigma_y$ 是局部屈服应力。\n- 泰勒位错强化关系：局部屈服应力为 $\\sigma_y = \\alpha G b \\sqrt{\\rho}$，其中 $\\alpha$ 是一个无量纲常数，$G$ 是剪切模量，$b$ 是伯格斯矢量的大小，$\\rho$ 是局部-位错密度。\n- Voigt均质化（均匀应变假设）：在施加的宏观应变 $\\bar{\\varepsilon}$ 下，宏观应力 $\\bar{\\sigma}$ 是局部应力的空间平均值，即 $\\bar{\\sigma} = \\langle \\sigma \\rangle$。\n- 代表性体积单元 (RVE)：最小的域尺寸 $L$，使得在多个独立的微观结构实现上，均质化响应的变异系数低于预设的容差 $\\epsilon_{\\mathrm{tol}}$，即 $\\mathrm{COV}(L) = s(L)/m(L) \\le \\epsilon_{\\mathrm{tol}}$，其中 $m(L)$ 和 $s(L)$ 分别是对于给定的域尺寸 $L$，在所有实现中 $\\bar{\\sigma}$ 的样本均值和样本标准差（自由度差值为 $\\mathrm{ddof}=1$）。\n\n微观结构模型：\n- 局部-位错密度 $\\rho(\\mathbf{x})$ 被建模为一个平稳对数正态随机场，该随机场源自一个相关长度为 $\\ell$ 的高斯协方差的相关高斯场 $g(\\mathbf{x})\\sim\\mathcal{N}(0,1)$。设 $\\rho(\\mathbf{x}) = \\rho_0 \\exp(\\sigma_g g(\\mathbf{x}) - \\frac{1}{2}\\sigma_g^2 )$，因此 $\\mathbb{E}[\\rho] = \\rho_0$。相关高斯场是通过对白噪声进行谱滤波生成的，具体方法是在波数空间中使用宽度为 $\\ell$ 的高斯滤波器。\n\n在施加的宏观应变 $\\bar{\\varepsilon}$ 下的局部本构响应：\n- 对于每个具有局部 $\\sigma_y$ 的单元，计算 $\\varepsilon_y = \\sigma_y / E$。然后，局部应力为\n$$\n\\sigma(\\mathbf{x};\\bar{\\varepsilon}) = \n\\begin{cases}\nE\\bar{\\varepsilon},  \\bar{\\varepsilon} \\le \\varepsilon_y(\\mathbf{x}),\\\\\n\\sigma_y(\\mathbf{x}) + H(\\bar{\\varepsilon} - \\varepsilon_y(\\mathbf{x})),  \\bar{\\varepsilon}  \\varepsilon_y(\\mathbf{x}).\n\\end{cases}\n$$\n宏观应力是空间平均值 $\\bar{\\sigma} = \\langle \\sigma(\\mathbf{x};\\bar{\\varepsilon}) \\rangle$。\n\n计算步骤：\n- 对于每个候选域尺寸 $L$（边长为L的正方形域），将其均匀离散化为间距为 $\\Delta x$ 的网格，因此每边有 $N = \\lfloor L / \\Delta x \\rfloor$ 个单元。对于每次实现：\n    1. 使用谱滤波方法生成一个相关高斯场 $g(\\mathbf{x})$，方法是将白噪声的离散傅里叶变换乘以 $\\exp(-\\frac{1}{2}\\ell^2 \\|\\mathbf{k}\\|^2)$，其中 $\\mathbf{k}$ 是波数矢量，$\\ell$ 的长度单位与 $\\Delta x$ 相同。\n    2. 通过上述的对数正态映射构建位错密度 $\\rho(\\mathbf{x})$。\n    3. 计算 $\\sigma_y(\\mathbf{x}) = \\alpha G b \\sqrt{\\rho(\\mathbf{x})}$。\n    4. 使用包含 $E$ 和 $H$ 的分段线性法则，通过平均在 $\\bar{\\varepsilon}$ 下的局部应力来计算 $\\bar{\\sigma}$。\n- 在 $n_{\\mathrm{real}}$ 次实现中，计算样本均值 $m(L)$ 和样本标准差 $s(L)$，并构成 $\\mathrm{COV}(L) = s(L)/m(L)$。\n- RVE尺寸是所提供的候选列表中满足 $\\mathrm{COV}(L) \\le \\epsilon_{\\mathrm{tol}}$ 的最小 $L$。如果没有候选尺寸满足该标准，则返回 $-1$。\n\n物理单位和输出：\n- 在内部应力计算中使用帕斯卡（Pa），但报告RVE尺寸时使用微米（$\\mu$m）。应变 $\\bar{\\varepsilon}$ 是无量纲的。伯格斯矢量 $b$ 必须以纳米（nm）为单位提供，并转换为米（m）。剪切模量 $G$、弹性模量 $E$ 和硬化模量 $H$ 以吉帕斯卡（GPa）为单位提供，并在计算中转换为帕斯卡（Pa）。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，例如 $[\\text{结果1},\\text{结果2},\\text{结果3}]$。每个结果必须是所选的RVE尺寸（以 $\\mu$m 为单位的浮点数），如果没有任何候选尺寸满足容差，则为整数 $-1$。\n\n测试套件：\n评估以下四个测试用例。每个测试用例以带单位的有序参数元组形式给出。程序必须嵌入这些参数并产生所需的输出。\n\n- 测试用例 1（典型异质性，中等相关性）：\n    - $\\Delta x = 1.0\\,\\mu\\mathrm{m}$，\n    - $\\ell = 2.0\\,\\mu\\mathrm{m}$，\n    - $\\sigma_g = 0.5$，\n    - $\\rho_0 = 1.0\\times 10^{14}\\,\\mathrm{m}^{-2}$，\n    - $\\alpha = 0.3$，\n    - $G = 26.0\\,\\mathrm{GPa}$，\n    - $b = 0.286\\,\\mathrm{nm}$，\n    - $E = 70.0\\,\\mathrm{GPa}$，\n    - $H = 1.0\\,\\mathrm{GPa}$，\n    - $\\bar{\\varepsilon} = 0.005$，\n    - 候选尺寸 $L \\in [5.0,\\,10.0,\\,20.0,\\,40.0]\\,\\mu\\mathrm{m}$，\n    - $n_{\\mathrm{real}} = 20$，\n    - $\\epsilon_{\\mathrm{tol}} = 0.02$，\n    - 随机种子 $s = 12345$。\n\n- 测试用例 2（更强异质性，大相关性）：\n    - $\\Delta x = 2.0\\,\\mu\\mathrm{m}$，\n    - $\\ell = 10.0\\,\\mu\\mathrm{m}$，\n    - $\\sigma_g = 0.8$，\n    - $\\rho_0 = 1.0\\times 10^{14}\\,\\mathrm{m}^{-2}$，\n    - $\\alpha = 0.3$，\n    - $G = 26.0\\,\\mathrm{GPa}$，\n    - $b = 0.286\\,\\mathrm{nm}$，\n    - $E = 70.0\\,\\mathrm{GPa}$，\n    - $H = 2.0\\,\\mathrm{GPa}$，\n    - $\\bar{\\varepsilon} = 0.005$，\n    - 候选尺寸 $L \\in [20.0,\\,40.0,\\,80.0]\\,\\mu\\mathrm{m}$，\n    - $n_{\\mathrm{real}} = 30$，\n    - $\\epsilon_{\\mathrm{tol}} = 0.03$，\n    - 随机种子 $s = 2468$。\n\n- 测试用例 3（严格容差，有限实现；可能无法满足标准）：\n    - $\\Delta x = 1.0\\,\\mu\\mathrm{m}$，\n    - $\\ell = 5.0\\,\\mu\\mathrm{m}$，\n    - $\\sigma_g = 0.9$，\n    - $\\rho_0 = 1.0\\times 10^{14}\\,\\mathrm{m}^{-2}$，\n    - $\\alpha = 0.3$，\n    - $G = 26.0\\,\\mathrm{GPa}$，\n    - $b = 0.286\\,\\mathrm{nm}$，\n    - $E = 70.0\\,\\mathrm{GPa}$，\n    - $H = 1.5\\,\\mathrm{GPa}$，\n    - $\\bar{\\varepsilon} = 0.005$，\n    - 候选尺寸 $L \\in [5.0,\\,10.0,\\,15.0]\\,\\mu\\mathrm{m}$，\n    - $n_{\\mathrm{real}} = 10$，\n    - $\\epsilon_{\\mathrm{tol}} = 0.01$，\n    - 随机种子 $s = 13579$。\n\n- 测试用例 4（弱异质性，短相关性）：\n    - $\\Delta x = 0.5\\,\\mu\\mathrm{m}$，\n    - $\\ell = 0.5\\,\\mu\\mathrm{m}$，\n    - $\\sigma_g = 0.4$，\n    - $\\rho_0 = 1.0\\times 10^{14}\\,\\mathrm{m}^{-2}$，\n    - $\\alpha = 0.3$，\n    - $G = 26.0\\,\\mathrm{GPa}$，\n    - $b = 0.286\\,\\mathrm{nm}$，\n    - $E = 70.0\\,\\mathrm{GPa}$，\n    - $H = 1.0\\,\\mathrm{GPa}$，\n    - $\\bar{\\varepsilon} = 0.005$，\n    - 候选尺寸 $L \\in [2.0,\\,4.0,\\,8.0]\\,\\mu\\mathrm{m}$，\n    - $n_{\\mathrm{real}} = 25$，\n    - $\\epsilon_{\\mathrm{tol}} = 0.02$，\n    - 随机种子 $s = 9876$。\n\n您的程序必须精确实现上述步骤，并以单行输出格式 $[r_1,r_2,r_3,r_4]$ 返回四个测试用例中每个用例所选的RVE尺寸，其中每个 $r_i$ 是一个以 $\\mu$m 为单位的浮点数，如果没有任何候选尺寸满足标准，则为整数 $-1$。",
            "solution": "该问题是有效的，因为它在科学上植根于连续介质力学和计算材料科学的原理，定义明确，目标清晰，参数完整，并使用客观、正式的语言。确定代表性体积单元（RVE）尺寸的程序是多尺度建模中的一种标准方法。\n\n解决方案是通过实现一个计算程序来构建的，该程序模拟空间异质材料的力学响应，并分析其均质化属性的统计收敛性。核心目标是找到最小的域尺寸，即RVE，在该尺寸下材料的有效响应具有统计代表性。这通过要求在多个独立的微观结构实现中，均质化应力的变异系数（COV）低于预设容差 $\\epsilon_{\\mathrm{tol}}$ 来量化。\n\n该程序的基本步骤如下：\n\n1.  **建模材料异质性：** 异质性的来源是随空间变化的局部塑性屈服应力 $\\sigma_y(\\mathbf{x})$。这种变化在物理上源于晶体缺陷（特别是位错）的非均匀分布。局部屈服应力由泰勒位错强化关系决定：\n    $$\n    \\sigma_y(\\mathbf{x}) = \\alpha G b \\sqrt{\\rho(\\mathbf{x})}\n    $$\n    其中 $\\alpha$ 是一个几何常数， $G$ 是剪切模量， $b$ 是伯格斯矢量的大小，而 $\\rho(\\mathbf{x})$ 是局部-位错密度。位错密度本身被建模为一个平稳对数正态随机场。这种选择确保了 $\\rho(\\mathbf{x})$ 始终为正。使用了以下特定形式：\n    $$\n    \\rho(\\mathbf{x}) = \\rho_0 \\exp\\left(\\sigma_g g(\\mathbf{x}) - \\frac{1}{2}\\sigma_g^2\\right)\n    $$\n    在此，$g(\\mathbf{x})$ 是一个标准化的相关高斯随机场，均值为零，方差为一，即 $g(\\mathbf{x}) \\sim \\mathcal{N}(0,1)$。参数 $\\sigma_g$ 控制波动的幅度，表达式的形式被选择以使得位错密度的期望值为 $\\mathbb{E}[\\rho] = \\rho_0$。\n\n2.  **生成相关随机场：** 空间相关的的高斯场 $g(\\mathbf{x})$ 是使用谱方法数值生成的。这种标准技术涉及在傅里叶（波数）域中对白噪声进行滤波。\n    - 在空间域中生成从标准正态分布中抽取的不相关随机数网格。这代表白噪声。\n    - 使用二维快速傅里叶变换（FFT）将此网格转换到波数域。\n    - 在此域中，应用一个乘性高斯滤波器：\n      $$\n      F(\\mathbf{k}) = \\exp\\left(-\\frac{1}{2}\\ell^2 \\|\\mathbf{k}\\|^2\\right)\n      $$\n      其中 $\\mathbf{k}$ 是波数矢量，$\\ell$ 是相关长度，它决定了微观结构特征的特征尺寸。\n    - 使用逆FFT将滤波后的场变换回空间域。取结果的实部。\n    - 为确保该场正确表示 $g(\\mathbf{x}) \\sim \\mathcal{N}(0,1)$ 的一个实现，通过减去样本均值并除以样本标准差来对其值进行经验标准化。\n\n3.  **本构响应与均质化：** 材料的整体行为是通过假设一个均匀应变场（Voigt均质化）来确定的，其中域中的每个点都承受相同的宏观应变 $\\bar{\\varepsilon}$。然后基于分段线性本构定律计算局部应力 $\\sigma(\\mathbf{x})$。\n    - 首先，找到局部弹性应变极限：$\\varepsilon_y(\\mathbf{x}) = \\sigma_y(\\mathbf{x}) / E$，其中 $E$ 是弹性模量。\n    - 如果施加的应变 $\\bar{\\varepsilon}$ 小于或等于局部屈服应变，则响应是纯弹性的（胡克定律）：$\\sigma(\\mathbf{x}) = E \\bar{\\varepsilon}$。\n    - 如果施加的应变超过局部屈服应变，该点的材料会发生塑性变形，应力由线性各向同性硬化法则给出：$\\sigma(\\mathbf{x}) = \\sigma_y(\\mathbf{x}) + H(\\bar{\\varepsilon} - \\varepsilon_y(\\mathbf{x}))$，其中 $H$ 是塑性切线模量。\n    - 宏观应力 $\\bar{\\sigma}$ 是局部应力场的体积平均值：\n      $$\n      \\bar{\\sigma} = \\langle \\sigma(\\mathbf{x}; \\bar{\\varepsilon}) \\rangle = \\frac{1}{V} \\int_V \\sigma(\\mathbf{x}; \\bar{\\varepsilon}) \\, dV\n      $$\n      对于离散网格，该积分变为简单的算术平均。\n\n4.  **通过统计分析确定RVE：** RVE尺寸是通过评估 $\\bar{\\sigma}$ 作为域尺寸 $L$ 的函数的统计稳定性来确定的。\n    - 对于给定列表中的每个候选尺寸 $L$，将域离散化为 $N \\times N$ 单元的网格，其中 $N = \\lfloor L / \\Delta x \\rfloor$ 且 $\\Delta x$ 是固定的网格间距。\n    - 生成一组 $n_{\\mathrm{real}}$ 个独立的微观结构实现。对于每个实现，按上述方法计算相应的宏观应力 $\\bar{\\sigma}$。\n    - 这为域尺寸 $L$ 提供了一个包含 $n_{\\mathrm{real}}$ 个 $\\bar{\\sigma}$ 值的样本。计算样本均值 $m(L)$ 和样本标准差 $s(L)$（使用除数 $n_{\\mathrm{real}}-1$，或 $\\mathrm{ddof}=1$）。\n    - 计算变异系数：$\\mathrm{COV}(L) = s(L)/m(L)$。\n    - RVE尺寸被确定为列表中满足 $\\mathrm{COV}(L) \\le \\epsilon_{\\mathrm{tol}}$ 的最小候选尺寸 $L$。如果没有候选尺寸满足此标准，则结论为在测试范围内未达到RVE尺寸。\n\n所有带单位的物理量（模量、长度）在计算前都转换为一致的国际单位制（SI）基本单位（帕斯卡、米）以确保正确性。最终报告的RVE尺寸会转换回指定的单位微米。对每个测试用例使用固定的随机种子可确保结果的计算可复现性。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_single_realization_stress(L, dx, ell, sigma_g, rho_0, alpha, G, b, E, H, bar_epsilon, rng):\n    \"\"\"\n    Computes the homogenized stress for a single microstructure realization.\n    All length units are handled in micrometers for grid setup and passed as SI for calculation.\n    All stress/modulus units are handled in GPa and passed as SI for calculation.\n    \"\"\"\n    # 1. Unit conversions to base SI\n    L_m = L * 1e-6\n    dx_m = dx * 1e-6\n    ell_m = ell * 1e-6\n    G_pa = G * 1e9\n    b_m = b * 1e-9\n    E_pa = E * 1e9\n    H_pa = H * 1e9\n\n    # 2. Grid setup\n    N = int(np.floor(L / dx))\n    if N == 0:\n        return np.nan\n\n    # 3. Generate correlated Gaussian random field g(x)\n    # 3a. Wavenumber grid\n    freq = np.fft.fftfreq(N, d=dx_m)  # Frequencies in cycles/meter\n    kx_grid, ky_grid = np.meshgrid(freq, freq)\n    k_grid_sq = (2 * np.pi * kx_grid)**2 + (2 * np.pi * ky_grid)**2\n\n    # 3b. Gaussian filter in Fourier space\n    gaussian_filter = np.exp(-0.5 * (ell_m**2) * k_grid_sq)\n    \n    # 3c. Generate field from white noise\n    white_noise = rng.standard_normal(size=(N, N))\n    fft_white_noise = np.fft.fft2(white_noise)\n    \n    fft_filtered = fft_white_noise * gaussian_filter\n    g_field_raw = np.fft.ifft2(fft_filtered).real\n\n    # 3d. Normalize the field to have zero mean and unit variance\n    g_field_mean = np.mean(g_field_raw)\n    g_field_std = np.std(g_field_raw)\n    if g_field_std  1e-15:\n        g_field = np.zeros((N, N))\n    else:\n        g_field = (g_field_raw - g_field_mean) / g_field_std\n\n    # 4. Construct dislocation density field rho(x) via lognormal mapping\n    rho_field = rho_0 * np.exp(sigma_g * g_field - 0.5 * sigma_g**2)\n\n    # 5. Compute local yield stress field sigma_y(x) using Taylor relation\n    sigma_y_field = alpha * G_pa * b_m * np.sqrt(rho_field)\n\n    # 6. Compute local stress sigma(x) under imposed strain bar_epsilon\n    epsilon_y_field = sigma_y_field / E_pa\n    \n    sigma_field = np.where(bar_epsilon = epsilon_y_field,\n                           E_pa * bar_epsilon,\n                           sigma_y_field + H_pa * (bar_epsilon - epsilon_y_field))\n\n    # 7. Compute homogenized stress (Voigt average)\n    bar_sigma = np.mean(sigma_field)\n    \n    return bar_sigma\n\ndef find_rve_size(params):\n    \"\"\"\n    Finds the RVE size for a single test case by iterating through candidate sizes.\n    \"\"\"\n    (dx, ell, sigma_g, rho_0, alpha, G, b, E, H, \n     bar_epsilon, L_candidates, n_real, epsilon_tol, seed) = params\n    \n    rng = np.random.default_rng(seed)\n\n    for L in L_candidates:\n        homogenized_stresses = []\n        for _ in range(n_real):\n            bar_sigma = compute_single_realization_stress(\n                L, dx, ell, sigma_g, rho_0, alpha, G, b, E, H, bar_epsilon, rng\n            )\n            homogenized_stresses.append(bar_sigma)\n        \n        homogenized_stresses = np.array(homogenized_stresses)\n        \n        if np.isnan(homogenized_stresses).any():\n            continue\n            \n        # Compute sample mean and sample standard deviation (ddof=1)\n        m_L = np.mean(homogenized_stresses)\n        s_L = np.std(homogenized_stresses, ddof=1)\n        \n        cov_L = s_L / m_L if np.abs(m_L) > 1e-9 else np.inf\n        \n        if cov_L = epsilon_tol:\n            return float(L)\n            \n    return -1\n\ndef solve():\n    \"\"\"\n    Main function to define test cases, run the RVE analysis, and print results.\n    \"\"\"\n    test_cases = [\n        # Test case 1\n        {'dx': 1.0, 'ell': 2.0, 'sigma_g': 0.5, 'rho_0': 1.0e14, 'alpha': 0.3,\n         'G': 26.0, 'b': 0.286, 'E': 70.0, 'H': 1.0, 'bar_epsilon': 0.005,\n         'L_candidates': [5.0, 10.0, 20.0, 40.0], 'n_real': 20, 'epsilon_tol': 0.02,\n         'seed': 12345},\n        # Test case 2\n        {'dx': 2.0, 'ell': 10.0, 'sigma_g': 0.8, 'rho_0': 1.0e14, 'alpha': 0.3,\n         'G': 26.0, 'b': 0.286, 'E': 70.0, 'H': 2.0, 'bar_epsilon': 0.005,\n         'L_candidates': [20.0, 40.0, 80.0], 'n_real': 30, 'epsilon_tol': 0.03,\n         'seed': 2468},\n        # Test case 3\n        {'dx': 1.0, 'ell': 5.0, 'sigma_g': 0.9, 'rho_0': 1.0e14, 'alpha': 0.3,\n         'G': 26.0, 'b': 0.286, 'E': 70.0, 'H': 1.5, 'bar_epsilon': 0.005,\n         'L_candidates': [5.0, 10.0, 15.0], 'n_real': 10, 'epsilon_tol': 0.01,\n         'seed': 13579},\n        # Test case 4\n        {'dx': 0.5, 'ell': 0.5, 'sigma_g': 0.4, 'rho_0': 1.0e14, 'alpha': 0.3,\n         'G': 26.0, 'b': 0.286, 'E': 70.0, 'H': 1.0, 'bar_epsilon': 0.005,\n         'L_candidates': [2.0, 4.0, 8.0], 'n_real': 25, 'epsilon_tol': 0.02,\n         'seed': 9876},\n    ]\n\n    results = []\n    for case in test_cases:\n        params_tuple = (\n            case['dx'], case['ell'], case['sigma_g'], case['rho_0'], case['alpha'],\n            case['G'], case['b'], case['E'], case['H'], case['bar_epsilon'],\n            case['L_candidates'], case['n_real'], case['epsilon_tol'], case['seed']\n        )\n        result = find_rve_size(params_tuple)\n        results.append(result)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}