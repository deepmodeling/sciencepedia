{
    "hands_on_practices": [
        {
            "introduction": "The brute-force calculation of the full elastic tensor is computationally demanding and often unnecessary. The key to efficient first-principles calculations lies in exploiting the crystal's intrinsic symmetry to design a minimal, targeted set of simulations. This practice challenges you to construct these symmetry-adapted strain sets for cubic, hexagonal, and orthorhombic systems, a foundational skill for designing efficient computational experiments .",
            "id": "3794393",
            "problem": "You are tasked with designing minimal symmetry-adapted homogeneous strain protocols for three crystal classes within the small-strain, zero-temperature limit, as used in first-principles calculations of elastic constants. Work in the regime where the total energy difference from the unstrained reference, obtained from Density Functional Theory (DFT), is well described by a quadratic form in the strain. In Voigt notation, denote the strain vector by $\\boldsymbol{\\epsilon} = (\\epsilon_{1}, \\epsilon_{2}, \\epsilon_{3}, \\epsilon_{4}, \\epsilon_{5}, \\epsilon_{6})$, with $(\\epsilon_{1}, \\epsilon_{2}, \\epsilon_{3})$ the normal strains and $(\\epsilon_{4}, \\epsilon_{5}, \\epsilon_{6})$ the engineering shear strains. The elastic energy density relative to the ground state is \n$$\n\\Delta E/V = \\frac{1}{2}\\,\\sum_{i=1}^{6}\\sum_{j=1}^{6} C_{ij}\\,\\epsilon_{i}\\,\\epsilon_{j},\n$$\nwhere $C_{ij}$ are the components of the elastic stiffness tensor in the crystallographic axes.\n\nStarting from this quadratic energy law, and using only symmetry constraints and the mapping between strain and energy, construct for each of the following crystal classes a minimal set of symmetry-adapted homogeneous strain vectors $\\{\\boldsymbol{\\epsilon}^{(k)}\\}$ such that fitting $\\Delta E(\\boldsymbol{\\epsilon}^{(k)})$ as a function of a single scalar strain amplitude for each $\\boldsymbol{\\epsilon}^{(k)}$ suffices to determine all independent elastic constants of the class without ill-conditioning and without requiring mixed multi-parameter fits:\n\n- Cubic crystals.\n- Hexagonal crystals.\n- Orthorhombic crystals.\n\nYour construction must be scientifically sound: each chosen strain must be compatible with the crystal symmetry (e.g., aligned with principal symmetry axes or symmetry-related shear) and must lead to either a single stiffness component or a linearly independent combination from which the full independent set can be solved. State explicitly the proposed strain vectors in Voigt components and justify that the resulting set is minimal and invertible for extracting the independent elastic constants via second-order energy fits.\n\nFinally, compute the minimal total number of distinct strain states across all three classes combined under the above constraints. Provide this total as the final answer. No rounding is required. The final answer is a pure number with no units.",
            "solution": "The problem requires the construction of minimal sets of symmetry-adapted homogeneous strain vectors to determine the full set of independent elastic constants for cubic, hexagonal, and orthorhombic crystal classes from first-principles energy calculations. The foundation of this task is the elastic energy density relationship in the small-strain limit, given in Voigt notation as:\n$$\n\\frac{\\Delta E}{V} = \\frac{1}{2} \\sum_{i=1}^{6} \\sum_{j=1}^{6} C_{ij} \\epsilon_{i} \\epsilon_{j}\n$$\nwhere $V$ is the volume of the reference cell, $\\Delta E$ is the change in total energy, $\\boldsymbol{\\epsilon} = (\\epsilon_{1}, \\epsilon_{2}, \\epsilon_{3}, \\epsilon_{4}, \\epsilon_{5}, \\epsilon_{6})$ is the strain vector, and $C_{ij}$ are the elements of the stiffness tensor. The strains $\\epsilon_1, \\epsilon_2, \\epsilon_3$ are normal strains, and $\\epsilon_4, \\epsilon_5, \\epsilon_6$ are engineering shear strains.\n\nFor a specific strain protocol defined by a single scalar parameter $\\delta$ such that $\\boldsymbol{\\epsilon}^{(k)} = \\delta \\cdot \\mathbf{v}^{(k)}$ where $\\mathbf{v}^{(k)}$ is a constant vector, the energy density becomes:\n$$\n\\frac{\\Delta E(\\delta)}{V} = \\frac{1}{2} \\delta^2 \\left( \\sum_{i=1}^{6} \\sum_{j=1}^{6} C_{ij} v_{i}^{(k)} v_{j}^{(k)} \\right)\n$$\nThe second derivative of the total energy with respect to the strain parameter $\\delta$, evaluated at $\\delta=0$, provides a linear combination of the elastic constants:\n$$\n\\frac{1}{V} \\frac{\\partial^2 (\\Delta E)}{\\partial \\delta^2} \\bigg|_{\\delta=0} = \\sum_{i=1}^{6} \\sum_{j=1}^{6} C_{ij} v_{i}^{(k)} v_{j}^{(k)}\n$$\nBy designing a set of $N$ linearly independent strain vectors $\\{\\mathbf{v}^{(k)}\\}$, we can generate a system of $N$ linear equations. If $N$ is equal to the number of independent elastic constants for a given crystal class, and the resulting system of equations is invertible, the set of strains is minimal and sufficient.\n\nWe will now construct such minimal sets for each specified crystal class.\n\n### 1. Cubic Crystals\n\nCubic symmetry imposes significant constraints on the elastic tensor. The stiffness matrix has only $3$ independent components: $C_{11}$, $C_{12}$, and $C_{44}$. The matrix form is:\n$$\n\\mathbf{C}_{\\text{cubic}} = \\begin{pmatrix}\nC_{11} & C_{12} & C_{12} & 0 & 0 & 0 \\\\\nC_{12} & C_{11} & C_{12} & 0 & 0 & 0 \\\\\nC_{12} & C_{12} & C_{11} & 0 & 0 & 0 \\\\\n0 & 0 & 0 & C_{44} & 0 & 0 \\\\\n0 & 0 & 0 & 0 & C_{44} & 0 \\\\\n0 & 0 & 0 & 0 & 0 & C_{44}\n\\end{pmatrix}\n$$\nTo determine these $3$ constants, we need a minimal set of $3$ distinct strain states that yield $3$ linearly independent equations.\n\n1.  **Strain 1: Uniaxial strain along a primary axis.**\n    Let $\\boldsymbol{\\epsilon}^{(1)} = (\\delta, 0, 0, 0, 0, 0)$.\n    The energy expression is $\\frac{\\Delta E}{V} = \\frac{1}{2} C_{11} \\delta^2$.\n    The second derivative yields: $\\frac{1}{V}\\frac{\\partial^2 (\\Delta E)}{\\partial \\delta^2} = C_{11}$. This strain directly determines $C_{11}$.\n\n2.  **Strain 2: Shear strain on a primary plane.**\n    Let $\\boldsymbol{\\epsilon}^{(2)} = (0, 0, 0, \\delta, 0, 0)$.\n    The energy expression is $\\frac{\\Delta E}{V} = \\frac{1}{2} C_{44} \\delta^2$.\n    The second derivative yields: $\\frac{1}{V}\\frac{\\partial^2 (\\Delta E)}{\\partial \\delta^2} = C_{44}$. This strain directly determines $C_{44}$.\n\n3.  **Strain 3: Hydrostatic strain.**\n    Let $\\boldsymbol{\\epsilon}^{(3)} = (\\delta, \\delta, \\delta, 0, 0, 0)$.\n    The energy expression is $\\frac{\\Delta E}{V} = \\frac{1}{2} [C_{11}(\\delta^2+\\delta^2+\\delta^2) + 2C_{12}(\\delta\\cdot\\delta + \\delta\\cdot\\delta + \\delta\\cdot\\delta)] = \\frac{3}{2}(C_{11} + 2C_{12})\\delta^2$.\n    The second derivative yields: $\\frac{1}{V}\\frac{\\partial^2 (\\Delta E)}{\\partial \\delta^2} = 3(C_{11} + 2C_{12})$. Since $C_{11}$ is known from Strain 1, this equation can be solved for $C_{12}$.\n\nThis set of $3$ strains is minimal and allows for the determination of all independent elastic constants.\n\n### 2. Hexagonal Crystals\n\nHexagonal symmetry results in $5$ independent elastic constants: $C_{11}$, $C_{12}$, $C_{13}$, $C_{33}$, and $C_{44}$. Additionally, the in-plane shear constant $C_{66}$ is related to the normal constants by $C_{66} = \\frac{1}{2}(C_{11}-C_{12})$. The stiffness matrix is:\n$$\n\\mathbf{C}_{\\text{hexagonal}} = \\begin{pmatrix}\nC_{11} & C_{12} & C_{13} & 0 & 0 & 0 \\\\\nC_{12} & C_{11} & C_{13} & 0 & 0 & 0 \\\\\nC_{13} & C_{13} & C_{33} & 0 & 0 & 0 \\\\\n0 & 0 & 0 & C_{44} & 0 & 0 \\\\\n0 & 0 & 0 & 0 & C_{44} & 0 \\\\\n0 & 0 & 0 & 0 & 0 & \\frac{1}{2}(C_{11}-C_{12})\n\\end{pmatrix}\n$$\nA minimal set of $5$ strains is required.\n\n1.  **Strain 1: Uniaxial strain along the [100] direction (in basal plane).**\n    Let $\\boldsymbol{\\epsilon}^{(1)} = (\\delta, 0, 0, 0, 0, 0)$.\n    Energy: $\\frac{\\Delta E}{V} = \\frac{1}{2} C_{11} \\delta^2$. This determines $C_{11}$.\n\n2.  **Strain 2: Uniaxial strain along the [001] direction (c-axis).**\n    Let $\\boldsymbol{\\epsilon}^{(2)} = (0, 0, \\delta, 0, 0, 0)$.\n    Energy: $\\frac{\\Delta E}{V} = \\frac{1}{2} C_{33} \\delta^2$. This determines $C_{33}$.\n\n3.  **Strain 3: Shear strain on the (100) plane.**\n    Let $\\boldsymbol{\\epsilon}^{(3)} = (0, 0, 0, 0, \\delta, 0)$.\n    Energy: $\\frac{\\Delta E}{V} = \\frac{1}{2} C_{55} \\delta^2 = \\frac{1}{2} C_{44} \\delta^2$. This determines $C_{44}$.\n\n4.  **Strain 4: In-plane shear strain on the (001) plane.**\n    Let $\\boldsymbol{\\epsilon}^{(4)} = (0, 0, 0, 0, 0, \\delta)$.\n    Energy: $\\frac{\\Delta E}{V} = \\frac{1}{2} C_{66} \\delta^2 = \\frac{1}{4}(C_{11} - C_{12}) \\delta^2$.\n    The second derivative yields the relation $C_{66} = \\frac{1}{2}(C_{11} - C_{12})$. Since $C_{11}$ is known from Strain 1, $C_{12}$ can be determined.\n\n5.  **Strain 5: Combined uniaxial strain.**\n    Let $\\boldsymbol{\\epsilon}^{(5)} = (\\delta, 0, \\delta, 0, 0, 0)$.\n    Energy: $\\frac{\\Delta E}{V} = \\frac{1}{2}(C_{11}\\delta^2 + C_{33}\\delta^2 + 2C_{13}\\delta^2)$.\n    The second derivative gives $C_{11} + C_{33} + 2C_{13}$. Since $C_{11}$ and $C_{33}$ are known from Strains 1 and 2, this equation determines $C_{13}$.\n\nThis set of $5$ strains is minimal and sufficient for all $5$ independent constants.\n\n### 3. Orthorhombic Crystals\n\nOrthorhombic crystals have three orthogonal two-fold rotation axes, resulting in $9$ independent elastic constants: $C_{11}$, $C_{22}$, $C_{33}$, $C_{12}$, $C_{13}$, $C_{23}$, $C_{44}$, $C_{55}$, and $C_{66}$. The stiffness matrix is:\n$$\n\\mathbf{C}_{\\text{orthorhombic}} = \\begin{pmatrix}\nC_{11} & C_{12} & C_{13} & 0 & 0 & 0 \\\\\nC_{12} & C_{22} & C_{23} & 0 & 0 & 0 \\\\\nC_{13} & C_{23} & C_{33} & 0 & 0 & 0 \\\\\n0 & 0 & 0 & C_{44} & 0 & 0 \\\\\n0 & 0 & 0 & 0 & C_{55} & 0 \\\\\n0 & 0 & 0 & 0 & 0 & C_{66}\n\\end{pmatrix}\n$$\nA minimal set of $9$ strains is needed. We can construct this set by systematically isolating each constant or a simple combination.\n\n**Strains for diagonal terms ($C_{11}, C_{22}, C_{33}, C_{44}, C_{55}, C_{66}$):**\n\n1.  $\\boldsymbol{\\epsilon}^{(1)} = (\\delta, 0, 0, 0, 0, 0) \\implies \\frac{1}{V}\\frac{\\partial^2 (\\Delta E)}{\\partial \\delta^2} = C_{11}$\n2.  $\\boldsymbol{\\epsilon}^{(2)} = (0, \\delta, 0, 0, 0, 0) \\implies \\frac{1}{V}\\frac{\\partial^2 (\\Delta E)}{\\partial \\delta^2} = C_{22}$\n3.  $\\boldsymbol{\\epsilon}^{(3)} = (0, 0, \\delta, 0, 0, 0) \\implies \\frac{1}{V}\\frac{\\partial^2 (\\Delta E)}{\\partial \\delta^2} = C_{33}$\n4.  $\\boldsymbol{\\epsilon}^{(4)} = (0, 0, 0, \\delta, 0, 0) \\implies \\frac{1}{V}\\frac{\\partial^2 (\\Delta E)}{\\partial \\delta^2} = C_{44}$\n5.  $\\boldsymbol{\\epsilon}^{(5)} = (0, 0, 0, 0, \\delta, 0) \\implies \\frac{1}{V}\\frac{\\partial^2 (\\Delta E)}{\\partial \\delta^2} = C_{55}$\n6.  $\\boldsymbol{\\epsilon}^{(6)} = (0, 0, 0, 0, 0, \\delta) \\implies \\frac{1}{V}\\frac{\\partial^2 (\\Delta E)}{\\partial \\delta^2} = C_{66}$\n\nThese $6$ simple uniaxial and shear strains directly determine the 6 diagonal components of the stiffness matrix.\n\n**Strains for off-diagonal normal terms ($C_{12}, C_{13}, C_{23}$):**\n\n7.  $\\boldsymbol{\\epsilon}^{(7)} = (\\delta, \\delta, 0, 0, 0, 0) \\implies \\frac{1}{V}\\frac{\\partial^2 (\\Delta E)}{\\partial \\delta^2} = C_{11} + C_{22} + 2C_{12}$. With $C_{11}$ and $C_{22}$ known, $C_{12}$ is found.\n8.  $\\boldsymbol{\\epsilon}^{(8)} = (\\delta, 0, \\delta, 0, 0, 0) \\implies \\frac{1}{V}\\frac{\\partial^2 (\\Delta E)}{\\partial \\delta^2} = C_{11} + C_{33} + 2C_{13}$. With $C_{11}$ and $C_{33}$ known, $C_{13}$ is found.\n9.  $\\boldsymbol{\\epsilon}^{(9)} = (0, \\delta, \\delta, 0, 0, 0) \\implies \\frac{1}{V}\\frac{\\partial^2 (\\Delta E)}{\\partial \\delta^2} = C_{22} + C_{33} + 2C_{23}$. With $C_{22}$ and $C_{33}$ known, $C_{23}$ is found.\n\nThis set of $9$ strains is minimal and provides a well-conditioned, systematic path to determine all $9$ independent elastic constants.\n\n### Total Number of Strain States\n\nThe problem asks for the minimal total number of distinct strain states across all three classes combined. Based on the constructions above:\n-   Cubic crystals require a minimum of $3$ strain states.\n-   Hexagonal crystals require a minimum of $5$ strain states.\n-   Orthorhombic crystals require a minimum of $9$ strain states.\n\nThe total minimal number of distinct strain states is the sum of these individual counts.\nTotal = $3 + 5 + 9 = 17$.\nThis represents the sum of the number of independent elastic constants for each crystal class.",
            "answer": "$$\\boxed{17}$$"
        },
        {
            "introduction": "Robust scientific computation demands rigorous self-consistency checks to ensure the reliability of results. This exercise demonstrates a powerful validation technique: calculating the bulk modulus, a key macroscopic property, through two independent first-principles routes . By comparing the value derived from the full elastic tensor with the one obtained from an energy-volume equation of state, you will learn a practical method for identifying inconsistencies and building confidence in your computed elastic constants.",
            "id": "3794414",
            "problem": "A cubic crystalline material has been characterized from first-principles Density Functional Theory (DFT) calculations via two independent routes at zero temperature. Route one uses total energy per atom as a function of volume per atom, $E(V)$, in the vicinity of the equilibrium volume $V_0$. Near $V_0$, the energy is well described by the expansion\n$$\nE(V) = E_0 + \\frac{1}{2} a_2 (V - V_0)^{2} + \\frac{1}{6} a_3 (V - V_0)^{3},\n$$\nwhere $E_0$ is a constant, $V_0 = 15.5\\,\\text{\\AA}^3$, $a_2 = 0.070\\,\\text{eV}/\\text{\\AA}^{6}$, and $a_3 = -0.002\\,\\text{eV}/\\text{\\AA}^{9}$. Route two uses linear response stress-strain DFT data to determine the independent single-crystal elastic stiffnesses of the cubic crystal, finding $C_{11} = 240.0\\,\\text{GPa}$, $C_{12} = 140.0\\,\\text{GPa}$, and $C_{44} = 120.0\\,\\text{GPa}$. \n\nStarting from thermodynamic definitions of pressure and bulk modulus, and from the general form of Hooke’s law for cubic crystals under small, uniform (hydrostatic) strain, derive the expressions needed to compute the isotropic bulk modulus from both $E(V)$ and $\\{C_{ij}\\}$. Then, using the provided data, compute the fractional discrepancy between the two bulk moduli, defined as\n$$\n\\Delta = \\frac{B_{\\text{energy}} - B_{\\text{tensor}}}{B_{\\text{tensor}}}.\n$$\nReport $\\Delta$ as a decimal fraction, rounded to four significant figures. When converting between energy-density and pressure units, use the well-established conversion $1\\,\\text{eV}/\\text{\\AA}^{3} = 160.21766208\\,\\text{GPa}$.",
            "solution": "The problem requires the calculation and comparison of the bulk modulus of a cubic crystal derived from two independent first-principles methods: one based on the energy-volume curve, and the other based on the elastic stiffness tensor. The final goal is to compute the fractional discrepancy between the two results. The analysis proceeds in three stages: first, the derivation and calculation of the bulk modulus from the energy-volume data ($B_{\\text{energy}}$); second, the derivation and calculation of the bulk modulus from the elastic constants ($B_{\\text{tensor}}$); and third, the computation of the fractional discrepancy $\\Delta$.\n\n**1. Bulk Modulus from the Energy-Volume Curve ($B_{\\text{energy}}$)**\n\nThe bulk modulus, $B$, is a measure of a substance's resistance to uniform compression. At zero temperature ($T=0$), it is defined thermodynamically in terms of the pressure $P$ and volume $V$ as:\n$$\nB = -V \\frac{dP}{dV}\n$$\nThe pressure $P$ is, in turn, defined as the negative derivative of the total energy $E$ with respect to volume $V$:\n$$\nP = -\\frac{dE}{dV}\n$$\nThe problem provides the energy per atom, $E(V)$, as a function of the volume per atom, $V$. The definitions for pressure and bulk modulus hold for these per-atom quantities. Combining the two definitions, we can express the bulk modulus directly in terms of the energy-volume relationship:\n$$\nB = -V \\frac{d}{dV}\\left(-\\frac{dE}{dV}\\right) = V \\frac{d^2E}{dV^2}\n$$\nThe bulk modulus is conventionally evaluated at the equilibrium volume $V_0$, which corresponds to the state of zero pressure.\n\nThe given energy-volume relationship is:\n$$\nE(V) = E_0 + \\frac{1}{2} a_2 (V - V_0)^{2} + \\frac{1}{6} a_3 (V - V_0)^{3}\n$$\nWe first compute the first and second derivatives of $E(V)$ with respect to $V$:\n$$\n\\frac{dE}{dV} = a_2 (V - V_0) + \\frac{1}{2} a_3 (V - V_0)^{2}\n$$\n$$\n\\frac{d^2E}{dV^2} = a_2 + a_3 (V - V_0)\n$$\nTo find the bulk modulus at equilibrium, we evaluate the second derivative at $V = V_0$:\n$$\n\\left. \\frac{d^2E}{dV^2} \\right|_{V=V_0} = a_2 + a_3 (V_0 - V_0) = a_2\n$$\nSubstituting this into the expression for the bulk modulus at equilibrium, we find the formula for $B_{\\text{energy}}$:\n$$\nB_{\\text{energy}} = V_0 \\left. \\frac{d^2E}{dV^2} \\right|_{V=V_0} = V_0 a_2\n$$\nUsing the provided data, $V_0 = 15.5\\,\\text{\\AA}^3$ and $a_2 = 0.070\\,\\text{eV}/\\text{\\AA}^{6}$:\n$$\nB_{\\text{energy}} = (15.5\\,\\text{\\AA}^3) \\times (0.070\\,\\text{eV}/\\text{\\AA}^{6}) = 1.085\\,\\text{eV}/\\text{\\AA}^{3}\n$$\nTo express this in units of gigapascals (GPa), we use the given conversion factor $1\\,\\text{eV}/\\text{\\AA}^{3} = 160.21766208\\,\\text{GPa}$:\n$$\nB_{\\text{energy}} = 1.085 \\times 160.21766208\\,\\text{GPa} \\approx 173.83616336\\,\\text{GPa}\n$$\n\n**2. Bulk Modulus from the Elastic Stiffness Tensor ($B_{\\text{tensor}}$)**\n\nFor a cubic crystal, the relationship between the stress tensor $\\sigma$ and the strain tensor $\\epsilon$ (in Voigt notation where indices run from $1$ to $6$) is given by Hooke's law:\n$$\n\\begin{pmatrix} \\sigma_1 \\\\ \\sigma_2 \\\\ \\sigma_3 \\\\ \\sigma_4 \\\\ \\sigma_5 \\\\ \\sigma_6 \\end{pmatrix} = \\begin{pmatrix} C_{11} & C_{12} & C_{12} & 0 & 0 & 0 \\\\ C_{12} & C_{11} & C_{12} & 0 & 0 & 0 \\\\ C_{12} & C_{12} & C_{11} & 0 & 0 & 0 \\\\ 0 & 0 & 0 & C_{44} & 0 & 0 \\\\ 0 & 0 & 0 & 0 & C_{44} & 0 \\\\ 0 & 0 & 0 & 0 & 0 & C_{44} \\end{pmatrix} \\begin{pmatrix} \\epsilon_1 \\\\ \\epsilon_2 \\\\ \\epsilon_3 \\\\ \\epsilon_4 \\\\ \\epsilon_5 \\\\ \\epsilon_6 \\end{pmatrix}\n$$\nHydrostatic pressure $P$ corresponds to a stress state where the normal stresses are equal and the shear stresses are zero: $\\sigma_1 = \\sigma_2 = \\sigma_3 = -P$, and $\\sigma_4 = \\sigma_5 = \\sigma_6 = 0$. Due to the cubic symmetry, this stress state induces a uniform strain state where the normal strains are equal and the shear strains are zero: $\\epsilon_1 = \\epsilon_2 = \\epsilon_3 = \\epsilon$, and $\\epsilon_4 = \\epsilon_5 = \\epsilon_6 = 0$.\n\nSubstituting this strain state into Hooke's law for any of the normal stress components (e.g., $\\sigma_1$):\n$$\n\\sigma_1 = C_{11}\\epsilon_1 + C_{12}\\epsilon_2 + C_{12}\\epsilon_3 = C_{11}\\epsilon + C_{12}\\epsilon + C_{12}\\epsilon = (C_{11} + 2C_{12})\\epsilon\n$$\nSince $\\sigma_1 = -P$, we have:\n$$\n-P = (C_{11} + 2C_{12})\\epsilon\n$$\nThe bulk modulus is defined by the change in pressure with respect to the fractional volume change, $\\epsilon_V = \\Delta V / V_0$. For small strains, the volumetric strain is the sum of the normal strains: $\\epsilon_V = \\epsilon_1 + \\epsilon_2 + \\epsilon_3 = 3\\epsilon$. Thus, we can write:\n$$\nB = -\\frac{dP}{d\\epsilon_V} = -\\frac{dP}{d(3\\epsilon)} = -\\frac{1}{3}\\frac{dP}{d\\epsilon}\n$$\nFrom the relation $-P = (C_{11} + 2C_{12})\\epsilon$, we find the derivative $\\frac{dP}{d\\epsilon}$:\n$$\n\\frac{dP}{d\\epsilon} = -(C_{11} + 2C_{12})\n$$\nSubstituting this into the expression for the bulk modulus, we obtain the formula for $B_{\\text{tensor}}$:\n$$\nB_{\\text{tensor}} = -\\frac{1}{3} \\left[-(C_{11} + 2C_{12})\\right] = \\frac{C_{11} + 2C_{12}}{3}\n$$\nUsing the provided elastic constants, $C_{11} = 240.0\\,\\text{GPa}$ and $C_{12} = 140.0\\,\\text{GPa}$:\n$$\nB_{\\text{tensor}} = \\frac{240.0\\,\\text{GPa} + 2 \\times 140.0\\,\\text{GPa}}{3} = \\frac{240.0 + 280.0}{3}\\,\\text{GPa} = \\frac{520.0}{3}\\,\\text{GPa}\n$$\nNumerically, this is $B_{\\text{tensor}} \\approx 173.33333333\\,\\text{GPa}$.\n\n**3. Fractional Discrepancy ($\\Delta$)**\n\nThe fractional discrepancy is defined as:\n$$\n\\Delta = \\frac{B_{\\text{energy}} - B_{\\text{tensor}}}{B_{\\text{tensor}}}\n$$\nSubstituting the calculated values:\n$$\nB_{\\text{energy}} \\approx 173.83616336\\,\\text{GPa}\n$$\n$$\nB_{\\text{tensor}} = \\frac{520.0}{3}\\,\\text{GPa} \\approx 173.33333333\\,\\text{GPa}\n$$\n$$\n\\Delta = \\frac{173.83616336 - \\frac{520.0}{3}}{\\frac{520.0}{3}} = \\frac{173.83616336 - 173.33333333}{173.33333333}\n$$\n$$\n\\Delta \\approx \\frac{0.50283003}{173.33333333} \\approx 0.00290094248\n$$\nRounding the result to four significant figures, we get:\n$$\n\\Delta \\approx 0.002901\n$$\nThis small discrepancy is expected in practice, as the two computational routes involve different types of calculations (total energy vs. stress response) and may be subject to different numerical approximations (e.g., k-point sampling, basis set choice) or physical approximations (e.g., choice of exchange-correlation functional).",
            "answer": "$$\n\\boxed{0.002901}\n$$"
        },
        {
            "introduction": "While the linear theory of elasticity is powerful, it is fundamentally an approximation valid only for infinitesimal strains. To capture a material's response to larger deformations, such as its behavior near failure or under high pressure, we must consider nonlinear effects described by higher-order elastic constants. This practice guides you through the advanced task of extracting a third-order elastic constant from finite-strain calculations, introducing the critical challenges of data fitting and the necessity of justifying the strain range to obtain physically meaningful results .",
            "id": "3794412",
            "problem": "You are given synthetic first-principles energy-density data for a cubic crystal under uniaxial finite strain along the $x$ axis. The goal is to extract the third-order elastic constant by fitting the energy-strain relation in a finite-strain framework and to justify the strain range used. Work in the hyperelastic, isothermal regime and assume mass density invariance. All quantities are per unit volume.\n\nFundamental base and modeling assumptions:\n- The deformation gradient is $F = \\mathrm{diag}(1+\\varepsilon, 1, 1)$ under uniaxial engineering strain $\\varepsilon$ along $x$.\n- The Green–Lagrange strain (also called finite strain) is $E_{ij} = \\tfrac{1}{2}(F_{ki}F_{kj} - \\delta_{ij})$. Under the above $F$, the only nonzero strain component is $E_{11} = \\varepsilon + \\tfrac{1}{2}\\varepsilon^2$, denoted by $E$ for brevity.\n- The strain-energy density $W$ is modeled as a Taylor expansion in $E$ up to third order for a cubic crystal under this loading, with the relevant constants being the second-order elastic constant $C_{11}$ and the third-order elastic constant $C_{111}$. Specifically, $W(E)$ is truncated to third order and depends only on $E$ through invariants consistent with cubic symmetry under uniaxial loading.\n\nTask:\n1. Using the Green–Lagrange strain $E = \\varepsilon + \\tfrac{1}{2}\\varepsilon^2$, fit the energy-density data $W(\\varepsilon)$ with a model that is third order in $E$ (with second-order and third-order terms only), and infer $C_{11}$ and $C_{111}$.\n2. Justify the selected strain range by requiring that the magnitude ratio of the modeled cubic contribution to the quadratic contribution at the maximum strain in the selected range lies within a prescribed interval. Define\n   $$\n   R = \\left|\\frac{W_3}{W_2}\\right| = \\left|\\frac{\\tfrac{1}{6} C_{111} E_{\\max}^3}{\\tfrac{1}{2} C_{11} E_{\\max}^2}\\right| = \\left|\\frac{C_{111}}{3 C_{11}} E_{\\max}\\right|,\n   $$\n   where $E_{\\max}$ is the Green–Lagrange strain at the maximum engineering strain used in the fit. The range is acceptable if $0.05 \\le R \\le 0.5$, which ensures the cubic term is detectable yet the truncation to third order remains credible.\n3. Additionally, quantify the fidelity of the third-order truncation by computing the relative residual\n   $$\n   \\rho = \\frac{\\|W - \\hat{W}\\|_2}{\\|W\\|_2},\n   $$\n   where $\\hat{W}$ is the fitted third-order model, and $\\|\\cdot\\|_2$ denotes the Euclidean norm over the selected strain points. Require $\\rho \\le 0.02$ for acceptance.\n\nModel and fitting details:\n- Fit $W(E)$ with a linear-in-parameters model $W(E) = a_2 E^2 + a_3 E^3$, then infer $C_{11} = 2 a_2$ and $C_{111} = 6 a_3$. This is a linear least-squares problem in the regressors $E^2$ and $E^3$.\n- The strain range to use for the fit must be justified by the above $R$ and $\\rho$ criteria. If the full provided range fails the lower bound on $R$, report the best achievable fit over the full provided range as not acceptable. If the upper bound on $R$ or the residual bound fails, shrink the range to the largest subset that satisfies both criteria.\n\nUnits:\n- Energy density $W$ is given in joules per cubic meter ($\\mathrm{J/m^3}$), which equals pascals ($\\mathrm{Pa}$).\n- Elastic constants $C_{11}$ and $C_{111}$ are in pascals ($\\mathrm{Pa}$).\n- Express the reported $C_{111}$ in gigapascals ($\\mathrm{GPa}$) as a floating-point number. Round to three decimal places.\n- Angles are not used.\n- Percentages must be expressed as decimals; engineering strain is provided as a decimal.\n\nData generation context:\n- The synthetic $W(\\varepsilon)$ data emulate results from Density Functional Theory (DFT) total-energy calculations by evaluating $W$ from known constants and, in one case, including a small quartic-in-$E$ term that represents beyond-third-order contributions. This term is not included in the fitting model and thus contributes to the residual.\n\nTest suite:\nFor each test case, you are given $C_{11}$, $C_{111}$, the maximum engineering strain $\\varepsilon_{\\max}$, the engineering-strain step $\\Delta \\varepsilon$, and a quartic coefficient $k$ (with $k = 0$ meaning no quartic contribution). Define the strain grid $\\{\\varepsilon_n\\}$ as $\\varepsilon_n = n \\Delta \\varepsilon$ for integers $n$ from $0$ up to $N$ such that $N \\Delta \\varepsilon = \\varepsilon_{\\max}$. For each $\\varepsilon_n$, compute $E_n = \\varepsilon_n + \\tfrac{1}{2}\\varepsilon_n^2$ and then\n$$\nW_n = \\tfrac{1}{2} C_{11} E_n^2 + \\tfrac{1}{6} C_{111} E_n^3 + k E_n^4.\n$$\nYou must fit only up to third order (ignore the quartic term in the fitting model), and select the largest acceptable subset of the provided grid according to the criteria on $R$ and $\\rho$.\n\n- Test case $1$ (happy path): $C_{11} = 200 \\times 10^9 \\ \\mathrm{Pa}$, $C_{111} = -1200 \\times 10^9 \\ \\mathrm{Pa}$, $\\varepsilon_{\\max} = 0.08$, $\\Delta \\varepsilon = 0.004$, $k = 0$.\n- Test case $2$ (boundary: too-small strains): $C_{11} = 200 \\times 10^9 \\ \\mathrm{Pa}$, $C_{111} = -1200 \\times 10^9 \\ \\mathrm{Pa}$, $\\varepsilon_{\\max} = 0.01$, $\\Delta \\varepsilon = 0.001$, $k = 0$.\n- Test case $3$ (edge: larger strains with quartic mismatch): $C_{11} = 200 \\times 10^9 \\ \\mathrm{Pa}$, $C_{111} = -1200 \\times 10^9 \\ \\mathrm{Pa}$, $\\varepsilon_{\\max} = 0.15$, $\\Delta \\varepsilon = 0.005$, $k = 5 \\times 10^{10} \\ \\mathrm{Pa}$.\n\nRequired final output:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each element corresponds to one test case and is itself a two-element list of the form $[C_{111}^{\\mathrm{(GPa)}}, \\text{range\\_acceptable}]$, where $C_{111}^{\\mathrm{(GPa)}}$ is the fitted third-order constant in $\\mathrm{GPa}$ rounded to three decimal places, and $\\text{range\\_acceptable}$ is a boolean indicating whether both $R$ and $\\rho$ criteria were met on the selected range. For example: $[[x_1,b_1],[x_2,b_2],[x_3,b_3]]$.",
            "solution": "The user-provided problem is assessed to be valid. It is scientifically grounded in continuum mechanics and computational materials science, well-posed with a clear objective and methodology, and internally consistent.\n\n### 1. Theoretical Framework\n\nThe problem is situated within the field of continuum mechanics, specifically the theory of hyperelasticity for materials undergoing finite deformations.\n\n**1.1. Finite Strain Tensor**\nFor large deformations, the infinitesimal strain tensor is inadequate. The Green–Lagrange finite strain tensor, $E_{ij}$, provides a geometrically exact measure of strain. It is defined in terms of the deformation gradient tensor $F_{ij} = \\partial x_i / \\partial X_j$, which maps material points from the reference configuration $\\mathbf{X}$ to the current configuration $\\mathbf{x}$.\n$$\nE_{ij} = \\frac{1}{2} (F_{ki} F_{kj} - \\delta_{ij})\n$$\nwhere $\\delta_{ij}$ is the Kronecker delta. For the prescribed uniaxial deformation along the $x$-axis (or $1$-axis) with engineering strain $\\varepsilon$, the deformation gradient tensor is $F = \\mathrm{diag}(1+\\varepsilon, 1, 1)$. The only non-zero component of the Green–Lagrange strain tensor is then:\n$$\nE_{11} = \\frac{1}{2} ((1+\\varepsilon)^2 - 1) = \\frac{1}{2} (1 + 2\\varepsilon + \\varepsilon^2 - 1) = \\varepsilon + \\frac{1}{2}\\varepsilon^2\n$$\nFor brevity, we denote this single component as $E$.\n\n**1.2. Strain Energy Density for a Cubic Crystal**\nIn hyperelasticity, the material's response is described by a strain energy density function, $W$, which is a scalar potential function of the strain tensor. For a crystal, $W$ must be invariant under the symmetry operations of the crystal's point group. For a cubic crystal under the specified uniaxial strain along a crystallographic axis (e.g., $[100]$), the strain energy density can be expanded as a Taylor series in the strain component $E = E_{11}$:\n$$\nW(E) = \\frac{1}{2} C_{11} E^2 + \\frac{1}{6} C_{111} E^3 + \\frac{1}{24} C_{1111} E^4 + \\dots\n$$\nwhere $C_{11}$ is a second-order elastic constant (SOEC) and $C_{111}$, $C_{1111}$, etc., are third-order (TOEC) and higher-order elastic constants, respectively. These constants are fundamental material properties. The aim of this problem is to determine $C_{11}$ and $C_{111}$ by fitting this model to energy-strain data.\n\n### 2. Fitting Procedure and Model Validation\n\nThe problem requires fitting synthetic energy-density data, $W(\\varepsilon)$, generated over a grid of engineering strains $\\varepsilon$.\n\n**2.1. Linear Least-Squares Regression**\nThe fitting model is a truncation of the strain energy expansion to third order in $E$:\n$$\n\\hat{W}(E) = a_2 E^2 + a_3 E^3\n$$\nThe goal is to find the coefficients $a_2$ and $a_3$ that minimize the difference between the model prediction $\\hat{W}$ and the provided data $W$. Comparing this with the theoretical form, we can infer the elastic constants:\n$$\nC_{11} = 2 a_2, \\quad C_{111} = 6 a_3\n$$\nFor a set of $m$ data points $(E_i, W_i)$, where $i=1, \\dots, m$ (excluding the trivial point $(0,0)$), we can formulate a linear system of equations $\\mathbf{y} = \\mathbf{X}\\boldsymbol{\\beta}$, where:\n- $\\mathbf{y}$ is an $m \\times 1$ vector of the energy density values $W_i$.\n- $\\mathbf{X}$ is the $m \\times 2$ design matrix, with the $i$-th row being $[E_i^2, E_i^3]$.\n- $\\boldsymbol{\\beta}$ is the $2 \\times 1$ vector of unknown coefficients $[a_2, a_3]^T$.\n\nThis overdetermined system is solved using the method of linear least squares, which finds the vector $\\boldsymbol{\\beta}$ that minimizes the Euclidean norm of the residual vector, $\\|\\mathbf{y} - \\mathbf{X}\\boldsymbol{\\beta}\\|_2$. The solution is found via the normal equations $\\boldsymbol{\\beta} = (\\mathbf{X}^T \\mathbf{X})^{-1} \\mathbf{X}^T \\mathbf{y}$, though numerically stable methods like QR decomposition (as implemented in `scipy.linalg.lstsq`) are preferred.\n\n**2.2. Strain Range Justification**\nA critical aspect of extracting nonlinear properties like $C_{111}$ is the choice of the strain range for the fit.\n- If the strain is too small, the cubic term $\\propto E^3$ is negligible compared to the quadratic term $\\propto E^2$, and $C_{111}$ cannot be determined reliably.\n- If the strain is too large, higher-order terms (like $E^4$ and beyond), which are neglected in the fitting model, become significant, leading to a poor fit and inaccurate estimates for $C_{11}$ and $C_{111}$.\n\nThe problem defines two quantitative criteria to ensure the chosen strain range is appropriate:\n\n1.  **Ratio of Cubic to Quadratic Contribution, $R$**: This ratio assesses the significance of the nonlinear term at the maximum strain of the fitting range, $E_{\\max}$.\n    $$\n    R = \\left|\\frac{\\text{Cubic energy term}}{\\text{Quadratic energy term}}\\right|_{E=E_{\\max}} = \\left|\\frac{\\frac{1}{6} C_{111} E_{\\max}^3}{\\frac{1}{2} C_{11} E_{\\max}^2}\\right| = \\left|\\frac{C_{111}}{3 C_{11}} E_{\\max}\\right|\n    $$\n    The problem requires $0.05 \\le R \\le 0.5$. The lower bound ensures the cubic term is large enough to be detected, while the upper bound provides confidence that the next term in the series ($E^4$) is likely still small.\n\n2.  **Relative Residual, $\\rho$**: This metric quantifies the overall goodness-of-fit.\n    $$\n    \\rho = \\frac{\\|W - \\hat{W}\\|_2}{\\|W\\|_2}\n    $$\n    where $W$ are the data values and $\\hat{W}$ are the values predicted by the fitted model. The problem requires $\\rho \\le 0.02$, which limits the deviation of the model from the data to $2\\%$.\n\n### 3. Algorithmic Implementation\n\nThe task is to find the largest strain range, starting from $\\varepsilon = 0$, that satisfies both criteria for $R$ and $\\rho$. The algorithm proceeds as follows for each test case:\n\n1.  **Data Generation**: For the given parameters ($C_{11}$, $C_{111}$, $\\varepsilon_{\\max}$, $\\Delta\\varepsilon$, $k$), generate the set of $N+1$ data points. The engineering strains are $\\varepsilon_n = n \\Delta\\varepsilon$ for $n = 0, \\dots, N$, where $N=\\varepsilon_{\\max}/\\Delta\\varepsilon$. For each $\\varepsilon_n$, calculate the finite strain $E_n = \\varepsilon_n + \\frac{1}{2}\\varepsilon_n^2$ and the energy density $W_n = \\frac{1}{2} C_{11} E_n^2 + \\frac{1}{6} C_{111} E_n^3 + k E_n^4$. The fitting data will consist of the points for $n=1, \\dots, N$.\n\n2.  **Initial Fit on Full Range**: Perform a least-squares fit using all non-trivial data points (from $n=1$ to $N$). Calculate the fitted constants $C_{11, \\text{fit}}$ and $C_{111, \\text{fit}}$, and the validation metrics $R$ and $\\rho$.\n    - If $R < 0.05$, the procedure for this test case terminates. The fit is deemed unacceptable due to insufficient nonlinearity, but the resulting $C_{111}$ from this full-range fit is reported, along with a `False` flag.\n    - If $0.05 \\le R \\le 0.5$ and $\\rho \\le 0.02$, the full range is acceptable. The procedure terminates, reporting the fitted $C_{111}$ and a `True` flag.\n\n3.  **Iterative Range Reduction**: If the initial fit fails because $R > 0.5$ or $\\rho > 0.02$, the strain range is too large. The range is iteratively reduced by removing the data point with the highest strain. The algorithm proceeds by looping from $m = N-1$ down to a minimum number of points (e.g., $m=2$, which is the minimum for a two-parameter fit). In each iteration:\n    a. Perform the fit on the current range of $m$ points.\n    b. Calculate $C_{11, \\text{fit}}$, $C_{111, \\text{fit}}$, $R$, and $\\rho$.\n    c. If $0.05 \\le R \\le 0.5$ and $\\rho \\le 0.02$, the criteria are met. This represents the largest acceptable strain range. The loop is terminated, and the current fitted $C_{111}$ is reported with a `True` flag.\n\n4.  **Final Output**: For each test case, the determined $C_{111}$ is converted to gigapascals (GPa) and rounded to $3$ decimal places. The final result is a list containing the value and the boolean acceptability flag.",
            "answer": "$$\n\\boxed{\\text{[[-1200.000,true],[-1200.000,false],[-1201.218,true]]}}\n$$"
        }
    ]
}