{
    "hands_on_practices": [
        {
            "introduction": "我们从晶格动力学中最基本的模型——一维双原子链模型开始。这个练习将让你通过解析推导，得到声学和光学声子支，为理解作为密度泛函微扰理论（DFPT）计算核心的声子色散曲线提供坚实的理论基础。掌握这个模型是解读真实材料复杂计算结果的第一步 。",
            "id": "3800615",
            "problem": "考虑一个一维双原子布拉伐晶格，其原胞平移长度为 $a$。每个原胞包含 $2$ 个原子：种类 $\\kappa=1$ 的原子质量为 $M_1$，位于位置 $x=na$；种类 $\\kappa=2$ 的原子质量为 $M_2$，位于位置 $x=na + a/2$，其中 $n \\in \\mathbb{Z}$ 是标记原胞的整数。假设 Born–Oppenheimer 近似和谐振近似成立。原子间力常数通过密度泛函微扰理论（DFPT）计算得出，并且由于对称性和短程键合，仅在最近邻的不同类原子对之间不为零。我们将这些相互作用建模为刚度系数为 $\\kappa$ 的相同标量弹簧，连接每个 $\\kappa=1$ 原子与其两个最近邻的 $\\kappa=2$ 原子（一个在同一原胞内，一个在相邻原胞内），同样地，每个 $\\kappa=2$ 原子也连接到其两个最近邻的 $\\kappa=1$ 原子。\n\n从原子 $(R,\\kappa)$ 上的谐振力定义 $F_{R\\kappa} = - \\sum_{R',\\kappa'} \\Phi_{R\\kappa,R'\\kappa'}\\, u_{R'\\kappa'}$ 出发，其中 $\\Phi_{R\\kappa,R'\\kappa'}$ 是原子间力常数，$u_{R\\kappa}$ 是小位移，并利用晶格周期性以及布洛赫形式的位移 $u_{R\\kappa}(t) = U_{\\kappa}(q)\\, \\exp(i q R - i \\omega t)$，构建一个 $2 \\times 2$ 的质量加权动力学矩阵 $D(q)$，其本征值问题通过其本征值 $\\omega^2(q)$ 给出声子频率。推导出两个分支 $\\omega_{-}(q)$ 和 $\\omega_{+}(q)$（分别为声学支和光学支），阐明基矢和由 $a/2$ 内坐标产生的相位因子的作用。然后，通过分析布里渊区中心极限 $q \\to 0$，以 $\\kappa$、$M_1$ 和 $M_2$ 的闭式表达式形式，确定 $q=0$ 处的光学模式带隙。\n\n请仅提供布里渊区中心光学频率 $\\omega_{+}(0)$ 的解析表达式作为最终答案。无需进行数值计算。",
            "solution": "用户希望解决一个一维双原子链的晶格动力学问题。在继续之前，我将验证问题陈述的有效性。\n\n### 问题验证\n\n**第1步：提取给定信息**\n\n*   **系统**：一维双原子布拉伐晶格。\n*   **原胞平移**：长度 $a$。\n*   **基矢**：每个原胞有 $2$ 个原子。\n    *   原子 $\\kappa=1$：质量 $M_1$，位置 $x=na$。\n    *   原子 $\\kappa=2$：质量 $M_2$，位置 $x=na + a/2$。\n    *   $n \\in \\mathbb{Z}$ 是原胞指数。\n*   **近似**：Born–Oppenheimer 近似和谐振近似。\n*   **相互作用**：力常数仅在最近邻的不同类原子对之间不为零，模型为刚度系数为 $\\kappa$ 的相同标量弹簧。\n*   **定义**：\n    *   谐振力：$F_{R\\kappa} = - \\sum_{R',\\kappa'} \\Phi_{R\\kappa,R'\\kappa'}\\, u_{R'\\kappa'}$。\n    *   布洛赫形式位移：$u_{R\\kappa}(t) = U_{\\kappa}(q)\\, \\exp(i q R - i \\omega t)$。\n*   **任务**：\n    1.  构建 $2 \\times 2$ 质量加权动力学矩阵 $D(q)$。\n    2.  推导两个分支 $\\omega_{-}(q)$ (声学支) 和 $\\omega_{+}(q)$ (光学支)。\n    3.  分析布里渊区中心极限 $q \\to 0$。\n    4.  以闭式表达式形式确定 $q=0$ 处的光学模式带隙。\n    5.  提供布里渊区中心光学频率 $\\omega_{+}(0)$ 的解析表达式。\n\n**第2步：使用提取的给定信息进行验证**\n\n*   **科学依据**：该问题是固体物理入门的经典练习，用于解释声子色散关系、声学支和光学支的概念，以及晶格中基矢的作用。所有原理和近似（谐振近似、布洛赫定理）都是该领域的基础。提及密度泛函微扰理论（DFPT）正确地将问题置于现代计算材料科学的背景下，其中 DFPT 是计算力常数（此处为 $\\kappa$）的标准方法。该问题在科学上是合理的。\n*   **良构性**：问题定义清晰，包含所有必要的参数（$M_1, M_2, a, \\kappa$）和一个直接的物理模型（最近邻弹簧）。目标明确，并导向一个唯一且有意义的解。\n*   **客观性**：问题以精确、无偏见且形式化的科学语言陈述。没有主观或含糊的术语。\n\n该问题未违反任何无效性标准。它是一个在其领域内良构、有科学依据的标准问题。\n\n**第3步：结论与行动**\n\n此问题**有效**。将提供完整解答。\n\n### 解答\n\n我们首先为索引为 $n$ 的原胞中的两个原子建立运动方程。设 $u_{n,1}$ 和 $u_{n,2}$ 分别为在原胞 $n$ 中质量为 $M_1$ 和 $M_2$ 的原子偏离其平衡位置的位移。\n\n位于位置 $na$ 处，质量为 $M_1$ 的原子与其两个最近邻原子相连：位于 $na+a/2$ 的质量为 $M_2$ 的原子（在同一原胞内）和位于 $(n-1)a+a/2$ 的质量为 $M_2$ 的原子（在前一个原胞内）。作用在该原子上的合力是这两个弹簧作用力的总和：\n$$F_{n,1} = \\kappa(u_{n,2} - u_{n,1}) + \\kappa(u_{n-1,2} - u_{n,1})$$\n应用牛顿第二定律 $F_{n,1} = M_1 \\ddot{u}_{n,1}$，我们得到：\n$$M_1 \\ddot{u}_{n,1} = \\kappa(u_{n,2} + u_{n-1,2} - 2 u_{n,1})$$\n类似地，位于位置 $na+a/2$ 处，质量为 $M_2$ 的原子与其两个最近邻原子相连：位于 $na$ 的质量为 $M_1$ 的原子（在同一原胞内）和位于 $(n+1)a$ 的质量为 $M_1$ 的原子（在下一个原胞内）。其所受合力为：\n$$F_{n,2} = \\kappa(u_{n,1} - u_{n,2}) + \\kappa(u_{n+1,1} - u_{n,2})$$\n应用牛顿第二定律 $F_{n,2} = M_2 \\ddot{u}_{n,2}$，我们得到：\n$$M_2 \\ddot{u}_{n,2} = \\kappa(u_{n+1,1} + u_{n,1} - 2 u_{n,2})$$\n我们寻求与布洛赫定理一致的平面波解（声子）。在原胞 $n$（位置 $R=na$）中，带有原胞内基矢 $\\vec{\\tau}_\\kappa$ 的原子 $\\kappa$ 的位移由下式给出：\n$$u_{n,\\kappa}(t) = U_{\\kappa}(q) \\exp[i(q(na+\\tau_\\kappa) - \\omega t)]$$\n在我们的二维情况下，基矢为原子1的 $\\tau_1=0$ 和原子2的 $\\tau_2=a/2$。位移为：\n$$u_{n,1}(t) = U_1 \\exp[i(qna - \\omega t)]$$\n$$u_{n,2}(t) = U_2 \\exp[i(q(na+a/2) - \\omega t)]$$\n相邻原子的位移可以与此关联：\n$$u_{n-1,2}(t) = U_2 \\exp[i(q((n-1)a+a/2) - \\omega t)] = U_2 \\exp[i(q(na+a/2) - \\omega t)] \\exp(-iqa) = u_{n,2}(t) \\exp(-iqa)$$\n$$u_{n+1,1}(t) = U_1 \\exp[i(q(n+1)a - \\omega t)] = U_1 \\exp[i(qna - \\omega t)] \\exp(iqa) = u_{n,1}(t) \\exp(iqa)$$\n对时间的二阶导数为 $\\ddot{u}_{n,\\kappa} = -\\omega^2 u_{n,\\kappa}$。\n\n将这些代入运动方程：\n对于质量 $M_1$：\n$$-M_1 \\omega^2 u_{n,1} = \\kappa(u_{n,2} + u_{n-1,2} - 2 u_{n,1}) = \\kappa(u_{n,2} + u_{n,2}\\exp(-iqa) - 2 u_{n,1})$$\n除以 $u_{n,1} = U_1 \\exp[i(qna - \\omega t)]$：\n$$-M_1 \\omega^2 U_1 = \\kappa \\left( \\frac{u_{n,2}}{u_{n,1}} (1+\\exp(-iqa)) - 2U_1 \\right)$$\n相位比为 $\\frac{u_{n,2}}{u_{n,1}} = \\frac{U_2}{U_1} \\exp(iqa/2)$。\n$$-M_1 \\omega^2 U_1 = \\kappa \\left( \\frac{U_2}{U_1} \\exp(iqa/2) (1+\\exp(-iqa)) - 2U_1 \\right)$$\n$$-M_1 \\omega^2 U_1 = \\kappa \\left( \\frac{U_2}{U_1} (\\exp(iqa/2)+\\exp(-iqa/2)) - 2U_1 \\right)$$\n$$-M_1 \\omega^2 U_1 = \\kappa(2 \\frac{U_2}{U_1} \\cos(qa/2) - 2U_1)$$\n$$(2\\kappa - M_1 \\omega^2) U_1 - 2\\kappa \\cos(qa/2) U_2 = 0$$\n对于质量 $M_2$：\n$$-M_2 \\omega^2 u_{n,2} = \\kappa(u_{n+1,1} + u_{n,1} - 2u_{n,2}) = \\kappa(u_{n,1}\\exp(iqa) + u_{n,1} - 2u_{n,2})$$\n除以 $u_{n,2} = U_2 \\exp[i(q(na+a/2) - \\omega t)]$：\n$$-M_2 \\omega^2 U_2 = \\kappa \\left( \\frac{u_{n,1}}{u_{n,2}} (\\exp(iqa)+1) - 2U_2 \\right)$$\n相位比为 $\\frac{u_{n,1}}{u_{n,2}} = \\frac{U_1}{U_2} \\exp(-iqa/2)$。如前所述进行处理：\n$$-M_2 \\omega^2 U_2 = \\kappa(2 \\frac{U_1}{U_2} \\cos(qa/2) - 2U_2)$$\n$$-2\\kappa \\cos(qa/2) U_1 + (2\\kappa - M_2 \\omega^2) U_2 = 0$$\n这两个关于振幅 $U_1$ 和 $U_2$ 的齐次线性方程组可以写成矩阵形式：\n$$\n\\begin{pmatrix}\n2\\kappa - M_1 \\omega^2 & -2\\kappa \\cos(qa/2) \\\\\n-2\\kappa \\cos(qa/2) & 2\\kappa - M_2 \\omega^2\n\\end{pmatrix}\n\\begin{pmatrix}\nU_1 \\\\\nU_2\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\\n0\n\\end{pmatrix}\n$$\n这是 $(C(q) - M\\omega^2)U = 0$ 的形式，其中 $C(q)$ 是傅里叶变换后的力常数矩阵，$M$ 是对角质量矩阵。质量加权动力学矩阵 $D(q)$ 由本征值问题 $D(q)v=\\omega^2 v$ 定义，其中 $v = M^{1/2}U$。这给出 $D(q) = M^{-1/2}C(q)M^{-1/2}$。\n$$\nC(q) = \\begin{pmatrix}\n2\\kappa & -2\\kappa \\cos(qa/2) \\\\\n-2\\kappa \\cos(qa/2) & 2\\kappa\n\\end{pmatrix}\n$$\n$$\nD(q) = \\begin{pmatrix}\n\\frac{1}{\\sqrt{M_1}} & 0 \\\\\n0 & \\frac{1}{\\sqrt{M_2}}\n\\end{pmatrix}\n\\begin{pmatrix}\n2\\kappa & -2\\kappa \\cos(qa/2) \\\\\n-2\\kappa \\cos(qa/2) & 2\\kappa\n\\end{pmatrix}\n\\begin{pmatrix}\n\\frac{1}{\\sqrt{M_1}} & 0 \\\\\n0 & \\frac{1}{\\sqrt{M_2}}\n\\end{pmatrix}\n$$\n$$\nD(q) = \\begin{pmatrix}\n\\frac{2\\kappa}{M_1} & -\\frac{2\\kappa}{\\sqrt{M_1 M_2}} \\cos(qa/2) \\\\\n-\\frac{2\\kappa}{\\sqrt{M_1 M_2}} \\cos(qa/2) & \\frac{2\\kappa}{M_2}\n\\end{pmatrix}\n$$\n这就是所要求的 $2 \\times 2$ 质量加权动力学矩阵。它的本征值 $\\omega^2$ 通过求解久期方程 $\\det(D(q) - \\omega^2 I)=0$ 得到：\n$$ \\left(\\frac{2\\kappa}{M_1} - \\omega^2\\right) \\left(\\frac{2\\kappa}{M_2} - \\omega^2\\right) - \\left(\\frac{2\\kappa}{\\sqrt{M_1 M_2}} \\cos(qa/2)\\right)^2 = 0 $$\n$$ \\omega^4 - 2\\kappa\\left(\\frac{1}{M_1} + \\frac{1}{M_2}\\right)\\omega^2 + \\frac{4\\kappa^2}{M_1 M_2} - \\frac{4\\kappa^2}{M_1 M_2}\\cos^2(qa/2) = 0 $$\n$$ \\omega^4 - 2\\kappa\\left(\\frac{1}{M_1} + \\frac{1}{M_2}\\right)\\omega^2 + \\frac{4\\kappa^2}{M_1 M_2}\\sin^2(qa/2) = 0 $$\n这是一个关于 $\\omega^2$ 的二次方程。求解 $\\omega^2$：\n$$ \\omega^2 = \\kappa\\left(\\frac{1}{M_1} + \\frac{1}{M_2}\\right) \\pm \\sqrt{\\kappa^2\\left(\\frac{1}{M_1} + \\frac{1}{M_2}\\right)^2 - \\frac{4\\kappa^2}{M_1 M_2}\\sin^2(qa/2)} $$\n$$ \\omega^2 = \\kappa\\left(\\frac{1}{M_1} + \\frac{1}{M_2}\\right) \\pm \\kappa\\sqrt{\\left(\\frac{1}{M_1^2} + \\frac{2}{M_1 M_2} + \\frac{1}{M_2^2}\\right) - \\frac{4}{M_1 M_2}\\sin^2(qa/2)} $$\n使用 $\\sin^2(x) = 1-\\cos^2(x)$：\n$$ \\omega^2 = \\kappa\\left(\\frac{1}{M_1} + \\frac{1}{M_2}\\right) \\pm \\kappa\\sqrt{\\left(\\frac{1}{M_1^2} - \\frac{2}{M_1 M_2} + \\frac{1}{M_2^2}\\right) + \\frac{4}{M_1 M_2}\\cos^2(qa/2)} $$\n$$ \\omega_{\\pm}^2(q) = \\kappa\\left(\\frac{1}{M_1} + \\frac{1}{M_2}\\right) \\pm \\kappa\\sqrt{\\left(\\frac{1}{M_1} - \\frac{1}{M_2}\\right)^2 + \\frac{4}{M_1 M_2}\\cos^2(qa/2)} $$\n上支（$+$ 号）是光学支 $\\omega_{+}(q)$，下支（$-$ 号）是声学支 $\\omega_{-}(q)$。\n\n为了找到布里渊区中心的光学频率，我们计算 $q=0$ 时的光学支。当 $q \\to 0$ 时，$\\cos(qa/2) \\to 1$。\n$$ \\omega_{+}^2(0) = \\kappa\\left(\\frac{1}{M_1} + \\frac{1}{M_2}\\right) + \\kappa\\sqrt{\\left(\\frac{1}{M_1} - \\frac{1}{M_2}\\right)^2 + \\frac{4}{M_1 M_2}} $$\n平方根下的项可以简化：\n$$ \\sqrt{\\left(\\frac{1}{M_1^2} - \\frac{2}{M_1 M_2} + \\frac{1}{M_2^2}\\right) + \\frac{4}{M_1 M_2}} = \\sqrt{\\frac{1}{M_1^2} + \\frac{2}{M_1 M_2} + \\frac{1}{M_2^2}} = \\sqrt{\\left(\\frac{1}{M_1} + \\frac{1}{M_2}\\right)^2} = \\frac{1}{M_1} + \\frac{1}{M_2} $$\n将此代回 $\\omega_{+}^2(0)$ 的表达式中：\n$$ \\omega_{+}^2(0) = \\kappa\\left(\\frac{1}{M_1} + \\frac{1}{M_2}\\right) + \\kappa\\left(\\frac{1}{M_1} + \\frac{1}{M_2}\\right) = 2\\kappa\\left(\\frac{1}{M_1} + \\frac{1}{M_2}\\right) $$\n布里渊区中心的光学频率是该值的平方根。\n$$ \\omega_{+}(0) = \\sqrt{2\\kappa\\left(\\frac{1}{M_1} + \\frac{1}{M_2}\\right)} $$\n这代表了光学模式的频率，在该模式下，原胞中的两个原子彼此反向振动，而它们的质心保持静止。在 $q=0$ 处，声学支和光学支之间的能隙由 $\\omega_{+}(0) - \\omega_{-}(0)$ 给出。由于 $\\omega_{-}(0)=0$，所以该带隙就是 $\\omega_{+}(0)$。",
            "answer": "$$\\boxed{\\sqrt{2\\kappa\\left(\\frac{1}{M_1} + \\frac{1}{M_2}\\right)}}$$"
        },
        {
            "introduction": "在基本模型的基础上，本实践将探讨极性材料中的一个关键现象：纵向光学（LO）和横向光学（TO）声子频率的分裂。你将推导由玻恩有效电荷和介电常数所描述的长程库仑相互作用，是如何消除布里渊区中心光学模式的简并的。这个练习突显了DFPT在处理动力学矩阵的非解析行为及其对振动和光学性质影响方面的独特能力 。",
            "id": "3800578",
            "problem": "一个二元极性双原子晶体在布里渊区中心有一个红外活性的光学模式。在长波极限下，密度泛函微扰理论 (DFPT) 指出，在声子谱的中心，动力学矩阵存在一个非解析的长程库仑贡献，该贡献导致了纵向光学-横向光学 (LO–TO) 的频率劈裂。子晶格 $\\kappa$ 的 Born 有效电荷张量定义为 $Z^{*}_{\\kappa,\\alpha\\beta} = \\Omega \\left.\\partial P_{\\beta}/\\partial u_{\\kappa,\\alpha}\\right|_{\\mathbf{E}=0}$，其中 $\\Omega$ 是原胞体积，$\\mathbf{P}$ 是宏观极化强度，$\\mathbf{u}_{\\kappa}$ 是子晶格位移。考虑一个简单的双原子晶体，其具有单一的极性光学模式，该模式的本征位移与声子传播方向 $\\hat{\\mathbf{q}}$ 共线。在电动力学计算中使用高斯单位制。\n\n该晶体由以下数据表征：\n- 各向同性的 Born 有效电荷 $Z^{*}_{A} = +Z^{*}\\,\\mathbf{I}$ 和 $Z^{*}_{B} = -Z^{*}\\,\\mathbf{I}$，其中 $Z^{*} = 2.10$。\n- 高频介电张量 $\\boldsymbol{\\epsilon}^{\\infty} = \\mathrm{diag}(5.50,\\,5.50,\\,3.30)$。\n- 子晶格质量 $M_{A} = 23.0$ 和 $M_{B} = 35.45$（单位为原子质量单位），以及原胞体积 $\\Omega = 90.0$（单位为 $\\text{\\AA}^{3}$）。\n\n从上述定义、纵向模式的长波静电边界条件以及相对坐标的运动方程出发，推导该双原子晶体 LO-TO 劈裂 $\\Delta \\omega^{2}(\\hat{\\mathbf{q}}) \\equiv \\omega_{\\mathrm{LO}}^{2}(\\hat{\\mathbf{q}}) - \\omega_{\\mathrm{TO}}^{2}$ 作为传播方向 $\\hat{\\mathbf{q}}$ 的函数的封闭形式表达式。然后，使用所提供的数据，计算比率\n$$\nR \\equiv \\frac{\\Delta \\omega^{2}(\\hat{\\mathbf{q}} = [100])}{\\Delta \\omega^{2}(\\hat{\\mathbf{q}} = [001])}.\n$$\n将您的 $R$ 值四舍五入到四位有效数字。将最终答案表示为一个无单位的纯数。",
            "solution": "### 第一步：提取已知条件\n题目为一种二元极性双原子晶体提供了以下信息：\n- 它在布里渊区中心（$\\mathbf{q} \\to 0$）有一个单一的红外活性光学模式。\n- 该极性光学模式的本征位移与声子传播方向 $\\hat{\\mathbf{q}}$ 共线。\n- 该系统在电动力学计算中采用高斯单位制。\n- Born 有效电荷张量是各向同性的：$Z^{*}_{A} = +Z^{*}\\,\\mathbf{I}$ 和 $Z^{*}_{B} = -Z^{*}\\,\\mathbf{I}$，其无量纲大小为 $Z^{*} = 2.10$。\n- 高频介电张量为 $\\boldsymbol{\\epsilon}^{\\infty} = \\mathrm{diag}(5.50,\\,5.50,\\,3.30)$。\n- 子晶格质量为 $M_{A} = 23.0$ amu 和 $M_{B} = 35.45$ amu。\n- 原胞体积为 $\\Omega = 90.0 \\, \\text{\\AA}^{3}$。\n\n### 第二步：使用提取的已知条件进行验证\n该问题具有科学依据，描述了极性晶体中公认的纵向光学-横向光学 (LO–TO) 劈裂现象。这种劈裂源于区中心动力学矩阵的非解析行为，这是晶格动力学中的一个核心概念，并且可以通过密度泛函微扰理论 (DFPT) 进行精确建模。所提供的定义和数据与标准的固态物理理论一致。介电常数、质量和 Born 有效电荷的值对于真实材料（例如 II-VI 族或 III-V 族半导体）是物理上合理的。该问题是自洽的、适定的和客观的。它要求进行标准推导，然后进行计算，基于所提供的数据，该问题有唯一解。在最终比率计算中包含多余数据（$M_A$、$M_B$、$\\Omega$、$Z^*$）是测试概念理解的常用方法，以确保解题者能够识别相关的物理量。该问题不违反任何无效性标准。\n\n### 第三步：结论与行动\n该问题有效。将提供一个完整的、有理有据的解答。\n\n### LO-TO 劈裂的推导\nLO-TO 劈裂是伴随极性材料中纵向光学声子而产生的宏观电场的结果。我们可以通过考虑两个子晶格相对位移的运动方程来推导劈裂的表达式。\n\n设 $\\mathbf{w} = \\mathbf{u}_A - \\mathbf{u}_B$ 为两个子晶格 A 和 B 之间的相对位移矢量。这个相对坐标的运动方程，可被视为一个约化质量为 $\\mu = \\frac{M_A M_B}{M_A + M_B}$ 的谐振子，可以写为：\n$$\n\\mu \\frac{d^2\\mathbf{w}}{dt^2} = \\mathbf{F}_{\\text{SR}} + \\mathbf{F}_{\\text{LR}}\n$$\n其中 $\\mathbf{F}_{\\text{SR}}$ 是短程恢复力，$\\mathbf{F}_{\\text{LR}}$ 是由宏观电场引起的长程力。\n\n短程力定义了横向光学 (TO) 频率 $\\omega_{\\text{TO}}$，因为对于横波（宏观电场为零），这是唯一存在的作用力。我们可以将其写为 $\\mathbf{F}_{\\text{SR}} = -\\mu \\omega_{\\text{TO}}^2 \\mathbf{w}$。\n\n长程力源于离子与宏观电场 $\\mathbf{E}$ 之间的相互作用。作用在离子 $\\kappa$ 上的力由 $q_{\\kappa} \\mathbf{E}$ 给出，其中 $q_{\\kappa}$ 是其有效电荷。对于相对运动，有效力由有效电荷 $Z^{*}_{\\text{mode}}$ 驱动。对于给定的具有各向同性电荷 $Z_A^*=Z^*e\\,\\mathbf{I}$ 和 $Z_B^*=-Z^*e\\,\\mathbf{I}$ 的双原子晶体，作用在相对坐标上的力是 $Z^*e\\mathbf{E}$。因此，$\\mathbf{F}_{\\text{LR}} = Z^* e \\mathbf{E}$。我们记模式电荷为 $Q^* = Z^*e$。\n运动方程为：\n$$\n\\mu \\frac{d^2\\mathbf{w}}{dt^2} = -\\mu\\omega_{\\text{TO}}^2 \\mathbf{w} + Q^* \\mathbf{E}\n$$\n由晶格位移引起的宏观极化强度 $\\mathbf{P}$ 由单位体积内的总偶极矩给出。对于相对位移 $\\mathbf{w}$，这表示为：\n$$\n\\mathbf{P} = \\frac{Q^*}{\\Omega} \\mathbf{w}\n$$\n其中 $\\Omega$ 是原胞体积。\n\n对于沿方向 $\\hat{\\mathbf{q}}$ 传播的纵向模式，位移 $\\mathbf{w}$、极化强度 $\\mathbf{P}$ 和电场 $\\mathbf{E}$ 都与 $\\hat{\\mathbf{q}}$ 平行。在没有自由电荷的区域，电位移场 $\\mathbf{D}$ 的散度为零：$\\nabla \\cdot \\mathbf{D} = 0$。在傅里叶空间中，此条件变为 $\\mathbf{q} \\cdot \\mathbf{D}(\\mathbf{q}) = 0$。本构关系为 $\\mathbf{D} = \\boldsymbol{\\epsilon}^{\\infty} \\mathbf{E} + 4\\pi\\mathbf{P}$，其中 $\\boldsymbol{\\epsilon}^{\\infty}$ 是高频介电张量。\n对于纵波，这给出：\n$$\n\\hat{\\mathbf{q}} \\cdot (\\boldsymbol{\\epsilon}^{\\infty} \\mathbf{E} + 4\\pi\\mathbf{P}) = 0\n$$\n由于 $\\mathbf{E} = E\\hat{\\mathbf{q}}$ 和 $\\mathbf{P} = P\\hat{\\mathbf{q}}$，我们可以写出：\n$$\n(\\hat{\\mathbf{q}} \\cdot \\boldsymbol{\\epsilon}^{\\infty} \\hat{\\mathbf{q}}) E + 4\\pi P = 0\n$$\n这给出了以极化强度表示的宏观电场：\n$$\n\\mathbf{E} = E\\hat{\\mathbf{q}} = -\\frac{4\\pi P}{\\hat{\\mathbf{q}} \\cdot \\boldsymbol{\\epsilon}^{\\infty} \\hat{\\mathbf{q}}} \\hat{\\mathbf{q}} = -\\frac{4\\pi \\mathbf{P}}{\\hat{\\mathbf{q}} \\cdot \\boldsymbol{\\epsilon}^{\\infty} \\cdot \\hat{\\mathbf{q}}}\n$$\n现在，我们将 $\\mathbf{P}$ 关于 $\\mathbf{w}$ 的表达式代入：\n$$\n\\mathbf{E} = -\\frac{4\\pi}{\\hat{\\mathbf{q}} \\cdot \\boldsymbol{\\epsilon}^{\\infty} \\cdot \\hat{\\mathbf{q}}} \\left(\\frac{Q^*}{\\Omega}\\mathbf{w}\\right)\n$$\n将此电场代回运动方程：\n$$\n\\mu \\frac{d^2\\mathbf{w}}{dt^2} = -\\mu\\omega_{\\text{TO}}^2 \\mathbf{w} - Q^* \\left(\\frac{4\\pi Q^*}{\\Omega(\\hat{\\mathbf{q}} \\cdot \\boldsymbol{\\epsilon}^{\\infty} \\cdot \\hat{\\mathbf{q}})}\\mathbf{w}\\right)\n$$\n对于在纵向光学频率 $\\omega_{\\text{LO}}$ 下的谐振，我们有 $\\frac{d^2\\mathbf{w}}{dt^2} = -\\omega_{\\text{LO}}^2 \\mathbf{w}$。\n$$\n-\\mu\\omega_{\\text{LO}}^2 \\mathbf{w} = -\\mu\\omega_{\\text{TO}}^2 \\mathbf{w} - \\frac{4\\pi (Q^*)^2}{\\Omega(\\hat{\\mathbf{q}} \\cdot \\boldsymbol{\\epsilon}^{\\infty} \\cdot \\hat{\\mathbf{q}})} \\mathbf{w}\n$$\n两边同除以 $-\\mathbf{w}$ 并重新整理，我们得到：\n$$\n\\mu\\omega_{\\text{LO}}^2(\\hat{\\mathbf{q}}) = \\mu\\omega_{\\text{TO}}^2 + \\frac{4\\pi (Q^*)^2}{\\Omega(\\hat{\\mathbf{q}} \\cdot \\boldsymbol{\\epsilon}^{\\infty} \\cdot \\hat{\\mathbf{q}})}\n$$\n因此，LO-TO 劈裂 $\\Delta \\omega^{2}(\\hat{\\mathbf{q}}) \\equiv \\omega_{\\mathrm{LO}}^{2}(\\hat{\\mathbf{q}}) - \\omega_{\\mathrm{TO}}^{2}$ 由以下封闭形式表达式给出：\n$$\n\\Delta \\omega^{2}(\\hat{\\mathbf{q}}) = \\frac{4\\pi (Z^*e)^2}{\\mu\\Omega(\\hat{\\mathbf{q}} \\cdot \\boldsymbol{\\epsilon}^{\\infty} \\cdot \\hat{\\mathbf{q}})}\n$$\n\n### 比率的计算\n我们被要求计算比率 $R \\equiv \\frac{\\Delta \\omega^{2}(\\hat{\\mathbf{q}} = [100])}{\\Delta \\omega^{2}(\\hat{\\mathbf{q}} = [001])}$。\n令 $\\hat{\\mathbf{q}}_1 = [100]$ 为单位矢量 $(1, 0, 0)$，$\\hat{\\mathbf{q}}_2 = [001]$ 为单位矢量 $(0, 0, 1)$。\n使用推导出的 $\\Delta \\omega^2(\\hat{\\mathbf{q}})$ 表达式：\n$$\nR = \\frac{\\Delta \\omega^{2}(\\hat{\\mathbf{q}}_1)}{\\Delta \\omega^{2}(\\hat{\\mathbf{q}}_2)} = \\frac{\\frac{4\\pi (Z^*e)^2}{\\mu\\Omega(\\hat{\\mathbf{q}}_1 \\cdot \\boldsymbol{\\epsilon}^{\\infty} \\cdot \\hat{\\mathbf{q}}_1)}}{\\frac{4\\pi (Z^*e)^2}{\\mu\\Omega(\\hat{\\mathbf{q}}_2 \\cdot \\boldsymbol{\\epsilon}^{\\infty} \\cdot \\hat{\\mathbf{q}}_2)}}\n$$\n常数前因子 $\\frac{4\\pi (Z^*e)^2}{\\mu\\Omega}$ 会被约去。这意味着此次计算不需要 $Z^*$、$M_A$、$M_B$ 和 $\\Omega$ 的值。该比率简化为：\n$$\nR = \\frac{\\hat{\\mathbf{q}}_2 \\cdot \\boldsymbol{\\epsilon}^{\\infty} \\cdot \\hat{\\mathbf{q}}_2}{\\hat{\\mathbf{q}}_1 \\cdot \\boldsymbol{\\epsilon}^{\\infty} \\cdot \\hat{\\mathbf{q}}_1}\n$$\n高频介电张量为 $\\boldsymbol{\\epsilon}^{\\infty} = \\mathrm{diag}(5.50,\\,5.50,\\,3.30)$。\n我们计算分子和分母中的项。\n对于分母，当 $\\hat{\\mathbf{q}}_1 = (1, 0, 0)$ 时：\n$$\n\\hat{\\mathbf{q}}_1 \\cdot \\boldsymbol{\\epsilon}^{\\infty} \\cdot \\hat{\\mathbf{q}}_1 = \\begin{pmatrix} 1 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} 5.50 & 0 & 0 \\\\ 0 & 5.50 & 0 \\\\ 0 & 0 & 3.30 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\epsilon^{\\infty}_{xx} = 5.50\n$$\n对于分子，当 $\\hat{\\mathbf{q}}_2 = (0, 0, 1)$ 时：\n$$\n\\hat{\\mathbf{q}}_2 \\cdot \\boldsymbol{\\epsilon}^{\\infty} \\cdot \\hat{\\mathbf{q}}_2 = \\begin{pmatrix} 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} 5.50 & 0 & 0 \\\\ 0 & 5.50 & 0 \\\\ 0 & 0 & 3.30 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\epsilon^{\\infty}_{zz} = 3.30\n$$\n将这些值代入 R 的表达式中：\n$$\nR = \\frac{3.30}{5.50} = \\frac{33}{55} = \\frac{3}{5} = 0.6\n$$\n题目要求答案四舍五入到四位有效数字。\n$$\nR = 0.6000\n$$",
            "answer": "$$\\boxed{0.6000}$$"
        },
        {
            "introduction": "最后，我们将研究DFPT最强大的预测性应用之一：通过软声子模式识别结构不稳定性。本题使用一个钙钛矿晶体的有效模型，来演示布里渊区边界上的虚频声子如何预示着即将发生的相变。通过将这种倒空间中的不稳定性映射到实空间中的原子位移模式，你将深入理解DFPT计算如何能够预测和解释材料中复杂的结构相变 。",
            "id": "3800621",
            "problem": "考虑一个 $\\text{ABO}_3$ 形式的立方钙钛矿在其高对称相中的情况。密度泛函微扰理论 (DFPT) 通过计算电子基态能量相对于周期性原子位移的二阶导数来计算晶格振动特性，从而提供倒易空间中的动力学矩阵。当给定波矢下动力学矩阵的最低本征值为负时，就存在软声子模式，这对应于一个虚频，并表明存在结构不稳定性。在立方钙钛矿中，反铁畸变倾转不稳定性通常与布里渊区边界点（如 $\\text{R}$ 点）相关联。\n\n从一个针对刚性八面体倾转自由度的谐波、最近邻有效哈密顿量出发，设每个晶胞有三个独立的转动坐标 $\\theta_x$、$\\theta_y$ 和 $\\theta_z$（分别表示绕 $x$、$y$ 和 $z$ 轴的倾转）。有效能量为\n$$\nE = \\frac{1}{2}\\sum_{\\mathbf{R}}\\sum_{i\\in\\{x,y,z\\}}\\left[\\kappa_i\\,\\theta_i(\\mathbf{R})^2 + J_i \\sum_{\\boldsymbol{\\delta}\\in\\{\\pm a\\hat{\\mathbf{x}},\\pm a\\hat{\\mathbf{y}},\\pm a\\hat{\\mathbf{z}}\\}} \\theta_i(\\mathbf{R})\\,\\theta_i(\\mathbf{R}+\\boldsymbol{\\delta})\\right],\n$$\n其中 $\\mathbf{R}$ 遍历所有布拉伐格矢，$a$ 是立方晶格常数，$\\kappa_i$ 是在位刚度，$J_i$ 是最近邻耦合。在倒易空间中，并在 $\\theta_x$、$\\theta_y$ 和 $\\theta_z$ 之间解耦的假设下，每个倾转分量的动力学矩阵是对角的，其对角元为\n$$\nD_i(\\mathbf{q}) = \\kappa_i + 2 J_i \\left[\\cos(q_x a) + \\cos(q_y a) + \\cos(q_z a)\\right],\n$$\n并且，为简化起见采用单位转动惯量，分量 $i$ 的声子频率平方为 $\\omega_i(\\mathbf{q})^2 = D_i(\\mathbf{q})$。当 $\\min_{i} D_i(\\mathbf{q}_\\text{R})  0$ 时，在 $\\text{R}$ 点 $\\mathbf{q}_\\text{R} = \\left(\\frac{\\pi}{a},\\frac{\\pi}{a},\\frac{\\pi}{a}\\right)$ 出现软模式。\n\n为了可视化相应的实空间倾转模式，构建一个 $2\\times 2 \\times 2$ 的超胞，并通过相位因子将本征矢映射到实空间。对于波矢为 $\\mathbf{q}$、晶胞周期性本征矢为 $e_i(\\mathbf{q})$（为简化起见，取其振幅为均匀）的单-$\\mathbf{q}$ 模式，在晶胞位置 $\\mathbf{R} = (n_x a, n_y a, n_z a)$ 处（其中 $n_x,n_y,n_z \\in \\{0,1\\}$）分量 $i$ 的位移模式正比于\n$$\nu_i(\\mathbf{R}) \\propto \\Re\\left[e^{\\mathrm{i}\\,\\mathbf{q}\\cdot \\mathbf{R}}\\right] = \\cos\\left(\\mathbf{q}\\cdot \\mathbf{R}\\right).\n$$\n在 $\\mathbf{q}_\\text{R}$ 点，这得到 $u_i(\\mathbf{R}) \\propto \\cos\\left[\\pi\\,(n_x+n_y+n_z)\\right]$，即相邻晶胞间的符号交替，这对应于Glazer标记法中的 $\\text{a}^-\\text{a}^-\\text{a}^-$ 倾转模式。此过程将 DFPT 到实空间的映射在超胞中具体化。\n\n你需要实现一个程序，该程序针对一组参数情况，计算高对称点 $\\Gamma$、$\\text{X}$、$\\text{M}$ 和 $\\text{R}$ 处的最低声子频率平方，并针对 $\\text{R}$ 点，使用上述余弦规则生成 $2\\times 2 \\times 2$ 超胞上的实空间符号模式。具体要求如下：\n- 使用波矢（在倒易空间中）$\\mathbf{q}_\\Gamma = (0,0,0)$、$\\mathbf{q}_\\text{X} = \\left(\\frac{\\pi}{a},0,0\\right)$、$\\mathbf{q}_\\text{M} = \\left(\\frac{\\pi}{a},\\frac{\\pi}{a},0\\right)$ 和 $\\mathbf{q}_\\text{R} = \\left(\\frac{\\pi}{a},\\frac{\\pi}{a},\\frac{\\pi}{a}\\right)$。\n- 对每种情况，在上述每个 $\\mathbf{q}$ 点计算 $\\min_{i\\in\\{x,y,z\\}} D_i(\\mathbf{q})$。将这四个最小值报告为浮点数。\n- 对于 $\\text{R}$ 点软模式的可视化，报告一个包含8个整数的列表，这些整数对应于8个位置 $\\mathbf{R} = (n_x a, n_y a, n_z a)$（其中 $n_x,n_y,n_z\\in\\{0,1\\}$）处 $u(\\mathbf{R})$ 的符号，按 $(n_x,n_y,n_z)$ 的字典序排列。如果 $\\cos(\\mathbf{q}_\\text{R}\\cdot \\mathbf{R}) \\ge 0$，则每个符号应为 $+1$，否则为 $-1$。\n- 同时报告一个布尔值，指示 $\\text{R}$ 点是否为软模式，即 $\\min_{i} D_i(\\mathbf{q}_\\text{R})  0$ 是否成立。\n\n假设使用无量纲单位，其中 $a$ 被视为纯数字，所有角度量均以弧度为单位。输出不需要物理单位。\n\n测试套件：\n使用以下参数集，每集由晶格常数 $a$、刚度 $(\\kappa_x,\\kappa_y,\\kappa_z)$ 和耦合 $(J_x,J_y,J_z)$ 指定：\n- 情况 1：$a=1$，$(\\kappa_x,\\kappa_y,\\kappa_z)=(4,4,4)$，$(J_x,J_y,J_z)=(1,1,1)$。\n- 情况 2：$a=1$，$(\\kappa_x,\\kappa_y,\\kappa_z)=(6,6,6)$，$(J_x,J_y,J_z)=(1,1,1)$。\n- 情况 3：$a=1$，$(\\kappa_x,\\kappa_y,\\kappa_z)=(8,7,9)$，$(J_x,J_y,J_z)=(1.1,1.0,0.9)$。\n- 情况 4：$a=1$，$(\\kappa_x,\\kappa_y,\\kappa_z)=(5,5,7)$，$(J_x,J_y,J_z)=(1.1,1.2,1.0)$。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。此外层列表的每个元素对应一种情况，其本身是一个 $[\\min D(\\Gamma), \\min D(\\text{X}), \\min D(\\text{M}), \\min D(\\text{R}), \\text{soft\\_at\\_R}, \\text{pattern}]$ 形式的列表，其中 $\\text{soft\\_at\\_R}$ 是一个布尔值，$\\text{pattern}$ 是包含8个整数的列表。例如，整体结构应类似于 $[[\\cdots],[\\cdots],[\\cdots],[\\cdots]]$。确保角度以弧度为单位，并且在测试套件中将 $a$ 解释为等于 $1$ 的无量纲量。",
            "solution": "其理论基础是密度泛函微扰理论 (DFPT)，它从基态能量相对于原子位移的二阶导数提供声子动力学矩阵。对于晶格振动，中心原理是波矢 $\\mathbf{q}$ 处的声子频率平方是质量归一化动力学矩阵的本征值：\n$$\n\\omega^2(\\mathbf{q}) \\text{是} \\mathbf{D}(\\mathbf{q}) \\text{的本征值},\n$$\n其中 $\\mathbf{D}(\\mathbf{q})$ 汇集了总能量相对于周期性位移的二阶导数。当 $\\omega^2(\\mathbf{q})  0$ 时，该模式是软的（虚频），预示着一种不稳定性，通常对应于对称性破缺的畸变。\n\n为将此理论具体应用于钙钛矿倾转的背景，考虑每个晶胞有三个解耦的转动（倾转）自由度：$\\theta_x$、$\\theta_y$ 和 $\\theta_z$，它们描述了氧八面体围绕笛卡尔坐标轴的刚性转动。仅包含在位刚度 $\\kappa_i$ 和沿立方轴的最近邻耦合 $J_i$ 的最简单的谐波有效哈密顿量为\n$$\nE = \\frac{1}{2}\\sum_{\\mathbf{R}}\\sum_{i\\in\\{x,y,z\\}}\\left[\\kappa_i\\,\\theta_i(\\mathbf{R})^2 + J_i \\sum_{\\boldsymbol{\\delta}\\in\\{\\pm a\\hat{\\mathbf{x}},\\pm a\\hat{\\mathbf{y}},\\pm a\\hat{\\mathbf{z}}\\}} \\theta_i(\\mathbf{R})\\,\\theta_i(\\mathbf{R}+\\boldsymbol{\\delta})\\right].\n$$\n通过傅里叶变换到倒易空间，使用 $\\theta_i(\\mathbf{R}) = \\frac{1}{\\sqrt{N}}\\sum_{\\mathbf{q}} \\theta_i(\\mathbf{q}) e^{\\mathrm{i}\\,\\mathbf{q}\\cdot \\mathbf{R}}$，并注意到简单立方晶格上的最近邻相互作用会产生几何因子 $2[\\cos(q_x a)+\\cos(q_y a)+\\cos(q_z a)]$，能量在 $\\mathbf{q}$ 和倾转分量上都变为对角化的：\n$$\nE = \\frac{1}{2}\\sum_{\\mathbf{q}}\\sum_{i\\in\\{x,y,z\\}} \\left[\\kappa_i + 2 J_i \\left(\\cos(q_x a) + \\cos(q_y a) + \\cos(q_z a)\\right)\\right]\\,|\\theta_i(\\mathbf{q})|^2.\n$$\n因此，在这个简化模型中，质量归一化的动力学矩阵是对角的，其对角元为\n$$\nD_i(\\mathbf{q}) = \\kappa_i + 2 J_i \\left[\\cos(q_x a) + \\cos(q_y a) + \\cos(q_z a)\\right].\n$$\n对每个转动坐标采用单位转动惯量（这样质量归一化就变得微不足道），倾转分量 $i$ 的声子频率平方就是 $\\omega_i(\\mathbf{q})^2 = D_i(\\mathbf{q})$。在给定的 $\\mathbf{q}$ 处的最低模式则是 $\\min_{i\\in\\{x,y,z\\}} D_i(\\mathbf{q})$。当这个最小值为负时，就会出现软模式。\n\n简单立方晶格的布里渊区边界点包括 $\\mathbf{q}_\\text{X} = \\left(\\frac{\\pi}{a},0,0\\right)$、$\\mathbf{q}_\\text{M} = \\left(\\frac{\\pi}{a},\\frac{\\pi}{a},0\\right)$ 和 $\\mathbf{q}_\\text{R} = \\left(\\frac{\\pi}{a},\\frac{\\pi}{a},\\frac{\\pi}{a}\\right)$。在 $\\text{R}$ 点，所有三个笛卡尔分量的余弦项都变为 $\\cos(\\pi) = -1$，所以它们的和是 $-3$，几何因子是 $-6$，得到\n$$\nD_i(\\mathbf{q}_\\text{R}) = \\kappa_i - 6 J_i.\n$$\n因此，对于正的 $J_i$，足够小的 $\\kappa_i$ 会导致 $D_i(\\mathbf{q}_\\text{R})  0$，即一个软的 $\\text{R}$ 点模式，这是在诸如钛酸锶 ($\\text{SrTiO}_3$) 和钛酸钙 ($\\text{CaTiO}_3$) 等钙钛矿中常见的反铁畸变倾转不稳定性的标志。\n\n为了在 $2\\times 2\\times 2$ 超胞中可视化与单-$\\mathbf{q}$ 模式相对应的实空间模式，使用通过相位因子映射本征矢的方法：\n$$\nu_i(\\mathbf{R}) \\propto \\Re\\left[e^{\\mathrm{i}\\,\\mathbf{q}\\cdot \\mathbf{R}}\\right] = \\cos\\left(\\mathbf{q}\\cdot \\mathbf{R}\\right),\n$$\n其中 $\\mathbf{R} = (n_x a, n_y a, n_z a)$ 且 $n_x,n_y,n_z\\in\\{0,1\\}$。在 $\\mathbf{q}_\\text{R}$ 点，可以得到\n$$\nu_i(\\mathbf{R}) \\propto \\cos\\left[\\pi\\,(n_x+n_y+n_z)\\right] = (-1)^{n_x+n_y+n_z},\n$$\n这表示沿所有三个轴，相邻晶胞间的符号交替。这正是Glazer标记法中的 $\\text{a}^-\\text{a}^-\\text{a}^-$ 倾转模式，其中沿每个轴的转动都是异相的。\n\n程序的算法设计：\n- 用 $a$、向量 $(\\kappa_x,\\kappa_y,\\kappa_z)$ 和向量 $(J_x,J_y,J_z)$ 来表示参数集。\n- 定义四个高对称 $\\mathbf{q}$ 点：$\\Gamma$、$\\text{X}$、$\\text{M}$ 和 $\\text{R}$，单位为弧度（三角函数中的角度必须是弧度）。\n- 对于每种情况和每个 $\\mathbf{q}$，计算 $\\cos(q_x a)$、$\\cos(q_y a)$ 和 $\\cos(q_z a)$，将它们相加，乘以 $2$，然后按分量与按 $(J_x,J_y,J_z)$ 缩放的 $(\\kappa_x,\\kappa_y,\\kappa_z)$ 相加，得到 $(D_x,D_y,D_z)$。\n- 取各分量中的最小值，得到该 $\\mathbf{q}$ 点的最低频率平方。\n- 对于 $\\text{R}$ 点，构建8个超胞位置 $\\mathbf{R}=(n_x a,n_y a,n_z a)$，其中 $n_x,n_y,n_z \\in \\{0,1\\}$，并计算 $\\cos(\\mathbf{q}_\\text{R}\\cdot \\mathbf{R})$ 的符号，当其非负时返回 $+1$，否则返回 $-1$。\n- 同时计算 $\\text{R}$ 点软化的布尔标志：$\\min_{i} D_i(\\mathbf{q}_\\text{R})0$。\n- 将所有情况的结果汇总到一个列表中，并作为单行打印。\n\n测试套件包括四种情况：\n- 情况 1：$a=1$, $(\\kappa_x,\\kappa_y,\\kappa_z)=(4,4,4)$, $(J_x,J_y,J_z)=(1,1,1)$，预期在 $\\text{R}$ 点有软模式，因为 $4-6\\cdot 1=-20$。\n- 情况 2：$a=1$, $(\\kappa_x,\\kappa_y,\\kappa_z)=(6,6,6)$, $(J_x,J_y,J_z)=(1,1,1)$，一个边界情况，在 $\\text{R}$ 点处为 $6-6\\cdot 1=0$。\n- 情况 3：$a=1$, $(\\kappa_x,\\kappa_y,\\kappa_z)=(8,7,9)$, $(J_x,J_y,J_z)=(1.1,1.0,0.9)$，预期在 $\\text{R}$ 点稳定，因为每个分量的 $\\kappa_i - 6J_i > 0$。\n- 情况 4：$a=1$, $(\\kappa_x,\\kappa_y,\\kappa_z)=(5,5,7)$, $(J_x,J_y,J_z)=(1.1,1.2,1.0)$，各向异性的，在 $\\text{R}$ 点至少有一个分量可能是软的（例如，对于 $y$ 分量，$5-6\\cdot 1.2=-2.20$）。\n\n所有计算均在无量纲单位下进行；角度以弧度为单位；最终输出为指定的浮点数、布尔值和整数列表。$\\text{R}$ 点实空间模式的构建为 DFPT 识别出的超胞中软模式提供了直观的可视化。这种方法将倒易空间中的软化与实空间中的Glazer倾转模式联系起来，而无需明确的原子坐标，但它抓住了对多尺度材料模拟至关重要的对称性和相关系。",
            "answer": "```python\nimport numpy as np\nimport json\n\ndef compute_min_d_values(a, kappa_vec, J_vec):\n    \"\"\"\n    Compute the minimum D_i(q) across i in {x,y,z} for q in {Gamma, X, M, R}.\n    Returns a dict with keys 'Gamma', 'X', 'M', 'R' mapping to float minima,\n    and the full D vectors for R if needed.\n    \"\"\"\n    # Define q-points in radians (angles expected in radians)\n    q_Gamma = np.array([0.0, 0.0, 0.0])\n    q_X = np.array([np.pi / a, 0.0, 0.0])\n    q_M = np.array([np.pi / a, np.pi / a, 0.0])\n    q_R = np.array([np.pi / a, np.pi / a, np.pi / a])\n\n    def D_vec(q):\n        cos_sum = np.cos(q[0] * a) + np.cos(q[1] * a) + np.cos(q[2] * a)\n        return kappa_vec + 2.0 * J_vec * cos_sum\n\n    D_Gamma = D_vec(q_Gamma)\n    D_X = D_vec(q_X)\n    D_M = D_vec(q_M)\n    D_R = D_vec(q_R)\n\n    min_Gamma = float(np.min(D_Gamma))\n    min_X = float(np.min(D_X))\n    min_M = float(np.min(D_M))\n    min_R = float(np.min(D_R))\n\n    return {\n        'Gamma': min_Gamma,\n        'X': min_X,\n        'M': min_M,\n        'R': min_R,\n        'D_R_vec': D_R\n    }\n\ndef r_point_pattern(a):\n    \"\"\"\n    Construct the 2x2x2 supercell sign pattern at the R point q = (pi/a, pi/a, pi/a).\n    Returns a list of 8 integers (+1 or -1) ordered lexicographically by (nx, ny, nz).\n    \"\"\"\n    q_R = np.array([np.pi / a, np.pi / a, np.pi / a])\n    pattern = []\n    for nx in [0, 1]:\n        for ny in [0, 1]:\n            for nz in [0, 1]:\n                R = np.array([nx * a, ny * a, nz * a])\n                phase = float(np.dot(q_R, R))\n                val = np.cos(phase)\n                sign = 1 if val >= 0.0 else -1\n                pattern.append(sign)\n    return pattern\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Each case: (a, kappa_vec, J_vec)\n        (1.0, np.array([4.0, 4.0, 4.0]), np.array([1.0, 1.0, 1.0])),\n        (1.0, np.array([6.0, 6.0, 6.0]), np.array([1.0, 1.0, 1.0])),\n        (1.0, np.array([8.0, 7.0, 9.0]), np.array([1.1, 1.0, 0.9])),\n        (1.0, np.array([5.0, 5.0, 7.0]), np.array([1.1, 1.2, 1.0])),\n    ]\n\n    results = []\n    for a, kappa_vec, J_vec in test_cases:\n        min_vals = compute_min_d_values(a, kappa_vec, J_vec)\n        pattern = r_point_pattern(a)\n        soft_at_R = bool(min_vals['R']  0.0)\n        result = [\n            min_vals['Gamma'],\n            min_vals['X'],\n            min_vals['M'],\n            min_vals['R'],\n            soft_at_R,\n            pattern\n        ]\n        results.append(result)\n\n    # Final print statement in the exact required format: single line, bracketed list.\n    # Use JSON to avoid spaces in separators.\n    print(json.dumps(results, separators=(',',':')))\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}