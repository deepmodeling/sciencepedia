{
    "hands_on_practices": [
        {
            "introduction": "The most direct way to determine surface energy in a simulation is by computing the excess energy required to create a surface from a bulk material. This exercise provides a foundational hands-on experience in applying the standard slab model formula, where you will calculate the surface energy, $\\gamma$, using pre-computed total energies from a Density Functional Theory (DFT) simulation . Performing this calculation reinforces the core concept of surface energy as the energy cost per unit area relative to a bulk reference.",
            "id": "3843480",
            "problem": "A stoichiometric, symmetric metallic slab is modeled using Density Functional Theory (DFT). The simulation is performed at $T=0$ so that entropic contributions vanish and the relevant quantity is the internal energy. The slab contains $N=200$ atoms of the same element, and the two opposing surfaces are crystallographically equivalent. The slab is thick enough that the two surfaces do not interact across the vacuum, and lateral strains are negligible. The computed total energy of the slab is $E_{\\text{slab}}=-685.000\\,\\text{eV}$. The bulk reference energy per atom, computed for the same element and exchange-correlation functional, is $E_{\\text{bulk}}=-3.500\\,\\text{eV}$. The surface area of one face of the slab is $A=100.00\\,\\text{\\AA}^{2}$.\n\nUsing only first principles definitions appropriate at $T=0$ for a stoichiometric symmetric slab, compute the surface energy $\\gamma$ of one surface. Express your final answer in $\\text{J/m}^2$ and round to four significant figures. Use the fundamental constants $1\\,\\text{eV}=1.602176634\\times 10^{-19}\\,\\text{J}$ and $1\\,\\text{\\AA}=10^{-10}\\,\\text{m}$. In your reasoning, explain the expected sign and typical magnitude of $\\gamma$ in the context of metallic bonding, but report only the requested numerical value as your final answer.",
            "solution": "The problem is deemed valid as it is scientifically grounded, well-posed, and objective. It presents a standard problem in computational materials science that can be solved using first principles. All necessary data are provided, and the conditions are physically consistent and clearly defined.\n\nThe surface energy, $\\gamma$, at temperature $T=0$, is defined as the excess Gibbs free energy per unit area associated with the creation of a surface. At $T=0$, entropic contributions vanish, and the Gibbs free energy becomes equal to the internal energy, $E$. Therefore, the surface energy is the excess internal energy per unit area of a surface relative to the bulk material.\n$$\n\\gamma = \\frac{E_{\\text{surface}}}{A}\n$$\nwhere $E_{\\text{surface}}$ is the total excess energy and $A$ is the surface area.\n\nFor a slab model as described, the total energy, $E_{\\text{slab}}$, is the sum of the energy of the atoms as if they were in the bulk and the excess energy due to the presence of the two surfaces. The energy of the atoms in the bulk reference state is the number of atoms, $N$, multiplied by the bulk energy per atom, $E_{\\text{bulk}}$.\nThe total excess energy for the entire slab is thus:\n$$\nE_{\\text{excess}} = E_{\\text{slab}} - N E_{\\text{bulk}}\n$$\nThe problem states that the slab is symmetric and thick enough that the two surfaces do not interact. This means the slab has two identical surfaces, each with area $A$. The total surface area created is $2A$. The excess energy is distributed equally between these two surfaces. Therefore, the surface energy $\\gamma$ for one surface is given by:\n$$\n\\gamma = \\frac{E_{\\text{slab}} - N E_{\\text{bulk}}}{2A}\n$$\nBefore calculating the numerical value, we consider the expected sign and magnitude of $\\gamma$. Creating a surface requires breaking the cohesive bonds that hold the atoms together in the bulk crystal. In a metal, these are strong metallic bonds. Breaking bonds is an endoergic process, meaning it requires an input of energy. Consequently, a system with a surface is at a higher energy state than the same number of atoms in the bulk. This implies that $E_{\\text{slab}}$ must be greater (less negative) than $N E_{\\text{bulk}}$, making the numerator $E_{\\text{slab}} - N E_{\\text{bulk}}$ a positive quantity. As the area $A$ is also positive, the surface energy $\\gamma$ must be positive. A negative surface energy would imply that a material could lower its energy by spontaneously increasing its surface area, which is unphysical. The magnitude of $\\gamma$ is related to the cohesive energy of the material (approximately $-E_{\\text{bulk}}$). For metals with cohesive energies of a few eV per atom, typical surface energies are on the order of $1\\,\\text{J/m}^2$.\n\nWe are given the following values:\n- Number of atoms, $N = 200$.\n- Total energy of the slab, $E_{\\text{slab}} = -685.000\\,\\text{eV}$.\n- Bulk energy per atom, $E_{\\text{bulk}} = -3.500\\,\\text{eV}$.\n- Area of one surface, $A = 100.00\\,\\text{\\AA}^{2}$.\n\nFirst, we calculate the excess energy, $E_{\\text{excess}}$:\n$$\nE_{\\text{excess}} = (-685.000\\,\\text{eV}) - (200 \\times -3.500\\,\\text{eV})\n$$\n$$\nE_{\\text{excess}} = -685.000\\,\\text{eV} - (-700.000\\,\\text{eV})\n$$\n$$\nE_{\\text{excess}} = 15.000\\,\\text{eV}\n$$\nThe total surface area is $2A$:\n$$\n2A = 2 \\times 100.00\\,\\text{\\AA}^{2} = 200.00\\,\\text{\\AA}^{2}\n$$\nNow we compute the surface energy $\\gamma$ in units of $\\text{eV}/\\text{\\AA}^{2}$:\n$$\n\\gamma = \\frac{15.000\\,\\text{eV}}{200.00\\,\\text{\\AA}^{2}} = 0.075000\\,\\frac{\\text{eV}}{\\text{\\AA}^{2}}\n$$\nThe problem requires the final answer to be in units of $\\text{J/m}^2$. We use the provided conversion factors:\n- $1\\,\\text{eV} = 1.602176634 \\times 10^{-19}\\,\\text{J}$\n- $1\\,\\text{\\AA} = 10^{-10}\\,\\text{m}$, which implies $1\\,\\text{\\AA}^{2} = (10^{-10}\\,\\text{m})^{2} = 10^{-20}\\,\\text{m}^{2}$\n\nThe conversion factor for surface energy is:\n$$\n1\\,\\frac{\\text{eV}}{\\text{\\AA}^{2}} = \\frac{1.602176634 \\times 10^{-19}\\,\\text{J}}{10^{-20}\\,\\text{m}^{2}} = 16.02176634\\,\\frac{\\text{J}}{\\text{m}^{2}}\n$$\nApplying this conversion to our calculated $\\gamma$:\n$$\n\\gamma = 0.075000\\,\\frac{\\text{eV}}{\\text{\\AA}^{2}} \\times 16.02176634\\,\\frac{\\text{J}/\\text{m}^{2}}{\\text{eV}/\\text{\\AA}^{2}}\n$$\n$$\n\\gamma = 1.2016324755\\,\\frac{\\text{J}}{\\text{m}^{2}}\n$$\nFinally, we round the result to four significant figures as requested by the problem statement.\n$$\n\\gamma \\approx 1.202\\,\\frac{\\text{J}}{\\text{m}^{2}}\n$$\nThis value is positive and has a magnitude typical for metallic surfaces, consistent with our physical reasoning.",
            "answer": "$$\\boxed{1.202}$$"
        },
        {
            "introduction": "While the formula for surface energy is straightforward, obtaining an accurate value from a periodic slab calculation requires careful management of finite-size artifacts. The computed energy can be contaminated by spurious interactions between the two surfaces of the slab and between the slab and its periodic images across the vacuum. This practice guides you through the process of establishing convergence criteria for slab thickness and vacuum spacing to ensure these artifacts are minimized, a crucial step for any professional surface simulation .",
            "id": "3843422",
            "problem": "You are modeling surface formation energy using a repeated-slab approach under Periodic Boundary Conditions (PBC). The surface energy per unit area is defined as the excess energy per surface when cleaving a bulk solid into two surfaces, $$\\gamma = \\dfrac{E_{\\text{slab}} - N E_{\\text{bulk}}}{2A},$$ where $E_{\\text{slab}}$ is the total energy of a slab with $N$ atomic layers and cross-sectional area $A$, and $E_{\\text{bulk}}$ is the bulk energy per layer. In a finite-slab, finite-vacuum supercell, the computed $\\gamma$ deviates from its semi-infinite limit $\\gamma_{\\infty}$ due to two physically distinct finite-size interactions that are well-tested to decay rapidly under screening:\n- Inter-surface coupling across the slab interior, which decays with the number of layers $n$, and\n- Inter-image coupling across vacuum due to the periodic replicas, which decays with vacuum thickness $L_{\\text{vac}}$.\n\nAssume the following two foundational physical facts hold for a wide class of non-pathological materials:\n1. The residual inter-surface interaction is bounded in magnitude by an exponentially decaying envelope, $$\\left|\\Delta_{\\text{slab}}(n)\\right| \\leq C_{\\text{s}} e^{-n/\\xi},$$ where $C_{\\text{s}} > 0$ is a material- and termination-dependent amplitude (in the same units as $\\gamma$), and $\\xi > 0$ is an effective screening length in units of layers.\n2. The residual inter-image interaction is bounded in magnitude by an exponentially decaying envelope, $$\\left|\\Delta_{\\text{vac}}(L_{\\text{vac}})\\right| \\leq C_{\\text{v}} e^{-\\kappa L_{\\text{vac}}},$$ where $C_{\\text{v}} > 0$ is an amplitude (in the same units as $\\gamma$), $\\kappa > 0$ is a decay constant (in inverse length), and $L_{\\text{vac}}$ is the vacuum thickness.\n\nYou will derive a sufficient convergence criterion on $(n, L_{\\text{vac}})$ to guarantee a target absolute tolerance $\\varepsilon$ for $\\gamma$, and then implement it to compute minimal $(n, L_{\\text{vac}})$ for several test cases.\n\nTasks:\n1) Using only the definition of $\\gamma$ above and the exponential error bounds for $\\Delta_{\\text{slab}}(n)$ and $\\Delta_{\\text{vac}}(L_{\\text{vac}})$, derive a sufficient condition that guarantees $$\\left|\\gamma(n, L_{\\text{vac}}) - \\gamma_{\\infty}\\right| \\leq \\varepsilon.$$ Constrain yourself to a simple, conservative resource allocation strategy in which each error source is assigned half of the total tolerance budget, i.e., $$\\left|\\Delta_{\\text{slab}}(n)\\right| \\leq \\varepsilon/2 \\quad \\text{and} \\quad \\left|\\Delta_{\\text{vac}}(L_{\\text{vac}})\\right| \\leq \\varepsilon/2.$$ From this, derive explicit inequalities for the minimal slab thickness $n_{\\min}$ (integer number of layers) and the minimal vacuum thickness $L_{\\text{vac},\\min}$ (nonnegative real length).\n2) Implement a program that, for each test case, computes:\n   - The smallest integer $n_{\\min} \\geq 1$ satisfying your derived slab criterion.\n   - The smallest nonnegative $L_{\\text{vac},\\min}$ satisfying your derived vacuum criterion, reported in ångström. Round $L_{\\text{vac},\\min}$ up to two decimal places (i.e., the next higher value with two digits after the decimal point). Express $L_{\\text{vac}}$ in ångström and $\\gamma$ and $\\varepsilon$ in joules per square meter.\n   - A boolean “plateau witness” that demonstrates approach to the semi-infinite limit: construct the sequence $$\\gamma(n) = \\gamma_{\\infty} + C_{\\text{s}} e^{-n/\\xi}$$ (i.e., take $L_{\\text{vac}} \\to \\infty$ to isolate the slab-thickness effect), evaluate this for integer $n$ from $n=1$ up to $$n_{\\text{end}} = n_{\\min} + \\max\\left(20, 10\\lceil \\xi \\rceil\\right),$$ and return true if the sequence is monotonically non-increasing and satisfies $$\\left|\\gamma(n_{\\text{end}}) - \\gamma_{\\infty}\\right| \\leq 10^{-8} \\text{ J m}^{-2}.$$ Otherwise return false. This quantitatively demonstrates the approach of $\\gamma(n)$ to a plateau as $n \\to \\infty$ under the assumed decay.\n3) Use the following test suite. For each case, compute and return $n_{\\min}$ (integer), $L_{\\text{vac},\\min}$ in ångström (rounded up to two decimals), and the plateau witness boolean. All parameters $C_{\\text{s}}$ and $C_{\\text{v}}$ and $\\gamma_{\\infty}$ and $\\varepsilon$ are in joules per square meter, $\\xi$ is in layers, $\\kappa$ is in inverse ångström, and $L_{\\text{vac}}$ is in ångström.\n   - Case A (happy path): $\\gamma_{\\infty} = 1.20$, $C_{\\text{s}} = 0.20$, $\\xi = 3.00$, $C_{\\text{v}} = 0.05$, $\\kappa = 0.80$, $\\varepsilon = 0.01$.\n   - Case B (edge with zero slab coupling): $\\gamma_{\\infty} = 0.85$, $C_{\\text{s}} = 0.00$, $\\xi = 1.00$, $C_{\\text{v}} = 0.03$, $\\kappa = 0.50$, $\\varepsilon = 0.005$.\n   - Case C (stringent tolerance): $\\gamma_{\\infty} = 1.00$, $C_{\\text{s}} = 0.10$, $\\xi = 2.00$, $C_{\\text{v}} = 0.02$, $\\kappa = 1.20$, $\\varepsilon = 0.001$.\n   - Case D (slow slab decay, fast vacuum decay): $\\gamma_{\\infty} = 1.50$, $C_{\\text{s}} = 0.08$, $\\xi = 10.00$, $C_{\\text{v}} = 0.01$, $\\kappa = 2.00$, $\\varepsilon = 0.02$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results for the four cases as a JSON-like list of lists: $$\\left[\\left[n_{\\min}^{(A)}, L_{\\text{vac},\\min}^{(A)}, b^{(A)}\\right], \\left[n_{\\min}^{(B)}, L_{\\text{vac},\\min}^{(B)}, b^{(B)}\\right], \\left[n_{\\min}^{(C)}, L_{\\text{vac},\\min}^{(C)}, b^{(C)}\\right], \\left[n_{\\min}^{(D)}, L_{\\text{vac},\\min}^{(D)}, b^{(D)}\\right]\\right],$$ where $b^{(\\cdot)}$ is the boolean plateau witness. The line must be printed exactly in this bracketed, comma-separated format with numerical values (integers for $n_{\\min}$, floats for $L_{\\text{vac},\\min}$ with two decimals, and booleans).",
            "solution": "The objective is to derive and implement a sufficient convergence criterion for calculating surface energy $\\gamma$ in a repeated-slab simulation. The criterion must guarantee that the computed value $\\gamma(n, L_{\\text{vac}})$ is within a specified absolute tolerance $\\varepsilon$ of the true semi-infinite limit $\\gamma_{\\infty}$, i.e., $|\\gamma(n, L_{\\text{vac}}) - \\gamma_{\\infty}| \\leq \\varepsilon$. Here, $n$ is the number of atomic layers in the slab and $L_{\\text{vac}}$ is the vacuum thickness.\n\nThe total error is assumed to be the sum of two independent contributions: an inter-surface coupling error $\\Delta_{\\text{slab}}(n)$ and an inter-image coupling error $\\Delta_{\\text{vac}}(L_{\\text{vac}})$.\n$$ \\gamma(n, L_{\\text{vac}}) - \\gamma_{\\infty} = \\Delta_{\\text{slab}}(n) + \\Delta_{\\text{vac}}(L_{\\text{vac}}) $$\nThe magnitudes of these errors are bounded by exponentially decaying functions as given in the problem statement:\n$$ |\\Delta_{\\text{slab}}(n)| \\leq C_{\\text{s}} e^{-n/\\xi} $$\n$$ |\\Delta_{\\text{vac}}(L_{\\text{vac}})| \\leq C_{\\text{v}} e^{-\\kappa L_{\\text{vac}}} $$\nUsing the triangle inequality, the magnitude of the total error is bounded:\n$$ |\\gamma(n, L_{\\text{vac}}) - \\gamma_{\\infty}| = |\\Delta_{\\text{slab}}(n) + \\Delta_{\\text{vac}}(L_{\\text{vac}})| \\leq |\\Delta_{\\text{slab}}(n)| + |\\Delta_{\\text{vac}}(L_{\\text{vac}})| $$\nTo ensure the total error is no more than $\\varepsilon$, it is sufficient to require:\n$$ |\\Delta_{\\text{slab}}(n)| + |\\Delta_{\\text{vac}}(L_{\\text{vac}})| \\leq \\varepsilon $$\n\nThe problem specifies a conservative error-budgeting strategy where each error source is allocated half of the total tolerance, $\\varepsilon/2$. This decouples the problem into two independent conditions:\n1. $|\\Delta_{\\text{slab}}(n)| \\leq \\varepsilon/2$\n2. $|\\Delta_{\\text{vac}}(L_{\\text{vac}})| \\leq \\varepsilon/2$\n\nWe use the given exponential bounds to find sufficient conditions on $n$ and $L_{\\text{vac}}$.\n\n**1. Derivation of Minimal Slab Thickness ($n_{\\min}$)**\n\nWe must satisfy the condition $C_{\\text{s}} e^{-n/\\xi} \\leq \\varepsilon/2$.\nWe seek the smallest integer $n_{\\min} \\geq 1$ that fulfills this inequality.\n\nFirst, consider the edge case where the slab-coupling amplitude $C_{\\text{s}} = 0$. The inequality becomes $0 \\leq \\varepsilon/2$, which is always true for any positive tolerance $\\varepsilon$. Thus, any number of layers $n \\geq 1$ is sufficient. The smallest integer value is $n_{\\min}=1$.\n\nNow, for $C_{\\text{s}} > 0$, we solve for $n$:\n$$ e^{-n/\\xi} \\leq \\frac{\\varepsilon}{2C_{\\text{s}}} $$\nIf $2C_{\\text{s}} \\leq \\varepsilon$, then $\\varepsilon/(2C_{\\text{s}}) \\geq 1$. Since $e^{-n/\\xi} \\leq 1$ for all $n \\geq 1$ and $\\xi > 0$, the inequality is satisfied for any $n \\geq 1$. The minimum is again $n_{\\min}=1$.\n\nIf $2C_{\\text{s}} > \\varepsilon$, we can take the natural logarithm of both sides:\n$$ -\\frac{n}{\\xi} \\leq \\ln\\left(\\frac{\\varepsilon}{2C_{\\text{s}}}\\right) $$\nMultiplying by $-\\xi$ (which is negative, as $\\xi>0$) reverses the inequality sign:\n$$ n \\geq -\\xi \\ln\\left(\\frac{\\varepsilon}{2C_{\\text{s}}}\\right) = \\xi \\ln\\left(\\left(\\frac{\\varepsilon}{2C_{\\text{s}}}\\right)^{-1}\\right) = \\xi \\ln\\left(\\frac{2C_{\\text{s}}}{\\varepsilon}\\right) $$\nSince $n$ must be an integer, we must take the ceiling of the right-hand side. The minimal integer $n_{\\min}$ is the smallest integer satisfying this, while also being at least $1$. Combining all cases, for $C_{\\text{s}} > 0$:\n$$ n_{\\min} = \\max\\left(1, \\left\\lceil \\xi \\ln\\left(\\frac{2C_{\\text{s}}}{\\varepsilon}\\right) \\right\\rceil\\right) $$\nThis expression correctly evaluates to $1$ when $2C_{\\text{s}} \\leq \\varepsilon$, as the argument of the logarithm is $\\leq 1$, making the logarithm $\\leq 0$.\n\n**2. Derivation of Minimal Vacuum Thickness ($L_{\\text{vac,min}}$)**\n\nWe must satisfy the condition $C_{\\text{v}} e^{-\\kappa L_{\\text{vac}}} \\leq \\varepsilon/2$.\nWe seek the smallest non-negative real number $L_{\\text{vac,min}}$ that fulfills this inequality. The parameter $C_{\\text{v}}$ is given as positive.\n\nWe solve for $L_{\\text{vac}}$:\n$$ e^{-\\kappa L_{\\text{vac}}} \\leq \\frac{\\varepsilon}{2C_{\\text{v}}} $$\nIf $2C_{\\text{v}} \\leq \\varepsilon$, then $\\varepsilon/(2C_{\\text{v}}) \\geq 1$. Since $e^{-\\kappa L_{\\text{vac}}} \\leq 1$ for non-negative $L_{\\text{vac}}$, the inequality is satisfied for all $L_{\\text{vac}} \\geq 0$. The minimal value is $L_{\\text{vac,min}} = 0$.\n\nIf $2C_{\\text{v}} > \\varepsilon$, we take the natural logarithm:\n$$ -\\kappa L_{\\text{vac}} \\leq \\ln\\left(\\frac{\\varepsilon}{2C_{\\text{v}}}\\right) $$\nDividing by $-\\kappa$ (which is negative, as $\\kappa>0$) reverses the inequality sign:\n$$ L_{\\text{vac}} \\geq -\\frac{1}{\\kappa} \\ln\\left(\\frac{\\varepsilon}{2C_{\\text{v}}}\\right) = \\frac{1}{\\kappa} \\ln\\left(\\frac{2C_{\\text{v}}}{\\varepsilon}\\right) $$\nThe minimal value is the lower bound. A single expression covering both cases is:\n$$ L_{\\text{vac,min}} = \\max\\left(0, \\frac{1}{\\kappa} \\ln\\left(\\frac{2C_{\\text{v}}}{\\varepsilon}\\right)\\right) $$\nThe problem requires this value to be rounded up to two decimal places.\n\n**3. Plateau Witness Logic**\n\nThe plateau witness verifies the convergence behavior for the slab thickness. It involves two checks on the model sequence $\\gamma(n) = \\gamma_{\\infty} + C_{\\text{s}} e^{-n/\\xi}$ for integers $n$ from $1$ to $n_{\\text{end}}$, where $n_{\\text{end}} = n_{\\min} + \\max(20, 10\\lceil \\xi \\rceil)$.\n\na) **Monotonicity**: The sequence must be monotonically non-increasing, i.e., $\\gamma(n) \\leq \\gamma(n-1)$ for $n=2, ..., n_{\\text{end}}$.\nFor $C_{\\text{s}} = 0$, $\\gamma(n) = \\gamma_{\\infty}$ is constant, which is non-increasing.\nFor $C_{\\text{s}} > 0$, since $e^{-x}$ is a strictly decreasing function, $\\gamma(n)$ is strictly decreasing.\nThus, this condition is always satisfied mathematically for the given model. The implementation will perform an explicit check as a demonstration.\n\nb) **Final Value Tolerance**: The error at the final point $n_{\\text{end}}$ must be below a very tight threshold, given as $10^{-8} \\text{ J m}^{-2}$.\n$$ |\\gamma(n_{\\text{end}}) - \\gamma_{\\infty}| \\leq 10^{-8} $$\nSubstituting the model sequence:\n$$ |(\\gamma_{\\infty} + C_{\\text{s}} e^{-n_{\\text{end}}/\\xi}) - \\gamma_{\\infty}| = C_{\\text{s}} e^{-n_{\\text{end}}/\\xi} \\leq 10^{-8} $$\nThe plateau witness is `True` if and only if both the (trivially true) monotonicity condition and this final value condition are met.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and implements a sufficient convergence criterion for surface energy calculations.\n    \"\"\"\n    test_cases = [\n        # Case A: (gamma_inf, Cs, xi, Cv, kappa, epsilon)\n        (1.20, 0.20, 3.00, 0.05, 0.80, 0.01),\n        # Case B\n        (0.85, 0.00, 1.00, 0.03, 0.50, 0.005),\n        # Case C\n        (1.00, 0.10, 2.00, 0.02, 1.20, 0.001),\n        # Case D\n        (1.50, 0.08, 10.00, 0.01, 2.00, 0.02),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        gamma_inf, Cs, xi, Cv, kappa, epsilon = case\n        \n        # --- Task 1: Calculate minimal slab thickness n_min ---\n        # The condition is Cs * exp(-n/xi) <= epsilon / 2.\n        # This implies n >= xi * ln(2*Cs / epsilon).\n        \n        n_min = 1\n        if Cs > 0:\n            val = 2 * Cs / epsilon\n            if val > 1:\n                n_min_calc = xi * np.log(val)\n                # n must be an integer, so we take the ceiling.\n                # It must be at least 1 layer.\n                n_min = int(np.ceil(n_min_calc))\n        if n_min  1:\n            n_min = 1\n            \n        # --- Task 1: Calculate minimal vacuum thickness L_vac_min ---\n        # The condition is Cv * exp(-kappa * L_vac) = epsilon / 2.\n        # This implies L_vac = (1/kappa) * ln(2*Cv / epsilon).\n        \n        L_vac_min = 0.0\n        val_vac = 2 * Cv / epsilon\n        if val_vac > 1:\n            L_vac_min = (1 / kappa) * np.log(val_vac)\n\n        # Round L_vac_min up to two decimal places.\n        L_vac_min_rounded = np.ceil(L_vac_min * 100) / 100\n\n        # --- Task 2: Compute the plateau witness ---\n        # Calculate n_end\n        n_end = n_min + int(np.max([20, 10 * np.ceil(xi)]))\n        \n        # a) Monotonicity check\n        # For the function gamma(n) = gamma_inf + Cs * exp(-n/xi),\n        # with Cs = 0 and xi  0, the sequence is always non-increasing.\n        # This check is mathematically guaranteed to pass.\n        is_monotonic = True\n        if Cs > 0: # If Cs is 0, sequence is constant, so non-increasing.\n            # Explicitly check for demonstration purposes, as requested.\n            val_prev = gamma_inf + Cs * np.exp(-1 / xi)\n            for n_i in range(2, n_end + 1):\n                val_curr = gamma_inf + Cs * np.exp(-n_i / xi)\n                if val_curr > val_prev:\n                    is_monotonic = False\n                    break\n                val_prev = val_curr\n                \n        # b) Final value check: |gamma(n_end) - gamma_inf| = 1e-8\n        final_value_error = Cs * np.exp(-n_end / xi)\n        is_converged_to_limit = final_value_error = 1e-8\n        \n        plateau_witness = is_monotonic and is_converged_to_limit\n        \n        results.append([n_min, L_vac_min_rounded, plateau_witness])\n\n    # Final print statement in the exact required format.\n    # The default string representation of a list of lists in Python\n    # matches the required JSON-like format.\n    # Example: [[12, 2.88, False], [1, 4.97, True], ...]\n    print(f\"{results}\")\n\nsolve()\n```"
        },
        {
            "introduction": "Not all surfaces are created equal; some, known as polar surfaces, have a net dipole moment perpendicular to the surface plane, which can lead to a divergence in the total energy. In periodic boundary conditions, this leads to a spurious electric field across the vacuum, making the surface energy calculation ill-defined. This advanced exercise demonstrates this critical issue and its solution by comparing a nonpolar surface with a polar one, both with and without an explicit dipole correction, highlighting a key practical challenge in modern materials simulation .",
            "id": "3843490",
            "problem": "A crystalline ionic solid has surfaces that can be modeled in Density Functional Theory (DFT) using periodic boundary conditions (PBC). The surface energy is defined as the reversible work per unit area required to create a surface from the bulk. For a slab calculation containing $N$ bulk formula units and lateral area $A$, with two free surfaces, the surface energy $ \\gamma $ is computed from total energies by subtracting the bulk reference and normalizing by area. For nonpolar symmetric slabs (both surfaces equivalent), this yields the per-surface energy. For polar asymmetric slabs (top and bottom surfaces inequivalent), the same normalization returns the arithmetic mean of the two surface energies. When the slab has a net dipole moment normal to the surface, the repeated-image vacuum region in PBC can host a uniform electric field. By Gauss’s law and the field energy density, the spurious electrostatic contribution scales with vacuum thickness, which can hinder convergence unless an explicit dipole correction is applied to cancel the field.\n\nStarting from these core principles:\n- The per-surface energy for a slab with two surfaces is obtained by normalizing the slab excess energy by $2A$.\n- The energy of an electric field is given by $U = \\dfrac{\\varepsilon_0}{2} \\int E^2 \\, dV$, so a uniform field in a vacuum region of thickness $L_{\\mathrm{vac}}$ adds a term that grows with $L_{\\mathrm{vac}}$.\n\nImplement a program that, for each provided test case, computes:\n1. The per-surface energy $ \\gamma_{100} $ for the nonpolar magnesium oxide (MgO) $(100)$ symmetric slab, and the per-surface mean energy $ \\gamma_{111} $ for the polar MgO $(111)$ asymmetric slab, both expressed in joules per square meter ($\\text{J/m}^2$).\n2. The differences $ \\Delta \\gamma_{\\mathrm{dc}} = \\gamma_{111}^{\\mathrm{(dc)}} - \\gamma_{100} $ and $ \\Delta \\gamma_{\\mathrm{no\\,dc}} = \\gamma_{111}^{\\mathrm{(no\\,dc)}} - \\gamma_{100} $, where “dc” denotes a calculation with an explicit dipole correction and “no dc” denotes a calculation without this correction.\n\nUse the following unit conversions in every calculation:\n- Electronvolt to joule: $1~\\mathrm{eV} = 1.602176634 \\times 10^{-19}~\\mathrm{J}$.\n- Square angstrom to square meter: $1~\\mathrm{\\AA}^2 = 1 \\times 10^{-20}~\\mathrm{m}^2$.\n\nTherefore, for a given slab with total energy $E_{\\mathrm{slab}}$ in electronvolts, bulk energy per formula unit $E_{\\mathrm{bulk}}$ in electronvolts, integer count $N$, and lateral area $A$ in square angstroms, compute the per-surface energy in joules per square meter as\n$$\n\\gamma = \\frac{\\left(E_{\\mathrm{slab}} - N \\, E_{\\mathrm{bulk}}\\right) \\times \\left(1.602176634 \\times 10^{-19}~\\mathrm{J/eV}\\right)}{2 \\, A \\times \\left(1 \\times 10^{-20}~\\mathrm{m}^2/\\mathrm{\\AA}^2\\right)}.\n$$\nThis normalization returns the per-surface value for a symmetric slab and the arithmetic mean of the top and bottom surfaces for an asymmetric slab.\n\nExpress all final differences $ \\Delta \\gamma $ in $\\text{J/m}^2$ as floats. Angles do not appear, so no angle unit is required.\n\nTest suite (all energies in electronvolts, areas in square angstroms, vacuum thicknesses in angstroms):\n- Global material parameters for all test cases:\n  - MgO bulk energy per formula unit: $E_{\\mathrm{bulk}} = -197.0$.\n  - MgO $(100)$ lateral area: $A_{100} = 17.7241$.\n  - MgO $(111)$ lateral area: $A_{111} = 7.6710$.\n\n- Test Case 1 (happy path: thick slabs, moderate vacuum):\n  - Slab counts: $N_{100} = 16$, $N_{111} = 16$.\n  - Vacuum thickness: $L_{\\mathrm{vac}} = 20.0$.\n  - DFT total energies:\n    - $E_{\\mathrm{slab},100} = -3149.7371$.\n    - $E_{\\mathrm{slab},111}^{\\mathrm{(dc)}} = -3146.6504$.\n    - $E_{\\mathrm{slab},111}^{\\mathrm{(no\\,dc)}} = -3145.1504$.\n\n- Test Case 2 (moderate slabs, smaller vacuum):\n  - Slab counts: $N_{100} = 8$, $N_{111} = 8$.\n  - Vacuum thickness: $L_{\\mathrm{vac}} = 15.0$.\n  - DFT total energies:\n    - $E_{\\mathrm{slab},100} = -1573.6671$.\n    - $E_{\\mathrm{slab},111}^{\\mathrm{(dc)}} = -1570.6104$.\n    - $E_{\\mathrm{slab},111}^{\\mathrm{(no\\,dc)}} = -1569.4104$.\n\n- Test Case 3 (edge case: very thin polar slab, small vacuum; pronounced asymmetry and field effects):\n  - Slab counts: $N_{100} = 3$, $N_{111} = 3$.\n  - Vacuum thickness: $L_{\\mathrm{vac}} = 8.0$.\n  - DFT total energies:\n    - $E_{\\mathrm{slab},100} = -588.2871$.\n    - $E_{\\mathrm{slab},111}^{\\mathrm{(dc)}} = -585.1304$.\n    - $E_{\\mathrm{slab},111}^{\\mathrm{(no\\,dc)}} = -584.2304$.\n\n- Test Case 4 (edge case: large vacuum; tests nonconvergence without dipole correction):\n  - Slab counts: $N_{100} = 8$, $N_{111} = 8$.\n  - Vacuum thickness: $L_{\\mathrm{vac}} = 30.0$.\n  - DFT total energies:\n    - $E_{\\mathrm{slab},100} = -1573.6671$.\n    - $E_{\\mathrm{slab},111}^{\\mathrm{(dc)}} = -1570.6104$.\n    - $E_{\\mathrm{slab},111}^{\\mathrm{(no\\,dc)}} = -1568.2104$.\n\nYour program must compute, for each test case, the pair $[\\Delta \\gamma_{\\mathrm{dc}}, \\Delta \\gamma_{\\mathrm{no\\,dc}}]$ in $\\text{J/m}^2$ and produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a two-element list. For example, the output format must resemble $[[x_1, y_1], [x_2, y_2], [x_3, y_3], [x_4, y_4]]$ with numeric values replacing $x_i$ and $y_i$.",
            "solution": "The problem is valid. It is scientifically grounded in the principles of computational materials science, specifically the calculation of surface energies from slab models in Density Functional Theory (DFT). The formulation is well-posed, objective, and provides all necessary data and equations for a unique, verifiable solution.\n\nThe central task is to compute surface energies, $\\gamma$, for different crystallographic orientations of magnesium oxide (MgO), and then to find the difference in energy relative to the stable $(100)$ surface. The calculation hinges on the fundamental definition of surface energy as the excess energy of a slab model relative to the bulk material, normalized by the surface area.\n\nThe formula for the per-surface energy, $\\gamma$, for a slab with two surfaces is given as:\n$$\n\\gamma = \\frac{E_{\\mathrm{slab}} - N E_{\\mathrm{bulk}}}{2A}\n$$\nwhere $E_{\\mathrm{slab}}$ is the total energy of the slab supercell, $E_{\\mathrm{bulk}}$ is the energy of a single bulk formula unit, $N$ is the number of formula units in the slab, and $A$ is the lateral area of the slab's surface. This formula provides the energy of a single surface for a symmetric slab and the arithmetic mean of the two different surface energies for an asymmetric slab.\n\nThe inputs are provided in electronvolts ($eV$) for energy and square angstroms ($\\mathrm{\\AA}^2$) for area. The desired output is in joules per square meter ($\\mathrm{J/m}^2$). The required conversion factors are:\n- $1~\\mathrm{eV} = 1.602176634 \\times 10^{-19}~\\mathrm{J}$\n- $1~\\mathrm{\\AA}^2 = 1 \\times 10^{-20}~\\mathrm{m}^2$\n\nIncorporating these conversions, the working equation becomes:\n$$\n\\gamma \\left[\\mathrm{J/m}^2\\right] = \\frac{\\left(E_{\\mathrm{slab}}[\\mathrm{eV}] - N E_{\\mathrm{bulk}}[\\mathrm{eV}]\\right) \\times (1.602176634 \\times 10^{-19}~\\mathrm{J/eV})}{2 \\times A[\\mathrm{\\AA}^2] \\times (1 \\times 10^{-20}~\\mathrm{m}^2/\\mathrm{\\AA}^2)}\n$$\nThis can be simplified by pre-calculating the conversion constant:\n$$\nC = \\frac{1.602176634 \\times 10^{-19}}{1 \\times 10^{-20}} = 16.02176634\n$$\nThus, the simplified formula is:\n$$\n\\gamma \\left[\\mathrm{J/m}^2\\right] = \\frac{E_{\\mathrm{slab}} - N E_{\\mathrm{bulk}}}{2A} \\times C\n$$\nThe problem requires the calculation of three surface energies for each test case:\n1. $\\gamma_{100}$: The surface energy of the nonpolar, symmetric MgO $(100)$ slab.\n2. $\\gamma_{111}^{\\mathrm{(dc)}}$: The mean surface energy of the polar, asymmetric MgO $(111)$ slab, calculated with a dipole correction.\n3. $\\gamma_{111}^{\\mathrm{(no\\,dc)}}$: The mean surface energy of the polar, asymmetric MgO $(111)$ slab, calculated without a dipole correction. The problem statement correctly notes that the energy of a polar slab without dipole correction is sensitive to the vacuum thickness, $L_{\\mathrm{vac}}$, due to a spurious electric field in the vacuum region under periodic boundary conditions. The provided total energies for the 'no dc' cases reflect this artifact.\n\nFrom these values, we compute two differences for each test case:\n- $\\Delta \\gamma_{\\mathrm{dc}} = \\gamma_{111}^{\\mathrm{(dc)}} - \\gamma_{100}$\n- $\\Delta \\gamma_{\\mathrm{no\\,dc}} = \\gamma_{111}^{\\mathrm{(no\\,dc)}} - \\gamma_{100}$\n\nWe will apply this procedure to each of the four test cases provided, using the global parameters $E_{\\mathrm{bulk}} = -197.0~\\mathrm{eV}$, $A_{100} = 17.7241~\\mathrm{\\AA}^2$, and $A_{111} = 7.6710~\\mathrm{\\AA}^2$.\n\nLet's illustrate the calculation for Test Case $1$:\n- Given: $N_{100} = 16$, $N_{111} = 16$, $E_{\\mathrm{slab},100} = -3149.7371~\\mathrm{eV}$, $E_{\\mathrm{slab},111}^{\\mathrm{(dc)}} = -3146.6504~\\mathrm{eV}$, and $E_{\\mathrm{slab},111}^{\\mathrm{(no\\,dc)}} = -3145.1504~\\mathrm{eV}$.\n\n1.  Calculate $\\gamma_{100}$:\n    - Excess energy $E_{\\mathrm{exc},100} = -3149.7371 - (16 \\times -197.0) = 2.2629~\\mathrm{eV}$.\n    - $\\gamma_{100} = \\frac{2.2629}{2 \\times 17.7241} \\times 16.02176634 \\approx 1.022759~\\mathrm{J/m}^2$.\n\n2.  Calculate $\\gamma_{111}^{\\mathrm{(dc)}}$:\n    - Excess energy $E_{\\mathrm{exc},111}^{\\mathrm{(dc)}} = -3146.6504 - (16 \\times -197.0) = 5.3496~\\mathrm{eV}$.\n    - $\\gamma_{111}^{\\mathrm{(dc)}} = \\frac{5.3496}{2 \\times 7.6710} \\times 16.02176634 \\approx 5.586683~\\mathrm{J/m}^2$.\n\n3.  Calculate $\\gamma_{111}^{\\mathrm{(no\\,dc)}}$:\n    - Excess energy $E_{\\mathrm{exc},111}^{\\mathrm{(no\\,dc)}} = -3145.1504 - (16 \\times -197.0) = 6.8496~\\mathrm{eV}$.\n    - $\\gamma_{111}^{\\mathrm{(no\\,dc)}} = \\frac{6.8496}{2 \\times 7.6710} \\times 16.02176634 \\approx 7.153106~\\mathrm{J/m}^2$.\n\n4.  Calculate the differences:\n    - $\\Delta \\gamma_{\\mathrm{dc}} = 5.586683 - 1.022759 = 4.563924~\\mathrm{J/m}^2$.\n    - $\\Delta \\gamma_{\\mathrm{no\\,dc}} = 7.153106 - 1.022759 = 6.130347~\\mathrm{J/m}^2$.\n\nThis same computational procedure is systematically applied to all four test cases to generate the final output. The implementation will encapsulate this logic in a reusable function.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes surface energy differences for MgO slabs based on DFT total energies.\n    \"\"\"\n    # Define unit conversions and global material parameters\n    EV_TO_J = 1.602176634e-19\n    ANG2_TO_M2 = 1e-20\n    CONVERSION_FACTOR = EV_TO_J / ANG2_TO_M2  # J*Å^2 / (eV*m^2)\n\n    E_BULK = -197.0  # eV\n    A_100 = 17.7241  # Å^2\n    A_111 = 7.6710   # Å^2\n\n    # Define the test cases from the problem statement\n    test_cases = [\n        {\n            \"N_100\": 16, \"N_111\": 16,\n            \"E_slab_100\": -3149.7371,\n            \"E_slab_111_dc\": -3146.6504,\n            \"E_slab_111_no_dc\": -3145.1504,\n        },\n        {\n            \"N_100\": 8, \"N_111\": 8,\n            \"E_slab_100\": -1573.6671,\n            \"E_slab_111_dc\": -1570.6104,\n            \"E_slab_111_no_dc\": -1569.4104,\n        },\n        {\n            \"N_100\": 3, \"N_111\": 3,\n            \"E_slab_100\": -588.2871,\n            \"E_slab_111_dc\": -585.1304,\n            \"E_slab_111_no_dc\": -584.2304,\n        },\n        {\n            \"N_100\": 8, \"N_111\": 8,\n            \"E_slab_100\": -1573.6671,\n            \"E_slab_111_dc\": -1570.6104,\n            \"E_slab_111_no_dc\": -1568.2104,\n        },\n    ]\n\n    def calculate_gamma(E_slab, N, E_bulk, A):\n        \"\"\"\n        Calculates the per-surface energy in J/m^2.\n\n        Args:\n            E_slab (float): Total energy of the slab in eV.\n            N (int): Number of bulk formula units in the slab.\n            E_bulk (float): Energy per bulk formula unit in eV.\n            A (float): Lateral area of the slab in Å^2.\n\n        Returns:\n            float: Surface energy in J/m^2.\n        \"\"\"\n        excess_energy_ev = E_slab - N * E_bulk\n        gamma = (excess_energy_ev / (2 * A)) * CONVERSION_FACTOR\n        return gamma\n\n    results = []\n    for case in test_cases:\n        # Calculate gamma for the (100) surface\n        gamma_100 = calculate_gamma(\n            case[\"E_slab_100\"], case[\"N_100\"], E_BULK, A_100\n        )\n\n        # Calculate gamma for the (111) surface with dipole correction\n        gamma_111_dc = calculate_gamma(\n            case[\"E_slab_111_dc\"], case[\"N_111\"], E_BULK, A_111\n        )\n\n        # Calculate gamma for the (111) surface without dipole correction\n        gamma_111_no_dc = calculate_gamma(\n            case[\"E_slab_111_no_dc\"], case[\"N_111\"], E_BULK, A_111\n        )\n        \n        # Calculate the required differences\n        delta_gamma_dc = gamma_111_dc - gamma_100\n        delta_gamma_no_dc = gamma_111_no_dc - gamma_100\n        \n        results.append([delta_gamma_dc, delta_gamma_no_dc])\n\n    # Format the final output string exactly as required\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}