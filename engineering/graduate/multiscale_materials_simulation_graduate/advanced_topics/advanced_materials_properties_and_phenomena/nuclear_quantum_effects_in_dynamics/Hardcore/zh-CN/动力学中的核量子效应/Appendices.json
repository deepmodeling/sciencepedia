{
    "hands_on_practices": [
        {
            "introduction": "一维量子谐振子是检验量子统计力学方法的基石。本练习提供了一个亲身实践的机会，让您从第一性原理出发实现路径积分分子动力学（PIMD）方法，并定量地评估其准确性。通过将关键可观测量（如能量和位置方差）的PIMD估计值与精确解析解进行比较，您将对收敛性与珠子数量（$P$）及温度的关系获得至关重要的直觉，这是该领域任何计算研究人员的基本技能 。",
            "id": "3893591",
            "problem": "考虑一个质量为 $m$、角频率为 $\\omega$ 的一维量子谐振子，处于反温度为 $\\beta$ 的正则系综中。该谐振子是化学吸附物种中振动模式的标准替代模型，而核量子效应在计算催化中对于准确预测自由能至关重要。设约化普朗克常数为 $\\hbar$，玻尔兹曼常数为 $k_{\\mathrm{B}}$。在本问题中，通过设置 $k_{\\mathrm{B}} = 1$ 和 $\\hbar = 1$ 将所有物理量无量纲化，因此 $\\beta$、能量和频率都是无量纲的。你的任务是：\n\n1. 从一维谐振子的能谱和正则配分函数的定义出发，推导出精确的量子力学配分函数 $Z_{\\mathrm{exact}}(\\beta,\\omega)$，并以闭合形式表示精确的内能 $E_{\\mathrm{exact}}(\\beta,\\omega)$ 和精确的位置方差 $\\langle x^2 \\rangle_{\\mathrm{exact}}(\\beta,m,\\omega)$。\n\n2. 使用具有 $P$ 个 Trotter 切片（珠子）的路径积分表示，构建配分函数的离散化环状聚合物表示。通过对循环珠子-弹簧耦合进行简正模对角化，证明配分函数的 $P$-珠子近似 $Z_P(\\beta,\\omega)$ 可以写成环状聚合物简正模的乘积，其本征值为\n$$\n\\lambda_k = \\omega^2 + 4 \\omega_P^2 \\sin^2\\left(\\frac{\\pi k}{P}\\right), \\quad \\text{for } k = 0,1,\\dots,P-1,\n$$\n其中 $\\omega_P = \\frac{P}{\\beta}$，并且\n$$\n\\ln Z_P(\\beta,\\omega) = \\sum_{k=0}^{P-1} \\left[ \\ln \\omega_P - \\frac{1}{2}\\ln\\left(\\omega^2 + 4 \\omega_P^2 \\sin^2\\left(\\frac{\\pi k}{P}\\right)\\right) \\right],\n$$\n因此 $Z_P(\\beta,\\omega) = \\exp\\left(\\ln Z_P(\\beta,\\omega)\\right)$。此外，推导路径积分估计的位置方差的闭合形式表达式，\n$$\n\\langle x^2 \\rangle_P(\\beta,m,\\omega) = \\frac{1}{\\beta m} \\sum_{k=0}^{P-1} \\frac{1}{\\lambda_k}.\n$$\n\n3. 将 $P$-珠子路径积分近似的热力学能量估计量定义为\n$$\nE_P(\\beta,\\omega) = -\\frac{\\partial}{\\partial \\beta}\\ln Z_P(\\beta,\\omega),\n$$\n并使用关于 $\\beta$ 的中心有限差分格式对其进行数值计算，该格式应是稳定的且与上述 $\\ln Z_P(\\beta,\\omega)$ 的离散表达式一致。\n\n你的程序必须实现上述公式，并对提供的每个测试用例评估以下量：\n- 精确配分函数 $Z_{\\mathrm{exact}}(\\beta,\\omega)$，\n- $P$-珠子近似 $Z_P(\\beta,\\omega)$，\n- 精确内能 $E_{\\mathrm{exact}}(\\beta,\\omega)$，\n- $P$-珠子热力学能量估计量 $E_P(\\beta,\\omega)$，\n- 精确位置方差 $\\langle x^2 \\rangle_{\\mathrm{exact}}(\\beta,m,\\omega)$，\n- $P$-珠子位置方差 $\\langle x^2 \\rangle_P(\\beta,m,\\omega)$。\n\n基于这些量，计算每个可观测量的绝对相对误差：\n$$\n\\varepsilon_Z = \\frac{\\left|Z_P - Z_{\\mathrm{exact}}\\right|}{\\left|Z_{\\mathrm{exact}}\\right|}, \\quad\n\\varepsilon_E = \\frac{\\left|E_P - E_{\\mathrm{exact}}\\right|}{\\left|E_{\\mathrm{exact}}\\right|}, \\quad\n\\varepsilon_{x^2} = \\frac{\\left|\\langle x^2 \\rangle_P - \\langle x^2 \\rangle_{\\mathrm{exact}}\\right|}{\\left|\\langle x^2 \\rangle_{\\mathrm{exact}}\\right|}.\n$$\n\n测试套件：\n使用以下参数集 $(m,\\omega,\\beta,P)$：\n- 案例1（高温，经典极限基线）：$(1.0, 1.0, 0.1, 1)$，\n- 案例2（低温，单珠子）：$(1.0, 1.0, 5.0, 1)$，\n- 案例3（低温，中等数量珠子）：$(1.0, 1.0, 5.0, 8)$，\n- 案例4（低温，多珠子）：$(1.0, 1.0, 5.0, 64)$，\n- 案例5（低温下极低频率，多珠子）：$(1.0, 0.2, 20.0, 128)$。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按每个案例的以下顺序排列结果：\n案例1的 $\\left[\\varepsilon_Z,\\varepsilon_E,\\varepsilon_{x^2}\\right]$，然后是案例2，以此类推，连接成一个单一的扁平列表。例如，输出应如下所示：\n$[\\text{case1\\_}\\varepsilon_Z,\\text{case1\\_}\\varepsilon_E,\\text{case1\\_}\\varepsilon_{x^2},\\text{case2\\_}\\varepsilon_Z,\\dots]$。\n在这个无量纲化的设定中，所有值都是无量纲的。",
            "solution": "该问题要求对一维谐振子的精确量子力学性质及其路径积分近似进行推导和数值比较。该问题在科学上是合理的、提法恰当的，并且所有提供的公式都是量子统计力学中的标准结果。我们将首先推导精确和近似可观测量的解析表达式，然后实现这些公式来计算指定测试用例的误差。我们在一个无量纲化的系统中进行操作，其中约化普朗克常数 $\\hbar = 1$，玻尔兹曼常数 $k_{\\mathrm{B}} = 1$。\n\n### 1. 精确的量子力学解\n\n一维量子谐振子的哈密顿量为 $\\hat{H} = \\frac{\\hat{p}^2}{2m} + \\frac{1}{2}m\\omega^2\\hat{x}^2$。其能量本征值由以下离散谱给出：\n$$\nE_n = \\hbar \\omega \\left(n + \\frac{1}{2}\\right) = \\omega \\left(n + \\frac{1}{2}\\right), \\quad \\text{for } n = 0, 1, 2, \\dots\n$$\n因为我们已设定 $\\hbar = 1$。\n\n正则配分函数 $Z_{\\mathrm{exact}}$ 定义为对所有量子态的玻尔兹曼因子求和：\n$$\nZ_{\\mathrm{exact}}(\\beta, \\omega) = \\sum_{n=0}^{\\infty} e^{-\\beta E_n} = \\sum_{n=0}^{\\infty} e^{-\\beta \\omega (n + 1/2)} = e^{-\\beta\\omega/2} \\sum_{n=0}^{\\infty} \\left(e^{-\\beta\\omega}\\right)^n\n$$\n该求和是一个首项为 $a=1$、公比为 $r = e^{-\\beta\\omega}$ 的几何级数。由于 $\\beta > 0$ 和 $\\omega > 0$，我们有 $0  r  1$，级数收敛于 $\\frac{1}{1-r}$。\n$$\nZ_{\\mathrm{exact}}(\\beta, \\omega) = e^{-\\beta\\omega/2} \\frac{1}{1 - e^{-\\beta\\omega}} = \\frac{1}{e^{\\beta\\omega/2} - e^{-\\beta\\omega/2}} = \\frac{1}{2\\sinh\\left(\\frac{\\beta\\omega}{2}\\right)}\n$$\n\n精确内能 $E_{\\mathrm{exact}}$ 通过热力学关系 $E = -\\frac{\\partial \\ln Z}{\\partial \\beta}$ 从配分函数获得：\n$$\nE_{\\mathrm{exact}}(\\beta, \\omega) = -\\frac{\\partial}{\\partial \\beta} \\ln\\left[ \\frac{1}{2\\sinh\\left(\\frac{\\beta\\omega}{2}\\right)} \\right] = \\frac{\\partial}{\\partial \\beta} \\ln\\left[ \\sinh\\left(\\frac{\\beta\\omega}{2}\\right) \\right]\n$$\n使用链式法则，我们得到：\n$$\nE_{\\mathrm{exact}}(\\beta, \\omega) = \\frac{1}{\\sinh\\left(\\frac{\\beta\\omega}{2}\\right)} \\cdot \\cosh\\left(\\frac{\\beta\\omega}{2}\\right) \\cdot \\frac{\\omega}{2} = \\frac{\\omega}{2} \\coth\\left(\\frac{\\beta\\omega}{2}\\right)\n$$\n这个表达式在低温极限（$\\beta \\to \\infty$）下正确地反映了零点能 $\\frac{\\omega}{2}$，并在高温极限（$\\beta \\to 0$）下正确地反映了经典能量均分结果 $1/\\beta$。\n\n精确位置方差 $\\langle x^2 \\rangle_{\\mathrm{exact}}$ 可以使用谐振子的维里定理求得，该定理指出平均动能等于平均势能，即 $\\langle T \\rangle = \\langle V \\rangle$。总能量为 $E = \\langle T \\rangle + \\langle V \\rangle = 2\\langle V \\rangle$。\n势能为 $V(x) = \\frac{1}{2}m\\omega^2x^2$，因此其期望值为 $\\langle V \\rangle = \\frac{1}{2}m\\omega^2\\langle x^2 \\rangle$。\n因此， $E_{\\mathrm{exact}} = 2 \\left( \\frac{1}{2}m\\omega^2 \\langle x^2 \\rangle_{\\mathrm{exact}} \\right) = m\\omega^2 \\langle x^2 \\rangle_{\\mathrm{exact}}$。\n重新整理得到位置方差：\n$$\n\\langle x^2 \\rangle_{\\mathrm{exact}}(\\beta, m, \\omega) = \\frac{E_{\\mathrm{exact}}}{m\\omega^2} = \\frac{1}{m\\omega^2} \\frac{\\omega}{2} \\coth\\left(\\frac{\\beta\\omega}{2}\\right) = \\frac{1}{2m\\omega} \\coth\\left(\\frac{\\beta\\omega}{2}\\right)\n$$\n\n### 2. 路径积分近似\n\n路径积分形式主义将单个量子粒子映射到一个由 $P$ 个珠子组成的经典环状聚合物上。这个经典类比的配分函数在 $P \\to \\infty$ 的极限下变得精确。对于有限的 $P$，它是一个近似。环状聚合物的势能为：\n$$\nU_P(\\{x_i\\}) = \\sum_{i=1}^{P} \\left[ \\frac{1}{2} m \\omega_P^2 (x_i - x_{i-1})^2 + \\frac{1}{P} V(x_i) \\right]\n$$\n其中 $x_0 \\equiv x_P$，$\\omega_P = \\frac{P}{\\beta}$，对于谐振子，$V(x_i) = \\frac{1}{2}m\\omega^2 x_i^2$。该势能是关于珠子位置 $\\{x_i\\}$ 的二次型，可以通过离散傅里叶变换（简正模变换）进行对角化。这将 $P$ 个耦合珠子的系统转换为 $P$ 个独立的谐振简正模。配分函数 $Z_P$ 随后可以计算为这些模式的配分函数的乘积。这些模式的有效频率平方是问题中给出的本征值 $\\lambda_k$：\n$$\n\\lambda_k = \\omega^2 + 4 \\omega_P^2 \\sin^2\\left(\\frac{\\pi k}{P}\\right), \\quad \\text{for } k = 0,1,\\dots,P-1\n$$\n得到的配分函数为 $Z_P = \\prod_{k=0}^{P-1} \\frac{\\omega_P}{ \\sqrt{\\lambda_k}}$。取对数可得到问题陈述中提供的表达式：\n$$\n\\ln Z_P(\\beta,\\omega) = \\ln \\left( \\prod_{k=0}^{P-1} \\frac{\\omega_P}{\\sqrt{\\lambda_k}} \\right) = \\sum_{k=0}^{P-1} \\left[ \\ln \\omega_P - \\frac{1}{2}\\ln\\left(\\lambda_k\\right) \\right]\n$$\n\n为了推导位置方差的路径积分估计量，我们使用一个类似 Hellmann-Feynman 定理的方法。位置方差的估计量定义为对所有珠子的平均，$\\langle \\hat{x}^2 \\rangle_P$，其中 $\\hat{x}^2 = \\frac{1}{P}\\sum_{i=1}^P x_i^2$。我们可以将其与配分函数对势能中某个参数的导数联系起来。\n让我们对 $\\ln Z_P$ 关于参数 $\\omega^2$ 求导。根据路径积分配分函数的定义 $Z_P \\propto \\int \\exp(-\\beta U_P) d\\{x_i\\}$，我们有：\n$$\n\\frac{\\partial \\ln Z_P}{\\partial (\\omega^2)} = \\left\\langle -\\frac{\\partial (\\beta U_P)}{\\partial (\\omega^2)} \\right\\rangle = \\left\\langle -\\beta \\sum_{i=1}^P \\frac{1}{P} \\frac{\\partial V(x_i)}{\\partial (\\omega^2)} \\right\\rangle = \\left\\langle -\\frac{\\beta}{P} \\sum_{i=1}^P \\frac{1}{2} m x_i^2 \\right\\rangle = -\\frac{\\beta m}{2} \\left\\langle \\frac{1}{P} \\sum_{i=1}^P x_i^2 \\right\\rangle = -\\frac{\\beta m}{2} \\langle \\hat{x}^2 \\rangle_P\n$$\n现在，我们对给定的 $\\ln Z_P$ 解析表达式求导：\n$$\n\\frac{\\partial \\ln Z_P}{\\partial (\\omega^2)} = \\frac{\\partial}{\\partial (\\omega^2)} \\sum_{k=0}^{P-1} \\left[ \\ln \\omega_P - \\frac{1}{2}\\ln\\left(\\omega^2 + 4 \\omega_P^2 \\sin^2\\left(\\frac{\\pi k}{P}\\right)\\right) \\right] = -\\frac{1}{2} \\sum_{k=0}^{P-1} \\frac{1}{\\lambda_k}\n$$\n令两个导数表达式相等，得到：\n$$\n-\\frac{\\beta m}{2} \\langle \\hat{x}^2 \\rangle_P = -\\frac{1}{2} \\sum_{k=0}^{P-1} \\frac{1}{\\lambda_k}\n$$\n求解 $\\langle \\hat{x}^2 \\rangle_P$（我们将其记为 $\\langle x^2 \\rangle_P$），即可得到所需的公式：\n$$\n\\langle x^2 \\rangle_P(\\beta,m,\\omega) = \\frac{1}{\\beta m} \\sum_{k=0}^{P-1} \\frac{1}{\\lambda_k}\n$$\n\n### 3. 数值实现\n\n热力学能量估计量 $E_P$ 定义为 $E_P = -\\frac{\\partial}{\\partial \\beta}\\ln Z_P$。这个导数使用一个带有小步长 $\\delta\\beta$ 的二阶中心有限差分格式进行数值计算：\n$$\nE_P(\\beta, \\omega) \\approx -\\frac{\\ln Z_P(\\beta+\\delta\\beta, \\omega) - \\ln Z_P(\\beta-\\delta\\beta, \\omega)}{2\\delta\\beta}\n$$\n为了保证稳定性和准确性，采用一个小的相对步长，例如 $\\delta\\beta = 10^{-6}\\beta$。\n\n路径积分近似与精确量子力学结果之间的相对误差按指定方式计算：\n$$\n\\varepsilon_Z = \\frac{\\left|Z_P - Z_{\\mathrm{exact}}\\right|}{\\left|Z_{\\mathrm{exact}}\\right|}, \\quad\n\\varepsilon_E = \\frac{\\left|E_P - E_{\\mathrm{exact}}\\right|}{\\left|E_{\\mathrm{exact}}\\right|}, \\quad\n\\varepsilon_{x^2} = \\frac{\\left|\\langle x^2 \\rangle_P - \\langle x^2 \\rangle_{\\mathrm{exact}}\\right|}{\\left|\\langle x^2 \\rangle_{\\mathrm{exact}}\\right|}\n$$\n程序将实现这些公式，以评估每个测试用例的量，并报告产生的相对误差。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the exact and path-integral observables for a quantum harmonic\n    oscillator and computes the relative errors for a suite of test cases.\n    \"\"\"\n    \n    # Test cases: (m, omega, beta, P)\n    test_cases = [\n        (1.0, 1.0, 0.1, 1),\n        (1.0, 1.0, 5.0, 1),\n        (1.0, 1.0, 5.0, 8),\n        (1.0, 1.0, 5.0, 64),\n        (1.0, 0.2, 20.0, 128),\n    ]\n\n    # Helper function for coth(x), numerically stable for large |x|.\n    def coth(x):\n        return 1.0 / np.tanh(x)\n\n    # --- 1. Exact Quantum Mechanical Formulas ---\n\n    def z_exact(beta, omega):\n        arg = beta * omega / 2.0\n        # For large arguments, sinh(arg) can overflow.\n        # Z_exact = exp(-arg) / (1 - exp(-2*arg))\n        if arg  700: # np.exp(709) is near float limit\n            return np.exp(-arg)\n        return 1.0 / (2.0 * np.sinh(arg))\n\n    def e_exact(beta, omega):\n        arg = beta * omega / 2.0\n        return (omega / 2.0) * coth(arg)\n    \n    def x2_exact(beta, m, omega):\n        arg = beta * omega / 2.0\n        return (1.0 / (2.0 * m * omega)) * coth(arg)\n\n    # --- 2. Path-Integral Approximation Formulas ---\n\n    def get_lambda_k(omega, omega_p, P):\n        \"\"\"Calculates the ring-polymer normal mode eigenvalues.\"\"\"\n        k = np.arange(P)\n        sin_term = np.sin(np.pi * k / P)\n        return omega**2 + 4.0 * omega_p**2 * sin_term**2\n\n    def ln_z_p(beta, omega, P):\n        \"\"\"Calculates the logarithm of the P-bead partition function.\"\"\"\n        if P == 0: return -np.inf # Should not happen with problem constraints\n        omega_p = P / beta\n        lambda_k = get_lambda_k(omega, omega_p, P)\n        \n        # Avoid log(0) if omega is 0 and k is 0.\n        # Problem constraints ensure omega  0.\n        log_lambda_k = np.log(lambda_k)\n        \n        return np.sum(np.log(omega_p) - 0.5 * log_lambda_k)\n\n    def z_p(beta, omega, P):\n        return np.exp(ln_z_p(beta, omega, P))\n\n    def e_p(beta, omega, P):\n        \"\"\"Calculates the thermodynamic energy estimator via finite difference.\"\"\"\n        # Use a small relative step for the finite difference derivative\n        delta_beta = beta * 1e-6\n        if delta_beta == 0: delta_beta = 1e-9 # Avoid zero step if beta=0\n\n        beta_plus = beta + delta_beta\n        beta_minus = beta - delta_beta\n        \n        ln_z_plus = ln_z_p(beta_plus, omega, P)\n        ln_z_minus = ln_z_p(beta_minus, omega, P)\n        \n        return -(ln_z_plus - ln_z_minus) / (2.0 * delta_beta)\n\n    def x2_p(beta, m, omega, P):\n        \"\"\"Calculates the position variance estimator.\"\"\"\n        if P == 0: return np.inf\n        omega_p = P / beta\n        lambda_k = get_lambda_k(omega, omega_p, P)\n        \n        # The sum of 1/lambda_k. Since omega  0, lambda_k  0.\n        sum_inv_lambda = np.sum(1.0 / lambda_k)\n        \n        return (1.0 / (beta * m)) * sum_inv_lambda\n    \n    results = []\n    \n    for case in test_cases:\n        m, omega, beta, P = case\n        \n        # Calculate exact values\n        val_z_exact = z_exact(beta, omega)\n        val_e_exact = e_exact(beta, omega)\n        val_x2_exact = x2_exact(beta, m, omega)\n        \n        # Calculate P-bead approximate values\n        val_z_p = z_p(beta, omega, P)\n        val_e_p = e_p(beta, omega, P)\n        val_x2_p = x2_p(beta, m, omega, P)\n        \n        # Calculate relative errors\n        err_z = np.abs(val_z_p - val_z_exact) / np.abs(val_z_exact)\n        err_e = np.abs(val_e_p - val_e_exact) / np.abs(val_e_exact)\n        err_x2 = np.abs(val_x2_p - val_x2_exact) / np.abs(val_x2_exact)\n        \n        results.extend([err_z, err_e, err_x2])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "尽管路径积分模拟通常提供对量子力学的一种近似，只有在珠子数量趋于无穷时才变得精确，但在某些特殊情况下，即使珠子数量有限，也能达到精确。这个理论练习深入探讨了谐振子的这样一种情景，利用了其底层代数结构的特性。通过解决这个问题，您将揭示经典环状聚合物模型在何种条件下能够完美再现量子期望值，从而加深您对PIMD形式体系数学基础的理解 。",
            "id": "3827764",
            "problem": "考虑一个一维量子谐振子，其哈密顿量为 $H = \\frac{p^{2}}{2 m} + \\frac{1}{2} m \\omega^{2} x^{2}$，质量为 $m$，角频率为 $\\omega$，逆温度为 $\\beta$。在具有 $P$ 个珠子的路径积分分子动力学 (PIMD) 表示中，正则量子热期望值是从一个经典环状聚合物系综中采样的，该系综的有效势由量子玻尔兹曼算符 $\\exp(-\\beta H)$ 的高阶分解构建。使用对于二次哈密顿量精确的四阶算符分解（例如 Takahashi–Imada (TI) 和 Suzuki–Chin 方案），从配分函数和路径积分映射的基本定义出发，并：\n\n- 推导振子珠子平均的均方根位移 $\\langle x^{2} \\rangle$ 和动能 $\\langle K \\rangle$ 的解析有限-$P$ PIMD 表达式。\n- 利用二次算符的对易子结构，论证为何对于任意 $P$，四阶分解对谐振子是精确的，并因此解释为何 PIMD 有限-$P$ 表达式与精确的量子结果一致。\n- 将最终答案表示为 $m$、$\\omega$、$\\beta$ 和 $\\hbar$ 的闭式解析函数。\n\n你的最终答案必须是两个闭式表达式，以 LaTeX 单行矩阵的形式排列，分别代表 $\\langle x^{2} \\rangle$ 和 $\\langle K \\rangle$。不需要进行数值计算。",
            "solution": "该问题要求使用路径积分分子动力学 (PIMD) 框架，推导一维量子谐振子的珠子平均均方根位移 $\\langle x^{2} \\rangle$ 和动能 $\\langle K \\rangle$。问题指定使用一种对二次哈密顿量精确的四阶算符分解。问题的核心在于理解这种精确性的含义。\n\n首先，我们来讨论关于玻尔兹曼算符 $\\exp(-\\beta H)$ 的某些四阶分解对谐振子是精确的这一论断。哈密顿量由 $H = T + V$ 给出，其中动能算符为 $T = \\frac{p^2}{2m}$，势能算符为 $V = \\frac{1}{2}m\\omega^2 x^2$。算符 $T$ 和 $V$ 分别是正则变量 $p$ 和 $x$ 的二次型。基本对易关系为 $[x, p] = i\\hbar$。\n\n让我们研究由 $T$ 和 $V$ 生成的算符代数。第一个对易子是：\n$$ [T, V] = \\left[\\frac{p^2}{2m}, \\frac{1}{2}m\\omega^2 x^2\\right] = \\frac{\\omega^2}{4}[p^2, x^2] = \\frac{\\omega^2}{4}\\left(p[p, x^2] + [p, x^2]p\\right) $$\n使用 $[p, f(x)] = -i\\hbar \\frac{df}{dx}$，我们得到 $[p, x^2] = -2i\\hbar x$。\n$$ [T, V] = \\frac{\\omega^2}{4}\\left(p(-2i\\hbar x) + (-2i\\hbar x)p\\right) = -i\\hbar\\frac{\\omega^2}{2}(px+xp) $$\n这个新算符同样是正则变量的二次型。如果我们计算更深层的嵌套对易子，例如 $[T, [T, V]]$ 和 $[V, [T, V]]$，我们会发现它们分别与 $T$ 和 $V$ 成正比。例如：\n$$ [T, [T, V]] = \\left[\\frac{p^2}{2m}, -i\\hbar\\frac{\\omega^2}{2}(px+xp)\\right] \\propto [p^2, px+xp] \\propto p^2 \\propto T $$\n$$ [V, [T, V]] = \\left[\\frac{1}{2}m\\omega^2 x^2, -i\\hbar\\frac{\\omega^2}{2}(px+xp)\\right] \\propto [x^2, px+xp] \\propto x^2 \\propto V $$\n这表明算符 $\\{T, V, [T,V]\\}$ 构成一个封闭的李代数。具体来说，二次算符集合 $\\{p^2, x^2, xp+px\\}$ 构成了 $sp(2, \\mathbb{R})$ 李代数的一个基。\n\nBaker-Campbell-Hausdorff (BCH) 公式允许将非对易算符的指数乘积表示为单个指数。对于属于有限维李代数的算符，BCH 级数会终止。这里就是这种情况。传播子的高阶对称分解，例如 Takahashi–Imada 或 Suzuki–Chin 方案，将 $\\exp(-\\tau(T+V))$ 近似为更简单指数的乘积，例如 $ \\prod_i \\exp(-c_i \\tau V) \\exp(-d_i \\tau T) $。由于谐振子代数的 BCH 级数终止，可以选择系数 $\\{c_i, d_i\\}$ 使得该乘积精确地等于 $\\exp(-\\tau(T+V))$。问题指出使用了这样一种精确分解。\n\nPIMD 方法源于量子配分函数 $Z_Q = \\text{Tr}[\\exp(-\\beta H)]$ 的路径积分表述。该算符被分解为 $P$ 个相同的短时传播子：$Z_Q = \\text{Tr}[(\\exp(-\\tau H))^P]$，其中 $\\tau = \\beta/P$。PIMD 的核心在于用一个分解形式来近似 $\\exp(-\\tau H)$。然而，由于所采用的分解对谐振子是精确的，PIMD 传播子不是一个近似，而是一个精确的表示：\n$$ \\exp(-\\tau H)_{\\text{PIMD factorized}} = \\exp(-\\tau H)_{\\text{exact}} $$\n因此，基于此分解构建的经典环状聚合物系统的配分函数 $Z_P$，对于任何珠子数 $P \\ge 1$ 都精确等于量子配分函数 $Z_Q$。\n$$ Z_P = Z_Q $$\n这个等式意味着，在这个特定的 PIMD 框架内计算的任何热期望值，都将与精确的量子力学热期望值相同。因此，所求的“有限-$P$ PIMD 表达式”就是精确的、与 $P$ 无关的量子结果。问题因此简化为计算精确的量子期望值 $\\langle x^2 \\rangle_Q$ 和 $\\langle K \\rangle_Q$。\n\n为此，我们首先计算一维谐振子的精确量子配分函数。能量本征值为 $E_n = \\hbar\\omega(n + 1/2)$，对于 $n=0, 1, 2, \\ldots$。\n$$ Z_Q = \\sum_{n=0}^{\\infty} \\exp(-\\beta E_n) = \\sum_{n=0}^{\\infty} \\exp\\left(-\\beta\\hbar\\omega\\left(n+\\frac{1}{2}\\right)\\right) $$\n$$ Z_Q = \\exp\\left(-\\frac{\\beta\\hbar\\omega}{2}\\right) \\sum_{n=0}^{\\infty} \\left(\\exp(-\\beta\\hbar\\omega)\\right)^n $$\n这是一个收敛的几何级数：\n$$ Z_Q = \\frac{\\exp(-\\beta\\hbar\\omega/2)}{1 - \\exp(-\\beta\\hbar\\omega)} = \\frac{1}{\\exp(\\beta\\hbar\\omega/2) - \\exp(-\\beta\\hbar\\omega/2)} = \\frac{1}{2\\sinh(\\beta\\hbar\\omega/2)} $$\n平均总能量 $\\langle H \\rangle$ 通过以下方式求得：\n$$ \\langle H \\rangle = -\\frac{1}{Z_Q}\\frac{\\partial Z_Q}{\\partial \\beta} = -\\frac{\\partial (\\ln Z_Q)}{\\partial \\beta} = -\\frac{\\partial}{\\partial \\beta} \\left( -\\ln\\left[2\\sinh\\left(\\frac{\\beta\\hbar\\omega}{2}\\right)\\right] \\right) $$\n$$ \\langle H \\rangle = \\frac{1}{\\sinh(\\beta\\hbar\\omega/2)} \\cdot \\cosh\\left(\\frac{\\beta\\hbar\\omega}{2}\\right) \\cdot \\frac{\\hbar\\omega}{2} = \\frac{\\hbar\\omega}{2} \\coth\\left(\\frac{\\beta\\hbar\\omega}{2}\\right) $$\n对于谐振子，量子维里定理指出，动能的热平均值等于势能的热平均值：$\\langle K \\rangle = \\langle V \\rangle$。\n由于 $\\langle H \\rangle = \\langle K \\rangle + \\langle V \\rangle$，因此有 $\\langle K \\rangle = \\langle V \\rangle = \\frac{1}{2}\\langle H \\rangle$。\n\n由此，我们可以求出动能期望值：\n$$ \\langle K \\rangle = \\frac{1}{2}\\langle H \\rangle = \\frac{\\hbar\\omega}{4} \\coth\\left(\\frac{\\beta\\hbar\\omega}{2}\\right) $$\n从势能期望值，我们求出均方位移：\n$$ \\langle V \\rangle = \\left\\langle \\frac{1}{2}m\\omega^2 x^2 \\right\\rangle = \\frac{1}{2}m\\omega^2 \\langle x^2 \\rangle $$\n将其设为等于 $\\frac{1}{2}\\langle H \\rangle$：\n$$ \\frac{1}{2}m\\omega^2 \\langle x^2 \\rangle = \\frac{\\hbar\\omega}{4} \\coth\\left(\\frac{\\beta\\hbar\\omega}{2}\\right) $$\n$$ \\langle x^2 \\rangle = \\frac{\\hbar\\omega}{2m\\omega^2} \\coth\\left(\\frac{\\beta\\hbar\\omega}{2}\\right) = \\frac{\\hbar}{2m\\omega} \\coth\\left(\\frac{\\beta\\hbar\\omega}{2}\\right) $$\n$\\langle x^2 \\rangle$ 和 $\\langle K \\rangle$ 的这些表达式是精确的量子力学结果。如上所述，由于使用了精确的分解方案，它们也是对于任意有限珠子数 $P$ 的 PIMD 估计量的解析表达式。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{\\hbar}{2m\\omega} \\coth\\left(\\frac{\\beta\\hbar\\omega}{2}\\right)  \\frac{\\hbar\\omega}{4} \\coth\\left(\\frac{\\beta\\hbar\\omega}{2}\\right) \\end{pmatrix} } $$"
        },
        {
            "introduction": "从理论走向实践，高效的PIMD模拟需要克服数值计算上的挑战，特别是源于环状聚合物高频内部模式所带来的刚性问题。本练习探讨了两种用于处理此问题的强大技术：正交模（normal-mode）和分级（staging）坐标变换。通过分析它们各自在数值积分和恒温控制方面的优势，您将培养出为模拟复杂量子系统选择和实现高效算法所需的批判性判断力 。",
            "id": "3893529",
            "problem": "在低温下，金属表面上的催化氢转移需要包含核量子效应来捕捉隧穿效应和零点能。路径积分分子动力学 (PIMD) 将一个量子化的原子核表示为一个由 $P$ 个珠子组成的经典环状聚合物，这些珠子由谐振弹簧连接，在逆温度 $\\beta$ 下对量子玻尔兹曼分布进行采样。对于一个笛卡尔自由度，环状聚合物的哈密顿量为\n$$\nH_P = \\sum_{j=1}^{P} \\left[ \\frac{p_j^2}{2 m} + V(q_j) \\right] + \\sum_{j=1}^{P} \\frac{1}{2} m \\omega_P^2 \\left( q_j - q_{j+1} \\right)^2,\n$$\n其中满足周期性边界条件，m为质量，$q_j$为位置，$p_j$为动量，$V(q)$为势能，弹簧频率为$\\omega_P = \\frac{P}{\\beta \\hbar}$，$\\hbar$是约化普朗克常数。环状聚合物的高频内禀模式会使积分变得刚性，并使温控变得非平凡。两种常用的坐标变换是简正模坐标（对角化谐振耦合的正交模式）和分阶坐标（一种减少珠子间关联的下三角分层变换），它们在动力学和温控过程中揭示和控制内禀模式谱的方式上有所不同。\n\n从上述哈密顿量出发，考虑这些变换如何影响与环状聚合物内禀模式相关的频率，以及温控（例如，朗之万或广义朗之万方程）和质量预处理以稳定数值积分的实际选择。关于在路径积分分子动力学（PIMD）中，分阶坐标相对于简正模坐标在温控和积分稳定性方面的优势，包括每种方法如何处理高频内禀模式，下列哪些陈述是正确的？\n\nA. 简正模坐标将谐振珠子-弹簧耦合对角化为具有明确定义的内禀模式频率谱的独立振子，从而可以进行模式特定的温控（例如，为每个模式定制摩擦并弱耦合质心），以强力阻尼高频内禀模式，提高积分稳定性，同时避免共振赝象。\n\nB. 分阶坐标通过将所有内禀模式的频率都变为零来消除高频内禀模式，因此在实践中对这些模式进行温控是不必要的。\n\nC. 在自由粒子极限下，分阶坐标为内禀位移产生独立的高斯变量，减少了珠子间的统计关联；对于相互作用的系统，它们相对于珠子坐标仍然能降低刚性，但不能完全对角化频谱，因此温控仍然是必要的，并且不如使用简正模那样具有针对性。\n\nD. 在简正模坐标中，质心模式在所有环状聚合物模式中频率最高，因此必须进行强力温控以维持数值稳定性；对质心的弱温控会导致能量漂移。\n\nE. 对于低温下的轻原子，增加 $P$ 会提高最大内禀模式频率，使积分更加刚性；简正模坐标有助于进行依赖于模式的质量预处理，以展平有效频率谱并允许更大的时间步长，这是其相对于单独使用珠子或分阶坐标的一个实际优势。",
            "solution": "用户提供了一个关于在路径积分分子动力学（PIMD）模拟中应用不同坐标变换——特别是简正模坐标和分阶坐标——的问题陈述。我的任务是首先验证该问题陈述，然后提供一个详细的解决方案来评估给定的选项。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n- **背景**：低温下金属表面的催化氢转移。\n- **方法**：路径积分分子动力学 (PIMD)。\n- **物理模型**：一个量子化的原子核被表示为由 $P$ 个珠子组成的经典环状聚合物。这些珠子由谐振弹簧连接，在逆温度 $\\beta$ 下对量子玻尔兹曼分布进行采样。\n- **哈密顿量**：对于一个笛卡尔自由度，环状聚合物的哈密顿量为\n$$\nH_P = \\sum_{j=1}^{P} \\left[ \\frac{p_j^2}{2 m} + V(q_j) \\right] + \\sum_{j=1}^{P} \\frac{1}{2} m \\omega_P^2 \\left( q_j - q_{j+1} \\right)^2\n$$\n- **定义**：\n    - $P$：珠子数量。\n    - $m$：原子核质量。\n    - $q_j, p_j$：第 $j$ 个珠子的位置和动量。\n    - $V(q)$：外势。\n    - $\\beta$：逆温度, $\\beta = 1/(k_B T)$。\n    - $\\hbar$：约化普朗克常数。\n    - $\\omega_P$：弹簧频率, $\\omega_P = \\frac{P}{\\beta \\hbar}$。\n    - **边界条件**：周期性，$j=P$ 时 $q_{j+1} = q_1$。\n- **挑战**：环状聚合物的高频内禀模式导致积分刚性和复杂的温控问题。\n- **技术**：\n    - **简正模坐标**：对角化谐振耦合的正交模式。\n    - **分阶坐标**：一种减少关联的下三角分层变换。\n- **问题**：识别关于分阶坐标与简正模坐标在温控和积分稳定性方面的优势的正确陈述。\n\n**步骤 2：使用提取的已知条件进行验证**\n将根据既定标准对问题陈述进行验证。\n\n- **科学依据**：该问题牢固地植根于统计力学和计算化学的原理。PIMD 形式体系，包括环状聚合物哈密顿量和弹簧频率 $\\omega_P$ 的定义，是该领域用于研究核量子效应的标准而准确的表示方法。所描述的挑战（刚性、温控）和提到的坐标变换（简正模、分阶坐标）是高级 PIMD 算法开发的核心主题。该描述在事实上和科学上都是合理的。\n- **良定性**：该问题要求对两种明确定义的坐标系的性质和实际优势进行定性比较。其结构旨在测试对 PIMD 算法的概念性理解。可以从已建立的 PIMD 理论中推导出一个确定且有意义的答案。\n- **客观性**：问题以精确的技术语言陈述。没有主观或含糊的术语。对坐标变换的描述是标准定义。\n\n**缺陷检查**：\n1.  **科学/事实不合理**：无。物理学是正确的。\n2.  **不可形式化/不相关**：无。问题与主题直接相关。\n3.  **不完整/矛盾的设置**：无。提供的哈密顿量和定义足以进行所需的概念分析。\n4.  **不切实际/不可行**：无。这是一个标准的计算问题。\n5.  **病态/结构不良**：无。问题是清晰的。\n6.  **伪深刻/琐碎**：无。该问题涉及高级分子模拟中的一个非琐碎问题。\n7.  **超出科学可验证性**：无。这些陈述可以根据变换的数学性质进行验证。\n\n**步骤 3：结论与行动**\n问题陈述是**有效的**。它在科学上合理、良定且客观。我现在将继续进行解答并评估各个选项。\n\n### 推导与选项分析\n\n问题的核心在于哈密顿量的谐振耦合项，$H_{\\text{spring}} = \\sum_{j=1}^{P} \\frac{1}{2} m \\omega_P^2 \\left( q_j - q_{j+1} \\right)^2$。该项耦合了珠子的动力学，并引入了宽广的振动频率谱。\n\n**简正模坐标**\n到简正模坐标 $\\{u_k\\}$ 的变换将 $H_{\\text{spring}}$ 的二次型对角化。这是通过离散傅里叶变换实现的。这些简正模是独立的谐振子（在没有外势 $V(q)$ 的情况下）。这些模式的频率由下式给出：\n$$\n\\Omega_k = 2 \\omega_P \\left| \\sin\\left(\\frac{\\pi k}{P}\\right) \\right| \\quad \\text{for } k = 0, 1, \\ldots, P-1\n$$\n模式 $k=0$ 是质心，$u_0 = \\frac{1}{\\sqrt{P}} \\sum_{j=1}^{P} q_j$，其频率为 $\\Omega_0 = 0$。该模式代表了聚合物质心在平均外势影响下的类经典运动。其他模式 $k=1, \\ldots, P-1$ 是环状聚合物的内禀模式。它们的频率范围从 $k=1, P-1$ 的一个较小值，一直到 $k \\approx P/2$ 时的最大频率 $\\Omega_{\\text{max}} \\approx 2\\omega_P = \\frac{2P}{\\beta\\hbar}$。这个宽广的频率范围使系统变得刚性，因为数值积分器必须使用足够小的时间步长 $\\Delta t$ 来解析最快的模式，即 $\\Delta t \\ll 1/\\Omega_{\\text{max}}$。\n\n**分阶坐标**\n分阶坐标 $\\{\\xi_j\\}$ 是通过一个分层的非正交变换定义的。一个常见的定义是 $\\xi_1 = q_1$ 和 $\\xi_j = q_j - (\\alpha_j q_{j+1} + \\dots)$（对于 $j  1$）。选择该变换是为了在自由粒子（$V(q)=0$）的情况下，概率分布 $P(\\{\\xi_j\\})$ 可以因子分解，这意味着分阶变量成为统计上独立的高斯随机变量。对于相互作用的系统（$V(q)\\neq 0$），外势会以复杂的方式在所有分阶坐标之间重新引入耦合。哈密顿量在这些坐标中不是对角化的。\n\n现在，我们来评估每个选项。\n\n**A. 简正模坐标将谐振珠子-弹簧耦合对角化为具有明确定义的内禀模式频率谱的独立振子，从而可以进行模式特定的温控（例如，为每个模式定制摩擦并弱耦合质心），以强力阻尼高频内禀模式，提高积分稳定性，同时避免共振赝象。**\n这个陈述正确而全面地描述了简正模变换在PIMD中的主要优势。\n1.  *对角化*：根据定义，简正模变换将哈密顿量的谐振部分对角化。\n2.  *模式特定的温控*：由于谐振运动被解耦为独立的模式，可以对每个模式应用一个单独的温控器（例如，一个单独的朗之万摩擦/噪声对）。\n3.  *定制摩擦*：标准做法是对质心（$k=0$）模式施加弱阻尼，以实现对势能面的正确采样，同时对高频内禀模式（$k \\approx P/2$）施加强阻尼。这种强阻尼能有效地冷却刚性的、非物理的模式，防止能量伪地流入它们并导致数值不稳定。这也有助于减轻由内禀模式和物理模式之间的共振引起的各态历经性问题。\n整个陈述是准确的。\n**结论：正确**\n\n**B. 分阶坐标通过将所有内禀模式的频率都变为零来消除高频内禀模式，因此在实践中对这些模式进行温控是不必要的。**\n这个陈述是根本错误的。分阶坐标是一种坐标变换；它不改变系统Hessian矩阵的物理本征值。高频模式仍然存在，只是在不同的坐标基中表示。动能项 $\\sum_j p_j^2/(2m)$ 和谐振弹簧项，当用分阶动量和坐标表示时，并不会得到一个只有零频率内禀模式的系统。只有质心模式具有与谐振弹簧相关的零频率。必须对所有模式进行温控以确保对正则系综的正确采样。\n**结论：错误**\n\n**C. 在自由粒子极限下，分阶坐标为内禀位移产生独立的高斯变量，减少了珠子间的统计关联；对于相互作用的系统，它们相对于珠子坐标仍然能降低刚性，但不能完全对角化频谱，因此温控仍然是必要的，并且不如使用简正模那样具有针对性。**\n这个陈述正确地指出了分阶变换的关键特征。\n1.  *自由粒子极限*：分阶变换专门设计用于对角化自由粒子的路径积分的协方差矩阵，使分阶变量在统计上独立。这是其主要的理论动机。\n2.  *相互作用的系统*：当存在外势 $V(q)$ 时，势能项 $\\sum_j V(q_j)$ 在所有分阶坐标之间产生复杂的耦合，因此完整的哈密顿量不是对角化的。\n3.  *刚性和温控*：“相对于珠子坐标仍然能降低刚性”这句话略显含糊，但在某些积分器的背景下，变换后的运动方程的结构可能是有益的。关键是，该陈述正确地断言了频谱没有被完全对角化。因此，应用模式特定的温控器不像在简正模中那样直接。通常使用全局温控器或更复杂的、适用于分阶表示的广义朗之万方程（GLE）。因此，温控确实是必要的，且不如简正模那样具有“针对性”。\n该陈述提供了一个细致入微且准确的描述。\n**结论：正确**\n\n**D. 在简正模坐标中，质心模式在所有环状聚合物模式中频率最高，因此必须进行强力温控以维持数值稳定性；对质心的弱温控会导致能量漂移。**\n这个陈述是不正确的。质心模式（$k=0$）对应于所有珠子的一致平移，相对于内禀谐振弹簧的频率为 $\\Omega_0 = 0$。它在珠子们产生的平均势场中运动。最高频率属于 $k \\approx P/2$ 的内禀模式。因此，质心频率最高的假设是错误的。应该对质心进行弱温控以正确采样其动力学，而不是强力温控。强力温控会抑制物理扩散和探索。\n**结论：错误**\n\n**E. 对于低温下的轻原子，增加 $P$ 会提高最大内禀模式频率，使积分更加刚性；简正模坐标有助于进行依赖于模式的质量预处理，以展平有效频率谱并允许更大的时间步长，这是其相对于单独使用珠子或分阶坐标的一个实际优势。**\n这个陈述准确地描述了简正模表示的另一个主要优点。\n1.  *刚性*：对于低温（大 $\\beta$）或轻原子（小 $m$），需要大量的珠子 $P$ 才能收敛。最大频率 $\\Omega_{\\text{max}} \\approx 2P/(\\beta\\hbar)$ 随 $P$ 增加而增加，使得数值积分更加刚性，需要更小的时间步长。\n2.  *质量预处理*：在简正模坐标中，可以为拉格朗日量动能部分的每个简正模分配一个不同的赝质量 $m'_k$。通过设置 $m'_k = m (\\Omega_k/\\Omega_{\\text{target}})^2$ （对于 $k0$），所有内禀模式的自由粒子频率都可以变得等于一个目标频率 $\\Omega_{\\text{target}}$。这“展平”了问题谐振部分的频率谱。\n3.  *优势*：这消除了与环状聚合物本身相关的刚性，允许根据物理势 $V(q)$ 的时间尺度来选择积分时间步长 $\\Delta t$，而这通常要大得多。这种技术只有在模式解耦的简正模坐标中才直接可行。\n该陈述完全准确。\n**结论：正确**",
            "answer": "$$\\boxed{ACE}$$"
        }
    ]
}