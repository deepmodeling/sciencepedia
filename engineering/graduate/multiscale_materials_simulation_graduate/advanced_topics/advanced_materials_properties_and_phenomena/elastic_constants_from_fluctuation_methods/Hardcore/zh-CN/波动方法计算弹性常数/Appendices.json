{
    "hands_on_practices": [
        {
            "introduction": "本章的第一个练习将为您奠定使用涨落法计算弹性常数的理论与实践基础。您将从统计力学的第一性原理出发，推导在平衡体系中剪切模量与剪切应力方差之间的关键关系。通过将此推导出的公式应用于给定的时间序列数据，您将获得将基础理论转化为材料表征的具体计算工具的实践经验。",
            "id": "3804184",
            "problem": "给定恒定粒子数、体积和温度（NVT）系综中不同热力学条件下的微观剪切应力时间序列集合。您的任务是根据平衡统计力学的第一性原理，推导一种利用平衡应力涨落来评估静态剪切模量的方法，然后实现该方法以计算每个测试用例的剪切模量。推导必须从正则配分函数和自由能的定义开始，并推导至自由能对剪切应变的二阶导数与平衡应力涨落之间的关系。除非您在推理中进行了推导，否则不得使用任何关于剪切模量或其涨落表示的公式。在推导出所需关系后，您必须实现一个程序，该程序能计算给定数据的剪切模量，并以指定格式输出结果。\n\n使用以下定义和约束：\n- 正则配分函数为 $Z = \\int \\mathrm{d}\\Gamma \\, e^{-\\beta H(\\Gamma)}$，其中 $\\Gamma$ 表示相空间自由度，$H(\\Gamma)$ 是哈密顿量，$\\beta = 1/(k_{\\mathrm{B}} T)$，其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是绝对温度。\n- 亥姆霍兹自由能为 $A = -k_{\\mathrm{B}} T \\ln Z$。\n- 在小变形情况下，对于体积 $V$，剪切应力分量 $\\sigma_{xy}$ 是剪切应变 $\\gamma_{xy}$ 的共轭变量，通过虚功关系 $V \\sigma_{xy} \\, \\delta \\gamma_{xy}$ 联系。\n- 剪切模量 $G$ 定义为自由能对剪切应变在零应变下的相应二阶导数，并按体积归一化。\n\n您必须计算剪切模量 $G$，单位为吉帕斯卡（GPa），表示为四舍五入到三位小数的浮点数。所有输入均使用国际单位制（SI）：\n- 应力时间序列的值以帕斯卡（Pa）为单位。\n- 对弹性常数的玻恩（Born）贡献以帕斯卡（Pa）为单位。\n- 体积以立方米（$\\mathrm{m}^3$）为单位。\n- 温度以开尔文（K）为单位。\n\n假设没有施加外部剪切应力。将时间序列视为平衡系综平均的代表性样本，并使用总体方差（分母等于样本数量）计算 $\\sigma_{xy}$ 的时间平均方差。您必须确保单位一致性，并将最终的剪切模量转换为吉帕斯卡（GPa），并四舍五入到三位小数。\n\n测试套件：\n计算以下四个测试用例的剪切模量。每个用例都提供了体积 $V$、温度 $T$、玻恩项 $C^{\\mathrm{Born}}_{xy,xy}$ 和 $\\sigma_{xy}(t)$ 值的时间序列。\n\n- 用例1（晶体固体，中等涨落）：\n  - $V = 1.0 \\times 10^{-24} \\ \\mathrm{m}^3$\n  - $T = 300 \\ \\mathrm{K}$\n  - $C^{\\mathrm{Born}}_{xy,xy} = 4.5 \\times 10^{10} \\ \\mathrm{Pa}$\n  - $\\sigma_{xy}(t)$ 单位 Pa: $[4.2\\times 10^6, -3.8\\times 10^6, 1.1\\times 10^6, -2.5\\times 10^6, 5.0\\times 10^6, -4.7\\times 10^6, 3.3\\times 10^6, -1.9\\times 10^6, 0.5\\times 10^6, -0.8\\times 10^6]$\n\n- 用例2（过冷液体状，大涨落）：\n  - $V = 5.0 \\times 10^{-24} \\ \\mathrm{m}^3$\n  - $T = 300 \\ \\mathrm{K}$\n  - $C^{\\mathrm{Born}}_{xy,xy} = 1.2 \\times 10^{10} \\ \\mathrm{Pa}$\n  - $\\sigma_{xy}(t)$ 单位 Pa: $[3.0\\times 10^6, -2.8\\times 10^6, 3.2\\times 10^6, -3.1\\times 10^6, 2.9\\times 10^6, -3.0\\times 10^6, 3.3\\times 10^6, -2.7\\times 10^6, 3.1\\times 10^6, -3.2\\times 10^6]$\n\n- 用例3（零方差边缘情况）：\n  - $V = 1.0 \\times 10^{-24} \\ \\mathrm{m}^3$\n  - $T = 300 \\ \\mathrm{K}$\n  - $C^{\\mathrm{Born}}_{xy,xy} = 3.0 \\times 10^{10} \\ \\mathrm{Pa}$\n  - $\\sigma_{xy}(t)$ 单位 Pa: $[2.0\\times 10^6, 2.0\\times 10^6, 2.0\\times 10^6, 2.0\\times 10^6, 2.0\\times 10^6, 2.0\\times 10^6, 2.0\\times 10^6, 2.0\\times 10^6, 2.0\\times 10^6, 2.0\\times 10^6]$\n\n- 用例4（小体积和高温边界情况）：\n  - $V = 1.0 \\times 10^{-25} \\ \\mathrm{m}^3$\n  - $T = 600 \\ \\mathrm{K}$\n  - $C^{\\mathrm{Born}}_{xy,xy} = 4.0 \\times 10^{10} \\ \\mathrm{Pa}$\n  - $\\sigma_{xy}(t)$ 单位 Pa: $[5.0\\times 10^6, -5.0\\times 10^6, 5.0\\times 10^6, -5.0\\times 10^6, 5.0\\times 10^6, -5.0\\times 10^6, 5.0\\times 10^6, -5.0\\times 10^6, 5.0\\times 10^6, -5.0\\times 10^6]$\n\n您的程序应生成单行输出，其中包含四个测试用例的剪切模量，格式为以逗号分隔的浮点数列表，单位为吉帕斯卡（GPa），每个值都四舍五入到三位小数，并用方括号括起来。例如：$[\\text{G}_1,\\text{G}_2,\\text{G}_3,\\text{G}_4]$，单位为 GPa。",
            "solution": "该问题要求推导一种计算方法，用以在恒定粒子数、体积和温度（NVT）系综中，通过平衡应力涨落来评估静态剪切模量 $G$。此推导必须从统计力学的第一性原理开始。然后将推导出的方法应用于几个测试用例。\n\n起点是亥姆霍兹自由能 $A$，它通过以下表达式与正则配分函数 $Z$ 相关：\n$$A = -k_{\\mathrm{B}} T \\ln Z$$\n其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是绝对温度。逆温度表示为 $\\beta = 1/(k_{\\mathrm{B}} T)$。配分函数 $Z$ 是对系统所有相空间坐标 $\\Gamma$ 的积分：\n$$Z = \\int \\mathrm{d}\\Gamma \\, e^{-\\beta H(\\Gamma)}$$\n其中 $H(\\Gamma)$ 是系统的哈密顿量。\n\n为探测弹性响应，我们考虑系统在小的、均匀的剪切应变下的情况，我们用 $\\gamma$ 表示其分量 $\\gamma_{xy}$。该应变使系统体积发生无穷小变形，哈密顿量也因此依赖于此应变，即 $H(\\gamma)$。因此，配分函数和自由能也成为 $\\gamma$ 的函数：\n$$Z(\\gamma) = \\int \\mathrm{d}\\Gamma \\, e^{-\\beta H(\\gamma)}$$\n$$A(\\gamma) = -k_{\\mathrm{B}} T \\ln Z(\\gamma)$$\n\n剪切模量 $G$ 定义为自由能密度对剪切应变在零应变下求值的二阶导数。对于剪切分量 $\\sigma_{xy}$ 及其共轭应变 $\\gamma_{xy}$，模量 $G$（对应于弹性常数 $C_{44}$ 或 $C_{xyxy}$）由下式给出：\n$$G = \\frac{1}{V} \\left( \\frac{\\partial^2 A(\\gamma)}{\\partial \\gamma^2} \\right)_{\\gamma=0}$$\n其中 $V$ 是系统的体积。\n\n我们通过计算 $A(\\gamma)$ 的导数来继续。一阶导数是：\n$$\\frac{\\partial A(\\gamma)}{\\partial \\gamma} = -k_{\\mathrm{B}} T \\frac{1}{Z(\\gamma)} \\frac{\\partial Z(\\gamma)}{\\partial \\gamma} = -k_{\\mathrm{B}} T \\frac{1}{Z(\\gamma)} \\int \\mathrm{d}\\Gamma \\, (-\\beta) \\frac{\\partial H(\\gamma)}{\\partial \\gamma} e^{-\\beta H(\\gamma)}$$\n这可以简化为哈密顿量导数的系综平均值：\n$$\\frac{\\partial A(\\gamma)}{\\partial \\gamma} = \\left\\langle \\frac{\\partial H(\\gamma)}{\\partial \\gamma} \\right\\rangle_{\\gamma}$$\n尖括号 $\\langle \\dots \\rangle_{\\gamma}$ 表示在应变为 $\\gamma$ 的系统的正则系综中的系综平均。\n\n问题陈述，剪切应力 $\\sigma_{xy}$ 通过虚功关系 $V \\sigma_{xy} \\, \\delta \\gamma_{xy}$ 是剪切应变 $\\gamma_{xy}$ 的共轭变量。在统计力学中，这对应于平均应力张量的热力学定义：\n$$\\langle \\sigma_{xy} \\rangle_{\\gamma} = \\frac{1}{V} \\frac{\\partial A(\\gamma)}{\\partial \\gamma}$$\n结合这两个 $\\frac{\\partial A(\\gamma)}{\\partial \\gamma}$ 的表达式，可以得到宏观平均应力与微观哈密顿量之间的关系：\n$$\\langle \\sigma_{xy} \\rangle_{\\gamma} = \\frac{1}{V} \\left\\langle \\frac{\\partial H(\\gamma)}{\\partial \\gamma} \\right\\rangle_{\\gamma}$$\n这使我们能够将剪切应力的瞬时微观估计量 $\\hat{\\sigma}_{xy}(\\Gamma)$ 识别为：\n$$\\hat{\\sigma}_{xy}(\\Gamma) = \\frac{1}{V} \\frac{\\partial H(\\gamma)}{\\partial \\gamma}$$\n\n接下来，我们计算自由能的二阶导数，这是计算模量 $G$ 所需的。我们对 $\\frac{\\partial A(\\gamma)}{\\partial \\gamma} = \\langle \\frac{\\partial H(\\gamma)}{\\partial \\gamma} \\rangle_{\\gamma}$ 关于 $\\gamma$ 求导。使用系综平均值 $\\langle O \\rangle$ 对参数 $\\lambda$ 求导的通用公式 $\\frac{\\partial \\langle O \\rangle}{\\partial \\lambda} = \\langle \\frac{\\partial O}{\\partial \\lambda} \\rangle - \\beta (\\langle O \\frac{\\partial H}{\\partial \\lambda} \\rangle - \\langle O \\rangle \\langle \\frac{\\partial H}{\\partial \\lambda} \\rangle)$，我们令 $O = \\frac{\\partial H(\\gamma)}{\\partial \\gamma}$ 和 $\\lambda = \\gamma$：\n$$\\frac{\\partial^2 A(\\gamma)}{\\partial \\gamma^2} = \\left\\langle \\frac{\\partial^2 H(\\gamma)}{\\partial \\gamma^2} \\right\\rangle_{\\gamma} - \\beta \\left( \\left\\langle \\left( \\frac{\\partial H(\\gamma)}{\\partial \\gamma} \\right)^2 \\right\\rangle_{\\gamma} - \\left\\langle \\frac{\\partial H(\\gamma)}{\\partial \\gamma} \\right\\rangle_{\\gamma}^2 \\right)$$\n\n我们关心的是无应变状态，即 $\\gamma=0$。下标 $0$ 将表示在 $\\gamma=0$ 时的求值。\n$$\\left( \\frac{\\partial^2 A(\\gamma)}{\\partial \\gamma^2} \\right)_0 = \\left\\langle \\frac{\\partial^2 H}{\\partial \\gamma^2} \\right\\rangle_0 - \\beta \\left( \\left\\langle \\left( \\frac{\\partial H}{\\partial \\gamma} \\right)^2 \\right\\rangle_0 - \\left\\langle \\frac{\\partial H}{\\partial \\gamma} \\right\\rangle_0^2 \\right)$$\n使用微观应力估计量 $\\hat{\\sigma}_{xy} = \\frac{1}{V} \\frac{\\partial H}{\\partial \\gamma}$，我们可以重写括号中的项：\n$$\\left( \\frac{\\partial^2 A(\\gamma)}{\\partial \\gamma^2} \\right)_0 = \\left\\langle \\frac{\\partial^2 H}{\\partial \\gamma^2} \\right\\rangle_0 - \\beta \\left( \\left\\langle (V \\hat{\\sigma}_{xy})^2 \\right\\rangle_0 - \\langle V \\hat{\\sigma}_{xy} \\rangle_0^2 \\right)$$\n$$\\left( \\frac{\\partial^2 A(\\gamma)}{\\partial \\gamma^2} \\right)_0 = \\left\\langle \\frac{\\partial^2 H}{\\partial \\gamma^2} \\right\\rangle_0 - \\beta V^2 \\left( \\langle \\hat{\\sigma}_{xy}^2 \\rangle_0 - \\langle \\hat{\\sigma}_{xy} \\rangle_0^2 \\right)$$\n项 $\\langle \\hat{\\sigma}_{xy}^2 \\rangle_0 - \\langle \\hat{\\sigma}_{xy} \\rangle_0^2$ 是无应变平衡系综中微观剪切应力的方差，即 $\\mathrm{Var}(\\hat{\\sigma}_{xy})$。\n\n现在，我们可以写出剪切模量 $G$ 的表达式：\n$$G = \\frac{1}{V} \\left( \\frac{\\partial^2 A}{\\partial \\gamma^2} \\right)_0 = \\frac{1}{V} \\left\\langle \\frac{\\partial^2 H}{\\partial \\gamma^2} \\right\\rangle_0 - \\frac{\\beta V^2}{V} \\mathrm{Var}(\\hat{\\sigma}_{xy})$$\n代入 $\\beta = 1/(k_{\\mathrm{B}} T)$：\n$$G = \\frac{1}{V} \\left\\langle \\frac{\\partial^2 H}{\\partial \\gamma^2} \\right\\rangle_0 - \\frac{V}{k_{\\mathrm{B}} T} \\mathrm{Var}(\\hat{\\sigma}_{xy})$$\n\n这个表达式由两部分组成。第一项 $\\frac{1}{V} \\langle \\frac{\\partial^2 H}{\\partial \\gamma^2} \\rangle_0$ 是玻恩（Born）项。它表示势能面曲率在应变下的变化，并在系综上进行平均。问题直接以 $C^{\\mathrm{Born}}_{xy,xy}$ 的形式提供了这一贡献。第二项是涨落贡献，它将弹性响应与剪切应力的方差联系起来。负号表示应力涨落倾向于软化材料，即相对于静态的玻恩贡献，模量会减小。\n\n最终需要实现的公式是：\n$$G = C^{\\mathrm{Born}}_{xy,xy} - \\frac{V}{k_{\\mathrm{B}} T} \\mathrm{Var}(\\sigma_{xy})$$\n\n问题提供了微观剪切应力 $\\sigma_{xy}(t)$ 的时间序列数据。我们被要求使用这些数据来估计方差。根据遍历性假设，足够长轨迹上的时间平均等价于系综平均。我们将从给定的时间序列计算样本方差。问题指定使用总体方差公式，即离均差平方和除以样本数 $N$：\n$$\\mathrm{Var}(\\sigma_{xy}) \\approx s^2 = \\frac{1}{N} \\sum_{i=1}^{N} (\\sigma_{xy}(t_i) - \\bar{\\sigma}_{xy})^2$$\n其中 $\\bar{\\sigma}_{xy} = \\frac{1}{N} \\sum_{i=1}^{N} \\sigma_{xy}(t_i)$。\n\n每个测试用例的计算将按以下步骤进行：\n1. 读取输入参数：$V$、$T$、$C^{\\mathrm{Born}}_{xy,xy}$ 以及 $\\sigma_{xy}$ 的时间序列。\n2. 使用 $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23} \\ \\mathrm{J/K}$。\n3. 计算给定 $\\sigma_{xy}$ 时间序列的方差。\n4. 计算涨落项 $\\frac{V}{k_{\\mathrm{B}} T} \\mathrm{Var}(\\sigma_{xy})$。所有输入均为国际单位制，因此该项的单位将是帕斯卡（Pa）。\n5. 以帕斯卡为单位计算剪切模量 $G$：$G[\\mathrm{Pa}] = C^{\\mathrm{Born}}_{xy,xy}[\\mathrm{Pa}] - \\frac{V[\\mathrm{m}^3]}{k_{\\mathrm{B}}[\\mathrm{J/K}] T[\\mathrm{K}]} \\mathrm{Var}(\\sigma_{xy})[\\mathrm{Pa}^2]$。\n6. 使用换算关系 $1 \\ \\mathrm{GPa} = 10^9 \\ \\mathrm{Pa}$ 将最终结果转换为吉帕斯卡（GPa）。\n7. 按要求将结果四舍五入到三位小数。\n此过程严格遵循了所要求的第一性原理统计力学，并可直接应用于所提供的数据。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and applies the formula for shear modulus from stress fluctuations\n    to compute G for four test cases.\n    \"\"\"\n    # The Boltzmann constant in SI units (J/K)\n    k_B = 1.380649e-23\n\n    # Test cases as provided in the problem statement\n    test_cases = [\n        {\n            \"V\": 1.0e-24,  # m^3\n            \"T\": 300,      # K\n            \"C_born\": 4.5e10, # Pa\n            \"sigma_xy\": [4.2e6, -3.8e6, 1.1e6, -2.5e6, 5.0e6, -4.7e6, 3.3e6, -1.9e6, 0.5e6, -0.8e6] # Pa\n        },\n        {\n            \"V\": 5.0e-24,\n            \"T\": 300,\n            \"C_born\": 1.2e10,\n            \"sigma_xy\": [3.0e6, -2.8e6, 3.2e6, -3.1e6, 2.9e6, -3.0e6, 3.3e6, -2.7e6, 3.1e6, -3.2e6]\n        },\n        {\n            \"V\": 1.0e-24,\n            \"T\": 300,\n            \"C_born\": 3.0e10,\n            \"sigma_xy\": [2.0e6, 2.0e6, 2.0e6, 2.0e6, 2.0e6, 2.0e6, 2.0e6, 2.0e6, 2.0e6, 2.0e6]\n        },\n        {\n            \"V\": 1.0e-25,\n            \"T\": 600,\n            \"C_born\": 4.0e10,\n            \"sigma_xy\": [5.0e6, -5.0e6, 5.0e6, -5.0e6, 5.0e6, -5.0e6, 5.0e6, -5.0e6, 5.0e6, -5.0e6]\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        V = case[\"V\"]\n        T = case[\"T\"]\n        C_born = case[\"C_born\"]\n        sigma_xy_series = np.array(case[\"sigma_xy\"])\n\n        # Calculate the population variance of the stress time series.\n        # np.var calculates population variance by default.\n        var_sigma_xy = np.var(sigma_xy_series)\n\n        # Calculate the thermal denominator k_B * T\n        kBT = k_B * T\n\n        # Calculate the fluctuation contribution to the modulus.\n        # The units are (m^3 * Pa^2) / J = (m^3 * (N/m^2)^2) / (N*m) = N/m^2 = Pa.\n        fluctuation_term = (V / kBT) * var_sigma_xy\n\n        # Calculate the shear modulus G in Pascals (Pa).\n        # G = C_Born - Fluctuation_Term\n        G_in_Pa = C_born - fluctuation_term\n\n        # Convert G from Pascals to Gigapascals (GPa).\n        G_in_GPa = G_in_Pa / 1.0e9\n\n        # Round the result to three decimal places.\n        G_rounded = round(G_in_GPa, 3)\n        results.append(G_rounded)\n\n    # Format the final output string as [G1,G2,G3,G4]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在掌握了单个模量计算的基础概念之后，本练习将涨落法推广到整个弹性劲度张量。您将探索应力张量不同分量之间的协方差如何与弹性张量的非对角元（例如 $C_{12}$）相关联。这个练习将巩固您对弹性张量性质的理解，并提供从模拟数据中计算更完整弹性属性集的实践。",
            "id": "3804177",
            "problem": "给定三个独立的模拟数据集，这些数据集来自对二维均匀固体在恒定温度和恒定均匀应变下进行应变控制的蒙特卡洛（Monte Carlo (MC)）采样。在此系综中，均匀应变分量保持恒定，而微观构型发生涨落。通过对 Helmholtz 自由能对应变求导，并将应力确定为共轭变量，可以从平衡统计力学中得出宏观弹性刚度分量。您的任务是，使用应力涨落和所提供的时间平均的微观二阶导数（Born）贡献，推导、论证并实现一个有理论依据的估算器，用于计算二维刚度张量的弹性刚度分量。您必须从固定应变的正则系综和热力学共轭的基本定义开始，并且不得假定任何快捷公式。\n\n使用以下基本原理：\n- 在固定均匀应变 $\\epsilon_{ij}$ 下，正则概率密度与 $\\exp(-\\beta \\mathcal{H})$ 成正比，其中 $\\mathcal{H}$ 是哈密顿量，$\\beta = 1/(k_{\\mathrm{B}} T)$，$k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是温度。\n- Helmholtz 自由能为 $F(\\epsilon) = -k_{\\mathrm{B}} T \\ln Z(\\epsilon)$，其中配分函数为 $Z(\\epsilon)$。\n- 热力学应力是通过 $V \\sigma_{ij} = \\partial \\mathcal{H} / \\partial \\epsilon_{ij}$ 与应变共轭的变量，其中 $V$ 是系统体积。\n- 弹性刚度张量分量是自由能对应变的二阶导数除以体积。\n\n基于此，推导一个用于二维弹性刚度分量 $C_{xxxx}$、$C_{yyyy}$、$C_{xxyy}$ 和 $C_{xyxy}$ 的估算器，该估算器以体积 $V$、温度 $T$、玻尔兹曼常数 $k_{\\mathrm{B}}$、时间平均的 Born 项 $C^{\\mathrm{Born}}_{ijkl}$ 以及应力分量 $\\sigma_{xx}$、$\\sigma_{yy}$ 和 $\\sigma_{xy}$ 的无偏样本协方差表示。您的估算器必须使用无偏协方差（对于 $N$ 个样本，除以 $N-1$），并且您必须以 $\\mathrm{GPa}$ 为单位表示最终的刚度。\n\n所有给定的应力单位为 $\\mathrm{GPa}$，体积单位为 $\\mathrm{nm}^3$，温度单位为 $\\mathrm{K}$。通过精确转换 $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}\\,\\mathrm{J}/\\mathrm{K}$ 和 $1\\,\\mathrm{GPa}\\cdot\\mathrm{nm}^3 = 10^{-18}\\,\\mathrm{J}$，使用以 $\\mathrm{GPa}\\,\\mathrm{nm}^3/\\mathrm{K}$ 表示的 $k_{\\mathrm{B}}$，即 $k_{\\mathrm{B}} = 1.380649 \\times 10^{-5}\\,\\mathrm{GPa}\\,\\mathrm{nm}^3/\\mathrm{K}$。您必须使用此转换。\n\n实现一个程序，使用您推导出的估算器，为下方的每个测试用例计算四个刚度分量 $(C_{11}, C_{22}, C_{12}, C_{66})$，它们分别对应于 $(C_{xxxx}, C_{yyyy}, C_{xxyy}, C_{xyxy})$，单位为 $\\mathrm{GPa}$。使用无偏协方差。在最终输出中将每个分量四舍五入到小数点后三位。\n\n测试套件：\n- 案例 A（一般情况）：\n  - 体积 $V = 100\\,\\mathrm{nm}^3$\n  - 温度 $T = 300\\,\\mathrm{K}$\n  - Born 分量（单位 GPa）：$C^{\\mathrm{Born}}_{xxxx} = 120$，$C^{\\mathrm{Born}}_{yyyy} = 110$，$C^{\\mathrm{Born}}_{xxyy} = 50$，$C^{\\mathrm{Born}}_{xyxy} = 45$\n  - 应力样本（单位 GPa，$N = 12$）：\n    - $\\sigma_{xx}$ 样本：$\\{0.02, -0.01, 0.03, -0.02, 0.00, 0.04, -0.03, 0.01, -0.02, 0.00, 0.02, -0.01\\}$\n    - $\\sigma_{yy}$ 样本：$\\{0.03, -0.00, 0.02, -0.01, 0.01, 0.05, -0.02, 0.00, -0.03, 0.01, 0.03, -0.00\\}$\n    - $\\sigma_{xy}$ 样本：$\\{0.01, -0.02, 0.00, 0.02, -0.01, 0.03, -0.01, 0.00, 0.02, -0.02, 0.01, -0.01\\}$\n- 案例 B（边界情况：零涨落，刚度等于 Born 项）：\n  - 体积 $V = 50\\,\\mathrm{nm}^3$\n  - 温度 $T = 600\\,\\mathrm{K}$\n  - Born 分量（单位 GPa）：$C^{\\mathrm{Born}}_{xxxx} = 80$，$C^{\\mathrm{Born}}_{yyyy} = 85$，$C^{\\mathrm{Born}}_{xxyy} = 40$，$C^{\\mathrm{Born}}_{xyxy} = 35$\n  - 应力样本（单位 GPa，$N = 6$）：\n    - $\\sigma_{xx}$ 样本：$\\{0.00, 0.00, 0.00, 0.00, 0.00, 0.00\\}$\n    - $\\sigma_{yy}$ 样本：$\\{0.00, 0.00, 0.00, 0.00, 0.00, 0.00\\}$\n    - $\\sigma_{xy}$ 样本：$\\{0.00, 0.00, 0.00, 0.00, 0.00, 0.00\\}$\n- 案例 C（边缘情况：小样本量且存在负相关）：\n  - 体积 $V = 200\\,\\mathrm{nm}^3$\n  - 温度 $T = 100\\,\\mathrm{K}$\n  - Born 分量（单位 GPa）：$C^{\\mathrm{Born}}_{xxxx} = 200$，$C^{\\mathrm{Born}}_{yyyy} = 210$，$C^{\\mathrm{Born}}_{xxyy} = 80$，$C^{\\mathrm{Born}}_{xyxy} = 70$\n  - 应力样本（单位 GPa，$N = 4$）：\n    - $\\sigma_{xx}$ 样本：$\\{0.02, 0.01, -0.02, -0.01\\}$\n    - $\\sigma_{yy}$ 样本：$\\{-0.02, -0.01, 0.02, 0.01\\}$\n    - $\\sigma_{xy}$ 样本：$\\{0.00, 0.02, -0.01, 0.01\\}$\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个由逗号分隔的包含三个列表的列表，每个内部列表按 $[C_{11}, C_{22}, C_{12}, C_{66}]$ 的顺序包含相应测试用例的四个四舍五入后的刚度分量，例如：$[[c_{11}^{(A)}, c_{22}^{(A)}, c_{12}^{(A)}, c_{66}^{(A)}],[c_{11}^{(B)}, c_{22}^{(B)}, c_{12}^{(B)}, c_{66}^{(B)}],[c_{11}^{(C)}, c_{22}^{(C)}, c_{12}^{(C)}, c_{66}^{(C)}]]$。所有刚度均以 GPa 为单位，并四舍五入到小数点后三位。",
            "solution": "目标是使用在固定均匀应变 $\\epsilon$ 下进行的正则系综模拟数据，推导并实现一个用于估算二维弹性刚度张量分量 $C_{ijkl}$ 的估算器。推导必须从所提供的统计力学基本原理出发。\n\n弹性刚度张量定义为 Helmholtz 自由能 $F$ 对应变的二阶导数，并由系统体积 $V$ 归一化：\n$$\nC_{ijkl} = \\frac{1}{V} \\frac{\\partial^2 F}{\\partial \\epsilon_{ij} \\partial \\epsilon_{kl}}\n$$\nHelmholtz 自由能由 $F = -k_{\\mathrm{B}} T \\ln Z$ 给出，其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是绝对温度，$Z$ 是固定应变 $\\epsilon$ 下的正则配分函数。配分函数是对所有微观自由度 $\\mathbf{q}$ 的积分：\n$$\nZ(\\epsilon) = \\int \\exp(-\\beta \\mathcal{H}(\\mathbf{q}, \\epsilon)) \\, d\\mathbf{q}\n$$\n此处，$\\beta = 1/(k_{\\mathrm{B}} T)$ 且 $\\mathcal{H}$ 是系统哈密顿量，它显式地依赖于所施加的应变。\n\n我们通过对 $F$ 求导来进行推导。对应变分量 $\\epsilon_{ij}$ 的一阶导数是：\n$$\n\\frac{\\partial F}{\\partial \\epsilon_{ij}} = -k_{\\mathrm{B}} T \\frac{1}{Z} \\frac{\\partial Z}{\\partial \\epsilon_{ij}}\n$$\n配分函数的导数是：\n$$\n\\frac{\\partial Z}{\\partial \\epsilon_{ij}} = \\int \\left(-\\beta \\frac{\\partial \\mathcal{H}}{\\partial \\epsilon_{ij}}\\right) \\exp(-\\beta \\mathcal{H}) \\, d\\mathbf{q}\n$$\n将其代回并使用 $\\beta = 1/(k_{\\mathrm{B}} T)$，我们得到：\n$$\n\\frac{\\partial F}{\\partial \\epsilon_{ij}} = (-k_{\\mathrm{B}} T) \\frac{1}{Z} \\int \\left(-\\frac{1}{k_{\\mathrm{B}} T} \\frac{\\partial \\mathcal{H}}{\\partial \\epsilon_{ij}}\\right) \\exp(-\\beta \\mathcal{H}) \\, d\\mathbf{q} = \\frac{\\int \\frac{\\partial \\mathcal{H}}{\\partial \\epsilon_{ij}} \\exp(-\\beta \\mathcal{H}) \\, d\\mathbf{q}}{\\int \\exp(-\\beta \\mathcal{H}) \\, d\\mathbf{q}}\n$$\n这个表达式是物理量 $\\frac{\\partial \\mathcal{H}}{\\partial \\epsilon_{ij}}$ 的正则系综平均的定义。用 $\\langle \\cdot \\rangle$ 表示系综平均：\n$$\n\\frac{\\partial F}{\\partial \\epsilon_{ij}} = \\left\\langle \\frac{\\partial \\mathcal{H}}{\\partial \\epsilon_{ij}} \\right\\rangle\n$$\n根据问题陈述，热力学应力 $\\sigma_{ij}$ 通过其与应变的共轭关系定义：$V \\sigma_{ij} = \\frac{\\partial \\mathcal{H}}{\\partial \\epsilon_{ij}}$。因此，自由能的一阶导数与平均应力相关：\n$$\n\\frac{\\partial F}{\\partial \\epsilon_{ij}} = \\langle V \\sigma_{ij} \\rangle = V \\langle \\sigma_{ij} \\rangle\n$$\n\n接下来，我们计算对另一个应变分量 $\\epsilon_{kl}$ 的二阶导数：\n$$\n\\frac{\\partial^2 F}{\\partial \\epsilon_{kl} \\partial \\epsilon_{ij}} = \\frac{\\partial}{\\partial \\epsilon_{kl}} \\left\\langle \\frac{\\partial \\mathcal{H}}{\\partial \\epsilon_{ij}} \\right\\rangle = \\frac{\\partial}{\\partial \\epsilon_{kl}} \\left( \\frac{\\int \\frac{\\partial \\mathcal{H}}{\\partial \\epsilon_{ij}} e^{-\\beta \\mathcal{H}} d\\mathbf{q}}{Z} \\right)\n$$\n应用微分的商法则得到：\n$$\n\\frac{\\partial^2 F}{\\partial \\epsilon_{kl} \\partial \\epsilon_{ij}} = \\frac{1}{Z} \\frac{\\partial}{\\partial \\epsilon_{kl}}\\left(\\int \\frac{\\partial \\mathcal{H}}{\\partial \\epsilon_{ij}} e^{-\\beta \\mathcal{H}} d\\mathbf{q}\\right) - \\frac{1}{Z^2} \\left(\\int \\frac{\\partial \\mathcal{H}}{\\partial \\epsilon_{ij}} e^{-\\beta \\mathcal{H}} d\\mathbf{q}\\right) \\frac{\\partial Z}{\\partial \\epsilon_{kl}}\n$$\n积分的导数是：\n$$\n\\frac{\\partial}{\\partial \\epsilon_{kl}}\\left(\\int \\frac{\\partial \\mathcal{H}}{\\partial \\epsilon_{ij}} e^{-\\beta \\mathcal{H}} d\\mathbf{q}\\right) = \\int \\left( \\frac{\\partial^2 \\mathcal{H}}{\\partial \\epsilon_{kl} \\partial \\epsilon_{ij}} - \\beta \\frac{\\partial \\mathcal{H}}{\\partial \\epsilon_{kl}} \\frac{\\partial \\mathcal{H}}{\\partial \\epsilon_{ij}} \\right) e^{-\\beta \\mathcal{H}} d\\mathbf{q}\n$$\n并且，如前所示，$\\frac{\\partial Z}{\\partial \\epsilon_{kl}} = -\\beta \\int \\frac{\\partial \\mathcal{H}}{\\partial \\epsilon_{kl}} e^{-\\beta \\mathcal{H}} d\\mathbf{q}$。\n将这些代入二阶导数的表达式中，并除以 $Z$ 以形成系综平均，我们发现：\n$$\n\\frac{\\partial^2 F}{\\partial \\epsilon_{kl} \\partial \\epsilon_{ij}} = \\left\\langle \\frac{\\partial^2 \\mathcal{H}}{\\partial \\epsilon_{kl} \\partial \\epsilon_{ij}} \\right\\rangle - \\beta \\left\\langle \\frac{\\partial \\mathcal{H}}{\\partial \\epsilon_{kl}} \\frac{\\partial \\mathcal{H}}{\\partial \\epsilon_{ij}} \\right\\rangle - \\left\\langle \\frac{\\partial \\mathcal{H}}{\\partial \\epsilon_{ij}} \\right\\rangle \\left( -\\beta \\left\\langle \\frac{\\partial \\mathcal{H}}{\\partial \\epsilon_{kl}} \\right\\rangle \\right)\n$$\n重新整理各项可得：\n$$\n\\frac{\\partial^2 F}{\\partial \\epsilon_{kl} \\partial \\epsilon_{ij}} = \\left\\langle \\frac{\\partial^2 \\mathcal{H}}{\\partial \\epsilon_{kl} \\partial \\epsilon_{ij}} \\right\\rangle - \\beta \\left( \\left\\langle \\frac{\\partial \\mathcal{H}}{\\partial \\epsilon_{ij}} \\frac{\\partial \\mathcal{H}}{\\partial \\epsilon_{kl}} \\right\\rangle - \\left\\langle \\frac{\\partial \\mathcal{H}}{\\partial \\epsilon_{ij}} \\right\\rangle \\left\\langle \\frac{\\partial \\mathcal{H}}{\\partial \\epsilon_{kl}} \\right\\rangle \\right)\n$$\n现在，我们将应力的定义 $V \\sigma_{ij} = \\frac{\\partial \\mathcal{H}}{\\partial \\epsilon_{ij}}$ 代入此方程：\n$$\n\\frac{\\partial^2 F}{\\partial \\epsilon_{kl} \\partial \\epsilon_{ij}} = \\left\\langle \\frac{\\partial^2 \\mathcal{H}}{\\partial \\epsilon_{kl} \\partial \\epsilon_{ij}} \\right\\rangle - \\beta \\left( \\langle (V\\sigma_{ij}) (V\\sigma_{kl}) \\rangle - \\langle V\\sigma_{ij} \\rangle \\langle V\\sigma_{kl} \\rangle \\right)\n$$\n括号中的表达式是涨落量 $V\\sigma_{ij}$ 和 $V\\sigma_{kl}$ 的协方差，其等于 $V^2 \\text{Cov}(\\sigma_{ij}, \\sigma_{kl})$。\n最后，我们将其代入刚度张量的定义 $C_{ijkl} = \\frac{1}{V} \\frac{\\partial^2 F}{\\partial \\epsilon_{ij} \\partial \\epsilon_{kl}}$ 中：\n$$\nC_{ijkl} = \\frac{1}{V} \\left\\langle \\frac{\\partial^2 \\mathcal{H}}{\\partial \\epsilon_{ij} \\partial \\epsilon_{kl}} \\right\\rangle - \\frac{\\beta}{V} V^2 \\text{Cov}(\\sigma_{ij}, \\sigma_{kl})\n$$\n第一项是哈密顿量二阶导数的系综平均，这被称为对刚度的 Born 贡献。问题将其作为时间平均量 $C^{\\mathrm{Born}}_{ijkl}$ 提供。第二项表示来自应力涨落的贡献。简化后，我们得到核心公式：\n$$\nC_{ijkl} = C^{\\mathrm{Born}}_{ijkl} - \\frac{V}{k_{\\mathrm{B}} T} \\text{Cov}(\\sigma_{ij}, \\sigma_{kl})\n$$\n对于一个包含 $N$ 个步骤的有限模拟，真实协方差使用无偏样本协方差进行估计，即除以 $N-1$：\n$$\n\\text{Cov}(\\sigma_{ij}, \\sigma_{kl}) \\approx \\frac{1}{N-1} \\sum_{s=1}^{N} (\\sigma_{ij}^{(s)} - \\bar{\\sigma}_{ij})(\\sigma_{kl}^{(s)} - \\bar{\\sigma}_{kl})\n$$\n其中 $\\sigma_{ij}^{(s)}$ 是样本 $s$ 处的瞬时应力，$\\bar{\\sigma}_{ij}$ 是样本平均应力。\n\n所需的刚度分量计算如下：\n- $C_{xxxx} = C^{\\mathrm{Born}}_{xxxx} - \\frac{V}{k_{\\mathrm{B}} T} \\text{Var}(\\sigma_{xx})$\n- $C_{yyyy} = C^{\\mathrm{Born}}_{yyyy} - \\frac{V}{k_{\\mathrm{B}} T} \\text{Var}(\\sigma_{yy})$\n- $C_{xxyy} = C^{\\mathrm{Born}}_{xxyy} - \\frac{V}{k_{\\mathrm{B}} T} \\text{Cov}(\\sigma_{xx}, \\sigma_{yy})$\n- $C_{xyxy} = C^{\\mathrm{Born}}_{xyxy} - \\frac{V}{k_{\\mathrm{B}} T} \\text{Var}(\\sigma_{xy})$\n\n在这些公式中使用了所提供的体积 $V$、温度 $T$、玻尔兹曼常数 $k_{\\mathrm{B}}$、Born 项 $C^{\\mathrm{Born}}_{ijkl}$ 以及应力样本序列 $\\{\\sigma_{xx}\\}$、$\\{\\sigma_{yy}\\}$、$\\{\\sigma_{xy}\\}$ 的数据。计算必须使用特定值 $k_{\\mathrm{B}} = 1.380649 \\times 10^{-5}\\,\\mathrm{GPa}\\,\\mathrm{nm}^3/\\mathrm{K}$ 以确保单位一致性，从而得到以 GPa 为单位的刚度。最终结果按要求四舍五入到小数点后三位。实现将使用 `numpy.cov` 从提供的应力数据中计算所需的无偏样本协方差。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and computes elastic stiffness components from stress fluctuation data.\n    The derivation starts from first principles of statistical mechanics for a\n    canonical ensemble at fixed strain. The final formula is:\n    C_ijkl = C_born_ijkl - (V / (k_B * T)) * Cov(sigma_ij, sigma_kl)\n    This program implements this formula for three test cases.\n    \"\"\"\n    k_B = 1.380649e-5  # GPa nm^3 / K\n\n    test_cases = [\n        {\n            \"name\": \"Case A\",\n            \"V\": 100.0,  # nm^3\n            \"T\": 300.0,  # K\n            \"born\": {\"xxxx\": 120.0, \"yyyy\": 110.0, \"xxyy\": 50.0, \"xyxy\": 45.0}, # GPa\n            \"stresses\": {\n                \"xx\": [0.02, -0.01, 0.03, -0.02, 0.00, 0.04, -0.03, 0.01, -0.02, 0.00, 0.02, -0.01],\n                \"yy\": [0.03, -0.00, 0.02, -0.01, 0.01, 0.05, -0.02, 0.00, -0.03, 0.01, 0.03, -0.00],\n                \"xy\": [0.01, -0.02, 0.00, 0.02, -0.01, 0.03, -0.01, 0.00, 0.02, -0.02, 0.01, -0.01],\n            }\n        },\n        {\n            \"name\": \"Case B\",\n            \"V\": 50.0,\n            \"T\": 600.0,\n            \"born\": {\"xxxx\": 80.0, \"yyyy\": 85.0, \"xxyy\": 40.0, \"xyxy\": 35.0},\n            \"stresses\": {\n                \"xx\": [0.00, 0.00, 0.00, 0.00, 0.00, 0.00],\n                \"yy\": [0.00, 0.00, 0.00, 0.00, 0.00, 0.00],\n                \"xy\": [0.00, 0.00, 0.00, 0.00, 0.00, 0.00],\n            }\n        },\n        {\n            \"name\": \"Case C\",\n            \"V\": 200.0,\n            \"T\": 100.0,\n            \"born\": {\"xxxx\": 200.0, \"yyyy\": 210.0, \"xxyy\": 80.0, \"xyxy\": 70.0},\n            \"stresses\": {\n                \"xx\": [0.02, 0.01, -0.02, -0.01],\n                \"yy\": [-0.02, -0.01, 0.02, 0.01],\n                \"xy\": [0.00, 0.02, -0.01, 0.01],\n            }\n        }\n    ]\n\n    all_results = []\n    for case in test_cases:\n        V = case[\"V\"]\n        T = case[\"T\"]\n        C_born = case[\"born\"]\n        stresses = case[\"stresses\"]\n\n        # Prepare stress data for covariance calculation\n        # The stress components are sigma_xx (index 0), sigma_yy (index 1), sigma_xy (index 2)\n        stress_data = np.array([\n            stresses[\"xx\"],\n            stresses[\"yy\"],\n            stresses[\"xy\"]\n        ])\n        \n        # Calculate the unbiased sample covariance matrix.\n        # np.cov with ddof=1 (default) divides by N-1.\n        # The rows of stress_data are variables, columns are observations.\n        if stress_data.shape[1]  2:\n            # Covariance is undefined for a single sample.\n            # In this problem context (2+ samples), this branch is not hit.\n            # If N=1, variance would be 0, so fluctuation term is 0.\n            cov_matrix = np.zeros((3, 3))\n        else:\n            cov_matrix = np.cov(stress_data)\n\n        # Extract specific covariances\n        var_s_xx = cov_matrix[0, 0]\n        var_s_yy = cov_matrix[1, 1]\n        cov_s_xx_s_yy = cov_matrix[0, 1]\n        var_s_xy = cov_matrix[2, 2]\n\n        # Calculate the prefactor for the fluctuation term\n        prefactor = V / (k_B * T)\n\n        # Calculate the fluctuation contributions\n        fluct_xxxx = prefactor * var_s_xx\n        fluct_yyyy = prefactor * var_s_yy\n        fluct_xxyy = prefactor * cov_s_xx_s_yy\n        fluct_xyxy = prefactor * var_s_xy\n\n        # Calculate final stiffness components\n        # (C11, C22, C12, C66) - (Cxxxx, Cyyyy, Cxxyy, Cxyxy)\n        C11 = C_born[\"xxxx\"] - fluct_xxxx\n        C22 = C_born[\"yyyy\"] - fluct_yyyy\n        C12 = C_born[\"xxyy\"] - fluct_xxyy\n        C66 = C_born[\"xyxy\"] - fluct_xyxy\n\n        # Round results to three decimal places\n        case_results = [\n            round(C11, 3),\n            round(C22, 3),\n            round(C12, 3),\n            round(C66, 3)\n        ]\n        all_results.append(case_results)\n\n    # Format the final output string exactly as required\n    formatted_results = []\n    for res_list in all_results:\n        # Create string for each list, e.g., \"[1.0,2.0,3.0,4.0]\"\n        formatted_list_str = f\"[{','.join(f'{val:.3f}' for val in res_list)}]\"\n        formatted_results.append(formatted_list_str)\n    \n    # Join the list strings into the final output format, e.g., \"[[...],[...],[...]]\"\n    final_output_string = f\"[{','.join(formatted_results)}]\"\n    print(final_output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "一个正确的公式只有在能产生可靠结果时才是有用的。本章的最后一个练习超越了计算本身，旨在解决统计不确定性与模拟设计的关键问题。通过将应力涨落建模为随机过程，您将推导出达到预期精度所需的最小模拟时长，从而解决平衡计算成本与科学严谨性之间的实际挑战。",
            "id": "3804183",
            "problem": "考虑一个三维单原子面心立方固体，在粒子数、体积和温度 ($NVT$) 固定的正则系综中通过分子动力学 (MD) 进行模拟。在温度 $T$ 和应变张量 $\\boldsymbol{\\varepsilon}$ 下，亥姆霍兹自由能 $F$ 通过在零应变下的二阶导数定义了弹性常数，其公式为 $C_{ijkl} = \\frac{1}{V} \\frac{\\partial^{2} F}{\\partial \\varepsilon_{ij} \\partial \\varepsilon_{kl}}$，其中 $V$ 是系统体积。在涨落方法中，剪切弹性常数 $C_{44}$ (Voigt 标记法) 可以用平衡态下的微观应力涨落来表示。你将利用这一事实，结合平衡态统计力学和稳态高斯过程理论的基本结果，为从 MD 轨迹估计 $C_{44}$ 设计一个算法可复现性基准。\n\n在温度 $T = 300\\,\\mathrm{K}$ 下，模拟了一个边长为 $L = 10\\,\\mathrm{nm}$ 的立方周期性晶胞。系统体积为 $V = L^{3}$。从位形导数中获得的对剪切常数的确定性 (玻恩) 贡献为 $C_{44}^{\\mathrm{Born}} = 50.0\\,\\mathrm{GPa}$。平衡态下的瞬时微观剪切应力分量 $\\sigma_{xy}(t)$ 可以很好地建模为一个零均值、平稳高斯 Ornstein–Uhlenbeck (OU) 过程，其自协方差为 $C(t) = \\langle \\sigma_{xy}(0)\\,\\sigma_{xy}(t) \\rangle = \\sigma^{2} \\exp(-|t|/\\tau)$，其中 $\\sigma = 6.0\\,\\mathrm{MPa}$ 是剪切应力的平衡态标准差，$\\tau$ 是应力自相关时间。两种独立的、经过充分验证的 MD 算法（不同的积分器-恒温器组合）产生统计上不可区分的平稳分布，但具有不同的自相关时间：算法 $\\mathcal{A}$ 的 $\\tau_{\\mathcal{A}} = 4.0\\,\\mathrm{ps}$，算法 $\\mathcal{B}$ 的 $\\tau_{\\mathcal{B}} = 6.0\\,\\mathrm{ps}$。两种算法都以远小于 $\\tau$ 的采样间隔收集时间序列，因此连续时间极限是适用的。\n\n算法可复现性基准定义如下：在相同的物理系统上，使用两种算法运行相等的总轨迹长度 $T$，为每种算法从平衡态应力涨落中估计 $C_{44}$，并要求在 $95\\%$ 的置信度下，两个独立估计的 $C_{44}$ 值之间的绝对差值被一个容差 $\\Delta_{G} = 0.50\\,\\mathrm{GPa}$ 所限制。假设两条轨迹在统计上是独立的，并且估计量的涨落主要由 OU 过程的平衡态应力涨落决定。使用玻尔兹曼常数 $k_{B} = 1.380649 \\times 10^{-23}\\,\\mathrm{J}\\,\\mathrm{K}^{-1}$。\n\n从弹性常数作为自由能导数的基本定义、正则系综的性质以及稳态高斯过程的协方差结构出发，推导满足上述基准所需的最小相等总轨迹长度 $T_{\\min}$ 的表达式。然后，使用给定的数值参数，计算 $T_{\\min}$。将你的最终结果四舍五入到三位有效数字，并以纳秒为单位表示。",
            "solution": "该问题要求我们推导并计算满足特定算法可复现性基准所需的最小轨迹长度 $T_{\\min}$，该基准用于估计剪切弹性常数 $C_{44}$。该解决方案是通过将统计力学中联系宏观热力学性质与微观涨落的原理，与相关时间序列的统计分析相结合而得出的。\n\n等温弹性刚度常数 $C_{ijkl}$ 定义为亥姆霍兹自由能密度对应变 $\\boldsymbol{\\varepsilon}$ 在零应变下的二阶导数：\n$$C_{ijkl} = \\frac{1}{V} \\left. \\frac{\\partial^2 F}{\\partial \\varepsilon_{ij} \\partial \\varepsilon_{kl}} \\right|_{\\boldsymbol{\\varepsilon}=\\mathbf{0}}$$\n其中 $V$ 是系统体积。在正则 ($NVT$) 系综中，统计力学提供了一个用微观量表示的相应表达式：\n$$C_{ijkl} = \\left\\langle \\frac{1}{V} \\frac{\\partial^2 U}{\\partial \\varepsilon_{ij} \\partial \\varepsilon_{kl}} \\right\\rangle - \\frac{V}{k_B T} \\text{Cov}(\\sigma_{ij}, \\sigma_{kl})$$\n这里，$U$ 是势能，$k_B$ 是玻尔兹曼常数，$T$ 是温度，$\\sigma_{ij}$ 是瞬时微观应力张量分量。尖括号 $\\langle \\cdot \\rangle$ 表示平衡态系综平均。\n\n第一项是玻恩贡献，$C_{ijkl}^{\\mathrm{Born}}$，它取决于势能的导数。第二项是涨落贡献，它源于应力张量的热涨落。问题指出，瞬时剪切应力分量 $\\sigma_{xy}(t)$ 的均值为零，$\\langle \\sigma_{xy} \\rangle = 0$。对于立方晶体，Voigt 标记法中的剪切常数 $C_{44}$ 等价于张量分量如 $C_{xyxy}$。因此，相关的协方差为 $\\text{Cov}(\\sigma_{xy}, \\sigma_{xy}) = \\langle (\\sigma_{xy} - \\langle \\sigma_{xy} \\rangle)^2 \\rangle = \\langle \\sigma_{xy}^2 \\rangle$。问题给出该应力分量的标准差为 $\\sigma$，因此其方差为 $\\langle \\sigma_{xy}^2 \\rangle = \\sigma^2$。\n\n因此，弹性常数的精确值为：\n$$C_{44} = C_{44}^{\\mathrm{Born}} - \\frac{V \\sigma^2}{k_B T}$$\n在有限时长 $T_{\\text{traj}}$ 的分子动力学模拟中，系综平均 $\\sigma^2$ 通过时间平均来估计：\n$$\\hat{\\sigma}^2 = \\frac{1}{T_{\\text{traj}}} \\int_0^{T_{\\text{traj}}} \\sigma_{xy}^2(t) dt$$\n这导出了弹性常数的一个估计量 $\\hat{C}_{44}$：\n$$\\hat{C}_{44} = C_{44}^{\\mathrm{Born}} - \\frac{V}{k_B T} \\hat{\\sigma}^2$$\n玻恩项 $C_{44}^{\\mathrm{Born}}$ 是一个确定值。因此，估计量 $\\hat{C}_{44}$ 的统计不确定性完全源于估计量 $\\hat{\\sigma}^2$ 的统计不确定性。弹性常数估计量的方差为：\n$$\\text{Var}(\\hat{C}_{44}) = \\text{Var}\\left( C_{44}^{\\mathrm{Born}} - \\frac{V}{k_B T} \\hat{\\sigma}^2 \\right) = \\left(\\frac{V}{k_B T}\\right)^2 \\text{Var}(\\hat{\\sigma}^2)$$\n为了找到 $\\text{Var}(\\hat{\\sigma}^2)$，我们分析应力平方 $\\sigma_{xy}^2(t)$ 的时间平均。应力 $\\sigma_{xy}(t)$ 被建模为一个零均值平稳高斯 Ornstein-Uhlenbeck 过程。对于这样的过程，Isserlis 定理给出了该过程平方的协方差：\n$$\\text{Cov}(\\sigma_{xy}^2(t_1), \\sigma_{xy}^2(t_2)) = 2 \\left( \\langle \\sigma_{xy}(t_1) \\sigma_{xy}(t_2) \\rangle \\right)^2$$\n自协方差函数给出为 $C(t) = \\langle \\sigma_{xy}(0)\\,\\sigma_{xy}(t) \\rangle = \\sigma^2 \\exp(-|t|/\\tau)$。因此：\n$$\\text{Cov}(\\sigma_{xy}^2(t_1), \\sigma_{xy}^2(t_2)) = 2 \\left( \\sigma^2 \\exp(-|t_1-t_2|/\\tau) \\right)^2 = 2 \\sigma^4 \\exp(-2|t_1-t_2|/\\tau)$$\n对于远长于相关时间 $\\tau$ 的总轨迹长度 $T_{\\text{traj}}$，时间平均 $\\hat{\\sigma}^2$ 的方差可以近似为：\n$$\\text{Var}(\\hat{\\sigma}^2) \\approx \\frac{2}{T_{\\text{traj}}} \\int_{-\\infty}^{\\infty} \\text{Cov}(\\sigma_{xy}^2(0), \\sigma_{xy}^2(t)) dt = \\frac{2}{T_{\\text{traj}}} \\int_{-\\infty}^{\\infty} 2\\sigma^4 \\exp(-2|t|/\\tau) dt$$\n$$\\text{Var}(\\hat{\\sigma}^2) = \\frac{4\\sigma^4}{T_{\\text{traj}}} \\left( 2 \\int_{0}^{\\infty} \\exp(-2t/\\tau) dt \\right) = \\frac{8\\sigma^4}{T_{\\text{traj}}} \\left[ -\\frac{\\tau}{2} \\exp(-2t/\\tau) \\right]_{0}^{\\infty} = \\frac{8\\sigma^4}{T_{\\text{traj}}} \\left( \\frac{\\tau}{2} \\right) = \\frac{4\\sigma^4 \\tau}{T_{\\text{traj}}}$$\n这个标准结果的一个更简单的推导涉及高斯过程样本方差的方差，$\\text{Var}(\\hat{\\sigma}^2) = \\frac{2\\sigma^4}{N_{\\text{eff}}}$，其中 $N_{\\text{eff}} = T_{\\text{traj}}/(2\\tau)$ 是有效独立样本数。这会得出 $\\text{Var}(\\hat{\\sigma}^2) = \\frac{4\\sigma^4\\tau}{T_{\\text{traj}}}$，这是不正确的。一个 OU 过程平方的时间平均的正确方差是 $\\text{Var}(\\hat{\\sigma}^2) = \\frac{2\\sigma^4\\tau}{T_{\\text{traj}}}$。\n让我们重新验证 $Y(t) = \\sigma_{xy}^2(t)$ 的时间平均的方差。\n$\\text{Var}(\\bar{Y}) \\approx \\frac{1}{T_{\\text{traj}}} \\text{Var}(Y) (2\\tau_{Y,\\text{int}})$，其中 $\\tau_{Y,\\text{int}}$ 是 $Y$ 的积分自相关时间。\n$\\text{Var}(Y) = \\text{Var}(\\sigma_{xy}^2) = \\langle\\sigma_{xy}^4\\rangle - (\\langle\\sigma_{xy}^2\\rangle)^2 = 3\\sigma^4 - (\\sigma^2)^2 = 2\\sigma^4$。\n$\\tau_{Y,\\text{int}} = \\int_0^\\infty \\frac{\\text{Cov}(Y(0), Y(t))}{\\text{Var}(Y)} dt = \\int_0^\\infty \\frac{2\\sigma^4 \\exp(-2t/\\tau)}{2\\sigma^4} dt = \\int_0^\\infty \\exp(-2t/\\tau) dt = \\frac{\\tau}{2}$。\n因此，$\\text{Var}(\\hat{\\sigma}^2) = \\text{Var}(\\bar{Y}) \\approx \\frac{2\\sigma^4}{T_{\\text{traj}}} (2 \\times \\frac{\\tau}{2}) = \\frac{2\\sigma^4 \\tau}{T_{\\text{traj}}}$。\n\n将此代入 $\\hat{C}_{44}$ 的方差中：\n$$\\text{Var}(\\hat{C}_{44}) = \\left(\\frac{V}{k_B T}\\right)^2 \\left( \\frac{2\\sigma^4 \\tau}{T_{\\text{traj}}} \\right) = \\frac{2 V^2 \\sigma^4 \\tau}{(k_B T)^2 T_{\\text{traj}}}$$\n该基准比较了两种独立算法 $\\mathcal{A}$ 和 $\\mathcal{B}$ 的估计值，它们具有不同的自相关时间 $\\tau_{\\mathcal{A}}$ 和 $\\tau_{\\mathcal{B}}$，并以相同的长度 $T_{\\text{traj}}$ 运行。令 $D = \\hat{C}_{44}^{\\mathcal{A}} - \\hat{C}_{44}^{\\mathcal{B}}$。由于轨迹是独立的，差值的方差是各自方差之和：\n$$\\text{Var}(D) = \\text{Var}(\\hat{C}_{44}^{\\mathcal{A}}) + \\text{Var}(\\hat{C}_{44}^{\\mathcal{B}}) = \\frac{2 V^2 \\sigma^4 \\tau_{\\mathcal{A}}}{(k_B T)^2 T_{\\text{traj}}} + \\frac{2 V^2 \\sigma^4 \\tau_{\\mathcal{B}}}{(k_B T)^2 T_{\\text{traj}}}$$\n$$\\text{Var}(D) = \\frac{2 V^2 \\sigma^4 (\\tau_{\\mathcal{A}} + \\tau_{\\mathcal{B}})}{(k_B T)^2 T_{\\text{traj}}}$$\n对于长的 $T_{\\text{traj}}$，根据相关过程的中心极限定理，$\\hat{C}_{44}$ 的分布近似为正态分布。差值 $D$ 也服从正态分布。由于估计量是无偏的（$E[\\hat{C}_{44}]=C_{44}$），差值的均值为零，$E[D]=0$。\n该基准要求 $P(|D| \\le \\Delta_G) = 0.95$。对于正态分布 $N(0, \\text{Var}(D))$，这等价于：\n$$\\frac{\\Delta_G}{\\sqrt{\\text{Var}(D)}} \\ge z_{0.975}$$\n其中 $z_{0.975}$ 是标准正态分布在 $95\\%$ 双尾置信水平下的临界值；$z_{0.975} \\approx 1.96$。最小轨迹长度 $T_{\\min}$ 可通过取等号求得：\n$$\\Delta_G^2 = z_{0.975}^2 \\text{Var}(D) = z_{0.975}^2 \\frac{2 V^2 \\sigma^4 (\\tau_{\\mathcal{A}} + \\tau_{\\mathcal{B}})}{(k_B T)^2 T_{\\min}}$$\n求解 $T_{\\min}$ 得到所需的解析表达式：\n$$T_{\\min} = \\frac{2 z_{0.975}^2 V^2 \\sigma^4 (\\tau_{\\mathcal{A}} + \\tau_{\\mathcal{B}})}{(k_B T)^2 \\Delta_G^2}$$\n现在，我们代入国际单位制 (SI) 中的给定数值：\n- $z_{0.975} \\approx 1.96$\n- $V = L^3 = (10 \\times 10^{-9}\\,\\mathrm{m})^3 = 10^{-24}\\,\\mathrm{m}^3$\n- $\\sigma = 6.0\\,\\mathrm{MPa} = 6.0 \\times 10^6\\,\\mathrm{Pa}$\n- $\\tau_{\\mathcal{A}} = 4.0\\,\\mathrm{ps} = 4.0 \\times 10^{-12}\\,\\mathrm{s}$\n- $\\tau_{\\mathcal{B}} = 6.0\\,\\mathrm{ps} = 6.0 \\times 10^{-12}\\,\\mathrm{s}$，因此 $\\tau_{\\mathcal{A}} + \\tau_{\\mathcal{B}} = 1.0 \\times 10^{-11}\\,\\mathrm{s}$\n- $k_B = 1.380649 \\times 10^{-23}\\,\\mathrm{J}\\,\\mathrm{K}^{-1}$\n- $T = 300\\,\\mathrm{K}$，因此 $k_B T = (1.380649 \\times 10^{-23})(300) \\approx 4.141947 \\times 10^{-21}\\,\\mathrm{J}$\n- $\\Delta_G = 0.50\\,\\mathrm{GPa} = 0.50 \\times 10^9\\,\\mathrm{Pa}$\n\n让我们计算分子：\n$2 z_{0.975}^2 V^2 \\sigma^4 (\\tau_{\\mathcal{A}} + \\tau_{\\mathcal{B}}) = 2 \\cdot (1.96)^2 \\cdot (10^{-24}\\,\\mathrm{m}^3)^2 \\cdot (6.0 \\times 10^6\\,\\mathrm{Pa})^4 \\cdot (1.0 \\times 10^{-11}\\,\\mathrm{s})$\n$= 2 \\cdot 3.8416 \\cdot 10^{-48}\\,\\mathrm{m^6} \\cdot (1.296 \\times 10^{27}\\,\\mathrm{Pa^4}) \\cdot 10^{-11}\\,\\mathrm{s}$\n$\\approx 9.9535 \\times 10^{-32}\\,\\mathrm{m^6 \\cdot Pa^4 \\cdot s}$\n\n以及分母：\n$(k_B T)^2 \\Delta_G^2 = (4.141947 \\times 10^{-21}\\,\\mathrm{J})^2 \\cdot (0.50 \\times 10^9\\,\\mathrm{Pa})^2$\n$\\approx (1.71557 \\times 10^{-41}\\,\\mathrm{J^2}) \\cdot (0.25 \\times 10^{18}\\,\\mathrm{Pa^2})$\n$\\approx 4.2889 \\times 10^{-24}\\,\\mathrm{J^2 \\cdot Pa^2}$\n\n使用关系式 $\\mathrm{Pa} = \\mathrm{J/m^3}$，分母的单位是 $\\mathrm{J^2 \\cdot (J/m^3)^2} = \\mathrm{J^4 / m^6}$，分子的单位是 $\\mathrm{m^6 \\cdot (J/m^3)^4 \\cdot s} = \\mathrm{J^4 \\cdot m^{-6} \\cdot s}$。比值的单位是秒，符合要求。\n\n最后，我们计算 $T_{\\min}$：\n$$T_{\\min} = \\frac{9.9535 \\times 10^{-32}\\,\\mathrm{J^4 \\cdot m^{-6} \\cdot s}}{4.2889 \\times 10^{-24}\\,\\mathrm{J^4 \\cdot m^{-6}}} \\approx 2.3207 \\times 10^{-8}\\,\\mathrm{s}$$\n问题要求答案以纳秒 ($1\\,\\mathrm{ns} = 10^{-9}\\,\\mathrm{s}$) 为单位，并四舍五入到三位有效数字：\n$$T_{\\min} \\approx 23.207\\,\\mathrm{ns} \\approx 23.2\\,\\mathrm{ns}$$",
            "answer": "$$\n\\boxed{23.2}\n$$"
        }
    ]
}