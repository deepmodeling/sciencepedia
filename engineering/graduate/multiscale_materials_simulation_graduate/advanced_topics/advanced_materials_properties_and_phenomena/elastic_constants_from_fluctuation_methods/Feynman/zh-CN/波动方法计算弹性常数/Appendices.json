{
    "hands_on_practices": [
        {
            "introduction": "这项实践是掌握涨落方法的核心。我们将从统计力学的第一性原理出发，推导出一个关键的涨落公式，该公式将宏观的剪切模量与微观的应力涨落直接联系起来。通过将此公式应用于一个假设的分子动力学模拟数据集，你将亲身体验如何从原子尺度的涨落中提取出材料的力学性能，这是计算材料科学中的一项基本技能。",
            "id": "3804184",
            "problem": "给定恒定粒子数、体积和温度（NVT）系综中，不同热力学条件下的一组微观剪切应力时间序列。你的任务是从平衡统计力学的第一性原理出发，推导一种利用平衡态应力涨落来评估静态剪切模量的计算方法，然后实现该方法以计算每个测试用例的剪切模量。该推导必须从正则配分函数和自由能的定义开始，并推导至自由能对剪切应变的二阶导数与平衡态应力涨落之间的关系。除非在你的推导过程中得出，否则你不能使用任何关于剪切模量或其涨落表示的现成公式。在推导出所需的关系后，你必须实现一个程序来计算给定数据的剪切模量，并以指定格式输出结果。\n\n使用以下定义和约束：\n- 正则配分函数为 $Z = \\int \\mathrm{d}\\Gamma \\, e^{-\\beta H(\\Gamma)}$，其中 $\\Gamma$ 表示相空间自由度，$H(\\Gamma)$ 是哈密顿量，$\\beta = 1/(k_{\\mathrm{B}} T)$，其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是绝对温度。\n- 亥姆霍兹自由能为 $A = -k_{\\mathrm{B}} T \\ln Z$。\n- 在小形变下，对于体积 $V$，剪切应力分量 $\\sigma_{xy}$ 是剪切应变 $\\gamma_{xy}$ 的共轭变量，通过虚功关系 $V \\sigma_{xy} \\, \\delta \\gamma_{xy}$ 关联。\n- 剪切模量 $G$ 定义为自由能对剪切应变在零应变下的相应二阶导数，并按体积进行归一化。\n\n你必须计算剪切模量 $G$（单位为吉帕斯卡，GPa），表示为一个四舍五入到三位小数的浮点数。所有输入均使用国际单位制（SI）：\n- 应力时间序列的值单位为帕斯卡（Pa）。\n- 弹性常数的玻恩贡献项单位为帕斯卡（Pa）。\n- 体积单位为立方米（$\\mathrm{m}^3$）。\n- 温度单位为开尔文（K）。\n\n假设没有施加外部剪切应力。将该时间序列视为平衡系综平均的代表性样本，并使用总体方差（分母等于样本数量）计算 $\\sigma_{xy}$ 的时间平均方差。你必须确保单位一致性，并将最终的剪切模量转换为吉帕斯卡（GPa），四舍五入到三位小数。\n\n测试套件：\n为以下四个测试用例计算剪切模量。每个用例提供了体积 $V$、温度 $T$、玻恩项 $C^{\\mathrm{Born}}_{xy,xy}$ 和一个 $\\sigma_{xy}(t)$ 值的时间序列。\n\n- 用例1（晶体固体，中等涨落）：\n  - $V = 1.0 \\times 10^{-24} \\ \\mathrm{m}^3$\n  - $T = 300 \\ \\mathrm{K}$\n  - $C^{\\mathrm{Born}}_{xy,xy} = 4.5 \\times 10^{10} \\ \\mathrm{Pa}$\n  - $\\sigma_{xy}(t)$ 单位 Pa: $[4.2\\times 10^6, -3.8\\times 10^6, 1.1\\times 10^6, -2.5\\times 10^6, 5.0\\times 10^6, -4.7\\times 10^6, 3.3\\times 10^6, -1.9\\times 10^6, 0.5\\times 10^6, -0.8\\times 10^6]$\n\n- 用例2（过冷类液体，大涨落）：\n  - $V = 5.0 \\times 10^{-24} \\ \\mathrm{m}^3$\n  - $T = 300 \\ \\mathrm{K}$\n  - $C^{\\mathrm{Born}}_{xy,xy} = 1.2 \\times 10^{10} \\ \\mathrm{Pa}$\n  - $\\sigma_{xy}(t)$ 单位 Pa: $[3.0\\times 10^6, -2.8\\times 10^6, 3.2\\times 10^6, -3.1\\times 10^6, 2.9\\times 10^6, -3.0\\times 10^6, 3.3\\times 10^6, -2.7\\times 10^6, 3.1\\times 10^6, -3.2\\times 10^6]$\n\n- 用例3（零方差边缘情况）：\n  - $V = 1.0 \\times 10^{-24} \\ \\mathrm{m}^3$\n  - $T = 300 \\ \\mathrm{K}$\n  - $C^{\\mathrm{Born}}_{xy,xy} = 3.0 \\times 10^{10} \\ \\mathrm{Pa}$\n  - $\\sigma_{xy}(t)$ 单位 Pa: $[2.0\\times 10^6, 2.0\\times 10^6, 2.0\\times 10^6, 2.0\\times 10^6, 2.0\\times 10^6, 2.0\\times 10^6, 2.0\\times 10^6, 2.0\\times 10^6, 2.0\\times 10^6, 2.0\\times 10^6]$\n\n- 用例4（小体积和高温边界情况）：\n  - $V = 1.0 \\times 10^{-25} \\ \\mathrm{m}^3$\n  - $T = 600 \\ \\mathrm{K}$\n  - $C^{\\mathrm{Born}}_{xy,xy} = 4.0 \\times 10^{10} \\ \\mathrm{Pa}$\n  - $\\sigma_{xy}(t)$ 单位 Pa: $[5.0\\times 10^6, -5.0\\times 10^6, 5.0\\times 10^6, -5.0\\times 10^6, 5.0\\times 10^6, -5.0\\times 10^6, 5.0\\times 10^6, -5.0\\times 10^6, 5.0\\times 10^6, -5.0\\times 10^6]$\n\n你的程序应生成单行输出，其中包含四个测试用例的剪切模量，形式为以逗号分隔的浮点数列表，单位为吉帕斯卡（GPa），每个值都四舍五入到三位小数，并用方括号括起来。例如：$[\\text{G}_1,\\text{G}_2,\\text{G}_3,\\text{G}_4]$，单位为 GPa。",
            "solution": "该问题要求在恒定粒子数、体积和温度（NVT）系综中，从平衡态应力涨落推导一个计算静态剪切模量 $G$ 的方法。此推导必须从统计力学的第一性原理开始。然后将推导出的方法应用于几个测试用例。\n\n出发点是亥姆霍兹自由能 $A$，它通过以下表达式与正则配分函数 $Z$ 相关联：\n$$A = -k_{\\mathrm{B}} T \\ln Z$$\n其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是绝对温度。逆温度用 $\\beta = 1/(k_{\\mathrm{B}} T)$ 表示。配分函数 $Z$ 是对系统所有相空间坐标 $\\Gamma$ 的积分：\n$$Z = \\int \\mathrm{d}\\Gamma \\, e^{-\\beta H(\\Gamma)}$$\n其中 $H(\\Gamma)$ 是系统的哈密顿量。\n\n为探测量弹性响应，我们考虑系统在一个小的、均匀的剪切应变作用下，我们用 $\\gamma$ 表示其分量 $\\gamma_{xy}$。该应变使系统发生无穷小形变，哈密顿量也变得依赖于此应变，$H(\\gamma)$。因此，配分函数和自由能也成为 $\\gamma$ 的函数：\n$$Z(\\gamma) = \\int \\mathrm{d}\\Gamma \\, e^{-\\beta H(\\gamma)}$$\n$$A(\\gamma) = -k_{\\mathrm{B}} T \\ln Z(\\gamma)$$\n\n剪切模量 $G$ 定义为自由能密度对剪切应变的二阶导数，在零应变下取值。对于剪切分量 $\\sigma_{xy}$ 及其共轭应变 $\\gamma_{xy}$，模量 $G$（对应于弹性常数 $C_{44}$ 或 $C_{xyxy}$）由下式给出：\n$$G = \\frac{1}{V} \\left( \\frac{\\partial^2 A(\\gamma)}{\\partial \\gamma^2} \\right)_{\\gamma=0}$$\n其中 $V$ 是系统的体积。\n\n我们通过计算 $A(\\gamma)$ 的导数来继续。一阶导数为：\n$$\\frac{\\partial A(\\gamma)}{\\partial \\gamma} = -k_{\\mathrm{B}} T \\frac{1}{Z(\\gamma)} \\frac{\\partial Z(\\gamma)}{\\partial \\gamma} = -k_{\\mathrm{B}} T \\frac{1}{Z(\\gamma)} \\int \\mathrm{d}\\Gamma \\, (-\\beta) \\frac{\\partial H(\\gamma)}{\\partial \\gamma} e^{-\\beta H(\\gamma)}$$\n这可以简化为哈密顿量导数的系综平均值：\n$$\\frac{\\partial A(\\gamma)}{\\partial \\gamma} = \\left\\langle \\frac{\\partial H(\\gamma)}{\\partial \\gamma} \\right\\rangle_{\\gamma}$$\n尖括号 $\\langle \\dots \\rangle_{\\gamma}$ 表示在应变为 $\\gamma$ 的系统中的正则系综平均。\n\n问题陈述，剪切应力 $\\sigma_{xy}$ 是通过虚功关系 $V \\sigma_{xy} \\, \\delta \\gamma_{xy}$ 与剪切应变 $\\gamma_{xy}$ 共轭的变量。在统计力学中，这对应于平均应力张量的热力学定义：\n$$\\langle \\sigma_{xy} \\rangle_{\\gamma} = \\frac{1}{V} \\frac{\\partial A(\\gamma)}{\\partial \\gamma}$$\n结合这两个关于 $\\frac{\\partial A(\\gamma)}{\\partial \\gamma}$ 的表达式，我们得到了宏观平均应力与微观哈密顿量之间的关系：\n$$\\langle \\sigma_{xy} \\rangle_{\\gamma} = \\frac{1}{V} \\left\\langle \\frac{\\partial H(\\gamma)}{\\partial \\gamma} \\right\\rangle_{\\gamma}$$\n这使我们能够将瞬时的、微观的剪切应力估算量 $\\hat{\\sigma}_{xy}(\\Gamma)$ 确定为：\n$$\\hat{\\sigma}_{xy}(\\Gamma) = \\frac{1}{V} \\frac{\\partial H(\\gamma)}{\\partial \\gamma}$$\n\n接下来，我们计算自由能的二阶导数，这是计算模量 $G$ 所必需的。我们对 $\\frac{\\partial A(\\gamma)}{\\partial \\gamma} = \\langle \\frac{\\partial H(\\gamma)}{\\partial \\gamma} \\rangle_{\\gamma}$ 求关于 $\\gamma$ 的导数。使用系综平均值 $\\langle O \\rangle$ 对参数 $\\lambda$ 求导的通用公式 $\\frac{\\partial \\langle O \\rangle}{\\partial \\lambda} = \\langle \\frac{\\partial O}{\\partial \\lambda} \\rangle - \\beta (\\langle O \\frac{\\partial H}{\\partial \\lambda} \\rangle - \\langle O \\rangle \\langle \\frac{\\partial H}{\\partial \\lambda} \\rangle)$，我们设 $O = \\frac{\\partial H(\\gamma)}{\\partial \\gamma}$ 且 $\\lambda = \\gamma$：\n$$\\frac{\\partial^2 A(\\gamma)}{\\partial \\gamma^2} = \\left\\langle \\frac{\\partial^2 H(\\gamma)}{\\partial \\gamma^2} \\right\\rangle_{\\gamma} - \\beta \\left( \\left\\langle \\left( \\frac{\\partial H(\\gamma)}{\\partial \\gamma} \\right)^2 \\right\\rangle_{\\gamma} - \\left\\langle \\frac{\\partial H(\\gamma)}{\\partial \\gamma} \\right\\rangle_{\\gamma}^2 \\right)$$\n\n我们关心的是无应变状态，即 $\\gamma=0$。下标 $0$ 将表示在 $\\gamma=0$ 处取值。\n$$\\left( \\frac{\\partial^2 A(\\gamma)}{\\partial \\gamma^2} \\right)_0 = \\left\\langle \\frac{\\partial^2 H}{\\partial \\gamma^2} \\right\\rangle_0 - \\beta \\left( \\left\\langle \\left( \\frac{\\partial H}{\\partial \\gamma} \\right)^2 \\right\\rangle_0 - \\left\\langle \\frac{\\partial H}{\\partial \\gamma} \\right\\rangle_0^2 \\right)$$\n使用微观应力估算量 $\\hat{\\sigma}_{xy} = \\frac{1}{V} \\frac{\\partial H}{\\partial \\gamma}$，我们可以重写括号中的项：\n$$\\left( \\frac{\\partial^2 A(\\gamma)}{\\partial \\gamma^2} \\right)_0 = \\left\\langle \\frac{\\partial^2 H}{\\partial \\gamma^2} \\right\\rangle_0 - \\beta \\left( \\left\\langle (V \\hat{\\sigma}_{xy})^2 \\right\\rangle_0 - \\langle V \\hat{\\sigma}_{xy} \\rangle_0^2 \\right)$$\n$$\\left( \\frac{\\partial^2 A(\\gamma)}{\\partial \\gamma^2} \\right)_0 = \\left\\langle \\frac{\\partial^2 H}{\\partial \\gamma^2} \\right\\rangle_0 - \\beta V^2 \\left( \\langle \\hat{\\sigma}_{xy}^2 \\rangle_0 - \\langle \\hat{\\sigma}_{xy} \\rangle_0^2 \\right)$$\n项 $\\langle \\hat{\\sigma}_{xy}^2 \\rangle_0 - \\langle \\hat{\\sigma}_{xy} \\rangle_0^2$ 是无应变平衡系综中微观剪切应力的方差，$\\mathrm{Var}(\\hat{\\sigma}_{xy})$。\n\n现在，我们可以写出剪切模量 $G$ 的表达式：\n$$G = \\frac{1}{V} \\left( \\frac{\\partial^2 A}{\\partial \\gamma^2} \\right)_0 = \\frac{1}{V} \\left\\langle \\frac{\\partial^2 H}{\\partial \\gamma^2} \\right\\rangle_0 - \\frac{\\beta V^2}{V} \\mathrm{Var}(\\hat{\\sigma}_{xy})$$\n代入 $\\beta = 1/(k_{\\mathrm{B}} T)$：\n$$G = \\frac{1}{V} \\left\\langle \\frac{\\partial^2 H}{\\partial \\gamma^2} \\right\\rangle_0 - \\frac{V}{k_{\\mathrm{B}} T} \\mathrm{Var}(\\hat{\\sigma}_{xy})$$\n\n该表达式由两部分组成。第一项 $\\frac{1}{V} \\langle \\frac{\\partial^2 H}{\\partial \\gamma^2} \\rangle_0$ 是玻恩项（Born term）。它表示在系综平均下，势能面曲率随应变的变化。问题直接以 $C^{\\mathrm{Born}}_{xy,xy}$ 的形式提供了这一贡献。第二项是涨落贡献，它将弹性响应与剪切应力的方差联系起来。负号表示应力涨落倾向于软化材料，即相对于静态的玻恩贡献，模量会减小。\n\n最终需要实现的公式是：\n$$G = C^{\\mathrm{Born}}_{xy,xy} - \\frac{V}{k_{\\mathrm{B}} T} \\mathrm{Var}(\\sigma_{xy})$$\n\n问题提供了微观剪切应力 $\\sigma_{xy}(t)$ 的时间序列数据。我们被指示使用这些数据来估计方差。根据遍历假设，足够长轨迹上的时间平均等价于系综平均。我们将根据给定的时间序列计算方差。问题指定使用总体方差公式，其中与均值的平方偏差之和除以样本数量 $N$：\n$$\\mathrm{Var}(\\sigma_{xy}) \\approx s^2 = \\frac{1}{N} \\sum_{i=1}^{N} (\\sigma_{xy}(t_i) - \\bar{\\sigma}_{xy})^2$$\n其中 $\\bar{\\sigma}_{xy} = \\frac{1}{N} \\sum_{i=1}^{N} \\sigma_{xy}(t_i)$。\n\n每个测试用例的计算将按以下步骤进行：\n1.  读取输入参数：$V$、$T$、$C^{\\mathrm{Born}}_{xy,xy}$ 和 $\\sigma_{xy}$ 的时间序列。\n2.  使用 $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23} \\ \\mathrm{J/K}$。\n3.  计算给定 $\\sigma_{xy}$ 时间序列的方差。\n4.  计算涨落项 $\\frac{V}{k_{\\mathrm{B}} T} \\mathrm{Var}(\\sigma_{xy})$。所有输入均为国际单位制，因此该项的单位将是帕斯卡（Pa）。\n5.  以帕斯卡为单位计算剪切模量 $G$：$G[\\mathrm{Pa}] = C^{\\mathrm{Born}}_{xy,xy}[\\mathrm{Pa}] - \\frac{V[\\mathrm{m}^3]}{k_{\\mathrm{B}}[\\mathrm{J/K}] T[\\mathrm{K}]} \\mathrm{Var}(\\sigma_{xy})[\\mathrm{Pa}^2]$。\n6.  使用换算关系 $1 \\ \\mathrm{GPa} = 10^9 \\ \\mathrm{Pa}$ 将最终结果转换为吉帕斯卡（GPa）。\n7.  按要求将结果四舍五入到三位小数。\n\n此过程严格遵循了所要求的第一性原理统计力学，并可直接应用于所提供的数据。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and applies the formula for shear modulus from stress fluctuations\n    to compute G for four test cases.\n    \"\"\"\n    # The Boltzmann constant in SI units (J/K)\n    k_B = 1.380649e-23\n\n    # Test cases as provided in the problem statement\n    test_cases = [\n        {\n            \"V\": 1.0e-24,  # m^3\n            \"T\": 300,      # K\n            \"C_born\": 4.5e10, # Pa\n            \"sigma_xy\": [4.2e6, -3.8e6, 1.1e6, -2.5e6, 5.0e6, -4.7e6, 3.3e6, -1.9e6, 0.5e6, -0.8e6] # Pa\n        },\n        {\n            \"V\": 5.0e-24,\n            \"T\": 300,\n            \"C_born\": 1.2e10,\n            \"sigma_xy\": [3.0e6, -2.8e6, 3.2e6, -3.1e6, 2.9e6, -3.0e6, 3.3e6, -2.7e6, 3.1e6, -3.2e6]\n        },\n        {\n            \"V\": 1.0e-24,\n            \"T\": 300,\n            \"C_born\": 3.0e10,\n            \"sigma_xy\": [2.0e6, 2.0e6, 2.0e6, 2.0e6, 2.0e6, 2.0e6, 2.0e6, 2.0e6, 2.0e6, 2.0e6]\n        },\n        {\n            \"V\": 1.0e-25,\n            \"T\": 600,\n            \"C_born\": 4.0e10,\n            \"sigma_xy\": [5.0e6, -5.0e6, 5.0e6, -5.0e6, 5.0e6, -5.0e6, 5.0e6, -5.0e6, 5.0e6, -5.0e6]\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        V = case[\"V\"]\n        T = case[\"T\"]\n        C_born = case[\"C_born\"]\n        sigma_xy_series = np.array(case[\"sigma_xy\"])\n\n        # Calculate the population variance of the stress time series.\n        # np.var calculates population variance by default.\n        var_sigma_xy = np.var(sigma_xy_series)\n\n        # Calculate the thermal denominator k_B * T\n        kBT = k_B * T\n\n        # Calculate the fluctuation contribution to the modulus.\n        # The units are (m^3 * Pa^2) / J = (m^3 * (N/m^2)^2) / (N*m) = N/m^2 = Pa.\n        fluctuation_term = (V / kBT) * var_sigma_xy\n\n        # Calculate the shear modulus G in Pascals (Pa).\n        # G = C_Born - Fluctuation_Term\n        G_in_Pa = C_born - fluctuation_term\n\n        # Convert G from Pascals to Gigapascals (GPa).\n        G_in_GPa = G_in_Pa / 1.0e9\n\n        # Round the result to three decimal places.\n        G_rounded = round(G_in_GPa, 3)\n        results.append(G_rounded)\n\n    # Format the final output string as [G1,G2,G3,G4]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在掌握了单个弹性常数的计算之后，我们将把这一概念推广到更一般的情况。这项练习旨在计算二维材料的多个弹性刚度张量分量，包括对角和非对角项。你将发现，这需要我们不仅考虑单个应力分量的方差，还要考虑不同应力分量之间的协方差，从而更全面地描述材料的各向异性响应。",
            "id": "3804177",
            "problem": "给定三个独立的模拟数据集，这些数据集来自对二维均匀固体在固定温度和固定均匀应变下进行应变控制的蒙特卡罗（Monte Carlo (MC)）采样。在该系综中，均匀应变分量保持恒定，而微观构型发生涨落。通过对亥姆霍兹自由能对应变求导并将应力识别为共轭变量，可以从平衡统计力学中得到宏观弹性刚度分量。您的任务是，利用应力涨落和所提供的时间平均微观二阶导数（玻恩）贡献，推导、论证并实现一个有原则的估计量，用于计算二维刚度张量的弹性刚度分量。您必须从固定应变下的正则系综和热力学共轭的基本定义出发，并且不得假设任何简化公式。\n\n请使用以下基础理论：\n- 在固定均匀应变 $\\epsilon_{ij}$ 下，正则概率密度与 $\\exp(-\\beta \\mathcal{H})$ 成正比，其中 $\\mathcal{H}$ 是哈密顿量，$\\beta = 1/(k_{\\mathrm{B}} T)$，$k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是温度。\n- 亥姆霍兹自由能为 $F(\\epsilon) = -k_{\\mathrm{B}} T \\ln Z(\\epsilon)$，其中 $Z(\\epsilon)$ 是配分函数。\n- 热力学应力是通过 $V \\sigma_{ij} = \\partial \\mathcal{H} / \\partial \\epsilon_{ij}$ 与应变共轭的变量，其中 $V$ 是系统体积。\n- 弹性刚度张量分量是自由能对应变的二阶导数除以体积。\n\n基于此，推导一个用于二维弹性刚度分量 $C_{xxxx}$、$C_{yyyy}$、$C_{xxyy}$ 和 $C_{xyxy}$ 的估计量，该估计量以体积 $V$、温度 $T$、玻尔兹曼常数 $k_{\\mathrm{B}}$、时间平均的玻恩项 $C^{\\mathrm{Born}}_{ijkl}$ 以及应力分量 $\\sigma_{xx}$、$\\sigma_{yy}$ 和 $\\sigma_{xy}$ 的无偏样本协方差来表示。您的估计量必须使用无偏协方差（对于 $N$ 个样本，除以 $N-1$），并且最终的刚度必须以 $\\mathrm{GPa}$ 为单位表示。\n\n所有提供的应力单位为 $\\mathrm{GPa}$，体积单位为 $\\mathrm{nm}^3$，温度单位为 $\\mathrm{K}$。使用以 $\\mathrm{GPa}\\,\\mathrm{nm}^3/\\mathrm{K}$ 表示的 $k_{\\mathrm{B}}$，通过精确转换 $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}\\,\\mathrm{J}/\\mathrm{K}$ 和 $1\\,\\mathrm{GPa}\\cdot\\mathrm{nm}^3 = 10^{-18}\\,\\mathrm{J}$，得到 $k_{\\mathrm{B}} = 1.380649 \\times 10^{-5}\\,\\mathrm{GPa}\\,\\mathrm{nm}^3/\\mathrm{K}$。您必须使用此转换关系。\n\n实现一个程序，使用您推导的估计量，为下面的每个测试用例计算四个刚度分量 $(C_{11}, C_{22}, C_{12}, C_{66})$，它们分别对应于 $(C_{xxxx}, C_{yyyy}, C_{xxyy}, C_{xyxy})$，单位为 $\\mathrm{GPa}$。请使用无偏协方差。在最终输出中，将每个分量四舍五入到三位小数。\n\n测试套件：\n- 案例 A（一般情况）：\n  - 体积 $V = 100\\,\\mathrm{nm}^3$\n  - 温度 $T = 300\\,\\mathrm{K}$\n  - 玻恩分量（单位 $\\mathrm{GPa}$）：$C^{\\mathrm{Born}}_{xxxx} = 120$，$C^{\\mathrm{Born}}_{yyyy} = 110$，$C^{\\mathrm{Born}}_{xxyy} = 50$，$C^{\\mathrm{Born}}_{xyxy} = 45$\n  - 应力样本（单位 $\\mathrm{GPa}$，$N = 12$）：\n    - $\\sigma_{xx}$ 样本：$\\{0.02, -0.01, 0.03, -0.02, 0.00, 0.04, -0.03, 0.01, -0.02, 0.00, 0.02, -0.01\\}$\n    - $\\sigma_{yy}$ 样本：$\\{0.03, -0.00, 0.02, -0.01, 0.01, 0.05, -0.02, 0.00, -0.03, 0.01, 0.03, -0.00\\}$\n    - $\\sigma_{xy}$ 样本：$\\{0.01, -0.02, 0.00, 0.02, -0.01, 0.03, -0.01, 0.00, 0.02, -0.02, 0.01, -0.01\\}$\n- 案例 B（边界情况：零涨落，刚度等于玻恩项）：\n  - 体积 $V = 50\\,\\mathrm{nm}^3$\n  - 温度 $T = 600\\,\\mathrm{K}$\n  - 玻恩分量（单位 $\\mathrm{GPa}$）：$C^{\\mathrm{Born}}_{xxxx} = 80$，$C^{\\mathrm{Born}}_{yyyy} = 85$，$C^{\\mathrm{Born}}_{xxyy} = 40$，$C^{\\mathrm{Born}}_{xyxy} = 35$\n  - 应力样本（单位 $\\mathrm{GPa}$，$N = 6$）：\n    - $\\sigma_{xx}$ 样本：$\\{0.00, 0.00, 0.00, 0.00, 0.00, 0.00\\}$\n    - $\\sigma_{yy}$ 样本：$\\{0.00, 0.00, 0.00, 0.00, 0.00, 0.00\\}$\n    - $\\sigma_{xy}$ 样本：$\\{0.00, 0.00, 0.00, 0.00, 0.00, 0.00\\}$\n- 案例 C（边缘情况：小样本量且存在负相关）：\n  - 体积 $V = 200\\,\\mathrm{nm}^3$\n  - 温度 $T = 100\\,\\mathrm{K}$\n  - 玻恩分量（单位 $\\mathrm{GPa}$）：$C^{\\mathrm{Born}}_{xxxx} = 200$，$C^{\\mathrm{Born}}_{yyyy} = 210$，$C^{\\mathrm{Born}}_{xxyy} = 80$，$C^{\\mathrm{Born}}_{xyxy} = 70$\n  - 应力样本（单位 $\\mathrm{GPa}$，$N = 4$）：\n    - $\\sigma_{xx}$ 样本：$\\{0.02, 0.01, -0.02, -0.01\\}$\n    - $\\sigma_{yy}$ 样本：$\\{-0.02, -0.01, 0.02, 0.01\\}$\n    - $\\sigma_{xy}$ 样本：$\\{0.00, 0.02, -0.01, 0.01\\}$\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个由三个列表组成的逗号分隔列表。每个内部列表包含相应测试用例的四个四舍五入后的刚度分量，顺序为 $[C_{11}, C_{22}, C_{12}, C_{66}]$。例如：$[[c_{11}^{(A)}, c_{22}^{(A)}, c_{12}^{(A)}, c_{66}^{(A)}],[c_{11}^{(B)}, c_{22}^{(B)}, c_{12}^{(B)}, c_{66}^{(B)}],[c_{11}^{(C)}, c_{22}^{(C)}, c_{12}^{(C)}, c_{66}^{(C)}]]$。所有刚度均以 $\\mathrm{GPa}$ 为单位表示，并四舍五入到三位小数。",
            "solution": "目标是使用在固定均匀应变 $\\epsilon$ 下进行正则系综模拟所得的数据，推导并实现一个用于二维弹性刚度张量分量 $C_{ijkl}$ 的估计量。推导必须从所提供的统计力学基本原理开始。\n\n弹性刚度张量定义为亥姆霍兹自由能 $F$ 对应变的二阶导数，并由系统体积 $V$ 归一化：\n$$\nC_{ijkl} = \\frac{1}{V} \\frac{\\partial^2 F}{\\partial \\epsilon_{ij} \\partial \\epsilon_{kl}}\n$$\n亥姆霍兹自由能由 $F = -k_{\\mathrm{B}} T \\ln Z$ 给出，其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是绝对温度，$Z$ 是固定应变 $\\epsilon$ 下的正则配分函数。配分函数是对所有微观自由度 $\\mathbf{q}$ 的积分：\n$$\nZ(\\epsilon) = \\int \\exp(-\\beta \\mathcal{H}(\\mathbf{q}, \\epsilon)) \\, d\\mathbf{q}\n$$\n这里，$\\beta = 1/(k_{\\mathrm{B}} T)$，$\\mathcal{H}$ 是系统的哈密顿量，它显式地依赖于所施加的应变。\n\n我们通过对 $F$ 求导来继续。对应变分量 $\\epsilon_{ij}$ 的一阶导数是：\n$$\n\\frac{\\partial F}{\\partial \\epsilon_{ij}} = -k_{\\mathrm{B}} T \\frac{1}{Z} \\frac{\\partial Z}{\\partial \\epsilon_{ij}}\n$$\n配分函数的导数是：\n$$\n\\frac{\\partial Z}{\\partial \\epsilon_{ij}} = \\int \\left(-\\beta \\frac{\\partial \\mathcal{H}}{\\partial \\epsilon_{ij}}\\right) \\exp(-\\beta \\mathcal{H}) \\, d\\mathbf{q}\n$$\n将此代回并使用 $\\beta = 1/(k_{\\mathrm{B}} T)$，我们得到：\n$$\n\\frac{\\partial F}{\\partial \\epsilon_{ij}} = (-k_{\\mathrm{B}} T) \\frac{1}{Z} \\int \\left(-\\frac{1}{k_{\\mathrm{B}} T} \\frac{\\partial \\mathcal{H}}{\\partial \\epsilon_{ij}}\\right) \\exp(-\\beta \\mathcal{H}) \\, d\\mathbf{q} = \\frac{\\int \\frac{\\partial \\mathcal{H}}{\\partial \\epsilon_{ij}} \\exp(-\\beta \\mathcal{H}) \\, d\\mathbf{q}}{\\int \\exp(-\\beta \\mathcal{H}) \\, d\\mathbf{q}}\n$$\n此表达式是物理量 $\\frac{\\partial \\mathcal{H}}{\\partial \\epsilon_{ij}}$ 的正则系综平均的定义。用 $\\langle \\cdot \\rangle$ 表示系综平均：\n$$\n\\frac{\\partial F}{\\partial \\epsilon_{ij}} = \\left\\langle \\frac{\\partial \\mathcal{H}}{\\partial \\epsilon_{ij}} \\right\\rangle\n$$\n根据问题陈述，热力学应力 $\\sigma_{ij}$ 通过其与应变的共轭关系定义：$V \\sigma_{ij} = \\frac{\\partial \\mathcal{H}}{\\partial \\epsilon_{ij}}$。因此，自由能的一阶导数与平均应力有关：\n$$\n\\frac{\\partial F}{\\partial \\epsilon_{ij}} = \\langle V \\sigma_{ij} \\rangle = V \\langle \\sigma_{ij} \\rangle\n$$\n\n接下来，我们计算对另一个应变分量 $\\epsilon_{kl}$ 的二阶导数：\n$$\n\\frac{\\partial^2 F}{\\partial \\epsilon_{kl} \\partial \\epsilon_{ij}} = \\frac{\\partial}{\\partial \\epsilon_{kl}} \\left\\langle \\frac{\\partial \\mathcal{H}}{\\partial \\epsilon_{ij}} \\right\\rangle = \\frac{\\partial}{\\partial \\epsilon_{kl}} \\left( \\frac{\\int \\frac{\\partial \\mathcal{H}}{\\partial \\epsilon_{ij}} e^{-\\beta \\mathcal{H}} d\\mathbf{q}}{Z} \\right)\n$$\n应用微分的商法则得到：\n$$\n\\frac{\\partial^2 F}{\\partial \\epsilon_{kl} \\partial \\epsilon_{ij}} = \\frac{1}{Z} \\frac{\\partial}{\\partial \\epsilon_{kl}}\\left(\\int \\frac{\\partial \\mathcal{H}}{\\partial \\epsilon_{ij}} e^{-\\beta \\mathcal{H}} d\\mathbf{q}\\right) - \\frac{1}{Z^2} \\left(\\int \\frac{\\partial \\mathcal{H}}{\\partial \\epsilon_{ij}} e^{-\\beta \\mathcal{H}} d\\mathbf{q}\\right) \\frac{\\partial Z}{\\partial \\epsilon_{kl}}\n$$\n积分的导数是：\n$$\n\\frac{\\partial}{\\partial \\epsilon_{kl}}\\left(\\int \\frac{\\partial \\mathcal{H}}{\\partial \\epsilon_{ij}} e^{-\\beta \\mathcal{H}} d\\mathbf{q}\\right) = \\int \\left( \\frac{\\partial^2 \\mathcal{H}}{\\partial \\epsilon_{kl} \\partial \\epsilon_{ij}} - \\beta \\frac{\\partial \\mathcal{H}}{\\partial \\epsilon_{kl}} \\frac{\\partial \\mathcal{H}}{\\partial \\epsilon_{ij}} \\right) e^{-\\beta \\mathcal{H}} d\\mathbf{q}\n$$\n并且，如前所示，$\\frac{\\partial Z}{\\partial \\epsilon_{kl}} = -\\beta \\int \\frac{\\partial \\mathcal{H}}{\\partial \\epsilon_{kl}} e^{-\\beta \\mathcal{H}} d\\mathbf{q}$。\n将这些代入二阶导数表达式中，并除以 $Z$ 以形成系综平均，我们发现：\n$$\n\\frac{\\partial^2 F}{\\partial \\epsilon_{kl} \\partial \\epsilon_{ij}} = \\left\\langle \\frac{\\partial^2 \\mathcal{H}}{\\partial \\epsilon_{kl} \\partial \\epsilon_{ij}} \\right\\rangle - \\beta \\left\\langle \\frac{\\partial \\mathcal{H}}{\\partial \\epsilon_{kl}} \\frac{\\partial \\mathcal{H}}{\\partial \\epsilon_{ij}} \\right\\rangle - \\left\\langle \\frac{\\partial \\mathcal{H}}{\\partial \\epsilon_{ij}} \\right\\rangle \\left( -\\beta \\left\\langle \\frac{\\partial \\mathcal{H}}{\\partial \\epsilon_{kl}} \\right\\rangle \\right)\n$$\n整理各项得到：\n$$\n\\frac{\\partial^2 F}{\\partial \\epsilon_{kl} \\partial \\epsilon_{ij}} = \\left\\langle \\frac{\\partial^2 \\mathcal{H}}{\\partial \\epsilon_{kl} \\partial \\epsilon_{ij}} \\right\\rangle - \\beta \\left( \\left\\langle \\frac{\\partial \\mathcal{H}}{\\partial \\epsilon_{ij}} \\frac{\\partial \\mathcal{H}}{\\partial \\epsilon_{kl}} \\right\\rangle - \\left\\langle \\frac{\\partial \\mathcal{H}}{\\partial \\epsilon_{ij}} \\right\\rangle \\left\\langle \\frac{\\partial \\mathcal{H}}{\\partial \\epsilon_{kl}} \\right\\rangle \\right)\n$$\n现在，我们将应力的定义 $V \\sigma_{ij} = \\frac{\\partial \\mathcal{H}}{\\partial \\epsilon_{ij}}$ 代入此方程：\n$$\n\\frac{\\partial^2 F}{\\partial \\epsilon_{kl} \\partial \\epsilon_{ij}} = \\left\\langle \\frac{\\partial^2 \\mathcal{H}}{\\partial \\epsilon_{kl} \\partial \\epsilon_{ij}} \\right\\rangle - \\beta \\left( \\langle (V\\sigma_{ij}) (V\\sigma_{kl}) \\rangle - \\langle V\\sigma_{ij} \\rangle \\langle V\\sigma_{kl} \\rangle \\right)\n$$\n括号中的表达式是涨落量 $V\\sigma_{ij}$ 和 $V\\sigma_{kl}$ 的协方差，等于 $V^2 \\text{Cov}(\\sigma_{ij}, \\sigma_{kl})$。\n最后，我们将其代入刚度张量的定义 $C_{ijkl} = \\frac{1}{V} \\frac{\\partial^2 F}{\\partial \\epsilon_{ij} \\partial \\epsilon_{kl}}$：\n$$\nC_{ijkl} = \\frac{1}{V} \\left\\langle \\frac{\\partial^2 \\mathcal{H}}{\\partial \\epsilon_{ij} \\partial \\epsilon_{kl}} \\right\\rangle - \\frac{\\beta}{V} V^2 \\text{Cov}(\\sigma_{ij}, \\sigma_{kl})\n$$\n第一项是哈密顿量二阶导数的系综平均值，这被称为对刚度的玻恩（Born）贡献。问题中将其作为时间平均量 $C^{\\mathrm{Born}}_{ijkl}$ 提供。第二项代表了应力涨落的贡献。简化后，我们得到中心公式：\n$$\nC_{ijkl} = C^{\\mathrm{Born}}_{ijkl} - \\frac{V}{k_{\\mathrm{B}} T} \\text{Cov}(\\sigma_{ij}, \\sigma_{kl})\n$$\n对于一个包含 $N$ 个步骤的有限模拟，真实的协方差通过无偏样本协方差来估计，即除以 $N-1$：\n$$\n\\text{Cov}(\\sigma_{ij}, \\sigma_{kl}) \\approx \\frac{1}{N-1} \\sum_{s=1}^{N} (\\sigma_{ij}^{(s)} - \\bar{\\sigma}_{ij})(\\sigma_{kl}^{(s)} - \\bar{\\sigma}_{kl})\n$$\n其中 $\\sigma_{ij}^{(s)}$ 是样本 $s$ 处的瞬时应力，$\\bar{\\sigma}_{ij}$ 是样本平均应力。\n\n所需的刚度分量计算如下：\n- $C_{xxxx} = C^{\\mathrm{Born}}_{xxxx} - \\frac{V}{k_{\\mathrm{B}} T} \\text{Var}(\\sigma_{xx})$\n- $C_{yyyy} = C^{\\mathrm{Born}}_{yyyy} - \\frac{V}{k_{\\mathrm{B}} T} \\text{Var}(\\sigma_{yy})$\n- $C_{xxyy} = C^{\\mathrm{Born}}_{xxyy} - \\frac{V}{k_{\\mathrm{B}} T} \\text{Cov}(\\sigma_{xx}, \\sigma_{yy})$\n- $C_{xyxy} = C^{\\mathrm{Born}}_{xyxy} - \\frac{V}{k_{\\mathrm{B}} T} \\text{Var}(\\sigma_{xy})$\n\n在这些公式中使用所提供的体积 $V$、温度 $T$、玻尔兹曼常数 $k_{\\mathrm{B}}$、玻恩项 $C^{\\mathrm{Born}}_{ijkl}$ 和应力样本序列 $\\{\\sigma_{xx}\\}$、$\\{\\sigma_{yy}\\}$、$\\{\\sigma_{xy}\\}$ 的数据。计算必须使用特定值 $k_{\\mathrm{B}} = 1.380649 \\times 10^{-5}\\,\\mathrm{GPa}\\,\\mathrm{nm}^3/\\mathrm{K}$ 以确保单位一致性，从而得到以 $\\mathrm{GPa}$ 为单位的刚度。最终结果按要求四舍五入到三位小数。实现将使用 `numpy.cov` 从提供的应力数据中计算所需的无偏样本协方差。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and computes elastic stiffness components from stress fluctuation data.\n    The derivation starts from first principles of statistical mechanics for a\n    canonical ensemble at fixed strain. The final formula is:\n    C_ijkl = C_born_ijkl - (V / (k_B * T)) * Cov(sigma_ij, sigma_kl)\n    This program implements this formula for three test cases.\n    \"\"\"\n    k_B = 1.380649e-5  # GPa nm^3 / K\n\n    test_cases = [\n        {\n            \"name\": \"Case A\",\n            \"V\": 100.0,  # nm^3\n            \"T\": 300.0,  # K\n            \"born\": {\"xxxx\": 120.0, \"yyyy\": 110.0, \"xxyy\": 50.0, \"xyxy\": 45.0}, # GPa\n            \"stresses\": {\n                \"xx\": [0.02, -0.01, 0.03, -0.02, 0.00, 0.04, -0.03, 0.01, -0.02, 0.00, 0.02, -0.01],\n                \"yy\": [0.03, -0.00, 0.02, -0.01, 0.01, 0.05, -0.02, 0.00, -0.03, 0.01, 0.03, -0.00],\n                \"xy\": [0.01, -0.02, 0.00, 0.02, -0.01, 0.03, -0.01, 0.00, 0.02, -0.02, 0.01, -0.01],\n            }\n        },\n        {\n            \"name\": \"Case B\",\n            \"V\": 50.0,\n            \"T\": 600.0,\n            \"born\": {\"xxxx\": 80.0, \"yyyy\": 85.0, \"xxyy\": 40.0, \"xyxy\": 35.0},\n            \"stresses\": {\n                \"xx\": [0.00, 0.00, 0.00, 0.00, 0.00, 0.00],\n                \"yy\": [0.00, 0.00, 0.00, 0.00, 0.00, 0.00],\n                \"xy\": [0.00, 0.00, 0.00, 0.00, 0.00, 0.00],\n            }\n        },\n        {\n            \"name\": \"Case C\",\n            \"V\": 200.0,\n            \"T\": 100.0,\n            \"born\": {\"xxxx\": 200.0, \"yyyy\": 210.0, \"xxyy\": 80.0, \"xyxy\": 70.0},\n            \"stresses\": {\n                \"xx\": [0.02, 0.01, -0.02, -0.01],\n                \"yy\": [-0.02, -0.01, 0.02, 0.01],\n                \"xy\": [0.00, 0.02, -0.01, 0.01],\n            }\n        }\n    ]\n\n    all_results = []\n    for case in test_cases:\n        V = case[\"V\"]\n        T = case[\"T\"]\n        C_born = case[\"born\"]\n        stresses = case[\"stresses\"]\n\n        # Prepare stress data for covariance calculation\n        # The stress components are sigma_xx (index 0), sigma_yy (index 1), sigma_xy (index 2)\n        stress_data = np.array([\n            stresses[\"xx\"],\n            stresses[\"yy\"],\n            stresses[\"xy\"]\n        ])\n        \n        # Calculate the unbiased sample covariance matrix.\n        # np.cov with ddof=1 (default) divides by N-1.\n        # The rows of stress_data are variables, columns are observations.\n        if stress_data.shape[1]  2:\n            # For N2, unbiased covariance is undefined or zero.\n            # If N=1, variance would be 0, so fluctuation term is 0.\n            cov_matrix = np.zeros((3, 3))\n        else:\n            cov_matrix = np.cov(stress_data)\n\n        # Extract specific covariances\n        var_s_xx = cov_matrix[0, 0]\n        var_s_yy = cov_matrix[1, 1]\n        cov_s_xx_s_yy = cov_matrix[0, 1]\n        var_s_xy = cov_matrix[2, 2]\n\n        # Calculate the prefactor for the fluctuation term\n        prefactor = V / (k_B * T)\n\n        # Calculate the fluctuation contributions\n        fluct_xxxx = prefactor * var_s_xx\n        fluct_yyyy = prefactor * var_s_yy\n        fluct_xxyy = prefactor * cov_s_xx_s_yy\n        fluct_xyxy = prefactor * var_s_xy\n\n        # Calculate final stiffness components\n        # (C11, C22, C12, C66) -> (Cxxxx, Cyyyy, Cxxyy, Cxyxy)\n        C11 = C_born[\"xxxx\"] - fluct_xxxx\n        C22 = C_born[\"yyyy\"] - fluct_yyyy\n        C12 = C_born[\"xxyy\"] - fluct_xxyy\n        C66 = C_born[\"xyxy\"] - fluct_xyxy\n\n        # Round results to three decimal places\n        case_results = [\n            round(C11, 3),\n            round(C22, 3),\n            round(C12, 3),\n            round(C66, 3)\n        ]\n        all_results.append(case_results)\n\n    # Format the final output string exactly as required\n    formatted_results = []\n    for res_list in all_results:\n        # Create string for each list, e.g., \"[1.0,2.0,3.0,4.0]\"\n        formatted_list_str = f\"[{','.join(f'{val:.3f}' for val in res_list)}]\"\n        formatted_results.append(formatted_list_str)\n    \n    # Join the list strings into the final output format, e.g., \"[[...],[...],[...]]\"\n    final_output_string = f\"[{','.join(formatted_results)}]\"\n    print(final_output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "在计算科学中，得到一个数值仅仅是第一步；理解其统计可靠性同样至关重要。这项高级实践将挑战你超越简单的计算，去设计一个算法再现性的基准测试。通过分析应力自相关性如何影响弹性常数估计的方差，你将学会如何量化模拟结果的精度，并确定满足特定置信度标准所需的最短模拟时间，这是严谨科学研究中不可或缺的一环。",
            "id": "3804183",
            "problem": "考虑一个三维、单原子、面心立方固体，其通过分子动力学（MD）在粒子数、体积和温度（$NVT$）固定的正则系综中进行模拟。在温度 $T$ 和应变张量 $\\boldsymbol{\\varepsilon}$ 下，亥姆霍兹自由能 $F$ 通过在零应变下的二阶导数定义了弹性常数：$C_{ijkl} = \\frac{1}{V} \\frac{\\partial^{2} F}{\\partial \\varepsilon_{ij} \\partial \\varepsilon_{kl}}$，其中 $V$ 是系统体积。在涨落方法中，剪切弹性常数 $C_{44}$（Voigt 记法）可以表示为平衡态下微观应力涨落的函数。您将利用这一事实，结合平衡统计力学和稳态高斯过程理论的基本结果，为从 MD 轨迹估计 $C_{44}$ 设计一个算法可复现性基准。\n\n一个边长 $L = 10\\,\\mathrm{nm}$ 的立方周期性晶胞在温度 $T = 300\\,\\mathrm{K}$ 下进行模拟。系统体积为 $V = L^{3}$。从构型导数获得的剪切常数的确定性（Born）贡献为 $C_{44}^{\\mathrm{Born}} = 50.0\\,\\mathrm{GPa}$。平衡态下的瞬时微观剪切应力分量 $\\sigma_{xy}(t)$ 可以很好地建模为一个零均值、稳态高斯 Ornstein–Uhlenbeck (OU) 过程，其自协方差为 $C(t) = \\langle \\sigma_{xy}(0)\\,\\sigma_{xy}(t) \\rangle = \\sigma^{2} \\exp(-|t|/\\tau)$，其中 $\\sigma = 6.0\\,\\mathrm{MPa}$ 是剪切应力的平衡态标准差，$\\tau$ 是应力自相关时间。两个独立且经过充分验证的 MD 算法（不同的积分器-恒温器组合）产生统计上不可区分的稳态分布，但自相关时间不同：算法 $\\mathcal{A}$ 的 $\\tau_{\\mathcal{A}} = 4.0\\,\\mathrm{ps}$，算法 $\\mathcal{B}$ 的 $\\tau_{\\mathcal{B}} = 6.0\\,\\mathrm{ps}$。两种算法都以远小于 $\\tau$ 的采样间隔收集时间序列，因此连续时间极限是合适的。\n\n定义算法可复现性基准如下：在相同的物理系统上运行两种算法，总轨迹长度 $T$ 相等，从每种算法的平衡应力涨落中估计 $C_{44}$，并要求在 $95\\%$ 的置信度下，两个独立估计的 $C_{44}$ 值之间的绝对差值受容差 $\\Delta_{G} = 0.50\\,\\mathrm{GPa}$ 的限制。假设两条轨迹在统计上是独立的，并且估计量的涨落主要由 OU 过程的平衡应力涨落主导。使用玻尔兹曼常数 $k_{B} = 1.380649 \\times 10^{-23}\\,\\mathrm{J}\\,\\mathrm{K}^{-1}$。\n\n从弹性常数作为自由能导数的基本定义、正则系综的性质以及稳态高斯过程的协方差结构出发，推导满足上述基准所需的最小相等总轨迹长度 $T_{\\min}$ 的表达式。然后，使用给定的数值参数，计算 $T_{\\min}$。将您的最终结果四舍五入到三位有效数字，并以纳秒为单位表示。",
            "solution": "本题要求我们推导并计算满足特定算法可复现性基准所需的最小轨迹长度 $T_{\\min}$，该基准用于剪切弹性常数 $C_{44}$ 的估计。解题过程结合了将宏观热力学性质与微观涨落联系起来的统计力学原理，以及对相关时间序列的统计分析。\n\n等温弹性劲度常数 $C_{ijkl}$ 定义为亥姆霍兹自由能密度对应变 $\\boldsymbol{\\varepsilon}$ 在零应变下的二阶导数：\n$$C_{ijkl} = \\frac{1}{V} \\left. \\frac{\\partial^2 F}{\\partial \\varepsilon_{ij} \\partial \\varepsilon_{kl}} \\right|_{\\boldsymbol{\\varepsilon}=\\mathbf{0}}$$\n其中 $V$ 是系统体积。在正则（$NVT$）系综中，统计力学提供了一个用微观量表示的相应表达式：\n$$C_{ijkl} = \\left\\langle \\frac{1}{V} \\frac{\\partial^2 U}{\\partial \\varepsilon_{ij} \\partial \\varepsilon_{kl}} \\right\\rangle - \\frac{V}{k_B T} \\text{Cov}(\\sigma_{ij}, \\sigma_{kl})$$\n此处，$U$ 是势能，$k_B$ 是玻尔兹曼常数，$T$ 是温度，$\\sigma_{ij}$ 是瞬时微观应力张量分量。尖括号 $\\langle \\cdot \\rangle$ 表示平衡系综平均。\n\n第一项是 Born 贡献，$C_{ijkl}^{\\mathrm{Born}}$，它依赖于势能的导数。第二项是涨落贡献，它源于应力张量的热涨落。题目指出，瞬时剪切应力分量 $\\sigma_{xy}(t)$ 的均值为零，即 $\\langle \\sigma_{xy} \\rangle = 0$。对于立方晶体，Voigt 记法的剪切常数 $C_{44}$ 等价于张量分量如 $C_{xyxy}$。相关的协方差则为 $\\text{Cov}(\\sigma_{xy}, \\sigma_{xy}) = \\langle (\\sigma_{xy} - \\langle \\sigma_{xy} \\rangle)^2 \\rangle = \\langle \\sigma_{xy}^2 \\rangle$。题目给出该应力分量的标准差为 $\\sigma$，因此其方差为 $\\langle \\sigma_{xy}^2 \\rangle = \\sigma^2$。\n\n因此，弹性常数的精确值为：\n$$C_{44} = C_{44}^{\\mathrm{Born}} - \\frac{V \\sigma^2}{k_B T}$$\n在持续时间为 $T_{\\text{traj}}$ 的分子动力学模拟中，系综平均 $\\sigma^2$ 通过时间平均来估计：\n$$\\hat{\\sigma}^2 = \\frac{1}{T_{\\text{traj}}} \\int_0^{T_{\\text{traj}}} \\sigma_{xy}^2(t) dt$$\n这导出了弹性常数的估计量 $\\hat{C}_{44}$：\n$$\\hat{C}_{44} = C_{44}^{\\mathrm{Born}} - \\frac{V}{k_B T} \\hat{\\sigma}^2$$\nBorn 项 $C_{44}^{\\mathrm{Born}}$ 作为确定性值给出。因此，估计量 $\\hat{C}_{44}$ 的统计不确定性完全来自估计量 $\\hat{\\sigma}^2$ 的统计不确定性。弹性常数估计量的方差为：\n$$\\text{Var}(\\hat{C}_{44}) = \\text{Var}\\left( C_{44}^{\\mathrm{Born}} - \\frac{V}{k_B T} \\hat{\\sigma}^2 \\right) = \\left(\\frac{V}{k_B T}\\right)^2 \\text{Var}(\\hat{\\sigma}^2)$$\n为了求得 $\\text{Var}(\\hat{\\sigma}^2)$，我们分析应力平方 $\\sigma_{xy}^2(t)$ 的时间平均值。应力 $\\sigma_{xy}(t)$ 被建模为一个零均值稳态高斯 Ornstein-Uhlenbeck 过程。对于此类过程，根据 Isserlis 定理，平方过程的协方差为：\n$$\\text{Cov}(\\sigma_{xy}^2(t_1), \\sigma_{xy}^2(t_2)) = 2 \\left( \\langle \\sigma_{xy}(t_1) \\sigma_{xy}(t_2) \\rangle \\right)^2$$\n自协方差函数为 $C(t) = \\langle \\sigma_{xy}(0)\\,\\sigma_{xy}(t) \\rangle = \\sigma^2 \\exp(-|t|/\\tau)$。因此：\n$$\\text{Cov}(\\sigma_{xy}^2(t_1), \\sigma_{xy}^2(t_2)) = 2 \\left( \\sigma^2 \\exp(-|t_1-t_2|/\\tau) \\right)^2 = 2 \\sigma^4 \\exp(-2|t_1-t_2|/\\tau)$$\n对于远长于相关时间 $\\tau$ 的总轨迹长度 $T_{\\text{traj}}$，时间平均 $\\hat{\\sigma}^2$ 的方差可以近似为：\n$$\\text{Var}(\\hat{\\sigma}^2) \\approx \\frac{2}{T_{\\text{traj}}} \\int_{0}^{\\infty} \\text{Cov}(\\sigma_{xy}^2(0), \\sigma_{xy}^2(t)) dt = \\frac{2}{T_{\\text{traj}}} \\int_{0}^{\\infty} 2\\sigma^4 \\exp(-2t/\\tau) dt$$\n$$\\text{Var}(\\hat{\\sigma}^2) = \\frac{4\\sigma^4}{T_{\\text{traj}}} \\int_{0}^{\\infty} \\exp(-2t/\\tau) dt = \\frac{4\\sigma^4}{T_{\\text{traj}}} \\left[ -\\frac{\\tau}{2} \\exp(-2t/\\tau) \\right]_{0}^{\\infty} = \\frac{4\\sigma^4}{T_{\\text{traj}}} \\left( \\frac{\\tau}{2} \\right) = \\frac{2\\sigma^4 \\tau}{T_{\\text{traj}}}$$\n这个标准结果的一个更严谨的推导涉及高斯过程样本方差的方差，$\\text{Var}(\\hat{\\sigma}^2) = \\frac{2\\sigma^4}{N_{\\text{eff}}}$，其中 $N_{\\text{eff}} = T_{\\text{traj}}/(2\\tau_{Y,\\text{int}})$ 是有效独立样本数。对于 $Y(t)=\\sigma_{xy}^2(t)$，其积分自相关时间 $\\tau_{Y,\\text{int}}=\\tau/2$。这得出 $\\text{Var}(\\hat{\\sigma}^2) = \\frac{4\\sigma^4\\tau_{Y,\\text{int}}}{T_{\\text{traj}}} = \\frac{2\\sigma^4\\tau}{T_{\\text{traj}}}$。\n\n将此代入 $\\hat{C}_{44}$ 的方差表达式中：\n$$\\text{Var}(\\hat{C}_{44}) = \\left(\\frac{V}{k_B T}\\right)^2 \\left( \\frac{2\\sigma^4 \\tau}{T_{\\text{traj}}} \\right) = \\frac{2 V^2 \\sigma^4 \\tau}{(k_B T)^2 T_{\\text{traj}}}$$\n该基准比较了来自两个独立算法 $\\mathcal{A}$ 和 $\\mathcal{B}$ 的估计值，它们具有不同的自相关时间 $\\tau_{\\mathcal{A}}$ 和 $\\tau_{\\mathcal{B}}$，并以相同的长度 $T_{\\text{traj}}$ 运行。令 $D = \\hat{C}_{44}^{\\mathcal{A}} - \\hat{C}_{44}^{\\mathcal{B}}$。由于轨迹是独立的，差值的方差是方差之和：\n$$\\text{Var}(D) = \\text{Var}(\\hat{C}_{44}^{\\mathcal{A}}) + \\text{Var}(\\hat{C}_{44}^{\\mathcal{B}}) = \\frac{2 V^2 \\sigma^4 \\tau_{\\mathcal{A}}}{(k_B T)^2 T_{\\text{traj}}} + \\frac{2 V^2 \\sigma^4 \\tau_{\\mathcal{B}}}{(k_B T)^2 T_{\\text{traj}}}$$\n$$\\text{Var}(D) = \\frac{2 V^2 \\sigma^4 (\\tau_{\\mathcal{A}} + \\tau_{\\mathcal{B}})}{(k_B T)^2 T_{\\text{traj}}}$$\n对于长的 $T_{\\text{traj}}$，根据相关过程的中心极限定理，$\\hat{C}_{44}$ 的分布近似为正态分布。差值 $D$ 也服从正态分布。由于估计量是无偏的（$E[\\hat{C}_{44}]=C_{44}$），差值的均值为零，$E[D]=0$。\n基准要求 $P(|D| \\le \\Delta_G) = 0.95$。对于一个正态分布 $N(0, \\text{Var}(D))$，这等价于：\n$$\\frac{\\Delta_G}{\\sqrt{\\text{Var}(D)}} \\ge z_{0.975}$$\n其中 $z_{0.975}$ 是对于 $95\\%$ 的双尾置信水平，标准正态分布的临界值；$z_{0.975} \\approx 1.96$。通过取等式可以找到最小轨迹长度 $T_{\\min}$：\n$$\\Delta_G^2 = z_{0.975}^2 \\text{Var}(D) = z_{0.975}^2 \\frac{2 V^2 \\sigma^4 (\\tau_{\\mathcal{A}} + \\tau_{\\mathcal{B}})}{(k_B T)^2 T_{\\min}}$$\n求解 $T_{\\min}$ 得到所需的解析表达式：\n$$T_{\\min} = \\frac{2 z_{0.975}^2 V^2 \\sigma^4 (\\tau_{\\mathcal{A}} + \\tau_{\\mathcal{B}})}{(k_B T)^2 \\Delta_G^2}$$\n现在，我们将给定的数值以国际单位制（SI）代入：\n- $z_{0.975} \\approx 1.96$\n- $V = L^3 = (10 \\times 10^{-9}\\,\\mathrm{m})^3 = 10^{-24}\\,\\mathrm{m}^3$\n- $\\sigma = 6.0\\,\\mathrm{MPa} = 6.0 \\times 10^6\\,\\mathrm{Pa}$\n- $\\tau_{\\mathcal{A}} = 4.0\\,\\mathrm{ps} = 4.0 \\times 10^{-12}\\,\\mathrm{s}$\n- $\\tau_{\\mathcal{B}} = 6.0\\,\\mathrm{ps} = 6.0 \\times 10^{-12}\\,\\mathrm{s}$，所以 $\\tau_{\\mathcal{A}} + \\tau_{\\mathcal{B}} = 1.0 \\times 10^{-11}\\,\\mathrm{s}$\n- $k_B = 1.380649 \\times 10^{-23}\\,\\mathrm{J}\\,\\mathrm{K}^{-1}$\n- $T = 300\\,\\mathrm{K}$，所以 $k_B T = (1.380649 \\times 10^{-23})(300) \\approx 4.141947 \\times 10^{-21}\\,\\mathrm{J}$\n- $\\Delta_G = 0.50\\,\\mathrm{GPa} = 0.50 \\times 10^9\\,\\mathrm{Pa}$\n\n让我们计算分子：\n$2 z_{0.975}^2 V^2 \\sigma^4 (\\tau_{\\mathcal{A}} + \\tau_{\\mathcal{B}}) = 2 \\cdot (1.96)^2 \\cdot (10^{-24}\\,\\mathrm{m}^3)^2 \\cdot (6.0 \\times 10^6\\,\\mathrm{Pa})^4 \\cdot (1.0 \\times 10^{-11}\\,\\mathrm{s})$\n$= 2 \\cdot 3.8416 \\cdot 10^{-48}\\,\\mathrm{m^6} \\cdot (1.296 \\times 10^{27}\\,\\mathrm{Pa^4}) \\cdot 10^{-11}\\,\\mathrm{s}$\n$\\approx 9.9535 \\times 10^{-32}\\,\\mathrm{m^6 \\cdot Pa^4 \\cdot s}$\n\n以及分母：\n$(k_B T)^2 \\Delta_G^2 = (4.141947 \\times 10^{-21}\\,\\mathrm{J})^2 \\cdot (0.50 \\times 10^9\\,\\mathrm{Pa})^2$\n$\\approx (1.71557 \\times 10^{-41}\\,\\mathrm{J^2}) \\cdot (0.25 \\times 10^{18}\\,\\mathrm{Pa^2})$\n$\\approx 4.2889 \\times 10^{-24}\\,\\mathrm{J^2 \\cdot Pa^2}$\n\n使用关系式 $\\mathrm{Pa} = \\mathrm{J/m^3}$，分母的单位是 $\\mathrm{J^2 \\cdot (J/m^3)^2} = \\mathrm{J^4 / m^6}$，分子的单位是 $\\mathrm{m^6 \\cdot (J/m^3)^4 \\cdot s} = \\mathrm{J^4 \\cdot m^{-6} \\cdot s}$。该比值的单位为秒，符合要求。\n\n最后，我们计算 $T_{\\min}$：\n$$T_{\\min} = \\frac{9.9535 \\times 10^{-32}\\,\\mathrm{J^4 \\cdot m^{-6} \\cdot s}}{4.2889 \\times 10^{-24}\\,\\mathrm{J^4 \\cdot m^{-6}}} \\approx 2.3207 \\times 10^{-8}\\,\\mathrm{s}$$\n题目要求答案以纳秒（$1\\,\\mathrm{ns} = 10^{-9}\\,\\mathrm{s}$）为单位，并四舍五入到三位有效数字：\n$$T_{\\min} \\approx 23.207\\,\\mathrm{ns} \\approx 23.2\\,\\mathrm{ns}$$",
            "answer": "$$\n\\boxed{23.2}\n$$"
        }
    ]
}