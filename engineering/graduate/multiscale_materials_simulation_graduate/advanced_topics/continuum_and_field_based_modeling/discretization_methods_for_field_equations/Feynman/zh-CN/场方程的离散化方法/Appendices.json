{
    "hands_on_practices": [
        {
            "introduction": "将连续的偏微分方程转化为离散的代数方程组，是进行数值模拟的第一步。本练习将从基本原理出发，阐述如何实现这一转化。我们将以泊松方程（物理和工程领域的一个基石方程）为例，通过泰勒级数展开，推导出有限差分格式，这包括内部节点的标准格式以及如何利用“虚拟点”技术来精确处理诺伊曼边界条件 。",
            "id": "3802275",
            "problem": "在多尺度材料模拟中，诸如静电势或化学势等粗粒化场在介观尺度上通常由二维（$2$D）泊松偏微分方程（PDE）控制，其中场变量 $u(x,y)$ 在矩形域上满足 $\\Delta u = f(x,y)$。考虑矩形域 $\\Omega = [0,L_x] \\times [0,L_y]$，其上定义了均匀张量积网格，由 $x_i = (i-1)h_x$（$i \\in \\{1,\\dots,N_x\\}$）和 $y_j = (j-1)h_y$（$j \\in \\{1,\\dots,N_y\\}$）定义，其中 $h_x = L_x/(N_x-1)$ 且 $h_y = L_y/(N_y-1)$。令 $u_{i,j}$ 表示 $u(x_i,y_j)$ 的离散近似值。假设边界条件如下：在 $x=L_x$、$y=0$ 和 $y=L_y$ 上为狄利克雷（Dirichlet）数据 $u = u_D$，在边界 $x=0$ 上为诺伊曼（Neumann）通量 $\\partial u/\\partial x = g(y)$。令 $g_j \\equiv g(y_j)$。\n\n从泰勒展开出发作为基本基础，构建此网格上拉普拉斯算子的二阶精确有限差分格式。你的任务是：\n\n(1) 推导内部网格点 $(i,j)$ 处的二阶精确离散拉普拉斯算子，其中 $i \\in \\{2,\\dots,N_x-1\\}$ 且 $j \\in \\{2,\\dots,N_y-1\\}$。\n\n(2) 使用位于 $i=0$ 的虚拟点来施加 $x=0$ 处的诺伊曼边界条件，以获得二阶精确的边界处理。消去虚拟点的值，得到一个以边界对齐节点 $(i,j)=(1,j)$（其中 $j \\in \\{2,\\dots,N_y-1\\}$）为中心的拉普拉斯算子的离散表达式，该表达式仅用 $u_{1,j}$、$u_{2,j}$、$u_{1,j\\pm 1}$、$h_x$、$h_y$ 和 $g_j$ 表示。\n\n为清晰和明确的评估，请将你的推导最终结果以单个行向量的形式报告，向量的元素为两个解析表达式，顺序为：首先是内部节点的离散拉普拉斯算子，然后是通过虚拟点消除法施加诺伊曼条件的边界节点的离散拉普拉斯算子。不需要进行数值计算，也不需要单位。最终答案必须按规定以单个解析行向量的形式给出。",
            "solution": "问题陈述已经过验证，是合理的。这是一个数值分析中的适定问题，要求推导拉普拉斯算子的有限差分模板。推导将基于基本的泰勒级数展开进行。\n\n二维拉普拉斯算子由 $\\Delta u = \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2}$ 给出。我们的任务是推导其在内部网格点和带有诺伊曼条件的边界网格点上的离散近似。\n\n**(1) 内部网格点的离散化**\n\n设内部网格点为 $(x_i, y_j)$，其中 $i \\in \\{2,\\dots,N_x-1\\}$ 且 $j \\in \\{2,\\dots,N_y-1\\}$。我们从 $\\frac{\\partial^2 u}{\\partial x^2}$ 开始，推导二阶偏导数的二阶精确中心差分近似。\n\n$u(x,y)$ 在点 $(x_i, y_j)$ 沿 $x$ 方向的泰勒级数展开为：\n$$u(x_i+h_x, y_j) = u(x_i, y_j) + h_x \\frac{\\partial u}{\\partial x} + \\frac{h_x^2}{2!} \\frac{\\partial^2 u}{\\partial x^2} + \\frac{h_x^3}{3!} \\frac{\\partial^3 u}{\\partial x^3} + \\frac{h_x^4}{4!} \\frac{\\partial^4 u}{\\partial x^4} + O(h_x^5)$$\n$$u(x_i-h_x, y_j) = u(x_i, y_j) - h_x \\frac{\\partial u}{\\partial x} + \\frac{h_x^2}{2!} \\frac{\\partial^2 u}{\\partial x^2} - \\frac{h_x^3}{3!} \\frac{\\partial^3 u}{\\partial x^3} + \\frac{h_x^4}{4!} \\frac{\\partial^4 u}{\\partial x^4} - O(h_x^5)$$\n其中所有导数均在点 $(x_i, y_j)$ 处求值。\n\n将这两个展开式相加，可以消去奇数阶导数项：\n$$u(x_i+h_x, y_j) + u(x_i-h_x, y_j) = 2u(x_i, y_j) + h_x^2 \\frac{\\partial^2 u}{\\partial x^2} + \\frac{h_x^4}{12} \\frac{\\partial^4 u}{\\partial x^4} + O(h_x^6)$$\n\n求解 $\\frac{\\partial^2 u}{\\partial x^2}$：\n$$\\frac{\\partial^2 u}{\\partial x^2} = \\frac{u(x_i+h_x, y_j) - 2u(x_i, y_j) + u(x_i-h_x, y_j)}{h_x^2} - \\frac{h_x^2}{12} \\frac{\\partial^4 u}{\\partial x^4} - O(h_x^4)$$\n使用离散记法 $u_{i,j} \\equiv u(x_i,y_j)$，二阶精确的中心差分近似为：\n$$\\frac{\\partial^2 u}{\\partial x^2}\\bigg|_{(i,j)} \\approx \\frac{u_{i+1,j} - 2u_{i,j} + u_{i-1,j}}{h_x^2}$$\n该近似的截断误差为 $O(h_x^2)$。\n\n通过对 $y$ 方向进行相同的论证，我们得到：\n$$\\frac{\\partial^2 u}{\\partial y^2}\\bigg|_{(i,j)} \\approx \\frac{u_{i,j+1} - 2u_{i,j} + u_{i,j-1}}{h_y^2}$$\n截断误差为 $O(h_y^2)$。\n\n内部点 $(i,j)$ 处的离散拉普拉斯算子是这两个表达式的和：\n$$(\\Delta u)_{i,j} \\approx \\frac{u_{i+1,j} - 2u_{i,j} + u_{i-1,j}}{h_x^2} + \\frac{u_{i,j+1} - 2u_{i,j} + u_{i,j-1}}{h_y^2}$$\n该表达式可以重新整理，按空间位置对各项进行分组：\n$$(\\Delta u)_{i,j} \\approx \\frac{u_{i+1,j} + u_{i-1,j}}{h_x^2} + \\frac{u_{i,j+1} + u_{i,j-1}}{h_y^2} - 2\\left(\\frac{1}{h_x^2} + \\frac{1}{h_y^2}\\right)u_{i,j}$$\n这是第一个所需的表达式。\n\n**(2) 带有诺伊曼条件的边界离散化**\n\n我们现在考虑左边界上的一个点 $(x_1, y_j)$，其中 $x_1=0$ 且 $j \\in \\{2,\\dots,N_y-1\\}$。诺伊曼边界条件为 $\\frac{\\partial u}{\\partial x}|_{x=0} = g(y)$。\n\n$(1,j)$ 处拉普拉斯算子的标准五点模板为：\n$$(\\Delta u)_{1,j} \\approx \\frac{u_{2,j} - 2u_{1,j} + u_{0,j}}{h_x^2} + \\frac{u_{1,j+1} - 2u_{1,j} + u_{1,j-1}}{h_y^2}$$\n该表达式涉及节点 $u_{0,j}$，它对应于点 $(x_0, y_j) = (-h_x, y_j)$，位于域 $\\Omega$ 之外。这是一个“虚拟点”。为了保持二阶精度，我们必须使用诺伊曼条件的二阶精确近似来消去 $u_{0,j}$。\n\n我们构造一个以边界点 $(x_1, y_j)$ 为中心的一阶导数 $\\frac{\\partial u}{\\partial x}$ 的二阶精确中心差分。将 $u(x_1-h_x, y_j)$ 的泰勒展开式从 $u(x_1+h_x, y_j)$ 的泰勒展开式中减去：\n$$u(x_1+h_x, y_j) - u(x_1-h_x, y_j) = 2h_x \\frac{\\partial u}{\\partial x} + \\frac{h_x^3}{3} \\frac{\\partial^3 u}{\\partial x^3} + O(h_x^5)$$\n求解在 $(x_1, y_j)$ 处的 $\\frac{\\partial u}{\\partial x}$：\n$$\\frac{\\partial u}{\\partial x} = \\frac{u(x_1+h_x, y_j) - u(x_1-h_x, y_j)}{2h_x} - \\frac{h_x^2}{6} \\frac{\\partial^3 u}{\\partial x^3} - O(h_x^4)$$\n离散近似为：\n$$\\frac{\\partial u}{\\partial x}\\bigg|_{(1,j)} \\approx \\frac{u_{2,j} - u_{0,j}}{2h_x}$$\n该近似是二阶精确的，截断误差为 $O(h_x^2)$。\n\n应用诺伊曼边界条件，$g_j \\equiv g(y_j)$：\n$$\\frac{u_{2,j} - u_{0,j}}{2h_x} = g_j$$\n我们求解虚拟点的值 $u_{0,j}$：\n$$u_{0,j} = u_{2,j} - 2h_x g_j$$\n\n现在，我们将 $u_{0,j}$ 的这个表达式代入 $(1,j)$ 处的形式离散拉普拉斯算子中：\n$$(\\Delta u)_{1,j} \\approx \\frac{u_{2,j} - 2u_{1,j} + (u_{2,j} - 2h_x g_j)}{h_x^2} + \\frac{u_{1,j+1} - 2u_{1,j} + u_{1,j-1}}{h_y^2}$$\n简化涉及 $x$ 导数的项：\n$$\\frac{2u_{2,j} - 2u_{1,j} - 2h_x g_j}{h_x^2} = \\frac{2u_{2,j}}{h_x^2} - \\frac{2u_{1,j}}{h_x^2} - \\frac{2g_j}{h_x}$$\n将其代回 $(\\Delta u)_{1,j}$ 的表达式中：\n$$(\\Delta u)_{1,j} \\approx \\left(\\frac{2u_{2,j}}{h_x^2} - \\frac{2u_{1,j}}{h_x^2} - \\frac{2g_j}{h_x}\\right) + \\left(\\frac{u_{1,j+1} - 2u_{1,j} + u_{1,j-1}}{h_y^2}\\right)$$\n最后，我们像处理内部点情况一样，根据节点值收集各项，以获得第二个所需的表达式：\n$$(\\Delta u)_{1,j} \\approx \\frac{2u_{2,j}}{h_x^2} + \\frac{u_{1,j+1} + u_{1,j-1}}{h_y^2} - 2\\left(\\frac{1}{h_x^2} + \\frac{1}{h_y^2}\\right)u_{1,j} - \\frac{2g_j}{h_x}$$\n这是诺伊曼边界节点 $(1,j)$ 处的二阶精确离散拉普拉斯算子。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{u_{i+1,j} + u_{i-1,j}}{h_x^2} + \\frac{u_{i,j+1} + u_{i,j-1}}{h_y^2} - 2\\left(\\frac{1}{h_x^2} + \\frac{1}{h_y^2}\\right)u_{i,j}  \\frac{2u_{2,j}}{h_x^2} + \\frac{u_{1,j+1} + u_{1,j-1}}{h_y^2} - 2\\left(\\frac{1}{h_x^2} + \\frac{1}{h_y^2}\\right)u_{1,j} - \\frac{2g_j}{h_x}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在掌握了基本离散化方法后，我们将探讨在求解输运方程时遇到的稳定性和精度挑战。当对流项在对流-扩散方程中占主导地位时，简单的中心差分格式可能会失效，产生非物理的数值振荡。本练习旨在通过对比稳健的迎风格式和中心差分格式，揭示数值稳定性的重要性，并引入网格佩克莱特数 ($Pe_{h}$) 来量化中心差分格式的稳定性边界 。",
            "id": "3802256",
            "problem": "考虑在多晶材料中，一个标量浓度场 $c(x)$ 沿着长度为 $L$ 的晶界段进行稳态一维输运。其中，平流由一个有效漂移速度 $a$（常数）驱动，扩散由分子扩散系数 $D$（常数）表征。其控制守恒律是通量形式的稳态平流-扩散方程，\n$$\\frac{d}{dx}\\left(-D\\,\\frac{dc}{dx} + a\\,c\\right) = 0,$$\n等效地可以写成场方程\n$$a\\,\\frac{dc}{dx} - D\\,\\frac{d^{2}c}{dx^{2}} = 0.$$\n你将需要在一个均匀网格上构建一个保守、单调的半离散有限差分格式，并通过离散极值原理评估中心差分格式的单调性。\n\n在一个间距为 $h$、内部节点为 $i=1,\\dots,N-1$ 的均匀网格 $x_{i} = i\\,h$ 上，执行以下操作：\n\n1. 从以 $x_{i}$ 为中心的控制体上的通量平衡声明出发，推导内部节点值 $\\{c_{i}\\}$ 的半离散线性系统。其中，平流通量使用与 $a$ 符号一致的一阶迎风有限差分进行近似，扩散通量使用二阶中心差分进行近似。请陈述在 $a0$ 情况下，离散算子的三对角模板系数。\n\n2. 从相同的通量平衡出发，推导内部节点值 $\\{c_{i}\\}$ 的半离散线性系统。其中，平流项 $a\\,dc/dx$ 使用二阶中心差分进行离散，扩散项 $D\\,d^{2}c/dx^{2}$ 也使用二阶中心差分进行离散。请陈述所得的三对角模板系数。\n\n3. 使用离散极值原理以及单调性的一个必要条件——线性系统矩阵为 M-矩阵（对角元素严格为正，非对角元素非正，且对于齐次内部方程行和为非负）的特性，推导当第二部分中的中心差分平流-扩散离散格式保持单调时，网格佩克莱数\n$$\\mathrm{Pe}_{h} \\equiv \\frac{|a|\\,h}{D}$$\n需满足的条件。请明确证明，对于足够大的 $\\mathrm{Pe}_{h}$，该单调性条件不成立。\n\n4. 在一个关于晶界电迁移的多尺度材料模拟中，假设有效漂移速度为 $a = 3.0 \\times 10^{-5}\\ \\mathrm{m/s}$，扩散系数为 $D = 7.0 \\times 10^{-12}\\ \\mathrm{m^{2}/s}$。根据你推导出的条件，计算使得第二部分中的中心差分格式保持单调的最大均匀网格间距 $h_{\\mathrm{crit}}$。请将 $h_{\\mathrm{crit}}$ 以微米为单位表示，并将答案四舍五入到四位有效数字。\n\n你的最终答案必须仅为以微米为单位的 $h_{\\mathrm{crit}}$ 的数值。",
            "solution": "问题陈述需要进行验证。\n\n### 步骤 1：提取已知条件\n- **控制方程（通量形式）：** $\\frac{d}{dx}\\left(-D\\,\\frac{dc}{dx} + a\\,c\\right) = 0$\n- **控制方程（场形式）：** $a\\,\\frac{dc}{dx} - D\\,\\frac{d^{2}c}{dx^{2}} = 0$\n- **变量和常数：** 标量浓度场 $c(x)$，漂移速度 $a$（常数），分子扩散系数 $D$（常数），区域长度 $L$。\n- **网格：** 均匀网格 $x_{i} = i\\,h$，间距为 $h$，内部节点为 $i=1,\\dots,N-1$。\n- **任务 1：** 从通量平衡出发，使用一阶迎风格式（$a0$）处理平流项、二阶中心格式处理扩散项，推导 $\\{c_i\\}$ 的半离散线性系统。陈述三对角模板系数。\n- **任务 2：** 从通量平衡出发，同时使用二阶中心差分处理平流项（$a\\,dc/dx$）和扩散项（$D\\,d^{2}c/dx^{2}$），推导 $\\{c_i\\}$ 的半离散线性系统。陈述三对角模板系数。\n- **任务 3：** 利用离散极值原理和 M-矩阵条件（对角元素 $ 0$，非对角元素 $\\le 0$，行和 $\\ge 0$），推导第二部分中的中心差分格式保持单调时，对网格佩克莱数 $\\mathrm{Pe}_{h} \\equiv \\frac{|a|\\,h}{D}$ 的条件。\n- **任务 4：** 对于 $a = 3.0 \\times 10^{-5}\\ \\mathrm{m/s}$ 和 $D = 7.0 \\times 10^{-12}\\ \\mathrm{m^{2}/s}$，计算使中心差分格式保持单调的临界均匀网格间距 $h_{\\mathrm{crit}}$（以微米为单位，四舍五入到四位有效数字）。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学依据：** 该问题描述了稳态一维平流-扩散方程，这是包括材料科学在内的各种STEM领域中描述输运现象的一个基本且普遍接受的模型。任务涉及将标准数值分析技术（有限差分，M-矩阵分析）应用于此方程。所提供的物理参数代表了诸如电迁移等原子输运现象。该问题是科学合理的。\n2.  **适定性：** 任务是明确定义的数学推导，以及基于推导结果的最终计算。问题结构清晰，能够导出一个唯一且有意义的解。\n3.  **客观性：** 语言精确且专业。所有术语在输运现象和数值分析领域都是标准术语。问题不含主观性。\n4.  **自洽性与一致性：** 问题提供了控制方程、要使用的离散化方法、分析框架（M-矩阵）以及所有必要的物理常数。内容没有矛盾之处。\n\n### 步骤 3：结论与行动\n问题有效。将提供完整解答。\n\n***\n\n解答过程将依次处理问题的四个部分。\n\n### 第一部分：平流项的迎风离散\n我们从守恒律在以节点 $x_i$ 为中心的控制体 $V_i = [x_{i-1/2}, x_{i+1/2}]$ 上的积分形式开始，其中 $x_{i \\pm 1/2} = x_i \\pm h/2$。通量定义为 $J(x) = -D\\,\\frac{dc}{dx} + a\\,c$。对于稳态，流出控制体的净通量为零：\n$$J(x_{i+1/2}) - J(x_{i-1/2}) = 0$$\n扩散通量项 $-D\\,dc/dx$ 在控制体界面上使用二阶中心差分进行近似：\n$$-D\\,\\frac{dc}{dx}\\bigg|_{x_{i+1/2}} \\approx -D\\,\\frac{c_{i+1} - c_i}{h}$$\n$$-D\\,\\frac{dc}{dx}\\bigg|_{x_{i-1/2}} \\approx -D\\,\\frac{c_i - c_{i-1}}{h}$$\n平流通量项 $a\\,c$ 使用一阶迎风格式进行近似。对于指定的 $a  0$ 情况，界面上的浓度取自“迎风”节点，即左侧的节点。\n$$a\\,c(x_{i+1/2}) \\approx a\\,c(x_i) = a\\,c_i$$\n$$a\\,c(x_{i-1/2}) \\approx a\\,c(x_{i-1}) = a\\,c_{i-1}$$\n因此，界面上的总通量为：\n$$J_{i+1/2} \\approx -D\\,\\frac{c_{i+1} - c_i}{h} + a\\,c_i$$\n$$J_{i-1/2} \\approx -D\\,\\frac{c_i - c_{i-1}}{h} + a\\,c_{i-1}$$\n将这些代入通量平衡方程，得到：\n$$\\left(-D\\,\\frac{c_{i+1} - c_i}{h} + a\\,c_i\\right) - \\left(-D\\,\\frac{c_i - c_{i-1}}{h} + a\\,c_{i-1}\\right) = 0$$\n为了找到模板系数，我们按 $c_{i-1}$、$c_i$ 和 $c_{i+1}$ 对各项进行分组：\n$$(-\\frac{D}{h} - a)c_{i-1} + (\\frac{2D}{h} + a)c_i - \\frac{D}{h}c_{i+1} = 0$$\n模板系数为：\n- $c_{i-1}$ 的系数：$-\\frac{D}{h} - a$\n- $c_i$ 的系数：$\\frac{2D}{h} + a$\n- $c_{i+1}$ 的系数：$-\\frac{D}{h}$\n\n### 第二部分：中心差分离散\n我们再次从通量平衡 $J(x_{i+1/2}) - J(x_{i-1/2}) = 0$ 开始。扩散通量的近似方法同前。现在，平流通量在界面上使用二阶中心平均进行近似：\n$$a\\,c(x_{i+1/2}) \\approx a\\,\\frac{c_i + c_{i+1}}{2}$$\n$$a\\,c(x_{i-1/2}) \\approx a\\,\\frac{c_{i-1} + c_i}{2}$$\n界面上的总通量为：\n$$J_{i+1/2} \\approx -D\\,\\frac{c_{i+1} - c_i}{h} + a\\,\\frac{c_i + c_{i+1}}{2}$$\n$$J_{i-1/2} \\approx -D\\,\\frac{c_i - c_{i-1}}{h} + a\\,\\frac{c_{i-1} + c_i}{2}$$\n代入通量平衡方程：\n$$\\left(-D\\,\\frac{c_{i+1} - c_i}{h} + a\\,\\frac{c_i + c_{i+1}}{2}\\right) - \\left(-D\\,\\frac{c_i - c_{i-1}}{h} + a\\,\\frac{c_{i-1} + c_i}{2}\\right) = 0$$\n按模板位置对各项进行分组：\n- $c_{i+1}$ 项：$-\\frac{D}{h}c_{i+1} + \\frac{a}{2}c_{i+1} = \\left(-\\frac{D}{h} + \\frac{a}{2}\\right)c_{i+1}$\n- $c_i$ 项：$\\frac{D}{h}c_i + \\frac{a}{2}c_i - \\left(-\\frac{D}{h}c_i + \\frac{a}{2}c_i\\right) = \\left(\\frac{D}{h} + \\frac{a}{2} + \\frac{D}{h} - \\frac{a}{2}\\right)c_i = \\frac{2D}{h}c_i$\n- $c_{i-1}$ 项：$-\\left(\\frac{D}{h}c_{i-1} + \\frac{a}{2}c_{i-1}\\right) = \\left(-\\frac{D}{h} - \\frac{a}{2}\\right)c_{i-1}$\n将这些组合起来，得到离散方程：\n$$\\left(-\\frac{D}{h} - \\frac{a}{2}\\right)c_{i-1} + \\left(\\frac{2D}{h}\\right)c_i + \\left(-\\frac{D}{h} + \\frac{a}{2}\\right)c_{i+1} = 0$$\n中心差分格式的三对角模板系数为：\n- $c_{i-1}$ 的系数：$-\\frac{D}{h} - \\frac{a}{2}$\n- $c_i$ 的系数：$\\frac{2D}{h}$\n- $c_{i+1}$ 的系数：$-\\frac{D}{h} + \\frac{a}{2}$\n\n### 第三部分：中心格式的单调性分析\n如果矩阵 $A$ 是一个 M-矩阵，那么线性系统 $A\\mathbf{c}=\\mathbf{b}$ 满足离散极值原理，且该格式被认为是单调的。一个矩阵成为 M-矩阵的必要条件是其对角元素严格为正，所有非对角元素均为非正。对于内部节点，设线性系统写作 $A_{i,i-1}c_{i-1} + A_{i,i}c_i + A_{i,i+1}c_{i+1} = 0$。根据第二部分，第 $i$ 行的矩阵元素为：\n$$A_{i,i} = \\frac{2D}{h}$$\n$$A_{i,i-1} = -\\frac{D}{h} - \\frac{a}{2}$$\n$$A_{i,i+1} = -\\frac{D}{h} + \\frac{a}{2}$$\n我们检查 M-矩阵的条件：\n1.  **正对角元素：** $A_{i,i} = \\frac{2D}{h}  0$。由于扩散系数 $D$ 和网格间距 $h$ 都是正的物理量，此条件总是满足的。\n2.  **非正非对角元素：** 我们需要 $A_{i,i-1} \\le 0$ 和 $A_{i,i+1} \\le 0$。\n    - 对于 $A_{i,i-1}$：$-\\frac{D}{h} - \\frac{a}{2} \\le 0 \\implies \\frac{D}{h} + \\frac{a}{2} \\ge 0$。\n    - 对于 $A_{i,i+1}$：$-\\frac{D}{h} + \\frac{a}{2} \\le 0 \\implies \\frac{a}{2} \\le \\frac{D}{h}$。\n    结合这两个不等式，我们必须有 $-\\frac{D}{h} \\le \\frac{a}{2} \\le \\frac{D}{h}$，这等价于 $\\left|\\frac{a}{2}\\right| \\le \\frac{D}{h}$。\n3.  **非负行和：** 内部节点的行和为 $S_i = A_{i,i-1} + A_{i,i} + A_{i,i+1}$。\n    $$S_i = \\left(-\\frac{D}{h} - \\frac{a}{2}\\right) + \\left(\\frac{2D}{h}\\right) + \\left(-\\frac{D}{h} + \\frac{a}{2}\\right) = 0$$\n    条件 $S_i \\ge 0$ 得到满足。\n\n如果非对角条件得到满足，则格式是单調的。该条件为 $|\\frac{a}{2}| \\le \\frac{D}{h}$。我们可以根据网格佩克莱数 $\\mathrm{Pe}_{h} = \\frac{|a|h}{D}$ 来重排此条件：\n$$|\\frac{a}{2}| \\le \\frac{D}{h} \\implies |a|h \\le 2D \\implies \\frac{|a|h}{D} \\le 2$$\n因此，单调性的条件是 $\\mathrm{Pe}_{h} \\le 2$。\n\n对于足够大的 $\\mathrm{Pe}_{h}$，特别是当 $\\mathrm{Pe}_{h}  2$ 时，此条件不成立。例如，如果 $a0$ 且 $\\mathrm{Pe}_{h}  2$，那么 $\\frac{ah}{D}  2$，这意味着 $\\frac{a}{2}  \\frac{D}{h}$。在这种情况下，非对角系数 $A_{i,i+1} = -\\frac{D}{h} + \\frac{a}{2}$ 变为正值，违反了 M-矩阵条件。这会导致单调性的丧失，并可能在数值解中引起非物理振荡。\n\n### 第四部分：临界网格间距计算\n我们已知物理参数：\n- 漂移速度：$a = 3.0 \\times 10^{-5}\\ \\mathrm{m/s}$\n- 扩散系数：$D = 7.0 \\times 10^{-12}\\ \\mathrm{m^{2}/s}$\n\n只要条件 $\\mathrm{Pe}_{h} \\le 2$ 得到满足，中心差分格式就保持单调。临界网格间距 $h_{\\mathrm{crit}}$ 是此条件成立的最大间距。这发生在不等式的临界点：\n$$\\mathrm{Pe}_{h} = \\frac{|a|h_{\\mathrm{crit}}}{D} = 2$$\n我们求解 $h_{\\mathrm{crit}}$：\n$$h_{\\mathrm{crit}} = \\frac{2D}{|a|}$$\n由于 $a  0$，所以 $|a| = a$。代入给定值：\n$$h_{\\mathrm{crit}} = \\frac{2 \\times (7.0 \\times 10^{-12}\\ \\mathrm{m^{2}/s})}{3.0 \\times 10^{-5}\\ \\mathrm{m/s}}$$\n$$h_{\\mathrm{crit}} = \\frac{14.0 \\times 10^{-12}}{3.0 \\times 10^{-5}}\\ \\mathrm{m} = \\frac{14}{3} \\times 10^{-7}\\ \\mathrm{m}$$\n$$h_{\\mathrm{crit}} \\approx 4.6666... \\times 10^{-7}\\ \\mathrm{m}$$\n问题要求答案以微米（$1\\ \\mu\\mathrm{m} = 10^{-6}\\ \\mathrm{m}$）为单位。\n$$h_{\\mathrm{crit}} = (4.6666... \\times 10^{-7}\\ \\mathrm{m}) \\times \\left(\\frac{1\\ \\mu\\mathrm{m}}{10^{-6}\\ \\mathrm{m}}\\right) = 0.46666...\\ \\mu\\mathrm{m}$$\n四舍五入到四位有效数字，我们得到：\n$$h_{\\mathrm{crit}} \\approx 0.4667\\ \\mu\\mathrm{m}$$",
            "answer": "$$\\boxed{0.4667}$$"
        },
        {
            "introduction": "对于包含激波或尖锐梯度的复杂流动问题，我们需要更强大的数值工具。本练习将介绍有限体积法 (FVM)，这是一种专为求解守恒律方程而设计的先进方法。我们将重点关注 Godunov 方法，该方法通过在网格单元界面上求解局部的黎曼问题 (Riemann problem) 来构造数值通量，从而确保计算格式能够稳健地捕捉不连续性，并得到符合物理规律的解 。",
            "id": "3802293",
            "problem": "考虑一维空间中的标量守恒律，其形式为\n$$\n\\partial_t u(x,t) + \\partial_x f(u(x,t)) = 0,\n$$\n其中 $u(x,t)$ 是一个标量守恒场，$f(u)$ 是一个光滑通量函数。在格心有限体积法（Finite Volume Method (FVM)）中，区域被划分为多个单元，这些单元的平均值通过单元交界面上的数值通量进行时间推进，这些数值通量与局部守恒和 Rankine–Hugoniot 条件一致。假设采用分段常数重构，使得在每个时间步长内，每个界面上 $u$ 的左右单侧极限都是常数状态 $u_L$ 和 $u_R$。Godunov 型数值通量通过在界面处求解局部黎曼问题的精确自相似解来选择单元间通量。\n\n您的任务是：\n- 从守恒的积分形式和弱解的定义出发，根据在 $x/t = 0$ 处求值的黎曼问题解来构建界面通量。解释为什么精确黎曼求解器能够确定界面处满足熵条件的状态，以及这如何为具有凸函数 $f$ 的标量方程导出一个一致的、单调的通量。\n- 基于此原理设计一个算法，用于计算通用可微凸函数 $f$ 的 Godunov 数值通量：给定 $u_L$ 和 $u_R$，在 $x/t=0$ 处的界面状态是两个给定状态之一，或是由与稀疏波相关的特征条件或与间断相关的激波速度决定的状态 $u_\\star$，并且数值通量等于 $f(u_\\star)$。\n- 实现一个程序，为以下凸通量族计算 Godunov 通量：\n  - Burgers 通量：$f(u) = \\tfrac{1}{2} u^2$，其中 $f'(u) = u$。\n  - 线性平流通量：$f(u) = c\\,u$，其中波速 $c \\in \\mathbb{R}$ 为常数，且 $f'(u) = c$。同时考虑 $c > 0$ 和 $c  0$ 的情况。\n  - 二次加线性通量：$f(u) = \\tfrac{1}{2} u^2 + u$，其中 $f'(u) = u + 1$。\n\n假设和要求：\n- 假设 $f$ 是可微且凸的，因此激波和稀疏波可根据特征速度的符号和 Rankine–Hugoniot 关系进行分类。除了弱解、Rankine–Hugoniot 跳跃和特征线的基本定义外，不要假设或使用任何其他公式。\n- 实现一个鲁棒的方法来识别稀疏波情况下的界面状态（$u_L \\le u_R$）：如果 $u_L$ 和 $u_R$ 处的特征速度符号相反，则通过在 $[u_L,u_R]$ 上使用区间法计算唯一的 $u_\\star$，使得 $f'(u_\\star) = 0$。如果 $u_L  u_R$（激波），则使用 Rankine–Hugoniot 速度 $s = \\dfrac{f(u_R) - f(u_L)}{u_R - u_L}$ 来决定界面处的迎风状态。\n- 将变量视为无量纲。所有输出必须是实数。\n\n测试套件：\n按所列顺序，为以下每种情况计算 Godunov 数值通量：\n- Burgers 通量，其中 $u_L = -1$, $u_R = 2$。\n- Burgers 通量，其中 $u_L = 2$, $u_R = -1$。\n- 线性平流通量，其中 $c = 3$, $u_L = -1$, $u_R = 2$。\n- 线性平流通量，其中 $c = -3$, $u_L = 1$, $u_R = 3$。\n- 二次加线性通量，其中 $u_L = -2$, $u_R = 0$。\n- 二次加线性通量，其中 $u_L = 1$, $u_R = -2$。\n- Burgers 通量，其中 $u_L = 1.234$, $u_R = 1.234$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个逗号分隔的浮点数列表，四舍五入到小数点后恰好六位，并用方括号括起来，例如 $[a_1,a_2,\\dots,a_n]$，其中每个 $a_i$ 是对应测试用例计算出的 Godunov 通量。",
            "solution": "该问题要求为一维标量守恒律 $\\partial_t u + \\partial_x f(u) = 0$ 构建并实现 Godunov 数值通量，前提是通量函数 $f(u)$ 是凸函数。\n\n### 第 1 步：理论构建\n\n有限体积法（FVM）的基础是守恒律的积分形式。将偏微分方程（PDE）在一个时空控制体 $\\Omega = [x_a, x_b] \\times [t^n, t^{n+1}]$ 上积分，得到：\n$$ \\int_{t^n}^{t^{n+1}} \\int_{x_a}^{x_b} \\left( \\frac{\\partial u}{\\partial t} + \\frac{\\partial f(u)}{\\partial x} \\right) dx \\, dt = 0 $$\n对向量场 $\\mathbf{V} = (f(u), u)$ 在 $(x, t)$ 平面上应用散度定理，此积分可转换为沿边界 $\\partial\\Omega$ 的线积分：\n$$ \\oint_{\\partial\\Omega} u \\, dx - f(u) \\, dt = 0 $$\n对于宽度为 $\\Delta x$ 的 FVM 单元 $C_i = [x_{i-1/2}, x_{i+1/2}]$，这变为：\n$$ \\int_{x_{i-1/2}}^{x_{i+1/2}} u(x, t^{n+1}) dx - \\int_{x_{i-1/2}}^{x_{i+1/2}} u(x, t^n) dx + \\int_{t^n}^{t^{n+1}} f(u(x_{i+1/2}, t)) dt - \\int_{t^n}^{t^{n+1}} f(u(x_{i-1/2}, t)) dt = 0 $$\n令 $U_i(t) = \\frac{1}{\\Delta x} \\int_{x_{i-1/2}}^{x_{i+1/2}} u(x, t) dx$ 为单元 $C_i$ 中 $u$ 的单元平均值。单元平均值的演化方程为：\n$$ U_i(t^{n+1}) - U_i(t^n) = -\\frac{1}{\\Delta x} \\left( \\int_{t^n}^{t^{n+1}} f(u(x_{i+1/2}, t)) dt - \\int_{t^n}^{t^{n+1}} f(u(x_{i-1/2}, t)) dt \\right) $$\nFVM 通过在单元交界面上定义数值通量来离散化该方程。令 $F_{i\\pm1/2}$ 为时间平均物理通量的近似值，$F_{i+1/2} \\approx \\frac{1}{\\Delta t} \\int_{t^n}^{t^{n+1}} f(u(x_{i+1/2}, t)) dt$，其中 $\\Delta t = t^{n+1} - t^n$。更新格式为：\n$$ U_i^{n+1} = U_i^n - \\frac{\\Delta t}{\\Delta x} \\left( F_{i+1/2} - F_{i-1/2} \\right) $$\nGodunov 方法通过在界面 $x_{i+1/2}$ 处求解一个局部黎曼问题来定义数值通量 $F_{i+1/2}$。使用分段常数重构，时间 $t^n$ 的状态被近似为 $u(x, t^n) = U_i^n$ (对于 $x \\in C_i$）。在界面 $x_{i+1/2}$ 处，这构成了一个具有以下初始数据的黎曼问题：\n$$ u(x, t^n) = \\begin{cases} u_L = U_i^n  \\text{for } x  x_{i+1/2} \\\\ u_R = U_{i+1}^n  \\text{for } x  x_{i+1/2} \\end{cases} $$\n此黎曼问题的解，记为 $u_{RP}(x,t)$，是自相似的，意味着它是射线 $\\xi = (x - x_{i+1/2}) / (t - t^n)$ 的函数。对于足够小的时间步长 $\\Delta t$，界面 $x_{i+1/2}$ 处的状态在时间上是恒定的，等于黎曼解沿射线 $\\xi = 0$ 的值。令此状态为 $u_\\star = u_{RP}(\\xi = 0)$。Godunov 数值通量则定义为在此界面状态下求值的物理通量：\n$$ F_G(u_L, u_R) = f(u_\\star) $$\n这种通量选择是一致的，因为如果 $u_L = u_R = u$，则 $u_\\star = u$ 且 $F_G(u, u) = f(u)$。根据其构造，它尊重局部守恒和间断的 Rankine-Hugoniot 条件。对于具有凸通量的标量守恒律，Godunov 格式是单调的（在合适的 CFL 条件下），这确保了它不会引入伪振荡，并收敛到唯一的、满足熵条件的弱解。\n\n### 第 2 步：针对凸通量的算法设计\n\n黎曼问题的解由特征速度 $a(u) = f'(u)$ 决定。由于 $f(u)$ 是凸的，$f''(u) \\ge 0$，这意味着 $a(u)$ 是 $u$ 的单调不减函数。分析根据初始状态 $u_L$ 和 $u_R$ 分为两种主要情况。\n\n**情况 1：稀疏波 ($u_L \\le u_R$)**\n如果 $u_L \\le u_R$，则特征速度 $a(u_L) = f'(u_L)$ 和 $a(u_R) = f'(u_R)$ 满足 $a(u_L) \\le a(u_R)$。特征线正在分散，导致一个称为稀疏波的连续解。解由 $u(x, t)$ 给出，使得当 $x/t$ 介于 $f'(u_L)$ 和 $f'(u_R)$ 之间时，$f'(u) = x/t$。我们需要找到界面处的状态 $u_\\star$，对应于 $x/t = 0$。\n- 如果 $f'(u_L) \\ge 0$，那么 $0 \\le f'(u_L) \\le f'(u_R)$。整个波结构向右传播（或静止）。在 $x/t = 0$ 处的状态是来自左侧的未扰动状态，因此 $u_\\star = u_L$。\n- 如果 $f'(u_R) \\le 0$，那么 $f'(u_L) \\le f'(u_R) \\le 0$。整个波结构向左传播。在 $x/t = 0$ 处的状态是来自右侧的未扰动状态，因此 $u_\\star = u_R$。\n- 如果 $f'(u_L)  0  f'(u_R)$，波是一个穿过界面的“跨音速稀疏波”。在 $x/t=0$ 处的状态 $u_\\star$ 必须满足条件 $f'(u_\\star) = 0$。由于 $f'$ 是单调的，在 $[u_L, u_R]$ 中存在一个唯一的根 $u_\\star$。这个根可以通过如二分法之类的区间套法找到。\n\n**情况 2：激波 ($u_L  u_R$)**\n如果 $u_L  u_R$，特征线正在碰撞，导致形成一个间断的激波。该激波的速度 $s$ 由 Rankine-Hugoniot 跳跃条件确定：\n$$ s = \\frac{f(u_R) - f(u_L)}{u_R - u_L} $$\n对于凸通量，条件 $u_L  u_R$ 确保了熵条件 $f'(u_L)  s  f'(u_R)$ 自动满足，保证了唯一的、物理相关的激波。解是一个以速度 $s$ 移动的阶跃间断。\n- 如果 $s  0$，激波向右传播。界面 $x/t=0$ 处的区域被激波左侧的状态占据，因此 $u_\\star = u_L$。\n- 如果 $s \\le 0$，激波向左传播或静止。界面 $x/t=0$ 处的区域被激波右侧的状态占据，因此 $u_\\star = u_R$。\n\n**平凡情况 ($u_L = u_R$)**\n如果 $u_L = u_R = u$，则没有波，状态是均匀的。因此，$u_\\star = u$。\n\n### 第 3 步：算法总结\n\n给定 $u_L$、$u_R$、一个凸通量函数 $f(u)$ 及其导数 $f'(u)$：\n\n1.  如果 $u_L$ 和 $u_R$ 相等（在一个很小的容差范围内），则设置 $u_\\star = u_L$。\n2.  如果 $u_L  u_R$（稀疏波）：\n    a. 计算 $a_L = f'(u_L)$ 和 $a_R = f'(u_R)$。\n    b. 如果 $a_L \\ge 0$，设置 $u_\\star = u_L$。\n    c. 否则，如果 $a_R \\le 0$，设置 $u_\\star = u_R$。\n    d. 否则（$a_L  0  a_R$），使用区间法在区间 $[u_L, u_R]$ 中找到 $f'(u) = 0$ 的唯一根 $u_\\star$。\n3.  如果 $u_L  u_R$（激波）：\n    a. 计算激波速度 $s = (f(u_R) - f(u_L)) / (u_R - u_L)$。\n    b. 如果 $s  0$，设置 $u_\\star = u_L$。\n    c. 否则（$s \\le 0$），设置 $u_\\star = u_R$。\n4.  Godunov 通量为 $f(u_\\star)$。\n\n该算法根据基本原理正确确定了界面状态 $u_\\star$，并由此计算出数值通量。",
            "answer": "```python\nimport numpy as np\n\ndef bisection(func, a, b, tol=1e-12, max_iter=100):\n    \"\"\"\n    Finds a root of func(x) = 0 within the interval [a, b] using the bisection method.\n    It is assumed that func(a) and func(b) have opposite signs.\n    \"\"\"\n    fa = func(a)\n    fb = func(b)\n    \n    if fa * fb >= 0:\n        # This should not happen for the transonic rarefaction case as f'(a)  0 and f'(b) > 0.\n        # But as a safeguard, we check.\n        if np.isclose(fa, 0): return a\n        if np.isclose(fb, 0): return b\n        raise ValueError(\"Bisection method requires function values at endpoints to have opposite signs.\")\n\n    for _ in range(max_iter):\n        c = (a + b) / 2\n        fc = func(c)\n        \n        if abs(fc)  tol or (b - a) / 2  tol:\n            return c\n        \n        if fa * fc  0:\n            b = c\n        else:\n            a = c\n            fa = fc\n            \n    return (a + b) / 2\n\ndef get_godunov_flux(uL, uR, f, fp):\n    \"\"\"\n    Computes the Godunov numerical flux for a scalar conservation law with a convex flux function.\n    \n    Args:\n        uL (float): State on the left of the interface.\n        uR (float): State on the right of the interface.\n        f (callable): The flux function, f(u).\n        fp (callable): The derivative of the flux function, f'(u).\n        \n    Returns:\n        float: The Godunov flux at the interface.\n    \"\"\"\n    \n    # Trivial case: The state is constant across the interface.\n    if np.isclose(uL, uR):\n        return f(uL)\n    \n    # Case 1: Rarefaction wave (uL  uR)\n    if uL  uR:\n        aL = fp(uL)  # Characteristic speed on the left\n        aR = fp(uR)  # Characteristic speed on the right\n        \n        if aL >= 0:\n            # Entire wave structure moves to the right. state at x/t=0 is uL.\n            u_star = uL\n        elif aR = 0:\n            # Entire wave structure moves to the left. state at x/t=0 is uR.\n            u_star = uR\n        else: # Transonic rarefaction: aL  0  aR\n            # The state at x/t=0 is the sonic point u_star where f'(u_star) = 0.\n            u_star = bisection(fp, uL, uR)\n            \n        return f(u_star)\n        \n    # Case 2: Shock wave (uL > uR)\n    else:\n        # Rankine-Hugoniot shock speed\n        s = (f(uR) - f(uL)) / (uR - uL)\n        \n        if s > 0:\n            # Shock moves to the right. State at x/t=0 is uL.\n            u_star = uL\n        else: # s = 0\n            # Shock is stationary or moves to the left. State at x/t=0 is uR.\n            u_star = uR\n            \n        return f(u_star)\n\ndef solve():\n    \"\"\"\n    Main function to solve the test cases and print the results.\n    \"\"\"\n    # Define flux functions and their derivatives\n    f_burgers = lambda u: 0.5 * u**2\n    fp_burgers = lambda u: u\n    \n    def make_linear_flux_funcs(c):\n        f = lambda u: c * u\n        fp = lambda u: c\n        return f, fp\n\n    f_quad_lin = lambda u: 0.5 * u**2 + u\n    fp_quad_lin = lambda u: u + 1\n\n    # Define test cases\n    test_cases = [\n        # (uL, uR, f, fp)\n        (-1.0, 2.0, f_burgers, fp_burgers),\n        (2.0, -1.0, f_burgers, fp_burgers),\n        (-1.0, 2.0, *make_linear_flux_funcs(3.0)),\n        (1.0, 3.0, *make_linear_flux_funcs(-3.0)),\n        (-2.0, 0.0, f_quad_lin, fp_quad_lin),\n        (1.0, -2.0, f_quad_lin, fp_quad_lin),\n        (1.234, 1.234, f_burgers, fp_burgers),\n    ]\n\n    results = []\n    for uL, uR, f, fp in test_cases:\n        flux = get_godunov_flux(uL, uR, f, fp)\n        results.append(flux)\n        \n    # Format and print the final output\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}