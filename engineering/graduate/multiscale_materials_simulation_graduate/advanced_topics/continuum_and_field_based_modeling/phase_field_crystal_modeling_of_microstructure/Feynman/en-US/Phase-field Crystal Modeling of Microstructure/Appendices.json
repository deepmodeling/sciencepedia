{
    "hands_on_practices": [
        {
            "introduction": "This practice focuses on the essential first step of working with the PFC model: nondimensionalization. Before performing any simulation or analysis, it is crucial to recast the governing equations into a dimensionless form. This process not only simplifies the model by reducing the number of parameters but also illuminates the fundamental dimensionless groups that control the system's behavior, making the results universally applicable .",
            "id": "3831665",
            "problem": "Consider a Phase-Field Crystal (PFC) model for a scalar order parameter field $\\psi(\\mathbf{r},t)$ that captures atomic-scale periodicity in a coarse-grained free-energy description at diffusive time scales. The dimensional free-energy functional is\n$$\nF[\\psi] \\;=\\; \\int d^d r \\,\\left\\{ \\frac{A}{2}\\,\\psi^2 \\;+\\; \\frac{C}{2}\\,\\psi\\,\\big(q_0^2 + \\nabla_{\\mathbf{r}}^2\\big)^2\\,\\psi \\;+\\; \\frac{G}{3}\\,\\psi^3 \\;+\\; \\frac{U}{4}\\,\\psi^4 \\right\\},\n$$\nwhere $A$, $C$, $G$, and $U$ are material-dependent constants, $q_0$ sets the dominant crystalline wavenumber, $d$ is the spatial dimension, and $\\nabla_{\\mathbf{r}}^2$ is the Laplacian with respect to $\\mathbf{r}$. The mass-conserving relaxational dynamics is given by\n$$\n\\frac{\\partial \\psi}{\\partial t} \\;=\\; M \\,\\nabla_{\\mathbf{r}}^2 \\,\\mu, \\quad \\mu \\;=\\; \\frac{\\delta F}{\\delta \\psi},\n$$\nwhere $M$ is a mobility coefficient and $\\mu$ is the chemical potential.\n\nYour task is to perform a rigorous nondimensionalization based on first principles. Define a scaled length by $\\mathbf{x} = q_0\\,\\mathbf{r}$, a scaled field by $\\psi(\\mathbf{r},t) = \\psi_0\\,n(\\mathbf{x},t)$ with a constant $\\psi_0$ chosen to achieve a canonical dimensionless form, and a scaled time $t' = t/t_0$ with a characteristic time $t_0$ expressed in terms of $M$, $C$, and $q_0$. Construct the dimensionless free energy $F^\\ast[n]$ and the dimensionless dynamics for $n(\\mathbf{x},t')$ starting only from the given dimensional statements and standard definitions of functional derivatives and differential operators, and impose the canonical normalization in which the coefficient multiplying $n\\,\\big(1+\\nabla_{\\mathbf{x}}^2\\big)^2\\,n$ in the integrand of $F^\\ast$ is $1/2$ and the coefficient of the quartic term is $1/4$ (i.e., the term is $1/4 \\, n^4$).\n\nFinally, provide the closed-form analytic expression for the dimensionless linear control parameter $r$ (the coefficient multiplying $n^2/2$ in the integrand of $F^\\ast$) in terms of $A$, $C$, and $q_0$. The final answer must be a single analytic expression. Do not evaluate any numerical values. No rounding is required. No physical units are required in the final answer.",
            "solution": "We begin from the given dimensional free-energy functional\n$$\nF[\\psi] \\;=\\; \\int d^d r \\,\\left\\{ \\frac{A}{2}\\,\\psi^2 \\;+\\; \\frac{C}{2}\\,\\psi\\,\\big(q_0^2 + \\nabla_{\\mathbf{r}}^2\\big)^2\\,\\psi \\;+\\; \\frac{G}{3}\\,\\psi^3 \\;+\\; \\frac{U}{4}\\,\\psi^4 \\right\\}.\n$$\nThe corresponding chemical potential is defined by the functional derivative\n$$\n\\mu \\;=\\; \\frac{\\delta F}{\\delta \\psi} \\;=\\; A\\,\\psi \\;+\\; C\\,\\big(q_0^2 + \\nabla_{\\mathbf{r}}^2\\big)^2\\,\\psi \\;+\\; G\\,\\psi^2 \\;+\\; U\\,\\psi^3,\n$$\nwhere we used linearity of the functional derivative and the self-adjointness of $\\big(q_0^2 + \\nabla_{\\mathbf{r}}^2\\big)^2$. The conserved dynamics is Model B–type:\n$$\n\\frac{\\partial \\psi}{\\partial t} \\;=\\; M\\,\\nabla_{\\mathbf{r}}^2 \\,\\mu.\n$$\n\nWe introduce nondimensional variables. Define the dimensionless position by $\\mathbf{x} = q_0\\,\\mathbf{r}$ so that derivatives transform according to\n$$\n\\nabla_{\\mathbf{r}} \\;=\\; q_0\\,\\nabla_{\\mathbf{x}}, \\qquad \\nabla_{\\mathbf{r}}^2 \\;=\\; q_0^2\\,\\nabla_{\\mathbf{x}}^2,\n$$\nand the measure transforms as $d^d r = d^d x \\, q_0^{-d}$. Define a scaled field $\\psi(\\mathbf{r},t) = \\psi_0\\,n(\\mathbf{x},t)$ with a constant amplitude scale $\\psi_0$ to be determined. With these, the free energy becomes\n\\begin{align*}\nF[\\psi] &= \\int d^d r \\left\\{ \\frac{A}{2}\\,\\psi^2 + \\frac{C}{2}\\,\\psi\\,\\big(q_0^2 + \\nabla_{\\mathbf{r}}^2\\big)^2\\,\\psi + \\frac{G}{3}\\,\\psi^3 + \\frac{U}{4}\\,\\psi^4 \\right\\} \\\\\n&= \\int d^d x \\, q_0^{-d} \\left\\{ \\frac{A}{2}\\,\\psi_0^2\\,n^2 + \\frac{C}{2}\\,\\psi_0\\,n\\,q_0^4\\,\\big(1 + \\nabla_{\\mathbf{x}}^2\\big)^2\\,\\psi_0\\,n + \\frac{G}{3}\\,\\psi_0^3\\,n^3 + \\frac{U}{4}\\,\\psi_0^4\\,n^4 \\right\\}.\n\\end{align*}\nWe factor out an energy scale $F_0 = C\\,\\psi_0^2\\,q_0^{4-d}$ so that the dimensionless free energy $F^\\ast = F/F_0$ reads\n\\begin{align*}\nF^\\ast[n] &= \\int d^d x \\left\\{ \\frac{A}{2\\,C\\,q_0^4}\\,n^2 \\;+\\; \\frac{1}{2}\\,n\\,\\big(1 + \\nabla_{\\mathbf{x}}^2\\big)^2\\,n \\;+\\; \\frac{G\\,\\psi_0}{3\\,C\\,q_0^4}\\,n^3 \\;+\\; \\frac{U\\,\\psi_0^2}{4\\,C\\,q_0^4}\\,n^4 \\right\\}.\n\\end{align*}\nThis achieves the canonical normalization in which the coefficient of $n\\,\\big(1+\\nabla_{\\mathbf{x}}^2\\big)^2\\,n$ is $\\frac{1}{2}$. To complete the canonical form, we choose $\\psi_0$ to fix the coefficient of the $n^4/4$ term to $1$, namely\n$$\n\\frac{U\\,\\psi_0^2}{C\\,q_0^4} \\;=\\; 1 \\quad \\Rightarrow \\quad \\psi_0 \\;=\\; q_0^2\\sqrt{\\frac{C}{U}}.\n$$\nWith this choice, the dimensionless free energy becomes\n$$\nF^\\ast[n] \\;=\\; \\int d^d x \\left\\{ \\frac{r}{2}\\,n^2 \\;+\\; \\frac{1}{2}\\,n\\,\\big(1 + \\nabla_{\\mathbf{x}}^2\\big)^2\\,n \\;+\\; \\frac{v}{3}\\,n^3 \\;+\\; \\frac{w}{4}\\,n^4 \\right\\},\n$$\nwhere the dimensionless coefficients are\n$$\nr \\;=\\; \\frac{A}{C\\,q_0^4}, \\qquad v \\;=\\; \\frac{G\\,\\psi_0}{C\\,q_0^4} \\;=\\; \\frac{G}{q_0^2\\sqrt{UC}}, \\qquad w \\;=\\; 1.\n$$\n\nWe now nondimensionalize the dynamics. The chemical potential scales as\n\\begin{align*}\n\\mu &= A\\,\\psi + C\\,\\big(q_0^2 + \\nabla_{\\mathbf{r}}^2\\big)^2\\,\\psi + G\\,\\psi^2 + U\\,\\psi^3 \\\\\n&= C q_0^4 \\psi_0 \\left[ \\frac{A}{Cq_0^4}\\,n + \\big(1 + \\nabla_{\\mathbf{x}}^2\\big)^2\\,n + \\frac{G\\psi_0}{Cq_0^4}\\,n^2 + \\frac{U\\psi_0^2}{Cq_0^4}\\,n^3 \\right] \\\\\n&= C q_0^4 \\psi_0 \\left[ r\\,n + \\big(1 + \\nabla_{\\mathbf{x}}^2\\big)^2\\,n + v\\,n^2 + w\\,n^3 \\right].\n\\end{align*}\nThe dynamics becomes\n\\begin{align*}\n\\frac{\\partial \\psi}{\\partial t} &= M\\,\\nabla_{\\mathbf{r}}^2 \\,\\mu \\;=\\; M\\,q_0^2\\,\\nabla_{\\mathbf{x}}^2 \\,\\mu \\\\\n\\Rightarrow \\quad \\psi_0\\,\\frac{\\partial n}{\\partial t} &= M\\,q_0^2\\,\\nabla_{\\mathbf{x}}^2 \\,\\left( C q_0^4 \\psi_0 \\left[ \\dots \\right] \\right) \\\\\n\\Rightarrow \\quad \\frac{\\partial n}{\\partial t} &= \\big(M\\,C\\,q_0^6\\big)\\,\\nabla_{\\mathbf{x}}^2 \\left[ r\\,n + \\big(1 + \\nabla_{\\mathbf{x}}^2\\big)^2\\,n + v\\,n^2 + w\\,n^3 \\right],\n\\end{align*}\nwhere we canceled $\\psi_0$. Define the characteristic time $t_0$ by\n$$\nt_0 \\;=\\; \\frac{1}{M\\,C\\,q_0^6}, \\qquad t' \\;=\\; \\frac{t}{t_0}.\n$$\nThen the dimensionless dynamics reads\n$$\n\\frac{\\partial n}{\\partial t'} \\;=\\; \\nabla_{\\mathbf{x}}^2 \\left[ r\\,n + \\big(1 + \\nabla_{\\mathbf{x}}^2\\big)^2\\,n + v\\,n^2 + w\\,n^3 \\right],\n$$\nwith $r$, $v$, and $w$ as above, consistent with the canonical normalization specified.\n\nThe requested dimensionless linear control parameter $r$ is thus obtained directly from the nondimensionalization of the quadratic term:\n$$\nr \\;=\\; \\frac{A}{C\\,q_0^4}.\n$$\nThis is a closed-form analytic expression depending only on $A$, $C$, and $q_0$.",
            "answer": "$$\\boxed{\\frac{A}{C\\,q_0^4}}$$"
        },
        {
            "introduction": "With a dimensionless formulation of the PFC model, we can proceed to simulate the evolution of the microstructure. This exercise guides you through the implementation of a numerical solver using the pseudospectral method, which is highly efficient for the periodic systems characteristic of crystalline materials. By building a solver from first principles and verifying the fundamental property of mass conservation, you will gain hands-on experience with the core computational techniques used in PFC modeling .",
            "id": "3831730",
            "problem": "You are given the non-dimensional phase-field crystal (PFC) dynamics for a conserved order parameter field $ \\psi(\\mathbf{r}, t) $ in a periodic domain. The thermodynamic driving force is the functional derivative of a coarse-grained free energy. Consider the free energy\n$$\nF[\\psi] = \\int_{\\Omega} \\left[ \\frac{1}{2}\\,\\psi\\left( r + \\left(1 + \\nabla^2\\right)^2 \\right)\\psi + \\frac{1}{4}\\,\\psi^4 \\right]\\, d\\mathbf{r},\n$$\nwhere $ \\Omega $ is a $ d $-dimensional periodic domain, $ r \\in \\mathbb{R} $ is a control parameter, and all quantities are non-dimensional. The chemical potential is $ \\mu = \\delta F/\\delta \\psi $, and the evolution equation is a conserved gradient flow\n$$\n\\frac{\\partial \\psi}{\\partial t} = \\nabla^2 \\mu,\n$$\nsubject to periodic boundary conditions on $ \\Omega $. The total mass is defined by\n$$\nM(t) = \\int_{\\Omega} \\psi(\\mathbf{r}, t)\\, d\\mathbf{r}.\n$$\n\nStarting from first principles and core definitions, implement a numerical solver that advances $ \\psi $ in time on a uniform grid with periodic boundaries using a pseudospectral approach in Fourier space. Your solver must:\n- Use a uniform grid with $ N_x \\times N_y $ nodes on a rectangular domain of size $ L_x \\times L_y $ with periodic boundary conditions.\n- Represent spatial derivatives via Fourier modes with wavevectors $ \\mathbf{k} = (k_x, k_y) $, where Fourier differentiation maps $ \\nabla^2 \\mapsto -|\\mathbf{k}|^2 $.\n- Treat the linear terms implicitly and the nonlinear term explicitly in a first-order accurate time integration that is consistent with the conserved gradient flow and periodicity. Do not use any aliasing corrections.\n- Compute the total mass $ M(t) $ at least at the initial and final times via the trapezoidal rule for uniform grids, which in this periodic and uniform-grid setting is exactly the rectangle rule:\n$$\nM(t) = \\left(\\sum_{i=1}^{N_x}\\sum_{j=1}^{N_y} \\psi_{i,j}(t)\\right)\\, \\Delta x\\, \\Delta y,\n$$\nwith $ \\Delta x = L_x/N_x $ and $ \\Delta y = L_y/N_y $.\n- For each test case, report the absolute difference $ \\Delta M = |M(t_{\\text{final}}) - M(0)| $ as a floating-point number. All reported numbers are unitless.\n\nDesign a self-contained program (no user input) that runs the following test suite and outputs the list of four results $ [\\Delta M_1, \\Delta M_2, \\Delta M_3, \\Delta M_4] $ on a single line, in a comma-separated list enclosed in square brackets. The initial conditions are specified in real space as follows, with $ x \\in [0, L_x) $ and $ y \\in [0, L_y) $:\n- Test case $ 1 $ (happy path random mean field):\n  - $ N_x = 32 $, $ N_y = 32 $, $ L_x = 32 $, $ L_y = 32 $, $ r = -0.25 $, $ \\Delta t = 0.1 $, $ n_{\\text{steps}} = 50 $.\n  - Initial condition $ \\psi(\\mathbf{r},0) = m + a \\,\\xi(\\mathbf{r}) $ with $ m = 0.1 $, $ a = 0.01 $, and $ \\xi $ a reproducible pseudo-random field of independent values in $ [-0.5, 0.5] $ (use a fixed seed).\n- Test case $ 2 $ (structured sinusoidal mode):\n  - $ N_x = 64 $, $ N_y = 64 $, $ L_x = 64 $, $ L_y = 64 $, $ r = -0.5 $, $ \\Delta t = 0.05 $, $ n_{\\text{steps}} = 20 $.\n  - Initial condition $ \\psi(\\mathbf{r},0) = m + a\\left[ \\cos\\left( \\frac{2\\pi m_x x}{L_x} \\right)\\cos\\left( \\frac{2\\pi m_y y}{L_y} \\right) \\right] $ with $ m = 0 $, $ a = 0.1 $, $ m_x = 3 $, $ m_y = 2 $.\n- Test case $ 3 $ (boundary case, constant field):\n  - $ N_x = 16 $, $ N_y = 16 $, $ L_x = 16 $, $ L_y = 16 $, $ r = -0.25 $, $ \\Delta t = 0.5 $, $ n_{\\text{steps}} = 5 $.\n  - Initial condition $ \\psi(\\mathbf{r},0) = m $ with $ m = 0.2 $.\n- Test case $ 4 $ (edge case, zero linear driving parameter):\n  - $ N_x = 48 $, $ N_y = 48 $, $ L_x = 48 $, $ L_y = 48 $, $ r = 0 $, $ \\Delta t = 0.2 $, $ n_{\\text{steps}} = 10 $.\n  - Initial condition $ \\psi(\\mathbf{r},0) = m + a \\,\\xi(\\mathbf{r}) $ with $ m = -0.02 $, $ a = 0.02 $, and $ \\xi $ a reproducible pseudo-random field as in Test case $ 1 $ (use a different fixed seed).\n\nYour program must:\n- Implement the pseudospectral time-stepping consistent with the conserved PFC dynamics and periodic boundary conditions, starting only from the definitions above.\n- For each test case, compute $ \\Delta M $ as defined and store it as a floating-point number.\n- Produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example $ [\\Delta M_1,\\Delta M_2,\\Delta M_3,\\Delta M_4] $.\n- All quantities are non-dimensional; report unitless numbers.\n\nNotes:\n- The algorithmic choices must ensure that the zero-wavevector mode is handled consistently with periodic conservation so that $ M(t) $ is invariant up to numerical roundoff.\n- The reported $ \\Delta M $ values should be small (close to machine precision), but you must report the raw computed values without applying thresholds or converting to booleans.",
            "solution": "The problem is valid as it is scientifically grounded in the established phase-field crystal (PFC) methodology, is well-posed with a complete and consistent set of parameters, and is expressed in objective, formal language. We proceed with the solution.\n\nThe core of the problem is to solve the PFC evolution equation for a conserved order parameter field $ \\psi(\\mathbf{r}, t) $ on a two-dimensional periodic domain $ \\Omega $. The dynamics are governed by a conserved gradient flow derived from a coarse-grained free energy functional $ F[\\psi] $.\n\nThe free energy functional is given by:\n$$\nF[\\psi] = \\int_{\\Omega} \\left[ \\frac{1}{2}\\,\\psi\\left( r + \\left(1 + \\nabla^2\\right)^2 \\right)\\psi + \\frac{1}{4}\\,\\psi^4 \\right]\\, d\\mathbf{r}\n$$\nHere, $ r $ is a control parameter, and $ \\nabla^2 $ is the Laplacian operator. The term $ (1 + \\nabla^2)^2 $ penalizes deviations from a characteristic length scale, leading to periodic (crystalline) structures. The $ \\psi^4 $ term is a standard double-well potential stabilizing the field.\n\nThe chemical potential $ \\mu $ is the functional derivative of the free energy with respect to the field $ \\psi $:\n$$\n\\mu = \\frac{\\delta F}{\\delta \\psi}\n$$\nTo compute this, we consider a small variation $ \\delta\\psi $:\n$$\n\\delta F = \\int_{\\Omega} \\left[ \\frac{1}{2}\\,\\delta\\psi\\left( r + \\left(1 + \\nabla^2\\right)^2 \\right)\\psi + \\frac{1}{2}\\,\\psi\\left( r + \\left(1 + \\nabla^2\\right)^2 \\right)\\delta\\psi + \\psi^3 \\delta\\psi \\right]\\, d\\mathbf{r}\n$$\nThe operator $ r + (1 + \\nabla^2)^2 $ is self-adjoint under periodic boundary conditions. Thus, the first two terms in the integrand are identical. This leads to:\n$$\n\\delta F = \\int_{\\Omega} \\left[ \\left( r + \\left(1 + \\nabla^2\\right)^2 \\right)\\psi + \\psi^3 \\right] \\delta\\psi \\, d\\mathbf{r}\n$$\nFrom the definition of the functional derivative, we identify the chemical potential as:\n$$\n\\mu(\\mathbf{r}, t) = \\left( r + \\left(1 + \\nabla^2\\right)^2 \\right)\\psi + \\psi^3\n$$\n\nThe evolution of $ \\psi $ follows a Cahn-Hilliard-type conserved dynamics equation:\n$$\n\\frac{\\partial \\psi}{\\partial t} = \\nabla^2 \\mu = \\nabla^2 \\left[ \\left( r + \\left(1 + \\nabla^2\\right)^2 \\right)\\psi + \\psi^3 \\right]\n$$\nThis can be separated into linear and nonlinear parts:\n$$\n\\frac{\\partial \\psi}{\\partial t} = \\nabla^2 \\left( r + \\left(1 + \\nabla^2\\right)^2 \\right)\\psi + \\nabla^2(\\psi^3)\n$$\n\nTo solve this partial differential equation numerically, we employ a pseudospectral method, which is highly efficient for problems with periodic boundary conditions. The method involves transforming the equation into Fourier space. Let $ \\hat{\\psi}(\\mathbf{k}, t) = \\mathcal{F}\\{\\psi(\\mathbf{r}, t)\\} $ be the Fourier transform of $ \\psi(\\mathbf{r}, t) $, where $ \\mathbf{k}=(k_x, k_y) $ is the wavevector. In Fourier space, the Laplacian operator becomes a simple multiplication: $ \\mathcal{F}\\{\\nabla^2 f\\} = -|\\mathbf{k}|^2 \\hat{f} $, where $ |\\mathbf{k}|^2 = k_x^2 + k_y^2 $.\n\nApplying the Fourier transform to the evolution equation yields:\n$$\n\\frac{\\partial \\hat{\\psi}}{\\partial t} = -|\\mathbf{k}|^2 \\left[ \\left( r + (1 - |\\mathbf{k}|^2)^2 \\right)\\hat{\\psi} + \\mathcal{F}\\{\\psi^3\\} \\right]\n$$\nWe can write this as:\n$$\n\\frac{\\partial \\hat{\\psi}}{\\partial t} = L(\\mathbf{k}) \\hat{\\psi} + N(\\psi)\n$$\nwhere the linear part is $ L(\\mathbf{k}) = -|\\mathbf{k}|^2\\left(r + (1 - |\\mathbf{k}|^2)^2\\right) $ and the nonlinear part is $ N(\\psi) = -|\\mathbf{k}|^2\\mathcal{F}\\{\\psi^3\\} $.\n\nThe problem specifies a first-order time integration scheme where the linear term is treated implicitly and the nonlinear term explicitly. This is a semi-implicit Euler (or forward-backward Euler) scheme. For a time step $ \\Delta t $, we discretize the equation as:\n$$\n\\frac{\\hat{\\psi}^{n+1} - \\hat{\\psi}^n}{\\Delta t} = L(\\mathbf{k}) \\hat{\\psi}^{n+1} + N(\\psi^n)\n$$\nwhere the superscripts $ n $ and $ n+1 $ denote the current and next time levels, respectively. Rearranging to solve for $ \\hat{\\psi}^{n+1} $:\n$$\n\\hat{\\psi}^{n+1}(1 - \\Delta t L(\\mathbf{k})) = \\hat{\\psi}^n + \\Delta t N(\\psi^n)\n$$\n$$\n\\hat{\\psi}^{n+1}(\\mathbf{k}) = \\frac{\\hat{\\psi}^n(\\mathbf{k}) + \\Delta t N(\\psi^n)}{1 - \\Delta t L(\\mathbf{k})}\n$$\nSubstituting the expressions for $ L(\\mathbf{k}) $ and $ N(\\psi^n) $:\n$$\n\\hat{\\psi}^{n+1}(\\mathbf{k}) = \\frac{\\hat{\\psi}^n(\\mathbf{k}) - \\Delta t |\\mathbf{k}|^2 \\mathcal{F}\\{(\\psi^n)^3\\}}{1 + \\Delta t |\\mathbf{k}|^2 \\left(r + (1-|\\mathbf{k}|^2)^2\\right)}\n$$\nThis is the update rule for the field in Fourier space.\n\nA key feature of this scheme is its handling of mass conservation. The total mass $ M(t) = \\int_{\\Omega} \\psi(\\mathbf{r}, t) d\\mathbf{r} $ is proportional to the zero-wavevector Fourier mode $ \\hat{\\psi}(\\mathbf{k}=\\mathbf{0}) $. For the $ \\mathbf{k}=\\mathbf{0} $ mode, $ |\\mathbf{k}|^2=0 $. The update equation simplifies to:\n$$\n\\hat{\\psi}^{n+1}(\\mathbf{0}) = \\frac{\\hat{\\psi}^n(\\mathbf{0}) - \\Delta t \\cdot 0 \\cdot \\mathcal{F}\\{(\\psi^n)^3\\}(\\mathbf{0})}{1 + \\Delta t \\cdot 0 \\cdot (\\dots)} = \\hat{\\psi}^n(\\mathbf{0})\n$$\nThis shows that the $ \\mathbf{k}=\\mathbf{0} $ mode is exactly conserved by the numerical scheme. Any change in the total mass, calculated as $ M(t) = (\\sum_{i,j} \\psi_{i,j}(t)) \\Delta x \\Delta y $, will be due solely to floating-point roundoff errors, and is expected to be close to machine precision.\n\nThe numerical algorithm for each test case is as follows:\n1.  Initialize parameters: $ N_x, N_y, L_x, L_y, r, \\Delta t, n_{\\text{steps}} $.\n2.  Define the real-space grid coordinates $ x, y $ and grid spacings $ \\Delta x = L_x/N_x, \\Delta y = L_y/N_y $.\n3.  Define the Fourier-space wavevector components $ k_x, k_y $ and construct the $ 2 $D wavevector grid $ \\mathbf{k}=(k_x, k_y) $ and the squared magnitude grid $ |\\mathbf{k}|^2 $.\n4.  Generate the initial condition $ \\psi(\\mathbf{r}, 0) $ on the real-space grid.\n5.  Calculate the initial mass $ M(0) $ using the provided summation formula.\n6.  Loop for $ n_{\\text{steps}} $:\n    a.  Compute the Fourier transform of the current field, $ \\hat{\\psi}^n = \\mathcal{F}\\{\\psi^n\\} $.\n    b.  Compute the nonlinear term in real space, $ (\\psi^n)^3 $, and its Fourier transform, $ \\mathcal{F}\\{(\\psi^n)^3\\} $.\n    c.  Apply the semi-implicit update formula in Fourier space to compute $ \\hat{\\psi}^{n+1} $.\n    d.  Compute the new real-space field via the inverse Fourier transform, $ \\psi^{n+1} = \\mathcal{F}^{-1}\\{\\hat{\\psi}^{n+1}\\} $. The result should be real, so we take the real part to discard negligible imaginary components from roundoff error.\n7.  After the loop, calculate the final mass $ M(t_{\\text{final}}) $.\n8.  Compute the final result for the test case as $ \\Delta M = |M(t_{\\text{final}}) - M(0)| $.\n\nThis procedure is implemented for each of the four test cases provided.",
            "answer": "```python\nimport numpy as np\n\ndef run_simulation(Nx, Ny, Lx, Ly, r, dt, n_steps, initial_condition_func):\n    \"\"\"\n    Runs a single Phase-Field Crystal simulation.\n\n    Args:\n        Nx (int): Number of grid points in x.\n        Ny (int): Number of grid points in y.\n        Lx (float): Domain size in x.\n        Ly (float): Domain size in y.\n        r (float): Control parameter.\n        dt (float): Time step size.\n        n_steps (int): Number of time steps.\n        initial_condition_func (function): A function that returns the initial psi field.\n\n    Returns:\n        float: The absolute difference between final and initial total mass.\n    \"\"\"\n    # Grid and wavevector setup\n    dx = Lx / Nx\n    dy = Ly / Ny\n    \n    # Create wavevectors in the order numpy.fft expects them\n    kx_vals = 2 * np.pi * np.fft.fftfreq(Nx, d=dx)\n    ky_vals = 2 * np.pi * np.fft.fftfreq(Ny, d=dy)\n    kx, ky = np.meshgrid(ky_vals, kx_vals) # Note: meshgrid indexing 'ij' for fft2\n    k2 = kx**2 + ky**2\n    \n    # Initial condition\n    psi = initial_condition_func(Nx, Ny, Lx, Ly)\n    \n    # Calculate initial mass\n    mass_initial = np.sum(psi) * dx * dy\n    \n    # Pre-compute the denominator for the time-stepping update rule\n    # Denominator: 1 + dt * |k|^2 * (r + (1 - |k|^2)^2)\n    denominator = 1 + dt * k2 * (r + (1 - k2)**2)\n    \n    # Time-stepping loop\n    psi_hat = np.fft.fft2(psi)\n\n    for _ in range(n_steps):\n        # Compute nonlinear term in real space and transform\n        psi_cubed = psi**3\n        psi_cubed_hat = np.fft.fft2(psi_cubed)\n        \n        # Update rule in Fourier space\n        # Numerator: psi_hat - dt * |k|^2 * FFT(psi^3)\n        numerator = psi_hat - dt * k2 * psi_cubed_hat\n        \n        psi_hat = numerator / denominator\n        \n        # Transform back to real space for the next iteration's nonlinear term\n        # The result of ifft2 on a field with appropriate symmetry will be real.\n        # Taking .real discards negligible imaginary parts due to roundoff.\n        psi = np.fft.ifft2(psi_hat).real\n\n    # Calculate final mass\n    mass_final = np.sum(psi) * dx * dy\n    \n    # Compute the absolute difference in mass\n    delta_mass = abs(mass_final - mass_initial)\n    \n    return delta_mass\n\ndef solve():\n    \"\"\"\n    Defines and runs the test suite for the PFC simulation.\n    \"\"\"\n    test_cases = [\n        # Test case 1 (happy path random mean field)\n        {\n            \"params\": {\"Nx\": 32, \"Ny\": 32, \"Lx\": 32, \"Ly\": 32, \"r\": -0.25, \"dt\": 0.1, \"n_steps\": 50},\n            \"ic_func\": lambda Nx, Ny, Lx, Ly: (\n                0.1 + 0.01 * (np.random.default_rng(seed=42).uniform(-0.5, 0.5, size=(Nx, Ny)))\n            ),\n        },\n        # Test case 2 (structured sinusoidal mode)\n        {\n            \"params\": {\"Nx\": 64, \"Ny\": 64, \"Lx\": 64, \"Ly\": 64, \"r\": -0.5, \"dt\": 0.05, \"n_steps\": 20},\n            \"ic_func\": lambda Nx, Ny, Lx, Ly: (\n                (lambda m, a, mx, my: (\n                    m + a * (np.cos(2 * np.pi * mx * np.linspace(0, Lx, Nx, endpoint=False) / Lx)[np.newaxis, :]) *\n                           (np.cos(2 * np.pi * my * np.linspace(0, Ly, Ny, endpoint=False) / Ly)[:, np.newaxis])\n                ))(m=0.0, a=0.1, mx=3, my=2)\n            ),\n        },\n        # Test case 3 (boundary case, constant field)\n        {\n            \"params\": {\"Nx\": 16, \"Ny\": 16, \"Lx\": 16, \"Ly\": 16, \"r\": -0.25, \"dt\": 0.5, \"n_steps\": 5},\n            \"ic_func\": lambda Nx, Ny, Lx, Ly: 0.2 * np.ones((Nx, Ny)),\n        },\n        # Test case 4 (edge case, zero linear driving parameter)\n        {\n            \"params\": {\"Nx\": 48, \"Ny\": 48, \"Lx\": 48, \"Ly\": 48, \"r\": 0.0, \"dt\": 0.2, \"n_steps\": 10},\n            \"ic_func\": lambda Nx, Ny, Lx, Ly: (\n                -0.02 + 0.02 * (np.random.default_rng(seed=1337).uniform(-0.5, 0.5, size=(Nx, Ny)))\n            ),\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        delta_m = run_simulation(\n            Nx=case[\"params\"][\"Nx\"],\n            Ny=case[\"params\"][\"Ny\"],\n            Lx=case[\"params\"][\"Lx\"],\n            Ly=case[\"params\"][\"Ly\"],\n            r=case[\"params\"][\"r\"],\n            dt=case[\"params\"][\"dt\"],\n            n_steps=case[\"params\"][\"n_steps\"],\n            initial_condition_func=case[\"ic_func\"]\n        )\n        results.append(delta_m)\n\n    # Format the final output as specified\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "A powerful simulation is one whose results can be compared to the real world. This final practice bridges the gap between the abstract, dimensionless world of the PFC model and the tangible, physical properties of materials. You will learn how to derive and apply scaling relations that connect the model's outputs, such as elastic constants and interfacial energies, to experimental or atomistic data, thereby determining the intrinsic length and energy scales of your PFC simulation .",
            "id": "3831643",
            "problem": "Consider the nondimensional Phase-Field Crystal (PFC) free-energy functional for a scalar density deviation field $n(\\mathbf{r})$ written in the standard form\n$$\nF_{\\mathrm{PFC}}[n] = \\int_{\\Omega} \\mathrm{d}\\mathbf{r}\\,\\left[\\frac{1}{2}\\,n\\,\\left(r + \\left(1 + \\nabla^{2}\\right)^{2}\\right)n + \\frac{v}{3}\\,n^{3} + \\frac{w}{4}\\,n^{4}\\right],\n$$\nwhere $\\mathbf{r}$ is a nondimensional spatial coordinate, $r$, $v$, and $w$ are nondimensional parameters, and $\\Omega$ is a nondimensional domain in three dimensions. Let the corresponding dimensional physical free-energy functional be $F_{\\mathrm{phys}}[n_{\\mathrm{phys}}] = \\int_{\\Omega_{\\mathrm{phys}}} \\mathrm{d}\\mathbf{x}\\, f_{\\mathrm{phys}}$, where $\\mathbf{x}$ is the physical spatial coordinate, $f_{\\mathrm{phys}}$ is the physical free-energy density (in $\\mathrm{J}/\\mathrm{m}^{3}$), and $\\Omega_{\\mathrm{phys}}$ is the physical domain.\n\nYou will construct a mapping between PFC units and physical units using only fundamental definitions and scaling. Define a single length scale $L_{0}$ such that $\\mathbf{x} = L_{0}\\,\\mathbf{r}$, and a single energy density scale $E_{0}$ such that $f_{\\mathrm{phys}} = E_{0}\\,f_{\\mathrm{PFC}}$. Assume the PFC elastic constants are obtained from the second derivative of the nondimensional free-energy density with respect to homogeneous strain, and that the solid–liquid interface energy is obtained as the excess free energy per unit area for a one-dimensional planar interface.\n\nStarting from these definitions:\n1. Derive how the physical elastic constants $C_{ijkl}^{\\mathrm{phys}}$ relate to the PFC elastic constants $C_{ijkl}^{\\mathrm{PFC}}$.\n2. Derive how the physical solid–liquid interface energy $\\gamma_{sl}^{\\mathrm{phys}}$ relates to the PFC interface energy $\\gamma_{sl}^{\\mathrm{PFC}}$.\n\nThen, use Molecular Dynamics (MD) or experimental values together with PFC outputs to determine the numerical values of $E_{0}$ and $L_{0}$ by matching a single elastic constant and the solid–liquid interface energy. Specifically, take:\n- $C_{11}^{\\mathrm{phys}} = 185 \\times 10^{9}\\ \\mathrm{Pa}$,\n- $\\gamma_{sl}^{\\mathrm{phys}} = 0.200\\ \\mathrm{J}/\\mathrm{m}^{2}$,\n- $C_{11}^{\\mathrm{PFC}} = 37.0$ (dimensionless),\n- $\\gamma_{sl}^{\\mathrm{PFC}} = 0.250$ (dimensionless, i.e., excess energy per unit nondimensional area).\n\nReport your two scale factors $E_{0}$ (energy density scale) and $L_{0}$ (length unit) in $\\mathrm{J}/\\mathrm{m}^{3}$ and $\\mathrm{m}$ respectively. Round both to four significant figures. Provide your final numerical pair as a row, with the first entry $E_{0}$ and the second entry $L_{0}$.",
            "solution": "The problem statement has been validated and found to be scientifically sound, well-posed, and self-contained. It provides a clear objective, all necessary definitions, and consistent data to determine the scaling factors for a Phase-Field Crystal (PFC) model. We may therefore proceed with the solution.\n\nThe problem requires us to first derive the scaling relations for elastic constants and solid-liquid interface energy, and then use provided data to calculate the numerical values of the energy density scale $E_{0}$ and the length scale $L_{0}$.\n\nThe fundamental scaling relations are given as:\n$\\mathbf{x} = L_{0}\\,\\mathbf{r}$, where $\\mathbf{x}$ is the physical coordinate and $\\mathbf{r}$ is the nondimensional PFC coordinate.\n$f_{\\mathrm{phys}} = E_{0}\\,f_{\\mathrm{PFC}}$, where $f_{\\mathrm{phys}}$ is the physical free-energy density and $f_{\\mathrm{PFC}}$ is the nondimensional PFC free-energy density.\n\nFirst, we derive the scaling for the elastic constants, $C_{ijkl}$.\nThe elastic constants are defined as the second partial derivatives of the free-energy density $f$ with respect to the components of the homogeneous strain tensor $\\epsilon_{kl}$.\n$$\nC_{ijkl} = \\frac{\\partial^{2}f}{\\partial \\epsilon_{ij} \\partial \\epsilon_{kl}}\n$$\nThe strain tensor $\\epsilon_{ij}$ is defined in terms of the displacement field gradient and is inherently dimensionless. As such, its value is independent of the choice of length scale, meaning $\\epsilon_{ij}^{\\mathrm{phys}} = \\epsilon_{ij}^{\\mathrm{PFC}}$. Let's denote it simply as $\\epsilon_{ij}$.\n\nThe physical elastic constants $C_{ijkl}^{\\mathrm{phys}}$ are derived from the physical free-energy density $f_{\\mathrm{phys}}$:\n$$\nC_{ijkl}^{\\mathrm{phys}} = \\frac{\\partial^{2}f_{\\mathrm{phys}}}{\\partial \\epsilon_{ij} \\partial \\epsilon_{kl}}\n$$\nUsing the given scaling relation $f_{\\mathrm{phys}} = E_{0}\\,f_{\\mathrm{PFC}}$, we can substitute this into the expression for $C_{ijkl}^{\\mathrm{phys}}$:\n$$\nC_{ijkl}^{\\mathrm{phys}} = \\frac{\\partial^{2}\\left(E_{0}\\,f_{\\mathrm{PFC}}\\right)}{\\partial \\epsilon_{ij} \\partial \\epsilon_{kl}}\n$$\nSince $E_{0}$ is a constant scaling factor, it can be taken outside the derivatives:\n$$\nC_{ijkl}^{\\mathrm{phys}} = E_{0}\\,\\frac{\\partial^{2}f_{\\mathrm{PFC}}}{\\partial \\epsilon_{ij} \\partial \\epsilon_{kl}}\n$$\nThe term $\\frac{\\partial^{2}f_{\\mathrm{PFC}}}{\\partial \\epsilon_{ij} \\partial \\epsilon_{kl}}$ is, by definition, the nondimensional PFC elastic constant, $C_{ijkl}^{\\mathrm{PFC}}$. Therefore, we arrive at the first scaling relation:\n$$\nC_{ijkl}^{\\mathrm{phys}} = E_{0}\\,C_{ijkl}^{\\mathrm{PFC}} \\quad (1)\n$$\nThis relation is dimensionally consistent. $C_{ijkl}^{\\mathrm{phys}}$ has units of energy per volume (e.g., $\\mathrm{J}/\\mathrm{m}^{3}$ or $\\mathrm{Pa}$), $E_{0}$ has units of energy per volume, and $C_{ijkl}^{\\mathrm{PFC}}$ is dimensionless.\n\nNext, we derive the scaling for the solid-liquid interface energy, $\\gamma_{sl}$.\nThe interface energy is defined as the excess total free energy $F_{\\mathrm{excess}}$ per unit of interfacial area $A$.\n$$\n\\gamma_{sl} = \\frac{F_{\\mathrm{excess}}}{A}\n$$\nThe total free energy $F$ is the integral of the free-energy density $f$ over the volume $V$. We must relate the total physical free energy $F_{\\mathrm{phys}}$ to the total nondimensional free energy $F_{\\mathrm{PFC}}$.\nThe differential volume elements are related by the length scale $L_{0}$:\n$$\n\\mathrm{d}\\mathbf{x} = \\mathrm{d}(L_{0}\\,r_{1})\\,\\mathrm{d}(L_{0}\\,r_{2})\\,\\mathrm{d}(L_{0}\\,r_{3}) = L_{0}^{3}\\,\\mathrm{d}\\mathbf{r}\n$$\nNow, we can relate the total free energies:\n$$\nF_{\\mathrm{phys}} = \\int_{\\Omega_{\\mathrm{phys}}} f_{\\mathrm{phys}}\\,\\mathrm{d}\\mathbf{x} = \\int_{\\Omega} \\left(E_{0}\\,f_{\\mathrm{PFC}}\\right)\\,\\left(L_{0}^{3}\\,\\mathrm{d}\\mathbf{r}\\right) = E_{0}\\,L_{0}^{3}\\,\\int_{\\Omega} f_{\\mathrm{PFC}}\\,\\mathrm{d}\\mathbf{r} = E_{0}\\,L_{0}^{3}\\,F_{\\mathrm{PFC}}\n$$\nThis scaling applies to any total free energy, including the excess free energy of an interface, $F_{\\mathrm{excess}}$. Thus:\n$$\nF_{\\mathrm{excess}}^{\\mathrm{phys}} = E_{0}\\,L_{0}^{3}\\,F_{\\mathrm{excess}}^{\\mathrm{PFC}}\n$$\nThe interfacial areas are also related by the length scale $L_{0}$. For a planar interface, the physical area $A_{\\mathrm{phys}}$ and nondimensional area $A_{\\mathrm{PFC}}$ are related by:\n$$\nA_{\\mathrm{phys}} = L_{0}^{2}\\,A_{\\mathrm{PFC}}\n$$\nNow we can write the physical interface energy $\\gamma_{sl}^{\\mathrm{phys}}$:\n$$\n\\gamma_{sl}^{\\mathrm{phys}} = \\frac{F_{\\mathrm{excess}}^{\\mathrm{phys}}}{A_{\\mathrm{phys}}} = \\frac{E_{0}\\,L_{0}^{3}\\,F_{\\mathrm{excess}}^{\\mathrm{PFC}}}{L_{0}^{2}\\,A_{\\mathrm{PFC}}}\n$$\nSimplifying this expression yields:\n$$\n\\gamma_{sl}^{\\mathrm{phys}} = E_{0}\\,L_{0}\\,\\left(\\frac{F_{\\mathrm{excess}}^{\\mathrm{PFC}}}{A_{\\mathrm{PFC}}}\\right)\n$$\nThe term in the parenthesis is the definition of the nondimensional PFC interface energy, $\\gamma_{sl}^{\\mathrm{PFC}}$. This gives our second scaling relation:\n$$\n\\gamma_{sl}^{\\mathrm{phys}} = E_{0}\\,L_{0}\\,\\gamma_{sl}^{\\mathrm{PFC}} \\quad (2)\n$$\nThis relation is also dimensionally consistent. $\\gamma_{sl}^{\\mathrm{phys}}$ has units of energy per area (e.g., $\\mathrm{J}/\\mathrm{m}^{2}$), $E_{0}$ is energy/volume, $L_{0}$ is length, and $\\gamma_{sl}^{\\mathrm{PFC}}$ is dimensionless. The product $(E_{0}\\,L_{0})$ has units of $(\\mathrm{J}/\\mathrm{m}^{3})\\cdot\\mathrm{m} = \\mathrm{J}/\\mathrm{m}^{2}$.\n\nWith the two scaling relations derived, we can now use the provided numerical data to find $E_{0}$ and $L_{0}$. The data are:\n- $C_{11}^{\\mathrm{phys}} = 185 \\times 10^{9}\\ \\mathrm{Pa} = 185 \\times 10^{9}\\ \\mathrm{J}/\\mathrm{m}^{3}$\n- $\\gamma_{sl}^{\\mathrm{phys}} = 0.200\\ \\mathrm{J}/\\mathrm{m}^{2}$\n- $C_{11}^{\\mathrm{PFC}} = 37.0$\n- $\\gamma_{sl}^{\\mathrm{PFC}} = 0.250$\n\nFrom relation $(1)$, we can solve for $E_{0}$:\n$$\nE_{0} = \\frac{C_{11}^{\\mathrm{phys}}}{C_{11}^{\\mathrm{PFC}}} = \\frac{185 \\times 10^{9}\\ \\mathrm{J}/\\mathrm{m}^{3}}{37.0} = 5.0 \\times 10^{9}\\ \\mathrm{J}/\\mathrm{m}^{3}\n$$\nThe problem requires rounding to four significant figures.\n$$\nE_{0} = 5.000 \\times 10^{9}\\ \\mathrm{J}/\\mathrm{m}^{3}\n$$\n\nNow, using relation $(2)$, we can solve for $L_{0}$:\n$$\nL_{0} = \\frac{\\gamma_{sl}^{\\mathrm{phys}}}{E_{0}\\,\\gamma_{sl}^{\\mathrm{PFC}}}\n$$\nSubstituting the known values:\n$$\nL_{0} = \\frac{0.200\\ \\mathrm{J}/\\mathrm{m}^{2}}{\\left(5.000 \\times 10^{9}\\ \\mathrm{J}/\\mathrm{m}^{3}\\right) \\times 0.250}\n$$\nFirst, calculate the denominator:\n$$\nE_{0}\\,\\gamma_{sl}^{\\mathrm{PFC}} = (5.000 \\times 10^{9}) \\times 0.250 = 1.250 \\times 10^{9}\\ \\mathrm{J}/\\mathrm{m}^{3}\n$$\nThen, perform the division:\n$$\nL_{0} = \\frac{0.200}{1.250 \\times 10^{9}}\\ \\mathrm{m} = 0.16 \\times 10^{-9}\\ \\mathrm{m} = 1.6 \\times 10^{-10}\\ \\mathrm{m}\n$$\nRounding to four significant figures as requested:\n$$\nL_{0} = 1.600 \\times 10^{-10}\\ \\mathrm{m}\n$$\nThe determined scale factors are $E_{0} = 5.000 \\times 10^{9}\\ \\mathrm{J}/\\mathrm{m}^{3}$ and $L_{0} = 1.600 \\times 10^{-10}\\ \\mathrm{m}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n5.000 \\times 10^{9} & 1.600 \\times 10^{-10}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}