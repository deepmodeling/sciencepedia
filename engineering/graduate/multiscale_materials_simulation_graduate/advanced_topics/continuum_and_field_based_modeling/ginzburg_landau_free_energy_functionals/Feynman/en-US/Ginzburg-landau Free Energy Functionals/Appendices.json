{
    "hands_on_practices": [
        {
            "introduction": "This foundational exercise demonstrates the power of the Ginzburg-Landau framework in its simplest form. By minimizing the free energy for a spatially uniform system, you will derive the mean-field critical exponent, a key universal quantity describing how the order parameter behaves near a continuous phase transition. This practice solidifies the core principle of minimizing the Landau polynomial to predict the equilibrium state of a system .",
            "id": "3766239",
            "problem": "In a uniform, isotropic superconductor near its critical temperature, consider the coarse-grained free energy functional from Ginzburg-Landau (GL) theory for a complex scalar order parameter field $\\psi(\\mathbf{x})$, written to the lowest nontrivial order in a Landau expansion and with the leading gradient penalty:\n$$\n\\mathcal{F}[\\psi] = \\int_{\\Omega} \\left( \\alpha(T)\\,|\\psi(\\mathbf{x})|^{2} + \\frac{\\beta}{2}\\,|\\psi(\\mathbf{x})|^{4} + \\frac{\\kappa}{2}\\,|\\nabla \\psi(\\mathbf{x})|^{2} \\right)\\,d^{d}\\mathbf{x},\n$$\nwith $\\alpha(T) = a_{0}\\,(T - T_{c})$, $a_{0} > 0$, $\\beta > 0$, and $\\kappa > 0$, where $T$ is the temperature, $T_{c}$ is the critical temperature, and $\\Omega$ is a large domain with periodic boundary conditions. Assume no coupling to external fields so that gauge potentials can be neglected. The gradient term models mesoscopic smoothness constraints arising from coarse-graining over microscopic scales, and the quartic coefficient $\\beta > 0$ ensures thermodynamic stability.\n\nWorking from first principles by minimizing the free energy under the assumption that the equilibrium minimizer is spatially uniform below $T_{c}$, derive the equilibrium amplitude $|\\psi|$ as a function of $T$ for $T  T_{c}$, and from its leading scaling with $T$ as $T \\to T_{c}^{-}$, extract the mean-field critical exponent $\\beta_{\\mathrm{op}}$ for the order parameter defined by the asymptotic relation $|\\psi| \\sim (T_{c} - T)^{\\beta_{\\mathrm{op}}}$.\n\nWhat is the value of $\\beta_{\\mathrm{op}}$? Give your answer as an exact number with no units.",
            "solution": "The problem requires the derivation of the mean-field critical exponent $\\beta_{\\mathrm{op}}$ for a scalar order parameter $\\psi(\\mathbf{x})$ described by a Ginzburg-Landau (GL) free energy functional. The derivation proceeds from first principles by minimizing this functional.\n\nThe GL free energy functional is given as:\n$$\n\\mathcal{F}[\\psi] = \\int_{\\Omega} \\left( \\alpha(T)\\,|\\psi(\\mathbf{x})|^{2} + \\frac{\\beta}{2}\\,|\\psi(\\mathbf{x})|^{4} + \\frac{\\kappa}{2}\\,|\\nabla \\psi(\\mathbf{x})|^{2} \\right)\\,d^{d}\\mathbf{x}\n$$\nThe parameters are defined as $\\alpha(T) = a_{0}\\,(T - T_{c})$, with constants $a_{0} > 0$, $\\beta > 0$, and $\\kappa > 0$.\n\nThe problem states that the equilibrium state, which minimizes $\\mathcal{F}[\\psi]$, can be assumed to be spatially uniform for $T  T_c$. Let this uniform order parameter be $\\psi(\\mathbf{x}) = \\psi_{0}$, where $\\psi_{0}$ is a complex constant independent of position $\\mathbf{x}$.\n\nUnder this assumption of uniformity, the gradient of the order parameter is zero: $\\nabla\\psi_{0} = \\mathbf{0}$. Consequently, the gradient term $\\frac{\\kappa}{2}\\,|\\nabla \\psi(\\mathbf{x})|^{2}$ in the free energy functional vanishes. The functional simplifies to:\n$$\n\\mathcal{F}[\\psi_{0}] = \\int_{\\Omega} \\left( \\alpha(T)\\,|\\psi_{0}|^{2} + \\frac{\\beta}{2}\\,|\\psi_{0}|^{4} \\right)\\,d^{d}\\mathbf{x}\n$$\nSince the integrand is now constant throughout the domain $\\Omega$, the integral is simply the integrand multiplied by the volume of the domain, $V = \\int_{\\Omega} d^{d}\\mathbf{x}$.\n$$\n\\mathcal{F}[\\psi_{0}] = V \\left( \\alpha(T)\\,|\\psi_{0}|^{2} + \\frac{\\beta}{2}\\,|\\psi_{0}|^{4} \\right)\n$$\nTo find the equilibrium value of $\\psi_{0}$ that minimizes the total free energy $\\mathcal{F}[\\psi_{0}]$, it is sufficient to minimize the free energy density, which we denote as $f(\\psi_{0})$:\n$$\nf(\\psi_{0}) = \\alpha(T)\\,|\\psi_{0}|^{2} + \\frac{\\beta}{2}\\,|\\psi_{0}|^{4}\n$$\nThis expression depends only on the magnitude of the order parameter, $|\\psi_{0}|$, and not on its complex phase. Let us define a real, non-negative variable $\\rho = |\\psi_{0}|$ to represent the amplitude of the order parameter. The free energy density can then be written as a function of $\\rho$:\n$$\nf(\\rho) = \\alpha(T)\\,\\rho^{2} + \\frac{\\beta}{2}\\,\\rho^{4}\n$$\nTo find the value of $\\rho$ that minimizes this function, we compute the first derivative with respect to $\\rho$ and set it to zero:\n$$\n\\frac{df}{d\\rho} = 2\\,\\alpha(T)\\,\\rho + 2\\,\\beta\\,\\rho^{3} = 0\n$$\nFactoring this equation gives:\n$$\n2\\rho\\,(\\alpha(T) + \\beta\\,\\rho^{2}) = 0\n$$\nThis equation has two potential solutions for the amplitude $\\rho$:\n1. $\\rho = 0$\n2. $\\alpha(T) + \\beta\\,\\rho^{2} = 0 \\implies \\rho^{2} = -\\frac{\\alpha(T)}{\\beta}$\n\nTo determine which of these corresponds to a stable equilibrium (a minimum of the free energy), we examine the second derivative of $f(\\rho)$:\n$$\n\\frac{d^{2}f}{d\\rho^{2}} = 2\\,\\alpha(T) + 6\\,\\beta\\,\\rho^{2}\n$$\nThe problem is concerned with the superconducting state, which exists for temperatures below the critical temperature, $T  T_{c}$. In this regime, the coefficient $\\alpha(T) = a_{0}(T - T_{c})$ is negative, i.e., $\\alpha(T)  0$.\n\nLet's analyze the stability of the two solutions for $T  T_{c}$:\nFor the solution $\\rho = 0$:\nThe second derivative is $\\left.\\frac{d^{2}f}{d\\rho^{2}}\\right|_{\\rho=0} = 2\\,\\alpha(T)$. Since $\\alpha(T)  0$, the second derivative is negative. This indicates that $\\rho=0$ (the normal state $\\psi_{0}=0$) is a local maximum of the free energy and is therefore unstable below the critical temperature.\n\nFor the solution $\\rho^{2} = -\\frac{\\alpha(T)}{\\beta}$:\nSince $\\alpha(T)  0$ and $\\beta > 0$, the right-hand side is positive, yielding a real solution for the amplitude $\\rho = \\sqrt{-\\frac{\\alpha(T)}{\\beta}}$. At this point, the second derivative is:\n$$\n\\frac{d^{2}f}{d\\rho^{2}} = 2\\,\\alpha(T) + 6\\,\\beta\\,\\left(-\\frac{\\alpha(T)}{\\beta}\\right) = 2\\,\\alpha(T) - 6\\,\\alpha(T) = -4\\,\\alpha(T)\n$$\nSince $\\alpha(T)  0$, the second derivative $-4\\,\\alpha(T)$ is positive. This indicates that this non-zero amplitude corresponds to a local minimum of the free energy, representing the stable equilibrium state.\n\nThus, for $T  T_{c}$, the equilibrium amplitude of the order parameter is:\n$$\n|\\psi| = \\sqrt{-\\frac{\\alpha(T)}{\\beta}}\n$$\nSubstituting the definition of $\\alpha(T)$:\n$$\n|\\psi| = \\sqrt{-\\frac{a_{0}(T - T_{c})}{\\beta}} = \\sqrt{\\frac{a_{0}(T_{c} - T)}{\\beta}}\n$$\nTo extract the critical exponent, we rewrite this expression to isolate the temperature dependence:\n$$\n|\\psi| = \\left(\\frac{a_{0}}{\\beta}\\right)^{1/2} (T_{c} - T)^{1/2}\n$$\nThe problem asks to find the critical exponent $\\beta_{\\mathrm{op}}$ defined by the asymptotic relation $|\\psi| \\sim (T_{c} - T)^{\\beta_{\\mathrm{op}}}$ as the temperature approaches the critical temperature from below ($T \\to T_{c}^{-}$).\n\nBy comparing the derived equilibrium amplitude with the defining relation, we have:\n$$\n\\left(\\frac{a_{0}}{\\beta}\\right)^{1/2} (T_{c} - T)^{1/2} \\sim (T_{c} - T)^{\\beta_{\\mathrm{op}}}\n$$\nThis comparison directly yields the value of the exponent:\n$$\n\\beta_{\\mathrm{op}} = \\frac{1}{2}\n$$\nThis is the classic mean-field value for the order parameter critical exponent.",
            "answer": "$$\n\\boxed{\\frac{1}{2}}\n$$"
        },
        {
            "introduction": "This practice explores a hallmark of superconductivity by incorporating the magnetic field into the Ginzburg-Landau functional. Your task is to derive the London penetration depth, the characteristic length scale for magnetic field expulsion, which is central to the Meissner effect. This exercise bridges the abstract theory with a fundamental, measurable property of superconductors and illustrates how coupling the order parameter to gauge fields gives rise to rich physical phenomena .",
            "id": "3766171",
            "problem": "Consider the Ginzburg–Landau (GL) free energy functional for a superconductor in the presence of an external magnetic field,\n$$\n\\mathcal{F}[\\psi,\\mathbf{A}] \\;=\\; \\int_{\\Omega} \\left[ \\alpha\\,|\\psi|^{2} \\;+\\; \\frac{\\beta}{2}\\,|\\psi|^{4} \\;+\\; \\frac{1}{2m}\\,\\left| \\left(-i\\hbar\\nabla - q\\,\\mathbf{A}\\right)\\psi \\right|^{2} \\;+\\; \\frac{|\\mathbf{B}|^{2}}{2\\mu_{0}} \\right]\\,\\mathrm{d}^{3}\\mathbf{r},\n$$\nwhere $\\psi$ is the complex order parameter, $\\mathbf{A}$ is the vector potential with $\\mathbf{B}=\\nabla\\times\\mathbf{A}$, $m$ is an effective mass, $q$ is the charge of the supercurrent carriers, and $\\mu_{0}$ is the vacuum permeability. Assume a static, weak-field configuration in which the order parameter has uniform magnitude and phase, so that $|\\psi|$ is spatially constant and $\\nabla \\arg\\psi=\\mathbf{0}$. Work in the Coulomb gauge $\\nabla\\cdot\\mathbf{A}=0$, and consider variations with respect to $\\mathbf{A}$ at fixed $|\\psi|$.\n\nUsing only the electromagnetic field energy and the supercurrent response that follows from the kinetic term in the GL functional under the stated assumptions, derive the linear field equation governing $\\mathbf{A}$ and deduce the characteristic magnetic field decay length (the London penetration depth) $\\lambda$ for a semi-infinite geometry in which a magnetic field $\\mathbf{B}$ penetrates from a planar boundary and decays into the bulk. Express $\\lambda$ as a closed-form analytic expression in terms of $m$, $\\mu_{0}$, $q$, and $|\\psi|$.\n\nBriefly interpret how $\\lambda$ depends on $|\\psi|$ based on your derivation. Give your final answer as a single symbolic expression for $\\lambda$; do not append units.",
            "solution": "The problem asks for the derivation of the linear field equation for the magnetic vector potential $\\mathbf{A}$ and the London penetration depth $\\lambda$ from the Ginzburg-Landau (GL) free energy functional.\n\nThe provided GL functional is:\n$$\n\\mathcal{F}[\\psi,\\mathbf{A}] \\;=\\; \\int_{\\Omega} \\left[ \\alpha\\,|\\psi|^{2} \\;+\\; \\frac{\\beta}{2}\\,|\\psi|^{4} \\;+\\; \\frac{1}{2m}\\,\\left| \\left(-i\\hbar\\nabla - q\\,\\mathbf{A}\\right)\\psi \\right|^{2} \\;+\\; \\frac{|\\mathbf{B}|^{2}}{2\\mu_{0}} \\right]\\,\\mathrm{d}^{3}\\mathbf{r}\n$$\nWe are instructed to consider only the electromagnetic field energy and the supercurrent response from the kinetic term, under the assumption that the order parameter $\\psi$ has a spatially constant magnitude $|\\psi|$ and phase, i.e., $\\nabla \\arg\\psi = \\mathbf{0}$.\n\nFirst, we simplify the kinetic energy density term, which is $\\frac{1}{2m}\\,\\left| \\left(-i\\hbar\\nabla - q\\,\\mathbf{A}\\right)\\psi \\right|^{2}$. The order parameter can be written as $\\psi = |\\psi|\\exp(i\\phi)$, where $\\phi$ is the phase. Its gradient is $\\nabla\\psi = (\\nabla|\\psi|)\\exp(i\\phi) + |\\psi|\\exp(i\\phi)(i\\nabla\\phi)$. The assumptions that $|\\psi|$ is constant and $\\nabla\\arg\\psi = \\nabla\\phi = \\mathbf{0}$ directly imply that $\\nabla\\psi = \\mathbf{0}$.\nSubstituting $\\nabla\\psi = \\mathbf{0}$ into the kinetic term operator gives:\n$$\n\\left(-i\\hbar\\nabla - q\\,\\mathbf{A}\\right)\\psi = -i\\hbar(\\nabla\\psi) - q\\mathbf{A}\\psi = -q\\mathbf{A}\\psi\n$$\nThe kinetic energy density thus simplifies to:\n$$\n\\frac{1}{2m} \\left| -q\\mathbf{A}\\psi \\right|^{2} = \\frac{1}{2m} q^{2} |\\mathbf{A}|^{2} |\\psi|^{2} = \\frac{q^{2}|\\psi|^{2}}{2m} |\\mathbf{A}|^{2}\n$$\nThe problem specifies that we should only consider this supercurrent response and the electromagnetic field energy, which is given by $\\frac{|\\mathbf{B}|^2}{2\\mu_0} = \\frac{|\\nabla \\times \\mathbf{A}|^2}{2\\mu_0}$. The potential energy terms $\\alpha|\\psi|^2$ and $\\frac{\\beta}{2}|\\psi|^4$ are constant because $|\\psi|$ is constant, so their variation with respect to $\\mathbf{A}$ is zero and they do not contribute to the field equation for $\\mathbf{A}$.\n\nThe effective free energy functional to be minimized with respect to $\\mathbf{A}$ is therefore:\n$$\n\\mathcal{F}_{eff}[\\mathbf{A}] = \\int_{\\Omega} \\left( \\frac{q^{2}|\\psi|^{2}}{2m} |\\mathbf{A}|^{2} + \\frac{1}{2\\mu_{0}} |\\nabla \\times \\mathbf{A}|^{2} \\right) \\mathrm{d}^{3}\\mathbf{r}\n$$\nTo find the governing equation for $\\mathbf{A}$, we compute the variational derivative of $\\mathcal{F}_{eff}$ with respect to $\\mathbf{A}$ and set it to zero, $\\delta\\mathcal{F}_{eff} = 0$. Consider a variation $\\mathbf{A} \\to \\mathbf{A} + \\delta\\mathbf{A}$:\n$$\n\\delta\\mathcal{F}_{eff} = \\int_{\\Omega} \\left( \\frac{q^{2}|\\psi|^{2}}{2m} \\delta(|\\mathbf{A}|^{2}) + \\frac{1}{2\\mu_{0}} \\delta(|\\nabla \\times \\mathbf{A}|^{2}) \\right) \\mathrm{d}^{3}\\mathbf{r}\n$$\nThe variations of the squared terms are $\\delta(|\\mathbf{A}|^2) = 2\\mathbf{A}\\cdot\\delta\\mathbf{A}$ and $\\delta(|\\nabla \\times \\mathbf{A}|^2) = 2(\\nabla \\times \\mathbf{A}) \\cdot (\\nabla \\times \\delta\\mathbf{A})$.\nSubstituting these into the expression for $\\delta\\mathcal{F}_{eff}$:\n$$\n\\delta\\mathcal{F}_{eff} = \\int_{\\Omega} \\left( \\frac{q^{2}|\\psi|^{2}}{m} \\mathbf{A}\\cdot\\delta\\mathbf{A} + \\frac{1}{\\mu_{0}} (\\nabla \\times \\mathbf{A}) \\cdot (\\nabla \\times \\delta\\mathbf{A}) \\right) \\mathrm{d}^{3}\\mathbf{r}\n$$\nWe use the vector calculus identity $\\mathbf{F}\\cdot(\\nabla \\times \\mathbf{G}) = \\mathbf{G}\\cdot(\\nabla \\times \\mathbf{F}) - \\nabla\\cdot(\\mathbf{F} \\times \\mathbf{G})$. Let $\\mathbf{G} = \\nabla \\times \\mathbf{A}$ and $\\mathbf{F} = \\delta\\mathbf{A}$. Then $(\\nabla \\times \\delta\\mathbf{A}) \\cdot (\\nabla \\times \\mathbf{A}) = \\delta\\mathbf{A} \\cdot (\\nabla \\times (\\nabla \\times \\mathbf{A})) + \\nabla\\cdot(\\delta\\mathbf{A} \\times (\\nabla \\times \\mathbf{A}))$. The integral of the divergence term can be converted to a surface integral via the divergence theorem. Assuming the variation $\\delta\\mathbf{A}$ vanishes on the boundary of the domain $\\Omega$, this surface integral is zero. The variation becomes:\n$$\n\\delta\\mathcal{F}_{eff} = \\int_{\\Omega} \\left( \\frac{q^{2}|\\psi|^{2}}{m} \\mathbf{A} + \\frac{1}{\\mu_{0}} \\nabla \\times (\\nabla \\times \\mathbf{A}) \\right) \\cdot \\delta\\mathbf{A} \\, \\mathrm{d}^{3}\\mathbf{r} = 0\n$$\nSince this must hold for any arbitrary variation $\\delta\\mathbf{A}$, the term in the parentheses must be zero. This gives us the linear field equation for $\\mathbf{A}$:\n$$\n\\frac{1}{\\mu_{0}} \\nabla \\times (\\nabla \\times \\mathbf{A}) + \\frac{q^{2}|\\psi|^{2}}{m} \\mathbf{A} = \\mathbf{0}\n$$\nThis equation can also be obtained by identifying the supercurrent density $\\mathbf{J}$. The general definition for the supercurrent is $\\mathbf{J} = -\\frac{\\delta \\mathcal{F}}{\\delta \\mathbf{A}}$. From our simplified kinetic term, we find $\\mathbf{J} = - \\frac{q^{2}|\\psi|^{2}}{m} \\mathbf{A}$. Combining this with the static Ampere's law, $\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J}$, and $\\mathbf{B} = \\nabla \\times \\mathbf{A}$, we get $\\nabla \\times (\\nabla \\times \\mathbf{A}) = -\\frac{\\mu_0 q^2 |\\psi|^2}{m} \\mathbf{A}$, which is identical to the equation derived variationally.\n\nTo deduce the penetration depth, we simplify the equation further using the vector identity $\\nabla \\times (\\nabla \\times \\mathbf{A}) = \\nabla(\\nabla \\cdot \\mathbf{A}) - \\nabla^2 \\mathbf{A}$. The problem specifies the Coulomb gauge $\\nabla \\cdot \\mathbf{A} = 0$, so the equation simplifies to:\n$$\n-\\frac{1}{\\mu_{0}} \\nabla^2 \\mathbf{A} + \\frac{q^{2}|\\psi|^{2}}{m} \\mathbf{A} = \\mathbf{0}\n$$\nRearranging this gives:\n$$\n\\nabla^2 \\mathbf{A} = \\frac{\\mu_{0} q^{2}|\\psi|^{2}}{m} \\mathbf{A}\n$$\nThis is a vector form of a reaction-diffusion equation. For a one-dimensional geometry, such as a field penetrating along the $z$-axis, this becomes a simple ordinary differential equation with solutions of the form $\\exp(\\pm z/\\lambda)$. The general form of the equation is $\\nabla^2 \\mathbf{A} = \\frac{1}{\\lambda^{2}}\\mathbf{A}$, where $\\lambda$ is the characteristic decay length. By comparing our derived equation with this general form, we can identify $\\lambda^{-2}$:\n$$\n\\frac{1}{\\lambda^{2}} = \\frac{\\mu_{0} q^{2}|\\psi|^{2}}{m}\n$$\nSolving for $\\lambda$, we find the London penetration depth:\n$$\n\\lambda = \\sqrt{\\frac{m}{\\mu_{0} q^{2}|\\psi|^{2}}}\n$$\nThe interpretation of this result is that $\\lambda$ is inversely proportional to $|\\psi|$. In the GL theory, $|\\psi|^2$ represents the density of the superconducting charge carriers (Cooper pairs). A larger value of $|\\psi|$ implies a higher density of carriers. These carriers create screening currents that oppose the external magnetic field. A higher density of carriers can produce stronger screening currents, which are more effective at canceling the field, leading to a more rapid exponential decay of the field into the superconductor. Thus, a larger $|\\psi|$ results in a smaller penetration depth $\\lambda$. Conversely, as $|\\psi| \\to 0$ (e.g., as temperature approaches the critical temperature), $\\lambda \\to \\infty$, and the magnetic field can fully penetrate the material, destroying the superconducting state.",
            "answer": "$$\\boxed{\\sqrt{\\frac{m}{\\mu_{0} q^{2} |\\psi|^{2}}}}$$"
        },
        {
            "introduction": "Moving from analytical theory to computational practice, this advanced exercise guides you through the numerical simulation of a superconductor in a magnetic field. You will implement a gradient descent algorithm to solve the Ginzburg-Landau equations and observe the formation of quantum vortices, which are topological defects in the order parameter field. This hands-on problem  illustrates how computational methods are used to explore complex, spatially varying phenomena that are often intractable analytically.",
            "id": "3766232",
            "problem": "Consider the extreme type-II limit of the Ginzburg-Landau (GL) theory for a two-dimensional superconducting strip, where magnetic field variations due to supercurrents are neglected. In this limit, the vector potential is externally imposed and the GL free energy functional reduces to the following nondimensionalized form on a rectangular domain $\\Omega = [0,L_x] \\times [0,W]$:\n$$\n\\mathcal{F}[\\psi] \\;=\\; \\int_{\\Omega} \\left( \\left| (\\nabla - i \\mathbf{A}) \\psi \\right|^2 \\;+\\; \\frac{1}{2} \\left( 1 - |\\psi|^2 \\right)^2 \\right) \\, d^2\\mathbf{r},\n$$\nwhere $\\psi(\\mathbf{r})$ is the complex order parameter, $\\mathbf{A}$ is the vector potential corresponding to a uniform perpendicular magnetic field of nondimensional strength $B$, and all quantities are dimensionless. Use the Landau gauge $\\mathbf{A} = (-B y, 0)$ so that $A_x = -B y$ and $A_y = 0$. Impose periodic boundary conditions along the $x$-direction and the de Gennes (superconductor–insulator) boundary condition along the $y$-direction:\n$$\n\\mathbf{n} \\cdot (\\nabla - i \\mathbf{A}) \\psi \\;=\\; 0 \\quad \\text{on} \\quad y=0 \\quad \\text{and} \\quad y=W,\n$$\nwhere $\\mathbf{n}$ is the outward unit normal. Angles must be treated in radians.\n\nYou must minimize $\\mathcal{F}[\\psi]$ numerically on a uniform discrete grid by gradient flow (steepest descent) starting from a slightly perturbed uniform initial state. Discretize the covariant derivatives with gauge-invariant link variables. On a uniform grid with $N_x$ points in $x$ and $N_y$ points in $y$, spacings $\\Delta x$ and $\\Delta y$ (use $\\Delta x = \\Delta y$), define the forward covariant difference operators:\n$$\nD_x \\psi_{i,j} \\;=\\; U_{x,j} \\, \\psi_{i+1,j} - \\psi_{i,j}, \\quad U_{x,j} \\;=\\; e^{-i A_x(j) \\Delta x} \\;=\\; e^{i B \\, y_j \\, \\Delta x},\n$$\n$$\nD_y \\psi_{i,j} \\;=\\; \\psi_{i,j+1} - \\psi_{i,j},\n$$\nwith periodic indexing in $i$ and $y_0 = 0$, $y_j = j \\, \\Delta y$. The adjoint operators on the grid yield the gauge-covariant discrete Laplacian components:\n$$\nD_x^\\dagger D_x \\psi_{i,j} \\;=\\; U_{x,j} \\, \\psi_{i+1,j} + U_{x,j}^\\ast \\, \\psi_{i-1,j} - 2 \\psi_{i,j},\n$$\n$$\nD_y^\\dagger D_y \\psi_{i,j} \\;=\\; \\psi_{i,j+1} + \\psi_{i,j-1} - 2 \\psi_{i,j},\n$$\nwhere the de Gennes boundary condition is enforced by reflection in $y$ so that $\\psi_{i,-1} = \\psi_{i,0}$ and $\\psi_{i,N_y} = \\psi_{i,N_y-1}$. The steepest descent evolution (a nondimensionalized form of the time-dependent GL gradient flow) is\n$$\n\\frac{\\partial \\psi}{\\partial t} \\;=\\; - \\frac{\\delta \\mathcal{F}}{\\delta \\psi^\\ast} \\;=\\; - \\left( D_x^\\dagger D_x \\psi + D_y^\\dagger D_y \\psi - \\left(1 - |\\psi|^2\\right)\\psi \\right),\n$$\nwhich you must discretize explicitly with a time step $\\Delta t$:\n$$\n\\psi^{(n+1)} \\;=\\; \\psi^{(n)} \\;-\\; \\Delta t \\left( D_x^\\dagger D_x \\psi^{(n)} + D_y^\\dagger D_y \\psi^{(n)} - \\left(1 - \\left|\\psi^{(n)}\\right|^2\\right)\\psi^{(n)} \\right).\n$$\n\nTo quantify vortex entry and boundary-induced patterning, compute the total gauge-invariant vorticity after convergence, using gauge-invariant phase differences on links:\n$$\n\\delta\\theta_x(i,j) \\;=\\; \\mathrm{wrap}\\left( \\arg(\\psi_{i+1,j}) - \\arg(\\psi_{i,j}) - \\arg(U_{x,j}) \\right), \\quad \\delta\\theta_y(i,j) \\;=\\; \\mathrm{wrap}\\left( \\arg(\\psi_{i,j+1}) - \\arg(\\psi_{i,j}) \\right),\n$$\nwhere $\\mathrm{wrap}(\\cdot)$ maps angles to $(-\\pi,\\pi]$. The plaquette vorticity (gauge-invariant circulation) is\n$$\n\\omega(i,j) \\;=\\; \\mathrm{wrap}\\left( \\delta\\theta_x(i,j) + \\delta\\theta_y(i+1,j) - \\delta\\theta_x(i,j+1) - \\delta\\theta_y(i,j) \\right),\n$$\nfor $i \\in \\{0,\\dots,N_x-1\\}$ with periodic wrap in $i$ and $j \\in \\{0,\\dots,N_y-2\\}$. The net integer vortex count is then\n$$\nN_v \\;=\\; \\mathrm{round}\\left( \\frac{1}{2\\pi} \\sum_{i=0}^{N_x-1} \\sum_{j=0}^{N_y-2} \\omega(i,j) \\right).\n$$\n\nYour program must implement the above discretization with the following fixed grid and numerical parameters, in dimensionless units:\n- Use $N_x = 24$, $N_y = 12$, $\\Delta x = \\Delta y = 1$.\n- Use an explicit gradient descent with $\\Delta t = 0.05$ and a total of $N_{\\mathrm{iter}} = 400$ iterations per test.\n- Initialize $\\psi$ as $\\psi_{i,j}^{(0)} = 1 + \\epsilon \\, \\eta_{i,j}$ with $\\epsilon = 10^{-2}$ and $\\eta_{i,j}$ a complex Gaussian perturbation with zero mean and unit variance, using a fixed random seed for reproducibility.\n\nTest suite:\n- Case $1$: $B = 0.0000$ (very low field; expected vortex-free).\n- Case $2$: $B = \\frac{2\\pi}{N_x (N_y - 1)} \\approx 0.0238$ (approximately one flux quantum across the strip interior).\n- Case $3$: $B = \\frac{4\\pi}{N_x (N_y - 1)} \\approx 0.0476$ (approximately two flux quanta).\n- Case $4$: $B = \\frac{6\\pi}{N_x (N_y - 1)} \\approx 0.0714$ (approximately three flux quanta).\n- Case $5$ (edge coverage, non-integer flux): $B = \\frac{3\\pi}{N_x (N_y - 1)} \\approx 0.0357$.\n\nFor each case, after minimizing $\\mathcal{F}[\\psi]$, compute $N_v$ as defined above. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[n_1,n_2,n_3,n_4,n_5]$, where each $n_k$ is the integer vortex count for the corresponding test case. All quantities are dimensionless; no physical unit conversion is required, and all angles are in radians.",
            "solution": "The problem requires the numerical minimization of a Ginzburg-Landau (GL) free energy functional for a two-dimensional superconducting strip. This is achieved by simulating the gradient flow of the order parameter, $\\psi$, using an explicit time-stepping method on a discrete grid. The primary goal is to compute the number of emergent vortices, $N_v$, for different strengths of an external magnetic field, $B$. The problem is well-posed, scientifically sound, and provides a complete set of instructions for the numerical implementation.\n\nThe Ginzburg-Landau free energy functional on the domain $\\Omega = [0,L_x] \\times [0,W]$ is given by:\n$$\n\\mathcal{F}[\\psi] \\;=\\; \\int_{\\Omega} \\left( \\left| (\\nabla - i \\mathbf{A}) \\psi \\right|^2 \\;+\\; \\frac{1}{2} \\left( 1 - |\\psi|^2 \\right)^2 \\right) \\, d^2\\mathbf{r}\n$$\nHere, $\\psi$ is the complex order parameter, and $\\mathbf{A} = (-B y, 0)$ is the vector potential in the Landau gauge for a uniform magnetic field of strength $B$.\n\nThe minimization of $\\mathcal{F}[\\psi]$ is performed using a steepest descent (gradient flow) method. This corresponds to evolving $\\psi$ in fictitious time $t$ according to the time-dependent Ginzburg-Landau equation:\n$$\n\\frac{\\partial \\psi}{\\partial t} \\;=\\; - \\frac{\\delta \\mathcal{F}}{\\delta \\psi^\\ast}\n$$\nThe variational derivative $\\frac{\\delta \\mathcal{F}}{\\delta \\psi^\\ast}$ is given in the problem statement, leading to the evolution equation:\n$$\n\\frac{\\partial \\psi}{\\partial t} \\;=\\; (\\nabla - i \\mathbf{A})^2 \\psi + (1 - |\\psi|^2)\\psi\n$$\nThe term $(\\nabla - i \\mathbf{A})^2 \\psi$ is the gauge-covariant Laplacian. The problem provides a specific an explicit discretization of this equation on a uniform grid, which we will implement.\n\nThe domain is discretized into a grid of size $N_x \\times N_y$ with lattice spacings $\\Delta x = \\Delta y = 1$. The order parameter $\\psi(\\mathbf{r})$ becomes a complex array $\\psi_{i,j}$, where $i \\in \\{0, \\dots, N_x-1\\}$ and $j \\in \\{0, \\dots, N_y-1\\}$.\n\nThe time evolution is discretized using an explicit forward Euler scheme with a time step $\\Delta t$:\n$$\n\\psi^{(n+1)}_{i,j} \\;=\\; \\psi^{(n)}_{i,j} \\;+\\; \\Delta t \\cdot \\left( \\frac{\\partial \\psi}{\\partial t} \\right)_{i,j}^{(n)}\n$$\nThe discrete form of the right-hand side, representing $-\\frac{\\delta \\mathcal{F}}{\\delta \\psi^\\ast}$, is given as:\n$$\n-\\frac{\\delta \\mathcal{F}}{\\delta \\psi^\\ast} \\to (D_x^\\dagger D_x \\psi)_{i,j} + (D_y^\\dagger D_y \\psi)_{i,j} - \\left(1 - |\\psi_{i,j}|^2\\right)\\psi_{i,j}\n$$\nThe discrete gauge-covariant Laplacian components are specified as:\n1.  **x-direction:** To maintain gauge invariance under discretization, a link variable $U_{x,j} = e^{i B y_j \\Delta x}$ is introduced, where $y_j = j \\Delta y$. The Laplacian is:\n    $$\n    (D_x^\\dagger D_x \\psi)_{i,j} \\;=\\; U_{x,j} \\, \\psi_{i+1,j} + U_{x,j}^\\ast \\, \\psi_{i-1,j} - 2 \\psi_{i,j}\n    $$\n    Periodic boundary conditions are applied in the $x$-direction, so indices $i$ are evaluated modulo $N_x$.\n\n2.  **y-direction:** The vector potential has no component in the $y$-direction ($A_y=0$), so the link variables are unity. The Laplacian is:\n    $$\n    (D_y^\\dagger D_y \\psi)_{i,j} \\;=\\; \\psi_{i,j+1} + \\psi_{i,j-1} - 2 \\psi_{i,j}\n    $$\n    The de Gennes (superconductor-insulator) boundary conditions, $\\partial_y \\psi = 0$ at $y=0$ and $y=W$, are implemented by reflecting the grid: $\\psi_{i,-1} = \\psi_{i,0}$ at the bottom boundary ($j=0$) and $\\psi_{i,N_y} = \\psi_{i,N_y-1}$ at the top boundary ($j=N_y-1$). This simplifies the Laplacian at the boundaries:\n    - At $j=0$: $(D_y^\\dagger D_y \\psi)_{i,0} = \\psi_{i,1} + \\psi_{i,-1} - 2\\psi_{i,0} = \\psi_{i,1} - \\psi_{i,0}$.\n    - At $j=N_y-1$: $(D_y^\\dagger D_y \\psi)_{i,N_y-1} = \\psi_{i,N_y} + \\psi_{i,N_y-2} - 2\\psi_{i,N_y-1} = \\psi_{i,N_y-2} - \\psi_{i,N_y-1}$.\n\nThe simulation starts from an initial state $\\psi_{i,j}^{(0)} = 1 + \\epsilon \\, \\eta_{i,j}$, where $\\epsilon = 10^{-2}$ is a small perturbation amplitude and $\\eta_{i,j}$ is a complex random number from a Gaussian distribution with zero mean and unit variance. A fixed random seed is used for reproducibility. The system is evolved for $N_{\\mathrm{iter}} = 400$ steps with a time step of $\\Delta t=0.05$.\n\nAfter the simulation converges to a minimum energy state, the number of vortices, $N_v$, is calculated. A vortex is a topological defect where the phase of $\\psi$ changes by a multiple of $2\\pi$ around a closed loop. On the lattice, this is computed by summing the gauge-invariant circulation around each elementary plaquette.\n\nThe gauge-invariant phase differences across links are:\n$$\n\\delta\\theta_x(i,j) = \\mathrm{wrap}\\left( \\arg(\\psi_{i+1,j}) - \\arg(\\psi_{i,j}) - \\arg(U_{x,j}) \\right)\n$$\n$$\n\\delta\\theta_y(i,j) = \\mathrm{wrap}\\left( \\arg(\\psi_{i,j+1}) - \\arg(\\psi_{i,j}) \\right)\n$$\nThe function $\\mathrm{wrap}(\\cdot)$ maps an angle to the interval $(-\\pi, \\pi]$.\nThe plaquette vorticity for the cell with its bottom-left corner at $(i,j)$ is the sum of phase differences around it:\n$$\n\\omega(i,j) = \\mathrm{wrap}\\left( \\delta\\theta_x(i,j) + \\delta\\theta_y(i+1,j) - \\delta\\theta_x(i,j+1) - \\delta\\theta_y(i,j) \\right)\n$$\nThis is calculated for each plaquette, indexed by $i \\in \\{0, \\dots, N_x-1\\}$ and $j \\in \\{0, \\dots, N_y-2\\}$. The total vortex count is the sum of all plaquette vorticities, normalized by $2\\pi$ and rounded to the nearest integer:\n$$\nN_v = \\mathrm{round}\\left( \\frac{1}{2\\pi} \\sum_{i=0}^{N_x-1} \\sum_{j=0}^{N_y-2} \\omega(i,j) \\right)\n$$\nThis procedure is repeated for each value of $B$ specified in the test suite. All calculations use the provided dimensionless parameters: $N_x = 24$, $N_y = 12$, $\\Delta x = \\Delta y = 1$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Ginzburg-Landau equation using gradient descent\n    and computes the vortex count for several magnetic field strengths.\n    \"\"\"\n    \n    # Fixed grid and numerical parameters\n    Nx = 24\n    Ny = 12\n    dx = 1.0\n    dy = 1.0\n    dt = 0.05\n    N_iter = 400\n    epsilon = 1e-2\n    \n    # Define test cases for the magnetic field B\n    B_denom = Nx * (Ny - 1)\n    test_cases = [\n        0.0,\n        (2 * np.pi) / B_denom,\n        (4 * np.pi) / B_denom,\n        (6 * np.pi) / B_denom,\n        (3 * np.pi) / B_denom,\n    ]\n\n    results = []\n\n    # Use a fixed random seed for reproducibility\n    np.random.seed(0)\n\n    # Grid coordinates\n    y_coords = np.arange(Ny) * dy\n\n    # Angle wrapping function to map angles to (-pi, pi]\n    def wrap_angle(angles):\n        return (angles + np.pi) % (2 * np.pi) - np.pi\n\n    for B in test_cases:\n        # Initialize the order parameter psi\n        # psi is a complex grid of size (Nx, Ny)\n        noise_real = np.random.randn(Nx, Ny)\n        noise_imag = np.random.randn(Nx, Ny)\n        psi = 1.0 + epsilon * (noise_real + 1j * noise_imag)\n\n        # Pre-compute link variables U_x, which depend only on y\n        # U_x is broadcastable to the shape of psi\n        arg_U_x = (B * y_coords * dx).reshape(1, Ny)\n        U_x = np.exp(1j * arg_U_x)\n        U_x_conj = U_x.conj()\n\n        # Perform gradient descent (explicit Euler time evolution)\n        for _ in range(N_iter):\n            # Calculate the gauge-covariant Laplacian in the x-direction\n            # Periodic boundary conditions are handled by np.roll\n            psi_xp1 = np.roll(psi, -1, axis=0)\n            psi_xm1 = np.roll(psi, 1, axis=0)\n            lap_x = U_x * psi_xp1 + U_x_conj * psi_xm1 - 2.0 * psi\n\n            # Calculate the Laplacian in the y-direction\n            # Enforce de Gennes (Neumann) boundary conditions\n            lap_y = np.zeros_like(psi)\n            psi_yp1 = np.roll(psi, -1, axis=1)\n            psi_ym1 = np.roll(psi, 1, axis=1)\n            \n            # Interior points\n            lap_y[:, 1:-1] = psi_yp1[:, 1:-1] + psi_ym1[:, 1:-1] - 2.0 * psi[:, 1:-1]\n            # Boundary at y=0 (j=0) as per problem spec\n            lap_y[:, 0] = psi[:, 1] - psi[:, 0]\n            # Boundary at y=W (j=Ny-1) as per problem spec\n            lap_y[:, -1] = psi[:, -2] - psi[:, -1]\n            \n            # Calculate the potential term\n            potential_term = (1.0 - np.abs(psi)**2) * psi\n\n            # Gradient of the free energy functional (RHS of the evolution eq.)\n            d_psi_dt = lap_x + lap_y + potential_term\n\n            # Update psi using forward Euler step\n            psi += dt * d_psi_dt\n\n        # --- Vortex Counting ---\n        # Calculate gauge-invariant phase differences on links\n        arg_psi = np.angle(psi)\n\n        # Phase difference on horizontal links (size Nx, Ny)\n        d_theta_x = wrap_angle(np.roll(arg_psi, -1, axis=0) - arg_psi - arg_U_x)\n\n        # Phase difference on vertical links (size Nx, Ny-1)\n        # Only defined for links inside the domain\n        d_theta_y = wrap_angle(arg_psi[:, 1:] - arg_psi[:, :-1])\n\n        # Calculate plaquette vorticity (gauge-invariant circulation)\n        # A plaquette (i,j) is bounded by points (i,j), (i+1,j), (i+1,j+1), (i,j+1)\n        # The sum is over i=0..Nx-1 and j=0..Ny-2. Omega has shape (Nx, Ny-1)\n        omega = wrap_angle(\n            d_theta_x[:, :-1] + \n            np.roll(d_theta_y, -1, axis=0) - \n            d_theta_x[:, 1:] - \n            d_theta_y\n        )\n\n        # Sum over all plaquettes and normalize to get the net vortex count\n        total_vorticity = np.sum(omega)\n        Nv = int(np.round(total_vorticity / (2 * np.pi)))\n        results.append(Nv)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}