{
    "hands_on_practices": [
        {
            "introduction": "The foundation of any phase-field model lies in the thermodynamic free energy of the system. This exercise  builds your skill in interpreting this fundamental quantity by connecting the mathematical form of a free energy density function to the tangible boundaries on a phase diagram. By calculating the binodal and spinodal compositions, you will practice identifying the limits of phase coexistence and thermodynamic stability, which are the essential driving forces for microstructure evolution.",
            "id": "2847472",
            "problem": "Consider a binary, compositionally symmetric regular solution with molar free energy density\n$$\nf(c) = RT\\big[c\\ln c + (1-c)\\ln(1-c)\\big] + \\Omega\\,c(1-c),\n$$\nwhere $c \\in (0,1)$ is the solute mole fraction, $R$ is the universal gas constant, $T$ is the absolute temperature, and $\\Omega$ is a temperature-independent interaction parameter. Using first principles of equilibrium thermodynamics for phase coexistence (equality of chemical potentials and the common-tangent construction) and the definition of the spinodal (vanishing curvature of the free energy density), determine the two binodal compositions and the two spinodal compositions at temperature $T$ and interaction parameter $\\Omega$. Assume $T = 800\\,\\mathrm{K}$, $\\Omega = 24.0 \\times 10^{3}\\,\\mathrm{J\\,mol^{-1}}$, and $R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$. Because the free energy is symmetric with respect to $c = 1/2$, report the results as $c_{\\mathrm{b,low}}$, $c_{\\mathrm{b,high}}$, $c_{\\mathrm{s,low}}$, and $c_{\\mathrm{s,high}}$, where $c_{\\mathrm{b,high}} = 1 - c_{\\mathrm{b,low}}$ and $c_{\\mathrm{s,high}} = 1 - c_{\\mathrm{s,low}}$. Round each composition to four significant figures and express them as pure decimals (no units). Provide your final answer as a single row vector in the order $\\big(c_{\\mathrm{b,low}},\\,c_{\\mathrm{b,high}},\\,c_{\\mathrm{s,low}},\\,c_{\\mathrm{s,high}}\\big)$.",
            "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It is a standard problem in the thermodynamics of materials. I will now proceed with the solution.\n\nThe molar free energy density of the binary regular solution is given by:\n$$\nf(c) = RT\\big[c\\ln c + (1-c)\\ln(1-c)\\big] + \\Omega\\,c(1-c)\n$$\nwhere $c$ is the solute mole fraction, $R$ is the universal gas constant, $T$ is the absolute temperature, and $\\Omega$ is the interaction parameter. The given numerical values are $T = 800\\,\\mathrm{K}$, $\\Omega = 24.0 \\times 10^{3}\\,\\mathrm{J\\,mol^{-1}}$, and $R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$. The system exhibits compositional symmetry about $c = 0.5$, which means $f(c) = f(1-c)$.\n\nFirst, we determine the spinodal compositions. The spinodal curve defines the limit of local stability of a phase against small composition fluctuations. This limit is reached when the curvature of the free energy density becomes zero. Mathematically, this condition is expressed as:\n$$\n\\frac{d^2f}{dc^2} = 0\n$$\nTo apply this condition, we first compute the first and second derivatives of $f(c)$ with respect to $c$.\nThe first derivative is:\n$$\n\\frac{df}{dc} = \\frac{d}{dc} \\left( RT\\big[c\\ln c + (1-c)\\ln(1-c)\\big] + \\Omega\\,c(1-c) \\right)\n$$\n$$\n\\frac{df}{dc} = RT\\left[ (\\ln c + c\\cdot\\frac{1}{c}) + (-\\ln(1-c) + (1-c)\\cdot\\frac{-1}{1-c}) \\right] + \\Omega(1 - 2c)\n$$\n$$\n\\frac{df}{dc} = RT\\left[ \\ln c + 1 - \\ln(1-c) - 1 \\right] + \\Omega(1 - 2c) = RT\\ln\\left(\\frac{c}{1-c}\\right) + \\Omega(1 - 2c)\n$$\nThe second derivative is:\n$$\n\\frac{d^2f}{dc^2} = \\frac{d}{dc} \\left( RT\\ln\\left(\\frac{c}{1-c}\\right) + \\Omega(1 - 2c) \\right)\n$$\n$$\n\\frac{d^2f}{dc^2} = RT \\frac{d}{dc} \\left( \\ln c - \\ln(1-c) \\right) - 2\\Omega\n$$\n$$\n\\frac{d^2f}{dc^2} = RT\\left( \\frac{1}{c} - \\frac{-1}{1-c} \\right) - 2\\Omega = RT\\left( \\frac{1}{c} + \\frac{1}{1-c} \\right) - 2\\Omega = \\frac{RT}{c(1-c)} - 2\\Omega\n$$\nSetting the second derivative to zero to find the spinodal compositions, denoted by $c_s$:\n$$\n\\frac{RT}{c_s(1-c_s)} - 2\\Omega = 0 \\implies c_s(1-c_s) = \\frac{RT}{2\\Omega}\n$$\nThis is a quadratic equation for $c_s$:\n$$\nc_s^2 - c_s + \\frac{RT}{2\\Omega} = 0\n$$\nThe solutions are given by the quadratic formula:\n$$\nc_s = \\frac{1 \\pm \\sqrt{1 - 4\\left(\\frac{RT}{2\\Omega}\\right)}}{2} = \\frac{1 \\pm \\sqrt{1 - \\frac{2RT}{\\Omega}}}{2}\n$$\nSubstituting the given values:\n$$\n\\frac{2RT}{\\Omega} = \\frac{2 \\times 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}} \\times 800\\,\\mathrm{K}}{24.0 \\times 10^{3}\\,\\mathrm{J\\,mol^{-1}}} = \\frac{13302.4}{24000} \\approx 0.554267\n$$\nThe spinodal compositions are:\n$$\nc_s = \\frac{1 \\pm \\sqrt{1 - 0.554267}}{2} = \\frac{1 \\pm \\sqrt{0.445733}}{2} = \\frac{1 \\pm 0.667632}{2}\n$$\nThis gives the two spinodal compositions:\n$$\nc_{\\mathrm{s,low}} = \\frac{1 - 0.667632}{2} = 0.166184\n$$\n$$\nc_{\\mathrm{s,high}} = \\frac{1 + 0.667632}{2} = 0.833816\n$$\nRounding to four significant figures, we get $c_{\\mathrm{s,low}} = 0.1662$ and $c_{\\mathrm{s,high}} = 0.8338$.\n\nSecond, we determine the binodal compositions. The binodal curve defines the compositions of phases in thermodynamic equilibrium. For a binary system, these compositions, $c_1$ and $c_2$, are found by the common-tangent construction, which is mathematically equivalent to the equality of the chemical potentials of each component in the two phases:\n$$\n\\mu_A(c_1) = \\mu_A(c_2) \\quad \\text{and} \\quad \\mu_B(c_1) = \\mu_B(c_2)\n$$\nwhere $\\mu_A = f(c) - c\\frac{df}{dc}$ and $\\mu_B = f(c) + (1-c)\\frac{df}{dc}$. This system of equations leads to the conditions:\n$$\n\\frac{df}{dc}\\bigg|_{c_1} = \\frac{df}{dc}\\bigg|_{c_2} \\quad \\text{and} \\quad \\frac{f(c_2) - f(c_1)}{c_2 - c_1} = \\frac{df}{dc}\\bigg|_{c_1}\n$$\nDue to the compositional symmetry of the free energy function, $f(c) = f(1-c)$, the two equilibrium compositions must be symmetric with respect to $c=0.5$. Let $c_1 = c_b$ and $c_2 = 1-c_b$.\nThe symmetry of the function implies that its derivative is antisymmetric about $c=0.5$, i.e., $\\frac{df}{dc}(c) = -\\frac{df}{dc}(1-c)$.\nThe first equilibrium condition, $\\frac{df}{dc}(c_b) = \\frac{df}{dc}(1-c_b)$, becomes $\\frac{df}{dc}(c_b) = -\\frac{df}{dc}(c_b)$, which implies $2\\frac{df}{dc}(c_b) = 0$, so $\\frac{df}{dc}(c_b) = 0$.\nIf $\\frac{df}{dc}(c_b) = 0$, the second equilibrium condition is also satisfied, as $f(c_b)=f(1-c_b)$ due to symmetry, making the left-hand side zero.\nTherefore, for this symmetric system, the binodal compositions $c_b$ are the solutions to the equation:\n$$\n\\frac{df}{dc} = RT\\ln\\left(\\frac{c_b}{1-c_b}\\right) + \\Omega(1 - 2c_b) = 0\n$$\nRearranging the equation:\n$$\n\\ln\\left(\\frac{c_b}{1-c_b}\\right) = -\\frac{\\Omega}{RT}(1 - 2c_b) = \\frac{\\Omega}{RT}(2c_b - 1)\n$$\nWe need to solve this transcendental equation for $c_b$. Let's evaluate the constant term:\n$$\n\\frac{\\Omega}{RT} = \\frac{24.0 \\times 10^{3}\\,\\mathrm{J\\,mol^{-1}}}{8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}} \\times 800\\,\\mathrm{K}} = \\frac{24000}{6651.2} \\approx 3.60835\n$$\nThe equation to solve is:\n$$\n\\ln\\left(\\frac{c_b}{1-c_b}\\right) = 3.60835(2c_b - 1)\n$$\nOne trivial solution is $c_b = 0.5$, which corresponds to the unstable maximum of the free energy. The two other solutions are the stable binodal compositions. Let $x = 2c_b - 1$. The equation transforms to $c_b = (x+1)/2$ and $1-c_b = (1-x)/2$.\n$$\n\\ln\\left(\\frac{1+x}{1-x}\\right) = \\frac{\\Omega}{RT}x \\implies 2\\,\\text{arctanh}(x) = \\frac{\\Omega}{RT}x \\implies \\text{arctanh}(x) = \\frac{\\Omega}{2RT}x\n$$\nWith $\\frac{\\Omega}{2RT} \\approx 1.804175$, we solve $x = \\tanh(1.804175\\,x)$ numerically. The non-zero solutions are found to be $x \\approx \\pm 0.933374$.\nThe binodal compositions are calculated from these values of $x$:\n$$\nc_{\\mathrm{b,low}} = \\frac{1 - 0.933374}{2} = 0.033313\n$$\n$$\nc_{\\mathrm{b,high}} = \\frac{1 + 0.933374}{2} = 0.966687\n$$\nRounding to four significant figures, we get $c_{\\mathrm{b,low}} = 0.03331$ and $c_{\\mathrm{b,high}} = 0.9667$.\n\nIn summary, the calculated compositions are:\nBinodal: $c_{\\mathrm{b,low}} = 0.03331$, $c_{\\mathrm{b,high}} = 0.9667$.\nSpinodal: $c_{\\mathrm{s,low}} = 0.1662$, $c_{\\mathrm{s,high}} = 0.8338$.\nThese values adhere to the expected order $c_{\\mathrm{b,low}}  c_{\\mathrm{s,low}}  0.5  c_{\\mathrm{s,high}}  c_{\\mathrm{b,high}}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.03331  0.9667  0.1662  0.8338\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "With the thermodynamic driving forces established, we turn to the kinetics of phase separation as described by the Cahn-Hilliard equation. This practice  guides you through a linear stability analysis, a crucial technique for understanding how an initially homogeneous phase begins to decompose. Deriving the dispersion relation $\\omega(k)$ will reveal how the growth rate of composition fluctuations depends on their wavelength, explaining the emergence of a characteristic length scale during the early stages of spinodal decomposition.",
            "id": "2508094",
            "problem": "Consider an isothermal binary mixture described by a conserved composition field $c(\\mathbf{x},t)$ evolving by diffusive dynamics. The system free energy is given by the square-gradient functional\n$$\nF[c] \\;=\\; \\int_{\\Omega} \\left( f_{0}(c) \\;+\\; \\frac{\\kappa}{2}\\,|\\nabla c|^{2} \\right)\\,\\mathrm{d}V,\n$$\nwhere $\\kappa0$ is a constant gradient-energy coefficient and $f_{0}(c)$ is a smooth bulk free-energy density. The chemical potential is defined by the variational derivative $\\mu \\equiv \\delta F/\\delta c$, the diffusive flux obeys linear Onsager kinetics $\\mathbf{J} = - M \\nabla \\mu$ with constant mobility $M0$, and mass conservation requires $\\partial_{t} c + \\nabla\\!\\cdot \\mathbf{J} = 0$.\n\nLet $c_{0}$ be a spatially homogeneous stationary state. Introduce a small-amplitude plane-wave perturbation\n$$\n\\delta c(\\mathbf{x},t) = \\varepsilon\\,\\phi\\,\\exp\\!\\left(i\\,\\mathbf{k}\\!\\cdot\\!\\mathbf{x} + \\omega t\\right)\n$$\nwith $0\\varepsilon\\ll 1$, real wavevector $\\mathbf{k}$ of magnitude $k=|\\mathbf{k}|$, and complex growth rate $\\omega$. Linearize the governing equations about $c_{0}$ and eliminate $\\phi$ to obtain the dispersion relation $\\omega(k)$.\n\nUsing only the definitions and laws stated above, derive the closed-form analytic expression for $\\omega(k)$ in terms of $M$, $\\kappa$, $f_{0}''(c_{0})$, and $k$. Express your final answer as a single analytic expression for $\\omega(k)$ (no units required).",
            "solution": "The problem statement is submitted to validation.\n\n**Step 1: Extract Givens**\nThe following information is provided:\n-   A system is described by a conserved composition field $c(\\mathbf{x},t)$.\n-   The total free energy functional is: $F[c] = \\int_{\\Omega} \\left( f_{0}(c) + \\frac{\\kappa}{2}\\,|\\nabla c|^{2} \\right)\\,\\mathrm{d}V$.\n-   The gradient-energy coefficient $\\kappa$ is a positive constant: $\\kappa  0$.\n-   $f_{0}(c)$ is a smooth bulk free-energy density.\n-   The chemical potential is the variational derivative of the free energy: $\\mu \\equiv \\delta F/\\delta c$.\n-   The diffusive flux follows linear Onsager kinetics: $\\mathbf{J} = - M \\nabla \\mu$.\n-   The mobility $M$ is a positive constant: $M  0$.\n-   Mass is conserved, obeying the continuity equation: $\\partial_{t} c + \\nabla\\!\\cdot \\mathbf{J} = 0$.\n-   A spatially homogeneous stationary state exists, denoted by $c_{0}$.\n-   A small-amplitude plane-wave perturbation is introduced: $\\delta c(\\mathbf{x},t) = \\varepsilon\\,\\phi\\,\\exp\\!\\left(i\\,\\mathbf{k}\\!\\cdot\\!\\mathbf{x} + \\omega t\\right)$.\n-   The perturbation amplitude is small: $0  \\varepsilon \\ll 1$.\n-   The wavevector $\\mathbf{k}$ is real, with magnitude $k=|\\mathbf{k}|$.\n-   The growth rate $\\omega$ is a complex number.\n-   The task is to derive the dispersion relation $\\omega(k)$ by linearizing the governing equations about $c_{0}$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is subjected to scrutiny based on the established criteria.\n-   **Scientifically Grounded**: The problem describes the Cahn-Hilliard theory of phase separation, a cornerstone model in materials science and statistical physics for describing spinodal decomposition. All definitions and governing equations—the Ginzburg-Landau free energy functional, the variational definition of chemical potential, the linear flux law, and the continuity equation—are standard and fundamentally sound.\n-   **Well-Posed**: The problem is well-posed. It provides a complete set of physical laws and definitions and asks for a standard linear stability analysis of a partial differential equation. This is a standard procedure in theoretical physics that leads to a unique and meaningful dispersion relation.\n-   **Objective**: The problem is stated in precise, objective mathematical language, free from ambiguity or subjective claims.\n\nThe problem does not exhibit any of the listed flaws. It is scientifically sound, formally stated, self-contained, and poses a non-trivial but solvable question in theoretical materials science.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A rigorous derivation will now be provided.\n\nThe derivation proceeds in three stages. First, the explicit form of the governing partial differential equation for $c(\\mathbf{x},t)$ is derived. Second, this equation is linearized around the homogeneous state $c_{0}$. Third, the plane-wave ansatz is substituted into the linearized equation to find the dispersion relation $\\omega(k)$.\n\nThe chemical potential $\\mu$ is defined as the variational derivative of the free energy $F[c]$ with respect to the field $c$.\n$$\n\\mu(\\mathbf{x}) = \\frac{\\delta F}{\\delta c(\\mathbf{x})}\n$$\nTo compute this, we consider a small variation $\\delta c(\\mathbf{x})$ and compute the change in the functional $\\delta F$:\n$$\n\\delta F = F[c+\\delta c] - F[c] = \\int_{\\Omega} \\left[ f_{0}(c+\\delta c) - f_{0}(c) + \\frac{\\kappa}{2} \\left( |\\nabla(c+\\delta c)|^{2} - |\\nabla c|^{2} \\right) \\right] \\mathrm{d}V\n$$\nFor an infinitesimal variation $\\delta c$, we expand to first order.\n$$\nf_{0}(c+\\delta c) \\approx f_{0}(c) + \\frac{\\mathrm{d}f_{0}}{\\mathrm{d}c} \\delta c = f_{0}(c) + f_{0}'(c) \\delta c\n$$\n$$\n|\\nabla(c+\\delta c)|^{2} = (\\nabla c + \\nabla \\delta c) \\cdot (\\nabla c + \\nabla \\delta c) = |\\nabla c|^{2} + 2\\nabla c \\cdot \\nabla \\delta c + |\\nabla \\delta c|^{2} \\approx |\\nabla c|^{2} + 2\\nabla c \\cdot \\nabla \\delta c\n$$\nSubstituting these expansions into the expression for $\\delta F$:\n$$\n\\delta F \\approx \\int_{\\Omega} \\left[ f_{0}'(c) \\delta c + \\kappa \\nabla c \\cdot \\nabla \\delta c \\right] \\mathrm{d}V\n$$\nWe apply integration by parts to the second term, using the identity $\\nabla \\cdot (\\psi \\mathbf{A}) = (\\nabla \\psi) \\cdot \\mathbf{A} + \\psi (\\nabla \\cdot \\mathbf{A})$. Let $\\psi = \\delta c$ and $\\mathbf{A} = \\kappa \\nabla c$. Then $\\nabla \\delta c \\cdot (\\kappa \\nabla c) = \\nabla \\cdot (\\delta c \\, \\kappa \\nabla c) - \\delta c \\, \\nabla \\cdot (\\kappa \\nabla c)$.\n$$\n\\int_{\\Omega} \\kappa \\nabla c \\cdot \\nabla \\delta c \\, \\mathrm{d}V = \\int_{\\Omega} \\nabla \\cdot (\\delta c \\, \\kappa \\nabla c) \\, \\mathrm{d}V - \\int_{\\Omega} \\delta c \\, (\\kappa \\nabla^{2} c) \\, \\mathrm{d}V\n$$\nUsing the divergence theorem, the first integral on the right-hand side becomes a surface integral over the boundary $\\partial\\Omega$. Assuming natural boundary conditions ($\\nabla c \\cdot \\mathbf{n} = 0$ on $\\partial\\Omega$) or periodic boundary conditions, this surface term vanishes.\n$$\n\\delta F = \\int_{\\Omega} \\left[ f_{0}'(c) - \\kappa \\nabla^{2} c \\right] \\delta c \\, \\mathrm{d}V\n$$\nFrom the definition $\\delta F = \\int \\mu \\, \\delta c \\, \\mathrm{d}V$, we identify the chemical potential:\n$$\n\\mu = f_{0}'(c) - \\kappa \\nabla^{2} c\n$$\nNow, we construct the governing equation. The continuity equation is $\\partial_{t} c = - \\nabla \\cdot \\mathbf{J}$. Substituting the flux law $\\mathbf{J} = -M \\nabla \\mu$ gives:\n$$\n\\partial_{t} c = - \\nabla \\cdot (-M \\nabla \\mu) = M \\nabla^{2} \\mu\n$$\nsince the mobility $M$ is a constant. Substituting the expression for $\\mu$:\n$$\n\\partial_{t} c = M \\nabla^{2} \\left[ f_{0}'(c) - \\kappa \\nabla^{2} c \\right]\n$$\nThis is the Cahn-Hilliard equation. We now linearize this equation about the constant reference state $c = c_{0}$. Let $c(\\mathbf{x}, t) = c_{0} + \\delta c(\\mathbf{x}, t)$, where $\\delta c$ is a small perturbation.\nThe left-hand side becomes:\n$$\n\\partial_{t} (c_{0} + \\delta c) = \\partial_{t} \\delta c\n$$\nFor the right-hand side, we first linearize the term $f_{0}'(c)$:\n$$\nf_{0}'(c) = f_{0}'(c_{0} + \\delta c) \\approx f_{0}'(c_{0}) + f_{0}''(c_{0}) \\delta c\n$$\nSubstituting this into the Cahn-Hilliard equation:\n$$\n\\partial_{t} \\delta c = M \\nabla^{2} \\left[ f_{0}'(c_{0}) + f_{0}''(c_{0}) \\delta c - \\kappa \\nabla^{2}(c_{0} + \\delta c) \\right]\n$$\nSince $c_{0}$ is a constant, $f_{0}'(c_{0})$ is a constant, and $\\nabla^{2}c_{0} = 0$. Hence, $\\nabla^{2}[f_{0}'(c_{0})] = 0$. The equation simplifies to:\n$$\n\\partial_{t} \\delta c = M \\nabla^{2} \\left[ f_{0}''(c_{0}) \\delta c - \\kappa \\nabla^{2} \\delta c \\right] = M f_{0}''(c_{0}) \\nabla^{2} \\delta c - M \\kappa \\nabla^{4} \\delta c\n$$\nThis is the linearized evolution equation for the perturbation $\\delta c$.\nFinally, we substitute the plane-wave ansatz $\\delta c(\\mathbf{x},t) = A \\exp(i\\,\\mathbf{k}\\!\\cdot\\!\\mathbf{x} + \\omega t)$, where $A=\\varepsilon\\phi$ is a constant amplitude. The required derivatives are:\n$$\n\\partial_{t} \\delta c = \\omega \\, \\delta c\n$$\n$$\n\\nabla \\delta c = i \\mathbf{k} \\, \\delta c\n$$\n$$\n\\nabla^{2} \\delta c = \\nabla \\cdot (i \\mathbf{k} \\, \\delta c) = (i \\mathbf{k}) \\cdot (i \\mathbf{k}) \\, \\delta c = -|\\mathbf{k}|^{2} \\delta c = -k^{2} \\delta c\n$$\n$$\n\\nabla^{4} \\delta c = \\nabla^{2}(\\nabla^{2} \\delta c) = \\nabla^{2}(-k^{2} \\delta c) = -k^{2} \\nabla^{2} \\delta c = (-k^{2})(-k^{2} \\delta c) = k^{4} \\delta c\n$$\nSubstituting these derivatives into the linearized equation:\n$$\n\\omega \\, \\delta c = M f_{0}''(c_{0}) (-k^{2} \\delta c) - M \\kappa (k^{4} \\delta c)\n$$\nDividing by the non-zero term $\\delta c$ yields the dispersion relation for $\\omega$:\n$$\n\\omega(k) = -M f_{0}''(c_{0}) k^{2} - M \\kappa k^{4}\n$$\nFactoring out common terms provides the final expression.\n$$\n\\omega(k) = -M k^{2} \\left( f_{0}''(c_{0}) + \\kappa k^{2} \\right)\n$$\nThis expression gives the growth rate $\\omega$ as a function of the wavenumber $k$ and the system parameters $M$, $\\kappa$, and the second derivative of the bulk free energy density at the reference composition, $f_{0}''(c_{0})$.",
            "answer": "$$\n\\boxed{-M k^{2} \\left( f_{0}''(c_{0}) + \\kappa k^{2} \\right)}\n$$"
        },
        {
            "introduction": "The final step in mastering phase-field theory is to translate the governing equations into a working simulation. This hands-on coding practice  challenges you to implement a numerical solver for the Cahn-Hilliard equation, allowing you to observe the full, non-linear process of microstructure evolution from noisy initial conditions to a coarsened state. A key aspect of this exercise is to verify that your simulation adheres to the second law of thermodynamics by confirming that the total free energy of the system monotonically decreases over time.",
            "id": "2847487",
            "problem": "Consider the Cahn–Hilliard equation for a conserved phase field $c(x,t)$ on a one–dimensional periodic domain of length $L$,\n$$\n\\frac{\\partial c}{\\partial t} = M \\nabla^2 \\mu,\\quad \\mu = \\frac{\\delta \\mathcal{F}}{\\delta c},\n$$\nwhere the free-energy functional is\n$$\n\\mathcal{F}[c] = \\int_0^L \\left( F(c) + \\frac{\\kappa}{2} \\left|\\nabla c\\right|^2 \\right)\\, dx,\\quad F(c) = \\frac{1}{4}\\left(c^2-1\\right)^2,\n$$\nwith mobility $Mgt;0$ and gradient-energy coefficient $\\kappagt;0$. Assume periodic boundary conditions and nondimensional variables so that no physical units are required anywhere in the computation or the output.\n\nYour task is to start from these definitions and first principles, and, by invoking the variational derivative and the definition of the chemical potential, derive a first-order accurate in time, Fourier pseudo-spectral semi-implicit discretization in which the contribution to the chemical potential arising from the gradient-energy term is handled implicitly while the nonlinear bulk derivative $F'(c)$ is handled explicitly. Discretize space using a uniform grid with $N$ points on a periodic interval of length $L$, and use the Fast Fourier Transform to represent spatial derivatives spectrally. Evolve the phase field $c$ forward in time for a specified number of time steps $\\Delta t$ and compute the discrete free energy at each time step using the trapezoidal rule on the grid:\n$$\n\\mathcal{F}_h[c] = \\sum_{j=0}^{N-1} \\left[ \\frac{1}{4}\\left(c_j^2-1\\right)^2 + \\frac{\\kappa}{2} \\left(\\partial_x c\\big|_j\\right)^2 \\right] \\Delta x,\n$$\nwhere $\\Delta x = L/N$, $c_j = c(x_j)$, $x_j = j\\,\\Delta x$, and $\\partial_x c$ is to be computed spectrally by multiplying the Fourier coefficients of $c$ by $\\mathrm{i}k$ with the standard wave numbers $k$ corresponding to the chosen $L$ and $N$. You must verify, for each test case, whether the discrete free energy sequence $\\{\\mathcal{F}_h^n\\}_{n=0}^{N_t}$, where $N_t$ is the number of time steps, is monotonically non-increasing, that is, whether $\\mathcal{F}_h^{n+1} \\le \\mathcal{F}_h^{n}$ for all $n$. Because of floating-point roundoff, you may allow a small non-negative tolerance determined algorithmically, but you must explain and justify your choice in your solution.\n\nImplement your derivation as an executable program that constructs the spectral operators, advances the semi-implicit scheme, computes the discrete free energy at every step, and returns a boolean indicating whether the free energy decreased monotonically over the entire run for each specified parameter set.\n\nUse the following test suite of parameter sets. For every case, let the domain length be $L=2\\pi$, and use nondimensional parameters. The initial condition in the “noise” cases is a spatially uncorrelated Gaussian perturbation with zero mean and specified amplitude, made reproducible by the indicated pseudorandom seed. The initial condition in the “uniform” case is spatially constant. For each case, report whether the free energy is monotonically non-increasing over the steps taken.\n\n- Case $1$ (happy path): $N=128$, $M=1$, $\\kappa=10^{-2}$, $\\Delta t = 2\\times 10^{-5}$, number of steps $N_t=2000$, initial condition type “noise” with amplitude $10^{-2}$ and seed $1$.\n- Case $2$ (moderately small time step): $N=128$, $M=1$, $\\kappa=10^{-2}$, $\\Delta t = 10^{-4}$, number of steps $N_t=400$, initial condition type “noise” with amplitude $10^{-2}$ and seed $2$.\n- Case $3$ (boundary condition at a bulk minimum): $N=64$, $M=1$, $\\kappa=10^{-2}$, $\\Delta t = 5\\times 10^{-4}$, number of steps $N_t=200$, initial condition type “uniform” with value $+1$.\n- Case $4$ (larger time step, potential to violate monotonic decay): $N=128$, $M=1$, $\\kappa=10^{-2}$, $\\Delta t = 2\\times 10^{-3}$, number of steps $N_t=100$, initial condition type “noise” with amplitude $10^{-2}$ and seed $3$.\n\nAll variables and parameters are nondimensional; no physical units are required for any quantity. Your program must produce, in a single line, a list of four booleans corresponding to the four cases above, in the order stated. The final output format must be exactly one line containing the results as a comma-separated list enclosed in square brackets, for example, “[True,False,True,True]”.\n\nYour implementation must be self-contained, use a Fourier pseudo-spectral representation for spatial derivatives, and follow the semi-implicit time discretization you derive from the stated principles, without relying on any external data. Do not include any extraneous output. The only acceptable output is the final single-line list of booleans as specified.",
            "solution": "The problem is valid as it is scientifically grounded, well-posed, and objective. It presents a standard numerical task in computational materials physics with all necessary information provided. We proceed with the derivation and solution.\n\nThe Cahn-Hilliard equation describes the evolution of a conserved phase field $c(x,t)$ and is given by\n$$\n\\frac{\\partial c}{\\partial t} = M \\nabla^2 \\mu,\n$$\nwhere $M$ is the mobility and $\\mu$ is the chemical potential. The chemical potential is defined as the variational derivative of the Ginzburg-Landau free-energy functional $\\mathcal{F}[c]$ with respect to the phase field $c$:\n$$\n\\mu = \\frac{\\delta \\mathcal{F}}{\\delta c}.\n$$\nThe free-energy functional is given as\n$$\n\\mathcal{F}[c] = \\int_0^L \\left( F(c) + \\frac{\\kappa}{2} |\\nabla c|^2 \\right) dx,\n$$\nwith a double-well bulk energy density $F(c) = \\frac{1}{4}(c^2-1)^2$ and a gradient-energy coefficient $\\kappa > 0$.\n\nFirst, we derive the explicit form of the chemical potential $\\mu$. The integrand of the functional is $I(c, \\nabla c) = F(c) + \\frac{\\kappa}{2} |\\nabla c|^2$. The variational derivative is found using the Euler-Lagrange equation:\n$$\n\\mu = \\frac{\\partial I}{\\partial c} - \\nabla \\cdot \\frac{\\partial I}{\\partial (\\nabla c)}.\n$$\nThe required partial derivatives are:\n$$\n\\frac{\\partial I}{\\partial c} = \\frac{dF}{dc} = \\frac{d}{dc}\\left[\\frac{1}{4}(c^2-1)^2\\right] = \\frac{1}{4} \\cdot 2(c^2-1) \\cdot 2c = c^3 - c.\n$$\n$$\n\\frac{\\partial I}{\\partial (\\nabla c)} = \\kappa \\nabla c.\n$$\nSubstituting these into the expression for $\\mu$ yields:\n$$\n\\mu = (c^3 - c) - \\kappa \\nabla^2 c.\n$$\nInserting this into the Cahn-Hilliard equation gives the full fourth-order nonlinear partial differential equation:\n$$\n\\frac{\\partial c}{\\partial t} = M \\nabla^2 (c^3 - c - \\kappa \\nabla^2 c) = M \\left( \\nabla^2(c^3 - c) - \\kappa \\nabla^4 c \\right).\n$$\n\nFor the numerical solution, we employ a Fourier pseudo-spectral method for spatial discretization and a semi-implicit first-order scheme for time integration. The spatial domain $[0, L]$ is discretized into $N$ grid points $x_j = j \\Delta x$ with grid spacing $\\Delta x = L/N$. The phase field $c(x,t)$ is represented by its values $c_j(t)$ on this grid. In the Fourier spectral method, spatial derivatives are computed in Fourier space. A function $f(x)$ is transformed to its Fourier coefficients $\\hat{f}(k)$, where $k$ are the wavenumbers. The $n$-th derivative in Fourier space corresponds to multiplication by $(ik)^n$. Thus, $\\nabla^2$ becomes multiplication by $-k^2$ and $\\nabla^4$ becomes multiplication by $k^4$.\n\nThe problem requires a semi-implicit time-stepping scheme where the nonlinear bulk term's contribution, which comes from $F'(c) = c^3-c$, is treated explicitly, and the stiff gradient energy term, $-\\kappa\\nabla^2 c$, is treated implicitly. Using a first-order forward Euler for the explicit part and backward Euler for the implicit part, the time-discretized equation for a time step $\\Delta t$ from step $n$ to $n+1$ is:\n$$\n\\frac{c^{n+1} - c^n}{\\Delta t} = M \\nabla^2 \\left[ ( (c^n)^3 - c^n ) - \\kappa \\nabla^2 c^{n+1} \\right].\n$$\nThis equation is algebraic in Fourier space, which makes it easy to solve for $\\hat{c}^{n+1}$. Let $\\hat{c}^n(k)$ be the discrete Fourier transform of $c^n(x_j)$. Transforming the equation, we get:\n$$\n\\frac{\\hat{c}^{n+1} - \\hat{c}^n}{\\Delta t} = M (-k^2) \\left[ \\widehat{((c^n)^3 - c^n)} + \\kappa k^2 \\hat{c}^{n+1} \\right].\n$$\nThe term $\\widehat{((c^n)^3 - c^n)}$ is computed pseudo-spectrally: the expression $(c^n)^3 - c^n$ is evaluated in real space at each grid point, and the result is then transformed to Fourier space.\nWe rearrange the equation to solve for $\\hat{c}^{n+1}(k)$:\n$$\n\\hat{c}^{n+1} - \\hat{c}^n = -M k^2 \\Delta t \\, \\widehat{((c^n)^3 - c^n)} - M \\kappa k^4 \\Delta t \\, \\hat{c}^{n+1}\n$$\n$$\n\\hat{c}^{n+1}(1 + M \\kappa k^4 \\Delta t) = \\hat{c}^n - M k^2 \\Delta t \\, \\widehat{((c^n)^3 - c^n)}\n$$\nThis yields the update rule for the Fourier coefficients at each time step:\n$$\n\\hat{c}^{n+1}(k) = \\frac{\\hat{c}^n(k) - M k^2 \\Delta t \\, \\widehat{((c^n)^3 - c^n)}(k)}{1 + M \\kappa k^4 \\Delta t}.\n$$\nAt each time step, we start with $c^n$, compute its Fourier transform $\\hat{c}^n$, compute the nonlinear term and its transform, apply the update rule to find $\\hat{c}^{n+1}$, and then perform an inverse Fourier transform to obtain $c^{n+1}$.\n\nThe discrete free energy $\\mathcal{F}_h$ is calculated at each step using the trapezoidal rule on the grid:\n$$\n\\mathcal{F}_h[c] = \\sum_{j=0}^{N-1} \\left[ \\frac{1}{4}(c_j^2-1)^2 + \\frac{\\kappa}{2} (\\partial_x c|_j)^2 \\right] \\Delta x.\n$$\nThe spatial derivative $\\partial_x c$ is computed spectrally by taking the Fourier transform of $c$, multiplying the coefficients $\\hat{c}(k)$ by $ik$, and then taking the inverse Fourier transform.\n\nWe must verify if the energy sequence $\\{\\mathcal{F}_h^n\\}$ is monotonically non-increasing. Numerical computation with finite-precision arithmetic introduces roundoff errors. A check for strict inequality $\\mathcal{F}_h^{n+1} \\le \\mathcal{F}_h^{n}$ is therefore inappropriate. An energy increase is considered significant only if it exceeds a tolerance. A robust tolerance must account for both the absolute magnitude of potential roundoff errors in near-zero energies and the relative error when energy is large. We define the tolerance $\\epsilon_{tol}$ as a sum of an absolute component $\\tau_{abs}$ and a relative component $\\tau_{rel} \\cdot |\\mathcal{F}_h^n|$. The condition for a non-monotonic step is then $\\mathcal{F}_h^{n+1} - \\mathcal{F}_h^n  \\tau_{abs} + \\tau_{rel} |\\mathcal{F}_h^n|$. For the double-precision floating-point numbers used, we choose conservative values $\\tau_{abs} = 10^{-12}$ and $\\tau_{rel} = 10^{-10}$. An energy sequence is deemed non-monotonic if this condition is met for any time step $n$.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function to run all test cases and print the final result.\n    \"\"\"\n    test_cases = [\n        # Case 1 (happy path): N=128, M=1, kappa=10^-2, dt=2x10^-5, Nt=2000, \n        # IC noise amp=10^-2, seed=1.\n        {'N': 128, 'M': 1.0, 'kappa': 1e-2, 'dt': 2e-5, 'Nt': 2000, \n         'ic_type': 'noise', 'ic_params': (1e-2, 1)},\n        # Case 2 (moderately small time step): N=128, M=1, kappa=10^-2, dt=10^-4, Nt=400,\n        # IC noise amp=10^-2, seed=2.\n        {'N': 128, 'M': 1.0, 'kappa': 1e-2, 'dt': 1e-4, 'Nt': 400, \n         'ic_type': 'noise', 'ic_params': (1e-2, 2)},\n        # Case 3 (boundary condition at a bulk minimum): N=64, M=1, kappa=10^-2, dt=5x10-4, Nt=200,\n        # IC uniform value=+1.\n        {'N': 64, 'M': 1.0, 'kappa': 1e-2, 'dt': 5e-4, 'Nt': 200,\n         'ic_type': 'uniform', 'ic_params': (1.0,)},\n        # Case 4 (larger time step, potential to violate monotonic decay): N=128, M=1, kappa=10^-2, dt=2x10-3, Nt=100,\n        # IC noise amp=10^-2, seed=3.\n        {'N': 128, 'M': 1.0, 'kappa': 1e-2, 'dt': 2e-3, 'Nt': 100,\n         'ic_type': 'noise', 'ic_params': (1e-2, 3)},\n    ]\n\n    results = []\n    for case in test_cases:\n        result = run_simulation(**case)\n        results.append(result)\n\n    # Format the final output string as specified\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef run_simulation(N, M, kappa, dt, Nt, ic_type, ic_params):\n    \"\"\"\n    Runs a single Cahn-Hilliard simulation for a given set of parameters.\n    Returns a boolean indicating if the free energy was monotonically non-increasing.\n    \"\"\"\n    L = 2.0 * np.pi\n    dx = L / N\n    k = 2.0 * np.pi * np.fft.fftfreq(N, d=dx)\n\n    # Set up initial condition\n    if ic_type == \"noise\":\n        amplitude, seed = ic_params\n        np.random.seed(seed)\n        c = amplitude * np.random.randn(N)\n    elif ic_type == \"uniform\":\n        value = ic_params[0]\n        c = np.full(N, value, dtype=float)\n\n    # Pre-calculate the denominator for the semi-implicit scheme, as it is constant.\n    den = 1.0 + M * kappa * k**4 * dt\n\n    energies = []\n    \n    # Calculate and store initial energy\n    energies.append(calculate_energy(c, k, kappa, dx))\n\n    # Perform time-stepping\n    for _ in range(Nt):\n        # Evaluate nonlinear term F'(c) = c^3 - c in real space\n        F_prime = c**3 - c\n        F_prime_hat = np.fft.fft(F_prime)\n        \n        c_hat = np.fft.fft(c)\n        \n        # Calculate numerator of the update rule\n        num = c_hat - M * dt * k**2 * F_prime_hat\n        \n        # Update concentration field in Fourier space\n        c_hat_new = num / den\n        \n        # Transform back to real space for the next step\n        # Taking np.real is necessary to discard numerical noise in the imaginary part\n        c = np.real(np.fft.ifft(c_hat_new))\n        \n        # Calculate and store energy of the new state\n        energies.append(calculate_energy(c, k, kappa, dx))\n\n    # Check for monotonic decrease in the stored energy sequence\n    is_monotonic = True\n    for i in range(len(energies) - 1):\n        # A tolerance is necessary for floating-point comparisons.\n        # It combines an absolute component for near-zero energies and\n        # a relative component for larger energies.\n        abs_tol = 1e-12\n        rel_tol = 1e-10\n        tolerance = abs_tol + rel_tol * abs(energies[i])\n        \n        if energies[i+1] > energies[i] + tolerance:\n            is_monotonic = False\n            break\n            \n    return is_monotonic\n\ndef calculate_energy(c, k, kappa, dx):\n    \"\"\"\n    Computes the discrete free energy of the system using the trapezoidal rule.\n    \"\"\"\n    # Bulk energy contribution: F(c) = (1/4)(c^2-1)^2\n    bulk_energy_density = 0.25 * (c**2 - 1)**2\n    \n    # Gradient energy contribution: (kappa/2) |grad c|^2\n    # The derivative is computed spectrally for high accuracy.\n    c_hat = np.fft.fft(c)\n    grad_c_hat = 1j * k * c_hat\n    grad_c = np.real(np.fft.ifft(grad_c_hat))\n    gradient_energy_density = 0.5 * kappa * grad_c**2\n    \n    # Total free energy is the integral over the domain, approximated by a sum.\n    # For a periodic function on a uniform grid, this sum is the trapezoidal rule.\n    total_energy = np.sum(bulk_energy_density + gradient_energy_density) * dx\n    return total_energy\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}