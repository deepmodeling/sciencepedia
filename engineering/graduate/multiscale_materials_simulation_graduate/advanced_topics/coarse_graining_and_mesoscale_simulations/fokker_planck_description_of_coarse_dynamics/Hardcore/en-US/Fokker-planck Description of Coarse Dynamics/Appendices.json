{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of multiscale simulation is the ability to construct an effective coarse-grained model from data generated by a more detailed, microscopic simulation. This first practice confronts this challenge head-on by asking you to develop a protocol for parameterizing a one-dimensional Fokker-Planck equation . By starting from the formal definitions of the drift and diffusion coefficients via the Kramers-Moyal expansion, you will learn how to estimate these functions from simulated trajectories and, critically, how to analyze the systematic bias introduced by using a finite time increment $\\Delta t$.",
            "id": "3808991",
            "problem": "Consider a scalar coarse observable $q$ for an underlying microscopic dynamics in a multiscale material system. Assume that, on coarse time scales, $q$ is well described by an Itô stochastic differential equation (SDE) of the form\n$$\ndq(t) \\;=\\; a(q(t))\\,dt \\;+\\; \\sqrt{2\\,D(q(t))}\\,dW_t,\n$$\nwhere $a(q)$ is the coarse-grained drift, $D(q)$ is the coarse-grained diffusion, and $W_t$ is a standard Wiener process. The associated Fokker–Planck equation governs the time evolution of the probability density of $q(t)$.\n\nYou are asked to design and implement a protocol to estimate $a(q)$ and $D(q)$ from short bursts of microdynamics, using conditional time increments at fixed $q$. Your protocol must begin from fundamental definitions and reasoning, and it must explicitly address the bias introduced by using a finite coarse time increment $\\Delta t$. All quantities in this problem are dimensionless.\n\nStarting point and constraints:\n- Begin from the definitions of the first two Kramers–Moyal coefficients, that is, the limits (as $\\Delta t \\to 0$) of the first and second conditional moments of the increment $\\Delta q = q(t+\\Delta t)-q(t)$ given $q(t)=q$. Use these as the fundamental base for your derivation of an estimation protocol based on short bursts of microdynamics.\n- You must not assume any closed-form expression for $a(q)$ and $D(q)$ beyond what follows, except when deduced from the chosen microdynamics.\n- For concreteness, take the underlying coarse SDE to be linear with constant diffusion, namely the Ornstein–Uhlenbeck model\n$$\ndq(t) \\;=\\; -k\\,q(t)\\,dt \\;+\\; \\sqrt{2\\,D_0}\\,dW_t,\n$$\nwith constants $k0$ and $D_00$. This choice models a stable coarse restoring drift and additive thermal-like fluctuations.\n- Emulate “short molecular dynamics (MD) bursts” as exact short-time evolutions over a coarse time $\\Delta t$ starting from a fixed $q^\\star$. In this linear case, the transition of $q$ over time $\\Delta t$ is Gaussian with a well-defined mean and variance; use this to compute conditional expectations needed by your estimators.\n\nYour tasks:\n- Derive, from the Kramers–Moyal definitions, consistent finite-$\\Delta t$ estimators for $a(q^\\star)$ and $D(q^\\star)$ using conditional time increments computed from short bursts initiated at $q^\\star$. Explicitly quantify and discuss the bias introduced by using a finite $\\Delta t$ in the special case of the linear SDE above.\n- Implement a program that, for specified parameters, evaluates the finite-$\\Delta t$ estimators at a fixed $q^\\star$ and reports the relative biases versus the true $a(q^\\star)$ and $D(q^\\star)$.\n\nTest suite:\n- Use $k = 1.5$, $D_0 = 0.7$, and $q^\\star = 0.8$.\n- Evaluate four distinct coarse time increments to probe the small-$\\Delta t$ and large-$\\Delta t$ regimes:\n  - Case $1$: $\\Delta t = 10^{-4}$.\n  - Case $2$: $\\Delta t = 10^{-2}$.\n  - Case $3$: $\\Delta t = 10^{-1}$.\n  - Case $4$: $\\Delta t = 1$.\n- For each case, compute two floats:\n  - The relative bias in the drift estimate at $q^\\star$, defined as\n    $$\n    \\frac{\\widehat{a}_{\\Delta t}(q^\\star) - a(q^\\star)}{\\lvert a(q^\\star) \\rvert},\n    $$\n    where $\\widehat{a}_{\\Delta t}(q^\\star)$ is your finite-$\\Delta t$ estimator and $a(q^\\star)$ is the true drift.\n  - The relative bias in the diffusion estimate at $q^\\star$, defined as\n    $$\n    \\frac{\\widehat{D}_{\\Delta t}(q^\\star) - D(q^\\star)}{D(q^\\star)}.\n    $$\n- All variables are dimensionless; report the floats as plain decimals.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered as\n$$\n[\\,\\text{drift\\_bias}_{1},\\;\\text{diffusion\\_bias}_{1},\\;\\text{drift\\_bias}_{2},\\;\\text{diffusion\\_bias}_{2},\\;\\text{drift\\_bias}_{3},\\;\\text{diffusion\\_bias}_{3},\\;\\text{drift\\_bias}_{4},\\;\\text{diffusion\\_bias}_{4}\\,].\n$$\nNo additional text should be printed.",
            "solution": "The problem requires the derivation and implementation of a protocol to estimate the drift and diffusion coefficients, $a(q)$ and $D(q)$, of a scalar Itô stochastic differential equation (SDE) from simulated short-time trajectory data. The protocol is to be founded on the Kramers–Moyal coefficient definitions and must account for the bias introduced by using a finite time increment, $\\Delta t$.\n\nThe general form of the SDE for the coarse observable $q(t)$ is given by\n$$\ndq(t) = a(q(t))\\,dt + \\sqrt{2\\,D(q(t))}\\,dW_t,\n$$\nwhere $W_t$ is a standard Wiener process. The drift coefficient $a(q)$ and the diffusion coefficient $D(q)$ are formally defined by the first two Kramers–Moyal coefficients, which are the limits of the conditional moments of the increment $\\Delta q \\equiv q(t+\\Delta t) - q(t)$ given the state $q(t)=q$:\n$$\na(q) = \\lim_{\\Delta t \\to 0} \\frac{1}{\\Delta t} \\mathbb{E}[\\Delta q | q(t)=q]\n$$\n$$\n2D(q) = \\lim_{\\Delta t \\to 0} \\frac{1}{\\Delta t} \\mathbb{E}[(\\Delta q)^2 | q(t)=q]\n$$\n\nA natural, albeit biased, set of estimators for $a(q)$ and $D(q)$ at a finite time step $\\Delta t$ can be constructed by dropping the limit. These estimators, which we denote as $\\widehat{a}_{\\Delta t}(q)$ and $\\widehat{D}_{\\Delta t}(q)$, are based on the expected values of the first two moments of the increment, evaluated over short bursts of dynamics initiated at a fixed value $q^\\star$:\n$$\n\\widehat{a}_{\\Delta t}(q^\\star) = \\frac{1}{\\Delta t} \\mathbb{E}[q(t+\\Delta t) - q(t) | q(t)=q^\\star]\n$$\n$$\n\\widehat{D}_{\\Delta t}(q^\\star) = \\frac{1}{2\\Delta t} \\mathbb{E}[(q(t+\\Delta t) - q(t))^2 | q(t)=q^\\star]\n$$\nTo analyze these estimators, we must compute the required conditional expectations for the specified underlying dynamics.\n\nThe problem specifies the Ornstein–Uhlenbeck (OU) process, a linear SDE with constant diffusion:\n$$\ndq(t) = -k\\,q(t)\\,dt + \\sqrt{2\\,D_0}\\,dW_t,\n$$\nwhere $k0$ and $D_00$ are constants. By direct comparison with the general SDE form, the true coefficients are:\n$$\na(q) = -k\\,q\n$$\n$$\nD(q) = D_0\n$$\nThe analytical solution to the OU SDE provides the exact transition probability needed to evaluate the conditional expectations. To solve the SDE, we use an integrating factor $e^{kt}$. Setting the initial time to $t=0$ with condition $q(0)=q^\\star$, we have:\n$$\nd(e^{kt}q(t)) = e^{kt}(dq(t) + k\\,q(t)\\,dt) = e^{kt}\\sqrt{2D_0}\\,dW_t\n$$\nIntegrating from $t=0$ to $t=\\Delta t$ yields:\n$$\ne^{k\\Delta t}q(\\Delta t) - q(0) = \\sqrt{2D_0} \\int_0^{\\Delta t} e^{kt'}\\,dW_{t'}\n$$\n$$\nq(\\Delta t) = q^\\star e^{-k\\Delta t} + \\sqrt{2D_0} \\int_0^{\\Delta t} e^{-k(\\Delta t - t')}\\,dW_{t'}\n$$\nThis expression shows that, conditioned on $q(0)=q^\\star$, the variable $q(\\Delta t)$ is a Gaussian random variable. Its mean is found by taking the expectation, noting that the stochastic integral has zero mean:\n$$\n\\mathbb{E}[q(\\Delta t) | q(0)=q^\\star] = q^\\star e^{-k\\Delta t}\n$$\nIts variance is found using the Itô isometry:\n$$\n\\text{Var}[q(\\Delta t) | q(0)=q^\\star] = \\text{Var}\\left[\\sqrt{2D_0} \\int_0^{\\Delta t} e^{-k(\\Delta t - t')}\\,dW_{t'}\\right] = 2D_0 \\int_0^{\\Delta t} \\left(e^{-k(\\Delta t - t')}\\right)^2 dt'\n$$\n$$\n\\text{Var}[q(\\Delta t) | q(0)=q^\\star] = 2D_0 \\int_0^{\\Delta t} e^{-2k(\\Delta t - t')} dt' = 2D_0 \\left[ \\frac{e^{-2k(\\Delta t - t')}}{2k} \\right]_0^{\\Delta t} = \\frac{D_0}{k}(1 - e^{-2k\\Delta t})\n$$\nNow we can compute the conditional moments of the increment $\\Delta q = q(\\Delta t) - q^\\star$. The first moment is:\n$$\n\\mathbb{E}[\\Delta q | q(0)=q^\\star] = \\mathbb{E}[q(\\Delta t) | q(0)=q^\\star] - q^\\star = q^\\star e^{-k\\Delta t} - q^\\star = q^\\star (e^{-k\\Delta t} - 1)\n$$\nFor the second moment, we use the property $\\mathbb{E}[X^2] = \\text{Var}[X] + (\\mathbb{E}[X])^2$:\n$$\n\\mathbb{E}[(\\Delta q)^2 | q(0)=q^\\star] = \\text{Var}[\\Delta q | q(0)=q^\\star] + (\\mathbb{E}[\\Delta q | q(0)=q^\\star])^2\n$$\nSince $\\Delta q = q(\\Delta t) - q^\\star$ and $q^\\star$ is a constant, $\\text{Var}[\\Delta q] = \\text{Var}[q(\\Delta t)]$. Therefore:\n$$\n\\mathbb{E}[(\\Delta q)^2 | q(0)=q^\\star] = \\frac{D_0}{k}(1 - e^{-2k\\Delta t}) + \\left(q^\\star (e^{-k\\Delta t} - 1)\\right)^2\n$$\nSubstituting these results into the definitions of our finite-$\\Delta t$ estimators, we obtain their exact expressions for the OU process:\n$$\n\\widehat{a}_{\\Delta t}(q^\\star) = \\frac{1}{\\Delta t} \\mathbb{E}[\\Delta q | q(0)=q^\\star] = \\frac{q^\\star (e^{-k\\Delta t} - 1)}{\\Delta t}\n$$\n$$\n\\widehat{D}_{\\Delta t}(q^\\star) = \\frac{1}{2\\Delta t} \\mathbb{E}[(\\Delta q)^2 | q(0)=q^\\star] = \\frac{1}{2\\Delta t} \\left[ \\frac{D_0}{k}(1 - e^{-2k\\Delta t}) + (q^\\star)^2(e^{-k\\Delta t} - 1)^2 \\right]\n$$\nTo analyze the bias, we compare these expressions to the true values, $a(q^\\star) = -k\\,q^\\star$ and $D(q^\\star) = D_0$.\n\nFor the drift estimator, consider its Taylor series expansion for small $\\Delta t$:\n$$\ne^{-k\\Delta t} = 1 - k\\Delta t + \\frac{(k\\Delta t)^2}{2} - \\frac{(k\\Delta t)^3}{6} + \\mathcal{O}(\\Delta t^4)\n$$\n$$\n\\widehat{a}_{\\Delta t}(q^\\star) = \\frac{q^\\star}{\\Delta t} \\left(-k\\Delta t + \\frac{k^2\\Delta t^2}{2} - \\dots \\right) = -k\\,q^\\star + \\frac{k^2 q^\\star \\Delta t}{2} + \\mathcal{O}(\\Delta t^2)\n$$\nThe bias is $\\widehat{a}_{\\Delta t}(q^\\star) - a(q^\\star) = \\frac{k^2 q^\\star \\Delta t}{2} + \\mathcal{O}(\\Delta t^2)$. This is a systematic error, linear in $\\Delta t$ to leading order, which causes the estimator to overestimate the magnitude of the negative drift (i.e., it is less negative than the true value).\n\nFor the diffusion estimator, we expand its components:\n$$\n1 - e^{-2k\\Delta t} = 1 - \\left(1 - 2k\\Delta t + \\frac{(2k\\Delta t)^2}{2} + \\dots \\right) = 2k\\Delta t - 2k^2\\Delta t^2 + \\mathcal{O}(\\Delta t^3)\n$$\n$$\n(e^{-k\\Delta t} - 1)^2 = (-k\\Delta t + \\frac{k^2\\Delta t^2}{2} + \\dots)^2 = k^2\\Delta t^2 + \\mathcal{O}(\\Delta t^3)\n$$\nSubstituting these into the expression for $\\widehat{D}_{\\Delta t}(q^\\star)$:\n$$\n\\widehat{D}_{\\Delta t}(q^\\star) = \\frac{1}{2\\Delta t} \\left[ \\frac{D_0}{k}(2k\\Delta t - 2k^2\\Delta t^2 + \\dots) + (q^\\star)^2(k^2\\Delta t^2 + \\dots) \\right]\n$$\n$$\n\\widehat{D}_{\\Delta t}(q^\\star) = \\frac{1}{2\\Delta t} \\left[ (2D_0\\Delta t - 2D_0k\\Delta t^2) + (q^\\star)^2k^2\\Delta t^2 + \\mathcal{O}(\\Delta t^3) \\right]\n$$\n$$\n\\widehat{D}_{\\Delta t}(q^\\star) = D_0 - D_0k\\Delta t + \\frac{(q^\\star)^2k^2\\Delta t}{2} + \\mathcal{O}(\\Delta t^2) = D_0 + \\left( \\frac{(q^\\star)^2 k^2}{2} - D_0k \\right)\\Delta t + \\mathcal{O}(\\Delta t^2)\n$$\nThe bias for the diffusion estimator, $\\widehat{D}_{\\Delta t}(q^\\star) - D(q^\\star)$, is also linear in $\\Delta t$ to leading order. Its sign depends on the competition between the term from the drift, $(q^\\star)^2 k^2/2$, and the term from the diffusion dynamics, $-D_0k$.\n\nBased on this derivation, the quantities to be computed are the relative biases for the given test cases.\nThe true values at $q^\\star$ are $a(q^\\star) = -k\\,q^\\star$ and $D(q^\\star) = D_0$.\nThe estimators are:\n$\\widehat{a}_{\\Delta t}(q^\\star) = q^\\star (e^{-k\\Delta t} - 1) / \\Delta t$\n$\\widehat{D}_{\\Delta t}(q^\\star) = \\frac{1}{2\\Delta t} [ \\frac{D_0}{k}(1 - e^{-2k\\Delta t}) + (q^\\star)^2(e^{-k\\Delta t} - 1)^2 ]$\nThe relative biases are:\n$$\n\\text{Relative Drift Bias} = \\frac{\\widehat{a}_{\\Delta t}(q^\\star) - a(q^\\star)}{\\lvert a(q^\\star) \\rvert}\n$$\n$$\n\\text{Relative Diffusion Bias} = \\frac{\\widehat{D}_{\\Delta t}(q^\\star) - D(q^\\star)}{D(q^\\star)}\n$$\nThese formulas are implemented for the specified parameters to quantify the estimation bias as a function of the coarse time step $\\Delta t$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the relative biases in drift and diffusion estimators\n    for an Ornstein-Uhlenbeck process at finite time steps.\n    \"\"\"\n    \n    # Define the parameters from the problem statement.\n    k = 1.5\n    D0 = 0.7\n    q_star = 0.8\n    \n    # Define the test cases for the coarse time increment delta_t.\n    test_cases = [1e-4, 1e-2, 1e-1, 1.0]\n\n    # Calculate the true values of the drift and diffusion coefficients.\n    # a(q) = -k*q, D(q) = D0\n    true_a = -k * q_star\n    true_d = D0\n    \n    # Store the final results.\n    results = []\n    \n    # Iterate through each coarse time increment delta_t.\n    for dt in test_cases:\n        # Calculate the finite-delta_t estimators for drift and diffusion.\n        # These are based on the exact conditional moments of the OU process increment.\n\n        # Estimator for drift: a_hat = (1/dt) * E[q(t+dt) - q(t) | q(t)=q_star]\n        exp_k_dt = np.exp(-k * dt)\n        a_hat = q_star * (exp_k_dt - 1.0) / dt\n\n        # Estimator for diffusion: D_hat = (1/(2*dt)) * E[(q(t+dt) - q(t))^2 | q(t)=q_star]\n        # E[(dq)^2] = Var(dq) + (E[dq])^2\n        # Var(dq) = Var(q(t+dt)) = (D0/k) * (1 - exp(-2*k*dt))\n        # E[dq] = q_star * (exp(-k*dt) - 1.0)\n        exp_2k_dt = np.exp(-2.0 * k * dt)\n        var_q_dt = (D0 / k) * (1.0 - exp_2k_dt)\n        mean_dq_sq = (q_star * (exp_k_dt - 1.0))**2\n        \n        d_hat = (var_q_dt + mean_dq_sq) / (2.0 * dt)\n        \n        # Calculate the relative biases as specified in the problem.\n        # Relative bias for drift: (a_hat - a_true) / |a_true|\n        drift_bias = (a_hat - true_a) / abs(true_a)\n        \n        # Relative bias for diffusion: (D_hat - D_true) / D_true\n        diffusion_bias = (d_hat - true_d) / true_d\n        \n        results.append(drift_bias)\n        results.append(diffusion_bias)\n\n    # Format the results into the required single-line string format.\n    # The map(str, ...) converts each float to its string representation.\n    # The ','.join(...) concatenates them with commas.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    \n    # Final print statement in the exact required format.\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "With a Fokker-Planck model in hand, a primary goal is to understand the slow, functionally important dynamics of the system, such as transitions between metastable states. This computational exercise delves into the spectral theory of the Fokker-Planck operator, a powerful method for identifying these slow processes . By numerically computing the eigenfunctions for a particle in a double-well potential, you will see firsthand how the first non-trivial eigenfunction serves as an excellent approximation to the committor, or reaction coordinate, which provides the most efficient description of the transition pathway.",
            "id": "3808979",
            "problem": "Consider a one-dimensional overdamped diffusion process used in multiscale materials simulation to model coarse-grained dynamics in a symmetric double-well potential. The dynamics of a configuration coordinate $x$ is given by the Itô Stochastic Differential Equation (SDE)\n$$\n\\mathrm{d}x_t = -U'(x_t)\\,\\mathrm{d}t + \\sqrt{2}\\,\\mathrm{d}W_t,\n$$\nwhere $U(x)$ is the energy landscape, $U'(x)$ is its derivative with respect to $x$, and $W_t$ is a standard Wiener process. Assume unit mobility and thermal energy so the diffusion coefficient equals $1$. The corresponding backward Kolmogorov generator (also referred to as the backward operator of the Fokker–Planck description) acting on sufficiently smooth test functions $f$ is\n$$\n\\mathcal{L} f(x) = -U'(x)\\,f'(x) + f''(x).\n$$\nLet the double-well potential be $U(x) = a\\,(x^2 - 1)^2$, with $a0$, yielding wells at $x=\\pm 1$ and a barrier at $x=0$.\n\nYour task is to compute numerically the leading eigenfunctions of the discretized backward generator $\\mathcal{L}$ on a finite interval and interpret the first nontrivial eigenfunction as a committor-like slow coordinate. Specifically, do the following:\n\n1. Discretize the interval $[-L,L]$ using a uniform grid $x_i$ with $N$ points and spacing $h$. Approximate the action of $\\mathcal{L}$ on grid functions using second-order centered finite differences for interior points:\n$$\nf'(x_i) \\approx \\frac{f_{i+1} - f_{i-1}}{2h}, \\quad\nf''(x_i) \\approx \\frac{f_{i+1} - 2f_i + f_{i-1}}{h^2}.\n$$\nImpose reflecting boundary conditions (Neumann) for the eigenproblem, $f'(x) = 0$ at $x=\\pm L$, by using ghost-point elimination that enforces $f_{-1} = f_{1}$ and $f_{N} = f_{N-2}$, leading to the discrete boundary rows\n$$\n(\\mathcal{L}f)_0 \\approx \\frac{2}{h^2}\\,(f_1 - f_0), \\quad\n(\\mathcal{L}f)_{N-1} \\approx \\frac{2}{h^2}\\,(f_{N-2} - f_{N-1}),\n$$\nand for interior indices $i=1,\\dots,N-2$,\n$$\n(\\mathcal{L}f)_i \\approx \\left(\\frac{U'(x_i)}{2h} + \\frac{1}{h^2}\\right) f_{i-1} - \\frac{2}{h^2} f_i + \\left(-\\frac{U'(x_i)}{2h} + \\frac{1}{h^2}\\right) f_{i+1}.\n$$\n\n2. Assemble the resulting $N\\times N$ matrix representation of $\\mathcal{L}$ on the grid and compute its eigenvalues and eigenvectors. Identify the smallest-in-magnitude eigenvalue $\\lambda_0$ and its eigenfunction $\\phi_0$ (which should be close to a constant due to the reflecting boundary conditions), and the next smallest-in-magnitude eigenvalue $\\lambda_1$ with eigenfunction $\\phi_1$. Normalize $\\phi_1$ to an affine-scaled version $g$ with range $[-1,1]$:\n$$\ng = 2\\,\\frac{\\phi_1 - \\min(\\phi_1)}{\\max(\\phi_1)-\\min(\\phi_1)} - 1.\n$$\n\n3. Compute the committor function $q$ as the solution of the boundary value problem\n$$\n\\mathcal{L} q(x) = 0 \\quad \\text{on} \\quad (-L,L), \\quad q(-L) = 0, \\quad q(L) = 1,\n$$\ndiscretized on the same grid using the same interior second-order finite differences, but now with Dirichlet boundary conditions applied at $x=\\pm L$. Solve the resulting linear system for the interior unknowns and set $q$ at the boundaries to the prescribed values. Define the centered committor\n$$\nc = 2q - 1.\n$$\n\n4. Interpret the first nontrivial eigenfunction $\\phi_1$ as a committor-like slow coordinate by quantifying its relationship to $c$. Compute:\n   - The Pearson correlation coefficient between $g$ and $c$.\n   - The parity error\n$$\n\\varepsilon = \\frac{\\max_i \\left| \\phi_{1,i} + \\phi_{1,(N-1-i)} \\right|}{\\max_i \\left| \\phi_{1,i} \\right| + 10^{-12}},\n$$\nwhich measures deviation from odd symmetry about $x=0$, a property expected for the slow mode in a symmetric double-well.\n\nConstruct a program that performs the above for the following test suite. Each test case is a triple $(a,L,N)$:\n\n- Case 1 (happy path, high barrier): $(10.0,\\,1.5,\\,201)$.\n- Case 2 (moderate barrier): $(4.0,\\,1.5,\\,201)$.\n- Case 3 (low barrier): $(1.0,\\,1.5,\\,201)$.\n- Case 4 (edge case, coarse grid): $(4.0,\\,1.5,\\,51)$.\n\nFor each case, compute and return a list of four floats $[\\lambda_0,\\,\\lambda_1,\\,\\mathrm{corr},\\,\\varepsilon]$, where $\\lambda_0$ and $\\lambda_1$ are the real parts of the two smallest-in-magnitude eigenvalues of the Neumann eigenproblem, $\\mathrm{corr}$ is the Pearson correlation coefficient between $g$ and $c$, and $\\varepsilon$ is the parity error. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a list of four floats, for example:\n$$\n\\text{[}[r_{1,1},r_{1,2},r_{1,3},r_{1,4}],[r_{2,1},r_{2,2},r_{2,3},r_{2,4}],\\dots\\text{]}.\n$$\nNo physical units are required and angles do not appear in this problem. All numerical answers must be floats or lists of floats, as specified above.",
            "solution": "The user has provided a valid, well-posed, and scientifically grounded problem. The task is to analyze the slow dynamics of an overdamped diffusion process in a symmetric double-well potential by studying the spectral properties of its backward Kolmogorov generator and its relation to the committor function. The problem is numerically solvable with the provided information.\n\nThe core of the problem lies in the Itô Stochastic Differential Equation (SDE) for a coordinate $x_t$:\n$$\n\\mathrm{d}x_t = -U'(x_t)\\,\\mathrm{d}t + \\sqrt{2}\\,\\mathrm{d}W_t\n$$\nThis equation describes the motion of a particle in a potential landscape $U(x) = a(x^2 - 1)^2$ under the influence of random thermal fluctuations, represented by the Wiener process $W_t$. The dynamics are governed by the backward Kolmogorov generator, $\\mathcal{L}$, which acts on a test function $f(x)$ as:\n$$\n\\mathcal{L} f(x) = -U'(x)\\,f'(x) + f''(x)\n$$\nThe eigenfunctions of this operator reveal the characteristic modes and timescales of the system. The eigenfunction corresponding to the second-slowest timescale (the first non-trivial one) serves as an excellent approximation for the reaction coordinate, which optimally describes the transition between the two potential wells. The problem requires a comparison of this eigenfunction with the committor function, the exact reaction coordinate.\n\nOur solution proceeds in four main stages, following the problem description:\n1.  Discretization of the operator $\\mathcal{L}$ on a spatial grid and assembly of its matrix representation under reflecting boundary conditions.\n2.  Numerical solution of the resulting matrix eigenproblem to find the key eigenvalues ($\\lambda_0, \\lambda_1$) and the first non-trivial eigenfunction ($\\phi_1$).\n3.  Calculation of the committor function $q(x)$ by solving a boundary value problem.\n4.  Quantitative comparison of the normalized eigenfunction $\\phi_1$ with the committor function $q(x)$ using a correlation coefficient and a parity error metric.\n\n**1. Discretization of the Generator $\\mathcal{L}$**\n\nWe discretize the spatial domain $[-L, L]$ into $N$ uniformly spaced points $x_i = -L + i \\cdot h$ for $i=0, 1, \\dots, N-1$, where the grid spacing is $h = 2L/(N-1)$. The value of a function $f(x)$ on this grid is denoted by the vector $\\mathbf{f}$ with components $f_i = f(x_i)$.\n\nThe first and second derivatives at an interior grid point $x_i$ ($i=1, \\dots, N-2$) are approximated using second-order central finite differences:\n$$\nf'(x_i) \\approx \\frac{f_{i+1} - f_{i-1}}{2h}, \\quad f''(x_i) \\approx \\frac{f_{i+1} - 2f_i + f_{i-1}}{h^2}\n$$\nSubstituting these into the expression for $\\mathcal{L}f(x_i)$ yields the discrete operator's action at interior points:\n$$\n(\\mathcal{L}f)_i \\approx -U'(x_i) \\left( \\frac{f_{i+1} - f_{i-1}}{2h} \\right) + \\left( \\frac{f_{i+1} - 2f_i + f_{i-1}}{h^2} \\right)\n$$\n$$\n(\\mathcal{L}f)_i \\approx \\left(\\frac{1}{h^2} + \\frac{U'(x_i)}{2h}\\right) f_{i-1} - \\frac{2}{h^2} f_i + \\left(\\frac{1}{h^2} - \\frac{U'(x_i)}{2h}\\right) f_{i+1}\n$$\nThis gives the coefficients for the tridiagonal structure of the matrix representation of $\\mathcal{L}$.\n\nFor the eigenproblem, we impose reflecting (Neumann) boundary conditions, $f'(\\pm L) = 0$. This is implemented using ghost points: $f_{-1} = f_1$ at the left boundary ($i=0$) and $f_N = f_{N-2}$ at the right boundary ($i=N-1$). The Neumann condition physically means that no probability flux leaves the domain. At the boundary $x_0 = -L$, the condition $f'(x_0)=0$ simplifies $\\mathcal{L}f(x_0)$ to just $f''(x_0)$. Using the central difference for $f''(x_0)$ and the ghost point condition:\n$$\n(\\mathcal{L}f)_0 \\approx f''(x_0) \\approx \\frac{f_1 - 2f_0 + f_{-1}}{h^2} = \\frac{f_1 - 2f_0 + f_1}{h^2} = \\frac{2}{h^2}(f_1 - f_0)\n$$\nA symmetric argument at $x_{N-1} = L$ yields:\n$$\n(\\mathcal{L}f)_{N-1} \\approx f''(x_{N-1}) \\approx \\frac{f_N - 2f_{N-1} + f_{N-2}}{h^2} = \\frac{f_{N-2} - 2f_{N-1} + f_{N-2}}{h^2} = \\frac{2}{h^2}(f_{N-2} - f_{N-1})\n$$\nThese formulas completely define the $N \\times N$ matrix representation, which we will call $L_{\\text{mat}}$.\n\n**2. The Eigenproblem: $\\mathcal{L}\\phi = \\lambda\\phi$**\n\nWe solve the matrix eigenproblem $L_{\\text{mat}}\\mathbf{\\phi} = \\lambda\\mathbf{\\phi}$ to find the eigenvalues $\\lambda$ and eigenvectors $\\mathbf{\\phi}$. The eigenvalues of $\\mathcal{L}$ are real and non-positive, representing the negative decay rates of the system's modes.\n- The eigenvalue with the smallest magnitude, $\\lambda_0$, is theoretically $0$. It corresponds to the stationary state of the system. For reflecting boundaries, the associated eigenfunction $\\phi_0$ is a constant vector, as $\\mathcal{L}C = 0$ for any constant $C$.\n- The eigenvalue with the second-smallest magnitude, $\\lambda_1$, is the first non-zero eigenvalue. The quantity $-\\lambda_1$ represents the rate of the slowest dynamical process in the system, which is the Arrhenius rate of transition between the potential wells. The corresponding eigenfunction, $\\phi_1$, describes the spatial form of this slow process and serves as an approximation to the reaction coordinate.\n\nAfter computing the eigenvalues and eigenvectors, we sort the eigenvalues by their absolute magnitude to identify $\\lambda_0$ and $\\lambda_1$. We then extract the corresponding real part of the eigenvector $\\phi_1$. For consistency, we orient $\\phi_1$ to be increasing with $x$ by ensuring $\\phi_1(-L)  \\phi_1(L)$. Finally, we normalize it to an affine-scaled version $g$ with range $[-1, 1]$:\n$$\ng = 2\\,\\frac{\\phi_1 - \\min(\\phi_1)}{\\max(\\phi_1)-\\min(\\phi_1)} - 1\n$$\n\n**3. The Committor Function**\n\nThe committor function, $q(x)$, is the canonical reaction coordinate. It is defined as the probability that a trajectory starting at $x$ will first reach the product state (approximated by $x=L$) before reaching the reactant state (approximated by $x=-L$). It is the solution to the backward Kolmogorov equation for a stationary process, subject to absorbing boundary conditions:\n$$\n\\mathcal{L} q(x) = 0 \\quad \\text{on} \\quad (-L,L), \\quad \\text{with} \\quad q(-L) = 0, \\quad q(L) = 1.\n$$\nTo solve this numerically, we use the same interior finite-difference scheme as before. This results in a system of $N-2$ linear equations for the $N-2$ unknown interior grid values $q_1, \\dots, q_{N-2}$. For a generic interior point $x_i$, the equation is:\n$$\n\\left(\\frac{1}{h^2} + \\frac{U'(x_i)}{2h}\\right) q_{i-1} - \\frac{2}{h^2} q_i + \\left(\\frac{1}{h^2} - \\frac{U'(x_i)}{2h}\\right) q_{i+1} = 0\n$$\nThe boundary conditions $q_0=0$ and $q_{N-1}=1$ are incorporated into the first and last equations of the system, modifying them into an inhomogeneous system of the form $A\\mathbf{q}_{\\text{int}} = \\mathbf{b}$, which can be readily solved. The centered committor is then defined as $c = 2q - 1$, which maps the committor to the interval $[-1, 1]$.\n\n**4. Analysis and Comparison**\n\nThe final step is to quantify the relationship between the approximate reaction coordinate $g$ (from the eigenfunction) and the exact one $c$ (from the committor).\n- **Pearson Correlation Coefficient**: We compute $\\mathrm{corr}(g, c)$. A value close to $+1$ indicates that $\\phi_1$ is an excellent proxy for the committor, which is expected for systems with high energy barriers separating metastable states.\n- **Parity Error**: For a symmetric potential $U(x)$, the first non-trivial eigenfunction $\\phi_1$ is expected to have odd symmetry, i.e., $\\phi_1(x) = -\\phi_1(-x)$. The parity error $\\varepsilon$ measures the deviation from this ideal symmetry:\n$$\n\\varepsilon = \\frac{\\max_i \\left| \\phi_{1,i} + \\phi_{1,(N-1-i)} \\right|}{\\max_i \\left| \\phi_{1,i} \\right| + 10^{-12}}\n$$\nA value of $\\varepsilon$ close to $0$ confirms the expected odd symmetry.\n\nThe algorithm is implemented in a Python program that iterates through the given test cases, performs these calculations, and reports the four requested metrics: $\\lambda_0$, $\\lambda_1$, $\\mathrm{corr}$, and $\\varepsilon$.",
            "answer": "```python\nimport numpy as np\nfrom scipy import linalg\n\ndef process_case(a, L, N):\n    \"\"\"\n    Computes the specified metrics for a single test case (a, L, N).\n\n    Args:\n        a (float): Parameter for the potential U(x) = a*(x**2 - 1)**2.\n        L (float): The half-width of the symmetric interval [-L, L].\n        N (int): The number of grid points.\n\n    Returns:\n        list: A list of four floats [lambda_0, lambda_1, corr, epsilon].\n    \"\"\"\n    # 1. Grid and Potential Setup\n    x = np.linspace(-L, L, N)\n    h = 2 * L / (N - 1)\n    U_prime = 4 * a * (x**3 - x)\n\n    # 2. Assemble and solve the Neumann Eigenproblem\n    L_mat = np.zeros((N, N))\n\n    # Boundary rows for reflecting BCs\n    L_mat[0, 0] = -2 / h**2\n    L_mat[0, 1] = 2 / h**2\n    L_mat[N - 1, N - 2] = 2 / h**2\n    L_mat[N - 1, N - 1] = -2 / h**2\n\n    # Interior rows\n    for i in range(1, N - 1):\n        c_minus = 1/h**2 + U_prime[i] / (2*h)\n        c_zero = -2/h**2\n        c_plus = 1/h**2 - U_prime[i] / (2*h)\n        L_mat[i, i - 1] = c_minus\n        L_mat[i, i] = c_zero\n        L_mat[i, i + 1] = c_plus\n\n    eigvals, eigvecs = linalg.eig(L_mat)\n\n    # Identify eigenvalues and the first non-trivial eigenfunction\n    sorted_indices = np.argsort(np.abs(eigvals))\n    idx0, idx1 = sorted_indices[0], sorted_indices[1]\n\n    lambda_0 = np.real(eigvals[idx0])\n    lambda_1 = np.real(eigvals[idx1])\n    \n    phi_1 = np.real(eigvecs[:, idx1])\n    \n    # Enforce consistent orientation for phi_1 (monotonically increasing)\n    if phi_1[-1]  phi_1[0]:\n        phi_1 = -phi_1\n\n    # Normalize phi_1 to g, ranging from -1 to 1\n    min_phi1, max_phi1 = np.min(phi_1), np.max(phi_1)\n    if (max_phi1 - min_phi1)  1e-12: # Avoid division by zero\n        g = np.zeros_like(phi_1)\n    else:\n        g = 2 * (phi_1 - min_phi1) / (max_phi1 - min_phi1) - 1\n\n    # 3. Solve the Committor Boundary Value Problem\n    # System A*q_int = b for interior points q_1, ..., q_{N-2}\n    A_committor = np.zeros((N - 2, N - 2))\n    b_committor = np.zeros(N - 2)\n\n    for i in range(1, N - 1):\n        row_idx = i - 1\n        \n        c_minus = 1/h**2 + U_prime[i] / (2*h)\n        c_zero = -2/h**2\n        c_plus = 1/h**2 - U_prime[i] / (2*h)\n        \n        if i > 1:\n            A_committor[row_idx, row_idx - 1] = c_minus\n        \n        A_committor[row_idx, row_idx] = c_zero\n        \n        if i  N - 2:\n            A_committor[row_idx, row_idx + 1] = c_plus\n        else: # i=N-2, use q(L)=1 BC\n            b_committor[row_idx] = -c_plus * 1.0\n            \n    q_interior = linalg.solve(A_committor, b_committor)\n\n    # Construct full committor q and centered committor c\n    q = np.zeros(N)\n    q[0], q[N-1] = 0.0, 1.0\n    q[1:N-1] = q_interior\n    c = 2 * q - 1\n\n    # 4. Compute Metrics\n    # Pearson correlation coefficient between g and c\n    corr = np.corrcoef(g, c)[0, 1]\n\n    # Parity error for phi_1\n    phi1_flipped = phi_1[::-1]\n    numerator = np.max(np.abs(phi_1 + phi1_flipped))\n    denominator = np.max(np.abs(phi_1)) + 1e-12\n    epsilon = numerator / denominator\n\n    return [lambda_0, lambda_1, corr, epsilon]\n\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        (10.0, 1.5, 201),  # Case 1 (happy path, high barrier)\n        (4.0, 1.5, 201),   # Case 2 (moderate barrier)\n        (1.0, 1.5, 201),   # Case 3 (low barrier)\n        (4.0, 1.5, 51),    # Case 4 (edge case, coarse grid)\n    ]\n\n    results = []\n    for case in test_cases:\n        a, L, N = case\n        result = process_case(a, L, N)\n        results.append(result)\n\n    # Format the output as specified\n    formatted_results = [f\"[{','.join(map(str, res))}]\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n# Execute the solution\nsolve()\n```"
        },
        {
            "introduction": "Beyond describing average behavior and the slowest relaxation modes, the Fokker-Planck framework provides a complete statistical description of the dynamics, including the probability of rare fluctuations. This advanced practice explores this deeper connection using the powerful Feynman-Kac formalism . You will derive the relationship between the statistical fluctuations of a particle's residence time in a given region and the spectrum of a modified \"tilted\" Fokker-Planck operator, revealing how the principal eigenvalue of this operator acts as a generating function for the full distribution of this important dynamical observable.",
            "id": "3808978",
            "problem": "Consider a coarse-grained coordinate $x(t)$ representing a one-dimensional collective variable for a crystalline microstructure, evolving under overdamped thermal fluctuations on a ring of length $L$ with periodic boundary conditions. The dynamics are modeled by the stochastic differential equation $\\mathrm{d}x(t) = \\sqrt{2 D} \\, \\mathrm{d}W(t)$, where $D$ is the constant diffusivity and $W(t)$ is a standard Wiener process. Let $\\chi_{A}(x)$ denote the indicator function of a material-relevant set $A = [0,a] \\subset [0,L)$ with $0  a  L$, and define the residence time in $A$ up to time $t$ as $T_{A}(t) = \\int_{0}^{t} \\chi_{A}(x(\\tau)) \\, \\mathrm{d}\\tau$. The process is initialized from the stationary distribution, which is uniform on $[0,L)$.\n\nDefine the moment generating function in the Laplace sense (i.e., a Laplace transform of the residence-time distribution) by $M(s,t) = \\mathbb{E}\\left[\\exp\\left(- s \\, T_{A}(t)\\right)\\right]$ for $s \\geq 0$. Starting from first principles, derive the Feynman–Kac representation for $M(s,t)$ using the Fokker–Planck equation (FPE), and show that in the long-time limit the scaled cumulant generating function $\\psi(s) = \\lim_{t \\to \\infty} \\frac{1}{t} \\ln M(s,t)$ is equal to the principal (largest real) eigenvalue of the tilted Fokker–Planck operator\n$$\n\\mathcal{L}_{s} = D \\, \\partial_{x}^{2} - s \\, \\chi_{A}(x)\n$$\nacting on $L^{2}([0,L])$ with periodic boundary conditions. Compute $\\psi(s)$ to second order in the tilting parameter $s$ by perturbation theory in $s$, expressing the result in terms of $a$, $L$, and $D$. Then, interpret the role of the spectrum of $\\mathcal{L}_{s}$ for the large-time fluctuations of $T_{A}(t)$ and identify the physical meaning of the principal eigenvalue and the spectral gap in this coarse-grained dynamics context.\n\nExpress your final answer symbolically. No numerical rounding is required.",
            "solution": "The problem requires a multistep analysis of the residence time statistics for a particle undergoing Brownian motion on a ring. We will proceed by first deriving the Feynman-Kac representation for the moment generating function, then relating its long-time behavior to the principal eigenvalue of a tilted operator, followed by a perturbative calculation of this eigenvalue, and finally a physical interpretation of the results.\n\n### Part 1: Feynman-Kac Representation\n\nThe coarse-grained coordinate $x(t)$ evolves according to the stochastic differential equation (SDE) $\\mathrm{d}x(t) = \\sqrt{2D} \\, \\mathrm{d}W(t)$ on the domain $[0,L)$ with periodic boundary conditions. The Fokker-Planck equation for the probability density $p(x,t)$ of the particle's position is given by $\\partial_t p = D \\partial_x^2 p$.\n\nWe are interested in the moment generating function of the residence time $T_A(t) = \\int_{0}^{t} \\chi_{A}(x(\\tau)) \\, \\mathrm{d}\\tau$, defined as $M(s,t) = \\mathbb{E}\\left[\\exp\\left(-s T_A(t)\\right)\\right]$. The expectation is taken over all paths starting from the stationary distribution $p_{st}(x) = 1/L$.\n\nTo derive the governing equation for $M(s,t)$, we introduce a more general quantity, the \"tilted\" propagator or conditional probability density, which keeps track of both position and accumulated residence time:\n$$\nq(x,t | x_0) = \\mathbb{E}_{x_0}\\left[\\exp\\left(-s \\int_{0}^{t} \\chi_{A}(x(\\tau)) \\, \\mathrm{d}\\tau\\right) \\delta(x(t)-x)\\right]\n$$\nThis represents the density of paths starting at $x(0)=x_0$ and ending at $x(t)=x$, weighted by the residence time functional. The time evolution of $q(x,t|x_0)$ over an infinitesimal time step $\\mathrm{d}t$ is found by considering the Chapman-Kolmogorov equation for the weighted paths:\n$$\nq(x, t+\\mathrm{d}t | x_0) = \\int_0^L \\mathbb{P}(x(t+\\mathrm{d}t) = x | x(t)=y) \\, \\exp(-s \\chi_{A}(y) \\mathrm{d}t) \\, q(y,t|x_0) \\, \\mathrm{d}y\n$$\nThe short-time transition probability for the SDE is a Gaussian kernel:\n$$\n\\mathbb{P}(x(t+\\mathrm{d}t) = x | x(t)=y) = \\frac{1}{\\sqrt{4\\pi D \\mathrm{d}t}} \\exp\\left(-\\frac{(x-y)^2}{4D \\mathrm{d}t}\\right)\n$$\nExpanding $\\exp(-s \\chi_{A}(y) \\mathrm{d}t) \\approx 1 - s \\chi_{A}(y) \\mathrm{d}t$ and Taylor expanding $q(y,t|x_0)$ around $y=x$ within the integral, we perform a Kramers-Moyal expansion. The standard procedure yields the backward Kolmogorov equation for $q$, but since the operator is self-adjoint, it satisfies the same forward equation (Fokker-Planck type):\n$$\n\\frac{\\partial}{\\partial t} q(x,t|x_0) = \\left(D \\frac{\\partial^2}{\\partial x^2} - s \\chi_{A}(x)\\right) q(x,t|x_0) = \\mathcal{L}_s \\, q(x,t|x_0)\n$$\nThis is a generalized Fokker-Planck equation, often called a Feynman-Kac equation. The operator $\\mathcal{L}_s = D \\partial_x^2 - s \\chi_A(x)$ is the tilted Fokker-Planck operator specified in the problem.\n\nThe process starts from the stationary distribution $p_{st}(x_0) = 1/L$. We define $P(x,t)$ as the probability density at time $t$ averaged over initial positions drawn from $p_{st}$:\n$$\nP(x,t) = \\int_0^L q(x,t|x_0) p_{st}(x_0) \\, \\mathrm{d}x_0 = \\frac{1}{L} \\int_0^L q(x,t|x_0) \\, \\mathrm{d}x_0\n$$\nSince $\\mathcal{L}_s$ is independent of $x_0$, $P(x,t)$ also obeys the PDE $\\partial_t P(x,t) = \\mathcal{L}_s P(x,t)$. The initial condition is $P(x,0) = p_{st}(x) = 1/L$. The moment generating function is obtained by integrating $P(x,t)$ over all final positions:\n$$\nM(s,t) = \\int_0^L P(x,t) \\, \\mathrm{d}x\n$$\nThis constitutes the Feynman-Kac representation: $M(s,t)$ is the spatial integral of the solution to the PDE $\\partial_t P = \\mathcal{L}_s P$ with initial condition $P(x,0) = 1/L$.\n\n### Part 2: Long-Time Limit and Principal Eigenvalue\n\nThe operator $\\mathcal{L}_s$ is a self-adjoint Sturm-Liouville operator on $L^2([0,L])$ with periodic boundary conditions. Its spectrum consists of real, discrete eigenvalues $\\{\\lambda_n(s)\\}_{n=0}^\\infty$ with corresponding eigenfunctions $\\{\\phi_n(x;s)\\}_{n=0}^\\infty$. For $s \\geq 0$, the Krein-Rutman theorem ensures the existence of a simple, principal (largest) eigenvalue $\\lambda_0(s)$, and its corresponding eigenfunction $\\phi_0(x;s)$ can be chosen to be strictly positive.\n\nWe can express the solution $P(x,t)$ as an eigenfunction expansion:\n$$\nP(x,t) = \\sum_{n=0}^{\\infty} c_n \\phi_n(x;s) \\exp(\\lambda_n(s) t)\n$$\nThe coefficients $c_n$ are determined by the initial condition $P(x,0) = 1/L$ via the inner product $\\langle f, g \\rangle = \\int_0^L f^*(x) g(x) \\mathrm{d}x$:\n$$\nc_n = \\langle \\phi_n(\\cdot;s), P(\\cdot,0) \\rangle = \\int_0^L \\phi_n^*(x;s) \\frac{1}{L} \\, \\mathrm{d}x\n$$\nFor large times $t \\to \\infty$, the sum is dominated by the term with the largest eigenvalue $\\lambda_0(s)$:\n$$\nP(x,t) \\approx c_0 \\phi_0(x;s) \\exp(\\lambda_0(s) t)\n$$\nThen, the moment generating function for large $t$ is:\n$$\nM(s,t) = \\int_0^L P(x,t) \\, \\mathrm{d}x \\approx c_0 \\exp(\\lambda_0(s) t) \\int_0^L \\phi_0(x;s) \\, \\mathrm{d}x\n$$\nThe scaled cumulant generating function is then:\n$$\n\\psi(s) = \\lim_{t \\to \\infty} \\frac{1}{t} \\ln M(s,t) = \\lim_{t \\to \\infty} \\frac{1}{t} \\left( \\ln\\left(c_0 \\int_0^L \\phi_0(x;s) \\mathrm{d}x \\right) + \\lambda_0(s) t \\right) = \\lambda_0(s)\n$$\nThus, $\\psi(s)$ is precisely the principal eigenvalue of the tilted operator $\\mathcal{L}_s$.\n\n### Part 3: Perturbation Theory Calculation\n\nWe compute $\\lambda_0(s)$ to second order in $s$ using standard time-independent perturbation theory. The operator is $\\mathcal{L}_s = \\mathcal{L}_0 + s\\mathcal{V}$, where the unperturbed operator is $\\mathcal{L}_0 = D \\partial_x^2$ and the perturbation is $\\mathcal{V} = -\\chi_A(x)$.\n\nThe unperturbed eigenproblem is $\\mathcal{L}_0 \\phi_k^{(0)} = \\lambda_k^{(0)} \\phi_k^{(0)}$. The orthonormal eigenfunctions and eigenvalues on $[0,L]$ with periodic boundary conditions are:\n$$\n\\phi_k^{(0)}(x) = \\frac{1}{\\sqrt{L}} \\exp\\left(i \\frac{2\\pi k}{L} x\\right), \\quad k \\in \\mathbb{Z}\n$$\n$$\n\\lambda_k^{(0)} = -D \\left(\\frac{2\\pi k}{L}\\right)^2\n$$\nThe unperturbed principal eigenvalue is for $k=0$: $\\lambda_0^{(0)} = 0$, with eigenfunction $\\phi_0^{(0)}(x) = 1/\\sqrt{L}$. This eigenvalue is non-degenerate.\n\n**First-Order Correction:**\nThe first-order correction to the principal eigenvalue is given by:\n$$\n\\lambda_0^{(1)} = \\langle \\phi_0^{(0)} | \\mathcal{V} | \\phi_0^{(0)} \\rangle = \\int_0^L \\left(\\frac{1}{\\sqrt{L}}\\right) (-\\chi_A(x)) \\left(\\frac{1}{\\sqrt{L}}\\right) \\mathrm{d}x = -\\frac{1}{L} \\int_0^a \\mathrm{d}x = -\\frac{a}{L}\n$$\n\n**Second-Order Correction:**\nThe second-order correction is given by the sum over all other states:\n$$\n\\lambda_0^{(2)} = \\sum_{k \\in \\mathbb{Z}, k \\neq 0} \\frac{|\\langle \\phi_k^{(0)} | \\mathcal{V} | \\phi_0^{(0)} \\rangle|^2}{\\lambda_0^{(0)} - \\lambda_k^{(0)}}\n$$\nFirst, we compute the matrix elements for $k \\neq 0$:\n$$\n\\langle \\phi_k^{(0)} | \\mathcal{V} | \\phi_0^{(0)} \\rangle = \\int_0^L \\left(\\frac{1}{\\sqrt{L}} e^{i\\frac{2\\pi k}{L}x}\\right)^* (-\\chi_A(x)) \\left(\\frac{1}{\\sqrt{L}}\\right) \\mathrm{d}x = -\\frac{1}{L} \\int_0^a e^{-i\\frac{2\\pi k}{L}x} \\mathrm{d}x\n$$\n$$\n= -\\frac{1}{L} \\left[ \\frac{e^{-i\\frac{2\\pi k}{L}x}}{-i\\frac{2\\pi k}{L}} \\right]_0^a = \\frac{1}{i 2\\pi k} \\left( e^{-i\\frac{2\\pi k a}{L}} - 1 \\right)\n$$\nThe squared magnitude is:\n$$\n|\\langle \\phi_k^{(0)} | \\mathcal{V} | \\phi_0^{(0)} \\rangle|^2 = \\frac{1}{(2\\pi k)^2} | e^{-i\\frac{2\\pi k a}{L}} - 1 |^2 = \\frac{1}{(2\\pi k)^2} (2 - 2\\cos(\\frac{2\\pi k a}{L})) = \\frac{4\\sin^2(\\frac{\\pi k a}{L})}{(2\\pi k)^2} = \\frac{\\sin^2(\\frac{\\pi k a}{L})}{(\\pi k)^2}\n$$\nThe energy denominator is $\\lambda_0^{(0)} - \\lambda_k^{(0)} = 0 - \\left(-D (\\frac{2\\pi k}{L})^2\\right) = D \\frac{4\\pi^2 k^2}{L^2}$.\nSubstituting these into the formula for $\\lambda_0^{(2)}$:\n$$\n\\lambda_0^{(2)} = \\sum_{k \\neq 0} \\frac{\\frac{\\sin^2(\\frac{\\pi k a}{L})}{(\\pi k)^2}}{D \\frac{4\\pi^2 k^2}{L^2}} = \\frac{L^2}{4D\\pi^4} \\sum_{k \\neq 0} \\frac{\\sin^2(\\frac{\\pi k a}{L})}{k^4}\n$$\nThe summand is an even function of $k$, so the sum over $k \\in \\mathbb{Z}, k \\neq 0$ is twice the sum over $k \\in \\mathbb{N}$:\n$$\n\\lambda_0^{(2)} = \\frac{L^2}{2D\\pi^4} \\sum_{k=1}^{\\infty} \\frac{\\sin^2(\\frac{\\pi k a}{L})}{k^4}\n$$\nThe sum can be evaluated using the known Fourier series of Bernoulli polynomials. The relevant identity is $\\sum_{k=1}^{\\infty} \\frac{\\cos(2\\pi k u)}{k^{2n}} = (-1)^{n-1} \\frac{(2\\pi)^{2n}}{2(2n)!} B_{2n}(u)$ for $u \\in (0,1)$. For $2n=4$:\n$$\n\\sum_{k=1}^\\infty \\frac{\\sin^2(\\pi k u)}{k^4} = \\frac{1}{2}\\sum_{k=1}^\\infty \\frac{1-\\cos(2\\pi k u)}{k^4} = \\frac{1}{2}\\left(\\zeta(4) - \\sum_{k=1}^\\infty \\frac{\\cos(2\\pi k u)}{k^4}\\right)\n$$\nWith $\\zeta(4) = \\frac{\\pi^4}{90}$ and $\\sum_{k=1}^\\infty \\frac{\\cos(2\\pi k u)}{k^4} = -\\frac{\\pi^4}{3}B_4(u)$, where $B_4(u) = u^4-2u^3+u^2-\\frac{1}{30}$:\n$$\n\\sum_{k=1}^{\\infty} \\frac{\\sin^2(\\pi k u)}{k^4} = \\frac{1}{2}\\left(\\frac{\\pi^4}{90} + \\frac{\\pi^4}{3}(u^4-2u^3+u^2-\\frac{1}{30})\\right) = \\frac{\\pi^4}{6}(u^4-2u^3+u^2) = \\frac{\\pi^4}{6}u^2(1-u)^2\n$$\nSetting $u=a/L$, we find the sum:\n$$\n\\sum_{k=1}^{\\infty} \\frac{\\sin^2(\\frac{\\pi k a}{L})}{k^4} = \\frac{\\pi^4}{6} \\left(\\frac{a}{L}\\right)^2 \\left(1-\\frac{a}{L}\\right)^2\n$$\nFinally, substituting this back into the expression for $\\lambda_0^{(2)}$:\n$$\n\\lambda_0^{(2)} = \\frac{L^2}{2D\\pi^4} \\left( \\frac{\\pi^4}{6} \\frac{a^2}{L^2} \\frac{(L-a)^2}{L^2} \\right) = \\frac{a^2(L-a)^2}{12 D L^2}\n$$\n\n**Final Result for $\\psi(s)$:**\nCombining the terms, the scaled cumulant generating function up to second order in $s$ is:\n$$\n\\psi(s) = \\lambda_0(s) \\approx \\lambda_0^{(0)} + s\\lambda_0^{(1)} + s^2\\lambda_0^{(2)} = 0 + s\\left(-\\frac{a}{L}\\right) + s^2\\left(\\frac{a^2(L-a)^2}{12DL^2}\\right)\n$$\n$$\n\\psi(s) \\approx -\\frac{a}{L}s + \\frac{a^2(L-a)^2}{12DL^2}s^2\n$$\n\n### Part 4: Physical Interpretation\n\nThe spectrum of the tilted operator $\\mathcal{L}_s$ contains crucial information about the long-time fluctuations of the residence time $T_A(t)$.\n- **Principal Eigenvalue $\\psi(s) = \\lambda_0(s)$**: This is the scaled cumulant generating function (SCGF) for the time-averaged residence time $T_A(t)/t$. By large deviation theory, $\\psi(s)$ determines the probability of rare events, i.e., observing a value of $T_A(t)/t$ significantly different from its mean. Specifically, $\\psi(s)$ is the Legendre-Fenchel transform of the rate function $I(\\rho)$ that quantifies the exponential decay of the probability $P(T_A(t)/t \\approx \\rho) \\asymp \\exp(-t I(\\rho))$.\nThe derivatives of $\\psi(s)$ at $s=0$ yield the scaled cumulants of $T_A(t)$. The first cumulant gives the average: $\\lim_{t\\to\\infty} \\frac{1}{t}\\mathbb{E}[T_A(t)] = -\\psi'(0) = a/L$. This is the fraction of the domain occupied by set $A$, as expected from ergodicity. The second cumulant gives the diffusion constant of the residence time: $\\lim_{t\\to\\infty} \\frac{1}{t}\\mathrm{Var}(T_A(t)) = \\psi''(0)$. Our calculation gives $\\psi''(0) = \\frac{a^2(L-a)^2}{6DL^2}$. This value is proportional to the integrated time-autocorrelation function of the fluctuations of the indicator function $\\chi_A(x(t))$, representing the effective variance of the process.\n\n- **Spectral Gap**: The spectral gap of $\\mathcal{L}_s$, $\\Delta_s = \\lambda_0(s) - \\lambda_1(s)$, where $\\lambda_1(s)$ is the second-largest eigenvalue, determines the time scale for convergence to the long-time asymptotic behavior. For the unperturbed system ($s=0$), the gap is $\\Delta_0 = \\lambda_0^{(0)} - \\lambda_1^{(0)} = 0 - (-D(2\\pi/L)^2) = 4\\pi^2 D/L^2$. The inverse of this gap, $\\tau_{rel} = 1/\\Delta_0=L^2/(4\\pi^2D)$, is the correlation time of the underlying stochastic process $x(t)$. It defines the time scale over which the particle \"forgets\" its initial position. In the context of the residence time fluctuations, the gap of $\\mathcal{L}_s$ determines the characteristic time scale for the large deviation statistics to become established. It sets the minimal observation time $t$ for which the asymptotic description $P(T_A(t)/t \\approx \\rho) \\asymp \\exp(-t I(\\rho))$ is valid.",
            "answer": "$$\\boxed{-\\frac{a}{L}s + \\frac{a^2(L-a)^2}{12DL^2}s^2}$$"
        }
    ]
}