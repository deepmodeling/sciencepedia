{
    "hands_on_practices": [
        {
            "introduction": "在应用福克-普朗克方程时，一个关键的初始步骤是确定其系数——漂移项 $a(q)$ 和扩散项 $D(q)$。本练习将演示一种基本方法，即如何从微观模拟的短时轨迹中估计这些系数。我们还将探讨在实际应用中至关重要的一个问题：使用有限时间步长 $\\Delta t$ 所引入的系统性偏差 。",
            "id": "3808991",
            "problem": "考虑一个多尺度材料系统中，底层微观动力学的一个标量粗粒化可观测量 $q$。假设在粗粒时间尺度上，$q$ 可以很好地由以下形式的 Itô 随机微分方程 (SDE) 描述\n$$\ndq(t) \\;=\\; a(q(t))\\,dt \\;+\\; \\sqrt{2\\,D(q(t))}\\,dW_t,\n$$\n其中 $a(q)$ 是粗粒化漂移，$D(q)$ 是粗粒化扩散，$W_t$ 是一个标准维纳过程。相关的 Fokker–Planck 方程控制着 $q(t)$ 的概率密度的时间演化。\n\n您的任务是设计并实现一个方案，使用在固定 $q$ 值下的条件时间增量，从短暂的微观动力学模拟中估计 $a(q)$ 和 $D(q)$。您的方案必须从基本定义和推论出发，并且必须明确地处理因使用有限粗粒时间增量 $\\Delta t$ 而引入的偏差。本问题中的所有量均为无量纲。\n\n起点和约束条件：\n- 从前两个 Kramers–Moyal 系数的定义出发，即在给定 $q(t)=q$ 的条件下，增量 $\\Delta q = q(t+\\Delta t)-q(t)$ 的一阶和二阶条件矩在 $\\Delta t \\to 0$ 时的极限。以此为基础，推导基于短暂微观动力学模拟的估计方案。\n- 除了从所选的微观动力学推导出的情况外，您不能对 $a(q)$ 和 $D(q)$ 假设任何超出下文所述的闭式表达式。\n- 为具体起见，假设底层的粗粒化 SDE 是具有恒定扩散的线性模型，即 Ornstein–Uhlenbeck 模型\n$$\ndq(t) \\;=\\; -k\\,q(t)\\,dt \\;+\\; \\sqrt{2\\,D_0}\\,dW_t,\n$$\n其中 $k>0$ 和 $D_0>0$ 是常数。这个选择模拟了一个稳定的粗粒化恢复漂移和附加的类热涨落。\n- 将“短暂的分子动力学 (MD) 爆发”模拟为从一个固定值 $q^\\star$ 开始，在粗粒时间 $\\Delta t$ 内的精确短时演化。在这种线性情况下，$q$ 在时间 $\\Delta t$ 内的跃迁是高斯的，具有明确定义的均值和方差；利用这一点来计算您的估计量所需的条件期望。\n\n您的任务：\n- 从 Kramers–Moyal 定义出发，推导使用从 $q^\\star$ 开始的短时程模拟计算的条件时间增量，来估计 $a(q^\\star)$ 和 $D(q^\\star)$ 的一致的有限 $\\Delta t$ 估计量。在上述线性 SDE 的特殊情况下，明确量化并讨论使用有限 $\\Delta t$ 引入的偏差。\n- 实现一个程序，对于给定的参数，在固定的 $q^\\star$ 处评估有限 $\\Delta t$ 估计量，并报告相对于真实 $a(q^\\star)$ 和 $D(q^\\star)$ 的相对偏差。\n\n测试套件：\n- 使用 $k = 1.5$，$D_0 = 0.7$ 和 $q^\\star = 0.8$。\n- 评估四个不同的粗粒时间增量，以探究小 $\\Delta t$ 和大 $\\Delta t$ 的情况：\n  - 情况 1：$\\Delta t = 10^{-4}$。\n  - 情况 2：$\\Delta t = 10^{-2}$。\n  - 情况 3：$\\Delta t = 10^{-1}$。\n  - 情况 4：$\\Delta t = 1$。\n- 对于每种情况，计算两个浮点数：\n  - 在 $q^\\star$ 处的漂移估计的相对偏差，定义为\n    $$\n    \\frac{\\widehat{a}_{\\Delta t}(q^\\star) - a(q^\\star)}{\\lvert a(q^\\star) \\rvert},\n    $$\n    其中 $\\widehat{a}_{\\Delta t}(q^\\star)$ 是您的有限 $\\Delta t$ 估计量，$a(q^\\star)$ 是真实漂移。\n  - 在 $q^\\star$ 处的扩散估计的相对偏差，定义为\n    $$\n    \\frac{\\widehat{D}_{\\Delta t}(q^\\star) - D(q^\\star)}{D(q^\\star)}.\n    $$\n- 所有变量都是无量纲的；以普通小数形式报告浮点数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序如下\n$$\n[\\,\\text{drift\\_bias}_{1},\\;\\text{diffusion\\_bias}_{1},\\;\\text{drift\\_bias}_{2},\\;\\text{diffusion\\_bias}_{2},\\;\\text{drift\\_bias}_{3},\\;\\text{diffusion\\_bias}_{3},\\;\\text{drift\\_bias}_{4},\\;\\text{diffusion\\_bias}_{4}\\,].\n$$\n不应打印任何额外文本。",
            "solution": "该问题要求推导并实现一个方案，用于从模拟的短时轨迹数据中估计标量 Itô 随机微分方程 (SDE) 的漂移系数 $a(q)$ 和扩散系数 $D(q)$。该方案需基于 Kramers–Moyal 系数的定义，并且必须考虑使用有限时间增量 $\\Delta t$ 所引入的偏差。\n\n粗粒化可观测量 $q(t)$ 的 SDE 的一般形式由下式给出\n$$\ndq(t) = a(q(t))\\,dt + \\sqrt{2\\,D(q(t))}\\,dW_t,\n$$\n其中 $W_t$ 是一个标准维纳过程。漂移系数 $a(q)$ 和扩散系数 $D(q)$ 由前两个 Kramers–Moyal 系数形式上定义，它们是在给定状态 $q(t)=q$ 的条件下，增量 $\\Delta q \\equiv q(t+\\Delta t) - q(t)$ 的条件矩的极限：\n$$\na(q) = \\lim_{\\Delta t \\to 0} \\frac{1}{\\Delta t} \\mathbb{E}[\\Delta q | q(t)=q]\n$$\n$$\n2D(q) = \\lim_{\\Delta t \\to 0} \\frac{1}{\\Delta t} \\mathbb{E}[(\\Delta q)^2 | q(t)=q]\n$$\n\n通过去掉极限，可以为 $a(q)$ 和 $D(q)$ 在有限时间步长 $\\Delta t$ 下构建一组自然但有偏的估计量。这些估计量我们记为 $\\widehat{a}_{\\Delta t}(q)$ 和 $\\widehat{D}_{\\Delta t}(q)$，它们基于从固定值 $q^\\star$ 开始的短时程动力学模拟中评估的增量的前两阶矩的期望值：\n$$\n\\widehat{a}_{\\Delta t}(q^\\star) = \\frac{1}{\\Delta t} \\mathbb{E}[q(t+\\Delta t) - q(t) | q(t)=q^\\star]\n$$\n$$\n\\widehat{D}_{\\Delta t}(q^\\star) = \\frac{1}{2\\Delta t} \\mathbb{E}[(q(t+\\Delta t) - q(t))^2 | q(t)=q^\\star]\n$$\n为了分析这些估计量，我们必须为指定的底层动力学计算所需的条件期望。\n\n问题指定了 Ornstein–Uhlenbeck (OU) 过程，这是一个具有恒定扩散的线性 SDE：\n$$\ndq(t) = -k\\,q(t)\\,dt + \\sqrt{2\\,D_0}\\,dW_t,\n$$\n其中 $k>0$ 和 $D_0>0$ 是常数。通过与通用 SDE 形式直接比较，真实的系数为：\n$$\na(q) = -k\\,q\n$$\n$$\nD(q) = D_0\n$$\nOU SDE 的解析解提供了评估条件期望所需的精确跃迁概率。为了求解该 SDE，我们使用积分因子 $e^{kt}$。设定初始时间为 $t=0$，条件为 $q(0)=q^\\star$，我们有：\n$$\nd(e^{kt}q(t)) = e^{kt}(dq(t) + k\\,q(t)\\,dt) = e^{kt}\\sqrt{2D_0}\\,dW_t\n$$\n从 $t=0$ 积分到 $t=\\Delta t$ 得到：\n$$\ne^{k\\Delta t}q(\\Delta t) - q(0) = \\sqrt{2D_0} \\int_0^{\\Delta t} e^{kt'}\\,dW_{t'}\n$$\n$$\nq(\\Delta t) = q^\\star e^{-k\\Delta t} + \\sqrt{2D_0} \\int_0^{\\Delta t} e^{-k(\\Delta t - t')}\\,dW_{t'}\n$$\n这个表达式表明，在 $q(0)=q^\\star$ 的条件下，变量 $q(\\Delta t)$ 是一个高斯随机变量。通过取期望可以求得其均值，注意到随机积分的均值为零：\n$$\n\\mathbb{E}[q(\\Delta t) | q(0)=q^\\star] = q^\\star e^{-k\\Delta t}\n$$\n其方差可使用 Itô 等距性质求得：\n$$\n\\text{Var}[q(\\Delta t) | q(0)=q^\\star] = \\text{Var}\\left[\\sqrt{2D_0} \\int_0^{\\Delta t} e^{-k(\\Delta t - t')}\\,dW_{t'}\\right] = 2D_0 \\int_0^{\\Delta t} \\left(e^{-k(\\Delta t - t')}\\right)^2 dt'\n$$\n$$\n\\text{Var}[q(\\Delta t) | q(0)=q^\\star] = 2D_0 \\int_0^{\\Delta t} e^{-2k(\\Delta t - t')} dt' = 2D_0 \\left[ \\frac{e^{-2k(\\Delta t - t')}}{2k} \\right]_0^{\\Delta t} = \\frac{D_0}{k}(1 - e^{-2k\\Delta t})\n$$\n现在我们可以计算增量 $\\Delta q = q(\\Delta t) - q^\\star$ 的条件矩。一阶矩为：\n$$\n\\mathbb{E}[\\Delta q | q(0)=q^\\star] = \\mathbb{E}[q(\\Delta t) | q(0)=q^\\star] - q^\\star = q^\\star e^{-k\\Delta t} - q^\\star = q^\\star (e^{-k\\Delta t} - 1)\n$$\n对于二阶矩，我们使用性质 $\\mathbb{E}[X^2] = \\text{Var}[X] + (\\mathbb{E}[X])^2$：\n$$\n\\mathbb{E}[(\\Delta q)^2 | q(0)=q^\\star] = \\text{Var}[\\Delta q | q(0)=q^\\star] + (\\mathbb{E}[\\Delta q | q(0)=q^\\star])^2\n$$\n由于 $\\Delta q = q(\\Delta t) - q^\\star$ 且 $q^\\star$ 是一个常数，所以 $\\text{Var}[\\Delta q] = \\text{Var}[q(\\Delta t)]$。因此：\n$$\n\\mathbb{E}[(\\Delta q)^2 | q(0)=q^\\star] = \\frac{D_0}{k}(1 - e^{-2k\\Delta t}) + \\left(q^\\star (e^{-k\\Delta t} - 1)\\right)^2\n$$\n将这些结果代入我们的有限 $\\Delta t$ 估计量的定义中，我们得到它们对于 OU 过程的精确表达式：\n$$\n\\widehat{a}_{\\Delta t}(q^\\star) = \\frac{1}{\\Delta t} \\mathbb{E}[\\Delta q | q(0)=q^\\star] = \\frac{q^\\star (e^{-k\\Delta t} - 1)}{\\Delta t}\n$$\n$$\n\\widehat{D}_{\\Delta t}(q^\\star) = \\frac{1}{2\\Delta t} \\mathbb{E}[(\\Delta q)^2 | q(0)=q^\\star] = \\frac{1}{2\\Delta t} \\left[ \\frac{D_0}{k}(1 - e^{-2k\\Delta t}) + (q^\\star)^2(e^{-k\\Delta t} - 1)^2 \\right]\n$$\n为了分析偏差，我们将这些表达式与真实值 $a(q^\\star) = -k\\,q^\\star$ 和 $D(q^\\star) = D_0$ 进行比较。\n\n对于漂移估计量，考虑其在小 $\\Delta t$ 时的泰勒级数展开：\n$$\ne^{-k\\Delta t} = 1 - k\\Delta t + \\frac{(k\\Delta t)^2}{2} - \\frac{(k\\Delta t)^3}{6} + \\mathcal{O}(\\Delta t^4)\n$$\n$$\n\\widehat{a}_{\\Delta t}(q^\\star) = \\frac{q^\\star}{\\Delta t} \\left(-k\\Delta t + \\frac{k^2\\Delta t^2}{2} - \\dots \\right) = -k\\,q^\\star + \\frac{k^2 q^\\star \\Delta t}{2} + \\mathcal{O}(\\Delta t^2)\n$$\n偏差为 $\\widehat{a}_{\\Delta t}(q^\\star) - a(q^\\star) = \\frac{k^2 q^\\star \\Delta t}{2} + \\mathcal{O}(\\Delta t^2)$。这是一个系统误差，其主导项与 $\\Delta t$ 呈线性关系，这导致估计量高估了负漂移的量值（即，其负值程度小于真实值）。\n\n对于扩散估计量，我们展开其组成部分：\n$$\n1 - e^{-2k\\Delta t} = 1 - \\left(1 - 2k\\Delta t + \\frac{(2k\\Delta t)^2}{2} + \\dots \\right) = 2k\\Delta t - 2k^2\\Delta t^2 + \\mathcal{O}(\\Delta t^3)\n$$\n$$\n(e^{-k\\Delta t} - 1)^2 = (-k\\Delta t + \\frac{k^2\\Delta t^2}{2} + \\dots)^2 = k^2\\Delta t^2 + \\mathcal{O}(\\Delta t^3)\n$$\n将这些代入 $\\widehat{D}_{\\Delta t}(q^\\star)$ 的表达式中：\n$$\n\\widehat{D}_{\\Delta t}(q^\\star) = \\frac{1}{2\\Delta t} \\left[ \\frac{D_0}{k}(2k\\Delta t - 2k^2\\Delta t^2 + \\dots) + (q^\\star)^2(k^2\\Delta t^2 + \\dots) \\right]\n$$\n$$\n\\widehat{D}_{\\Delta t}(q^\\star) = \\frac{1}{2\\Delta t} \\left[ (2D_0\\Delta t - 2D_0k\\Delta t^2) + (q^\\star)^2k^2\\Delta t^2 + \\mathcal{O}(\\Delta t^3) \\right]\n$$\n$$\n\\widehat{D}_{\\Delta t}(q^\\star) = D_0 - D_0k\\Delta t + \\frac{(q^\\star)^2k^2\\Delta t}{2} + \\mathcal{O}(\\Delta t^2) = D_0 + \\left( \\frac{(q^\\star)^2 k^2}{2} - D_0k \\right)\\Delta t + \\mathcal{O}(\\Delta t^2)\n$$\n扩散估计量的偏差 $\\widehat{D}_{\\Delta t}(q^\\star) - D(q^\\star)$ 的主导项也与 $\\Delta t$ 呈线性关系。其符号取决于来自漂移的项 $(q^\\star)^2 k^2/2$ 和来自扩散动力学的项 $-D_0k$ 之间的竞争。\n\n基于此推导，需要计算的量是给定测试用例的相对偏差。\n在 $q^\\star$ 处的真实值为 $a(q^\\star) = -k\\,q^\\star$ 和 $D(q^\\star) = D_0$。\n估计量为：\n$\\widehat{a}_{\\Delta t}(q^\\star) = q^\\star (e^{-k\\Delta t} - 1) / \\Delta t$\n$\\widehat{D}_{\\Delta t}(q^\\star) = \\frac{1}{2\\Delta t} [ \\frac{D_0}{k}(1 - e^{-2k\\Delta t}) + (q^\\star)^2(e^{-k\\Delta t} - 1)^2 ]$\n相对偏差为：\n$$\n\\text{相对漂移偏差} = \\frac{\\widehat{a}_{\\Delta t}(q^\\star) - a(q^\\star)}{\\lvert a(q^\\star) \\rvert}\n$$\n$$\n\\text{相对扩散偏差} = \\frac{\\widehat{D}_{\\Delta t}(q^\\star) - D(q^\\star)}{D(q^\\star)}\n$$\n这些公式是为指定参数实现的，用以量化作为粗粒时间步长 $\\Delta t$ 函数的估计偏差。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the relative biases in drift and diffusion estimators\n    for an Ornstein-Uhlenbeck process at finite time steps.\n    \"\"\"\n    \n    # Define the parameters from the problem statement.\n    k = 1.5\n    D0 = 0.7\n    q_star = 0.8\n    \n    # Define the test cases for the coarse time increment delta_t.\n    test_cases = [1e-4, 1e-2, 1e-1, 1.0]\n\n    # Calculate the true values of the drift and diffusion coefficients.\n    # a(q) = -k*q, D(q) = D0\n    true_a = -k * q_star\n    true_d = D0\n    \n    # Store the final results.\n    results = []\n    \n    # Iterate through each coarse time increment delta_t.\n    for dt in test_cases:\n        # Calculate the finite-delta_t estimators for drift and diffusion.\n        # These are based on the exact conditional moments of the OU process increment.\n\n        # Estimator for drift: a_hat = (1/dt) * E[q(t+dt) - q(t) | q(t)=q_star]\n        exp_k_dt = np.exp(-k * dt)\n        a_hat = q_star * (exp_k_dt - 1.0) / dt\n\n        # Estimator for diffusion: D_hat = (1/(2*dt)) * E[(q(t+dt) - q(t))^2 | q(t)=q_star]\n        # E[(dq)^2] = Var(dq) + (E[dq])^2\n        # Var(dq) = Var(q(t+dt)) = (D0/k) * (1 - exp(-2*k*dt))\n        # E[dq] = q_star * (exp(-k*dt) - 1.0)\n        exp_2k_dt = np.exp(-2.0 * k * dt)\n        var_q_dt = (D0 / k) * (1.0 - exp_2k_dt)\n        mean_dq_sq = (q_star * (exp_k_dt - 1.0))**2\n        \n        d_hat = (var_q_dt + mean_dq_sq) / (2.0 * dt)\n        \n        # Calculate the relative biases as specified in the problem.\n        # Relative bias for drift: (a_hat - a_true) / |a_true|\n        drift_bias = (a_hat - true_a) / abs(true_a)\n        \n        # Relative bias for diffusion: (D_hat - D_true) / D_true\n        diffusion_bias = (d_hat - true_d) / true_d\n        \n        results.append(drift_bias)\n        results.append(diffusion_bias)\n\n    # Format the results into the required single-line string format.\n    # The map(str, ...) converts each float to its string representation.\n    # The ','.join(...) concatenates them with commas.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    \n    # Final print statement in the exact required format.\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "建立了福克-普朗克模型后，我们可以用它来预测系统的长期行为。本练习要求解析求解在球面（一个用于模拟取向自由度的常见场景）上运动的粒子的稳态福克-普朗克方程。通过这个练习，你将加深对平衡态下零通量条件与著名的玻尔兹曼分布之间联系的理解 。",
            "id": "3808963",
            "problem": "考虑一个粗粒化取向自由度，它由一个约束在单位球面 $S^{2}$ 上运动的单位矢量表示，其球坐标为 $(\\theta,\\phi)$，其中 $\\theta \\in [0,\\theta_{0}]$ 且 $\\phi \\in [0,2\\pi)$。该模型用于模拟嵌入在粘弹性材料中的各向异性夹杂物的慢取向动力学。假设为过阻尼动力学，在曲面上存在由粗粒化势 $U(\\theta) = - u_{0} \\cos \\theta$ 产生的切向漂移，因此切向漂移场为 $\\boldsymbol{v}_{t}(\\theta,\\phi) = - \\mu_{R} \\nabla_{S} U(\\theta)$，其中 $\\mu_{R}$ 是转动迁移率，$\\nabla_{S}$ 是 $S^{2}$ 上的曲面梯度。令 $D_{R}$ 为转动扩散系数，并假设爱因斯坦关系 $D_{R} = \\mu_{R} k_{B} T$ 成立，其中 $k_{B}$ 是玻尔兹曼常数，$T$ 是温度。单位表面积的概率密度 $\\rho(\\theta,\\phi,t)$ 的演化遵循球面上的福克-普朗克连续性方程 $\\partial_{t} \\rho = - \\nabla_{S} \\cdot \\boldsymbol{J}$，其概率流为 $\\boldsymbol{J} = \\rho \\boldsymbol{v}_{t} - D_{R} \\nabla_{S} \\rho$。圆形边界 $\\theta=\\theta_{0}$ 是反射边界，这意味着在 $\\theta=\\theta_{0}$ 处，概率流 $\\boldsymbol{J}$ 的法向分量为零。在这些坐标下，$S^{2}$ 上的表面积元为 $\\mathrm{d}A = \\sin \\theta \\,\\mathrm{d}\\theta\\,\\mathrm{d}\\phi$。\n\n假设稳态密度是轴对称的，即与 $\\phi$ 无关，请计算稳态密度 $\\rho_{\\mathrm{ss}}(\\theta)$ 的闭式解析表达式，并充分考虑曲面测度。归一化条件为\n$$\n\\int_{0}^{2\\pi} \\int_{0}^{\\theta_{0}} \\rho_{\\mathrm{ss}}(\\theta) \\,\\sin \\theta \\,\\mathrm{d}\\theta \\,\\mathrm{d}\\phi \\;=\\; 1.\n$$\n将最终答案表示为关于 $\\theta$、$\\theta_{0}$、$u_{0}$、$k_{B}$ 和 $T$ 的单个解析表达式。无需四舍五入。报告 $S^{2}$ 上单位表面积的密度。",
            "solution": "问题陈述已经过验证，并被确定为统计物理学中的一个适定问题。该问题具有科学依据、自洽且客观。因此，我们可以开始求解。\n\n单位表面积的概率密度 $\\rho(\\theta, \\phi, t)$ 的演化由球面上的福克-普朗克方程 $\\partial_{t} \\rho = - \\nabla_{S} \\cdot \\boldsymbol{J}$ 控制，其中 $\\nabla_{S}$ 是曲面梯度算符，$\\boldsymbol{J}$ 是概率流。我们寻求稳态解 $\\rho_{\\mathrm{ss}}$，对于该解有 $\\partial_{t} \\rho_{\\mathrm{ss}} = 0$。这意味着稳态流 $\\boldsymbol{J}_{\\mathrm{ss}}$ 在球冠上必须是一个无散场，即 $\\nabla_{S} \\cdot \\boldsymbol{J}_{\\mathrm{ss}} = 0$。\n\n概率流由 $\\boldsymbol{J} = \\rho \\boldsymbol{v}_{t} - D_{R} \\nabla_{S} \\rho$ 给出。漂移速度为 $\\boldsymbol{v}_{t} = - \\mu_{R} \\nabla_{S} U$，其中 $U(\\theta) = -u_{0} \\cos\\theta$ 是势，$\\mu_{R}$ 是转动迁移率。转动扩散系数 $D_{R}$ 通过爱因斯坦关系 $D_{R} = \\mu_{R} k_{B} T$ 与 $\\mu_{R}$ 相关联。\n\n使用爱因斯坦关系，我们可以将迁移率表示为 $\\mu_{R} = D_{R} / (k_{B} T)$。将其代入流的表达式中得到：\n$$\n\\boldsymbol{J}_{\\mathrm{ss}} = - \\rho_{\\mathrm{ss}} \\frac{D_{R}}{k_{B} T} \\nabla_{S} U - D_{R} \\nabla_{S} \\rho_{\\mathrm{ss}} = -D_{R} \\left( \\frac{\\rho_{\\mathrm{ss}}}{k_{B} T} \\nabla_{S} U + \\nabla_{S} \\rho_{\\mathrm{ss}} \\right)\n$$\n问题陈述指出稳态密度是轴对称的，$\\rho_{\\mathrm{ss}} = \\rho_{\\mathrm{ss}}(\\theta)$，这与势 $U(\\theta)$ 也是轴对称的是一致的。在单位球面的球坐标系中，曲面梯度为 $\\nabla_{S} = \\hat{\\boldsymbol{\\theta}} \\frac{\\partial}{\\partial \\theta} + \\hat{\\boldsymbol{\\phi}} \\frac{1}{\\sin\\theta} \\frac{\\partial}{\\partial \\phi}$。由于 $\\rho_{\\mathrm{ss}}$ 和 $U$ 都与 $\\phi$ 无关，它们的梯度纯粹在 $\\hat{\\boldsymbol{\\theta}}$ 方向上。因此，流矢量 $\\boldsymbol{J}_{\\mathrm{ss}}$ 只有一个 $\\theta$ 分量，即 $\\boldsymbol{J}_{\\mathrm{ss}} = J_{\\theta}(\\theta) \\hat{\\boldsymbol{\\theta}}$。\n\n作用于矢量场 $\\boldsymbol{F} = F_{\\theta} \\hat{\\boldsymbol{\\theta}} + F_{\\phi} \\hat{\\boldsymbol{\\phi}}$ 的曲面散度算符为 $\\nabla_{S} \\cdot \\boldsymbol{F} = \\frac{1}{\\sin\\theta} \\frac{\\partial}{\\partial\\theta}(\\sin\\theta F_{\\theta}) + \\frac{1}{\\sin\\theta} \\frac{\\partial F_{\\phi}}{\\partial\\phi}$。对于我们的轴对称流，这简化为 $\\nabla_{S} \\cdot \\boldsymbol{J}_{\\mathrm{ss}} = \\frac{1}{\\sin\\theta} \\frac{d}{d\\theta}(\\sin\\theta J_{\\theta})$。\n因此，稳态条件 $\\nabla_{S} \\cdot \\boldsymbol{J}_{\\mathrm{ss}} = 0$ 意味着：\n$$\n\\frac{1}{\\sin\\theta} \\frac{d}{d\\theta}(\\sin\\theta J_{\\theta}) = 0 \\quad \\implies \\quad \\sin\\theta J_{\\theta} = C\n$$\n其中 $C$ 是一个积分常数。\n\n边界 $\\theta=\\theta_{0}$ 是反射的。这意味着没有概率流穿过此边界。边界曲线 $\\theta=\\theta_{0}$ 的法线方向是 $\\hat{\\boldsymbol{\\theta}}$。因此，边界上的流的法向分量必须为零：$J_{\\theta}(\\theta_{0}) = 0$。\n将此代入我们的积分方程中，得到 $\\sin(\\theta_{0}) J_{\\theta}(\\theta_{0}) = C$，这给出 $C=0$（因为 $\\theta_{0} \\in (0, \\pi)$，所以 $\\sin(\\theta_0) \\neq 0$）。\n因此，流在定义域内必须处处为零：$\\boldsymbol{J}_{\\mathrm{ss}} = \\boldsymbol{0}$。这个条件对应于热平衡。\n\n将流的表达式设为零，可得：\n$$\n-D_{R} \\left( \\frac{\\rho_{\\mathrm{ss}}}{k_{B} T} \\nabla_{S} U + \\nabla_{S} \\rho_{\\mathrm{ss}} \\right) = \\boldsymbol{0}\n$$\n$$\n\\nabla_{S} \\rho_{\\mathrm{ss}} = - \\frac{\\rho_{\\mathrm{ss}}}{k_{B} T} \\nabla_{S} U\n$$\n由于两个量都只依赖于 $\\theta$，这变成了一个常微分方程：\n$$\n\\frac{d\\rho_{\\mathrm{ss}}}{d\\theta} = - \\frac{\\rho_{\\mathrm{ss}}}{k_{B} T} \\frac{dU}{d\\theta}\n$$\n这是一个可分离方程：$\\frac{1}{\\rho_{\\mathrm{ss}}} d\\rho_{\\mathrm{ss}} = -\\frac{1}{k_{B} T} dU$。积分可得 $\\ln \\rho_{\\mathrm{ss}} = -\\frac{U}{k_{B} T} + \\text{constant}$。\n解是玻尔兹曼分布：\n$$\n\\rho_{\\mathrm{ss}}(\\theta) = A \\exp\\left(-\\frac{U(\\theta)}{k_{B} T}\\right)\n$$\n其中 $A$ 是一个归一化常数。代入势 $U(\\theta) = -u_{0} \\cos\\theta$：\n$$\n\\rho_{\\mathrm{ss}}(\\theta) = A \\exp\\left(-\\frac{-u_{0} \\cos\\theta}{k_{B} T}\\right) = A \\exp\\left(\\frac{u_{0} \\cos\\theta}{k_{B} T}\\right)\n$$\n常数 $A$ 由在球冠上的归一化条件确定：\n$$\n\\int_{0}^{2\\pi} \\int_{0}^{\\theta_{0}} \\rho_{\\mathrm{ss}}(\\theta) \\sin\\theta \\,d\\theta \\,d\\phi = 1\n$$\n代入 $\\rho_{\\mathrm{ss}}(\\theta)$ 的表达式：\n$$\nA \\int_{0}^{2\\pi} d\\phi \\int_{0}^{\\theta_{0}} \\exp\\left(\\frac{u_{0} \\cos\\theta}{k_{B} T}\\right) \\sin\\theta \\,d\\theta = 1\n$$\n对 $\\phi$ 的积分得出 $2\\pi$。对于对 $\\theta$ 的积分，我们使用换元法 $x = \\cos\\theta$，因此 $dx = -\\sin\\theta d\\theta$。积分限从 $\\theta=0$到 $\\theta=\\theta_{0}$ 变为 $x=\\cos(0)=1$ 到 $x=\\cos(\\theta_{0})$。令 $\\beta = \\frac{u_{0}}{k_{B} T}$。该积分变为：\n$$\n\\int_{0}^{\\theta_{0}} \\exp(\\beta \\cos\\theta) \\sin\\theta \\,d\\theta = \\int_{1}^{\\cos\\theta_{0}} \\exp(\\beta x) (-dx) = \\int_{\\cos\\theta_{0}}^{1} \\exp(\\beta x) \\,dx\n$$\n$$\n= \\left[ \\frac{1}{\\beta} \\exp(\\beta x) \\right]_{\\cos\\theta_{0}}^{1} = \\frac{1}{\\beta} \\left( \\exp(\\beta) - \\exp(\\beta \\cos\\theta_{0}) \\right)\n$$\n将 $\\beta = \\frac{u_{0}}{k_{B} T}$ 代回：\n$$\n\\int_{0}^{\\theta_{0}} \\exp\\left(\\frac{u_{0} \\cos\\theta}{k_{B} T}\\right) \\sin\\theta \\,d\\theta = \\frac{k_{B} T}{u_{0}} \\left( \\exp\\left(\\frac{u_{0}}{k_{B} T}\\right) - \\exp\\left(\\frac{u_{0} \\cos\\theta_{0}}{k_{B} T}\\right) \\right)\n$$\n现在的归一化条件是：\n$$\n2\\pi A \\left[ \\frac{k_{B} T}{u_{0}} \\left( \\exp\\left(\\frac{u_{0}}{k_{B} T}\\right) - \\exp\\left(\\frac{u_{0} \\cos\\theta_{0}}{k_{B} T}\\right) \\right) \\right] = 1\n$$\n解出 $A$：\n$$\nA = \\frac{u_{0}}{2\\pi k_{B} T \\left( \\exp\\left(\\frac{u_{0}}{k_{B} T}\\right) - \\exp\\left(\\frac{u_{0} \\cos\\theta_{0}}{k_{B} T}\\right) \\right)}\n$$\n最后，将常数 $A$ 代回 $\\rho_{\\mathrm{ss}}(\\theta)$ 的表达式中，我们得到最终答案：\n$$\n\\rho_{\\mathrm{ss}}(\\theta) = \\frac{u_{0} \\exp\\left(\\frac{u_{0} \\cos\\theta}{k_{B} T}\\right)}{2\\pi k_{B} T \\left( \\exp\\left(\\frac{u_{0}}{k_{B} T}\\right) - \\exp\\left(\\frac{u_{0} \\cos\\theta_{0}}{k_{B} T}\\right) \\right)}\n$$\n这就是球冠上单位表面积的稳态概率密度。",
            "answer": "$$\n\\boxed{\\frac{u_{0} \\exp\\left(\\frac{u_{0} \\cos\\theta}{k_{B} T}\\right)}{2\\pi k_{B} T \\left( \\exp\\left(\\frac{u_{0}}{k_{B} T}\\right) - \\exp\\left(\\frac{u_{0} \\cos\\theta_{0}}{k_{B} T}\\right) \\right)}}\n$$"
        },
        {
            "introduction": "除了平衡态性质，福克-普朗克算子本身还掌握着理解系统动力学的钥匙，特别是介于亚稳态之间的缓慢转变过程。本数值练习将通过分析一个双势阱系统中的福克-普朗克算子的本征值和本征函数来探索这一概念。你将发现，该算子的第一个非平庸本征函数如何成为反应坐标的绝佳近似，而反应坐标是描述转变路径的理想变量 。",
            "id": "3808979",
            "problem": "考虑一个用于多尺度材料模拟中的一维过阻尼扩散过程，该过程用于模拟对称双阱势中的粗粒化动力学。一个构型坐标 $x$ 的动力学由 Itô 随机微分方程 (SDE) 给出\n$$\n\\mathrm{d}x_t = -U'(x_t)\\,\\mathrm{d}t + \\sqrt{2}\\,\\mathrm{d}W_t,\n$$\n其中 $U(x)$ 是能量景观，$U'(x)$ 是其关于 $x$ 的导数，$W_t$ 是一个标准维纳过程。假设单位迁移率和单位热能，因此扩散系数等于 $1$。作用于足够光滑的测试函数 $f$ 的相应向后 Kolmogorov 生成元（也称为 Fokker–Planck 描述的向后算子）为\n$$\n\\mathcal{L} f(x) = -U'(x)\\,f'(x) + f''(x).\n$$\n设双阱势为 $U(x) = a\\,(x^2 - 1)^2$，其中 $a>0$，在 $x=\\pm 1$ 处产生势阱，在 $x=0$ 处产生势垒。\n\n您的任务是数值计算有限区间上离散化的向后生成元 $\\mathcal{L}$ 的主导特征函数，并将第一个非平凡特征函数解释为类 committor 慢坐标。具体来说，执行以下操作：\n\n1. 使用包含 $N$ 个点且间距为 $h$ 的均匀网格 $x_i$ 对区间 $[-L,L]$ 进行离散化。对于内部点，使用二阶中心有限差分来近似 $\\mathcal{L}$ 在网格函数上的作用：\n$$\nf'(x_i) \\approx \\frac{f_{i+1} - f_{i-1}}{2h}, \\quad\nf''(x_i) \\approx \\frac{f_{i+1} - 2f_i + f_{i-1}}{h^2}.\n$$\n通过使用鬼点消除法，对特征问题施加反射边界条件（Neumann），即在 $x=\\pm L$ 处 $f'(x) = 0$。该方法强制 $f_{-1} = f_{1}$ 和 $f_{N} = f_{N-2}$，从而得到离散边界行\n$$\n(\\mathcal{L}f)_0 \\approx \\frac{2}{h^2}\\,(f_1 - f_0), \\quad\n(\\mathcal{L}f)_{N-1} \\approx \\frac{2}{h^2}\\,(f_{N-2} - f_{N-1}),\n$$\n对于内部索引 $i=1,\\dots,N-2$：\n$$\n(\\mathcal{L}f)_i \\approx \\left(\\frac{U'(x_i)}{2h} + \\frac{1}{h^2}\\right) f_{i-1} - \\frac{2}{h^2} f_i + \\left(-\\frac{U'(x_i)}{2h} + \\frac{1}{h^2}\\right) f_{i+1}.\n$$\n\n2. 在网格上组装得到的 $\\mathcal{L}$ 的 $N\\times N$ 矩阵表示，并计算其特征值和特征向量。识别出绝对值最小的特征值 $\\lambda_0$ 及其特征函数 $\\phi_0$（由于反射边界条件，该函数应接近一个常数），以及绝对值次小的特征值 $\\lambda_1$ 及其特征函数 $\\phi_1$。将 $\\phi_1$ 归一化为一个值域在 $[-1,1]$ 之间的仿射缩放版本 $g$：\n$$\ng = 2\\,\\frac{\\phi_1 - \\min(\\phi_1)}{\\max(\\phi_1)-\\min(\\phi_1)} - 1.\n$$\n\n3. 计算 committor 函数 $q$，它是以下边值问题的解\n$$\n\\mathcal{L} q(x) = 0 \\quad \\text{on} \\quad (-L,L), \\quad q(-L) = 0, \\quad q(L) = 1,\n$$\n该问题在相同的网格上使用相同的内部二阶有限差分进行离散化，但现在在 $x=\\pm L$ 处应用 Dirichlet 边界条件。求解得到的关于内部未知数的线性系统，并将边界处的 $q$ 设置为指定值。定义中心化 committor\n$$\nc = 2q - 1.\n$$\n\n4. 通过量化第一个非平凡特征函数 $\\phi_1$ 与 $c$ 的关系，将其解释为类 committor 慢坐标。计算：\n   - $g$ 和 $c$ 之间的皮尔逊相关系数。\n   - 奇偶性误差\n$$\n\\varepsilon = \\frac{\\max_i \\left| \\phi_{1,i} + \\phi_{1,(N-1-i)} \\right|}{\\max_i \\left| \\phi_{1,i} \\right| + 10^{-12}},\n$$\n该误差衡量了关于 $x=0$ 的奇对称性的偏差，这是对称双阱中慢模态的预期属性。\n\n构建一个程序，对以下测试套件执行上述操作。每个测试用例是一个三元组 $(a,L,N)$：\n\n- 案例 1（正常路径，高势垒）：$(10.0,\\,1.5,\\,201)$。\n- 案例 2（中等势垒）：$(4.0,\\,1.5,\\,201)$。\n- 案例 3（低势垒）：$(1.0,\\,1.5,\\,201)$。\n- 案例 4（边缘情况，粗网格）：$(4.0,\\,1.5,\\,51)$。\n\n对于每个案例，计算并返回一个包含四个浮点数的列表 $[\\lambda_0,\\,\\lambda_1,\\,\\mathrm{corr},\\,\\varepsilon]$，其中 $\\lambda_0$ 和 $\\lambda_1$ 是 Neumann 特征问题中两个绝对值最小的特征值的实部，$\\mathrm{corr}$ 是 $g$ 和 $c$ 之间的皮尔逊相关系数，$\\varepsilon$ 是奇偶性误差。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个元素对应一个测试用例，并且本身是一个包含四个浮点数的列表，例如：\n$$\n\\text{[}[r_{1,1},r_{1,2},r_{1,3},r_{1,4}],[r_{2,1},r_{2,2},r_{2,3},r_{2,4}],\\dots\\text{]}.\n$$\n此问题不要求物理单位，也未出现角度。所有数值答案必须是浮点数或浮点数列表，如上所述。",
            "solution": "用户提供了一个有效、适定且具有科学依据的问题。任务是通过研究其向后 Kolmogorov 生成元的光谱性质及其与 committor 函数的关系，来分析对称双阱势中过阻尼扩散过程的慢动力学。利用所提供的信息，该问题是可以用数值方法求解的。\n\n问题的核心在于坐标 $x_t$ 的 Itô 随机微分方程 (SDE)：\n$$\n\\mathrm{d}x_t = -U'(x_t)\\,\\mathrm{d}t + \\sqrt{2}\\,\\mathrm{d}W_t\n$$\n该方程描述了一个粒子在势能景观 $U(x) = a(x^2 - 1)^2$ 中，受随机热涨落（由维纳过程 $W_t$ 表示）影响下的运动。该动力学由向后 Kolmogorov 生成元 $\\mathcal{L}$ 控制，它作用于测试函数 $f(x)$ 的方式如下：\n$$\n\\mathcal{L} f(x) = -U'(x)\\,f'(x) + f''(x)\n$$\n该算子的特征函数揭示了系统的特征模态和时间尺度。对应于第二慢时间尺度（即第一个非平凡时间尺度）的特征函数可作为反应坐标的一个极好近似，该坐标能最佳地描述两个势阱之间的跃迁。问题要求将此特征函数与 committor 函数（即精确的反应坐标）进行比较。\n\n我们的解决方案遵循问题描述，分为四个主要阶段：\n1.  在空间网格上对算子 $\\mathcal{L}$ 进行离散化，并在反射边界条件下组装其矩阵表示。\n2.  数值求解得到的矩阵特征问题，以找到关键特征值（$\\lambda_0, \\lambda_1$）和第一个非平凡特征函数（$\\phi_1$）。\n3.  通过求解一个边值问题来计算 committor 函数 $q(x)$。\n4.  使用相关系数和奇偶性误差度量，对归一化的特征函数 $\\phi_1$ 与 committor 函数 $q(x)$ 进行定量比较。\n\n**1. 生成元 $\\mathcal{L}$ 的离散化**\n\n我们将空间域 $[-L, L]$ 离散化为 $N$ 个均匀间隔的点 $x_i = -L + i \\cdot h$，其中 $i=0, 1, \\dots, N-1$，网格间距为 $h = 2L/(N-1)$。函数 $f(x)$ 在此网格上的值由向量 $\\mathbf{f}$ 表示，其分量为 $f_i = f(x_i)$。\n\n在内部网格点 $x_i$（$i=1, \\dots, N-2$）处的一阶和二阶导数使用二阶中心有限差分进行近似：\n$$\nf'(x_i) \\approx \\frac{f_{i+1} - f_{i-1}}{2h}, \\quad f''(x_i) \\approx \\frac{f_{i+1} - 2f_i + f_{i-1}}{h^2}\n$$\n将这些近似代入 $\\mathcal{L}f(x_i)$ 的表达式，得到离散算子在内部点的作用：\n$$\n(\\mathcal{L}f)_i \\approx -U'(x_i) \\left( \\frac{f_{i+1} - f_{i-1}}{2h} \\right) + \\left( \\frac{f_{i+1} - 2f_i + f_{i-1}}{h^2} \\right)\n$$\n$$\n(\\mathcal{L}f)_i \\approx \\left(\\frac{1}{h^2} + \\frac{U'(x_i)}{2h}\\right) f_{i-1} - \\frac{2}{h^2} f_i + \\left(\\frac{1}{h^2} - \\frac{U'(x_i)}{2h}\\right) f_{i+1}\n$$\n这给出了 $\\mathcal{L}$ 矩阵表示的三对角结构系数。\n\n对于特征问题，我们施加反射（Neumann）边界条件 $f'(\\pm L) = 0$。这是通过使用鬼点来实现的：在左边界（$i=0$）处 $f_{-1} = f_1$，在右边界（$i=N-1$）处 $f_N = f_{N-2}$。Neumann 条件在物理上意味着没有概率通量离开该区域。在边界 $x_0 = -L$ 处，条件 $f'(x_0)=0$ 将 $\\mathcal{L}f(x_0)$ 简化为 $f''(x_0)$。使用中心差分来表示 $f''(x_0)$ 并应用鬼点条件：\n$$\n(\\mathcal{L}f)_0 \\approx f''(x_0) \\approx \\frac{f_1 - 2f_0 + f_{-1}}{h^2} = \\frac{f_1 - 2f_0 + f_1}{h^2} = \\frac{2}{h^2}(f_1 - f_0)\n$$\n在 $x_{N-1} = L$ 处进行对称论证可得：\n$$\n(\\mathcal{L}f)_{N-1} \\approx f''(x_{N-1}) \\approx \\frac{f_N - 2f_{N-1} + f_{N-2}}{h^2} = \\frac{f_{N-2} - 2f_{N-1} + f_{N-2}}{h^2} = \\frac{2}{h^2}(f_{N-2} - f_{N-1})\n$$\n这些公式完全定义了 $N \\times N$ 的矩阵表示，我们称之为 $L_{\\text{mat}}$。\n\n**2. 特征问题：$\\mathcal{L}\\phi = \\lambda\\phi$**\n\n我们求解矩阵特征问题 $L_{\\text{mat}}\\mathbf{\\phi} = \\lambda\\mathbf{\\phi}$ 以找到特征值 $\\lambda$ 和特征向量 $\\mathbf{\\phi}$。$\\mathcal{L}$ 的特征值是实数且非正，代表系统模态的负衰减率。\n- 绝对值最小的特征值 $\\lambda_0$ 理论上为 $0$。它对应于系统的稳态。对于反射边界，相关的特征函数 $\\phi_0$ 是一个常数向量，因为对于任何常数 $C$，都有 $\\mathcal{L}C = 0$。\n- 绝对值第二小的特征值 $\\lambda_1$ 是第一个非零特征值。量 $-\\lambda_1$ 代表了系统中最慢动力学过程的速率，即势阱之间跃迁的 Arrhenius 速率。相应的特征函数 $\\phi_1$ 描述了此慢过程的空间形式，并可作为反应坐标的近似。\n\n在计算特征值和特征向量后，我们按其绝对值大小对特征值进行排序，以识别 $\\lambda_0$ 和 $\\lambda_1$。然后我们提取特征向量 $\\phi_1$ 对应的实部。为保持一致性，我们通过确保 $\\phi_1(-L)  \\phi_1(L)$ 来定向 $\\phi_1$，使其随 $x$ 单调递增。最后，我们将其归一化为一个值域在 $[-1, 1]$ 的仿射缩放版本 $g$：\n$$\ng = 2\\,\\frac{\\phi_1 - \\min(\\phi_1)}{\\max(\\phi_1)-\\min(\\phi_1)} - 1\n$$\n\n**3. Committor 函数**\n\nCommittor 函数 $q(x)$ 是正则反应坐标。它被定义为从 $x$ 出发的轨迹在到达反应物态（由 $x=-L$ 近似）之前首先到达产物态（由 $x=L$ 近似）的概率。它是稳态过程的向后 Kolmogorov 方程在吸收边界条件下的解：\n$$\n\\mathcal{L} q(x) = 0 \\quad \\text{on} \\quad (-L,L), \\quad \\text{with} \\quad q(-L) = 0, \\quad q(L) = 1.\n$$\n为了进行数值求解，我们使用与之前相同的内部有限差分格式。这将产生一个包含 $N-2$ 个线性方程的方程组，用于求解 $N-2$ 个未知的内部网格值 $q_1, \\dots, q_{N-2}$。对于一个通用的内部点 $x_i$，方程为：\n$$\n\\left(\\frac{1}{h^2} + \\frac{U'(x_i)}{2h}\\right) q_{i-1} - \\frac{2}{h^2} q_i + \\left(\\frac{1}{h^2} - \\frac{U'(x_i)}{2h}\\right) q_{i+1} = 0\n$$\n将边界条件 $q_0=0$ 和 $q_{N-1}=1$ 纳入系统中的第一个和最后一个方程，将其修改为 $A\\mathbf{q}_{\\text{int}} = \\mathbf{b}$ 形式的非齐次系统，该系统可以很容易地求解。然后定义中心化 committor 为 $c = 2q - 1$，它将 committor 映射到区间 $[-1, 1]$。\n\n**4. 分析与比较**\n\n最后一步是量化近似反应坐标 $g$（来自特征函数）与精确反应坐标 $c$（来自 committor）之间的关系。\n- **皮尔逊相关系数**：我们计算 $\\mathrm{corr}(g, c)$。一个接近 $+1$ 的值表明 $\\phi_1$ 是 committor 的一个极好代理，这对于由高能垒分隔的亚稳态系统是符合预期的。\n- **奇偶性误差**：对于对称势 $U(x)$，第一个非平凡特征函数 $\\phi_1$ 预期具有奇对称性，即 $\\phi_1(x) = -\\phi_1(-x)$。奇偶性误差 $\\varepsilon$ 衡量了与这种理想对称性的偏差：\n$$\n\\varepsilon = \\frac{\\max_i \\left| \\phi_{1,i} + \\phi_{1,(N-1-i)} \\right|}{\\max_i \\left| \\phi_{1,i} \\right| + 10^{-12}}\n$$\n一个接近 $0$ 的 $\\varepsilon$ 值证实了预期的奇对称性。\n\n该算法在一个 Python 程序中实现，该程序遍历给定的测试用例，执行这些计算，并报告所要求的四个度量指标：$\\lambda_0$, $\\lambda_1$, $\\mathrm{corr}$ 和 $\\varepsilon$。",
            "answer": "```python\nimport numpy as np\nfrom scipy import linalg\n\ndef process_case(a, L, N):\n    \"\"\"\n    Computes the specified metrics for a single test case (a, L, N).\n\n    Args:\n        a (float): Parameter for the potential U(x) = a*(x**2 - 1)**2.\n        L (float): The half-width of the symmetric interval [-L, L].\n        N (int): The number of grid points.\n\n    Returns:\n        list: A list of four floats [lambda_0, lambda_1, corr, epsilon].\n    \"\"\"\n    # 1. Grid and Potential Setup\n    x = np.linspace(-L, L, N)\n    h = 2 * L / (N - 1)\n    U_prime = 4 * a * (x**3 - x)\n\n    # 2. Assemble and solve the Neumann Eigenproblem\n    L_mat = np.zeros((N, N))\n\n    # Boundary rows for reflecting BCs\n    L_mat[0, 0] = -2 / h**2\n    L_mat[0, 1] = 2 / h**2\n    L_mat[N - 1, N - 2] = 2 / h**2\n    L_mat[N - 1, N - 1] = -2 / h**2\n\n    # Interior rows\n    for i in range(1, N - 1):\n        c_minus = 1/h**2 + U_prime[i] / (2*h)\n        c_zero = -2/h**2\n        c_plus = 1/h**2 - U_prime[i] / (2*h)\n        L_mat[i, i - 1] = c_minus\n        L_mat[i, i] = c_zero\n        L_mat[i, i + 1] = c_plus\n\n    eigvals, eigvecs = linalg.eig(L_mat)\n\n    # Identify eigenvalues and the first non-trivial eigenfunction\n    sorted_indices = np.argsort(np.abs(eigvals))\n    idx0, idx1 = sorted_indices[0], sorted_indices[1]\n\n    lambda_0 = np.real(eigvals[idx0])\n    lambda_1 = np.real(eigvals[idx1])\n    \n    phi_1 = np.real(eigvecs[:, idx1])\n    \n    # Enforce consistent orientation for phi_1 (monotonically increasing)\n    if phi_1[-1]  phi_1[0]:\n        phi_1 = -phi_1\n\n    # Normalize phi_1 to g, ranging from -1 to 1\n    min_phi1, max_phi1 = np.min(phi_1), np.max(phi_1)\n    if (max_phi1 - min_phi1)  1e-12: # Avoid division by zero\n        g = np.zeros_like(phi_1)\n    else:\n        g = 2 * (phi_1 - min_phi1) / (max_phi1 - min_phi1) - 1\n\n    # 3. Solve the Committor Boundary Value Problem\n    # System A*q_int = b for interior points q_1, ..., q_{N-2}\n    A_committor = np.zeros((N - 2, N - 2))\n    b_committor = np.zeros(N - 2)\n\n    for i in range(1, N - 1):\n        row_idx = i - 1\n        \n        c_minus = 1/h**2 + U_prime[i] / (2*h)\n        c_zero = -2/h**2\n        c_plus = 1/h**2 - U_prime[i] / (2*h)\n        \n        if i > 1:\n            A_committor[row_idx, row_idx - 1] = c_minus\n        \n        A_committor[row_idx, row_idx] = c_zero\n        \n        if i  N - 2:\n            A_committor[row_idx, row_idx + 1] = c_plus\n        else: # i=N-2, use q(L)=1 BC\n            b_committor[row_idx] = -c_plus * 1.0\n            \n    q_interior = linalg.solve(A_committor, b_committor)\n\n    # Construct full committor q and centered committor c\n    q = np.zeros(N)\n    q[0], q[N-1] = 0.0, 1.0\n    q[1:N-1] = q_interior\n    c = 2 * q - 1\n\n    # 4. Compute Metrics\n    # Pearson correlation coefficient between g and c\n    corr = np.corrcoef(g, c)[0, 1]\n\n    # Parity error for phi_1\n    phi1_flipped = phi_1[::-1]\n    numerator = np.max(np.abs(phi_1 + phi1_flipped))\n    denominator = np.max(np.abs(phi_1)) + 1e-12\n    epsilon = numerator / denominator\n\n    return [lambda_0, lambda_1, corr, epsilon]\n\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        (10.0, 1.5, 201),  # Case 1 (happy path, high barrier)\n        (4.0, 1.5, 201),   # Case 2 (moderate barrier)\n        (1.0, 1.5, 201),   # Case 3 (low barrier)\n        (4.0, 1.5, 51),    # Case 4 (edge case, coarse grid)\n    ]\n\n    results = []\n    for case in test_cases:\n        a, L, N = case\n        result = process_case(a, L, N)\n        results.append(result)\n\n    # Format the output as specified\n    formatted_results = [f\"[{','.join(map(str, res))}]\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n# Execute the solution\nsolve()\n```"
        }
    ]
}