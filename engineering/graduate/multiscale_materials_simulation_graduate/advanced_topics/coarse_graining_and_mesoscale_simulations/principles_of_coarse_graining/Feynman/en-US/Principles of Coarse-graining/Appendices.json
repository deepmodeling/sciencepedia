{
    "hands_on_practices": [
        {
            "introduction": "The first step in many coarse-graining schemes is to define the mapping from a high-resolution atomistic representation to a simplified one. For rigid molecules, this typically involves defining a center-of-mass for translation and an orientation coordinate, such as a quaternion, for rotation. This practice provides a concrete exercise in implementing this fundamental mapping, connecting abstract geometric concepts like least-squares alignment to a tangible molecular configuration .",
            "id": "3835541",
            "problem": "Consider a rigid coarse-grained mapping for a trimer molecule in three dimensions that reduces the all-atom coordinates to a center-of-mass and a unit orientation quaternion. Let the molecule consist of three atoms with equal masses $m_{1} = m_{2} = m_{3}$ and a fixed reference geometry in a body-fixed frame given by the positions\n$$\n\\mathbf{s}_{1} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\quad\n\\mathbf{s}_{2} = \\begin{pmatrix} -\\tfrac{1}{2} \\\\ \\tfrac{\\sqrt{3}}{2} \\\\ 0 \\end{pmatrix}, \\quad\n\\mathbf{s}_{3} = \\begin{pmatrix} -\\tfrac{1}{2} \\\\ -\\tfrac{\\sqrt{3}}{2} \\\\ 0 \\end{pmatrix},\n$$\nwhich satisfy $\\sum_{i=1}^{3} m_{i} \\mathbf{s}_{i} = \\mathbf{0}$. In the laboratory frame, an observed configuration is provided by atomic coordinates\n$$\n\\mathbf{r}_{1} = \\begin{pmatrix} 1 \\\\ 3 \\\\ 3 \\end{pmatrix}, \\quad\n\\mathbf{r}_{2} = \\begin{pmatrix} 1 - \\tfrac{\\sqrt{3}}{2} \\\\ \\tfrac{3}{2} \\\\ 3 \\end{pmatrix}, \\quad\n\\mathbf{r}_{3} = \\begin{pmatrix} 1 + \\tfrac{\\sqrt{3}}{2} \\\\ \\tfrac{3}{2} \\\\ 3 \\end{pmatrix}.\n$$\nAll coordinates are in nanometers, and masses are equal and finite.\n\nTask:\n1. Starting from first principles (rigid-body kinematics, mass-weighted definitions, and the orthogonal Procrustes alignment in three dimensions), formulate explicitly the nonlinear coarse-graining map that sends $\\{\\mathbf{r}_{i}\\}_{i=1}^{3}$ to the center-of-mass $\\mathbf{R}$ and the orientation unit quaternion $\\mathbf{q} = (q_{0}, q_{1}, q_{2}, q_{3})$ (scalar-first convention), defined as the unique maximizer (up to the known double cover $\\mathbf{q} \\sim -\\mathbf{q}$) of a mass-weighted least-squares alignment of $\\{\\mathbf{s}_{i}\\}_{i=1}^{3}$ to the centered laboratory coordinates $\\{\\mathbf{r}_{i} - \\mathbf{R}\\}_{i=1}^{3}$. Your formulation must include the normalization constraint on $\\mathbf{q}$ and a clear sign convention to fix the representative of the quaternion equivalence class.\n2. Using your explicit mapping, compute the coarse variables for the provided data. Adopt the convention that $q_{0} > 0$. Express the center-of-mass in nanometers and the quaternion components as dimensionless numbers. If you introduce any approximations to radicals, round your final numerical values to four significant figures; otherwise, present exact values.\n\nReport your final answer as a single row matrix containing the seven coarse variables in the order $(R_{x}, R_{y}, R_{z}, q_{0}, q_{1}, q_{2}, q_{3})$.",
            "solution": "The problem is evaluated as scientifically grounded, well-posed, and objective. It represents a standard procedure in multiscale materials simulation for determining the coarse-grained coordinates (center-of-mass and orientation) of a rigid molecule from its atomic coordinates. The problem provides all necessary data and definitions for a unique solution. Therefore, I will proceed with a full derivation.\n\nThe coarse-graining map transforms the set of all-atom coordinates $\\{\\mathbf{r}_{i}\\}_{i=1}^{3}$ into a center-of-mass vector $\\mathbf{R}$ and an orientation unit quaternion $\\mathbf{q}$.\n\n**1. Formulation of the Coarse-Graining Map**\n\n**Center of Mass ($\\mathbf{R}$):**\nThe center of mass $\\mathbf{R}$ is the mass-weighted average of the atomic positions $\\mathbf{r}_{i}$:\n$$\n\\mathbf{R} = \\frac{\\sum_{i=1}^{3} m_{i} \\mathbf{r}_{i}}{\\sum_{i=1}^{3} m_{i}}\n$$\nGiven that the masses are equal, $m_{1} = m_{2} = m_{3} = m$, the expression simplifies to the arithmetic mean of the position vectors:\n$$\n\\mathbf{R} = \\frac{m(\\mathbf{r}_{1} + \\mathbf{r}_{2} + \\mathbf{r}_{3})}{3m} = \\frac{1}{3} (\\mathbf{r}_{1} + \\mathbf{r}_{2} + \\mathbf{r}_{3})\n$$\n\n**Orientation Quaternion ($\\mathbf{q}$):**\nThe orientation is determined by finding the rotation that best aligns the centered laboratory coordinates, $\\mathbf{r}'_{i} = \\mathbf{r}_{i} - \\mathbf{R}$, with the reference body-fixed coordinates, $\\mathbf{s}_{i}$. This is achieved by solving the orthogonal Procrustes problem, which involves minimizing the mass-weighted sum of squared deviations:\n$$\nL(\\mathbf{Q}) = \\sum_{i=1}^{3} m_{i} \\|\\mathbf{r}'_{i} - \\mathbf{Q} \\mathbf{s}_{i}\\|^{2}\n$$\nwhere $\\mathbf{Q}$ is a $3 \\times 3$ proper rotation matrix ($\\mathbf{Q}^{T}\\mathbf{Q} = \\mathbf{I}$, $\\det(\\mathbf{Q})=1$). Since all masses $m_i$ are equal and positive, minimizing $L(\\mathbf{Q})$ is equivalent to minimizing $\\frac{L(\\mathbf{Q})}{m} = \\sum_{i=1}^{3} \\|\\mathbf{r}'_{i} - \\mathbf{Q} \\mathbf{s}_{i}\\|^{2}$.\n\nExpanding the squared norm, we find that minimizing this sum is equivalent to maximizing the term $\\text{Tr}(\\mathbf{Q} \\mathbf{C})$, where $\\mathbf{C}$ is the correlation matrix given by:\n$$\n\\mathbf{C} = \\sum_{i=1}^{3} \\mathbf{s}_{i} (\\mathbf{r}'_{i})^{T}\n$$\nThe solution to this maximization problem is found via the Singular Value Decomposition (SVD) of $\\mathbf{C}$. Let the SVD of $\\mathbf{C}$ be $\\mathbf{C} = \\mathbf{U} \\mathbf{\\Sigma} \\mathbf{V}^{T}$, where $\\mathbf{U}$ and $\\mathbf{V}$ are orthogonal matrices and $\\mathbf{\\Sigma}$ is a diagonal matrix of singular values. The optimal rotation matrix $\\mathbf{Q}$ is given by:\n$$\n\\mathbf{Q} = \\mathbf{V} \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & \\det(\\mathbf{V}\\mathbf{U}^{T}) \\end{pmatrix} \\mathbf{U}^{T}\n$$\nThis formulation ensures that $\\mathbf{Q}$ is a proper rotation, correcting for any potential reflection.\n\nOnce the optimal rotation matrix $\\mathbf{Q}$ is found, it is converted to a unit quaternion $\\mathbf{q} = (q_{0}, q_{1}, q_{2}, q_{3})$ using the scalar-first convention. The components are given by:\n$$\n\\begin{aligned}\nq_{0} &= \\frac{1}{2} \\sqrt{1 + \\text{Tr}(\\mathbf{Q})} \\\\\nq_{1} &= \\frac{Q_{32} - Q_{23}}{4q_{0}} \\\\\nq_{2} &= \\frac{Q_{13} - Q_{31}}{4q_{0}} \\\\\nq_{3} &= \\frac{Q_{21} - Q_{12}}{4q_{0}}\n\\end{aligned}\n$$\nwhere $Q_{ij}$ are the elements of $\\mathbf{Q}$. The problem specifies the convention $q_{0} > 0$, which is satisfied by taking the positive root for $q_0$. This choice fixes the quaternion representative from the equivalence class $(\\mathbf{q} \\sim -\\mathbf{q})$.\n\n**2. Application to the Provided Data**\n\n**Calculate Center of Mass $\\mathbf{R}$:**\nUsing the given laboratory coordinates:\n$$\n\\mathbf{r}_{1} = \\begin{pmatrix} 1 \\\\ 3 \\\\ 3 \\end{pmatrix}, \\quad\n\\mathbf{r}_{2} = \\begin{pmatrix} 1 - \\frac{\\sqrt{3}}{2} \\\\ \\frac{3}{2} \\\\ 3 \\end{pmatrix}, \\quad\n\\mathbf{r}_{3} = \\begin{pmatrix} 1 + \\frac{\\sqrt{3}}{2} \\\\ \\frac{3}{2} \\\\ 3 \\end{pmatrix}\n$$\n$$\n\\mathbf{R} = \\frac{1}{3} \\left( \\begin{pmatrix} 1 \\\\ 3 \\\\ 3 \\end{pmatrix} + \\begin{pmatrix} 1 - \\frac{\\sqrt{3}}{2} \\\\ \\frac{3}{2} \\\\ 3 \\end{pmatrix} + \\begin{pmatrix} 1 + \\frac{\\sqrt{3}}{2} \\\\ \\frac{3}{2} \\\\ 3 \\end{pmatrix} \\right) = \\frac{1}{3} \\begin{pmatrix} 3 \\\\ 6 \\\\ 9 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix}\n$$\nThe center of mass is $\\mathbf{R} = (1, 2, 3)$.\n\n**Calculate Centered Coordinates $\\mathbf{r}'_i = \\mathbf{r}_i - \\mathbf{R}$:**\n$$\n\\mathbf{r}'_{1} = \\begin{pmatrix} 1 \\\\ 3 \\\\ 3 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\n$$\n\\mathbf{r}'_{2} = \\begin{pmatrix} 1 - \\frac{\\sqrt{3}}{2} \\\\ \\frac{3}{2} \\\\ 3 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} -\\frac{\\sqrt{3}}{2} \\\\ -\\frac{1}{2} \\\\ 0 \\end{pmatrix}\n$$\n$$\n\\mathbf{r}'_{3} = \\begin{pmatrix} 1 + \\frac{\\sqrt{3}}{2} \\\\ \\frac{3}{2} \\\\ 3 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} \\frac{\\sqrt{3}}{2} \\\\ -\\frac{1}{2} \\\\ 0 \\end{pmatrix}\n$$\n\n**Calculate the Correlation Matrix $\\mathbf{C}$:**\nThe reference coordinates are:\n$$\n\\mathbf{s}_{1} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\quad\n\\mathbf{s}_{2} = \\begin{pmatrix} -\\frac{1}{2} \\\\ \\frac{\\sqrt{3}}{2} \\\\ 0 \\end{pmatrix}, \\quad\n\\mathbf{s}_{3} = \\begin{pmatrix} -\\frac{1}{2} \\\\ -\\frac{\\sqrt{3}}{2} \\\\ 0 \\end{pmatrix}\n$$\nThe correlation matrix $\\mathbf{C} = \\sum_{i=1}^{3} \\mathbf{s}_{i} (\\mathbf{r}'_{i})^{T}$ is calculated as:\n$$\n\\mathbf{C} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} \\begin{pmatrix} 0 & 1 & 0 \\end{pmatrix} + \\begin{pmatrix} -\\frac{1}{2} \\\\ \\frac{\\sqrt{3}}{2} \\\\ 0 \\end{pmatrix} \\begin{pmatrix} -\\frac{\\sqrt{3}}{2} & -\\frac{1}{2} & 0 \\end{pmatrix} + \\begin{pmatrix} -\\frac{1}{2} \\\\ -\\frac{\\sqrt{3}}{2} \\\\ 0 \\end{pmatrix} \\begin{pmatrix} \\frac{\\sqrt{3}}{2} & -\\frac{1}{2} & 0 \\end{pmatrix}\n$$\n$$\n\\mathbf{C} = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} + \\begin{pmatrix} \\frac{\\sqrt{3}}{4} & \\frac{1}{4} & 0 \\\\ -\\frac{3}{4} & -\\frac{\\sqrt{3}}{4} & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} + \\begin{pmatrix} -\\frac{\\sqrt{3}}{4} & \\frac{1}{4} & 0 \\\\ -\\frac{3}{4} & \\frac{\\sqrt{3}}{4} & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n= \\begin{pmatrix} 0 & \\frac{3}{2} & 0 \\\\ -\\frac{3}{2} & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\n\n**Perform SVD on $\\mathbf{C}$ and Find $\\mathbf{Q}$:**\nLet the SVD of $\\mathbf{C}$ be $\\mathbf{C} = \\mathbf{U} \\mathbf{\\Sigma} \\mathbf{V}^{T}$.\nThe matrices are:\n$$\n\\mathbf{U} = \\begin{pmatrix} 0 & 1 & 0 \\\\ -1 & 0 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}, \\quad\n\\mathbf{\\Sigma} = \\begin{pmatrix} \\frac{3}{2} & 0 & 0 \\\\ 0 & \\frac{3}{2} & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}, \\quad\n\\mathbf{V} = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} = \\mathbf{I}\n$$\nWe compute $\\mathbf{Q}$ starting with $\\mathbf{V}\\mathbf{U}^{T}$:\n$$\n\\mathbf{V}\\mathbf{U}^{T} = \\mathbf{I} \\begin{pmatrix} 0 & -1 & 0 \\\\ 1 & 0 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 0 & -1 & 0 \\\\ 1 & 0 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\nThe determinant is $\\det(\\mathbf{V}\\mathbf{U}^{T}) = 1$. Thus, no correction is needed.\n$$\n\\mathbf{Q} = \\mathbf{V}\\mathbf{U}^{T} = \\begin{pmatrix} 0 & -1 & 0 \\\\ 1 & 0 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\nThis rotation matrix represents a rotation of $+\\frac{\\pi}{2}$ radians ($90^\\circ$) about the z-axis.\n\n**Convert $\\mathbf{Q}$ to Quaternion $\\mathbf{q}$:**\nThe trace of $\\mathbf{Q}$ is $\\text{Tr}(\\mathbf{Q}) = 0 + 0 + 1 = 1$.\nNow we compute the quaternion components:\n$$\nq_{0} = \\frac{1}{2} \\sqrt{1 + 1} = \\frac{\\sqrt{2}}{2}\n$$\n$$\nq_{1} = \\frac{Q_{32} - Q_{23}}{4q_{0}} = \\frac{0 - 0}{4(\\frac{\\sqrt{2}}{2})} = 0\n$$\n$$\nq_{2} = \\frac{Q_{13} - Q_{31}}{4q_{0}} = \\frac{0 - 0}{4(\\frac{\\sqrt{2}}{2})} = 0\n$$\n$$\nq_{3} = \\frac{Q_{21} - Q_{12}}{4q_{0}} = \\frac{1 - (-1)}{4(\\frac{\\sqrt{2}}{2})} = \\frac{2}{2\\sqrt{2}} = \\frac{1}{\\sqrt{2}} = \\frac{\\sqrt{2}}{2}\n$$\nThe resulting quaternion is $\\mathbf{q} = (\\frac{\\sqrt{2}}{2}, 0, 0, \\frac{\\sqrt{2}}{2})$. The component $q_0$ is positive, satisfying the specified convention. The values are exact.\n\nThe final coarse-grained variables are the components of the center-of-mass vector $\\mathbf{R}$ and the orientation quaternion $\\mathbf{q}$.\n$\\mathbf{R} = (1, 2, 3)$ nm.\n$\\mathbf{q} = (\\frac{\\sqrt{2}}{2}, 0, 0, \\frac{\\sqrt{2}}{2})$.\nThe final answer vector is $(R_x, R_y, R_z, q_0, q_1, q_2, q_3)$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1 & 2 & 3 & \\frac{\\sqrt{2}}{2} & 0 & 0 & \\frac{\\sqrt{2}}{2} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Once coarse-grained sites are defined, the next challenge is to derive the effective potential that governs their interactions so the model reproduces key properties of the original atomistic system. This practice explores the theoretical foundation of structure-based coarse-graining by having you derive the Iterative Boltzmann Inversion (IBI) update rule from the statistical mechanical relationship between the potential of mean force and the radial distribution function . By working through this derivation, you will gain a deeper understanding of how structural information can be systematically used to parameterize a computationally efficient model.",
            "id": "3835521",
            "problem": "You are developing a pairwise coarse-grained potential for a simple fluid by matching a target radial distribution function (RDF) at a specified thermodynamic state. The goal is to construct an iterative update for the pair potential based on the measured RDF from a coarse-grained simulation at each iteration. Work within the canonical ensemble of equilibrium statistical mechanics at fixed temperature $T$ and number density $\\rho$, and use only the following foundational facts:\n\n- The radial distribution function $g(r)$ is defined from equilibrium averages of pair separations in the canonical ensemble and determines the potential of mean force $W(r)$ via $W(r) = - k_B T \\ln g(r)$, where $k_B$ is the Boltzmann constant.\n- At sufficiently low density, or under a local linear-response approximation, changes in the logarithm of the RDF respond approximately locally to changes in the pair potential, in the sense that $\\delta \\ln g(r) \\approx - \\beta \\, \\delta U(r)$ with $\\beta = 1/(k_B T)$.\n- The Iterative Boltzmann Inversion (IBI) method seeks an iteration that leaves the pair potential unchanged when the simulated RDF equals the target RDF, and that corrects the potential in the direction that reduces the discrepancy in $g(r)$.\n\nStarting from these bases, and without invoking any pre-existing IBI formulas, derive an update rule for the pair potential $U_{n+1}(r)$ in terms of the current potential $U_n(r)$, the measured RDF $g_n(r)$ obtained from a simulation using $U_n(r)$, and the target RDF $g_{\\mathrm{target}}(r)$ at the same state point. Your derivation should make explicit use of the potential of mean force and the local linear-response approximation and should justify why the resulting update has a fixed point when $g_n(r) = g_{\\mathrm{target}}(r)$. Briefly interpret the convergence properties in terms of fixed points under the dilute-gas limit and under a scalar local sensitivity $\\delta \\ln g(r) \\approx - \\beta \\alpha(r) \\, \\delta U(r)$ with $0 < \\alpha(r) < 2$.\n\nReport, as your final answer, the closed-form analytical expression for the update step $U_{n+1}(r)$ in terms of $U_n(r)$, $g_n(r)$, $g_{\\mathrm{target}}(r)$, $k_B$, and $T$. Do not include any explanatory text or units in your final answer.",
            "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It is based on established principles of statistical mechanics and coarse-graining theory, contains sufficient information for a unique solution, and is free of ambiguity or contradiction. We may therefore proceed with a full derivation.\n\nThe objective is to derive an iterative update rule for a coarse-grained pair potential, $U(r)$, such that the radial distribution function, $g(r)$, produced in a simulation using this potential matches a given target radial distribution function, $g_{\\mathrm{target}}(r)$. The derivation will be constructed within the framework of the canonical ensemble at a fixed temperature $T$ and number density $\\rho$.\n\nLet $U_n(r)$ be the pair potential at iteration $n$, and let $g_n(r)$ be the corresponding radial distribution function obtained from an equilibrium simulation using $U_n(r)$. The goal is to determine an update $\\Delta U_n(r) = U_{n+1}(r) - U_n(r)$ that drives $g_n(r)$ towards $g_{\\mathrm{target}}(r)$ in the subsequent iteration.\n\nThe fundamental connection between the pair potential and the structure of the fluid is provided by the potential of mean force (PMF), $W(r)$. The PMF is defined from the radial distribution function as $W(r) = -k_B T \\ln g(r)$, where $k_B$ is the Boltzmann constant. At very low densities, the PMF is identical to the pair potential, $W(r) \\approx U(r)$, because many-body correlation effects vanish. This suggests that a first approximation to the potential that would generate $g_{\\mathrm{target}}(r)$ is the corresponding PMF itself, $W_{\\mathrm{target}}(r) = -k_B T \\ln g_{\\mathrm{target}}(r)$. This is the basis for the Boltzmann Inversion method.\n\nHowever, at finite density, this approximation is not exact. The Iterative Boltzmann Inversion (IBI) method refines this idea by introducing a correction at each step. We seek an update $U_{n+1}(r)$ based on the discrepancy between the current RDF, $g_n(r)$, and the target, $g_{\\mathrm{target}}(r)$. Let us define the current and target PMFs:\n$$W_n(r) = -k_B T \\ln g_n(r)$$\n$$W_{\\mathrm{target}}(r) = -k_B T \\ln g_{\\mathrm{target}}(r)$$\nThe difference between these two quantities, $W_n(r) - W_{\\mathrm{target}}(r) = k_B T (\\ln g_{\\mathrm{target}}(r) - \\ln g_n(r))$, represents the error in the effective interaction at iteration $n$. A simple idea is to correct the current potential $U_n(r)$ by an amount related to this error.\n\nTo formalize this, we use the provided local linear-response approximation, which relates a small change in the potential, $\\delta U(r)$, to the resulting change in the logarithm of the RDF, $\\delta \\ln g(r)$:\n$$\\delta \\ln g(r) \\approx - \\beta \\, \\delta U(r)$$\nwhere $\\beta = 1/(k_B T)$.\n\nWe wish to choose a potential update, $\\delta U(r) = U_{n+1}(r) - U_n(r)$, that induces a change in the RDF, $\\delta \\ln g(r)$, which eliminates the current error. That is, we desire the new RDF, $g_{n+1}(r)$, to be equal to $g_{\\mathrm{target}}(r)$. Thus, the desired change is:\n$$\\delta \\ln g(r) = \\ln g_{\\mathrm{target}}(r) - \\ln g_n(r)$$\n\nSubstituting our desired change $\\delta \\ln g(r)$ and the potential update $\\delta U(r)$ into the linear-response formula, we get:\n$$\\ln g_{\\mathrm{target}}(r) - \\ln g_n(r) \\approx - \\beta (U_{n+1}(r) - U_n(r))$$\n\nSolving this relation for the next potential, $U_{n+1}(r)$, we treat the approximation as an equality to define the iterative step:\n$$U_{n+1}(r) - U_n(r) = - \\frac{1}{\\beta} (\\ln g_{\\mathrm{target}}(r) - \\ln g_n(r))$$\n$$U_{n+1}(r) = U_n(r) - k_B T (\\ln g_{\\mathrm{target}}(r) - \\ln g_n(r))$$\nThis can be rewritten as the standard IBI update rule:\n$$U_{n+1}(r) = U_n(r) + k_B T \\ln g_n(r) - k_B T \\ln g_{\\mathrm{target}}(r)$$\nThis expression can be compactly written as $U_{n+1}(r) = U_n(r) + W_{\\mathrm{target}}(r) - W_n(r)$, which shows that the potential is corrected by the difference between the target PMF and the current PMF.\n\nTo verify the fixed-point property, we assume the iteration has converged, meaning $U_{n+1}(r) = U_n(r) = U^*(r)$. Substituting this into the update rule gives:\n$$U^*(r) = U^*(r) + k_B T \\ln g^*(r) - k_B T \\ln g_{\\mathrm{target}}(r)$$\nwhere $g^*(r)$ is the RDF produced by the potential $U^*(r)$. This equation simplifies to:\n$$0 = k_B T (\\ln g^*(r) - \\ln g_{\\mathrm{target}}(r))$$\n$$\\ln g^*(r) = \\ln g_{\\mathrm{target}}(r)$$\n$$g^*(r) = g_{\\mathrm{target}}(r)$$\nThis confirms that the iteration has a fixed point precisely when the simulated RDF matches the target RDF, as required.\n\nNow, we briefly interpret the convergence properties.\nIn the dilute-gas limit ($\\rho \\to 0$), many-body correlations are negligible, and the RDF is given exactly by the Boltzmann factor of the pair potential: $g(r) = \\exp(-\\beta U(r))$. In this case, the linear-response approximation with $\\alpha(r)=1$ becomes exact. For the current iteration, $g_n(r) = \\exp(-\\beta U_n(r))$, which means $\\ln g_n(r) = -\\beta U_n(r)$. The target potential $U_{\\mathrm{target}}(r)$ is what gives $g_{\\mathrm{target}}(r)$, so $\\ln g_{\\mathrm{target}}(r)=-\\beta U_{\\mathrm{target}}(r)$. Substituting these into our update rule:\n$$U_{n+1}(r) = U_n(r) + k_B T (-\\beta U_n(r)) - k_B T (-\\beta U_{\\mathrm{target}}(r))$$\n$$U_{n+1}(r) = U_n(r) - U_n(r) + U_{\\mathrm{target}}(r) = U_{\\mathrm{target}}(r)$$\nThis shows that in the dilute-gas limit, the iteration converges to the exact target potential in a single step, irrespective of the initial guess $U_n(r)$.\n\nUnder a more general local sensitivity, $\\delta \\ln g(r) \\approx - \\beta \\alpha(r) \\, \\delta U(r)$, we analyze the stability of the fixed point. Let $U_{\\mathrm{target}}(r)$ be the true potential that generates $g_{\\mathrm{target}}(r)$. Let $\\Delta U_n(r) = U_n(r) - U_{\\mathrm{target}}(r)$ be the error in the potential at step $n$. The IBI update rule for the error is:\n$$\\Delta U_{n+1}(r) = U_{n+1}(r) - U_{\\mathrm{target}}(r) = \\left(U_n(r) + k_B T (\\ln g_n(r) - \\ln g_{\\mathrm{target}}(r))\\right) - U_{\\mathrm{target}}(r)$$\n$$\\Delta U_{n+1}(r) = \\Delta U_n(r) + k_B T (\\ln g_n(r) - \\ln g_{\\mathrm{target}}(r))$$\nApproximating the change in $\\ln g(r)$ around the target state:\n$$\\ln g_n(r) - \\ln g_{\\mathrm{target}}(r) \\approx - \\beta \\alpha(r) (U_n(r) - U_{\\mathrm{target}}(r)) = -\\beta \\alpha(r) \\Delta U_n(r)$$\nSubstituting this back into the error update equation:\n$$\\Delta U_{n+1}(r) \\approx \\Delta U_n(r) + k_B T (-\\beta \\alpha(r) \\Delta U_n(r))$$\n$$\\Delta U_{n+1}(r) \\approx \\Delta U_n(r) - \\alpha(r) \\Delta U_n(r) = (1 - \\alpha(r)) \\Delta U_n(r)$$\nThis shows that the error at each step is multiplied by a factor of $(1 - \\alpha(r))$. For the iteration to converge, the magnitude of this factor must be less than $1$, i.e., $|1 - \\alpha(r)|  1$. This inequality is satisfied if and only if $-1  1 - \\alpha(r)  1$, which simplifies to $0  \\alpha(r)  2$. Thus, the IBI method converges if the system's structural response $\\alpha(r)$ lies within this range. If $\\alpha(r)$ is outside this range, the simple IBI iteration will be unstable and diverge.",
            "answer": "$$\\boxed{U_{n+1}(r) = U_n(r) + k_B T \\ln\\left(\\frac{g_n(r)}{g_{\\mathrm{target}}(r)}\\right)}$$"
        },
        {
            "introduction": "Coarse-graining simplifies a system's degrees of freedom, which has profound consequences for its dynamics; the effects of the eliminated atoms manifest as frictional memory and random noise. This exercise delves into the dynamics of a coarse-grained variable using the Generalized Langevin Equation (GLE), allowing you to analyze the role of the memory kernel and quantify the error introduced by the common Markovian approximation . This practice is crucial for understanding the limitations of simpler dynamical models and appreciating the importance of timescale separation, a key principle governing whether memory effects can be safely ignored.",
            "id": "3835538",
            "problem": "A single coarse variable $q(t)$, obtained by projecting a high-dimensional atomistic dynamics onto a scalar collective coordinate, obeys the Generalized Langevin Equation (GLE). According to the Mori–Zwanzig projection formalism and the Fluctuation–Dissipation Theorem (FDT), the reduced dynamics can be written as\n$$\nm \\ddot{q}(t) + \\int_{0}^{t} K(t-s)\\,\\dot{q}(s)\\,\\mathrm{d}s + k\\,q(t) = F_{\\mathrm{R}}(t),\n$$\nwhere $m$ is the effective mass, $k$ is the coarse-grained harmonic stiffness, $K(t)$ is the memory kernel determined by unresolved degrees of freedom, and $F_{\\mathrm{R}}(t)$ is a stationary random force consistent with the FDT. The memory kernel width is set by the decorrelation time of the orthogonal dynamics; denote this width by the fast timescale $\\tau_{f} > 0$. The slow relaxation timescale of the coarse mode in the Markovian overdamped limit is $\\tau_{s} = \\gamma/k$, where $\\gamma$ is the friction coefficient defined as the integral of the memory kernel.\n\nConsider the high-friction overdamped regime $m \\to 0$, and focus on the deterministic relaxation of the mean by setting $F_{\\mathrm{R}}(t) = 0$. Assume a scientifically standard parametrization of the memory kernel with weak scale separation through a single-exponential form\n$$\nK(t) = \\frac{\\gamma}{\\tau_{f}} \\exp\\!\\Big(-\\frac{t}{\\tau_{f}}\\Big),\n$$\nwhich has integral $\\int_{0}^{\\infty} K(t)\\,\\mathrm{d}t = \\gamma$ and width $\\tau_{f}$. The Markovian closure with a Dirac delta function kernel replaces $K(t)$ by $K_{\\delta}(t) = \\gamma\\,\\delta(t)$.\n\nStarting from the above foundations, determine the slow relaxation rates predicted by the non-Markovian single-exponential kernel and by the Markovian $\\delta$-kernel closure, respectively. Then, compute an analytic expression for the relative error $E$ of the Markovian prediction with respect to the non-Markovian prediction, defined as\n$$\nE \\equiv \\frac{|\\lambda_{\\delta} - \\lambda_{\\mathrm{NM}}|}{|\\lambda_{\\mathrm{NM}}|},\n$$\nwhere $\\lambda_{\\delta}$ is the relaxation rate under the Markovian $\\delta$-kernel closure and $\\lambda_{\\mathrm{NM}}$ is the relaxation rate under the non-Markovian single-exponential kernel. Your final answer must be a single closed-form expression for $E$ in terms of $\\tau_{f}$ and $\\tau_{s}$. No numerical evaluation is required. State units or angle units only if relevant; here they are not required. Interpret physically when a Markovian closure with $\\delta$-kernel friction fails by relating $E$ to a prescribed tolerance, but do not include any inequalities in your final answer.",
            "solution": "The user has provided a scientifically valid and well-posed problem statement from the field of coarse-grained modeling. All necessary definitions and equations are provided, and the problem is free of contradictions or ambiguities. I will therefore proceed with a full solution.\n\nThe problem requires us to determine the slow relaxation rates for a coarse-grained variable $q(t)$ under two different models for the memory kernel $K(t)$ in the overdamped Generalized Langevin Equation (GLE). The GLE for the deterministic relaxation of the mean, in the overdamped limit ($m \\to 0$), is given by:\n$$\n\\int_{0}^{t} K(t-s)\\,\\dot{q}(s)\\,\\mathrm{d}s + k\\,q(t) = 0\n$$\nWe will first analyze the Markovian case and then the non-Markovian case, and finally compute the relative error between their predicted relaxation rates.\n\n**1. Markovian Relaxation Rate ($\\lambda_{\\delta}$)**\n\nThe Markovian approximation replaces the memory kernel $K(t)$ with a Dirac delta function, $K_{\\delta}(t) = \\gamma\\,\\delta(t)$, where $\\gamma = \\int_{0}^{\\infty} K(t')\\,\\mathrm{d}t'$ is the total friction. Substituting this into the GLE:\n$$\n\\int_{0}^{t} \\gamma\\,\\delta(t-s)\\,\\dot{q}(s)\\,\\mathrm{d}s + k\\,q(t) = 0\n$$\nUsing the sifting property of the Dirac delta function, the integral evaluates to $\\gamma\\,\\dot{q}(t)$:\n$$\n\\gamma\\,\\dot{q}(t) + k\\,q(t) = 0\n$$\nThis is a first-order linear ordinary differential equation. We seek a solution of the form $q(t) = q(0)\\,\\exp(-\\lambda t)$, which describes exponential relaxation. Substituting this ansatz into the equation gives:\n$$\n\\gamma\\,(-\\lambda\\,q(t)) + k\\,q(t) = 0\n$$\nFor a non-trivial solution ($q(t) \\neq 0$), the rate $\\lambda$ must satisfy:\n$$\n-\\gamma\\,\\lambda + k = 0\n$$\nSolving for the relaxation rate, which we denote as $\\lambda_{\\delta}$, we find:\n$$\n\\lambda_{\\delta} = \\frac{k}{\\gamma}\n$$\nThe problem defines the slow relaxation timescale as $\\tau_s = \\gamma/k$. Therefore, the Markovian relaxation rate is:\n$$\n\\lambda_{\\delta} = \\frac{1}{\\tau_s}\n$$\n\n**2. Non-Markovian Relaxation Rate ($\\lambda_{\\mathrm{NM}}$)**\n\nFor the non-Markovian case, the memory kernel is given by the single-exponential form:\n$$\nK(t) = \\frac{\\gamma}{\\tau_{f}} \\exp\\left(-\\frac{t}{\\tau_{f}}\\right)\n$$\nwhere $\\tau_f$ is the memory decorrelation time. The governing integro-differential equation is:\n$$\n\\int_{0}^{t} \\frac{\\gamma}{\\tau_{f}} \\exp\\left(-\\frac{t-s}{\\tau_{f}}\\right)\\,\\dot{q}(s)\\,\\mathrm{d}s + k\\,q(t) = 0\n$$\nThis is a Volterra integral equation of the convolution type. A standard method to solve this is to convert it into a system of ordinary differential equations. Let us define an auxiliary variable $z(t)$ as the friction term:\n$$\nz(t) \\equiv \\int_{0}^{t} \\frac{\\gamma}{\\tau_{f}} \\exp\\left(-\\frac{t-s}{\\tau_{f}}\\right)\\,\\dot{q}(s)\\,\\mathrm{d}s\n$$\nThe GLE then becomes $z(t) + k\\,q(t) = 0$, which implies $z(t) = -k\\,q(t)$. Differentiating this with respect to time gives $\\dot{z}(t) = -k\\,\\dot{q}(t)$.\n\nNow, we differentiate the definition of $z(t)$ using the Leibniz integral rule:\n$$\n\\dot{z}(t) = \\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{0}^{t} K(t-s)\\,\\dot{q}(s)\\,\\mathrm{d}s = K(0)\\,\\dot{q}(t) + \\int_{0}^{t} \\frac{\\partial K(t-s)}{\\partial t}\\,\\dot{q}(s)\\,\\mathrm{d}s\n$$\nFor our kernel, $K(0) = \\gamma/\\tau_f$ and $\\frac{\\partial K(t-s)}{\\partial t} = -\\frac{1}{\\tau_f} K(t-s)$. Substituting these in:\n$$\n\\dot{z}(t) = \\frac{\\gamma}{\\tau_f}\\,\\dot{q}(t) - \\frac{1}{\\tau_f} \\int_{0}^{t} K(t-s)\\,\\dot{q}(s)\\,\\mathrm{d}s = \\frac{\\gamma}{\\tau_f}\\,\\dot{q}(t) - \\frac{1}{\\tau_f} z(t)\n$$\nWe now have a system of two equations:\n1. $\\dot{z}(t) = -k\\,\\dot{q}(t)$\n2. $\\dot{z}(t) = \\frac{\\gamma}{\\tau_f}\\,\\dot{q}(t) - \\frac{1}{\\tau_f} z(t)$\n\nEquating the expressions for $\\dot{z}(t)$ and substituting $z(t) = -k\\,q(t)$:\n$$\n-k\\,\\dot{q}(t) = \\frac{\\gamma}{\\tau_f}\\,\\dot{q}(t) - \\frac{1}{\\tau_f}(-k\\,q(t))\n$$\nRearranging the terms to form a single ODE for $q(t)$:\n$$\n\\left(k + \\frac{\\gamma}{\\tau_f}\\right)\\dot{q}(t) + \\frac{k}{\\tau_f}\\,q(t) = 0\n$$\nMultiplying by $\\tau_f$:\n$$\n(k\\,\\tau_f + \\gamma)\\dot{q}(t) + k\\,q(t) = 0\n$$\nThis is again a first-order linear ODE. The relaxation rate $\\lambda_{\\mathrm{NM}}$ is found from the characteristic equation:\n$$\n(k\\,\\tau_f + \\gamma)(-\\lambda_{\\mathrm{NM}}) + k = 0\n$$\nSolving for $\\lambda_{\\mathrm{NM}}$:\n$$\n\\lambda_{\\mathrm{NM}} = \\frac{k}{\\gamma + k\\,\\tau_f}\n$$\n\n**3. Relative Error Calculation**\n\nThe relative error $E$ of the Markovian prediction with respect to the non-Markovian one is defined as:\n$$\nE \\equiv \\frac{|\\lambda_{\\delta} - \\lambda_{\\mathrm{NM}}|}{|\\lambda_{\\mathrm{NM}}|}\n$$\nThe rates $\\lambda_{\\delta}$ and $\\lambda_{\\mathrm{NM}}$ are both positive, as $k, \\gamma, \\tau_f > 0$. Also, since $\\gamma + k\\tau_f > \\gamma$, it follows that $\\lambda_{\\mathrm{NM}}  \\lambda_\\delta$. The numerator is positive, so we can drop the outer absolute value.\n$$\nE = \\frac{\\lambda_{\\delta} - \\lambda_{\\mathrm{NM}}}{\\lambda_{\\mathrm{NM}}} = \\frac{\\lambda_{\\delta}}{\\lambda_{\\mathrm{NM}}} - 1\n$$\nSubstituting the expressions for the rates:\n$$\nE = \\frac{k/\\gamma}{k/(\\gamma + k\\,\\tau_f)} - 1 = \\frac{\\gamma + k\\,\\tau_f}{\\gamma} - 1 = \\left(1 + \\frac{k\\,\\tau_f}{\\gamma}\\right) - 1\n$$\nThis simplifies to:\n$$\nE = \\frac{k\\,\\tau_f}{\\gamma}\n$$\nFinally, we express this result in terms of the given timescales $\\tau_f$ and $\\tau_s = \\gamma/k$. We note that $k/\\gamma = 1/\\tau_s$.\n$$\nE = \\left(\\frac{k}{\\gamma}\\right) \\tau_f = \\frac{\\tau_f}{\\tau_s}\n$$\n\n**Physical Interpretation**\nThe relative error $E = \\tau_f / \\tau_s$ is the ratio of the fast memory timescale $\\tau_f$ to the slow coarse-grained relaxation timescale $\\tau_s$. The Markovian approximation assumes an infinite separation of timescales, i.e., that the bath decorrelates instantaneously compared to the evolution of the slow variable ($\\tau_f \\to 0$). Our result quantifies the error incurred when this assumption is not perfectly met. If a certain relative error tolerance, say $\\epsilon$, is prescribed for the relaxation rate, the Markovian closure is considered to fail when $E > \\epsilon$, which translates to $\\tau_f / \\tau_s > \\epsilon$. This failure occurs when the memory persistence time $\\tau_f$ is a non-negligible fraction of the system's own relaxation time $\\tau_s$, violating the timescale separation principle.",
            "answer": "$$\\boxed{\\frac{\\tau_f}{\\tau_s}}$$"
        }
    ]
}