{
    "hands_on_practices": [
        {
            "introduction": "迭代玻尔兹曼反演（IBI）过程始于对有效势的初始猜测。本练习将探讨最基本的出发点：一个没有相互作用的系统。通过执行单步IBI更新，您将推导出初次迭代势的解析形式，揭示其与平均力势（PMF）的直接联系，并为整个迭代精化过程奠定基础。",
            "id": "3810822",
            "problem": "考虑一个单原子Lennard–Jones流体，其绝对温度为 $T$，数密度为 $\\rho$。原子模拟为其提供了适用于所有 $g_{\\mathrm{target}}(r)>0$ 的距离 $r$ 的径向平均的目标径向分布函数 $g_{\\mathrm{target}}(r)$。你需要对该流体进行基于结构的粗粒化，粗粒化为一个单点、对加性模型，该模型具有各向同性的有效对势 $u(r)$，且在相同的 $T$ 和 $\\rho$ 下能重现 $g_{\\mathrm{target}}(r)$。假设粗粒化相互作用是平移不变且对加性的，并考虑体积为 $V$ 中包含 $N$ 个粒子的正则系综。\n\n从零相互作用的初始猜测 $u_{0}(r)=0$ 开始，你需要执行一步迭代玻尔兹曼反演 (Iterative Boltzmann Inversion, IBI)，以构建更新后的势 $u_{1}(r)$，此过程仅使用基于物理的统计力学定义以及使用 $u_{0}(r)=0$ 的试验模拟是理想气体这一事实。推导 $u_{1}(r)$ 的闭式表达式，用 $k_{B}$、$T$ 和 $g_{\\mathrm{target}}(r)$ 表示。\n\n将最终答案表示为单一的解析表达式。不需要数值近似或四舍五入。在答案框内的最终表达式中不要包含物理单位；该表达式必须是关于 $k_{B}$、$T$ 和 $g_{\\mathrm{target}}(r)$ 的符号表达式。",
            "solution": "用户提供了一个问题陈述，在尝试解答之前需要对其进行验证。\n\n### 第1步：提取已知条件\n- **系统**：单原子Lennard–Jones流体。\n- **状态变量**：绝对温度 $T$ 和数密度 $\\rho$。\n- **目标函数**：对于所有 $g_{\\mathrm{target}}(r)>0$ 的距离 $r$ ，径向平均的目标径向分布函数 $g_{\\mathrm{target}}(r)$。\n- **粗粒化模型**：一个单点、对加性模型，具有各向同性的有效对势 $u(r)$。\n- **目标**：粗粒化模型必须在相同的 $T$ 和 $\\rho$ 下重现 $g_{\\mathrm{target}}(r)$。\n- **假设**：粗粒化相互作用是平移不变且对加性的。\n- **系综**：正则系综（体积 $V$ 中有 $N$ 个粒子）。\n- **方法**：一步迭代玻尔兹曼反演 (IBI)。\n- **初始条件**：势的初始猜测为 $u_{0}(r)=0$。\n- **任务**：推导更新后的势 $u_{1}(r)$ 的闭式表达式，用 $k_{B}$、$T$ 和 $g_{\\mathrm{target}}(r)$ 表示。\n\n### 第2步：使用提取的已知条件进行验证\n根据验证标准评估问题陈述。\n\n- **科学依据**：该问题坚实地植根于统计力学和计算化学的原理。迭代玻尔兹曼反演 (IBI) 是一种标准且广泛使用的基于结构的粗粒化技术。径向分布函数 ($g(r)$)、对势 ($u(r)$)、理想气体和正则系综等概念是该领域的基础。\n- **适定性**：该问题是适定的。它提供了一个明确的初始条件 ($u_{0}(r)=0$)、一个要应用的具体算法（一步 IBI），以及一个明确定义的目标（$u_{1}(r)$ 的闭式表达式）。这种结构导向一个唯一且有意义的解。\n- **客观性**：该问题使用精确、客观和标准的科学术语进行陈述。没有主观或含糊不清的表述。\n\n该问题没有表现出任何列出的无效性缺陷。它在科学上是合理的，可形式化的，完整的，并且直接关系到基于结构的粗粒化这一特定主题。\n\n### 第3步：结论与行动\n该问题是 **有效的**。将提供解答。\n\n目标是，从初始猜测 $u_{0}(r)=0$ 开始，经过一次迭代玻尔兹曼反演 (IBI) 方法后，求出有效对势 $u_{1}(r)$。\n\nIBI 方法是一个迭代过程，旨在优化对势 $u(r)$ 以重现已知的目标径向分布函数 $g_{\\mathrm{target}}(r)$。该方法的核心是更新规则，它根据第 $i$ 次迭代产生的 RDF ($g_{i}(r)$) 与目标 RDF ($g_{\\mathrm{target}}(r)$) 之间的差异来修正势。标准的 IBI 更新方程是：\n$$u_{i+1}(r) = u_{i}(r) + k_{B} T \\ln\\left( \\frac{g_{i}(r)}{g_{\\mathrm{target}}(r)} \\right)$$\n其中 $u_{i+1}(r)$ 是下一次迭代的精化势，$u_{i}(r)$ 是当前势，$g_{i}(r)$ 是使用 $u_{i}(r)$ 进行模拟得到的 RDF，$k_{B}$ 是玻尔兹曼常数，$T$ 是绝对温度。这个更新规则源于一个将平均力势与对势相关联的近似。\n\n我们被要求执行此迭代的第一步，这对应于设置 $i=0$。更新方程变为：\n$$u_{1}(r) = u_{0}(r) + k_{B} T \\ln\\left( \\frac{g_{0}(r)}{g_{\\mathrm{target}}(r)} \\right)$$\n\n问题提供了势的初始猜测：\n$$u_{0}(r) = 0$$\n\n接下来，我们必须确定 $g_{0}(r)$，即由势 $u_{0}(r)=0$ 控制的系统的径向分布函数。根据定义，一个相互作用势为零的粒子系统是理想气体。在理想气体中，粒子之间不相互作用，因此它们的位置完全不相关。\n\n径向分布函数 $g(r)$ 的定义是，$\\rho g(r)$ 给出距离任意选择的中心粒子为 $r$ 处粒子的平均局部数密度，其中 $\\rho$ 是体数密度。对于理想气体，在原点存在一个粒子不影响在任何其他位置找到另一个粒子的概率。因此，距离中心粒子任意距离 $r$ 处的局部密度就是体密度 $\\rho$。\n$$\\rho g_{0}(r) = \\rho$$\n这意味着对于理想气体，径向分布函数在所有距离 $r$ 上都为1：\n$$g_{0}(r) = 1$$\n\n现在，我们将 $u_{0}(r)$ 和 $g_{0}(r)$ 的表达式代入 $u_{1}(r)$ 的 IBI 更新方程中：\n$$u_{1}(r) = 0 + k_{B} T \\ln\\left( \\frac{1}{g_{\\mathrm{target}}(r)} \\right)$$\n\n利用对数的性质 $\\ln(1/x) = \\ln(1) - \\ln(x) = -\\ln(x)$，我们简化表达式：\n$$u_{1}(r) = k_{B} T \\left( \\ln(1) - \\ln(g_{\\mathrm{target}}(r)) \\right)$$\n$$u_{1}(r) = k_{B} T \\left( 0 - \\ln(g_{\\mathrm{target}}(r)) \\right)$$\n$$u_{1}(r) = -k_{B} T \\ln(g_{\\mathrm{target}}(r))$$\n\n这个结果是与目标 RDF 对应的平均力势 $W(r)$，因为 $W(r) = -k_{B}T \\ln(g(r))$。因此，从零势开始的 IBI 第一步，等效于用目标系统的平均力势来近似有效对势。问题陈述指明了 $g_{\\mathrm{target}}(r) > 0$，这确保了对数有良好定义，并且得到的势 $u_1(r)$ 是有限的。在粒子不能重叠的极小距离处，$g_{\\mathrm{target}}(r) \\to 0$，推导出的势 $u_1(r) \\to \\infty$，这正确地表示了强的空间排斥作用。",
            "answer": "$$\\boxed{-k_{B} T \\ln(g_{\\mathrm{target}}(r))}$$"
        },
        {
            "introduction": "本练习将理论付诸实践，模拟IBI过程中一个真实的数值精化步骤。利用目标和模拟径向分布函数（RDF）的离散数据，您将应用核心IBI更新方程来计算精化后的势。此实践还旨在解决实际操作中的一个关键挑战：如何处理粒子计数为零的距离区间，从而引导您采用基于物理意义的方法以避免数值奇异点。",
            "id": "3843094",
            "problem": "您正在对单组分流体进行粗粒化，以重现指定的径向分布函数 (RDF)。在成对粗粒化模型中，径向分布函数 $g(r)$ 通过平衡玻尔兹曼关系 $g(r) = \\exp\\!\\big(-\\beta W(r)\\big)$ 与平均力势 (PMF) $W(r)$ 相关，其中 $W(r)$ 可相差一个加性常数，$\\beta = 1/(k_B T)$ 是逆热能，$k_B$ 是玻尔兹曼常数，$T$ 是绝对温度。在通过迭代玻尔兹曼反演 (IBI) 进行的基于结构的粗粒化中，目标是更新一个试验性的对势 $V_n(r)$，使得模拟得到的径向分布函数 $g_n(r)$ 与从更高分辨率的参考系统获得的目标径向分布函数 $g_{\\text{target}}(r)$ 相匹配。缩写 IBI 代表迭代玻尔兹曼反演 (Iterative Boltzmann Inversion)。\n\n假设使用约化的 Lennard-Jones 单位，其中距离以特征长度的倍数度量，能量以特征能量的倍数度量，热能 $k_B T = 2.5$。您在均匀的区间中心网格 $r \\in \\{0.60, 0.70, 0.80, 0.90, 1.00\\}$ 上获得了离散化数据：\n- 在这些区间上，当前的对势 $V_n(r)$ 为 $\\{10.0, 2.5, -0.3, 0.1, 0.2\\}$。\n- 当前模拟的径向分布函数 $g_n(r)$ 为 $\\{0.00, 0.40, 1.30, 1.10, 0.80\\}$。\n- 目标径向分布函数 $g_{\\text{target}}(r)$ 为 $\\{0.02, 0.50, 1.20, 0.95, 0.85\\}$。\n\n从 $g(r)$ 和平均力势 $W(r)$ 之间的基本关系出发，并基于成对粗粒化势 $V(r)$ 应追踪平均力势以实现目标结构的建模假设，推导 $V_{n+1}(r)$ 的迭代更新公式，用 $V_n(r)$、$g_n(r)$、$g_{\\text{target}}(r)$ 和 $k_B T$ 来表示。根据物理原理，论证每一项的符号和形式的合理性。\n\n然后，使用您推导的更新公式，计算当 $k_B T = 2.5$ 时，$V_{n+1}(r)$ 在 $r = 0.70$ 处的数值。将您的最终数值答案四舍五入到四位有效数字。能量使用上述的约化单位表示。\n\n最后，解释如何处理 $g_n(r) = 0$ 的区间（例如，在所提供的数据中 $r = 0.60$ 处），以使更新保持良态 (well-posed) 和物理上合理。您的解释应基于 $g(r)$ 的统计力学意义。\n\n您的最终答案必须是一个实数，对应于约化能量单位下的 $V_{n+1}(0.70)$，并按要求四舍五入到四位有效数字。不要在最终的方框答案中包含任何单位。",
            "solution": "该问题陈述经评估具有科学依据、良态性、客观性和自洽性。进行所需计算的所有必要数据均已提供。所涉及的概念，如径向分布函数 $g(r)$、平均力势 $W(r)$、玻尔兹曼反演和迭代方案，在统计力学和分子模拟领域是标准且成熟的。对于用约化单位描述的系统，数值是物理上合理的。因此，该问题有效，下面构建解决方案。\n\n基于结构的粗粒化的核心是找到一个有效的对势 $V(r)$，该势能重现目标径向分布函数 $g_{\\text{target}}(r)$。径向分布函数 $g(r)$ 与平均力势 (PMF) $W(r)$ 之间的基本统计力学关系由以下公式给出：\n$$g(r) = \\exp\\left(-\\frac{W(r)}{k_B T}\\right)$$\n其中 $k_B$ 是玻尔兹曼常数，$T$ 是绝对温度。因此，通过反转此关系可以从 RDF 获得 PMF：\n$$W(r) = -k_B T \\ln(g(r))$$\n该表达式的确定可相差一个任意的加性常数，我们可以在不失一般性的情况下将其设为零，因为它只改变势能基线。\n\n像迭代玻尔兹曼反演 (IBI) 这类方法的基本假设是，有效对势 $V(r)$ 应近似于平均力势，即 $V(r) \\approx W(r)$。这一假设的动机来自于 Henderson 唯一定理，该定理在特定条件下保证，对于给定的 $g(r)$，产生它的对势 $V(r)$是唯一的。然而，平均力势 $W(r)$ 隐含地包含了多体相关效应，而粗粒化模拟通常是使用纯粹的成对势 $V(r)$ 进行的。因此，直接反演 $V(r) = -k_B T \\ln(g_{\\text{target}}(r))$ 通常无法重现 $g_{\\text{target}}(r)$，因为使用该 $V(r)$ 进行模拟所得到的平均力势将不等于 $V(r)$。\n\nIBI 通过迭代方式解决这个问题。在第 $n$ 次迭代中，我们有一个试验势 $V_n(r)$，它产生一个模拟的 RDF $g_n(r)$ 和相应的 PMF $W_n(r) = -k_B T \\ln(g_n(r))$。目标是获得目标 RDF $g_{\\text{target}}(r)$，它对应于一个目标 PMF $W_{\\text{target}}(r) = -k_B T \\ln(g_{\\text{target}}(r))$。\n\nIBI 更新提出了对势的一个修正项 $\\Delta V_n(r)$，该修正基于当前结构与目标结构之间的失配。用于下一次迭代的势的更新 $V_{n+1}(r)$ 构建如下：\n$$V_{n+1}(r) = V_n(r) + \\Delta V_n(r)$$\n选择该修正项是为了补偿 PMF 的差异。其基本原理是，对势 $V(r)$ 和 PMF $W(r)$ 之间的差异源于多体贡献，而这些贡献被假设在迭代之间变化缓慢。因此，我们用目标 PMF 和当前 PMF 之间的差异来近似所需的势修正：\n$$\\Delta V_n(r) \\approx W_{\\text{target}}(r) - W_n(r)$$\n代入 PMF 的表达式：\n$$\\Delta V_n(r) = \\left(-k_B T \\ln(g_{\\text{target}}(r))\\right) - \\left(-k_B T \\ln(g_n(r))\\right)$$\n$$\\Delta V_n(r) = k_B T \\left(\\ln(g_n(r)) - \\ln(g_{\\text{target}}(r))\\right)$$\n利用对数的性质 $\\ln(a) - \\ln(b) = \\ln(a/b)$：\n$$\\Delta V_n(r) = k_B T \\ln\\left(\\frac{g_n(r)}{g_{\\text{target}}(r)}\\right)$$\n因此，势的完整更新规则是：\n$$V_{n+1}(r) = V_n(r) + k_B T \\ln\\left(\\frac{g_n(r)}{g_{\\text{target}}(r)}\\right)$$\n在实践中，通常会引入一个阻尼因子 $\\alpha \\in (0, 1]$，即 $V_{n+1}(r) = V_n(r) + \\alpha k_B T \\ln(g_n(r)/g_{\\text{target}}(r))$，以提高数值稳定性，但题目暗示 $\\alpha=1$。\n\n此更新规则的物理原理如下：\n1.  如果 $g_n(r) > g_{\\text{target}}(r)$，说明在距离 $r$ 处，当前 RDF 显示粒子对过多。这意味着势 $V_n(r)$ 太具吸引力（或排斥力不足）。为了修正这一点，必须增加势（使其更具排斥性）。更新项的参数 $\\frac{g_n(r)}{g_{\\text{target}}(r)} > 1$，其对数为正，因此 $\\Delta V_n(r) > 0$。这正确地增加了势。\n2.  如果 $g_n(r) < g_{\\text{target}}(r)$，说明在距离 $r$ 处，当前 RDF 显示粒子对不足。这意味着 $V_n(r)$ 太具排斥性。必须减小势（使其更具吸引力）。参数 $\\frac{g_n(r)}{g_{\\text{target}}(r)} < 1$，其对数为负，因此 $\\Delta V_n(r) < 0$。这正确地减小了势。\n3.  如果 $g_n(r) = g_{\\text{target}}(r)$，说明在此距离处的结构是正确的，不需要更新。对数的参数为 $1$，其对数为 $0$，因此 $\\Delta V_n(r) = 0$。势保持不变，这是期望的行为。\n\n接下来，我们计算 $V_{n+1}(r)$ 在 $r = 0.70$ 处的数值。\n给定的数据是：\n- $k_B T = 2.5$\n- 在 $r = 0.70$ 处：\n  - $V_n(0.70) = 2.5$\n  - $g_n(0.70) = 0.40$\n  - $g_{\\text{target}}(0.70) = 0.50$\n\n使用推导出的更新公式：\n$$V_{n+1}(0.70) = V_n(0.70) + k_B T \\ln\\left(\\frac{g_n(0.70)}{g_{\\text{target}}(0.70)}\\right)$$\n代入数值：\n$$V_{n+1}(0.70) = 2.5 + 2.5 \\ln\\left(\\frac{0.40}{0.50}\\right)$$\n$$V_{n+1}(0.70) = 2.5 + 2.5 \\ln(0.8)$$\n$0.8$ 的自然对数约为 $-0.22314355$。\n$$V_{n+1}(0.70) \\approx 2.5 + 2.5 \\times (-0.22314355)$$\n$$V_{n+1}(0.70) \\approx 2.5 - 0.55785888$$\n$$V_{n+1}(0.70) \\approx 1.94214112$$\n四舍五入到四位有效数字，得到 $1.942$。\n\n最后，我们讨论在 $r=0.60$ 处观察到的 $g_n(r) = 0$ 的特殊情况。\n$g(r)$ 的统计力学解释是，它与在分离距离 $r$ 处找到一对粒子的概率密度成正比。在有限时长的模拟中，$g_n(r)=0$ 意味着在该距离区间内没有观察到粒子对。这通常是由于强排斥势核（即排斥体积）或对高能构象的采样不足所致。\n如果我们直接在 $g_n(r) = 0$ 的地方应用 IBI 更新规则：\n$$V_{n+1}(r) = V_n(r) + k_B T \\ln\\left(\\frac{0}{g_{\\text{target}}(r)}\\right)$$\n项 $\\ln(0)$ 是未定义的，趋近于 $-\\infty$。这将导致数值上的灾难性更新，试图将 $V_{n+1}(r) \\to -\\infty$。这是有限采样的产物；一个零计数事件并不意味着不可能事件（零概率），而是一个未被观测到的低概率事件。由此产生的无限大的吸引力修正是非物理的。\n\n为了处理这种情况，必须对更新规则进行正则化。一个稳健的实现不应在 $g_n(r)=0$ 的区间使用直接公式。一个常见且物理上合理的过程是：\n1.  认识到当 $g_n(r)=0$ 而 $g_{\\text{target}}(r) > 0$ 时（此处 $g_{\\text{target}}(0.60) = 0.02$），表明当前的势 $V_n(r)$ 排斥性过强。\n2.  不使用对数公式，而是应用启发式修正。例如，可以对更新进行封顶，或用一个合理的、有限的吸引力修正来代替。一种这样的方法是从 $g_n(r)$ 非零且行为良好的相邻区域对势进行线性外推。\n3.  另一种简单有效的方法是对势施加一个较大但有限的吸引力“冲击”。例如，可以设置 $V_{n+1}(r) = V_n(r) - C$，其中 $C$ 是一个量级为几个 $k_B T$ 的常数。这会降低势垒，使得该区域在下一次模拟迭代中可以被访问，从而可以采样到非零的 $g_{n+1}(r)$，之后便可使用标准的 IBI 更新。其目标是恰到好处地修正势，以便在下一步中填充该区间，从而避免数值奇点。",
            "answer": "$$\\boxed{1.942}$$"
        },
        {
            "introduction": "粗粒化方法的一个关键挑战是，一个为重现结构而优化的势并不保证能够重现热力学性质。这项高级练习直面这一“可表征性”问题。您将首先使用维里定理计算粗粒化模型的压力，然后将其与目标系统的压力进行比较，从而展示常见的压力不匹配问题，并引导对标准校正技术的讨论。",
            "id": "3843056",
            "problem": "温度为 $T$、数密度为 $\\rho$ 的单组分各向同性粗粒化流体由一个对加和模型表示，其初始对势取为平均力势 $u(r) = - k_{B} T \\ln g(r)$，其中 $k_{B}$ 是玻尔兹曼常数，$g(r)$ 是在相同状态点下通过原子模拟测得的目标径向分布函数。考虑以下解析参数化的目标径向分布函数：\n$$\ng(r) = 1 + a \\exp(-\\alpha r)\\,\\sin(\\beta r),\n$$\n参数为 $a = 0.20$ (无量纲)，$\\alpha = 20\\,\\mathrm{nm}^{-1}$，$\\beta = 10\\,\\mathrm{nm}^{-1}$。热力学状态为 $T = 300\\,\\mathrm{K}$，$\\rho = 5.0\\,\\mathrm{nm}^{-3}$。此状态点下的原子模拟压力为 $P_{\\mathrm{AT}} = 19.70\\,\\mathrm{MPa}$。\n\n使用适用于具有对中心力的各向同性流体的维里路径，并利用给定的 $g(r)$ 和模型势，计算该状态下粗粒化模型的预测压力 $P_{\\mathrm{CG}}$。如果 $P_{\\mathrm{CG}}$ 偏离 $P_{\\mathrm{AT}}$，请解释在基于结构的粗粒化方法——迭代玻尔兹曼反演 (IBI) 中，会引入何种类型的修正来减小这种差异，同时保持短程结构保真度，并指出本案例中所需修正的符号。无需进行任何振幅拟合；仅需从概念上描述该修正。\n\n将最终压力四舍五入至四位有效数字，并以 $\\mathrm{MPa}$ 为单位表示。",
            "solution": "该问题要求计算粗粒化(CG)流体模型的压力，并对迭代玻尔兹曼反演(IBI)方法中通常使用的压力修正进行概念性描述。\n\n首先，我们验证问题陈述的有效性。\n给定条件如下：\n- 温度: $T = 300\\,\\mathrm{K}$\n- 数密度: $\\rho = 5.0\\,\\mathrm{nm}^{-3}$\n- 目标径向分布函数 (RDF): $g(r) = 1 + a \\exp(-\\alpha r)\\,\\sin(\\beta r)$\n- RDF 参数: $a = 0.20$ (无量纲)，$\\alpha = 20\\,\\mathrm{nm}^{-1}$，$\\beta = 10\\,\\mathrm{nm}^{-1}$\n- 玻尔兹曼常数: $k_{B}$\n- 粗粒化势 (平均力势, PMF): $u(r) = - k_{B} T \\ln g(r)$\n- 目标原子模拟压力: $P_{\\mathrm{AT}} = 19.70\\,\\mathrm{MPa}$\n\n该问题在科学上基于统计力学和多尺度模拟的原理。它使用了平均力势、维里压力的标准定义，并引用了一种成熟的粗粒化技术(IBI)。所提供的 $g(r)$ 函数形式代表了一种合理的液体结构。所有必要数据均已提供。该问题是适定且客观的。因此，该问题被认为是有效的。\n\n第1部分：粗粒化压力 $P_{\\mathrm{CG}}$ 的计算\n\n具有对中心力的各向同性流体的压力可以使用维里压力方程计算：\n$$\nP_{\\mathrm{CG}} = \\rho k_B T - \\frac{2\\pi\\rho^2}{3} \\int_0^\\infty r^3 \\frac{du(r)}{dr} g_{\\mathrm{CG}}(r) dr\n$$\n此处，$g_{\\mathrm{CG}}(r)$ 是使用势 $u(r)$ 进行模拟所产生的RDF。在IBI的第一步中，作为一个合理的近似，我们假设平均力势 $u(r)$ 生成的RDF与目标RDF $g(r)$ 相近。因此，我们近似 $g_{\\mathrm{CG}}(r) \\approx g(r)$。我们必须首先求出势的导数 $\\frac{du(r)}{dr}$。\n给定 $u(r) = - k_{B} T \\ln g(r)$，其关于 $r$ 的导数为：\n$$\n\\frac{du(r)}{dr} = -k_B T \\frac{1}{g(r)} \\frac{dg(r)}{dr}\n$$\n将此式代入压力方程，并使用近似 $g_{\\mathrm{CG}}(r) \\approx g(r)$，被积函数中的 $g(r)$ 项相互抵消：\n$$\nP_{\\mathrm{CG}} = \\rho k_B T - \\frac{2\\pi\\rho^2}{3} \\int_0^\\infty r^3 \\left(-k_B T \\frac{1}{g(r)} \\frac{dg(r)}{dr}\\right) g(r) dr\n$$\n$$\nP_{\\mathrm{CG}} = \\rho k_B T + \\frac{2\\pi\\rho^2 k_B T}{3} \\int_0^\\infty r^3 \\frac{dg(r)}{dr} dr\n$$\n现在，我们计算给定 $g(r) = 1 + a \\exp(-\\alpha r)\\,\\sin(\\beta r)$ 的导数：\n$$\n\\frac{dg(r)}{dr} = a \\frac{d}{dr} \\left[ \\exp(-\\alpha r)\\,\\sin(\\beta r) \\right] = a \\left[ -\\alpha \\exp(-\\alpha r)\\,\\sin(\\beta r) + \\beta \\exp(-\\alpha r)\\,\\cos(\\beta r) \\right]\n$$\n积分项为 $\\int_0^\\infty r^3 \\frac{dg(r)}{dr} dr$。我们可以使用分部积分法求解，设 $U = r^3$ 且 $dV = \\frac{dg(r)}{dr}dr$。这得到 $dU = 3r^2 dr$ 和 $V = g(r) - 1$。\n$$\n\\int_0^\\infty r^3 \\frac{dg(r)}{dr} dr = \\left[ r^3 (g(r)-1) \\right]_0^\\infty - \\int_0^\\infty (g(r)-1) 3r^2 dr\n$$\n边界项 $[r^3 (g(r)-1)]_0^\\infty$ 为零，因为在 $r=0$ 时 $r^3=0$，且当 $r \\to \\infty$ 时 $r^3 \\exp(-\\alpha r)$ 项趋近于零。因此，积分变为：\n$$\n\\int_0^\\infty r^3 \\frac{dg(r)}{dr} dr = -3 \\int_0^\\infty r^2 (g(r)-1) dr = -3a \\int_0^\\infty r^2 \\exp(-\\alpha r)\\,\\sin(\\beta r) dr\n$$\n我们定义积分 $J = \\int_0^\\infty r^2 \\exp(-\\alpha r)\\,\\sin(\\beta r) dr$。这可以通过将其视为一个复积分的虚部来求解：\n$$\nJ = \\mathrm{Im} \\left[ \\int_0^\\infty r^2 \\exp(-(\\alpha-i\\beta)r) dr \\right]\n$$\n该积分是 $r^2$ 在 $s = \\alpha-i\\beta$ 处的拉普拉斯变换，其值为 $\\frac{2}{s^3}$。\n$$\nJ = \\mathrm{Im} \\left[ \\frac{2}{(\\alpha-i\\beta)^3} \\right] = \\mathrm{Im} \\left[ \\frac{2(\\alpha+i\\beta)^3}{(\\alpha^2+\\beta^2)^3} \\right]\n$$\n分子展开为 $2(\\alpha^3 + 3i\\alpha^2\\beta - 3\\alpha\\beta^2 - i\\beta^3) = 2(\\alpha^3 - 3\\alpha\\beta^2) + i(6\\alpha^2\\beta - 2\\beta^3)$。\n虚部是：\n$$\nJ = \\frac{6\\alpha^2\\beta - 2\\beta^3}{(\\alpha^2+\\beta^2)^3} = \\frac{2\\beta(3\\alpha^2 - \\beta^2)}{(\\alpha^2 + \\beta^2)^3}\n$$\n代入给定值 $\\alpha = 20\\,\\mathrm{nm}^{-1}$ 和 $\\beta = 10\\,\\mathrm{nm}^{-1}$：\n$$\nJ = \\frac{2(10)(3(20^2) - 10^2)}{((20^2) + (10^2))^3} = \\frac{20(3 \\times 400 - 100)}{(400 + 100)^3} = \\frac{20(1100)}{(500)^3} = \\frac{22000}{125 \\times 10^6}\\,\\mathrm{nm}^3 = 1.76 \\times 10^{-4}\\,\\mathrm{nm}^3\n$$\n压力表达式可以重写为：\n$$\nP_{\\mathrm{CG}} = \\rho k_B T + \\frac{2\\pi\\rho^2 k_B T}{3} (-3aJ) = \\rho k_B T (1 - 2\\pi \\rho a J)\n$$\n项 $2\\pi \\rho a J$ 是无量纲的。我们使用 $\\rho=5.0\\,\\mathrm{nm}^{-3}$，$a=0.20$ 和 $J=1.76 \\times 10^{-4}\\,\\mathrm{nm}^3$。\n$$\n2\\pi \\rho a J = 2\\pi (5.0) (0.20) (1.76 \\times 10^{-4}) = 2\\pi (1.76 \\times 10^{-4}) \\approx 0.00110584\n$$\n现在我们以 MPa 为单位计算理想气体压力贡献项 $\\rho k_B T$。\n$k_B = 1.380649 \\times 10^{-23}\\,\\mathrm{J/K}$。\n$$\n\\rho k_B T = (5.0\\,\\mathrm{nm}^{-3}) (1.380649 \\times 10^{-23}\\,\\mathrm{J/K}) (300\\,\\mathrm{K})\n$$\n$$\n\\rho k_B T = (5.0 \\times 10^{27}\\,\\mathrm{m}^{-3}) (4.141947 \\times 10^{-21}\\,\\mathrm{J}) = 20.709735 \\times 10^6\\,\\mathrm{J/m}^3\n$$\n由于 $1\\,\\mathrm{J/m}^3 = 1\\,\\mathrm{Pa}$，我们有 $\\rho k_B T \\approx 20.710\\,\\mathrm{MPa}$。\n最后，我们计算 $P_{\\mathrm{CG}}$：\n$$\nP_{\\mathrm{CG}} = (20.709735\\,\\mathrm{MPa}) \\times (1 - 0.00110584) = (20.709735\\,\\mathrm{MPa}) \\times (0.99889416) \\approx 20.6868\\,\\mathrm{MPa}\n$$\n四舍五入到四位有效数字，我们得到 $P_{\\mathrm{CG}} = 20.69\\,\\mathrm{MPa}$。\n\n第2部分：IBI压力修正\n\n计算出的粗粒化压力为 $P_{\\mathrm{CG}} \\approx 20.69\\,\\mathrm{MPa}$，而目标原子模拟压力为 $P_{\\mathrm{AT}} = 19.70\\,\\mathrm{MPa}$。粗粒化模型的压力高于目标压力 ($P_{\\mathrm{CG}} > P_{\\mathrm{AT}}$)。在标准IBI中，对势的迭代更新旨在再现目标结构(RDF)，但不一定能再现诸如压力之类的热力学性质。为了修正这一差异，通常会将压力修正与IBI结合应用。\n\n目标是在势 $u(r)$ 上添加一个修正项 $\\Delta u(r)$，该修正项能够修改压力而不会显著改变RDF。RDF主要对短程力（势的局域导数）敏感。而压力通过维里，对 $r F(r) = -r \\frac{du}{dr}$ 在系统体积上的积分敏感。因此，使用**缓变**的修正势，因为它引起的力微小且近似恒定，对液体结构影响甚微，但能对压力维里产生显著的累积效应。\n\n由修正 $\\Delta u(r)$ 引起的压力变化近似为：\n$$\n\\Delta P = P_{\\mathrm{new}} - P_{\\mathrm{old}} \\approx -\\frac{2\\pi\\rho^2}{3} \\int_0^\\infty r^3 \\frac{d(\\Delta u(r))}{dr} g(r) dr\n$$\n我们需要降低压力，因此要求 $\\Delta P < 0$。这意味着积分项必须为正：$\\int r^3 \\frac{d(\\Delta u)}{dr} g(r) dr > 0$。由于 $r^3$ 和 $g(r)$ 均为正，这要求 $\\frac{d(\\Delta u)}{dr}$ 平均为正。\n\n正的导数 $\\frac{d(\\Delta u)}{dr}$ 对应于一个排斥势（即随着 $r$ 减小，势变得更具排斥性/更少吸引性），以及一个**吸引力**修正 $F_{\\mathrm{corr}} = -\\frac{d(\\Delta u)}{dr} < 0$。从物理上讲，吸引力将粒子拉得更近，减小了对容器壁的向外推力，从而降低了压力。\n\n因此，要将压力从 $P_{\\mathrm{CG}}$ 降低到 $P_{\\mathrm{AT}}$，必须添加一个缓变的**吸引**势修正。该修正的符号是吸引性的；例如，这可以是一个在其影响范围内主要为负的势项 $\\Delta u(r)$。一个常见的选择是线性斜坡势，它为相互作用增加一个长程吸引尾。",
            "answer": "$$\n\\boxed{20.69}\n$$"
        }
    ]
}