{
    "hands_on_practices": [
        {
            "introduction": "To truly master the Nudged Elastic Band (NEB) method, it is essential to first understand how the force acting on each image is constructed. This exercise provides a foundational, step-by-step calculation that deconstructs the total NEB force into its two orthogonal components: the potential force acting perpendicular to the path and the spring force acting parallel to it. By working through this problem, you will gain a concrete feel for how these competing forces guide the chain of images toward a minimum energy path. ",
            "id": "3849267",
            "problem": "Consider a discrete path of images used in the Nudged Elastic Band (NEB) method for finding a minimum-energy pathway in a two-dimensional configuration space. You are given three consecutive images with positions $\\mathbf{R}_{i-1} = (1.0,\\,0.0)$, $\\mathbf{R}_{i} = (2.0,\\,1.0)$, and $\\mathbf{R}_{i+1} = (3.5,\\,1.5)$, where all coordinates are in Ångström units. The path tangent at image $i$ is prescribed as the unit vector $\\hat{\\tau}_{i} = \\left(\\frac{1}{\\sqrt{2}},\\,\\frac{1}{\\sqrt{2}}\\right)$. The potential energy gradient at $\\mathbf{R}_{i}$ is $\\nabla V(\\mathbf{R}_{i}) = (4,\\,-2)$ in electronvolt per Ångström. The physical force is $\\mathbf{F}_{i}^{\\text{true}} = -\\nabla V(\\mathbf{R}_{i})$. The NEB spring constant is $k = 0.5$ in electronvolt per Ångström squared. The image is updated by a steepest-descent move using the NEB force with step size $\\eta = \\frac{1}{20}$ in Ångström squared per electronvolt.\n\nStarting from the following fundamental bases:\n- The physical force is given by $\\mathbf{F} = -\\nabla V$.\n- The parallel component of a vector $\\mathbf{a}$ along a unit direction $\\hat{\\mathbf{u}}$ is $(\\mathbf{a}\\cdot\\hat{\\mathbf{u}})\\,\\hat{\\mathbf{u}}$, and the perpendicular component is $\\mathbf{a} - (\\mathbf{a}\\cdot\\hat{\\mathbf{u}})\\,\\hat{\\mathbf{u}}$.\n- A steepest-descent update for position uses $\\mathbf{R}^{\\text{new}} = \\mathbf{R}^{\\text{old}} + \\eta\\,\\mathbf{F}^{\\text{eff}}$ for an effective force $\\mathbf{F}^{\\text{eff}}$.\n\nCompute the perpendicular and parallel components of $\\mathbf{F}_{i}^{\\text{true}}$ with respect to $\\hat{\\tau}_{i}$. Then, using the difference of neighbor separations along the path computed from the given positions, construct the parallel spring contribution along $\\hat{\\tau}_{i}$ and form the NEB effective force by combining the physical perpendicular component and the parallel spring term. Finally, determine the magnitude of the single-step displacement $\\|\\Delta \\mathbf{R}_{i}\\| = \\|\\eta\\,\\mathbf{F}_{i}^{\\text{NEB}}\\|$ produced by this NEB update.\n\nProvide your final answer as an exact closed-form analytical expression. Express the displacement magnitude in Ångström. Do not round; an exact expression is required. The final answer must be a single expression.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and all necessary information is provided.\n\n**Problem Validation**\n\nGivens extracted from the problem statement:\n- Positions of three consecutive images: $\\mathbf{R}_{i-1} = (1.0,\\,0.0)$, $\\mathbf{R}_{i} = (2.0,\\,1.0)$, and $\\mathbf{R}_{i+1} = (3.5,\\,1.5)$. All coordinates are in units of Ångström (Å).\n- Prescribed path tangent at image $i$: $\\hat{\\tau}_{i} = \\left(\\frac{1}{\\sqrt{2}},\\,\\frac{1}{\\sqrt{2}}\\right)$.\n- Potential energy gradient at $\\mathbf{R}_{i}$: $\\nabla V(\\mathbf{R}_{i}) = (4,\\,-2)$ in units of electronvolt per Ångström (eV/Å).\n- Definition of the true physical force: $\\mathbf{F}_{i}^{\\text{true}} = -\\nabla V(\\mathbf{R}_{i})$.\n- NEB spring constant: $k = 0.5$ eV/Å$^2$.\n- Steepest-descent step size: $\\eta = \\frac{1}{20}$ Å$^2$/eV.\n- Update rule: $\\mathbf{R}^{\\text{new}} = \\mathbf{R}^{\\text{old}} + \\eta\\,\\mathbf{F}^{\\text{eff}}$.\n- Definitions for vector components: Parallel component of $\\mathbf{a}$ along $\\hat{\\mathbf{u}}$ is $(\\mathbf{a}\\cdot\\hat{\\mathbf{u}})\\,\\hat{\\mathbf{u}}$, and the perpendicular component is $\\mathbf{a} - (\\mathbf{a}\\cdot\\hat{\\mathbf{u}})\\,\\hat{\\mathbf{u}}$.\n\nThe problem is scientifically sound, as it is based on the well-established Nudged Elastic Band (NEB) method used in computational science. All parameters are explicitly defined, the units are consistent, and the objectives are clear. The use of a prescribed tangent vector is a valid simplification for an exercise of this nature and does not create a contradiction. Therefore, the problem is deemed valid and a solution can be derived.\n\n**Solution Derivation**\n\nThe solution proceeds by following the steps requested in the problem statement.\n\nFirst, we determine the true physical force $\\mathbf{F}_{i}^{\\text{true}}$ acting on image $i$ using the given potential energy gradient:\n$$\n\\mathbf{F}_{i}^{\\text{true}} = -\\nabla V(\\mathbf{R}_{i}) = -(4,\\,-2) = (-4,\\,2) \\quad \\text{eV/Å}\n$$\n\nNext, we decompose this force into components parallel and perpendicular to the prescribed path tangent $\\hat{\\tau}_{i} = \\left(\\frac{1}{\\sqrt{2}},\\,\\frac{1}{\\sqrt{2}}\\right)$. The parallel component is found by projecting $\\mathbf{F}_{i}^{\\text{true}}$ onto $\\hat{\\tau}_{i}$:\n$$\n\\mathbf{F}_{i}^{\\text{true},\\parallel} = (\\mathbf{F}_{i}^{\\text{true}} \\cdot \\hat{\\tau}_{i}) \\hat{\\tau}_{i}\n$$\nThe scalar projection is:\n$$\n\\mathbf{F}_{i}^{\\text{true}} \\cdot \\hat{\\tau}_{i} = (-4,\\,2) \\cdot \\left(\\frac{1}{\\sqrt{2}},\\,\\frac{1}{\\sqrt{2}}\\right) = -4\\left(\\frac{1}{\\sqrt{2}}\\right) + 2\\left(\\frac{1}{\\sqrt{2}}\\right) = -\\frac{2}{\\sqrt{2}} = -\\sqrt{2} \\quad \\text{eV/Å}\n$$\nThe perpendicular component of the true force, $\\mathbf{F}_{i}^{\\perp}$, is the part of the true force that is orthogonal to the path tangent. This component is used in the NEB force to guide the path towards the minimum energy path without causing the images to slide along the path.\n$$\n\\mathbf{F}_{i}^{\\perp} = \\mathbf{F}_{i}^{\\text{true}} - \\mathbf{F}_{i}^{\\text{true},\\parallel} = \\mathbf{F}_{i}^{\\text{true}} - (\\mathbf{F}_{i}^{\\text{true}} \\cdot \\hat{\\tau}_{i}) \\hat{\\tau}_{i}\n$$\nSubstituting the values:\n$$\n\\mathbf{F}_{i}^{\\perp} = (-4,\\,2) - (-\\sqrt{2})\\left(\\frac{1}{\\sqrt{2}},\\,\\frac{1}{\\sqrt{2}}\\right) = (-4,\\,2) - (-1,\\,-1) = (-3,\\,3) \\quad \\text{eV/Å}\n$$\n\nThe second part of the NEB force is the spring force, which acts to maintain equal spacing between the images along the path. The spring force acts parallel to the path tangent.\n$$\n\\mathbf{F}_{i}^{\\text{spring},\\parallel} = k (\\|\\mathbf{R}_{i+1} - \\mathbf{R}_{i}\\| - \\|\\mathbf{R}_{i} - \\mathbf{R}_{i-1}\\|) \\hat{\\tau}_{i}\n$$\nWe need to calculate the lengths of the path segments adjacent to image $i$:\n$$\n\\mathbf{R}_{i} - \\mathbf{R}_{i-1} = (2.0 - 1.0,\\,1.0 - 0.0) = (1,\\,1) \\quad \\text{Å}\n$$\n$$\n\\|\\mathbf{R}_{i} - \\mathbf{R}_{i-1}\\| = \\sqrt{1^2 + 1^2} = \\sqrt{2} \\quad \\text{Å}\n$$\n$$\n\\mathbf{R}_{i+1} - \\mathbf{R}_{i} = (3.5 - 2.0,\\,1.5 - 1.0) = (1.5,\\,0.5) = \\left(\\frac{3}{2},\\,\\frac{1}{2}\\right) \\quad \\text{Å}\n$$\n$$\n\\|\\mathbf{R}_{i+1} - \\mathbf{R}_{i}\\| = \\sqrt{\\left(\\frac{3}{2}\\right)^2 + \\left(\\frac{1}{2}\\right)^2} = \\sqrt{\\frac{9}{4} + \\frac{1}{4}} = \\sqrt{\\frac{10}{4}} = \\sqrt{\\frac{5}{2}} \\quad \\text{Å}\n$$\nWith the spring constant $k = 0.5 = \\frac{1}{2}$ eV/Å$^2$, the spring force is:\n$$\n\\mathbf{F}_{i}^{\\text{spring},\\parallel} = \\frac{1}{2} \\left(\\sqrt{\\frac{5}{2}} - \\sqrt{2}\\right) \\hat{\\tau}_{i}\n$$\n\nThe total NEB force, $\\mathbf{F}_{i}^{\\text{NEB}}$, is the sum of the perpendicular component of the true force and the parallel component of the spring force:\n$$\n\\mathbf{F}_{i}^{\\text{NEB}} = \\mathbf{F}_{i}^{\\perp} + \\mathbf{F}_{i}^{\\text{spring},\\parallel}\n$$\nSince $\\mathbf{F}_{i}^{\\perp}$ is orthogonal to $\\hat{\\tau}_{i}$ and $\\mathbf{F}_{i}^{\\text{spring},\\parallel}$ is parallel to $\\hat{\\tau}_{i}$, these two vectors are orthogonal to each other. Therefore, the squared magnitude of the total NEB force is the sum of their squared magnitudes:\n$$\n\\|\\mathbf{F}_{i}^{\\text{NEB}}\\|^2 = \\|\\mathbf{F}_{i}^{\\perp}\\|^2 + \\|\\mathbf{F}_{i}^{\\text{spring},\\parallel}\\|^2\n$$\nLet's calculate the squared magnitudes:\n$$\n\\|\\mathbf{F}_{i}^{\\perp}\\|^2 =\\|(-3,\\,3)\\|^2 = (-3)^2 + 3^2 = 9 + 9 = 18\n$$\n$$\n\\|\\mathbf{F}_{i}^{\\text{spring},\\parallel}\\|^2 = \\left\\| \\frac{1}{2} \\left(\\sqrt{\\frac{5}{2}} - \\sqrt{2}\\right) \\hat{\\tau}_{i} \\right\\|^2 = \\left( \\frac{1}{2} \\left(\\sqrt{\\frac{5}{2}} - \\sqrt{2}\\right) \\right)^2 \\|\\hat{\\tau}_{i}\\|^2\n$$\nSince $\\hat{\\tau}_{i}$ is a unit vector, $\\|\\hat{\\tau}_{i}\\|^2 = 1$.\n$$\n\\|\\mathbf{F}_{i}^{\\text{spring},\\parallel}\\|^2 = \\frac{1}{4} \\left(\\sqrt{\\frac{5}{2}} - \\sqrt{2}\\right)^2 = \\frac{1}{4} \\left( \\frac{5}{2} - 2\\sqrt{\\frac{5}{2}}\\sqrt{2} + 2 \\right) = \\frac{1}{4} \\left( \\frac{9}{2} - 2\\sqrt{5} \\right) = \\frac{9}{8} - \\frac{\\sqrt{5}}{2} = \\frac{9 - 4\\sqrt{5}}{8}\n$$\nNow, summing the squared magnitudes:\n$$\n\\|\\mathbf{F}_{i}^{\\text{NEB}}\\|^2 = 18 + \\frac{9 - 4\\sqrt{5}}{8} = \\frac{144}{8} + \\frac{9 - 4\\sqrt{5}}{8} = \\frac{153 - 4\\sqrt{5}}{8}\n$$\n\nFinally, we compute the magnitude of the single-step displacement, $\\|\\Delta \\mathbf{R}_{i}\\|$, using the steepest-descent update rule with step size $\\eta = \\frac{1}{20}$:\n$$\n\\|\\Delta \\mathbf{R}_{i}\\| = \\|\\eta\\,\\mathbf{F}_{i}^{\\text{NEB}}\\| = \\eta \\|\\mathbf{F}_{i}^{\\text{NEB}}\\| = \\frac{1}{20} \\sqrt{\\frac{153 - 4\\sqrt{5}}{8}}\n$$\nTo present this as a single fraction, we simplify the expression:\n$$\n\\|\\Delta \\mathbf{R}_{i}\\| = \\frac{1}{20} \\frac{\\sqrt{153 - 4\\sqrt{5}}}{\\sqrt{8}} = \\frac{\\sqrt{153 - 4\\sqrt{5}}}{20 \\cdot 2\\sqrt{2}} = \\frac{\\sqrt{153 - 4\\sqrt{5}}}{40\\sqrt{2}}\n$$\nRationalizing the denominator:\n$$\n\\|\\Delta \\mathbf{R}_{i}\\| = \\frac{\\sqrt{153 - 4\\sqrt{5}} \\cdot \\sqrt{2}}{40\\sqrt{2} \\cdot \\sqrt{2}} = \\frac{\\sqrt{2(153 - 4\\sqrt{5})}}{40 \\cdot 2} = \\frac{\\sqrt{306 - 8\\sqrt{5}}}{80}\n$$\nThis is the final exact analytical expression for the magnitude of the displacement in Ångströms.",
            "answer": "$$\\boxed{\\frac{\\sqrt{306 - 8\\sqrt{5}}}{80}}$$"
        },
        {
            "introduction": "The accuracy of an NEB calculation is fundamentally limited by how well the discrete set of images represents the true, continuous minimum energy path. This practice uses a simple one-dimensional model to illuminate a common pitfall: uneven image spacing can cause the highest-energy image to misrepresent the true location and energy of the saddle point. You will investigate this discretization bias and then implement a targeted image insertion scheme, a powerful technique for refining the path and systematically improving the accuracy of the calculated energy barrier. ",
            "id": "2818689",
            "problem": "Design and implement a program that quantitatively analyzes discretization bias in the Nudged Elastic Band (NEB) method, arising from uneven image spacing along a one-dimensional minimum-energy path. The analysis must start from a well-defined potential energy surface and proceed from first principles of calculus.\n\nConsider the one-dimensional potential energy function given by\n$$\nV(x) = \\frac{1}{4}\\left(x^2 - 1\\right)^2,\n$$\nwhich has minima at $x=-1$ and $x=1$ and a single transition-state (saddle) at the origin. The minimum-energy path connecting the minima is the line in configuration space parameterized by $x$ itself. The true barrier location and energy for this path are at $x^\\ddagger = 0$ with $V^\\ddagger = V(0)$.\n\nIn the NEB picture, a path is discretized into a sequence of images (points) $x_0, x_1, \\dots, x_{N-1}$ connecting the endpoints $x_0=-1$ and $x_{N-1}=1$. The highest-energy image $x_k$ is used as an estimator of the saddle location and barrier energy. When images are unevenly spaced, $x_k$ can be biased away from $x^\\ddagger$, yielding a biased barrier energy. Near the saddle, a smooth potential admits a Taylor expansion\n$$\nV(x) \\approx V^\\ddagger - \\frac{|\\kappa|}{2}\\,\\delta^2 + \\mathcal{O}(\\delta^4),\n$$\nwhere $\\delta = x - x^\\ddagger$ and $|\\kappa|$ is the magnitude of the negative curvature at the saddle. Thus, the absolute energy bias at the discrete maximum scales quadratically with the distance of the nearest image to the saddle. By inserting additional images near the current maximum, one can reduce $\\delta$ and thereby reduce the energy bias.\n\nYour tasks are:\n- Generate initial image sets of size $N$ (including endpoints) on the path using a monotone mapping $s \\mapsto x$ defined by\n$$\nx_i = -1 + 2\\, s_i^p,\\quad s_i = \\frac{i}{N-1},\\quad i\\in\\{0,1,\\dots,N-1\\},\n$$\nwith exponent $p \\geq 1$ controlling the degree of uneven spacing. The choice $p=1$ yields uniform spacing, and $p>1$ clusters images toward the left minimum. This parameterization is a purely mathematical device to emulate the effect of uneven tangential spring distributions in NEB without invoking spring forces explicitly.\n- For each image set, compute the index $k$ of the highest-energy image, the corresponding coordinate $x_k$, and its energy $V(x_k)$. Using $x^\\ddagger=0$ and $V^\\ddagger=V(0)$ as the exact saddle location and barrier energy, compute the absolute energy error\n$$\n\\Delta E_{\\text{before}} = \\left|V(x_k) - V^\\ddagger\\right|\n$$\nand the location error\n$$\n\\Delta x_{\\text{before}} = \\left|x_k - x^\\ddagger\\right|.\n$$\n- Emulate targeted NEB image insertion near the discrete maximum by inserting $m$ new images in the immediate neighborhood of $x_k$ as follows: divide each of the two adjacent intervals $\\left[x_{k-1},x_k\\right]$ and $\\left[x_k,x_{k+1}\\right]$ into equal subintervals and insert equally spaced interior points so that a total of $m$ new images are added, with $\\lceil m/2 \\rceil$ on the left interval and $m - \\lceil m/2 \\rceil$ on the right interval. Keep the endpoints at $x=-1$ and $x=1$ fixed. Recompute the highest-energy image after insertion to obtain $\\Delta E_{\\text{after}}$ and $\\Delta x_{\\text{after}}$ defined analogously.\n- Report the quantitative effect of insertion by outputting, for each test case, the quadruple of floats $[\\Delta E_{\\text{before}}, \\Delta E_{\\text{after}}, \\Delta x_{\\text{before}}, \\Delta x_{\\text{after}}]$, rounded to $10$ decimal places.\n\nTest suite:\n- Case A (uneven spacing, moderate resolution): $N=9$, $p=3$, $m=2$.\n- Case B (uniform spacing, high resolution): $N=33$, $p=1$, $m=2$.\n- Case C (highly uneven spacing, very coarse): $N=5$, $p=5$, $m=2$.\n- Case D (uniform spacing with an image exactly at the saddle): $N=11$, $p=1$, $m=2$.\n\nScientific realism requirements:\n- All computations are to be performed on the exact analytic $V(x)$ provided. Treat energy as dimensionless and positions as dimensionless.\n- Angles are not used in this problem.\n- The algorithmic insertion rule must respect adjacency: images may only be inserted within $\\left[x_{k-1},x_k\\right]$ and $\\left[x_k,x_{k+1}\\right]$.\n\nFinal output format:\n- Your program should produce a single line of output containing all test results as a comma-separated list enclosed in square brackets. Concatenate the four rounded numbers for Case A, then Case B, then Case C, then Case D, in that order. That is, the output is a flat list with $16$ floats: \n$[\\Delta E_{\\text{before}}^{(A)},\\Delta E_{\\text{after}}^{(A)},\\Delta x_{\\text{before}}^{(A)},\\Delta x_{\\text{after}}^{(A)},\\dots,\\Delta E_{\\text{before}}^{(D)},\\Delta E_{\\text{after}}^{(D)},\\Delta x_{\\text{before}}^{(D)},\\Delta x_{\\text{after}}^{(D)}]$.",
            "solution": "We proceed from first principles of calculus applied to the discretized minimum-energy path. The Nudged Elastic Band (NEB) method represents a continuous path in configuration space by a finite set of images $x_0,\\dots,x_{N-1}$, with $x_0$ and $x_{N-1}$ fixed at the reactant and product minima. The highest-energy image is used as a discrete proxy for the saddle point. When the images are unevenly distributed, the nearest image to the true saddle $x^\\ddagger$ may lie at a finite offset $\\delta = x_k - x^\\ddagger$, producing biased estimates of both the saddle location and barrier energy.\n\nFundamental base: For a smooth potential energy surface $V(x)$ with a nondegenerate saddle at $x^\\ddagger$, a Taylor expansion in the neighborhood of $x^\\ddagger$ yields\n$$\nV(x^\\ddagger + \\delta) = V^\\ddagger + \\frac{1}{2} V''(x^\\ddagger)\\,\\delta^2 + \\mathcal{O}(\\delta^3),\n$$\nwith $V'(x^\\ddagger)=0$ by stationarity and $V''(x^\\ddagger)<0$ by the definition of a first-order saddle. For the specific potential\n$$\nV(x) = \\frac{1}{4}(x^2-1)^2 = \\frac{1}{4} - \\frac{1}{2}x^2 + \\frac{1}{4}x^4,\n$$\nwe have $x^\\ddagger=0$ by symmetry, $V^\\ddagger = V(0) = \\frac{1}{4}$, and $V''(0) = -1$. Therefore,\n$$\nV(\\delta) = \\frac{1}{4} - \\frac{1}{2}\\delta^2 + \\frac{1}{4}\\delta^4,\n$$\nand the absolute energy bias at the discrete maximum located a distance $\\delta$ from the saddle is\n$$\n\\Delta E = \\left|V(\\delta) - V^\\ddagger\\right| = \\frac{1}{2}\\delta^2 - \\frac{1}{4}\\delta^4.\n$$\nFor sufficiently small $\\delta$, the leading behavior is quadratic,\n$$\n\\Delta E \\approx \\frac{1}{2}\\delta^2,\n$$\nwhich formalizes the intuition that discretization bias in the barrier energy decays with the square of the proximity of an image to the saddle.\n\nAlgorithmic design: To emulate uneven NEB spacing without introducing tangential spring forces explicitly, we parameterize initial images by $x_i = -1 + 2\\,(\\frac{i}{N-1})^p$. This concentrates images near the left minimum for $p>1$. We compute the index $k$ of the highest-energy image by maximizing $V(x_i)$. The corresponding absolute errors are\n$$\n\\Delta x_{\\text{before}} = |x_k - x^\\ddagger|, \\quad \\Delta E_{\\text{before}} = |V(x_k) - V^\\ddagger|.\n$$\nTo reduce the bias, we carry out targeted insertion of $m$ images in the immediate vicinity of $x_k$ by subdividing the adjacent intervals $[x_{k-1},x_k]$ and $[x_k,x_{k+1}]$. Specifically, we place $\\lceil m/2 \\rceil$ equally spaced interior points in $[x_{k-1},x_k]$ and $m - \\lceil m/2 \\rceil$ in $[x_k,x_{k+1}]$. This halves or better the local mesh size near the discrete maximum and reduces $\\Delta x$ accordingly. Because $\\Delta E$ is asymptotically quadratic in $\\Delta x$, one expects an approximate reduction factor near $4$ in the energy bias under ideal symmetric refinement near the saddle.\n\nWe apply this to the test suite:\n- Case A: $N=9$, $p=3$, $m=2$. The initial images cluster near $x=-1$, leaving a large gap spanning the saddle. The discrete maximum lies at some $x_k<0$ with $\\Delta x_{\\text{before}}>0$. Inserting $m=2$ images places one on each neighboring interval, moving the nearest image closer to $x^\\ddagger=0$ and reducing both $\\Delta x$ and $\\Delta E$ markedly, consistent with the quadratic scaling.\n- Case B: $N=33$, $p=1$, $m=2$. Uniform spacing with odd $N$ places an image exactly at $x=0$, so $\\Delta x_{\\text{before}}=0$ and $\\Delta E_{\\text{before}}=0$. Insertion leaves the maximum at $x^\\ddagger$, so the errors remain zero.\n- Case C: $N=5$, $p=5$, $m=2$. Extremely uneven coarse spacing leaves the nearest image at a large $|\\delta|$, producing a large $\\Delta E_{\\text{before}}$. Inserting two images substantially reduces $\\Delta x$ and therefore $\\Delta E$ by more than a factor of order $4$, though the exact factor depends on the asymmetry of the adjacent intervals.\n- Case D: $N=11$, $p=1$, $m=2$. As in Case B, an image lies exactly at $x^\\ddagger$, giving zero errors before and after.\n\nImplementation details:\n- Compute $V^\\ddagger = V(0)$ and $x^\\ddagger=0$ directly from the analytic $V(x)$ and its symmetry.\n- Identify the highest-energy image by direct evaluation of $V(x_i)$.\n- Perform insertion by placing equally spaced interior points on each adjacent interval, preserving endpoints $x=-1$ and $x=1$.\n- Recompute the maximum and errors after insertion.\n- Output, for each test case in order A, B, C, D, the quadruple $[\\Delta E_{\\text{before}}, \\Delta E_{\\text{after}}, \\Delta x_{\\text{before}}, \\Delta x_{\\text{after}}]$, rounded to $10$ decimal places, concatenated into a flat list.\n\nThis design directly connects the mathematical expansion of $V(x)$ near the saddle with a concrete algorithmic remedy (local insertion) and demonstrates, through the provided test cases, how reducing the local discretization length near the maximum corrects the bias in both location and barrier energy estimates.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef potential(x):\n    # V(x) = 1/4 (x^2 - 1)^2\n    return 0.25 * (x**2 - 1.0)**2\n\ndef generate_images(N, p):\n    # Generate N images including endpoints using x = -1 + 2*(s^p), s in [0,1]\n    s = np.linspace(0.0, 1.0, N, dtype=float)\n    x = -1.0 + 2.0 * (s ** p)\n    # Ensure sorted uniqueness (should already be sorted)\n    x = np.array(sorted(set(np.round(x, 16))))  # guard against fp duplicates\n    return x\n\ndef analyze_images(x, x_saddle=0.0):\n    E = potential(x)\n    k = int(np.argmax(E))\n    x_max = float(x[k])\n    E_max = float(E[k])\n    E_saddle = float(potential(x_saddle))\n    dE = abs(E_max - E_saddle)\n    dx = abs(x_max - x_saddle)\n    return dE, dx, k\n\ndef insert_near_max(x, k, m):\n    # Insert m new images near index k: distribute ceil(m/2) on left interval [x[k-1], x[k]]\n    # and the rest on right interval [x[k], x[k+1]]. Endpoints remain fixed.\n    if m <= 0:\n        return np.array(x, dtype=float)\n    n = len(x)\n    # Safety: k should not be at endpoints for this potential; if it is, return unchanged\n    if k <= 0 or k >= n - 1:\n        return np.array(x, dtype=float)\n    left_count = int(np.ceil(m / 2.0))\n    right_count = int(m - left_count)\n    new_points = []\n\n    # Left interval subdivision: generate equally spaced interior points\n    xL, xK = x[k - 1], x[k]\n    if left_count > 0:\n        for j in range(1, left_count + 1):\n            frac = j / (left_count + 1)\n            new_points.append(xL + frac * (xK - xL))\n\n    # Right interval subdivision\n    xK, xR = x[k], x[k + 1]\n    if right_count > 0:\n        for j in range(1, right_count + 1):\n            frac = j / (right_count + 1)\n            new_points.append(xK + frac * (xR - xK))\n\n    x_aug = np.concatenate([x, np.array(new_points, dtype=float)])\n    x_aug.sort()\n    # Deduplicate with tolerance\n    x_unique = []\n    for xi in x_aug:\n        if len(x_unique) == 0 or abs(xi - x_unique[-1]) > 1e-15:\n            x_unique.append(float(xi))\n    return np.array(x_unique, dtype=float)\n\ndef run_case(N, p, m):\n    x0 = generate_images(N, p)\n    dE_before, dx_before, k = analyze_images(x0, 0.0)\n    x1 = insert_near_max(x0, k, m)\n    dE_after, dx_after, _ = analyze_images(x1, 0.0)\n    return dE_before, dE_after, dx_before, dx_after\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (N, p, m)\n    test_cases = [\n        (9, 3.0, 2),   # Case A\n        (33, 1.0, 2),  # Case B\n        (5, 5.0, 2),   # Case C\n        (11, 1.0, 2),  # Case D\n    ]\n\n    results = []\n    for N, p, m in test_cases:\n        dE_before, dE_after, dx_before, dx_after = run_case(N, p, m)\n        # Round to 10 decimal places as specified\n        results.extend([\n            round(dE_before, 10),\n            round(dE_after, 10),\n            round(dx_before, 10),\n            round(dx_after, 10),\n        ])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "A successful Nudged Elastic Band calculation does not end when the forces on the images converge. The final, critical step is to verify that the identified highest-energy point is indeed a true first-order saddle point, which is the mathematical definition of a transition state. This exercise guides you through the process of numerically computing the Hessian matrix at a candidate saddle point, analyzing its eigenvalues to confirm the presence of a single unstable mode, and relating the direction of this mode to the path tangent. ",
            "id": "3789297",
            "problem": "You are given a dimensionless potential energy landscape in two spatial dimensions specified by functions $E(\\mathbf{x})$ with $\\mathbf{x} \\in \\mathbb{R}^2$, together with three discrete paths that pass through a candidate saddle image obtained via the Nudged Elastic Band (NEB) method. Your task is to numerically construct the full Hessian matrix at the central image of each path, classify the saddle by the single negative eigenvalue criterion, and quantify the orientation of the most unstable mode relative to the NEB path tangent.\n\nFoundational base to use:\n- The Hessian of a scalar field $E(\\mathbf{x})$ at $\\mathbf{x}^\\star$ is the matrix of second-order partial derivatives defined by $H_{ij}(\\mathbf{x}^\\star) = \\frac{\\partial^2 E}{\\partial x_i \\partial x_j}(\\mathbf{x}^\\star)$.\n- The eigenvalues $\\lambda_k$ and eigenvectors $\\mathbf{v}_k$ of a symmetric Hessian satisfy $H \\mathbf{v}_k = \\lambda_k \\mathbf{v}_k$ with orthonormal $\\{\\mathbf{v}_k\\}$.\n- A transition state in atomistic modeling is an index-$1$ saddle, meaning exactly one strictly negative eigenvalue of the Hessian.\n- The NEB path tangent at an image indexed by $m$ in a discrete path $\\{\\mathbf{x}_0,\\mathbf{x}_1,\\mathbf{x}_2\\}$ is approximated by the normalized difference $\\mathbf{t} = \\frac{\\mathbf{x}_{m+1} - \\mathbf{x}_{m-1}}{\\|\\mathbf{x}_{m+1} - \\mathbf{x}_{m-1}\\|}$.\n\nYou must implement a symmetric central finite difference approximation for partial derivatives with a uniform step size $h$ to evaluate the Hessian numerically. Use a negativity tolerance $\\tau$ to classify eigenvalues: count an eigenvalue $\\lambda$ as negative if $\\lambda < -\\tau$, positive if $\\lambda > \\tau$, and otherwise treat it as numerically zero. Report the angle between the most negative-eigenvalue eigenvector and the NEB tangent in radians, and report the signed parallel component and the perpendicular component norm of that eigenvector with respect to the tangent. The angle should be computed between directions (ignoring overall sign), i.e., use the absolute value of the dot product in the cosine, and express the angle in radians.\n\nTest suite:\n- Case $1$ (happy path): $E_1(x_1,x_2) = (x_1^2 - 1)^2 + 0.5\\,x_2^2$. Discrete path images are $\\mathbf{x}_0 = (-1,0)$, $\\mathbf{x}_1 = (0,0)$, and $\\mathbf{x}_2 = (1,0)$. Use $h = 10^{-4}$ and $\\tau = 10^{-8}$.\n- Case $2$ (non-transition-state maximum): $E_2(x_1,x_2) = -x_1^2 - x_2^2 + 0.1\\,(x_1^4 + x_2^4)$. Discrete path images are $\\mathbf{x}_0 = (-0.1,0)$, $\\mathbf{x}_1 = (0,0)$, and $\\mathbf{x}_2 = (0.1,0)$. Use $h = 10^{-4}$ and $\\tau = 10^{-8}$.\n- Case $3$ (near-degenerate flat direction): $E_3(x_1,x_2) = (x_1^2 - 1)^2 + \\epsilon\\,x_2^4$ with $\\epsilon = 10^{-6}$. Discrete path images are $\\mathbf{x}_0 = (-1,0)$, $\\mathbf{x}_1 = (0,0)$, and $\\mathbf{x}_2 = (1,0)$. Use $h = 10^{-4}$ and $\\tau = 10^{-8}$.\n\nFor each case, at the central image $\\mathbf{x}_1$, perform the following:\n- Numerically compute the full Hessian $H(\\mathbf{x}_1)$ using symmetric central finite differences with step size $h$.\n- Compute all eigenvalues and eigenvectors of $H(\\mathbf{x}_1)$.\n- Verify the single negative eigenvalue criterion using $\\tau$ and return a boolean indicating whether the criterion holds.\n- Compute the NEB tangent $\\mathbf{t}$ at $\\mathbf{x}_1$ from the given neighboring images and normalize it.\n- Select the eigenvector $\\mathbf{v}_{\\min}$ corresponding to the most negative eigenvalue (i.e., the smallest eigenvalue). Compute the angle $\\theta$ between directions spanned by $\\mathbf{v}_{\\min}$ and $\\mathbf{t}$ in radians, the signed parallel component $c_{\\parallel} = \\mathbf{v}_{\\min} \\cdot \\mathbf{t}$, and the perpendicular component norm $c_{\\perp} = \\|\\mathbf{v}_{\\min} - c_{\\parallel}\\,\\mathbf{t}\\|$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one case in order. Each case’s result must be a list structured as $[\\text{boolean}, \\theta, c_{\\parallel}, c_{\\perp}]$, where the angle $\\theta$ is in radians.\n- Example format: $[[\\text{True}, 0.123, 0.456, 0.789],[\\text{False}, 0.321, -0.654, 0.987],[\\text{True}, 0.000, 1.000, 0.000]]$.\n\nAll quantities are dimensionless; express angles in radians. No external input is required; hard-code the test suite in your program exactly as specified above.",
            "solution": "The problem requires an analysis of candidate saddle points on two-dimensional potential energy surfaces, obtained from a Nudged Elastic Band (NEB) calculation. For each of three given cases, we must characterize the stationary point at the central image, $\\mathbf{x}_1$, of a discrete path $\\{\\mathbf{x}_0, \\mathbf{x}_1, \\mathbf{x}_2\\}$. This characterization involves computing the Hessian matrix, analyzing its eigenvalues to determine if the point is an index-$1$ saddle (a transition state), and quantifying the alignment of the unstable mode with the reaction path tangent.\n\nThe procedure for each case is as follows:\n\n1.  **Numerical Computation of the Hessian Matrix**\n\nThe Hessian matrix, $H$, of a scalar potential energy function $E(\\mathbf{x})$ where $\\mathbf{x} = (x_1, x_2)$, is a $2 \\times 2$ matrix of second-order partial derivatives:\n$$\nH(\\mathbf{x}) = \\begin{pmatrix}\n\\frac{\\partial^2 E}{\\partial x_1^2} & \\frac{\\partial^2 E}{\\partial x_1 \\partial x_2} \\\\\n\\frac{\\partial^2 E}{\\partial x_2 \\partial x_1} & \\frac{\\partial^2 E}{\\partial x_2^2}\n\\end{pmatrix}\n$$\nSince potential energy functions are continuously differentiable, the Hessian is symmetric, i.e., $\\frac{\\partial^2 E}{\\partial x_1 \\partial x_2} = \\frac{\\partial^2 E}{\\partial x_2 \\partial x_1}$. We are tasked to compute this matrix at the central image $\\mathbf{x}_1 = (x_{1,1}, x_{2,1})$ using a symmetric central finite difference scheme with a step size $h$. The formulas for the components are:\n\n-   Diagonal elements:\n    $$\n    H_{11} = \\frac{\\partial^2 E}{\\partial x_1^2} \\approx \\frac{E(x_{1,1}+h, x_{2,1}) - 2E(x_{1,1}, x_{2,1}) + E(x_{1,1}-h, x_{2,1})}{h^2}\n    $$\n    $$\n    H_{22} = \\frac{\\partial^2 E}{\\partial x_2^2} \\approx \\frac{E(x_{1,1}, x_{2,1}+h) - 2E(x_{1,1}, x_{2,1}) + E(x_{1,1}, x_{2,1}-h)}{h^2}\n    $$\n-   Off-diagonal element:\n    $$\n    H_{12} = H_{21} = \\frac{\\partial^2 E}{\\partial x_1 \\partial x_2} \\approx \\frac{E(x_{1,1}+h, x_{2,1}+h) - E(x_{1,1}+h, x_{2,1}-h) - E(x_{1,1}-h, x_{2,1}+h) + E(x_{1,1}-h, x_{2,1}-h)}{4h^2}\n    $$\nThese approximations are applied to the specific energy function $E(x_1, x_2)$ for each test case at the point $\\mathbf{x}_1$.\n\n2.  **Eigenvalue Analysis and Saddle Point Classification**\n\nOnce the numerical Hessian matrix $H(\\mathbf{x}_1)$ is constructed, we solve the eigenvalue problem $H \\mathbf{v}_k = \\lambda_k \\mathbf{v}_k$ to find its eigenvalues $\\lambda_k$ and corresponding eigenvectors $\\mathbf{v}_k$. For a symmetric $2 \\times 2$ Hessian, we will obtain two real eigenvalues, $\\lambda_1$ and $\\lambda_2$.\n\nA transition state (or index-$1$ saddle point) is characterized by having exactly one negative eigenvalue. We use the provided negativity tolerance $\\tau$ to perform this classification. An eigenvalue $\\lambda$ is counted as negative if and only if $\\lambda < -\\tau$. We count the number of such negative eigenvalues. If this count is exactly one, the point $\\mathbf{x}_1$ is classified as a transition state.\n\n3.  **Unstable Mode and Path Tangent Analysis**\n\nIf the point is a saddle, the eigenvector corresponding to the single negative eigenvalue represents the direction of the \"unstable mode\"—the direction of lowest energy barrier leading away from the saddle point. We denote this eigenvector as $\\mathbf{v}_{\\min}$.\n\nThe NEB path tangent at the central image $\\mathbf{x}_1$ provides an approximation of the reaction path direction. It is calculated using the neighboring images $\\mathbf{x}_0$ and $\\mathbf{x}_2$:\n$$\n\\mathbf{t} = \\frac{\\mathbf{x}_2 - \\mathbf{x}_0}{\\|\\mathbf{x}_2 - \\mathbf{x}_0\\|}\n$$\nThe tangent vector $\\mathbf{t}$ is normalized to be a unit vector.\n\nFinally, we quantify the relationship between the unstable mode $\\mathbf{v}_{\\min}$ and the path tangent $\\mathbf{t}$. Both $\\mathbf{v}_{\\min}$ (as returned by standard eigensolvers) and $\\mathbf{t}$ are unit vectors.\n\n-   **Angle $\\theta$**: The angle between the directions of the two vectors is computed. To ensure the angle is between $0$ and $\\pi/2$ radians (i.e., we compare directions, not specific vectors which have arbitrary signs), we use the absolute value of the dot product:\n    $$\n    \\theta = \\arccos(|\\mathbf{v}_{\\min} \\cdot \\mathbf{t}|)\n    $$\n-   **Signed Parallel Component $c_{\\parallel}$**: This measures the projection of $\\mathbf{v}_{\\min}$ onto $\\mathbf{t}$. Since $\\mathbf{t}$ is a unit vector, this is simply the dot product:\n    $$\n    c_{\\parallel} = \\mathbf{v}_{\\min} \\cdot \\mathbf{t}\n    $$\n    The sign of $c_{\\parallel}$ depends on the arbitrary sign convention of the eigenvector returned by the numerical solver.\n-   **Perpendicular Component Norm $c_{\\perp}$**: This measures the magnitude of the component of $\\mathbf{v}_{\\min}$ that is orthogonal to the tangent $\\mathbf{t}$. It is calculated as the norm of the vector difference:\n    $$\n    c_{\\perp} = \\|\\mathbf{v}_{\\min} - c_{\\parallel} \\mathbf{t}\\|\n    $$\nBy applying this full procedure to each of the three test cases, we can verify the nature of the candidate saddle points and the quality of the NEB path alignment.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem by analyzing candidate saddle points for three test cases.\n    \"\"\"\n\n    def compute_hessian(E, x, h):\n        \"\"\"\n        Computes the Hessian matrix of a 2D scalar function E at point x\n        using symmetric central finite differences with step size h.\n        \"\"\"\n        x1, x2 = x\n        \n        # Second derivative with respect to x1\n        H11 = (E(x1 + h, x2) - 2 * E(x1, x2) + E(x1 - h, x2)) / (h**2)\n        \n        # Second derivative with respect to x2\n        H22 = (E(x1, x2 + h) - 2 * E(x1, x2) + E(x1, x2 - h)) / (h**2)\n        \n        # Mixed partial derivative\n        H12 = (E(x1 + h, x2 + h) - E(x1 + h, x2 - h) - E(x1 - h, x2 + h) + E(x1 - h, x2 - h)) / (4 * h**2)\n        \n        # Hessian is symmetric, H21 = H12\n        return np.array([[H11, H12], [H12, H22]])\n\n    def analyze_saddle(E, path, h, tau):\n        \"\"\"\n        Performs the full analysis for a given potential and path.\n        \"\"\"\n        x0, x1, x2 = path\n        \n        # 1. Compute the Hessian at the central image x1\n        H = compute_hessian(E, x1, h)\n        \n        # 2. Compute eigenvalues and eigenvectors.\n        # numpy.linalg.eigh is used for symmetric matrices. It returns eigenvalues\n        # in ascending order and corresponding eigenvectors as columns.\n        eigenvalues, eigenvectors = np.linalg.eigh(H)\n        \n        # 3. Verify the single negative eigenvalue criterion\n        num_negative_eigenvalues = np.sum(eigenvalues < -tau)\n        is_transition_state = (num_negative_eigenvalues == 1)\n        \n        # 4. Compute the NEB tangent at x1\n        tangent_raw = x2 - x0\n        tangent = tangent_raw / np.linalg.norm(tangent_raw)\n        \n        # 5. Select the eigenvector for the most negative eigenvalue\n        # This corresponds to the first eigenvalue/eigenvector from eigh.\n        v_min = eigenvectors[:, 0]\n        \n        # 6. Compute angle, parallel, and perpendicular components\n        # Angle between directions (using abs of dot product)\n        dot_product = np.dot(v_min, tangent)\n        \n        # Handle potential floating point inaccuracies for arccos\n        # Clamp the argument to the valid range [-1, 1]\n        angle_arg = np.clip(np.abs(dot_product), -1.0, 1.0)\n        theta = np.arccos(angle_arg)\n        \n        # Signed parallel component\n        c_parallel = dot_product\n        \n        # Perpendicular component norm\n        c_perpendicular = np.linalg.norm(v_min - c_parallel * tangent)\n        \n        return [is_transition_state, theta, c_parallel, c_perpendicular]\n\n    # Test suite parameters\n    h = 1e-4\n    tau = 1e-8\n    \n    test_cases = [\n        {\n            \"E\": lambda x1, x2: (x1**2 - 1)**2 + 0.5 * x2**2,\n            \"path\": (np.array([-1.0, 0.0]), np.array([0.0, 0.0]), np.array([1.0, 0.0])),\n        },\n        {\n            \"E\": lambda x1, x2: -x1**2 - x2**2 + 0.1 * (x1**4 + x2**4),\n            \"path\": (np.array([-0.1, 0.0]), np.array([0.0, 0.0]), np.array([0.1, 0.0])),\n        },\n        {\n            \"E\": lambda x1, x2: (x1**2 - 1)**2 + 1e-6 * x2**4,\n            \"path\": (np.array([-1.0, 0.0]), np.array([0.0, 0.0]), np.array([1.0, 0.0])),\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        result = analyze_saddle(case[\"E\"], case[\"path\"], h, tau)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # The str() of a list automatically includes brackets and commas.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}