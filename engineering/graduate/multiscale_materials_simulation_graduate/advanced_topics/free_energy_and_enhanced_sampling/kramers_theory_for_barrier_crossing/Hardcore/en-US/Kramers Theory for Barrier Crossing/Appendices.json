{
    "hands_on_practices": [
        {
            "introduction": "The starting point for any rate theory calculation is a thorough understanding of the potential energy surface ($U(x)$). The key features that govern reaction rates are the locations of stable states (wells), transition states (barriers), and the energy difference between them. This exercise will solidify your ability to extract the essential parameters—the barrier height $\\Delta U$ and the curvatures at the well and barrier—from a given potential, which are the fundamental inputs for the Kramers rate formulas. ",
            "id": "3819052",
            "problem": "In activated transport within Kramers theory for barrier crossing, the escape rate out of a metastable well depends on the local curvatures of the potential energy near the metastable minimum and the barrier top, and on the barrier height relative to thermal energy. Consider a one-dimensional coarse-grained potential energy landscape given by $U(x)=a x^{4}-b x^{2}$, with $a0$ and $b0$, which can arise as a local approximation of a potential of mean force in multiscale materials simulation. Starting from the definitions of stationary points and curvature in terms of the first and second derivatives of $U(x)$, do the following:\n\n1. Identify the stationary points and classify them to determine the unique barrier top $x_{b}$ and the metastable well location $x_{0}$ on the branch $x0$.\n2. Compute the second derivative $U''(x)$ and evaluate $U''(x_{0})$ and $U''(x_{b})$, interpreting their signs in terms of local stability.\n3. Determine the barrier height $\\Delta U=U(x_{b})-U(x_{0})$.\n4. Let $\\beta=1/\\left(k_{B} T\\right)$, where $k_{B}$ is the Boltzmann constant and $T$ is the absolute temperature. Form the dimensionless barrier height $\\beta \\Delta U$.\n\nExpress your final answer as a single closed-form analytic expression for $\\beta \\Delta U$ in terms of $a$, $b$, $k_{B}$, and $T$. Do not perform any numerical substitutions and do not round. The final answer must be dimensionless; do not include units in your final answer. Provide no additional outputs beyond the requested final expression.",
            "solution": "The problem requires finding the dimensionless barrier height $\\beta \\Delta U$ for a particle in a one-dimensional potential energy landscape given by $U(x) = a x^{4} - b x^{2}$, where $a0$ and $b0$. The solution is constructed by following the four specified steps.\n\nFirst, we define the potential energy function:\n$$U(x) = a x^{4} - b x^{2}$$\n\n1. Identify the stationary points and classify them to determine the unique barrier top $x_{b}$ and the metastable well location $x_{0}$ on the branch $x0$.\n\nThe stationary points of the potential $U(x)$ are the points where the first derivative, which corresponds to the force $F(x) = -U'(x)$, is zero. We compute the first derivative of $U(x)$:\n$$U'(x) = \\frac{d}{dx} \\left( a x^{4} - b x^{2} \\right) = 4ax^{3} - 2bx$$\nWe set the first derivative to zero to find the stationary points:\n$$U'(x) = 4ax^{3} - 2bx = 2x(2ax^{2} - b) = 0$$\nThe solutions for $x$ are:\n$$x = 0$$\nand\n$$2ax^{2} - b = 0 \\implies x^{2} = \\frac{b}{2a} \\implies x = \\pm\\sqrt{\\frac{b}{2a}}$$\nThe stationary points are located at $x=0$, $x=+\\sqrt{\\frac{b}{2a}}$, and $x=-\\sqrt{\\frac{b}{2a}}$. The problem specifies to consider the metastable well on the branch $x0$.\n\n2. Compute the second derivative $U''(x)$ and evaluate $U''(x_{0})$ and $U''(x_{b})$, interpreting their signs in terms of local stability.\n\nTo classify these stationary points, we use the second derivative test. The second derivative of $U(x)$ is:\n$$U''(x) = \\frac{d^{2}}{dx^{2}} \\left( a x^{4} - b x^{2} \\right) = \\frac{d}{dx} \\left( 4ax^{3} - 2bx \\right) = 12ax^{2} - 2b$$\nNow we evaluate $U''(x)$ at each stationary point:\nAt $x=0$:\n$$U''(0) = 12a(0)^{2} - 2b = -2b$$\nSince $b0$, $U''(0)  0$. A negative second derivative indicates that the potential is locally concave down, so $x=0$ is a local maximum. This point corresponds to the top of the potential barrier that separates the two wells. Therefore, the barrier top is at $x_{b}=0$.\n\nAt $x=+\\sqrt{\\frac{b}{2a}}$:\n$$U''\\left(\\sqrt{\\frac{b}{2a}}\\right) = 12a\\left(\\sqrt{\\frac{b}{2a}}\\right)^{2} - 2b = 12a\\left(\\frac{b}{2a}\\right) - 2b = 6b - 2b = 4b$$\nSince $b0$, $U''\\left(\\sqrt{\\frac{b}{2a}}\\right)  0$. A positive second derivative indicates that the potential is locally concave up, so this point is a local minimum. This corresponds to the location of the metastable well on the $x0$ branch. Therefore, the well location is $x_{0}=\\sqrt{\\frac{b}{2a}}$.\n\nThe positive curvature $U''(x_{0})=4b$ signifies that the point $x_0$ is a position of stable equilibrium (a well), while the negative curvature $U''(x_{b})=-2b$ signifies that the point $x_b$ is a position of unstable equilibrium (a barrier).\n\n3. Determine the barrier height $\\Delta U = U(x_{b}) - U(x_{0})$.\n\nThe barrier height is the difference in potential energy between the barrier top and the well minimum.\nFirst, we calculate the potential energy at the barrier top, $x_{b}=0$:\n$$U(x_{b}) = U(0) = a(0)^{4} - b(0)^{2} = 0$$\nNext, we calculate the potential energy at the well minimum, $x_{0}=\\sqrt{\\frac{b}{2a}}$:\n$$U(x_{0}) = U\\left(\\sqrt{\\frac{b}{2a}}\\right) = a\\left(\\sqrt{\\frac{b}{2a}}\\right)^{4} - b\\left(\\sqrt{\\frac{b}{2a}}\\right)^{2}$$\n$$U(x_{0}) = a\\left(\\frac{b^{2}}{4a^{2}}\\right) - b\\left(\\frac{b}{2a}\\right) = \\frac{b^{2}}{4a} - \\frac{2b^{2}}{4a} = -\\frac{b^{2}}{4a}$$\nNow we compute the barrier height $\\Delta U$:\n$$\\Delta U = U(x_{b}) - U(x_{0}) = 0 - \\left(-\\frac{b^{2}}{4a}\\right) = \\frac{b^{2}}{4a}$$\n\n4. Form the dimensionless barrier height $\\beta \\Delta U$.\n\nThe problem defines $\\beta$ as $\\beta = 1/(k_{B}T)$, where $k_{B}$ is the Boltzmann constant and $T$ is the absolute temperature. The dimensionless barrier height is the ratio of the barrier height to the characteristic thermal energy $k_{B}T$.\n$$\\beta \\Delta U = \\left(\\frac{1}{k_{B}T}\\right) \\Delta U = \\frac{1}{k_{B}T} \\left(\\frac{b^{2}}{4a}\\right)$$\nThis gives the final expression:\n$$\\beta \\Delta U = \\frac{b^{2}}{4ak_{B}T}$$\nThis is the dimensionless barrier height expressed in terms of the given parameters $a$, $b$, $k_{B}$, and $T$.",
            "answer": "$$\\boxed{\\frac{b^{2}}{4ak_{B}T}}$$"
        },
        {
            "introduction": "With the parameters of the potential energy surface in hand, we can apply Kramers theory to predict the rate of escape, which takes different forms depending on the level of friction. In the high-friction (Smoluchowski) limit, relevant for many condensed-phase processes, the rate is limited by spatial diffusion over the barrier, and this exercise challenges you to derive the rate expressions for both Transition State Theory (TST) and the high-friction Kramers theory from first principles.  By deriving and comparing these rates, you will gain a deep understanding of the transmission coefficient $\\kappa$ and how it quantifies the rate reduction due to friction-induced recrossings, a central concept distinguishing Kramers theory from simpler TST.",
            "id": "3819073",
            "problem": "A coarse-grained reaction coordinate $x$ describes the collective rearrangement of a shear transformation zone in a metallic glass matrix, modeled at the mesoscale as a one-dimensional overdamped Langevin system coupled to a thermal bath. The potential energy $U(x)$ has a metastable minimum at $x=x_{\\text{a}}$ and a single barrier (saddle) at $x=x_{\\text{b}}$. Near $x_{\\text{a}}$ and $x_{\\text{b}}$, $U(x)$ is well-approximated by harmonic expansions with curvatures that define small-oscillation frequencies: the well frequency $\\omega_{\\text{a}}$ at $x_{\\text{a}}$ and the barrier frequency $\\omega_{\\text{b}}$ (associated with the unstable direction) at $x_{\\text{b}}$. The system is in contact with a heat bath at absolute temperature $T$, with linear friction characterized by a rate $\\gamma$. The barrier height is $\\Delta U = U(x_{\\text{b}}) - U(x_{\\text{a}})$.\n\nUsing only foundational principles of statistical mechanics and stochastic dynamics (namely, equilibrium Boltzmann statistics, the Langevin equation, and the flux-over-population method in the appropriate dynamical regime), do the following:\n1. Derive the Transition State Theory (TST) rate $k_{\\text{TST}}$ for barrier crossing in terms of $\\omega_{\\text{a}}$, $\\Delta U$, Boltzmann’s constant $k_{B}$, and $T$.\n2. In the high-friction (Smoluchowski) limit of Kramers theory, derive the Kramers rate $k_{\\text{Kramers}}$ in terms of $\\omega_{\\text{a}}$, $\\omega_{\\text{b}}$, $\\gamma$, $\\Delta U$, $k_{B}$, and $T$.\n3. Evaluate both rates numerically for the following parameters, and report the dimensionless transmission coefficient $\\kappa = k_{\\text{Kramers}}/k_{\\text{TST}}$:\n   $\\omega_{\\text{a}} = 1.95 \\times 10^{13}\\ \\text{s}^{-1}$, $\\omega_{\\text{b}} = 1.35 \\times 10^{13}\\ \\text{s}^{-1}$, $\\gamma = 4.50 \\times 10^{13}\\ \\text{s}^{-1}$, $\\Delta U = 0.58\\ \\text{eV}$, $T = 1100\\ \\text{K}$.\n   Use $k_{B}$ in electronvolt per kelvin units.\n4. Briefly explain, in one or two sentences, how the numerical value of $\\kappa$ reflects dynamical deviations from the Transition State Theory assumption in this regime.\n\nExpress $k_{\\text{TST}}$ and $k_{\\text{Kramers}}$ in $\\text{s}^{-1}$. Round the final reported value of $\\kappa$ to four significant figures. The final answer must be only the numerical value of $\\kappa$.",
            "solution": "The solution is structured into the four parts requested by the problem statement.\n\n1. Derivation of the Transition State Theory (TST) rate, $k_{\\text{TST}}$.\n\nThe rate of transition, $k$, is defined by the flux-over-population method as the ratio of the one-way flux, $J$, of systems crossing the barrier at $x=x_{\\text{b}}$ to the total population of systems in the reactant well, $N_A$.\n$$k = \\frac{J}{N_A}$$\nTransition State Theory assumes that any trajectory crossing the dividing surface at the barrier top $x_{\\text{b}}$ from the reactant side to the product side will not recross back. This allows us to calculate the flux and population using the equilibrium Boltzmann distribution in phase space, $\\rho_{\\text{eq}}(x, v) = C \\exp(-H(x, v) / (k_B T))$, where $H(x, v) = \\frac{1}{2}mv^2 + U(x)$ is the Hamiltonian and $C$ is a normalization constant.\n\nThe one-way flux $J$ at the barrier top $x = x_{\\text{b}}$ is the integral of velocity $v$ over the distribution of systems at $x_{\\text{b}}$ with positive velocity:\n$$J = \\int_{0}^{\\infty} dv \\, v \\, \\rho_{\\text{eq}}(x_{\\text{b}}, v) = C \\int_{0}^{\\infty} dv \\, v \\, \\exp\\left(-\\frac{\\frac{1}{2}mv^2 + U(x_{\\text{b}})}{k_B T}\\right)$$\n$$J = C \\exp\\left(-\\frac{U(x_{\\text{b}})}{k_B T}\\right) \\int_{0}^{\\infty} v \\exp\\left(-\\frac{mv^2}{2k_B T}\\right) dv$$\nThe integral evaluates to $\\frac{k_B T}{m}$. Thus, the flux is:\n$$J = C \\exp\\left(-\\frac{U(x_{\\text{b}})}{k_B T}\\right) \\frac{k_B T}{m}$$\nThe equilibrium population $N_A$ in the reactant well is found by integrating the phase-space density over the region of the well:\n$$N_A = \\int_{\\text{well A}} dx \\int_{-\\infty}^{\\infty} dv \\, \\rho_{\\text{eq}}(x, v) = C \\int_{\\text{well A}} dx \\exp\\left(-\\frac{U(x)}{k_B T}\\right) \\int_{-\\infty}^{\\infty} dv \\exp\\left(-\\frac{mv^2}{2k_B T}\\right)$$\nWe use the harmonic approximation for the potential near the minimum $x_{\\text{a}}$: $U(x) \\approx U(x_{\\text{a}}) + \\frac{1}{2}m\\omega_{\\text{a}}^2(x-x_{\\text{a}})^2$. The integrals are standard Gaussian integrals:\n$$\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{mv^2}{2k_B T}\\right) dv = \\sqrt{\\frac{2\\pi k_B T}{m}}$$\n$$\\int_{\\text{well A}} \\exp\\left(-\\frac{U(x)}{k_B T}\\right) dx \\approx \\exp\\left(-\\frac{U(x_{\\text{a}})}{k_B T}\\right) \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{m\\omega_{\\text{a}}^2(x-x_{\\text{a}})^2}{2k_B T}\\right) dx = \\exp\\left(-\\frac{U(x_{\\text{a}})}{k_B T}\\right) \\sqrt{\\frac{2\\pi k_B T}{m\\omega_{\\text{a}}^2}}$$\nCombining these results gives the population $N_A$:\n$$N_A = C \\exp\\left(-\\frac{U(x_{\\text{a}})}{k_B T}\\right) \\sqrt{\\frac{2\\pi k_B T}{m\\omega_{\\text{a}}^2}} \\sqrt{\\frac{2\\pi k_B T}{m}}$$\nThe TST rate, $k_{\\text{TST}} = J/N_A$, is then:\n$$k_{\\text{TST}} = \\frac{C \\exp(-U(x_{\\text{b}})/k_B T) \\frac{k_B T}{m}}{C \\exp(-U(x_{\\text{a}})/k_B T) \\sqrt{\\frac{2\\pi k_B T}{m\\omega_{\\text{a}}^2}} \\sqrt{\\frac{2\\pi k_B T}{m}}} = \\frac{\\exp(-\\Delta U/k_B T) \\frac{k_B T}{m}}{\\frac{2\\pi k_B T}{m\\omega_{\\text{a}}}}$$\nwhere $\\Delta U = U(x_{\\text{b}}) - U(x_{\\text{a}})$. The unknown constants $C$ and mass $m$ cancel, yielding the final expression for the TST rate:\n$$k_{\\text{TST}} = \\frac{\\omega_{\\text{a}}}{2\\pi} \\exp\\left(-\\frac{\\Delta U}{k_B T}\\right)$$\n\n2. Derivation of the Kramers rate, $k_{\\text{Kramers}}$, in the high-friction limit.\n\nIn the high-friction (overdamped or Smoluchowski) limit, the dynamics are described by the Smoluchowski equation for the probability density $p(x,t)$. The corresponding probability current is $J(x) = -D \\left( \\frac{1}{k_B T}\\frac{dU}{dx}p(x) + \\frac{\\partial p}{\\partial x} \\right)$, where $D = k_B T/\\gamma$ is the diffusion constant if $\\gamma$ is the friction coefficient. We seek a steady-state solution where the current $J_0$ is constant. The derivation based on the mean first passage time gives the inverse rate as:\n$$k_{\\text{Kramers}}^{-1} = \\frac{1}{D} \\int_{x_{\\text{a}}}^{\\infty} \\exp\\left(\\frac{U(x)}{k_B T}\\right) dx \\int_{-\\infty}^{x} \\exp\\left(-\\frac{U(y)}{k_B T}\\right) dy$$\nThis general expression can be simplified by evaluating the integrals using the saddle-point (Laplace's) method, given the harmonic approximations for the potential at the well minimum ($x_{\\text{a}}$) and barrier maximum ($x_{\\text{b}}$). The derivation yields:\n$$k_{\\text{Kramers}}^{-1} \\approx \\frac{2\\pi\\gamma}{\\omega_{\\text{a}}\\omega_{\\text{b}}} \\exp\\left(\\frac{\\Delta U}{k_B T}\\right)$$\nHere, $\\gamma$ is the friction rate (units of 1/time), consistent with the problem's parameters.\nInverting this expression gives the Kramers rate in the high-friction limit:\n$$k_{\\text{Kramers}} = \\frac{\\omega_{\\text{a}}\\omega_{\\text{b}}}{2\\pi\\gamma} \\exp\\left(-\\frac{\\Delta U}{k_B T}\\right)$$\n\n3. Numerical Evaluation of Rates and Transmission Coefficient $\\kappa$.\n\nGiven parameters:\n$\\omega_{\\text{a}} = 1.95 \\times 10^{13}\\ \\text{s}^{-1}$\n$\\omega_{\\text{b}} = 1.35 \\times 10^{13}\\ \\text{s}^{-1}$\n$\\gamma = 4.50 \\times 10^{13}\\ \\text{s}^{-1}$\n$\\Delta U = 0.58\\ \\text{eV}$\n$T = 1100\\ \\text{K}$\n$k_B \\approx 8.6173 \\times 10^{-5}\\ \\text{eV}\\cdot\\text{K}^{-1}$\n\nFirst, we calculate the thermal energy and the Boltzmann factor:\n$$k_B T = (8.6173 \\times 10^{-5}\\ \\text{eV}\\cdot\\text{K}^{-1}) \\times (1100\\ \\text{K}) \\approx 0.09479\\ \\text{eV}$$\n$$\\frac{\\Delta U}{k_B T} = \\frac{0.58\\ \\text{eV}}{0.09479\\ \\text{eV}} \\approx 6.1188$$\n$$\\exp\\left(-\\frac{\\Delta U}{k_B T}\\right) \\approx \\exp(-6.1188) \\approx 2.201 \\times 10^{-3}$$\nNow, we compute the rates:\n$$k_{\\text{TST}} = \\frac{1.95 \\times 10^{13}\\ \\text{s}^{-1}}{2\\pi} \\times (2.201 \\times 10^{-3}) \\approx 6.832 \\times 10^{9}\\ \\text{s}^{-1}$$\n$$k_{\\text{Kramers}} = \\frac{(1.95 \\times 10^{13}\\ \\text{s}^{-1})(1.35 \\times 10^{13}\\ \\text{s}^{-1})}{2\\pi(4.50 \\times 10^{13}\\ \\text{s}^{-1})} \\times (2.201 \\times 10^{-3}) \\approx 2.049 \\times 10^{9}\\ \\text{s}^{-1}$$\nThe transmission coefficient $\\kappa$ is the ratio of the Kramers rate to the TST rate:\n$$\\kappa = \\frac{k_{\\text{Kramers}}}{k_{\\text{TST}}} = \\frac{\\frac{\\omega_{\\text{a}}\\omega_{\\text{b}}}{2\\pi\\gamma} \\exp\\left(-\\frac{\\Delta U}{k_B T}\\right)}{\\frac{\\omega_{\\text{a}}}{2\\pi} \\exp\\left(-\\frac{\\Delta U}{k_B T}\\right)} = \\frac{\\omega_{\\text{b}}}{\\gamma}$$\nSubstituting the numerical values:\n$$\\kappa = \\frac{1.35 \\times 10^{13}\\ \\text{s}^{-1}}{4.50 \\times 10^{13}\\ \\text{s}^{-1}} = 0.3$$\nRounding to four significant figures as requested, the result is $0.3000$.\n\n4. Explanation of the Transmission Coefficient $\\kappa$.\n\nThe transmission coefficient $\\kappa = 0.3000$ represents the correction to the TST rate due to frictional effects. The value $\\kappa  1$ indicates that the true rate is lower than the TST prediction because TST's core assumption of no-recrossing is violated; in this high-friction regime, trajectories reaching the barrier top are likely to diffuse back into the reactant well due to random thermal collisions. This value signifies that only $30\\%$ of the trajectories that reach the barrier maximum successfully cross to the product side.",
            "answer": "$$\\boxed{0.3000}$$"
        },
        {
            "introduction": "Analytical formulas, like the Kramers rate, are powerful but rely on approximations, such as the harmonic expansion of the potential around its extrema. This practice guides you to compute the barrier-crossing rate by numerically solving the underlying Smoluchowski equation, which provides a more exact benchmark for a given potential.  By comparing your numerical result with the analytical Kramers formula, you will directly test the accuracy of the theory's harmonic approximation, bridging the gap between analytical theory and computational practice, which is a core skill in multiscale simulation.",
            "id": "3819068",
            "problem": "Consider the overdamped barrier crossing of a one-dimensional reaction coordinate in a double-well potential within the framework of multiscale materials simulation. You will apply the flux-over-population method, grounded in the Smoluchowski limit of the Langevin dynamics, to numerically estimate the rate constant and compare it with an analytic Kramers theory prediction.\n\nStarting point and physical setting:\n- The motion of a reaction coordinate $x(t)$ in a potential energy landscape $U(x)$ with thermal noise and friction coefficient $\\gamma$ is modeled by the overdamped limit of the Langevin equation, which leads to the Smoluchowski Fokker-Planck equation (FPE) for the probability density $p(x,t)$. The diffusion coefficient $D$ and inverse thermal energy $\\beta$ satisfy $D = k_{\\mathrm{B}}T/\\gamma$ and $\\beta = 1/(k_{\\mathrm{B}}T)$. In this problem, use dimensionless units where $k_{\\mathrm{B}} = 1$, so $D = \\theta/\\gamma$ and $\\beta = 1/\\theta$, with $\\theta$ denoting temperature.\n- The flux-over-population method defines the rate constant $k$ as the stationary probability current $J$ crossing the barrier divided by the population $N$ retained in the reactant well.\n- In one dimension, for an absorbing boundary at the barrier top $x_b$ and a reflecting boundary at the reactant minimum $x_a$, the flux-over-population method is equivalent to computing the inverse of a mean first passage time. You must derive and implement this equivalence from the Smoluchowski FPE and the associated boundary value problem.\n\nConcrete potential and boundaries:\n- Use the quartic double-well potential $U(x) = A(x^2 - 1)^2$ with minima at $x = \\pm 1$ and a barrier at $x = 0$. The reactant well is the left minimum at $x_a = -1$, and the barrier top is at $x_b = 0$.\n- The diffusion coefficient is $D = \\theta/\\gamma$ and the inverse temperature is $\\beta = 1/\\theta$. The rate you compute must be reported in inverse time (dimensionless) units.\n\nAnalytic comparison:\n- Compare your numerical flux-over-population estimate $k_{\\mathrm{num}}$ to the analytic overdamped Kramers rate $k_{\\mathrm{K}}$ obtained by harmonic approximations near the minimum and near the barrier top for the specified potential. You must first derive the appropriate analytic expression for $k_{\\mathrm{K}}$ in terms of $A$, $\\theta$, and $\\gamma$.\n\nNumerical method specification:\n- Construct a uniform grid on $[x_a, x_b] = [-1, 0]$.\n- Use the trapezoidal rule to approximate the required integrals that arise from the flux-over-population formalism (do not use closed-form shortcuts). Ensure numerical stability appropriate for advanced graduate-level scientific computing.\n\nTest suite:\n- Evaluate the program for the following parameter sets $(A, \\theta, \\gamma)$:\n    - Case $1$: $A = 5.0$, $\\theta = 1.0$, $\\gamma = 10.0$.\n    - Case $2$: $A = 2.0$, $\\theta = 1.0$, $\\gamma = 5.0$.\n    - Case $3$: $A = 0.5$, $\\theta = 1.0$, $\\gamma = 10.0$.\n    - Case $4$: $A = 2.0$, $\\theta = 2.0$, $\\gamma = 2.0$.\n- For each case, produce a list $[k_{\\mathrm{num}}, k_{\\mathrm{K}}, \\varepsilon]$, where $k_{\\mathrm{num}}$ is the numerical flux-over-population rate estimate, $k_{\\mathrm{K}}$ is the analytic overdamped Kramers rate, and $\\varepsilon$ is the absolute relative error defined by $\\varepsilon = \\lvert k_{\\mathrm{num}} - k_{\\mathrm{K}} \\rvert / k_{\\mathrm{K}}$. All three quantities must be floats.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list of three-element lists enclosed in square brackets (for example, $[[r_{1,\\mathrm{num}}, r_{1,\\mathrm{K}}, r_{1,\\varepsilon}], [r_{2,\\mathrm{num}}, r_{2,\\mathrm{K}}, r_{2,\\varepsilon}], \\dots]$]). The numbers must be in inverse time (dimensionless) units.",
            "solution": "We begin with the overdamped limit of the Langevin equation for a reaction coordinate $x(t)$ in a potential $U(x)$ at temperature $T$ with friction coefficient $\\gamma$. In the dimensionless units adopted here, Boltzmann’s constant is set to $k_{\\mathrm{B}} = 1$, so the diffusion coefficient is $D = \\theta/\\gamma$, where $\\theta$ denotes the temperature, and the inverse temperature is $\\beta = 1/\\theta$. The dynamics are described by the Smoluchowski Fokker-Planck equation (FPE) for the probability density $p(x,t)$:\n$$\n\\frac{\\partial p(x,t)}{\\partial t} = D \\frac{\\partial}{\\partial x}\\left[\\frac{\\partial p(x,t)}{\\partial x} + \\beta U'(x) p(x,t)\\right].\n$$\nThe probability current density $j(x,t)$ associated with this FPE is\n$$\nj(x,t) = -D \\left[\\frac{\\partial p(x,t)}{\\partial x} + \\beta U'(x) p(x,t)\\right].\n$$\nIn the stationary regime with a small constant current and appropriate boundary conditions, the flux-over-population method defines the rate constant $k$ as the stationary current crossing the barrier divided by the population within the reactant region:\n$$\nk = \\frac{J}{N}.\n$$\nFor one-dimensional barrier crossing between a reflecting boundary at $x_a$ and an absorbing boundary at $x_b$, the flux-over-population method is equivalent to the inverse of a mean first passage time (MFPT). Specifically, the MFPT $T(x)$ from an initial position $x$ to absorption at $x_b$ with a reflecting boundary at $x_a$ satisfies the backward Fokker-Planck (or backward Kolmogorov) equation obtained from the Smoluchowski operator:\n$$\n- D e^{\\beta U(x)} \\frac{d}{dx}\\left( e^{-\\beta U(x)} \\frac{dT(x)}{dx} \\right) = 1,\n$$\nsubject to boundary conditions\n$$\n\\frac{dT}{dx}\\bigg|_{x=x_a} = 0 \\quad \\text{(reflecting)}, \\qquad T(x_b) = 0 \\quad \\text{(absorbing)}.\n$$\nIntegrating this ordinary differential equation with the given boundary conditions yields a well-known integral representation of the MFPT from the reflecting boundary $x_a$ to the absorbing boundary $x_b$:\n$$\nT(x_a) = \\frac{1}{D} \\int_{x_a}^{x_b} dy \\, e^{\\beta U(y)} \\int_{x_a}^{y} dz \\, e^{-\\beta U(z)}.\n$$\nThe flux-over-population rate estimate is then\n$$\nk_{\\mathrm{num}} = \\frac{1}{T(x_a)}.\n$$\nWe will compute $T(x_a)$ numerically using the trapezoidal rule on a uniform grid for stability and accuracy:\n- Construct a grid $\\{x_i\\}_{i=0}^{n-1}$ on $[x_a, x_b]$ with $x_0 = x_a$ and $x_{n-1} = x_b$.\n- Compute $U(x_i)$ and then the arrays $w_-(x_i) = e^{-\\beta U(x_i)}$ and $w_+(x_i) = e^{\\beta U(x_i)}$.\n- Compute the cumulative integral $S(y) = \\int_{x_a}^{y} e^{-\\beta U(z)} dz$ via the cumulative trapezoidal rule:\n$$\nS(x_0) = 0, \\quad S(x_i) = S(x_{i-1}) + \\frac{1}{2}\\left[w_-(x_{i}) + w_-(x_{i-1})\\right]\\left(x_i - x_{i-1}\\right).\n$$\n- Form the integrand $G(y) = e^{\\beta U(y)} S(y)$ and evaluate the outer integral using the trapezoidal rule:\n$$\n\\int_{x_a}^{x_b} G(y) \\, dy \\approx \\sum_{i=1}^{n-1} \\frac{1}{2}\\left[G(x_i) + G(x_{i-1})\\right]\\left(x_i - x_{i-1}\\right).\n$$\n- Multiply by $1/D$ to obtain $T(x_a)$ and then invert to obtain $k_{\\mathrm{num}}$.\n\nWe now derive the analytic overdamped Kramers rate for the specific quartic double-well potential\n$$\nU(x) = A(x^2 - 1)^2,\n$$\nwith minima at $x = \\pm 1$ and a barrier at $x = 0$. The left reactant well is at $x_a = -1$, the barrier top is at $x_b = 0$, and the barrier height is\n$$\n\\Delta U = U(x_b) - U(x_a) = A - 0 = A.\n$$\nThe overdamped Kramers rate formula arises from a matched asymptotic analysis of the Smoluchowski FPE in the high-barrier limit, using harmonic approximations near the well minimum and near the barrier top. The overdamped Kramers rate constant is\n$$\nk_{\\mathrm{K}} = \\frac{\\beta D}{2\\pi} \\sqrt{U''(x_a)\\left|U''(x_b)\\right|} \\, e^{-\\beta \\Delta U}.\n$$\nIn our dimensionless units, $\\beta D = (1/\\theta) \\cdot (\\theta/\\gamma) = 1/\\gamma$, so\n$$\nk_{\\mathrm{K}} = \\frac{1}{2\\pi \\gamma} \\sqrt{U''(x_a)\\left|U''(x_b)\\right|} \\, e^{-A/\\theta}.\n$$\nWe compute the second derivatives for the quartic double-well:\n$$\nU'(x) = 4A x(x^2 - 1), \\quad U''(x) = 4A(3x^2 - 1).\n$$\nThus,\n$$\nU''(x_a) = U''(-1) = 4A(3\\cdot 1 - 1) = 8A, \\qquad U''(x_b) = U''(0) = 4A(0 - 1) = -4A,\n$$\nand\n$$\n\\sqrt{U''(x_a)\\left|U''(x_b)\\right|} = \\sqrt{8A \\cdot 4A} = \\sqrt{32} \\, A.\n$$\nThe analytic overdamped Kramers rate for this potential is therefore\n$$\nk_{\\mathrm{K}} = \\frac{\\sqrt{32} \\, A}{2\\pi \\gamma} \\, e^{-A/\\theta}.\n$$\n\nAlgorithmic steps for each test case:\n- Set $x_a = -1$, $x_b = 0$, construct a uniform grid with sufficiently many points to control quadrature error.\n- Compute $U(x)$, $w_-(x) = e^{-\\beta U(x)}$, cumulative integral $S(y)$, integrand $G(y) = e^{\\beta U(y)} S(y)$, and the outer integral by trapezoidal rule.\n- Compute $T(x_a) = \\frac{1}{D} \\int_{x_a}^{x_b} G(y) \\, dy$ and $k_{\\mathrm{num}} = 1/T(x_a)$.\n- Compute $k_{\\mathrm{K}} = \\frac{\\sqrt{32} A}{2\\pi \\gamma} e^{-A/\\theta}$.\n- Compute the absolute relative error $\\varepsilon = \\lvert k_{\\mathrm{num}} - k_{\\mathrm{K}} \\rvert / k_{\\mathrm{K}}$.\n\nTest suite and outputs:\n- Case $1$: $A = 5.0$, $\\theta = 1.0$, $\\gamma = 10.0$ tests a high barrier and high friction (well within overdamped Kramers regime).\n- Case $2$: $A = 2.0$, $\\theta = 1.0$, $\\gamma = 5.0$ tests moderate barrier and moderate friction.\n- Case $3$: $A = 0.5$, $\\theta = 1.0$, $\\gamma = 10.0$ tests a low barrier where asymptotic Kramers accuracy is limited.\n- Case $4$: $A = 2.0$, $\\theta = 2.0$, $\\gamma = 2.0$ tests higher temperature and lower friction (still overdamped), probing sensitivity to $\\theta$ and $\\gamma$.\n\nThe program will output a single line containing a comma-separated list of lists $[[k_{\\mathrm{num}}, k_{\\mathrm{K}}, \\varepsilon], \\dots]$ in inverse time (dimensionless) units for all cases. Numerical stability is managed through uniform-grid trapezoidal quadrature and careful evaluation of exponentials confined to the interval $[x_a, x_b]$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_rate_flux_over_population(A: float, theta: float, gamma: float, n_grid: int = 20001):\n    \"\"\"\n    Compute the flux-over-population rate for U(x) = A*(x^2 - 1)^2\n    using a uniform grid and trapezoidal quadrature on [x_a, x_b] = [-1, 0].\n    \"\"\"\n    # Boundaries: reactant minimum (reflecting) and barrier top (absorbing)\n    xa = -1.0\n    xb = 0.0\n\n    # Thermal parameters in dimensionless units: k_B = 1\n    beta = 1.0 / theta\n    D = theta / gamma  # Smoluchowski diffusion coefficient\n\n    # Uniform grid\n    x = np.linspace(xa, xb, n_grid)\n    dx = x[1] - x[0]\n\n    # Potential and exponentials\n    U = A * (x**2 - 1.0)**2\n    w_minus = np.exp(-beta * U)  # e^{-beta U(x)}\n    w_plus = np.exp(beta * U)    # e^{+beta U(x)}\n\n    # Cumulative trapezoidal integration for S(y) = \\int_{xa}^{y} e^{-beta U(z)} dz\n    S = np.zeros_like(x)\n    # S[0] = 0 by definition\n    # Iteratively accumulate with trapezoidal rule\n    for i in range(1, n_grid):\n        S[i] = S[i-1] + 0.5 * (w_minus[i] + w_minus[i-1]) * (x[i] - x[i-1])\n\n    # Outer integrand G(y) = e^{beta U(y)} * S(y)\n    G = w_plus * S\n\n    # Trapezoidal integration for outer integral \\int_{xa}^{xb} G(y) dy\n    integral_outer = np.sum(0.5 * (G[1:] + G[:-1]) * (x[1:] - x[:-1]))\n\n    # Mean first passage time T(xa)\n    T = (1.0 / D) * integral_outer\n\n    # Numerical rate\n    k_num = 1.0 / T\n    return k_num\n\ndef compute_kramers_overdamped_rate(A: float, theta: float, gamma: float):\n    \"\"\"\n    Analytic overdamped Kramers rate for U(x) = A*(x^2 - 1)^2:\n    k_K = (sqrt(32) * A / (2*pi*gamma)) * exp(-A/theta)\n    \"\"\"\n    sqrt32 = np.sqrt(32.0)\n    kK = (sqrt32 * A) / (2.0 * np.pi * gamma) * np.exp(-A / theta)\n    return kK\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (A, theta, gamma)\n    test_cases = [\n        (5.0, 1.0, 10.0),  # Case 1: high barrier, high friction\n        (2.0, 1.0, 5.0),   # Case 2: moderate barrier, moderate friction\n        (0.5, 1.0, 10.0),  # Case 3: low barrier\n        (2.0, 2.0, 2.0),   # Case 4: higher temperature, lower friction\n    ]\n\n    results = []\n    for A, theta, gamma in test_cases:\n        # Compute numerical flux-over-population rate\n        k_num = compute_rate_flux_over_population(A=A, theta=theta, gamma=gamma, n_grid=20001)\n\n        # Compute analytic overdamped Kramers rate\n        k_kramers = compute_kramers_overdamped_rate(A=A, theta=theta, gamma=gamma)\n\n        # Absolute relative error\n        # Handle the case where k_kramers might be extremely small; if zero, set error to np.inf.\n        if k_kramers == 0.0:\n            rel_err = float('inf')\n        else:\n            rel_err = abs(k_num - k_kramers) / k_kramers\n\n        results.append([k_num, k_kramers, rel_err])\n\n    # Format the output as a single-line, comma-separated list of lists without spaces.\n    def format_results(res):\n        def fmt_triplet(t):\n            return \"[\" + \",\".join(f\"{v:.10g}\" for v in t) + \"]\"\n        return \"[\" + \",\".join(fmt_triplet(t) for t in res) + \"]\"\n\n    print(format_results(results))\n\nsolve()\n```"
        }
    ]
}