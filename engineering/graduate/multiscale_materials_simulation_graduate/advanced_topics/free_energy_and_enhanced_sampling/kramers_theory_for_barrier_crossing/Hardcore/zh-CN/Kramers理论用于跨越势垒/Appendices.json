{
    "hands_on_practices": [
        {
            "introduction": "在我们计算一个过程发生的速度之前，我们必须首先理解它需要穿越的“地形”。第一个练习侧重于分析势能面的基本技能。通过研究一个经典的双阱势，你将学会如何识别稳定态（势阱）和过渡态（势垒），并量化必须克服的能垒，这是任何速率理论计算中至关重要的第一步。",
            "id": "3819052",
            "problem": "在 Kramers 越垒理论中的激活输运过程中，从亚稳态势阱中逃逸的速率取决于亚稳态势阱最小值和势垒顶部附近势能的局部曲率，以及势垒高度相对于热能的大小。考虑一个由 $U(x)=a x^{4}-b x^{2}$给出的一维粗粒化势能景观，其中 $a>0$ 且 $b>0$。该势能景观可作为多尺度材料模拟中平均力势的局部近似而出现。从驻点和曲率关于 $U(x)$ 一阶和二阶导数的定义出发，完成以下任务：\n\n1. 找出驻点并对其进行分类，以确定势垒顶部 $x_b$ 和在 $x>0$ 分支上的亚稳态势阱位置 $x_0$。\n2. 计算二阶导数 $U''(x)$ 并计算 $U''(x_{0})$ 和 $U''(x_{b})$ 的值，根据其正负号解释局部稳定性。\n3. 确定势垒高度 $\\Delta U=U(x_{b})-U(x_{0})$。\n4. 令 $\\beta=1/\\left(k_{B} T\\right)$，其中 $k_{B}$ 是玻尔兹曼常数，$T$ 是绝对温度。构建无量纲势垒高度 $\\beta \\Delta U$。\n\n请将您的最终答案表示为关于 $a$、$b$、$k_{B}$ 和 $T$ 的单一闭式解析表达式。不要进行任何数值代入，也不要四舍五入。最终答案必须是无量纲的；请勿在最终答案中包含单位。除了所要求的最终表达式外，不要提供任何其他输出。",
            "solution": "该问题要求计算在一个由 $U(x) = a x^{4} - b x^{2}$ ($a>0$ 且 $b>0$) 给出的一维势能景观中，一个粒子的无量纲势垒高度 $\\beta \\Delta U$。解题过程遵循指定的四个步骤构建。\n\n首先，我们定义势能函数：\n$$U(x) = a x^{4} - b x^{2}$$\n\n1. 找出驻点并对其进行分类，以确定势垒顶部 $x_b$ 和在 $x>0$ 分支上的亚稳态势阱位置 $x_0$。\n\n势能 $U(x)$ 的驻点是其一阶导数（对应于力 $F(x) = -U'(x)$）为零的点。我们计算 $U(x)$ 的一阶导数：\n$$U'(x) = \\frac{d}{dx} \\left( a x^{4} - b x^{2} \\right) = 4ax^{3} - 2bx$$\n我们将一阶导数设为零以找到驻点：\n$$U'(x) = 4ax^{3} - 2bx = 2x(2ax^{2} - b) = 0$$\n$x$ 的解为：\n$$x = 0$$\n和\n$$2ax^{2} - b = 0 \\implies x^{2} = \\frac{b}{2a} \\implies x = \\pm\\sqrt{\\frac{b}{2a}}$$\n驻点位于 $x=0$、$x=+\\sqrt{\\frac{b}{2a}}$ 和 $x=-\\sqrt{\\frac{b}{2a}}$。问题指定考虑 $x>0$ 分支上的亚稳态势阱。\n\n2. 计算二阶导数 $U''(x)$ 并计算 $U''(x_{0})$ 和 $U''(x_{b})$ 的值，根据其正负号解释局部稳定性。\n\n为了对这些驻点进行分类，我们使用二阶导数检验。$U(x)$ 的二阶导数为：\n$$U''(x) = \\frac{d^{2}}{dx^{2}} \\left( a x^{4} - b x^{2} \\right) = \\frac{d}{dx} \\left( 4ax^{3} - 2bx \\right) = 12ax^{2} - 2b$$\n现在我们在每个驻点处计算 $U''(x)$ 的值：\n在 $x=0$ 处：\n$$U''(0) = 12a(0)^{2} - 2b = -2b$$\n由于 $b>0$，所以 $U''(0)  0$。负的二阶导数表示势能在此处是局部下凹的，因此 $x=0$ 是一个局部极大值点。该点对应于分隔两个势阱的势垒顶部。因此，势垒顶部位于 $x_{b}=0$。\n\n在 $x=+\\sqrt{\\frac{b}{2a}}$ 处：\n$$U''\\left(\\sqrt{\\frac{b}{2a}}\\right) = 12a\\left(\\sqrt{\\frac{b}{2a}}\\right)^{2} - 2b = 12a\\left(\\frac{b}{2a}\\right) - 2b = 6b - 2b = 4b$$\n由于 $b>0$，所以 $U''\\left(\\sqrt{\\frac{b}{2a}}\\right) > 0$。正的二阶导数表示势能在此处是局部上凹的，因此该点是一个局部极小值点。这对应于 $x>0$ 分支上亚稳态势阱的位置。因此，势阱位置是 $x_{0}=\\sqrt{\\frac{b}{2a}}$。\n\n正曲率 $U''(x_{0})=4b$ 表示点 $x_0$ 是一个稳定平衡位置（一个势阱），而负曲率 $U''(x_{b})=-2b$ 表示点 $x_b$ 是一个不稳定平衡位置（一个势垒）。\n\n3. 确定势垒高度 $\\Delta U = U(x_{b}) - U(x_{0})$。\n\n势垒高度是势垒顶部和势阱最小值之间的势能差。\n首先，我们计算势垒顶部 $x_{b}=0$ 处的势能：\n$$U(x_{b}) = U(0) = a(0)^{4} - b(0)^{2} = 0$$\n接下来，我们计算势阱最小值 $x_{0}=\\sqrt{\\frac{b}{2a}}$ 处的势能：\n$$U(x_{0}) = U\\left(\\sqrt{\\frac{b}{2a}}\\right) = a\\left(\\sqrt{\\frac{b}{2a}}\\right)^{4} - b\\left(\\sqrt{\\frac{b}{2a}}\\right)^{2}$$\n$$U(x_{0}) = a\\left(\\frac{b^{2}}{4a^{2}}\\right) - b\\left(\\frac{b}{2a}\\right) = \\frac{b^{2}}{4a} - \\frac{2b^{2}}{4a} = -\\frac{b^{2}}{4a}$$\n现在我们计算势垒高度 $\\Delta U$：\n$$\\Delta U = U(x_{b}) - U(x_{0}) = 0 - \\left(-\\frac{b^{2}}{4a}\\right) = \\frac{b^{2}}{4a}$$\n\n4. 构建无量纲势垒高度 $\\beta \\Delta U$。\n\n问题定义 $\\beta$ 为 $\\beta = 1/(k_{B}T)$，其中 $k_{B}$ 是玻尔兹曼常数，$T$ 是绝对温度。无量纲势垒高度是势垒高度与特征热能 $k_{B}T$ 的比值。\n$$\\beta \\Delta U = \\left(\\frac{1}{k_{B}T}\\right) \\Delta U = \\frac{1}{k_{B}T} \\left(\\frac{b^{2}}{4a}\\right)$$\n这给出了最终的表达式：\n$$\\beta \\Delta U = \\frac{b^{2}}{4ak_{B}T}$$\n这就是用给定参数 $a$、$b$、$k_{B}$ 和 $T$ 表示的无量纲势垒高度。",
            "answer": "$$\\boxed{\\frac{b^{2}}{4ak_{B}T}}$$"
        },
        {
            "introduction": "在对势能面进行了表征之后，我们现在可以估算穿越速率了。这个练习将介绍高摩擦（或过阻尼）极限下的克莱默斯速率公式，在该极限下，系统的运动主要由粘性阻力主导。你将从第一性原理出发推导这个重要的结果，并将其与更简单的过渡态理论 ($k_{\\text{TST}}$) 进行对比，从而突显出透射系数在解释动力学重穿越效应中的作用。",
            "id": "3819073",
            "problem": "一个粗粒化反应坐标 $x$ 描述了金属玻璃基体中剪切形变区的集体原子重排。在介观尺度上，该过程被建模为一个与热浴耦合的一维过阻尼朗之万系统。势能 $U(x)$ 在 $x=x_{\\text{a}}$ 处有一个亚稳态极小值，在 $x=x_{\\text{b}}$ 处有一个单个势垒（鞍点）。在 $x_{\\text{a}}$ 和 $x_{\\text{b}}$ 附近，$U(x)$ 可以很好地用谐波展开来近似，其曲率定义了微振荡频率：$x_{\\text{a}}$ 处的势阱频率 $\\omega_{\\text{a}}$ 和 $x_{\\text{b}}$ 处的势垒频率 $\\omega_{\\text{b}}$（与不稳定方向相关）。该系统与一个绝对温度为 $T$ 的热浴接触，其线性摩擦由一个速率 $\\gamma$ 表征。势垒高度为 $\\Delta U = U(x_{\\text{b}}) - U(x_{\\text{a}})$.\n\n仅使用统计力学和随机动力学的基本原理（即平衡玻尔兹曼统计、朗之万方程以及在适当动力学区域中的通量-布居数方法），完成以下任务：\n1. 推导过渡态理论 (TST) 的越垒速率 $k_{\\text{TST}}$，用 $\\omega_{\\text{a}}$、$\\Delta U$、玻尔兹曼常数 $k_{B}$ 和 $T$ 表示。\n2. 在 Kramers 理论的高摩擦（Smoluchowski）极限下，推导 Kramers 速率 $k_{\\text{Kramers}}$，用 $\\omega_{\\text{a}}$、$\\omega_{\\text{b}}$、$\\gamma$、$\\Delta U$、$k_{B}$ 和 $T$ 表示。\n3. 对于以下参数，数值计算这两个速率，并报告无量纲透射系数 $\\kappa = k_{\\text{Kramers}}/k_{\\text{TST}}$：\n   $\\omega_{\\text{a}} = 1.95 \\times 10^{13}\\ \\text{s}^{-1}$，$\\omega_{\\text{b}} = 1.35 \\times 10^{13}\\ \\text{s}^{-1}$，$\\gamma = 4.50 \\times 10^{13}\\ \\text{s}^{-1}$，$\\Delta U = 0.58\\ \\text{eV}$，$T = 1100\\ \\text{K}$。\n   使用以电子伏特每开尔文为单位的 $k_{B}$。\n4. 用一两句话简要解释，在此动力学区域中，$\\kappa$ 的数值如何反映了对过渡态理论假设的动力学偏差。\n\n将 $k_{\\text{TST}}$ 和 $k_{\\text{Kramers}}$ 以 $\\text{s}^{-1}$ 为单位表示。将最终报告的 $\\kappa$ 值四舍五入到四位有效数字。最终答案必须仅为 $\\kappa$ 的数值。",
            "solution": "解答按照问题陈述要求的四个部分进行组织。\n\n1. 过渡态理论 (TST) 速率 $k_{\\text{TST}}$ 的推导。\n\n跃迁速率 $k$ 由通量-布居数方法定义，即在 $x=x_{\\text{b}}$ 处越过势垒的系统的单向通量 $J$ 与反应物势阱中系统的总布居数 $N_A$ 之比。\n$$k = \\frac{J}{N_A}$$\n过渡态理论假设，任何从反应物侧穿过势垒顶部 $x_{\\text{b}}$ 处分隔面到达产物侧的轨迹都不会回穿。这使我们可以使用相空间中的平衡玻尔兹曼分布 $\\rho_{\\text{eq}}(x, v) = C \\exp(-H(x, v) / (k_B T))$ 来计算通量和布居数，其中 $H(x, v) = \\frac{1}{2}mv^2 + U(x)$ 是哈密顿量，$C$ 是归一化常数。\n\n在势垒顶部 $x = x_{\\text{b}}$ 处的单向通量 $J$ 是速度 $v$ 对 $x_{\\text{b}}$ 处具有正速度的系统分布的积分：\n$$J = \\int_{0}^{\\infty} dv \\, v \\, \\rho_{\\text{eq}}(x_{\\text{b}}, v) = C \\int_{0}^{\\infty} dv \\, v \\, \\exp\\left(-\\frac{\\frac{1}{2}mv^2 + U(x_{\\text{b}})}{k_B T}\\right)$$\n$$J = C \\exp\\left(-\\frac{U(x_{\\text{b}})}{k_B T}\\right) \\int_{0}^{\\infty} v \\exp\\left(-\\frac{mv^2}{2k_B T}\\right) dv$$\n该积分的计算结果为 $\\frac{k_B T}{m}$。因此，通量为：\n$$J = C \\exp\\left(-\\frac{U(x_{\\text{b}})}{k_B T}\\right) \\frac{k_B T}{m}$$\n反应物势阱中的平衡布居数 $N_A$ 通过对势阱区域的相空间密度进行积分得到：\n$$N_A = \\int_{\\text{well A}} dx \\int_{-\\infty}^{\\infty} dv \\, \\rho_{\\text{eq}}(x, v) = C \\int_{\\text{well A}} dx \\exp\\left(-\\frac{U(x)}{k_B T}\\right) \\int_{-\\infty}^{\\infty} dv \\exp\\left(-\\frac{mv^2}{2k_B T}\\right)$$\n我们使用势阱极小值 $x_{\\text{a}}$ 附近的谐波近似：$U(x) \\approx U(x_{\\text{a}}) + \\frac{1}{2}m\\omega_{\\text{a}}^2(x-x_{\\text{a}})^2$。这些积分是标准的高斯积分：\n$$\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{mv^2}{2k_B T}\\right) dv = \\sqrt{\\frac{2\\pi k_B T}{m}}$$\n$$\\int_{\\text{well A}} \\exp\\left(-\\frac{U(x)}{k_B T}\\right) dx \\approx \\exp\\left(-\\frac{U(x_{\\text{a}})}{k_B T}\\right) \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{m\\omega_{\\text{a}}^2(x-x_{\\text{a}})^2}{2k_B T}\\right) dx = \\exp\\left(-\\frac{U(x_{\\text{a}})}{k_B T}\\right) \\sqrt{\\frac{2\\pi k_B T}{m\\omega_{\\text{a}}^2}}$$\n结合这些结果，得到布居数 $N_A$：\n$$N_A = C \\exp\\left(-\\frac{U(x_{\\text{a}})}{k_B T}\\right) \\sqrt{\\frac{2\\pi k_B T}{m\\omega_{\\text{a}}^2}} \\sqrt{\\frac{2\\pi k_B T}{m}}$$\n那么，TST 速率 $k_{\\text{TST}} = J/N_A$ 为：\n$$k_{\\text{TST}} = \\frac{C \\exp(-U(x_{\\text{b}})/k_B T) \\frac{k_B T}{m}}{C \\exp(-U(x_{\\text{a}})/k_B T) \\sqrt{\\frac{2\\pi k_B T}{m\\omega_{\\text{a}}^2}} \\sqrt{\\frac{2\\pi k_B T}{m}}} = \\frac{\\exp(-\\Delta U/k_B T) \\frac{k_B T}{m}}{\\frac{2\\pi k_B T}{m\\omega_{\\text{a}}}}$$\n其中 $\\Delta U = U(x_{\\text{b}}) - U(x_{\\text{a}})$。未知常数 $C$ 和质量 $m$ 被消去，得到 TST 速率的最终表达式：\n$$k_{\\text{TST}} = \\frac{\\omega_{\\text{a}}}{2\\pi} \\exp\\left(-\\frac{\\Delta U}{k_B T}\\right)$$\n\n2. 在高摩擦极限下推导 Kramers 速率 $k_{\\text{Kramers}}$。\n\n在高摩擦（过阻尼或 Smoluchowski）极限下，动力学由概率密度 $p(x,t)$ 的 Smoluchowski 方程描述。相应的概率流为 $J(x) = -D \\left( \\frac{1}{k_B T}\\frac{dU}{dx}p(x) + \\frac{\\partial p}{\\partial x} \\right)$，其中 $D = k_B T/(m\\gamma)$ 是扩散常数。我们寻求一个稳态解，其中流 $J_0$ 是一个常数。\n$$J_0 = -D \\exp\\left(-\\frac{U(x)}{k_B T}\\right) \\frac{d}{dx}\\left( p(x) \\exp\\left(\\frac{U(x)}{k_B T}\\right) \\right)$$\n速率由 $k_{\\text{Kramers}} = J_0 / N_A$ 给出，其中 $N_A$ 是反应物势阱中的布居数。我们可以通过注意对于归一化分布有 $N_A \\approx 1$，并施加边界条件：在反应物势阱深处 $p(x) \\to p_{\\text{eq}}(x)$，在产物势阱中 $p(x) \\to 0$ 来求解速率。该速率是平均首达时间的倒数，可以表示为：\n$$k_{\\text{Kramers}}^{-1} = \\frac{1}{D} \\int_{x_{\\text{a}}}^{\\infty} \\exp\\left(\\frac{U(x)}{k_B T}\\right) dx \\int_{-\\infty}^{x} \\exp\\left(-\\frac{U(y)}{k_B T}\\right) dy$$\n在给定势阱极小值 ($x_{\\text{a}}$) 和势垒极大值 ($x_{\\text{b}}$) 处的谐波近似条件下，可以使用鞍点法（拉普拉斯方法）对积分进行求值，从而简化这个通用表达式。\n积分 $\\int_{-\\infty}^{x} \\exp(-U(y)/k_B T) dy$ 主要由 $x_{\\text{a}}$ 处的极小值主导：\n$$\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{U(y)}{k_B T}\\right) dy \\approx \\exp\\left(-\\frac{U(x_{\\text{a}})}{k_B T}\\right) \\sqrt{\\frac{2\\pi k_B T}{m\\omega_{\\text{a}}^2}}$$\n积分 $\\int_{x_{\\text{a}}}^{\\infty} \\exp(U(x)/k_B T) dx$ 主要由 $x_{\\text{b}}$ 处的极大值主导，其中 $U(x) \\approx U(x_{\\text{b}}) - \\frac{1}{2}m\\omega_{\\text{b}}^2(x-x_{\\text{b}})^2$：\n$$\\int_{-\\infty}^{\\infty} \\exp\\left(\\frac{U(x)}{k_B T}\\right) dx \\approx \\exp\\left(\\frac{U(x_{\\text{b}})}{k_B T}\\right) \\sqrt{\\frac{2\\pi k_B T}{m\\omega_{\\text{b}}^2}}$$\n将这些近似值代入速率公式中（更形式化的推导在 $k^{-1}$ 的表达式中给出了这两个积分的乘积）：\n$$k_{\\text{Kramers}}^{-1} \\approx \\frac{1}{D} \\left( \\exp\\left(\\frac{U(x_{\\text{b}})}{k_B T}\\right) \\sqrt{\\frac{2\\pi k_B T}{m\\omega_{\\text{b}}^2}} \\right) \\left( \\exp\\left(-\\frac{U(x_{\\text{a}})}{k_B T}\\right) \\sqrt{\\frac{2\\pi k_B T}{m\\omega_{\\text{a}}^2}} \\right)$$\n$$k_{\\text{Kramers}}^{-1} \\approx \\frac{1}{D} \\exp\\left(\\frac{\\Delta U}{k_B T}\\right) \\frac{2\\pi k_B T}{m\\omega_{\\text{a}}\\omega_{\\text{b}}}$$\n代入 $D = k_B T / (m\\gamma)$：\n$$k_{\\text{Kramers}}^{-1} \\approx \\frac{m\\gamma}{k_B T} \\exp\\left(\\frac{\\Delta U}{k_B T}\\right) \\frac{2\\pi k_B T}{m\\omega_{\\text{a}}\\omega_{\\text{b}}} = \\frac{2\\pi\\gamma}{\\omega_{\\text{a}}\\omega_{\\text{b}}} \\exp\\left(\\frac{\\Delta U}{k_B T}\\right)$$\n对此表达式求逆，得到高摩擦极限下的 Kramers 速率：\n$$k_{\\text{Kramers}} = \\frac{\\omega_{\\text{a}}\\omega_{\\text{b}}}{2\\pi\\gamma} \\exp\\left(-\\frac{\\Delta U}{k_B T}\\right)$$\n\n3. 速率和透射系数 $\\kappa$ 的数值计算。\n\n给定参数：\n$\\omega_{\\text{a}} = 1.95 \\times 10^{13}\\ \\text{s}^{-1}$\n$\\omega_{\\text{b}} = 1.35 \\times 10^{13}\\ \\text{s}^{-1}$\n$\\gamma = 4.50 \\times 10^{13}\\ \\text{s}^{-1}$\n$\\Delta U = 0.58\\ \\text{eV}$\n$T = 1100\\ \\text{K}$\n$k_B \\approx 8.6173 \\times 10^{-5}\\ \\text{eV}\\cdot\\text{K}^{-1}$\n\n首先，我们计算热能和玻尔兹曼因子：\n$$k_B T = (8.6173 \\times 10^{-5}\\ \\text{eV}\\cdot\\text{K}^{-1}) \\times (1100\\ \\text{K}) \\approx 0.09479\\ \\text{eV}$$\n$$\\frac{\\Delta U}{k_B T} = \\frac{0.58\\ \\text{eV}}{0.09479\\ \\text{eV}} \\approx 6.1188$$\n$$\\exp\\left(-\\frac{\\Delta U}{k_B T}\\right) \\approx \\exp(-6.1188) \\approx 2.201 \\times 10^{-3}$$\n现在，我们计算速率：\n$$k_{\\text{TST}} = \\frac{1.95 \\times 10^{13}\\ \\text{s}^{-1}}{2\\pi} \\times (2.201 \\times 10^{-3}) \\approx 6.832 \\times 10^{9}\\ \\text{s}^{-1}$$\n$$k_{\\text{Kramers}} = \\frac{(1.95 \\times 10^{13}\\ \\text{s}^{-1})(1.35 \\times 10^{13}\\ \\text{s}^{-1})}{2\\pi(4.50 \\times 10^{13}\\ \\text{s}^{-1})} \\times (2.201 \\times 10^{-3}) \\approx 2.049 \\times 10^{9}\\ \\text{s}^{-1}$$\n透射系数 $\\kappa$ 是 Kramers 速率与 TST 速率之比：\n$$\\kappa = \\frac{k_{\\text{Kramers}}}{k_{\\text{TST}}} = \\frac{\\frac{\\omega_{\\text{a}}\\omega_{\\text{b}}}{2\\pi\\gamma} \\exp\\left(-\\frac{\\Delta U}{k_B T}\\right)}{\\frac{\\omega_{\\text{a}}}{2\\pi} \\exp\\left(-\\frac{\\Delta U}{k_B T}\\right)} = \\frac{\\omega_{\\text{b}}}{\\gamma}$$\n代入数值：\n$$\\kappa = \\frac{1.35 \\times 10^{13}\\ \\text{s}^{-1}}{4.50 \\times 10^{13}\\ \\text{s}^{-1}} = 0.3$$\n按要求四舍五入到四位有效数字，结果为 $0.3000$。\n\n4. 透射系数 $\\kappa$ 的解释。\n\n透射系数 $\\kappa = 0.3000$ 代表了由摩擦效应引起的对 TST 速率的修正。$\\kappa  1$ 的值表明真实速率低于 TST 的预测，因为 TST 的核心假设——无回穿——被违背了；在这个高摩擦区域，到达势垒顶部的轨迹很可能由于随机热碰撞而扩散回反应物势阱。该值意味着只有 $30\\%$ 到达势垒顶部的轨迹成功地越过并进入产物侧。",
            "answer": "$$\n\\boxed{0.3000}\n$$"
        },
        {
            "introduction": "像克莱默斯速率这样的解析公式通常依赖于近似，例如势阱和势垒附近的谐振子近似。最后一个练习将带你进一步进入计算物理学领域，要求你通过数值求解底层的随机问题来直接计算速率常数。通过实现平均首渡时间方法，你将对理论框架有更深刻的理解，并能够检验克莱默斯解析理论的准确性。",
            "id": "3819068",
            "problem": "考虑在多尺度材料模拟框架下，一个一维反应坐标在双阱势中的过阻尼越垒过程。你将应用基于朗之万动力学的斯莫鲁霍夫斯基极限的流-布居数方法（flux-over-population method），对速率常数进行数值估计，并将其与解析的 Kramers 理论预测进行比较。\n\n出发点与物理背景：\n- 在势能形貌 $U(x)$ 中，一个反应坐标 $x(t)$ 的运动受到热噪声和摩擦系数为 $\\gamma$ 的影响，其运动由朗之万方程的过阻尼极限描述，这导出了关于概率密度 $p(x,t)$ 的斯莫鲁霍夫斯基-福克-普朗克方程（FPE）。扩散系数 $D$ 和逆热能 $\\beta$ 满足 $D = k_{\\mathrm{B}}T/\\gamma$ 和 $\\beta = 1/(k_{\\mathrm{B}}T)$。在本问题中，使用无量纲单位，其中 $k_{\\mathrm{B}} = 1$，因此 $D = \\theta/\\gamma$ 且 $\\beta = 1/\\theta$，其中 $\\theta$ 表示温度。\n- 流-布居数方法将速率常数 $k$ 定义为跨越势垒的稳态概率流 $J$ 除以保留在反应物阱中的布居数 $N$。\n- 在一维情况下，对于势垒顶部 $x_b$ 处的吸收边界和反应物极小值点 $x_a$ 处的反射边界，流-布居数方法等价于计算平均首达时间的倒数。你必须从斯莫鲁霍夫斯基 FPE 及相关的边值问题出发，推导并实现此等价关系。\n\n具体的势和边界：\n- 使用四次双阱势 $U(x) = A(x^2 - 1)^2$，其极小值点在 $x = \\pm 1$，势垒在 $x = 0$。反应物阱是位于 $x_a = -1$ 的左侧极小值点，势垒顶部在 $x_b = 0$。\n- 扩散系数为 $D = \\theta/\\gamma$，逆温度为 $\\beta = 1/\\theta$。你计算出的速率必须以逆时间（无量纲）单位报告。\n\n解析比较：\n- 将你的数值流-布居数估计值 $k_{\\mathrm{num}}$ 与解析的过阻尼 Kramers 速率 $k_{\\mathrm{K}}$ 进行比较，该解析速率是通过对指定势在极小值点附近和势垒顶部附近进行谐波近似得到的。你必须首先推导用 $A$、$\\theta$ 和 $\\gamma$ 表示 $k_{\\mathrm{K}}$ 的适当解析表达式。\n\n数值方法说明：\n- 在 $[x_a, x_b] = [-1, 0]$ 上构建一个均匀网格。\n- 使用梯形法则来近似流-布居数形式中出现的所需积分（不要使用闭式解捷径）。确保数值稳定性，以适应高等研究生水平的科学计算。\n\n测试套件：\n- 对以下参数集 $(A, \\theta, \\gamma)$ 评估程序：\n    - 情况1：$A = 5.0$，$\\theta = 1.0$，$\\gamma = 10.0$。\n    - 情况2：$A = 2.0$，$\\theta = 1.0$，$\\gamma = 5.0$。\n    - 情况3：$A = 0.5$，$\\theta = 1.0$，$\\gamma = 10.0$。\n    - 情况4：$A = 2.0$，$\\theta = 2.0$，$\\gamma = 2.0$。\n- 对于每种情况，生成一个列表 $[k_{\\mathrm{num}}, k_{\\mathrm{K}}, \\varepsilon]$，其中 $k_{\\mathrm{num}}$ 是数值流-布居数速率估计值，$k_{\\mathrm{K}}$ 是解析的过阻尼 Kramers 速率，$\\varepsilon$ 是由 $\\varepsilon = \\lvert k_{\\mathrm{num}} - k_{\\mathrm{K}} \\rvert / k_{\\mathrm{K}}$ 定义的绝对相对误差。所有这三个量都必须是浮点数。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含一个由方括号括起来的、由逗号分隔的三元素列表组成的列表（例如，`[[r_{1,\\mathrm{num}}, r_{1,\\mathrm{K}}, r_{1,\\varepsilon}], [r_{2,\\mathrm{num}}, r_{2,\\mathrm{K}}, r_{2,\\varepsilon}], \\dots]`）。这些数字必须以逆时间（无量纲）单位表示。",
            "solution": "我们从一个反应坐标 $x(t)$ 在势 $U(x)$ 中、温度为 $T$、摩擦系数为 $\\gamma$ 时的朗之万方程的过阻尼极限开始。在此处采用的无量纲单位中，玻尔兹曼常数设为 $k_{\\mathrm{B}} = 1$，因此扩散系数为 $D = \\theta/\\gamma$，其中 $\\theta$ 表示温度，逆温度为 $\\beta = 1/\\theta$。该动力学由关于概率密度 $p(x,t)$ 的斯莫鲁霍夫斯基-福克-普朗克方程（FPE）描述：\n$$\n\\frac{\\partial p(x,t)}{\\partial t} = D \\frac{\\partial}{\\partial x}\\left[\\frac{\\partial p(x,t)}{\\partial x} + \\beta U'(x) p(x,t)\\right].\n$$\n与此 FPE 相关的概率流密度 $j(x,t)$ 为\n$$\nj(x,t) = -D \\left[\\frac{\\partial p(x,t)}{\\partial x} + \\beta U'(x) p(x,t)\\right].\n$$\n在具有微小恒定电流和适当边界条件的稳态区域，流-布居数方法将速率常数 $k$ 定义为跨越势垒的稳态电流除以反应物区域内的布居数：\n$$\nk = \\frac{J}{N}.\n$$\n对于在反射边界 $x_a$ 和吸收边界 $x_b$ 之间的一维越垒过程，流-布居数方法等价于平均首达时间（MFPT）的倒数。具体来说，从初始位置 $x$ 到在 $x_b$ 处被吸收（在 $x_a$ 处有反射边界）的 MFPT $T(x)$ 满足从斯莫鲁霍夫斯基算子得到的后向福克-普朗克（或后向柯尔莫哥洛夫）方程：\n$$\n- D e^{\\beta U(x)} \\frac{d}{dx}\\left( e^{-\\beta U(x)} \\frac{dT(x)}{dx} \\right) = 1,\n$$\n服从边界条件\n$$\n\\frac{dT}{dx}\\bigg|_{x=x_a} = 0 \\quad \\text{(reflecting)}, \\qquad T(x_b) = 0 \\quad \\text{(absorbing)}.\n$$\n对该常微分方程应用给定边界条件进行积分，得到从反射边界 $x_a$ 到吸收边界 $x_b$ 的 MFPT 的一个著名积分表示：\n$$\nT(x_a) = \\frac{1}{D} \\int_{x_a}^{x_b} dy \\, e^{\\beta U(y)} \\int_{x_a}^{y} dz \\, e^{-\\beta U(z)}.\n$$\n那么，流-布居数速率估计值为\n$$\nk_{\\mathrm{num}} = \\frac{1}{T(x_a)}.\n$$\n我们将使用梯形法则在均匀网格上数值计算 $T(x_a)$，以保证稳定性和准确性：\n- 在 $[x_a, x_b]$ 上构建一个网格 $\\{x_i\\}_{i=0}^{n-1}$，其中 $x_0 = x_a$ 且 $x_{n-1} = x_b$。\n- 计算 $U(x_i)$，然后计算数组 $w_-(x_i) = e^{-\\beta U(x_i)}$ 和 $w_+(x_i) = e^{\\beta U(x_i)}$。\n- 通过累积梯形法则计算累积积分 $S(y) = \\int_{x_a}^{y} e^{-\\beta U(z)} dz$：\n$$\nS(x_0) = 0, \\quad S(x_i) = S(x_{i-1}) + \\frac{1}{2}\\left[w_-(x_{i}) + w_-(x_{i-1})\\right]\\left(x_i - x_{i-1}\\right).\n$$\n- 构建被积函数 $G(y) = e^{\\beta U(y)} S(y)$，并使用梯形法则计算外层积分：\n$$\n\\int_{x_a}^{x_b} G(y) \\, dy \\approx \\sum_{i=1}^{n-1} \\frac{1}{2}\\left[G(x_i) + G(x_{i-1})\\right]\\left(x_i - x_{i-1}\\right).\n$$\n- 乘以 $1/D$ 得到 $T(x_a)$，然后取倒数得到 $k_{\\mathrm{num}}$。\n\n我们现在推导针对特定四次双阱势的解析过阻尼 Kramers 速率\n$$\nU(x) = A(x^2 - 1)^2,\n$$\n其极小值点在 $x = \\pm 1$，势垒在 $x = 0$。左侧反应物阱位于 $x_a = -1$，势垒顶部位于 $x_b = 0$，势垒高度为\n$$\n\\Delta U = U(x_b) - U(x_a) = A - 0 = A.\n$$\n过阻尼 Kramers 速率公式源于高势垒极限下对斯莫鲁霍夫斯基 FPE 的匹配渐近分析，其中在势阱极小值点和势垒顶部附近使用了谐波近似。过阻尼 Kramers 速率常数为\n$$\nk_{\\mathrm{K}} = \\frac{\\beta D}{2\\pi} \\sqrt{U''(x_a)\\left|U''(x_b)\\right|} \\, e^{-\\beta \\Delta U}.\n$$\n在我们的无量纲单位中，$\\beta D = (1/\\theta) \\cdot (\\theta/\\gamma) = 1/\\gamma$，因此\n$$\nk_{\\mathrm{K}} = \\frac{1}{2\\pi \\gamma} \\sqrt{U''(x_a)\\left|U''(x_b)\\right|} \\, e^{-A/\\theta}.\n$$\n我们计算四次双阱势的二阶导数：\n$$\nU'(x) = 4A x(x^2 - 1), \\quad U''(x) = 4A(3x^2 - 1).\n$$\n因此，\n$$\nU''(x_a) = U''(-1) = 4A(3\\cdot 1 - 1) = 8A, \\qquad U''(x_b) = U''(0) = 4A(0 - 1) = -4A,\n$$\n以及\n$$\n\\sqrt{U''(x_a)\\left|U''(x_b)\\right|} = \\sqrt{8A \\cdot 4A} = \\sqrt{32} \\, A.\n$$\n因此，该势的解析过阻尼 Kramers 速率为\n$$\nk_{\\mathrm{K}} = \\frac{\\sqrt{32} \\, A}{2\\pi \\gamma} \\, e^{-A/\\theta}.\n$$\n\n每个测试用例的算法步骤：\n- 设置 $x_a = -1$，$x_b = 0$，构建一个具有足够多点的均匀网格以控制积分误差。\n- 计算 $U(x)$、$w_-(x) = e^{-\\beta U(x)}$、累积积分 $S(y)$、被积函数 $G(y) = e^{\\beta U(y)} S(y)$，并通过梯形法则计算外层积分。\n- 计算 $T(x_a) = \\frac{1}{D} \\int_{x_a}^{x_b} G(y) \\, dy$ 和 $k_{\\mathrm{num}} = 1/T(x_a)$。\n- 计算 $k_{\\mathrm{K}} = \\frac{\\sqrt{32} A}{2\\pi \\gamma} e^{-A/\\theta}$。\n- 计算绝对相对误差 $\\varepsilon = \\lvert k_{\\mathrm{num}} - k_{\\mathrm{K}} \\rvert / k_{\\mathrm{K}}$。\n\n测试套件和输出：\n- 情况1：$A = 5.0$，$\\theta = 1.0$，$\\gamma = 10.0$ 测试高势垒和高摩擦（完全在过阻尼 Kramers 机制范围内）。\n- 情况2：$A = 2.0$，$\\theta = 1.0$，$\\gamma = 5.0$ 测试中等势垒和中等摩擦。\n- 情况3：$A = 0.5$，$\\theta = 1.0$，$\\gamma = 10.0$ 测试低势垒，此时渐近的 Kramers 准确性受限。\n- 情况4：$A = 2.0$，$\\theta = 2.0$，$\\gamma = 2.0$ 测试更高温度和更低摩擦（仍为过阻尼），以探究对 $\\theta$ 和 $\\gamma$ 的敏感性。\n\n程序将为所有情况输出单行，包含一个由列表组成的逗号分隔列表 $[[k_{\\mathrm{num}}, k_{\\mathrm{K}}, \\varepsilon], \\dots]$，单位为逆时间（无量纲）。数值稳定性通过均匀网格上的梯形积分和对限制在区间 $[x_a, x_b]$ 上的指数函数的谨慎求值来管理。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_rate_flux_over_population(A: float, theta: float, gamma: float, n_grid: int = 20001):\n    \"\"\"\n    Compute the flux-over-population rate for U(x) = A*(x^2 - 1)^2\n    using a uniform grid and trapezoidal quadrature on [x_a, x_b] = [-1, 0].\n    \"\"\"\n    # Boundaries: reactant minimum (reflecting) and barrier top (absorbing)\n    xa = -1.0\n    xb = 0.0\n\n    # Thermal parameters in dimensionless units: k_B = 1\n    beta = 1.0 / theta\n    D = theta / gamma  # Smoluchowski diffusion coefficient\n\n    # Uniform grid\n    x = np.linspace(xa, xb, n_grid)\n    dx = x[1] - x[0]\n\n    # Potential and exponentials\n    U = A * (x**2 - 1.0)**2\n    w_minus = np.exp(-beta * U)  # e^{-beta U(x)}\n    w_plus = np.exp(beta * U)    # e^{+beta U(x)}\n\n    # Cumulative trapezoidal integration for S(y) = \\int_{xa}^{y} e^{-beta U(z)} dz\n    S = np.zeros_like(x)\n    # S[0] = 0 by definition\n    # Iteratively accumulate with trapezoidal rule\n    for i in range(1, n_grid):\n        S[i] = S[i-1] + 0.5 * (w_minus[i] + w_minus[i-1]) * (x[i] - x[i-1])\n\n    # Outer integrand G(y) = e^{beta U(y)} * S(y)\n    G = w_plus * S\n\n    # Trapezoidal integration for outer integral \\int_{xa}^{xb} G(y) dy\n    integral_outer = np.sum(0.5 * (G[1:] + G[:-1]) * (x[1:] - x[:-1]))\n\n    # Mean first passage time T(xa)\n    T = (1.0 / D) * integral_outer\n\n    # Numerical rate\n    k_num = 1.0 / T\n    return k_num\n\ndef compute_kramers_overdamped_rate(A: float, theta: float, gamma: float):\n    \"\"\"\n    Analytic overdamped Kramers rate for U(x) = A*(x^2 - 1)^2:\n    k_K = (sqrt(32) * A / (2*pi*gamma)) * exp(-A/theta)\n    \"\"\"\n    sqrt32 = np.sqrt(32.0)\n    kK = (sqrt32 * A) / (2.0 * np.pi * gamma) * np.exp(-A / theta)\n    return kK\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (A, theta, gamma)\n    test_cases = [\n        (5.0, 1.0, 10.0),  # Case 1: high barrier, high friction\n        (2.0, 1.0, 5.0),   # Case 2: moderate barrier, moderate friction\n        (0.5, 1.0, 10.0),  # Case 3: low barrier\n        (2.0, 2.0, 2.0),   # Case 4: higher temperature, lower friction\n    ]\n\n    results = []\n    for A, theta, gamma in test_cases:\n        # Compute numerical flux-over-population rate\n        k_num = compute_rate_flux_over_population(A=A, theta=theta, gamma=gamma, n_grid=20001)\n\n        # Compute analytic overdamped Kramers rate\n        k_kramers = compute_kramers_overdamped_rate(A=A, theta=theta, gamma=gamma)\n\n        # Absolute relative error\n        # Handle the case where k_kramers might be extremely small; if zero, set error to np.inf.\n        if k_kramers == 0.0:\n            rel_err = float('inf')\n        else:\n            rel_err = abs(k_num - k_kramers) / k_kramers\n\n        results.append([k_num, k_kramers, rel_err])\n\n    # Format the output as a single-line, comma-separated list of lists without spaces.\n    def format_results(res):\n        def fmt_triplet(t):\n            return \"[\" + \",\".join(f\"{v:.10g}\" for v in t) + \"]\"\n        return \"[\" + \",\".join(fmt_triplet(t) for t in res) + \"]\"\n\n    print(format_results(results))\n\nsolve()\n```"
        }
    ]
}