{
    "hands_on_practices": [
        {
            "introduction": "任何分子动力学（包括第一性原理分子动力学）模拟的准确性和稳定性都从根本上取决于时间步长 $\\Delta t$ 的选择。本练习将引导你通过分析系统中的最高频振动，为广泛使用的速度-Verlet算法推导其稳定性极限。这是设置任何模拟时至关重要的第一步。",
            "id": "4090896",
            "problem": "在计算地球化学中，对含水体系进行经典分子动力学 (MD) 和第一性原理分子动力学 (AIMD) 模拟时，都必须解析最快的振动，以确保稳定和精确的时间积分。考虑一个无约束的氧-氢键伸缩，它被建模为一个一维谐振子，其位移为 $x(t)$，角频率为 $\\omega$，并遵循牛顿第二定律。其轨迹使用速度-Verlet格式进行积分。\n\n从牛顿第二定律和谐振子的定义出发，并利用速度-Verlet方法固有的中心差分结构，推导出将时间步长 $\\Delta t$ 与系统中存在的最高振动角频率 $\\omega_{\\max}$ 联系起来的线性稳定性约束。然后，对于液态水中波数为 $\\bar{\\nu} = 3600\\ \\mathrm{cm}^{-1}$ 的典型O–H伸缩振动模式，估算一个推荐的时间步长 $\\Delta t_{\\mathrm{rec}}$，使得每个振动周期至少有 $N = 20$ 个数据点。取光速为 $c = 2.99792458 \\times 10^{10}\\ \\mathrm{cm}\\ \\mathrm{s}^{-1}$，并使用关系式 $\\omega = 2\\pi c \\bar{\\nu}$ 计算谐振角频率。\n\n将 $\\Delta t_{\\mathrm{rec}}$ 的最终数值答案以飞秒 (fs) 为单位表示，并将答案四舍五入到三位有效数字。只提供 $\\Delta t_{\\mathrm{rec}}$ 的值作为最终答案。",
            "solution": "该问题需要分两部分回答。首先，我们必须推导应用于一维谐振子的速度-Verlet积分算法的线性稳定性约束。其次，我们必须根据给定的分辨率标准，为特定的O-H伸缩振动模式计算一个推荐的积分时间步长。\n\n**第一部分：稳定性约束的推导**\n\n一维谐振子的运动方程由牛顿第二定律给出：\n$$m \\frac{d^2x}{dt^2} = -kx$$\n其中 $m$ 是质量，$x$ 是偏离平衡位置的位移，$k$ 是弹簧常数。这可以用角频率 $\\omega = \\sqrt{k/m}$ 表示为：\n$$\\frac{d^2x}{dt^2} = -\\omega^2 x(t)$$\n在任意时间 $t$ 的加速度为 $a(t) = -\\omega^2 x(t)$。\n\n速度-Verlet算法是一种时间可逆的数值积分方法。为了进行稳定性分析，最方便的是使用其以位置为中心的形式，即所谓的Störmer-Verlet或蛙跳法。在离散时间步长 $t_n = n \\Delta t$ 处，位置 $x$ 的更新规则是：\n$$x(t + \\Delta t) = 2x(t) - x(t - \\Delta t) + a(t) \\Delta t^2$$\n令 $x_n = x(t_n) = x(n \\Delta t)$。有限差分方程变为：\n$$x_{n+1} = 2x_n - x_{n-1} + a_n \\Delta t^2$$\n代入谐振子的加速度表达式 $a_n = -\\omega^2 x_n$：\n$$x_{n+1} = 2x_n - x_{n-1} - \\omega^2 x_n \\Delta t^2$$\n整理各项，我们得到一个线性齐次递推关系：\n$$x_{n+1} - (2 - \\omega^2 \\Delta t^2) x_n + x_{n-1} = 0$$\n为分析此递推关系的稳定性，我们寻找形式为 $x_n = \\lambda^n$ 的解。将此试探解代入方程，得到关于 $\\lambda$ 的特征方程：\n$$\\lambda^{n+1} - (2 - \\omega^2 \\Delta t^2) \\lambda^n + \\lambda^{n-1} = 0$$\n假设存在非平凡解 ($\\lambda \\neq 0$)，我们用 $\\lambda^{n-1}$ 除等式两边：\n$$\\lambda^2 - (2 - \\omega^2 \\Delta t^2) \\lambda + 1 = 0$$\n为使数值解是稳定的，轨迹不能指数增长。这要求特征方程的根 $\\lambda$ 的模必须小于或等于1，即 $|\\lambda| \\le 1$。对于振荡系统，根必须是位于复平面单位圆上的一对共轭复数，这意味着 $|\\lambda| = 1$。这种情况发生在二次方程的判别式为负或零时：\n$$\\Delta = [-(2 - \\omega^2 \\Delta t^2)]^2 - 4(1)(1) \\le 0$$\n$$(2 - \\omega^2 \\Delta t^2)^2 \\le 4$$\n对两边取平方根，我们得到：\n$$|2 - \\omega^2 \\Delta t^2| \\le 2$$\n这个不等式等价于两个条件：\n$$-2 \\le 2 - \\omega^2 \\Delta t^2 \\le 2$$\n我们分别分析每个不等式。\n1. 右侧不等式：$2 - \\omega^2 \\Delta t^2 \\le 2 \\implies -\\omega^2 \\Delta t^2 \\le 0$。由于 $\\omega > 0$ 且 $\\Delta t > 0$，此条件始终满足。\n2. 左侧不等式：$-2 \\le 2 - \\omega^2 \\Delta t^2 \\implies \\omega^2 \\Delta t^2 \\le 4$。\n\n由于 $\\omega$ 和 $\\Delta t$ 均为正数，我们可以取平方根得到稳定性条件：\n$$\\omega \\Delta t \\le 2$$\n对于包含多个振动模式的系统，积分时间步长 $\\Delta t$ 必须足够小，以解析最快的运动，这对应于最高的角频率 $\\omega_{\\max}$。因此，速度-Verlet算法的一般线性稳定性约束为：\n$$\\omega_{\\max} \\Delta t \\le 2$$\n\n**第二部分：推荐时间步长的计算**\n\n题目要求一个推荐的时间步长 $\\Delta t_{\\mathrm{rec}}$，使得每个振动周期 $T$ 至少有 $N = 20$ 个数据点。周期和角频率之间的关系是：\n$$T = \\frac{2\\pi}{\\omega}$$\n每个周期有 $N$ 个数据点的条件可转化为：\n$$N \\Delta t_{\\mathrm{rec}} = T$$\n求解 $\\Delta t_{\\mathrm{rec}}$：\n$$\\Delta t_{\\mathrm{rec}} = \\frac{T}{N} = \\frac{2\\pi}{N \\omega}$$\n题目给出了波数 $\\bar{\\nu} = 3600\\ \\mathrm{cm}^{-1}$ 以及角频率和波数之间的关系：\n$$\\omega = 2\\pi c \\bar{\\nu}$$\n其中 $c$ 是光速。将 $\\omega$ 的这个表达式代入 $\\Delta t_{\\mathrm{rec}}$ 的方程中，得到：\n$$\\Delta t_{\\mathrm{rec}} = \\frac{2\\pi}{N (2\\pi c \\bar{\\nu})} = \\frac{1}{N c \\bar{\\nu}}$$\n现在，我们代入给定的数值：\n$N = 20$\n$c = 2.99792458 \\times 10^{10}\\ \\mathrm{cm}\\ \\mathrm{s}^{-1}$\n$\\bar{\\nu} = 3600\\ \\mathrm{cm}^{-1}$\n\n$$\\Delta t_{\\mathrm{rec}} = \\frac{1}{20 \\times (2.99792458 \\times 10^{10}\\ \\mathrm{cm}\\ \\mathrm{s}^{-1}) \\times (3600\\ \\mathrm{cm}^{-1})}$$\n$$\\Delta t_{\\mathrm{rec}} = \\frac{1}{2.1585056976 \\times 10^{15}\\ \\mathrm{s}^{-1}}$$\n$$\\Delta t_{\\mathrm{rec}} \\approx 4.63283 \\times 10^{-16}\\ \\mathrm{s}$$\n题目要求结果以飞秒 (fs) 为单位，其中 $1\\ \\mathrm{fs} = 10^{-15}\\ \\mathrm{s}$。\n$$\\Delta t_{\\mathrm{rec}} \\approx 0.463283 \\times 10^{-15}\\ \\mathrm{s} = 0.463283\\ \\mathrm{fs}$$\n将结果四舍五入到三位有效数字，我们得到：\n$$\\Delta t_{\\mathrm{rec}} \\approx 0.463\\ \\mathrm{fs}$$\n\n这个推荐的时间步长得出 $\\omega \\Delta t_{\\mathrm{rec}} = (2\\pi c \\bar{\\nu}) (\\frac{1}{N c \\bar{\\nu}}) = \\frac{2\\pi}{N} = \\frac{2\\pi}{20} = \\frac{\\pi}{10} \\approx 0.314$，这完全在稳定性极限 $\\omega \\Delta t \\le 2$ 的范围内。",
            "answer": "$$\\boxed{0.463}$$"
        },
        {
            "introduction": "在第一性原理分子动力学中，计算压力等物理性质需要特别小心。本练习探讨了从维里定理和热力学关系推导出的压力之间的微妙而关键的差异，并阐明了必须如何引入“Pulay应力”——一种由原子中心基组不完备性产生的修正项——来协调这两种定义。对于使用许多量子化学程序获得准确结果而言，这是一项关键技能。",
            "id": "3437092",
            "problem": "考虑一个通过从头算分子动力学（MD）模拟的系统，其瞬时压力可以由维里定理或亥姆霍兹自由能的热力学积分来定义。目标是比较由维里表达式导出的压力与通过亥姆霍兹自由能对体积的导数获得的压力，同时考虑由基组不完备性引起的Pulay应力修正。分析仅限于各向同性形变，因此应力张量与单位矩阵成正比。所有结果必须以吉帕斯卡（GPa）表示。\n\n从以下基本原理开始：\n\n- 牛顿第二定律，对于粒子集合，它导出了维里定理。对于具有各向同性应力的经典系统，压力由维里定义为 $P_{\\mathrm{vir}} = \\dfrac{N k_{\\mathrm{B}} T}{V} + \\dfrac{W}{3 V}$，其中 $N$ 是粒子数，$k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是绝对温度，$V$ 是体积，$W$ 是位形维里 $W = \\sum_i \\mathbf{r}_i \\cdot \\mathbf{f}_i$。\n- 在平衡统计力学中，压力也由热力学关系 $P = -\\left(\\dfrac{\\partial F}{\\partial V}\\right)_T$ 给出，其中 $F$ 是在固定温度 $T$ 下的亥姆霍兹自由能。\n- 在具有不完备基组的从头算MD中，自由能会产生一个依赖于体积的基组误差 $\\delta E(V)$，对于各向同性形变，相关的Pulay压力为 $p_{\\mathrm{Pulay}} = -\\dfrac{\\mathrm{d}\\,\\delta E}{\\mathrm{d}V}$。如果在计算力时没有包含Pulay修正，则必须将此Pulay项加到维里压力上，以协调维里定义和热力学定义。\n\n为您提供了一个在各向同性缩放下真实亥姆霍兹自由能和基组误差的参数模型：\n$$F_{\\mathrm{true}}(V) = \\frac{A}{V} + B V + C,$$\n$$\\delta E(V) = \\frac{\\alpha}{V},$$\n其中 $A$（单位为 $\\mathrm{eV}\\cdot\\mathrm{\\AA}^3$）、$B$（单位为 $\\mathrm{eV}/\\mathrm{\\AA}^3$）和 $C$（单位为 $\\mathrm{eV}$）定义了真实的自由能，而 $\\alpha$（单位为 $\\mathrm{eV}\\cdot\\mathrm{\\AA}^3$）量化了基组的不完备性。用于热力学积分的总自由能为 $F_{\\mathrm{tot}}(V) = F_{\\mathrm{true}}(V) + \\delta E(V)$。\n\n对于每个测试用例，在中心体积 $V_0$ 处执行以下操作：\n\n1. 使用三个体积 $V_- = V_0 - \\Delta V$、$V_0$ 和 $V_+ = V_0 + \\Delta V$，通过 $F_{\\mathrm{tot}}(V)$ 的二阶中心有限差分计算热力学压力 $P_{\\mathrm{TI}}(V_0)$：\n$$P_{\\mathrm{TI}}(V_0) = -\\frac{F_{\\mathrm{tot}}(V_+) - F_{\\mathrm{tot}}(V_-)}{2 \\Delta V}.$$\n2. 计算 $V_0$ 处的解析真实压力（不包括基组误差）：\n$$P_{\\mathrm{true}}(V_0) = -\\left.\\frac{\\partial F_{\\mathrm{true}}}{\\partial V}\\right|_{V_0} = \\frac{A}{V_0^2} - B.$$\n3. 构建通过维里关系产生解析真实压力的Hellmann-Feynman维里 $W_{\\mathrm{HF}}$：\n$$W_{\\mathrm{HF}} = 3 V_0 P_{\\mathrm{true}}(V_0) - 3 N k_{\\mathrm{B}} T,$$\n然后计算\n$$P_{\\mathrm{vir,HF}}(V_0) = \\frac{N k_{\\mathrm{B}} T}{V_0} + \\frac{W_{\\mathrm{HF}}}{3 V_0}.$$\n4. 计算Pulay压力\n$$p_{\\mathrm{Pulay}}(V_0) = -\\left.\\frac{\\mathrm{d}\\,\\delta E}{\\mathrm{d}V}\\right|_{V_0} = \\frac{\\alpha}{V_0^2},$$\n以及经过Pulay修正的维里压力\n$$P_{\\mathrm{vir,corr}}(V_0) = P_{\\mathrm{vir,HF}}(V_0) + p_{\\mathrm{Pulay}}(V_0).$$\n5. 形成各向同性柯西应力张量 $\\boldsymbol{\\sigma}_{\\mathrm{TI}} = -P_{\\mathrm{TI}} \\mathbf{I}$、$\\boldsymbol{\\sigma}_{\\mathrm{vir,HF}} = -P_{\\mathrm{vir,HF}} \\mathbf{I}$ 和 $\\boldsymbol{\\sigma}_{\\mathrm{vir,corr}} = -P_{\\mathrm{vir,corr}} \\mathbf{I}$，其中 $\\mathbf{I}$ 是单位张量。计算应力差的弗罗贝尼乌斯范数：\n$$\\left\\|\\boldsymbol{\\sigma}_{\\mathrm{TI}} - \\boldsymbol{\\sigma}_{\\mathrm{vir,HF}}\\right\\|_{\\mathrm{F}} = \\sqrt{3}\\,\\left|P_{\\mathrm{TI}} - P_{\\mathrm{vir,HF}}\\right|,$$\n$$\\left\\|\\boldsymbol{\\sigma}_{\\mathrm{TI}} - \\boldsymbol{\\sigma}_{\\mathrm{vir,corr}}\\right\\|_{\\mathrm{F}} = \\sqrt{3}\\,\\left|P_{\\mathrm{TI}} - P_{\\mathrm{vir,corr}}\\right|.$$\n\n使用 $k_{\\mathrm{B}} = 8.617333262 \\times 10^{-5}$ $\\mathrm{eV}/\\mathrm{K}$ 和转换因子 $1$ $\\mathrm{eV}/\\mathrm{\\AA}^3 = 160.21766208$ $\\mathrm{GPa}$。所有压力和应力范数都必须以GPa报告。\n\n测试套件。对于每种情况，参数以 $(N, T, A, B, C, \\alpha, V_0, \\Delta V)$ 的形式给出：\n- 情况1（完备基组，基准一致性）：$(N=\\;32,\\, T=\\;300,\\, A=\\;1000,\\, B=\\;0.02,\\, C=\\;0,\\, \\alpha=\\;0,\\, V_0=\\;100,\\, \\Delta V=\\;5)$。\n- 情况2（中等基组不完备性）：$(N=\\;32,\\, T=\\;300,\\, A=\\;1000,\\, B=\\;0.02,\\, C=\\;0,\\, \\alpha=\\;200,\\, V_0=\\;100,\\, \\Delta V=\\;5)$。\n- 情况3（小体积，显著的Pulay应力）：$(N=\\;24,\\, T=\\;300,\\, A=\\;300,\\, B=\\;0.01,\\, C=\\;0,\\, \\alpha=\\;50,\\, V_0=\\;20,\\, \\Delta V=\\;1)$。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。对于按所列顺序的每个测试用例，附加以下五个以GPa为单位的浮点数量：\n$[P_{\\mathrm{TI}},\\, P_{\\mathrm{vir,HF}},\\, P_{\\mathrm{vir,corr}},\\, \\left\\|\\boldsymbol{\\sigma}_{\\mathrm{TI}} - \\boldsymbol{\\sigma}_{\\mathrm{vir,HF}}\\right\\|_{\\mathrm{F}},\\, \\left\\|\\boldsymbol{\\sigma}_{\\mathrm{TI}} - \\boldsymbol{\\sigma}_{\\mathrm{vir,corr}}\\right\\|_{\\mathrm{F}}]$。\n将所有三种情况的结果聚合到一个扁平列表中。最终打印必须与此确切格式匹配。",
            "solution": "求解过程通过系统地为每个测试用例计算所要求的量来进行，并遵循所提供的物理原理和数学公式。\n\n核心量是压力，其定义如下：\n- 来自热力学积分的热力学压力 $P_{\\mathrm{TI}}$，是使用总亥姆霍兹自由能 $F_{\\mathrm{tot}}(V)$ 的二阶中心有限差分来估计的。\n- “真实”压力 $P_{\\mathrm{true}}$ 是真实自由能 $F_{\\mathrm{true}}(V)$ 的解析导数。\n- Hellmann-Feynman维里压力 $P_{\\mathrm{vir,HF}}$ 是使用不包括基组相关（Pulay）修正的力，通过维里定理计算出的压力。根据本问题的构造，它等于 $P_{\\mathrm{true}}$。\n- 经过Pulay修正的维里压力 $P_{\\mathrm{vir,corr}}$ 是Hellmann-Feynman维里压力和Pulay压力 $p_{\\mathrm{Pulay}}$ 的和，后者解释了基组的不完备性。\n\n提供的能量参数形式为：\n$$F_{\\mathrm{true}}(V) = \\frac{A}{V} + B V + C$$\n$$\\delta E(V) = \\frac{\\alpha}{V}$$\n总亥姆霍兹自由能是它们的和：\n$$F_{\\mathrm{tot}}(V) = F_{\\mathrm{true}}(V) + \\delta E(V) = \\frac{A + \\alpha}{V} + B V + C$$\n\n让我们推导压力的解析表达式。\n\n1.  **热力学压力, $P_{\\mathrm{TI}}(V_0)$**：\n    压力由中心有限差分近似：\n    $$P_{\\mathrm{TI}}(V_0) = -\\frac{F_{\\mathrm{tot}}(V_0 + \\Delta V) - F_{\\mathrm{tot}}(V_0 - \\Delta V)}{2 \\Delta V}$$\n    代入 $F_{\\mathrm{tot}}(V)$ 的表达式：\n    $$P_{\\mathrm{TI}}(V_0) = -\\frac{1}{2 \\Delta V} \\left[ \\left(\\frac{A+\\alpha}{V_0+\\Delta V} + B(V_0+\\Delta V)\\right) - \\left(\\frac{A+\\alpha}{V_0-\\Delta V} + B(V_0-\\Delta V)\\right) \\right]$$\n    简化代数运算可得：\n    $$P_{\\mathrm{TI}}(V_0) = -\\frac{1}{2 \\Delta V} \\left[ (A+\\alpha)\\left(\\frac{-2\\Delta V}{(V_0)^2 - (\\Delta V)^2}\\right) + B(2\\Delta V) \\right]$$\n    $$P_{\\mathrm{TI}}(V_0) = \\frac{A+\\alpha}{(V_0)^2 - (\\Delta V)^2} - B$$\n    该表达式表明，与 $V_0$ 处的真实解析导数相比，二阶有限差分引入了与 $(\\Delta V)^2$ 成正比的离散化误差。\n\n2.  **真实压力和Hellmann-Feynman维里压力, $P_{\\mathrm{vir,HF}}(V_0)$**：\n    问题要求首先计算解析真实压力：\n    $$P_{\\mathrm{true}}(V_0) = -\\left.\\frac{\\partial F_{\\mathrm{true}}}{\\partial V}\\right|_{V=V_0} = -\\left( -\\frac{A}{V^2} + B \\right)_{V=V_0} = \\frac{A}{(V_0)^2} - B$$\n    Hellmann-Feynman维里压力 $P_{\\mathrm{vir,HF}}(V_0)$ 被构造成等于此真实压力。通过分解为动能项和维里项，$P_{\\mathrm{vir,HF}}(V_0) = \\frac{N k_{\\mathrm{B}} T}{V_0} + \\frac{W_{\\mathrm{HF}}}{3 V_0}$，其中 $W_{\\mathrm{HF}}$ 被特别定义为 $W_{\\mathrm{HF}} = 3 V_0 P_{\\mathrm{true}}(V_0) - 3 N k_{\\mathrm{B}} T$，这确保了 $P_{\\mathrm{vir,HF}}(V_0) = P_{\\mathrm{true}}(V_0)$。因此：\n    $$P_{\\mathrm{vir,HF}}(V_0) = \\frac{A}{(V_0)^2} - B$$\n\n3.  **Pulay压力和修正后的维里压力, $P_{\\mathrm{vir,corr}}(V_0)$**：\n    Pulay压力是基组误差能量 $\\delta E(V)$ 的解析导数：\n    $$p_{\\mathrm{Pulay}}(V_0) = -\\left.\\frac{\\mathrm{d}\\,\\delta E}{\\mathrm{d}V}\\right|_{V=V_0} = -\\left( -\\frac{\\alpha}{V^2} \\right)_{V=V_0} = \\frac{\\alpha}{(V_0)^2}$$\n    经过Pulay修正的维里压力是Hellmann-Feynman压力和Pulay压力的和：\n    $$P_{\\mathrm{vir,corr}}(V_0) = P_{\\mathrm{vir,HF}}(V_0) + p_{\\mathrm{Pulay}}(V_0) = \\left(\\frac{A}{(V_0)^2} - B\\right) + \\frac{\\alpha}{(V_0)^2} = \\frac{A+\\alpha}{(V_0)^2} - B$$\n    这正是总自由能 $F_{\\mathrm{tot}}$ 在 $V_0$ 处的解析导数，我们可以将其表示为 $P_{\\mathrm{tot, ana}}(V_0)$。这证实了添加Pulay项可以正确地协调维里压力和热力学压力，其差异仅在于有限差分法的离散化误差。\n\n4.  **应力差的弗罗贝尼乌斯范数**：\n    对于一个各向同性系统，其应力张量为 $\\boldsymbol{\\sigma} = -P \\mathbf{I}$（其中 $\\mathbf{I}$ 是 $3 \\times 3$ 单位矩阵），应力差的弗罗贝尼乌斯范数计算如下：\n    $$\\|\\boldsymbol{\\sigma}_1 - \\boldsymbol{\\sigma}_2\\|_{\\mathrm{F}} = \\|(-P_1 + P_2) \\mathbf{I}\\|_{\\mathrm{F}} = |P_2 - P_1| \\cdot \\|\\mathbf{I}\\|_{\\mathrm{F}} = |P_2 - P_1| \\sqrt{1^2+1^2+1^2} = \\sqrt{3}|P_2 - P_1|$$\n    我们将计算：\n    $$\\left\\|\\boldsymbol{\\sigma}_{\\mathrm{TI}} - \\boldsymbol{\\sigma}_{\\mathrm{vir,HF}}\\right\\|_{\\mathrm{F}} = \\sqrt{3}\\,\\left|P_{\\mathrm{TI}} - P_{\\mathrm{vir,HF}}\\right|$$\n    $$\\left\\|\\boldsymbol{\\sigma}_{\\mathrm{TI}} - \\boldsymbol{\\sigma}_{\\mathrm{vir,corr}}\\right\\|_{\\mathrm{F}} = \\sqrt{3}\\,\\left|P_{\\mathrm{TI}} - P_{\\mathrm{vir,corr}}\\right|$$\n\n所有压力计算首先以 $\\mathrm{eV}/\\mathrm{\\AA}^3$ 为基本单位进行，然后使用提供的转换因子 $1~\\mathrm{eV}/\\mathrm{\\AA}^3 = 160.21766208~\\mathrm{GPa}$ 转换为吉帕斯卡（GPa）。所有后续的量，包括范数，均以GPa报告。\n\n该过程使用推导出的解析关系应用于每个测试用例。\n- **情况1**：$(N=32, T=300, A=1000, B=0.02, C=0, \\alpha=0, V_0=100, \\Delta V=5)$\n- **情况2**：$(N=32, T=300, A=1000, B=0.02, C=0, \\alpha=200, V_0=100, \\Delta V=5)$\n- **情况3**：$(N=24, T=300, A=300, B=0.01, C=0, \\alpha=50, V_0=20, \\Delta V=1)$\n\n这些计算的结果被聚合成一个单一列表作为最终输出。计算结果突出表明，在存在基组不完备性（$\\alpha \\neq 0$）的情况下，未经修正的Hellmann-Feynman维里压力 $P_{\\mathrm{vir,HF}}$ 与热力学压力 $P_{\\mathrm{TI}}$ 有显著偏差，而经过Pulay修正的维里压力 $P_{\\mathrm{vir,corr}}$ 则表现出极好的一致性，其微小的残余差异可归因于对 $P_{\\mathrm{TI}}$ 的有限差分近似。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates various pressure definitions and stress differences for a model\n    system in ab initio Molecular Dynamics to demonstrate the effect of Pulay stress.\n    \"\"\"\n    \n    # Define physical constants.\n    # Boltzmann constant in eV/K\n    k_B = 8.617333262e-5\n    # Conversion factor from eV/Angstrom^3 to GPa\n    EV_A3_TO_GPA = 160.21766208\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (N, T, A, B, C, alpha, V0, dV)\n    test_cases = [\n        # Case 1 (complete basis, benchmark agreement)\n        (32, 300, 1000, 0.02, 0, 0, 100, 5),\n        # Case 2 (moderate basis-set incompleteness)\n        (32, 300, 1000, 0.02, 0, 200, 100, 5),\n        # Case 3 (small volume, pronounced Pulay stress)\n        (24, 300, 300, 0.01, 0, 50, 20, 1),\n    ]\n\n    all_results = []\n    for case in test_cases:\n        N, T, A, B, C, alpha, V0, dV = case\n        \n        # All pressures are first calculated in eV/A^3.\n\n        # 1. Compute the thermodynamic pressure P_TI(V0)\n        # Using the analytical form derived from the central difference of F_tot(V):\n        # P_TI(V0) = (A + alpha) / (V0^2 - dV^2) - B\n        P_TI_eV_A3 = (A + alpha) / (V0**2 - dV**2) - B\n\n        # 2. Compute the analytical true pressure P_true(V0), which is equivalent\n        #    to the Hellmann-Feynman virial pressure P_vir,HF(V0).\n        # P_true(V0) = A / V0^2 - B\n        P_vir_HF_eV_A3 = A / V0**2 - B\n        \n        # 3. Compute the Pulay pressure p_Pulay(V0)\n        # p_Pulay(V0) = alpha / V0^2\n        p_Pulay_eV_A3 = alpha / V0**2\n\n        # 4. Compute the Pulay-corrected virial pressure P_vir,corr(V0)\n        # P_vir,corr(V0) = P_vir,HF(V0) + p_Pulay(V0)\n        P_vir_corr_eV_A3 = P_vir_HF_eV_A3 + p_Pulay_eV_A3\n        \n        # Convert all pressure quantities to GPa\n        P_TI = P_TI_eV_A3 * EV_A3_TO_GPA\n        P_vir_HF = P_vir_HF_eV_A3 * EV_A3_TO_GPA\n        P_vir_corr = P_vir_corr_eV_A3 * EV_A3_TO_GPA\n\n        # 5. Compute the Frobenius norms of the stress differences.\n        # The stress tensor is sigma = -P * I, so the norm of the difference is\n        # ||sigma_1 - sigma_2||_F = sqrt(3) * |P_1 - P_2|\n        norm_diff_HF = np.sqrt(3) * abs(P_TI - P_vir_HF)\n        norm_diff_corr = np.sqrt(3) * abs(P_TI - P_vir_corr)\n        \n        # Append the five required quantities for this case to the results list.\n        all_results.extend([P_TI, P_vir_HF, P_vir_corr, norm_diff_HF, norm_diff_corr])\n\n    # Format the final output as a comma-separated list in brackets.\n    # Using 'g' for general format to avoid forcing scientific notation on small numbers\n    # and to provide sufficient precision.\n    formatted_results = [f\"{val:.12g}\" for val in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "标准的第一性原理分子动力学将原子核视为经典粒子，但对于氢等轻原子，零点能等量子效应至关重要。这项高级练习将展示如何使用路径积分分子动力学（PIMD）形式论来扩展FPMD以包含这些效应。你将学习如何估算收敛所需的“珠子”(beads)数量，并思考这给模拟设置带来的实际影响。",
            "id": "2759518",
            "problem": "一个温度为 $T = 300\\,\\mathrm{K}$ 的氢键分子体系，其最高的相关分子内振动模式为 O–H 伸缩振动，波数为 $\\tilde{\\nu}_{\\max} = 3300\\,\\mathrm{cm}^{-1}$。您希望在一个从头算分子动力学 (AIMD) 框架内，使用路径积分分子动力学 (PIMD) 来包含零点能水平的核量子效应。\n\n从角频率为 $\\omega$ 的谐振子的量子正则配分函数的虚时路径积分表示，以及将其离散化为 $P$ 个时间片的 Trotter 分解出发，推导出一个关于 Trotter 数 $P$ 的保守条件，以确保环状聚合物表示能够分辨在 $\\tilde{\\nu}_{\\max}$ 处最快振动模式的零点涨落。用 $P$、$\\beta = 1/(k_{B}T)$ 和 $\\omega_{\\max} = 2\\pi c\\,\\tilde{\\nu}_{\\max}$ 来表示您的条件，并确定对于给定的 $T$ 和 $\\tilde{\\nu}_{\\max}$，满足该条件的最小整数 $P$。使用恒等式 $\\hbar \\omega = h \\nu = h c \\tilde{\\nu}$ 和转换常数 $k_{B}/(h c) = 0.69503476\\,\\mathrm{cm}^{-1}\\,\\mathrm{K}^{-1}$。\n\n在您的推导中，还需提出一个与您的珠子数量一致的从头算分子动力学设置，在 Born–Oppenheimer 分子动力学 (BOMD) 和 Car–Parrinello 分子动力学 (CPMD) 之间做出选择，并根据在扩展的 PIMD 动力学中必须分辨的最大频率来估算一个稳定的时间步长。简要论证您为对量子正则系综进行采样所采用的恒温策略。最终答案仅报告所需的珠子数量 $P$。不要在最终答案中包含单位。最终答案无需四舍五入到特定有效数字；报告满足您推导出的标准的最小整数 $P$。",
            "solution": "一个哈密顿量为 $\\hat{H} = \\hat{T} + \\hat{V}$、逆温度为 $\\beta = 1/(k_{B}T)$ 的体系，其量子正则配分函数 $Z$ 为 $Z = \\text{Tr}[\\exp(-\\beta \\hat{H})]$。路径积分形式依赖于玻尔兹曼算符的 Trotter 分解：\n$$\n\\exp(-\\beta \\hat{H}) = \\left[ \\exp\\left(-\\frac{\\beta}{P} \\hat{H}\\right) \\right]^P \\approx \\left[ \\exp\\left(-\\frac{\\beta \\hat{V}}{2P}\\right) \\exp\\left(-\\frac{\\beta \\hat{T}}{P}\\right) \\exp\\left(-\\frac{\\beta \\hat{V}}{2P}\\right) \\right]^P\n$$\n这种分解会引入一个误差，该误差仅在指数的自变量 $(\\beta/P)\\hat{H}$ 在某种意义上“很小”时才可忽略不计。体系的能量标度由其最高频率模式 $\\omega_{\\max}$ 决定。特征能量为 $\\hbar \\omega_{\\max}$。因此，为了使 Trotter 近似有效，无量纲量 $(\\beta/P) \\hbar \\omega_{\\max}$ 必须远小于1。这导出了一个保守条件：\n$$\n\\frac{\\beta \\hbar \\omega_{\\max}}{P} \\le 1 \\implies P \\ge \\beta \\hbar \\omega_{\\max}\n$$\n该条件确保了虚时间步长 $\\Delta\\tau = \\hbar\\beta/P$ 小于最快量子振荡的特征时间尺度 $1/\\omega_{\\max}$。满足此标准对于离散化的环状聚合物表示能否精确捕捉由最高频率模式的零点运动主导的量子力学离域至关重要。\n\n我们现在必须计算在给定系统参数下满足此条件的最小整数值 $P$。所需的量是 $\\beta \\hbar \\omega_{\\max}$。我们可以使用给定的常数来表示它：\n$$\n\\beta \\hbar \\omega_{\\max} = \\frac{1}{k_B T} \\cdot \\hbar \\cdot (2\\pi c \\tilde{\\nu}_{\\max}) = \\frac{1}{k_B T} \\cdot \\frac{h}{2\\pi} \\cdot (2\\pi c \\tilde{\\nu}_{\\max}) = \\frac{h c \\tilde{\\nu}_{\\max}}{k_B T}\n$$\n这可以计算为：\n$$\n\\beta \\hbar \\omega_{\\max} = \\frac{\\tilde{\\nu}_{\\max}}{T \\cdot (k_B / (hc))}\n$$\n代入给定值：\n$$\n\\beta \\hbar \\omega_{\\max} = \\frac{3300\\,\\mathrm{cm}^{-1}}{300\\,\\mathrm{K} \\cdot 0.69503476\\,\\mathrm{cm}^{-1}\\,\\mathrm{K}^{-1}} = \\frac{3300}{208.510428} \\approx 15.8265\n$$\n因此，关于 Trotter 数 $P$ 的条件是 $P \\ge 15.8265$。由于 $P$ 必须是整数，所需的最小珠子数量是 $P=16$。\n\n对于从头算 PIMD 设置，必须在 Born-Oppenheimer MD (BOMD) 和 Car-Parrinello MD (CPMD) 之间进行选择。在 AI-PIMD 中，每个珠子的势能都是通过电子结构计算动态计算出来的。基于 BOMD 的方法涉及在每个 MD 步骤中为 $P$ 个原子核构型中的每一个将电子波函数优化到基态。这在计算上要求很高，计算量随 $P$ 线性增加，但它很稳健且在概念上很直接。基于 CPMD 的方法则需要传播 $P$ 组虚拟电子自由度，而这些自由度必须与 $P$ 组原子核自由度保持绝热分离。这会带来严重的时间步长限制和复杂的稳定性挑战。因此，**Born–Oppenheimer 分子动力学 (BOMD)** 框架是 AI-PIMD 更为实用和稳定的选择。\n\n积分时间步长 $\\Delta t$ 的选择必须能够分辨模拟系统中的最高频率运动。在 PIMD 中，动力学是经典环状聚合物的动力学，其中珠子由谐波弹簧连接。这些弹簧的频率为 $\\omega_P = P/(\\hbar\\beta)$。自由环状聚合物的简正模式频率为 $\\Omega_k = 2\\omega_P \\sin(k\\pi/P)$，其中 $k=1, \\dots, P-1$。这些频率中的最高频率为 $\\Omega_{\\max} \\approx 2\\omega_P = 2P/(\\hbar\\beta)$。整个系统的频率为 $\\omega_k^{\\text{full}} = \\sqrt{\\omega_{\\text{phys}}^2 + \\Omega_k^2}$。因此，最高频率由环状聚合物的弹簧模式主导：$\\omega_{\\text{PIMD, max}} \\approx \\Omega_{\\max} = 2P/(\\hbar\\beta)$。这个最快运动的周期是 $T_{\\min} = 2\\pi / \\omega_{\\text{PIMD, max}} = \\pi\\hbar\\beta/P$。对于 $P=16$，我们有 $T_{\\min} = \\pi \\hbar\\beta / 16$。使用我们之前的结果，$\\hbar\\beta = (\\beta\\hbar\\omega_{\\max})/\\omega_{\\max} = 15.8265 / (2\\pi c \\tilde{\\nu}_{\\max}) \\approx 2.54 \\times 10^{-14}\\,\\mathrm{s}$，即 $25.4\\,\\mathrm{fs}$。因此，$T_{\\min} \\approx \\pi(25.4\\,\\mathrm{fs})/16 \\approx 5.0\\,\\mathrm{fs}$。一个稳定的积分要求时间步长 $\\Delta t$ 至少小一个数量级，因此一个合理的稳定时间步长估计值为 $\\Delta t \\approx 0.1 - 0.2\\,\\mathrm{fs}$。\n\n最后，关于恒温策略，众所周知，PIMD 系统存在严重的非各态历经性问题。应用于所有自由度的单个恒温器会失效，因为物理模式与环状聚合物的刚性、高频内部模式之间的能量交换极其缓慢。这会导致对正则系综的错误采样。为了确保所有模式的适当热化，需要一个专门的恒温器。最佳策略是为环状聚合物的每个简正模式应用一个单独的恒温器。**路径积分 Nosé-Hoover 链 (PI-NHC)** 恒温器是用于此目的的标准且稳健的方法。它通过单独热化每个简正模式来保证正确的正则采样，从而克服各态历经性问题。另外，配置得当的广义朗之万方程 (GLE) 恒温器也可以非常有效。",
            "answer": "$$\n\\boxed{16}\n$$"
        }
    ]
}