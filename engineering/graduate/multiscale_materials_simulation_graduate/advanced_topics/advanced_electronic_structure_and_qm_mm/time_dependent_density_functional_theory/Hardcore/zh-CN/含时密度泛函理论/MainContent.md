## 引言
物质与光的相互作用是自然界最基本的现象之一，从光合作用到现代光电器件，其核心都在于电子在光场驱动下的激发与动力学过程。然而，从第一性原理精确描述这些含时量子现象，需要求解极其复杂的含时[多体薛定谔方程](@entry_id:1127611)，这对于绝大多数真实体系而言是一项不可能完成的任务。为了在计算可行性与物理精确性之间取得平衡，发展高效而可靠的理论模型至关重要。[含时密度泛函理论](@entry_id:200019) (Time-Dependent Density Functional Theory, TDDFT) 正是在这一背景下应运而生，并迅速成为[计算化学](@entry_id:143039)、凝聚态物理和材料科学领域研究电子激发态性质的标准工具之一。

本文将系统性地引导读者深入理解TDDFT的理论与实践。我们将从其理论基石 Runge-Gross 定理出发，构建含时[科恩-沈方程](@entry_id:143968)，并详细剖析两种核心计算方法——[实时传播](@entry_id:199067)与[线性响应理论](@entry_id:145737)，同时审视[绝热近似](@entry_id:143074)这一关键瓶颈。接着，我们将通过丰富的实例，展示TDDFT如何被用于模拟分子光谱、揭示光[化学机理](@entry_id:185553)、设计新材料以及理解凝聚态体系中的[集体激发](@entry_id:145026)。最后，读者将有机会通过具体的编程练习，亲手实现TDDFT的核心算法，从而将理论知识转化为实践能力。

## 原理与机制

本章旨在深入阐述[含时密度泛函理论](@entry_id:200019) (Time-Dependent Density Functional Theory, TDDFT) 的核心原理与关键机制。我们将从其严格的理论基础出发，构建含时科恩-沈 (Kohn-Sham, KS) 方程体系，进而探讨两种主要的计算范式——[实时传播](@entry_id:199067)与线性响应理论。最后，我们将详细剖析[线性响应理论](@entry_id:145737)中的核心——卡西达 (Casida) 方程，并审视在实际应用中至关重要的[绝热近似](@entry_id:143074)及其局限性。

### 理论基石：Runge-Gross 定理与含时科恩-沈体系

[含时密度泛函理论](@entry_id:200019)的合法性建立在 **Runge-Gross (RG) 定理**之上。该定理是静态[密度泛函理论](@entry_id:139027)中 Hohenberg-Kohn 定理在时域上的推广。RG 定理为我们提供了一个深刻的结论：对于一个给定的多电子体系初始态 $\lvert \Psi_0 \rangle$，其随时间演化的电子密度 $n(\mathbf{r}, t)$ 与产生该演化的外部[标量势](@entry_id:276177) $v(\mathbf{r}, t)$ 之间存在[一一对应](@entry_id:143935)的映射关系，除非两者相差一个仅与时间相关的函数 $c(t)$ 。

具体而言，假设有两个不同的外部势 $v(\mathbf{r}, t)$ 和 $v'(\mathbf{r}, t)$，它们从同一个初始态 $\lvert \Psi_0 \rangle$ 出发，在一段时间内演化出完全相同的密度 $n(\mathbf{r}, t)$。那么，这两个势必定满足关系 $v'(\mathbf{r}, t) = v(\mathbf{r}, t) + c(t)$。这种自由度源于一个简单的物理事实：在[哈密顿量](@entry_id:144286)中增加一项 $c(t) \int \hat{n}(\mathbf{r}) d^3r = c(t)N$（其中 $N$ 是总电子数），只会给整个[多体波函数](@entry_id:203043)附加一个不依赖于空间坐标的相位因子 $\exp(-i N \int c(t') dt')$，而不会改变任何[物理可观测量](@entry_id:154692)，包括电子密度。该定理的原始证明要求外部势在时间上是解析的，即可以在初始时刻 $t_0$ 附近进行泰勒展开。这个看似技术性的要求，为通过比较密度的时间各阶导数来证明势的唯一性提供了可能。

RG 定理的重大意义在于，它保证了含时密度 $n(\mathbf{r}, t)$ 是一个基本的变量。原则上，体系的所有性质，包括[多体波函数](@entry_id:203043) $\lvert \Psi(t) \rangle$ 本身，都是初始态 $\lvert \Psi_0 \rangle$ 和密度历史 $n(\mathbf{r}, t')$ ($t' \le t$) 的泛函。这为我们绕过求解复杂的含时[多体薛定谔方程](@entry_id:1127611)，转而求解以密度为变量的更简单方程铺平了道路。

正是基于这一思想，TDDFT 构建了 **含时科恩-沈 (TDKS) 体系**。这是一个巧妙的理论构造：我们用一个虚构的、无相互作用的电子体系来代替真实的、存在相互作用的多电子体系。这个虚构体系被设计为在与真实体系相同的外部势下，能够精确地复制出真实体系的含时电子密度 $n(\mathbf{r}, t)$。由于无相互作用体系的[波函数](@entry_id:201714)可以精确地写为单个[斯莱特行列式](@entry_id:139034)，问题被极大地简化了。

这个虚构体系中每个电子（占据所谓的 **[科恩-沈轨道](@entry_id:171979)** $\phi_i(\mathbf{r}, t)$）的演化遵循一个单粒子薛定谔方程，即 **TDKS 方程** ：
$$
\mathrm{i} \frac{\partial}{\partial t} \phi_i(\mathbf{r}, t) = \left[ -\frac{1}{2}\nabla^2 + v_{\text{s}}(\mathbf{r}, t) \right] \phi_i(\mathbf{r}, t)
$$
其中，我们使用了[原子单位](@entry_id:166762) ($\hbar=m_e=e=1$)。这里的核心是有效的 **[科恩-沈势](@entry_id:169598)** $v_{\text{s}}(\mathbf{r}, t)$，它被分解为三部分：
$$
v_{\text{s}}(\mathbf{r}, t) = v_{\text{ext}}(\mathbf{r}, t) + v_{\text{H}}(\mathbf{r}, t) + v_{\text{xc}}(\mathbf{r}, t)
$$
1.  $v_{\text{ext}}(\mathbf{r}, t)$ 是真实体系所受到的外部势（例如来自原子核的吸引势和外加电场）。
2.  $v_{\text{H}}(\mathbf{r}, t)$ 是经典的 **哈特里 (Hartree) 势**，它描述了电子与由总电子密度 $n(\mathbf{r}, t)$ 产生的平均静电场的相互作用。它是一个瞬时密度泛函：
    $$
    v_{\text{H}}[n](\mathbf{r}, t) = \int \frac{n(\mathbf{r}', t)}{|\mathbf{r} - \mathbf{r}'|} d^3\mathbf{r}'
    $$
3.  $v_{\text{xc}}(\mathbf{r}, t)$ 是 **交换关联 (exchange-correlation, xc) 势**。这是一个“万有”项，其定义是为了弥补 TDKS 体系与真实体系之间的所有差异。这包括了无相互作用体系的动能与真实体系动能的差值，以及所有非经典的量子效应，如[泡利不相容原理](@entry_id:141850)（交换）和电子运动的动态关联。

TDKS 体系的[自洽性](@entry_id:160889)通过密度约束来保证：由 KS 轨道构建的密度必须等于体系的真实密度。
$$
n(\mathbf{r}, t) = \sum_i f_i |\phi_i(\mathbf{r}, t)|^2
$$
其中 $f_i$ 是轨道 $i$ 的占据数。

对于精确的理论而言，交换关联势 $v_{\text{xc}}$ 具有复杂的依赖关系。首先，它具有 **“记忆效应” (memory dependence)**，即在时刻 $t$ 的势 $v_{\text{xc}}(\mathbf{r}, t)$ 不仅依赖于该时刻的密度 $n(\mathbf{r}, t)$，还依赖于从初始时刻 $t_0$ 到当前时刻 $t$ 的整个密度演化历史 $n(\mathbf{r}, t')$ ($t_0 \le t' \le t$)。其次，它还显式地依赖于 **初始态** 。正如 RG 定理的唯一性映射是以固定的初始态为前提，精确的 $v_{\text{xc}}$ 泛函也必须依赖于真实相互作用体系的初始态 $\Psi_0$ 和我们为 KS 体系所选择的初始态 $\Phi_0$。因此，精确的交换关联势应写作 $v_{\text{xc}}[n, \Psi_0, \Phi_0](\mathbf{r}, t)$。在实际计算中，这种复杂的依赖性通常通过近似来处理，其中最著名的就是我们稍后将讨论的[绝热近似](@entry_id:143074)。

### 电子动力学的计算方法：[实时传播](@entry_id:199067)与[线性响应](@entry_id:146180)

有了 TDKS 方程这一理论工具，我们便可以通过两种主要计算范式来模拟电子动力学和激发性质。

#### [实时传播](@entry_id:199067) (Real-Time, RT) 方法

[实时传播](@entry_id:199067)方法是最直观的途径。它直接对 TDKS 方程进行数值积分，从初始时刻 $t_0$ 开始，一步步地求解 KS 轨道随时间的演化。为了探测体系的激发谱，通常在初始时刻对体系施加一个微扰，例如一个瞬时（$\delta$ 函数形式）的电[偶极场](@entry_id:269059)。这个“脉冲”可以看作是同时激发了所有频率的模式。随后，通过监测体系某个[可观测量](@entry_id:267133)随时间的演化，就可以提取出体系的响应信息。

最常被监测的量是体系的总[电偶极矩](@entry_id:178520) $\boldsymbol{\mu}(t)$ ：
$$
\boldsymbol{\mu}(t) = \int \mathbf{r} n(\mathbf{r}, t) d^3\mathbf{r}
$$
$\boldsymbol{\mu}(t)$ 的时间演化信号包含了体系所有光学允许的激发模式的[振荡频率](@entry_id:269468)和振幅。为了得到我们通常所见的[吸收光谱](@entry_id:144611)（即吸收强度随频率的分布），需要对 $\boldsymbol{\mu}(t)$ 进行傅里叶变换，从而得到频率依赖的动力学极化率 $\alpha(\omega)$，[吸收光谱](@entry_id:144611)则正比于 $\operatorname{Im}[\alpha(\omega)] \cdot \omega$。因此，[RT-TDDFT](@entry_id:198643) 的原始输出是时域信号 $\boldsymbol{\mu}(t)$，而频域光谱是后处理的结果。RT 方法的优势在于它可以自然地处理强场、[非线性](@entry_id:637147)和任意时变的外部势，是研究[超快动力学](@entry_id:164209)过程的有力工具。

#### 线性响应 (Linear-Response, LR) 理论

当外部势非常微弱时，我们可以采用线性响应理论，这是研究电子激发谱最常用的方法。LR-TDDFT 不在时域上直接求解 TDKS 方程，而是在频域中分析体系对微扰的线性响应。

其核心概念是 **密度[响应函数](@entry_id:142629)** $\chi(\mathbf{r}, \mathbf{r}', \omega)$。它描述了在频率为 $\omega$ 的外部势微扰 $\delta v_{\text{ext}}(\mathbf{r}', \omega)$ 作用下，体系在 $\mathbf{r}$ 处产生的密度响应 $\delta n(\mathbf{r}, \omega)$ ：
$$
\delta n(\mathbf{r}, \omega) = \int \chi(\mathbf{r}, \mathbf{r}', \omega) \delta v_{\text{ext}}(\mathbf{r}', \omega) d^3\mathbf{r}'
$$
物理上，$\chi$ 的极点 (poles) 对应于体系的真实中性[激发能](@entry_id:190368)。同样，我们可以定义 KS 体系的密度响应函数 $\chi_s$，它描述了无相互作用体系的密度对 *自身* [有效势](@entry_id:1124192) $v_s$ 微扰的响应。

LR-TDDFT 的关键在于，它通过一个类似于戴森 (Dyson) 的方程，将难以计算的真实响应函数 $\chi$ 与相对容易计算的 KS 响应函数 $\chi_s$ 联系起来：
$$
\chi = \chi_s + \chi_s \star (f_{\text{H}} + f_{\text{xc}}) \star \chi
$$
这里的 $\star$ 符号代表在空间和时间（或在频域中仅在空间）上的[卷积积分](@entry_id:155865)。方程中的两个核心是：
- **哈特里核 (Hartree kernel)** $f_{\text{H}}(\mathbf{r}, \mathbf{r}') = 1/|\mathbf{r} - \mathbf{r}'|$，它描述了密度响应引起的经典库仑相互作用。
- **交换关联核 (exchange-correlation kernel)** $f_{\text{xc}}(\mathbf{r}, \mathbf{r}', \omega) = \left. \frac{\delta v_{\text{xc}}(\mathbf{r}, \omega)}{\delta n(\mathbf{r}', \omega)} \right|_{n_0}$，它包含了所有非经典的交换与关联效应对响应的修正。

这个[戴森方程](@entry_id:146246)表明，真实的相互作用体系的响应，可以看作是无相互作用的 KS 体系的响应，再通过哈特里和交换关联相互作用进行“修正”或“屏蔽”的结果。求解这个方程，寻找 $\chi$ 的极点，便是 LR-TDDFT 计算[激发能](@entry_id:190368)的本质。

### 卡西达形式主义：从响应函数到[激发光谱](@entry_id:139562)

直接求解上述关于响应函数的[积分方程](@entry_id:138643)非常困难。**卡西达 (Casida) 形式主义** 提供了一种巧妙的代数方法来实现这一目标。它将寻找响应函数 $\chi$ 极点的问题，转化为一个矩阵本征值问题。

该方法将激发过程看作是从占据的 KS 轨道 ($i, j, \dots$) 到未占据（虚）的 KS 轨道 ($a, b, \dots$) 的单[电子跃迁](@entry_id:152949)（也称为“粒子-空穴”对）。在这些单[电子跃迁](@entry_id:152949)构成的基组中，上述[戴森方程](@entry_id:146246)可以被写成如下的矩阵形式，即 **[卡西达方程](@entry_id:183031)**：
$$
\begin{pmatrix} \mathbf{A} & \mathbf{B} \\ \mathbf{B}^* & \mathbf{A}^* \end{pmatrix} \begin{pmatrix} \mathbf{X} \\ \mathbf{Y} \end{pmatrix} = \omega \begin{pmatrix} \mathbf{1} & \mathbf{0} \\ \mathbf{0} & -\mathbf{1} \end{pmatrix} \begin{pmatrix} \mathbf{X} \\ \mathbf{Y} \end{pmatrix}
$$
这个方程的解给出了我们关心的激发信息 ：
- **本征值 $\omega$**：对应于体系的中性[激发能](@entry_id:190368)。这些能量不是简单的 KS [轨道能量](@entry_id:158481)差 $\epsilon_a - \epsilon_i$，因为矩阵 $\mathbf{A}$ 和 $\mathbf{B}$ 中包含了电子-空穴间的相互作用。
- **本征矢 $(\mathbf{X}, \mathbf{Y})$**：描述了每个真实激发态是由哪些 KS 单[电子跃迁](@entry_id:152949)线性组合而成的。向量 $\mathbf{X}$ 的分量代表了从占据到未占据轨道的“激发”部分的振幅，而 $\mathbf{Y}$ 则代表了“退激发”部分的振幅。

**交换关联核 $f_{\text{xc}}$** 在这里扮演了至关重要的角色 。矩阵 $\mathbf{A}$ 和 $\mathbf{B}$ 的元素包含了耦合项 $K_{ia,jb}$，它描述了跃迁 $i \to a$ 与跃迁 $j \to b$ 之间的相互作用。这个耦合项由哈特里核 $f_{\text{H}}$ 和交换关联核 $f_{\text{xc}}$ 共同贡献。$f_{\text{H}}$ 贡献了经典的[库仑相互作用](@entry_id:747947)，而 $f_{\text{xc}}$ 则将所有关键的量子力学效应——交换和关联——引入到被激发的电子与其留下的空穴之间的有效相互作用中。例如，[单重态和三重态](@entry_id:148894)[激发能](@entry_id:190368)的分裂，就是由交换作用主导的，必须通过 $f_{\text{xc}}$ 才能正确描述。

从更形式化的角度看，[卡西达方程](@entry_id:183031)的本征值 $\omega$ 精确地对应于[响应函数](@entry_id:142629) $\chi$ 的极点。而本征矢则决定了在这些极点处的留数 (residue)，这些留数与跃迁偶极矩直接相关，进而决定了 **[振子强度](@entry_id:147221) (oscillator strength)** $f_I$。[振子强度](@entry_id:147221)是衡量一个[光学跃迁](@entry_id:160047)发生概率或吸收强度的物理量。因此，LR-TDDFT 计算的直接输出就是一系列离散的[激发能](@entry_id:190368)及对应的[振子强度](@entry_id:147221)，即所谓的“棒状光谱” (stick spectrum)。为了与实验光谱比较，通常需要对这些棒状谱线进行展宽处理 。

### 关键近似及其后果：[绝热近似](@entry_id:143074)

至今我们讨论的都是精确理论，但精确的、具有记忆效应和初始态依赖的交换关联泛函 $v_{\text{xc}}$ 和核 $f_{\text{xc}}$ 的形式是未知的。因此，在实践中必须引入近似。

最广泛使用的近似是 **[绝热近似](@entry_id:143074) (adiabatic approximation)** 。它假设在任意时刻 $t$，交换关联势 $v_{\text{xc}}(\mathbf{r}, t)$ 只依赖于该时刻的瞬时密度 $n(\mathbf{r}, t)$，而完全忽略其演化历史。具体地，它直接借用静态 DFT 中已知的基态交换关联势泛函 $v_{\text{xc}}^{\text{GS}}[n]$，并将其应用于瞬时含时密度上：
$$
v_{\text{xc}}^{\text{A}}(\mathbf{r}, t) = v_{\text{xc}}^{\text{GS}}[n=n(\cdot, t)](\mathbf{r})
$$
这个近似的物理图像是，体系的电子云在每个瞬间都“绝热地”适应当前的密度分布，仿佛体系在每一刻都处于对应于当前密度的“基态”。

[绝热近似](@entry_id:143074)极大地简化了计算，但也带来了深刻的后果。由于势只依赖于瞬时密度，交换关联核 $f_{\text{xc}}$ 在时域上变成了局域的，即与 $\delta(t-t')$ 成正比。经过傅里叶变换到频域，这意味着 **绝热交换关联核 $f_{\text{xc}}^{\text{A}}$ 与频率 $\omega$ 无关**。这种频率无关性是[绝热近似](@entry_id:143074)的核心特征，也是其许多失败的根源。

#### 绝热 TDDFT 的局限性

尽管绝热 TDDFT 在描述许多分子的低能价层激发方面取得了巨大成功，但它在处理某些类型的激发时会系统性地失败。

1.  **电荷转移 (Charge-Transfer, CT) 激发**：考虑一个由电子给体 (D) 和受体 (A) 组成的分子，当它们相距较远时，最低的 CT [激发能](@entry_id:190368) $E_{\text{CT}}$ 近似为 $I_D - A_A - 1/R$，其中 $I_D$ 是给体的[电离能](@entry_id:136678)，$A_A$ 是受体的电子亲和能，而 $-1/R$ 项是分离后的电子和空穴之间的库仑吸引能。标准的绝热 TDDFT 计算（特别是使用局域或半局域泛函如 GGA）会严重低估这个能量 。其根本原因在于，这些泛函的交换关联势和核都随距离过快地衰减。当电子和空穴在空间上被拉开时，这种短程的 $f_{\text{xc}}$ 无法描述它们之间长程的 $-1/R$ 库仑吸引。结果是，计算出的 CT [激发能](@entry_id:190368)几乎就是 KS 体系的 HOMO 和 LUMO 的轨道能差，而忽略了重要的电子-空穴束缚能，导致能量被严重低估。

2.  **双重激发 (Double Excitations)**：双重激发是指那些主要涉及两个电子同时从占据轨道跃迁到[虚轨道](@entry_id:188499)的激发态。在绝热 LR-TDDFT 的卡西达形式中，整个理论框架是构建在单[电子跃迁](@entry_id:152949)（$1p-1h$）的基组之上的 。由于绝[热核](@entry_id:172041) $f_{\text{xc}}$ 是频率无关的，它只能混合和移动这些已有的单激发态的能量，但无法在其数学结构之外创造出全新的极点。因此，绝热 TDDFT 从根本上无法描述那些以双重激发为主要特征的激发态。要捕捉这类激发，必须超越[绝热近似](@entry_id:143074)，采用一个具有显式频率依赖性的交换关联核 $f_{\text{xc}}(\omega)$。一个频率依赖的核（即具有[记忆效应](@entry_id:266709)的核）本身可以包含对应于双重激发的极点，从而将这些激发态引入到整个体系的[响应函数](@entry_id:142629)中。

总之，[含时密度泛函理论](@entry_id:200019)通过巧妙的科恩-沈构造，为研究电子动力学和激发提供了一个强大而高效的理论框架。然而，我们必须始终意识到，其实际应用的效果在很大程度上取决于所使用的交换关联泛函的近似水平。理解像[绝热近似](@entry_id:143074)这样的核心近似的原理及其内在局限性，对于准确地解释计算结果和推动理论发展至关重要。