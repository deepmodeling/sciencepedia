{
    "hands_on_practices": [
        {
            "introduction": "A key insight enabling reduced-scaling methods is the \"nearsightedness\" principle, which states that local changes in the Hamiltonian have negligible effects far away. For the two-electron repulsion integrals that dominate the cost of conventional Hartree-Fock theory, this principle manifests as a rapid decay of integral values with increasing distance between charge distributions. This exercise provides a tangible, hands-on demonstration of how this principle is exploited through integral screening, allowing you to manually apply a simplified but physically motivated set of rules to determine which integrals are computationally significant for a small molecule .",
            "id": "2457312",
            "problem": "Consider a model screening procedure motivated by linear-scaling electronic structure methods for a square $\\mathrm{H}_4$ cluster in a minimal basis of localized $1s$ Atomic Orbitals (AO). Four hydrogen nuclei are fixed at Cartesian coordinates (in arbitrary length units) $\\mathbf{R}_1=(0,0,0)$, $\\mathbf{R}_2=(L,0,0)$, $\\mathbf{R}_3=(L,L,0)$, and $\\mathbf{R}_4=(0,L,0)$, where $L>0$. Let $(\\mu\\nu|\\lambda\\sigma)$ denote a two-electron Coulomb repulsion integral in chemists’ notation over AOs centered at nuclei indexed by $\\mu,\\nu,\\lambda,\\sigma \\in \\{1,2,3,4\\}$.\n\nYou are to apply the following purely distance-based screening rule to the full ordered list of all $(\\mu\\nu|\\lambda\\sigma)$ (that is, all $4^4$ ordered quadruples):\n\n1. Pair-compactness condition: For a pair of AO indices $(\\mu,\\nu)$, define the inter-center distance $d_{\\mu\\nu}=\\|\\mathbf{R}_\\mu-\\mathbf{R}_\\nu\\|$. The pair $(\\mu,\\nu)$ is deemed compact if $d_{\\mu\\nu}\\le r_p$, with $r_p=L$. Similarly define compactness for $(\\lambda,\\sigma)$.\n\n2. Pair-centroid separation condition: For a pair $(\\mu,\\nu)$, define its centroid as $\\mathbf{C}_{\\mu\\nu}=\\tfrac{1}{2}(\\mathbf{R}_\\mu+\\mathbf{R}_\\nu)$. Given two pairs $(\\mu,\\nu)$ and $(\\lambda,\\sigma)$, define the pair-centroid separation $D_{\\mu\\nu,\\lambda\\sigma}=\\|\\mathbf{C}_{\\mu\\nu}-\\mathbf{C}_{\\lambda\\sigma}\\|$. The two-electron integral $(\\mu\\nu|\\lambda\\sigma)$ is retained only if $D_{\\mu\\nu,\\lambda\\sigma}\\le R_c$, with $R_c=\\tfrac{L}{2}$.\n\nA two-electron integral $(\\mu\\nu|\\lambda\\sigma)$ is retained by the screening if and only if both pair-compactness conditions and the pair-centroid separation condition are satisfied. Count all retained integrals as distinct by their ordered indices $(\\mu,\\nu,\\lambda,\\sigma)$; do not invoke any permutation symmetries.\n\nWhat is the total number of ordered two-electron integrals $(\\mu\\nu|\\lambda\\sigma)$ that are retained by this screening rule? Provide your answer as a single integer. No rounding is required.",
            "solution": "The problem requires us to count the total number of ordered two-electron integrals $(\\mu\\nu|\\lambda\\sigma)$, with indices $\\mu, \\nu, \\lambda, \\sigma$ each ranging from $1$ to $4$, that are retained by a specific three-part screening rule. An integral is retained if and only if all three of the following conditions are met:\n$1$. The pair $(\\mu,\\nu)$ is compact: $d_{\\mu\\nu} = \\|\\mathbf{R}_\\mu - \\mathbf{R}_\\nu\\| \\le r_p$, where $r_p=L$.\n$2$. The pair $(\\lambda,\\sigma)$ is compact: $d_{\\lambda\\sigma} = \\|\\mathbf{R}_\\lambda - \\mathbf{R}_\\sigma\\| \\le r_p$, where $r_p=L$.\n$3$. The pair-centroid separation is small: $D_{\\mu\\nu,\\lambda\\sigma} = \\|\\mathbf{C}_{\\mu\\nu} - \\mathbf{C}_{\\lambda\\sigma}\\| \\le R_c$, where $R_c = \\frac{L}{2}$.\n\nThe solution proceeds in a sequence of logical steps: first, we identify all pairs of atomic orbital indices that satisfy the compactness condition. Second, we compute the centroids for these compact pairs. Third, using the set of compact pairs and their centroids, we enumerate all combinations of pairs $((\\mu,\\nu), (\\lambda,\\sigma))$ that satisfy the pair-centroid separation condition.\n\nThe four hydrogen nuclei are located at the vertices of a square in the $xy$-plane: $\\mathbf{R}_1=(0,0,0)$, $\\mathbf{R}_2=(L,0,0)$, $\\mathbf{R}_3=(L,L,0)$, and $\\mathbf{R}_4=(0,L,0)$.\n\nStep 1: Identify the set of compact pairs, $S_p$.\nWe must find all ordered pairs $(\\mu,\\nu)$ such that the distance $d_{\\mu\\nu} = \\|\\mathbf{R}_\\mu - \\mathbf{R}_\\nu\\|$ is less than or equal to $L$. Let us compute the relevant squared distances, $d_{\\mu\\nu}^2$:\n- For $\\mu=\\nu$: $d_{\\mu\\mu}^2 = 0$. The distance is $d_{\\mu\\mu}=0$. Since $0 \\le L$, all $4$ pairs of the form $(\\mu,\\mu)$ are compact: $(1,1), (2,2), (3,3), (4,4)$.\n- For adjacent nuclei (sides of the square): $d_{12}^2 = L^2$, $d_{23}^2 = L^2$, $d_{34}^2 = L^2$, $d_{41}^2 = L^2$. The distance is $d_{\\mu\\nu}=L$ in these cases. Since $L \\le L$, these pairs are compact. This gives us the pairs $(1,2), (2,1), (2,3), (3,2), (3,4), (4,3), (4,1), (1,4)$, for a total of $8$ pairs.\n- For opposite nuclei (diagonals of the square): $d_{13}^2 = L^2+L^2 = 2L^2$ and $d_{24}^2 = L^2+L^2 = 2L^2$. The distance is $d_{\\mu\\nu}=L\\sqrt{2}$. Since $L\\sqrt{2} > L$ (as $L>0$), these pairs are not compact.\n\nThe set of compact pairs, $S_p$, thus consists of $4+8=12$ pairs:\n$S_p = \\{ (1,1), (2,2), (3,3), (4,4), (1,2), (2,1), (2,3), (3,2), (3,4), (4,3), (1,4), (4,1) \\}$.\n\nStep 2: Determine the centroids for all compact pairs.\nThe centroid for a pair $(\\mu,\\nu)$ is $\\mathbf{C}_{\\mu\\nu} = \\frac{1}{2}(\\mathbf{R}_\\mu + \\mathbf{R}_\\nu)$.\nWe find two distinct types of centroids corresponding to the compact pairs:\n- For pairs of the form $(\\mu,\\mu)$, the centroid is the position of the nucleus itself: $\\mathbf{C}_{\\mu\\mu} = \\mathbf{R}_\\mu$. These are the $4$ vertices of the square, which we call \"vertex centroids\".\n    - $\\mathbf{C}_{11} = (0,0,0)$\n    - $\\mathbf{C}_{22} = (L,0,0)$\n    - $\\mathbf{C}_{33} = (L,L,0)$\n    - $\\mathbf{C}_{44} = (0,L,0)$\n    Each vertex centroid corresponds to exactly $1$ compact pair.\n- For pairs of adjacent nuclei $(\\mu,\\nu)$, the centroid is the midpoint of the edge connecting them. Note that $\\mathbf{C}_{\\mu\\nu} = \\mathbf{C}_{\\nu\\mu}$. These are the $4$ midpoints of the sides of the square, which we call \"midpoint centroids\".\n    - $\\mathbf{C}_{12} = \\mathbf{C}_{21} = (\\frac{L}{2}, 0, 0)$\n    - $\\mathbf{C}_{23} = \\mathbf{C}_{32} = (L, \\frac{L}{2}, 0)$\n    - $\\mathbf{C}_{34} = \\mathbf{C}_{43} = (\\frac{L}{2}, L, 0)$\n    - $\\mathbf{C}_{41} = \\mathbf{C}_{14} = (0, \\frac{L}{2}, 0)$\n    Each midpoint centroid corresponds to exactly $2$ compact pairs.\n\nStep 3: Apply the pair-centroid separation condition and count integrals.\nThe total number of retained integrals, $N$, is the sum over all initial compact pairs $(\\mu,\\nu) \\in S_p$ of the number of final compact pairs $(\\lambda,\\sigma) \\in S_p$ that satisfy $\\|\\mathbf{C}_{\\mu\\nu} - \\mathbf{C}_{\\lambda\\sigma}\\| \\le \\frac{L}{2}$.\nLet's analyze the distances between centroids.\n- The distance between an adjacent vertex centroid and midpoint centroid is, for example, $\\|\\mathbf{C}_{11} - \\mathbf{C}_{12}\\| = \\|(0,0,0) - (\\frac{L}{2},0,0)\\| = \\frac{L}{2}$. This distance satisfies the condition. By symmetry, any vertex centroid is at distance $\\frac{L}{2}$ from its two adjacent midpoint centroids.\n- The distance between any two distinct vertex centroids is at least $L$, which is greater than $\\frac{L}{2}$.\n- The distance between any two distinct midpoint centroids is at least $\\frac{L\\sqrt{2}}{2} \\approx 0.707L$, which is greater than $\\frac{L}{2}$.\n- The distance of a centroid to itself is $0$, which satisfies the condition.\n\nSo, a given centroid $\\mathbf{C}$ is \"connected\" (i.e., satisfies the separation condition) only to itself and its nearest neighbors in the set of centroids. Specifically:\n- A vertex centroid is connected to itself and its $2$ adjacent midpoint centroids.\n- A midpoint centroid is connected to itself and its $2$ adjacent vertex centroids.\n\nWe can now count the total number of integrals by considering the two types of initial pairs $(\\mu,\\nu)$.\n\nCase A: The initial pair $(\\mu,\\nu)$ has a vertex centroid.\nThere are $4$ such pairs in $S_p$: $(1,1), (2,2), (3,3), (4,4)$. Let's consider $(\\mu,\\nu)=(1,1)$, whose centroid is $\\mathbf{C}_{11}=(0,0,0)$. The centroids for the final pair $(\\lambda,\\sigma)$ must be within $\\frac{L}{2}$ of $\\mathbf{C}_{11}$. These are $\\mathbf{C}_{11}$ itself, and the adjacent midpoint centroids $\\mathbf{C}_{12}$ and $\\mathbf{C}_{41}$.\n- Number of pairs with centroid $\\mathbf{C}_{11}$: $1$ pair, which is $(1,1)$.\n- Number of pairs with centroid $\\mathbf{C}_{12}$: $2$ pairs, which are $(1,2)$ and $(2,1)$.\n- Number of pairs with centroid $\\mathbf{C}_{41}$: $2$ pairs, which are $(1,4)$ and $(4,1)$.\nFor an initial pair with a vertex centroid, there are $1+2+2=5$ valid final pairs.\nSince there are $4$ such initial pairs, this contributes $4 \\times 5 = 20$ to the total count.\n\nCase B: The initial pair $(\\mu,\\nu)$ has a midpoint centroid.\nThere are $8$ such pairs in $S_p$. Let's consider $(\\mu,\\nu)=(1,2)$, whose centroid is $\\mathbf{C}_{12}=(\\frac{L}{2},0,0)$. The centroids for the final pair $(\\lambda,\\sigma)$ must be within $\\frac{L}{2}$ of $\\mathbf{C}_{12}$. These are $\\mathbf{C}_{12}$ itself, and the adjacent vertex centroids $\\mathbf{C}_{11}$ and $\\mathbf{C}_{22}$.\n- Number of pairs with centroid $\\mathbf{C}_{12}$: $2$ pairs, which are $(1,2)$ and $(2,1)$.\n- Number of pairs with centroid $\\mathbf{C}_{11}$: $1$ pair, which is $(1,1)$.\n- Number of pairs with centroid $\\mathbf{C}_{22}$: $1$ pair, which is $(2,2)$.\nFor an initial pair with a midpoint centroid, there are $2+1+1=4$ valid final pairs.\nSince there are $8$ such initial pairs, this contributes $8 \\times 4 = 32$ to the total count.\n\nFinally, the total number of retained integrals is the sum of the contributions from both cases.\n$N = 20 + 32 = 52$.",
            "answer": "$$\n\\boxed{52}\n$$"
        },
        {
            "introduction": "While we know that enforcing sparsity on the density matrix introduces errors, performing an exact, full-scale calculation to find the true error is computationally prohibitive—defeating the purpose of a reduced-scaling method. Therefore, developing reliable *a posteriori* error estimators is crucial for validating these approximations. This analytical practice challenges you to first quantify the error in the norm of a truncated orbital, and then to investigate how this error disrupts the idempotency and normalization of the density matrix, requiring a corrective scheme to restore physical consistency .",
            "id": "3791707",
            "problem": "In multiscale materials simulation, linear-scaling electronic structure methods often impose finite spatial support on localized orbitals to reduce computational cost. Consider a normalized Slater-type $s$-orbital in three spatial dimensions given by $\\chi(\\mathbf{r}) = N \\exp(-\\zeta r)$, where $r = |\\mathbf{r}|$ and $\\zeta > 0$ is the decay parameter. The normalized orbital satisfies $\\int_{\\mathbb{R}^{3}} |\\chi(\\mathbf{r})|^{2} \\, d^{3}\\mathbf{r} = 1$. Define the truncated orbital by $\\chi_{R}(\\mathbf{r}) = \\chi(\\mathbf{r}) W_{R}(\\mathbf{r})$, where $W_{R}(\\mathbf{r})$ is the indicator function of the ball of radius $R$ centered at the origin, i.e., $W_{R}(\\mathbf{r}) = 1$ if $r \\leq R$ and $W_{R}(\\mathbf{r}) = 0$ otherwise. The norm deficit due to truncation is $\\varepsilon_{N}(R) = 1 - \\int_{|\\mathbf{r}| \\leq R} |\\chi(\\mathbf{r})|^{2} \\, d^{3}\\mathbf{r}$.\n\nFirst, starting from the definition of normalization, derive a closed-form expression for $\\varepsilon_{N}(R)$ in terms of $\\zeta$ and $R$.\n\nNext, consider a minimal nonorthogonal localized basis $\\{ \\chi_{1}, \\chi_{2} \\}$ in which a single electron occupies the subspace spanned by $\\chi_{1}$. The one-electron density kernel $K$ in this basis is represented by the matrix $K = \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix}$. After truncation to finite support $R$, the overlap matrix becomes $S_{R}$ with entries $S_{ij}(R) = \\langle \\chi_{i,R} | \\chi_{j,R} \\rangle$. In a nonorthogonal basis, the idempotency of the density operator implies $K S_{R} K = K$, and conservation of electron number implies $\\operatorname{Tr}(K S_{R}) = 1$. Propose a scalar rescaling scheme $K' = \\alpha(R) K$ that enforces both idempotency and normalization under finite support, and derive $\\alpha(R)$ in closed form using your expression for $\\varepsilon_{N}(R)$.\n\nProvide the final answer as a single closed-form analytic expression for $\\alpha(R)$ in terms of $\\zeta$ and $R$. No numerical evaluation is required. Do not include any units. If you find multiple equivalent forms, give the simplest exact form. The final answer must be a single expression.",
            "solution": "The problem asks for two quantities: first, a closed-form expression for the norm deficit $\\varepsilon_{N}(R)$ of a truncated Slater-type orbital; and second, a scalar rescaling factor $\\alpha(R)$ for a density kernel to maintain idempotency and normalization under this truncation. The solution will proceed in two parts accordingly.\n\nPart 1: Derivation of the norm deficit $\\varepsilon_{N}(R)$.\n\nThe Slater-type $s$-orbital is given by $\\chi(\\mathbf{r}) = N \\exp(-\\zeta r)$, where $r=|\\mathbf{r}|$. The normalization condition is $\\int_{\\mathbb{R}^{3}} |\\chi(\\mathbf{r})|^{2} \\, d^{3}\\mathbf{r} = 1$. We first determine the normalization constant $N$. The integral is best evaluated in spherical coordinates, where $d^{3}\\mathbf{r} = r^{2}\\sin\\theta \\, dr \\, d\\theta \\, d\\phi$.\n\nThe squared modulus of the orbital is $|\\chi(\\mathbf{r})|^2 = N^2 \\exp(-2\\zeta r)$. The normalization integral becomes:\n$$ \\int_{\\mathbb{R}^{3}} N^{2} \\exp(-2\\zeta r) \\, d^{3}\\mathbf{r} = N^{2} \\int_{0}^{2\\pi} d\\phi \\int_{0}^{\\pi} \\sin\\theta \\, d\\theta \\int_{0}^{\\infty} r^{2} \\exp(-2\\zeta r) \\, dr = 1 $$\nThe angular integrals yield a factor of $4\\pi$. The radial integral is a standard form related to the Gamma function: $\\int_{0}^{\\infty} x^n \\exp(-ax) \\, dx = \\frac{n!}{a^{n+1}}$. For $n=2$ and $a=2\\zeta$, we have:\n$$ \\int_{0}^{\\infty} r^{2} \\exp(-2\\zeta r) \\, dr = \\frac{2!}{(2\\zeta)^{3}} = \\frac{2}{8\\zeta^{3}} = \\frac{1}{4\\zeta^{3}} $$\nSubstituting this into the normalization equation:\n$$ N^{2} (4\\pi) \\left(\\frac{1}{4\\zeta^{3}}\\right) = 1 \\implies \\frac{\\pi N^{2}}{\\zeta^{3}} = 1 \\implies N^{2} = \\frac{\\zeta^{3}}{\\pi} $$\nNext, we calculate the norm contained within a sphere of radius $R$, denoted by $I_R$:\n$$ I_R = \\int_{|\\mathbf{r}| \\leq R} |\\chi(\\mathbf{r})|^{2} \\, d^{3}\\mathbf{r} = N^{2} \\int_{0}^{R} 4\\pi r^2 \\exp(-2\\zeta r) \\, dr $$\nWe must evaluate the definite integral $\\int_{0}^{R} r^{2} \\exp(-2\\zeta r) \\, dr$. Using integration by parts twice, we find the indefinite integral:\n$$ \\int r^{2} \\exp(-2\\zeta r) \\, dr = -\\exp(-2\\zeta r) \\left( \\frac{r^{2}}{2\\zeta} + \\frac{r}{2\\zeta^{2}} + \\frac{1}{4\\zeta^{3}} \\right) $$\nEvaluating this from $0$ to $R$:\n$$ \\int_{0}^{R} r^{2} \\exp(-2\\zeta r) \\, dr = \\left[ -\\exp(-2\\zeta r) \\left( \\frac{r^{2}}{2\\zeta} + \\frac{r}{2\\zeta^{2}} + \\frac{1}{4\\zeta^{3}} \\right) \\right]_{0}^{R} $$\n$$ = \\left( -\\exp(-2\\zeta R) \\left( \\frac{R^{2}}{2\\zeta} + \\frac{R}{2\\zeta^{2}} + \\frac{1}{4\\zeta^{3}} \\right) \\right) - \\left( -\\exp(0) \\left( 0 + 0 + \\frac{1}{4\\zeta^{3}} \\right) \\right) $$\n$$ = \\frac{1}{4\\zeta^{3}} - \\exp(-2\\zeta R) \\left( \\frac{R^{2}}{2\\zeta} + \\frac{R}{2\\zeta^{2}} + \\frac{1}{4\\zeta^{3}} \\right) = \\frac{1}{4\\zeta^{3}} \\left[ 1 - \\exp(-2\\zeta R) \\left( 1 + 2\\zeta R + 2\\zeta^{2} R^{2} \\right) \\right] $$\nNow, we substitute this back into the expression for $I_R$, along with $N^2 = \\zeta^3/\\pi$:\n$$ I_R = \\left(\\frac{\\zeta^{3}}{\\pi}\\right) (4\\pi) \\left( \\frac{1}{4\\zeta^{3}} \\left[ 1 - \\exp(-2\\zeta R) \\left( 1 + 2\\zeta R + 2\\zeta^{2} R^{2} \\right) \\right] \\right) $$\n$$ I_R = 1 - \\exp(-2\\zeta R) (1 + 2\\zeta R + 2\\zeta^{2} R^{2}) $$\nThe norm deficit is defined as $\\varepsilon_{N}(R) = 1 - I_R$. Therefore, the first required expression is:\n$$ \\varepsilon_{N}(R) = \\exp(-2\\zeta R) (1 + 2\\zeta R + 2\\zeta^{2} R^{2}) $$\n\nPart 2: Derivation of the rescaling factor $\\alpha(R)$.\n\nWe are given a minimal basis $\\{\\chi_{1}, \\chi_{2}\\}$ and a one-electron density kernel $K = \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix}$. The basis orbitals are truncated to a support radius $R$, yielding truncated orbitals $\\chi_{i,R}$ and a truncated overlap matrix $S_R$ with elements $S_{ij}(R) = \\langle \\chi_{i,R} | \\chi_{j,R} \\rangle$. We seek a rescaled density kernel $K' = \\alpha(R) K$ that satisfies the idempotency condition $K'S_R K' = K'$ and the normalization condition $\\operatorname{Tr}(K'S_R) = 1$.\n\nLet's analyze the conditions with $K' = \\alpha K$:\n1.  Idempotency: $(\\alpha K) S_R (\\alpha K) = \\alpha K \\implies \\alpha^{2} K S_R K = \\alpha K$. Assuming $\\alpha \\neq 0$, this simplifies to $\\alpha K S_R K = K$.\n2.  Normalization: $\\operatorname{Tr}(\\alpha K S_R) = 1 \\implies \\alpha \\operatorname{Tr}(K S_R) = 1$. This gives $\\alpha = \\frac{1}{\\operatorname{Tr}(K S_R)}$.\n\nLet's evaluate the matrix products using the given form of $K$:\n$$ K S_R = \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix} \\begin{pmatrix} S_{11} & S_{12} \\\\ S_{21} & S_{22} \\end{pmatrix} = \\begin{pmatrix} S_{11} & S_{12} \\\\ 0 & 0 \\end{pmatrix} $$\nThe trace is $\\operatorname{Tr}(K S_R) = S_{11}$. From the normalization condition, we find $\\alpha(R) = \\frac{1}{S_{11}(R)}$.\n\nNow we check consistency with the idempotency condition. The condition becomes $\\frac{1}{S_{11}(R)} K S_R K = K$, which requires $K S_R K = S_{11}(R) K$. Let's compute the left-hand side:\n$$ K S_R K = \\begin{pmatrix} S_{11} & S_{12} \\\\ 0 & 0 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix} = \\begin{pmatrix} S_{11} & 0 \\\\ 0 & 0 \\end{pmatrix} $$\nAnd the right-hand side is:\n$$ S_{11}(R) K = S_{11} \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix} = \\begin{pmatrix} S_{11} & 0 \\\\ 0 & 0 \\end{pmatrix} $$\nThe two sides are identical, so the conditions are consistent and both yield $\\alpha(R) = \\frac{1}{S_{11}(R)}$.\n\nThe term $S_{11}(R)$ is the self-overlap of the truncated orbital $\\chi_{1,R}$:\n$$ S_{11}(R) = \\langle \\chi_{1,R} | \\chi_{1,R} \\rangle = \\int_{\\mathbb{R}^3} |\\chi_{1,R}(\\mathbf{r})|^2 \\, d^3\\mathbf{r} = \\int_{|\\mathbf{r}| \\leq R} |\\chi_1(\\mathbf{r})|^2 \\, d^3\\mathbf{r} $$\nThe problem context implies that the orbital $\\chi_1$ is an instance of the generic Slater-type orbital $\\chi(\\mathbf{r})$ described. Hence, the integral for $S_{11}(R)$ is identical to the integral for $I_R$ calculated in the first part.\n$$ S_{11}(R) = I_R = 1 - \\exp(-2\\zeta R) (1 + 2\\zeta R + 2\\zeta^{2} R^{2}) $$\nThe problem asks to derive $\\alpha(R)$ using the expression for $\\varepsilon_N(R)$. We have $S_{11}(R) = I_R$ and $\\varepsilon_N(R) = 1 - I_R$, which implies $S_{11}(R) = 1 - \\varepsilon_N(R)$.\nTherefore, the rescaling factor is:\n$$ \\alpha(R) = \\frac{1}{S_{11}(R)} = \\frac{1}{1 - \\varepsilon_N(R)} $$\nSubstituting the derived expression for $\\varepsilon_N(R)$:\n$$ \\alpha(R) = \\frac{1}{1 - \\exp(-2\\zeta R) (1 + 2\\zeta R + 2\\zeta^{2} R^{2})} $$\nThis is the final closed-form expression for $\\alpha(R)$ in terms of $\\zeta$ and $R$.",
            "answer": "$$\n\\boxed{\\frac{1}{1 - \\exp(-2\\zeta R) (1 + 2\\zeta R + 2\\zeta^{2} R^{2})}}\n$$"
        },
        {
            "introduction": "While we know that enforcing sparsity on the density matrix introduces errors, performing an exact, full-scale calculation to find the true error is computationally prohibitive—defeating the purpose of a reduced-scaling method. Therefore, developing reliable *a posteriori* error estimators is crucial for validating these approximations. This computational exercise guides you through the process of implementing and testing such an estimator, providing practical insight into how the band-energy error is linked to the spectral gap and the residual commutator, $[H, P_s]$ .",
            "id": "2457291",
            "problem": "You are given a real symmetric matrix $H \\in \\mathbb{R}^{n \\times n}$, interpreted as a single-particle Hamiltonian, and a Fermi level $\\mu \\in \\mathbb{R}$. At zero temperature and for a gapped spectrum around $\\mu$, the ground-state density matrix $P^\\star \\in \\mathbb{R}^{n \\times n}$ is the spectral projector of $H$ onto the invariant subspace spanned by eigenvectors with eigenvalues strictly less than $\\mu$. A strictly sparse approximation $P_s$ is obtained by setting to zero all entries $(i,j)$ of $P^\\star$ with $|i-j| > r$, where $r \\in \\mathbb{Z}_{\\ge 0}$ is a prescribed half-bandwidth, and indices are counted from $0$ to $n-1$. The exact band-energy error induced by enforcing strict sparsity is defined as\n$$\nE_{\\mathrm{err}} \\;=\\; \\left|\\mathrm{Tr}\\!\\left(H\\,(P^\\star - P_s)\\right)\\right|.\n$$\nAssume the spectrum of $H$ has a nonzero gap $\\gamma > 0$ around $\\mu$, defined as\n$$\n\\gamma \\;=\\; \\min\\{\\lambda \\in \\sigma(H) \\,:\\, \\lambda > \\mu\\} \\;-\\; \\max\\{\\lambda \\in \\sigma(H) \\,:\\, \\lambda < \\mu\\}.\n$$\nDefine the residual commutator $R = [H,P_s] = H P_s - P_s H$, and the Frobenius norm $\\|A\\|_F = \\sqrt{\\mathrm{Tr}(A^\\top A)}$. Consider the following a posteriori error estimator for the band-energy error:\n$$\n\\mathcal{B} \\;=\\; \\frac{\\|H\\|_F}{\\gamma}\\,\\|[H,P_s]\\|_F.\n$$\n\nYour task is to write a program that, for each test case defined below, constructs $H$, computes $P^\\star$, forms $P_s$ by the strict sparsity rule with the given $r$, evaluates the exact band-energy error $E_{\\mathrm{err}}$, computes the spectral gap $\\gamma$ around $\\mu$, evaluates the estimator $\\mathcal{B}$, and returns both values along with a boolean indicating whether the bound is satisfied within a numerical tolerance.\n\nTest suite and construction details:\n- For each test, use a one-dimensional tight-binding chain of length $n$ with open boundary conditions, defined by\n  - On-site potential: $H_{ii} = \\Delta$ if $i$ is even, and $H_{ii} = -\\Delta$ if $i$ is odd, for $i \\in \\{0,1,\\dots,n-1\\}$.\n  - Nearest-neighbor hopping: $H_{i,i+1} = H_{i+1,i} = t$ for $i \\in \\{0,1,\\dots,n-2\\}$.\n- Set the Fermi level to $\\mu = 0$.\n- Construct $P^\\star$ as the spectral projector onto eigenvectors of $H$ with eigenvalues strictly less than $\\mu$.\n- Construct $P_s$ by setting $(P_s)_{ij} = (P^\\star)_{ij}$ if $|i-j| \\le r$ and $(P_s)_{ij} = 0$ otherwise.\n- Compute $E_{\\mathrm{err}} = \\left|\\mathrm{Tr}\\!\\left(H\\,(P^\\star - P_s)\\right)\\right|$.\n- Compute the spectral gap $\\gamma$ as the difference between the smallest eigenvalue of $H$ strictly greater than $\\mu$ and the largest eigenvalue of $H$ strictly less than $\\mu$.\n- Compute $\\mathcal{B} = \\dfrac{\\|H\\|_F}{\\gamma}\\,\\|[H,P_s]\\|_F$.\n- Define a boolean $\\mathrm{ok}$ that is $\\mathrm{True}$ if $E_{\\mathrm{err}} \\le \\mathcal{B} + 10^{-12}$ and $\\mathrm{False}$ otherwise.\n\nUse the following parameter sets $(n,t,\\Delta,r)$:\n- Test $1$: $(n,t,\\Delta,r) = (8,-1.0,1.0,1)$.\n- Test $2$: $(n,t,\\Delta,r) = (8,-1.0,1.0,7)$.\n- Test $3$: $(n,t,\\Delta,r) = (8,-1.0,0.2,1)$.\n- Test $4$: $(n,t,\\Delta,r) = (8,-1.0,1.0,0)$.\n\nAngle units are not involved. No physical units are required; all quantities are dimensionless. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order\n$$\n\\big[E_{\\mathrm{err}}^{(1)},\\, \\mathcal{B}^{(1)},\\, \\mathrm{ok}^{(1)},\\, E_{\\mathrm{err}}^{(2)},\\, \\mathcal{B}^{(2)},\\, \\mathrm{ok}^{(2)},\\, E_{\\mathrm{err}}^{(3)},\\, \\mathcal{B}^{(3)},\\, \\mathrm{ok}^{(3)},\\, E_{\\mathrm{err}}^{(4)},\\, \\mathcal{B}^{(4)},\\, \\mathrm{ok}^{(4)}\\big].\n$$\nAll floating-point outputs must be rounded to six decimal places. The booleans must be printed as either $\\mathrm{True}$ or $\\mathrm{False}$ without quotes.",
            "solution": "The problem presented is a valid computational task within the field of electronic structure theory. It requests a numerical verification of a postulated a posteriori error bound for the band energy arising from sparse approximation of the density matrix. All terms, including the Hamiltonian model, the density matrix, its approximation, the error metric, and the error estimator, are well-defined and grounded in standard principles of quantum mechanics and numerical linear algebra. The problem is self-contained, objective, and computationally feasible. We will now proceed with a principled solution.\n\nThe objective is to compute the exact band-energy error $E_{\\mathrm{err}}$ and a proposed error estimator $\\mathcal{B}$ for a simplified quantum system, and to verify if the bound $E_{\\mathrm{err}} \\le \\mathcal{B}$ holds.\n\nThe system is a one-dimensional tight-binding chain of length $n$ with open boundary conditions. Its non-interacting electronic structure is described by a single-particle Hamiltonian matrix $H \\in \\mathbb{R}^{n \\times n}$. The elements of this matrix are defined as:\n$$\nH_{ij} =\n\\begin{cases}\n    (-1)^i \\Delta & \\text{if } i = j \\\\\n    t & \\text{if } |i-j| = 1 \\\\\n    0 & \\text{otherwise}\n\\end{cases}\n$$\nwhere $i, j \\in \\{0, 1, \\dots, n-1\\}$. The parameter $\\Delta$ represents a staggered on-site potential, and $t$ is the nearest-neighbor hopping integral. This Hamiltonian is a real symmetric matrix.\n\nAccording to the spectral theorem, $H$ can be diagonalized as $H = V \\Lambda V^\\top$, where $\\Lambda$ is a diagonal matrix of real eigenvalues $\\lambda_k$, and $V$ is an orthogonal matrix whose columns $\\mathbf{v}_k$ are the corresponding eigenvectors. So, $H \\mathbf{v}_k = \\lambda_k \\mathbf{v}_k$.\n\nAt zero temperature, the electrons occupy all energy states up to the Fermi level $\\mu$. The ground-state projector, also known as the density matrix $P^\\star$, is the spectral projector onto the subspace spanned by eigenvectors with eigenvalues less than $\\mu$. Mathematically, this is expressed as:\n$$\nP^\\star = \\sum_{k : \\lambda_k < \\mu} \\mathbf{v}_k \\mathbf{v}_k^\\top\n$$\nThis matrix $P^\\star$ is idempotent ($ (P^\\star)^2 = P^\\star $) and commutes with the Hamiltonian ($[H, P^\\star] = 0$). The total energy of the occupied states, or band energy, is $E_{\\mathrm{band}} = \\mathrm{Tr}(H P^\\star) = \\sum_{k : \\lambda_k < \\mu} \\lambda_k$.\n\nIn linear-scaling electronic structure methods, the density matrix $P^\\star$ is often approximated by a sparse matrix to reduce computational cost. The problem defines a strictly sparse approximation $P_s$ by applying a hard cutoff based on a half-bandwidth $r$:\n$$\n(P_s)_{ij} =\n\\begin{cases}\n    (P^\\star)_{ij} & \\text{if } |i-j| \\le r \\\\\n    0 & \\text{if } |i-j| > r\n\\end{cases}\n$$\nThis truncation breaks the idempotency and the commutation with $H$. The error in the band energy due to this approximation is defined as:\n$$\nE_{\\mathrm{err}} = \\left| \\mathrm{Tr}(H P^\\star) - \\mathrm{Tr}(H P_s) \\right| = \\left|\\mathrm{Tr}\\left(H\\,(P^\\star - P_s)\\right)\\right|\n$$\n\nThe problem proposes an a posteriori error estimator $\\mathcal{B}$ for $E_{\\mathrm{err}}$. This estimator is constructed from quantities that can be computed without knowledge of the exact solution $P^\\star$. However, in this problem, the formulation of $\\mathcal{B}$ depends on $\\gamma$, which requires full diagonalization. The estimator is:\n$$\n\\mathcal{B} = \\frac{\\|H\\|_F}{\\gamma} \\|[H, P_s]\\|_F\n$$\nHere, $\\|A\\|_F = \\sqrt{\\mathrm{Tr}(A^\\top A)}$ is the Frobenius norm. The term $[H, P_s] = H P_s - P_s H$ is the residual commutator; its norm measures the degree to which $P_s$ fails to represent an invariant subspace of $H$. The quantity $\\gamma$ is the spectral gap around the Fermi level $\\mu$, defined as the energy difference between the lowest unoccupied state and the highest occupied state:\n$$\n\\gamma = \\min\\{\\lambda \\in \\sigma(H) \\,:\\, \\lambda > \\mu\\} - \\max\\{\\lambda \\in \\sigma(H) \\,:\\, \\lambda < \\mu\\}\n$$\nA non-zero gap $\\gamma > 0$ is crucial for the stability of the projector and for such bounds to be well-defined. The factor $1/\\gamma$ suggests that the error is larger for systems with smaller gaps, which is a key principle in solid-state physics.\n\nThe computational procedure for each test case $(n, t, \\Delta, r)$ is as follows:\n1.  Construct the $n \\times n$ Hamiltonian matrix $H$ with $\\mu=0$.\n2.  Solve the eigenvalue problem $H \\mathbf{v}_k = \\lambda_k \\mathbf{v}_k$ to find all eigenvalues $\\lambda_k$ and eigenvectors $\\mathbf{v}_k$.\n3.  Identify eigenvalues below $\\mu=0$ and above $\\mu=0$. Compute the spectral gap $\\gamma$.\n4.  Construct the exact density matrix $P^\\star$ from the eigenvectors corresponding to eigenvalues $\\lambda_k < 0$.\n5.  Construct the sparse approximation $P_s$ by retaining only elements $(P^\\star)_{ij}$ where $|i-j| \\le r$.\n6.  Compute the exact band-energy error $E_{\\mathrm{err}} = \\left|\\mathrm{Tr}\\left(H\\,(P^\\star - P_s)\\right)\\right|$.\n7.  Compute the Frobenius norm of the Hamiltonian, $\\|H\\|_F$.\n8.  Compute the residual commutator $R = [H, P_s]$ and its Frobenius norm, $\\|R\\|_F$.\n9.  Calculate the estimator $\\mathcal{B} = (\\|H\\|_F / \\gamma) \\|R\\|_F$.\n10. Verify if the inequality $E_{\\mathrm{err}} \\le \\mathcal{B} + \\epsilon$ holds for a small tolerance $\\epsilon = 10^{-12}$. This determines the boolean value `ok`.\n\nThis structured procedure allows for a direct numerical test of the relationship between the band-energy error $E_{\\mathrm{err}}$ and its estimator $\\mathcal{B}$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem for the given test cases.\n    For each test case, it constructs the Hamiltonian, computes the exact and\n    sparse density matrices, and evaluates the band-energy error and an estimator.\n    \"\"\"\n    # Test cases are given as tuples of (n, t, Delta, r).\n    test_cases = [\n        (8, -1.0, 1.0, 1),\n        (8, -1.0, 1.0, 7),\n        (8, -1.0, 0.2, 1),\n        (8, -1.0, 1.0, 0),\n    ]\n\n    results = []\n    mu = 0.0\n    tolerance = 1e-12\n\n    for n, t, Delta, r in test_cases:\n        # 1. Construct the Hamiltonian matrix H\n        H = np.zeros((n, n), dtype=float)\n        for i in range(n):\n            # On-site potential\n            H[i, i] = Delta if i % 2 == 0 else -Delta\n            # Nearest-neighbor hopping\n            if i < n - 1:\n                H[i, i + 1] = t\n                H[i + 1, i] = t\n\n        # 2. Solve the eigenvalue problem\n        # np.linalg.eigh is used for symmetric matrices. It returns sorted eigenvalues.\n        eigvals, eigvecs = np.linalg.eigh(H)\n\n        # 3. Compute the spectral gap gamma\n        occupied_eigvals = eigvals[eigvals < mu]\n        unoccupied_eigvals = eigvals[eigvals > mu]\n        \n        # This problem setup ensures a non-empty set of occupied and unoccupied states.\n        lambda_homo = occupied_eigvals[-1]\n        lambda_lumo = unoccupied_eigvals[0]\n        gamma = lambda_lumo - lambda_homo\n\n        # 4. Construct the exact density matrix P_star\n        occupied_indices = np.where(eigvals < mu)[0]\n        occupied_vecs = eigvecs[:, occupied_indices]\n        P_star = occupied_vecs @ occupied_vecs.T\n\n        # 5. Construct the sparse approximation P_s\n        P_s = np.zeros_like(P_star)\n        for i in range(n):\n            for j in range(n):\n                if abs(i - j) <= r:\n                    P_s[i, j] = P_star[i, j]\n\n        # 6. Compute the exact band-energy error E_err\n        # E_err = |Tr(H * (P_star - P_s))|\n        E_err = np.abs(np.trace(H @ (P_star - P_s)))\n\n        # 7. Compute the Frobenius norm of H\n        norm_H_F = np.linalg.norm(H, 'fro')\n\n        # 8. Compute the residual commutator R and its norm\n        R = H @ P_s - P_s @ H\n        norm_R_F = np.linalg.norm(R, 'fro')\n\n        # 9. Calculate the estimator B\n        if gamma > 0:\n            B = (norm_H_F / gamma) * norm_R_F\n        else:\n            # Handle the case of zero gap, though not expected in these tests.\n            # If norm_R_F is also zero, B can be 0. Otherwise, it's infinite.\n            B = 0.0 if np.isclose(norm_R_F, 0.0) else np.inf\n\n        # 10. Verify the inequality\n        ok = E_err <= B + tolerance\n\n        # Append results formatted as required\n        results.extend([f\"{E_err:.6f}\", f\"{B:.6f}\", str(ok)])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}