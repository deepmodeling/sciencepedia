{
    "hands_on_practices": [
        {
            "introduction": "To begin, let's focus on the core mechanism of the Metropolis-Hastings algorithm: the acceptance probability. This calculation is the heart of the method, ensuring that our random walk preferentially moves towards regions of higher probability while still being able to explore the entire state space. This first exercise  provides a concrete, discrete scenario to practice applying the acceptance formula, which is crucial for building intuition before tackling more complex, continuous systems.",
            "id": "1962671",
            "problem": "A computational simulation uses the Metropolis-Hastings algorithm to explore the conformational states of a protein. The model simplifies the protein's structure into three possible discrete states: State 1, State 2, and State 3. The goal of the simulation is to generate samples from a target stationary distribution, $\\pi$, which represents the equilibrium probability of finding the protein in each state. This target distribution is given by:\n$\\pi(\\text{State 1}) = 0.1$\n$\\pi(\\text{State 2}) = 0.3$\n$\\pi(\\text{State 3}) = 0.6$\n\nThe algorithm proceeds by proposing moves from a current state $i$ to a new state $j$ according to a proposal distribution $q(j|i)$. The proposal mechanism is defined as follows:\n- From State 1, a move to State 2 is proposed with probability $0.2$, and a move to State 3 is proposed with probability $0.8$.\n- From State 2, a move to State 1 is proposed with probability $0.5$, and a move to State 3 is proposed with probability $0.5$.\n- From State 3, a move to State 1 is proposed with probability $0.1$, and a move to State 2 is proposed with probability $0.9$.\n\nSuppose the simulation is currently in State 1 and a move to State 3 is proposed. Calculate the acceptance probability for this specific transition. Express your final answer as a simplified fraction.",
            "solution": "In the Metropolis-Hastings algorithm, the acceptance probability for a proposed move from a current state $i$ to a new state $j$ is\n$$\n\\alpha_{i \\to j} = \\min\\left(1, \\frac{\\pi(j)\\,q(i \\mid j)}{\\pi(i)\\,q(j \\mid i)}\\right).\n$$\nFor the proposed transition from State 1 to State 3, use the given target probabilities and proposal probabilities. Converting the given decimals to exact fractions,\n$$\n\\pi(\\text{State 3}) = \\frac{3}{5}, \\quad \\pi(\\text{State 1}) = \\frac{1}{10}, \\quad q(3 \\mid 1) = \\frac{4}{5}, \\quad q(1 \\mid 3) = \\frac{1}{10}.\n$$\nSubstitute into the acceptance ratio:\n$$\n\\frac{\\pi(3)\\,q(1 \\mid 3)}{\\pi(1)\\,q(3 \\mid 1)} = \\frac{\\left(\\frac{3}{5}\\right)\\left(\\frac{1}{10}\\right)}{\\left(\\frac{1}{10}\\right)\\left(\\frac{4}{5}\\right)} = \\frac{\\frac{3}{50}}{\\frac{4}{50}} = \\frac{3}{4}.\n$$\nTherefore,\n$$\n\\alpha_{1 \\to 3} = \\min\\left(1, \\frac{3}{4}\\right) = \\frac{3}{4}.\n$$",
            "answer": "$$\\boxed{\\frac{3}{4}}$$"
        },
        {
            "introduction": "While the Metropolis-Hastings algorithm guarantees convergence in the long run for well-behaved chains, its finite-time performance can be severely hindered by the 'shape' of the target distribution. This thought experiment  explores a common and challenging scenario: a distribution with disconnected regions of support, analogous to a physical system with multiple metastable states separated by large energy barriers. Analyzing this case reveals the crucial difference between theoretical irreducibility and practical mixing time, a key concept for diagnosing and trusting MCMC results.",
            "id": "3252214",
            "problem": "Consider a one-dimensional target distribution with unnormalized density given by $\\tilde{\\pi}(x) = \\exp(-x^2)\\,\\mathbf{1}_{\\{|x|\\ge 1\\}}$ on $\\mathbb{R}$, where $\\mathbf{1}_{\\{|x|\\ge 1\\}}$ is the indicator function that is $1$ if $|x|\\ge 1$ and $0$ otherwise. Let $\\pi(x) = \\tilde{\\pi}(x)/Z$ denote the normalized target distribution, where $Z$ is the appropriate normalizing constant. The support of $\\pi$ is the disconnected set $S = (-\\infty,-1]\\cup[1,\\infty)$. We run a Markov chain Monte Carlo (MCMC) method using the Metropolis-Hastings (MH) algorithm with the random-walk Gaussian proposal $q(y\\mid x)$ equal to a normal distribution centered at the current state, specifically $q(y\\mid x) = \\mathcal{N}(x,\\sigma^2)$ with $\\sigma>0$. The algorithm uses the usual MH accept-reject mechanism to ensure $\\pi$ is invariant.\n\nAnalyze the behavior of this sampler in the presence of the disconnected support and select all statements that are correct:\n\nA. For any $\\sigma>0$, the resulting Markov chain on $S$ is irreducible and aperiodic, and hence converges in distribution to $\\pi$.\n\nB. When $\\sigma$ is sufficiently small, the probability of proposing a jump from the left component $\\{x\\le -1\\}$ to the right component $\\{x\\ge 1\\}$ is exponentially small in $1/\\sigma^2$, which implies exponentially large expected transition times between components and severe finite-time bias for estimators that depend on both components.\n\nC. If one instead uses an independence MH sampler with proposal $q(y)=\\mathcal{N}(0,\\tau^2)$, the chain is uniformly ergodic for all $\\tau>0$ because $q$ has positive density everywhere on $\\mathbb{R}$.\n\nD. Any proposal landing in the gap region $\\{-1<x<1\\}$ is accepted with probability $1$ because the MH acceptance ratio uses unnormalized densities.\n\nE. The random-walk MH chain is reducible because the target support $S$ is disconnected.\n\nSelect all correct options.",
            "solution": "The problem statement is a valid exercise in analyzing the properties of the Metropolis-Hastings (MH) algorithm. It is scientifically grounded, well-posed, objective, and contains all necessary information. We may proceed with the solution.\n\nThe unnormalized target density is given by $\\tilde{\\pi}(x) = \\exp(-x^2)\\,\\mathbf{1}_{\\{|x|\\ge 1\\}}$. The support of this distribution is the set $S = (-\\infty,-1]\\cup[1,\\infty)$. The proposal distribution is a random-walk Gaussian, $q(y\\mid x) = \\mathcal{N}(x,\\sigma^2)$, which is a normal distribution with mean $x$ and variance $\\sigma^2$. The density function for the proposal is $q(y|x) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}}\\exp\\left(-\\frac{(y-x)^2}{2\\sigma^2}\\right)$. Since this function is symmetric in $x$ and $y$, i.e., $q(y|x) = q(x|y)$, the Metropolis-Hastings acceptance probability simplifies to the Metropolis form:\n$$ \\alpha(y|x) = \\min\\left(1, \\frac{\\tilde{\\pi}(y)q(x|y)}{\\tilde{\\pi}(x)q(y|x)}\\right) = \\min\\left(1, \\frac{\\tilde{\\pi}(y)}{\\tilde{\\pi}(x)}\\right) $$\nFor a proposed move from a current state $x \\in S$ to a new state $y$, the acceptance probability is:\n$$ \\alpha(y|x) = \\begin{cases} \\min\\left(1, \\frac{\\exp(-y^2)}{\\exp(-x^2)}\\right) & \\text{if } |y| \\ge 1 \\\\ 0 & \\text{if } |y| < 1 \\end{cases} $$\nThe chain moves from $X_t=x$ to $X_{t+1}=y$ with probability $\\alpha(y|x)$ if a state $y$ is proposed. Otherwise, the chain remains at $x$, i.e., $X_{t+1}=x$.\n\nWe now evaluate each statement.\n\n**A. For any $\\sigma>0$, the resulting Markov chain on $S$ is irreducible and aperiodic, and hence converges in distribution to $\\pi$.**\n\n*   **Irreducibility**: A Markov chain on a state space $S$ is irreducible if it is possible to go from any state (or non-empty set of states) to any other non-empty set of states. For a continuous state space, this means the transition kernel allows movement between any two regions of positive measure. Let's consider any two states $x \\in S$ and $y \\in S$. The proposal density $q(y|x)$ is a Gaussian density, which is strictly positive for all real numbers $x$ and $y$. Thus, for any $x, y \\in S$, the probability of proposing a move from $x$ to a neighborhood of $y$ is positive. The acceptance probability is $\\alpha(y|x) = \\min(1, \\exp(x^2-y^2))$. Since $x, y \\in S$, $\\tilde{\\pi}(x) > 0$ and $\\tilde{\\pi}(y) > 0$, which implies $\\alpha(y|x) > 0$. Since both the proposal density and the acceptance probability are positive for any pair of states in the support $S$, the chain can transition between any region in $S$ to any other region in $S$. Therefore, the chain is irreducible. The disconnected nature of the support $S$ does not imply reducibility because the proposal distribution can \"jump\" over the gap.\n*   **Aperiodicity**: A chain is aperiodic if it does not get trapped in cycles. A sufficient condition for aperiodicity is that for any state $x$, the probability of staying in that state, $P(X_{t+1}=x|X_t=x)$, is positive. In the MH algorithm, a move can be rejected, causing the chain to stay in the same state. The probability of rejection is $1-\\int_S q(y|x)\\alpha(y|x)dy$. Since the total acceptance probability is less than $1$, the rejection probability is greater than $0$. Thus, $P(X_{t+1}=x|X_t=x) > 0$, and the chain is aperiodic.\n*   **Convergence**: An irreducible, aperiodic Markov chain that has $\\pi$ as its invariant distribution is guaranteed to converge to $\\pi$ in distribution. The MH algorithm is constructed specifically to ensure that $\\pi$ is the invariant distribution. Given that the chain is irreducible and aperiodic, it will converge to the target distribution $\\pi(x)$.\n\nTherefore, the statement is **Correct**.\n\n**B. When $\\sigma$ is sufficiently small, the probability of proposing a jump from the left component $\\{x\\le -1\\}$ to the right component $\\{x\\ge 1\\}$ is exponentially small in $1/\\sigma^2$, which implies exponentially large expected transition times between components and severe finite-time bias for estimators that depend on both components.**\n\n*   Let the chain be in the left component, at a state $x \\le -1$. A jump to the right component, $[1, \\infty)$, requires proposing a state $y \\ge 1$. The proposal is drawn from $Y \\sim \\mathcal{N}(x, \\sigma^2)$. The probability of proposing such a jump is $P(Y \\ge 1)$. This probability is maximized for $x$ closest to the gap, i.e., $x = -1$.\n*   For $x=-1$, the probability of proposing a state $y \\ge 1$ is:\n    $$ P(Y \\ge 1) = P\\left(\\frac{Y - (-1)}{\\sigma} \\ge \\frac{1 - (-1)}{\\sigma}\\right) = P\\left(Z \\ge \\frac{2}{\\sigma}\\right) $$\n    where $Z \\sim \\mathcal{N}(0,1)$ is a standard normal random variable.\n*   For small $\\sigma > 0$, the value $z = 2/\\sigma$ is large. The tail probability of a standard normal distribution, $P(Z \\ge z)$, can be approximated for large $z$ using Mill's ratio or other bounds, which show it behaves like $\\frac{1}{z\\sqrt{2\\pi}}\\exp(-z^2/2)$. Substituting $z=2/\\sigma$:\n    $$ P\\left(Z \\ge \\frac{2}{\\sigma}\\right) \\propto \\frac{\\sigma}{2} \\exp\\left(-\\frac{(2/\\sigma)^2}{2}\\right) = \\frac{\\sigma}{2} \\exp\\left(-\\frac{2}{\\sigma^2}\\right) $$\n*   This probability is exponentially small in $1/\\sigma^2$. Since the acceptance probability is at most $1$, the total probability of transitioning between components is also exponentially small.\n*   The expected number of steps to make such a transition is inversely proportional to this probability, and is therefore exponentially large in $1/\\sigma^2$. This means the sampler will mix very slowly between the two components.\n*   If a simulation is run for a finite number of steps that is much smaller than this expected transition time, the chain will likely remain trapped in its starting component. Any statistical estimator that relies on sampling from the entire support (e.g., the mean, which should be $0$ by symmetry) will be severely biased towards the values in the explored component.\n\nTherefore, the statement is **Correct**.\n\n**C. If one instead uses an independence MH sampler with proposal $q(y)=\\mathcal{N}(0,\\tau^2)$, the chain is uniformly ergodic for all $\\tau>0$ because $q$ has positive density everywhere on $\\mathbb{R}$.**\n\n*   An independence sampler proposes moves from a distribution $q(y)$ that is independent of the current state $x$. A sufficient condition for uniform ergodicity of an independence sampler is that the ratio of the target density to the proposal density, $w(x) = \\tilde{\\pi}(x)/q(x)$, must be bounded over the support $S$.\n*   Let's compute this ratio for $|x| \\ge 1$:\n    $$ w(x) = \\frac{\\tilde{\\pi}(x)}{q(x)} = \\frac{\\exp(-x^2)}{\\frac{1}{\\sqrt{2\\pi\\tau^2}}\\exp(-x^2/(2\\tau^2))} = \\sqrt{2\\pi\\tau^2} \\exp\\left(-x^2 + \\frac{x^2}{2\\tau^2}\\right) = \\sqrt{2\\pi\\tau^2} \\exp\\left(x^2\\left(\\frac{1}{2\\tau^2} - 1\\right)\\right) $$\n*   For $w(x)$ to be bounded for all $x \\in S$, the term in the exponent cannot be positive. If the coefficient of $x^2$ is positive, $w(x)$ will grow without bound as $|x| \\to \\infty$.\n*   The coefficient is $\\frac{1}{2\\tau^2} - 1$. This is positive if $\\frac{1}{2\\tau^2} > 1$, which simplifies to $\\tau^2 < 1/2$.\n*   When $\\tau^2 < 1/2$, the ratio $w(x)$ is unbounded on $S$. Therefore, the chain is not uniformly ergodic in this case.\n*   The statement claims uniform ergodicity for all $\\tau > 0$. Since we have found a range of $\\tau$ for which this fails, the statement is false. The justification given (\"because $q$ has positive density everywhere on $\\mathbb{R}$\") is a condition for irreducibility, not uniform ergodicity.\n\nTherefore, the statement is **Incorrect**.\n\n**D. Any proposal landing in the gap region $\\{-1<x<1\\}$ is accepted with probability $1$ because the MH acceptance ratio uses unnormalized densities.**\n\n*   Let the current state be $x \\in S$. A new state $y$ is proposed such that $-1 < y < 1$.\n*   According to the definition of the unnormalized target density, $\\tilde{\\pi}(y) = \\exp(-y^2) \\cdot \\mathbf{1}_{\\{|y|\\ge 1\\}}$. Since $|y| < 1$, the indicator function $\\mathbf{1}_{\\{|y|\\ge 1\\}}$ is $0$. Thus, $\\tilde{\\pi}(y) = 0$.\n*   The current state $x$ is in the support $S$, so $\\tilde{\\pi}(x) = \\exp(-x^2) > 0$.\n*   The acceptance probability is $\\alpha(y|x) = \\min\\left(1, \\frac{\\tilde{\\pi}(y)}{\\tilde{\\pi}(x)}\\right) = \\min\\left(1, \\frac{0}{\\exp(-x^2)}\\right) = \\min(1, 0) = 0$.\n*   A proposal landing in the gap region is always rejected (i.e., accepted with probability $0$), not accepted with probability $1$. The use of unnormalized densities is standard and does not change this outcome.\n\nTherefore, the statement is **Incorrect**.\n\n**E. The random-walk MH chain is reducible because the target support $S$ is disconnected.**\n\n*   This statement claims the chain is reducible. As established in the analysis of statement A, the chain is irreducible.\n*   Reducibility would mean there exists a partition of the state space $S$ into sets from which the chain cannot escape. For example, if the chain could not move from the component $(-\\infty, -1]$ to $[1, \\infty)$.\n*   However, the Gaussian proposal distribution $q(y|x) = \\mathcal{N}(x,\\sigma^2)$ has a density that is positive over all of $\\mathbb{R}$. This means that for any starting point $x \\in (-\\infty, -1]$, there is a non-zero probability density of proposing any state $y \\in [1, \\infty)$.\n*   As shown in the analysis for A, the acceptance probability for such a move, $\\alpha(y|x)$, is also positive.\n*   Since transitions between the two disconnected components of the support are possible (with positive probability), the chain is not reducible. The statement makes a common but incorrect inference that a disconnected support implies a reducible chain.\n\nTherefore, the statement is **Incorrect**.",
            "answer": "$$\\boxed{AB}$$"
        },
        {
            "introduction": "Many real-world simulation problems involve parameters that are not free to vary over all of $\\mathbb{R}^n$, but are subject to constraints, such as compositions that must sum to one. A naive proposal mechanism will fail in such cases, either by violating the constraints or by failing to satisfy detailed balance. This final practice  challenges you to evaluate several advanced strategies for designing valid and efficient Metropolis-Hastings samplers on a constrained space known as the simplex, a common task in fields from materials science to finance.",
            "id": "2442824",
            "problem": "Consider a portfolio selection problem with $K \\ge 3$ assets. The portfolio weights are collected in $\\mathbf{w}=(w_1,\\dots,w_K)$ constrained to the open unit simplex $\\Delta^{K-1}=\\{\\mathbf{w}\\in \\mathbb{R}^K: w_i>0 \\text{ for all } i, \\ \\sum_{i=1}^K w_i=1\\}$. Suppose the target density over $\\mathbf{w}$, denoted $\\pi(\\mathbf{w})$, is known up to a multiplicative normalizing constant, and can be evaluated pointwise on $\\Delta^{K-1}$. You wish to construct a Metropolis-Hastings (MH) step within a Markov chain Monte Carlo (MCMC) algorithm that leaves $\\pi(\\mathbf{w})$ invariant and is implementable.\n\nWhich of the following proposal mechanisms define a valid and implementable Metropolis-Hastings transition on $\\Delta^{K-1}$ that (i) respects the constraints $w_i>0$ and $\\sum_i w_i=1$, (ii) is irreducible on the open simplex, and (iii) uses an acceptance probability that can be evaluated from known densities? Select all that apply.\n\nA. Additive Euclidean Gaussian with ad hoc projection: Propose $\\mathbf{w}'=\\mathbf{w}+\\boldsymbol{\\epsilon}$ with $\\boldsymbol{\\epsilon}\\sim \\mathcal{N}(\\mathbf{0},\\sigma^2 \\mathbf{I}_K)$, then set $w'_i\\leftarrow \\max\\{w'_i,0\\}$ for each $i$ and renormalize by $w'_i\\leftarrow w'_i/\\sum_{j=1}^K w'_j$. Accept with probability $\\min\\{1,\\ \\pi(\\mathbf{w}')/\\pi(\\mathbf{w})\\}$.\n\nB. Dirichlet random-walk on the simplex: Given tuning parameter $\\kappa>0$, propose $\\mathbf{w}'\\sim \\mathrm{Dirichlet}(\\kappa \\mathbf{w})$, and accept with probability $\\min\\left\\{1,\\ \\frac{\\pi(\\mathbf{w}')\\, q(\\mathbf{w}\\mid \\mathbf{w}')}{\\pi(\\mathbf{w})\\, q(\\mathbf{w}'\\mid \\mathbf{w})}\\right\\}$ where $q(\\cdot\\mid\\cdot)$ is the Dirichlet density.\n\nC. Pairwise exchange move with symmetric step: Choose an ordered pair $(i,j)$ uniformly from all $i\\neq j$. Draw $\\varepsilon$ uniformly from the interval $(-w_i,\\, w_j)$ and set $w'_i=w_i+\\varepsilon$, $w'_j=w_j-\\varepsilon$, and $w'_k=w_k$ for all $k\\notin\\{i,j\\}$. Accept with probability $\\min\\{1,\\ \\pi(\\mathbf{w}')/\\pi(\\mathbf{w})\\}$.\n\nD. Logistic-normal random walk in a bijective transform: Define $z_k=\\log(w_k/w_K)$ for $k=1,\\dots,K-1$ so that $\\mathbf{z}\\in \\mathbb{R}^{K-1}$. Propose $\\mathbf{z}'=\\mathbf{z}+\\boldsymbol{\\eta}$ with $\\boldsymbol{\\eta}\\sim \\mathcal{N}(\\mathbf{0},\\boldsymbol{\\Sigma})$, map back by $w'_k=\\exp(z'_k)/\\left(1+\\sum_{\\ell=1}^{K-1}\\exp(z'_\\ell)\\right)$ for $k=1,\\dots,K-1$ and $w'_K=1-\\sum_{k=1}^{K-1}w'_k$, and accept with probability $\\min\\left\\{1,\\ \\frac{\\pi(\\mathbf{w}')\\, |J(\\mathbf{z}')|}{\\pi(\\mathbf{w})\\, |J(\\mathbf{z})|}\\right\\}$, where $|J(\\mathbf{z})|$ is the absolute determinant of the Jacobian of the softmax map from $\\mathbf{z}$ to $\\mathbf{w}$.\n\nE. Independence proposal from a fixed Dirichlet: Fix $\\boldsymbol{\\alpha}\\in (0,\\infty)^K$ and propose $\\mathbf{w}'\\sim \\mathrm{Dirichlet}(\\boldsymbol{\\alpha})$ independently of $\\mathbf{w}$. Accept with probability $\\min\\left\\{1,\\ \\frac{\\pi(\\mathbf{w}')\\, q(\\mathbf{w})}{\\pi(\\mathbf{w})\\, q(\\mathbf{w}')}\\right\\}$ where $q$ is the Dirichlet density.\n\nF. Local uniform move in an $\\ell_2$ ball with symmetry assumed: Fix $r>0$. Propose $\\mathbf{w}'$ uniformly over $\\{\\mathbf{u}\\in \\Delta^{K-1}: \\|\\mathbf{u}-\\mathbf{w}\\|_2\\le r\\}$ and accept with probability $\\min\\{1,\\ \\pi(\\mathbf{w}')/\\pi(\\mathbf{w})\\}$.\n\nChoose all options that satisfy the stated criteria.",
            "solution": "The task is to validate several proposed Metropolis-Hastings (MH) transition mechanisms for sampling from a target density $\\pi(\\mathbf{w})$ defined on the open unit simplex $\\Delta^{K-1} = \\{\\mathbf{w}\\in \\mathbb{R}^K: w_i>0 \\text{ for all } i, \\ \\sum_{i=1}^K w_i=1\\}$. A valid mechanism must produce proposals $\\mathbf{w}'$ that remain in $\\Delta^{K-1}$, ensure the resulting Markov chain is irreducible on $\\Delta^{K-1}$, and use a correctly formulated and evaluable acceptance probability $\\alpha(\\mathbf{w}', \\mathbf{w})$.\n\nThe general form of the MH acceptance probability for a proposal density $q(\\mathbf{w}' \\mid \\mathbf{w})$ is:\n$$ \\alpha(\\mathbf{w}', \\mathbf{w}) = \\min\\left\\{1, \\frac{\\pi(\\mathbf{w}') q(\\mathbf{w} \\mid \\mathbf{w}')}{\\pi(\\mathbf{w}) q(\\mathbf{w}' \\mid \\mathbf{w})}\\right\\} $$\nIf the proposal density is symmetric, i.e., $q(\\mathbf{w}' \\mid \\mathbf{w}) = q(\\mathbf{w} \\mid \\mathbf{w}')$, this simplifies to the Metropolis acceptance probability:\n$$ \\alpha(\\mathbf{w}', \\mathbf{w}) = \\min\\left\\{1, \\frac{\\pi(\\mathbf{w}')}{\\pi(\\mathbf{w})}\\right\\} $$\nThe target density $\\pi(\\mathbf{w})$ is known up to a constant, so the ratio $\\pi(\\mathbf{w}')/\\pi(\\mathbf{w})$ is evaluable.\n\nWe will now analyze each option.\n\n**A. Additive Euclidean Gaussian with ad hoc projection**\n\nThis proposal mechanism consists of three steps:\n1.  Propose an unconstrained move: $\\mathbf{y} = \\mathbf{w} + \\boldsymbol{\\epsilon}$, where $\\boldsymbol{\\epsilon} \\sim \\mathcal{N}(\\mathbf{0}, \\sigma^2 \\mathbf{I}_K)$.\n2.  Project to the non-negative orthant: $y'_i = \\max\\{y_i, 0\\}$ for all $i=1,\\dots,K$.\n3.  Renormalize to the simplex: $\\mathbf{w}' = \\mathbf{y}' / \\sum_{j=1}^K y'_j$.\n\nThe proposed acceptance probability is $\\min\\{1, \\pi(\\mathbf{w}')/\\pi(\\mathbf{w})\\}$. This is valid only if the proposal density $q(\\mathbf{w}' \\mid \\mathbf{w})$ is symmetric.\n\nThe overall transformation from $\\mathbf{w}$ to $\\mathbf{w}'$ is a complex, non-linear function involving random noise, truncation, and normalization. The density $q(\\mathbf{w}' \\mid \\mathbf{w})$ is not symmetric. For example, the probability of proposing a move from a point $\\mathbf{w}$ in the center of the simplex to a point $\\mathbf{w}'$ near a boundary is not the same as the probability of the reverse move from $\\mathbf{w}'$ to $\\mathbf{w}$. The projection and normalization distort the underlying symmetric Gaussian proposal in a state-dependent manner. Calculating the correct Hastings correction term $q(\\mathbf{w} \\mid \\mathbf{w}') / q(\\mathbf{w}' \\mid \\mathbf{w})$ would require computing the Jacobian of this complex transformation, which is generally intractable. Using the symmetric Metropolis formula makes the algorithm incorrect, as it will not leave $\\pi(\\mathbf{w})$ invariant.\n\nVerdict: **Incorrect**.\n\n**B. Dirichlet random-walk on the simplex**\n\nThe proposal is $\\mathbf{w}' \\sim \\mathrm{Dirichlet}(\\kappa \\mathbf{w})$, where $\\kappa > 0$ is a tuning parameter.\n1.  **Constraints**: Since $\\mathbf{w} \\in \\Delta^{K-1}$, we have $w_i > 0$ for all $i$. With $\\kappa > 0$, the parameters $\\kappa w_i$ of the Dirichlet proposal are all positive. A draw from a Dirichlet distribution with positive parameters lies in the open simplex. Thus, $\\mathbf{w}' \\in \\Delta^{K-1}$.\n2.  **Irreducibility**: The support of the a Dirichlet distribution with all positive parameters is the entire open simplex. Therefore, it is possible to move from any $\\mathbf{w}$ to any neighborhood in $\\Delta^{K-1}$. The chain is irreducible.\n3.  **Acceptance Probability**: The proposal density is the Dirichlet density, $q(\\mathbf{w}' \\mid \\mathbf{w}) = \\frac{\\Gamma(\\kappa)}{\\prod_{i=1}^K \\Gamma(\\kappa w_i)} \\prod_{i=1}^K (w'_i)^{\\kappa w_i - 1}$. The reverse proposal density is $q(\\mathbf{w} \\mid \\mathbf{w}') = \\frac{\\Gamma(\\kappa)}{\\prod_{i=1}^K \\Gamma(\\kappa w'_i)} \\prod_{i=1}^K w_i^{\\kappa w'_i - 1}$. The proposal is not symmetric. The option provides the correct general Hastings acceptance probability $\\min\\left\\{1,\\ \\frac{\\pi(\\mathbf{w}')\\, q(\\mathbf{w}\\mid \\mathbf{w}')}{\\pi(\\mathbf{w})\\, q(\\mathbf{w}'\\mid \\mathbf{w})}\\right\\}$. All terms in this expression are evaluable, as the Dirichlet density is a standard function.\n\nVerdict: **Correct**.\n\n**C. Pairwise exchange move with symmetric step**\n\nThe proposal is generated by picking an ordered pair $(i,j)$ with $i \\neq j$ uniformly, drawing $\\varepsilon \\sim \\mathrm{Uniform}(-w_i, w_j)$, and setting $w'_i = w_i + \\varepsilon$, $w'_j = w_j - \\varepsilon$.\n1.  **Constraints**: The sum is preserved: $\\sum_k w'_k = (w_i+\\varepsilon) + (w_j-\\varepsilon) + \\sum_{k\\neq i,j} w_k = 1$. The positivity is also preserved: $w'_i = w_i + \\varepsilon > w_i - w_i = 0$ and $w'_j = w_j - \\varepsilon > w_j - w_j = 0$. So $\\mathbf{w}' \\in \\Delta^{K-1}$.\n2.  **Irreducibility**: For $K \\geq 3$, one can transfer mass between any two components, say from $i$ to $j$, and then from $j$ to $k$. By composing such moves, it is possible to reach any point in the simplex from any other point. The chain is irreducible.\n3.  **Acceptance Probability**: The proposed probability is $\\min\\{1, \\pi(\\mathbf{w}')/\\pi(\\mathbf{w})\\}$, implying symmetry. Let us check if $q(\\mathbf{w}' \\mid \\mathbf{w}) = q(\\mathbf{w} \\mid \\mathbf{w}')$. The proposal is uniquely defined by the choice of the pair $(i, j)$ and the value $\\varepsilon$. The density of proposing a move from $\\mathbf{w}$ to $\\mathbf{w}'$ via a specific pair $(i,j)$ and a step $\\varepsilon$ is proportional to the probability of picking $(i,j)$ and the density of $\\varepsilon$. The number of ordered pairs is $K(K-1)$. The density of $\\varepsilon$ is $1/(w_i+w_j)$. So, the density of this particular transition is proportional to $\\frac{1}{K(K-1)} \\frac{1}{w_i+w_j}$.\nThe reverse move, from $\\mathbf{w}'$ to $\\mathbf{w}$, requires setting $w_i = w'_i - \\varepsilon$ and $w_j = w'_j + \\varepsilon$. This corresponds to picking the pair $(j,i)$ and proposing a step of $-\\varepsilon$. The range for the new step $\\varepsilon'$ is $(-w'_i, w'_j)$. We have $\\varepsilon \\in (-w_i, w_j)$, so $-\\varepsilon \\in (-w_j, w_i)$. The range from which the reverse step must be drawn is $(-w'_i, w'_j)$. Since $w'_i = w_i+\\varepsilon$ and $w'_j = w_j-\\varepsilon$, this range is $(-w_i-\\varepsilon, w_j-\\varepsilon)$. This is not symmetric.\nLet us re-read the proposal: \"Draw $\\varepsilon$ uniformly from the interval $(-w_i,\\, w_j)$ and set $w'_i=w_i+\\varepsilon, w'_j=w_j-\\varepsilon$\". This means mass is transferred from component $j$ to component $i$ by an amount $\\varepsilon$. The reverse move requires transferring mass from $i$ to $j$ by amount $\\varepsilon$. This would be accomplished by choosing pair $(j,i)$ and drawing from $U(-w_j, w_i)$.\nThis implies a more complex symmetry.\nLet's reconsider the density. The proposal density cannot depend on the direction of the move. For a specific transition $\\mathbf{w} \\rightarrow \\mathbf{w}'$ where $w'_i = w_i+\\epsilon$ and $w'_j = w_j-\\epsilon$, the probability density is $q(\\mathbf{w}'|\\mathbf{w}) = \\frac{1}{K(K-1)} \\frac{1}{w_i+w_j}$. For the reverse transition $\\mathbf{w}' \\rightarrow \\mathbf{w}$, we have $w_i = w'_i-\\epsilon$ and $w_j=w'_j+\\epsilon$. The probability density is $q(\\mathbf{w}|\\mathbf{w}') = \\frac{1}{K(K-1)} \\frac{1}{w'_i+w'_j}$.\nSince $w'_i+w'_j = (w_i+\\varepsilon) + (w_j-\\varepsilon) = w_i+w_j$, the forward and reverse transition densities are equal. The proposal is symmetric. Therefore, the simple Metropolis acceptance probability is correct.\n\nVerdict: **Correct**.\n\n**D. Logistic-normal random walk in a bijective transform**\n\nThis method transforms the constrained problem on $\\Delta^{K-1}$ to an unconstrained problem on $\\mathbb{R}^{K-1}$ using the additive log-ratio (ALR) transform: $z_k=\\log(w_k/w_K)$ for $k=1,\\dots,K-1$. A symmetric Gaussian random walk, $\\mathbf{z}'=\\mathbf{z}+\\boldsymbol{\\eta}$ with $\\boldsymbol{\\eta}\\sim \\mathcal{N}(\\mathbf{0},\\boldsymbol{\\Sigma})$, is performed in the unconstrained space.\n1.  **Constraints**: The inverse transformation (a softmax function) maps any point from $\\mathbb{R}^{K-1}$ back to the open simplex $\\Delta^{K-1}$. So, the constraints are always satisfied.\n2.  **Irreducibility**: The Gaussian random walk is irreducible on $\\mathbb{R}^{K-1}$. Since the ALR transform is a bijection between $\\Delta^{K-1}$ and $\\mathbb{R}^{K-1}$, the resulting chain on $\\mathbf{w}$ is irreducible.\n3.  **Acceptance Probability**: When performing a change of variables, the target density in the new space becomes $\\pi_{\\mathbf{z}}(\\mathbf{z}) = \\pi(\\mathbf{w}(\\mathbf{z})) |J(\\mathbf{z})|$, where $|J(\\mathbf{z})|$ is the absolute value of the Jacobian determinant of the map $\\mathbf{z} \\mapsto \\mathbf{w}$. The proposal for $\\mathbf{z}$ is symmetric, so the acceptance probability is $\\min\\left\\{1, \\frac{\\pi_{\\mathbf{z}}(\\mathbf{z}')}{\\pi_{\\mathbf{z}}(\\mathbf{z})}\\right\\} = \\min\\left\\{1, \\frac{\\pi(\\mathbf{w}')|J(\\mathbf{z}')|}{\\pi(\\mathbf{w})|J(\\mathbf{z})|}\\right\\}$, where $\\mathbf{w}'=\\mathbf{w}(\\mathbf{z}')$. This matches the formula in the option. The Jacobian determinant for the ALR transform is $|J(\\mathbf{z})| = \\prod_{k=1}^K w_k$, which is easily computed. All parts are evaluable.\n\nVerdict: **Correct**.\n\n**E. Independence proposal from a fixed Dirichlet**\n\nThis is an independence sampler. A candidate $\\mathbf{w}'$ is drawn from a fixed proposal distribution $q(\\mathbf{w}') = \\mathrm{Dirichlet}(\\mathbf{w}' \\mid \\boldsymbol{\\alpha})$, independently of the current state $\\mathbf{w}$.\n1.  **Constraints**: As with option B, a draw from a Dirichlet with positive parameters $\\boldsymbol{\\alpha}$ lies in the open simplex $\\Delta^{K-1}$.\n2.  **Irreducibility**: The proposal distribution has support over the entire open simplex, so any state can be reached from any other state in one step. The chain is irreducible.\n3.  **Acceptance Probability**: For an independence sampler, $q(\\mathbf{w}' \\mid \\mathbf{w}) = q(\\mathbf{w}')$ and $q(\\mathbf{w} \\mid \\mathbf{w}') = q(\\mathbf{w})$. The general MH acceptance probability becomes $\\alpha = \\min\\left\\{1, \\frac{\\pi(\\mathbf{w}') q(\\mathbf{w})}{\\pi(\\mathbf{w}) q(\\mathbf{w}')}\\right\\}$. This matches the formula in the option. The Dirichlet density $q$ is evaluable, so the acceptance probability is implementable.\n\nVerdict: **Correct**.\n\n**F. Local uniform move in an $\\ell_2$ ball with symmetry assumed**\n\nThe proposal is to draw $\\mathbf{w}'$ uniformly from the set $S_{\\mathbf{w},r} = \\{\\mathbf{u}\\in \\Delta^{K-1}: \\|\\mathbf{u}-\\mathbf{w}\\|_2\\le r\\}$. The proposed acceptance probability $\\min\\{1, \\pi(\\mathbf{w}')/\\pi(\\mathbf{w})\\}$ assumes a symmetric proposal density.\n1.  **Symmetry**: The proposal density is $q(\\mathbf{w}' \\mid \\mathbf{w}) = 1/\\text{Vol}(S_{\\mathbf{w},r})$ if $\\mathbf{w}' \\in S_{\\mathbf{w},r}$ and $0$ otherwise. For this to be symmetric, we require $\\text{Vol}(S_{\\mathbf{w},r}) = \\text{Vol}(S_{\\mathbf{w}',r})$ for any valid move. The set $S_{\\mathbf{w},r}$ is the intersection of the simplex $\\Delta^{K-1}$ with an $\\ell_2$ ball centered at $\\mathbf{w}$. The $(K-1)$-dimensional volume of this region depends on $\\mathbf{w}$. If $\\mathbf{w}$ is close to a boundary of the simplex, the ball will be truncated by the boundary, resulting in a smaller volume than if $\\mathbf{w}$ were in the center of the simplex. Thus, $\\text{Vol}(S_{\\mathbf{w},r})$ is not constant, the proposal density is not symmetric, and the proposed acceptance probability is wrong.\n2.  **Implementability**: Sampling uniformly from this complex geometric region (an intersection of a hyperplane, half-spaces, and a hypersphere) is a very difficult computational problem. It is not considered practically implementable with standard library functions.\n\nVerdict: **Incorrect**.\n\nIn conclusion, options B, C, D, and E describe valid and implementable Metropolis-Hastings transition mechanisms.",
            "answer": "$$\\boxed{BCDE}$$"
        }
    ]
}