{
    "hands_on_practices": [
        {
            "introduction": "Metropolis-Hastings 算法的核心在于其接受准则，该准则通过确保马尔可夫链满足细致平衡条件，最终使其收敛到目标分布。第一个练习将带你回到算法的基石，通过一个离散状态空间的简单场景，让你亲手计算接受概率 ()。这个基础练习旨在确保你对算法中提议分布和目标分布如何共同决定转移可能性的计算细节有清晰的理解。",
            "id": "1962671",
            "problem": "一个计算模拟使用 Metropolis-Hastings 算法来探索蛋白质的构象状态。该模型将蛋白质的结构简化为三个可能的离散状态：状态1、状态2和状态3。模拟的目标是从一个目标平稳分布 $\\pi$ 中生成样本，该分布代表了在每个状态下找到该蛋白质的平衡概率。这个目标分布由下式给出：\n$\\pi(\\text{State 1}) = 0.1$\n$\\pi(\\text{State 2}) = 0.3$\n$\\pi(\\text{State 3}) = 0.6$\n\n该算法根据提议分布 $q(j|i)$，从当前状态 $i$ 提议移动到一个新状态 $j$。提议机制定义如下：\n- 从状态1，以概率 $0.2$ 提议移动到状态2，以概率 $0.8$ 提议移动到状态3。\n- 从状态2，以概率 $0.5$ 提议移动到状态1，以概率 $0.5$ 提议移动到状态3。\n- 从状态3，以概率 $0.1$ 提议移动到状态1，以概率 $0.9$ 提议移动到状态2。\n\n假设模拟当前处于状态1，并且提议了向状态3的移动。计算此特定转移的接受概率。将你的最终答案表示为最简分数。",
            "solution": "在 Metropolis-Hastings 算法中，对于从当前状态 $i$ 提议移动到新状态 $j$ 的接受概率为\n$$\n\\alpha_{i \\to j} = \\min\\left(1, \\frac{\\pi(j)\\,q(i \\mid j)}{\\pi(i)\\,q(j \\mid i)}\\right).\n$$\n对于从状态1到状态3的提议转移，我们使用给定的目标概率和提议概率。\n\n我们将给定的值代入接受率公式中：\n- 目标概率：$\\pi(3) = 0.6$ 和 $\\pi(1) = 0.1$\n- 提议概率：$q(3 \\mid 1) = 0.8$（从状态1提议状态3的概率）和 $q(1 \\mid 3) = 0.1$（从状态3提议状态1的概率）\n\n代入接受率公式中的比率部分：\n$$\n\\frac{\\pi(3)\\,q(1 \\mid 3)}{\\pi(1)\\,q(3 \\mid 1)} = \\frac{(0.6) \\times (0.1)}{(0.1) \\times (0.8)} = \\frac{0.06}{0.08} = \\frac{6}{8} = \\frac{3}{4}.\n$$\n因此，接受概率为：\n$$\n\\alpha_{1 \\to 3} = \\min\\left(1, \\frac{3}{4}\\right) = \\frac{3}{4}.\n$$",
            "answer": "$$\\boxed{\\frac{3}{4}}$$"
        },
        {
            "introduction": "在实践中，仅仅正确实现算法是不够的，我们更关心的是采样效率。提议分布的步长是一个关键的调节参数，它直接影响采样器探索状态空间的速度。这个练习 () 提出了一个看似反直觉但极为常见的情景：极高的接受率。通过分析这种情况，你将学会诊断 MCMC 运行中的一个关键问题，并理解接受率与采样器混合效率之间的微妙平衡。",
            "id": "1962675",
            "problem": "一位数据科学家正在使用Metropolis算法（Metropolis-Hastings算法的一个特例）从一维、连续、单峰的目标概率密度函数$\\pi(x)$中生成样本。该算法的工作原理如下：在每一步$t$，给定当前状态$x_t$，从一个对称的提议分布$q(x'|x_t) = q(x_t|x')$中提出一个新的候选状态$x'$。在这种情况下，提议分布是一个以当前状态为中心的正态分布，$x' \\sim N(x_t, \\sigma^2)$，其中标准差$\\sigma$是一个控制步长的调节参数。\n\n新状态$x'$以概率$\\alpha = \\min\\left(1, \\frac{\\pi(x')}{\\pi(x_t)}\\right)$被接受。如果被接受，下一个状态是$x_{t+1} = x'$；否则，马尔可夫链保持在同一状态，$x_{t+1} = x_t$。\n\n在运行采样器大量迭代后，该数据科学家观察到接受率稳定在99.5%左右。在马尔可夫链蒙特卡洛（MCMC）诊断的背景下，下列哪项陈述为这一观察提供了最准确且最可能的解释？\n\nA. 采样器表现最佳，因为高接受率确保了生成的样本是目标分布的完美表示。\n\nB. 提议步长$\\sigma$可能太大了，导致采样器在目标分布的尾部提出状态，而这些状态几乎总是被拒绝。\n\nC. 采样器已成功收敛到平稳分布，后续样本可以被视为来自$\\pi(x)$的独立抽取。\n\nD. 提议步长$\\sigma$可能太小了，导致采样器探索状态空间的速度非常慢且效率低下，尽管大多数步骤都被接受了。\n\nE. 目标分布$\\pi(x)$必定近似于均匀分布，这就是为什么几乎每个提议的状态都被接受的原因。",
            "solution": "给定一个对称提议$q(x'|x_{t})=q(x_{t}|x')$，Metropolis接受概率简化为\n$$\n\\alpha(x_{t},x')=\\min\\left(1,\\frac{\\pi(x')}{\\pi(x_{t})}\\right)=\\min\\left(1,\\exp\\left(\\ln\\pi(x')-\\ln\\pi(x_{t})\\right)\\right).\n$$\n令$x'=x_{t}+\\epsilon$，其中$\\epsilon\\sim N(0,\\sigma^{2})$。定义对数密度$\\ell(x)=\\ln\\pi(x)$。对于可微的单峰$\\pi$，在$x_{t}$附近的泰勒展开给出\n$$\n\\ell(x_{t}+\\epsilon)-\\ell(x_{t})=\\ell'(x_{t})\\,\\epsilon+\\frac{1}{2}\\ell''(x_{t})\\,\\epsilon^{2}+o(\\epsilon^{2}).\n$$\n当$\\sigma$很小时，$\\epsilon$通常是$\\sigma$阶的，所以对数密度的变化很小：\n$$\n\\ell(x_{t}+\\epsilon)-\\ell(x_{t})=\\mathcal{O}(\\sigma)+\\mathcal{O}(\\sigma^{2}).\n$$\n因此$\\exp\\left(\\ell(x_{t}+\\epsilon)-\\ell(x_{t})\\right)\\approx 1$，这意味着$\\alpha(x_{t},x')\\approx 1$。因此，接近$0.995$的接受率是步长$\\sigma$非常小的一个标志：大多数提议的移动在$\\pi$上产生的变化可以忽略不计，所以它们几乎总是被接受。然而，马尔可夫链随后以大小为$\\epsilon=\\mathcal{O}(\\sigma)$的增量移动，因此每次迭代对状态空间的探索都很慢，并且马尔可夫链表现出高自相关性和差的混合效率。\n\n基于此，我们来考虑每个选项：\n- A是不正确的，因为非常高的接受率并不意味着最佳性能或完美表示；过高的接受率通常表示步长过小和探索效率低下。\n- B是不正确的，因为过大的$\\sigma$通常会驱使提议进入低密度区域，导致接受率低而非高。\n- C是不正确的，因为仅凭接受率无法确定收敛性，而且即使在平稳状态下，随机游走Metropolis的样本也不是独立的；在步长很小的情况下，它们具有强烈的自相关性。\n- D是正确的：非常高的接受率强烈表明$\\sigma$太小，导致尽管大多数提议都被接受，但探索速度很慢。\n- E是不正确的，因为接近1的接受率并不要求$\\pi$近似均匀分布；它可能仅仅因为$\\sigma$非常小而产生。一个真正的均匀目标分布对任何提议都会产生恰好为1的接受率，这在此处并未暗示。\n\n因此，最准确的解释是提议步长太小，尽管接受率很高，但导致探索效率低下。",
            "answer": "$$\\boxed{D}$$"
        },
        {
            "introduction": "许多科学问题，尤其是在材料科学和金融领域，其参数被限制在特定的几何空间内，例如表示成分或投资组合权重的单纯形（simplex）。在这种情况下，设计一个有效的提议分布变得极具挑战性。这个高级练习 () 要求你评估多种为单纯形空间设计的提议机制，从简单的启发式方法到复杂的变量变换。完成这个练习将使你具备为复杂约束问题设计和验证有效的 Metropolis-Hastings 采样器的关键能力。",
            "id": "2442824",
            "problem": "考虑一个包含 $K \\ge 3$ 种资产的投资组合选择问题。投资组合的权重汇集在 $\\mathbf{w}=(w_1,\\dots,w_K)$ 中，并被约束在开放单位单纯形 $\\Delta^{K-1} = \\{\\mathbf{w} \\in \\mathbb{R}^K \\mid w_i > 0 \\text{ for all } i, \\sum_{i=1}^K w_i = 1\\}$ 上。假设 $\\mathbf{w}$ 上的目标密度函数（表示为 $\\pi(\\mathbf{w})$）在相差一个乘法归一化常数的情况下是已知的，并且可以在 $\\Delta^{K-1}$ 上进行逐点评估。你希望在一个马尔可夫链蒙特卡洛（MCMC）算法中构建一个Metropolis-Hastings (MH)步骤，该步骤能使 $\\pi(\\mathbf{w})$ 保持不变且是可实现的。\n\n以下哪种提议机制定义了在 $\\Delta^{K-1}$ 上一个有效且可实现的Metropolis-Hastings转移，该转移 (i) 遵守约束条件 $w_i0$ 和 $\\sum_i w_i=1$，(ii) 在开放单纯形上是不可约的，并且 (iii) 使用一个可以从已知密度函数计算出的接受概率？请选择所有适用的选项。\n\nA. 加性欧几里得高斯分布与临时投影：提议 $\\mathbf{w}'=\\mathbf{w}+\\boldsymbol{\\epsilon}$，其中 $\\boldsymbol{\\epsilon}\\sim \\mathcal{N}(\\mathbf{0},\\sigma^2 \\mathbf{I}_K)$，然后对每个 $i$ 设置 $w'_i\\leftarrow \\max\\{w'_i,0\\}$，并通过 $w'_i\\leftarrow w'_i/\\sum_{j=1}^K w'_j$ 进行重新归一化。以概率 $\\min\\{1,\\ \\pi(\\mathbf{w}')/\\pi(\\mathbf{w})\\}$ 接受。\n\nB. 单纯形上的狄利克雷随机游走：给定调整参数 $\\kappa0$，提议 $\\mathbf{w}'\\sim \\mathrm{Dirichlet}(\\kappa \\mathbf{w})$，并以概率 $\\min\\left\\{1,\\ \\frac{\\pi(\\mathbf{w}')\\, q(\\mathbf{w}\\mid \\mathbf{w}')}{\\pi(\\mathbf{w})\\, q(\\mathbf{w}'\\mid \\mathbf{w})}\\right\\}$ 接受，其中 $q(\\cdot\\mid\\cdot)$ 是狄利克雷密度函数。\n\nC. 对称步骤的成对交换移动：从所有 $i\\neq j$ 中均匀选择一个有序对 $(i,j)$。从区间 $(-w_i, w_j)$ 中均匀抽取 $\\varepsilon$，并设置 $w'_i=w_i+\\varepsilon$，$w'_j=w_j-\\varepsilon$，对于所有 $k\\notin\\{i,j\\}$，设置 $w'_k=w_k$。以概率 $\\min\\{1,\\ \\pi(\\mathbf{w}')/\\pi(\\mathbf{w})\\}$ 接受。\n\nD. 双射变换中的对数正态随机游走：对于 $k=1,\\dots,K-1$，定义 $z_k=\\log(w_k/w_K)$，使得 $\\mathbf{z}\\in \\mathbb{R}^{K-1}$。提议 $\\mathbf{z}'=\\mathbf{z}+\\boldsymbol{\\eta}$，其中 $\\boldsymbol{\\eta}\\sim \\mathcal{N}(\\mathbf{0},\\boldsymbol{\\Sigma})$，然后通过 $w'_k=\\exp(z'_k)/\\left(1+\\sum_{\\ell=1}^{K-1}\\exp(z'_\\ell)\\right)$（对于 $k=1,\\dots,K-1$）和 $w'_K=1-\\sum_{k=1}^{K-1}w'_k$ 映射回去，并以概率 $\\min\\left\\{1,\\ \\frac{\\pi(\\mathbf{w}')\\, |J(\\mathbf{z}')|}{\\pi(\\mathbf{w})\\, |J(\\mathbf{z})|}\\right\\}$ 接受，其中 $|J(\\mathbf{z})|$ 是从 $\\mathbf{z}$到 $\\mathbf{w}$ 的 softmax 映射的雅可比行列式的绝对值。\n\nE. 来自固定狄利克雷分布的独立提议：固定 $\\boldsymbol{\\alpha}\\in (0,\\infty)^K$，并独立于 $\\mathbf{w}$ 提议 $\\mathbf{w}'\\sim \\mathrm{Dirichlet}(\\boldsymbol{\\alpha})$。以概率 $\\min\\left\\{1,\\ \\frac{\\pi(\\mathbf{w}')\\, q(\\mathbf{w})}{\\pi(\\mathbf{w})\\, q(\\mathbf{w}')}\\right\\}$ 接受，其中 $q$ 是狄利克雷密度函数。\n\nF. 在假设对称性的情况下，在 $\\ell_2$ 球内的局部均匀移动：固定 $r0$。在集合 $\\{\\mathbf{u}\\in \\Delta^{K-1}: \\|\\mathbf{u}-\\mathbf{w}\\|_2\\le r\\}$ 上均匀地提议 $\\mathbf{w}'$，并以概率 $\\min\\{1,\\ \\pi(\\mathbf{w}')/\\pi(\\mathbf{w})\\}$ 接受。\n\n选择所有满足所述标准的选项。",
            "solution": "任务是验证几种为从定义在开放单位单纯形 $\\Delta^{K-1} = \\{\\mathbf{w} \\in \\mathbb{R}^K \\mid w_i > 0 \\text{ for all } i, \\sum_{i=1}^K w_i = 1\\}$ 上的目标密度 $\\pi(\\mathbf{w})$ 采样而提出的梅特罗波利斯-黑斯廷斯（MH）转移机制。一个有效的机制必须能产生保持在 $\\Delta^{K-1}$ 内的提议 $\\mathbf{w}'$，确保生成的马尔可夫链在 $\\Delta^{K-1}$ 上是不可约的，并使用一个正确表述且可评估的接受概率 $\\alpha(\\mathbf{w}', \\mathbf{w})$。\n\n对于一个提议密度 $q(\\mathbf{w}' \\mid \\mathbf{w})$，MH 接受概率的一般形式是：\n$$ \\alpha(\\mathbf{w}', \\mathbf{w}) = \\min\\left\\{1, \\frac{\\pi(\\mathbf{w}') q(\\mathbf{w} \\mid \\mathbf{w}')}{\\pi(\\mathbf{w}) q(\\mathbf{w}' \\mid \\mathbf{w})}\\right\\} $$\n如果提议密度是对称的，即 $q(\\mathbf{w}' \\mid \\mathbf{w}) = q(\\mathbf{w} \\mid \\mathbf{w}')$，则这简化为梅特罗波利斯接受概率：\n$$ \\alpha(\\mathbf{w}', \\mathbf{w}) = \\min\\left\\{1, \\frac{\\pi(\\mathbf{w}')}{\\pi(\\mathbf{w})}\\right\\} $$\n目标密度 $\\pi(\\mathbf{w})$ 在相差一个常数的情况下是已知的，因此比率 $\\pi(\\mathbf{w}')/\\pi(\\mathbf{w})$ 是可评估的。\n\n我们现在来分析每个选项。\n\n**A. 加性欧几里得高斯分布与临时投影**\n\n该提议机制包括三个步骤：\n1.  提议一个无约束的移动：$\\mathbf{y} = \\mathbf{w} + \\boldsymbol{\\epsilon}$，其中 $\\boldsymbol{\\epsilon} \\sim \\mathcal{N}(\\mathbf{0}, \\sigma^2 \\mathbf{I}_K)$。\n2.  投影到非负象限：对所有 $i=1,\\dots,K$，设置 $y'_i = \\max\\{y_i, 0\\}$。\n3.  重新归一化到单纯形：$\\mathbf{w}' = \\mathbf{y}' / \\sum_{j=1}^K y'_j$。\n\n提议的接受概率是 $\\min\\{1, \\pi(\\mathbf{w}')/\\pi(\\mathbf{w})\\}$。这仅在提议密度 $q(\\mathbf{w}' \\mid \\mathbf{w})$ 是对称的情况下才有效。\n\n从 $\\mathbf{w}$ 到 $\\mathbf{w}'$ 的整体变换是一个复杂的非线性函数，涉及随机噪声、截断和归一化。密度 $q(\\mathbf{w}' \\mid \\mathbf{w})$ 不是对称的。例如，从单纯形中心的一个点 $\\mathbf{w}$ 移动到靠近边界的一个点 $\\mathbf{w}'$ 的提议概率，与从 $\\mathbf{w}'$ 反向移动到 $\\mathbf{w}$ 的概率是不同的。投影和归一化以一种依赖于状态的方式扭曲了底层的对称高斯提议。计算正确的黑斯廷斯修正项 $q(\\mathbf{w} \\mid \\mathbf{w}') / q(\\mathbf{w}' \\mid \\mathbf{w})$ 需要计算这个复杂变换的雅可比行列式，这通常是难以处理的。使用对称的梅特罗波利斯公式会使算法不正确，因为它不会使 $\\pi(\\mathbf{w})$ 保持不变。\n\n结论：**不正确**。\n\n**B. 单纯形上的狄利克雷随机游走**\n\n提议是 $\\mathbf{w}' \\sim \\mathrm{Dirichlet}(\\kappa \\mathbf{w})$，其中 $\\kappa  0$ 是一个调整参数。\n1.  **约束**：由于 $\\mathbf{w} \\in \\Delta^{K-1}$，我们有对所有 $i$ 都有 $w_i  0$。当 $\\kappa  0$ 时，狄利克雷提议的参数 $\\kappa w_i$ 都是正的。从一个具有正参数的狄利克雷分布中抽取的样本位于开放单纯形内。因此，$\\mathbf{w}' \\in \\Delta^{K-1}$。\n2.  **不可约性**：具有全正参数的狄利克雷分布的支撑集是整个开放单纯形。因此，可以从任何 $\\mathbf{w}$ 移动到 $\\Delta^{K-1}$ 中的任何邻域。该链是不可约的。\n3.  **接受概率**：提议密度是狄利克雷密度函数，$q(\\mathbf{w}' \\mid \\mathbf{w}) = \\frac{\\Gamma(\\kappa)}{\\prod_{i=1}^K \\Gamma(\\kappa w_i)} \\prod_{i=1}^K (w'_i)^{\\kappa w_i - 1}$。反向提议密度是 $q(\\mathbf{w} \\mid \\mathbf{w}') = \\frac{\\Gamma(\\kappa)}{\\prod_{i=1}^K \\Gamma(\\kappa w'_i)} \\prod_{i=1}^K w_i^{\\kappa w'_i - 1}$。该提议不是对称的。该选项提供了正确的一般黑斯廷斯接受概率 $\\min\\left\\{1,\\ \\frac{\\pi(\\mathbf{w}')\\, q(\\mathbf{w}\\mid \\mathbf{w}')}{\\pi(\\mathbf{w})\\, q(\\mathbf{w}'\\mid \\mathbf{w})}\\right\\}$。由于狄利克雷密度是一个标准函数，此表达式中的所有项都是可评估的。\n\n结论：**正确**。\n\n**C. 对称步骤的成对交换移动**\n\n提议是通过均匀地选择一个 $i \\neq j$ 的有序对 $(i,j)$，从 $\\mathrm{Uniform}(-w_i, w_j)$ 中抽取 $\\varepsilon$，并设置 $w'_i = w_i + \\varepsilon$，$w'_j = w_j - \\varepsilon$ 来生成的。\n1.  **约束**：总和保持不变：$\\sum_k w'_k = (w_i+\\varepsilon) + (w_j-\\varepsilon) + \\sum_{k\\neq i,j} w_k = 1$。正性也得到保持：$w'_i = w_i + \\varepsilon  w_i - w_i = 0$ 且 $w'_j = w_j - \\varepsilon  w_j - w_j = 0$。所以 $\\mathbf{w}' \\in \\Delta^{K-1}$。\n2.  **不可约性**：对于 $K \\geq 3$，可以在任意两个分量之间转移质量，比如从 $i$ 到 $j$，然后从 $j$ 到 $k$。通过组合这样的移动，可以从单纯形中的任何一点到达任何其他点。该链是不可约的。\n3.  **接受概率**：提议的概率是 $\\min\\{1, \\pi(\\mathbf{w}')/\\pi(\\mathbf{w})\\}$，这暗示了对称性。我们来检查一下是否有 $q(\\mathbf{w}' \\mid \\mathbf{w}) = q(\\mathbf{w} \\mid \\mathbf{w}')$。该提议由选择的对 $(i, j)$ 和值 $\\varepsilon$ 唯一确定。通过特定对 $(i,j)$ 和步长 $\\varepsilon$ 从 $\\mathbf{w}$ 移动到 $\\mathbf{w}'$ 的提议密度与选择 $(i,j)$ 的概率和 $\\varepsilon$ 的密度成正比。有序对的数量是 $K(K-1)$。$\\varepsilon$ 的密度是 $1/(w_i+w_j)$。所以，这个特定转移的密度正比于 $\\frac{1}{K(K-1)} \\frac{1}{w_i+w_j}$。\n对于反向转移 $\\mathbf{w}' \\rightarrow \\mathbf{w}$，我们有 $w_i = w'_i-\\epsilon$ 和 $w_j=w'_j+\\epsilon$。其概率密度为 $q(\\mathbf{w}|\\mathbf{w}') = \\frac{1}{K(K-1)} \\frac{1}{w'_i+w'_j}$。\n由于 $w'_i+w'_j = (w_i+\\varepsilon) + (w_j-\\varepsilon) = w_i+w_j$，前向和反向转移密度是相等的。该提议是对称的。因此，简单的梅特罗波利斯接受概率是正确的。\n\n结论：**正确**。\n\n**D. 双射变换中的对数正态随机游走**\n\n该方法使用加性对数比（ALR）变换：$z_k=\\log(w_k/w_K)$（对于 $k=1,\\dots,K-1$），将 $\\Delta^{K-1}$ 上的约束问题转换为 $\\mathbb{R}^{K-1}$ 上的无约束问题。在无约束空间中执行对称的高斯随机游走，$\\mathbf{z}'=\\mathbf{z}+\\boldsymbol{\\eta}$，其中 $\\boldsymbol{\\eta}\\sim \\mathcal{N}(\\mathbf{0},\\boldsymbol{\\Sigma})$。\n1.  **约束**：逆变换（一个 softmax 函数）将 $\\mathbb{R}^{K-1}$ 中的任何点映射回开放单纯形 $\\Delta^{K-1}$。因此，约束总是被满足。\n2.  **不可约性**：高斯随机游走在 $\\mathbb{R}^{K-1}$ 上是不可约的。由于 ALR 变换是 $\\Delta^{K-1}$ 和 $\\mathbb{R}^{K-1}$ 之间的双射，因此在 $\\mathbf{w}$ 上产生的链也是不可约的。\n3.  **接受概率**：当进行变量替换时，新空间中的目标密度变为 $\\pi_{\\mathbf{z}}(\\mathbf{z}) = \\pi(\\mathbf{w}(\\mathbf{z})) |J(\\mathbf{z})|$，其中 $|J(\\mathbf{z})|$ 是映射 $\\mathbf{z} \\mapsto \\mathbf{w}$ 的雅可比行列式的绝对值。对 $\\mathbf{z}$ 的提议是对称的，所以接受概率是 $\\min\\left\\{1, \\frac{\\pi_{\\mathbf{z}}(\\mathbf{z}')}{\\pi_{\\mathbf{z}}(\\mathbf{z})}\\right\\} = \\min\\left\\{1, \\frac{\\pi(\\mathbf{w}')|J(\\mathbf{z}')|}{\\pi(\\mathbf{w})|J(\\mathbf{z})|}\\right\\}$，其中 $\\mathbf{w}'=\\mathbf{w}(\\mathbf{z}')$。这与选项中的公式相符。ALR 变换的雅可比行列式是 $|J(\\mathbf{z})| = \\prod_{k=1}^K w_k$，可以轻松计算。所有部分都是可评估的。\n\n结论：**正确**。\n\n**E. 来自固定狄利克雷分布的独立提议**\n\n这是一个独立采样器。候选值 $\\mathbf{w}'$ 从一个固定的提议分布 $q(\\mathbf{w}') = \\mathrm{Dirichlet}(\\mathbf{w}' \\mid \\boldsymbol{\\alpha})$ 中抽取，且独立于当前状态 $\\mathbf{w}$。\n1.  **约束**：与选项 B 一样，从具有正参数 $\\boldsymbol{\\alpha}$ 的狄利克雷分布中抽取的样本位于开放单纯形 $\\Delta^{K-1}$ 内。\n2.  **不可约性**：提议分布的支撑集覆盖整个开放单纯形，因此任何状态都可以从任何其他状态一步到达。该链是不可约的。\n3.  **接受概率**：对于独立采样器，$q(\\mathbf{w}' \\mid \\mathbf{w}) = q(\\mathbf{w}')$ 且 $q(\\mathbf{w} \\mid \\mathbf{w}') = q(\\mathbf{w})$。一般 MH 接受概率变为 $\\alpha = \\min\\left\\{1, \\frac{\\pi(\\mathbf{w}') q(\\mathbf{w})}{\\pi(\\mathbf{w}) q(\\mathbf{w}')}\\right\\}$。这与选项中的公式相符。狄利克雷密度 $q$ 是可评估的，所以接受概率是可实现的。\n\n结论：**正确**。\n\n**F. 在假设对称性的情况下，在 $\\ell_2$ 球内的局部均匀移动**\n\n提议是从集合 $S_{\\mathbf{w},r} = \\{\\mathbf{u}\\in \\Delta^{K-1}: \\|\\mathbf{u}-\\mathbf{w}\\|_2\\le r\\}$ 中均匀抽取 $\\mathbf{w}'$。提议的接受概率 $\\min\\{1, \\pi(\\mathbf{w}')/\\pi(\\mathbf{w})\\}$ 假设了提议密度是对称的。\n1.  **对称性**：提议密度为 $q(\\mathbf{w}' \\mid \\mathbf{w}) = 1/\\text{Vol}(S_{\\mathbf{w},r})$（如果 $\\mathbf{w}' \\in S_{\\mathbf{w},r}$）否则为 0。要使其对称，我们需要对于任何有效移动都有 $\\text{Vol}(S_{\\mathbf{w},r}) = \\text{Vol}(S_{\\mathbf{w}',r})$。集合 $S_{\\mathbf{w},r}$ 是单纯形 $\\Delta^{K-1}$ 与一个以 $\\mathbf{w}$ 为中心的 $\\ell_2$ 球的交集。该区域的 $(K-1)$ 维体积取决于 $\\mathbf{w}$。如果 $\\mathbf{w}$ 靠近单纯形的边界，球将被边界截断，导致其体积小于 $\\mathbf{w}$ 位于单纯形中心时的情况。因此，$\\text{Vol}(S_{\\mathbf{w},r})$ 不是常数，提议密度不是对称的，并且提议的接受概率是错误的。\n2.  **可实现性**：从这个复杂的几何区域（一个超平面、多个半空间和一个超球面的交集）中均匀采样是一个非常困难的计算问题。使用标准库函数通常不认为这是实践上可实现的。\n\n结论：**不正确**。\n\n总之，选项 B、C、D 和 E 描述了有效且可实现的梅特罗波利斯-黑斯廷斯转移机制。",
            "answer": "$$\\boxed{BCDE}$$"
        }
    ]
}