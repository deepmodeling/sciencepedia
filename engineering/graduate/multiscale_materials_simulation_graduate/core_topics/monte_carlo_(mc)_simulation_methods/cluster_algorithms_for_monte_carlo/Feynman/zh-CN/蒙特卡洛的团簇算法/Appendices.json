{
    "hands_on_practices": [
        {
            "introduction": "第一个练习将引导您逐步完成 Swendsen-Wang 算法的基础操作。通过在一个最小化的 $2 \\times 2$ 晶格上手动计算转移概率，您将具体地理解如何以概率方式放置键以形成团簇，以及集体翻转如何高效地更新系统构型。这个练习是为您建立团簇方法核心机制直觉的关键。",
            "id": "3796429",
            "problem": "考虑一个在$2\\times 2$方形晶格上、具有周期性边界条件的铁磁伊辛模型，该模型在多尺度材料模拟中用作粗粒化自旋模型。伊辛哈密顿量为 $H = -J \\sum_{\\langle i j \\rangle} s_i s_j$，其中 $J>0$，$s_i \\in \\{+1,-1\\}$，求和遍及所有最近邻对 $\\langle i j \\rangle$。这个周期性的 $2\\times 2$ 晶格恰好有 4 条无向最近邻边：两条水平边 $\\{(0,0),(1,0)\\}$ 和 $\\{(0,1),(1,1)\\}$，以及两条垂直边 $\\{(0,0),(0,1)\\}$ 和 $\\{(1,0),(1,1)\\}$，其中坐标 $(x,y)$ 满足 $x\\in\\{0,1\\}$ 和 $y\\in\\{0,1\\}$。\n\n用于伊辛模型的 Swendsen–Wang (SW) 团簇算法的步骤如下：对每条满足的最近邻边（即 $s_i s_j=+1$），以激活概率 $p = 1 - \\exp(-2 \\beta J)$ 独立地在其上放置一个键，其中 $\\beta = 1/(k_B T)$，$k_B$ 是玻尔兹曼常数；对于不满足的边（即 $s_i s_j=-1$），绝不放置键。由此产生的键图将晶格划分为多个团簇（在激活的键下形成的连通分量）。然后，每个团簇以 1/2 的概率独立地进行翻转（等价地，每个团簇被独立于其他团簇地以相同概率赋予一个新的共同自旋值 +1 或 -1），从而得到一个新的自旋构型。\n\n从初始自旋构型开始：\n$$\ns_{0,0}=+1,\\quad s_{1,0}=+1,\\quad s_{0,1}=-1,\\quad s_{1,1}=-1,\n$$\n该构型在顶行上有一个+1条带，在底行上有一个-1条带。仅使用基本原理（伊辛哈密顿量、玻尔兹曼权重，以及推导出 SW 键规则 $p = 1 - \\exp(-2 \\beta J)$ 的 Fortuin–Kasteleyn 随机团簇表示），完成以下任务：\n\n- 枚举出从该初始自旋构型的满足边中可能产生的所有不同的 SW 键构型，并对每种构型，识别其产生的团簇。\n- 对于每种键构型，计算在独立的团簇翻转之后，达到所有可能的自旋构型的概率。\n\n最后，以闭合形式计算并报告从给定的初始构型到全朝上构型 $s'_{x,y}=+1$（对所有 $(x,y)$）的总 SW 转移概率，表示为键激活概率 $p$ 的解析函数。你最终报告的答案必须是一个单一的闭合形式表达式；不需要进行数值舍入。",
            "solution": "首先根据指定标准对问题进行验证。\n\n### 问题验证\n\n**第1步：提取已知条件**\n- **模型**：在具有周期性边界条件的$2\\times 2$方形晶格上的铁磁伊辛模型。\n- **哈密顿量**：$H = -J \\sum_{\\langle i,j \\rangle} s_i s_j$，其中 $J>0$。\n- **自旋**：$s_i \\in \\{+1, -1\\}$。\n- **晶格与边**：该晶格有4个格点，由坐标 $(x,y)$（其中 $x,y \\in \\{0,1\\}$）标识，以及4条无向最近邻边：$\\{(0,0),(1,0)\\}$、$\\{(0,1),(1,1)\\}$、$\\{(0,0),(0,1)\\}$ 和 $\\{(1,0),(1,1)\\}$。\n- **Swendsen-Wang (SW) 算法**：\n    - 在满足的边（$s_i s_j = +1$）上以概率 $p = 1 - \\exp(-2 \\beta J)$ 放置键。\n    - 在不满足的边（$s_i s_j = -1$）上不放置键。\n    - 团簇（连通分量）以 1/2 的概率独立翻转。\n- **初始自旋构型**：$s_{0,0}=+1$，$s_{1,0}=+1$，$s_{0,1}=-1$，$s_{1,1}=-1$。\n- **任务**：计算从初始构型到全朝上构型（对所有 $(x,y)$，$s'_{x,y}=+1$）的总转移概率，表示为 $p$ 的解析函数。\n\n**第2步：使用提取的已知条件进行验证**\n- **科学依据**：该问题基于标准的伊辛模型和 Swendsen-Wang 算法，这些是统计力学和计算物理学中的基本概念。关系式 $p = 1 - \\exp(-2\\beta J)$ 是作为 SW 算法基础的 Fortuin-Kasteleyn 表示的基石。\n- **适定性**：该问题提供了一个特定的初始状态、一个明确定义的随机过程（SW算法的一个步骤）和一个特定的目标最终状态。这使得计算一个唯一的、有意义的转移概率成为可能。\n- **明确性**：该问题以精确、无歧义的数学和物理术语陈述。\n- **完整性与一致性**：对于这种拓扑结构，关于具有4条边的周期性边界条件的 $2 \\times 2$ 晶格的描述是正确的。所有必需的参数和规则都已指定。没有矛盾之处。\n- **现实性**：该设置是一个标准的、尽管很小的系统，用于阐释计算统计力学中的概念。在此理论背景下，它是完全现实的。\n\n**第3步：结论与行动**\n该问题是有效的。它具有科学合理性、适定性，并提供了所有必要的信息。我现在将着手解答。\n\n### 解答\n\n解答过程通过应用 Swendsen-Wang (SW) 算法的规则来执行单个更新步。总转移概率是所有可能中间键构型概率的总和。\n\n**1. 识别满足和不满足的边**\n初始自旋构型为 $s_{0,0}=+1$、$s_{1,0}=+1$、$s_{0,1}=-1$ 和 $s_{1,1}=-1$。我们检查四条最近邻边的状态：\n- 边 $e_1 = \\langle(0,0), (1,0)\\rangle$：自旋为 $s_{0,0}=+1$ 和 $s_{1,0}=+1$。乘积为 $s_{0,0}s_{1,0} = (+1)(+1) = +1$。该边是**满足的**。\n- 边 $e_2 = \\langle(0,1), (1,1)\\rangle$：自旋为 $s_{0,1}=-1$ 和 $s_{1,1}=-1$。乘积为 $s_{0,1}s_{1,1} = (-1)(-1) = +1$。该边是**满足的**。\n- 边 $e_3 = \\langle(0,0), (0,1)\\rangle$：自旋为 $s_{0,0}=+1$ 和 $s_{0,1}=-1$。乘积为 $s_{0,0}s_{0,1} = (+1)(-1) = -1$。该边是**不满足的**。\n- 边 $e_4 = \\langle(1,0), (1,1)\\rangle$：自旋为 $s_{1,0}=+1$ 和 $s_{1,1}=-1$。乘积为 $s_{1,0}s_{1,1} = (+1)(-1) = -1$。该边是**不满足的**。\n\n根据 SW 算法，键只放置在满足的边上。因此，我们只需要考虑在边 $e_1$ 和 $e_2$ 上放置键。这两条边中的每一条都以概率 $p$ 独立地被放置一个键。这产生了 $2^2=4$ 种可能的键构型。\n\n**2. 枚举键构型并计算转移概率**\n对于每种键构型，我们确定其产生的团簇，计算团簇数量 ($k$)，并计算达到全朝上构型（所有格点的 $s'_{x,y}=+1$）的条件概率。这要求每个团簇都被赋予一个新的+1自旋，其发生概率为 $(1/2)^k$。\n\n- **构型1：没有键被激活。**\n  - 此构型的概率：$(1-p)(1-p) = (1-p)^2$。\n  - 团簇：4个格点中的每一个都是一个单独的团簇：$\\{(0,0)\\}$、$\\{(1,0)\\}$、$\\{(0,1)\\}$、$\\{(1,1)\\}$。\n  - 团簇数量：$k=4$。\n  - 达到全朝上状态的概率：$(1/2)^4 = 1/16$。\n  - 对总概率的贡献：$\\frac{1}{16}(1-p)^2$。\n\n- **构型2：仅在边 $e_1$ 上有键。**\n  - 此构型的概率：$p(1-p)$。\n  - 团簇：格点 $(0,0)$ 和 $(1,0)$ 相连，形成一个团簇。另外两个格点是孤立的。团簇为：$\\{(0,0), (1,0)\\}$、$\\{(0,1)\\}$、$\\{(1,1)\\}$。\n  - 团簇数量：$k=3$。\n  - 达到全朝上状态的概率：$(1/2)^3 = 1/8$。\n  - 对总概率的贡献：$\\frac{1}{8}p(1-p)$。\n\n- **构型3：仅在边 $e_2$ 上有键。**\n  - 此构型的概率：$(1-p)p$。\n  - 团簇：格点 $(0,1)$ 和 $(1,1)$ 相连。团簇为：$\\{(0,0)\\}$、$\\{(1,0)\\}$、$\\{(0,1), (1,1)\\}$。\n  - 团簇数量：$k=3$。\n  - 达到全朝上状态的概率：$(1/2)^3 = 1/8$。\n  - 对总概率的贡献：$\\frac{1}{8}p(1-p)$。\n\n- **构型4：在边 $e_1$ 和 $e_2$ 上都有键。**\n  - 此构型的概率：$p \\cdot p = p^2$。\n  - 团簇：顶部的两个格点形成一个团簇，底部的两个格点形成另一个团簇。团簇为：$\\{(0,0), (1,0)\\}$、$\\{(0,1), (1,1)\\}$。\n  - 团簇数量：$k=2$。\n  - 达到全朝上状态的概率：$(1/2)^2 = 1/4$。\n  - 对总概率的贡献：$\\frac{1}{4}p^2$。\n\n**3. 计算总转移概率**\n从给定的初始构型转移到全朝上构型的总概率 $P_{total}$ 是所有四种可能的键构型贡献的总和。\n\n$$P_{total} = \\frac{1}{16}(1-p)^2 + \\frac{1}{8}p(1-p) + \\frac{1}{8}p(1-p) + \\frac{1}{4}p^2$$\n\n我们简化这个表达式：\n$$P_{total} = \\frac{1}{16}(1-p)^2 + \\frac{2}{8}p(1-p) + \\frac{1}{4}p^2$$\n$$P_{total} = \\frac{1}{16}(1-p)^2 + \\frac{1}{4}p(1-p) + \\frac{1}{4}p^2$$\n将所有项通分，分母为16：\n$$P_{total} = \\frac{1(1-2p+p^2)}{16} + \\frac{4(p-p^2)}{16} + \\frac{4p^2}{16}$$\n$$P_{total} = \\frac{1-2p+p^2 + 4p-4p^2 + 4p^2}{16}$$\n合并分子中的同类项：\n$$P_{total} = \\frac{1 + (-2p+4p) + (p^2-4p^2+4p^2)}{16}$$\n$$P_{total} = \\frac{1 + 2p + p^2}{16}$$\n这个分子是一个完全平方，$(1+p)^2$。因此，总转移概率是：\n$$P_{total} = \\frac{(1+p)^2}{16}$$\n\n这就是转移概率作为键激活概率 $p$ 的函数的最终闭合形式表达式。",
            "answer": "$$\\boxed{\\frac{(1+p)^2}{16}}$$"
        },
        {
            "introduction": "在掌握基础知识之后，这个练习将演示如何将团簇算法应用于更复杂、更具物理意义的模型，例如在交错场中的反铁磁体。您将学习变量变换和“幽灵自旋”嵌入等强大技术，这些技术能将问题映射到一个等效的可解铁磁模型上。掌握这种方法对于解决材料模拟中的各种问题至关重要。",
            "id": "3796401",
            "problem": "考虑一个线性尺寸为 $L$ 的二分二维方形晶格，具有周期性边界条件。其上的格点由整数坐标 $(x_i,y_i)$ 索引，并通过宇称划分为两个子晶格，使得 $\\varepsilon_i = (-1)^{x_i+y_i} \\in \\{-1,+1\\}$。令伊辛自旋 $s_i \\in \\{-1,+1\\}$ 位于这些格点上。在交错场中，反铁磁最近邻哈密顿量为\n$$\nH(s) \\;=\\; J \\sum_{\\langle i j \\rangle} s_i s_j \\;-\\; \\sum_{i} h_i s_i,\n$$\n其中 $J>0$，逆温度为 $\\beta$，交错场为 $h_i = \\varepsilon_i h$，其中均匀振幅 $h \\ge 0$。玻尔兹曼权重由 $P(s) \\propto \\exp(-\\beta H(s))$ 给出。在多尺度材料模拟中，采样必须保留由 $\\varepsilon_i$ 编码的交错对称性，同时通过团簇算法实现高效的大尺度集体更新。\n\n从玻尔兹曼分布和二分结构出发，构建一个团簇嵌入，通过将变量变换到一个可以使用铁磁耦合和均匀场形成团簇的表示，从而保留交错对称性。引入嵌入均匀场到团簇构造中所需的最小附加自由度，且不违反细致平衡条件。然后，从随机团簇（Fortuin–Kasteleyn）表示的第一性原理出发，推导最近邻格点之间以及格点与辅助自由度之间的键激活概率的闭合表达式，用 $\\beta$、$J$ 和 $h$ 表示。\n\n将您的最终答案表示为两个激活概率，一个用于最近邻键，一个用于与辅助自由度之间的键，形式为一个单一的解析行向量。无需进行数值计算。",
            "solution": "该问题要求推导应用于二分晶格上、存在交错磁场的二维反铁磁伊辛模型的团簇算法的键激活概率。在将上述问题转换为合适的表示后，必须从第一性原理出发进行推导。\n\n### 步骤 1：问题验证\n\n**1.1. 提取已知条件：**\n-   **系统：** 线性尺寸为 $L$ 的二分二维方形晶格。\n-   **格点索引：** $(x_i, y_i)$。\n-   **子晶格划分：** $\\varepsilon_i = (-1)^{x_i+y_i} \\in \\{-1,+1\\}$。\n-   **自旋变量：** 每个格点 $i$ 上的 $s_i \\in \\{-1,+1\\}$。\n-   **哈密顿量：** $H(s) = J \\sum_{\\langle i j \\rangle} s_i s_j - \\sum_{i} h_i s_i$。\n-   **参数：**\n    -   反铁磁耦合：$J > 0$。\n    -   逆温度：$\\beta$。\n    -   交错场：$h_i = \\varepsilon_i h$，其中均匀振幅 $h \\ge 0$。\n-   **统计权重：** 玻尔兹曼权重 $P(s) \\propto \\exp(-\\beta H(s))$。\n-   **任务：**\n    1.  通过变换到具有均匀场的铁磁表示，构建一个保留交错对称性的团簇嵌入。\n    2.  引入最小的辅助自由度来处理均匀场。\n    3.  从随机团簇表示的第一性原理出发，推导(a)最近邻格点之间和(b)格点与辅助自由度之间的键激活概率的闭合表达式。\n\n**1.2. 使用提取的已知条件进行验证：**\n-   **科学依据：** 该问题描述了方形晶格上带有交错场的反铁磁伊辛模型。这是统计物理学中用于研究反铁磁性和量子临界点的典型模型。使用团簇算法（如 Swendsen-Wang 或 Wolff 算法）和随机团簇（Fortuin-Kasteleyn, FK）表示是计算统计力学中克服临界慢化的标准且强大的技术。所提议的变换和嵌入是成熟的方法。该问题在科学上是合理的，在事实上是正确的。\n-   **适定性：** 目标是基于一个明确定义的物理模型和一个标准的理论框架，推导出特定的解析表达式（键概率）。必要的信息（$H$、晶格结构、参数）均已提供。一个唯一且有意义的解存在并且可以被系统地推导出来。\n-   **客观性：** 该问题以精确、客观的数学和物理语言陈述。它不包含任何主观论断、歧义或模糊之处。\n\n**1.3. 结论与行动：**\n该问题是有效的。它是一个计算统计物理学中适定且有科学依据的问题。可以开始求解过程。\n\n### 步骤 2：键概率的推导\n\n**2.1. 变换到铁磁表示**\n哈密顿量包含一个反铁磁相互作用项 $J \\sum s_i s_j$，其中 $J>0$。标准形式的团簇算法是为铁磁相互作用制定的。方形晶格的二分性质允许进行一种变换，将反铁磁模型映射到铁磁模型。对于任意一对最近邻格点 $\\langle i, j \\rangle$，这两个格点属于不同的子晶格，意味着 $\\varepsilon_i \\varepsilon_j = -1$。\n\n我们引入一组新的自旋变量 $\\sigma_i$，由交错变换定义：\n$$ \\sigma_i = \\varepsilon_i s_i $$\n逆变换为 $s_i = \\varepsilon_i \\sigma_i$，因为 $\\varepsilon_i^2 = (-1)^{2(x_i+y_i)} = 1$。现在我们用 $\\sigma_i$ 变量重写哈密顿量。\n\n相互作用项变为：\n$$ J \\sum_{\\langle i j \\rangle} s_i s_j = J \\sum_{\\langle i j \\rangle} (\\varepsilon_i \\sigma_i)(\\varepsilon_j \\sigma_j) = J \\sum_{\\langle i j \\rangle} (\\varepsilon_i \\varepsilon_j) \\sigma_i \\sigma_j $$\n因为对于最近邻，$\\varepsilon_j = -\\varepsilon_i$，所以我们有 $\\varepsilon_i \\varepsilon_j = -1$。因此，相互作用项为：\n$$ J \\sum_{\\langle i j \\rangle} s_i s_j = -J \\sum_{\\langle i j \\rangle} \\sigma_i \\sigma_j $$\n这是一个耦合强度为 $J$ 的铁磁相互作用。\n\n磁场项变为：\n$$ -\\sum_i h_i s_i = -\\sum_i (\\varepsilon_i h) s_i = -h \\sum_i \\varepsilon_i (\\varepsilon_i \\sigma_i) = -h \\sum_i \\varepsilon_i^2 \\sigma_i $$\n由于 $\\varepsilon_i^2=1$，磁场项简化为：\n$$ -\\sum_i h_i s_i = -h \\sum_i \\sigma_i $$\n这是一个作用在 $\\sigma_i$ 自旋上、强度为 $h$ 的均匀磁场。\n\n变换后的哈密顿量，记为 $H'(\\sigma)$，是：\n$$ H'(\\sigma) = -J \\sum_{\\langle i j \\rangle} \\sigma_i \\sigma_j - h \\sum_i \\sigma_i $$\n玻尔兹曼权重现在是 $P(\\sigma) \\propto \\exp(-\\beta H'(\\sigma))$。这描述了一个处于均匀外场中的铁磁伊辛模型。\n\n**2.2. 嵌入均匀场**\n均匀场项 $-h \\sum_i \\sigma_i$ 的存在破坏了模型的全局自旋翻转对称性（$\\sigma \\to -\\sigma$）。标准的团簇算法依赖于这种对称性。为了恢复一种适用于团簇方法的表述，我们通过引入一个单一的辅助自由度，将磁场项嵌入到相互作用结构中。这个“幽灵自旋”记为 $\\sigma_0$，并永久固定为 $\\sigma_0=+1$。\n\n均匀场项可以重写为与这个幽灵自旋的相互作用：\n$$ -h \\sum_i \\sigma_i = -h \\sum_i \\sigma_i \\sigma_0 $$\n哈密顿量随后可以在一个扩展图上表示，该图包含原始的 $N$ 个晶格格点和额外的格点 $0$：\n$$ H''(\\sigma) = -J \\sum_{\\langle i j \\rangle} \\sigma_i \\sigma_j - h \\sum_{i} \\sigma_i \\sigma_0 $$\n这个哈密顿量描述了一个纯铁磁伊辛模型（无外场），其图上有两种类型的键：\n1.  晶格上最近邻格点 $i$ 和 $j$ 之间的键，耦合强度为 $J$。\n2.  每个晶格格点 $i$ 和幽灵格点 $0$ 之间的键，耦合强度为 $h$。\n\n**2.3. 从 Fortuin-Kasteleyn 表示推导**\n随机团簇（FK）表示为团簇算法提供了理论基础。铁磁伊辛模型的配分函数 $Z$ 可以表示为对自旋构型 $\\{\\sigma\\}$ 和键图构型 $\\{G\\}$ 的求和。关键的恒等式将相互作用自旋对的玻尔兹曼权重与一个概率性的键联系起来。\n\n对于哈密顿量中通过 $-K_{ab} \\sigma_a \\sigma_b$ 项相互作用的任意一对自旋 $\\sigma_a, \\sigma_b$，相应的玻尔兹曼因子是 $\\exp(\\beta K_{ab} \\sigma_a \\sigma_b)$。这个因子可以分解为：\n$$ \\exp(\\beta K_{ab} \\sigma_a \\sigma_b) = \\exp(-\\beta K_{ab}) + \\left[ \\exp(\\beta K_{ab}) - \\exp(-\\beta K_{ab}) \\right] \\delta_{\\sigma_a, \\sigma_b} $$\n其中 $\\delta_{\\sigma_a, \\sigma_b}$ 是克罗内克 δ。这可以重写为：\n$$ \\exp(\\beta K_{ab} \\sigma_a \\sigma_b) = \\exp(-\\beta K_{ab}) \\left[ 1 + \\left( \\exp(2\\beta K_{ab}) - 1 \\right) \\delta_{\\sigma_a, \\sigma_b} \\right] $$\n在 Swendsen-Wang 或 Wolff 团簇算法的背景下，只有当格点 $a$ 和 $b$ 的自旋对齐（$\\sigma_a = \\sigma_b$）时，才会考虑在它们之间激活一个键。激活这样一个键的概率 $p_{ab}$ 必须满足细致平衡条件。对团簇翻转的细致平衡条件的推导表明，如果键激活概率选择为以下形式，则该条件得到满足：\n$$ p_{ab} = 1 - \\exp(-2\\beta K_{ab}) $$\n这个选择使得团簇翻转及其逆过程的跃迁概率之比等于相应微观态的玻尔兹曼权重之比。\n\n我们现在将这个一般性结果应用于我们的有效哈密顿量 $H''(\\sigma)$ 中的两种相互作用。\n\n**2.3.1. 最近邻格点之间的键**\n对于连接晶格上最近邻格点 $i$ 和 $j$ 的键，耦合常数为 $K_{ij}=J$。因此，相应的键激活概率 $p_{\\text{NN}}$ 为：\n$$ p_{\\text{NN}} = 1 - \\exp(-2\\beta J) $$\n\n**2.3.2. 与辅助自由度之间的键**\n对于连接晶格格点 $i$ 和幽灵自旋格点 $0$ 的键，耦合常数为 $K_{i0}=h$。因此，相应的键激活概率 $p_{\\text{ghost}}$ 为：\n$$ p_{\\text{ghost}} = 1 - \\exp(-2\\beta h) $$\n\n这两个概率定义了团簇的构建规则。在团簇更新步骤中，对于每一对具有耦合 $K_{ab}$ 且处于相同状态（$\\sigma_a = \\sigma_b$）的相互作用自旋 $(\\sigma_a, \\sigma_b)$，以概率 $p_{ab} = 1 - \\exp(-2\\beta K_{ab})$ 在它们之间“冻结”一个键。然后，团簇被定义为所得键图的连通分量，每个团簇以 $1/2$ 的概率翻转（对于 Swendsen-Wang 算法），或者生长并翻转单个团簇（对于 Wolff 算法）。推导出的概率对这两种算法都是基础。\n\n最终答案是这两个概率的集合，按要求以行向量的形式呈现。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 1 - \\exp(-2\\beta J) & 1 - \\exp(-2\\beta h) \\end{pmatrix} } $$"
        },
        {
            "introduction": "一个算法的正确性与其效率同等重要。最后一个练习将我们的重点转移到团簇方法的理论基础，特别是遍历性这一关键属性上。通过一个概念性的反例，您将探讨一个看似合理的算法修改如何破坏遍历性，从而阻止模拟对整个状态空间进行采样，并导致错误的物理结论。",
            "id": "3796449",
            "problem": "考虑一个线性尺寸为 $L$ 的周期性方格晶格（环面）上的铁磁伊辛模型，其哈密顿量为 $H(\\{s_i\\})=-J\\sum_{\\langle i j\\rangle} s_i s_j$，其中 $J>0$，$s_i\\in\\{-1,+1\\}$，求和遍及最近邻。在二维情况下，当逆温度 $\\beta> \\beta_c$ 时，系统处于具有两个磁化符号扇区的对称性破缺相中。标准的团簇更新（例如 Wolff 算法）通过以概率 $p=1-\\mathrm{e}^{-2\\beta J}$ 占据相同自旋之间的键来构建单个团簇，并以 1 的接受概率翻转整个连通分量；这满足关于零外场下玻尔兹曼分布的细致平衡条件。\n\n考虑以下旨在“避免拓扑翻转”的修改更新提议：在构建一个 Wolff 团簇后，如果提议的团簇具有非平凡的环绕数（即，它至少在一个晶格方向上环绕了环面），则确定性地拒绝该提议；否则，翻转该团簇。马尔可夫链的其余部分仅由这些团簇更新组成。\n\n仅使用马尔可夫链、遍历性的基本定义以及所述的伊辛模型和团簇构建规则，推断该修改提议是否会在对称性破缺相中破坏遍历性。找出一个具体的反例构型和机制来展示这种破坏（如果存在），并提出一个最小的修改，以在保持正确平稳分布的同时恢复遍历性。选择正确提供有效反例和最小遍历性恢复修复方案的选项。\n\nA. 反例：在 $L\\times L$ 环面上，对于 $\\beta>\\beta_c$，当 $L\\to\\infty$ 时，多数自旋以远离 0 的概率形成一个环绕（非平凡环绕数）的团簇。从全 $+1$ 构型开始，任何可能反转磁化符号的多数自旋团簇必然是环绕的，因此是不可翻转的；翻转任何非环绕的团簇都不能改变全局磁化符号，因此马尔可夫链无法连接两个对称性破缺的扇区。最小修复方案：通过一个全局自旋翻转提议来增强动力学，该提议以一个小的概率 $\\varepsilon>0$ 翻转所有自旋 $s_i\\mapsto -s_i$；在零场下 $\\Delta H=0$，因此接受概率为 1，并且增加的这一步在保持细致平衡的同时连接了两个扇区。\n\nB. 反例：对于任何 $\\beta$，禁止环绕团簇不影响遍历性，因为有限多次翻转非环绕团簇总是可以反转全局磁化。最小修复方案：无需更改。\n\nC. 反例：对于 $\\beta>\\beta_c$，修改后的更新是非遍历的，但问题在于细致平衡的失效，而不是扇区连通性。最小修复方案：将键概率减半至 $p\\mapsto p/2$，使得大团簇更罕见；这无需额外步骤即可恢复遍历性。\n\nD. 反例：对于环面上的 $\\beta>\\beta_c$，一旦存在多数相的环绕团簇，禁止翻转任何环绕团簇会阻止在 $+m$ 和 $-m$ 磁化扇区之间的跃迁，因为任何对非环绕的少数自旋“岛”的翻转都会增加磁化强度的大小，而任何对多数自旋的非环绕子集（在 Wolff 连通性下不能断开环绕主干）的翻转都无法移除逾渗的主干。最小修复方案：以一个小的概率 $\\varepsilon>0$ 混合一个局部的单自旋 Metropolis 更新（例如，均匀随机选择一个自旋进行翻转尝试，以概率 $\\min\\{1,\\mathrm{e}^{-\\beta \\Delta H}\\}$ 接受）。两个满足细致平衡的核（团簇和局部）的混合相对于玻尔兹曼分布仍然是可逆的，并通过允许扇区之间的通信来恢复遍历性。\n\n选择所有适用的选项。",
            "solution": "问题陈述是计算统计物理学中一个有效的、适定的问题。它在科学上基于伊辛模型、马尔可夫链蒙特卡洛方法和相变理论的原理。术语精确，前提一致。我们可以进行分析。\n\n核心问题是，对 Wolff 团簇算法的提议修改是否破坏了遍历性。如果一个马尔可夫链是不可约的且非周期的，那么它是遍历的。对于本问题，关键属性是不可约性，即从构型空间中的任何状态出发，在有限步内到达任何其他状态的概率都非零。构型空间由所有可能的自旋构型 $\\{s_i\\}$ 组成，目标平稳分布是玻尔兹曼分布 $P(\\{s_i\\}) \\propto \\exp(-\\beta H(\\{s_i\\}))$，当 $\\beta$ 为有限值时，该分布对所有构型都非零。\n\n该系统是 $L \\times L$ 环面上的二维铁磁伊辛模型，逆温度为 $\\beta > \\beta_c$。在此区域（对称性破缺相），系统的自由能景观有两个深度的极小值，分别对应于以正磁化为主的状态（$M = \\sum_i s_i > 0$）和以负磁化为主的状态（$M  0$）。为了使算法具有遍历性，它必须能够在这两个构型空间扇区之间产生跃迁。\n\n标准的 Wolff 算法是遍历的。它的工作原理是从一个随机选择的位点 $i$ 开始，构建一个同号自旋的团簇。相邻的同号自旋 $(j, k)$ 之间的键以概率 $p = 1 - \\exp(-2\\beta J)$ 添加。然后整个团簇被翻转。在低温下（$\\beta  \\beta_c$），一个典型的构型由一个大的、逾渗的多数自旋取向的“海洋”组成，其中点缀着少数自旋取向的小“岛屿”。Wolff 算法可以在这个多数自旋海洋中选择一个自旋，并生成一个同样很大且经常环绕环面的团簇。翻转这样一个大团簇可以改变全局磁化的符号，从而实现两个对称性破缺扇区之间的跃迁。\n\n提议的修改是，如果提议的团簇表现出非平凡的环绕数（即环绕环面），则确定性地拒绝任何提议的团簇翻转。我们必须分析这个拒绝规则的后果。\n\n**遍历性破坏的反例与机制**\n\n考虑一个处于有序相深处（$\\beta \\gg \\beta_c$）的典型构型，例如一个具有大正磁化强度的构型。该构型将由 $+1$ 自旋主导，它们形成一个单一的、大的连通分量，该分量至少在一个方向上（通常是两个方向）环绕环面。这是逾渗理论的一个标准结果；多数自旋的密度远高于逾渗阈值。\n\n要从这个正磁化状态跃迁到一个负磁化状态，必须翻转系统自旋的很大一部分。具体来说，如果初始磁化为 $M_{initial}0$，则必须将超过 $M_{initial}/2$ 个自旋从 $+1$ 翻转到 $-1$ 才能使最终磁化变为负值。一个包含这么多自旋、从多数相中抽取的团簇，几乎必然是一个环绕团簇，特别是对于大晶格尺寸 $L$。\n\n在修改后的规则下，任何翻转这样一个环绕团簇的尝试都会被拒绝。该算法只能执行两种类型的成功翻转：\n1. 翻转一个小的、非环绕的少数自旋（例如 $-1$ 自旋）岛屿。这将把它们变成 $+1$ 自旋，从而增加正磁化强度的大小，并将系统更深地推入正扇区。\n2. 翻转多数（$+1$）自旋海洋的一个小的、非环绕部分。这会在仍然环绕的 $+1$ 海洋中创建一个 $-1$ 自旋的岛屿。此举会降低磁化强度，但不能改变其符号。\n\n本质上，任何单一的移动或允许的移动序列都无法跨越正负磁化扇区之间的鸿沟。状态空间被分割成至少两个不连通的集合（连通类），$\\Omega_+ = \\{\\{s_i\\} | M  \\delta\\}$ 和 $\\Omega_- = \\{\\{s_i\\} | M  -\\delta\\}$（对于某个 $\\delta  0$），它们之间不可能发生跃迁。这违反了不可约性。因此，修改后的算法是非遍历的。\n\n**恢复遍历性的最小修改**\n\n为了恢复遍历性，必须引入至少一种能够连接不连通扇区的移动类型，同时仍然满足相对于玻尔兹曼分布的细致平衡条件。\n\n1. **全局自旋翻转：** 提议翻转系统中的所有自旋，即对所有 $i$ 执行 $s_i \\mapsto -s_i$。对于给定的哈密顿量 $H(\\{s_i\\})=-J\\sum_{\\langle i j\\rangle} s_i s_j$，全局翻转的能量变化为 $\\Delta H = H(\\{-s_i\\}) - H(\\{s_i\\}) = -J\\sum_{\\langle i j\\rangle} (-s_i)(-s_j) - (-J\\sum_{\\langle i j\\rangle} s_i s_j) = 0$。Metropolis 接受概率为 $\\min\\{1, \\exp(-\\beta \\Delta H)\\} = 1$。这一移动总是将状态 $\\{s_i\\}$ 连接到 $\\{-s_i\\}$，从而直接连接正负磁化扇区。将此移动混入马尔可夫链中（例如，以一个小的概率 $\\varepsilon  0$ 尝试它）可以恢复不可约性并满足细致平衡。\n\n2. **局部 Metropolis 更新：** 提议翻转一个随机选择的单个自旋 $s_k$。接受概率由标准 Metropolis 规则给出，$P_{acc} = \\min\\{1, \\exp(-\\beta \\Delta H_k)\\}$，其中 $\\Delta H_k$ 是局部能量变化。一系列单自旋翻转可以连接任何两个构型，因此这种移动类型本身就是遍历的。将局部更新与修改后的团簇算法混合，可确保整个链是不可约的，并满足细致平衡。\n\n两者都是有效的最小修复方案。现在我们来评估这些选项。\n\n**选项 A. 分析**\n- **反例：** 该选项正确地指出，对于 $\\beta  \\beta_c$，多数自旋相会形成一个环绕团簇。它正确地论证说，任何大到足以反转磁化符号的团簇都将是一个环绕团簇，而禁止其翻转会阻止两个对称性破缺扇区之间的跃迁。这个分析是完全合理的。\n- **最小修复方案：** 该选项提议通过全局自旋翻转移动来增强动力学。它正确地指出，对于零场伊辛模型，此移动的 $\\Delta H=0$，接受概率为 1，它在保持细致平衡的同时恢复了扇区之间的连通性。这是一个有效且最小的修复方案。\n- **结论：** 正确。\n\n**选项 B. 分析**\n- **反例：** 该选项声称禁止环绕团簇不影响遍历性，这是错误的，正如我们的分析所示。“有限多次翻转非环绕团簇总是可以反转全局磁化”的推理在有序相中是不正确的，因为系统会被困在一个磁化扇区中。\n- **最小修复方案：** 它错误地指出无需更改。\n- **结论：** 错误。\n\n**选项 C. 分析**\n- **反例：** 该选项正确地指出更新是非遍历的，但错误地声称问题是细致平衡的失效，而不是扇区连通性（不可约性）问题。修改后的更新规则对于它所允许的跃迁*确实*满足细致平衡。问题在于某些关键跃迁的概率恰好为零。\n- **最小修复方案：** 这提议改变键概率 $p$。改变定义 $p=1-\\mathrm{e}^{-2\\beta J}$ 会破坏 Wolff 构建相对于目标玻尔兹曼分布的细致平衡条件。由此产生的算法将从一个不正确的分布中抽样。这不是一个有效的修复方案。\n- **结论：** 错误。\n\n**选项 D. 分析**\n- **反例：** 该选项提供了对遍历性破坏的正确描述。它准确地描述了非环绕的少数自旋岛屿的翻转如何加强当前的磁化扇区，以及多数自旋海洋的非环绕部分的翻转无法克服逾渗主干来翻转全局符号。这是一个正确而详细的机制。\n- **最小修复方案：** 该选项提议混合局部的单自旋 Metropolis 更新。它正确地指出，这是一种恢复遍历性的有效方法，因为两个满足细致平衡的核的混合也满足细致平衡，并且局部更新核是不可约的。这是一个标准的、有效的、最小的修复方案。\n- **结论：** 正确。\n\n选项 A 和 D 都提供了有效的反例和有效的最小修复方案。因此，这两个选项都是正确的。",
            "answer": "$$\\boxed{AD}$$"
        }
    ]
}