{
    "hands_on_practices": [
        {
            "introduction": "The cornerstone of Linear Combination of Atomic Orbitals (LCAO) methods is the evaluation of integrals between basis functions on different atoms. This exercise directly contrasts the analytical convenience of Gaussian-type orbitals (GTOs) with the numerical challenge posed by the more physically accurate Slater-type orbitals (STOs) for the fundamental overlap integral. By deriving the GTO overlap formula from first principles and implementing a numerical scheme for the STO case, you will gain a first-hand appreciation for the central trade-off that has shaped the development of computational quantum chemistry .",
            "id": "3821264",
            "problem": "Consider localized basis sets used in multiscale materials simulation, specifically $s$-type Gaussian-type orbitals (GTOs) and $s$-type Slater-type orbitals (STOs). An $s$-type GTO centered at a position vector $\\mathbf{A} \\in \\mathbb{R}^3$ is defined by the function $\\chi(\\mathbf{r}) = N \\exp\\!\\left(-\\alpha \\lvert \\mathbf{r} - \\mathbf{A}\\rvert^2\\right)$, where $\\alpha > 0$ is the Gaussian exponent and $N$ is a normalization factor chosen so that $\\int_{\\mathbb{R}^3} \\lvert \\chi(\\mathbf{r})\\rvert^2 \\, d\\mathbf{r} = 1$. An $s$-type STO centered at $\\mathbf{A}$ is defined by $\\chi(\\mathbf{r}) = N \\exp\\!\\left(-\\zeta \\lvert \\mathbf{r} - \\mathbf{A}\\rvert\\right)$, where $\\zeta > 0$ is the Slater exponent and $N$ is chosen so that $\\int_{\\mathbb{R}^3} \\lvert \\chi(\\mathbf{r})\\rvert^2 \\, d\\mathbf{r} = 1$. All quantities are to be treated in atomic units, where distances are measured in bohr, and the final overlap integrals are dimensionless.\n\nStarting from these definitions and using only fundamental mathematical operations, derive the analytic expression for the overlap integral\n$$\nS_{\\mathrm{GTO}} = \\int_{\\mathbb{R}^3} \\chi_a(\\mathbf{r}) \\, \\chi_b(\\mathbf{r}) \\, d\\mathbf{r}\n$$\nbetween two normalized $s$-type GTOs centered at $\\mathbf{A}$ and $\\mathbf{B}$ with exponents $\\alpha_a$ and $\\alpha_b$. Your derivation must begin from the stated definitions, the condition of normalization, and first principles such as completing the square, and must not invoke any pre-derived shortcut formulas.\n\nThen, for the STO case, set up the corresponding overlap integral\n$$\nS_{\\mathrm{STO}} = \\int_{\\mathbb{R}^3} \\chi_a(\\mathbf{r}) \\, \\chi_b(\\mathbf{r}) \\, d\\mathbf{r}\n$$\nbetween two normalized $s$-type STOs centered at $\\mathbf{A}$ and $\\mathbf{B}$ with exponents $\\zeta_a$ and $\\zeta_b$. Use a mathematically sound numerical quadrature scheme to evaluate $S_{\\mathrm{STO}}$ to high accuracy. To ensure universality and reproducibility, perform the angular integration using Gauss–Legendre quadrature on the variable $u = \\cos\\theta$ over $[-1,1]$, and perform the radial integration over $[0,\\infty)$ using a robust one-dimensional quadrature. Explicitly state any change of variables and justify convergence. The program must compute $S_{\\mathrm{GTO}}$ analytically and $S_{\\mathrm{STO}}$ numerically for each test case below.\n\nUse the following test suite, where $\\mathbf{A}$ and $\\mathbf{B}$ are given in bohr, and exponents are in appropriate atomic units:\n- Test case $1$ (coincident centers, identical exponents): $\\mathbf{A} = [\\,0,0,0\\,]$, $\\mathbf{B} = [\\,0,0,0\\,]$, $\\alpha_a = \\alpha_b = 0.7$, $\\zeta_a = \\zeta_b = 1.3$.\n- Test case $2$ (moderate separation, identical exponents): $\\mathbf{A} = [\\,0,0,0\\,]$, $\\mathbf{B} = [\\,1.0,0,0\\,]$, $\\alpha_a = \\alpha_b = 0.7$, $\\zeta_a = \\zeta_b = 1.3$.\n- Test case $3$ (large separation, identical exponents): $\\mathbf{A} = [\\,0,0,0\\,]$, $\\mathbf{B} = [\\,5.0,0,0\\,]$, $\\alpha_a = \\alpha_b = 0.7$, $\\zeta_a = \\zeta_b = 1.3$.\n- Test case $4$ (moderate separation, different exponents): $\\mathbf{A} = [\\,0,0,0\\,]$, $\\mathbf{B} = [\\,1.5,0,0\\,]$, $\\alpha_a = 0.5$, $\\alpha_b = 1.2$, $\\zeta_a = 1.0$, $\\zeta_b = 2.0$.\n\nYour program must:\n- Compute $S_{\\mathrm{GTO}}$ analytically using your derived expression.\n- Compute $S_{\\mathrm{STO}}$ numerically using the specified quadrature approach, ensuring absolute and relative integration tolerances are chosen to achieve results accurate to at least $10^{-8}$ in absolute error.\n- For each test case, return the pair $\\left[S_{\\mathrm{GTO}}, S_{\\mathrm{STO}}\\right]$.\n\nFinal output format: Your program should produce a single line of output containing the results for the four test cases as a comma-separated list of four lists, each inner list containing two floating-point numbers rounded to $8$ digits after the decimal point, enclosed in square brackets, for example, $\\left[ [\\,0.12345678,0.23456789\\,], [\\,\\cdots\\,], [\\,\\cdots\\,], [\\,\\cdots\\,] \\right]$. No units appear in the output.",
            "solution": "The problem is assessed to be valid as it is scientifically grounded, well-posed, objective, and contains a complete and consistent setup. It presents a standard, verifiable problem from computational quantum chemistry. We now proceed with the solution.\n\nThe solution is presented in two parts. First, we derive the analytical expression for the overlap integral between two $s$-type Gaussian-type orbitals (GTOs). Second, we set up the corresponding overlap integral for Slater-type orbitals (STOs) for numerical evaluation, as stipulated by the problem.\n\n### Part 1: Analytical Overlap Integral for $s$-type GTOs\n\nAn unnormalized $s$-type GTO centered at a position vector $\\mathbf{A} \\in \\mathbb{R}^3$ with exponent $\\alpha > 0$ is given by $\\phi(\\mathbf{r}) = \\exp(-\\alpha |\\mathbf{r} - \\mathbf{A}|^2)$. The normalized orbital is $\\chi(\\mathbf{r}) = N \\phi(\\mathbf{r})$, where the normalization constant $N$ is determined by the condition $\\int_{\\mathbb{R}^3} |\\chi(\\mathbf{r})|^2 \\, d\\mathbf{r} = 1$.\n\n**1.1. GTO Normalization Constant**\n\nThe normalization integral is:\n$$\n\\int_{\\mathbb{R}^3} N^2 \\exp(-2\\alpha |\\mathbf{r} - \\mathbf{A}|^2) \\, d\\mathbf{r} = 1\n$$\nBy shifting the origin of the coordinate system, $\\mathbf{r}' = \\mathbf{r} - \\mathbf{A}$, this becomes:\n$$\nN^2 \\int_{\\mathbb{R}^3} \\exp(-2\\alpha |\\mathbf{r}'|^2) \\, d\\mathbf{r}' = 1\n$$\nThe integral is separable in Cartesian coordinates $(x', y', z')$. Using the standard Gaussian integral formula $\\int_{-\\infty}^{\\infty} e^{-ax^2} dx = \\sqrt{\\pi/a}$, we have:\n$$\n\\int_{\\mathbb{R}^3} e^{-2\\alpha(x'^2+y'^2+z'^2)} dx'dy'dz' = \\left( \\int_{-\\infty}^{\\infty} e^{-2\\alpha u^2} du \\right)^3 = \\left(\\sqrt{\\frac{\\pi}{2\\alpha}}\\right)^3 = \\left(\\frac{\\pi}{2\\alpha}\\right)^{3/2}\n$$\nThe normalization condition becomes $N^2 (\\frac{\\pi}{2\\alpha})^{3/2} = 1$, which gives the normalization constant:\n$$\nN = \\left(\\frac{2\\alpha}{\\pi}\\right)^{3/4}\n$$\n\n**1.2. GTO Overlap Integral Derivation**\n\nWe seek to evaluate the overlap integral $S_{\\mathrm{GTO}} = \\int_{\\mathbb{R}^3} \\chi_a(\\mathbf{r}) \\chi_b(\\mathbf{r}) \\, d\\mathbf{r}$ between two normalized $s$-type GTOs, $\\chi_a$ and $\\chi_b$, centered at $\\mathbf{A}$ and $\\mathbf{B}$ with exponents $\\alpha_a$ and $\\alpha_b$, respectively.\n$$\n\\chi_a(\\mathbf{r}) = \\left(\\frac{2\\alpha_a}{\\pi}\\right)^{3/4} \\exp(-\\alpha_a |\\mathbf{r} - \\mathbf{A}|^2) \\\\\n\\chi_b(\\mathbf{r}) = \\left(\\frac{2\\alpha_b}{\\pi}\\right)^{3/4} \\exp(-\\alpha_b |\\mathbf{r} - \\mathbf{B}|^2)\n$$\nThe overlap integral is:\n$$\nS_{\\mathrm{GTO}} = \\left(\\frac{2\\alpha_a}{\\pi}\\right)^{3/4} \\left(\\frac{2\\alpha_b}{\\pi}\\right)^{3/4} \\int_{\\mathbb{R}^3} \\exp(-\\alpha_a |\\mathbf{r} - \\mathbf{A}|^2 - \\alpha_b |\\mathbf{r} - \\mathbf{B}|^2) \\, d\\mathbf{r}\n$$\nThe product of two Gaussians is another Gaussian, a property known as the Gaussian Product Theorem. To show this, we combine the terms in the exponent by completing the square. The exponent is:\n$$\nE = -\\alpha_a (\\mathbf{r}^2 - 2\\mathbf{r}\\cdot\\mathbf{A} + \\mathbf{A}^2) - \\alpha_b (\\mathbf{r}^2 - 2\\mathbf{r}\\cdot\\mathbf{B} + \\mathbf{B}^2) \\\\\n= -(\\alpha_a + \\alpha_b)\\mathbf{r}^2 + 2(\\alpha_a\\mathbf{A} + \\alpha_b\\mathbf{B})\\cdot\\mathbf{r} - (\\alpha_a\\mathbf{A}^2 + \\alpha_b\\mathbf{B}^2)\n$$\nLet $\\alpha_p = \\alpha_a + \\alpha_b$ and define a new center $\\mathbf{P} = \\frac{\\alpha_a\\mathbf{A} + \\alpha_b\\mathbf{B}}{\\alpha_p}$. We can rewrite the exponent in the form $-\\alpha_p|\\mathbf{r} - \\mathbf{P}|^2 + K$:\n$$\n-\\alpha_p|\\mathbf{r} - \\mathbf{P}|^2 = -\\alpha_p(\\mathbf{r}^2 - 2\\mathbf{r}\\cdot\\mathbf{P} + \\mathbf{P}^2) = -(\\alpha_a+\\alpha_b)\\mathbf{r}^2 + 2(\\alpha_a\\mathbf{A}+\\alpha_b\\mathbf{B})\\cdot\\mathbf{r} - \\alpha_p\\mathbf{P}^2\n$$\nComparing with the expression for $E$, we see that the terms dependent on $\\mathbf{r}$ match perfectly. The constant term $K$ is:\n$$\nK = \\alpha_p\\mathbf{P}^2 - (\\alpha_a\\mathbf{A}^2 + \\alpha_b\\mathbf{B}^2) = \\frac{(\\alpha_a\\mathbf{A} + \\alpha_b\\mathbf{B})^2}{\\alpha_a+\\alpha_b} - (\\alpha_a\\mathbf{A}^2 + \\alpha_b\\mathbf{B}^2)\n$$\nExpanding and simplifying this expression yields:\n$$\nK = -\\frac{\\alpha_a\\alpha_b}{\\alpha_a+\\alpha_b} (\\mathbf{A}^2 - 2\\mathbf{A}\\cdot\\mathbf{B} + \\mathbf{B}^2) = -\\frac{\\alpha_a\\alpha_b}{\\alpha_a+\\alpha_b} |\\mathbf{A}-\\mathbf{B}|^2\n$$\nThe integral becomes:\n$$\n\\int_{\\mathbb{R}^3} \\exp(-\\alpha_p |\\mathbf{r} - \\mathbf{P}|^2) \\exp(K) \\, d\\mathbf{r} = \\exp(K) \\int_{\\mathbb{R}^3} \\exp(-\\alpha_p |\\mathbf{r} - \\mathbf{P}|^2) \\, d\\mathbf{r}\n$$\nThe integral is a standard Gaussian integral, which evaluates to $(\\pi/\\alpha_p)^{3/2} = (\\pi/(\\alpha_a+\\alpha_b))^{3/2}$.\nCombining all terms for $S_{\\mathrm{GTO}}$:\n$$\nS_{\\mathrm{GTO}} = \\left(\\frac{4\\alpha_a\\alpha_b}{\\pi^2}\\right)^{3/4} \\left(\\frac{\\pi}{\\alpha_a+\\alpha_b}\\right)^{3/2} \\exp\\left(-\\frac{\\alpha_a\\alpha_b}{\\alpha_a+\\alpha_b} |\\mathbf{A}-\\mathbf{B}|^2\\right)\n$$\nSimplifying the pre-factors:\n$$\n\\left(\\frac{(4\\alpha_a\\alpha_b)^{3/4}}{(\\pi^2)^{3/4}}\\right) \\left(\\frac{\\pi^{3/2}}{(\\alpha_a+\\alpha_b)^{3/2}}\\right) = \\frac{(4\\alpha_a\\alpha_b)^{3/4}}{\\pi^{3/2}} \\frac{\\pi^{3/2}}{(\\alpha_a+\\alpha_b)^{3/2}} = \\left(\\frac{4\\alpha_a\\alpha_b}{(\\alpha_a+\\alpha_b)^2}\\right)^{3/4}\n$$\nThe final analytical expression for the overlap integral is:\n$$\nS_{\\mathrm{GTO}} = \\left(\\frac{4\\alpha_a\\alpha_b}{(\\alpha_a+\\alpha_b)^2}\\right)^{3/4} \\exp\\left(-\\frac{\\alpha_a\\alpha_b}{\\alpha_a+\\alpha_b} |\\mathbf{A}-\\mathbf{B}|^2\\right)\n$$\n\n### Part 2: Numerical Overlap Integral for $s$-type STOs\n\nAn unnormalized $s$-type STO centered at $\\mathbf{A}$ with exponent $\\zeta > 0$ is $\\phi(\\mathbf{r}) = \\exp(-\\zeta|\\mathbf{r}-\\mathbf{A}|)$.\n\n**2.1. STO Normalization Constant**\n\nThe normalization integral $\\int_{\\mathbb{R}^3} N^2 \\exp(-2\\zeta |\\mathbf{r} - \\mathbf{A}|) \\, d\\mathbf{r} = 1$ is best evaluated in spherical polar coordinates centered at $\\mathbf{A}$. Let $\\mathbf{r}' = \\mathbf{r} - \\mathbf{A}$.\n$$\nN^2 \\int_0^{2\\pi}d\\phi \\int_0^\\pi \\sin\\theta d\\theta \\int_0^\\infty r'^2 e^{-2\\zeta r'} dr' = 1\n$$\nThe angular integrals yield $4\\pi$. The radial integral is a Gamma function, $\\int_0^\\infty x^n e^{-ax} dx = n!/a^{n+1}$. For $n=2$ and $a=2\\zeta$, the integral is $2!/(2\\zeta)^3 = 2/(8\\zeta^3) = 1/(4\\zeta^3)$.\nThe condition becomes $N^2 (4\\pi) (1/(4\\zeta^3)) = N^2 \\pi/\\zeta^3 = 1$, giving the normalization constant:\n$$\nN = \\sqrt{\\frac{\\zeta^3}{\\pi}}\n$$\n\n**2.2. STO Overlap Integral Numerical Setup**\n\nThe overlap integral $S_{\\mathrm{STO}}$ between two normalized STOs centered at $\\mathbf{A}$ and $\\mathbf{B}$ with exponents $\\zeta_a$ and $\\zeta_b$ is:\n$$\nS_{\\mathrm{STO}} = \\frac{\\sqrt{\\zeta_a^3\\zeta_b^3}}{\\pi} \\int_{\\mathbb{R}^3} \\exp(-\\zeta_a |\\mathbf{r}-\\mathbf{A}| - \\zeta_b |\\mathbf{r}-\\mathbf{B}|) \\, d\\mathbf{r}\n$$\nThe value of this integral is invariant under rigid translation and rotation of the coordinate system. We can simplify the setup by placing $\\mathbf{A}$ at the origin $(0,0,0)$ and $\\mathbf{B}$ on the $z$-axis at $(0,0,R)$, where $R=|\\mathbf{A}-\\mathbf{B}|$. The distances become $r_a = |\\mathbf{r}-\\mathbf{A}| = r$ and $r_b = |\\mathbf{r}-\\mathbf{B}| = \\sqrt{r^2+R^2-2rR\\cos\\theta}$, where $(r, \\theta, \\phi)$ are the spherical coordinates of $\\mathbf{r}$.\nThe integral in these coordinates is:\n$$\nS_{\\mathrm{STO}} = \\frac{\\sqrt{\\zeta_a^3\\zeta_b^3}}{\\pi} \\int_0^{2\\pi}d\\phi \\int_0^\\pi d\\theta \\int_0^\\infty dr \\left[ r^2 \\sin\\theta \\exp(-\\zeta_a r - \\zeta_b \\sqrt{r^2+R^2-2rR\\cos\\theta}) \\right]\n$$\nThe integrand is independent of $\\phi$, so integration over $\\phi$ yields a factor of $2\\pi$.\n$$\nS_{\\mathrm{STO}} = 2\\sqrt{\\zeta_a^3\\zeta_b^3} \\int_0^\\pi \\sin\\theta \\int_0^\\infty r^2 \\exp(-\\zeta_a r - \\zeta_b \\sqrt{r^2+R^2-2rR\\cos\\theta}) \\, dr \\, d\\theta\n$$\nAs specified, we perform a change of variables for the angular integral: $u = \\cos\\theta$, so $du = -\\sin\\theta d\\theta$. The integration limits change from $[\\,0, \\pi\\,]$ to $[\\,1, -1\\,]$, which is equivalent to integrating from $-1$ to $1$.\n$$\nS_{\\mathrm{STO}} = 2\\sqrt{\\zeta_a^3\\zeta_b^3} \\int_{-1}^{1} \\left( \\int_0^{\\infty} r^2 \\exp(-\\zeta_a r - \\zeta_b \\sqrt{r^2+R^2-2rRu}) \\, dr \\right) du\n$$\nThis two-dimensional integral is solved numerically. The outer integral over $u \\in [-1,1]$ is approximated using Gauss-Legendre quadrature:\n$$\n\\int_{-1}^{1} f(u) du \\approx \\sum_{i=1}^{N_u} w_i f(u_i)\n$$\nwhere $u_i$ and $w_i$ are the quadrature nodes and weights. The inner function $f(u_i)$ corresponds to the one-dimensional radial integral:\n$$\nf(u_i) = \\int_0^{\\infty} r^2 \\exp(-\\zeta_a r - \\zeta_b \\sqrt{r^2+R^2-2rRu_i}) \\, dr\n$$\nThis integral over the semi-infinite domain $[0, \\infty)$ is evaluated using a robust adaptive quadrature routine, such as `scipy.integrate.quad`.\n\nThe convergence of this numerical scheme is well-founded. For any fixed $r > 0$, the integrand is a very smooth function of $u$ over $[-1, 1]$, which ensures rapid convergence of Gauss-Legendre quadrature with an increasing number of points $N_u$. For the radial integral, the integrand decays exponentially as $r \\to \\infty$, ensuring the integral is finite and readily handled by adaptive quadrature algorithms designed for such problems. The required accuracy of $10^{-8}$ can be achieved by selecting a sufficiently large $N_u$ and setting appropriately small tolerance parameters for the inner quadrature.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\nfrom scipy.special import roots_legendre\n\ndef solve():\n    \"\"\"\n    Main function to compute and print GTO and STO overlap integrals for given test cases.\n    \"\"\"\n    \n    # Test cases defined in the problem statement\n    # Format: (A, B, alpha_a, alpha_b, zeta_a, zeta_b)\n    test_cases = [\n        ([0.0, 0.0, 0.0], [0.0, 0.0, 0.0], 0.7, 0.7, 1.3, 1.3),\n        ([0.0, 0.0, 0.0], [1.0, 0.0, 0.0], 0.7, 0.7, 1.3, 1.3),\n        ([0.0, 0.0, 0.0], [5.0, 0.0, 0.0], 0.7, 0.7, 1.3, 1.3),\n        ([0.0, 0.0, 0.0], [1.5, 0.0, 0.0], 0.5, 1.2, 1.0, 2.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        A_vec, B_vec, alpha_a, alpha_b, zeta_a, zeta_b = case\n        A, B = np.array(A_vec), np.array(B_vec)\n\n        s_gto = compute_gto_overlap(alpha_a, alpha_b, A, B)\n        s_sto = compute_sto_overlap(zeta_a, zeta_b, A, B)\n\n        results.append([s_gto, s_sto])\n\n    # Format the final output string as specified\n    inner_parts = []\n    for r_gto, r_sto in results:\n        inner_parts.append(f\"[{r_gto:.8f}, {r_sto:.8f}]\")\n    output_string = \"[\" + \", \".join(inner_parts) + \"]\"\n    print(output_string)\n\n\ndef compute_gto_overlap(alpha_a: float, alpha_b: float, A: np.ndarray, B: np.ndarray) -> float:\n    \"\"\"\n    Computes the overlap integral between two s-type GTOs analytically.\n    \n    Args:\n        alpha_a: Exponent of GTO at center A.\n        alpha_b: Exponent of GTO at center B.\n        A: Position vector of center A.\n        B: Position vector of center B.\n\n    Returns:\n        The value of the overlap integral S_GTO.\n    \"\"\"\n    R_sq = np.sum((A - B)**2)\n    alpha_p = alpha_a + alpha_b\n    \n    prefactor_term = (4 * alpha_a * alpha_b) / (alpha_p**2)\n    prefactor = prefactor_term**(3.0 / 4.0)\n    \n    exponent_term = (alpha_a * alpha_b) / alpha_p\n    exponent = np.exp(-exponent_term * R_sq)\n    \n    return prefactor * exponent\n\n\ndef compute_sto_overlap(zeta_a: float, zeta_b: float, A: np.ndarray, B: np.ndarray) -> float:\n    \"\"\"\n    Computes the overlap integral between two s-type STOs numerically.\n    \n    The numerical integration is done using Gauss-Legendre quadrature for the\n    angular part and scipy.integrate.quad for the radial part.\n\n    Args:\n        zeta_a: Exponent of STO at center A.\n        zeta_b: Exponent of STO at center B.\n        A: Position vector of center A.\n        B: Position vector of center B.\n\n    Returns:\n        The value of the overlap integral S_STO.\n    \"\"\"\n    R = np.linalg.norm(A - B)\n\n    # Coincident centers case: use analytical formula for speed and stability\n    if np.isclose(R, 0.0):\n        if np.isclose(zeta_a, zeta_b):\n            return 1.0\n        return 8.0 * ((zeta_a * zeta_b)**0.5 / (zeta_a + zeta_b))**3.0\n\n    # Numerical integration for separated centers\n    prefactor = 2.0 * (zeta_a**3 * zeta_b**3)**0.5\n\n    # Number of points for Gauss-Legendre quadrature.\n    # 64 points is sufficient for high accuracy for these smooth integrands.\n    N_u = 64\n    u_nodes, u_weights = roots_legendre(N_u)\n\n    # Integration tolerances for the inner radial integral\n    quad_epsabs = 1e-12\n    quad_epsrel = 1e-12\n\n    angular_integral_sum = 0.0\n    for i in range(N_u):\n        u = u_nodes[i]\n        w = u_weights[i]\n\n        # Define the radial integrand for the current angular node u\n        def radial_integrand(r):\n            sqrt_arg = r**2 + R**2 - 2 * r * R * u\n            # The argument to sqrt is always non-negative for r>=0, u in [-1,1]\n            # It is (r-R)^2 at u=1 and (r+R)^2 at u=-1.\n            r_b = np.sqrt(sqrt_arg)\n            return r**2 * np.exp(-zeta_a * r - zeta_b * r_b)\n\n        # Compute the radial integral for this u\n        radial_integral_val, _ = integrate.quad(\n            radial_integrand, 0, np.inf, \n            epsabs=quad_epsabs, epsrel=quad_epsrel\n        )\n        \n        angular_integral_sum += w * radial_integral_val\n\n    return prefactor * angular_integral_sum\n\n# Execute the solution\nsolve()\n\n```"
        },
        {
            "introduction": "While overlap integrals are essential, the true computational bottleneck in many quantum chemistry methods arises from the vast number of two-electron repulsion integrals (ERIs). This practice demonstrates how the mathematical properties that make GTOs efficient, particularly the Gaussian Product Theorem, extend to simplify these complex four-center integrals into a manageable form. You will derive and compute a specific $(ss|ss)$ ERI, a foundational block for understanding the computational machinery of Hartree-Fock and more advanced electronic structure theories .",
            "id": "3821317",
            "problem": "Consider two normalized primitive $s$-type Gaussian-type orbitals (GTOs) centered at positions $\\mathbf{A}$ and $\\mathbf{B}$ in three-dimensional space, defined by $\\phi_{\\mathbf{A}}(\\mathbf{r}) = N(\\alpha) \\exp\\!\\big(-\\alpha |\\mathbf{r}-\\mathbf{A}|^{2}\\big)$ and $\\phi_{\\mathbf{B}}(\\mathbf{r}) = N(\\alpha) \\exp\\!\\big(-\\alpha |\\mathbf{r}-\\mathbf{B}|^{2}\\big)$, where the normalization factor is $N(\\alpha) = \\left(\\frac{2\\alpha}{\\pi}\\right)^{3/4}$. Place the centers on the $x$-axis as $\\mathbf{A}=(0,0,0)$ and $\\mathbf{B}=(R,0,0)$ with $R>0$, and take a common Gaussian exponent $\\alpha>0$. The Electron Repulsion Integral (ERI) for the $(ss|ss)$ case over these two centers is defined by\n$$\n(\\!s_{\\mathbf{A}} s_{\\mathbf{B}} \\mid s_{\\mathbf{A}} s_{\\mathbf{B}}\\!) \\;=\\; \\iint \\phi_{\\mathbf{A}}(\\mathbf{r}_{1})\\,\\phi_{\\mathbf{B}}(\\mathbf{r}_{1})\\,\\frac{1}{|\\mathbf{r}_{1}-\\mathbf{r}_{2}|}\\,\\phi_{\\mathbf{A}}(\\mathbf{r}_{2})\\,\\phi_{\\mathbf{B}}(\\mathbf{r}_{2}) \\, d^{3}\\mathbf{r}_{1}\\, d^{3}\\mathbf{r}_{2}.\n$$\nStarting from the Coulomb operator $1/|\\mathbf{r}_{1}-\\mathbf{r}_{2}|$, the Gaussian product theorem, and the definition of the Boys function, derive a closed-form expression for $(\\!s_{\\mathbf{A}} s_{\\mathbf{B}} \\mid s_{\\mathbf{A}} s_{\\mathbf{B}}\\!)$ specialized to the case of equal exponents and the geometry above. Then evaluate this ERI numerically for the parameters $\\alpha = 1.0 \\ \\mathrm{bohr}^{-2}$ and $R = 1.0 \\ \\mathrm{bohr}$. Use the high-precision reference value $I_{\\mathrm{ref}} = 0.415107497420595$ for the ERI in Hartree (atomic units of energy) to verify numerical accuracy.\n\nAnswer specification:\n- Compute the ERI and round its numerical value to six significant figures. Express this value in Hartree.\n- Compute the absolute error $E = |I_{\\text{rounded}} - I_{\\mathrm{ref}}|$ and round it to six significant figures. Express $E$ in Hartree.\n- Present your final answer as a row matrix containing two entries: the rounded ERI value and the rounded absolute error.",
            "solution": "The user wants to solve a quantum chemistry problem, specifically the calculation of a two-electron repulsion integral (ERI) for Gaussian-type orbitals (GTOs).\n\n### Step 1: Extract Givens\n-   **Orbital Definitions**: Two normalized primitive $s$-type GTOs, $\\phi_{\\mathbf{A}}(\\mathbf{r}) = N(\\alpha) \\exp\\!\\big(-\\alpha |\\mathbf{r}-\\mathbf{A}|^{2}\\big)$ and $\\phi_{\\mathbf{B}}(\\mathbf{r}) = N(\\alpha) \\exp\\!\\big(-\\alpha |\\mathbf{r}-\\mathbf{B}|^{2}\\big)$.\n-   **Normalization Constant**: $N(\\alpha) = \\left(\\frac{2\\alpha}{\\pi}\\right)^{3/4}$.\n-   **Geometry**: Centers are $\\mathbf{A}=(0,0,0)$ and $\\mathbf{B}=(R,0,0)$, with $R>0$.\n-   **Gaussian Exponent**: A common exponent $\\alpha>0$ is used.\n-   **Integral Definition**: The $(ss|ss)$ ERI is $(\\!s_{\\mathbf{A}} s_{\\mathbf{B}} \\mid s_{\\mathbf{A}} s_{\\mathbf{B}}\\!) = \\iint \\phi_{\\mathbf{A}}(\\mathbf{r}_{1})\\,\\phi_{\\mathbf{B}}(\\mathbf{r}_{1})\\,\\frac{1}{|\\mathbf{r}_{1}-\\mathbf{r}_{2}|}\\,\\phi_{\\mathbf{A}}(\\mathbf{r}_{2})\\,\\phi_{\\mathbf{B}}(\\mathbf{r}_{2}) \\, d^{3}\\mathbf{r}_{1}\\, d^{3}\\mathbf{r}_{2}$.\n-   **Numerical Parameters**: $\\alpha = 1.0 \\ \\mathrm{bohr}^{-2}$ and $R = 1.0 \\ \\mathrm{bohr}$.\n-   **Reference Value**: $I_{\\mathrm{ref}} = 0.415107497420595$ Hartree.\n-   **Task**: 1. Derive a closed-form expression for the ERI. 2. Evaluate it for the given parameters, rounding to six significant figures. 3. Compute the absolute error with respect to the reference, rounding it to six significant figures.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem is a standard calculation in computational quantum chemistry. The definitions of GTOs, the ERI, the Gaussian product theorem, and the Boys function are fundamental concepts in this field. The problem is firmly rooted in established scientific principles.\n-   **Well-Posed**: The problem is self-contained and provides all necessary information, including the functional forms of the orbitals, their centers, the common exponent, the definition of the integral, and the specific numerical parameters for evaluation. A unique and meaningful solution can be derived.\n-   **Objective**: The language is precise, mathematical, and free of any subjective or opinion-based statements. All terms are well-defined within the context of quantum chemistry.\n\n### Step 3: Verdict and Action\nThe problem is scientifically sound, well-posed, and objective. It contains no discernible flaws. Therefore, the problem is **valid**. The solution will now be derived.\n\nThe problem is to evaluate the electron repulsion integral (ERI) for two identical pairs of $s$-type Gaussian-type orbitals (GTOs). The integral is given by:\n$$\nI = (\\!s_{\\mathbf{A}} s_{\\mathbf{B}} \\mid s_{\\mathbf{A}} s_{\\mathbf{B}}\\!) = \\iint \\phi_{\\mathbf{A}}(\\mathbf{r}_{1})\\,\\phi_{\\mathbf{B}}(\\mathbf{r}_{1})\\,\\frac{1}{|\\mathbf{r}_{1}-\\mathbf{r}_{2}|}\\,\\phi_{\\mathbf{A}}(\\mathbf{r}_{2})\\,\\phi_{\\mathbf{B}}(\\mathbf{r}_{2}) \\, d^{3}\\mathbf{r}_{1}\\, d^{3}\\mathbf{r}_{2}\n$$\nThe integral can be rewritten by defining a product charge distribution, $\\Omega(\\mathbf{r}) = \\phi_{\\mathbf{A}}(\\mathbf{r})\\,\\phi_{\\mathbf{B}}(\\mathbf{r})$. With this definition, the ERI becomes:\n$$\nI = \\iint \\Omega(\\mathbf{r}_{1}) \\frac{1}{|\\mathbf{r}_{1}-\\mathbf{r}_{2}|} \\Omega(\\mathbf{r}_{2}) \\, d^{3}\\mathbf{r}_{1}\\, d^{3}\\mathbf{r}_{2}\n$$\nThis is the electrostatic self-repulsion energy of the charge distribution $\\Omega(\\mathbf{r})$.\n\nFirst, we apply the Gaussian Product Theorem (GPT) to the product of two GTOs. The product of two GTOs centered at $\\mathbf{A}$ and $\\mathbf{B}$ with exponents $\\alpha_{A}$ and $\\alpha_{B}$ is a new Gaussian centered at a point $\\mathbf{P}$:\n$$\n\\exp(-\\alpha_{A}|\\mathbf{r}-\\mathbf{A}|^2) \\exp(-\\alpha_{B}|\\mathbf{r}-\\mathbf{B}|^2) = \\exp\\left(-\\frac{\\alpha_A \\alpha_B}{\\alpha_A+\\alpha_B}|\\mathbf{A}-\\mathbf{B}|^2\\right) \\exp\\left(-(\\alpha_A+\\alpha_B)|\\mathbf{r}-\\mathbf{P}|^2\\right)\n$$\nwhere $\\mathbf{P} = \\frac{\\alpha_A \\mathbf{A} + \\alpha_B \\mathbf{B}}{\\alpha_A+\\alpha_B}$.\n\nIn our specific case, the exponents are equal, $\\alpha_A = \\alpha_B = \\alpha$. The new exponent is $p = \\alpha+\\alpha = 2\\alpha$, and the new center is $\\mathbf{P} = \\frac{\\alpha\\mathbf{A}+\\alpha\\mathbf{B}}{2\\alpha} = \\frac{\\mathbf{A}+\\mathbf{B}}{2}$. With $\\mathbf{A}=(0,0,0)$ and $\\mathbf{B}=(R,0,0)$, we have $\\mathbf{P} = (\\frac{R}{2}, 0, 0)$. Also, $|\\mathbf{A}-\\mathbf{B}|^2 = R^2$.\n\nThe charge distribution $\\Omega(\\mathbf{r})$ is:\n$$\n\\Omega(\\mathbf{r}) = \\phi_{\\mathbf{A}}(\\mathbf{r})\\,\\phi_{\\mathbf{B}}(\\mathbf{r}) = N(\\alpha)^2 \\exp(-\\alpha|\\mathbf{r}-\\mathbf{A}|^2) \\exp(-\\alpha|\\mathbf{r}-\\mathbf{B}|^2)\n$$\n$$\n\\Omega(\\mathbf{r}) = N(\\alpha)^2 \\exp\\left(-\\frac{\\alpha^2}{2\\alpha}R^2\\right) \\exp(-2\\alpha|\\mathbf{r}-\\mathbf{P}|^2) = N(\\alpha)^2 \\exp\\left(-\\frac{\\alpha R^2}{2}\\right) \\exp(-2\\alpha|\\mathbf{r}-\\mathbf{P}|^2)\n$$\nLet's define a constant $K = N(\\alpha)^2 \\exp\\left(-\\frac{\\alpha R^2}{2}\\right)$. The charge distribution is $\\Omega(\\mathbf{r}) = K \\exp(-p|\\mathbf{r}-\\mathbf{P}|^2)$ with $p=2\\alpha$.\n\nThe ERI is the self-repulsion of this Gaussian charge distribution. The general formula for the repulsion integral between two s-type Gaussian charge distributions, $\\rho_1(\\mathbf{r}) = \\exp(-p_1|\\mathbf{r}-\\mathbf{P}_1|^2)$ and $\\rho_2(\\mathbf{r}) = \\exp(-p_2|\\mathbf{r}-\\mathbf{P}_2|^2)$, is:\n$$\n\\iint \\rho_1(\\mathbf{r}_1) \\frac{1}{|\\mathbf{r}_1-\\mathbf{r}_2|} \\rho_2(\\mathbf{r}_2) \\, d^3\\mathbf{r}_1 d^3\\mathbf{r}_2 = \\frac{2\\pi^{5/2}}{p_1 p_2 \\sqrt{p_1+p_2}} F_0\\left(\\frac{p_1 p_2}{p_1+p_2}|\\mathbf{P}_1-\\mathbf{P}_2|^2\\right)\n$$\nwhere $F_0(T)$ is the Boys function of order zero, defined as $F_0(T) = \\int_0^1 \\exp(-Tu^2) du$.\n\nIn our problem, the two charge distributions are identical, so $\\rho_1 = \\rho_2 = \\Omega$, but without the pre-factor $K$.\nThe parameters are $p_1=p_2=p=2\\alpha$ and $\\mathbf{P}_1=\\mathbf{P}_2=\\mathbf{P}$.\nThe argument of the Boys function is $T = \\frac{p \\cdot p}{p+p}|\\mathbf{P}-\\mathbf{P}|^2 = 0$.\nThe Boys function at $T=0$ is $F_0(0) = \\int_0^1 \\exp(0) du = \\int_0^1 1 du = 1$.\n\nThe integral part becomes:\n$$\n\\frac{2\\pi^{5/2}}{p \\cdot p \\sqrt{p+p}} F_0(0) = \\frac{2\\pi^{5/2}}{(2\\alpha)(2\\alpha)\\sqrt{2\\alpha+2\\alpha}} \\cdot 1 = \\frac{2\\pi^{5/2}}{4\\alpha^2\\sqrt{4\\alpha}} = \\frac{2\\pi^{5/2}}{4\\alpha^2(2\\sqrt{\\alpha})} = \\frac{\\pi^{5/2}}{4\\alpha^{5/2}}\n$$\nThe total ERI is this value multiplied by the square of the pre-factor $K$:\n$$\nI = K^2 \\cdot \\frac{\\pi^{5/2}}{4\\alpha^{5/2}} = \\left[N(\\alpha)^2 \\exp\\left(-\\frac{\\alpha R^2}{2}\\right)\\right]^2 \\frac{\\pi^{5/2}}{4\\alpha^{5/2}}\n$$\nSubstitute $N(\\alpha) = \\left(\\frac{2\\alpha}{\\pi}\\right)^{3/4}$, so $N(\\alpha)^4 = \\left(\\frac{2\\alpha}{\\pi}\\right)^3$.\n$$\nI = \\left(\\frac{2\\alpha}{\\pi}\\right)^3 \\exp\\left(-\\alpha R^2\\right) \\frac{\\pi^{5/2}}{4\\alpha^{5/2}}\n$$\n$$\nI = \\frac{8\\alpha^3}{\\pi^3} \\exp\\left(-\\alpha R^2\\right) \\frac{\\pi^{5/2}}{4\\alpha^{5/2}}\n$$\n$$\nI = 2 \\frac{\\alpha^{3 - 5/2}}{\\pi^{3-5/2}} \\exp\\left(-\\alpha R^2\\right) = 2 \\frac{\\alpha^{1/2}}{\\pi^{1/2}} \\exp\\left(-\\alpha R^2\\right)\n$$\nThe final closed-form expression for the ERI is:\n$$\nI = 2 \\sqrt{\\frac{\\alpha}{\\pi}} \\exp\\left(-\\alpha R^2\\right)\n$$\n\nNow, we evaluate this expression for the given parameters $\\alpha = 1.0 \\ \\mathrm{bohr}^{-2}$ and $R = 1.0 \\ \\mathrm{bohr}$. In atomic units, these values are $\\alpha=1.0$ and $R=1.0$. The result will be in Hartree.\n$$\nI = 2 \\sqrt{\\frac{1.0}{\\pi}} \\exp\\left(-1.0 \\cdot (1.0)^2\\right) = \\frac{2}{\\sqrt{\\pi}} \\exp(-1) = \\frac{2}{e\\sqrt{\\pi}}\n$$\nUsing a high-precision calculator for the numerical value:\n$$\nI \\approx \\frac{2}{(2.718281828459045)(1.7724538509055159)} \\approx 0.4151074974205951\n$$\nThe problem asks for this value to be rounded to six significant figures.\n$I_{\\text{rounded}} = 0.415107$.\n\nNext, we compute the absolute error $E = |I_{\\text{rounded}} - I_{\\mathrm{ref}}|$.\nThe reference value is $I_{\\mathrm{ref}} = 0.415107497420595$.\n$$\nE = |0.415107 - 0.415107497420595| = |-0.000000497420595| = 0.000000497420595\n$$\nThis can be written in scientific notation as $4.97420595 \\times 10^{-7}$.\nRounding the error to six significant figures:\n$E \\approx 4.97421 \\times 10^{-7}$.\n\nThe final answer is a row matrix containing the rounded ERI and the rounded absolute error.",
            "answer": "$$ \\boxed{\\begin{pmatrix} 0.415107 & 4.97421 \\times 10^{-7} \\end{pmatrix}} $$"
        },
        {
            "introduction": "A key strategy in modern basis set design is to capture the physical accuracy of STOs using the computational efficiency of GTOs, leading to the well-known STO-nG basis sets. This exercise simulates a real-world research workflow: constructing a GTO expansion of a target STO and testing the convergence of a physical property—in this case, a proxy for cohesive energy—as the expansion becomes more complete. This practice bridges the gap between abstract basis functions and their practical application in the quantitative prediction of material properties .",
            "id": "3821281",
            "problem": "You are tasked with implementing a principled convergence test for a material property that is computed from localized basis sets using Gaussian-type orbitals (GTOs) as approximations to Slater-type orbitals (STOs), which is a common strategy in multiscale materials simulation. The property to be monitored is a proxy for cohesive energy derived from Linear Combination of Atomic Orbitals (LCAO) tight-binding arguments. You must construct a sequence of $N$-term GTO expansions of a target Slater-type orbital and compute how the resulting proxy cohesive energy changes as $N$ increases. The objective is to determine the smallest basis size at which the change in the property between consecutive basis sizes falls below a specified threshold.\n\nUse the following fundamental bases and well-tested facts:\n- A Slater-type orbital (STO) for a $1s$-like atomic orbital is defined as $\\phi_{\\mathrm{STO}}(\\mathbf{r}) = \\left(\\dfrac{\\zeta^{3}}{\\pi}\\right)^{1/2} e^{-\\zeta r}$, where $r = \\|\\mathbf{r}\\|$ and $\\zeta$ is the Slater exponent, with $\\phi_{\\mathrm{STO}}$ normalized in three dimensions.\n- A Gaussian-type orbital (GTO) $s$-type basis function centered at the nucleus is $g_{\\alpha}(\\mathbf{r}) = N(\\alpha)\\, e^{-\\alpha r^{2}}$, where $N(\\alpha)$ is the normalization factor, and $g_{\\alpha}$ is normalized as a function in three-dimensional space.\n- In a Linear Combination of Atomic Orbitals (LCAO) tight-binding model, the cohesive energy per atom scales with the bandwidth, which in turn scales with the nearest-neighbor hopping amplitude. Under standard approximations, the hopping amplitude is proportional to the nearest-neighbor orbital overlap. Therefore, we use a proxy cohesive energy proportional to the nearest-neighbor overlap between orbitals on adjacent sites.\n\nDefine the following mathematical objects and operations:\n- An $N$-term GTO approximation to the target STO is $\\phi_{N}(\\mathbf{r}) = \\sum_{i=1}^{N} c_{i}\\, g_{\\alpha_{i}}(\\mathbf{r})$, where the exponents $\\{\\alpha_{i}\\}_{i=1}^{N}$ are chosen on a geometric progression spanning a physically reasonable range that depends on $\\zeta$, and the coefficients $\\{c_{i}\\}_{i=1}^{N}$ are determined by minimizing the squared error $\\int_{\\mathbb{R}^{3}} \\left|\\phi_{\\mathrm{STO}}(\\mathbf{r}) - \\phi_{N}(\\mathbf{r})\\right|^{2}\\, d^{3}\\mathbf{r}$, which reduces to solving the normal equations based on inner products. After solving for $\\{c_{i}\\}$, normalize $\\phi_{N}$ so that $\\int_{\\mathbb{R}^{3}} \\left|\\phi_{N}(\\mathbf{r})\\right|^{2}\\, d^{3}\\mathbf{r} = 1$.\n- Place two identical atoms separated by a distance $R$ along one axis. Let $\\phi_{N}^{A}(\\mathbf{r})$ be centered at the origin and $\\phi_{N}^{B}(\\mathbf{r})$ be the same orbital centered at distance $R$; then the nearest-neighbor overlap is $S_{N}(R) = \\int_{\\mathbb{R}^{3}} \\phi_{N}^{A}(\\mathbf{r})\\, \\phi_{N}^{B}(\\mathbf{r})\\, d^{3}\\mathbf{r}$. For GTOs, these integrals can be evaluated exactly by known Gaussian product formulas or numerically via convergent quadrature.\n- Define the proxy cohesive energy as $E_{\\mathrm{coh}}^{(N)} = C\\, z\\, S_{N}(R)$, where $C$ is a positive energy scale in electronvolts $\\left(\\mathrm{eV}\\right)$, $z$ is the coordination number (an integer representing the number of nearest neighbors), and $R$ is the nearest-neighbor distance. This proxy is motivated by the observation that the cohesive energy scales with the bandwidth, which scales with the hopping amplitude and hence with the overlap.\n\nYour program must:\n- For each test case, construct a sequence of $N$-term GTO expansions for $N$ from $N_{\\min}$ to $N_{\\max}$, with exponents $\\alpha_{i}$ chosen on a geometric progression $\\alpha_{i} \\in [\\alpha_{\\min}, \\alpha_{\\max}]$ where $\\alpha_{\\min} = 0.3\\, \\zeta^{2}$ and $\\alpha_{\\max} = 8\\, \\zeta^{2}$. Determine coefficients by least squares in the three-dimensional $L^{2}$ sense, then renormalize the resulting expansion.\n- Compute $E_{\\mathrm{coh}}^{(N)}$ in $\\mathrm{eV}$ for each $N$ in the sequence using the overlap between orbitals on two sites separated by $R$.\n- Determine the smallest integer $N^{\\ast}$ such that $N^{\\ast} > N_{\\min}$ and $\\left|E_{\\mathrm{coh}}^{(N^{\\ast})} - E_{\\mathrm{coh}}^{(N^{\\ast}-1)}\\right| < \\tau$, where $\\tau$ is the target threshold in $\\mathrm{eV}$. If no such $N^{\\ast}$ exists within $[N_{\\min}, N_{\\max}]$, return $-1$ for that test case.\n\nImportant unit conventions and numerical requirements:\n- Distances $R$ are provided in ångströms and must be converted to Bohr radii for the integrals; use $1\\,\\mathrm{Bohr} = 0.529177\\,\\mathrm{\\AA}$.\n- Energies must be computed and compared in electronvolts $\\left(\\mathrm{eV}\\right)$.\n- Angles do not occur; there is no angle unit required.\n\nTest suite:\nUse the following four test cases, each specified as the tuple $\\left(\\zeta, R_{\\mathrm{\\AA}}, z, C, \\tau, N_{\\min}, N_{\\max}\\right)$ where $\\zeta$ is in inverse Bohr radii, $R_{\\mathrm{\\AA}}$ is in ångströms, $z$ is an integer, $C$ and $\\tau$ are in $\\mathrm{eV}$, and $N_{\\min}, N_{\\max}$ are integers.\n- Case $1$: $\\left(1.2, 2.5, 12, 0.8, 10^{-3}, 1, 8\\right)$\n- Case $2$: $\\left(3.0, 1.8, 6, 1.5, 5\\times 10^{-4}, 1, 10\\right)$\n- Case $3$: $\\left(0.8, 3.2, 8, 1.2, 10^{-5}, 1, 12\\right)$\n- Case $4$: $\\left(2.5, 2.0, 4, 1.0, 5\\times 10^{-2}, 1, 6\\right)$\n\nFinal output format specification:\n- Your program should produce a single line of output containing the four integer results $\\left[N_{1}^{\\ast}, N_{2}^{\\ast}, N_{3}^{\\ast}, N_{4}^{\\ast}\\right]$ corresponding to the four test cases, as a comma-separated list enclosed in square brackets, for example, $\\left[2,4,-1,3\\right]$.",
            "solution": "The problem requires the implementation of a convergence test for a proxy cohesive energy, which is calculated using a sequence of increasingly larger Gaussian-type orbital (GTO) basis sets that approximate a target Slater-type orbital (STO). The core of the task is to find the smallest basis set size, $N^{\\ast}$, for which the change in the cohesive energy falls below a given threshold, $\\tau$.\n\nThe fundamental starting point is the $1s$-like Slater-type orbital, defined as $\\phi_{\\mathrm{STO}}(\\mathbf{r}) = \\left(\\frac{\\zeta^{3}}{\\pi}\\right)^{1/2} e^{-\\zeta r}$, where $\\zeta$ is the Slater exponent and $r = \\|\\mathbf{r}\\|$. This function is normalized such that $\\int_{\\mathbb{R}^3} |\\phi_{\\mathrm{STO}}(\\mathbf{r})|^2 d^3\\mathbf{r} = 1$. Each STO is approximated by a linear combination of $N$ primitive $s$-type GTOs, $\\phi_{N}(\\mathbf{r}) = \\sum_{i=1}^{N} c_{i} g_{\\alpha_{i}}(\\mathbf{r})$. A primitive GTO is given by $g_{\\alpha}(\\mathbf{r}) = N(\\alpha)\\, e^{-\\alpha r^{2}}$, where the normalization constant $N(\\alpha) = (2\\alpha/\\pi)^{3/4}$ ensures $\\int_{\\mathbb{R}^3} |g_{\\alpha}(\\mathbf{r})|^2 d^3\\mathbf{r} = 1$.\n\nThe exponents $\\{\\alpha_i\\}_{i=1}^N$ of the GTO basis are chosen from a geometric progression spanning the interval $[\\alpha_{\\min}, \\alpha_{\\max}]$, where $\\alpha_{\\min} = 0.3\\,\\zeta^2$ and $\\alpha_{\\max} = 8\\,\\zeta^2$. For $N>1$, the exponents are given by $\\alpha_i = \\alpha_{\\min} \\cdot (\\alpha_{\\max}/\\alpha_{\\min})^{(i-1)/(N-1)}$. For the special case of $N=1$, a single exponent $\\alpha_1 = \\sqrt{\\alpha_{\\min}\\alpha_{\\max}}$ is used, representing the geometric mean of the bounds.\n\nThe coefficients $\\{c_i\\}_{i=1}^N$ are determined by minimizing the mean squared error between the STO and its GTO expansion, $\\epsilon^2 = \\int_{\\mathbb{R}^3} |\\phi_{\\mathrm{STO}}(\\mathbf{r}) - \\phi_{N}(\\mathbf{r})|^2 d^3\\mathbf{r}$. Setting the partial derivatives $\\partial \\epsilon^2 / \\partial c_k$ to zero for all $k=1, \\dots, N$ leads to a system of linear equations known as the normal equations:\n$$ \\sum_{i=1}^{N} c_i \\int_{\\mathbb{R}^3} g_{\\alpha_k}(\\mathbf{r}) g_{\\alpha_i}(\\mathbf{r}) d^3\\mathbf{r} = \\int_{\\mathbb{R}^3} g_{\\alpha_k}(\\mathbf{r}) \\phi_{\\mathrm{STO}}(\\mathbf{r}) d^3\\mathbf{r} $$\nThis can be written in matrix form as $\\mathbf{S}\\mathbf{c} = \\mathbf{b}$, where:\n1.  $\\mathbf{S}$ is the $N \\times N$ Gram matrix of the GTO basis functions, with elements $S_{ki} = \\langle g_k | g_i \\rangle$. This is the GTO overlap matrix. The analytical expression for the overlap of two normalized, concentric $s$-type GTOs with exponents $\\alpha_k$ and $\\alpha_i$ is $S_{ki} = \\left(\\frac{4\\alpha_k\\alpha_i}{(\\alpha_k+\\alpha_i)^2}\\right)^{3/4}$.\n2.  $\\mathbf{b}$ is an $N$-dimensional vector with elements $b_k = \\langle g_k | \\phi_{\\mathrm{STO}} \\rangle$. This is the overlap between a GTO basis function and the target STO. This integral, $b_k = \\int_0^\\infty 4\\pi r^2 g_{\\alpha_k}(r) \\phi_{\\mathrm{STO}}(r) dr$, lacks a simple closed-form expression and will be computed using high-precision numerical quadrature as permitted by the problem statement.\n3.  $\\mathbf{c}$ is the vector of coefficients to be solved for, $\\mathbf{c} = \\mathbf{S}^{-1}\\mathbf{b}$.\n\nThe resulting expansion, $\\phi'_N(\\mathbf{r}) = \\sum_i c_i g_{\\alpha_i}(\\mathbf{r})$, is not guaranteed to be normalized. We must re-normalize it to obtain $\\phi_N(\\mathbf{r})$. The squared norm is $\\langle \\phi'_N | \\phi'_N \\rangle = \\sum_{i,j} c_i c_j \\langle g_i | g_j \\rangle = \\mathbf{c}^T \\mathbf{S} \\mathbf{c}$. The normalization constant is $K = (\\mathbf{c}^T \\mathbf{S} \\mathbf{c})^{-1/2}$, and the final, normalized coefficients are $d_i = K c_i$.\n\nThe proxy for cohesive energy, $E_{\\mathrm{coh}}^{(N)}$, is defined as proportional to the overlap integral $S_N(R)$ between two identical normalized orbitals, $\\phi_N^A$ and $\\phi_N^B$, centered on adjacent atomic sites separated by a distance $R$.\n$$ S_N(R) = \\int_{\\mathbb{R}^3} \\phi_N^A(\\mathbf{r}) \\phi_N^B(\\mathbf{r}) d^3\\mathbf{r} = \\sum_{i=1}^N \\sum_{j=1}^N d_i d_j \\int_{\\mathbb{R}^3} g_{\\alpha_i}^A(\\mathbf{r}) g_{\\alpha_j}^B(\\mathbf{r}) d^3\\mathbf{r} $$\nThe integral of the product of two displaced GTOs can be calculated analytically using the Gaussian Product Theorem. The overlap of two normalized $s$-type GTOs with exponents $\\alpha_i$ and $\\alpha_j$ separated by distance $R$ is $S_{ij}^{AB}(R) = S_{ij} \\exp\\left(-\\frac{\\alpha_i \\alpha_j}{\\alpha_i+\\alpha_j}R^2\\right)$, where $S_{ij}$ is the single-center overlap. The total overlap is then $S_N(R) = \\sum_{i,j} d_i d_j S_{ij}^{AB}(R)$.\n\nThe cohesive energy proxy is then $E_{\\mathrm{coh}}^{(N)} = C z S_N(R)$, where $C$ is an energy scale in electronvolts ($\\mathrm{eV}$), $z$ is the coordination number, and $R$ is the nearest-neighbor distance. The input distance $R_{\\mathrm{\\AA}}$ in ångströms must be converted to Bohr radii using the given conversion factor $1\\,\\mathrm{Bohr} = 0.529177\\,\\mathrm{\\AA}$.\n\nThe overall algorithm proceeds as follows for each test case:\n1.  Initialize an empty list to store computed energies for each basis size $N$.\n2.  Iterate $N$ from $N_{\\min}$ to $N_{\\max}$. In each iteration, perform the steps outlined above to compute $E_{\\mathrm{coh}}^{(N)}$.\n3.  For each $N > N_{\\min}$, check the convergence criterion: $|E_{\\mathrm{coh}}^{(N)} - E_{\\mathrm{coh}}^{(N-1)}| < \\tau$.\n4.  If the criterion is met, the smallest such integer $N$ is the answer, $N^{\\ast}$. The search for that test case terminates.\n5.  If the loop completes without meeting the criterion, the answer for that case is $-1$.\nThe results for all test cases are collected and formatted into the specified output string.",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import quad\n\nBOHR_IN_A = 0.529177\n\ndef _compute_proxy_cohesive_energy(params, N):\n    \"\"\"\n    Computes the proxy cohesive energy for a given basis size N and parameter set.\n    \"\"\"\n    zeta, R_A, z, C, _, _, _ = params\n    R_bohr = R_A / BOHR_IN_A\n\n    # Step 1: Construct GTO basis exponents\n    alpha_min = 0.3 * zeta**2\n    alpha_max = 8.0 * zeta**2\n    if N == 1:\n        alphas = np.array([np.sqrt(alpha_min * alpha_max)])\n    else:\n        alphas = np.geomspace(alpha_min, alpha_max, num=N)\n\n    # Step 2: Solve the normal equations (Sc = b)\n    # 2a. GTO-GTO overlap matrix S (Gram matrix)\n    S_matrix = np.zeros((N, N))\n    for i in range(N):\n        for j in range(i, N):\n            ai, aj = alphas[i], alphas[j]\n            val = (4 * ai * aj / (ai + aj)**2)**(3/4)\n            S_matrix[i, j] = val\n            S_matrix[j, i] = val\n\n    # 2b. STO-GTO overlap vector b\n    b_vector = np.zeros(N)\n    sto_norm = (zeta**3 / np.pi)**0.5\n    for i in range(N):\n        alpha_i = alphas[i]\n        gto_norm = (2 * alpha_i / np.pi)**(0.75)\n        \n        # Integrand for numerical quadrature: 4*pi*r^2 * phi_STO(r) * g_GTO(r)\n        def integrand(r):\n            return (4 * np.pi * r**2 * \n                    (sto_norm * np.exp(-zeta * r)) * \n                    (gto_norm * np.exp(-alpha_i * r**2)))\n            \n        b_vector[i], _ = quad(integrand, 0, np.inf)\n\n    # 2c. Solve for coefficients c\n    try:\n        c_coeffs = np.linalg.solve(S_matrix, b_vector)\n    except np.linalg.LinAlgError:\n        # This should not occur as S is positive definite, but is good practice.\n        return np.nan \n\n    # Step 3: Renormalize the LCAO coefficients\n    norm_sq = c_coeffs.T @ S_matrix @ c_coeffs\n    if norm_sq <= 0: return np.nan\n    d_coeffs = c_coeffs / np.sqrt(norm_sq)\n\n    # Step 4: Compute the total two-center overlap S_N(R)\n    total_overlap_S_N_R = 0.0\n    for i in range(N):\n        for j in range(N):\n            ai, aj = alphas[i], alphas[j]\n            # Two-center overlap integral for s-type GTOs\n            exp_term = np.exp(- (ai * aj) / (ai + aj) * R_bohr**2)\n            two_center_overlap = S_matrix[i, j] * exp_term\n            total_overlap_S_N_R += d_coeffs[i] * d_coeffs[j] * two_center_overlap\n    \n    # Step 5: Compute the proxy cohesive energy\n    E_coh = C * z * total_overlap_S_N_R\n    return E_coh\n\ndef solve():\n    \"\"\"\n    Main solver function to run the convergence test for all provided cases.\n    \"\"\"\n    test_cases = [\n        # (zeta, R_Å, z, C, tau, N_min, N_max)\n        (1.2, 2.5, 12, 0.8, 1e-3, 1, 8),\n        (3.0, 1.8, 6, 1.5, 5e-4, 1, 10),\n        (0.8, 3.2, 8, 1.2, 1e-5, 1, 12),\n        (2.5, 2.0, 4, 1.0, 5e-2, 1, 6),\n    ]\n\n    results = []\n    for case in test_cases:\n        _, _, _, _, tau, N_min, N_max = case\n        \n        E_coh_prev = None\n        found_N_star = -1\n        \n        for N in range(N_min, N_max + 1):\n            E_coh_current = _compute_proxy_cohesive_energy(case, N)\n            \n            # The convergence check starts from N = N_min + 1\n            if N > N_min:\n                if E_coh_prev is None: # Should not happen if N > N_min\n                     break\n                diff = np.abs(E_coh_current - E_coh_prev)\n                if diff < tau:\n                    found_N_star = N\n                    break\n            \n            E_coh_prev = E_coh_current\n            \n        results.append(found_N_star)\n        \n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}