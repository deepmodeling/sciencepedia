{
    "hands_on_practices": [
        {
            "introduction": "Our first exercise grounds the theoretical differences between Slater-type orbitals (STOs) and Gaussian-type orbitals (GTOs) in a practical calculation of the overlap integral, $S = \\int \\chi_a^*(\\mathbf{r}) \\chi_b(\\mathbf{r}) d\\mathbf{r}$. This quantity, a fundamental building block in LCAO theory, quantifies the spatial interaction between orbitals. By deriving the analytical solution for GTOs and contrasting it with the numerical approach required for STOs , you will gain a first-hand appreciation for the computational advantages that have made Gaussian-type orbitals dominant in the field.",
            "id": "3821264",
            "problem": "Consider localized basis sets used in multiscale materials simulation, specifically $s$-type Gaussian-type orbitals (GTOs) and $s$-type Slater-type orbitals (STOs). An $s$-type GTO centered at a position vector $\\mathbf{A} \\in \\mathbb{R}^3$ is defined by the function $\\chi(\\mathbf{r}) = N \\exp\\!\\left(-\\alpha \\lvert \\mathbf{r} - \\mathbf{A}\\rvert^2\\right)$, where $\\alpha > 0$ is the Gaussian exponent and $N$ is a normalization factor chosen so that $\\int_{\\mathbb{R}^3} \\lvert \\chi(\\mathbf{r})\\rvert^2 \\, d\\mathbf{r} = 1$. An $s$-type STO centered at $\\mathbf{A}$ is defined by $\\chi(\\mathbf{r}) = N \\exp\\!\\left(-\\zeta \\lvert \\mathbf{r} - \\mathbf{A}\\rvert\\right)$, where $\\zeta > 0$ is the Slater exponent and $N$ is chosen so that $\\int_{\\mathbb{R}^3} \\lvert \\chi(\\mathbf{r})\\rvert^2 \\, d\\mathbf{r} = 1$. All quantities are to be treated in atomic units, where distances are measured in bohr, and the final overlap integrals are dimensionless.\n\nStarting from these definitions and using only fundamental mathematical operations, derive the analytic expression for the overlap integral\n$$\nS_{\\mathrm{GTO}} = \\int_{\\mathbb{R}^3} \\chi_a(\\mathbf{r}) \\, \\chi_b(\\mathbf{r}) \\, d\\mathbf{r}\n$$\nbetween two normalized $s$-type GTOs centered at $\\mathbf{A}$ and $\\mathbf{B}$ with exponents $\\alpha_a$ and $\\alpha_b$. Your derivation must begin from the stated definitions, the condition of normalization, and first principles such as completing the square, and must not invoke any pre-derived shortcut formulas.\n\nThen, for the STO case, set up the corresponding overlap integral\n$$\nS_{\\mathrm{STO}} = \\int_{\\mathbb{R}^3} \\chi_a(\\mathbf{r}) \\, \\chi_b(\\mathbf{r}) \\, d\\mathbf{r}\n$$\nbetween two normalized $s$-type STOs centered at $\\mathbf{A}$ and $\\mathbf{B}$ with exponents $\\zeta_a$ and $\\zeta_b$. Use a mathematically sound numerical quadrature scheme to evaluate $S_{\\mathrm{STO}}$ to high accuracy. To ensure universality and reproducibility, perform the angular integration using Gaussâ€“Legendre quadrature on the variable $u = \\cos\\theta$ over $[-1,1]$, and perform the radial integration over $[0,\\infty)$ using a robust one-dimensional quadrature. Explicitly state any change of variables and justify convergence. The program must compute $S_{\\mathrm{GTO}}$ analytically and $S_{\\mathrm{STO}}$ numerically for each test case below.\n\nUse the following test suite, where $\\mathbf{A}$ and $\\mathbf{B}$ are given in bohr, and exponents are in appropriate atomic units:\n- Test case $1$ (coincident centers, identical exponents): $\\mathbf{A} = [\\,0,0,0\\,]$, $\\mathbf{B} = [\\,0,0,0\\,]$, $\\alpha_a = \\alpha_b = 0.7$, $\\zeta_a = \\zeta_b = 1.3$.\n- Test case $2$ (moderate separation, identical exponents): $\\mathbf{A} = [\\,0,0,0\\,]$, $\\mathbf{B} = [\\,1.0,0,0\\,]$, $\\alpha_a = \\alpha_b = 0.7$, $\\zeta_a = \\zeta_b = 1.3$.\n- Test case $3$ (large separation, identical exponents): $\\mathbf{A} = [\\,0,0,0\\,]$, $\\mathbf{B} = [\\,5.0,0,0\\,]$, $\\alpha_a = \\alpha_b = 0.7$, $\\zeta_a = \\zeta_b = 1.3$.\n- Test case $4$ (moderate separation, different exponents): $\\mathbf{A} = [\\,0,0,0\\,]$, $\\mathbf{B} = [\\,1.5,0,0\\,]$, $\\alpha_a = 0.5$, $\\alpha_b = 1.2$, $\\zeta_a = 1.0$, $\\zeta_b = 2.0$.\n\nYour program must:\n- Compute $S_{\\mathrm{GTO}}$ analytically using your derived expression.\n- Compute $S_{\\mathrm{STO}}$ numerically using the specified quadrature approach, ensuring absolute and relative integration tolerances are chosen to achieve results accurate to at least $10^{-8}$ in absolute error.\n- For each test case, return the pair $\\left[S_{\\mathrm{GTO}}, S_{\\mathrm{STO}}\\right]$.\n\nFinal output format: Your program should produce a single line of output containing the results for the four test cases as a comma-separated list of four lists, each inner list containing two floating-point numbers rounded to $8$ digits after the decimal point, enclosed in square brackets, for example, $\\left[ [\\,0.12345678,0.23456789\\,], [\\,\\cdots\\,], [\\,\\cdots\\,], [\\,\\cdots\\,] \\right]$. No units appear in the output.",
            "solution": "The solution is presented in two parts. First, we derive the analytical expression for the overlap integral between two $s$-type Gaussian-type orbitals (GTOs). Second, we set up the corresponding overlap integral for Slater-type orbitals (STOs) for numerical evaluation, as stipulated by the problem.\n\n### Part 1: Analytical Overlap Integral for $s$-type GTOs\n\nAn unnormalized $s$-type GTO centered at a position vector $\\mathbf{A} \\in \\mathbb{R}^3$ with exponent $\\alpha > 0$ is given by $\\phi(\\mathbf{r}) = \\exp(-\\alpha |\\mathbf{r} - \\mathbf{A}|^2)$. The normalized orbital is $\\chi(\\mathbf{r}) = N \\phi(\\mathbf{r})$, where the normalization constant $N$ is determined by the condition $\\int_{\\mathbb{R}^3} |\\chi(\\mathbf{r})|^2 \\, d\\mathbf{r} = 1$.\n\n**1.1. GTO Normalization Constant**\n\nThe normalization integral is:\n$$\n\\int_{\\mathbb{R}^3} N^2 \\exp(-2\\alpha |\\mathbf{r} - \\mathbf{A}|^2) \\, d\\mathbf{r} = 1\n$$\nBy shifting the origin of the coordinate system, $\\mathbf{r}' = \\mathbf{r} - \\mathbf{A}$, this becomes:\n$$\nN^2 \\int_{\\mathbb{R}^3} \\exp(-2\\alpha |\\mathbf{r}'|^2) \\, d\\mathbf{r}' = 1\n$$\nThe integral is separable in Cartesian coordinates $(x', y', z')$. Using the standard Gaussian integral formula $\\int_{-\\infty}^{\\infty} e^{-ax^2} dx = \\sqrt{\\pi/a}$, we have:\n$$\n\\int_{\\mathbb{R}^3} e^{-2\\alpha(x'^2+y'^2+z'^2)} dx'dy'dz' = \\left( \\int_{-\\infty}^{\\infty} e^{-2\\alpha u^2} du \\right)^3 = \\left(\\sqrt{\\frac{\\pi}{2\\alpha}}\\right)^3 = \\left(\\frac{\\pi}{2\\alpha}\\right)^{3/2}\n$$\nThe normalization condition becomes $N^2 (\\frac{\\pi}{2\\alpha})^{3/2} = 1$, which gives the normalization constant:\n$$\nN = \\left(\\frac{2\\alpha}{\\pi}\\right)^{3/4}\n$$\n\n**1.2. GTO Overlap Integral Derivation**\n\nWe seek to evaluate the overlap integral $S_{\\mathrm{GTO}} = \\int_{\\mathbb{R}^3} \\chi_a(\\mathbf{r}) \\chi_b(\\mathbf{r}) \\, d\\mathbf{r}$ between two normalized $s$-type GTOs, $\\chi_a$ and $\\chi_b$, centered at $\\mathbf{A}$ and $\\mathbf{B}$ with exponents $\\alpha_a$ and $\\alpha_b$, respectively.\n$$\n\\chi_a(\\mathbf{r}) = \\left(\\frac{2\\alpha_a}{\\pi}\\right)^{3/4} \\exp(-\\alpha_a |\\mathbf{r} - \\mathbf{A}|^2) \\\\\n\\chi_b(\\mathbf{r}) = \\left(\\frac{2\\alpha_b}{\\pi}\\right)^{3/4} \\exp(-\\alpha_b |\\mathbf{r} - \\mathbf{B}|^2)\n$$\nThe overlap integral is:\n$$\nS_{\\mathrm{GTO}} = \\left(\\frac{2\\alpha_a}{\\pi}\\right)^{3/4} \\left(\\frac{2\\alpha_b}{\\pi}\\right)^{3/4} \\int_{\\mathbb{R}^3} \\exp(-\\alpha_a |\\mathbf{r} - \\mathbf{A}|^2 - \\alpha_b |\\mathbf{r} - \\mathbf{B}|^2) \\, d\\mathbf{r}\n$$\nThe product of two Gaussians is another Gaussian, a property known as the Gaussian Product Theorem. To show this, we combine the terms in the exponent by completing the square. The exponent is:\n$$\nE = -\\alpha_a (\\mathbf{r}^2 - 2\\mathbf{r}\\cdot\\mathbf{A} + \\mathbf{A}^2) - \\alpha_b (\\mathbf{r}^2 - 2\\mathbf{r}\\cdot\\mathbf{B} + \\mathbf{B}^2) \\\\\n= -(\\alpha_a + \\alpha_b)\\mathbf{r}^2 + 2(\\alpha_a\\mathbf{A} + \\alpha_b\\mathbf{B})\\cdot\\mathbf{r} - (\\alpha_a\\mathbf{A}^2 + \\alpha_b\\mathbf{B}^2)\n$$\nLet $\\alpha_p = \\alpha_a + \\alpha_b$ and define a new center $\\mathbf{P} = \\frac{\\alpha_a\\mathbf{A} + \\alpha_b\\mathbf{B}}{\\alpha_p}$. We can rewrite the exponent in the form $-\\alpha_p|\\mathbf{r} - \\mathbf{P}|^2 + K$:\n$$\n-\\alpha_p|\\mathbf{r} - \\mathbf{P}|^2 = -\\alpha_p(\\mathbf{r}^2 - 2\\mathbf{r}\\cdot\\mathbf{P} + \\mathbf{P}^2) = -(\\alpha_a+\\alpha_b)\\mathbf{r}^2 + 2(\\alpha_a\\mathbf{A}+\\alpha_b\\mathbf{B})\\cdot\\mathbf{r} - \\alpha_p\\mathbf{P}^2\n$$\nComparing with the expression for $E$, we see that the terms dependent on $\\mathbf{r}$ match perfectly. The constant term $K$ is:\n$$\nK = \\alpha_p\\mathbf{P}^2 - (\\alpha_a\\mathbf{A}^2 + \\alpha_b\\mathbf{B}^2) = \\frac{(\\alpha_a\\mathbf{A} + \\alpha_b\\mathbf{B})^2}{\\alpha_a+\\alpha_b} - (\\alpha_a\\mathbf{A}^2 + \\alpha_b\\mathbf{B}^2)\n$$\nExpanding and simplifying this expression yields:\n$$\nK = -\\frac{\\alpha_a\\alpha_b}{\\alpha_a+\\alpha_b} (\\mathbf{A}^2 - 2\\mathbf{A}\\cdot\\mathbf{B} + \\mathbf{B}^2) = -\\frac{\\alpha_a\\alpha_b}{\\alpha_a+\\alpha_b} |\\mathbf{A}-\\mathbf{B}|^2\n$$\nThe integral becomes:\n$$\n\\int_{\\mathbb{R}^3} \\exp(-\\alpha_p |\\mathbf{r} - \\mathbf{P}|^2) \\exp(K) \\, d\\mathbf{r} = \\exp(K) \\int_{\\mathbb{R}^3} \\exp(-\\alpha_p |\\mathbf{r} - \\mathbf{P}|^2) \\, d\\mathbf{r}\n$$\nThe integral is a standard Gaussian integral, which evaluates to $(\\pi/\\alpha_p)^{3/2} = (\\pi/(\\alpha_a+\\alpha_b))^{3/2}$.\nCombining all terms for $S_{\\mathrm{GTO}}$:\n$$\nS_{\\mathrm{GTO}} = \\left(\\frac{4\\alpha_a\\alpha_b}{\\pi^2}\\right)^{3/4} \\left(\\frac{\\pi}{\\alpha_a+\\alpha_b}\\right)^{3/2} \\exp\\left(-\\frac{\\alpha_a\\alpha_b}{\\alpha_a+\\alpha_b} |\\mathbf{A}-\\mathbf{B}|^2\\right)\n$$\nSimplifying the pre-factors:\n$$\n\\left(\\frac{(4\\alpha_a\\alpha_b)^{3/4}}{(\\pi^2)^{3/4}}\\right) \\left(\\frac{\\pi^{3/2}}{(\\alpha_a+\\alpha_b)^{3/2}}\\right) = \\frac{(4\\alpha_a\\alpha_b)^{3/4}}{\\pi^{3/2}} \\frac{\\pi^{3/2}}{(\\alpha_a+\\alpha_b)^{3/2}} = \\left(\\frac{4\\alpha_a\\alpha_b}{(\\alpha_a+\\alpha_b)^2}\\right)^{3/4}\n$$\nThe final analytical expression for the overlap integral is:\n$$\nS_{\\mathrm{GTO}} = \\left(\\frac{4\\alpha_a\\alpha_b}{(\\alpha_a+\\alpha_b)^2}\\right)^{3/4} \\exp\\left(-\\frac{\\alpha_a\\alpha_b}{\\alpha_a+\\alpha_b} |\\mathbf{A}-\\mathbf{B}|^2\\right)\n$$\n\n### Part 2: Numerical Overlap Integral for $s$-type STOs\n\nAn unnormalized $s$-type STO centered at $\\mathbf{A}$ with exponent $\\zeta > 0$ is $\\phi(\\mathbf{r}) = \\exp(-\\zeta|\\mathbf{r}-\\mathbf{A}|)$.\n\n**2.1. STO Normalization Constant**\n\nThe normalization integral $\\int_{\\mathbb{R}^3} N^2 \\exp(-2\\zeta |\\mathbf{r} - \\mathbf{A}|) \\, d\\mathbf{r} = 1$ is best evaluated in spherical polar coordinates centered at $\\mathbf{A}$. Let $\\mathbf{r}' = \\mathbf{r} - \\mathbf{A}$.\n$$\nN^2 \\int_0^{2\\pi}d\\phi \\int_0^\\pi \\sin\\theta d\\theta \\int_0^\\infty r'^2 e^{-2\\zeta r'} dr' = 1\n$$\nThe angular integrals yield $4\\pi$. The radial integral is a Gamma function, $\\int_0^\\infty x^n e^{-ax} dx = n!/a^{n+1}$. For $n=2$ and $a=2\\zeta$, the integral is $2!/(2\\zeta)^3 = 2/(8\\zeta^3) = 1/(4\\zeta^3)$.\nThe condition becomes $N^2 (4\\pi) (1/(4\\zeta^3)) = N^2 \\pi/\\zeta^3 = 1$, giving the normalization constant:\n$$\nN = \\sqrt{\\frac{\\zeta^3}{\\pi}}\n$$\n\n**2.2. STO Overlap Integral Numerical Setup**\n\nThe overlap integral $S_{\\mathrm{STO}}$ between two normalized STOs centered at $\\mathbf{A}$ and $\\mathbf{B}$ with exponents $\\zeta_a$ and $\\zeta_b$ is:\n$$\nS_{\\mathrm{STO}} = \\frac{\\sqrt{\\zeta_a^3\\zeta_b^3}}{\\pi} \\int_{\\mathbb{R}^3} \\exp(-\\zeta_a |\\mathbf{r}-\\mathbf{A}| - \\zeta_b |\\mathbf{r}-\\mathbf{B}|) \\, d\\mathbf{r}\n$$\nThe value of this integral is invariant under rigid translation and rotation of the coordinate system. We can simplify the setup by placing $\\mathbf{A}$ at the origin $(0,0,0)$ and $\\mathbf{B}$ on the $z$-axis at $(0,0,R)$, where $R=|\\mathbf{A}-\\mathbf{B}|$. The distances become $r_a = |\\mathbf{r}-\\mathbf{A}| = r$ and $r_b = |\\mathbf{r}-\\mathbf{B}| = \\sqrt{r^2+R^2-2rR\\cos\\theta}$, where $(r, \\theta, \\phi)$ are the spherical coordinates of $\\mathbf{r}$.\nThe integral in these coordinates is:\n$$\nS_{\\mathrm{STO}} = \\frac{\\sqrt{\\zeta_a^3\\zeta_b^3}}{\\pi} \\int_0^{2\\pi}d\\phi \\int_0^\\pi d\\theta \\int_0^\\infty dr \\left[ r^2 \\sin\\theta \\exp(-\\zeta_a r - \\zeta_b \\sqrt{r^2+R^2-2rR\\cos\\theta}) \\right]\n$$\nThe integrand is independent of $\\phi$, so integration over $\\phi$ yields a factor of $2\\pi$.\n$$\nS_{\\mathrm{STO}} = 2\\sqrt{\\zeta_a^3\\zeta_b^3} \\int_0^\\pi \\sin\\theta \\int_0^\\infty r^2 \\exp(-\\zeta_a r - \\zeta_b \\sqrt{r^2+R^2-2rR\\cos\\theta}) \\, dr \\, d\\theta\n$$\nAs specified, we perform a change of variables for the angular integral: $u = \\cos\\theta$, so $du = -\\sin\\theta d\\theta$. The integration limits change from $[\\,0, \\pi\\,]$ to $[\\,1, -1\\,]$, which is equivalent to integrating from $-1$ to $1$.\n$$\nS_{\\mathrm{STO}} = 2\\sqrt{\\zeta_a^3\\zeta_b^3} \\int_{-1}^{1} \\left( \\int_0^{\\infty} r^2 \\exp(-\\zeta_a r - \\zeta_b \\sqrt{r^2+R^2-2rRu}) \\, dr \\right) du\n$$\nThis two-dimensional integral is solved numerically. The outer integral over $u \\in [-1,1]$ is approximated using Gauss-Legendre quadrature:\n$$\n\\int_{-1}^{1} f(u) du \\approx \\sum_{i=1}^{N_u} w_i f(u_i)\n$$\nwhere $u_i$ and $w_i$ are the quadrature nodes and weights. The inner function $f(u_i)$ corresponds to the one-dimensional radial integral:\n$$\nf(u_i) = \\int_0^{\\infty} r^2 \\exp(-\\zeta_a r - \\zeta_b \\sqrt{r^2+R^2-2rRu_i}) \\, dr\n$$\nThis integral over the semi-infinite domain $[0, \\infty)$ is evaluated using a robust adaptive quadrature routine, such as `scipy.integrate.quad`.\n\nThe convergence of this numerical scheme is well-founded. For any fixed $r > 0$, the integrand is a very smooth function of $u$ over $[-1, 1]$, which ensures rapid convergence of Gauss-Legendre quadrature with an increasing number of points $N_u$. For the radial integral, the integrand decays exponentially as $r \\to \\infty$, ensuring the integral is finite and readily handled by adaptive quadrature algorithms designed for such problems. The required accuracy of $10^{-8}$ can be achieved by selecting a sufficiently large $N_u$ and setting appropriately small tolerance parameters for the inner quadrature.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\nfrom scipy.special import roots_legendre\n\ndef solve():\n    \"\"\"\n    Main function to compute and print GTO and STO overlap integrals for given test cases.\n    \"\"\"\n    \n    # Test cases defined in the problem statement\n    # Format: (A, B, alpha_a, alpha_b, zeta_a, zeta_b)\n    test_cases = [\n        ([0.0, 0.0, 0.0], [0.0, 0.0, 0.0], 0.7, 0.7, 1.3, 1.3),\n        ([0.0, 0.0, 0.0], [1.0, 0.0, 0.0], 0.7, 0.7, 1.3, 1.3),\n        ([0.0, 0.0, 0.0], [5.0, 0.0, 0.0], 0.7, 0.7, 1.3, 1.3),\n        ([0.0, 0.0, 0.0], [1.5, 0.0, 0.0], 0.5, 1.2, 1.0, 2.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        A_vec, B_vec, alpha_a, alpha_b, zeta_a, zeta_b = case\n        A, B = np.array(A_vec), np.array(B_vec)\n\n        s_gto = compute_gto_overlap(alpha_a, alpha_b, A, B)\n        s_sto = compute_sto_overlap(zeta_a, zeta_b, A, B)\n\n        results.append([s_gto, s_sto])\n\n    # Format the final output string as specified\n    inner_parts = []\n    for r_gto, r_sto in results:\n        inner_parts.append(f\"[{r_gto:.8f}, {r_sto:.8f}]\")\n    output_string = \"[\" + \", \".join(inner_parts) + \"]\"\n    print(output_string)\n\n\ndef compute_gto_overlap(alpha_a: float, alpha_b: float, A: np.ndarray, B: np.ndarray) -> float:\n    \"\"\"\n    Computes the overlap integral between two s-type GTOs analytically.\n    \n    Args:\n        alpha_a: Exponent of GTO at center A.\n        alpha_b: Exponent of GTO at center B.\n        A: Position vector of center A.\n        B: Position vector of center B.\n\n    Returns:\n        The value of the overlap integral S_GTO.\n    \"\"\"\n    R_sq = np.sum((A - B)**2)\n    alpha_p = alpha_a + alpha_b\n    \n    prefactor_term = (4 * alpha_a * alpha_b) / (alpha_p**2)\n    prefactor = prefactor_term**(3.0 / 4.0)\n    \n    exponent_term = (alpha_a * alpha_b) / alpha_p\n    exponent = np.exp(-exponent_term * R_sq)\n    \n    return prefactor * exponent\n\n\ndef compute_sto_overlap(zeta_a: float, zeta_b: float, A: np.ndarray, B: np.ndarray) -> float:\n    \"\"\"\n    Computes the overlap integral between two s-type STOs numerically.\n    \n    The numerical integration is done using Gauss-Legendre quadrature for the\n    angular part and scipy.integrate.quad for the radial part.\n\n    Args:\n        zeta_a: Exponent of STO at center A.\n        zeta_b: Exponent of STO at center B.\n        A: Position vector of center A.\n        B: Position vector of center B.\n\n    Returns:\n        The value of the overlap integral S_STO.\n    \"\"\"\n    R = np.linalg.norm(A - B)\n\n    # Coincident centers case: use analytical formula for speed and stability\n    if np.isclose(R, 0.0):\n        if np.isclose(zeta_a, zeta_b):\n            return 1.0\n        return 8.0 * ((zeta_a * zeta_b)**0.5 / (zeta_a + zeta_b))**3.0\n\n    # Numerical integration for separated centers\n    prefactor = 2.0 * (zeta_a**3 * zeta_b**3)**0.5\n\n    # Number of points for Gauss-Legendre quadrature.\n    # 64 points is sufficient for high accuracy for these smooth integrands.\n    N_u = 64\n    u_nodes, u_weights = roots_legendre(N_u)\n\n    # Integration tolerances for the inner radial integral\n    quad_epsabs = 1e-12\n    quad_epsrel = 1e-12\n\n    angular_integral_sum = 0.0\n    for i in range(N_u):\n        u = u_nodes[i]\n        w = u_weights[i]\n\n        # Define the radial integrand for the current angular node u\n        def radial_integrand(r):\n            sqrt_arg = r**2 + R**2 - 2 * r * R * u\n            # The argument to sqrt is always non-negative for r>=0, u in [-1,1]\n            # It is (r-R)^2 at u=1 and (r+R)^2 at u=-1.\n            r_b = np.sqrt(sqrt_arg)\n            return r**2 * np.exp(-zeta_a * r - zeta_b * r_b)\n\n        # Compute the radial integral for this u\n        radial_integral_val, _ = integrate.quad(\n            radial_integrand, 0, np.inf, \n            epsabs=quad_epsabs, epsrel=quad_epsrel\n        )\n        \n        angular_integral_sum += w * radial_integral_val\n\n    return prefactor * angular_integral_sum\n\n# Execute the solution\nsolve()\n\n```"
        },
        {
            "introduction": "We now advance from one-electron to two-electron integrals, which lie at the heart of electronic structure theory and represent the main computational bottleneck. This practice focuses on evaluating a canonical $(ss|ss)$ electron repulsion integral (ERI) for a GTO basis . By successfully reducing this complex six-dimensional integral to a simple analytical expression, you will understand the profound computational simplification that GTOs provide, justifying their central role in modern materials simulation.",
            "id": "3821317",
            "problem": "Consider two normalized primitive $s$-type Gaussian-type orbitals (GTOs) centered at positions $\\mathbf{A}$ and $\\mathbf{B}$ in three-dimensional space, defined by $\\phi_{\\mathbf{A}}(\\mathbf{r}) = N(\\alpha) \\exp\\!\\big(-\\alpha |\\mathbf{r}-\\mathbf{A}|^{2}\\big)$ and $\\phi_{\\mathbf{B}}(\\mathbf{r}) = N(\\alpha) \\exp\\!\\big(-\\alpha |\\mathbf{r}-\\mathbf{B}|^{2}\\big)$, where the normalization factor is $N(\\alpha) = \\left(\\frac{2\\alpha}{\\pi}\\right)^{3/4}$. Place the centers on the $x$-axis as $\\mathbf{A}=(0,0,0)$ and $\\mathbf{B}=(R,0,0)$ with $R>0$, and take a common Gaussian exponent $\\alpha>0$. The Electron Repulsion Integral (ERI) for the $(ss|ss)$ case over these two centers is defined by\n$$\n(\\!s_{\\mathbf{A}} s_{\\mathbf{B}} \\mid s_{\\mathbf{A}} s_{\\mathbf{B}}\\!) \\;=\\; \\iint \\phi_{\\mathbf{A}}(\\mathbf{r}_{1})\\,\\phi_{\\mathbf{B}}(\\mathbf{r}_{1})\\,\\frac{1}{|\\mathbf{r}_{1}-\\mathbf{r}_{2}|}\\,\\phi_{\\mathbf{A}}(\\mathbf{r}_{2})\\,\\phi_{\\mathbf{B}}(\\mathbf{r}_{2}) \\, d^{3}\\mathbf{r}_{1}\\, d^{3}\\mathbf{r}_{2}.\n$$\nStarting from the Coulomb operator $1/|\\mathbf{r}_{1}-\\mathbf{r}_{2}|$, the Gaussian product theorem, and the definition of the Boys function, derive a closed-form expression for $(\\!s_{\\mathbf{A}} s_{\\mathbf{B}} \\mid s_{\\mathbf{A}} s_{\\mathbf{B}}\\!)$ specialized to the case of equal exponents and the geometry above. Then evaluate this ERI numerically for the parameters $\\alpha = 1.0 \\ \\mathrm{bohr}^{-2}$ and $R = 1.0 \\ \\mathrm{bohr}$. Use the high-precision reference value $I_{\\mathrm{ref}} = 0.415107497420595$ for the ERI in Hartree (atomic units of energy) to verify numerical accuracy.\n\nAnswer specification:\n- Compute the ERI and round its numerical value to six significant figures. Express this value in Hartree.\n- Compute the absolute error $E = |I_{\\text{rounded}} - I_{\\mathrm{ref}}|$ and round it to six significant figures. Express $E$ in Hartree.\n- Present your final answer as a row matrix containing two entries: the rounded ERI value and the rounded absolute error.",
            "solution": "The problem is to evaluate the electron repulsion integral (ERI) for two identical pairs of $s$-type Gaussian-type orbitals (GTOs). The integral is given by:\n$$\nI = (\\!s_{\\mathbf{A}} s_{\\mathbf{B}} \\mid s_{\\mathbf{A}} s_{\\mathbf{B}}\\!) = \\iint \\phi_{\\mathbf{A}}(\\mathbf{r}_{1})\\,\\phi_{\\mathbf{B}}(\\mathbf{r}_{1})\\,\\frac{1}{|\\mathbf{r}_{1}-\\mathbf{r}_{2}|}\\,\\phi_{\\mathbf{A}}(\\mathbf{r}_{2})\\,\\phi_{\\mathbf{B}}(\\mathbf{r}_{2}) \\, d^{3}\\mathbf{r}_{1}\\, d^{3}\\mathbf{r}_{2}\n$$\nThe integral can be rewritten by defining a product charge distribution, $\\Omega(\\mathbf{r}) = \\phi_{\\mathbf{A}}(\\mathbf{r})\\,\\phi_{\\mathbf{B}}(\\mathbf{r})$. With this definition, the ERI becomes:\n$$\nI = \\iint \\Omega(\\mathbf{r}_{1}) \\frac{1}{|\\mathbf{r}_{1}-\\mathbf{r}_{2}|} \\Omega(\\mathbf{r}_{2}) \\, d^{3}\\mathbf{r}_{1}\\, d^{3}\\mathbf{r}_{2}\n$$\nThis is the electrostatic self-repulsion energy of the charge distribution $\\Omega(\\mathbf{r})$.\n\nFirst, we apply the Gaussian Product Theorem (GPT) to the product of two GTOs. The product of two GTOs centered at $\\mathbf{A}$ and $\\mathbf{B}$ with exponents $\\alpha_{A}$ and $\\alpha_{B}$ is a new Gaussian centered at a point $\\mathbf{P}$:\n$$\n\\exp(-\\alpha_{A}|\\mathbf{r}-\\mathbf{A}|^2) \\exp(-\\alpha_{B}|\\mathbf{r}-\\mathbf{B}|^2) = \\exp\\left(-\\frac{\\alpha_A \\alpha_B}{\\alpha_A+\\alpha_B}|\\mathbf{A}-\\mathbf{B}|^2\\right) \\exp\\left(-(\\alpha_A+\\alpha_B)|\\mathbf{r}-\\mathbf{P}|^2\\right)\n$$\nwhere $\\mathbf{P} = \\frac{\\alpha_A \\mathbf{A} + \\alpha_B \\mathbf{B}}{\\alpha_A+\\alpha_B}$.\n\nIn our specific case, the exponents are equal, $\\alpha_A = \\alpha_B = \\alpha$. The new exponent is $p = \\alpha+\\alpha = 2\\alpha$, and the new center is $\\mathbf{P} = \\frac{\\alpha\\mathbf{A}+\\alpha\\mathbf{B}}{2\\alpha} = \\frac{\\mathbf{A}+\\mathbf{B}}{2}$. With $\\mathbf{A}=(0,0,0)$ and $\\mathbf{B}=(R,0,0)$, we have $\\mathbf{P} = (\\frac{R}{2}, 0, 0)$. Also, $|\\mathbf{A}-\\mathbf{B}|^2 = R^2$.\n\nThe charge distribution $\\Omega(\\mathbf{r})$ is:\n$$\n\\Omega(\\mathbf{r}) = \\phi_{\\mathbf{A}}(\\mathbf{r})\\,\\phi_{\\mathbf{B}}(\\mathbf{r}) = N(\\alpha)^2 \\exp(-\\alpha|\\mathbf{r}-\\mathbf{A}|^2) \\exp(-\\alpha|\\mathbf{r}-\\mathbf{B}|^2)\n$$\n$$\n\\Omega(\\mathbf{r}) = N(\\alpha)^2 \\exp\\left(-\\frac{\\alpha^2}{2\\alpha}R^2\\right) \\exp(-2\\alpha|\\mathbf{r}-\\mathbf{P}|^2) = N(\\alpha)^2 \\exp\\left(-\\frac{\\alpha R^2}{2}\\right) \\exp(-2\\alpha|\\mathbf{r}-\\mathbf{P}|^2)\n$$\nLet's define a constant $K = N(\\alpha)^2 \\exp\\left(-\\frac{\\alpha R^2}{2}\\right)$. The charge distribution is $\\Omega(\\mathbf{r}) = K \\exp(-p|\\mathbf{r}-\\mathbf{P}|^2)$ with $p=2\\alpha$.\n\nThe ERI is the self-repulsion of this Gaussian charge distribution. The general formula for the repulsion integral between two s-type Gaussian charge distributions, $\\rho_1(\\mathbf{r}) = \\exp(-p_1|\\mathbf{r}-\\mathbf{P}_1|^2)$ and $\\rho_2(\\mathbf{r}) = \\exp(-p_2|\\mathbf{r}-\\mathbf{P}_2|^2)$, is:\n$$\n\\iint \\rho_1(\\mathbf{r}_1) \\frac{1}{|\\mathbf{r}_1-\\mathbf{r}_2|} \\rho_2(\\mathbf{r}_2) \\, d^3\\mathbf{r}_1 d^3\\mathbf{r}_2 = \\frac{2\\pi^{5/2}}{p_1 p_2 \\sqrt{p_1+p_2}} F_0\\left(\\frac{p_1 p_2}{p_1+p_2}|\\mathbf{P}_1-\\mathbf{P}_2|^2\\right)\n$$\nwhere $F_0(T)$ is the Boys function of order zero, defined as $F_0(T) = \\int_0^1 \\exp(-Tu^2) du$.\n\nIn our problem, the two charge distributions are identical, so $\\rho_1 = \\rho_2 = \\Omega$, but without the pre-factor $K$.\nThe parameters are $p_1=p_2=p=2\\alpha$ and $\\mathbf{P}_1=\\mathbf{P}_2=\\mathbf{P}$.\nThe argument of the Boys function is $T = \\frac{p \\cdot p}{p+p}|\\mathbf{P}-\\mathbf{P}|^2 = 0$.\nThe Boys function at $T=0$ is $F_0(0) = \\int_0^1 \\exp(0) du = \\int_0^1 1 du = 1$.\n\nThe integral part becomes:\n$$\n\\frac{2\\pi^{5/2}}{p \\cdot p \\sqrt{p+p}} F_0(0) = \\frac{2\\pi^{5/2}}{(2\\alpha)(2\\alpha)\\sqrt{2\\alpha+2\\alpha}} \\cdot 1 = \\frac{2\\pi^{5/2}}{4\\alpha^2\\sqrt{4\\alpha}} = \\frac{2\\pi^{5/2}}{4\\alpha^2(2\\sqrt{\\alpha})} = \\frac{\\pi^{5/2}}{4\\alpha^{5/2}}\n$$\nThe total ERI is this value multiplied by the square of the pre-factor $K$:\n$$\nI = K^2 \\cdot \\frac{\\pi^{5/2}}{4\\alpha^{5/2}} = \\left[N(\\alpha)^2 \\exp\\left(-\\frac{\\alpha R^2}{2}\\right)\\right]^2 \\frac{\\pi^{5/2}}{4\\alpha^{5/2}}\n$$\nSubstitute $N(\\alpha) = \\left(\\frac{2\\alpha}{\\pi}\\right)^{3/4}$, so $N(\\alpha)^4 = \\left(\\frac{2\\alpha}{\\pi}\\right)^3$.\n$$\nI = \\left(\\frac{2\\alpha}{\\pi}\\right)^3 \\exp\\left(-\\alpha R^2\\right) \\frac{\\pi^{5/2}}{4\\alpha^{5/2}}\n$$\n$$\nI = \\frac{8\\alpha^3}{\\pi^3} \\exp\\left(-\\alpha R^2\\right) \\frac{\\pi^{5/2}}{4\\alpha^{5/2}}\n$$\n$$\nI = 2 \\frac{\\alpha^{3 - 5/2}}{\\pi^{3-5/2}} \\exp\\left(-\\alpha R^2\\right) = 2 \\frac{\\alpha^{1/2}}{\\pi^{1/2}} \\exp\\left(-\\alpha R^2\\right)\n$$\nThe final closed-form expression for the ERI is:\n$$\nI = 2 \\sqrt{\\frac{\\alpha}{\\pi}} \\exp\\left(-\\alpha R^2\\right)\n$$\n\nNow, we evaluate this expression for the given parameters $\\alpha = 1.0 \\ \\mathrm{bohr}^{-2}$ and $R = 1.0 \\ \\mathrm{bohr}$. In atomic units, these values are $\\alpha=1.0$ and $R=1.0$. The result will be in Hartree.\n$$\nI = 2 \\sqrt{\\frac{1.0}{\\pi}} \\exp\\left(-1.0 \\cdot (1.0)^2\\right) = \\frac{2}{\\sqrt{\\pi}} \\exp(-1) = \\frac{2}{e\\sqrt{\\pi}}\n$$\nUsing a high-precision calculator for the numerical value:\n$$\nI \\approx \\frac{2}{(2.718281828459045)(1.7724538509055159)} \\approx 0.4151074974205951\n$$\nThe problem asks for this value to be rounded to six significant figures.\n$I_{\\text{rounded}} = 0.415107$.\n\nNext, we compute the absolute error $E = |I_{\\text{rounded}} - I_{\\mathrm{ref}}|$.\nThe reference value is $I_{\\mathrm{ref}} = 0.415107497420595$.\n$$\nE = |0.415107 - 0.415107497420595| = |-0.000000497420595| = 0.000000497420595\n$$\nThis can be written in scientific notation as $4.97420595 \\times 10^{-7}$.\nRounding the error to six significant figures:\n$E \\approx 4.97421 \\times 10^{-7}$.\n\nThe final answer is a row matrix containing the rounded ERI and the rounded absolute error.",
            "answer": "$$ \\boxed{\\begin{pmatrix} 0.415107 & 4.97421 \\times 10^{-7} \\end{pmatrix}} $$"
        },
        {
            "introduction": "While GTOs enable efficient computation, any finite basis set remains an approximation to the true wavefunction, introducing a basis set incompleteness error. This final exercise introduces a powerful technique to systematically manage this error: extrapolation to the complete basis set (CBS) limit. By leveraging the predictable convergence behavior of correlation-consistent basis sets , you will learn to estimate the exact energy that would be obtained with an infinitely large basis, a critical skill for producing benchmark-quality results.",
            "id": "3821347",
            "problem": "In multiscale materials simulation, localized basis sets are commonly constructed from Gaussian-type orbitals (GTOs) and Slater-type orbitals (STOs). The correlation-consistent polarized valence X-zeta (cc-pVXZ) GTO families are designed to systematically recover missing angular-momentum components of the wavefunction. For many molecular systems, the basis set incompleteness error in the correlation energy using cc-pVXZ GTOs is empirically and theoretically well described by the asymptotic form that scales with the cardinal number $X$ as $X^{-3}$, consistent with the missing high-angular-momentum contributions and the electron-electron cusp conditions not being exactly captured by Gaussians. Define the Complete Basis Set (CBS) limit energy as $E_{\\text{CBS}}$.\n\nYou have computed total electronic energies for a localized quantum region within a multiscale model using cc-pVXZ GTOs:\n- $E(3)$ from cc-pVTZ ($X=3$): $-76.384512$ Hartree,\n- $E(4)$ from cc-pVQZ ($X=4$): $-76.389012$ Hartree.\n\nAssume the asymptotic two-point form for GTO convergence holds:\n$$E(X) = E_{\\text{CBS}} + A X^{-3},$$\nwhere $A$ is a system-dependent constant and $X \\in \\{3,4\\}$ are the cardinalities of cc-pVXZ.\n\nStarting from the concepts of basis set incompleteness and the asymptotic $X^{-3}$ convergence for GTOs, and without invoking any shortcut formulas beyond the stated convergence model, do the following:\n1. Derive an explicit algebraic expression for $E_{\\text{CBS}}$ in terms of $E(3)$ and $E(4)$ by eliminating $A$.\n2. Use the given numerical values of $E(3)$ and $E(4)$ to compute $E_{\\text{CBS}}$.\n3. Briefly assess the residual basis set error at $X=4$ implied by the model and discuss, at the level of first principles, how the presence of a physical electron-nucleus cusp in Slater-type orbitals (STOs) might alter the asymptotic convergence behavior compared to GTOs.\n\nRound your final reported value of $E_{\\text{CBS}}$ to six significant figures. Express the final energy in Hartree.",
            "solution": "The solution is developed in three parts as requested.\n\n### Part 1: Derivation of the Expression for $E_{\\text{CBS}}$\n\nThe problem posits that the total electronic energy, $E(X)$, calculated with a correlation-consistent basis set of cardinal number $X$, follows the asymptotic relationship:\n$$E(X) = E_{\\text{CBS}} + A X^{-3}$$\nwhere $E_{\\text{CBS}}$ is the energy at the complete basis set limit and $A$ is a system-dependent constant. We are given two data points corresponding to $X=3$ (cc-pVTZ) and $X=4$ (cc-pVQZ). We can write two simultaneous equations based on the model:\n$$E(3) = E_{\\text{CBS}} + A (3)^{-3} \\quad \\quad (1)$$\n$$E(4) = E_{\\text{CBS}} + A (4)^{-3} \\quad \\quad (2)$$\nOur goal is to solve this system of two linear equations for the unknown $E_{\\text{CBS}}$ by eliminating the constant $A$.\n\nFrom equation (1), we can express $A$ in terms of $E(3)$ and $E_{\\text{CBS}}$:\n$$A (3)^{-3} = E(3) - E_{\\text{CBS}}$$\n$$A = 3^3 (E(3) - E_{\\text{CBS}}) = 27 (E(3) - E_{\\text{CBS}})$$\nNow, we substitute this expression for $A$ into equation (2):\n$$E(4) = E_{\\text{CBS}} + [27 (E(3) - E_{\\text{CBS}})] (4)^{-3}$$\n$$E(4) = E_{\\text{CBS}} + \\frac{27}{4^3} (E(3) - E_{\\text{CBS}})$$\n$$E(4) = E_{\\text{CBS}} + \\frac{27}{64} (E(3) - E_{\\text{CBS}})$$\nWe now rearrange the equation to isolate $E_{\\text{CBS}}$.\n$$E(4) = E_{\\text{CBS}} + \\frac{27}{64} E(3) - \\frac{27}{64} E_{\\text{CBS}}$$\n$$E(4) - \\frac{27}{64} E(3) = E_{\\text{CBS}} - \\frac{27}{64} E_{\\text{CBS}}$$\n$$E(4) - \\frac{27}{64} E(3) = E_{\\text{CBS}} \\left(1 - \\frac{27}{64}\\right)$$\nThe term in the parenthesis simplifies to:\n$$1 - \\frac{27}{64} = \\frac{64}{64} - \\frac{27}{64} = \\frac{37}{64}$$\nSubstituting this back into the equation gives:\n$$E(4) - \\frac{27}{64} E(3) = E_{\\text{CBS}} \\left(\\frac{37}{64}\\right)$$\nTo solve for $E_{\\text{CBS}}$, we multiply both sides by $\\frac{64}{37}$:\n$$E_{\\text{CBS}} = \\frac{64}{37} \\left(E(4) - \\frac{27}{64} E(3)\\right)$$\nDistributing the factor $\\frac{64}{37}$:\n$$E_{\\text{CBS}} = \\frac{64 E(4) - 27 E(3)}{37}$$\nThis is the explicit algebraic expression for $E_{\\text{CBS}}$ in terms of $E(3)$ and $E(4)$.\n\n### Part 2: Numerical Calculation of $E_{\\text{CBS}}$\n\nWe are given the following numerical values in Hartree units:\n- $E(3) = -76.384512$\n- $E(4) = -76.389012$\n\nSubstituting these values into the derived expression for $E_{\\text{CBS}}$:\n$$E_{\\text{CBS}} = \\frac{64(-76.389012) - 27(-76.384512)}{37}$$\nFirst, we compute the products in the numerator:\n$$64 \\times (-76.389012) = -4888.896768$$\n$$27 \\times (-76.384512) = -2062.381824$$\nNow, substitute these back into the expression:\n$$E_{\\text{CBS}} = \\frac{-4888.896768 - (-2062.381824)}{37}$$\n$$E_{\\text{CBS}} = \\frac{-4888.896768 + 2062.381824}{37}$$\n$$E_{\\text{CBS}} = \\frac{-2826.514944}{37}$$\nPerforming the division gives the unrounded value:\n$$E_{\\text{CBS}} \\approx -76.3922957837... \\text{ Hartree}$$\nThe problem requires rounding the final value to six significant figures. The first six significant digits are $7$, $6$, $3$, $9$, $2$, $2$. The seventh digit is $9$, which is greater than or equal to $5$, so we round up the sixth digit.\n$$E_{\\text{CBS}} \\approx -76.3923 \\text{ Hartree}$$\n\n### Part 3: Residual Error and STO vs. GTO Convergence\n\nThe residual basis set error at $X=4$ is the difference between the calculated energy $E(4)$ and the extrapolated complete basis set limit $E_{\\text{CBS}}$. Using our unrounded value for $E_{\\text{CBS}}$ for better accuracy:\n$$\\text{Error}(X=4) = E(4) - E_{\\text{CBS}}$$\n$$\\text{Error}(X=4) = -76.389012 - (-76.39229578...) \\approx 0.00328378 \\text{ Hartree}$$\nThis positive value indicates that the energy calculated with the cc-pVQZ basis set is higher than the CBS limit, as expected from the variational principle.\n\nThe discussion of Slater-type orbitals (STOs) versus Gaussian-type orbitals (GTOs) centers on their ability to model the electronic wavefunction, particularly at the positions of the atomic nuclei and at points of electron-electron coalescence.\n\nA GTO has the radial form $\\exp(-\\alpha r^2)$, which has a zero derivative at the nucleus ($r=0$). This functional form is mathematically incorrect for describing the electron-nucleus cusp, where the exact wavefunction should have a non-zero derivative given by Kato's cusp condition, $\\frac{1}{\\psi}\\frac{\\partial\\psi}{\\partial r}|_{r=0} = -Z$, where $Z$ is the nuclear charge. The failure to describe this cusp is a primary source of basis set incompleteness error in the one-electron (Hartree-Fock) part of the energy calculation.\n\nAn STO, with the radial form $\\exp(-\\zeta r)$, correctly has a non-zero derivative at the nucleus and thus provides a much better physical description of the electron-nucleus cusp. Consequently, the Hartree-Fock energy converges much more rapidly when using an STO basis compared to a GTO basis of similar size.\n\nThe asymptotic convergence behavior $E(X) \\approx E_{\\text{CBS}} + A X^{-3}$ for correlation-consistent basis sets is primarily dictated by the slow convergence of the *correlation energy*. This slow convergence arises from the difficulty in describing the electron-electron cusp, which occurs when two electrons approach each other ($r_{12} \\to 0$). Neither GTOs nor STOs, being one-electron functions, can exactly represent the multivariable dependence required to describe the electron-electron cusp. The $X^{-3}$ scaling behavior stems from the partial wave expansion of the correlation energy, a mathematical feature that is largely independent of the specific functional form (GTO or STO) of the one-electron basis functions.\n\nTherefore, the presence of a physical electron-nucleus cusp in STOs would alter the asymptotic convergence in the following manner:\n1.  The error in the one-electron (Hartree-Fock) component of the total energy would be significantly smaller and converge much more rapidly with STOs.\n2.  The total energy error, $E(X) - E_{\\text{CBS}}$, would be dominated almost entirely by the correlation energy error even for small cardinal numbers $X$.\n3.  As a result, the asymptotic $X^{-3}$ formula for the *total energy* would become accurate for smaller values of $X$ when using STOs than it is for GTOs, where the convergence is \"contaminated\" by the more slowly converging Hartree-Fock error component.\n\nIn summary, while the fundamental $X^{-3}$ power law for correlation energy is not expected to change, using STOs would make the total energy adhere more closely to this asymptotic form, providing a more reliable extrapolation from smaller basis sets.",
            "answer": "$$\\boxed{-76.3923}$$"
        }
    ]
}