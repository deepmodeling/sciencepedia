{
    "hands_on_practices": [
        {
            "introduction": "Plotting a band structure requires calculating energies along specific paths connecting high-symmetry points in the first Brillouin zone (e.g., $\\Gamma$, $X$, $L$). This fundamental exercise provides hands-on practice in the crucial task of converting the standard coordinates of these points into the primitive reciprocal basis used by many simulation codes. Mastering this vector algebra is a foundational skill for correctly setting up any band structure calculation.",
            "id": "3794761",
            "problem": "Consider two three-dimensional Bravais lattices with conventional cubic lattice constant $a$: the face-centered cubic (fcc) lattice and the body-centered cubic (bcc) lattice. The electronic band structure of a crystalline solid is computed along high-symmetry lines connecting special points in its First Brillouin Zone (FBZ). These special points are identified by the symmetry of the FBZ and have widely accepted Cartesian coordinates when expressed in the conventional reciprocal cubic basis $\\{(2\\pi/a)\\,\\hat{\\mathbf{x}},(2\\pi/a)\\,\\hat{\\mathbf{y}},(2\\pi/a)\\,\\hat{\\mathbf{z}}\\}$.\n\nStarting from the following foundational definitions:\n- The primitive direct lattice vectors $\\{\\mathbf{a}_{i}\\}$ for fcc can be chosen as $\\mathbf{a}_{1}=\\frac{a}{2}(0,1,1)$, $\\mathbf{a}_{2}=\\frac{a}{2}(1,0,1)$, $\\mathbf{a}_{3}=\\frac{a}{2}(1,1,0)$, and for bcc as $\\mathbf{a}_{1}=\\frac{a}{2}(1,1,-1)$, $\\mathbf{a}_{2}=\\frac{a}{2}(1,-1,1)$, $\\mathbf{a}_{3}=\\frac{a}{2}(-1,1,1)$.\n- The primitive reciprocal lattice vectors $\\{\\mathbf{b}_{i}\\}$ are defined by $\\mathbf{b}_{i}\\cdot\\mathbf{a}_{j}=2\\pi\\,\\delta_{ij}$ for $i,j\\in\\{1,2,3\\}$.\n\nUse the above to construct the primitive reciprocal bases $\\{\\mathbf{b}_{i}^{\\text{(fcc)}}\\}$ and $\\{\\mathbf{b}_{i}^{\\text{(bcc)}}\\}$ explicitly. Then, using the well-tested conventional Cartesian fractional coordinates (in the basis $\\{(2\\pi/a)\\,\\hat{\\mathbf{x}},(2\\pi/a)\\,\\hat{\\mathbf{y}},(2\\pi/a)\\,\\hat{\\mathbf{z}}\\}$) for the standard high-symmetry points:\n- For fcc: $\\Gamma=(0,0,0)$, $X=(0,1,0)$, $L=\\left(\\frac{1}{2},\\frac{1}{2},\\frac{1}{2}\\right)$, $W=\\left(\\frac{1}{2},1,0\\right)$, $K=\\left(\\frac{3}{4},\\frac{3}{4},0\\right)$.\n- For bcc: $\\Gamma=(0,0,0)$, $H=(1,0,0)$, $N=\\left(0,\\frac{1}{2},0\\right)$, $P=\\left(\\frac{1}{2},\\frac{1}{2},\\frac{1}{2}\\right)$.\n\nCompute the dimensionless coordinates of these points in the respective primitive reciprocal bases, that is, find $(c_{1},c_{2},c_{3})$ such that $\\mathbf{k}=c_{1}\\mathbf{b}_{1}+c_{2}\\mathbf{b}_{2}+c_{3}\\mathbf{b}_{3}$ for each listed point in fcc and bcc. Express your final answer as a single row matrix containing, in order, the three components for each point:\n- fcc in the order $\\Gamma$, $X$, $L$, $W$, $K$,\n- bcc in the order $\\Gamma$, $H$, $N$, $P$.\n\nNo rounding is required; express all entries as exact rational numbers. The entries are dimensionless and must be given in units of the respective $\\mathbf{b}_{i}$.",
            "solution": "The problem is well-posed, scientifically grounded, and contains all necessary information for a unique solution. We can proceed with the calculation.\n\nThe problem requires finding the coordinates $(c_1, c_2, c_3)$ of various high-symmetry points $\\mathbf{k}$ in the First Brillouin Zone (FBZ) with respect to the primitive reciprocal lattice basis $\\{\\mathbf{b}_1, \\mathbf{b}_2, \\mathbf{b}_3\\}$. The relationship is given by:\n$$ \\mathbf{k} = c_1\\mathbf{b}_1 + c_2\\mathbf{b}_2 + c_3\\mathbf{b}_3 $$\n\nThe primitive reciprocal lattice vectors $\\mathbf{b}_i$ are defined by their relationship to the primitive direct lattice vectors $\\mathbf{a}_j$:\n$$ \\mathbf{b}_i \\cdot \\mathbf{a}_j = 2\\pi \\delta_{ij} $$\nwhere $\\delta_{ij}$ is the Kronecker delta.\n\nTo find the coefficient $c_j$, we can take the dot product of the expression for $\\mathbf{k}$ with a direct lattice vector $\\mathbf{a}_j$:\n$$ \\mathbf{k} \\cdot \\mathbf{a}_j = (c_1\\mathbf{b}_1 + c_2\\mathbf{b}_2 + c_3\\mathbf{b}_3) \\cdot \\mathbf{a}_j $$\n$$ \\mathbf{k} \\cdot \\mathbf{a}_j = c_1(\\mathbf{b}_1 \\cdot \\mathbf{a}_j) + c_2(\\mathbf{b}_2 \\cdot \\mathbf{a}_j) + c_3(\\mathbf{b}_3 \\cdot \\mathbf{a}_j) $$\nUsing the orthogonality condition, this simplifies to:\n$$ \\mathbf{k} \\cdot \\mathbf{a}_j = c_j (2\\pi) $$\nThus, the coefficients can be directly calculated as:\n$$ c_j = \\frac{\\mathbf{k} \\cdot \\mathbf{a}_j}{2\\pi} $$\nThis method bypasses the explicit calculation of the $\\mathbf{b}_i$ vectors, though such a calculation would confirm that the fcc direct lattice corresponds to a bcc reciprocal lattice, and vice-versa.\n\nThe problem provides the coordinates of the high-symmetry points, denoted here as $(k'_x, k'_y, k'_z)$, in the conventional reciprocal cubic basis $\\{(2\\pi/a)\\,\\hat{\\mathbf{x}},(2\\pi/a)\\,\\hat{\\mathbf{y}},(2\\pi/a)\\,\\hat{\\mathbf{z}}\\}$. Therefore, the vector $\\mathbf{k}$ is given by:\n$$ \\mathbf{k} = \\frac{2\\pi}{a} (k'_x, k'_y, k'_z) $$\n\nSubstituting this into the formula for $c_j$:\n$$ c_j = \\frac{1}{2\\pi} \\left( \\frac{2\\pi}{a} (k'_x, k'_y, k'_z) \\right) \\cdot \\mathbf{a}_j = \\frac{1}{a} (k'_x, k'_y, k'_z) \\cdot \\mathbf{a}_j $$\n\nWe will now apply this general formula to the fcc and bcc lattices separately.\n\n**1. Face-Centered Cubic (fcc) Lattice**\n\nThe primitive direct lattice vectors for fcc are given as:\n$$ \\mathbf{a}_1^{(\\text{fcc})} = \\frac{a}{2}(0,1,1), \\quad \\mathbf{a}_2^{(\\text{fcc})} = \\frac{a}{2}(1,0,1), \\quad \\mathbf{a}_3^{(\\text{fcc})} = \\frac{a}{2}(1,1,0) $$\n\nUsing the derived formula for $c_j$, we obtain the specific transformation equations for the fcc lattice:\n$$ c_1 = \\frac{1}{a} (k'_x, k'_y, k'_z) \\cdot \\frac{a}{2}(0,1,1) = \\frac{1}{2}(k'_y + k'_z) $$\n$$ c_2 = \\frac{1}{a} (k'_x, k'_y, k'_z) \\cdot \\frac{a}{2}(1,0,1) = \\frac{1}{2}(k'_x + k'_z) $$\n$$ c_3 = \\frac{1}{a} (k'_x, k'_y, k'_z) \\cdot \\frac{a}{2}(1,1,0) = \\frac{1}{2}(k'_x + k'_y) $$\n\nWe now compute the coordinates $(c_1, c_2, c_3)$ for each specified fcc high-symmetry point:\n- **$\\Gamma=(0,0,0)$**: $(k'_x,k'_y,k'_z)=(0,0,0)$.\n  $c_1 = \\frac{1}{2}(0+0) = 0$, $c_2 = \\frac{1}{2}(0+0) = 0$, $c_3 = \\frac{1}{2}(0+0) = 0$. Coordinates: $(0,0,0)$.\n- **$X=(0,1,0)$**: $(k'_x,k'_y,k'_z)=(0,1,0)$.\n  $c_1 = \\frac{1}{2}(1+0) = \\frac{1}{2}$, $c_2 = \\frac{1}{2}(0+0) = 0$, $c_3 = \\frac{1}{2}(0+1) = \\frac{1}{2}$. Coordinates: $(\\frac{1}{2},0,\\frac{1}{2})$.\n- **$L=(\\frac{1}{2},\\frac{1}{2},\\frac{1}{2})$**: $(k'_x,k'_y,k'_z)=(\\frac{1}{2},\\frac{1}{2},\\frac{1}{2})$.\n  $c_1 = \\frac{1}{2}(\\frac{1}{2}+\\frac{1}{2}) = \\frac{1}{2}$, $c_2 = \\frac{1}{2}(\\frac{1}{2}+\\frac{1}{2}) = \\frac{1}{2}$, $c_3 = \\frac{1}{2}(\\frac{1}{2}+\\frac{1}{2}) = \\frac{1}{2}$. Coordinates: $(\\frac{1}{2},\\frac{1}{2},\\frac{1}{2})$.\n- **$W=(\\frac{1}{2},1,0)$**: $(k'_x,k'_y,k'_z)=(\\frac{1}{2},1,0)$.\n  $c_1 = \\frac{1}{2}(1+0) = \\frac{1}{2}$, $c_2 = \\frac{1}{2}(\\frac{1}{2}+0) = \\frac{1}{4}$, $c_3 = \\frac{1}{2}(\\frac{1}{2}+1) = \\frac{3}{4}$. Coordinates: $(\\frac{1}{2},\\frac{1}{4},\\frac{3}{4})$.\n- **$K=(\\frac{3}{4},\\frac{3}{4},0)$**: $(k'_x,k'_y,k'_z)=(\\frac{3}{4},\\frac{3}{4},0)$.\n  $c_1 = \\frac{1}{2}(\\frac{3}{4}+0) = \\frac{3}{8}$, $c_2 = \\frac{1}{2}(\\frac{3}{4}+0) = \\frac{3}{8}$, $c_3 = \\frac{1}{2}(\\frac{3}{4}+\\frac{3}{4}) = \\frac{3}{4}$. Coordinates: $(\\frac{3}{8},\\frac{3}{8},\\frac{3}{4})$.\n\n**2. Body-Centered Cubic (bcc) Lattice**\n\nThe primitive direct lattice vectors for bcc are given as:\n$$ \\mathbf{a}_1^{(\\text{bcc})} = \\frac{a}{2}(1,1,-1), \\quad \\mathbf{a}_2^{(\\text{bcc})} = \\frac{a}{2}(1,-1,1), \\quad \\mathbf{a}_3^{(\\text{bcc})} = \\frac{a}{2}(-1,1,1) $$\n\nThe specific transformation equations for the bcc lattice are:\n$$ c_1 = \\frac{1}{a} (k'_x, k'_y, k'_z) \\cdot \\frac{a}{2}(1,1,-1) = \\frac{1}{2}(k'_x + k'_y - k'_z) $$\n$$ c_2 = \\frac{1}{a} (k'_x, k'_y, k'_z) \\cdot \\frac{a}{2}(1,-1,1) = \\frac{1}{2}(k'_x - k'_y + k'_z) $$\n$$ c_3 = \\frac{1}{a} (k'_x, k'_y, k'_z) \\cdot \\frac{a}{2}(-1,1,1) = \\frac{1}{2}(-k'_x + k'_y + k'_z) $$\n\nWe now compute the coordinates $(c_1, c_2, c_3)$ for each specified bcc high-symmetry point:\n- **$\\Gamma=(0,0,0)$**: $(k'_x,k'_y,k'_z)=(0,0,0)$.\n  $c_1=0$, $c_2=0$, $c_3=0$. Coordinates: $(0,0,0)$.\n- **$H=(1,0,0)$**: $(k'_x,k'_y,k'_z)=(1,0,0)$.\n  $c_1 = \\frac{1}{2}(1+0-0) = \\frac{1}{2}$, $c_2 = \\frac{1}{2}(1-0+0) = \\frac{1}{2}$, $c_3 = \\frac{1}{2}(-1+0+0) = -\\frac{1}{2}$. Coordinates: $(\\frac{1}{2},\\frac{1}{2},-\\frac{1}{2})$.\n- **$N=(0,\\frac{1}{2},0)$**: $(k'_x,k'_y,k'_z)=(0,\\frac{1}{2},0)$.\n  $c_1 = \\frac{1}{2}(0+\\frac{1}{2}-0) = \\frac{1}{4}$, $c_2 = \\frac{1}{2}(0-\\frac{1}{2}+0) = -\\frac{1}{4}$, $c_3 = \\frac{1}{2}(0+\\frac{1}{2}+0) = \\frac{1}{4}$. Coordinates: $(\\frac{1}{4},-\\frac{1}{4},\\frac{1}{4})$.\n- **$P=(\\frac{1}{2},\\frac{1}{2},\\frac{1}{2})$**: $(k'_x,k'_y,k'_z)=(\\frac{1}{2},\\frac{1}{2},\\frac{1}{2})$.\n  $c_1 = \\frac{1}{2}(\\frac{1}{2}+\\frac{1}{2}-\\frac{1}{2}) = \\frac{1}{4}$, $c_2 = \\frac{1}{2}(\\frac{1}{2}-\\frac{1}{2}+\\frac{1}{2}) = \\frac{1}{4}$, $c_3 = \\frac{1}{2}(-\\frac{1}{2}+\\frac{1}{2}+\\frac{1}{2}) = \\frac{1}{4}$. Coordinates: $(\\frac{1}{4},\\frac{1}{4},\\frac{1}{4})$.\n\nThe results are exact rational numbers as required. We consolidate them into a single row matrix in the specified order.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 0 & 0 & 0 & \\frac{1}{2} & 0 & \\frac{1}{2} & \\frac{1}{2} & \\frac{1}{2} & \\frac{1}{2} & \\frac{1}{2} & \\frac{1}{4} & \\frac{3}{4} & \\frac{3}{8} & \\frac{3}{8} & \\frac{3}{4} & 0 & 0 & 0 & \\frac{1}{2} & \\frac{1}{2} & -\\frac{1}{2} & \\frac{1}{4} & -\\frac{1}{4} & \\frac{1}{4} & \\frac{1}{4} & \\frac{1}{4} & \\frac{1}{4} \\end{pmatrix} } $$"
        },
        {
            "introduction": "The accuracy of plane-wave calculations depends critically on the basis set size, governed by the kinetic energy cutoff $E_{\\text{cut}}$. Too low a cutoff yields inaccurate results; too high is computationally wasteful. This practice simulates the essential process of performing a convergence test to determine the minimum $E_{\\text{cut}}$ required to achieve a desired accuracy for key physical quantities, a fundamental skill for producing reliable computational results.",
            "id": "3739438",
            "problem": "Consider a one-dimensional periodic potential model intended to qualitatively emulate the electronic structure features of silicon while remaining computationally tractable within a plane-wave basis. The system is governed by the single-particle time-independent Schrödinger equation for an electron of mass $m_e$ in a periodic potential $V(x)$ with lattice constant $a$, expressed as $-\\frac{\\hbar^2}{2 m_e} \\frac{d^2}{dx^2} \\psi(x) + V(x) \\psi(x) = E \\psi(x)$. By Bloch's theorem, eigenstates can be written as $\\psi_{n,k}(x) = e^{i k x} u_{n,k}(x)$ where $u_{n,k}(x)$ has the periodicity of the lattice. Expanding in plane waves leads to a matrix Hamiltonian in reciprocal space indexed by reciprocal lattice vectors $G$ and $G'$:\n$$\nH_{G,G'}(k) = \\delta_{G,G'} \\left( \\frac{\\hbar^2}{2 m_e} \\left| k + G \\right|^2 \\right) + V_{G - G'}\n$$\nwhere $V_{q}$ are Fourier components of the periodic potential and $\\delta_{G,G'}$ is the Kronecker delta. The reciprocal lattice vectors are $G = n G_0$ with $n \\in \\mathbb{Z}$ and $G_0 = \\frac{2 \\pi}{a}$. In this problem, use a transferable local pseudopotential specified by two nonzero Fourier components $V_{G_0}$ and $V_{2 G_0}$, with $V_{q} = 0$ otherwise. Take $V_{G_0} = -5.0$ eV and $V_{2 G_0} = +1.5$ eV for all volumes, which constitutes a model intended to emulate the opening of an indirect gap and a finite valence bandwidth reminiscent of silicon. Use the physical constant $\\frac{\\hbar^2}{2 m_e} = 3.8099819443$ eV·Å$^2$.\n\nTo reflect a plane-wave basis truncation, impose a kinetic energy cutoff $E_{\\text{cut}}$ by including only those reciprocal lattice vectors $G$ for which the free-electron kinetic energy at $k = 0$ satisfies $\\frac{\\hbar^2}{2 m_e} G^2 \\le E_{\\text{cut}}$. For each chosen $E_{\\text{cut}}$, construct the Hamiltonian $H(k)$ on a uniform grid of wave numbers $k$ in the first Brillouin zone from $0$ to $\\pi/a$, diagonalize $H(k)$ to obtain band energies $E_n(k)$ (sorted in ascending order), and define the valence band as $n_v = 1$ and the conduction band as $n_c = 2$. This indexing corresponds to the physically motivated assumption for a one-dimensional insulator with a single primary band gap between the first and second bands in the nearly-free electron regime. The valence bandwidth is $W_v = \\max_k E_{n_v}(k) - \\min_k E_{n_v}(k)$, and the indirect band gap is $\\Delta_{\\text{ind}} = \\min_k E_{n_c}(k) - \\max_k E_{n_v}(k)$, with energies expressed in electronvolts.\n\nYour task is to compute convergence of $\\Delta_{\\text{ind}}$ and $W_v$ with respect to $E_{\\text{cut}}$, and to assess transferability of the pseudopotential across volumes by repeating the analysis at different lattice constants $a$. Use the following test suite:\n\n- Lattice constants (in Å): $a_1 = 5.43$, $a_2 = 5.30$, $a_3 = 5.60$.\n- Energy cutoffs (in eV) to test: $E_{\\text{cut}} \\in \\{ 4, 6, 8, 12, 16, 24, 32, 48 \\}$.\n- Reference energy cutoff (in eV): $E_{\\text{ref}} = 80$.\n- Tolerances (in eV): $\\varepsilon_{\\Delta} = 0.01$ for the indirect gap and $\\varepsilon_W = 0.01$ for the valence bandwidth.\n- Wave number grid: uniformly sample $k$ in $[0, \\pi/a]$ with $201$ points.\n\nFor each lattice constant $a$, compute the reference values $\\Delta_{\\text{ind}}^{\\text{ref}}(a)$ and $W_v^{\\text{ref}}(a)$ using $E_{\\text{ref}}$. Then, for each $E_{\\text{cut}}$ in the test list, compute $\\Delta_{\\text{ind}}(a; E_{\\text{cut}})$ and $W_v(a; E_{\\text{cut}})$ and determine the smallest $E_{\\text{cut}}$ such that $\\left| \\Delta_{\\text{ind}}(a; E_{\\text{cut}}) - \\Delta_{\\text{ind}}^{\\text{ref}}(a) \\right| \\le \\varepsilon_{\\Delta}$ and the smallest $E_{\\text{cut}}$ such that $\\left| W_v(a; E_{\\text{cut}}) - W_v^{\\text{ref}}(a) \\right| \\le \\varepsilon_W$. If for a given property at a given $a$ no $E_{\\text{cut}}$ in the test list meets the tolerance, report $-1$ for that entry. Energies and cutoffs are in electronvolts (eV), and distances are in ångström (Å). Wave numbers $k$ are in reciprocal ångström (Å$^{-1}$).\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must contain six numbers in the following order: the minimal $E_{\\text{cut}}$ for the indirect gap at $a_1$, the minimal $E_{\\text{cut}}$ for the valence bandwidth at $a_1$, then the corresponding two values for $a_2$, and then for $a_3$. For example, the output format must be like $[x_1, y_1, x_2, y_2, x_3, y_3]$ where each $x_i$ and $y_i$ are floating-point numbers in eV.",
            "solution": "The problem requires the calculation of the indirect band gap and valence bandwidth of a one-dimensional periodic system and the study of their convergence with respect to the plane-wave energy cutoff parameter, $E_{\\text{cut}}$. This is a standard procedure in computational materials science to ensure the reliability of simulation results. The analysis will be performed for three different lattice constants, $a$, to assess the transferability of the provided pseudopotential.\n\nThe foundation of this problem is the time-independent single-particle Schrödinger equation for an electron of mass $m_e$ in a periodic potential $V(x)$:\n$$\n\\left[ -\\frac{\\hbar^2}{2 m_e} \\frac{d^2}{dx^2} + V(x) \\right] \\psi(x) = E \\psi(x)\n$$\nDue to the periodicity of the potential, $V(x) = V(x+a)$, Bloch's theorem states that the eigenstates can be written in the form $\\psi_{n,k}(x) = e^{ikx} u_{n,k}(x)$, where $u_{n,k}(x)$ is a periodic function with the same lattice periodicity, and $k$ is the wave number confined to the first Brillouin zone, which for a 1D lattice is $[-\\pi/a, \\pi/a]$.\n\nThe periodic function $u_{n,k}(x)$ can be expanded in a Fourier series over the reciprocal lattice vectors $G = n G_0$, where $G_0 = 2\\pi/a$ and $n \\in \\mathbb{Z}$:\n$$\nu_{n,k}(x) = \\sum_{G} c_{k,G} e^{iGx}\n$$\nSubstituting this into the Schrödinger equation leads to an eigenvalue problem in reciprocal space. The Hamiltonian becomes a matrix with elements indexed by reciprocal lattice vectors $G$ and $G'$:\n$$\nH_{G,G'}(k) = \\delta_{G,G'} \\left( \\frac{\\hbar^2}{2 m_e} |k+G|^2 \\right) + V_{G-G'}\n$$\nHere, $\\delta_{G,G'}$ is the Kronecker delta, and $V_{G-G'}$ are the Fourier coefficients of the potential $V(x)$. For a physical, real potential $V(x)$, its Fourier coefficients must satisfy $V_q = V_{-q}^*$. The problem provides real values for $V_q$, which implies $V_q = V_{-q}$. We are given two non-zero potential components: $V_{G_0} = -5.0 \\text{ eV}$ and $V_{2G_0} = +1.5 \\text{ eV}$. We thus assume $V_{-G_0} = V_{G_0}$ and $V_{-2G_0} = V_{2G_0}$. All other components, including $V_0$, are zero. The constant $\\frac{\\hbar^2}{2m_e}$ is given as $3.8099819443 \\text{ eV} \\cdot \\text{Å}^2$.\n\nIn any practical calculation, the infinite sum over $G$ must be truncated. The problem specifies a kinetic energy cutoff scheme: the basis set includes only those reciprocal lattice vectors $G$ for which the free-electron kinetic energy at $k=0$ is below a cutoff $E_{\\text{cut}}$.\n$$\n\\frac{\\hbar^2}{2 m_e} G^2 \\le E_{\\text{cut}}\n$$\nSubstituting $G = n G_0 = n \\frac{2\\pi}{a}$, we can find the maximum integer $N_{\\text{max}}$ for the basis set:\n$$\n\\frac{\\hbar^2}{2 m_e} \\left( n \\frac{2\\pi}{a} \\right)^2 \\le E_{\\text{cut}} \\implies n^2 \\le \\frac{E_{\\text{cut}} a^2}{4\\pi^2 (\\hbar^2 / 2m_e)}\n$$\nThus, $N_{\\text{max}}(a, E_{\\text{cut}}) = \\left\\lfloor \\sqrt{\\frac{E_{\\text{cut}} a^2}{4\\pi^2 (\\hbar^2 / 2m_e)}} \\right\\rfloor$. The basis will consist of $G_n = nG_0$ for $n \\in \\{-N_{\\text{max}}, \\dots, N_{\\text{max}}\\}$. The size of the Hamiltonian matrix will be $(2N_{\\text{max}} + 1) \\times (2N_{\\text{max}} + 1)$. For the problem to be meaningful (i.e., to obtain at least two bands, $n_v=1$ and $n_c=2$), the matrix size must be at least $2 \\times 2$, which means $N_{\\text{max}} \\ge 1$. If a chosen $E_{\\text{cut}}$ results in $N_{\\text{max}} < 1$, the calculation for that cutoff is not performed as the required quantities are ill-defined.\n\nThe computational procedure is as follows:\n1.  For each lattice constant $a \\in \\{5.43, 5.30, 5.60\\}$ Å:\n    a. A uniform grid of $201$ wave numbers $k$ is generated in the range $[0, \\pi/a]$.\n    b. The reference values for the indirect gap, $\\Delta_{\\text{ind}}^{\\text{ref}}(a)$, and valence bandwidth, $W_v^{\\text{ref}}(a)$, are computed using a high reference cutoff $E_{\\text{ref}} = 80 \\text{ eV}$.\n    c. For each test cutoff $E_{\\text{cut}} \\in \\{4, 6, 8, 12, 16, 24, 32, 48\\}$ eV, the quantities $\\Delta_{\\text{ind}}(a; E_{\\text{cut}})$ and $W_v(a; E_{\\text{cut}})$ are computed. This involves:\n        i. Determining $N_{\\text{max}}$ for the given $a$ and $E_{\\text{cut}}$.\n        ii. For each $k$ on the grid, constructing the $(2N_{\\text{max}}+1) \\times (2N_{\\text{max}}+1)$ Hamiltonian matrix $H(k)$. The matrix is Hermitian (in this case, real and symmetric).\n        iii. Diagonalizing $H(k)$ to obtain its eigenvalues, which are the band energies $E_n(k)$. These are sorted in ascending order.\n        iv. After looping through all $k$, the valence bandwidth is calculated as $W_v = \\max_k E_1(k) - \\min_k E_1(k)$, and the indirect band gap as $\\Delta_{\\text{ind}} = \\min_k E_2(k) - \\max_k E_1(k)$.\n    d. The smallest $E_{\\text{cut}}$ from the test list is found such that the absolute error relative to the reference value is within tolerance: $|\\Delta_{\\text{ind}} - \\Delta_{\\text{ind}}^{\\text{ref}}| \\le \\varepsilon_{\\Delta}$ for the gap ($\\varepsilon_{\\Delta} = 0.01$ eV) and $|W_v - W_v^{\\text{ref}}| \\le \\varepsilon_W$ for the bandwidth ($\\varepsilon_W = 0.01$ eV). If no such cutoff exists in the list, $-1$ is reported.\n\nThis process is repeated for each of the three lattice constants, yielding six final values for the minimal converged energy cutoffs.",
            "answer": "[16.0,8.0,16.0,8.0,16.0,8.0]"
        },
        {
            "introduction": "Extracting quantitative physical properties from a band structure often requires more than just plotting along standard paths, especially for materials with sharp features like graphene's Dirac cones. This advanced exercise demonstrates how to implement an adaptive k-point mesh to accurately resolve the linear dispersion near a Dirac point. This allows you to bridge the gap between a qualitative band diagram and the quantitative prediction of a measurable property like the Fermi velocity.",
            "id": "3794760",
            "problem": "You are tasked with constructing an adaptive wave vector mesh around a Dirac cone in graphene and quantifying the error in the computed Fermi velocity as a function of mesh refinement. The physical model is based on a nearest-neighbor tight-binding description of graphene’s honeycomb lattice, and the Fermi velocity is to be extracted from the slope of the conduction band energy near a Dirac point.\n\nStart from the following fundamental base:\n- Bloch’s theorem implies that electronic states in a periodic crystal can be characterized by a wave vector $k$ and an energy dispersion $E(k)$, and that the group velocity is given by $v(k) = \\frac{1}{\\hbar} \\nabla_k E(k)$, where $\\hbar$ is the reduced Planck constant.\n- In a nearest-neighbor tight-binding (TB) model on graphene’s honeycomb lattice, the Bloch Hamiltonian in the sublattice basis $\\{A,B\\}$ takes the form\n$$\nH(k) = \\begin{pmatrix}\n0 & -t f(k) \\\\\n-t f^*(k) & 0\n\\end{pmatrix},\n$$\nwhere $t$ is the nearest-neighbor hopping energy and $f(k) = \\sum_{i=1}^{3} \\exp\\left(i\\, k \\cdot \\delta_i\\right)$ sums the phase contributions from the three nearest-neighbor vectors $\\delta_i$. The energy dispersion is $E_{\\pm}(k) = \\pm t \\left| f(k) \\right|$.\n- The Dirac points $K$ are those $k$ such that $f(k)=0$. Around $K$, the band dispersion is linear.\n\nUse the following scientifically consistent and self-contained specifications:\n- Nearest-neighbor displacement vectors expressed in Cartesian coordinates with nearest-neighbor distance $a$ are\n$$\n\\delta_1 = a \\,(0,1), \\quad\n\\delta_2 = a \\left(\\frac{\\sqrt{3}}{2}, -\\frac{1}{2}\\right), \\quad\n\\delta_3 = a \\left(-\\frac{\\sqrt{3}}{2}, -\\frac{1}{2}\\right).\n$$\n- One Dirac point (corner of the Brillouin zone) consistent with the above choice is\n$$\nK = \\left(\\frac{4\\pi}{3\\sqrt{3}\\,a}, \\, 0\\right).\n$$\n- Physical constants and parameters:\n  - Nearest-neighbor distance $a = 1.42 \\times 10^{-10}\\ \\mathrm{m}$.\n  - Nearest-neighbor hopping energy $t = 2.7\\ \\mathrm{eV}$.\n  - Reduced Planck constant $\\hbar = 1.054571817 \\times 10^{-34}\\ \\mathrm{J\\,s}$.\n  - Energy conversions must be performed using $1\\ \\mathrm{eV} = 1.602176634 \\times 10^{-19}\\ \\mathrm{J}$.\n- Use radians for any angular quantities.\n- Construct an adaptive mesh of wave vectors $k$ around the Dirac point $K$ via polar sampling of $q = k - K$:\n  - For a given refinement level $\\ell \\in \\mathbb{N}$, define an angular resolution $N_\\theta(\\ell) = N_{\\theta,0}\\, 2^\\ell$ and a radial step $\\Delta r(\\ell) = \\Delta r_0 / 2^\\ell$.\n  - For each $\\ell$, sample radii $r_j = j\\, \\Delta r(\\ell)$ for integer $j = 1,2,\\dots,M(\\ell)$ where $M(\\ell) = \\left\\lfloor r_{\\max} / \\Delta r(\\ell) \\right\\rfloor$, and angles $\\theta_i = \\frac{2\\pi i}{N_\\theta(\\ell)}$ for $i = 0,1,\\dots,N_\\theta(\\ell)-1$.\n  - Construct the mesh points $k_{j,i} = K + r_j \\left(\\cos \\theta_i, \\sin \\theta_i\\right)$.\n- Compute the conduction band energy $E_+(k)$ at each mesh point from the TB model given above. Convert the energy to joules and fit a linear model $E \\approx S r + E_0$ in the scalar radial variable $r = |q|$ by least squares. Infer the Fermi velocity estimate $v_{\\mathrm{fit}} = S / \\hbar$. The fit should include the intercept $E_0$ to avoid bias from numerical curvature; however, the Fermi velocity must be extracted solely from the slope $S$ via $S/\\hbar$.\n- Quantify the absolute error in the computed Fermi velocity relative to the true Fermi velocity $v_{\\mathrm{true}}$ derived from first principles using the above TB model around $K$:\n$$\n\\varepsilon = \\left| v_{\\mathrm{fit}} - v_{\\mathrm{true}} \\right|.\n$$\nExpress the final error values in $\\mathrm{m/s}$ as floating-point numbers.\n\nYour program must implement the above procedure and produce numerical results for the following test suite, which is designed to assess different aspects of the adaptive mesh:\n- Test case $1$: $(\\ell, N_{\\theta,0}, \\Delta r_0, r_{\\max}) = (0, 8, 1.0 \\times 10^{8}\\ \\mathrm{m}^{-1}, 5.0 \\times 10^{8}\\ \\mathrm{m}^{-1})$.\n- Test case $2$: $(\\ell, N_{\\theta,0}, \\Delta r_0, r_{\\max}) = (1, 8, 1.0 \\times 10^{8}\\ \\mathrm{m}^{-1}, 5.0 \\times 10^{8}\\ \\mathrm{m}^{-1})$.\n- Test case $3$: $(\\ell, N_{\\theta,0}, \\Delta r_0, r_{\\max}) = (2, 8, 1.0 \\times 10^{8}\\ \\mathrm{m}^{-1}, 5.0 \\times 10^{8}\\ \\mathrm{m}^{-1})$.\n- Test case $4$: $(\\ell, N_{\\theta,0}, \\Delta r_0, r_{\\max}) = (2, 4, 1.0 \\times 10^{8}\\ \\mathrm{m}^{-1}, 5.0 \\times 10^{8}\\ \\mathrm{m}^{-1})$.\n- Test case $5$: $(\\ell, N_{\\theta,0}, \\Delta r_0, r_{\\max}) = (2, 8, 1.0 \\times 10^{8}\\ \\mathrm{m}^{-1}, 2.0 \\times 10^{9}\\ \\mathrm{m}^{-1})$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the test cases above, for example, $[\\varepsilon_1,\\varepsilon_2,\\varepsilon_3,\\varepsilon_4,\\varepsilon_5]$ where each $\\varepsilon_i$ is the absolute error in $\\mathrm{m/s}$ for test case $i$.",
            "solution": "The graphene honeycomb lattice can be modeled using a nearest-neighbor tight-binding (TB) Hamiltonian in the sublattice basis $\\{A,B\\}$,\n$$\nH(k) = \\begin{pmatrix}\n0 & -t f(k) \\\\\n-t f^*(k) & 0\n\\end{pmatrix},\n$$\nwhere the off-diagonal term encodes hopping from sublattice $A$ to $B$ and vice versa, with $t$ the nearest-neighbor hopping energy and $f(k)$ the sum over phase factors contributed by the three nearest-neighbor vectors. For the honeycomb lattice with nearest-neighbor distance $a$, the displacement vectors are chosen as\n$$\n\\delta_1 = a \\,(0,1), \\quad\n\\delta_2 = a \\left(\\frac{\\sqrt{3}}{2}, -\\frac{1}{2}\\right), \\quad\n\\delta_3 = a \\left(-\\frac{\\sqrt{3}}{2}, -\\frac{1}{2}\\right).\n$$\nThe function $f(k)$ is then\n$$\nf(k) = \\sum_{i=1}^{3} \\exp\\left(i\\, k \\cdot \\delta_i\\right) = \\exp\\left(i\\, k \\cdot \\delta_1\\right) + \\exp\\left(i\\, k \\cdot \\delta_2\\right) + \\exp\\left(i\\, k \\cdot \\delta_3\\right).\n$$\nThe band energies are\n$$\nE_{\\pm}(k) = \\pm t \\left| f(k) \\right|.\n$$\n\nDirac points occur where $f(k) = 0$. For the above choice of $\\delta_i$, a Dirac point is located at\n$$\nK = \\left(\\frac{4\\pi}{3\\sqrt{3}\\,a}, \\, 0\\right),\n$$\nwhich can be verified by evaluating $f(K)$:\n$$\nK \\cdot \\delta_1 = 0 \\Rightarrow \\exp\\left(i\\,K\\cdot \\delta_1\\right) = 1,\n$$\n$$\nK \\cdot \\delta_2 = a \\left(\\frac{\\sqrt{3}}{2}\\right) \\frac{4\\pi}{3\\sqrt{3}\\,a} = \\frac{2\\pi}{3} \\Rightarrow \\exp\\left(i\\,K\\cdot \\delta_2\\right) = \\exp\\left(i\\,\\frac{2\\pi}{3}\\right),\n$$\n$$\nK \\cdot \\delta_3 = -\\frac{2\\pi}{3} \\Rightarrow \\exp\\left(i\\,K\\cdot \\delta_3\\right) = \\exp\\left(-i\\,\\frac{2\\pi}{3}\\right),\n$$\nso that\n$$\nf(K) = 1 + 2 \\cos\\left(\\frac{2\\pi}{3}\\right) = 1 + 2\\left(-\\frac{1}{2}\\right) = 0.\n$$\n\nNear $K$, define $q = k - K$. The low-energy expansion of $f(K+q)$ to first order in $q$ yields an isotropic linear dependence on $|q|$ up to an overall phase. Specifically, one finds\n$$\nf(K+q) \\approx \\frac{3a}{2}\\left(q_x - i q_y\\right) \\times (\\text{phase}),\n$$\nand hence, the conduction band energy (in electronvolts) is approximately\n$$\nE_+(K+q) \\approx t \\left| f(K+q) \\right| \\approx t \\cdot \\frac{3a}{2} |q|.\n$$\nTo convert energy to joules, use $t_{\\mathrm{J}} = t \\times (1.602176634 \\times 10^{-19})$ and write the energy as\n$$\nE_{\\mathrm{J}}(K+q) \\approx t_{\\mathrm{J}} \\cdot \\frac{3a}{2} |q|.\n$$\nThe group velocity as the slope of energy with respect to $|q|$ divided by $\\hbar$ is\n$$\nv_{\\mathrm{true}} = \\frac{1}{\\hbar} \\frac{d E_{\\mathrm{J}}}{d |q|} = \\frac{1}{\\hbar} \\left( t_{\\mathrm{J}} \\cdot \\frac{3a}{2} \\right) = \\frac{3 a t_{\\mathrm{J}}}{2 \\hbar}.\n$$\n\nAlgorithmic plan:\n1. Construct an adaptive mesh around $K$ using polar sampling. For a refinement level $\\ell$, define $N_\\theta(\\ell) = N_{\\theta,0} \\, 2^\\ell$ angular samples and a radial step $\\Delta r(\\ell) = \\Delta r_0 / 2^\\ell$. Sample radii $r_j = j \\Delta r(\\ell)$ for $j = 1,2,\\dots, M(\\ell)$ where $M(\\ell) = \\left\\lfloor r_{\\max} / \\Delta r(\\ell) \\right\\rfloor$. For each radius and angle $\\theta_i = \\frac{2\\pi i}{N_\\theta(\\ell)}$, form wave vectors $k_{j,i} = K + r_j(\\cos\\theta_i,\\sin\\theta_i)$.\n2. At each $k_{j,i}$, compute $f(k_{j,i}) = \\sum_{n=1}^{3} \\exp\\left( i\\, k_{j,i} \\cdot \\delta_n \\right)$ and the conduction band energy $E_+(k_{j,i}) = t \\left| f(k_{j,i}) \\right|$ (in electronvolts). Convert the energies to joules via $E_{\\mathrm{J},j,i} = E_+(k_{j,i}) \\times (1.602176634 \\times 10^{-19})$.\n3. Fit the linear model $E_{\\mathrm{J}} \\approx S r + E_0$ by least squares over the sampled data $(r_{j}, E_{\\mathrm{J},j,i})$. Here $r_j$ repeats for each angle $\\theta_i$ at fixed radius. Extract the slope $S$ and compute $v_{\\mathrm{fit}} = S / \\hbar$.\n4. Compute the absolute error $\\varepsilon = |v_{\\mathrm{fit}} - v_{\\mathrm{true}}|$ with $v_{\\mathrm{true}} = \\frac{3 a t_{\\mathrm{J}}}{2 \\hbar}$.\n5. Repeat for all test cases and collect the errors.\n\nScientific reasoning:\n- Bloch’s theorem and the TB model provide a valid and widely used description of graphene’s band structure near the Dirac point.\n- The group velocity definition $v(k) = \\frac{1}{\\hbar} \\nabla_k E(k)$ connects the slope of the energy near $K$ to the Fermi velocity.\n- The low-energy linearization at $K$ leads to an isotropic conical dispersion, justifying linear regression of $E$ versus $|q|$ to estimate the Fermi velocity.\n- Adaptive refinement increases angular resolution and decreases radial step, improving the approximation of the linear region and thereby reducing the error in $v_{\\mathrm{fit}}$.\n\nThe program implements this algorithm, uses the specified constants, adheres to radians for angles, calculates $v_{\\mathrm{true}}$ from the derived expression $v_{\\mathrm{true}} = \\frac{3 a t_{\\mathrm{J}}}{2 \\hbar}$, and outputs a single line containing the list of absolute errors in $\\mathrm{m/s}$ for the given test suite in the specified order.",
            "answer": "[1323.518609598286,82.88048202517978,5.181285223043233,5.181285223043233,331.4116246473204]"
        }
    ]
}