{
    "hands_on_practices": [
        {
            "introduction": "电子能带结构通常沿着第一布里渊区中的高对称性路径进行绘制，以揭示材料电子性质的关键特征。在进行任何实际的能带计算之前，必须首先确定这些高对称点在倒易空间中的精确坐标。此练习旨在提供一项基础但至关重要的技能：将高对称点的常规笛卡尔坐标转换为许多计算软件所使用的原胞倒易基矢坐标，这是正确设置能带结构计算的第一步 。",
            "id": "3794761",
            "problem": "考虑两种三维布拉菲晶格，其常规立方晶格常数为 $a$：面心立方 (fcc) 晶格和体心立方 (bcc) 晶格。晶体的电子能带结构是沿着其第一布里渊区 (FBZ) 中连接特殊点的高对称性线计算的。这些特殊点由第一布里渊区的对称性确定，并且在以常规倒易立方基矢 $\\{(2\\pi/a)\\,\\hat{\\mathbf{x}},(2\\pi/a)\\,\\hat{\\mathbf{y}},(2\\pi/a)\\,\\hat{\\mathbf{z}}\\}$ 表示时，具有广泛接受的笛卡尔坐标。\n\n从以下基本定义出发：\n- fcc 的原胞直晶格矢量 $\\{\\mathbf{a}_{i}\\}$ 可选择为 $\\mathbf{a}_{1}=\\frac{a}{2}(0,1,1)$，$\\mathbf{a}_{2}=\\frac{a}{2}(1,0,1)$，$\\mathbf{a}_{3}=\\frac{a}{2}(1,1,0)$；bcc 的则可选择为 $\\mathbf{a}_{1}=\\frac{a}{2}(1,1,-1)$，$\\mathbf{a}_{2}=\\frac{a}{2}(1,-1,1)$，$\\mathbf{a}_{3}=\\frac{a}{2}(-1,1,1)$。\n- 原胞倒易晶格矢量 $\\{\\mathbf{b}_{i}\\}$ 由 $\\mathbf{b}_{i}\\cdot\\mathbf{a}_{j}=2\\pi\\,\\delta_{ij}$ 定义，其中 $i,j\\in\\{1,2,3\\}$。\n\n请使用上述定义，显式构建原胞倒易基矢 $\\{\\mathbf{b}_{i}^{\\text{(fcc)}}\\}$ 和 $\\{\\mathbf{b}_{i}^{\\text{(bcc)}}\\}$。然后，使用以下标准高对称点的公认常规笛卡尔分数坐标（在基矢 $\\{(2\\pi/a)\\,\\hat{\\mathbf{x}},(2\\pi/a)\\,\\hat{\\mathbf{y}},(2\\pi/a)\\,\\hat{\\mathbf{z}}\\}$ 下）：\n- 对于 fcc：$\\Gamma=(0,0,0)$， $X=(0,1,0)$， $L=\\left(\\frac{1}{2},\\frac{1}{2},\\frac{1}{2}\\right)$， $W=\\left(\\frac{1}{2},1,0\\right)$， $K=\\left(\\frac{3}{4},\\frac{3}{4},0\\right)$。\n- 对于 bcc：$\\Gamma=(0,0,0)$， $H=(1,0,0)$， $N=\\left(0,\\frac{1}{2},0\\right)$， $P=\\left(\\frac{1}{2},\\frac{1}{2},\\frac{1}{2}\\right)$。\n\n计算这些点在各自原胞倒易基矢下的无量纲坐标，即对 fcc 和 bcc 中列出的每个点，求出满足 $\\mathbf{k}=c_{1}\\mathbf{b}_{1}+c_{2}\\mathbf{b}_{2}+c_{3}\\mathbf{b}_{3}$ 的 $(c_{1},c_{2},c_{3})$。将您的最终答案表示为单个行矩阵，其中按顺序包含每个点的三个分量：\n- fcc 按 $\\Gamma$, $X$, $L$, $W$, $K$ 的顺序，\n- bcc 按 $\\Gamma$, $H$, $N$, $P$ 的顺序。\n\n无需四舍五入；所有条目均需表示为精确的有理数。这些条目是无量纲的，并且必须以各自的 $\\mathbf{b}_{i}$ 为单位给出。",
            "solution": "该问题陈述清晰，具有科学依据，并包含了获得唯一解所需的所有信息。我们可以开始计算。\n\n问题要求在原胞倒易晶格基矢 $\\{\\mathbf{b}_1, \\mathbf{b}_2, \\mathbf{b}_3\\}$ 下，求出第一布里渊区 (FBZ) 中各个高对称点 $\\mathbf{k}$ 的坐标 $(c_1, c_2, c_3)$。其关系由下式给出：\n$$ \\mathbf{k} = c_1\\mathbf{b}_1 + c_2\\mathbf{b}_2 + c_3\\mathbf{b}_3 $$\n\n原胞倒易晶格矢量 $\\mathbf{b}_i$ 通过它们与原胞直晶格矢量 $\\mathbf{a}_j$ 的关系定义：\n$$ \\mathbf{b}_i \\cdot \\mathbf{a}_j = 2\\pi \\delta_{ij} $$\n其中 $\\delta_{ij}$ 是克罗内克δ函数。\n\n为求出系数 $c_j$，我们可以将 $\\mathbf{k}$ 的表达式与直晶格矢量 $\\mathbf{a}_j$ 进行点积：\n$$ \\mathbf{k} \\cdot \\mathbf{a}_j = (c_1\\mathbf{b}_1 + c_2\\mathbf{b}_2 + c_3\\mathbf{b}_3) \\cdot \\mathbf{a}_j $$\n$$ \\mathbf{k} \\cdot \\mathbf{a}_j = c_1(\\mathbf{b}_1 \\cdot \\mathbf{a}_j) + c_2(\\mathbf{b}_2 \\cdot \\mathbf{a}_j) + c_3(\\mathbf{b}_3 \\cdot \\mathbf{a}_j) $$\n利用正交关系，上式可简化为：\n$$ \\mathbf{k} \\cdot \\mathbf{a}_j = c_j (2\\pi) $$\n因此，系数可以直接计算为：\n$$ c_j = \\frac{\\mathbf{k} \\cdot \\mathbf{a}_j}{2\\pi} $$\n这种方法避免了对 $\\mathbf{b}_i$ 矢量的显式计算，尽管这样的计算可以证实 fcc 直晶格对应于 bcc 倒易晶格，反之亦然。\n\n问题给出了高对称点在常规倒易立方基矢 $\\{(2\\pi/a)\\,\\hat{\\mathbf{x}},(2\\pi/a)\\,\\hat{\\mathbf{y}},(2\\pi/a)\\,\\hat{\\mathbf{z}}\\}$ 下的坐标，此处记为 $(k'_x, k'_y, k'_z)$。因此，矢量 $\\mathbf{k}$ 由下式给出：\n$$ \\mathbf{k} = \\frac{2\\pi}{a} (k'_x, k'_y, k'_z) $$\n\n将此代入 $c_j$ 的公式中：\n$$ c_j = \\frac{1}{2\\pi} \\left( \\frac{2\\pi}{a} (k'_x, k'_y, k'_z) \\right) \\cdot \\mathbf{a}_j = \\frac{1}{a} (k'_x, k'_y, k'_z) \\cdot \\mathbf{a}_j $$\n\n我们现在将此通用公式分别应用于 fcc 和 bcc 晶格。\n\n**1. 面心立方 (fcc) 晶格**\n\nfcc 的原胞直晶格矢量给出如下：\n$$ \\mathbf{a}_1^{(\\text{fcc})} = \\frac{a}{2}(0,1,1), \\quad \\mathbf{a}_2^{(\\text{fcc})} = \\frac{a}{2}(1,0,1), \\quad \\mathbf{a}_3^{(\\text{fcc})} = \\frac{a}{2}(1,1,0) $$\n\n使用推导出的 $c_j$ 公式，我们得到 fcc 晶格的具体变换方程：\n$$ c_1 = \\frac{1}{a} (k'_x, k'_y, k'_z) \\cdot \\frac{a}{2}(0,1,1) = \\frac{1}{2}(k'_y + k'_z) $$\n$$ c_2 = \\frac{1}{a} (k'_x, k'_y, k'_z) \\cdot \\frac{a}{2}(1,0,1) = \\frac{1}{2}(k'_x + k'_z) $$\n$$ c_3 = \\frac{1}{a} (k'_x, k'_y, k'_z) \\cdot \\frac{a}{2}(1,1,0) = \\frac{1}{2}(k'_x + k'_y) $$\n\n我们现在计算每个指定的 fcc 高对称点的坐标 $(c_1, c_2, c_3)$：\n- **$\\Gamma=(0,0,0)$**：$(k'_x,k'_y,k'_z)=(0,0,0)$。\n  $c_1 = \\frac{1}{2}(0+0) = 0$， $c_2 = \\frac{1}{2}(0+0) = 0$， $c_3 = \\frac{1}{2}(0+0) = 0$。坐标：$(0,0,0)$。\n- **$X=(0,1,0)$**：$(k'_x,k'_y,k'_z)=(0,1,0)$。\n  $c_1 = \\frac{1}{2}(1+0) = \\frac{1}{2}$， $c_2 = \\frac{1}{2}(0+0) = 0$，$c_3 = \\frac{1}{2}(0+1) = \\frac{1}{2}$。坐标：$(\\frac{1}{2},0,\\frac{1}{2})$。\n- **$L=(\\frac{1}{2},\\frac{1}{2},\\frac{1}{2})$**：$(k'_x,k'_y,k'_z)=(\\frac{1}{2},\\frac{1}{2},\\frac{1}{2})$。\n  $c_1 = \\frac{1}{2}(\\frac{1}{2}+\\frac{1}{2}) = \\frac{1}{2}$，$c_2 = \\frac{1}{2}(\\frac{1}{2}+\\frac{1}{2}) = \\frac{1}{2}$，$c_3 = \\frac{1}{2}(\\frac{1}{2}+\\frac{1}{2}) = \\frac{1}{2}$。坐标：$(\\frac{1}{2},\\frac{1}{2},\\frac{1}{2})$。\n- **$W=(\\frac{1}{2},1,0)$**：$(k'_x,k'_y,k'_z)=(\\frac{1}{2},1,0)$。\n  $c_1 = \\frac{1}{2}(1+0) = \\frac{1}{2}$，$c_2 = \\frac{1}{2}(\\frac{1}{2}+0) = \\frac{1}{4}$，$c_3 = \\frac{1}{2}(\\frac{1}{2}+1) = \\frac{3}{4}$。坐标：$(\\frac{1}{2},\\frac{1}{4},\\frac{3}{4})$。\n- **$K=(\\frac{3}{4},\\frac{3}{4},0)$**：$(k'_x,k'_y,k'_z)=(\\frac{3}{4},\\frac{3}{4},0)$。\n  $c_1 = \\frac{1}{2}(\\frac{3}{4}+0) = \\frac{3}{8}$，$c_2 = \\frac{1}{2}(\\frac{3}{4}+0) = \\frac{3}{8}$，$c_3 = \\frac{1}{2}(\\frac{3}{4}+\\frac{3}{4}) = \\frac{3}{4}$。坐标：$(\\frac{3}{8},\\frac{3}{8},\\frac{3}{4})$。\n\n**2. 体心立方 (bcc) 晶格**\n\nbcc 的原胞直晶格矢量给出如下：\n$$ \\mathbf{a}_1^{(\\text{bcc})} = \\frac{a}{2}(1,1,-1), \\quad \\mathbf{a}_2^{(\\text{bcc})} = \\frac{a}{2}(1,-1,1), \\quad \\mathbf{a}_3^{(\\text{bcc})} = \\frac{a}{2}(-1,1,1) $$\n\nbcc 晶格的具体变换方程为：\n$$ c_1 = \\frac{1}{a} (k'_x, k'_y, k'_z) \\cdot \\frac{a}{2}(1,1,-1) = \\frac{1}{2}(k'_x + k'_y - k'_z) $$\n$$ c_2 = \\frac{1}{a} (k'_x, k'_y, k'_z) \\cdot \\frac{a}{2}(1,-1,1) = \\frac{1}{2}(k'_x - k'_y + k'_z) $$\n$$ c_3 = \\frac{1}{a} (k'_x, k'_y, k'_z) \\cdot \\frac{a}{2}(-1,1,1) = \\frac{1}{2}(-k'_x + k'_y + k'_z) $$\n\n我们现在计算每个指定的 bcc 高对称点的坐标 $(c_1, c_2, c_3)$：\n- **$\\Gamma=(0,0,0)$**：$(k'_x,k'_y,k'_z)=(0,0,0)$。\n  $c_1=0$，$c_2=0$，$c_3=0$。坐标：$(0,0,0)$。\n- **$H=(1,0,0)$**：$(k'_x,k'_y,k'_z)=(1,0,0)$。\n  $c_1 = \\frac{1}{2}(1+0-0) = \\frac{1}{2}$，$c_2 = \\frac{1}{2}(1-0+0) = \\frac{1}{2}$，$c_3 = \\frac{1}{2}(-1+0+0) = -\\frac{1}{2}$。坐标：$(\\frac{1}{2},\\frac{1}{2},-\\frac{1}{2})$。\n- **$N=(0,\\frac{1}{2},0)$**：$(k'_x,k'_y,k'_z)=(0,\\frac{1}{2},0)$。\n  $c_1 = \\frac{1}{2}(0+\\frac{1}{2}-0) = \\frac{1}{4}$，$c_2 = \\frac{1}{2}(0-\\frac{1}{2}+0) = -\\frac{1}{4}$，$c_3 = \\frac{1}{2}(0+\\frac{1}{2}+0) = \\frac{1}{4}$。坐标：$(\\frac{1}{4},-\\frac{1}{4},\\frac{1}{4})$。\n- **$P=(\\frac{1}{2},\\frac{1}{2},\\frac{1}{2})$**：$(k'_x,k'_y,k'_z)=(\\frac{1}{2},\\frac{1}{2},\\frac{1}{2})$。\n  $c_1 = \\frac{1}{2}(\\frac{1}{2}+\\frac{1}{2}-\\frac{1}{2}) = \\frac{1}{4}$，$c_2 = \\frac{1}{2}(\\frac{1}{2}-\\frac{1}{2}+\\frac{1}{2}) = \\frac{1}{4}$，$c_3 = \\frac{1}{2}(-\\frac{1}{2}+\\frac{1}{2}+\\frac{1}{2}) = \\frac{1}{4}$。坐标：$(\\frac{1}{4},\\frac{1}{4},\\frac{1}{4})$。\n\n计算结果均为所要求的精确有理数。我们将它们按指定顺序合并成一个单一的行矩阵。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 0 & 0 & 0 & \\frac{1}{2} & 0 & \\frac{1}{2} & \\frac{1}{2} & \\frac{1}{2} & \\frac{1}{2} & \\frac{1}{2} & \\frac{1}{4} & \\frac{3}{4} & \\frac{3}{8} & \\frac{3}{8} & \\frac{3}{4} & 0 & 0 & 0 & \\frac{1}{2} & \\frac{1}{2} & -\\frac{1}{2} & \\frac{1}{4} & -\\frac{1}{4} & \\frac{1}{4} & \\frac{1}{4} & \\frac{1}{4} & \\frac{1}{4} \\end{pmatrix} } $$"
        },
        {
            "introduction": "在确定了计算路径之后，下一步是实际求解薛定谔方程以获得能带。平面波基组方法是计算周期性固态体系电子结构的标准工具，但其计算精度和成本强烈依赖于所选的动能截断能 $E_{\\text{cut}}$。本练习通过一个简化的模型，指导您亲手实现一个收敛性测试过程，这是确保任何模拟结果可靠性和准确性的核心步骤，也是计算材料科学家必须掌握的关键实践技能 。",
            "id": "3739438",
            "problem": "考虑一个一维周期势模型，该模型旨在定性地模拟硅的电子结构特征，同时在平面波基组下保持计算上的可处理性。该系统由单粒子不含时薛定谔方程所描述，描述的是一个质量为 $m_e$ 的电子在晶格常数为 $a$ 的周期势 $V(x)$ 中的行为，方程表达式为 $-\\frac{\\hbar^2}{2 m_e} \\frac{d^2}{dx^2} \\psi(x) + V(x) \\psi(x) = E \\psi(x)$。根据布洛赫定理，本征态可以写成 $\\psi_{n,k}(x) = e^{i k x} u_{n,k}(x)$ 的形式，其中 $u_{n,k}(x)$ 具有晶格的周期性。在平面波基组中展开，会得到一个在倒易空间中的矩阵哈密顿量，其索引为倒易晶格矢量 $G$ 和 $G'$：\n$$\nH_{G,G'}(k) = \\delta_{G,G'} \\left( \\frac{\\hbar^2}{2 m_e} \\left| k + G \\right|^2 \\right) + V_{G - G'}\n$$\n其中 $V_{q}$ 是周期势的傅里叶分量，$\\delta_{G,G'}$ 是克罗内克 δ。倒易晶格矢量为 $G = n G_0$，其中 $n \\in \\mathbb{Z}$ 且 $G_0 = \\frac{2 \\pi}{a}$。在本问题中，使用一个由两个非零傅里叶分量 $V_{G_0}$ 和 $V_{2 G_0}$ 指定的可转移局域赝势，其他所有 $V_q$ 均为 0。对于所有体积，取 $V_{G_0} = -5.0$ eV 和 $V_{2 G_0} = +1.5$ eV，这构成了一个旨在模拟间接带隙的打开和有限价带宽的模型，其特性与硅相似。使用物理常数 $\\frac{\\hbar^2}{2 m_e} = 3.8099819443$ eV·Å$^2$。\n\n为了体现平面波基组的截断，施加一个动能截断 $E_{\\text{cut}}$，即只包含那些在 $k = 0$ 时的自由电子动能满足 $\\frac{\\hbar^2}{2 m_e} G^2 \\le E_{\\text{cut}}$ 的倒易晶格矢量 $G$。对于每个选定的 $E_{\\text{cut}}$，在第一布里渊区从 $0$ 到 $\\pi/a$ 的均匀波数 $k$ 网格上构建哈密顿量 $H(k)$，对角化 $H(k)$ 以获得能带能量 $E_n(k)$（按升序排列），并定义价带为 $n_v = 1$，导带为 $n_c = 2$。这种索引方式对应于一个物理上合理的假设，即在一维绝缘体中，在近自由电子近似下，第一和第二能带之间存在一个主带隙。价带宽为 $W_v = \\max_k E_{n_v}(k) - \\min_k E_{n_v}(k)$，间接带隙为 $\\Delta_{\\text{ind}} = \\min_k E_{n_c}(k) - \\max_k E_{n_v}(k)$，能量以电子伏特表示。\n\n您的任务是计算 $\\Delta_{\\text{ind}}$ 和 $W_v$ 相对于 $E_{\\text{cut}}$ 的收敛性，并通过在不同的晶格常数 $a$ 下重复分析来评估赝势在不同体积下的可转移性。使用以下测试套件：\n\n- 晶格常数 (单位 Å): $a_1 = 5.43$, $a_2 = 5.30$, $a_3 = 5.60$。\n- 待测试的能量截断 (单位 eV): $E_{\\text{cut}} \\in \\{ 4, 6, 8, 12, 16, 24, 32, 48 \\}$。\n- 参考能量截断 (单位 eV): $E_{\\text{ref}} = 80$。\n- 容差 (单位 eV): 间接带隙 $\\varepsilon_{\\Delta} = 0.01$，价带宽 $\\varepsilon_W = 0.01$。\n- 波数网格：在 $[0, \\pi/a]$ 区间内均匀采样 $201$ 个 $k$ 点。\n\n对于每个晶格常数 $a$，使用 $E_{\\text{ref}}$ 计算参考值 $\\Delta_{\\text{ind}}^{\\text{ref}}(a)$ 和 $W_v^{\\text{ref}}(a)$。然后，对于测试列表中的每个 $E_{\\text{cut}}$，计算 $\\Delta_{\\text{ind}}(a; E_{\\text{cut}})$ 和 $W_v(a; E_{\\text{cut}})$，并确定满足 $\\left| \\Delta_{\\text{ind}}(a; E_{\\text{cut}}) - \\Delta_{\\text{ind}}^{\\text{ref}}(a) \\right| \\le \\varepsilon_{\\Delta}$ 的最小 $E_{\\text{cut}}$ 和满足 $\\left| W_v(a; E_{\\text{cut}}) - W_v^{\\text{ref}}(a) \\right| \\le \\varepsilon_W$ 的最小 $E_{\\text{cut}}$。如果在给定的 $a$ 下，测试列表中的所有 $E_{\\text{cut}}$ 都不能使某个属性满足容差要求，则报告 $-1$ 作为该条目的结果。能量和截断值以电子伏特 (eV) 为单位，距离以埃 (Å) 为单位。波数 $k$ 以倒埃 (Å$^{-1}$) 为单位。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。该列表必须按以下顺序包含六个数字：在 $a_1$ 处间接带隙的最小 $E_{\\text{cut}}$，在 $a_1$ 处价带宽的最小 $E_{\\text{cut}}$，然后是 $a_2$ 对应的两个值，最后是 $a_3$ 对应的两个值。例如，输出格式必须类似于 $[x_1, y_1, x_2, y_2, x_3, y_3]$，其中每个 $x_i$ 和 $y_i$ 都是以 eV 为单位的浮点数。",
            "solution": "该问题要求计算一维周期性系统的间接带隙和价带宽，并研究它们相对于平面波能量截断参数 $E_{\\text{cut}}$ 的收敛性。这是计算材料科学中的一个标准流程，用以确保模拟结果的可靠性。分析将在三种不同的晶格常数 $a$ 下进行，以评估所提供赝势的可转移性。\n\n这个问题的基础是描述质量为 $m_e$ 的电子在周期势 $V(x)$ 中运动的单粒子不含时薛定谔方程：\n$$\n\\left[ -\\frac{\\hbar^2}{2 m_e} \\frac{d^2}{dx^2} + V(x) \\right] \\psi(x) = E \\psi(x)\n$$\n由于势的周期性 $V(x) = V(x+a)$，布洛赫定理指出，本征态可以写成 $\\psi_{n,k}(x) = e^{ikx} u_{n,k}(x)$ 的形式，其中 $u_{n,k}(x)$ 是一个与晶格具有相同周期性的周期函数，$k$ 是限制在第一布里渊区内的波数，对于一维晶格，该区域为 $[-\\pi/a, \\pi/a]$。\n\n周期函数 $u_{n,k}(x)$ 可以在倒易晶格矢量 $G = n G_0$（其中 $G_0 = 2\\pi/a$ 且 $n \\in \\mathbb{Z}$）上展开为傅里叶级数：\n$$\nu_{n,k}(x) = \\sum_{G} c_{k,G} e^{iGx}\n$$\n将此代入薛定谔方程，得到倒易空间中的一个本征值问题。哈密顿量变成一个矩阵，其矩阵元由倒易晶格矢量 $G$ 和 $G'$ 索引：\n$$\nH_{G,G'}(k) = \\delta_{G,G'} \\left( \\frac{\\hbar^2}{2 m_e} |k+G|^2 \\right) + V_{G-G'}\n$$\n这里，$\\delta_{G,G'}$ 是克罗内克 δ，$V_{G-G'}$ 是势 $V(x)$ 的傅里叶系数。对于一个物理的、实的势 $V(x)$，其傅里叶系数必须满足 $V_q = V_{-q}^*$。问题给出了 $V_q$ 的实数值，这意味着 $V_q = V_{-q}$。给定两个非零的势分量：$V_{G_0} = -5.0 \\text{ eV}$ 和 $V_{2G_0} = +1.5 \\text{ eV}$。因此我们假设 $V_{-G_0} = V_{G_0}$ 和 $V_{-2G_0} = V_{2G_0}$。所有其他分量，包括 $V_0$，都为零。常数 $\\frac{\\hbar^2}{2m_e}$ 给定为 $3.8099819443 \\text{ eV} \\cdot \\text{Å}^2$。\n\n在任何实际计算中，对 $G$ 的无限求和都必须截断。问题指定了一种动能截断方案：基组只包含那些在 $k=0$ 时的自由电子动能低于截断值 $E_{\\text{cut}}$ 的倒易晶格矢量 $G$。\n$$\n\\frac{\\hbar^2}{2 m_e} G^2 \\le E_{\\text{cut}}\n$$\n代入 $G = n G_0 = n \\frac{2\\pi}{a}$，我们可以找到基组的最大整数 $N_{\\text{max}}$：\n$$\n\\frac{\\hbar^2}{2 m_e} \\left( n \\frac{2\\pi}{a} \\right)^2 \\le E_{\\text{cut}} \\implies n^2 \\le \\frac{E_{\\text{cut}} a^2}{4\\pi^2 (\\hbar^2 / 2m_e)}\n$$\n因此，$N_{\\text{max}}(a, E_{\\text{cut}}) = \\left\\lfloor \\sqrt{\\frac{E_{\\text{cut}} a^2}{4\\pi^2 (\\hbar^2 / 2m_e)}} \\right\\rfloor$。基组将由 $n \\in \\{-N_{\\text{max}}, \\dots, N_{\\text{max}}\\}$ 的 $G_n = nG_0$ 组成。哈密顿矩阵的大小将是 $(2N_{\\text{max}} + 1) \\times (2N_{\\text{max}} + 1)$。为了使问题有意义（即，至少获得两个能带，$n_v=1$ 和 $n_c=2$），矩阵大小必须至少为 $2 \\times 2$，这意味着 $N_{\\text{max}} \\ge 1$。如果选定的 $E_{\\text{cut}}$ 导致 $N_{\\text{max}} < 1$，则不执行该截断值的计算，因为所需的量是未定义的。\n\n计算步骤如下：\n1. 对于每个晶格常数 $a \\in \\{5.43, 5.30, 5.60\\}$ Å：\n    a. 在 $[0, \\pi/a]$ 范围内生成一个包含 $201$ 个波数 $k$ 的均匀网格。\n    b. 使用一个高的参考截断值 $E_{\\text{ref}} = 80 \\text{ eV}$ 计算间接带隙 $\\Delta_{\\text{ind}}^{\\text{ref}}(a)$ 和价带宽 $W_v^{\\text{ref}}(a)$ 的参考值。\n    c. 对于每个测试截断值 $E_{\\text{cut}} \\in \\{4, 6, 8, 12, 16, 24, 32, 48\\}$ eV，计算 $\\Delta_{\\text{ind}}(a; E_{\\text{cut}})$ 和 $W_v(a; E_{\\text{cut}})$。这包括：\n        i. 对于给定的 $a$ 和 $E_{\\text{cut}}$，确定 $N_{\\text{max}}$。\n        ii. 对于网格上的每个 $k$，构建 $(2N_{\\text{max}}+1) \\times (2N_{\\text{max}}+1)$ 的哈密顿矩阵 $H(k)$。该矩阵是厄米矩阵（在本例中为实对称矩阵）。\n        iii. 对角化 $H(k)$ 以获得其本征值，即能带能量 $E_n(k)$。这些值按升序排序。\n        iv. 遍历所有 $k$ 后，价带宽计算为 $W_v = \\max_k E_1(k) - \\min_k E_1(k)$，间接带隙计算为 $\\Delta_{\\text{ind}} = \\min_k E_2(k) - \\max_k E_1(k)$。\n    d. 从测试列表中找到满足相对于参考值的绝对误差在容差范围内的最小 $E_{\\text{cut}}$：对于带隙，要求 $|\\Delta_{\\text{ind}} - \\Delta_{\\text{ind}}^{\\text{ref}}| \\le \\varepsilon_{\\Delta}$（$\\varepsilon_{\\Delta} = 0.01$ eV）；对于带宽，要求 $|W_v - W_v^{\\text{ref}}| \\le \\varepsilon_W$（$\\varepsilon_W = 0.01$ eV）。如果列表中不存在这样的截断值，则报告 $-1$。\n\n对三个晶格常数中的每一个重复此过程，得出六个关于最小收敛能量截断的最终值。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the convergence of indirect band gap and valence bandwidth\n    with respect to the plane-wave energy cutoff for a 1D crystal model.\n    \"\"\"\n    \n    # --- Givens from the problem statement ---\n    \n    # Physical and model parameters\n    HBAR2_2M = 3.8099819443  # eV·Å^2\n    V_G0 = -5.0  # eV\n    V_2G0 = +1.5  # eV\n    \n    # Test suite parameters\n    LATTICE_CONSTANTS = [5.43, 5.30, 5.60]  # in Å\n    ENERGY_CUTOFFS = [4, 6, 8, 12, 16, 24, 32, 48]  # in eV\n    E_REF = 80.0  # in eV\n    EPS_DELTA = 0.01  # Tolerance for indirect gap in eV\n    EPS_W = 0.01  # Tolerance for valence bandwidth in eV\n    K_POINTS = 201\n    \n    # Dictionary of potential components\n    # V_q = V_{-q} because V(x) is real\n    POTENTIAL_FOURIER = {\n        1: V_G0,\n        -1: V_G0,\n        2: V_2G0,\n        -2: V_2G0,\n    }\n\n    def calculate_properties(a, e_cut, k_grid):\n        \"\"\"\n        Calculates band structure properties for a given lattice constant and energy cutoff.\n        \"\"\"\n        g0 = 2 * np.pi / a\n        \n        # Determine the size of the plane-wave basis set\n        n_max_sq = (e_cut * a**2) / (4 * np.pi**2 * HBAR2_2M)\n        n_max = int(np.floor(np.sqrt(n_max_sq)))\n        \n        # The problem requires at least two bands. If basis size  2, properties are undefined.\n        if 2 * n_max + 1  2:\n            return None, None\n            \n        n_values = np.arange(-n_max, n_max + 1)\n        matrix_size = len(n_values)\n        \n        e1_k = np.zeros(len(k_grid))\n        e2_k = np.zeros(len(k_grid))\n        \n        # Construct and diagonalize the Hamiltonian for each k-point\n        for i, k in enumerate(k_grid):\n            H = np.zeros((matrix_size, matrix_size), dtype=np.complex128)\n            \n            # Populate Hamiltonian matrix\n            for row in range(matrix_size):\n                for col in range(matrix_size):\n                    n_row = n_values[row]\n                    n_col = n_values[col]\n                    \n                    # Kinetic energy term (diagonal)\n                    if row == col:\n                        H[row, col] += HBAR2_2M * (k + n_row * g0)**2\n                    \n                    # Potential term (off-diagonal)\n                    n_diff = n_row - n_col\n                    if n_diff in POTENTIAL_FOURIER:\n                        H[row, col] += POTENTIAL_FOURIER[n_diff]\n            \n            # Diagonalize the Hermitian matrix to find eigenvalues (band energies)\n            eigenvalues = np.linalg.eigh(H)[0]\n            \n            # Store the first two bands (sorted by eigh)\n            e1_k[i] = eigenvalues[0]\n            e2_k[i] = eigenvalues[1]\n            \n        # Calculate valence bandwidth and indirect band gap\n        w_v = np.max(e1_k) - np.min(e1_k)\n        delta_ind = np.min(e2_k) - np.max(e1_k)\n        \n        return delta_ind, w_v\n\n    final_results = []\n    \n    for a in LATTICE_CONSTANTS:\n        k_grid = np.linspace(0, np.pi / a, K_POINTS)\n        \n        # 1. Calculate reference values with E_ref\n        delta_ref, w_v_ref = calculate_properties(a, E_REF, k_grid)\n\n        # Storage for results for the current lattice constant\n        cutoff_results = {}\n        \n        # 2. Calculate properties for each test E_cut\n        for e_cut in ENERGY_CUTOFFS:\n            delta, w_v = calculate_properties(a, float(e_cut), k_grid)\n            cutoff_results[e_cut] = (delta, w_v)\n            \n        # 3. Find the minimum E_cut satisfying the convergence criteria\n        min_e_cut_delta = -1.0\n        min_e_cut_w_v = -1.0\n        \n        for e_cut in sorted(cutoff_results.keys()):\n            delta, w_v = cutoff_results[e_cut]\n            \n            if delta is not None:\n                # Check convergence for indirect gap\n                if min_e_cut_delta == -1.0 and abs(delta - delta_ref) = EPS_DELTA:\n                    min_e_cut_delta = float(e_cut)\n                \n                # Check convergence for valence bandwidth\n                if min_e_cut_w_v == -1.0 and abs(w_v - w_v_ref) = EPS_W:\n                    min_e_cut_w_v = float(e_cut)\n\n        final_results.extend([min_e_cut_delta, min_e_cut_w_v])\n        \n    # 4. Format and print the final output\n    print(f\"[{','.join(map(str, final_results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "掌握了能带结构的基本计算和收敛性测试后，我们可以进入更高级的应用：从能带图中提取可测量的物理量。石墨烯及其独特的线性色散狄拉克锥提供了一个绝佳的研究范例，其载流子的行为由费米速度 $v_F$ 描述，而该速度可由能带在狄拉克点附近的斜率确定。此练习模拟了一项真实的研究任务，要求您构建一个自适应的 $k$ 点网格，以精确计算费米速度，从而将理论计算与关键物理性质直接联系起来 。",
            "id": "3794760",
            "problem": "你的任务是在 graphene 的 Dirac 锥周围构建一个自适应波矢网格，并量化计算出的费米速度随网格细化变化的误差。物理模型基于对 graphene 蜂窝晶格的最近邻紧束缚描述，费米速度将从 Dirac 点附近导带能量的斜率中提取。\n\n从以下基本基础开始：\n- Bloch 定理指出，周期性晶体中的电子态可以通过波矢 $k$ 和能量色散 $E(k)$ 来表征，其群速度由 $v(k) = \\frac{1}{\\hbar} \\nabla_k E(k)$ 给出，其中 $\\hbar$ 是约化普朗克常数。\n- 在 graphene 蜂窝晶格的最近邻紧束缚 (TB) 模型中，子晶格基矢 $\\{A,B\\}$ 下的 Bloch 哈密顿量形式如下\n$$\nH(k) = \\begin{pmatrix}\n0  -t f(k) \\\\\n-t f^*(k)  0\n\\end{pmatrix},\n$$\n其中 $t$ 是最近邻跃迁能量，$f(k) = \\sum_{i=1}^{3} \\exp\\left(i\\, k \\cdot \\delta_i\\right)$ 是三个最近邻矢量 $\\delta_i$ 的相位贡献之和。能量色散为 $E_{\\pm}(k) = \\pm t \\left| f(k) \\right|$。\n- Dirac 点 $K$ 是满足 $f(k)=0$ 的波矢 $k$。在 $K$ 点附近，能带色散是线性的。\n\n使用以下科学上一致且自洽的规范：\n- 以最近邻距离 $a$ 表示，在笛卡尔坐标系中的最近邻位移矢量为\n$$\n\\delta_1 = a \\,(0,1), \\quad\n\\delta_2 = a \\left(\\frac{\\sqrt{3}}{2}, -\\frac{1}{2}\\right), \\quad\n\\delta_3 = a \\left(-\\frac{\\sqrt{3}}{2}, -\\frac{1}{2}\\right).\n$$\n- 与上述选择一致的一个 Dirac 点（Brillouin zone 的一个角点）是\n$$\nK = \\left(\\frac{4\\pi}{3\\sqrt{3}\\,a}, \\, 0\\right).\n$$\n- 物理常数和参数：\n  - 最近邻距离 $a = 1.42 \\times 10^{-10}\\ \\mathrm{m}$。\n  - 最近邻跃迁能量 $t = 2.7\\ \\mathrm{eV}$。\n  - 约化普朗克常数 $\\hbar = 1.054571817 \\times 10^{-34}\\ \\mathrm{J\\,s}$。\n  - 能量转换必须使用 $1\\ \\mathrm{eV} = 1.602176634 \\times 10^{-19}\\ \\mathrm{J}$ 进行。\n- 对任何角度量均使用弧度。\n- 通过对 $q = k - K$ 进行极坐标采样，在 Dirac 点 $K$ 周围构建一个自适应波矢 $k$ 网格：\n  - 对于给定的细化等级 $\\ell \\in \\mathbb{N}$，定义角分辨率 $N_\\theta(\\ell) = N_{\\theta,0}\\, 2^\\ell$ 和径向步长 $\\Delta r(\\ell) = \\Delta r_0 / 2^\\ell$。\n  - 对于每个 $\\ell$，对整数 $j = 1,2,\\dots,M(\\ell)$（其中 $M(\\ell) = \\left\\lfloor r_{\\max} / \\Delta r(\\ell) \\right\\rfloor$）采样半径 $r_j = j\\, \\Delta r(\\ell)$，并对 $i = 0,1,\\dots,N_\\theta(\\ell)-1$ 采样角度 $\\theta_i = \\frac{2\\pi i}{N_\\theta(\\ell)}$。\n  - 构建网格点 $k_{j,i} = K + r_j \\left(\\cos \\theta_i, \\sin \\theta_i\\right)$。\n- 根据上面给出的 TB 模型，计算每个网格点上的导带能量 $E_+(k)$。将能量转换为焦耳，并通过最小二乘法对标量径向变量 $r = |q|$ 拟合线性模型 $E \\approx S r + E_0$。推断出费米速度的估计值 $v_{\\mathrm{fit}} = S / \\hbar$。拟合应包含截距 $E_0$ 以避免数值曲率带来的偏差；然而，费米速度必须仅从斜率 $S$ 通过 $S/\\hbar$ 提取。\n- 量化计算出的费米速度相对于从上述 TB 模型在 $K$ 点附近通过第一性原理推导出的真实费米速度 $v_{\\mathrm{true}}$ 的绝对误差：\n$$\n\\varepsilon = \\left| v_{\\mathrm{fit}} - v_{\\mathrm{true}} \\right|.\n$$\n以 $\\mathrm{m/s}$ 为单位，将最终误差值表示为浮点数。\n\n你的程序必须实现上述过程，并为以下测试套件生成数值结果，该测试套件旨在评估自适应网格的不同方面：\n- 测试用例 1：$(\\ell, N_{\\theta,0}, \\Delta r_0, r_{\\max}) = (0, 8, 1.0 \\times 10^{8}\\ \\mathrm{m}^{-1}, 5.0 \\times 10^{8}\\ \\mathrm{m}^{-1})$。\n- 测试用例 2：$(\\ell, N_{\\theta,0}, \\Delta r_0, r_{\\max}) = (1, 8, 1.0 \\times 10^{8}\\ \\mathrm{m}^{-1}, 5.0 \\times 10^{8}\\ \\mathrm{m}^{-1})$。\n- 测试用例 3：$(\\ell, N_{\\theta,0}, \\Delta r_0, r_{\\max}) = (2, 8, 1.0 \\times 10^{8}\\ \\mathrm{m}^{-1}, 5.0 \\times 10^{8}\\ \\mathrm{m}^{-1})$。\n- 测试用例 4：$(\\ell, N_{\\theta,0}, \\Delta r_0, r_{\\max}) = (2, 4, 1.0 \\times 10^{8}\\ \\mathrm{m}^{-1}, 5.0 \\times 10^{8}\\ \\mathrm{m}^{-1})$。\n- 测试用例 5：$(\\ell, N_{\\theta,0}, \\Delta r_0, r_{\\max}) = (2, 8, 1.0 \\times 10^{8}\\ \\mathrm{m}^{-1}, 2.0 \\times 10^{9}\\ \\mathrm{m}^{-1})$。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按上述测试用例的顺序排列，例如 $[\\varepsilon_1,\\varepsilon_2,\\varepsilon_3,\\varepsilon_4,\\varepsilon_5]$，其中每个 $\\varepsilon_i$ 是测试用例 $i$ 的绝对误差，单位为 $\\mathrm{m/s}$。",
            "solution": "graphene 蜂窝晶格可以在子晶格基矢 $\\{A,B\\}$ 下使用最近邻紧束缚 (TB) 哈密顿量进行建模，\n$$\nH(k) = \\begin{pmatrix}\n0  -t f(k) \\\\\n-t f^*(k)  0\n\\end{pmatrix},\n$$\n其中非对角项编码了从子晶格 $A$ 到 $B$ 的跃迁以及反向跃迁，$t$ 是最近邻跃迁能量，$f(k)$ 是由三个最近邻矢量贡献的相因子之和。对于最近邻距离为 $a$ 的蜂窝晶格，位移矢量选择为\n$$\n\\delta_1 = a \\,(0,1), \\quad\n\\delta_2 = a \\left(\\frac{\\sqrt{3}}{2}, -\\frac{1}{2}\\right), \\quad\n\\delta_3 = a \\left(-\\frac{\\sqrt{3}}{2}, -\\frac{1}{2}\\right).\n$$\n那么函数 $f(k)$ 是\n$$\nf(k) = \\sum_{i=1}^{3} \\exp\\left(i\\, k \\cdot \\delta_i\\right) = \\exp\\left(i\\, k \\cdot \\delta_1\\right) + \\exp\\left(i\\, k \\cdot \\delta_2\\right) + \\exp\\left(i\\, k \\cdot \\delta_3\\right).\n$$\n能带能量为\n$$\nE_{\\pm}(k) = \\pm t \\left| f(k) \\right|.\n$$\n\nDirac 点出现在 $f(k) = 0$ 的地方。对于上述 $\\delta_i$ 的选择，一个 Dirac 点位于\n$$\nK = \\left(\\frac{4\\pi}{3\\sqrt{3}\\,a}, \\, 0\\right),\n$$\n这可以通过计算 $f(K)$ 来验证：\n$$\nK \\cdot \\delta_1 = 0 \\Rightarrow \\exp\\left(i\\,K\\cdot \\delta_1\\right) = 1,\n$$\n$$\nK \\cdot \\delta_2 = a \\left(\\frac{\\sqrt{3}}{2}\\right) \\frac{4\\pi}{3\\sqrt{3}\\,a} = \\frac{2\\pi}{3} \\Rightarrow \\exp\\left(i\\,K\\cdot \\delta_2\\right) = \\exp\\left(i\\,\\frac{2\\pi}{3}\\right),\n$$\n$$\nK \\cdot \\delta_3 = -\\frac{2\\pi}{3} \\Rightarrow \\exp\\left(i\\,K\\cdot \\delta_3\\right) = \\exp\\left(-i\\,\\frac{2\\pi}{3}\\right),\n$$\n因此\n$$\nf(K) = 1 + 2 \\cos\\left(\\frac{2\\pi}{3}\\right) = 1 + 2\\left(-\\frac{1}{2}\\right) = 0.\n$$\n\n在 $K$ 点附近，定义 $q = k - K$。$f(K+q)$ 在 $q$ 的一阶低能展开，在忽略一个总体相位的情况下，会得到一个与 $|q|$ 相关的各向同性线性依赖关系。具体来说，可以发现\n$$\nf(K+q) \\approx \\frac{3a}{2}\\left(q_x - i q_y\\right) \\times (\\text{phase}),\n$$\n因此，导带能量（以电子伏特为单位）近似为\n$$\nE_+(K+q) \\approx t \\left| f(K+q) \\right| \\approx t \\cdot \\frac{3a}{2} |q|.\n$$\n为将能量转换为焦耳，使用 $t_{\\mathrm{J}} = t \\times (1.602176634 \\times 10^{-19})$ 并将能量写为\n$$\nE_{\\mathrm{J}}(K+q) \\approx t_{\\mathrm{J}} \\cdot \\frac{3a}{2} |q|.\n$$\n群速度是能量相对于 $|q|$ 的斜率除以 $\\hbar$，即\n$$\nv_{\\mathrm{true}} = \\frac{1}{\\hbar} \\frac{d E_{\\mathrm{J}}}{d |q|} = \\frac{1}{\\hbar} \\left( t_{\\mathrm{J}} \\cdot \\frac{3a}{2} \\right) = \\frac{3 a t_{\\mathrm{J}}}{2 \\hbar}.\n$$\n\n算法规划：\n1. 使用极坐标采样在 $K$ 点周围构建自适应网格。对于细化等级 $\\ell$，定义 $N_\\theta(\\ell) = N_{\\theta,0} \\, 2^\\ell$ 个角度样本和径向步长 $\\Delta r(\\ell) = \\Delta r_0 / 2^\\ell$。对 $j = 1,2,\\dots, M(\\ell)$（其中 $M(\\ell) = \\left\\lfloor r_{\\max} / \\Delta r(\\ell) \\right\\rfloor$）采样半径 $r_j = j \\Delta r(\\ell)$。对于每个半径和角度 $\\theta_i = \\frac{2\\pi i}{N_\\theta(\\ell)}$，形成波矢 $k_{j,i} = K + r_j(\\cos\\theta_i,\\sin\\theta_i)$。\n2. 在每个 $k_{j,i}$ 处，计算 $f(k_{j,i}) = \\sum_{n=1}^{3} \\exp\\left( i\\, k_{j,i} \\cdot \\delta_n \\right)$ 和导带能量 $E_+(k_{j,i}) = t \\left| f(k_{j,i}) \\right|$（以电子伏特为单位）。通过 $E_{\\mathrm{J},j,i} = E_+(k_{j,i}) \\times (1.602176634 \\times 10^{-19})$ 将能量转换为焦耳。\n3. 对采样数据 $(r_{j}, E_{\\mathrm{J},j,i})$ 通过最小二乘法拟合线性模型 $E_{\\mathrm{J}} \\approx S r + E_0$。此处，对于固定的半径，每个角度 $\\theta_i$ 都对应一个 $r_j$。提取斜率 $S$ 并计算 $v_{\\mathrm{fit}} = S / \\hbar$。\n4. 计算绝对误差 $\\varepsilon = |v_{\\mathrm{fit}} - v_{\\mathrm{true}}|$，其中 $v_{\\mathrm{true}} = \\frac{3 a t_{\\mathrm{J}}}{2 \\hbar}$。\n5. 对所有测试用例重复此过程并收集误差。\n\n科学推理：\n- Bloch 定理和 TB 模型为 Dirac 点附近的 graphene 能带结构提供了有效且广泛使用的描述。\n- 群速度的定义 $v(k) = \\frac{1}{\\hbar} \\nabla_k E(k)$ 将 $K$ 点附近能量的斜率与费米速度联系起来。\n- $K$ 点处的低能线性化导致了各向同性的锥形色散，这为通过 $E$ 对 $|q|$ 进行线性回归来估计费米速度提供了依据。\n- 自适应细化增加了角分辨率并减小了径向步长，从而改善了对线性区域的近似，并因此减小了 $v_{\\mathrm{fit}}$ 中的误差。\n\n该程序实现了此算法，使用指定的常数，对角度采用弧度制，根据推导出的表达式 $v_{\\mathrm{true}} = \\frac{3 a t_{\\mathrm{J}}}{2 \\hbar}$ 计算 $v_{\\mathrm{true}}$，并输出一行包含给定测试套件的绝对误差列表（单位为 $\\mathrm{m/s}$），顺序与指定一致。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Physical constants\nHBAR = 1.054571817e-34  # J*s\nEV_TO_J = 1.602176634e-19  # J per eV\n\n# Graphene parameters\na = 1.42e-10  # nearest-neighbor distance in meters\nt_eV = 2.7  # hopping in eV\nt_J = t_eV * EV_TO_J  # hopping in Joules\n\n# Nearest-neighbor displacement vectors (meters)\ndeltas = np.array([\n    [0.0, 1.0],\n    [np.sqrt(3)/2.0, -0.5],\n    [-np.sqrt(3)/2.0, -0.5]\n], dtype=float) * a\n\n# Dirac point K consistent with chosen deltas\nKx = 4.0 * np.pi / (3.0 * np.sqrt(3.0) * a)\nKy = 0.0\n\ndef f_k(kx, ky):\n    \"\"\"Compute f(k) = sum_i exp(i k · δ_i) for arrays kx, ky.\"\"\"\n    # Vectorized computation over deltas\n    f = np.zeros_like(kx, dtype=np.complex128)\n    for d in deltas:\n        f += np.exp(1j * (kx * d[0] + ky * d[1]))\n    return f\n\ndef compute_v_true():\n    \"\"\"Analytical Fermi velocity from linearization: v_true = 3 a t_J / (2 hbar).\"\"\"\n    return (3.0 * a * t_J) / (2.0 * HBAR)\n\ndef compute_error_for_case(L, N_theta0, dr0, r_max):\n    \"\"\"\n    Compute the absolute error in the fitted Fermi velocity for a given refinement case.\n    L: refinement level (int)\n    N_theta0: base number of angular samples (int)\n    dr0: base radial step (1/m)\n    r_max: maximum radius (1/m)\n    \"\"\"\n    N_theta = int(N_theta0 * (2 ** L))\n    dr = dr0 / (2 ** L)\n    M = int(np.floor(r_max / dr))\n    if M  2 or N_theta  2:\n        # Not enough samples to perform a reliable fit; return NaN to indicate failure.\n        return float('nan')\n\n    # Radii and angles\n    radii = dr * np.arange(1, M + 1, dtype=float)  # exclude r=0 to avoid duplicate zero energies\n    angles = 2.0 * np.pi * np.arange(N_theta, dtype=float) / float(N_theta)\n\n    # Mesh in q-space\n    cos_th = np.cos(angles)\n    sin_th = np.sin(angles)\n    qx = radii[:, None] * cos_th[None, :]\n    qy = radii[:, None] * sin_th[None, :]\n\n    # Construct k points around K\n    kx = Kx + qx\n    ky = Ky + qy\n\n    # Compute f(k) and conduction band energies in Joules\n    f = np.zeros_like(kx, dtype=np.complex128)\n    for d in deltas:\n        f += np.exp(1j * (kx * d[0] + ky * d[1]))\n    E_J = t_J * np.abs(f)\n\n    # Prepare linear regression of E_J versus r\n    r = np.sqrt(qx**2 + qy**2).reshape(-1)\n    y = E_J.reshape(-1)\n\n    # Design matrix with intercept\n    X = np.column_stack([r, np.ones_like(r)])\n\n    # Least squares fit: y ≈ S * r + E0\n    coeffs, _, _, _ = np.linalg.lstsq(X, y, rcond=None)\n    S = coeffs[0]  # slope in J·m (since r has units 1/m)\n\n    # Fitted Fermi velocity\n    v_fit = S / HBAR\n\n    # True Fermi velocity\n    v_true = compute_v_true()\n\n    # Absolute error in m/s\n    error = abs(v_fit - v_true)\n    return float(error)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each tuple: (L, N_theta0, dr0 [1/m], r_max [1/m])\n    test_cases = [\n        (0, 8, 1.0e8, 5.0e8),\n        (1, 8, 1.0e8, 5.0e8),\n        (2, 8, 1.0e8, 5.0e8),\n        (2, 4, 1.0e8, 5.0e8),\n        (2, 8, 1.0e8, 2.0e9),\n    ]\n\n    results = []\n    for case in test_cases:\n        L, N_theta0, dr0, r_max = case\n        result = compute_error_for_case(L, N_theta0, dr0, r_max)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}