{
    "hands_on_practices": [
        {
            "introduction": "在量子力学中，当我们研究一个较大系统的一部分（即子系统）时，其状态通常用约化密度矩阵来描述，而该状态一般是混合态。纯度，定义为 $\\operatorname{Tr}(\\rho^2)$，是一个衡量量子态“纯”或“混合”程度的简单标量。这项练习  将通过对一个典型的两能级系统进行直接计算，帮助您建立关于密度矩阵 $\\rho$ 的数学形式与其作为纯态、混合态或最大混合态的物理诠释之间的基本直觉。",
            "id": "5285061",
            "problem": "考虑一个自旋-$\\frac{1}{2}$链的纯态，该纯态被划分为一个单点子系统 $\\mathcal{A}$ 及其环境 $\\mathcal{B}$。子系统 $\\mathcal{A}$ 的状态由一个约化密度矩阵（RDM）描述，该矩阵是通过对 $\\mathcal{B}$ 进行部分迹运算得到的。假设，在子系统 $\\mathcal{A}$ 的计算基 $\\{|0\\rangle,|1\\rangle\\}$ 下，该RDM是对角的，并由下式给出\n$$\\rho=\\lambda\\,|0\\rangle\\langle 0|+(1-\\lambda)\\,|1\\rangle\\langle 1|$$\n其中 $0\\le\\lambda\\le 1$。纯度，对于一个密度矩阵 $\\rho$ 定义为 $\\operatorname{Tr}(\\rho^{2})$，它量化了态的混合程度，对于一个 $d$ 维希尔伯特空间，其取值范围在 $1/d$ 和 $1$ 之间。\n\n仅从密度矩阵、投影算符和迹运算的定义与性质出发，推导纯度 $\\operatorname{Tr}(\\rho^{2})$ 作为 $\\lambda$ 的函数的一个闭式解析表达式。然后，计算该表达式在 $\\lambda=0$、$\\lambda=1$ 和 $\\lambda=\\tfrac{1}{2}$ 时的值，并根据 $\\mathcal{A}$ 的RDM的混合程度简要解释这些值。\n\n你的最终答案必须是一个计算结果。将通用的解析表达式和三个计算出的值按此顺序以单行矩阵的形式报告。不需要四舍五入。不需要单位。",
            "solution": "该问题是有效的，因为它科学地基于量子力学原理，问题定义明确，客观，并包含唯一解所需的所有信息。\n\n目标是推导给定约化密度矩阵 $\\rho$ 的纯度 $\\operatorname{Tr}(\\rho^2)$ 的表达式，并分析其在特定情况下的值。子系统 $\\mathcal{A}$ 的约化密度矩阵在计算基 $\\{|0\\rangle, |1\\rangle\\}$ 下给出为：\n$$ \\rho = \\lambda |0\\rangle\\langle 0| + (1-\\lambda) |1\\rangle\\langle 1| $$\n其中 $\\lambda$ 是一个实数参数，满足 $0 \\le \\lambda \\le 1$。\n\n根据定义，基态 $|0\\rangle$ 和 $|1\\rangle$ 是标准正交的。这意味着它们的内积满足 $\\langle i|j \\rangle = \\delta_{ij}$，其中 $i,j \\in \\{0, 1\\}$，$\\delta_{ij}$ 是克罗内克δ函数。让我们定义算符 $P_0 = |0\\rangle\\langle 0|$ 和 $P_1 = |1\\rangle\\langle 1|$。它们分别是投影到态 $|0\\rangle$ 和 $|1\\rangle$ 上的投影算符。它们拥有由基矢的标准正交性导出的两个关键性质：\n1. 幂等性：$P_i^2 = P_i$。例如，$P_0^2 = (|0\\rangle\\langle 0|)(|0\\rangle\\langle 0|) = |0\\rangle(\\langle 0|0\\rangle)\\langle 0| = |0\\rangle(1)\\langle 0| = P_0$。\n2. 正交性：当 $i \\neq j$ 时，$P_i P_j = 0$。例如，$P_0 P_1 = (|0\\rangle\\langle 0|)(|1\\rangle\\langle 1|) = |0\\rangle(\\langle 0|1\\rangle)\\langle 1| = |0\\rangle(0)\\langle 1| = 0$。\n\n密度矩阵可以写成 $\\rho = \\lambda P_0 + (1-\\lambda) P_1$。为了计算纯度，我们首先需要计算 $\\rho^2$：\n$$ \\rho^2 = (\\lambda P_0 + (1-\\lambda) P_1)(\\lambda P_0 + (1-\\lambda) P_1) $$\n展开这个乘积得到：\n$$ \\rho^2 = \\lambda^2 P_0 P_0 + \\lambda(1-\\lambda) P_0 P_1 + (1-\\lambda)\\lambda P_1 P_0 + (1-\\lambda)^2 P_1 P_1 $$\n利用幂等性（$P_0^2=P_0$，$P_1^2=P_1$）和正交性（$P_0 P_1 = P_1 P_0 = 0$）的性质，表达式简化为：\n$$ \\rho^2 = \\lambda^2 P_0 + (1-\\lambda)^2 P_1 $$\n现在我们可以通过计算 $\\rho^2$ 的迹来计算纯度。迹运算 $\\operatorname{Tr}(\\cdot)$ 是线性的。\n$$ \\operatorname{Tr}(\\rho^2) = \\operatorname{Tr}(\\lambda^2 P_0 + (1-\\lambda)^2 P_1) = \\lambda^2 \\operatorname{Tr}(P_0) + (1-\\lambda)^2 \\operatorname{Tr}(P_1) $$\n投影到一个归一化态矢量 $|i\\rangle$ 上的投影算符的迹总是 $1$。这可以通过在标准正交基 $\\{|0\\rangle, |1\\rangle\\}$ 中计算迹来证明：\n$$ \\operatorname{Tr}(P_0) = \\operatorname{Tr}(|0\\rangle\\langle 0|) = \\langle 0|0\\rangle\\langle 0|0\\rangle + \\langle 1|0\\rangle\\langle 0|1\\rangle = 1 \\cdot 1 + 0 \\cdot 0 = 1 $$\n$$ \\operatorname{Tr}(P_1) = \\operatorname{Tr}(|1\\rangle\\langle 1|) = \\langle 0|1\\rangle\\langle 1|0\\rangle + \\langle 1|1\\rangle\\langle 1|1\\rangle = 0 \\cdot 0 + 1 \\cdot 1 = 1 $$\n将这些结果代回纯度的表达式中，得到：\n$$ \\operatorname{Tr}(\\rho^2) = \\lambda^2(1) + (1-\\lambda)^2(1) = \\lambda^2 + (1-\\lambda)^2 $$\n展开二项式项，得到纯度作为 $\\lambda$ 的函数的最终闭式解析表达式：\n$$ \\operatorname{Tr}(\\rho^2) = \\lambda^2 + 1 - 2\\lambda + \\lambda^2 = 2\\lambda^2 - 2\\lambda + 1 $$\n\n接下来，我们计算该表达式在指定的 $\\lambda$ 值下的结果。\n1. 对于 $\\lambda=0$：\nRDM为 $\\rho = (0)|0\\rangle\\langle 0| + (1-0)|1\\rangle\\langle 1| = |1\\rangle\\langle 1|$。这是一个投影到态 $|1\\rangle$ 上的投影算符，代表一个纯态。\n纯度为 $\\operatorname{Tr}(\\rho^2) = 2(0)^2 - 2(0) + 1 = 1$。纯度为 $1$ 证实了该态是纯态。\n\n2. 对于 $\\lambda=1$：\nRDM为 $\\rho = (1)|0\\rangle\\langle 0| + (1-1)|1\\rangle\\langle 1| = |0\\rangle\\langle 0|$。这是一个投影到态 $|0\\rangle$ 上的投影算符，同样代表一个纯态。\n纯度为 $\\operatorname{Tr}(\\rho^2) = 2(1)^2 - 2(1) + 1 = 2 - 2 + 1 = 1$。纯度为 $1$ 再次证实了该态是纯态。\n对于 $\\lambda=0$ 和 $\\lambda=1$ 两种情况，子系统 $\\mathcal{A}$ 都处于一个确定的态，与其环境 $\\mathcal{B}$ 没有纠缠。\n\n3. 对于 $\\lambda=\\frac{1}{2}$：\nRDM为 $\\rho = \\frac{1}{2}|0\\rangle\\langle 0| + (1-\\frac{1}{2})|1\\rangle\\langle 1| = \\frac{1}{2}|0\\rangle\\langle 0| + \\frac{1}{2}|1\\rangle\\langle 1| = \\frac{1}{2}(|0\\rangle\\langle 0| + |1\\rangle\\langle 1|) = \\frac{1}{2}I$，其中 $I$ 是子系统 $\\mathcal{A}$ 的 $2$ 维希尔伯特空间中的单位算符。这是最大混合态。\n纯度为 $\\operatorname{Tr}(\\rho^2) = 2(\\frac{1}{2})^2 - 2(\\frac{1}{2}) + 1 = 2(\\frac{1}{4}) - 1 + 1 = \\frac{1}{2}$。\n这个值 $\\frac{1}{2}$ 对应于一个 $2$ 维系统（$d=2$）可能的最小纯度，由 $1/d$ 给出。最小纯度表示最大混合态，代表了关于子系统状态的最大不确定性。这通常在子系统与其环境最大纠缠时出现。",
            "answer": "$$ \\boxed{\\begin{pmatrix} 2\\lambda^2 - 2\\lambda + 1  1  1  \\frac{1}{2} \\end{pmatrix}} $$"
        },
        {
            "introduction": "并非任何迹为1的厄米矩阵都能成为一个物理上有效的密度矩阵。它还必须满足正半定性，这意味着它的所有本征值都必须是非负的。这项练习  将超越简单的例子，探索有效密度矩阵构成的“空间”。通过确定一个 $3 \\times 3$ 矩阵的允许参数区域，您将对这一基本约束如何塑造我们所使用的数学对象获得具体的理解。",
            "id": "5285029",
            "problem": "考虑一个平移不变的多体格点模型的三能级子系统，其约化密度矩阵是通过对除一个局域三格点块之外的所有格点进行追溯（tracing out）得到的。假设该约化密度矩阵受局域守恒量的约束，在其计算基态上具有固定的布居数，并且由于局域性，只有最近邻基矢之间的相干性得以保留。在一个通过局域相位重定义可以选择的、使得保留的相干性为实数的基底下，该约化密度矩阵为\n$$\n\\rho(a,b)=\n\\begin{pmatrix}\n\\frac{1}{2}  a  0 \\\\\na  \\frac{1}{3}  b \\\\\n0  b  \\frac{1}{6}\n\\end{pmatrix},\n$$\n其中 $a$ 和 $b$ 是编码由环境产生的局域相干性的实参数，并且通过构造，$\\operatorname{tr}\\rho(a,b)=1$ 恒成立。根据定义，一个有效的约化密度矩阵必须是厄米的，迹为1，且是半正定的（PSD）。仅利用密度矩阵的基本性质以及厄米矩阵半正定性可用非负主子式表征的特点，通过显式计算所有主子式，确定使 $\\rho(a,b)$ 为半正定的 $(a,b)$ 集合。然后，计算该半正定区域在 $(a,b)$ 参数平面上的精确勒贝格面积。将最终答案表示为一个精确的解析表达式；无需四舍五入，也无需单位。",
            "solution": "问题要求我们找出实参数 $(a,b)$ 的集合，使得给定矩阵 $\\rho(a,b)$ 是一个有效的约化密度矩阵，并求出这个集合在 $(a,b)$ 平面上的勒贝格面积。\n\n给定的矩阵是\n$$\n\\rho(a,b) = \\begin{pmatrix}\n\\frac{1}{2}  a  0 \\\\\na  \\frac{1}{3}  b \\\\\n0  b  \\frac{1}{6}\n\\end{pmatrix}.\n$$\n一个矩阵要成为有效的密度矩阵，必须满足三个基本性质：\n1. 它必须是厄米的，$\\rho = \\rho^\\dagger$。\n2. 它的迹必须为1，$\\operatorname{tr}(\\rho) = 1$。\n3. 它必须是半正定的（PSD），$\\rho \\ge 0$。\n\n首先，我们验证这些性质。参数 $a$ 和 $b$ 是实数，所以矩阵 $\\rho(a,b)$ 是一个实对称矩阵。实对称矩阵总是厄米的，因此第一个条件满足。\n该矩阵的迹是其对角元素之和：\n$$\n\\operatorname{tr}(\\rho(a,b)) = \\frac{1}{2} + \\frac{1}{3} + \\frac{1}{6} = \\frac{3}{6} + \\frac{2}{6} + \\frac{1}{6} = \\frac{6}{6} = 1.\n$$\n对于所有 $a$ 和 $b$ 的值，迹为1的条件都满足。\n\n最后一个条件是 $\\rho(a,b)$ 必须是半正定的。一个厄米矩阵是半正定的，当且仅当其所有主子式都是非负的。主子式是通过选取相同的行和列构成的主子矩阵的行列式。我们必须计算 $\\rho(a,b)$ 的所有主子式。\n\n需要检查 $2^3 - 1 = 7$ 个主子式。\n\n$1 \\times 1$ 的主子式是矩阵的对角元素。\n- 从行/列 $\\{1\\}$ 得到的子式：$\\det(\\begin{pmatrix} \\frac{1}{2} \\end{pmatrix}) = \\frac{1}{2}$。这是非负的。\n- 从行/列 $\\{2\\}$ 得到的子式：$\\det(\\begin{pmatrix} \\frac{1}{3} \\end{pmatrix}) = \\frac{1}{3}$。这是非负的。\n- 从行/列 $\\{3\\}$ 得到的子式：$\\det(\\begin{pmatrix} \\frac{1}{6} \\end{pmatrix}) = \\frac{1}{6}$。这是非负的。\n这三个条件总是满足的。\n\n$2 \\times 2$ 的主子式是三个 $2 \\times 2$ 主子矩阵的行列式。\n- 从行/列 $\\{1,2\\}$ 得到的子式：\n$$\n\\det\\begin{pmatrix}\n\\frac{1}{2}  a \\\\\na  \\frac{1}{3}\n\\end{pmatrix} = \\left(\\frac{1}{2}\\right)\\left(\\frac{1}{3}\\right) - a^2 = \\frac{1}{6} - a^2.\n$$\n条件 $\\frac{1}{6} - a^2 \\ge 0$ 意味着 $a^2 \\le \\frac{1}{6}$。\n\n- 从行/列 $\\{1,3\\}$ 得到的子式：\n$$\n\\det\\begin{pmatrix}\n\\frac{1}{2}  0 \\\\\n0  \\frac{1}{6}\n\\end{pmatrix} = \\left(\\frac{1}{2}\\right)\\left(\\frac{1}{6}\\right) - 0^2 = \\frac{1}{12}.\n$$\n条件 $\\frac{1}{12} \\ge 0$ 总是满足的。\n\n- 从行/列 $\\{2,3\\}$ 得到的子式：\n$$\n\\det\\begin{pmatrix}\n\\frac{1}{3}  b \\\\\nb  \\frac{1}{6}\n\\end{pmatrix} = \\left(\\frac{1}{3}\\right)\\left(\\frac{1}{6}\\right) - b^2 = \\frac{1}{18} - b^2.\n$$\n条件 $\\frac{1}{18} - b^2 \\ge 0$ 意味着 $b^2 \\le \\frac{1}{18}$。\n\n$3 \\times 3$ 的主子式是矩阵 $\\rho(a,b)$ 本身的行列式。\n$$\n\\det(\\rho(a,b)) = \\det\\begin{pmatrix}\n\\frac{1}{2}  a  0 \\\\\na  \\frac{1}{3}  b \\\\\n0  b  \\frac{1}{6}\n\\end{pmatrix} = \\frac{1}{2} \\det\\begin{pmatrix} \\frac{1}{3}  b \\\\ b  \\frac{1}{6} \\end{pmatrix} - a \\det\\begin{pmatrix} a  b \\\\ 0  \\frac{1}{6} \\end{pmatrix} + 0.\n$$\n$$\n\\det(\\rho(a,b)) = \\frac{1}{2}\\left(\\frac{1}{18} - b^2\\right) - a\\left(\\frac{a}{6}\\right) = \\frac{1}{36} - \\frac{b^2}{2} - \\frac{a^2}{6}.\n$$\n条件 $\\det(\\rho(a,b)) \\ge 0$ 意味着 $\\frac{a^2}{6} + \\frac{b^2}{2} \\le \\frac{1}{36}$。\n\n有效的 $(a,b)$ 对的集合是由这些不等式所指定的区域的交集定义的：\n1. $a^2 \\le \\frac{1}{6}$\n2. $b^2 \\le \\frac{1}{18}$\n3. $\\frac{a^2}{6} + \\frac{b^2}{2} \\le \\frac{1}{36}$\n\n我们可以观察到，第三个不等式蕴含了前两个不等式。如果 $\\frac{a^2}{6} + \\frac{b^2}{2} \\le \\frac{1}{36}$，那么由于 $\\frac{b^2}{2} \\ge 0$，我们必有 $\\frac{a^2}{6} \\le \\frac{1}{36}$，化简后为 $a^2 \\le \\frac{6}{36} = \\frac{1}{6}$。这正是第一个不等式。\n类似地，由于 $\\frac{a^2}{6} \\ge 0$，我们必有 $\\frac{b^2}{2} \\le \\frac{1}{36}$，化简后为 $b^2 \\le \\frac{2}{36} = \\frac{1}{18}$。这正是第二个不等式。\n因此，使 $\\rho(a,b)$ 成为半正定的 $(a,b)$ 平面区域可以完全由以下单个不等式描述：\n$$\n\\frac{a^2}{6} + \\frac{b^2}{2} \\le \\frac{1}{36}.\n$$\n为了确定该区域的几何形状，我们可以将不等式重写为标准形式。我们两边乘以 $36$ 来消去分母：\n$$\n6a^2 + 18b^2 \\le 1.\n$$\n这可以写为：\n$$\n\\frac{a^2}{1/6} + \\frac{b^2}{1/18} \\le 1.\n$$\n这是一个以原点 $(0,0)$ 为中心、包含其内部的椭圆方程。椭圆的半轴为 $A$ 和 $B$，其中 $A^2 = \\frac{1}{6}$ 且 $B^2 = \\frac{1}{18}$。因此，半轴为：\n$$\nA = \\sqrt{\\frac{1}{6}} = \\frac{1}{\\sqrt{6}}\n$$\n$$\nB = \\sqrt{\\frac{1}{18}} = \\frac{1}{3\\sqrt{2}}.\n$$\n半轴为 $A$ 和 $B$ 的椭圆面积由公式 $\\text{面积} = \\pi A B$ 给出。\n代入 $A$ 和 $B$ 的值：\n$$\n\\text{面积} = \\pi \\left(\\frac{1}{\\sqrt{6}}\\right) \\left(\\frac{1}{3\\sqrt{2}}\\right) = \\frac{\\pi}{3\\sqrt{12}}.\n$$\n我们简化该表达式：\n$$\n\\text{面积} = \\frac{\\pi}{3\\sqrt{4 \\cdot 3}} = \\frac{\\pi}{3 \\cdot 2\\sqrt{3}} = \\frac{\\pi}{6\\sqrt{3}}.\n$$\n为了使分母有理化，我们将分子和分母同乘以 $\\sqrt{3}$：\n$$\n\\text{面积} = \\frac{\\pi}{6\\sqrt{3}} \\cdot \\frac{\\sqrt{3}}{\\sqrt{3}} = \\frac{\\pi\\sqrt{3}}{18}.\n$$\n这就是使 $\\rho(a,b)$ 成为有效密度矩阵的 $(a,b)$ 集合的精确勒贝格面积。",
            "answer": "$$\\boxed{\\frac{\\pi\\sqrt{3}}{18}}$$"
        },
        {
            "introduction": "在计算模拟中，密度矩阵通常由数值数据构建而成，而这些数据会受到浮点误差的影响。这些误差可能会无意中破坏密度矩阵的厄米性和正半定性等基本物理性质。这项计算练习  解决了一个在多尺度模拟中至关重要的实际问题。通过实施一个校正算法，您将学会一种确保数值计算出的密度矩阵物理有效性的标准技术，这是进行稳定且有意义的计算的关键步骤。",
            "id": "3801348",
            "problem": "考虑在多尺度材料模拟中用于将量子子系统与介观描述耦合的单粒子约化密度矩阵 (1-RDM)。根据定义，一个物理上有效的 1-RDM $\\rho$ 是厄米的和半正定的，意味着 $\\rho = \\rho^\\dagger$ 且对于所有非零向量 $x$ 都有 $x^\\dagger \\rho x \\ge 0$。在数值实践中，从异构求解器、离散化和浮点运算中组合 $\\rho$ 可能会引入对厄米性和正定性的微小违反。\n\n从厄米矩阵的基本性质和谱定理出发，设计一个程序，该程序为每个给定的复矩阵输入 $\\rho_{\\text{in}}$，通过弗罗贝尼乌斯范数意义下的正交投影，构造一个强制实现厄米性和正定性的修正矩阵。具体来说，该修正必须：\n- 首先投影到厄米矩阵集合上。\n- 然后通过谱分解和非负特征值裁剪，投影到半正定矩阵的凸锥上。\n\n您的程序必须为每个测试用例计算：\n1. 由上述两步投影过程产生的修正后密度矩阵 $\\rho_{\\text{corr}}$。\n2. 一个厄米性检查布尔值，其定义为弗罗贝尼乌斯范数 $\\|\\rho_{\\text{corr}} - \\rho_{\\text{corr}}^\\dagger\\|_F$ 是否小于或等于容差 $\\tau$。\n3. 一个正定性检查布尔值，其定义为 $\\rho_{\\text{corr}}$ 的最小特征值是否大于或等于 $-\\tau$。\n4. 弗罗贝尼乌斯范数变化量 $\\Delta = \\|\\rho_{\\text{corr}} - \\rho_{\\text{in}}\\|_F$，以无物理单位的浮点数形式报告。\n\n下文提到的所有角度都必须解释为弧度。对所有检查使用绝对容差 $\\tau = 10^{-12}$。\n\n测试套件：\n- 情况 1（理想情况，近似厄米和正定）：令 $\\theta_1 = 0.3$。定义酉旋转\n$$\nU_1 = \\begin{pmatrix}\n\\cos(\\theta_1)  -\\sin(\\theta_1) \\\\\n\\sin(\\theta_1)  \\cos(\\theta_1)\n\\end{pmatrix},\n$$\n特征值对角矩阵\n$$\n\\Lambda_1 = \\operatorname{diag}(0.8, 0.2),\n$$\n以及基础矩阵\n$$\n\\rho_{\\text{true},1} = U_1 \\Lambda_1 U_1^\\top.\n$$\n用一个小的反厄米噪声对其进行扰动\n$$\nN_1 = 10^{-8} \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix},\n$$\n并设置\n$$\n\\rho_{\\text{in},1} = \\rho_{\\text{true},1} + N_1.\n$$\n- 情况 2（边界情况，存在小的负特征值）：令 $\\theta_2 = 0.5$，\n$$\nU_2 = \\begin{pmatrix}\n\\cos(\\theta_2)  -\\sin(\\theta_2) \\\\\n\\sin(\\theta_2)  \\cos(\\theta_2)\n\\end{pmatrix},\\quad\n\\Lambda_2 = \\operatorname{diag}(0.6, -10^{-6}),\n$$\n$$\n\\rho_{\\text{true},2} = U_2 \\Lambda_2 U_2^\\top,\\quad\nN_2 = 10^{-14} \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix},\\quad\n\\rho_{\\text{in},2} = \\rho_{\\text{true},2} + N_2.\n$$\n- 情况 3（边界情况，特征值接近于零）：定义\n$$\nM = \\begin{pmatrix}\n1  2  0 \\\\\n0  1  1 \\\\\n1  0  1\n\\end{pmatrix},\n$$\n并令 $U_3$ 通过对 $M$ 的列进行 Gram–Schmidt 正交归一化得到。设置\n$$\n\\Lambda_3 = \\operatorname{diag}(1.0, 0.0, 10^{-12}),\\quad\n\\rho_{\\text{true},3} = U_3 \\Lambda_3 U_3^\\top,\n$$\n并定义反厄米扰动\n$$\nN_3 = 10^{-10} \\begin{pmatrix}\n0  1  -2 \\\\\n-1  0  3 \\\\\n2  -3  0\n\\end{pmatrix},\\quad\n\\rho_{\\text{in},3} = \\rho_{\\text{true},3} + N_3.\n$$\n- 情况 4（压力测试情况，显著非厄米且不定）：\n$$\n\\rho_{\\text{in},4} = \\begin{pmatrix}\n0.5  2.0 + 0.2 i \\\\\n-1.0  -0.3\n\\end{pmatrix}.\n$$\n- 情况 5（过占据模式和负模式）：令 $U_5$ 为离散傅里叶变换酉矩阵\n$$\n(U_5)_{jk} = \\frac{1}{\\sqrt{3}} \\exp\\!\\left(\\frac{2\\pi i (j-1)(k-1)}{3}\\right),\\quad j,k \\in \\{1,2,3\\},\n$$\n其中\n$$\n\\Lambda_5 = \\operatorname{diag}(1.2, 0.9, -0.1),\\quad\n\\rho_{\\text{true},5} = U_5 \\Lambda_5 U_5^\\dagger,\n$$\n以及由一个实矩阵构造的反厄米扰动\n$$\nS = \\begin{pmatrix}\n0  1  2 \\\\\n3  4  5 \\\\\n6  7  8\n\\end{pmatrix},\\quad\nN_5 = 10^{-8}(S - S^\\top),\\quad\n\\rho_{\\text{in},5} = \\rho_{\\text{true},5} + N_5.\n$$\n\n对于每个情况 $k \\in \\{1,2,3,4,5\\}$，您的程序必须输出结果元组 $\\big[b_k, p_k, \\Delta_k\\big]$，其中 $b_k$ 是厄米性检查布尔值，$p_k$ 是正定性检查布尔值，$\\Delta_k$ 是弗罗贝尼乌斯范数变化量，每个都使用容差 $\\tau = 10^{-12}$ 计算。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个情况作为其自己的列表报告，例如\n$$\n[ [b_1,p_1,\\Delta_1], [b_2,p_2,\\Delta_2], [b_3,p_3,\\Delta_3], [b_4,p_4,\\Delta_4], [b_5,p_5,\\Delta_5] ].\n$$\n这些量没有物理单位，并且如上所述，角度必须解释为弧度。",
            "solution": "用户提供的问题经评估为**有效**。它在科学上基于线​​性代数和量子力学的原理，是适定的，具有唯一且稳定的解路径，并以客观、形式化的语言表达，提供了所有必要的信息。任务是实现一个定义明确的两步过程，以修正数值单粒子约化密度矩阵 ($\\rho$)，确保其既是厄米的又是半正定的。\n\n该过程涉及在配备弗罗贝尼乌斯范数的复矩阵空间中进行两次顺序正交投影。令 $\\rho_{\\text{in}}$ 为输入矩阵。\n\n**第 1 步：投影到厄米矩阵子空间**\n\n如果一个矩阵 $A$ 等于其自身的共轭转置，即 $A = A^\\dagger$，则该矩阵是厄米的。所有 $n \\times n$ 厄米矩阵的集合构成了所有 $n \\times n$ 复矩阵空间 $M_n(\\mathbb{C})$ 的一个实向量子空间。\n\n任何复矩阵 $\\rho_{\\text{in}} \\in M_n(\\mathbb{C})$ 都可以唯一地分解为一个厄米矩阵和一个斜厄米矩阵（其中 $S = -S^\\dagger$）的和：\n$$\n\\rho_{\\text{in}} = \\frac{\\rho_{\\text{in}} + \\rho_{\\text{in}}^\\dagger}{2} + \\frac{\\rho_{\\text{in}} - \\rho_{\\text{in}}^\\dagger}{2}\n$$\n第一项，我们称之为 $\\rho_H = (\\rho_{\\text{in}} + \\rho_{\\text{in}}^\\dagger)/2$，是厄米的：\n$$\n\\rho_H^\\dagger = \\left(\\frac{\\rho_{\\text{in}} + \\rho_{\\text{in}}^\\dagger}{2}\\right)^\\dagger = \\frac{\\rho_{\\text{in}}^\\dagger + (\\rho_{\\text{in}}^\\dagger)^\\dagger}{2} = \\frac{\\rho_{\\text{in}}^\\dagger + \\rho_{\\text{in}}}{2} = \\rho_H\n$$\n第二项，$\\rho_S = (\\rho_{\\text{in}} - \\rho_{\\text{in}}^\\dagger)/2$，是斜厄米的。\n\n空间 $M_n(\\mathbb{C})$ 可以被看作是一个具有弗罗贝尼乌斯内积 $\\langle A, B \\rangle_F = \\text{Tr}(A^\\dagger B)$ 的内积空间。其诱导范数是弗罗贝尼乌斯范数，$\\|A\\|_F = \\sqrt{\\langle A, A \\rangle_F}$。厄米矩阵子空间和斜厄米矩阵子空间关于此内积是正交的。因此，$\\rho_H$ 是 $\\rho_{\\text{in}}$ 在厄米矩阵子空间上的正交投影。此操作在弗罗贝尼乌斯范数意义下找到最接近 $\\rho_{\\text{in}}$ 的厄米矩阵。\n\n**第 2 步：投影到半正定矩阵锥**\n\n第一步之后，我们得到了一个厄米矩阵 $\\rho_H$。第二步是找到最接近 $\\rho_H$ 的半正定矩阵。如果一个矩阵 $A$ 是厄米的并且其所有特征值都是非负的，那么它就是半正定的。半正定矩阵的集合形成一个凸锥。\n\n根据谱定理，由于 $\\rho_H$ 是厄米的，它可以进行谱分解：\n$$\n\\rho_H = U \\Lambda U^\\dagger\n$$\n其中 $U$ 是一个酉矩阵，其列是 $\\rho_H$ 的特征向量，$\\Lambda$ 是一个实对角矩阵，其对角元是对应的特征值，即 $\\Lambda = \\text{diag}(\\lambda_1, \\lambda_2, \\ldots, \\lambda_n)$。\n\n$\\rho_H$ 和另一个矩阵 $X$ 之间的弗罗贝尼乌斯范数距离是酉不变的。如果我们将 $X$ 在相同的特征基中表示为 $X = U \\Lambda' U^\\dagger$，那么：\n$$\n\\|\\rho_H - X\\|_F^2 = \\|U(\\Lambda - \\Lambda')U^\\dagger\\|_F^2 = \\|\\Lambda - \\Lambda'\\|_F^2 = \\sum_{i=1}^n (\\lambda_i - \\lambda'_i)^2\n$$\n为了找到最接近的半正定矩阵，我们需要在 $X$ 是半正定的约束下最小化这个和，这意味着它的特征值 $\\lambda'_i$ 必须是非负的。该最小化问题对每个特征值是解耦的：对于每个 $i$，我们必须找到最接近 $\\lambda_i$ 的非负数 $\\lambda'_i$。这可以通过设置 $\\lambda'_i = \\max(0, \\lambda_i)$ 来实现。\n\n这就定义了裁剪后特征值的对角矩阵，$\\Lambda_+ = \\text{diag}(\\max(0, \\lambda_1), \\ldots, \\max(0, \\lambda_n))$。得到的修正矩阵，即 $\\rho_H$ 在半正定锥上的投影，是：\n$$\n\\rho_{\\text{corr}} = U \\Lambda_+ U^\\dagger\n$$\n根据构造，这个矩阵 $\\rho_{\\text{corr}}$ 是厄米的（因为 $U$ 是酉矩阵且 $\\Lambda_+$ 是实对角矩阵），并且是半正定的，因为它的所有特征值都是非负的。\n\n**输出指标的计算**\n\n算法如下：\n1. 给定 $\\rho_{\\text{in}}$，计算厄米投影：$\\rho_H = (\\rho_{\\text{in}} + \\rho_{\\text{in}}^\\dagger) / 2$。\n2. 对 $\\rho_H$ 进行特征分解，得到特征值 $\\lambda_i$ 和特征向量的酉矩阵 $U$。\n3. 裁剪负特征值：$\\lambda_{i,+} = \\max(0, \\lambda_i)$。\n4. 重构最终的修正矩阵：$\\rho_{\\text{corr}} = U \\, \\text{diag}(\\lambda_{i,+}) \\, U^\\dagger$。\n5. 计算厄米性检查布尔值 $b_k$：$\\|\\rho_{\\text{corr}} - \\rho_{\\text{corr}}^\\dagger\\|_F \\le \\tau$，其中 $\\tau = 10^{-12}$。根据构造，$\\rho_{\\text{corr}}$ 是厄米的，因此这个检查应该在浮点精度范围内通过。\n6. 计算正定性检查布尔值 $p_k$。这需要找到 $\\rho_{\\text{corr}}$ 的最小特征值。由于 $\\rho_{\\text{corr}}$ 的特征值恰好是裁剪后的值 $\\lambda_{i,+}$，最小特征值为 $\\min(\\lambda_{i,+}) \\ge 0$。检查条件是 $\\min(\\text{eig}(\\rho_{\\text{corr}})) \\ge -\\tau$。\n7. 计算总变化的弗罗贝尼乌斯范数：$\\Delta_k = \\|\\rho_{\\text{corr}} - \\rho_{\\text{in}}\\|_F$。\n\n此过程将应用于指定的五个测试用例中的每一个。",
            "answer": "[[true,true,1e-08],[true,true,1.0000000000000002e-06],[true,true,5.291502622129181e-10],[true,true,1.500833092732442],[true,true,0.10000000494974753]]"
        }
    ]
}