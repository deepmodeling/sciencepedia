{
    "hands_on_practices": [
        {
            "introduction": "Understanding a concept often begins with a simple, tangible calculation. This first practice focuses on the purity of a quantum state, a fundamental measure that quantifies how 'mixed' or 'pure' a state is. By calculating the purity for a simple two-level system, you will gain a direct, hands-on feel for how this metric connects the mathematical form of a density matrix to the physical concepts of definite states versus statistical mixtures .",
            "id": "5285061",
            "problem": "Consider a pure state of a spin-$\\frac{1}{2}$ chain partitioned into a single-site subsystem $\\mathcal{A}$ and its environment $\\mathcal{B}$. The state of subsystem $\\mathcal{A}$ is described by a reduced density matrix (RDM), obtained by a partial trace over $\\mathcal{B}$. Suppose that, in the computational basis $\\{|0\\rangle,|1\\rangle\\}$ of subsystem $\\mathcal{A}$, the RDM is diagonal and given by\n$$\\rho=\\lambda\\,|0\\rangle\\langle 0|+(1-\\lambda)\\,|1\\rangle\\langle 1|$$\nwith $0\\le\\lambda\\le 1$. The purity, defined for a density matrix $\\rho$ as $\\operatorname{Tr}(\\rho^{2})$, quantifies the degree of mixedness of the state and ranges between $1/d$ and $1$ for a $d$-dimensional Hilbert space.\n\nStarting only from the definitions and properties of density matrices, projectors, and the trace operation, derive a closed-form analytic expression for the purity $\\operatorname{Tr}(\\rho^{2})$ as a function of $\\lambda$. Then evaluate this expression at $\\lambda=0$, $\\lambda=1$, and $\\lambda=\\tfrac{1}{2}$, and briefly interpret these values in terms of the mixedness of the RDM of $\\mathcal{A}$.\n\nYour final answer must be a calculation. Report both the general analytic expression and the three evaluated values, in that order, as a single row matrix. No rounding is required. No units are required.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of quantum mechanics, well-posed, objective, and contains all necessary information for a unique solution.\n\nThe objective is to derive an expression for the purity, $\\operatorname{Tr}(\\rho^2)$, of a given reduced density matrix $\\rho$ and analyze its values for specific cases. The reduced density matrix for subsystem $\\mathcal{A}$ is given in the computational basis $\\{|0\\rangle, |1\\rangle\\}$ as:\n$$ \\rho = \\lambda |0\\rangle\\langle 0| + (1-\\lambda) |1\\rangle\\langle 1| $$\nwhere $\\lambda$ is a real parameter such that $0 \\le \\lambda \\le 1$.\n\nThe basis states $|0\\rangle$ and $|1\\rangle$ are, by definition, orthonormal. This means their inner products satisfy $\\langle i|j \\rangle = \\delta_{ij}$ for $i,j \\in \\{0, 1\\}$, where $\\delta_{ij}$ is the Kronecker delta. Let us define the operators $P_0 = |0\\rangle\\langle 0|$ and $P_1 = |1\\rangle\\langle 1|$. These are projection operators onto the states $|0\\rangle$ and $|1\\rangle$, respectively. They possess two key properties derived from the orthonormality of the basis:\n$1$. Idempotency: $P_i^2 = P_i$. For example, $P_0^2 = (|0\\rangle\\langle 0|)(|0\\rangle\\langle 0|) = |0\\rangle(\\langle 0|0\\rangle)\\langle 0| = |0\\rangle(1)\\langle 0| = P_0$.\n$2$. Orthogonality: $P_i P_j = 0$ for $i \\neq j$. For example, $P_0 P_1 = (|0\\rangle\\langle 0|)(|1\\rangle\\langle 1|) = |0\\rangle(\\langle 0|1\\rangle)\\langle 1| = |0\\rangle(0)\\langle 1| = 0$.\n\nThe density matrix can be written as $\\rho = \\lambda P_0 + (1-\\lambda) P_1$. To calculate the purity, we first need to compute $\\rho^2$:\n$$ \\rho^2 = (\\lambda P_0 + (1-\\lambda) P_1)(\\lambda P_0 + (1-\\lambda) P_1) $$\nExpanding this product gives:\n$$ \\rho^2 = \\lambda^2 P_0 P_0 + \\lambda(1-\\lambda) P_0 P_1 + (1-\\lambda)\\lambda P_1 P_0 + (1-\\lambda)^2 P_1 P_1 $$\nUsing the properties of idempotency ($P_0^2=P_0$, $P_1^2=P_1$) and orthogonality ($P_0 P_1 = P_1 P_0 = 0$), the expression simplifies to:\n$$ \\rho^2 = \\lambda^2 P_0 + (1-\\lambda)^2 P_1 $$\nNow we can compute the purity by taking the trace of $\\rho^2$. The trace operation, $\\operatorname{Tr}(\\cdot)$, is linear.\n$$ \\operatorname{Tr}(\\rho^2) = \\operatorname{Tr}(\\lambda^2 P_0 + (1-\\lambda)^2 P_1) = \\lambda^2 \\operatorname{Tr}(P_0) + (1-\\lambda)^2 \\operatorname{Tr}(P_1) $$\nThe trace of a projection operator onto a single normalized state vector $|i\\rangle$ is always $1$. This can be shown by computing the trace in the orthonormal basis $\\{|0\\rangle, |1\\rangle\\}$:\n$$ \\operatorname{Tr}(P_0) = \\operatorname{Tr}(|0\\rangle\\langle 0|) = \\langle 0|0\\rangle\\langle 0|0\\rangle + \\langle 1|0\\rangle\\langle 0|1\\rangle = 1 \\cdot 1 + 0 \\cdot 0 = 1 $$\n$$ \\operatorname{Tr}(P_1) = \\operatorname{Tr}(|1\\rangle\\langle 1|) = \\langle 0|1\\rangle\\langle 1|0\\rangle + \\langle 1|1\\rangle\\langle 1|1\\rangle = 0 \\cdot 0 + 1 \\cdot 1 = 1 $$\nSubstituting these results back into the expression for the purity gives:\n$$ \\operatorname{Tr}(\\rho^2) = \\lambda^2(1) + (1-\\lambda)^2(1) = \\lambda^2 + (1-\\lambda)^2 $$\nExpanding the binomial term yields the final closed-form analytic expression for the purity as a function of $\\lambda$:\n$$ \\operatorname{Tr}(\\rho^2) = \\lambda^2 + 1 - 2\\lambda + \\lambda^2 = 2\\lambda^2 - 2\\lambda + 1 $$\n\nNext, we evaluate this expression for the specified values of $\\lambda$.\n$1$. For $\\lambda=0$:\nThe RDM is $\\rho = (0)|0\\rangle\\langle 0| + (1-0)|1\\rangle\\langle 1| = |1\\rangle\\langle 1|$. This is a projection operator onto the state $|1\\rangle$, representing a pure state.\nThe purity is $\\operatorname{Tr}(\\rho^2) = 2(0)^2 - 2(0) + 1 = 1$. A purity of $1$ confirms that the state is pure.\n\n$2$. For $\\lambda=1$:\nThe RDM is $\\rho = (1)|0\\rangle\\langle 0| + (1-1)|1\\rangle\\langle 1| = |0\\rangle\\langle 0|$. This is a projection operator onto the state $|0\\rangle$, also representing a pure state.\nThe purity is $\\operatorname{Tr}(\\rho^2) = 2(1)^2 - 2(1) + 1 = 2 - 2 + 1 = 1$. Again, a purity of $1$ confirms the state is pure.\nFor both $\\lambda=0$ and $\\lambda=1$, the subsystem $\\mathcal{A}$ is in a definite state, unentangled with its environment $\\mathcal{B}$.\n\n$3$. For $\\lambda=\\frac{1}{2}$:\nThe RDM is $\\rho = \\frac{1}{2}|0\\rangle\\langle 0| + (1-\\frac{1}{2})|1\\rangle\\langle 1| = \\frac{1}{2}|0\\rangle\\langle 0| + \\frac{1}{2}|1\\rangle\\langle 1| = \\frac{1}{2}(|0\\rangle\\langle 0| + |1\\rangle\\langle 1|) = \\frac{1}{2}I$, where $I$ is the identity operator in the $2$-dimensional Hilbert space of subsystem $\\mathcal{A}$. This is the maximally mixed state.\nThe purity is $\\operatorname{Tr}(\\rho^2) = 2(\\frac{1}{2})^2 - 2(\\frac{1}{2}) + 1 = 2(\\frac{1}{4}) - 1 + 1 = \\frac{1}{2}$.\nThis value, $\\frac{1}{2}$, corresponds to the minimum possible purity for a $2$-dimensional system ($d=2$), given by $1/d$. A minimal purity indicates a maximally mixed state, which represents maximal uncertainty about the state of the subsystem. This typically arises when the subsystem is maximally entangled with its environment.",
            "answer": "$$ \\boxed{\\begin{pmatrix} 2\\lambda^2 - 2\\lambda + 1  1  1  \\frac{1}{2} \\end{pmatrix}} $$"
        },
        {
            "introduction": "A valid density matrix must satisfy strict mathematical requirements, most notably being positive semidefinite. This exercise moves beyond using a given density matrix to exploring the very boundaries of what constitutes a physically possible one. By determining the allowed parameter space for a hypothetical three-level system, you will apply the fundamental criterion of positive semidefiniteness to map out the 'space of valid states,' revealing a deep connection between abstract quantum principles and concrete geometric constraints .",
            "id": "5285029",
            "problem": "Consider a three-level subsystem of a translationally invariant many-body lattice model, whose reduced density matrix arises by tracing out all sites except a local block of three. Assume the reduced density matrix is constrained by local conserved quantities to have fixed populations on its computational basis states, and that only nearest-basis coherences survive due to locality. In a basis where the surviving coherences are real (a choice achievable by local phase redefinitions), the reduced density matrix is\n$$\n\\rho(a,b)=\n\\begin{pmatrix}\n\\frac{1}{2}  a  0 \\\\\na  \\frac{1}{3}  b \\\\\n0  b  \\frac{1}{6}\n\\end{pmatrix},\n$$\nwhere $a$ and $b$ are real parameters encoding local coherences generated by the environment and $\\operatorname{tr}\\rho(a,b)=1$ is satisfied by construction. By definition, a valid reduced density matrix must be Hermitian, have unit trace, and be positive semidefinite (PSD). Using only the fundamental properties of density matrices and the characterization of PSD Hermitian matrices in terms of nonnegative principal minors, determine the set of $(a,b)$ for which $\\rho(a,b)$ is PSD by explicitly computing all principal minors. Then, compute the exact Lebesgue area of this PSD region in the $(a,b)$ parameter plane. Express your final answer as an exact analytical expression; no rounding is necessary and no units are required.",
            "solution": "The problem asks for the set of real parameters $(a,b)$ for which the given matrix $\\rho(a,b)$ is a valid reduced density matrix, and for the Lebesgue area of this set in the $(a,b)$ plane.\n\nThe given matrix is\n$$\n\\rho(a,b) = \\begin{pmatrix}\n\\frac{1}{2}  a  0 \\\\\na  \\frac{1}{3}  b \\\\\n0  b  \\frac{1}{6}\n\\end{pmatrix}.\n$$\nA matrix is a valid density matrix if it satisfies three fundamental properties:\n1. It must be Hermitian, $\\rho = \\rho^\\dagger$.\n2. It must have unit trace, $\\operatorname{tr}(\\rho) = 1$.\n3. It must be positive semidefinite (PSD), $\\rho \\ge 0$.\n\nFirst, we verify the given properties. The parameters $a$ and $b$ are real, so the matrix $\\rho(a,b)$ is a real symmetric matrix. A real symmetric matrix is always Hermitian, so the first condition is satisfied.\nThe trace of the matrix is the sum of its diagonal elements:\n$$\n\\operatorname{tr}(\\rho(a,b)) = \\frac{1}{2} + \\frac{1}{3} + \\frac{1}{6} = \\frac{3}{6} + \\frac{2}{6} + \\frac{1}{6} = \\frac{6}{6} = 1.\n$$\nThe unit trace condition is satisfied for all values of $a$ and $b$.\n\nThe final condition is that $\\rho(a,b)$ must be positive semidefinite. A Hermitian matrix is positive semidefinite if and only if all of its principal minors are non-negative. A principal minor is the determinant of a principal submatrix, which is formed by selecting the same set of rows and columns. We must compute all principal minors of $\\rho(a,b)$.\n\nThere are $2^3 - 1 = 7$ principal minors to check.\n\nThe $1 \\times 1$ principal minors are the diagonal elements of the matrix.\n- Minor from row/column $\\{1\\}$: $\\det(\\begin{pmatrix} \\frac{1}{2} \\end{pmatrix}) = \\frac{1}{2}$. This is non-negative.\n- Minor from row/column $\\{2\\}$: $\\det(\\begin{pmatrix} \\frac{1}{3} \\end{pmatrix}) = \\frac{1}{3}$. This is non-negative.\n- Minor from row/column $\\{3\\}$: $\\det(\\begin{pmatrix} \\frac{1}{6} \\end{pmatrix}) = \\frac{1}{6}$. This is non-negative.\nThese three conditions are always satisfied.\n\nThe $2 \\times 2$ principal minors are the determinants of the three $2 \\times 2$ principal submatrices.\n- Minor from rows/columns $\\{1,2\\}$:\n$$\n\\det\\begin{pmatrix}\n\\frac{1}{2}  a \\\\\na  \\frac{1}{3}\n\\end{pmatrix} = \\left(\\frac{1}{2}\\right)\\left(\\frac{1}{3}\\right) - a^2 = \\frac{1}{6} - a^2.\n$$\nThe condition $\\frac{1}{6} - a^2 \\ge 0$ implies $a^2 \\le \\frac{1}{6}$.\n\n- Minor from rows/columns $\\{1,3\\}$:\n$$\n\\det\\begin{pmatrix}\n\\frac{1}{2}  0 \\\\\n0  \\frac{1}{6}\n\\end{pmatrix} = \\left(\\frac{1}{2}\\right)\\left(\\frac{1}{6}\\right) - 0^2 = \\frac{1}{12}.\n$$\nThe condition $\\frac{1}{12} \\ge 0$ is always satisfied.\n\n- Minor from rows/columns $\\{2,3\\}$:\n$$\n\\det\\begin{pmatrix}\n\\frac{1}{3}  b \\\\\nb  \\frac{1}{6}\n\\end{pmatrix} = \\left(\\frac{1}{3}\\right)\\left(\\frac{1}{6}\\right) - b^2 = \\frac{1}{18} - b^2.\n$$\nThe condition $\\frac{1}{18} - b^2 \\ge 0$ implies $b^2 \\le \\frac{1}{18}$.\n\nThe $3 \\times 3$ principal minor is the determinant of the matrix $\\rho(a,b)$ itself.\n$$\n\\det(\\rho(a,b)) = \\det\\begin{pmatrix}\n\\frac{1}{2}  a  0 \\\\\na  \\frac{1}{3}  b \\\\\n0  b  \\frac{1}{6}\n\\end{pmatrix} = \\frac{1}{2} \\det\\begin{pmatrix} \\frac{1}{3}  b \\\\ b  \\frac{1}{6} \\end{pmatrix} - a \\det\\begin{pmatrix} a  b \\\\ 0  \\frac{1}{6} \\end{pmatrix} + 0.\n$$\n$$\n\\det(\\rho(a,b)) = \\frac{1}{2}\\left(\\frac{1}{18} - b^2\\right) - a\\left(\\frac{a}{6}\\right) = \\frac{1}{36} - \\frac{b^2}{2} - \\frac{a^2}{6}.\n$$\nThe condition $\\det(\\rho(a,b)) \\ge 0$ implies $\\frac{a^2}{6} + \\frac{b^2}{2} \\le \\frac{1}{36}$.\n\nThe set of valid $(a,b)$ pairs is defined by the intersection of the regions specified by these inequalities:\n1. $a^2 \\le \\frac{1}{6}$\n2. $b^2 \\le \\frac{1}{18}$\n3. $\\frac{a^2}{6} + \\frac{b^2}{2} \\le \\frac{1}{36}$\n\nWe can observe that the third inequality implies the first two. If $\\frac{a^2}{6} + \\frac{b^2}{2} \\le \\frac{1}{36}$, then since $\\frac{b^2}{2} \\ge 0$, we must have $\\frac{a^2}{6} \\le \\frac{1}{36}$, which simplifies to $a^2 \\le \\frac{6}{36} = \\frac{1}{6}$. This is the first inequality.\nSimilarly, since $\\frac{a^2}{6} \\ge 0$, we must have $\\frac{b^2}{2} \\le \\frac{1}{36}$, which simplifies to $b^2 \\le \\frac{2}{36} = \\frac{1}{18}$. This is the second inequality.\nTherefore, the region of the $(a,b)$ plane for which $\\rho(a,b)$ is positive semidefinite is fully described by the single inequality:\n$$\n\\frac{a^2}{6} + \\frac{b^2}{2} \\le \\frac{1}{36}.\n$$\nTo identify the geometric shape of this region, we can rewrite the inequality in a standard form. We multiply by $36$ to clear the denominator:\n$$\n6a^2 + 18b^2 \\le 1.\n$$\nThis can be written as:\n$$\n\\frac{a^2}{1/6} + \\frac{b^2}{1/18} \\le 1.\n$$\nThis is the equation of an ellipse centered at the origin $(0,0)$ including its interior. The semi-axes of the ellipse are $A$ and $B$, where $A^2 = \\frac{1}{6}$ and $B^2 = \\frac{1}{18}$. Thus, the semi-axes are:\n$$\nA = \\sqrt{\\frac{1}{6}} = \\frac{1}{\\sqrt{6}}\n$$\n$$\nB = \\sqrt{\\frac{1}{18}} = \\frac{1}{\\sqrt{9 \\cdot 2}} = \\frac{1}{3\\sqrt{2}}.\n$$\nThe area of an ellipse with semi-axes $A$ and $B$ is given by the formula $\\text{Area} = \\pi A B$.\nSubstituting the values of $A$ and $B$:\n$$\n\\text{Area} = \\pi \\left(\\frac{1}{\\sqrt{6}}\\right) \\left(\\frac{1}{3\\sqrt{2}}\\right) = \\frac{\\pi}{3\\sqrt{12}}.\n$$\nWe simplify the expression:\n$$\n\\text{Area} = \\frac{\\pi}{3\\sqrt{4 \\cdot 3}} = \\frac{\\pi}{3 \\cdot 2\\sqrt{3}} = \\frac{\\pi}{6\\sqrt{3}}.\n$$\nTo rationalize the denominator, we multiply the numerator and denominator by $\\sqrt{3}$:\n$$\n\\text{Area} = \\frac{\\pi}{6\\sqrt{3}} \\cdot \\frac{\\sqrt{3}}{\\sqrt{3}} = \\frac{\\pi\\sqrt{3}}{18}.\n$$\nThis is the exact Lebesgue area of the set of $(a,b)$ for which $\\rho(a,b)$ is a valid density matrix.",
            "answer": "$$\\boxed{\\frac{\\pi\\sqrt{3}}{18}}$$"
        },
        {
            "introduction": "In the world of computational materials science, theoretical exactness meets the finite precision of computers. This final practice tackles a critical real-world challenge: numerical errors can cause a computed density matrix to violate the fundamental properties of Hermiticity and positive semidefiniteness. You will implement a standard correction algorithm to 'purify' these numerical matrices, ensuring they remain physically valid, a crucial skill for anyone performing robust multiscale simulations .",
            "id": "3801348",
            "problem": "Consider the one-particle reduced density matrix (1-RDM) used in multiscale materials simulation to couple quantum subsystems to mesoscopic descriptions. By definition, a physically valid 1-RDM $\\rho$ is Hermitian and positive semidefinite, meaning $\\rho = \\rho^\\dagger$ and $x^\\dagger \\rho x \\ge 0$ for all nonzero vectors $x$. In numerical practice, assembling $\\rho$ from heterogeneous solvers, discretizations, and floating-point arithmetic can introduce small violations of Hermiticity and positivity.\n\nStarting from the foundational properties of Hermitian matrices and the spectral theorem, design a program that, for each given complex matrix input $\\rho_{\\text{in}}$, constructs a corrected matrix that enforces Hermiticity and positivity by orthogonal projections in the Frobenius norm sense. Specifically, the correction must:\n- First project onto the set of Hermitian matrices.\n- Then project onto the convex cone of positive semidefinite matrices via spectral decomposition and nonnegative eigenvalue clipping.\n\nYour program must, for each test case, compute:\n1. A corrected density matrix $\\rho_{\\text{corr}}$ produced by the above two-step projection procedure.\n2. A Hermiticity check boolean defined by whether the Frobenius norm $\\|\\rho_{\\text{corr}} - \\rho_{\\text{corr}}^\\dagger\\|_F$ is less than or equal to a tolerance $\\tau$.\n3. A positivity check boolean defined by whether the smallest eigenvalue of $\\rho_{\\text{corr}}$ is greater than or equal to $-\\tau$.\n4. The Frobenius norm change $\\Delta = \\|\\rho_{\\text{corr}} - \\rho_{\\text{in}}\\|_F$ reported as a floating-point number with no physical units.\n\nAll angles mentioned below must be interpreted in radians. Use the absolute tolerance $\\tau = 10^{-12}$ for all checks.\n\nTest suite:\n- Case $1$ (happy path, nearly Hermitian and positive): Let $\\theta_1 = 0.3$. Define the unitary rotation\n$$\nU_1 = \\begin{pmatrix}\n\\cos(\\theta_1)  -\\sin(\\theta_1) \\\\\n\\sin(\\theta_1)  \\cos(\\theta_1)\n\\end{pmatrix},\n$$\nthe eigenvalue diagonal\n$$\n\\Lambda_1 = \\operatorname{diag}(0.8, 0.2),\n$$\nand the base matrix\n$$\n\\rho_{\\text{true},1} = U_1 \\Lambda_1 U_1^\\top.\n$$\nPerturb it with a small anti-Hermitian noise\n$$\nN_1 = 10^{-8} \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix},\n$$\nand set\n$$\n\\rho_{\\text{in},1} = \\rho_{\\text{true},1} + N_1.\n$$\n- Case $2$ (edge case, small negative eigenvalue): Let $\\theta_2 = 0.5$,\n$$\nU_2 = \\begin{pmatrix}\n\\cos(\\theta_2)  -\\sin(\\theta_2) \\\\\n\\sin(\\theta_2)  \\cos(\\theta_2)\n\\end{pmatrix},\\quad\n\\Lambda_2 = \\operatorname{diag}(0.6, -10^{-6}),\n$$\n$$\n\\rho_{\\text{true},2} = U_2 \\Lambda_2 U_2^\\top,\\quad\nN_2 = 10^{-14} \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix},\\quad\n\\rho_{\\text{in},2} = \\rho_{\\text{true},2} + N_2.\n$$\n- Case $3$ (boundary case, eigenvalues near zero): Define\n$$\nM = \\begin{pmatrix}\n1  2  0 \\\\\n0  1  1 \\\\\n1  0  1\n\\end{pmatrix},\n$$\nand let $U_3$ be obtained by Gramâ€“Schmidt orthonormalization of the columns of $M$. Set\n$$\n\\Lambda_3 = \\operatorname{diag}(1.0, 0.0, 10^{-12}),\\quad\n\\rho_{\\text{true},3} = U_3 \\Lambda_3 U_3^\\top,\n$$\nand define the anti-Hermitian perturbation\n$$\nN_3 = 10^{-10} \\begin{pmatrix}\n0  1  -2 \\\\\n-1  0  3 \\\\\n2  -3  0\n\\end{pmatrix},\\quad\n\\rho_{\\text{in},3} = \\rho_{\\text{true},3} + N_3.\n$$\n- Case $4$ (stress case, markedly non-Hermitian and indefinite):\n$$\n\\rho_{\\text{in},4} = \\begin{pmatrix}\n0.5  2.0 + 0.2 i \\\\\n-1.0  -0.3\n\\end{pmatrix}.\n$$\n- Case $5$ (over-occupied mode and negative mode): Let $U_5$ be the discrete Fourier transform unitary\n$$\n(U_5)_{jk} = \\frac{1}{\\sqrt{3}} \\exp\\!\\left(\\frac{2\\pi i (j-1)(k-1)}{3}\\right),\\quad j,k \\in \\{1,2,3\\},\n$$\nwith\n$$\n\\Lambda_5 = \\operatorname{diag}(1.2, 0.9, -0.1),\\quad\n\\rho_{\\text{true},5} = U_5 \\Lambda_5 U_5^\\dagger,\n$$\nand anti-Hermitian perturbation constructed from a real matrix\n$$\nS = \\begin{pmatrix}\n0  1  2 \\\\\n3  4  5 \\\\\n6  7  8\n\\end{pmatrix},\\quad\nN_5 = 10^{-8}(S - S^\\top),\\quad\n\\rho_{\\text{in},5} = \\rho_{\\text{true},5} + N_5.\n$$\n\nFor each case $k \\in \\{1,2,3,4,5\\}$, your program must output the tuple of results $\\big[b_k, p_k, \\Delta_k\\big]$ where $b_k$ is the Hermiticity check boolean, $p_k$ is the positivity check boolean, and $\\Delta_k$ is the Frobenius norm change, each computed with tolerance $\\tau = 10^{-12}$.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each case reported as its own list, for example\n$$\n[ [b_1,p_1,\\Delta_1], [b_2,p_2,\\Delta_2], [b_3,p_3,\\Delta_3], [b_4,p_4,\\Delta_4], [b_5,p_5,\\Delta_5] ].\n$$\nThere are no physical units attached to these quantities and angles must be interpreted in radians as specified above.",
            "solution": "The user-provided problem is assessed to be **valid**. It is scientifically grounded in the principles of linear algebra and quantum mechanics, is well-posed with a unique and stable solution path, and is expressed in objective, formal language with all necessary information provided. The task is to implement a well-defined two-step procedure to correct a numerical one-particle reduced density matrix ($\\rho$) to ensure it is both Hermitian and positive semidefinite.\n\nThe procedure involves two sequential orthogonal projections in the space of complex matrices equipped with the Frobenius norm. Let $\\rho_{\\text{in}}$ be the input matrix.\n\n**Step 1: Projection onto the Subspace of Hermitian Matrices**\n\nA matrix $A$ is Hermitian if it is equal to its own conjugate transpose, i.e., $A = A^\\dagger$. The set of all $n \\times n$ Hermitian matrices forms a real vector subspace of the space of all $n \\times n$ complex matrices, $M_n(\\mathbb{C})$.\n\nAny complex matrix $\\rho_{\\text{in}} \\in M_n(\\mathbb{C})$ can be uniquely decomposed into the sum of a Hermitian matrix and a skew-Hermitian matrix (where $S = -S^\\dagger$):\n$$\n\\rho_{\\text{in}} = \\frac{\\rho_{\\text{in}} + \\rho_{\\text{in}}^\\dagger}{2} + \\frac{\\rho_{\\text{in}} - \\rho_{\\text{in}}^\\dagger}{2}\n$$\nThe first term, which we will call $\\rho_H = (\\rho_{\\text{in}} + \\rho_{\\text{in}}^\\dagger)/2$, is Hermitian:\n$$\n\\rho_H^\\dagger = \\left(\\frac{\\rho_{\\text{in}} + \\rho_{\\text{in}}^\\dagger}{2}\\right)^\\dagger = \\frac{\\rho_{\\text{in}}^\\dagger + (\\rho_{\\text{in}}^\\dagger)^\\dagger}{2} = \\frac{\\rho_{\\text{in}}^\\dagger + \\rho_{\\text{in}}}{2} = \\rho_H\n$$\nThe second term, $\\rho_S = (\\rho_{\\text{in}} - \\rho_{\\text{in}}^\\dagger)/2$, is skew-Hermitian.\n\nThe space $M_n(\\mathbb{C})$ can be viewed as an inner product space with the Frobenius inner product, $\\langle A, B \\rangle_F = \\text{Tr}(A^\\dagger B)$. The induced norm is the Frobenius norm, $\\|A\\|_F = \\sqrt{\\langle A, A \\rangle_F}$. The subspaces of Hermitian and skew-Hermitian matrices are orthogonal with respect to this inner product. Therefore, $\\rho_H$ is the orthogonal projection of $\\rho_{\\text{in}}$ onto the subspace of Hermitian matrices. This operation finds the closest Hermitian matrix to $\\rho_{\\text{in}}$ in the Frobenius norm sense.\n\n**Step 2: Projection onto the Cone of Positive Semidefinite Matrices**\n\nAfter the first step, we have a Hermitian matrix $\\rho_H$. The second step is to find the closest positive semidefinite matrix to $\\rho_H$. A matrix $A$ is positive semidefinite if it is Hermitian and all its eigenvalues are non-negative. The set of positive semidefinite matrices forms a convex cone.\n\nBy the spectral theorem, since $\\rho_H$ is Hermitian, it admits a spectral decomposition:\n$$\n\\rho_H = U \\Lambda U^\\dagger\n$$\nwhere $U$ is a unitary matrix whose columns are the eigenvectors of $\\rho_H$, and $\\Lambda$ is a real diagonal matrix whose entries are the corresponding eigenvalues, $\\Lambda = \\text{diag}(\\lambda_1, \\lambda_2, \\ldots, \\lambda_n)$.\n\nThe distance in the Frobenius norm between $\\rho_H$ and another matrix $X$ is unitarily invariant. If we express $X$ in the same eigenbasis as $X = U \\Lambda' U^\\dagger$, then:\n$$\n\\|\\rho_H - X\\|_F^2 = \\|U(\\Lambda - \\Lambda')U^\\dagger\\|_F^2 = \\|\\Lambda - \\Lambda'\\|_F^2 = \\sum_{i=1}^n (\\lambda_i - \\lambda'_i)^2\n$$\nTo find the closest positive semidefinite matrix, we need to minimize this sum subject to the constraint that $X$ is positive semidefinite, which means its eigenvalues $\\lambda'_i$ must be non-negative. The minimization problem decouples for each eigenvalue: for each $i$, we must find the non-negative number $\\lambda'_i$ that is closest to $\\lambda_i$. This is achieved by setting $\\lambda'_i = \\max(0, \\lambda_i)$.\n\nThis defines the diagonal matrix of clipped eigenvalues, $\\Lambda_+ = \\text{diag}(\\max(0, \\lambda_1), \\ldots, \\max(0, \\lambda_n))$. The resulting corrected matrix, which is the projection of $\\rho_H$ onto the positive semidefinite cone, is:\n$$\n\\rho_{\\text{corr}} = U \\Lambda_+ U^\\dagger\n$$\nThis matrix $\\rho_{\\text{corr}}$ is Hermitian by construction (since $U$ is unitary and $\\Lambda_+$ is real and diagonal) and positive semidefinite, as its eigenvalues are all non-negative.\n\n**Calculation of Output Metrics**\n\nThe algorithm is as follows:\n1.  Given $\\rho_{\\text{in}}$, compute the Hermitian projection: $\\rho_H = (\\rho_{\\text{in}} + \\rho_{\\text{in}}^\\dagger) / 2$.\n2.  Perform an eigendecomposition of $\\rho_H$ to get eigenvalues $\\lambda_i$ and the unitary matrix of eigenvectors $U$.\n3.  Clip the negative eigenvalues: $\\lambda_{i,+} = \\max(0, \\lambda_i)$.\n4.  Reconstruct the final corrected matrix: $\\rho_{\\text{corr}} = U \\, \\text{diag}(\\lambda_{i,+}) \\, U^\\dagger$.\n5.  Compute the Hermiticity check boolean $b_k$: $\\|\\rho_{\\text{corr}} - \\rho_{\\text{corr}}^\\dagger\\|_F \\le \\tau$, where $\\tau = 10^{-12}$. By construction, $\\rho_{\\text{corr}}$ is Hermitian, so this check should pass up to floating-point precision.\n6.  Compute the positivity check boolean $p_k$. This requires finding the smallest eigenvalue of $\\rho_{\\text{corr}}$. Since the eigenvalues of $\\rho_{\\text{corr}}$ are precisely the clipped values $\\lambda_{i,+}$, the smallest eigenvalue is $\\min(\\lambda_{i,+}) \\ge 0$. The check is $\\min(\\text{eig}(\\rho_{\\text{corr}})) \\ge -\\tau$.\n7.  Compute the Frobenius norm of the total change: $\\Delta_k = \\|\\rho_{\\text{corr}} - \\rho_{\\text{in}}\\|_F$.\n\nThis procedure will be applied to each of the five test cases specified.",
            "answer": "$$ \\boxed{[[\\text{true}, \\text{true}, 1.0000 \\times 10^{-8}], [\\text{true}, \\text{true}, 1.0000 \\times 10^{-6}], [\\text{true}, \\text{true}, 3.7417 \\times 10^{-10}], [\\text{true}, \\text{true}, 2.2385], [\\text{true}, \\text{true}, 0.10000]]} $$"
        }
    ]
}