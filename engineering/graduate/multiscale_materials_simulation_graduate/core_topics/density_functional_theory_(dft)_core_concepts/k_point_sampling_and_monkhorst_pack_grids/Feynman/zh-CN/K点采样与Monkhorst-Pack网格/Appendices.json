{
    "hands_on_practices": [
        {
            "introduction": "任何k点采样的过程都始于倒易晶格，它由材料的晶体结构唯一确定。本练习提供了基础性的实践，引导您完整推导六方晶系（一种常见且重要的非立方晶格类型）的倒易晶格基矢，并在此基础上显式地构建一个Monkhorst-Pack网格。完成这项练习将帮助您掌握从正空间晶格到k点网格生成的核心步骤。",
            "id": "3818403",
            "problem": "考虑一个三维六方布拉菲晶格，其常规晶胞参数为：沿晶格矢量 $\\mathbf{a}_{1}$、$\\mathbf{a}_{2}$ 和 $\\mathbf{a}_{3}$ 的长度分别为 $a$、$a$ 和 $c$，轴间角为 $(90^\\circ, 90^\\circ, 120^\\circ)$。在笛卡尔坐标系中，其正空间原胞矢量为\n$$\n\\mathbf{a}_{1} = a\\,(1,0,0),\\quad \\mathbf{a}_{2} = a\\left(\\frac{1}{2}, \\frac{\\sqrt{3}}{2}, 0\\right),\\quad \\mathbf{a}_{3} = c\\,(0,0,1).\n$$\n从倒易点阵的基本定义出发，即倒易原胞矢量 $\\mathbf{b}_{i}$ 满足 $\\mathbf{a}_{i}\\cdot \\mathbf{b}_{j} = 2\\pi\\,\\delta_{ij}$，完成以下任务：\n\n1) 推导倒易点阵原胞矢量 $\\mathbf{b}_{1}$、$\\mathbf{b}_{2}$ 和 $\\mathbf{b}_{3}$ 的笛卡尔分量。\n\n2) 根据布里渊区内具有反演对称性和周期性边界条件的均匀取样原理，明确构造一个 $6\\times 6\\times 4$ Monkhorst-Pack (MP) 网格的分数坐标集。此处，“分数坐标”指展开式 $\\mathbf{k}=u_{1}\\mathbf{b}_{1}+u_{2}\\mathbf{b}_{2}+u_{3}\\mathbf{b}_{3}$ 中的系数 $(u_{1},u_{2},u_{3})$。请提供沿每个倒易基矢方向的一维分数坐标列表，并指明完整的网格是它们的笛卡尔積；无需逐点列举。\n\n3) 设 $V_{\\text{BZ}}$ 表示倒易原胞的布里渊区体积，并设 $N_{k}=6\\times 6\\times 4$。假设 MP 网格上的权重是均匀的，计算由 $w = V_{\\text{BZ}}/N_{k}$ 定义的每个 $\\mathbf{k}$ 点的积分权重 $w$，并用 $a$ 和 $c$ 进行符号表示。将 $w$ 的最终答案以立方长度的倒数单位表示（例如，如果 $a$ 和 $c$ 的单位是 $\\text{\\AA}$，那么 $w$ 的单位是 $\\text{\\AA}^{-3}$）。不要代入任何数值。将最终答案表示为单个简化的解析表达式。不要四舍五入。",
            "solution": "我们从倒易点阵的定义开始。对于一组正空间原胞矢量 $\\{\\mathbf{a}_{1},\\mathbf{a}_{2},\\mathbf{a}_{3}\\}$，倒易原胞矢量 $\\{\\mathbf{b}_{1},\\mathbf{b}_{2},\\mathbf{b}_{3}\\}$ 由以下关系定义\n$$\n\\mathbf{a}_{i}\\cdot \\mathbf{b}_{j}=2\\pi\\,\\delta_{ij}.\n$$\n一种构造性表达式是\n$$\n\\mathbf{b}_{1} = 2\\pi\\,\\frac{\\mathbf{a}_{2}\\times \\mathbf{a}_{3}}{\\mathbf{a}_{1}\\cdot(\\mathbf{a}_{2}\\times \\mathbf{a}_{3})},\\quad\n\\mathbf{b}_{2} = 2\\pi\\,\\frac{\\mathbf{a}_{3}\\times \\mathbf{a}_{1}}{\\mathbf{a}_{1}\\cdot(\\mathbf{a}_{2}\\times \\mathbf{a}_{3})},\\quad\n\\mathbf{b}_{3} = 2\\pi\\,\\frac{\\mathbf{a}_{1}\\times \\mathbf{a}_{2}}{\\mathbf{a}_{1}\\cdot(\\mathbf{a}_{2}\\times \\mathbf{a}_{3})}.\n$$\n首先计算原胞体积 $ \\Omega $:\n$$\n\\Omega = \\mathbf{a}_{1}\\cdot(\\mathbf{a}_{2}\\times \\mathbf{a}_{3}).\n$$\n使用给定的矢量，\n$$\n\\mathbf{a}_{2}\\times \\mathbf{a}_{3} = a\\left(\\frac{1}{2}, \\frac{\\sqrt{3}}{2}, 0\\right)\\times c(0,0,1) = \\left(\\frac{\\sqrt{3}\\,a c}{2}, -\\frac{a c}{2}, 0\\right),\n$$\n所以\n$$\n\\Omega = \\mathbf{a}_{1}\\cdot(\\mathbf{a}_{2}\\times \\mathbf{a}_{3}) = a(1,0,0)\\cdot \\left(\\frac{\\sqrt{3}\\,a c}{2}, -\\frac{a c}{2}, 0\\right) = \\frac{\\sqrt{3}}{2}\\,a^{2}c.\n$$\n因此，\n$$\n\\mathbf{b}_{1} = 2\\pi\\,\\frac{\\left(\\frac{\\sqrt{3}\\,a c}{2}, -\\frac{a c}{2}, 0\\right)}{\\frac{\\sqrt{3}}{2}\\,a^{2}c} = \\frac{2\\pi}{a}\\left(1, -\\frac{1}{\\sqrt{3}}, 0\\right).\n$$\n接下来，\n$$\n\\mathbf{a}_{3}\\times \\mathbf{a}_{1} = c(0,0,1)\\times a(1,0,0) = (0, c a, 0),\n$$\n所以\n$$\n\\mathbf{b}_{2} = 2\\pi\\,\\frac{(0, c a, 0)}{\\frac{\\sqrt{3}}{2}\\,a^{2}c} = \\left(0, \\frac{4\\pi}{\\sqrt{3}\\,a}, 0\\right).\n$$\n最后，\n$$\n\\mathbf{a}_{1}\\times \\mathbf{a}_{2} = a(1,0,0)\\times a\\left(\\frac{1}{2}, \\frac{\\sqrt{3}}{2},0\\right) = \\left(0,0,\\frac{\\sqrt{3}}{2}\\,a^{2}\\right),\n$$\n得到\n$$\n\\mathbf{b}_{3} = 2\\pi\\,\\frac{\\left(0,0,\\frac{\\sqrt{3}}{2}\\,a^{2}\\right)}{\\frac{\\sqrt{3}}{2}\\,a^{2}c} = \\left(0,0,\\frac{2\\pi}{c}\\right).\n$$\n因此，倒易原胞矢量的笛卡尔分量为\n$$\n\\mathbf{b}_{1} = \\frac{2\\pi}{a}\\left(1, -\\frac{1}{\\sqrt{3}}, 0\\right),\\quad\n\\mathbf{b}_{2} = \\left(0, \\frac{4\\pi}{\\sqrt{3}\\,a}, 0\\right),\\quad\n\\mathbf{b}_{3} = \\left(0, 0, \\frac{2\\pi}{c}\\right).\n$$\n\n现在我们构造一个大小为 $6\\times 6\\times 4$ 的 Monkhorst-Pack 网格的分数坐标集。沿单个倒易点阵方向，对于偶数个点 $N$ 的均匀且具有反演对称性的取样，是通过将 $N$ 个点对称地置于原点周围、位置均匀分布且避开 $\\Gamma$ 点的方式获得的。由此得到的一维分数坐标 $\\{u_{m}\\}$ （在该方向上定义为 $k=u\\,b$）是\n$$\nu_{m}=\\frac{2 m - N - 1}{2 N},\\quad m=1,2,\\dots,N.\n$$\n对于 $N=6$，这得到\n$$\n\\left\\{-\\frac{5}{12},\\,-\\frac{3}{12},\\,-\\frac{1}{12},\\,\\frac{1}{12},\\,\\frac{3}{12},\\,\\frac{5}{12}\\right\\}\n=\n\\left\\{-\\frac{5}{12},\\,-\\frac{1}{4},\\,-\\frac{1}{12},\\,\\frac{1}{12},\\,\\frac{1}{4},\\,\\frac{5}{12}\\right\\}.\n$$\n对于 $N=4$，这得到\n$$\n\\left\\{-\\frac{3}{8},\\,-\\frac{1}{8},\\,\\frac{1}{8},\\,\\frac{3}{8}\\right\\}.\n$$\n因此，相对于 $(\\mathbf{b}_{1},\\mathbf{b}_{2},\\mathbf{b}_{3})$ 的 $6\\times 6\\times 4$ Monkhorst-Pack 网格的分数坐标 $(u_{1},u_{2},u_{3})$ 是以下三个列表的笛卡尔积\n$$\nu_{1}\\in \\left\\{-\\frac{5}{12},\\,-\\frac{1}{4},\\,-\\frac{1}{12},\\,\\frac{1}{12},\\,\\frac{1}{4},\\,\\frac{5}{12}\\right\\},\\quad\nu_{2}\\in \\left\\{-\\frac{5}{12},\\,-\\frac{1}{4},\\,-\\frac{1}{12},\\,\\frac{1}{12},\\,\\frac{1}{4},\\,\\frac{5}{12}\\right\\},\\quad\nu_{3}\\in \\left\\{-\\frac{3}{8},\\,-\\frac{1}{8},\\,\\frac{1}{8},\\,\\frac{3}{8}\\right\\}.\n$$\n\n最后，我们计算每个 $\\mathbf{k}$ 点的积分权重 $w$。原胞的布里渊区体积是一个经过充分验证的结果，\n$$\nV_{\\text{BZ}}=\\frac{(2\\pi)^{3}}{\\Omega},\n$$\n其中 $\\Omega$ 是正空间原胞的体积。我们已经求得 $\\Omega = \\frac{\\sqrt{3}}{2}\\,a^{2}c$。对于 $N_{k}=6\\times 6\\times 4=144$ 个均匀加权的点，\n$$\nw=\\frac{V_{\\text{BZ}}}{N_{k}} = \\frac{(2\\pi)^{3}}{\\Omega\\,N_{k}} = \\frac{8\\pi^{3}}{\\left(\\frac{\\sqrt{3}}{2}\\,a^{2}c\\right)\\cdot 144}.\n$$\n化简得，\n$$\nw = \\frac{8\\pi^{3}}{72\\sqrt{3}\\,a^{2}c} = \\frac{\\pi^{3}}{9\\sqrt{3}\\,a^{2}c}.\n$$\n这个 $w$ 是与每个 $\\mathbf{k}$ 点相关联的倒易空间体积。如果 $a$ 和 $c$ 的单位是 $\\text{\\AA}$，那么 $w$ 的单位是 $\\text{\\AA}^{-3}$。",
            "answer": "$$\\boxed{\\frac{\\pi^{3}}{9\\sqrt{3}\\,a^{2}c}}$$"
        },
        {
            "introduction": "一个常见的初学者错误是，无论晶胞形状如何，都在所有方向上使用相同数量的k点（例如 $N \\times N \\times N$）。本实践问题通过一个理论模型，揭示了为何这种方法对于各向异性体系是低效的，并可能导致显著的计算误差。理解这一原理对于为真实材料设计高效且准确的k点网格至关重要。",
            "id": "3818373",
            "problem": "考虑一个正交晶体，其原胞正格矢常数为 $a_{x}$、$a_{y}$ 和 $a_{z}$，它们产生的倒格矢模长为 $G_{x} = \\frac{2\\pi}{a_{x}}$、$G_{y} = \\frac{2\\pi}{a_{y}}$ 和 $G_{z} = \\frac{2\\pi}{a_{z}}$。第一布里渊区 (BZ) 取为矩形区域 $[-G_{x}/2,G_{x}/2] \\times [-G_{y}/2,G_{y}/2] \\times [-G_{z}/2,G_{z}/2]$。在诸如密度泛函理论 (DFT) 等电子结构计算中，光滑周期性可观测量在 BZ 上的积分使用均匀的 Monkhorst-Pack (MP) 网格进行近似，该网格在其最简单的形式下与 BZ 上的复合中点法则一致。\n\n假设 BZ 上的被积函数由其在 $\\Gamma$ 点（即 $\\mathbf{k} = \\mathbf{0}$）附近的二阶泰勒展开主导，并且是各向同性光滑但曲率上各向异性的：\n$$\nf(\\mathbf{k}) \\approx c + \\alpha_{x} k_{x}^{2} + \\alpha_{y} k_{y}^{2} + \\alpha_{z} k_{z}^{2},\n$$\n其中 $c$、$\\alpha_{x}$、$\\alpha_{y}$ 和 $\\alpha_{z}$ 是常数，$\\mathbf{k} = (k_{x},k_{y},k_{z})$ 的取值范围是整个 BZ。$f(\\mathbf{k})$ 在 BZ 上的精确积分 $I$ 定义为\n$$\nI = \\int_{-G_{x}/2}^{G_{x}/2} \\int_{-G_{y}/2}^{G_{y}/2} \\int_{-G_{z}/2}^{G_{z}/2} f(\\mathbf{k}) \\, \\mathrm{d}k_{x}\\,\\mathrm{d}k_{y}\\,\\mathrm{d}k_{z}.\n$$\n\n现在使用一个 $N \\times N \\times N$ 的 Monkhorst-Pack 网格来近似 $I$，每个方向的 $N$ 值相同，即采用复合中点法则，步长为 $\\Delta k_{x} = G_{x}/N$、$\\Delta k_{y} = G_{y}/N$ 和 $\\Delta k_{z} = G_{z}/N$，网格点位于\n$$\nk_{x,i} = -\\frac{G_{x}}{2} + \\left(i + \\frac{1}{2}\\right)\\Delta k_{x}, \\quad\nk_{y,j} = -\\frac{G_{y}}{2} + \\left(j + \\frac{1}{2}\\right)\\Delta k_{y}, \\quad\nk_{z,\\ell} = -\\frac{G_{z}}{2} + \\left(\\ell + \\frac{1}{2}\\right)\\Delta k_{z},\n$$\n其中 $i,j,\\ell \\in \\{0,1,\\dots,N-1\\}$。将此数值近似记为 $I_{N}$：\n$$\nI_{N} = \\Delta k_{x}\\Delta k_{y}\\Delta k_{z} \\sum_{i=0}^{N-1} \\sum_{j=0}^{N-1} \\sum_{\\ell=0}^{N-1} f(k_{x,i},k_{y,j},k_{z,\\ell}).\n$$\n\n从积分、网格和复合中点法则的定义出发，推导主阶积分误差 $E_{N} = I - I_{N}$ 的闭合形式表达式，该表达式是 $G_{x}$、$G_{y}$、$G_{z}$、$N$、$\\alpha_{x}$、$\\alpha_{y}$、$\\alpha_{z}$ 和 $c$ 的函数。明确展示当 $G_{x}$、$G_{y}$ 和 $G_{z}$ 高度各向异性时，沿所有倒格矢方向使用相同的 $N$ 如何导致分辨率不均匀，并在最终的误差表达式中量化这种各向异性。\n\n请以 $E_{N}$ 的单一闭合形式解析表达式的形式给出你的最终答案。不需要进行数值四舍五入，也不需要单位。",
            "solution": "积分误差定义为 $E_{N} = I - I_{N}$。推导过程首先计算精确积分 $I$，然后计算数值近似 $I_{N}$，最后计算它们的差值。\n\n**1. 计算精确积分 $I$**\n\n被积函数为 $f(\\mathbf{k}) = c + \\alpha_{x} k_{x}^{2} + \\alpha_{y} k_{y}^{2} + \\alpha_{z} k_{z}^{2}$。在 BZ 上的积分 $I$ 是可分离的：\n$$\nI = \\int_{BZ} (c + \\alpha_{x} k_{x}^{2} + \\alpha_{y} k_{y}^{2} + \\alpha_{z} k_{z}^{2}) \\, \\mathrm{d}^{3}k\n$$\n我们可以分别计算每一项。常数 $c$ 在 BZ 体积 $V_{BZ} = G_{x}G_{y}G_{z}$ 上的积分为：\n$$\n\\int_{BZ} c \\, \\mathrm{d}^{3}k = c V_{BZ} = c G_{x}G_{y}G_{z}\n$$\n项 $\\alpha_{x} k_{x}^{2}$ 的积分为：\n$$\n\\int_{BZ} \\alpha_{x} k_{x}^{2} \\, \\mathrm{d}^{3}k = \\alpha_{x} \\left( \\int_{-G_{x}/2}^{G_{x}/2} k_{x}^{2} \\, \\mathrm{d}k_{x} \\right) \\left( \\int_{-G_{y}/2}^{G_{y}/2} \\mathrm{d}k_{y} \\right) \\left( \\int_{-G_{z}/2}^{G_{z}/2} \\mathrm{d}k_{z} \\right)\n$$\n$k_{x}^{2}$ 的一维积分为：\n$$\n\\int_{-G_{x}/2}^{G_{x}/2} k_{x}^{2} \\, \\mathrm{d}k_{x} = \\left[\\frac{k_{x}^{3}}{3}\\right]_{-G_{x}/2}^{G_{x}/2} = \\frac{1}{3} \\left( \\left(\\frac{G_{x}}{2}\\right)^{3} - \\left(-\\frac{G_{x}}{2}\\right)^{3} \\right) = \\frac{1}{3} \\left( \\frac{G_{x}^{3}}{8} + \\frac{G_{x}^{3}}{8} \\right) = \\frac{G_{x}^{3}}{12}\n$$\n因此，$\\alpha_{x} k_{x}^{2}$ 项的积分为 $\\alpha_{x} (\\frac{G_{x}^{3}}{12}) G_{y} G_{z}$。根据对称性，$y$ 和 $z$ 分量的积分是类似的。将所有项相加，精确积分 $I$ 为：\n$$\nI = c G_{x}G_{y}G_{z} + \\frac{\\alpha_{x} G_{x}^{3} G_{y} G_{z}}{12} + \\frac{\\alpha_{y} G_{x} G_{y}^{3} G_{z}}{12} + \\frac{\\alpha_{z} G_{x} G_{y} G_{z}^{3}}{12}\n$$\n$$\nI = G_{x}G_{y}G_{z} \\left( c + \\frac{1}{12}(\\alpha_{x} G_{x}^{2} + \\alpha_{y} G_{y}^{2} + \\alpha_{z} G_{z}^{2}) \\right)\n$$\n\n**2. 计算数值近似 $I_{N}$**\n\n数值积分 $I_{N}$ 由下式给出：\n$$\nI_{N} = \\Delta k_{x}\\Delta k_{y}\\Delta k_{z} \\sum_{i=0}^{N-1} \\sum_{j=0}^{N-1} \\sum_{\\ell=0}^{N-1} f(k_{x,i}, k_{y,j}, k_{z,\\ell})\n$$\n体积元为 $\\Delta k_{x}\\Delta k_{y}\\Delta k_{z} = (\\frac{G_{x}}{N})(\\frac{G_{y}}{N})(\\frac{G_{z}}{N}) = \\frac{G_{x}G_{y}G_{z}}{N^{3}}$。代入 $f(\\mathbf{k})$ 的表达式：\n$$\n\\sum_{i,j,\\ell} f = \\sum_{i,j,\\ell} (c + \\alpha_{x} k_{x,i}^{2} + \\alpha_{y} k_{y,j}^{2} + \\alpha_{z} k_{z,\\ell}^{2})\n$$\n该求和也是可分离的。对常数项 $c$ 的求和为 $\\sum_{i,j,\\ell} c = c \\sum_{i=0}^{N-1} 1 \\sum_{j=0}^{N-1} 1 \\sum_{\\ell=0}^{N-1} 1 = c N^{3}$。常数项对 $I_{N}$ 的贡献是 $(\\frac{G_{x}G_{y}G_{z}}{N^{3}}) (c N^{3}) = c G_{x}G_{y}G_{z}$。这与 $I$ 中的对应项相同，因为中点法则能精确积分常数函数。\n\n现在考虑 $\\alpha_{x}k_{x}^{2}$ 项。它对求和的贡献是：\n$$\n\\sum_{i,j,\\ell} \\alpha_{x} k_{x,i}^{2} = \\alpha_{x} \\left(\\sum_{i=0}^{N-1} k_{x,i}^{2}\\right) \\left(\\sum_{j=0}^{N-1} 1\\right) \\left(\\sum_{\\ell=0}^{N-1} 1\\right) = \\alpha_{x} N^{2} \\sum_{i=0}^{N-1} k_{x,i}^{2}\n$$\n为了计算这个，我们需要求和 $\\sum_{i=0}^{N-1} k_{x,i}^{2}$。网格点为 $k_{x,i} = -\\frac{G_{x}}{2} + (i + \\frac{1}{2})\\frac{G_{x}}{N} = \\frac{G_{x}}{2N}(-N + 2i + 1)$。平方和为：\n$$\n\\sum_{i=0}^{N-1} k_{x,i}^{2} = \\frac{G_{x}^{2}}{4N^{2}} \\sum_{i=0}^{N-1} (-N+1+2i)^{2} = \\frac{G_{x}^{2}}{4N^{2}} \\frac{N(N^{2}-1)}{3} = \\frac{G_{x}^{2}(N^{2}-1)}{12N}\n$$\n$\\alpha_{x}$ 项对 $I_{N}$ 的总贡献是：\n$$\n(\\frac{G_{x}G_{y}G_{z}}{N^{3}}) \\left(\\alpha_{x} N^{2} \\frac{G_{x}^{2}(N^{2}-1)}{12N}\\right) = \\frac{\\alpha_{x} G_{x}^{3} G_{y} G_{z} (N^{2}-1)}{12N^{2}}\n$$\n将 $I_{N}$ 的所有项相加：\n$$\nI_{N} = c G_{x}G_{y}G_{z} + \\frac{\\alpha_{x} G_{x}^{3} G_{y} G_{z} (N^{2}-1)}{12N^{2}} + \\frac{\\alpha_{y} G_{x} G_{y}^{3} G_{z} (N^{2}-1)}{12N^{2}} + \\frac{\\alpha_{z} G_{x} G_{y} G_{z}^{3} (N^{2}-1)}{12N^{2}}\n$$\n$$\nI_{N} = G_{x}G_{y}G_{z} \\left( c + \\frac{N^{2}-1}{12N^{2}}(\\alpha_{x} G_{x}^{2} + \\alpha_{y} G_{y}^{2} + \\alpha_{z} G_{z}^{2}) \\right)\n$$\n\n**3. 计算积分误差 $E_{N}$**\n\n误差是差值 $E_{N} = I - I_{N}$：\n$$\nE_{N} = G_{x}G_{y}G_{z} \\left( c + \\frac{1}{12} \\sum_{j=x,y,z} \\alpha_{j}G_{j}^{2} \\right) - G_{x}G_{y}G_{z} \\left( c + \\frac{N^{2}-1}{12N^{2}} \\sum_{j=x,y,z} \\alpha_{j}G_{j}^{2} \\right)\n$$\n常数项 $c$ 消去了。剩余的项给出：\n$$\nE_{N} = \\frac{G_{x}G_{y}G_{z}}{12} \\left( \\sum_{j=x,y,z} \\alpha_{j}G_{j}^{2} \\right) \\left( 1 - \\frac{N^{2}-1}{N^{2}} \\right)\n$$\n$$\nE_{N} = \\frac{G_{x}G_{y}G_{z}}{12} \\left( \\alpha_{x}G_{x}^{2} + \\alpha_{y}G_{y}^{2} + \\alpha_{z}G_{z}^{2} \\right) \\left( \\frac{N^{2} - (N^{2}-1)}{N^{2}} \\right)\n$$\n$$\nE_{N} = \\frac{G_{x}G_{y}G_{z}}{12N^{2}} (\\alpha_{x} G_{x}^{2} + \\alpha_{y} G_{y}^{2} + \\alpha_{z} G_{z}^{2})\n$$\n\n**4. 误差项与各向异性分析**\n\n最终的误差表达式 $E_{N} = \\frac{V_{BZ}}{12N^{2}} \\sum_{j=x,y,z} \\alpha_{j}G_{j}^{2}$ 表明，总误差是来自每个方向的贡献之和，而来自方向 $j$ 的贡献与 $G_{j}^{2}$ 成正比。这意味着误差对布里渊区的最大维度高度敏感。如果一个维度（例如 $G_{x}$）显著大于其他维度，其对应的项 $\\frac{V_{BZ}}{12N^{2}}\\alpha_{x}G_{x}^{2}$ 将主导总误差。因此，对于各向异性系统，在每个方向上使用相同数量的 k 点 $N$ 是一种低效的策略，因为积分精度受限于沿倒易空间最长方向的粗糙采样。",
            "answer": "$$\n\\boxed{\\frac{G_x G_y G_z}{12 N^2}(\\alpha_x G_x^2 + \\alpha_y G_y^2 + \\alpha_z G_z^2)}\n$$"
        },
        {
            "introduction": "在选定网格密度之后，不同的采样方案仍可能产生不同的精度。本计算练习要求您比较两种最普遍使用的方法：包含$\\Gamma$点的网格与在各方向上偏移半步长的Monkhorst-Pack网格。通过实现一个简单的紧束缚模型，您将亲身体验并验证偏移网格对于平滑被积函数所具有的更优收敛性，这是进行实际计算时的一个关键考量。",
            "id": "3818397",
            "problem": "您的任务是构建一个数值实验，比较在使用两种不同的$\\mathbf{k}$点采样方案时，简单立方绝缘体在第一布里渊区（BZ）中总能量估算的收敛行为。这两种方案是：以$\\Gamma$点为中心的网格和半步平移的Monkhorst-Pack网格。请完全在一个受物理启发的、但纯粹的数学模型内工作，该模型基于一个晶格常数$a=1$的简单立方晶格上的双带紧束缚绝缘体。所有角度都必须以弧度处理。\n\n基本原理：\n- 对于简单立方晶格，在约化单位下，第一布里渊区（BZ）是立方体$\\left[-\\pi,\\pi\\right]^3$。\n- 一个光滑、有带隙的双带紧束缚绝缘体可以用价带能量来建模：\n$$\nE_{\\mathrm{v}}(\\mathbf{k}) = -\\sqrt{\\Delta^2 + \\left(2t\\,\\sum_{i\\in\\{x,y,z\\}}\\cos k_i\\right)^2},\n$$\n其中$\\Delta>0$是带隙参数，$t>0$是最近邻跃迁参数。这是一个在布里渊区上关于$\\mathbf{k}$的光滑偶函数。\n- 被占据价带的单位晶胞布里渊区平均总能量是$E_{\\mathrm{v}}(\\mathbf{k})$在布里渊区上的平均值：\n$$\n\\bar{E} = \\frac{1}{(2\\pi)^3}\\int_{-\\pi}^{\\pi}\\int_{-\\pi}^{\\pi}\\int_{-\\pi}^{\\pi} E_{\\mathrm{v}}(k_x,k_y,k_z)\\,\\mathrm{d}k_x\\,\\mathrm{d}k_y\\,\\mathrm{d}k_z.\n$$\n\n离散布里渊区采样：\n- 对于大小为$N\\times N\\times N$的均匀$\\mathbf{k}$点网格，其中$N\\in\\mathbb{N}$，定义步长$\\Delta k = \\frac{2\\pi}{N}$。\n- 沿每个轴定义以$\\Gamma$为中心的一维网格：\n$$\nk^{(\\Gamma)}_r = -\\pi + \\Delta k\\cdot r,\\quad r\\in\\{0,1,\\dots,N-1\\}.\n$$\n- 沿每个轴定义半步平移的一维网格：\n$$\nk^{(\\mathrm{sh})}_r = -\\pi + \\Delta k\\cdot\\left(r+\\tfrac{1}{2}\\right),\\quad r\\in\\{0,1,\\dots,N-1\\}.\n$$\n- 通过各自在$k_x$、$k_y$和$k_z$方向上的一维网格的笛卡尔积，构建$N\\times N\\times N$的三维网格。\n- 任一网格的离散布里渊区平均能量估算值为均匀平均值：\n$$\n\\bar{E}_N^{(\\cdot)} = \\frac{1}{N^3}\\sum_{r,s,u=0}^{N-1} E_{\\mathrm{v}}\\!\\left(k^{(\\cdot)}_r,k^{(\\cdot)}_s,k^{(\\cdot)}_u\\right).\n$$\n- 使用一个在$N_{\\mathrm{ref}}=80$的精细$\\Gamma$中心网格上计算出的高度收敛的参考值$\\bar{E}_{\\mathrm{ref}}$。\n\n目标：\n- 实现两种采样方案，并计算绝对误差$\\left|\\bar{E}_N^{(\\cdot)} - \\bar{E}_{\\mathrm{ref}}\\right|$。\n- 对于每个测试用例，报告$\\Gamma$中心网格和移位网格的绝对误差之差：\n$$\n\\Delta\\mathrm{err} = \\left|\\bar{E}_N^{(\\Gamma)} - \\bar{E}_{\\mathrm{ref}}\\right| - \\left|\\bar{E}_N^{(\\mathrm{sh})} - \\bar{E}_{\\mathrm{ref}}\\right|.\n$$\n负的$\\Delta\\mathrm{err}$表示$\\Gamma$中心网格更准确；正的$\\Delta\\mathrm{err}$表示移位网格更准确。能量是无量纲的，以$t$为单位。\n\n测试套件：\n- 使用以下参数集$(N,\\Delta,t)$:\n    1. $\\left(6,\\,2.0,\\,1.0\\right)$\n    2. $\\left(6,\\,0.5,\\,1.0\\right)$\n    3. $\\left(6,\\,10.0,\\,1.0\\right)$\n    4. $\\left(4,\\,2.0,\\,1.0\\right)$\n    5. $\\left(8,\\,2.0,\\,1.0\\right)$\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$\\left[\\mathrm{result1},\\mathrm{result2},\\mathrm{result3}\\right]$），其中每个$\\mathrm{result}$是对应于上述顺序中一个测试用例的浮点数$\\Delta\\mathrm{err}$。",
            "solution": "该问题的核心是实现一个数值实验，以比较两种$\\mathbf{k}$点采样方案的收敛行为：以$\\Gamma$点为中心的网格和半步平移的Monkhorst-Pack网格。该数值实验基于一个双带紧束缚模型。对于光滑的被积函数，如本问题中的绝缘体能带，平移网格（Monkhorst-Pack）通常比包含布里渊区高对称点（如$\\Gamma$点）的网格具有更快的收敛速度，因为它可以更好地避免函数泰勒展开中偶数阶导数项的系统性误差。\n\n解决方案的算法步骤如下：\n1.  实现一个函数，根据给定的物理参数($\\Delta, t$)、网格尺寸($N$)和网格类型（以$\\Gamma$为中心或平移），计算离散的布里渊区平均能量$\\bar{E}_N$。此函数首先生成一维$\\mathbf{k}$点坐标，然后使用笛卡尔积（例如，通过`meshgrid`）构建三维网格，接着在每个网格点上计算能量$E_{\\mathrm{v}}(\\mathbf{k})$，最后求取所有能量值的算术平均值。\n2.  为每个测试用例中的物理参数($\\Delta, t$)，使用一个精细的$N_{\\mathrm{ref}}=80$的$\\Gamma$中心网格计算一个高度收敛的参考能量$\\bar{E}_{\\mathrm{ref}}$。\n3.  遍历每个测试用例，计算其对应的$\\bar{E}_N^{(\\Gamma)}$和$\\bar{E}_N^{(\\mathrm{sh})}$。\n4.  计算两种方案的绝对误差：$\\mathrm{err}^{(\\Gamma)} = |\\bar{E}_N^{(\\Gamma)} - \\bar{E}_{\\mathrm{ref}}|$ 和 $\\mathrm{err}^{(\\mathrm{sh})} = |\\bar{E}_N^{(\\mathrm{sh})} - \\bar{E}_{\\mathrm{ref}}|$。\n5.  最后，计算并报告目标值，即绝对误差之差：$\\Delta\\mathrm{err} = \\mathrm{err}^{(\\Gamma)} - \\mathrm{err}^{(\\mathrm{sh})}$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of comparing k-point sampling schemes for a tight-binding insulator.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, Delta, t)\n        (6, 2.0, 1.0),\n        (6, 0.5, 1.0),\n        (6, 10.0, 1.0),\n        (4, 2.0, 1.0),\n        (8, 2.0, 1.0),\n    ]\n\n    def calculate_average_energy(N: int, delta: float, t: float, grid_type: str) -> float:\n        \"\"\"\n        Calculates the discrete BZ-averaged energy for a given grid.\n\n        Args:\n            N (int): The number of k-points along each dimension of the grid (N x N x N).\n            delta (float): The band gap parameter.\n            t (float): The hopping parameter.\n            grid_type (str): The type of grid, either 'gamma' or 'shifted'.\n\n        Returns:\n            float: The computed average energy.\n        \"\"\"\n        if N == 0:\n            raise ValueError(\"Grid size N must be positive.\")\n\n        # Define the 1D k-point grid\n        dk = 2.0 * np.pi / N\n        r = np.arange(N)\n        \n        if grid_type == 'gamma':\n            k_1d = -np.pi + dk * r\n        elif grid_type == 'shifted':\n            k_1d = -np.pi + dk * (r + 0.5)\n        else:\n            raise ValueError(\"Invalid grid_type. Must be 'gamma' or 'shifted'.\")\n\n        # Create the 3D grid of k-points using np.meshgrid\n        kx, ky, kz = np.meshgrid(k_1d, k_1d, k_1d, indexing='ij')\n\n        # Calculate the energy at each k-point\n        # E_v(k) = -sqrt(Delta^2 + (2*t * (cos(kx) + cos(ky) + cos(kz)))^2)\n        cos_sum = np.cos(kx) + np.cos(ky) + np.cos(kz)\n        energy_grid = -np.sqrt(delta**2 + (2.0 * t * cos_sum)**2)\n\n        # The discrete average energy is the mean of all values on the grid.\n        # np.mean correctly sums all elements and divides by N*N*N.\n        return np.mean(energy_grid)\n\n    results = []\n    # Memoization cache for reference energies to avoid re-computation\n    ref_energy_cache = {}\n    N_ref = 80\n\n    for case in test_cases:\n        N, delta, t = case\n        \n        # Define a key for caching based on physical parameters\n        ref_key = (delta, t)\n\n        # Compute reference energy if not already cached\n        if ref_key not in ref_energy_cache:\n            E_ref = calculate_average_energy(N_ref, delta, t, grid_type='gamma')\n            ref_energy_cache[ref_key] = E_ref\n        else:\n            E_ref = ref_energy_cache[ref_key]\n\n        # Calculate energy for the Gamma-centered grid\n        E_N_gamma = calculate_average_energy(N, delta, t, grid_type='gamma')\n\n        # Calculate energy for the shifted (Monkhorst-Pack) grid\n        E_N_shifted = calculate_average_energy(N, delta, t, grid_type='shifted')\n\n        # Calculate the absolute errors\n        err_gamma = np.abs(E_N_gamma - E_ref)\n        err_shifted = np.abs(E_N_shifted - E_ref)\n        \n        # Calculate the difference in errors\n        delta_err = err_gamma - err_shifted\n        \n        results.append(delta_err)\n\n    # Format the final output as a comma-separated list in brackets\n    # Using a format specifier for consistent representation of floats.\n    formatted_results = [f\"{res:.12f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```"
        }
    ]
}