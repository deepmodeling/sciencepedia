{
    "hands_on_practices": [
        {
            "introduction": "理解局域密度近似（LDA）的第一步是掌握其数学基础。本练习将带你从均匀电子气的第一性原理出发，推导LDA交换能泛函。然后，你将把这个泛函应用到一个假设的、可以解析求解的密度分布上，从而锻炼处理密度泛函理论（DFT）中泛函所必需的数学技能。",
            "id": "3820908",
            "problem": "在多尺度材料模拟中，密度泛函理论（DFT）中的局域密度近似（LDA）通过假设空间中的每个点在局域上表现得像一个具有相同局域密度的均匀电子气，来模拟非均匀电子体系的交换能。考虑一个三维空间中的自旋非极化电子体系，并采用Hartree原子单位，使得基本电荷、约化普朗克常数和电子质量满足$e=1$，$\\hbar=1$和$m_e=1$，且能量以Hartree为单位。\n\n从关于均匀电子气的以下经过充分验证的事实出发：\n- 对于数密度为$\\rho$的自旋非极化电子气，其费米波矢为$k_{F}=(3\\pi^{2}\\rho)^{1/3}$。\n- 每个电子的Hartree–Fock交换能为$\\varepsilon_{x}(\\rho)=-\\frac{3}{4\\pi}k_{F}$，\n\n通过应用上述局域性假设，推导在三维空间中对于一般的非均匀自旋非极化密度$\\rho(\\mathbf{r})$的LDA交换能泛函$E_{x}^{\\mathrm{LDA}}[\\rho]$。然后，对于球对称密度分布$\\rho(\\mathbf{r})=\\rho_{0}\\exp(-a r)$（其中$\\rho_{0}>0$，$a>0$，$r=|\\mathbf{r}|$），计算该泛函的值。\n\n将最终答案表示为以$\\rho_{0}$和$a$表示的单个闭式解析表达式。能量以Hartree表示。不要四舍五入；不需要进行数值近似。",
            "solution": "该问题要求推导交换能泛函的局域密度近似（LDA）$E_{x}^{\\mathrm{LDA}}[\\rho]$，并随后针对一个特定的球对称电子密度分布计算其值。推导将在Hartree原子单位下进行，其中基本电荷$e=1$，约化普朗克常数$\\hbar=1$，电子质量$m_e=1$。\n\n首先，我们推导$E_{x}^{\\mathrm{LDA}}[\\rho]$的一般表达式。LDA的基本假设是，非均匀电子体系中某一点$\\mathbf{r}$的交换能密度仅取决于该点的电子密度$\\rho(\\mathbf{r})$，并且这种关系与密度为$\\rho$的均匀电子气（HEG）中的关系相同。\n\n密度为$\\rho$的HEG中每个电子的交换能由$\\varepsilon_{x}(\\rho)$给出。来自无穷小体积元$d^3\\mathbf{r}$的总交换能贡献是每个电子的能量与该体积内的电子数$\\rho(\\mathbf{r}) d^3\\mathbf{r}$的乘积。此贡献为$dE_{x} = \\varepsilon_{x}(\\rho(\\mathbf{r})) \\rho(\\mathbf{r}) d^3\\mathbf{r}$。\n\n为了获得总交换能泛函，我们将此能量密度在整个空间上积分：\n$$E_{x}^{\\mathrm{LDA}}[\\rho] = \\int \\varepsilon_{x}(\\rho(\\mathbf{r})) \\rho(\\mathbf{r}) \\, d^3\\mathbf{r}$$\n问题提供了自旋非极化HEG所需的关系式：\n1.  费米波矢：$k_{F}=(3\\pi^{2}\\rho)^{1/3}$\n2.  每个电子的交换能：$\\varepsilon_{x}(\\rho)=-\\frac{3}{4\\pi}k_{F}$\n\n将$k_F$的表达式代入$\\varepsilon_x(\\rho)$，我们得到每个电子的交换能作为密度$\\rho$的显式函数：\n$$\\varepsilon_{x}(\\rho) = -\\frac{3}{4\\pi}(3\\pi^{2}\\rho)^{1/3} = -\\frac{3}{4\\pi}(3\\pi^{2})^{1/3}\\rho^{1/3}$$\n让我们定义一个常数$C_{x} = \\frac{3}{4\\pi}(3\\pi^{2})^{1/3}$。那么$\\varepsilon_{x}(\\rho) = -C_{x}\\rho^{1/3}$。\n\n现在，我们将其代入总交换能泛函的积分中：\n$$E_{x}^{\\mathrm{LDA}}[\\rho] = \\int (-C_{x}\\rho(\\mathbf{r})^{1/3}) \\rho(\\mathbf{r}) \\, d^3\\mathbf{r} = -C_{x} \\int \\rho(\\mathbf{r})^{4/3} \\, d^3\\mathbf{r}$$\n这就是自旋非极化体系的LDA交换能泛函的一般形式。\n\n接下来，我们为给定的球对称密度分布$\\rho(\\mathbf{r})=\\rho_{0}\\exp(-a r)$（其中$r=|\\mathbf{r}|$，$\\rho_{0}>0$，$a>0$）计算此泛函的值。\n将此密度代入泛函，得到：\n$$E_{x} = -C_{x} \\int \\left(\\rho_{0}\\exp(-a r)\\right)^{4/3} \\, d^3\\mathbf{r}$$\n$$E_{x} = -C_{x} \\rho_{0}^{4/3} \\int \\exp\\left(-\\frac{4}{3}ar\\right) \\, d^3\\mathbf{r}$$\n被积函数是球对称的，因此使用球坐标$(r, \\theta, \\phi)$是有利的，其中体积元为$d^3\\mathbf{r} = r^2 \\sin\\theta \\, dr \\, d\\theta \\, d\\phi$。积分变为：\n$$ \\int \\exp\\left(-\\frac{4}{3}ar\\right) \\, d^3\\mathbf{r} = \\int_{0}^{2\\pi} d\\phi \\int_{0}^{\\pi} \\sin\\theta \\, d\\theta \\int_{0}^{\\infty} r^2 \\exp\\left(-\\frac{4}{3}ar\\right) \\, dr $$\n积分的角度部分是整个球面的立体角：\n$$ \\int_{0}^{2\\pi} d\\phi \\int_{0}^{\\pi} \\sin\\theta \\, d\\theta = (2\\pi) [-\\cos\\theta]_{0}^{\\pi} = 2\\pi(1 - (-1)) = 4\\pi $$\n径向部分是一个标准的与伽马函数相关的积分，形式为$\\int_{0}^{\\infty} x^n \\exp(-bx) dx = \\frac{n!}{b^{n+1}}$。这里，$n=2$，衰减常数为$b = \\frac{4a}{3}$。\n$$ \\int_{0}^{\\infty} r^2 \\exp\\left(-\\frac{4a}{3}r\\right) \\, dr = \\frac{2!}{\\left(\\frac{4a}{3}\\right)^{3}} = \\frac{2}{\\frac{64a^3}{27}} = \\frac{54}{64a^3} = \\frac{27}{32a^3} $$\n结合角度和径向部分，空间积分的计算结果为：\n$$ \\int \\exp\\left(-\\frac{4}{3}ar\\right) \\, d^3\\mathbf{r} = (4\\pi) \\left(\\frac{27}{32a^3}\\right) = \\frac{27\\pi}{8a^3} $$\n现在，我们将此结果代回能量$E_x$的表达式中：\n$$ E_{x} = -C_{x} \\rho_{0}^{4/3} \\left(\\frac{27\\pi}{8a^3}\\right) $$\n最后，我们代入常数$C_{x} = \\frac{3}{4\\pi}(3\\pi^{2})^{1/3}$的完整表达式：\n$$ E_{x} = -\\left[\\frac{3}{4\\pi}(3\\pi^{2})^{1/3}\\right] \\rho_{0}^{4/3} \\left(\\frac{27\\pi}{8a^3}\\right) $$\n让我们简化这个表达式：\n$$ E_{x} = -\\frac{3 \\cdot 27\\pi}{4\\pi \\cdot 8a^3} (3\\pi^2)^{1/3} \\rho_{0}^{4/3} $$\n分子和分母中的因子$\\pi$相互消去：\n$$ E_{x} = -\\frac{81}{32a^3} (3^{1/3}\\pi^{2/3}) \\rho_{0}^{4/3} $$\n为了将其写成单项式，我们合并数值常数。注意$81 = 3^4$：\n$$ E_{x} = -\\frac{3^4 \\cdot 3^{1/3} \\pi^{2/3}}{32a^3} \\rho_{0}^{4/3} = -\\frac{3^{13/3} \\pi^{2/3}}{32a^3} \\rho_{0}^{4/3} $$\n这个表达式可以重排以将常数和参数分组：\n$$ E_{x} = -\\frac{3^{13/3} \\pi^{2/3}}{32} \\frac{\\rho_{0}^{4/3}}{a^{3}} $$\n这就是给定密度分布的交换能的最终闭式解析表达式，以Hartree为单位。",
            "answer": "$$\\boxed{-\\frac{3^{13/3} \\pi^{2/3} \\rho_{0}^{4/3}}{32 a^{3}}}$$"
        },
        {
            "introduction": "在掌握了LDA泛函的基本形式后，下一步是探究其局限性。本练习将引导你计算自相互作用误差（SIE），这是LDA的一个主要概念缺陷，我们会使用最简单的情形：氢原子中的单电子。通过比较LDA交换能对哈特里（Hartree）能量的不完全抵消，这个练习可以让你对自相互作用误差有一个清晰、定量的理解。",
            "id": "3820942",
            "problem": "考虑一个在 Kohn–Sham 密度泛函理论 (KS-DFT) 框架下描述的单电子体系。在局域密度近似 (LDA) 中，交换能泛函是通过对在局域密度下计算的三维均匀电子气 (UEG) 的交换能密度进行积分来构建的。假设单位粒子的 UEG 交换能是一个经过充分检验的事实，其大小取决于费米波矢 $k_{F}$，并且费米波矢通过 $k_{F}=(3\\pi^{2}\\rho)^{1/3}$ 与局域密度相关。经典静电 (Hartree) 能量由电荷密度与其自身的库仑排斥的双重积分给出，对于单电子体系，精确交换必须完全抵消该 Hartree 能量。\n\n给定归一化的类氢原子 $1s$ 电子密度\n$$\\rho(r)=\\frac{1}{\\pi}a_{0}^{-3}\\exp\\!\\left(-\\frac{2r}{a_{0}}\\right),$$\n其中 $a_{0}$ 是玻尔半径。\n\n从上述基本事实和定义（KS-DFT、基于 UEG 构建的 LDA、$k_{F}$ 与 $\\rho$ 之间的关系，以及作为库仑双重积分的 Hartree 能量定义）出发，完成以下任务：\n\n1. 将 LDA 交换能 $E_{x}^{\\mathrm{LDA}}[\\rho]$ 表示为在 $\\rho(r)$ 处计算的 UEG 交换能密度的空间积分，并以闭合形式进行积分，从而推导出给定 $\\rho(r)$ 的该能量值。\n2. 使用 Hartree 能量的基本定义\n$$E_{H}[\\rho]=\\frac{1}{2}\\int d^{3}r\\int d^{3}r'\\,\\frac{\\rho(\\mathbf{r})\\,\\rho(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|},$$\n以闭合形式计算给定 $\\rho(r)$ 的 $E_{H}[\\rho]$。\n3. 对于单电子体系，精确交换必须满足 $E_{x}^{\\mathrm{exact}}[\\rho]=-E_{H}[\\rho]$。通过计算以下表达式来诊断自相互作用误差的大小\n$$\\Delta_{\\mathrm{SIE}}=E_{H}[\\rho]+E_{x}^{\\mathrm{LDA}}[\\rho],$$\n并以单一闭合形式的解析表达式提供最终结果。\n\n所有能量均以哈特里（原子单位）表示。不需要进行数值取整；以 $a_{0}$ 和标准常数的形式提供精确表达式。最终答案必须是 $\\Delta_{\\mathrm{SIE}}$ 的单一表达式。",
            "solution": "用户提供了一个问题，要求计算局域密度近似 (LDA) 对单电子体系（特别是处于基态的氢原子）的自相互作用误差 (SIE)。该问题包含三个部分：(1) 计算 LDA 交换能，(2) 计算经典 Hartree 自排斥能，(3) 结合这两者以求出自相互作用误差。所有能量都将以哈特里原子单位表示，基本常数保留为符号形式。\n\n### 步骤1：问题陈述的验证\n\n对该问题进行严格的验证过程。\n\n**提取的已知条件：**\n*   **体系：** Kohn–Sham 密度泛函理论 (KS-DFT) 中的单电子体系。\n*   **近似：** 交换泛函的局域密度近似 (LDA)。\n*   **LDA 交换来源：** 三维均匀电子气 (UEG) 的交换能密度。\n*   **单位粒子的 UEG 交换能：** 表述为一个“经过充分检验的事实”，其大小取决于费米波矢 $k_{F}$。\n*   **费米波矢与密度的关系：** $k_{F}=(3\\pi^{2}\\rho)^{1/3}$。\n*   **Hartree 能量：** $E_{H}[\\rho]=\\frac{1}{2}\\int d^{3}r\\int d^{3}r'\\,\\frac{\\rho(\\mathbf{r})\\,\\rho(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}$。\n*   **精确交换条件：** 对于单电子体系，$E_{x}^{\\mathrm{exact}}[\\rho]=-E_{H}[\\rho]$。\n*   **电子密度：** 归一化的类氢原子 $1s$ 密度，$\\rho(r)=\\frac{1}{\\pi}a_{0}^{-3}\\exp(-\\frac{2r}{a_{0}})$，其中 $a_{0}$ 是玻尔半径。\n*   **任务：** 计算自相互作用误差，$\\Delta_{\\mathrm{SIE}}=E_{H}[\\rho]+E_{x}^{\\mathrm{LDA}}[\\rho]$。\n\n**验证分析：**\n该问题具有科学依据，植根于密度泛函理论的基本原理。LDA、均匀电子气、Hartree 能量和自相互作用误差等概念在该领域是标准且明确定义的。所提供的电子密度是氢原子的正确基态电荷密度。$k_F$ 和 $\\rho$ 之间的关系是三维自由电子气的标准关系。对于单电子体系，$E_{x}^{\\mathrm{exact}}[\\rho]=-E_{H}[\\rho]$ 的前提是精确 DFT 的一个基石。\n\n虽然问题没有明确给出 UEG 交换能的公式，但它将其称为一个“经过充分检验的事实”。这意味着需要使用标准的 Dirac 交换公式，这在该领域是常识，因此不构成致命的遗漏。问题提法得当，提供了所有必要的组成部分，以得出一个唯一且有意义的解。语言客观而精确。因此，该问题被认定为有效。\n\n### 步骤2：解题推导\n\n我们按要求进行三项计算。在整个推导过程中，我们在原子单位制中进行，其中 $\\hbar=m_{e}=e=4\\pi\\epsilon_0=1$，能量单位是哈特里 ($E_h$)，长度单位是玻尔半径 ($a_0$)。\n\n**第1部分：LDA 交换能 $E_{x}^{\\mathrm{LDA}}[\\rho]$ 的推导**\n\nLDA 交换能泛函是通过对均匀电子气的交换能密度 $e_{x}^{\\mathrm{UEG}}$（在实际系统的局域密度 $\\rho(\\mathbf{r})$ 处计算）进行积分来构建的。\n$$E_{x}^{\\mathrm{LDA}}[\\rho] = \\int e_{x}^{\\mathrm{UEG}}(\\rho(\\mathbf{r})) \\, d^{3}r$$\nUEG 的单位粒子交换能由 $\\epsilon_{x}^{\\mathrm{UEG}} = -\\frac{3}{4\\pi}k_{F}$ 给出。交换能密度是该量乘以密度 $\\rho$，因此 $e_{x}^{\\mathrm{UEG}}(\\rho) = \\rho \\epsilon_{x}^{\\mathrm{UEG}} = -\\frac{3\\rho}{4\\pi}k_{F}$。\n代入给定的关系式 $k_{F} = (3\\pi^{2}\\rho)^{1/3}$，我们得到 LDA 交换能密度泛函的显式形式：\n$$e_{x}^{\\mathrm{UEG}}(\\rho) = -\\frac{3\\rho}{4\\pi}(3\\pi^{2}\\rho)^{1/3} = -\\frac{3}{4\\pi}(3\\pi^{2})^{1/3}\\rho^{4/3} = -\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}\\rho^{4/3}$$\n我们定义常数 $C_{x} = \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}$。那么 $e_{x}^{\\mathrm{UEG}}(\\rho) = -C_{x}\\rho^{4/3}$。\n\n现在我们可以计算给定类氢原子 $1s$ 密度 $\\rho(r)=\\frac{1}{\\pi a_{0}^{3}}\\exp(-\\frac{2r}{a_{0}})$ 的 $E_{x}^{\\mathrm{LDA}}$：\n$$E_{x}^{\\mathrm{LDA}}[\\rho] = \\int -C_{x} [\\rho(r)]^{4/3} \\, d^{3}r$$\n积分在球坐标系中进行，其中 $d^{3}r = 4\\pi r^{2} dr$。\n$$E_{x}^{\\mathrm{LDA}} = -C_{x} \\int_{0}^{\\infty} \\left(\\frac{1}{\\pi a_{0}^{3}}\\exp\\left(-\\frac{2r}{a_{0}}\\right)\\right)^{4/3} 4\\pi r^{2} \\, dr$$\n$$E_{x}^{\\mathrm{LDA}} = -4\\pi C_{x} \\left(\\frac{1}{\\pi a_{0}^{3}}\\right)^{4/3} \\int_{0}^{\\infty} \\exp\\left(-\\frac{8r}{3a_{0}}\\right) r^{2} \\, dr$$\n该积分为标准伽马函数形式，$\\int_{0}^{\\infty} x^{n} \\exp(-\\alpha x) \\, dx = \\frac{n!}{\\alpha^{n+1}}$。对于本例，$n=2$ 且 $\\alpha = \\frac{8}{3a_{0}}$。\n$$\\int_{0}^{\\infty} r^{2} \\exp\\left(-\\frac{8r}{3a_{0}}\\right) \\, dr = \\frac{2!}{\\left(\\frac{8}{3a_{0}}\\right)^{3}} = \\frac{2}{\\frac{512}{27a_{0}^{3}}} = \\frac{54a_{0}^{3}}{512} = \\frac{27a_{0}^{3}}{256}$$\n将此结果代回 $E_{x}^{\\mathrm{LDA}}$ 的表达式中：\n$$E_{x}^{\\mathrm{LDA}} = -4\\pi C_{x} \\left(\\frac{1}{\\pi^{4/3} a_{0}^{4}}\\right) \\left(\\frac{27a_{0}^{3}}{256}\\right) = -\\frac{108\\pi}{256} C_{x} \\pi^{-4/3} a_{0}^{-1} = -\\frac{27\\pi}{64} C_{x} \\pi^{-4/3} a_{0}^{-1}$$\n现在，我们代入 $C_{x}$ 的值：\n$$E_{x}^{\\mathrm{LDA}} = -\\frac{27\\pi}{64} \\left(\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}\\right) \\pi^{-4/3} a_{0}^{-1} = -\\frac{81}{256} \\left(\\frac{3}{\\pi}\\right)^{1/3} \\pi \\cdot \\pi^{-4/3} a_{0}^{-1}$$\n$$E_{x}^{\\mathrm{LDA}} = -\\frac{81}{256} (3^{1/3}\\pi^{-1/3}) \\pi^{-1/3} a_{0}^{-1} = -\\frac{81}{256} 3^{1/3} \\pi^{-2/3} a_{0}^{-1}$$\n这可以更紧凑地写为：\n$$E_{x}^{\\mathrm{LDA}}[\\rho] = -\\frac{81}{256} \\left(\\frac{3}{\\pi^{2}}\\right)^{1/3} \\frac{1}{a_{0}}$$\n\n**第2部分：Hartree 能量 $E_{H}[\\rho]$ 的计算**\n\nHartree 能量表示电荷密度 $\\rho(\\mathbf{r})$ 的经典静电自排斥。\n$$E_{H}[\\rho] = \\frac{1}{2} \\int d^{3}r \\int d^{3}r' \\frac{\\rho(\\mathbf{r}) \\rho(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}$$\n这可以重写为 $E_{H}[\\rho] = \\frac{1}{2}\\int \\rho(\\mathbf{r}) V_{H}(\\mathbf{r}) \\, d^{3}r$，其中 $V_{H}(\\mathbf{r}) = \\int \\frac{\\rho(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|} \\, d^{3}r'$ 是由密度产生的经典势。对于球对称的 $1s$ 密度，已知势 $V_{H}(r)$ 为：\n$$V_{H}(r) = \\frac{1}{r} - \\left(\\frac{1}{a_{0}} + \\frac{1}{r}\\right)\\exp\\left(-\\frac{2r}{a_{0}}\\right)$$\n现在我们计算能量积分：\n$$E_{H}[\\rho] = \\frac{1}{2} \\int_{0}^{\\infty} \\rho(r) V_{H}(r) 4\\pi r^{2} \\, dr$$\n$$E_{H}[\\rho] = \\frac{1}{2} \\int_{0}^{\\infty} \\frac{1}{\\pi a_{0}^{3}}\\exp\\left(-\\frac{2r}{a_{0}}\\right) \\left[ \\frac{1}{r} - \\left(\\frac{1}{a_{0}} + \\frac{1}{r}\\right)\\exp\\left(-\\frac{2r}{a_{0}}\\right) \\right] 4\\pi r^{2} \\, dr$$\n$$E_{H}[\\rho] = \\frac{2}{a_{0}^{3}} \\int_{0}^{\\infty} \\left[ r\\exp\\left(-\\frac{2r}{a_{0}}\\right) - \\frac{r^{2}}{a_{0}}\\exp\\left(-\\frac{4r}{a_{0}}\\right) - r\\exp\\left(-\\frac{4r}{a_{0}}\\right) \\right] \\, dr$$\n我们使用公式 $\\int_{0}^{\\infty} x^{n} e^{-\\alpha x} dx = \\frac{n!}{\\alpha^{n+1}}$ 来计算这三个积分：\n1.  $\\int_{0}^{\\infty} r\\exp(-\\frac{2r}{a_{0}}) \\, dr = \\frac{1!}{(2/a_{0})^{2}} = \\frac{a_{0}^{2}}{4}$\n2.  $\\int_{0}^{\\infty} r^{2}\\exp(-\\frac{4r}{a_{0}}) \\, dr = \\frac{2!}{(4/a_{0})^{3}} = \\frac{2a_{0}^{3}}{64} = \\frac{a_{0}^{3}}{32}$\n3.  $\\int_{0}^{\\infty} r\\exp(-\\frac{4r}{a_{0}}) \\, dr = \\frac{1!}{(4/a_{0})^{2}} = \\frac{a_{0}^{2}}{16}$\n\n将这些结果代回 $E_{H}$ 的表达式中：\n$$E_{H}[\\rho] = \\frac{2}{a_{0}^{3}} \\left[ \\frac{a_{0}^{2}}{4} - \\frac{1}{a_{0}}\\left(\\frac{a_{0}^{3}}{32}\\right) - \\frac{a_{0}^{2}}{16} \\right]$$\n$$E_{H}[\\rho] = \\frac{2}{a_{0}^{3}} \\left[ \\frac{a_{0}^{2}}{4} - \\frac{a_{0}^{2}}{32} - \\frac{a_{0}^{2}}{16} \\right] = \\frac{2}{a_{0}} \\left[ \\frac{1}{4} - \\frac{1}{32} - \\frac{2}{32} \\right]$$\n$$E_{H}[\\rho] = \\frac{2}{a_{0}} \\left[ \\frac{8-1-2}{32} \\right] = \\frac{2}{a_{0}} \\left( \\frac{5}{32} \\right) = \\frac{10}{32 a_{0}} = \\frac{5}{16 a_{0}}$$\n\n**第3部分：自相互作用误差 $\\Delta_{\\mathrm{SIE}}$**\n\n对于单电子体系，精确交换能必须完全抵消非物理的 Hartree 自排斥能，即 $E_{x}^{\\mathrm{exact}}[\\rho] + E_{H}[\\rho] = 0$。近似泛函未能满足此条件的情况会导致自相互作用误差。对于 LDA，该误差定义为：\n$$\\Delta_{\\mathrm{SIE}} = E_{H}[\\rho] + E_{x}^{\\mathrm{LDA}}[\\rho]$$\n使用第1部分和第2部分的结果：\n$$\\Delta_{\\mathrm{SIE}} = \\frac{5}{16 a_{0}} + \\left(-\\frac{81}{256} \\left(\\frac{3}{\\pi^{2}}\\right)^{1/3} \\frac{1}{a_{0}}\\right)$$\n$$\\Delta_{\\mathrm{SIE}} = \\left( \\frac{5}{16} - \\frac{81}{256} \\left(\\frac{3}{\\pi^{2}}\\right)^{1/3} \\right) \\frac{1}{a_{0}}$$\n为了将其表示为单个合并的分数，我们找到公分母 $256$：\n$$\\Delta_{\\mathrm{SIE}} = \\left( \\frac{5 \\cdot 16}{256} - \\frac{81}{256} \\left(\\frac{3}{\\pi^{2}}\\right)^{1/3} \\right) \\frac{1}{a_{0}} = \\left( \\frac{80}{256} - \\frac{81}{256} \\left(\\frac{3}{\\pi^{2}}\\right)^{1/3} \\right) \\frac{1}{a_{0}}$$\n这给出了自相互作用误差的最终表达式：\n$$\\Delta_{\\mathrm{SIE}} = \\frac{1}{256 a_{0}} \\left( 80 - 81 \\left(\\frac{3}{\\pi^{2}}\\right)^{1/3} \\right)$$\n这个非零的正值表示 LDA 泛函未能完全抵消氢原子的自相互作用能的量，从而导致对总电子能量的高估。",
            "answer": "$$\\boxed{\\frac{1}{256 a_{0}} \\left( 80 - 81 \\left(\\frac{3}{\\pi^{2}}\\right)^{1/3} \\right)}$$"
        },
        {
            "introduction": "最后一个练习将从解析问题转向计算建模，并探讨LDA的另一个经典失效案例。通过为金属表面模型（均匀正电背景模型，Jellium）实现LDA交换相关势，这个练习将展示其在真空区域不正确的渐进行为。这种未能再现长程经典镜像势的缺陷，凸显了纯局域近似的局限性，并为发展更高级的泛函提供了动力。",
            "id": "3820912",
            "problem": "要求您实现一个程序，用于计算一维 jellium-真空界面上的局域密度近似（LDA）交换相关势分布，并量化其与经典镜像势尾的渐近偏差。计算必须采用原子单位，其中距离以玻尔（bohr）为单位，能量（势）以哈特里（Hartree）为单位。\n\n出发点是针对自旋非极化系统的密度泛函理论（DFT）。交换相关能量泛函定义为电子密度乘以每个粒子的交换相关能量在每个点上进行局域求值的积分。使用均匀电子气作为每个粒子能量的参考系统，采用经过充分检验的自旋非极化情况下的相关参数化方法，并对交换部分使用解析形式。基于此基础，通过对交换相关能量泛函关于电子密度求泛函导数来推导交换相关势，并通过密度参数中编码的密度依赖性适当地应用链式法则。\n\n考虑一个占据负位置半空间的半无限 jellium 板，其平面界面位于位置 $z_0$，正位置为真空。穿过界面的电子密度分布由一个平滑的单调函数建模：\n$$\nn(z) = \\frac{n_0}{1 + \\exp\\!\\left(\\frac{z - z_0}{w}\\right)},\n$$\n其中 $n_0$ 是体 jellium 电子密度，$z$ 是垂直于界面的位置坐标，$z_0$ 是界面位置，$w$ 是控制过渡陡峭程度的宽度参数。体密度 $n_0$ 由 Wigner–Seitz 半径 $r_s$ 通过标准的均匀电子气关系确定：\n$$\n\\frac{4\\pi}{3} r_s^3 n_0 = 1,\n$$\n因此\n$$\nn_0 = \\frac{3}{4\\pi r_s^3}.\n$$\n\n您的任务是：\n- 从上述 DFT 基础出发，通过对交换相关能量泛函关于密度求泛函导数，推导出作为局域电子密度 $n$ 的函数的 LDA 交换相关势 $v_{\\mathrm{xc}}(n)$。对每个粒子的交换能量使用自旋非极化的均匀电子气，对均匀电子气（自旋非极化）的每个粒子的相关能量使用一个标准的、广泛使用的参数化方法，确保内部一致性。\n- 实现一个函数，使用给定的 $n(z)$ 分布和您推导的 $v_{\\mathrm{xc}}(n)$ 表达式，计算界面上的 $v_{\\mathrm{xc}}(z)$。\n- 在远离表面的真空区域，将指定远距离 $z_\\mathrm{far}$ 处的 LDA $v_{\\mathrm{xc}}(z)$ 与经典镜像势 $v_{\\mathrm{img}}(z) = -\\frac{1}{4(z - z_0)}$进行比较。定义诊断比率\n$$\nM = \\frac{v_{\\mathrm{xc}}(z_\\mathrm{far})}{-\\frac{1}{4(z_\\mathrm{far} - z_0)}},\n$$\n这应该是一个无量纲数。$M$ 的值接近 $1$ 表示正确的镜像势尾行为，而 $M$ 的值接近 $0$ 则表示不存在镜像势尾。\n\n所有距离必须以玻尔为单位，所有势必须以哈特里为单位。角度不出现。将所有最终输出表示为十进制浮点数。您的程序必须生成一行，其中包含测试套件的诊断比率列表，格式为用方括号括起来的逗号分隔列表。\n\n测试套件：\n- 情况 1：$r_s = 2.0$, $w = 1.0$, $z_0 = 0.0$, $z_\\mathrm{far} = 12.0$。\n- 情况 2：$r_s = 3.0$, $w = 0.5$, $z_0 = 0.0$, $z_\\mathrm{far} = 15.0$。\n- 情况 3：$r_s = 5.0$, $w = 2.0$, $z_0 = 0.0$, $z_\\mathrm{far} = 20.0$。\n- 情况 4：$r_s = 2.0$, $w = 0.1$, $z_0 = 0.0$, $z_\\mathrm{far} = 10.0$。\n- 情况 5：$r_s = 20.0$, $w = 1.0$, $z_0 = 0.0$, $z_\\mathrm{far} = 15.0$。\n\n程序输出格式：\n您的程序应生成单行输出，其中包含结果，格式为用方括号括起来的逗号分隔列表（例如，$[M_1,M_2,M_3,M_4,M_5]$），其中每个 $M_i$ 是相应测试用例的诊断比率。",
            "solution": "该问题要求计算一维 jellium-真空界面上的局域密度近似（LDA）交换相关势 $v_{\\mathrm{xc}}(z)$，并量化其与经典镜像势的渐近行为的比较。求解过程采用原子单位（能量为哈特里，距离为玻尔）。\n\n其理论基础是密度泛函理论（DFT），其中自旋非极化系统的交换相关（xc）能量由 LDA 泛函给出：\n$$\nE_{\\mathrm{xc}}[n] = \\int n(\\mathbf{r}) \\epsilon_{\\mathrm{xc}}(n(\\mathbf{r})) \\, d\\mathbf{r}\n$$\n这里，$n(\\mathbf{r})$ 是电子密度，$\\epsilon_{\\mathrm{xc}}(n)$ 是密度为 $n$ 的均匀电子气（UEG）中每个粒子的交换相关能量。xc 势 $v_{\\mathrm{xc}}(\\mathbf{r})$ 是 $E_{\\mathrm{xc}}[n]$ 对密度 $n(\\mathbf{r})$ 的泛函导数：\n$$\nv_{\\mathrm{xc}}(\\mathbf{r}) = \\frac{\\delta E_{\\mathrm{xc}}[n]}{\\delta n(\\mathbf{r})}\n$$\n对于形式为 $E[n] = \\int f(n(\\mathbf{r}))d\\mathbf{r}$ 的局域泛函，其导数为 $\\frac{\\delta E}{\\delta n(\\mathbf{r})} = \\frac{df(n)}{dn}\\bigg|_{n=n(\\mathbf{r})}$。在我们的情况下，$f(n) = n\\epsilon_{\\mathrm{xc}}(n)$，因此应用乘积法则求导，得到 LDA 势作为局域密度函数的表达式：\n$$\nv_{\\mathrm{xc}}(n) = \\frac{d}{dn} [n \\epsilon_{\\mathrm{xc}}(n)] = \\epsilon_{\\mathrm{xc}}(n) + n \\frac{d\\epsilon_{\\mathrm{xc}}(n)}{dn}\n$$\n每个粒子的 xc 能量分为交换和相关两部分，$\\epsilon_{\\mathrm{xc}}(n) = \\epsilon_{\\mathrm{x}}(n) + \\epsilon_{\\mathrm{c}}(n)$，这导致势也相应地分为两部分，$v_{\\mathrm{xc}}(n) = v_{\\mathrm{x}}(n) + v_{\\mathrm{c}}(n)$。\n\n密度通常通过 Wigner-Seitz 半径 $r_s$ 进行参数化，其定义为 $\\frac{4\\pi}{3}r_s^3 = \\frac{1}{n}$，从而得到 $r_s(n) = \\left(\\frac{3}{4\\pi n}\\right)^{1/3}$。当 $\\epsilon_{\\mathrm{c}}$ 作为 $r_s$ 的函数给出时，为了计算 $n \\frac{d\\epsilon_{\\mathrm{c}}(n)}{dn}$ 这一项，我们使用链式法则：\n$$\nn \\frac{d\\epsilon_{\\mathrm{c}}}{dn} = n \\frac{d\\epsilon_{\\mathrm{c}}}{dr_s}\\frac{dr_s}{dn} = n \\frac{d\\epsilon_{\\mathrm{c}}}{dr_s} \\left(-\\frac{1}{3n}r_s\\right) = -\\frac{r_s}{3}\\frac{d\\epsilon_{\\mathrm{c}}}{dr_s}\n$$\n因此，作为 $r_s$ 函数的 xc 势为 $v_{\\mathrm{xc}}(r_s) = \\epsilon_{\\mathrm{xc}}(r_s) - \\frac{r_s}{3}\\frac{d\\epsilon_{\\mathrm{xc}}(r_s)}{dr_s}$。\n\n**交换部分**\n对于自旋非极化的 UEG，每个粒子的交换能量有解析形式：\n$$\n\\epsilon_{\\mathrm{x}}(n) = -\\frac{3}{4\\pi}(3\\pi^2 n)^{1/3}\n$$\n相应的交换势为：\n$$\nv_{\\mathrm{x}}(n) = \\epsilon_{\\mathrm{x}}(n) + n \\frac{d\\epsilon_{\\mathrm{x}}(n)}{dn} = \\epsilon_{\\mathrm{x}}(n) + n \\left(\\frac{1}{3} \\frac{\\epsilon_{\\mathrm{x}}(n)}{n}\\right) = \\frac{4}{3}\\epsilon_{\\mathrm{x}}(n)\n$$\n用 $r_s$ 表示为：\n$$\n\\epsilon_{\\mathrm{x}}(r_s) = -\\frac{3}{4\\pi}\\left(\\frac{9\\pi}{4}\\right)^{1/3} \\frac{1}{r_s} \\approx -\\frac{0.458165}{r_s}\n$$\n$$\nv_{\\mathrm{x}}(r_s) = \\frac{4}{3}\\epsilon_{\\mathrm{x}}(r_s) \\approx -\\frac{0.610887}{r_s}\n$$\n\n**相关部分**\n我们使用 Perdew-Zunger '81 对 Ceperley-Alder 量子蒙特卡洛数据的参数化，用于自旋非极化 UEG 的相关能。函数形式取决于 $r_s$ 的值。\n\n对于低密度区域（$r_s \\geq 1$）：\n$$\n\\epsilon_{\\mathrm{c}}(r_s) = \\frac{\\gamma}{1 + \\beta_1 \\sqrt{r_s} + \\beta_2 r_s}\n$$\n参数为 $\\gamma = -0.1423$，$\\beta_1 = 1.0529$，$\\beta_2 = 0.3334$。相应的势为：\n$$\nv_{\\mathrm{c}}(r_s) = \\epsilon_{\\mathrm{c}}(r_s) - \\frac{r_s}{3}\\frac{d\\epsilon_{\\mathrm{c}}(r_s)}{dr_s} = \\epsilon_{\\mathrm{c}}(r_s) \\left[ 1 + \\frac{\\frac{1}{2}\\beta_1 \\sqrt{r_s} + \\beta_2 r_s}{3(1 + \\beta_1 \\sqrt{r_s} + \\beta_2 r_s)} \\right]\n$$\n\n对于高密度区域（$r_s  1$）：\n$$\n\\epsilon_{\\mathrm{c}}(r_s) = A \\ln r_s + B + C r_s \\ln r_s + D r_s\n$$\n参数为 $A = 0.0311$，$B = -0.0480$，$C = 0.0020$，$D = -0.0116$。相应的势为：\n$$\nv_{\\mathrm{c}}(r_s) = \\epsilon_{\\mathrm{c}}(r_s) - \\frac{r_s}{3}\\frac{d\\epsilon_{\\mathrm{c}}(r_s)}{dr_s} = A \\ln r_s + \\left(B - \\frac{A}{3}\\right) + \\frac{2C}{3} r_s \\ln r_s + \\frac{2D-C}{3} r_s\n$$\n\n**计算步骤**\n对于由 ($r_s^{\\text{bulk}}, w, z_0, z_{\\mathrm{far}}$) 定义的每个测试用例，算法按以下步骤进行：\n1. 计算体电子密度 $n_0 = \\frac{3}{4\\pi (r_s^{\\text{bulk}})^3}$。\n2. 使用给定的分布函数 $n(z) = n_0 / (1 + \\exp((z - z_0)/w))$ 计算指定远距离处的局域电子密度 $n(z_{\\mathrm{far}})$。\n3. 从 $n(z_{\\mathrm{far}})$ 计算局域 Wigner-Seitz 半径 $r_s(z_{\\mathrm{far}})$。\n4. 根据 $r_s(z_{\\mathrm{far}})$ 的值，使用适当的 PZ81 公式计算 $v_{\\mathrm{c}}$，从而计算总交换相关势 $v_{\\mathrm{xc}}(z_{\\mathrm{far}}) = v_{\\mathrm{x}}(r_s(z_{\\mathrm{far}})) + v_{\\mathrm{c}}(r_s(z_{\\mathrm{far}}))$。\n5. 计算同一点处的经典镜像势 $v_{\\mathrm{img}}(z_{\\mathrm{far}}) = -\\frac{1}{4(z_{\\mathrm{far}} - z_0)}$。\n6. 计算最终的诊断比率 $M = v_{\\mathrm{xc}}(z_{\\mathrm{far}}) / v_{\\mathrm{img}}(z_{\\mathrm{far}})$。该比率量化了 LDA 势与正确渐近行为的偏差。一个接近 $0$ 的 $M$ 值表明 LDA 未能再现长程镜像势，这是其已知的缺陷。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the LDA exchange-correlation potential profile across a 1D\n    jellium-vacuum interface and quantifies its asymptotic deviation from the\n    classical image potential tail.\n    \"\"\"\n    # Test cases from the problem statement.\n    # Each case is a tuple: (rs_bulk, w, z0, z_far)\n    test_cases = [\n        (2.0, 1.0, 0.0, 12.0),\n        (3.0, 0.5, 0.0, 15.0),\n        (5.0, 2.0, 0.0, 20.0),\n        (2.0, 0.1, 0.0, 10.0),\n        (20.0, 1.0, 0.0, 15.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        rs_bulk, w, z0, z_far = case\n\n        # Physical constants and helper functions in atomic units\n        pi = np.pi\n        \n        # Function to convert Wigner-Seitz radius to density\n        def rs_to_n(rs):\n            if rs = 0:\n                raise ValueError(\"r_s must be positive.\")\n            return 3.0 / (4.0 * pi * rs**3)\n\n        # Function to convert density to Wigner-Seitz radius\n        def n_to_rs(n):\n            if n = 0:\n                # In the limit n -> 0, rs -> inf. Return a large number.\n                return np.inf\n            return (3.0 / (4.0 * pi * n))**(1.0 / 3.0)\n\n        # Perdew-Zunger '81 parameters for spin-unpolarized case\n        # High-density (rs  1)\n        A = 0.0311\n        B = -0.0480\n        C = 0.0020\n        D = -0.0116\n        # Low-density (rs >= 1)\n        GAMMA = -0.1423\n        BETA1 = 1.0529\n        BETA2 = 0.3334\n\n        # Exchange energy/potential constants\n        C_X_RS = (3.0 / (4.0 * pi)) * (9.0 * pi / 4.0)**(1.0 / 3.0) # for eps_x = -C_X_RS/rs\n\n        def v_xc_lda(rs):\n            \"\"\"\n            Calculates the LDA exchange-correlation potential v_xc for a given rs.\n            \"\"\"\n            if rs == np.inf or rs = 0:\n                return 0.0\n\n            # Exchange potential\n            v_x = -(4.0 / 3.0) * C_X_RS / rs\n\n            # Correlation potential\n            if rs >= 1.0:\n                sqrt_rs = np.sqrt(rs)\n                denominator = 1.0 + BETA1 * sqrt_rs + BETA2 * rs\n                eps_c = GAMMA / denominator\n                \n                # v_c = eps_c - (rs/3) * d(eps_c)/d(rs)\n                factor_num = 0.5 * BETA1 * sqrt_rs + BETA2 * rs\n                factor = 1.0 + factor_num / (3.0 * denominator)\n                v_c = eps_c * factor\n            else: # rs  1.0\n                ln_rs = np.log(rs)\n                # v_c = A*ln(rs) + (B-A/3) + (2C/3)*rs*ln(rs) + (2D-C)/3*rs\n                v_c = A * ln_rs + (B - A/3.0) + (2.0*C/3.0)*rs*ln_rs + ((2.0*D - C)/3.0)*rs\n            \n            return v_x + v_c\n\n        # Step 1: Calculate bulk density n0\n        n0 = rs_to_n(rs_bulk)\n\n        # Step 2: Calculate density n(z_far)\n        exponent_arg = (z_far - z0) / w\n        # Handle potential overflow in exp by checking the argument\n        if exponent_arg > 700: # np.exp(709) is near float max\n            n_far = 0.0\n        else:\n            n_far = n0 / (1.0 + np.exp(exponent_arg))\n\n        # Step 3: Calculate local Wigner-Seitz radius rs(z_far)\n        rs_far = n_to_rs(n_far)\n\n        # Step 4: Calculate v_xc at z_far\n        v_xc_far = v_xc_lda(rs_far)\n\n        # Step 5: Calculate image potential at z_far\n        if z_far - z0 = 0:\n            # Avoid division by zero or negative distance, though test cases prevent this\n            v_img_far = np.nan\n        else:\n            v_img_far = -1.0 / (4.0 * (z_far - z0))\n\n        # Step 6: Compute the diagnostic ratio M\n        if v_img_far == 0.0 or np.isnan(v_img_far):\n             # This should not happen with the given test cases\n             M = np.nan\n        else:\n             M = v_xc_far / v_img_far\n        \n        results.append(M)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}