{
    "hands_on_practices": [
        {
            "introduction": "This first practice is foundational, bridging the conceptual gap between the abstract idea of a local approximation and its concrete mathematical form. Starting from the known exchange energy of a uniform electron gas, you will derive the explicit expression for the LDA exchange energy functional, which is proportional to an integral of the electron density $\\rho(\\mathbf{r})$ raised to the $4/3$ power. By then applying this functional to a hypothetical, spherically symmetric density, you will gain direct experience with a typical LDA calculation .",
            "id": "3820908",
            "problem": "In multiscale materials simulation, the Local Density Approximation (LDA) in Density Functional Theory (DFT) models the exchange energy of an inhomogeneous electron system by assuming that, locally, each point in space behaves like a homogeneous electron gas of the same local density. Consider a spin-unpolarized electron system in three spatial dimensions, and adopt Hartree atomic units so that the elementary charge, reduced Planck constant, and electron mass satisfy $e=1$, $\\hbar=1$, and $m=1$, and energies are in Hartree.\n\nStarting from the following well-tested facts for the homogeneous electron gas:\n- The Fermi wave vector for a spin-unpolarized electron gas with number density $\\rho$ is $k_{F}=(3\\pi^{2}\\rho)^{1/3}$.\n- The Hartree–Fock exchange energy per electron is $\\varepsilon_{x}(\\rho)=-\\frac{3}{4\\pi}k_{F}$,\n\nderive the LDA exchange energy functional $E_{x}^{\\mathrm{LDA}}[\\rho]$ for a general inhomogeneous spin-unpolarized density $\\rho(\\mathbf{r})$ in three spatial dimensions by applying the locality assumption described above. Then, evaluate this functional for the spherically symmetric density profile $\\rho(\\mathbf{r})=\\rho_{0}\\exp(-a r)$ with $\\rho_{0}>0$, $a>0$, and $r=|\\mathbf{r}|$.\n\nExpress your final answer as a single closed-form analytical expression in terms of $\\rho_{0}$ and $a$. Express the energy in Hartree. Do not round; no numerical approximation is required.",
            "solution": "The problem requires the derivation of the Local Density Approximation (LDA) for the exchange energy functional, $E_{x}^{\\mathrm{LDA}}[\\rho]$, and its subsequent evaluation for a specific spherically symmetric electron density profile. The derivation will be performed in Hartree atomic units, where the elementary charge $e=1$, the reduced Planck constant $\\hbar=1$, and the electron mass $m=1$.\n\nFirst, we derive the general expression for $E_{x}^{\\mathrm{LDA}}[\\rho]$. The fundamental assumption of the LDA is that the exchange energy density at a point $\\mathbf{r}$ in an inhomogeneous electron system depends only on the electron density $\\rho(\\mathbf{r})$ at that same point, and that this relationship is the same as in a homogeneous electron gas (HEG) of density $\\rho$.\n\nThe exchange energy per electron in a HEG of density $\\rho$ is given as $\\varepsilon_{x}(\\rho)$. The total exchange energy contribution from an infinitesimal volume element $d^3\\mathbf{r}$ is the product of the energy per electron and the number of electrons in that volume, $\\rho(\\mathbf{r}) d^3\\mathbf{r}$. This contribution is $dE_{x} = \\varepsilon_{x}(\\rho(\\mathbf{r})) \\rho(\\mathbf{r}) d^3\\mathbf{r}$.\n\nTo obtain the total exchange energy functional, we integrate this energy density over all space:\n$$E_{x}^{\\mathrm{LDA}}[\\rho] = \\int \\varepsilon_{x}(\\rho(\\mathbf{r})) \\rho(\\mathbf{r}) \\, d^3\\mathbf{r}$$\nThe problem provides the necessary expressions for the spin-unpolarized HEG:\n1.  The Fermi wave vector: $k_{F}=(3\\pi^{2}\\rho)^{1/3}$\n2.  The exchange energy per electron: $\\varepsilon_{x}(\\rho)=-\\frac{3}{4\\pi}k_{F}$\n\nSubstituting the expression for $k_F$ into $\\varepsilon_x(\\rho)$, we get the exchange energy per electron as an explicit function of density $\\rho$:\n$$\\varepsilon_{x}(\\rho) = -\\frac{3}{4\\pi}(3\\pi^{2}\\rho)^{1/3} = -\\frac{3}{4\\pi}(3\\pi^{2})^{1/3}\\rho^{1/3}$$\nLet's define a constant $C_{x} = \\frac{3}{4\\pi}(3\\pi^{2})^{1/3}$. Then $\\varepsilon_{x}(\\rho) = -C_{x}\\rho^{1/3}$.\n\nNow, we substitute this into the integral for the total exchange energy functional:\n$$E_{x}^{\\mathrm{LDA}}[\\rho] = \\int (-C_{x}\\rho(\\mathbf{r})^{1/3}) \\rho(\\mathbf{r}) \\, d^3\\mathbf{r} = -C_{x} \\int \\rho(\\mathbf{r})^{4/3} \\, d^3\\mathbf{r}$$\nThis is the general form of the LDA exchange energy functional for a spin-unpolarized system.\n\nNext, we evaluate this functional for the given spherically symmetric density profile $\\rho(\\mathbf{r})=\\rho_{0}\\exp(-a r)$, where $r=|\\mathbf{r}|$, $\\rho_{0}>0$, and $a>0$.\nSubstituting this density into the functional gives:\n$$E_{x} = -C_{x} \\int \\left(\\rho_{0}\\exp(-a r)\\right)^{4/3} \\, d^3\\mathbf{r}$$\n$$E_{x} = -C_{x} \\rho_{0}^{4/3} \\int \\exp\\left(-\\frac{4}{3}ar\\right) \\, d^3\\mathbf{r}$$\nThe integrand is spherically symmetric, so it is advantageous to use spherical coordinates $(r, \\theta, \\phi)$, where the volume element is $d^3\\mathbf{r} = r^2 \\sin\\theta \\, dr \\, d\\theta \\, d\\phi$. The integral becomes:\n$$ \\int \\exp\\left(-\\frac{4}{3}ar\\right) \\, d^3\\mathbf{r} = \\int_{0}^{2\\pi} d\\phi \\int_{0}^{\\pi} \\sin\\theta \\, d\\theta \\int_{0}^{\\infty} r^2 \\exp\\left(-\\frac{4}{3}ar\\right) \\, dr $$\nThe angular part of the integral is the solid angle over a full sphere:\n$$ \\int_{0}^{2\\pi} d\\phi \\int_{0}^{\\pi} \\sin\\theta \\, d\\theta = (2\\pi) [-\\cos\\theta]_{0}^{\\pi} = 2\\pi(1 - (-1)) = 4\\pi $$\nThe radial part is a standard gamma-function-related integral of the form $\\int_{0}^{\\infty} x^n \\exp(-bx) dx = \\frac{n!}{b^{n+1}}$. Here, $n=2$ and the decay constant is $b = \\frac{4a}{3}$.\n$$ \\int_{0}^{\\infty} r^2 \\exp\\left(-\\frac{4a}{3}r\\right) \\, dr = \\frac{2!}{\\left(\\frac{4a}{3}\\right)^{3}} = \\frac{2}{\\frac{64a^3}{27}} = \\frac{54}{64a^3} = \\frac{27}{32a^3} $$\nCombining the angular and radial parts, the spatial integral evaluates to:\n$$ \\int \\exp\\left(-\\frac{4}{3}ar\\right) \\, d^3\\mathbf{r} = (4\\pi) \\left(\\frac{27}{32a^3}\\right) = \\frac{27\\pi}{8a^3} $$\nNow, we substitute this result back into the expression for the energy $E_x$:\n$$ E_{x} = -C_{x} \\rho_{0}^{4/3} \\left(\\frac{27\\pi}{8a^3}\\right) $$\nFinally, we substitute the full expression for the constant $C_{x} = \\frac{3}{4\\pi}(3\\pi^{2})^{1/3}$:\n$$ E_{x} = -\\left[\\frac{3}{4\\pi}(3\\pi^{2})^{1/3}\\right] \\rho_{0}^{4/3} \\left(\\frac{27\\pi}{8a^3}\\right) $$\nLet's simplify this expression:\n$$ E_{x} = -\\frac{3 \\cdot 27\\pi}{4\\pi \\cdot 8a^3} (3\\pi^2)^{1/3} \\rho_{0}^{4/3} $$\nThe factor of $\\pi$ in the numerator and denominator cancels out:\n$$ E_{x} = -\\frac{81}{32a^3} (3^{1/3}\\pi^{2/3}) \\rho_{0}^{4/3} $$\nTo write this as a single term, we combine the numerical constants. Note that $81 = 3^4$:\n$$ E_{x} = -\\frac{3^4 \\cdot 3^{1/3} \\pi^{2/3}}{32a^3} \\rho_{0}^{4/3} = -\\frac{3^{13/3} \\pi^{2/3}}{32a^3} \\rho_{0}^{4/3} $$\nThis expression can be rearranged to group constants and parameters:\n$$ E_{x} = -\\frac{3^{13/3} \\pi^{2/3}}{32} \\frac{\\rho_{0}^{4/3}}{a^{3}} $$\nThis is the final closed-form analytical expression for the exchange energy for the given density profile, expressed in Hartree.",
            "answer": "$$\\boxed{-\\frac{3^{13/3} \\pi^{2/3} \\rho_{0}^{4/3}}{32 a^{3}}}$$"
        },
        {
            "introduction": "Having established the LDA functional, we now critically assess its performance by exploring one of its most famous shortcomings: the self-interaction error. For any one-electron system, the exact exchange energy must perfectly cancel the non-physical electrostatic self-repulsion, or Hartree energy. This practice uses the hydrogen atom as a test case to quantify the degree to which the LDA fails this crucial test, providing a concrete measure of this fundamental limitation .",
            "id": "3820942",
            "problem": "Consider a one-electron system described within Kohn–Sham Density Functional Theory (KS-DFT). In the Local Density Approximation (LDA), the exchange energy functional is constructed by integrating the exchange energy density of the three-dimensional Uniform Electron Gas (UEG) evaluated at the local density. Assume the UEG exchange energy per particle is a well-tested fact that depends on the Fermi wavevector $k_{F}$ and that the Fermi wavevector relates to the local density via $k_{F}=(3\\pi^{2}\\rho)^{1/3}$. The classical electrostatic (Hartree) energy is given by the double integral of the Coulomb repulsion of the charge density with itself, and for a one-electron system, the exact exchange must cancel this entire Hartree energy.\n\nYou are given the normalized hydrogenic $1s$ electron density\n$$\\rho(r)=\\frac{1}{\\pi}a_{0}^{-3}\\exp\\!\\left(-\\frac{2r}{a_{0}}\\right),$$\nwhere $a_{0}$ is the Bohr radius.\n\nStarting from the above foundational facts and definitions (KS-DFT, LDA built from UEG, the relation between $k_{F}$ and $\\rho$, and the definition of the Hartree energy as a Coulomb double integral), do the following:\n\n1. Derive the LDA exchange energy $E_{x}^{\\mathrm{LDA}}[\\rho]$ for the given $\\rho(r)$ by expressing it as a spatial integral of the UEG exchange energy density evaluated at $\\rho(r)$ and performing the integration in closed form.\n2. Using the fundamental definition of the Hartree energy\n$$E_{H}[\\rho]=\\frac{1}{2}\\int d^{3}r\\int d^{3}r'\\,\\frac{\\rho(\\mathbf{r})\\,\\rho(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|},$$\nevaluate $E_{H}[\\rho]$ for the given $\\rho(r)$ in closed form.\n3. For a one-electron system, exact exchange must satisfy $E_{x}^{\\mathrm{exact}}[\\rho]=-E_{H}[\\rho]$. Diagnose the magnitude of the self-interaction error by computing\n$$\\Delta_{\\mathrm{SIE}}=E_{H}[\\rho]+E_{x}^{\\mathrm{LDA}}[\\rho],$$\nand provide your final result as a single closed-form analytic expression.\n\nExpress all energies in Hartree (atomic units). No numerical rounding is required; provide exact expressions in terms of $a_{0}$ and standard constants. The final answer must be a single expression for $\\Delta_{\\mathrm{SIE}}$.",
            "solution": "The problem requires the calculation of the self-interaction error (SIE) of the Local Density Approximation (LDA) for the hydrogen atom's ground state. This is done by computing the sum of the LDA exchange energy, $E_{x}^{\\mathrm{LDA}}[\\rho]$, and the classical Hartree self-repulsion energy, $E_{H}[\\rho]$. For an exact one-electron theory, this sum must be zero. We will perform the calculations in Hartree atomic units.\n\nFirst, we calculate the LDA exchange energy, $E_{x}^{\\mathrm{LDA}}[\\rho]$. The LDA exchange energy functional is given by:\n$$E_{x}^{\\mathrm{LDA}}[\\rho] = \\int e_{x}^{\\mathrm{UEG}}(\\rho(\\mathbf{r})) \\, d^{3}r = \\int \\rho(\\mathbf{r}) \\epsilon_{x}^{\\mathrm{UEG}}(\\rho(\\mathbf{r})) \\, d^{3}r$$\nwhere $\\epsilon_{x}^{\\mathrm{UEG}}$ is the exchange energy per particle in a uniform electron gas (UEG). Using the standard relations for the UEG, $\\epsilon_{x}^{\\mathrm{UEG}} = -\\frac{3}{4\\pi}k_{F}$ and $k_{F} = (3\\pi^{2}\\rho)^{1/3}$, we get the energy density as a function of $\\rho$:\n$$e_{x}^{\\mathrm{UEG}}(\\rho) = \\rho \\left(-\\frac{3}{4\\pi}(3\\pi^{2}\\rho)^{1/3}\\right) = -\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}\\rho^{4/3} = -C_{x}\\rho^{4/3}$$\nWe now apply this to the hydrogen 1s density, $\\rho(r)=\\frac{1}{\\pi a_{0}^{3}}\\exp(-\\frac{2r}{a_{0}})$, integrating in spherical coordinates:\n$$E_{x}^{\\mathrm{LDA}}[\\rho] = -C_{x} \\int_{0}^{\\infty} \\left(\\frac{1}{\\pi a_{0}^{3}}\\exp\\left(-\\frac{2r}{a_{0}}\\right)\\right)^{4/3} 4\\pi r^{2} \\, dr$$\n$$E_{x}^{\\mathrm{LDA}}[\\rho] = -4\\pi C_{x} \\left(\\frac{1}{\\pi^{4/3} a_{0}^{4}}\\right) \\int_{0}^{\\infty} r^{2} \\exp\\left(-\\frac{8r}{3a_{0}}\\right) \\, dr$$\nThe integral evaluates to $\\int_{0}^{\\infty} r^{2} \\exp(-\\alpha r) \\, dr = \\frac{2!}{\\alpha^3} = \\frac{2}{(8/3a_0)^3} = \\frac{27a_{0}^{3}}{256}$. Substituting this and the value of $C_x$ gives:\n$$E_{x}^{\\mathrm{LDA}}[\\rho] = -4\\pi \\left(\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}\\right) \\frac{1}{\\pi^{4/3} a_{0}^{4}} \\frac{27a_{0}^{3}}{256} = -3\\pi \\left(\\frac{3}{\\pi}\\right)^{1/3} \\frac{1}{\\pi^{4/3} a_{0}} \\frac{27}{256}$$\n$$E_{x}^{\\mathrm{LDA}}[\\rho] = -\\frac{81}{256} \\frac{3^{1/3}\\pi}{\\pi^{1/3}\\pi^{4/3}a_0} = -\\frac{81}{256} \\frac{3^{1/3}}{\\pi^{2/3} a_0} = -\\frac{81}{256} \\left(\\frac{3}{\\pi^{2}}\\right)^{1/3} \\frac{1}{a_{0}}$$\n\nNext, we evaluate the Hartree energy, $E_{H}[\\rho]$. This is the classical self-repulsion energy of the electron's charge density:\n$$E_{H}[\\rho] = \\frac{1}{2} \\int \\rho(\\mathbf{r}) V_{H}(\\mathbf{r}) \\, d^{3}r$$\nwhere $V_H(r)$ is the electrostatic potential generated by $\\rho(r)$. For the 1s density, this potential is known:\n$$V_{H}(r) = \\frac{1}{r} - \\left(\\frac{1}{a_{0}} + \\frac{1}{r}\\right)\\exp\\left(-\\frac{2r}{a_{0}}\\right)$$\nThe integral for the energy is:\n$$E_{H}[\\rho] = \\frac{1}{2} \\int_{0}^{\\infty} \\frac{1}{\\pi a_{0}^{3}}\\exp\\left(-\\frac{2r}{a_{0}}\\right) \\left[ \\frac{1}{r} - \\left(\\frac{1}{a_{0}} + \\frac{1}{r}\\right)\\exp\\left(-\\frac{2r}{a_{0}}\\right) \\right] 4\\pi r^{2} \\, dr$$\n$$E_{H}[\\rho] = \\frac{2}{a_{0}^{3}} \\int_{0}^{\\infty} \\left[ r\\exp\\left(-\\frac{2r}{a_{0}}\\right) - \\frac{r^{2}}{a_{0}}\\exp\\left(-\\frac{4r}{a_{0}}\\right) - r\\exp\\left(-\\frac{4r}{a_{0}}\\right) \\right] \\, dr$$\nUsing the standard integral $\\int_{0}^{\\infty} x^{n} e^{-\\alpha x} dx = n!/\\alpha^{n+1}$, we evaluate the terms:\n$$E_{H}[\\rho] = \\frac{2}{a_{0}^{3}} \\left[ \\frac{1!}{(2/a_0)^2} - \\frac{1}{a_0}\\frac{2!}{(4/a_0)^3} - \\frac{1!}{(4/a_0)^2} \\right]$$\n$$E_{H}[\\rho] = \\frac{2}{a_{0}^{3}} \\left[ \\frac{a_{0}^{2}}{4} - \\frac{a_{0}^{2}}{32} - \\frac{a_{0}^{2}}{16} \\right] = \\frac{2}{a_{0}} \\left[ \\frac{8 - 1 - 2}{32} \\right] = \\frac{2}{a_{0}} \\left(\\frac{5}{32}\\right) = \\frac{5}{16 a_{0}}$$\n\nFinally, we compute the self-interaction error, $\\Delta_{\\mathrm{SIE}}$, as the sum of the Hartree and LDA exchange energies:\n$$\\Delta_{\\mathrm{SIE}} = E_{H}[\\rho] + E_{x}^{\\mathrm{LDA}}[\\rho] = \\frac{5}{16 a_{0}} - \\frac{81}{256} \\left(\\frac{3}{\\pi^{2}}\\right)^{1/3} \\frac{1}{a_{0}}$$\nCombining the terms gives the final result:\n$$\\Delta_{\\mathrm{SIE}} = \\left( \\frac{80}{256} - \\frac{81}{256} \\left(\\frac{3}{\\pi^{2}}\\right)^{1/3} \\right) \\frac{1}{a_{0}} = \\frac{1}{256 a_{0}} \\left( 80 - 81 \\left(\\frac{3}{\\pi^{2}}\\right)^{1/3} \\right)$$\nThis non-zero result quantifies the failure of LDA to be self-interaction free for the hydrogen atom.",
            "answer": "$$\\boxed{\\frac{1}{256 a_{0}} \\left( 80 - 81 \\left(\\frac{3}{\\pi^{2}}\\right)^{1/3} \\right)}$$"
        },
        {
            "introduction": "Our final exercise moves from analytical calculations to a computational model to investigate another key failure of the LDA in a practical context. We will examine the behavior of the exchange-correlation potential at the surface of a metal, a system of great importance in catalysis and electronics. This practice demonstrates that the LDA potential decays incorrectly into the vacuum, failing to reproduce the long-range classical image potential that is essential for describing electron-surface interactions .",
            "id": "3820912",
            "problem": "You are asked to implement a program that computes the Local Density Approximation (LDA) exchange-correlation potential profile across a one-dimensional jellium-vacuum interface and quantifies its asymptotic deviation from the classical image potential tail. The computation must be in atomic units, where distances are measured in bohr and energies (potentials) in Hartree.\n\nThe starting point is Density Functional Theory (DFT) for a spin-unpolarized system. The exchange-correlation energy functional is defined as the integral of the electron density times an exchange-correlation energy per particle, evaluated locally at each point. Use the uniform electron gas as the reference system for the energy per particle, with a well-tested correlation parameterization for the spin-unpolarized case and an analytical form for the exchange part. From this foundation, derive the exchange-correlation potential as the functional derivative of the exchange-correlation energy with respect to the electron density, applying the chain rule appropriately through the density dependence encoded in the density parameter.\n\nConsider a semi-infinite jellium slab occupying the half-space at negative positions, with a planar interface at position $z_0$ and vacuum at positive positions. The electron density profile across the interface is modeled by a smooth monotonic function\n$$\nn(z) = \\frac{n_0}{1 + \\exp\\!\\left(\\frac{z - z_0}{w}\\right)},\n$$\nwhere $n_0$ is the bulk jellium electron density, $z$ is the position coordinate normal to the interface, $z_0$ is the interface location, and $w$ is a width parameter that controls the steepness of the transition. The bulk density $n_0$ is determined from the Wigner–Seitz radius $r_s$ by the standard uniform electron gas relation\n$$\n\\frac{4\\pi}{3} r_s^3 n_0 = 1,\n$$\nso that\n$$\nn_0 = \\frac{3}{4\\pi r_s^3}.\n$$\n\nYour task is to:\n- Starting from the above DFT foundation, derive the LDA exchange-correlation potential $v_{\\mathrm{xc}}(n)$ as a function of the local electron density $n$ by taking the functional derivative of the exchange-correlation energy functional with respect to the density. Use the spin-unpolarized uniform electron gas for the exchange energy per particle and a standard, widely used parameterization for the correlation energy per particle of the uniform electron gas (spin-unpolarized), ensuring internal consistency.\n- Implement a function that computes $v_{\\mathrm{xc}}(z)$ across the interface using the provided $n(z)$ profile and your derived expression for $v_{\\mathrm{xc}}(n)$.\n- In the vacuum region far from the surface, compare the LDA $v_{\\mathrm{xc}}(z)$ at a specified large distance $z_\\mathrm{far}$ to the classical image potential $v_{\\mathrm{img}}(z) = -\\frac{1}{4(z - z_0)}$. Define the diagnostic ratio\n$$\nM = \\frac{v_{\\mathrm{xc}}(z_\\mathrm{far})}{-\\frac{1}{4(z_\\mathrm{far} - z_0)}},\n$$\nwhich should be a dimensionless number. A value of $M$ close to $1$ indicates the correct image tail behavior, while a value of $M$ close to $0$ indicates the absence of the image tail.\n\nAll distances must be in bohr and all potentials in Hartree. Angles do not appear. Express all final outputs as decimal floats. Your program must produce a single line containing the list of diagnostic ratios for the test suite, as a comma-separated list enclosed in square brackets.\n\nTest Suite:\n- Case $1$: $r_s = 2.0$, $w = 1.0$, $z_0 = 0.0$, $z_\\mathrm{far} = 12.0$.\n- Case $2$: $r_s = 3.0$, $w = 0.5$, $z_0 = 0.0$, $z_\\mathrm{far} = 15.0$.\n- Case $3$: $r_s = 5.0$, $w = 2.0$, $z_0 = 0.0$, $z_\\mathrm{far} = 20.0$.\n- Case $4$: $r_s = 2.0$, $w = 0.1$, $z_0 = 0.0$, $z_\\mathrm{far} = 10.0$.\n- Case $5$: $r_s = 20.0$, $w = 1.0$, $z_0 = 0.0$, $z_\\mathrm{far} = 15.0$.\n\nProgram Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[M_1,M_2,M_3,M_4,M_5]$), where each $M_i$ is the diagnostic ratio for the corresponding test case.",
            "solution": "The problem requires the computation of the Local Density Approximation (LDA) exchange-correlation potential, $v_{\\mathrm{xc}}(z)$, across a one-dimensional jellium-vacuum interface, and the quantification of its asymptotic behavior compared to the classical image potential. The solution is developed in atomic units (Hartree for energy, bohr for distance).\n\nThe theoretical foundation is Density Functional Theory (DFT), where the exchange-correlation (xc) energy of a spin-unpolarized system is given by the LDA functional:\n$$\nE_{\\mathrm{xc}}[n] = \\int n(\\mathbf{r}) \\epsilon_{\\mathrm{xc}}(n(\\mathbf{r})) \\, d\\mathbf{r}\n$$\nHere, $n(\\mathbf{r})$ is the electron density and $\\epsilon_{\\mathrm{xc}}(n)$ is the exchange-correlation energy per particle of a uniform electron gas (UEG) with density $n$. The xc-potential, $v_{\\mathrm{xc}}(\\mathbf{r})$, is the functional derivative of $E_{\\mathrm{xc}}[n]$ with respect to the density $n(\\mathbf{r})$:\n$$\nv_{\\mathrm{xc}}(\\mathbf{r}) = \\frac{\\delta E_{\\mathrm{xc}}[n]}{\\delta n(\\mathbf{r})}\n$$\nFor a local functional of the form $E[n] = \\int f(n(\\mathbf{r}))d\\mathbf{r}$, the derivative is $\\frac{\\delta E}{\\delta n(\\mathbf{r})} = \\frac{df(n)}{dn}\\bigg|_{n=n(\\mathbf{r})}$. In our case, $f(n) = n\\epsilon_{\\mathrm{xc}}(n)$, so applying the product rule for differentiation yields the expression for the LDA potential as a function of the local density:\n$$\nv_{\\mathrm{xc}}(n) = \\frac{d}{dn} [n \\epsilon_{\\mathrm{xc}}(n)] = \\epsilon_{\\mathrm{xc}}(n) + n \\frac{d\\epsilon_{\\mathrm{xc}}(n)}{dn}\n$$\nThe xc-energy per particle is separated into exchange and correlation components, $\\epsilon_{\\mathrm{xc}}(n) = \\epsilon_{\\mathrm{x}}(n) + \\epsilon_{\\mathrm{c}}(n)$, which results in a corresponding separation of the potential, $v_{\\mathrm{xc}}(n) = v_{\\mathrm{x}}(n) + v_{\\mathrm{c}}(n)$.\n\nThe density is often parameterized by the Wigner-Seitz radius $r_s$, defined by $\\frac{4\\pi}{3}r_s^3 = \\frac{1}{n}$, which gives $r_s(n) = \\left(\\frac{3}{4\\pi n}\\right)^{1/3}$. To compute the term $n \\frac{d\\epsilon_{\\mathrm{c}}(n)}{dn}$ when $\\epsilon_{\\mathrm{c}}$ is given as a function of $r_s$, we use the chain rule:\n$$\nn \\frac{d\\epsilon_{\\mathrm{c}}}{dn} = n \\frac{d\\epsilon_{\\mathrm{c}}}{dr_s}\\frac{dr_s}{dn} = n \\frac{d\\epsilon_{\\mathrm{c}}}{dr_s} \\left(-\\frac{1}{3n}r_s\\right) = -\\frac{r_s}{3}\\frac{d\\epsilon_{\\mathrm{c}}}{dr_s}\n$$\nThus, the xc-potential as a function of $r_s$ is $v_{\\mathrm{xc}}(r_s) = \\epsilon_{\\mathrm{xc}}(r_s) - \\frac{r_s}{3}\\frac{d\\epsilon_{\\mathrm{xc}}(r_s)}{dr_s}$.\n\n**Exchange Component**\nFor a spin-unpolarized UEG, the exchange energy per particle is known analytically:\n$$\n\\epsilon_{\\mathrm{x}}(n) = -\\frac{3}{4\\pi}(3\\pi^2 n)^{1/3}\n$$\nThe corresponding exchange potential is:\n$$\nv_{\\mathrm{x}}(n) = \\epsilon_{\\mathrm{x}}(n) + n \\frac{d\\epsilon_{\\mathrm{x}}(n)}{dn} = \\epsilon_{\\mathrm{x}}(n) + n \\left(\\frac{1}{3} \\frac{\\epsilon_{\\mathrm{x}}(n)}{n}\\right) = \\frac{4}{3}\\epsilon_{\\mathrm{x}}(n)\n$$\nIn terms of $r_s$, this is:\n$$\n\\epsilon_{\\mathrm{x}}(r_s) = -\\frac{3}{4\\pi}\\left(\\frac{9\\pi}{4}\\right)^{1/3} \\frac{1}{r_s} \\approx -\\frac{0.458165}{r_s}\n$$\n$$\nv_{\\mathrm{x}}(r_s) = \\frac{4}{3}\\epsilon_{\\mathrm{x}}(r_s) \\approx -\\frac{0.610887}{r_s}\n$$\n\n**Correlation Component**\nWe use the Perdew-Zunger'81 parameterization of the Ceperley-Alder Quantum Monte Carlo data for the correlation energy of the spin-unpolarized UEG. The functional form depends on the value of $r_s$.\n\nFor the low-density regime ($r_s \\geq 1$):\n$$\n\\epsilon_{\\mathrm{c}}(r_s) = \\frac{\\gamma}{1 + \\beta_1 \\sqrt{r_s} + \\beta_2 r_s}\n$$\nwith parameters $\\gamma = -0.1423$, $\\beta_1 = 1.0529$, $\\beta_2 = 0.3334$. The corresponding potential is:\n$$\nv_{\\mathrm{c}}(r_s) = \\epsilon_{\\mathrm{c}}(r_s) - \\frac{r_s}{3}\\frac{d\\epsilon_{\\mathrm{c}}(r_s)}{dr_s} = \\epsilon_{\\mathrm{c}}(r_s) \\left[ 1 + \\frac{\\frac{1}{2}\\beta_1 \\sqrt{r_s} + \\beta_2 r_s}{3(1 + \\beta_1 \\sqrt{r_s} + \\beta_2 r_s)} \\right]\n$$\n\nFor the high-density regime ($r_s < 1$):\n$$\n\\epsilon_{\\mathrm{c}}(r_s) = A \\ln r_s + B + C r_s \\ln r_s + D r_s\n$$\nwith parameters $A = 0.0311$, $B = -0.0480$, $C = 0.0020$, $D = -0.0116$. The corresponding potential is:\n$$\nv_{\\mathrm{c}}(r_s) = \\epsilon_{\\mathrm{c}}(r_s) - \\frac{r_s}{3}\\frac{d\\epsilon_{\\mathrm{c}}(r_s)}{dr_s} = A \\ln r_s + \\left(B - \\frac{A}{3}\\right) + \\frac{2C}{3} r_s \\ln r_s + \\frac{2D-C}{3} r_s\n$$\n\n**Computational Procedure**\nThe algorithm proceeds as follows for each test case defined by ($r_s^{\\text{bulk}}, w, z_0, z_{\\mathrm{far}}$):\n$1$. Calculate the bulk electron density $n_0 = \\frac{3}{4\\pi (r_s^{\\text{bulk}})^3}$.\n$2$. Calculate the local electron density $n(z_{\\mathrm{far}})$ at the specified far distance using the given profile: $n(z) = n_0 / (1 + \\exp((z - z_0)/w))$.\n$3$. Compute the local Wigner-Seitz radius $r_s(z_{\\mathrm{far}})$ from $n(z_{\\mathrm{far}})$.\n$4$. Calculate the total exchange-correlation potential $v_{\\mathrm{xc}}(z_{\\mathrm{far}}) = v_{\\mathrm{x}}(r_s(z_{\\mathrm{far}})) + v_{\\mathrm{c}}(r_s(z_{\\mathrm{far}}))$, using the appropriate PZ81 formula for $v_{\\mathrm{c}}$ based on the value of $r_s(z_{\\mathrm{far}})$.\n$5$. Calculate the classical image potential at the same point, $v_{\\mathrm{img}}(z_{\\mathrm{far}}) = -\\frac{1}{4(z_{\\mathrm{far}} - z_0)}$.\n$6$. Compute the final diagnostic ratio $M = v_{\\mathrm{xc}}(z_{\\mathrm{far}}) / v_{\\mathrm{img}}(z_{\\mathrm{far}})$. This ratio quantifies the deviation of the LDA potential from the correct asymptotic behavior. A value of $M$ close to $0$ demonstrates the known failure of LDA to reproduce the long-range image potential.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the LDA exchange-correlation potential profile across a 1D\n    jellium-vacuum interface and quantifies its asymptotic deviation from the\n    classical image potential tail.\n    \"\"\"\n    # Test cases from the problem statement.\n    # Each case is a tuple: (rs_bulk, w, z0, z_far)\n    test_cases = [\n        (2.0, 1.0, 0.0, 12.0),\n        (3.0, 0.5, 0.0, 15.0),\n        (5.0, 2.0, 0.0, 20.0),\n        (2.0, 0.1, 0.0, 10.0),\n        (20.0, 1.0, 0.0, 15.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        rs_bulk, w, z0, z_far = case\n\n        # Physical constants and helper functions in atomic units\n        pi = np.pi\n        \n        # Function to convert Wigner-Seitz radius to density\n        def rs_to_n(rs):\n            if rs = 0:\n                raise ValueError(\"r_s must be positive.\")\n            return 3.0 / (4.0 * pi * rs**3)\n\n        # Function to convert density to Wigner-Seitz radius\n        def n_to_rs(n):\n            if n = 0:\n                # In the limit n->0, rs->inf. Return a large number.\n                return np.inf\n            return (3.0 / (4.0 * pi * n))**(1.0 / 3.0)\n\n        # Perdew-Zunger '81 parameters for spin-unpolarized case\n        # High-density (rs  1)\n        A = 0.0311\n        B = -0.0480\n        C = 0.0020\n        D = -0.0116\n        # Low-density (rs >= 1)\n        GAMMA = -0.1423\n        BETA1 = 1.0529\n        BETA2 = 0.3334\n\n        # Exchange energy/potential constants\n        C_X_RS = (3.0 / (4.0 * pi)) * (9.0 * pi / 4.0)**(1.0 / 3.0) # for eps_x = -C_X_RS/rs\n\n        def v_xc_lda(rs):\n            \"\"\"\n            Calculates the LDA exchange-correlation potential v_xc for a given rs.\n            \"\"\"\n            if rs == np.inf or rs = 0:\n                return 0.0\n\n            # Exchange potential\n            v_x = -(4.0 / 3.0) * C_X_RS / rs\n\n            # Correlation potential\n            if rs >= 1.0:\n                sqrt_rs = np.sqrt(rs)\n                denominator = 1.0 + BETA1 * sqrt_rs + BETA2 * rs\n                eps_c = GAMMA / denominator\n                \n                # v_c = eps_c - (rs/3) * d(eps_c)/d(rs)\n                factor_num = 0.5 * BETA1 * sqrt_rs + BETA2 * rs\n                factor = 1.0 + factor_num / (3.0 * denominator)\n                v_c = eps_c * factor\n            else: # rs  1.0\n                ln_rs = np.log(rs)\n                # v_c = A*ln(rs) + (B-A/3) + (2C/3)*rs*ln(rs) + (2D-C)/3*rs\n                v_c = A * ln_rs + (B - A/3.0) + (2.0*C/3.0)*rs*ln_rs + ((2.0*D - C)/3.0)*rs\n            \n            return v_x + v_c\n\n        # Step 1: Calculate bulk density n0\n        n0 = rs_to_n(rs_bulk)\n\n        # Step 2: Calculate density n(z_far)\n        exponent_arg = (z_far - z0) / w\n        # Handle potential overflow in exp by checking the argument\n        if exponent_arg > 700: # np.exp(709) is near float max\n            n_far = 0.0\n        else:\n            n_far = n0 / (1.0 + np.exp(exponent_arg))\n\n        # Step 3: Calculate local Wigner-Seitz radius rs(z_far)\n        rs_far = n_to_rs(n_far)\n\n        # Step 4: Calculate v_xc at z_far\n        v_xc_far = v_xc_lda(rs_far)\n\n        # Step 5: Calculate image potential at z_far\n        if z_far - z0 = 0:\n            # Avoid division by zero or negative distance, though test cases prevent this\n            v_img_far = np.nan\n        else:\n            v_img_far = -1.0 / (4.0 * (z_far - z0))\n\n        # Step 6: Compute the diagnostic ratio M\n        if v_img_far == 0.0:\n             # This should not happen with the given test cases\n             M = np.nan\n        else:\n             M = v_xc_far / v_img_far\n        \n        results.append(M)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}