{
    "hands_on_practices": [
        {
            "introduction": "Our first practice exercise grounds us in the foundational application of tight-binding to one of the most studied materials: graphene. By constructing the Hamiltonian for its honeycomb lattice with only nearest-neighbor interactions, we can derive its most celebrated electronic feature—the linear dispersion at the Dirac points. This exercise is essential for mastering the core steps of translating a real-space lattice and atomic basis into a $\\mathbf{k}$-space Bloch Hamiltonian and connecting it to fundamental properties like the Fermi level .",
            "id": "3805341",
            "problem": "Consider a minimal empirical tight-binding description of graphene’s $\\pi$-electron system appropriate for multiscale materials simulation. The honeycomb lattice has two sublattices, labeled $A$ and $B$, and one carbon $p_z$ orbital per site. Assume equal on-site energies $\\varepsilon$ on $A$ and $B$ and only nearest-neighbor hopping of magnitude $t$ between $A$ and $B$. Treat electrons as non-interacting and assume spin degeneracy. Using the tight-binding basis of Bloch sums consistent with the discrete translational symmetry, construct the single-particle Bloch Hamiltonian and deduce the qualitative features of its spectrum that follow directly from the bipartite structure and nearest-neighbor connectivity. Then, using electron counting rooted in the valence configuration of carbon, determine the $\\pi$-band filling per unit cell at zero temperature for undoped graphene and locate the Fermi energy $E_F$ at half-filling relative to $\\varepsilon$ by identifying the energy at the band-touching (Dirac) points. Report your final result as a row matrix containing two entries in the order: the number of $\\pi$-electrons per unit cell and the Fermi energy at half-filling. No rounding is required. Do not include units. Your answer must be a single real-valued number or a single closed-form analytical expression for each entry and must be expressed as a row matrix.",
            "solution": "The problem asks for an analysis of a minimal tight-binding model for graphene's $\\pi$-electron system. We must first construct the Bloch Hamiltonian, analyze its spectral properties, and then use electron counting to determine the number of $\\pi$-electrons per unit cell and the Fermi energy at half-filling.\n\n**1. Lattice Structure and Basis**\nThe honeycomb lattice is a triangular Bravais lattice with a two-atom basis. Let the two basis atoms, belonging to sublattices $A$ and $B$, define the unit cell. We place an orbital, representing the carbon $p_z$ state, on each lattice site. The on-site energy for any orbital is given as $\\varepsilon$, so $\\varepsilon_A = \\varepsilon_B = \\varepsilon$. Hopping is restricted to nearest neighbors only, with a hopping integral of $-t$ (where $t>0$ is the hopping magnitude).\n\nThe tight-binding basis for a crystalline solid is formed by Bloch sums, which are symmetry-adapted linear combinations of atomic orbitals. For a system with two atoms per unit cell, we define two Bloch sums for each wavevector $\\mathbf{k}$ in the first Brillouin zone:\n$$|\\phi_A(\\mathbf{k})\\rangle = \\frac{1}{\\sqrt{N}} \\sum_{\\mathbf{R}_A} \\exp(i\\mathbf{k} \\cdot \\mathbf{R}_A) |\\mathbf{R}_A\\rangle$$\n$$|\\phi_B(\\mathbf{k})\\rangle = \\frac{1}{\\sqrt{N}} \\sum_{\\mathbf{R}_B} \\exp(i\\mathbf{k} \\cdot \\mathbf{R}_B) |\\mathbf{R}_B\\rangle$$\nHere, $N$ is the number of unit cells, $|\\mathbf{R}_A\\rangle$ and $|\\mathbf{R}_B\\rangle$ are the $p_z$ orbitals at sites $\\mathbf{R}_A$ and $\\mathbf{R}_B$ on sublattices $A$ and $B$ respectively, and the sums run over all sites of the respective sublattices.\n\n**2. Construction of the Bloch Hamiltonian**\nThe single-particle Bloch Hamiltonian $H(\\mathbf{k})$ is a $2 \\times 2$ matrix in the basis $\\{|\\phi_A(\\mathbf{k})\\rangle, |\\phi_B(\\mathbf{k})\\rangle\\}$:\n$$H(\\mathbf{k}) = \\begin{pmatrix} H_{AA}(\\mathbf{k}) & H_{AB}(\\mathbf{k}) \\\\ H_{BA}(\\mathbf{k}) & H_{BB}(\\mathbf{k}) \\end{pmatrix}$$\nwhere $H_{\\alpha\\beta}(\\mathbf{k}) = \\langle\\phi_\\alpha(\\mathbf{k})|\\hat{H}|\\phi_\\beta(\\mathbf{k})\\rangle$.\n\nThe diagonal elements represent the on-site energies. Since hopping is restricted to nearest neighbors and all nearest neighbors of an $A$-site are $B$-sites (and vice versa), there are no hopping terms between sites of the same sublattice.\n$$H_{AA}(\\mathbf{k}) = \\langle\\phi_A(\\mathbf{k})|\\hat{H}|\\phi_A(\\mathbf{k})\\rangle = \\frac{1}{N} \\sum_{\\mathbf{R}_A} \\langle\\mathbf{R}_A|\\hat{H}|\\mathbf{R}_A\\rangle = \\frac{1}{N} \\sum_{\\mathbf{R}_A} \\varepsilon = \\varepsilon$$\nBy identical reasoning, $H_{BB}(\\mathbf{k}) = \\varepsilon$.\n\nThe off-diagonal elements represent the nearest-neighbor hopping between the two sublattices. Let us consider an $A$-site at the origin. Its three nearest neighbors (all $B$-sites) are located at positions given by the vectors $\\boldsymbol{\\delta}_1, \\boldsymbol{\\delta}_2, \\boldsymbol{\\delta}_3$. The matrix element $H_{AB}(\\mathbf{k})$ is:\n$$H_{AB}(\\mathbf{k}) = \\langle\\phi_A(\\mathbf{k})|\\hat{H}|\\phi_B(\\mathbf{k})\\rangle$$\nExpanding this using the Bloch sums:\n$$H_{AB}(\\mathbf{k}) = \\frac{1}{N} \\sum_{\\mathbf{R}_A, \\mathbf{R}_B} \\exp(-i\\mathbf{k} \\cdot \\mathbf{R}_A) \\exp(i\\mathbf{k} \\cdot \\mathbf{R}_B) \\langle\\mathbf{R}_A|\\hat{H}|\\mathbf{R}_B\\rangle$$\nThe matrix element $\\langle\\mathbf{R}_A|\\hat{H}|\\mathbf{R}_B\\rangle$ is $-t$ if $\\mathbf{R}_A$ and $\\mathbf{R}_B$ are nearest neighbors, and $0$ otherwise. For each site $\\mathbf{R}_A$, the only non-zero contributions come from its three nearest-neighbor $B$-sites at positions $\\mathbf{R}_A + \\boldsymbol{\\delta}_j$ for $j=1, 2, 3$.\n$$H_{AB}(\\mathbf{k}) = \\frac{1}{N} \\sum_{\\mathbf{R}_A} \\sum_{j=1}^{3} \\exp(-i\\mathbf{k} \\cdot \\mathbf{R}_A) \\exp(i\\mathbf{k} \\cdot (\\mathbf{R}_A + \\boldsymbol{\\delta}_j)) (-t)$$\n$$H_{AB}(\\mathbf{k}) = \\frac{-t}{N} \\sum_{\\mathbf{R}_A} \\sum_{j=1}^{3} \\exp(i\\mathbf{k} \\cdot \\boldsymbol{\\delta}_j) = \\frac{-t}{N} (N) \\sum_{j=1}^{3} \\exp(i\\mathbf{k} \\cdot \\boldsymbol{\\delta}_j)$$\nLet's define the geometric structure factor $f(\\mathbf{k}) = \\sum_{j=1}^{3} \\exp(i\\mathbf{k} \\cdot \\boldsymbol{\\delta}_j)$. Then, $H_{AB}(\\mathbf{k}) = -t f(\\mathbf{k})$.\nThe Hamiltonian must be Hermitian, so $H_{BA}(\\mathbf{k}) = H_{AB}^*(\\mathbf{k}) = -t f^*(\\mathbf{k})$.\n\nThe Bloch Hamiltonian matrix is therefore:\n$$H(\\mathbf{k}) = \\begin{pmatrix} \\varepsilon & -t f(\\mathbf{k}) \\\\ -t f^*(\\mathbf{k}) & \\varepsilon \\end{pmatrix}$$\n\n**3. Spectrum and Qualitative Features**\nThe eigenvalues $E(\\mathbf{k})$ are found by solving the characteristic equation $\\det(H(\\mathbf{k}) - E I) = 0$:\n$$(\\varepsilon - E)^2 - (-t f(\\mathbf{k}))(-t f^*(\\mathbf{k})) = 0$$\n$$(\\varepsilon - E)^2 - t^2 |f(\\mathbf{k})|^2 = 0$$\n$$\\varepsilon - E = \\pm t |f(\\mathbf{k})|$$\nThis gives two energy bands (the $\\pi$ and $\\pi^*$ bands):\n$$E_{\\pm}(\\mathbf{k}) = \\varepsilon \\pm t |f(\\mathbf{k})|$$\nThe structure of the Hamiltonian and its spectrum reveals a crucial feature: the energies $E_{\\pm}(\\mathbf{k})$ are symmetric about the on-site energy $\\varepsilon$. This is a direct consequence of the bipartite nature of the lattice (no A-A or B-B nearest neighbors) and the assumption of equal on-site energies ($\\varepsilon_A = \\varepsilon_B$). This property is known as electron-hole symmetry.\n\n**4. Band Filling and Fermi Energy**\nThe primitive unit cell of graphene contains two carbon atoms. The electronic configuration of a carbon atom is $[He] 2s^2 2p^2$. In graphene, three valence electrons per atom participate in strong in-plane $sp^2$ hybridized $\\sigma$ bonds. The remaining one electron per atom occupies the $2p_z$ orbital, which is perpendicular to the graphene plane. These $p_z$ electrons form the $\\pi$-bands described by our tight-binding model.\n\nSince there are two carbon atoms per unit cell and one $\\pi$-electron per atom, the number of $\\pi$-electrons per unit cell is $2$.\n\nThe tight-binding model gives two energy bands, $E_+(\\mathbf{k})$ (conduction band) and $E_-(\\mathbf{k})$ (valence band). Taking into account spin degeneracy, each band can accommodate $2$ electrons per unit cell. With $2$ electrons per unit cell to place, at zero temperature ($T=0$), they will fill all the available states in the lower energy band, $E_-(\\mathbf{k})$. The upper band, $E_+(\\mathbf{k})$, will be completely empty. This situation is referred to as half-filling.\n\nThe Fermi energy, $E_F$, is the energy of the highest occupied state at $T=0$. In this case, it corresponds to the energy at the top of the filled valence band. For undoped graphene, the valence band $E_-(\\mathbf{k})$ is just filled and touches the empty conduction band $E_+(\\mathbf{k})$ at specific points in the Brillouin zone. These band-touching points, known as Dirac points, occur where the energy gap between the bands vanishes:\n$$E_+(\\mathbf{k}) - E_-(\\mathbf{k}) = 2t|f(\\mathbf{k})| = 0$$\nThis requires $|f(\\mathbf{k})| = 0$. At these Dirac points, $\\mathbf{k}=\\mathbf{K}$, the energy of both bands is degenerate:\n$$E_{\\pm}(\\mathbf{K}) = \\varepsilon \\pm t|f(\\mathbf{K})| = \\varepsilon \\pm 0 = \\varepsilon$$\nSince the valence band is full and the conduction band is empty, and they touch at energy $\\varepsilon$, the Fermi energy must be precisely this value.\nTherefore, for undoped graphene at half-filling, $E_F = \\varepsilon$.\n\nThe two results requested are:\n1.  Number of $\\pi$-electrons per unit cell: $2$.\n2.  Fermi energy at half-filling: $\\varepsilon$.",
            "answer": "$$\\boxed{\\begin{pmatrix} 2 & \\varepsilon \\end{pmatrix}}$$"
        },
        {
            "introduction": "Building upon the minimal model, our next exercise explores how to systematically improve a tight-binding description and understand the physical consequences. We will introduce next-nearest-neighbor hopping ($t'$) into the graphene model, a term often required for quantitative accuracy. This practice reveals how a seemingly small addition to the Hamiltonian breaks the model's particle-hole symmetry and shifts the energy of the Dirac points, demonstrating the sensitivity of electronic properties to the details of the model's parameterization .",
            "id": "3805405",
            "problem": "Consider a monolayer of graphene modeled by an empirical tight-binding (TB) Hamiltonian on the honeycomb lattice with two sublattices, denoted by $A$ and $B$. Let $t$ be the nearest-neighbor hopping amplitude between sublattices $A$ and $B$, and let $t'$ be the next-nearest-neighbor (NNN) hopping amplitude within the same sublattice. Assume there are no on-site energies and ignore spin. Use the following geometrical specification for the honeycomb lattice: its Bravais lattice is triangular with primitive vectors $\\mathbf{a}_{1} = a_{0}\\left(\\tfrac{1}{2}, \\tfrac{\\sqrt{3}}{2}\\right)$ and $\\mathbf{a}_{2} = a_{0}\\left(\\tfrac{1}{2}, -\\tfrac{\\sqrt{3}}{2}\\right)$, where $a_{0}$ is the lattice constant of the underlying triangular Bravais lattice. The three nearest-neighbor displacement vectors from a site on sublattice $A$ to sublattice $B$ can be chosen as $\\boldsymbol{\\delta}_{1} = a\\left(0, 1\\right)$, $\\boldsymbol{\\delta}_{2} = a\\left(\\tfrac{\\sqrt{3}}{2}, -\\tfrac{1}{2}\\right)$, and $\\boldsymbol{\\delta}_{3} = a\\left(-\\tfrac{\\sqrt{3}}{2}, -\\tfrac{1}{2}\\right)$, where $a = a_{0}/\\sqrt{3}$ is the nearest-neighbor bond length. The six next-nearest-neighbor displacement vectors within a given sublattice are $\\pm\\mathbf{a}_{1}$, $\\pm\\mathbf{a}_{2}$, and $\\pm(\\mathbf{a}_2-\\mathbf{a}_1)$. One of the Dirac points is located at $\\mathbf{K} = \\left(\\tfrac{4\\pi}{3 a_{0}}, 0\\right)$ in the Brillouin zone.\n\nStarting from the real-space TB Hamiltonian with nearest-neighbor and next-nearest-neighbor hoppings, use Bloch’s theorem to obtain the $2\\times 2$ Bloch Hamiltonian in $\\mathbf{k}$-space. Then, by analyzing the resulting band energies, identify how the next-nearest-neighbor hopping $t'$ induces particle–hole asymmetry and calculate the energy of the Dirac point. Your derivation must begin from the Hamiltonian definition in real space and proceed through the Fourier transform to $\\mathbf{k}$-space, identifying the relevant structure factors. Evaluate the Dirac-point energy at $\\mathbf{K}$ exactly.\n\nReport only the final analytic expression for the Dirac-point energy $E_{D}$ in terms of $t'$; no numerical values are required. Express your final answer symbolically as a closed-form expression in $t'$ only.",
            "solution": "The problem asks for the energy of the Dirac point in a graphene monolayer described by a tight-binding model that includes both nearest-neighbor (NN) hopping $t$ and next-nearest-neighbor (NNN) hopping $t'$.\n\nThe real-space tight-binding Hamiltonian $H$ can be written as the sum of a nearest-neighbor term $H_{NN}$ (hopping between sublattices A and B) and a next-nearest-neighbor term $H_{NNN}$ (hopping within the same sublattice).\n$$H = H_{NN} + H_{NNN}$$\n\nWe use Bloch's theorem to transform the Hamiltonian into $\\mathbf{k}$-space. In the basis of Bloch states $|A, \\mathbf{k}\\rangle$ and $|B, \\mathbf{k}\\rangle$ for the two sublattices, the Hamiltonian becomes a $2\\times 2$ matrix $H(\\mathbf{k})$ for each crystal momentum $\\mathbf{k}$:\n$$H(\\mathbf{k}) = \\begin{pmatrix} H_{AA}(\\mathbf{k}) & H_{AB}(\\mathbf{k}) \\\\ H_{BA}(\\mathbf{k}) & H_{BB}(\\mathbf{k}) \\end{pmatrix}$$\n\nThe off-diagonal elements arise from the nearest-neighbor hopping $H_{NN}$. These are given by:\n$$H_{AB}(\\mathbf{k}) = -t \\sum_{j=1}^{3} e^{i\\mathbf{k}\\cdot\\boldsymbol{\\delta}_j} = -t f(\\mathbf{k})$$\nwhere $f(\\mathbf{k})$ is the geometric structure factor for nearest neighbors. The other off-diagonal element is the hermitian conjugate, $H_{BA}(\\mathbf{k}) = H_{AB}^*(\\mathbf{k}) = -t f^*(\\mathbf{k})$.\n\nThe diagonal elements arise from the next-nearest-neighbor hopping $H_{NNN}$, which connects sites within the same sublattice. The six NNN displacement vectors are given as $\\pm\\mathbf{a}_1, \\pm\\mathbf{a}_2, \\pm(\\mathbf{a}_2-\\mathbf{a}_1)$. The Fourier transform of the NNN hopping terms leads to:\n$$H_{AA}(\\mathbf{k}) = H_{BB}(\\mathbf{k}) = -t' \\left( e^{i\\mathbf{k}\\cdot\\mathbf{a}_1} + e^{-i\\mathbf{k}\\cdot\\mathbf{a}_1} + e^{i\\mathbf{k}\\cdot\\mathbf{a}_2} + e^{-i\\mathbf{k}\\cdot\\mathbf{a}_2} + e^{i\\mathbf{k}\\cdot(\\mathbf{a}_2-\\mathbf{a}_1)} + e^{-i\\mathbf{k}\\cdot(\\mathbf{a}_2-\\mathbf{a}_1)} \\right)$$\n$$H_{AA}(\\mathbf{k}) = -2t' \\left( \\cos(\\mathbf{k}\\cdot\\mathbf{a}_1) + \\cos(\\mathbf{k}\\cdot\\mathbf{a}_2) + \\cos(\\mathbf{k}\\cdot(\\mathbf{a}_2-\\mathbf{a}_1)) \\right)$$\nLet's define the NNN structure factor $g(\\mathbf{k}) = 2(\\cos(\\mathbf{k}\\cdot\\mathbf{a}_1) + \\cos(\\mathbf{k}\\cdot\\mathbf{a}_2) + \\cos(\\mathbf{k}\\cdot(\\mathbf{a}_2-\\mathbf{a}_1)))$. Then $H_{AA}(\\mathbf{k}) = H_{BB}(\\mathbf{k}) = -t'g(\\mathbf{k})$.\n\nThe full Bloch Hamiltonian (with on-site energy set to zero) is:\n$$H(\\mathbf{k}) = \\begin{pmatrix} -t'g(\\mathbf{k}) & -t f(\\mathbf{k}) \\\\ -t f^*(\\mathbf{k}) & -t'g(\\mathbf{k}) \\end{pmatrix}$$\nThe eigenvalues $E(\\mathbf{k})$ give the energy bands:\n$$( -t'g(\\mathbf{k}) - E )^2 - |-t f(\\mathbf{k})|^2 = 0$$\n$$E(\\mathbf{k}) = -t'g(\\mathbf{k}) \\pm t|f(\\mathbf{k})|$$\n\nThe Dirac points are the $\\mathbf{k}$-vectors where the two bands touch, which occurs when the gap closes, i.e., $t|f(\\mathbf{k})| = 0$. This requires $f(\\mathbf{k})=0$. The energy at a Dirac point $\\mathbf{K}$ is therefore:\n$$E_D = E(\\mathbf{K}) = -t'g(\\mathbf{K})$$\nThe problem asks for this energy at the specific Dirac point $\\mathbf{K} = \\left(\\tfrac{4\\pi}{3 a_{0}}, 0\\right)$. We need to calculate $g(\\mathbf{K})$ by first computing the necessary dot products using the given vectors:\n$\\mathbf{a}_{1} = a_{0}\\left(\\tfrac{1}{2}, \\tfrac{\\sqrt{3}}{2}\\right)$ and $\\mathbf{a}_{2} = a_{0}\\left(\\tfrac{1}{2}, -\\tfrac{\\sqrt{3}}{2}\\right)$.\n\n1.  $\\mathbf{K} \\cdot \\mathbf{a}_1 = \\left(\\frac{4\\pi}{3 a_{0}}\\right) \\left(a_0 \\frac{1}{2}\\right) = \\frac{2\\pi}{3}$\n2.  $\\mathbf{K} \\cdot \\mathbf{a}_2 = \\left(\\frac{4\\pi}{3 a_{0}}\\right) \\left(a_0 \\frac{1}{2}\\right) = \\frac{2\\pi}{3}$\n3.  $\\mathbf{a}_2 - \\mathbf{a}_1 = a_0(0, -\\sqrt{3})$. So, $\\mathbf{K} \\cdot (\\mathbf{a}_2 - \\mathbf{a}_1) = 0$.\n\nNow we substitute these into the expression for $g(\\mathbf{K})$:\n$$g(\\mathbf{K}) = 2\\cos\\left(\\frac{2\\pi}{3}\\right) + 2\\cos\\left(\\frac{2\\pi}{3}\\right) + 2\\cos(0)$$\nUsing $\\cos(2\\pi/3) = -1/2$ and $\\cos(0) = 1$:\n$$g(\\mathbf{K}) = 2\\left(-\\frac{1}{2}\\right) + 2\\left(-\\frac{1}{2}\\right) + 2(1) = -1 - 1 + 2 = 0$$\nFinally, the energy of the Dirac point is:\n$$E_D = -t' g(\\mathbf{K}) = -t'(0) = 0$$\nThe energy at the Dirac point is therefore $E_D = 0$. This shows that while the next-nearest-neighbor hopping $t'$ breaks the overall particle-hole symmetry of the spectrum (by adding the term $-t'g(\\mathbf{k})$ which is not symmetric about $E=0$ for a general $\\mathbf{k}$), it does not shift the energy of the Dirac point itself. The particle-hole asymmetry is manifested in the band structure away from the K-points.",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "The final practice transitions from analytical band structure theory to essential numerical implementation, focusing on the calculation of the Density of States (DOS). An energy dispersion $E(\\mathbf{k})$ is only the first step; computing observable properties like the DOS requires careful integration over the Brillouin zone. This exercise guides you through implementing and comparing a simple histogram method with a more sophisticated adaptive smearing technique, providing critical hands-on experience in the numerical methods that underpin modern materials simulation .",
            "id": "3805383",
            "problem": "You are asked to implement a numerical computation of the Density of States (DOS) for a single-band Empirical Tight-Binding (ETB) model on a three-dimensional simple cubic lattice. The aim is to compare the convergence properties of two numerical estimators: a basic histogram binning and an adaptive smearing method. The foundational base is the Bloch dispersion relation for a simple cubic lattice with one orbital per site and nearest-neighbor hopping. The dispersion is given by $E(\\mathbf{k}) = \\varepsilon + 2t\\left[\\cos\\left(k_x a\\right) + \\cos\\left(k_y a\\right) + \\cos\\left(k_z a\\right)\\right]$, where $a$ is the lattice constant, $\\varepsilon$ is an on-site energy, and $t$ is a hopping parameter. The reciprocal-space domain is the first Brillouin zone (BZ), defined by $k_x, k_y, k_z \\in [-\\pi/a,\\pi/a]$. All trigonometric arguments must be computed in radians. The task is to derive the DOS estimators from first principles and implement them for numerical evaluation.\n\nThe Density of States (DOS), denoted by $D(E)$, is defined as the density of energy eigenvalues in energy-space per cell, per unit energy. For a single band sampled on a uniform $\\mathbf{k}$-space mesh with $N$ points along each axis and $N_k = N^3$ total points, the definition is $D(E) = \\frac{1}{N_k}\\sum_{\\mathbf{k}} \\delta\\!\\left(E - E(\\mathbf{k})\\right)$, where $\\delta(\\cdot)$ is the Dirac delta function. The goal is to approximate this definition using two different numerical approaches:\n- A simple histogram estimator that bins the energies $E(\\mathbf{k})$ into $N_b$ uniform bins across the energy range and normalizes by the bin width to obtain a piecewise constant approximation to $D(E)$.\n- An adaptive Gaussian smearing estimator that replaces the Dirac delta $\\delta(\\cdot)$ by a normalized Gaussian $G_{\\sigma(\\mathbf{k})}(\\cdot)$ with a $\\mathbf{k}$-dependent width $\\sigma(\\mathbf{k})$ chosen to reflect local band dispersion. Use $\\sigma(\\mathbf{k}) = \\alpha \\|\\nabla_{\\mathbf{k}} E(\\mathbf{k})\\| \\Delta k$, where $\\alpha$ is a dimensionless tuning parameter, $\\|\\nabla_{\\mathbf{k}} E(\\mathbf{k})\\|$ is the norm of the gradient of the energy with respect to $\\mathbf{k}$, and $\\Delta k = 2\\pi/(a N)$ is the uniform mesh spacing in reciprocal space. Impose a strictly positive lower bound $\\sigma_{\\min}$ to avoid division by zero at stationary points. The Gaussian must be normalized as $G_{\\sigma}(x) = \\frac{1}{\\sqrt{2\\pi}\\sigma}\\exp\\!\\left(-\\frac{x^2}{2\\sigma^2}\\right)$ so that $\\int_{-\\infty}^{\\infty} G_{\\sigma}(x)\\,\\mathrm{d}x = 1$.\n\nTo evaluate convergence, define a reference DOS $D_{\\mathrm{ref}}(E)$ computed using a high-resolution histogram on a finer $\\mathbf{k}$-space mesh of size $N_{\\mathrm{ref}}$ along each axis and a large number of energy bins $N_{b,\\mathrm{ref}}$. For any test case, compute the DOS on a uniform energy grid of $N_b$ bin centers spanning $[E_{\\min}, E_{\\max}]$, where $E_{\\min} = \\varepsilon - 6|t|$ and $E_{\\max} = \\varepsilon + 6|t|$. Compare each method to the reference via the integrated squared error (ISE),\n$$\n\\mathrm{ISE} = \\sum_{i=1}^{N_b} \\left[D_{\\mathrm{method}}(E_i) - D_{\\mathrm{ref}}(E_i)\\right]^2 \\,\\Delta E,\n$$\nwhere $E_i$ are bin centers and $\\Delta E = (E_{\\max} - E_{\\min})/N_b$. The ISE must be reported in units of states squared per electronvolt ($\\mathrm{states}^2/\\mathrm{eV}$) per cell. Energies must be in electronvolts (eV), lattice constant in ångströms (Å), and angles in radians.\n\nImplement the following:\n1. A function to generate the $\\mathbf{k}$-space grid with $N$ points per axis over the first Brillouin zone, using a uniform grid spacing $\\Delta k = 2\\pi/(a N)$ and sampling points $k_\\mu = -\\pi/a + i\\Delta k$ for $i = 0,1,\\dots,N-1$ and $\\mu \\in \\{x,y,z\\}$.\n2. A function to compute $E(\\mathbf{k})$ and $\\|\\nabla_{\\mathbf{k}} E(\\mathbf{k})\\|$ for each $\\mathbf{k}$ on the grid.\n3. A histogram-based DOS estimator that produces $D_{\\mathrm{hist}}(E_i)$ at the bin centers $E_i$ with normalization such that $\\sum_i D_{\\mathrm{hist}}(E_i)\\Delta E \\approx 1$.\n4. An adaptive smearing DOS estimator that produces $D_{\\mathrm{smear}}(E_i)$ at the same energy bin centers using $\\sigma(\\mathbf{k}) = \\alpha \\|\\nabla_{\\mathbf{k}} E(\\mathbf{k})\\| \\Delta k$ with a positive floor $\\sigma_{\\min}$.\n5. A high-resolution reference DOS $D_{\\mathrm{ref}}(E)$ computed by a histogram on a finer mesh with $N_{\\mathrm{ref}}$ and $N_{b,\\mathrm{ref}}$ chosen to be large enough to serve as a surrogate ground truth, and interpolated onto the $E_i$ used in each test case.\n\nUse the fixed physical parameters for all test cases: $a = 3.0\\,\\mathrm{\\AA}$, $\\varepsilon = 0.0\\,\\mathrm{eV}$, and $t = -1.0\\,\\mathrm{eV}$. Use $\\sigma_{\\min} = 10^{-5}\\,\\mathrm{eV}$ in all cases. All trigonometric function evaluations must use radians.\n\nProvide a test suite comprising the following four parameter sets, designed to probe different convergence regimes:\n- Case A (general resolved case): $N = 16$, $N_b = 200$, $\\alpha = 0.6$.\n- Case B (coarse $\\mathbf{k}$-mesh boundary): $N = 6$, $N_b = 200$, $\\alpha = 0.2$.\n- Case C (few energy bins edge case): $N = 22$, $N_b = 60$, $\\alpha = 1.0$.\n- Case D (many energy bins sensitivity): $N = 14$, $N_b = 600$, $\\alpha = 0.5$.\n\nFor the reference, use $N_{\\mathrm{ref}} = 46$ and $N_{b,\\mathrm{ref}} = 1200$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the test cases A through D. Each test case result must itself be a list of two floats $[\\mathrm{ISE}_{\\mathrm{hist}}, \\mathrm{ISE}_{\\mathrm{smear}}]$, rounded to six decimal places. For example, the output line must have the form\n$[\\,[\\mathrm{ISE}_{\\mathrm{hist},A},\\mathrm{ISE}_{\\mathrm{smear},A}],\\,[\\mathrm{ISE}_{\\mathrm{hist},B},\\mathrm{ISE}_{\\mathrm{smear},B}],\\,[\\mathrm{ISE}_{\\mathrm{hist},C},\\mathrm{ISE}_{\\mathrm{smear},C}],\\,[\\mathrm{ISE}_{\\mathrm{hist},D},\\mathrm{ISE}_{\\mathrm{smear},D}]\\,]$.\n\nAll energies must be reported in electronvolts (eV). The integrated squared errors must be reported in $\\mathrm{states}^2/\\mathrm{eV}$ per cell. All angles must be in radians.",
            "solution": "This problem requires implementing and comparing two numerical methods for calculating the Density of States (DOS) for a single-band tight-binding model on a simple cubic lattice. The solution involves defining the model, deriving necessary analytical expressions, implementing the DOS estimators, and computing the error against a high-resolution reference.\n\n**1. Model and Analytical Expressions**\nThe energy dispersion for the simple cubic lattice model is given by:\n$$E(\\mathbf{k}) = \\varepsilon + 2t\\left[\\cos\\left(k_x a\\right) + \\cos\\left(k_y a\\right) + \\cos\\left(k_z a\\right)\\right]$$\nThe gradient of the dispersion, $\\|\\nabla_{\\mathbf{k}} E(\\mathbf{k})\\|$, is required for the adaptive smearing width. Its squared norm is:\n$$ \\|\\nabla_{\\mathbf{k}} E(\\mathbf{k})\\|^2 = (-2ta)^2 \\left( \\sin^2(k_x a) + \\sin^2(k_y a) + \\sin^2(k_z a) \\right) $$\n\n**2. Numerical Implementation Strategy**\nThe overall algorithm consists of two main parts: calculating a reference DOS and then evaluating the test cases against it.\n\n*   **Reference DOS Calculation:** A high-resolution reference DOS is computed once to serve as a 'ground truth'.\n    1.  A fine $\\mathbf{k}$-space grid ($N_{\\mathrm{ref}}=46$) is generated over the first Brillouin zone.\n    2.  The energy $E(\\mathbf{k})$ is calculated for each of the $N_{\\mathrm{ref}}^3$ points.\n    3.  These energies are binned into a fine histogram ($N_{b,\\mathrm{ref}}=1200$) over the band's energy range.\n    4.  The histogram counts are normalized by the total number of $\\mathbf{k}$-points and the energy bin width to obtain the reference DOS, $D_{\\mathrm{ref}}(E_i)$.\n\n*   **Test Case Evaluation Loop:** For each of the four specified test cases:\n    1.  A coarser $\\mathbf{k}$-mesh (size $N$) and energy grid (size $N_b$) are generated according to the case parameters.\n    2.  Energies $E(\\mathbf{k})$ and gradient norms $\\|\\nabla_{\\mathbf{k}} E(\\mathbf{k})\\|$ are computed on this test $\\mathbf{k}$-mesh.\n    3.  **Histogram DOS:** The energies are binned into a histogram. The counts are normalized by the number of $\\mathbf{k}$-points ($N^3$) and the energy bin width $\\Delta E$ to get $D_{\\mathrm{hist}}(E_i)$.\n    4.  **Adaptive Smearing DOS:** For each $\\mathbf{k}$-point, an adaptive Gaussian smearing width is calculated: $\\sigma(\\mathbf{k}) = \\max(\\sigma_{\\min}, \\alpha \\|\\nabla_{\\mathbf{k}} E(\\mathbf{k})\\| \\Delta k)$. The total DOS at each energy grid point $E_i$ is computed as the average sum of these normalized Gaussian functions centered at their respective energies $E(\\mathbf{k})$: $D_{\\mathrm{smear}}(E_i) = \\frac{1}{N^3} \\sum_{\\mathbf{k}} G_{\\sigma(\\mathbf{k})}(E_i - E(\\mathbf{k}))$.\n    5.  **Error Calculation:** The pre-computed reference DOS is linearly interpolated onto the current test case's energy grid. The Integrated Squared Error (ISE) is then calculated for both the histogram and smearing methods by summing the squared differences between the computed DOS and the interpolated reference, weighted by the energy bin width $\\Delta E$.\n\nThis procedure is repeated for all test cases, and the resulting ISE values are collected and formatted for the final output.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and compares the Integrated Squared Error (ISE) for two different\n    Density of States (DOS) estimators (histogram and adaptive Gaussian smearing)\n    for a single-band tight-binding model on a simple cubic lattice.\n    \"\"\"\n    \n    # --- Fixed Physical and Reference Parameters ---\n    A_LATTICE = 3.0       # Lattice constant in Angstrom\n    EPSILON = 0.0         # On-site energy in eV\n    T_HOP = -1.0          # Hopping parameter in eV\n    SIGMA_MIN = 1e-5      # Minimum smearing width in eV\n    N_REF = 46            # k-mesh size for reference calculation\n    N_B_REF = 1200        # Number of energy bins for reference calculation\n\n    # Define the test cases from the problem statement\n    test_cases = [\n        # (N, N_b, alpha)\n        (16, 200, 0.6),  # Case A\n        (6, 200, 0.2),   # Case B\n        (22, 60, 1.0),   # Case C\n        (14, 600, 0.5),  # Case D\n    ]\n\n    # --- Pre-compute High-Resolution Reference DOS ---\n    \n    # Energy band limits are determined by the dispersion relation\n    e_min = EPSILON - 6 * abs(T_HOP)\n    e_max = EPSILON + 6 * abs(T_HOP)\n    \n    # Generate reference k-grid\n    delta_k_ref = 2 * np.pi / (A_LATTICE * N_REF)\n    k_vals_ref = -np.pi / A_LATTICE + np.arange(N_REF) * delta_k_ref\n    kx_ref, ky_ref, kz_ref = np.meshgrid(k_vals_ref, k_vals_ref, k_vals_ref, indexing='ij')\n\n    # Calculate energies on reference grid\n    cos_sum_ref = np.cos(kx_ref * A_LATTICE) + np.cos(ky_ref * A_LATTICE) + np.cos(kz_ref * A_LATTICE)\n    energies_ref_flat = (EPSILON + 2 * T_HOP * cos_sum_ref).flatten()\n    \n    # Define reference energy grid\n    energy_bins_ref = np.linspace(e_min, e_max, N_B_REF + 1)\n    delta_e_ref = (e_max - e_min) / N_B_REF\n    \n    # Compute reference DOS using histogram method\n    dos_ref_counts, _ = np.histogram(energies_ref_flat, bins=energy_bins_ref)\n    dos_ref_values = dos_ref_counts / (N_REF**3 * delta_e_ref)\n    energy_centers_ref = (energy_bins_ref[:-1] + energy_bins_ref[1:]) / 2\n\n    # --- Process Each Test Case ---\n    all_results = []\n    for N, N_b, alpha in test_cases:\n        N_k = N**3\n        \n        # --- Setup for Current Test Case ---\n        delta_k = 2 * np.pi / (A_LATTICE * N)\n        k_vals = -np.pi / A_LATTICE + np.arange(N) * delta_k\n        kx, ky, kz = np.meshgrid(k_vals, k_vals, k_vals, indexing='ij')\n\n        # Energy grid for test case evaluation\n        delta_e = (e_max - e_min) / N_b\n        energy_bins = np.linspace(e_min, e_max, N_b + 1)\n        energy_centers = (energy_bins[:-1] + energy_bins[1:]) / 2\n\n        # --- Calculate Energies and Gradients on Test k-mesh ---\n        cos_sum = np.cos(kx * A_LATTICE) + np.cos(ky * A_LATTICE) + np.cos(kz * A_LATTICE)\n        energies_flat = (EPSILON + 2 * T_HOP * cos_sum).flatten()\n\n        sin_sq_sum = np.sin(kx * A_LATTICE)**2 + np.sin(ky * A_LATTICE)**2 + np.sin(kz * A_LATTICE)**2\n        grad_norm_flat = (2 * abs(T_HOP) * A_LATTICE * np.sqrt(sin_sq_sum)).flatten()\n\n        # --- Method 1: Histogram DOS ---\n        dos_hist_counts, _ = np.histogram(energies_flat, bins=energy_bins)\n        dos_hist = dos_hist_counts / (N_k * delta_e)\n\n        # --- Method 2: Adaptive Smearing DOS ---\n        sigma_k = alpha * grad_norm_flat * delta_k\n        sigma_k = np.maximum(sigma_k, SIGMA_MIN)\n\n        # Vectorized calculation of smearing DOS to improve performance\n        # Shapes: energy_centers (N_b,), energies_flat (N_k,), sigma_k (N_k,)\n        diff_matrix = energy_centers[:, np.newaxis] - energies_flat[np.newaxis, :]  # Shape (N_b, N_k)\n        sigma_k_bcast = sigma_k[np.newaxis, :] # Shape (1, N_k)\n        \n        prefactor = 1.0 / (np.sqrt(2 * np.pi) * sigma_k_bcast)\n        exponent = -0.5 * (diff_matrix / sigma_k_bcast)**2\n        \n        gaussians_matrix = prefactor * np.exp(exponent)\n        dos_smear = np.sum(gaussians_matrix, axis=1) / N_k\n\n        # --- Compare with Reference and Calculate ISE ---\n        # Interpolate reference DOS onto the test case's energy grid\n        dos_ref_interp = np.interp(energy_centers, energy_centers_ref, dos_ref_values)\n\n        # Calculate Integrated Squared Error (ISE) for both methods\n        ise_hist = np.sum((dos_hist - dos_ref_interp)**2) * delta_e\n        ise_smear = np.sum((dos_smear - dos_ref_interp)**2) * delta_e\n        \n        # Append rounded results for the current case\n        all_results.append([round(ise_hist, 6), round(ise_smear, 6)])\n\n    # Format and print the final output as a single-line string\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        }
    ]
}