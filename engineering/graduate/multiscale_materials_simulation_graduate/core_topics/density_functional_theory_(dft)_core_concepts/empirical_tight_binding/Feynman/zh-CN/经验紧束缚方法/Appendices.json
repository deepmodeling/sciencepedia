{
    "hands_on_practices": [
        {
            "introduction": "掌握经验紧束缚方法的最好方式之一就是将其应用于一个具有代表性的真实材料。本练习将指导你完成对石墨烯这一标志性二维材料的基础建模过程 。你将从其蜂巢晶格结构出发，一步步构建布洛赫哈密顿量，并最终揭示其著名的狄拉克点和费米能级的物理起源。",
            "id": "3805341",
            "problem": "考虑一个适用于多尺度材料模拟的石墨烯$\\pi$电子系统的最小经验紧束缚模型。蜂窝晶格有两个子晶格，标记为$A$和$B$，每个格点有一个碳原子的$p_z$轨道。假设$A$和$B$上的在位能$\\varepsilon$相等，并且只有$A$和$B$之间的最近邻跃迁，其跃迁能量大小为$t$。将电子视为无相互作用，并假设自旋简并。使用与离散平移对称性一致的布洛赫和的紧束缚基矢，构建单粒子布洛赫哈密顿量，并推导其能谱中直接由二分结构和最近邻连通性产生的定性特征。然后，利用基于碳的价电子构型的电子计数法，确定未掺杂石墨烯在零温下每个晶胞的$\\pi$带填充数，并通过确定能带接触点（狄拉克点）的能量，来定位半填充时的费米能$E_F$相对于$\\varepsilon$的位置。将最终结果以行矩阵的形式报告，其中包含两个条目，顺序为：每个晶胞的$\\pi$电子数和半填充时的费米能。无需四舍五入。不要包含单位。你的答案的每个条目必须是单个实值数或单个闭式解析表达式，并且必须表示为行矩阵。",
            "solution": "问题要求分析石墨烯$\\pi$电子系统的最小紧束缚模型。我们必须首先构建布洛赫哈密顿量，分析其能谱性质，然后使用电子计数法确定每个晶胞的$\\pi$电子数和半填充时的费米能。\n\n**1. 晶格结构与基矢**\n蜂窝晶格是一个具有双原子基底的三角布拉维晶格。令属于子晶格$A$和$B$的两个基底原子定义晶胞。我们在每个格点上放置一个轨道，代表碳的$p_z$态。任何轨道上的在位能都为$\\varepsilon$，因此$\\varepsilon_A = \\varepsilon_B = \\varepsilon$。跃迁仅限于最近邻，跃迁积分为$-t$（其中$t>0$是跃迁能量大小）。\n\n晶体的紧束缚基矢由布洛赫和构成，它们是原子轨道的对称性匹配线性组合。对于每个晶胞有两个原子的系统，我们在第一布里渊区为每个波矢$\\mathbf{k}$定义两个布洛赫和：\n$$|\\phi_A(\\mathbf{k})\\rangle = \\frac{1}{\\sqrt{N}} \\sum_{\\mathbf{R}_A} \\exp(i\\mathbf{k} \\cdot \\mathbf{R}_A) |\\mathbf{R}_A\\rangle$$\n$$|\\phi_B(\\mathbf{k})\\rangle = \\frac{1}{\\sqrt{N}} \\sum_{\\mathbf{R}_B} \\exp(i\\mathbf{k} \\cdot \\mathbf{R}_B) |\\mathbf{R}_B\\rangle$$\n这里，$N$是晶胞的数量， $|\\mathbf{R}_A\\rangle$和$|\\mathbf{R}_B\\rangle$分别是子晶格$A$和$B$上位置为$\\mathbf{R}_A$和$\\mathbf{R}_B$的格点上的$p_z$轨道，求和遍及各自子晶格的所有格点。\n\n**2. 构建布洛赫哈密顿量**\n单粒子布洛赫哈密顿量$H(\\mathbf{k})$是在基矢 $\\{|\\phi_A(\\mathbf{k})\\rangle, |\\phi_B(\\mathbf{k})\\rangle\\}$下的一个$2 \\times 2$矩阵：\n$$H(\\mathbf{k}) = \\begin{pmatrix} H_{AA}(\\mathbf{k}) & H_{AB}(\\mathbf{k}) \\\\ H_{BA}(\\mathbf{k}) & H_{BB}(\\mathbf{k}) \\end{pmatrix}$$\n其中 $H_{\\alpha\\beta}(\\mathbf{k}) = \\langle\\phi_\\alpha(\\mathbf{k})|\\hat{H}|\\phi_\\beta(\\mathbf{k})\\rangle$。\n\n对角元素表示在位能。由于跃迁仅限于最近邻，并且$A$格点的所有最近邻都是$B$格点（反之亦然），因此同一子晶格的格点之间没有跃迁项。\n$$H_{AA}(\\mathbf{k}) = \\langle\\phi_A(\\mathbf{k})|\\hat{H}|\\phi_A(\\mathbf{k})\\rangle = \\frac{1}{N} \\sum_{\\mathbf{R}_A} \\langle\\mathbf{R}_A|\\hat{H}|\\mathbf{R}_A\\rangle = \\frac{1}{N} \\sum_{\\mathbf{R}_A} \\varepsilon = \\varepsilon$$\n根据相同的推理，$H_{BB}(\\mathbf{k}) = \\varepsilon$。\n\n非对角元素表示两个子晶格之间的最近邻跃迁。让我们考虑位于原点的一个$A$格点。它的三个最近邻（均为$B$格点）位于由矢量$\\boldsymbol{\\delta}_1, \\boldsymbol{\\delta}_2, \\boldsymbol{\\delta}_3$给出的位置。矩阵元$H_{AB}(\\mathbf{k})$是：\n$$H_{AB}(\\mathbf{k}) = \\langle\\phi_A(\\mathbf{k})|\\hat{H}|\\phi_B(\\mathbf{k})\\rangle$$\n使用布洛赫和展开此式：\n$$H_{AB}(\\mathbf{k}) = \\frac{1}{N} \\sum_{\\mathbf{R}_A, \\mathbf{R}_B} \\exp(-i\\mathbf{k} \\cdot \\mathbf{R}_A) \\exp(i\\mathbf{k} \\cdot \\mathbf{R}_B) \\langle\\mathbf{R}_A|\\hat{H}|\\mathbf{R}_B\\rangle$$\n如果$\\mathbf{R}_A$和$\\mathbf{R}_B$是最近邻，矩阵元$\\langle\\mathbf{R}_A|\\hat{H}|\\mathbf{R}_B\\rangle$为$-t$，否则为$0$。对于每个格点$\\mathbf{R}_A$，唯一非零的贡献来自其三个最近邻$B$格点，其位置为$\\mathbf{R}_A + \\boldsymbol{\\delta}_j$（$j=1, 2, 3$）。\n$$H_{AB}(\\mathbf{k}) = \\frac{1}{N} \\sum_{\\mathbf{R}_A} \\sum_{j=1}^{3} \\exp(-i\\mathbf{k} \\cdot \\mathbf{R}_A) \\exp(i\\mathbf{k} \\cdot (\\mathbf{R}_A + \\boldsymbol{\\delta}_j)) (-t)$$\n$$H_{AB}(\\mathbf{k}) = \\frac{-t}{N} \\sum_{\\mathbf{R}_A} \\sum_{j=1}^{3} \\exp(i\\mathbf{k} \\cdot \\boldsymbol{\\delta}_j) = \\frac{-t}{N} (N) \\sum_{j=1}^{3} \\exp(i\\mathbf{k} \\cdot \\boldsymbol{\\delta}_j)$$\n我们定义几何结构因子$f(\\mathbf{k}) = \\sum_{j=1}^{3} \\exp(i\\mathbf{k} \\cdot \\boldsymbol{\\delta}_j)$。那么，$H_{AB}(\\mathbf{k}) = -t f(\\mathbf{k})$。\n哈密顿量必须是厄米（Hermitian）的，所以$H_{BA}(\\mathbf{k}) = H_{AB}^*(\\mathbf{k}) = -t f^*(\\mathbf{k})$。\n\n因此，布洛赫哈密顿矩阵为：\n$$H(\\mathbf{k}) = \\begin{pmatrix} \\varepsilon & -t f(\\mathbf{k}) \\\\ -t f^*(\\mathbf{k}) & \\varepsilon \\end{pmatrix}$$\n\n**3. 能谱与定性特征**\n本征值$E(\\mathbf{k})$通过求解特征方程$\\det(H(\\mathbf{k}) - E I) = 0$得到：\n$$(\\varepsilon - E)^2 - (-t f(\\mathbf{k}))(-t f^*(\\mathbf{k})) = 0$$\n$$(\\varepsilon - E)^2 - t^2 |f(\\mathbf{k})|^2 = 0$$\n$$\\varepsilon - E = \\pm t |f(\\mathbf{k})|$$\n这给出两个能带（$\\pi$带和$\\pi^*$带）：\n$$E_{\\pm}(\\mathbf{k}) = \\varepsilon \\pm t |f(\\mathbf{k})|$$\n哈密顿量的结构及其能谱揭示了一个关键特征：能量$E_{\\pm}(\\mathbf{k})$关于在位能$\\varepsilon$对称。这是晶格的二分性质（没有A-A或B-B最近邻）和在位能相等（$\\varepsilon_A = \\varepsilon_B$）的假设的直接结果。这个性质被称为电子-空穴对称性。\n\n**4. 能带填充与费米能**\n石墨烯的原胞包含两个碳原子。碳原子的电子排布是$[He] 2s^2 2p^2$。在石墨烯中，每个原子的三个价电子参与形成强的面内$sp^2$杂化$\\sigma$键。每个原子剩余的一个电子占据垂直于石墨烯平面的$2p_z$轨道。这些$p_z$电子形成了我们的紧束缚模型所描述的$\\pi$带。\n\n由于每个晶胞有两个碳原子，每个原子有一个$\\pi$电子，因此每个晶胞的$\\pi$电子数为$2$。\n\n紧束缚模型给出两个能带，$E_+(\\mathbf{k})$（导带）和$E_-(\\mathbf{k})$（价带）。考虑到自旋简并，每个能带每个晶胞可以容纳$2$个电子。对于每个晶胞需要放置的$2$个电子，在零温（$T=0$）下，它们将填满较低能带$E_-(\\mathbf{k})$中的所有可用态。较高的能带$E_+(\\mathbf{k})$将完全为空。这种情况被称为半填充。\n\n费米能$E_F$是$T=0$时最高占据态的能量。在这种情况下，它对应于已填满的价带顶部的能量。对于未掺杂的石墨烯，价带$E_-(\\mathbf{k})$刚好被填满，并在布里渊区的特定点与空的导带$E_+(\\mathbf{k})$接触。这些能带接触点，被称为狄拉克点，出现在能带之间的能隙消失的地方：\n$$E_+(\\mathbf{k}) - E_-(\\mathbf{k}) = 2t|f(\\mathbf{k})| = 0$$\n这要求$|f(\\mathbf{k})| = 0$。在这些狄拉克点$\\mathbf{k}=\\mathbf{K}$处，两个能带的能量是简并的：\n$$E_{\\pm}(\\mathbf{K}) = \\varepsilon \\pm t|f(\\mathbf{K})| = \\varepsilon \\pm 0 = \\varepsilon$$\n由于价带是满的，导带是空的，并且它们在能量$\\varepsilon$处接触，所以费米能必须恰好是这个值。\n因此，对于半填充的未掺杂石墨烯，$E_F = \\varepsilon$。\n\n所要求的两个结果是：\n1.  每个晶胞的$\\pi$电子数：$2$。\n2.  半填充时的费米能：$\\varepsilon$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 2  \\varepsilon \\end{pmatrix}}$$"
        },
        {
            "introduction": "虽然最简模型能够抓住材料物理性质的核心，但更精确的描述通常需要考虑更复杂的相互作用。本练习在前一个石墨烯模型的基础上，引入了次近邻跃迁项 。通过推导，你将亲身体验这一改进如何打破理想化的粒子-空穴对称性，并使模型能更真实地反映实验中观察到的能带结构。",
            "id": "3805405",
            "problem": "考虑一个由经验紧束缚(ETB)哈密顿量描述的单层石墨烯，其晶格为蜂窝状，具有两个子格，分别表示为$A$和$B$。设$t$为子格$A$和$B$之间的最近邻跃迁振幅，设$t'$为同一子格内的次近邻(NNN)跃迁振幅。假设不存在在位能，并忽略自旋。使用以下蜂窝晶格的几何规格：其布拉维晶格为三角形，原胞矢量为 $\\mathbf{a}_{1} = a_{0}\\left(\\tfrac{1}{2}, \\tfrac{\\sqrt{3}}{2}\\right)$ 和 $\\mathbf{a}_{2} = a_{0}\\left(\\tfrac{1}{2}, -\\tfrac{\\sqrt{3}}{2}\\right)$，其中$a_0$是其下层三角形布拉维晶格的晶格常数。从子格$A$上的一个格点到子格$B$的三个最近邻位移矢量可选择为 $\\boldsymbol{\\delta}_{1} = a\\left(0, 1\\right)$、$\\boldsymbol{\\delta}_{2} = a\\left(\\tfrac{\\sqrt{3}}{2}, -\\tfrac{1}{2}\\right)$ 和 $\\boldsymbol{\\delta}_{3} = a\\left(-\\tfrac{\\sqrt{3}}{2}, -\\tfrac{1}{2}\\right)$，其中$a = a_{0}/\\sqrt{3}$是最近邻键长。给定子格内的三个不等价次近邻位移矢量是布拉维矢量 $\\mathbf{a}_{1}$、$\\mathbf{a}_{2}$ 和 $\\mathbf{a}_{1}+\\mathbf{a}_{2}$。其中一个狄拉克点位于布里渊区中的 $\\mathbf{K} = \\left(\\tfrac{4\\pi}{3 a_{0}}, 0\\right)$。\n\n从包含最近邻和次近邻跃迁的实空间紧束缚哈密顿量出发，利用布洛赫定理得到$\\mathbf{k}$空间中的$2\\times 2$布洛赫哈密顿量。然后，通过在$\\mathbf{K}$点附近展开所得的能带能量，确定次近邻跃迁$t'$如何引起粒子-空穴不对称性并移动狄拉克点的能量。您的推导必须从实空间中的哈密顿量定义开始，通过傅里叶变换到$\\mathbf{k}$空间，并识别出由集合 $\\{\\boldsymbol{\\delta}_{j}\\}$ 和 $\\{\\mathbf{a}_{1}, \\mathbf{a}_{2}, \\mathbf{a}_{1}+\\mathbf{a}_{2}\\}$ 构建的相关结构因子。精确计算在$\\mathbf{K}$点的狄拉克点能量。\n\n仅报告狄拉克点能量$E_D$关于$t'$的最终解析表达式；不需要数值。将您的最终答案表示为仅含$t'$的符号闭合形式表达式。",
            "solution": "问题要求解一个由紧束缚模型描述的单层石墨烯中狄拉克点的能量，该模型同时包含最近邻(NN)跃迁$t$和次近邻(NNN)跃迁$t'$。出发点是实空间哈密顿量。\n\n紧束缚哈密顿量$H$可以写成最近邻项$H_{NN}$和次近邻项$H_{NNN}$之和：\n$$H = H_{NN} + H_{NNN}$$\n设$a_{\\mathbf{R}}^\\dagger$和$a_{\\mathbf{R}}$分别为子格$A$上布拉维晶格位置$\\mathbf{R}$处电子的产生和湮灭算符，而$b_{\\mathbf{R}'}^\\dagger$和$b_{\\mathbf{R}'}$为子格$B$的算符。蜂窝晶格具有双原子基矢。我们可以将子格$A$上的每个格点与一个布拉维晶格矢量$\\mathbf{R}$关联起来，而子格$B$上的相邻格点则相对于这些$A$格点有一定位移。\n\n最近邻跃迁发生在子格$A$和$B$之间。设一个$A$格点位于位置$\\mathbf{R}$。其在子格$B$上的三个最近邻格点位于位置$\\mathbf{R}+\\boldsymbol{\\delta}_j$（其中$j=1,2,3$）。$H_{NN}$项为：\n$$H_{NN} = -t \\sum_{\\mathbf{R}} \\sum_{j=1}^{3} \\left ( a_{\\mathbf{R}}^\\dagger b_{\\mathbf{R}+\\boldsymbol{\\delta}_j} + b_{\\mathbf{R}+\\boldsymbol{\\delta}_j}^\\dagger a_{\\mathbf{R}} \\right )$$\n\n次近邻跃迁发生在同一子格内部。一个位于$\\mathbf{R}$的格点的六个次近邻位于$\\mathbf{R} \\pm \\mathbf{v}_i$，其中问题指定了三个不等价的位移矢量为$\\mathbf{v}_1=\\mathbf{a}_1$、$\\mathbf{v}_2=\\mathbf{a}_2$和$\\mathbf{v}_3=\\mathbf{a}_1+\\mathbf{a}_2$。$H_{NNN}$项为：\n$$H_{NNN} = -t' \\sum_{\\mathbf{R}} \\sum_{i=1}^{3} \\left( a_{\\mathbf{R}}^\\dagger a_{\\mathbf{R}+\\mathbf{v}_i} + a_{\\mathbf{R}}^\\dagger a_{\\mathbf{R}-\\mathbf{v}_i} + b_{\\mathbf{R}}^\\dagger b_{\\mathbf{R}+\\mathbf{v}_i} + b_{\\mathbf{R}}^\\dagger b_{\\mathbf{R}-\\mathbf{v}_i} + h.c. \\right)$$\n其中$h.c.$表示厄米共轭。注意，求和遍历所有布拉维晶格格点$\\mathbf{R}$，并对每个格点，遍历其所有次近邻。\n\n我们使用布洛赫定理将哈密顿量变换到$\\mathbf{k}$空间。算符的傅里叶变换如下：\n$$a_{\\mathbf{R}} = \\frac{1}{\\sqrt{N}} \\sum_{\\mathbf{k}} e^{i\\mathbf{k}\\cdot\\mathbf{R}} a_{\\mathbf{k}}$$\n$$b_{\\mathbf{R}+\\boldsymbol{\\delta}_j} = \\frac{1}{\\sqrt{N}} \\sum_{\\mathbf{k}} e^{i\\mathbf{k}\\cdot(\\mathbf{R}+\\boldsymbol{\\delta}_j)} b_{\\mathbf{k}}$$\n其中$N$是晶胞的数量。\n\n在布洛赫态 $|A, \\mathbf{k}\\rangle$ 和 $|B, \\mathbf{k}\\rangle$ 的基底下，哈密顿量可以为每个$\\mathbf{k}$写成一个$2\\times 2$矩阵$H(\\mathbf{k})$：\n$$H(\\mathbf{k}) = \\begin{pmatrix} H_{AA}(\\mathbf{k}) & H_{AB}(\\mathbf{k}) \\\\ H_{BA}(\\mathbf{k}) & H_{BB}(\\mathbf{k}) \\end{pmatrix}$$\n矩阵元的计算如下：\n\n非对角元来自于$H_{NN}$：\n$$H_{AB}(\\mathbf{k}) = -t \\sum_{j=1}^{3} e^{i\\mathbf{k}\\cdot\\boldsymbol{\\delta}_j}$$\n我们定义几何结构因子$f(\\mathbf{k}) = \\sum_{j=1}^{3} e^{i\\mathbf{k}\\cdot\\boldsymbol{\\delta}_j}$。因此，$H_{AB}(\\mathbf{k}) = -t f(\\mathbf{k})$。由于哈密顿量是厄米的，$H_{BA}(\\mathbf{k}) = H_{AB}^*(\\mathbf{k}) = -t f^*(\\mathbf{k})$。\n\n对角元来自于$H_{NNN}$。从位于$\\mathbf{R}$的$A$格点跃迁到另一个位于$\\mathbf{R}+\\mathbf{v}_i$的$A$格点，贡献一个项$-t'e^{i\\mathbf{k}\\cdot\\mathbf{v}_i}$。对所有六个次近邻求和：\n$$H_{AA}(\\mathbf{k}) = -t' \\sum_{i=1}^{3} \\left( e^{i\\mathbf{k}\\cdot\\mathbf{v}_i} + e^{-i\\mathbf{k}\\cdot\\mathbf{v}_i} \\right) = -2t' \\sum_{i=1}^{3} \\cos(\\mathbf{k}\\cdot\\mathbf{v}_i)$$\n我们定义次近邻结构因子$g(\\mathbf{k}) = 2 \\sum_{i=1}^{3} \\cos(\\mathbf{k}\\cdot\\mathbf{v}_i)$。对于$\\mathbf{v}_1=\\mathbf{a}_1, \\mathbf{v}_2=\\mathbf{a}_2, \\mathbf{v}_3=\\mathbf{a}_1+\\mathbf{a}_2$，此式为：\n$$g(\\mathbf{k}) = 2\\cos(\\mathbf{k}\\cdot\\mathbf{a}_1) + 2\\cos(\\mathbf{k}\\cdot\\mathbf{a}_2) + 2\\cos(\\mathbf{k}\\cdot(\\mathbf{a}_1+\\mathbf{a}_2))$$\n因此，$H_{AA}(\\mathbf{k}) = -t' g(\\mathbf{k})$。由于晶格的对称性，子格$B$的次近邻跃迁项是相同的，所以$H_{BB}(\\mathbf{k}) = H_{AA}(\\mathbf{k})$。\n\n完整的布洛赫哈密顿量为：\n$$H(\\mathbf{k}) = \\begin{pmatrix} -t'g(\\mathbf{k}) & -t f(\\mathbf{k}) \\\\ -t f^*(\\mathbf{k}) & -t'g(\\mathbf{k}) \\end{pmatrix}$$\n该哈密顿量的本征值$E(\\mathbf{k})$给出了能带：\n$$( -t'g(\\mathbf{k}) - E )^2 - |-t f(\\mathbf{k})|^2 = 0$$\n$$E(\\mathbf{k}) = -t'g(\\mathbf{k}) \\pm t|f(\\mathbf{k})|$$\n这给出了两个能带，$E_+(\\mathbf{k})$（导带）和$E_-(\\mathbf{k})$（价带）。\n\n与$t'$成正比的项破坏了粒子-空穴对称性。如果$t'=0$，能谱$E(\\mathbf{k}) = \\pm t|f(\\mathbf{k})|$关于$E=0$是对称的。对于$t' \\neq 0$，能谱被一个依赖于$\\mathbf{k}$的量$-t'g(\\mathbf{k})$所移动。\n\n狄拉克点是两个能带接触处的$\\mathbf{k}$矢量，这发生在能隙闭合时，即$t|f(\\mathbf{k})| = 0$。这要求$f(\\mathbf{k})=0$。因此，在狄拉克点$\\mathbf{K}$处的能量是：\n$$E_D = E(\\mathbf{K}) = -t'g(\\mathbf{K})$$\n问题要求在特定狄拉克点$\\mathbf{K} = \\left(\\tfrac{4\\pi}{3 a_{0}}, 0\\right)$处的能量。我们需要计算$g(\\mathbf{K})$。首先，我们使用给定的矢量计算所需的点积：\n$\\mathbf{a}_{1} = a_{0}\\left(\\tfrac{1}{2}, \\tfrac{\\sqrt{3}}{2}\\right)$ 和 $\\mathbf{a}_{2} = a_{0}\\left(\\tfrac{1}{2}, -\\tfrac{\\sqrt{3}}{2}\\right)$。\n\n1.  $\\mathbf{K} \\cdot \\mathbf{a}_1 = \\left(\\frac{4\\pi}{3 a_{0}}\\right) \\left(a_0 \\frac{1}{2}\\right) + (0)\\left(a_0 \\frac{\\sqrt{3}}{2}\\right) = \\frac{2\\pi}{3}$\n2.  $\\mathbf{K} \\cdot \\mathbf{a}_2 = \\left(\\frac{4\\pi}{3 a_{0}}\\right) \\left(a_0 \\frac{1}{2}\\right) + (0)\\left(-a_0 \\frac{\\sqrt{3}}{2}\\right) = \\frac{2\\pi}{3}$\n3.  $\\mathbf{a}_1 + \\mathbf{a}_2 = a_0(1, 0)$。所以，$\\mathbf{K} \\cdot (\\mathbf{a}_1 + \\mathbf{a}_2) = \\left(\\frac{4\\pi}{3 a_{0}}\\right) (a_0) = \\frac{4\\pi}{3}$\n\n现在我们将这些结果代入$g(\\mathbf{K})$的表达式中：\n$$g(\\mathbf{K}) = 2\\cos\\left(\\frac{2\\pi}{3}\\right) + 2\\cos\\left(\\frac{2\\pi}{3}\\right) + 2\\cos\\left(\\frac{4\\pi}{3}\\right)$$\n使用 $\\cos(2\\pi/3) = -1/2$ 和 $\\cos(4\\pi/3) = -1/2$：\n$$g(\\mathbf{K}) = 2\\left(-\\frac{1}{2}\\right) + 2\\left(-\\frac{1}{2}\\right) + 2\\left(-\\frac{1}{2}\\right) = -1 - 1 - 1 = -3$$\n最后，狄拉克点的能量是：\n$$E_D = -t' g(\\mathbf{K}) = -t'(-3) = 3t'$$\n次近邻跃迁将狄拉克点的能量从$E=0$（对于$t'=0$）移动到$E_D = 3t'$。这种移动破坏了低能谱的电子-空穴对称性。在$\\mathbf{K}$点附近展开能带可以证实这一点。设$\\mathbf{k} = \\mathbf{K}+\\mathbf{q}$，可以证明$f(\\mathbf{K}+\\mathbf{q})$是$\\mathbf{q}$的线性函数，并且$g(\\mathbf{K}+\\mathbf{q}) \\approx g(\\mathbf{K}) = -3$（在$\\mathbf{q}$的一阶近似下）。这导致了以新能量$E_D=3t'$为中心的线性色散关系。\n\n最终要求的量是这个狄拉克点能量的精确表达式。",
            "answer": "$$\n\\boxed{3t'}\n$$"
        },
        {
            "introduction": "从紧束缚计算中获得能带色散关系 $E(\\mathbf{k})$ 只是第一步，计算可观测量（如态密度 (DOS)）同样至关重要。本练习聚焦于一个核心的计算挑战：如何从分布在布里渊区中的离散能量点精确地计算出连续的态密度函数 。你将通过编程实践，比较两种不同数值方法的收敛性与优劣，这是计算材料科学中的一项基本技能。",
            "id": "3805383",
            "problem": "要求您为三维简单立方晶格上的单带经验紧束缚 (Empirical Tight-Binding, ETB) 模型实现态密度 (Density of States, DOS) 的数值计算。目标是比较两种数值估计器（基本的直方图分箱和自适应展宽方法）的收敛特性。其理论基础是每个格点一个轨道且仅考虑最近邻跃迁的简单立方晶格的布洛赫色散关系。色散关系由 $E(\\mathbf{k}) = \\varepsilon + 2t\\left[\\cos\\left(k_x a\\right) + \\cos\\left(k_y a\\right) + \\cos\\left(k_z a\\right)\\right]$ 给出，其中 $a$ 是晶格常数，$\\varepsilon$ 是在位能， $t$ 是跃迁参数。倒易空间域为第一布里渊区 (Brillouin zone, BZ)，定义为 $k_x, k_y, k_z \\in [-\\pi/a,\\pi/a]$。所有三角函数的参数必须以弧度计算。任务是从第一性原理出发推导 DOS 估计器，并实现它们的数值评估。\n\n态密度 (DOS)，记为 $D(E)$，定义为能量空间中单位晶胞、单位能量内的能量本征值密度。对于在均匀 $\\mathbf{k}$ 空间网格上采样的单能带，若每个轴上有 $N$ 个点，总点数为 $N_k = N^3$，则其定义为 $D(E) = \\frac{1}{N_k}\\sum_{\\mathbf{k}} \\delta\\!\\left(E - E(\\mathbf{k})\\right)$，其中 $\\delta(\\cdot)$ 是狄拉克 $\\delta$ 函数。目标是使用两种不同的数值方法来近似此定义：\n- 一种简单的直方图估计器，它将能量 $E(\\mathbf{k})$ 划分到能量范围内的 $N_b$ 个均匀区间中，并通过区间宽度进行归一化，以获得 $D(E)$ 的分段常数近似。\n- 一种自适应高斯展宽估计器，它用归一化的高斯函数 $G_{\\sigma(\\mathbf{k})}(\\cdot)$ 替代狄拉克 $\\delta$ 函数 $\\delta(\\cdot)$。高斯函数的宽度 $\\sigma(\\mathbf{k})$ 依赖于 $\\mathbf{k}$，其选择旨在反映局域能带色散。使用 $\\sigma(\\mathbf{k}) = \\alpha \\|\\nabla_{\\mathbf{k}} E(\\mathbf{k})\\| \\Delta k$，其中 $\\alpha$ 是一个无量纲的调节参数，$\\|\\nabla_{\\mathbf{k}} E(\\mathbf{k})\\|$ 是能量关于 $\\mathbf{k}$ 的梯度范数，$\\Delta k = 2\\pi/(a N)$ 是倒易空间中的均匀网格间距。为避免在驻点处出现除零错误，需设置一个严格为正的下限 $\\sigma_{\\min}$。高斯函数必须归一化为 $G_{\\sigma}(x) = \\frac{1}{\\sqrt{2\\pi}\\sigma}\\exp\\!\\left(-\\frac{x^2}{2\\sigma^2}\\right)$，以使 $\\int_{-\\infty}^{\\infty} G_{\\sigma}(x)\\,\\mathrm{d}x = 1$。\n\n为评估收敛性，需定义一个参考 DOS $D_{\\mathrm{ref}}(E)$。该参考 DOS 在一个更精细的 $\\mathbf{k}$ 空间网格（每轴尺寸为 $N_{\\mathrm{ref}}$）和大量能量区间（$N_{b,\\mathrm{ref}}$）上使用高分辨率直方图计算得出。对于任何测试用例，在跨越 $[E_{\\min}, E_{\\max}]$ 的 $N_b$ 个区间中心的均匀能量网格上计算 DOS，其中 $E_{\\min} = \\varepsilon - 6|t|$ 且 $E_{\\max} = \\varepsilon + 6|t|$。通过积分平方误差 (integrated squared error, ISE) 将每种方法与参考值进行比较，\n$$\n\\mathrm{ISE} = \\sum_{i=1}^{N_b} \\left[D_{\\mathrm{method}}(E_i) - D_{\\mathrm{ref}}(E_i)\\right]^2 \\,\\Delta E,\n$$\n其中 $E_i$ 是区间中心，$\\Delta E = (E_{\\max} - E_{\\min})/N_b$。ISE 必须以每个晶胞中态的平方每电子伏特 ($\\mathrm{states}^2/\\mathrm{eV}$) 为单位报告。能量单位必须是电子伏特 (eV)，晶格常数单位是埃 (Å)，角度单位是弧度。\n\n实现以下内容：\n1. 一个函数，用于在第一布里渊区上生成每轴 $N$ 个点的 $\\mathbf{k}$ 空间网格，使用均匀网格间距 $\\Delta k = 2\\pi/(a N)$ 和采样点 $k_\\mu = -\\pi/a + i\\Delta k$，其中 $i = 0,1,\\dots,N-1$ 且 $\\mu \\in \\{x,y,z\\}$。\n2. 一个函数，用于计算网格上每个 $\\mathbf{k}$ 点的 $E(\\mathbf{k})$ 和 $\\|\\nabla_{\\mathbf{k}} E(\\mathbf{k})\\|$。\n3. 一个基于直方图的 DOS 估计器，用于在区间中心 $E_i$ 处生成 $D_{\\mathrm{hist}}(E_i)$，其归一化应满足 $\\sum_i D_{\\mathrm{hist}}(E_i)\\Delta E \\approx 1$。\n4. 一个自适应展宽 DOS 估计器，用于在相同的能量区间中心生成 $D_{\\mathrm{smear}}(E_i)$，使用 $\\sigma(\\mathbf{k}) = \\alpha \\|\\nabla_{\\mathbf{k}} E(\\mathbf{k})\\| \\Delta k$ 并设置一个正下限 $\\sigma_{\\min}$。\n5. 一个高分辨率的参考 DOS $D_{\\mathrm{ref}}(E)$，通过在具有 $N_{\\mathrm{ref}}$ 和 $N_{b,\\mathrm{ref}}$（选择足够大的值以作为基准真相）的更精细网格上使用直方图计算，并插值到每个测试用例所用的 $E_i$ 上。\n\n所有测试用例均使用固定的物理参数：$a = 3.0\\,\\mathrm{\\AA}$，$\\varepsilon = 0.0\\,\\mathrm{eV}$，以及 $t = -1.0\\,\\mathrm{eV}$。在所有情况下，均使用 $\\sigma_{\\min} = 10^{-5}\\,\\mathrm{eV}$。所有三角函数求值必须使用弧度。\n\n提供一个包含以下四个参数集的测试套件，旨在探测不同的收敛区域：\n- 情况 A (一般解析情况): $N = 16$, $N_b = 200$, $\\alpha = 0.6$。\n- 情况 B (粗糙 $\\mathbf{k}$ 网格边界): $N = 6$, $N_b = 200$, $\\alpha = 0.2$。\n- 情况 C (少量能量区间边缘情况): $N = 22$, $N_b = 60$, $\\alpha = 1.0$。\n- 情况 D (大量能量区间敏感度): $N = 14$, $N_b = 600$, $\\alpha = 0.5$。\n\n对于参考计算，使用 $N_{\\mathrm{ref}} = 46$ 和 $N_{b,\\mathrm{ref}} = 1200$。\n\n您的程序应生成单行输出，其中包含一个逗号分隔的列表，该列表用方括号括起，结果按测试用例 A 到 D 的顺序排列。每个测试用例的结果本身必须是一个包含两个浮点数的列表 $[\\mathrm{ISE}_{\\mathrm{hist}}, \\mathrm{ISE}_{\\mathrm{smear}}]$，四舍五入到六位小数。例如，输出行必须具有以下形式\n$[\\,[\\mathrm{ISE}_{\\mathrm{hist},A},\\mathrm{ISE}_{\\mathrm{smear},A}],\\,[\\mathrm{ISE}_{\\mathrm{hist},B},\\mathrm{ISE}_{\\mathrm{smear},B}],\\,[\\mathrm{ISE}_{\\mathrm{hist},C},\\mathrm{ISE}_{\\mathrm{smear},C}],\\,[\\mathrm{ISE}_{\\mathrm{hist},D},\\mathrm{ISE}_{\\mathrm{smear},D}]\\,]$。\n\n所有能量必须以电子伏特 (eV) 报告。积分平方误差必须以每个晶胞中 $\\mathrm{states}^2/\\mathrm{eV}$ 为单位报告。所有角度必须是弧度。",
            "solution": "用户要求实现并比较用于简单立方晶格上单带紧束缚模型的两种态密度 (DOS) 数值估计器。\n\n### 步骤 1：问题验证\n\n**提取的已知条件：**\n- **模型：** 三维简单立方晶格上的单带经验紧束缚 (ETB)。\n- **色散关系：** $E(\\mathbf{k}) = \\varepsilon + 2t\\left[\\cos\\left(k_x a\\right) + \\cos\\left(k_y a\\right) + \\cos\\left(k_z a\\right)\\right]$。\n- **物理参数：** 晶格常数 $a = 3.0\\,\\mathrm{\\AA}$，在位能 $\\varepsilon = 0.0\\,\\mathrm{eV}$，跃迁参数 $t = -1.0\\,\\mathrm{eV}$。\n- **布里渊区：** $k_x, k_y, k_z \\in [-\\pi/a, \\pi/a]$。\n- **k 空间网格：** 均匀网格，每轴 $N$ 个点，间距 $\\Delta k = 2\\pi/(a N)$，点坐标为 $k_\\mu = -\\pi/a + i\\Delta k$，其中 $i \\in \\{0, \\dots, N-1\\}$。\n- **能量范围：** $[E_{\\min}, E_{\\max}]$，其中 $E_{\\min} = \\varepsilon - 6|t|$ 且 $E_{\\max} = \\varepsilon + 6|t|$。\n- **离散 k 网格的 DOS 定义：** $D(E) = \\frac{1}{N_k}\\sum_{\\mathbf{k}} \\delta(E - E(\\mathbf{k}))$，其中 $N_k=N^3$。\n- **直方图 DOS 估计器：** 在 $N_b$ 个区间上的分段常数近似，通过区间宽度 $\\Delta E = (E_{\\max} - E_{\\min})/N_b$ 进行归一化。\n- **自适应展宽 DOS 估计器：** 用归一化的高斯函数 $G_{\\sigma}(x) = \\frac{1}{\\sqrt{2\\pi}\\sigma}\\exp(-x^2/2\\sigma^2)$ 替换 $\\delta(x)$。\n- **自适应展宽宽度：** $\\sigma(\\mathbf{k}) = \\alpha \\|\\nabla_{\\mathbf{k}} E(\\mathbf{k})\\| \\Delta k$，具有下限 $\\sigma_{\\min} = 10^{-5}\\,\\mathrm{eV}$。\n- **误差度量：** 积分平方误差，$\\mathrm{ISE} = \\sum_{i=1}^{N_b} \\left[D_{\\mathrm{method}}(E_i) - D_{\\mathrm{ref}}(E_i)\\right]^2 \\,\\Delta E$。\n- **参考 DOS：** 使用 $N_{\\mathrm{ref}} = 46$ 和 $N_{b,\\mathrm{ref}} = 1200$ 的直方图方法，并插值到评估能量网格上。\n- **测试用例 (N, Nb, alpha):**\n    - A: $(16, 200, 0.6)$\n    - B: $(6, 200, 0.2)$\n    - C: $(22, 60, 1.0)$\n    - D: $(14, 600, 0.5)$\n- **单位与约定：** 能量单位为 eV，长度单位为 Å，角度单位为弧度。输出的 ISE 单位为 $\\mathrm{states}^2/\\mathrm{eV}$/cell，四舍五入到六位小数。\n\n**验证结论：**\n此问题是**有效的**。\n1.  **科学上合理：** 它基于标准的紧束缚形式，这是固态物理学中的一个基本工具。DOS 的定义以及数值估计方法（直方图、高斯展宽）都是标准的，并且描述正确。\n2.  **定义明确：** 所有必要的参数、方程和算法步骤都已明确提供，可得出一个唯一的、可计算的结果。\n3.  **完整且一致：** 问题是自洽的。没有缺失的参数或矛盾的陈述。能量范围被正确指定以包含整个能带。\n4.  **可行性：** 计算负载，即使是参考计算（$N_{\\mathrm{ref}}=46$，产生 $46^3 \\approx 97,000$ 个 k 点），也完全在标准计算机的能力范围之内。\n\n### 步骤 2：解法推导与算法设计\n\n解决方案将根据问题陈述中指定的定义和要求来构建。\n\n**1. 初步数学推导**\n\n- **能带宽度：** 表达式 $\\cos(k_x a) + \\cos(k_y a) + \\cos(k_z a)$ 的范围从最小值 $-3$ 到最大值 $3$。当 $t = -1.0\\,\\mathrm{eV}$ 和 $\\varepsilon = 0.0\\,\\mathrm{eV}$ 时，能量 $E(\\mathbf{k})$ 的范围从 $E_{\\max} = 0.0 + 2(-1.0)(-3) = +6.0\\,\\mathrm{eV}$ 到 $E_{\\min} = 0.0 + 2(-1.0)(3) = -6.0\\,\\mathrm{eV}$。指定的范围 $[\\varepsilon - 6|t|, \\varepsilon + 6|t|]$ 正确地覆盖了 $[-6.0, 6.0]\\,\\mathrm{eV}$。\n\n- **色散梯度：** 自适应展宽宽度需要能量色散的梯度 $\\nabla_{\\mathbf{k}} E(\\mathbf{k})$。关于 $k_x$ 的偏导数为：\n$$\n\\frac{\\partial E}{\\partial k_x} = \\frac{\\partial}{\\partial k_x} \\left( \\varepsilon + 2t\\left[\\cos\\left(k_x a\\right) + \\cos\\left(k_y a\\right) + \\cos\\left(k_z a\\right)\\right] \\right) = -2ta \\sin(k_x a)\n$$\n梯度的平方范数为：\n$$\n\\|\\nabla_{\\mathbf{k}} E(\\mathbf{k})\\|^2 = \\left(\\frac{\\partial E}{\\partial k_x}\\right)^2 + \\left(\\frac{\\partial E}{\\partial k_y}\\right)^2 + \\left(\\frac{\\partial E}{\\partial k_z}\\right)^2 = (-2ta)^2 \\left( \\sin^2(k_x a) + \\sin^2(k_y a) + \\sin^2(k_z a) \\right)\n$$\n因此，范数为：\n$$\n\\|\\nabla_{\\mathbf{k}} E(\\mathbf{k})\\| = |2ta| \\sqrt{\\sin^2(k_x a) + \\sin^2(k_y a) + \\sin^2(k_z a)}\n$$\n此表达式将用于计算自适应展宽参数 $\\sigma(\\mathbf{k})$。\n\n**2. 算法实现策略**\n\n任务的核心是实现计算每个测试用例的 DOS 和 ISE 所需的函数。\n\n- **参考 DOS 计算：** 一个关键的优化是只计算一次高分辨率的参考 DOS，并在所有测试用例中重复使用它。这包括：\n    1.  生成一个精细的 k 空间网格，每轴有 $N_{\\mathrm{ref}} = 46$ 个点。总共得到 $N_{\\mathrm{ref}}^3$ 个点。\n    2.  计算这些点中每一个点的能量 $E(\\mathbf{k})$。\n    3.  将这些能量分箱到一个具有 $N_{b,\\mathrm{ref}} = 1200$ 个区间的直方图中，能量范围为 $[-6, 6]\\,\\mathrm{eV}$。\n    4.  通过 k 点总数 ($N_{\\mathrm{ref}}^3$) 和能量区间宽度 ($\\Delta E_{\\mathrm{ref}}$) 对直方图计数进行归一化，以获得 $D_{\\mathrm{ref}}(E_i)$。\n    5.  生成的 `(能量, DOS)` 对将作为参考数据。\n\n- **测试用例评估循环：** 对于指定的四个测试用例中的每一个：\n    1.  **网格生成：** 根据用例参数 ($N$ 和 $N_b$) 生成 k 空间网格和能量评估网格。\n    2.  **能量与梯度计算：** 对于 k 网格上的每个点，计算能量 $E(\\mathbf{k})$ 及其梯度的范数 $\\|\\nabla_{\\mathbf{k}} E(\\mathbf{k})\\|$。\n    3.  **直方图 DOS：** 计算所有 k 点的能量，并使用 `numpy.histogram` 对它们进行分箱。对得到的计数进行归一化以获得 $D_{\\mathrm{hist}}(E)$。\n    4.  **自适应展宽 DOS：**\n        a. 对每个 k 点，计算展宽宽度 $\\sigma(\\mathbf{k}) = \\max(\\sigma_{\\min}, \\alpha \\|\\nabla_{\\mathbf{k}} E(\\mathbf{k})\\| \\Delta k)$。\n        b. 对于输出能量网格上的每个点 $E_i$，通过对所有 k 点的贡献求和来计算 DOS：$D_{\\mathrm{smear}}(E_i) = \\frac{1}{N_k} \\sum_{\\mathbf{k}} G_{\\sigma(\\mathbf{k})}(E_i - E(\\mathbf{k}))$。这可以通过使用 NumPy 的广播功能高效实现，以避免嵌套的 Python 循环。将计算一个 $(N_b \\times N_k)$ 的高斯值矩阵，然后沿 $N_k$ 轴求和。\n    5.  **误差计算：**\n        a. 使用 `numpy.interp` 将预计算的参考 DOS 线性插值到当前测试用例的能量网格上。这提供了与 $D_{\\mathrm{hist}}$ 和 $D_{\\mathrm{smear}}$ 相同能量点上的 $D_{\\mathrm{ref}}(E_i)$。\n        b. 使用提供的公式为两种方法计算 ISE。\n    6.  **结果存储：** 存储当前测试用例的一对计算出的 ISE 值，四舍五入到六位小数。\n\n- **最终输出：** 处理完所有测试用例后，将收集到的结果格式化为问题输出格式指定的单个字符串（列表的列表），并打印到标准输出。\n\n这个分步过程确保满足所有要求，计算正确执行，且实现是高效的。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and compares the Integrated Squared Error (ISE) for two different\n    Density of States (DOS) estimators (histogram and adaptive Gaussian smearing)\n    for a single-band tight-binding model on a simple cubic lattice.\n    \"\"\"\n    \n    # --- Fixed Physical and Reference Parameters ---\n    A_LATTICE = 3.0       # Lattice constant in Angstrom\n    EPSILON = 0.0         # On-site energy in eV\n    T_HOP = -1.0          # Hopping parameter in eV\n    SIGMA_MIN = 1e-5      # Minimum smearing width in eV\n    N_REF = 46            # k-mesh size for reference calculation\n    N_B_REF = 1200        # Number of energy bins for reference calculation\n\n    # Define the test cases from the problem statement\n    test_cases = [\n        # (N, N_b, alpha)\n        (16, 200, 0.6),  # Case A\n        (6, 200, 0.2),   # Case B\n        (22, 60, 1.0),   # Case C\n        (14, 600, 0.5),  # Case D\n    ]\n\n    # --- Pre-compute High-Resolution Reference DOS ---\n    \n    # Energy band limits are determined by the dispersion relation\n    e_min = EPSILON + 2 * T_HOP * 3\n    e_max = EPSILON + 2 * T_HOP * (-3)\n    \n    # Generate reference k-grid\n    delta_k_ref = 2 * np.pi / (A_LATTICE * N_REF)\n    k_vals_ref = -np.pi / A_LATTICE + np.arange(N_REF) * delta_k_ref\n    kx_ref, ky_ref, kz_ref = np.meshgrid(k_vals_ref, k_vals_ref, k_vals_ref, indexing='ij')\n\n    # Calculate energies on reference grid\n    cos_sum_ref = np.cos(kx_ref * A_LATTICE) + np.cos(ky_ref * A_LATTICE) + np.cos(kz_ref * A_LATTICE)\n    energies_ref_flat = (EPSILON + 2 * T_HOP * cos_sum_ref).flatten()\n    \n    # Define reference energy grid\n    energy_bins_ref = np.linspace(e_min, e_max, N_B_REF + 1)\n    delta_e_ref = (e_max - e_min) / N_B_REF\n    \n    # Compute reference DOS using histogram method\n    dos_ref_counts, _ = np.histogram(energies_ref_flat, bins=energy_bins_ref)\n    dos_ref_values = dos_ref_counts / (N_REF**3 * delta_e_ref)\n    energy_centers_ref = (energy_bins_ref[:-1] + energy_bins_ref[1:]) / 2\n\n    # --- Process Each Test Case ---\n    all_results = []\n    for N, N_b, alpha in test_cases:\n        N_k = N**3\n        \n        # --- Setup for Current Test Case ---\n        delta_k = 2 * np.pi / (A_LATTICE * N)\n        k_vals = -np.pi / A_LATTICE + np.arange(N) * delta_k\n        kx, ky, kz = np.meshgrid(k_vals, k_vals, k_vals, indexing='ij')\n\n        # Energy grid for test case evaluation\n        delta_e = (e_max - e_min) / N_b\n        energy_bins = np.linspace(e_min, e_max, N_b + 1)\n        energy_centers = (energy_bins[:-1] + energy_bins[1:]) / 2\n\n        # --- Calculate Energies and Gradients on Test k-mesh ---\n        cos_sum = np.cos(kx * A_LATTICE) + np.cos(ky * A_LATTICE) + np.cos(kz * A_LATTICE)\n        energies_flat = (EPSILON + 2 * T_HOP * cos_sum).flatten()\n\n        sin_sq_sum = np.sin(kx * A_LATTICE)**2 + np.sin(ky * A_LATTICE)**2 + np.sin(kz * A_LATTICE)**2\n        grad_norm_flat = (abs(2 * T_HOP * A_LATTICE) * np.sqrt(sin_sq_sum)).flatten()\n\n        # --- Method 1: Histogram DOS ---\n        dos_hist_counts, _ = np.histogram(energies_flat, bins=energy_bins)\n        dos_hist = dos_hist_counts / (N_k * delta_e)\n\n        # --- Method 2: Adaptive Smearing DOS ---\n        sigma_k = alpha * grad_norm_flat * delta_k\n        sigma_k = np.maximum(sigma_k, SIGMA_MIN)\n\n        # Vectorized calculation of smearing DOS to improve performance\n        # Shapes: energy_centers (N_b,), energies_flat (N_k,), sigma_k (N_k,)\n        diff_matrix = energy_centers[:, np.newaxis] - energies_flat[np.newaxis, :]  # Shape (N_b, N_k)\n        sigma_k_bcast = sigma_k[np.newaxis, :] # Shape (1, N_k)\n        \n        prefactor = 1.0 / (np.sqrt(2 * np.pi) * sigma_k_bcast)\n        exponent = -0.5 * (diff_matrix / sigma_k_bcast)**2\n        \n        gaussians_matrix = prefactor * np.exp(exponent)\n        dos_smear = np.sum(gaussians_matrix, axis=1) / N_k\n\n        # --- Compare with Reference and Calculate ISE ---\n        # Interpolate reference DOS onto the test case's energy grid\n        dos_ref_interp = np.interp(energy_centers, energy_centers_ref, dos_ref_values)\n\n        # Calculate Integrated Squared Error (ISE) for both methods\n        ise_hist = np.sum((dos_hist - dos_ref_interp)**2) * delta_e\n        ise_smear = np.sum((dos_smear - dos_ref_interp)**2) * delta_e\n        \n        # Append rounded results for the current case\n        all_results.append([round(ise_hist, 6), round(ise_smear, 6)])\n\n    # Format and print the final output as a single-line string\n    print(f\"[{','.join(map(str, all_results)).replace(' ', '')}]\")\n\nsolve()\n```"
        }
    ]
}