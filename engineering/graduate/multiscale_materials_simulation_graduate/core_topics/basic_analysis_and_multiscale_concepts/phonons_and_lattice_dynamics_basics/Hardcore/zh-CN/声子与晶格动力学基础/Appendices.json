{
    "hands_on_practices": [
        {
            "introduction": "本练习将深入研究一维双原子链模型，这是理解含有多个原子的原胞晶体中晶格动力学的基础。通过从第一性原理推导色散关系，你将揭示声学和光学声子支的起源及其截然不同的物理特性。这项实践对于建立集体原子运动如何产生不同类型振动模式的直觉至关重要。",
            "id": "3832848",
            "problem": "考虑一个无限长的一维晶体，其由每个原胞包含两个原子的重复基元构成，原子质量分别为 $m_1$ 和 $m_2$，晶格常数为 $a$。相邻原子通过力常数为 $K$ 的相同谐振子弹簧相互作用，且只存在最近邻相互作用。设在晶胞标号为 $n$ 的原胞中，质量为 $m_1$ 和 $m_2$ 的两个子晶格偏离平衡位置的位移分别为 $u_n$ 和 $v_n$。假设振动为小振幅振动，从而胡克定律适用且线性叠加原理有效。利用牛顿第二定律和与分立平移对称性一致的平面波拟设，推导晶格动力学方程，求出色散关系 $\\omega(q)$ 的两个分支，并确定声学支和光学支频率在 $q \\to 0$ 时的极限。\n\n此外，请确定在 $q \\to 0$ 极限下的相应本征矢量，并从第一性原理出发，解释两个子晶格同相运动与反相运动的物理解释，包括总动量和质心运动如何体现在声学支中，以及内部相对运动如何体现在光学支中。\n\n你的最终输出必须是 $\\lim_{q \\to 0} \\omega_{\\text{ac}}(q)$ 和 $\\lim_{q \\to 0} \\omega_{\\text{op}}(q)$ 的精确闭式解析表达式，用 $m_1$、$m_2$ 和 $K$ 表示。将最终结果表示为一个行矩阵，其元素分别为 $\\lim_{q \\to 0} \\omega_{\\text{ac}}(q)$ 和 $\\lim_{q \\to 0} \\omega_{\\text{op}}(q)$。请提供精确表达式；最终表达式中不包含单位。",
            "solution": "问题陈述已经过严格验证，被认为是有效的。这是一个适定、有科学依据的问题，是晶格动力学研究的核心，没有任何模糊、矛盾或事实错误。\n\n我们考虑一个具有双原子基元的无限长一维晶体。设原子质量为 $m_1$ 和 $m_2$。原胞的长度为 $a$。最简单的排列方式是交替质量的线性链。设第 $n$ 个原胞中质量为 $m_1$ 的原子的平衡位置为 $x_{n,1}^{(0)} = na$，质量为 $m_2$ 的原子的平衡位置为 $x_{n,2}^{(0)} = na + a/2$。任意两个相邻原子之间的距离为 $a/2$。原子通过一个由弹簧常数 $K$ 表征的谐振势与其最近邻相互作用。设第 $n$ 个晶胞中质量为 $m_1$ 和 $m_2$ 的原子的纵向位移分别为 $u_n$ 和 $v_n$。\n\n我们对第 $n$ 个晶胞中的每个质量应用牛顿第二定律。\n位于 $na+u_n$ 的质量为 $m_1$ 的原子，与位于同一晶胞 $na+a/2+v_n$ 的质量为 $m_2$ 的原子以及位于前一个晶胞 $(n-1)$ 中 $(n-1)a+a/2+v_{n-1}$ 的质量为 $m_2$ 的原子耦合。质量 $m_1$ 的运动方程为：\n$$m_1 \\frac{d^2 u_n}{dt^2} = F_{n,1} = K[(v_n-u_n)] + K[(v_{n-1}-u_n)]$$\n$$m_1 \\ddot{u}_n = K(v_n + v_{n-1} - 2u_n)$$\n\n位于 $na+a/2+v_n$ 的质量为 $m_2$ 的原子，与位于下一个晶胞 $(n+1)$ 中 $(n+1)a+u_{n+1}$ 的质量为 $m_1$ 的原子以及位于同一晶胞 $na+u_n$ 的质量为 $m_1$ 的原子耦合。质量 $m_2$ 的运动方程为：\n$$m_2 \\frac{d^2 v_n}{dt^2} = F_{n,2} = K[(u_{n+1}-v_n)] + K[(u_n-v_n)]$$\n$$m_2 \\ddot{v}_n = K(u_{n+1} + u_n - 2v_n)$$\n\n我们寻求与晶格的分立平移对称性一致的平面波解。对于波矢为 $q$、角频率为 $\\omega$ 的波，位移可以写成：\n$$u_n(t) = u \\exp[i(qna - \\omega t)]$$\n$$v_n(t) = v \\exp[i(qna - \\omega t)]$$\n这里，$u$ 和 $v$ 是基元中两个原子的复振幅。将这些代入运动方程：\n对于 $m_1$：\n$$-m_1 \\omega^2 u \\exp[i(qna - \\omega t)] = K(v \\exp[i(qna - \\omega t)] + v \\exp[i(q(n-1)a - \\omega t)] - 2u \\exp[i(qna - \\omega t)])$$\n两边同除以 $\\exp[i(qna - \\omega t)]$:\n$$-m_1 \\omega^2 u = K(v + v e^{-iqa} - 2u)$$\n$$(2K - m_1 \\omega^2)u - K(1 + e^{-iqa})v = 0$$\n\n对于 $m_2$：\n$$-m_2 \\omega^2 v \\exp[i(qna - \\omega t)] = K(u \\exp[i(q(n+1)a - \\omega t)] + u \\exp[i(qna - \\omega t)] - 2v \\exp[i(qna - \\omega t)])$$\n两边同除以 $\\exp[i(qna - \\omega t)]$:\n$$-m_2 \\omega^2 v = K(u e^{iqa} + u - 2v)$$\n$$-K(1 + e^{iqa})u + (2K - m_2 \\omega^2)v = 0$$\n\n这两个关于振幅 $u$ 和 $v$ 的齐次线性方程组可以写成矩阵形式：\n$$\n\\begin{pmatrix}\n2K - m_1 \\omega^2   -K(1 + e^{-iqa}) \\\\\n-K(1 + e^{iqa})   2K - m_2 \\omega^2\n\\end{pmatrix}\n\\begin{pmatrix}\nu \\\\\nv\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\\n0\n\\end{pmatrix}\n$$\n为使方程有非平凡解，系数矩阵（即动力学矩阵）的行列式必须为零。这就给出了色散关系 $\\omega(q)$ 的久期方程：\n$$(2K - m_1 \\omega^2)(2K - m_2 \\omega^2) - K^2(1 + e^{-iqa})(1 + e^{iqa}) = 0$$\n乘积项 $(1 + e^{-iqa})(1 + e^{iqa}) = |1+e^{iqa}|^2 = (1+\\cos(qa))^2 + \\sin^2(qa) = 2+2\\cos(qa) = 4\\cos^2(qa/2)$。\n久期方程变为：\n$$(2K - m_1 \\omega^2)(2K - m_2 \\omega^2) - 4K^2\\cos^2(qa/2) = 0$$\n$$m_1 m_2 \\omega^4 - 2K(m_1+m_2)\\omega^2 + 4K^2 - 4K^2\\cos^2(qa/2) = 0$$\n利用恒等式 $1 - \\cos^2(\\theta) = \\sin^2(\\theta)$:\n$$m_1 m_2 \\omega^4 - 2K(m_1+m_2)\\omega^2 + 4K^2\\sin^2(qa/2) = 0$$\n这是一个关于 $\\omega^2$ 的二次方程。求解 $\\omega^2$：\n$$\\omega^2(q) = \\frac{2K(m_1+m_2) \\pm \\sqrt{4K^2(m_1+m_2)^2 - 16K^2m_1m_2\\sin^2(qa/2)}}{2m_1m_2}$$\n$$\\omega^2(q) = K\\left(\\frac{1}{m_1}+\\frac{1}{m_2}\\right) \\pm K\\sqrt{\\left(\\frac{1}{m_1}+\\frac{1}{m_2}\\right)^2 - \\frac{4\\sin^2(qa/2)}{m_1m_2}}$$\n对于每个 $q$，这给出了 $\\omega^2$ 的两个解，对应于两个声子分支。上支（带 $+$ 号）是光学支，下支（带 $-$ 号）是声学支。\n\n为了找到 $q \\to 0$ 时的极限，我们在色散关系中令 $q=0$。在此极限下，$\\sin(qa/2) = 0$。\n$$\\lim_{q\\to 0} \\omega^2(q) = K\\left(\\frac{1}{m_1}+\\frac{1}{m_2}\\right) \\pm K\\sqrt{\\left(\\frac{1}{m_1}+\\frac{1}{m_2}\\right)^2} = K\\left(\\frac{1}{m_1}+\\frac{1}{m_2}\\right) \\pm K\\left(\\frac{1}{m_1}+\\frac{1}{m_2}\\right)$$\n对于声学支（取负号）：\n$$\\lim_{q\\to 0} \\omega_{\\text{ac}}^2(q) = K\\left(\\frac{1}{m_1}+\\frac{1}{m_2}\\right) - K\\left(\\frac{1}{m_1}+\\frac{1}{m_2}\\right) = 0$$\n$$\\lim_{q\\to 0} \\omega_{\\text{ac}}(q) = 0$$\n对于光学支（取正号）：\n$$\\lim_{q\\to 0} \\omega_{\\text{op}}^2(q) = K\\left(\\frac{1}{m_1}+\\frac{1}{m_2}\\right) + K\\left(\\frac{1}{m_1}+\\frac{1}{m_2}\\right) = 2K\\left(\\frac{1}{m_1}+\\frac{1}{m_2}\\right)$$\n$$\\lim_{q\\to 0} \\omega_{\\text{op}}(q) = \\sqrt{2K\\left(\\frac{1}{m_1}+\\frac{1}{m_2}\\right)}$$\n\n接下来，我们分析描述原子相对运动的本征矢量。振幅比 $u/v$ 可以从第一个运动方程求得：\n$$\\frac{u}{v} = \\frac{K(1 + e^{-iqa})}{2K - m_1 \\omega^2}$$\n在 $q \\to 0$ 的极限下，$e^{-iqa} \\to 1$。\n\n对于声学支，当 $q \\to 0$ 时，我们有 $\\omega^2 \\to \\omega_{\\text{ac}}^2(0) = 0$。振幅比为：\n$$\\lim_{q \\to 0} \\left(\\frac{u}{v}\\right)_{\\text{ac}} = \\frac{K(1+1)}{2K - m_1(0)} = \\frac{2K}{2K} = 1$$\n因此，$u=v$。这表示原胞中的两个原子同相、等幅运动。整个晶胞作为一个刚体运动。这对应于长波长的声波，其中相邻的原子平面相互滑过。晶胞的质心位移为 $\\delta R_{CM} = (m_1 u_n + m_2 v_n)/(m_1+m_2)$，由于 $u_n=v_n \\neq 0$，质心显然发生了位移。这种运动携带动量，这是声学波的一个关键特征。\n\n对于光学支，当 $q \\to 0$ 时，我们有 $\\omega^2 \\to \\omega_{\\text{op}}^2(0) = 2K(1/m_1+1/m_2)$。振幅比为：\n$$\\lim_{q \\to 0} \\left(\\frac{u}{v}\\right)_{\\text{op}} = \\frac{K(1+1)}{2K - m_1 \\left[2K(\\frac{1}{m_1}+\\frac{1}{m_2})\\right]} = \\frac{2K}{2K - 2K - 2K\\frac{m_1}{m_2}} = \\frac{2K}{-2K\\frac{m_1}{m_2}} = -\\frac{m_2}{m_1}$$\n因此，$m_1 u = -m_2 v$。这意味着两个原子反相运动，方向相反。晶胞的动量为 $P_{\\text{cell}} = m_1 \\dot{u}_n + m_2 \\dot{v}_n$。由于 $m_1 u_n = -m_2 v_n$，因此可得 $m_1 \\dot{u}_n + m_2 \\dot{v}_n = 0$。晶胞的质心保持静止。这是一种内部振动模式，其中原子相互对着振荡。如果原子带有相反的电荷（如在离子晶体中），这种振荡的偶极子可以被外部电磁场（光）激发，因此得名“光学”支。它代表了晶胞内部的相对运动，而不是整个晶胞的平移。",
            "answer": "$$\\boxed{\\begin{pmatrix} 0  \\sqrt{2K\\left(\\frac{1}{m_1}+\\frac{1}{m_2}\\right)} \\end{pmatrix}}$$"
        },
        {
            "introduction": "从离散的原子图像转向宏观尺度，本练习将晶格动力学与连续介质弹性理论联系起来。你将探索声学声子的长波极限如何对应于在晶体中传播的声波。通过从材料的弹性常数计算声速，你将在微观力常数和可测量的宏观属性之间建立起一座桥梁。",
            "id": "3832828",
            "problem": "考虑一个在长波（连续介质）极限下的均匀立方晶体固体，用线性弹性理论建模。设其质量密度为 $\\rho$（单位为 $\\mathrm{kg}\\,\\mathrm{m}^{-3}$），弹性刚度张量 $C_{ijkl}$ 具有立方对称性，由独立常数 $C_{11}$、$C_{12}$ 和 $C_{44}$（单位为 $\\mathrm{Pa}$）表征。一个微小振幅的机械扰动沿晶体学方向 $\\left[100\\right]$ 传播。\n\n仅从各向异性均匀介质的基本线性弹性动力学方程出发，\n$$\\rho\\,\\ddot{u}_{i}=\\partial_{j}\\sigma_{ij},\\quad \\sigma_{ij}=C_{ijkl}\\,\\varepsilon_{kl},\\quad \\varepsilon_{kl}=\\tfrac{1}{2}\\left(\\partial_{k}u_{l}+\\partial_{l}u_{k}\\right),$$\n以及 $C_{ijkl}$ 在立方对称性下的特化形式，确定沿 $\\left[100\\right]$ 方向传播的纵波声速和（简并的）横波声速。\n\n以 $C_{11}$、$C_{44}$ 和 $\\rho$ 的闭式解析表达式形式报告最终的速度。使用国际单位制（SI），使得速度的单位为 $\\mathrm{m}\\,\\mathrm{s}^{-1}$。无需进行数值代入或四舍五入。以一行的形式提供两种速度，首先是纵波声速，然后是横波声速。",
            "solution": "该问题要求从线性弹性动力学基本方程出发，推导在均匀立方固体中沿 $\\left[100\\right]$ 晶向传播的机械波的纵波声速和横波声速。\n\n给定的控制方程为：\n运动方程：\n$$\n\\rho\\,\\ddot{u}_{i}=\\partial_{j}\\sigma_{ij}\n$$\n线性本构关系（胡克定律）：\n$$\n\\sigma_{ij}=C_{ijkl}\\,\\varepsilon_{kl}\n$$\n无穷小应变-位移关系：\n$$\n\\varepsilon_{kl}=\\tfrac{1}{2}\\left(\\partial_{k}u_{l}+\\partial_{l}u_{k}\\right)\n$$\n这里，$\\rho$ 是质量密度，$u_i$ 是位移矢量 $\\mathbf{u}$ 的第 $i$ 个分量，$\\sigma_{ij}$ 是柯西应力张量，$\\varepsilon_{kl}$ 是无穷小应变张量，$C_{ijkl}$ 是四阶弹性刚度张量。符号 $\\ddot{u}_i$ 表示对时间的二阶偏导数 $\\frac{\\partial^2 u_i}{\\partial t^2}$，而 $\\partial_j$ 表示对空间坐标 $x_j$ 的偏导数 $\\frac{\\partial}{\\partial x_j}$。\n\n首先，我们将这些方程组合成一个关于位移场 $u_i$ 的波动方程。将应变-位移关系代入胡克定律得到：\n$$\n\\sigma_{ij} = C_{ijkl} \\left( \\tfrac{1}{2}\\left(\\partial_{k}u_{l}+\\partial_{l}u_{k}\\right) \\right) = \\tfrac{1}{2} C_{ijkl} \\partial_k u_l + \\tfrac{1}{2} C_{ijkl} \\partial_l u_k\n$$\n通过交换第二项中的哑指标 $k$ 和 $l$，我们得到 $\\tfrac{1}{2} C_{ijlk} \\partial_k u_l$。弹性刚度张量具有次对称性 $C_{ijlk} = C_{ijkl}$。因此，应力的表达式简化为：\n$$\n\\sigma_{ij} = \\tfrac{1}{2} C_{ijkl} \\partial_k u_l + \\tfrac{1}{2} C_{ijkl} \\partial_k u_l = C_{ijkl} \\partial_k u_l\n$$\n现在，将此应力表达式代入运动方程：\n$$\n\\rho\\,\\ddot{u}_{i} = \\partial_{j}\\left(C_{ijkl} \\partial_k u_l\\right)\n$$\n对于均匀介质，刚度张量 $C_{ijkl}$ 的分量不随位置变化，因此可以移到空间导数之外：\n$$\n\\rho\\,\\frac{\\partial^2 u_i}{\\partial t^2} = C_{ijkl} \\frac{\\partial^2 u_l}{\\partial x_j \\partial x_k}\n$$\n这是各向异性介质中弹性动力学波动方程的一般形式。\n\n我们寻求一个平面单色波解，其形式为：\n$$\nu_i(\\mathbf{x}, t) = U_i \\exp\\left[i(\\mathbf{k} \\cdot \\mathbf{x} - \\omega t)\\right]\n$$\n其中 $U_i$ 是常数极化矢量 $\\mathbf{U}$ 的分量，$\\mathbf{k}$ 是波矢，$\\omega$ 是角频率。其导数为：\n$$\n\\frac{\\partial^2 u_i}{\\partial t^2} = (-\\omega^2) u_i\n$$\n$$\n\\frac{\\partial^2 u_l}{\\partial x_j \\partial x_k} = (i k_j)(i k_k) u_l = -k_j k_k u_l\n$$\n将这些代入波动方程得到：\n$$\n\\rho(-\\omega^2 U_i) = C_{ijkl} (-k_j k_k U_l)\n$$\n$$\n\\rho \\omega^2 U_i = C_{ijkl} k_j k_k U_l\n$$\n令 $\\mathbf{n}$ 为传播方向的单位矢量，则 $\\mathbf{k} = k \\mathbf{n}$，其中 $k=|\\mathbf{k}|$ 是波数。相速度为 $v = \\omega/k$。代入这些关系：\n$$\n\\rho (v^2 k^2) U_i = C_{ijkl} (k n_j) (k n_k) U_l\n$$\n两边除以 $k^2$（假设 $k \\neq 0$）得到克里斯托费尔方程：\n$$\n\\left( C_{ijkl} n_j n_k \\right) U_l = \\rho v^2 U_i\n$$\n这是一个本征值问题，可以写成 $\\Gamma_{il} U_l = \\rho v^2 U_i$。分量为 $\\Gamma_{il} = C_{ijkl} n_j n_k$ 的矩阵 $\\Gamma$ 被称为克里斯托费尔张量。该张量的本征值为 $\\lambda = \\rho v^2$，它决定了在给定传播方向 $\\mathbf{n}$ 下三种可能的波速。相应的本征矢量 $\\mathbf{U}$ 代表这些波的极化方向。\n\n对于立方晶体，弹性刚度张量在福格特（Voigt）表示法中只有三个独立的非零分量：$C_{11}$、$C_{12}$ 和 $C_{44}$。在完整的张量表示法中，相关的非零分量是：\n$C_{1111}=C_{2222}=C_{3333} = C_{11}$\n$C_{1122}=C_{2211}=C_{1133}=C_{3311}=C_{2233}=C_{3322} = C_{12}$\n$C_{2323}=C_{3232}=C_{1313}=C_{3131}=C_{1212}=C_{2121} = C_{44}$（以及其他由对称性得到的分量，例如 $C_{1221}=C_{44}$）。\n\n问题指定传播方向为 $\\left[100\\right]$。这对应于单位矢量 $\\mathbf{n} = (1, 0, 0)$，所以 $n_1=1$，$n_2=0$，$n_3=0$。\n我们现在计算克里斯托费尔张量 $\\Gamma_{il} = C_{ijkl} n_j n_k$ 的分量。由于 $\\mathbf{n}$ 的形式，对 $j$ 和 $k$ 的求和中唯一的非零贡献出现在 $j=1$ 和 $k=1$ 时。因此，表达式简化为：\n$$\n\\Gamma_{il} = C_{i11l}\n$$\n我们来计算 $3 \\times 3$ 矩阵 $\\Gamma$ 的分量：\n$\\Gamma_{11} = C_{1111} = C_{11}$\n$\\Gamma_{12} = C_{1112} = 0$（对于立方对称性）\n$\\Gamma_{13} = C_{1113} = 0$（对于立方对称性）\n$\\Gamma_{21} = C_{2111} = 0$（对于立方对称性）\n$\\Gamma_{22} = C_{2112} = C_{44}$（根据对称性 $C_{2112}=C_{1212}=C_{44}$）\n$\\Gamma_{23} = C_{2113} = 0$（对于立方对称性）\n$\\Gamma_{31} = C_{3111} = 0$（对于立方对称性）\n$\\Gamma_{32} = C_{3112} = 0$（对于立方对称性）\n$\\Gamma_{33} = C_{3113} = C_{44}$（根据对称性 $C_{3113}=C_{1313}=C_{44}$）\n\n沿 $\\left[100\\right]$ 方向传播的克里斯托费尔张量是一个对角矩阵：\n$$\n\\Gamma = \\begin{pmatrix} C_{11}  0  0 \\\\ 0  C_{44}  0 \\\\ 0  0  C_{44} \\end{pmatrix}\n$$\n$\\Gamma$ 的本征值 $\\lambda$ 就是其对角元：$\\lambda_1 = C_{11}$，$\\lambda_2 = C_{44}$，和 $\\lambda_3 = C_{44}$。\n相应的相速度的平方由 $\\rho v^2 = \\lambda$ 得到：\n$v_1^2 = \\frac{C_{11}}{\\rho}$\n$v_2^2 = \\frac{C_{44}}{\\rho}$\n$v_3^2 = \\frac{C_{44}}{\\rho}$\n\n为了识别模式，我们检查本征矢量。\n对于本征值 $\\lambda_1 = C_{11}$，本征矢量是 $\\mathbf{U}_1 = (1, 0, 0)$。这个极化矢量平行于传播方向 $\\mathbf{n} = (1, 0, 0)$，因此该模式是纵波。纵波声速为：\n$$\nv_L = \\sqrt{\\frac{C_{11}}{\\rho}}\n$$\n对于简并本征值 $\\lambda_2 = \\lambda_3 = C_{44}$，本征矢量可以选择为 $\\mathbf{U}_2 = (0, 1, 0)$ 和 $\\mathbf{U}_3 = (0, 0, 1)$。这两个极化矢量都垂直于传播方向 $\\mathbf{n}$。这些模式是横波。由于它们的速度相同，因此被称为简并横波模式。横波声速为：\n$$\nv_T = \\sqrt{\\frac{C_{44}}{\\rho}}\n$$\n问题要求先给出纵波声速，再给出横波声速。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\sqrt{\\frac{C_{11}}{\\rho}}  \\sqrt{\\frac{C_{44}}{\\rho}} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "这项实践从解析理论过渡到计算材料科学中的实际挑战。原子间力常数的数值计算可能会引入违反声学求和规则的误差，而该规则是平移不变性的基本推论。你将设计并实现一个校正算法，在最小化改动计算数据的前提下强制执行这一物理定律，这是确保声子模拟结果物理有效性的关键一步。",
            "id": "3832843",
            "problem": "给定一个实数方阵，表示一个晶体的力常数 $\\Phi \\in \\mathbb{R}^{m \\times m}$，该晶体具有 $m = 3N$ 个自由度，其中 $N$ 是原子数，因子 $3$ 对应于每个原子的三个笛卡尔坐标方向。在晶格动力学中，晶体的平移不变性意味着声学求和规则（Acoustic Sum Rule, ASR）：对于每个自由度 $i\\alpha$，行和 $\\sum_{j\\beta} \\Phi_{i\\alpha,j\\beta}$ 必须为零。等效地，使用全一向量 $\\mathbf{1} \\in \\mathbb{R}^{m}$ 写成向量形式，ASR 要求 $\\Phi \\mathbf{1} = \\mathbf{0}$。一个计算出的 $\\Phi$ 可能会因为数值或建模误差而违反 ASR。\n\n从以下基本原理出发：(i) Newton定律意味着刚性平移不应产生净力；(ii) 对于保守的原子间势，力常数矩阵满足对偶对称性 $\\Phi_{i\\alpha,j\\beta} = \\Phi_{j\\beta,i\\alpha}$，构建一个校正程序，该程序在强制执行 ASR 并保持对偶对称性 $\\Phi = \\Phi^{\\top}$ 的同时，以弗罗贝尼乌斯范数（Frobenius norm）衡量，对 $\\Phi$ 的修改最小。具体来说，设计一个算法，生成一个校正后的矩阵 $\\Phi' \\in \\mathbb{R}^{m \\times m}$，满足：\n- $\\Phi'$ 是对称的，即 $\\Phi' = \\Phi'^{\\top}$，\n- $\\Phi' \\mathbf{1} = \\mathbf{0}$，\n- 在所有满足 ASR 的对称矩阵中，变化量 $\\Delta = \\Phi' - \\widehat{\\Phi}$ 的弗罗贝尼乌斯范数最小，其中 $\\widehat{\\Phi} = (\\Phi + \\Phi^{\\top})/2$ 是对称化输入，弗罗贝尼乌斯范数为 $\\|\\Delta\\|_F = \\sqrt{\\sum_{i,j} \\Delta_{ij}^2}$。\n\n你的程序必须对一组给定的测试矩阵实施此校正，并为每个测试用例输出三个可用于检验结果的量：\n- 校正后的最大绝对 ASR 残差，定义为 $\\max_{i} |(\\Phi' \\mathbf{1})_i|$，\n- 所施加校正的弗罗贝尼乌斯范数，定义为 $\\|\\Delta\\|_F$，\n- 校正后矩阵中的最大绝对不对称性，定义为 $\\max_{i,j} |\\Phi'_{ij} - \\Phi'_{ji}|$。\n\n对于此问题，所有量都是无量纲实数，输出时不应带单位。\n\n测试套件：\n使用以下三个科学上合理的矩阵作为测试用例。每个矩阵都是实数且无量纲的。\n\n1. 情况 A ($m = 6$): 两个原子在所有笛卡尔方向上以弹簧常数 $k = 10$ 各向同性耦合，并受到对称的秩一扰动。令 $I_3$ 为 $3 \\times 3$ 单位矩阵。定义\n$$\n\\Phi_{\\text{ideal}} = \n\\begin{pmatrix}\nk I_3  -k I_3 \\\\\n-k I_3  k I_3\n\\end{pmatrix},\n\\quad\n\\mathbf{v} = \\begin{pmatrix} 2 \\\\ -1 \\\\ 0.5 \\\\ 3 \\\\ -2 \\\\ 1 \\end{pmatrix},\n\\quad\n\\Phi^{(A)} = \\Phi_{\\text{ideal}} + 0.3\\, \\mathbf{v}\\mathbf{v}^{\\top}.\n$$\n\n2. 情况 B ($m = 3$): 单原子 $3 \\times 3$ 矩阵，其对角线元素混合，模拟自洽项中的数值不一致性：\n$$\n\\Phi^{(B)} = \\mathrm{diag}(1, -1, 0).\n$$\n\n3. 情况 C ($m = 9$): 线性链中的三个原子，各向同性耦合系数为 $k_{12} = 5$ 和 $k_{23} = 8$，受到对称的结构化扰动。使用与上述相同的 $I_3$，构建 $9 \\times 9$ 矩阵\n$$\n\\Phi_{\\text{ideal}} = \n\\begin{pmatrix}\nk_{12} I_3  -k_{12} I_3  0 \\\\\n-k_{12} I_3  (k_{12}+k_{23}) I_3  -k_{23} I_3 \\\\\n0  -k_{23} I_3  k_{23} I_3\n\\end{pmatrix},\n$$\n并令\n$$\n\\mathbf{a} =\n\\begin{pmatrix}\n0 \\\\ 1 \\\\ -1 \\\\ 2 \\\\ 0 \\\\ -2 \\\\ 1 \\\\ 0.5 \\\\ -1.5\n\\end{pmatrix},\n\\quad\n\\Phi^{(C)} = \\Phi_{\\text{ideal}} + 0.4 \\left( \\mathbf{a}\\mathbf{1}^{\\top} + \\mathbf{1}\\mathbf{a}^{\\top} \\right).\n$$\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个逗号分隔的用例结果列表，每个用例结果本身是一个用方括号括起来的逗号分隔的三元组，整个列表也用方括号括起来。例如，输出必须如下所示：\n$$\n[[r_{\\max}^{(A)},\\|\\Delta^{(A)}\\|_F,a_{\\max}^{(A)}],[r_{\\max}^{(B)},\\|\\Delta^{(B)}\\|_F,a_{\\max}^{(B)}],[r_{\\max}^{(C)},\\|\\Delta^{(C)}\\|_F,a_{\\max}^{(C)}]],\n$$\n其中 $r_{\\max}$ 是校正后的最大绝对 ASR 残差，$\\|\\Delta\\|_F$ 是校正的弗罗贝尼乌斯范数，而 $a_{\\max}$ 是校正后矩阵的最大绝对不对称性。程序不得打印任何其他文本。",
            "solution": "该问题要求提供一种算法来校正一个给定的实数方阵力常数矩阵 $\\Phi \\in \\mathbb{R}^{m \\times m}$，使其同时满足两个基本的物理约束：对偶对称性（$\\Phi' = \\Phi'^{\\top}$）和声学求和规则（ASR, $\\Phi' \\mathbf{1} = \\mathbf{0}$）。此校正必须是最小的，即相对于对称化输入矩阵，它使变化的弗罗贝尼乌斯范数最小化。\n\n这个问题可以表述为一个约束优化问题。设给定的矩阵 $\\Phi$ 可能非对称且违反 ASR。第一步是强制对称性。在弗罗贝尼乌斯范数下，与 $\\Phi$最接近的对称矩阵是其对称部分 $\\widehat{\\Phi} = (\\Phi + \\Phi^{\\top}) / 2$。问题陈述正确地将 $\\widehat{\\Phi}$ 确定为参考矩阵。我们寻求一个校正后的矩阵 $\\Phi'$，它在满足约束条件的前提下，使 $\\|\\Phi' - \\widehat{\\Phi}\\|_F$ 最小化。\n\n令 $\\Delta = \\Phi' - \\widehat{\\Phi}$ 为校正矩阵。问题等价于找到矩阵 $\\Delta$，使其在满足以下条件时最小化 $\\|\\Delta\\|_F^2 = \\sum_{i,j} \\Delta_{ij}^2$：\n$1$. $\\Phi'$ 是对称的：$(\\widehat{\\Phi} + \\Delta) = (\\widehat{\\Phi} + \\Delta)^{\\top}$。由于 $\\widehat{\\Phi}$ 根据定义是对称的，这简化为 $\\Delta = \\Delta^{\\top}$。\n$2$. $\\Phi'$ 满足 ASR：$(\\widehat{\\Phi} + \\Delta)\\mathbf{1} = \\mathbf{0}$，这意味着 $\\Delta\\mathbf{1} = -\\widehat{\\Phi}\\mathbf{1}$。\n\n令 $\\mathbf{r} = \\widehat{\\Phi}\\mathbf{1}$ 为对称化矩阵 $\\widehat{\\Phi}$ 的 ASR 残差向量。该优化问题为：\n$$\n\\underset{\\Delta \\in \\mathbb{R}^{m \\times m}}{\\text{minimize}} \\quad \\frac{1}{2} \\|\\Delta\\|_F^2\n$$\n$$\n\\text{subject to} \\quad \\Delta = \\Delta^{\\top} \\quad \\text{and} \\quad \\Delta \\mathbf{1} = -\\mathbf{r}\n$$\n\n这是一个凸优化问题（带线性约束的二次目标函数），保证有唯一解。解 $\\Delta$ 是零矩阵在由约束定义的仿射子空间上的正交投影。解决此问题的标准方法是提出解的形式并确定其参数。我们寻求一个满足求和规则的对称校正矩阵 $\\Delta$。这类矩阵的一个自然拟设（ansatz）是：\n$$\n\\Delta = \\mathbf{x} \\mathbf{1}^{\\top} + \\mathbf{1} \\mathbf{x}^{\\top}\n$$\n对于某个向量 $\\mathbf{x} \\in \\mathbb{R}^m$。这种形式显然是对称的，因为 $(\\mathbf{x} \\mathbf{1}^{\\top} + \\mathbf{1} \\mathbf{x}^{\\top})^{\\top} = (\\mathbf{1} \\mathbf{x}^{\\top}) + (\\mathbf{x} \\mathbf{1}^{\\top}) = \\Delta$。\n\n现在我们强制执行 ASR 约束 $\\Delta\\mathbf{1} = -\\mathbf{r}$：\n$$\n(\\mathbf{x} \\mathbf{1}^{\\top} + \\mathbf{1} \\mathbf{x}^{\\top})\\mathbf{1} = -\\mathbf{r}\n$$\n利用矩阵乘法的结合律：\n$$\n\\mathbf{x}(\\mathbf{1}^{\\top}\\mathbf{1}) + \\mathbf{1}(\\mathbf{x}^{\\top}\\mathbf{1}) = -\\mathbf{r}\n$$\n项 $\\mathbf{1}^{\\top}\\mathbf{1}$ 是全一向量与自身的点积，等于空间维度 $m$。项 $\\mathbf{x}^{\\top}\\mathbf{1}$ 是一个标量，我们记为 $s = \\sum_{i=1}^m x_i$。方程变为：\n$$\nm\\mathbf{x} + s\\mathbf{1} = -\\mathbf{r}\n$$\n此方程给出了向量 $\\mathbf{x}$ 关于未知标量 $s$ 的表达式：\n$$\n\\mathbf{x} = -\\frac{1}{m}(\\mathbf{r} + s\\mathbf{1})\n$$\n为了找到 $s$，我们使用其定义 $s = \\mathbf{1}^{\\top}\\mathbf{x}$。我们将 $\\mathbf{x}$ 的表达式左乘 $\\mathbf{1}^{\\top}$：\n$$\n\\mathbf{1}^{\\top}\\mathbf{x} = -\\frac{1}{m}\\mathbf{1}^{\\top}(\\mathbf{r} + s\\mathbf{1})\n$$\n$$\ns = -\\frac{1}{m}(\\mathbf{1}^{\\top}\\mathbf{r} + s\\mathbf{1}^{\\top}\\mathbf{1})\n$$\n令 $S_r = \\mathbf{1}^{\\top}\\mathbf{r} = \\sum_{i=1}^m r_i$ 为所有残差的总和。代入 $S_r$ 和 $\\mathbf{1}^{\\top}\\mathbf{1}=m$：\n$$\ns = -\\frac{1}{m}(S_r + sm) = -\\frac{S_r}{m} - s\n$$\n$$\n2s = -\\frac{S_r}{m} \\implies s = -\\frac{S_r}{2m}\n$$\n确定了 $s$ 之后，向量 $\\mathbf{x}$ 就被完全指定，从而校正矩阵 $\\Delta$ 也被确定。此过程给出了最小化弗罗贝尼乌斯范数的唯一解。\n\n计算算法如下：\n$1$. 给定输入矩阵 $\\Phi \\in \\mathbb{R}^{m \\times m}$。\n$2$. 构建对称化矩阵 $\\widehat{\\Phi} = (\\Phi + \\Phi^{\\top}) / 2$。\n$3$. 计算 ASR 残差向量 $\\mathbf{r} = \\widehat{\\Phi}\\mathbf{1}$。\n$4$. 计算残差总和 $S_r = \\sum_{i=1}^m r_i$。\n$5$. 计算标量 $s = -S_r / (2m)$。\n$6$. 确定校正向量 $\\mathbf{x} = -(\\mathbf{r} + s\\mathbf{1}) / m$。\n$7$. 构建校正矩阵 $\\Delta$，其中 $\\Delta_{ij} = x_i + x_j$。矩阵形式为 $\\Delta = \\mathbf{x} \\mathbf{1}^{\\top} + \\mathbf{1} \\mathbf{x}^{\\top}$。\n$8$. 计算最终校正矩阵 $\\Phi' = \\widehat{\\Phi} + \\Delta$。\n$9$. 最后，计算所需的可检验量：\n    - 校正后的最大绝对 ASR 残差：$r_{\\max} = \\max_{i} |(\\Phi' \\mathbf{1})_i|$。代数上，该值为 $0$。\n    - 所施加校正的弗罗贝尼乌斯范数：$\\|\\Delta\\|_F = \\|\\Phi' - \\widehat{\\Phi}\\|_F$。一个方便计算的公式是 $\\|\\Delta\\|_F^2 = 2m\\|\\mathbf{x}\\|_2^2 + 2s^2$。\n    - 校正后矩阵中的最大绝对不对称性：$a_{\\max} = \\max_{i,j} |\\Phi'_{ij} - \\Phi'_{ji}|$。代数上，该值也为 $0$。\n在数值实现中，$r_{\\max}$ 和 $a_{\\max}$ 的非零值将是由于浮点运算精度限制造成的。",
            "answer": "[[2.220446049250313e-15,19.68756188059882,0.0],[0.0,1.1547005383792515,0.0],[2.842170943040401e-14,22.04540763264771,0.0]]"
        }
    ]
}