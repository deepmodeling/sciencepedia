{
    "hands_on_practices": [
        {
            "introduction": "The Cauchy-Born rule provides a powerful link between macroscopic deformation and the stretching of individual atomic bonds. This practice  puts this principle into action by having you calculate the strain energy density for two distinct 2D crystal structures. By comparing the response of square and triangular lattices to the same uniaxial tension, you will gain a concrete understanding of how lattice geometry and coordination directly govern a material's elastic stiffness.",
            "id": "3845527",
            "problem": "Consider two crystalline solids modeled as identical point atoms interacting via an isotropic nearest-neighbor pair potential $V(r) = \\frac{1}{2} k \\left(r - a_0\\right)^{2}$, where $k$ is a positive stiffness constant and $a_0$ is the equilibrium nearest-neighbor separation. One solid has a square Bravais lattice, and the other has a triangular Bravais lattice, both in $2$-dimensional space. Assume no interactions beyond the nearest neighbors, and neglect any angular or multi-body terms. Under a homogeneous uniaxial tension along a high-symmetry lattice direction, the macroscopic deformation is described by the deformation gradient $\\mathbf{F} = \\mathrm{diag}(\\lambda, 1)$, with $\\lambda > 1$. In the regime where the Cauchy-Born rule (CBR) applies, lattice bond vectors deform affinely according to $\\mathbf{F}$.\n\nStarting from the definition of the pair interaction and the homogeneous deformation, derive the energy density per unit undeformed area for the square lattice, and for the triangular lattice, by summing per-atom bond energies with appropriate double-counting correction and multiplying by the initial areal number density of atoms for each lattice. Then, compute the ratio of the triangular-lattice energy density to the square-lattice energy density as a function of $\\lambda$, based solely on the nearest-neighbor geometry and coordination. Report this ratio as a single closed-form analytic expression in terms of $\\lambda$ only. No numerical values are required, and no rounding is required. The final ratio is dimensionless, so no physical units should be used in the answer.\n\nIn addition to the derivation, explain qualitatively why coordination and bond orientation lead to differences between the two lattices under this loading, making clear reference to how the Cauchy-Born rule (CBR) couples continuum kinematics to atomistic bond stretches without invoking any additional constitutive shortcuts beyond the stated assumptions.",
            "solution": "The problem requires the derivation of the ratio of strain energy densities for two-dimensional triangular and square lattices under a specific homogeneous deformation, based on the Cauchy-Born rule (CBR). The potential energy is given by a nearest-neighbor harmonic pair potential, $V(r) = \\frac{1}{2} k \\left(r - a_0\\right)^{2}$, where $a_0$ is the equilibrium bond length, which is also the lattice parameter in the undeformed state. The macroscopic deformation is a uniaxial stretch defined by the deformation gradient $\\mathbf{F} = \\mathrm{diag}(\\lambda, 1)$.\n\nThe CBR provides the crucial link between macroscopic continuum deformation and microscopic atomic displacements. It posits that bond vectors $\\mathbf{d}$ in the undeformed lattice deform affinely to $\\mathbf{d}' = \\mathbf{F} \\mathbf{d}$ in the deformed lattice. The strain energy density, $\\mathcal{E}$, is the stored energy per unit undeformed area. It is calculated by summing the potential energy of all bonds connected to a representative atom, applying a correction for double-counting, and dividing by the area per atom in the undeformed configuration.\n\nFirst, we analyze the square lattice.\nLet the lattice be oriented such that its principal axes align with the Cartesian axes. A representative atom is placed at the origin. In the undeformed state, the four nearest-neighbor vectors are:\n$$\n\\mathbf{d}_1^{(S)} = \\begin{pmatrix} a_0 \\\\ 0 \\end{pmatrix}, \\quad \\mathbf{d}_2^{(S)} = \\begin{pmatrix} 0 \\\\ a_0 \\end{pmatrix}, \\quad \\mathbf{d}_3^{(S)} = \\begin{pmatrix} -a_0 \\\\ 0 \\end{pmatrix}, \\quad \\mathbf{d}_4^{(S)} = \\begin{pmatrix} 0 \\\\ -a_0 \\end{pmatrix}\n$$\nThe coordination number is $Z_S = 4$. Applying the deformation gradient $\\mathbf{F} = \\begin{pmatrix} \\lambda & 0 \\\\ 0 & 1 \\end{pmatrix}$:\n$$\n\\mathbf{d'}_1^{(S)} = \\mathbf{F}\\mathbf{d}_1^{(S)} = \\begin{pmatrix} \\lambda a_0 \\\\ 0 \\end{pmatrix}, \\quad \\mathbf{d'}_2^{(S)} = \\mathbf{F}\\mathbf{d}_2^{(S)} = \\begin{pmatrix} 0 \\\\ a_0 \\end{pmatrix}\n$$\nThe other two deformed vectors are $\\mathbf{d'}_3^{(S)} = -\\mathbf{d'}_1^{(S)}$ and $\\mathbf{d'}_4^{(S)} = -\\mathbf{d'}_2^{(S)}$. The new bond lengths are $r_1 = |\\mathbf{d'}_1^{(S)}| = \\lambda a_0$ and $r_2 = |\\mathbf{d'}_2^{(S)}| = a_0$. By symmetry, $r_3 = r_1$ and $r_4 = r_2$.\nThe strain energy stored in each bond is:\n$$\nV(r_1) = \\frac{1}{2} k (\\lambda a_0 - a_0)^2 = \\frac{1}{2} k a_0^2 (\\lambda - 1)^2\n$$\n$$\nV(r_2) = \\frac{1}{2} k (a_0 - a_0)^2 = 0\n$$\nThe total energy per atom, $E_{atom}^{(S)}$, is half the sum of energies of the bonds connected to it (the factor of $\\frac{1}{2}$ corrects for sharing each bond between two atoms):\n$$\nE_{atom}^{(S)} = \\frac{1}{2} \\sum_{i=1}^{4} V(r_i) = \\frac{1}{2} [2 V(r_1) + 2 V(r_2)] = V(r_1) = \\frac{1}{2} k a_0^2 (\\lambda - 1)^2\n$$\nThe area per atom in the undeformed square lattice is $A_0^{(S)} = a_0^2$. The energy density is therefore:\n$$\n\\mathcal{E}^{(S)} = \\frac{E_{atom}^{(S)}}{A_0^{(S)}} = \\frac{\\frac{1}{2} k a_0^2 (\\lambda - 1)^2}{a_0^2} = \\frac{1}{2} k (\\lambda - 1)^2\n$$\n\nNext, we analyze the triangular lattice.\nWe orient the lattice such that one of the three high-symmetry bond directions is aligned with the x-axis. The six nearest-neighbor vectors are:\n$$\n\\mathbf{d}_1^{(T)} = a_0 \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\quad \\mathbf{d}_2^{(T)} = a_0 \\begin{pmatrix} \\cos(\\pi/3) \\\\ \\sin(\\pi/3) \\end{pmatrix} = a_0 \\begin{pmatrix} 1/2 \\\\ \\sqrt{3}/2 \\end{pmatrix}, \\quad \\mathbf{d}_3^{(T)} = a_0 \\begin{pmatrix} \\cos(2\\pi/3) \\\\ \\sin(2\\pi/3) \\end{pmatrix} = a_0 \\begin{pmatrix} -1/2 \\\\ \\sqrt{3}/2 \\end{pmatrix}\n$$\nand their negatives $\\mathbf{d}_4^{(T)}=-\\mathbf{d}_1^{(T)}$, $\\mathbf{d}_5^{(T)}=-\\mathbf{d}_2^{(T)}$, $\\mathbf{d}_6^{(T)}=-\\mathbf{d}_3^{(T)}$. The coordination number is $Z_T = 6$.\nApplying the deformation $\\mathbf{F}$:\n$$\n\\mathbf{d'}_1^{(T)} = \\mathbf{F}\\mathbf{d}_1^{(T)} = \\begin{pmatrix} \\lambda a_0 \\\\ 0 \\end{pmatrix}\n$$\n$$\n\\mathbf{d'}_2^{(T)} = \\mathbf{F}\\mathbf{d}_2^{(T)} = a_0 \\begin{pmatrix} \\lambda/2 \\\\ \\sqrt{3}/2 \\end{pmatrix}\n$$\n$$\n\\mathbf{d'}_3^{(T)} = \\mathbf{F}\\mathbf{d}_3^{(T)} = a_0 \\begin{pmatrix} -\\lambda/2 \\\\ \\sqrt{3}/2 \\end{pmatrix}\n$$\nThe new bond lengths are:\n$$\nr_1 = |\\mathbf{d'}_1^{(T)}| = \\lambda a_0\n$$\n$$\nr_2 = |\\mathbf{d'}_2^{(T)}| = \\sqrt{(a_0 \\lambda/2)^2 + (a_0 \\sqrt{3}/2)^2} = \\frac{a_0}{2}\\sqrt{\\lambda^2 + 3}\n$$\nBy symmetry, $r_3=r_5=r_6=r_2$ and $r_4=r_1$.\nThe bond energies are:\n$$\nV(r_1) = \\frac{1}{2} k (\\lambda a_0 - a_0)^2 = \\frac{1}{2} k a_0^2 (\\lambda - 1)^2\n$$\n$$\nV(r_2) = \\frac{1}{2} k \\left(\\frac{a_0}{2}\\sqrt{\\lambda^2 + 3} - a_0\\right)^2 = \\frac{1}{2} k a_0^2 \\left(\\frac{\\sqrt{\\lambda^2 + 3}}{2} - 1\\right)^2 = \\frac{k a_0^2}{8} \\left(\\sqrt{\\lambda^2 + 3} - 2\\right)^2\n$$\nThe energy per atom is:\n$$\nE_{atom}^{(T)} = \\frac{1}{2} \\sum_{i=1}^{6} V(r_i) = \\frac{1}{2} [2 V(r_1) + 4 V(r_2)] = V(r_1) + 2 V(r_2)\n$$\n$$\nE_{atom}^{(T)} = \\frac{1}{2} k a_0^2 (\\lambda-1)^2 + 2 \\left[ \\frac{k a_0^2}{8} (\\sqrt{\\lambda^2 + 3} - 2)^2 \\right] = \\frac{k a_0^2}{4} \\left[ 2(\\lambda-1)^2 + (\\sqrt{\\lambda^2 + 3} - 2)^2 \\right]\n$$\nExpanding the terms:\n$$\nE_{atom}^{(T)} = \\frac{k a_0^2}{4} \\left[ 2(\\lambda^2 - 2\\lambda + 1) + (\\lambda^2 + 3 - 4\\sqrt{\\lambda^2 + 3} + 4) \\right]\n$$\n$$\nE_{atom}^{(T)} = \\frac{k a_0^2}{4} \\left[ 2\\lambda^2 - 4\\lambda + 2 + \\lambda^2 + 7 - 4\\sqrt{\\lambda^2 + 3} \\right] = \\frac{k a_0^2}{4} \\left[ 3\\lambda^2 - 4\\lambda + 9 - 4\\sqrt{\\lambda^2 + 3} \\right]\n$$\nThe area per atom in the undeformed triangular lattice (area of a primitive cell spanned by vectors $(a_0, 0)$ and $(a_0/2, a_0\\sqrt{3}/2)$) is $A_0^{(T)} = a_0 \\cdot \\frac{a_0 \\sqrt{3}}{2} = \\frac{\\sqrt{3}}{2} a_0^2$. The energy density is:\n$$\n\\mathcal{E}^{(T)} = \\frac{E_{atom}^{(T)}}{A_0^{(T)}} = \\frac{\\frac{k a_0^2}{4} \\left[ 3\\lambda^2 - 4\\lambda + 9 - 4\\sqrt{\\lambda^2 + 3} \\right]}{\\frac{\\sqrt{3}}{2} a_0^2} = \\frac{k}{2\\sqrt{3}} \\left[ 3\\lambda^2 - 4\\lambda + 9 - 4\\sqrt{\\lambda^2 + 3} \\right]\n$$\nFinally, we compute the ratio $R = \\mathcal{E}^{(T)}/\\mathcal{E}^{(S)}$:\n$$\nR(\\lambda) = \\frac{\\frac{k}{2\\sqrt{3}} \\left[ 3\\lambda^2 - 4\\lambda + 9 - 4\\sqrt{\\lambda^2 + 3} \\right]}{\\frac{1}{2} k (\\lambda - 1)^2} = \\frac{3\\lambda^2 - 4\\lambda + 9 - 4\\sqrt{\\lambda^2 + 3}}{\\sqrt{3}(\\lambda - 1)^2}\n$$\n\nQualitatively, the difference in energy density arises from the distinct lattice geometries. The Cauchy-Born rule rigidly links the macroscopic strain to the microscopic bond stretches. For the square lattice under uniaxial tension along a lattice vector, only the $2$ bonds (out of $4$) aligned with the tension are stretched. The other $2$ transverse bonds are unaffected and store no energy. In contrast, the triangular lattice is more interconnected, with a higher coordination number of $6$. When stretched along a high-symmetry direction, not only are the $2$ bonds aligned with the tension stretched, but the other $4$ oblique bonds are also forced to stretch and rotate. These oblique bonds have components along the tensile axis, and the CBR dictates their endpoints move apart, increasing their length and storing strain energy. Consequently, all $6$ bonds in the triangular lattice contribute to resisting the deformation (for $\\lambda>1$), whereas only half of the bonds do so in the square lattice. This more comprehensive engagement of bonds makes the triangular lattice structurally stiffer under this specific deformation, causing it to store more energy per unit area for the same macroscopic strain $\\lambda$.",
            "answer": "$$\\boxed{\\frac{3\\lambda^{2} - 4\\lambda + 9 - 4\\sqrt{\\lambda^{2}+3}}{\\sqrt{3}\\left(\\lambda-1\\right)^{2}}}$$"
        },
        {
            "introduction": "A cornerstone of multiscale modeling is ensuring that physical quantities like stress are described consistently across different scales. This practice  guides you through a computational verification of this consistency, challenging you to calculate the Cauchy stress tensor via two independent paths: the microscopic virial formula and the macroscopic Cauchy-Born rule. By showing that these two methods yield identical results for a homogeneously deformed crystal, you will confirm a fundamental tenet of continuum elasticity and gain valuable experience translating theoretical mechanics into a working algorithm.",
            "id": "3845528",
            "problem": "You are given a homogeneous deformation scenario for a Bravais lattice and asked to compute continuum stress from a Molecular Dynamics (MD) snapshot and compare it with the Cauchy-Born prediction. The goal is to design a program that, for a prescribed set of deformation gradients, calculates the Cauchy stress via two independent routes—an MD virial formula using the snapshot of positions under the deformation, and the Cauchy-Born rule derived from atomistic energy density—and returns a quantitative discrepancy measure for each case.\n\nFundamental base and assumptions to be used:\n- The lattice is a simple cubic Bravais lattice with lattice parameter $a$ and one atom per lattice point. The undeformed reference positions are given by $X = (i\\,a, j\\,a, k\\,a)$ for integer indices $i, j, k$ covering a periodic supercell.\n- The homogeneous deformation is represented by the deformation gradient $F \\in \\mathbb{R}^{3 \\times 3}$. Under homogeneous kinematics, the deformed positions are $x = F X$, and the deformed periodic supercell vectors are $F$ times the reference cell vectors.\n- The pair potential between nearest neighbors is harmonic, with $\\phi(r) = \\frac{k}{2} (r - r_0)^2$, where $r = \\lVert r_{ij} \\rVert$ is the bond length between atoms $i$ and $j$ in the deformed configuration, $k > 0$ is the spring constant, and $r_0 > 0$ is the rest length. Forces are central: $f_{ij} = -\\phi'(r)\\,\\hat{r}$ with $\\hat{r} = r_{ij}/r$.\n- The MD virial formula for the Cauchy stress $\\sigma$ with pairwise central forces under periodic boundary conditions is\n$$\n\\sigma_{\\mathrm{MD}} = -\\frac{1}{V} \\sum_{(i,j)\\,\\mathrm{pairs}} r_{ij} \\otimes f_{ij},\n$$\nwhere $V$ is the current deformed volume and the sum is taken over each unique pair once.\n- The Cauchy-Born rule expresses the continuum energy density $W(F)$ of a Bravais lattice under homogeneous deformation as a sum over reference bonds $R$ mapped by $F$:\n$$\nW(F) = \\frac{1}{V_0} \\sum_{R \\in \\mathcal{N}} \\phi(\\lVert F R \\rVert),\n$$\nwhere $V_0$ is the undeformed volume of the supercell and $\\mathcal{N}$ is the set of nearest-neighbor reference bond vectors. The first Piola-Kirchhoff stress $P(F)$ is\n$$\nP(F) = \\frac{\\partial W}{\\partial F} = \\frac{1}{V_0} \\sum_{R \\in \\mathcal{N}} \\phi'(\\lVert F R \\rVert)\\, \\frac{F R}{\\lVert F R \\rVert} \\otimes R,\n$$\nand the Cauchy stress is related by\n$$\n\\sigma_{\\mathrm{CB}}(F) = \\frac{1}{J} P(F) F^\\top, \\quad J = \\det(F), \\quad V = J V_0.\n$$\n\nCalculation recipe and implementation requirements:\n- Construct a periodic $N_x \\times N_y \\times N_z$ simple cubic supercell with lattice parameter $a$, one atom per lattice site, and only nearest-neighbor bonds along the three coordinate axes. Enumerate each unique bond exactly once by linking each site to its neighbor in the positive $x$, $y$, and $z$ directions with periodic wrapping. The resulting reference bond list is $\\mathcal{N} = \\{R\\}$ with $R \\in \\{(a,0,0), (0,a,0), (0,0,a)\\}$ repeated for each lattice site.\n- For a given deformation gradient $F$, compute the deformed bond vectors $r = F R$ and their lengths $\\lVert r \\rVert$ for all $R \\in \\mathcal{N}$.\n- Using the MD route, compute the Cauchy stress via the virial formula with central forces $f = -\\phi'(\\lVert r \\rVert)\\, r/\\lVert r \\rVert$ and deformed volume $V = J V_0$ as\n$$\n\\sigma_{\\mathrm{MD}} = -\\frac{1}{V} \\sum_{R \\in \\mathcal{N}} r \\otimes f.\n$$\n- Using the Cauchy-Born rule, compute $P(F)$ and then $\\sigma_{\\mathrm{CB}}(F)$ via\n$$\nP(F) = \\frac{1}{V_0} \\sum_{R \\in \\mathcal{N}} \\phi'(\\lVert r \\rVert)\\, \\frac{r}{\\lVert r \\rVert} \\otimes R, \\quad \\sigma_{\\mathrm{CB}} = \\frac{1}{J} P F^\\top.\n$$\n- Quantify the discrepancy between the two stresses for each test case by the maximum absolute component-wise difference:\n$$\n\\Delta = \\max_{i,j} \\left| \\sigma_{\\mathrm{MD},ij} - \\sigma_{\\mathrm{CB},ij} \\right|.\n$$\n\nUnits and parameters:\n- Use reduced units with $a = 1$, $r_0 = 1$, $k = 1$, and the undeformed supercell volume $V_0 = N_x N_y N_z\\, a^3$. In these reduced units, stress is dimensionless. All outputs must be expressed as decimal numbers without any unit symbols.\n\nTest suite:\n- Supercell parameters: $N_x = 4$, $N_y = 4$, $N_z = 4$, $a = 1$, $r_0 = 1$, $k = 1$.\n- Deformation gradients to test:\n    1. $F_1 = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}$ (identity, happy path baseline).\n    2. $F_2 = \\mathrm{diag}(1.10, 1.10, 1.10)$ (isotropic stretch, happy path).\n    3. $F_3 = \\begin{pmatrix} 1 & 0.10 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}$ (simple shear, edge case for off-diagonal stress).\n    4. $F_4 = \\mathrm{diag}(1.20, 0.90, 1.00)$ (anisotropic stretch, edge case with mixed tension/compression).\n\nRequired final output format:\n- Your program should produce a single line of output containing the results for the four test cases as a comma-separated list enclosed in square brackets. Specifically, output\n$$\n[\\Delta(F_1), \\Delta(F_2), \\Delta(F_3), \\Delta(F_4)]\n$$\nwhere each entry is the maximum absolute component-wise difference between $\\sigma_{\\mathrm{MD}}$ and $\\sigma_{\\mathrm{CB}}$ for that test case, represented as a decimal number.",
            "solution": "The problem asks for a comparative analysis of two methods for calculating the Cauchy stress tensor in a homogeneously deformed simple cubic Bravais lattice: the Molecular Dynamics (MD) virial formula and the Cauchy-Born rule. A quantitative measure of the discrepancy between the two is required for a specified set of deformation gradients.\n\n### Step 1: Extract Givens\n- **Lattice and Deformation**: A simple cubic Bravais lattice with lattice parameter $a$. Reference positions are $X = (i\\,a, j\\,a, k\\,a)$. Deformed positions are $x = F X$ for a given deformation gradient $F$. The supercell is a periodic $N_x \\times N_y \\times N_z$ grid.\n- **Interaction Potential**: A harmonic pair potential $\\phi(r) = \\frac{k}{2} (r - r_0)^2$ between nearest neighbors only, where $r$ is the deformed bond length. The forces are central, $f_{ij} = -\\phi'(r)\\,\\hat{r}$ with $\\hat{r} = r_{ij}/r$.\n- **MD Virial Stress**: $\\sigma_{\\mathrm{MD}} = -\\frac{1}{V} \\sum_{(i,j)\\,\\mathrm{pairs}} r_{ij} \\otimes f_{ij}$, where $V$ is the deformed volume.\n- **Cauchy-Born (CB) Rule**:\n    - Strain energy density: $W(F) = \\frac{1}{V_0} \\sum_{R \\in \\mathcal{N}} \\phi(\\lVert F R \\rVert)$, where $V_0$ is the reference volume and $\\mathcal{N}$ is the set of nearest-neighbor reference bond vectors.\n    - First Piola-Kirchhoff stress: $P(F) = \\frac{\\partial W}{\\partial F} = \\frac{1}{V_0} \\sum_{R \\in \\mathcal{N}} \\phi'(\\lVert F R \\rVert)\\, \\frac{F R}{\\lVert F R \\rVert} \\otimes R$.\n    - Cauchy stress: $\\sigma_{\\mathrm{CB}}(F) = \\frac{1}{J} P(F) F^\\top$, with $J = \\det(F)$.\n- **Calculation Simplification**: The sum $\\sum_{R \\in \\mathcal{N}}$ over all bonds in the supercell can be used in both the MD and CB stress formulas.\n- **Discrepancy Metric**: $\\Delta = \\max_{i,j} \\left| \\sigma_{\\mathrm{MD},ij} - \\sigma_{\\mathrm{CB},ij} \\right|$.\n- **Parameters**:\n    - Reduced units: $a = 1$, $r_0 = 1$, $k = 1$.\n    - Supercell dimensions: $N_x = 4$, $N_y = 4$, $N_z = 4$.\n- **Test Cases**:\n    1. $F_1 = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}$\n    2. $F_2 = \\mathrm{diag}(1.10, 1.10, 1.10)$\n    3. $F_3 = \\begin{pmatrix} 1 & 0.10 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}$\n    4. $F_4 = \\mathrm{diag}(1.20, 0.90, 1.00)$\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement is scientifically grounded, well-posed, and objective. It describes a standard verification exercise in computational materials science. The provided formulas for virial stress and the Cauchy-Born rule are standard. All parameters and constants are specified, and the test cases are well-defined. The problem asks for the implementation of two distinct computational pathways to arrive at the same physical quantity. A crucial aspect of this problem is to recognize the theoretical relationship between the two stress measures under the given assumptions. For a Bravais lattice subjected to a homogeneous deformation and interacting via central pair potentials, the Cauchy-Born approximation is exact. This means that the MD virial stress and the Cauchy-Born stress must be identical.\n\nLet us demonstrate this equivalence. The derivative of the harmonic potential is $\\phi'(r) = k(r - r_0)$. The central force vector is $f = -\\phi'(r) \\frac{r}{r}$.\n\nThe MD virial stress is given as:\n$$\n\\sigma_{\\mathrm{MD}} = -\\frac{1}{V} \\sum_{R \\in \\mathcal{N}} r \\otimes f\n$$\nHere, the sum is over the set of all $3 N_{tot}$ unique directed nearest-neighbor bonds in the reference configuration. The vector $r$ is the deformed image of a reference bond vector $R$, so $r = F R$. Substituting the expression for the force $f$:\n$$\n\\sigma_{\\mathrm{MD}} = -\\frac{1}{V} \\sum_{R \\in \\mathcal{N}} r \\otimes \\left( -\\phi'(\\lVert r \\rVert) \\frac{r}{\\lVert r \\rVert} \\right) = \\frac{1}{V} \\sum_{R \\in \\mathcal{N}} \\frac{\\phi'(\\lVert r \\rVert)}{\\lVert r \\rVert} (r \\otimes r)\n$$\nIn component form, this is:\n$$\n\\sigma_{\\mathrm{MD},ij} = \\frac{1}{V} \\sum_{R \\in \\mathcal{N}} \\frac{\\phi'(\\lVert FR \\rVert)}{\\lVert FR \\rVert} (FR)_i (FR)_j\n$$\n\nNow, let's analyze the Cauchy-Born stress, $\\sigma_{\\mathrm{CB}} = \\frac{1}{J} P F^\\top$, where $P$ is the first Piola-Kirchhoff stress.\n$$\nP(F) = \\frac{1}{V_0} \\sum_{R \\in \\mathcal{N}} \\phi'(\\lVert F R \\rVert)\\, \\frac{F R}{\\lVert F R \\rVert} \\otimes R = \\frac{1}{V_0} \\sum_{R \\in \\mathcal{N}} \\frac{\\phi'(\\lVert r \\rVert)}{\\lVert r \\rVert} (r \\otimes R)\n$$\nNow, we compute the Cauchy stress $\\sigma_{\\mathrm{CB}}$ by post-multiplying by $F^\\top$ and scaling by $1/J$.\n$$\n\\sigma_{\\mathrm{CB}} = \\frac{1}{J} P F^\\top = \\frac{1}{J} \\left( \\frac{1}{V_0} \\sum_{R \\in \\mathcal{N}} \\frac{\\phi'(\\lVert r \\rVert)}{\\lVert r \\rVert} (r \\otimes R) \\right) F^\\top\n$$\nUsing the identity $(u \\otimes v) A = u \\otimes (A^\\top v)$ for vectors $u, v$ and matrix $A$, we apply this to each term in the sum with $A=F^\\top$:\n$$\n(r \\otimes R) F^\\top = r \\otimes ((F^\\top)^\\top R) = r \\otimes (F R) = r \\otimes r\n$$\nSubstituting this back and using $V = J V_0$:\n$$\n\\sigma_{\\mathrm{CB}} = \\frac{1}{J V_0} \\sum_{R \\in \\mathcal{N}} \\frac{\\phi'(\\lVert r \\rVert)}{\\lVert r \\rVert} (r \\otimes r) = \\frac{1}{V} \\sum_{R \\in \\mathcal{N}} \\frac{\\phi'(\\lVert r \\rVert)}{\\lVert r \\rVert} (r \\otimes r)\n$$\nThis expression is identical to the one derived for $\\sigma_{\\mathrm{MD}}$.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. It is a well-posed computational task to verify a fundamental principle of continuum mechanics: the equivalence of the microscopic virial stress and the macroscopic Cauchy-Born stress for a homogeneously deformed Bravais lattice. The expected outcome is that the discrepancy $\\Delta$ will be zero, or a very small number on the order of floating-point precision, for all test cases. The task is to implement both computational paths and confirm this result numerically.\n\n### Algorithmic Solution\nThe solution will proceed by implementing the calculations for both stress tensors for each given deformation gradient $F$.\n\n1.  **Initialization**: Define the physical and simulation parameters: $a=1, r_0=1, k=1, N_x=4, N_y=4, N_z=4$. Calculate the total number of atoms, $N_{tot} = N_x N_y N_z = 64$, and the undeformed supercell volume, $V_0 = N_{tot} a^3 = 64$. The set of unique reference bond types originating from a single lattice site is $R_{base} = \\{ (a,0,0), (0,a,0), (0,0,a) \\}$.\n\n2.  **Iterate through Test Cases**: For each provided matrix $F$:\n    a.  Calculate the Jacobian determinant $J = \\det(F)$ and the deformed volume $V = J V_0$.\n    b.  Initialize two $3 \\times 3$ matrices, `sigma_md_sum` and `p_cb_sum`, to zero. These will accumulate the sums for the MD stress and the PK1 stress, respectively, for a single representative atom.\n    c.  Loop through each base reference bond vector $R$ in $R_{base}$:\n        i.  Compute the deformed bond vector $r = F R$.\n        ii. Calculate its norm, $\\lVert r \\rVert$.\n        iii. Evaluate the potential derivative, $\\phi'(\\lVert r \\rVert) = k (\\lVert r \\rVert - r_0)$.\n        iv. Compute the common scalar factor $s = \\phi'(\\lVert r \\rVert) / \\lVert r \\rVert$. Note that for all given test cases, $\\lVert r \\rVert \\neq 0$.\n        v.  Update the MD sum: `sigma_md_sum` += $s (r \\otimes r)$. The outer product $r \\otimes r$ is a $3 \\times 3$ matrix.\n        vi. Update the PK1 sum: `p_cb_sum` += $s (r \\otimes R)$.\n\n3.  **Finalize Stress Tensors**:\n    a.  The total sums for the supercell are $N_{tot}$ times the single-atom sums due to homogeneity.\n    b.  Calculate the MD Cauchy stress: $\\sigma_{\\mathrm{MD}} = \\frac{N_{tot}}{V} \\times \\text{sigma\\_md\\_sum}$.\n    c.  Calculate the CB First Piola-Kirchhoff stress: $P_{\\mathrm{CB}} = \\frac{N_{tot}}{V_0} \\times \\text{p\\_cb\\_sum}$.\n    d.  Transform to the CB Cauchy stress: $\\sigma_{\\mathrm{CB}} = \\frac{1}{J} P_{\\mathrm{CB}} F^\\top$.\n\n4.  **Compute Discrepancy**:\n    a.  Calculate the element-wise difference matrix $|\\sigma_{\\mathrm{MD}} - \\sigma_{\\mathrm{CB}}|$.\n    b.  Find the maximum value in this difference matrix, $\\Delta = \\max_{i,j} \\left| \\sigma_{\\mathrm{MD},ij} - \\sigma_{\\mathrm{CB},ij} \\right|$.\n\n5.  **Store and Output**: Store the computed $\\Delta$ for each test case. Finally, format the results into the required string `[d1,d2,d3,d4]`. As established, these values are expected to be nearly zero.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the discrepancy between the MD virial stress and the Cauchy-Born\n    stress for a homogeneously deformed simple cubic lattice.\n    \"\"\"\n    \n    # Define physical parameters and supercell dimensions from the problem statement.\n    # Using reduced units.\n    a = 1.0  # lattice parameter\n    r0 = 1.0 # rest length of harmonic spring\n    k = 1.0  # spring constant\n    Nx, Ny, Nz = 4, 4, 4 # supercell size in lattice units\n    \n    # Calculate total number of atoms and reference volume\n    N_tot = Nx * Ny * Nz\n    V0 = N_tot * a**3\n    \n    # Define the set of unique nearest-neighbor bond vectors in the reference state\n    # originating from a single lattice site.\n    R_base = [\n        np.array([a, 0.0, 0.0]),\n        np.array([0.0, a, 0.0]),\n        np.array([0.0, 0.0, a])\n    ]\n    \n    # Define the test cases for the deformation gradient F.\n    test_cases = [\n        # Case 1: Identity\n        np.array([[1.0, 0.0, 0.0], [0.0, 1.0, 0.0], [0.0, 0.0, 1.0]]),\n        # Case 2: Isotropic stretch\n        np.array([[1.1, 0.0, 0.0], [0.0, 1.1, 0.0], [0.0, 0.0, 1.1]]),\n        # Case 3: Simple shear\n        np.array([[1.0, 0.1, 0.0], [0.0, 1.0, 0.0], [0.0, 0.0, 1.0]]),\n        # Case 4: Anisotropic stretch\n        np.array([[1.2, 0.0, 0.0], [0.0, 0.9, 0.0], [0.0, 0.0, 1.0]])\n    ]\n\n    results = []\n    \n    for F in test_cases:\n        # Calculate Jacobian and deformed volume\n        J = np.linalg.det(F)\n        V = J * V0\n        \n        # Initialize sums for a single representative atom.\n        # Due to homogeneity, we can calculate the contribution from one atom's\n        # bonds and multiply by the total number of atoms.\n        sigma_md_sum = np.zeros((3, 3))\n        p_cb_sum = np.zeros((3, 3))\n\n        # Loop over the three unique bond directions\n        for R in R_base:\n            # Deformed bond vector\n            r = F @ R\n            # Norm of the deformed bond vector\n            r_norm = np.linalg.norm(r)\n            \n            # Derivative of the harmonic potential: phi'(r) = k * (r - r0)\n            phi_prime = k * (r_norm - r0)\n            \n            # This scalar factor appears in both stress formulations.\n            # Avoid division by zero, although not expected in these test cases.\n            if r_norm == 0.0:\n                s = 0.0\n            else:\n                s = phi_prime / r_norm\n            \n            # Accumulate MD stress contribution (from r tensor r)\n            sigma_md_sum += s * np.outer(r, r)\n            \n            # Accumulate PK1 stress contribution (from r tensor R)\n            p_cb_sum += s * np.outer(r, R)\n            \n        # Calculate the final stress tensors by scaling the sums.\n        # The sum over all bonds in the supercell is N_tot times the sum for one atom.\n        \n        # 1. MD Virial Cauchy Stress\n        # sigma_MD = (1/V) * sum_over_all_bonds(...)\n        sigma_md = (N_tot / V) * sigma_md_sum\n        \n        # 2. Cauchy-Born Stress\n        # First, calculate the First Piola-Kirchhoff (PK1) stress P\n        # P = (1/V0) * sum_over_all_bonds(...)\n        P_cb = (N_tot / V0) * p_cb_sum\n        \n        # Then, convert PK1 stress to Cauchy stress\n        # sigma_CB = (1/J) * P * F^T\n        sigma_cb = (1.0 / J) * (P_cb @ F.T)\n        \n        # Calculate the discrepancy as the max absolute difference of components\n        discrepancy = np.max(np.abs(sigma_md - sigma_cb))\n        results.append(discrepancy)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The classical Cauchy-Born rule assumes the crystal deforms uniformly, but what happens when the material can exist in multiple stable or metastable states? This exercise  delves into this advanced scenario by presenting a non-convex energy landscape, which is characteristic of materials undergoing phase transformations. You will discover that for certain deformations, the system can lower its energy by forming a fine-scale mixture of phases, a concept captured mathematically by the convex envelope of the energy function. This practice reveals the theoretical origins of microstructure and introduces a powerful tool for predicting the behavior of complex materials.",
            "id": "3845544",
            "problem": "A one-dimensional Bravais lattice with reference spacing is deformed homogeneously by a stretch $\\lambda$. The per-bond interaction potential favors two crystallographic variants with preferred stretches $a$ and $b$, with $a<b$. In the neighborhood of each variant, assume a quadratic approximation for the per-bond energy about that variant, leading to the following multi-well continuum energy density under the Cauchy-Born assumption:\n$$\nW_{\\mathrm{CB}}(\\lambda) \\equiv \\min\\left\\{ \\frac{\\mu}{2}\\,(\\lambda-a)^{2},\\; \\frac{\\mu}{2}\\,(\\lambda-b)^{2} + \\Delta \\right\\},\n$$\nwhere $\\mu>0$ is a stiffness and $\\Delta>0$ is an energy offset that favors the $a$-variant. This construction produces a nonconvex energy with two wells.\n\nStarting only from the principles that (i) the Cauchy-Born rule equates atomic bond stretches to the macroscopic stretch in a homogeneous state, and (ii) in one space dimension, the energy relaxed by arbitrarily fine compatible microstructures equals the convex envelope of the stored-energy function, derive the relaxed energy attainable by laminates of the two variants. In particular, determine the explicit analytic expression of the linear segment of the convex envelope that replaces the nonconvex region of $W_{\\mathrm{CB}}(\\lambda)$ when $\\mu$ is the same for both wells.\n\nThen, for the specific parameter values $a=0.9$, $b=1.1$, $\\mu=200$, $\\Delta=0.02$ (all nondimensional), and a prescribed macroscopic stretch $\\bar{\\lambda}=1.0$, compute the relaxed energy per unit reference length achieved by optimal microstructure. Express the final energy in nondimensional units and round your answer to four significant figures.",
            "solution": "The problem statement is first validated against the required criteria.\n\n### Step 1: Extract Givens\n-   **System**: A one-dimensional Bravais lattice with reference spacing.\n-   **Deformation**: A homogeneous stretch $\\lambda$.\n-   **Energy Density**: The Cauchy-Born energy density is given by $W_{\\mathrm{CB}}(\\lambda) \\equiv \\min\\left\\{ \\frac{\\mu}{2}\\,(\\lambda-a)^{2},\\; \\frac{\\mu}{2}\\,(\\lambda-b)^{2} + \\Delta \\right\\}$.\n-   **Parameters**:\n    -   $a$ and $b$ are preferred stretches for two crystallographic variants, with $a<b$.\n    -   $\\mu > 0$ is a stiffness parameter.\n    -   $\\Delta > 0$ is an energy offset.\n-   **Principles**:\n    -   (i) The Cauchy-Born rule equates atomic bond stretches to the macroscopic stretch $\\lambda$ in a homogeneous state.\n    -   (ii) The relaxed energy achievable by arbitrarily fine compatible microstructures (laminates) is the convex envelope of the stored-energy function.\n-   **Task 1 (Analytical)**: Derive the explicit analytic expression of the linear segment of the convex envelope that replaces the nonconvex region of $W_{\\mathrm{CB}}(\\lambda)$.\n-   **Task 2 (Numerical)**: For the specific parameter values $a=0.9$, $b=1.1$, $\\mu=200$, $\\Delta=0.02$, and a prescribed macroscopic stretch $\\bar{\\lambda}=1.0$, compute the relaxed energy per unit reference length.\n-   **Output Requirement**: Round the final numerical answer to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem is based on the well-established theory of continuum mechanics for materials with phase transitions. The use of a multi-well energy function, the Cauchy-Born rule, and energy relaxation via convexification are standard tools in the study of microstructure formation. The quadratic energy wells represent a common and valid approximation near equilibrium states. The setup is scientifically sound.\n2.  **Well-Posed**: The problem is mathematically well-posed. Finding the convex envelope of a continuous, piecewise-defined function is a standard procedure in convex analysis. All necessary functions and parameters are defined, and the task is to perform a specific derivation and calculation. A unique solution exists.\n3.  **Objective**: The problem is stated in precise, objective mathematical language, free from ambiguity or subjective content.\n4.  **Completeness and Consistency**: The problem is self-contained. All parameters are provided for both the analytical derivation and the numerical calculation. There are no contradictions in the provided information.\n\n### Step 3: Verdict and Action\nThe problem is deemed valid. A full solution will be provided.\n\n### Solution Derivation\n\nThe relaxed energy of the system, attainable by forming fine-scale laminates of the two variants, is the convex envelope of the Cauchy-Born energy density $W_{\\mathrm{CB}}(\\lambda)$. Let us denote this relaxed energy by $W^{**}(\\lambda)$.\n\nThe function $W_{\\mathrm{CB}}(\\lambda)$ is the lower envelope of two parabolas:\n$W_a(\\lambda) = \\frac{\\mu}{2}(\\lambda-a)^2$\n$W_b(\\lambda) = \\frac{\\mu}{2}(\\lambda-b)^2 + \\Delta$\n\nSince $a<b$ and $\\Delta>0$, the parabola $W_a$ has its minimum at a smaller stretch and the minimum value is $0$, while $W_b$ has its minimum at a larger stretch and the minimum value is $\\Delta$. The overall energy function $W_{\\mathrm{CB}}(\\lambda)$ has two wells and is non-convex in the region between them. The convex envelope, $W^{**}(\\lambda)$, is constructed by replacing the non-convex part of $W_{\\mathrm{CB}}(\\lambda)$ with a common tangent to the two parabolic wells, $W_a(\\lambda)$ and $W_b(\\lambda)$.\n\nLet the equation of this common tangent line be $L(\\lambda)$. This line is tangent to $W_a(\\lambda)$ at a point $\\lambda_1$ and to $W_b(\\lambda)$ at a point $\\lambda_2$. At these points of tangency, the slope of the line must equal the slope of the respective parabola.\nThe derivatives of the energy functions are:\n$W_a'(\\lambda) = \\mu(\\lambda-a)$\n$W_b'(\\lambda) = \\mu(\\lambda-b)$\n\nThe condition for a common tangent slope, $m$, is:\n$m = W_a'(\\lambda_1) = \\mu(\\lambda_1 - a)$\n$m = W_b'(\\lambda_2) = \\mu(\\lambda_2 - b)$\nEquating these gives $\\mu(\\lambda_1 - a) = \\mu(\\lambda_2 - b)$, which simplifies to $\\lambda_1 - a = \\lambda_2 - b$, or $\\lambda_2 - \\lambda_1 = b - a$.\n\nThe slope $m$ of the tangent line must also be equal to the slope of the secant line connecting the two points of tangency, $(\\lambda_1, W_a(\\lambda_1))$ and $(\\lambda_2, W_b(\\lambda_2))$:\n$$m = \\frac{W_b(\\lambda_2) - W_a(\\lambda_1)}{\\lambda_2 - \\lambda_1}$$\nSubstituting the expressions for the energies and the relation $\\lambda_2 - \\lambda_1 = b - a$:\n$$m = \\frac{\\left(\\frac{\\mu}{2}(\\lambda_2 - b)^2 + \\Delta\\right) - \\left(\\frac{\\mu}{2}(\\lambda_1 - a)^2\\right)}{b-a}$$\nUsing the fact that $\\lambda_1 - a = \\lambda_2 - b$, the quadratic terms cancel out:\n$$m = \\frac{\\frac{\\mu}{2}(\\lambda_1 - a)^2 + \\Delta - \\frac{\\mu}{2}(\\lambda_1 - a)^2}{b-a} = \\frac{\\Delta}{b-a}$$\nNow we can determine the points of tangency, $\\lambda_1$ and $\\lambda_2$, by substituting this expression for $m$ back into the derivative equations:\n$\\mu(\\lambda_1 - a) = \\frac{\\Delta}{b-a} \\implies \\lambda_1 = a + \\frac{\\Delta}{\\mu(b-a)}$\n$\\mu(\\lambda_2 - b) = \\frac{\\Delta}{b-a} \\implies \\lambda_2 = b + \\frac{\\Delta}{\\mu(b-a)}$\n\nThe problem asks for the explicit analytic expression of the linear segment of the convex envelope. This is the equation of the line $L(\\lambda)$ for $\\lambda \\in [\\lambda_1, \\lambda_2]$. We can find this using the point-slope form with the point $(\\lambda_1, W_a(\\lambda_1))$ and slope $m$.\nFirst, calculate the energy at $\\lambda_1$:\n$W_a(\\lambda_1) = \\frac{\\mu}{2}(\\lambda_1-a)^2 = \\frac{\\mu}{2}\\left(\\frac{\\Delta}{\\mu(b-a)}\\right)^2 = \\frac{\\Delta^2}{2\\mu(b-a)^2}$\nThe equation for the line $L(\\lambda)$ is:\n$L(\\lambda) = W_a(\\lambda_1) + m(\\lambda - \\lambda_1)$\n$L(\\lambda) = \\frac{\\Delta^2}{2\\mu(b-a)^2} + \\frac{\\Delta}{b-a}\\left(\\lambda - \\left(a + \\frac{\\Delta}{\\mu(b-a)}\\right)\\right)$\n$L(\\lambda) = \\frac{\\Delta^2}{2\\mu(b-a)^2} + \\frac{\\Delta}{b-a}(\\lambda-a) - \\frac{\\Delta^2}{\\mu(b-a)^2}$\n$L(\\lambda) = \\frac{\\Delta}{b-a}(\\lambda-a) - \\frac{\\Delta^2}{2\\mu(b-a)^2}$\nThis is the analytic expression for the linear segment of the convex envelope, valid for macroscopic stretches $\\lambda$ in the interval $[\\lambda_1, \\lambda_2]$. For a stretch $\\bar{\\lambda}$ in this interval, the material forms a laminate of the two variants, with the variants having stretches $\\lambda_1$ and $\\lambda_2$.\n\n### Numerical Calculation\n\nWe are given the parameter values: $a=0.9$, $b=1.1$, $\\mu=200$, $\\Delta=0.02$, and a prescribed macroscopic stretch $\\bar{\\lambda}=1.0$.\n\nFirst, we determine the interval $[\\lambda_1, \\lambda_2]$ to check if $\\bar{\\lambda}$ falls within it.\n$b - a = 1.1 - 0.9 = 0.2$\n$\\lambda_1 = a + \\frac{\\Delta}{\\mu(b-a)} = 0.9 + \\frac{0.02}{200 \\times 0.2} = 0.9 + \\frac{0.02}{40} = 0.9 + 0.0005 = 0.9005$\n$\\lambda_2 = b + \\frac{\\Delta}{\\mu(b-a)} = 1.1 + \\frac{0.02}{200 \\times 0.2} = 1.1 + 0.0005 = 1.1005$\n\nThe interval is $[\\lambda_1, \\lambda_2] = [0.9005, 1.1005]$. The prescribed macroscopic stretch is $\\bar{\\lambda}=1.0$. Since $0.9005 < 1.0 < 1.1005$, the stretch $\\bar{\\lambda}$ lies within the interval of microstructural mixing. The relaxed energy is therefore given by $W^{**}(\\bar{\\lambda}) = L(\\bar{\\lambda})$.\n\nWe now compute $L(1.0)$ using the derived expression:\n$L(\\bar{\\lambda}) = \\frac{\\Delta}{b-a}(\\bar{\\lambda}-a) - \\frac{\\Delta^2}{2\\mu(b-a)^2}$\nSubstitute the numerical values:\n$L(1.0) = \\frac{0.02}{0.2}(1.0 - 0.9) - \\frac{(0.02)^2}{2 \\times 200 \\times (0.2)^2}$\n$L(1.0) = 0.1 \\times 0.1 - \\frac{0.0004}{2 \\times 200 \\times 0.04}$\n$L(1.0) = 0.01 - \\frac{0.0004}{16}$\n$L(1.0) = 0.01 - 0.000025$\n$L(1.0) = 0.009975$\n\nThe relaxed energy is $0.009975$. The problem requests the answer to be rounded to four significant figures. The number $0.009975$ already has exactly four significant figures (9, 9, 7, 5). Therefore, no further rounding is needed.\nThe relaxed energy per unit reference length is $0.009975$ in nondimensional units.",
            "answer": "$$\n\\boxed{0.009975}\n$$"
        }
    ]
}