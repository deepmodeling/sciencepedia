{
    "hands_on_practices": [
        {
            "introduction": "The formation energy of any defect fundamentally depends on the availability of its constituent atoms, a factor governed by their respective chemical potentials, $\\mu_i$. For a stable compound material, these chemical potentials are not arbitrary; they are constrained within a multidimensional region of thermodynamic stability, with boundaries defined by equilibrium conditions with competing phases. This exercise  provides hands-on practice in a foundational step for any defect study: calculating this allowed range of chemical potentials, ensuring that subsequent formation energy calculations are performed under physically meaningful and well-defined thermodynamic conditions.",
            "id": "3800266",
            "problem": "Consider a binary compound AB treated within a zero-temperature, zero-pressure thermodynamic framework suitable for first-principles supercell defect calculations. Let the chemical potentials of the elements be denoted by $\\mu_{A}$ and $\\mu_{B}$, and let the elemental reference states be $\\mu_{A}^{\\text{ref}}$ and $\\mu_{B}^{\\text{ref}}$, respectively. Define the chemical potential deviations $\\Delta \\mu_{i} \\equiv \\mu_{i} - \\mu_{i}^{\\text{ref}}$ for $i \\in \\{A,B\\}$, and the formation enthalpy per formula unit of a compound $A_{x}B_{y}$ at zero temperature by $\\Delta H_{f}(A_{x}B_{y}) \\equiv \\mu(A_{x}B_{y}) - x\\,\\mu_{A}^{\\text{ref}} - y\\,\\mu_{B}^{\\text{ref}}$. Assume that $\\Delta H_{f}$ is known for the stoichiometries AB, $A_{2}B$, and $AB_{2}$, and that the compound AB is stable against decomposition.\n\nStarting from these definitions and the thermodynamic requirement that, in equilibrium with AB, no other phase (including the pure elements) can lower the Gibbs free energy, derive the admissible region in the $(\\Delta \\mu_{A}, \\Delta \\mu_{B})$ plane consistent with the stability of AB and the non-precipitation of competing phases. Use the following data, given in electronvolts per formula unit: $\\Delta H_{f}(\\text{AB}) = -0.70$, $\\Delta H_{f}(A_{2}B) = -1.10$, and $\\Delta H_{f}(AB_{2}) = -0.90$. Then determine the numerical width of the allowable interval for $\\Delta \\mu_{A}$ along the line of equilibrium with AB. Express your answer in electronvolts. Round your answer to three significant figures.",
            "solution": "The problem requires determining the thermodynamically allowed range for the chemical potential of element A, $\\mu_A$, for a binary compound AB to be stable at zero temperature and pressure. This range is often referred to as the chemical potential stability window. We are given the formation enthalpies of the host compound AB and two potential competing phases, $A_2B$ and $AB_2$.\n\nThe analysis is performed in the space of chemical potential deviations from their reference states, defined as $\\Delta \\mu_{i} \\equiv \\mu_{i} - \\mu_{i}^{\\text{ref}}$ for $i \\in \\{A,B\\}$.\n\nFirst, we establish the condition for thermodynamic equilibrium between the elemental constituents and the compound AB. At zero temperature, the chemical potential of a solid compound is its total energy per formula unit. For two-phase equilibrium between A, B, and the compound AB, the chemical potentials must satisfy:\n$$ \\mu_A + \\mu_B = \\mu(AB) $$\nThe formation enthalpy of a compound $A_x B_y$ is defined as $\\Delta H_{f}(A_{x}B_{y}) \\equiv \\mu(A_{x}B_{y}) - x\\,\\mu_{A}^{\\text{ref}} - y\\,\\mu_{B}^{\\text{ref}}$. For AB, this is $\\Delta H_f(AB) = \\mu(AB) - \\mu_A^{\\text{ref}} - \\mu_B^{\\text{ref}}$.\nSubstituting the definitions into the equilibrium condition:\n$$ (\\Delta \\mu_A + \\mu_A^{\\text{ref}}) + (\\Delta \\mu_B + \\mu_B^{\\text{ref}}) = \\Delta H_f(AB) + \\mu_A^{\\text{ref}} + \\mu_B^{\\text{ref}} $$\nThis simplifies to a linear relationship between the chemical potential deviations:\n$$ \\Delta \\mu_A + \\Delta \\mu_B = \\Delta H_f(AB) $$\nUsing the given value $\\Delta H_f(AB) = -0.70$ eV, we have:\n$$ \\Delta \\mu_A + \\Delta \\mu_B = -0.70 \\quad (1) $$\nThis equation defines a line in the $(\\Delta \\mu_A, \\Delta \\mu_B)$ plane along which the system is in equilibrium with the AB compound.\n\nNext, we impose the stability conditions. For the compound AB to be stable, it must be more stable than any competing phase. This means that its formation must not be preceded by the precipitation of pure elements A or B, or any other competing compound.\n\n1.  **Stability against precipitation of pure elements:** The chemical potential of an element cannot exceed its value in the stable elemental reference phase. If it did, the pure element would precipitate.\n    $$ \\mu_A \\le \\mu_A^{\\text{ref}} \\implies \\Delta \\mu_A \\le 0 $$\n    $$ \\mu_B \\le \\mu_B^{\\text{ref}} \\implies \\Delta \\mu_B \\le 0 $$\n    These conditions define the A-rich ($\\Delta \\mu_A = 0$) and B-rich ($\\Delta \\mu_B = 0$) limits.\n\n2.  **Stability against precipitation of competing compounds:** The formation of any other compound $A_x B_y$ must be thermodynamically unfavorable. This implies that the weighted sum of chemical potentials of its constituents must be less than or equal to the chemical potential of that compound:\n    $$ x \\mu_A + y \\mu_B \\le \\mu(A_x B_y) $$\n    We can rewrite this in terms of $\\Delta \\mu$ and $\\Delta H_f$:\n    $$ x (\\Delta \\mu_A + \\mu_A^{\\text{ref}}) + y (\\Delta \\mu_B + \\mu_B^{\\text{ref}}) \\le \\Delta H_f(A_x B_y) + x \\mu_A^{\\text{ref}} + y \\mu_B^{\\text{ref}} $$\n    $$ x \\Delta \\mu_A + y \\Delta \\mu_B \\le \\Delta H_f(A_x B_y) $$\n\n    Applying this to the competing phases $A_2 B$ and $AB_2$:\n    For $A_2 B$ ($x=2, y=1$):\n    $$ 2 \\Delta \\mu_A + \\Delta \\mu_B \\le \\Delta H_f(A_2 B) $$\n    Using the given data, $\\Delta H_f(A_2 B) = -1.10$ eV:\n    $$ 2 \\Delta \\mu_A + \\Delta \\mu_B \\le -1.10 \\quad (2) $$\n    For $AB_2$ ($x=1, y=2$):\n    $$ \\Delta \\mu_A + 2 \\Delta \\mu_B \\le \\Delta H_f(AB_2) $$\n    Using the given data, $\\Delta H_f(AB_2) = -0.90$ eV:\n    $$ \\Delta \\mu_A + 2 \\Delta \\mu_B \\le -0.90 \\quad (3) $$\n\nThe allowable range for the chemical potentials is the segment of the equilibrium line (1) that satisfies all the stability inequalities. We can find this range by substituting the equilibrium condition into the inequalities. From eq. (1), we have $\\Delta \\mu_B = -0.70 - \\Delta \\mu_A$.\n\nSubstituting this into inequality (2):\n$$ 2 \\Delta \\mu_A + (-0.70 - \\Delta \\mu_A) \\le -1.10 $$\n$$ \\Delta \\mu_A - 0.70 \\le -1.10 $$\n$$ \\Delta \\mu_A \\le -0.40 $$\nThis gives the upper bound for $\\Delta \\mu_A$. This boundary corresponds to equilibrium between AB and $A_2B$.\n\nSubstituting $\\Delta \\mu_B = -0.70 - \\Delta \\mu_A$ into inequality (3):\n$$ \\Delta \\mu_A + 2 (-0.70 - \\Delta \\mu_A) \\le -0.90 $$\n$$ \\Delta \\mu_A - 1.40 - 2 \\Delta \\mu_A \\le -0.90 $$\n$$ - \\Delta \\mu_A \\le 0.50 $$\n$$ \\Delta \\mu_A \\ge -0.50 $$\nThis gives the lower bound for $\\Delta \\mu_A$. This boundary corresponds to equilibrium between AB and $AB_2$.\n\nThe stability conditions from the pure elements, $\\Delta \\mu_A \\le 0$ and $\\Delta \\mu_B \\le 0$, must also be checked.\nThe derived range for $\\Delta \\mu_A$ is $[-0.50, -0.40]$. Since all values in this range are less than or equal to $0$, the condition $\\Delta \\mu_A \\le 0$ is satisfied.\nFor $\\Delta \\mu_B \\le 0$, we have $-0.70 - \\Delta \\mu_A \\le 0$, which means $\\Delta \\mu_A \\ge -0.70$. Since the derived range $[-0.50, -0.40]$ is entirely within $[-0.70, \\infty)$, this condition is also satisfied.\nThus, the competing compounds $A_2B$ and $AB_2$ provide more stringent constraints than the pure elements.\n\nThe full admissible interval for $\\Delta \\mu_A$ along the line of equilibrium with AB is:\n$$ -0.50 \\le \\Delta \\mu_A \\le -0.40 $$\nThe width of this allowable interval, which represents the stability range of the compound AB, is the difference between the maximum and minimum values of $\\Delta \\mu_A$:\n$$ \\text{Width} = (\\text{max } \\Delta \\mu_A) - (\\text{min } \\Delta \\mu_A) = (-0.40) - (-0.50) = 0.10 \\, \\text{eV} $$\nThe problem asks for the answer to be rounded to three significant figures.\n$$ \\text{Width} = 0.100 \\, \\text{eV} $$",
            "answer": "$$ \\boxed{0.100} $$"
        },
        {
            "introduction": "A central challenge in simulating charged defects is that the use of periodic boundary conditions in finite supercells introduces spurious electrostatic interactions between a defect and its periodic images. To obtain physically meaningful formation energies, these finite-size artifacts must be corrected. This coding exercise  moves beyond theory by guiding you through a concrete implementation of the Freysoldt, Neugebauer, and Van de Walle (FNV) correction, a state-of-the-art method that systematically removes these errors by decomposing the electrostatic potential and performing a careful potential alignment. This practice will equip you with a critical computational tool essential for achieving accurate results in modern materials simulations.",
            "id": "3800267",
            "problem": "You are tasked with implementing the Freysoldt, Neugebauer, and Van de Walle (FNV) correction for charged defects using a principled decomposition of the defect-induced electrostatic potential into long-range and short-range components, and computing the correction energy from planar-averaged potentials. The Freysoldt, Neugebauer, and Van de Walle (FNV) method requires computing a model long-range potential from fundamental electrostatics, isolating the short-range contribution, performing potential alignment in a far-field region, and combining this alignment with the image-charge energy to obtain the correction. All energies must be expressed in electronvolt (eV).\n\nFundamental base assumptions and definitions:\n- Start from the electrostatic Poisson equation in matter, given by $$\\nabla^2 V(\\mathbf{r}) = - \\frac{\\rho(\\mathbf{r})}{\\epsilon_0 \\epsilon},$$ where $V(\\mathbf{r})$ is the electrostatic potential, $\\rho(\\mathbf{r})$ is the charge density, $\\epsilon_0$ is the vacuum permittivity, and $\\epsilon$ is the scalar relative permittivity (dielectric constant).\n- Consider a three-dimensional periodic supercell with dimensions $L_x$, $L_y$, and $L_z$ and total volume $V_{\\text{cell}} = L_x L_y L_z$, containing a localized defect of charge $q$ (in units of the elementary charge) at position $z_0$ along the $z$ direction. To enforce charge neutrality in a periodic calculation, a uniform compensating background charge density is assumed.\n- Planar averaging reduces the problem to one dimension by averaging over planes perpendicular to the $z$ axis. Define the planar-averaged charge density as $$\\bar{\\rho}(z) = \\frac{q}{A} \\delta(z - z_0) - \\frac{q}{A L_z},$$ where $A = L_x L_y$ and $\\delta$ is the Dirac delta. This enforces neutrality since $$\\int_0^{L_z} \\bar{\\rho}(z)\\, \\mathrm{d}z = 0.$$\n- The planar-averaged electrostatic potential $V(z)$ obeys the one-dimensional Poisson equation under periodic boundary conditions and zero-average gauge, $$- \\epsilon_0 \\epsilon \\frac{\\mathrm{d}^2 V(z)}{\\mathrm{d}z^2} = \\bar{\\rho}(z), \\quad V(0)=V(L_z), \\quad \\int_0^{L_z} V(z)\\, \\mathrm{d}z = 0.$$\n- The one-dimensional periodic Green’s function $G(z,z_0)$ solves $$- \\frac{\\mathrm{d}^2 G(z,z_0)}{\\mathrm{d}z^2} = \\delta(z-z_0) - \\frac{1}{L_z},$$ with periodic boundary conditions and zero mean. Using the shortest arc distance on the ring $s(z) = \\min(|z - z_0|, L_z - |z - z_0|)$, the Green’s function has the closed form $$G(z,z_0) = \\frac{s(z)\\,(L_z - s(z))}{2 L_z} - \\frac{L_z}{12}.$$\n- The model long-range planar-averaged potential is then $$V_{\\text{lr}}(z) = \\frac{q}{\\epsilon_0 \\epsilon A} G(z,z_0).$$ For numerical work and to express energies in electronvolt (eV), use the Coulomb prefactor in electronvolt–angstrom units $$k_e = \\frac{e^2}{4 \\pi \\epsilon_0} \\approx 14.399645\\ \\mathrm{eV}\\, \\mathrm{\\AA},$$ and write $$V_{\\text{lr}}(z) = \\frac{k_e}{\\epsilon}\\, \\frac{q}{A}\\, \\left( \\frac{s(z)\\,(L_z - s(z))}{2 L_z} - \\frac{L_z}{12} \\right),$$ ensuring that $L_x$, $L_y$, $L_z$, and $s(z)$ are provided in angstroms so that $V_{\\text{lr}}(z)$ is in electronvolt (eV).\n- The potential due to the defect from a first-principles calculation is represented by the planar-averaged potential difference $$\\Delta V(z) = V_{\\text{defect}}(z) - V_{\\text{bulk}}(z),$$ which can be decomposed into long-range and short-range components $$\\Delta V(z) = V_{\\text{lr}}(z) + V_{\\text{sr}}(z).$$ The short-range component $V_{\\text{sr}}(z)$ is localized around the defect and vanishes sufficiently far away.\n- The far-field potential alignment constant is obtained by averaging $V_{\\text{sr}}(z)$ in a region far from the defect (excluding a neighborhood of radius $r_{\\text{cut}}$ around $z_0$). Denote the alignment constant by $$C_{\\text{align}} = \\langle V_{\\text{sr}}(z) \\rangle_{\\text{far}},$$ where the average is taken over all $z$ such that $s(z) \\ge r_{\\text{cut}}$.\n- The image-charge energy within this one-dimensional planar-averaged model is given by $$E_{\\text{img}} = \\frac{1}{2} q\\, V_{\\text{lr}}(z_0) = \\frac{1}{2} q\\, \\frac{k_e}{\\epsilon}\\, \\frac{q}{A}\\, \\left( - \\frac{L_z}{12} \\right),$$ using the above gauge choice.\n- The Freysoldt, Neugebauer, and Van de Walle (FNV) correction energy is then $$E_{\\text{corr}} = q\\, C_{\\text{align}} + E_{\\text{img}},$$ expressed in electronvolt (eV).\n\nYour program must:\n1. Implement the long-range model $V_{\\text{lr}}(z)$ using the above one-dimensional periodic Green’s function with the Coulomb prefactor $k_e$ in electronvolt–angstrom units, strictly using inputs with lengths in angstroms and returning potentials and energies in electronvolt (eV).\n2. Construct synthetic test planar-averaged potential differences $\\Delta V(z)$ for validation by adding a localized short-range Gaussian around $z_0$ and a constant offset (representing an arbitrary reference mismatch), i.e., $$\\Delta V(z_i) = V_{\\text{lr}}(z_i) + A_{\\text{sr}} \\exp\\!\\left( - \\frac{s(z_i)^2}{2 \\sigma^2} \\right) + \\Delta V_0,$$ where $z_i$ are discrete sampling points, $A_{\\text{sr}}$ is the short-range amplitude in electronvolt (eV), $\\sigma$ is the width in angstroms, and $\\Delta V_0$ is a constant offset in electronvolt (eV).\n3. Compute the short-range component as $$V_{\\text{sr}}(z_i) = \\Delta V(z_i) - V_{\\text{lr}}(z_i),$$ and obtain the alignment constant $C_{\\text{align}}$ by averaging $V_{\\text{sr}}(z_i)$ over all points with $s(z_i) \\ge r_{\\text{cut}}$.\n4. Compute the image-charge energy $E_{\\text{img}}$ from $V_{\\text{lr}}(z_0)$, and then compute $$E_{\\text{corr}} = q\\, C_{\\text{align}} + E_{\\text{img}}.$$\n\nTest suite:\nUse the following four test cases to validate coverage, including a general case, a neutral-defect boundary condition ($q=0$), and edge cases with high dielectric screening and a defect near the boundary. In all cases, sample the interval $[0, L_z]$ uniformly with $N_z = 1000$ points. All lengths must be input in angstroms, and all energies (potentials) in electronvolt (eV). For each case, specify $(L_x, L_y, L_z, \\epsilon, q, z_0, r_{\\text{cut}}, A_{\\text{sr}}, \\sigma, \\Delta V_0)$:\n\n- Case 1 (general): $(10.0, 10.0, 20.0, 12.0, +1.0, 7.4, 5.0, 0.6, 1.0, 0.25)$.\n- Case 2 (neutral defect boundary): $(12.0, 12.0, 24.0, 10.0, 0.0, 5.0, 6.0, 0.8, 0.8, -0.20)$.\n- Case 3 (high dielectric, negative charge): $(8.0, 16.0, 16.0, 30.0, -2.0, 2.3, 4.0, 0.5, 1.5, 0.10)$.\n- Case 4 (low dielectric, defect near boundary): $(20.0, 10.0, 10.0, 3.0, +1.0, 9.8, 3.0, 0.4, 1.2, 0.00)$.\n\nAnswer specification:\n- For each test case, compute a single floating-point number $E_{\\text{corr}}$ in electronvolt (eV).\n- Your program should produce a single line of output containing the four results as a comma-separated list enclosed in square brackets, for example, $$[E_{\\text{corr,1}}, E_{\\text{corr,2}}, E_{\\text{corr,3}}, E_{\\text{corr,4}}].$$\n\nAll mathematical entities (symbols, variables, functions, operators, and numbers) must be written in LaTeX within this problem statement. Use electronvolt (eV) as the energy unit. Angles are not used.",
            "solution": "The problem has been validated and is deemed sound, well-posed, and self-contained. The provided physical and mathematical framework for the Freysoldt, Neugebauer, and Van de Walle (FNV) correction method is consistent with established literature in computational materials science. The test cases are well-defined and suitable for verifying the implementation.\n\nThe solution proceeds by systematically implementing the steps outlined in the FNV formalism. The core principle is to decompose the electrostatic potential difference between a defect-containing supercell and a pristine supercell, $\\Delta V(z) = V_{\\text{defect}}(z) - V_{\\text{bulk}}(z)$, into a known long-range component, $V_{\\text{lr}}(z)$, and a residual short-range component, $V_{\\text{sr}}(z)$. The correction energy, $E_{\\text{corr}}$, is then assembled from two key terms derived from this decomposition: a potential alignment correction and an image-charge interaction energy.\n\nThe algorithmic procedure is as follows:\n\n1.  **Discretization and Geometric Setup:** For each test case, we consider a one-dimensional grid along the $z$-axis of the supercell of length $L_z$, sampled at $N_z = 1000$ points. The planar-averaged formulation depends on the cell area perpendicular to this axis, $A = L_x L_y$. A critical geometric quantity is the periodic distance, $s(z)$, between a point $z$ on the grid and the defect position $z_0$. This is defined as the shortest arc distance on a circle of circumference $L_z$: $s(z) = \\min(|z - z_0|, L_z - |z - z_0|)$. This function correctly handles the periodicity of the supercell.\n\n2.  **Long-Range Model Potential, $V_{\\text{lr}}(z)$:** The long-range electrostatic potential arising from a planar point charge $q$ and a uniform neutralizing background is modeled using the one-dimensional periodic Poisson equation. The solution, $V_{\\text{lr}}(z)$, is obtained via the corresponding periodic Green's function, $G(z, z_0)$. The problem provides the closed-form expression for $V_{\\text{lr}}(z)$ in a specific gauge (zero-average potential) and using practical units (electronvolt and angstrom):\n    $$V_{\\text{lr}}(z) = \\frac{k_e}{\\epsilon}\\, \\frac{q}{A}\\, \\left( \\frac{s(z)\\,(L_z - s(z))}{2 L_z} - \\frac{L_z}{12} \\right)$$\n    where $k_e = \\frac{e^2}{4 \\pi \\epsilon_0} \\approx 14.399645\\ \\mathrm{eV}\\, \\mathrm{\\AA}$ is the Coulomb prefactor, $\\epsilon$ is the relative permittivity, and $q$ is the defect charge in units of the elementary charge $e$. This model potential is computed for all points $z_i$ on the grid.\n\n3.  **Synthetic Test Potential, $\\Delta V(z)$:** To validate the correction scheme, we construct a synthetic potential difference $\\Delta V(z)$ that mimics the output of a first-principles calculation. This is built by summing three components: (i) the exact long-range model potential $V_{\\text{lr}}(z)$ computed above; (ii) a localized, short-range Gaussian function centered at the defect, $A_{\\text{sr}} \\exp\\!\\left( - s(z)^2 / (2 \\sigma^2) \\right)$, representing the defect-induced electronic and ionic relaxation; and (iii) a constant offset $\\Delta V_0$, which represents the arbitrary potential alignment difference between the defect and bulk calculations.\n    $$\\Delta V(z_i) = V_{\\text{lr}}(z_i) + A_{\\text{sr}} \\exp\\!\\left( - \\frac{s(z_i)^2}{2 \\sigma^2} \\right) + \\Delta V_0$$\n\n4.  **Potential Alignment Constant, $C_{\\text{align}}$:** The short-range potential is isolated by subtracting the known long-range model from the total potential difference: $V_{\\text{sr}}(z_i) = \\Delta V(z_i) - V_{\\text{lr}}(z_i)$. For our synthetic potential, this yields:\n    $$V_{\\text{sr}}(z_i) = A_{\\text{sr}} \\exp\\!\\left( - \\frac{s(z_i)^2}{2 \\sigma^2} \\right) + \\Delta V_0$$\n    The key insight of the FNV method is that far from the defect, the short-range physical potential vanishes. The remaining non-zero value of $V_{\\text{sr}}(z)$ in this \"far-field\" region must therefore correspond to the unknown offset $\\Delta V_0$. We compute the alignment constant $C_{\\text{align}}$ by averaging $V_{\\text{sr}}(z_i)$ over all grid points $z_i$ where the periodic distance $s(z_i)$ is greater than or equal to a specified cutoff radius, $r_{\\text{cut}}$.\n    $$C_{\\text{align}} = \\langle V_{\\text{sr}}(z) \\rangle_{s(z) \\ge r_{\\text{cut}}}$$\n    If $r_{\\text{cut}}$ is sufficiently large compared to the short-range width $\\sigma$, the Gaussian term becomes negligible, and the procedure accurately recovers the offset, i.e., $C_{\\text{align}} \\approx \\Delta V_0$.\n\n5.  **Image-Charge Energy, $E_{\\text{img}}$:** The use of periodic boundary conditions introduces a spurious electrostatic interaction between the defect charge and its periodic images, mediated by the neutralizing background. This artificial energy contribution must be subtracted. Within the planar-averaged model, this energy is given by half the interaction energy of the charge $q$ with the long-range potential it creates, evaluated at its own position $z_0$:\n    $$E_{\\text{img}} = \\frac{1}{2} q\\, V_{\\text{lr}}(z_0)$$\n    Substituting the expression for $V_{\\text{lr}}(z)$ and noting that $s(z_0) = 0$, we obtain the computational formula:\n    $$E_{\\text{img}} = - \\frac{k_e q^2 L_z}{24 \\epsilon A}$$\n\n6.  **Total FNV Correction, $E_{\\text{corr}}$:** The final correction energy is the sum of two terms. The first, $q C_{\\text{align}}$, corrects the total energy of the system for the potential alignment error. The second term is the addition of $E_{\\text{img}}$, which, given its negative sign, effectively subtracts the spurious image-charge interaction energy.\n    $$E_{\\text{corr}} = q\\, C_{\\text{align}} + E_{\\text{img}}$$\n    This procedure is applied to each test case. For the special case of a neutral defect ($q=0$), both $E_{\\text{img}}$ and the term $q C_{\\text{align}}$ are zero, resulting in a total correction $E_{\\text{corr}} = 0$, as expected.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Freysoldt, Neugebauer, and Van de Walle (FNV) correction\n    energy for charged defects based on a 1D planar-averaged model.\n    \"\"\"\n\n    # Define the Coulomb prefactor in eV*Angstrom units.\n    K_E = 14.399645  # e^2 / (4 * pi * epsilon_0)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (Lx, Ly, Lz, epsilon, q, z0, r_cut, A_sr, sigma, dV0)\n        # Case 1 (general)\n        (10.0, 10.0, 20.0, 12.0, +1.0, 7.4, 5.0, 0.6, 1.0, 0.25),\n        # Case 2 (neutral defect boundary)\n        (12.0, 12.0, 24.0, 10.0, 0.0, 5.0, 6.0, 0.8, 0.8, -0.20),\n        # Case 3 (high dielectric, negative charge)\n        (8.0, 16.0, 16.0, 30.0, -2.0, 2.3, 4.0, 0.5, 1.5, 0.10),\n        # Case 4 (low dielectric, defect near boundary)\n        (20.0, 10.0, 10.0, 3.0, +1.0, 9.8, 3.0, 0.4, 1.2, 0.00),\n    ]\n\n    results = []\n    \n    # Number of sampling points along the z-axis.\n    N_Z = 1000\n\n    for case in test_cases:\n        Lx, Ly, Lz, epsilon, q, z0, r_cut, A_sr, sigma, dV0 = case\n        \n        # Area of the cell in the xy-plane.\n        A = Lx * Ly\n\n        # For a neutral defect (q=0), the correction is zero.\n        if q == 0.0:\n            results.append(0.0)\n            continue\n            \n        # 1. Create a uniform grid along z and compute the periodic distance s(z).\n        # We use a grid representing the periodic interval [0, Lz).\n        z_grid = np.linspace(0.0, Lz, N_Z, endpoint=False)\n        \n        # Calculate the shortest periodic distance s(z) from each grid point to z0.\n        s_dist_raw = np.abs(z_grid - z0)\n        s_dist = np.minimum(s_dist_raw, Lz - s_dist_raw)\n\n        # 2. Compute the model long-range potential V_lr(z).\n        # This is based on the 1D periodic Green's function.\n        G_part = (s_dist * (Lz - s_dist)) / (2.0 * Lz) - Lz / 12.0\n        V_lr = (K_E * q) / (epsilon * A) * G_part\n\n        # 3. Construct the synthetic total potential difference dV(z).\n        # This simulates the output of a first-principles calculation.\n        V_sr_gauss = A_sr * np.exp(-s_dist**2 / (2.0 * sigma**2))\n        dV = V_lr + V_sr_gauss + dV0\n\n        # 4. Isolate the short-range potential V_sr(z) and compute the alignment constant C_align.\n        V_sr = dV - V_lr\n        \n        # C_align is the average of V_sr in the far-field region.\n        far_field_mask = s_dist >= r_cut\n        C_align = np.mean(V_sr[far_field_mask])\n\n        # 5. Compute the image-charge interaction energy E_img.\n        # This is the electrostatic self-interaction in the periodic cell.\n        E_img = - (K_E * q**2 * Lz) / (24.0 * epsilon * A)\n\n        # 6. Compute the total FNV correction energy E_corr.\n        E_corr = q * C_align + E_img\n        results.append(E_corr)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Once accurate, corrected formation energies are computed for a defect in its various possible charge states, the crucial next step is to interpret this data to understand the defect's electronic behavior within the material. The most stable charge state of a defect is not fixed but depends on the position of the Fermi level, $E_F$. In this practice , you will analyze a set of formation energies to construct a defect stability diagram, which reveals the thermodynamic charge transition levels, $\\epsilon(q/q')$, and can uncover complex behaviors like the \"negative-U\" phenomenon, where an intermediate charge state is never thermodynamically stable.",
            "id": "3800308",
            "problem": "A point defect $D$ in a wide-band-gap semiconductor is studied using first-principles total-energy calculations within the grand canonical ensemble of atoms and electrons. The valence band maximum $E_v$ is set as the zero of energy for the electron reservoir. The host band gap is $E_{\\mathrm{g}} = 2.4 \\text{ eV}$, so the Fermi level $E_F$ varies within $0 \\leq E_F \\leq E_{\\mathrm{g}}$ relative to $E_v$. The defect $D$ is computed in five charge states $q \\in \\{+2, +1, 0, -1, -2\\}$, and the resulting formation energies $E_f(D^q)$ at three Fermi-level positions are reported as follows (all energies are in $\\text{eV}$):\n\nAt $E_F = 0.0 \\text{ eV}$: $E_f(D^{+2}) = 1.0 \\text{ eV}$, $E_f(D^{+1}) = 1.5 \\text{ eV}$, $E_f(D^{0}) = 1.4 \\text{ eV}$, $E_f(D^{-1}) = 3.0 \\text{ eV}$, $E_f(D^{-2}) = 5.0 \\text{ eV}$.\n\nAt $E_F = 1.2 \\text{ eV}$: $E_f(D^{+2}) = 3.4 \\text{ eV}$, $E_f(D^{+1}) = 2.7 \\text{ eV}$, $E_f(D^{0}) = 1.4 \\text{ eV}$, $E_f(D^{-1}) = 1.8 \\text{ eV}$, $E_f(D^{-2}) = 2.6 \\text{ eV}$.\n\nAt $E_F = 2.4 \\text{ eV}$: $E_f(D^{+2}) = 5.8 \\text{ eV}$, $E_f(D^{+1}) = 3.9 \\text{ eV}$, $E_f(D^{0}) = 1.4 \\text{ eV}$, $E_f(D^{-1}) = 0.6 \\text{ eV}$, $E_f(D^{-2}) = 0.2 \\text{ eV}$.\n\nStarting from the fundamental definition of defect formation energy in a charged state and the role of the electron reservoir, reason out the dependence of $E_f(D^q)$ on $E_F$. Use the supplied data to determine all thermodynamic charge-state transition levels $\\epsilon(q/q')$ within $0 \\leq E_F \\leq E_{\\mathrm{g}}$ by finding the Fermi-level positions where $E_f(D^q)$ and $E_f(D^{q'})$ are equal and the lower-energy branch changes identity. From these transition levels, compute the set of stable charge states over the entire band gap and assess whether the defect exhibits negative-$U$ behavior, defined by the absence of stability of an intermediate charge state between two stable charge states that differ by $2$ in $q$ over the whole band gap. If negative-$U$ behavior is present, compute the effective correlation energy for the skipped intermediate state via the second difference of formation energies at the valence band maximum.\n\nRound all reported energies to four significant figures. Express energies in $\\text{eV}$. In your final answer, report the three transition energies (from lower to higher $E_F$) and the effective correlation energy for the skipped intermediate state (if present), in that order.",
            "solution": "We begin from the standard grand-canonical formulation for the formation energy of a point defect $D$ in charge state $q$ exchanging atoms and electrons with reservoirs. The formation energy at a Fermi level $E_F$ (referenced to the valence band maximum $E_v$) reads\n$$\nE_f(D^q; E_F) = E_{\\mathrm{tot}}(D^q) - E_{\\mathrm{tot}}(\\mathrm{bulk}) + \\sum_i n_i \\mu_i + q\\,(E_F + E_v) + E_{\\mathrm{corr}}(q),\n$$\nwhere $E_{\\mathrm{tot}}(D^q)$ and $E_{\\mathrm{tot}}(\\mathrm{bulk})$ are total energies of the defective and pristine supercells, $n_i$ and $\\mu_i$ are stoichiometric deviations and chemical potentials of species $i$, $q$ is the integer defect charge (in units of elementary charge), and $E_{\\mathrm{corr}}(q)$ accounts for finite-size and electrostatic corrections. With $E_v$ set as the reference zero, the explicit $E_F$ dependence simplifies to\n$$\n\\frac{\\partial E_f(D^q; E_F)}{\\partial E_F} = q,\n$$\nso $E_f(D^q; E_F)$ is linear in $E_F$ with slope $q$. Therefore, for each $q$, we can write\n$$\nE_f(D^q; E_F) = A_q + q\\,E_F,\n$$\nwhere $A_q \\equiv E_f(D^q; E_F=0)$ is the intercept at the valence band maximum. The provided data at $E_F = 0.0 \\text{ eV}$ give the intercepts directly:\n$$\nA_{+2} = 1.0,\\quad A_{+1} = 1.5,\\quad A_0 = 1.4,\\quad A_{-1} = 3.0,\\quad A_{-2} = 5.0,\n$$\nall in $\\text{eV}$. The additional points at $E_F = 1.2 \\text{ eV}$ and $E_F = 2.4 \\text{ eV}$ are consistent with the linear form and slopes $q$:\n- For $q=+2$: $A_{+2} + 2\\times 1.2 = 1.0 + 2.4 = 3.4$ and $A_{+2} + 2\\times 2.4 = 1.0 + 4.8 = 5.8$.\n- For $q=+1$: $A_{+1} + 1\\times 1.2 = 1.5 + 1.2 = 2.7$ and $A_{+1} + 1\\times 2.4 = 1.5 + 2.4 = 3.9$.\n- For $q=0$: $A_0 + 0\\times E_F = 1.4$ for all $E_F$.\n- For $q=-1$: $A_{-1} - 1\\times 1.2 = 3.0 - 1.2 = 1.8$ and $A_{-1} - 1\\times 2.4 = 3.0 - 2.4 = 0.6$.\n- For $q=-2$: $A_{-2} - 2\\times 1.2 = 5.0 - 2.4 = 2.6$ and $A_{-2} - 2\\times 2.4 = 5.0 - 4.8 = 0.2$.\n\nThermodynamic transition levels $\\epsilon(q/q')$ (relative to $E_v$) are given by the Fermi-level positions where $E_f(D^q; E_F)$ equals $E_f(D^{q'}; E_F)$ and the identity of the lowest-energy branch changes. Solving $A_q + q E_F = A_{q'} + q' E_F$ yields\n$$\n\\epsilon(q/q') = \\frac{A_{q'} - A_q}{q - q'}.\n$$\nWe compute the relevant crossings within the band gap $0 \\leq E_F \\leq 2.4$:\n\n1. Between $q=+2$ and $q=0$:\n$$\n\\epsilon(+2/0) = \\frac{A_0 - A_{+2}}{2 - 0} = \\frac{1.4 - 1.0}{2} = 0.2 \\text{ eV}.\n$$\nComparing to $q=+1$, we note $\\epsilon(+2/+1) = \\frac{A_{+1} - A_{+2}}{2 - 1} = 0.5 \\text{ eV}$, but the $q=0$ branch already undercuts $q=+1$ for $E_F  0.2 \\text{ eV}$, as $E_f(D^0; E_F) = 1.4$ while $E_f(D^{+1}; E_F) = 1.5 + E_F$. The crossing $\\epsilon(+1/0) = A_0 - A_{+1} = -0.1 \\text{ eV}$ lies outside the band gap. Consequently, the first transition is directly $+2 \\to 0$ at $E_F = 0.2 \\text{ eV}$, and $q=+1$ is never thermodynamically stable in the gap.\n\n2. Between $q=0$ and $q=-1$:\n$$\n\\epsilon(0/-1) = \\frac{A_{-1} - A_0}{0 - (-1)} = 3.0 - 1.4 = 1.6 \\text{ eV}.\n$$\n\n3. Between $q=-1$ and $q=-2$:\n$$\n\\epsilon(-1/-2) = \\frac{A_{-2} - A_{-1}}{-1 - (-2)} = 5.0 - 3.0 = 2.0 \\text{ eV}.\n$$\n\nThese are the only crossings within $0 \\leq E_F \\leq 2.4 \\text{ eV}$. Therefore, the stable charge-state sequence over the band gap is:\n- For $0 \\leq E_F  0.2 \\text{ eV}$: $q=+2$ is lowest.\n- For $0.2 \\text{ eV} \\leq E_F  1.6 \\text{ eV}$: $q=0$ is lowest.\n- For $1.6 \\text{ eV} \\leq E_F  2.0 \\text{ eV}$: $q=-1$ is lowest.\n- For $2.0 \\text{ eV} \\leq E_F \\leq 2.4 \\text{ eV}$: $q=-2$ is lowest.\n\nThe direct transition $+2 \\to 0$ without stability of $+1$ indicates negative-$U$ behavior centered on the intermediate charge $q=+1$. An effective correlation energy quantifying the skipping of $q=+1$ can be defined as the second difference at the valence band maximum,\n$$\nU_{\\mathrm{eff}}(q=+1) = A_{+2} + A_0 - 2 A_{+1}.\n$$\nUsing the intercepts,\n$$\nU_{\\mathrm{eff}}(+1) = 1.0 + 1.4 - 2\\times 1.5 = 2.4 - 3.0 = -0.6 \\text{ eV}.\n$$\nA negative value confirms negative-$U$ character for the $+1$ intermediate state. No skipping occurs on the negative side, as both $q=-1$ and $q=-2$ are stable over finite $E_F$ intervals.\n\nRounding each reported energy to four significant figures, we obtain the three transition energies and the effective correlation energy as $0.2000 \\text{ eV}$, $1.600 \\text{ eV}$, $2.000 \\text{ eV}$, and $-0.6000 \\text{ eV}$, respectively.",
            "answer": "$$\\boxed{\\begin{pmatrix}0.2000  1.600  2.000  -0.6000\\end{pmatrix}}$$"
        }
    ]
}