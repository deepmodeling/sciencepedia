{
    "hands_on_practices": [
        {
            "introduction": "A cornerstone of hierarchical materials modeling is coarse-graining, a technique that systematically reduces the number of degrees of freedom to access larger length and time scales. This practice  provides a concrete exercise in bridging the atomistic and mesoscopic scales by mapping a detailed polymer chain to a simplified bead-spring model. By requiring the coarse-grained model to reproduce key physical observables of the original system—its overall size and diffusive behavior—you will engage directly with the foundational principles of statistical mechanics, such as the equipartition theorem and Rouse dynamics, to derive a physically consistent and computationally efficient representation.",
            "id": "3815431",
            "problem": "You are tasked with formalizing a hierarchical coarse-graining procedure that maps an atomistic polymer chain to a bead-spring chain and validating the resulting coarse-grained model against two target observables: the mean-squared end-to-end distance and the long-time self-diffusion coefficient. The derivation and algorithm must start from foundational physical principles appropriate for multiscale materials simulation and be expressed in purely mathematical and logical terms.\n\nBegin with these fundamental laws and core definitions:\n\n- The equipartition theorem for a three-dimensional harmonic spring: each quadratic degree of freedom contributes $k_{\\mathrm{B}} T / 2$ to the mean energy, where $k_{\\mathrm{B}}$ is Boltzmann's constant and $T$ is absolute temperature. For a harmonic spring with potential $U(\\mathbf{r}) = \\frac{1}{2} k \\lVert \\mathbf{r} \\rVert^2$, this implies a relation between the spring constant $k$ and the mean-square bond length.\n- The ideal Gaussian chain statistics: for a chain with $n$ independent, identically distributed segments of zero mean and isotropic variance, the mean-squared end-to-end distance is proportional to the number of segments.\n- The Einstein relation for diffusion: the long-time self-diffusion coefficient $D$ of a Brownian particle subject to linear drag is given by $D = k_{\\mathrm{B}} T / \\zeta$, where $\\zeta$ is the friction coefficient.\n- Additivity of friction in the Rouse model (no hydrodynamic interactions): the total friction of a linear chain is the sum of bead frictions.\n\nYour mapping must be specified by a coarse-graining factor $g$ (the number of atomistic monomers per coarse bead), an atomistic chain of $N_{\\mathrm{a}}$ monomers, and an ideal bead-spring chain with $n_{\\mathrm{c}}$ beads connected by harmonic springs with spring constant $k$ and zero rest length. The bead friction is denoted $\\zeta_{\\mathrm{b}}$. You must:\n\n1. Construct the bead-spring chain such that its mean-squared end-to-end distance matches the atomistic chain’s measured mean-squared end-to-end distance. From first principles, derive how to compute the coarse-grained segment statistical parameter (effective segment length) from this matching condition and then compute the harmonic spring constant using the equipartition theorem.\n2. Using the Rouse model’s additivity of friction and the Einstein relation, derive how to set the bead friction $\\zeta_{\\mathrm{b}}$ as a function of the coarse-graining factor $g$ and the atomistic monomer friction $\\zeta_{\\mathrm{m}}$. From this, derive the predicted diffusion coefficient of the coarse-grained chain and compare it to the measured atomistic diffusion coefficient.\n3. Quantify validation by computing the relative error in the end-to-end mean-squared distance and in the diffusion coefficient, defined as absolute difference divided by the atomistic measured value for each observable.\n\nAll quantities must be treated in the International System of Units (SI). Specifically:\n\n- Temperature $T$ in $\\mathrm{K}$.\n- Boltzmann constant $k_{\\mathrm{B}}$ in $\\mathrm{J}/\\mathrm{K}$.\n- Friction coefficients $\\zeta_{\\mathrm{m}}$ and $\\zeta_{\\mathrm{b}}$ in $\\mathrm{kg}/\\mathrm{s}$.\n- Diffusion coefficients $D$ in $\\mathrm{m}^2/\\mathrm{s}$.\n- End-to-end mean-squared distance $\\langle R^2 \\rangle$ in $\\mathrm{m}^2$.\n\nYou must implement a program that performs this mapping and validation for the following test suite of parameter values. In each test case, compute coarse-grained parameters and validation metrics according to the derivations:\n\n- Test case A (general case):\n  - $N_{\\mathrm{a}} = 100$\n  - $g = 5$\n  - $\\langle R^2 \\rangle_{\\mathrm{atom}} = 9.0 \\times 10^{-16}\\ \\mathrm{m}^2$\n  - $\\zeta_{\\mathrm{m}} = 1.0 \\times 10^{-12}\\ \\mathrm{kg}/\\mathrm{s}$\n  - $T = 300\\ \\mathrm{K}$\n  - $D_{\\mathrm{atom}} = \\dfrac{k_{\\mathrm{B}} T}{N_{\\mathrm{a}} \\zeta_{\\mathrm{m}}}$ (numerical evaluation required)\n  - End-to-end tolerance $\\varepsilon_{R^2} = 1.0 \\times 10^{-6}$\n  - Diffusion tolerance $\\varepsilon_{D} = 1.0 \\times 10^{-1}$\n\n- Test case B (near-tolerance diffusion deviation):\n  - $N_{\\mathrm{a}} = 50$\n  - $g = 10$\n  - $\\langle R^2 \\rangle_{\\mathrm{atom}} = 2.5 \\times 10^{-16}\\ \\mathrm{m}^2$\n  - $\\zeta_{\\mathrm{m}} = 5.0 \\times 10^{-13}\\ \\mathrm{kg}/\\mathrm{s}$\n  - $T = 300\\ \\mathrm{K}$\n  - $D_{\\mathrm{atom}}$ is $1.08$ times the Einstein prediction $k_{\\mathrm{B}} T / (N_{\\mathrm{a}} \\zeta_{\\mathrm{m}})$ (numerical evaluation required)\n  - $\\varepsilon_{R^2} = 1.0 \\times 10^{-6}$\n  - $\\varepsilon_{D} = 1.0 \\times 10^{-1}$\n\n- Test case C (diffusion deviation beyond tolerance):\n  - $N_{\\mathrm{a}} = 200$\n  - $g = 4$\n  - $\\langle R^2 \\rangle_{\\mathrm{atom}} = 1.6 \\times 10^{-15}\\ \\mathrm{m}^2$\n  - $\\zeta_{\\mathrm{m}} = 2.0 \\times 10^{-12}\\ \\mathrm{kg}/\\mathrm{s}$\n  - $T = 300\\ \\mathrm{K}$\n  - $D_{\\mathrm{atom}}$ is $0.75$ times the Einstein prediction $k_{\\mathrm{B}} T / (N_{\\mathrm{a}} \\zeta_{\\mathrm{m}})$ (numerical evaluation required)\n  - $\\varepsilon_{R^2} = 1.0 \\times 10^{-6}$\n  - $\\varepsilon_{D} = 1.0 \\times 10^{-1}$\n\nFor each test case, your program must:\n\n- Compute the number of coarse beads $n_{\\mathrm{c}} = N_{\\mathrm{a}} / g$.\n- Determine the effective coarse-grained segment mean-squared length $b^2$ required to match $\\langle R^2 \\rangle_{\\mathrm{atom}}$.\n- Compute the harmonic spring constant $k$ using the equipartition theorem.\n- Set the bead friction $\\zeta_{\\mathrm{b}}$ using additivity of friction in the Rouse model from monomer friction $\\zeta_{\\mathrm{m}}$ and $g$.\n- Predict the coarse-grained chain diffusion coefficient $D_{\\mathrm{pred}}$ using the Einstein relation.\n- Validate by computing the relative error in end-to-end mean-squared distance $\\delta_{R^2}$ and diffusion coefficient $\\delta_{D}$, and check whether each error is less than or equal to its tolerance.\n\nFinal output format: Your program should produce a single line of output containing a comma-separated list enclosed in square brackets. For each test case in the order A, B, C, append four values in this exact order:\n$[\\delta_{R^2}, \\delta_{D}, \\mathrm{pass}_{R^2}, \\mathrm{pass}_{D}]$.\nThus the final output will be a single list of length $12$ containing the concatenated results for all three test cases, for example $[x_1, x_2, x_3, x_4, x_5, x_6, x_7, x_8, x_9, x_{10}, x_{11}, x_{12}]$ where each $x_i$ is either a floating-point number (for relative errors) or a boolean (for pass/fail).\n\nAnswer all quantities in SI units and implement your solution as a complete, runnable program as specified.",
            "solution": "We present a principle-based derivation and algorithm design that maps an atomistic polymer chain to a bead-spring chain and validates the coarse-grained model using the mean-squared end-to-end distance and the diffusion coefficient. The hierarchy of materials modeling approaches is respected by deriving coarse-grained model parameters from atomistically measured observables and fundamental statistical physics laws.\n\nDefinitions and setup:\n\n- Let the atomistic chain have $N_{\\mathrm{a}}$ monomers. We choose a coarse-graining factor $g$ (monomers per bead), yielding a bead-spring chain with $n_{\\mathrm{c}}$ beads, where $n_{\\mathrm{c}} = N_{\\mathrm{a}} / g$.\n- Denote the atomistically measured mean-squared end-to-end distance by $\\langle R^2 \\rangle_{\\mathrm{atom}}$.\n- Denote the atomistically measured long-time self-diffusion coefficient by $D_{\\mathrm{atom}}$.\n- Let the absolute temperature be $T$, and Boltzmann's constant $k_{\\mathrm{B}}$.\n\nFundamental base:\n\n1. Equipartition theorem: For a three-dimensional harmonic spring described by $U(\\mathbf{r}) = \\frac{1}{2} k \\lVert \\mathbf{r} \\rVert^2$, the mean-square bond vector magnitude satisfies\n$$\n\\langle \\lVert \\mathbf{r} \\rVert^2 \\rangle = \\frac{3 k_{\\mathrm{B}} T}{k}.\n$$\nThis follows because each Cartesian component contributes $k_{\\mathrm{B}} T / 2$ to the average energy, so $\\langle U \\rangle = \\frac{3}{2} k_{\\mathrm{B}} T$, and the equipartition relation implies $\\frac{1}{2} k \\langle \\lVert \\mathbf{r} \\rVert^2 \\rangle = \\frac{3}{2} k_{\\mathrm{B}} T$.\n\n2. Ideal Gaussian chain statistics: For a chain comprising $n$ independent segments with zero mean and isotropic variance $\\langle \\lVert \\mathbf{b} \\rVert^2 \\rangle = b^2$, the end-to-end vector $\\mathbf{R}$ is the sum of segment vectors, and by linearity of expectation and independence,\n$$\n\\langle R^2 \\rangle = n b^2.\n$$\nThis is a well-tested model for flexible polymers at scales larger than a persistence length under theta conditions and serves as the foundational coarse-grained model for bead-spring chains.\n\n3. Einstein relation for diffusion: For a Brownian particle subject to linear drag with friction coefficient $\\zeta$, the long-time self-diffusion coefficient is\n$$\nD = \\frac{k_{\\mathrm{B}} T}{\\zeta}.\n$$\n\n4. Additivity of friction in the Rouse model (ignoring hydrodynamic interactions): The total friction of a linear chain comprising $n_{\\mathrm{c}}$ beads is the sum of individual bead frictions. If each bead has friction $\\zeta_{\\mathrm{b}}$, then $\\zeta_{\\mathrm{tot}} = n_{\\mathrm{c}} \\zeta_{\\mathrm{b}}$. Moreover, if each coarse bead represents $g$ monomers and monomer friction is $\\zeta_{\\mathrm{m}}$, then the bead friction is\n$$\n\\zeta_{\\mathrm{b}} = g \\, \\zeta_{\\mathrm{m}}.\n$$\n\nDerivation of the mapping:\n\n- The bead-spring chain must match the atomistic end-to-end mean-squared distance. Using Gaussian chain statistics, for the coarse chain with $n_{\\mathrm{c}}$ segments,\n$$\n\\langle R^2 \\rangle_{\\mathrm{coarse}} = n_{\\mathrm{c}} b^2.\n$$\nImposing $\\langle R^2 \\rangle_{\\mathrm{coarse}} = \\langle R^2 \\rangle_{\\mathrm{atom}}$ yields the coarse-grained segment mean-squared length\n$$\nb^2 = \\frac{\\langle R^2 \\rangle_{\\mathrm{atom}}}{n_{\\mathrm{c}}}.\n$$\n\n- Using the equipartition theorem for harmonic springs, the spring constant $k$ is determined by matching the segment variance to $b^2$:\n$$\nb^2 \\equiv \\langle \\lVert \\mathbf{r} \\rVert^2 \\rangle = \\frac{3 k_{\\mathrm{B}} T}{k}\n\\quad \\Rightarrow \\quad\nk = \\frac{3 k_{\\mathrm{B}} T}{b^2}.\n$$\n\n- The bead friction is set by additivity:\n$$\n\\zeta_{\\mathrm{b}} = g \\, \\zeta_{\\mathrm{m}},\n$$\nso the total coarse-chain friction is\n$$\n\\zeta_{\\mathrm{tot}} = n_{\\mathrm{c}} \\zeta_{\\mathrm{b}} = n_{\\mathrm{c}} g \\, \\zeta_{\\mathrm{m}} = N_{\\mathrm{a}} \\, \\zeta_{\\mathrm{m}}.\n$$\nNote this total friction is invariant under the coarse-graining factor $g$ in the Rouse model.\n\n- The predicted diffusion coefficient of the coarse chain is then\n$$\nD_{\\mathrm{pred}} = \\frac{k_{\\mathrm{B}} T}{\\zeta_{\\mathrm{tot}}}\n= \\frac{k_{\\mathrm{B}} T}{N_{\\mathrm{a}} \\, \\zeta_{\\mathrm{m}}}.\n$$\n\nValidation metrics:\n\n- Define the relative error in end-to-end mean-squared distance as\n$$\n\\delta_{R^2} = \\frac{\\left| \\langle R^2 \\rangle_{\\mathrm{coarse}} - \\langle R^2 \\rangle_{\\mathrm{atom}} \\right|}{\\langle R^2 \\rangle_{\\mathrm{atom}}}.\n$$\n- Define the relative error in diffusion coefficient as\n$$\n\\delta_{D} = \\frac{\\left| D_{\\mathrm{pred}} - D_{\\mathrm{atom}} \\right|}{D_{\\mathrm{atom}}}.\n$$\n- The validations pass if\n$$\n\\delta_{R^2} \\le \\varepsilon_{R^2}\n\\quad \\text{and} \\quad\n\\delta_{D} \\le \\varepsilon_{D},\n$$\nwhere $\\varepsilon_{R^2}$ and $\\varepsilon_{D}$ are prescribed tolerances.\n\nAlgorithmic steps for each test case:\n\n1. Compute $n_{\\mathrm{c}} = N_{\\mathrm{a}} / g$.\n2. Compute $b^2 = \\langle R^2 \\rangle_{\\mathrm{atom}} / n_{\\mathrm{c}}$.\n3. Compute $k = 3 k_{\\mathrm{B}} T / b^2$.\n4. Compute $\\zeta_{\\mathrm{b}} = g \\, \\zeta_{\\mathrm{m}}$.\n5. Compute $D_{\\mathrm{pred}} = k_{\\mathrm{B}} T / (N_{\\mathrm{a}} \\, \\zeta_{\\mathrm{m}})$.\n6. Compute $\\delta_{R^2}$ and $\\delta_{D}$ and pass/fail booleans.\n\nScientific realism:\n\n- The chosen parameters correspond to polymer coils of nanometric end-to-end sizes in solution at $T = 300\\ \\mathrm{K}$, monomer frictions of order $10^{-12}\\ \\mathrm{kg}/\\mathrm{s}$, and diffusion coefficients in the range $10^{-11}$ to $10^{-10}\\ \\mathrm{m}^2/\\mathrm{s}$, consistent with Rouse scaling and typical experimental regimes.\n\nFinal output specification:\n\n- Produce a single line containing a list with $12$ entries in the order $[\\delta_{R^2}^{(A)}, \\delta_{D}^{(A)}, \\mathrm{pass}_{R^2}^{(A)}, \\mathrm{pass}_{D}^{(A)}, \\delta_{R^2}^{(B)}, \\delta_{D}^{(B)}, \\mathrm{pass}_{R^2}^{(B)}, \\mathrm{pass}_{D}^{(B)}, \\delta_{R^2}^{(C)}, \\delta_{D}^{(C)}, \\mathrm{pass}_{R^2}^{(C)}, \\mathrm{pass}_{D}^{(C)}]$, where superscripts $(A)$, $(B)$, $(C)$ denote test cases A, B, and C respectively. Each $\\delta$ is a floating-point number and each pass is a boolean.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_mapping_and_validation(N_a, g, R2_atom, D_atom, zeta_m, T, tol_R2, tol_D):\n    # Physical constant: Boltzmann constant (SI units: J/K)\n    k_B = 1.380649e-23\n\n    # Number of coarse beads\n    n_c = N_a / g  # test cases ensure divisibility\n\n    # Effective coarse segment mean-squared length to match R2\n    b2 = R2_atom / n_c\n\n    # Spring constant from equipartition for 3D harmonic spring\n    k = 3.0 * k_B * T / b2\n\n    # Bead friction from additivity in Rouse model\n    zeta_b = g * zeta_m\n\n    # Predicted diffusion coefficient from Einstein relation and additive friction\n    # D_pred = k_B * T / (n_c * zeta_b) = k_B * T / (N_a * zeta_m)\n    D_pred = k_B * T / (N_a * zeta_m)\n\n    # Coarse end-to-end predicted (should equal R2_atom by construction)\n    R2_pred = n_c * b2\n\n    # Relative errors\n    err_R2 = abs(R2_pred - R2_atom) / R2_atom\n    err_D = abs(D_pred - D_atom) / D_atom\n\n    # Pass/fail according to tolerances\n    pass_R2 = err_R2 <= tol_R2\n    pass_D = err_D <= tol_D\n\n    return err_R2, err_D, pass_R2, pass_D, n_c, b2, k, zeta_b, D_pred\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (N_a, g, R2_atom [m^2], D_atom [m^2/s], zeta_m [kg/s], T [K], tol_R2, tol_D)\n    k_B = 1.380649e-23\n    T = 300.0\n\n    # Case A parameters\n    N_a_A = 100\n    g_A = 5\n    R2_atom_A = 9.0e-16\n    zeta_m_A = 1.0e-12\n    D_atom_A = k_B * T / (N_a_A * zeta_m_A)  # exact Einstein prediction\n    tol_R2_A = 1.0e-6\n    tol_D_A = 1.0e-1\n\n    # Case B parameters (D_atom is 1.08 times the Einstein prediction)\n    N_a_B = 50\n    g_B = 10\n    R2_atom_B = 2.5e-16\n    zeta_m_B = 5.0e-13\n    D_pred_B = k_B * T / (N_a_B * zeta_m_B)\n    D_atom_B = 1.08 * D_pred_B\n    tol_R2_B = 1.0e-6\n    tol_D_B = 1.0e-1\n\n    # Case C parameters (D_atom is 0.75 times the Einstein prediction)\n    N_a_C = 200\n    g_C = 4\n    R2_atom_C = 1.6e-15\n    zeta_m_C = 2.0e-12\n    D_pred_C = k_B * T / (N_a_C * zeta_m_C)\n    D_atom_C = 0.75 * D_pred_C\n    tol_R2_C = 1.0e-6\n    tol_D_C = 1.0e-1\n\n    test_cases = [\n        (N_a_A, g_A, R2_atom_A, D_atom_A, zeta_m_A, T, tol_R2_A, tol_D_A),\n        (N_a_B, g_B, R2_atom_B, D_atom_B, zeta_m_B, T, tol_R2_B, tol_D_B),\n        (N_a_C, g_C, R2_atom_C, D_atom_C, zeta_m_C, T, tol_R2_C, tol_D_C),\n    ]\n\n    results = []\n    # We will compute required metrics and append only the requested outputs:\n    # For each case: [err_R2, err_D, pass_R2, pass_D]\n    for case in test_cases:\n        N_a, g, R2_atom, D_atom, zeta_m, T_case, tol_R2, tol_D = case\n        err_R2, err_D, pass_R2, pass_D, n_c, b2, k, zeta_b, D_pred = compute_mapping_and_validation(\n            N_a, g, R2_atom, D_atom, zeta_m, T_case, tol_R2, tol_D\n        )\n        results.extend([err_R2, err_D, pass_R2, pass_D])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "A central challenge in linking atomistic simulations to continuum descriptions is the rigorous definition and calculation of macroscopic fields from discrete particle data. This practice  delves into the theoretical foundations of calculating the Cauchy stress tensor from a Molecular Dynamics trajectory at finite temperature. You will be challenged to reason from first principles about how to properly account for thermal fluctuations and non-affine atomic motion, leading to a critical understanding of the spatial and temporal averaging protocols required to extract a smooth, objective, and physically meaningful stress field from the noisy microscopic world.",
            "id": "3815423",
            "problem": "A crystalline solid with defects is simulated by Molecular Dynamics (MD) at finite temperature $T$ under a homogeneous shear characterized by a deformation gradient tensor $\\mathbf{F}$. The simulation provides atomistic trajectories $\\mathbf{r}_i(t)$ and velocities $\\mathbf{v}_i(t)$ for atoms indexed by $i$. You wish to compute a continuum-quality Cauchy stress field $\\boldsymbol{\\sigma}(\\mathbf{r},t)$ suitable for comparison to a continuum mechanics computation at the same thermodynamic state. In the deformed solid, atomistic displacements are not purely affine: for each atom, the displacement can be decomposed into an affine part induced by $\\mathbf{F}$ and a non-affine part due to local rearrangements, defects, and thermal vibrations. Thermal fluctuations produce stochastic velocity components and vibrational motions over a spectrum of time scales.\n\nFrom first principles of momentum conservation and definitions of stress as momentum flux, reason about how non-affine displacements and thermal fluctuations enter a microscopic stress definition and how they must be treated to obtain a smooth, objective continuum-quality stress. Then select the protocol that most correctly yields $\\boldsymbol{\\sigma}(\\mathbf{r},t)$ with minimal bias, consistent with the hierarchy from atomistic to continuum descriptions.\n\nWhich option best meets these requirements?\n\nA. Use a spatial coarse-graining of the Irving–Kirkwood stress with a smooth, compactly supported kernel $W(\\mathbf{r})$ of width $l$ satisfying $a \\ll l \\ll L$, where $a$ is the lattice spacing and $L$ is a macroscopic length. Define the local streaming velocity $\\mathbf{u}(\\mathbf{r},t)$ by kernel-weighted averaging of $\\mathbf{v}_i(t)$, and compute the kinetic term using the peculiar velocities $\\mathbf{c}_i(t) = \\mathbf{v}_i(t) - \\mathbf{u}(\\mathbf{r},t)$ to suppress advective contributions. Include the configurational contribution along interatomic bonds without assuming affine kinematics, so that non-affine displacements enter through the actual $\\mathbf{r}_i(t)$. Perform time averaging over a window $\\Delta t$ chosen such that $\\tau_{\\mathrm{vib}} \\ll \\Delta t \\ll \\tau_{\\mathrm{drift}}$, where $\\tau_{\\mathrm{vib}}$ is a characteristic vibrational decorrelation time and $\\tau_{\\mathrm{drift}}$ is a macroscopic evolution time, and optionally ensemble-average across independent MD replicas.\n\nB. Compute the instantaneous virial stress in a small atomistic subvolume containing only a few atoms using only the configurational term, arguing that non-affine displacements average to zero and that thermal fluctuations are negligible at room temperature, so neither spatial nor time averaging is necessary.\n\nC. Perform a global time average of the Irving–Kirkwood stress over a long window $\\Delta t$ using the unmodified velocities $\\mathbf{v}_i(t)$ and a top-hat spatial bin of size $l$ chosen comparable to $a$, so that local detail is preserved. Subtract the global mean velocity of the simulation cell but do not define a local streaming velocity field $\\mathbf{u}(\\mathbf{r},t)$.\n\nD. Enforce affine kinematics by mapping $\\mathbf{X}_i$ to $\\mathbf{F}\\mathbf{X}_i$ and discard any deviations as non-affine noise. Compute stresses from the Cauchy–Born rule using derivatives of the potential evaluated at the affinely deformed lattice. Remove the entire kinetic contribution to eliminate thermal noise, since continuum stresses are defined by potential interactions.\n\nE. Use a Gaussian kernel $W(\\mathbf{r})$ of width $l$ with $l \\sim L$ to eliminate all microstructural detail. Retain both kinetic and configurational terms but compute the kinetic part with the raw velocities $\\mathbf{v}_i(t)$, and avoid time averaging to preserve instantaneous response. Assume that the large $l$ alone ensures continuum-quality stress even in the presence of defects and thermal fluctuations.\n\nSelect the correct option.",
            "solution": "The correct protocol for calculating a continuum-quality Cauchy stress field from atomistic data must properly account for kinetic and potential contributions while systematically averaging out microscopic fluctuations. The foundation for this is the Irving–Kirkwood (IK) stress tensor, which is derived from the conservation of momentum for a system of discrete particles.\n\nThe IK stress tensor at a point $\\mathbf{r}$ consists of a kinetic term and a configurational (potential) term:\n$$ \\boldsymbol{\\sigma}(\\mathbf{r},t) = \\boldsymbol{\\sigma}_K(\\mathbf{r},t) + \\boldsymbol{\\sigma}_C(\\mathbf{r},t) $$\n1.  **Kinetic Contribution ($\\boldsymbol{\\sigma}_K$):** This term represents momentum transport due to atomic motion. For the stress to be an objective, frame-independent quantity, it must describe momentum flux relative to the local mean flow. Therefore, the kinetic term must be calculated using the **peculiar velocities** of the atoms, $\\mathbf{c}_i(t) = \\mathbf{v}_i(t) - \\mathbf{u}(\\mathbf{r}_i(t), t)$, where $\\mathbf{u}(\\mathbf{r},t)$ is the local streaming velocity field. Using the total velocity $\\mathbf{v}_i(t)$ would incorrectly include an advective term ($\\rho \\mathbf{u} \\otimes \\mathbf{u}$) that depends on the observer's reference frame.\n2.  **Configurational Contribution ($\\boldsymbol{\\sigma}_C$):** This term represents momentum transfer via interatomic forces. The expression for this term uses the **actual, non-affine atomic positions** $\\mathbf{r}_i(t)$. This is crucial because it naturally incorporates the effects of local rearrangements, thermal vibrations, and the complex strain fields around defects, which are essential for describing the mechanics of real materials. Approximations like the Cauchy–Born rule, which assume affine deformation, are only valid for perfect, defect-free crystals and would fail here.\n3.  **Averaging:** The raw, microscopic IK expression is singular (containing Dirac delta functions) and noisy. To obtain a smooth continuum field, two averaging procedures are essential:\n    *   **Spatial Averaging:** The microscopic stress is convolved with a smoothing kernel of width $l$. A critical **separation of scales** must exist: the averaging length $l$ must be large enough to contain many atoms ($l \\gg a$, where $a$ is the atomic spacing) but small enough to resolve macroscopic stress gradients ($l \\ll L$).\n    *   **Temporal Averaging:** To remove high-frequency noise from thermal vibrations, the field must be averaged over a time window $\\Delta t$. This window must also respect a separation of scales: it must be longer than the characteristic vibrational period ($\\Delta t \\gg \\tau_{\\mathrm{vib}}$) but shorter than the time scale of macroscopic changes in the system ($\\Delta t \\ll \\tau_{\\mathrm{drift}}$).\n\n**Analysis of Options:**\n-   **Option A** correctly combines all these principles: it uses the IK formula, properly defines the kinetic term with peculiar velocities, includes non-affine kinematics, and specifies the correct spatial and temporal averaging scales. It represents the standard, rigorous methodology.\n-   **Option B** is incorrect because it neglects averaging, dismisses thermal fluctuations, and wrongly assumes non-affine displacements are negligible, especially near defects.\n-   **Option C** is incorrect because it uses an averaging length $l \\sim a$ that is too small and fails to use a local streaming velocity for the kinetic term.\n-   **Option D** is incorrect because it discards essential physics by enforcing affine kinematics (Cauchy-Born rule), making it unsuitable for a system with defects and thermal motion.\n-   **Option E** is incorrect because its averaging length $l \\sim L$ is too large (washing out all spatial detail), and it fails to perform time averaging or correctly handle the kinetic term.\n\nTherefore, option A is the only one that describes a physically sound and numerically robust protocol for bridging the atomistic and continuum scales in stress calculation.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Beyond extracting information, the hierarchy of models provides powerful predictive tools, such as continuum micromechanics, for estimating bulk properties from the characteristics of a material's microstructure. This practice  exemplifies this approach by tasking you with the homogenization of a polycrystalline material's elastic response. Starting from the anisotropic elasticity of single crystals, you will apply the classic Voigt and Reuss averaging schemes—which provide rigorous upper and lower bounds on the effective moduli—to predict the isotropic elastic constants of the macroscopic polycrystal, thereby building essential skills in homogenization theory.",
            "id": "3815463",
            "problem": "A statistically isotropic polycrystal is formed by an ensemble of randomly oriented cubic single crystals. You are to connect single-crystal elasticity to the emergent polycrystal elasticity through homogenization within the hierarchy of materials modeling approaches, using the Hill–Mandel macrohomogeneity condition and well-posed uniform field assumptions. Start from the following fundamental bases: (i) the Hill–Mandel condition of energy equivalence, which states that the macroscopic strain energy density equals the volume average of the microscopic strain energy density, (ii) Cauchy linear elasticity for each crystal, with stress–strain relation given by a fourth-order stiffness tensor, and (iii) statistical isotropy of the orientation distribution (random texture).\n\nThe single-crystal stiffness tensor of each cubic crystal in its crystallographic basis has the nonzero Voigt components $C_{11}$, $C_{12}$, and $C_{44}$, with the usual cubic symmetry. Consider two classical scale-bridging assumptions:\n- the Voigt (uniform strain) assumption, in which the microscopic strain is equal to the macroscopic strain in every grain, and\n- the Reuss (uniform stress) assumption, in which the microscopic stress is equal to the macroscopic stress in every grain.\n\nTasks:\n1) Using the Hill–Mandel condition and the uniform strain assumption, derive the effective bulk modulus $K_{V}$ and shear modulus $G_{V}$ of the isotropic polycrystal in terms of the single-crystal stiffness components $C_{11}$, $C_{12}$, and $C_{44}$.\n2) Using the Hill–Mandel condition and the uniform stress assumption, derive the effective bulk modulus $K_{R}$ and shear modulus $G_{R}$ of the isotropic polycrystal in terms of the single-crystal compliance components $S_{11}$, $S_{12}$, and $S_{44}$ (the inverse of the stiffness).\n3) Form the Hill averages $K_{H}$ and $G_{H}$ as the arithmetic means of the Voigt and Reuss moduli.\n4) For a cubic metal with $C_{11} = 106\\,\\text{GPa}$, $C_{12} = 60\\,\\text{GPa}$, and $C_{44} = 28\\,\\text{GPa}$, evaluate the Hill-averaged isotropic Young’s modulus $E_{H}$ of the polycrystal using the standard isotropic relationship between $K$, $G$, and $E$.\n\nExpress the final answer for $E_{H}$ in $\\text{GPa}$ and round your answer to four significant figures.",
            "solution": "The problem statement describes a classical problem in the micromechanics of materials, specifically the homogenization of a polycrystal's elastic properties from its single-crystal constituents. All premises are scientifically sound and the problem is well-posed. We shall proceed with the derivation and calculation.\n\nThe foundation of this analysis is the Hill–Mandel macrohomogeneity condition, which states that the macroscopic strain-energy density is the volume average of the microscopic strain-energy density. If we denote macroscopic quantities with an overbar (e.g., $\\overline{\\boldsymbol{\\sigma}}$, $\\overline{\\boldsymbol{\\epsilon}}$) and microscopic quantities as functions of position $\\mathbf{x}$ (e.g., $\\boldsymbol{\\sigma}(\\mathbf{x})$, $\\boldsymbol{\\epsilon}(\\mathbf{x})$), the condition is expressed as:\n$$\n\\overline{\\boldsymbol{\\sigma}}:\\overline{\\boldsymbol{\\epsilon}} = \\langle \\boldsymbol{\\sigma}(\\mathbf{x}):\\boldsymbol{\\epsilon}(\\mathbf{x}) \\rangle\n$$\nwhere $\\langle \\cdot \\rangle$ denotes the volume averaging operator. The macroscopic stress and strain are defined as the volume averages of their microscopic counterparts, $\\overline{\\boldsymbol{\\sigma}} = \\langle\\boldsymbol{\\sigma}(\\mathbf{x})\\rangle$ and $\\overline{\\boldsymbol{\\epsilon}} = \\langle\\boldsymbol{\\epsilon}(\\mathbf{x})\\rangle$. The constitutive relation at the microscale is $\\boldsymbol{\\sigma}(\\mathbf{x}) = \\mathbf{C}(\\mathbf{x}):\\boldsymbol{\\epsilon}(\\mathbf{x})$, where $\\mathbf{C}(\\mathbf{x})$ is the fourth-order stiffness tensor of the crystal grain at position $\\mathbf{x}$. The macroscopic relation is $\\overline{\\boldsymbol{\\sigma}} = \\mathbf{C}^{\\text{eff}}:\\overline{\\boldsymbol{\\epsilon}}$, where $\\mathbf{C}^{\\text{eff}}$ is the effective stiffness tensor we seek to determine.\n\nA general fourth-order stiffness tensor for a cubic crystal has three independent components, which in Voigt notation are $C_{11}$, $C_{12}$, and $C_{44}$. It is convenient to decompose this tensor based on irreducible representations of the rotation group, which for elasticity corresponds to a hydrostatic (scalar) part and a deviatoric (shear) part. The cubic tensor can be written as:\n$$\n\\mathbf{C} = 3K\\mathbf{J} + 2G'\\mathbf{K}' + 2G''\\mathbf{K}''\n$$\nwhere $\\mathbf{J}$, $\\mathbf{K}'$, and $\\mathbf{K}''$ are projection operators. The single-crystal bulk modulus $K$ and two shear moduli $G'$ and $G''$ are related to the Voigt components by:\n$$\nK = \\frac{C_{11} + 2C_{12}}{3}\n$$\n$$\nG' = C_{44}\n$$\n$$\nG'' = \\frac{C_{11} - C_{12}}{2}\n$$\n\nThe target effective medium is an isotropic polycrystal, so its stiffness tensor $\\mathbf{C}^{\\text{eff}}$ must be isotropic. An isotropic tensor is characterized by only two constants, the bulk modulus $K^{\\text{eff}}$ and the shear modulus $G^{\\text{eff}}$.\n\n1) Voigt (Uniform Strain) Assumption\nThe Voigt assumption posits that the strain is uniform throughout the material, i.e., $\\boldsymbol{\\epsilon}(\\mathbf{x}) = \\overline{\\boldsymbol{\\epsilon}}$. This assumption trivially satisfies the strain averaging condition $\\langle \\boldsymbol{\\epsilon}(\\mathbf{x}) \\rangle = \\overline{\\boldsymbol{\\epsilon}}$. The macroscopic stress is then the volume average of the microscopic stresses:\n$$\n\\overline{\\boldsymbol{\\sigma}} = \\langle \\boldsymbol{\\sigma}(\\mathbf{x}) \\rangle = \\langle \\mathbf{C}(\\mathbf{x}):\\boldsymbol{\\epsilon}(\\mathbf{x}) \\rangle = \\langle \\mathbf{C}(\\mathbf{x}):\\overline{\\boldsymbol{\\epsilon}} \\rangle = \\langle \\mathbf{C}(\\mathbf{x}) \\rangle:\\overline{\\boldsymbol{\\epsilon}}\n$$\nThus, the Voigt effective stiffness tensor $\\mathbf{C}_V$ is the orientational average of the single-crystal stiffness tensor: $\\mathbf{C}_V = \\langle \\mathbf{C} \\rangle$. To find the effective moduli $K_V$ and $G_V$, we average the decomposed tensor:\n$$\n\\mathbf{C}_V = \\langle 3K\\mathbf{J} + 2G'\\mathbf{K}' + 2G''\\mathbf{K}'' \\rangle = 3K\\langle\\mathbf{J}\\rangle + 2G'\\langle\\mathbf{K}'\\rangle + 2G''\\langle\\mathbf{K}''\\rangle\n$$\nAs $K$, $G'$, and $G''$ are scalars, they are not affected by the averaging. The hydrostatic projector $\\mathbf{J}$ is isotropic, so $\\langle\\mathbf{J}\\rangle = \\mathbf{J}$. The averaging of the anisotropic shear projectors $\\mathbf{K}'$ and $\\mathbf{K}''$ over all orientations yields isotropic tensors. It can be shown that $\\langle\\mathbf{K}'\\rangle = \\frac{3}{5}\\mathbf{K}_{\\text{dev}}$ and $\\langle\\mathbf{K}''\\rangle = \\frac{2}{5}\\mathbf{K}_{\\text{dev}}$, where $\\mathbf{K}_{\\text{dev}}$ is the isotropic deviatoric projection tensor.\nThe bulk modulus part of $\\mathbf{C}_V$ is $3K\\mathbf{J}$, so the effective bulk modulus is:\n$$\nK_V = K = \\frac{C_{11} + 2C_{12}}{3}\n$$\nThe shear modulus part of $\\mathbf{C}_V$ is $2G_V\\mathbf{K}_{\\text{dev}} = 2G'(\\frac{3}{5}\\mathbf{K}_{\\text{dev}}) + 2G''(\\frac{2}{5}\\mathbf{K}_{\\text{dev}})$. This yields the effective shear modulus:\n$$\nG_V = \\frac{3}{5}G' + \\frac{2}{5}G'' = \\frac{3}{5}C_{44} + \\frac{2}{5}\\left(\\frac{C_{11}-C_{12}}{2}\\right) = \\frac{1}{5}(C_{11} - C_{12} + 3C_{44})\n$$\n\n2) Reuss (Uniform Stress) Assumption\nThe Reuss assumption posits that the stress is uniform, $\\boldsymbol{\\sigma}(\\mathbf{x}) = \\overline{\\boldsymbol{\\sigma}}$. This is dual to the Voigt case. We work with the compliance tensor $\\mathbf{S} = \\mathbf{C}^{-1}$. The micro-constitutive law is $\\boldsymbol{\\epsilon}(\\mathbf{x}) = \\mathbf{S}(\\mathbf{x}):\\boldsymbol{\\sigma}(\\mathbf{x})$. The macroscopic strain is:\n$$\n\\overline{\\boldsymbol{\\epsilon}} = \\langle \\boldsymbol{\\epsilon}(\\mathbf{x}) \\rangle = \\langle \\mathbf{S}(\\mathbf{x}):\\boldsymbol{\\sigma}(\\mathbf{x}) \\rangle = \\langle \\mathbf{S}(\\mathbf{x}):\\overline{\\boldsymbol{\\sigma}} \\rangle = \\langle \\mathbf{S}(\\mathbf{x}) \\rangle:\\overline{\\boldsymbol{\\sigma}}\n$$\nThus, the Reuss effective compliance tensor is $\\mathbf{S}_R = \\langle \\mathbf{S} \\rangle$. The Reuss stiffness is then $\\mathbf{C}_R = (\\mathbf{S}_R)^{-1}$. The same averaging logic applies to $\\mathbf{S}$. The single-crystal compliance tensor for a cubic material has components $S_{11}$, $S_{12}$, and $S_{44}$. These are related to the stiffness components by:\n$$S_{11} = \\frac{C_{11}+C_{12}}{(C_{11}-C_{12})(C_{11}+2C_{12})}, \\quad S_{12} = \\frac{-C_{12}}{(C_{11}-C_{12})(C_{11}+2C_{12})}, \\quad S_{44} = \\frac{1}{C_{44}}$$\nThe Reuss bulk modulus $K_R$ and shear modulus $G_R$ are obtained by inverting the averaged compliance. By duality, we replace stiffness components with compliance components in the averaging formulae. The effective bulk compliance is $1/K_R$ and the effective shear compliance is $1/G_R$.\nFor the bulk modulus:\n$$\n\\frac{1}{K_R} = 3(S_{11} + 2S_{12}) = 3\\left(\\frac{C_{11}+C_{12}}{(C_{11}-C_{12})(C_{11}+2C_{12})} + 2\\frac{-C_{12}}{(C_{11}-C_{12})(C_{11}+2C_{12})}\\right) = \\frac{3(C_{11}-C_{12})}{(C_{11}-C_{12})(C_{11}+2C_{12})} = \\frac{3}{C_{11}+2C_{12}}\n$$\nThis confirms $K_R = \\frac{C_{11}+2C_{12}}{3} = K_V$. So we denote $K_H=K_V=K_R$. The Reuss bulk modulus in terms of compliance components is $K_R = \\frac{1}{3(S_{11}+2S_{12})}$.\nFor the shear modulus, the averaging is a harmonic mean structure, dual to the arithmetic mean in the Voigt case:\n$$\n\\frac{1}{G_R} = \\frac{3}{5}\\frac{1}{G'} + \\frac{2}{5}\\frac{1}{G''} = \\frac{3}{5}S_{44} + \\frac{2}{5}\\left(2(S_{11}-S_{12})\\right) = \\frac{1}{5}(4(S_{11}-S_{12}) + 3S_{44})\n$$\nThus, the Reuss shear modulus is:\n$$\nG_R = \\frac{5}{4(S_{11}-S_{12}) + 3S_{44}}\n$$\n\n3) Hill Averages\nThe Hill averages are the arithmetic means of the Voigt (upper bound) and Reuss (lower bound) moduli:\n$$\nK_H = \\frac{K_V + K_R}{2} \\quad \\text{and} \\quad G_H = \\frac{G_V + G_R}{2}\n$$\nSince $K_V = K_R$ for cubic polycrystals, $K_H = K_V = K_R = \\frac{C_{11}+2C_{12}}{3}$.\nThe Hill shear modulus is $G_H = \\frac{1}{2}(G_V + G_R)$.\n\n4) Numerical Evaluation\nWe are given the stiffness components for a cubic metal: $C_{11} = 106\\,\\text{GPa}$, $C_{12} = 60\\,\\text{GPa}$, and $C_{44} = 28\\,\\text{GPa}$.\nFirst, we calculate the Hill-averaged bulk and shear moduli.\nThe bulk modulus is:\n$$\nK_H = \\frac{C_{11} + 2C_{12}}{3} = \\frac{106 + 2(60)}{3} = \\frac{106 + 120}{3} = \\frac{226}{3}\\,\\text{GPa}\n$$\nThe Voigt shear modulus is:\n$$\nG_V = \\frac{1}{5}(C_{11} - C_{12} + 3C_{44}) = \\frac{1}{5}(106 - 60 + 3(28)) = \\frac{1}{5}(46 + 84) = \\frac{130}{5} = 26\\,\\text{GPa}\n$$\nThe Reuss shear modulus is calculated by first finding the compliance components or using the inverted formula:\n$$\nG_R = \\frac{5(C_{11}-C_{12})C_{44}}{4C_{44} + 3(C_{11}-C_{12})} = \\frac{5(46)(28)}{4(28) + 3(46)} = \\frac{6440}{112 + 138} = \\frac{6440}{250} = 25.76\\,\\text{GPa}\n$$\nThe Hill shear modulus is the arithmetic average:\n$$\nG_H = \\frac{G_V + G_R}{2} = \\frac{26 + 25.76}{2} = \\frac{51.76}{2} = 25.88\\,\\text{GPa}\n$$\nFinally, we compute the Hill-averaged Young's modulus $E_H$ using the standard formula for isotropic materials that relates Young's modulus $E$, bulk modulus $K$, and shear modulus $G$:\n$$\nE = \\frac{9KG}{3K+G}\n$$\nSubstituting our calculated Hill-averaged values:\n$$\nE_H = \\frac{9 K_H G_H}{3 K_H + G_H} = \\frac{9 \\left(\\frac{226}{3}\\right) (25.88)}{3 \\left(\\frac{226}{3}\\right) + 25.88} = \\frac{3(226)(25.88)}{226 + 25.88} = \\frac{678 \\times 25.88}{251.88} = \\frac{17546.64}{251.88} \\approx 69.66429\\,\\text{GPa}\n$$\nRounding the result to four significant figures, we get $E_H = 69.66\\,\\text{GPa}$.",
            "answer": "$$\n\\boxed{69.66}\n$$"
        }
    ]
}