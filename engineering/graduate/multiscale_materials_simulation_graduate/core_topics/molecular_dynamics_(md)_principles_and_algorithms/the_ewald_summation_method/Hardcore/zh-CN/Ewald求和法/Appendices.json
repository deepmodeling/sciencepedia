{
    "hands_on_practices": [
        {
            "introduction": "理论的最佳检验是实践。本章的第一个动手练习将指导您从第一性原理出发，构建一个完整的埃瓦尔德求和程序。我们的目标是计算马德隆常数——一个描述离子晶体静电能的基本物理量，这也是检验我们程序正确性的绝佳案例。通过这个练习 ()，您将巩固对实空间、倒易空间和自能修正项的理解。",
            "id": "3846353",
            "problem": "您的任务是实现一个完整、可运行的程序，使用 Ewald 求和方法 (ESM) 计算几种周期性离子晶体的无量纲马德隆常数。此处的马德隆常数定义为每个化学式单位的静电能，并以基本能量标度 $q^2/a$ 进行归一化，其中 $q$ 是离子电荷的大小，$a$ 是立方晶格常数。您的推导和实现必须从库仑定律和周期性边界条件的基本原理出发，并且不得假定任何预先给定的 Ewald 分解快捷公式。\n\n核心目标是对一个三维、周期性且电中性的晶体进行数值评估：\n- 使用短程屏蔽相互作用计算实空间对静电能的贡献，\n- 使用傅里叶空间屏蔽计算倒易空间的贡献，\n- 以及由分裂过程引起的自能校正。\n\n出发点是：\n- 点电荷的库仑定律：两个相距为 $r$ 的电荷 $q_i$ 和 $q_j$ 之间的势在无量纲形式下为 $q_i q_j / r$，\n- 通过对所有由布拉维晶格矢量 $\\mathbf{R}$ 表征的晶格映像的相互作用求和来施加周期性边界条件，\n- 以及马德隆常数 $M$ 的定义为 $M = \\dfrac{a}{q^2} \\dfrac{E_{\\text{cell}}}{N_{\\text{pairs}}}$，其中 $E_{\\text{cell}}$ 是每个晶胞的总静电能，$N_{\\text{pairs}}$ 是每个晶胞中带相反电荷的离子对（化学式单位）的数量。本问题中的所有量都是无量纲的，并以介电常数因子被吸收的单位进行度量，因此不需要物理单位。\n\n您必须实现一个算法，该算法：\n- 用给定的 $a$ 通过立方晶格矢量 $\\mathbf{a}_1 = a \\hat{\\mathbf{x}}$, $\\mathbf{a}_2 = a \\hat{\\mathbf{y}}$, $\\mathbf{a}_3 = a \\hat{\\mathbf{z}}$ 来表示晶体，\n- 使用分数坐标基矢位置 $\\{\\mathbf{f}_j\\}$，并将其映射到笛卡尔坐标位置 $\\mathbf{r}_j = \\mathbf{L} \\mathbf{f}_j$，其中 $\\mathbf{L}$ 是一个 $3 \\times 3$ 矩阵，其列为 $\\mathbf{a}_1$, $\\mathbf{a}_2$, $\\mathbf{a}_3$，\n- 为每个基点分配电荷 $\\{q_j\\}$，使得 $\\sum_j q_j = 0$（电中性），\n- 枚举实空间晶格矢量 $\\mathbf{R} = n_1 \\mathbf{a}_1 + n_2 \\mathbf{a}_2 + n_3 \\mathbf{a}_3$，其中整数 $(n_1,n_2,n_3)$ 仅限于满足 $\\|\\mathbf{R}\\| \\le r_{\\text{cut}}$ 的矢量，\n- 枚举倒易空间晶格矢量 $\\mathbf{G} = m_1 \\mathbf{b}_1 + m_2 \\mathbf{b}_2 + m_3 \\mathbf{b}_3$，其中 $\\mathbf{b}_i$ 是由 $\\mathbf{B} = 2\\pi \\mathbf{L}^{-T}$ 定义的倒易晶格矢量，整数 $(m_1,m_2,m_3)$ 仅限于满足 $\\|\\mathbf{G}\\| \\le g_{\\text{cut}}$ 且不包括 $\\mathbf{G} = \\mathbf{0}$ 的矢量，\n- 使用一个分裂参数 $\\alpha > 0$，通过互补误差函数和高斯屏蔽来分离短程和长程部分，\n- 包括分裂势的自相互作用校正项，以及\n- 得出总静电能 $E_{\\text{cell}}$，并由此计算出马德隆常数 $M$。\n\n您的程序必须实现上述过程，并为以下测试套件计算马德隆常数。所有量都是无量纲的，$a$ 是立方晶格常数，电荷以 $q$ 为单位，其中 $q = 1$ 用于归一化：\n\n- 测试用例 1 (正常路径，体心基矢)：\n  - 晶格常数 $a = 1$。\n  - 基矢位置 (分数坐标)：$(0,0,0)$ 带电荷 $+1$，$(\\tfrac{1}{2}, \\tfrac{1}{2}, \\tfrac{1}{2})$ 带电荷 $-1$。\n  - 分裂参数 $\\alpha = 5$。\n  - 实空间截断半径 $r_{\\text{cut}} = 6$。\n  - 倒易空间截断半径 $g_{\\text{cut}} = 20$。\n  - 这对应于氯化铯结构。\n\n- 测试用例 2 (面心立方子晶格，常规立方晶胞)：\n  - 晶格常数 $a = 1$。\n  - 基矢位置 (分数坐标)，$8$ 个位置：\n    - 氯离子子晶格 (电荷 $-1$)：$(0,0,0)$、$(0,\\tfrac{1}{2},\\tfrac{1}{2})$、$(\\tfrac{1}{2},0,\\tfrac{1}{2})$、$(\\tfrac{1}{2},\\tfrac{1}{2},0)$。\n    - 钠离子子晶格 (电荷 $+1$)：$(\\tfrac{1}{2},0,0)$、$(0,\\tfrac{1}{2},0)$、$(0,0,\\tfrac{1}{2})$、$(\\tfrac{1}{2},\\tfrac{1}{2},\\tfrac{1}{2})$。\n  - 分裂参数 $\\alpha = 6$。\n  - 实空间截断半径 $r_{\\text{cut}} = 6$。\n  - 倒易空间截断半径 $g_{\\text{cut}} = 20$。\n  - 这对应于氯化钠结构。\n\n- 测试用例 3 (闪锌矿结构，带四面体位移的面心立方)：\n  - 晶格常数 $a = 1$。\n  - 基矢位置 (分数坐标)，$8$ 个位置：\n    - 硫离子子晶格 (电荷 $-1$)：$(0,0,0)$、$(0,\\tfrac{1}{2},\\tfrac{1}{2})$、$(\\tfrac{1}{2},0,\\tfrac{1}{2})$、$(\\tfrac{1}{2},\\tfrac{1}{2},0)$。\n    - 锌离子子晶格 (电荷 $+1$)：$(\\tfrac{1}{4},\\tfrac{1}{4},\\tfrac{1}{4})$、$(\\tfrac{3}{4},\\tfrac{1}{4},\\tfrac{3}{4})$、$(\\tfrac{1}{4},\\tfrac{3}{4},\\tfrac{3}{4})$、$(\\tfrac{3}{4},\\tfrac{3}{4},\\tfrac{1}{4})$。\n  - 分裂参数 $\\alpha = 5$。\n  - 实空间截断半径 $r_{\\text{cut}} = 6$。\n  - 倒易空间截断半径 $g_{\\text{cut}} = 20$。\n\n- 测试用例 4 (使用不同分裂和更紧密截断的边缘稳定性检查)：\n  - 晶格常数 $a = 1$。\n  - 基矢位置 (分数坐标)：$(0,0,0)$ 带电荷 $+1$，$(\\tfrac{1}{2}, \\tfrac{1}{2}, \\tfrac{1}{2})$ 带电荷 $-1$。\n  - 分裂参数 $\\alpha = 3$。\n  - 实空间截断半径 $r_{\\text{cut}} = 4$。\n  - 倒易空间截断半径 $g_{\\text{cut}} = 12$。\n\n您的程序应生成单行输出，其中包含四个测试用例计算出的马德隆常数，格式为方括号内以逗号分隔的列表，并四舍五入到六位小数，例如：$[\\text{result1},\\text{result2},\\text{result3},\\text{result4}]$。不应打印任何其他文本。\n\n最终输出不涉及角度。由于所有量都是无量纲的，因此无需报告物理单位。您在解答中的推导必须从第一性原理出发，引入并论证 Ewald 分裂，并清晰地将推导过程与程序中实现的算法步骤联系起来。首次使用缩略词时需展开，例如 Ewald 求和方法 (Ewald Summation Method, ESM) 和泊松求和公式 (Poisson Summation Formula, PSF)。",
            "solution": "该问题要求计算周期性离子晶体的无量纲马德隆常数。该常数表征了晶格的静电势能。对于晶胞内 $N$ 个位于基矢位置 $\\mathbf{r}_i$ 上的点电荷 $q_i$ 构成的电中性周期性排列，每个晶胞的总静电能 $E_{\\text{cell}}$ 由整个晶体中所有离子对之间的相互作用总和给出。这可以表示为对参考晶胞中的原子对 $(i, j)$ 以及所有布拉维晶格矢量 $\\mathbf{R}$ 的求和：\n$$\nE_{\\text{cell}} = \\frac{1}{2} \\sum_{i=1}^{N} \\sum_{j=1}^{N} \\sideset{}{'}\\sum_{\\mathbf{R}} \\frac{q_i q_j}{|\\mathbf{r}_{ij} + \\mathbf{R}|}\n$$\n此处，$\\mathbf{r}_{ij} = \\mathbf{r}_i - \\mathbf{r}_j$ 是参考晶胞中离子 $i$ 和 $j$ 之间的分离矢量。带撇号的求和 $\\sum'$ 表示当晶格矢量 $\\mathbf{R} = \\mathbf{0}$ 时，排除 $i=j$ 的项，这可以防止电荷与自身的无限自相互作用。因子 $1/2$ 用于校正对每对相互作用的双重计数。该问题使用无量纲单位，其中势为 $q_i q_j/r$。\n\n直接对 $1/r$ 势进行求和是有问题的。该和是条件收敛的，意味着其值取决于求和的顺序。为了克服这个问题，我们采用 Ewald 求和方法 (ESM)。ESM 的核心思想是使用一个涉及互补误差函数 $\\text{erfc}(x)$ 和误差函数 $\\text{erf}(x)$ 的数学恒等式，将库仑势分裂为两部分：\n$$\n\\frac{1}{r} = \\frac{\\text{erfc}(\\alpha r)}{r} + \\frac{\\text{erf}(\\alpha r)}{r}\n$$\n参数 $\\alpha$ 控制分裂的宽度。第一项包含 $\\text{erfc}(\\alpha r)$，是一个短程函数，衰减迅速（类似高斯函数）。通过只包含少数相邻晶胞，可以在实空间中高效地对其求和。第二项包含 $\\text{erf}(\\alpha r)$，是一个长程、平滑的函数。其平滑性使其适合在倒易（傅里叶）空间中进行高效求和。\n\n这种分解使我们能够将总能量 $E_{\\text{cell}}$ 分为三个部分：实空间和 $E_{\\text{real}}$、倒易空间和 $E_{\\text{recip}}$ 以及自相互作用校正 $E_{\\text{self}}$。\n$$\nE_{\\text{cell}} = E_{\\text{real}} + E_{\\text{recip}} + E_{\\text{self}}\n$$\n\n实空间贡献 $E_{\\text{real}}$ 是通过对所有相关对的势的短程部分求和得到的：\n$$\nE_{\\text{real}} = \\frac{1}{2} \\sum_{i=1}^{N} \\sum_{j=1}^{N} \\sideset{}{'}\\sum_{\\mathbf{R}} q_i q_j \\frac{\\text{erfc}(\\alpha |\\mathbf{r}_{ij} + \\mathbf{R}|)}{|\\mathbf{r}_{ij} + \\mathbf{R}|}\n$$\n由于 $\\text{erfc}(x)$ 的快速衰减，对晶格矢量 $\\mathbf{R}$ 的求和可以在所有 $|\\mathbf{R}|$ 大于选定的截断半径 $r_{\\text{cut}}$ 时被截断。算法会遍历所有基矢原子对 $(i, j)$ 和截断球内的所有晶格矢量 $\\mathbf{R}$。对于每种组合，它会计算距离并加上相应的能量项，同时排除 $i=j, \\mathbf{R}=\\mathbf{0}$ 的情况。\n\n倒易空间贡献 $E_{\\text{recip}}$ 处理势的长程部分。我们不直接对平滑的势求和，而是将其变换到倒易空间，在那里它变为短程的。这一变换通过使用泊松求和公式 (Poisson Summation Formula, PSF) 得到严格证明，该公式将一个函数在晶格上的和与其傅里叶变换在倒易晶格上的和联系起来。将 PSF 应用于长程势项，可得到能量表达式为倒易晶格矢量 $\\mathbf{G}$ 上的和：\n$$\nE_{\\text{recip}} = \\frac{2\\pi}{V} \\sum_{\\mathbf{G} \\ne 0} \\frac{e^{-G^2 / (4\\alpha^2)}}{G^2} |S(\\mathbf{G})|^2\n$$\n此处，$V$ 是晶胞的体积，$G = |\\mathbf{G}|$，$S(\\mathbf{G})$ 是结构因子，定义为：\n$$\nS(\\mathbf{G}) = \\sum_{j=1}^{N} q_j e^{-i \\mathbf{G} \\cdot \\mathbf{r}_j}\n$$\n倒易晶格矢量由 $\\mathbf{G} = m_1 \\mathbf{b}_1 + m_2 \\mathbf{b}_2 + m_3 \\mathbf{b}_3$ 给出，其中 $m_k$ 为整数，基矢 $\\mathbf{b}_i$ 由实空间晶格矢量 $\\mathbf{a}_i$ 通过 $\\mathbf{B} = 2\\pi (\\mathbf{L}^{-T})$ 推导得出，其中 $\\mathbf{L}$ 和 $\\mathbf{B}$ 分别是列为 $\\mathbf{a}_i$ 和 $\\mathbf{b}_i$ 的矩阵。$\\mathbf{G}=\\mathbf{0}$ 项被排除，因为晶胞的整体电中性（$\\sum q_j = 0$）确保了 $S(\\mathbf{G}=\\mathbf{0})=0$。由于高斯项 $e^{-G^2 / (4\\alpha^2)}$ 的存在，倒易空间中的和收敛很快，因此可以在一个截断半径 $g_{\\text{cut}}$ 之外被截断。算法会遍历所有达到此截断半径的倒易晶格矢量 $\\mathbf{G}$，计算结构因子模的平方 $|S(\\mathbf{G})|^2$，并将相应的项加到总和中。\n\nEwald 分裂过程通过用于推导倒易空间项的平滑高斯电荷分布，人为地引入了每个电荷与其自身的相互作用。这种非物理的自能必须被减去。这个校正项 $E_{\\text{self}}$ 是一个点电荷 $q_i$ 与其自身的中和高斯电荷分布所产生的势相互作用的能量，并对基矢中的所有原子求和。一个电荷自身的误差函数项在 $r=0$ 处的势为 $\\lim_{r\\to 0} \\frac{\\text{erf}(\\alpha r)}{r} = \\frac{2\\alpha}{\\sqrt{\\pi}}$。总校正将此项对所有基矢原子求和，得到：\n$$\nE_{\\text{self}} = -\\frac{1}{2} \\sum_{i=1}^{N} q_i^2 \\left( \\frac{2\\alpha}{\\sqrt{\\pi}} \\right) = - \\frac{\\alpha}{\\sqrt{\\pi}} \\sum_{i=1}^{N} q_i^2\n$$\n对于给定的晶体结构和 $\\alpha$ 值，这是一个简单的常数项。\n\n最后，根据问题中的规定，从总能量 $E_{\\text{cell}}$ 计算无量纲马德隆常数 $M$：\n$$\nM = \\frac{a}{q^2} \\frac{E_{\\text{cell}}}{N_{\\text{pairs}}}\n$$\n其中 $a$ 是立方晶格常数，$q$ 是基本离子电荷的大小（此处 $q=1$），$N_{\\text{pairs}}$ 是计算晶胞中的化学式单位数。对于 CsCl 结构在其原胞中，$N_{\\text{pairs}}=1$。对于 NaCl 和 ZnS 结构在其常规立方晶胞中，$N_{\\text{pairs}}=4$。实现将根据指定的截断半径和参数计算 $E_{\\text{real}}$, $E_{\\text{recip}}$ 和 $E_{\\text{self}}$，将它们相加得到 $E_{\\text{cell}}$，然后进行归一化以求得 $M$。",
            "answer": "```python\nimport numpy as np\nfrom scipy.special import erfc\n\ndef compute_madelung(a, basis_frac, charges, alpha, rcut, gcut, N_pairs):\n    \"\"\"\n    Computes the Madelung constant for a periodic ionic crystal using the Ewald summation method.\n\n    All quantities are dimensionless as per the problem description.\n    \"\"\"\n    # Convert fractional basis positions to Cartesian coordinates\n    L_matrix = a * np.identity(3)\n    basis_cart = np.dot(np.array(basis_frac), L_matrix)\n    \n    # Unit cell volume\n    V = np.linalg.det(L_matrix)\n    \n    # Reciprocal lattice vectors basis\n    B_matrix = 2 * np.pi * np.linalg.inv(L_matrix).T\n    \n    N = len(charges)\n    q_arr = np.array(charges)\n\n    # --- 1. Real-space contribution ---\n    E_real = 0.0\n    # Determine the integer range for lattice vectors R based on rcut\n    n_max = int(np.ceil(rcut / a)) if a > 0 else 0\n    \n    for n1 in range(-n_max, n_max + 1):\n        for n2 in range(-n_max, n_max + 1):\n            for n3 in range(-n_max, n_max + 1):\n                R = np.dot([n1, n2, n3], L_matrix)\n                # Skip R vectors outside the cutoff sphere to be more efficient,\n                # although the loops are bounded by a cube that contains the sphere.\n                if np.linalg.norm(R) > rcut + a: # add a buffer to include all pairs\n                    continue\n\n                for i in range(N):\n                    for j in range(N):\n                        # Exclude self-interaction term for the central cell (R=0)\n                        if i == j and n1 == 0 and n2 == 0 and n3 == 0:\n                            continue\n                        \n                        r_ij = basis_cart[i] - basis_cart[j]\n                        dist_vec = r_ij + R\n                        dist = np.linalg.norm(dist_vec)\n                        \n                        if dist = rcut and dist > 1e-9: # Avoid division by zero for overlapping atoms\n                            E_real += q_arr[i] * q_arr[j] * erfc(alpha * dist) / dist\n    \n    E_real *= 0.5\n\n    # --- 2. Reciprocal-space contribution ---\n    E_recip = 0.0\n    # Determine the integer range for reciprocal vectors G based on gcut\n    # Using a cubic search box in integer space that encloses the gcut sphere\n    m_max = 0\n    if a > 0:\n        # Find the max integer index m required to cover the gcut sphere\n        # For a cubic lattice, b_i vectors are orthogonal and of length 2pi/a\n        m_max = int(np.ceil(gcut * a / (2 * np.pi)))\n    \n    for m1 in range(-m_max, m_max + 1):\n        for m2 in range(-m_max, m_max + 1):\n            for m3 in range(-m_max, m_max + 1):\n                # Exclude G=0 term\n                if m1 == 0 and m2 == 0 and m3 == 0:\n                    continue\n                \n                G = np.dot([m1, m2, m3], B_matrix)\n                G_sq = np.dot(G, G)\n\n                if np.sqrt(G_sq) > gcut:\n                    continue\n                \n                # Structure factor S(G)\n                # S(G) = sum_j q_j exp(-i*G.r_j) -- Note: problem used exp(i G.r) in text, but exp(-i G.r) is more conventional for S(G). Result |S(G)|^2 is the same.\n                G_dot_r = np.dot(basis_cart, G)\n                S_real = np.sum(q_arr * np.cos(G_dot_r))\n                S_imag = np.sum(q_arr * np.sin(G_dot_r))\n                abs_S_G_sq = S_real**2 + S_imag**2\n\n                term = (np.exp(-G_sq / (4 * alpha**2)) / G_sq) * abs_S_G_sq\n                E_recip += term\n\n    E_recip *= (2 * np.pi / V)\n\n    # --- 3. Self-energy correction ---\n    E_self = - (alpha / np.sqrt(np.pi)) * np.sum(q_arr**2)\n\n    # --- 4. Total energy and Madelung constant ---\n    E_cell = E_real + E_recip + E_self\n    \n    # Definition from problem: M = (a/q^2) * (E_cell / N_pairs), with q=1\n    M = (a / 1.0**2) * (E_cell / N_pairs)\n    \n    return M\n\ndef solve():\n    test_cases = [\n        # Case 1: CsCl structure\n        {\n            \"a\": 1.0,\n            \"basis_frac\": [(0, 0, 0), (0.5, 0.5, 0.5)],\n            \"charges\": [1, -1],\n            \"alpha\": 5.0,\n            \"rcut\": 6.0,\n            \"gcut\": 20.0,\n            \"N_pairs\": 1\n        },\n        # Case 2: NaCl structure\n        {\n            \"a\": 1.0,\n            \"basis_frac\": [\n                (0.0, 0.0, 0.0), (0.0, 0.5, 0.5), (0.5, 0.0, 0.5), (0.5, 0.5, 0.0), # Cl-\n                (0.5, 0.0, 0.0), (0.0, 0.5, 0.0), (0.0, 0.0, 0.5), (0.5, 0.5, 0.5)  # Na+\n            ],\n            \"charges\": [-1, -1, -1, -1, 1, 1, 1, 1],\n            \"alpha\": 6.0,\n            \"rcut\": 6.0,\n            \"gcut\": 20.0,\n            \"N_pairs\": 4\n        },\n        # Case 3: Zincblende (ZnS) structure\n        {\n            \"a\": 1.0,\n            \"basis_frac\": [\n                (0.0, 0.0, 0.0), (0.0, 0.5, 0.5), (0.5, 0.0, 0.5), (0.5, 0.5, 0.0), # S\n                (0.25, 0.25, 0.25), (0.75, 0.25, 0.75), (0.25, 0.75, 0.75), (0.75, 0.75, 0.25) # Zn\n            ],\n            \"charges\": [-1, -1, -1, -1, 1, 1, 1, 1],\n            \"alpha\": 5.0,\n            \"rcut\": 6.0,\n            \"gcut\": 20.0,\n            \"N_pairs\": 4\n        },\n        # Case 4: CsCl with different parameters\n        {\n            \"a\": 1.0,\n            \"basis_frac\": [(0, 0, 0), (0.5, 0.5, 0.5)],\n            \"charges\": [1, -1],\n            \"alpha\": 3.0,\n            \"rcut\": 4.0,\n            \"gcut\": 12.0,\n            \"N_pairs\": 1\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = compute_madelung(\n            a=case[\"a\"],\n            basis_frac=case[\"basis_frac\"],\n            charges=case[\"charges\"],\n            alpha=case[\"alpha\"],\n            rcut=case[\"rcut\"],\n            gcut=case[\"gcut\"],\n            N_pairs=case[\"N_pairs\"]\n        )\n        results.append(f\"{result:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "一个正确的程序固然重要，但懂得如何正确使用并验证其结果同样关键。本练习 () 专注于收敛性测试和实现验证这些核心技能。我们将探讨分裂参数 $\\alpha$ 和截断半径的选择如何影响计算的精度与效率，并验证我们的代码是否遵循了平移不变性等基本物理原理。",
            "id": "3846371",
            "problem": "您的任务是设计、实现并验证一个数值程序，该程序使用 Ewald 求和方法计算三维 ($3$) 立方周期性单元中一组点电荷的静电相互作用能。重点在于验证和收敛性测试，而不是复现一个已知的封闭形式结果。您的程序必须测试对截断参数的系统性改变是否能产生收敛的能量，以及计算出的能量是否在所有电荷进行统一平移后保持不变，后者是物理周期性所要求的。\n\n从以下基本原理出发：\n- 点电荷的静电相互作用能遵循库仑定律，而在周期性晶体中直接求和是条件收敛的。严格的评估需要一个数学上有效的重求和方法，例如 Ewald 分裂法，它将和分解为短程实空间部分和与长程倒易空间部分和，并加上在导电边界条件下物理上必需的自相互作用校正。\n- 标准定义包括：一个边长为 $L$ 的立方单元，位于位置 $\\mathbf{r}_i$ 的点电荷 $q_i$（整体电荷中性 $\\sum_i q_i = 0$），以及周期性边界条件，该条件对于所有整数 $n_x, n_y, n_z$ 都将 $\\mathbf{r}$ 与 $\\mathbf{r} + n_x L \\hat{\\mathbf{x}} + n_y L \\hat{\\mathbf{y}} + n_z L \\hat{\\mathbf{z}}$ 等同起来。\n\n您的程序必须在导电边界条件（也称为锡箔边界条件）下实现一个正确且物理上一致的 Ewald 求和，并确保：\n- 实空间部分和被一个有限半径 $r_{\\mathrm{cut}}$ 截断。\n- 倒易空间部分和在整数倒易晶格指数空间中被一个球形指数截断值 $n_{\\mathrm{max}}$ 截断。\n- 对每个点电荷进行适当的自相互作用校正。\n- 在完全收敛的极限下，总能量必须与任意的 Ewald 分裂参数 $\\alpha$ 无关。在有限截断的情况下，随着 $r_{\\mathrm{cut}}$ 和 $n_{\\mathrm{max}}$ 的增加，能量应趋于一个稳定值。\n\n所有量均为无量纲，并以约化单位表示，其中基本电荷大小和介电常数已被归一化，使得能量也是无量纲的。立方单元的边长为 $L = 1$。\n\n需实现的验证和收敛性测试协议：\n1. 使用两种 ($2$) 电中性的点电荷构型：\n   - 构型 A：电荷 $q = [ +1, -1 ]$ 位于位置 $\\mathbf{r} = \\{ (0,0,0), (0.5,0,0) \\} \\times L$。\n   - 构型 B：电荷 $q = [ +1, +1, -2 ]$ 位于位置 $\\mathbf{r} = \\{ (0,0,0), (0.25,0.25,0.25), (0.5,0.5,0.5) \\} \\times L$。\n2. 对于每种构型，使用 Ewald 方法及以下参数计算一个高精度的参考能量 $E_{\\mathrm{ref}}$：$\\alpha_{\\mathrm{ref}} = 5.0$, $r_{\\mathrm{cut,ref}} = 4.0$, $n_{\\mathrm{max,ref}} = 30$。\n3. 定义以下测试用例。每个测试用例指定了 $(\\text{构型}, \\alpha, r_{\\mathrm{cut}}, n_{\\mathrm{max}})$：\n   - 测试 $1$：$(\\text{A}, 5.0, 1.5, 8)$。\n   - 测试 $2$：$(\\text{A}, 5.0, 3.0, 15)$。\n   - 测试 $3$：$(\\text{A}, 2.0, 4.0, 20)$。\n   - 测试 $4$：$(\\text{A}, 8.0, 1.2, 25)$。\n   - 测试 $5$：$(\\text{B}, 5.0, 2.0, 12)$。\n   - 测试 $6$：$(\\text{B}, 5.0, 3.5, 20)$。\n4. 对于每个测试用例 $k$，计算能量 $E_k$ 并报告其与相同构型的参考能量之间的绝对相对误差：\n   $$\\varepsilon_k = \\frac{|E_k - E_{\\mathrm{ref}}|}{\\max(|E_{\\mathrm{ref}}|, 10^{-12})}.$$\n5. 此外，使用参考参数对构型 A 执行平移不变性检查（测试 7）。将所有位置平移 $\\Delta \\mathbf{r} = (0.1, 0.2, 0.3) \\times L$，并应用周期性边界条件将其包装回盒子内。使用相同的参数计算原始参考能量 $E_{\\mathrm{ref}}$ 和平移后的能量 $E_{\\mathrm{shift}}$，然后报告其绝对差值：\n   $$\\delta = |E_{\\mathrm{shift}} - E_{\\mathrm{ref}}|.$$\n\n您的程序必须生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，条目按 $[\\varepsilon_1, \\varepsilon_2, \\varepsilon_3, \\varepsilon_4, \\varepsilon_5, \\varepsilon_6, \\delta]$ 的顺序排列。不得打印任何额外文本。\n\n所有计算必须严格使用无量纲的约化单位。角度（如果内部出现，例如在复指数中）以弧度为单位。最终输出为实值浮点数。该设计必须测试在 $\\alpha$、$r_{\\mathrm{cut}}$ 和 $n_{\\mathrm{max}}$ 变化下的收敛行为，以及在周期性单元中进行统一平移时的物理不变性。",
            "solution": "该问题要求实现埃瓦尔德求和方法，以计算周期性排列的点电荷在传导（“锡箔”）边界条件下的静电能，并执行一系列验证和收敛性测试。\n\n对于一个边长为 $L$、体积为 $V=L^3$ 的立方盒子中的 $N$ 个电荷 $\\{q_i\\}$（位于位置 $\\{\\mathbf{r}_i\\}$），在传导边界条件下的总静电能由埃瓦尔德公式给出，该公式包含三个部分：实空间和、倒易空间和以及自能校正。\n$$U = U_{\\text{real}} + U_{\\text{recip}} + U_{\\text{self}}$$\n\n1.  **实空间能量 ($U_{\\text{real}}$):** 该项对应于相互作用的短程部分。它的计算方法是，对所有粒子对 $(i,j)$ 及其在截断半径 $r_{\\mathrm{cut}}$ 内的周期性映像进行求和。求和符号上的撇号表示对于中心晶胞（$\\mathbf{n}=0$），排除 $i=j$ 的项。\n    $$ U_{\\text{real}} = \\frac{1}{2} \\sum_{i=1}^{N} \\sum_{j=1}^{N} \\sideset{}{'}{\\sum}_{\\mathbf{n}} \\frac{q_i q_j \\mathrm{erfc}(\\alpha|\\mathbf{r}_{ij} + \\mathbf{n}|)}{|\\mathbf{r}_{ij} + \\mathbf{n}|} $$\n    此处，$\\mathbf{r}_{ij} = \\mathbf{r}_i - \\mathbf{r}_j$，$\\mathbf{n} = (n_x L, n_y L, n_z L)$ 是晶格平移矢量，其分量 $(n_x, n_y, n_z)$ 为整数，$\\alpha$ 是埃瓦尔德分裂参数。对 $\\mathbf{n}$ 的求和被截断，仅包含满足 $|\\mathbf{r}_{ij} + \\mathbf{n}| \\le r_{\\mathrm{cut}}$ 的项。\n\n2.  **倒易空间能量 ($U_{\\text{recip}}$):** 该项通过在傅里叶（倒易）空间中求和来捕捉相互作用的长程部分。对于传导边界条件，$\\mathbf{k}=\\mathbf{0}$ 项被排除，这在物理上对应于系统被一个完美导体包围，该导体屏蔽了由净偶极矩产生的任何宏观电场。\n    $$ U_{\\text{recip}} = \\frac{2\\pi}{V} \\sum_{\\mathbf{k} \\neq \\mathbf{0}} \\frac{e^{-k^2/(4\\alpha^2)}}{k^2} |S(\\mathbf{k})|^2 $$\n    此处，$\\mathbf{k} = \\frac{2\\pi}{L}(n_x, n_y, n_z)$ 是倒易晶格矢量，其整数索引为 $(n_x, n_y, n_z)$，$k = |\\mathbf{k}|$。结构因子 $S(\\mathbf{k})$ 定义为：\n    $$ S(\\mathbf{k}) = \\sum_{j=1}^{N} q_j e^{i\\mathbf{k} \\cdot \\mathbf{r}_j} $$\n    对 $\\mathbf{k}$ 的求和被截断，仅包含其整数索引满足 $\\sqrt{n_x^2 + n_y^2 + n_z^2} \\le n_{\\mathrm{max}}$ 的矢量。问题中通过整数截断值 $n_{\\mathrm{max}}$ 指定了这一点。\n\n3.  **自能校正 ($U_{\\text{self}}$):** 该项减去了每个电荷与其自身的屏蔽高斯电荷云之间的非物理相互作用，该相互作用是在埃瓦尔德分裂过程中引入的。\n    $$ U_{\\text{self}} = -\\frac{\\alpha}{\\sqrt{\\pi}} \\sum_{i=1}^{N} q_i^2 $$\n\n实现时，将首先使用紧密的收敛参数为每种构型计算一个高精度的参考能量 $E_{\\mathrm{ref}}$。然后，对于每个测试用例，将使用指定的参数 $(\\alpha, r_{\\mathrm{cut}}, n_{\\mathrm{max}})$ 计算能量 $E_k$，并计算绝对相对误差 $\\varepsilon_k = |E_k - E_{\\mathrm{ref}}| / \\max(|E_{\\mathrm{ref}}|, 10^{-12})$。最后，将通过平移所有坐标来测试平移不变性，重新计算能量，并报告与原始参考能量的绝对差值 $\\delta$。对于一个正确的实现，这个差值应该接近机器精度。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import special\n\ndef solve():\n    \"\"\"\n    Main function to run the Ewald summation tests as specified in the problem.\n    \"\"\"\n\n    def ewald_energy(q, r, L, alpha, r_cut, n_max):\n        \"\"\"\n        Calculates the Ewald electrostatic energy for a set of point charges\n        under conducting (tin-foil) boundary conditions.\n\n        Args:\n            q (np.ndarray): Array of charges of shape (N,).\n            r (np.ndarray): Array of positions of shape (N, 3).\n            L (float): Side length of the cubic simulation box.\n            alpha (float): Ewald splitting parameter.\n            r_cut (float): Cutoff radius for the real-space sum.\n            n_max (int): Integer cutoff for the reciprocal-space sum.\n\n        Returns:\n            float: The total Ewald energy.\n        \"\"\"\n        N = len(q)\n        V = L**3\n\n        # Real-space term\n        E_real = 0.0\n        n_real_max_int = int(np.ceil(r_cut / L))\n        for i in range(N):\n            for j in range(N):\n                rij = r[i] - r[j]\n                for nx in range(-n_real_max_int, n_real_max_int + 1):\n                    for ny in range(-n_real_max_int, n_real_max_int + 1):\n                        for nz in range(-n_real_max_int, n_real_max_int + 1):\n                            if i == j and nx == 0 and ny == 0 and nz == 0:\n                                continue\n                            \n                            n_vec = np.array([nx, ny, nz]) * L\n                            dist_vec = rij + n_vec\n                            dist = np.linalg.norm(dist_vec)\n                            \n                            if dist = r_cut:\n                                E_real += q[i] * q[j] * special.erfc(alpha * dist) / dist\n        E_real *= 0.5\n\n        # Reciprocal-space term\n        E_recip = 0.0\n        for nx in range(-n_max, n_max + 1):\n            for ny in range(-n_max, n_max + 1):\n                for nz in range(-n_max, n_max + 1):\n                    if nx == 0 and ny == 0 and nz == 0:\n                        continue\n                    \n                    n_sq = nx**2 + ny**2 + nz**2\n                    if n_sq > n_max**2:\n                        continue\n                        \n                    k_vec = (2.0 * np.pi / L) * np.array([nx, ny, nz])\n                    k_sq = np.dot(k_vec, k_vec)\n\n                    k_dot_r = np.dot(r, k_vec)\n                    # The problem uses exp(i k.r) convention in S(k), leading to S(k) = sum(q * (cos+isin))\n                    # The more common convention is exp(-i k.r), leading to S(k) = sum(q * (cos-isin))\n                    # Since we use |S(k)|^2, the sign of the imaginary part doesn't matter.\n                    S_k_real = np.sum(q * np.cos(k_dot_r))\n                    S_k_imag = np.sum(q * np.sin(k_dot_r))\n                    S_k_sq = S_k_real**2 + S_k_imag**2\n\n                    term = np.exp(-k_sq / (4.0 * alpha**2)) / k_sq\n                    E_recip += term * S_k_sq\n        \n        E_recip *= 2.0 * np.pi / V\n\n        # Self-interaction correction\n        E_self = - (alpha / np.sqrt(np.pi)) * np.sum(q**2)\n        \n        return E_real + E_recip + E_self\n\n    # --- Problem Setup ---\n    L = 1.0 # Box side length\n    \n    # Configuration A\n    q_A = np.array([1.0, -1.0])\n    r_A = np.array([[0.0, 0.0, 0.0], [0.5, 0.0, 0.0]]) * L\n\n    # Configuration B\n    q_B = np.array([1.0, 1.0, -2.0])\n    r_B = np.array([[0.0, 0.0, 0.0], [0.25, 0.25, 0.25], [0.5, 0.5, 0.5]]) * L\n\n    # Reference parameters\n    alpha_ref = 5.0\n    rcut_ref = 4.0\n    nmax_ref = 30\n\n    # Calculate reference energies\n    E_ref_A = ewald_energy(q_A, r_A, L, alpha_ref, rcut_ref, nmax_ref)\n    E_ref_B = ewald_energy(q_B, r_B, L, alpha_ref, rcut_ref, nmax_ref)\n\n    # Test cases\n    test_cases = [\n        ('A', 5.0, 1.5, 8),   # Test 1\n        ('A', 5.0, 3.0, 15),  # Test 2\n        ('A', 2.0, 4.0, 20),  # Test 3\n        ('A', 8.0, 1.2, 25),  # Test 4\n        ('B', 5.0, 2.0, 12),  # Test 5\n        ('B', 5.0, 3.5, 20),  # Test 6\n    ]\n\n    results = []\n    \n    # --- Execute Test Cases 1-6 ---\n    for i, (config_id, alpha, r_cut, n_max) in enumerate(test_cases):\n        if config_id == 'A':\n            q, r, E_ref = q_A, r_A, E_ref_A\n        else: # config_id == 'B'\n            q, r, E_ref = q_B, r_B, E_ref_B\n        \n        E_k = ewald_energy(q, r, L, alpha, r_cut, n_max)\n        \n        error_denom = max(abs(E_ref), 1e-12)\n        eps_k = abs(E_k - E_ref) / error_denom\n        results.append(eps_k)\n\n    # --- Execute Test Case 7: Translation Invariance ---\n    delta_r = np.array([0.1, 0.2, 0.3]) * L\n    r_A_shifted = (r_A + delta_r) % L\n    \n    E_shift = ewald_energy(q_A, r_A_shifted, L, alpha_ref, rcut_ref, nmax_ref)\n    \n    delta = abs(E_shift - E_ref_A)\n    results.append(delta)\n\n    # --- Final Output ---\n    print(f\"[{','.join(f'{res:.12e}' for res in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "埃瓦尔德求和的结果会微妙地依赖于所假设的宏观边界条件。这个高级练习 () 将探讨对于含有净偶极矩 $\\mathbf{M}$ 的体系，这种依赖性如何体现。我们将推导并计算当从默认的“锡箔”边界条件切换到更符合物理实际的真空边界条件时所需的能量修正，这是模拟极性材料和界面时常遇到的一个重要挑战。",
            "id": "3846365",
            "problem": "一个三维周期性系统在传导（锡箔）边界条件下，使用 Ewald 求和方法进行模拟。立方模拟单元的边长为 $L$，体积为 $V = L^{3}$，其中包含两个点电荷 $q_{1} = +e$ 和 $q_{2} = -e$，分别位于 $\\mathbf{r}_{1} = (d/2, 0, 0)$ 和 $\\mathbf{r}_{2} = (-d/2, 0, 0)$。这里，$e$ 是基本电荷，$d$ 是一个分离参数，且 $d \\ll L$。净电荷为零，但该构型具有一个非零的总偶极矩 $\\mathbf{M} = \\sum_{i} q_{i} \\mathbf{r}_{i}$。\n\n在多尺度材料模拟中，通过 Ewald 求和计算的长程静电能是条件收敛的，并且依赖于宏观边界条件和样品的形状。在传导边界条件下，会省略一个 $k=\\mathbf{0}$ 的贡献，这对应于忽略了与样品净偶极矩相关的宏观退极化场。在具有球形宏观边界的真空中，这种省略会导致对静电能的一个有限尺寸、形状依赖的修正。\n\n从包括库仑定律（$\\mathbf{E}(\\mathbf{r}) = \\frac{1}{4\\pi \\varepsilon_{0}} \\int \\rho(\\mathbf{r}') \\frac{\\mathbf{r}-\\mathbf{r}'}{|\\mathbf{r}-\\mathbf{r}'|^{3}} \\,\\mathrm{d}^{3}\\mathbf{r}'$）、泊松方程（$\\nabla^{2} \\phi = -\\rho/\\varepsilon_{0}$）以及均匀极化体的宏观静电学（极化强度 $\\mathbf{P} = \\mathbf{M}/V$ 和由退极化张量 $\\mathbf{N}$ 表征的椭球体内部的退极化场）在内的静电学基本原理出发，推导当将传导边界条件替换为具有球形边界的真空时，对 Ewald 能量产生的形状依赖修正的形式。用 $\\varepsilon_{0}$、$V$ 和 $\\mathbf{M}$ 表示该修正。\n\n然后，对于上述双电荷构型的具体情况，使用 $L = 3.00 \\times 10^{-9}\\,\\mathrm{m}$ 和 $d = 6.00 \\times 10^{-10}\\,\\mathrm{m}$ 的立方单元，数值计算此修正。使用以下常数：$e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$，$\\varepsilon_{0} = 8.8541878128 \\times 10^{-12}\\,\\mathrm{F/m}$，以及阿伏伽德罗常数 $N_{\\mathrm{A}} = 6.02214076 \\times 10^{23}\\,\\mathrm{mol}^{-1}$。将该修正视为每个模拟单元的能量，并通过乘以 $N_{\\mathrm{A}}$ 将其转换为每摩尔的能量。\n\n将最终答案四舍五入到四位有效数字，并以 $\\mathrm{kJ/mol}$ 为单位表示。最终答案必须是单个实数。",
            "solution": "该问题要求推导当假定的宏观边界条件从传导（“锡箔”）变为具有球形形状的真空时，对通过 Ewald 求和方法计算的静电能的修正。这种修正仅出现在每个模拟单元具有非零净偶极矩 $\\mathbf{M}$ 的系统中。\n\n**第 1 部分：能量修正的推导**\n在 Ewald 求和中，计算的是模拟单元周期性晶格的静电能。标准实现，特别是对于电中性系统，会省略倒易空间求和的 $\\mathbf{k}=\\mathbf{0}$ 项。此过程等同于假设无限周期晶格被一个零电势的完美导体包围。在这些“锡箔”边界条件下，样品上没有宏观电场，宏观样品形状对能量的贡献为零。\n\n当宏观样品被真空包围时，非零的偶极矩密度，即极化强度 $\\mathbf{P} = \\mathbf{M}/V$，会在样品内部产生一个宏观电场，称为退极化场 $\\mathbf{E}_{\\text{dep}}$。与该场相关的能量代表了必须加到锡箔 Ewald 能量上的修正。\n\n均匀极化的椭球形体内部的退极化场是均匀的，由下式给出：\n$$\n\\mathbf{E}_{\\text{dep}} = -\\frac{\\mathbf{N} \\cdot \\mathbf{P}}{\\varepsilon_{0}}\n$$\n其中 $\\mathbf{N}$ 是退极化张量，它取决于宏观体的形状。对于球体，即问题中指定的形状，退极化张量是各向同性的：\n$$\n\\mathbf{N} = \\frac{1}{3}\\mathbf{I}\n$$\n其中 $\\mathbf{I}$ 是单位张量。因此，对于球形边界，退极化场为：\n$$\n\\mathbf{E}_{\\text{dep}} = -\\frac{\\mathbf{P}}{3\\varepsilon_{0}}\n$$\n这个极化体的静电自能，即储存在退极化场中的能量，就是所要求的修正 $\\Delta U$。这个能量是在抵抗其产生的场 $\\mathbf{E}_{\\text{dep}}$ 的情况下建立极化强度 $\\mathbf{P}$ 所做的功。能量密度为 $u = -\\frac{1}{2}\\mathbf{P} \\cdot \\mathbf{E}_{\\text{dep}}$。在模拟单元的体积 $V$（代表宏观体的一个单位）上积分，得到总的修正能量：\n$$\n\\Delta U = \\int_{V} \\left(-\\frac{1}{2}\\mathbf{P} \\cdot \\mathbf{E}_{\\text{dep}}\\right) dV'\n$$\n由于 $\\mathbf{P}$ 和 $\\mathbf{E}_{\\text{dep}}$ 在样品内部都是均匀的，这可以简化为：\n$$\n\\Delta U = -\\frac{V}{2} \\mathbf{P} \\cdot \\mathbf{E}_{\\text{dep}}\n$$\n代入 $\\mathbf{E}_{\\text{dep}}$ 和 $\\mathbf{P}$ 的表达式：\n$$\n\\Delta U = -\\frac{V}{2} \\left(\\frac{\\mathbf{M}}{V}\\right) \\cdot \\left(-\\frac{\\mathbf{M}/V}{3\\varepsilon_{0}}\\right) = \\frac{V}{2} \\frac{|\\mathbf{M}|^2}{3\\varepsilon_{0}V^2}\n$$\n这简化为能量修正的最终表达式：\n$$\n\\Delta U = \\frac{|\\mathbf{M}|^2}{6\\varepsilon_{0}V}\n$$\n这是为了获得在真空中具有球形宏观边界的周期性系统的能量而需要加到标准 Ewald 能量上的能量。\n\n**第 2 部分：数值计算**\n首先，我们计算给定电荷构型的偶极矩 $\\mathbf{M}$。\n电荷为 $q_{1} = +e$ 位于 $\\mathbf{r}_{1} = (d/2, 0, 0)$ 和 $q_{2} = -e$ 位于 $\\mathbf{r}_{2} = (-d/2, 0, 0)$。\n$$\n\\mathbf{M} = q_{1}\\mathbf{r}_{1} + q_{2}\\mathbf{r}_{2} = (+e)\\begin{pmatrix} d/2 \\\\ 0 \\\\ 0 \\end{pmatrix} + (-e)\\begin{pmatrix} -d/2 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} ed/2 \\\\ 0 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} ed/2 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} ed \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n偶极矩的大小为 $|\\mathbf{M}| = ed$。其大小的平方为 $|\\mathbf{M}|^2 = (ed)^2$。\n立方单元的体积为 $V = L^3$。\n将此代入我们推导的修正公式中：\n$$\n\\Delta U = \\frac{(ed)^2}{6\\varepsilon_{0}L^3}\n$$\n现在，我们代入给定的数值：\n- $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$\n- $d = 6.00 \\times 10^{-10}\\,\\mathrm{m}$\n- $\\varepsilon_{0} = 8.8541878128 \\times 10^{-12}\\,\\mathrm{F/m}$\n- $L = 3.00 \\times 10^{-9}\\,\\mathrm{m}$\n\n我们来计算各项：\n$|\\mathbf{M}| = ed = (1.602176634 \\times 10^{-19}\\,\\mathrm{C}) \\times (6.00 \\times 10^{-10}\\,\\mathrm{m}) = 9.613059804 \\times 10^{-29}\\,\\mathrm{C \\cdot m}$\n$|\\mathbf{M}|^2 = (9.613059804 \\times 10^{-29}\\,\\mathrm{C \\cdot m})^2 = 9.24109310 \\times 10^{-57}\\,\\mathrm{C^2 \\cdot m^2}$\n$V = L^3 = (3.00 \\times 10^{-9}\\,\\mathrm{m})^3 = 2.70 \\times 10^{-26}\\,\\mathrm{m^3}$\n\n现在，我们以焦耳为单位计算每个模拟单元的能量修正：\n$$\n\\Delta U = \\frac{9.24109310 \\times 10^{-57}\\,\\mathrm{C^2 \\cdot m^2}}{6 \\times (8.8541878128 \\times 10^{-12}\\,\\mathrm{F/m}) \\times (2.70 \\times 10^{-26}\\,\\mathrm{m^3})}\n$$\n$$\n\\Delta U = \\frac{9.24109310 \\times 10^{-57}}{1.43419842 \\times 10^{-36}}\\,\\mathrm{J} = 6.4433150 \\times 10^{-21}\\,\\mathrm{J}\n$$\n这是每个模拟单元的修正。问题要求以 $\\mathrm{kJ/mol}$ 为单位的摩尔能量。我们乘以阿伏伽德罗常数 $N_{\\mathrm{A}}$ 并进行单位换算。\n$$\n\\Delta U_{\\text{molar}} = \\Delta U \\times N_{\\mathrm{A}} = (6.4433150 \\times 10^{-21}\\,\\mathrm{J}) \\times (6.02214076 \\times 10^{23}\\,\\mathrm{mol}^{-1})\n$$\n$$\n\\Delta U_{\\text{molar}} = 3880.303\\,\\mathrm{J/mol}\n$$\n换算为千焦耳每摩尔：\n$$\n\\Delta U_{\\text{molar}} = 3.880303\\,\\mathrm{kJ/mol}\n$$\n最后，我们按要求将结果四舍五入到四位有效数字。\n$$\n\\Delta U_{\\text{molar}} \\approx 3.880\\,\\mathrm{kJ/mol}\n$$",
            "answer": "$$\n\\boxed{3.880}\n$$"
        }
    ]
}