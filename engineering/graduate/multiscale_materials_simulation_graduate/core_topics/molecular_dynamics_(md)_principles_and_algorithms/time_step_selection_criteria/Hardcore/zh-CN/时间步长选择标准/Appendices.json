{
    "hands_on_practices": [
        {
            "introduction": "在显式时间积分的计算力学中，时间步长的选择对于数值稳定性至关重要。此问题的核心是著名的 Courant-Friedrichs-Lewy (CFL) 条件，它将最大允许时间步长与系统中波的传播速度和网格尺寸联系起来。本练习将引导您通过第一性原理，深入分析有限元方法 (FEM) 中一个常见的数值技巧——质量集中（mass lumping）——如何通过改变系统质量矩阵的谱特性来影响稳定性极限 。通过对一个简单的四面体单元进行精确的数学推导，您将量化这一效应，从而为理解数值离散化选择与计算效率及稳定性之间的权衡提供坚实的理论基础。",
            "id": "3855310",
            "problem": "考虑使用线性四面体单元的有限元法 (FEM)，对各向同性均匀弹性固体的半离散弹性动力学方程进行显式时间积分。设该固体的密度为 $\\rho$，拉梅参数为 $\\lambda$ 和 $\\mu$。为捕捉限制稳定性的膨胀响应，我们通过标量波动方程代理 $\\,\\rho\\,\\ddot{u} - \\kappa\\,\\nabla^{2}u = 0\\,$ 来模拟最快模式，其中 $\\kappa = \\rho c^{2}$ 且 $c = \\sqrt{(\\lambda + 2\\mu)/\\rho}$ 等于压缩波速。在边长为 $s$ 的单个正四面体上进行标准伽辽金离散化后，半离散系统具有形式 $\\,\\mathbf{M}\\,\\ddot{\\mathbf{u}} + \\mathbf{K}\\,\\mathbf{u} = \\mathbf{0}\\,$，其中 $\\,\\mathbf{M}\\,$ 和 $\\,\\mathbf{K}\\,$ 分别是与四个标量节点自由度相关的单元质量矩阵和刚度矩阵，而 $\\,\\mathbf{u}\\,$ 是 $u$ 的节点值向量。设 $\\,\\Delta t\\,$ 是应用于该系统的显式中心差分格式的时间步长。\n\n从基本原理出发——即半离散运动方程、通过四面体上线性形函数的梯度定义刚度矩阵 $\\,\\mathbf{K}\\,$，以及质量矩阵 $\\,\\mathbf{M}\\,$ 的一致定义与行和集中定义——推导质量集中如何改变算子 $\\,\\mathbf{M}^{-1}\\mathbf{K}\\,$ 的谱，从而改变最大稳定时间步长 $\\,\\Delta t\\,$。通过计算精确比率 $\\,\\Delta t_{\\mathrm{lump}}/\\Delta t_{\\mathrm{cons}}\\,$，量化单个正四面体单元的这种效应，其中 $\\,\\Delta t_{\\mathrm{lump}}\\,$ 和 $\\,\\Delta t_{\\mathrm{cons}}\\,$ 分别表示在行和集中质量矩阵和一致质量矩阵下的中心差分稳定性极限。\n\n请以单个无单位的精确值形式提供最终答案。无需四舍五入。",
            "solution": "用户希望找到标量波动方程的有限元法 (FEM) 半离散化在使用显式中心差分积分时的最大稳定时间步长之比。比较是在单个正线性四面体单元上使用行和集中质量矩阵 ($\\mathbf{M}_{\\mathrm{lump}}$) 和一致质量矩阵 ($\\mathbf{M}_{\\mathrm{cons}}$) 之间的差异。\n\n### 步骤 1：问题验证\n\n**1.1. 提取已知条件**\n- **物理系统**：各向同性均匀弹性固体，其稳定性分析基于代理标量波动方程 $\\rho\\,\\ddot{u} - \\kappa\\,\\nabla^{2}u = 0$ 进行。\n- **材料与模型参数**：密度 $\\rho$，波动模量 $\\kappa = \\rho c^{2}$，其中 $c = \\sqrt{(\\lambda + 2\\mu)/\\rho}$ 是压缩波速。\n- **离散化方法**：伽辽金有限元法。\n- **单元类型**：边长为 $s$ 的单个正四面体。使用线性形函数，得到 4 个节点自由度。\n- **半离散方程**：$\\mathbf{M}\\,\\ddot{\\mathbf{u}} + \\mathbf{K}\\,\\mathbf{u} = \\mathbf{0}$，其中 $\\mathbf{u}$ 是 $u$ 的节点值向量。\n- **质量矩阵**：考虑两种情况：一致质量矩阵 $\\mathbf{M}_{\\mathrm{cons}}$ 和行和集中质量矩阵 $\\mathbf{M}_{\\mathrm{lump}}$。\n- **时间积分**：使用时间步长 $\\Delta t$ 的显式中心差分格式。\n- **目标**：推导质量集中对 $\\mathbf{M}^{-1}\\mathbf{K}$ 谱的影响，并计算稳定性极限的精确比率 $\\Delta t_{\\mathrm{lump}}/\\Delta t_{\\mathrm{cons}}$。\n\n**1.2. 对照标准进行验证**\n- **科学基础**：该问题牢固地植根于计算固体力学和有限元分析的标准理论中。使用标量波动方程作为弹性动力学稳定性的代理、一致和集中质量矩阵的概念，以及中心差分格式的稳定性分析，都是已确立的原则。\n- **适定性**：该问题是适定的。它明确了物理模型、单元几何形状（正四面体）、单元类型（线性）以及要执行的分析。这些信息足以唯一地确定单元矩阵及其谱特性，从而得出一个单一、可计算的比率。\n- **客观性**：该问题以精确、客观的数学和工程术语陈述，没有任何主观性或模糊性。\n- **其他缺陷**：该问题是自洽的、合理的、非平凡的，并且可以通过标准数学程序进行验证。它不违反任何无效性标准。\n\n**1.3. 结论**\n该问题有效。将提供完整解答。\n\n### 步骤 2：解题推导\n\n对于系统 $\\mathbf{M}\\,\\ddot{\\mathbf{u}} + \\mathbf{K}\\,\\mathbf{u} = \\mathbf{0}$，显式中心差分格式的稳定性由 Courant-Friedrichs-Lewy (CFL) 条件决定，该条件规定时间步长 $\\Delta t$ 不得超过一个临界值 $\\Delta t_{\\mathrm{max}}$。该极限与半离散系统的最高固有频率 $\\omega_{\\max}$ 相关：\n$$\n\\Delta t \\le \\Delta t_{\\mathrm{max}} = \\frac{2}{\\omega_{\\max}}\n$$\n固有频率 $\\omega$ 是广义特征值问题 $\\mathbf{K}\\mathbf{v} = \\omega^{2}\\mathbf{M}\\mathbf{v}$ 的特征值 $\\lambda_{\\mathrm{eig}}$ 的平方根。这等效于求矩阵 $\\mathbf{D} = \\mathbf{M}^{-1}\\mathbf{K}$ 的特征值。因此，$\\omega_{\\max} = \\sqrt{\\lambda_{\\max}(\\mathbf{M}^{-1}\\mathbf{K})}$，稳定性极限为：\n$$\n\\Delta t_{\\mathrm{max}} = \\frac{2}{\\sqrt{\\lambda_{\\max}(\\mathbf{M}^{-1}\\mathbf{K})}}\n$$\n我们要求解比率 $\\frac{\\Delta t_{\\mathrm{lump}}}{\\Delta t_{\\mathrm{cons}}}$，可以用最大特征值表示为：\n$$\n\\frac{\\Delta t_{\\mathrm{lump}}}{\\Delta t_{\\mathrm{cons}}} = \\frac{2/\\sqrt{\\lambda_{\\max}(\\mathbf{M}_{\\mathrm{lump}}^{-1}\\mathbf{K})}}{2/\\sqrt{\\lambda_{\\max}(\\mathbf{M}_{\\mathrm{cons}}^{-1}\\mathbf{K})}} = \\sqrt{\\frac{\\lambda_{\\max}(\\mathbf{M}_{\\mathrm{cons}}^{-1}\\mathbf{K})}{\\lambda_{\\max}(\\mathbf{M}_{\\mathrm{lump}}^{-1}\\mathbf{K})}}\n$$\n为了计算该比率，我们必须首先为正线性四面体构建单元刚度矩阵和质量矩阵。\n\n**2.1. 正四面体的单元矩阵**\n\n线性四面体有4个节点。设形函数为 $N_i(\\mathbf{x})$，其中 $i=1, 2, 3, 4$。单元矩阵定义如下：\n$$\nK_{ij} = \\int_{V_e} \\kappa (\\nabla N_i \\cdot \\nabla N_j) \\, dV\n$$\n$$\n(M_{\\mathrm{cons}})_{ij} = \\int_{V_e} \\rho N_i N_j \\, dV\n$$\n其中 $V_e$ 是单元的体积。对于边长为 $s$ 的正四面体，其体积为 $V_e = \\frac{s^3}{6\\sqrt{2}}$。\n\n对于正四面体，其几何形状是完全对称的。这种对称性反映在单元矩阵的结构中。$\\mathbf{K}$ 和 $\\mathbf{M}_{\\mathrm{cons}}$ 都将具有 $a\\mathbf{I} + b\\mathbf{J}$ 的形式，其中 $\\mathbf{I}$ 是 $4 \\times 4$ 的单位矩阵，$\\mathbf{J}$ 是 $4 \\times 4$ 的全一矩阵。\n\n**刚度矩阵 $\\mathbf{K}$**：\n对于线性单元，梯度 $\\nabla N_i$ 在单元内部是常数。由于正四面体的对称性，这些梯度的点积具有特定的结构：对于所有 $i$，$|\\nabla N_i|^2$ 的值相同，我们称之为 $\\alpha_g$；对于 $i \\ne j$，$\\nabla N_i \\cdot \\nabla N_j$ 的值对于所有对都相同，我们称之为 $\\beta_g$。根据性质 $\\sum_{i=1}^4 \\nabla N_i = \\mathbf{0}$，我们有 $\\nabla N_i \\cdot (\\sum_{j=1}^4 \\nabla N_j) = 0$，这导致 $\\alpha_g + 3\\beta_g = 0$，即 $\\beta_g = -\\alpha_g/3$。可以证明，对于边长为 $s$ 的正四面体，$\\alpha_g = \\frac{3}{2s^2}$。因此，$\\beta_g = -\\frac{1}{2s^2}$。\n刚度矩阵的项为 $K_{ij} = \\kappa V_e (\\nabla N_i \\cdot \\nabla N_j)$。\n$$\n\\mathbf{K} = \\kappa V_e \\begin{pmatrix} \\alpha_g  \\beta_g  \\beta_g  \\beta_g \\\\ \\beta_g  \\alpha_g  \\beta_g  \\beta_g \\\\ \\beta_g  \\beta_g  \\alpha_g  \\beta_g \\\\ \\beta_g  \\beta_g  \\beta_g  \\alpha_g \\end{pmatrix} = \\kappa \\frac{s^3}{6\\sqrt{2}} \\frac{1}{2s^2} \\begin{pmatrix} 3  -1  -1  -1 \\\\ -1  3  -1  -1 \\\\ -1  -1  3  -1 \\\\ -1  -1  -1  3 \\end{pmatrix} = \\frac{\\kappa s}{12\\sqrt{2}} \\begin{pmatrix} 3  -1  -1  -1 \\\\ -1  3  -1  -1 \\\\ -1  -1  3  -1 \\\\ -1  -1  -1  3 \\end{pmatrix}\n$$\n该矩阵可以紧凑地写为 $\\mathbf{K} = \\frac{\\kappa s}{12\\sqrt{2}}(4\\mathbf{I} - \\mathbf{J})$。\n\n**一致质量矩阵 $\\mathbf{M}_{\\mathrm{cons}}$**：\n通过对重心形函数的乘积进行积分，得出的线性四面体一致质量矩阵的标准公式为：\n$$\n\\mathbf{M}_{\\mathrm{cons}} = \\frac{\\rho V_e}{20} \\begin{pmatrix} 2  1  1  1 \\\\ 1  2  1  1 \\\\ 1  1  2  1 \\\\ 1  1  1  2 \\end{pmatrix}\n$$\n代入 $V_e = \\frac{s^3}{6\\sqrt{2}}$，我们得到：\n$$\n\\mathbf{M}_{\\mathrm{cons}} = \\frac{\\rho s^3}{120\\sqrt{2}} \\begin{pmatrix} 2  1  1  1 \\\\ 1  2  1  1 \\\\ 1  1  2  1 \\\\ 1  1  1  2 \\end{pmatrix} = \\frac{\\rho s^3}{120\\sqrt{2}}(\\mathbf{I} + \\mathbf{J})\n$$\n\n**集中质量矩阵 $\\mathbf{M}_{\\mathrm{lump}}$**：\n行和集中质量矩阵是一个对角矩阵，其中每个对角项是一致质量矩阵相应行中各项的和。\n对 $\\mathbf{M}_{\\mathrm{cons}}$ 的任意行求和得到：$\\frac{\\rho s^3}{120\\sqrt{2}} (2 + 1 + 1 + 1) = \\frac{5\\rho s^3}{120\\sqrt{2}} = \\frac{\\rho s^3}{24\\sqrt{2}}$。\n因此，集中质量矩阵为：\n$$\n\\mathbf{M}_{\\mathrm{lump}} = \\frac{\\rho s^3}{24\\sqrt{2}} \\mathbf{I}\n$$\n\n**2.2. 谱分析**\n\n矩阵 $\\mathbf{K}$ 和 $\\mathbf{M}_{\\mathrm{cons}}$ 都是 $a\\mathbf{I} + b\\mathbf{J}$ 的形式。这类矩阵共享一组相同的特征向量。\n矩阵 $\\mathbf{J}$（全一矩阵）有两个不同的特征值：\n- $\\lambda_1 = 4$，其特征向量为 $\\mathbf{v}_1 = (1, 1, 1, 1)^T$。这对应于均匀（刚体平移）模式。\n- $\\lambda_2 = 0$，其特征空间是与 $\\mathbf{v}_1$ 正交的向量构成的三维空间。这些对应于高阶变形模式。\n\n矩阵 $a\\mathbf{I} + b\\mathbf{J}$ 的特征值为 $a+4b$（单重）和 $a$（三重）。\n让我们将此应用于我们的矩阵特征值问题。\n\n**集中质量情况**：\n我们需要 $\\mathbf{D}_{\\mathrm{lump}} = \\mathbf{M}_{\\mathrm{lump}}^{-1}\\mathbf{K}$ 的特征值。\n$$\n\\mathbf{D}_{\\mathrm{lump}} = \\left(\\frac{\\rho s^3}{24\\sqrt{2}}\\mathbf{I}\\right)^{-1} \\left(\\frac{\\kappa s}{12\\sqrt{2}}(4\\mathbf{I} - \\mathbf{J})\\right) = \\frac{24\\sqrt{2}}{\\rho s^3} \\frac{\\kappa s}{12\\sqrt{2}} (4\\mathbf{I} - \\mathbf{J}) = \\frac{2\\kappa}{\\rho s^2}(4\\mathbf{I} - \\mathbf{J})\n$$\n$4\\mathbf{I}-\\mathbf{J}$ 的特征值为 $4-4=0$ 和 $4-0=4$。\n$\\mathbf{D}_{\\mathrm{lump}}$ 的特征值为 $\\frac{2\\kappa}{\\rho s^2} \\times \\{0, 4, 4, 4\\}$。\n因此，最大特征值为：\n$$\n\\lambda_{\\max}(\\mathbf{M}_{\\mathrm{lump}}^{-1}\\mathbf{K}) = \\frac{2\\kappa}{\\rho s^2} \\times 4 = \\frac{8\\kappa}{\\rho s^2}\n$$\n\n**一致质量情况**：\n我们需要广义特征值问题 $\\mathbf{K}\\mathbf{v} = \\lambda_{\\mathrm{eig}} \\mathbf{M}_{\\mathrm{cons}}\\mathbf{v}$ 的特征值 $\\lambda_{\\mathrm{eig}}$。\n$$\n\\frac{\\kappa s}{12\\sqrt{2}}(4\\mathbf{I} - \\mathbf{J})\\mathbf{v} = \\lambda_{\\mathrm{eig}} \\frac{\\rho s^3}{120\\sqrt{2}}(\\mathbf{I} + \\mathbf{J})\\mathbf{v}\n$$\n乘以 $\\frac{120\\sqrt{2}}{\\rho s^3}$ 将方程简化为：\n$$\n\\frac{10\\kappa}{\\rho s^2}(4\\mathbf{I} - \\mathbf{J})\\mathbf{v} = \\lambda_{\\mathrm{eig}} (\\mathbf{I} + \\mathbf{J})\\mathbf{v}\n$$\n我们测试 $\\mathbf{K}$ 和 $\\mathbf{M}_{\\mathrm{cons}}$ 的共同特征向量：\n1.  对于均匀模式 $\\mathbf{v}_1=(1,1,1,1)^T$：\n    $$\n    \\frac{10\\kappa}{\\rho s^2}(4\\mathbf{v}_1 - 4\\mathbf{v}_1) = \\lambda_{\\mathrm{eig}} (\\mathbf{v}_1 + 4\\mathbf{v}_1) \\implies \\mathbf{0} = \\lambda_{\\mathrm{eig}}(5\\mathbf{v}_1) \\implies \\lambda_{\\mathrm{eig}} = 0\n    $$\n2.  对于高阶模式 $\\mathbf{v}_k$（与 $\\mathbf{v}_1$ 正交，因此 $\\mathbf{J}\\mathbf{v}_k=\\mathbf{0}$）：\n    $$\n    \\frac{10\\kappa}{\\rho s^2}(4\\mathbf{v}_k - \\mathbf{0}) = \\lambda_{\\mathrm{eig}} (\\mathbf{v}_k + \\mathbf{0}) \\implies \\frac{40\\kappa}{\\rho s^2}\\mathbf{v}_k = \\lambda_{\\mathrm{eig}}\\mathbf{v}_k\n    $$\n    这得到 $\\lambda_{\\mathrm{eig}} = \\frac{40\\kappa}{\\rho s^2}$。这是一个三重特征值。\n\n一致质量情况下的最大特征值为：\n$$\n\\lambda_{\\max}(\\mathbf{M}_{\\mathrm{cons}}^{-1}\\mathbf{K}) = \\frac{40\\kappa}{\\rho s^2}\n$$\n\n**2.3. 时间步长比率的计算**\n\n最大允许时间步长的比率为：\n$$\n\\frac{\\Delta t_{\\mathrm{lump}}}{\\Delta t_{\\mathrm{cons}}} = \\sqrt{\\frac{\\lambda_{\\max}(\\mathbf{M}_{\\mathrm{cons}}^{-1}\\mathbf{K})}{\\lambda_{\\max}(\\mathbf{M}_{\\mathrm{lump}}^{-1}\\mathbf{K})}} = \\sqrt{\\frac{40\\kappa / (\\rho s^2)}{8\\kappa / (\\rho s^2)}} = \\sqrt{\\frac{40}{8}} = \\sqrt{5}\n$$\n这个结果表明，对于正线性四面体，质量集中将最大稳定时间步长增加了 $\\sqrt{5}$ 倍。这是因为集中有效地减小了算子 $\\mathbf{M}^{-1}\\mathbf{K}$ 的谱半径，使得系统在其最高频率处表现得“更软”，从而对时间步长的限制更小。",
            "answer": "$$\\boxed{\\sqrt{5}}$$"
        },
        {
            "introduction": "当模拟从确定性动力学（如NVE系综）转向随机恒温动力学（如Langevin动力学）时，时间步长选择的挑战提升到了一个新的层次。此时，目标不仅是精确地积分运动轨迹，更要确保对目标统计系综（如玻尔兹曼分布）进行正确的采样。本练习探讨了一个深刻而微妙的问题：自适应时间步长和步拒绝策略如何影响随机积分器的采样正确性 。您需要运用细致平衡原理来辨析，哪些看似合理的自适应方案会引入采样偏差，而哪些方案在经过适当的Metropolis-Hastings校正后仍能保持统计保真度。这项高级实践将磨练您的理论严谨性，加深您对蒙特卡洛方法和非平衡统计物理基本原理的理解。",
            "id": "3855339",
            "problem": "考虑在逆温度 $\\beta0$ 下，一个粒子在 $\\mathbb{R}^{d}$ 上的光滑势 $U(x)$ 中的过阻尼朗之万动力学，由随机微分方程 (SDE) $dx_{t}=-\\nabla U(x_{t})\\,dt+\\sqrt{2\\beta^{-1}}\\,dW_{t}$ 定义，其中 $W_{t}$ 是标准的 $d$ 维维纳过程。该连续动力学的目标不变密度是玻尔兹曼-吉布斯密度 $\\rho(x)\\propto\\exp(-\\beta U(x))$。一个广泛使用的时间离散化方法是欧拉-丸山格式：给定 $x_{n}$，提出\n$$\nx_{n+1}^{\\mathrm{trial}}=x_{n}-\\nabla U(x_{n})\\,\\Delta t+\\sqrt{2\\beta^{-1}\\,\\Delta t}\\,\\xi_{n},\n$$\n其中 $\\xi_{n}\\sim\\mathcal{N}(0,I_{d})$。在多尺度材料模拟中，人们常常希望自适应地调整时间步长 $\\Delta t$ 并可能拒绝某些步以维持稳定性或准确性。在用于 $\\dot{x}=f(x)$ 的确定性常微分方程 (ODE) 积分中，带步长拒绝的自适应步长是标准做法，例如当局部误差估计量超过容差时将 $\\Delta t$ 减半。\n\n从不变密度和欧拉-丸山提议的转移核的定义，以及细致平衡的概念出发，分析步长拒绝和时间步长自适应如何影响确定性与随机积分器中的不变测度。特别是，论证依赖于实现的噪声增量 $\\xi_{n}$ 的拒绝准则是否会改变采样的分布，以及在何种修正下可以保留对 $\\rho(x)$ 的无偏采样。\n\n选择所有正确的陈述：\n\nA. 对于应用于常微分方程的确定性积分器，仅基于局部截断误差估计量拒绝一个步长并用更小的 $\\Delta t$ 重新计算，不会使任何不变分布产生偏差，因为演化是确定性的，自适应时间离散化只控制近似误差，而不是对目标测度进行采样。\n\nB. 在由欧拉-丸山格式离散化的过阻尼朗之万动力学中，当实现的高斯增量的大小超过一个固定阈值时拒绝一个尝试移动，然后重用按较小 $\\Delta t$ 缩放的相同增量，可以保持玻尔兹曼-吉布斯不变密度 $\\rho(x)$。\n\nC. 在过阻尼朗之万动力学中，仅根据当前状态（例如，从 $\\lVert\\nabla^{2}U(x_{n})\\rVert$ 导出的界）自适应调整 $\\Delta t$，并对最终的提议进行 Metropolis–Hastings 修正，在任何重试时都使用新的高斯噪声，可以保持玻尔兹曼-吉布斯不变密度 $\\rho(x)$。\n\nD. 在随机恒温动力学中，一个只接受能量减少的提议（拒绝能量增加的提议）且没有任何概率修正的规则，能够维持不变测度，因为随机噪声补偿了拒绝。\n\nE. 在欠阻尼朗之万动力学中，将其分裂为确定性哈密顿流和随机 Ornstein–Uhlenbeck 动量刷新，对哈密顿子步使用时间可逆、保体积的积分器，并对该子步进行 Metropolis 修正，同时允许为哈密顿部分自适应调整 $\\Delta t$ 并保持 Ornstein–Uhlenbeck 刷新是精确的，可以保持玻尔兹曼-吉布斯不变密度。",
            "solution": "指导马尔可夫链蒙特卡洛 (MCMC) 算法正确采样目标概率密度 $\\rho(x)$ 的基本原则是保持 $\\rho(x)$ 作为所生成链的不变测度。一个充分条件是细致平衡条件，该条件指出，对于任何两个状态 $x$ 和 $x'$，在平衡状态下，从 $x$ 转换到 $x'$ 的速率必须等于从 $x'$ 转换到 $x$ 的速率。如果转移概率密度为 $P(x'|x)$，细致平衡表示为：\n$$\n\\rho(x) P(x'|x) = \\rho(x') P(x|x')\n$$\nMetropolis-Hastings 算法提供了一个通用框架来强制执行此条件。给定一个提议密度 $q(x'|x)$，一个从 $x$ 到 $x'$ 的提议移动以概率 $\\alpha(x'|x)$ 被接受，该概率由下式给出：\n$$\n\\alpha(x'|x) = \\min\\left(1, \\frac{\\rho(x')q(x|x')}{\\rho(x)q(x'|x)}\\right)\n$$\n如果移动被拒绝，状态保持为 $x$。最终的有效转移核满足细致平衡。在给定问题的背景下，欧拉-丸山格式充当提议机制。目标密度是 $\\rho(x) \\propto \\exp(-\\beta U(x))$。提议 $x' = x - \\nabla U(x)\\,\\Delta t + \\sqrt{2\\beta^{-1}\\,\\Delta t}\\,\\xi$（其中 $\\xi \\sim \\mathcal{N}(0,I_{d})$）对应于一个高斯提议密度 $q(x'|x)$。\n\n我们现在基于这些原则来评估每个陈述。\n\nA. 对于应用于常微分方程的确定性积分器，仅基于局部截断误差估计量拒绝一个步长并用更小的 $\\Delta t$ 重新计算，不会使任何不变分布产生偏差，因为演化是确定性的，自适应时间离散化只控制近似误差，而不是对目标测度进行采样。\n\n该陈述针对确定性动力学 $\\dot{x}=f(x)$。数值积分器的目标是近似真实轨迹 $x(t)$。自适应步长方案旨在控制局部误差，即数值解与真实轨迹在一个单步内的偏差。当一个步长被拒绝时（例如，局部误差估计超过容差），算法会返回到前一个状态，并用一个更小的时间间隔 $\\Delta t'  \\Delta t$ 重新积分。整个过程是一个数值程序，用于生成从初始条件出发的单一、唯一轨迹的更精确近似。对于 ODE，“不变分布”的概念关系到被系统真实流所保持的测度（例如，对于哈密顿系统是刘维尔测度）。自适应积分器仅仅是近似此流的工具。它不改变底层动力学或其所保持的测度。其目的是控制计算轨迹（生成样本）的准确性。它不会在 MCMC 意义上引入采样偏差。一旦初始状态固定，该过程是完全确定性的。因此，该策略是计算准确性和效率的问题，而非 MCMC 意义上的统计采样正确性问题。\n\n**结论：正确。**\n\nB. 在由欧拉-丸山格式离散化的过阻尼朗之万动力学中，当实现的高斯增量的大小超过一个固定阈值时拒绝一个尝试移动，然后重用按较小 $\\Delta t$ 缩放的相同增量，可以保持玻尔兹曼-吉布斯不变密度 $\\rho(x)$。\n\n该陈述提出了一种基于随机噪声 $\\xi_n$ 实现的拒绝规则。具体来说，如果 $\\lVert\\xi_n\\rVert$ 超过某个阈值，该步将被修改。这意味着提议机制不再是一个简单的欧拉-丸山步。实际位移的概率分布已从原始高斯分布改变。例如，由噪声驱动的大幅度移动被系统性地抑制或改变。在 MCMC 中，任何影响提议过程的规则都必须在细致平衡条件中加以考虑，通常通过 Metropolis-Hastings 框架中的接受概率来实现。该陈述暗示此过程本身（“保持...不变密度”）是充分的。但事实并非如此。这样的过程违反了细致平衡，因为提议密度 $q(x'|x)$ 不再是简单的高斯分布，且该过程没有使用修改后的提议密度来计算有效的 Metropolis-Hastings 修正。在没有在接受概率中进行相应修正的情况下，根据随机数的实现来拒绝或修改提议，会使采样产生偏差，并导致不正确的平稳分布。\n\n**结论：不正确。**\n\nC. 在过阻尼朗之万动力学中，仅根据当前状态（例如，从 $\\lVert\\nabla^{2}U(x_{n})\\rVert$ 导出的界）自适应调整 $\\Delta t$，并对最终的提议进行 Metropolis–Hastings 修正，在任何重试时都使用新的高斯噪声，可以保持玻尔兹曼-吉布斯不变密度 $\\rho(x)$。\n\n这描述了一个有效的 MCMC 过程。在这里，时间步长 $\\Delta t$ 成为当前状态的函数，即 $\\Delta t_n = \\Delta t(x_n)$。提议 $x'$ 是使用这个依赖于状态的时间步长生成的。确保正确性的关键要素是：\n1.  自适应仅取决于当前状态 $x_n$，而不取决于提议的状态 $x'$ 或随机噪声 $\\xi_n$。\n2.  执行了 Metropolis-Hastings (MH) 修正。此修正必须正确地考虑依赖于状态的时间步长。正向移动的提议密度为 $q(x'|x_n) \\propto \\exp\\left(-\\frac{\\beta}{4\\Delta t(x_n)} \\lVert x' - x_n + \\nabla U(x_n) \\Delta t(x_n) \\rVert^2\\right)$。从 $x'$ 到 $x_n$ 的反向移动的提议密度必须使用对应于状态 $x'$ 的时间步长，即 $\\Delta t(x')$。因此，$q(x_n|x') \\propto \\exp\\left(-\\frac{\\beta}{4\\Delta t(x')} \\lVert x_n - x' + \\nabla U(x') \\Delta t(x') \\rVert^2\\right)$。在 MH 接受率 $\\alpha(x'|x_n)$ 中使用这两个不同的提议密度可确保满足细致平衡。\n3.  “在任何重试时都使用新的高斯噪声”确保了每个提议都是一次独立的尝试，满足了 MCMC 分析所需的马尔可夫性质。\n这个过程，被称为依赖状态的或自适应的 MALA (Metropolis 调整的朗之万算法)，是采样目标分布 $\\rho(x)$ 的一个行之有效的方法。\n\n**结论：正确。**\n\nD. 在随机恒温动力学中，一个只接受能量减少的提议（拒绝能量增加的提议）且没有任何概率修正的规则，能够维持不变测度，因为随机噪声补偿了拒绝。\n\n该陈述描述了一个过程，其中任何增加势能的提议移动，$U(x')  U(x)$，都以概率1被拒绝。这样的规则对于任何有限温度系统都从根本上违反了细致平衡。对于玻尔兹曼-吉布斯分布 $\\rho(x) \\propto \\exp(-\\beta U(x))$，细致平衡要求上坡移动（$U(x')  U(x)$）是可能的。具体来说，Metropolis 算法以概率 $\\exp(-\\beta(U(x')-U(x)))$ 接受此类移动。禁止所有上坡移动会阻止系统逃离局部势能最小值，它将不会根据玻尔兹曼-吉布斯分布探索状态空间。系统实际上会执行带噪声的能量最小化。“随机噪声补偿了拒绝”的说法在物理上和数学上都是没有根据的。噪声是提议机制的一部分，而对所有能量增加的步的硬性拒绝会使采样偏向 $T \\to 0$（零温）极限，而不是所期望的有限温度 $\\beta^{-1}$。\n\n**结论：不正确。**\n\nE. 在欠阻尼朗之万动力学中，将其分裂为确定性哈密顿流和随机 Ornstein–Uhlenbeck 动量刷新，对哈密顿子步使用时间可逆、保体积的积分器，并对该子步进行 Metropolis 修正，同时允许为哈密顿部分自适应调整 $\\Delta t$ 并保持 Ornstein–Uhlenbeck 刷新是精确的，可以保持玻尔兹曼-吉布斯不变密度。\n\n这描述了一种用于欠阻尼朗之万动力学的复杂但有效的 MCMC 算法，通常与广义混合蒙特卡洛 (GHMC) 相关。该算法分为：\n1.  一个确定性部分（哈密顿动力学），进行数值积分。使用时间可逆和保体积（辛）的积分器对于算法的结构至关重要。\n2.  一个随机部分（速度的 Ornstein–Uhlenbeck 过程），可以精确求解。\n哈密顿部分的数值积分引入的误差违反了能量守恒，$H(x,v) = U(x)+\\frac{1}{2}v^T M v$。为了使相空间密度 $\\pi(x,v) \\propto \\exp(-\\beta H(x,v))$ 的采样精确，对整个哈密顿子步应用了 Metropolis 修正。接受概率通常为 $\\min(1, \\exp(-\\beta \\Delta H))$，这修正了积分器的误差。这是一个有效的 GHMC 步。该陈述接着建议为哈密顿部分自适应调整 $\\Delta t$。正如在选项 C 的分析中确立的，这是允许的，前提是自适应取决于步长开始时的状态，并且 Metropolis 修正的公式能够正确地考虑这种自适应。这需要包含时间步长变换的雅可比行列式，或确保提议保持可逆性，这可能很复杂，但理论上是可能的。“对该子步进行 Metropolis 修正”这一措辞意味着确实执行了维持细致平衡所必需的修正。因此，一个可逆积分器、一个精确的随机步和一个适当的 Metropolis 修正（考虑了任何依赖状态的时间步长）的组合，构成了采样玻尔兹曼-吉布斯分布的有效算法。\n\n**结论：正确。**",
            "answer": "$$\\boxed{ACE}$$"
        }
    ]
}