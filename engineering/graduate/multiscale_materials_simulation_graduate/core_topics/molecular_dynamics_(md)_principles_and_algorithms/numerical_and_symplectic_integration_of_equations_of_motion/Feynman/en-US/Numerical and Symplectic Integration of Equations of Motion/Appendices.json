{
    "hands_on_practices": [
        {
            "introduction": "Before applying any numerical integrator to a complex simulation, it is essential to understand its fundamental stability properties. This exercise guides you through a linear stability analysis of the velocity Verlet method using the harmonic oscillator as a model system . By deriving the amplification matrix and analyzing its eigenvalues, you will determine the critical time step limit, a result that provides a crucial rule of thumb for ensuring stable simulations of any oscillatory system.",
            "id": "3828011",
            "problem": "In atomistic segments of multiscale materials simulation, lattice vibrations around equilibrium are often modeled as harmonic oscillators integrated by symplectic schemes such as velocity Verlet to preserve the geometric structure. Consider the one-dimensional harmonic oscillator governed by Newton’s second law $\\ddot{q}(t) + \\omega^{2} q(t) = 0$, where $q(t)$ is the displacement and $\\omega$ is the angular frequency associated with the local curvature of the potential well. The velocity Verlet method is applied with a constant time step $h$ to advance the state $(q_{n}, v_{n})$ to $(q_{n+1}, v_{n+1})$ using the standard three sub-steps: half-step velocity update, full-step position update, and final half-step velocity update, with acceleration given by the force from the harmonic potential $V(q) = \\frac{1}{2} \\omega^{2} q^{2}$ and unit mass. Starting from Newton’s second law and the definition of velocity Verlet, derive the one-step linear update in phase space as a $2 \\times 2$ amplification matrix that maps the state at time $t_{n}$ to $t_{n+1}$ for this linear system. Perform a linear stability analysis of this amplification matrix and determine the set of nondimensional steps $z = h \\omega$ for which all eigenvalues lie on the unit circle, consistent with bounded oscillatory propagation. Using this analysis, report the supremum $z_{\\max}$ of nondimensional step sizes $z$ that maintain linear stability of velocity Verlet for the harmonic oscillator. Express the final answer as a single real number. Do not include units.",
            "solution": "The problem requires the derivation of the linear stability limit for the velocity Verlet integration of a one-dimensional harmonic oscillator. The analysis proceeds in three main stages: first, expressing the one-step velocity Verlet update as a matrix operation; second, finding the eigenvalues of this matrix; and third, determining the condition under which these eigenvalues lead to stable (non-divergent) evolution.\n\nThe equation of motion for the harmonic oscillator is given as $\\ddot{q}(t) + \\omega^{2} q(t) = 0$. With unit mass ($m=1$), Newton's second law, $F = ma$, implies that the force is $F(q) = -\\omega^{2} q$. The acceleration is therefore $a(q) = -\\omega^{2} q$. The state of the system at a discrete time step $t_n$ is given by the phase space vector $(q_n, v_n) = (q(t_n), \\dot{q}(t_n))$.\n\nThe velocity Verlet algorithm advances the state from $(q_n, v_n)$ to $(q_{n+1}, v_{n+1})$ over a time step $h$ via three sequential updates:\n\n1.  **Half-step velocity update**: The velocity is advanced by a half-step using the acceleration at the current position $q_n$. The acceleration is $a_n = a(q_n) = -\\omega^2 q_n$.\n    $$v_{n+1/2} = v_n + \\frac{h}{2} a_n = v_n - \\frac{h \\omega^2}{2} q_n$$\n\n2.  **Full-step position update**: The position is advanced by a full time step using the half-step velocity $v_{n+1/2}$.\n    $$q_{n+1} = q_n + h v_{n+1/2}$$\n    Substituting the expression for $v_{n+1/2}$ from the first step:\n    $$q_{n+1} = q_n + h \\left(v_n - \\frac{h \\omega^2}{2} q_n\\right) = \\left(1 - \\frac{h^2 \\omega^2}{2}\\right) q_n + h v_n$$\n\n3.  **Final half-step velocity update**: The velocity is advanced by another half-step using the acceleration at the new position $q_{n+1}$. The acceleration is $a_{n+1} = a(q_{n+1}) = -\\omega^2 q_{n+1}$.\n    $$v_{n+1} = v_{n+1/2} + \\frac{h}{2} a_{n+1} = v_{n+1/2} - \\frac{h \\omega^2}{2} q_{n+1}$$\n    Substituting the expressions for $v_{n+1/2}$ and $q_{n+1}$:\n    $$v_{n+1} = \\left(v_n - \\frac{h \\omega^2}{2} q_n\\right) - \\frac{h \\omega^2}{2} \\left[ \\left(1 - \\frac{h^2 \\omega^2}{2}\\right) q_n + h v_n \\right]$$\n    We group terms by $q_n$ and $v_n$:\n    $$v_{n+1} = \\left(-\\frac{h \\omega^2}{2} - \\frac{h \\omega^2}{2}\\left(1 - \\frac{h^2 \\omega^2}{2}\\right)\\right) q_n + \\left(1 - \\frac{h^2 \\omega^2}{2}\\right) v_n$$\n    $$v_{n+1} = \\left(-h \\omega^2 + \\frac{h^3 \\omega^4}{4}\\right) q_n + \\left(1 - \\frac{h^2 \\omega^2}{2}\\right) v_n$$\n    $$v_{n+1} = -h \\omega^2 \\left(1 - \\frac{h^2 \\omega^2}{4}\\right) q_n + \\left(1 - \\frac{h^2 \\omega^2}{2}\\right) v_n$$\n\nNow, we can write the one-step update as a matrix equation, which defines the amplification matrix $\\mathbf{A}$:\n$$\n\\begin{pmatrix} q_{n+1} \\\\ v_{n+1} \\end{pmatrix} =\n\\begin{pmatrix}\n1 - \\frac{h^2 \\omega^2}{2} & h \\\\\n-h \\omega^2 \\left(1 - \\frac{h^2 \\omega^2}{4}\\right) & 1 - \\frac{h^2 \\omega^2}{2}\n\\end{pmatrix}\n\\begin{pmatrix} q_n \\\\ v_n \\end{pmatrix}\n= \\mathbf{A} \\begin{pmatrix} q_n \\\\ v_n \\end{pmatrix}\n$$\n\nFor the linear stability analysis, we examine the eigenvalues of the amplification matrix $\\mathbf{A}$. The system is stable if and only if the magnitudes of all eigenvalues are less than or equal to one. For a conservative system like the harmonic oscillator, stability requires the eigenvalues to lie on the unit circle in the complex plane, i.e., $|\\lambda| = 1$.\n\nLet's introduce the non-dimensional step size $z = h \\omega$. The matrix $\\mathbf{A}$ can be written in terms of $z$:\n$$\n\\mathbf{A} =\n\\begin{pmatrix}\n1 - \\frac{z^2}{2} & \\frac{z}{\\omega} \\\\\n-\\omega z \\left(1 - \\frac{z^2}{4}\\right) & 1 - \\frac{z^2}{2}\n\\end{pmatrix}\n$$\nThe eigenvalues $\\lambda$ are the roots of the characteristic equation $\\det(\\mathbf{A} - \\lambda \\mathbf{I}) = 0$. The characteristic polynomial is $\\lambda^2 - \\mathrm{Tr}(\\mathbf{A})\\lambda + \\det(\\mathbf{A}) = 0$.\n\nLet's compute the trace and determinant of $\\mathbf{A}$:\n$$\\mathrm{Tr}(\\mathbf{A}) = \\left(1 - \\frac{z^2}{2}\\right) + \\left(1 - \\frac{z^2}{2}\\right) = 2 - z^2$$\n$$\n\\det(\\mathbf{A}) = \\left(1 - \\frac{z^2}{2}\\right)^2 - \\left(\\frac{z}{\\omega}\\right) \\left(-\\omega z \\left(1 - \\frac{z^2}{4}\\right)\\right)\n= \\left(1 - z^2 + \\frac{z^4}{4}\\right) + z^2 \\left(1 - \\frac{z^2}{4}\\right)\n= 1 - z^2 + \\frac{z^4}{4} + z^2 - \\frac{z^4}{4} = 1\n$$\nThe fact that $\\det(\\mathbf{A})=1$ is a hallmark of symplectic integrators like velocity Verlet, as it implies the conservation of phase-space area for linear systems.\n\nThe characteristic equation is:\n$$\\lambda^2 - (2 - z^2)\\lambda + 1 = 0$$\nThe roots (eigenvalues) are given by the quadratic formula:\n$$\\lambda = \\frac{(2 - z^2) \\pm \\sqrt{(2 - z^2)^2 - 4}}{2}$$\nFor the eigenvalues to lie on the unit circle, they must be a complex conjugate pair (or be real and equal to $\\pm 1$). This requires the discriminant of the quadratic equation to be non-positive:\n$$\\Delta = (2 - z^2)^2 - 4 \\le 0$$\nThis inequality can be solved for $z$:\n$$(2 - z^2)^2 \\le 4$$\nTaking the square root of both sides gives:\n$$|2 - z^2| \\le 2$$\nThis is equivalent to the compound inequality:\n$$-2 \\le 2 - z^2 \\le 2$$\nWe analyze the two parts separately:\n1.  $2 - z^2 \\le 2 \\implies -z^2 \\le 0 \\implies z^2 \\ge 0$. This is always true for real $z$.\n2.  $-2 \\le 2 - z^2 \\implies z^2 \\le 4$.\n\nSince $z = h \\omega$ represents a physical time step and frequency, we must have $z \\ge 0$. The condition for stability is therefore $0 \\le z \\le 2$. The integration scheme is linearly stable for all non-dimensional step sizes $z$ in the closed interval $[0, 2]$.\n\nThe problem asks for the supremum $z_{\\max}$ of this set of nondimensional step sizes. The supremum of the interval $[0, 2]$ is $2$. At the boundary $z=2$, the eigenvalues are $\\lambda = \\frac{(2-4) \\pm \\sqrt{0}}{2} = -1$, which is on the unit circle but can lead to oscillatory instabilities in practice. For any $z > 2$, the eigenvalues become real, with one having magnitude greater than $1$, leading to exponential growth and numerical instability.\n\nThus, the supremum of nondimensional step sizes that maintain linear stability is $2$.",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "While symplectic integrators like velocity Verlet are prized for their long-term stability, they do not perfectly reproduce the dynamics of the original system. Instead, they exactly follow the dynamics of a slightly perturbed \"shadow\" Hamiltonian, which leads to predictable, bounded errors in quantities like energy and phase. This practice delves into this concept by having you derive the modified frequency and the resulting accumulated phase error for the harmonic oscillator . Understanding this systematic phase error is key to interpreting the long-term behavior of periodic phenomena in molecular simulations.",
            "id": "3828031",
            "problem": "Consider a single harmonic normal mode representative of an atomistic subdomain in a multiscale materials simulation, modeled as a point mass with displacement $q(t)$ obeying Newton's second law $m\\,\\ddot{q}(t) + k\\,q(t) = 0$, where $m > 0$ is the mass, $k > 0$ is the stiffness, and $\\omega = \\sqrt{k/m}$ is the natural angular frequency. The mode is advanced in time using the velocity Verlet integrator, which is commonly employed in Molecular Dynamics (MD), with a fixed time step $h > 0$. Assume the stability condition $0  \\omega h  2$ and choose $h$ such that the exact period $T = 2\\pi/\\omega$ is an integer multiple of $h$, so that $M = N T / h \\in \\mathbb{N}$ steps correspond to exactly $N \\in \\mathbb{N}$ continuous periods.\n\nStarting from the fundamental equations of motion and the definition of the velocity Verlet algorithm, analyze the discrete dynamics to identify the modified angular frequency $\\tilde{\\omega}$ that governs the numerical evolution of the harmonic oscillator. Then, define the accumulated phase error after exactly $N$ continuous periods as $\\Delta \\phi = \\phi_{\\mathrm{num}} - \\phi_{\\mathrm{exact}}$, where $\\phi_{\\mathrm{exact}} = 2\\pi N$ and $\\phi_{\\mathrm{num}} = \\tilde{\\omega}\\,N T$, and derive a closed-form analytic expression for $\\Delta \\phi$ in terms of $N$, $\\omega$, and $h$.\n\nExpress the final phase error in radians. Your final answer must be a single closed-form analytic expression.",
            "solution": "The problem requires the derivation of the accumulated phase error for a harmonic oscillator integrated with the velocity Verlet algorithm. The derivation proceeds by first determining the modified angular frequency, $\\tilde{\\omega}$, that governs the discrete dynamics and then using it to compute the phase difference relative to the exact solution after a specified number of periods.\n\nThe equation of motion for the simple harmonic oscillator is given by:\n$$\nm\\,\\ddot{q}(t) + k\\,q(t) = 0\n$$\nwhere $q(t)$ is the displacement, $m$ is the mass, and $k$ is the stiffness. Dividing by $m$ and defining the natural angular frequency $\\omega = \\sqrt{k/m}$, we obtain the standard form:\n$$\n\\ddot{q}(t) = -\\omega^2 q(t)\n$$\nThe acceleration at time $t$ is $a(t) = \\ddot{q}(t) = -\\omega^2 q(t)$.\n\nThe velocity Verlet algorithm advances the position $q$ and velocity $v = \\dot{q}$ from time step $n$ to $n+1$ over a time interval $h$. The update rules are:\n1.  Update position: $q_{n+1} = q_n + v_n h + \\frac{1}{2} a_n h^2$\n2.  Update velocity: $v_{n+1} = v_n + \\frac{1}{2} (a_n + a_{n+1}) h$\n\nHere, $q_n = q(t_n)$, $v_n = v(t_n)$, and $a_n = a(t_n)$. For the harmonic oscillator, we can substitute $a_n = -\\omega^2 q_n$ and $a_{n+1} = -\\omega^2 q_{n+1}$.\n\nLet's rewrite the algorithm as a linear map for the state vector $\\begin{pmatrix} q_n \\\\ v_n \\end{pmatrix}$.\nFirst, substitute $a_n = -\\omega^2 q_n$ into the position update:\n$$\nq_{n+1} = q_n + v_n h - \\frac{1}{2} \\omega^2 q_n h^2 = \\left(1 - \\frac{1}{2}\\omega^2 h^2\\right)q_n + h\\,v_n\n$$\nNext, substitute $a_n = -\\omega^2 q_n$ and $a_{n+1} = -\\omega^2 q_{n+1}$ into the velocity update:\n$$\nv_{n+1} = v_n - \\frac{1}{2} \\omega^2 h (q_n + q_{n+1})\n$$\nNow, substitute the expression for $q_{n+1}$ into the equation for $v_{n+1}$:\n$$\nv_{n+1} = v_n - \\frac{1}{2} \\omega^2 h \\left[q_n + \\left(\\left(1 - \\frac{1}{2}\\omega^2 h^2\\right)q_n + h\\,v_n\\right)\\right]\n$$\n$$\nv_{n+1} = v_n - \\frac{1}{2} \\omega^2 h \\left[\\left(2 - \\frac{1}{2}\\omega^2 h^2\\right)q_n + h\\,v_n\\right]\n$$\n$$\nv_{n+1} = \\left[-\\omega^2 h\\left(1 - \\frac{1}{4}\\omega^2 h^2\\right)\\right]q_n + \\left(1 - \\frac{1}{2}\\omega^2 h^2\\right)v_n\n$$\nWe can now write the discrete evolution in matrix form, $\\begin{pmatrix} q_{n+1} \\\\ v_{n+1} \\end{pmatrix} = \\mathbf{A} \\begin{pmatrix} q_n \\\\ v_n \\end{pmatrix}$:\n$$\n\\begin{pmatrix} q_{n+1} \\\\ v_{n+1} \\end{pmatrix} = \\begin{pmatrix} 1 - \\frac{1}{2}\\omega^2 h^2  h \\\\ -\\omega^2 h\\left(1 - \\frac{1}{4}\\omega^2 h^2\\right)  1 - \\frac{1}{2}\\omega^2 h^2 \\end{pmatrix} \\begin{pmatrix} q_n \\\\ v_n \\end{pmatrix}\n$$\nThis matrix $\\mathbf{A}$ is the transfer matrix for one time step. The numerical dynamics are governed by its eigenvalues, $\\lambda$. The characteristic equation is $\\det(\\mathbf{A} - \\lambda\\mathbf{I}) = 0$:\n$$\n\\left(1 - \\frac{1}{2}\\omega^2 h^2 - \\lambda\\right)^2 + \\omega^2 h^2 \\left(1 - \\frac{1}{4}\\omega^2 h^2\\right) = 0\n$$\nExpanding this, we get a quadratic equation for $\\lambda$:\n$$\n\\lambda^2 - 2\\left(1 - \\frac{1}{2}\\omega^2 h^2\\right)\\lambda + \\left(1 - \\frac{1}{2}\\omega^2 h^2\\right)^2 + \\omega^2 h^2 - \\frac{1}{4}\\omega^4 h^4 = 0\n$$\n$$\n\\lambda^2 - \\left(2 - \\omega^2 h^2\\right)\\lambda + \\left(1 - \\omega^2 h^2 + \\frac{1}{4}\\omega^4 h^4\\right) + \\omega^2 h^2 - \\frac{1}{4}\\omega^4 h^4 = 0\n$$\n$$\n\\lambda^2 - \\left(2 - \\omega^2 h^2\\right)\\lambda + 1 = 0\n$$\nThe trace of the transfer matrix is $\\mathrm{Tr}(\\mathbf{A}) = 2 - \\omega^2 h^2$. For a stable oscillatory system, the numerical solution should also be oscillatory, corresponding to eigenvalues on the unit circle, $\\lambda = e^{\\pm i \\tilde{\\omega} h}$, where $\\tilde{\\omega}$ is the modified angular frequency. The trace of the matrix representation of this rotation is $e^{i\\tilde{\\omega}h} + e^{-i\\tilde{\\omega}h} = 2\\cos(\\tilde{\\omega}h)$.\nEquating the two expressions for the trace gives:\n$$\n2\\cos(\\tilde{\\omega}h) = 2 - \\omega^2 h^2\n$$\n$$\n\\cos(\\tilde{\\omega}h) = 1 - \\frac{1}{2}(\\omega h)^2\n$$\nThe stability condition $0  \\omega h  2$ ensures that the argument of the cosine is between $-1$ and $1$, so a real $\\tilde{\\omega}$ exists. We can solve for $\\tilde{\\omega}$ directly, but a more elegant expression is found using the half-angle identity $\\cos(\\theta) = 1 - 2\\sin^2(\\theta/2)$.\n$$\n1 - 2\\sin^2\\left(\\frac{\\tilde{\\omega}h}{2}\\right) = 1 - \\frac{1}{2}(\\omega h)^2\n$$\n$$\n\\sin^2\\left(\\frac{\\tilde{\\omega}h}{2}\\right) = \\frac{(\\omega h)^2}{4}\n$$\n$$\n\\sin\\left(\\frac{\\tilde{\\omega}h}{2}\\right) = \\frac{\\omega h}{2}\n$$\nWe take the positive root because for small $h$, $\\omega \\approx \\tilde{\\omega}$, so $\\tilde{\\omega}h/2$ is a small positive angle. The stability condition $0  \\omega h  2$ implies $0  \\omega h/2  1$, which is the domain for $\\arcsin$ to yield a principal value in $(0, \\pi/2)$.\nSolving for $\\tilde{\\omega}$:\n$$\n\\frac{\\tilde{\\omega}h}{2} = \\arcsin\\left(\\frac{\\omega h}{2}\\right)\n$$\n$$\n\\tilde{\\omega} = \\frac{2}{h}\\arcsin\\left(\\frac{\\omega h}{2}\\right)\n$$\nThis is the closed-form expression for the modified angular frequency.\n\nNow, we can compute the accumulated phase error, $\\Delta \\phi$, after a time $t_{final} = N T$, where $T = 2\\pi/\\omega$ is the exact period and $N$ is an integer.\nThe exact total phase accumulated is:\n$$\n\\phi_{\\mathrm{exact}} = \\omega t_{final} = \\omega (N T) = \\omega N \\frac{2\\pi}{\\omega} = 2\\pi N\n$$\nThe numerical total phase accumulated over the same duration is:\n$$\n\\phi_{\\mathrm{num}} = \\tilde{\\omega} t_{final} = \\tilde{\\omega} (N T)\n$$\nSubstituting the expressions for $\\tilde{\\omega}$ and $T$:\n$$\n\\phi_{\\mathrm{num}} = \\left(\\frac{2}{h}\\arcsin\\left(\\frac{\\omega h}{2}\\right)\\right) N \\left(\\frac{2\\pi}{\\omega}\\right) = \\frac{4\\pi N}{\\omega h}\\arcsin\\left(\\frac{\\omega h}{2}\\right)\n$$\nThe phase error $\\Delta\\phi$ is defined as the difference between the numerical and exact phases:\n$$\n\\Delta\\phi = \\phi_{\\mathrm{num}} - \\phi_{\\mathrm{exact}} = \\frac{4\\pi N}{\\omega h}\\arcsin\\left(\\frac{\\omega h}{2}\\right) - 2\\pi N\n$$\nFactoring out the term $2\\pi N$ yields the final closed-form expression for the accumulated phase error:\n$$\n\\Delta\\phi = 2\\pi N \\left(\\frac{2}{\\omega h}\\arcsin\\left(\\frac{\\omega h}{2}\\right) - 1\\right)\n$$\nThis expression depends only on the given parameters $N$, $\\omega$, and $h$. The condition that $T/h$ is an integer ensures that the comparison is made at a time when the exact system has completed an integer number of cycles, but it is not needed for the formula itself.",
            "answer": "$$\\boxed{2\\pi N \\left( \\frac{2}{\\omega h} \\arcsin\\left(\\frac{\\omega h}{2}\\right) - 1 \\right)}$$"
        },
        {
            "introduction": "Theory comes to life through implementation. This practice moves from analytical derivations to a direct computational test of the velocity Verlet algorithm's properties . You will simulate the interaction of two particles via the Lennard-Jones potential, a cornerstone model in materials science, and monitor the system's total energy over millions of time steps. This exercise provides concrete, numerical evidence of the superior energy conservation behavior of symplectic integrators, demonstrating why they are the standard for long-time molecular dynamics simulations.",
            "id": "3828000",
            "problem": "Consider a two-particle system in reduced units representative of coarse-grained atomistic interactions used in multiscale materials simulation. Two identical particles of mass $m$ interact through the Lennard-Jones pair potential $U(r)=4\\epsilon\\left[(\\sigma/r)^{12}-(\\sigma/r)^6\\right]$, where $r$ is the scalar separation (radial coordinate), $\\epsilon$ sets the energy scale, and $\\sigma$ sets the length scale. In the relative coordinate description appropriate for two identical masses, the dynamics reduce to a single degree of freedom governed by Newton's second law for the reduced mass $\\mu = m/2$,\n$$\n\\mu\\,\\ddot{r}(t) = -\\frac{dU}{dr}(r(t)),\n$$\nwith $r(t)>0$. The total energy is\n$$\nE(t) = \\frac{1}{2}\\mu\\,\\dot{r}(t)^2 + U(r(t)).\n$$\nStarting from the foundational laws above and the requirement of time reversibility and phase-space volume preservation for long-time materials simulations, derive the velocity Verlet integrator for this single-degree-of-freedom system, and implement one explicit time-stepping update that advances $(r,v)$, where $v=\\dot{r}$, by a time step $h$. Using this integrator, estimate the long-time energy drift over $N=10^6$ steps for specified time steps $h$.\n\nUse the following scientifically plausible and self-consistent setup in reduced Lennard-Jones units:\n- Parameters: $m=1$, $\\mu = 1/2$, $\\epsilon=1$, $\\sigma=1$.\n- Initial condition: $r(0)=1.3\\,\\sigma$ and $v(0)=0$.\n- Force from the potential: $F(r) = -\\frac{dU}{dr}(r)$ acting radially; use $F(r)=24\\,\\epsilon\\left[2\\,\\sigma^{12}r^{-13}-\\sigma^6 r^{-7}\\right]$ derived from the given $U(r)$.\n- Energy to monitor: $E(t)$ as defined above.\n\nTasks:\n1. Starting from Newton's second law and the given potential, derive the update rules of the velocity Verlet method for $(r,v)$ and explain why it is symplectic and time-reversible for separable Hamiltonians.\n2. Implement a single velocity Verlet update and use it iteratively for $N=10^6$ steps to advance the system.\n3. For each time step in the provided test suite, compute the energy drift $\\Delta E = E(Nh) - E(0)$ and report it in units of $\\epsilon$ as a floating-point number.\n\nTest suite:\n- Case 1 (happy path): $h=0.002$.\n- Case 2 (larger step, near-stability boundary for this setup): $h=0.02$.\n\nAngle units are not applicable here. Express energy drift values in units of $\\epsilon$ as decimal floating-point numbers. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2]\"). The results should be ordered to correspond to the test suite cases listed above.",
            "solution": "We begin from Newton's second law for the reduced-coordinate two-body problem. For two identical particles of mass $m$, the center of mass decouples and the relative coordinate $r$ evolves with reduced mass $\\mu=m/2$. The governing equation is\n$$\n\\mu\\,\\ddot{r}(t) = -\\frac{dU}{dr}(r(t)),\n$$\nwhere the Lennard-Jones potential is\n$$\nU(r) = 4\\epsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^6\\right].\n$$\nDifferentiating with respect to $r$ yields the radial force\n$$\nF(r) = -\\frac{dU}{dr}(r) = 24\\epsilon\\left[2 \\frac{\\sigma^{12}}{r^{13}} - \\frac{\\sigma^6}{r^7}\\right],\n$$\nand the acceleration $a(r)$ satisfies\n$$\na(r) = \\ddot{r} = \\frac{F(r)}{\\mu}.\n$$\nThe total energy, a constant of motion for the exact dynamics, is\n$$\nE(t) = \\frac{1}{2}\\mu\\,\\dot{r}(t)^2 + U(r(t)).\n$$\n\nTo design the numerical integrator for long-time stability in materials simulations, we rely on fundamental Hamiltonian principles. For separable Hamiltonians of the form $H(p,q) = T(p) + V(q)$, with $T(p) = p^2/(2\\mu)$ and $V(q) = U(q)$, the exact flow preserves the symplectic two-form and is time-reversible. A method that respects these properties typically avoids secular energy growth. The velocity Verlet method is derived by composing half-step momentum updates with a full-step position update, a consequence of splitting the Hamiltonian into kinetic and potential parts and applying the Lie-Trotter or Strang composition. Specifically, denote $r_n \\approx r(t_n)$ and $v_n \\approx \\dot{r}(t_n)$, with $t_{n+1} = t_n + h$. The velocity Verlet updates are\n$$\nr_{n+1} = r_n + h\\,v_n + \\frac{h^2}{2} a(r_n),\n$$\n$$\na_{n} = \\frac{F(r_n)}{\\mu}, \\quad a_{n+1} = \\frac{F(r_{n+1})}{\\mu},\n$$\n$$\nv_{n+1} = v_n + \\frac{h}{2}\\left[a(r_n) + a(r_{n+1})\\right].\n$$\nThis scheme is time-reversible: if one applies the update with $h$ and then reverses velocities and applies $-h$, the original state is recovered. It is symplectic because it can be interpreted as the composition of exact flows under $T(p)$ and $V(q)$, each of which is symplectic, and the composition maintains symplecticness. For smooth potentials, the method has global error $\\mathcal{O}(h^2)$ for states and exhibits bounded oscillatory energy error consistent with backward error analysis: the numerical trajectory exactly conserves a modified Hamiltonian $H_h$ that differs from $H$ by $\\mathcal{O}(h^2)$.\n\nAlgorithmic implementation proceeds as follows:\n1. Initialize parameters in reduced units: $m=1$, hence $\\mu=1/2$, $\\epsilon=1$, $\\sigma=1$. Choose initial conditions $r(0)=1.3\\sigma$ and $v(0)=0$, which lie near the potential minimum at $r_m = 2^{1/6}\\sigma$ yet avoid the strong repulsive core at very small $r$.\n2. Compute the initial acceleration $a_0 = F(r_0)/\\mu$ and initial energy $E_0 = \\frac{1}{2}\\mu v_0^2 + U(r_0)$.\n3. For a given time step $h$, iterate the velocity Verlet updates for $N=10^6$ steps:\n   - Update $r_{n+1}$ using $r_n, v_n$, and $a_n$.\n   - Compute $a_{n+1} = F(r_{n+1})/\\mu$.\n   - Update $v_{n+1}$ using the average acceleration.\n4. Compute the final energy $E_N = \\frac{1}{2}\\mu v_N^2 + U(r_N)$ and the energy drift $\\Delta E = E_N - E_0$.\n5. Repeat for the test suite time steps $h=0.002$ and $h=0.02$.\n\nBecause the velocity Verlet method is symplectic and time-reversible, $\\Delta E$ over long times is expected to be small and to exhibit bounded oscillations rather than systematic drift, provided $h$ is below the stability threshold set by the local stiffness (curvature) of $U(r)$ near the operating region. The larger time step tests proximity to this threshold, where the energy deviations increase but should remain bounded if stability is maintained.\n\nComputational considerations:\n- The operations per step are constant: evaluating $F(r)$ and $U(r)$ consists of a few multiplications and powers via repeated multiplications in reduced units, avoiding expensive function calls.\n- For $N=10^6$ steps, iterating the updates in a tight loop is feasible for two test cases.\n- All reported energy drifts are dimensionless in units of $\\epsilon$.\n\nThe program implements the described algorithm and outputs a single line containing the energy drifts for the specified $h$ values in the order given, enclosed in square brackets.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef lennard_jones_force(r, epsilon=1.0, sigma=1.0):\n    \"\"\"\n    Compute the radial Lennard-Jones force F(r) = -dU/dr for r  0.\n    F(r) = 24*epsilon * [ 2*(sigma^12)/r^13 - (sigma^6)/r^7 ].\n    Uses reduced units by default: epsilon = 1, sigma = 1.\n    \"\"\"\n    # Guard against non-positive r to avoid division by zero; reflect minimally.\n    if r = 0.0:\n        # If r is non-positive due to numerical error, gently push it positive.\n        r = abs(r) if r != 0.0 else np.finfo(float).tiny\n    inv_r = 1.0 / r\n    s_over_r = sigma * inv_r\n    s_over_r2 = s_over_r * s_over_r\n    s_over_r6 = s_over_r2 * s_over_r2 * s_over_r2  # (sigma/r)^6\n    s_over_r12 = s_over_r6 * s_over_r6             # (sigma/r)^12\n    # F = 24*epsilon * ( 2*s_over_r12/r - s_over_r6/r )\n    return 24.0 * epsilon * inv_r * (2.0 * s_over_r12 - s_over_r6)\n\ndef lennard_jones_potential(r, epsilon=1.0, sigma=1.0):\n    \"\"\"\n    Compute the Lennard-Jones potential U(r) = 4*epsilon * [ (sigma/r)^12 - (sigma/r)^6 ].\n    \"\"\"\n    if r = 0.0:\n        r = abs(r) if r != 0.0 else np.finfo(float).tiny\n    inv_r = 1.0 / r\n    s_over_r = sigma * inv_r\n    s_over_r2 = s_over_r * s_over_r\n    s_over_r6 = s_over_r2 * s_over_r2 * s_over_r2\n    s_over_r12 = s_over_r6 * s_over_r6\n    return 4.0 * epsilon * (s_over_r12 - s_over_r6)\n\ndef simulate_energy_drift(h_values, N_steps, r0, v0, m=1.0, epsilon=1.0, sigma=1.0):\n    \"\"\"\n    Simulate the relative-coordinate LJ system for each time step in h_values\n    using velocity Verlet for N_steps, and return a list of energy drifts\n    DeltaE = E_final - E_initial in units of epsilon.\n    \"\"\"\n    mu = 0.5 * m  # reduced mass for two identical particles\n\n    # Initialize states and accelerations for each h\n    states = []\n    for h in h_values:\n        r = float(r0)\n        v = float(v0)\n        a = lennard_jones_force(r, epsilon, sigma) / mu\n        E0 = 0.5 * mu * v * v + lennard_jones_potential(r, epsilon, sigma)\n        states.append([h, r, v, a, E0])\n\n    # Tight integration loop\n    for _ in range(N_steps):\n        # Update each state using velocity Verlet\n        # Unroll loop for performance when small number of h_values\n        if len(states) == 1:\n            h, r, v, a, E0 = states[0]\n            r_new = r + h * v + 0.5 * h * h * a\n            a_new = lennard_jones_force(r_new, epsilon, sigma) / mu\n            v_new = v + 0.5 * h * (a + a_new)\n            states[0][1] = r_new\n            states[0][2] = v_new\n            states[0][3] = a_new\n        elif len(states) == 2:\n            # First state\n            h0, r0s, v0s, a0s, E00 = states[0]\n            r0_new = r0s + h0 * v0s + 0.5 * h0 * h0 * a0s\n            a0_new = lennard_jones_force(r0_new, epsilon, sigma) / mu\n            v0_new = v0s + 0.5 * h0 * (a0s + a0_new)\n            states[0][1] = r0_new\n            states[0][2] = v0_new\n            states[0][3] = a0_new\n            # Second state\n            h1, r1s, v1s, a1s, E01 = states[1]\n            r1_new = r1s + h1 * v1s + 0.5 * h1 * h1 * a1s\n            a1_new = lennard_jones_force(r1_new, epsilon, sigma) / mu\n            v1_new = v1s + 0.5 * h1 * (a1s + a1_new)\n            states[1][1] = r1_new\n            states[1][2] = v1_new\n            states[1][3] = a1_new\n        else:\n            # General case\n            for i in range(len(states)):\n                h, r, v, a, E0 = states[i]\n                r_new = r + h * v + 0.5 * h * h * a\n                a_new = lennard_jones_force(r_new, epsilon, sigma) / mu\n                v_new = v + 0.5 * h * (a + a_new)\n                states[i][1] = r_new\n                states[i][2] = v_new\n                states[i][3] = a_new\n\n    # Compute energy drifts\n    drifts = []\n    for h, r, v, a, E0 in states:\n        E_final = 0.5 * mu * v * v + lennard_jones_potential(r, epsilon, sigma)\n        drifts.append(E_final - E0)\n    return drifts\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Two time steps to test: happy path and near-stability boundary.\n    h_values = [0.002, 0.02]\n    N_steps = 1_000_000\n    # Initial conditions in reduced units\n    r0 = 1.3  # sigma = 1\n    v0 = 0.0  # starting at rest\n    # Run simulation and collect energy drifts in units of epsilon.\n    results = simulate_energy_drift(h_values, N_steps, r0, v0, m=1.0, epsilon=1.0, sigma=1.0)\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}