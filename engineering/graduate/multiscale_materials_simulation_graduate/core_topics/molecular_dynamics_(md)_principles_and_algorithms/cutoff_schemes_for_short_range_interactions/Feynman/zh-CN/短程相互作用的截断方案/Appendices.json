{
    "hands_on_practices": [
        {
            "introduction": "在分子模拟中，为了计算效率，我们必须截断长程相互作用。然而，这种最简单的“硬截断”方法会引入系统性的误差。本练习旨在从第一性原理出发，量化这种截断误差，特别是对于像Lennard-Jones势这样具有幂律长程尾巴的势函数，我们将推导势能误差如何随截断半径 $r_c$ 变化，这是平衡计算精度与效率的关键考量。",
            "id": "3799687",
            "problem": "考虑一种三维均匀各向同性流体，其数密度为 $\\rho$，具有球对称的短程对势 $V(r)$，该势在有限的截断半径 $r_c$ 处被截断。每个粒子的总势能由双粒子关联定义，截断会引入一个误差 $\\Delta u$，该误差完全源于忽略了间距 $r \\ge r_c$ 的部分。假设流体处于这样一种状态：大间距下的对关联是有界的，并渐近地趋向于无关联极限。从第一性原理（即根据对关联函数以及流体的均匀性和各向同性来定义每个粒子的势能）出发，通过积分 $\\int_{r_c}^{\\infty} r^2 |V(r)| \\,\\mathrm{d}r$ 对尾部贡献进行定界，从而推导出 $|\\Delta u|$ 大小的一个界。具体来说，假设存在常数 $A>0$、$p>3$ 和 $r_0>0$，使得对于所有 $r \\ge r_0$ 都有 $|V(r)| \\le A r^{-p}$；并假设对于截断半径以外的大 $r$ 关联，存在一个有限的界 $g_{\\infty} \\ge 0$。在这些假设下，证明该界如何随 $r_c$ 变化。\n\n然后，对于 Lennard-Jones 势 $V_{\\mathrm{LJ}}(r) = 4 \\epsilon \\left[ \\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6} \\right]$（其中 $\\epsilon$ 为能量标度，$\\sigma$ 为长度标度），假设对双粒子关联采用标准的长程尾部近似，推导在 $r_c/\\sigma \\to \\infty$ 极限下，由 $\\epsilon$ 归一化的每个粒子势能的截断误差的领头阶渐近表达式。将你的最终结果表示为关于无量纲变量 $\\rho \\sigma^{3}$ 和 $r_c/\\sigma$ 的单个 $\\Delta u / \\epsilon$ 的闭式解析表达式。最终表达式中不要包含任何单位。仅报告领头阶渐近表达式作为你的最终答案。",
            "solution": "首先根据所需标准对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n- 系统：三维均匀各向同性流体。\n- 数密度：$\\rho$。\n- 对势：$V(r)$，球对称，短程。\n- 截断半径：$r_c$。\n- 每个粒子势能的截断误差：$\\Delta u$，仅源于忽略间距 $r \\ge r_c$。\n- 一般流体的假设：大间距下的对关联是有界的，并渐近趋向于无关联极限。\n- 任务1：通过积分 $\\int_{r_c}^{\\infty} r^2 |V(r)| \\,\\mathrm{d}r$ 推导 $|\\Delta u|$ 的界。\n- 任务1的假设：存在常数 $A>0$、$p>3$ 和 $r_0>0$，使得对所有 $r \\ge r_0$ 都有 $|V(r)| \\le A r^{-p}$。\n- 任务1的假设：对于截断半径以外的大 $r$ 关联，存在一个有限的界 $g_{\\infty} \\ge 0$。\n- 目标1：证明 $|\\Delta u|$ 的界如何随 $r_c$ 变化。\n- 任务2的特定势：Lennard-Jones 势 $V_{\\mathrm{LJ}}(r) = 4 \\epsilon \\left[ \\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6} \\right]$，其中 $\\epsilon$ 为能量标度，$\\sigma$ 为长度标度。\n- 任务2的假设：对双粒子关联采用标准的长程尾部近似。\n- 目标2：在 $r_c/\\sigma \\to \\infty$ 极限下，推导截断误差 $\\Delta u / \\epsilon$ 的领头阶渐近表达式。\n- 最终答案格式：关于无量纲变量 $\\rho \\sigma^{3}$ 和 $r_c/\\sigma$ 的单个 $\\Delta u / \\epsilon$ 的闭式解析表达式。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学上合理**：该问题基于流体统计力学的基本原理，特别是使用对关联函数计算势能。截断半径的概念和截断误差的分析是分子模拟中的标准和关键课题。Lennard-Jones 势是该领域的经典模型。所有前提在事实上和科学上都是合理的。\n- **提法恰当**：该问题清晰地分为两部分，有明确的假设和目标。所提供的信息足以进行所需的推导。“对双粒子关联采用标准的长程尾部近似”这一表述唯一地意指近似 $g(r) \\to 1$（当 $r \\to \\infty$ 时），这在此背景下是标准的。对于领头阶项，该问题允许一个唯一解。\n- **客观性**：该问题以精确、无歧义的技术语言陈述，不含主观论断。\n\n### 步骤3：结论与行动\n该问题在科学上合理、提法恰当且客观。它不包含任何使其无效的缺陷。因此，该问题被判定为**有效**。将提供完整解答。\n\n### 解答推导\n\n一个包含 $N$ 个粒子、体积为 $\\mathcal{V}$ 的系统，其总势能 $U$ 可以用数密度 $\\rho = N/\\mathcal{V}$ 和对关联函数 $g(r)$ 来表示。对于均匀各向同性流体，每个粒子的势能 $u = U/N$ 由下式给出：\n$$\nu = \\frac{1}{2} \\rho \\int_0^{\\infty} V(r) g(r) 4 \\pi r^2 \\,\\mathrm{d}r = 2 \\pi \\rho \\int_0^{\\infty} V(r) g(r) r^2 \\,\\mathrm{d}r\n$$\n因子 $\\frac{1}{2}$ 是为了校正对粒子对的双重计数。当势在截断半径 $r_c$ 处被截断时，会引入一个误差 $\\Delta u$，它对应于积分中 $r \\ge r_c$ 的尾部贡献。\n$$\n\\Delta u = 2 \\pi \\rho \\int_{r_c}^{\\infty} V(r) g(r) r^2 \\,\\mathrm{d}r\n$$\n\n**第一部分：一般界与标度关系**\n\n我们需要找到截断误差大小 $|\\Delta u|$ 的一个界。使用积分的三角不等式：\n$$\n|\\Delta u| = \\left| 2 \\pi \\rho \\int_{r_c}^{\\infty} V(r) g(r) r^2 \\,\\mathrm{d}r \\right| \\le 2 \\pi \\rho \\int_{r_c}^{\\infty} |V(r)| |g(r)| r^2 \\,\\mathrm{d}r\n$$\n问题陈述，对于大间距，对关联由一个有限值 $g_{\\infty} \\ge 0$ 界定。我们假设 $r_c$ 足够大，使得对于所有 $r \\ge r_c$ 都有 $|g(r)| \\le g_{\\infty}$。问题还陈述，存在常数 $A > 0$、$p > 3$ 和 $r_0 > 0$，使得对于所有 $r \\ge r_0$ 都有 $|V(r)| \\le A r^{-p}$。我们假设 $r_c \\ge r_0$。应用这些界：\n$$\n|\\Delta u| \\le 2 \\pi \\rho g_{\\infty} \\int_{r_c}^{\\infty} (A r^{-p}) r^2 \\,\\mathrm{d}r = 2 \\pi \\rho g_{\\infty} A \\int_{r_c}^{\\infty} r^{2-p} \\,\\mathrm{d}r\n$$\n该积分可以直接计算。由于 $p > 3$，指数 $2-p$ 小于 $-1$，保证了积分收敛。\n$$\n\\int_{r_c}^{\\infty} r^{2-p} \\,\\mathrm{d}r = \\left[ \\frac{r^{3-p}}{3-p} \\right]_{r_c}^{\\infty}\n$$\n因为 $p > 3$，指数 $3-p$ 是负的，所以 $\\lim_{r\\to\\infty} r^{3-p} = 0$。积分计算结果为：\n$$\n0 - \\frac{r_c^{3-p}}{3-p} = \\frac{r_c^{3-p}}{p-3}\n$$\n将此结果代回不等式，得到 $|\\Delta u|$ 的界：\n$$\n|\\Delta u| \\le \\frac{2 \\pi \\rho g_{\\infty} A}{p-3} r_c^{3-p}\n$$\n这表明截断误差大小的界与截断半径的标度关系为 $|\\Delta u| \\propto r_c^{3-p}$。\n\n**第二部分：Lennard-Jones 势**\n\n现在我们考虑 Lennard-Jones 势的具体情况：\n$$\nV_{\\mathrm{LJ}}(r) = 4 \\epsilon \\left[ \\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6} \\right]\n$$\n截断误差为：\n$$\n\\Delta u = 2 \\pi \\rho \\int_{r_c}^{\\infty} V_{\\mathrm{LJ}}(r) g(r) r^2 \\,\\mathrm{d}r\n$$\n问题指定在 $r_c/\\sigma \\to \\infty$ 极限下对 $g(r)$ 使用“标准的长程尾部近似”。该近似在于设 $r \\ge r_c$ 时 $g(r) \\approx 1$，因为关联在长距离处消失。\n$$\n\\Delta u \\approx 2 \\pi \\rho \\int_{r_c}^{\\infty} 4 \\epsilon \\left[ \\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6} \\right] r^2 \\,\\mathrm{d}r\n$$\n$$\n\\Delta u \\approx 8 \\pi \\rho \\epsilon \\int_{r_c}^{\\infty} \\left( \\sigma^{12}r^{-12} - \\sigma^{6}r^{-6} \\right) r^2 \\,\\mathrm{d}r\n$$\n$$\n\\Delta u \\approx 8 \\pi \\rho \\epsilon \\int_{r_c}^{\\infty} \\left( \\sigma^{12}r^{-10} - \\sigma^{6}r^{-4} \\right) \\,\\mathrm{d}r\n$$\n我们进行积分：\n$$\n\\int \\left( \\sigma^{12}r^{-10} - \\sigma^{6}r^{-4} \\right) \\,\\mathrm{d}r = \\sigma^{12}\\frac{r^{-9}}{-9} - \\sigma^{6}\\frac{r^{-3}}{-3} = -\\frac{\\sigma^{12}}{9r^9} + \\frac{\\sigma^{6}}{3r^3}\n$$\n计算从 $r_c$ 到 $\\infty$ 的定积分：\n$$\n\\left[ -\\frac{\\sigma^{12}}{9r^9} + \\frac{\\sigma^{6}}{3r^3} \\right]_{r_c}^{\\infty} = \\lim_{r\\to\\infty} \\left(-\\frac{\\sigma^{12}}{9r^9} + \\frac{\\sigma^{6}}{3r^3}\\right) - \\left(-\\frac{\\sigma^{12}}{9r_c^9} + \\frac{\\sigma^{6}}{3r_c^3}\\right)\n$$\n$$\n= (0 + 0) - \\left(-\\frac{\\sigma^{12}}{9r_c^9} + \\frac{\\sigma^{6}}{3r_c^3}\\right) = \\frac{\\sigma^{12}}{9r_c^9} - \\frac{\\sigma^{6}}{3r_c^3}\n$$\n因此，在此近似下误差的完整表达式为：\n$$\n\\Delta u \\approx 8 \\pi \\rho \\epsilon \\left( \\frac{\\sigma^{12}}{9r_c^9} - \\frac{\\sigma^{6}}{3r_c^3} \\right)\n$$\n问题要求在 $r_c/\\sigma \\to \\infty$ 极限下的*领头阶*渐近表达式。我们必须比较这两项。第一项的标度关系为 $(r_c/\\sigma)^{-9}$，而第二项的标度关系为 $(r_c/\\sigma)^{-3}$。当 $r_c/\\sigma \\to \\infty$ 时，负幂次较小的那一项，即 $(r_c/\\sigma)^{-3}$，衰减得慢得多，因此是主导的领头阶项。该项源于势能的 $r^{-6}$ 引力部分。\n$$\n\\Delta u \\approx 8 \\pi \\rho \\epsilon \\left( - \\frac{\\sigma^{6}}{3r_c^3} \\right) = -\\frac{8 \\pi \\rho \\epsilon \\sigma^6}{3 r_c^3}\n$$\n题目要求我们将 $\\Delta u / \\epsilon$ 的结果用无量纲变量 $\\rho \\sigma^3$ 和 $r_c/\\sigma$ 表示。\n$$\n\\frac{\\Delta u}{\\epsilon} \\approx -\\frac{8 \\pi \\rho \\sigma^6}{3 r_c^3} = -\\frac{8 \\pi}{3} (\\rho \\sigma^3) \\frac{\\sigma^3}{r_c^3} = -\\frac{8 \\pi}{3} (\\rho \\sigma^3) \\left(\\frac{\\sigma}{r_c}\\right)^3\n$$\n这就是归一化截断误差的领头阶渐近表达式。",
            "answer": "$$\n\\boxed{-\\frac{8 \\pi}{3} (\\rho \\sigma^{3}) \\left(\\frac{r_c}{\\sigma}\\right)^{-3}}\n$$"
        },
        {
            "introduction": "硬截断势函数会在截断半径处产生力的不连续性，这会严重影响能量守恒，导致模拟结果不可靠。为了解决这个问题，我们引入了平滑的切换函数。本练习将指导你构建并分析两种不同平滑度的切换函数（$C^1$ 和 $C^2$），并比较它们对系统作用力的扰动，让你亲身体会到函数连续性对物理模拟真实性的直接影响。",
            "id": "3799640",
            "problem": "考虑分子动力学 (MD) 中的一个各向同性对相互作用，其特征是一个径向对称势 $\\phi(r)$，其中 $r$ 是原子间距。为了减缓在有限截断半径 $r_{c}$ 处出现的力的不连续性，引入了一个光滑的开关函数 $S(r)$，定义了修正势 $U_{S}(r) = S(r)\\,\\phi(r)$。假设一个开关区间 $[r_{s}, r_{c}]$，$r_{c} > r_{s}$，在此区间内 $S(r)$ 从 $1$ 单调过渡到 $0$，在此区间外，当 $r \\le r_{s}$ 时 $S(r)$ 等于 $1$，当 $r \\ge r_{c}$ 时 $S(r)$ 等于 $0$。\n\n你的任务是使用具有指定光滑性的开关函数来设计和分析短程相互作用的截断方案：\n\n1. 构建一个在 $[r_{s}, r_{c}]$ 上的 $C^{1}$ 三次开关函数 $S_{\\mathrm{cub}}(r)$，它满足边界条件 $S(r_{s}) = 1$、$S(r_{c}) = 0$、$S'(r_{s}) = 0$ 和 $S'(r_{c}) = 0$，其中撇号表示对 $r$ 的微分。\n\n2. 考虑在 $[r_{s}, r_{c}]$ 上的标准 $C^{2}$ 五次开关函数 $S_{\\mathrm{qui}}(r)$，它满足边界条件 $S(r_{s}) = 1$、$S(r_{c}) = 0$、$S'(r_{s}) = 0$、$S'(r_{c}) = 0$、$S''(r_{s}) = 0$ 和 $S''(r_{c}) = 0$，其中双撇号表示对 $r$ 的二阶导数。\n\n定义由开关引起的力微扰矢量为 $\\Delta \\mathbf{f}(r) = \\mathbf{f}_{S}(r) - \\mathbf{f}_{0}(r)$，其中 $\\mathbf{f}_{S}(r) = -\\nabla U_{S}(r)$ 是开关后的力，$\\mathbf{f}_{0}(r) = -\\nabla \\phi(r)$ 是原始力。对于中心势，力是径向的，可以用其大小 $f_{S}(r)$ 和 $f_{0}(r)$ 来表示，其中 $f(r) = -\\frac{d}{dr}(\\cdot)$。\n\n从第一性原理出发——即力的定义是势的负梯度以及链式法则——推导在 $r \\in [r_{s}, r_{c}]$ 上 $|\\Delta f(r)|$ 的一个界，用 $|S'(r)|$、$|\\phi(r)|$ 和 $|\\phi'(r)|$ 表示。然后，使用这个界，比较由 $|S'(r)|\\,|\\phi(r)|$ 项对 $C^{1}$ 三次和 $C^{2}$ 五次开关函数所诱导的最大值。为了使比较独立于特定的材料体系，重点关注三次与五次开关函数在 $[r_{s}, r_{c}]$ 上 $|S'(r)|$ 的上确界之比，用开关宽度 $w = r_{c} - r_{s}$ 表示。\n\n将你的最终答案表示为一个单一的无量纲数，即比值\n$$\\frac{\\sup_{r \\in [r_{s}, r_{c}]} |S_{\\mathrm{cub}}'(r)|}{\\sup_{r \\in [r_{s}, r_{c}]} |S_{\\mathrm{qui}}'(r)|}.$$\n无需四舍五入。请以无单位的无量纲数形式提供该比值。",
            "solution": "该问题要求构造和分析两个多项式开关函数，一个是三次的，一个是五次的，并随后比较它们的一阶导数。分析将分几步进行：首先，推导开关函数的显式形式；其次，推导力微扰的一般表达式；第三，找到每个函数一阶导数大小的最大值；最后，计算这些最大值的比值。\n\n为简化推导，我们为开关区间 $[r_{s}, r_{c}]$ 引入一个归一化的无量纲变量 $x$。设区间的宽度为 $w = r_{c} - r_{s}$。变量 $x$ 定义为\n$$x = \\frac{r - r_{s}}{w}$$\n这样，当 $r=r_{s}$ 时 $x=0$，当 $r=r_{c}$ 时 $x=1$。因此，$r(x) = r_{s} + wx$。\n\n任何函数 $S(r)$ 对 $r$ 的导数，可以用其对应的函数 $g(x) = S(r(x))$ 对 $x$ 的导数，通过链式法则来表示：\n$$S'(r) = \\frac{dS}{dr} = \\frac{dg}{dx}\\frac{dx}{dr} = g'(x) \\frac{1}{w}$$\n$$S''(r) = \\frac{d}{dr}\\left(g'(x)\\frac{1}{w}\\right) = \\frac{d}{dx}\\left(g'(x)\\frac{1}{w}\\right)\\frac{dx}{dr} = g''(x) \\frac{1}{w^2}$$\n\n**1. 构造 $C^{1}$ 三次开关函数 $S_{\\mathrm{cub}}(r)$**\n\n我们寻求在区间 $[0, 1]$ 上的一个三次多项式 $g_{\\mathrm{cub}}(x) = ax^3 + bx^2 + cx + d$。$S_{\\mathrm{cub}}(r)$ 的边界条件是 $S(r_{s})=1$、$S(r_{c})=0$、$S'(r_{s})=0$ 和 $S'(r_{c})=0$。用 $g_{\\mathrm{cub}}(x)$ 表示，这些条件是：\n$1.$ $g_{\\mathrm{cub}}(0) = 1$\n$2.$ $g_{\\mathrm{cub}}(1) = 0$\n$3.$ $g'_{\\mathrm{cub}}(0) = 0$ (因为 $S'(r_s) = g'_{\\mathrm{cub}}(0)/w = 0$)\n$4.$ $g'_{\\mathrm{cub}}(1) = 0$ (因为 $S'(r_c) = g'_{\\mathrm{cub}}(1)/w = 0$)\n\n将这些条件应用于 $g_{\\mathrm{cub}}(x)$ 及其导数 $g'_{\\mathrm{cub}}(x) = 3ax^2 + 2bx + c$：\n由条件 1：$g_{\\mathrm{cub}}(0) = d = 1$。\n由条件 3：$g'_{\\mathrm{cub}}(0) = c = 0$。\n多项式简化为 $g_{\\mathrm{cub}}(x) = ax^3 + bx^2 + 1$。\n应用余下的条件：\n由条件 2：$g_{\\mathrm{cub}}(1) = a + b + 1 = 0$。\n由条件 4：$g'_{\\mathrm{cub}}(1) = 3a + 2b = 0$。\n\n我们求解这个关于 $a$ 和 $b$ 的二元线性方程组：\n$$a + b = -1$$\n$$3a + 2b = 0$$\n由第二个方程，得 $b = -\\frac{3}{2}a$。代入第一个方程：\n$$a - \\frac{3}{2}a = -1 \\implies -\\frac{1}{2}a = -1 \\implies a = 2$$\n则 $b = -\\frac{3}{2}(2) = -3$。\n因此，归一化的三次多项式是 $g_{\\mathrm{cub}}(x) = 2x^3 - 3x^2 + 1$。\n所以三次开关函数 $S_{\\mathrm{cub}}(r)$ 是：\n$$S_{\\mathrm{cub}}(r) = 2\\left(\\frac{r - r_{s}}{w}\\right)^3 - 3\\left(\\frac{r - r_{s}}{w}\\right)^2 + 1 \\quad \\text{for } r \\in [r_{s}, r_{c}]$$\n\n**2. 构造 $C^{2}$ 五次开关函数 $S_{\\mathrm{qui}}(r)$**\n\n我们寻求在 $[0,1]$ 上的一个五次多项式 $g_{\\mathrm{qui}}(x) = Ax^5 + Bx^4 + Cx^3 + Dx^2 + Ex + F$。$S_{\\mathrm{qui}}(r)$ 的六个边界条件是 $S(r_{s})=1$、$S(r_{c})=0$、$S'(r_{s})=0$、$S'(r_{c})=0$、$S''(r_{s})=0$ 和 $S''(r_{c})=0$。用 $g_{\\mathrm{qui}}(x)$ 表示，这些条件是：\n$1.$ $g_{\\mathrm{qui}}(0) = 1$\n$2.$ $g_{\\mathrm{qui}}(1) = 0$\n$3.$ $g'_{\\mathrm{qui}}(0) = 0$\n$4.$ $g'_{\\mathrm{qui}}(1) = 0$\n$5.$ $g''_{\\mathrm{qui}}(0) = 0$\n$6.$ $g''_{\\mathrm{qui}}(1) = 0$\n\n将这些条件应用于 $g_{\\mathrm{qui}}(x)$ 及其导数 $g'_{\\mathrm{qui}}(x) = 5Ax^4 + 4Bx^3 + 3Cx^2 + 2Dx + E$ 和 $g''_{\\mathrm{qui}}(x) = 20Ax^3 + 12Bx^2 + 6Cx + 2D$：\n由条件 1：$F = 1$。\n由条件 3：$E = 0$。\n由条件 5：$2D = 0 \\implies D=0$。\n多项式简化为 $g_{\\mathrm{qui}}(x) = Ax^5 + Bx^4 + Cx^3 + 1$。\n在 $x=1$ 处的余下条件给出了一个关于 $A, B, C$ 的方程组：\n由条件 2：$A + B + C + 1 = 0$。\n由条件 4：$5A + 4B + 3C = 0$。\n由条件 6：$20A + 12B + 6C = 0 \\implies 10A + 6B + 3C = 0$。\n\n将第二个方程从第三个方程中减去：$(10A-5A) + (6B-4B) + (3C-3C) = 0 \\implies 5A + 2B = 0 \\implies B = -\\frac{5}{2}A$。\n将 $B$ 代入第二个方程：$5A + 4(-\\frac{5}{2}A) + 3C = 0 \\implies 5A - 10A + 3C = 0 \\implies -5A + 3C = 0 \\implies C = \\frac{5}{3}A$。\n将 $B$ 和 $C$ 代入第一个方程：$A - \\frac{5}{2}A + \\frac{5}{3}A + 1 = 0$。两边乘以 $6$ 得 $6A - 15A + 10A + 6 = 0 \\implies A + 6 = 0 \\implies A = -6$。\n则 $B = -\\frac{5}{2}(-6) = 15$，且 $C = \\frac{5}{3}(-6) = -10$。\n归一化的五次多项式是 $g_{\\mathrm{qui}}(x) = -6x^5 + 15x^4 - 10x^3 + 1$。\n\n**3. 力微扰界的推导**\n\n原始力的大小为 $f_{0}(r) = -\\frac{d}{dr}\\phi(r) = -\\phi'(r)$。\n开关后的势为 $U_{S}(r) = S(r)\\phi(r)$。\n开关后的力的大小为 $f_{S}(r) = -\\frac{d}{dr}U_{S}(r) = -\\frac{d}{dr}[S(r)\\phi(r)]$。\n使用乘积法则求导：\n$$f_{S}(r) = -[S'(r)\\phi(r) + S(r)\\phi'(r)]$$\n诱导的力微扰大小 $\\Delta f(r)$ 是开关后的力与原始力之差：\n$$\\Delta f(r) = f_{S}(r) - f_{0}(r) = -S'(r)\\phi(r) - S(r)\\phi'(r) - (-\\phi'(r))$$\n$$\\Delta f(r) = -S'(r)\\phi(r) + (1 - S(r))\\phi'(r)$$\n该微扰的大小为 $|\\Delta f(r)| = |-S'(r)\\phi(r) + (1 - S(r))\\phi'(r)|$。\n应用三角不等式 $|a+b| \\le |a| + |b|$，我们得到界：\n$$|\\Delta f(r)| \\le |-S'(r)\\phi(r)| + |(1 - S(r))\\phi'(r)|$$\n$$|\\Delta f(r)| \\le |S'(r)||\\phi(r)| + |1 - S(r)||\\phi'(r)|$$\n由于 $S(r)$ 在 $[r_{s}, r_{c}]$ 上从 $1$ 单调递减到 $0$，所以 $0 \\le S(r) \\le 1$，这意味着 $|1 - S(r)| = 1 - S(r)$。界为：\n$$|\\Delta f(r)| \\le |S'(r)||\\phi(r)| + (1 - S(r))|\\phi'(r)|$$\n\n**4. $|S'(r)|$ 的上确界比较**\n\n问题要求比较 $|S'(r)||\\phi(r)|$ 项，这需要找到两个函数在区间 $[r_{s}, r_{c}]$ 上 $|S'(r)|$ 的上确界。\n\n对于三次函数：\n$S'_{\\mathrm{cub}}(r) = \\frac{1}{w} g'_{\\mathrm{cub}}(x) = \\frac{1}{w}(6x^2 - 6x) = \\frac{6}{w}x(x-1)$。\n由于 $x \\in [0, 1]$，项 $x(x-1)$ 是非正的。\n$|S'_{\\mathrm{cub}}(r)| = \\frac{6}{w}|x(x-1)| = \\frac{6}{w}(x - x^2)$。\n为了找到这个表达式在 $[0,1]$ 上的最大值，我们求抛物线 $p(x) = x - x^2$ 的顶点。最大值出现在 $x = -1/(2(-1)) = 1/2$。\n$|g'_{\\mathrm{cub}}(x)| = 6(x-x^2)$ 的最大值在 $x=1/2$ 处取得：\n$|g'_{\\mathrm{cub}}(1/2)| = 6(\\frac{1}{2} - (\\frac{1}{2})^2) = 6(\\frac{1}{2} - \\frac{1}{4}) = 6(\\frac{1}{4}) = \\frac{3}{2}$。\n因此，$\\sup_{r \\in [r_{s}, r_{c}]} |S'_{\\mathrm{cub}}(r)| = \\frac{1}{w} \\sup_{x \\in [0, 1]} |g'_{\\mathrm{cub}}(x)| = \\frac{3}{2w}$。\n\n对于五次函数：\n$S'_{\\mathrm{qui}}(r) = \\frac{1}{w} g'_{\\mathrm{qui}}(x) = \\frac{1}{w}(-30x^4 + 60x^3 - 30x^2) = -\\frac{30}{w}x^2(x^2 - 2x + 1) = -\\frac{30}{w}x^2(x-1)^2$。\n对于所有 $x$，项 $x^2(x-1)^2$ 是非负的。因此，$S'_{\\mathrm{qui}}(r)$ 在该区间上是非正的。\n$|S'_{\\mathrm{qui}}(r)| = \\frac{30}{w}x^2(x-1)^2 = \\frac{30}{w}[x(1-x)]^2$。\n该表达式的最大值出现在 $x(1-x)$ 最大的地方，即 $x=1/2$。在这一点，$x(1-x) = 1/4$。\n$|g'_{\\mathrm{qui}}(x)| = 30[x(1-x)]^2$ 的最大值在 $x=1/2$ 处取得：\n$|g'_{\\mathrm{qui}}(1/2)| = 30[(\\frac{1}{2})(1-\\frac{1}{2})]^2 = 30(\\frac{1}{4})^2 = \\frac{30}{16} = \\frac{15}{8}$。\n因此，$\\sup_{r \\in [r_{s}, r_{c}]} |S'_{\\mathrm{qui}}(r)| = \\frac{1}{w} \\sup_{x \\in [0, 1]} |g'_{\\mathrm{qui}}(x)| = \\frac{15}{8w}$。\n\n**5. 最终比值计算**\n\n所要求的比值为：\n$$\\frac{\\sup_{r \\in [r_{s}, r_{c}]} |S_{\\mathrm{cub}}'(r)|}{\\sup_{r \\in [r_{s}, r_{c}]} |S_{\\mathrm{qui}}'(r)|} = \\frac{\\frac{3}{2w}}{\\frac{15}{8w}} = \\frac{3}{2} \\cdot \\frac{8}{15} = \\frac{24}{30} = \\frac{4}{5}$$\n该比值是一个无量纲常数，表明对于给定的开关宽度 $w$，三次开关函数导数大小的最大值是五次开关函数导数大小最大值的 $4/5$。这与直觉相悖，因为通常期望更高阶的平滑会减小导数，但在这里我们看到一阶导数的峰值大小却相反。五次函数的附加约束迫使其在区间中点的斜率更陡，以满足两端导数为零的条件。",
            "answer": "$$\n\\boxed{\\frac{4}{5}}\n$$"
        },
        {
            "introduction": "大多数分子模拟都在周期性边界条件（PBC）下进行，并遵循最小镜像约定（MIC）来计算粒子间的相互作用。这一约定要求截断半径 $r_c$ 不能超过模拟盒子边长的一半 ($L/2$)。本练习将探讨当这一基本规则被无意中违反时会发生什么，通过量化由此产生的虚假能量和压力贡献，你将深刻理解为何 $r_c \\le L/2$ 是确保模拟物理正确性的一个硬性约束。",
            "id": "3799666",
            "problem": "考虑一个在周期性边界条件 (PBC) 下的三维周期性体系，该体系占据一个边长为 $L$ 的立方模拟单元，数密度为 $\\rho$。假设一个成对的、球对称的短程势 $u(r)$ 使用半径为 $r_c = \\frac{L}{2} + \\Delta$ 的球形截断，其中有一个小的正溢出量 $\\Delta \\ll L$。假设在评估对距离时采用最小镜像约定 (MIC)。当 $r_c > \\frac{L}{2}$ 时，某些粒子对可能有一个以上的周期性镜像分离矢量，其模长小于或等于 $r_c$，我们称之为“模糊”对。\n\n假设体系是均匀的，因此对于接近 $\\frac{L}{2}$ 的距离，径向分布函数 (RDF) $g(r)$ 满足 $g(r) \\approx 1$。假设 $u(r)$ 在 $r = \\frac{L}{2}$ 的一个邻域内是连续可微的，其导数为 $u'(r)$。通过忽略 $\\mathcal{O}\\!\\left((\\Delta/L)^3\\right)$ 及更高阶的边和角贡献，以小参数 $\\Delta/L$ 的领头阶来处理模糊区域的几何形状。\n\n从第一性原理出发，即立方单元中 MIC 的几何表征以及均匀体系中位形能量密度和维里压力的标准表达式，\n- 单位体积的位形能量：$U/V = \\frac{\\rho^2}{2} \\int u(r)\\,g(r)\\,d^3 r$，\n- 维里压力：$p = \\rho k_B T - \\frac{\\rho^2}{6} \\int r\\,u'(r)\\,g(r)\\,d^3 r$，\n\n推导出在 Wigner–Seitz 原胞 $[-L/2,L/2]^3$ 中，除了满足 $|r| \\le r_c$ 的 MIC 分离外，还存在至少一个满足 $|r_{\\mathrm{alt}}| \\le r_c$ 的非最小周期性镜像分离 $r_{\\mathrm{alt}}$ 的位移矢量 $r$ 的分数 $f_{\\mathrm{amb}}$，结果保留到 $\\Delta/L$ 的领头阶。然后用此结果计算领头阶偏差：\n- $\\Delta \\mathcal{E}$，即为每个模糊对包含一个额外周期性镜像所引起的单位体积位形能量的伪增量，\n- $\\Delta p$，即维里压力中相应的伪偏移。\n\n将 $\\Delta \\mathcal{E}$ 以焦耳/立方米表示，$\\Delta p$ 以帕斯卡表示。用 $\\rho$、$L$、$\\Delta$、$u\\!\\left(\\frac{L}{2}\\right)$ 和 $u'\\!\\left(\\frac{L}{2}\\right)$ 的符号形式提供您的最终表达式。无需四舍五入；请提供精确的解析表达式。您的最终答案必须是一个单行矩阵，按顺序包含 $f_{\\mathrm{amb}}$、$\\Delta \\mathcal{E}$ 和 $\\Delta p$ 这三个量。",
            "solution": "用户希望解决一个多尺度材料模拟领域的问题。\n\n### 步骤1：提取已知条件\n- **体系**：在周期性边界条件 (PBC) 下的三维周期性体系。\n- **模拟单元**：边长为 $L$ 的立方单元。\n- **数密度**：$\\rho$。\n- **相互作用**：成对的、球对称的短程势 $u(r)$。\n- **截断半径**：$r_c = \\frac{L}{2} + \\Delta$，其中 $\\Delta > 0$ 且 $\\Delta \\ll L$。\n- **距离约定**：最小镜像约定 (MIC)。\n- **模糊对**：具有一个以上周期性镜像分离矢量且其模长小于或等于 $r_c$ 的粒子对。\n- **RDF的近似**：对于接近 $\\frac{L}{2}$ 的距离 $r$，径向分布函数 $g(r) \\approx 1$。\n- **势函数的近似**：$u(r)$ 在 $r = \\frac{L}{2}$ 附近连续可微，导数为 $u'(r)$。\n- **几何近似**：$\\Delta/L$ 的领头阶，忽略 $\\mathcal{O}((\\Delta/L)^3)$ 及更高阶的贡献。\n- **给定的公式**：\n    - 位形能量密度：$\\mathcal{E} = U/V = \\frac{\\rho^2}{2} \\int u(r)\\,g(r)\\,d^3 r$。\n    - 维里压力：$p = \\rho k_B T - \\frac{\\rho^2}{6} \\int r\\,u'(r)\\,g(r)\\,d^3 r$。\n- **任务**：\n    1.  推导 Wigner-Seitz 原胞中模糊位移矢量的分数 $f_{\\mathrm{amb}}$。\n    2.  推导伪位形能量密度增量 $\\Delta \\mathcal{E}$。\n    3.  推导伪维里压力偏移 $\\Delta p$。\n- **输出要求**：用 $\\rho$、$L$、$\\Delta$、$u\\left(\\frac{L}{2}\\right)$ 和 $u'\\left(\\frac{L}{2}\\right)$ 表示结果。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题定义明确，其科学基础根植于统计力学和计算物理的原理。截断半径 $r_c > L/2$ 的情景是分子模拟中一个已知的潜在误差来源，因此对其进行分析是一个有效的科学问题。所提供的能量和压力公式是标准的。各项假设（$g(r) \\approx 1$、$u(r)$ 的可微性、$\\Delta/L$ 的领头阶分析）陈述清晰，使问题可解。该问题是自洽的、客观的且非平凡的。未检测到科学、逻辑或事实上的缺陷。\n\n### 步骤3：结论与行动\n该问题有效。有必要给出一个完整的、有理有据的解答。\n\n### 解答推导\n\n该问题要求我们确定在一个立方周期性体系中，使用超过盒子长度一半 $L/2$ 的截断半径 $r_c = L/2 + \\Delta$ 所带来的后果。这可能导致一对粒子与其多个周期性镜像发生相互作用，这违反了势程应短于镜像间最小距离的原则。\n\n**1. 模糊区域的几何形状与体积**\n\n对于立方晶格，Wigner-Seitz 原胞是立方体 $[-L/2, L/2]^3$。此原胞内的一个位移矢量 $\\vec{r} = (r_x, r_y, r_z)$ 代表了两个粒子之间的最小镜像约定 (MIC) 分离。如果一个替代的周期性镜像矢量 $\\vec{r}_{\\mathrm{alt}} = \\vec{r} - \\vec{n}L$（其中 $\\vec{n}$ 是一个非零整数矢量）也满足 $|\\vec{r}_{\\mathrm{alt}}| \\le r_c$，则会出现模糊性。\n\n根据 MIC，对于所有 $\\vec{n} \\ne \\vec{0}$，都有 $|\\vec{r}| \\le |\\vec{r} - \\vec{n}L|$。模糊性发生在 Wigner-Seitz 原胞中的矢量 $\\vec{r}$，对于某些 $\\vec{n} \\ne \\vec{0}$，我们有 $|\\vec{r}_{\\mathrm{alt}}| \\le r_c$。$\\vec{n}$ 最可能的候选项是对应于最近相邻单元的矢量，例如 $(\\pm 1, 0, 0)$、$(0, \\pm 1, 0)$ 和 $(0, 0, \\pm 1)$。\n\n让我们考虑 $+x$ 方向上的镜像的条件，即 $\\vec{n} = (1, 0, 0)$。替代矢量为 $\\vec{r}_{\\mathrm{alt}} = (r_x-L, r_y, r_z)$。模糊性的条件是 $|\\vec{r}_{\\mathrm{alt}}|^2 \\le r_c^2$:\n$$ (r_x-L)^2 + r_y^2 + r_z^2 \\le \\left(\\frac{L}{2} + \\Delta\\right)^2 $$\n这个不等式定义了与 $\\vec{n}=(1,0,0)$ 镜像相关的 MIC 矢量 $\\vec{r}$ 的‘模糊区域’。该区域是位于 Wigner-Seitz 原胞 $[-L/2, L/2]^3$ 内，以 $(L, 0, 0)$ 为中心、半径为 $r_c$ 的球体的一部分。\n\n由于 $\\Delta \\ll L$，这个球体仅仅通过其在 $r_x = L/2$ 处的面穿入 Wigner-Seitz 原胞。交集形成一个薄的透镜状区域。在领头阶上，我们可以将其体积按球冠计算。球体半径为 $R=r_c=L/2+\\Delta$，并被平面 $r_x=L/2$ 切割。该球冠的高度为 $h = r_c - L/2 = \\Delta$。\n\n球冠的体积由 $V_{\\text{cap}} = \\frac{\\pi h^2}{3}(3R - h)$ 给出。代入 $h=\\Delta$ 和 $R=L/2+\\Delta$：\n$$ V_{\\text{cap}} = \\frac{\\pi \\Delta^2}{3} \\left(3\\left(\\frac{L}{2} + \\Delta\\right) - \\Delta\\right) = \\frac{\\pi \\Delta^2}{3} \\left(\\frac{3L}{2} + 2\\Delta\\right) = \\frac{\\pi L \\Delta^2}{2} + \\frac{2\\pi \\Delta^3}{3} $$\n在小参数 $\\Delta/L$ 的领头阶上，我们保留 $\\Delta$ 的最低次幂：\n$$ V_{\\text{cap}} \\approx \\frac{\\pi L \\Delta^2}{2} $$\n这个体积对应于立方单元六个面中的一个。问题陈述允许我们忽略边和角效应，这些效应对应于 $\\Delta/L$ 的高阶项。这是合理的，因为面上球冠的圆形底面半径约为 $\\sqrt{r_c^2 - (L/2)^2} = \\sqrt{L\\Delta + \\Delta^2} \\approx \\sqrt{L\\Delta}$。由于 $\\Delta \\ll L$，该半径远小于 $L/2$，因此相邻面上的球冠不会重叠。\n\n总模糊体积 $V_{\\mathrm{amb}}$ 是六个面的体积之和：\n$$ V_{\\mathrm{amb}} = 6 \\times V_{\\text{cap}} \\approx 6 \\times \\frac{\\pi L \\Delta^2}{2} = 3\\pi L \\Delta^2 $$\n模糊矢量的分数 $f_{\\mathrm{amb}}$ 是该体积与 Wigner-Seitz 原胞总体积 $V_{\\mathrm{WS}} = L^3$ 的比率：\n$$ f_{\\mathrm{amb}} = \\frac{V_{\\mathrm{amb}}}{L^3} = \\frac{3\\pi L \\Delta^2}{L^3} = \\frac{3\\pi \\Delta^2}{L^2} $$\n\n**2. 伪位形能量密度 ($\\Delta \\mathcal{E}$)**\n\n单位体积能量的伪增量 $\\Delta \\mathcal{E}$ 是由于为每个模糊对增加了一个额外周期性镜像的势能而产生的。这对应于对模糊体积 $V_{\\mathrm{amb}}$ 的一个额外积分。对于位移 $\\vec{r} \\in V_{\\mathrm{amb}}$，额外的能量是使用到替代镜像的距离 $|\\vec{r}_{\\mathrm{alt}}|$ 计算的。\n$$ \\Delta \\mathcal{E} = \\frac{\\rho^2}{2} \\int_{V_{\\mathrm{amb}}} u(|\\vec{r}_{\\mathrm{alt}}|) g(|\\vec{r}|) d^3r $$\n在薄的模糊区域内， $|\\vec{r}|$ 接近 $L/2$。根据定义， $|\\vec{r}_{\\mathrm{alt}}|$ 也接近 $L/2$ (具体来说，$L/2 \\le |\\vec{r}_{\\mathrm{alt}}| \\le r_c = L/2+\\Delta$）。根据假设，我们可以近似 $g(|\\vec{r}|) \\approx 1$。对于领头阶计算，我们也可以将势项近似为常数：$u(|\\vec{r}_{\\mathrm{alt}}|) \\approx u(L/2)$。任何修正项都会涉及像 $(|\\vec{r}_{\\mathrm{alt}}|-L/2)$ 这样的项，它们是 $\\Delta$ 阶的，在一个 $L\\Delta^2$ 阶的体积上对它们进行积分，将得到一个 $\\Delta^3$ 阶的贡献，这是更高阶的。\n$$ \\Delta \\mathcal{E} \\approx \\frac{\\rho^2}{2} \\int_{V_{\\mathrm{amb}}} u\\left(\\frac{L}{2}\\right) \\cdot 1 \\cdot d^3r = \\frac{\\rho^2}{2} u\\left(\\frac{L}{2}\\right) V_{\\mathrm{amb}} $$\n代入 $V_{\\mathrm{amb}}$ 的表达式：\n$$ \\Delta \\mathcal{E} = \\frac{\\rho^2}{2} u\\left(\\frac{L}{2}\\right) (3\\pi L \\Delta^2) = \\frac{3\\pi}{2} \\rho^2 L \\Delta^2 u\\left(\\frac{L}{2}\\right) $$\n单位是 $(\\text{m}^{-3})^2 \\cdot \\text{m} \\cdot \\text{m}^2 \\cdot \\text{J} = \\text{J} \\cdot \\text{m}^{-3}$，符合要求。\n\n**3. 伪维里压力 ($\\Delta p$)**\n\n类似地，压力的伪偏移 $\\Delta p$ 是来自额外镜像相互作用对维里的贡献。维里项取决于 $\\vec{r} \\cdot \\vec{F}(\\vec{r}) = -r u'(r)$。伪贡献使用替代矢量 $\\vec{r}_{\\mathrm{alt}}$：\n$$ \\Delta p = -\\frac{\\rho^2}{6} \\int_{V_{\\mathrm{amb}}} |\\vec{r}_{\\mathrm{alt}}| u'(|\\vec{r}_{\\mathrm{alt}}|) g(|\\vec{r}|) d^3r $$\n使用与能量相同的领头阶论证，我们用其在 $r=L/2$ 处的值来近似被积函数：\n$$ |\\vec{r}_{\\mathrm{alt}}| u'(|\\vec{r}_{\\mathrm{alt}}|) \\approx \\frac{L}{2} u'\\left(\\frac{L}{2}\\right) \\quad \\text{和} \\quad g(|\\vec{r}|) \\approx 1 $$\n$$ \\Delta p \\approx -\\frac{\\rho^2}{6} \\int_{V_{\\mathrm{amb}}} \\frac{L}{2} u'\\left(\\frac{L}{2}\\right) d^3r = -\\frac{\\rho^2 L}{12} u'\\left(\\frac{L}{2}\\right) V_{\\mathrm{amb}} $$\n代入 $V_{\\mathrm{amb}}$ 的表达式：\n$$ \\Delta p = -\\frac{\\rho^2 L}{12} u'\\left(\\frac{L}{2}\\right) (3\\pi L \\Delta^2) = -\\frac{3\\pi}{12} \\rho^2 L^2 \\Delta^2 u'\\left(\\frac{L}{2}\\right) $$\n$$ \\Delta p = -\\frac{\\pi}{4} \\rho^2 L^2 \\Delta^2 u'\\left(\\frac{L}{2}\\right) $$\n单位是 $(\\text{m}^{-3})^2 \\cdot \\text{m}^2 \\cdot \\text{m}^2 \\cdot (\\text{J}/\\text{m}) = \\text{J} \\cdot \\text{m}^{-3} = \\text{Pa}$，符合要求。\n\n推导出的三个量是：\n- $f_{\\mathrm{amb}} = \\frac{3\\pi \\Delta^2}{L^2}$\n- $\\Delta \\mathcal{E} = \\frac{3\\pi}{2} \\rho^2 L \\Delta^2 u\\left(\\frac{L}{2}\\right)$\n- $\\Delta p = -\\frac{\\pi}{4} \\rho^2 L^2 \\Delta^2 u'\\left(\\frac{L}{2}\\right)$\n\n按要求将它们以单行矩阵的形式呈现。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{3\\pi \\Delta^2}{L^2} & \\frac{3\\pi}{2} \\rho^2 L \\Delta^2 u\\left(\\frac{L}{2}\\right) & -\\frac{\\pi}{4} \\rho^2 L^2 \\Delta^2 u'\\left(\\frac{L}{2}\\right)\n\\end{pmatrix}\n}\n$$"
        }
    ]
}