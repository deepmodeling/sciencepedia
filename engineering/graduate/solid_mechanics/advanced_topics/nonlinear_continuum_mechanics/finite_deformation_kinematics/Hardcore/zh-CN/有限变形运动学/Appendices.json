{
    "hands_on_practices": [
        {
            "introduction": "在小变形理论中，应变张量被直接定义为位移梯度的对称部分。然而，对于大变形和转动，这种近似不再成立。本练习提供了一个鲜明的反例——大刚体转动——来揭示即使材料未发生任何实际应变，位移梯度也可能很大 。通过计算真实的应变张量（为零）和位移梯度的范数（不为零），您将深刻理解为何在有限运动学中必须采用客观的、与参考标架无关的应变度量。",
            "id": "2639548",
            "problem": "一个三维弹性体绕固定的 $z$ 轴进行均匀刚体转动，转动角度为 $\\theta = \\frac{2\\pi}{3}$ (弧度)。该运动相对于参考构型由 $\\boldsymbol{x} = \\boldsymbol{R} \\boldsymbol{X}$ 定义，其中\n$$\n\\boldsymbol{R} =\n\\begin{pmatrix}\n\\cos\\theta  -\\sin\\theta  0 \\\\\n\\sin\\theta  \\phantom{-}\\cos\\theta  0 \\\\\n0  0  1\n\\end{pmatrix}.\n$$\n仅从变形梯度 $\\boldsymbol{F}$、右柯西-格林张量 $\\boldsymbol{C}$、格林-拉格朗日应变张量 $\\boldsymbol{E}$、左柯西-格林张量 $\\boldsymbol{b}$ 和欧拉-阿尔曼西应变张量 $\\boldsymbol{e}$ 的基本定义出发，完成以下任务：\n\n- 推导此运动的变形梯度 $\\boldsymbol{F}$，并用它来证明 $\\boldsymbol{E}$ 和 $\\boldsymbol{e}$ 在物体内处处为零。\n- 定义位移场 $\\boldsymbol{u} = \\boldsymbol{x} - \\boldsymbol{X}$，并计算物质位移梯度 $\\nabla_{\\! \\boldsymbol{X}} \\boldsymbol{u}$。\n- 计算物质位移梯度的弗罗贝尼乌斯范数 $\\|\\nabla_{\\! \\boldsymbol{X}} \\boldsymbol{u}\\|_{F}$，其中对于任意二阶张量 $\\boldsymbol{A}$，$\\| \\boldsymbol{A} \\|_{F} = \\sqrt{\\operatorname{tr}(\\boldsymbol{A}^{\\mathsf{T}} \\boldsymbol{A})}$。\n\n这个构造作为一个反例，表明大的刚体转动可以产生大的位移梯度，而所有应变张量都为零。将 $\\theta = \\frac{2\\pi}{3}$ 时 $\\|\\nabla_{\\! \\boldsymbol{X}} \\boldsymbol{u}\\|_{F}$ 的精确值作为你的最终答案。不需要单位。以精确形式表示答案，不要进行近似或四舍五入。",
            "solution": "在尝试解答之前，对问题陈述进行验证。\n\n首先，提取已知条件。\n- 运动: $\\boldsymbol{x} = \\boldsymbol{R} \\boldsymbol{X}$\n- 旋转矩阵:\n$$\n\\boldsymbol{R} =\n\\begin{pmatrix}\n\\cos\\theta  -\\sin\\theta  0 \\\\\n\\sin\\theta  \\phantom{-}\\cos\\theta  0 \\\\\n0  0  1\n\\end{pmatrix}\n$$\n- 转动角度: $\\theta = \\frac{2\\pi}{3}$\n- 基本定义: 变形梯度 $\\boldsymbol{F}$、右柯西-格林张量 $\\boldsymbol{C}$、格林-拉格朗日应变张量 $\\boldsymbol{E}$、左柯西-格林张量 $\\boldsymbol{b}$、欧拉-阿尔曼西应变张量 $\\boldsymbol{e}$。\n- 位移场: $\\boldsymbol{u} = \\boldsymbol{x} - \\boldsymbol{X}$\n- 物质位移梯度: $\\nabla_{\\! \\boldsymbol{X}} \\boldsymbol{u}$\n- 弗罗贝尼乌斯范数: $\\| \\boldsymbol{A} \\|_{F} = \\sqrt{\\operatorname{tr}(\\boldsymbol{A}^{\\mathsf{T}} \\boldsymbol{A})}$\n\n验证开始。该问题是连续介质力学中的一个标准练习，具体涉及有限变形运动学主题。它具有科学依据，是适定的、客观的且内部一致的。它包含了获得唯一解所需的所有信息。该问题旨在说明位移梯度（在刚性旋转中可以很大）与应变（在此类运动中为零）之间的重要区别。因此，问题陈述是有效的。我们开始求解。\n\n物体的运动由映射 $\\boldsymbol{x} = \\boldsymbol{x}(\\boldsymbol{X}) = \\boldsymbol{R}\\boldsymbol{X}$ 给出，其中 $\\boldsymbol{X}$ 是粒子在参考构型中的位置矢量，$\\boldsymbol{x}$ 是其在当前构型中的位置。对于这种均匀变形，矩阵 $\\boldsymbol{R}$ 是一个常数。\n\n步骤 1：推导变形梯度 $\\boldsymbol{F}$ 以及应变张量 $\\boldsymbol{E}$ 和 $\\boldsymbol{e}$。\n变形梯度张量 $\\boldsymbol{F}$ 定义为运动的物质梯度：\n$$\n\\boldsymbol{F} = \\frac{\\partial \\boldsymbol{x}}{\\partial \\boldsymbol{X}} = \\nabla_{\\! \\boldsymbol{X}} (\\boldsymbol{R}\\boldsymbol{X})\n$$\n由于 $\\boldsymbol{R}$ 是相对于物质坐标 $\\boldsymbol{X}$ 的常数矩阵，其导数就是：\n$$\n\\boldsymbol{F} = \\boldsymbol{R}\n$$\n右柯西-格林张量 $\\boldsymbol{C}$ 定义为 $\\boldsymbol{C} = \\boldsymbol{F}^{\\mathsf{T}}\\boldsymbol{F}$。代入 $\\boldsymbol{F} = \\boldsymbol{R}$：\n$$\n\\boldsymbol{C} = \\boldsymbol{R}^{\\mathsf{T}}\\boldsymbol{R}\n$$\n矩阵 $\\boldsymbol{R}$ 代表一个旋转，它是一种正交变换。任何正交张量的一个性质是其转置为其逆，因此 $\\boldsymbol{R}^{\\mathsf{T}}\\boldsymbol{R} = \\boldsymbol{I}$，其中 $\\boldsymbol{I}$ 是二阶单位张量。因此：\n$$\n\\boldsymbol{C} = \\boldsymbol{I}\n$$\n格林-拉格朗日应变张量 $\\boldsymbol{E}$ 定义为 $\\boldsymbol{E} = \\frac{1}{2}(\\boldsymbol{C} - \\boldsymbol{I})$。使用我们得到的 $\\boldsymbol{C}$ 的结果：\n$$\n\\boldsymbol{E} = \\frac{1}{2}(\\boldsymbol{I} - \\boldsymbol{I}) = \\boldsymbol{O}\n$$\n其中 $\\boldsymbol{O}$ 是零张量。\n\n接下来，我们考虑空间应变张量。左柯西-格林张量 $\\boldsymbol{b}$ 定义为 $\\boldsymbol{b} = \\boldsymbol{F}\\boldsymbol{F}^{\\mathsf{T}}$。代入 $\\boldsymbol{F} = \\boldsymbol{R}$：\n$$\n\\boldsymbol{b} = \\boldsymbol{R}\\boldsymbol{R}^{\\mathsf{T}}\n$$\n同样，根据 $\\boldsymbol{R}$ 的正交性，我们有 $\\boldsymbol{R}\\boldsymbol{R}^{\\mathsf{T}} = \\boldsymbol{I}$。因此：\n$$\n\\boldsymbol{b} = \\boldsymbol{I}\n$$\n欧拉-阿尔曼西应变张量 $\\boldsymbol{e}$ 定义为 $\\boldsymbol{e} = \\frac{1}{2}(\\boldsymbol{I} - \\boldsymbol{b}^{-1})$。由于 $\\boldsymbol{b} = \\boldsymbol{I}$，其逆也是单位张量，即 $\\boldsymbol{b}^{-1} = \\boldsymbol{I}^{-1} = \\boldsymbol{I}$。将此代入 $\\boldsymbol{e}$ 的定义中：\n$$\n\\boldsymbol{e} = \\frac{1}{2}(\\boldsymbol{I} - \\boldsymbol{I}) = \\boldsymbol{O}\n$$\n格林-拉格朗日应变张量和欧拉-阿尔曼西应变张量均为零，这是刚体运动的正确且预期的结果，因为它不引起任何变形或拉伸。\n\n步骤 2：计算物质位移梯度 $\\nabla_{\\! \\boldsymbol{X}} \\boldsymbol{u}$。\n位移矢量场 $\\boldsymbol{u}$ 定义为 $\\boldsymbol{u} = \\boldsymbol{x} - \\boldsymbol{X}$。代入给定的运动 $\\boldsymbol{x} = \\boldsymbol{R}\\boldsymbol{X}$：\n$$\n\\boldsymbol{u} = \\boldsymbol{R}\\boldsymbol{X} - \\boldsymbol{X} = (\\boldsymbol{R} - \\boldsymbol{I})\\boldsymbol{X}\n$$\n物质位移梯度是张量 $\\boldsymbol{H} = \\nabla_{\\! \\boldsymbol{X}} \\boldsymbol{u} = \\frac{\\partial \\boldsymbol{u}}{\\partial \\boldsymbol{X}}$。\n$$\n\\boldsymbol{H} = \\nabla_{\\! \\boldsymbol{X}} [(\\boldsymbol{R} - \\boldsymbol{I})\\boldsymbol{X}]\n$$\n由于对于均匀运动，张量 $(\\boldsymbol{R} - \\boldsymbol{I})$ 是常数：\n$$\n\\boldsymbol{H} = \\nabla_{\\! \\boldsymbol{X}} \\boldsymbol{u} = \\boldsymbol{R} - \\boldsymbol{I}\n$$\n这表明即使应变为零，位移梯度也不为零。\n\n步骤 3：计算物质位移梯度的弗罗贝尼乌斯范数 $\\|\\nabla_{\\! \\boldsymbol{X}} \\boldsymbol{u}\\|_{F}$。\n弗罗贝尼乌斯范数定义为 $\\|\\boldsymbol{H}\\|_{F} = \\sqrt{\\operatorname{tr}(\\boldsymbol{H}^{\\mathsf{T}}\\boldsymbol{H})}$。我们首先计算乘积 $\\boldsymbol{H}^{\\mathsf{T}}\\boldsymbol{H}$：\n$$\n\\boldsymbol{H}^{\\mathsf{T}}\\boldsymbol{H} = (\\boldsymbol{R} - \\boldsymbol{I})^{\\mathsf{T}}(\\boldsymbol{R} - \\boldsymbol{I}) = (\\boldsymbol{R}^{\\mathsf{T}} - \\boldsymbol{I})(\\boldsymbol{R} - \\boldsymbol{I})\n$$\n展开乘积得到：\n$$\n\\boldsymbol{H}^{\\mathsf{T}}\\boldsymbol{H} = \\boldsymbol{R}^{\\mathsf{T}}\\boldsymbol{R} - \\boldsymbol{R}^{\\mathsf{T}} - \\boldsymbol{R} + \\boldsymbol{I}\n$$\n使用正交性质 $\\boldsymbol{R}^{\\mathsf{T}}\\boldsymbol{R} = \\boldsymbol{I}$：\n$$\n\\boldsymbol{H}^{\\mathsf{T}}\\boldsymbol{H} = \\boldsymbol{I} - \\boldsymbol{R}^{\\mathsf{T}} - \\boldsymbol{R} + \\boldsymbol{I} = 2\\boldsymbol{I} - (\\boldsymbol{R} + \\boldsymbol{R}^{\\mathsf{T}})\n$$\n现在我们对这个表达式取迹。迹是一个线性算子：\n$$\n\\operatorname{tr}(\\boldsymbol{H}^{\\mathsf{T}}\\boldsymbol{H}) = \\operatorname{tr}(2\\boldsymbol{I}) - \\operatorname{tr}(\\boldsymbol{R} + \\boldsymbol{R}^{\\mathsf{T}}) = 2\\operatorname{tr}(\\boldsymbol{I}) - \\operatorname{tr}(\\boldsymbol{R}) - \\operatorname{tr}(\\boldsymbol{R}^{\\mathsf{T}})\n$$\n在三维空间中，$\\operatorname{tr}(\\boldsymbol{I}) = 3$。并且，$\\operatorname{tr}(\\boldsymbol{R}) = \\operatorname{tr}(\\boldsymbol{R}^{\\mathsf{T}})$。所以：\n$$\n\\operatorname{tr}(\\boldsymbol{H}^{\\mathsf{T}}\\boldsymbol{H}) = 2(3) - 2\\operatorname{tr}(\\boldsymbol{R}) = 6 - 2\\operatorname{tr}(\\boldsymbol{R})\n$$\n给定旋转矩阵 $\\boldsymbol{R}$ 的迹是：\n$$\n\\operatorname{tr}(\\boldsymbol{R}) = \\cos\\theta + \\cos\\theta + 1 = 2\\cos\\theta + 1\n$$\n将此代入 $\\boldsymbol{H}^{\\mathsf{T}}\\boldsymbol{H}$ 的迹的表达式中：\n$$\n\\operatorname{tr}(\\boldsymbol{H}^{\\mathsf{T}}\\boldsymbol{H}) = 6 - 2(2\\cos\\theta + 1) = 6 - 4\\cos\\theta - 2 = 4 - 4\\cos\\theta\n$$\n弗罗贝尼乌斯范数是其平方根：\n$$\n\\|\\nabla_{\\! \\boldsymbol{X}} \\boldsymbol{u}\\|_{F} = \\sqrt{4 - 4\\cos\\theta} = 2\\sqrt{1 - \\cos\\theta}\n$$\n问题指定旋转角度为 $\\theta = \\frac{2\\pi}{3}$。我们必须计算该值下的表达式。该角度的余弦值为：\n$$\n\\cos\\left(\\frac{2\\pi}{3}\\right) = -\\frac{1}{2}\n$$\n代入此值：\n$$\n\\|\\nabla_{\\! \\boldsymbol{X}} \\boldsymbol{u}\\|_{F} = 2\\sqrt{1 - \\left(-\\frac{1}{2}\\right)} = 2\\sqrt{1 + \\frac{1}{2}} = 2\\sqrt{\\frac{3}{2}}\n$$\n为了简化表达式：\n$$\n2\\sqrt{\\frac{3}{2}} = 2 \\frac{\\sqrt{3}}{\\sqrt{2}} = \\frac{2\\sqrt{3}\\sqrt{2}}{2} = \\sqrt{6}\n$$\n物质位移梯度的弗罗贝尼乌斯范数的精确值为 $\\sqrt{6}$。这个范数大于1的大数值，与零应变相结合，正确地说明了当用为无穷小变形而发展的度量来分析时，有限旋转运动学的反直觉性质。",
            "answer": "$$\\boxed{\\sqrt{6}}$$"
        },
        {
            "introduction": "极分解定理是连续介质力学的基石，它指出任何变形都可以唯一地分解为一个纯拉伸和一个刚体转动的乘积。本练习将此基本定理应用于简单剪切这一典型变形模式，一个直观上似乎不包含转动的变形。通过亲手计算拉伸张量 $\\mathbf{U}$ 和转动张量 $\\mathbf{R}$，您将揭示出伴随有限剪切发生的“内蕴”转动，并体会变形与方向之间深刻的非线性耦合关系。",
            "id": "2639541",
            "problem": "一个均匀体经历平面单剪切，其变形梯度在标准正交基 $\\{\\mathbf{e}_{1},\\mathbf{e}_{2},\\mathbf{e}_{3}\\}$ 下表示为\n$$\n\\mathbf{F} \\;=\\; \\mathbf{I} \\;+\\; \\gamma\\,\\mathbf{e}_{1}\\otimes\\mathbf{e}_{2},\n$$\n其中 $\\gamma \\in \\mathbb{R}$ 是剪切量。完全在有限变形运动学框架内进行计算。仅从核心定义出发，推导右极分解 $\\mathbf{F}=\\mathbf{R}\\,\\mathbf{U}$，其中 $\\mathbf{R}$ 是正交的，满足 $\\mathbf{R}^{T}\\mathbf{R}=\\mathbf{I}$ 和 $\\det\\mathbf{R}=+1$，而 $\\mathbf{U}$ 是对称正定 (SPD) 的。具体要求如下：\n\n1. 使用右柯西-格林张量 $\\mathbf{C}=\\mathbf{F}^{T}\\mathbf{F}$ 的定义和右拉伸张量作为主平方根 $\\mathbf{U}=\\mathbf{C}^{1/2}$ 的定义，在给定基下显式计算 $\\mathbf{U}$ 的 $3\\times 3$ 矩阵。\n\n2. 显式计算正交因子 $\\mathbf{R}=\\mathbf{F}\\,\\mathbf{U}^{-1}$，并确定其在 $\\mathbf{e}_{1}$–$\\mathbf{e}_{2}$ 平面内绕 $\\mathbf{e}_{3}$ 轴旋转某个角度 $\\theta(\\gamma)$ 的作用。\n\n3. 计算 $\\mathbf{F}$ 的对称-反对称分解，即 $\\tfrac{1}{2}(\\mathbf{F}+\\mathbf{F}^{T})$ 和 $\\tfrac{1}{2}(\\mathbf{F}-\\mathbf{F}^{T})$，并将此线性分解与您得到的非线性极分解因子进行比较。解释它们在小 $\\gamma$ 值下的一致性以及在有限 $\\gamma$ 值下的差异。\n\n作为最终答案，报告旋转角 $\\theta(\\gamma)$ 的精确表达式，单位为弧度，选择连续函数使得 $\\theta(0)=0$ 且当 $\\gamma>0$ 时 $\\theta(\\gamma)>0$。不要在最终答案框中包含单位；角度应解释为弧度。",
            "solution": "在尝试解答之前，对问题进行验证。\n\n## 问题验证\n\n### 步骤 1：提取已知条件\n- 一个均匀体经历平面单剪切的变形梯度在标准正交基 $\\{\\mathbf{e}_{1},\\mathbf{e}_{2},\\mathbf{e}_{3}\\}$ 下给出为：\n$$\n\\mathbf{F} = \\mathbf{I} + \\gamma\\,\\mathbf{e}_{1}\\otimes\\mathbf{e}_{2}\n$$\n- 剪切量为 $\\gamma \\in \\mathbb{R}$。\n- 框架为有限变形运动学。\n- 目标是求右极分解 $\\mathbf{F}=\\mathbf{R}\\,\\mathbf{U}$，其中 $\\mathbf{R}$ 是一个真正交张量（$\\mathbf{R}^{T}\\mathbf{R}=\\mathbf{I}$，$\\det\\mathbf{R}=+1$），而 $\\mathbf{U}$ 是一个对称正定（SPD）张量。\n- 任务 1：根据定义 $\\mathbf{U} = \\mathbf{C}^{1/2}$ 计算右拉伸张量 $\\mathbf{U}$，其中 $\\mathbf{C} = \\mathbf{F}^{T}\\mathbf{F}$ 是右柯西-格林张量。\n- 任务 2：由 $\\mathbf{R}=\\mathbf{F}\\,\\mathbf{U}^{-1}$ 计算旋转张量 $\\mathbf{R}$，并确定其作用为旋转一个角度 $\\theta(\\gamma)$。\n- 任务 3：计算 $\\mathbf{F}$ 的对称-反对称分解，即 $\\tfrac{1}{2}(\\mathbf{F}+\\mathbf{F}^{T})$ 和 $\\tfrac{1}{2}(\\mathbf{F}-\\mathbf{F}^{T})$，并将其与极分解因子 $\\mathbf{R}$ 和 $\\mathbf{U}$ 进行比较。\n- 最终答案应为角度 $\\theta(\\gamma)$ 的表达式，并满足指定条件 $\\theta(0)=0$ 且当 $\\gamma>0$ 时 $\\theta(\\gamma)>0$。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学依据**：该问题是连续介质力学中的一个基本练习，特别是在有限变形运动学领域。所有概念，如变形梯度、极分解和柯西-格林张量，都是公认的。\n2.  **适定性**：该问题是适定的。对于任何可逆的变形梯度，右极分解的存在性和唯一性是有保证的。此处，$\\det(\\mathbf{F})=1$，因此 $\\mathbf{F}$ 是可逆的。问题提供了所有必要的信息和明确的目标。关于角度 $\\theta(\\gamma)$ 符号的条件被解释为报告答案的约定，这解决了任何潜在的歧义。\n3.  **客观性**：该问题以精确、客观的数学语言陈述。\n\n### 步骤 3：结论与行动\n该问题被判定为**有效**。将提供完整解答。\n\n## 解答\n\n变形梯度 $\\mathbf{F}$ 在基 $\\{\\mathbf{e}_{1},\\mathbf{e}_{2},\\mathbf{e}_{3}\\}$ 下的矩阵表示为\n$$\n[F] = \\begin{pmatrix} 1  \\gamma  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n\n### 第 1 部分：右拉伸张量 U 的计算\n\n右柯西-格林张量 $\\mathbf{C}$ 定义为 $\\mathbf{C} = \\mathbf{F}^{T}\\mathbf{F}$。其矩阵表示为\n$$\n[C] = [F]^{T}[F] = \\begin{pmatrix} 1  0  0 \\\\ \\gamma  1  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} 1  \\gamma  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 1  \\gamma  0 \\\\ \\gamma  1+\\gamma^{2}  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n右拉伸张量 $\\mathbf{U}$ 是 $\\mathbf{C}$ 唯一的对称正定平方根，即 $\\mathbf{U}=\\mathbf{C}^{1/2}$。由于 $\\mathbf{C}$ 是块对角矩阵，$\\mathbf{U}$ 将具有相同的结构。右下角的 $1 \\times 1$ 块是 $1$，所以其平方根是 $1$。我们需要求左上角 $2 \\times 2$ 块的平方根，我们将其记为 $C_{2D}$：\n$$\nC_{2D} = \\begin{pmatrix} 1  \\gamma \\\\ \\gamma  1+\\gamma^{2} \\end{pmatrix}\n$$\n对于一个 $2 \\times 2$ 对称正定矩阵 $M$，其平方根由以下公式给出\n$$\n\\sqrt{M} = \\frac{1}{\\sqrt{\\text{tr}(M) + 2\\sqrt{\\det(M)}}} \\left( M + \\sqrt{\\det(M)} I \\right)\n$$\n对于 $C_{2D}$，我们有 $\\text{tr}(C_{2D}) = 1 + (1+\\gamma^{2}) = 2+\\gamma^{2}$ 和 $\\det(C_{2D}) = 1(1+\\gamma^{2}) - \\gamma^{2} = 1$。\n将这些代入公式，我们得到 $\\mathbf{U}$ 的 $2 \\times 2$ 部分的矩阵，记为 $U_{2D}$：\n$$\nU_{2D} = \\frac{1}{\\sqrt{(2+\\gamma^{2}) + 2\\sqrt{1}}} \\left( \\begin{pmatrix} 1  \\gamma \\\\ \\gamma  1+\\gamma^{2} \\end{pmatrix} + \\sqrt{1} \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} \\right) = \\frac{1}{\\sqrt{4+\\gamma^{2}}} \\begin{pmatrix} 2  \\gamma \\\\ \\gamma  2+\\gamma^{2} \\end{pmatrix}\n$$\n因此，$\\mathbf{U}$ 的完整矩阵是\n$$\n[U] = \\begin{pmatrix} \\frac{2}{\\sqrt{4+\\gamma^{2}}}  \\frac{\\gamma}{\\sqrt{4+\\gamma^{2}}}  0 \\\\ \\frac{\\gamma}{\\sqrt{4+\\gamma^{2}}}  \\frac{2+\\gamma^{2}}{\\sqrt{4+\\gamma^{2}}}  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n\n### 第 2 部分：旋转张量 R 和角度 $\\theta(\\gamma)$ 的计算\n\n旋转张量 $\\mathbf{R}$ 计算为 $\\mathbf{R} = \\mathbf{F}\\mathbf{U}^{-1}$。首先，我们求 $\\mathbf{U}$ 的逆。由于 $\\det(\\mathbf{U}) = \\sqrt{\\det(\\mathbf{C})} = \\sqrt{1} = 1$，我们可以通过求 $2 \\times 2$ 块 $U_{2D}$ 的逆来得到 $[U]^{-1}$。\n$\\det(U_{2D}) = (\\frac{1}{\\sqrt{4+\\gamma^{2}}})^{2} [2(2+\\gamma^{2}) - \\gamma^{2}] = \\frac{1}{4+\\gamma^{2}}(4+\\gamma^{2}) = 1$。\n$$\n[U_{2D}]^{-1} = \\frac{1}{\\det(U_{2D})} \\frac{1}{\\sqrt{4+\\gamma^{2}}} \\begin{pmatrix} 2+\\gamma^{2}  -\\gamma \\\\ -\\gamma  2 \\end{pmatrix} = \\frac{1}{\\sqrt{4+\\gamma^{2}}} \\begin{pmatrix} 2+\\gamma^{2}  -\\gamma \\\\ -\\gamma  2 \\end{pmatrix}\n$$\n$\\mathbf{U}^{-1}$ 的完整矩阵是\n$$\n[U^{-1}] = \\begin{pmatrix} \\frac{2+\\gamma^{2}}{\\sqrt{4+\\gamma^{2}}}  -\\frac{\\gamma}{\\sqrt{4+\\gamma^{2}}}  0 \\\\ -\\frac{\\gamma}{\\sqrt{4+\\gamma^{2}}}  \\frac{2}{\\sqrt{4+\\gamma^{2}}}  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n现在，我们计算 $[R] = [F][U^{-1}]$：\n$$\n[R] = \\begin{pmatrix} 1  \\gamma  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} \\frac{1}{\\sqrt{4+\\gamma^{2}}} \\begin{pmatrix} 2+\\gamma^{2}  -\\gamma  0 \\\\ -\\gamma  2  0 \\\\ 0  0  \\sqrt{4+\\gamma^{2}} \\end{pmatrix}\n$$\n$$\n[R] = \\frac{1}{\\sqrt{4+\\gamma^{2}}} \\begin{pmatrix} 1(2+\\gamma^{2}) + \\gamma(-\\gamma)  1(-\\gamma) + \\gamma(2)  0 \\\\ 0(2+\\gamma^{2}) + 1(-\\gamma)  0(-\\gamma) + 1(2)  0 \\\\ 0  0  \\sqrt{4+\\gamma^{2}} \\end{pmatrix}\n$$\n$$\n[R] = \\frac{1}{\\sqrt{4+\\gamma^{2}}} \\begin{pmatrix} 2  \\gamma  0 \\\\ -\\gamma  2  0 \\\\ 0  0  \\sqrt{4+\\gamma^{2}} \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{\\sqrt{4+\\gamma^{2}}}  \\frac{\\gamma}{\\sqrt{4+\\gamma^{2}}}  0 \\\\ -\\frac{\\gamma}{\\sqrt{4+\\gamma^{2}}}  \\frac{2}{\\sqrt{4+\\gamma^{2}}}  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n该矩阵对应于绕 $\\mathbf{e}_{3}$ 轴的旋转。角度为 $\\theta$ 的逆时针 (CCW) 旋转的标准矩阵是 $\\begin{pmatrix} \\cos\\theta  -\\sin\\theta \\\\ \\sin\\theta  \\cos\\theta \\end{pmatrix}$。计算出的矩阵 $[R]$ 具有 $\\begin{pmatrix} C  S \\\\ -S  C \\end{pmatrix}$ 的形式，这代表一个顺时针旋转。\n将 $[R]$ 与标准逆时针旋转矩阵比较，可得：\n$$\n\\cos\\theta = \\frac{2}{\\sqrt{4+\\gamma^{2}}}, \\quad -\\sin\\theta = \\frac{\\gamma}{\\sqrt{4+\\gamma^{2}}} \\implies \\sin\\theta = -\\frac{\\gamma}{\\sqrt{4+\\gamma^{2}}}\n$$\n这意味着 $\\tan\\theta = \\frac{\\sin\\theta}{\\cos\\theta} = -\\frac{\\gamma}{2}$，因此标准逆时针角度为 $\\theta_{std} = \\arctan(-\\gamma/2) = -\\arctan(\\gamma/2)$。然而，问题指定所选角度 $\\theta(\\gamma)$ 必须满足当 $\\gamma>0$ 时 $\\theta(\\gamma)>0$。这是关于如何报告角度的指令。对于 $\\gamma>0$，计算出的旋转是顺时针方向，大小为 $\\arctan(\\gamma/2)$。因此，我们将所需的角度 $\\theta(\\gamma)$ 定义为这个正的大小。\n$$\n\\theta(\\gamma) = \\arctan\\left(\\frac{\\gamma}{2}\\right)\n$$\n这个选择满足 $\\theta(0)=0$ 并在 $\\gamma>0$ 时为正。\n\n### 第 3 部分：与对称-反对称分解的比较\n\n$\\mathbf{F}$ 的加法分解为 $\\mathbf{F} = \\mathbf{E}_{symm} + \\mathbf{W}_{skew}$，其中 $\\mathbf{E}_{symm} = \\frac{1}{2}(\\mathbf{F}+\\mathbf{F}^{T})$ 和 $\\mathbf{W}_{skew} = \\frac{1}{2}(\\mathbf{F}-\\mathbf{F}^{T})$。\n$$\n[E_{symm}] = \\frac{1}{2}\\left(\\begin{pmatrix} 1  \\gamma  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} + \\begin{pmatrix} 1  0  0 \\\\ \\gamma  1  0 \\\\ 0  0  1 \\end{pmatrix}\\right) = \\begin{pmatrix} 1  \\gamma/2  0 \\\\ \\gamma/2  1  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n$$\n[W_{skew}] = \\frac{1}{2}\\left(\\begin{pmatrix} 1  \\gamma  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} - \\begin{pmatrix} 1  0  0 \\\\ \\gamma  1  0 \\\\ 0  0  1 \\end{pmatrix}\\right) = \\begin{pmatrix} 0  \\gamma/2  0 \\\\ -\\gamma/2  0  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\n在小变形理论中，当 $\\mathbf{F} = \\mathbf{I} + \\nabla\\mathbf{u}$ 且 $\\|\\nabla\\mathbf{u}\\| \\ll 1$ 时，拉伸张量 $\\mathbf{U}$ 近似为 $\\mathbf{I}+\\boldsymbol{\\epsilon}$，旋转张量 $\\mathbf{R}$ 近似为 $\\mathbf{I}+\\boldsymbol{\\omega}$，其中 $\\boldsymbol{\\epsilon} = \\text{symm}(\\nabla\\mathbf{u})$ 是无穷小应变张量，$\\boldsymbol{\\omega} = \\text{skew}(\\nabla\\mathbf{u})$ 是无穷小旋转张量。\n对于本问题，$\\nabla\\mathbf{u} = \\mathbf{F}-\\mathbf{I} = \\gamma\\,\\mathbf{e}_{1}\\otimes\\mathbf{e}_{2}$。\n那么 $\\boldsymbol{\\epsilon} = \\frac{\\gamma}{2}(\\mathbf{e}_{1}\\otimes\\mathbf{e}_{2} + \\mathbf{e}_{2}\\otimes\\mathbf{e}_{1})$，因此 $\\mathbf{I}+\\boldsymbol{\\epsilon}$ 的矩阵为 $[E_{symm}]$。\n并且 $\\boldsymbol{\\omega} = \\frac{\\gamma}{2}(\\mathbf{e}_{1}\\otimes\\mathbf{e}_{2} - \\mathbf{e}_{2}\\otimes\\mathbf{e}_{1})$，其矩阵为 $[W_{skew}]$。\n\n让我们对小 $\\gamma$ 展开 $\\mathbf{U}$ 和 $\\mathbf{R}$：\n对小 $x$ 使用泰勒展开 $(1+x)^{-1/2} \\approx 1 - x/2$：\n$$\n\\frac{1}{\\sqrt{4+\\gamma^{2}}} = \\frac{1}{2}(1+\\gamma^{2}/4)^{-1/2} \\approx \\frac{1}{2}(1-\\gamma^{2}/8)\n$$\n$$\n[U]_{11} = \\frac{2}{\\sqrt{4+\\gamma^{2}}} \\approx 2 \\cdot \\frac{1}{2}(1-\\gamma^{2}/8) = 1-\\frac{\\gamma^{2}}{8} \\approx 1\n$$\n$$\n[U]_{12} = \\frac{\\gamma}{\\sqrt{4+\\gamma^{2}}} \\approx \\gamma \\cdot \\frac{1}{2}(1-\\gamma^{2}/8) \\approx \\frac{\\gamma}{2}\n$$\n$$\n[U]_{22} = \\frac{2+\\gamma^{2}}{\\sqrt{4+\\gamma^{2}}} \\approx (2+\\gamma^{2}) \\cdot \\frac{1}{2}(1-\\gamma^{2}/8) = (1+\\frac{\\gamma^{2}}{2})(1-\\frac{\\gamma^{2}}{8}) \\approx 1+\\frac{3\\gamma^{2}}{8} \\approx 1\n$$\n对于 $\\gamma$ 的一阶近似，$[U] \\approx \\begin{pmatrix} 1  \\gamma/2  0 \\\\ \\gamma/2  1  0 \\\\ 0  0  1 \\end{pmatrix} = [E_{symm}]$。这表明对于小剪切，右拉伸张量 $\\mathbf{U}$ 对应于 $\\mathbf{F}$ 的对称部分。对于有限的 $\\gamma$，它们是不同的，其中 $\\mathbf{U}$ 是几何上正确的局部拉伸度量。\n\n对于旋转张量 $\\mathbf{R}$：\n$$\n[R] = \\begin{pmatrix} \\frac{2}{\\sqrt{4+\\gamma^{2}}}  \\frac{\\gamma}{\\sqrt{4+\\gamma^{2}}}  0 \\\\ -\\frac{\\gamma}{\\sqrt{4+\\gamma^{2}}}  \\frac{2}{\\sqrt{4+\\gamma^{2}}}  0 \\\\ 0  0  1 \\end{pmatrix} \\approx \\begin{pmatrix} 1-\\frac{\\gamma^{2}}{8}  \\frac{\\gamma}{2}  0 \\\\ -\\frac{\\gamma}{2}  1-\\frac{\\gamma^{2}}{8}  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n对于 $\\gamma$ 的一阶近似，$[R] \\approx \\begin{pmatrix} 1  \\gamma/2  0 \\\\ -\\gamma/2  1  0 \\\\ 0  0  1 \\end{pmatrix} = [I] + [W_{skew}]$。这表明对于小剪切，旋转张量 $\\mathbf{R}$ 对应于由 $\\mathbf{F}$ 的反对称部分给出的无穷小旋转。对于有限的 $\\gamma$，$\\mathbf{R}$ 是一个有限旋转，一个真正交张量，而 $\\mathbf{I}+\\mathbf{W}_{skew}$ 不是正交的。\n\n总而言之，加法分解 $\\mathbf{F} = \\mathbf{E}_{symm} + \\mathbf{W}_{skew}$ 在小变形极限下为乘法分解 $\\mathbf{F}=\\mathbf{R}\\mathbf{U}$ 提供了一阶近似。极分解是适用于有限变形的几何上和物理上正确的分解。",
            "answer": "$$\\boxed{\\arctan\\left(\\frac{\\gamma}{2}\\right)}$$"
        },
        {
            "introduction": "尽管极分解在概念上十分优雅，但其实际计算依赖于稳健的数值方法。本高级练习深入探讨了极分解与奇异值分解（SVD）之间的联系，后者是计算力学中完成此任务的主力算法。您不仅将推导出一个基于SVD的算法，还将证明其与一个深刻的变分原理相关：即找到与给定变形梯度“最接近”的唯一转动。这将使您对有限元分析中使用的运动学理论获得更深层次的理解。",
            "id": "2886399",
            "problem": "给定一个方阵，代表材料力学中的有限形变梯度。令形变梯度为一个实矩阵 $\\mathbf{F} \\in \\mathbb{R}^{n \\times n}$，且 $\\det(\\mathbf{F}) > 0$。右极分解旨在寻求一个真旋转矩阵 $\\mathbf{R} \\in \\mathrm{SO}(n)$ 和一个对称正定拉伸矩阵 $\\mathbf{U} \\in \\mathbb{R}^{n \\times n}$，使得 $\\mathbf{F} = \\mathbf{R}\\mathbf{U}$。本问题中所有角度都必须以弧度为单位。\n\n你的任务如下：\n\n1) 仅从奇异值分解、正交矩阵、弗罗贝尼乌斯范数和对称正定矩阵的基本定义出发，推导出一个使用奇异值分解计算 $\\mathbf{F}$ 的右极分解的算法。该算法必须对任何满足 $\\det(\\mathbf{F}) > 0$ 的 $\\mathbf{F}$ 都有效，并且必须返回一个真旋转矩阵 $\\mathbf{R} \\in \\mathrm{SO}(n)$ 和一个对称正定矩阵 $\\mathbf{U}$。\n\n2) 证明你的算法所产生的旋转矩阵 $\\mathbf{R}$ 是问题\n$$\n\\min_{\\mathbf{Q} \\in \\mathrm{SO}(n)} \\|\\mathbf{F} - \\mathbf{Q}\\|_F,\n$$\n的唯一极小化子，并且相关的 $\\mathbf{U} = \\mathbf{R}^\\top \\mathbf{F}$ 是对称正定的。你的证明必须基于基本原理，从弗罗贝尼乌斯范数的酉不变性和标准谱不等式出发，不得预先假设目标结果。\n\n3) 实现一个程序，该程序能够：\n- 计算每个给定测试矩阵 $\\mathbf{F}$ 的奇异值分解。\n- 使用你推导的算法为每种情况计算 $\\mathbf{R}$ 和 $\\mathbf{U}$。\n- 对每个测试用例，计算一个实值诊断量，用以定量验证你的推导和证明所蕴含的核心属性之一。\n\n使用以下形变梯度测试套件：\n- 情况1（二维对角拉伸）：$\\mathbf{F}_1 = \\begin{bmatrix} 2.0  0.0 \\\\ 0.0  0.5 \\end{bmatrix}$。输出 $\\|\\mathbf{F}_1 - \\mathbf{R}_1\\|_F$ 与值 $\\sqrt{\\sum_{i=1}^2 (\\sigma_i - 1)^2}$ 之间的绝对差，其中 $\\sigma_i$ 是 $\\mathbf{F}_1$ 的奇异值。\n- 情况2（二维旋转拉伸）：令 $\\theta = 0.4$ (弧度)，$\\mathbf{R}_{\\mathrm{true}} = \\begin{bmatrix} \\cos\\theta  -\\sin\\theta \\\\ \\sin\\theta  \\cos\\theta \\end{bmatrix}$，以及 $\\mathbf{U}_{\\mathrm{true}} = \\operatorname{diag}(1.2, 0.8)$。定义 $\\mathbf{F}_2 = \\mathbf{R}_{\\mathrm{true}} \\mathbf{U}_{\\mathrm{true}}$。输出 $\\|\\mathbf{R}_2 - \\mathbf{R}_{\\mathrm{true}}\\|_F$。\n- 情况3（具有非平凡特征基的三维一般对称拉伸）：令 $\\phi = 0.6$ (弧度)，$\\mathbf{Q} = \\begin{bmatrix} \\cos\\phi  -\\sin\\phi  0 \\\\ \\sin\\phi  \\cos\\phi  0 \\\\ 0  0  1 \\end{bmatrix}$，$\\mathbf{D} = \\operatorname{diag}(1.5, 0.9, 1.1)$，以及 $\\mathbf{U}_{\\mathrm{true}} = \\mathbf{Q}\\mathbf{D}\\mathbf{Q}^\\top$。令 $\\alpha = -0.7$ (弧度) 且 $\\mathbf{R}_{\\mathrm{true}}^{(x)} = \\begin{bmatrix} 1  0  0 \\\\ 0  \\cos\\alpha  -\\sin\\alpha \\\\ 0  \\sin\\alpha  \\cos\\alpha \\end{bmatrix}$。定义 $\\mathbf{F}_3 = \\mathbf{R}_{\\mathrm{true}}^{(x)} \\mathbf{U}_{\\mathrm{true}}$。输出 $\\|\\mathbf{U}_3 - \\mathbf{U}_{\\mathrm{true}}\\|_F$。\n- 情况4（二维病态拉伸）：令 $\\beta = 1.1$ (弧度)，$\\mathbf{R}_{\\beta} = \\begin{bmatrix} \\cos\\beta  -\\sin\\beta \\\\ \\sin\\beta  \\cos\\beta \\end{bmatrix}$，以及 $\\mathbf{U}_{\\mathrm{true}} = \\operatorname{diag}(10^{-6}, 3.0)$。定义 $\\mathbf{F}_4 = \\mathbf{R}_{\\beta} \\mathbf{U}_{\\mathrm{true}}$。输出 $\\|\\mathbf{F}_4 - \\mathbf{R}_4\\|_F$ 与值 $\\sqrt{\\sum_{i=1}^2 (\\sigma_i - 1)^2}$ 之间的绝对差。\n\n所有计算都必须假设角度以弧度为单位。你的程序必须将四个诊断量汇总到单行输出中，其内容是按情况1到4的顺序排列、用逗号分隔并用方括号括起来的结果列表。每个诊断量都必须是一个实数（浮点数）。可以对输出进行四舍五入到固定的小数位数，但所有四个输出必须保持一致。\n\n注意：\n- 上述表达式中的奇异值指的是每种情况下相应 $\\mathbf{F}$ 的奇异值。\n- 确保所使用的所有 $\\mathbf{F}_k$ 都具有严格为正的行列式，以便极分解中存在真旋转。",
            "solution": "所提出的问题是连续介质力学和线性代数中的一个标准练习。该问题提法恰当，有科学依据，并包含了获得完整唯一解所需的所有信息。指定的测试用例与理论框架一致，并且按要求其行列式大于零。因此，该问题被认定是有效的。\n\n按照要求，解答分为三个部分呈现：首先，推导右极分解的算法；其次，证明相关的最小化性质；第三，解释应用于测试用例的实现。\n\n### 1. 右极分解的算法推导\n\n目标是找到一个真旋转矩阵 $\\mathbf{R} \\in \\mathrm{SO}(n)$（即 $\\mathbf{R}^\\top\\mathbf{R}=\\mathbf{I}$ 且 $\\det(\\mathbf{R})=+1$）和一个对称正定拉伸张量 $\\mathbf{U}$，使得对于给定的形变梯度 $\\mathbf{F}$（其中 $\\det(\\mathbf{F}) > 0$），右极分解成立：\n$$ \\mathbf{F} = \\mathbf{R}\\mathbf{U} $$\n我们从 $\\mathbf{F}$ 的奇异值分解（SVD）开始，对于任何实矩阵 $\\mathbf{F} \\in \\mathbb{R}^{n \\times n}$，其定义为：\n$$ \\mathbf{F} = \\mathbf{V} \\mathbf{\\Sigma} \\mathbf{W}^\\top $$\n这里，$\\mathbf{V}$ 和 $\\mathbf{W}$ 是正交矩阵（$\\mathbf{V}^\\top\\mathbf{V} = \\mathbf{I}$，$\\mathbf{W}^\\top\\mathbf{W} = \\mathbf{I}$），$\\mathbf{\\Sigma}$ 是一个对角矩阵，其对角线元素为 $\\mathbf{F}$ 的奇异值 $\\sigma_i \\ge 0$。由于问题规定 $\\det(\\mathbf{F}) > 0$，$\\mathbf{F}$ 是可逆的，这意味着所有奇异值都严格为正，即 $\\sigma_i > 0$。\n\n我们试图用 $\\mathbf{V}$、$\\mathbf{\\Sigma}$ 和 $\\mathbf{W}$ 来表示 $\\mathbf{R}$ 和 $\\mathbf{U}$。一种自然的构造方法是将SVD中的正交部分和对称部分组合起来。我们提出以下 $\\mathbf{R}$ 和 $\\mathbf{U}$ 的候选形式：\n$$ \\mathbf{R} = \\mathbf{V}\\mathbf{W}^\\top $$\n$$ \\mathbf{U} = \\mathbf{W}\\mathbf{\\Sigma}\\mathbf{W}^\\top $$\n我们必须验证这些选择是否满足所需属性。\n\n首先，检查分解是否有效：\n$$ \\mathbf{R}\\mathbf{U} = (\\mathbf{V}\\mathbf{W}^\\top)(\\mathbf{W}\\mathbf{\\Sigma}\\mathbf{W}^\\top) = \\mathbf{V}(\\mathbf{W}^\\top\\mathbf{W})\\mathbf{\\Sigma}\\mathbf{W}^\\top = \\mathbf{V}\\mathbf{I}\\mathbf{\\Sigma}\\mathbf{W}^\\top = \\mathbf{V}\\mathbf{\\Sigma}\\mathbf{W}^\\top = \\mathbf{F} $$\n该分解是正确的。\n\n其次，验证 $\\mathbf{U}$ 的属性。\n对称性：\n$$ \\mathbf{U}^\\top = (\\mathbf{W}\\mathbf{\\Sigma}\\mathbf{W}^\\top)^\\top = (\\mathbf{W}^\\top)^\\top \\mathbf{\\Sigma}^\\top \\mathbf{W}^\\top = \\mathbf{W}\\mathbf{\\Sigma}\\mathbf{W}^\\top = \\mathbf{U} $$\n因为 $\\mathbf{\\Sigma}$ 是对角矩阵，所以是对称的。故 $\\mathbf{U}$ 是对称的。\n\n正定性：对于任意非零向量 $\\mathbf{x} \\in \\mathbb{R}^n$，我们考察二次型 $\\mathbf{x}^\\top\\mathbf{U}\\mathbf{x}$：\n$$ \\mathbf{x}^\\top\\mathbf{U}\\mathbf{x} = \\mathbf{x}^\\top (\\mathbf{W}\\mathbf{\\Sigma}\\mathbf{W}^\\top) \\mathbf{x} = (\\mathbf{W}^\\top\\mathbf{x})^\\top \\mathbf{\\Sigma} (\\mathbf{W}^\\top\\mathbf{x}) $$\n令 $\\mathbf{y} = \\mathbf{W}^\\top\\mathbf{x}$。由于 $\\mathbf{W}$ 是正交的且 $\\mathbf{x} \\neq \\mathbf{0}$，因此 $\\mathbf{y} \\neq \\mathbf{0}$。该表达式变为：\n$$ \\mathbf{y}^\\top \\mathbf{\\Sigma} \\mathbf{y} = \\sum_{i=1}^n \\sigma_i y_i^2 $$\n如前所述，对所有 $i$ 都有 $\\sigma_i > 0$。因为 $\\mathbf{y} \\neq \\mathbf{0}$，所以至少有一个 $y_i \\neq 0$。因此，$\\sum_{i=1}^n \\sigma_i y_i^2 > 0$。这证实了 $\\mathbf{U}$ 是正定的。\n\n第三，验证 $\\mathbf{R}$ 的属性。\n正交性：\n$$ \\mathbf{R}^\\top\\mathbf{R} = (\\mathbf{V}\\mathbf{W}^\\top)^\\top(\\mathbf{V}\\mathbf{W}^\\top) = (\\mathbf{W}\\mathbf{V}^\\top)(\\mathbf{V}\\mathbf{W}^\\top) = \\mathbf{W}(\\mathbf{V}^\\top\\mathbf{V})\\mathbf{W}^\\top = \\mathbf{W}\\mathbf{I}\\mathbf{W}^\\top = \\mathbf{W}\\mathbf{W}^\\top = \\mathbf{I} $$\n$\\mathbf{R}$ 是正交的。\n\n真旋转：我们必须确保 $\\det(\\mathbf{R}) = +1$。\n$$ \\det(\\mathbf{R}) = \\det(\\mathbf{V}\\mathbf{W}^\\top) = \\det(\\mathbf{V})\\det(\\mathbf{W}^\\top) = \\det(\\mathbf{V})\\det(\\mathbf{W}) $$\n从SVD可知，$\\det(\\mathbf{F}) = \\det(\\mathbf{V}\\mathbf{\\Sigma}\\mathbf{W}^\\top) = \\det(\\mathbf{V})\\det(\\mathbf{\\Sigma})\\det(\\mathbf{W}) = (\\det(\\mathbf{V})\\det(\\mathbf{W})) \\prod_{i=1}^n \\sigma_i$。\n给定 $\\det(\\mathbf{F}) > 0$ 且已知 $\\prod \\sigma_i > 0$，则必有 $\\det(\\mathbf{V})\\det(\\mathbf{W}) > 0$。\n正交矩阵的行列式只能是 $+1$ 或 $-1$。因此，$\\det(\\mathbf{V})$ 和 $\\det(\\mathbf{W})$ 必须同号。它们的乘积必然为 $+1$。\n$$ \\det(\\mathbf{R}) = \\det(\\mathbf{V})\\det(\\mathbf{W}) = +1 $$\n因此，$\\mathbf{R}$ 是一个真旋转矩阵，即 $\\mathbf{R} \\in \\mathrm{SO}(n)$。\n\n从这些第一性原理推导出的算法如下：\n1.  对于给定的矩阵 $\\mathbf{F}$（满足 $\\det(\\mathbf{F}) > 0$），计算其SVD：$\\mathbf{F} = \\mathbf{V}\\mathbf{\\Sigma}\\mathbf{W}^\\top$。\n2.  旋转矩阵为 $\\mathbf{R} = \\mathbf{V}\\mathbf{W}^\\top$。\n3.  拉伸张量为 $\\mathbf{U} = \\mathbf{W}\\mathbf{\\Sigma}\\mathbf{W}^\\top$。或者，也可以通过 $\\mathbf{U} = \\mathbf{R}^\\top\\mathbf{F}$ 计算得到。\n\n### 2. 最小性和唯一性的证明\n\n我们必须证明 $\\mathbf{R} = \\mathbf{V}\\mathbf{W}^\\top$ 是问题 $\\min_{\\mathbf{Q} \\in \\mathrm{SO}(n)} \\|\\mathbf{F} - \\mathbf{Q}\\|_F$ 的唯一极小化子。\n\n弗罗贝尼乌斯范数的平方为 $\\|\\mathbf{A}\\|_F^2 = \\operatorname{Tr}(\\mathbf{A}^\\top\\mathbf{A})$。我们展开目标函数：\n$$ \\|\\mathbf{F} - \\mathbf{Q}\\|_F^2 = \\operatorname{Tr}((\\mathbf{F} - \\mathbf{Q})^\\top(\\mathbf{F} - \\mathbf{Q})) = \\operatorname{Tr}(\\mathbf{F}^\\top\\mathbf{F} - \\mathbf{F}^\\top\\mathbf{Q} - \\mathbf{Q}^\\top\\mathbf{F} + \\mathbf{Q}^\\top\\mathbf{Q}) $$\n由于 $\\mathbf{Q} \\in \\mathrm{SO}(n)$，$\\mathbf{Q}$ 是正交的，所以 $\\mathbf{Q}^\\top\\mathbf{Q} = \\mathbf{I}$ 且 $\\operatorname{Tr}(\\mathbf{I}) = n$。同时，$\\operatorname{Tr}(\\mathbf{Q}^\\top\\mathbf{F}) = \\operatorname{Tr}((\\mathbf{F}^\\top\\mathbf{Q})^\\top) = \\operatorname{Tr}(\\mathbf{F}^\\top\\mathbf{Q})$。\n$$ \\|\\mathbf{F} - \\mathbf{Q}\\|_F^2 = \\operatorname{Tr}(\\mathbf{F}^\\top\\mathbf{F}) + n - 2\\operatorname{Tr}(\\mathbf{F}^\\top\\mathbf{Q}) = \\|\\mathbf{F}\\|_F^2 + n - 2\\operatorname{Tr}(\\mathbf{F}^\\top\\mathbf{Q}) $$\n相对于 $\\mathbf{Q}$ 最小化此表达式，等价于最大化 $\\operatorname{Tr}(\\mathbf{F}^\\top\\mathbf{Q})$ 这一项。\n\n将 $\\mathbf{F} = \\mathbf{V}\\mathbf{\\Sigma}\\mathbf{W}^\\top$ 的SVD代入迹中：\n$$ \\operatorname{Tr}(\\mathbf{F}^\\top\\mathbf{Q}) = \\operatorname{Tr}((\\mathbf{V}\\mathbf{\\Sigma}\\mathbf{W}^\\top)^\\top \\mathbf{Q}) = \\operatorname{Tr}(\\mathbf{W}\\mathbf{\\Sigma}\\mathbf{V}^\\top \\mathbf{Q}) $$\n利用迹的循环性质 $\\operatorname{Tr}(\\mathbf{ABC}) = \\operatorname{Tr}(\\mathbf{CAB})$：\n$$ \\operatorname{Tr}(\\mathbf{W}\\mathbf{\\Sigma}\\mathbf{V}^\\top \\mathbf{Q}) = \\operatorname{Tr}(\\mathbf{\\Sigma}\\mathbf{V}^\\top \\mathbf{Q}\\mathbf{W}) $$\n令 $\\mathbf{Z} = \\mathbf{V}^\\top\\mathbf{Q}\\mathbf{W}$。由于 $\\mathbf{V}$、$\\mathbf{Q}$ 和 $\\mathbf{W}$ 都是正交的，它们的乘积 $\\mathbf{Z}$ 也是正交的。我们希望在所有可以由 $\\mathbf{Q} \\in \\mathrm{SO}(n)$ 构成的正交矩阵 $\\mathbf{Z}$ 中，最大化 $\\operatorname{Tr}(\\mathbf{\\Sigma}\\mathbf{Z})$。\n$$ \\det(\\mathbf{Z}) = \\det(\\mathbf{V}^\\top)\\det(\\mathbf{Q})\\det(\\mathbf{W}) = \\det(\\mathbf{V})^{-1} (+1) \\det(\\mathbf{W}) = \\det(\\mathbf{V})\\det(\\mathbf{W}) = +1 $$\n最后一步是因为对于行列式为 $\\pm 1$ 的正交矩阵，有 $\\det(\\mathbf{V}) = \\det(\\mathbf{V}^\\top)$，或者简单地说是因为 $\\det(\\mathbf{V})^2=1$。更严谨地说，$\\det(\\mathbf{V}^\\top\\mathbf{V})=1 \\implies \\det(\\mathbf{V}^\\top)\\det(\\mathbf{V})=1 \\implies \\det(\\mathbf{V})^2=1$。所以 $\\det(\\mathbf{V}^\\top)=\\det(\\mathbf{V})$。\n因此，我们必须在所有 $\\mathbf{Z} \\in \\mathrm{SO}(n)$ 中最大化 $\\operatorname{Tr}(\\mathbf{\\Sigma}\\mathbf{Z})$。\n\n该迹为 $\\operatorname{Tr}(\\mathbf{\\Sigma}\\mathbf{Z}) = \\sum_{i=1}^n \\sigma_i Z_{ii}$。根据冯·诺伊曼迹不等式，$\\operatorname{Tr}(\\mathbf{\\Sigma}\\mathbf{Z}) \\le \\sum_i \\sigma_i(\\mathbf{\\Sigma})\\sigma_i(\\mathbf{Z})$。$\\mathbf{\\Sigma}$ 的奇异值是 $\\sigma_i$，而正交矩阵 $\\mathbf{Z}$ 的奇异值全部为1。\n$$ \\operatorname{Tr}(\\mathbf{\\Sigma}\\mathbf{Z}) \\le \\sum_{i=1}^n \\sigma_i $$\n当 $\\mathbf{\\Sigma}$ 和 $\\mathbf{Z}$ 可以被同一对正交矩阵同时对角化时，等号成立。由于 $\\mathbf{\\Sigma}$ 已经是 对角矩阵，此条件意味着 $\\mathbf{Z}$ 也必须是对角矩阵。一个正交的对角矩阵的对角线元素必须是 $\\pm 1$。\n为了在 $\\sigma_i > 0$ 和 $Z_{ii} = \\pm 1$ 的条件下最大化 $\\sum_i \\sigma_i Z_{ii}$，我们必须为所有 $i$ 选择 $Z_{ii}=+1$。这导出了唯一的选择 $\\mathbf{Z} = \\mathbf{I}$。\n单位矩阵 $\\mathbf{I}$ 属于 $\\mathrm{SO}(n)$，因为 $\\det(\\mathbf{I})=+1$。\n因此，当且仅当 $\\mathbf{Z} = \\mathbf{I}$ 时，$\\operatorname{Tr}(\\mathbf{\\Sigma}\\mathbf{Z})$ 达到其最大值。\n\n设置 $\\mathbf{Z} = \\mathbf{I}$ 给出最优的 $\\mathbf{Q}$：\n$$ \\mathbf{V}^\\top\\mathbf{Q}\\mathbf{W} = \\mathbf{I} \\implies \\mathbf{Q} = \\mathbf{V}\\mathbf{I}\\mathbf{W}^\\top = \\mathbf{V}\\mathbf{W}^\\top $$\n这恰好是上一节中推导出的矩阵 $\\mathbf{R}$。这证明了对于 $\\mathbf{Q} \\in \\mathrm{SO}(n)$，$\\mathbf{R} = \\mathbf{V}\\mathbf{W}^\\top$ 是 $\\|\\mathbf{F} - \\mathbf{Q}\\|_F$ 的唯一极小化子。\n\n关于相关联的拉伸张量 $\\mathbf{U} = \\mathbf{R}^\\top\\mathbf{F}$ 是对称正定的证明，已在算法推导部分得到展示。\n\n### 3. 实现与验证\n\nPython 实现将遵循推导出的算法。对每个测试矩阵 $\\mathbf{F}_k$，我们执行以下步骤：\n1.  构造 $\\mathbf{F}_k$。\n2.  使用 `numpy.linalg.svd` 计算其SVD：$\\mathbf{V}$、$\\mathbf{S}$（奇异值向量）、$\\mathbf{W}^\\top$。\n3.  计算 $\\mathbf{R}_k = \\mathbf{V} \\mathbf{W}^\\top$。\n4.  计算所需的诊断量。\n\n对于情况1和4，诊断量为 $|\\,\\|\\mathbf{F}_k - \\mathbf{R}_k\\|_F - \\sqrt{\\sum (\\sigma_i - 1)^2}\\,|$。\n从第2节的证明可知，目标函数的最小值为：\n$$ \\|\\mathbf{F} - \\mathbf{R}\\|_F^2 = \\|\\mathbf{F}\\|_F^2 + n - 2 \\operatorname{Tr}(\\mathbf{F}^\\top\\mathbf{R}) $$\n我们证明了 $\\operatorname{Tr}(\\mathbf{F}^\\top\\mathbf{R}) = \\sum \\sigma_i$。同时，$\\|\\mathbf{F}\\|_F^2 = \\operatorname{Tr}(\\mathbf{F}^\\top\\mathbf{F}) = \\operatorname{Tr}(\\mathbf{W}\\mathbf{\\Sigma}^2\\mathbf{W}^\\top) = \\operatorname{Tr}(\\mathbf{\\Sigma}^2) = \\sum \\sigma_i^2$。\n$$ \\|\\mathbf{F} - \\mathbf{R}\\|_F^2 = \\sum \\sigma_i^2 + n - 2\\sum \\sigma_i = \\sum_{i=1}^n (\\sigma_i^2 - 2\\sigma_i + 1) = \\sum_{i=1}^n (\\sigma_i - 1)^2 $$\n取平方根，我们恰好得到 $\\|\\mathbf{F} - \\mathbf{R}\\|_F = \\sqrt{\\sum (\\sigma_i - 1)^2}$。\n因此，对于情况1和4，诊断量预期为零（在浮点精度误差范围内）。这可作为我们最小化证明的定量验证。\n\n对于情况2和3，矩阵 $\\mathbf{F}_k$ 是以 $\\mathbf{F}_k = \\mathbf{R}_{\\mathrm{true}} \\mathbf{U}_{\\mathrm{true}}$ 的形式构造的，其中 $\\mathbf{R}_{\\mathrm{true}}$ 是一个真旋转矩阵，$\\mathbf{U}_{\\mathrm{true}}$ 是对称正定的。根据定义，这本身就是右极分解。由于可逆矩阵的极分解是唯一的，我们的算法必须能够恢复出 $\\mathbf{R}_k = \\mathbf{R}_{\\mathrm{true}}$ 和 $\\mathbf{U}_k = \\mathbf{U}_{\\mathrm{true}}$。因此，诊断量 $\\|\\mathbf{R}_2 - \\mathbf{R}_{\\mathrm{true}}\\|_F$ 和 $\\|\\mathbf{U}_3 - \\mathbf{U}_{\\mathrm{true}}\\|_F$ 预期为零（在数值精度误差范围内）。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the right polar decomposition for several deformation gradients and\n    calculates specific diagnostic values to verify the theoretical results.\n    \"\"\"\n\n    # --- Test Case 1: 2D diagonal stretch ---\n    F1 = np.array([[2.0, 0.0], [0.0, 0.5]])\n\n    # --- Test Case 2: 2D rotated stretch ---\n    theta = 0.4\n    R_true2 = np.array([[np.cos(theta), -np.sin(theta)],\n                        [np.sin(theta), np.cos(theta)]])\n    U_true2 = np.diag([1.2, 0.8])\n    F2 = R_true2 @ U_true2\n\n    # --- Test Case 3: 3D general symmetric stretch ---\n    phi = 0.6\n    Q3 = np.array([[np.cos(phi), -np.sin(phi), 0.0],\n                   [np.sin(phi), np.cos(phi), 0.0],\n                   [0.0, 0.0, 1.0]])\n    D3 = np.diag([1.5, 0.9, 1.1])\n    U_true3 = Q3 @ D3 @ Q3.T\n    \n    alpha = -0.7\n    R_true3_x = np.array([[1.0, 0.0, 0.0],\n                          [0.0, np.cos(alpha), -np.sin(alpha)],\n                          [0.0, np.sin(alpha), np.cos(alpha)]])\n    F3 = R_true3_x @ U_true3\n\n    # --- Test Case 4: 2D ill-conditioned stretch ---\n    beta = 1.1\n    R_beta4 = np.array([[np.cos(beta), -np.sin(beta)],\n                        [np.sin(beta), np.cos(beta)]])\n    U_true4 = np.diag([1e-6, 3.0])\n    F4 = R_beta4 @ U_true4\n\n    test_cases = [\n        {'F': F1, 'type': 'diag_check'},\n        {'F': F2, 'type': 'R_check', 'R_true': R_true2},\n        {'F': F3, 'type': 'U_check', 'U_true': U_true3},\n        {'F': F4, 'type': 'diag_check'}\n    ]\n\n    results = []\n\n    for case in test_cases:\n        F = case['F']\n        \n        # Core algorithm: Right Polar Decomposition using SVD\n        # F = V @ Sigma @ Wt\n        V, S_vec, Wt = np.linalg.svd(F)\n        \n        # This is needed for the general case where det(F) could be  0.\n        # For this problem, det(F) > 0, so det(V)*det(Wt) is always +1.\n        if np.linalg.det(V) * np.linalg.det(Wt)  0:\n            V_corr = V.copy()\n            V_corr[:, -1] *= -1\n            R = V_corr @ Wt\n        else:\n            R = V @ Wt\n\n        if case['type'] == 'diag_check':\n            # Diagnostic: | ||F - R||_F - sqrt(sum((sigma_i - 1)^2)) |\n            norm_F_minus_R = np.linalg.norm(F - R, 'fro')\n            norm_s_minus_1 = np.sqrt(np.sum((S_vec - 1)**2))\n            diagnostic = np.abs(norm_F_minus_R - norm_s_minus_1)\n            results.append(diagnostic)\n            \n        elif case['type'] == 'R_check':\n            # Diagnostic: ||R - R_true||_F\n            R_true = case['R_true']\n            diagnostic = np.linalg.norm(R - R_true, 'fro')\n            results.append(diagnostic)\n\n        elif case['type'] == 'U_check':\n            # U can be computed as U = R.T @ F\n            U = R.T @ F\n            U_true = case['U_true']\n            # Diagnostic: ||U - U_true||_F\n            diagnostic = np.linalg.norm(U - U_true, 'fro')\n            results.append(diagnostic)\n\n    # Format the output as a comma-separated list of floats in a single line.\n    # Use scientific notation for consistency and to handle very small numbers.\n    formatted_results = [f\"{res:.8e}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}