{
    "hands_on_practices": [
        {
            "introduction": "我们从一个简单的双杆桁架结构开始。这个练习之所以至关重要，是因为它能让我们清晰地看到极限分析的静态（下限）和运动（上限）两个核心定理的实际应用。通过分别为该结构构建一个静力容许的应力场和一个机动容许的倒塌机构，我们将证明两个定理给出的边界可以重合，从而得到精确的极限荷载，这个过程将为我们理解更复杂的问题打下坚实的基础。",
            "id": "2654975",
            "problem": "一个由两根杆件铰接组成的桁架在其顶点处承受一个竖向荷载。这两根相同的杆件，其下端连接到笛卡尔坐标系中坐标为 $\\left(-a,\\,0\\right)$ 和 $\\left(+a,\\,0\\right)$ 的固定无摩擦铰支座上，它们在顶点 $\\left(0,\\,h\\right)$ 处交汇。每根杆件具有恒定的横截面积 $A$，并遵循刚性理想塑性、率无关的单轴本构行为，其受拉和受压的屈服应力均为 $\\sigma_{y}$。这些杆件只承受轴向力，被完美地支撑以防止失稳，且几何变化很小，因此一阶运动学和平衡对于虚功方程是有效的。\n\n一个向下的竖向荷载 $P=\\lambda\\,P_{0}$ 施加在顶点上，其中 $P_{0}0$ 是一个固定的参考荷载，$\\lambda$ 是一个无量纲的荷载因子。当杆件达到其屈服条件 $|N|\\le N_{p}$ 时，桁架形成塑性机构并发生破坏，其中 $N$ 是杆件中的轴向力，$N_{p}=\\sigma_{y}A$ 是塑性轴向承载力。\n\n仅使用平衡、协调的基本原理，塑性轴向承载力的定义，以及极限分析的下限定理（静力法）和上限定理（机动法）的陈述：\n\n- 构建一个满足顶点关节平衡和两根杆件屈服条件的静力许可轴力场，并推导出荷载因子 $\\lambda$ 的一个下限。\n- 构建一个在顶点和固定支座处具有一致虚速度场的机动许可破坏机构，应用虚功原理和刚性理想塑性行为的最大塑性耗散原理，以推导出 $\\lambda$ 的一个上限。\n- 证明当应力场和机构的选择与几何形状及屈服面一致时，下限和上限重合，从而得到精确的临界荷载因子 $\\lambda_{c}$。\n\n将精确的 $\\lambda_{c}$ 表示为包含 $a$、$h$、$A$、$\\sigma_{y}$ 和 $P_{0}$ 的闭式解析表达式。不要进行任何数值代入。你的最终答案必须是 $\\lambda_{c}$ 的单个无单位解析表达式。",
            "solution": "我们首先记录基本的几何和力学事实。从 $\\left(-a,\\,0\\right)$ 到 $\\left(0,\\,h\\right)$ 的杆件和从 $\\left(+a,\\,0\\right)$ 到 $\\left(0,\\,h\\right)$ 的杆件是相同的，每根杆件的长度为\n$$\nL=\\sqrt{a^{2}+h^{2}}.\n$$\n设 $\\mathbf{e}_{1}$ 和 $\\mathbf{e}_{2}$ 是沿着从下部支座到顶点关节的杆件方向的单位向量。根据几何关系，\n$$\n\\mathbf{e}_{1}=\\left(\\frac{a}{L},\\,\\frac{h}{L}\\right),\\qquad \\mathbf{e}_{2}=\\left(-\\frac{a}{L},\\,\\frac{h}{L}\\right).\n$$\n设每根杆件中的未知轴力分别为 $N_{1}$ 和 $N_{2}$，分别沿 $\\mathbf{e}_{1}$ 和 $\\mathbf{e}_{2}$ 方向受拉为正。施加在顶点的荷载为 $\\mathbf{P}=(0,\\,-P)$，其中 $P=\\lambda P_{0}0$。\n\n下限定理（静力法）。下限定理断言，如果存在一个与外荷载满足全局平衡并且处处满足屈服条件 $|N_{i}|\\le N_{p}$ 的静力许可内力场，那么相关的荷载是一个不超过真实破坏荷载的安全估计。对于该铰接桁架，顶点的平衡要求\n$$\nN_{1}\\,\\mathbf{e}_{1}+N_{2}\\,\\mathbf{e}_{2}+\\mathbf{P}=\\mathbf{0}.\n$$\n根据几何和荷载的对称性，一个静力许可的选择是 $N_{1}=N_{2}=N$。投影到竖直方向上，\n$$\nN\\left(\\frac{h}{L}\\right)+N\\left(\\frac{h}{L}\\right)-P=0\\quad\\Longrightarrow\\quad 2N\\frac{h}{L}=P.\n$$\n施加屈服约束 $|N|\\le N_{p}=\\sigma_{y}A$ 并寻求最大的许可荷载 $P$，当 $N=-N_{p}$ 时得到下限值（因为荷载向下，杆件受压，拉力为正的约定下$N$为负值）：\n$$\nP_{\\mathrm{LB}}=2(-N_p)\\frac{h}{L}(-1)=2N_{p}\\frac{h}{L}=2\\,\\sigma_{y}A\\,\\frac{h}{\\sqrt{a^{2}+h^{2}}}.\n$$\n因此，荷载因子的下限为\n$$\n\\lambda_{\\mathrm{LB}}=\\frac{P_{\\mathrm{LB}}}{P_{0}}=2\\,\\frac{\\sigma_{y}A}{P_{0}}\\,\\frac{h}{\\sqrt{a^{2}+h^{2}}}.\n$$\n\n上限定理（机动法）。上限定理断言，对于任何与支座和机构相容的机动许可速度场，在破坏时，外力功率等于内能塑性耗散率，这提供了破坏荷载的一个上限。对于一维情况下具有凸对称屈服面 $|N|\\le N_{p}$ 的率无关刚性理想塑性材料，最大塑性耗散原理意味着，对于给定的轴向塑性伸长率 $\\dot{\\Delta}$，当轴力取值为 $N=N_{p}\\,\\mathrm{sign}(\\dot{\\Delta})$ 时，每根杆件的内功率达到最大值 $N_{p}\\,|\\dot{\\Delta}|$。\n\n选择一个机动许可的机构，其中顶点具有竖向速度 $\\mathbf{v}=(0,\\,-v)$（$v0$），而支座是固定的。小变形协调性给出每根杆件的轴向变化率，即为顶点相对速度在杆件单位轴线上的投影：\n$$\n\\dot{\\Delta}_{1}=\\mathbf{v}\\cdot\\mathbf{e}_{1}=(0,\\,-v)\\cdot\\left(\\frac{a}{L},\\,\\frac{h}{L}\\right)=-v\\,\\frac{h}{L},\\qquad\n\\dot{\\Delta}_{2}=\\mathbf{v}\\cdot\\mathbf{e}_{2}=(0,\\,-v)\\cdot\\left(-\\frac{a}{L},\\,\\frac{h}{L}\\right)=-v\\,\\frac{h}{L}.\n$$\n因此，总的内部塑性耗散率为\n$$\n\\dot{W}_{\\mathrm{int}}=N_{p}\\,|\\dot{\\Delta}_{1}|+N_{p}\\,|\\dot{\\Delta}_{2}|=2\\,N_{p}\\,\\left(\\frac{v\\,h}{L}\\right)=2\\,\\sigma_{y}A\\,\\frac{v\\,h}{\\sqrt{a^{2}+h^{2}}}.\n$$\n外力功率是作用荷载与荷载方向上相容速度的乘积：\n$$\n\\dot{W}_{\\mathrm{ext}}=P\\,v=\\lambda P_{0}\\,v.\n$$\n将破坏时的外力功率与内能耗散率相等，得到机动法上限\n$$\n\\lambda_{\\mathrm{UB}}\\,P_{0}\\,v=2\\,\\sigma_{y}A\\,\\frac{v\\,h}{\\sqrt{a^{2}+h^{2}}}\\quad\\Longrightarrow\\quad \\lambda_{\\mathrm{UB}}=2\\,\\frac{\\sigma_{y}A}{P_{0}}\\,\\frac{h}{\\sqrt{a^{2}+h^{2}}}.\n$$\n\n上下限的重合与精确解。上面推导出的下限和上限是相等的：\n$$\n\\lambda_{\\mathrm{LB}}=\\lambda_{\\mathrm{UB}}=2\\,\\frac{\\sigma_{y}A}{P_{0}}\\,\\frac{h}{\\sqrt{a^{2}+h^{2}}}.\n$$\n这种相等之所以发生，是因为静力许可场和机动许可机构与几何形状及对称屈服面是一致的：两根杆件都被激活，并且在机动分析中选择的轴向塑性流动方向是在 $|N|\\le N_{p}$ 约束下使耗散最大化的方向，这与使 $|N|=N_{p}$ 饱和并满足平衡的静力场是对偶的。根据极限分析的基本定理，当从上下限方法得到相同的值时，该值即为精确的破坏荷载因子 $\\lambda_{c}$。\n\n因此，精确的临界荷载因子为\n$$\n\\lambda_{c}=2\\,\\frac{\\sigma_{y}A}{P_{0}}\\,\\frac{h}{\\sqrt{a^{2}+h^{2}}}.\n$$",
            "answer": "$$\\boxed{2\\,\\dfrac{\\sigma_{y}A}{P_{0}}\\,\\dfrac{h}{\\sqrt{a^{2}+h^{2}}}}$$"
        },
        {
            "introduction": "接下来，我们转向一个更复杂的连续结构：一端固定、一端简支的梁。对于这类结构，直接构造满足所有条件的弯矩分布（静力法）可能很困难，而运动（上限）定理提供了一个强有力的替代方法。我们可以通过假设一个合理的倒塌机构，并应用虚功原理计算出对应的极限荷载，从而得到一个偏于安全设计的上限估计。这个练习将帮助你掌握定义机动许可机构和计算内外功率的关键技能。",
            "id": "2655046",
            "problem": "一根长度为 $L$ 的等截面直梁，具有刚塑性弯曲响应，其在 $x=0$ 处为嵌固端（固定支座），在 $x=L$ 处由一个简支支座支撑，该支座阻止竖向平动但允许转动。横截面具有对称的弯曲屈服能力，因此在正弯（下垂）和负弯（拱起）时，全塑性弯矩均为 $M_p$，不考虑轴力相互作用，且抗剪能力足够高，不会发生剪切屈服。该梁承受一个未知的恒定集度为 $w$ 的均布横向荷载，在 $0 \\le x \\le L$ 范围内向下作用。假设转角很小，并且在破坏机构中，塑性铰之间的梁段作刚体运动，由发生集中塑性转动的塑性铰隔开。\n\n使用塑性极限分析的机动（上限）定理和虚功原理，考虑一个具有两个塑性铰的机动许可机构：一个在固定端 $x=0$ 处，另一个在内部位置 $x=b$ 处，其中 $0  b  L$。在简支端 $x=L$ 处不形成塑性铰，且在 $x=L$ 处的虚竖向位移为零。\n\n推导 $w$ 作为内铰位置 $b$ 的函数的表达式。然后，通过对 $b$ 最小化此表达式来找到极限荷载集度 $w$ 的最小上限 $w_{\\mathrm{UB}}$。您的最终答案必须用 $M_p$ 和 $L$ 表示。",
            "solution": "分析过程通过对指定的破坏机构应用虚功原理来进行。外加荷载所做的外力功功率必须等于塑性铰处耗散的内能功率。\n\n首先，我们定义机动许可的虚位移场 $\\dot{\\delta}(x)$。一个塑性铰在固定支座 $x=0$ 处形成，另一个在内部点 $x=b$ 处形成。梁由两个刚性段组成：段1从 $x=0$ 到 $x=b$，段2从 $x=b$ 到 $x=L$。我们为段1引入一个绕点 $x=0$ 的虚转动速率 $\\dot{\\alpha}$。对于小转角，此段中任意点 $x$ 的虚竖向位移由下式给出：\n$$ \\dot{\\delta}(x) = \\dot{\\alpha}x, \\quad \\text{for } 0 \\le x \\le b $$\n在内部铰位置 $x=b$ 处，位移为 $\\dot{\\delta}(b) = \\dot{\\alpha}b$。\n\n从 $x=b$ 到 $x=L$ 的段2，作为刚体转动以满足边界条件 $\\dot{\\delta}(L)=0$ 和协调条件 $\\dot{\\delta}(b) = \\dot{\\alpha}b$。此段绕 $x=L$ 处的简支支座转动。段2的转动，记为 $\\dot{\\beta}$，必须在长度 $L-b$ 上产生 $\\dot{\\alpha}b$ 的向上位移。因此，该段的斜率为负。\n$$ \\dot{\\delta}(x) = \\frac{\\dot{\\delta}(b)}{L-b}(L-x) = \\frac{\\dot{\\alpha}b}{L-b}(L-x), \\quad \\text{for } b \\le x \\le L $$\n\n由均布荷载 $w$ 所做的外力功功率 $\\dot{W}_{\\mathrm{ext}}$ 是荷载集度乘以虚速度场在梁的全长上的积分。\n$$ \\dot{W}_{\\mathrm{ext}} = \\int_0^L w \\dot{\\delta}(x) dx = w \\left( \\int_0^b \\dot{\\alpha}x \\,dx + \\int_b^L \\frac{\\dot{\\alpha}b}{L-b}(L-x) \\,dx \\right) $$\n计算积分：\n$$ \\int_0^b \\dot{\\alpha}x \\,dx = \\dot{\\alpha} \\left[ \\frac{x^2}{2} \\right]_0^b = \\frac{1}{2} \\dot{\\alpha}b^2 $$\n$$ \\int_b^L \\frac{\\dot{\\alpha}b}{L-b}(L-x) \\,dx = \\frac{\\dot{\\alpha}b}{L-b} \\left[ Lx - \\frac{x^2}{2} \\right]_b^L = \\frac{\\dot{\\alpha}b}{L-b} \\left( (L^2 - \\frac{L^2}{2}) - (Lb - \\frac{b^2}{2}) \\right) = \\frac{\\dot{\\alpha}b}{L-b} \\left( \\frac{L^2 - 2Lb + b^2}{2} \\right) = \\frac{\\dot{\\alpha}b(L-b)^2}{2(L-b)} = \\frac{1}{2}\\dot{\\alpha}b(L-b) $$\n将两部分相加得到总外力功功率：\n$$ \\dot{W}_{\\mathrm{ext}} = w \\left( \\frac{1}{2}\\dot{\\alpha}b^2 + \\frac{1}{2}\\dot{\\alpha}b(L-b) \\right) = w \\left( \\frac{\\dot{\\alpha}b^2 + \\dot{\\alpha}bL - \\dot{\\alpha}b^2}{2} \\right) = \\frac{1}{2} w \\dot{\\alpha} b L $$\n\n接下来，我们计算内能耗散功率 $\\dot{W}_{\\mathrm{int}}$。能量耗散发生在塑性铰处，其中塑性弯矩 $M_p$ 抵抗相对转动。\n固定支座 $x=0$ 处的塑性铰，其转动速率等于段1的转动，即 $\\dot{\\theta}_0 = \\dot{\\alpha}$。这是一个负弯矩铰。\n位于 $x=b$ 处的塑性铰的转动速率等于段1和段2之间的斜率变化。段1的斜率为 $\\dot{\\alpha}$。段2的斜率为 $-\\frac{\\dot{\\alpha}b}{L-b}$。相对转动速率是这些斜率绝对值之和：\n$$ \\dot{\\theta}_b = \\dot{\\alpha} + \\frac{\\dot{\\alpha}b}{L-b} = \\dot{\\alpha} \\left( 1 + \\frac{b}{L-b} \\right) = \\dot{\\alpha} \\left( \\frac{L-b+b}{L-b} \\right) = \\frac{\\dot{\\alpha}L}{L-b} $$\n这是一个正弯矩铰。总的内部耗散功率为：\n$$ \\dot{W}_{\\mathrm{int}} = M_p |\\dot{\\theta}_0| + M_p |\\dot{\\theta}_b| = M_p \\dot{\\alpha} + M_p \\frac{\\dot{\\alpha}L}{L-b} = M_p \\dot{\\alpha} \\left( 1 + \\frac{L}{L-b} \\right) = M_p \\dot{\\alpha} \\left( \\frac{L-b+L}{L-b} \\right) = M_p \\dot{\\alpha} \\frac{2L-b}{L-b} $$\n\n根据虚功原理，在破坏时有 $\\dot{W}_{\\mathrm{ext}} = \\dot{W}_{\\mathrm{int}}$。\n$$ \\frac{1}{2} w \\dot{\\alpha} b L = M_p \\dot{\\alpha} \\frac{2L-b}{L-b} $$\n虚转动速率 $\\dot{\\alpha}$ 被消去，我们求解 $w$ 作为 $b$ 的函数：\n$$ w(b) = \\frac{2 M_p}{bL} \\frac{2L-b}{L-b} = \\frac{2M_p}{L} \\left( \\frac{2L-b}{Lb-b^2} \\right) $$\n根据机动定理，对于任意 $b \\in (0, L)$，此表达式给出了真实极限荷载的一个上限。为了找到最小上限，我们必须对 $b$ 最小化 $w(b)$。我们计算导数 $\\frac{dw}{db}$ 并令其为零。这等效于最小化函数 $f(b) = \\frac{2L-b}{Lb-b^2}$。\n$$ \\frac{df}{db} = \\frac{(-1)(Lb-b^2) - (2L-b)(L-2b)}{(Lb-b^2)^2} = 0 $$\n分子必须为零：\n$$ -(Lb-b^2) - (2L^2 - 4Lb - Lb + 2b^2) = 0 $$\n$$ -Lb + b^2 - (2L^2 - 5Lb + 2b^2) = 0 $$\n$$ -Lb + b^2 - 2L^2 + 5Lb - 2b^2 = 0 $$\n$$ -b^2 + 4Lb - 2L^2 = 0 $$\n$$ b^2 - 4Lb + 2L^2 = 0 $$\n这是一个关于 $b$ 的二次方程。其解为：\n$$ b = \\frac{-(-4L) \\pm \\sqrt{(-4L)^2 - 4(1)(2L^2)}}{2} = \\frac{4L \\pm \\sqrt{16L^2 - 8L^2}}{2} = \\frac{4L \\pm \\sqrt{8L^2}}{2} = \\frac{4L \\pm 2\\sqrt{2}L}{2} = (2 \\pm \\sqrt{2})L $$\n$b$ 的两个可能值为 $(2+\\sqrt{2})L$ 和 $(2-\\sqrt{2})L$。由于塑性铰必须位于梁内，即 $0  b  L$，所以值 $b = (2+\\sqrt{2})L \\approx 3.414L$ 是无关解。有效的位置是：\n$$ b = (2-\\sqrt{2})L $$\n注意 $2-\\sqrt{2} \\approx 0.586$，它在区间 $(0, 1)$ 内。\n\n最后，我们将 $b$ 的这个值代入 $w(b)$ 的表达式中，以求得最低的上限极限荷载 $w_{\\mathrm{UB}}$。\n$$ w_{\\mathrm{UB}} = \\frac{2M_p}{L} \\left( \\frac{2L-b}{Lb-b^2} \\right) $$\n我们来计算包含 $b$ 的项：\n$$ 2L - b = 2L - (2-\\sqrt{2})L = (2 - 2 + \\sqrt{2})L = \\sqrt{2}L $$\n$$ Lb - b^2 = L(2-\\sqrt{2})L - ((2-\\sqrt{2})L)^2 = (2-\\sqrt{2})L^2 - (4-4\\sqrt{2}+2)L^2 = (2-\\sqrt{2} - 6+4\\sqrt{2})L^2 = (3\\sqrt{2}-4)L^2 $$\n将这些表达式代入 $w_{\\mathrm{UB}}$ 的公式中：\n$$ w_{\\mathrm{UB}} = \\frac{2M_p}{L} \\left( \\frac{\\sqrt{2}L}{(3\\sqrt{2}-4)L^2} \\right) = \\frac{2\\sqrt{2} M_p}{(3\\sqrt{2}-4)L^2} $$\n为简化，我们将分母有理化：\n$$ \\frac{2\\sqrt{2}}{3\\sqrt{2}-4} = \\frac{2\\sqrt{2}}{3\\sqrt{2}-4} \\times \\frac{3\\sqrt{2}+4}{3\\sqrt{2}+4} = \\frac{2\\sqrt{2}(3\\sqrt{2}+4)}{(3\\sqrt{2})^2 - 4^2} = \\frac{12+8\\sqrt{2}}{18-16} = \\frac{12+8\\sqrt{2}}{2} = 6+4\\sqrt{2} $$\n因此，极限荷载集度的最小上限为：\n$$ w_{\\mathrm{UB}} = (6+4\\sqrt{2}) \\frac{M_p}{L^2} $$",
            "answer": "$$\\boxed{(6+4\\sqrt{2})\\frac{M_p}{L^2}}$$"
        },
        {
            "introduction": "最后，我们将理论与现代计算工具联系起来。对于复杂的超静定桁架，手动进行极限分析既繁琐又容易出错。本练习将向你展示如何将下限定理系统地表述为一个线性规划（LP）问题，这在计算结构优化中是一种标准技术。通过求解这个线性规划问题，我们可以为任意复杂的桁架结构找到最佳的下限解，对于桁架这类离散系统，该解即为精确的极限荷载。",
            "id": "2655024",
            "problem": "考虑一个二维铰接桁架，其模型由一组通过无摩擦节点连接的直杆构成，这些直杆仅承受轴向荷载。设桁架有 $n$ 个节点，其坐标为 $(x_j,y_j)$，$j=1,\\dots,n$；有 $m$ 个杆件，索引为 $i=1,\\dots,m$，其中杆件 $i$ 连接节点 $a(i)$ 和节点 $b(i)$。每个节点有两个平移自由度 $u_{x,j}$ 和 $u_{y,j}$，总共有 $2n$ 个自由度。部分自由度可能受到支座的约束。荷载以节点力的形式施加。对于每个杆件 $i$，其轴力记为 $N_i$，正号表示受拉。杆件 $i$ 具有对称的轴向屈服承载力 $N_{y,i}0$，因此塑性容许条件为 $|N_i|\\le N_{y,i}$。一个荷载模式由节点力向量 $\\mathbf{p}_0\\in\\mathbb{R}^{2n}$ 指定，一个标量荷载因子 $\\lambda\\ge 0$ 将此模式缩放为 $\\lambda \\mathbf{p}_0$。\n\n使用极限分析的下限定理（静力定理），建立一个问题，以求解最大荷载因子 $\\lambda^\\star$。该因子需确保存在一组在屈服极限内的静力容许杆件力 $\\{N_i\\}$，使得所有自由自由度上的平衡得以满足。将此问题表述为一个线性规划（LP）问题，其决策变量为 $\\{N_i\\}_{i=1}^m$ 和 $\\lambda$。该线性规划必须仅基于：\n- 自由自由度上的力平衡，以及\n- 塑性容许边界 $|N_i|\\le N_{y,i}$ 和 $\\lambda\\ge 0$。\n\n按如下方式从第一性原理构建平衡约束。对于连接节点 $a$ 和 $b$ 的杆件 $i$，设其长度为 $L_i=\\sqrt{(x_{b}-x_{a})^2+(y_{b}-y_{a})^2}$，其单位方向向量为 $\\mathbf{t}_i=(c_i,s_i)=\\left(\\dfrac{x_{b}-x_{a}}{L_i},\\dfrac{y_{b}-y_{a}}{L_i}\\right)$。$N_i$ 的等效节点力贡献在节点 $a$ 处为 $+N_i\\mathbf{t}_i$，在节点 $b$ 处为 $-N_i\\mathbf{t}_i$。对于每个杆件 $i$，通过将 $\\mathbf{t}_i$ 放置在对应于节点 $a$ 的行中，将 $-\\mathbf{t}_i$ 放置在对应于节点 $b$ 的行中，并在其他位置填零，来组装平衡矩阵 $\\mathbf{B}\\in\\mathbb{R}^{2n\\times m}$。令 $\\mathcal{F}$ 表示自由自由度的索引集，并令 $\\mathbf{B}_{\\mathcal{F}}$ 和 $\\mathbf{p}_{0,\\mathcal{F}}$ 为局限于 $\\mathcal{F}$ 的子矩阵和子向量。则自由自由度上的平衡方程为\n$$\n\\mathbf{B}_{\\mathcal{F}}\\mathbf{N}+\\lambda\\,\\mathbf{p}_{0,\\mathcal{F}}=\\mathbf{0},\n$$\n其中 $\\mathbf{N}=(N_1,\\dots,N_m)^\\top$。\n\n您的程序必须：\n- 根据提供的几何形状和连接关系构建 $\\mathbf{B}$。\n- 根据支座条件识别自由自由度，并提取 $\\mathbf{B}_{\\mathcal{F}}$ 和 $\\mathbf{p}_{0,\\mathcal{F}}$。\n- 求解线性规划问题，在等式约束和箱式边界 $-N_{y,i}\\le N_i\\le N_{y,i}$ 及 $\\lambda\\ge 0$ 的条件下最大化 $\\lambda$。\n- 返回最优的 $\\lambda^\\star$。\n\n所有距离单位必须为米，所有力和承载力单位必须为牛顿。荷载因子 $\\lambda^\\star$ 是无量纲的。由于荷载模式 $\\mathbf{p}_0$ 的分量单位为牛顿，因此 $\\lambda^\\star$ 的数值即为极限荷载的大小（以牛顿为单位）。将每个结果 $\\lambda^\\star$ 表示为浮点数，并四舍五入到六位小数。\n\n测试套件。使用以下四个桁架实例。对于每个实例，输入数据为：\n- 节点列表：坐标 $(x_j,y_j)$，单位为米。\n- 杆件列表：由从零开始的节点索引组成的对 $(a,b)$。\n- 支座：对于每个受支撑的节点，指明其哪些自由度 $(u_x,u_y)$ 受到约束。\n- 屈服承载力：列表 $[N_{y,1},\\dots,N_{y,m}]$，单位为牛顿。\n- 荷载模式 $\\mathbf{p}_0$：一个长度为 $2n$ 的节点力数组，单位为牛顿。此处不涉及角度单位（如有）。\n\n案例1（对称V形桁架，理想情况）：\n- 节点：$(0,0)$, $(2,0)$, $(1,1)$。\n- 杆件：$(0,2)$, $(2,1)$。\n- 支座：节点0约束 $(u_x,u_y)$，节点1约束 $(u_x,u_y)$。\n- 承载力：$[100,100]$。\n- 荷载模式：在节点2施加单位垂直向下荷载：$\\mathbf{p}_0=[0,0,0,0,0,-1]$。\n\n案例2（单个竖直杆件承受水平荷载，此方向承载力为零，边界情况）：\n- 节点：$(0,0)$, $(0,1)$。\n- 杆件：$(0,1)$。\n- 支座：节点0约束 $(u_x,u_y)$。\n- 承载力：$[100]$。\n- 荷载模式：在节点1施加单位水平向右荷载：$\\mathbf{p}_0=[0,0,1,0]$。\n\n案例3（V形桁架承载力不对称，由较弱杆件控制）：\n- 节点：$(0,0)$, $(2,0)$, $(1,1)$。\n- 杆件：$(0,2)$, $(2,1)$。\n- 支座：节点0约束 $(u_x,u_y)$，节点1约束 $(u_x,u_y)$。\n- 承载力：$[80,200]$。\n- 荷载模式：在节点2施加单位垂直向下荷载：$\\mathbf{p}_0=[0,0,0,0,0,-1]$。\n\n案例4（超静定三角形，由下弦杆限制）：\n- 节点：$(0,0)$, $(2,0)$, $(1,1)$。\n- 杆件：$(0,2)$, $(2,1)$, $(0,1)$。\n- 支座：节点0约束 $(u_x,u_y)$，节点1约束 $(u_x,u_y)$。\n- 承载力：$[200,200,100]$，其中前两个是斜杆 $(0,2)$ 和 $(2,1)$ 的承载力，第三个是下弦杆 $(0,1)$ 的承载力。\n- 荷载模式：在节点2施加单位垂直向下荷载：$\\mathbf{p}_0=[0,0,0,0,0,-1]$。\n\n最终输出格式。您的程序应生成单行输出，其中包含一个逗号分隔的列表，内容是上述四个案例的最优荷载因子 $\\lambda^\\star$，顺序相同，四舍五入到六位小数，并用方括号括起来。例如，输出必须如下所示：\n[lambda1,lambda2,lambda3,lambda4]",
            "solution": "下限定理指出，对于任何可以找到静力容许应力场的荷载因子 $\\lambda$，该因子是真实倒塌荷载因子 $\\lambda^\\star$ 的一个下界。一个应力场（在此案例中为杆件力向量 $\\mathbf{N}$）如果满足平衡条件且不违反屈服准则，则为静力容许的。为了找到最好的下界，我们寻求这样的 $\\lambda$ 的最大值。这可以被公式化为以下优化问题：\n\n最大化 $\\lambda$\n满足约束：\n1. 平衡：$\\mathbf{B}_{\\mathcal{F}}\\mathbf{N} + \\lambda \\mathbf{p}_{0,\\mathcal{F}} = \\mathbf{0}$\n2. 屈服条件：$|N_i| \\le N_{y,i}$ 对于 $i=1, \\dots, m$\n3. 非负性：$\\lambda \\ge 0$\n\n这是一个线性规划（LP）问题。决策变量是杆件力 $N_1, \\dots, N_m$ 和荷载因子 $\\lambda$。为了使用标准的LP求解器，我们重新格式化该问题。大多数标准求解器被设计为最小化一个线性目标函数。最大化 $\\lambda$ 等价于最小化 $-\\lambda$。\n\n决策变量向量为 $\\mathbf{x} = [N_1, \\dots, N_m, \\lambda]^\\top$。\n\n目标函数是最小化 $\\mathbf{c}^\\top \\mathbf{x}$，其中 $\\mathbf{c} = [0, \\dots, 0, -1]^\\top$。\n\n约束如下：\n- **等式约束**：平衡方程可以重写为一个齐次线性方程组：\n$$ \\mathbf{B}_{\\mathcal{F}}\\mathbf{N} + \\lambda \\mathbf{p}_{0,\\mathcal{F}} = \\mathbf{0} \\implies [\\mathbf{B}_{\\mathcal{F}} \\quad \\mathbf{p}_{0,\\mathcal{F}}] \\begin{bmatrix} \\mathbf{N} \\\\ \\lambda \\end{bmatrix} = \\mathbf{0} $$\n这采用标准形式 $\\mathbf{A}_{eq} \\mathbf{x} = \\mathbf{b}_{eq}$，其中 $\\mathbf{A}_{eq} = [\\mathbf{B}_{\\mathcal{F}} \\quad \\mathbf{p}_{0,\\mathcal{F}}]$ 且 $\\mathbf{b}_{eq}$ 是一个大小等于自由自由度数量的零向量。\n\n- **边界约束**：屈服条件 $|N_i| \\le N_{y,i}$ 等价于箱式约束：$-N_{y,i} \\le N_i \\le N_{y,i}$。荷载因子的非负性提供了一个单边边界：$\\lambda \\ge 0$。这些被指定为决策变量的边界：\n    - 对于 $x_i = N_i$：边界为 $[-N_{y,i}, N_{y,i}]$。\n    - 对于 $x_{m+1} = \\lambda$：边界为 $[0, \\infty)$。\n\n求解过程按算法实现如下：\n1.  **构建平衡矩阵 $\\mathbf{B}$**：对于一个有 $n$ 个节点和 $m$ 个杆件的桁架，$\\mathbf{B}$ 是一个 $2n \\times m$ 的矩阵。对于每个连接节点 $a$ 到节点 $b$ 的杆件 $i$，我们计算其方向向量 $\\mathbf{t}_i = (c_i, s_i)$。$\\mathbf{B}$ 的第 $i$ 列包含杆件 $i$ 对节点的力贡献。根据问题陈述，对节点 $a$ 的力贡献为 $N_i \\mathbf{t}_i$，对节点 $b$ 为 $-N_i\\mathbf{t}_i$。因此，列 $i$ 的第 $2a$ 行和第 $2a+1$ 行分别是 $c_i$ 和 $s_i$，第 $2b$ 行和第 $2b+1$ 行分别是 $-c_i$ 和 $-s_i$。列 $i$ 中的所有其他元素均为零。\n\n2.  **识别自由自由度**：我们为所有 $2n$ 个自由度构建一个布尔掩码。最初，所有自由度都标记为自由。然后，我们遍历给定的支座条件，将相应的自由度标记为受约束（非自由）。自由自由度的索引集合是 $\\mathcal{F}$。\n\n3.  **建立LP模型**：使用 $\\mathcal{F}$ 中的索引，我们从 $\\mathbf{B}$ 中提取子矩阵 $\\mathbf{B}_{\\mathcal{F}}$，从 $\\mathbf{p}_0$ 中提取子向量 $\\mathbf{p}_{0,\\mathcal{F}}$。然后，我们构造目标向量 $\\mathbf{c}$、等式约束矩阵 $\\mathbf{A}_{eq}$ 和向量 $\\mathbf{b}_{eq}$，以及每个变量的边界列表。\n\n4.  **求解LP**：使用一个数值求解器，如 `scipy.optimize.linprog`，来求解已建立的LP问题。求解器返回决策变量的最优值，存于向量 $\\mathbf{x}^\\star = [N_1^\\star, \\dots, N_m^\\star, \\lambda^\\star]^\\top$ 中。所需结果是最后一个元素 $\\lambda^\\star$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    Solves the four truss limit analysis problems specified in the problem statement.\n    \"\"\"\n    test_cases = [\n        {\n            \"nodes\": [(0, 0), (2, 0), (1, 1)],\n            \"members\": [(0, 2), (2, 1)],\n            \"supports\": {0: ('u_x', 'u_y'), 1: ('u_x', 'u_y')},\n            \"capacities\": [100.0, 100.0],\n            \"p0\": [0, 0, 0, 0, 0, -1.0],\n        },\n        {\n            \"nodes\": [(0, 0), (0, 1)],\n            \"members\": [(0, 1)],\n            \"supports\": {0: ('u_x', 'u_y')},\n            \"capacities\": [100.0],\n            \"p0\": [0, 0, 1.0, 0],\n        },\n        {\n            \"nodes\": [(0, 0), (2, 0), (1, 1)],\n            \"members\": [(0, 2), (2, 1)],\n            \"supports\": {0: ('u_x', 'u_y'), 1: ('u_x', 'u_y')},\n            \"capacities\": [80.0, 200.0],\n            \"p0\": [0, 0, 0, 0, 0, -1.0],\n        },\n        {\n            \"nodes\": [(0, 0), (2, 0), (1, 1)],\n            \"members\": [(0, 2), (2, 1), (0, 1)],\n            \"supports\": {0: ('u_x', 'u_y'), 1: ('u_x', 'u_y')},\n            \"capacities\": [200.0, 200.0, 100.0],\n            \"p0\": [0, 0, 0, 0, 0, -1.0],\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        lambda_star = solve_truss_instance(case)\n        results.append(f\"{lambda_star:.6f}\")\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\ndef solve_truss_instance(data):\n    \"\"\"\n    Solves a single truss limit analysis instance.\n\n    Args:\n        data (dict): A dictionary containing the truss definition.\n\n    Returns:\n        float: The optimal load factor lambda_star.\n    \"\"\"\n    nodes = data[\"nodes\"]\n    members = data[\"members\"]\n    supports = data[\"supports\"]\n    capacities = data[\"capacities\"]\n    p0 = data[\"p0\"]\n\n    n = len(nodes)\n    m = len(members)\n    num_dofs = 2 * n\n\n    # Step 1: Build the equilibrium matrix B\n    B = np.zeros((num_dofs, m))\n    for i, member in enumerate(members):\n        a, b = member\n        node_a_coords = np.array(nodes[a])\n        node_b_coords = np.array(nodes[b])\n\n        delta = node_b_coords - node_a_coords\n        L = np.linalg.norm(delta)\n        \n        if L > 1e-9:\n            t = delta / L\n        else:\n            t = np.zeros(2)\n\n        # As per problem: +t_i for node a, -t_i for node b\n        B[2 * a : 2 * a + 2, i] = -t\n        B[2 * b : 2 * b + 2, i] = t\n\n    # Step 2: Identify free degrees of freedom\n    dof_is_free = np.ones(num_dofs, dtype=bool)\n    for node_idx, restrained_dofs in supports.items():\n        if 'u_x' in restrained_dofs:\n            dof_is_free[2 * node_idx] = False\n        if 'u_y' in restrained_dofs:\n            dof_is_free[2 * node_idx + 1] = False\n    \n    free_dof_indices = np.where(dof_is_free)[0]\n\n    if free_dof_indices.size == 0:\n        return 0.0\n\n    # Step 3: Reformulate for linprog\n    # Equilibrium: A_F*N + p_F = 0, where A is the assembly matrix and p = lambda*p0\n    # A_F is our B[free_dof_indices, :]\n    A_F = B[free_dof_indices, :]\n    p0_F = np.array(p0)[free_dof_indices]\n\n    # Objective: maximize lambda -> minimize -lambda\n    # Variables: [N_1, ..., N_m, lambda]\n    c = np.zeros(m + 1)\n    c[-1] = -1\n\n    # Equality constraints: A_F * N + lambda * p0_F = 0\n    # [A_F, p0_F] * [N; lambda] = 0\n    A_eq = np.hstack([A_F, p0_F.reshape(-1, 1)])\n    b_eq = np.zeros(len(free_dof_indices))\n\n    # Bounds: -N_y = N = N_y, lambda >= 0\n    bounds = [(-cap, cap) for cap in capacities]\n    bounds.append((0, None))  # lambda >= 0\n\n    # Step 4: Solve the LP\n    res = linprog(c=c, A_eq=A_eq, b_eq=b_eq, bounds=bounds, method='highs')\n\n    if res.success:\n        lambda_star = res.x[-1]\n    else:\n        lambda_star = 0.0\n\n    return lambda_star\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}