{
    "hands_on_practices": [
        {
            "introduction": "塑性流动的方向由塑性势函数 $g$ 相对于应力 $\\boldsymbol{\\sigma}$ 的梯度 $\\partial g / \\partial \\boldsymbol{\\sigma}$ 决定，这是非关联流动法则的核心。本练习旨在通过推导广泛应用的Drucker-Prager模型中的塑性流动方向，提供张量微积分的基础实践。掌握这一核心数学技能对于深入理解和应用塑性理论至关重要。",
            "id": "2616095",
            "problem": "考虑一个三维各向同性弹塑性固体，其塑性流动由Drucker-Prager型塑性势 $g(\\boldsymbol{\\sigma})=\\sqrt{J_2}+\\beta I_1$ 控制，其中 $J_2=\\tfrac{1}{2}\\boldsymbol{s}:\\boldsymbol{s}$ 是偏应力第二不变量，$I_1=\\operatorname{tr}\\boldsymbol{\\sigma}$ 是应力第一不变量，$\\boldsymbol{s}=\\boldsymbol{\\sigma}-\\tfrac{1}{3}I_1\\boldsymbol{I}$ 是偏应力，$\\boldsymbol{I}$ 是二阶单位张量。符号 $:$ 表示张量的弗罗贝尼乌斯内积，弗罗贝尼乌斯范数定义为 $\\|\\boldsymbol{A}\\|=\\sqrt{\\boldsymbol{A}:\\boldsymbol{A}}$。假设 $J_20$。\n\n对于由 $g$ 生成的非关联流动法则，塑性流动方向定义为单位张量\n$$\n\\boldsymbol{n}_g=\\frac{\\dfrac{\\partial g}{\\partial\\boldsymbol{\\sigma}}}{\\left\\|\\dfrac{\\partial g}{\\partial\\boldsymbol{\\sigma}}\\right\\|},\n$$\n其中梯度 $\\dfrac{\\partial g}{\\partial\\boldsymbol{\\sigma}}$ 是关于 $\\boldsymbol{\\sigma}$ 求取的，其意义在于，对于任何容许的应力变分 $\\delta\\boldsymbol{\\sigma}$，都有 $\\delta g=\\dfrac{\\partial g}{\\partial\\boldsymbol{\\sigma}}:\\delta\\boldsymbol{\\sigma}$。\n\n从上述定义和连续介质力学中的标准张量微积分出发，推导 $\\boldsymbol{n}_g$ 的闭式表达式，用 $\\boldsymbol{s}$、$J_2$、$\\beta$ 和 $\\boldsymbol{I}$ 表示。将你的最终结果以单一的解析张量表达式形式给出。无需进行数值计算，也无需四舍五入。",
            "solution": "所提出的问题是连续介质塑性理论中的一个标准练习，它是适定的、有科学依据且客观的。它要求推导一种由Drucker-Prager塑性势控制的材料的塑性流动方向单位张量 $\\boldsymbol{n}_g$。所有定义和条件都已给出，并与既有文献一致。因此，将提供一个解答。\n\n目标是计算单位张量 $\\boldsymbol{n}_g$ 的表达式，其定义为：\n$$\n\\boldsymbol{n}_g = \\frac{\\dfrac{\\partial g}{\\partial\\boldsymbol{\\sigma}}}{\\left\\|\\dfrac{\\partial g}{\\partial\\boldsymbol{\\sigma}}\\right\\|}\n$$\n推导过程分为两个逻辑步骤：首先，确定塑性势的梯度 $\\frac{\\partial g}{\\partial\\boldsymbol{\\sigma}}$；其次，计算其弗罗贝尼乌斯范数。\n\n塑性势函数由 $g(\\boldsymbol{\\sigma}) = \\sqrt{J_2} + \\beta I_1$ 给出。\n我们应用链式法则对张量变量 $\\boldsymbol{\\sigma}$ 进行微分：\n$$\n\\frac{\\partial g}{\\partial\\boldsymbol{\\sigma}} = \\frac{\\partial g}{\\partial J_2} \\frac{\\partial J_2}{\\partial\\boldsymbol{\\sigma}} + \\frac{\\partial g}{\\partial I_1} \\frac{\\partial I_1}{\\partial\\boldsymbol{\\sigma}}\n$$\n我们必须计算这个表达式的每个分量。$g$ 关于不变量 $J_2$ 和 $I_1$ 的偏导数直接可得：\n$$\n\\frac{\\partial g}{\\partial J_2} = \\frac{\\partial}{\\partial J_2}(\\sqrt{J_2} + \\beta I_1) = \\frac{1}{2\\sqrt{J_2}}\n$$\n这是良定义的，因为问题指定了 $J_2 > 0$。\n$$\n\\frac{\\partial g}{\\partial I_1} = \\frac{\\partial}{\\partial I_1}(\\sqrt{J_2} + \\beta I_1) = \\beta\n$$\n接下来，我们需要应力不变量 $I_1$ 和 $J_2$ 关于柯西应力张量 $\\boldsymbol{\\sigma}$ 的梯度。这些是张量微积分中的基本关系。\n对于第一不变量，$I_1 = \\operatorname{tr}(\\boldsymbol{\\sigma}) = \\boldsymbol{\\sigma} : \\boldsymbol{I}$。其变分为 $\\delta I_1 = \\delta\\boldsymbol{\\sigma} : \\boldsymbol{I}$。根据张量梯度的定义 $\\delta I_1 = \\frac{\\partial I_1}{\\partial\\boldsymbol{\\sigma}}:\\delta\\boldsymbol{\\sigma}$，我们立即可以确定：\n$$\n\\frac{\\partial I_1}{\\partial\\boldsymbol{\\sigma}} = \\boldsymbol{I}\n$$\n对于偏应力第二不变量，$J_2 = \\frac{1}{2}\\boldsymbol{s}:\\boldsymbol{s}$，我们首先表达其变分。回顾 $\\boldsymbol{s} = \\boldsymbol{\\sigma} - \\frac{1}{3}I_1\\boldsymbol{I}$，我们求得 $J_2$ 的变分：\n$$\n\\delta J_2 = \\boldsymbol{s} : \\delta\\boldsymbol{s} = \\boldsymbol{s} : \\left( \\delta\\boldsymbol{\\sigma} - \\frac{1}{3}(\\delta I_1)\\boldsymbol{I} \\right) = \\boldsymbol{s} : \\delta\\boldsymbol{\\sigma} - \\frac{1}{3}\\delta I_1 (\\boldsymbol{s} : \\boldsymbol{I})\n$$\n偏应力张量的一个关键性质是它的迹为零，即 $\\operatorname{tr}(\\boldsymbol{s}) = \\boldsymbol{s} : \\boldsymbol{I} = 0$。因此，第二项消失，剩下：\n$$\n\\delta J_2 = \\boldsymbol{s} : \\delta\\boldsymbol{\\sigma}\n$$\n从定义 $\\delta J_2 = \\frac{\\partial J_2}{\\partial\\boldsymbol{\\sigma}}:\\delta\\boldsymbol{\\sigma}$，我们推断出：\n$$\n\\frac{\\partial J_2}{\\partial\\boldsymbol{\\sigma}} = \\boldsymbol{s}\n$$\n将这些梯度代回到 $\\frac{\\partial g}{\\partial\\boldsymbol{\\sigma}}$ 的表达式中，得到 $\\boldsymbol{n}_g$ 的分子：\n$$\n\\frac{\\partial g}{\\partial\\boldsymbol{\\sigma}} = \\left(\\frac{1}{2\\sqrt{J_2}}\\right)\\boldsymbol{s} + (\\beta)\\boldsymbol{I}\n$$\n现在，我们必须计算这个梯度张量的弗罗贝尼乌斯范数，它是 $\\boldsymbol{n}_g$ 的分母。范数由 $\\|\\boldsymbol{A}\\| = \\sqrt{\\boldsymbol{A}:\\boldsymbol{A}}$ 给出。令 $\\boldsymbol{A} = \\frac{\\partial g}{\\partial\\boldsymbol{\\sigma}}$。\n$$\n\\left\\|\\frac{\\partial g}{\\partial\\boldsymbol{\\sigma}}\\right\\|^2 = \\left( \\frac{1}{2\\sqrt{J_2}}\\boldsymbol{s} + \\beta\\boldsymbol{I} \\right) : \\left( \\frac{1}{2\\sqrt{J_2}}\\boldsymbol{s} + \\beta\\boldsymbol{I} \\right)\n$$\n利用内积的双线性性展开：\n$$\n\\left\\|\\frac{\\partial g}{\\partial\\boldsymbol{\\sigma}}\\right\\|^2 = \\left(\\frac{1}{2\\sqrt{J_2}}\\right)^2 (\\boldsymbol{s}:\\boldsymbol{s}) + 2\\left(\\frac{1}{2\\sqrt{J_2}}\\right)\\beta(\\boldsymbol{s}:\\boldsymbol{I}) + \\beta^2(\\boldsymbol{I}:\\boldsymbol{I})\n$$\n我们计算每个张量积：\n1.  根据定义，$J_2 = \\frac{1}{2}\\boldsymbol{s}:\\boldsymbol{s}$，所以 $\\boldsymbol{s}:\\boldsymbol{s} = 2J_2$。\n2.  如前所述，偏应力的迹为零：$\\boldsymbol{s}:\\boldsymbol{I} = \\operatorname{tr}(\\boldsymbol{s}) = 0$。\n3.  对于三维空间，单位张量与自身的内积是 $\\boldsymbol{I}:\\boldsymbol{I} = \\operatorname{tr}(\\boldsymbol{I}) = 3$。\n\n将这些结果代入范数平方的方程中：\n$$\n\\left\\|\\frac{\\partial g}{\\partial\\boldsymbol{\\sigma}}\\right\\|^2 = \\frac{1}{4J_2}(2J_2) + \\frac{\\beta}{\\sqrt{J_2}}(0) + \\beta^2(3) = \\frac{1}{2} + 3\\beta^2\n$$\n取平方根得到范数：\n$$\n\\left\\|\\frac{\\partial g}{\\partial\\boldsymbol{\\sigma}}\\right\\| = \\sqrt{\\frac{1}{2} + 3\\beta^2}\n$$\n最后，我们通过将梯度除以其范数来组合出 $\\boldsymbol{n}_g$ 的表达式。这就得到了用指定变量表示的最终闭式表达式，它代表了主应力空间中塑性应变增量的方向。\n$$\n\\boldsymbol{n}_g = \\frac{\\frac{1}{2\\sqrt{J_2}}\\boldsymbol{s} + \\beta\\boldsymbol{I}}{\\sqrt{\\frac{1}{2} + 3\\beta^2}}\n$$\n这个表达式是所提出问题的完整且正确的答案。",
            "answer": "$$\n\\boxed{\\frac{\\frac{1}{2\\sqrt{J_2}}\\boldsymbol{s} + \\beta\\boldsymbol{I}}{\\sqrt{\\frac{1}{2} + 3\\beta^2}}}\n$$"
        },
        {
            "introduction": "在上一练习的基础上，我们现在考虑一个更复杂的场景：一个非光滑的屈服面，例如Mohr-Coulomb模型。许多描述土壤和岩石等材料的实际模型都包含角点，本练习将演示当多个屈服面同时被激活时如何确定流动方向。此练习突出了关联流动法则对摩擦材料的一个关键影响：剪胀性（dilatancy）。",
            "id": "2616101",
            "problem": "一个黏聚-摩擦连续体，使用各向同性理想塑性Mohr–Coulomb材料进行建模，在小应变条件下承受轴对称三轴压缩荷载。采用岩土力学符号约定，即压应力和压应变取为正值。Cauchy应力张量在主坐标系中是对角的，其主值由 $\\boldsymbol{\\sigma}=\\operatorname{diag}(\\sigma_{1},\\sigma_{3},\\sigma_{3})$ 给出，且 $\\sigma_{1}\\ge \\sigma_{3}\\ge 0$。假设采用相关联流动法则，且塑性流动与应力共轴。\n\n在主应力空间中，使用Mohr–Coulomb屈服面的标准多面表示法。对于由有序主应力对 $(i,j)$ 激活的平面，其中 $i$ 是该平面的最大主应力，$j$ 是最小主应力，其屈服函数为\n$$\nf_{ij}(\\boldsymbol{\\sigma}) \\equiv \\sigma_{i}-\\sigma_{j}-(\\sigma_{i}+\\sigma_{j})\\sin\\varphi-2c\\cos\\varphi,\n$$\n其中 $\\varphi$ 是摩擦角，$c$ 是黏聚力。在轴对称三轴压缩条件下，当 $\\sigma_{2}=\\sigma_{3}$ 时，$(1,2)$-平面和 $(1,3)$-平面会同时激活。设相应的塑性乘子为 $\\dot{\\lambda}_{2}\\ge 0$ 和 $\\dot{\\lambda}_{3}\\ge 0$。\n\n仅从以下三点出发：(i) 相关联流动法则，即 $\\dot{\\boldsymbol{\\varepsilon}}^{p}=\\sum_{k}\\dot{\\lambda}_{k}\\,\\partial f_{k}/\\partial\\boldsymbol{\\sigma}$，其中求和遍历当前所有激活的屈服面；(ii) 上述Mohr–Coulomb屈服函数的主平面形式；以及 (iii) 轴对称状态下的对称性要求（即侧向塑性应变率必须相等），推导塑性流动方向的主分量和体积塑性应变率。请按如下方式报告你的答案：\n\n- 将塑性流动方向定义为由单个标量塑性乘子归一化的塑性应变率，即 $m_{i}\\equiv \\dot{\\varepsilon}^{p}_{i}/\\dot{\\lambda}$，其中 $\\dot{\\lambda}$ 是轴对称状态下激活的塑性乘子的共同值，你必须从基本原理出发确定该值。\n- 将体积塑性应变率定义为 $\\dot{\\varepsilon}_{v}^{p}\\equiv \\dot{\\varepsilon}^{p}_{1}+\\dot{\\varepsilon}^{p}_{2}+\\dot{\\varepsilon}^{p}_{3}$，并报告其经 $\\dot{\\lambda}$ 归一化后的值，即 $\\dot{\\varepsilon}_{v}^{p}/\\dot{\\lambda}$。\n\n将你的最终结果表示为仅含 $\\varphi$ 的闭合形式单行向量 $(m_{1},\\,m_{2},\\,m_{3},\\,\\dot{\\varepsilon}_{v}^{p}/\\dot{\\lambda})$。无需进行数值计算，最终报告的向量中不包含单位。",
            "solution": "我们在主坐标系下进行计算，其中 $\\boldsymbol{\\sigma}=\\operatorname{diag}(\\sigma_{1},\\sigma_{2},\\sigma_{3})$，且 $\\sigma_{2}=\\sigma_{3}$ 和 $\\sigma_{1}\\ge \\sigma_{3}$。Mohr–Coulomb屈服面在主应力空间中是分段线性的，其平面由下式定义\n$$\nf_{ij}(\\boldsymbol{\\sigma})=\\sigma_{i}-\\sigma_{j}-(\\sigma_{i}+\\sigma_{j})\\sin\\varphi-2c\\cos\\varphi,\n$$\n每当 $(i,j)$ 是控制破坏的最大-最小主应力对时，该平面就被激活。在轴对称三轴压缩中，由于 $\\sigma_{2}=\\sigma_{3}$ 为共同的次主应力，因此 $f_{12}$ 和 $f_{13}$ 同时被激活。\n\n根据相关联流动法则，塑性应变率张量是激活的屈服函数的梯度经其塑性乘子加权后的和：\n$$\n\\dot{\\boldsymbol{\\varepsilon}}^{p}=\\dot{\\lambda}_{2}\\,\\frac{\\partial f_{12}}{\\partial\\boldsymbol{\\sigma}}+\\dot{\\lambda}_{3}\\,\\frac{\\partial f_{13}}{\\partial\\boldsymbol{\\sigma}}.\n$$\n由于我们在主坐标系中，并且流动是共轴的，我们只需要梯度向量的主分量。对于给定的平面 $f_{1j}$，对其关于主应力求导可得\n$$\n\\frac{\\partial f_{1j}}{\\partial \\sigma_{1}}=1-\\sin\\varphi,\\qquad \\frac{\\partial f_{1j}}{\\partial \\sigma_{j}}=-(1+\\sin\\varphi),\\qquad \\frac{\\partial f_{1j}}{\\partial \\sigma_{k}}=0\\ \\text{for}\\ k\\notin\\{1,j\\}.\n$$\n因此，组合两个激活平面 $(1,2)$ 和 $(1,3)$，可得到主塑性应变率：\n\\begin{align*}\n\\dot{\\varepsilon}^{p}_{1}=\\dot{\\lambda}_{2}(1-\\sin\\varphi)+\\dot{\\lambda}_{3}(1-\\sin\\varphi)=(\\dot{\\lambda}_{2}+\\dot{\\lambda}_{3})(1-\\sin\\varphi),\\\\\n\\dot{\\varepsilon}^{p}_{2}=\\dot{\\lambda}_{2}\\bigl(-(1+\\sin\\varphi)\\bigr)+\\dot{\\lambda}_{3}\\cdot 0=-\\dot{\\lambda}_{2}(1+\\sin\\varphi),\\\\\n\\dot{\\varepsilon}^{p}_{3}=\\dot{\\lambda}_{2}\\cdot 0+\\dot{\\lambda}_{3}\\bigl(-(1+\\sin\\varphi)\\bigr)=-\\dot{\\lambda}_{3}(1+\\sin\\varphi).\n\\end{align*}\n轴对称性要求侧向塑性应变率相等，即 $\\dot{\\varepsilon}^{p}_{2}=\\dot{\\varepsilon}^{p}_{3}$。根据上述结果，该要求意味着\n$$\n-\\dot{\\lambda}_{2}(1+\\sin\\varphi)=-\\dot{\\lambda}_{3}(1+\\sin\\varphi)\\quad\\Longrightarrow\\quad \\dot{\\lambda}_{2}=\\dot{\\lambda}_{3}.\n$$\n将这个共同值定义为 $\\dot{\\lambda}$：\n$$\n\\dot{\\lambda}_{2}=\\dot{\\lambda}_{3}=\\dot{\\lambda}.\n$$\n代回后，主塑性应变率简化为\n\\begin{align*}\n\\dot{\\varepsilon}^{p}_{1}=2\\dot{\\lambda}(1-\\sin\\varphi),\\\\\n\\dot{\\varepsilon}^{p}_{2}=-\\dot{\\lambda}(1+\\sin\\varphi),\\\\\n\\dot{\\varepsilon}^{p}_{3}=-\\dot{\\lambda}(1+\\sin\\varphi).\n\\end{align*}\n塑性流动方向定义为由 $\\dot{\\lambda}$ 归一化的塑性应变率，即 $m_{i}\\equiv \\dot{\\varepsilon}^{p}_{i}/\\dot{\\lambda}$。因此\n$$\nm_{1}=2(1-\\sin\\varphi),\\qquad m_{2}=-(1+\\sin\\varphi),\\qquad m_{3}=-(1+\\sin\\varphi).\n$$\n体积塑性应变率是塑性应变率张量的迹，\n$$\n\\dot{\\varepsilon}^{p}_{v}=\\dot{\\varepsilon}^{p}_{1}+\\dot{\\varepsilon}^{p}_{2}+\\dot{\\varepsilon}^{p}_{3}=2\\dot{\\lambda}(1-\\sin\\varphi)-\\dot{\\lambda}(1+\\sin\\varphi)-\\dot{\\lambda}(1+\\sin\\varphi).\n$$\n简化后，\n\\begin{align*}\n\\dot{\\varepsilon}^{p}_{v}=2\\dot{\\lambda}(1-\\sin\\varphi)-2\\dot{\\lambda}(1+\\sin\\varphi)=2\\dot{\\lambda}\\bigl[(1-\\sin\\varphi)-(1+\\sin\\varphi)\\bigr]\\\\\n=2\\dot{\\lambda}\\bigl(-2\\sin\\varphi\\bigr)=-4\\dot{\\lambda}\\sin\\varphi.\n\\end{align*}\n因此，经 $\\dot{\\lambda}$ 归一化后，体积塑性应变为\n$$\n\\frac{\\dot{\\varepsilon}^{p}_{v}}{\\dot{\\lambda}}=-4\\sin\\varphi.\n$$\n在所采用的符号约定（压缩为正）下，对于 $\\varphi0$，该值为负，反映了在三轴压缩下由剪切主导的塑性流动引起的剪胀体积膨胀。\n\n汇总所要求的结果，行向量 $(m_{1},\\,m_{2},\\,m_{3},\\,\\dot{\\varepsilon}_{v}^{p}/\\dot{\\lambda})$ 为\n$$\n\\bigl(2(1-\\sin\\varphi),\\,-(1+\\sin\\varphi),\\,-(1+\\sin\\varphi),\\,-4\\sin\\varphi\\bigr).\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}2\\left(1-\\sin\\varphi\\right)  -\\left(1+\\sin\\varphi\\right)  -\\left(1+\\sin\\varphi\\right)  -4\\sin\\varphi\\end{pmatrix}}$$"
        },
        {
            "introduction": "我们将从解析推导过渡到计算实践，因为现代固体力学高度依赖于数值方法。最后一个练习将实现一个返回映射算法（return mapping algorithm），这是计算塑性学的基石，适用于关联和非关联的Drucker-Prager模型。通过这项实践，您将具体了解流动法则的选择如何影响预测的应力状态，并能量化关联与非关联预测之间的差异。",
            "id": "2616066",
            "problem": "考虑一个处于平面应变状态下的各向同性、线性弹性、小应变固体，其遵循 Drucker–Prager 屈服准则和线性各向同性硬化。设总小应变张量用 $\\boldsymbol{\\varepsilon}$ 表示，并假设为平面应变，因此 $\\varepsilon_{zz}=0$ 且 $\\varepsilon_{xz}=\\varepsilon_{yz}=0$。Cauchy 应力张量 $\\boldsymbol{\\sigma}$ 分解为 $\\boldsymbol{\\sigma}=\\boldsymbol{s}-p \\boldsymbol{I}$，其中平均应力 $p= -\\tfrac{1}{3} \\operatorname{tr}(\\boldsymbol{\\sigma})$ (压为正)，偏应力为 $\\boldsymbol{s}$，其第二不变量度量为 $q=\\sqrt{3 J_{2}}=\\sqrt{\\tfrac{3}{2}} \\lVert \\boldsymbol{s} \\rVert$。各向同性线弹性定律为 $\\boldsymbol{\\sigma} = 2 G \\operatorname{dev}(\\boldsymbol{\\varepsilon}-\\boldsymbol{\\varepsilon}^{p}) + 3 K \\operatorname{mean}(\\boldsymbol{\\varepsilon}-\\boldsymbol{\\varepsilon}^{p}) \\boldsymbol{I}$，其中剪切模量 $G = \\dfrac{E}{2(1+\\nu)}$，体积模量 $K = \\dfrac{E}{3(1-2\\nu)}$，$E$ 是杨氏模量，$\\nu$ 是泊松比，$\\operatorname{mean}(\\cdot)$ 表示迹的三分之一。带有线性各向同性硬化的 Drucker–Prager 屈服函数为\n$$\nf(\\boldsymbol{\\sigma},\\kappa) \\;=\\; q + \\alpha\\, p \\;-\\; \\left( \\sigma_{y0} + H \\kappa \\right),\n$$\n其中 $\\sigma_{y0}$ 是初始屈服应力，$H$ 是硬化模量，$\\alpha$ 是摩擦参数，$\\kappa$ 是硬化变量。对于相关联流动，塑性势等于屈服函数；而对于非相关联流动，塑性势为\n$$\ng(\\boldsymbol{\\sigma}) \\;=\\; q + \\alpha_{\\psi}\\, p,\n$$\n其中 $\\alpha_{\\psi}$ 是剪胀参数 (通常 $\\alpha_{\\psi}\\neq \\alpha$)。流动法则是 $\\mathrm{d}\\boldsymbol{\\varepsilon}^{p} = \\mathrm{d}\\gamma \\,\\dfrac{\\partial g}{\\partial \\boldsymbol{\\sigma}}$，其中塑性乘子 $\\mathrm{d}\\gamma \\ge 0$ 在塑性加载期间满足 Karush–Kuhn–Tucker 条件和一致性条件 $f(\\boldsymbol{\\sigma},\\kappa)=0$，以及线性各向同性硬化 $\\kappa_{n+1}=\\kappa_{n}+\\Delta\\gamma$。\n\n在从初始无应力无应变状态开始的单个比例加载步下，使用后向欧拉弹性预测/塑性修正方法，并结合上述定义，推导并实现一个塑性返回映射，以更新相关联和非相关联流动下的应力。该加载步是比例的，意味着总应变增量 $\\Delta \\boldsymbol{\\varepsilon}$ 在一个具有固定张量方向的步骤中施加。\n\n从上面列出的基本定义和定律出发，不要假设任何不能从这些推导出的专用公式。特别地，使用以下基础：\n- 具有给定模量 $E$ 和 $\\nu$ 的各向同性线弹性。\n- 应力分解为平均和偏应力部分，其中 $p=-\\tfrac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma})$ 且 $q=\\sqrt{\\tfrac{3}{2}}\\lVert \\boldsymbol{s}\\rVert$。\n- 如上所述的 Drucker–Prager 屈服和塑性势。\n- 流动法则的后向欧拉积分，其中 $\\Delta \\boldsymbol{\\varepsilon}^{p}=\\Delta\\gamma \\dfrac{\\partial g}{\\partial \\boldsymbol{\\sigma}}$ 以及线性各向同性硬化 $\\kappa_{n+1}=\\kappa_{n}+\\Delta \\gamma$。\n\n从给定的总应变增量定义弹性试探应力 $\\boldsymbol{\\sigma}^{\\mathrm{tr}}$，其中步初 $\\boldsymbol{\\varepsilon}^{p}_{n}=\\boldsymbol{0}$。如果 $f(\\boldsymbol{\\sigma}^{\\mathrm{tr}},0)\\le 0$，则该步是弹性的，更新后的应力等于试探应力。否则，计算以下情况的更新后应力：\n- 相关联流动：在塑性势中使用 $\\alpha_{\\psi}=\\alpha$。\n- 非相关联流动：使用一个可能不同于 $\\alpha$ 的给定 $\\alpha_{\\psi}$。\n\n对于每种情况，将应力修正误差范数定义为塑性修正的 Frobenius 范数，即\n$$\n\\lVert \\Delta \\boldsymbol{\\sigma}\\rVert_{F} \\;=\\; \\left\\lVert \\boldsymbol{\\sigma}^{\\mathrm{tr}} \\;-\\; \\boldsymbol{\\sigma}_{n+1} \\right\\rVert_{F},\n$$\n单位为兆帕 (MPa)。报告相关联和非相关联更新的此范数。\n\n需注意的实现细节：\n- 一致地使用压为正的平均应力约定 $p= -\\tfrac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma})$。\n- 如上所述，使用带有 $\\Delta \\boldsymbol{\\varepsilon}^{p}=\\Delta\\gamma \\dfrac{\\partial g}{\\partial \\boldsymbol{\\sigma}}$ 和 $\\kappa$ 中线性各向同性硬化的后向欧拉更新。\n- 对于平面应变，设置 $\\varepsilon_{zz}=0$ 并初始化 $\\varepsilon_{xz}=\\varepsilon_{yz}=0$。\n- 将输入的剪切分量 $\\gamma_{xy}$ 解释为工程剪切应变，因此 $\\varepsilon_{xy}=\\gamma_{xy}/2$。\n\n测试套件。使用以下四个测试用例。对于每个用例，参数以元组形式给出\n$$\n\\left(E\\;\\text{[MPa]},\\, \\nu,\\, \\sigma_{y0}\\;\\text{[MPa]},\\, H\\;\\text{[MPa]},\\, \\alpha,\\, \\alpha_{\\psi},\\, \\varepsilon_{xx},\\, \\varepsilon_{yy},\\, \\gamma_{xy}\\right),\n$$\n其中 $\\varepsilon_{zz}=0$ 且所有应变均为无量纲：\n1. $\\left(30000,\\, 0.25,\\, 100,\\, 500,\\, 0.2,\\, 0.05,\\, 0.0,\\, 0.0,\\, 0.001\\right)$。\n2. $\\left(30000,\\, 0.25,\\, 100,\\, 500,\\, 0.2,\\, 0.05,\\, 0.0,\\, 0.0,\\, 0.01\\right)$。\n3. $\\left(30000,\\, 0.25,\\, 100,\\, 500,\\, 0.2,\\, 0.05,\\, -0.006,\\, -0.006,\\, 0.0\\right)$。\n4. $\\left(30000,\\, 0.25,\\, 100,\\, 500,\\, 0.2,\\, 0.05,\\, 0.0,\\, 0.0,\\, 0.0048\\right)$。\n\n你的程序必须：\n- 为每个测试用例实现上述针对相关联和非相关联流动的更新。\n- 对每个测试用例，计算两个以兆帕 (MPa) 为单位的标量输出：相关联更新的修正范数和非相关联更新的修正范数。\n- 生成单行输出，包含一个有四个元素的列表，每个元素对应一个测试用例，其中每个元素是一个包含相关联和非相关联修正范数的双元素列表。所有浮点数以 MPa 为单位，四舍五入到六位小数。例如，一个有效的最终格式是\n$[ [a_{1},b_{1}], [a_{2},b_{2}], [a_{3},b_{3}], [a_{4},b_{4}] ]$\n其中每个 $a_{i}$ 和 $b_{i}$ 是小数点后有六位数字的浮点数。",
            "solution": "问题陈述经核实科学上合理、适定、客观且完整。它描述了计算塑性力学理论中的一个标准问题——在平面应变条件下实现 Drucker–Prager 屈服准则的返回映射算法。所有必要的参数和条件都已提供，没有矛盾或模糊之处。因此，我将继续进行推导和求解。\n\n目标是为一个具有 Drucker–Prager 塑性和线性各向同性硬化的各向同性线弹性材料，推导并实现一个后向欧拉弹性预测/塑性修正算法。该更新考虑了从初始无应力无应变状态开始的单个比例应变增量 $\\Delta\\boldsymbol{\\varepsilon}$。\n\n基本控制方程如下：\n1.  **应变加法分解**: $\\boldsymbol{\\varepsilon} = \\boldsymbol{\\varepsilon}^e + \\boldsymbol{\\varepsilon}^p$，其中 $\\boldsymbol{\\varepsilon}^e$ 和 $\\boldsymbol{\\varepsilon}^p$ 分别是弹性和塑性应变张量。\n2.  **各向同性线弹性**: $\\boldsymbol{\\sigma} = \\mathbb{C}:\\boldsymbol{\\varepsilon}^e = 2G\\,\\operatorname{dev}(\\boldsymbol{\\varepsilon}^e) + K\\,\\operatorname{tr}(\\boldsymbol{\\varepsilon}^e)\\boldsymbol{I}$。使用压为正的平均应力定义 $p = -\\frac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma})$ 和相应的体积应变定义 $\\varepsilon_v = \\operatorname{tr}(\\boldsymbol{\\varepsilon})$，弹性定律可以对偏应力 $\\boldsymbol{s}$ 和平均应力 $p$ 写为 $\\boldsymbol{s} = 2G \\boldsymbol{e}^e$ 和 $p = -K \\varepsilon_v^e$，其中 $\\boldsymbol{e}^e = \\operatorname{dev}(\\boldsymbol{\\varepsilon}^e)$ 且 $\\varepsilon_v^e = \\operatorname{tr}(\\boldsymbol{\\varepsilon}^e)$。\n3.  **Drucker–Prager 屈服函数**: $f(\\boldsymbol{\\sigma}, \\kappa) = q + \\alpha p - (\\sigma_{y0} + H\\kappa) = 0$，其中 $q = \\sqrt{\\frac{3}{2}\\boldsymbol{s}:\\boldsymbol{s}}$ 是 von Mises 等效应力，$p$ 是平均应力，$\\alpha$ 是摩擦参数，$\\sigma_{y0}$ 是初始屈服应力，$H$ 是硬化模量，$\\kappa$ 是各向同性硬化变量。\n4.  **塑性势**: $g(\\boldsymbol{\\sigma}) = q + \\alpha_{\\psi} p$，其中 $\\alpha_{\\psi}$ 是剪胀参数。对于相关联流动，$\\alpha_{\\psi} = \\alpha$。\n5.  **流动法则**: 塑性应变增量由后向欧拉积分格式给出，为 $\\Delta\\boldsymbol{\\varepsilon}^p = \\Delta\\gamma \\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}}\\Big|_{\\boldsymbol{\\sigma}_{n+1}}$，其中 $\\Delta\\gamma \\ge 0$ 是塑性乘子。\n6.  **硬化法则**: 硬化变量演化为 $\\kappa_{n+1} = \\kappa_n + \\Delta\\gamma$。由于初始状态是未变形的，$\\kappa_n=0$，因此 $\\kappa_{n+1} = \\Delta\\gamma$。\n\n返回映射算法包括一个弹性预测步，如果发生屈服，则随后进行一个塑性修正步。\n\n**弹性预测**\n首先，我们假设整个应变增量 $\\Delta\\boldsymbol{\\varepsilon}$ 是弹性的。弹性试探应力，记为 $\\boldsymbol{\\sigma}^{\\mathrm{tr}}$，由总应变 $\\boldsymbol{\\varepsilon}_{n+1} = \\Delta\\boldsymbol{\\varepsilon}$ 计算得出，假设塑性应变没有变化，即 $\\Delta\\boldsymbol{\\varepsilon}^p = \\boldsymbol{0}$。\n$$\n\\boldsymbol{\\sigma}^{\\mathrm{tr}} = \\mathbb{C} : (\\boldsymbol{\\varepsilon}_{n+1} - \\boldsymbol{\\varepsilon}^p_n) = \\mathbb{C} : \\Delta\\boldsymbol{\\varepsilon}\n$$\n因为 $\\boldsymbol{\\varepsilon}^p_n = \\boldsymbol{0}$。\n这可以分解为试探平均和偏应力分量：\n$$\np^{\\mathrm{tr}} = -K \\operatorname{tr}(\\Delta\\boldsymbol{\\varepsilon})\n$$\n$$\n\\boldsymbol{s}^{\\mathrm{tr}} = 2G \\operatorname{dev}(\\Delta\\boldsymbol{\\varepsilon})\n$$\n试探等效应力为 $q^{\\mathrm{tr}} = \\sqrt{\\frac{3}{2} \\boldsymbol{s}^{\\mathrm{tr}}:\\boldsymbol{s}^{\\mathrm{tr}}}$。\n\n**屈服检查**\n我们在试探状态下使用初始硬化变量 $\\kappa_n=0$ 来评估屈服函数：\n$$\nf^{\\mathrm{tr}} = f(\\boldsymbol{\\sigma}^{\\mathrm{tr}}, 0) = q^{\\mathrm{tr}} + \\alpha p^{\\mathrm{tr}} - \\sigma_{y0}\n$$\n如果 $f^{\\mathrm{tr}} \\le 0$，则假设正确；该步是弹性的。最终应力即为试探应力，$\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}^{\\mathrm{tr}}$，应力修正为零。\n如果 $f^{\\mathrm{tr}}  0$，则状态位于屈服面之外，这是不可接受的。需要进行塑性修正，将应力状态返回到更新后的屈服面上。\n\n**塑性修正**\n最终应力 $\\boldsymbol{\\sigma}_{n+1}$ 通过考虑塑性应变增量 $\\Delta\\boldsymbol{\\varepsilon}^p$ 与试探应力相关联：\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\mathbb{C} : (\\boldsymbol{\\varepsilon}_{n+1} - \\boldsymbol{\\varepsilon}^p_{n+1}) = \\mathbb{C} : (\\boldsymbol{\\varepsilon}_{n+1} - (\\boldsymbol{\\varepsilon}^p_n + \\Delta\\boldsymbol{\\varepsilon}^p)) = \\boldsymbol{\\sigma}^{\\mathrm{tr}} - \\mathbb{C}:\\Delta\\boldsymbol{\\varepsilon}^p\n$$\n代入流动法则，$\\Delta\\boldsymbol{\\varepsilon}^p = \\Delta\\gamma \\frac{\\partial g}{\\partial\\boldsymbol{\\sigma}}\\Big|_{\\boldsymbol{\\sigma}_{n+1}}$：\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}^{\\mathrm{tr}} - \\Delta\\gamma \\, \\mathbb{C}:\\frac{\\partial g}{\\partial\\boldsymbol{\\sigma}}\\Big|_{\\boldsymbol{\\sigma}_{n+1}}\n$$\n塑性势的梯度为 $\\frac{\\partial g}{\\partial\\boldsymbol{\\sigma}} = \\frac{\\partial q}{\\partial\\boldsymbol{\\sigma}} + \\alpha_{\\psi}\\frac{\\partial p}{\\partial\\boldsymbol{\\sigma}}$。其导数为 $\\frac{\\partial q}{\\partial\\boldsymbol{\\sigma}} = \\frac{3}{2q}\\boldsymbol{s}$ 和 $\\frac{\\partial p}{\\partial\\boldsymbol{\\sigma}} = -\\frac{1}{3}\\boldsymbol{I}$。因此：\n$$\n\\frac{\\partial g}{\\partial\\boldsymbol{\\sigma}}\\Big|_{\\boldsymbol{\\sigma}_{n+1}} = \\frac{3}{2q_{n+1}}\\boldsymbol{s}_{n+1} - \\frac{\\alpha_{\\psi}}{3}\\boldsymbol{I}\n$$\n应用弹性算子 $\\mathbb{C}$ 可得：\n$$\n\\mathbb{C}:\\left( \\frac{3}{2q_{n+1}}\\boldsymbol{s}_{n+1} - \\frac{\\alpha_{\\psi}}{3}\\boldsymbol{I} \\right) = 2G\\left(\\frac{3}{2q_{n+1}}\\boldsymbol{s}_{n+1}\\right) - K\\alpha_{\\psi}\\boldsymbol{I} = \\frac{3G}{q_{n+1}}\\boldsymbol{s}_{n+1} - K\\alpha_{\\psi}\\boldsymbol{I}\n$$\n应力更新方程变为：\n$$\n\\boldsymbol{s}_{n+1} - p_{n+1}\\boldsymbol{I} = (\\boldsymbol{s}^{\\mathrm{tr}} - p^{\\mathrm{tr}}\\boldsymbol{I}) - \\Delta\\gamma\\left(\\frac{3G}{q_{n+1}}\\boldsymbol{s}_{n+1} - K\\alpha_{\\psi}\\boldsymbol{I}\\right)\n$$\n将其分离为偏量和体量部分，可得：\n$$\n\\boldsymbol{s}_{n+1} = \\boldsymbol{s}^{\\mathrm{tr}} - \\Delta\\gamma \\frac{3G}{q_{n+1}}\\boldsymbol{s}_{n+1} \\implies \\boldsymbol{s}_{n+1}\\left(1 + \\frac{3G\\Delta\\gamma}{q_{n+1}}\\right) = \\boldsymbol{s}^{\\mathrm{tr}}\n$$\n$$\np_{n+1} = p^{\\mathrm{tr}} - \\Delta\\gamma K\\alpha_{\\psi}\n$$\n从偏应力方程中，我们可以看出 $\\boldsymbol{s}_{n+1}$ 和 $\\boldsymbol{s}^{\\mathrm{tr}}$ 是共线的。对此方程取范数 $\\sqrt{\\frac{3}{2}(\\cdot):(\\cdot)}$ 可得 $q_{n+1}(1 + \\frac{3G\\Delta\\gamma}{q_{n+1}}) = q^{\\mathrm{tr}}$，简化后为：\n$$\nq_{n+1} = q^{\\mathrm{tr}} - 3G\\Delta\\gamma\n$$\n现在我们有了用未知数 $\\Delta\\gamma$ 表示的 $p_{n+1}$ 和 $q_{n+1}$ 的表达式。我们使用一致性条件 $f(\\boldsymbol{\\sigma}_{n+1}, \\kappa_{n+1})=0$ 来求解 $\\Delta\\gamma$：\n$$\nq_{n+1} + \\alpha p_{n+1} - (\\sigma_{y0} + H\\kappa_{n+1}) = 0\n$$\n代入 $q_{n+1}$、$p_{n+1}$ 和 $\\kappa_{n+1}=\\Delta\\gamma$ 的表达式：\n$$\n(q^{\\mathrm{tr}} - 3G\\Delta\\gamma) + \\alpha(p^{\\mathrm{tr}} - K\\alpha_{\\psi}\\Delta\\gamma) - (\\sigma_{y0} + H\\Delta\\gamma) = 0\n$$\n整理以求解 $\\Delta\\gamma$：\n$$\n(q^{\\mathrm{tr}} + \\alpha p^{\\mathrm{tr}} - \\sigma_{y0}) = \\Delta\\gamma(3G + H + \\alpha K\\alpha_{\\psi})\n$$\n左边括号中的项是 $f^{\\mathrm{tr}}$。这给出了塑性乘子：\n$$\n\\Delta\\gamma = \\frac{f^{\\mathrm{tr}}}{3G + H + \\alpha K \\alpha_{\\psi}}\n$$\n只要更新后的应力位于屈服面的锥面部分 ($q_{n+1} \\ge 0$)，此解就有效。如果 $q^{\\mathrm{tr}} - 3G\\Delta\\gamma  0$，则试探状态位于一个映射到屈服锥顶点 ($q_{n+1}=0$) 的区域。这种“顶点返回”的条件可以通过代入 $\\Delta\\gamma$ 的表达式找到：\n$$\n\\frac{q^{\\mathrm{tr}}}{3G}  \\frac{q^{\\mathrm{tr}} + \\alpha p^{\\mathrm{tr}} - \\sigma_{y0}}{3G + H + \\alpha K \\alpha_{\\psi}} \\implies 3G(\\alpha p^{\\mathrm{tr}} - \\sigma_{y0}) > q^{\\mathrm{tr}}(H + \\alpha K\\alpha_{\\psi})\n$$\n如果此条件成立，则返回到顶点。此时 $q_{n+1}=0$，并且从 $q_{n+1} = q^{\\mathrm{tr}} - 3G\\Delta\\gamma$ 中，我们得到 $\\Delta\\gamma = q^{\\mathrm{tr}}/(3G)$。\n\n**应力修正范数**\n应力修正是 $\\Delta\\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}^{\\mathrm{tr}} - \\boldsymbol{\\sigma}_{n+1}$。我们需要计算其 Frobenius 范数 $||\\Delta\\boldsymbol{\\sigma}||_F$。根据返回映射方程，$\\Delta\\boldsymbol{\\sigma} = \\Delta\\gamma\\,\\mathbb{C}:\\frac{\\partial g}{\\partial\\boldsymbol{\\sigma}}\\Big|_{\\boldsymbol{\\sigma}_{n+1}}$。\n$$\n\\Delta\\boldsymbol{\\sigma} = \\Delta\\gamma\\left(\\frac{3G}{q_{n+1}}\\boldsymbol{s}_{n+1} - K\\alpha_{\\psi}\\boldsymbol{I}\\right)\n$$\n其 Frobenius 范数的平方是 $||\\Delta\\boldsymbol{\\sigma}||_F^2 = \\operatorname{tr}(\\Delta\\boldsymbol{\\sigma}^T \\Delta\\boldsymbol{\\sigma})$。由于 $\\boldsymbol{s}_{n+1}$ 是偏张量而 $\\boldsymbol{I}$ 是球张量，它们是正交的，即 $\\operatorname{tr}(\\boldsymbol{s}_{n+1}^T \\boldsymbol{I})=0$。\n$$\n||\\Delta\\boldsymbol{\\sigma}||_F^2 = (\\Delta\\gamma)^2 \\left( \\left\\|\\frac{3G}{q_{n+1}}\\boldsymbol{s}_{n+1}\\right\\|_F^2 + \\|-K\\alpha_{\\psi}\\boldsymbol{I}\\|_F^2 \\right)\n$$\n使用 $||\\boldsymbol{s}_{n+1}||_F^2 = \\frac{2}{3}q_{n+1}^2$ 和 $||\\boldsymbol{I}||_F^2 = 3$：\n$$\n||\\Delta\\boldsymbol{\\sigma}||_F^2 = (\\Delta\\gamma)^2 \\left( \\left(\\frac{3G}{q_{n+1}}\\right)^2\\left(\\frac{2}{3}q_{n+1}^2\\right) + (K\\alpha_{\\psi})^2(3) \\right) = (\\Delta\\gamma)^2(6G^2 + 3K^2\\alpha_{\\psi}^2)\n$$\n因此，修正范数为：\n$$\n||\\Delta\\boldsymbol{\\sigma}||_F = \\Delta\\gamma \\sqrt{6G^2 + 3K^2\\alpha_{\\psi}^2}\n$$\n此公式适用于常规返回和顶点返回两种情况，只需使用相应的 $\\Delta\\gamma$ 值。\n\n**算法摘要**\n对于每个测试用例和每个流动法则（相关联流动为 $\\alpha_{\\psi}=\\alpha$，非相关联流动为给定的 $\\alpha_{\\psi}$）：\n1.  从 $E$ 和 $\\nu$ 计算弹性模量 $G$ 和 $K$。\n2.  从给定的应变增量 $\\Delta\\boldsymbol{\\varepsilon}$ 计算试探应力不变量 $p^{\\mathrm{tr}}$ 和 $q^{\\mathrm{tr}}$。\n3.  评估试探屈服函数 $f^{\\mathrm{tr}} = q^{\\mathrm{tr}} + \\alpha p^{\\mathrm{tr}} - \\sigma_{y0}$。\n4.  如果 $f^{\\mathrm{tr}} \\le 0$，则该步是弹性的。修正范数为 $0$。\n5.  如果 $f^{\\mathrm{tr}}  0$，则该步是塑性的：\n    a. 检查顶点返回条件：$3G(\\alpha p^{\\mathrm{tr}} - \\sigma_{y0}) > q^{\\mathrm{tr}}(H + \\alpha K\\alpha_{\\psi})$。\n    b. 如果是顶点返回，$\\Delta\\gamma = q^{\\mathrm{tr}}/(3G)$。\n    c. 否则（常规返回），$\\Delta\\gamma = f^{\\mathrm{tr}} / (3G + H + \\alpha K\\alpha_{\\psi})$。\n    d. 使用 $||\\Delta\\boldsymbol{\\sigma}||_F = \\Delta\\gamma \\sqrt{6G^2 + 3K^2\\alpha_{\\psi}^2}$ 计算修正范数。\n\n该过程将针对所提供的测试用例进行实现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_correction_norm(E, nu, sig_y0, H, alpha, alpha_psi, eps_xx, eps_yy, gamma_xy):\n    \"\"\"\n    Calculates the stress correction norm for a single step of loading\n    for a Drucker-Prager material.\n\n    Args:\n        E (float): Young's modulus [MPa]\n        nu (float): Poisson's ratio\n        sig_y0 (float): Initial yield stress [MPa]\n        H (float): Hardening modulus [MPa]\n        alpha (float): Friction parameter\n        alpha_psi (float): Dilatancy parameter\n        eps_xx (float): Normal strain in x-direction\n        eps_yy (float): Normal strain in y-direction\n        gamma_xy (float): Engineering shear strain in xy-plane\n\n    Returns:\n        float: The Frobenius norm of the stress correction [MPa].\n    \"\"\"\n    # 1. Calculate elastic moduli\n    G = E / (2 * (1 + nu))\n    K = E / (3 * (1 - 2 * nu))\n\n    # 2. Compute the trial stress state\n    # Strain tensor components\n    eps_xy = gamma_xy / 2.0\n    \n    # Volumetric strain\n    eps_v = eps_xx + eps_yy\n    \n    # Trial mean stress (compression positive)\n    p_tr = -K * eps_v\n    \n    # Deviatoric strain components\n    e_xx = eps_xx - eps_v / 3.0\n    e_yy = eps_yy - eps_v / 3.0\n    e_zz = -eps_v / 3.0 # Plane strain condition eps_zz = 0\n    e_xy = eps_xy\n    \n    # Trial deviatoric stress components\n    s_tr_xx = 2 * G * e_xx\n    s_tr_yy = 2 * G * e_yy\n    s_tr_zz = 2 * G * e_zz\n    s_tr_xy = 2 * G * e_xy\n    \n    # Trial equivalent stress (q)\n    # s_tr:s_tr = s_tr_xx^2 + s_tr_yy^2 + s_tr_zz^2 + 2*s_tr_xy^2\n    s_tr_F_sq = s_tr_xx**2 + s_tr_yy**2 + s_tr_zz**2 + 2 * s_tr_xy**2\n    q_tr = np.sqrt(3.0 / 2.0 * s_tr_F_sq)\n    \n    # 3. Evaluate the trial yield function\n    f_tr = q_tr + alpha * p_tr - sig_y0\n    \n    delta_gamma = 0.0\n    # 4. Check for plastic loading\n    if f_tr > 1e-9: # Use a small tolerance for floating point comparison\n        # 5. Plastic step: calculate plastic multiplier delta_gamma\n        denominator = 3*G + H + alpha * K * alpha_psi\n        \n        # Check for apex return condition\n        is_apex = False\n        if denominator > 1e-9:\n            # Apex return if 3*G*(alpha*p_tr - sig_y0) > q_tr*(H + alpha*K*alpha_psi)\n            if 3*G*(alpha*p_tr - sig_y0) > q_tr*(H + alpha*K*alpha_psi):\n                is_apex = True\n\n        if is_apex:\n            if G > 1e-9:\n                delta_gamma = q_tr / (3 * G)\n            else:\n                 delta_gamma = 0.0 # Should not happen with real materials\n        else: # Regular return\n            if denominator > 1e-9:\n                delta_gamma = f_tr / denominator\n            else:\n                delta_gamma = 0.0 # Unstable material response\n    \n    # 6. Calculate the stress correction norm\n    correction_norm = delta_gamma * np.sqrt(6 * G**2 + 3 * (K * alpha_psi)**2)\n    \n    return correction_norm\n\ndef solve():\n    \"\"\"\n    Main function to run test cases and print results.\n    \"\"\"\n    test_cases = [\n        # (E [MPa], nu, sigma_y0 [MPa], H [MPa], alpha, alpha_psi, eps_xx, eps_yy, gamma_xy)\n        (30000, 0.25, 100, 500, 0.2, 0.05, 0.0, 0.0, 0.001),\n        (30000, 0.25, 100, 500, 0.2, 0.05, 0.0, 0.0, 0.01),\n        (30000, 0.25, 100, 500, 0.2, 0.05, -0.006, -0.006, 0.0),\n        (30000, 0.25, 100, 500, 0.2, 0.05, 0.0, 0.0, 0.0048),\n    ]\n\n    results = []\n    for case in test_cases:\n        E, nu, sig_y0, H, alpha, alpha_psi_non_assoc, eps_xx, eps_yy, gamma_xy = case\n        \n        # Associated flow: use alpha_psi = alpha\n        norm_assoc = calculate_correction_norm(E, nu, sig_y0, H, alpha, alpha, eps_xx, eps_yy, gamma_xy)\n        \n        # Non-associated flow: use the given alpha_psi\n        norm_non_assoc = calculate_correction_norm(E, nu, sig_y0, H, alpha, alpha_psi_non_assoc, eps_xx, eps_yy, gamma_xy)\n        \n        # Format results to six decimal places as required\n        formatted_norms = [f\"{norm_assoc:.6f}\", f\"{norm_non_assoc:.6f}\"]\n        results.append(f\"[{','.join(formatted_norms)}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}