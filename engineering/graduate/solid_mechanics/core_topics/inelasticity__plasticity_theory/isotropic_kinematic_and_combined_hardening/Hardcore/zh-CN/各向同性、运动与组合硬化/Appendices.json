{
    "hands_on_practices": [
        {
            "introduction": "在进行任何复杂的塑性分析之前，首要任务是判断材料是否已进入塑性状态。本练习将带你回顾塑性力学的基础知识，即如何从一个给定的应力张量计算等效应力。通过应用 von Mises ($J_2$) 屈服准则，你将能够明确区分弹性行为和塑性行为，这是所有后续硬化模型分析的起点 。",
            "id": "2652054",
            "problem": "一种处于小应变状态的均匀、各向同性金属遵循一个与应变率无关、带有组合硬化的 $J_2$（偏应力第二不变量）塑性模型，但在所关注的加载瞬间，运动背应力为零，且各向同性硬化半径等于当前屈服应力。Cauchy 应力张量是对角的，其主应力已知，所有剪切分量均为零，具体为 $\\boldsymbol{\\sigma}=\\operatorname{diag}(300,150,0)\\,\\text{MPa}$。当前屈服应力为 $\\sigma_{y}=200\\,\\text{MPa}$。\n\n从平均应力、偏应力和偏应力第二不变量 $J_2$ 的基本定义出发，计算 von Mises 等效应力 $\\sigma_{eq}$，并使用带有各向同性硬化的 $J_2$ 屈服准则来判断该状态是弹性的还是塑性的。\n\n最终答案只报告 $\\sigma_{eq}$ 的数值，以兆帕（MPa）为单位，并四舍五入到四位有效数字。任何分类（弹性的或塑性的）都应在您的计算过程中得到证明，但不包含在最终报告的数字中。",
            "solution": "该问题陈述是适定的、内部一致的，并且科学上基于连续介质力学的原理。我们可以开始求解。\n\n任务是针对给定的应力状态计算 von Mises 等效应力 $\\sigma_{eq}$，并判断材料是否正在屈服。分析将按照要求从基本定义开始。\n\n给定的 Cauchy 应力张量 $\\boldsymbol{\\sigma}$ 是对角的，这意味着坐标轴与主应力方向一致。主应力为：\n$$ \\sigma_1 = 300\\,\\text{MPa} $$\n$$ \\sigma_2 = 150\\,\\text{MPa} $$\n$$ \\sigma_3 = 0\\,\\text{MPa} $$\n应力张量的矩阵形式为：\n$$ \\boldsymbol{\\sigma} = \\begin{pmatrix} 300  0  0 \\\\ 0  150  0 \\\\ 0  0  0 \\end{pmatrix} \\,\\text{MPa} $$\n\n首先，我们计算平均应力（或静水应力）$\\sigma_m$，其定义为应力张量迹 $\\operatorname{tr}(\\boldsymbol{\\sigma})$ 的三分之一：\n$$ \\sigma_m = \\frac{1}{3} \\operatorname{tr}(\\boldsymbol{\\sigma}) = \\frac{1}{3} (\\sigma_1 + \\sigma_2 + \\sigma_3) $$\n代入给定的主应力值：\n$$ \\sigma_m = \\frac{1}{3} (300 + 150 + 0) = \\frac{450}{3} = 150\\,\\text{MPa} $$\n平均应力代表了应力状态中纯粹的体积变化部分。\n\n其次，我们确定偏应力张量 $\\boldsymbol{s}$，它引起形状改变（畸变）。它是通过从总应力张量中减去静水压力部分得到的：\n$$ \\boldsymbol{s} = \\boldsymbol{\\sigma} - \\sigma_m \\boldsymbol{I} $$\n其中 $\\boldsymbol{I}$ 是二阶单位张量。偏应力张量的主分量是：\n$$ s_1 = \\sigma_1 - \\sigma_m = 300 - 150 = 150\\,\\text{MPa} $$\n$$ s_2 = \\sigma_2 - \\sigma_m = 150 - 150 = 0\\,\\text{MPa} $$\n$$ s_3 = \\sigma_3 - \\sigma_m = 0 - 150 = -150\\,\\text{MPa} $$\n偏应力张量的矩阵形式为：\n$$ \\boldsymbol{s} = \\begin{pmatrix} 150  0  0 \\\\ 0  0  0 \\\\ 0  0  -150 \\end{pmatrix} \\,\\text{MPa} $$\n根据定义，偏应力张量是无迹的：$\\operatorname{tr}(\\boldsymbol{s}) = 150 + 0 + (-150) = 0$。\n\n第三，我们计算偏应力张量的第二不变量 $J_2$。这个标量是偏应力大小的度量，并且是 von Mises 屈服准则的核心。其定义为：\n$$ J_2 = \\frac{1}{2} s_{ij}s_{ji} = \\frac{1}{2} \\operatorname{tr}(\\boldsymbol{s}^2) $$\n使用主偏应力，这变为：\n$$ J_2 = \\frac{1}{2} (s_1^2 + s_2^2 + s_3^2) $$\n代入计算出的值：\n$$ J_2 = \\frac{1}{2} (150^2 + 0^2 + (-150)^2) = \\frac{1}{2} (22500 + 0 + 22500) = \\frac{45000}{2} = 22500\\,\\text{MPa}^2 $$\n\nvon Mises 等效应力 $\\sigma_{eq}$ 通过以下定义与 $J_2$ 相关联：\n$$ \\sigma_{eq} = \\sqrt{3 J_2} $$\n代入 $J_2$ 的值：\n$$ \\sigma_{eq} = \\sqrt{3 \\times 22500} = \\sqrt{67500} = 150\\sqrt{3}\\,\\text{MPa} $$\n\n为了检查是弹性行为还是塑性行为，我们将 $\\sigma_{eq}$ 与当前屈服应力 $\\sigma_y$ 进行比较。问题陈述中提到，运动背应力为零，且各向同性硬化半径等于当前屈服应力 $\\sigma_y = 200\\,\\text{MPa}$。带有各向同性硬化的 $J_2$ 塑性的屈服函数为：\n$$ f = \\sigma_{eq} - \\sigma_y $$\n如果 $f  0$，状态为弹性；如果 $f \\ge 0$，状态为塑性。我们必须首先数值计算 $\\sigma_{eq}$：\n$$ \\sigma_{eq} = 150\\sqrt{3} \\approx 150 \\times 1.7320508... \\approx 259.8076...\\,\\text{MPa} $$\n现在，我们计算屈服函数：\n$$ f \\approx 259.81\\,\\text{MPa} - 200\\,\\text{MPa} = 59.81\\,\\text{MPa} $$\n由于 $f > 0$（等效地，$\\sigma_{eq} > \\sigma_y$），材料当前处于塑性状态。\n\n问题要求最终答案为 $\\sigma_{eq}$ 的数值，以兆帕为单位，并四舍五入到四位有效数字。\n$$ \\sigma_{eq} \\approx 259.8\\,\\text{MPa} $$\n这就是要报告的值。",
            "answer": "$$\\boxed{259.8}$$"
        },
        {
            "introduction": "真实世界的材料和结构经常承受复杂的循环加载，而不仅仅是单向加载。本练习旨在通过一个完整的加载-卸载-反向加载过程，让你亲手追踪具有组合硬化（随动硬化和各向同性硬化）特性的材料的状态演化。完成这个练习将帮助你深入理解模型如何捕捉循环塑性的关键特征，例如 Bauschinger 效应，并直观地看到屈服面的平移和扩张 。",
            "id": "2652033",
            "problem": "一个由金属合金制成的率无关、小应变单轴试样，通过各向同性线弹性与经典 von Mises ($J_{2}$) 塑性相结合进行建模，该模型包含关联流动、线性随动硬化 (Prager 法则) 和线性各向同性硬化。设弹性模量为 $E = 210 \\times 10^{3} \\ \\mathrm{MPa}$，初始屈服应力为 $\\sigma_{y0} = 250 \\ \\mathrm{MPa}$，随动硬化模量为 $H_{\\mathrm{kin}} = 4000 \\ \\mathrm{MPa}$，各向同性硬化模量为 $H_{\\mathrm{iso}} = 600 \\ \\mathrm{MPa}$。初始状态为无应力、无塑性应变，且背应力和各向同性硬化变量均为零。\n\n按如下方式准静态施加一个预设的单轴应变历史：从 $\\varepsilon = 0$ 开始，轴向应变单调增加到 $\\varepsilon = 0.006$，然后单调减少到 $\\varepsilon = -0.002$。假设小应变运动学 $\\varepsilon = \\varepsilon^{e} + \\varepsilon^{p}$、线弹性 $\\sigma = E \\, \\varepsilon^{e}$、含随动和各向同性硬化的 von Mises 屈服条件的单轴简化形式以及关联流动。使用与这些定义一致的标量简化单轴方程，计算整个历史过程中背应力 $\\alpha(\\varepsilon)$、各向同性硬化变量 $\\kappa(\\varepsilon)$ 和轴向 Cauchy 应力 $\\sigma(\\varepsilon)$ 的演化，并识别弹性段、塑性段以及反向重新屈服的逆转点。\n\n只需报告加载程序结束时，即 $\\varepsilon = -0.002$ 时的最终轴向 Cauchy 应力。应力以 $\\mathrm{MPa}$ 为单位表示，并将答案四舍五入至四位有效数字。",
            "solution": "首先对问题进行验证。\n\n步骤 1：提取已知条件\n- 材料模型：率无关、小应变、单轴、各向同性线弹性与 von Mises ($J_2$) 塑性。\n- 硬化模型：组合线性随动硬化 (Prager 法则) 和线性各向同性硬化。\n- 弹性模量：$E = 210 \\times 10^{3} \\ \\mathrm{MPa}$。\n- 初始屈服应力：$\\sigma_{y0} = 250 \\ \\mathrm{MPa}$。\n- 随动硬化模量：$H_{\\mathrm{kin}} = 4000 \\ \\mathrm{MPa}$。\n- 各向同性硬化模量：$H_{\\mathrm{iso}} = 600 \\ \\mathrm{MPa}$。\n- 初始条件：无应力、无塑性应变、零背应力、零各向同性硬化。\n- 应变历史：从 $\\varepsilon = 0$ 单调增加到 $\\varepsilon = 0.006$，然后单调减少到 $\\varepsilon = -0.002$。\n- 运动学：小应变，$\\varepsilon = \\varepsilon^{e} + \\varepsilon^{p}$。\n- 本构关系：$\\sigma = E \\, \\varepsilon^{e}$，关联流动法则。\n\n步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据、提法适定、客观且完整。它描述了固体力学的一个分支——塑性理论中的一个标准问题。所有必要的参数和初始/边界条件都已提供。该模型是经典模型（含组合硬化的 von Mises 塑性），要求是将其应用于一个简单的单轴加载路径。该问题不违反任何科学原理，没有歧义，并且与塑性力学中的硬化模型主题直接相关。\n\n步骤 3：结论与行动\n问题有效。将提供解答。\n\n该问题要求计算一个经历预设单轴应变历史的试样的最终应力。材料行为由线弹性和具有组合线性各向同性与随动硬化的 $J_2$ 塑性理论控制。\n\n单轴情况下的基本方程如下：\n1.  应变的加法分解：$\\varepsilon = \\varepsilon^e + \\varepsilon^p$，其中 $\\varepsilon$ 是总应变，$\\varepsilon^e$ 是弹性应变，$\\varepsilon^p$ 是塑性应变。\n2.  线弹性定律：$\\sigma = E \\varepsilon^e = E(\\varepsilon - \\varepsilon^p)$。\n3.  屈服条件：带有组合硬化的 von Mises 准则简化为 $f(\\sigma, \\alpha, \\kappa) = |\\sigma - \\alpha| - (\\sigma_{y0} + \\kappa) \\le 0$，其中 $\\alpha$ 是背应力，$\\kappa$ 是各向同性硬化变量（等效于屈服应力的增量）。\n4.  硬化法则：\n    -   随动硬化 (Prager 法则)：$\\dot{\\alpha} = H_{\\mathrm{kin}} \\dot{\\varepsilon}^p$。\n    -   各向同性硬化：$\\dot{\\kappa} = H_{\\mathrm{iso}} \\dot{\\bar{\\varepsilon}}^p$，其中 $\\dot{\\bar{\\varepsilon}}^p = |\\dot{\\varepsilon}^p|$ 是等效塑性应变率。\n5.  流动法则：关联流动意味着 $\\dot{\\varepsilon}^p = \\dot{\\lambda} \\operatorname{sgn}(\\sigma - \\alpha)$，其中 $\\dot{\\lambda} \\ge 0$ 是塑性乘子。Kuhn-Tucker 条件适用：$\\dot{\\lambda} \\ge 0$，$f \\le 0$，$\\dot{\\lambda}f = 0$。\n\n分析是根据施加的应变历史分段进行的。\n\n第 1 部分：从 $\\varepsilon = 0$ 到 $\\varepsilon_1 = 0.006$ 的单调加载。\n\nA 段：弹性加载 ($0 \\le \\varepsilon \\le \\varepsilon_y$)\n初始时，$\\varepsilon^p = 0$，$\\alpha = 0$，$\\kappa = 0$。响应是弹性的：$\\sigma = E\\varepsilon$。当 $|\\sigma| = \\sigma_{y0}$ 时开始屈服。由于是拉伸加载，这发生在 $\\sigma = \\sigma_{y0}$ 处。相应的屈服应变为：\n$$ \\varepsilon_y = \\frac{\\sigma_{y0}}{E} = \\frac{250}{210 \\times 10^3} = \\frac{1}{840} \\approx 0.00119 $$\n由于 $\\varepsilon_1 = 0.006 > \\varepsilon_y$，将发生塑性变形。\n\nB 段：塑性加载 ($\\varepsilon_y  \\varepsilon \\le \\varepsilon_1 = 0.006$)\n在此段中，屈服准则被激活：$\\sigma - \\alpha = \\sigma_{y0} + \\kappa$。对一个类时参数求导得到 $\\dot{\\sigma} - \\dot{\\alpha} = \\dot{\\kappa}$。\n对于拉伸塑性加载，$\\dot{\\varepsilon}^p > 0$，因此 $\\dot{\\bar{\\varepsilon}}^p = \\dot{\\varepsilon}^p$。硬化率为 $\\dot{\\alpha} = H_{\\mathrm{kin}}\\dot{\\varepsilon}^p$ 和 $\\dot{\\kappa} = H_{\\mathrm{iso}}\\dot{\\varepsilon}^p$。应力率为 $\\dot{\\sigma} = E(\\dot{\\varepsilon} - \\dot{\\varepsilon}^p)$。将这些代入一致性条件：\n$$ E(\\dot{\\varepsilon} - \\dot{\\varepsilon}^p) - H_{\\mathrm{kin}}\\dot{\\varepsilon}^p = H_{\\mathrm{iso}}\\dot{\\varepsilon}^p $$\n$$ E\\dot{\\varepsilon} = (E + H_{\\mathrm{kin}} + H_{\\mathrm{iso}})\\dot{\\varepsilon}^p $$\n塑性应变率为 $\\dot{\\varepsilon}^p = \\frac{E}{E + H}\\dot{\\varepsilon}$，其中 $H = H_{\\mathrm{kin}} + H_{\\mathrm{iso}}$。\n塑性范围内的切线模量为 $E_T = \\frac{d\\sigma}{d\\varepsilon} = E(1 - \\frac{\\dot{\\varepsilon}^p}{\\dot{\\varepsilon}}) = E(1 - \\frac{E}{E+H}) = \\frac{EH}{E+H}$。\n让我们计算在逆转点 $\\varepsilon_1 = 0.006$ 时的状态值：\n$H = 4000 + 600 = 4600 \\ \\mathrm{MPa}$。\n$E+H = 210000 + 4600 = 214600 \\ \\mathrm{MPa}$。\n$E_T = \\frac{210000 \\times 4600}{214600} \\approx 4501.4 \\ \\mathrm{MPa}$。\n在 $\\varepsilon_1$ 处的应力为：\n$$ \\sigma_1 = \\sigma_{y0} + E_T (\\varepsilon_1 - \\varepsilon_y) = 250 + \\frac{210000 \\times 4600}{214600} \\left(0.006 - \\frac{250}{210000}\\right) $$\n$$ \\sigma_1 = 250 + \\left(\\frac{4830000}{1073}\\right) \\left(\\frac{101}{21000}\\right) = 250 + \\frac{23230}{1073} \\approx 271.65 \\ \\mathrm{MPa} $$\n此处的总塑性应变通过对塑性应变率积分得到：\n$$ \\varepsilon_1^p = \\int_{\\varepsilon_y}^{\\varepsilon_1} \\frac{E}{E+H} d\\varepsilon = \\frac{E}{E+H} (\\varepsilon_1 - \\varepsilon_y) = \\frac{210000}{214600} \\left(0.006 - \\frac{1}{840}\\right) = \\frac{101}{21460} \\approx 0.0047064 $$\n逆转时的内状态变量为：\n$$ \\alpha_1 = H_{\\mathrm{kin}} \\varepsilon_1^p = 4000 \\left(\\frac{101}{21460}\\right) = \\frac{20200}{1073} \\approx 18.83 \\ \\mathrm{MPa} $$\n$$ \\kappa_1 = H_{\\mathrm{iso}} \\varepsilon_1^p = 600 \\left(\\frac{101}{21460}\\right) = \\frac{3030}{1073} \\approx 2.82 \\ \\mathrm{MPa} $$\n\n第 2 部分：从 $\\varepsilon_1 = 0.006$ 到 $\\varepsilon_f = -0.002$ 的单调卸载。\n\nC 段：弹性卸载 ($\\varepsilon_{ry}  \\varepsilon \\le \\varepsilon_1$)\n逆转时，材料发生弹性卸载。塑性应变和内变量保持恒定：$\\varepsilon^p = \\varepsilon_1^p$，$\\alpha = \\alpha_1$，$\\kappa = \\kappa_1$。\n应力-应变关系为 $\\sigma - \\sigma_1 = E(\\varepsilon - \\varepsilon_1)$。\n当屈服准则在压缩状态下满足时，发生反向屈服：$\\sigma - \\alpha_1 = -(\\sigma_{y0} + \\kappa_1)$。\n反向屈服时的应力 $\\sigma_{ry}$ 为：\n$$ \\sigma_{ry} = \\alpha_1 - (\\sigma_{y0} + \\kappa_1) = \\frac{20200}{1073} - \\left(250 + \\frac{3030}{1073}\\right) = \\frac{17170}{1073} - 250 = -\\frac{251080}{1073} \\approx -234.00 \\ \\mathrm{MPa} $$\n弹性应力范围的大小为 $\\sigma_1 - \\sigma_{ry} = 2(\\sigma_{y0} + \\kappa_1) = 2(250 + \\frac{3030}{1073}) = \\frac{542560}{1073} \\approx 505.65 \\ \\mathrm{MPa}$。\n反向屈服时的应变 $\\varepsilon_{ry}$ 为：\n$$ \\varepsilon_{ry} = \\varepsilon_1 + \\frac{\\sigma_{ry} - \\sigma_1}{E} = 0.006 - \\frac{2(\\sigma_{y0} + \\kappa_1)}{E} = 0.006 - \\frac{542560}{1073 \\times 210000} \\approx 0.006 - 0.0024078 = 0.0035922 $$\n\nD 段：反向塑性加载 ($\\varepsilon_f \\le \\varepsilon  \\varepsilon_{ry}$)\n最终目标应变为 $\\varepsilon_f = -0.002$。由于 $\\varepsilon_f  \\varepsilon_{ry}$，材料经历反向塑性流动。反向塑性流动的切线模量相同，为 $E_T = \\frac{EH}{E+H}$。\n最终应力 $\\sigma_f$ 可通过从反向屈服点开始并沿塑性应力-应变路径计算得出：\n$$ \\sigma_f = \\sigma_{ry} + E_T(\\varepsilon_f - \\varepsilon_{ry}) $$\n此塑性段的应变增量为 $\\Delta\\varepsilon_{pl} = \\varepsilon_f - \\varepsilon_{ry} \\approx -0.002 - 0.0035922 = -0.0055922$。\n应力增量为 $\\Delta\\sigma_{pl} = E_T \\Delta\\varepsilon_{pl} \\approx 4501.4 \\times (-0.0055922) \\approx -25.17 \\ \\mathrm{MPa}$。\n最终应力为：\n$$ \\sigma_f = \\sigma_{ry} + \\Delta\\sigma_{pl} \\approx -234.00 + (-25.17) = -259.17 \\ \\mathrm{MPa} $$\n让我们使用精确分数进行计算以确保精度：\n$$ \\sigma_f = -\\frac{251080}{1073} + \\left(\\frac{210000 \\times 4600}{214600}\\right) \\left(-0.002 - \\left(0.006 - \\frac{2(\\sigma_{y0} + \\kappa_1)}{E}\\right)\\right) $$\n$$ \\sigma_f = -\\frac{251080}{1073} + E_T \\left(-0.008 + \\frac{2}{E}\\left(250 + \\frac{3030}{1073}\\right)\\right) $$\n$$ \\sigma_f = -\\frac{251080}{1073} - \\frac{38640}{1073} + \\frac{4830000}{1073} \\frac{542560}{210000 \\times 1073} $$\n$$ \\sigma_f = \\frac{-289720 \\times 1073 + 12478880}{1073^2} = \\frac{-310869560 + 12478880}{1151329} = -\\frac{298390680}{1151329} \\approx -259.17019 \\ \\mathrm{MPa} $$\n四舍五入到四位有效数字，最终轴向应力为 $-259.2 \\ \\mathrm{MPa}$。",
            "answer": "$$ \\boxed{-259.2} $$"
        },
        {
            "introduction": "尽管手动计算对于理解物理概念至关重要，但对于复杂的工程问题，我们依赖于数值算法。这个最终的实践练习将指导你实现组合硬化模型的“心脏”——返回映射算法（return-mapping algorithm）。通过将连续的塑性理论转化为离散的计算机代码，你不仅能自动化应力更新过程，还能深刻揭示有限元软件中塑性求解器的工作原理 。",
            "id": "2652024",
            "problem": "实现一个用于线性各向同性硬化、线性随动硬化及其组合的弹塑性材料的小应变单轴返回映射算法（径向返回）。该问题以纯数学术语提出，使用具有物理意义的单位：应力单位为兆帕 (MPa)，应变无量纲。从应变加和分解、线性弹性以及一个带有单轴屈服函数的关联率无关塑性模型出发。不要使用任何预先推导的更新快捷公式；通过在增量结束时强制执行一致性条件来推导更新过程。\n\n假设在单轴小应变下具有以下本构结构：\n- 加和分解：$\\varepsilon = \\varepsilon^{e} + \\varepsilon^{p}$。\n- 线性弹性：$\\sigma = E\\,\\varepsilon^{e}$，其中 $E$ 为杨氏模量。\n- 单轴形式的屈服函数：$f(\\sigma,\\alpha,\\kappa) = | \\sigma - \\alpha | - \\left(\\sigma_{y}^{0} + H_{\\text{iso}}\\,\\kappa\\right)$，其中 $\\alpha$ 是用于随动硬化的单轴背应力，$\\kappa$ 是累积塑性应变，$\\sigma_{y}^{0}$ 是初始屈服应力，而 $H_{\\text{iso}}$ 是线性各向同性硬化模量。\n- 关联流动法则和单轴形式的硬化演化：$\\dot{\\varepsilon}^{p} = \\dot{\\gamma}\\,\\operatorname{sign}(\\sigma-\\alpha)$，$\\dot{\\kappa} = \\dot{\\gamma}$，以及 $\\dot{\\alpha} = C\\,\\dot{\\varepsilon}^{p}$，其中 $C$ 是线性随动硬化模量，$\\dot{\\gamma} \\ge 0$ 是强制执行 $f \\le 0$ 和 $\\dot{\\gamma} f = 0$ 的塑性乘子。\n\n给定一个从状态 $n$ 到 $n+1$ 的时间步内的应变增量 $\\Delta \\varepsilon$，且已知状态变量 $(\\sigma^{n}, \\varepsilon^{p\\,n}, \\kappa^{n}, \\alpha^{n})$，实现以下算法以计算 $(\\sigma^{n+1}, \\varepsilon^{p\\,n+1}, \\kappa^{n+1}, \\alpha^{n+1})$：\n\n1. 使用 $\\sigma_{\\text{tr}} = \\sigma^{n} + E\\,\\Delta \\varepsilon$ 计算弹性试探应力。\n2. 评估试探屈服函数 $f_{\\text{tr}} = | \\sigma_{\\text{tr}} - \\alpha^{n} | - \\left(\\sigma_{y}^{0} + H_{\\text{iso}}\\,\\kappa^{n}\\right)$。\n3. 如果 $f_{\\text{tr}} \\le 0$（在您必须定义的数值容差范围内），则接受弹性步，结果为 $(\\sigma^{n+1}, \\varepsilon^{p\\,n+1}, \\kappa^{n+1}, \\alpha^{n+1}) = (\\sigma_{\\text{tr}}, \\varepsilon^{p\\,n}, \\kappa^{n}, \\alpha^{n})$。\n4. 如果 $f_{\\text{tr}} > 0$，则在 $n+1$ 时刻强制执行塑性一致性，并采用关联流动和线性硬化来确定塑性修正。使用一个在增量期间保持加载方向 $\\operatorname{sign}(\\sigma_{\\text{tr}}-\\alpha^{n})$ 的返回映射算法，并相应地更新 $(\\sigma, \\varepsilon^{p}, \\kappa, \\alpha)$。\n\n设计一个程序，将此更新应用于一组固定的测试用例。所有应力（包括背应力 $\\alpha$）必须以 $\\mathrm{MPa}$ 为单位，所有应变（包括 $\\varepsilon^{p}$ 和 $\\kappa$）均为无量纲。每个测试用例的输出必须是一个包含四个浮点数的列表，按 $[\\sigma^{n+1}\\,(\\mathrm{MPa}), \\varepsilon^{p\\,n+1}, \\kappa^{n+1}, \\alpha^{n+1}\\,(\\mathrm{MPa})]$ 的顺序排列，并四舍五入到六位小数。\n\n测试套件（请精确使用这些参数值）：\n- 用例 A（仅各向同性硬化，塑性步）：$E = 210000\\,\\mathrm{MPa}$，$\\sigma_{y}^{0} = 250\\,\\mathrm{MPa}$，$H_{\\text{iso}} = 1000\\,\\mathrm{MPa}$，$C = 0\\,\\mathrm{MPa}$，$\\sigma^{n} = 0\\,\\mathrm{MPa}$，$\\varepsilon^{p\\,n} = 0$，$\\kappa^{n} = 0$，$\\alpha^{n} = 0\\,\\mathrm{MPa}$，$\\Delta \\varepsilon = 0.003$。\n- 用例 B（仅各向同性硬化，弹性步）：$E = 210000\\,\\mathrm{MPa}$，$\\sigma_{y}^{0} = 250\\,\\mathrm{MPa}$，$H_{\\text{iso}} = 1000\\,\\mathrm{MPa}$，$C = 0\\,\\mathrm{MPa}$，$\\sigma^{n} = 0\\,\\mathrm{MPa}$，$\\varepsilon^{p\\,n} = 0$，$\\kappa^{n} = 0$，$\\alpha^{n} = 0\\,\\mathrm{MPa}$，$\\Delta \\varepsilon = 0.001$。\n- 用例 C（仅随动硬化，塑性步）：$E = 210000\\,\\mathrm{MPa}$，$\\sigma_{y}^{0} = 250\\,\\mathrm{MPa}$，$H_{\\text{iso}} = 0\\,\\mathrm{MPa}$，$C = 30000\\,\\mathrm{MPa}$，$\\sigma^{n} = 260\\,\\mathrm{MPa}$，$\\alpha^{n} = 50\\,\\mathrm{MPa}$，$\\varepsilon^{p\\,n} = 50/30000$，$\\kappa^{n} = 50/30000$，$\\Delta \\varepsilon = 0.002$。\n- 用例 D（组合硬化与反向加载，塑性步）：$E = 210000\\,\\mathrm{MPa}$，$\\sigma_{y}^{0} = 250\\,\\mathrm{MPa}$，$H_{\\text{iso}} = 2000\\,\\mathrm{MPa}$，$C = 40000\\,\\mathrm{MPa}$，$\\sigma^{n} = 376\\,\\mathrm{MPa}$，$\\alpha^{n} = 120\\,\\mathrm{MPa}$，$\\varepsilon^{p\\,n} = 120/40000$，$\\kappa^{n} = 120/40000$，$\\Delta \\varepsilon = -0.003$。\n- 用例 E（恰好在屈服边界，弹性）：$E = 210000\\,\\mathrm{MPa}$，$\\sigma_{y}^{0} = 300\\,\\mathrm{MPa}$，$H_{\\text{iso}} = 500\\,\\mathrm{MPa}$，$C = 0\\,\\mathrm{MPa}$，$\\sigma^{n} = 200\\,\\mathrm{MPa}$，$\\alpha^{n} = 0\\,\\mathrm{MPa}$，$\\kappa^{n} = 0.1$，$\\varepsilon^{p\\,n} = 0.1$，$\\Delta \\varepsilon = (350 - 200)/210000$。\n\n你的程序应对上述所有用例应用相同的算法。在判断 $f_{\\text{tr}} \\le 0$ 是否为弹性时，使用一个严格但合理的数值容差。最终的程序输出必须是单行，包含按顺序排列的用例 A–E 的结果列表，格式为一个逗号分隔的类 Python 列表的列表，其中每个浮点数四舍五入到六位小数；例如，形式为 $[[\\cdot,\\cdot,\\cdot,\\cdot],[\\cdot,\\cdot,\\cdot,\\cdot],\\ldots]$。",
            "solution": "该问题要求为一个包含线性各向同性和线性随动硬化的广义弹塑性材料模型实现一个单轴返回映射算法。推导必须从第一性原理出发，具体包括应变加和分解、线性弹性、给定的屈服准则以及关联流动和硬化法则。必须为弹塑性转变定义一个数值容差；这里选择 $10^{-7}$，因为相对于应力大小（$\\mathrm{MPa}$），这个值足够小以确保精度。\n\n目标是给定增量开始时的状态 $(\\sigma^{n}, \\varepsilon^{p\\,n}, \\kappa^{n}, \\alpha^{n})$ 和总应变增量 $\\Delta \\varepsilon$，计算增量结束时的状态变量 $(\\sigma^{n+1}, \\varepsilon^{p\\,n+1}, \\kappa^{n+1}, \\alpha^{n+1})$。\n\n算法始于一个弹性试探步。试探应力 $\\sigma_{\\text{tr}}$ 的计算假设整个应变增量 $\\Delta\\varepsilon$ 纯粹是弹性的：\n$$ \\sigma_{\\text{tr}} = \\sigma^{n} + E\\,\\Delta\\varepsilon $$\n然后使用步骤 $n$ 的状态变量对照屈服条件检查试探状态：\n$$ f_{\\text{tr}} = | \\sigma_{\\text{tr}} - \\alpha^{n} | - \\left(\\sigma_{y}^{0} + H_{\\text{iso}}\\,\\kappa^{n}\\right) $$\n如果 $f_{\\text{tr}} \\le 0$，则纯弹性步的假设是正确的。材料没有屈服，或正在弹性卸载。最终状态即为试探状态：\n$$ \\sigma^{n+1} = \\sigma_{\\text{tr}}, \\quad \\varepsilon^{p\\,n+1} = \\varepsilon^{p\\,n}, \\quad \\kappa^{n+1} = \\kappa^{n}, \\quad \\alpha^{n+1} = \\alpha^{n} $$\n如果 $f_{\\text{tr}} > 0$，则试探状态位于屈服面之外，这在物理上是不可接受的。需要进行塑性修正。这种修正，称为返回映射，必须将应力状态带回到更新后的屈服面上，满足一致性条件 $f(\\sigma^{n+1}, \\alpha^{n+1}, \\kappa^{n+1}) = 0$。\n\n塑性演化由关联流动和硬化法则控制，这些法则使用后向欧拉格式在增量上进行积分。这是一种确保无条件稳定性的标准隐式方法。塑性状态变量的增量为：\n$$ \\Delta\\varepsilon^{p} = \\varepsilon^{p\\,n+1} - \\varepsilon^{p\\,n} = \\Delta\\gamma \\, \\operatorname{sign}(\\sigma^{n+1} - \\alpha^{n+1}) $$\n$$ \\Delta\\kappa = \\kappa^{n+1} - \\kappa^{n} = \\Delta\\gamma $$\n$$ \\Delta\\alpha = \\alpha^{n+1} - \\alpha^{n} = C\\,\\Delta\\varepsilon^{p} $$\n其中 $\\Delta\\gamma \\ge 0$ 是增量上的总一致性参数。\n\n返回映射算法假设塑性流动的方向在整个修正过程中保持不变，并由试探状态确定。设此方向为 $R$：\n$$ R = \\operatorname{sign}(\\sigma_{\\text{tr}} - \\alpha^{n}) $$\n这简化了演化方程：\n$$ \\Delta\\varepsilon^{p} = \\Delta\\gamma \\, R \\quad \\implies \\quad \\varepsilon^{p\\,n+1} = \\varepsilon^{p\\,n} + \\Delta\\gamma \\, R $$\n$$ \\Delta\\kappa = \\Delta\\gamma \\quad \\implies \\quad \\kappa^{n+1} = \\kappa^{n} + \\Delta\\gamma $$\n$$ \\Delta\\alpha = C \\, \\Delta\\gamma \\, R \\quad \\implies \\quad \\alpha^{n+1} = \\alpha^{n} + C \\, \\Delta\\gamma \\, R $$\n步骤 $n+1$ 的应力是通过对试探应力进行修正，以考虑增量期间发生的塑性应变而获得的：\n$$ \\sigma^{n+1} = E (\\varepsilon^{n+1} - \\varepsilon^{p\\,n+1}) = E(\\varepsilon^n + \\Delta\\varepsilon - \\varepsilon^{p,n} - \\Delta\\varepsilon^p) = \\sigma^n + E\\Delta\\varepsilon - E\\Delta\\varepsilon^p = \\sigma_{\\text{tr}} - E\\,\\Delta\\varepsilon^{p} $$\n$$ \\sigma^{n+1} = \\sigma_{\\text{tr}} - E\\,\\Delta\\gamma\\,R $$\n所有更新后的状态变量现在都用单个未知标量 $\\Delta\\gamma$ 表示。为了求得 $\\Delta\\gamma$，我们强制执行塑性一致性条件 $f^{n+1} = 0$：\n$$ f^{n+1} = | \\sigma^{n+1} - \\alpha^{n+1} | - \\left(\\sigma_{y}^{0} + H_{\\text{iso}}\\,\\kappa^{n+1}\\right) = 0 $$\n让我们代入更新后变量的表达式。首先，相对应力：\n$$ \\sigma^{n+1} - \\alpha^{n+1} = (\\sigma_{\\text{tr}} - E\\,\\Delta\\gamma\\,R) - (\\alpha^{n} + C\\,\\Delta\\gamma\\,R) = (\\sigma_{\\text{tr}} - \\alpha^{n}) - (E+C)\\,\\Delta\\gamma\\,R $$\n由于塑性修正会减小相对应力的量值，因此项 $(\\sigma^{n+1} - \\alpha^{n+1})$ 与 $(\\sigma_{\\text{tr}} - \\alpha^{n})$ 保持相同的符号 $R$。因此，我们可以取其绝对值：\n$$ | \\sigma^{n+1} - \\alpha^{n+1} | = | \\sigma_{\\text{tr}} - \\alpha^{n} | - (E+C)\\,\\Delta\\gamma $$\n更新后的屈服应力为：\n$$ \\sigma_{y}^{n+1} = \\sigma_{y}^{0} + H_{\\text{iso}}\\,\\kappa^{n+1} = \\sigma_{y}^{0} + H_{\\text{iso}}\\,(\\kappa^{n} + \\Delta\\gamma) $$\n根据一致性条件，将两个表达式相等：\n$$ | \\sigma_{\\text{tr}} - \\alpha^{n} | - (E+C)\\,\\Delta\\gamma = \\sigma_{y}^{0} + H_{\\text{iso}}\\,\\kappa^{n} + H_{\\text{iso}}\\,\\Delta\\gamma $$\n重新整理以求解 $\\Delta\\gamma$：\n$$ | \\sigma_{\\text{tr}} - \\alpha^{n} | - (\\sigma_{y}^{0} + H_{\\text{iso}}\\,\\kappa^{n}) = (E + C + H_{\\text{iso}})\\,\\Delta\\gamma $$\n左侧正好是试探屈服函数值 $f_{\\text{tr}}$。这得到了塑性乘子增量的最终表达式：\n$$ \\Delta\\gamma = \\frac{f_{\\text{tr}}}{E + C + H_{\\text{iso}}} $$\n由于 $f_{\\text{tr}} > 0$ 且材料模量 $E, C, H_{\\text{iso}}$ 是非负的（$E > 0$），因此 $\\Delta\\gamma > 0$，符合要求。\n\n一个增量的完整算法如下：\n1.  计算试探应力：$\\sigma_{\\text{tr}} = \\sigma^{n} + E\\,\\Delta\\varepsilon$。\n2.  计算试探屈服函数：$f_{\\text{tr}} = | \\sigma_{\\text{tr}} - \\alpha^{n} | - (\\sigma_{y}^{0} + H_{\\text{iso}}\\,\\kappa^{n})$。\n3.  如果 $f_{\\text{tr}} \\le 10^{-7}$，则该步为弹性步。更新后的状态为 $(\\sigma_{\\text{tr}}, \\varepsilon^{p\\,n}, \\kappa^{n}, \\alpha^{n})$。\n4.  如果 $f_{\\text{tr}} > 10^{-7}$，则该步为塑性步。\n    a. 计算 $\\Delta\\gamma = \\frac{f_{\\text{tr}}}{E + C + H_{\\text{iso}}}$。\n    b. 确定流动方向 $R = \\operatorname{sign}(\\sigma_{\\text{tr}} - \\alpha^{n})$。\n    c. 更新应力：$\\sigma^{n+1} = \\sigma_{\\text{tr}} - E\\,\\Delta\\gamma\\,R$。\n    d. 更新内部变量：\n       $\\varepsilon^{p\\,n+1} = \\varepsilon^{p\\,n} + \\Delta\\gamma\\,R$。\n       $\\kappa^{n+1} = \\kappa^{n} + \\Delta\\gamma$。\n       $\\alpha^{n+1} = \\alpha^{n} + C\\,\\Delta\\gamma\\,R$。\n此过程在以下程序中直接实现。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef update_state(E, sig_y0, H_iso, C, sig_n, ep_n, kap_n, alp_n, d_eps):\n    \"\"\"\n    Computes the updated state variables for a uniaxial elastic-plastic material\n    with combined linear isotropic and kinematic hardening using a return-mapping algorithm.\n\n    Args:\n        E (float): Young's modulus (MPa)\n        sig_y0 (float): Initial yield stress (MPa)\n        H_iso (float): Isotropic hardening modulus (MPa)\n        C (float): Kinematic hardening modulus (MPa)\n        sig_n (float): Stress at the beginning of the increment (MPa)\n        ep_n (float): Plastic strain at the beginning of the increment\n        kap_n (float): Accumulated plastic strain at the beginning of the increment\n        alp_n (float): Backstress at the beginning of the increment (MPa)\n        d_eps (float): Total strain increment\n\n    Returns:\n        tuple: Updated state variables (sig_np1, ep_np1, kap_np1, alp_np1)\n    \"\"\"\n    # Numerical tolerance for yield check\n    TOL = 1e-7\n\n    # 1. Compute elastic trial stress\n    sig_tr = sig_n + E * d_eps\n\n    # 2. Evaluate trial yield function\n    sig_y_n = sig_y0 + H_iso * kap_n\n    f_tr = np.abs(sig_tr - alp_n) - sig_y_n\n\n    # 3. Check for yielding\n    if f_tr = TOL:\n        # Elastic step\n        sig_np1 = sig_tr\n        ep_np1 = ep_n\n        kap_np1 = kap_n\n        alp_np1 = alp_n\n        return sig_np1, ep_np1, kap_np1, alp_np1\n    else:\n        # 4. Plastic step: enforce consistency\n        # Calculate plastic multiplier increment\n        denominator = E + C + H_iso\n        d_gamma = f_tr / denominator\n\n        # Determine flow direction\n        R = np.sign(sig_tr - alp_n)\n\n        # Update state variables\n        kap_np1 = kap_n + d_gamma\n        ep_np1 = ep_n + d_gamma * R\n        alp_np1 = alp_n + C * d_gamma * R\n        sig_np1 = sig_tr - E * d_gamma * R\n\n        return sig_np1, ep_np1, kap_np1, alp_np1\n\ndef solve():\n    \"\"\"\n    Main solver function to run the test suite and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: Isotropic hardening only, plastic step\n        {'E': 210000.0, 'sig_y0': 250.0, 'H_iso': 1000.0, 'C': 0.0, 'sig_n': 0.0, 'ep_n': 0.0, 'kap_n': 0.0, 'alp_n': 0.0, 'd_eps': 0.003},\n        # Case B: Isotropic hardening only, elastic step\n        {'E': 210000.0, 'sig_y0': 250.0, 'H_iso': 1000.0, 'C': 0.0, 'sig_n': 0.0, 'ep_n': 0.0, 'kap_n': 0.0, 'alp_n': 0.0, 'd_eps': 0.001},\n        # Case C: Kinematic hardening only, plastic step\n        {'E': 210000.0, 'sig_y0': 250.0, 'H_iso': 0.0, 'C': 30000.0, 'sig_n': 260.0, 'alp_n': 50.0, 'ep_n': 50.0/30000.0, 'kap_n': 50.0/30000.0, 'd_eps': 0.002},\n        # Case D: Combined hardening with reverse loading, plastic step\n        {'E': 210000.0, 'sig_y0': 250.0, 'H_iso': 2000.0, 'C': 40000.0, 'sig_n': 376.0, 'alp_n': 120.0, 'ep_n': 120.0/40000.0, 'kap_n': 120.0/40000.0, 'd_eps': -0.003},\n        # Case E: Boundary case exactly at yield, elastic\n        {'E': 210000.0, 'sig_y0': 300.0, 'H_iso': 500.0, 'C': 0.0, 'sig_n': 200.0, 'alp_n': 0.0, 'kap_n': 0.1, 'ep_n': 0.1, 'd_eps': (350.0 - 200.0)/210000.0},\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack case parameters and call the update function\n        sig_np1, ep_np1, kap_np1, alp_np1 = update_state(\n            case['E'], case['sig_y0'], case['H_iso'], case['C'],\n            case['sig_n'], case['ep_n'], case['kap_n'], case['alp_n'],\n            case['d_eps']\n        )\n        \n        # Round results to six decimal places and store as a list\n        result = [\n            round(sig_np1, 6),\n            round(ep_np1, 6),\n            round(kap_np1, 6),\n            round(alp_np1, 6)\n        ]\n        results.append(result)\n\n    # Format the final output as a string representing a list of lists.\n    # e.g., [[1.0,2.0,...],[3.0,4.0,...]]\n    # map(str, results) converts each inner list to its string representation.\n    # ','.join() combines these strings with commas.\n    # The outer brackets are added manually.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}