{
    "hands_on_practices": [
        {
            "introduction": "我们从一个结构力学中的经典问题开始我们的动手实践：静不定支撑悬臂梁。此练习展示了叠加原理如何将一个复杂的、原本无法直接求解的系统，转化为一组简单的、可解的悬臂梁问题之和，从而加深对变形协调概念的理解 。",
            "id": "630180",
            "problem": "一根长度为 $L$、抗弯刚度 $EI$ 恒定的均匀梁，其一端 $x=0$ 为固定（悬臂）端，另一端 $x=L$ 由一个简支座（支柱）支撑。这种结构被称为撑杆悬臂梁。该梁承受一个分布式的竖向荷载 $w(x)$，其集度从固定端的 $w_1$ 线性变化到支撑端的 $w_2$。因此，荷载分布由下式给出：\n$$\nw(x) = w_1 + (w_2 - w_1) \\frac{x}{L}\n$$\n该体系是静不定的。为了求解支座反力，必须考虑梁的挠度。叠加原理是进行此分析的一种有效方法。\n\n使用叠加原理，推导位于 $x=L$ 处的简支座上的竖向反力 $R_B$ 的表达式。\n\n为帮助推导，下面给出了长度为 $L$ 的悬臂梁在一些标准荷载工况下自由端的向下挠度：\n1.  自由端承受集中荷载 $P$：$\\delta_P = \\frac{PL^3}{3EI}$\n2.  集度为 $w$ 的均布荷载：$\\delta_w = \\frac{wL^4}{8EI}$\n3.  三角形分布荷载，固定端集度为 $0$，自由端集度为 $w_{max}$：$\\delta_{tri} = \\frac{w_{max}L^4}{30EI}$",
            "solution": "我们将悬臂梁上实际的线性变化荷载与在 $x=L$ 处向上的集中反力 $R_B$ 进行叠加，并施加 $x=L$ 处挠度为零的条件。\n\n1. 分解荷载\n   $$w(x)=w_1+\\frac{w_2-w_1}{L}x\n     =\\underbrace{w_1}_{\\text{均布}}+\\underbrace{\\frac{w_2-w_1}{L}x}_{\\text{三角形}}.$$  \n\n2. 由均布部分引起的自由端（$x=L$）挠度\n   $$\\delta_{\\rm uni}\n     =\\frac{w_1L^4}{8EI}.$$  \n\n3. 由三角形部分（固定端为零，自由端为 $w_2-w_1$）引起的挠度\n   $$\\delta_{\\rm tri}\n     =\\frac{(w_2-w_1)L^4}{30EI}.$$  \n\n4. 由自由端向上的集中荷载 $R_B$ 引起的挠度（以向下为正）\n   $$\\delta_{R_B}\n     =-\\,\\frac{R_B\\,L^3}{3EI}.$$  \n\n5. 变形协调条件：$x=L$ 处的总挠度为零\n   $$\\delta_{\\rm uni}+\\delta_{\\rm tri}+\\delta_{R_B}=0\n   \\;\\Longrightarrow\\;\n   \\frac{w_1L^4}{8EI}+\\frac{(w_2-w_1)L^4}{30EI}-\\frac{R_B\\,L^3}{3EI}=0.$$  \n\n6. 求解 $R_B$\n   $$\\frac{L^4}{EI}\\Bigl(\\frac{w_1}{8}+\\frac{w_2-w_1}{30}\\Bigr)\n     =\\frac{R_B\\,L^3}{3EI}\n   \\;\\Longrightarrow\\;\n   R_B\n     =3L\\Bigl(\\frac{w_1}{8}+\\frac{w_2-w_1}{30}\\Bigr)\n     =\\frac{L\\,(11w_1+4w_2)}{40}.$$",
            "answer": "$$\\boxed{\\frac{L\\,(11w_1+4w_2)}{40}}$$"
        },
        {
            "introduction": "在基础应用的铺垫之上，下一个问题深入探讨了建模的细微差别，通过比较欧拉-伯努利梁理论和铁木辛柯梁理论。你将通过在每个理论框架内应用叠加原理，来量化剪切变形的贡献，从而更深刻地理解线性理论背后的假设以及何时需要采用更高级的模型 。",
            "id": "2699126",
            "problem": "一根长度为 $L$、截面为宽 $b$ 高 $h$ 的矩形、杨氏模量为 $E$、剪切模量为 $G$、剪切修正系数为 $\\kappa$ 的直等截面均质线性弹性悬臂梁，在距离固定端 $x=c_{1}L$ 和 $x=c_{2}L$ 处（$0<c_{1}<c_{2}<1$）分别受到两个横向集中载荷 $P_1$ 和 $P_2$ 的作用。\n\nEuler-Bernoulli (EB) 梁理论和 Timoshenko (TB) 梁理论对梁挠度的预测不同，因为前者忽略了剪切变形。对于给定的载荷，预测的自由端挠度 $w_{\\mathrm{TB}}$ 将大于 $w_{\\mathrm{EB}}$。\n\n对于给定的载荷配置 $P_1 = 3.0 \\times 10^3\\,$N, $P_2 = 5.0 \\times 10^3\\,$N，$c_1=0.35$，$c_2=0.70$，材料属性 $\\nu=0.30$ 和 $\\kappa=5/6$，当两种理论预测的相对差异 $\\Delta = (w_{\\mathrm{TB}} - w_{\\mathrm{EB}}) / w_{\\mathrm{EB}}$ 达到 5%（即 $\\delta=0.05$）时，最小的梁长细比 $s^*=L/h$ 是多少？\n\n请将你的答案四舍五入到四位有效数字。",
            "solution": "该问题陈述提出了一个结构力学中的标准问题，旨在比较 Euler-Bernoulli 和 Timoshenko 梁理论。该问题具有科学依据、提法恰当、客观，并包含了获得唯一解所需的全部信息。因此，该问题被认为是有效的。求解过程如下：首先在两种理论下分别推导悬臂梁在单个集中载荷作用下的末端挠度，然后应用叠加原理，最后确定所需的长细比。\n\n首先，我们建立基本关系。设 $x$ 为沿梁中性轴的坐标，固定端位于 $x=0$。设 $w(x)$ 为横向挠度，$\\psi(x)$ 为截面转角，$M(x)$ 为弯矩，$V(x)$ 为剪力。材料是线性弹性的，杨氏模量为 $E$，剪切模量为 $G$。截面为矩形，宽为 $b$，高为 $h$，其面积 $A=bh$，截面二次矩 $I=\\frac{bh^3}{12}$。\n\n考虑一个作用在距固定端 $a$ 处的单个横向集中载荷 $P$（$0 < a \\le L$）。对于悬臂梁，在 $0 \\le x \\le a$ 段，内弯矩和剪力分别为 $M(x) = P(a-x)$ 和 $V(x) = P$。在 $a < x \\le L$ 段，$M(x)=0$ 且 $V(x)=0$。固定端（$x=0$）的边界条件是挠度为零，$w(0)=0$，转角为零。\n\n对于 Euler-Bernoulli (EB) 梁理论，我们假设平面截面在变形后仍垂直于中性轴，这意味着忽略了剪切变形。中性轴的转角为 $\\frac{dw}{dx}$。弯矩-曲率关系为：\n$$EI \\frac{d^2w}{dx^2} = M(x)$$\n我们对梁的两个分段分别积分该方程。\n对于 $0 \\le x \\le a$：\n$$EI \\frac{d^2w}{dx^2} = P(a-x)$$\n对 $x$ 积分得到斜率：\n$$EI \\frac{dw}{dx} = P(ax - \\frac{x^2}{2}) + C_1$$\n固定端的边界条件为 $\\frac{dw}{dx}(0) = 0$，由此可得 $C_1=0$。\n再次积分得到挠度：\n$$EI w(x) = P(\\frac{ax^2}{2} - \\frac{x^3}{6}) + C_2$$\n边界条件 $w(0)=0$ 得到 $C_2=0$。因此，对于 $0 \\le x \\le a$：\n$$w(x) = \\frac{P}{EI}\\left(\\frac{ax^2}{2} - \\frac{x^3}{6}\\right)$$\n对于梁段 $a < x \\le L$，$M(x)=0$，因此 $EI \\frac{d^2w}{dx^2} = 0$。积分得到一个线性的挠度分布。在 $x=a$ 处，斜率和挠度必须连续。\n$x=a$ 处的斜率为 $\\frac{dw}{dx}(a) = \\frac{P}{EI}(a^2 - \\frac{a^2}{2}) = \\frac{Pa^2}{2EI}$。\n$x=a$ 处的挠度为 $w(a) = \\frac{P}{EI}(\\frac{a^3}{2} - \\frac{a^3}{6}) = \\frac{Pa^3}{3EI}$。\n对于 $a < x \\le L$，斜率为常数，等于 $\\frac{dw}{dx}(a)$。因此，挠度为：\n$$w(x) = w(a) + \\frac{dw}{dx}(a) (x-a) = \\frac{Pa^3}{3EI} + \\frac{Pa^2}{2EI}(x-a)$$\n自由端（$x=L$）的挠度为：\n$$w_{\\mathrm{EB}}(L; P, a) = \\frac{Pa^3}{3EI} + \\frac{Pa^2}{2EI}(L-a) = \\frac{P}{6EI}(2a^3 + 3a^2L - 3a^3) = \\frac{Pa^2(3L-a)}{6EI}$$\n\n对于 Timoshenko (TB) 梁理论，我们考虑剪切变形。中性轴的总斜率 $\\frac{dw}{dx}$ 是截面转角 $\\psi$ 与截面平均剪应变 $\\gamma$ 的和。\n$$\\frac{dw}{dx} = \\psi + \\gamma$$\n本构关系为：\n$$M(x) = EI \\frac{d\\psi}{dx} \\quad \\text{and} \\quad V(x) = \\kappa G A \\gamma = \\kappa G A \\left(\\frac{dw}{dx} - \\psi\\right)$$\n其中 $\\kappa$ 是剪切修正系数。\n总挠度 $w(x)$ 可视为弯曲挠度 $w_b$ 和剪切挠度 $w_s$ 的和。弯曲分量由与 EB 梁相同的运动学关系支配，因此 $w_b(x)$ 与上面推导的 EB 挠度相同。\n$$w_b(L; P, a) = \\frac{Pa^2(3L-a)}{6EI}$$\n剪切挠度是通过对剪应变 $\\gamma = \\frac{V(x)}{\\kappa G A}$ 积分得到的。\n$$w_s(x) = \\int_0^x \\gamma(x') dx' = \\int_0^x \\frac{V(x')}{\\kappa G A} dx'$$\n对于作用在 $x=a$ 处的载荷 $P$，剪力在 $0 \\le x \\le a$ 段为 $V(x)=P$，在 $a < x \\le L$ 段为 $V(x)=0$。因此，剪切变形只发生在 $[0, a]$ 段。$[a, L]$ 段作为刚体，以 $x=a$ 处的剪切位移和转角进行平移和转动。由剪切引起的梁末端挠度就是累积到载荷作用点的挠度。\n$$w_s(L; P, a) = \\int_0^a \\frac{P}{\\kappa G A} dx = \\frac{Pa}{\\kappa G A}$$\nTimoshenko 理论下自由端的总挠度是弯曲和剪切贡献的总和：\n$$w_{\\mathrm{TB}}(L; P, a) = w_b(L; P, a) + w_s(L; P, a) = \\frac{Pa^2(3L-a)}{6EI} + \\frac{Pa}{\\kappa G A}$$\n\n现在，我们对两个载荷（$P_1$ 作用于 $a_1=c_1L$，$P_2$ 作用于 $a_2=c_2L$）应用叠加原理。\n自由端的总 Euler-Bernoulli 挠度为：\n$$w_{\\mathrm{EB}} = w_{\\mathrm{EB}}(L; P_1, c_1L) + w_{\\mathrm{EB}}(L; P_2, c_2L)$$\n$$w_{\\mathrm{EB}} = \\frac{P_1(c_1L)^2(3L-c_1L)}{6EI} + \\frac{P_2(c_2L)^2(3L-c_2L)}{6EI}$$\n$$w_{\\mathrm{EB}} = \\frac{L^3}{6EI} \\left[ P_1 c_1^2(3-c_1) + P_2 c_2^2(3-c_2) \\right]$$\n自由端的总 Timoshenko 挠度为：\n$$w_{\\mathrm{TB}} = w_{\\mathrm{TB}}(L; P_1, c_1L) + w_{\\mathrm{TB}}(L; P_2, c_2L)$$\n$$w_{\\mathrm{TB}} = \\left( \\frac{P_1(c_1L)^2(3L-c_1L)}{6EI} + \\frac{P_1(c_1L)}{\\kappa G A} \\right) + \\left( \\frac{P_2(c_2L)^2(3L-c_2L)}{6EI} + \\frac{P_2(c_2L)}{\\kappa G A} \\right)$$\n$$w_{\\mathrm{TB}} = w_{\\mathrm{EB}} + \\frac{L}{\\kappa G A} (P_1 c_1 + P_2 c_2)$$\n\n相对变化量 $\\Delta$ 定义为 $\\frac{w_{\\mathrm{TB}}-w_{\\mathrm{EB}}}{w_{\\mathrm{EB}}}$。\n$$\\Delta = \\frac{\\frac{L}{\\kappa G A} (P_1 c_1 + P_2 c_2)}{\\frac{L^3}{6EI} \\left[ P_1 c_1^2(3-c_1) + P_2 c_2^2(3-c_2) \\right]}$$\n为了用长细比 $s = L/h$ 来表示该式，我们代入 $I=\\frac{bh^3}{12}$、$A=bh$ 和弹性关系 $E=2G(1+\\nu)$。\n$$\\Delta = \\frac{L}{\\kappa G (bh)} \\frac{6E(\\frac{bh^3}{12})}{L^3} \\frac{P_1 c_1 + P_2 c_2}{P_1 c_1^2(3-c_1) + P_2 c_2^2(3-c_2)}$$\n$$\\Delta = \\frac{L}{\\kappa G bh} \\frac{Ebh^3}{2L^3} \\frac{P_1 c_1 + P_2 c_2}{P_1 c_1^2(3-c_1) + P_2 c_2^2(3-c_2)}$$\n$$\\Delta = \\frac{E}{\\kappa G} \\frac{h^2}{2L^2} \\frac{P_1 c_1 + P_2 c_2}{P_1 c_1^2(3-c_1) + P_2 c_2^2(3-c_2)} = \\frac{2G(1+\\nu)}{\\kappa G} \\frac{1}{2s^2} \\frac{P_1 c_1 + P_2 c_2}{P_1 c_1^2(3-c_1) + P_2 c_2^2(3-c_2)}$$\n$$\\Delta = \\frac{1+\\nu}{\\kappa s^2} \\frac{P_1 c_1 + P_2 c_2}{P_1 c_1^2(3-c_1) + P_2 c_2^2(3-c_2)}$$\n我们的任务是找到使 $\\Delta = \\delta$ 成立的最小长细比 $s^*$。\n$$\\delta = \\frac{1+\\nu}{\\kappa (s^*)^2} \\frac{P_1 c_1 + P_2 c_2}{P_1 c_1^2(3-c_1) + P_2 c_2^2(3-c_2)}$$\n解出 $s^*$：\n$$s^* = \\sqrt{\\frac{1+\\nu}{\\kappa \\delta} \\frac{P_1 c_1 + P_2 c_2}{P_1 c_1^2(3-c_1) + P_2 c_2^2(3-c_2)}}$$\n\n最后，我们代入给定的数值：$P_1 = 3.0 \\times 10^3\\,$N, $P_2 = 5.0 \\times 10^3\\,$N, $c_1=0.35$, $c_2=0.70$, $\\nu=0.30$, $\\kappa=5/6$, and $\\delta=0.05$。载荷中的因子 $10^3$ 会被约掉，所以我们使用 $P_1=3.0$ 和 $P_2=5.0$。\n\n首先，计算无量纲载荷因子：\n$$ \\mathcal{F} = \\frac{P_1 c_1 + P_2 c_2}{P_1 c_1^2(3-c_1) + P_2 c_2^2(3-c_2)} $$\n分子：$P_1 c_1 + P_2 c_2 = (3.0)(0.35) + (5.0)(0.70) = 1.05 + 3.5 = 4.55$。\n分母：\n$P_1 c_1^2(3-c_1) = (3.0)(0.35)^2(3-0.35) = (3.0)(0.1225)(2.65) = 0.973875$。\n$P_2 c_2^2(3-c_2) = (5.0)(0.70)^2(3-0.70) = (5.0)(0.49)(2.3) = 5.635$。\n分母为 $0.973875 + 5.635 = 6.608875$。\n所以，$\\mathcal{F} = \\frac{4.55}{6.608875} \\approx 0.6884606$。\n\n接下来，计算材料和阈值因子：\n$$ \\frac{1+\\nu}{\\kappa \\delta} = \\frac{1+0.30}{(5/6) \\times 0.05} = \\frac{1.3}{5/6 \\times 1/20} = \\frac{1.3}{5/120} = \\frac{1.3 \\times 120}{5} = 1.3 \\times 24 = 31.2 $$\n\n现在，我们可以求出 $(s^*)^2$：\n$$ (s^*)^2 = \\left( \\frac{1+\\nu}{\\kappa \\delta} \\right) \\mathcal{F} = (31.2) \\left( \\frac{4.55}{6.608875} \\right) \\approx 21.480051 $$\n长细比是其平方根：\n$$ s^* = \\sqrt{21.480051} \\approx 4.634657 $$\n四舍五入到四位有效数字，得到 $s^*=4.635$。\n这个结果在物理上是合理的；它表明对于这种加载配置，在一个长细比较低的粗短梁上，剪切变形的贡献达到了弯曲挠度的 5%。",
            "answer": "$$\\boxed{4.635}$$"
        },
        {
            "introduction": "我们最后的实践将从解析推导过渡到计算领域，在现代工程中，叠加原理正是在这里找到了其最强大的应用。这个问题要求你通过预先计算影响向量，为大型线性系统实现一种高效的求解策略，这直接模拟了有限元分析软件中处理多工况载荷时，为避免昂贵的重复计算所使用的技术 。",
            "id": "2699158",
            "problem": "一个离散线性弹性系统由一个对称正定刚度矩阵 $K \\in \\mathbb{R}^{n \\times n}$ 建模，该矩阵通过线性平衡方程 $K u = f$ 将节点位移向量 $u \\in \\mathbb{R}^{n}$ 与节点力向量 $f \\in \\mathbb{R}^{n}$ 关联起来。根据映射 $f \\mapsto u$ 的线性性质，叠加原理成立。本题要求你通过从一小组典型影响解中组合响应，来高效地计算多种稀疏载荷模式下的响应，此过程不显式构造 $K^{-1}$，且在每个测试用例中对 $K$ 的分解不超过一次。假设 $K$ 是时不变的且独立于 $f$。\n\n从基本的动量守恒和线性弹性假设出发：离散系统的平衡要求 $K u = f$，其中 $K$ 源于一个稳定的线性本构关系和协调的运动学，因此 $K$ 是对称正定的。运用这些原理，从第一性原理出发设计一种算法，通过利用线性性质来最小化对多种载荷模式的重复计算工作。除了通用线性代数之外，不要使用任何特定问题领域的预封装捷径。\n\n你的程序必须对自由度使用基于 $0$ 的索引来解决以下测试套件。必须遵守所有物理单位：刚度矩阵的元素单位为牛顿/米 ($\\mathrm{N/m}$)，力的单位为牛顿 ($\\mathrm{N}$)，位移的单位为米 ($\\mathrm{m}$)，应变能的单位为焦耳 ($\\mathrm{J}$)。对于每个测试用例，预先计算一个最小的典型影响响应集，然后对于每种载荷模式，利用这些影响响应通过叠加来组合出位移向量。对于每种载荷模式，仅报告以焦耳为单位的总应变能 $U = \\tfrac{1}{2} f^{\\mathsf{T}} u$。将每个以焦耳为单位的应变能表示为一个四舍五入到六位小数的十进制数。\n\n你的程序在每个测试用例中必须满足的约束条件：\n- 每个测试用例最多对 $K$ 进行一次矩阵分解。\n- 不显式构造 $K^{-1}$。\n- 通过预先计算对应于一组指定的可加载自由度的影响响应来使用叠加原理。\n- 每个给定的载荷向量的非零项仅出现在指定的可加载自由度上。\n\n测试套件。共有 $3$ 个独立的测试用例。对于每个测试用例，都指定了刚度矩阵 $K$、一个可加载自由度索引集 $\\mathcal{I}$ 以及一个载荷向量列表 $\\{ f^{(j)} \\}$。索引是基于 $0$ 的，向量按坐标顺序列出。\n\n- 测试用例 $1$：\n  - 尺寸 $n = 4$。\n  - 刚度\n    $$K_1 = 1000 \\cdot\n    \\begin{bmatrix}\n    2  -1  0  0 \\\\\n    -1  2  -1  0 \\\\\n    0  -1  2  -1 \\\\\n    0  0  -1  2\n    \\end{bmatrix} \\quad [\\mathrm{N/m}].$$\n  - 可加载索引 $\\mathcal{I}_1 = \\{0, 3\\}$。\n  - 载荷向量（单位：牛顿）：\n    $$f_1^{(1)} = \\begin{bmatrix} 100 \\\\ 0 \\\\ 0 \\\\ 0 \\end{bmatrix}, \\quad\n      f_1^{(2)} = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 50 \\end{bmatrix}, \\quad\n      f_1^{(3)} = \\begin{bmatrix} 60 \\\\ 0 \\\\ 0 \\\\ 40 \\end{bmatrix}, \\quad\n      f_1^{(4)} = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{bmatrix}。$$\n\n- 测试用例 $2$：\n  - 尺寸 $n = 5$。\n  - 刚度\n    $$K_2 = 1500 \\cdot\n    \\begin{bmatrix}\n    2  -1  0  0  0 \\\\\n    -1  2  -1  0  0 \\\\\n    0  -1  2  -1  0 \\\\\n    0  0  -1  2  -1 \\\\\n    0  0  0  -1  2\n    \\end{bmatrix} \\quad [\\mathrm{N/m}].$$\n  - 可加载索引 $\\mathcal{I}_2 = \\{1, 4\\}$。\n  - 载荷向量（单位：牛顿）：\n    $$f_2^{(1)} = \\begin{bmatrix} 0 \\\\ 120 \\\\ 0 \\\\ 0 \\\\ 0 \\end{bmatrix}, \\quad\n      f_2^{(2)} = \\begin{bmatrix} 0 \\\\ 80 \\\\ 0 \\\\ 0 \\\\ 40 \\end{bmatrix}, \\quad\n      f_2^{(3)} = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 100 \\end{bmatrix}, \\quad\n      f_2^{(4)} = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{bmatrix}。$$\n\n- 测试用例 $3$：\n  - 尺寸 $n = 3$。\n  - 刚度\n    $$K_3 = 500 \\cdot\n    \\begin{bmatrix}\n    2  -1  0 \\\\\n    -1  2  -1 \\\\\n    0  -1  2\n    \\end{bmatrix} \\quad [\\mathrm{N/m}].$$\n  - 可加载索引 $\\mathcal{I}_3 = \\{1\\}$。\n  - 载荷向量（单位：牛顿）：\n    $$f_3^{(1)} = \\begin{bmatrix} 0 \\\\ 75 \\\\ 0 \\end{bmatrix}, \\quad\n      f_3^{(2)} = \\begin{bmatrix} 0 \\\\ 0 \\\\ 0 \\end{bmatrix}, \\quad\n      f_3^{(3)} = \\begin{bmatrix} 0 \\\\ 150 \\\\ 0 \\end{bmatrix}。$$\n\n所需输出。你的程序应生成单行输出，该行包含用方括号括起来的、以逗号分隔的结果列表。该列表应为每个测试用例包含一个条目，顺序与上文相同。每个条目必须是一个十进制数列表，其中每个数字是对应载荷向量（按给定顺序）的应变能 $U = \\tfrac{1}{2} f^{\\mathsf{T}} u$（单位为焦耳），并四舍五入到六位小数。例如，总体格式应为\n$$[\\,[U_{1}^{(1)}, U_{1}^{(2)}, \\dots],\\ [U_{2}^{(1)}, U_{2}^{(2)}, \\dots],\\ [U_{3}^{(1)}, U_{3}^{(2)}, \\dots]\\,],$$\n其中所有 $U$ 均以 $\\mathrm{J}$ 为单位，表示为四舍五入到六位小数的十进制数。",
            "solution": "在尝试求解之前，对问题进行验证。\n\n### 步骤 1：提取已知条件\n- **控制方程**：离散线性弹性系统由平衡方程 $K u = f$ 控制，其中 $K \\in \\mathbb{R}^{n \\times n}$ 是对称正定刚度矩阵，$u \\in \\mathbb{R}^{n}$ 是节点位移向量，$f \\in \\mathbb{R}^{n}$ 是节点力向量。\n- **叠加原理**：明确指出了映射 $f \\mapsto u$ 的线性性质。\n- **应变能**：总应变能由公式 $U = \\tfrac{1}{2} f^{\\mathsf{T}} u$ 给出。\n- **方法约束**：\n    1.  每个测试用例最多对 $K$ 进行一次矩阵分解。\n    2.  不显式计算矩阵逆 $K^{-1}$。\n    3.  通过预计算对典型载荷的响应来使用叠加原理。\n    4.  载荷向量是稀疏的，非零项仅出现在指定的可加载自由度（DOF）上。\n- **测试用例**：提供了三个测试用例。每个测试用例包含一个刚度矩阵 $K$、一个可加载自由度索引集 $\\mathcal{I}$ 和一个载荷向量列表 $\\{ f^{(j)} \\}$。\n    - **测试用例 1**：\n        - $n = 4$\n        - $K_1 = 1000 \\cdot [[2, -1, 0, 0], [-1, 2, -1, 0], [0, -1, 2, -1], [0, 0, -1, 2]]$ $\\mathrm{N/m}$\n        - $\\mathcal{I}_1 = \\{0, 3\\}$\n        - $f_1^{(1)} = [100, 0, 0, 0]^{\\mathsf{T}}$ $\\mathrm{N}$，$f_1^{(2)} = [0, 0, 0, 50]^{\\mathsf{T}}$ $\\mathrm{N}$，$f_1^{(3)} = [60, 0, 0, 40]^{\\mathsf{T}}$ $\\mathrm{N}$，$f_1^{(4)} = [0, 0, 0, 0]^{\\mathsf{T}}$ $\\mathrm{N}$\n    - **测试用例 2**：\n        - $n = 5$\n        - $K_2 = 1500 \\cdot [[2, -1, 0, 0, 0], [-1, 2, -1, 0, 0], [0, -1, 2, -1, 0], [0, 0, -1, 2, -1], [0, 0, 0, -1, 2]]$ $\\mathrm{N/m}$\n        - $\\mathcal{I}_2 = \\{1, 4\\}$\n        - $f_2^{(1)} = [0, 120, 0, 0, 0]^{\\mathsf{T}}$ $\\mathrm{N}$，$f_2^{(2)} = [0, 80, 0, 0, 40]^{\\mathsf{T}}$ $\\mathrm{N}$，$f_2^{(3)} = [0, 0, 0, 0, 100]^{\\mathsf{T}}$ $\\mathrm{N}$，$f_2^{(4)} = [0, 0, 0, 0, 0]^{\\mathsf{T}}$ $\\mathrm{N}$\n    - **测试用例 3**：\n        - $n = 3$\n        - $K_3 = 500 \\cdot [[2, -1, 0], [-1, 2, -1], [0, -1, 2]]$ $\\mathrm{N/m}$\n        - $\\mathcal{I}_3 = \\{1\\}$\n        - $f_3^{(1)} = [0, 75, 0]^{\\mathsf{T}}$ $\\mathrm{N}$，$f_3^{(2)} = [0, 0, 0]^{\\mathsf{T}}$ $\\mathrm{N}$，$f_3^{(3)} = [0, 150, 0]^{\\mathsf{T}}$ $\\mathrm{N}$\n- **输出要求**：对于每个测试用例，以嵌套列表格式报告每个载荷向量的应变能列表，四舍五入到六位小数。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题基于线弹性力学和结构力学的基本原理，即离散系统的平衡方程 $K u = f$ 以及作为线性直接推论的叠加原理。所提供的刚度矩阵是对称的，并且（对于这种结构是众所周知的）是正定的，这与稳定的弹性系统相符。应变能的定义 $U = \\tfrac{1}{2} f^{\\mathsf{T}} u$ 对于线性弹性系统是正确的。该问题在科学上是合理的。\n- **适定性**：刚度矩阵 $K$ 被说明为对称正定，这意味着它是可逆的。因此，对于任意给定的力向量 $f$，都存在唯一的位移向量 $u = K^{-1}f$。该问题是适定的。\n- **客观性**：该问题使用精确的数学符号和客观的物理量进行描述。没有主观或模糊的陈述。\n- **完整性与一致性**：为每个测试用例提供了所有必要的数据（$K$, $\\mathcal{I}$, $f^{(j)}$）和公式。对求解方法的约束定义清晰且不矛盾。该问题是自洽且一致的。\n- **可行性**：数值和矩阵结构是力学学术问题中的标准形式。不存在物理上不可能的条件或量纲不一致的数据。\n\n### 步骤 3：结论与行动\n问题陈述是有效的。它具有科学依据、适定、客观且完整。将根据要求，基于利用叠加原理来构建解决方案。\n\n### 解法推导\n静态、离散线性弹性系统的控制方程为\n$$K u = f$$\n其中 $K$ 是刚度矩阵，$u$ 是位移向量，$f$ 是力向量。由于 $K$ 是一个常数矩阵，这代表了从力空间到位移空间的线性变换。其形式解为 $u = K^{-1}f$。这种线性性质引出了叠加原理。\n\n问题指明，对于任何给定的测试用例，所有施加的载荷向量 $f$ 的非零分量仅出现在一个小的、固定的自由度（DOF）集合上，该集合由索引集 $\\mathcal{I}$ 表示。设第 $k$ 个自由度的标准基向量为 $e_k$，它是在索引 $k$ 处为 $1$、其他位置为 $0$ 的向量。任何此类载荷向量 $f$ 都可以表示为这些基向量（对于 $k \\in \\mathcal{I}$）的线性组合：\n$$f = \\sum_{k \\in \\mathcal{I}} f_k e_k$$\n其中 $f_k$ 是施加在自由度 $k$ 上的力的大小。\n\n根据叠加原理，对组合载荷 $f$ 的位移响应 $u$ 是对每个单独载荷分量的响应进行相应缩放后的总和：\n$$u = K^{-1}f = K^{-1} \\left( \\sum_{k \\in \\mathcal{I}} f_k e_k \\right) = \\sum_{k \\in \\mathcal{I}} f_k (K^{-1} e_k)$$\n\n这种结构提示了一种高效的计算策略。我们可以预先计算一组“影响向量”。一个影响向量（我们记为 $u^{(k)}$）是系统对施加在单个自由度 $k$ 上的单位载荷的位移响应。在数学上，$u^{(k)}$ 是线性方程组 $K u^{(k)} = e_k$ 的解：\n$$K u^{(k)} = e_k$$\n因此，$u^{(k)} = K^{-1}e_k$。请注意，$u^{(k)}$ 就是逆矩阵 $K^{-1}$ 的第 $k$ 列。然而，题目禁止显式计算 $K^{-1}$。相反，我们可以对每个 $k \\in \\mathcal{I}$ 求解方程组 $K u^{(k)} = e_k$ 来找到所需的影响向量。\n\n一旦预先计算出影响向量集 $\\{u^{(k)} \\mid k \\in \\mathcal{I}\\}$，对于任何给定的载荷向量 $f^{(j)}$，其位移响应 $u^{(j)}$ 就可以通过线性组合快速组合而成：\n$$u^{(j)} = \\sum_{k \\in \\mathcal{I}} f_k^{(j)} u^{(k)}$$\n其中 $f_k^{(j)}$ 是向量 $f^{(j)}$ 的第 $k$ 个分量。\n\n最后，使用其定义计算每个载荷工况的应变能 $U^{(j)}$：\n$$U^{(j)} = \\frac{1}{2} (f^{(j)})^{\\mathsf{T}} u^{(j)}$$\n\n每个测试用例的总体算法如下：\n1.  **预计算**：\n    a.  对刚度矩阵 $K$ 进行一次分解。由于 $K$ 是对称正定的，Cholesky 分解（$K = LL^{\\mathsf{T}}$）是最高效的选择。这次单次分解符合问题约束。\n    b.  对于可加载自由度集合 $\\mathcal{I}$ 中的每个索引 $k$：\n        i.  构造单位载荷向量 $e_k$。\n        ii. 求解线性方程组 $K u^{(k)} = e_k$ 以找到影响向量 $u^{(k)}$。这一步可以通过使用预先计算的 Cholesky 因子（前向和后向代入）来高效完成，从而避免了重新分解和显式求逆。\n    c.  存储计算出的影响向量 $\\{u^{(k)}\\}_{k \\in \\mathcal{I}}$。\n\n2.  **响应计算**：\n    a.  对于测试用例中提供的每个载荷向量 $f^{(j)}$：\n        i.  将总位移向量 $u^{(j)}$ 初始化为零向量。\n        ii. 通过对每个可加载自由度的贡献求和来组合总位移：$u^{(j)} = \\sum_{k \\in \\mathcal{I}} f_k^{(j)} u^{(k)}$。\n        iii. 计算应变能：$U^{(j)} = \\frac{1}{2} (f^{(j)})^{\\mathsf{T}} u^{(j)}$。\n    b.  收集测试用例中所有载荷向量的计算能量。\n\n该算法满足所有问题约束，即每个测试用例只执行一次分解，避免了显式矩阵求逆，并利用叠加原理来高效计算多种载荷场景下的响应。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import cho_factor, cho_solve\n\ndef solve():\n    \"\"\"\n    Solves a series of linear elastic problems using the principle of superposition.\n    For each test case, it pre-computes influence vectors for a set of loadable\n    degrees of freedom and then assembles the response for various load patterns.\n    The final output is the strain energy for each load pattern.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"K\": 1000.0 * np.array([\n                [2, -1, 0, 0],\n                [-1, 2, -1, 0],\n                [0, -1, 2, -1],\n                [0, 0, -1, 2]\n            ]),\n            \"loadable_indices\": [0, 3],\n            \"load_vectors\": [\n                np.array([100.0, 0, 0, 0]),\n                np.array([0, 0, 0, 50.0]),\n                np.array([60.0, 0, 0, 40.0]),\n                np.array([0, 0, 0, 0])\n            ]\n        },\n        {\n            \"K\": 1500.0 * np.array([\n                [2, -1, 0, 0, 0],\n                [-1, 2, -1, 0, 0],\n                [0, -1, 2, -1, 0],\n                [0, 0, -1, 2, -1],\n                [0, 0, 0, -1, 2]\n            ]),\n            \"loadable_indices\": [1, 4],\n            \"load_vectors\": [\n                np.array([0, 120.0, 0, 0, 0]),\n                np.array([0, 80.0, 0, 0, 40.0]),\n                np.array([0, 0, 0, 0, 100.0]),\n                np.array([0, 0, 0, 0, 0])\n            ]\n        },\n        {\n            \"K\": 500.0 * np.array([\n                [2, -1, 0],\n                [-1, 2, -1],\n                [0, -1, 2]\n            ]),\n            \"loadable_indices\": [1],\n            \"load_vectors\": [\n                np.array([0, 75.0, 0]),\n                np.array([0, 0, 0]),\n                np.array([0, 150.0, 0])\n            ]\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        K = case[\"K\"]\n        loadable_indices = case[\"loadable_indices\"]\n        load_vectors = case[\"load_vectors\"]\n        n = K.shape[0]\n        \n        # Precomputation Step\n        # 1. Factorize the stiffness matrix K = L L^T once.\n        # Since K is symmetric positive-definite, Cholesky factorization is used.\n        try:\n            c, low = cho_factor(K, lower=True)\n        except np.linalg.LinAlgError:\n            # This should not happen for the given valid matrices.\n            # Handle error gracefully if it occurs in a general case.\n            all_results.append([])\n            continue\n\n        # 2. Compute and store influence vectors for each loadable DOF.\n        # An influence vector u_k is the response to a unit load e_k at DOF k.\n        influence_vectors = {}\n        for k in loadable_indices:\n            # Create the unit load vector e_k.\n            e_k = np.zeros(n)\n            e_k[k] = 1.0\n            \n            # Solve K u_k = e_k using the precomputed Cholesky factorization.\n            u_k = cho_solve((c, low), e_k)\n            influence_vectors[k] = u_k\n\n        # Response Calculation Step\n        case_energies = []\n        for f in load_vectors:\n            # Assemble the total displacement u using superposition.\n            u = np.zeros(n)\n            for k in loadable_indices:\n                force_component = f[k]\n                if force_component != 0.0:\n                    u += force_component * influence_vectors[k]\n            \n            # Calculate strain energy U = 0.5 * f^T * u.\n            energy = 0.5 * np.dot(f, u)\n            \n            # Round to six decimal places as required.\n            case_energies.append(round(energy, 6))\n            \n        all_results.append(case_energies)\n\n    # Format the final output string exactly as specified.\n    # The str() of a list of lists is close, we just remove spaces.\n    final_output_string = str(all_results).replace(\" \", \"\")\n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}