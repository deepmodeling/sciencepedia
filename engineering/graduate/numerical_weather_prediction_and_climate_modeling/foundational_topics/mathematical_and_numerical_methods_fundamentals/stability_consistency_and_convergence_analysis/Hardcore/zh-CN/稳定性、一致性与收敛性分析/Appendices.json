{
    "hands_on_practices": [
        {
            "introduction": "本练习是偏微分方程数值分析的基石。它涉及为迎风格式推导 Courant-Friedrichs-Lewy (CFL) 条件，迎风格式是求解平流问题最简单、最稳健的方法之一。通过傅里叶稳定性分析（von Neumann 分析），你将直接看到数值格式的稳定性如何依赖于物理波速和网格分辨率，从而对制约显式时间积分方法的因素有基本的理解。",
            "id": "4092885",
            "problem": "考虑一个长度为$L$的一维纬向周期性通道中被动示踪物的线性平流偏微分方程 (PDE) $u_{t} + c\\,u_{x} = 0$，其中$c$是一个空间均匀的波速，代表数值天气预报 (NWP) 或气候模拟背景下的平均纬向流。该区域在均匀网格上进行离散化，网格间距为$\\Delta x$，时间步长为$\\Delta t$。在网格点$x_{i} = i\\,\\Delta x$和时间$t^{n} = n\\,\\Delta t$上，离散解记为$u_{i}^{n} \\approx u(x_{i}, t^{n})$。迎风格式是在均匀网格上，通过对线性通量函数$f(u) = c\\,u$使用单调Godunov数值通量，从守恒通量形式$u_{t} + \\partial_{x} (c\\,u) = 0$构建的：\n- 若$c > 0$，取$F_{i+1/2}^{n} = c\\,u_{i}^{n}$且$F_{i-1/2}^{n} = c\\,u_{i-1}^{n}$。\n- 若$c  0$，取$F_{i+1/2}^{n} = c\\,u_{i+1}^{n}$且$F_{i-1/2}^{n} = c\\,u_{i}^{n}$。\n\n定义无量纲库朗数$\\nu = c\\,\\Delta t / \\Delta x$。使用带有周期性边界条件的傅里叶 (von Neumann) 稳定性分析，推导迎风格式稳定性的Courant–Friedrichs–Lewy (CFL) 约束对$\\nu$的要求。明确描述$\\nu$的允许范围和模板方向如何依赖于$c$的符号。然后，使用你推导出的稳定性约束，给出最大稳定时间步长$\\Delta t_{\\max}$作为$\\Delta x$和$c$函数的闭式表达式。你必须从偏微分方程、守恒通量形式和Godunov通量选择出发，逻辑地推导出放大因子和最终的稳定区域；不要假设或引用任何迎风格式的目标稳定性结果。\n\n将最终的最大稳定时间步长表示为符号解析表达式。无需四舍五入。答案框内的最终答案必须是无量纲的。",
            "solution": "出发点是常数$c$的线性平流偏微分方程 (PDE) $u_{t} + c\\,u_{x} = 0$。其守恒通量形式为$u_{t} + \\partial_{x}(f(u)) = 0$，其中$f(u) = c\\,u$。\n\n在一个网格间距为$\\Delta x$、时间步长为$\\Delta t$的均匀网格上，单元平均值的一个有限体积更新（或在均匀网格上点值的一个密切相关的有限差分更新）可以写成\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+1/2}^{n} - F_{i-1/2}^{n}\\right),\n$$\n其中$F_{i\\pm 1/2}^{n}$是一个与$f(u) = c\\,u$相容且为保证稳定性而单调的数值通量。对于具有恒定输运速度$c$的线性通量，Godunov通量简化为依赖于$c$符号的迎风选择：\n- 若$c > 0$，特征线向右移动，因此使用迎风（左侧）状态：$F_{i+1/2}^{n} = c\\,u_{i}^{n}$且$F_{i-1/2}^{n} = c\\,u_{i-1}^{n}$。\n- 若$c  0$，特征线向左移动，因此使用迎风（右侧）状态：$F_{i+1/2}^{n} = c\\,u_{i+1}^{n}$且$F_{i-1/2}^{n} = c\\,u_{i}^{n}$。\n\n将这些代入更新方程，得到经典的迎风格式，根据$c$的符号分为两种情况。定义无量纲库朗数$\\nu = c\\,\\Delta t / \\Delta x$。\n\n情况$c > 0$：\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\frac{\\Delta t}{\\Delta x}\\left(c\\,u_{i}^{n} - c\\,u_{i-1}^{n}\\right)\n= u_{i}^{n} - \\nu\\left(u_{i}^{n} - u_{i-1}^{n}\\right)\n= (1 - \\nu)u_{i}^{n} + \\nu\\,u_{i-1}^{n}.\n$$\n\n情况$c  0$：\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\frac{\\Delta t}{\\Delta x}\\left(c\\,u_{i+1}^{n} - c\\,u_{i}^{n}\\right)\n= u_{i}^{n} - \\nu\\left(u_{i+1}^{n} - u_{i}^{n}\\right)\n= (1 + \\nu)u_{i}^{n} - \\nu\\,u_{i+1}^{n}.\n$$\n注意在这种情况下$\\nu  0$，因此方便定义$\\mu = -\\nu = |c|\\,\\Delta t / \\Delta x \\ge 0$，得到\n$$\nu_{i}^{n+1} = (1 - \\mu)u_{i}^{n} + \\mu\\,u_{i+1}^{n}.\n$$\n\n我们假设周期性边界条件，进行 von Neumann 稳定性分析。设离散解分解为傅里叶模态，\n$$\nu_{i}^{n} = \\hat{u}^{n}\\,\\exp\\!\\left(\\mathrm{i}\\,k\\,x_{i}\\right) = \\hat{u}^{n}\\,\\exp\\!\\left(\\mathrm{i}\\,k\\,i\\,\\Delta x\\right),\n$$\n其中$k$是波数，$\\mathrm{i}$是虚数单位。每个模态的更新定义了一个放大因子$G(k)$，使得$\\hat{u}^{n+1} = G(k)\\,\\hat{u}^{n}$。傅里叶模态有界增长意义下的稳定性要求对所有容许的$k$都有$|G(k)| \\le 1$。\n\n情况$c > 0$：\n使用$u_{i-1}^{n} = u_{i}^{n}\\,\\exp\\!\\left(-\\mathrm{i}\\,k\\,\\Delta x\\right)$，\n$$\nG(k) = (1 - \\nu) + \\nu\\,\\exp\\!\\left(-\\mathrm{i}\\,k\\,\\Delta x\\right).\n$$\n令$\\theta = k\\,\\Delta x$。则\n$$\nG(\\theta) = 1 - \\nu\\left(1 - \\exp(-\\mathrm{i}\\,\\theta)\\right).\n$$\n计算其模：\n\\begin{align*}\n1 - \\exp(-\\mathrm{i}\\,\\theta) = 1 - \\cos\\theta + \\mathrm{i}\\,\\sin\\theta, \\\\\nG(\\theta) = 1 - \\nu(1 - \\cos\\theta) - \\mathrm{i}\\,\\nu\\,\\sin\\theta, \\\\\n|G(\\theta)|^{2} = \\left[1 - \\nu(1 - \\cos\\theta)\\right]^{2} + \\left[\\nu\\,\\sin\\theta\\right]^{2} \\\\\n= 1 - 2\\,\\nu(1 - \\cos\\theta) + \\nu^{2}\\left[(1 - \\cos\\theta)^{2} + \\sin^{2}\\theta\\right].\n\\end{align*}\n使用三角恒等式$(1 - \\cos\\theta)^{2} + \\sin^{2}\\theta = 2(1 - \\cos\\theta)$来简化：\n$$\n|G(\\theta)|^{2} = 1 - 2\\,\\nu(1 - \\cos\\theta) + 2\\,\\nu^{2}(1 - \\cos\\theta) = 1 - 2(1 - \\cos\\theta)\\,\\nu(1 - \\nu).\n$$\n因为对所有$\\theta$都有$1 - \\cos\\theta \\ge 0$，最坏情况的界对应于$1 - \\cos\\theta$的最大值，即在$\\theta = \\pi$时的$2$。因子$\\nu(1 - \\nu)$是非负的当且仅当$0 \\le \\nu \\le 1$。对于$0 \\le \\nu \\le 1$，我们对所有$\\theta$都有$|G(\\theta)|^{2} \\le 1$。如果$\\nu  0$或$\\nu > 1$，则$\\nu(1 - \\nu)  0$，并且对于足够大的$1 - \\cos\\theta$，$|G(\\theta)|^{2} > 1$，意味着不稳定。因此，对于$c > 0$，CFL稳定范围是\n$$\n0 \\le \\nu \\le 1,\n$$\n此时格式使用左迎风模板$u_{i-1}^{n}$。\n\n情况$c  0$：\n使用$\\mu = -\\nu \\ge 0$和$u_{i+1}^{n} = u_{i}^{n}\\,\\exp\\!\\left(\\mathrm{i}\\,k\\,\\Delta x\\right)$，\n$$\nG(k) = (1 - \\mu) + \\mu\\,\\exp\\!\\left(\\mathrm{i}\\,k\\,\\Delta x\\right).\n$$\n令$\\theta = k\\,\\Delta x$。则\n$$\nG(\\theta) = 1 + \\mu\\left(\\exp(\\mathrm{i}\\,\\theta) - 1\\right) = 1 - \\mu(1 - \\cos\\theta) + \\mathrm{i}\\,\\mu\\,\\sin\\theta.\n$$\n模的平方为\n\\begin{align*}\n|G(\\theta)|^{2} = \\left[1 - \\mu(1 - \\cos\\theta)\\right]^{2} + \\left[\\mu\\,\\sin\\theta\\right]^{2} \\\\\n= 1 - 2\\,\\mu(1 - \\cos\\theta) + 2\\,\\mu^{2}(1 - \\cos\\theta) \\\\\n= 1 - 2(1 - \\cos\\theta)\\,\\mu(1 - \\mu).\n\\end{align*}\n根据相同的推理，稳定性要求$0 \\le \\mu \\le 1$，用$\\nu$表示即为$-1 \\le \\nu \\le 0$。对于$c  0$，格式使用右迎风模板$u_{i+1}^{n}$。\n\n因此，迎风格式的Courant–Friedrichs–Lewy (CFL) 稳定性条件是\n$$\n\\text{若 } c > 0,\\quad 0 \\le \\nu \\le 1;\\qquad \\text{若 } c  0,\\quad -1 \\le \\nu \\le 0.\n$$\n等价地，在这两种情况下，都必须满足模约束$|\\nu| \\le 1$，其中$\\nu$的符号由$c$的符号决定，并相应地选择模板（$c > 0$时为左迎风，$c  0$时为右迎风）。\n\n为了将最大稳定时间步长$\\Delta t_{\\max}$表示为$\\Delta x$和$c$的函数，注意到$|\\nu| \\le 1$意味着\n$$\n\\left|\\frac{c\\,\\Delta t}{\\Delta x}\\right| \\le 1 \\quad \\Longrightarrow \\quad \\Delta t \\le \\frac{\\Delta x}{|c|}.\n$$\n因此，\n$$\n\\Delta t_{\\max} = \\frac{\\Delta x}{|c|}.\n$$\n\n最后，为了将其与数值天气预报 (NWP) 和气候模拟背景下的相容性和收敛性联系起来，我们注意到迎风格式是$u_{t} + c\\,u_{x} = 0$的一阶精度离散化，其局部截断误差的量级为$\\mathcal{O}(\\Delta t) + \\mathcal{O}(\\Delta x)$（相容性）。根据均匀网格上线性初值问题的Lax等价定理，稳定性（由上述CFL条件保证）与相容性共同意味着，在周期性边界条件下，当$\\Delta t \\to 0$和$\\Delta x \\to 0$时，该格式收敛于真实解。$c$的符号改变了迎风方向和$\\nu$的允许符号，但最大稳定时间步长仅取决于$|c|$的大小，这是CFL约束中物理上相关的平流速度。",
            "answer": "$$\\boxed{\\frac{\\Delta x}{|c|}}$$"
        },
        {
            "introduction": "确保稳定性至关重要，但解决可能降低解质量的数值伪影也同样重要。本练习将探讨蛙跳格式，这是一种因其高效和低数值耗散而曾被大气模型偏爱的格式，但它会产生一个非物理的计算模。你将分析该格式的相位和振幅特性，并学习如何使用 Robert–Asselin 滤波器来抑制计算模，这是业务模型中广泛应用的一种技术。",
            "id": "4092934",
            "problem": "考虑在数值天气预报和气候模拟中出现的线性常系数波分量的一个单一空间傅里叶模态。其复振幅$u(t)$遵循常微分方程$ \\frac{d u}{d t} = i \\,\\omega \\, u $演化，其中$\\omega > 0$是振荡解的物理角频率，$i$是虚数单位。令无量纲时间步长为$\\mu := \\omega \\,\\Delta t$，其中$\\Delta t$是数值时间步长。\n\n两步蛙跳时间离散化由三层格式定义：\n$$ u^{n+1} - u^{n-1} = 2\\, i \\,\\mu \\, u^{n}, $$\n其中$u^{n}$近似于$t^{n} = n\\,\\Delta t$时的$u(t^{n})$。为减轻蛙跳计算模态的污染，定义带有系数$\\alpha$的 Robert–Asselin (RA) 滤波器，其诊断更新为\n$$ u^{n} \\leftarrow u^{n} + \\alpha \\,\\big( u^{n+1} - 2\\,u^{n} + u^{n-1} \\big). $$\n\n假设$0 \\le \\mu \\le 1$，因此对于此振荡问题，未滤波的蛙跳格式是中性稳定的。完成以下任务：\n\n1. 使用未滤波的蛙跳格式，假设一个简正模假设$u^{n} = \\lambda^{n} u^{0}$，并推导离散放大因子。由此，确定物理模态的精确每步相位$\\theta(\\mu)$及其与精确相位$\\mu$的偏差。说明振幅误差。\n\n2. 引入 Robert–Asselin 滤波器，并将组合更新的一步表示为作用于双分量状态向量$\\big(u^{n+1}, \\tilde{u}^{n}\\big)$的线性映射，其中$\\tilde{u}^{n}$表示滤波后的$u^{n}$。推导该组合格式的特征多项式和闭式特征值$\\lambda_{\\pm}(\\mu,\\alpha)$。\n\n3. 识别计算模态的特征值$\\lambda_{c}(\\mu,\\alpha)$，并确定对于给定的$\\mu \\in [0,1]$，使$|\\lambda_{c}(\\mu,\\alpha)|$最小化的$\\alpha$值。将所得的$\\alpha$以仅含$\\mu$的单一闭式解析表达式的形式给出。\n\n你的最终答案必须是使值最小化的$\\alpha$作为仅关于$\\mu$的函数的解析表达式。不需要进行数值计算。如果选择化简根式，请进行精确化简，不要近似。最终答案中不要包含单位。",
            "solution": "该问题被评估为有效，因为它在科学上基于已建立的微分方程数值方法理论，是适定的、客观的且内部一致的。\n\n解答按照题目要求分为三个部分展开。\n\n第一部分：未滤波蛙跳格式的分析\n\n未滤波的蛙跳格式由下式给出：\n$$ u^{n+1} - u^{n-1} = 2\\, i \\,\\mu \\, u^{n}. $$\n我们假设一个形式为$u^{n} = \\lambda^{n} u^{0}$的简正模解。将此假设代入格式中，得到\n$$ \\lambda^{n+1}u^{0} - \\lambda^{n-1}u^{0} = 2\\, i \\,\\mu \\,\\lambda^{n}u^{0}. $$\n假设$u^{0} \\ne 0$和$\\lambda \\ne 0$，我们可以用$\\lambda^{n-1}u^{0}$去除，以获得放大因子$\\lambda$的特征多项式：\n$$ \\lambda^{2} - 1 = 2\\, i \\,\\mu \\,\\lambda, $$\n$$ \\lambda^{2} - 2\\, i \\,\\mu \\,\\lambda - 1 = 0. $$\n这是一个关于$\\lambda$的二次方程。使用求根公式，两个根（即离散放大因子）是：\n$$ \\lambda_{\\pm} = \\frac{2\\, i \\,\\mu \\pm \\sqrt{(-2\\, i \\,\\mu)^{2} - 4(1)(-1)}}{2} = \\frac{2\\, i \\,\\mu \\pm \\sqrt{-4\\mu^{2} + 4}}{2} = i\\,\\mu \\pm \\sqrt{1-\\mu^{2}}. $$\n题目说明$0 \\le \\mu \\le 1$，这确保了$1-\\mu^{2} \\ge 0$，因此平方根是实数。两个放大因子是$\\lambda_{1} = \\sqrt{1-\\mu^{2}} + i\\,\\mu$和$\\lambda_{2} = -\\sqrt{1-\\mu^{2}} + i\\,\\mu$。\n\n这些因子的模由$|\\lambda_{\\pm}|^{2} = (\\pm\\sqrt{1-\\mu^{2}})^{2} + \\mu^{2} = (1-\\mu^{2}) + \\mu^{2} = 1$给出。因此，$|\\lambda_{\\pm}| = 1$。这证实了对于$0 \\le \\mu \\le 1$，该格式是中性稳定的，因此每时间步的振幅误差为零。\n\n$\\frac{du}{dt} = i\\,\\omega\\,u$的精确解是$u(t) = u(0) \\exp(i\\,\\omega\\,t)$。在一个时间步长$\\Delta t$内的精确放大因子是$G_{exact} = \\exp(i\\,\\omega\\,\\Delta t) = \\exp(i\\,\\mu)$。每步的精确相变是$\\mu$。\n\n数值格式的物理模态应近似这种行为。对于小的$\\mu$，$\\lambda_{1} = \\sqrt{1-\\mu^{2}} + i\\,\\mu \\approx (1-\\frac{1}{2}\\mu^{2}) + i\\,\\mu$，这是对$\\exp(i\\,\\mu) \\approx 1 + i\\,\\mu - \\frac{1}{2}\\mu^{2}$的二阶近似。另一个根$\\lambda_2$在$\\mu$很小时近似于$-1$，是计算模态。因此，物理模态的放大因子是$\\lambda_{p} = \\sqrt{1-\\mu^{2}} + i\\,\\mu$。\n\n物理模态的相位$\\theta(\\mu)$是$\\lambda_{p}$的辐角。它由下式给出\n$$ \\tan(\\theta(\\mu)) = \\frac{\\text{Im}(\\lambda_{p})}{\\text{Re}(\\lambda_{p})} = \\frac{\\mu}{\\sqrt{1-\\mu^{2}}}. $$\n对于$\\mu \\in [0,1]$，这意味着$\\theta(\\mu) = \\arcsin(\\mu)$。\n数值相位与精确相位的偏差是\n$$ \\text{Phase Deviation} = \\theta(\\mu) - \\mu = \\arcsin(\\mu) - \\mu. $$\n对于小的$\\mu > 0$，使用泰勒级数$\\arcsin(\\mu) = \\mu + \\frac{1}{6}\\mu^{3} + O(\\mu^{5})$，相位偏差约为$\\frac{1}{6}\\mu^{3}$，这表明存在相位超前（数值波比物理波传播得更快）。\n\n第二部分：滤波格式的分析\n\n组合格式包括一个蛙跳预测步，后跟一个 Robert–Asselin 滤波器校正步。我们用向量$X^{n} = (u^{n}, u^{n-1})^{T}$表示系统在时间层$n$的状态。到下一个状态$X^{n+1} = (u^{n+1}, \\tilde{u}^{n})^{T}$的更新按如下方式执行：\n1. 蛙跳步，求得一个临时的$u^{n+1}$：$u^{n+1} = u^{n-1} + 2\\,i\\,\\mu\\,u^{n}$。\n2. RA 滤波器，求得用于下一个时间积分周期的校正值$\\tilde{u}^{n}$：$\\tilde{u}^{n} = u^{n} + \\alpha (u^{n+1} - 2u^{n} + u^{n-1})$。\n\n将第一个方程中$u^{n+1}$的表达式代入第二个方程，得到：\n$$ \\tilde{u}^{n} = u^{n} + \\alpha \\left( (u^{n-1} + 2\\,i\\,\\mu\\,u^{n}) - 2u^{n} + u^{n-1} \\right) $$\n$$ \\tilde{u}^{n} = u^{n} + \\alpha \\left( (2\\,i\\,\\mu - 2)u^{n} + 2u^{n-1} \\right) $$\n$$ \\tilde{u}^{n} = (1 - 2\\alpha + 2\\,i\\,\\alpha\\,\\mu)u^{n} + 2\\alpha u^{n-1}. $$\n更新过程可以写成矩阵变换$X^{n+1} = A X^{n}$：\n$$ \\begin{pmatrix} u^{n+1} \\\\ \\tilde{u}^{n} \\end{pmatrix} = \\begin{pmatrix} 2\\,i\\,\\mu  1 \\\\ 1 - 2\\alpha + 2\\,i\\,\\alpha\\,\\mu  2\\alpha \\end{pmatrix} \\begin{pmatrix} u^{n} \\\\ u^{n-1} \\end{pmatrix}. $$\n放大矩阵$A$的特征值$\\lambda$通过求解特征方程$\\det(A - \\lambda I) = 0$得到：\n$$ \\det \\begin{pmatrix} 2\\,i\\,\\mu - \\lambda  1 \\\\ 1 - 2\\alpha + 2\\,i\\,\\alpha\\,\\mu  2\\alpha - \\lambda \\end{pmatrix} = 0 $$\n$$ (2\\,i\\,\\mu - \\lambda)(2\\alpha - \\lambda) - (1 - 2\\alpha + 2\\,i\\,\\alpha\\,\\mu) = 0 $$\n$$ \\lambda^{2} - (2\\alpha + 2\\,i\\,\\mu)\\lambda + (4\\,i\\,\\alpha\\,\\mu - 1 + 2\\alpha - 2\\,i\\,\\alpha\\,\\mu) = 0 $$\n$$ \\lambda^{2} - 2(\\alpha + i\\,\\mu)\\lambda + (2\\alpha - 1 + 2\\,i\\,\\alpha\\,\\mu) = 0. $$\n这是组合格式的特征多项式。我们使用求根公式求解特征值$\\lambda_{\\pm}$：\n$$ \\lambda_{\\pm} = \\frac{2(\\alpha + i\\,\\mu) \\pm \\sqrt{4(\\alpha + i\\,\\mu)^{2} - 4(2\\alpha - 1 + 2\\,i\\,\\alpha\\,\\mu)}}{2} $$\n$$ \\lambda_{\\pm}(\\mu, \\alpha) = (\\alpha + i\\,\\mu) \\pm \\sqrt{(\\alpha^{2} - \\mu^{2} + 2\\,i\\,\\alpha\\,\\mu) - (2\\alpha - 1 + 2\\,i\\,\\alpha\\,\\mu)} $$\n$$ \\lambda_{\\pm}(\\mu, \\alpha) = (\\alpha + i\\,\\mu) \\pm \\sqrt{\\alpha^{2} - 2\\alpha + 1 - \\mu^{2}} $$\n$$ \\lambda_{\\pm}(\\mu, \\alpha) = \\alpha + i\\,\\mu \\pm \\sqrt{(1-\\alpha)^{2} - \\mu^{2}}. $$\n\n第三部分：计算模态振幅的最小化\n\n物理模态对应于当$\\mu \\to 0$和$\\alpha \\to 0$时趋近于$1$的特征值，即$\\lambda_{p} = \\lambda_{+} = \\alpha + i\\,\\mu + \\sqrt{(1-\\alpha)^{2} - \\mu^{2}}$。因此，计算模态是\n$$ \\lambda_{c}(\\mu, \\alpha) = \\lambda_{-} = \\alpha + i\\,\\mu - \\sqrt{(1-\\alpha)^{2} - \\mu^{2}}. $$\n我们希望找到对于给定的$\\mu \\in [0,1]$，使模$|\\lambda_{c}(\\mu, \\alpha)|$最小化的$\\alpha$值。\n我们分析模的平方$|\\lambda_{c}|^{2}$。\n首先，考虑平方根下的项为非负的情况，即$(1-\\alpha)^{2} - \\mu^{2} \\ge 0$。在这种情况下，$\\sqrt{(1-\\alpha)^{2} - \\mu^{2}}$是实数。\n$\\lambda_{c}$的模的平方是\n$$ |\\lambda_{c}|^{2} = \\left(\\text{Re}(\\lambda_{c})\\right)^{2} + \\left(\\text{Im}(\\lambda_{c})\\right)^{2} = \\left(\\alpha - \\sqrt{(1-\\alpha)^{2} - \\mu^{2}}\\right)^{2} + \\mu^{2}. $$\n为了对固定的$\\mu$最小化此表达式，我们必须最小化第一项，它是一个实数的平方。该项的可能最小值为$0$。如果我们能选择$\\alpha$使得平方内的项为零，就可以达到这个最小值：\n$$ \\alpha - \\sqrt{(1-\\alpha)^{2} - \\mu^{2}} = 0. $$\n假设$\\alpha \\ge 0$，我们可以重新排列并对两边进行平方：\n$$ \\alpha^{2} = (1-\\alpha)^{2} - \\mu^{2} $$\n$$ \\alpha^{2} = 1 - 2\\alpha + \\alpha^{2} - \\mu^{2} $$\n$$ 0 = 1 - 2\\alpha - \\mu^{2} $$\n$$ 2\\alpha = 1 - \\mu^{2} \\implies \\alpha = \\frac{1-\\mu^{2}}{2}. $$\n我们必须验证这个$\\alpha$的选择满足条件$(1-\\alpha)^{2} - \\mu^{2} \\ge 0$。\n代入我们的$\\alpha$表达式：\n$$ 1-\\alpha = 1 - \\frac{1-\\mu^{2}}{2} = \\frac{2 - 1 + \\mu^{2}}{2} = \\frac{1+\\mu^{2}}{2}. $$\n然后，\n$$ (1-\\alpha)^{2} - \\mu^{2} = \\left(\\frac{1+\\mu^{2}}{2}\\right)^{2} - \\mu^{2} = \\frac{1 + 2\\mu^{2} + \\mu^{4}}{4} - \\frac{4\\mu^{2}}{4} = \\frac{1 - 2\\mu^{2} + \\mu^{4}}{4} = \\left(\\frac{1-\\mu^{2}}{2}\\right)^{2}. $$\n由于这个量是一个平方，它总是非负的。因此，$\\alpha = \\frac{1-\\mu^{2}}{2}$这个选择始终位于使根式为实的定义域内。\n这个特定的$\\alpha$选择使得$\\lambda_c$的实部为零，从而导致$|\\lambda_{c}|^{2}$的可能最小值为$\\mu^{2}$。所以$|\\lambda_c| = \\mu$。在该域内任何其他$\\alpha$的选择都会导致第一项严格为正，使得$|\\lambda_c|^2 > \\mu^2$。\n\n如果$(1-\\alpha)^{2} - \\mu^{2}  0$，平方根变为虚数，一个单独的分析（为简洁起见此处省略，但过程直接）表明$|\\lambda_c|^2$总是大于$\\mu^2$。\n因此，$|\\lambda_{c}(\\mu, \\alpha)|$的全局最小值在以下$\\alpha$值处达到：\n$$ \\alpha = \\frac{1-\\mu^{2}}{2}. $$\n对于给定的频率$\\mu$，这个$\\alpha$值可以最优地衰减计算模态。对于$\\mu \\in [0,1]$，我们有$\\alpha \\in [0, 1/2]$。",
            "answer": "$$\\boxed{\\frac{1-\\mu^{2}}{2}}$$"
        },
        {
            "introduction": "离散化方法的选择对数值模型的稳定性和准确性都有显著影响。这个问题将我们的焦点转移到有限元方法（FEM），并探究一个关键的设计选择：质量矩阵的构造。通过比较使用一致质量矩阵与集总质量矩阵的格式的稳定性极限和频散误差，你将深入了解计算效率和解的保真度之间的权衡，这是模型开发者经常面临的困境。",
            "id": "4092931",
            "problem": "考虑一维空间中的标量声波方程，\n$$\n\\frac{\\partial^{2} q}{\\partial t^{2}} \\;=\\; c^{2}\\,\\frac{\\partial^{2} q}{\\partial x^{2}},\n$$\n该方程定义在一个长度为$L$的周期性域上，其中$c$是恒定的声速。用$N$个节点和网格间距$h=L/N$对空间域进行均匀离散化，并在此网格上使用连续分段线性有限元来近似$q(x,t)$。\n\n令$M$和$K$分别表示使用节点（帽函数）基通过标准 Galerkin 方法生成的全局质量矩阵和刚度矩阵。对质量矩阵使用两种典型的选择：\n- 一致质量矩阵$M$，其元素为$M_{ii}=2h/3$，$M_{i,i\\pm 1}=h/6$，所有其他元素为零；以及\n- 行和集中质量矩阵$M_{\\ell}$，通过将$M$替换为一个对角矩阵得到，该对角矩阵的对角元素是$M$的行和，即$(M_{\\ell})_{ii} = h$。\n\n对得到的半离散系统\n$$\nM\\,\\ddot{\\boldsymbol{q}}(t) \\;+\\; c^{2}\\,K\\,\\boldsymbol{q}(t) \\;=\\; \\boldsymbol{0}\n$$\n使用显式二阶精确的中心差分（蛙跳）方法进行时间积分，\n$$\n\\boldsymbol{q}^{n+1} \\;=\\; 2\\,\\boldsymbol{q}^{n} \\;-\\; \\boldsymbol{q}^{n-1} \\;-\\; \\Delta t^{2}\\, M^{-1}\\,c^{2}\\,K\\,\\boldsymbol{q}^{n},\n$$\n其中空间上采用周期性边界条件，$\\boldsymbol{q}^{n}$表示在时间层$t^{n}=n\\,\\Delta t$的节点值向量。\n\n在空间周期性设置下进行分析，并使用 Fourier (von Neumann) 分析方法，采用$v_{j}=\\exp(\\mathrm{i}\\,j\\,\\theta)$形式的离散傅里叶模态，其中$j$是节点索引，$\\theta\\in[0,\\pi]$是无量纲波数。用$\\mu(\\theta)$表示矩阵对$(K,M)$的广义特征值，即对于傅里叶模态$\\boldsymbol{v}$满足$K\\,\\boldsymbol{v}=\\mu(\\theta)\\,M\\,\\boldsymbol{v}$的量，并用$\\mu_{\\ell}(\\theta)$表示$(K,M_{\\ell})$的类似广义特征值。\n\n仅使用标准线性有限元基和周期性 Toeplitz 算子的基本性质，完成以下任务：\n\n- 对于每种质量矩阵的选择，根据最大广义特征值推导出中心差分法的最大稳定时间步长$\\Delta t_{\\max}$。然后确定比值\n$$\nr \\;=\\; \\frac{\\Delta t_{\\max}^{(\\text{lumped})}}{\\Delta t_{\\max}^{(\\text{consistent})}}.\n$$\n\n- 通过推导集中质量半离散系统的相速度的小波数展开，来量化由质量集中引入的主阶色散误差。具体来说，对于$\\theta\\to 0$，将离散相速度$c_{p,\\ell}(\\theta)$写成以下形式\n$$\n\\frac{c_{p,\\ell}(\\theta)}{c} \\;=\\; 1 \\;+\\; \\beta\\,\\theta^{2} \\;+\\; \\mathcal{O}(\\theta^{4}),\n$$\n并计算系数$\\beta$。\n\n以行矩阵的形式提供你的最终答案，该矩阵依次包含$r$的精确表达式和$\\beta$的精确值。不需要单位。不需要四舍五入；请提供精确值。",
            "solution": "用户提供了来自数值分析领域的有效问题陈述，具体涉及一维声波方程有限元离散化的稳定性和色散特性。该问题具有科学依据，是适定的且客观的。我们接下来提供详细的解答。\n\n该问题要求计算两个量：集中质量矩阵与一致质量矩阵的最大稳定时间步长之比，以及集中质量格式的主阶色散误差系数。这两项任务都需要对半离散系统进行傅里叶分析。\n\n首先，我们分析中心差分（蛙跳）时间积分格式的稳定性。半离散系统由下式给出\n$$\nM\\,\\ddot{\\boldsymbol{q}}(t) \\;+\\; c^{2}\\,K\\,\\boldsymbol{q}(t) \\;=\\; \\boldsymbol{0},\n$$\n其中$\\boldsymbol{q}(t)$是节点值向量，$M$是质量矩阵（一致或集中），$K$是刚度矩阵，$c$是恒定声速。蛙跳格式根据以下方式更新解\n$$\n\\boldsymbol{q}^{n+1} \\;=\\; 2\\,\\boldsymbol{q}^{n} \\;-\\; \\boldsymbol{q}^{n-1} \\;-\\; (\\Delta t)^{2}\\, c^{2}\\,M^{-1}\\,K\\,\\boldsymbol{q}^{n}.\n$$\n我们通过将离散傅里叶模态$\\boldsymbol{q}^n_j = \\hat{q}(\\omega) \\exp(\\mathrm{i} n \\Delta t \\omega) \\exp(\\mathrm{i} j \\theta)$代入格式来进行 von Neumann 稳定性分析。一个更简单、等效的方法是认识到蛙跳法的稳定性取决于算子$c^2 M^{-1}K$的特征值。令$\\mu(\\theta)$为对应于无量纲波数$\\theta$的傅里叶模态的矩阵对$(K,M)$的一个广义特征值。此模态的半离散方程的行为类似于一个简谐振子$\\ddot{y} = -\\omega_{\\text{num}}^2 y$，其中数值频率$\\omega_{\\text{num}}$由$\\omega_{\\text{num}}^2 = c^2 \\mu(\\theta)$给出。对于这个振子，蛙跳法是稳定的，当且仅当满足 Courant-Friedrichs-Lewy (CFL) 条件$|\\omega_{\\text{num}} \\Delta t| \\leq 2$。为确保对所有可能的模态都稳定，该条件必须对最大可能的数值频率成立：\n$$\n\\Delta t \\,\\max_{\\theta} |\\omega_{\\text{num}}(\\theta)| \\;\\leq\\; 2 \\quad\\implies\\quad \\Delta t \\, c \\, \\sqrt{\\max_{\\theta} \\mu(\\theta)} \\;\\leq\\; 2.\n$$\n因此，最大稳定时间步长为\n$$\n\\Delta t_{\\max} \\;=\\; \\frac{2}{c\\,\\sqrt{\\max_{\\theta} \\mu(\\theta)}}.\n$$\n为了找到$\\mu(\\theta)$，我们必须找到周期性 Toeplitz 矩阵$M$和$K$作用于分量为$v_j = \\exp(\\mathrm{i} j \\theta)$的傅里叶模态$\\boldsymbol{v}$时的符号（特征值）。对于一个具有模板$\\{a_{-p}, \\dots, a_0, \\dots, a_p\\}$的矩阵，其符号为$\\hat{A}(\\theta) = \\sum_{k=-p}^{p} a_k \\exp(\\mathrm{i} k \\theta)$。\n\n使用线性有限元法，算子$-\\partial^2/\\partial x^2$的刚度矩阵$K$由$K_{ij} = \\int_{0}^{L} \\frac{d\\phi_i}{dx} \\frac{d\\phi_j}{dx} dx$导出，其中$\\phi_j$是标准的线性“帽”基函数。这对于一个内部节点$j$产生模板$\\{-\\frac{1}{h}, \\frac{2}{h}, -\\frac{1}{h}\\}$。$K$的符号是：\n$$\n\\hat{K}(\\theta) \\;=\\; -\\frac{1}{h}\\exp(-\\mathrm{i}\\theta) \\;+\\; \\frac{2}{h} \\;-\\; \\frac{1}{h}\\exp(\\mathrm{i}\\theta) \\;=\\; \\frac{2}{h}(1 - \\cos(\\theta)).\n$$\n一致质量矩阵$M$由模板$\\{\\frac{h}{6}, \\frac{2h}{3}, \\frac{h}{6}\\}$给出。其符号是：\n$$\n\\hat{M}(\\theta) \\;=\\; \\frac{h}{6}\\exp(-\\mathrm{i}\\theta) \\;+\\; \\frac{2h}{3} \\;+\\; \\frac{h}{6}\\exp(\\mathrm{i}\\theta) \\;=\\; \\frac{2h}{3} + \\frac{h}{3}\\cos(\\theta) \\;=\\; \\frac{h}{3}(2 + \\cos(\\theta)).\n$$\n行和集中质量矩阵$M_{\\ell}$是对角的，其元素为$(M_{\\ell})_{ii}=h$，所以它的模板是$\\{0,h,0\\}$。其符号很简单：\n$$\n\\hat{M}_{\\ell}(\\theta) \\;=\\; h.\n$$\n广义特征值$\\mu(\\theta)$是符号的比值，$\\mu(\\theta) = \\hat{K}(\\theta) / \\hat{M}(\\theta)$。\n\n对于一致质量矩阵的情况：\n$$\n\\mu(\\theta) \\;=\\; \\frac{\\hat{K}(\\theta)}{\\hat{M}(\\theta)} \\;=\\; \\frac{\\frac{2}{h}(1 - \\cos(\\theta))}{\\frac{h}{3}(2 + \\cos(\\theta))} \\;=\\; \\frac{6}{h^2} \\frac{1 - \\cos(\\theta)}{2 + \\cos(\\theta)}.\n$$\n为了找到最大值，我们注意到对于$\\theta \\in [0, \\pi]$，函数$f(\\theta) = \\frac{1 - \\cos(\\theta)}{2 + \\cos(\\theta)}$是单调递增的。因此，其最大值出现在最高波数处，即$\\theta = \\pi$：\n$$\n\\max_{\\theta} \\mu(\\theta) \\;=\\; \\mu(\\pi) \\;=\\; \\frac{6}{h^2} \\frac{1 - (-1)}{2 + (-1)} \\;=\\; \\frac{6}{h^2} \\frac{2}{1} \\;=\\; \\frac{12}{h^2}.\n$$\n一致质量格式的最大稳定时间步长是：\n$$\n\\Delta t_{\\max}^{(\\text{consistent})} \\;=\\; \\frac{2}{c \\sqrt{12/h^2}} \\;=\\; \\frac{2h}{c \\sqrt{12}} \\;=\\; \\frac{2h}{2c\\sqrt{3}} \\;=\\; \\frac{h}{c\\sqrt{3}}.\n$$\n对于集中质量矩阵的情况：\n$$\n\\mu_{\\ell}(\\theta) \\;=\\; \\frac{\\hat{K}(\\theta)}{\\hat{M}_{\\ell}(\\theta)} \\;=\\; \\frac{\\frac{2}{h}(1 - \\cos(\\theta))}{h} \\;=\\; \\frac{2}{h^2}(1 - \\cos(\\theta)).\n$$\n这个函数在$\\theta \\in [0, \\pi]$上也是单调递增的。最大值在$\\theta = \\pi$处取得：\n$$\n\\max_{\\theta} \\mu_{\\ell}(\\theta) \\;=\\; \\mu_{\\ell}(\\pi) \\;=\\; \\frac{2}{h^2}(1 - (-1)) \\;=\\; \\frac{4}{h^2}.\n$$\n集中质量格式的最大稳定时间步长是：\n$$\n\\Delta t_{\\max}^{(\\text{lumped})} \\;=\\; \\frac{2}{c \\sqrt{4/h^2}} \\;=\\; \\frac{2h}{c \\cdot 2} \\;=\\; \\frac{h}{c}.\n$$\n于是，比值$r$为：\n$$\nr \\;=\\; \\frac{\\Delta t_{\\max}^{(\\text{lumped})}}{\\Delta t_{\\max}^{(\\text{consistent})}} \\;=\\; \\frac{h/c}{h/(c\\sqrt{3})} \\;=\\; \\sqrt{3}.\n$$\n\n接下来，我们分析集中质量系统的色散误差。数值相速度$c_{p,\\ell}(\\theta)$由关系式$c_{p,\\ell}(\\theta) = \\omega_{\\text{num}}(\\theta) / k$给出，其中$k = \\theta/h$是物理波数。\n$$\nc_{p,\\ell}(\\theta) \\;=\\; \\frac{\\omega_{\\text{num},\\ell}(\\theta)}{k} \\;=\\; \\frac{c \\sqrt{\\mu_{\\ell}(\\theta)}}{\\theta/h} \\;=\\; ch \\frac{\\sqrt{\\frac{2}{h^2}(1 - \\cos(\\theta))}}{\\theta} \\;=\\; c \\frac{\\sqrt{2(1 - \\cos(\\theta))}}{\\theta}.\n$$\n为了找到主阶误差，我们对该表达式在小波数下（即$\\theta \\to 0$）进行展开。我们使用$\\cos(\\theta)$在$\\theta=0$附近的泰勒级数展开：\n$$\n\\cos(\\theta) \\;=\\; 1 - \\frac{\\theta^2}{2!} + \\frac{\\theta^4}{4!} - \\mathcal{O}(\\theta^6).\n$$\n将此代入相速度比值的表达式中：\n$$\n\\frac{c_{p,\\ell}(\\theta)}{c} \\;=\\; \\frac{\\sqrt{2\\left(1 - \\left(1 - \\frac{\\theta^2}{2} + \\frac{\\theta^4}{24} - \\dots\\right)\\right)}}{\\theta} \\;=\\; \\frac{\\sqrt{2\\left(\\frac{\\theta^2}{2} - \\frac{\\theta^4}{24} + \\dots\\right)}}{\\theta} \\;=\\; \\frac{\\sqrt{\\theta^2 - \\frac{\\theta^4}{12} + \\dots}}{\\theta}.\n$$\n从平方根中提出因子$\\theta$：\n$$\n\\frac{c_{p,\\ell}(\\theta)}{c} \\;=\\; \\frac{\\theta \\sqrt{1 - \\frac{\\theta^2}{12} + \\mathcal{O}(\\theta^4)}}{\\theta} \\;=\\; \\sqrt{1 - \\frac{\\theta^2}{12} + \\mathcal{O}(\\theta^4)}.\n$$\n使用二项式展开$\\sqrt{1+x} = 1 + \\frac{x}{2} + \\mathcal{O}(x^2)$，并令$x = -\\frac{\\theta^2}{12}$：\n$$\n\\frac{c_{p,\\ell}(\\theta)}{c} \\;=\\; 1 + \\frac{1}{2}\\left(-\\frac{\\theta^2}{12}\\right) + \\mathcal{O}(\\theta^4) \\;=\\; 1 - \\frac{\\theta^2}{24} + \\mathcal{O}(\\theta^4).\n$$\n将此与所要求的形式$\\frac{c_{p,\\ell}(\\theta)}{c} = 1 + \\beta\\,\\theta^{2} + \\mathcal{O}(\\theta^{4})$进行比较，我们确定系数$\\beta$为：\n$$\n\\beta \\;=\\; -\\frac{1}{24}.\n$$\n负号表示数值波滞后于真实波（相位误差）。\n\n所要求的两个量是$r=\\sqrt{3}$和$\\beta = -1/24$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\sqrt{3}  -\\frac{1}{24} \\end{pmatrix}}\n$$"
        }
    ]
}