{
    "hands_on_practices": [
        {
            "introduction": "稳定性是显式时间步进方案的首要考虑因素。一个数值方案的稳定性由其放大因子决定，该因子作用于空间离散算子的特征值。本练习将引导您完成为一个广泛使用的强稳定性保持龙格-库塔（SSPRK）方法推导稳定性多项式的正式过程，并利用它来找到 Courant-Friedrichs-Lewy (CFL) 极限。对于任何实现或分析数值模型的人来说，这是一项基本技能 。",
            "id": "4041369",
            "problem": "考虑一维线性平流方程，其定义在间距为 $\\Delta x$ 的均匀周期性网格上，\n$$\n\\partial_t u(x,t) + a\\,\\partial_x u(x,t) = 0,\n$$\n其中 $a$ 是一个恒定的平流速度。使用空间上的二阶中心有限差分，网格点值 $u_j(t)$ 的半离散系统可以写为\n$$\n\\partial_t u_j(t) = -a\\,\\frac{u_{j+1}(t) - u_{j-1}(t)}{2\\,\\Delta x},\n$$\n其形式为 $\\partial_t \\mathbf{u}(t) = \\mathbf{L}\\,\\mathbf{u}(t)$，其中 $\\mathbf{L}$ 是一个常数矩阵。对于这种带有周期性边界的空间离散化，傅里叶模式 $e^{\\mathrm{i} k j \\Delta x}$ 是 $\\mathbf{L}$ 的特征向量，其对应的特征值为\n$$\n\\lambda(k) = \\mathrm{i}\\,a\\,\\frac{\\sin(k\\,\\Delta x)}{\\Delta x}.\n$$\n您将使用三阶段、三阶强保稳定龙格库塔方法 (SSPRK(3,3)) 对该半离散系统进行时间步进，该方法以 Shu–Osher 形式由以下阶段给出\n$$\n\\mathbf{u}^{(1)} = \\mathbf{u}^n + \\Delta t\\,\\mathbf{L}\\,\\mathbf{u}^n,\n$$\n$$\n\\mathbf{u}^{(2)} = \\frac{3}{4}\\,\\mathbf{u}^n + \\frac{1}{4}\\left(\\mathbf{u}^{(1)} + \\Delta t\\,\\mathbf{L}\\,\\mathbf{u}^{(1)}\\right),\n$$\n$$\n\\mathbf{u}^{n+1} = \\frac{1}{3}\\,\\mathbf{u}^n + \\frac{2}{3}\\left(\\mathbf{u}^{(2)} + \\Delta t\\,\\mathbf{L}\\,\\mathbf{u}^{(2)}\\right).\n$$\n从以下基本事实出发：应用于 $\\partial_t \\mathbf{u} = \\mathbf{L}\\,\\mathbf{u}$ 的线性时间步进方法的稳定性由该方法的标量稳定性多项式 $R(z)$ 通过要求对 $\\mathbf{L}$ 的所有特征值 $\\lambda_k$ 满足 $|R(\\Delta t\\,\\lambda_k)| \\leq 1$ 来决定，并且离散傅里叶分析可表征周期性线性平流的 $\\mathbf{L}$ 的谱。请推导 SSPRK(3,3) 的稳定性多项式 $R(z)$，确定其沿虚轴的 $|\\cdot| \\leq 1$ 区域，并计算确保对网格支持的所有波数 $k$ 都有 $|R(\\Delta t\\,\\lambda(k))| \\leq 1$ 的最大时间步长 $\\Delta t$。将您的最终答案表示为关于 $a$ 和 $\\Delta x$ 的单个闭式解析表达式。以秒为单位表示最终允许的时间步长。无需四舍五入。",
            "solution": "问题要求在使用特定的空间离散化和时间积分方案求解线性平流方程时，允许的最大时间步长 $\\Delta t$。该过程的稳定性由条件 $|R(\\Delta t\\,\\lambda_k)| \\leq 1$ 对半离散算子 $\\mathbf{L}$ 的所有特征值 $\\lambda_k$ 成立来决定。求解过程需要三个主要步骤：首先，为给定的时间步进方法 (SSPRK(3,3)) 推导稳定性多项式 $R(z)$；其次，确定该多项式沿虚轴的稳定域，因为特征值 $\\lambda_k$ 是纯虚数；第三，利用该稳定域来约束 $\\Delta t$。\n\n半离散系统由 $\\partial_t \\mathbf{u}(t) = \\mathbf{L}\\,\\mathbf{u}(t)$ 给出。SSPRK(3,3) 方法通过三个阶段将解从时间步 $n$推进到 $n+1$：\n$$\n\\mathbf{u}^{(1)} = \\mathbf{u}^n + \\Delta t\\,\\mathbf{L}\\,\\mathbf{u}^n\n$$\n$$\n\\mathbf{u}^{(2)} = \\frac{3}{4}\\,\\mathbf{u}^n + \\frac{1}{4}\\left(\\mathbf{u}^{(1)} + \\Delta t\\,\\mathbf{L}\\,\\mathbf{u}^{(1)}\\right)\n$$\n$$\n\\mathbf{u}^{n+1} = \\frac{1}{3}\\,\\mathbf{u}^n + \\frac{2}{3}\\left(\\mathbf{u}^{(2)} + \\Delta t\\,\\mathbf{L}\\,\\mathbf{u}^{(2)}\\right)\n$$\n为了找到稳定性多项式 $R(z)$，我们将 $\\mathbf{u}^{n+1}$ 完全用 $\\mathbf{u}^n$ 来表示。令 $z = \\Delta t\\,\\mathbf{L}$。该方法可以写成 $\\mathbf{u}^{n+1} = R(z)\\,\\mathbf{u}^n$。\n\n第一阶段：\n$$\n\\mathbf{u}^{(1)} = (\\mathbf{I} + z)\\,\\mathbf{u}^n\n$$\n第二阶段：将 $\\mathbf{u}^{(1)}$ 代入其定义中。\n$$\n\\mathbf{u}^{(2)} = \\frac{3}{4}\\,\\mathbf{u}^n + \\frac{1}{4}\\left((\\mathbf{I}+z)\\,\\mathbf{u}^{(1)}\\right) = \\frac{3}{4}\\,\\mathbf{u}^n + \\frac{1}{4}(\\mathbf{I}+z)(\\mathbf{I}+z)\\,\\mathbf{u}^n = \\left(\\frac{3}{4}\\mathbf{I} + \\frac{1}{4}(\\mathbf{I}+z)^2\\right)\\,\\mathbf{u}^n\n$$\n展开关于 $z$ 的多项式：\n$$\n\\frac{3}{4}\\mathbf{I} + \\frac{1}{4}(\\mathbf{I} + 2z + z^2) = \\left(\\frac{3}{4}+\\frac{1}{4}\\right)\\mathbf{I} + \\frac{2}{4}z + \\frac{1}{4}z^2 = \\mathbf{I} + \\frac{1}{2}z + \\frac{1}{4}z^2\n$$\n因此，$\\mathbf{u}^{(2)} = \\left(\\mathbf{I} + \\frac{1}{2}z + \\frac{1}{4}z^2\\right)\\mathbf{u}^n$。\n\n第三阶段：将 $\\mathbf{u}^{(2)}$ 代入 $\\mathbf{u}^{n+1}$ 的最终表达式中。\n$$\n\\mathbf{u}^{n+1} = \\frac{1}{3}\\,\\mathbf{u}^n + \\frac{2}{3}\\left((\\mathbf{I}+z)\\,\\mathbf{u}^{(2)}\\right) = \\left(\\frac{1}{3}\\mathbf{I} + \\frac{2}{3}(\\mathbf{I}+z)\\left(\\mathbf{I} + \\frac{1}{2}z + \\frac{1}{4}z^2\\right)\\right)\\mathbf{u}^n\n$$\n乘以 $\\mathbf{u}^n$ 的算子就是稳定性多项式 $R(z)$。\n$$\nR(z) = \\frac{1}{3} + \\frac{2}{3}(1+z)\\left(1 + \\frac{1}{2}z + \\frac{1}{4}z^2\\right)\n$$\n我们展开这个乘积：\n$$\n(1+z)\\left(1 + \\frac{1}{2}z + \\frac{1}{4}z^2\\right) = 1 + \\frac{1}{2}z + \\frac{1}{4}z^2 + z + \\frac{1}{2}z^2 + \\frac{1}{4}z^3 = 1 + \\frac{3}{2}z + \\frac{3}{4}z^2 + \\frac{1}{4}z^3\n$$\n将此代回 $R(z)$ 的表达式中：\n$$\nR(z) = \\frac{1}{3} + \\frac{2}{3}\\left(1 + \\frac{3}{2}z + \\frac{3}{4}z^2 + \\frac{1}{4}z^3\\right) = \\frac{1}{3} + \\frac{2}{3} + z + \\frac{1}{2}z^2 + \\frac{1}{6}z^3\n$$\n因此，SSPRK(3,3) 的稳定性多项式是：\n$$\nR(z) = 1 + z + \\frac{1}{2}z^2 + \\frac{1}{6}z^3\n$$\n这是 $\\exp(z)$ 的三阶泰勒级数展开，与该方法的精度阶数一致。\n\n接下来，我们分析 $R(z)$ 在虚轴上的稳定性。空间算子的特征值由 $\\lambda(k) = \\mathrm{i}\\,a\\,\\frac{\\sin(k\\,\\Delta x)}{\\Delta x}$ 给出，它们是纯虚数。因此，稳定性多项式的自变量 $z_k = \\Delta t\\,\\lambda(k)$ 也是纯虚数。我们设 $z = \\mathrm{i} y$，其中 $y$ 为实数，并找出使 $|R(\\mathrm{i} y)| \\leq 1$ 成立的 $y$ 的值。\n$$\nR(\\mathrm{i} y) = 1 + (\\mathrm{i} y) + \\frac{1}{2}(\\mathrm{i} y)^2 + \\frac{1}{6}(\\mathrm{i} y)^3 = 1 + \\mathrm{i} y - \\frac{1}{2}y^2 - \\frac{\\mathrm{i}}{6}y^3\n$$\n对实部和虚部进行分组：\n$$\nR(\\mathrm{i} y) = \\left(1 - \\frac{1}{2}y^2\\right) + \\mathrm{i}\\left(y - \\frac{1}{6}y^3\\right)\n$$\n模的平方是：\n$$\n|R(\\mathrm{i} y)|^2 = \\left(1 - \\frac{1}{2}y^2\\right)^2 + \\left(y - \\frac{1}{6}y^3\\right)^2\n$$\n展开各项：\n$$\n|R(\\mathrm{i} y)|^2 = \\left(1 - y^2 + \\frac{1}{4}y^4\\right) + \\left(y^2 - \\frac{2}{6}y^4 + \\frac{1}{36}y^6\\right)\n$$\n$$\n|R(\\mathrm{i} y)|^2 = 1 - y^2 + \\frac{1}{4}y^4 + y^2 - \\frac{1}{3}y^4 + \\frac{1}{36}y^6\n$$\n$$\n|R(\\mathrm{i} y)|^2 = 1 + \\left(\\frac{1}{4} - \\frac{1}{3}\\right)y^4 + \\frac{1}{36}y^6 = 1 - \\frac{1}{12}y^4 + \\frac{1}{36}y^6\n$$\n稳定性条件 $|R(\\mathrm{i} y)|^2 \\leq 1$ 变为：\n$$\n1 - \\frac{1}{12}y^4 + \\frac{1}{36}y^6 \\leq 1\n$$\n$$\n\\frac{1}{36}y^6 - \\frac{1}{12}y^4 \\leq 0\n$$\n假设 $y \\neq 0$，我们可以除以正数 $\\frac{y^4}{36}$：\n$$\ny^2 - 3 \\leq 0 \\implies y^2 \\leq 3\n$$\n这意味着 $|y| \\leq \\sqrt{3}$。SSPRK(3,3) 方法沿虚轴的稳定区间是 $[-i\\sqrt{3}, i\\sqrt{3}]$。\n\n最后，我们将此约束应用于给定的问题。稳定性条件要求对所有波数 $k$，值 $z_k = \\Delta t\\,\\lambda(k)$ 必须位于此稳定区间内。\n$$\nz_k = \\Delta t \\left(\\mathrm{i}\\,a\\,\\frac{\\sin(k\\,\\Delta x)}{\\Delta x}\\right) = \\mathrm{i} \\left(\\frac{a\\,\\Delta t}{\\Delta x}\\sin(k\\,\\Delta x)\\right)\n$$\n其形式为 $\\mathrm{i} y_k$，其中 $y_k = \\frac{a\\,\\Delta t}{\\Delta x}\\sin(k\\,\\Delta x)$。稳定性条件 $|y_k| \\leq \\sqrt{3}$ 必须对所有 $k$ 成立。\n$$\n\\left|\\frac{a\\,\\Delta t}{\\Delta x}\\sin(k\\,\\Delta x)\\right| \\leq \\sqrt{3}\n$$\n因为 $\\Delta t > 0$ 且 $\\Delta x > 0$，这等价于：\n$$\n\\frac{|a|\\,\\Delta t}{\\Delta x}|\\sin(k\\,\\Delta x)| \\leq \\sqrt{3}\n$$\n为了确保该不等式对网格支持的所有波数 $k$ 都成立，我们必须考虑最坏情况，即 $|\\sin(k\\,\\Delta x)|$ 达到其最大值。$|\\sin(\\theta)|$ 的最大值是 $1$。因此，我们必须满足：\n$$\n\\frac{|a|\\,\\Delta t}{\\Delta x} \\cdot 1 \\leq \\sqrt{3}\n$$\n最大时间步长 $\\Delta t$ 是通过取等号得到的：\n$$\n\\Delta t = \\frac{\\sqrt{3}\\,\\Delta x}{|a|}\n$$\n该表达式给出了以秒为单位的最大允许时间步长 $\\Delta t$，它确保了对所有波数的数值稳定性。",
            "answer": "$$\n\\boxed{\\frac{\\sqrt{3} \\Delta x}{|a|}}\n$$"
        },
        {
            "introduction": "蛙跳格式因其中性稳定性和二阶精度而广受欢迎，但它也存在显著的缺陷。本练习探讨了非负性保持的特性，这在模拟像湿度或化学示踪剂浓度这样不能为负的物理量时至关重要。通过证明标准的线性蛙跳格式在一般条件下无法保证非负性，这个练习揭示了该方法的一个关键局限性。它强调了为什么更先进的技术，例如保正限制器，是现代大气和气候模型的重要组成部分 。",
            "id": "4041408",
            "problem": "考虑在一个具有均匀网格间距 $\\Delta x$ 和恒定平流速度 $a \\in \\mathbb{R}$ 的周期性域上，一个守恒的、非反应性的水汽混合比 $q(x,t)$ 的一维线性平流，其受守恒律 $q_{t} + a\\,q_{x} = 0$ 支配。令 $q_{j}^{n}$ 表示在空间指标 $j \\in \\mathbb{Z}$ 和离散时间层 $n \\in \\mathbb{Z}$ 处 $q$ 的离散近似，时间步长 $\\Delta t$ 均匀。时间蛙跳、空间中心差分离散格式定义为\n$$\n\\frac{q_{j}^{n+1} - q_{j}^{n-1}}{2\\,\\Delta t} + a\\,\\frac{q_{j+1}^{n} - q_{j-1}^{n}}{2\\,\\Delta x} \\;=\\; 0,\n$$\n可以写成\n$$\nq_{j}^{n+1} \\;=\\; q_{j}^{n-1} \\;-\\; \\lambda\\left(q_{j+1}^{n} - q_{j-1}^{n}\\right),\n$$\n其中库朗数为 $\\lambda \\equiv \\frac{a\\,\\Delta t}{\\Delta x}$。此外，假设在每次更新后应用系数为 $\\nu \\in [0,1)$ 的 Robert–Asselin (RA) 滤波器以阻尼计算模态，其定义为\n$$\nq_{j}^{n} \\;\\leftarrow\\; q_{j}^{n} \\;+\\; \\nu\\left(q_{j}^{n-1} - 2\\,q_{j}^{n} + q_{j}^{n+1}\\right).\n$$\n假设进入更新的离散场对所有 $j$ 均满足 $q_{j}^{n-1} \\ge 0$ 和 $q_{j}^{n} \\ge 0$，且对其空间分布没有进一步的限制。从守恒律和给定的离散格式出发，推导库朗数 $\\lambda$ 需满足的一个条件（表示为单个界限），在该条件下，只要对所有 $j$ 都有 $q_{j}^{n-1} \\ge 0$ 和 $q_{j}^{n} \\ge 0$，蛙跳格式就能在 $q_{j}^{n+1} \\ge 0$ 的意义上保持非负性。然后，分析在更新步 $n \\mapsto n+1$ 中，具有任意固定 $\\nu \\in [0,1)$ 的 RA 滤波器的存在是否可以放宽或修改此界限。请以单个实数值或单个闭式表达式的形式，给出保证更新时保持非负性的最大允许库朗数 $\\lambda_{\\max}(\\nu)$。无需四舍入，库朗数为无量纲量，因此不需要物理单位。",
            "solution": "本问题将按要求进行验证，如果有效，将分两部分进行求解。首先，将推导未滤波的蛙跳格式保持非负性时库朗数 $\\lambda$ 需满足的条件。其次，将分析 Robert–Asselin (RA) 滤波器对此条件的影响。\n\n问题验证：\n步骤 1：提取已知条件\n-   控制性偏微分方程：$q_{t} + a\\,q_{x} = 0$。\n-   变量：$q(x,t)$ 是一个守恒的、非反应性的水汽混合比。\n-   平流速度：$a$ 是 $\\mathbb{R}$ 中的一个常数。\n-   离散化：$q_{j}^{n}$ 是在网格点 $j \\in \\mathbb{Z}$ 和时间层 $n \\in \\mathbb{Z}$ 处的近似值。网格间距 $\\Delta x$ 和时间步长 $\\Delta t$ 是均匀的。\n-   蛙跳格式：$\\frac{q_{j}^{n+1} - q_{j}^{n-1}}{2\\,\\Delta t} + a\\,\\frac{q_{j+1}^{n} - q_{j-1}^{n}}{2\\,\\Delta x} = 0$。\n-   蛙跳更新规则：$q_{j}^{n+1} = q_{j}^{n-1} - \\lambda(q_{j+1}^{n} - q_{j-1}^{n})$，其中 $\\lambda \\equiv \\frac{a\\,\\Delta t}{\\Delta x}$。\n-   Robert–Asselin (RA) 滤波器：在每次更新后应用，定义为 $q_{j}^{n} \\leftarrow q_{j}^{n} + \\nu\\left(q_{j}^{n-1} - 2\\,q_{j}^{n} + q_{j}^{n+1}\\right)$。\n-   滤波器系数：$\\nu \\in [0,1)$。\n-   更新步骤的条件：进入更新的场 $q_{j}^{n-1}$ 和 $q_{j}^{n}$ 对所有 $j$ 都是非负的：$q_{j}^{n-1} \\ge 0$ 和 $q_{j}^{n} \\ge 0$。对其空间分布没有进一步的限制。\n-   目标：推导保证未滤波格式下 $q_{j}^{n+1} \\ge 0$ 的 $\\lambda$ 条件。然后，分析 RA 滤波器是否会修改此条件。最后，提供保证非负性保持的最大允许库朗数 $\\lambda_{\\max}(\\nu)$。\n\n步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，因为它涉及用于数值天气预报相关的基本模型方程（线性平流）的标准数值方法（蛙跳格式、RA 滤波器）。它是适定的，提供了执行所需分析的所有必要定义和约束。语言客观明确。所有术语都是偏微分方程数值分析领域的标准术语。该问题不违反任何科学原理，不是不完整的，也不是不适定的。\n\n步骤 3：结论与行动\n问题被判定为**有效**。将提供一个完整的、有理有据的解答。\n\n解答：\n第一部分：未滤波蛙跳格式的非负性\n\n时间蛙跳、空间中心差分格式由以下更新规则给出：\n$$q_{j}^{n+1} = q_{j}^{n-1} - \\lambda(q_{j+1}^{n} - q_{j-1}^{n})$$\n我们已知在时间层 $n-1$ 和 $n$ 的场是非负的，即对所有空间指标 $k \\in \\mathbb{Z}$，有 $q_{k}^{n-1} \\ge 0$ 和 $q_{k}^{n} \\ge 0$。问题要求找到库朗数 $\\lambda$ 需满足的条件，以保证对所有 $j$ 都有 $q_{j}^{n+1} \\ge 0$，前提是初始数据 $q^{n-1}$ 和 $q^{n}$ 可以是任何非负场，且“对其空间分布没有进一步的限制”。\n\n这要求对于非负场 $q^{n-1}$ 和 $q^{n}$ 的任何选择，以下不等式都成立：\n$$q_{j}^{n-1} - \\lambda(q_{j+1}^{n} - q_{j-1}^{n}) \\ge 0$$\n为了找到一个普遍成立的关于 $\\lambda$ 的条件，我们必须考虑最有可能违反此不等式的“最坏情况”场景。这样的场景会试图使左侧表达式尽可能小（即，尽可能为负）。\n\n根据假设，项 $q_{j}^{n-1}$ 是非负的。为了最小化该表达式，我们可以选择一个非负场 $q^{n-1}$，其中 $q_j^{n-1}$ 取其可能的最小值，即 $0$。例如，我们可以选择对所有 $k$ 均为 $q_{k}^{n-1} = 0$ 的平凡场。根据问题陈述，这是一个有效的选择。\n\n当 $q_{j}^{n-1} = 0$ 时，不等式简化为：\n$$-\\lambda(q_{j+1}^{n} - q_{j-1}^{n}) \\ge 0$$\n这必须对任何非负场 $q^n$ 都成立。我们根据 $\\lambda$ 的符号对此进行分析。恒定平流速度 $a$ 可以是任何实数，因此 $\\lambda$ 可以是正数、负数或零。\n\n情况 1：$\\lambda > 0$。\n条件变为 $q_{j+1}^{n} - q_{j-1}^{n} \\le 0$，或 $q_{j+1}^{n} \\le q_{j-1}^{n}$。这个不等式必须对所有 $j$ 和任何非负场 $q^n$ 都成立。这显然是错误的。我们可以自由选择一个违反此条件的非负场 $q^n$。对于一个特定的指标 $j$，考虑如下定义的场：\n$$\nq_{k}^{n} = \\begin{cases} 1  \\text{if } k = j+1 \\\\ 0  \\text{otherwise} \\end{cases}\n$$\n该场是非负的。对于此选择，$q_{j+1}^{n} = 1$ 且 $q_{j-1}^{n} = 0$，所以 $q_{j+1}^{n} - q_{j-1}^{n} = 1 > 0$。条件被违反。在 $j$ 处的最终值为 $q_{j}^{n+1} = 0 - \\lambda(1 - 0) = -\\lambda$。由于 $\\lambda > 0$，所以 $q_{j}^{n+1}  0$。因此，没有 $\\lambda > 0$ 能保证非负性。\n\n情况 2：$\\lambda  0$。\n条件变为 $q_{j+1}^{n} - q_{j-1}^{n} \\ge 0$，或 $q_{j+1}^{n} \\ge q_{j-1}^{n}$。同样，这必须对任何非负场 $q^n$ 都成立，而这是不正确的。考虑以下反例场：\n$$\nq_{k}^{n} = \\begin{cases} 1  \\text{if } k = j-1 \\\\ 0  \\text{otherwise} \\end{cases}\n$$\n该场是非负的。对于此选择，$q_{j+1}^{n} = 0$ 且 $q_{j-1}^{n} = 1$，所以 $q_{j+1}^{n} - q_{j-1}^{n} = -1  0$。条件被违反。在 $j$ 处的最终值为 $q_{j}^{n+1} = 0 - \\lambda(0 - 1) = \\lambda$。由于 $\\lambda  0$，所以 $q_{j}^{n+1}  0$。因此，没有 $\\lambda  0$ 能保证非负性。\n\n情况 3：$\\lambda = 0$。\n更新规则变为 $q_{j}^{n+1} = q_{j}^{n-1}$。由于我们假设 $q_{j}^{n-1} \\ge 0$，因此可得 $q_{j}^{n+1} \\ge 0$。此条件成立。\n\n根据此分析，对于任意非负输入场，能使未滤波蛙跳格式保持非负性的唯一库朗数值是 $\\lambda = 0$。\n\n第二部分：Robert–Asselin 滤波器的影响\n\n该问题描述了每次时间更新的两步过程。首先，使用蛙跳格式计算下一个时间层 $n+1$ 的一个临时值。其次，应用一个滤波器。问题在于滤波器是否可以放宽对 $\\lambda$ 的非负性条件。\n\n步骤 1：使用蛙跳规则计算 $q_j^{n+1}$：\n$$q_{j}^{n+1} = q_{j}^{n-1} - \\lambda(q_{j+1}^{n} - q_{j-1}^{n})$$\n步骤 2：应用 RA 滤波器，该滤波器更新时间层 $n$ 的值：\n$$q_{j}^{n} \\leftarrow q_{j}^{n} + \\nu\\left(q_{j}^{n-1} - 2\\,q_{j}^{n} + q_{j}^{n+1}\\right)$$\n问题的第一部分是找到保证 $q_{j}^{n+1} \\ge 0$ 的 $\\lambda$ 条件。$q_j^{n+1}$ 的方程完全由步骤 1 决定。该方程不涉及滤波器参数 $\\nu$。滤波器是在 $q_{j}^{n+1}$ 计算出来*之后*应用的，并使用这个值来修改 $q_j^n$。根据定义，滤波器在当前更新中不改变 $q_{j}^{n+1}$ 的值。\n\n因此，确保 $q_{j}^{n+1} \\ge 0$ 的条件完全独立于参数为 $\\nu$ 的 RA 滤波器。第一部分的分析保持不变。引入 RA 滤波器并不会放宽或修改对 $\\lambda$ 的界限。\n\n关于 $\\lambda_{\\max}(\\nu)$ 的结论：\n\n最大允许库朗数 $\\lambda_{\\max}$ 是保证保持非负性的 $|\\lambda|$ 值集合的上确界。根据我们的分析，满足条件的唯一 $\\lambda$ 值为 $\\lambda=0$。无论滤波器参数 $\\nu \\in [0,1)$ 的值如何，这一结论都成立。因此，作为 $\\nu$ 的函数，最大允许库朗数是一个常数函数。\n$$\\lambda_{\\max}(\\nu) = 0$$",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "除了非负性问题，蛙跳格式还因其会产生一个可能污染解的非物理“计算模式”而闻名。时间滤波器是标准的补救措施。本练习从简单的分析转向主动设计，您将使用傅里叶分析来理解滤波器如何影响物理模式和计算模式。本练习要求您构建并解决一个优化问题，以设计一个能够最大程度抑制不必要的计算模式，同时对物理求解影响最小的滤波器。这种设计和优化数值组件的过程是开发高级模拟代码的核心活动 。",
            "id": "4041376",
            "problem": "给定一个离散时间线性波问题，该问题是数值天气预报和气候模拟中的典型问题。考虑一个标量复振幅 $y(t)$，其受线性常微分方程 $dy/dt = i \\omega y$ 控制，其中 $\\omega$ 是实角频率。在均匀时间步长 $\\Delta t$ 上的离散时间步进方案由以下三种典型方法定义，这些方法的定性性质在文献中已有详尽阐述：\n\n- 显式（前向欧拉）：$y^{n+1} = y^n + i \\omega \\Delta t \\, y^n$。\n- 隐式（后向欧拉）：$y^{n+1} = y^n + i \\omega \\Delta t \\, y^{n+1}$。\n- 蛙跳格式：$y^{n+1} = y^{n-1} + 2 i \\omega \\Delta t \\, y^n$。\n\n显式和隐式单步法不会引入时间解耦的计算模态。相比之下，两步蛙跳格式支持两种时间本征模态：一种是物理模态，另一种是计算模态，这是两步时间层耦合的结果。一种常见的补救措施是在每次蛙跳格式更新后应用一个线性时间滤波器，以抑制计算模态，同时尽可能地保持物理模态的特性。\n\n设计一个作用于连续三个时间层的最小阶线性时间滤波器，\n$y^n_{\\mathrm{filt}} = a \\, y^{n-1} + b \\, y^n + c \\, y^{n+1}$,\n须满足以下约束条件：\n- 常数保持：$a + b + c = 1$。\n- 物理模态的最小相位误差：强制对称 $a = c$，以使物理模态经滤波器后产生零相移。\n- 滤波器权重的非负性：$a \\ge 0$，$b \\ge 0$，$c \\ge 0$。\n\n设离散振荡频率为 $\\theta = \\omega \\Delta t$，以弧度为单位。分析该滤波器对两种模态时间序列的作用：\n- 物理模态序列：$y^n = e^{i n \\theta}$。\n- 计算模态序列：$y^n = (-1)^n e^{i n \\theta}$。\n\n使用时间上的傅里叶分析，推导滤波器的物理模态和计算模态放大因子，表示为 $a$、$b$、$c$ 和 $\\theta$ 的函数，并强制对称性 $a = c$。\n\n现在，将设计构建为一个优化问题：对于给定的 $\\theta$ 和每次应用滤波器时允许的物理模态振幅损失的指定界限 $\\delta$，\n$$\n|1 - \\text{(物理模态放大率)}| \\le \\delta,\n$$\n选择 $(a,b,c)$ 以最大程度地衰减计算模态（即，最小化其放大因子的绝对值），同时严格满足上述约束条件并保持物理模态的零相位误差。用一个辅助参数表示系数 $(a,b,c)$，并推导出作为 $\\theta$ 和 $\\delta$ 函数的闭式最优解。确保您假设的科学真实性和一致性。\n\n您的程序必须实现此设计，并为每个测试案例按以下顺序计算输出：\n- 系数 $a$、$b$、$c$。\n- 物理模态振幅因子（一个实数）。\n- 物理模态相位误差，以弧度为单位（一个实数；当滤波器对称且振幅因子为非负时，使用 $0$）。\n- 计算模态振幅因子（一个实数）。\n\n所有角度输入均以弧度为单位。此问题中除角度外没有其他物理单位。\n\n测试套件：\n为以下 $(\\theta,\\delta)$ 对提供计算（其中 $\\theta$ 以弧度为单位，$\\delta$ 是无量纲的振幅损失界限）：\n1. $\\theta = 1.0$, $\\delta = 0.02$。\n2. $\\theta = 0.05$, $\\delta = 0.02$。\n3. $\\theta = 3.12$, $\\delta = 0.10$。\n4. $\\theta = 1.0$, $\\delta = 0.35$。\n5. $\\theta = 0.0$, $\\delta = 0.02$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试用例的结果本身都应是一个列表，顺序为\n$[a,b,c,\\text{phys\\_amp},\\text{phys\\_phase\\_error},\\text{comp\\_amp}]$。\n例如，整体打印输出必须类似于\n$[[\\ldots],[\\ldots],[\\ldots],[\\ldots],[\\ldots]]$。",
            "solution": "用户希望设计一个最优的三点对称时间滤波器，用于抑制蛙跳时间积分方案的计算模态。\n\n### 第1步：问题验证\n\n分析问题陈述以确保其科学上合理、适定且完整。\n\n-   **逐字提取的已知条件：**\n    -   控制常微分方程：$dy/dt = i \\omega y$。\n    -   离散时间滤波器：$y^n_{\\mathrm{filt}} = a \\, y^{n-1} + b \\, y^n + c \\, y^{n+1}$。\n    -   约束1（常数保持）：$a + b + c = 1$。\n    -   约束2（零相位误差的对称性）：$a = c$。\n    -   约束3（非负性）：$a \\ge 0$，$b \\ge 0$，$c \\ge 0$。\n    -   离散振荡频率：$\\theta = \\omega \\Delta t$。\n    -   物理模态时间序列：$y^n = e^{i n \\theta}$。\n    -   计算模态时间序列：$y^n = (-1)^n e^{i n \\theta}$。\n    -   优化约束：$|1 - \\text{(物理模态放大率)}| \\le \\delta$。\n    -   优化目标：最小化计算模态放大因子的绝对值。\n    -   测试套件：$(\\theta, \\delta)$ 对为 $(1.0, 0.02)$、$(0.05, 0.02)$、$(3.12, 0.10)$、$(1.0, 0.35)$、$(0.0, 0.02)$。\n    -   要求输出：$[a, b, c, \\text{phys\\_amp}, \\text{phys\\_phase\\_error}, \\text{comp\\_amp}]$。\n\n-   **使用提取的已知条件进行验证：**\n    -   **科学依据：**该问题是微分方程数值解中的一个经典课题，尤其是在地球物理流体动力学领域。蛙跳格式、其计算模态以及时间滤波器（如本问题所推广的 Robert-Asselin 滤波器）的使用都是标准概念。该问题在数值分析中有坚实的理论基础。\n    -   **适定性：**该问题建立了一个约束优化问题。变量、约束和目标函数都已明确定义。下面的推导将证实存在一个唯一、稳定且有意义的解。\n    -   **客观性：**该问题以精确、形式化的数学语言陈述，没有任何主观性。\n    -   **完整性：**提供了所有必要的方程、约束和数据，以推导滤波器系数并分析其性质。\n    -   **可行性：**测试套件中的参数值在物理上和数值上都是现实的。\n\n-   **结论：**该问题有效。\n\n### 第2步：滤波器性质推导\n\n滤波器定义为 $y^n_{\\mathrm{filt}} = a y^{n-1} + b y^n + c y^{n+1}$。约束条件 $a=c$ 和 $a+b+c=1$ 简化了滤波器系数。将 $c=a$ 代入第二个约束条件得到 $2a+b=1$，因此 $b=1-2a$。非负性约束 $a, c \\ge 0$ 和 $b \\ge 0$ 转化为 $a \\ge 0$ 和 $1-2a \\ge 0$，这将 $a$ 的范围限制在 $0 \\le a \\le 1/2$。因此，整个滤波器仅由单个参数 $a$ 定义。\n\n**放大因子分析**\n\n放大因子 $\\lambda$ 由关系式 $y^n_{\\mathrm{filt}} = \\lambda y^n$ 定义。我们将滤波器应用于每种模态。\n\n1.  **物理模态：** 设 $y^n = e^{i n \\theta}$。\n    $$\n    y^n_{\\mathrm{filt}} = a e^{i(n-1)\\theta} + b e^{in\\theta} + c e^{i(n+1)\\theta} = (a e^{-i\\theta} + b + c e^{i\\theta}) y^n\n    $$\n    物理模态的放大因子为 $\\lambda_{\\text{phys}} = a e^{-i\\theta} + b + c e^{i\\theta}$。\n    使用 $a=c$ 和 $b=1-2a$：\n    $$\n    \\lambda_{\\text{phys}} = a(e^{-i\\theta} + e^{i\\theta}) + (1-2a) = 2a\\cos\\theta + 1 - 2a = 1 - 2a(1-\\cos\\theta)\n    $$\n    由于 $a$ 和 $\\theta$ 是实数，$\\lambda_{\\text{phys}}$ 也是实数。对称性约束 $a=c$ 成功确保了零相移，只要 $\\lambda_{\\text{phys}}$ 是非负的。物理模态振幅因子是 $|\\lambda_{\\text{phys}}|$。\n\n2.  **计算模态：** 设 $y^n = (-1)^n e^{i n \\theta}$。\n    $$\n    y^n_{\\mathrm{filt}} = a(-1)^{n-1}e^{i(n-1)\\theta} + b(-1)^n e^{in\\theta} + c(-1)^{n+1}e^{i(n+1)\\theta}\n    $$\n    除以 $y^n = (-1)^n e^{in\\theta}$ 得到放大因子：\n    $$\n    \\lambda_{\\text{comp}} = -a e^{-i\\theta} + b - c e^{i\\theta}\n    $$\n    使用 $a=c$ 和 $b=1-2a$：\n    $$\n    \\lambda_{\\text{comp}} = -a(e^{-i\\theta} + e^{i\\theta}) + (1-2a) = -2a\\cos\\theta + 1 - 2a = 1 - 2a(1+\\cos\\theta)\n    $$\n    $\\lambda_{\\text{comp}}$ 也是一个实数。计算模态振幅因子是 $|\\lambda_{\\text{comp}}|$。\n\n### 第3步：优化问题构建与求解\n\n目标是选择 $a$ 以在所有约束条件下最小化 $|\\lambda_{\\text{comp}}|$。\n\n-   **参数范围：** $0 \\le a \\le 1/2$。\n-   **物理模态约束：** $|1 - \\lambda_{\\text{phys}}| \\le \\delta$。\n    代入 $\\lambda_{\\text{phys}} = 1 - 2a(1-\\cos\\theta)$，我们得到：\n    $$\n    |1 - (1 - 2a(1-\\cos\\theta))| \\le \\delta \\implies |2a(1-\\cos\\theta)| \\le \\delta\n    $$\n    由于 $a \\ge 0$ 且 $1-\\cos\\theta \\ge 0$，这可简化为 $2a(1-\\cos\\theta) \\le \\delta$。\n    如果 $1-\\cos\\theta  0$，这给出了 $a$ 的一个上界：$a \\le \\frac{\\delta}{2(1-\\cos\\theta)}$。\n    如果 $1-\\cos\\theta = 0$（即 $\\theta=2k\\pi$），约束变为 $0 \\le \\delta$，这永远成立，且没有对 $a$ 产生任何限制。\n\n    结合所有约束，$a$ 的可行范围是 $0 \\le a \\le a_{\\max}$，其中：\n    -   如果 $\\cos\\theta=1$：$a_{\\max} = 1/2$。\n    -   如果 $\\cos\\theta \\ne 1$：$a_{\\max} = \\min\\left(\\frac{1}{2}, \\frac{\\delta}{2(1-\\cos\\theta)}\\right)$。\n\n-   **目标函数：** 最小化 $|\\lambda_{\\text{comp}}| = |1 - 2a(1+\\cos\\theta)|$。\n    设 $f(a) = 1 - 2a(1+\\cos\\theta)$。我们希望在 $a \\in [0, a_{\\max}]$ 上最小化 $|f(a)|$。\n    $|f(a)|$ 的无约束最小值为 $0$，出现在 $f(a)=0$ 时，即 $a = a^* = \\frac{1}{2(1+\\cos\\theta)}$（对于 $\\cos\\theta \\ne -1$）。\n    函数 $|f(a)|$ 呈 V 形，中心在 $a^*$ 处。在区间 $[0, a_{\\max}]$ 上 $|f(a)|$ 的最小值在区间内离 $a^*$ 最近的点处取得。由于 $a^* \\ge 0$（对于 $\\cos\\theta \\ne -1$）且区间从 0 开始，所以 $a$ 的最优选择是 $\\min(a_{\\max}, a^*)$。\n\n-   **$a$ 的闭式解：**\n    1.  **一般情况（$\\cos\\theta \\ne \\pm 1$）：**\n        $$\n        a_{\\text{opt}} = \\min\\left( a_{\\max}, a^* \\right) = \\min\\left( \\frac{1}{2}, \\frac{\\delta}{2(1-\\cos\\theta)}, \\frac{1}{2(1+\\cos\\theta)} \\right)\n        $$\n    2.  **特殊情况（$\\cos\\theta=1$，例如 $\\theta=0$）：**\n        物理模态约束 $a \\le \\frac{\\delta}{2(0)}$ 不相关。范围是 $a \\in [0, 1/2]$。\n        $\\lambda_{\\text{comp}} = 1 - 4a$。为在 $[0, 1/2]$ 上最小化 $|1-4a|$，我们选择 $a=1/4$。\n        $a_{\\text{opt}} = 1/4$。\n    3.  **特殊情况（$\\cos\\theta=-1$，例如 $\\theta=\\pi$）：**\n        计算模态的零点 $a^*$ 未定义。\n        $\\lambda_{\\text{comp}} = 1 - 2a(1-1) = 1$，因此无法被衰减。在这个意义上，任何有效的 $a$ 都是‘最优’的。\n        可行范围是 $a_{\\max} = \\min\\left(\\frac{1}{2}, \\frac{\\delta}{2(1-(-1))}\\right) = \\min\\left(\\frac{1}{2}, \\frac{\\delta}{4}\\right)$。我们选择尽可能大的 $a$ 以最大化对其他模态的衰减，所以 $a_{\\text{opt}} = \\min(1/2, \\delta/4)$。\n\n### 第4步：最终计算\n对于每个测试用例 $(\\theta, \\delta)$，我们使用上述公式计算 $a_{\\text{opt}}$。然后：\n- $c = a_{\\text{opt}}$\n- $b = 1 - 2a_{\\text{opt}}$\n- $\\lambda_{\\text{phys}} = 1 - 2a_{\\text{opt}}(1-\\cos\\theta)$\n- $\\lambda_{\\text{comp}} = 1 - 2a_{\\text{opt}}(1+\\cos\\theta)$\n- 物理模态振幅因子是 $\\lambda_{\\text{phys}}$（可以证明 $1-\\delta \\le \\lambda_{\\text{phys}} \\le 1$，所以对于 $\\delta  1$ 它是正数）。\n- 物理模态相位误差是 $0$（因为 $\\lambda_{\\text{phys}}$ 是实数且为正）。\n- 计算模态振幅因子是 $|\\lambda_{\\text{comp}}|$。也可以证明，对于我们选择的 $a_{\\text{opt}}$，$0 \\le \\lambda_{\\text{comp}} \\le 1$。\n\n此逻辑在 Python 代码中实现。",
            "answer": "[[0.02175323284106516,0.9564935343178697,0.02175323284106516,0.98,0.0,0.9329719363539744],[0.2501562989492163,0.4996874021015674,0.2501562989492163,0.9993746092497918,0.0,0.0],[0.025000411330352528,0.949999177339295,0.025000411330352528,0.9,0.0,0.999998342674996],[0.3246101662515431,0.3507796674969138,0.3246101662515431,0.7018518518518519,0.0,0.0],[0.25,0.5,0.25,1.0,0.0,0.0]]"
        }
    ]
}