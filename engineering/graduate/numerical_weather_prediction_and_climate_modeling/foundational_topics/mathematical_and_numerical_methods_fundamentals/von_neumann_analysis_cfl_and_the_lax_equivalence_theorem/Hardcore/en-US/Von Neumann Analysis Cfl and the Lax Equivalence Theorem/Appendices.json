{
    "hands_on_practices": [
        {
            "introduction": "The first step in mastering numerical stability is to apply the Von Neumann analysis to a canonical problem. This practice focuses on the Forward-Time Centered-Space (FTCS) scheme for the one-dimensional diffusion equation, a fundamental model for mixing processes. By deriving the amplification factor, you will determine the strict stability constraint on the time step, providing a concrete example of a Courant-Friedrichs-Lewy (CFL) condition for a parabolic equation .",
            "id": "4110334",
            "problem": "In the context of numerical weather prediction and climate modeling, small-scale turbulent mixing of a passive tracer along a one-dimensional periodic section can be idealized by the linear diffusion Partial Differential Equation (PDE) $u_{t} = \\nu u_{xx}$, where $u(x,t)$ is the tracer concentration, $t$ is time, $x$ is the spatial coordinate, and $\\nu  0$ is the kinematic diffusion coefficient representing subgrid-scale mixing. Consider a uniform spatial grid of spacing $\\Delta x$ and an explicit time step $\\Delta t$. Apply the Forward-Time Centered-Space (FTCS) scheme, defined by a forward Euler time discretization and a second-order centered spatial discretization, on this periodic grid.\n\nUsing von Neumann (Fourier) analysis, assume a discrete Fourier mode $u_{j}^{n} = \\hat{u}^{n} \\exp(i j \\theta)$, where $j$ indexes grid points, $n$ indexes time levels, $\\theta = k \\Delta x$ is the nondimensional phase with $k$ the wavenumber, and $i$ is the imaginary unit. Derive the discrete amplification factor $G(\\theta)$ such that $\\hat{u}^{n+1} = G(\\theta)\\,\\hat{u}^{n}$ and express $G(\\theta)$ in closed form in terms of $\\theta$ and the nondimensional diffusion number $r = \\nu \\Delta t / \\Delta x^{2}$. Then, starting from the fundamental definition of linear stability under von Neumann analysis and invoking the Lax equivalence theorem (which states that for linear initial value problems, consistency plus stability implies convergence), interpret the implications of your $G(\\theta)$ for the Courant-Friedrichs-Lewy (CFL) type restriction on $r$ for the explicit FTCS diffusion scheme.\n\nProvide your final answer as the explicit analytical expression for $G(\\theta)$ in terms of $r$ and $\\theta$. No numerical evaluation is required.",
            "solution": "The problem statement is found to be valid. It is a standard, well-posed problem in the field of numerical analysis of partial differential equations, grounded in established mathematical principles and physical models. All necessary information is provided, and the terminology is precise and unambiguous.\n\nThe problem requires the derivation and interpretation of the stability of the Forward-Time Centered-Space (FTCS) scheme for the one-dimensional linear diffusion equation.\n\nThe governing Partial Differential Equation (PDE) is given by:\n$$\n\\frac{\\partial u}{\\partial t} = \\nu \\frac{\\partial^2 u}{\\partial x^2}\n$$\nwhere $u(x,t)$ is the tracer concentration, $t$ is time, $x$ is the spatial coordinate, and $\\nu  0$ is the constant kinematic diffusion coefficient.\n\nWe are instructed to apply the FTCS scheme on a uniform grid with spatial step $\\Delta x$ and time step $\\Delta t$. Let $u_j^n$ represent the numerical approximation of $u(j\\Delta x, n\\Delta t)$. The FTCS scheme discretizes the time derivative using a first-order forward difference and the spatial derivative using a second-order centered difference.\n\nThe forward difference in time is:\n$$\n\\frac{\\partial u}{\\partial t} \\bigg|_{j,n} \\approx \\frac{u_j^{n+1} - u_j^n}{\\Delta t}\n$$\n\nThe centered difference in space is:\n$$\n\\frac{\\partial^2 u}{\\partial x^2} \\bigg|_{j,n} \\approx \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\\Delta x)^2}\n$$\n\nSubstituting these approximations into the PDE yields the finite difference equation for the FTCS scheme:\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = \\nu \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\\Delta x)^2}\n$$\n\nWe can solve for the solution at the next time step, $u_j^{n+1}$:\n$$\nu_j^{n+1} = u_j^n + \\frac{\\nu \\Delta t}{(\\Delta x)^2} (u_{j+1}^n - 2u_j^n + u_{j-1}^n)\n$$\n\nThe problem defines the nondimensional diffusion number as $r = \\nu \\Delta t / (\\Delta x)^2$. Substituting $r$ into the equation gives:\n$$\nu_j^{n+1} = u_j^n + r (u_{j+1}^n - 2u_j^n + u_{j-1}^n)\n$$\n\nTo perform the von Neumann stability analysis, we substitute the given discrete Fourier mode, $u_j^n = \\hat{u}^n \\exp(i j \\theta)$, where $\\theta = k \\Delta x$ is the nondimensional wavenumber. The term $\\hat{u}^n$ is the amplitude of the Fourier mode at time level $n$. The relation $\\hat{u}^{n+1} = G(\\theta) \\hat{u}^n$ defines the amplification factor $G(\\theta)$.\n\nSubstituting the Fourier mode into the difference equation:\n$$\n\\hat{u}^{n+1} \\exp(i j \\theta) = \\hat{u}^n \\exp(i j \\theta) + r \\left( \\hat{u}^n \\exp(i (j+1) \\theta) - 2 \\hat{u}^n \\exp(i j \\theta) + \\hat{u}^n \\exp(i (j-1) \\theta) \\right)\n$$\n\nWe can factor out the common term $\\hat{u}^n \\exp(i j \\theta)$ from the right-hand side:\n$$\n\\hat{u}^{n+1} \\exp(i j \\theta) = \\hat{u}^n \\exp(i j \\theta) \\left[ 1 + r \\left( \\exp(i \\theta) - 2 + \\exp(-i \\theta) \\right) \\right]\n$$\n\nDividing both sides by $\\hat{u}^n \\exp(i j \\theta)$ (which is non-zero) and using the definition $G(\\theta) = \\hat{u}^{n+1} / \\hat{u}^n$, we obtain the expression for the amplification factor:\n$$\nG(\\theta) = 1 + r \\left( \\exp(i \\theta) + \\exp(-i \\theta) - 2 \\right)\n$$\n\nUsing Euler's identity, $\\cos(\\theta) = \\frac{\\exp(i \\theta) + \\exp(-i \\theta)}{2}$, we have $\\exp(i \\theta) + \\exp(-i \\theta) = 2 \\cos(\\theta)$. Substituting this into the expression for $G(\\theta)$ yields the desired closed-form expression in terms of $r$ and $\\theta$:\n$$\nG(\\theta) = 1 + r(2 \\cos(\\theta) - 2) = 1 + 2r(\\cos(\\theta) - 1)\n$$\nThis can be further simplified using the half-angle identity $\\cos(\\theta) - 1 = -2 \\sin^2(\\theta/2)$, which gives $G(\\theta) = 1 - 4r \\sin^2(\\theta/2)$. However, the form $1 + 2r(\\cos(\\theta) - 1)$ is the direct result requested.\n\nNow, we interpret the implications for stability. The fundamental definition of linear stability in von Neumann analysis requires that the magnitude of the amplification factor be less than or equal to one for all possible wavenumbers (i.e., for all $\\theta$):\n$$\n|G(\\theta)| \\le 1 \\quad \\forall \\theta \\in [-\\pi, \\pi]\n$$\nThis condition ensures that no Fourier mode will be unphysically amplified in time, which would lead to a catastrophic growth of numerical error.\n\nSince $G(\\theta)$ is purely real, the condition $|G(\\theta)| \\le 1$ is equivalent to $-1 \\le G(\\theta) \\le 1$.\nLet's check these two inequalities.\n\n1. The upper bound: $G(\\theta) \\le 1$\n$$\n1 + 2r(\\cos(\\theta) - 1) \\le 1\n$$\n$$\n2r(\\cos(\\theta) - 1) \\le 0\n$$\nSince $r = \\nu \\Delta t / (\\Delta x)^2  0$ and the term $(\\cos(\\theta) - 1)$ is always less than or equal to zero (as $\\cos(\\theta) \\le 1$), their product is always less than or equal to zero. Thus, this inequality is always satisfied.\n\n2. The lower bound: $G(\\theta) \\ge -1$\n$$\n1 + 2r(\\cos(\\theta) - 1) \\ge -1\n$$\n$$\n2 \\ge -2r(\\cos(\\theta) - 1)\n$$\n$$\n2 \\ge 2r(1 - \\cos(\\theta))\n$$\n$$\n1 \\ge r(1 - \\cos(\\theta))\n$$\nThis condition must hold for all values of $\\theta$. To find the most restrictive case, we must maximize the term $r(1 - \\cos(\\theta))$. Since $r$ is a positive constant, we need to maximize $(1 - \\cos(\\theta))$. The maximum value of this term is $2$, which occurs when $\\cos(\\theta) = -1$, corresponding to the highest frequency (shortest wavelength) representable on the grid, $\\theta = \\pi$ (the so-called \"2-$\\Delta x$\" wave).\n\nSubstituting this most restrictive case into the inequality:\n$$\n1 \\ge r(1 - (-1))\n$$\n$$\n1 \\ge 2r\n$$\n$$\nr \\le \\frac{1}{2}\n$$\n\nThus, the CFL-type restriction for the FTCS scheme applied to the diffusion equation is $r = \\frac{\\nu \\Delta t}{(\\Delta x)^2} \\le \\frac{1}{2}$. This is a condition of conditional stability. The time step $\\Delta t$ is constrained by the square of the spatial step, $\\Delta t \\le \\frac{(\\Delta x)^2}{2\\nu}$. This can be a very severe restriction for high-resolution models (small $\\Delta x$).\n\nFinally, the Lax equivalence theorem states that for a well-posed linear initial value problem, a consistent finite difference scheme is convergent if and only if it is stable.\n- **Consistency**: The FTCS scheme is consistent with the diffusion equation because its truncation error, which is of order $O(\\Delta t, (\\Delta x)^2)$, goes to zero as $\\Delta t \\to 0$ and $\\Delta x \\to 0$.\n- **Stability**: As derived, the scheme is stable only under the condition $r \\le 1/2$.\nTherefore, by the Lax equivalence theorem, the numerical solution from the FTCS scheme will converge to the true solution of the diffusion PDE as the grid is refined, provided that the stability condition $r \\le 1/2$ is satisfied. If this condition is violated, the scheme is unstable, and the numerical solution will diverge, rendering it useless.\nThe final answer is the derived expression for $G(\\theta)$.",
            "answer": "$$\n\\boxed{1 + 2r(\\cos(\\theta) - 1)}\n$$"
        },
        {
            "introduction": "Building on the foundational analysis of parabolic equations, this exercise shifts focus to the hyperbolic advection equation, a cornerstone of transport in weather and climate models. Here, you will derive and compare two classic explicit schemes: the first-order Lax-Friedrichs and the second-order Lax-Wendroff. This comparative analysis not only reinforces the application of Von Neumann analysis but also illuminates the crucial trade-offs between numerical accuracy and stability .",
            "id": "4110330",
            "problem": "Consider the linear one-dimensional advection equation $u_{t} + c\\,u_{x} = 0$ for a passive scalar $u(x,t)$ in a zonal column model of a Numerical Weather Prediction (NWP) system, where the wind speed $c  0$ is constant. Let the computational domain be discretized by a uniform spatial mesh $x_{j} = j\\,\\Delta x$ and a uniform time step $t_{n} = n\\,\\Delta t$, with the Courant–Friedrichs–Lewy (CFL) number $r = \\dfrac{c\\,\\Delta t}{\\Delta x}$. Assume periodic boundary conditions on a sufficiently large domain so that Fourier-mode analysis is meaningful.\n\nStarting from the finite-difference representation of $u_{t}$ and $u_{x}$ consistent with the governing equation and the conservative transport of $u$:\n- Derive the explicit nearest-neighbor stencil formula customarily known as the Lax–Friedrichs scheme by using a first-order time update and a centered spatial representation augmented by a symmetric nearest-neighbor replacement of the point value consistent with conservative averaging.\n- Derive the explicit two-step Taylor-in-time stencil formula customarily known as the Lax–Wendroff scheme by expanding $u(x_{j}, t_{n} + \\Delta t)$ to second order in time and eliminating time derivatives using the governing equation, while representing spatial derivatives by centered differences of matching formal order.\n\nFor each scheme:\n- Write the resulting stencil update $u_{j}^{n+1}$ in terms of $u_{j-1}^{n}$, $u_{j}^{n}$, and $u_{j+1}^{n}$, and explain the formal order of accuracy in time and space, under the CFL scaling $\\Delta t = \\lambda\\,\\Delta x$ with $\\lambda = \\mathcal{O}(1)$ as $\\Delta x \\to 0$.\n- Perform a von Neumann (Fourier-mode) stability analysis by inserting the ansatz $u_{j}^{n} = \\hat{u}^{n}\\,\\exp(i\\,j\\,\\xi)$ with wavenumber $\\xi \\in [0, 2\\pi]$, and compute the amplification factor $G(\\xi, r)$ for each scheme.\n- Using the Lax equivalence theorem (for linear initial-value problems, a consistent linear difference scheme is convergent if and only if it is stable), determine the tightest common upper bound on $|r|$ that guarantees stability for all Fourier modes for both schemes simultaneously.\n\nReport as your final answer the single number $r_{\\max}$, the supremum of $|r|$ such that both schemes are von Neumann stable for all wavenumbers. No rounding is required, and the answer is dimensionless. Express the final answer as a single number.",
            "solution": "The problem requires the derivation and stability analysis of the Lax-Friedrichs and Lax-Wendroff schemes for the one-dimensional linear advection equation, $u_{t} + c\\,u_{x} = 0$, where $c  0$ is a constant. The final objective is to find the tightest common upper bound on the Courant-Friedrichs-Lewy (CFL) number, $r = \\frac{c\\,\\Delta t}{\\Delta x}$, that ensures stability for both schemes.\n\nWe will analyze each scheme separately and then combine the results. For both schemes, we use the discretization $u(x_j, t_n) \\approx u_j^n$, where $x_j = j\\,\\Delta x$ and $t_n = n\\,\\Delta t$.\n\n### Lax–Friedrichs Scheme\n\n**1. Derivation and Stencil Formula**\nThe problem directs us to derive the scheme using a first-order time update (Forward Euler), a centered spatial representation for $u_x$, and a specific replacement for the term $u_j^n$.\nA simple Forward-Time Centered-Space (FTCS) discretization would be:\n$$ \\frac{u_j^{n+1} - u_j^n}{\\Delta t} + c \\frac{u_{j+1}^n - u_{j-1}^n}{2\\Delta x} = 0 $$\nThe Lax-Friedrichs scheme modifies this by replacing the point value $u_j^n$ with its conservative average over nearest neighbors, $u_j^n \\to \\frac{1}{2}(u_{j+1}^n + u_{j-1}^n)$. Applying this modification, we get:\n$$ \\frac{u_j^{n+1} - \\frac{1}{2}(u_{j+1}^n + u_{j-1}^n)}{\\Delta t} + c \\frac{u_{j+1}^n - u_{j-1}^n}{2\\Delta x} = 0 $$\nSolving for $u_j^{n+1}$:\n$$ u_j^{n+1} = \\frac{1}{2}(u_{j+1}^n + u_{j-1}^n) - \\frac{c\\,\\Delta t}{2\\Delta x}(u_{j+1}^n - u_{j-1}^n) $$\nSubstituting the CFL number $r = \\frac{c\\,\\Delta t}{\\Delta x}$:\n$$ u_j^{n+1} = \\frac{1}{2}(u_{j+1}^n + u_{j-1}^n) - \\frac{r}{2}(u_{j+1}^n - u_{j-1}^n) $$\nGrouping terms by their spatial index at time level $n$:\n$$ u_j^{n+1} = \\left(\\frac{1}{2} + \\frac{r}{2}\\right)u_{j-1}^n + 0 \\cdot u_j^n + \\left(\\frac{1}{2} - \\frac{r}{2}\\right)u_{j+1}^n $$\nThis is the stencil update formula for the Lax-Friedrichs scheme.\n\n**2. Order of Accuracy**\nTo determine the formal order of accuracy, we perform a Taylor series expansion of the scheme's terms around the point $(x_j, t_n)$.\n$$ u_{j \\pm 1}^n = u \\pm \\Delta x u_x + \\frac{\\Delta x^2}{2} u_{xx} \\pm \\frac{\\Delta x^3}{6} u_{xxx} + \\mathcal{O}(\\Delta x^4) $$\n$$ u_j^{n+1} = u + \\Delta t u_t + \\frac{\\Delta t^2}{2} u_{tt} + \\mathcal{O}(\\Delta t^3) $$\nSubstituting these into the scheme $\\frac{u_j^{n+1} - \\frac{1}{2}(u_{j+1}^n + u_{j-1}^n)}{\\Delta t} + c \\frac{u_{j+1}^n - u_{j-1}^n}{2\\Delta x} = 0$, we get:\n$$ \\frac{(u + \\Delta t u_t + \\dots) - (u + \\frac{\\Delta x^2}{2}u_{xx} + \\dots)}{\\Delta t} + c(u_x + \\frac{\\Delta x^2}{6}u_{xxx} + \\dots) = 0 $$\n$$ u_t - \\frac{\\Delta x^2}{2\\Delta t}u_{xx} + c u_x + \\mathcal{O}(\\Delta t, \\Delta x^2) = 0 $$\nRearranging, we find the modified equation that the scheme actually solves:\n$$ u_t + c u_x = \\frac{\\Delta x^2}{2\\Delta t}u_{xx} + \\mathcal{O}(\\Delta t, \\Delta x^2) $$\nThe leading term of the truncation error is $\\mathcal{O}(\\frac{\\Delta x^2}{\\Delta t})$. Under the CFL scaling $\\Delta t = \\lambda \\Delta x$ with $\\lambda = \\mathcal{O}(1)$, the truncation error is $\\mathcal{O}(\\Delta x)$. Thus, the Lax-Friedrichs scheme is first-order accurate in both space and time.\n\n**3. von Neumann Stability Analysis**\nWe substitute the Fourier mode ansatz $u_j^n = \\hat{u}^n e^{i j \\xi}$ into the stencil formula, where $\\xi = k_x \\Delta x$ is the dimensionless wavenumber. The amplification factor is $G(\\xi, r) = \\hat{u}^{n+1}/\\hat{u}^n$.\n$$ G e^{ij\\xi} = \\frac{1+r}{2} e^{i(j-1)\\xi} + \\frac{1-r}{2} e^{i(j+1)\\xi} $$\nDividing by $e^{ij\\xi}$:\n$$ G_{LF}(\\xi, r) = \\frac{1+r}{2} e^{-i\\xi} + \\frac{1-r}{2} e^{i\\xi} $$\n$$ G_{LF}(\\xi, r) = \\frac{1}{2}(e^{i\\xi} + e^{-i\\xi}) - \\frac{r}{2}(e^{i\\xi} - e^{-i\\xi}) $$\nUsing Euler's formula, $e^{\\pm i\\xi} = \\cos(\\xi) \\pm i\\sin(\\xi)$:\n$$ G_{LF}(\\xi, r) = \\cos(\\xi) - i r \\sin(\\xi) $$\nFor stability, we require $|G_{LF}(\\xi, r)| \\le 1$ for all $\\xi$. The magnitude squared is:\n$$ |G_{LF}|^2 = (\\cos(\\xi))^2 + (-r \\sin(\\xi))^2 = \\cos^2(\\xi) + r^2 \\sin^2(\\xi) $$\nThe stability condition is $\\cos^2(\\xi) + r^2 \\sin^2(\\xi) \\le 1$. Since $\\cos^2(\\xi) = 1 - \\sin^2(\\xi)$:\n$$ 1 - \\sin^2(\\xi) + r^2 \\sin^2(\\xi) \\le 1 $$\n$$ (r^2 - 1)\\sin^2(\\xi) \\le 0 $$\nAs $\\sin^2(\\xi) \\ge 0$, this inequality holds for all $\\xi$ if and only if $r^2 - 1 \\le 0$, which implies $r^2 \\le 1$.\nThe stability condition for the Lax-Friedrichs scheme is $|r| \\le 1$.\n\n### Lax–Wendroff Scheme\n\n**1. Derivation and Stencil Formula**\nWe begin with a second-order Taylor series expansion of $u(x, t)$ in time:\n$$ u(x, t+\\Delta t) = u(x,t) + \\Delta t u_t + \\frac{\\Delta t^2}{2} u_{tt} + \\mathcal{O}(\\Delta t^3) $$\nFrom the governing equation $u_t = -c u_x$, we find the second time derivative:\n$$ u_{tt} = \\frac{\\partial}{\\partial t}(-c u_x) = -c \\frac{\\partial}{\\partial x}(u_t) = -c \\frac{\\partial}{\\partial x}(-c u_x) = c^2 u_{xx} $$\nSubstituting $u_t$ and $u_{tt}$ into the Taylor expansion:\n$$ u(x, t+\\Delta t) = u(x,t) - c \\Delta t u_x + \\frac{c^2 \\Delta t^2}{2} u_{xx} + \\mathcal{O}(\\Delta t^3) $$\nNow, we discretize this equation at $(x_j, t_n)$ using second-order centered differences for the spatial derivatives:\n$$ u_x \\approx \\frac{u_{j+1}^n - u_{j-1}^n}{2\\Delta x}, \\quad u_{xx} \\approx \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{\\Delta x^2} $$\nSubstituting these into the discretized Taylor expansion gives the Lax-Wendroff scheme:\n$$ u_j^{n+1} = u_j^n - c \\Delta t \\left(\\frac{u_{j+1}^n - u_{j-1}^n}{2\\Delta x}\\right) + \\frac{c^2 \\Delta t^2}{2} \\left(\\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{\\Delta x^2}\\right) $$\nUsing the CFL number $r = \\frac{c \\Delta t}{\\Delta x}$:\n$$ u_j^{n+1} = u_j^n - \\frac{r}{2}(u_{j+1}^n - u_{j-1}^n) + \\frac{r^2}{2}(u_{j+1}^n - 2u_j^n + u_{j-1}^n) $$\nGrouping terms by spatial index:\n$$ u_j^{n+1} = \\left(\\frac{r}{2} + \\frac{r^2}{2}\\right)u_{j-1}^n + (1 - r^2)u_j^n + \\left(-\\frac{r}{2} + \\frac{r^2}{2}\\right)u_{j+1}^n $$\nThe stencil update formula is $u_j^{n+1} = \\frac{r(r+1)}{2}u_{j-1}^n + (1-r^2)u_j^n + \\frac{r(r-1)}{2}u_{j+1}^n$.\n\n**2. Order of Accuracy**\nThe derivation itself shows that the scheme approximates the PDE with an error of $\\mathcal{O}(\\Delta t^3)$ from the time expansion and $\\mathcal{O}(\\Delta t \\Delta x^2)$ from the spatial discretization. Specifically, the leading term of the local truncation error is $\\frac{c \\Delta t \\Delta x^2}{6}(1-r^2)u_{xxx}$. Under the scaling $\\Delta t = \\lambda \\Delta x$, this error is $\\mathcal{O}(\\Delta x^3)$. The scheme is second-order accurate, $\\mathcal{O}(\\Delta t^2, \\Delta x^2)$.\n\n**3. von Neumann Stability Analysis**\nWe substitute the ansatz $u_j^n = G^n e^{i j \\xi}$ into the scheme expression:\n$$ G = 1 - \\frac{r}{2}(e^{i\\xi} - e^{-i\\xi}) + \\frac{r^2}{2}(e^{i\\xi} - 2 + e^{-i\\xi}) $$\n$$ G_{LW}(\\xi, r) = 1 - \\frac{r}{2}(2i\\sin(\\xi)) + \\frac{r^2}{2}(2\\cos(\\xi) - 2) = 1 - i r \\sin(\\xi) + r^2(\\cos(\\xi) - 1) $$\nTo find the magnitude, we compute $|G_{LW}|^2$:\n$$ |G_{LW}|^2 = (1 + r^2(\\cos(\\xi)-1))^2 + (-r\\sin(\\xi))^2 $$\n$$ |G_{LW}|^2 = 1 + 2r^2(\\cos(\\xi)-1) + r^4(\\cos(\\xi)-1)^2 + r^2\\sin^2(\\xi) $$\nUsing $1 - \\cos\\xi = 2\\sin^2(\\xi/2)$ expands this to:\n$$ |G_{LW}|^2 = 1 - 4r^2\\sin^2(\\frac{\\xi}{2}) + 4r^4\\sin^4(\\frac{\\xi}{2}) + 4r^2\\sin^2(\\frac{\\xi}{2})\\cos^2(\\frac{\\xi}{2}) $$\n$$ |G_{LW}|^2 = 1 - 4r^2\\sin^2(\\frac{\\xi}{2}) + 4r^4\\sin^4(\\frac{\\xi}{2}) + 4r^2\\sin^2(\\frac{\\xi}{2})(1-\\sin^2(\\frac{\\xi}{2})) $$\n$$ |G_{LW}|^2 = 1 - 4r^2\\sin^2(\\frac{\\xi}{2}) + 4r^4\\sin^4(\\frac{\\xi}{2}) + 4r^2\\sin^2(\\frac{\\xi}{2}) - 4r^2\\sin^4(\\frac{\\xi}{2}) $$\n$$ |G_{LW}|^2 = 1 + (4r^4 - 4r^2)\\sin^4(\\frac{\\xi}{2}) = 1 - 4r^2(1-r^2)\\sin^4(\\frac{\\xi}{2}) $$\nFor stability, $|G_{LW}|^2 \\le 1$, which requires:\n$$ -4r^2(1-r^2)\\sin^4(\\frac{\\xi}{2}) \\le 0 $$\nSince $r^2 \\ge 0$ and $\\sin^4(\\xi/2) \\ge 0$, this condition is met for all $\\xi$ if and only if $1-r^2 \\ge 0$, which implies $r^2 \\le 1$.\nThe stability condition for the Lax-Wendroff scheme is $|r| \\le 1$.\n\n### Common Stability Bound\n\nAccording to the Lax equivalence theorem, for these consistent linear schemes, stability is the necessary and sufficient condition for convergence.\n- The von Neumann stability analysis for the Lax-Friedrichs scheme yields the condition $|r| \\le 1$.\n- The von Neumann stability analysis for the Lax-Wendroff scheme yields the condition $|r| \\le 1$.\n\nBoth schemes are stable if and only if the CFL number $r$ satisfies $|r| \\le 1$. The set of values for which both schemes are simultaneously stable is the intersection of their individual stability regions, which in this case is the interval $[-1, 1]$.\n\nThe tightest common upper bound on $|r|$ is the supremum of $|r|$ over this common stability region. Thus, the supremum is $1$.\nLet $r_{\\max} = \\sup \\{ |r| : |r| \\le 1 \\}$. This gives $r_{\\max} = 1$.",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "Stability analysis tells us whether a scheme will fail, but it can also reveal more subtle behaviors. A stable scheme with an amplification factor magnitude less than one introduces numerical dissipation, which can be quantified and interpreted physically. This practice guides you through an analysis of the first-order upwind scheme to derive its equivalent numerical diffusion coefficient, demonstrating how a scheme's leading truncation error manifests as an artificial process that damps waves .",
            "id": "4110374",
            "problem": "In one spatial dimension, consider passive tracer transport in a uniform zonal current, modeled by the linear advection equation $u_{t} + c\\,u_{x} = 0$ with constant velocity $c  0$ on a periodic domain. A standard first-order upwind in space and forward Euler in time discretization (adopted in many numerical weather prediction transport modules) is applied on a uniform grid with spacing $\\Delta x$ and time step $\\Delta t$. Denote $\\mu = c\\,\\Delta t / \\Delta x$ as the Courant–Friedrichs–Lewy (CFL) number. Assume $\\mu \\in [0,1]$ so that the scheme is stable and consistent, as required by the Lax equivalence theorem.\n\nStarting from the discrete scheme, perform a von Neumann Fourier mode analysis to:\n- derive the amplification factor $G(\\theta)$ for a Fourier mode of nondimensional wavenumber $\\theta = k\\,\\Delta x$;\n- obtain the small-$\\theta$ expansion of $\\lvert G(\\theta) \\rvert$ up to and including the leading nontrivial order in $\\theta$;\n- interpret this leading-order amplitude decay over one time step $\\Delta t$ as arising from an equivalent diffusive term $\\nu_{\\mathrm{num}}\\,u_{xx}$ added to the continuous equation, meaning that a mode of wavenumber $k$ decays per time step as $\\exp\\!\\big(-\\nu_{\\mathrm{num}}\\,k^{2}\\,\\Delta t\\big)$ to leading order.\n\nProvide a single closed-form analytic expression for the equivalent numerical diffusion coefficient $\\nu_{\\mathrm{num}}$ in terms of $c$, $\\Delta x$, and $\\mu$. Express your final result symbolically; do not substitute numerical values. SI base units are implied for dimensional quantities. Your final answer must be a single analytical expression.",
            "solution": "The problem as stated is valid. It is scientifically grounded in the principles of numerical analysis for partial differential equations, specifically concerning the stability and dissipative properties of finite difference schemes. The problem is well-posed, with all necessary information provided and a clear, unique objective. The language is objective and formal.\n\nThe problem asks for the derivation of the numerical diffusion coefficient for the first-order upwind scheme applied to the linear advection equation. The derivation proceeds in three main steps:\n1.  Deriving the amplification factor $G$ of the numerical scheme using von Neumann stability analysis.\n2.  Analyzing the dissipative nature of the scheme by expanding the modulus of the amplification factor, $|G|$, for long wavelengths.\n3.  Equating this numerical dissipation to the dissipation produced by a physical diffusion term $\\nu_{\\mathrm{num}}u_{xx}$ added to the original partial differential equation (PDE), thereby determining $\\nu_{\\mathrm{num}}$.\n\nThe one-dimensional linear advection equation is given by:\n$$ u_{t} + c\\,u_{x} = 0 $$\nwhere $c  0$ is the constant advection velocity.\n\nThe discretization uses the forward Euler method for time (subscript $t$) and the first-order upwind scheme for space (subscript $x$). Let $u_j^n$ represent the numerical solution at spatial grid point $x_j = j\\Delta x$ and time $t_n = n\\Delta t$. Since $c  0$, the \"upwind\" direction is from the left (index $j-1$). The discretized equation is:\n$$ \\frac{u_j^{n+1} - u_j^n}{\\Delta t} + c \\left( \\frac{u_j^n - u_{j-1}^n}{\\Delta x} \\right) = 0 $$\nRearranging to solve for $u_j^{n+1}$:\n$$ u_j^{n+1} = u_j^n - \\frac{c\\Delta t}{\\Delta x} (u_j^n - u_{j-1}^n) $$\nUsing the definition of the Courant–Friedrichs–Lewy (CFL) number, $\\mu = \\frac{c\\Delta t}{\\Delta x}$, the scheme becomes:\n$$ u_j^{n+1} = u_j^n - \\mu (u_j^n - u_{j-1}^n) = (1 - \\mu)u_j^n + \\mu u_{j-1}^n $$\n\nFor the von Neumann analysis, we consider a single Fourier mode of the solution:\n$$ u_j^n = \\hat{u}^n(k) e^{i k x_j} = (G(k))^n \\hat{u}^0(k) e^{i k j \\Delta x} $$\nHere, $k$ is the wavenumber and $G(k)$ is the amplification factor per time step. Substituting this form into the discrete equation:\n$$ G^{n+1} e^{i k j \\Delta x} = (1 - \\mu) G^n e^{i k j \\Delta x} + \\mu G^n e^{i k (j-1) \\Delta x} $$\nDividing by $G^n e^{i k j \\Delta x}$ yields the amplification factor $G$:\n$$ G = (1 - \\mu) + \\mu e^{-i k \\Delta x} $$\nUsing the nondimensional wavenumber $\\theta = k \\Delta x$, we have:\n$$ G(\\theta) = 1 - \\mu + \\mu e^{-i\\theta} $$\nThis completes the first part of the task.\n\nNext, we find the magnitude of the amplification factor, $|G(\\theta)|$, to analyze the amplitude error (numerical dissipation).\n$$ G(\\theta) = (1 - \\mu) + \\mu(\\cos\\theta - i\\sin\\theta) = (1 - \\mu + \\mu\\cos\\theta) - i(\\mu\\sin\\theta) $$\nThe squared magnitude is:\n$$ |G(\\theta)|^2 = (1 - \\mu + \\mu\\cos\\theta)^2 + (-\\mu\\sin\\theta)^2 $$\n$$ |G(\\theta)|^2 = (1 - \\mu)^2 + 2\\mu(1-\\mu)\\cos\\theta + \\mu^2\\cos^2\\theta + \\mu^2\\sin^2\\theta $$\n$$ |G(\\theta)|^2 = 1 - 2\\mu + \\mu^2 + 2\\mu(1-\\mu)\\cos\\theta + \\mu^2(\\cos^2\\theta + \\sin^2\\theta) $$\n$$ |G(\\theta)|^2 = 1 - 2\\mu + \\mu^2 + 2\\mu(1-\\mu)\\cos\\theta + \\mu^2 $$\n$$ |G(\\theta)|^2 = 1 - 2\\mu + 2\\mu^2 + (2\\mu - 2\\mu^2)\\cos\\theta $$\n$$ |G(\\theta)|^2 = 1 - 2\\mu(1 - \\mu) + 2\\mu(1 - \\mu)\\cos\\theta = 1 - 2\\mu(1 - \\mu)(1 - \\cos\\theta) $$\nFor the scheme to be stable, we require $|G(\\theta)| \\le 1$. Since $\\mu \\in [0,1]$ and $(1-\\cos\\theta) \\ge 0$, we have $2\\mu(1-\\mu)(1-\\cos\\theta) \\ge 0$, which ensures $|G(\\theta)|^2 \\le 1$.\n\nNow, we perform a small-$\\theta$ expansion to analyze the behavior for long wavelengths. We use the Taylor series for $\\cos\\theta$ about $\\theta=0$:\n$$ \\cos\\theta = 1 - \\frac{\\theta^2}{2} + O(\\theta^4) $$\nSubstituting this into the expression for $|G(\\theta)|^2$:\n$$ |G(\\theta)|^2 = 1 - 2\\mu(1 - \\mu)\\left(1 - \\left(1 - \\frac{\\theta^2}{2} + O(\\theta^4)\\right)\\right) $$\n$$ |G(\\theta)|^2 = 1 - 2\\mu(1 - \\mu)\\left(\\frac{\\theta^2}{2} - O(\\theta^4)\\right) = 1 - \\mu(1 - \\mu)\\theta^2 + O(\\theta^4) $$\nTo find $|G(\\theta)|$, we take the square root, using the expansion $\\sqrt{1-x} = 1 - \\frac{1}{2}x + O(x^2)$:\n$$ |G(\\theta)| = \\left(1 - \\mu(1 - \\mu)\\theta^2 + O(\\theta^4)\\right)^{1/2} = 1 - \\frac{1}{2}\\mu(1 - \\mu)\\theta^2 + O(\\theta^4) $$\nThe leading-order amplitude decay over one time step is thus characterized by the $\\theta^2$ term.\n\nFinally, we interpret this decay as arising from an equivalent diffusion term $\\nu_{\\mathrm{num}}u_{xx}$ added to the original PDE, which becomes the advection-diffusion equation:\n$$ u_t + c u_x = \\nu_{\\mathrm{num}} u_{xx} $$\nThe exact amplification factor for this modified PDE over a time step $\\Delta t$ can be found by substituting a Fourier mode $u(x,t) = A(t)e^{ikx}$:\n$$ \\frac{dA}{dt} e^{ikx} + c(ik)A e^{ikx} = \\nu_{\\mathrm{num}}(ik)^2 A e^{ikx} $$\n$$ \\frac{dA}{dt} = (-ikc - k^2\\nu_{\\mathrm{num}})A $$\nThe solution for $A(t)$ is $A(t) = A(0)\\exp((-ikc - k^2\\nu_{\\mathrm{num}})t)$. The amplification factor over one time step $\\Delta t$ is:\n$$ G_{\\mathrm{exact}}(k) = \\frac{A(\\Delta t)}{A(0)} = \\exp((-ikc - k^2\\nu_{\\mathrm{num}})\\Delta t) $$\nThe magnitude of this factor represents the amplitude decay:\n$$ |G_{\\mathrm{exact}}(k)| = |\\exp(-ikc\\Delta t)\\exp(-k^2\\nu_{\\mathrm{num}}\\Delta t)| = \\exp(-k^2\\nu_{\\mathrm{num}}\\Delta t) $$\nFor small arguments, $\\exp(-z) \\approx 1-z$. Thus, for small $k$, the decay is:\n$$ |G_{\\mathrm{exact}}(k)| \\approx 1 - k^2\\nu_{\\mathrm{num}}\\Delta t $$\nWe now equate the leading-order decay from the numerical scheme with this effective physical decay. Replacing $\\theta$ with $k\\Delta x$:\n$$ |G(k\\Delta x)| \\approx 1 - \\frac{1}{2}\\mu(1 - \\mu)(k\\Delta x)^2 $$\nComparing the two expressions:\n$$ 1 - \\frac{1}{2}\\mu(1 - \\mu)k^2(\\Delta x)^2 = 1 - k^2\\nu_{\\mathrm{num}}\\Delta t $$\nEquating the coefficients of $k^2$:\n$$ \\frac{1}{2}\\mu(1 - \\mu)(\\Delta x)^2 = \\nu_{\\mathrm{num}}\\Delta t $$\nSolving for the numerical diffusion coefficient $\\nu_{\\mathrm{num}}$:\n$$ \\nu_{\\mathrm{num}} = \\frac{(\\Delta x)^2}{2\\Delta t}\\mu(1 - \\mu) $$\nTo express this in terms of $c$, $\\Delta x$, and $\\mu$, we use the definition of $\\mu$ to eliminate $\\Delta t$. From $\\mu = \\frac{c\\Delta t}{\\Delta x}$, we have $\\frac{1}{\\Delta t} = \\frac{c}{\\mu\\Delta x}$.\nSubstituting this into the expression for $\\nu_{\\mathrm{num}}$:\n$$ \\nu_{\\mathrm{num}} = \\frac{(\\Delta x)^2}{2} \\left(\\frac{c}{\\mu\\Delta x}\\right) \\mu(1 - \\mu) $$\n$$ \\nu_{\\mathrm{num}} = \\frac{c\\Delta x}{2\\mu} \\mu(1 - \\mu) = \\frac{c\\Delta x}{2}(1 - \\mu) $$\nThis is the final expression for the equivalent numerical diffusion coefficient.",
            "answer": "$$\\boxed{\\frac{c \\Delta x}{2}(1 - \\mu)}$$"
        }
    ]
}