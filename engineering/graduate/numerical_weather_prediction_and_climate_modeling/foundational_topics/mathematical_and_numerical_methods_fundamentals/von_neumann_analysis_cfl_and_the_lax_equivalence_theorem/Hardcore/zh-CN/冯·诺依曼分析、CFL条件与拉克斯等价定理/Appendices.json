{
    "hands_on_practices": [
        {
            "introduction": "冯·诺依曼分析是检验有限差分格式稳定性的基石。本练习将这一强大的工具应用于一个典型的物理过程——扩散现象，具体来说是针对扩散方程的前向时间中心空间（FTCS）格式 。通过从头推导放大因子 $G(\\theta)$，你将亲手揭示出著名的稳定性条件 $r = \\nu \\Delta t / \\Delta x^{2} \\le 1/2$ 的来源，从而深刻理解抛物型方程的 CFL 条件是如何产生的。",
            "id": "4110334",
            "problem": "在数值天气预报和气候模拟的背景下，一维周期性截面上被动示踪剂的小尺度湍流混合可以通过线性扩散偏微分方程 (PDE) $u_{t} = \\nu u_{xx}$ 进行理想化，其中 $u(x,t)$ 是示踪剂浓度，$t$ 是时间，$x$ 是空间坐标，$\\nu  0$ 是代表亚网格尺度混合的运动学扩散系数。考虑一个空间步长为 $\\Delta x$ 的均匀空间网格和一个显式时间步长 $\\Delta t$。在这个周期性网格上，应用由前向欧拉时间离散化和二阶中心空间离散化定义的前向时间中心空间 (FTCS) 格式。\n\n使用 von Neumann (傅里叶) 分析，假设一个离散傅里叶模式 $u_{j}^{n} = \\hat{u}^{n} \\exp(i j \\theta)$，其中 $j$ 是网格点的索引，$n$ 是时间层的索引，$\\theta = k \\Delta x$ 是无量纲相位，$k$ 是波数，$i$ 是虚数单位。推导离散放大因子 $G(\\theta)$，使得 $\\hat{u}^{n+1} = G(\\theta)\\,\\hat{u}^{n}$，并用 $\\theta$ 和无量纲扩散数 $r = \\nu \\Delta t / \\Delta x^{2}$ 以闭合形式表示 $G(\\theta)$。然后，从 von Neumann 分析下线性稳定性的基本定义出发，并援引 Lax 等价定理（该定理指出，对于线性初值问题，相容性加稳定性意味着收敛性），解释您得到的 $G(\\theta)$ 对显式 FTCS 扩散格式中 $r$ 的 Courant-Friedrichs-Lewy (CFL) 型限制的意义。\n\n以 $r$ 和 $\\theta$ 的显式解析表达式形式提供您的最终答案。不需要进行数值计算。",
            "solution": "问题陈述有效。这是偏微分方程数值分析领域一个标准的、适定的问题，基于已建立的数学原理和物理模型。所有必要信息均已提供，术语精确无歧义。\n\n该问题要求推导和解释一维线性扩散方程的前向时间中心空间 (FTCS) 格式的稳定性。\n\n控制偏微分方程 (PDE) 如下：\n$$\n\\frac{\\partial u}{\\partial t} = \\nu \\frac{\\partial^2 u}{\\partial x^2}\n$$\n其中 $u(x,t)$ 是示踪剂浓度，$t$ 是时间，$x$ 是空间坐标，$\\nu  0$ 是常数运动学扩散系数。\n\n我们被要求在空间步长为 $\\Delta x$ 和时间步长为 $\\Delta t$ 的均匀网格上应用 FTCS 格式。令 $u_j^n$ 表示 $u(j\\Delta x, n\\Delta t)$ 的数值近似。FTCS 格式使用一阶前向差分来离散化时间导数，使用二阶中心差分来离散化空间导数。\n\n时间上的前向差分是：\n$$\n\\frac{\\partial u}{\\partial t} \\bigg|_{j,n} \\approx \\frac{u_j^{n+1} - u_j^n}{\\Delta t}\n$$\n\n空间上的中心差分是：\n$$\n\\frac{\\partial^2 u}{\\partial x^2} \\bigg|_{j,n} \\approx \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\\Delta x)^2}\n$$\n\n将这些近似值代入 PDE，得到 FTCS 格式的有限差分方程：\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = \\nu \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\\Delta x)^2}\n$$\n\n我们可以求解下一个时间步的解 $u_j^{n+1}$：\n$$\nu_j^{n+1} = u_j^n + \\frac{\\nu \\Delta t}{(\\Delta x)^2} (u_{j+1}^n - 2u_j^n + u_{j-1}^n)\n$$\n\n问题将无量纲扩散数定义为 $r = \\nu \\Delta t / (\\Delta x)^2$。将 $r$ 代入方程得到：\n$$\nu_j^{n+1} = u_j^n + r (u_{j+1}^n - 2u_j^n + u_{j-1}^n)\n$$\n\n为了进行 von Neumann 稳定性分析，我们代入给定的离散傅里叶模式 $u_j^n = \\hat{u}^n \\exp(i j \\theta)$，其中 $\\theta = k \\Delta x$ 是无量纲波数。项 $\\hat{u}^n$ 是时间层 $n$ 处傅里叶模式的振幅。关系式 $\\hat{u}^{n+1} = G(\\theta) \\hat{u}^n$ 定义了放大因子 $G(\\theta)$。\n\n将傅里叶模式代入差分方程：\n$$\n\\hat{u}^{n+1} \\exp(i j \\theta) = \\hat{u}^n \\exp(i j \\theta) + r \\left( \\hat{u}^n \\exp(i (j+1) \\theta) - 2 \\hat{u}^n \\exp(i j \\theta) + \\hat{u}^n \\exp(i (j-1) \\theta) \\right)\n$$\n\n我们可以从右侧提取公因式 $\\hat{u}^n \\exp(i j \\theta)$：\n$$\n\\hat{u}^{n+1} \\exp(i j \\theta) = \\hat{u}^n \\exp(i j \\theta) \\left[ 1 + r \\left( \\exp(i \\theta) - 2 + \\exp(-i \\theta) \\right) \\right]\n$$\n\n两边同除以 $\\hat{u}^n \\exp(i j \\theta)$ (非零)，并使用定义 $G(\\theta) = \\hat{u}^{n+1} / \\hat{u}^n$，我们得到放大因子的表达式：\n$$\nG(\\theta) = 1 + r \\left( \\exp(i \\theta) + \\exp(-i \\theta) - 2 \\right)\n$$\n\n使用欧拉恒等式 $\\cos(\\theta) = \\frac{\\exp(i \\theta) + \\exp(-i \\theta)}{2}$，我们有 $\\exp(i \\theta) + \\exp(-i \\theta) = 2 \\cos(\\theta)$。将其代入 $G(\\theta)$ 的表达式，得到所需的以 $r$ 和 $\\theta$ 表示的闭合形式表达式：\n$$\nG(\\theta) = 1 + r(2 \\cos(\\theta) - 2) = 1 + 2r(\\cos(\\theta) - 1)\n$$\n这可以使用半角恒等式 $\\cos(\\theta) - 1 = -2 \\sin^2(\\theta/2)$ 进一步简化，得到 $G(\\theta) = 1 - 4r \\sin^2(\\theta/2)$。然而，所要求的直接结果是 $1 + 2r(\\cos(\\theta) - 1)$ 的形式。\n\n现在，我们解释其对稳定性的影响。von Neumann 分析中线性稳定性的基本定义要求，对于所有可能的波数（即，对于所有 $\\theta$），放大因子的模长必须小于或等于 1：\n$$\n|G(\\theta)| \\le 1 \\quad \\forall \\theta \\in [-\\pi, \\pi]\n$$\n这个条件确保了没有傅里叶模式会在时间上被非物理地放大，否则将导致数值误差的灾难性增长。\n\n由于 $G(\\theta)$ 是纯实数，条件 $|G(\\theta)| \\le 1$ 等价于 $-1 \\le G(\\theta) \\le 1$。\n我们来检查这两个不等式。\n\n1. 上界：$G(\\theta) \\le 1$\n$$\n1 + 2r(\\cos(\\theta) - 1) \\le 1\n$$\n$$\n2r(\\cos(\\theta) - 1) \\le 0\n$$\n由于 $r = \\nu \\Delta t / (\\Delta x)^2  0$ 且项 $(\\cos(\\theta) - 1)$ 总是小于或等于零（因为 $\\cos(\\theta) \\le 1$），它们的乘积总是小于或等于零。因此，这个不等式总是成立的。\n\n2. 下界：$G(\\theta) \\ge -1$\n$$\n1 + 2r(\\cos(\\theta) - 1) \\ge -1\n$$\n$$\n2 \\ge -2r(\\cos(\\theta) - 1)\n$$\n$$\n2 \\ge 2r(1 - \\cos(\\theta))\n$$\n$$\n1 \\ge r(1 - \\cos(\\theta))\n$$\n这个条件必须对所有 $\\theta$ 值成立。为了找到最严格的情况，我们必须最大化项 $r(1 - \\cos(\\theta))$。由于 $r$ 是一个正常数，我们需要最大化 $(1 - \\cos(\\theta))$。该项的最大值为 $2$，出现在 $\\cos(\\theta) = -1$ 时，对应于网格上可表示的最高频率（最短波长），即 $\\theta = \\pi$（所谓的“2-$\\Delta x$”波）。\n\n将这个最严格的情况代入不等式：\n$$\n1 \\ge r(1 - (-1))\n$$\n$$\n1 \\ge 2r\n$$\n$$\nr \\le \\frac{1}{2}\n$$\n\n因此，应用于扩散方程的 FTCS 格式的 CFL 型限制是 $r = \\frac{\\nu \\Delta t}{(\\Delta x)^2} \\le \\frac{1}{2}$。这是一个条件稳定性。时间步长 $\\Delta t$ 受到空间步长平方的限制，即 $\\Delta t \\le \\frac{(\\Delta x)^2}{2\\nu}$。对于高分辨率模型（小 $\\Delta x$），这可能是一个非常严格的限制。\n\n最后，Lax 等价定理指出，对于一个适定的线性初值问题，一个相容的有限差分格式是收敛的，当且仅当它是稳定的。\n- **相容性**：FTCS 格式与扩散方程是相容的，因为其截断误差为 $O(\\Delta t, (\\Delta x)^2)$ 阶，当 $\\Delta t \\to 0$ 和 $\\Delta x \\to 0$ 时，截断误差趋于零。\n- **稳定性**：如前所推导，该格式仅在条件 $r \\le 1/2$ 下稳定。\n因此，根据 Lax 等价定理，只要满足稳定性条件 $r \\le 1/2$，随着网格的细化，FTCS 格式的数值解将收敛于扩散偏微分方程的真解。如果违反此条件，格式将不稳定，数值解将发散，从而变得无用。\n最终答案是推导出的 $G(\\theta)$ 表达式。",
            "answer": "$$\n\\boxed{1 + 2r(\\cos(\\theta) - 1)}\n$$"
        },
        {
            "introduction": "在掌握了扩散方程的基本分析之后，我们将注意力转向在天气和气候模型中至关重要的平流方程。本练习旨在比较两种广泛使用的数值格式：一阶的 Lax-Friedrichs 格式和二阶的 Lax-Wendroff 格式 。通过对这两种格式进行稳定性分析，你不仅能将在上一个练习中学到的技能应用于新的场景，还能体会到数值精度、实现复杂性以及稳定性约束（例如 Courant 数 $r = c\\Delta t / \\Delta x$）之间的权衡。",
            "id": "4110330",
            "problem": "考虑一个数值天气预报 (NWP) 系统的纬向柱状模型中的被动标量 $u(x,t)$ 的线性一维平流方程 $u_{t} + c\\,u_{x} = 0$，其中风速 $c  0$ 是一个常数。设计算域由均匀空间网格 $x_{j} = j\\,\\Delta x$ 和均匀时间步长 $t_{n} = n\\,\\Delta t$ 离散化，Courant–Friedrichs–Lewy (CFL) 数为 $r = \\dfrac{c\\,\\Delta t}{\\Delta x}$。假设在一个足够大的域上采用周期性边界条件，以便傅里叶模式分析有意义。\n\n从与控制方程以及 $u$ 的守恒输运相一致的 $u_{t}$ 和 $u_{x}$ 的有限差分表示出发：\n- 使用一阶时间更新和中心空间表示，并辅以与守恒平均一致的点值的对称最近邻替换，推导通常称为 Lax–Friedrichs 格式的显式最近邻格式公式。\n- 通过将 $u(x_{j}, t_{n} + \\Delta t)$ 在时间上展开到二阶，并使用控制方程消去时间导数，同时用匹配的形式阶的中心差分表示空间导数，推导通常称为 Lax–Wendroff 格式的显式两步时间泰勒格式公式。\n\n对每种格式：\n- 写出得到的格式更新 $u_{j}^{n+1}$ 关于 $u_{j-1}^{n}$、$u_{j}^{n}$ 和 $u_{j+1}^{n}$ 的表达式，并解释在 CFL 标度关系 $\\Delta t = \\lambda\\,\\Delta x$（其中当 $\\Delta x \\to 0$ 时 $\\lambda = \\mathcal{O}(1)$）下，其在时间和空间上的形式精度阶。\n- 通过代入波数为 $\\xi \\in [0, 2\\pi]$ 的拟设 $u_{j}^{n} = \\hat{u}^{n}\\,\\exp(i\\,j\\,\\xi)$，进行 von Neumann (傅里叶模式) 稳定性分析，并计算每种格式的放大因子 $G(\\xi, r)$。\n- 使用 Lax 等价定理（对于线性初值问题，一个相容的线性差分格式是收敛的当且仅当它是稳定的），确定保证两种格式对所有傅里叶模式同时稳定的 $|r|$ 的最紧公共上界。\n\n将最终答案报告为单个数字 $r_{\\max}$，即 $|r|$ 的上确界，使得两种格式对所有波数都是 von Neumann 稳定的。无需四舍五入，答案是无量纲的。将最终答案表示为单个数字。",
            "solution": "问题要求对一维线性平流方程 $u_{t} + c\\,u_{x} = 0$（其中 $c  0$ 是一个常数）的 Lax-Friedrichs 和 Lax-Wendroff 格式进行推导和稳定性分析。最终目标是找到 Courant-Friedrichs-Lewy (CFL) 数 $r = \\frac{c\\,\\Delta t}{\\Delta x}$ 的最紧公共上界，以确保两种格式都稳定。\n\n我们将分别分析每种格式，然后综合结果。对于两种格式，我们都使用离散化 $u(x_j, t_n) \\approx u_j^n$，其中 $x_j = j\\,\\Delta x$ 且 $t_n = n\\,\\Delta t$。\n\n### Lax–Friedrichs 格式\n\n**1. 推导与格式公式**\n问题指导我们使用一阶时间更新（向前欧拉法）、$u_x$ 的中心空间表示以及对项 $u_j^n$ 的特定替换来推导该格式。\n一个简单的时间向前中心差分 (FTCS) 离散化是：\n$$ \\frac{u_j^{n+1} - u_j^n}{\\Delta t} + c \\frac{u_{j+1}^n - u_{j-1}^n}{2\\Delta x} = 0 $$\nLax-Friedrichs 格式对此进行了修改，将点值 $u_j^n$ 替换为其在最近邻上的守恒平均值 $u_j^n \\to \\frac{1}{2}(u_{j+1}^n + u_{j-1}^n)$。应用此修改，我们得到：\n$$ \\frac{u_j^{n+1} - \\frac{1}{2}(u_{j+1}^n + u_{j-1}^n)}{\\Delta t} + c \\frac{u_{j+1}^n - u_{j-1}^n}{2\\Delta x} = 0 $$\n求解 $u_j^{n+1}$：\n$$ u_j^{n+1} = \\frac{1}{2}(u_{j+1}^n + u_{j-1}^n) - \\frac{c\\,\\Delta t}{2\\Delta x}(u_{j+1}^n - u_{j-1}^n) $$\n代入 CFL 数 $r = \\frac{c\\,\\Delta t}{\\Delta x}$：\n$$ u_j^{n+1} = \\frac{1}{2}(u_{j+1}^n + u_{j-1}^n) - \\frac{r}{2}(u_{j+1}^n - u_{j-1}^n) $$\n在 n 时刻层，按空间索引对各项进行分组：\n$$ u_j^{n+1} = \\left(\\frac{1}{2} + \\frac{r}{2}\\right)u_{j-1}^n + 0 \\cdot u_j^n + \\left(\\frac{1}{2} - \\frac{r}{2}\\right)u_{j+1}^n $$\n这就是 Lax-Friedrichs 格式的格式更新公式。\n\n**2. 精度阶**\n为确定形式精度阶，我们对格式的各项在点 $(x_j, t_n)$ 附近进行泰勒级数展开。\n$$ u_{j \\pm 1}^n = u \\pm \\Delta x u_x + \\frac{\\Delta x^2}{2} u_{xx} \\pm \\frac{\\Delta x^3}{6} u_{xxx} + \\mathcal{O}(\\Delta x^4) $$\n$$ u_j^{n+1} = u + \\Delta t u_t + \\frac{\\Delta t^2}{2} u_{tt} + \\mathcal{O}(\\Delta t^3) $$\n将这些代入格式 $\\frac{u_j^{n+1} - \\frac{1}{2}(u_{j+1}^n + u_{j-1}^n)}{\\Delta t} + c \\frac{u_{j+1}^n - u_{j-1}^n}{2\\Delta x} = 0$，我们得到：\n$$ \\frac{(u + \\Delta t u_t + \\dots) - (u + \\frac{\\Delta x^2}{2}u_{xx} + \\dots)}{\\Delta t} + c(u_x + \\frac{\\Delta x^2}{6}u_{xxx} + \\dots) = 0 $$\n$$ u_t - \\frac{\\Delta x^2}{2\\Delta t}u_{xx} + c u_x + \\mathcal{O}(\\Delta t, \\Delta x^2) = 0 $$\n重新整理后，我们发现该格式实际求解的修正方程是：\n$$ u_t + c u_x = \\frac{\\Delta x^2}{2\\Delta t}u_{xx} + \\mathcal{O}(\\Delta t, \\Delta x^2) $$\n截断误差的首项是 $\\mathcal{O}(\\frac{\\Delta x^2}{\\Delta t})$。在 CFL 标度关系 $\\Delta t = \\lambda \\Delta x$（其中 $\\lambda = \\mathcal{O}(1)$）下，截断误差为 $\\mathcal{O}(\\Delta x)$。因此，Lax-Friedrichs 格式在时间和空间上都是一阶精度的。\n\n**3. von Neumann 稳定性分析**\n我们将傅里叶模式拟设 $u_j^n = \\hat{u}^n e^{i j \\xi}$ 代入格式公式，其中 $\\xi = k_x \\Delta x$ 是无量纲波数。放大因子为 $G(\\xi, r) = \\hat{u}^{n+1}/\\hat{u}^n$。\n$$ G e^{ij\\xi} = \\frac{1+r}{2} e^{i(j-1)\\xi} + \\frac{1-r}{2} e^{i(j+1)\\xi} $$\n两边同除以 $e^{ij\\xi}$：\n$$ G_{LF}(\\xi, r) = \\frac{1+r}{2} e^{-i\\xi} + \\frac{1-r}{2} e^{i\\xi} $$\n$$ G_{LF}(\\xi, r) = \\frac{1}{2}(e^{i\\xi} + e^{-i\\xi}) - \\frac{r}{2}(e^{i\\xi} - e^{-i\\xi}) $$\n使用欧拉公式 $e^{\\pm i\\xi} = \\cos(\\xi) \\pm i\\sin(\\xi)$：\n$$ G_{LF}(\\xi, r) = \\cos(\\xi) - i r \\sin(\\xi) $$\n为保证稳定性，我们要求对所有 $\\xi$ 都有 $|G_{LF}(\\xi, r)| \\le 1$。模的平方为：\n$$ |G_{LF}|^2 = (\\cos(\\xi))^2 + (-r \\sin(\\xi))^2 = \\cos^2(\\xi) + r^2 \\sin^2(\\xi) $$\n稳定性条件是 $\\cos^2(\\xi) + r^2 \\sin^2(\\xi) \\le 1$。由于 $\\cos^2(\\xi) = 1 - \\sin^2(\\xi)$：\n$$ 1 - \\sin^2(\\xi) + r^2 \\sin^2(\\xi) \\le 1 $$\n$$ (r^2 - 1)\\sin^2(\\xi) \\le 0 $$\n由于 $\\sin^2(\\xi) \\ge 0$，该不等式对所有 $\\xi$ 成立的充要条件是 $r^2 - 1 \\le 0$，即 $r^2 \\le 1$。\nLax-Friedrichs 格式的稳定性条件是 $|r| \\le 1$。\n\n### Lax–Wendroff 格式\n\n**1. 推导与格式公式**\n我们从 $u(x, t)$ 在时间上的二阶泰勒级数展开开始：\n$$ u(x, t+\\Delta t) = u(x,t) + \\Delta t u_t + \\frac{\\Delta t^2}{2} u_{tt} + \\mathcal{O}(\\Delta t^3) $$\n从控制方程 $u_t = -c u_x$ 出发，我们求二阶时间导数：\n$$ u_{tt} = \\frac{\\partial}{\\partial t}(-c u_x) = -c \\frac{\\partial}{\\partial x}(u_t) = -c \\frac{\\partial}{\\partial x}(-c u_x) = c^2 u_{xx} $$\n将 $u_t$ 和 $u_{tt}$ 代入泰勒展开式：\n$$ u(x, t+\\Delta t) = u(x,t) - c \\Delta t u_x + \\frac{c^2 \\Delta t^2}{2} u_{xx} + \\mathcal{O}(\\Delta t^3) $$\n现在，我们使用二阶中心差分来表示空间导数，从而在点 $(x_j, t_n)$ 处离散化该方程：\n$$ u_x \\approx \\frac{u_{j+1}^n - u_{j-1}^n}{2\\Delta x}, \\quad u_{xx} \\approx \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{\\Delta x^2} $$\n将这些代入离散化的泰勒展开式，得到 Lax-Wendroff 格式：\n$$ u_j^{n+1} = u_j^n - c \\Delta t \\left(\\frac{u_{j+1}^n - u_{j-1}^n}{2\\Delta x}\\right) + \\frac{c^2 \\Delta t^2}{2} \\left(\\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{\\Delta x^2}\\right) $$\n使用 CFL 数 $r = \\frac{c \\Delta t}{\\Delta x}$：\n$$ u_j^{n+1} = u_j^n - \\frac{r}{2}(u_{j+1}^n - u_{j-1}^n) + \\frac{r^2}{2}(u_{j+1}^n - 2u_j^n + u_{j-1}^n) $$\n按空间索引分组项：\n$$ u_j^{n+1} = \\left(\\frac{r}{2} + \\frac{r^2}{2}\\right)u_{j-1}^n + (1 - r^2)u_j^n + \\left(-\\frac{r}{2} + \\frac{r^2}{2}\\right)u_{j+1}^n $$\n格式更新公式为 $u_j^{n+1} = \\frac{r(r+1)}{2}u_{j-1}^n + (1-r^2)u_j^n + \\frac{r(r-1)}{2}u_{j+1}^n$。\n\n**2. 精度阶**\n推导过程本身表明，该格式近似偏微分方程的误差来自时间展开的 $\\mathcal{O}(\\Delta t^3)$ 和空间离散化的 $\\mathcal{O}(\\Delta t \\Delta x^2)$。具体而言，局部截断误差的首项是 $\\frac{c \\Delta t \\Delta x^2}{6}(1-r^2)u_{xxx}$。在标度关系 $\\Delta t = \\lambda \\Delta x$ 下，此误差为 $\\mathcal{O}(\\Delta x^3)$。该格式是二阶精度的，即 $\\mathcal{O}(\\Delta t^2, \\Delta x^2)$。\n\n**3. von Neumann 稳定性分析**\n我们将拟设 $u_j^n = G^n e^{i j \\xi}$ 代入格式表达式：\n$$ G = 1 - \\frac{r}{2}(e^{i\\xi} - e^{-i\\xi}) + \\frac{r^2}{2}(e^{i\\xi} - 2 + e^{-i\\xi}) $$\n$$ G_{LW}(\\xi, r) = 1 - \\frac{r}{2}(2i\\sin(\\xi)) + \\frac{r^2}{2}(2\\cos(\\xi) - 2) = 1 - i r \\sin(\\xi) + r^2(\\cos(\\xi) - 1) $$\n为了求模，我们计算 $|G_{LW}|^2$：\n$$ |G_{LW}|^2 = (1 + r^2(\\cos(\\xi)-1))^2 + (-r\\sin(\\xi))^2 $$\n$$ |G_{LW}|^2 = 1 + 2r^2(\\cos(\\xi)-1) + r^4(\\cos(\\xi)-1)^2 + r^2\\sin^2(\\xi) $$\n使用 $1 - \\cos\\xi = 2\\sin^2(\\xi/2)$ 将其展开为：\n$$ |G_{LW}|^2 = 1 - 4r^2\\sin^2(\\frac{\\xi}{2}) + 4r^4\\sin^4(\\frac{\\xi}{2}) + 4r^2\\sin^2(\\frac{\\xi}{2})\\cos^2(\\frac{\\xi}{2}) $$\n$$ |G_{LW}|^2 = 1 - 4r^2\\sin^2(\\frac{\\xi}{2}) + 4r^4\\sin^4(\\frac{\\xi}{2}) + 4r^2\\sin^2(\\frac{\\xi}{2})(1-\\sin^2(\\frac{\\xi}{2})) $$\n$$ |G_{LW}|^2 = 1 - 4r^2\\sin^2(\\frac{\\xi}{2}) + 4r^4\\sin^4(\\frac{\\xi}{2}) + 4r^2\\sin^2(\\frac{\\xi}{2}) - 4r^2\\sin^4(\\frac{\\xi}{2}) $$\n$$ |G_{LW}|^2 = 1 + (4r^4 - 4r^2)\\sin^4(\\frac{\\xi}{2}) = 1 - 4r^2(1-r^2)\\sin^4(\\frac{\\xi}{2}) $$\n为保证稳定性，需满足 $|G_{LW}|^2 \\le 1$，这要求：\n$$ -4r^2(1-r^2)\\sin^4(\\frac{\\xi}{2}) \\le 0 $$\n由于 $r^2 \\ge 0$ 且 $\\sin^4(\\xi/2) \\ge 0$，该条件对所有 $\\xi$ 成立的充要条件是 $1-r^2 \\ge 0$，即 $r^2 \\le 1$。\nLax-Wendroff 格式的稳定性条件是 $|r| \\le 1$。\n\n### 公共稳定性界\n\n根据 Lax 等价定理，对于这些相容的线性格式，稳定性是收敛的充要条件。\n- 对 Lax-Friedrichs 格式的 von Neumann 稳定性分析得出的条件是 $|r| \\le 1$。\n- 对 Lax-Wendroff 格式的 von Neumann 稳定性分析得出的条件是 $|r| \\le 1$。\n\n两种格式都是稳定的，当且仅当 CFL 数 $r$ 满足 $|r| \\le 1$。两种格式同时稳定的取值集合是它们各自稳定区域的交集，在本例中即为区间 $[-1, 1]$。\n\n$|r|$ 的最紧公共上界是 $|r|$ 在此公共稳定区域上的上确界。因此，上确界是 1。\n令 $r_{\\max} = \\sup \\{ |r| : |r| \\le 1 \\}$。这得到 $r_{\\max} = 1$。",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "一个稳定的格式能够保证收敛，但这并不意味着它能完美地再现真实的物理过程。本练习将带领你超越简单的稳定性判断，深入探究解的质量，具体任务是分析 Lax-Wendroff 格式的相位误差 。这个高级练习揭示了一种更为微妙的数值效应——色散误差，即不同波长的波会以不正确的速度传播，这对于精确模拟大气和海洋中的波动现象至关重要。",
            "id": "4110305",
            "problem": "在数值天气预报和气候模拟中，被动示踪物的一维线性平流是输运过程的一个典型组成部分。\n\n考虑在具有空间步长 $\\Delta x$ 和时间步长 $\\Delta t$ 的均匀网格上，满足周期性边界条件的平流方程 $u_{t} + c\\,u_{x} = 0$，其中波速 $c$ 为常数。Courant–Friedrichs–Lewy (CFL) 数定义为 $\\mu = c\\,\\Delta t / \\Delta x$。\n\n从时间的二阶泰勒展开出发，并用中心有限差分替换空间导数，为该方程构建 Lax–Wendroff 格式。通过假设一个离散傅里叶模 $u_{j}^{n} = \\hat{u}^{n}\\,\\exp(i\\,j\\,\\theta)$（其中 $\\theta = k\\,\\Delta x$ 是无量纲波数，$j$ 是网格点的索引）来进行傅里叶（von Neumann）稳定性分析。推导离散放大因子 $G(\\theta)$，并用 $\\mu$ 和 $\\theta$ 表示。\n\n通过将数值放大因子与连续方程的精确傅里叶放大进行比较，确定每个时间步的主阶相位误差，该误差是关于 $\\mu$ 和 $\\theta$ 的解析函数。您的最终答案必须是给出主阶相位误差的单个闭式表达式，用 $\\mu$ 和 $\\theta$ 表示。不需要四舍五入，最终答案中不应包含物理单位。",
            "solution": "本题要求推导应用于一维线性平流方程 $u_{t} + c\\,u_{x} = 0$ 的 Lax-Wendroff 数值格式的主阶相位误差。\n\n首先，我们构建 Lax-Wendroff 格式。我们从解 $u(x,t)$ 在时间上对 $t$ 的二阶泰勒级数展开开始：\n$$u(x, t+\\Delta t) = u(x,t) + \\Delta t \\, u_{t}(x,t) + \\frac{(\\Delta t)^2}{2} u_{tt}(x,t) + O((\\Delta t)^3)$$\n根据控制偏微分方程，$u_t = -c u_x$。我们可以通过对偏微分方程关于时间求导来找到二阶时间导数，假设 $c$ 是常数：\n$$u_{tt} = \\frac{\\partial}{\\partial t}(-c u_x) = -c \\frac{\\partial u_x}{\\partial t} = -c \\frac{\\partial u_t}{\\partial x}$$\n再次代入 $u_t = -c u_x$，我们得到：\n$$u_{tt} = -c \\frac{\\partial}{\\partial x}(-c u_x) = c^2 u_{xx}$$\n将 $u_t$ 和 $u_{tt}$ 的表达式代回泰勒展开式得到：\n$$u(x, t+\\Delta t) = u(x,t) - c\\,\\Delta t\\,u_x + \\frac{(c\\,\\Delta t)^2}{2} u_{xx} + O((\\Delta t)^3)$$\n现在，我们在均匀网格上离散化该方程，其中 $x_j = j\\,\\Delta x$ 且 $t_n = n\\,\\Delta t$。令 $u_j^n \\approx u(x_j, t_n)$。我们使用二阶中心有限差分来近似空间导数：\n$$u_x(x_j, t_n) \\approx \\frac{u_{j+1}^n - u_{j-1}^n}{2\\,\\Delta x}$$\n$$u_{xx}(x_j, t_n) \\approx \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\\Delta x)^2}$$\n将这些离散化代入时间展开方程，得到数值格式：\n$$u_j^{n+1} = u_j^n - c\\,\\Delta t \\left( \\frac{u_{j+1}^n - u_{j-1}^n}{2\\,\\Delta x} \\right) + \\frac{(c\\,\\Delta t)^2}{2} \\left( \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\\Delta x)^2} \\right)$$\n引入 Courant–Friedrichs–Lewy (CFL) 数 $\\mu = \\frac{c\\,\\Delta t}{\\Delta x}$，我们可以将格式写得更紧凑：\n$$u_j^{n+1} = u_j^n - \\frac{\\mu}{2}(u_{j+1}^n - u_{j-1}^n) + \\frac{\\mu^2}{2}(u_{j+1}^n - 2u_j^n + u_{j-1}^n)$$\n这就是 Lax-Wendroff 格式。\n\n接下来，我们进行 von Neumann 稳定性分析来求放大因子。我们将离散傅里叶模 $u_j^n = \\hat{u}^n \\exp(i\\,j\\,\\theta)$ 代入格式中，其中 $\\theta = k\\,\\Delta x$ 是无量纲波数。下一个时间步的解是 $u_j^{n+1} = G(\\theta)\\,\\hat{u}^n \\exp(i\\,j\\,\\theta)$，其中 $G(\\theta)$ 是放大因子。\n$$G\\,\\hat{u}^n e^{ij\\theta} = \\hat{u}^n e^{ij\\theta} - \\frac{\\mu}{2}(\\hat{u}^n e^{i(j+1)\\theta} - \\hat{u}^n e^{i(j-1)\\theta}) + \\frac{\\mu^2}{2}(\\hat{u}^n e^{i(j+1)\\theta} - 2\\hat{u}^n e^{ij\\theta} + \\hat{u}^n e^{i(j-1)\\theta})$$\n两边同除以 $\\hat{u}^n e^{ij\\theta}$：\n$$G(\\theta) = 1 - \\frac{\\mu}{2}(e^{i\\theta} - e^{-i\\theta}) + \\frac{\\mu^2}{2}(e^{i\\theta} - 2 + e^{-i\\theta})$$\n使用恒等式 $e^{i\\theta} - e^{-i\\theta} = 2i\\sin\\theta$ 和 $e^{i\\theta} + e^{-i\\theta} = 2\\cos\\theta$：\n$$G(\\theta) = 1 - \\frac{\\mu}{2}(2i\\sin\\theta) + \\frac{\\mu^2}{2}(2\\cos\\theta - 2) = 1 - i\\mu\\sin\\theta + \\mu^2(\\cos\\theta - 1)$$\n这是 Lax-Wendroff 格式的离散放大因子。\n\n现在我们将其与精确放大因子进行比较。对于初始条件 $u(x,0) = \\exp(ikx)$，方程 $u_t + c u_x = 0$ 的精确解是 $u(x,t) = \\exp(ik(x-ct))$。在一个时间步长 $\\Delta t$ 内的放大是：\n$$G_{exact} = \\frac{u(x, t+\\Delta t)}{u(x,t)} = \\frac{\\exp(ik(x-c(t+\\Delta t)))}{\\exp(ik(x-ct))} = \\exp(-ikc\\Delta t)$$\n代入 $k = \\theta/\\Delta x$ 和 $c\\Delta t = \\mu\\Delta x$：\n$$G_{exact} = \\exp\\left(-i\\,\\frac{\\theta}{\\Delta x}\\,\\mu\\,\\Delta x\\right) = \\exp(-i\\mu\\theta)$$\n精确解是一个纯相位移动，其模 $|G_{exact}| = 1$。每个时间步的精确相变是 $\\phi_{exact} = \\arg(G_{exact}) = -\\mu\\theta$。\n\n每个时间步的相位误差是 $\\Delta\\phi = \\phi_{num} - \\phi_{exact}$，其中 $\\phi_{num} = \\arg(G(\\theta))$。该误差也由数值放大因子与精确放大因子之比的辐角给出：\n$$\\Delta\\phi = \\arg\\left(\\frac{G(\\theta)}{G_{exact}}\\right) = \\arg(G(\\theta) \\exp(i\\mu\\theta))$$\n为了找到主阶相位误差，我们将 $G(\\theta)$ 和 $\\exp(i\\mu\\theta)$ 在 $\\theta$ 很小时展开为泰勒级数：\n$$\\sin\\theta = \\theta - \\frac{\\theta^3}{6} + O(\\theta^5)$$\n$$\\cos\\theta - 1 = -\\frac{\\theta^2}{2} + \\frac{\\theta^4}{24} + O(\\theta^6)$$\n代入 $G(\\theta)$：\n$$G(\\theta) = 1 - i\\mu\\left(\\theta - \\frac{\\theta^3}{6} + \\dots\\right) + \\mu^2\\left(-\\frac{\\theta^2}{2} + \\frac{\\theta^4}{24} + \\dots\\right)$$\n$$G(\\theta) = 1 - i\\mu\\theta - \\frac{\\mu^2\\theta^2}{2} + i\\frac{\\mu\\theta^3}{6} + O(\\theta^4)$$\n$\\exp(i\\mu\\theta)$ 的展开式为：\n$$\\exp(i\\mu\\theta) = 1 + i\\mu\\theta - \\frac{(\\mu\\theta)^2}{2} - i\\frac{(\\mu\\theta)^3}{6} + O(\\theta^4)$$\n现在，我们计算乘积 $G(\\theta)\\exp(i\\mu\\theta)$：\n$$G(\\theta)\\exp(i\\mu\\theta) = \\left(1 - i\\mu\\theta - \\frac{\\mu^2\\theta^2}{2} + i\\frac{\\mu\\theta^3}{6} + \\dots\\right) \\left(1 + i\\mu\\theta - \\frac{\\mu^2\\theta^2}{2} - i\\frac{\\mu^3\\theta^3}{6} + \\dots\\right)$$\n我们按 $\\theta$ 的阶数收集各项：\n-   常数项：$1 \\times 1 = 1$。\n-   $\\theta^1$ 项：$1 \\times (i\\mu\\theta) + (-i\\mu\\theta) \\times 1 = 0$。\n-   $\\theta^2$ 项：$1 \\times (-\\frac{\\mu^2\\theta^2}{2}) + (-i\\mu\\theta) \\times (i\\mu\\theta) + (-\\frac{\\mu^2\\theta^2}{2}) \\times 1 = -\\frac{\\mu^2\\theta^2}{2} + \\mu^2\\theta^2 - \\frac{\\mu^2\\theta^2}{2} = 0$。\n$\\theta^1$ 和 $\\theta^2$ 项的抵消证实了该格式是二阶精度的。主误差项的阶数将是 $\\theta^3$。\n-   $\\theta^3$ 项（只收集虚部，因为实部将是更高阶的）：\n$$1 \\times \\left(-i\\frac{\\mu^3\\theta^3}{6}\\right) + (-i\\mu\\theta) \\times \\left(-\\frac{\\mu^2\\theta^2}{2}\\right) + \\left(-\\frac{\\mu^2\\theta^2}{2}\\right) \\times (i\\mu\\theta) + \\left(i\\frac{\\mu\\theta^3}{6}\\right) \\times 1$$\n$$= i\\theta^3 \\left(-\\frac{\\mu^3}{6} + \\frac{\\mu^3}{2} - \\frac{\\mu^3}{2} + \\frac{\\mu}{6}\\right) = i\\theta^3 \\left(\\frac{\\mu - \\mu^3}{6}\\right) = i\\frac{\\mu(1-\\mu^2)}{6}\\theta^3$$\n所以，对于小的 $\\theta$：\n$$\\frac{G(\\theta)}{G_{exact}} \\approx 1 + i\\frac{\\mu(1-\\mu^2)}{6}\\theta^3$$\n对于一个复数 $z = 1 + iy$，其中 $y \\ll 1$，其辐角为 $\\arg(z) \\approx \\arctan(y) \\approx y$。因此，主阶相位误差是：\n$$\\Delta\\phi \\approx \\frac{\\mu(1-\\mu^2)}{6}\\theta^3$$\n这个表达式表示 Lax-Wendroff 格式每个时间步的主阶相位误差。",
            "answer": "$$\\boxed{\\frac{\\mu(1-\\mu^2)}{6}\\theta^3}$$"
        }
    ]
}