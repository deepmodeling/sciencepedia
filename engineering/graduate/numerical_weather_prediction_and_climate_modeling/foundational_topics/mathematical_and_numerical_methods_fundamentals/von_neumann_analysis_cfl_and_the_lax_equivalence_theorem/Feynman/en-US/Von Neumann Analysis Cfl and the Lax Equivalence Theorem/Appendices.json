{
    "hands_on_practices": [
        {
            "introduction": "We begin with a foundational application of numerical analysis to a physical process. The diffusion equation is a canonical model for turbulent mixing, and understanding how to discretize it stably is a crucial skill. This exercise will guide you through the application of Von Neumann stability analysis to the Forward-Time Centered-Space (FTCS) scheme, a classic method whose stability is not guaranteed. By deriving the amplification factor, you will uncover the famous Courant–Friedrichs–Lewy (CFL) condition for this parabolic problem, providing a concrete link between the time step, grid spacing, and the physical diffusivity of the system .",
            "id": "4110334",
            "problem": "In the context of numerical weather prediction and climate modeling, small-scale turbulent mixing of a passive tracer along a one-dimensional periodic section can be idealized by the linear diffusion Partial Differential Equation (PDE) $u_{t} = \\nu u_{xx}$, where $u(x,t)$ is the tracer concentration, $t$ is time, $x$ is the spatial coordinate, and $\\nu > 0$ is the kinematic diffusion coefficient representing subgrid-scale mixing. Consider a uniform spatial grid of spacing $\\Delta x$ and an explicit time step $\\Delta t$. Apply the Forward-Time Centered-Space (FTCS) scheme, defined by a forward Euler time discretization and a second-order centered spatial discretization, on this periodic grid.\n\nUsing von Neumann (Fourier) analysis, assume a discrete Fourier mode $u_{j}^{n} = \\hat{u}^{n} \\exp(i j \\theta)$, where $j$ indexes grid points, $n$ indexes time levels, $\\theta = k \\Delta x$ is the nondimensional phase with $k$ the wavenumber, and $i$ is the imaginary unit. Derive the discrete amplification factor $G(\\theta)$ such that $\\hat{u}^{n+1} = G(\\theta)\\,\\hat{u}^{n}$ and express $G(\\theta)$ in closed form in terms of $\\theta$ and the nondimensional diffusion number $r = \\nu \\Delta t / \\Delta x^{2}$. Then, starting from the fundamental definition of linear stability under von Neumann analysis and invoking the Lax equivalence theorem (which states that for linear initial value problems, consistency plus stability implies convergence), interpret the implications of your $G(\\theta)$ for the Courant-Friedrichs-Lewy (CFL) type restriction on $r$ for the explicit FTCS diffusion scheme.\n\nProvide your final answer as the explicit analytical expression for $G(\\theta)$ in terms of $r$ and $\\theta$. No numerical evaluation is required.",
            "solution": "The problem statement is found to be valid. It is a standard, well-posed problem in the field of numerical analysis of partial differential equations, grounded in established mathematical principles and physical models. All necessary information is provided, and the terminology is precise and unambiguous.\n\nThe problem requires the derivation and interpretation of the stability of the Forward-Time Centered-Space (FTCS) scheme for the one-dimensional linear diffusion equation.\n\nThe governing Partial Differential Equation (PDE) is given by:\n$$\n\\frac{\\partial u}{\\partial t} = \\nu \\frac{\\partial^2 u}{\\partial x^2}\n$$\nwhere $u(x,t)$ is the tracer concentration, $t$ is time, $x$ is the spatial coordinate, and $\\nu > 0$ is the constant kinematic diffusion coefficient.\n\nWe are instructed to apply the FTCS scheme on a uniform grid with spatial step $\\Delta x$ and time step $\\Delta t$. Let $u_j^n$ represent the numerical approximation of $u(j\\Delta x, n\\Delta t)$. The FTCS scheme discretizes the time derivative using a first-order forward difference and the spatial derivative using a second-order centered difference.\n\nThe forward difference in time is:\n$$\n\\frac{\\partial u}{\\partial t} \\bigg|_{j,n} \\approx \\frac{u_j^{n+1} - u_j^n}{\\Delta t}\n$$\n\nThe centered difference in space is:\n$$\n\\frac{\\partial^2 u}{\\partial x^2} \\bigg|_{j,n} \\approx \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\\Delta x)^2}\n$$\n\nSubstituting these approximations into the PDE yields the finite difference equation for the FTCS scheme:\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = \\nu \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\\Delta x)^2}\n$$\n\nWe can solve for the solution at the next time step, $u_j^{n+1}$:\n$$\nu_j^{n+1} = u_j^n + \\frac{\\nu \\Delta t}{(\\Delta x)^2} (u_{j+1}^n - 2u_j^n + u_{j-1}^n)\n$$\n\nThe problem defines the nondimensional diffusion number as $r = \\nu \\Delta t / (\\Delta x)^2$. Substituting $r$ into the equation gives:\n$$\nu_j^{n+1} = u_j^n + r (u_{j+1}^n - 2u_j^n + u_{j-1}^n)\n$$\n\nTo perform the von Neumann stability analysis, we substitute the given discrete Fourier mode, $u_j^n = \\hat{u}^n \\exp(i j \\theta)$, where $\\theta = k \\Delta x$ is the nondimensional wavenumber. The term $\\hat{u}^n$ is the amplitude of the Fourier mode at time level $n$. The relation $\\hat{u}^{n+1} = G(\\theta) \\hat{u}^n$ defines the amplification factor $G(\\theta)$.\n\nSubstituting the Fourier mode into the difference equation:\n$$\n\\hat{u}^{n+1} \\exp(i j \\theta) = \\hat{u}^n \\exp(i j \\theta) + r \\left( \\hat{u}^n \\exp(i (j+1) \\theta) - 2 \\hat{u}^n \\exp(i j \\theta) + \\hat{u}^n \\exp(i (j-1) \\theta) \\right)\n$$\n\nWe can factor out the common term $\\hat{u}^n \\exp(i j \\theta)$ from the right-hand side:\n$$\n\\hat{u}^{n+1} \\exp(i j \\theta) = \\hat{u}^n \\exp(i j \\theta) \\left[ 1 + r \\left( \\exp(i \\theta) - 2 + \\exp(-i \\theta) \\right) \\right]\n$$\n\nDividing both sides by $\\hat{u}^n \\exp(i j \\theta)$ (which is non-zero) and using the definition $G(\\theta) = \\hat{u}^{n+1} / \\hat{u}^n$, we obtain the expression for the amplification factor:\n$$\nG(\\theta) = 1 + r \\left( \\exp(i \\theta) + \\exp(-i \\theta) - 2 \\right)\n$$\n\nUsing Euler's identity, $\\cos(\\theta) = \\frac{\\exp(i \\theta) + \\exp(-i \\theta)}{2}$, we have $\\exp(i \\theta) + \\exp(-i \\theta) = 2 \\cos(\\theta)$. Substituting this into the expression for $G(\\theta)$ yields the desired closed-form expression in terms of $r$ and $\\theta$:\n$$\nG(\\theta) = 1 + r(2 \\cos(\\theta) - 2) = 1 + 2r(\\cos(\\theta) - 1)\n$$\nThis can be further simplified using the half-angle identity $\\cos(\\theta) - 1 = -2 \\sin^2(\\theta/2)$, which gives $G(\\theta) = 1 - 4r \\sin^2(\\theta/2)$. However, the form $1 + 2r(\\cos(\\theta) - 1)$ is the direct result requested.\n\nNow, we interpret the implications for stability. The fundamental definition of linear stability in von Neumann analysis requires that the magnitude of the amplification factor be less than or equal to one for all possible wavenumbers (i.e., for all $\\theta$):\n$$\n|G(\\theta)| \\le 1 \\quad \\forall \\theta \\in [-\\pi, \\pi]\n$$\nThis condition ensures that no Fourier mode will be unphysically amplified in time, which would lead to a catastrophic growth of numerical error.\n\nSince $G(\\theta)$ is purely real, the condition $|G(\\theta)| \\le 1$ is equivalent to $-1 \\le G(\\theta) \\le 1$.\nLet's check these two inequalities.\n\n1. The upper bound: $G(\\theta) \\le 1$\n$$\n1 + 2r(\\cos(\\theta) - 1) \\le 1\n$$\n$$\n2r(\\cos(\\theta) - 1) \\le 0\n$$\nSince $r = \\nu \\Delta t / (\\Delta x)^2 > 0$ and the term $(\\cos(\\theta) - 1)$ is always less than or equal to zero (as $\\cos(\\theta) \\le 1$), their product is always less than or equal to zero. Thus, this inequality is always satisfied.\n\n2. The lower bound: $G(\\theta) \\ge -1$\n$$\n1 + 2r(\\cos(\\theta) - 1) \\ge -1\n$$\n$$\n2 \\ge -2r(\\cos(\\theta) - 1)\n$$\n$$\n2 \\ge 2r(1 - \\cos(\\theta))\n$$\n$$\n1 \\ge r(1 - \\cos(\\theta))\n$$\nThis condition must hold for all values of $\\theta$. To find the most restrictive case, we must maximize the term $r(1 - \\cos(\\theta))$. Since $r$ is a positive constant, we need to maximize $(1 - \\cos(\\theta))$. The maximum value of this term is $2$, which occurs when $\\cos(\\theta) = -1$, corresponding to the highest frequency (shortest wavelength) representable on the grid, $\\theta = \\pi$ (the so-called \"2-$\\Delta x$\" wave).\n\nSubstituting this most restrictive case into the inequality:\n$$\n1 \\ge r(1 - (-1))\n$$\n$$\n1 \\ge 2r\n$$\n$$\nr \\le \\frac{1}{2}\n$$\n\nThus, the CFL-type restriction for the FTCS scheme applied to the diffusion equation is $r = \\frac{\\nu \\Delta t}{(\\Delta x)^2} \\le \\frac{1}{2}$. This is a condition of conditional stability. The time step $\\Delta t$ is constrained by the square of the spatial step, $\\Delta t \\le \\frac{(\\Delta x)^2}{2\\nu}$. This can be a very severe restriction for high-resolution models (small $\\Delta x$).\n\nFinally, the Lax equivalence theorem states that for a well-posed linear initial value problem, a consistent finite difference scheme is convergent if and only if it is stable.\n- **Consistency**: The FTCS scheme is consistent with the diffusion equation because its truncation error, which is of order $O(\\Delta t, (\\Delta x)^2)$, goes to zero as $\\Delta t \\to 0$ and $\\Delta x \\to 0$.\n- **Stability**: As derived, the scheme is stable only under the condition $r \\le 1/2$.\nTherefore, by the Lax equivalence theorem, the numerical solution from the FTCS scheme will converge to the true solution of the diffusion PDE as the grid is refined, provided that the stability condition $r \\le 1/2$ is satisfied. If this condition is violated, the scheme is unstable, and the numerical solution will diverge, rendering it useless.\nThe final answer is the derived expression for $G(\\theta)$.",
            "answer": "$$\n\\boxed{1 + 2r(\\cos(\\theta) - 1)}\n$$"
        },
        {
            "introduction": "While diffusion smooths gradients, advection transports properties without change, presenting a different numerical challenge. This practice shifts our focus to the linear advection equation, a cornerstone of transport modules in weather and climate models. You will derive and compare two fundamental explicit schemes, Lax-Friedrichs and Lax-Wendroff, uncovering how their construction impacts their order of accuracy and stability. This comparative analysis is essential for appreciating the design trade-offs inherent in numerical methods and provides a practical context for the Lax Equivalence Theorem, which links stability and consistency to the ultimate goal of a convergent solution .",
            "id": "4110330",
            "problem": "Consider the linear one-dimensional advection equation $u_{t} + c\\,u_{x} = 0$ for a passive scalar $u(x,t)$ in a zonal column model of a Numerical Weather Prediction (NWP) system, where the wind speed $c > 0$ is constant. Let the computational domain be discretized by a uniform spatial mesh $x_{j} = j\\,\\Delta x$ and a uniform time step $t_{n} = n\\,\\Delta t$, with the Courant–Friedrichs–Lewy (CFL) number $r = \\dfrac{c\\,\\Delta t}{\\Delta x}$. Assume periodic boundary conditions on a sufficiently large domain so that Fourier-mode analysis is meaningful.\n\nStarting from the finite-difference representation of $u_{t}$ and $u_{x}$ consistent with the governing equation and the conservative transport of $u$:\n- Derive the explicit nearest-neighbor stencil formula customarily known as the Lax–Friedrichs scheme by using a first-order time update and a centered spatial representation augmented by a symmetric nearest-neighbor replacement of the point value consistent with conservative averaging.\n- Derive the explicit two-step Taylor-in-time stencil formula customarily known as the Lax–Wendroff scheme by expanding $u(x_{j}, t_{n} + \\Delta t)$ to second order in time and eliminating time derivatives using the governing equation, while representing spatial derivatives by centered differences of matching formal order.\n\nFor each scheme:\n- Write the resulting stencil update $u_{j}^{n+1}$ in terms of $u_{j-1}^{n}$, $u_{j}^{n}$, and $u_{j+1}^{n}$, and explain the formal order of accuracy in time and space, under the CFL scaling $\\Delta t = \\lambda\\,\\Delta x$ with $\\lambda = \\mathcal{O}(1)$ as $\\Delta x \\to 0$.\n- Perform a von Neumann (Fourier-mode) stability analysis by inserting the ansatz $u_{j}^{n} = \\hat{u}^{n}\\,\\exp(i\\,j\\,\\xi)$ with wavenumber $\\xi \\in [0, 2\\pi]$, and compute the amplification factor $G(\\xi, r)$ for each scheme.\n- Using the Lax equivalence theorem (for linear initial-value problems, a consistent linear difference scheme is convergent if and only if it is stable), determine the tightest common upper bound on $|r|$ that guarantees stability for all Fourier modes for both schemes simultaneously.\n\nReport as your final answer the single number $r_{\\max}$, the supremum of $|r|$ such that both schemes are von Neumann stable for all wavenumbers. No rounding is required, and the answer is dimensionless. Express the final answer as a single number.",
            "solution": "The problem requires the derivation and stability analysis of the Lax-Friedrichs and Lax-Wendroff schemes for the one-dimensional linear advection equation, $u_{t} + c\\,u_{x} = 0$, where $c > 0$ is a constant. The final objective is to find the tightest common upper bound on the Courant-Friedrichs-Lewy (CFL) number, $r = \\frac{c\\,\\Delta t}{\\Delta x}$, that ensures stability for both schemes.\n\nWe will analyze each scheme separately and then combine the results. For both schemes, we use the discretization $u(x_j, t_n) \\approx u_j^n$, where $x_j = j\\,\\Delta x$ and $t_n = n\\,\\Delta t$.\n\n### Lax–Friedrichs Scheme\n\n**1. Derivation and Stencil Formula**\nThe problem directs us to derive the scheme using a first-order time update (Forward Euler), a centered spatial representation for $u_x$, and a specific replacement for the term $u_j^n$.\nA simple Forward-Time Centered-Space (FTCS) discretization would be:\n$$ \\frac{u_j^{n+1} - u_j^n}{\\Delta t} + c \\frac{u_{j+1}^n - u_{j-1}^n}{2\\Delta x} = 0 $$\nThe Lax-Friedrichs scheme modifies this by replacing the point value $u_j^n$ with its conservative average over nearest neighbors, $u_j^n \\to \\frac{1}{2}(u_{j+1}^n + u_{j-1}^n)$. Applying this modification, we get:\n$$ \\frac{u_j^{n+1} - \\frac{1}{2}(u_{j+1}^n + u_{j-1}^n)}{\\Delta t} + c \\frac{u_{j+1}^n - u_{j-1}^n}{2\\Delta x} = 0 $$\nSolving for $u_j^{n+1}$:\n$$ u_j^{n+1} = \\frac{1}{2}(u_{j+1}^n + u_{j-1}^n) - \\frac{c\\,\\Delta t}{2\\Delta x}(u_{j+1}^n - u_{j-1}^n) $$\nSubstituting the CFL number $r = \\frac{c\\,\\Delta t}{\\Delta x}$:\n$$ u_j^{n+1} = \\frac{1}{2}(u_{j+1}^n + u_{j-1}^n) - \\frac{r}{2}(u_{j+1}^n - u_{j-1}^n) $$\nGrouping terms by their spatial index at time level $n$:\n$$ u_j^{n+1} = \\left(\\frac{1}{2} + \\frac{r}{2}\\right)u_{j-1}^n + 0 \\cdot u_j^n + \\left(\\frac{1}{2} - \\frac{r}{2}\\right)u_{j+1}^n $$\nThis is the stencil update formula for the Lax-Friedrichs scheme.\n\n**2. Order of Accuracy**\nTo determine the formal order of accuracy, we perform a Taylor series expansion of the scheme's terms around the point $(x_j, t_n)$.\n$$ u_{j \\pm 1}^n = u \\pm \\Delta x u_x + \\frac{\\Delta x^2}{2} u_{xx} \\pm \\frac{\\Delta x^3}{6} u_{xxx} + \\mathcal{O}(\\Delta x^4) $$\n$$ u_j^{n+1} = u + \\Delta t u_t + \\frac{\\Delta t^2}{2} u_{tt} + \\mathcal{O}(\\Delta t^3) $$\nSubstituting these into the scheme $\\frac{u_j^{n+1} - \\frac{1}{2}(u_{j+1}^n + u_{j-1}^n)}{\\Delta t} + c \\frac{u_{j+1}^n - u_{j-1}^n}{2\\Delta x} = 0$, we get:\n$$ \\frac{(u + \\Delta t u_t + \\dots) - (u + \\frac{\\Delta x^2}{2}u_{xx} + \\dots)}{\\Delta t} + c(u_x + \\frac{\\Delta x^2}{6}u_{xxx} + \\dots) = 0 $$\n$$ u_t - \\frac{\\Delta x^2}{2\\Delta t}u_{xx} + c u_x + \\mathcal{O}(\\Delta t, \\Delta x^2) = 0 $$\nRearranging, we find the modified equation that the scheme actually solves:\n$$ u_t + c u_x = \\frac{\\Delta x^2}{2\\Delta t}u_{xx} + \\mathcal{O}(\\Delta t, \\Delta x^2) $$\nThe leading term of the truncation error is $\\mathcal{O}(\\frac{\\Delta x^2}{\\Delta t})$. Under the CFL scaling $\\Delta t = \\lambda \\Delta x$ with $\\lambda = \\mathcal{O}(1)$, the truncation error is $\\mathcal{O}(\\Delta x)$. Thus, the Lax-Friedrichs scheme is first-order accurate in both space and time.\n\n**3. von Neumann Stability Analysis**\nWe substitute the Fourier mode ansatz $u_j^n = \\hat{u}^n e^{i j \\xi}$ into the stencil formula, where $\\xi = k_x \\Delta x$ is the dimensionless wavenumber. The amplification factor is $G(\\xi, r) = \\hat{u}^{n+1}/\\hat{u}^n$.\n$$ G e^{ij\\xi} = \\frac{1+r}{2} e^{i(j-1)\\xi} + \\frac{1-r}{2} e^{i(j+1)\\xi} $$\nDividing by $e^{ij\\xi}$:\n$$ G_{LF}(\\xi, r) = \\frac{1+r}{2} e^{-i\\xi} + \\frac{1-r}{2} e^{i\\xi} $$\n$$ G_{LF}(\\xi, r) = \\frac{1}{2}(e^{i\\xi} + e^{-i\\xi}) - \\frac{r}{2}(e^{i\\xi} - e^{-i\\xi}) $$\nUsing Euler's formula, $e^{\\pm i\\xi} = \\cos(\\xi) \\pm i\\sin(\\xi)$:\n$$ G_{LF}(\\xi, r) = \\cos(\\xi) - i r \\sin(\\xi) $$\nFor stability, we require $|G_{LF}(\\xi, r)| \\le 1$ for all $\\xi$. The magnitude squared is:\n$$ |G_{LF}|^2 = (\\cos(\\xi))^2 + (-r \\sin(\\xi))^2 = \\cos^2(\\xi) + r^2 \\sin^2(\\xi) $$\nThe stability condition is $\\cos^2(\\xi) + r^2 \\sin^2(\\xi) \\le 1$. Since $\\cos^2(\\xi) = 1 - \\sin^2(\\xi)$:\n$$ 1 - \\sin^2(\\xi) + r^2 \\sin^2(\\xi) \\le 1 $$\n$$ (r^2 - 1)\\sin^2(\\xi) \\le 0 $$\nAs $\\sin^2(\\xi) \\ge 0$, this inequality holds for all $\\xi$ if and only if $r^2 - 1 \\le 0$, which implies $r^2 \\le 1$.\nThe stability condition for the Lax-Friedrichs scheme is $|r| \\le 1$.\n\n### Lax–Wendroff Scheme\n\n**1. Derivation and Stencil Formula**\nWe begin with a second-order Taylor series expansion of $u(x, t)$ in time:\n$$ u(x, t+\\Delta t) = u(x,t) + \\Delta t u_t + \\frac{\\Delta t^2}{2} u_{tt} + \\mathcal{O}(\\Delta t^3) $$\nFrom the governing equation $u_t = -c u_x$, we find the second time derivative:\n$$ u_{tt} = \\frac{\\partial}{\\partial t}(-c u_x) = -c \\frac{\\partial}{\\partial x}(u_t) = -c \\frac{\\partial}{\\partial x}(-c u_x) = c^2 u_{xx} $$\nSubstituting $u_t$ and $u_{tt}$ into the Taylor expansion:\n$$ u(x, t+\\Delta t) = u(x,t) - c \\Delta t u_x + \\frac{c^2 \\Delta t^2}{2} u_{xx} + \\mathcal{O}(\\Delta t^3) $$\nNow, we discretize this equation at $(x_j, t_n)$ using second-order centered differences for the spatial derivatives:\n$$ u_x \\approx \\frac{u_{j+1}^n - u_{j-1}^n}{2\\Delta x}, \\quad u_{xx} \\approx \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{\\Delta x^2} $$\nSubstituting these into the discretized Taylor expansion gives the Lax-Wendroff scheme:\n$$ u_j^{n+1} = u_j^n - c \\Delta t \\left(\\frac{u_{j+1}^n - u_{j-1}^n}{2\\Delta x}\\right) + \\frac{c^2 \\Delta t^2}{2} \\left(\\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{\\Delta x^2}\\right) $$\nUsing the CFL number $r = \\frac{c \\Delta t}{\\Delta x}$:\n$$ u_j^{n+1} = u_j^n - \\frac{r}{2}(u_{j+1}^n - u_{j-1}^n) + \\frac{r^2}{2}(u_{j+1}^n - 2u_j^n + u_{j-1}^n) $$\nGrouping terms by spatial index:\n$$ u_j^{n+1} = \\left(\\frac{r}{2} + \\frac{r^2}{2}\\right)u_{j-1}^n + (1 - r^2)u_j^n + \\left(-\\frac{r}{2} + \\frac{r^2}{2}\\right)u_{j+1}^n $$\nThe stencil update formula is $u_j^{n+1} = \\frac{r(r+1)}{2}u_{j-1}^n + (1-r^2)u_j^n + \\frac{r(r-1)}{2}u_{j+1}^n$.\n\n**2. Order of Accuracy**\nThe derivation itself shows that the scheme approximates the PDE with an error of $\\mathcal{O}(\\Delta t^3)$ from the time expansion and $\\mathcal{O}(\\Delta t \\Delta x^2)$ from the spatial discretization. Specifically, the leading term of the local truncation error is $\\frac{c \\Delta t \\Delta x^2}{6}(1-r^2)u_{xxx}$. Under the scaling $\\Delta t = \\lambda \\Delta x$, this error is $\\mathcal{O}(\\Delta x^3)$. The scheme is second-order accurate, $\\mathcal{O}(\\Delta t^2, \\Delta x^2)$.\n\n**3. von Neumann Stability Analysis**\nWe substitute the ansatz $u_j^n = G^n e^{i j \\xi}$ into the scheme expression:\n$$ G = 1 - \\frac{r}{2}(e^{i\\xi} - e^{-i\\xi}) + \\frac{r^2}{2}(e^{i\\xi} - 2 + e^{-i\\xi}) $$\n$$ G_{LW}(\\xi, r) = 1 - \\frac{r}{2}(2i\\sin(\\xi)) + \\frac{r^2}{2}(2\\cos(\\xi) - 2) = 1 - i r \\sin(\\xi) + r^2(\\cos(\\xi) - 1) $$\nTo find the magnitude, we compute $|G_{LW}|^2$:\n$$ |G_{LW}|^2 = (1 + r^2(\\cos(\\xi)-1))^2 + (-r\\sin(\\xi))^2 $$\n$$ |G_{LW}|^2 = 1 + 2r^2(\\cos(\\xi)-1) + r^4(\\cos(\\xi)-1)^2 + r^2\\sin^2(\\xi) $$\nUsing $1 - \\cos\\xi = 2\\sin^2(\\xi/2)$ expands this to:\n$$ |G_{LW}|^2 = 1 - 4r^2\\sin^2(\\frac{\\xi}{2}) + 4r^4\\sin^4(\\frac{\\xi}{2}) + 4r^2\\sin^2(\\frac{\\xi}{2})\\cos^2(\\frac{\\xi}{2}) $$\n$$ |G_{LW}|^2 = 1 - 4r^2\\sin^2(\\frac{\\xi}{2}) + 4r^4\\sin^4(\\frac{\\xi}{2}) + 4r^2\\sin^2(\\frac{\\xi}{2})(1-\\sin^2(\\frac{\\xi}{2})) $$\n$$ |G_{LW}|^2 = 1 - 4r^2\\sin^2(\\frac{\\xi}{2}) + 4r^4\\sin^4(\\frac{\\xi}{2}) + 4r^2\\sin^2(\\frac{\\xi}{2}) - 4r^2\\sin^4(\\frac{\\xi}{2}) $$\n$$ |G_{LW}|^2 = 1 + (4r^4 - 4r^2)\\sin^4(\\frac{\\xi}{2}) = 1 - 4r^2(1-r^2)\\sin^4(\\frac{\\xi}{2}) $$\nFor stability, $|G_{LW}|^2 \\le 1$, which requires:\n$$ -4r^2(1-r^2)\\sin^4(\\frac{\\xi}{2}) \\le 0 $$\nSince $r^2 \\ge 0$ and $\\sin^4(\\xi/2) \\ge 0$, this condition is met for all $\\xi$ if and only if $1-r^2 \\ge 0$, which implies $r^2 \\le 1$.\nThe stability condition for the Lax-Wendroff scheme is $|r| \\le 1$.\n\n### Common Stability Bound\n\nAccording to the Lax equivalence theorem, for these consistent linear schemes, stability is the necessary and sufficient condition for convergence.\n- The von Neumann stability analysis for the Lax-Friedrichs scheme yields the condition $|r| \\le 1$.\n- The von Neumann stability analysis for the Lax-Wendroff scheme yields the condition $|r| \\le 1$.\n\nBoth schemes are stable if and only if the CFL number $r$ satisfies $|r| \\le 1$. The set of values for which both schemes are simultaneously stable is the intersection of their individual stability regions, which in this case is the interval $[-1, 1]$.\n\nThe tightest common upper bound on $|r|$ is the supremum of $|r|$ over this common stability region. Thus, the supremum is $1$.\nLet $r_{\\max} = \\sup \\{ |r| : |r| \\le 1 \\}$. This gives $r_{\\max} = 1$.",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "A stable scheme may still produce solutions that are qualitatively wrong due to inherent numerical errors. To move beyond a simple stable/unstable classification, we must understand the character of these errors. This exercise introduces the powerful technique of deriving the \"modified equation,\" which reveals the partial differential equation that a numerical scheme implicitly solves. By applying this method to the first-order upwind scheme, you will mathematically demonstrate how this scheme introduces an \"artificial diffusion\" term, quantifying how numerical truncation error can manifest as a physical-like dissipative effect .",
            "id": "4110350",
            "problem": "Consider a one-dimensional, constant-coefficient linear advection model for a passive tracer in a locally uniform zonal flow relevant to numerical weather prediction and climate modeling,\n$$\nq_t + c\\,q_x = 0,\n$$\nwith constant advective speed $c>0$. On a uniform grid with spacing $\\Delta x$ and time step $\\Delta t$, the standard first-order upwind finite-difference discretization in time and space is\n$$\nq_j^{n+1} = q_j^n - \\mu\\left(q_j^n - q_{j-1}^n\\right),\n$$\nwhere the Courant–Friedrichs–Lewy (CFL) number is $\\mu = \\dfrac{c\\,\\Delta t}{\\Delta x}$. Assume $q(x,t)$ is smooth, $\\Delta x \\to 0$ with fixed $\\mu$ so that $\\Delta t = \\dfrac{\\mu\\,\\Delta x}{c} = \\mathcal{O}(\\Delta x)$, and interpret the scheme as a consistent approximation to the partial differential equation solved by the numerical method (the modified equation), keeping terms up to and including those that are $\\mathcal{O}(\\Delta x^2)$.\n\nStarting only from the governing advection equation, the definition of the CFL number, and Taylor expansions, derive the modified equation in the form\n$$\nq_t + c\\,q_x = \\nu\\,q_{xx} + \\kappa\\,q_{xxx} + \\mathcal{O}(\\Delta x^3),\n$$\nand thereby identify the artificial diffusion coefficient $\\nu$ as an explicit analytic function of $c$, $\\Delta x$, and $\\mu$. Your final answer must be the closed-form expression for $\\nu$ only. No numerical evaluation or rounding is required, and no units should be included in the final expression.",
            "solution": "The problem requires the derivation of the modified equation for the first-order upwind finite-difference scheme applied to the one-dimensional linear advection equation. The goal is to identify the artificial diffusion coefficient, $\\nu$.\n\nThe governing partial differential equation (PDE) is the linear advection equation:\n$$\n\\frac{\\partial q}{\\partial t} + c \\frac{\\partial q}{\\partial x} = 0\n$$\nwhere $c > 0$ is a constant advective speed. For brevity, we will use the subscript notation $q_t$ for $\\frac{\\partial q}{\\partial t}$, $q_x$ for $\\frac{\\partial q}{\\partial x}$, $q_{xx}$ for $\\frac{\\partial^2 q}{\\partial x^2}$, and so on. The PDE is thus $q_t + c\\,q_x = 0$.\n\nThe finite-difference scheme provided is:\n$$\nq_j^{n+1} = q_j^n - \\mu\\left(q_j^n - q_{j-1}^n\\right)\n$$\nwhere $q_j^n$ approximates the solution $q(x_j, t_n)$, with $x_j = j\\Delta x$ and $t_n = n\\Delta t$. The Courant–Friedrichs–Lewy (CFL) number is $\\mu = \\frac{c\\Delta t}{\\Delta x}$.\n\nThe first step is to express the scheme in a form that resembles a differential equation. We rearrange the scheme to isolate a finite-difference approximation of the time derivative:\n$$\n\\frac{q_j^{n+1} - q_j^n}{\\Delta t} = -\\frac{\\mu}{\\Delta t}\\left(q_j^n - q_{j-1}^n\\right)\n$$\nSubstituting the definition of $\\mu$:\n$$\n\\frac{q_j^{n+1} - q_j^n}{\\Delta t} = -\\frac{c\\Delta t/\\Delta x}{\\Delta t}\\left(q_j^n - q_{j-1}^n\\right) = -c \\frac{q_j^n - q_{j-1}^n}{\\Delta x}\n$$\nTo find the modified equation, we perform a Taylor series expansion of each term in the scheme around the point $(x_j, t_n)$, assuming the solution $q(x,t)$ is sufficiently smooth.\n\nThe left-hand side (LHS) is a forward difference in time. Its Taylor expansion around $t_n$ is:\n$$\nq_j^{n+1} = q(x_j, t_n + \\Delta t) = q(x_j, t_n) + \\Delta t \\frac{\\partial q}{\\partial t} + \\frac{(\\Delta t)^2}{2!} \\frac{\\partial^2 q}{\\partial t^2} + \\frac{(\\Delta t)^3}{3!} \\frac{\\partial^3 q}{\\partial t^3} + \\mathcal{O}(\\Delta t^4)\n$$\nSubstituting this into the LHS gives:\n$$\n\\frac{q_j^{n+1} - q_j^n}{\\Delta t} = \\frac{\\partial q}{\\partial t} + \\frac{\\Delta t}{2} \\frac{\\partial^2 q}{\\partial t^2} + \\frac{(\\Delta t)^2}{6} \\frac{\\partial^3 q}{\\partial t^3} + \\mathcal{O}(\\Delta t^3)\n$$\nAll derivatives are evaluated at $(x_j, t_n)$.\n\nThe right-hand side (RHS) involves a backward difference in space. Its Taylor expansion around $x_j$ is:\n$$\nq_{j-1}^n = q(x_j - \\Delta x, t_n) = q(x_j, t_n) - \\Delta x \\frac{\\partial q}{\\partial x} + \\frac{(\\Delta x)^2}{2!} \\frac{\\partial^2 q}{\\partial x^2} - \\frac{(\\Delta x)^3}{3!} \\frac{\\partial^3 q}{\\partial x^3} + \\mathcal{O}(\\Delta x^4)\n$$\nSubstituting this into the RHS gives:\n$$\n-c \\frac{q_j^n - q_{j-1}^n}{\\Delta x} = -c \\frac{1}{\\Delta x} \\left[ \\Delta x \\frac{\\partial q}{\\partial x} - \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 q}{\\partial x^2} + \\frac{(\\Delta x)^3}{6} \\frac{\\partial^3 q}{\\partial x^3} - \\mathcal{O}(\\Delta x^4) \\right]\n$$\n$$\n= -c \\frac{\\partial q}{\\partial x} + \\frac{c \\Delta x}{2} \\frac{\\partial^2 q}{\\partial x^2} - \\frac{c (\\Delta x)^2}{6} \\frac{\\partial^3 q}{\\partial x^3} + \\mathcal{O}(\\Delta x^3)\n$$\nEquating the expanded LHS and RHS, we obtain the modified equation with mixed derivatives:\n$$\n\\frac{\\partial q}{\\partial t} + \\frac{\\Delta t}{2} \\frac{\\partial^2 q}{\\partial t^2} + \\frac{(\\Delta t)^2}{6} \\frac{\\partial^3 q}{\\partial t^3} + \\dots = -c \\frac{\\partial q}{\\partial x} + \\frac{c \\Delta x}{2} \\frac{\\partial^2 q}{\\partial x^2} - \\frac{c (\\Delta x)^2}{6} \\frac{\\partial^3 q}{\\partial x^3} + \\dots\n$$\nWe rearrange this to isolate $\\frac{\\partial q}{\\partial t}$:\n$$\n\\frac{\\partial q}{\\partial t} = -c \\frac{\\partial q}{\\partial x} - \\frac{\\Delta t}{2} \\frac{\\partial^2 q}{\\partial t^2} + \\frac{c \\Delta x}{2} \\frac{\\partial^2 q}{\\partial x^2} - \\frac{(\\Delta t)^2}{6} \\frac{\\partial^3 q}{\\partial t^3} - \\frac{c (\\Delta x)^2}{6} \\frac{\\partial^3 q}{\\partial x^3} + \\dots\n$$\nThe next step is to eliminate the time derivatives on the RHS, expressing them in terms of spatial derivatives. This is done iteratively. We start with the lowest-order approximation of the modified equation, which is the original PDE itself: $q_t = -c q_x$.\n\nWe differentiate this approximation with respect to time to find an expression for $q_{tt}$:\n$$\n\\frac{\\partial^2 q}{\\partial t^2} = \\frac{\\partial}{\\partial t} \\left(-c \\frac{\\partial q}{\\partial x}\\right) = -c \\frac{\\partial}{\\partial x} \\left(\\frac{\\partial q}{\\partial t}\\right)\n$$\nNow, substitute $q_t = -c q_x$ into this expression:\n$$\n\\frac{\\partial^2 q}{\\partial t^2} = -c \\frac{\\partial}{\\partial x} \\left(-c \\frac{\\partial q}{\\partial x}\\right) = c^2 \\frac{\\partial^2 q}{\\partial x^2}\n$$\nThe full expression for $q_{tt}$ involves higher-order spatial derivatives, but $q_{tt} = c^2 q_{xx} + \\mathcal{O}(\\Delta x)$ is a sufficient approximation for determining the coefficient of $q_{xx}$ in the modified equation, as the error term will only affect coefficients of terms of order $\\mathcal{O}(\\Delta x^2)$ and higher.\n\nSubstitute $q_{tt} \\approx c^2 q_{xx}$ into the expression for $q_t$:\n$$\n\\frac{\\partial q}{\\partial t} \\approx -c \\frac{\\partial q}{\\partial x} - \\frac{\\Delta t}{2} \\left(c^2 \\frac{\\partial^2 q}{\\partial x^2}\\right) + \\frac{c \\Delta x}{2} \\frac{\\partial^2 q}{\\partial x^2} + \\dots\n$$\nWe can now group the terms by the order of their spatial derivatives.\n$$\n\\frac{\\partial q}{\\partial t} + c \\frac{\\partial q}{\\partial x} \\approx \\left( \\frac{c \\Delta x}{2} - \\frac{c^2 \\Delta t}{2} \\right) \\frac{\\partial^2 q}{\\partial x^2} + \\dots\n$$\nComparing this to the target form of the modified equation, $q_t + c\\,q_x = \\nu\\,q_{xx} + \\kappa\\,q_{xxx} + \\mathcal{O}(\\Delta x^3)$, we can identify the artificial diffusion coefficient $\\nu$ as the coefficient of the $q_{xx}$ term:\n$$\n\\nu = \\frac{c \\Delta x}{2} - \\frac{c^2 \\Delta t}{2}\n$$\nThe final step is to express $\\nu$ as a function of $c$, $\\Delta x$, and $\\mu$ by using the relationship $\\Delta t = \\frac{\\mu \\Delta x}{c}$:\n$$\n\\nu = \\frac{c \\Delta x}{2} - \\frac{c^2}{2}\\left(\\frac{\\mu \\Delta x}{c}\\right)\n$$\n$$\n\\nu = \\frac{c \\Delta x}{2} - \\frac{c \\mu \\Delta x}{2}\n$$\nFactoring out the common terms, we arrive at the final expression for the artificial diffusion coefficient:\n$$\n\\nu = \\frac{c \\Delta x}{2}(1 - \\mu)\n$$\nThis is the leading-order error term of the scheme, which manifests as a diffusive term. For the scheme to be numerically stable, the condition $0 \\le \\mu \\le 1$ must be met, which ensures that $\\nu \\ge 0$.",
            "answer": "$$\\boxed{\\frac{c \\Delta x}{2}(1-\\mu)}$$"
        }
    ]
}