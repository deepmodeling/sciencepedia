{
    "hands_on_practices": [
        {
            "introduction": "本练习将冯·诺伊曼分析应用于一个核心物理过程——扩散方程。通过推导前向时间中心空间（FTCS）格式的放大因子，你将亲手实践如何从稳定性基本准则 $|G(\\theta)| \\le 1$ 推导出对时间步长的严格限制。这个实践是理解数值稳定性和拉克斯等价定理如何共同保证数值解收敛性的基石。",
            "id": "4110334",
            "problem": "在数值天气预报和气候模拟的背景下，一维周期性区域上被动示踪物的小尺度湍流混合可以通过线性扩散偏微分方程（PDE）$u_{t} = \\nu u_{xx}$ 进行理想化处理。其中，$u(x,t)$ 是示踪物浓度，$t$ 是时间，$x$ 是空间坐标，$\\nu  0$ 是代表次网格尺度混合的运动学扩散系数。考虑一个空间间距为 $\\Delta x$ 的均匀空间网格和一个显式时间步长 $\\Delta t$。在此周期性网格上应用前向时间中心空间（FTCS）格式，该格式由前向 Euler 时间离散和二阶中心空间离散定义。\n\n使用 von Neumann (Fourier) 分析，假设一个离散傅里叶模态 $u_{j}^{n} = \\hat{u}^{n} \\exp(i j \\theta)$，其中 $j$ 为网格点索引，$n$ 为时间层索引，$\\theta = k \\Delta x$ 是无量纲相位（$k$ 为波数），$i$ 是虚数单位。推导离散放大因子 $G(\\theta)$，使得 $\\hat{u}^{n+1} = G(\\theta)\\,\\hat{u}^{n}$，并用 $\\theta$ 和无量纲扩散数 $r = \\nu \\Delta t / \\Delta x^{2}$ 以闭合形式表示 $G(\\theta)$。然后，从 von Neumann 分析下的线性稳定性基本定义出发，并引用 Lax 等价定理（该定理指出，对于线性初值问题，相容性加稳定性意味着收敛性），解释你得到的 $G(\\theta)$ 对显式 FTCS 扩散格式中 $r$ 的 Courant-Friedrichs-Lewy (CFL) 型限制所产生的影响。\n\n以 $r$ 和 $\\theta$ 表示的 $G(\\theta)$ 的显式解析表达式作为你的最终答案。不需要进行数值计算。",
            "solution": "问题陈述是有效的。这是一个偏微分方程数值分析领域的标准、适定问题，基于已建立的数学原理和物理模型。所有必要信息都已提供，术语精确且无歧义。\n\n该问题要求推导和解释用于一维线性扩散方程的前向时间中心空间（FTCS）格式的稳定性。\n\n控制性偏微分方程（PDE）由下式给出：\n$$\n\\frac{\\partial u}{\\partial t} = \\nu \\frac{\\partial^2 u}{\\partial x^2}\n$$\n其中 $u(x,t)$ 是示踪物浓度，$t$ 是时间，$x$ 是空间坐标，$\\nu  0$ 是常数运动学扩散系数。\n\n我们被要求在空间步长为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格上应用 FTCS 格式。令 $u_j^n$ 表示 $u(j\\Delta x, n\\Delta t)$ 的数值近似。FTCS 格式使用一阶前向差分来离散化时间导数，使用二阶中心差分来离散化空间导数。\n\n时间上的前向差分为：\n$$\n\\frac{\\partial u}{\\partial t} \\bigg|_{j,n} \\approx \\frac{u_j^{n+1} - u_j^n}{\\Delta t}\n$$\n\n空间上的中心差分为：\n$$\n\\frac{\\partial^2 u}{\\partial x^2} \\bigg|_{j,n} \\approx \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\\Delta x)^2}\n$$\n\n将这些近似值代入 PDE，得到 FTCS 格式的有限差分方程：\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = \\nu \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\\Delta x)^2}\n$$\n\n我们可以求解下一个时间步的解 $u_j^{n+1}$：\n$$\nu_j^{n+1} = u_j^n + \\frac{\\nu \\Delta t}{(\\Delta x)^2} (u_{j+1}^n - 2u_j^n + u_{j-1}^n)\n$$\n\n问题将无量纲扩散数定义为 $r = \\nu \\Delta t / (\\Delta x)^2$。将 $r$ 代入方程得到：\n$$\nu_j^{n+1} = u_j^n + r (u_{j+1}^n - 2u_j^n + u_{j-1}^n)\n$$\n\n为了进行 von Neumann 稳定性分析，我们代入给定的离散傅里叶模态 $u_j^n = \\hat{u}^n \\exp(i j \\theta)$，其中 $\\theta = k \\Delta x$ 是无量纲波数。项 $\\hat{u}^n$ 是时间层 $n$ 上傅里叶模态的振幅。关系式 $\\hat{u}^{n+1} = G(\\theta) \\hat{u}^n$ 定义了放大因子 $G(\\theta)$。\n\n将傅里叶模态代入差分方程：\n$$\n\\hat{u}^{n+1} \\exp(i j \\theta) = \\hat{u}^n \\exp(i j \\theta) + r \\left( \\hat{u}^n \\exp(i (j+1) \\theta) - 2 \\hat{u}^n \\exp(i j \\theta) + \\hat{u}^n \\exp(i (j-1) \\theta) \\right)\n$$\n\n我们可以从右侧提出公因子 $\\hat{u}^n \\exp(i j \\theta)$：\n$$\n\\hat{u}^{n+1} \\exp(i j \\theta) = \\hat{u}^n \\exp(i j \\theta) \\left[ 1 + r \\left( \\exp(i \\theta) - 2 + \\exp(-i \\theta) \\right) \\right]\n$$\n\n两边同除以 $\\hat{u}^n \\exp(i j \\theta)$ (非零)，并使用定义 $G(\\theta) = \\hat{u}^{n+1} / \\hat{u}^n$，我们得到放大因子的表达式：\n$$\nG(\\theta) = 1 + r \\left( \\exp(i \\theta) + \\exp(-i \\theta) - 2 \\right)\n$$\n\n使用 Euler 恒等式 $\\cos(\\theta) = \\frac{\\exp(i \\theta) + \\exp(-i \\theta)}{2}$，我们有 $\\exp(i \\theta) + \\exp(-i \\theta) = 2 \\cos(\\theta)$。将此代入 $G(\\theta)$ 的表达式，得到所需的以 $r$ 和 $\\theta$ 表示的闭合形式表达式：\n$$\nG(\\theta) = 1 + r(2 \\cos(\\theta) - 2) = 1 + 2r(\\cos(\\theta) - 1)\n$$\n这可以使用半角恒等式 $\\cos(\\theta) - 1 = -2 \\sin^2(\\theta/2)$ 进一步简化，得到 $G(\\theta) = 1 - 4r \\sin^2(\\theta/2)$。然而，所要求的直接结果是 $1 + 2r(\\cos(\\theta) - 1)$ 的形式。\n\n现在，我们解释其对稳定性的影响。von Neumann 分析中线性稳定性的基本定义要求，对于所有可能的波数（即，对于所有 $\\theta$），放大因子的模必须小于或等于 1：\n$$\n|G(\\theta)| \\le 1 \\quad \\forall \\theta \\in [-\\pi, \\pi]\n$$\n这个条件确保了没有傅里叶模态会在时间上被非物理地放大，否则将导致数值误差的灾难性增长。\n\n由于 $G(\\theta)$ 是纯实数，条件 $|G(\\theta)| \\le 1$ 等价于 $-1 \\le G(\\theta) \\le 1$。\n我们来检查这两个不等式。\n\n1. 上界：$G(\\theta) \\le 1$\n$$\n1 + 2r(\\cos(\\theta) - 1) \\le 1\n$$\n$$\n2r(\\cos(\\theta) - 1) \\le 0\n$$\n由于 $r = \\nu \\Delta t / (\\Delta x)^2  0$ 且项 $(\\cos(\\theta) - 1)$ 总是小于或等于零（因为 $\\cos(\\theta) \\le 1$），它们的乘积总是小于或等于零。因此，这个不等式总是成立的。\n\n2. 下界：$G(\\theta) \\ge -1$\n$$\n1 + 2r(\\cos(\\theta) - 1) \\ge -1\n$$\n$$\n2 \\ge -2r(\\cos(\\theta) - 1)\n$$\n$$\n2 \\ge 2r(1 - \\cos(\\theta))\n$$\n$$\n1 \\ge r(1 - \\cos(\\theta))\n$$\n这个条件必须对所有 $\\theta$ 值都成立。为了找到最严格的情况，我们必须最大化项 $r(1 - \\cos(\\theta))$。由于 $r$ 是一个正常数，我们需要最大化 $(1 - \\cos(\\theta))$。该项的最大值为 $2$，出现在 $\\cos(\\theta) = -1$ 时，对应于网格上可表示的最高频率（最短波长），即 $\\theta = \\pi$（所谓的“2-$\\Delta x$”波）。\n\n将这个最严格的情况代入不等式：\n$$\n1 \\ge r(1 - (-1))\n$$\n$$\n1 \\ge 2r\n$$\n$$\nr \\le \\frac{1}{2}\n$$\n\n因此，应用于扩散方程的 FTCS 格式的 CFL 型限制是 $r = \\frac{\\nu \\Delta t}{(\\Delta x)^2} \\le \\frac{1}{2}$。这是一个条件稳定性。时间步长 $\\Delta t$ 受到空间步长平方的限制，即 $\\Delta t \\le \\frac{(\\Delta x)^2}{2\\nu}$。对于高分辨率模型（小的 $\\Delta x$）来说，这可能是一个非常严格的限制。\n\n最后，Lax 等价定理指出，对于一个适定的线性初值问题，一个相容的有限差分格式是收敛的当且仅当它是稳定的。\n- **相容性 (Consistency)**：FTCS 格式与扩散方程是相容的，因为其截断误差（阶数为 $O(\\Delta t, (\\Delta x)^2)$）在 $\\Delta t \\to 0$ 和 $\\Delta x \\to 0$ 时趋于零。\n- **稳定性 (Stability)**：如上所推导，该格式仅在条件 $r \\le 1/2$ 下是稳定的。\n因此，根据 Lax 等价定理，只要满足稳定性条件 $r \\le 1/2$，随着网格的细化，FTCS 格式的数值解将收敛到扩散偏微分方程的真实解。如果违反此条件，格式将变得不稳定，数值解将发散，从而变得毫无用处。\n最终答案是推导出的 $G(\\theta)$ 的表达式。",
            "answer": "$$\n\\boxed{1 + 2r(\\cos(\\theta) - 1)}\n$$"
        },
        {
            "introduction": "稳定性并非数值格式的全部；即使是稳定格式也可能引入显著误差。本练习聚焦于对流方程的一阶迎风格式，并引导你量化其固有的数值耗散。通过分析放大因子的模 $|G(\\theta)|$，你将学习如何将离散化引入的振幅衰减与一个等效的物理扩散项联系起来，从而揭示数值格式可能产生的非物理效应。",
            "id": "4110374",
            "problem": "在一维空间中，考虑一个均匀纬向流中的无源示踪剂输运，其模型为线性平流方程 $u_{t} + c\\,u_{x} = 0$，其中速度 $c  0$ 为常数，定义域为周期性区域。在一个空间间距为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格上，应用一种标准的空间一阶迎风、时间前向欧拉离散格式（许多数值天气预报的输运模块都采用此方法）。将 $\\mu = c\\,\\Delta t / \\Delta x$ 记为 Courant–Friedrichs–Lewy (CFL) 数。假设 $\\mu \\in [0,1]$，以使该格式满足 Lax 等价定理所要求的稳定性和相容性。\n\n从该离散格式出发，进行 von Neumann 傅里叶模态分析，以：\n- 推导无量纲波数为 $\\theta = k\\,\\Delta x$ 的傅里叶模态的放大因子 $G(\\theta)$；\n- 获得 $\\lvert G(\\theta) \\rvert$ 的小 $\\theta$ 展开式，直至并包含 $\\theta$ 的主导非平凡阶；\n- 将一个时间步长 $\\Delta t$ 内的主导阶振幅衰减解释为源于一个添加到连续方程中的等效扩散项 $\\nu_{\\mathrm{num}}\\,u_{xx}$，这意味着波数为 $k$ 的模态在主导阶上每个时间步长按 $\\exp\\!\\big(-\\nu_{\\mathrm{num}}\\,k^{2}\\,\\Delta t\\big)$ 衰减。\n\n提供等效数值扩散系数 $\\nu_{\\mathrm{num}}$ 的单一闭式解析表达式，用 $c$、$\\Delta x$ 和 $\\mu$ 表示。以符号形式表示最终结果；不要代入数值。有量纲的量默认使用国际单位制基本单位。你的最终答案必须是单一的解析表达式。",
            "solution": "所述问题是有效的。其科学基础在于偏微分方程的数值分析原理，特别是关于有限差分格式的稳定性和耗散性质。该问题是适定的，提供了所有必要信息，并且目标明确唯一。语言客观且正式。\n\n问题要求推导应用于线性平流方程的一阶迎风格式的数值扩散系数。推导过程分为三个主要步骤：\n1.  使用 von Neumann 稳定性分析推导数值格式的放大因子 $G$。\n2.  通过对长波情况下放大因子的模 $|G|$ 进行展开，分析该格式的耗散性质。\n3.  将此数值耗散等同于一个添加到原始偏微分方程（PDE）中的物理扩散项 $\\nu_{\\mathrm{num}}u_{xx}$ 所产生的耗散，从而确定 $\\nu_{\\mathrm{num}}$。\n\n一维线性平流方程由下式给出：\n$$ u_{t} + c\\,u_{x} = 0 $$\n其中 $c  0$ 是恒定的平流速度。\n\n离散化使用时间上的前向欧拉法（下标 $t$）和空间上的一阶迎风格式（下标 $x$）。设 $u_j^n$ 表示在空间网格点 $x_j = j\\Delta x$ 和时间 $t_n = n\\Delta t$ 上的数值解。由于 $c  0$，“迎风”方向来自左侧（索引 $j-1$）。离散化方程为：\n$$ \\frac{u_j^{n+1} - u_j^n}{\\Delta t} + c \\left( \\frac{u_j^n - u_{j-1}^n}{\\Delta x} \\right) = 0 $$\n重新整理以求解 $u_j^{n+1}$：\n$$ u_j^{n+1} = u_j^n - \\frac{c\\Delta t}{\\Delta x} (u_j^n - u_{j-1}^n) $$\n使用 Courant–Friedrichs–Lewy (CFL) 数的定义 $\\mu = \\frac{c\\Delta t}{\\Delta x}$，格式变为：\n$$ u_j^{n+1} = u_j^n - \\mu (u_j^n - u_{j-1}^n) = (1 - \\mu)u_j^n + \\mu u_{j-1}^n $$\n\n对于 von Neumann 分析，我们考虑解的单个傅里叶模态：\n$$ u_j^n = \\hat{u}^n(k) e^{i k x_j} = (G(k))^n \\hat{u}^0(k) e^{i k j \\Delta x} $$\n此处，$k$ 是波数，$G(k)$ 是每时间步长的放大因子。将此形式代入离散方程：\n$$ G^{n+1} e^{i k j \\Delta x} = (1 - \\mu) G^n e^{i k j \\Delta x} + \\mu G^n e^{i k (j-1) \\Delta x} $$\n用 $G^n e^{i k j \\Delta x}$ 除以各项，得到放大因子 $G$：\n$$ G = (1 - \\mu) + \\mu e^{-i k \\Delta x} $$\n使用无量纲波数 $\\theta = k \\Delta x$，我们有：\n$$ G(\\theta) = 1 - \\mu + \\mu e^{-i\\theta} $$\n这完成了任务的第一部分。\n\n接下来，我们求放大因子的模 $|G(\\theta)|$，以分析振幅误差（数值耗散）。\n$$ G(\\theta) = (1 - \\mu) + \\mu(\\cos\\theta - i\\sin\\theta) = (1 - \\mu + \\mu\\cos\\theta) - i(\\mu\\sin\\theta) $$\n模的平方为：\n$$ |G(\\theta)|^2 = (1 - \\mu + \\mu\\cos\\theta)^2 + (-\\mu\\sin\\theta)^2 $$\n$$ |G(\\theta)|^2 = (1 - \\mu)^2 + 2\\mu(1-\\mu)\\cos\\theta + \\mu^2\\cos^2\\theta + \\mu^2\\sin^2\\theta $$\n$$ |G(\\theta)|^2 = 1 - 2\\mu + \\mu^2 + 2\\mu(1-\\mu)\\cos\\theta + \\mu^2(\\cos^2\\theta + \\sin^2\\theta) $$\n$$ |G(\\theta)|^2 = 1 - 2\\mu + \\mu^2 + 2\\mu(1-\\mu)\\cos\\theta + \\mu^2 $$\n$$ |G(\\theta)|^2 = 1 - 2\\mu + 2\\mu^2 + (2\\mu - 2\\mu^2)\\cos\\theta $$\n$$ |G(\\theta)|^2 = 1 - 2\\mu(1 - \\mu) + 2\\mu(1 - \\mu)\\cos\\theta = 1 - 2\\mu(1 - \\mu)(1 - \\cos\\theta) $$\n为使格式稳定，我们要求 $|G(\\theta)| \\le 1$。由于 $\\mu \\in [0,1]$ 且 $(1-\\cos\\theta) \\ge 0$，我们有 $2\\mu(1-\\mu)(1-\\cos\\theta) \\ge 0$，这保证了 $|G(\\theta)|^2 \\le 1$。\n\n现在，我们进行小 $\\theta$ 展开来分析长波行为。我们使用 $\\cos\\theta$ 在 $\\theta=0$ 处的泰勒级数：\n$$ \\cos\\theta = 1 - \\frac{\\theta^2}{2} + O(\\theta^4) $$\n将此代入 $|G(\\theta)|^2$ 的表达式中：\n$$ |G(\\theta)|^2 = 1 - 2\\mu(1 - \\mu)\\left(1 - \\left(1 - \\frac{\\theta^2}{2} + O(\\theta^4)\\right)\\right) $$\n$$ |G(\\theta)|^2 = 1 - 2\\mu(1 - \\mu)\\left(\\frac{\\theta^2}{2} - O(\\theta^4)\\right) = 1 - \\mu(1 - \\mu)\\theta^2 + O(\\theta^4) $$\n为求 $|G(\\theta)|$，我们取平方根，使用展开式 $\\sqrt{1-x} = 1 - \\frac{1}{2}x + O(x^2)$：\n$$ |G(\\theta)| = \\left(1 - \\mu(1 - \\mu)\\theta^2 + O(\\theta^4)\\right)^{1/2} = 1 - \\frac{1}{2}\\mu(1 - \\mu)\\theta^2 + O(\\theta^4) $$\n因此，一个时间步长内的主导阶振幅衰减由 $\\theta^2$ 项表征。\n\n最后，我们将此衰减解释为源自一个添加到原始 PDE 中的等效扩散项 $\\nu_{\\mathrm{num}}u_{xx}$，方程变为平流-扩散方程：\n$$ u_t + c u_x = \\nu_{\\mathrm{num}} u_{xx} $$\n这个修正后的偏微分方程在一个时间步长 $\\Delta t$ 内的精确放大因子可以通过代入傅里叶模态 $u(x,t) = A(t)e^{ikx}$ 来找到：\n$$ \\frac{dA}{dt} e^{ikx} + c(ik)A e^{ikx} = \\nu_{\\mathrm{num}}(ik)^2 A e^{ikx} $$\n$$ \\frac{dA}{dt} = (-ikc - k^2\\nu_{\\mathrm{num}})A $$\n$A(t)$ 的解是 $A(t) = A(0)\\exp((-ikc - k^2\\nu_{\\mathrm{num}})t)$。在一个时间步长 $\\Delta t$ 内的放大因子是：\n$$ G_{\\mathrm{exact}}(k) = \\frac{A(\\Delta t)}{A(0)} = \\exp((-ikc - k^2\\nu_{\\mathrm{num}})\\Delta t) $$\n该因子的模代表振幅衰减：\n$$ |G_{\\mathrm{exact}}(k)| = |\\exp(-ikc\\Delta t)\\exp(-k^2\\nu_{\\mathrm{num}}\\Delta t)| = \\exp(-k^2\\nu_{\\mathrm{num}}\\Delta t) $$\n对于小自变量，$\\exp(-z) \\approx 1-z$。因此，对于小 $k$，衰减为：\n$$ |G_{\\mathrm{exact}}(k)| \\approx 1 - k^2\\nu_{\\mathrm{num}}\\Delta t $$\n我们现在将来自数值格式的主导阶衰减与这个等效的物理衰减等同起来。将 $\\theta$ 替换为 $k\\Delta x$：\n$$ |G(k\\Delta x)| \\approx 1 - \\frac{1}{2}\\mu(1 - \\mu)(k\\Delta x)^2 $$\n比较这两个表达式：\n$$ 1 - \\frac{1}{2}\\mu(1 - \\mu)k^2(\\Delta x)^2 = 1 - k^2\\nu_{\\mathrm{num}}\\Delta t $$\n令 $k^2$ 的系数相等：\n$$ \\frac{1}{2}\\mu(1 - \\mu)(\\Delta x)^2 = \\nu_{\\mathrm{num}}\\Delta t $$\n求解数值扩散系数 $\\nu_{\\mathrm{num}}$：\n$$ \\nu_{\\mathrm{num}} = \\frac{(\\Delta x)^2}{2\\Delta t}\\mu(1 - \\mu) $$\n为了用 $c$、$\\Delta x$ 和 $\\mu$ 表示，我们使用 $\\mu$ 的定义来消去 $\\Delta t$。从 $\\mu = \\frac{c\\Delta t}{\\Delta x}$，我们得到 $\\frac{1}{\\Delta t} = \\frac{c}{\\mu\\Delta x}$。\n将此代入 $\\nu_{\\mathrm{num}}$ 的表达式中：\n$$ \\nu_{\\mathrm{num}} = \\frac{(\\Delta x)^2}{2} \\left(\\frac{c}{\\mu\\Delta x}\\right) \\mu(1 - \\mu) $$\n$$ \\nu_{\\mathrm{num}} = \\frac{c\\Delta x}{2\\mu} \\mu(1 - \\mu) = \\frac{c\\Delta x}{2}(1 - \\mu) $$\n这就是等效数值扩散系数的最终表达式。",
            "answer": "$$\\boxed{\\frac{c \\Delta x}{2}(1 - \\mu)}$$"
        },
        {
            "introduction": "高阶格式旨在减少数值误差，但它们往往用一种类型的误差换取另一种。本练习将分析用于对流方程的二阶Lax-Wendroff格式，重点是评估其相误差，即数值频散。通过将数值放大因子的相位与精确解的相位进行比较，你将揭示该格式如何导致不同波长的波以错误的速度传播，这是理解高阶格式在波动建模中表现的关键一步。",
            "id": "4110305",
            "problem": "在数值天气预报和气候模拟中，被动示踪物的一维线性平流是输运过程的一个基本组成部分。考虑在具有空间步长 $\\Delta x$ 和时间步长 $\\Delta t$ 的均匀网格上，具有恒定波速 $c$ 的平流方程 $u_{t} + c\\,u_{x} = 0$，并服从周期性边界条件。Courant–Friedrichs–Lewy (CFL) 数定义为 $\\mu = c\\,\\Delta t / \\Delta x$。\n\n从时间的二阶泰勒展开出发，并用中心有限差分替换空间导数，为该方程构建 Lax–Wendroff 格式。通过假设一个离散傅里叶模 $u_{j}^{n} = \\hat{u}^{n}\\,\\exp(i\\,j\\,\\theta)$，进行傅里叶（von Neumann）稳定性分析，其中 $\\theta = k\\,\\Delta x$ 是无量纲波数，$j$ 是网格点的索引。推导离散放大因子 $G(\\theta)$，并用 $\\mu$ 和 $\\theta$ 表示。\n\n通过将数值放大因子与连续方程的精确傅里叶放大进行比较，确定每个时间步的主阶相位误差，作为 $\\mu$ 和 $\\theta$ 的解析函数。你的最终答案必须是给出主阶相位误差的单一闭式表达式，用 $\\mu$ 和 $\\theta$ 表示。不需要四舍五入，最终答案中不应包含物理单位。",
            "solution": "本问题要求推导应用于一维线性平流方程 $u_{t} + c\\,u_{x} = 0$ 的 Lax-Wendroff 数值格式的主阶相位误差。\n\n首先，我们构建 Lax-Wendroff 格式。我们从解 $u(x,t)$ 在时间上围绕 $t$ 的二阶泰勒级数展开开始：\n$$u(x, t+\\Delta t) = u(x,t) + \\Delta t \\, u_{t}(x,t) + \\frac{(\\Delta t)^2}{2} u_{tt}(x,t) + O((\\Delta t)^3)$$\n根据控制偏微分方程，$u_t = -c u_x$。我们可以通过对该偏微分方程关于时间求导来找到二阶时间导数，假设 $c$ 是常数：\n$$u_{tt} = \\frac{\\partial}{\\partial t}(-c u_x) = -c \\frac{\\partial u_x}{\\partial t} = -c \\frac{\\partial u_t}{\\partial x}$$\n再次代入 $u_t = -c u_x$，我们得到：\n$$u_{tt} = -c \\frac{\\partial}{\\partial x}(-c u_x) = c^2 u_{xx}$$\n将 $u_t$ 和 $u_{tt}$ 的表达式代回泰勒展开式，得到：\n$$u(x, t+\\Delta t) = u(x,t) - c\\,\\Delta t\\,u_x + \\frac{(c\\,\\Delta t)^2}{2} u_{xx} + O((\\Delta t)^3)$$\n现在，我们在均匀网格上离散化该方程，其中 $x_j = j\\,\\Delta x$，$t_n = n\\,\\Delta t$。令 $u_j^n \\approx u(x_j, t_n)$。我们使用二阶中心有限差分来近似空间导数：\n$$u_x(x_j, t_n) \\approx \\frac{u_{j+1}^n - u_{j-1}^n}{2\\,\\Delta x}$$\n$$u_{xx}(x_j, t_n) \\approx \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\\Delta x)^2}$$\n将这些离散化代入时间展开的方程中，得到数值格式：\n$$u_j^{n+1} = u_j^n - c\\,\\Delta t \\left( \\frac{u_{j+1}^n - u_{j-1}^n}{2\\,\\Delta x} \\right) + \\frac{(c\\,\\Delta t)^2}{2} \\left( \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\\Delta x)^2} \\right)$$\n引入 Courant–Friedrichs–Lewy (CFL) 数 $\\mu = \\frac{c\\,\\Delta t}{\\Delta x}$，我们可以更紧凑地写出该格式：\n$$u_j^{n+1} = u_j^n - \\frac{\\mu}{2}(u_{j+1}^n - u_{j-1}^n) + \\frac{\\mu^2}{2}(u_{j+1}^n - 2u_j^n + u_{j-1}^n)$$\n这就是 Lax-Wendroff 格式。\n\n接下来，我们进行 von Neumann 稳定性分析以求得放大因子。我们将离散傅里叶模 $u_j^n = \\hat{u}^n \\exp(i\\,j\\,\\theta)$ 代入格式中，其中 $\\theta = k\\,\\Delta x$ 是无量纲波数。下一个时间步的解是 $u_j^{n+1} = G(\\theta)\\,\\hat{u}^n \\exp(i\\,j\\,\\theta)$，其中 $G(\\theta)$ 是放大因子。\n$$G\\,\\hat{u}^n e^{ij\\theta} = \\hat{u}^n e^{ij\\theta} - \\frac{\\mu}{2}(\\hat{u}^n e^{i(j+1)\\theta} - \\hat{u}^n e^{i(j-1)\\theta}) + \\frac{\\mu^2}{2}(\\hat{u}^n e^{i(j+1)\\theta} - 2\\hat{u}^n e^{ij\\theta} + \\hat{u}^n e^{i(j-1)\\theta})$$\n除以 $\\hat{u}^n e^{ij\\theta}$：\n$$G(\\theta) = 1 - \\frac{\\mu}{2}(e^{i\\theta} - e^{-i\\theta}) + \\frac{\\mu^2}{2}(e^{i\\theta} - 2 + e^{-i\\theta})$$\n使用恒等式 $e^{i\\theta} - e^{-i\\theta} = 2i\\sin\\theta$ 和 $e^{i\\theta} + e^{-i\\theta} = 2\\cos\\theta$：\n$$G(\\theta) = 1 - i\\mu\\sin\\theta + \\mu^2(\\cos\\theta - 1)$$\n这是 Lax-Wendroff 格式的离散放大因子。\n\n现在我们将其与精确放大因子进行比较。对于初始条件 $u(x,0) = \\exp(ikx)$，方程 $u_t + c u_x = 0$ 的精确解是 $u(x,t) = \\exp(ik(x-ct))$。在一个时间步长 $\\Delta t$ 内的放大是：\n$$G_{exact} = \\frac{u(x, t+\\Delta t)}{u(x,t)} = \\frac{\\exp(ik(x-c(t+\\Delta t)))}{\\exp(ik(x-ct))} = \\exp(-ikc\\Delta t)$$\n代入 $k = \\theta/\\Delta x$ 和 $c\\Delta t = \\mu\\Delta x$：\n$$G_{exact} = \\exp\\left(-i\\,\\frac{\\theta}{\\Delta x}\\,\\mu\\,\\Delta x\\right) = \\exp(-i\\mu\\theta)$$\n精确解是一个纯相位移动，其 $|G_{exact}| = 1$。每个时间步的精确相位变化是 $\\phi_{exact} = \\arg(G_{exact}) = -\\mu\\theta$。\n\n每个时间步的相位误差是 $\\Delta\\phi = \\phi_{num} - \\phi_{exact}$，其中 $\\phi_{num} = \\arg(G(\\theta))$。该误差也由数值放大因子与精确放大因子之比的辐角给出：\n$$\\Delta\\phi = \\arg\\left(\\frac{G(\\theta)}{G_{exact}}\\right) = \\arg(G(\\theta) \\exp(i\\mu\\theta))$$\n为了找到主阶相位误差，我们将 $G(\\theta)$ 和 $\\exp(i\\mu\\theta)$ 展成关于小 $\\theta$ 的泰勒级数：\n$$\\sin\\theta = \\theta - \\frac{\\theta^3}{6} + O(\\theta^5)$$\n$$\\cos\\theta - 1 = -\\frac{\\theta^2}{2} + \\frac{\\theta^4}{24} + O(\\theta^6)$$\n代入 $G(\\theta)$：\n$$G(\\theta) = 1 - i\\mu\\left(\\theta - \\frac{\\theta^3}{6} + \\dots\\right) + \\mu^2\\left(-\\frac{\\theta^2}{2} + \\frac{\\theta^4}{24} + \\dots\\right)$$\n$$G(\\theta) = 1 - i\\mu\\theta - \\frac{\\mu^2\\theta^2}{2} + i\\frac{\\mu\\theta^3}{6} + O(\\theta^4)$$\n$\\exp(i\\mu\\theta)$ 的展开式是：\n$$\\exp(i\\mu\\theta) = 1 + i\\mu\\theta - \\frac{(\\mu\\theta)^2}{2} - i\\frac{(\\mu\\theta)^3}{6} + O(\\theta^4)$$\n现在，我们计算乘积 $G(\\theta)\\exp(i\\mu\\theta)$：\n$$G(\\theta)\\exp(i\\mu\\theta) = \\left(1 - i\\mu\\theta - \\frac{\\mu^2\\theta^2}{2} + i\\frac{\\mu\\theta^3}{6} + \\dots\\right) \\left(1 + i\\mu\\theta - \\frac{\\mu^2\\theta^2}{2} - i\\frac{\\mu^3\\theta^3}{6} + \\dots\\right)$$\n我们按 $\\theta$ 的阶数收集各项：\n- 常数项：$1 \\times 1 = 1$。\n- $\\theta^1$ 项：$1 \\times (i\\mu\\theta) + (-i\\mu\\theta) \\times 1 = 0$。\n- $\\theta^2$ 项：$1 \\times (-\\frac{\\mu^2\\theta^2}{2}) + (-i\\mu\\theta) \\times (i\\mu\\theta) + (-\\frac{\\mu^2\\theta^2}{2}) \\times 1 = -\\frac{\\mu^2\\theta^2}{2} + \\mu^2\\theta^2 - \\frac{\\mu^2\\theta^2}{2} = 0$。\n$\\theta^1$ 和 $\\theta^2$ 项的抵消证实了该格式是二阶精度的。主误差项将是 $\\theta^3$ 阶的。\n- $\\theta^3$ 项（只收集虚部，因为实部将是更高阶的）：\n$$1 \\times \\left(-i\\frac{\\mu^3\\theta^3}{6}\\right) + (-i\\mu\\theta) \\times \\left(-\\frac{\\mu^2\\theta^2}{2}\\right) + \\left(-\\frac{\\mu^2\\theta^2}{2}\\right) \\times (i\\mu\\theta) + \\left(i\\frac{\\mu\\theta^3}{6}\\right) \\times 1$$\n$$= i\\theta^3 \\left(-\\frac{\\mu^3}{6} + \\frac{\\mu^3}{2} - \\frac{\\mu^3}{2} + \\frac{\\mu}{6}\\right) = i\\theta^3 \\left(\\frac{\\mu - \\mu^3}{6}\\right) = i\\frac{\\mu(1-\\mu^2)}{6}\\theta^3$$\n所以，对于小 $\\theta$：\n$$\\frac{G(\\theta)}{G_{exact}} \\approx 1 + i\\frac{\\mu(1-\\mu^2)}{6}\\theta^3$$\n对于复数 $z = 1 + iy$，当 $y \\ll 1$ 时，其辐角为 $\\arg(z) \\approx \\arctan(y) \\approx y$。因此，主阶相位误差是：\n$$\\Delta\\phi \\approx \\frac{\\mu(1-\\mu^2)}{6}\\theta^3$$\n该表达式代表了 Lax-Wendroff 格式每个时间步的主阶相位误差。",
            "answer": "$$\\boxed{\\frac{\\mu(1-\\mu^2)}{6}\\theta^3}$$"
        }
    ]
}