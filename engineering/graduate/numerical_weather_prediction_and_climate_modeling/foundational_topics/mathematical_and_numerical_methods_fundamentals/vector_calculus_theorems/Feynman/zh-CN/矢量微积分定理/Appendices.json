{
    "hands_on_practices": [
        {
            "introduction": "高斯散度定理是将体积积分与面积分联系起来的基石，它在推导物理守恒定律中扮演着核心角色。本练习将该定理应用于一个典型的数值天气预报场景——有限区域模型，以计算模型区域内总大气质量的变化率。通过这个实践，您将把抽象的数学定理与追踪模型中守恒量（如质量）的实际任务联系起来，从而深入理解守恒定律的积分形式。",
            "id": "4109033",
            "problem": "在用于数值天气预报（NWP）的局地模式（LAM）中，考虑一个半径为 $R$、高度为 $H$ 的圆柱形区域，其体积为 $V$，边界 $\\partial V$ 由位于 $r=R$ 的侧面 $S_{\\mathrm{side}}$、位于 $z=H$ 的顶盖 $S_{\\mathrm{top}}$ 和位于 $z=0$ 的底盖 $S_{\\mathrm{bottom}}$ 组成。空气密度分层表示为 $\\rho(z)=\\rho_{s}\\,\\exp(-z/H_{d})$，其中 $\\rho_{s}$ 是地面密度， $H_{d}$ 是密度尺度高度。侧边界上的速度场是纯径向的，为 $u_{r}(\\theta,z)=U_{m}+U_{a}\\cos\\theta$，其中 $\\theta$ 是以弧度为单位的方位角。在顶盖 $S_{\\mathrm{top}}$ 和底盖 $S_{\\mathrm{bottom}}$ 上，垂直速度满足 $\\mathbf{u}\\cdot\\mathbf{n}=0$（刚性盖条件），因此没有垂直质量通量穿过顶部和底部边界。\n\n从局地质量守恒方程 $\\partial_{t}\\rho+\\nabla\\cdot(\\rho\\mathbf{u})=0$ 出发，对体积 $V$ 应用散度定理，推导区域平均的整层质量趋势 $\\partial_{t}M_{\\mathrm{col}}$ 的表达式，其中 $M_{\\mathrm{col}}=\\frac{1}{A}\\int_{V}\\rho\\,dV$ 且 $A=\\pi R^{2}$ 是该区域的水平面积。在进行边界通量计算时，通过考虑 $S_{\\mathrm{side}}$ 上 $\\mathbf{u}\\cdot\\mathbf{n}$ 的符号来明确处理侧向流入和流出。\n\n使用以下参数值，这些值对于中尺度大气体积是科学上合理的：$R=1.0\\times 10^{5}\\,\\mathrm{m}$，$H=1.0\\times 10^{4}\\,\\mathrm{m}$，$\\rho_{s}=1.2\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$，$H_{d}=8.0\\times 10^{3}\\,\\mathrm{m}$，$U_{m}=0.5\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$，以及 $U_{a}=1.5\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$。将您的最终答案四舍五入到四位有效数字，并以 $\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$ 为单位表示。角度 $\\theta$ 应以弧度处理。",
            "solution": "首先验证问题，以确保其具有科学依据、适定且客观。\n\n**步骤1：提取已知条件**\n- 区域：半径为 $R$、高度为 $H$ 的圆柱体。\n- 体积：$V$。\n- 边界：$\\partial V = S_{\\mathrm{side}} \\cup S_{\\mathrm{top}} \\cup S_{\\mathrm{bottom}}$。\n- 侧面：$S_{\\mathrm{side}}$，位于 $r=R$。\n- 顶盖：$S_{\\mathrm{top}}$，位于 $z=H$。\n- 底盖：$S_{\\mathrm{bottom}}$，位于 $z=0$。\n- 空气密度：$\\rho(z)=\\rho_{s}\\,\\exp(-z/H_{d})$。\n- 侧面 $S_{\\mathrm{side}}$ 上的速度场：纯径向，$u_{r}(\\theta,z)=U_{m}+U_{a}\\cos\\theta$。\n- 盖上的边界条件：在 $S_{\\mathrm{top}}$ 和 $S_{\\mathrm{bottom}}$ 上 $\\mathbf{u}\\cdot\\mathbf{n}=0$。\n- 控制方程：局地质量守恒，$\\partial_{t}\\rho+\\nabla\\cdot(\\rho\\mathbf{u})=0$。\n- 待求量：区域平均的整层质量趋势，$\\partial_{t}M_{\\mathrm{col}}$。\n- 定义：$M_{\\mathrm{col}}=\\frac{1}{A}\\int_{V}\\rho\\,dV$，其中 $A=\\pi R^{2}$。\n- 参数值：$R=1.0\\times 10^{5}\\,\\mathrm{m}$，$H=1.0\\times 10^{4}\\,\\mathrm{m}$，$\\rho_{s}=1.2\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$，$H_{d}=8.0\\times 10^{3}\\,\\mathrm{m}$，$U_{m}=0.5\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$，$U_{a}=1.5\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，使用了质量守恒基本原理（连续性方程）和标准的大气密度模型。该问题是适定的，提供了得出唯一解所需的所有信息、方程和边界条件。语言客观、精确。参数对于中尺度大气模型是物理上现实的。因此，该问题被认定为有效。\n\n**步骤3：结论与行动**\n问题有效。将提供完整解答。\n\n**求解过程**\n\n推导从局地质量守恒方程（连续性方程）开始：\n$$ \\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{u}) = 0 $$\n我们将此方程对整个圆柱体积 $V$ 进行积分：\n$$ \\int_V \\frac{\\partial \\rho}{\\partial t} \\, dV + \\int_V \\nabla \\cdot (\\rho \\mathbf{u}) \\, dV = 0 $$\n对于一个固定的控制体积，时间导数可以移到积分符号之外。第一项是体积中总质量 $M$ 的变化率，其中 $M = \\int_V \\rho \\, dV$。\n$$ \\frac{dM}{dt} = \\int_V \\frac{\\partial \\rho}{\\partial t} \\, dV $$\n第二项可以使用散度定理转换为在边界 $\\partial V$ 上的面积分：\n$$ \\int_V \\nabla \\cdot (\\rho \\mathbf{u}) \\, dV = \\oint_{\\partial V} (\\rho \\mathbf{u}) \\cdot \\mathbf{n} \\, dS $$\n其中 $\\mathbf{n}$ 是表面 $\\partial V$ 上指向外部的单位法向量。\n\n将这些代回到积分守恒方程中，得到质量守恒的积分形式：\n$$ \\frac{dM}{dt} = - \\oint_{\\partial V} (\\rho \\mathbf{u}) \\cdot \\mathbf{n} \\, dS $$\n这表明体积内质量的变化率等于进入该体积的净质量通量。问题要求的是区域平均的整层质量趋势，$\\partial_{t}M_{\\mathrm{col}}$。区域平均的整层质量 $M_{\\mathrm{col}}$ 定义为总质量 $M$ 除以区域的水平面积 $A = \\pi R^2$。\n$$ M_{\\mathrm{col}} = \\frac{M}{A} = \\frac{1}{A} \\int_V \\rho \\, dV $$\n因此，时间导数为：\n$$ \\frac{dM_{\\mathrm{col}}}{dt} = \\frac{1}{A} \\frac{dM}{dt} = - \\frac{1}{A} \\oint_{\\partial V} (\\rho \\mathbf{u}) \\cdot \\mathbf{n} \\, dS $$\n边界 $\\partial V$ 由三个面组成：顶盖 $S_{\\mathrm{top}}$、底盖 $S_{\\mathrm{bottom}}$ 和侧面 $S_{\\mathrm{side}}$。面积分可以相应地拆分为：\n$$ \\oint_{\\partial V} (\\rho \\mathbf{u}) \\cdot \\mathbf{n} \\, dS = \\int_{S_{\\mathrm{top}}} (\\rho \\mathbf{u}) \\cdot \\mathbf{n} \\, dS + \\int_{S_{\\mathrm{bottom}}} (\\rho \\mathbf{u}) \\cdot \\mathbf{n} \\, dS + \\int_{S_{\\mathrm{side}}} (\\rho \\mathbf{u}) \\cdot \\mathbf{n} \\, dS $$\n问题说明顶部和底部边界的垂直速度分量为零，即在 $S_{\\mathrm{top}}$ 和 $S_{\\mathrm{bottom}}$ 上 $\\mathbf{u} \\cdot \\mathbf{n} = 0$。这就是刚性盖条件，意味着没有质量通量穿过这些表面。因此，前两个积分为零。\n整层质量趋势的表达式简化为仅通过侧面的通量：\n$$ \\frac{dM_{\\mathrm{col}}}{dt} = - \\frac{1}{A} \\int_{S_{\\mathrm{side}}} (\\rho \\mathbf{u}) \\cdot \\mathbf{n} \\, dS $$\n我们现在计算在 $S_{\\mathrm{side}}$ 上的积分。在柱坐标系 $(r, \\theta, z)$ 中，侧面位于 $r=R$。\n向外的单位法向量是 $\\mathbf{n} = \\hat{\\mathbf{r}}$。\n此表面上的速度场被给定为纯径向的：$\\mathbf{u} = u_r \\hat{\\mathbf{r}} = (U_m + U_a \\cos\\theta)\\hat{\\mathbf{r}}$。\n微分表面积元是 $dS = R \\, d\\theta \\, dz$。\n被积函数变为：\n$$ (\\rho \\mathbf{u}) \\cdot \\mathbf{n} = \\rho(z) u_r = \\rho_{s}\\,\\exp(-z/H_{d}) (U_m + U_a \\cos\\theta) $$\n在 $S_{\\mathrm{side}}$ 上的积分是：\n$$ \\int_{S_{\\mathrm{side}}} (\\rho \\mathbf{u}) \\cdot \\mathbf{n} \\, dS = \\int_{0}^{H} \\int_{0}^{2\\pi} \\left[ \\rho_{s}\\,\\exp(-z/H_{d}) (U_m + U_a \\cos\\theta) \\right] R \\, d\\theta \\, dz $$\n我们可以将关于 $z$ 和 $\\theta$ 的积分分开：\n$$ = R \\rho_s \\left( \\int_{0}^{H} \\exp(-z/H_{d}) \\, dz \\right) \\left( \\int_{0}^{2\\pi} (U_m + U_a \\cos\\theta) \\, d\\theta \\right) $$\n首先，我们计算关于 $\\theta$ 的积分：\n$$ \\int_{0}^{2\\pi} (U_m + U_a \\cos\\theta) \\, d\\theta = \\int_{0}^{2\\pi} U_m \\, d\\theta + \\int_{0}^{2\\pi} U_a \\cos\\theta \\, d\\theta = [U_m \\theta]_{0}^{2\\pi} + [U_a \\sin\\theta]_{0}^{2\\pi} = 2\\pi U_m + 0 = 2\\pi U_m $$\n这个结果明确地处理了侧边界上的流入和流出条件。随 $\\cos\\theta$ 变化的流分量导致了流入和流出区域，但其对整个圆柱边界上的总质量通量的净贡献为零。净通量仅由平均径向速度 $U_m$ 决定。\n\n接下来，我们计算关于 $z$ 的积分：\n$$ \\int_{0}^{H} \\exp(-z/H_{d}) \\, dz = \\left[-H_d \\exp(-z/H_d)\\right]_{0}^{H} = -H_d (\\exp(-H/H_d) - \\exp(0)) = H_d (1 - \\exp(-H/H_d)) $$\n结合这些结果，总的侧向质量通量为：\n$$ \\int_{S_{\\mathrm{side}}} (\\rho \\mathbf{u}) \\cdot \\mathbf{n} \\, dS = R \\rho_s \\left( H_d (1 - \\exp(-H/H_d)) \\right) (2\\pi U_m) = 2\\pi R \\rho_s U_m H_d (1 - \\exp(-H/H_d)) $$\n现在，我们将此结果代回到整层质量趋势的表达式中，并使用 $A = \\pi R^2$：\n$$ \\frac{dM_{\\mathrm{col}}}{dt} = - \\frac{1}{\\pi R^2} \\left[ 2\\pi R \\rho_s U_m H_d (1 - \\exp(-H/H_d)) \\right] $$\n化简后，我们得到最终的符号表达式：\n$$ \\frac{dM_{\\mathrm{col}}}{dt} = - \\frac{2 \\rho_s U_m H_d}{R} (1 - \\exp(-H/H_d)) $$\n负号表示对于正的平均流出（$U_m > 0$），整层质量会减少。\n\n最后，我们代入给定的数值：\n$R = 1.0 \\times 10^5 \\, \\mathrm{m}$\n$H = 1.0 \\times 10^4 \\, \\mathrm{m}$\n$\\rho_s = 1.2 \\, \\mathrm{kg}\\,\\mathrm{m}^{-3}$\n$H_d = 8.0 \\times 10^3 \\, \\mathrm{m}$\n$U_m = 0.5 \\, \\mathrm{m}\\,\\mathrm{s}^{-1}$\n$U_a = 1.5 \\, \\mathrm{m}\\,\\mathrm{s}^{-1}$ 的值对于计算净通量不是必需的。\n\n首先，计算无量纲指数：\n$$ \\frac{H}{H_d} = \\frac{1.0 \\times 10^4}{8.0 \\times 10^3} = 1.25 $$\n现在计算表达式中的各项：\n$$ \\frac{dM_{\\mathrm{col}}}{dt} = - \\frac{2 \\times (1.2) \\times (0.5) \\times (8.0 \\times 10^3)}{1.0 \\times 10^5} (1 - \\exp(-1.25)) $$\n$$ \\frac{dM_{\\mathrm{col}}}{dt} = - \\frac{9600}{1.0 \\times 10^5} (1 - \\exp(-1.25)) $$\n$$ \\frac{dM_{\\mathrm{col}}}{dt} = -0.096 \\times (1 - 0.28650479...) $$\n$$ \\frac{dM_{\\mathrm{col}}}{dt} = -0.096 \\times (0.71349520...) $$\n$$ \\frac{dM_{\\mathrm{col}}}{dt} \\approx -0.068495539 \\, \\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1} $$\n将结果四舍五入到四位有效数字，得到 $-0.06850 \\, \\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$。用标准科学记数法表示，即为 $-6.850 \\times 10^{-2} \\, \\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$。",
            "answer": "$$\\boxed{-6.850 \\times 10^{-2}}$$"
        },
        {
            "introduction": "理解了积分形式的守恒定律后，下一步是探究这些定律如何在数值模型中实现。本练习将演示如何从高斯散度定理出发，构建一个有限体积离散散度算子，这是现代守恒型数值模型的基石。您还将证明该离散格式具有“伸缩求和”的特性，这一特性确保了数值方案在全局范围内精确守恒，这对于长期气候模拟至关重要。",
            "id": "4108983",
            "problem": "在用于数值天气预报（NWP）的有限体积动力核心中，通过在网格单元上强制执行广延量的积分守恒来推进预报方程。考虑一个矩形域 $[0,L_{x}]\\times[0,L_{y}]\\times[0,L_{z}]$，该域由一个均匀的直线网格离散化，包含 $N_{x}\\times N_{y}\\times N_{z}$ 个控制体积，其尺寸为 $\\Delta x=L_{x}/N_{x}$、$\\Delta y=L_{y}/N_{y}$、$\\Delta z=L_{z}/N_{z}$，单元体积为 $\\Delta V=\\Delta x\\,\\Delta y\\,\\Delta z$。设 $\\mathbf{F}(x,y,z)$ 表示一个在空间上光滑的面法向通量密度场（例如，质量或示踪剂通量密度）。\n\n从一个通量为 $\\mathbf{F}$ 且无源的被动示踪剂的积分守恒定律出发，\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\int_{V}\\!q\\,\\mathrm{d}V \\;=\\; -\\oint_{\\partial V}\\!\\mathbf{F}\\cdot\\mathbf{n}\\,\\mathrm{d}S,\n$$\n并利用 Gauss 散度定理作为体积分和面积分之间的基本桥梁，推导在此网格上散度 $\\nabla\\cdot\\mathbf{F}$ 的一个二阶精度有限体积离散表示，该表示使用在单元面上求值的、朝外的面法向通量和精确的面面积。然后，通过将此离散散度在域内所有控制体积上求和（每一项乘以其体积），证明所有内面的贡献都精确抵消，从而使剩余的总和仅为域物理边界面上的通量之和。\n\n最后，将您的结果应用于人工通量场\n$$\n\\mathbf{F}(x,y,z)\\;=\\;\\big(a\\,x,\\;b\\,y,\\;c\\,z\\big),\n$$\n其中 $a=2.0\\times 10^{-7}$，$b=3.0\\times 10^{-7}$，$c=4.0\\times 10^{-7}$ (单位均为 $\\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$，因此 $\\mathbf{F}$ 的单位为 $\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$)，域维度为 $L_{x}=6.0\\times 10^{5}$，$L_{y}=4.0\\times 10^{5}$，$L_{z}=1.0\\times 10^{4}$ (单位为 $\\mathrm{m}$)。取 $N_{x}=60$，$N_{y}=40$，$N_{z}=20$。使用您的离散伸缩求和结果，计算由所有单元上离散散度之和所隐含的通过整个域边界的净向外通量，并以 $\\mathrm{kg}\\,\\mathrm{s}^{-1}$ 为单位表示最终答案。将您的答案四舍五入到三位有效数字。所有出现的角度（如果有）都应以弧度表示。",
            "solution": "该问题要求完成三个主要任务：首先，推导散度 $\\nabla\\cdot\\mathbf{F}$ 的二阶精度有限体积离散表示；其次，证明此离散散度在所有网格单元上的和可以伸缩求和为域边界面上的和；第三，应用此结果计算给定人工通量场 $\\mathbf{F}$ 的总净向外通量。\n\n让我们考虑一个单一的控制体积（或网格单元）$V_{i,j,k}$，其中指标 $i \\in \\{1,...,N_x\\}$，$j \\in \\{1,...,N_y\\}$，$k \\in \\{1,...,N_z\\}$。在一个均匀的直线网格上，该单元占据空间 $[x_{i-1/2}, x_{i+1/2}] \\times [y_{j-1/2}, y_{j+1/2}] \\times [z_{k-1/2}, z_{k+1/2}]$，其中面的位置由 $x_{i \\pm 1/2}$，$y_{j \\pm 1/2}$ 和 $z_{k \\pm 1/2}$ 给出。对于域 $[0,L_{x}]\\times[0,L_{y}]\\times[0,L_{z}]$，我们可以将面坐标定义为 $x_{i-1/2} = (i-1)\\Delta x$，$y_{j-1/2} = (j-1)\\Delta y$ 和 $z_{k-1/2} = (k-1)\\Delta z$。单元的体积是 $\\Delta V = \\Delta x \\Delta y \\Delta z$。\n\n**第一部分：离散散度的推导**\n\n体积 $V$ 内矢量场 $\\mathbf{F}$ 的散度与该场通过体积边界面 $\\partial V$ 的通量之间的基本关系由 Gauss 散度定理给出：\n$$\n\\int_{V} \\nabla\\cdot\\mathbf{F} \\, \\mathrm{d}V = \\oint_{\\partial V} \\mathbf{F}\\cdot\\mathbf{n} \\, \\mathrm{d}S\n$$\n其中 $\\mathbf{n}$ 是边界面 $\\partial V$ 上指向外部的单位法向量。\n\n在有限体积法中，我们将单元平均散度（记为 $(\\nabla\\cdot\\mathbf{F})_{i,j,k}$）定义为：\n$$\n(\\nabla\\cdot\\mathbf{F})_{i,j,k} = \\frac{1}{\\Delta V} \\int_{V_{i,j,k}} \\nabla\\cdot\\mathbf{F} \\, \\mathrm{d}V\n$$\n将散度定理应用于单元 $V_{i,j,k}$，我们得到：\n$$\n(\\nabla\\cdot\\mathbf{F})_{i,j,k} = \\frac{1}{\\Delta V} \\oint_{\\partial V_{i,j,k}} \\mathbf{F}\\cdot\\mathbf{n} \\, \\mathrm{d}S\n$$\n右侧的面积分是对矩形单元的六个面进行的。我们可以将其表示为通过每个面的通量之和。设 $\\mathbf{F} = (F_x, F_y, F_z)$。该面积分为：\n$$\n\\begin{align*} \\oint_{\\partial V_{i,j,k}} \\mathbf{F}\\cdot\\mathbf{n} \\, \\mathrm{d}S =  \\int_{y_{j-1/2}}^{y_{j+1/2}}\\int_{z_{k-1/2}}^{z_{k+1/2}} F_x(x_{i+1/2},y,z) \\, \\mathrm{d}z\\mathrm{d}y \\\\ - \\int_{y_{j-1/2}}^{y_{j+1/2}}\\int_{z_{k-1/2}}^{z_{k+1/2}} F_x(x_{i-1/2},y,z) \\, \\mathrm{d}z\\mathrm{d}y \\\\ + \\int_{x_{i-1/2}}^{x_{i+1/2}}\\int_{z_{k-1/2}}^{z_{k+1/2}} F_y(x,y_{j+1/2},z) \\, \\mathrm{d}z\\mathrm{d}x \\\\ - \\int_{x_{i-1/2}}^{x_{i+1/2}}\\int_{z_{k-1/2}}^{z_{k+1/2}} F_y(x,y_{j-1/2},z) \\, \\mathrm{d}z\\mathrm{d}x \\\\ + \\int_{x_{i-1/2}}^{x_{i+1/2}}\\int_{y_{j-1/2}}^{y_{j+1/2}} F_z(x,y,z_{k+1/2}) \\, \\mathrm{d}y\\mathrm{d}x \\\\ - \\int_{x_{i-1/2}}^{x_{i+1/2}}\\int_{y_{j-1/2}}^{y_{j+1/2}} F_z(x,y,z_{k-1/2}) \\, \\mathrm{d}y\\mathrm{d}x \\end{align*}\n$$\n问题陈述我们应该使用在单元面上求值的通量。这对应于使用中点法则来近似每个面积分，该法则是二阶精度的。例如，对“右”面（在 $x=x_{i+1/2}$ 处）的积分近似为：\n$$\n\\int_{y_{j-1/2}}^{y_{j+1/2}}\\int_{z_{k-1/2}}^{z_{k+1/2}} F_x(x_{i+1/2},y,z) \\, \\mathrm{d}z\\mathrm{d}y \\approx F_x(x_{i+1/2},y_j,z_k) \\Delta y \\Delta z\n$$\n其中 $(x_{i+1/2}, y_j, z_k)$ 是面的中心。我们将此面中心的通量值记为 $(F_x)_{i+1/2,j,k}$。面面积为 $\\Delta S_x = \\Delta y \\Delta z$，$\\Delta S_y = \\Delta x \\Delta z$ 和 $\\Delta S_z = \\Delta x \\Delta y$。将此近似应用于所有六个面，总向外通量变为：\n$$\n\\oint_{\\partial V_{i,j,k}} \\mathbf{F}\\cdot\\mathbf{n} \\, \\mathrm{d}S \\approx \\left[ (F_x)_{i+1/2,j,k} - (F_x)_{i-1/2,j,k} \\right]\\Delta y \\Delta z + \\left[ (F_y)_{i,j+1/2,k} - (F_y)_{i,j-1/2,k} \\right]\\Delta x \\Delta z + \\left[ (F_z)_{i,j,k+1/2} - (F_z)_{i,j,k-1/2} \\right]\\Delta x \\Delta y\n$$\n将此代入离散散度的表达式中，并使用 $\\Delta V = \\Delta x \\Delta y \\Delta z$，便得到我们所求的表示：\n$$\n(\\nabla\\cdot\\mathbf{F})_{i,j,k} = \\frac{(F_x)_{i+1/2,j,k} - (F_x)_{i-1/2,j,k}}{\\Delta x} + \\frac{(F_y)_{i,j+1/2,k} - (F_y)_{i,j-1/2,k}}{\\Delta y} + \\frac{(F_z)_{i,j,k+1/2} - (F_z)_{i,j,k-1/2}}{\\Delta z}\n$$\n这是均匀网格上散度的二阶精度离散化。\n\n**第二部分：伸缩求和的证明**\n\n问题要求将离散散度在所有控制体积上求和，每一项乘以其体积 $\\Delta V$。设此和为 $\\Phi_{total}$。\n$$\n\\Phi_{total} = \\sum_{i=1}^{N_x} \\sum_{j=1}^{N_y} \\sum_{k=1}^{N_z} (\\nabla\\cdot\\mathbf{F})_{i,j,k} \\Delta V\n$$\n使用通量积分的中间表达式，我们有：\n$$\n(\\nabla\\cdot\\mathbf{F})_{i,j,k} \\Delta V = \\left[ (F_x)_{i+1/2,j,k} - (F_x)_{i-1/2,j,k} \\right]\\Delta S_x + \\left[ (F_y)_{i,j+1/2,k} - (F_y)_{i,j-1/2,k} \\right]\\Delta S_y + \\left[ (F_z)_{i,j,k+1/2} - (F_z)_{i,j,k-1/2} \\right]\\Delta S_z\n$$\n让我们分析 $x$ 分量项的和：\n$$\n\\sum_{i=1}^{N_x} \\sum_{j=1}^{N_y} \\sum_{k=1}^{N_z} \\left[ (F_x)_{i+1/2,j,k} - (F_x)_{i-1/2,j,k} \\right]\\Delta S_x\n$$\n考虑对于固定的 $j$ 和 $k$，对指标 $i$ 的最内层求和：\n$$\n\\sum_{i=1}^{N_x} \\left[ (F_x)_{i+1/2,j,k} - (F_x)_{i-1/2,j,k} \\right]\n$$\n这是一个伸缩求和。我们将其展开：\n$$\n\\left((F_x)_{3/2} - (F_x)_{1/2}\\right) + \\left((F_x)_{5/2} - (F_x)_{3/2}\\right) + \\dots + \\left((F_x)_{N_x+1/2} - (F_x)_{N_x-1/2}\\right)\n$$\n任何内面 $(F_x)_{i+1/2,j,k}$ 处的通量，对于单元 $(i,j,k)$ 是向外的通量，贡献为正号。对于相邻的单元 $(i+1,j,k)$，同一个面是它的左面 $x_{(i+1)-1/2}$，其通量贡献为负号。因此，所有内面的贡献都相互抵消。唯一保留下来的项来自域边界上的面：第一个面 $i=1/2$（即 $x=0$）和最后一个面 $i=N_x+1/2$（即 $x=L_x$）。和简化为：\n$$\n(F_x)_{N_x+1/2,j,k} - (F_x)_{1/2,j,k}\n$$\n因此，$x$分量的总和是在 $x=L_x$ 和 $x=0$ 处边界面上的通量之和：\n$$\n\\sum_{j=1}^{N_y} \\sum_{k=1}^{N_z} \\left[ (F_x)_{N_x+1/2,j,k} - (F_x)_{1/2,j,k} \\right]\\Delta S_x\n$$\n同理，$y$ 和 $z$分量的求和也是伸缩求和，只留下通过 $y=0, L_y$ 和 $z=0, L_z$ 面的通量。总和 $\\Phi_{total}$ 是整个域 $[0,L_x]\\times[0,L_y]\\times[0,L_z]$ 所有边界面上的向外通量之和。这证明了离散求和是守恒的，并且等效于全局边界上的面积分，这与整个域的 Gauss 散度定理相呼应。\n\n**第三部分：应用于人工通量场**\n\n给定通量场 $\\mathbf{F}(x,y,z) = (ax, by, cz)$。其连续散度为 $\\nabla\\cdot\\mathbf{F} = \\frac{\\partial(ax)}{\\partial x} + \\frac{\\partial(by)}{\\partial y} + \\frac{\\partial(cz)}{\\partial z} = a+b+c$。由于散度是常数，精确的总净向外通量 $\\Phi$ 就是散度乘以总体积 $V = L_x L_y L_z$：\n$$\n\\Phi = \\int_{V} \\nabla\\cdot\\mathbf{F} \\, \\mathrm{d}V = (a+b+c)V = (a+b+c)L_x L_y L_z\n$$\n对于这个线性通量场，我们的二阶离散算子是精确的。在面 $x_{i+1/2}=i\\Delta x$ 处的通量是 $(F_x)_{i+1/2,j,k} = a(i\\Delta x)$。在面 $x_{i-1/2}=(i-1)\\Delta x$ 处的通量是 $(F_x)_{i-1/2,j,k} = a((i-1)\\Delta x)$。离散的 $x$ 方向导数为 $\\frac{a(i\\Delta x) - a((i-1)\\Delta x)}{\\Delta x} = a$。类似地，其他项为 $b$ 和 $c$。因此，对于所有单元，$(\\nabla\\cdot\\mathbf{F})_{i,j,k} = a+b+c$。\n总和为 $\\Phi_{total} = \\sum_{i,j,k} (a+b+c)\\Delta V = (a+b+c)\\sum_{i,j,k}\\Delta V = (a+b+c)L_x L_y L_z$。离散计算得出了精确的连续结果。\n\n现在，我们代入给定的数值：\n$a = 2.0 \\times 10^{-7} \\, \\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$\n$b = 3.0 \\times 10^{-7} \\, \\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$\n$c = 4.0 \\times 10^{-7} \\, \\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$\n$L_x = 6.0 \\times 10^5 \\, \\mathrm{m}$\n$L_y = 4.0 \\times 10^5 \\, \\mathrm{m}$\n$L_z = 1.0 \\times 10^4 \\, \\mathrm{m}$\n\n首先，计算散度常数之和：\n$$\na+b+c = (2.0 + 3.0 + 4.0) \\times 10^{-7} = 9.0 \\times 10^{-7} \\, \\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}\n$$\n接下来，计算域的总体积：\n$$\nV = L_x L_y L_z = (6.0 \\times 10^5 \\, \\mathrm{m}) \\times (4.0 \\times 10^5 \\, \\mathrm{m}) \\times (1.0 \\times 10^4 \\, \\mathrm{m})\n$$\n$$\nV = (6.0 \\times 4.0 \\times 1.0) \\times 10^{5+5+4} \\, \\mathrm{m}^3 = 24.0 \\times 10^{14} \\, \\mathrm{m}^3 = 2.4 \\times 10^{15} \\, \\mathrm{m}^3\n$$\n最后，计算总净向外通量 $\\Phi$：\n$$\n\\Phi = (a+b+c)V = (9.0 \\times 10^{-7} \\, \\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}) \\times (2.4 \\times 10^{15} \\, \\mathrm{m}^3)\n$$\n$$\n\\Phi = (9.0 \\times 2.4) \\times 10^{-7+15} \\, \\mathrm{kg}\\,\\mathrm{s}^{-1} = 21.6 \\times 10^{8} \\, \\mathrm{kg}\\,\\mathrm{s}^{-1}\n$$\n将此结果写成标准科学记数法：\n$$\n\\Phi = 2.16 \\times 10^9 \\, \\mathrm{kg}\\,\\mathrm{s}^{-1}\n$$\n问题要求将答案四舍五入到三位有效数字。计算值 $2.16 \\times 10^9$ 已经恰好是三位有效数字。",
            "answer": "$$\n\\boxed{2.16 \\times 10^9}\n$$"
        },
        {
            "introduction": "正如散度定理是质量守恒的基础，斯托克斯定理则是理解涡度动力学的关键。本练习将构建在Arakawa C-网格上的离散涡度算子，这是一种在现代大气和海洋模型中广泛使用的交错网格布局。通过这项实践，您将直接洞察流体的“旋转”是如何在实际的数值模型中计算的，从而将一个连续的数学定理与一个实用的计算工具联系起来。",
            "id": "4108981",
            "problem": "在数值天气预报 (NWP) 动力核心中，水平动量通常在 Arakawa C-网格 (C-网格) 上进行离散化，其中水平速度分量交错分布在网格单元的边缘：东西分量 $u$ 存储在水平边缘（南缘和北缘）的中心，南北分量 $v$ 存储在垂直边缘（西缘和东缘）的中心。考虑一个单一的矩形网格单元，其均匀间距为 $\\Delta x$ 和 $\\Delta y$，其边缘与坐标轴平行。网格单元中心 $(i,j)$ 是诸如涡度垂直分量等标量的位置。\n\n仅从连续形式的斯托克斯定理和标准定义出发，按以下步骤进行：\n\n1) 采用逆时针方向计算绕网格单元边界 $\\partial A_{i,j}$ 的环流，从连续形式的斯托克斯定理开始\n$$\n\\oint_{\\partial A_{i,j}} \\boldsymbol{u} \\cdot \\mathrm{d}\\boldsymbol{\\ell} \\;=\\; \\iint_{A_{i,j}} \\left( \\frac{\\partial v}{\\partial x} - \\frac{\\partial u}{\\partial y} \\right) \\,\\mathrm{d}A,\n$$\n通过在每个边缘上应用中点法则，使用 C-网格上配置在边缘上的值 $u_{i, j\\pm 1/2}$ 和 $v_{i\\pm 1/2, j}$，为环流构建一个二阶精度的离散近似。然后，将网格单元平均垂直涡度 $\\zeta_{i,j}$ 定义为离散环流除以网格单元面积 $\\Delta x \\,\\Delta y$。明确指出由逆时针路径方向所隐含的每个边缘贡献的正负号。\n\n2) 对于一个具体的、科学上合理的案例，其中均匀间距为 $\\Delta x = 1.0 \\times 10^{5}\\ \\mathrm{m}$ 和 $\\Delta y = 2.0 \\times 10^{5}\\ \\mathrm{m}$，并且网格单元 $(i,j)$ 处边缘中心的速率为\n$$\nu_{i, j+1/2} = 6.0\\ \\mathrm{m\\,s^{-1}},\\quad u_{i, j-1/2} = 2.0\\ \\mathrm{m\\,s^{-1}},\\quad v_{i+1/2, j} = 1.0\\ \\mathrm{m\\,s^{-1}},\\quad v_{i-1/2, j} = -3.0\\ \\mathrm{m\\,s^{-1}},\n$$\n计算从你的离散构造中得到的网格单元平均垂直涡度 $\\zeta_{i,j}$。\n\n用 $\\mathrm{s^{-1}}$ 单位表示你对 $\\zeta_{i,j}$ 的最终数值答案。无需四舍五入。",
            "solution": "该问题是有效的，因为它科学地基于矢量微积分和数值流体动力学的原理，是适定的（提供了所有必要信息），并且陈述客观。我们可以开始求解。\n\n问题要求做两件事：首先，从连续形式的斯托克斯定理推导出一个网格单元平均垂直涡度的离散近似；其次，为给定的一组参数计算其值。\n\n第 1 部分：离散垂直涡度的推导。\n\n我们从二维的连续形式斯托克斯定理开始，该定理将矢量场 $\\boldsymbol{u}$ 围绕闭合曲线 $\\partial A$ 的环流与 $\\boldsymbol{u}$ 的旋度在该曲线所围面积 $A$ 上的积分联系起来。对于二维速度场 $\\boldsymbol{u} = u\\hat{\\mathbf{i}} + v\\hat{\\mathbf{j}}$，旋度的垂直分量是 $\\left(\\nabla \\times \\boldsymbol{u}\\right)_z = \\frac{\\partial v}{\\partial x} - \\frac{\\partial u}{\\partial y}$。该定理表述为：\n$$\n\\oint_{\\partial A_{i,j}} \\boldsymbol{u} \\cdot \\mathrm{d}\\boldsymbol{\\ell} \\;=\\; \\iint_{A_{i,j}} \\left( \\frac{\\partial v}{\\partial x} - \\frac{\\partial u}{\\partial y} \\right) \\,\\mathrm{d}A\n$$\n左边的积分是环流，我们将其表示为 $C_{i,j}$。网格单元 $A_{i,j}$ 是一个宽度为 $\\Delta x$、高度为 $\\Delta y$ 的矩形。其角点分别位于 $(x_{i-1/2}, y_{j-1/2})$、$(x_{i+1/2}, y_{j-1/2})$、$(x_{i+1/2}, y_{j+1/2})$ 和 $(x_{i-1/2}, y_{j+1/2})$。积分路径 $\\partial A_{i,j}$ 沿着该单元的四个边缘逆时针进行。我们可以将线积分分解为四部分：南、东、北、西四个边缘。\n$$\nC_{i,j} = \\int_{\\text{南}} \\boldsymbol{u} \\cdot \\mathrm{d}\\boldsymbol{\\ell} + \\int_{\\text{东}} \\boldsymbol{u} \\cdot \\mathrm{d}\\boldsymbol{\\ell} + \\int_{\\text{北}} \\boldsymbol{u} \\cdot \\mathrm{d}\\boldsymbol{\\ell} + \\int_{\\text{西}} \\boldsymbol{u} \\cdot \\mathrm{d}\\boldsymbol{\\ell}\n$$\n让我们逐段计算：\n1.  南缘：路径从 $(x_{i-1/2}, y_{j-1/2})$ 到 $(x_{i+1/2}, y_{j-1/2})$。此处 $\\mathrm{d}\\boldsymbol{\\ell} = \\mathrm{d}x\\,\\hat{\\mathbf{i}}$。积分为 $\\int_{x_{i-1/2}}^{x_{i+1/2}} u(x, y_{j-1/2}) \\,\\mathrm{d}x$。我们应用中点法则。此边缘的中点是 $(x_i, y_{j-1/2})$，那里的速度值是 $u_{i, j-1/2}$。边长为 $\\Delta x$。积分近似为 $u_{i, j-1/2} \\Delta x$。符号为正。\n\n2.  东缘：路径从 $(x_{i+1/2}, y_{j-1/2})$ 到 $(x_{i+1/2}, y_{j+1/2})$。此处 $\\mathrm{d}\\boldsymbol{\\ell} = \\mathrm{d}y\\,\\hat{\\mathbf{j}}$。积分为 $\\int_{y_{j-1/2}}^{y_{j+1/2}} v(x_{i+1/2}, y) \\,\\mathrm{d}y$。中点是 $(x_{i+1/2}, y_j)$，那里的速度是 $v_{i+1/2, j}$。边长为 $\\Delta y$。积分近似为 $v_{i+1/2, j} \\Delta y$。符号为正。\n\n3.  北缘：路径从 $(x_{i+1/2}, y_{j+1/2})$ 到 $(x_{i-1/2}, y_{j+1/2})$。此处 $\\mathrm{d}\\boldsymbol{\\ell} = -\\mathrm{d}x\\,\\hat{\\mathbf{i}}$。积分为 $\\int_{x_{i+1/2}}^{x_{i-1/2}} u(x, y_{j+1/2}) (-\\mathrm{d}x) = -\\int_{x_{i-1/2}}^{x_{i+1/2}} u(x, y_{j+1/2}) \\,\\mathrm{d}x$。中点是 $(x_i, y_{j+1/2})$，那里的速度是 $u_{i, j+1/2}$。长度为 $\\Delta x$。积分近似为 $-u_{i, j+1/2} \\Delta x$。符号为负。\n\n4.  西缘：路径从 $(x_{i-1/2}, y_{j+1/2})$ 到 $(x_{i-1/2}, y_{j-1/2})$。此处 $\\mathrm{d}\\boldsymbol{\\ell} = -\\mathrm{d}y\\,\\hat{\\mathbf{j}}$。积分为 $\\int_{y_{j+1/2}}^{y_{j-1/2}} v(x_{i-1/2}, y) (-\\mathrm{d}y) = -\\int_{y_{j-1/2}}^{y_{j+1/2}} v(x_{i-1/2}, y) \\,\\mathrm{d}y$。中点是 $(x_{i-1/2}, y_j)$，那里的速度是 $v_{i-1/2, j}$。长度为 $\\Delta y$。积分近似为 $-v_{i-1/2, j} \\Delta y$。符号为负。\n\n将这四个贡献相加，得到离散环流 $C_{i,j}$：\n$$\nC_{i,j} = \\left(u_{i, j-1/2} \\Delta x\\right) + \\left(v_{i+1/2, j} \\Delta y\\right) - \\left(u_{i, j+1/2} \\Delta x\\right) - \\left(v_{i-1/2, j} \\Delta y\\right)\n$$\n网格单元平均垂直涡度 $\\zeta_{i,j}$ 定义为环流除以网格单元面积 $A_{i,j} = \\Delta x \\Delta y$。\n$$\n\\zeta_{i,j} = \\frac{C_{i,j}}{A_{i,j}} = \\frac{u_{i, j-1/2} \\Delta x + v_{i+1/2, j} \\Delta y - u_{i, j+1/2} \\Delta x - v_{i-1/2, j} \\Delta y}{\\Delta x \\Delta y}\n$$\n重新整理各项并化简，我们得到：\n$$\n\\zeta_{i,j} = \\frac{v_{i+1/2, j} \\Delta y - v_{i-1/2, j} \\Delta y}{\\Delta x \\Delta y} - \\frac{u_{i, j+1/2} \\Delta x - u_{i, j-1/2} \\Delta x}{\\Delta x \\Delta y}\n$$\n$$\n\\zeta_{i,j} = \\frac{v_{i+1/2, j} - v_{i-1/2, j}}{\\Delta x} - \\frac{u_{i, j+1/2} - u_{i, j-1/2}}{\\Delta y}\n$$\n这个表达式是 Arakawa C-网格上垂直涡度 $\\frac{\\partial v}{\\partial x} - \\frac{\\partial u}{\\partial y}$ 的标准二阶精度有限差分近似。\n\n第 2 部分：计算网格单元平均垂直涡度。\n\n给定以下值：\n$\\Delta x = 1.0 \\times 10^{5}\\ \\mathrm{m}$\n$\\Delta y = 2.0 \\times 10^{5}\\ \\mathrm{m}$\n$u_{i, j+1/2} = 6.0\\ \\mathrm{m\\,s^{-1}}$\n$u_{i, j-1/2} = 2.0\\ \\mathrm{m\\,s^{-1}}$\n$v_{i+1/2, j} = 1.0\\ \\mathrm{m\\,s^{-1}}$\n$v_{i-1/2, j} = -3.0\\ \\mathrm{m\\,s^{-1}}$\n\n我们将这些值代入推导出的 $\\zeta_{i,j}$ 公式中：\n$$\n\\zeta_{i,j} = \\frac{(1.0\\ \\mathrm{m\\,s^{-1}}) - (-3.0\\ \\mathrm{m\\,s^{-1}})}{1.0 \\times 10^{5}\\ \\mathrm{m}} - \\frac{(6.0\\ \\mathrm{m\\,s^{-1}}) - (2.0\\ \\mathrm{m\\,s^{-1}})}{2.0 \\times 10^{5}\\ \\mathrm{m}}\n$$\n$$\n\\zeta_{i,j} = \\frac{4.0\\ \\mathrm{m\\,s^{-1}}}{1.0 \\times 10^{5}\\ \\mathrm{m}} - \\frac{4.0\\ \\mathrm{m\\,s^{-1}}}{2.0 \\times 10^{5}\\ \\mathrm{m}}\n$$\n$$\n\\zeta_{i,j} = (4.0 \\times 10^{-5}\\ \\mathrm{s^{-1}}) - (2.0 \\times 10^{-5}\\ \\mathrm{s^{-1}})\n$$\n$$\n\\zeta_{i,j} = 2.0 \\times 10^{-5}\\ \\mathrm{s^{-1}}\n$$\n最终得到的网格单元平均垂直涡度为 $2.0 \\times 10^{-5}\\ \\mathrm{s^{-1}}$。",
            "answer": "$$\n\\boxed{2.0 \\times 10^{-5}}\n$$"
        }
    ]
}