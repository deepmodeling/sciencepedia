{
    "hands_on_practices": [
        {
            "introduction": "The primitive equations that govern atmospheric and oceanic flow are fundamentally expressed in spherical coordinates to represent the geometry of the Earth. This exercise challenges you to derive the horizontal divergence operator on a sphere directly from its fundamental definition as the net outward flux per unit area. By working from first principles rather than memorized formulas, you will gain a deep appreciation for the role of metric terms, like the $\\cos(\\phi)$ factor, which arise from the convergence of meridians toward the poles .",
            "id": "4109040",
            "problem": "In a hydrostatic primitive equation model used for Numerical Weather Prediction (NWP), horizontal mass conservation on the spherical Earth requires accurate evaluation of the horizontal divergence of the horizontal wind. Consider a sphere of radius $a$, with geographic longitude $\\lambda$ and latitude $\\phi$, and a horizontal wind $\\mathbf{u}_h(\\lambda,\\phi,t) = \\big(u(\\lambda,\\phi,t),\\, v(\\lambda,\\phi,t)\\big)$, where $u$ is the component along increasing $\\lambda$ (eastward) and $v$ is the component along increasing $\\phi$ (northward). Assume the flow is strictly tangential to the spherical surface at fixed radius $a$.\n\nStarting from the fundamental definition of surface divergence as the limit of outward normal flux per unit area,\n$$\n\\nabla_h \\cdot \\mathbf{u}_h \\equiv \\lim_{\\Delta A \\to 0} \\frac{1}{\\Delta A} \\oint_{\\partial A} \\mathbf{u}_h \\cdot \\mathbf{n}_t \\, \\mathrm{d}\\ell,\n$$\nwhere $\\mathbf{n}_t$ is the outward unit normal lying in the tangent plane to the sphere along the boundary $\\partial A$ of an infinitesimal spherical control area $A$, derive the explicit form of $\\nabla_h \\cdot \\mathbf{u}_h$ at a point $(\\lambda,\\phi)$ by evaluating the fluxes through the sides of a small spherical rectangle bounded by $\\lambda \\pm \\Delta \\lambda/2$ and $\\phi \\pm \\Delta \\phi/2$.\n\nYou may use only the following geometric facts about the sphere of radius $a$: the arc length along a circle of latitude at latitude $\\phi$ is $a \\cos\\phi \\,\\mathrm{d}\\lambda$, the arc length along a meridian is $a \\,\\mathrm{d}\\phi$, and the surface area element is $a^2 \\cos\\phi \\,\\mathrm{d}\\lambda\\,\\mathrm{d}\\phi$. Do not invoke any pre-memorized coordinate formulas beyond these facts and the definition of divergence above.\n\nWhich of the following options correctly gives the explicit formula for $\\nabla_h \\cdot \\mathbf{u}_h$ and correctly explains the role of metric factors in the expression?\n\nA. $\\nabla_h \\cdot \\mathbf{u}_h = \\dfrac{1}{a}\\dfrac{\\partial u}{\\partial \\lambda} + \\dfrac{1}{a}\\dfrac{\\partial v}{\\partial \\phi}$. The coordinate lines are orthogonal, so the basis is effectively Cartesian in the tangent plane and no metric factors appear.\n\nB. $\\nabla_h \\cdot \\mathbf{u}_h = \\dfrac{1}{a\\cos\\phi}\\dfrac{\\partial u}{\\partial \\lambda} + \\dfrac{1}{a}\\dfrac{\\partial v}{\\partial \\phi}$. The factor $\\cos\\phi$ accounts for meridian convergence in the longitudinal derivative, while the meridional derivative is unaffected because meridians have constant spacing.\n\nC. $\\nabla_h \\cdot \\mathbf{u}_h = \\dfrac{1}{a\\cos\\phi}\\dfrac{\\partial u}{\\partial \\lambda} + \\dfrac{1}{a\\cos\\phi}\\dfrac{\\partial}{\\partial \\phi}\\!\\left(v\\cos\\phi\\right)$. The factor $\\cos\\phi$ arises from the longitudinal arc length $a\\cos\\phi\\,\\mathrm{d}\\lambda$ and from the latitude-dependent length of parallels in the flux across the $\\phi=\\mathrm{const}$ edges, so conservation requires the product form in the meridional term.\n\nD. $\\nabla_h \\cdot \\mathbf{u}_h = \\dfrac{1}{a}\\dfrac{\\partial}{\\partial \\lambda}\\!\\left(u\\cos\\phi\\right) + \\dfrac{1}{a\\cos\\phi}\\dfrac{\\partial v}{\\partial \\phi}$. The factor $\\cos\\phi$ multiplies $u$ because the meridional arc length scales with $\\cos\\phi$, while the longitudinal spacing fixes the meridional derivative with a denominator $\\cos\\phi$.\n\nSelect the single best option.",
            "solution": "The problem statement is a valid application of vector calculus to derive a fundamental operator in geophysical fluid dynamics. The givens are self-consistent, scientifically sound, and sufficient for the derivation.\n\nWe are asked to derive the explicit form of the surface divergence $\\nabla_h \\cdot \\mathbf{u}_h$ for a horizontal wind field $\\mathbf{u}_h = (u, v)$ on a sphere of radius $a$, starting from the definition:\n$$\n\\nabla_h \\cdot \\mathbf{u}_h \\equiv \\lim_{\\Delta A \\to 0} \\frac{1}{\\Delta A} \\oint_{\\partial A} \\mathbf{u}_h \\cdot \\mathbf{n}_t \\, \\mathrm{d}\\ell\n$$\nWe consider an infinitesimal spherical rectangle centered at $(\\lambda, \\phi)$ and bounded by longitudes $\\lambda \\pm \\Delta\\lambda/2$ and latitudes $\\phi \\pm \\Delta\\phi/2$.\n\nFirst, we determine the area $\\Delta A$ of this spherical rectangle. The area element is given as $\\mathrm{d}A = a^2 \\cos\\phi' \\,\\mathrm{d}\\lambda'\\,\\mathrm{d}\\phi'$. For an infinitesimally small rectangle, we can approximate the area by evaluating the integrand at the center point $(\\lambda, \\phi)$:\n$$\n\\Delta A = \\int_{\\phi - \\Delta\\phi/2}^{\\phi + \\Delta\\phi/2} \\int_{\\lambda - \\Delta\\lambda/2}^{\\lambda + \\Delta\\lambda/2} a^2 \\cos\\phi' \\, \\mathrm{d}\\lambda' \\, \\mathrm{d}\\phi' \\approx (a^2 \\cos\\phi) (\\Delta\\lambda) (\\Delta\\phi)\n$$\n\nNext, we calculate the total outward flux, which is the sum of fluxes through the four sides of the rectangle. The flux is the line integral of the normal component of the velocity along the boundary. We evaluate the flux contribution from pairs of opposite sides.\n\n**1. Flux across longitudinal boundaries (East and West sides):**\nThe east side is a segment of the meridian at longitude $\\lambda_E = \\lambda + \\Delta\\lambda/2$, extending from latitude $\\phi - \\Delta\\phi/2$ to $\\phi + \\Delta\\phi/2$. The outward unit normal $\\mathbf{n}_t$ points east, so $\\mathbf{u}_h \\cdot \\mathbf{n}_t = u$. The arc length element is $a\\,\\mathrm{d}\\phi'$. The flux out of the east side is:\n$$\n\\text{Flux}_E = \\int_{\\phi-\\Delta\\phi/2}^{\\phi+\\Delta\\phi/2} u(\\lambda_E, \\phi') \\, a\\,\\mathrm{d}\\phi'\n$$\nFor small $\\Delta\\phi$, we can approximate this as the value at the center latitude $\\phi$ multiplied by the arc length $a\\Delta\\phi$:\n$$\n\\text{Flux}_E \\approx u(\\lambda + \\Delta\\lambda/2, \\phi) \\, (a \\Delta\\phi)\n$$\nSimilarly, the west side is at longitude $\\lambda_W = \\lambda - \\Delta\\lambda/2$. The outward normal points west, so $\\mathbf{u}_h \\cdot \\mathbf{n}_t = -u$. The flux out of the west side is:\n$$\n\\text{Flux}_W \\approx -u(\\lambda - \\Delta\\lambda/2, \\phi) \\, (a \\Delta\\phi)\n$$\nThe net flux from these two sides is:\n$$\n\\text{Flux}_{\\lambda} = \\text{Flux}_E + \\text{Flux}_W \\approx \\left[ u(\\lambda + \\Delta\\lambda/2, \\phi) - u(\\lambda - \\Delta\\lambda/2, \\phi) \\right] a \\Delta\\phi\n$$\nRecognizing the central difference approximation for the partial derivative, for small $\\Delta\\lambda$, this becomes:\n$$\n\\text{Flux}_{\\lambda} \\approx \\left( \\frac{\\partial u}{\\partial \\lambda} \\Delta\\lambda \\right) a \\Delta\\phi = a \\frac{\\partial u}{\\partial \\lambda} \\Delta\\lambda \\Delta\\phi\n$$\n\n**2. Flux across latitudinal boundaries (North and South sides):**\nThe north side is a segment of the circle of latitude at $\\phi_N = \\phi + \\Delta\\phi/2$. The outward normal points north, so $\\mathbf{u}_h \\cdot \\mathbf{n}_t = v$. The arc length of this segment is given by $a \\cos(\\phi_N) \\Delta\\lambda$. The flux out of the north side is, to first order:\n$$\n\\text{Flux}_N \\approx v(\\lambda, \\phi_N) \\cdot (\\text{length of the segment}) = v(\\lambda, \\phi + \\Delta\\phi/2) \\, a \\cos(\\phi + \\Delta\\phi/2) \\Delta\\lambda\n$$\nThe south side is at latitude $\\phi_S = \\phi - \\Delta\\phi/2$. The outward normal points south, so $\\mathbf{u}_h \\cdot \\mathbf{n}_t = -v$. The arc length is $a \\cos(\\phi_S) \\Delta\\lambda$. The flux is:\n$$\n\\text{Flux}_S \\approx -v(\\lambda, \\phi_S) \\cdot (\\text{length of the segment}) = -v(\\lambda, \\phi - \\Delta\\phi/2) \\, a \\cos(\\phi - \\Delta\\phi/2) \\Delta\\lambda\n$$\nThe net flux from these two sides involves the difference of the product $(v \\cos\\phi)$:\n$$\n\\text{Flux}_{\\phi} = \\text{Flux}_N + \\text{Flux}_S \\approx a \\Delta\\lambda \\left[ v(\\lambda, \\phi_N) \\cos(\\phi_N) - v(\\lambda, \\phi_S) \\cos(\\phi_S) \\right]\n$$\nLet's define a function $F(\\phi) = v(\\lambda, \\phi) \\cos\\phi$. The term in the brackets is $F(\\phi + \\Delta\\phi/2) - F(\\phi - \\Delta\\phi/2)$. For small $\\Delta\\phi$, this is approximately $\\frac{\\partial F}{\\partial \\phi} \\Delta\\phi$.\n$$\n\\text{Flux}_{\\phi} \\approx a \\Delta\\lambda \\left( \\frac{\\partial}{\\partial \\phi} (v \\cos\\phi) \\Delta\\phi \\right) = a \\frac{\\partial}{\\partial \\phi} (v \\cos\\phi) \\Delta\\lambda \\Delta\\phi\n$$\nThis form correctly captures two effects: the change in $v$ with latitude and the convergence of meridians (the change in the length of the latitude segments with $\\phi$).\n\n**3. Total Flux and Divergence:**\nThe total outward flux is the sum of the longitudinal and meridional contributions:\n$$\n\\oint \\mathbf{u}_h \\cdot \\mathbf{n}_t \\, \\mathrm{d}\\ell = \\text{Flux}_{\\lambda} + \\text{Flux}_{\\phi} \\approx a \\frac{\\partial u}{\\partial \\lambda} \\Delta\\lambda \\Delta\\phi + a \\frac{\\partial}{\\partial \\phi} (v \\cos\\phi) \\Delta\\lambda \\Delta\\phi\n$$\nNow, we divide by the area $\\Delta A \\approx a^2 \\cos\\phi \\, \\Delta\\lambda \\Delta\\phi$ and take the limit:\n$$\n\\nabla_h \\cdot \\mathbf{u}_h = \\lim_{\\substack{\\Delta\\lambda \\to 0 \\\\ \\Delta\\phi \\to 0}} \\frac{a \\left( \\frac{\\partial u}{\\partial \\lambda} + \\frac{\\partial}{\\partial \\phi}(v \\cos\\phi) \\right) \\Delta\\lambda \\Delta\\phi}{a^2 \\cos\\phi \\, \\Delta\\lambda \\Delta\\phi}\n$$\n$$\n\\nabla_h \\cdot \\mathbf{u}_h = \\frac{1}{a \\cos\\phi} \\left( \\frac{\\partial u}{\\partial \\lambda} + \\frac{\\partial}{\\partial \\phi}(v \\cos\\phi) \\right)\n$$\nThis can be written as:\n$$\n\\nabla_h \\cdot \\mathbf{u}_h = \\frac{1}{a \\cos\\phi} \\frac{\\partial u}{\\partial \\lambda} + \\frac{1}{a \\cos\\phi} \\frac{\\partial}{\\partial \\phi} (v \\cos\\phi)\n$$\n\nNow we evaluate the given options.\n\n**A. $\\nabla_h \\cdot \\mathbf{u}_h = \\dfrac{1}{a}\\dfrac{\\partial u}{\\partial \\lambda} + \\dfrac{1}{a}\\dfrac{\\partial v}{\\partial \\phi}$. The coordinate lines are orthogonal, so the basis is effectively Cartesian in the tangent plane and no metric factors appear.**\nThis formula is incorrect. It fails to account for the scale factor $h_\\lambda = a\\cos\\phi$ depending on latitude $\\phi$. The explanation is fallacious; orthogonality is not sufficient to ignore scale factors if they are not constant.\n**Verdict:** Incorrect.\n\n**B. $\\nabla_h \\cdot \\mathbf{u}_h = \\dfrac{1}{a\\cos\\phi}\\dfrac{\\partial u}{\\partial \\lambda} + \\dfrac{1}{a}\\dfrac{\\partial v}{\\partial \\phi}$. The factor $\\cos\\phi$ accounts for meridian convergence in the longitudinal derivative, while the meridional derivative is unaffected because meridians have constant spacing.**\nThis formula is incorrect. The second term is wrong. It omits the effect of varying northern/southern boundary lengths on the meridional flux. The explanation for the meridional term is flawed; while meridians themselves have constant spacing per degree latitude, the change in length of the latitudinal boundaries of a control area with latitude is a crucial geometric effect that contributes to divergence. This is the $- (v/a) \\tan\\phi$ term that arises when expanding the derivative of the product $(v\\cos\\phi)$.\n**Verdict:** Incorrect.\n\n**C. $\\nabla_h \\cdot \\mathbf{u}_h = \\dfrac{1}{a\\cos\\phi}\\dfrac{\\partial u}{\\partial \\lambda} + \\dfrac{1}{a\\cos\\phi}\\dfrac{\\partial}{\\partial \\phi}\\!\\left(v\\cos\\phi\\right)$. The factor $\\cos\\phi$ arises from the longitudinal arc length $a\\cos\\phi\\,\\mathrm{d}\\lambda$ and from the latitude-dependent length of parallels in the flux across the $\\phi=\\mathrm{const}$ edges, so conservation requires the product form in the meridional term.**\nThe formula is identical to the one derived from first principles. The explanation correctly identifies the origin of the metric factors. The longitudinal term $\\frac{1}{a\\cos\\phi}\\frac{\\partial u}{\\partial \\lambda}$ arises from scaling the derivative over the coordinate $\\lambda$ by the true arc length $a\\cos\\phi \\, \\mathrm{d}\\lambda$. The product form $\\frac{\\partial}{\\partial \\phi}(v\\cos\\phi)$ correctly arises because the flux across a latitude line depends on the product of the velocity component $v$ and the length of the line segment $a\\cos\\phi\\Delta\\lambda$. The difference in this flux between the northern and southern boundaries naturally leads to the derivative of the product. The explanation is physically and mathematically sound.\n**Verdict:** Correct.\n\n**D. $\\nabla_h \\cdot \\mathbf{u}_h = \\dfrac{1}{a}\\dfrac{\\partial}{\\partial \\lambda}\\!\\left(u\\cos\\phi\\right) + \\dfrac{1}{a\\cos\\phi}\\dfrac{\\partial v}{\\partial \\phi}$. The factor $\\cos\\phi$ multiplies $u$ because the meridional arc length scales with $\\cos\\phi$, while the longitudinal spacing fixes the meridional derivative with a denominator $\\cos\\phi$.**\nThe formula is incorrect. It conflates the metric factors between the two terms. The explanation is based on incorrect geometric reasoning. The meridional arc length is $a\\,\\mathrm{d}\\phi$, it does not scale with $\\cos\\phi$. The longitudinal arc length is what scales with $\\cos\\phi$. The entire statement is confused.\n**Verdict:** Incorrect.",
            "answer": "$$\\boxed{C}$$"
        },
        {
            "introduction": "At the heart of climate and weather modeling lies the principle of conservation. This practice translates the abstract divergence theorem into a concrete physical statement about the conservation of mass within a defined model domain. You will start with the local (differential) form of the mass continuity equation and use the divergence theorem to derive an expression for the total mass tendency in terms of fluxes across the domain's boundaries . This is a foundational skill for understanding model diagnostics and analyzing physical budgets.",
            "id": "4109033",
            "problem": "In a Limited-Area Model (LAM) used in Numerical Weather Prediction (NWP), consider a cylindrical domain of radius $R$ and height $H$, with volume $V$ and boundary $\\partial V$ comprised of the lateral side surface $S_{\\mathrm{side}}$ at $r=R$ and horizontal lids $S_{\\mathrm{top}}$ at $z=H$ and $S_{\\mathrm{bottom}}$ at $z=0$. The air density is stratified as $\\rho(z)=\\rho_{s}\\,\\exp(-z/H_{d})$, where $\\rho_{s}$ is the surface density and $H_{d}$ is the density scale height. The velocity field on the lateral boundary is purely radial with $u_{r}(\\theta,z)=U_{m}+U_{a}\\cos\\theta$, where $\\theta$ is the azimuthal angle measured in radians. The vertical velocity satisfies $\\mathbf{u}\\cdot\\mathbf{n}=0$ on $S_{\\mathrm{top}}$ and $S_{\\mathrm{bottom}}$ (rigid lids), so there is no vertical mass flux through the top and bottom boundaries.\n\nStarting from local mass conservation $\\partial_{t}\\rho+\\nabla\\cdot(\\rho\\mathbf{u})=0$ and applying the divergence theorem to the volume $V$, derive an expression for the area-mean column mass tendency $\\partial_{t}M_{\\mathrm{col}}$, where $M_{\\mathrm{col}}=\\frac{1}{A}\\int_{V}\\rho\\,dV$ and $A=\\pi R^{2}$ is the horizontal area of the domain. In performing the boundary-flux calculation, explicitly handle lateral inflow and outflow by accounting for the sign of $\\mathbf{u}\\cdot\\mathbf{n}$ on $S_{\\mathrm{side}}$.\n\nUse the following parameter values, which are scientifically plausible for a mesoscale atmospheric volume: $R=1.0\\times 10^{5}\\,\\mathrm{m}$, $H=1.0\\times 10^{4}\\,\\mathrm{m}$, $\\rho_{s}=1.2\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $H_{d}=8.0\\times 10^{3}\\,\\mathrm{m}$, $U_{m}=0.5\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$, and $U_{a}=1.5\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$. Round your final answer to four significant figures and express it in $\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$. Angles $\\theta$ are to be treated in radians.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n**Step 1: Extract Givens**\n- Domain: Cylinder of radius $R$ and height $H$.\n- Volume: $V$.\n- Boundary: $\\partial V = S_{\\mathrm{side}} \\cup S_{\\mathrm{top}} \\cup S_{\\mathrm{bottom}}$.\n- Lateral surface: $S_{\\mathrm{side}}$ at $r=R$.\n- Top lid: $S_{\\mathrm{top}}$ at $z=H$.\n- Bottom lid: $S_{\\mathrm{bottom}}$ at $z=0$.\n- Air density: $\\rho(z)=\\rho_{s}\\,\\exp(-z/H_{d})$.\n- Velocity field on $S_{\\mathrm{side}}$: Purely radial, $u_{r}(\\theta,z)=U_{m}+U_{a}\\cos\\theta$.\n- Boundary condition on lids: $\\mathbf{u}\\cdot\\mathbf{n}=0$ on $S_{\\mathrm{top}}$ and $S_{\\mathrm{bottom}}$.\n- Governing equation: Local mass conservation, $\\partial_{t}\\rho+\\nabla\\cdot(\\rho\\mathbf{u})=0$.\n- Quantity to derive: Area-mean column mass tendency, $\\partial_{t}M_{\\mathrm{col}}$.\n- Definition: $M_{\\mathrm{col}}=\\frac{1}{A}\\int_{V}\\rho\\,dV$, where $A=\\pi R^{2}$.\n- Parameter values: $R=1.0\\times 10^{5}\\,\\mathrm{m}$, $H=1.0\\times 10^{4}\\,\\mathrm{m}$, $\\rho_{s}=1.2\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $H_{d}=8.0\\times 10^{3}\\,\\mathrm{m}$, $U_{m}=0.5\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$, $U_{a}=1.5\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, using the fundamental principle of mass conservation (the continuity equation) and a standard atmospheric density model. It is well-posed, providing all necessary information, equations, and boundary conditions to arrive at a unique solution. The language is objective and precise. The parameters are physically realistic for a mesoscale atmospheric model. Therefore, the problem is deemed valid.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\n**Solution Derivation**\n\nThe derivation begins with the equation for local mass conservation (the continuity equation):\n$$ \\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{u}) = 0 $$\nWe integrate this equation over the entire cylindrical volume $V$:\n$$ \\int_V \\frac{\\partial \\rho}{\\partial t} \\, dV + \\int_V \\nabla \\cdot (\\rho \\mathbf{u}) \\, dV = 0 $$\nFor a fixed control volume, the time derivative can be moved outside the integral. The first term is the rate of change of total mass $M$ in the volume, where $M = \\int_V \\rho \\, dV$.\n$$ \\frac{dM}{dt} = \\int_V \\frac{\\partial \\rho}{\\partial t} \\, dV $$\nThe second term can be transformed into a surface integral over the boundary $\\partial V$ using the divergence theorem:\n$$ \\int_V \\nabla \\cdot (\\rho \\mathbf{u}) \\, dV = \\oint_{\\partial V} (\\rho \\mathbf{u}) \\cdot \\mathbf{n} \\, dS $$\nwhere $\\mathbf{n}$ is the outward-pointing unit normal vector on the surface $\\partial V$.\n\nSubstituting these back into the integrated conservation equation gives the integral form of mass conservation:\n$$ \\frac{dM}{dt} = - \\oint_{\\partial V} (\\rho \\mathbf{u}) \\cdot \\mathbf{n} \\, dS $$\nThis states that the rate of change of mass inside the volume equals the net mass flux into the volume. The problem asks for the area-mean column mass tendency, $\\partial_{t}M_{\\mathrm{col}}$. The area-mean column mass $M_{\\mathrm{col}}$ is defined as the total mass $M$ divided by the horizontal area of the domain, $A = \\pi R^2$.\n$$ M_{\\mathrm{col}} = \\frac{M}{A} = \\frac{1}{A} \\int_V \\rho \\, dV $$\nThe time derivative is therefore:\n$$ \\frac{dM_{\\mathrm{col}}}{dt} = \\frac{1}{A} \\frac{dM}{dt} = - \\frac{1}{A} \\oint_{\\partial V} (\\rho \\mathbf{u}) \\cdot \\mathbf{n} \\, dS $$\nThe boundary $\\partial V$ consists of three surfaces: the top lid $S_{\\mathrm{top}}$, the bottom lid $S_{\\mathrm{bottom}}$, and the lateral side surface $S_{\\mathrm{side}}$. The surface integral can be split accordingly:\n$$ \\oint_{\\partial V} (\\rho \\mathbf{u}) \\cdot \\mathbf{n} \\, dS = \\int_{S_{\\mathrm{top}}} (\\rho \\mathbf{u}) \\cdot \\mathbf{n} \\, dS + \\int_{S_{\\mathrm{bottom}}} (\\rho \\mathbf{u}) \\cdot \\mathbf{n} \\, dS + \\int_{S_{\\mathrm{side}}} (\\rho \\mathbf{u}) \\cdot \\mathbf{n} \\, dS $$\nThe problem states that the vertical velocity component at the top and bottom boundaries is zero, i.e., $\\mathbf{u} \\cdot \\mathbf{n} = 0$ on $S_{\\mathrm{top}}$ and $S_{\\mathrm{bottom}}$. This is the rigid-lid condition, implying no mass flux through these surfaces. Thus, the first two integrals are zero.\nThe expression for the column mass tendency simplifies to the flux through the lateral side only:\n$$ \\frac{dM_{\\mathrm{col}}}{dt} = - \\frac{1}{A} \\int_{S_{\\mathrm{side}}} (\\rho \\mathbf{u}) \\cdot \\mathbf{n} \\, dS $$\nWe now evaluate the integral over $S_{\\mathrm{side}}$. In cylindrical coordinates $(r, \\theta, z)$, the lateral surface is at $r=R$.\nThe outward unit normal vector is $\\mathbf{n} = \\hat{\\mathbf{r}}$.\nThe velocity field on this surface is given as purely radial: $\\mathbf{u} = u_r \\hat{\\mathbf{r}} = (U_m + U_a \\cos\\theta)\\hat{\\mathbf{r}}$.\nThe differential surface area element is $dS = R \\, d\\theta \\, dz$.\nThe integrand becomes:\n$$ (\\rho \\mathbf{u}) \\cdot \\mathbf{n} = \\rho(z) u_r = \\rho_{s}\\,\\exp(-z/H_{d}) (U_m + U_a \\cos\\theta) $$\nThe integral over $S_{\\mathrm{side}}$ is:\n$$ \\int_{S_{\\mathrm{side}}} (\\rho \\mathbf{u}) \\cdot \\mathbf{n} \\, dS = \\int_{0}^{H} \\int_{0}^{2\\pi} \\left[ \\rho_{s}\\,\\exp(-z/H_{d}) (U_m + U_a \\cos\\theta) \\right] R \\, d\\theta \\, dz $$\nWe can separate the integrals over $z$ and $\\theta$:\n$$ = R \\rho_s \\left( \\int_{0}^{H} \\exp(-z/H_{d}) \\, dz \\right) \\left( \\int_{0}^{2\\pi} (U_m + U_a \\cos\\theta) \\, d\\theta \\right) $$\nFirst, we evaluate the integral over $\\theta$:\n$$ \\int_{0}^{2\\pi} (U_m + U_a \\cos\\theta) \\, d\\theta = \\int_{0}^{2\\pi} U_m \\, d\\theta + \\int_{0}^{2\\pi} U_a \\cos\\theta \\, d\\theta = [U_m \\theta]_{0}^{2\\pi} + [U_a \\sin\\theta]_{0}^{2\\pi} = 2\\pi U_m + 0 = 2\\pi U_m $$\nThis result explicitly handles the inflow and outflow conditions on the lateral boundary. The component of the flow varying as $\\cos\\theta$ results in regions of inflow and outflow, but its net contribution to the total mass flux over the entire cylindrical boundary is zero. The net flux is determined solely by the mean radial velocity $U_m$.\n\nNext, we evaluate the integral over $z$:\n$$ \\int_{0}^{H} \\exp(-z/H_{d}) \\, dz = \\left[-H_d \\exp(-z/H_d)\\right]_{0}^{H} = -H_d (\\exp(-H/H_d) - \\exp(0)) = H_d (1 - \\exp(-H/H_d)) $$\nCombining these results, the total lateral mass flux is:\n$$ \\int_{S_{\\mathrm{side}}} (\\rho \\mathbf{u}) \\cdot \\mathbf{n} \\, dS = R \\rho_s \\left( H_d (1 - \\exp(-H/H_d)) \\right) (2\\pi U_m) = 2\\pi R \\rho_s U_m H_d (1 - \\exp(-H/H_d)) $$\nNow, we substitute this back into the expression for the column mass tendency, using $A = \\pi R^2$:\n$$ \\frac{dM_{\\mathrm{col}}}{dt} = - \\frac{1}{\\pi R^2} \\left[ 2\\pi R \\rho_s U_m H_d (1 - \\exp(-H/H_d)) \\right] $$\nSimplifying, we obtain the final symbolic expression:\n$$ \\frac{dM_{\\mathrm{col}}}{dt} = - \\frac{2 \\rho_s U_m H_d}{R} (1 - \\exp(-H/H_d)) $$\nThe negative sign indicates that for a positive mean outflow ($U_m > 0$), the column mass decreases.\n\nFinally, we substitute the given numerical values:\n$R = 1.0 \\times 10^5 \\, \\mathrm{m}$\n$H = 1.0 \\times 10^4 \\, \\mathrm{m}$\n$\\rho_s = 1.2 \\, \\mathrm{kg}\\,\\mathrm{m}^{-3}$\n$H_d = 8.0 \\times 10^3 \\, \\mathrm{m}$\n$U_m = 0.5 \\, \\mathrm{m}\\,\\mathrm{s}^{-1}$\nThe value of $U_a = 1.5 \\, \\mathrm{m}\\,\\mathrm{s}^{-1}$ is not needed for the net flux calculation.\n\nFirst, calculate the dimensionless exponent:\n$$ \\frac{H}{H_d} = \\frac{1.0 \\times 10^4}{8.0 \\times 10^3} = 1.25 $$\nNow calculate the terms in the expression:\n$$ \\frac{dM_{\\mathrm{col}}}{dt} = - \\frac{2 \\times (1.2) \\times (0.5) \\times (8.0 \\times 10^3)}{1.0 \\times 10^5} (1 - \\exp(-1.25)) $$\n$$ \\frac{dM_{\\mathrm{col}}}{dt} = - \\frac{9600}{1.0 \\times 10^5} (1 - \\exp(-1.25)) $$\n$$ \\frac{dM_{\\mathrm{col}}}{dt} = -0.096 \\times (1 - 0.28650479...) $$\n$$ \\frac{dM_{\\mathrm{col}}}{dt} = -0.096 \\times (0.71349520...) $$\n$$ \\frac{dM_{\\mathrm{col}}}{dt} \\approx -0.068495539 \\, \\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1} $$\nRounding the result to four significant figures gives $-0.06850 \\, \\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$. In standard scientific notation, this is $-6.850 \\times 10^{-2} \\, \\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$.",
            "answer": "$$\\boxed{-6.850 \\times 10^{-2}}$$"
        },
        {
            "introduction": "Moving from continuous physics to a computational model requires translating differential operators into discrete algorithms. This hands-on practice demonstrates how Stokes' theorem provides a powerful and physically intuitive basis for constructing a discrete version of the curl operator, which is used to calculate vorticity. By relating circulation around a grid cell to the average vorticity within it, you will derive the finite-difference vorticity operator on the Arakawa C-grid, a staggered grid layout celebrated for its excellent properties in fluid simulations .",
            "id": "4108981",
            "problem": "In a Numerical Weather Prediction (NWP) dynamical core, the horizontal momentum is often discretized on an Arakawa C-grid (C-grid), where the horizontal velocity components are staggered on the cell edges: the east–west component $u$ is stored at the centers of the horizontal edges (south and north edges), and the north–south component $v$ is stored at the centers of the vertical edges (west and east edges). Consider a single rectangular cell with uniform spacings $\\Delta x$ and $\\Delta y$, oriented with its edges parallel to the coordinate axes. The cell center $(i,j)$ is the location of scalar quantities such as the vertical component of vorticity.\n\nStarting only from the continuous Stokes theorem and standard definitions, proceed as follows:\n\n1) Using the counterclockwise orientation for the circulation around the cell boundary $\\partial A_{i,j}$, begin from the continuous Stokes theorem\n$$\n\\oint_{\\partial A_{i,j}} \\boldsymbol{u} \\cdot \\mathrm{d}\\boldsymbol{\\ell} \\;=\\; \\iint_{A_{i,j}} \\left( \\frac{\\partial v}{\\partial x} - \\frac{\\partial u}{\\partial y} \\right) \\,\\mathrm{d}A,\n$$\nand construct a second-order accurate discrete approximation for the circulation by applying the midpoint rule on each edge, using the C-grid collocated edge values $u_{i,j\\pm 1/2}$ and $v_{i\\pm 1/2,j}$. Then define the cell-averaged vertical vorticity $\\zeta_{i,j}$ as the discrete circulation divided by the cell area $\\Delta x \\,\\Delta y$. Explicitly identify the signs associated with each edge contribution implied by the counterclockwise path orientation.\n\n2) For a specific, scientifically plausible case with uniform spacings $\\Delta x = 1.0 \\times 10^{5}\\ \\mathrm{m}$ and $\\Delta y = 2.0 \\times 10^{5}\\ \\mathrm{m}$, and edge-centered velocities at the cell $(i,j)$ given by\n$$\nu_{i,\\,j+1/2} = 6.0\\ \\mathrm{m\\,s^{-1}},\\quad u_{i,\\,j-1/2} = 2.0\\ \\mathrm{m\\,s^{-1}},\\quad v_{i+1/2,\\,j} = 1.0\\ \\mathrm{m\\,s^{-1}},\\quad v_{i-1/2,\\,j} = -3.0\\ \\mathrm{m\\,s^{-1}},\n$$\nevaluate the cell-averaged vertical vorticity $\\zeta_{i,j}$ obtained from your discrete construction.\n\nExpress your final numerical answer for $\\zeta_{i,j}$ in $\\mathrm{s^{-1}}$. No rounding is necessary.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of vector calculus and numerical fluid dynamics, is well-posed with all necessary information provided, and is stated objectively. We may proceed with the solution.\n\nThe problem asks for two things: first, to derive a discrete approximation for the cell-averaged vertical vorticity from the continuous Stokes theorem, and second, to calculate its value for a given set of parameters.\n\nPart 1: Derivation of the discrete vertical vorticity.\n\nWe begin with the continuous Stokes theorem in two dimensions, which relates the circulation of a vector field $\\boldsymbol{u}$ around a closed curve $\\partial A$ to the integral of the curl of $\\boldsymbol{u}$ over the area $A$ enclosed by the curve. For a two-dimensional velocity field $\\boldsymbol{u} = u\\hat{\\mathbf{i}} + v\\hat{\\mathbf{j}}$, the vertical component of the curl is $\\left(\\nabla \\times \\boldsymbol{u}\\right)_z = \\frac{\\partial v}{\\partial x} - \\frac{\\partial u}{\\partial y}$. The theorem is given as:\n$$\n\\oint_{\\partial A_{i,j}} \\boldsymbol{u} \\cdot \\mathrm{d}\\boldsymbol{\\ell} \\;=\\; \\iint_{A_{i,j}} \\left( \\frac{\\partial v}{\\partial x} - \\frac{\\partial u}{\\partial y} \\right) \\,\\mathrm{d}A\n$$\nThe integral on the left is the circulation, which we will denote as $C_{i,j}$. The cell $A_{i,j}$ is a rectangle with width $\\Delta x$ and height $\\Delta y$. Its corners are at $(x_{i-1/2}, y_{j-1/2})$, $(x_{i+1/2}, y_{j-1/2})$, $(x_{i+1/2}, y_{j+1/2})$, and $(x_{i-1/2}, y_{j+1/2})$. The path of integration $\\partial A_{i,j}$ is taken counterclockwise along the four edges of this cell. We can break the line integral into four parts: south, east, north, and west edges.\n$$\nC_{i,j} = \\int_{\\text{south}} \\boldsymbol{u} \\cdot \\mathrm{d}\\boldsymbol{\\ell} + \\int_{\\text{east}} \\boldsymbol{u} \\cdot \\mathrm{d}\\boldsymbol{\\ell} + \\int_{\\text{north}} \\boldsymbol{u} \\cdot \\mathrm{d}\\boldsymbol{\\ell} + \\int_{\\text{west}} \\boldsymbol{u} \\cdot \\mathrm{d}\\boldsymbol{\\ell}\n$$\nLet's evaluate each segment:\n1.  South edge: The path is from $(x_{i-1/2}, y_{j-1/2})$ to $(x_{i+1/2}, y_{j-1/2})$. Here, $\\mathrm{d}\\boldsymbol{\\ell} = \\mathrm{d}x\\,\\hat{\\mathbf{i}}$. The integral is $\\int_{x_{i-1/2}}^{x_{i+1/2}} u(x, y_{j-1/2}) \\,\\mathrm{d}x$. We apply the midpoint rule. The midpoint of this edge is $(x_i, y_{j-1/2})$, where the velocity value is given as $u_{i,j-1/2}$. The length of the edge is $\\Delta x$. The integral is approximated as $u_{i,j-1/2} \\Delta x$. The sign is positive.\n\n2.  East edge: The path is from $(x_{i+1/2}, y_{j-1/2})$ to $(x_{i+1/2}, y_{j+1/2})$. Here, $\\mathrm{d}\\boldsymbol{\\ell} = \\mathrm{d}y\\,\\hat{\\mathbf{j}}$. The integral is $\\int_{y_{j-1/2}}^{y_{j+1/2}} v(x_{i+1/2}, y) \\,\\mathrm{d}y$. The midpoint is $(x_{i+1/2}, y_j)$, where the velocity is $v_{i+1/2,j}$. The length of the edge is $\\Delta y$. The integral is approximated as $v_{i+1/2,j} \\Delta y$. The sign is positive.\n\n3.  North edge: The path is from $(x_{i+1/2}, y_{j+1/2})$ to $(x_{i-1/2}, y_{j+1/2})$. Here, $\\mathrm{d}\\boldsymbol{\\ell} = -\\mathrm{d}x\\,\\hat{\\mathbf{i}}$. The integral is $\\int_{x_{i+1/2}}^{x_{i-1/2}} u(x, y_{j+1/2}) (-\\mathrm{d}x) = -\\int_{x_{i-1/2}}^{x_{i+1/2}} u(x, y_{j+1/2}) \\,\\mathrm{d}x$. The midpoint is $(x_i, y_{j+1/2})$, where the velocity is $u_{i,j+1/2}$. The length is $\\Delta x$. The integral is approximated as $-u_{i,j+1/2} \\Delta x$. The sign is negative.\n\n4.  West edge: The path is from $(x_{i-1/2}, y_{j+1/2})$ to $(x_{i-1/2}, y_{j-1/2})$. Here, $\\mathrm{d}\\boldsymbol{\\ell} = -\\mathrm{d}y\\,\\hat{\\mathbf{j}}$. The integral is $\\int_{y_{j+1/2}}^{y_{j-1/2}} v(x_{i-1/2}, y) (-\\mathrm{d}y) = -\\int_{y_{j-1/2}}^{y_{j+1/2}} v(x_{i-1/2}, y) \\,\\mathrm{d}y$. The midpoint is $(x_{i-1/2}, y_j)$, where the velocity is $v_{i-1/2,j}$. The length is $\\Delta y$. The integral is approximated as $-v_{i-1/2,j} \\Delta y$. The sign is negative.\n\nSumming these four contributions gives the discrete circulation $C_{i,j}$:\n$$\nC_{i,j} = \\left(u_{i,j-1/2} \\Delta x\\right) + \\left(v_{i+1/2,j} \\Delta y\\right) - \\left(u_{i,j+1/2} \\Delta x\\right) - \\left(v_{i-1/2,j} \\Delta y\\right)\n$$\nThe cell-averaged vertical vorticity, $\\zeta_{i,j}$, is defined as the circulation divided by the cell area, $A_{i,j} = \\Delta x \\Delta y$.\n$$\n\\zeta_{i,j} = \\frac{C_{i,j}}{A_{i,j}} = \\frac{u_{i,j-1/2} \\Delta x + v_{i+1/2,j} \\Delta y - u_{i,j+1/2} \\Delta x - v_{i-1/2,j} \\Delta y}{\\Delta x \\Delta y}\n$$\nRearranging the terms and simplifying, we obtain:\n$$\n\\zeta_{i,j} = \\frac{v_{i+1/2,j} \\Delta y - v_{i-1/2,j} \\Delta y}{\\Delta x \\Delta y} - \\frac{u_{i,j+1/2} \\Delta x - u_{i,j-1/2} \\Delta x}{\\Delta x \\Delta y}\n$$\n$$\n\\zeta_{i,j} = \\frac{v_{i+1/2,j} - v_{i-1/2,j}}{\\Delta x} - \\frac{u_{i,j+1/2} - u_{i,j-1/2}}{\\Delta y}\n$$\nThis expression is the standard second-order accurate finite-difference approximation of the vertical vorticity $\\frac{\\partial v}{\\partial x} - \\frac{\\partial u}{\\partial y}$ on an Arakawa C-grid.\n\nPart 2: Calculation of the cell-averaged vertical vorticity.\n\nWe are given the following values:\n$\\Delta x = 1.0 \\times 10^{5}\\ \\mathrm{m}$\n$\\Delta y = 2.0 \\times 10^{5}\\ \\mathrm{m}$\n$u_{i,\\,j+1/2} = 6.0\\ \\mathrm{m\\,s^{-1}}$\n$u_{i,\\,j-1/2} = 2.0\\ \\mathrm{m\\,s^{-1}}$\n$v_{i+1/2,\\,j} = 1.0\\ \\mathrm{m\\,s^{-1}}$\n$v_{i-1/2,\\,j} = -3.0\\ \\mathrm{m\\,s^{-1}}$\n\nWe substitute these values into the derived formula for $\\zeta_{i,j}$:\n$$\n\\zeta_{i,j} = \\frac{(1.0\\ \\mathrm{m\\,s^{-1}}) - (-3.0\\ \\mathrm{m\\,s^{-1}})}{1.0 \\times 10^{5}\\ \\mathrm{m}} - \\frac{(6.0\\ \\mathrm{m\\,s^{-1}}) - (2.0\\ \\mathrm{m\\,s^{-1}})}{2.0 \\times 10^{5}\\ \\mathrm{m}}\n$$\n$$\n\\zeta_{i,j} = \\frac{4.0\\ \\mathrm{m\\,s^{-1}}}{1.0 \\times 10^{5}\\ \\mathrm{m}} - \\frac{4.0\\ \\mathrm{m\\,s^{-1}}}{2.0 \\times 10^{5}\\ \\mathrm{m}}\n$$\n$$\n\\zeta_{i,j} = (4.0 \\times 10^{-5}\\ \\mathrm{s^{-1}}) - (2.0 \\times 10^{-5}\\ \\mathrm{s^{-1}})\n$$\n$$\n\\zeta_{i,j} = 2.0 \\times 10^{-5}\\ \\mathrm{s^{-1}}\n$$\nThe resulting cell-averaged vertical vorticity is $2.0 \\times 10^{-5}\\ \\mathrm{s^{-1}}$.",
            "answer": "$$\n\\boxed{2.0 \\times 10^{-5}}\n$$"
        }
    ]
}