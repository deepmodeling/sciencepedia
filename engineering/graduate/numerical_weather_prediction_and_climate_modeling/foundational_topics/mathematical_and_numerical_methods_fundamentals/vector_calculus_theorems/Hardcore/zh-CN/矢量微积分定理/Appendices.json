{
    "hands_on_practices": [
        {
            "introduction": "在数值天气预报中，核心任务是预测大气状态随时间的变化。这个过程的基石是物理守恒定律，例如质量守恒。本练习将引导你应用高斯散度定理，将控制体积内质量随时间的变化率与通过其边界的质量通量联系起来，这是构建和理解数值模式中积分守恒律的关键一步。",
            "id": "4109033",
            "problem": "在一个用于数值天气预报（NWP）的局地模式（LAM）中，考虑一个半径为 $R$、高度为 $H$ 的柱状区域，其体积为 $V$，边界 $\\partial V$ 由 $r=R$ 处的侧面 $S_{\\mathrm{side}}$ 以及 $z=H$ 处的水平顶盖 $S_{\\mathrm{top}}$ 和 $z=0$ 处的水平底盖 $S_{\\mathrm{bottom}}$ 组成。空气密度是分层的，其形式为 $\\rho(z)=\\rho_{s}\\,\\exp(-z/H_{d})$，其中 $\\rho_{s}$ 是地表密度，$H_{d}$ 是密度尺度高度。侧边界上的速度场是纯径向的，为 $u_{r}(\\theta,z)=U_{m}+U_{a}\\cos\\theta$，其中 $\\theta$ 是以弧度为单位的方位角。在顶盖 $S_{\\mathrm{top}}$ 和底盖 $S_{\\mathrm{bottom}}$ 上，垂直速度满足 $\\mathbf{u}\\cdot\\mathbf{n}=0$（刚性盖条件），因此没有垂直质量通量穿过顶盖和底盖边界。\n\n从局地质量守恒 $\\partial_{t}\\rho+\\nabla\\cdot(\\rho\\mathbf{u})=0$ 出发，对体积 $V$ 应用散度定理，推导面积平均的整层质量趋势 $\\partial_{t}M_{\\mathrm{col}}$ 的表达式，其中 $M_{\\mathrm{col}}=\\frac{1}{A}\\int_{V}\\rho\\,dV$，$A=\\pi R^{2}$ 是该区域的水平面积。在进行边界通量计算时，通过考虑 $S_{\\mathrm{side}}$ 上 $\\mathbf{u}\\cdot\\mathbf{n}$ 的符号来明确处理侧向流入和流出。\n\n使用以下参数值，这些值对于一个中尺度大气体积是科学上合理的：$R=1.0\\times 10^{5}\\,\\mathrm{m}$，$H=1.0\\times 10^{4}\\,\\mathrm{m}$，$\\rho_{s}=1.2\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$，$H_{d}=8.0\\times 10^{3}\\,\\mathrm{m}$，$U_{m}=0.5\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$，以及 $U_{a}=1.5\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$。将您的最终答案四舍五入到四位有效数字，并以 $\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$ 为单位表示。角度 $\\theta$ 以弧度处理。",
            "solution": "该问题是有效的，因为它在科学上基于流体动力学，是适定的（具有足够的信息以得到唯一解），且其表述是客观的。\n\n我们的起点是局部质量守恒方程（连续性方程）：\n$$ \\partial_{t}\\rho + \\nabla\\cdot(\\rho\\mathbf{u}) = 0 $$\n对该方程在固定控制体积 $V$ 上进行积分，得到：\n$$ \\int_V \\partial_{t}\\rho \\,dV + \\int_V \\nabla\\cdot(\\rho\\mathbf{u}) \\,dV = 0 $$\n由于体积 $V$ 是固定的，时间导数可以移到积分之外。应用高斯散度定理，我们将体积散度积分转化为通过边界 $\\partial V$ 的面积分：\n$$ \\frac{d}{dt}\\int_V \\rho\\,dV = - \\oint_{\\partial V} (\\rho\\mathbf{u})\\cdot\\mathbf{n}\\,dS $$\n其中 $\\mathbf{n}$ 是向外的单位法向量。\n\n面积平均的整层质量 $M_{\\mathrm{col}}$ 定义为 $M_{\\mathrm{col}} = \\frac{1}{A} \\int_V \\rho\\,dV$，其中 $A = \\pi R^2$。因此，$\\int_V \\rho\\,dV = A M_{\\mathrm{col}}$。代入上式，我们得到：\n$$ A \\frac{dM_{\\mathrm{col}}}{dt} = - \\oint_{\\partial V} (\\rho\\mathbf{u})\\cdot\\mathbf{n}\\,dS $$\n即：\n$$ \\partial_{t}M_{\\mathrm{col}} = -\\frac{1}{A} \\oint_{\\partial V} (\\rho\\mathbf{u})\\cdot\\mathbf{n}\\,dS $$\n边界 $\\partial V$ 由顶盖 $S_{\\mathrm{top}}$、底盖 $S_{\\mathrm{bottom}}$ 和侧面 $S_{\\mathrm{side}}$ 组成。根据问题陈述，通过顶盖和底盖的质量通量为零。因此，边界积分仅需考虑侧面：\n$$ \\oint_{\\partial V} (\\rho\\mathbf{u})\\cdot\\mathbf{n}\\,dS = \\iint_{S_{\\mathrm{side}}} (\\rho\\mathbf{u})\\cdot\\mathbf{n}\\,dS $$\n在圆柱坐标系中，侧面 $S_{\\mathrm{side}}$ 上的向外单位法向量是 $\\mathbf{n} = \\hat{\\mathbf{r}}$。速度场是纯径向的，$\\mathbf{u} = u_r(\\theta, z)\\hat{\\mathbf{r}}$。微分面积元为 $dS = R\\,d\\theta\\,dz$。因此，侧向通量积分为：\n$$ \\iint_{S_{\\mathrm{side}}} \\rho(z) u_r(\\theta, z) \\,(R\\,d\\theta\\,dz) $$\n由于 $\\rho$ 仅依赖于 $z$，$u_r$ 仅依赖于 $\\theta$，积分可以分离：\n$$ R \\left( \\int_0^H \\rho(z)\\,dz \\right) \\left( \\int_0^{2\\pi} u_r(\\theta)\\,d\\theta \\right) $$\n分别计算这两个积分：\n$$ \\int_0^{2\\pi} u_r(\\theta)\\,d\\theta = \\int_0^{2\\pi} (U_m + U_a\\cos\\theta)\\,d\\theta = [U_m\\theta + U_a\\sin\\theta]_0^{2\\pi} = 2\\pi U_m $$\n$$ \\int_0^H \\rho(z)\\,dz = \\int_0^H \\rho_s e^{-z/H_d}\\,dz = \\rho_s [-H_d e^{-z/H_d}]_0^H = \\rho_s H_d (1 - e^{-H/H_d}) $$\n将结果合并，得到总的侧向通量：\n$$ \\text{通量} = R \\cdot (2\\pi U_m) \\cdot (\\rho_s H_d (1 - e^{-H/H_d})) $$\n最后，代入 $\\partial_t M_{\\mathrm{col}}$ 的表达式中：\n$$ \\partial_{t}M_{\\mathrm{col}} = -\\frac{1}{\\pi R^2} \\left[ 2\\pi R U_m \\rho_s H_d (1 - e^{-H/H_d}) \\right] = -\\frac{2U_m}{R} \\rho_s H_d (1 - e^{-H/H_d}) $$\n现在，代入数值：\n- $R=1.0\\times 10^{5}\\,\\mathrm{m}$\n- $H=1.0\\times 10^{4}\\,\\mathrm{m}$\n- $\\rho_{s}=1.2\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$\n- $H_{d}=8.0\\times 10^{3}\\,\\mathrm{m}$\n- $U_{m}=0.5\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$\n$$ \\partial_{t}M_{\\mathrm{col}} = -\\frac{2 \\cdot 0.5}{1.0\\times 10^{5}} \\cdot (1.2) \\cdot (8.0\\times 10^{3}) \\cdot \\left(1 - \\exp\\left(-\\frac{1.0\\times 10^{4}}{8.0\\times 10^{3}}\\right)\\right) $$\n$$ \\partial_{t}M_{\\mathrm{col}} = -(1.0 \\times 10^{-5}) \\cdot (9600) \\cdot (1 - e^{-1.25}) $$\n$$ \\partial_{t}M_{\\mathrm{col}} \\approx -0.096 \\cdot (1 - 0.28650479) = -0.096 \\cdot 0.71349521 $$\n$$ \\partial_{t}M_{\\mathrm{col}} \\approx -0.068495539 \\approx -6.850 \\times 10^{-2} \\, \\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1} $$",
            "answer": "$$\\boxed{-6.850 \\times 10^{-2}}$$"
        },
        {
            "introduction": "继散度定理之后，我们将探讨其在二维平面上的对应形式——斯托克斯定理。该定理在流体动力学中至关重要，因为它建立了沿闭合路径的速度环流与该路径所包围区域内涡度通量之间的深刻联系。通过这个练习，你将把斯托克斯定理应用于一个实际的气象学场景：利用飞机沿热带气旋眼墙测量的风场数据来估算其内部的平均涡度，这清晰地展示了如何将抽象的数学工具转化为分析真实大气现象的有力手段。",
            "id": "4109006",
            "problem": "一次支持数值天气预报（NWP）的科研飞行，在某成熟热带气旋的风眼周围近似恒定的高度上对切向风进行了采样。在该高度上，风眼尺度的流场可被视为水平二维的。飞行路径是一条以涡旋质心为中心的封闭近似圆形曲线，并特意与当地方位角方向对齐，以最小化路径上的径向风干扰。相对涡度的垂直分量将通过对飞行路径所包围区域内的水平速度场应用斯托克斯定理（Stokes' theorem）来推断。假设在采样尺度上地球曲率可以忽略不计，角度以弧度为单位。\n\n方位坐标用 $\\theta \\in [0,2\\pi]$ 表示，飞行路径的半径建模为 $r(\\theta) = R \\left(1 + \\epsilon \\cos(2\\theta)\\right)$，沿路径观测到的切向风建模为 $v_{\\theta}(\\theta) = V_{0}\\left(1 + \\mu \\cos(2\\theta) + \\nu \\sin(2\\theta) + \\sigma \\cos(3\\theta)\\right)$。在本分析中，可以忽略沿路径的径向风。使用以下数值：\n- $R = 3.0 \\times 10^{4}\\ \\text{m}$,\n- $\\epsilon = 0.10$,\n- $V_{0} = 45\\ \\text{m}\\ \\text{s}^{-1}$,\n- $\\mu = 0.12$,\n- $\\nu = -0.05$,\n- $\\sigma = 0.04$.\n\n从第一性原理和适当的核心定义出发，计算飞行路径所包围区域内相对涡度的面积平均垂直分量，并明确考虑非圆形路径几何形状的影响。将最终的平均涡度以 $\\text{s}^{-1}$ 为单位表示，并将答案四舍五入到四位有效数字。不要将风眼近似为完美的圆形；应计入由给定的 $r(\\theta)$ 和 $v_{\\theta}(\\theta)$ 引起的非圆形修正。",
            "solution": "该问题是有效的，因为它在科学上基于流体动力学，是适定的（具有足够的信息以得到唯一解），且其表述是客观的。\n\n主要目标是计算由飞行路径 $C$ 包围的相对涡度的面积平均垂直分量 $\\langle \\zeta_z \\rangle$。根据定义，标量场 $\\phi$ 在面积为 $A$ 的曲面 $S$ 上的面积平均值由 $\\langle \\phi \\rangle = \\frac{1}{A} \\iint_S \\phi \\, dA$ 给出。\n在本例中，标量场是相对涡度的垂直分量 $\\zeta_z$。因此，\n$$ \\langle \\zeta_z \\rangle = \\frac{1}{A} \\iint_S \\zeta_z \\, dA $$\n涡度的垂直分量是速度场 $\\mathbf{v}$ 的旋量在垂直方向上的分量，在局部笛卡尔坐标系中，我们把垂直方向的单位向量记为 $\\hat{\\mathbf{k}}$。\n$$ \\zeta_z = (\\nabla \\times \\mathbf{v}) \\cdot \\hat{\\mathbf{k}} $$\n利用斯托克斯定理（Stokes' theorem），$\\zeta_z$ 的面积分可以与一个线积分关联起来。对于一个由闭合曲线 $C$ 为边界的曲面 $S$，斯托克斯定理指出：\n$$ \\iint_S (\\nabla \\times \\mathbf{v}) \\cdot d\\mathbf{S} = \\oint_C \\mathbf{v} \\cdot d\\mathbf{l} $$\n由于分析是在恒定高度下进行的，曲面 $S$ 是水平的。微分曲面元为 $d\\mathbf{S} = dA \\, \\hat{\\mathbf{k}}$。斯托克斯定理的左侧变为：\n$$ \\iint_S (\\nabla \\times \\mathbf{v}) \\cdot (dA \\, \\hat{\\mathbf{k}}) = \\iint_S [(\\nabla \\times \\mathbf{v}) \\cdot \\hat{\\mathbf{k}}] \\, dA = \\iint_S \\zeta_z \\, dA $$\n右侧的线积分 $\\oint_C \\mathbf{v} \\cdot d\\mathbf{l}$ 是环量，记作 $\\Gamma$。\n将此代入平均涡度的定义，我们得到：\n$$ \\langle \\zeta_z \\rangle = \\frac{1}{A} \\oint_C \\mathbf{v} \\cdot d\\mathbf{l} = \\frac{\\Gamma}{A} $$\n问题因此简化为计算沿飞行路径的环量 $\\Gamma$ 和它所包围的面积 $A$。\n\n首先，我们计算环量 $\\Gamma$。飞行路径在极坐标中由 $r(\\theta) = R \\left(1 + \\epsilon \\cos(2\\theta)\\right)$ 给出。位置矢量为 $\\mathbf{r}(\\theta) = r(\\theta)\\hat{\\mathbf{r}}$，其中 $\\hat{\\mathbf{r}}$ 是径向单位矢量。沿路径的微分线元 $d\\mathbf{l}$ 为：\n$$ d\\mathbf{l} = \\frac{d\\mathbf{r}}{d\\theta} d\\theta = \\frac{d}{d\\theta}(r(\\theta)\\hat{\\mathbf{r}}) d\\theta = \\left( \\frac{dr}{d\\theta}\\hat{\\mathbf{r}} + r(\\theta)\\frac{d\\hat{\\mathbf{r}}}{d\\theta} \\right) d\\theta $$\n使用恒等式 $\\frac{d\\hat{\\mathbf{r}}}{d\\theta} = \\hat{\\mathbf{\\theta}}$，其中 $\\hat{\\mathbf{\\theta}}$ 是方位角单位矢量，我们得到：\n$$ d\\mathbf{l} = \\left( \\frac{dr}{d\\theta}\\hat{\\mathbf{r}} + r(\\theta)\\hat{\\mathbf{\\theta}} \\right) d\\theta $$\n如问题所述，沿路径的速度矢量被假定为纯切向的，因此 $\\mathbf{v} = v_{\\theta}(\\theta)\\hat{\\mathbf{\\theta}}$。点积 $\\mathbf{v} \\cdot d\\mathbf{l}$ 为：\n$$ \\mathbf{v} \\cdot d\\mathbf{l} = (v_{\\theta}(\\theta)\\hat{\\mathbf{\\theta}}) \\cdot \\left( \\frac{dr}{d\\theta}\\hat{\\mathbf{r}} + r(\\theta)\\hat{\\mathbf{\\theta}} \\right) d\\theta = v_{\\theta}(\\theta)r(\\theta) d\\theta $$\n因为 $\\hat{\\mathbf{r}}$ 和 $\\hat{\\mathbf{\\theta}}$ 是正交的。\n环量 $\\Gamma$ 是沿闭合路径 $\\theta \\in [0, 2\\pi]$ 的积分：\n$$ \\Gamma = \\int_{0}^{2\\pi} v_{\\theta}(\\theta)r(\\theta) \\, d\\theta $$\n代入给定的 $r(\\theta)$ 和 $v_{\\theta}(\\theta)$ 表达式：\n$$ \\Gamma = \\int_{0}^{2\\pi} \\left[ V_{0}\\left(1 + \\mu \\cos(2\\theta) + \\nu \\sin(2\\theta) + \\sigma \\cos(3\\theta)\\right) \\right] \\left[ R \\left(1 + \\epsilon \\cos(2\\theta)\\right) \\right] \\, d\\theta $$\n$$ \\Gamma = R V_{0} \\int_{0}^{2\\pi} \\left(1 + \\epsilon \\cos(2\\theta)\\right) \\left(1 + \\mu \\cos(2\\theta) + \\nu \\sin(2\\theta) + \\sigma \\cos(3\\theta)\\right) \\, d\\theta $$\n我们展开被积函数并逐项积分。我们使用在区间 $[0, 2\\pi]$ 上的三角函数正交关系：对于非零整数 $m, n$，有 $\\int_0^{2\\pi} \\cos(m\\theta) d\\theta = 0$，$\\int_0^{2\\pi} \\sin(m\\theta) d\\theta = 0$，$\\int_0^{2\\pi} \\sin(m\\theta)\\cos(n\\theta) d\\theta = 0$，以及 $\\int_0^{2\\pi} \\cos(m\\theta)\\cos(n\\theta) d\\theta = \\pi \\delta_{mn}$。此外，$\\int_0^{2\\pi} \\cos^2(m\\theta) d\\theta = \\pi$。\n展开式中积分不为零的项只有常数项（来自 $1 \\times 1$）和包含 $\\cos^2(2\\theta)$ 的项（来自 $(\\epsilon \\cos(2\\theta)) \\times (\\mu \\cos(2\\theta))$）。\n$$ \\int_{0}^{2\\pi} 1 \\cdot 1 \\, d\\theta = 2\\pi $$\n$$ \\int_{0}^{2\\pi} (\\epsilon \\cos(2\\theta))(\\mu \\cos(2\\theta)) \\, d\\theta = \\epsilon\\mu \\int_{0}^{2\\pi} \\cos^2(2\\theta) \\, d\\theta = \\epsilon\\mu\\pi $$\n所有其他的交叉乘积项积分后都为零。\n所以，环量为：\n$$ \\Gamma = R V_{0} (2\\pi + \\epsilon\\mu\\pi) = \\pi R V_{0} (2 + \\epsilon\\mu) $$\n\n接下来，我们计算路径所包围的面积 $A$。在极坐标中，面积的公式为：\n$$ A = \\frac{1}{2}\\int_{0}^{2\\pi} [r(\\theta)]^2 \\, d\\theta $$\n代入 $r(\\theta) = R(1 + \\epsilon\\cos(2\\theta))$：\n$$ A = \\frac{1}{2}\\int_{0}^{2\\pi} \\left[ R(1 + \\epsilon\\cos(2\\theta)) \\right]^2 \\, d\\theta = \\frac{R^2}{2}\\int_{0}^{2\\pi} (1 + 2\\epsilon\\cos(2\\theta) + \\epsilon^2\\cos^2(2\\theta)) \\, d\\theta $$\n逐项积分：\n$$ \\int_{0}^{2\\pi} 1 \\, d\\theta = 2\\pi $$\n$$ \\int_{0}^{2\\pi} 2\\epsilon\\cos(2\\theta) \\, d\\theta = 0 $$\n$$ \\int_{0}^{2\\pi} \\epsilon^2\\cos^2(2\\theta) \\, d\\theta = \\epsilon^2\\pi $$\n因此，面积为：\n$$ A = \\frac{R^2}{2}(2\\pi + \\epsilon^2\\pi) = \\pi R^2 \\left(1 + \\frac{\\epsilon^2}{2}\\right) $$\n\n现在我们可以计算面积平均涡度：\n$$ \\langle \\zeta_z \\rangle = \\frac{\\Gamma}{A} = \\frac{\\pi R V_{0} (2 + \\epsilon\\mu)}{\\pi R^2 (1 + \\frac{\\epsilon^2}{2})} = \\frac{V_0}{R} \\frac{2 + \\epsilon\\mu}{1 + \\frac{\\epsilon^2}{2}} $$\n我们代入给定的数值：\n$R = 3.0 \\times 10^{4}\\ \\text{m}$\n$V_{0} = 45\\ \\text{m s}^{-1}$\n$\\epsilon = 0.10$\n$\\mu = 0.12$\n$$ \\langle \\zeta_z \\rangle = \\frac{45}{3.0 \\times 10^{4}} \\frac{2 + (0.10)(0.12)}{1 + \\frac{(0.10)^2}{2}} $$\n$$ \\langle \\zeta_z \\rangle = (1.5 \\times 10^{-3}) \\frac{2 + 0.012}{1 + \\frac{0.01}{2}} = (1.5 \\times 10^{-3}) \\frac{2.012}{1.005} $$\n$$ \\langle \\zeta_z \\rangle = (1.5 \\times 10^{-3}) (2.00199004975...) $$\n$$ \\langle \\zeta_z \\rangle \\approx 3.00298507... \\times 10^{-3}\\ \\text{s}^{-1} $$\n按要求四舍五入到四位有效数字：\n$$ \\langle \\zeta_z \\rangle \\approx 3.003 \\times 10^{-3}\\ \\text{s}^{-1} $$",
            "answer": "$$\\boxed{3.003 \\times 10^{-3}}$$"
        },
        {
            "introduction": "我们已经看到连续的矢量微积分定理如何应用于物理问题，但计算机模型是在离散的网格上运行的，我们如何将这些连续的理论转化为离散的计算呢？本练习将为你揭示斯托克斯定理的积分形式如何直接指导我们构建离散的涡度算子，特别是在大气和海洋模型中广泛使用的交错网格（Arakawa C-grid）上。掌握这种从连续到离散的转换，是开发和验证数值模型中关键物理过程（如涡度演变）计算方案的核心技能。",
            "id": "4108981",
            "problem": "在数值天气预报 (NWP) 动力核心中，水平动量通常在 Arakawa C-网格 (C-网格) 上进行离散化，其中水平速度分量交错放置在单元格的边上：东西分量 $u$ 存储在水平边（南边和北边）的中心，而南北分量 $v$ 存储在垂直边（西边和东边）的中心。考虑一个具有均匀间距 $\\Delta x$ 和 $\\Delta y$ 的单个矩形单元格，其边缘与坐标轴平行。单元格中心 $(i,j)$ 是诸如垂直涡度等标量的位置。\n\n仅从连续形式的斯托克斯定理和标准定义出发，按以下步骤进行：\n\n1) 对围绕单元格边界 $\\partial A_{i,j}$ 的环流采用逆时针方向，从连续形式的斯托克斯定理\n$$\n\\oint_{\\partial A_{i,j}} \\boldsymbol{u} \\cdot \\mathrm{d}\\boldsymbol{\\ell} \\;=\\; \\iint_{A_{i,j}} \\left( \\frac{\\partial v}{\\partial x} - \\frac{\\partial u}{\\partial y} \\right) \\,\\mathrm{d}A,\n$$\n出发，通过在每条边上应用中点法则，并使用 C-网格上同位配置的边值 $u_{i,j\\pm 1/2}$ 和 $v_{i\\pm 1/2,j}$，构造一个环流的二阶精度离散近似。然后将单元格平均垂直涡度 $\\zeta_{i,j}$ 定义为离散环流除以单元格面积 $\\Delta x \\,\\Delta y$。明确指出由逆时针路径方向决定的每条边贡献的符号。\n\n2) 对于一个具体的、科学上合理的情况，给定均匀间距 $\\Delta x = 1.0 \\times 10^{5}\\ \\mathrm{m}$ 和 $\\Delta y = 2.0 \\times 10^{5}\\ \\mathrm{m}$，以及位于单元格 $(i,j)$ 边中心的速度\n$$\nu_{i,\\,j+1/2} = 6.0\\ \\mathrm{m\\,s^{-1}},\\quad u_{i,\\,j-1/2} = 2.0\\ \\mathrm{m\\,s^{-1}},\\quad v_{i+1/2,\\,j} = 1.0\\ \\mathrm{m\\,s^{-1}},\\quad v_{i-1/2,\\,j} = -3.0\\ \\mathrm{m\\,s^{-1}},\n$$\n计算从你的离散构造中得到的单元格平均垂直涡度 $\\zeta_{i,j}$。\n\n将 $\\zeta_{i,j}$ 的最终数值答案以 $\\mathrm{s^{-1}}$ 为单位表示。无需四舍五入。",
            "solution": "该问题是有效的，因为它科学地基于矢量微积分和数值流体力学的原理，是适定的（提供了所有必要信息），并且是客观陈述的。我们可以开始求解。\n\n问题要求做两件事：首先，从连续形式的斯托克斯定理推导单元格平均垂直涡度的离散近似；其次，根据一组给定的参数计算其值。\n\n第1部分：离散垂直涡度的推导。\n\n我们从二维连续形式的斯托克斯定理开始，该定理将矢量场 $\\boldsymbol{u}$ 沿闭合曲线 $\\partial A$ 的环流与 $\\boldsymbol{u}$ 的旋度在由该曲线围成的区域 $A$ 上的积分联系起来。对于一个二维速度场 $\\boldsymbol{u} = u\\hat{\\mathbf{i}} + v\\hat{\\mathbf{j}}$，其旋度的垂直分量是 $\\left(\\nabla \\times \\boldsymbol{u}\\right)_z = \\frac{\\partial v}{\\partial x} - \\frac{\\partial u}{\\partial y}$。该定理表述为：\n$$\n\\oint_{\\partial A_{i,j}} \\boldsymbol{u} \\cdot \\mathrm{d}\\boldsymbol{\\ell} \\;=\\; \\iint_{A_{i,j}} \\left( \\frac{\\partial v}{\\partial x} - \\frac{\\partial u}{\\partial y} \\right) \\,\\mathrm{d}A\n$$\n左边的积分是环流，我们将其记为 $C_{i,j}$。单元格 $A_{i,j}$ 是一个宽为 $\\Delta x$、高为 $\\Delta y$ 的矩形。其角点位于 $(x_{i-1/2}, y_{j-1/2})$、$(x_{i+1/2}, y_{j-1/2})$、$(x_{i+1/2}, y_{j+1/2})$ 和 $(x_{i-1/2}, y_{j+1/2})$。积分路径 $\\partial A_{i,j}$ 沿该单元格的四条边逆时针进行。我们可以将线积分分解为四个部分：南边、东边、北边和西边。\n$$\nC_{i,j} = \\int_{\\text{south}} \\boldsymbol{u} \\cdot \\mathrm{d}\\boldsymbol{\\ell} + \\int_{\\text{east}} \\boldsymbol{u} \\cdot \\mathrm{d}\\boldsymbol{\\ell} + \\int_{\\text{north}} \\boldsymbol{u} \\cdot \\mathrm{d}\\boldsymbol{\\ell} + \\int_{\\text{west}} \\boldsymbol{u} \\cdot \\mathrm{d}\\boldsymbol{\\ell}\n$$\n让我们计算每个部分：\n1.  南边：路径从 $(x_{i-1/2}, y_{j-1/2})$ 到 $(x_{i+1/2}, y_{j-1/2})$。这里，$\\mathrm{d}\\boldsymbol{\\ell} = \\mathrm{d}x\\,\\hat{\\mathbf{i}}$。积分为 $\\int_{x_{i-1/2}}^{x_{i+1/2}} u(x, y_{j-1/2}) \\,\\mathrm{d}x$。我们应用中点法则。该边的中点是 $(x_i, y_{j-1/2})$，此处给定的速度值为 $u_{i,j-1/2}$。边的长度为 $\\Delta x$。积分近似为 $u_{i,j-1/2} \\Delta x$。符号为正。\n\n2.  东边：路径从 $(x_{i+1/2}, y_{j-1/2})$ 到 $(x_{i+1/2}, y_{j+1/2})$。这里，$\\mathrm{d}\\boldsymbol{\\ell} = \\mathrm{d}y\\,\\hat{\\mathbf{j}}$。积分为 $\\int_{y_{j-1/2}}^{y_{j+1/2}} v(x_{i+1/2}, y) \\,\\mathrm{d}y$。该边的中点是 $(x_{i+1/2}, y_j)$，此处速度为 $v_{i+1/2,j}$。边的长度为 $\\Delta y$。积分近似为 $v_{i+1/2,j} \\Delta y$。符号为正。\n\n3.  北边：路径从 $(x_{i+1/2}, y_{j+1/2})$ 到 $(x_{i-1/2}, y_{j+1/2})$。这里，$\\mathrm{d}\\boldsymbol{\\ell} = -\\mathrm{d}x\\,\\hat{\\mathbf{i}}$。积分为 $\\int_{x_{i-1/2}}^{x_{i+1/2}} -u(x, y_{j+1/2}) \\,\\mathrm{d}x$。该边的中点是 $(x_i, y_{j+1/2})$，此处速度为 $u_{i,j+1/2}$。边的长度为 $\\Delta x$。积分近似为 $-u_{i,j+1/2} \\Delta x$。符号为负。\n\n4.  西边：路径从 $(x_{i-1/2}, y_{j+1/2})$ 到 $(x_{i-1/2}, y_{j-1/2})$。这里，$\\mathrm{d}\\boldsymbol{\\ell} = -\\mathrm{d}y\\,\\hat{\\mathbf{j}}$。积分为 $\\int_{y_{j-1/2}}^{y_{j+1/2}} -v(x_{i-1/2}, y) \\,\\mathrm{d}y$。该边的中点是 $(x_{i-1/2}, y_j)$，此处速度为 $v_{i-1/2,j}$。边的长度为 $\\Delta y$。积分近似为 $-v_{i-1/2,j} \\Delta y$。符号为负。\n\n将这四个贡献相加，得到离散环流 $C_{i,j}$：\n$$\nC_{i,j} = \\left(u_{i,j-1/2} \\Delta x\\right) + \\left(v_{i+1/2,j} \\Delta y\\right) - \\left(u_{i,j+1/2} \\Delta x\\right) - \\left(v_{i-1/2,j} \\Delta y\\right)\n$$\n单元格平均垂直涡度 $\\zeta_{i,j}$ 定义为环流除以单元格面积 $A_{i,j} = \\Delta x \\Delta y$。\n$$\n\\zeta_{i,j} = \\frac{C_{i,j}}{A_{i,j}} = \\frac{u_{i,j-1/2} \\Delta x + v_{i+1/2,j} \\Delta y - u_{i,j+1/2} \\Delta x - v_{i-1/2,j} \\Delta y}{\\Delta x \\Delta y}\n$$\n重新整理各项并化简，我们得到：\n$$\n\\zeta_{i,j} = \\frac{v_{i+1/2,j} \\Delta y - v_{i-1/2,j} \\Delta y}{\\Delta x \\Delta y} - \\frac{u_{i,j+1/2} \\Delta x - u_{i,j-1/2} \\Delta x}{\\Delta x \\Delta y}\n$$\n$$\n\\zeta_{i,j} = \\frac{v_{i+1/2,j} - v_{i-1/2,j}}{\\Delta x} - \\frac{u_{i,j+1/2} - u_{i,j-1/2}}{\\Delta y}\n$$\n这个表达式是在 Arakawa C-网格上对垂直涡度 $\\frac{\\partial v}{\\partial x} - \\frac{\\partial u}{\\partial y}$ 的标准二阶精度有限差分近似。\n\n第2部分：单元格平均垂直涡度的计算。\n\n给定以下数值：\n$\\Delta x = 1.0 \\times 10^{5}\\ \\mathrm{m}$\n$\\Delta y = 2.0 \\times 10^{5}\\ \\mathrm{m}$\n$u_{i,\\,j+1/2} = 6.0\\ \\mathrm{m\\,s^{-1}}$\n$u_{i,\\,j-1/2} = 2.0\\ \\mathrm{m\\,s^{-1}}$\n$v_{i+1/2,\\,j} = 1.0\\ \\mathrm{m\\,s^{-1}}$\n$v_{i-1/2,\\,j} = -3.0\\ \\mathrm{m\\,s^{-1}}$\n\n我们将这些数值代入推导出的 $\\zeta_{i,j}$ 公式中：\n$$\n\\zeta_{i,j} = \\frac{(1.0\\ \\mathrm{m\\,s^{-1}}) - (-3.0\\ \\mathrm{m\\,s^{-1}})}{1.0 \\times 10^{5}\\ \\mathrm{m}} - \\frac{(6.0\\ \\mathrm{m\\,s^{-1}}) - (2.0\\ \\mathrm{m\\,s^{-1}})}{2.0 \\times 10^{5}\\ \\mathrm{m}}\n$$\n$$\n\\zeta_{i,j} = \\frac{4.0\\ \\mathrm{m\\,s^{-1}}}{1.0 \\times 10^{5}\\ \\mathrm{m}} - \\frac{4.0\\ \\mathrm{m\\,s^{-1}}}{2.0 \\times 10^{5}\\ \\mathrm{m}}\n$$\n$$\n\\zeta_{i,j} = (4.0 \\times 10^{-5}\\ \\mathrm{s^{-1}}) - (2.0 \\times 10^{-5}\\ \\mathrm{s^{-1}})\n$$\n$$\n\\zeta_{i,j} = 2.0 \\times 10^{-5}\\ \\mathrm{s^{-1}}\n$$\n最终得到的单元格平均垂直涡度为 $2.0 \\times 10^{-5}\\ \\mathrm{s^{-1}}$。",
            "answer": "$$\n\\boxed{2.0 \\times 10^{-5}}\n$$"
        }
    ]
}