{
    "hands_on_practices": [
        {
            "introduction": "The Divergence Theorem is the mathematical bedrock for physical conservation laws, such as the conservation of mass, energy, and momentum. This practice illustrates how the theorem is used to construct a discrete divergence operator within a finite-volume numerical model, the workhorse of modern weather and climate prediction . By proving that the sum of local flux divergences over all grid cells reduces to the net flux across the domain's outer boundary, you will uncover the elegant principle of telescoping sums that guarantees discrete conservation, a property essential for the long-term stability of climate simulations.",
            "id": "4108983",
            "problem": "In a finite-volume dynamical core used in Numerical Weather Prediction (NWP), prognostic equations are advanced by enforcing integral conservation of extensive quantities over grid cells. Consider a rectangular domain $[0,L_{x}]\\times[0,L_{y}]\\times[0,L_{z}]$ discretized by a uniform rectilinear grid with $N_{x}\\times N_{y}\\times N_{z}$ control volumes of sizes $\\Delta x=L_{x}/N_{x}$, $\\Delta y=L_{y}/N_{y}$, $\\Delta z=L_{z}/N_{z}$, and cell volume $\\Delta V=\\Delta x\\,\\Delta y\\,\\Delta z$. Let $\\mathbf{F}(x,y,z)$ denote a face-normal flux density field (for example, a mass or tracer flux density) that is smooth in space.\n\nStarting from the integral conservation law for a passive tracer with flux $\\mathbf{F}$ and no sources,\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\int_{V}\\!q\\,\\mathrm{d}V \\;=\\; -\\oint_{\\partial V}\\!\\mathbf{F}\\cdot\\mathbf{n}\\,\\mathrm{d}S,\n$$\nand using the Gauss divergence theorem as the fundamental bridge between volume and surface integrals, derive a second-order accurate finite-volume discrete representation of the divergence $\\nabla\\cdot\\mathbf{F}$ on this grid that uses outward-oriented face-normal fluxes evaluated at cell faces and exact face areas. Then, by summing this discrete divergence over all control volumes in the domain (each multiplied by its volume), prove that all internal face contributions cancel exactly so that the remaining total is a sum over only the physical boundary faces of the domain.\n\nFinally, apply your result to the synthetic flux field\n$$\n\\mathbf{F}(x,y,z)\\;=\\;\\big(a\\,x,\\;b\\,y,\\;c\\,z\\big),\n$$\nwith $a=2.0\\times 10^{-7}$, $b=3.0\\times 10^{-7}$, $c=4.0\\times 10^{-7}$ (each having units $\\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$ so that $\\mathbf{F}$ has units $\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$), and domain dimensions $L_{x}=6.0\\times 10^{5}$, $L_{y}=4.0\\times 10^{5}$, $L_{z}=1.0\\times 10^{4}$ (in $\\mathrm{m}$). Take $N_{x}=60$, $N_{y}=40$, $N_{z}=20$. Using your discrete telescoping result, compute the net outward flux through the entire domain boundary implied by the discrete divergence summed over all cells, and express the final answer in $\\mathrm{kg}\\,\\mathrm{s}^{-1}$. Round your answer to three significant figures. All angles, if any appear, should be expressed in radians.",
            "solution": "The problem asks for three main tasks: first, to derive a second-order accurate finite-volume discrete representation of the divergence $\\nabla\\cdot\\mathbf{F}$; second, to prove that the sum of this discrete divergence over all grid cells telescopes to a sum over the domain's boundary faces; and third, to apply this result to compute the total net outward flux for a given synthetic flux field $\\mathbf{F}$.\n\nLet us consider a single control volume (or grid cell) $V_{i,j,k}$ for indices $i \\in \\{1,...,N_x\\}$, $j \\in \\{1,...,N_y\\}$, and $k \\in \\{1,...,N_z\\}$. On a uniform rectilinear grid, this cell occupies the space $[x_{i-1/2}, x_{i+1/2}] \\times [y_{j-1/2}, y_{j+1/2}] \\times [z_{k-1/2}, z_{k+1/2}]$, where the face locations are given by $x_{i \\pm 1/2}$, $y_{j \\pm 1/2}$, and $z_{k \\pm 1/2}$. For the domain $[0,L_{x}]\\times[0,L_{y}]\\times[0,L_{z}]$, we can define the face coordinates as $x_{i-1/2} = (i-1)\\Delta x$, $y_{j-1/2} = (j-1)\\Delta y$, and $z_{k-1/2} = (k-1)\\Delta z$. The volume of the cell is $\\Delta V = \\Delta x \\Delta y \\Delta z$.\n\n**Part 1: Derivation of the Discrete Divergence**\n\nThe fundamental relationship between the divergence of a vector field $\\mathbf{F}$ within a volume $V$ and the flux of that field through the volume's boundary surface $\\partial V$ is given by the Gauss divergence theorem:\n$$\n\\int_{V} \\nabla\\cdot\\mathbf{F} \\, \\mathrm{d}V = \\oint_{\\partial V} \\mathbf{F}\\cdot\\mathbf{n} \\, \\mathrm{d}S\n$$\nwhere $\\mathbf{n}$ is the outward-pointing unit normal vector on the surface $\\partial V$.\n\nIn the finite-volume method, we define the cell-averaged divergence, denoted $(\\nabla\\cdot\\mathbf{F})_{i,j,k}$, as:\n$$\n(\\nabla\\cdot\\mathbf{F})_{i,j,k} = \\frac{1}{\\Delta V} \\int_{V_{i,j,k}} \\nabla\\cdot\\mathbf{F} \\, \\mathrm{d}V\n$$\nApplying the divergence theorem to the cell $V_{i,j,k}$, we get:\n$$\n(\\nabla\\cdot\\mathbf{F})_{i,j,k} = \\frac{1}{\\Delta V} \\oint_{\\partial V_{i,j,k}} \\mathbf{F}\\cdot\\mathbf{n} \\, \\mathrm{d}S\n$$\nThe surface integral on the right is over the six faces of the rectangular cell. We can express this as the sum of fluxes through each face. Let $\\mathbf{F} = (F_x, F_y, F_z)$. The surface integral is:\n\\begin{align*} \\oint_{\\partial V_{i,j,k}} \\mathbf{F}\\cdot\\mathbf{n} \\, \\mathrm{d}S =  \\int_{y_{j-1/2}}^{y_{j+1/2}}\\int_{z_{k-1/2}}^{z_{k+1/2}} F_x(x_{i+1/2},y,z) \\, \\mathrm{d}z\\mathrm{d}y \\\\ - \\int_{y_{j-1/2}}^{y_{j+1/2}}\\int_{z_{k-1/2}}^{z_{k+1/2}} F_x(x_{i-1/2},y,z) \\, \\mathrm{d}z\\mathrm{d}y \\\\ + \\int_{x_{i-1/2}}^{x_{i+1/2}}\\int_{z_{k-1/2}}^{z_{k+1/2}} F_y(x,y_{j+1/2},z) \\, \\mathrm{d}z\\mathrm{d}x \\\\ - \\int_{x_{i-1/2}}^{x_{i+1/2}}\\int_{z_{k-1/2}}^{z_{k+1/2}} F_y(x,y_{j-1/2},z) \\, \\mathrm{d}z\\mathrm{d}x \\\\ + \\int_{x_{i-1/2}}^{x_{i+1/2}}\\int_{y_{j-1/2}}^{y_{j+1/2}} F_z(x,y,z_{k+1/2}) \\, \\mathrm{d}y\\mathrm{d}x \\\\ - \\int_{x_{i-1/2}}^{x_{i+1/2}}\\int_{y_{j-1/2}}^{y_{j+1/2}} F_z(x,y,z_{k-1/2}) \\, \\mathrm{d}y\\mathrm{d}x \\end{align*}\nThe problem states we should use fluxes evaluated at cell faces. This corresponds to approximating each face integral using the midpoint rule, which is second-order accurate. For example, the integral over the \"right\" face (at $x=x_{i+1/2}$) is approximated as:\n$$\n\\int_{y_{j-1/2}}^{y_{j+1/2}}\\int_{z_{k-1/2}}^{z_{k+1/2}} F_x(x_{i+1/2},y,z) \\, \\mathrm{d}z\\mathrm{d}y \\approx F_x(x_{i+1/2},y_j,z_k) \\Delta y \\Delta z\n$$\nwhere $(x_{i+1/2}, y_j, z_k)$ is the center of the face. We denote the flux value at this face center as $(F_x)_{i+1/2,j,k}$. The face areas are $\\Delta S_x = \\Delta y \\Delta z$, $\\Delta S_y = \\Delta x \\Delta z$, and $\\Delta S_z = \\Delta x \\Delta y$. Applying this approximation to all six faces, the total outward flux becomes:\n$$\n\\oint_{\\partial V_{i,j,k}} \\mathbf{F}\\cdot\\mathbf{n} \\, \\mathrm{d}S \\approx \\left[ (F_x)_{i+1/2,j,k} - (F_x)_{i-1/2,j,k} \\right]\\Delta y \\Delta z + \\left[ (F_y)_{i,j+1/2,k} - (F_y)_{i,j-1/2,k} \\right]\\Delta x \\Delta z + \\left[ (F_z)_{i,j,k+1/2} - (F_z)_{i,j,k-1/2} \\right]\\Delta x \\Delta y\n$$\nSubstituting this into the expression for the discrete divergence and using $\\Delta V = \\Delta x \\Delta y \\Delta z$ gives our desired representation:\n$$\n(\\nabla\\cdot\\mathbf{F})_{i,j,k} = \\frac{(F_x)_{i+1/2,j,k} - (F_x)_{i-1/2,j,k}}{\\Delta x} + \\frac{(F_y)_{i,j+1/2,k} - (F_y)_{i,j-1/2,k}}{\\Delta y} + \\frac{(F_z)_{i,j,k+1/2} - (F_z)_{i,j,k-1/2}}{\\Delta z}\n$$\nThis is a second-order accurate discretization of the divergence on a uniform grid.\n\n**Part 2: Proof of the Telescoping Sum**\n\nThe problem asks to sum the discrete divergence over all control volumes, with each term multiplied by its volume $\\Delta V$. Let this sum be $\\Phi_{total}$.\n$$\n\\Phi_{total} = \\sum_{i=1}^{N_x} \\sum_{j=1}^{N_y} \\sum_{k=1}^{N_z} (\\nabla\\cdot\\mathbf{F})_{i,j,k} \\Delta V\n$$\nUsing the intermediate expression for the flux integral, we have:\n$$\n(\\nabla\\cdot\\mathbf{F})_{i,j,k} \\Delta V = \\left[ (F_x)_{i+1/2,j,k} - (F_x)_{i-1/2,j,k} \\right]\\Delta S_x + \\left[ (F_y)_{i,j+1/2,k} - (F_y)_{i,j-1/2,k} \\right]\\Delta S_y + \\left[ (F_z)_{i,j,k+1/2} - (F_z)_{i,j,k-1/2} \\right]\\Delta S_z\n$$\nLet's analyze the sum of the $x$-component terms:\n$$\n\\sum_{i=1}^{N_x} \\sum_{j=1}^{N_y} \\sum_{k=1}^{N_z} \\left[ (F_x)_{i+1/2,j,k} - (F_x)_{i-1/2,j,k} \\right]\\Delta S_x\n$$\nConsider the innermost sum over the index $i$ for fixed $j$ and $k$:\n$$\n\\sum_{i=1}^{N_x} \\left[ (F_x)_{i+1/2,j,k} - (F_x)_{i-1/2,j,k} \\right]\n$$\nThis is a telescoping sum. Let's expand it:\n$$\n\\left((F_x)_{3/2} - (F_x)_{1/2}\\right) + \\left((F_x)_{5/2} - (F_x)_{3/2}\\right) + \\dots + \\left((F_x)_{N_x+1/2} - (F_x)_{N_x-1/2}\\right)\n$$\nThe flux at any interior face, $(F_x)_{i+1/2,j,k}$, is the outward flux for cell $(i,j,k)$ and contributes with a positive sign. For the adjacent cell $(i+1,j,k)$, this same face is its left face, $x_{(i+1)-1/2}$, and the flux contributes with a negative sign. Thus, all internal face contributions cancel out. The only terms that survive are from the faces at the domain boundaries: the first face at $i=1/2$ (i.e., $x=0$) and the last face at $i=N_x+1/2$ (i.e., $x=L_x$). The sum simplifies to:\n$$\n(F_x)_{N_x+1/2,j,k} - (F_x)_{1/2,j,k}\n$$\nThe total sum for the $x$-component is therefore the sum of fluxes over the boundary faces at $x=L_x$ and $x=0$:\n$$\n\\sum_{j=1}^{N_y} \\sum_{k=1}^{N_z} \\left[ (F_x)_{N_x+1/2,j,k} - (F_x)_{1/2,j,k} \\right]\\Delta S_x\n$$\nBy analogy, the sums for the $y$ and $z$ components also telescope, leaving only the fluxes through the faces at $y=0, L_y$ and $z=0, L_z$. The total sum $\\Phi_{total}$ is the sum of outward fluxes over all the boundary faces of the entire domain $[0,L_x]\\times[0,L_y]\\times[0,L_z]$. This proves that the discrete sum is conservative and equivalent to a surface integral over the global boundary, mirroring the Gauss divergence theorem for the entire domain.\n\n**Part 3: Application to the Synthetic Flux Field**\n\nWe are given the flux field $\\mathbf{F}(x,y,z) = (ax, by, cz)$. The continuous divergence is $\\nabla\\cdot\\mathbf{F} = \\frac{\\partial(ax)}{\\partial x} + \\frac{\\partial(by)}{\\partial y} + \\frac{\\partial(cz)}{\\partial z} = a+b+c$. Since the divergence is a constant, the exact total net outward flux $\\Phi$ is simply the divergence multiplied by the total volume $V = L_x L_y L_z$:\n$$\n\\Phi = \\int_{V} \\nabla\\cdot\\mathbf{F} \\, \\mathrm{d}V = (a+b+c)V = (a+b+c)L_x L_y L_z\n$$\nFor this linear flux field, our second-order discrete operator is exact. The flux at face $x_{i+1/2}=i\\Delta x$ is $(F_x)_{i+1/2,j,k} = a(i\\Delta x)$. The flux at face $x_{i-1/2}=(i-1)\\Delta x$ is $(F_x)_{i-1/2,j,k} = a((i-1)\\Delta x)$. The discrete $x$-derivative is $\\frac{a(i\\Delta x) - a((i-1)\\Delta x)}{\\Delta x} = a$. Similarly, the other terms are $b$ and $c$. So, $(\\nabla\\cdot\\mathbf{F})_{i,j,k} = a+b+c$ for all cells.\nThe total sum is $\\Phi_{total} = \\sum_{i,j,k} (a+b+c)\\Delta V = (a+b+c)\\sum_{i,j,k}\\Delta V = (a+b+c)L_x L_y L_z$. The discrete calculation yields the exact continuous result.\n\nNow, we substitute the given numerical values:\n$a = 2.0 \\times 10^{-7} \\, \\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$\n$b = 3.0 \\times 10^{-7} \\, \\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$\n$c = 4.0 \\times 10^{-7} \\, \\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}$\n$L_x = 6.0 \\times 10^5 \\, \\mathrm{m}$\n$L_y = 4.0 \\times 10^5 \\, \\mathrm{m}$\n$L_z = 1.0 \\times 10^4 \\, \\mathrm{m}$\n\nFirst, calculate the sum of the divergence constants:\n$$\na+b+c = (2.0 + 3.0 + 4.0) \\times 10^{-7} = 9.0 \\times 10^{-7} \\, \\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}\n$$\nNext, calculate the total volume of the domain:\n$$\nV = L_x L_y L_z = (6.0 \\times 10^5 \\, \\mathrm{m}) \\times (4.0 \\times 10^5 \\, \\mathrm{m}) \\times (1.0 \\times 10^4 \\, \\mathrm{m})\n$$\n$$\nV = (6.0 \\times 4.0 \\times 1.0) \\times 10^{5+5+4} \\, \\mathrm{m}^3 = 24.0 \\times 10^{14} \\, \\mathrm{m}^3 = 2.4 \\times 10^{15} \\, \\mathrm{m}^3\n$$\nFinally, compute the total net outward flux $\\Phi$:\n$$\n\\Phi = (a+b+c)V = (9.0 \\times 10^{-7} \\, \\mathrm{kg}\\,\\mathrm{m}^{-3}\\,\\mathrm{s}^{-1}) \\times (2.4 \\times 10^{15} \\, \\mathrm{m}^3)\n$$\n$$\n\\Phi = (9.0 \\times 2.4) \\times 10^{-7+15} \\, \\mathrm{kg}\\,\\mathrm{s}^{-1} = 21.6 \\times 10^{8} \\, \\mathrm{kg}\\,\\mathrm{s}^{-1}\n$$\nWriting this in standard scientific notation gives:\n$$\n\\Phi = 2.16 \\times 10^9 \\, \\mathrm{kg}\\,\\mathrm{s}^{-1}\n$$\nThe problem asks for the answer to be rounded to three significant figures. The calculated value $2.16 \\times 10^9$ already has exactly three significant figures.",
            "answer": "$$\n\\boxed{2.16 \\times 10^9}\n$$"
        },
        {
            "introduction": "Analogous to the role of divergence in mass conservation, the concept of curl, or vorticity, is fundamental to describing the rotational dynamics of fluid flow. This exercise serves as a direct counterpart to the previous one, this time applying Stokes' Theorem to derive a discrete operator for vertical vorticity on an Arakawa C-grid, a widely used staggered grid arrangement in atmospheric and oceanic models . This practice connects the physical concept of circulation to its numerical representation, reinforcing how integral theorems provide a robust framework for discretizing key dynamical quantities.",
            "id": "4108981",
            "problem": "In a Numerical Weather Prediction (NWP) dynamical core, the horizontal momentum is often discretized on an Arakawa C-grid (C-grid), where the horizontal velocity components are staggered on the cell edges: the east–west component $u$ is stored at the centers of the horizontal edges (south and north edges), and the north–south component $v$ is stored at the centers of the vertical edges (west and east edges). Consider a single rectangular cell with uniform spacings $\\Delta x$ and $\\Delta y$, oriented with its edges parallel to the coordinate axes. The cell center $(i,j)$ is the location of scalar quantities such as the vertical component of vorticity.\n\nStarting only from the continuous Stokes theorem and standard definitions, proceed as follows:\n\n1) Using the counterclockwise orientation for the circulation around the cell boundary $\\partial A_{i,j}$, begin from the continuous Stokes theorem\n$$\n\\oint_{\\partial A_{i,j}} \\boldsymbol{u} \\cdot \\mathrm{d}\\boldsymbol{\\ell} \\;=\\; \\iint_{A_{i,j}} \\left( \\frac{\\partial v}{\\partial x} - \\frac{\\partial u}{\\partial y} \\right) \\,\\mathrm{d}A,\n$$\nand construct a second-order accurate discrete approximation for the circulation by applying the midpoint rule on each edge, using the C-grid collocated edge values $u_{i,j\\pm 1/2}$ and $v_{i\\pm 1/2,j}$. Then define the cell-averaged vertical vorticity $\\zeta_{i,j}$ as the discrete circulation divided by the cell area $\\Delta x \\,\\Delta y$. Explicitly identify the signs associated with each edge contribution implied by the counterclockwise path orientation.\n\n2) For a specific, scientifically plausible case with uniform spacings $\\Delta x = 1.0 \\times 10^{5}\\ \\mathrm{m}$ and $\\Delta y = 2.0 \\times 10^{5}\\ \\mathrm{m}$, and edge-centered velocities at the cell $(i,j)$ given by\n$$\nu_{i,\\,j+1/2} = 6.0\\ \\mathrm{m\\,s^{-1}},\\quad u_{i,\\,j-1/2} = 2.0\\ \\mathrm{m\\,s^{-1}},\\quad v_{i+1/2,\\,j} = 1.0\\ \\mathrm{m\\,s^{-1}},\\quad v_{i-1/2,\\,j} = -3.0\\ \\mathrm{m\\,s^{-1}},\n$$\nevaluate the cell-averaged vertical vorticity $\\zeta_{i,j}$ obtained from your discrete construction.\n\nExpress your final numerical answer for $\\zeta_{i,j}$ in $\\mathrm{s^{-1}}$. No rounding is necessary.",
            "solution": "The problem asks for two things: first, to derive a discrete approximation for the cell-averaged vertical vorticity from the continuous Stokes theorem, and second, to calculate its value for a given set of parameters.\n\nPart 1: Derivation of the discrete vertical vorticity.\n\nWe begin with the continuous Stokes theorem in two dimensions, which relates the circulation of a vector field $\\boldsymbol{u}$ around a closed curve $\\partial A$ to the integral of the curl of $\\boldsymbol{u}$ over the area $A$ enclosed by the curve. For a two-dimensional velocity field $\\boldsymbol{u} = u\\hat{\\mathbf{i}} + v\\hat{\\mathbf{j}}$, the vertical component of the curl is $\\left(\\nabla \\times \\boldsymbol{u}\\right)_z = \\frac{\\partial v}{\\partial x} - \\frac{\\partial u}{\\partial y}$. The theorem is given as:\n$$\n\\oint_{\\partial A_{i,j}} \\boldsymbol{u} \\cdot \\mathrm{d}\\boldsymbol{\\ell} \\;=\\; \\iint_{A_{i,j}} \\left( \\frac{\\partial v}{\\partial x} - \\frac{\\partial u}{\\partial y} \\right) \\,\\mathrm{d}A\n$$\nThe integral on the left is the circulation, which we will denote as $C_{i,j}$. The cell $A_{i,j}$ is a rectangle with width $\\Delta x$ and height $\\Delta y$. Its corners are at $(x_{i-1/2}, y_{j-1/2})$, $(x_{i+1/2}, y_{j-1/2})$, $(x_{i+1/2}, y_{j+1/2})$, and $(x_{i-1/2}, y_{j+1/2})$. The path of integration $\\partial A_{i,j}$ is taken counterclockwise along the four edges of this cell. We can break the line integral into four parts: south, east, north, and west edges.\n$$\nC_{i,j} = \\int_{\\text{south}} \\boldsymbol{u} \\cdot \\mathrm{d}\\boldsymbol{\\ell} + \\int_{\\text{east}} \\boldsymbol{u} \\cdot \\mathrm{d}\\boldsymbol{\\ell} + \\int_{\\text{north}} \\boldsymbol{u} \\cdot \\mathrm{d}\\boldsymbol{\\ell} + \\int_{\\text{west}} \\boldsymbol{u} \\cdot \\mathrm{d}\\boldsymbol{\\ell}\n$$\nLet's evaluate each segment:\n1.  South edge: The path is from $(x_{i-1/2}, y_{j-1/2})$ to $(x_{i+1/2}, y_{j-1/2})$. Here, $\\mathrm{d}\\boldsymbol{\\ell} = \\mathrm{d}x\\,\\hat{\\mathbf{i}}$. The integral is $\\int_{x_{i-1/2}}^{x_{i+1/2}} u(x, y_{j-1/2}) \\,\\mathrm{d}x$. We apply the midpoint rule. The midpoint of this edge is $(x_i, y_{j-1/2})$, where the velocity value is given as $u_{i,j-1/2}$. The length of the edge is $\\Delta x$. The integral is approximated as $u_{i,j-1/2} \\Delta x$. The sign is positive.\n\n2.  East edge: The path is from $(x_{i+1/2}, y_{j-1/2})$ to $(x_{i+1/2}, y_{j+1/2})$. Here, $\\mathrm{d}\\boldsymbol{\\ell} = \\mathrm{d}y\\,\\hat{\\mathbf{j}}$. The integral is $\\int_{y_{j-1/2}}^{y_{j+1/2}} v(x_{i+1/2}, y) \\,\\mathrm{d}y$. The midpoint is $(x_{i+1/2}, y_j)$, where the velocity is $v_{i+1/2,j}$. The length of the edge is $\\Delta y$. The integral is approximated as $v_{i+1/2,j} \\Delta y$. The sign is positive.\n\n3.  North edge: The path is from $(x_{i+1/2}, y_{j+1/2})$ to $(x_{i-1/2}, y_{j+1/2})$. Here, $\\mathrm{d}\\boldsymbol{\\ell} = -\\mathrm{d}x\\,\\hat{\\mathbf{i}}$. The integral is $\\int_{x_{i+1/2}}^{x_{i-1/2}} u(x, y_{j+1/2}) (-\\mathrm{d}x) = -\\int_{x_{i-1/2}}^{x_{i+1/2}} u(x, y_{j+1/2}) \\,\\mathrm{d}x$. The midpoint is $(x_i, y_{j+1/2})$, where the velocity is $u_{i,j+1/2}$. The length is $\\Delta x$. The integral is approximated as $-u_{i,j+1/2} \\Delta x$. The sign is negative.\n\n4.  West edge: The path is from $(x_{i-1/2}, y_{j+1/2})$ to $(x_{i-1/2}, y_{j-1/2})$. Here, $\\mathrm{d}\\boldsymbol{\\ell} = -\\mathrm{d}y\\,\\hat{\\mathbf{j}}$. The integral is $\\int_{y_{j+1/2}}^{y_{j-1/2}} v(x_{i-1/2}, y) (-\\mathrm{d}y) = -\\int_{y_{j-1/2}}^{y_{j+1/2}} v(x_{i-1/2}, y) \\,\\mathrm{d}y$. The midpoint is $(x_{i-1/2}, y_j)$, where the velocity is $v_{i-1/2,j}$. The length is $\\Delta y$. The integral is approximated as $-v_{i-1/2,j} \\Delta y$. The sign is negative.\n\nSumming these four contributions gives the discrete circulation $C_{i,j}$:\n$$\nC_{i,j} = \\left(u_{i,j-1/2} \\Delta x\\right) + \\left(v_{i+1/2,j} \\Delta y\\right) - \\left(u_{i,j+1/2} \\Delta x\\right) - \\left(v_{i-1/2,j} \\Delta y\\right)\n$$\nThe cell-averaged vertical vorticity, $\\zeta_{i,j}$, is defined as the circulation divided by the cell area, $A_{i,j} = \\Delta x \\Delta y$.\n$$\n\\zeta_{i,j} = \\frac{C_{i,j}}{A_{i,j}} = \\frac{u_{i,j-1/2} \\Delta x + v_{i+1/2,j} \\Delta y - u_{i,j+1/2} \\Delta x - v_{i-1/2,j} \\Delta y}{\\Delta x \\Delta y}\n$$\nRearranging the terms and simplifying, we obtain:\n$$\n\\zeta_{i,j} = \\frac{v_{i+1/2,j} \\Delta y - v_{i-1/2,j} \\Delta y}{\\Delta x \\Delta y} - \\frac{u_{i,j+1/2} \\Delta x - u_{i,j-1/2} \\Delta x}{\\Delta x \\Delta y}\n$$\n$$\n\\zeta_{i,j} = \\frac{v_{i+1/2,j} - v_{i-1/2,j}}{\\Delta x} - \\frac{u_{i,j+1/2} - u_{i,j-1/2}}{\\Delta y}\n$$\nThis expression is the standard second-order accurate finite-difference approximation of the vertical vorticity $\\frac{\\partial v}{\\partial x} - \\frac{\\partial u}{\\partial y}$ on an Arakawa C-grid.\n\nPart 2: Calculation of the cell-averaged vertical vorticity.\n\nWe are given the following values:\n$\\Delta x = 1.0 \\times 10^{5}\\ \\mathrm{m}$\n$\\Delta y = 2.0 \\times 10^{5}\\ \\mathrm{m}$\n$u_{i,\\,j+1/2} = 6.0\\ \\mathrm{m\\,s^{-1}}$\n$u_{i,\\,j-1/2} = 2.0\\ \\mathrm{m\\,s^{-1}}$\n$v_{i+1/2,\\,j} = 1.0\\ \\mathrm{m\\,s^{-1}}$\n$v_{i-1/2,\\,j} = -3.0\\ \\mathrm{m\\,s^{-1}}$\n\nWe substitute these values into the derived formula for $\\zeta_{i,j}$:\n$$\n\\zeta_{i,j} = \\frac{(1.0\\ \\mathrm{m\\,s^{-1}}) - (-3.0\\ \\mathrm{m\\,s^{-1}})}{1.0 \\times 10^{5}\\ \\mathrm{m}} - \\frac{(6.0\\ \\mathrm{m\\,s^{-1}}) - (2.0\\ \\mathrm{m\\,s^{-1}})}{2.0 \\times 10^{5}\\ \\mathrm{m}}\n$$\n$$\n\\zeta_{i,j} = \\frac{4.0\\ \\mathrm{m\\,s^{-1}}}{1.0 \\times 10^{5}\\ \\mathrm{m}} - \\frac{4.0\\ \\mathrm{m\\,s^{-1}}}{2.0 \\times 10^{5}\\ \\mathrm{m}}\n$$\n$$\n\\zeta_{i,j} = (4.0 \\times 10^{-5}\\ \\mathrm{s^{-1}}) - (2.0 \\times 10^{-5}\\ \\mathrm{s^{-1}})\n$$\n$$\n\\zeta_{i,j} = 2.0 \\times 10^{-5}\\ \\mathrm{s^{-1}}\n$$\nThe resulting cell-averaged vertical vorticity is $2.0 \\times 10^{-5}\\ \\mathrm{s^{-1}}$.",
            "answer": "$$\n\\boxed{2.0 \\times 10^{-5}}\n$$"
        },
        {
            "introduction": "Vector calculus theorems are not only for building models but are also indispensable for analyzing and interpreting observational data. This final practice moves from idealized numerical grids to a practical diagnostic challenge: estimating the mean vorticity within a tropical cyclone from simulated aircraft measurements . By applying Stokes' theorem to a non-circular flight path with a non-uniform wind field, you will learn how to adapt these fundamental principles to the complexities of real-world measurements, bridging the gap between abstract theory and applied atmospheric science.",
            "id": "4109006",
            "problem": "A research flight supporting Numerical Weather Prediction (NWP) sampled the tangential wind around the eye of a mature tropical cyclone at approximately constant altitude where the flow may be treated as horizontally two-dimensional over the eye scale. The flight path was a closed, nearly circular curve centered on the vortex centroid and was purposely aligned with the local azimuthal direction to minimize radial wind contamination along the path. The vertical component of relative vorticity is to be inferred by invoking Stokes’ theorem applied to the horizontal velocity field over the area enclosed by the flight path. Assume Earth curvature is negligible over the sampling scale and angles are measured in radians.\n\nThe azimuthal coordinate is denoted by $\\theta \\in [0,2\\pi]$, the radius of the flight path is modeled as $r(\\theta) = R \\left(1 + \\epsilon \\cos(2\\theta)\\right)$, and the observed tangential wind along the path is modeled as $v_{\\theta}(\\theta) = V_{0}\\left(1 + \\mu \\cos(2\\theta) + \\nu \\sin(2\\theta) + \\sigma \\cos(3\\theta)\\right)$. The radial wind along the path may be neglected for this analysis. Use these values:\n- $R = 3.0 \\times 10^{4}\\ \\text{m}$,\n- $\\epsilon = 0.10$,\n- $V_{0} = 45\\ \\text{m}\\ \\text{s}^{-1}$,\n- $\\mu = 0.12$,\n- $\\nu = -0.05$,\n- $\\sigma = 0.04$.\n\nStarting from first principles and appropriate core definitions, compute the area-mean vertical component of the relative vorticity within the region enclosed by the flight path, explicitly accounting for the noncircular path geometry. Express your final mean vorticity in $\\text{s}^{-1}$ and round your answer to four significant figures. Do not approximate the eye as perfectly circular; incorporate the noncircular corrections that arise from the given $r(\\theta)$ and $v_{\\theta}(\\theta)$.",
            "solution": "The primary objective is to compute the area-mean vertical component of the relative vorticity, $\\langle \\zeta_z \\rangle$, enclosed by the flight path $C$. By definition, the area-mean of a scalar field $\\phi$ over a surface $S$ with area $A$ is given by $\\langle \\phi \\rangle = \\frac{1}{A} \\iint_S \\phi \\, dA$.\nIn this case, the scalar field is the vertical component of relative vorticity, $\\zeta_z$. Thus,\n$$ \\langle \\zeta_z \\rangle = \\frac{1}{A} \\iint_S \\zeta_z \\, dA $$\nThe vertical component of vorticity is the component of the curl of the velocity field $\\mathbf{v}$ in the vertical direction, which we take as $\\hat{\\mathbf{k}}$ in a local Cartesian system.\n$$ \\zeta_z = (\\nabla \\times \\mathbf{v}) \\cdot \\hat{\\mathbf{k}} $$\nThe surface integral of $\\zeta_z$ can be related to a line integral using Stokes' theorem. For a surface $S$ bounded by a closed curve $C$, Stokes' theorem states:\n$$ \\iint_S (\\nabla \\times \\mathbf{v}) \\cdot d\\mathbf{S} = \\oint_C \\mathbf{v} \\cdot d\\mathbf{l} $$\nSince the analysis is performed at a constant altitude, the surface $S$ is horizontal. The differential surface element is $d\\mathbf{S} = dA \\, \\hat{\\mathbf{k}}$. The left side of Stokes' theorem becomes:\n$$ \\iint_S (\\nabla \\times \\mathbf{v}) \\cdot (dA \\, \\hat{\\mathbf{k}}) = \\iint_S [(\\nabla \\times \\mathbf{v}) \\cdot \\hat{\\mathbf{k}}] \\, dA = \\iint_S \\zeta_z \\, dA $$\nThe line integral on the right side, $\\oint_C \\mathbf{v} \\cdot d\\mathbf{l}$, is the circulation, denoted by $\\Gamma$.\nSubstituting this into the definition of the mean vorticity, we get:\n$$ \\langle \\zeta_z \\rangle = \\frac{1}{A} \\oint_C \\mathbf{v} \\cdot d\\mathbf{l} = \\frac{\\Gamma}{A} $$\nThe problem is thus reduced to calculating the circulation $\\Gamma$ along the flight path and the area $A$ enclosed by it.\n\nFirst, we calculate the circulation $\\Gamma$. The flight path is given in polar coordinates by $r(\\theta) = R \\left(1 + \\epsilon \\cos(2\\theta)\\right)$. The position vector is $\\mathbf{r}(\\theta) = r(\\theta)\\hat{\\mathbf{r}}$, where $\\hat{\\mathbf{r}}$ is the radial unit vector. The differential line element $d\\mathbf{l}$ along the path is:\n$$ d\\mathbf{l} = \\frac{d\\mathbf{r}}{d\\theta} d\\theta = \\frac{d}{d\\theta}(r(\\theta)\\hat{\\mathbf{r}}) d\\theta = \\left( \\frac{dr}{d\\theta}\\hat{\\mathbf{r}} + r(\\theta)\\frac{d\\hat{\\mathbf{r}}}{d\\theta} \\right) d\\theta $$\nUsing the identity $\\frac{d\\hat{\\mathbf{r}}}{d\\theta} = \\hat{\\mathbf{\\theta}}$, where $\\hat{\\mathbf{\\theta}}$ is the azimuthal unit vector, we have:\n$$ d\\mathbf{l} = \\left( \\frac{dr}{d\\theta}\\hat{\\mathbf{r}} + r(\\theta)\\hat{\\mathbf{\\theta}} \\right) d\\theta $$\nThe velocity vector along the path is assumed to be purely tangential, as stated in the problem, so $\\mathbf{v} = v_{\\theta}(\\theta)\\hat{\\mathbf{\\theta}}$. The dot product $\\mathbf{v} \\cdot d\\mathbf{l}$ is:\n$$ \\mathbf{v} \\cdot d\\mathbf{l} = (v_{\\theta}(\\theta)\\hat{\\mathbf{\\theta}}) \\cdot \\left( \\frac{dr}{d\\theta}\\hat{\\mathbf{r}} + r(\\theta)\\hat{\\mathbf{\\theta}} \\right) d\\theta = v_{\\theta}(\\theta)r(\\theta) d\\theta $$\nsince $\\hat{\\mathbf{r}}$ and $\\hat{\\mathbf{\\theta}}$ are orthogonal.\nThe circulation $\\Gamma$ is the integral over the closed path $\\theta \\in [0, 2\\pi]$:\n$$ \\Gamma = \\int_{0}^{2\\pi} v_{\\theta}(\\theta)r(\\theta) \\, d\\theta $$\nSubstituting the given expressions for $r(\\theta)$ and $v_{\\theta}(\\theta)$:\n$$ \\Gamma = \\int_{0}^{2\\pi} \\left[ V_{0}\\left(1 + \\mu \\cos(2\\theta) + \\nu \\sin(2\\theta) + \\sigma \\cos(3\\theta)\\right) \\right] \\left[ R \\left(1 + \\epsilon \\cos(2\\theta)\\right) \\right] \\, d\\theta $$\n$$ \\Gamma = R V_{0} \\int_{0}^{2\\pi} \\left(1 + \\epsilon \\cos(2\\theta)\\right) \\left(1 + \\mu \\cos(2\\theta) + \\nu \\sin(2\\theta) + \\sigma \\cos(3\\theta)\\right) \\, d\\theta $$\nWe expand the integrand and integrate term by term. We use the orthogonality relations for trigonometric functions over the interval $[0, 2\\pi]$: for non-zero integers $m, n$, $\\int_0^{2\\pi} \\cos(m\\theta) d\\theta = 0$, $\\int_0^{2\\pi} \\sin(m\\theta) d\\theta = 0$, $\\int_0^{2\\pi} \\sin(m\\theta)\\cos(n\\theta) d\\theta = 0$, and $\\int_0^{2\\pi} \\cos(m\\theta)\\cos(n\\theta) d\\theta = \\pi \\delta_{mn}$. Also, $\\int_0^{2\\pi} \\cos^2(m\\theta) d\\theta = \\pi$.\nThe only terms in the expansion that yield a non-zero integral are the constant term, from $1 \\times 1$, and the term containing $\\cos^2(2\\theta)$, from $(\\epsilon \\cos(2\\theta)) \\times (\\mu \\cos(2\\theta))$.\n$$ \\int_{0}^{2\\pi} 1 \\cdot 1 \\, d\\theta = 2\\pi $$\n$$ \\int_{0}^{2\\pi} (\\epsilon \\cos(2\\theta))(\\mu \\cos(2\\theta)) \\, d\\theta = \\epsilon\\mu \\int_{0}^{2\\pi} \\cos^2(2\\theta) \\, d\\theta = \\epsilon\\mu\\pi $$\nAll other cross-product terms integrate to zero.\nSo, the circulation is:\n$$ \\Gamma = R V_{0} (2\\pi + \\epsilon\\mu\\pi) = \\pi R V_{0} (2 + \\epsilon\\mu) $$\n\nNext, we calculate the area $A$ enclosed by the path. The formula for area in polar coordinates is:\n$$ A = \\frac{1}{2}\\int_{0}^{2\\pi} [r(\\theta)]^2 \\, d\\theta $$\nSubstituting $r(\\theta) = R(1 + \\epsilon\\cos(2\\theta))$:\n$$ A = \\frac{1}{2}\\int_{0}^{2\\pi} \\left[ R(1 + \\epsilon\\cos(2\\theta)) \\right]^2 \\, d\\theta = \\frac{R^2}{2}\\int_{0}^{2\\pi} (1 + 2\\epsilon\\cos(2\\theta) + \\epsilon^2\\cos^2(2\\theta)) \\, d\\theta $$\nIntegrating term by term:\n$$ \\int_{0}^{2\\pi} 1 \\, d\\theta = 2\\pi $$\n$$ \\int_{0}^{2\\pi} 2\\epsilon\\cos(2\\theta) \\, d\\theta = 0 $$\n$$ \\int_{0}^{2\\pi} \\epsilon^2\\cos^2(2\\theta) \\, d\\theta = \\epsilon^2\\pi $$\nThe area is therefore:\n$$ A = \\frac{R^2}{2}(2\\pi + \\epsilon^2\\pi) = \\pi R^2 \\left(1 + \\frac{\\epsilon^2}{2}\\right) $$\n\nNow we can compute the area-mean vorticity:\n$$ \\langle \\zeta_z \\rangle = \\frac{\\Gamma}{A} = \\frac{\\pi R V_{0} (2 + \\epsilon\\mu)}{\\pi R^2 (1 + \\frac{\\epsilon^2}{2})} = \\frac{V_0}{R} \\frac{2 + \\epsilon\\mu}{1 + \\frac{\\epsilon^2}{2}} $$\nWe substitute the given numerical values:\n$R = 3.0 \\times 10^{4}\\ \\text{m}$\n$V_{0} = 45\\ \\text{m s}^{-1}$\n$\\epsilon = 0.10$\n$\\mu = 0.12$\n$$ \\langle \\zeta_z \\rangle = \\frac{45}{3.0 \\times 10^{4}} \\frac{2 + (0.10)(0.12)}{1 + \\frac{(0.10)^2}{2}} $$\n$$ \\langle \\zeta_z \\rangle = (1.5 \\times 10^{-3}) \\frac{2 + 0.012}{1 + \\frac{0.01}{2}} = (1.5 \\times 10^{-3}) \\frac{2.012}{1.005} $$\n$$ \\langle \\zeta_z \\rangle = (1.5 \\times 10^{-3}) (2.00199004975...) $$\n$$ \\langle \\zeta_z \\rangle \\approx 3.00298507... \\times 10^{-3}\\ \\text{s}^{-1} $$\nRounding to four significant figures as required:\n$$ \\langle \\zeta_z \\rangle \\approx 3.003 \\times 10^{-3}\\ \\text{s}^{-1} $$",
            "answer": "$$\\boxed{3.003 \\times 10^{-3}}$$"
        }
    ]
}