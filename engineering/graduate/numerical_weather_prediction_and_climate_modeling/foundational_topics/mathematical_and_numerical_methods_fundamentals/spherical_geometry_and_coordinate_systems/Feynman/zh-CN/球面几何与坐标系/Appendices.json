{
    "hands_on_practices": [
        {
            "introduction": "在全球数值模型中，物理量的守恒是至关重要的。此练习将引导您从第一性原理出发，推导球面上一个经纬度网格单元的精确面积，并探讨该面积如何在确保物理量（如示踪物质量）在不同网格间传递时得以守恒的“守恒重映射”过程中发挥核心作用。通过这个实践，您将深刻理解网格几何与物理守恒定律之间的直接联系。",
            "id": "4092520",
            "problem": "一个球形地球上的全球大气模型使用经纬度网格。假设地球是一个半径为 $R$ 的完美球体，地理纬度 $\\phi \\in \\left[-\\frac{\\pi}{2}, \\frac{\\pi}{2}\\right]$，经度 $\\lambda \\in [0, 2\\pi)$。考虑一个跨越 $\\phi \\in \\left[\\phi - \\frac{\\Delta \\phi}{2}, \\phi + \\frac{\\Delta \\phi}{2}\\right]$ 和 $\\lambda \\in \\left[\\lambda_{0} - \\frac{\\Delta \\lambda}{2}, \\lambda_{0} + \\frac{\\Delta \\lambda}{2}\\right]$ 的单个经纬度单元，其中所有角度均以弧度为单位。\n\n从球面几何的第一性原理出发，推导该单元在球面上的表面积的精确、封闭形式表达式（无小角度近似）。然后，利用单元平均标量场的积分在重映射下守恒的要求，推导从源单元到目标单元的一阶守恒重映射权重表达式，该表达式用它们的球形重叠区域面积和目标单元面积来表示。\n\n最后，针对以下具体配置，评估该守恒重映射权重，其中单个源单元对一个目标单元有贡献。源单元跨越\n$\\phi \\in \\left[\\frac{\\pi}{6} - \\frac{\\pi}{36}, \\frac{\\pi}{6} + \\frac{\\pi}{36}\\right]$ 和 $\\lambda \\in \\left[0, \\frac{\\pi}{18}\\right]$。\n目标单元跨越\n$\\phi \\in \\left[\\frac{\\pi}{6} - \\frac{\\pi}{36}, \\frac{\\pi}{6} + \\frac{\\pi}{36}\\right]$ 和 $\\lambda \\in \\left[\\frac{\\pi}{36}, \\frac{\\pi}{12}\\right]$。\n假设这里不考虑其他重叠的源单元；仅计算此单个源单元对目标单元贡献的权重，该权重定义为球形重叠区域面积与目标单元面积之比。所有角度均以弧度为单位。将最终权重表示为单个精确数字或简化的精确表达式，不带单位。无需四舍五入。",
            "solution": "问题验证如下。\n\n**第 1 步：提取已知条件**\n- 地球是半径为 $R$ 的完美球体。\n- 地理纬度用 $\\phi$ 表示，其中 $\\phi \\in \\left[-\\frac{\\pi}{2}, \\frac{\\pi}{2}\\right]$。\n- 经度用 $\\lambda$ 表示，其中 $\\lambda \\in [0, 2\\pi)$。\n- 一个通用的经纬度单元跨越 $\\phi \\in \\left[\\phi - \\frac{\\Delta \\phi}{2}, \\phi + \\frac{\\Delta \\phi}{2}\\right]$ 和 $\\lambda \\in \\left[\\lambda_{0} - \\frac{\\Delta \\lambda}{2}, \\lambda_{0} + \\frac{\\Delta \\lambda}{2}\\right]$。\n- 问题要求从第一性原理出发，推导单元表面积，且不使用小角度近似。\n- 单元平均标量场的积分在重映射下是守恒的。\n- 一个源单元 ($S$) 定义为：\n  - 纬度：$\\phi \\in \\left[\\frac{\\pi}{6} - \\frac{\\pi}{36}, \\frac{\\pi}{6} + \\frac{\\pi}{36}\\right]$\n  - 经度：$\\lambda \\in \\left[0, \\frac{\\pi}{18}\\right]$\n- 一个目标单元 ($T$) 定义为：\n  - 纬度：$\\phi \\in \\left[\\frac{\\pi}{6} - \\frac{\\pi}{36}, \\frac{\\pi}{6} + \\frac{\\pi}{36}\\right]$\n  - 经度：$\\lambda \\in \\left[\\frac{\\pi}{36}, \\frac{\\pi}{12}\\right]$\n- 守恒重映射权重定义为球形重叠区域面积与目标单元面积之比。\n\n**第 2 步：使用提取的已知条件进行验证**\n- **科学依据：** 该问题坚实地基于球面几何原理和守恒重映射概念，这些是数值天气预报和气候建模中的基础。该设置是这些模型中网格到网格转换的标准（尽管是简化的）表示。\n- **适定性：** 该问题结构清晰。它要求三个不同的输出：(1) 单元面积的通用公式，(2) 重映射权重的通用公式，以及 (3) 在给定具体配置下该权重的具体数值。所提供的信息对于所有三个任务都是充分且一致的。\n- **客观性：** 该问题使用精确的数学语言和定义陈述，没有歧义或主观论断。\n\n**第 3 步：结论与行动**\n该问题是有效的。它科学合理、适定、客观，并包含推导唯一解所需的所有必要信息。现在开始求解过程。\n\n**第 1 部分：经纬度单元表面积的推导**\n\n半径为 $R$ 的球面上的一个点可以用球面坐标 $(\\lambda, \\phi)$ 来描述，其中 $\\lambda$ 是经度，$\\phi$ 是纬度。球面上的无穷小表面积元 $dA$ 由下式给出：\n$$dA = R^2 \\cos(\\phi) \\, d\\phi \\, d\\lambda$$\n一个经纬度单元由边界 $\\phi \\in [\\phi_1, \\phi_2]$ 和 $\\lambda \\in [\\lambda_1, \\lambda_2]$ 定义。该单元的总表面积 $A$ 是通过在这些边界上对面积元进行积分得到的：\n$$A = \\int_{\\lambda_1}^{\\lambda_2} \\int_{\\phi_1}^{\\phi_2} R^2 \\cos(\\phi) \\, d\\phi \\, d\\lambda$$\n由于被积函数和积分限是可分的，我们可以将积分写成：\n$$A = R^2 \\left( \\int_{\\lambda_1}^{\\lambda_2} d\\lambda \\right) \\left( \\int_{\\phi_1}^{\\phi_2} \\cos(\\phi) \\, d\\phi \\right)$$\n分别计算每个积分：\n关于经度的积分是：\n$$\\int_{\\lambda_1}^{\\lambda_2} d\\lambda = \\lambda_2 - \\lambda_1 = \\Delta\\lambda$$\n关于纬度的积分是：\n$$\\int_{\\phi_1}^{\\phi_2} \\cos(\\phi) \\, d\\phi = [\\sin(\\phi)]_{\\phi_1}^{\\phi_2} = \\sin(\\phi_2) - \\sin(\\phi_1)$$\n将这些结果结合起来，得到单元表面积的精确、封闭形式表达式：\n$$A = R^2 (\\lambda_2 - \\lambda_1) (\\sin(\\phi_2) - \\sin(\\phi_1))$$\n该表达式是从第一性原理推导出来的，没有使用任何小角度近似。\n\n**第 2 部分：守恒重映射权重的推导**\n\n设 $\\Psi$ 是一个单元平均的标量（例如，单位面积的示踪剂质量）。守恒重映射要求在从源网格移动到目标网格时，该总物理量守恒。\n一个单元中物理量 $Q$ 的总量是单元平均值 $\\Psi$ 和单元面积 $A$ 的乘积：$Q = \\Psi A$。\n我们考虑一个目标单元 $T$，它被一组源单元 $\\{S_i\\}$ 所覆盖。目标单元中的总物理量 $Q_T = \\Psi_T A_T$ 必须等于每个重叠源单元贡献的物理量之和。\n$$Q_T = \\sum_i Q_{S_i \\to T}$$\n其中 $Q_{S_i \\to T}$ 是从源单元 $S_i$ 转移到目标单元 $T$ 的物理量。\n假设标量场在每个源单元 $S_i$ 内均匀分布，则转移到目标单元 $T$ 的物理量与它们的交集面积 $A_{S_i \\cap T}$ 成正比。从 $S_i$ 转移的物理量是其总物理量 $Q_{S_i} = \\Psi_{S_i} A_{S_i}$ 乘以重叠面积的分数：\n$$Q_{S_i \\to T} = Q_{S_i} \\frac{A_{S_i \\cap T}}{A_{S_i}} = (\\Psi_{S_i} A_{S_i}) \\frac{A_{S_i \\cap T}}{A_{S_i}} = \\Psi_{S_i} A_{S_i \\cap T}$$\n将此代回 $Q_T$ 的守恒方程：\n$$\\Psi_T A_T = \\sum_i \\Psi_{S_i} A_{S_i \\cap T}$$\n求解目标单元中的单元平均值 $\\Psi_T$：\n$$\\Psi_T = \\sum_i \\Psi_{S_i} \\left(\\frac{A_{S_i \\cap T}}{A_T}\\right)$$\n这个方程定义了一阶守恒重映射。项 $w_{S_i \\to T} = \\frac{A_{S_i \\cap T}}{A_T}$ 是重映射权重，代表源单元 $S_i$ 对目标单元 $T$ 的贡献。这证实了问题陈述中提供的定义。\n\n**第 3 部分：特定重映射权重的评估**\n\n我们需要为给定的源单元 ($S$) 和目标单元 ($T$) 计算权重 $w_{S \\to T} = \\frac{A_{S \\cap T}}{A_T}$。\n\n源单元的边界为：\n- 纬度：$\\phi \\in \\left[\\frac{\\pi}{6} - \\frac{\\pi}{36}, \\frac{\\pi}{6} + \\frac{\\pi}{36}\\right] = \\left[\\frac{5\\pi}{36}, \\frac{7\\pi}{36}\\right]$\n- 经度：$\\lambda \\in \\left[0, \\frac{\\pi}{18}\\right]$\n\n目标单元的边界为：\n- 纬度：$\\phi \\in \\left[\\frac{\\pi}{6} - \\frac{\\pi}{36}, \\frac{\\pi}{6} + \\frac{\\pi}{36}\\right] = \\left[\\frac{5\\pi}{36}, \\frac{7\\pi}{36}\\right]$\n- 经度：$\\lambda \\in \\left[\\frac{\\pi}{36}, \\frac{\\pi}{12}\\right]$\n\n首先，我们计算目标单元的面积 $A_T$。\n- 纬度边界：$\\phi_1 = \\frac{5\\pi}{36}$, $\\phi_2 = \\frac{7\\pi}{36}$\n- 经度边界：$\\lambda_1 = \\frac{\\pi}{36}$, $\\lambda_2 = \\frac{\\pi}{12} = \\frac{3\\pi}{36}$\n经度宽度为 $\\Delta\\lambda_T = \\lambda_2 - \\lambda_1 = \\frac{3\\pi}{36} - \\frac{\\pi}{36} = \\frac{2\\pi}{36} = \\frac{\\pi}{18}$。\n使用面积公式：\n$$A_T = R^2 \\left(\\frac{\\pi}{18}\\right) \\left[ \\sin\\left(\\frac{7\\pi}{36}\\right) - \\sin\\left(\\frac{5\\pi}{36}\\right) \\right]$$\n\n接下来，我们确定重叠区域 $S \\cap T$，并计算其面积 $A_{S \\cap T}$。\n- 纬度重叠：$S$ 和 $T$ 的纬度范围相同，所以重叠范围是 $\\phi \\in \\left[\\frac{5\\pi}{36}, \\frac{7\\pi}{36}\\right]$。\n- 经度重叠：我们求经度区间 $\\left[0, \\frac{\\pi}{18}\\right]$ 和 $\\left[\\frac{\\pi}{36}, \\frac{\\pi}{12}\\right]$ 的交集。\n  我们使用公分母 36：$\\left[0, \\frac{2\\pi}{36}\\right]$ 和 $\\left[\\frac{\\pi}{36}, \\frac{3\\pi}{36}\\right]$。\n  交集是 $\\lambda \\in \\left[\\frac{\\pi}{36}, \\frac{2\\pi}{36}\\right] = \\left[\\frac{\\pi}{36}, \\frac{\\pi}{18}\\right]$。\n因此，对于重叠区域 $S \\cap T$：\n- 纬度边界：$\\phi_1 = \\frac{5\\pi}{36}$, $\\phi_2 = \\frac{7\\pi}{36}$\n- 经度边界：$\\lambda_1 = \\frac{\\pi}{36}$, $\\lambda_2 = \\frac{\\pi}{18}$\n重叠区域的经度宽度为 $\\Delta\\lambda_{S \\cap T} = \\frac{\\pi}{18} - \\frac{\\pi}{36} = \\frac{2\\pi - \\pi}{36} = \\frac{\\pi}{36}$。\n重叠区域的面积是：\n$$A_{S \\cap T} = R^2 \\left(\\frac{\\pi}{36}\\right) \\left[ \\sin\\left(\\frac{7\\pi}{36}\\right) - \\sin\\left(\\frac{5\\pi}{36}\\right) \\right]$$\n\n最后，我们计算重映射权重 $w_{S \\to T}$：\n$$w_{S \\to T} = \\frac{A_{S \\cap T}}{A_T} = \\frac{R^2 \\left(\\frac{\\pi}{36}\\right) \\left[ \\sin\\left(\\frac{7\\pi}{36}\\right) - \\sin\\left(\\frac{5\\pi}{36}\\right) \\right]}{R^2 \\left(\\frac{\\pi}{18}\\right) \\left[ \\sin\\left(\\frac{7\\pi}{36}\\right) - \\sin\\left(\\frac{5\\pi}{36}\\right) \\right]}$$\n$R^2$ 和 $\\left[ \\sin\\left(\\frac{7\\pi}{36}\\right) - \\sin\\left(\\frac{5\\pi}{36}\\right) \\right]$ 项相互抵消。权重简化为重叠区域和目标单元区域的经度宽度之比：\n$$w_{S \\to T} = \\frac{\\frac{\\pi}{36}}{\\frac{\\pi}{18}} = \\frac{\\pi}{36} \\cdot \\frac{18}{\\pi} = \\frac{18}{36} = \\frac{1}{2}$$\n守恒重映射权重为 $\\frac{1}{2}$。",
            "answer": "$$\\boxed{\\frac{1}{2}}$$"
        },
        {
            "introduction": "经纬度网格的一个众所周知的挑战是“极地奇异性”问题，即网格单元在向两极汇聚时变得非常狭窄。这种纯粹的几何特性对数值模拟的稳定性有着深远的影响，尤其是在使用显式时间积分方案时。本练习旨在量化这种几何约束，通过计算在特定纬度和风速下，为满足 Courant–Friedrichs–Lewy (CFL) 稳定条件所允许的最大时间步长。",
            "id": "4092519",
            "problem": "考虑一个用于数值天气预报和气候模拟的经纬度球面网格，该网格建立在半径为 $R = 6.371 \\times 10^{6}$ 的球形地球上。一个被动标量 $q$ 被峰值速度为 $U$ 的纯纬向风沿着纬度为 $\\phi$ 的纬线平流。其控制输运的是线性平流方程 $\\frac{\\partial q}{\\partial t} + u \\frac{\\partial q}{\\partial s} = 0$，其中 $s$ 表示在固定纬度 $\\phi$ 上沿纬线的弧长，$u$ 是风的纬向分量。沿纬线对应经度增量 $\\Delta \\lambda$ 的距离为 $R \\cos(\\phi) \\, \\Delta \\lambda$，其中 $\\Delta \\lambda$ 以弧度为单位。该模型在时间和经度上采用显式一阶迎风离散格式，并受平流方向上的 Courant–Friedrichs–Lewy (CFL) 稳定性要求约束。\n\n从平流方程和球面弧长关系出发，推导在纬度 $\\phi$ 处最大允许时间步长 $\\Delta t_{\\max}$ 作为 $R$、$\\phi$、$\\Delta \\lambda$ 和 $U$ 的函数表达式。然后，针对以下配置计算最大允许时间步长：\n- 纬度 $\\phi = 60^{\\circ}$，\n- 初始经度间距 $\\Delta \\lambda_{0} = 0.5^{\\circ}$，\n- 加密后的经度间距 $\\Delta \\lambda_{1} = 0.25^{\\circ}$，\n- 峰值纬向风速 $U = 90$，\n计算时需将角度转换为弧度。\n\n报告在 $\\Delta \\lambda_{0}$ 时的最大允许时间步长、在 $\\Delta \\lambda_{1}$ 时的最大允许时间步长，以及比率 $\\Delta t_{\\max}(\\Delta \\lambda_{1}) / \\Delta t_{\\max}(\\Delta \\lambda_{0})$。将所有报告值四舍五入至四位有效数字。时间步长以秒为单位表示，比率以无量纲小数表示。",
            "solution": "问题陈述已经过验证，并被认为是有效的。它在科学上基于流体动力学和数值方法的原理，是适定的，并使用客观语言。半径 $R$ 和风速 $U$ 的单位没有明确给出，但给定的数值（$R = 6.371 \\times 10^{6}$ 和 $U = 90$）强烈暗示它们分别是标准的国际单位米 (m) 和米/秒 (m/s)，这在大气科学中是常规用法。这个假设是必要的，以便按要求得出以秒为单位的结果，并将在解答中采用此假设。\n\n第一步是推导最大允许时间步长 $\\Delta t_{\\max}$ 的一般表达式。被动标量 $q$ 的输运控制方程是一维线性平流方程：\n$$\n\\frac{\\partial q}{\\partial t} + u \\frac{\\partial q}{\\partial s} = 0\n$$\n其中 $t$ 是时间，$s$ 是沿纬线的弧长坐标，$u$ 是恒定的纬向风速，给定为 $U$。\n\n问题指定了显式一阶迎风离散化。对时间的偏导数 $\\frac{\\partial q}{\\partial t}$ 使用向前差分进行近似：\n$$\n\\frac{\\partial q}{\\partial t} \\approx \\frac{q_j^{n+1} - q_j^n}{\\Delta t}\n$$\n其中上标 $n$ 表示时间层，下标 $j$ 表示经度方向上的空间网格点。\n\n空间导数 $\\frac{\\partial q}{\\partial s}$ 使用一阶迎风差分进行近似。由于风是纬向的，我们可以不失一般性地假设 $u = U > 0$（代表西风）。因此，迎风方向是网格点 $j-1$。空间导数为：\n$$\n\\frac{\\partial q}{\\partial s} \\approx \\frac{q_j^n - q_{j-1}^n}{\\Delta s}\n$$\n其中 $\\Delta s$ 是沿纬线的空间网格间距。\n\n将这些近似值代入平流方程，得到完全离散的格式：\n$$\n\\frac{q_j^{n+1} - q_j^n}{\\Delta t} + U \\left( \\frac{q_j^n - q_{j-1}^n}{\\Delta s} \\right) = 0\n$$\n为了分析稳定性，我们重排方程以求解下一个时间步的值 $q_j^{n+1}$：\n$$\nq_j^{n+1} = q_j^n - \\frac{U \\Delta t}{\\Delta s} (q_j^n - q_{j-1}^n)\n$$\n这可以被重写，通过定义库朗数（Courant number） $C$ 为：\n$$\nC = \\frac{U \\Delta t}{\\Delta s}\n$$\n离散方程变为：\n$$\nq_j^{n+1} = (1 - C) q_j^n + C q_{j-1}^n\n$$\n为使该显式格式稳定，von Neumann 稳定性分析（或更简单的系数分析）要求库朗数 $C$ 满足条件 $0 \\le C \\le 1$。由于 $U$、$\\Delta t$ 和 $\\Delta s$ 均为正值，$C \\ge 0$ 的条件自然满足。因此，稳定性由 Courant–Friedrichs–Lewy (CFL) 条件决定：\n$$\nC = \\frac{U \\Delta t}{\\Delta s} \\le 1\n$$\n最大允许时间步长 $\\Delta t_{\\max}$ 在该不等式的极限处取得，即 $C=1$ 时：\n$$\n\\frac{U \\Delta t_{\\max}}{\\Delta s} = 1 \\implies \\Delta t_{\\max} = \\frac{\\Delta s}{U}\n$$\n问题提供了在半径为 $R$ 的球体上，纬度为 $\\phi$ 处，对应经度增量 $\\Delta \\lambda$（以弧度为单位）的弧长 $\\Delta s$ 的关系：\n$$\n\\Delta s = R \\cos(\\phi) \\Delta \\lambda\n$$\n将 $\\Delta s$ 的这个表达式代入 $\\Delta t_{\\max}$ 的方程，得出通用公式：\n$$\n\\Delta t_{\\max} = \\frac{R \\cos(\\phi) \\Delta \\lambda}{U}\n$$\n\n接下来，我们根据指定的配置计算这个表达式的值。给定参数如下：\n- 地球半径，$R = 6.371 \\times 10^{6}$ m。\n- 峰值纬向风速，$U = 90$ m/s。\n- 纬度，$\\phi = 60^{\\circ}$。\n- 初始经度间距，$\\Delta \\lambda_{0} = 0.5^{\\circ}$。\n- 加密后的经度间距，$\\Delta \\lambda_{1} = 0.25^{\\circ}$。\n\n在计算中，角度必须使用转换因子 $\\frac{\\pi}{180}$ 从度转换为弧度。\n纬度的弧度值为 $\\phi = 60^{\\circ} \\times \\frac{\\pi}{180^{\\circ}} = \\frac{\\pi}{3}$ 弧度。该纬度的余弦值为 $\\cos(\\frac{\\pi}{3}) = 0.5$。\n经度间距的弧度值为：\n$$\n\\Delta \\lambda_{0} = 0.5^{\\circ} \\times \\frac{\\pi}{180^{\\circ}} \\text{ rad}\n$$\n$$\n\\Delta \\lambda_{1} = 0.25^{\\circ} \\times \\frac{\\pi}{180^{\\circ}} \\text{ rad}\n$$\n\n现在，我们计算初始经度间距下的最大时间步长 $\\Delta t_{\\max}(\\Delta \\lambda_{0})$：\n$$\n\\Delta t_{\\max}(\\Delta \\lambda_{0}) = \\frac{(6.371 \\times 10^{6}) \\times \\cos(60^{\\circ}) \\times (0.5 \\times \\frac{\\pi}{180})}{90}\n$$\n$$\n\\Delta t_{\\max}(\\Delta \\lambda_{0}) = \\frac{(6.371 \\times 10^{6}) \\times 0.5 \\times (0.5 \\times \\pi)}{90 \\times 180} = \\frac{1592750 \\times \\pi}{16200} \\approx 308.8767 \\text{ s}\n$$\n四舍五入到四位有效数字，我们得到 $\\Delta t_{\\max}(\\Delta \\lambda_{0}) = 308.9$ s。\n\n接下来，我们计算加密后的经度间距下的最大时间步长 $\\Delta t_{\\max}(\\Delta \\lambda_{1})$：\n$$\n\\Delta t_{\\max}(\\Delta \\lambda_{1}) = \\frac{(6.371 \\times 10^{6}) \\times \\cos(60^{\\circ}) \\times (0.25 \\times \\frac{\\pi}{180})}{90}\n$$\n$$\n\\Delta t_{\\max}(\\Delta \\lambda_{1}) = \\frac{(6.371 \\times 10^{6}) \\times 0.5 \\times (0.25 \\times \\pi)}{90 \\times 180} = \\frac{796375 \\times \\pi}{16200} \\approx 154.4384 \\text{ s}\n$$\n四舍五入到四位有效数字，我们得到 $\\Delta t_{\\max}(\\Delta \\lambda_{1}) = 154.4$ s。\n\n最后，我们计算比率 $\\frac{\\Delta t_{\\max}(\\Delta \\lambda_{1})}{\\Delta t_{\\max}(\\Delta \\lambda_{0})}$。从推导的公式可以看出，$\\Delta t_{\\max}$ 与 $\\Delta \\lambda$ 成正比，所有其他因子均为常数。因此，比率为：\n$$\n\\frac{\\Delta t_{\\max}(\\Delta \\lambda_{1})}{\\Delta t_{\\max}(\\Delta \\lambda_{0})} = \\frac{\\frac{R \\cos(\\phi) \\Delta \\lambda_{1}}{U}}{\\frac{R \\cos(\\phi) \\Delta \\lambda_{0}}{U}} = \\frac{\\Delta \\lambda_{1}}{\\Delta \\lambda_{0}}\n$$\n使用给定的度数值：\n$$\n\\text{比率} = \\frac{0.25^{\\circ}}{0.5^{\\circ}} = 0.5\n$$\n作为一个四舍五入到四位有效数字的小数，该比率为 $0.5000$。\n\n所要求的三个值是：$\\Delta \\lambda_{0}$ 的最大允许时间步长，$\\Delta \\lambda_{1}$ 的最大允许时间步长，以及它们的比率。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 308.9  154.4  0.5000 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "与有限差分或有限体积模型中使用的规则网格不同，全球谱模型依赖于一种特殊设计的“高斯网格”来精确地执行物理空间和谱空间之间的转换。这些网格点的选择并非任意，而是遵循严格的数学要求，以消除谱变换中的混淆误差并确保积分的精确性。此练习将挑战您对高斯网格构建背后理论的理解，要求您确定并论证在给定谱截断下，为何必须采用特定的纬度和经度分辨率。",
            "id": "4092478",
            "problem": "您正在设计一个球体上的全球谱数值天气预报 (NWP) 模型，该模型在总波数 $L$ 处截断，使用球谐函数 $Y_{\\ell}^{m}(\\lambda,\\phi)$ 作为基函数。设 $\\lambda$ 表示经度，$\\phi$ 表示纬度，并定义 $\\mu = \\sin\\phi$，因此球面面积元为 $d\\Omega = d\\lambda\\,d\\mu$。对于所有带限在球谐阶数 $\\ell \\le L$ 和次数 $|m| \\le L$ 的场，谱-格点和格点-谱变换必须是精确的。您将通过选择一组 $N$ 个纬度和 $M$ 个经度，以及适当的求积权重，来构建一个全球高斯格点，以确保精确计算作为变换基础的内积，并保证积分不变量（例如总质量）的守恒。\n\n在以下方案中，选择能在给定截断下保证变换精确性，并正确解释为何高斯纬度必须位于勒让德多项式 $P_N(\\mu)$ 的根处的构建方案。\n\nA. 在 $(-1,1)$ 上选择 $P_N(\\mu)$ 的 $N$ 个不同根处的 $N = L + 1$ 个纬度 $\\mu_i$，其相应的高斯-勒让德权重为 $w_i = \\dfrac{2}{(1 - \\mu_i^2)\\,[P_N'(\\mu_i)]^2}$，并选择 $M$ 个等距分布的经度，其中 $M \\ge 2L + 1$。理由：通过离散傅里叶和进行经向分离后，连带勒让德函数的纬向内积通过重复分部积分，可简化为关于 $\\mu$ 的最高次数为 $2N - 1$ 的多项式积分，高斯-勒让德求积可以精确地计算该积分；经度方向的精确性源于 $e^{i m \\lambda}$ 在等距格点上对 $|m| \\le L$ 的离散正交性。\n\nB. 在 $[-\\tfrac{\\pi}{2}, \\tfrac{\\pi}{2}]$ 上选择 $N$ 个在 $\\phi$ 上均匀分布的纬度，以及 $M = 2N$ 个等距分布的经度。理由：在 $\\phi$ 上的均匀分布使单元面积相等，因此无需特殊的求积节点即可为最高阶数 $\\ell \\le L$ 的球谐函数提供精确的正交性。\n\nC. 在 $P_N'(\\mu)$ 的根（即 $P_N$ 的极值点）处选择 $N$ 个纬度 $\\mu_i$，其权重为 $w_i \\propto (1 - \\mu_i^2)$，并选择 $M \\ge 2L + 1$ 个等距分布的经度。理由：微分正交性增加了稳定性，并为最高次数为 $2N$ 的多项式提供了精确性。\n\nD. 在 $P_L(\\mu)$ 的根处选择 $N = L$ 个纬度 $\\mu_i$，其权重为 $w_i = \\dfrac{2}{(1 - \\mu_i^2)\\,[P_L'(\\mu_i)]^2}$，并选择 $M = 2L - 1$ 个等距分布的经度。理由：将纬度数量与截断相匹配可以避免冗余，并且由于对称性，减少的经度数量仍然足够。",
            "solution": "用户希望我扮演一位 STEM 领域的严谨、苛刻的教授，解决一个与数值天气预报模型相关的问题。我将首先验证问题陈述，然后进行全面的解答和选项评估。\n\n### 问题验证\n\n**第 1 步：提取已知条件**\n- **模型类型：** 全球谱数值天气预报 (NWP) 模型。\n- **区域：** 球体。\n- **基函数：** 球谐函数，$Y_{\\ell}^{m}(\\lambda,\\phi)$。\n- **截断：** 总波数 $L$，使得 $\\ell \\le L$ 且 $|m| \\le L$。\n- **坐标：** 经度 $\\lambda$，纬度 $\\phi$。\n- **辅助变量：** $\\mu = \\sin\\phi$。\n- **面积元：** $d\\Omega = d\\lambda\\,d\\mu$。\n- **任务要求：** 对于所有带限在球谐阶数 $\\ell \\le L$ 的场，谱-格点和格点-谱变换必须是精确的。\n- **格点构建：** 一个具有 $N$ 个纬度和 $M$ 个经度以及相应求积权重的全球高斯格点。\n- **目标：** 格点构建必须确保变换内积的精确计算。\n- **问题：** 选择能保证精确性并正确解释为何使用位于勒让德多项式 $P_N(\\mu)$ 根处的高斯纬度的构建方案。\n\n**第 2 步：使用提取的已知条件进行验证**\n- **科学依据：** 该问题是现代全球大气和气候模拟数值方法的基石。球谐函数、谱截断、高斯格点和高斯-勒让德求积的使用是标准的和基础的理论，是欧洲中期天气预报中心 (ECMWF) 等主要业务中心开发模型的核心。所涉及的原理在数值分析和应用数学中是公认的。该问题在科学上和事实上都是合理的。\n- **适定性：** 问题是适定的。它指定了一个明确的数学要求（对特定函数类别的变换要精确），并要求满足此要求的数值格点条件。预计在选项中存在一组唯一、正确的条件。\n- **客观性：** 问题陈述使用了地球物理流体动力学和数值分析领域常见的精确技术语言。它没有歧义、主观性或观点。\n- **完整性和一致性：** 问题提供了所有必要信息。基函数的定义、变换要求和变量都是标准的，足以推导出必要的格点参数。不存在矛盾。\n\n**第 3 步：结论和行动**\n该问题是**有效的**，因为它在科学上合理、适定、客观且自洽。我现在将进行全面的推导和分析。\n\n### 推导\n\n将标量场 $A(\\lambda, \\mu)$ 从格点空间变换到谱空间，需要通过内积计算其谱系数 $A_{\\ell}^{m}$：\n$$\nA_{\\ell}^{m} = \\int_{S^2} A(\\lambda, \\mu) [Y_{\\ell}^{m}(\\lambda, \\mu)]^* d\\Omega = \\int_{-1}^{1} \\int_{0}^{2\\pi} A(\\lambda, \\mu) [Y_{\\ell}^{m}(\\lambda, \\mu)]^* d\\lambda d\\mu\n$$\n其中 $[Y_{\\ell}^{m}]^*$ 是球谐函数 $Y_{\\ell}^{m}$ 的复共轭。逆变换，即从谱空间到格点空间，是合成：\n$$\nA(\\lambda, \\mu) = \\sum_{\\ell=0}^{L} \\sum_{m=-\\ell}^{\\ell} A_{\\ell}^{m} Y_{\\ell}^{m}(\\lambda, \\mu)\n$$\n问题要求变换的数值求积对于任何在总波数 $L$ 处带限的场 $A(\\lambda, \\mu)$ 都是精确的。这意味着，如果我们取一个由上述和式定义的场 $A(\\lambda, \\mu)$，并以数值方式计算其系数 $A_{\\ell'}^{m'}$，对于所有 $\\ell' \\le L, |m'| \\le L'$，结果必须是精确的。\n\n将 $A(\\lambda, \\mu)$ 的合成公式代入分析积分，我们看到数值方案必须能够精确计算以下形式的积分：\n$$\n\\int_{-1}^{1} \\int_{0}^{2\\pi} Y_{\\ell_1}^{m_1}(\\lambda, \\mu) [Y_{\\ell_2}^{m_2}(\\lambda, \\mu)]^* d\\lambda d\\mu\n$$\n对于所有 $\\ell_1, \\ell_2 \\le L$ 及其相关的 $m_1, m_2$。\n\n球谐函数定义为 $Y_{\\ell}^{m}(\\lambda, \\mu) = K_{\\ell,m} P_{\\ell}^{m}(\\mu) e^{i m \\lambda}$，其中 $P_{\\ell}^{m}(\\mu)$ 是连带勒让德函数，$K_{\\ell,m}$ 是归一化常数。积分可以分离为经向和纬向部分：\n$$\n\\text{const} \\times \\int_{-1}^{1} P_{\\ell_1}^{m_1}(\\mu) P_{\\ell_2}^{m_2}(\\mu) d\\mu \\int_{0}^{2\\pi} e^{i(m_1 - m_2)\\lambda} d\\lambda\n$$\n\n**1. 经向（纬圈）变换要求**\n关于经度 $\\lambda$ 的积分是 $\\int_{0}^{2\\pi} e^{i(m_1 - m_2)\\lambda} d\\lambda$。由于 $|m_1| \\le \\ell_1 \\le L$ 和 $|m_2| \\le \\ell_2 \\le L$，波数 $k = m_1 - m_2$ 的范围可以从 $L - (-L) = 2L$ 到 $-L - L = -2L$。\n该积分的数值计算通常使用离散傅里叶变换进行，这对应于在 $M$ 个等距点 $\\{\\lambda_j = \\frac{2\\pi j}{M}\\}$ 组成的格点上使用梯形法则。只要 $k$ 不是 $M$ 的非零倍数，这种数值求积对于任何三角多项式 $e^{ik\\lambda}$ 都是精确的。为了精确地积分所有 $|k| \\le 2L$ 的项，并正确地区分它们与 $k=0$（这是连续积分为非零的唯一情况），我们必须确保在 $[-2L, 2L]$ 范围内的任何非零整数 $k$ 都不是 $M$ 的倍数。这要求 $M > 2L$。满足此条件的最小整数是 $M = 2L+1$。因此，经度点的数量必须满足 $M \\ge 2L + 1$。\n\n**2. 纬向（经圈）变换要求**\n指数函数在经度上的正交性，即 $\\int_0^{2\\pi} e^{i(m_1-m_2)\\lambda}d\\lambda = 2\\pi\\delta_{m_1,m_2}$，意味着我们只需要考虑 $m_1=m_2=m$ 时的纬向积分。任务是精确计算：\n$$\nI = \\int_{-1}^{1} P_{\\ell_1}^{m}(\\mu) P_{\\ell_2}^{m}(\\mu) d\\mu\n$$\n对于所有 $\\ell_1, \\ell_2 \\le L$ 和 $|m| \\le \\min(\\ell_1, \\ell_2)$。\n连带勒让德函数 $P_{\\ell}^{m}(\\mu)$ 由 $(1-\\mu^2)^{|m|/2}$ 乘以一个次数为 $\\ell-|m|$ 的关于 $\\mu$ 的多项式给出。因此，乘积 $P_{\\ell_1}^{m}(\\mu) P_{\\ell_2}^{m}(\\mu)$ 由以下形式给出：\n$$\nP_{\\ell_1}^{m}(\\mu) P_{\\ell_2}^{m}(\\mu) = (1-\\mu^2)^{|m|} \\times (\\text{次数为 } \\ell_1-|m| \\text{ 的多项式}) \\times (\\text{次数为 } \\ell_2-|m| \\text{ 的多项式})\n$$\n该乘积是关于 $\\mu$ 的一个多项式。其总次数为 $2|m| + (\\ell_1-|m|) + (\\ell_2-|m|) = \\ell_1+\\ell_2$。\n当 $\\ell_1 = L$ 和 $\\ell_2 = L$ 时，该多项式的次数达到最大值，最高次数为 $L+L=2L$。\n\n为了在区间 $[-1, 1]$ 上精确地积分一个最高次数为 $D$ 的任意多项式，需要使用 $N$ 点高斯-勒让德求积，其中 $2N-1 \\ge D$。这种求积的节点 $\\mu_i$ 是勒让德多项式 $P_N(\\mu)$ 的 $N$ 个根。\n在我们的情况下，最高多项式次数为 $D=2L$。因此我们需要：\n$$\n2N - 1 \\ge 2L \\implies 2N \\ge 2L+1 \\implies N \\ge L + \\frac{1}{2}\n$$\n由于 $N$ 必须是整数，所以纬度点的最小数量是 $N=L+1$。这 $N$ 个纬度必须选择在 $P_N(\\mu) = P_{L+1}(\\mu)$ 的根处。\n\n总而言之，为了使在 $L$ 处带限的场的变换精确，格点必须至少有 $N = L+1$ 个位于 $P_{L+1}(\\mu)$ 根处的纬度，以及至少 $M = 2L+1$ 个等距分布的经度。\n\n### 逐项分析\n\n**A. 在 $(-1,1)$ 上选择 $P_N(\\mu)$ 的 $N$ 个不同根处的 $N = L + 1$ 个纬度 $\\mu_i$，其相应的高斯-勒让德权重为 $w_i = \\dfrac{2}{(1 - \\mu_i^2)\\,[P_N'(\\mu_i)]^2}$，并选择 $M$ 个等距分布的经度，其中 $M \\ge 2L + 1$。理由：通过离散傅里叶和进行经向分离后，连带勒让德函数的纬向内积通过重复分部积分，可简化为关于 $\\mu$ 的最高次数为 $2N - 1$ 的多项式积分，高斯-勒让德求积可以精确地计算该积分；经度方向的精确性源于 $e^{i m \\lambda}$ 在等距格点上对 $|m| \\le L$ 的离散正交性。**\n\n- **分析：** 纬度数量 $N=L+1$ 及其位于 $P_N(\\mu)$ 根处的位置是正确的。权重 $w_i$ 的公式是高斯-勒让德权重的正确公式。经度数量 $M \\ge 2L+1$ 也是正确的。理由部分正确地指出，纬向积分简化为多项式积分，且高斯-勒让德求积对此积分是精确的。关于次数最高为 $2N-1$ 的陈述是正确的，因为 $N=L+1$ 提供的精确度最高为 $2(L+1)-1 = 2L+1$ 次，而实际的多项式次数最高为 $2L$，小于 $2L+1$。提及“重复分部积分”有些晦涩，但并未使核心推理无效。关于经度部分的理由原则上也是正确的，因为 `M \\ge 2L+1` 确保了变换计算中出现的傅里叶模式所需的正交性。\n- **结论：** **正确**。\n\n**B. 在 $[-\\tfrac{\\pi}{2}, \\tfrac{\\pi}{2}]$ 上选择 $N$ 个在 $\\phi$ 上均匀分布的纬度，以及 $M = 2N$ 个等距分布的经度。理由：在 $\\phi$ 上的均匀分布使单元面积相等，因此无需特殊的求积节点即可为最高阶数 $\\ell \\le L$ 的球谐函数提供精确的正交性。**\n\n- **分析：** 在纬度 $\\phi$ 上均匀的格点不是高斯格点。这种格点对应于在 $\\mu=\\sin\\phi$ 上的非均匀间距，并且这些点不是任何勒让德多项式的根。在此类格点上的标准求积（例如梯形法则）对于高次多项式是不精确的。其理由在事实上是不正确的。面积元 $d\\Omega = \\cos\\phi\\, d\\lambda\\, d\\phi$ 对于均匀的 `d\\phi` 间距是不恒定的；它在两极处消失。变换的精确性绝对需要特殊的求积节点（即高斯纬度）。\n- **结论：** **错误**。\n\n**C. 在 $P_N'(\\mu)$ 的根（即 $P_N$ 的极值点）处选择 $N$ 个纬度 $\\mu_i$，其权重为 $w_i \\propto (1 - \\mu_i^2)$，并选择 $M \\ge 2L + 1$ 个等距分布的经度。理由：微分正交性增加了稳定性，并为最高次数为 $2N$ 的多项式提供了精确性。**\n\n- **分析：** $P_N'(\\mu)$ 的根是高斯-洛巴托求积的节点，而不是高斯-勒让德求积。这是一种具有不同性质和精度阶（对最高次数为 $2N-3$ 的多项式精确）的不同方案。对于 $\\int_{-1}^1 f(x) dx$，最高效的标准求积使用 $P_N(\\mu)$ 的根。其理由也有缺陷：实线上的任何标准 $N$ 点求积都不能对 $2N$ 次多项式精确，并且“微分正交性”在此上下文中不是标准术语。\n- **结论：** **错误**。\n\n**D. 在 $P_L(\\mu)$ 的根处选择 $N = L$ 个纬度 $\\mu_i$，其权重为 $w_i = \\dfrac{2}{(1 - \\mu_i^2)\\,[P_L'(\\mu_i)]^2}$，并选择 $M = 2L - 1$ 个等距分布的经度。理由：将纬度数量与截断相匹配可以避免冗余，并且由于对称性，减少的经度数量仍然足够。**\n\n- **分析：** 如上所述，我们需要 $N \\ge L+1$。选择 $N=L$ 将意味着求积仅对最高次数为 $2L-1$ 的多项式精确。它将无法精确积分涉及 $P_L(\\mu)P_L(\\mu)$ 的项，这些项的次数为 $2L$。同样，我们需要 $M \\ge 2L+1$。选择 $M=2L-1$ 会对傅里叶模式 $e^{i(2L)\\lambda}$ 造成混叠，该模式可能在计算内积时由模式 $e^{iL\\lambda}$ 和 $e^{iL\\lambda}$ 的乘积产生。其理由基于“避免冗余”的错误前提和泛泛而谈。\n- **结论：** **错误**。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}