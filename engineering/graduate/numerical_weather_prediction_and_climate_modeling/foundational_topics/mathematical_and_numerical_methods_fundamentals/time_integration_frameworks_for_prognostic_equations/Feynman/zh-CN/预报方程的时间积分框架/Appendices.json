{
    "hands_on_practices": [
        {
            "introduction": "这个练习将我们带回到显式方法最基本的稳定性约束——Courant–Friedrichs–Lewy (CFL) 条件。通过分别计算缓慢的平流运动和快速的声波所允许的最大时间步长，你将亲身体会到“刚性”（stiffness）问题，这是大气建模中的一个核心挑战。理解这一限制是探索更高级时间积分框架必要性的第一步 。",
            "id": "4105163",
            "problem": "考虑一个用于数值天气预报的可压缩动力核心的一维剖面，其预报方程在间距为 $\\Delta x$ 的均匀网格上离散化。该模型对平流和声波传播均采用完全显式格式进行时间积分。稳定性的基本依据是，双曲型偏微分方程的显式离散化遵循 Courant–Friedrichs–Lewy (CFL) 条件。该条件约束了由 $\\nu = \\frac{v\\,\\Delta t}{\\Delta x}$ 定义的无量纲 Courant 数 $\\nu$（其中 $v$ 是相应的特征信号速度），为保证线性稳定性，必须满足 $\\nu \\leq 1$。\n\n从以下方程出发：\n- 特征速度为 $|U|$ 的线性平流方程 $\\partial_t \\phi + U\\,\\partial_x \\phi = 0$，以及\n- 特征声速为 $c_s$ 的可压缩欧拉方程的线性化声学子系统，\n\n分别推导由平流 CFL 条件和声学 CFL 条件施加的最大显式时间步长约束，然后通过取两者中更严格的一个来确定同时满足两个约束的单一最大时间步长。使用以下科学上合理的参数：网格间距 $\\Delta x = 10\\,\\text{km}$，风速 $U = 20\\,\\text{m s}^{-1}$，以及声速 $c_s = 320\\,\\text{m s}^{-1}$。将您的最终数值答案以秒为单位表示，并四舍五入到四位有效数字。在您的推理中，解释在这些条件下哪种模态（平流或声学）是限制性的。",
            "solution": "该问题要求确定用于一维可压缩动力核心的完全显式数值格式的最大稳定时间步长。对于双曲型偏微分方程，这种格式的稳定性由 Courant–Friedrichs–Lewy (CFL) 条件决定。\n\nCFL 条件是使用无量纲 Courant 数 $\\nu$ 来表述的，其定义为：\n$$ \\nu = \\frac{v \\, \\Delta t}{\\Delta x} $$\n其中 $v$ 是相关波动现象的特征速度，$\\Delta t$ 是时间步长，$\\Delta x$ 是网格间距。对于许多显式格式的线性稳定性，该条件要求 $\\nu \\leq 1$。这个不等式可以重新排列，以确定时间步长的上限：\n$$ \\Delta t \\leq \\frac{\\Delta x}{v} $$\n因此，对于一个特征速度为 $v$ 的过程，最大允许时间步长 $\\Delta t_{max}$ 为：\n$$ \\Delta t_{max} = \\frac{\\Delta x}{v} $$\n所描述的系统涉及两个不同的物理过程：平流和声波传播。我们必须对每个过程评估 CFL 约束，以确定整体的稳定性极限。\n\n给定的参数是：\n- 网格间距：$\\Delta x = 10\\,\\text{km}$\n- 风速：$U = 20\\,\\text{m s}^{-1}$\n- 声速：$c_s = 320\\,\\text{m s}^{-1}$\n\n为保证量纲一致性，所有量都必须使用国际单位制（SI）。将网格间距从千米转换为米：\n$$ \\Delta x = 10\\,\\text{km} = 10 \\times 10^3\\,\\text{m} = 10^4\\,\\text{m} $$\n\n我们现在分别为每种模态推导时间步长约束。\n\n1.  **平流时间步长约束：**\n    线性平流方程 $\\partial_t \\phi + U\\,\\partial_x \\phi = 0$ 控制着背景风的输送。该过程的特征速度是风速的大小，即 $v_{adv} = |U|$。平流的 CFL 条件是：\n    $$ \\nu_{adv} = \\frac{|U| \\, \\Delta t}{\\Delta x} \\leq 1 $$\n    这对平流过程施加了一个最大时间步长 $\\Delta t_{adv}$：\n    $$ \\Delta t \\leq \\frac{\\Delta x}{|U|} \\implies \\Delta t_{adv} = \\frac{\\Delta x}{|U|} $$\n    代入给定的数值：\n    $$ \\Delta t_{adv} = \\frac{10^4\\,\\text{m}}{|20\\,\\text{m s}^{-1}|} = \\frac{10000}{20}\\,\\text{s} = 500\\,\\text{s} $$\n\n2.  **声学时间步长约束：**\n    线性化声学子系统控制声波的传播。该过程的特征速度是声速，即 $v_{ac} = c_s$。声波的 CFL 条件是：\n    $$ \\nu_{ac} = \\frac{c_s \\, \\Delta t}{\\Delta x} \\leq 1 $$\n    这对声学过程施加了一个最大时间步长 $\\Delta t_{ac}$：\n    $$ \\Delta t \\leq \\frac{\\Delta x}{c_s} \\implies \\Delta t_{ac} = \\frac{\\Delta x}{c_s} $$\n    代入给定的数值：\n    $$ \\Delta t_{ac} = \\frac{10^4\\,\\text{m}}{320\\,\\text{m s}^{-1}} = \\frac{10000}{320}\\,\\text{s} = \\frac{1000}{32}\\,\\text{s} = 31.25\\,\\text{s} $$\n\n3.  **复合稳定性约束：**\n    一个完全显式积分格式必须对所有被模拟的物理过程都保持稳定。因此，时间步长 $\\Delta t$ 必须同时满足平流和声学约束。这意味着 $\\Delta t$ 必须小于或等于各个最大允许时间步长中的最小值：\n    $$ \\Delta t \\leq \\min(\\Delta t_{adv}, \\Delta t_{ac}) $$\n    确保整个系统稳定性的单一最大时间步长 $\\Delta t_{max}$ 是两个值中更严格的（即较小的）那一个：\n    $$ \\Delta t_{max} = \\min(500\\,\\text{s}, 31.25\\,\\text{s}) $$\n    因此，总体的最大稳定时间步长是：\n    $$ \\Delta t_{max} = 31.25\\,\\text{s} $$\n    问题要求答案四舍五入到四位有效数字。计算值 $31.25$ 是一个具有四位有效数字的精确结果，符合要求。\n\n**解释：**\n比较两个约束 $\\Delta t_{adv} = 500\\,\\text{s}$ 和 $\\Delta t_{ac} = 31.25\\,\\text{s}$，可以发现 $\\Delta t_{ac}$ 远小于 $\\Delta t_{adv}$。这表明**声学模态是显式格式稳定性的限制因素**。声波的高传播速度（$c_s = 320\\,\\text{m s}^{-1}$）迫使我们使用非常小的时间步长，而具有重要气象意义的平流过程（$U = 20\\,\\text{m s}^{-1}$）则允许使用大得多的时间步长。这种差异是大气模拟中的一个典型挑战，它推动了计算效率更高的时间积分方法的发展，例如分裂-显式（split-explicit）或半隐式（semi-implicit）格式，这些方法对快、慢模态进行区别处理。",
            "answer": "$$\n\\boxed{31.25}\n$$"
        },
        {
            "introduction": "在了解了稳定性带来的挑战后，这个练习将重点转向数值格式的精度，并介绍一种常用于克服刚性问题的隐式方法。你将通过推导Crank-Nicolson格式的放大因子并量化其在模拟波动现象时的相位误差，来分析该格式的特性。这项练习为你提供了一个关键工具，用以评估数值格式在多大程度上能保持波动的物理属性，这是模型保真度的重要方面 。",
            "id": "4105191",
            "problem": "在数值天气预报 (Numerical Weather Prediction, NWP) 和气候模拟中，预报方程支持振荡简正模（例如，惯性重力波），其单个水平傅里叶分量可以用一个复振幅表示，该复振幅满足形式为 $\\frac{dy}{dt}=\\lambda y$ 的线性常微分方程 (Ordinary Differential Equation, ODE)。考虑一个具有纯振荡频率的此类单模，因此 $\\lambda=i\\omega$，其中 $\\omega>0$ 为实数，并令 $\\Delta t>0$ 表示一个固定的时间步长。定义无量纲步长 $z=\\lambda \\Delta t$ 和 $\\Omega=\\omega \\Delta t$，因此 $z=i\\Omega$。\n\n从积分形式 $y^{n+1}-y^{n}=\\int_{t_n}^{t_{n+1}} f(y(t))\\,dt$（其中 $f(y)=\\lambda y$）出发，通过将梯形法则应用于右侧，构建 Crank-Nicolson (CN) 单步时间积分方法。对于线性检验方程 $\\frac{dy}{dt}=\\lambda y$，推导相应的线性放大因子 $R(z)$（定义为 $y^{n+1}=R(z)\\,y^{n}$）作为 $z$ 的函数。然后，将其特化到振荡情况 $z=i\\Omega$，并定义数值相位 $\\theta(\\Omega)=\\arg\\big(R(i\\Omega)\\big)$，其中角度以弧度为单位。使用对小 $\\Omega$ 有效的级数展开，求得相位误差 $\\varepsilon(\\Omega)=\\theta(\\Omega)-\\Omega$ 关于 $\\Omega$ 的幂级数，直到并包括 $\\Omega^{5}$ 阶项。\n\n以 $\\mathcal{O}(\\Omega^{5})$ 阶截断的单个 $\\varepsilon(\\Omega)$ 闭式表达式的形式提供您的最终结果，角度以弧度为单位。不需要进行数值舍入。",
            "solution": "求解过程如下。给定预报方程 $\\frac{dy}{dt} = \\lambda y$，对于纯振荡模，该方程变为 $\\frac{dy}{dt} = i\\omega y$，其中 $\\omega > 0$ 是一个实常数。任务是分析该方程的 Crank-Nicolson 时间积分格式。\n\n首先，我们构建 Crank-Nicolson 格式。我们从方程在一个时间步长 $\\Delta t$ 内（从 $t_n$ 到 $t_{n+1} = t_n + \\Delta t$）的积分形式开始：\n$$y(t_{n+1}) - y(t_n) = \\int_{t_n}^{t_{n+1}} \\lambda y(t) \\, dt$$\n使用记法 $y^k = y(t_k)$，可得：\n$$y^{n+1} - y^{n} = \\int_{t_n}^{t_{n+1}} \\lambda y(t) \\, dt$$\nCrank-Nicolson 方法是通过将梯形法则应用于右侧的积分而推导出来的。梯形法则将积分近似为：\n$$\\int_{a}^{b} g(t) \\, dt \\approx \\frac{b-a}{2} [g(a) + g(b)]$$\n将此应用于我们的问题，其中 $g(t) = \\lambda y(t)$，$a = t_n$，$b = t_{n+1}$，我们得到离散格式：\n$$y^{n+1} - y^{n} = \\frac{t_{n+1} - t_n}{2} [\\lambda y(t_n) + \\lambda y(t_{n+1})]$$\n$$y^{n+1} - y^{n} = \\frac{\\Delta t}{2} (\\lambda y^n + \\lambda y^{n+1})$$\n为了推导放大因子 $R(z)$，我们引入无量纲步长 $z = \\lambda \\Delta t$。该格式可以重写为：\n$$y^{n+1} - y^{n} = \\frac{z}{2} (y^n + y^{n+1})$$\n我们现在重新整理方程，以求解 $y^{n+1}$ 作为 $y^n$ 的函数：\n$$y^{n+1} \\left(1 - \\frac{z}{2}\\right) = y^n \\left(1 + \\frac{z}{2}\\right)$$\n$$y^{n+1} = \\left(\\frac{1 + z/2}{1 - z/2}\\right) y^n$$\n根据定义 $y^{n+1} = R(z) y^n$，Crank-Nicolson 格式的线性放大因子为：\n$$R(z) = \\frac{1 + z/2}{1 - z/2}$$\n对于指定的纯振荡情况，我们有 $\\lambda = i\\omega$，这使得无量纲步长 $z = i\\omega \\Delta t = i\\Omega$，其中 $\\Omega = \\omega \\Delta t > 0$。将 $z = i\\Omega$ 代入 $R(z)$ 的表达式中：\n$$R(i\\Omega) = \\frac{1 + i\\Omega/2}{1 - i\\Omega/2}$$\n数值相位 $\\theta(\\Omega)$ 是这个复数的辐角。利用复数 $w$ 的性质 $\\arg(w/\\bar{w}) = 2\\arg(w)$，或通过计算 $\\arg(1+i\\Omega/2) - \\arg(1-i\\Omega/2)$，我们发现：\n$$\\theta(\\Omega) = \\arg(R(i\\Omega)) = \\arg(1 + i\\Omega/2) - \\arg(1 - i\\Omega/2)$$\n复数 $x+iy$ 的辐角是 $\\arctan(y/x)$。因此：\n$$\\arg(1 + i\\Omega/2) = \\arctan\\left(\\frac{\\Omega/2}{1}\\right) = \\arctan\\left(\\frac{\\Omega}{2}\\right)$$\n$$\\arg(1 - i\\Omega/2) = \\arctan\\left(\\frac{-\\Omega/2}{1}\\right) = -\\arctan\\left(\\frac{\\Omega}{2}\\right)$$\n将这些结合起来，得到数值相位：\n$$\\theta(\\Omega) = \\arctan\\left(\\frac{\\Omega}{2}\\right) - \\left(-\\arctan\\left(\\frac{\\Omega}{2}\\right)\\right) = 2 \\arctan\\left(\\frac{\\Omega}{2}\\right)$$\n$\\frac{dy}{dt} = i\\omega y$ 的精确解是 $y(t) = y(0) \\exp(i\\omega t)$。在一个时间步长 $\\Delta t$ 内，精确解的相位增加了 $\\omega \\Delta t = \\Omega$。相位误差 $\\varepsilon(\\Omega)$ 是数值相位与精确相位之差：\n$$\\varepsilon(\\Omega) = \\theta(\\Omega) - \\Omega = 2 \\arctan\\left(\\frac{\\Omega}{2}\\right) - \\Omega$$\n为了求 $\\varepsilon(\\Omega)$ 直到 $\\Omega^5$ 阶的幂级数，我们使用反正切函数的麦克劳林级数：\n$$\\arctan(x) = x - \\frac{x^3}{3} + \\frac{x^5}{5} - \\mathcal{O}(x^7)$$\n我们将 $x = \\Omega/2$ 代入此级数：\n$$\\arctan\\left(\\frac{\\Omega}{2}\\right) = \\left(\\frac{\\Omega}{2}\\right) - \\frac{1}{3}\\left(\\frac{\\Omega}{2}\\right)^3 + \\frac{1}{5}\\left(\\frac{\\Omega}{2}\\right)^5 - \\mathcal{O}(\\Omega^7)$$\n$$\\arctan\\left(\\frac{\\Omega}{2}\\right) = \\frac{\\Omega}{2} - \\frac{\\Omega^3}{24} + \\frac{\\Omega^5}{160} - \\mathcal{O}(\\Omega^7)$$\n现在将此展开式代回相位误差 $\\varepsilon(\\Omega)$ 的表达式中：\n$$\\varepsilon(\\Omega) = 2 \\left( \\frac{\\Omega}{2} - \\frac{\\Omega^3}{24} + \\frac{\\Omega^5}{160} - \\mathcal{O}(\\Omega^7) \\right) - \\Omega$$\n将因子 2 乘进去：\n$$\\varepsilon(\\Omega) = \\left( \\Omega - \\frac{\\Omega^3}{12} + \\frac{\\Omega^5}{80} - \\mathcal{O}(\\Omega^7) \\right) - \\Omega$$\n最后，减去 $\\Omega$ 得到相位误差展开式：\n$$\\varepsilon(\\Omega) = -\\frac{\\Omega^3}{12} + \\frac{\\Omega^5}{80} - \\mathcal{O}(\\Omega^7)$$\n将此级数截断至包含 $\\Omega^5$ 阶项，即可得到所需的表达式。",
            "answer": "$$\\boxed{-\\frac{\\Omega^{3}}{12} + \\frac{\\Omega^{5}}{80}}$$"
        },
        {
            "introduction": "本练习旨在对两种不同的显式积分框架——蛙跳格式（leapfrog）和二阶龙格-库塔（RK2）方法——进行比较分析。通过推导两种格式的相位误差（频散）和振幅误差（耗散）的主阶项，你将学会批判性地评估和对比不同数值格式之间的权衡。这突显出不存在唯一的“最佳”方法，方案的选择取决于对精度和稳定性的具体要求 。",
            "id": "4105167",
            "problem": "考虑由预报方程 $$\\frac{\\partial q}{\\partial t} + c\\,\\frac{\\partial q}{\\partial x} = 0,$$ 控制的无源标量的一维线性平流，其定义在一个长度为 $L$ 的周期性域上，其中 $c>0$ 是常数。对于一个傅里叶模态初始条件 $$q(x,0) = \\hat{q}_0\\,\\exp\\!\\big(i k x\\big),$$ 其精确解为 $$q(x,t) = \\hat{q}_0\\,\\exp\\!\\big(i k (x - c t)\\big),$$ 这意味着傅里叶振幅 $u(t) \\equiv \\hat{q}(t)$ 的时间演化满足线性常微分方程 $$\\frac{d u}{d t} = - i \\omega\\,u, \\quad \\omega \\equiv c k,$$ 其精确解为 $u(t) = u(0)\\,\\exp(- i \\omega t)$。定义库朗数为 $$\\mu \\equiv \\omega\\,\\Delta t = c k\\,\\Delta t,$$ 其中 $\\Delta t$ 是时间步长。\n\n在数值天气预报和气候模拟中，考虑使用两种时间积分方案来计算 $u(t)$ 的时间演化：\n\n1. 蛙跳格式（两步，时间中心差），为半离散预报方程定义为 $$u^{n+1} = u^{n-1} + 2\\,\\Delta t\\,\\frac{d u}{d t}\\bigg|_{t=t_n},$$ 应用于 $\\frac{d u}{d t} = - i \\omega u$。\n\n2. 二阶两步显式龙格-库塔方法（RK2），由以下步骤定义 $$k_1 = - i \\omega\\,u^n, \\quad k_2 = - i \\omega\\,(u^n + \\Delta t\\,k_1), \\quad u^{n+1} = u^n + \\frac{\\Delta t}{2}\\,(k_1 + k_2)。$$\n\n对于每种方法，为物理模态定义单步放大因子 $G(\\mu)$ 为 $u^{n+1} = G(\\mu)\\,u^n$。定义每个时间步长的数值相位增量为 $$\\psi(\\mu) \\equiv -\\arg\\big(G(\\mu)\\big),$$ 以及每个时间步长的对数振幅变化为 $$\\delta_A(\\mu) \\equiv \\ln\\big|G(\\mu)\\big|.$$ 精确的连续演化具有相位增量 $\\mu$ 和每个时间步长为零的对数振幅变化。定义每步相位误差为 $$\\delta_{\\phi}(\\mu) \\equiv \\psi(\\mu) - \\mu.$$\n\n假设 $|\\mu| \\ll 1$，这在大型数值天气预报中是典型情况，其中 $c$ 的量级为每秒几十米，$L$ 的量级为 $10^6$ 米，$\\Delta t$ 的量级为 $10^2$ 至 $10^3$ 秒，因此 $k = 2\\pi/L$ 会产生一个小的 $\\mu$。仅从上述定义和预报方程出发，推导蛙跳格式和龙格-库塔（RK2）格式的 $\\delta_{\\phi}(\\mu)$ 和 $\\delta_A(\\mu)$ 的小-$\\mu$ 渐近展开式。具体来说，确定由下式定义的领头阶误差常数 $\\alpha$ 和 $\\beta$\n$$\\delta_{\\phi}(\\mu) = \\alpha\\,\\mu^{3} + \\mathcal{O}(\\mu^{5}), \\qquad \\delta_A(\\mu) = \\beta\\,\\mu^{4} + \\mathcal{O}(\\mu^{6}),$$\n对于每种方法。将你的最终答案表示为一个单行矩阵，按顺序包含这四个常数 $$\\alpha_{\\mathrm{LF}},\\ \\beta_{\\mathrm{LF}},\\ \\alpha_{\\mathrm{RK2}},\\ \\beta_{\\mathrm{RK2}}。$$ 不需要进行数值取整。所有量均为无量纲。",
            "solution": "我们继续为这两种方案推导所要求的常数 $\\alpha$ 和 $\\beta$。\n\n**1. 蛙跳（LF）格式**\n\n针对常微分方程 $\\frac{d u}{d t} = - i \\omega u$ 的蛙跳格式由下式给出\n$$u^{n+1} = u^{n-1} + 2 \\Delta t \\left( \\frac{d u}{d t} \\right)^n = u^{n-1} + 2 \\Delta t (-i \\omega u^n)。$$\n使用库朗数 $\\mu = \\omega \\Delta t$ 的定义，上式变为\n$$u^{n+1} = u^{n-1} - 2 i \\mu u^n。$$\n为了找到放大因子，我们寻求形式为 $u^n = G^n u^0$ 的解。将此假设代入格式中，得到\n$$G^{n+1} u^0 = G^{n-1} u^0 - 2 i \\mu G^n u^0。$$\n对于 $G \\neq 0$ 和 $u^0 \\neq 0$，两边同除以 $G^{n-1} u^0$，得到 G 的特征多项式：\n$$G^2 + 2 i \\mu G - 1 = 0。$$\n这是关于 G 的一个二次方程，其解为\n$$G = \\frac{-2 i \\mu \\pm \\sqrt{(2 i \\mu)^2 - 4(1)(-1)}}{2} = -i \\mu \\pm \\sqrt{1 - \\mu^2}。$$\n单个时间步长的精确放大因子是 $G_{\\text{exact}} = \\exp(-i \\mu)$。对于小 $\\mu$，其泰勒级数为 $G_{\\text{exact}} = 1 - i \\mu - \\frac{1}{2} \\mu^2 + \\mathcal{O}(\\mu^3)$。我们必须通过比较其小-$\\mu$ 展开式与 $G_{\\text{exact}}$ 的展开式，来确定 G 的两个根中哪一个对应于物理模态。\n使用泰勒展开式 $\\sqrt{1-x} = 1 - \\frac{x}{2} - \\frac{x^2}{8} - \\dots$，两个根是：\n$$G_1 = -i \\mu + \\sqrt{1 - \\mu^2} \\approx -i \\mu + \\left(1 - \\frac{\\mu^2}{2} - \\frac{\\mu^4}{8}\\right) = 1 - i \\mu - \\frac{1}{2}\\mu^2 - \\frac{1}{8}\\mu^4 + \\mathcal{O}(\\mu^6)。$$\n$$G_2 = -i \\mu - \\sqrt{1 - \\mu^2} \\approx -i \\mu - \\left(1 - \\frac{\\mu^2}{2}\\right) = -1 - i \\mu + \\frac{1}{2}\\mu^2 + \\mathcal{O}(\\mu^4)。$$\n显然，$G_1$ 近似于 $G_{\\text{exact}}$，因此它代表物理模态。因此，蛙跳格式物理模态的放大因子是\n$$G_{\\mathrm{LF}}(\\mu) = \\sqrt{1 - \\mu^2} - i \\mu。$$\n这在 $|\\mu| \\le 1$ 时有效。\n\n现在我们分析 $G_{\\mathrm{LF}}(\\mu)$ 的振幅和相位。模的平方是\n$$|G_{\\mathrm{LF}}(\\mu)|^2 = \\left(\\sqrt{1 - \\mu^2}\\right)^2 + (-\\mu)^2 = (1 - \\mu^2) + \\mu^2 = 1。$$\n因此，对于 $|\\mu| \\le 1$，有 $|G_{\\mathrm{LF}}(\\mu)| = 1$。该格式是无耗散的（中性稳定）。\n每个时间步长的对数振幅变化是\n$$\\delta_A(\\mu) = \\ln|G_{\\mathrm{LF}}(\\mu)| = \\ln(1) = 0。$$\n将其与指定的渐近形式 $\\delta_A(\\mu) = \\beta_{\\mathrm{LF}}\\,\\mu^{4} + \\mathcal{O}(\\mu^{6})$ 进行比较，我们发现级数中的所有系数都必须为零。因此，\n$$\\beta_{\\mathrm{LF}} = 0。$$\n\n相位增量 $\\psi(\\mu) = -\\arg(G_{\\mathrm{LF}}(\\mu))$。令 $\\phi = \\arg(G_{\\mathrm{LF}}(\\mu))$。由于 $|G_{\\mathrm{LF}}(\\mu)| = 1$，我们可以写作 $G_{\\mathrm{LF}}(\\mu) = \\cos(\\phi) + i \\sin(\\phi)$。将其与 $G_{\\mathrm{LF}}(\\mu) = \\sqrt{1 - \\mu^2} - i \\mu$ 比较，我们得到 $\\cos(\\phi) = \\sqrt{1 - \\mu^2}$ 和 $\\sin(\\phi) = -\\mu$。\n由 $\\sin(\\phi) = -\\mu$ 可知，$\\phi = \\arcsin(-\\mu)$。$\\arcsin(x)$ 的泰勒展开式为 $x + \\frac{x^3}{6} + \\mathcal{O}(x^5)$。所以，\n$$\\phi = -\\mu - \\frac{\\mu^3}{6} + \\mathcal{O}(\\mu^5)。$$\n数值相位增量是\n$$\\psi(\\mu) = -\\phi = \\mu + \\frac{1}{6}\\mu^3 + \\mathcal{O}(\\mu^5)。$$\n每步相位误差是\n$$\\delta_{\\phi}(\\mu) = \\psi(\\mu) - \\mu = \\left(\\mu + \\frac{1}{6}\\mu^3 + \\mathcal{O}(\\mu^5)\\right) - \\mu = \\frac{1}{6}\\mu^3 + \\mathcal{O}(\\mu^5)。$$\n将其与形式 $\\delta_{\\phi}(\\mu) = \\alpha_{\\mathrm{LF}}\\,\\mu^{3} + \\mathcal{O}(\\mu^{5})$ 比较，我们得到\n$$\\alpha_{\\mathrm{LF}} = \\frac{1}{6}。$$\n\n**2. 二阶两步龙格-库塔（RK2）格式**\n\nRK2 格式由以下步骤给出：\n$$k_1 = - i \\omega u^n$$\n$$k_2 = - i \\omega (u^n + \\Delta t k_1)$$\n$$u^{n+1} = u^n + \\frac{\\Delta t}{2} (k_1 + k_2)$$\n首先，我们用 $u^n$ 表示 $k_2$：\n$$k_2 = -i \\omega \\left(u^n + \\Delta t (-i \\omega u^n)\\right) = -i \\omega u^n (1 - i \\omega \\Delta t) = -i \\omega u^n (1 - i \\mu)。$$\n现在，我们将 $k_1$ 和 $k_2$ 代入 $u^{n+1}$ 的更新公式中：\n$$u^{n+1} = u^n + \\frac{\\Delta t}{2} \\left( -i \\omega u^n - i \\omega u^n (1 - i \\mu) \\right)$$\n$$u^{n+1} = u^n \\left( 1 + \\frac{\\Delta t}{2} \\left( -i \\omega - i \\omega (1 - i \\mu) \\right) \\right)$$\n$$u^{n+1} = u^n \\left( 1 - \\frac{i \\omega \\Delta t}{2} \\left( 1 + (1-i\\mu) \\right) \\right) = u^n \\left( 1 - \\frac{i \\mu}{2} (2 - i \\mu) \\right)$$\n$$u^{n+1} = u^n \\left( 1 - i \\mu - \\frac{\\mu^2}{2} \\right)。$$\n单步放大因子是\n$$G_{\\mathrm{RK2}}(\\mu) = 1 - \\frac{\\mu^2}{2} - i \\mu。$$\n模的平方是\n$$|G_{\\mathrm{RK2}}(\\mu)|^2 = \\left(1 - \\frac{\\mu^2}{2}\\right)^2 + (-\\mu)^2 = 1 - \\mu^2 + \\frac{\\mu^4}{4} + \\mu^2 = 1 + \\frac{\\mu^4}{4}。$$\n模是 $|G_{\\mathrm{RK2}}(\\mu)| = \\sqrt{1 + \\frac{\\mu^4}{4}}$。对数振幅变化是\n$$\\delta_A(\\mu) = \\ln|G_{\\mathrm{RK2}}(\\mu)| = \\ln\\left( \\left(1 + \\frac{\\mu^4}{4}\\right)^{1/2} \\right) = \\frac{1}{2} \\ln\\left(1 + \\frac{\\mu^4}{4}\\right)。$$\n使用泰勒展开 $\\ln(1+x) = x - \\frac{x^2}{2} + \\dots$，其中 $x = \\frac{\\mu^4}{4}$：\n$$\\delta_A(\\mu) = \\frac{1}{2} \\left( \\frac{\\mu^4}{4} + \\mathcal{O}(\\mu^8) \\right) = \\frac{1}{8}\\mu^4 + \\mathcal{O}(\\mu^8)。$$\n将其与 $\\delta_A(\\mu) = \\beta_{\\mathrm{RK2}}\\,\\mu^{4} + \\mathcal{O}(\\mu^{6})$ 匹配，我们得到\n$$\\beta_{\\mathrm{RK2}} = \\frac{1}{8}。$$\n\n对于相位，我们有 $\\psi(\\mu) = -\\arg(G_{\\mathrm{RK2}}(\\mu))$。令 $\\phi = \\arg(G_{\\mathrm{RK2}}(\\mu))$。那么\n$$\\tan(\\phi) = \\frac{\\mathrm{Im}(G_{\\mathrm{RK2}})}{\\mathrm{Re}(G_{\\mathrm{RK2}})} = \\frac{-\\mu}{1 - \\mu^2/2}。$$\n相位增量是 $\\psi(\\mu) = -\\phi$，所以 $\\tan(\\psi) = -\\tan(\\phi) = \\frac{\\mu}{1 - \\mu^2/2}$。我们使用反正切函数求解 $\\psi$：\n$$\\psi(\\mu) = \\arctan\\left(\\frac{\\mu}{1 - \\mu^2/2}\\right)。$$\n我们使用泰勒级数 $(1-x)^{-1} = 1 + x + x^2 + \\dots$，其中 $x = \\mu^2/2$，来展开反正切函数的参数：\n$$\\frac{\\mu}{1 - \\mu^2/2} = \\mu \\left(1 - \\frac{\\mu^2}{2}\\right)^{-1} = \\mu \\left(1 + \\frac{\\mu^2}{2} + \\frac{\\mu^4}{4} + \\dots \\right) = \\mu + \\frac{\\mu^3}{2} + \\mathcal{O}(\\mu^5)。$$\n现在，我们使用泰勒级数 $\\arctan(y) = y - \\frac{y^3}{3} + \\dots$，其中 $y = \\mu + \\frac{\\mu^3}{2} + \\dots$：\n$$\\psi(\\mu) = \\left(\\mu + \\frac{\\mu^3}{2}\\right) - \\frac{1}{3}\\left(\\mu + \\mathcal{O}(\\mu^3)\\right)^3 + \\mathcal{O}(\\mu^5)$$\n$$\\psi(\\mu) = \\mu + \\frac{\\mu^3}{2} - \\frac{\\mu^3}{3} + \\mathcal{O}(\\mu^5) = \\mu + \\left(\\frac{1}{2} - \\frac{1}{3}\\right)\\mu^3 + \\mathcal{O}(\\mu^5) = \\mu + \\frac{1}{6}\\mu^3 + \\mathcal{O}(\\mu^5)。$$\n每步相位误差是\n$$\\delta_{\\phi}(\\mu) = \\psi(\\mu) - \\mu = \\frac{1}{6}\\mu^3 + \\mathcal{O}(\\mu^5)。$$\n将其与 $\\delta_{\\phi}(\\mu) = \\alpha_{\\mathrm{RK2}}\\,\\mu^{3} + \\mathcal{O}(\\mu^{5})$ 比较，我们发现\n$$\\alpha_{\\mathrm{RK2}} = \\frac{1}{6}。$$\n\n综上所述，这四个常数是：\n$\\alpha_{\\mathrm{LF}} = 1/6$\n$\\beta_{\\mathrm{LF}} = 0$\n$\\alpha_{\\mathrm{RK2}} = 1/6$\n$\\beta_{\\mathrm{RK2}} = 1/8$",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{6} & 0 & \\frac{1}{6} & \\frac{1}{8} \\end{pmatrix}}$$"
        }
    ]
}