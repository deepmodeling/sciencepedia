{
    "hands_on_practices": [
        {
            "introduction": "Atmospheric and climate models solve equations on the spherical surface of the Earth, where a standard Cartesian grid is inadequate. This exercise provides foundational practice in correctly discretizing differential operators in a spherical coordinate system. By starting from the geometric line element, you will derive the discrete horizontal gradient, a building block for nearly all terms in the governing equations, learning how to incorporate the essential metric scale factors that account for the convergence of meridians toward the poles .",
            "id": "4091166",
            "problem": "Consider a global latitudeâ€“longitude discretization of a spherical Earth used in Numerical Weather Prediction and Climate Modeling, with the Earth's mean radius denoted by $a$. The computational grid is defined on angular coordinates $(\\lambda,\\phi)$, where $\\lambda$ is longitude and $\\phi$ is latitude, both measured in radians. The grid is uniformly spaced with angular steps $\\Delta \\lambda$ in longitude and $\\Delta \\phi$ in latitude. Let a scalar field $q(\\lambda,\\phi)$ be sampled at grid points $(\\lambda_i,\\phi_j)$ and denote the discrete values by $q_{i,j} = q(\\lambda_i,\\phi_j)$. Assume $(\\lambda_i,\\phi_j)$ is an interior point not at the poles (so that $\\cos\\phi_j \\neq 0$). \n\nStarting from the spherical geometry of the Earth and the definition of the gradient in orthogonal curvilinear coordinates, derive a second-order accurate discrete approximation to the horizontal gradient of $q$ at $(\\lambda_i,\\phi_j)$ that properly accounts for the spherical metric. Your base should be the line element on a sphere,\n$$\n\\mathrm{d}\\ell^{2} = a^{2}\\cos^{2}\\phi\\,\\mathrm{d}\\lambda^{2} + a^{2}\\,\\mathrm{d}\\phi^{2},\n$$\nand the definition of the gradient in terms of directional derivatives along orthogonal coordinate lines. Use centered differences to approximate the necessary partial derivatives of $q$ at $(\\lambda_i,\\phi_j)$.\n\nExpress your final answer as a two-component row vector giving, respectively, the eastward (along increasing $\\lambda$) and northward (along increasing $\\phi$) components of the discrete gradient at $(\\lambda_i,\\phi_j)$, written solely in terms of $a$, $\\phi_j$, $\\Delta \\lambda$, $\\Delta \\phi$, and the neighboring grid values of $q$. Use radians for angular quantities and meters for $a$, so that the components of the gradient have units of the scalar per meter. The final answer must be a single closed-form analytic expression as specified above. No rounding is required.",
            "solution": "The problem is valid. It is scientifically grounded in differential geometry and numerical analysis, well-posed with sufficient information, and objectively stated. We will proceed to derive the solution.\n\nThe horizontal gradient of a scalar field $q$ on a surface is a vector field that points in the direction of the greatest rate of increase of $q$, with a magnitude equal to this rate of change. For an orthogonal curvilinear coordinate system $(u_1, u_2)$, the gradient is given by:\n$$\n\\nabla q = \\frac{1}{h_1} \\frac{\\partial q}{\\partial u_1} \\hat{\\mathbf{e}}_1 + \\frac{1}{h_2} \\frac{\\partial q}{\\partial u_2} \\hat{\\mathbf{e}}_2\n$$\nwhere $\\hat{\\mathbf{e}}_1$ and $\\hat{\\mathbf{e}}_2$ are the unit vectors in the directions of increasing $u_1$ and $u_2$, respectively, and $h_1$ and $h_2$ are the metric scale factors. The scale factors are defined by the differential line element $\\mathrm{d}\\ell$, such that the square of the distance between two infinitesimally close points is $\\mathrm{d}\\ell^2 = (h_1 \\mathrm{d}u_1)^2 + (h_2 \\mathrm{d}u_2)^2$.\n\nThe problem provides the line element for a spherical surface of radius $a$ using longitude $\\lambda$ and latitude $\\phi$ as coordinates:\n$$\n\\mathrm{d}\\ell^2 = a^2 \\cos^2\\phi \\, \\mathrm{d}\\lambda^2 + a^2 \\, \\mathrm{d}\\phi^2\n$$\nHere, our coordinates are $u_1 = \\lambda$ and $u_2 = \\phi$. By comparing this to the general form of the line element, we can identify the scale factors. The eastward direction corresponds to increasing $\\lambda$, and the northward direction corresponds to increasing $\\phi$.\n\nThe term corresponding to the longitudinal displacement is $(h_\\lambda \\mathrm{d}\\lambda)^2 = a^2 \\cos^2\\phi \\, \\mathrm{d}\\lambda^2$. This gives the scale factor for the longitude coordinate as:\n$$\nh_\\lambda = a \\cos\\phi\n$$\nThe term corresponding to the latitudinal displacement is $(h_\\phi \\mathrm{d}\\phi)^2 = a^2 \\, \\mathrm{d}\\phi^2$. This gives the scale factor for the latitude coordinate as:\n$$\nh_\\phi = a\n$$\nThese scale factors relate the change in angular coordinates $(\\mathrm{d}\\lambda, \\mathrm{d}\\phi)$ to physical distances on the sphere's surface. A differential displacement in the eastward direction is $\\mathrm{d}x = h_\\lambda \\mathrm{d}\\lambda = a \\cos\\phi \\, \\mathrm{d}\\lambda$, and in the northward direction is $\\mathrm{d}y = h_\\phi \\mathrm{d}\\phi = a \\, \\mathrm{d}\\phi$.\n\nSubstituting these coordinates and scale factors into the general gradient formula, we obtain the expression for the horizontal gradient on a sphere:\n$$\n\\nabla q = \\frac{1}{h_\\lambda} \\frac{\\partial q}{\\partial \\lambda} \\hat{\\mathbf{e}}_\\lambda + \\frac{1}{h_\\phi} \\frac{\\partial q}{\\partial \\phi} \\hat{\\mathbf{e}}_\\phi = \\frac{1}{a \\cos\\phi} \\frac{\\partial q}{\\partial \\lambda} \\hat{\\mathbf{e}}_\\lambda + \\frac{1}{a} \\frac{\\partial q}{\\partial \\phi} \\hat{\\mathbf{e}}_\\phi\n$$\nwhere $\\hat{\\mathbf{e}}_\\lambda$ is the unit vector pointing east and $\\hat{\\mathbf{e}}_\\phi$ is the unit vector pointing north. The two components of the gradient vector are the eastward component, $(\\nabla q)_\\lambda$, and the northward component, $(\\nabla q)_\\phi$:\n$$\n(\\nabla q)_\\lambda = \\frac{1}{a \\cos\\phi} \\frac{\\partial q}{\\partial \\lambda}\n$$\n$$\n(\\nabla q)_\\phi = \\frac{1}{a} \\frac{\\partial q}{\\partial \\phi}\n$$\nThese components have units of the scalar $q$ per unit distance (meter), as required.\n\nThe next step is to approximate the partial derivatives $\\frac{\\partial q}{\\partial \\lambda}$ and $\\frac{\\partial q}{\\partial \\phi}$ using a second-order accurate finite difference scheme at the grid point $(\\lambda_i, \\phi_j)$. The problem specifies the use of centered differences. A centered difference approximation for the first derivative of a function $f(x)$ at $x_i$ is given by $\\frac{f(x_i+\\Delta x) - f(x_i-\\Delta x)}{2\\Delta x}$, which is second-order accurate in $\\Delta x$.\n\nFor the partial derivative with respect to longitude $\\lambda$ at $(\\lambda_i, \\phi_j)$, we use the values of $q$ at the neighboring grid points in the east-west direction, $(\\lambda_{i+1}, \\phi_j)$ and $(\\lambda_{i-1}, \\phi_j)$. Here, $\\lambda_{i+1} = \\lambda_i + \\Delta\\lambda$ and $\\lambda_{i-1} = \\lambda_i - \\Delta\\lambda$. The discrete values are $q_{i+1,j}$ and $q_{i-1,j}$. The centered difference approximation is:\n$$\n\\frac{\\partial q}{\\partial \\lambda}\\bigg|_{i,j} \\approx \\frac{q(\\lambda_i+\\Delta\\lambda, \\phi_j) - q(\\lambda_i-\\Delta\\lambda, \\phi_j)}{2\\Delta\\lambda} = \\frac{q_{i+1,j} - q_{i-1,j}}{2\\Delta\\lambda}\n$$\nSimilarly, for the partial derivative with respect to latitude $\\phi$ at $(\\lambda_i, \\phi_j)$, we use the values of $q$ at the neighboring grid points in the north-south direction, $(\\lambda_i, \\phi_{j+1})$ and $(\\lambda_i, \\phi_{j-1})$. Here, $\\phi_{j+1} = \\phi_j + \\Delta\\phi$ and $\\phi_{j-1} = \\phi_j - \\Delta\\phi$. The discrete values are $q_{i,j+1}$ and $q_{i,j-1}$. The centered difference approximation is:\n$$\n\\frac{\\partial q}{\\partial \\phi}\\bigg|_{i,j} \\approx \\frac{q(\\lambda_i, \\phi_j+\\Delta\\phi) - q(\\lambda_i, \\phi_j-\\Delta\\phi)}{2\\Delta\\phi} = \\frac{q_{i,j+1} - q_{i,j-1}}{2\\Delta\\phi}\n$$\nNow, we substitute these discrete approximations into the expressions for the gradient components, evaluating the scale factors at the latitude $\\phi_j$. The problem states that $\\cos\\phi_j \\neq 0$, which ensures the longitudinal scale factor is well-defined.\n\nThe eastward component of the discrete gradient at $(\\lambda_i, \\phi_j)$ is:\n$$\n(\\nabla_h q)_{i,j, \\lambda} = \\frac{1}{a \\cos\\phi_j} \\left( \\frac{q_{i+1,j} - q_{i-1,j}}{2\\Delta\\lambda} \\right) = \\frac{q_{i+1,j} - q_{i-1,j}}{2a \\Delta\\lambda \\cos\\phi_j}\n$$\nThe northward component of the discrete gradient at $(\\lambda_i, \\phi_j)$ is:\n$$\n(\\nabla_h q)_{i,j, \\phi} = \\frac{1}{a} \\left( \\frac{q_{i,j+1} - q_{i,j-1}}{2\\Delta\\phi} \\right) = \\frac{q_{i,j+1} - q_{i,j-1}}{2a \\Delta\\phi}\n$$\nThe problem asks for the result as a two-component row vector representing the discrete horizontal gradient $(\\nabla_h q)_{i,j}$. Combining the two components yields the final expression.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{q_{i+1,j} - q_{i-1,j}}{2a \\Delta\\lambda \\cos\\phi_j} & \\frac{q_{i,j+1} - q_{i,j-1}}{2a \\Delta\\phi}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Replacing continuous derivatives with finite-difference approximations fundamentally alters how information propagates in a numerical model. To understand the fidelity of a numerical scheme, we must analyze its behavior across a spectrum of waves. This practice introduces dispersion analysis, a powerful technique to quantify how a scheme represents waves of different lengths, revealing critical numerical artifacts like spurious dispersion where waves travel at the wrong speed or even in the wrong direction .",
            "id": "4091169",
            "problem": "Consider one-dimensional passive tracer advection relevant to Numerical Weather Prediction (NWP) and climate modeling, governed by the linear advection equation $u_{t} + c\\,u_{x} = 0$, where $u(x,t)$ is the tracer concentration and $c>0$ is a constant zonal wind speed. Let space be discretized on a uniform grid $x_{j} = j\\,\\Delta x$ with grid spacing $\\Delta x>0$, and define the semi-discrete model by replacing the spatial derivative $u_{x}$ with the second-order central finite difference on this grid while keeping time continuous. Perform a Fourier normal-mode analysis of the resulting semi-discrete system to derive the discrete dispersion relation $\\,\\omega(k)\\,$ as a function of the continuous wavenumber $k$ (measured in radians per meter), and from it obtain the group velocity $v_{g}(k) = \\frac{d\\omega}{dk}$. Using this analysis, define $k_{c} \\in (0,\\pi/\\Delta x)$ to be the smallest positive wavenumber at which the group velocity changes sign. Determine $k_{c}$ as a closed-form analytic expression in terms of $\\Delta x$. Use radians for all trigonometric arguments and express the final answer for $k_{c}$ in radians per meter. No rounding is required.",
            "solution": "The problem statement is confirmed to be valid as it is scientifically grounded, well-posed, and objective. It represents a standard analysis of a numerical method for a fundamental partial differential equation. We proceed with the solution.\n\nThe one-dimensional linear advection equation is given by:\n$$u_{t} + c\\,u_{x} = 0$$\nwhere $u(x,t)$ is the tracer concentration, and $c>0$ is a constant advection speed.\n\nThe spatial domain is discretized on a uniform grid $x_{j} = j\\,\\Delta x$, where $j$ is an integer index and $\\Delta x$ is the constant grid spacing. The continuous-in-time, discrete-in-space (semi-discrete) formulation is obtained by approximating the spatial derivative $u_{x}$ at grid point $x_j$ using a second-order central finite difference. Let $u_j(t)$ denote the approximation of $u(x_j, t)$. The approximation is:\n$$\\left.\\frac{\\partial u}{\\partial x}\\right|_{x=x_j} \\approx \\frac{u(x_{j+1},t) - u(x_{j-1},t)}{2\\,\\Delta x} = \\frac{u_{j+1}(t) - u_{j-1}(t)}{2\\,\\Delta x}$$\nSubstituting this into the governing equation yields the semi-discrete system of ordinary differential equations:\n$$\\frac{d u_j}{dt} + c\\,\\frac{u_{j+1} - u_{j-1}}{2\\,\\Delta x} = 0$$\nTo perform a Fourier normal-mode analysis, we seek solutions of the form:\n$$u_j(t) = \\hat{u}(k) \\exp\\left[i(kx_j - \\omega t)\\right]$$\nwhere $k$ is the wavenumber in radians per meter, $\\omega$ is the angular frequency, and $\\hat{u}(k)$ is the constant amplitude of the mode. Substituting $x_j = j\\,\\Delta x$, the solution form is:\n$$u_j(t) = \\hat{u}(k) \\exp\\left[i(k j \\Delta x - \\omega t)\\right]$$\nWe can express the values at neighboring grid points as:\n$$u_{j+1}(t) = \\hat{u}(k) \\exp\\left[i(k(j+1)\\Delta x - \\omega t)\\right] = u_j(t) \\exp(i k \\Delta x)$$\n$$u_{j-1}(t) = \\hat{u}(k) \\exp\\left[i(k(j-1)\\Delta x - \\omega t)\\right] = u_j(t) \\exp(-i k \\Delta x)$$\nThe time derivative is:\n$$\\frac{d u_j}{dt} = -i\\omega \\, \\hat{u}(k) \\exp\\left[i(k j \\Delta x - \\omega t)\\right] = -i\\omega u_j(t)$$\nSubstituting these expressions into the semi-discrete equation gives:\n$$-i\\omega u_j + c\\,\\frac{u_j \\exp(i k \\Delta x) - u_j \\exp(-i k \\Delta x)}{2\\,\\Delta x} = 0$$\nFor a non-trivial solution, $u_j \\neq 0$, so we can divide by $u_j$:\n$$-i\\omega + \\frac{c}{2\\,\\Delta x} \\left[ \\exp(i k \\Delta x) - \\exp(-i k \\Delta x) \\right] = 0$$\nUsing Euler's identity, $\\sin(\\theta) = \\frac{\\exp(i\\theta) - \\exp(-i\\theta)}{2i}$, we can simplify the term in the brackets:\n$$\\exp(i k \\Delta x) - \\exp(-i k \\Delta x) = 2i \\sin(k \\Delta x)$$\nThe equation becomes:\n$$-i\\omega + \\frac{c}{2\\,\\Delta x} \\left[ 2i \\sin(k \\Delta x) \\right] = 0$$\n$$-i\\omega + i \\frac{c}{\\Delta x} \\sin(k \\Delta x) = 0$$\nSolving for $\\omega$ yields the discrete dispersion relation for the semi-discrete system:\n$$\\omega(k) = \\frac{c}{\\Delta x} \\sin(k \\Delta x)$$\nThe group velocity $v_g(k)$ is the derivative of the frequency $\\omega$ with respect to the wavenumber $k$:\n$$v_g(k) = \\frac{d\\omega}{dk}$$\nDifferentiating the dispersion relation with respect to $k$:\n$$v_g(k) = \\frac{d}{dk} \\left( \\frac{c}{\\Delta x} \\sin(k \\Delta x) \\right)$$\nUsing the chain rule, where the derivative of $\\sin(k \\Delta x)$ with respect to $k$ is $\\cos(k \\Delta x) \\cdot \\Delta x$:\n$$v_g(k) = \\frac{c}{\\Delta x} \\left[ \\cos(k \\Delta x) \\cdot \\Delta x \\right]$$\n$$v_g(k) = c \\cos(k \\Delta x)$$\nThe problem asks for the smallest positive wavenumber $k_c \\in (0, \\pi/\\Delta x)$ at which the group velocity $v_g(k)$ changes sign. A function changes sign at points where its value is zero (assuming it is continuous). We set $v_g(k) = 0$:\n$$c \\cos(k \\Delta x) = 0$$\nSince $c > 0$, this requires:\n$$\\cos(k \\Delta x) = 0$$\nThe general solution for this trigonometric equation is:\n$$k \\Delta x = \\frac{\\pi}{2} + n\\pi, \\quad \\text{for } n \\in \\mathbb{Z}$$\nSolving for $k$:\n$$k = \\frac{1}{\\Delta x} \\left( \\frac{\\pi}{2} + n\\pi \\right) = \\frac{\\pi}{\\Delta x} \\left(\\frac{1}{2} + n\\right)$$\nWe are looking for the smallest positive wavenumber, which corresponds to the smallest non-negative integer $n$ that yields $k>0$.\nFor $n=0$: $k = \\frac{\\pi}{2 \\Delta x}$. This is positive.\nFor $n=1$: $k = \\frac{3\\pi}{2 \\Delta x}$.\nFor $n=-1$: $k = -\\frac{\\pi}{2 \\Delta x}$.\nThe smallest positive solution is for $n=0$. We define this as $k_c$:\n$$k_c = \\frac{\\pi}{2 \\Delta x}$$\nWe must verify that this wavenumber lies in the specified interval $(0, \\pi/\\Delta x)$. Since $\\Delta x > 0$, it is clear that $0 < \\frac{\\pi}{2 \\Delta x} < \\frac{\\pi}{\\Delta x}$, which is equivalent to $0 < \\frac{1}{2} < 1$. Thus, $k_c$ is in the required interval.\nFurthermore, we must confirm that $v_g(k)$ changes sign at $k_c$.\nFor $0 < k < k_c$, we have $0 < k\\Delta x < \\frac{\\pi}{2}$. In this range, $\\cos(k\\Delta x) > 0$, so $v_g(k) = c\\cos(k\\Delta x) > 0$.\nFor $k > k_c$ (but smaller than the next root at $k = \\frac{3\\pi}{2\\Delta x}$), we have $\\frac{\\pi}{2} < k\\Delta x < \\frac{3\\pi}{2}$. In this range, $\\cos(k\\Delta x) < 0$, so $v_g(k) < 0$.\nThe group velocity changes from positive to negative at $k_c = \\frac{\\pi}{2 \\Delta x}$. Therefore, this is the correct value.\nThis wavenumber corresponds to a wavelength $\\lambda = \\frac{2\\pi}{k_c} = \\frac{2\\pi}{\\pi/(2\\Delta x)} = 4\\Delta x$. Waves shorter than $4\\Delta x$ propagate in the wrong direction, a phenomenon of numerical dispersion.\nThe final closed-form analytic expression for $k_c$ is $\\frac{\\pi}{2 \\Delta x}$.",
            "answer": "$$\\boxed{\\frac{\\pi}{2 \\Delta x}}$$"
        },
        {
            "introduction": "The interaction between spatial discretization and complex coordinate systems is a source of significant challenges in numerical modeling. This exercise explores a classic and critical example: the spurious pressure gradient force that arises in terrain-following coordinates. You will implement a diagnostic to quantify this error, providing a concrete understanding of how a formally consistent discretization can produce large, physically unrealistic accelerations over sloping terrain, a pitfall that has driven decades of research in model development .",
            "id": "4091154",
            "problem": "Consider a dry, hydrostatic, isothermal atmosphere in which the terrain height varies linearly in the horizontal direction. Let the gravitational acceleration be $g$, the specific gas constant for dry air be $R$, and the absolute temperature be $T$. Under hydrostatic balance with the Ideal Gas Law, the pressure as a function of geometric height satisfies $dp/dz = -\\rho g$ and $\\rho = p/(R T)$, leading to an exponential base-state pressure profile $p(z) = p_0 \\exp(-z/H)$ where $H = R T / g$ and $p_0$ is the pressure at $z = 0$.\n\nLet the terrain height be $h(x) = h_0 + s x$ where $s$ is a constant slope (in $\\mathrm{m\\,m^{-1}}$). Then the surface pressure is $p_s(x) = p_0 \\exp(-h(x)/H)$ and the top pressure is a constant $p_{\\mathrm{top}}$. Define the vertical coordinate $\\sigma$ (sigma) by $\\sigma = (p - p_{\\mathrm{top}})/(p_s(x) - p_{\\mathrm{top}})$ so that $p(\\sigma, x) = p_{\\mathrm{top}} + \\sigma \\big(p_s(x) - p_{\\mathrm{top}}\\big)$.\n\nIn a physically correct formulation, the horizontal pressure gradient force at constant geometric height $z$ is $-(1/\\rho)\\,\\partial p/\\partial x \\vert_z$. For the horizontally uniform base state above, $\\partial p/\\partial x \\vert_z = 0$, yielding zero horizontal acceleration. However, a naive discretization that evaluates horizontal pressure gradients at constant $\\sigma$ using nearest-neighbor finite differences can produce non-zero accelerations over sloping terrain, which are spurious with respect to the physically correct zero result.\n\nYou will implement the following discrete diagnostic at the column centered at $x=0$:\n- Use three columns located at $x=-\\Delta x$, $x=0$, and $x=+\\Delta x$.\n- For a given number of vertical layers $N$, define mid-layer sigma levels $\\sigma_k = (k - 0.5)/N$ for $k = 1, 2, \\ldots, N$.\n- For each $\\sigma_k$, compute $p(\\sigma_k, x)$ at $x=-\\Delta x$ and $x=+\\Delta x$ using $p(\\sigma, x) = p_{\\mathrm{top}} + \\sigma \\big(p_s(x) - p_{\\mathrm{top}}\\big)$ with $p_s(x) = p_0 \\exp\\!\\big(-h(x)/H\\big)$ and $h(x) = h_0 + s x$.\n- Approximate the horizontal pressure gradient at constant $\\sigma_k$ by the central difference\n$$\n\\left.\\frac{\\partial p}{\\partial x}\\right\\vert_{\\sigma_k} \\approx \\frac{p(\\sigma_k, +\\Delta x) - p(\\sigma_k, -\\Delta x)}{2\\,\\Delta x}.\n$$\n- Compute the density at the center column for each $\\sigma_k$ as $\\rho_k = p(\\sigma_k, 0)/(R T)$.\n- Compute the spurious horizontal acceleration at each mid-layer as\n$$\na_k = -\\frac{1}{\\rho_k}\\,\\left.\\frac{\\partial p}{\\partial x}\\right\\vert_{\\sigma_k}.\n$$\n\nYour task is to compute, for each test case, the root-mean-square of the spurious accelerations across all layers,\n$$\na_{\\mathrm{rms}} = \\sqrt{\\frac{1}{N}\\sum_{k=1}^{N} a_k^2},\n$$\nand report $a_{\\mathrm{rms}}$ in $\\mathrm{m\\,s^{-2}}$.\n\nUse the following constants:\n- $g = 9.81\\,\\mathrm{m\\,s^{-2}}$,\n- $R = 287\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$,\n- $T = 280\\,\\mathrm{K}$,\n- $p_0 = 100000\\,\\mathrm{Pa}$,\n- $p_{\\mathrm{top}} = 10000\\,\\mathrm{Pa}$,\n- $h_0 = 1500\\,\\mathrm{m}$.\n\nTest suite (each case specifies the grid spacing $\\Delta x$ in $\\mathrm{m}$, the slope $s$ in $\\mathrm{m\\,m^{-1}}$, and the number of vertical layers $N$ as an integer):\n- Case $1$: $\\Delta x = 1000\\,\\mathrm{m}$, $s = 0.05\\,\\mathrm{m\\,m^{-1}}$, $N = 30$.\n- Case $2$: $\\Delta x = 5000\\,\\mathrm{m}$, $s = 0.02\\,\\mathrm{m\\,m^{-1}}$, $N = 30$.\n- Case $3$: $\\Delta x = 250\\,\\mathrm{m}$, $s = 0.10\\,\\mathrm{m\\,m^{-1}}$, $N = 60$.\n- Case $4$: $\\Delta x = 1000\\,\\mathrm{m}$, $s = 0.10\\,\\mathrm{m\\,m^{-1}}$, $N = 10$.\n- Case $5$ (boundary): $\\Delta x = 1000\\,\\mathrm{m}$, $s = 0.00\\,\\mathrm{m\\,m^{-1}}$, $N = 30$.\n\nPhysical units requirement: Express each reported $a_{\\mathrm{rms}}$ in $\\mathrm{m\\,s^{-2}}$.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,r_3,r_4,r_5]$), where $r_i$ is the $\\mathrm{m\\,s^{-2}}$ value of $a_{\\mathrm{rms}}$ for Case $i$ in the order listed above.",
            "solution": "The problem is valid as it is scientifically grounded in the principles of atmospheric dynamics, well-posed with a clear and deterministic procedure for calculation, and objective in its formulation. It addresses a well-known issue in numerical modeling related to the pressure gradient force calculation in terrain-following coordinate systems.\n\nThe objective is to compute the root-mean-square ($a_{\\mathrm{rms}}$) of spurious horizontal accelerations that arise from a naive finite-difference approximation of the horizontal pressure gradient on a terrain-following sigma ($\\sigma$) coordinate system. The physical context is a dry, hydrostatic, isothermal atmosphere at rest, where the true horizontal acceleration should be zero. The non-zero result is a numerical artifact.\n\nThe calculation proceeds by implementing the discrete diagnostic procedure outlined in the problem statement for each test case.\n\nFirst, we establish the physical constants and derived parameters. The specific gas constant for dry air is $R = 287\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$, the absolute temperature is $T = 280\\,\\mathrm{K}$, and the gravitational acceleration is $g = 9.81\\,\\mathrm{m\\,s^{-2}}$. The atmospheric scale height, $H$, which characterizes the exponential decay of pressure with height, is calculated as:\n$$\nH = \\frac{R T}{g}\n$$\nThe base-state pressure at sea level ($z=0$) is $p_0 = 100000\\,\\mathrm{Pa}$, and the pressure at the model top is a constant $p_{\\mathrm{top}} = 10000\\,\\mathrm{Pa}$.\n\nThe terrain height, $h(x)$, varies linearly with the horizontal coordinate $x$:\n$$\nh(x) = h_0 + s x\n$$\nwhere $h_0 = 1500\\,\\mathrm{m}$ is the terrain height at $x=0$ and $s$ is the slope. The surface pressure, $p_s(x)$, is the pressure from the base-state profile evaluated at the terrain surface $z=h(x)$:\n$$\np_s(x) = p_0 \\exp\\left(-\\frac{h(x)}{H}\\right)\n$$\n\nThe vertical coordinate is the terrain-following sigma coordinate, defined as:\n$$\n\\sigma = \\frac{p - p_{\\mathrm{top}}}{p_s(x) - p_{\\mathrm{top}}}\n$$\nThis normalizes the pressure in each column, such that $\\sigma=0$ at the model top ($p=p_{\\mathrm{top}}$) and $\\sigma=1$ at the surface ($p=p_s(x)$). We can express the pressure $p$ as a function of $\\sigma$ and $x$:\n$$\np(\\sigma, x) = p_{\\mathrm{top}} + \\sigma \\big(p_s(x) - p_{\\mathrm{top}}\\big)\n$$\n\nThe numerical grid consists of three columns at horizontal positions $x = -\\Delta x$, $x=0$, and $x = +\\Delta x$. The vertical grid has $N$ layers, and we perform calculations at the mid-layer sigma levels, $\\sigma_k$:\n$$\n\\sigma_k = \\frac{k - 0.5}{N} \\quad \\text{for } k = 1, 2, \\ldots, N\n$$\n\nThe core of the problem is to compute the spurious acceleration, $a_k$, at each level $\\sigma_k$ in the central column ($x=0$). This acceleration arises from approximating the horizontal pressure gradient at a constant $\\sigma_k$ level, which does not correspond to a constant geometric height $z$ when the terrain is sloped ($s \\neq 0$).\n\nThe horizontal pressure gradient at each level $\\sigma_k$ is approximated using a second-order central finite difference:\n$$\n\\left.\\frac{\\partial p}{\\partial x}\\right\\vert_{\\sigma_k} \\approx \\frac{p(\\sigma_k, +\\Delta x) - p(\\sigma_k, -\\Delta x)}{2\\,\\Delta x}\n$$\nSubstituting the expression for $p(\\sigma, x)$, this becomes:\n$$\n\\left.\\frac{\\partial p}{\\partial x}\\right\\vert_{\\sigma_k} \\approx \\frac{\\left(p_{\\mathrm{top}} + \\sigma_k (p_s(+\\Delta x) - p_{\\mathrm{top}})\\right) - \\left(p_{\\mathrm{top}} + \\sigma_k (p_s(-\\Delta x) - p_{\\mathrm{top}})\\right)}{2\\,\\Delta x} = \\sigma_k \\frac{p_s(+\\Delta x) - p_s(-\\Delta x)}{2\\,\\Delta x}\n$$\n\nThe density, $\\rho_k$, at each level $\\sigma_k$ in the central column is determined from the Ideal Gas Law, $\\rho = p/(RT)$:\n$$\n\\rho_k = \\frac{p(\\sigma_k, 0)}{R T}\n$$\n\nThe spurious horizontal acceleration, $a_k$, is then computed from the horizontal pressure gradient force term:\n$$\na_k = -\\frac{1}{\\rho_k}\\,\\left.\\frac{\\partial p}{\\partial x}\\right\\vert_{\\sigma_k}\n$$\n\nFinally, for each test case, we compute the root-mean-square of these spurious accelerations over all $N$ layers to obtain a single metric for the numerical error:\n$$\na_{\\mathrm{rms}} = \\sqrt{\\frac{1}{N}\\sum_{k=1}^{N} a_k^2}\n$$\n\nThis procedure is systematically applied to each test case specified by the parameters ($\\Delta x$, $s$, $N$). For the case where $s=0$, the terrain is flat, so $h(x)$ and consequently $p_s(x)$ are constant. This makes the numerator of the pressure gradient term zero, leading to $a_k = 0$ for all $k$ and thus $a_{\\mathrm{rms}} = 0$, as expected physically and numerically.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the root-mean-square of spurious horizontal accelerations\n    arising from a finite-difference pressure gradient calculation on a\n    sigma-coordinate grid over sloping terrain.\n    \"\"\"\n\n    # Define the physical constants.\n    g = 9.81  # Gravitational acceleration in m/s^2\n    R = 287.0  # Specific gas constant for dry air in J/(kg*K)\n    T = 280.0  # Isothermal temperature in K\n    p0 = 100000.0  # Pressure at z=0 in Pa\n    p_top = 10000.0  # Pressure at the model top in Pa\n    h0 = 1500.0  # Terrain height at x=0 in m\n\n    # Define the test cases.\n    # Each case is a tuple: (delta_x in m, slope s in m/m, N layers)\n    test_cases = [\n        (1000.0, 0.05, 30),\n        (5000.0, 0.02, 30),\n        (250.0, 0.10, 60),\n        (1000.0, 0.10, 10),\n        (1000.0, 0.00, 30),\n    ]\n\n    results = []\n\n    # Calculate constant parameters\n    H = R * T / g  # Scale height in m\n    RT = R * T\n\n    for dx, s, N in test_cases:\n        # For the s=0 case, the result is analytically 0.\n        if s == 0.0:\n            results.append(0.0)\n            continue\n\n        # 1. Define grid and coordinates\n        x_L, x_C, x_R = -dx, 0.0, dx\n        \n        # Mid-layer sigma levels\n        sigma_k = (np.arange(1, N + 1) - 0.5) / N\n\n        # 2. Compute terrain height and surface pressures\n        h_L = h0 + s * x_L\n        h_C = h0 + s * x_C\n        h_R = h0 + s * x_R\n\n        ps_L = p0 * np.exp(-h_L / H)\n        ps_C = p0 * np.exp(-h_C / H)\n        ps_R = p0 * np.exp(-h_R / H)\n\n        # 3. Compute pressure at all levels and locations\n        # Using numpy broadcasting for efficiency\n        p_L_k = p_top + sigma_k * (ps_L - p_top)\n        p_C_k = p_top + sigma_k * (ps_C - p_top)\n        p_R_k = p_top + sigma_k * (ps_R - p_top)\n        \n        # 4. Approximate horizontal pressure gradient at constant sigma\n        dp_dx_k = (p_R_k - p_L_k) / (2 * dx)\n\n        # 5. Compute density at the center column for each level\n        rho_k = p_C_k / RT\n\n        # 6. Compute the spurious horizontal acceleration at each level\n        a_k = - (1 / rho_k) * dp_dx_k\n\n        # 7. Compute the root-mean-square of the spurious accelerations\n        a_rms = np.sqrt(np.mean(a_k**2))\n        \n        results.append(a_rms)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}