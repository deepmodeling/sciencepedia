{
    "hands_on_practices": [
        {
            "introduction": "在构建复杂的大气模型之前，我们必须首先理解其数值构建块的基本属性。平流过程是大气运动的核心，而对其进行离散是数值天气预报中最基本的挑战之一。此练习通过傅里叶分析，揭示了一个简单的中心差分格式如何扭曲波的传播，导致一种称为“数值频散”的非物理现象，甚至可能使波向错误的方向传播。 掌握这种分析方法对于评估和选择任何平流方案的性能至关重要。",
            "id": "4091169",
            "problem": "考虑与数值天气预报 (NWP) 和气候模拟相关的一维被动示踪剂平流问题，该问题由线性平流方程 $u_{t} + c\\,u_{x} = 0$ 控制，其中 $u(x,t)$ 是示踪剂浓度，$c0$ 是一个恒定的纬向风速。设空间在均匀网格 $x_{j} = j\\,\\Delta x$ 上离散化，网格间距为 $\\Delta x0$。通过在该网格上用二阶中心有限差分替换空间导数 $u_{x}$，同时保持时间连续，来定义半离散模型。对得到的半离散系统进行傅里叶标准模态分析，推导出离散色散关系 $\\,\\omega(k)\\,$ 作为连续波数 $k$（单位为弧度/米）的函数，并由此求得群速度 $v_{g}(k) = \\frac{d\\omega}{dk}$。利用此分析，将 $k_{c} \\in (0,\\pi/\\Delta x)$ 定义为群速度改变符号的最小正波数。确定 $k_{c}$ 作为一个以 $\\Delta x$ 表示的闭式解析表达式。所有三角函数参数均使用弧度，并将 $k_{c}$ 的最终答案以弧度/米为单位表示。无需四舍五入。",
            "solution": "问题陈述经确认为有效，因其具有科学依据、提法恰当且客观。它代表了对一个基本偏微分方程数值方法的标准分析。我们开始求解。\n\n一维线性平流方程为：\n$$u_{t} + c\\,u_{x} = 0$$\n其中 $u(x,t)$ 是示踪剂浓度，$c0$ 是一个恒定的平流速度。\n\n空间域在均匀网格 $x_{j} = j\\,\\Delta x$ 上离散化，其中 $j$ 是一个整数索引，$\\Delta x$ 是恒定的网格间距。通过在网格点 $x_j$ 使用二阶中心有限差分来近似空间导数 $u_{x}$，得到时间上连续、空间上离散（半离散）的格式。令 $u_j(t)$ 表示 $u(x_j, t)$ 的近似值。该近似为：\n$$\\left.\\frac{\\partial u}{\\partial x}\\right|_{x=x_j} \\approx \\frac{u(x_{j+1},t) - u(x_{j-1},t)}{2\\,\\Delta x} = \\frac{u_{j+1}(t) - u_{j-1}(t)}{2\\,\\Delta x}$$\n将此代入控制方程，得到半离散常微分方程组：\n$$\\frac{d u_j}{dt} + c\\,\\frac{u_{j+1} - u_{j-1}}{2\\,\\Delta x} = 0$$\n为了进行傅里叶标准模态分析，我们寻找以下形式的解：\n$$u_j(t) = \\hat{u}(k) \\exp\\left[i(kx_j - \\omega t)\\right]$$\n其中 $k$ 是波数，单位为弧度/米，$\\omega$ 是角频率，$\\hat{u}(k)$ 是该模态的恒定振幅。代入 $x_j = j\\,\\Delta x$，解的形式为：\n$$u_j(t) = \\hat{u}(k) \\exp\\left[i(k j \\Delta x - \\omega t)\\right]$$\n我们可以将相邻网格点上的值表示为：\n$$u_{j+1}(t) = \\hat{u}(k) \\exp\\left[i(k(j+1)\\Delta x - \\omega t)\\right] = u_j(t) \\exp(i k \\Delta x)$$\n$$u_{j-1}(t) = \\hat{u}(k) \\exp\\left[i(k(j-1)\\Delta x - \\omega t)\\right] = u_j(t) \\exp(-i k \\Delta x)$$\n时间导数为：\n$$\\frac{d u_j}{dt} = -i\\omega \\, \\hat{u}(k) \\exp\\left[i(k j \\Delta x - \\omega t)\\right] = -i\\omega u_j(t)$$\n将这些表达式代入半离散方程，得到：\n$$-i\\omega u_j + c\\,\\frac{u_j \\exp(i k \\Delta x) - u_j \\exp(-i k \\Delta x)}{2\\,\\Delta x} = 0$$\n对于非平凡解，$u_j \\neq 0$，因此我们可以两边同除以 $u_j$：\n$$-i\\omega + \\frac{c}{2\\,\\Delta x} \\left[ \\exp(i k \\Delta x) - \\exp(-i k \\Delta x) \\right] = 0$$\n使用欧拉公式 $\\sin(\\theta) = \\frac{\\exp(i\\theta) - \\exp(-i\\theta)}{2i}$，我们可以简化方括号中的项：\n$$\\exp(i k \\Delta x) - \\exp(-i k \\Delta x) = 2i \\sin(k \\Delta x)$$\n方程变为：\n$$-i\\omega + \\frac{c}{2\\,\\Delta x} \\left[ 2i \\sin(k \\Delta x) \\right] = 0$$\n$$-i\\omega + i \\frac{c}{\\Delta x} \\sin(k \\Delta x) = 0$$\n解出 $\\omega$ 即可得到半离散系统的离散色散关系：\n$$\\omega(k) = \\frac{c}{\\Delta x} \\sin(k \\Delta x)$$\n群速度 $v_g(k)$ 是频率 $\\omega$ 关于波数 $k$ 的导数：\n$$v_g(k) = \\frac{d\\omega}{dk}$$\n对色散关系关于 $k$ 求导：\n$$v_g(k) = \\frac{d}{dk} \\left( \\frac{c}{\\Delta x} \\sin(k \\Delta x) \\right)$$\n使用链式法则，其中 $\\sin(k \\Delta x)$ 关于 $k$ 的导数是 $\\cos(k \\Delta x) \\cdot \\Delta x$：\n$$v_g(k) = \\frac{c}{\\Delta x} \\left[ \\cos(k \\Delta x) \\cdot \\Delta x \\right]$$\n$$v_g(k) = c \\cos(k \\Delta x)$$\n问题要求的是群速度 $v_g(k)$ 改变符号的最小正波数 $k_c \\in (0, \\pi/\\Delta x)$。一个函数（假设其连续）在值为零的点改变符号。我们令 $v_g(k) = 0$：\n$$c \\cos(k \\Delta x) = 0$$\n由于 $c  0$，这要求：\n$$\\cos(k \\Delta x) = 0$$\n这个三角方程的通解是：\n$$k \\Delta x = \\frac{\\pi}{2} + n\\pi, \\quad \\text{for } n \\in \\mathbb{Z}$$\n解出 $k$：\n$$k = \\frac{1}{\\Delta x} \\left( \\frac{\\pi}{2} + n\\pi \\right) = \\frac{\\pi}{\\Delta x} \\left(\\frac{1}{2} + n\\right)$$\n我们正在寻找最小的正波数，这对应于能使 $k0$ 的最小非负整数 $n$。\n当 $n=0$ 时：$k = \\frac{\\pi}{2 \\Delta x}$。这是正数。\n当 $n=1$ 时：$k = \\frac{3\\pi}{2 \\Delta x}$。\n当 $n=-1$ 时：$k = -\\frac{\\pi}{2 \\Delta x}$。\n最小正解对应于 $n=0$。我们将其定义为 $k_c$：\n$$k_c = \\frac{\\pi}{2 \\Delta x}$$\n我们必须验证该波数位于指定区间 $(0, \\pi/\\Delta x)$ 内。由于 $\\Delta x  0$，显然有 $0  \\frac{\\pi}{2 \\Delta x}  \\frac{\\pi}{\\Delta x}$，这等价于 $0  \\frac{1}{2}  1$。因此，$k_c$ 在所要求的区间内。\n此外，我们必须确认 $v_g(k)$ 在 $k_c$ 处改变符号。\n对于 $0  k  k_c$，我们有 $0  k\\Delta x  \\frac{\\pi}{2}$。在此范围内，$\\cos(k\\Delta x)  0$，所以 $v_g(k) = c\\cos(k\\Delta x)  0$。\n对于 $k  k_c$（但小于下一个根 $k = \\frac{3\\pi}{2\\Delta x}$），我们有 $\\frac{\\pi}{2}  k\\Delta x  \\frac{3\\pi}{2}$。在此范围内，$\\cos(k\\Delta x)  0$，所以 $v_g(k)  0$。\n群速度在 $k_c = \\frac{\\pi}{2 \\Delta x}$ 处从正变为负。因此，这是正确的值。\n该波数对应的波长为 $\\lambda = \\frac{2\\pi}{k_c} = \\frac{2\\pi}{\\pi/(2\\Delta x)} = 4\\Delta x$。短于 $4\\Delta x$ 的波会向错误的方向传播，这是一种数值色散现象。\n$k_c$ 的最终闭式解析表达式为 $\\frac{\\pi}{2 \\Delta x}$。",
            "answer": "$$\\boxed{\\frac{\\pi}{2 \\Delta x}}$$"
        },
        {
            "introduction": "将数值方案从理想化的笛卡尔坐标系推广到真实的地球球面是建模过程中的关键一步。在曲面上，像梯度这样的微分算子必须考虑到底层几何形状的影响，这通过引入“度规因子”来实现。此练习要求您在标准的经纬度网格上推导标量场水平梯度的离散形式，从而直接处理因地球曲率而产生的度规项。 正确处理这些几何效应是确保全球模型计算准确性的基础。",
            "id": "4091166",
            "problem": "考虑一个用于数值天气预报和气候模拟的球形地球的全球经纬度离散化，地球的平均半径用 $a$ 表示。计算网格定义在角坐标 $(\\lambda,\\phi)$ 上，其中 $\\lambda$ 是经度，$\\phi$ 是纬度，两者都以弧度为单位。该网格是均匀间隔的，经度方向的角步长为 $\\Delta \\lambda$，纬度方向的角步长为 $\\Delta \\phi$。设一个标量场 $q(\\lambda,\\phi)$ 在网格点 $(\\lambda_i,\\phi_j)$ 上采样，并将其离散值表示为 $q_{i,j} = q(\\lambda_i,\\phi_j)$。假设 $(\\lambda_i,\\phi_j)$ 是一个不位于极点的内部点（因此 $\\cos\\phi_j \\neq 0$）。\n\n从地球的球面几何形状和正交曲线坐标中梯度的定义出发，推导在 $(\\lambda_i,\\phi_j)$ 点处 $q$ 的水平梯度的二阶精确离散近似，该近似应能恰当地考虑球面度规。你的推导应基于球面上的线元，\n$$\n\\mathrm{d}\\ell^{2} = a^{2}\\cos^{2}\\phi\\,\\mathrm{d}\\lambda^{2} + a^{2}\\,\\mathrm{d}\\phi^{2},\n$$\n以及根据沿正交坐标线的方向导数定义的梯度。使用中心差分来近似在 $(\\lambda_i,\\phi_j)$ 点处 $q$ 的必要偏导数。\n\n将你的最终答案表示为一个双分量行向量，分别给出在 $(\\lambda_i,\\phi_j)$ 点处离散梯度的东向（沿 $\\lambda$ 增加方向）和北向（沿 $\\phi$ 增加方向）分量，仅用 $a$、$\\phi_j$、$\\Delta \\lambda$、$\\Delta \\phi$ 和 $q$ 的相邻网格值表示。角度量使用弧度，$a$ 使用米，这样梯度的分量单位就是标量/米。最终答案必须是如上所述的单一闭式解析表达式。不需要四舍五入。",
            "solution": "该问题是有效的。它在科学上基于微分几何和数值分析，信息充分，问题明确，且陈述客观。我们将着手推导解答。\n\n表面上标量场 $q$ 的水平梯度是一个矢量场，指向 $q$ 增长最快的方向，其大小等于这个变化率。对于一个正交曲线坐标系 $(u_1, u_2)$，梯度由下式给出：\n$$\n\\nabla q = \\frac{1}{h_1} \\frac{\\partial q}{\\partial u_1} \\hat{\\mathbf{e}}_1 + \\frac{1}{h_2} \\frac{\\partial q}{\\partial u_2} \\hat{\\mathbf{e}}_2\n$$\n其中 $\\hat{\\mathbf{e}}_1$ 和 $\\hat{\\mathbf{e}}_2$ 分别是沿 $u_1$ 和 $u_2$ 增加方向的单位向量，而 $h_1$ 和 $h_2$ 是度规尺度因子。尺度因子由微分线元 $\\mathrm{d}\\ell$ 定义，使得两个无穷小距离点之间的距离平方为 $\\mathrm{d}\\ell^2 = (h_1 \\mathrm{d}u_1)^2 + (h_2 \\mathrm{d}u_2)^2$。\n\n问题给出了半径为 $a$ 的球面上使用经度 $\\lambda$ 和纬度 $\\phi$ 作为坐标的线元：\n$$\n\\mathrm{d}\\ell^2 = a^2 \\cos^2\\phi \\, \\mathrm{d}\\lambda^2 + a^2 \\, \\mathrm{d}\\phi^2\n$$\n这里，我们的坐标是 $u_1 = \\lambda$ 和 $u_2 = \\phi$。通过将其与线元的一般形式进行比较，我们可以确定尺度因子。东向对应于 $\\lambda$ 的增加，北向对应于 $\\phi$ 的增加。\n\n对应于经向位移的项是 $(h_\\lambda \\mathrm{d}\\lambda)^2 = a^2 \\cos^2\\phi \\, \\mathrm{d}\\lambda^2$。这给出了经度坐标的尺度因子为：\n$$\nh_\\lambda = a \\cos\\phi\n$$\n对应于纬向位移的项是 $(h_\\phi \\mathrm{d}\\phi)^2 = a^2 \\, \\mathrm{d}\\phi^2$。这给出了纬度坐标的尺度因子为：\n$$\nh_\\phi = a\n$$\n这些尺度因子将角坐标的变化 $(\\mathrm{d}\\lambda, \\mathrm{d}\\phi)$ 与球体表面上的物理距离联系起来。东向的微分位移是 $\\mathrm{d}x = h_\\lambda \\mathrm{d}\\lambda = a \\cos\\phi \\, \\mathrm{d}\\lambda$，北向的微分位移是 $\\mathrm{d}y = h_\\phi \\mathrm{d}\\phi = a \\, \\mathrm{d}\\phi$。\n\n将这些坐标和尺度因子代入一般的梯度公式，我们得到球面上水平梯度的表达式：\n$$\n\\nabla q = \\frac{1}{h_\\lambda} \\frac{\\partial q}{\\partial \\lambda} \\hat{\\mathbf{e}}_\\lambda + \\frac{1}{h_\\phi} \\frac{\\partial q}{\\partial \\phi} \\hat{\\mathbf{e}}_\\phi = \\frac{1}{a \\cos\\phi} \\frac{\\partial q}{\\partial \\lambda} \\hat{\\mathbf{e}}_\\lambda + \\frac{1}{a} \\frac{\\partial q}{\\partial \\phi} \\hat{\\mathbf{e}}_\\phi\n$$\n其中 $\\hat{\\mathbf{e}}_\\lambda$ 是指向东方的单位向量，$\\hat{\\mathbf{e}}_\\phi$ 是指向北方的单位向量。梯度向量的两个分量是东向分量 $(\\nabla q)_\\lambda$ 和北向分量 $(\\nabla q)_\\phi$：\n$$\n(\\nabla q)_\\lambda = \\frac{1}{a \\cos\\phi} \\frac{\\partial q}{\\partial \\lambda}\n$$\n$$\n(\\nabla q)_\\phi = \\frac{1}{a} \\frac{\\partial q}{\\partial \\phi}\n$$\n根据要求，这些分量的单位是标量 $q$ 每单位距离（米）。\n\n下一步是在网格点 $(\\lambda_i, \\phi_j)$ 处，使用二阶精确的有限差分格式来近似偏导数 $\\frac{\\partial q}{\\partial \\lambda}$ 和 $\\frac{\\partial q}{\\partial \\phi}$。问题指定使用中心差分。函数 $f(x)$ 在 $x_i$ 点的一阶导数的中心差分近似由 $\\frac{f(x_i+\\Delta x) - f(x_i-\\Delta x)}{2\\Delta x}$ 给出，该近似在 $\\Delta x$ 上是二阶精确的。\n\n对于在 $(\\lambda_i, \\phi_j)$ 点处关于经度 $\\lambda$ 的偏导数，我们使用东西方向上相邻网格点 $(\\lambda_{i+1}, \\phi_j)$ 和 $(\\lambda_{i-1}, \\phi_j)$ 处的 $q$ 值。这里，$\\lambda_{i+1} = \\lambda_i + \\Delta\\lambda$ 且 $\\lambda_{i-1} = \\lambda_i - \\Delta\\lambda$。离散值为 $q_{i+1,j}$ 和 $q_{i-1,j}$。中心差分近似为：\n$$\n\\frac{\\partial q}{\\partial \\lambda}\\bigg|_{i,j} \\approx \\frac{q(\\lambda_i+\\Delta\\lambda, \\phi_j) - q(\\lambda_i-\\Delta\\lambda, \\phi_j)}{2\\Delta\\lambda} = \\frac{q_{i+1,j} - q_{i-1,j}}{2\\Delta\\lambda}\n$$\n类似地，对于在 $(\\lambda_i, \\phi_j)$ 点处关于纬度 $\\phi$ 的偏导数，我们使用南北方向上相邻网格点 $(\\lambda_i, \\phi_{j+1})$ 和 $(\\lambda_i, \\phi_{j-1})$ 处的 $q$ 值。这里，$\\phi_{j+1} = \\phi_j + \\Delta\\phi$ 且 $\\phi_{j-1} = \\phi_j - \\Delta\\phi$。离散值为 $q_{i,j+1}$ 和 $q_{i,j-1}$。中心差分近似为：\n$$\n\\frac{\\partial q}{\\partial \\phi}\\bigg|_{i,j} \\approx \\frac{q(\\lambda_i, \\phi_j+\\Delta\\phi) - q(\\lambda_i, \\phi_j-\\Delta\\phi)}{2\\Delta\\phi} = \\frac{q_{i,j+1} - q_{i,j-1}}{2\\Delta\\phi}\n$$\n现在，我们将这些离散近似代入梯度分量的表达式中，并在纬度 $\\phi_j$ 处计算尺度因子。问题陈述中提到 $\\cos\\phi_j \\neq 0$，这确保了经向尺度因子是良定义的。\n\n在 $(\\lambda_i, \\phi_j)$ 点处离散梯度的东向分量是：\n$$\n(\\nabla_h q)_{i,j, \\lambda} = \\frac{1}{a \\cos\\phi_j} \\left( \\frac{q_{i+1,j} - q_{i-1,j}}{2\\Delta\\lambda} \\right) = \\frac{q_{i+1,j} - q_{i-1,j}}{2a \\Delta\\lambda \\cos\\phi_j}\n$$\n在 $(\\lambda_i, \\phi_j)$ 点处离散梯度的北向分量是：\n$$\n(\\nabla_h q)_{i,j, \\phi} = \\frac{1}{a} \\left( \\frac{q_{i,j+1} - q_{i,j-1}}{2\\Delta\\phi} \\right) = \\frac{q_{i,j+1} - q_{i,j-1}}{2a \\Delta\\phi}\n$$\n问题要求将结果表示为一个代表离散水平梯度 $(\\nabla_h q)_{i,j}$ 的双分量行向量。组合这两个分量即可得到最终表达式。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{q_{i+1,j} - q_{i-1,j}}{2a \\Delta\\lambda \\cos\\phi_j}  \\quad  \\frac{q_{i,j+1} - q_{i,j-1}}{2a \\Delta\\phi}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "真实的大气模型不仅要处理球面几何，还必须应对复杂地形。地形追随坐标（如 $\\sigma$ 坐标）是处理此问题的常用方法，但这引入了新的数值挑战。此练习通过一个实践性的编码任务，模拟和量化了数值天气预报中一个典型且至关重要的误差来源：在地形追随坐标系中，对水平气压梯度力的朴素离散会产生虚假的、非物理性的加速度。 这个问题揭示了为何在复杂坐标系中进行离散需要特别精巧的设计，以避免产生破坏性的计算噪音。",
            "id": "4091154",
            "problem": "考虑一个干燥、静力平衡的等温大气，其中地形高度在水平方向上呈线性变化。设重力加速度为 $g$，干空气的比气体常数为 $R$，绝对温度为 $T$。在静力平衡和理想气体定律下，压力作为几何高度的函数满足 $dp/dz = -\\rho g$ 和 $\\rho = p/(R T)$，这导出一个指数形式的基态气压廓线 $p(z) = p_0 \\exp(-z/H)$，其中 $H = R T / g$，$p_0$ 是 $z = 0$ 处的气压。\n\n设地形高度为 $h(x) = h_0 + s x$，其中 $s$ 是一个恒定的坡度（单位为 $\\mathrm{m\\,m^{-1}}$）。那么地表气压为 $p_s(x) = p_0 \\exp(-h(x)/H)$，顶部气压为一个常数 $p_{\\mathrm{top}}$。定义垂直坐标 $\\sigma$ (sigma) 为 $\\sigma = (p - p_{\\mathrm{top}})/(p_s(x) - p_{\\mathrm{top}})$，因此 $p(\\sigma, x) = p_{\\mathrm{top}} + \\sigma \\big(p_s(x) - p_{\\mathrm{top}}\\big)$。\n\n在一个物理上正确的表述中，恒定几何高度 $z$ 上的水平气压梯度力为 $-(1/\\rho)\\,\\partial p/\\partial x \\vert_z$。对于上述水平均匀的基态，$\\partial p/\\partial x \\vert_z = 0$，产生零水平加速度。然而，一种使用最近邻有限差分在恒定 $\\sigma$ 面上计算水平气压梯度的朴素离散化方法，在倾斜地形上会产生非零加速度，这相对于物理上正确的零结果是虚假的。\n\n您将需要在以 $x=0$ 为中心的列上实现以下离散诊断：\n- 使用位于 $x=-\\Delta x$、$x=0$ 和 $x=+\\Delta x$ 的三列。\n- 对于给定的垂直层数 $N$，定义层中 sigma 水平 $\\sigma_k = (k - 0.5)/N$，其中 $k = 1, 2, \\ldots, N$。\n- 对于每个 $\\sigma_k$，使用 $p(\\sigma, x) = p_{\\mathrm{top}} + \\sigma \\big(p_s(x) - p_{\\mathrm{top}}\\big)$ 以及 $p_s(x) = p_0 \\exp\\!\\big(-h(x)/H\\big)$ 和 $h(x) = h_0 + s x$ 来计算在 $x=-\\Delta x$ 和 $x=+\\Delta x$ 处的 $p(\\sigma_k, x)$。\n- 通过中心差分近似恒定 $\\sigma_k$ 上的水平气压梯度\n$$\n\\left.\\frac{\\partial p}{\\partial x}\\right\\vert_{\\sigma_k} \\approx \\frac{p(\\sigma_k, +\\Delta x) - p(\\sigma_k, -\\Delta x)}{2\\,\\Delta x}.\n$$\n- 将中心列每个 $\\sigma_k$ 处的密度计算为 $\\rho_k = p(\\sigma_k, 0)/(R T)$。\n- 将每个层中的虚假水平加速度计算为\n$$\na_k = -\\frac{1}{\\rho_k}\\,\\left.\\frac{\\partial p}{\\partial x}\\right\\vert_{\\sigma_k}.\n$$\n\n您的任务是为每个测试用例计算所有层上虚假加速度的均方根值，\n$$\na_{\\mathrm{rms}} = \\sqrt{\\frac{1}{N}\\sum_{k=1}^{N} a_k^2},\n$$\n并以 $\\mathrm{m\\,s^{-2}}$ 为单位报告 $a_{\\mathrm{rms}}$。\n\n使用以下常量：\n- $g = 9.81\\,\\mathrm{m\\,s^{-2}}$，\n- $R = 287\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$，\n- $T = 280\\,\\mathrm{K}$，\n- $p_0 = 100000\\,\\mathrm{Pa}$，\n- $p_{\\mathrm{top}} = 10000\\,\\mathrm{Pa}$，\n- $h_0 = 1500\\,\\mathrm{m}$。\n\n测试套件（每个用例指定网格间距 $\\Delta x$（单位为 $\\mathrm{m}$）、坡度 $s$（单位为 $\\mathrm{m\\,m^{-1}}$）和垂直层数 $N$（整数））：\n- 用例 1：$\\Delta x = 1000\\,\\mathrm{m}$，$s = 0.05\\,\\mathrm{m\\,m^{-1}}$，$N = 30$。\n- 用例 2：$\\Delta x = 5000\\,\\mathrm{m}$，$s = 0.02\\,\\mathrm{m\\,m^{-1}}$，$N = 30$。\n- 用例 3：$\\Delta x = 250\\,\\mathrm{m}$，$s = 0.10\\,\\mathrm{m\\,m^{-1}}$，$N = 60$。\n- 用例 4：$\\Delta x = 1000\\,\\mathrm{m}$，$s = 0.10\\,\\mathrm{m\\,m^{-1}}$，$N = 10$。\n- 用例 5（边界）：$\\Delta x = 1000\\,\\mathrm{m}$，$s = 0.00\\,\\mathrm{m\\,m^{-1}}$，$N = 30$。\n\n物理单位要求：将每个报告的 $a_{\\mathrm{rms}}$ 以 $\\mathrm{m\\,s^{-2}}$ 为单位表示。\n\n最终输出格式：您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，$[r_1,r_2,r_3,r_4,r_5]$），其中 $r_i$ 是用例 $i$ 的 $a_{\\mathrm{rms}}$ 值（单位为 $\\mathrm{m\\,s^{-2}}$），顺序与上面列出的一致。",
            "solution": "该问题是有效的，因为它科学地基于大气动力学原理，具有清晰且确定性的计算过程，是一个适定问题，并且其表述是客观的。它探讨了数值模拟中一个与地形追随坐标系中气压梯度力计算相关的著名问题。\n\n目标是计算由地形追随 sigma ($\\sigma$) 坐标系上水平气压梯度的朴素有限差分近似所产生的虚假水平加速度的均方根 ($a_{\\mathrm{rms}}$)。物理背景是一个静止的干燥、静力平衡、等温大气，其中真实的水平加速度应为零。非零结果是一种计算伪影。\n\n计算过程通过为每个测试用例实现问题陈述中概述的离散诊断程序来进行。\n\n首先，我们确定物理常数和派生参数。干空气的比气体常数为 $R = 287\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$，绝对温度为 $T = 280\\,\\mathrm{K}$，重力加速度为 $g = 9.81\\,\\mathrm{m\\,s^{-2}}$。大气标高 $H$ 表征了压力随高度的指数衰减，其计算公式为：\n$$\nH = \\frac{R T}{g}\n$$\n海平面（$z=0$）的基态气压为 $p_0 = 100000\\,\\mathrm{Pa}$，模式顶部的气压是一个常数 $p_{\\mathrm{top}} = 10000\\,\\mathrm{Pa}$。\n\n地形高度 $h(x)$ 随水平坐标 $x$ 线性变化：\n$$\nh(x) = h_0 + s x\n$$\n其中 $h_0 = 1500\\,\\mathrm{m}$ 是 $x=0$ 处的地形高度，$s$ 是坡度。地表气压 $p_s(x)$ 是在地形表面 $z=h(x)$ 处评估的基态廓线气压：\n$$\np_s(x) = p_0 \\exp\\left(-\\frac{h(x)}{H}\\right)\n$$\n\n垂直坐标是地形追随 sigma 坐标，定义为：\n$$\n\\sigma = \\frac{p - p_{\\mathrm{top}}}{p_s(x) - p_{\\mathrm{top}}}\n$$\n这将每列中的压力进行归一化，使得在模式顶部（$p=p_{\\mathrm{top}}$）$\\sigma=0$，在地表（$p=p_s(x)$）$\\sigma=1$。我们可以将压力 $p$ 表示为 $\\sigma$ 和 $x$ 的函数：\n$$\np(\\sigma, x) = p_{\\mathrm{top}} + \\sigma \\big(p_s(x) - p_{\\mathrm{top}}\\big)\n$$\n\n数值网格由位于水平位置 $x = -\\Delta x$、$x=0$ 和 $x = +\\Delta x$ 的三列组成。垂直网格有 $N$ 层，我们在层中 sigma 水平 $\\sigma_k$ 上进行计算：\n$$\n\\sigma_k = \\frac{k - 0.5}{N} \\quad \\text{for } k = 1, 2, \\ldots, N\n$$\n\n问题的核心是计算中心列（$x=0$）中每个 $\\sigma_k$ 水平上的虚假加速度 $a_k$。当存在地形坡度（$s \\neq 0$）时，恒定的 $\\sigma_k$ 水平不对应于恒定的几何高度 $z$，这种加速度正是源于在此种水平上对水平气压梯度的近似。\n\n每个 $\\sigma_k$ 水平上的水平气压梯度使用二阶中心有限差分进行近似：\n$$\n\\left.\\frac{\\partial p}{\\partial x}\\right\\vert_{\\sigma_k} \\approx \\frac{p(\\sigma_k, +\\Delta x) - p(\\sigma_k, -\\Delta x)}{2\\,\\Delta x}\n$$\n代入 $p(\\sigma, x)$ 的表达式，得到：\n$$\n\\left.\\frac{\\partial p}{\\partial x}\\right\\vert_{\\sigma_k} \\approx \\frac{\\left(p_{\\mathrm{top}} + \\sigma_k (p_s(+\\Delta x) - p_{\\mathrm{top}})\\right) - \\left(p_{\\mathrm{top}} + \\sigma_k (p_s(-\\Delta x) - p_{\\mathrm{top}})\\right)}{2\\,\\Delta x} = \\sigma_k \\frac{p_s(+\\Delta x) - p_s(-\\Delta x)}{2\\,\\Delta x}\n$$\n\n中心列中每个 $\\sigma_k$ 水平上的密度 $\\rho_k$ 由理想气体定律 $\\rho = p/(RT)$ 确定：\n$$\n\\rho_k = \\frac{p(\\sigma_k, 0)}{R T}\n$$\n\n然后，虚假水平加速度 $a_k$ 从水平气压梯度力项计算得出：\n$$\na_k = -\\frac{1}{\\rho_k}\\,\\left.\\frac{\\partial p}{\\partial x}\\right\\vert_{\\sigma_k}\n$$\n\n最后，对于每个测试用例，我们计算所有 $N$ 个层上这些虚假加速度的均方根，以获得一个衡量数值误差的单一指标：\n$$\na_{\\mathrm{rms}} = \\sqrt{\\frac{1}{N}\\sum_{k=1}^{N} a_k^2}\n$$\n\n此过程被系统地应用于由参数（$\\Delta x$、$s$、$N$）指定的每个测试用例。对于 $s=0$ 的情况，地形是平坦的，因此 $h(x)$ 以及 $p_s(x)$ 是常数。这使得气压梯度项的分子为零，导致对所有 $k$ 都有 $a_k = 0$，因此 $a_{\\mathrm{rms}} = 0$，这与物理和数值上的预期相符。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the root-mean-square of spurious horizontal accelerations\n    arising from a finite-difference pressure gradient calculation on a\n    sigma-coordinate grid over sloping terrain.\n    \"\"\"\n\n    # Define the physical constants.\n    g = 9.81  # Gravitational acceleration in m/s^2\n    R = 287.0  # Specific gas constant for dry air in J/(kg*K)\n    T = 280.0  # Isothermal temperature in K\n    p0 = 100000.0  # Pressure at z=0 in Pa\n    p_top = 10000.0  # Pressure at the model top in Pa\n    h0 = 1500.0  # Terrain height at x=0 in m\n\n    # Define the test cases.\n    # Each case is a tuple: (delta_x in m, slope s in m/m, N layers)\n    test_cases = [\n        (1000.0, 0.05, 30),\n        (5000.0, 0.02, 30),\n        (250.0, 0.10, 60),\n        (1000.0, 0.10, 10),\n        (1000.0, 0.00, 30),\n    ]\n\n    results = []\n\n    # Calculate constant parameters\n    H = R * T / g  # Scale height in m\n    RT = R * T\n\n    for dx, s, N in test_cases:\n        # For the s=0 case, the result is analytically 0.\n        if s == 0.0:\n            results.append(0.0)\n            continue\n\n        # 1. Define grid and coordinates\n        x_L, x_C, x_R = -dx, 0.0, dx\n        \n        # Mid-layer sigma levels\n        sigma_k = (np.arange(1, N + 1) - 0.5) / N\n\n        # 2. Compute terrain height and surface pressures\n        h_L = h0 + s * x_L\n        h_C = h0 + s * x_C\n        h_R = h0 + s * x_R\n\n        ps_L = p0 * np.exp(-h_L / H)\n        ps_C = p0 * np.exp(-h_C / H)\n        ps_R = p0 * np.exp(-h_R / H)\n\n        # 3. Compute pressure at all levels and locations\n        # Using numpy broadcasting for efficiency\n        p_L_k = p_top + sigma_k * (ps_L - p_top)\n        p_C_k = p_top + sigma_k * (ps_C - p_top)\n        p_R_k = p_top + sigma_k * (ps_R - p_top)\n        \n        # 4. Approximate horizontal pressure gradient at constant sigma\n        dp_dx_k = (p_R_k - p_L_k) / (2 * dx)\n\n        # 5. Compute density at the center column for each level\n        rho_k = p_C_k / RT\n\n        # 6. Compute the spurious horizontal acceleration at each level\n        a_k = - (1 / rho_k) * dp_dx_k\n\n        # 7. Compute the root-mean-square of the spurious accelerations\n        a_rms = np.sqrt(np.mean(a_k**2))\n        \n        results.append(a_rms)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}