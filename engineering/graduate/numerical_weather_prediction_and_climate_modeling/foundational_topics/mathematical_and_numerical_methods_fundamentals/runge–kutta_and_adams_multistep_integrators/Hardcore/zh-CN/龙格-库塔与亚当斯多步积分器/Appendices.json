{
    "hands_on_practices": [
        {
            "introduction": "许多强大的数值方法都源于简单直观的思想。本练习将引导你从基本原理出发，通过多项式插值来推导 Adams-Moulton 和 Adams-Bashforth 方法的系数。通过这个练习，你将深入理解这些多步法是如何通过利用历史时间点上的信息来逼近解的积分形式的，从而为显式和隐式积分方案打下坚实的基础。",
            "id": "4084573",
            "problem": "在数值天气预报和气候模拟的预报标量半离散模型中，守恒律的空间离散化会产生一个形如 $\\frac{d y}{dt} = f(t, y)$ 的常微分方程，其中 $y$ 是网格点值的向量，$f$ 是一致离散化的趋势项。考虑大小为 $h  0$ 的均匀时间步长，时间层为 $t_n = t_0 + n h$，并记 $y_n \\approx y(t_n)$ 和 $f_n = f(t_n, y_n)$。单步的精确积分形式为 $y_{n+1} = y_n + \\int_{t_n}^{t_{n+1}} f(t, y(t)) \\, dt$。\n\n仅使用以下基本要素：\n- 积分表示 $y_{n+1} = y_n + \\int_{t_n}^{t_{n+1}} f(t, y(t)) \\, dt$，\n- 在选定的时间节点上，用拉格朗日插值多项式对 $f$ 进行多项式插值，\n- 在 $[t_n, t_{n+1}]$ 上对该插值多项式进行精确积分，\n\n请从第一性原理推导以下方法的系数：\n- 二阶两步 Adams–Bashforth 方法 (Adams–Bashforth (AB) $2$)，通过在过去节点 $\\{t_{n}, t_{n-1}\\}$ 对 $f$ 进行插值，并在 $[t_n, t_{n+1}]$ 上对插值多项式进行积分得到，\n- 二阶 Adams–Moulton 方法 (Adams–Moulton (AM) $2$)，通过在节点 $\\{t_{n+1}, t_{n}\\}$ 对 $f$ 进行插值，并在 $[t_n, t_{n+1}]$ 上对插值多项式进行积分得到。\n\n将两个公式都表示为规范形式\n$y_{n+1} = y_n + h \\sum_{j} \\beta_j f_{n+j}$，\n并确定系数的数值。将最终答案以单个行向量 $\\big(\\beta^{\\mathrm{AB2}}_{0}, \\beta^{\\mathrm{AB2}}_{-1}, \\beta^{\\mathrm{AM2}}_{1}, \\beta^{\\mathrm{AM2}}_{0}\\big)$ 的形式报告，分别对应 Adams–Bashforth $2$ 中乘以 $f_n$、$f_{n-1}$ 的系数，以及 Adams–Moulton $2$ 中乘以 $f_{n+1}$、$f_n$ 的系数。请提供精确的有理数值。无需四舍五入。最终答案中不需要物理单位。",
            "solution": "该问题陈述经核实具有科学依据、适定、客观且完整。它构成了常微分方程数值分析领域的标准推导。我们按要求进行推导。\n\nAdams–Bashforth 和 Adams–Moulton 方法的基本原理都是近似精确关系 $y_{n+1} = y_n + \\int_{t_n}^{t_{n+1}} f(t, y(t)) \\, dt$ 中的积分。这是通过首先用一个多项式 $P(t)$ 来近似被积函数 $f(t, y(t))$ 实现的，该多项式在一组过去或当前时间层的已知趋势函数值 $f_k = f(t_k, y_k)$ 处进行插值。然后，精确计算该多项式的积分。\n\n设时间步长是均匀的，对于任意整数 $k$，$h = t_{k+1} - t_k$。为简化积分，我们引入一个由关系式 $t = t_n + sh$ 定义的无量纲时间坐标 $s$。因此，$dt = h \\, ds$。积分区间 $[t_n, t_{n+1}]$ 对应于 $s$ 从 $0$ 到 $1$。\n\n**二阶 Adams–Bashforth (AB2) 方法的推导**\n\nAB2 方法是一种显式两步法。它通过一个在已知值 $f_n = f(t_n, y_n)$ 和 $f_{n-1} = f(t_{n-1}, y_{n-1})$ 处进行插值的多项式来近似区间 $[t_n, t_{n+1}]$ 上的 $f(t, y(t))$。由于有两个点，这是一个线性多项式（1次）。\n\n经过点 $(t_n, f_n)$ 和 $(t_{n-1}, f_{n-1})$ 的拉格朗日插值多项式 $P_1^{\\mathrm{AB}}(t)$ 由下式给出：\n$$\nP_1^{\\mathrm{AB}}(t) = f_{n-1} \\frac{t - t_n}{t_{n-1} - t_n} + f_n \\frac{t - t_{n-1}}{t_n - t_{n-1}}\n$$\n注意到 $t_{n-1} - t_n = -h$ 和 $t_n - t_{n-1} = h$，我们有：\n$$\nP_1^{\\mathrm{AB}}(t) = f_{n-1} \\frac{t - t_n}{-h} + f_n \\frac{t - t_{n-1}}{h}\n$$\n用无量纲坐标 $s$ 表示，我们有 $t - t_n = sh$ 和 $t - t_{n-1} = (t_n + sh) - (t_n - h) = h(s+1)$。将这些代入多项式可得：\n$$\nP_1^{\\mathrm{AB}}(t(s)) = f_{n-1} \\frac{sh}{-h} + f_n \\frac{h(s+1)}{h} = -s f_{n-1} + (s+1) f_n\n$$\n现在积分近似为：\n$$\n\\int_{t_n}^{t_{n+1}} f(t, y(t)) \\, dt \\approx \\int_{t_n}^{t_{n+1}} P_1^{\\mathrm{AB}}(t) \\, dt = \\int_{0}^{1} P_1^{\\mathrm{AB}}(t(s)) \\, h \\, ds\n$$\n$$\n= h \\int_{0}^{1} \\left( -s f_{n-1} + (s+1) f_n \\right) \\, ds\n$$\n$$\n= h \\left[ -\\frac{s^2}{2} f_{n-1} + \\left(\\frac{s^2}{2} + s\\right) f_n \\right]_0^1\n$$\n$$\n= h \\left( -\\frac{1}{2} f_{n-1} + \\left(\\frac{1}{2} + 1\\right) f_n \\right) - h(0)\n$$\n$$\n= h \\left( \\frac{3}{2} f_n - \\frac{1}{2} f_{n-1} \\right)\n$$\n将此结果代入 ODE 的积分形式，得到 AB2 方法：\n$$\ny_{n+1} = y_n + h \\left( \\frac{3}{2} f_n - \\frac{1}{2} f_{n-1} \\right)\n$$\n从规范形式 $y_{n+1} = y_n + h \\sum_{j} \\beta_j f_{n+j}$ 中，系数可确定为：\n$\\beta^{\\mathrm{AB2}}_{0} = \\frac{3}{2}$ 和 $\\beta^{\\mathrm{AB2}}_{-1} = -\\frac{1}{2}$。\n\n**二阶 Adams–Moulton (AM2) 方法的推导**\n\nAM2 方法是一种隐式单步法。它通过一个在值 $f_{n+1} = f(t_{n+1}, y_{n+1})$ 和 $f_n = f(t_n, y_n)$ 处进行插值的线性多项式来近似区间 $[t_n, t_{n+1}]$ 上的 $f(t, y(t))$。该方法是隐式的，因为它需要未来时间步的值 $f_{n+1}$。\n\n经过点 $(t_{n+1}, f_{n+1})$ 和 $(t_n, f_n)$ 的拉格朗日插值多项式 $P_1^{\\mathrm{AM}}(t)$ 为：\n$$\nP_1^{\\mathrm{AM}}(t) = f_n \\frac{t - t_{n+1}}{t_n - t_{n+1}} + f_{n+1} \\frac{t - t_n}{t_{n+1} - t_n}\n$$\n当 $t_n - t_{n+1} = -h$ 和 $t_{n+1} - t_n = h$ 时，这变成：\n$$\nP_1^{\\mathrm{AM}}(t) = f_n \\frac{t - t_{n+1}}{-h} + f_{n+1} \\frac{t - t_n}{h}\n$$\n使用相同的坐标变换 $t = t_n + sh$，我们有 $t - t_n = sh$ 和 $t - t_{n+1} = (t_n + sh) - (t_n + h) = h(s-1)$。关于 $s$ 的多项式为：\n$$\nP_1^{\\mathrm{AM}}(t(s)) = f_n \\frac{h(s-1)}{-h} + f_{n+1} \\frac{sh}{h} = (1-s) f_n + s f_{n+1}\n$$\n积分近似为：\n$$\n\\int_{t_n}^{t_{n+1}} f(t, y(t)) \\, dt \\approx \\int_{t_n}^{t_{n+1}} P_1^{\\mathrm{AM}}(t) \\, dt = \\int_{0}^{1} P_1^{\\mathrm{AM}}(t(s)) \\, h \\, ds\n$$\n$$\n= h \\int_{0}^{1} \\left( (1-s) f_n + s f_{n+1} \\right) \\, ds\n$$\n$$\n= h \\left[ \\left(s - \\frac{s^2}{2}\\right) f_n + \\frac{s^2}{2} f_{n+1} \\right]_0^1\n$$\n$$\n= h \\left( \\left(1 - \\frac{1}{2}\\right) f_n + \\frac{1}{2} f_{n+1} \\right) - h(0)\n$$\n$$\n= h \\left( \\frac{1}{2} f_n + \\frac{1}{2} f_{n+1} \\right)\n$$\n这就得到了 AM2 方法，也称为梯形法则：\n$$\ny_{n+1} = y_n + \\frac{h}{2} (f_{n+1} + f_n)\n$$\n从规范形式中，系数可确定为：\n$\\beta^{\\mathrm{AM2}}_{1} = \\frac{1}{2}$ 和 $\\beta^{\\mathrm{AM2}}_{0} = \\frac{1}{2}$。\n\n**最终系数**\n\n综合结果，系数为：\n- 对于 Adams–Bashforth 2: $\\beta^{\\mathrm{AB2}}_{0} = \\frac{3}{2}$，$\\beta^{\\mathrm{AB2}}_{-1} = -\\frac{1}{2}$\n- 对于 Adams–Moulton 2: $\\beta^{\\mathrm{AM2}}_{1} = \\frac{1}{2}$，$\\beta^{\\mathrm{AM2}}_{0} = \\frac{1}{2}$\n\n所求的行向量为 $\\big(\\beta^{\\mathrm{AB2}}_{0}, \\beta^{\\mathrm{AB2}}_{-1}, \\beta^{\\mathrm{AM2}}_{1}, \\beta^{\\mathrm{AM2}}_{0}\\big)$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{3}{2}  -\\frac{1}{2}  \\frac{1}{2}  \\frac{1}{2} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "与依赖过去时间步信息的多步法不同，Runge-Kutta 方法提供了一条通过在单个时间步内进行多次“微观”计算来达到高精度的途径。本练习将带你深入经典的四阶 Runge-Kutta (RK4) 方法的核心，展示其系数是如何通过满足一系列严格的代数方程（即阶数条件）来确定的。完成此练习有助于你掌握紧凑而强大的 Butcher 表格表示法，这是理解和设计现代 Runge-Kutta 积分器的关键。",
            "id": "4084659",
            "problem": "在数值天气预报 (NWP) 中，对大气原始方程进行空间半离散化，会得到一个形如 $\\frac{d\\mathbf{u}}{dt}=\\mathbf{F}(t,\\mathbf{u})$ 的大型常微分方程 (ODEs) 组。其中，$\\mathbf{u}$ 代表计算网格上的速度分量、位温等预报变量，而 $\\mathbf{F}$ 则包含了离散化的动力和物理趋势项。由于其良好的精度和稳定性，显式龙格－库塔 (RK) 格式被广泛用作此类系统的时间积分器。从一个显式 $s$ 阶龙格－库塔方法的核心定义出发，该方法具有层离散点 $\\mathbf{c}=(c_{1},\\dots,c_{s})^{\\top}$、层矩阵 $A=(a_{ij})$ 和权重 $\\mathbf{b}=(b_{1},\\dots,b_{s})^{\\top}$，并将其应用于大气模型稳定性分析中使用的自治线性测试问题 $\\frac{dy}{dt}=\\lambda y$。通过对线性测试方程的精确指数解强制实现四阶精度，推导出经典四阶龙格－库塔方法 (经典RK4) 的布彻表 (Butcher tableau)。然后，验证对于所构造的系数，结构约束 $\\,\\mathbf{c}=A\\mathbf{1}\\,$ 和 $\\,\\sum_{i=1}^{s} b_{i}=1\\,$ 成立，其中 $\\mathbf{1}$ 表示所有分量都为 $1$ 的向量。最后，计算诊断量\n$$\nD \\;=\\; \\left\\| \\mathbf{c}-A\\mathbf{1} \\right\\|_{2} \\;+\\; \\left| \\sum_{i=1}^{s} b_{i} - 1 \\right|\n$$\n对于经典RK4系数。将 $D$ 的最终答案表示为一个无单位的实数。无需四舍五入。",
            "solution": "用户要求完整推导经典四阶龙格－库塔 (RK4) 方法的布彻表，验证其两个结构特性，并计算一个诊断量。\n\n该问题具有科学依据，提法明确且客观。它是常微分方程 (ODEs) 数值分析领域的标准练习，并与数值天气预报有相关的应用背景。因此，我们可以着手求解。\n\n对于初值问题 $\\frac{d\\mathbf{u}}{dt} = \\mathbf{F}(t, \\mathbf{u})$，一个 $s$ 阶显式龙格－库塔方法由系数 $(\\mathbf{c}, A, \\mathbf{b})$ 定义，其中 $\\mathbf{c} \\in \\mathbb{R}^s$ 是层离散点向量， $A \\in \\mathbb{R}^{s \\times s}$ 是严格下三角的层矩阵，$\\mathbf{b} \\in \\mathbb{R}^s$ 是权重向量。数值解通过以下方式从时间 $t_n$推进到 $t_{n+1} = t_n + \\Delta t$：\n$$\n\\mathbf{u}_{n+1} = \\mathbf{u}_n + \\Delta t \\sum_{i=1}^{s} b_i \\mathbf{k}_i\n$$\n其中，层 $\\mathbf{k}_i$ 由下式给出：\n$$\n\\mathbf{k}_i = \\mathbf{F}(t_n + c_i \\Delta t, \\mathbf{u}_n + \\Delta t \\sum_{j=1}^{i-1} a_{ij} \\mathbf{k}_j)\n$$\n\n问题要求通过对线性测试问题 $\\frac{dy}{dt} = \\lambda y$ 强制实现四阶精度来推导经典RK4方法的布彻表。将RK方法应用于此测试问题，得到 $y_{n+1} = R(z) y_n$，其中 $z = \\lambda \\Delta t$，$R(z)$ 是稳定性函数。对于显式RK方法，稳定性函数可以表示为：\n$$\nR(z) = 1 + z \\mathbf{b}^T (I - zA)^{-1} \\mathbf{1}\n$$\n其中 $\\mathbf{1}$ 是全一向量。由于 $A$ 是严格下三角矩阵，矩阵 $I-zA$ 是可逆的。使用诺伊曼级数 (Neumann series) 求逆，我们展开 $R(z)$：\n$$\nR(z) = 1 + z(\\mathbf{b}^T\\mathbf{1}) + z^2(\\mathbf{b}^TA\\mathbf{1}) + z^3(\\mathbf{b}^TA^2\\mathbf{1}) + z^4(\\mathbf{b}^TA^3\\mathbf{1}) + \\dots\n$$\n测试问题的精确解为 $y(t_n+\\Delta t) = y(t_n) \\exp(\\lambda \\Delta t) = y_n \\exp(z)$。$\\exp(z)$ 的泰勒级数 (Taylor series) 是：\n$$\n\\exp(z) = 1 + z + \\frac{z^2}{2!} + \\frac{z^3}{3!} + \\frac{z^4}{4!} + \\dots\n$$\n为了使一个方法达到四阶精度，其稳定性函数 $R(z)$ 必须与 $\\exp(z)$ 的级数展开式匹配到 $z^4$ 项。这产生了所谓的线性阶条件：\n\\begin{align*}\n\\mathbf{b}^T \\mathbf{1} = 1  (\\text{1 阶}) \\\\\n\\mathbf{b}^T A \\mathbf{1} = \\frac{1}{2}  (\\text{2 阶}) \\\\\n\\mathbf{b}^T A^2 \\mathbf{1} = \\frac{1}{6}  (\\text{3 阶}) \\\\\n\\mathbf{b}^T A^3 \\mathbf{1} = \\frac{1}{24}  (\\text{4 阶})\n\\end{align*}\n这些条件对于一般非线性问题达到四阶精度是必要但不充分的。一个方法是 $p=4$ 阶的，如果它满足一个更全面的包含八个代数方程的集合，即所谓的阶条件。经典RK4方法是这八个方程组的一个特解，通过一些简化假设得到。我们现在通过在这些简化选择下求解该方程组来推导系数。\n\n$p=4$ 阶的八个条件是：\n\\begin{align*}\n(1) \\quad  \\sum_{i} b_i = 1 \\\\\n(2) \\quad  \\sum_{i} b_i c_i = \\frac{1}{2} \\\\\n(3) \\quad  \\sum_{i} b_i c_i^2 = \\frac{1}{3} \\\\\n(4) \\quad  \\sum_{i,j} b_i a_{ij} c_j = \\frac{1}{6} \\\\\n(5) \\quad  \\sum_{i} b_i c_i^3 = \\frac{1}{4} \\\\\n(6) \\quad  \\sum_{i,j} b_i c_i a_{ij} c_j = \\frac{1}{8} \\\\\n(7) \\quad  \\sum_{i,j} b_i a_{ij} c_j^2 = \\frac{1}{12} \\\\\n(8) \\quad  \\sum_{i,j,k} b_i a_{ij} a_{jk} c_k = \\frac{1}{24}\n\\end{align*}\n经典RK4方法使用 $s=4$ 个层。其定义的简化假设是：\n(A1) 离散点的选择：$\\mathbf{c} = (0, 1/2, 1/2, 1)^T$。\n(A2) 行和条件成立：对于 $i=2,3,4$，$c_i = \\sum_{j=1}^{i-1} a_{ij}$。\n(A3) 对 $A$ 的进一步结构简化：$a_{31}=0$ 和 $a_{41}=a_{42}=0$。\n\n我们来推导系数。从(A1)可知，$c_1=0, c_2=1/2, c_3=1/2, c_4=1$。将这些值代入条件(2)和(3)：\n$$\n\\frac{1}{2} b_2 + \\frac{1}{2} b_3 + b_4 = \\frac{1}{2} \\quad \\implies \\quad b_2 + b_3 + 2b_4 = 1\n$$\n$$\n\\frac{1}{4} b_2 + \\frac{1}{4} b_3 + b_4 = \\frac{1}{3} \\quad \\implies \\quad b_2 + b_3 + 4b_4 = \\frac{4}{3}\n$$\n用第二个方程减去第一个方程，得到 $2b_4 = 4/3 - 1 = 1/3$，所以 $b_4 = 1/6$。\n将 $b_4$ 代回，得到 $b_2 + b_3 + 2(1/6) = 1$，所以 $b_2 + b_3 = 2/3$。\n根据条件(1)，$b_1+b_2+b_3+b_4 = 1$。代入已知值，$b_1 + 2/3 + 1/6 = 1$，得到 $b_1 = 1 - 5/6 = 1/6$。\n\n现在我们确定矩阵 $A$。\n根据(A2)：$a_{21}=c_2=1/2$。\n根据(A2)和(A3)：$a_{31}+a_{32}=c_3=1/2$ 且 $a_{31}=0$，这意味着 $a_{32}=1/2$。\n根据(A2)和(A3)：$a_{41}+a_{42}+a_{43}=c_4=1$ 且 $a_{41}=a_{42}=0$，这意味着 $a_{43}=1$。\n因此矩阵 $A$ 为：\n$$\nA = \\begin{pmatrix}\n0  0  0  0 \\\\\n1/2  0  0  0 \\\\\n0  1/2  0  0 \\\\\n0  0  1  0\n\\end{pmatrix}\n$$\n最后，我们使用另一个阶条件来确定剩余的权重 $b_2$ 和 $b_3$。条件(4)是 $\\sum_{i,j} b_i a_{ij} c_j = 1/6$。由于 $c_1=0$，该式简化为：\n$$\nb_3 a_{32} c_2 + b_4 (a_{42} c_2 + a_{43} c_3) = \\frac{1}{6}\n$$\n代入已推导出的 $A$ 和 $c_i$ 的值：\n$$\nb_3 (\\frac{1}{2})(\\frac{1}{2}) + \\frac{1}{6} (0 \\cdot \\frac{1}{2} + 1 \\cdot \\frac{1}{2}) = \\frac{1}{6}\n$$\n$$\n\\frac{1}{4} b_3 + \\frac{1}{12} = \\frac{1}{6} \\quad \\implies \\quad \\frac{1}{4} b_3 = \\frac{1}{12} \\quad \\implies \\quad b_3 = \\frac{4}{12} = \\frac{1}{3}\n$$\n由于 $b_2+b_3=2/3$，我们得到 $b_2 = 2/3 - 1/3 = 1/3$。\n现在所有系数都已确定。经典RK4方法的布彻表为：\n$$\n\\begin{array}{c|cccc}\n0    0      0      0  0 \\\\\n1/2  1/2    0      0  0 \\\\\n1/2  0      1/2    0  0 \\\\\n1    0      0      1  0 \\\\\n\\hline\n     1/6    1/3    1/3  1/6\n\\end{array}\n$$\n可以验证这组系数满足所有八个阶条件。\n\n接下来，我们验证推导出的系数的两个结构约束。\n1.  验证 $\\mathbf{c} = A\\mathbf{1}$：\n    $$\n    A\\mathbf{1} = \\begin{pmatrix}\n    0  0  0  0 \\\\\n    1/2  0  0  0 \\\\\n    0  1/2  0  0 \\\\\n    0  0  1  0\n    \\end{pmatrix}\n    \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\\\ 1 \\end{pmatrix}\n    =\n    \\begin{pmatrix}\n    0 \\\\\n    1/2 \\\\\n    1/2 \\\\\n    1\n    \\end{pmatrix}\n    = \\mathbf{c}\n    $$\n    该约束成立。这在推导中被用作简化假设 (A2)。\n\n2.  验证 $\\sum_{i=1}^{s} b_i = 1$：\n    $$\n    \\sum_{i=1}^{4} b_i = \\frac{1}{6} + \\frac{1}{3} + \\frac{1}{3} + \\frac{1}{6} = \\frac{1}{6} + \\frac{2}{6} + \\frac{2}{6} + \\frac{1}{6} = \\frac{6}{6} = 1\n    $$\n    这个约束，即一阶条件，也成立。\n\n最后，我们计算诊断量 $D$：\n$$\nD = \\left\\| \\mathbf{c}-A\\mathbf{1} \\right\\|_{2} + \\left| \\sum_{i=1}^{s} b_{i} - 1 \\right|\n$$\n基于上面的直接验证：\n第一项是向量差 $\\mathbf{c} - A\\mathbf{1}$ 的 L2-范数。由于我们已证明 $\\mathbf{c} = A\\mathbf{1}$，这个差是零向量 $\\mathbf{0}=(0,0,0,0)^T$。\n$$\n\\left\\| \\mathbf{c}-A\\mathbf{1} \\right\\|_{2} = \\left\\| \\mathbf{0} \\right\\|_{2} = 0\n$$\n第二项涉及权重的总和，我们已证明其为 $1$。\n$$\n\\left| \\sum_{i=1}^{s} b_{i} - 1 \\right| = |1 - 1| = 0\n$$\n因此，诊断量 $D$ 为：\n$$\nD = 0 + 0 = 0\n$$",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "在构建了数值积分器之后，一个核心问题是：如何选择合适的积分器和时间步长以确保计算的稳定性？对于包含从缓慢平流到快速重力波等多种时间尺度过程的大气模型而言，稳定性分析至关重要。本练习通过推导 RK4 方法的稳定性函数，将抽象的数学理论与数值天气预报中的实际挑战联系起来，让你能够定性分析其稳定性区域，并理解它对于处理扩散和波动现象的意义。",
            "id": "4084714",
            "problem": "在数值天气预报系统的半隐式谱核心中，线性化离散的原始方程的某些模式可以被分离出来，作为空间算子的本征模。经过一致的空间离散化后，每个这样的模式都遵循标量常微分方程 $y'(t) = \\lambda y(t)$，其中 $\\lambda \\in \\mathbb{C}$ 是离散化线性算子的一个特征值，它可能编码了重力波的传播（$\\lambda$ 的值近乎为纯虚数）或扩散（$\\lambda$ 具有负实部）。考虑将经典的显式四阶四级龙格-库塔（Runge–Kutta, RK）方法以固定的时间步长 $h  0$ 应用于此标量测试问题。设该方法由以下分级方程定义\n$$\nk_{1} = f(y_{n}), \\quad\nk_{2} = f\\!\\left(y_{n} + \\frac{h}{2} k_{1}\\right), \\quad\nk_{3} = f\\!\\left(y_{n} + \\frac{h}{2} k_{2}\\right), \\quad\nk_{4} = f\\!\\left(y_{n} + h\\, k_{3}\\right),\n$$\n以及更新\n$$\ny_{n+1} = y_{n} + \\frac{h}{6}\\left(k_{1} + 2 k_{2} + 2 k_{3} + k_{4}\\right),\n$$\n其中 $f(y) = \\lambda y$ 且 $z = h \\lambda$。从这些定义和标量测试方程出发，推导由 $y_{n+1} = R(z)\\, y_{n}$ 定义的稳定性函数 $R(z)$。然后，基于 $R(z)$，在复平面中定性描述绝对稳定域 $\\{z \\in \\mathbb{C} : |R(z)| \\leq 1\\}$，说明它如何与负实轴相交以及它在虚轴附近的行为。简要解释这些特征在数值天气预报和气候模拟中对重力波和扩散模进行显式时间步进的背景下的意义，并将其与Adams型多步法的定性稳定性属性进行对比。提供 $R(z)$ 的解析表达式作为你的最终答案。不需要四舍五入，最终表达式中也不应包含任何单位。",
            "solution": "问题陈述是适定的，有科学依据，并包含了推导经典四阶龙格-库塔方法的稳定性函数并分析其性质所需的所有信息。该问题有效。\n\n任务是推导显式四阶四级龙格-库塔（RK4）方法应用于标量测试方程 $y'(t) = \\lambda y(t)$（其中 $\\lambda \\in \\mathbb{C}$）时的稳定性函数 $R(z)$。稳定性函数由关系式 $y_{n+1} = R(z) y_n$ 定义，其中 $z = h\\lambda$，$h$ 是时间步长。\n\nRK4 方法定义如下：\n$$\nk_{1} = f(y_{n})\n$$\n$$\nk_{2} = f\\left(y_{n} + \\frac{h}{2} k_{1}\\right)\n$$\n$$\nk_{3} = f\\left(y_{n} + \\frac{h}{2} k_{2}\\right)\n$$\n$$\nk_{4} = f\\left(y_{n} + h k_{3}\\right)\n$$\n$$\ny_{n+1} = y_{n} + \\frac{h}{6}\\left(k_{1} + 2 k_{2} + 2 k_{3} + k_{4}\\right)\n$$\n\n对于测试方程 $y' = \\lambda y$，函数为 $f(y) = \\lambda y$。我们将其代入分级方程：\n\n第1级：\n$$\nk_1 = \\lambda y_n\n$$\n\n第2级：\n$$\nk_2 = \\lambda \\left(y_n + \\frac{h}{2} k_1\\right) = \\lambda \\left(y_n + \\frac{h}{2} (\\lambda y_n)\\right) = \\lambda y_n \\left(1 + \\frac{h\\lambda}{2}\\right)\n$$\n\n第3级：\n$$\nk_3 = \\lambda \\left(y_n + \\frac{h}{2} k_2\\right) = \\lambda \\left(y_n + \\frac{h}{2} \\left[\\lambda y_n \\left(1 + \\frac{h\\lambda}{2}\\right)\\right]\\right) = \\lambda y_n \\left(1 + \\frac{h\\lambda}{2} + \\frac{(h\\lambda)^2}{4}\\right)\n$$\n\n第4级：\n$$\nk_4 = \\lambda \\left(y_n + h k_3\\right) = \\lambda \\left(y_n + h \\left[\\lambda y_n \\left(1 + \\frac{h\\lambda}{2} + \\frac{(h\\lambda)^2}{4}\\right)\\right]\\right) = \\lambda y_n \\left(1 + h\\lambda + \\frac{(h\\lambda)^2}{2} + \\frac{(h\\lambda)^3}{4}\\right)\n$$\n\n现在，我们将分级 $k_1, k_2, k_3, k_4$ 的这些表达式代入 $y_{n+1}$ 的最终更新公式：\n$$\ny_{n+1} = y_n + \\frac{h}{6} \\left[ \\lambda y_n + 2\\lambda y_n \\left(1 + \\frac{h\\lambda}{2}\\right) + 2\\lambda y_n \\left(1 + \\frac{h\\lambda}{2} + \\frac{(h\\lambda)^2}{4}\\right) + \\lambda y_n \\left(1 + h\\lambda + \\frac{(h\\lambda)^2}{2} + \\frac{(h\\lambda)^3}{4}\\right) \\right]\n$$\n从右侧提出公因子 $y_n$ 并代入 $z = h\\lambda$：\n$$\ny_{n+1} = y_n \\left( 1 + \\frac{h\\lambda}{6} \\left[ 1 + 2\\left(1 + \\frac{h\\lambda}{2}\\right) + 2\\left(1 + \\frac{h\\lambda}{2} + \\frac{(h\\lambda)^2}{4}\\right) + \\left(1 + h\\lambda + \\frac{(h\\lambda)^2}{2} + \\frac{(h\\lambda)^3}{4}\\right) \\right] \\right)\n$$\n$$\ny_{n+1} = y_n \\left( 1 + \\frac{z}{6} \\left[ 1 + 2\\left(1 + \\frac{z}{2}\\right) + 2\\left(1 + \\frac{z}{2} + \\frac{z^2}{4}\\right) + \\left(1 + z + \\frac{z^2}{2} + \\frac{z^3}{4}\\right) \\right] \\right)\n$$\n化简方括号内的表达式：\n$$\n[ \\dots ] = 1 + (2+z) + (2+z+\\frac{z^2}{2}) + (1+z+\\frac{z^2}{2}+\\frac{z^3}{4})\n$$\n$$\n[ \\dots ] = (1+2+2+1) + (z+z+z) + \\left(\\frac{z^2}{2}+\\frac{z^2}{2}\\right) + \\frac{z^3}{4} = 6 + 3z + z^2 + \\frac{z^3}{4}\n$$\n将此结果代回 $y_{n+1}$ 的表达式：\n$$\ny_{n+1} = y_n \\left( 1 + \\frac{z}{6} \\left[ 6 + 3z + z^2 + \\frac{z^3}{4} \\right] \\right)\n$$\n$$\ny_{n+1} = y_n \\left( 1 + z + \\frac{z^2}{2} + \\frac{z^3}{6} + \\frac{z^4}{24} \\right)\n$$\n通过与定义 $y_{n+1} = R(z) y_n$ 进行比较，我们确定稳定性函数 $R(z)$ 为：\n$$\nR(z) = 1 + z + \\frac{z^2}{2} + \\frac{z^3}{6} + \\frac{z^4}{24} = \\sum_{k=0}^{4} \\frac{z^k}{k!}\n$$\n这是指数函数 $\\exp(z)$ 的四阶泰勒级数展开。精确常微分方程的解是 $y(t_{n+1}) = \\exp(h\\lambda) y(t_n) = \\exp(z) y(t_n)$，因此 $R(z)$ 是 $\\exp(z)$ 的一个四阶近似。\n\n绝对稳定域是集合 $\\{z \\in \\mathbb{C} : |R(z)| \\leq 1\\}$。\n定性地看，这个区域是复平面左半部分一个有界的、豆形的区域，关于实轴对称并包含原点。\n-   它与负实轴的交集是一个区间 $[x_0, 0]$。左端点 $x_0$ 通过求解 $R(x_0)=-1$ 得到，结果为 $x_0 \\approx -2.785$。因此，对于纯扩散问题（$z=h\\lambda$ 是实数且为负），稳定性要求是 $|z| \\leq 2.785$。\n-   它与虚轴的交集是一个区间 $[-i\\omega_0, i\\omega_0]$。端点通过求解 $|R(i\\omega)| = 1$ 得到。这发生在 $\\omega_0 = \\sqrt{8} = 2\\sqrt{2} \\approx 2.828$ 处。因此，对于纯振荡问题（$z=h\\lambda$ 是纯虚数），稳定性要求是 $|z| \\leq 2\\sqrt{2}$。\n\n在数值天气预报和气候模拟的背景下：\n-   **扩散模** 对应于具有负实部的 $\\lambda$。负实轴上的稳定性限制（$|h\\lambda| \\leq 2.785$）对时间步长 $h$ 施加了一个约束，该约束与扩散强度成反比。对于强扩散（大的 $|\\text{Re}(\\lambda)|$），$h$ 必须非常小。\n-   **重力波模** 对应于近乎为纯虚数的 $\\lambda$。稳定域沿虚轴的有限范围（$|h\\lambda| \\leq 2\\sqrt{2}$）尤其具有限制性。快速传播的重力波具有大的 $\\lambda$ 虚部，这迫使使用非常小的时间步长 $h$ 来维持稳定性。这就是这些波的 Courant–Friedrichs–Lewy (CFL) 条件。这种严格的时间步长限制是在大气模型中使用半隐式格式的一个主要动机，在这些格式中，负责快波的项被隐式处理以消除这种稳定性约束。\n\n与 Adams 型多步法的对比：\n-   **Adams-Bashforth（显式）方法：** 与 RK4 一样，这些是具有有界稳定域的显式方法。对于给定的阶数，它们的稳定域通常比龙格-库塔方法的稳定域更小且形状更复杂。例如，四阶 Adams-Bashforth 方法在实轴上的稳定区间约为 $[-1.3, 0]$，这比 RK4 的限制性要大得多。它们同样不适用于大气模型的刚性分量。\n-   **Adams-Moulton（隐式）方法：** 这些方法具有大得多的稳定域。二阶 Adams-Moulton 方法（梯形法则）是 A-稳定的，意味着其稳定域包含整个左半平面，即 $\\text{Re}(z) \\leq 0$。这使其对于任何扩散或纯振荡的稳定模式都是无条件稳定的。更高阶的 Adams-Moulton 方法不是 A-稳定的，但是“刚性稳定”的，拥有比任何同阶显式方法大得多的稳定域。这种有利的稳定性属性允许使用大得多的时间步长，使得它们以及其他隐式格式，对于大气和气候模型的有效长期积分至关重要，在这些模型中，由各种物理过程引起的刚性是一个主要特征。像 RK4 这样的显式方法通常保留用于非刚性分量，例如平流，或者用于启动多步法。",
            "answer": "$$\n\\boxed{1 + z + \\frac{z^2}{2} + \\frac{z^3}{6} + \\frac{z^4}{24}}\n$$"
        }
    ]
}