{
    "hands_on_practices": [
        {
            "introduction": "光谱模型通过将大气场表示为一系列波的总和来进行模拟。第一个练习提供了基础性的实践，即将一个由熟悉的正弦和余弦波组成的简单场，转换为其复数傅里叶级数表示。掌握这种转换是理解和操作谱空间数据的第一步 。",
            "id": "4044958",
            "problem": "考虑一个沿经度方向纬向周期的标量场，表示为函数 $f(\\lambda)$，其中 $\\lambda \\in [0,2\\pi)$ 是以弧度为单位的经度。在用于数值天气预报和气候模拟的全球谱模式中，场的经向相关性被展开为复傅里叶模态，而纬向相关性则用球谐函数处理。一个 $2\\pi$ 周期函数的复傅里叶级数定义为\n$$\nf(\\lambda) = \\sum_{k\\in\\mathbb{Z}} \\hat{f}_{k}\\,\\exp(i k \\lambda),\n\\quad\n\\hat{f}_{k} = \\frac{1}{2\\pi}\\int_{0}^{2\\pi} f(\\lambda)\\,\\exp(-i k \\lambda)\\,\\mathrm{d}\\lambda,\n$$\n其中 $i$ 是虚数单位，$\\exp(i k \\lambda)$ 在 $[0,2\\pi)$ 上的正交性是谱分解的基础。令\n$$\nf(\\lambda) = \\sin(3\\lambda) + \\frac{1}{2}\\cos(2\\lambda).\n$$\n从上述定义出发，并且仅使用诸如欧拉公式 $\\exp(i\\theta)=\\cos\\theta+i\\sin\\theta$、$\\cos\\theta=\\frac{1}{2}\\big(\\exp(i\\theta)+\\exp(-i\\theta)\\big)$ 和 $\\sin\\theta=\\frac{1}{2i}\\big(\\exp(i\\theta)-\\exp(-i\\theta)\\big)$ 等公认的恒等式，完成以下任务：\n- 推导 $f(\\lambda)$ 的非零复傅里叶系数 $\\hat{f}_{k}$。\n- 从这些 $\\hat{f}_{k}$ 重构 $f(\\lambda)$ 以验证一致性。\n- 解释实三角分量的振幅和相位是如何编码在非零纬向波数的复系数中的。\n\n角度以弧度表示。使用 $\\mathrm{pmatrix}$ 环境，将你的最终答案以非零系数的有序行向量 $(\\hat{f}_{-3},\\,\\hat{f}_{-2},\\,\\hat{f}_{2},\\,\\hat{f}_{3})$ 的形式报告。无需四舍五入。",
            "solution": "问题是要求出给定标量场的非零复傅里叶系数，通过重构验证结果，并解释实波的性质是如何编码在这些系数中的。给定的标量场为 $f(\\lambda) = \\sin(3\\lambda) + \\frac{1}{2}\\cos(2\\lambda)$，其中 $\\lambda \\in [0, 2\\pi)$ 是以弧度为单位的经度。\n\n分析基于 $2\\pi$ 周期函数的复傅里叶级数表示：\n$$f(\\lambda) = \\sum_{k\\in\\mathbb{Z}} \\hat{f}_{k}\\,\\exp(i k \\lambda)$$\n其中系数 $\\hat{f}_{k}$ 由投影积分给出：\n$$\\hat{f}_{k} = \\frac{1}{2\\pi}\\int_{0}^{2\\pi} f(\\lambda)\\,\\exp(-i k \\lambda)\\,\\mathrm{d}\\lambda$$\n\n第一个任务是求出非零系数 $\\hat{f}_{k}$。我们可以不进行直接积分，而是使用提供的欧拉恒等式将 $f(\\lambda)$ 表示为复指数形式，然后将所得表达式与傅里叶级数的定义进行比较，从而确定系数。\n\n相关的欧拉恒等式是：\n$$\\cos\\theta = \\frac{1}{2}\\big(\\exp(i\\theta)+\\exp(-i\\theta)\\big)$$\n$$\\sin\\theta = \\frac{1}{2i}\\big(\\exp(i\\theta)-\\exp(-i\\theta)\\big) = -\\frac{i}{2}\\big(\\exp(i\\theta)-\\exp(-i\\theta)\\big)$$\n因为 $\\frac{1}{i} = -i$。\n\n我们将这些恒等式代入 $f(\\lambda)$ 的表达式中：\n$$f(\\lambda) = \\left( -\\frac{i}{2}\\big(\\exp(i3\\lambda)-\\exp(-i3\\lambda)\\big) \\right) + \\frac{1}{2}\\left( \\frac{1}{2}\\big(\\exp(i2\\lambda)+\\exp(-i2\\lambda)\\big) \\right)$$\n展开各项，我们得到：\n$$f(\\lambda) = -\\frac{i}{2}\\exp(i3\\lambda) + \\frac{i}{2}\\exp(-i3\\lambda) + \\frac{1}{4}\\exp(i2\\lambda) + \\frac{1}{4}\\exp(-i2\\lambda)$$\n为了使其与傅里叶级数形式 $f(\\lambda) = \\sum_{k\\in\\mathbb{Z}} \\hat{f}_{k}\\,\\exp(i k \\lambda)$ 相匹配，我们按照纬向波数 $k$ 的递增顺序重新排列各项：\n$$f(\\lambda) = \\left(\\frac{i}{2}\\right)\\exp(i(-3)\\lambda) + \\left(\\frac{1}{4}\\right)\\exp(i(-2)\\lambda) + \\left(\\frac{1}{4}\\right)\\exp(i(2)\\lambda) + \\left(-\\frac{i}{2}\\right)\\exp(i(3)\\lambda)$$\n通过直接比较 $\\exp(ik\\lambda)$ 项的系数，我们可以确定非零傅里叶系数：\n- 对于 $k = -3$：$\\hat{f}_{-3} = \\frac{i}{2}$\n- 对于 $k = -2$：$\\hat{f}_{-2} = \\frac{1}{4}$\n- 对于 $k = 2$：$\\hat{f}_{2} = \\frac{1}{4}$\n- 对于 $k = 3$：$\\hat{f}_{3} = -\\frac{i}{2}$\n所有其他对于 $k \\notin \\{-3, -2, 2, 3\\}$ 的系数 $\\hat{f}_{k}$ 均为零。注意，对于这个实值函数 $f(\\lambda)$，其系数满足性质 $\\hat{f}_{-k} = \\overline{\\hat{f}_{k}}$（复共轭），这与预期相符。对于 $k=2$，$\\hat{f}_{-2} = \\frac{1}{4}$ 且 $\\overline{\\hat{f}_2} = \\overline{\\frac{1}{4}} = \\frac{1}{4}$。对于 $k=3$，$\\hat{f}_{-3} = \\frac{i}{2}$ 且 $\\overline{\\hat{f}_3} = \\overline{-\\frac{i}{2}} = \\frac{i}{2}$。\n\n第二个任务是从这些系数重构 $f(\\lambda)$ 以验证一致性。我们将与非零系数对应的分量相加：\n$$f(\\lambda) = \\hat{f}_{-3}\\exp(-i3\\lambda) + \\hat{f}_{-2}\\exp(-i2\\lambda) + \\hat{f}_{2}\\exp(i2\\lambda) + \\hat{f}_{3}\\exp(i3\\lambda)$$\n代入我们求得的值：\n$$f(\\lambda) = \\frac{i}{2}\\exp(-i3\\lambda) + \\frac{1}{4}\\exp(-i2\\lambda) + \\frac{1}{4}\\exp(i2\\lambda) - \\frac{i}{2}\\exp(i3\\lambda)$$\n我们将具有相同波数大小 $|k|$ 的项分组：\n$$f(\\lambda) = \\left( \\frac{1}{4}\\exp(i2\\lambda) + \\frac{1}{4}\\exp(-i2\\lambda) \\right) + \\left( -\\frac{i}{2}\\exp(i3\\lambda) + \\frac{i}{2}\\exp(-i3\\lambda) \\right)$$\n提取公因式：\n$$f(\\lambda) = \\frac{1}{2} \\left( \\frac{\\exp(i2\\lambda) + \\exp(-i2\\lambda)}{2} \\right) + \\left( \\frac{\\exp(i3\\lambda) - \\exp(-i3\\lambda)}{2i} \\right)$$\n逆向使用欧拉恒等式，我们识别出 $\\cos(2\\lambda)$ 和 $\\sin(3\\lambda)$ 的表达式：\n$$f(\\lambda) = \\frac{1}{2}\\cos(2\\lambda) + \\sin(3\\lambda)$$\n这与原函数相同，证实了所推导系数的正确性。\n\n第三个任务是解释实三角分量的振幅和相位是如何编码在复系数中的。考虑一个特定正波数 $k > 0$ 的一般实波分量，写成 $A_k\\cos(k\\lambda) + B_k\\sin(k\\lambda)$。使用欧拉恒等式，该分量可以表示为：\n$$A_k \\frac{\\exp(ik\\lambda)+\\exp(-ik\\lambda)}{2} + B_k \\frac{\\exp(ik\\lambda)-\\exp(-ik\\lambda)}{2i}$$\n$$ = \\frac{A_k}{2}(\\exp(ik\\lambda)+\\exp(-ik\\lambda)) - \\frac{iB_k}{2}(\\exp(ik\\lambda)-\\exp(-ik\\lambda))$$\n按 $\\exp(ik\\lambda)$ 和 $\\exp(-ik\\lambda)$ 对各项进行分组：\n$$ = \\left(\\frac{A_k - iB_k}{2}\\right)\\exp(ik\\lambda) + \\left(\\frac{A_k + iB_k}{2}\\right)\\exp(-ik\\lambda)$$\n与傅里叶级数项 $\\hat{f}_{k}\\exp(ik\\lambda) + \\hat{f}_{-k}\\exp(-ik\\lambda)$ 比较，我们发现：\n$$\\hat{f}_{k} = \\frac{A_k - iB_k}{2} \\quad \\text{和} \\quad \\hat{f}_{-k} = \\frac{A_k + iB_k}{2} = \\overline{\\hat{f}_{k}}$$\n实波分量 $C_k\\cos(k\\lambda - \\phi_k) = A_k\\cos(k\\lambda) + B_k\\sin(k\\lambda)$ 的振幅是 $C_k = \\sqrt{A_k^2 + B_k^2}$。复系数 $\\hat{f}_k$ 的模是：\n$$|\\hat{f}_{k}| = \\left|\\frac{A_k - iB_k}{2}\\right| = \\frac{1}{2}\\sqrt{A_k^2 + (-B_k)^2} = \\frac{1}{2}\\sqrt{A_k^2 + B_k^2} = \\frac{C_k}{2}$$\n因此，实波的振幅是正波数对应的复傅里叶系数的模的两倍：$C_k = 2|\\hat{f}_{k}|$。\n\n相位 $\\phi_k$ 由 $\\phi_k = \\arctan(B_k/A_k)$ 给出。复系数 $\\hat{f}_k$ 的辐角（相位）是：\n$$\\arg(\\hat{f}_{k}) = \\arg\\left(\\frac{A_k}{2} - i\\frac{B_k}{2}\\right) = \\arctan\\left(\\frac{-B_k/2}{A_k/2}\\right) = \\arctan\\left(-\\frac{B_k}{A_k}\\right) = -\\phi_k$$\n因此，实波的相位是复傅里叶系数辐角的负值：$\\phi_k = -\\arg(\\hat{f}_{k})$。\n\n将此应用于我们的问题：\n- 对于波数 $k=2$，实分量是 $\\frac{1}{2}\\cos(2\\lambda)$。这里，$A_2 = \\frac{1}{2}$ 且 $B_2=0$。振幅是 $C_2=\\frac{1}{2}$，相位是 $\\phi_2=0$。复系数是 $\\hat{f}_{2} = \\frac{1}{4}$。\n  - 振幅检验：$2|\\hat{f}_{2}| = 2\\left|\\frac{1}{4}\\right| = \\frac{1}{2} = C_2$。\n  - 相位检验：$-\\arg(\\hat{f}_{2}) = -\\arg\\left(\\frac{1}{4}\\right) = -0 = 0 = \\phi_2$。\n- 对于波数 $k=3$，实分量是 $\\sin(3\\lambda)$。这里，$A_3 = 0$ 且 $B_3=1$。这可以写成 $1 \\cdot \\cos(3\\lambda - \\pi/2)$。振幅是 $C_3=1$，相位是 $\\phi_3=\\pi/2$。复系数是 $\\hat{f}_{3} = -\\frac{i}{2}$。\n  - 振幅检验：$2|\\hat{f}_{3}| = 2\\left|-\\frac{i}{2}\\right| = 2 \\cdot \\frac{1}{2} = 1 = C_3$。\n  - 相位检验：$-\\arg(\\hat{f}_{3}) = -\\arg\\left(-\\frac{i}{2}\\right) = -(-\\pi/2) = \\pi/2 = \\phi_3$。\n\n分析证实，对于一个正波数 $k$，相应实波的振幅和相位被编码在单个复系数 $\\hat{f}_k$ 的模和辐角中。对于实信号，系数 $\\hat{f}_{-k}$ 是多余的，因为它只是 $\\hat{f}_k$ 的复共轭。\n\n最终答案是非零系数的有序行向量 $(\\hat{f}_{-3},\\,\\hat{f}_{-2},\\,\\hat{f}_{2},\\,\\hat{f}_{3})$。\n- $\\hat{f}_{-3} = \\frac{i}{2}$\n- $\\hat{f}_{-2} = \\frac{1}{4}$\n- $\\hat{f}_{2} = \\frac{1}{4}$\n- $\\hat{f}_{3} = -\\frac{i}{2}$",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{i}{2}  \\frac{1}{4}  \\frac{1}{4}  -\\frac{i}{2} \\end{pmatrix}}$$"
        },
        {
            "introduction": "在连续傅里叶级数的基础上，本练习探讨了数值建模的一个关键方面：数据离散化。当一个连续场在有限网格上采样时，高频波可能被错误地解释为低频波——这种现象被称为“混叠”。本练习通过分析欠采样信号的离散傅里叶变换(DFT)，演示了如何识别混叠，这是正确解读光谱模型输出的一项至关重要的技能 。",
            "id": "4044967",
            "problem": "考虑球面上一个纬向周期的标量场，该场代表了数值天气预报谱动力核心中的一个预报变量。现将其限制在单个纬度圈上，以便使用傅里叶基来分析其经度相关性。设经度为 $\\lambda \\in [0,2\\pi)$，该场为\n$$\nf(\\lambda) = \\cos(5\\lambda) + \\cos(9\\lambda).\n$$\n假设该场在 $N=16$ 个等距经度点 $\\lambda_n = \\frac{2\\pi n}{N}$（其中 $n=0,1,\\dots,15$）上进行采样。定义离散傅里叶变换 (DFT) 为\n$$\nX_k = \\sum_{n=0}^{N-1} f(\\lambda_n)\\,\\exp\\!\\left(-i\\,\\frac{2\\pi k n}{N}\\right), \\quad k=0,1,\\dots,N-1,\n$$\n其逆变换为\n$$\nf(\\lambda_n) = \\frac{1}{N}\\sum_{k=0}^{N-1} X_k\\,\\exp\\!\\left(i\\,\\frac{2\\pi k n}{N}\\right).\n$$\n从圆周上傅里叶基的基本定义和采样操作出发，推导在指定采样点上 $f(\\lambda)$ 的非零 DFT 系数 $X_k$。然后，利用奈奎斯特波数 $k_{\\mathrm{Nyq}} = \\frac{N}{2}$ 的定义和圆周上的离散采样对称性，解释在离散网格上解释波数 $k>k_{\\mathrm{Nyq}}$ 的模态时，哪些连续波数贡献发生了混叠，并指出相应的混叠后的可分辨波数。\n\n将最终的谱表示为一个包含 $X_0, X_1, \\dots, X_{15}$（按此顺序）的单行矩阵。无需四舍五入。",
            "solution": "该问题要求计算一个在离散网格上采样的给定函数的离散傅里叶变换 (DFT) 系数，并解释其中涉及的混叠现象。\n\n该标量场由下式给出\n$$\nf(\\lambda) = \\cos(5\\lambda) + \\cos(9\\lambda).\n$$\n使用欧拉公式 $\\cos(\\theta) = \\frac{1}{2} (\\exp(i\\theta) + \\exp(-i\\theta))$，我们可以将该函数表示为复指数之和，这些复指数代表行波：\n$$\nf(\\lambda) = \\frac{1}{2}\\left(\\exp(i5\\lambda) + \\exp(-i5\\lambda)\\right) + \\frac{1}{2}\\left(\\exp(i9\\lambda) + \\exp(-i9\\lambda)\\right).\n$$\n此函数是连续波数为 $m = \\pm 5$ 和 $m = \\pm 9$ 的波的叠加。\n\n该场在 $N=16$ 个等距点 $\\lambda_n = \\frac{2\\pi n}{N}$（其中 $n=0, 1, \\dots, N-1$）上进行采样。奈奎斯特采样定理指出，为避免混叠，信号中存在的最高波数的绝对值 $m_{\\max}$ 必须小于奈奎斯特波数 $k_{\\mathrm{Nyq}}$。奈奎斯特波数定义为 $k_{\\mathrm{Nyq}} = \\frac{N}{2}$。对于本问题，\n$$\nk_{\\mathrm{Nyq}} = \\frac{16}{2} = 8.\n$$\n$f(\\lambda)$ 中存在的波数是 $m=\\pm 5$ 和 $m=\\pm 9$。\n来自 $\\cos(5\\lambda)$ 的波数贡献的绝对值为 $|m|=5$。由于 $|5|  k_{\\mathrm{Nyq}}$，该波可以被网格分辨。\n来自 $\\cos(9\\lambda)$ 的波数贡献的绝对值为 $|m|=9$。由于 $|9| > k_{\\mathrm{Nyq}}$，该波被欠采样，并将发生混叠。\n\n我们必须确定波数 $m=9$ 在离散网格上是如何表示的。如果在网格点 $\\lambda_n$ 上求值，一个连续波 $\\exp(im\\lambda)$ 与另一个波 $\\exp(im'\\lambda)$ 是无法区分的，条件是 $m' = m + jN$，其中 $j$ 为任意整数。这是因为：\n$$\n\\exp(im'\\lambda_n) = \\exp(i(m+jN)\\lambda_n) = \\exp\\left(i(m+jN)\\frac{2\\pi n}{N}\\right) = \\exp\\left(i\\frac{2\\pi m n}{N}\\right) \\exp\\left(i\\frac{2\\pi j N n}{N}\\right) = \\exp(im\\lambda_n) \\exp(i2\\pi jn).\n$$\n由于 $j$ 和 $n$ 是整数，所以 $\\exp(i2\\pi jn) = 1$。因此，在离散网格上，连续波数 $m=9$ 会混叠到 $[-k_{\\mathrm{Nyq}}, k_{\\mathrm{Nyq}}]$ 范围内的某个可分辨波数 $m'$。我们通过选择 $j=-1$ 来找到 $m'$：\n$$\nm' = 9 + (-1)N = 9 - 16 = -7.\n$$\n类似地，连续波数 $m=-9$ 通过选择 $j=1$ 发生混叠：\n$$\nm' = -9 + (1)N = -9 + 16 = 7.\n$$\n因此，$\\cos(9\\lambda)$ 项的采样值与 $\\cos(7\\lambda)$ 项的采样值相同：\n$$\n\\cos(9\\lambda_n) = \\cos\\left(9\\frac{2\\pi n}{16}\\right) = \\cos\\left((16-7)\\frac{2\\pi n}{16}\\right) = \\cos\\left(2\\pi n - 7\\frac{2\\pi n}{16}\\right) = \\cos\\left(-7\\frac{2\\pi n}{16}\\right) = \\cos\\left(7\\frac{2\\pi n}{16}\\right) = \\cos(7\\lambda_n).\n$$\n来自 $\\cos(9\\lambda)$ 的连续波贡献在离散网格上混叠为 $\\cos(7\\lambda)$。这个欠采样的波伪装成了一个更低频率的波。\n\n因此，在采样点上求值的函数 $f(\\lambda_n)$ 实际上是\n$$\nf(\\lambda_n) = \\cos(5\\lambda_n) + \\cos(7\\lambda_n).\n$$\n我们现在为这个混叠后的函数计算 DFT 系数 $X_k$。首先，我们将 $f(\\lambda_n)$ 表示为复指数形式：\n$$\nf(\\lambda_n) = \\frac{1}{2}\\left(\\exp(i5\\lambda_n) + \\exp(-i5\\lambda_n)\\right) + \\frac{1}{2}\\left(\\exp(i7\\lambda_n) + \\exp(-i7\\lambda_n)\\right).\n$$\n代入 $\\lambda_n = \\frac{2\\pi n}{N}$：\n$$\nf(\\lambda_n) = \\frac{1}{2}\\exp\\left(i\\frac{2\\pi(5)n}{N}\\right) + \\frac{1}{2}\\exp\\left(i\\frac{2\\pi(-5)n}{N}\\right) + \\frac{1}{2}\\exp\\left(i\\frac{2\\pi(7)n}{N}\\right) + \\frac{1}{2}\\exp\\left(i\\frac{2\\pi(-7)n}{N}\\right).\n$$\nDFT 定义为 $X_k = \\sum_{n=0}^{N-1} f(\\lambda_n)\\,\\exp\\left(-i\\,\\frac{2\\pi k n}{N}\\right)$。DFT 的一个关键性质是其基函数的正交性：\n$$\n\\sum_{n=0}^{N-1} \\exp\\left(i\\frac{2\\pi m n}{N}\\right) \\exp\\left(-i\\frac{2\\pi k n}{N}\\right) = \\sum_{n=0}^{N-1} \\exp\\left(i\\frac{2\\pi(m-k)n}{N}\\right) = N \\delta_{k, m \\pmod N}.\n$$\n这意味着单个复指数 $\\exp\\left(i\\frac{2\\pi m n}{N}\\right)$ 的 DFT 仅在满足 $k = m \\pmod N$ 的离散波数 $k$ 处非零。当它非零时，其值为 $N$。\n\n将此性质应用于我们 $f(\\lambda_n)$ 表达式中的每一项：\n1. 对于项 $\\frac{1}{2}\\exp\\left(i\\frac{2\\pi(5)n}{N}\\right)$，连续波数为 $m=5$。DFT 在 $k=5 \\pmod{16}$（即 $k=5$）时非零。系数为 $X_5 = \\frac{1}{2}N = \\frac{16}{2} = 8$。\n2. 对于项 $\\frac{1}{2}\\exp\\left(i\\frac{2\\pi(-5)n}{N}\\right)$，连续波数为 $m=-5$。DFT 在 $k=-5 \\pmod{16}$（即 $k=11$）时非零。系数为 $X_{11} = \\frac{1}{2}N = \\frac{16}{2} = 8$。\n3. 对于项 $\\frac{1}{2}\\exp\\left(i\\frac{2\\pi(7)n}{N}\\right)$，连续波数为 $m=7$。DFT 在 $k=7 \\pmod{16}$（即 $k=7$）时非零。系数为 $X_7 = \\frac{1}{2}N = \\frac{16}{2} = 8$。\n4. 对于项 $\\frac{1}{2}\\exp\\left(i\\frac{2\\pi(-7)n}{N}\\right)$，连续波数为 $m=-7$。DFT 在 $k=-7 \\pmod{16}$（即 $k=9$）时非零。系数为 $X_9 = \\frac{1}{2}N = \\frac{16}{2} = 8$。\n\n对于 $k \\in \\{0, 1, \\dots, 15\\}$，所有其他系数 $X_k$ 均为零。该函数没有平均分量，因此 $X_0=0$。\n\n得到的谱是一个包含16个系数的向量，在 $k=5, 7, 9, 11$ 处有非零值。\n$X_0 = 0, X_1 = 0, X_2 = 0, X_3 = 0, X_4 = 0, X_5 = 8, X_6 = 0, X_7 = 8, X_8 = 0, X_9 = 8, X_{10} = 0, X_{11} = 8, X_{12} = 0, X_{13} = 0, X_{14} = 0, X_{15} = 0$。\n\n总结来说，离散模态 $k=9$（大于 $k_{\\mathrm{Nyq}}=8$）是来自连续波数 $m=9$ 的贡献的混叠表示，在网格上它被解释为其混叠别名 $m'=-7$。对称地，离散模态 $k=7$ 代表了来自 $m=-9$ 的贡献，它混叠为 $m'=7$。离散模态 $k=5$ 和 $k=11$ 分别正确地代表了可分辨的连续波数 $m=5$ 和 $m=-5$。\n最终的谱代表了混叠后的函数 $\\cos(5\\lambda) + \\cos(7\\lambda)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  0  0  0  0  8  0  8  0  8  0  8  0  0  0  0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "全球大气模型需要自然适用于球面的基函数。球谐函数正是扮演了这一角色，它将傅里叶分析的原理从圆形域扩展到球面。最后的这个练习提供了一个具体的动手实践机会，您将根据其数学定义构建一个特定的球谐函数，并验证其正交性的基本属性，从而揭开这些全球建模基本工具的神秘面纱 。",
            "id": "4044962",
            "problem": "在用于数值天气预报和气候模拟的全球谱动力核心中，球体上的标量场（例如位势高度）在复球谐函数基中展开。采用以下归一化约定：复球谐函数 $Y_{\\ell,m}(\\theta,\\phi)$ 在单位球面上关于面元 $d\\Omega = \\sin(\\theta)\\,d\\theta\\,d\\phi$ 是标准正交的，并且连带勒让德函数 $P_{\\ell}^{m}(x)$ 包含Condon–Shortley相位。角度 $\\theta$ 和 $\\phi$ 以弧度为单位。仅使用与此约定一致的基本定义和性质，计算 $Y_{2,1}(\\theta,\\phi)$ 的显式解析表达式，并通过计算积分\n$$\n\\int_{0}^{2\\pi}\\int_{0}^{\\pi} Y_{2,1}(\\theta,\\phi)^{*}\\,Y_{2,0}(\\theta,\\phi)\\,\\sin(\\theta)\\,d\\theta\\,d\\phi.\n$$\n来验证其与 $Y_{2,0}(\\theta,\\phi)$ 的正交性。\n请将显式函数 $Y_{2,1}(\\theta,\\phi)$ 和积分的精确值作为您的最终答案报告。角度必须以弧度为单位，无需单位。",
            "solution": "该问题是有效的。它具有科学依据，提法恰当，客观，并且包含所有必要信息，可以根据数学物理的基本原理，特别是球谐函数理论，推导出唯一的解。\n\n该问题要求得到两个结果：复球谐函数 $Y_{2,1}(\\theta,\\phi)$ 的显式解析表达式，以及正交性积分 $\\int_{0}^{2\\pi}\\int_{0}^{\\pi} Y_{2,1}(\\theta,\\phi)^{*}\\,Y_{2,0}(\\theta,\\phi)\\,\\sin(\\theta)\\,d\\theta\\,d\\phi$ 的值。\n\n复球谐函数 $Y_{\\ell,m}(\\theta, \\phi)$ 在球面上形成一个标准正交基，满足以下关系式：\n$$\n\\int_{0}^{2\\pi}\\int_{0}^{\\pi} Y_{\\ell,m}(\\theta,\\phi)^{*}\\,Y_{\\ell',m'}(\\theta,\\phi)\\,\\sin(\\theta)\\,d\\theta\\,d\\phi = \\delta_{\\ell\\ell'}\\delta_{mm'}\n$$\n其中 $\\delta_{ij}$ 是克罗内克（Kronecker）δ。该问题要求在 $(\\ell,m) = (2,1)$ 和 $(\\ell',m') = (2,0)$ 的特定情况下验证此性质。\n\n与指定的标准正交性一致、且包含Condon-Shortley相位的球谐函数，其常见定义为：\n$$\nY_{\\ell,m}(\\theta, \\phi) = (-1)^m \\sqrt{\\frac{2\\ell+1}{4\\pi} \\frac{(\\ell-m)!}{(\\ell+m)!}} P_{\\ell}^{m}(\\cos\\theta) e^{im\\phi} \\quad \\text{对于 } m \\ge 0\n$$\n对于 $m  0$，$Y_{\\ell,m}(\\theta, \\phi) = (-1)^m (Y_{\\ell,-m}(\\theta,\\phi))^*$。对于 $m \\ge 0$ 的连带勒让德函数 $P_{\\ell}^{m}(x)$ 的相应定义是：\n$$\nP_{\\ell}^{m}(x) = (1-x^2)^{m/2} \\frac{d^m}{dx^m} P_{\\ell}(x)\n$$\n其中 $P_{\\ell}(x)$ 是勒让德（Legendre）多项式。\n\n首先，我们计算 $Y_{2,1}(\\theta,\\phi)$ 的显式表达式。这里，$\\ell=2$ 且 $m=1$。\n预因子中的归一化常数部分是：\n$$\n\\sqrt{\\frac{2(2)+1}{4\\pi} \\frac{(2-1)!}{(2+1)!}} = \\sqrt{\\frac{5}{4\\pi} \\frac{1!}{3!}} = \\sqrt{\\frac{5}{4\\pi \\cdot 6}} = \\sqrt{\\frac{5}{24\\pi}}\n$$\n对于 $\\ell=2$ 的勒让德多项式是 $P_2(x) = \\frac{1}{2}(3x^2 - 1)$。\n连带勒让德函数 $P_2^1(x)$ 是：\n$$\nP_2^1(x) = (1-x^2)^{1/2} \\frac{d}{dx}P_2(x) = (1-x^2)^{1/2} \\frac{d}{dx}\\left(\\frac{1}{2}(3x^2-1)\\right) = (1-x^2)^{1/2} (3x)\n$$\n代入 $x = \\cos\\theta$：\n$$\nP_2^1(\\cos\\theta) = (1-\\cos^2\\theta)^{1/2} (3\\cos\\theta) = \\sin\\theta (3\\cos\\theta) = 3\\sin\\theta\\cos\\theta\n$$\n将这些部分组合成 $Y_{2,1}(\\theta,\\phi)$，包括Condon-Shortley相因子 $(-1)^1 = -1$：\n$$\nY_{2,1}(\\theta,\\phi) = (-1) \\left(\\sqrt{\\frac{5}{24\\pi}}\\right) (3\\sin\\theta\\cos\\theta) e^{i\\phi}\n$$\n$$\nY_{2,1}(\\theta,\\phi) = -3\\sqrt{\\frac{5}{24\\pi}} \\sin\\theta\\cos\\theta e^{i\\phi}\n$$\n为了简化常数，我们将 $3$ 移入平方根内：\n$$\n-3\\sqrt{\\frac{5}{24\\pi}} = -\\sqrt{\\frac{9 \\cdot 5}{24\\pi}} = -\\sqrt{\\frac{45}{24\\pi}} = -\\sqrt{\\frac{15}{8\\pi}}\n$$\n因此，$Y_{2,1}(\\theta, \\phi)$ 的显式表达式是：\n$$\nY_{2,1}(\\theta,\\phi) = -\\sqrt{\\frac{15}{8\\pi}} \\sin\\theta\\cos\\theta e^{i\\phi}\n$$\n\n接下来，我们计算正交性积分。这需要 $Y_{2,0}(\\theta, \\phi)$ 的表达式。这里，$\\ell=2$ 且 $m=0$。\nCondon-Shortley相因子是 $(-1)^0 = 1$。\n归一化常数部分是：\n$$\n\\sqrt{\\frac{2(2)+1}{4\\pi} \\frac{(2-0)!}{(2+0)!}} = \\sqrt{\\frac{5}{4\\pi} \\frac{2!}{2!}} = \\sqrt{\\frac{5}{4\\pi}}\n$$\n连带勒让德函数是 $P_2^0(x) = P_2(x) = \\frac{1}{2}(3x^2-1)$。\n当 $x=\\cos\\theta$ 时，$P_2^0(\\cos\\theta) = \\frac{1}{2}(3\\cos^2\\theta - 1)$。\n将这些部分组合起来得到：\n$$\nY_{2,0}(\\theta,\\phi) = \\sqrt{\\frac{5}{4\\pi}} \\left(\\frac{1}{2}(3\\cos^2\\theta-1)\\right) e^{i(0)\\phi} = \\sqrt{\\frac{5}{16\\pi}} (3\\cos^2\\theta - 1)\n$$\n需要计算的积分是 $I = \\int_{0}^{2\\pi}\\int_{0}^{\\pi} Y_{2,1}(\\theta,\\phi)^{*}\\,Y_{2,0}(\\theta,\\phi)\\,\\sin(\\theta)\\,d\\theta\\,d\\phi$。\n$Y_{2,1}(\\theta, \\phi)$ 的复共轭是：\n$$\nY_{2,1}(\\theta,\\phi)^* = \\left(-\\sqrt{\\frac{15}{8\\pi}} \\sin\\theta\\cos\\theta e^{i\\phi}\\right)^* = -\\sqrt{\\frac{15}{8\\pi}} \\sin\\theta\\cos\\theta e^{-i\\phi}\n$$\n被积函数是 $Y_{2,1}^* Y_{2,0} \\sin\\theta$ 的乘积：\n$$\n\\left(-\\sqrt{\\frac{15}{8\\pi}} \\sin\\theta\\cos\\theta e^{-i\\phi}\\right) \\left(\\sqrt{\\frac{5}{16\\pi}} (3\\cos^2\\theta - 1)\\right) \\sin\\theta\n$$\n我们收集常数项并分离变量：\n$$\nI = -\\sqrt{\\frac{15}{8\\pi}}\\sqrt{\\frac{5}{16\\pi}} \\int_{0}^{2\\pi}\\int_{0}^{\\pi} e^{-i\\phi} (\\sin\\theta\\cos\\theta (3\\cos^2\\theta - 1) \\sin\\theta) \\,d\\theta\\,d\\phi\n$$\n该积分可以分离成一个依赖于 $\\phi$ 的部分和一个依赖于 $\\theta$ 的部分：\n$$\nI = \\left(-\\sqrt{\\frac{75}{128\\pi^2}}\\right) \\left( \\int_{0}^{2\\pi} e^{-i\\phi} d\\phi \\right) \\left( \\int_{0}^{\\pi} \\sin^2\\theta\\cos\\theta(3\\cos^2\\theta-1) d\\theta \\right)\n$$\n我们计算关于 $\\phi$ 的积分：\n$$\n\\int_{0}^{2\\pi} e^{-i\\phi} d\\phi = \\left[ \\frac{e^{-i\\phi}}{-i} \\right]_{0}^{2\\pi} = \\frac{e^{-i2\\pi} - e^0}{-i} = \\frac{\\cos(2\\pi) - i\\sin(2\\pi) - 1}{-i} = \\frac{1 - 0 - 1}{-i} = 0\n$$\n由于乘积中的一个因子是 $0$，整个积分 $I$ 必须为 $0$：\n$$\nI = \\left(-\\sqrt{\\frac{75}{128\\pi^2}}\\right) \\cdot 0 \\cdot \\left( \\int_{0}^{\\pi} \\sin^2\\theta\\cos\\theta(3\\cos^2\\theta-1) d\\theta \\right) = 0\n$$\n这个结果证实了这两个球谐函数的正交性，正如从一般理论所预期的那样。\n\n最终答案的两个部分是函数 $Y_{2,1}(\\theta,\\phi)$ 和积分的值。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\sqrt{\\frac{15}{8\\pi}} \\sin\\theta \\cos\\theta \\exp(i\\phi)  0\n\\end{pmatrix}\n}\n$$"
        }
    ]
}