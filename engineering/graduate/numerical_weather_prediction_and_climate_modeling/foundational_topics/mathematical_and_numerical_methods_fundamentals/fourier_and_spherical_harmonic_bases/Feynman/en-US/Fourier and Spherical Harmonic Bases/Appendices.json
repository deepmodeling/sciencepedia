{
    "hands_on_practices": [
        {
            "introduction": "In spectral atmospheric models, physical fields are represented as a sum of basis functions. For the longitudinal direction, the natural choice is the Fourier series. This first exercise provides practice in translating a simple wave field, expressed in familiar sines and cosines, into the complex exponential form used in models. By working through this problem , you will solidify your understanding of how real-world wave amplitude and phase are encoded within the magnitude and argument of complex Fourier coefficients, a crucial skill for interpreting spectral data.",
            "id": "4044958",
            "problem": "Consider a zonally periodic scalar field along longitude, represented as a function $f(\\lambda)$ with $\\lambda \\in [0,2\\pi)$ in radians. In global spectral models used for numerical weather prediction and climate modeling, the longitudinal dependence of fields is expanded in complex Fourier modes while the latitudinal dependence is treated with spherical harmonics. The complex Fourier series of a $2\\pi$-periodic function is defined by\n$$\nf(\\lambda) = \\sum_{k\\in\\mathbb{Z}} \\hat{f}_{k}\\,\\exp(i k \\lambda),\n\\quad\n\\hat{f}_{k} = \\frac{1}{2\\pi}\\int_{0}^{2\\pi} f(\\lambda)\\,\\exp(-i k \\lambda)\\,\\mathrm{d}\\lambda,\n$$\nwhere $i$ is the imaginary unit and the orthogonality of $\\exp(i k \\lambda)$ over $[0,2\\pi)$ underpins the spectral decomposition. Let\n$$\nf(\\lambda) = \\sin(3\\lambda) + \\frac{1}{2}\\cos(2\\lambda).\n$$\nStarting from the definitions above and using only well-established identities such as the Euler formulas $\\exp(i\\theta)=\\cos\\theta+i\\sin\\theta$, $\\cos\\theta=\\frac{1}{2}\\big(\\exp(i\\theta)+\\exp(-i\\theta)\\big)$, and $\\sin\\theta=\\frac{1}{2i}\\big(\\exp(i\\theta)-\\exp(-i\\theta)\\big)$, do the following:\n- Derive the nonzero complex Fourier coefficients $\\hat{f}_{k}$ of $f(\\lambda)$.\n- Reconstruct $f(\\lambda)$ from these $\\hat{f}_{k}$ to verify consistency.\n- Explain how the amplitudes and phases of the real trigonometric components are encoded in the complex coefficients for the nonzero zonal wavenumbers.\n\nExpress angles in radians. Report your final answer as the ordered row vector of the nonzero coefficients $(\\hat{f}_{-3},\\,\\hat{f}_{-2},\\,\\hat{f}_{2},\\,\\hat{f}_{3})$ using the $\\mathrm{pmatrix}$ environment. No rounding is required.",
            "solution": "The problem is to find the nonzero complex Fourier coefficients for a given scalar field, verify the result by reconstruction, and explain how the real wave properties are encoded in these coefficients. The given scalar field is $f(\\lambda) = \\sin(3\\lambda) + \\frac{1}{2}\\cos(2\\lambda)$, where $\\lambda \\in [0, 2\\pi)$ is the longitude in radians.\n\nThe analysis is based on the complex Fourier series representation of a $2\\pi$-periodic function:\n$$f(\\lambda) = \\sum_{k\\in\\mathbb{Z}} \\hat{f}_{k}\\,\\exp(i k \\lambda)$$\nwhere the coefficients $\\hat{f}_{k}$ are given by the projection integral:\n$$\\hat{f}_{k} = \\frac{1}{2\\pi}\\int_{0}^{2\\pi} f(\\lambda)\\,\\exp(-i k \\lambda)\\,\\mathrm{d}\\lambda$$\n\nThe first task is to find the nonzero coefficients $\\hat{f}_{k}$. Instead of direct integration, we can use the provided Euler identities to express $f(\\lambda)$ in terms of complex exponentials and then identify the coefficients by comparing the resulting expression with the definition of the Fourier series.\n\nThe relevant Euler identities are:\n$$\\cos\\theta = \\frac{1}{2}\\big(\\exp(i\\theta)+\\exp(-i\\theta)\\big)$$\n$$\\sin\\theta = \\frac{1}{2i}\\big(\\exp(i\\theta)-\\exp(-i\\theta)\\big) = -\\frac{i}{2}\\big(\\exp(i\\theta)-\\exp(-i\\theta)\\big)$$\nsince $\\frac{1}{i} = -i$.\n\nWe substitute these identities into the expression for $f(\\lambda)$:\n$$f(\\lambda) = \\left( -\\frac{i}{2}\\big(\\exp(i3\\lambda)-\\exp(-i3\\lambda)\\big) \\right) + \\frac{1}{2}\\left( \\frac{1}{2}\\big(\\exp(i2\\lambda)+\\exp(-i2\\lambda)\\big) \\right)$$\nDistributing the terms, we get:\n$$f(\\lambda) = -\\frac{i}{2}\\exp(i3\\lambda) + \\frac{i}{2}\\exp(-i3\\lambda) + \\frac{1}{4}\\exp(i2\\lambda) + \\frac{1}{4}\\exp(-i2\\lambda)$$\nTo match this with the Fourier series form $f(\\lambda) = \\sum_{k\\in\\mathbb{Z}} \\hat{f}_{k}\\,\\exp(i k \\lambda)$, we rearrange the terms in order of increasing zonal wavenumber $k$:\n$$f(\\lambda) = \\left(\\frac{i}{2}\\right)\\exp(i(-3)\\lambda) + \\left(\\frac{1}{4}\\right)\\exp(i(-2)\\lambda) + \\left(\\frac{1}{4}\\right)\\exp(i(2)\\lambda) + \\left(-\\frac{i}{2}\\right)\\exp(i(3)\\lambda)$$\nBy direct comparison of the coefficients of the $\\exp(ik\\lambda)$ terms, we can identify the nonzero Fourier coefficients:\n- For $k = -3$: $\\hat{f}_{-3} = \\frac{i}{2}$\n- For $k = -2$: $\\hat{f}_{-2} = \\frac{1}{4}$\n- For $k = 2$: $\\hat{f}_{2} = \\frac{1}{4}$\n- For $k = 3$: $\\hat{f}_{3} = -\\frac{i}{2}$\nAll other coefficients $\\hat{f}_{k}$ for $k \\notin \\{-3, -2, 2, 3\\}$ are zero. Note that for this real-valued function $f(\\lambda)$, the coefficients satisfy the property $\\hat{f}_{-k} = \\overline{\\hat{f}_{k}}$ (the complex conjugate), as expected. For $k=2$, $\\hat{f}_{-2} = \\frac{1}{4}$ and $\\overline{\\hat{f}_2} = \\overline{\\frac{1}{4}} = \\frac{1}{4}$. For $k=3$, $\\hat{f}_{-3} = \\frac{i}{2}$ and $\\overline{\\hat{f}_3} = \\overline{-\\frac{i}{2}} = \\frac{i}{2}$.\n\nThe second task is to reconstruct $f(\\lambda)$ from these coefficients to verify consistency. We sum the components corresponding to the nonzero coefficients:\n$$f(\\lambda) = \\hat{f}_{-3}\\exp(-i3\\lambda) + \\hat{f}_{-2}\\exp(-i2\\lambda) + \\hat{f}_{2}\\exp(i2\\lambda) + \\hat{f}_{3}\\exp(i3\\lambda)$$\nSubstituting the values we found:\n$$f(\\lambda) = \\frac{i}{2}\\exp(-i3\\lambda) + \\frac{1}{4}\\exp(-i2\\lambda) + \\frac{1}{4}\\exp(i2\\lambda) - \\frac{i}{2}\\exp(i3\\lambda)$$\nWe group the terms with the same magnitude of wavenumber $|k|$:\n$$f(\\lambda) = \\left( \\frac{1}{4}\\exp(i2\\lambda) + \\frac{1}{4}\\exp(-i2\\lambda) \\right) + \\left( -\\frac{i}{2}\\exp(i3\\lambda) + \\frac{i}{2}\\exp(-i3\\lambda) \\right)$$\nFactoring out common terms:\n$$f(\\lambda) = \\frac{1}{2} \\left( \\frac{\\exp(i2\\lambda) + \\exp(-i2\\lambda)}{2} \\right) + \\left( \\frac{\\exp(i3\\lambda) - \\exp(-i3\\lambda)}{2i} \\right)$$\nUsing the Euler identities in reverse, we recognize the expressions for $\\cos(2\\lambda)$ and $\\sin(3\\lambda)$:\n$$f(\\lambda) = \\frac{1}{2}\\cos(2\\lambda) + \\sin(3\\lambda)$$\nThis is identical to the original function, confirming the correctness of the derived coefficients.\n\nThe third task is to explain how the amplitudes and phases of the real trigonometric components are encoded in the complex coefficients. Consider a general real wave component for a specific positive wavenumber $k > 0$, written as $A_k\\cos(k\\lambda) + B_k\\sin(k\\lambda)$. Using Euler's identities, this component can be expressed as:\n$$A_k \\frac{\\exp(ik\\lambda)+\\exp(-ik\\lambda)}{2} + B_k \\frac{\\exp(ik\\lambda)-\\exp(-ik\\lambda)}{2i}$$\n$$ = \\frac{A_k}{2}(\\exp(ik\\lambda)+\\exp(-ik\\lambda)) - \\frac{iB_k}{2}(\\exp(ik\\lambda)-\\exp(-ik\\lambda))$$\nGrouping terms by $\\exp(ik\\lambda)$ and $\\exp(-ik\\lambda)$:\n$$ = \\left(\\frac{A_k - iB_k}{2}\\right)\\exp(ik\\lambda) + \\left(\\frac{A_k + iB_k}{2}\\right)\\exp(-ik\\lambda)$$\nBy comparison with the Fourier series terms $\\hat{f}_{k}\\exp(ik\\lambda) + \\hat{f}_{-k}\\exp(-ik\\lambda)$, we find:\n$$\\hat{f}_{k} = \\frac{A_k - iB_k}{2} \\quad \\text{and} \\quad \\hat{f}_{-k} = \\frac{A_k + iB_k}{2} = \\overline{\\hat{f}_{k}}$$\nThe amplitude $C_k$ of the real wave component $C_k\\cos(k\\lambda - \\phi_k) = A_k\\cos(k\\lambda) + B_k\\sin(k\\lambda)$ is $C_k = \\sqrt{A_k^2 + B_k^2}$. The magnitude of the complex coefficient $\\hat{f}_k$ is:\n$$|\\hat{f}_{k}| = \\left|\\frac{A_k - iB_k}{2}\\right| = \\frac{1}{2}\\sqrt{A_k^2 + (-B_k)^2} = \\frac{1}{2}\\sqrt{A_k^2 + B_k^2} = \\frac{C_k}{2}$$\nThus, the amplitude of the real wave is twice the magnitude of the complex Fourier coefficient for the positive wavenumber: $C_k = 2|\\hat{f}_{k}|$.\n\nThe phase $\\phi_k$ is given by $\\phi_k = \\arctan(B_k/A_k)$. The argument (phase) of the complex coefficient $\\hat{f}_k$ is:\n$$\\arg(\\hat{f}_{k}) = \\arg\\left(\\frac{A_k}{2} - i\\frac{B_k}{2}\\right) = \\arctan\\left(\\frac{-B_k/2}{A_k/2}\\right) = \\arctan\\left(-\\frac{B_k}{A_k}\\right) = -\\phi_k$$\nThus, the phase of the real wave is the negative of the argument of the complex Fourier coefficient: $\\phi_k = -\\arg(\\hat{f}_{k})$.\n\nApplying this to our problem:\n- For wavenumber $k=2$, the real component is $\\frac{1}{2}\\cos(2\\lambda)$. Here, $A_2 = \\frac{1}{2}$ and $B_2=0$. The amplitude is $C_2=\\frac{1}{2}$ and the phase is $\\phi_2=0$. The complex coefficient is $\\hat{f}_{2} = \\frac{1}{4}$.\n  - Amplitude check: $2|\\hat{f}_{2}| = 2\\left|\\frac{1}{4}\\right| = \\frac{1}{2} = C_2$.\n  - Phase check: $-\\arg(\\hat{f}_{2}) = -\\arg\\left(\\frac{1}{4}\\right) = -0 = 0 = \\phi_2$.\n- For wavenumber $k=3$, the real component is $\\sin(3\\lambda)$. Here, $A_3 = 0$ and $B_3=1$. This can be written as $1 \\cdot \\cos(3\\lambda - \\pi/2)$. The amplitude is $C_3=1$ and the phase is $\\phi_3=\\pi/2$. The complex coefficient is $\\hat{f}_{3} = -\\frac{i}{2}$.\n  - Amplitude check: $2|\\hat{f}_{3}| = 2\\left|-\\frac{i}{2}\\right| = 2 \\cdot \\frac{1}{2} = 1 = C_3$.\n  - Phase check: $-\\arg(\\hat{f}_{3}) = -\\arg\\left(-\\frac{i}{2}\\right) = -(-\\pi/2) = \\pi/2 = \\phi_3$.\n\nThe analysis confirms that for a positive wavenumber $k$, the amplitude and phase of the corresponding real wave are encoded in the magnitude and argument of the single complex coefficient $\\hat{f}_k$. The coefficient $\\hat{f}_{-k}$ is redundant for a real signal as it is just the complex conjugate of $\\hat{f}_k$.\n\nThe final answer is the ordered row vector of the nonzero coefficients $(\\hat{f}_{-3},\\,\\hat{f}_{-2},\\,\\hat{f}_{2},\\,\\hat{f}_{3})$.\n- $\\hat{f}_{-3} = \\frac{i}{2}$\n- $\\hat{f}_{-2} = \\frac{1}{4}$\n- $\\hat{f}_{2} = \\frac{1}{4}$\n- $\\hat{f}_{3} = -\\frac{i}{2}$",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{i}{2} & \\frac{1}{4} & \\frac{1}{4} & -\\frac{i}{2} \\end{pmatrix}}$$"
        },
        {
            "introduction": "While Fourier series are perfect for periodic phenomena on a circle, modeling fields on the entire globe requires a basis set suitable for the sphere: the spherical harmonics, $Y_{\\ell,m}$. This exercise moves from theory to practice by having you construct a specific spherical harmonic from its fundamental definition. Furthermore, by explicitly verifying the orthogonality property through integration , you will gain a deeper appreciation for how these functions allow any scalar field on the sphere to be decomposed into a unique set of spectral coefficients.",
            "id": "4044962",
            "problem": "In global spectral dynamical cores used in numerical weather prediction and climate modeling, scalar fields on the sphere (e.g., geopotential height) are expanded in complex spherical harmonic bases. Adopt the following normalization convention: complex spherical harmonics $Y_{\\ell,m}(\\theta,\\phi)$ are orthonormal on the unit sphere with respect to the surface element $d\\Omega = \\sin(\\theta)\\,d\\theta\\,d\\phi$, and the associated Legendre functions $P_{\\ell}^{m}(x)$ include the Condonâ€“Shortley phase. Angles $\\theta$ and $\\phi$ are measured in radians. Using only fundamental definitions and properties consistent with this convention, compute the explicit analytic expression for $Y_{2,1}(\\theta,\\phi)$ and verify its orthogonality to $Y_{2,0}(\\theta,\\phi)$ by evaluating the integral\n$$\n\\int_{0}^{2\\pi}\\int_{0}^{\\pi} Y_{2,1}(\\theta,\\phi)^{*}\\,Y_{2,0}(\\theta,\\phi)\\,\\sin(\\theta)\\,d\\theta\\,d\\phi.\n$$\nReport both the explicit function $Y_{2,1}(\\theta,\\phi)$ and the exact value of the integral as your final answer. Angles must be in radians, and no units are required.",
            "solution": "The problem is valid. It is scientifically grounded, well-posed, objective, and contains all necessary information to derive a unique solution based on the fundamental principles of mathematical physics, specifically the theory of spherical harmonics.\n\nThe problem asks for two results: the explicit analytic expression for the complex spherical harmonic $Y_{2,1}(\\theta,\\phi)$ and the value of the orthogonality integral $\\int_{0}^{2\\pi}\\int_{0}^{\\pi} Y_{2,1}(\\theta,\\phi)^{*}\\,Y_{2,0}(\\theta,\\phi)\\,\\sin(\\theta)\\,d\\theta\\,d\\phi$.\n\nThe complex spherical harmonics $Y_{\\ell,m}(\\theta, \\phi)$ form an orthonormal basis on the surface of a sphere, satisfying the relation:\n$$\n\\int_{0}^{2\\pi}\\int_{0}^{\\pi} Y_{\\ell,m}(\\theta,\\phi)^{*}\\,Y_{\\ell',m'}(\\theta,\\phi)\\,\\sin(\\theta)\\,d\\theta\\,d\\phi = \\delta_{\\ell\\ell'}\\delta_{mm'}\n$$\nwhere $\\delta_{ij}$ is the Kronecker delta. The problem asks to verify this property for the specific case of $(\\ell,m) = (2,1)$ and $(\\ell',m') = (2,0)$.\n\nA common definition for the spherical harmonics that incorporates the Condon-Shortley phase, consistent with the specified orthonormality, is:\n$$\nY_{\\ell,m}(\\theta, \\phi) = (-1)^m \\sqrt{\\frac{2\\ell+1}{4\\pi} \\frac{(\\ell-m)!}{(\\ell+m)!}} P_{\\ell}^{m}(\\cos\\theta) e^{im\\phi} \\quad \\text{for } m \\ge 0\n$$\nAnd for $m < 0$, $Y_{\\ell,m}(\\theta, \\phi) = (-1)^m (Y_{\\ell,-m}(\\theta,\\phi))^*$. The acompanying definition for the associated Legendre functions $P_{\\ell}^{m}(x)$ for $m \\ge 0$ is:\n$$\nP_{\\ell}^{m}(x) = (1-x^2)^{m/2} \\frac{d^m}{dx^m} P_{\\ell}(x)\n$$\nwhere $P_{\\ell}(x)$ are the Legendre polynomials.\n\nFirst, we compute the explicit expression for $Y_{2,1}(\\theta,\\phi)$. Here, $\\ell=2$ and $m=1$.\nThe normalization constant part of the prefactor is:\n$$\n\\sqrt{\\frac{2(2)+1}{4\\pi} \\frac{(2-1)!}{(2+1)!}} = \\sqrt{\\frac{5}{4\\pi} \\frac{1!}{3!}} = \\sqrt{\\frac{5}{4\\pi \\cdot 6}} = \\sqrt{\\frac{5}{24\\pi}}\n$$\nThe Legendre polynomial for $\\ell=2$ is $P_2(x) = \\frac{1}{2}(3x^2 - 1)$.\nThe associated Legendre function $P_2^1(x)$ is:\n$$\nP_2^1(x) = (1-x^2)^{1/2} \\frac{d}{dx}P_2(x) = (1-x^2)^{1/2} \\frac{d}{dx}\\left(\\frac{1}{2}(3x^2-1)\\right) = (1-x^2)^{1/2} (3x)\n$$\nSubstituting $x = \\cos\\theta$:\n$$\nP_2^1(\\cos\\theta) = (1-\\cos^2\\theta)^{1/2} (3\\cos\\theta) = \\sin\\theta (3\\cos\\theta) = 3\\sin\\theta\\cos\\theta\n$$\nCombining these parts to form $Y_{2,1}(\\theta,\\phi)$, including the Condon-Shortley phase factor $(-1)^1 = -1$:\n$$\nY_{2,1}(\\theta,\\phi) = (-1) \\left(\\sqrt{\\frac{5}{24\\pi}}\\right) (3\\sin\\theta\\cos\\theta) e^{i\\phi}\n$$\n$$\nY_{2,1}(\\theta,\\phi) = -3\\sqrt{\\frac{5}{24\\pi}} \\sin\\theta\\cos\\theta e^{i\\phi}\n$$\nTo simplify the constant, we bring the $3$ inside the square root:\n$$\n-3\\sqrt{\\frac{5}{24\\pi}} = -\\sqrt{\\frac{9 \\cdot 5}{24\\pi}} = -\\sqrt{\\frac{45}{24\\pi}} = -\\sqrt{\\frac{15}{8\\pi}}\n$$\nThus, the explicit expression for $Y_{2,1}(\\theta, \\phi)$ is:\n$$\nY_{2,1}(\\theta,\\phi) = -\\sqrt{\\frac{15}{8\\pi}} \\sin\\theta\\cos\\theta e^{i\\phi}\n$$\n\nNext, we evaluate the orthogonality integral. This requires the expression for $Y_{2,0}(\\theta, \\phi)$. Here, $\\ell=2$ and $m=0$.\nThe Condon-Shortley phase factor is $(-1)^0 = 1$.\nThe normalization constant part is:\n$$\n\\sqrt{\\frac{2(2)+1}{4\\pi} \\frac{(2-0)!}{(2+0)!}} = \\sqrt{\\frac{5}{4\\pi} \\frac{2!}{2!}} = \\sqrt{\\frac{5}{4\\pi}}\n$$\nThe associated Legendre function is $P_2^0(x) = P_2(x) = \\frac{1}{2}(3x^2-1)$.\nWith $x=\\cos\\theta$, $P_2^0(\\cos\\theta) = \\frac{1}{2}(3\\cos^2\\theta - 1)$.\nCombining these parts gives:\n$$\nY_{2,0}(\\theta,\\phi) = \\sqrt{\\frac{5}{4\\pi}} \\left(\\frac{1}{2}(3\\cos^2\\theta-1)\\right) e^{i(0)\\phi} = \\sqrt{\\frac{5}{16\\pi}} (3\\cos^2\\theta - 1)\n$$\nThe integral to evaluate is $I = \\int_{0}^{2\\pi}\\int_{0}^{\\pi} Y_{2,1}(\\theta,\\phi)^{*}\\,Y_{2,0}(\\theta,\\phi)\\,\\sin(\\theta)\\,d\\theta\\,d\\phi$.\nThe complex conjugate of $Y_{2,1}(\\theta, \\phi)$ is:\n$$\nY_{2,1}(\\theta,\\phi)^* = \\left(-\\sqrt{\\frac{15}{8\\pi}} \\sin\\theta\\cos\\theta e^{i\\phi}\\right)^* = -\\sqrt{\\frac{15}{8\\pi}} \\sin\\theta\\cos\\theta e^{-i\\phi}\n$$\nThe integrand is the product $Y_{2,1}^* Y_{2,0} \\sin\\theta$:\n$$\n\\left(-\\sqrt{\\frac{15}{8\\pi}} \\sin\\theta\\cos\\theta e^{-i\\phi}\\right) \\left(\\sqrt{\\frac{5}{16\\pi}} (3\\cos^2\\theta - 1)\\right) \\sin\\theta\n$$\nLet's collect the constant terms and separate the variables:\n$$\nI = -\\sqrt{\\frac{15}{8\\pi}}\\sqrt{\\frac{5}{16\\pi}} \\int_{0}^{2\\pi}\\int_{0}^{\\pi} e^{-i\\phi} (\\sin\\theta\\cos\\theta (3\\cos^2\\theta - 1) \\sin\\theta) \\,d\\theta\\,d\\phi\n$$\nThe integral can be separated into a part depending on $\\phi$ and a part depending on $\\theta$:\n$$\nI = \\left(-\\sqrt{\\frac{75}{128\\pi^2}}\\right) \\left( \\int_{0}^{2\\pi} e^{-i\\phi} d\\phi \\right) \\left( \\int_{0}^{\\pi} \\sin^2\\theta\\cos\\theta(3\\cos^2\\theta-1) d\\theta \\right)\n$$\nWe evaluate the integral with respect to $\\phi$:\n$$\n\\int_{0}^{2\\pi} e^{-i\\phi} d\\phi = \\left[ \\frac{e^{-i\\phi}}{-i} \\right]_{0}^{2\\pi} = \\frac{e^{-i2\\pi} - e^0}{-i} = \\frac{\\cos(2\\pi) - i\\sin(2\\pi) - 1}{-i} = \\frac{1 - 0 - 1}{-i} = 0\n$$\nSince one of the factors in the product is $0$, the entire integral $I$ must be $0$:\n$$\nI = \\left(-\\sqrt{\\frac{75}{128\\pi^2}}\\right) \\cdot 0 \\cdot \\left( \\int_{0}^{\\pi} \\sin^2\\theta\\cos\\theta(3\\cos^2\\theta-1) d\\theta \\right) = 0\n$$\nThis result confirms the orthogonality property for these two spherical harmonics, as expected from the general theory.\n\nThe two parts of the final answer are the function $Y_{2,1}(\\theta,\\phi)$ and the value of the integral.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\sqrt{\\frac{15}{8\\pi}} \\sin\\theta \\cos\\theta \\exp(i\\phi) & 0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "A spectral model's core does not work with continuous functions, but with their values on a discrete grid. This transition from the continuous to the discrete introduces important numerical phenomena, the most famous of which is aliasing. This problem  provides a hands-on demonstration of how a high-wavenumber wave, when sampled on a grid of insufficient resolution, can be mistaken for a completely different, lower-wavenumber wave. Mastering this concept is vital for understanding the limitations of spectral models and the rationale behind numerical techniques like the spectral transform method.",
            "id": "4044967",
            "problem": "Consider a zonally periodic scalar field on a sphere, representative of a prognostic variable in a spectral dynamical core for numerical weather prediction, restricted to a single latitude circle so that its longitudinal dependence can be analyzed using a Fourier basis. Let the longitude be denoted by $\\lambda \\in [0,2\\pi)$, and the field be\n$$\nf(\\lambda) = \\cos(5\\lambda) + \\cos(9\\lambda).\n$$\nAssume the field is sampled at $N=16$ equally spaced longitudes $\\lambda_n = \\frac{2\\pi n}{N}$ for $n=0,1,\\dots,15$. Define the Discrete Fourier Transform (DFT) by\n$$\nX_k = \\sum_{n=0}^{N-1} f(\\lambda_n)\\,\\exp\\!\\left(-i\\,\\frac{2\\pi k n}{N}\\right), \\quad k=0,1,\\dots,N-1,\n$$\nwith the inverse given by\n$$\nf(\\lambda_n) = \\frac{1}{N}\\sum_{k=0}^{N-1} X_k\\,\\exp\\!\\left(i\\,\\frac{2\\pi k n}{N}\\right).\n$$\nStarting from the fundamental definition of the Fourier basis on the circle and the sampling operation, derive the nonzero DFT coefficients $X_k$ of $f(\\lambda)$ at the specified sampling points. Then, using the definition of the Nyquist wavenumber $k_{\\mathrm{Nyq}} = \\frac{N}{2}$ and the discrete sampling symmetry on the circle, explain which continuous wavenumber contributions are aliased when interpreting modes with $k>k_{\\mathrm{Nyq}}$ on the discrete grid, and identify the corresponding aliased resolved wavenumbers.\n\nExpress your final spectrum as a single row matrix containing $X_0, X_1, \\dots, X_{15}$ (in that order). No rounding is required.",
            "solution": "The problem requires the calculation of the Discrete Fourier Transform (DFT) coefficients for a given function sampled on a discrete grid, and an explanation of the aliasing phenomenon involved.\n\nThe scalar field is given by\n$$\nf(\\lambda) = \\cos(5\\lambda) + \\cos(9\\lambda).\n$$\nUsing Euler's formula, $\\cos(\\theta) = \\frac{1}{2} (\\exp(i\\theta) + \\exp(-i\\theta))$, we can express the function as a sum of complex exponentials, which represent traveling waves:\n$$\nf(\\lambda) = \\frac{1}{2}\\left(\\exp(i5\\lambda) + \\exp(-i5\\lambda)\\right) + \\frac{1}{2}\\left(\\exp(i9\\lambda) + \\exp(-i9\\lambda)\\right).\n$$\nThis function is a superposition of waves with continuous wavenumbers $m = \\pm 5$ and $m = \\pm 9$.\n\nThe field is sampled at $N=16$ equally spaced points $\\lambda_n = \\frac{2\\pi n}{N}$ for $n=0, 1, \\dots, N-1$. The Nyquist sampling theorem states that to avoid aliasing, the magnitude of the highest wavenumber present in the signal, $m_{\\max}$, must be less than the Nyquist wavenumber, $k_{\\mathrm{Nyq}}$. The Nyquist wavenumber is defined as $k_{\\mathrm{Nyq}} = \\frac{N}{2}$. For this problem,\n$$\nk_{\\mathrm{Nyq}} = \\frac{16}{2} = 8.\n$$\nThe wavenumbers present in $f(\\lambda)$ are $m=\\pm 5$ and $m=\\pm 9$.\nThe wavenumber contribution from $\\cos(5\\lambda)$ has $|m|=5$. Since $|5| < k_{\\mathrm{Nyq}}$, this wave is resolved by the grid.\nThe wavenumber contribution from $\\cos(9\\lambda)$ has $|m|=9$. Since $|9| > k_{\\mathrm{Nyq}}$, this wave is undersampled and will be aliased.\n\nWe must determine how the wavenumber $m=9$ is represented on the discrete grid. A continuous wave $\\exp(im\\lambda)$ evaluated at the grid points $\\lambda_n$ is indistinguishable from a wave $\\exp(im'\\lambda)$ if $m' = m + jN$ for any integer $j$. This is because:\n$$\n\\exp(im'\\lambda_n) = \\exp(i(m+jN)\\lambda_n) = \\exp\\left(i(m+jN)\\frac{2\\pi n}{N}\\right) = \\exp\\left(i\\frac{2\\pi m n}{N}\\right) \\exp\\left(i\\frac{2\\pi j N n}{N}\\right) = \\exp(im\\lambda_n) \\exp(i2\\pi jn).\n$$\nSince $j$ and $n$ are integers, $\\exp(i2\\pi jn) = 1$. Thus, on the discrete grid, the continuous wavenumber $m=9$ is aliased to a resolved wavenumber $m'$ in the range $[-k_{\\mathrm{Nyq}}, k_{\\mathrm{Nyq}}]$. We find $m'$ by choosing $j=-1$:\n$$\nm' = 9 + (-1)N = 9 - 16 = -7.\n$$\nSimilarly, the continuous wavenumber $m=-9$ is aliased by choosing $j=1$:\n$$\nm' = -9 + (1)N = -9 + 16 = 7.\n$$\nTherefore, the samples of the $\\cos(9\\lambda)$ term are identical to the samples of the $\\cos(7\\lambda)$ term:\n$$\n\\cos(9\\lambda_n) = \\cos\\left(9\\frac{2\\pi n}{16}\\right) = \\cos\\left((16-7)\\frac{2\\pi n}{16}\\right) = \\cos\\left(2\\pi n - 7\\frac{2\\pi n}{16}\\right) = \\cos\\left(-7\\frac{2\\pi n}{16}\\right) = \\cos\\left(7\\frac{2\\pi n}{16}\\right) = \\cos(7\\lambda_n).\n$$\nThe continuous wave contribution from $\\cos(9\\lambda)$ is aliased to appear as $\\cos(7\\lambda)$ on the discrete grid. The undersampled wave masquerades as a lower-frequency wave.\n\nConsequently, the function evaluated at the sampling points, $f(\\lambda_n)$, is effectively\n$$\nf(\\lambda_n) = \\cos(5\\lambda_n) + \\cos(7\\lambda_n).\n$$\nWe now compute the DFT coefficients $X_k$ for this aliased function. First, we express $f(\\lambda_n)$ in complex exponential form:\n$$\nf(\\lambda_n) = \\frac{1}{2}\\left(\\exp(i5\\lambda_n) + \\exp(-i5\\lambda_n)\\right) + \\frac{1}{2}\\left(\\exp(i7\\lambda_n) + \\exp(-i7\\lambda_n)\\right).\n$$\nSubstitute $\\lambda_n = \\frac{2\\pi n}{N}$:\n$$\nf(\\lambda_n) = \\frac{1}{2}\\exp\\left(i\\frac{2\\pi(5)n}{N}\\right) + \\frac{1}{2}\\exp\\left(i\\frac{2\\pi(-5)n}{N}\\right) + \\frac{1}{2}\\exp\\left(i\\frac{2\\pi(7)n}{N}\\right) + \\frac{1}{2}\\exp\\left(i\\frac{2\\pi(-7)n}{N}\\right).\n$$\nThe DFT is defined as $X_k = \\sum_{n=0}^{N-1} f(\\lambda_n)\\,\\exp\\left(-i\\,\\frac{2\\pi k n}{N}\\right)$. A key property of the DFT is the orthogonality of the basis functions:\n$$\n\\sum_{n=0}^{N-1} \\exp\\left(i\\frac{2\\pi m n}{N}\\right) \\exp\\left(-i\\frac{2\\pi k n}{N}\\right) = \\sum_{n=0}^{N-1} \\exp\\left(i\\frac{2\\pi(m-k)n}{N}\\right) = N \\delta_{k, m \\pmod N}.\n$$\nThis means that the DFT of a single complex exponential $\\exp\\left(i\\frac{2\\pi m n}{N}\\right)$ is non-zero only at the discrete wavenumber $k$ which satisfies $k = m \\pmod N$. When it is non-zero, its value is $N$.\n\nApplying this to each term in our expression for $f(\\lambda_n)$:\n1. For the term $\\frac{1}{2}\\exp\\left(i\\frac{2\\pi(5)n}{N}\\right)$, the continuous wavenumber is $m=5$. The DFT is non-zero for $k=5 \\pmod{16}$, which is $k=5$. The coefficient is $X_5 = \\frac{1}{2}N = \\frac{16}{2} = 8$.\n2. For the term $\\frac{1}{2}\\exp\\left(i\\frac{2\\pi(-5)n}{N}\\right)$, the continuous wavenumber is $m=-5$. The DFT is non-zero for $k=-5 \\pmod{16}$, which is $k=11$. The coefficient is $X_{11} = \\frac{1}{2}N = \\frac{16}{2} = 8$.\n3. For the term $\\frac{1}{2}\\exp\\left(i\\frac{2\\pi(7)n}{N}\\right)$, the continuous wavenumber is $m=7$. The DFT is non-zero for $k=7 \\pmod{16}$, which is $k=7$. The coefficient is $X_7 = \\frac{1}{2}N = \\frac{16}{2} = 8$.\n4. For the term $\\frac{1}{2}\\exp\\left(i\\frac{2\\pi(-7)n}{N}\\right)$, the continuous wavenumber is $m=-7$. The DFT is non-zero for $k=-7 \\pmod{16}$, which is $k=9$. The coefficient is $X_9 = \\frac{1}{2}N = \\frac{16}{2} = 8$.\n\nAll other coefficients $X_k$ for $k \\in \\{0, 1, \\dots, 15\\}$ are zero. The function has no mean component, so $X_0=0$.\n\nThe resulting spectrum is a vector of $16$ coefficients, with non-zero values at $k=5, 7, 9, 11$.\n$X_0 = 0, X_1 = 0, X_2 = 0, X_3 = 0, X_4 = 0, X_5 = 8, X_6 = 0, X_7 = 8, X_8 = 0, X_9 = 8, X_{10} = 0, X_{11} = 8, X_{12} = 0, X_{13} = 0, X_{14} = 0, X_{15} = 0$.\n\nIn summary, the continuous wavenumber $m=9$ is undersampled and is aliased to the resolved wavenumber $m=7$ on the discrete grid. The signal effectively becomes $f(\\lambda_n) = \\cos(5\\lambda_n) + \\cos(7\\lambda_n)$. The DFT of this signal produces non-zero coefficients at $k=5, 11$ (from the $\\cos(5\\lambda)$ component) and $k=7, 9$ (from the $\\cos(7\\lambda)$ component).",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & 0 & 0 & 0 & 0 & 8 & 0 & 8 & 0 & 8 & 0 & 8 & 0 & 0 & 0 & 0\n\\end{pmatrix}\n}\n$$"
        }
    ]
}