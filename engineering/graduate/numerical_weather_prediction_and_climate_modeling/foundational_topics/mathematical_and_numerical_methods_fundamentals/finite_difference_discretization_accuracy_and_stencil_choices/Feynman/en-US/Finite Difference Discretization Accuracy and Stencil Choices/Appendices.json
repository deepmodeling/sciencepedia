{
    "hands_on_practices": [
        {
            "introduction": "High-accuracy schemes are essential in climate and weather modeling to reduce numerical errors over long integrations. This exercise guides you through the fundamental process of deriving a fourth-order accurate finite difference stencil for the Laplacian operator, $\\nabla^2$, using Taylor series expansions. Then, using Fourier analysis, you will determine the scheme's discrete eigenvalues, a key step in understanding its behavior and stability for different spatial scales.",
            "id": "4042504",
            "problem": "Consider a one-dimensional periodic zonal channel of length $L$ used in Numerical Weather Prediction (NWP) and climate modeling to represent horizontally homogeneous dynamics. Let the grid consist of $N$ equally spaced points with grid spacing $h = L/N$ and locations $x_{j} = j h$ for integer $j$. The continuous Laplacian in one dimension is $\\nabla^{2} u = \\frac{d^{2} u}{d x^{2}}$. You are asked to construct a fourth-order accurate finite difference discretization for $\\nabla^{2}$ on this grid and determine the discrete eigenvalues under periodic boundary conditions using Fourier modes.\n\nStarting from fundamental principles, use Taylor expansions about $x_{j}$ to derive a symmetric five-point stencil of the form\n$$\n\\mathcal{L}_{h} u_{j} \\equiv \\frac{a\\,u_{j-2} + b\\,u_{j-1} + c\\,u_{j} + b\\,u_{j+1} + a\\,u_{j+2}}{h^{2}},\n$$\nwhere $a$, $b$, and $c$ are constants to be determined such that $\\mathcal{L}_{h} u_{j}$ is fourth-order accurate for approximating $\\frac{d^{2}u}{dx^{2}}$ at $x_{j}$ for smooth $u(x)$.\n\nThen, using the Fourier mode ansatz $u_{j} = \\exp(i k x_{j})$ with wavenumber $k = \\frac{2 \\pi m}{L}$ for integer $m$ and periodic boundary conditions, determine the discrete eigenvalue $\\lambda(k)$ defined by $\\mathcal{L}_{h} u_{j} = \\lambda(k)\\, u_{j}$.\n\nYour final answer must be a single closed-form analytic expression for $\\lambda(k)$ in terms of the wavenumber $k$ and the grid spacing $h$. No numerical evaluation is required. Do not provide intermediate formulas in your final answer. If you introduce any acronyms, spell them out on first use. If any units are discussed, recall that eigenvalues of the Laplacian have units of inverse-square length, but do not include units in the final boxed answer.",
            "solution": "The solution proceeds in two parts: first, the determination of the stencil coefficients $a$, $b$, and $c$, and second, the calculation of the discrete eigenvalue $\\lambda(k)$.\n\nPart 1: Derivation of the Stencil Coefficients\n\nOur goal is to find the constants $a$, $b$, and $c$ such that the discrete operator $\\mathcal{L}_{h} u_{j}$ approximates the continuous second derivative $\\frac{d^{2}u}{dx^{2}}$ at point $x_j$ with a truncation error of order $h^4$. We achieve this by using Taylor series expansions of $u(x)$ around the point $x_j$. Let $u_j = u(x_j)$ and $u^{(n)}|_j = \\frac{d^n u}{dx^n}|_{x_j}$.\n\nThe Taylor expansions for the terms in the stencil are:\n$$u_{j \\pm p} = u(x_j \\pm ph) = u_j \\pm (ph) u'|_j + \\frac{(ph)^2}{2!} u''|_j \\pm \\frac{(ph)^3}{3!} u'''|_j + \\frac{(ph)^4}{4!} u^{(4)}|_j + \\frac{(ph)^5}{5!} u^{(5)}|_j + \\frac{(ph)^6}{6!} u^{(6)}|_j + O(h^7)$$\nDue to the symmetry of the stencil ($u_{j-p}$ and $u_{j+p}$ have the same coefficient), odd-order derivative terms will cancel when we form sums. We compute the relevant symmetric sums:\n$$u_{j-1} + u_{j+1} = 2u_j + h^2 u''|_j + \\frac{h^4}{12} u^{(4)}|_j + \\frac{h^6}{360} u^{(6)}|_j + O(h^8)$$\n$$u_{j-2} + u_{j+2} = 2u_j + 4h^2 u''|_j + \\frac{16h^4}{12} u^{(4)}|_j + \\frac{64h^6}{360} u^{(6)}|_j + O(h^8)$$\nSubstituting these into the expression for the operator $\\mathcal{L}_h u_j$:\n$$h^2 \\mathcal{L}_h u_j = a(u_{j-2} + u_{j+2}) + b(u_{j-1} + u_{j+1}) + c u_j$$\n$$h^2 \\mathcal{L}_h u_j = a\\left(2u_j + 4h^2 u''|_j + \\frac{4h^4}{3} u^{(4)}|_j + \\dots\\right) + b\\left(2u_j + h^2 u''|_j + \\frac{h^4}{12} u^{(4)}|_j + \\dots\\right) + c u_j$$\nWe collect terms by the derivatives of $u$:\n$$h^2 \\mathcal{L}_h u_j = (2a+2b+c)u_j + (4a+b)h^2 u''|_j + \\left(\\frac{4a}{3} + \\frac{b}{12}\\right)h^4 u^{(4)}|_j + O(h^6)$$\nFor $\\mathcal{L}_h u_j$ to be a consistent approximation of $u''|_j$, we require the coefficient of $h^2 u''|_j$ on the right-hand side to be $1$, and the coefficients of lower-order terms (i.e., $u_j$) to be zero. For the approximation to be fourth-order accurate, the coefficient of the $h^4 u^{(4)}|_j$ term must also be zero. This gives us a system of three linear equations for $a$, $b$, and $c$:\n1. Coefficient of $u_j$: $2a + 2b + c = 0$\n2. Coefficient of $h^2 u''|_j$: $4a + b = 1$\n3. Coefficient of $h^4 u^{(4)}|_j$: $\\frac{4a}{3} + \\frac{b}{12} = 0$, which simplifies to $16a + b = 0$.\n\nFrom equation (3), we find $b = -16a$. Substituting this into equation (2) gives $4a - 16a = 1$, which yields $-12a = 1$, so $a = -\\frac{1}{12}$.\nConsequently, $b = -16(-\\frac{1}{12}) = \\frac{16}{12} = \\frac{4}{3}$.\nFinally, from equation (1), we find $c = -2a - 2b = -2(-\\frac{1}{12}) - 2(\\frac{4}{3}) = \\frac{1}{6} - \\frac{8}{3} = \\frac{1}{6} - \\frac{16}{6} = -\\frac{15}{6} = -\\frac{5}{2}$.\nThe coefficients are $a = -\\frac{1}{12}$, $b = \\frac{4}{3}$, and $c = -\\frac{5}{2}$.\n\nPart 2: Determination of the Discrete Eigenvalue $\\lambda(k)$\n\nWe now analyze the action of the derived discrete operator on a single Fourier mode, $u_j = \\exp(ikx_j) = \\exp(ikjh)$. The values at neighboring grid points are related by a phase shift:\n$$u_{j\\pm p} = \\exp(ik(j\\pm p)h) = \\exp(ikjh) \\exp(\\pm ikph) = u_j \\exp(\\pm ikph)$$\nWe substitute this into the discrete operator expression:\n$$\\mathcal{L}_{h} u_{j} = \\frac{1}{h^{2}} \\left( a u_{j-2} + b u_{j-1} + c u_j + b u_{j+1} + a u_{j+2} \\right)$$\n$$\\mathcal{L}_{h} u_{j} = \\frac{u_j}{h^{2}} \\left( a e^{-i2kh} + b e^{-ikh} + c + b e^{ikh} + a e^{i2kh} \\right)$$\nBy definition, $\\mathcal{L}_{h} u_{j} = \\lambda(k) u_j$, so the eigenvalue $\\lambda(k)$ is the term multiplying $u_j$:\n$$\\lambda(k) = \\frac{1}{h^{2}} \\left( c + 2b \\cos(kh) + 2a \\cos(2kh) \\right)$$\nNow, we substitute the values for $a$, $b$, and $c$:\n$$\\lambda(k) = \\frac{1}{h^{2}} \\left( -\\frac{5}{2} + 2\\left(\\frac{4}{3}\\right) \\cos(kh) + 2\\left(-\\frac{1}{12}\\right) \\cos(2kh) \\right)$$\n$$\\lambda(k) = \\frac{1}{h^2} \\left( -\\frac{5}{2} + \\frac{8}{3} \\cos(kh) - \\frac{1}{6} \\cos(2kh) \\right)$$\nTo simplify this expression, we put everything over a common denominator of $6$:\n$$\\lambda(k) = \\frac{1}{6h^2} \\left( -15 + 16\\cos(kh) - \\cos(2kh) \\right)$$\nWe use the double-angle identity $\\cos(2\\theta) = 2\\cos^2(\\theta) - 1$:\n$$\\lambda(k) = \\frac{1}{6h^2} \\left( -15 + 16\\cos(kh) - (2\\cos^2(kh) - 1) \\right)$$\n$$\\lambda(k) = \\frac{1}{6h^2} \\left( -14 + 16\\cos(kh) - 2\\cos^2(kh) \\right)$$\nFactoring out $-2$:\n$$\\lambda(k) = \\frac{-2}{6h^2} \\left( \\cos^2(kh) - 8\\cos(kh) + 7 \\right)$$\n$$\\lambda(k) = -\\frac{1}{3h^2} \\left( \\cos^2(kh) - 8\\cos(kh) + 7 \\right)$$\nThe quadratic in $\\cos(kh)$ can be factored as $(\\cos(kh)-1)(\\cos(kh)-7)$.\n$$\\lambda(k) = -\\frac{1}{3h^2} (\\cos(kh) - 1)(\\cos(kh) - 7)$$\nThis expression can be further simplified using the half-angle identity $\\cos(\\theta) - 1 = -2\\sin^2(\\frac{\\theta}{2})$:\n$$\\lambda(k) = -\\frac{1}{3h^2} \\left(-2\\sin^2\\left(\\frac{kh}{2}\\right)\\right) \\left(\\cos(kh) - 7\\right)$$\n$$\\lambda(k) = \\frac{2}{3h^2} \\sin^2\\left(\\frac{kh}{2}\\right) \\left(\\cos(kh) - 7\\right)$$\nFinally, expressing $\\cos(kh)$ in terms of $\\sin^2(\\frac{kh}{2})$ using $\\cos(\\theta) = 1 - 2\\sin^2(\\frac{\\theta}{2})$:\n$$\\lambda(k) = \\frac{2}{3h^2} \\sin^2\\left(\\frac{kh}{2}\\right) \\left( \\left(1 - 2\\sin^2\\left(\\frac{kh}{2}\\right)\\right) - 7 \\right)$$\n$$\\lambda(k) = \\frac{2}{3h^2} \\sin^2\\left(\\frac{kh}{2}\\right) \\left( -6 - 2\\sin^2\\left(\\frac{kh}{2}\\right) \\right)$$\n$$\\lambda(k) = -\\frac{4}{3h^2} \\sin^2\\left(\\frac{kh}{2}\\right) \\left( 3 + \\sin^2\\left(\\frac{kh}{2}\\right) \\right)$$\nThis final form is particularly insightful. The eigenvalue for the corresponding second-order accurate stencil is $-\\frac{4}{h^2}\\sin^2(\\frac{kh}{2})$. Our fourth-order eigenvalue is a correction to this, scaled by the factor $\\frac{1}{3}(3+\\sin^2(\\frac{kh}{2}))$. As $kh \\to 0$, this factor approaches $1$, and a Taylor expansion confirms the fourth-order accuracy of the scheme.",
            "answer": "$$\\boxed{-\\frac{4}{3h^{2}} \\sin^{2}\\left(\\frac{kh}{2}\\right) \\left(3 + \\sin^{2}\\left(\\frac{kh}{2}\\right)\\right)}$$"
        },
        {
            "introduction": "The choice of how variables are arranged on a grid can be as critical as the choice of the finite difference stencil itself. This practice explores the properties of the Arakawa A-grid, where all variables are co-located, for discretizing the linearized shallow-water equations. Through Fourier analysis of the discretized system, you will discover and diagnose a notorious flaw: the existence of a spurious, stationary computational mode that can corrupt numerical solutions.",
            "id": "4042432",
            "problem": "A one-dimensional, inviscid shallow layer of water of mean depth $H$ and gravitational acceleration $g$ is considered on an $x$-periodic domain of length $L$ with $N$ uniformly spaced grid points and grid spacing $h = L/N$. The layer is initially at rest with small perturbations. The linearized shallow-water equations for small perturbations are derived from conservation of momentum and mass: the momentum equation is $\\partial u/\\partial t = - g \\, \\partial \\eta/\\partial x$ and the mass continuity equation is $\\partial \\eta/\\partial t = - H \\, \\partial u/\\partial x$, where $u(x,t)$ is the zonal velocity and $\\eta(x,t)$ is the free-surface displacement.\n\nOn an Arakawa A-grid (A-grid), both $u$ and $\\eta$ are co-located at the same grid points $x_i = i h$ for integer $i$. Using second-order centered finite differences on the A-grid, construct the semi-discrete form (continuous in time, discrete in space) of the linearized shallow-water equations with the discrete pressure gradient operator acting on $\\eta$ at each grid point. Assume periodic boundary conditions so that indices are taken modulo $N$.\n\nTreating the semi-discrete system as invariant under discrete translations, consider discrete normal modes of the form $u_i(t) = U \\, \\exp\\!\\big(i (k x_i - \\omega t)\\big)$ and $\\eta_i(t) = \\hat{\\eta} \\, \\exp\\!\\big(i (k x_i - \\omega t)\\big)$ for real wavenumber $k$ and angular frequency $\\omega$. Using this ansatz, derive the discrete dispersion relation $\\omega(k)$ implied by the semi-discrete equations and demonstrate rigorously the emergence of a spurious computational mode with wavelength $2h$ that decouples from velocity through the discrete pressure gradient operator.\n\nFinally, evaluate the angular frequency $\\omega$ for the $2h$ mode, which corresponds to the wavenumber $k = \\pi/h$, and report its value. Express the final angular frequency in $\\mathrm{s}^{-1}$. No rounding is required.",
            "solution": "The fundamental basis is the conservation of momentum and mass for shallow-water flow linearized about a state of rest and constant depth. The linearized shallow-water equations in one spatial dimension are\n$$\n\\frac{\\partial u}{\\partial t} = - g \\, \\frac{\\partial \\eta}{\\partial x}, \\qquad\n\\frac{\\partial \\eta}{\\partial t} = - H \\, \\frac{\\partial u}{\\partial x}.\n$$\nOn an Arakawa A-grid (A-grid), the variables $u$ and $\\eta$ are defined at the same grid points $x_i = i h$ for integer $i$. We discretize the spatial derivatives with second-order centered finite differences. The discrete pressure gradient operator $G$ acting on the discrete free-surface displacement $\\eta_i$ at grid point $i$ is\n$$\n(G \\eta)_i = \\frac{\\eta_{i+1} - \\eta_{i-1}}{2 h}.\n$$\nSimilarly, the discrete divergence operator $D$ acting on $u_i$ is\n$$\n(D u)_i = \\frac{u_{i+1} - u_{i-1}}{2 h}.\n$$\nWith these operators and periodic boundary conditions (indices modulo $N$), the semi-discrete linearized shallow-water equations are\n$$\n\\frac{d u_i}{d t} = - g \\, (G \\eta)_i = - g \\, \\frac{\\eta_{i+1} - \\eta_{i-1}}{2 h}, \\qquad\n\\frac{d \\eta_i}{d t} = - H \\, (D u)_i = - H \\, \\frac{u_{i+1} - u_{i-1}}{2 h}.\n$$\nTo analyze the mode structure, we use the discrete normal mode ansatz\n$$\nu_i(t) = U \\, \\exp\\!\\big(i (k x_i - \\omega t)\\big), \\qquad\n\\eta_i(t) = \\hat{\\eta} \\, \\exp\\!\\big(i (k x_i - \\omega t)\\big),\n$$\nwith real $k$ and complex $\\omega$ (for generality). Under this ansatz, the centered finite difference of a plane wave is computed as follows:\n$$\n\\frac{\\eta_{i+1} - \\eta_{i-1}}{2 h}\n= \\frac{\\hat{\\eta} \\exp\\!\\big(i(k x_{i+1} - \\omega t)\\big) - \\hat{\\eta} \\exp\\!\\big(i(k x_{i-1} - \\omega t)\\big)}{2 h}\n= \\frac{\\hat{\\eta} \\exp\\!\\big(i(k x_i - \\omega t)\\big)\\big(\\exp(i k h) - \\exp(- i k h)\\big)}{2 h}\n= \\hat{\\eta} \\exp\\!\\big(i(k x_i - \\omega t)\\big) \\cdot \\frac{i \\, \\sin(k h)}{h}.\n$$\nThus, the discrete gradient operator acting on a plane wave produces $i D(k)$ times the original wave, where we define the real symbol\n$$\nD(k) \\equiv \\frac{\\sin(k h)}{h}.\n$$\nThe same holds for the discrete divergence acting on $u_i$, namely\n$$\n\\frac{u_{i+1} - u_{i-1}}{2 h} = U \\exp\\!\\big(i(k x_i - \\omega t)\\big) \\cdot \\frac{i \\, \\sin(k h)}{h} = i D(k) \\, U \\exp\\!\\big(i(k x_i - \\omega t)\\big).\n$$\nSubstituting these into the semi-discrete equations and cancelling the common factor $\\exp\\!\\big(i(k x_i - \\omega t)\\big)$ yields the algebraic system\n$$\n- i \\omega \\, U = - g \\, i D(k) \\, \\hat{\\eta} \\quad \\Longrightarrow \\quad \\omega \\, U = g \\, D(k) \\, \\hat{\\eta},\n$$\n$$\n- i \\omega \\, \\hat{\\eta} = - H \\, i D(k) \\, U \\quad \\Longrightarrow \\quad \\omega \\, \\hat{\\eta} = H \\, D(k) \\, U.\n$$\nEliminating $U$ and $\\hat{\\eta}$ gives the discrete dispersion relation. Multiply the first equation by $\\omega$ and substitute the second:\n$$\n\\omega^{2} \\, U = g \\, D(k) \\, \\omega \\, \\hat{\\eta} = g \\, D(k) \\, \\big(H \\, D(k) \\, U\\big) \\quad \\Longrightarrow \\quad \\omega^{2} = g H \\, D(k)^{2}.\n$$\nIn explicit terms,\n$$\n\\omega^{2}(k) = g H \\left(\\frac{\\sin(k h)}{h}\\right)^{2}.\n$$\nThis relation shows how the discrete spatial differencing modifies the continuous dispersion $\\omega^{2} = g H k^{2}$ by replacing $k$ with the discrete wavenumber function $\\sin(k h)/h$.\n\nWe now demonstrate the spurious computational mode with wavelength $2 h$. A wavelength $\\lambda$ corresponds to wavenumber $k = 2 \\pi / \\lambda$. For $\\lambda = 2 h$, the wavenumber is\n$$\nk = \\frac{2 \\pi}{2 h} = \\frac{\\pi}{h}.\n$$\nEvaluating the discrete wavenumber function at $k = \\pi/h$ gives\n$$\nD\\!\\left(\\frac{\\pi}{h}\\right) = \\frac{\\sin\\!\\big((\\pi/h) h\\big)}{h} = \\frac{\\sin(\\pi)}{h} = 0.\n$$\nHence, the discrete pressure gradient and divergence operators annihilate the $2 h$ mode:\n$$\n(G \\eta)_i = \\frac{\\eta_{i+1} - \\eta_{i-1}}{2 h} = 0, \\qquad (D u)_i = \\frac{u_{i+1} - u_{i-1}}{2 h} = 0,\n$$\nfor any alternating checkerboard pattern $\\eta_i \\propto (-1)^i$ and $u_i \\propto (-1)^i$. Physically, the discrete pressure gradient vanishes for this grid-scale mode, so the velocity experiences no forcing from $\\eta$, and conversely the divergence vanishes so $\\eta$ experiences no tendency from $u$. In the modal analysis, this decoupling appears as\n$$\n\\omega^{2}\\!\\left(\\frac{\\pi}{h}\\right) = g H \\left(\\frac{\\sin(\\pi)}{h}\\right)^{2} = 0 \\quad \\Longrightarrow \\quad \\omega\\!\\left(\\frac{\\pi}{h}\\right) = 0.\n$$\nTherefore, the $2 h$ mode is a stationary spurious computational mode that decouples from the dynamics due to the discrete pressure gradient operator on the A-grid. The requested angular frequency for $k = \\pi/h$, expressed in $\\mathrm{s}^{-1}$, is zero.",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "Theoretical analysis of numerical schemes comes to life when implemented in code. This hands-on programming exercise challenges you to solve the linear advection equation, a cornerstone of transport modeling, using two classic methods: a first-order upwind scheme and a second-order centered scheme. By comparing the numerical solutions against the exact solution for an initial step function, you will directly observe and quantify the characteristic errors of numerical diffusion and dispersion.",
            "id": "4042465",
            "problem": "Consider the one-dimensional linear advection equation $u_t + c\\,u_x = 0$ on the periodic domain $x \\in [0,1)$, where $c  0$ is a constant advection speed. Let the initial condition be a dimensionless step function defined by $u(x,0) = 1$ for $x \\in [a,b)$ and $u(x,0) = 0$ otherwise, with $a = 0.25$ and $b = 0.5$. The exact solution is obtained by rigid translation of the initial condition at speed $c$ under periodic boundary conditions.\n\nYour task is to implement two explicit finite difference schemes for this problem and compare the evolution of the $L^1$ and $L^2$ error norms over time, at equal Courant–Friedrichs–Lewy (CFL) number. The schemes are:\n- A first-order upwind finite difference scheme for positive $c$ (donor-cell).\n- A second-order accurate scheme that is constructed from second-order central differencing in space and second-order Taylor expansion in time (commonly known to be consistent and stable for $0 \\le \\nu \\le 1$ on this equation), where $\\nu = c\\,\\Delta t / \\Delta x$ is the CFL number.\n\nBoth methods must use the same grid, the same time step, and the same CFL number for each test case. The domain must be discretized with $N$ equally spaced points on $[0,1)$, with periodic boundary conditions. Take the solution variable $u$ to be dimensionless; report all errors as dimensionless quantities.\n\nFor each method, compute the numerical solution and compare it with the exact solution at specified output times. The exact solution at time $t$ is given by translating the initial step: $u_{\\text{exact}}(x,t) = 1$ if $(x - c t) \\bmod 1 \\in [a,b)$ and $u_{\\text{exact}}(x,t) = 0$ otherwise. The discrete $L^1$ error must be computed as the Riemann sum $L^1 = \\Delta x \\sum_j |u_j - u_{\\text{exact},j}|$, and the discrete $L^2$ error must be computed as $L^2 = \\sqrt{\\Delta x \\sum_j (u_j - u_{\\text{exact},j})^2}$.\n\nUse the same CFL number $\\nu$ for both methods in each test case, with $\\Delta t = \\nu\\,\\Delta x / c$. The output times will be specified as fractions of the total integration time $T$. At each output time, record the $L^1$ and $L^2$ errors for both schemes.\n\nTest Suite:\n- Test Case 1 (happy path): $N = 400$, $c = 1.0$, $\\nu = 0.8$, $T = 1.0$, output times at $[0.0, 0.25, 0.5, 0.75, 1.0] \\times T$.\n- Test Case 2 (boundary CFL): $N = 200$, $c = 1.0$, $\\nu = 1.0$, $T = 1.0$, output times at $[0.0, 0.25, 0.5, 0.75, 1.0] \\times T$.\n- Test Case 3 (coarse grid): $N = 50$, $c = 1.0$, $\\nu = 0.5$, $T = 1.0$, output times at $[0.0, 0.25, 0.5, 0.75, 1.0] \\times T$.\n\nImplementation Details:\n- The grid points $x_j$ should be uniformly spaced with $\\Delta x = 1/N$, and periodic boundary conditions must be used.\n- The first-order upwind scheme must be the standard donor-cell upwind for $c  0$.\n- The second-order accurate scheme must be derived from second-order central differencing in space and second-order time accuracy consistent with the advection equation; use the same CFL number as the upwind scheme.\n- For each test case, initialize the numerical solution for both schemes with the same discrete initial condition sampled at the grid points from the step function described.\n- Evolve both schemes forward in time using the same $\\Delta t$ until the largest requested output time. At each requested output time, compute the exact solution by translating the initial condition by $c t$ and compute the $L^1$ and $L^2$ errors for both schemes.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The outermost list must have one entry per test case. Each test case entry must itself be a list containing two lists: the first corresponding to the first-order upwind scheme, and the second corresponding to the second-order scheme. Within each of these inner lists, place the $L^1$ and $L^2$ errors at each output time, in chronological order. All numerical values must be printed as decimal floats rounded to eight digits after the decimal point. Concretely, for one test case with $K+1$ output times, the structure is:\n$[[L^1_{\\text{up}}(t_0), L^2_{\\text{up}}(t_0), L^1_{\\text{up}}(t_1), L^2_{\\text{up}}(t_1), \\dots, L^1_{\\text{up}}(t_K), L^2_{\\text{up}}(t_K)], [L^1_{\\text{sec}}(t_0), L^2_{\\text{sec}}(t_0), L^1_{\\text{sec}}(t_1), L^2_{\\text{sec}}(t_1), \\dots, L^1_{\\text{sec}}(t_K), L^2_{\\text{sec}}(t_K)]]$\nThe program must aggregate the three test case results into a single list, yielding a final single-line output string of the form:\n$[[\\dots],[\\dots],[\\dots]]$\nrounded to eight digits after the decimal point for every number, with no additional text.",
            "solution": "## Solution\n\nThe task is to solve the one-dimensional linear advection equation, $u_t + c\\,u_x = 0$, for a positive advection speed $c  0$ on a periodic domain $x \\in [0, 1)$. We will implement and compare two explicit finite difference schemes.\n\n### Discretization\n\nThe domain $[0, 1)$ is discretized into $N$ grid cells of equal width $\\Delta x = 1/N$. The grid points are $x_j = j \\Delta x$ for $j = 0, 1, \\dots, N-1$. A uniform time step $\\Delta t$ is used, with time levels denoted by $t^n = n \\Delta t$. The numerical approximation of the solution $u(x_j, t^n)$ is denoted by $u_j^n$. The Courant-Friedrichs-Lewy (CFL) number is $\\nu = c \\Delta t / \\Delta x$.\n\n### Scheme 1: First-Order Upwind (Donor-Cell)\n\nThis scheme is first-order accurate in both time and space. For $c  0$, the \"upwind\" direction is from the left. We use a forward difference for the time derivative and a backward difference for the spatial derivative.\n\nThe discretization of $u_t + c u_x = 0$ is:\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + c \\frac{u_j^n - u_{j-1}^n}{\\Delta x} = 0\n$$\nSolving for $u_j^{n+1}$:\n$$\nu_j^{n+1} = u_j^n - \\frac{c \\Delta t}{\\Delta x} (u_j^n - u_{j-1}^n)\n$$\nSubstituting the CFL number $\\nu = c \\Delta t / \\Delta x$, we obtain the update rule:\n$$\nu_j^{n+1} = u_j^n - \\nu (u_j^n - u_{j-1}^n) = (1-\\nu)u_j^n + \\nu u_{j-1}^n\n$$\nThis scheme is known to be stable for $0 \\le \\nu \\le 1$. It is highly dissipative, meaning it tends to smear out sharp features in the solution.\n\n### Scheme 2: Second-Order Accurate Scheme (Lax-Wendroff)\n\nThis scheme is constructed to be second-order accurate in both time and space. We start with a second-order Taylor series expansion in time:\n$$\nu(x_j, t^{n+1}) = u(x_j, t^n) + \\Delta t \\, u_t(x_j, t^n) + \\frac{(\\Delta t)^2}{2} u_{tt}(x_j, t^n) + \\mathcal{O}((\\Delta t)^3)\n$$\nFrom the governing equation, we have $u_t = -c u_x$. Differentiating with respect to time gives $u_{tt} = -c u_{xt}$. Differentiating with respect to space gives $u_{tx} = -c u_{xx}$. Assuming sufficient smoothness ($u_{xt} = u_{tx}$), we find $u_{tt} = c^2 u_{xx}$. Substituting these into the Taylor expansion:\n$$\nu(x_j, t^{n+1}) = u(x_j, t^n) - c \\Delta t \\, u_x(x_j, t^n) + \\frac{c^2 (\\Delta t)^2}{2} u_{xx}(x_j, t^n) + \\mathcal{O}((\\Delta t)^3)\n$$\nWe now discretize the spatial derivatives using second-order central differences:\n$$\nu_x(x_j, t^n) \\approx \\frac{u_{j+1}^n - u_{j-1}^n}{2 \\Delta x}\n$$\n$$\nu_{xx}(x_j, t^n) \\approx \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\\Delta x)^2}\n$$\nSubstituting these into the time-expanded equation yields the Lax-Wendroff scheme:\n$$\nu_j^{n+1} = u_j^n - c \\Delta t \\left( \\frac{u_{j+1}^n - u_{j-1}^n}{2 \\Delta x} \\right) + \\frac{c^2 (\\Delta t)^2}{2} \\left( \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\\Delta x)^2} \\right)\n$$\nUsing $\\nu = c \\Delta t / \\Delta x$ and rearranging terms:\n$$\nu_j^{n+1} = u_j^n - \\frac{\\nu}{2} (u_{j+1}^n - u_{j-1}^n) + \\frac{\\nu^2}{2} (u_{j+1}^n - 2u_j^n + u_{j-1}^n)\n$$\n$$\nu_j^{n+1} = \\left(\\frac{\\nu^2}{2} - \\frac{\\nu}{2}\\right) u_{j+1}^n + (1 - \\nu^2) u_j^n + \\left(\\frac{\\nu^2}{2} + \\frac{\\nu}{2}\\right) u_{j-1}^n\n$$\nThis scheme is stable for $|\\nu| \\le 1$. It is dispersive, meaning it can introduce spurious oscillations (Gibbs phenomena) near discontinuities.\n\n### Implementation Details\n\n- **Initial Condition**: The discrete initial condition $u_j^0$ is set by sampling the given step function at the grid points $x_j$: $u_j^0 = 1$ if $x_j \\in [0.25, 0.5)$ and $u_j^0 = 0$ otherwise.\n- **Periodic Boundary Conditions**: The periodic nature of the domain implies $u_{j+N}^n = u_j^n$. Accessing indices $j-1$ for $j=0$ and $j+1$ for $j=N-1$ is handled by wrapping around the array. For example, $u_{-1}^n \\equiv u_{N-1}^n$ and $u_N^n \\equiv u_0^n$. This is efficiently implemented using array-rolling operations.\n- **Exact Solution**: The exact solution at time $t$ involves translating the initial profile. A point $x$ has the value of the initial profile at $(x - c t)$. Due to periodicity, this is evaluated as $(x - c t) \\pmod 1$. The discrete exact solution is:\n$$\nu_{\\text{exact},j}(t) = 1 \\text{ if } (x_j - c t) \\pmod 1 \\in [0.25, 0.5), \\text{ and } 0 \\text{ otherwise.}\n$$\n- **Error Norms**: At each specified output time $t$, the discrete $L^1$ and $L^2$ error norms are computed using the provided formulas:\n$$\nL^1(t) = \\Delta x \\sum_{j=0}^{N-1} |u_j(t) - u_{\\text{exact},j}(t)|\n$$\n$$\nL^2(t) = \\sqrt{\\Delta x \\sum_{j=0}^{N-1} (u_j(t) - u_{\\text{exact},j}(t))^2}\n$$\n- **Algorithm**: For each test case defined by $\\{N, c, \\nu, T, \\text{output times}\\}$:\n  1. Calculate grid spacing $\\Delta x = 1/N$ and time step $\\Delta t = \\nu \\Delta x / c$.\n  2. Create the spatial grid $x_j$ and the initial condition array $u^0$. Initialize arrays for both schemes, $u_{\\text{upwind}}$ and $u_{\\text{LW}}$, with $u^0$.\n  3. Determine the integer time steps corresponding to the required output times.\n  4. Loop from time step $n=0$ up to the final time step required to reach $T$.\n  5. If the current time step is an output step, calculate the exact solution and compute the $L^1$ and $L^2$ errors for both $u_{\\text{upwind}}$ and $u_{\\text{LW}}$. Store the results.\n  6. Update $u_{\\text{upwind}}$ and $u_{\\text{LW}}$ to the next time level using their respective finite difference formulas.\n  7. After processing all test cases, format the collected results into the specified string format.\n\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function to run the numerical experiments and generate output.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'N': 400, 'c': 1.0, 'nu': 0.8, 'T': 1.0, 'output_factors': [0.0, 0.25, 0.5, 0.75, 1.0]},\n        {'N': 200, 'c': 1.0, 'nu': 1.0, 'T': 1.0, 'output_factors': [0.0, 0.25, 0.5, 0.75, 1.0]},\n        {'N': 50, 'c': 1.0, 'nu': 0.5, 'T': 1.0, 'output_factors': [0.0, 0.25, 0.5, 0.75, 1.0]},\n    ]\n    \n    a = 0.25\n    b = 0.5\n    all_test_results = []\n\n    for case in test_cases:\n        N = case['N']\n        c = case['c']\n        nu = case['nu']\n        T = case['T']\n        output_factors = case['output_factors']\n\n        # Discretization\n        dx = 1.0 / N\n        dt = nu * dx / c\n        x = np.linspace(0.0, 1.0, N, endpoint=False)\n\n        # Initial condition\n        u0 = np.zeros(N)\n        u0[(x = a)  (x  b)] = 1.0\n\n        u_upwind = u0.copy()\n        u_lw = u0.copy()\n\n        results_upwind = []\n        results_lw = []\n\n        output_times = np.array(output_factors) * T\n        # Use np.round to handle potential floating point inaccuracies\n        output_steps = set(np.round(output_times / dt).astype(int))\n        \n        num_steps = int(np.ceil(T / dt))\n\n        for step in range(num_steps + 1):\n            current_t = step * dt\n\n            if step in output_steps:\n                # Calculate exact solution at current_t\n                x_shifted = (x - c * current_t) % 1.0\n                u_exact = np.where((x_shifted = a)  (x_shifted  b), 1.0, 0.0)\n\n                # Calculate errors for upwind scheme\n                l1_upwind = dx * np.sum(np.abs(u_upwind - u_exact))\n                l2_upwind = np.sqrt(dx * np.sum((u_upwind - u_exact)**2))\n                results_upwind.extend([l1_upwind, l2_upwind])\n\n                # Calculate errors for Lax-Wendroff scheme\n                l1_lw = dx * np.sum(np.abs(u_lw - u_exact))\n                l2_lw = np.sqrt(dx * np.sum((u_lw - u_exact)**2))\n                results_lw.extend([l1_lw, l2_lw])\n            \n            if current_t = T:\n                break\n\n            # Update solutions\n            # First-order upwind\n            u_upwind = (1 - nu) * u_upwind + nu * np.roll(u_upwind, 1)\n\n            # Second-order Lax-Wendroff\n            u_j_minus_1 = np.roll(u_lw, 1)\n            u_j_plus_1 = np.roll(u_lw, -1)\n            term1 = (nu**2 / 2 - nu / 2) * u_j_plus_1\n            term2 = (1 - nu**2) * u_lw\n            term3 = (nu**2 / 2 + nu / 2) * u_j_minus_1\n            u_lw = term1 + term2 + term3\n\n        all_test_results.append([results_upwind, results_lw])\n\n    # Final print statement in the exact required format.\n    # The structure is a list of test cases. Each test case is a list of two lists (one for each scheme).\n    # Each scheme list contains the L1, L2 errors at each output time.\n    outer_list = []\n    for test_result in all_test_results:\n        case_list_str = []\n        for scheme_result in test_result:\n            scheme_list_str_inner = [f\"{val:.8f}\" for val in scheme_result]\n            case_list_str.append(f\"[{','.join(scheme_list_str_inner)}]\")\n        outer_list.append(f\"[{','.join(case_list_str)}]\")\n    \n    # This print call has been wrapped for readability but should be a single line.\n    print(f\"[{','.join(outer_list)}]\")\n\nsolve()\n```",
            "answer": "[[[0.00000000,0.00000000,0.05282000,0.14493399,0.07186000,0.18370161,0.08378000,0.20786523,0.09138000,0.22292728],[0.00000000,0.00000000,0.05739328,0.21980838,0.06380628,0.23789304,0.06300486,0.23868218,0.06289069,0.23896263]],[[0.00000000,0.00000000,0.00000000,0.00000000,0.00000000,0.00000000,0.00000000,0.00000000,0.00000000,0.00000000],[0.00000000,0.00000000,0.00000000,0.00000000,0.00000000,0.00000000,0.00000000,0.00000000,0.00000000,0.00000000]],[[0.00000000,0.00000000,0.08290000,0.23233157,0.11300000,0.28114172,0.13090000,0.30948952,0.14230000,0.32688756],[0.00000000,0.00000000,0.10173663,0.37053535,0.10300407,0.38001619,0.10323386,0.38092248,0.10322300,0.38090740]]]"
        }
    ]
}