{
    "hands_on_practices": [
        {
            "introduction": "数值建模的第一步是将连续的数学算子（如拉普拉斯算子）转化为离散的近似形式。本练习将指导你从泰勒级数展开的基本原理出发，构建一个用于一维拉普拉斯算子的四阶精度差分格式。通过傅里叶分析，你还将推导出该离散算子的特征值，这是理解数值格式如何影响不同尺度波动的关键一步 ()。",
            "id": "4042504",
            "problem": "考虑一个长度为 $L$ 的一维周期性纬向通道，该通道在数值天气预报（NWP）和气候模拟中用于表示水平均匀的动力学过程。设网格由 $N$ 个等距点组成，网格间距 $h = L/N$，位置为 $x_{j} = j h$，$j$ 为整数。一维连续拉普拉斯算子为 $\\nabla^{2} u = \\frac{d^{2} u}{d x^{2}}$。要求您为此网格上的 $\\nabla^{2}$ 构建一个四阶精度的有限差分离散格式，并使用傅里叶模态在周期性边界条件下确定其离散特征值。\n\n从基本原理出发，使用关于 $x_{j}$ 的泰勒展开，推导一个形如下式的对称五点格式\n$$\n\\mathcal{L}_{h} u_{j} \\equiv \\frac{a\\,u_{j-2} + b\\,u_{j-1} + c\\,u_{j} + b\\,u_{j+1} + a\\,u_{j+2}}{h^{2}},\n$$\n其中 $a$、$b$ 和 $c$ 是待定常数，使得对于光滑函数 $u(x)$，$\\mathcal{L}_{h} u_{j}$ 在 $x_{j}$ 点逼近 $\\frac{d^{2}u}{dx^{2}}$ 时具有四阶精度。\n\n然后，使用傅里叶模态拟设 $u_{j} = \\exp(i k x_{j})$（其中波数 $k = \\frac{2 \\pi m}{L}$，$m$ 为整数）和周期性边界条件，确定由 $\\mathcal{L}_{h} u_{j} = \\lambda(k)\\, u_{j}$ 定义的离散特征值 $\\lambda(k)$。\n\n您的最终答案必须是一个关于 $\\lambda(k)$ 的单一闭式解析表达式，用波数 $k$ 和网格间距 $h$ 表示。无需进行数值计算。在最终答案中不要提供中间公式。如果引入任何缩写词，首次使用时需写出全称。如果讨论到单位，请记住拉普拉斯算子的特征值单位是长度的平方的倒数，但不要在最终的方框答案中包含单位。",
            "solution": "用户要求推导一维拉普拉斯算子的一个四阶精度有限差分格式，并在周期性边界条件下确定其离散特征值。\n\n首先，我将验证问题陈述。\n\n### 步骤 1：提取已知条件\n- 域：长度为 $L$ 的一维周期性通道。\n- 网格：$N$ 个等距点，间距 $h = L/N$，位置 $x_{j} = j h$。\n- 连续算子：$\\nabla^{2} u = \\frac{d^{2} u}{d x^{2}}$。\n- 离散算子形式：$\\mathcal{L}_{h} u_{j} \\equiv \\frac{a\\,u_{j-2} + b\\,u_{j-1} + c\\,u_{j} + b\\,u_{j+1} + a\\,u_{j+2}}{h^{2}}$。\n- 精度要求：四阶，意味着截断误差为 $O(h^{4})$。\n- 分析工具：傅里叶模态拟设 $u_{j} = \\exp(i k x_{j})$，波数 $k = \\frac{2 \\pi m}{L}$，$m$ 为整数。\n- 特征值的定义：$\\mathcal{L}_{h} u_{j} = \\lambda(k)\\, u_{j}$。\n- 最终答案要求：一个关于 $\\lambda(k)$ 的、用 $k$ 和 $h$ 表示的单一闭式解析表达式。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，因为它是数值分析领域的一个标准和基础练习，特别是用于流体动力学和地球物理建模学科（如数值天气预报(NWP)）的方法。该问题是适定的，具有明确的目标和足够的约束来确定唯一解。语言客观且数学上精确。该问题没有任何指令中列出的无效缺陷。这是一个完整、一致且可形式化的理论问题。\n\n### 步骤 3：结论与行动\n问题有效。我将继续进行详细求解。\n\n求解过程分为两部分：首先，确定格式系数 $a$、$b$ 和 $c$；其次，计算离散特征值 $\\lambda(k)$。\n\n第一部分：推导格式系数\n\n我们的目标是找到常数 $a$、$b$ 和 $c$，使得离散算子 $\\mathcal{L}_{h} u_{j}$ 在点 $x_j$ 处逼近连续二阶导数 $\\frac{d^{2}u}{dx^{2}}$ 的截断误差为 $h^4$ 阶。我们通过在点 $x_j$ 附近对 $u(x)$ 进行泰勒级数展开来实现这一目标。设 $u_j = u(x_j)$ 且 $u^{(n)}|_j = \\frac{d^n u}{dx^n}|_{x_j}$。\n\n格式中各项的泰勒展开式为：\n$$u_{j \\pm p} = u(x_j \\pm ph) = u_j \\pm (ph) u'|_j + \\frac{(ph)^2}{2!} u''|_j \\pm \\frac{(ph)^3}{3!} u'''|_j + \\frac{(ph)^4}{4!} u^{(4)}|_j + \\frac{(ph)^5}{5!} u^{(5)}|_j + \\frac{(ph)^6}{6!} u^{(6)}|_j + O(h^7)$$\n由于格式的对称性（$u_{j-p}$ 和 $u_{j+p}$ 具有相同的系数），当我们求和时，奇数阶导数项将抵消。我们计算相关的对称和：\n$$u_{j-1} + u_{j+1} = 2u_j + h^2 u''|_j + \\frac{h^4}{12} u^{(4)}|_j + \\frac{h^6}{360} u^{(6)}|_j + O(h^8)$$\n$$u_{j-2} + u_{j+2} = 2u_j + 4h^2 u''|_j + \\frac{16h^4}{12} u^{(4)}|_j + \\frac{64h^6}{360} u^{(6)}|_j + O(h^8)$$\n将这些代入算子 $\\mathcal{L}_h u_j$ 的表达式中：\n$$h^2 \\mathcal{L}_h u_j = a(u_{j-2} + u_{j+2}) + b(u_{j-1} + u_{j+1}) + c u_j$$\n$$h^2 \\mathcal{L}_h u_j = a\\left(2u_j + 4h^2 u''|_j + \\frac{4h^4}{3} u^{(4)}|_j + \\dots\\right) + b\\left(2u_j + h^2 u''|_j + \\frac{h^4}{12} u^{(4)}|_j + \\dots\\right) + c u_j$$\n我们按 $u$ 的导数阶次整理各项：\n$$h^2 \\mathcal{L}_h u_j = (2a+2b+c)u_j + (4a+b)h^2 u''|_j + \\left(\\frac{4a}{3} + \\frac{b}{12}\\right)h^4 u^{(4)}|_j + O(h^6)$$\n为使 $\\mathcal{L}_h u_j$ 是 $u''|_j$ 的一致逼近，我们要求右侧 $h^2 u''|_j$ 的系数为 $1$，且低阶项（即 $u_j$）的系数为零。为使逼近达到四阶精度，$h^4 u^{(4)}|_j$ 项的系数也必须为零。这给了我们一个关于 $a$、$b$、$c$ 的三元线性方程组：\n1. $u_j$ 的系数：$2a + 2b + c = 0$\n2. $h^2 u''|_j$ 的系数：$4a + b = 1$\n3. $h^4 u^{(4)}|_j$ 的系数：$\\frac{4a}{3} + \\frac{b}{12} = 0$，可简化为 $16a + b = 0$。\n\n从方程(3)中，我们得到 $b = -16a$。将其代入方程(2)得到 $4a - 16a = 1$，得出 $-12a = 1$，所以 $a = -\\frac{1}{12}$。\n因此，$b = -16(-\\frac{1}{12}) = \\frac{16}{12} = \\frac{4}{3}$。\n最后，从方程(1)中，我们得到 $c = -2a - 2b = -2(-\\frac{1}{12}) - 2(\\frac{4}{3}) = \\frac{1}{6} - \\frac{8}{3} = \\frac{1}{6} - \\frac{16}{6} = -\\frac{15}{6} = -\\frac{5}{2}$。\n这些系数是 $a = -\\frac{1}{12}$、$b = \\frac{4}{3}$ 和 $c = -\\frac{5}{2}$。\n\n第二部分：确定离散特征值 $\\lambda(k)$\n\n我们现在分析所推导的离散算子作用于单个傅里叶模态 $u_j = \\exp(ikx_j) = \\exp(ikjh)$ 的情况。相邻网格点上的值通过一个相移相关联：\n$$u_{j\\pm p} = \\exp(ik(j\\pm p)h) = \\exp(ikjh) \\exp(\\pm ikph) = u_j \\exp(\\pm ikph)$$\n我们将其代入离散算子表达式中：\n$$\\mathcal{L}_{h} u_{j} = \\frac{1}{h^{2}} \\left( a u_{j-2} + b u_{j-1} + c u_j + b u_{j+1} + a u_{j+2} \\right)$$\n$$\\mathcal{L}_{h} u_{j} = \\frac{u_j}{h^{2}} \\left( a e^{-i2kh} + b e^{-ikh} + c + b e^{ikh} + a e^{i2kh} \\right)$$\n根据定义，$\\mathcal{L}_{h} u_{j} = \\lambda(k) u_j$，所以特征值 $\\lambda(k)$ 是乘以 $u_j$ 的项：\n$$\\lambda(k) = \\frac{1}{h^{2}} \\left( c + b(e^{ikh} + e^{-ikh}) + a(e^{i2kh} + e^{-i2kh}) \\right)$$\n使用欧拉恒等式 $e^{i\\theta} + e^{-i\\theta} = 2\\cos(\\theta)$，我们得到：\n$$\\lambda(k) = \\frac{1}{h^{2}} \\left( c + 2b \\cos(kh) + 2a \\cos(2kh) \\right)$$\n现在，我们代入 $a$、$b$ 和 $c$ 的值：\n$$\\lambda(k) = \\frac{1}{h^{2}} \\left( -\\frac{5}{2} + 2\\left(\\frac{4}{3}\\right) \\cos(kh) + 2\\left(-\\frac{1}{12}\\right) \\cos(2kh) \\right)$$\n$$\\lambda(k) = \\frac{1}{h^2} \\left( -\\frac{5}{2} + \\frac{8}{3} \\cos(kh) - \\frac{1}{6} \\cos(2kh) \\right)$$\n为了简化此表达式，我们将所有项通分，分母为 $6$：\n$$\\lambda(k) = \\frac{1}{6h^2} \\left( -15 + 16\\cos(kh) - \\cos(2kh) \\right)$$\n我们使用二倍角恒等式 $\\cos(2\\theta) = 2\\cos^2(\\theta) - 1$：\n$$\\lambda(k) = \\frac{1}{6h^2} \\left( -15 + 16\\cos(kh) - (2\\cos^2(kh) - 1) \\right)$$\n$$\\lambda(k) = \\frac{1}{6h^2} \\left( -14 + 16\\cos(kh) - 2\\cos^2(kh) \\right)$$\n提出因子 $-2$：\n$$\\lambda(k) = \\frac{-2}{6h^2} \\left( \\cos^2(kh) - 8\\cos(kh) + 7 \\right)$$\n$$\\lambda(k) = -\\frac{1}{3h^2} \\left( \\cos^2(kh) - 8\\cos(kh) + 7 \\right)$$\n关于 $\\cos(kh)$ 的二次多项式可以因式分解为 $(\\cos(kh)-1)(\\cos(kh)-7)$。\n$$\\lambda(k) = -\\frac{1}{3h^2} (\\cos(kh) - 1)(\\cos(kh) - 7)$$\n使用半角恒等式 $\\cos(\\theta) - 1 = -2\\sin^2(\\frac{\\theta}{2})$，该表达式可以进一步简化：\n$$\\lambda(k) = -\\frac{1}{3h^2} \\left(-2\\sin^2\\left(\\frac{kh}{2}\\right)\\right) \\left(\\cos(kh) - 7\\right)$$\n$$\\lambda(k) = \\frac{2}{3h^2} \\sin^2\\left(\\frac{kh}{2}\\right) \\left(\\cos(kh) - 7\\right)$$\n最后，使用 $\\cos(\\theta) = 1 - 2\\sin^2(\\frac{\\theta}{2})$ 将 $\\cos(kh)$ 用 $\\sin^2(\\frac{kh}{2})$ 表示：\n$$\\lambda(k) = \\frac{2}{3h^2} \\sin^2\\left(\\frac{kh}{2}\\right) \\left( \\left(1 - 2\\sin^2\\left(\\frac{kh}{2}\\right)\\right) - 7 \\right)$$\n$$\\lambda(k) = \\frac{2}{3h^2} \\sin^2\\left(\\frac{kh}{2}\\right) \\left( -6 - 2\\sin^2\\left(\\frac{kh}{2}\\right) \\right)$$\n$$\\lambda(k) = -\\frac{4}{3h^2} \\sin^2\\left(\\frac{kh}{2}\\right) \\left( 3 + \\sin^2\\left(\\frac{kh}{2}\\right) \\right)$$\n这个最终形式特别具有启发性。相应的二阶精度格式的特征值为 $-\\frac{4}{h^2}\\sin^2(\\frac{kh}{2})$。我们的四阶特征值是对其的一个修正，乘以因子 $\\frac{1}{3}(3+\\sin^2(\\frac{kh}{2}))$。当 $kh \\to 0$ 时，该因子趋近于 $1$，泰勒展开可证实该格式的四阶精度。",
            "answer": "$$\\boxed{-\\frac{4}{3h^{2}} \\sin^{2}\\left(\\frac{kh}{2}\\right) \\left(3 + \\sin^{2}\\left(\\frac{kh}{2}\\right)\\right)}$$"
        },
        {
            "introduction": "选择一个高精度的差分格式只是成功的一半；差分格式与网格配置的相互作用同样至关重要。一个看似合理的离散化选择有时会引入非物理的“计算模态”，从而污染数值解。本练习 () 探讨了一个经典的例子：在非交错的Arakawa A-网格上使用中心差分格式，会导致虚假的静止波（波长为 $2h$）的产生，这揭示了在地球物理流体动力学模型中网格设计的重要性。",
            "id": "4042432",
            "problem": "考虑一个一维无粘浅水层，其平均深度为 $H$，重力加速度为 $g$。该水层位于一个长度为 $L$ 的 $x$ 方向周期性域上，域上有 $N$ 个均匀分布的网格点，网格间距为 $h = L/N$。该水层初始处于静止状态，并伴有小扰动。小扰动的线性化浅水方程由动量守恒和质量守恒导出：动量方程为 $\\partial u/\\partial t = - g \\, \\partial \\eta/\\partial x$，质量连续性方程为 $\\partial \\eta/\\partial t = - H \\, \\partial u/\\partial x$，其中 $u(x,t)$ 是纬向速度，$\\eta(x,t)$ 是自由面位移。\n\n在 Arakawa A-网格（A-网格）上，$u$ 和 $\\eta$ 都同位配置在相同的网格点 $x_i = i h$ 上（其中 $i$ 为整数）。在 A-网格上使用二阶中心有限差分，构建线性化浅水方程的半离散形式（时间上连续，空间上离散），其中离散压力梯度算子作用于每个网格点上的 $\\eta$。假设采用周期性边界条件，因此下标对 $N$ 取模。\n\n将半离散系统视为在离散平移下不变，考虑形式为 $u_i(t) = U \\, \\exp\\!\\big(i (k x_i - \\omega t)\\big)$ 和 $\\eta_i(t) = \\Eta \\, \\exp\\!\\big(i (k x_i - \\omega t)\\big)$ 的离散正规模，其中波数 $k$ 为实数，角频率为 $\\omega$。使用此拟设，推导由半离散方程所蕴含的离散色散关系 $\\omega(k)$，并严格证明波长为 $2h$ 的伪计算模的出现，该模式通过离散压力梯度算子与速度解耦。\n\n最后，计算对应于波数 $k = \\pi/h$ 的 $2h$ 模的角频率 $\\omega$，并报告其值。最终的角频率以 $\\mathrm{s}^{-1}$ 为单位表示。无需四舍五入。",
            "solution": "基本依据是围绕静止和恒定深度状态线性化的浅水流的动量和质量守恒。一维空间中的线性化浅水方程为\n$$\n\\frac{\\partial u}{\\partial t} = - g \\, \\frac{\\partial \\eta}{\\partial x}, \\qquad\n\\frac{\\partial \\eta}{\\partial t} = - H \\, \\frac{\\partial u}{\\partial x}.\n$$\n在 Arakawa A-网格（A-网格）上，变量 $u$ 和 $\\eta$ 定义在相同的网格点 $x_i = i h$ 上（其中 $i$ 为整数）。我们用二阶中心有限差分来离散化空间导数。作用于网格点 $i$ 上的离散自由面位移 $\\eta_i$ 的离散压力梯度算子 $G$ 是\n$$\n(G \\eta)_i = \\frac{\\eta_{i+1} - \\eta_{i-1}}{2 h}.\n$$\n类似地，作用于 $u_i$ 的离散散度算子 $D$ 是\n$$\n(D u)_i = \\frac{u_{i+1} - u_{i-1}}{2 h}.\n$$\n利用这些算子和周期性边界条件（下标对 $N$ 取模），半离散的线性化浅水方程为\n$$\n\\frac{d u_i}{d t} = - g \\, (G \\eta)_i = - g \\, \\frac{\\eta_{i+1} - \\eta_{i-1}}{2 h}, \\qquad\n\\frac{d \\eta_i}{d t} = - H \\, (D u)_i = - H \\, \\frac{u_{i+1} - u_{i-1}}{2 h}.\n$$\n为了分析模态结构，我们使用离散正规模拟设（ansatz）\n$$\nu_i(t) = U \\, \\exp\\!\\big(i (k x_i - \\omega t)\\big), \\qquad\n\\eta_i(t) = \\Eta \\, \\exp\\!\\big(i (k x_i - \\omega t)\\big),\n$$\n其中 $k$ 为实数，$\\omega$ 为复数（为了一般性）。在此拟设下，平面波的中心有限差分计算如下：\n$$\n\\frac{\\eta_{i+1} - \\eta_{i-1}}{2 h}\n= \\frac{\\Eta \\exp\\!\\big(i(k x_{i+1} - \\omega t)\\big) - \\Eta \\exp\\!\\big(i(k x_{i-1} - \\omega t)\\big)}{2 h}\n= \\frac{\\Eta \\exp\\!\\big(i(k x_i - \\omega t)\\big)\\big(\\exp(i k h) - \\exp(- i k h)\\big)}{2 h}\n= \\Eta \\exp\\!\\big(i(k x_i - \\omega t)\\big) \\cdot \\frac{i \\, \\sin(k h)}{h}.\n$$\n因此，离散梯度算子作用于平面波会产生原波的 $i D(k)$ 倍，其中我们定义实数符号\n$$\nD(k) \\equiv \\frac{\\sin(k h)}{h}.\n$$\n同样的情况也适用于作用于 $u_i$ 的离散散度，即\n$$\n\\frac{u_{i+1} - u_{i-1}}{2 h} = U \\exp\\!\\big(i(k x_i - \\omega t)\\big) \\cdot \\frac{i \\, \\sin(k h)}{h} = i D(k) \\, U \\exp\\!\\big(i(k x_i - \\omega t)\\big).\n$$\n将这些代入半离散方程并消去公因子 $\\exp\\!\\big(i(k x_i - \\omega t)\\big)$，得到代数系统\n$$\n- i \\omega \\, U = - g \\, i D(k) \\, \\Eta \\quad \\Longrightarrow \\quad \\omega \\, U = g \\, D(k) \\, \\Eta,\n$$\n$$\n- i \\omega \\, \\Eta = - H \\, i D(k) \\, U \\quad \\Longrightarrow \\quad \\omega \\, \\Eta = H \\, D(k) \\, U.\n$$\n消去 $U$ 和 $\\Eta$ 得到离散色散关系。将第一个方程乘以 $\\omega$ 并代入第二个方程：\n$$\n\\omega^{2} \\, U = g \\, D(k) \\, \\omega \\, \\Eta = g \\, D(k) \\, \\big(H \\, D(k) \\, U\\big) \\quad \\Longrightarrow \\quad \\omega^{2} = g H \\, D(k)^{2}.\n$$\n具体来说，\n$$\n\\omega^{2}(k) = g H \\left(\\frac{\\sin(k h)}{h}\\right)^{2}.\n$$\n这个关系式显示了离散空间差分如何通过将 $k$ 替换为离散波数函数 $\\sin(k h)/h$ 来修正连续色散关系 $\\omega^{2} = g H k^{2}$。\n\n我们现在来证明波长为 $2 h$ 的伪计算模。波长 $\\lambda$ 对应于波数 $k = 2 \\pi / \\lambda$。对于 $\\lambda = 2 h$，波数为\n$$\nk = \\frac{2 \\pi}{2 h} = \\frac{\\pi}{h}.\n$$\n计算离散波数函数在 $k = \\pi/h$ 处的值，得到\n$$\nD\\!\\left(\\frac{\\pi}{h}\\right) = \\frac{\\sin\\!\\big((\\pi/h) h\\big)}{h} = \\frac{\\sin(\\pi)}{h} = 0.\n$$\n因此，离散压力梯度和散度算子会湮灭 $2 h$ 模：\n$$\n(G \\eta)_i = \\frac{\\eta_{i+1} - \\eta_{i-1}}{2 h} = 0, \\qquad (D u)_i = \\frac{u_{i+1} - u_{i-1}}{2 h} = 0,\n$$\n对于任何交替的棋盘格模式 $\\eta_i \\propto (-1)^i$ 和 $u_i \\propto (-1)^i$。从物理上看，对于此网格尺度的模，离散压力梯度为零，因此速度不受 $\\eta$ 的强迫作用；反之，散度为零，因此 $\\eta$ 不会因 $u$ 而产生变化趋势。在模态分析中，这种解耦表现为\n$$\n\\omega^{2}\\!\\left(\\frac{\\pi}{h}\\right) = g H \\left(\\frac{\\sin(\\pi)}{h}\\right)^{2} = 0 \\quad \\Longrightarrow \\quad \\omega\\!\\left(\\frac{\\pi}{h}\\right) = 0.\n$$\n因此，$2h$ 模是一个静止的伪计算模，它由于 A-网格上的离散压力梯度算子而与动力学过程解耦。所要求的对应于 $k = \\pi/h$ 的角频率，以 $\\mathrm{s}^{-1}$ 为单位表示，其值为零。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "理论分析为我们提供了关于数值格式行为的深刻见解，但通过实际编程和计算来观察这些行为同样不可或缺。本练习 () 要求你编写代码，对比一个一阶迎风格式和一个二阶格式在求解线性平流方程时的表现。通过计算它们在平流一个阶梯函数时的误差演变，你将亲眼见证数值耗散与数值频散这两种典型的数值误差，并定量地评估不同格式的性能。",
            "id": "4042465",
            "problem": "考虑一维线性平流方程 $u_t + c\\,u_x = 0$，其定义在周期性域 $x \\in [0,1)$ 上，其中 $c > 0$ 是一个恒定的平流速度。设初始条件为一个无量纲阶跃函数，定义为当 $x \\in [a,b)$ 时 $u(x,0) = 1$，否则 $u(x,0) = 0$，其中 $a = 0.25$，$b = 0.5$。在周期性边界条件下，精确解是通过以速度 $c$ 对初始条件进行刚性平移得到的。\n\n你的任务是为该问题实现两种显式有限差分格式，并在相同的 Courant–Friedrichs–Lewy (CFL) 数下，比较 $L^1$ 和 $L^2$ 误差范数随时间的演变。这两种格式是：\n- 针对正 $c$ 的一阶迎风有限差分格式（供体单元）。\n- 一种二阶精确格式，该格式由空间上的二阶中心差分和时间上的二阶泰勒展开构造而成（通常认为此格式在该方程上对于 $0 \\le \\nu \\le 1$ 是相容且稳定的），其中 $\\nu = c\\,\\Delta t / \\Delta x$ 是 CFL 数。\n\n对于每个测试用例，两种方法必须使用相同的网格、相同的时间步长和相同的 CFL 数。域必须用 $[0,1)$ 上的 $N$ 个等距点进行离散化，并采用周期性边界条件。将解变量 $u$ 视为无量纲；所有误差均报告为无量纲量。\n\n对于每种方法，计算数值解，并在指定的输出时间将其与精确解进行比较。时间 $t$ 处的精确解通过平移初始阶跃函数给出：如果 $(x - c t) \\bmod 1 \\in [a,b)$，则 $u_{\\text{exact}}(x,t) = 1$，否则 $u_{\\text{exact}}(x,t) = 0$。离散 $L^1$ 误差必须计算为黎曼和 $L^1 = \\Delta x \\sum_j |u_j - u_{\\text{exact},j}|$，离散 $L^2$ 误差必须计算为 $L^2 = \\sqrt{\\Delta x \\sum_j (u_j - u_{\\text{exact},j})^2}$。\n\n在每个测试用例中，两种方法使用相同的 CFL 数 $\\nu$，时间步长为 $\\Delta t = \\nu\\,\\Delta x / c$。输出时间将指定为总积分时间 $T$ 的分数。在每个输出时间，记录两种格式的 $L^1$ 和 $L^2$ 误差。\n\n测试套件：\n- 测试用例 1（理想情况）：$N = 400$，$c = 1.0$，$\\nu = 0.8$，$T = 1.0$，输出时间为 $[0.0, 0.25, 0.5, 0.75, 1.0] \\times T$。\n- 测试用例 2（边界CFL）：$N = 200$，$c = 1.0$，$\\nu = 1.0$，$T = 1.0$，输出时间为 $[0.0, 0.25, 0.5, 0.75, 1.0] \\times T$。\n- 测试用例 3（粗网格）：$N = 50$，$c = 1.0$，$\\nu = 0.5$，$T = 1.0$，输出时间为 $[0.0, 0.25, 0.5, 0.75, 1.0] \\times T$。\n\n实现细节：\n- 网格点 $x_j$ 应均匀分布，间距为 $\\Delta x = 1/N$，且必须使用周期性边界条件。\n- 一阶迎风格式必须是针对 $c > 0$ 的标准供体单元迎风格式。\n- 二阶精确格式必须从空间上的二阶中心差分和与平流方程一致的二阶时间精度导出；使用与迎风格式相同的 CFL 数。\n- 对于每个测试用例，使用在网格点上从所述阶跃函数采样的相同离散初始条件来初始化两种格式的数值解。\n- 使用相同的 $\\Delta t$ 将两种格式在时间上向前推进，直到达到请求的最大输出时间。在每个请求的输出时间，通过将初始条件平移 $c t$ 来计算精确解，并计算两种格式的 $L^1$ 和 $L^2$ 误差。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。最外层的列表必须为每个测试用例包含一个条目。每个测试用例条目本身必须是一个包含两个列表的列表：第一个对应于一阶迎风格式，第二个对应于二阶格式。在这些内层列表中的每一个里，按时间顺序放置每个输出时间的 $L^1$ 和 $L^2$ 误差。所有数值必须打印为四舍五入到小数点后八位的十进制浮点数。具体来说，对于一个有 $K+1$ 个输出时间的测试用例，结构是：\n$[[L^1_{\\text{up}}(t_0), L^2_{\\text{up}}(t_0), L^1_{\\text{up}}(t_1), L^2_{\\text{up}}(t_1), \\dots, L^1_{\\text{up}}(t_K), L^2_{\\text{up}}(t_K)], [L^1_{\\text{sec}}(t_0), L^2_{\\text{sec}}(t_0), L^1_{\\text{sec}}(t_1), L^2_{\\text{sec}}(t_1), \\dots, L^1_{\\text{sec}}(t_K), L^2_{\\text{sec}}(t_K)]]$\n程序必须将三个测试用例的结果聚合成一个单一列表，最终生成一个单行输出字符串，格式如下：\n$[[\\dots],[\\dots],[\\dots]]$\n其中每个数字都四舍五入到小数点后八位，不含任何额外文本。",
            "solution": "## 问题验证\n\n### 步骤 1：提取已知条件\n\n- **控制方程**：一维线性平流方程 $u_t + c\\,u_x = 0$，定义在周期性域上，其中 $c > 0$ 是一个常数。\n- **域**：$x \\in [0,1)$。\n- **初始条件**：一个阶跃函数 $u(x,0) = 1$（对于 $x \\in [a,b)$）和 $u(x,0) = 0$（其他情况），其中 $a = 0.25$，$b = 0.5$。\n- **离散化**：域被离散化为 $N$ 个等距点。\n- **数值格式**：\n  1. 一阶迎风有限差分格式（供体单元）。\n  2. 由空间二阶中心差分和时间二阶泰勒展开构造的二阶精确格式。\n- **Courant–Friedrichs–Lewy (CFL) 数**：$\\nu = c\\,\\Delta t / \\Delta x$，在给定的测试用例中，两种格式的该值保持不变。\n- **时间步长**：$\\Delta t = \\nu\\,\\Delta x / c$。\n- **精确解**：$u_{\\text{exact}}(x,t) = 1$（如果 $(x - c t) \\bmod 1 \\in [a,b)$），否则 $u_{\\text{exact}}(x,t) = 0$。\n- **误差范数**：\n  - 离散 $L^1$ 误差：$L^1 = \\Delta x \\sum_j |u_j - u_{\\text{exact},j}|$。\n  - 离散 $L^2$ 误差：$L^2 = \\sqrt{\\Delta x \\sum_j (u_j - u_{\\text{exact},j})^2}$。\n- **测试套件**：\n  - 测试用例 1：$N = 400$，$c = 1.0$，$\\nu = 0.8$，$T = 1.0$，输出时间为 $[0.0, 0.25, 0.5, 0.75, 1.0] \\times T$。\n  - 测试用例 2：$N = 200$，$c = 1.0$，$\\nu = 1.0$，$T = 1.0$，输出时间为 $[0.0, 0.25, 0.5, 0.75, 1.0] \\times T$。\n  - 测试用例 3：$N = 50$，$c = 1.0$，$\\nu = 0.5$，$T = 1.0$，输出时间为 $[0.0, 0.25, 0.5, 0.75, 1.0] \\times T$。\n- **输出格式**：一个特定的嵌套列表结构，包含每个测试用例在所有指定输出时间下两种格式的 $L^1$ 和 $L^2$ 误差，四舍五入到八位小数。\n\n### 步骤 2：使用提取的已知条件进行验证\n\n根据指定标准对问题进行验证。\n\n- **科学依据**：该问题基于线性平流方程，这是物理学和工程学中的一个基本偏微分方程。所用的数值方法（一阶迎风和二阶 Lax-Wendroff）是求解双曲型偏微分方程的标准、成熟技术。CFL 数、稳定性和误差范数的概念是数值分析的核心。该问题在科学上是合理的。\n- **适定性**：该问题是适定的。给定初始条件的线性平流方程初值问题有唯一解。所指定的数值格式是条件稳定的。一阶迎风格式在 $0 \\le \\nu \\le 1$ 时稳定，二阶格式（Lax-Wendroff）在 $0 \\le \\nu \\le 1$ 时稳定（给定 $c>0$）。测试套件中所有指定的 CFL 数（$\\nu=0.8, 1.0, 0.5$）都在此稳定范围内。该问题的结构能产生唯一的数值解。\n- **客观性**：问题使用精确、客观的数学和计算语言陈述。所有参数都已明确定义，任务明确无歧义。\n- **缺陷检查清单**：\n  1. 不存在科学或事实上的不准确之处。\n  2. 该问题是计算流体动力学和数值分析中的一个正式且典型的任务。\n  3. 问题设置完整。为每个测试用例提供了所有必要参数（$N, c, \\nu, T$ 和输出时间）。\n  4. 对于数值实验而言，条件在物理上是合理的。所有参数都是无量纲或一致的。\n  5. 问题结构良好，不包含歧义。虽然不连续的初始条件对高阶格式具有挑战性（导致吉布斯振荡），但它是一个标准的测试用例，并不会使问题变得不适定。\n  6. 问题并非琐碎；它要求正确实现和比较两种不同的数值格式，这突出了数值耗散和数值色散等基本概念。\n  7. 结果可以通过实现所述算法并比较输出来进行科学验证。\n\n### 步骤 3：结论与行动\n\n问题陈述是**有效**的，因为它具有科学依据、适定、客观，并且没有指定的缺陷。将提供一个解答。\n\n## 解答\n\n任务是求解一维线性平流方程 $u_t + c\\,u_x = 0$，其中平流速度 $c > 0$ 为正，定义在周期性域 $x \\in [0, 1)$ 上。我们将实现并比较两种显式有限差分格式。\n\n### 离散化\n\n域 $[0, 1)$ 被离散化为 $N$ 个等宽的网格单元，宽度为 $\\Delta x = 1/N$。网格点为 $x_j = j \\Delta x$，其中 $j = 0, 1, \\dots, N-1$。使用均匀的时间步长 $\\Delta t$，时间层表示为 $t^n = n \\Delta t$。解 $u(x_j, t^n)$ 的数值近似表示为 $u_j^n$。Courant-Friedrichs-Lewy (CFL) 数为 $\\nu = c \\Delta t / \\Delta x$。\n\n### 格式 1：一阶迎风（供体单元）\n\n该格式在时间和空间上均为一阶精度。对于 $c > 0$，“迎风”方向来自左侧。我们对时间导数使用向前差分，对空间导数使用向后差分。\n\n$u_t + c u_x = 0$ 的离散化是：\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + c \\frac{u_j^n - u_{j-1}^n}{\\Delta x} = 0\n$$\n求解 $u_j^{n+1}$：\n$$\nu_j^{n+1} = u_j^n - \\frac{c \\Delta t}{\\Delta x} (u_j^n - u_{j-1}^n)\n$$\n代入 CFL 数 $\\nu = c \\Delta t / \\Delta x$，我们得到更新规则：\n$$\nu_j^{n+1} = u_j^n - \\nu (u_j^n - u_{j-1}^n) = (1-\\nu)u_j^n + \\nu u_{j-1}^n\n$$\n已知该格式在 $0 \\le \\nu \\le 1$ 时稳定。它具有高度耗散性，这意味着它会抹平解中的尖锐特征。\n\n### 格式 2：二阶精度格式（Lax-Wendroff）\n\n构造该格式使其在时间和空间上均为二阶精度。我们从时间上的二阶泰勒级数展开开始：\n$$\nu(x_j, t^{n+1}) = u(x_j, t^n) + \\Delta t \\, u_t(x_j, t^n) + \\frac{(\\Delta t)^2}{2} u_{tt}(x_j, t^n) + \\mathcal{O}((\\Delta t)^3)\n$$\n根据控制方程，我们有 $u_t = -c u_x$。对时间求导得到 $u_{tt} = -c u_{xt}$。对空间求导得到 $u_{tx} = -c u_{xx}$。假设足够光滑（$u_{xt} = u_{tx}$），我们发现 $u_{tt} = c^2 u_{xx}$。将这些代入泰勒展开式：\n$$\nu(x_j, t^{n+1}) = u(x_j, t^n) - c \\Delta t \\, u_x(x_j, t^n) + \\frac{c^2 (\\Delta t)^2}{2} u_{xx}(x_j, t^n) + \\mathcal{O}((\\Delta t)^3)\n$$\n现在我们使用二阶中心差分来离散化空间导数：\n$$\nu_x(x_j, t^n) \\approx \\frac{u_{j+1}^n - u_{j-1}^n}{2 \\Delta x}\n$$\n$$\nu_{xx}(x_j, t^n) \\approx \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\\Delta x)^2}\n$$\n将这些代入时间展开的方程中，得到 Lax-Wendroff 格式：\n$$\nu_j^{n+1} = u_j^n - c \\Delta t \\left( \\frac{u_{j+1}^n - u_{j-1}^n}{2 \\Delta x} \\right) + \\frac{c^2 (\\Delta t)^2}{2} \\left( \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\\Delta x)^2} \\right)\n$$\n使用 $\\nu = c \\Delta t / \\Delta x$ 并重排各项：\n$$\nu_j^{n+1} = u_j^n - \\frac{\\nu}{2} (u_{j+1}^n - u_{j-1}^n) + \\frac{\\nu^2}{2} (u_{j+1}^n - 2u_j^n + u_{j-1}^n)\n$$\n$$\nu_j^{n+1} = \\left(\\frac{\\nu^2}{2} - \\frac{\\nu}{2}\\right) u_{j+1}^n + (1 - \\nu^2) u_j^n + \\left(\\frac{\\nu^2}{2} + \\frac{\\nu}{2}\\right) u_{j-1}^n\n$$\n该格式在 $|\\nu| \\le 1$ 时稳定。它具有色散性，这意味着它会在不连续点附近引入伪振荡（吉布斯现象）。\n\n### 实现细节\n\n- **初始条件**：离散初始条件 $u_j^0$ 通过在网格点 $x_j$ 处采样给定的阶跃函数来设置：如果 $x_j \\in [0.25, 0.5)$，则 $u_j^0 = 1$，否则 $u_j^0 = 0$。\n- **周期性边界条件**：域的周期性意味着 $u_{j+N}^n = u_j^n$。访问索引 $j-1$（当 $j=0$ 时）和 $j+1$（当 $j=N-1$ 时）通过环绕数组来处理。例如，$u_{-1}^n \\equiv u_{N-1}^n$ 和 $u_N^n \\equiv u_0^n$。这可以通过数组滚动操作高效实现。\n- **精确解**：时间 $t$ 处的精确解涉及平移初始剖面。点 $x$ 的值等于初始剖面在 $(x - c t)$ 处的值。由于周期性，这被计算为 $(x - c t) \\pmod 1$。离散精确解为：\n$$\nu_{\\text{exact},j}(t) = 1 \\text{ 如果 } (x_j - c t) \\pmod 1 \\in [0.25, 0.5), \\text{ 否则为 } 0\n$$\n- **误差范数**：在每个指定的输出时间 $t$，使用提供的公式计算离散 $L^1$ 和 $L^2$ 误差范数：\n$$\nL^1(t) = \\Delta x \\sum_{j=0}^{N-1} |u_j(t) - u_{\\text{exact},j}(t)|\n$$\n$$\nL^2(t) = \\sqrt{\\Delta x \\sum_{j=0}^{N-1} (u_j(t) - u_{\\text{exact},j}(t))^2}\n$$\n- **算法**：对于由 $\\{N, c, \\nu, T, \\text{输出时间}\\}$ 定义的每个测试用例：\n  1. 计算网格间距 $\\Delta x = 1/N$ 和时间步长 $\\Delta t = \\nu \\Delta x / c$。\n  2. 创建空间网格 $x_j$ 和初始条件数组 $u^0$。用 $u^0$ 初始化两种格式的数组，$u_{\\text{upwind}}$ 和 $u_{\\text{LW}}$。\n  3. 确定与所需输出时间对应的整数时间步。\n  4. 从时间步 $n=0$ 循环到达到 $T$ 所需的最终时间步。\n  5. 如果当前时间步是输出步，则计算精确解，并计算 $u_{\\text{upwind}}$ 和 $u_{\\text{LW}}$ 的 $L^1$ 和 $L^2$ 误差。存储结果。\n  6. 使用各自的有限差分公式将 $u_{\\text{upwind}}$ 和 $u_{\\text{LW}}$ 更新到下一个时间层。\n  7. 处理完所有测试用例后，将收集到的结果格式化为指定的字符串格式。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function to run the numerical experiments and generate output.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'N': 400, 'c': 1.0, 'nu': 0.8, 'T': 1.0, 'output_factors': [0.0, 0.25, 0.5, 0.75, 1.0]},\n        {'N': 200, 'c': 1.0, 'nu': 1.0, 'T': 1.0, 'output_factors': [0.0, 0.25, 0.5, 0.75, 1.0]},\n        {'N': 50, 'c': 1.0, 'nu': 0.5, 'T': 1.0, 'output_factors': [0.0, 0.25, 0.5, 0.75, 1.0]},\n    ]\n    \n    a = 0.25\n    b = 0.5\n    all_test_results = []\n\n    for case in test_cases:\n        N = case['N']\n        c = case['c']\n        nu = case['nu']\n        T = case['T']\n        output_factors = case['output_factors']\n\n        # Discretization\n        dx = 1.0 / N\n        dt = nu * dx / c\n        x = np.linspace(0.0, 1.0, N, endpoint=False)\n\n        # Initial condition\n        u0 = np.zeros(N)\n        u0[(x >= a) & (x < b)] = 1.0\n\n        u_upwind = u0.copy()\n        u_lw = u0.copy()\n\n        results_upwind = []\n        results_lw = []\n\n        output_times = np.array(output_factors) * T\n        # Use np.round to handle potential floating point inaccuracies\n        output_steps = set(np.round(output_times / dt).astype(int))\n        \n        num_steps = int(np.ceil(T / dt))\n\n        for step in range(num_steps + 1):\n            current_t = step * dt\n\n            if step in output_steps:\n                # Calculate exact solution at current_t\n                x_shifted = (x - c * current_t) % 1.0\n                u_exact = np.where((x_shifted >= a) & (x_shifted < b), 1.0, 0.0)\n\n                # Calculate errors for upwind scheme\n                l1_upwind = dx * np.sum(np.abs(u_upwind - u_exact))\n                l2_upwind = np.sqrt(dx * np.sum((u_upwind - u_exact)**2))\n                results_upwind.extend([l1_upwind, l2_upwind])\n\n                # Calculate errors for Lax-Wendroff scheme\n                l1_lw = dx * np.sum(np.abs(u_lw - u_exact))\n                l2_lw = np.sqrt(dx * np.sum((u_lw - u_exact)**2))\n                results_lw.extend([l1_lw, l2_lw])\n            \n            if current_t >= T:\n                break\n\n            # Update solutions\n            # First-order upwind\n            u_upwind = (1 - nu) * u_upwind + nu * np.roll(u_upwind, 1)\n\n            # Second-order Lax-Wendroff\n            u_j_minus_1 = np.roll(u_lw, 1)\n            u_j_plus_1 = np.roll(u_lw, -1)\n            term1 = (nu**2 / 2 - nu / 2) * u_j_plus_1\n            term2 = (1 - nu**2) * u_lw\n            term3 = (nu**2 / 2 + nu / 2) * u_j_minus_1\n            u_lw = term1 + term2 + term3\n\n        all_test_results.append([results_upwind, results_lw])\n\n    # Final print statement in the exact required format.\n    # The structure is a list of test cases. Each test case is a list of two lists (one for each scheme).\n    # Each scheme list contains the L1, L2 errors at each output time.\n    outer_list = []\n    for test_result in all_test_results:\n        case_list_str = []\n        for scheme_result in test_result:\n            scheme_list_str = [f\"{val:.8f}\" for val in scheme_result]\n            case_list_str.append(f\"[{','.join(scheme_list_str)}]\")\n        outer_list.append(f\"[{','.join(case_list_str)}]\")\n    \n    print(f\"[{','.join(outer_list)}]\")\n\nsolve()\n```"
        }
    ]
}