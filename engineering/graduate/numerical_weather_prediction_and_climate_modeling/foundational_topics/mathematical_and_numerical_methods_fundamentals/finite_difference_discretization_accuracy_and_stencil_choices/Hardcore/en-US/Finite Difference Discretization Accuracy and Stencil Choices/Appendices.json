{
    "hands_on_practices": [
        {
            "introduction": "A fundamental goal in numerical modeling is to create discretizations that approximate the continuous equations as accurately as possible. While the standard three-point stencil for the second derivative is second-order accurate, we can achieve higher accuracy by incorporating information from more distant grid points. This practice guides you through the process of constructing a fourth-order accurate stencil for the Laplacian operator using Taylor series expansions and then analyzing its spectral properties, revealing how the choice of stencil modifies the representation of waves on the discrete grid. ",
            "id": "4042504",
            "problem": "Consider a one-dimensional periodic zonal channel of length $L$ used in Numerical Weather Prediction (NWP) and climate modeling to represent horizontally homogeneous dynamics. Let the grid consist of $N$ equally spaced points with grid spacing $h = L/N$ and locations $x_{j} = j h$ for integer $j$. The continuous Laplacian in one dimension is $\\nabla^{2} u = \\frac{d^{2} u}{d x^{2}}$. You are asked to construct a fourth-order accurate finite difference discretization for $\\nabla^{2}$ on this grid and determine the discrete eigenvalues under periodic boundary conditions using Fourier modes.\n\nStarting from fundamental principles, use Taylor expansions about $x_{j}$ to derive a symmetric five-point stencil of the form\n$$\n\\mathcal{L}_{h} u_{j} \\equiv \\frac{a\\,u_{j-2} + b\\,u_{j-1} + c\\,u_{j} + b\\,u_{j+1} + a\\,u_{j+2}}{h^{2}},\n$$\nwhere $a$, $b$, and $c$ are constants to be determined such that $\\mathcal{L}_{h} u_{j}$ is fourth-order accurate for approximating $\\frac{d^{2}u}{dx^{2}}$ at $x_{j}$ for smooth $u(x)$.\n\nThen, using the Fourier mode ansatz $u_{j} = \\exp(i k x_{j})$ with wavenumber $k = \\frac{2 \\pi m}{L}$ for integer $m$ and periodic boundary conditions, determine the discrete eigenvalue $\\lambda(k)$ defined by $\\mathcal{L}_{h} u_{j} = \\lambda(k)\\, u_{j}$.\n\nYour final answer must be a single closed-form analytic expression for $\\lambda(k)$ in terms of the wavenumber $k$ and the grid spacing $h$. No numerical evaluation is required. Do not provide intermediate formulas in your final answer. If you introduce any acronyms, spell them out on first use. If any units are discussed, recall that eigenvalues of the Laplacian have units of inverse-square length, but do not include units in the final boxed answer.",
            "solution": "The user has requested the derivation of a fourth-order accurate finite difference stencil for the one-dimensional Laplacian and the subsequent determination of its discrete eigenvalues under periodic boundary conditions.\n\nFirst, I will validate the problem statement.\n\n### Step 1: Extract Givens\n- Domain: A one-dimensional periodic channel of length $L$.\n- Grid: $N$ equally spaced points with spacing $h = L/N$ and locations $x_{j} = j h$.\n- Continuous operator: $\\nabla^{2} u = \\frac{d^{2} u}{d x^{2}}$.\n- Discrete operator form: $\\mathcal{L}_{h} u_{j} \\equiv \\frac{a\\,u_{j-2} + b\\,u_{j-1} + c\\,u_{j} + b\\,u_{j+1} + a\\,u_{j+2}}{h^{2}}$.\n- Accuracy requirement: Fourth-order, meaning the truncation error is $O(h^{4})$.\n- Analysis tool: Fourier mode ansatz $u_{j} = \\exp(i k x_{j})$ with wavenumber $k = \\frac{2 \\pi m}{L}$ for integer $m$.\n- Definition of eigenvalue: $\\mathcal{L}_{h} u_{j} = \\lambda(k)\\, u_{j}$.\n- Final answer requirement: A single closed-form analytic expression for $\\lambda(k)$ in terms of $k$ and $h$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, as it is a standard and fundamental exercise in the field of numerical analysis, specifically for methods used in fluid dynamics and geophysical modeling disciplines such as Numerical Weather Prediction (NWP). The problem is well-posed, with a clear objective and sufficient constraints to determine a unique solution. The language is objective and mathematically precise. The problem is free of any of the invalidating flaws listed in the instructions. It is a complete, consistent, and formalizable theoretical problem.\n\n### Step 3: Verdict and Action\nThe problem is valid. I will proceed with the detailed solution.\n\nThe solution proceeds in two parts: first, the determination of the stencil coefficients $a$, $b$, and $c$, and second, the calculation of the discrete eigenvalue $\\lambda(k)$.\n\nPart 1: Derivation of the Stencil Coefficients\n\nOur goal is to find the constants $a$, $b$, and $c$ such that the discrete operator $\\mathcal{L}_{h} u_{j}$ approximates the continuous second derivative $\\frac{d^{2}u}{dx^{2}}$ at point $x_j$ with a truncation error of order $h^4$. We achieve this by using Taylor series expansions of $u(x)$ around the point $x_j$. Let $u_j = u(x_j)$ and $u^{(n)}|_j = \\frac{d^n u}{dx^n}|_{x_j}$.\n\nThe Taylor expansions for the terms in the stencil are:\n$$u_{j \\pm p} = u(x_j \\pm ph) = u_j \\pm (ph) u'|_j + \\frac{(ph)^2}{2!} u''|_j \\pm \\frac{(ph)^3}{3!} u'''|_j + \\frac{(ph)^4}{4!} u^{(4)}|_j + \\frac{(ph)^5}{5!} u^{(5)}|_j + \\frac{(ph)^6}{6!} u^{(6)}|_j + O(h^7)$$\nDue to the symmetry of the stencil ($u_{j-p}$ and $u_{j+p}$ have the same coefficient), odd-order derivative terms will cancel when we form sums. We compute the relevant symmetric sums:\n$$u_{j-1} + u_{j+1} = 2u_j + h^2 u''|_j + \\frac{h^4}{12} u^{(4)}|_j + \\frac{h^6}{360} u^{(6)}|_j + O(h^8)$$\n$$u_{j-2} + u_{j+2} = 2u_j + 4h^2 u''|_j + \\frac{16h^4}{12} u^{(4)}|_j + \\frac{64h^6}{360} u^{(6)}|_j + O(h^8)$$\nSubstituting these into the expression for the operator $\\mathcal{L}_h u_j$:\n$$h^2 \\mathcal{L}_h u_j = a(u_{j-2} + u_{j+2}) + b(u_{j-1} + u_{j+1}) + c u_j$$\n$$h^2 \\mathcal{L}_h u_j = a\\left(2u_j + 4h^2 u''|_j + \\frac{4h^4}{3} u^{(4)}|_j + \\dots\\right) + b\\left(2u_j + h^2 u''|_j + \\frac{h^4}{12} u^{(4)}|_j + \\dots\\right) + c u_j$$\nWe collect terms by the derivatives of $u$:\n$$h^2 \\mathcal{L}_h u_j = (2a+2b+c)u_j + (4a+b)h^2 u''|_j + \\left(\\frac{4a}{3} + \\frac{b}{12}\\right)h^4 u^{(4)}|_j + O(h^6)$$\nFor $\\mathcal{L}_h u_j$ to be a consistent approximation of $u''|_j$, we require the coefficient of $h^2 u''|_j$ on the right-hand side to be $1$, and the coefficients of lower-order terms (i.e., $u_j$) to be zero. For the approximation to be fourth-order accurate, the coefficient of the $h^4 u^{(4)}|_j$ term must also be zero. This gives us a system of three linear equations for $a$, $b$, and $c$:\n1. Coefficient of $u_j$: $2a + 2b + c = 0$\n2. Coefficient of $h^2 u''|_j$: $4a + b = 1$\n3. Coefficient of $h^4 u^{(4)}|_j$: $\\frac{4a}{3} + \\frac{b}{12} = 0$, which simplifies to $16a + b = 0$.\n\nFrom equation (3), we find $b = -16a$. Substituting this into equation (2) gives $4a - 16a = 1$, which yields $-12a = 1$, so $a = -\\frac{1}{12}$.\nConsequently, $b = -16(-\\frac{1}{12}) = \\frac{16}{12} = \\frac{4}{3}$.\nFinally, from equation (1), we find $c = -2a - 2b = -2(-\\frac{1}{12}) - 2(\\frac{4}{3}) = \\frac{1}{6} - \\frac{8}{3} = \\frac{1}{6} - \\frac{16}{6} = -\\frac{15}{6} = -\\frac{5}{2}$.\nThe coefficients are $a = -\\frac{1}{12}$, $b = \\frac{4}{3}$, and $c = -\\frac{5}{2}$.\n\nPart 2: Determination of the Discrete Eigenvalue $\\lambda(k)$\n\nWe now analyze the action of the derived discrete operator on a single Fourier mode, $u_j = \\exp(ikx_j) = \\exp(ikjh)$. The values at neighboring grid points are related by a phase shift:\n$$u_{j\\pm p} = \\exp(ik(j\\pm p)h) = \\exp(ikjh) \\exp(\\pm ikph) = u_j \\exp(\\pm ikph)$$\nWe substitute this into the discrete operator expression:\n$$\\mathcal{L}_{h} u_{j} = \\frac{1}{h^{2}} \\left( a u_{j-2} + b u_{j-1} + c u_j + b u_{j+1} + a u_{j+2} \\right)$$\n$$\\mathcal{L}_{h} u_{j} = \\frac{u_j}{h^{2}} \\left( a e^{-i2kh} + b e^{-ikh} + c + b e^{ikh} + a e^{i2kh} \\right)$$\nBy definition, $\\mathcal{L}_{h} u_{j} = \\lambda(k) u_j$, so the eigenvalue $\\lambda(k)$ is the term multiplying $u_j$:\n$$\\lambda(k) = \\frac{1}{h^{2}} \\left( c + b(e^{ikh} + e^{-ikh}) + a(e^{i2kh} + e^{-i2kh}) \\right)$$\nUsing Euler's identity, $e^{i\\theta} + e^{-i\\theta} = 2\\cos(\\theta)$, we get:\n$$\\lambda(k) = \\frac{1}{h^{2}} \\left( c + 2b \\cos(kh) + 2a \\cos(2kh) \\right)$$\nNow, we substitute the values for $a$, $b$, and $c$:\n$$\\lambda(k) = \\frac{1}{h^{2}} \\left( -\\frac{5}{2} + 2\\left(\\frac{4}{3}\\right) \\cos(kh) + 2\\left(-\\frac{1}{12}\\right) \\cos(2kh) \\right)$$\n$$\\lambda(k) = \\frac{1}{h^2} \\left( -\\frac{5}{2} + \\frac{8}{3} \\cos(kh) - \\frac{1}{6} \\cos(2kh) \\right)$$\nTo simplify this expression, we put everything over a common denominator of $6$:\n$$\\lambda(k) = \\frac{1}{6h^2} \\left( -15 + 16\\cos(kh) - \\cos(2kh) \\right)$$\nWe use the double-angle identity $\\cos(2\\theta) = 2\\cos^2(\\theta) - 1$:\n$$\\lambda(k) = \\frac{1}{6h^2} \\left( -15 + 16\\cos(kh) - (2\\cos^2(kh) - 1) \\right)$$\n$$\\lambda(k) = \\frac{1}{6h^2} \\left( -14 + 16\\cos(kh) - 2\\cos^2(kh) \\right)$$\nFactoring out $-2$:\n$$\\lambda(k) = \\frac{-2}{6h^2} \\left( \\cos^2(kh) - 8\\cos(kh) + 7 \\right)$$\n$$\\lambda(k) = -\\frac{1}{3h^2} \\left( \\cos^2(kh) - 8\\cos(kh) + 7 \\right)$$\nThe quadratic in $\\cos(kh)$ can be factored as $(\\cos(kh)-1)(\\cos(kh)-7)$.\n$$\\lambda(k) = -\\frac{1}{3h^2} (\\cos(kh) - 1)(\\cos(kh) - 7)$$\nThis expression can be further simplified using the half-angle identity $\\cos(\\theta) - 1 = -2\\sin^2(\\frac{\\theta}{2})$:\n$$\\lambda(k) = -\\frac{1}{3h^2} \\left(-2\\sin^2\\left(\\frac{kh}{2}\\right)\\right) \\left(\\cos(kh) - 7\\right)$$\n$$\\lambda(k) = \\frac{2}{3h^2} \\sin^2\\left(\\frac{kh}{2}\\right) \\left(\\cos(kh) - 7\\right)$$\nFinally, expressing $\\cos(kh)$ in terms of $\\sin^2(\\frac{kh}{2})$ using $\\cos(\\theta) = 1 - 2\\sin^2(\\frac{\\theta}{2})$:\n$$\\lambda(k) = \\frac{2}{3h^2} \\sin^2\\left(\\frac{kh}{2}\\right) \\left( \\left(1 - 2\\sin^2\\left(\\frac{kh}{2}\\right)\\right) - 7 \\right)$$\n$$\\lambda(k) = \\frac{2}{3h^2} \\sin^2\\left(\\frac{kh}{2}\\right) \\left( -6 - 2\\sin^2\\left(\\frac{kh}{2}\\right) \\right)$$\n$$\\lambda(k) = -\\frac{4}{3h^2} \\sin^2\\left(\\frac{kh}{2}\\right) \\left( 3 + \\sin^2\\left(\\frac{kh}{2}\\right) \\right)$$\nThis final form is particularly insightful. The eigenvalue for the corresponding second-order accurate stencil is $-\\frac{4}{h^2}\\sin^2(\\frac{kh}{2})$. Our fourth-order eigenvalue is a correction to this, scaled by the factor $\\frac{1}{3}(3+\\sin^2(\\frac{kh}{2}))$. As $kh \\to 0$, this factor approaches $1$, and a Taylor expansion confirms the fourth-order accuracy of the scheme.",
            "answer": "$$\\boxed{-\\frac{4}{3h^{2}} \\sin^{2}\\left(\\frac{kh}{2}\\right) \\left(3 + \\sin^{2}\\left(\\frac{kh}{2}\\right)\\right)}$$"
        },
        {
            "introduction": "Achieving formal truncation accuracy is a necessary but not sufficient condition for a reliable numerical scheme. The specific arrangement of variables on the grid, combined with the choice of finite difference stencil, can permit non-physical solutions known as spurious computational modes. This exercise explores a classic example of this problem on a collocated Arakawa A-grid, where you will demonstrate how a standard centered-difference approximation of the pressure gradient fails to control grid-scale oscillations, leading to a stationary, decoupled mode. ",
            "id": "4042432",
            "problem": "A one-dimensional, inviscid shallow layer of water of mean depth $H$ and gravitational acceleration $g$ is considered on an $x$-periodic domain of length $L$ with $N$ uniformly spaced grid points and grid spacing $h = L/N$. The layer is initially at rest with small perturbations. The linearized shallow-water equations for small perturbations are derived from conservation of momentum and mass: the momentum equation is $\\partial u/\\partial t = - g \\, \\partial \\eta/\\partial x$ and the mass continuity equation is $\\partial \\eta/\\partial t = - H \\, \\partial u/\\partial x$, where $u(x,t)$ is the zonal velocity and $\\eta(x,t)$ is the free-surface displacement.\n\nOn an Arakawa A-grid (A-grid), both $u$ and $\\eta$ are co-located at the same grid points $x_i = i h$ for integer $i$. Using second-order centered finite differences on the A-grid, construct the semi-discrete form (continuous in time, discrete in space) of the linearized shallow-water equations with the discrete pressure gradient operator acting on $\\eta$ at each grid point. Assume periodic boundary conditions so that indices are taken modulo $N$.\n\nTreating the semi-discrete system as invariant under discrete translations, consider discrete normal modes of the form $u_i(t) = U \\, \\exp\\!\\big(i (k x_i - \\omega t)\\big)$ and $\\eta_i(t) = \\Eta \\, \\exp\\!\\big(i (k x_i - \\omega t)\\big)$ for real wavenumber $k$ and angular frequency $\\omega$. Using this ansatz, derive the discrete dispersion relation $\\omega(k)$ implied by the semi-discrete equations and demonstrate rigorously the emergence of a spurious computational mode with wavelength $2h$ that decouples from velocity through the discrete pressure gradient operator.\n\nFinally, evaluate the angular frequency $\\omega$ for the $2h$ mode, which corresponds to the wavenumber $k = \\pi/h$, and report its value. Express the final angular frequency in $\\mathrm{s}^{-1}$. No rounding is required.",
            "solution": "The fundamental base is the conservation of momentum and mass for shallow-water flow linearized about a state of rest and constant depth. The linearized shallow-water equations in one spatial dimension are\n$$\n\\frac{\\partial u}{\\partial t} = - g \\, \\frac{\\partial \\eta}{\\partial x}, \\qquad\n\\frac{\\partial \\eta}{\\partial t} = - H \\, \\frac{\\partial u}{\\partial x}.\n$$\nOn an Arakawa A-grid (A-grid), the variables $u$ and $\\eta$ are defined at the same grid points $x_i = i h$ for integer $i$. We discretize the spatial derivatives with second-order centered finite differences. The discrete pressure gradient operator $G$ acting on the discrete free-surface displacement $\\eta_i$ at grid point $i$ is\n$$\n(G \\eta)_i = \\frac{\\eta_{i+1} - \\eta_{i-1}}{2 h}.\n$$\nSimilarly, the discrete divergence operator $D$ acting on $u_i$ is\n$$\n(D u)_i = \\frac{u_{i+1} - u_{i-1}}{2 h}.\n$$\nWith these operators and periodic boundary conditions (indices modulo $N$), the semi-discrete linearized shallow-water equations are\n$$\n\\frac{d u_i}{d t} = - g \\, (G \\eta)_i = - g \\, \\frac{\\eta_{i+1} - \\eta_{i-1}}{2 h}, \\qquad\n\\frac{d \\eta_i}{d t} = - H \\, (D u)_i = - H \\, \\frac{u_{i+1} - u_{i-1}}{2 h}.\n$$\nTo analyze the mode structure, we use the discrete normal mode ansatz\n$$\nu_i(t) = U \\, \\exp\\!\\big(i (k x_i - \\omega t)\\big), \\qquad\n\\eta_i(t) = \\Eta \\, \\exp\\!\\big(i (k x_i - \\omega t)\\big),\n$$\nwith real $k$ and complex $\\omega$ (for generality). Under this ansatz, the centered finite difference of a plane wave is computed as follows:\n$$\n\\frac{\\eta_{i+1} - \\eta_{i-1}}{2 h}\n= \\frac{\\Eta \\exp\\!\\big(i(k x_{i+1} - \\omega t)\\big) - \\Eta \\exp\\!\\big(i(k x_{i-1} - \\omega t)\\big)}{2 h}\n= \\frac{\\Eta \\exp\\!\\big(i(k x_i - \\omega t)\\big)\\big(\\exp(i k h) - \\exp(- i k h)\\big)}{2 h}\n= \\Eta \\exp\\!\\big(i(k x_i - \\omega t)\\big) \\cdot \\frac{i \\, \\sin(k h)}{h}.\n$$\nThus, the discrete gradient operator acting on a plane wave produces $i D(k)$ times the original wave, where we define the real symbol\n$$\nD(k) \\equiv \\frac{\\sin(k h)}{h}.\n$$\nThe same holds for the discrete divergence acting on $u_i$, namely\n$$\n\\frac{u_{i+1} - u_{i-1}}{2 h} = U \\exp\\!\\big(i(k x_i - \\omega t)\\big) \\cdot \\frac{i \\, \\sin(k h)}{h} = i D(k) \\, U \\exp\\!\\big(i(k x_i - \\omega t)\\big).\n$$\nSubstituting these into the semi-discrete equations and cancelling the common factor $\\exp\\!\\big(i(k x_i - \\omega t)\\big)$ yields the algebraic system\n$$\n- i \\omega \\, U = - g \\, i D(k) \\, \\Eta \\quad \\Longrightarrow \\quad \\omega \\, U = g \\, D(k) \\, \\Eta,\n$$\n$$\n- i \\omega \\, \\Eta = - H \\, i D(k) \\, U \\quad \\Longrightarrow \\quad \\omega \\, \\Eta = H \\, D(k) \\, U.\n$$\nEliminating $U$ and $\\Eta$ gives the discrete dispersion relation. Multiply the first equation by $\\omega$ and substitute the second:\n$$\n\\omega^{2} \\, U = g \\, D(k) \\, \\omega \\, \\Eta = g \\, D(k) \\, \\big(H \\, D(k) \\, U\\big) \\quad \\Longrightarrow \\quad \\omega^{2} = g H \\, D(k)^{2}.\n$$\nIn explicit terms,\n$$\n\\omega^{2}(k) = g H \\left(\\frac{\\sin(k h)}{h}\\right)^{2}.\n$$\nThis relation shows how the discrete spatial differencing modifies the continuous dispersion $\\omega^{2} = g H k^{2}$ by replacing $k$ with the discrete wavenumber function $\\sin(k h)/h$.\n\nWe now demonstrate the spurious computational mode with wavelength $2 h$. A wavelength $\\lambda$ corresponds to wavenumber $k = 2 \\pi / \\lambda$. For $\\lambda = 2 h$, the wavenumber is\n$$\nk = \\frac{2 \\pi}{2 h} = \\frac{\\pi}{h}.\n$$\nEvaluating the discrete wavenumber function at $k = \\pi/h$ gives\n$$\nD\\!\\left(\\frac{\\pi}{h}\\right) = \\frac{\\sin\\!\\big((\\pi/h) h\\big)}{h} = \\frac{\\sin(\\pi)}{h} = 0.\n$$\nHence, the discrete pressure gradient and divergence operators annihilate the $2 h$ mode:\n$$\n(G \\eta)_i = \\frac{\\eta_{i+1} - \\eta_{i-1}}{2 h} = 0, \\qquad (D u)_i = \\frac{u_{i+1} - u_{i-1}}{2 h} = 0,\n$$\nfor any alternating checkerboard pattern $\\eta_i \\propto (-1)^i$ and $u_i \\propto (-1)^i$. Physically, the discrete pressure gradient vanishes for this grid-scale mode, so the velocity experiences no forcing from $\\eta$, and conversely the divergence vanishes so $\\eta$ experiences no tendency from $u$. In the modal analysis, this decoupling appears as\n$$\n\\omega^{2}\\!\\left(\\frac{\\pi}{h}\\right) = g H \\left(\\frac{\\sin(\\pi)}{h}\\right)^{2} = 0 \\quad \\Longrightarrow \\quad \\omega\\!\\left(\\frac{\\pi}{h}\\right) = 0.\n$$\nTherefore, the $2 h$ mode is a stationary spurious computational mode that decouples from the dynamics due to the discrete pressure gradient operator on the A-grid. The requested angular frequency for $k = \\pi/h$, expressed in $\\mathrm{s}^{-1}$, is zero.",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "In climate modeling, ensuring the long-term conservation of global quantities like mass and energy is as important as local accuracy. Different numerical schemes can have vastly different local error characteristics—some are diffusive, while others are dispersive—but their behavior regarding global conservation laws can be surprising. This thought experiment challenges you to analyze the conservation of a tracer in a simplified atmospheric circulation, comparing a first-order upwind scheme with a second-order centered scheme to understand how stencil choice impacts global conservation in a flux-conservative framework. ",
            "id": "4042497",
            "problem": "Consider two latitude–longitude numerical grids on a sphere of radius $R$ used in Numerical Weather Prediction (NWP) and climate modeling. A passive tracer $q(\\lambda,\\varphi,t)$ is transported by a purely zonal (east–west) velocity $u(\\varphi)$, with no meridional (north–south) velocity. The continuous scalar advection equation in spherical coordinates reduces to\n$$\n\\frac{\\partial q}{\\partial t} + \\frac{u(\\varphi)}{R \\cos\\varphi}\\,\\frac{\\partial q}{\\partial \\lambda} = 0,\n$$\nwhere $\\lambda$ is longitude and $\\varphi$ is latitude. The longitude coordinate is periodic with period $2\\pi$, and the tracer and velocity are smooth functions of $\\lambda$ and $\\varphi$.\n\nOn each latitude circle $\\varphi=\\varphi_{j}$, the longitude is discretized uniformly with grid spacing $\\Delta \\lambda$, and the tracer is stored at grid points $\\lambda_{i}=i\\,\\Delta \\lambda$, $i=0,1,\\dots,N-1$, with $N\\Delta \\lambda=2\\pi$. The semi-discrete zonal advection operator is applied row-by-row, replacing $\\partial q/\\partial \\lambda$ with a finite difference stencil:\n\n1. Centered differencing: $(\\partial q/\\partial \\lambda)_{i,j}\\approx (q_{i+1,j}-q_{i-1,j})/(2\\Delta \\lambda)$.\n\n2. Upwind differencing for eastward flow: assume $u(\\varphi)0$ for all $\\varphi$ considered; then $(\\partial q/\\partial \\lambda)_{i,j}\\approx (q_{i,j}-q_{i-1,j})/\\Delta \\lambda$.\n\nThe grid is conservative in the sense that the hemispheric mass of tracer is computed by the area-weighted sum\n$$\nM_{\\mathrm{N}}(t)=R^{2}\\sum_{\\{j:\\,\\varphi_{j}0\\}}\\left(\\int_{0}^{2\\pi} q(\\lambda,\\varphi_{j},t)\\,\\mathrm{d}\\lambda\\right)\\cos\\varphi_{j}\\,\\Delta \\varphi_{j},\\quad\nM_{\\mathrm{S}}(t)=R^{2}\\sum_{\\{j:\\,\\varphi_{j}0\\}}\\left(\\int_{0}^{2\\pi} q(\\lambda,\\varphi_{j},t)\\,\\mathrm{d}\\lambda\\right)\\cos\\varphi_{j}\\,\\Delta \\varphi_{j},\n$$\nwhere $\\Delta \\varphi_{j}$ denotes the meridional grid spacing associated with the latitude index $j$. Assume periodicity in $\\lambda$, exact quadrature in $\\lambda$ by the uniform grid, and row-wise application of the zonal operator with either stencil.\n\nStarting from the continuous advection equation and the above discrete replacements, derive the leading-order truncation error at a fixed high latitude $\\varphi_{0}$ for each stencil by Taylor expansion in $\\Delta \\lambda$, expressed in terms of $u(\\varphi_{0})$, $R$, $\\cos\\varphi_{0}$, $\\Delta \\lambda$, and longitudinal derivatives of $q$. Then, using the conservative area-weighted hemispheric sums defined above and the periodicity in $\\lambda$, determine the closed-form analytic expression for the difference in equator-crossing tracer transport (net flux across $\\varphi=0$) induced by the upwind stencil minus that induced by the centered stencil under pure zonal advection with $u(\\varphi)0$ and $v(\\varphi)=0$. Express your final answer for this difference as a single analytic expression. No rounding is required. If your answer has physical units, express it in $\\mathrm{kg\\,s^{-1}}$; otherwise, provide a dimensionless expression.",
            "solution": "The problem statement is evaluated as scientifically sound, well-posed, objective, and self-contained. It presents a standard, albeit simplified, scenario in numerical geophysical fluid dynamics and asks for derivations based on fundamental principles of numerical analysis (Taylor series expansion) and conservation laws. All necessary definitions and equations are provided. The problem is valid.\n\nThe problem consists of two parts. First, we derive the leading-order truncation error for the centered and upwind finite difference schemes. Second, we determine the difference in equator-crossing tracer transport between the two schemes.\n\n**Part 1: Truncation Error Analysis**\n\nThe continuous advection equation is given by:\n$$\n\\frac{\\partial q}{\\partial t} = - \\frac{u(\\varphi)}{R \\cos\\varphi}\\,\\frac{\\partial q}{\\partial \\lambda}\n$$\nA semi-discrete numerical scheme approximates this as:\n$$\n\\frac{\\partial q_{i,j}}{\\partial t} = - \\frac{u(\\varphi_j)}{R \\cos\\varphi_j}\\, D_\\lambda(q_{i,j})\n$$\nwhere $D_\\lambda(q_{i,j})$ is a finite difference approximation of $\\frac{\\partial q}{\\partial \\lambda}$ at grid point $(\\lambda_i, \\varphi_j)$. The truncation error, $\\tau$, is the residual obtained by substituting the exact solution into the numerical scheme:\n$$\n\\tau = \\frac{\\partial q}{\\partial t} - \\left(-\\frac{u(\\varphi)}{R \\cos\\varphi}\\, D_\\lambda(q)\\right) = - \\frac{u(\\varphi)}{R \\cos\\varphi} \\left( \\frac{\\partial q}{\\partial \\lambda} - D_\\lambda(q) \\right)\n$$\nWe analyze the error term $(\\frac{\\partial q}{\\partial \\lambda} - D_\\lambda(q))$ for each stencil at a fixed latitude $\\varphi_0$ by performing a Taylor series expansion of $q$ in the longitudinal direction $\\lambda$ around a point $\\lambda_i$. Let $q_i$ denote $q(\\lambda_i, \\varphi_0, t)$.\n\n1.  **Centered Differencing Stencil:**\n    The stencil is $D_\\lambda^{(c)}(q_i) = \\frac{q_{i+1} - q_{i-1}}{2\\Delta\\lambda}$.\n    We expand $q_{i+1} = q(\\lambda_i + \\Delta\\lambda)$ and $q_{i-1} = q(\\lambda_i - \\Delta\\lambda)$ around $\\lambda_i$:\n    $$\n    q_{i+1} = q_i + \\Delta\\lambda \\frac{\\partial q}{\\partial\\lambda} + \\frac{(\\Delta\\lambda)^2}{2!} \\frac{\\partial^2 q}{\\partial\\lambda^2} + \\frac{(\\Delta\\lambda)^3}{3!} \\frac{\\partial^3 q}{\\partial\\lambda^3} + O((\\Delta\\lambda)^4)\n    $$\n    $$\n    q_{i-1} = q_i - \\Delta\\lambda \\frac{\\partial q}{\\partial\\lambda} + \\frac{(\\Delta\\lambda)^2}{2!} \\frac{\\partial^2 q}{\\partial\\lambda^2} - \\frac{(\\Delta\\lambda)^3}{3!} \\frac{\\partial^3 q}{\\partial\\lambda^3} + O((\\Delta\\lambda)^4)\n    $$\n    Subtracting the second expansion from the first gives:\n    $$\n    q_{i+1} - q_{i-1} = 2\\Delta\\lambda \\frac{\\partial q}{\\partial\\lambda} + \\frac{2(\\Delta\\lambda)^3}{6} \\frac{\\partial^3 q}{\\partial\\lambda^3} + O((\\Delta\\lambda)^5)\n    $$\n    Dividing by $2\\Delta\\lambda$:\n    $$\n    D_\\lambda^{(c)}(q_i) = \\frac{q_{i+1} - q_{i-1}}{2\\Delta\\lambda} = \\frac{\\partial q}{\\partial\\lambda} + \\frac{(\\Delta\\lambda)^2}{6} \\frac{\\partial^3 q}{\\partial\\lambda^3} + O((\\Delta\\lambda)^4)\n    $$\n    The leading-order error in approximating the derivative is $-\\frac{(\\Delta\\lambda)^2}{6} \\frac{\\partial^3 q}{\\partial\\lambda^3}$. The leading-order truncation error for the full advection equation is:\n    $$\n    \\tau^{(c)} = - \\frac{u(\\varphi_0)}{R \\cos\\varphi_0} \\left( -\\frac{(\\Delta\\lambda)^2}{6} \\frac{\\partial^3 q}{\\partial\\lambda^3} \\right) = \\frac{u(\\varphi_0)(\\Delta\\lambda)^2}{6 R \\cos\\varphi_0} \\frac{\\partial^3 q}{\\partial\\lambda^3}\n    $$\n    This is a second-order accurate, dispersive error.\n\n2.  **Upwind Differencing Stencil (for $u>0$):**\n    The stencil is $D_\\lambda^{(u)}(q_i) = \\frac{q_i - q_{i-1}}{\\Delta\\lambda}$.\n    Using the Taylor expansion for $q_{i-1}$ from above:\n    $$\n    q_i - q_{i-1} = q_i - \\left( q_i - \\Delta\\lambda \\frac{\\partial q}{\\partial\\lambda} + \\frac{(\\Delta\\lambda)^2}{2} \\frac{\\partial^2 q}{\\partial\\lambda^2} - O((\\Delta\\lambda)^3) \\right) = \\Delta\\lambda \\frac{\\partial q}{\\partial\\lambda} - \\frac{(\\Delta\\lambda)^2}{2} \\frac{\\partial^2 q}{\\partial\\lambda^2} + O((\\Delta\\lambda)^3)\n    $$\n    Dividing by $\\Delta\\lambda$:\n    $$\n    D_\\lambda^{(u)}(q_i) = \\frac{q_i - q_{i-1}}{\\Delta\\lambda} = \\frac{\\partial q}{\\partial\\lambda} - \\frac{\\Delta\\lambda}{2} \\frac{\\partial^2 q}{\\partial\\lambda^2} + O((\\Delta\\lambda)^2)\n    $$\n    The leading-order error in approximating the derivative is $\\frac{\\Delta\\lambda}{2} \\frac{\\partial^2 q}{\\partial\\lambda^2}$. The leading-order truncation error for the full advection equation is:\n    $$\n    \\tau^{(u)} = - \\frac{u(\\varphi_0)}{R \\cos\\varphi_0} \\left( \\frac{\\Delta\\lambda}{2} \\frac{\\partial^2 q}{\\partial\\lambda^2} \\right) = - \\frac{u(\\varphi_0)\\Delta\\lambda}{2 R \\cos\\varphi_0} \\frac{\\partial^2 q}{\\partial\\lambda^2}\n    $$\n    This is a first-order accurate, diffusive error.\n\n**Part 2: Difference in Equator-Crossing Tracer Transport**\n\nThe net equator-crossing tracer transport is the rate of change of the total mass in a hemisphere, for instance, the Northern Hemisphere, $M_N(t)$. This quantity is defined as a sum over latitude lines.\n$$\nM_{\\mathrm{N}}(t)=R^{2}\\sum_{\\{j:\\,\\varphi_{j}0\\}}\\left(\\int_{0}^{2\\pi} q(\\lambda,\\varphi_{j},t)\\,\\mathrm{d}\\lambda\\right)\\cos\\varphi_{j}\\,\\Delta \\varphi_{j}\n$$\nThe problem states to assume \"exact quadrature in $\\lambda$ by the uniform grid,\" which means the integral can be replaced by the discrete sum:\n$$\n\\int_{0}^{2\\pi} q(\\lambda,\\varphi_{j},t)\\,\\mathrm{d}\\lambda = \\sum_{i=0}^{N-1} q_{i,j}(t) \\Delta\\lambda\n$$\nSubstituting this into the expression for $M_N(t)$:\n$$\nM_{\\mathrm{N}}(t) = R^{2}\\sum_{\\{j:\\,\\varphi_{j}0\\}} \\left( \\sum_{i=0}^{N-1} q_{i,j}(t) \\Delta\\lambda \\right) \\cos\\varphi_{j}\\,\\Delta \\varphi_{j}\n$$\nThe equator-crossing transport is the time derivative, $\\frac{dM_N}{dt}$:\n$$\n\\frac{dM_N}{dt} = R^{2} \\sum_{\\{j:\\,\\varphi_{j}0\\}} \\left( \\sum_{i=0}^{N-1} \\frac{\\partial q_{i,j}}{\\partial t} \\Delta\\lambda \\right) \\cos\\varphi_{j}\\,\\Delta \\varphi_{j}\n$$\nWe now substitute the semi-discrete advection equation, $\\frac{\\partial q_{i,j}}{\\partial t} = - \\frac{u(\\varphi_j)}{R \\cos\\varphi_j} D_\\lambda(q_{i,j})$:\n$$\n\\frac{dM_N}{dt} = R^{2} \\sum_{\\{j:\\,\\varphi_{j}0\\}} \\left( \\sum_{i=0}^{N-1} \\left( - \\frac{u_j}{R \\cos\\varphi_j} D_\\lambda(q_{i,j}) \\right) \\Delta\\lambda \\right) \\cos\\varphi_{j}\\,\\Delta \\varphi_{j}\n$$\nwhere $u_j = u(\\varphi_j)$. Simplifying the expression:\n$$\n\\frac{dM_N}{dt} = -R \\Delta\\lambda \\sum_{\\{j:\\,\\varphi_{j}0\\}} u_j \\Delta\\varphi_j \\left( \\sum_{i=0}^{N-1} D_\\lambda(q_{i,j}) \\right)\n$$\nThe crucial part of this expression is the zonal sum of the finite difference operator, $\\sum_{i=0}^{N-1} D_\\lambda(q_{i,j})$. We evaluate this sum for each stencil, using the periodicity in longitude, which implies $q_{k,j} = q_{k+N,j}$ for any integer $k$.\n\n1.  **Centered Differencing Stencil:**\n    $$\n    \\sum_{i=0}^{N-1} D_\\lambda^{(c)}(q_{i,j}) = \\sum_{i=0}^{N-1} \\frac{q_{i+1,j} - q_{i-1,j}}{2\\Delta\\lambda} = \\frac{1}{2\\Delta\\lambda} \\left( \\sum_{i=0}^{N-1} q_{i+1,j} - \\sum_{i=0}^{N-1} q_{i-1,j} \\right)\n    $$\n    Due to periodicity, the sums are over the same set of values, just with shifted indices. Thus, $\\sum_{i=0}^{N-1} q_{i+1,j} = \\sum_{k=1}^{N} q_{k,j} = \\sum_{i=0}^{N-1} q_{i,j}$, and likewise $\\sum_{i=0}^{N-1} q_{i-1,j} = \\sum_{i=0}^{N-1} q_{i,j}$. The sum becomes:\n    $$\n    \\sum_{i=0}^{N-1} D_\\lambda^{(c)}(q_{i,j}) = \\frac{1}{2\\Delta\\lambda} \\left( \\sum_{i=0}^{N-1} q_{i,j} - \\sum_{i=0}^{N-1} q_{i,j} \\right) = 0\n    $$\n\n2.  **Upwind Differencing Stencil:**\n    $$\n    \\sum_{i=0}^{N-1} D_\\lambda^{(u)}(q_{i,j}) = \\sum_{i=0}^{N-1} \\frac{q_{i,j} - q_{i-1,j}}{\\Delta\\lambda} = \\frac{1}{\\Delta\\lambda} \\left( \\sum_{i=0}^{N-1} q_{i,j} - \\sum_{i=0}^{N-1} q_{i-1,j} \\right)\n    $$\n    Again, due to periodicity, $\\sum_{i=0}^{N-1} q_{i-1,j} = \\sum_{i=0}^{N-1} q_{i,j}$. The sum becomes:\n    $$\n    \\sum_{i=0}^{N-1} D_\\lambda^{(u)}(q_{i,j}) = \\frac{1}{\\Delta\\lambda} \\left( \\sum_{i=0}^{N-1} q_{i,j} - \\sum_{i=0}^{N-1} q_{i,j} \\right) = 0\n    $$\n\nFor both numerical schemes, the zonal sum of the finite difference operator is identically zero. This is a fundamental property of such difference operators on a periodic domain. As a result, the rate of change of hemispheric mass is zero for both schemes:\n$$\n\\left(\\frac{dM_N}{dt}\\right)^{(c)} = 0 \\quad \\text{and} \\quad \\left(\\frac{dM_N}{dt}\\right)^{(u)} = 0\n$$\nThis means there is no numerically-induced net transport across the equator for either scheme under the problem's conditions (purely zonal flow and a row-wise discrete operator). The difference between the transport induced by the upwind stencil and that induced by the centered stencil is therefore:\n$$\n\\left(\\frac{dM_N}{dt}\\right)^{(u)} - \\left(\\frac{dM_N}{dt}\\right)^{(c)} = 0 - 0 = 0\n$$\nWhile the local truncation errors show that the upwind scheme introduces numerical diffusion and the centered scheme introduces numerical dispersion, these effects do not create or destroy mass when integrated over the periodic zonal domain. Consequently, there is no artificial mass flux across latitudes.",
            "answer": "$$\n\\boxed{0}\n$$"
        }
    ]
}