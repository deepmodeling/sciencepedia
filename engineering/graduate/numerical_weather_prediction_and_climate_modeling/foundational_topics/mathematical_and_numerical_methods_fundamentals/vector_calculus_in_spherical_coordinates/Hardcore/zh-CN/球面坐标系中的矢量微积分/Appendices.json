{
    "hands_on_practices": [
        {
            "introduction": "在分析球体上的流体运动之前，我们必须首先掌握其几何特性。本练习从基本原理出发，推导球面上的角网格间距与真实物理距离之间的基本关系，从而巩固我们的理解。在任何全球模型中，掌握这一概念是正确构建有限差分或有限体积格式的关键第一步。",
            "id": "4108645",
            "problem": "在一个近似为半径为 $a$ 的完美球体的旋转行星上，用于数值天气预报和气候模拟的经纬度网格需要精确的几何度量，以将角度网格间距转换为物理距离。考虑标准球坐标 $(r,\\theta,\\lambda)$，其中 $r$ 是径向距离，$\\theta$ 是从北极测量的余纬，$\\lambda$ 是经度。设地理纬度为 $\\varphi$，因此 $\\theta = \\frac{\\pi}{2} - \\varphi$。\n\n仅从球面的笛卡尔嵌入和欧几里得点积出发，推导球面 $r=a$ 上的诱导曲面线元，并用微分 $d\\varphi$ 和 $d\\lambda$ 表示。然后，利用该线元：\n- 确定在固定纬度 $\\varphi$ 处，沿纬线圈对应经度方向一个小的正角度增量 $\\Delta\\lambda$ 的弧长。\n- 确定沿子午线（经度恒定的线）对应纬度方向一个小的正角度增量 $\\Delta\\varphi$ 的弧长。\n\n假设所有角度都以弧度为单位。将最终结果表示为一个包含两个弧长 $[L_{\\text{lat}}\\;\\;L_{\\text{mer}}]$ 的行矩阵，用 $a$、$\\varphi$、$\\Delta\\lambda$ 和 $\\Delta\\varphi$ 表示。不需要进行数值计算，也不需要四舍五入。最终的方框答案中不要包含单位。",
            "solution": "该问题是适定的，有科学依据，并包含足够的信息以获得唯一解。我们首先推导半径为 $a$ 的球面上的曲面线元，然后用它来求指定的弧长。\n\n首先，我们建立球面的笛卡尔嵌入。半径为 $a$ 的球面上的一个点可以用笛卡尔坐标系 $(x, y, z)$ 中的位置矢量 $\\vec{R}$ 来描述。使用球坐标 $(r, \\theta, \\lambda)$ 的标准参数化是：\n$x = r \\sin\\theta \\cos\\lambda$\n$y = r \\sin\\theta \\sin\\lambda$\n$z = r \\cos\\theta$\n其中 $r$ 是径向距离，$\\theta$ 是余纬 ($0 \\le \\theta \\le \\pi$)，$\\lambda$ 是经度 ($0 \\le \\lambda  2\\pi$)。\n\n问题要求使用地理纬度 $\\varphi$，它与余纬 $\\theta$ 的关系为 $\\varphi = \\frac{\\pi}{2} - \\theta$，或 $\\theta = \\frac{\\pi}{2} - \\varphi$。纬度的范围是 $-\\frac{\\pi}{2} \\le \\varphi \\le \\frac{\\pi}{2}$。我们将这个关系代入涉及 $\\theta$ 的三角函数中：\n$\\sin\\theta = \\sin\\left(\\frac{\\pi}{2} - \\varphi\\right) = \\cos\\varphi$\n$\\cos\\theta = \\cos\\left(\\frac{\\pi}{2} - \\varphi\\right) = \\sin\\varphi$\n\n在球面上，半径是恒定的，$r=a$。现在，位置矢量 $\\vec{R}(\\varphi, \\lambda)$ 可以用纬度 $\\varphi$ 和经度 $\\lambda$ 来表示：\n$\\vec{R}(\\varphi, \\lambda) = (a \\cos\\varphi \\cos\\lambda) \\hat{i} + (a \\cos\\varphi \\sin\\lambda) \\hat{j} + (a \\sin\\varphi) \\hat{k}$\n\n该曲面上的无穷小位移矢量 $d\\vec{R}$ 由 $\\vec{R}$ 的全微分给出：\n$d\\vec{R} = \\frac{\\partial \\vec{R}}{\\partial \\varphi} d\\varphi + \\frac{\\partial \\vec{R}}{\\partial \\lambda} d\\lambda$\n\n我们计算 $\\vec{R}$ 关于 $\\varphi$ 和 $\\lambda$ 的偏导数：\n$\\frac{\\partial \\vec{R}}{\\partial \\varphi} = (-a \\sin\\varphi \\cos\\lambda) \\hat{i} + (-a \\sin\\varphi \\sin\\lambda) \\hat{j} + (a \\cos\\varphi) \\hat{k}$\n$\\frac{\\partial \\vec{R}}{\\partial \\lambda} = (-a \\cos\\varphi \\sin\\lambda) \\hat{i} + (a \\cos\\varphi \\cos\\lambda) \\hat{j} + (0) \\hat{k}$\n\n这个位移矢量长度的平方 $ds^2$ 就是诱导的曲面线元，它是通过计算 $d\\vec{R}$ 与自身的欧几里得点积得到的：\n$ds^2 = d\\vec{R} \\cdot d\\vec{R} = \\left(\\frac{\\partial \\vec{R}}{\\partial \\varphi} d\\varphi + \\frac{\\partial \\vec{R}}{\\partial \\lambda} d\\lambda\\right) \\cdot \\left(\\frac{\\partial \\vec{R}}{\\partial \\varphi} d\\varphi + \\frac{\\partial \\vec{R}}{\\partial \\lambda} d\\lambda\\right)$\n$ds^2 = \\left|\\frac{\\partial \\vec{R}}{\\partial \\varphi}\\right|^2 (d\\varphi)^2 + 2\\left(\\frac{\\partial \\vec{R}}{\\partial \\varphi} \\cdot \\frac{\\partial \\vec{R}}{\\partial \\lambda}\\right) d\\varphi d\\lambda + \\left|\\frac{\\partial \\vec{R}}{\\partial \\lambda}\\right|^2 (d\\lambda)^2$\n\n我们来计算这些点积：\n$\\left|\\frac{\\partial \\vec{R}}{\\partial \\varphi}\\right|^2 = (-a \\sin\\varphi \\cos\\lambda)^2 + (-a \\sin\\varphi \\sin\\lambda)^2 + (a \\cos\\varphi)^2$\n$= a^2 \\sin^2\\varphi \\cos^2\\lambda + a^2 \\sin^2\\varphi \\sin^2\\lambda + a^2 \\cos^2\\varphi$\n$= a^2 \\sin^2\\varphi (\\cos^2\\lambda + \\sin^2\\lambda) + a^2 \\cos^2\\varphi$\n$= a^2 \\sin^2\\varphi + a^2 \\cos^2\\varphi = a^2(\\sin^2\\varphi + \\cos^2\\varphi) = a^2$\n\n$\\left|\\frac{\\partial \\vec{R}}{\\partial \\lambda}\\right|^2 = (-a \\cos\\varphi \\sin\\lambda)^2 + (a \\cos\\varphi \\cos\\lambda)^2 + 0^2$\n$= a^2 \\cos^2\\varphi \\sin^2\\lambda + a^2 \\cos^2\\varphi \\cos^2\\lambda$\n$= a^2 \\cos^2\\varphi (\\sin^2\\lambda + \\cos^2\\lambda) = a^2 \\cos^2\\varphi$\n\n$\\frac{\\partial \\vec{R}}{\\partial \\varphi} \\cdot \\frac{\\partial \\vec{R}}{\\partial \\lambda} = (-a \\sin\\varphi \\cos\\lambda)(-a \\cos\\varphi \\sin\\lambda) + (-a \\sin\\varphi \\sin\\lambda)(a \\cos\\varphi \\cos\\lambda) + (a \\cos\\varphi)(0)$\n$= a^2 \\sin\\varphi \\cos\\varphi \\cos\\lambda \\sin\\lambda - a^2 \\sin\\varphi \\cos\\varphi \\sin\\lambda \\cos\\lambda = 0$\n非对角项为零证实了纬度和经度坐标在球面上是正交的。\n\n将这些结果代回到 $ds^2$ 的表达式中，我们得到用 $d\\varphi$ 和 $d\\lambda$ 表示的线元：\n$ds^2 = a^2 (d\\varphi)^2 + a^2 \\cos^2\\varphi (d\\lambda)^2$\n\n现在，我们使用这个线元来确定所需的两个弧长。\n\n1.  **沿纬线圈的弧长, $L_{\\text{lat}}$**\n纬线圈由一个恒定的纬度定义，即 $\\varphi = \\text{const}$。沿着这条路径，纬度的微分变化为零，即 $d\\varphi = 0$。线元简化为：\n$ds^2 = a^2 \\cos^2\\varphi (d\\lambda)^2$\n无穷小弧长为 $ds = \\sqrt{a^2 \\cos^2\\varphi (d\\lambda)^2} = |a \\cos\\varphi d\\lambda|$。因为 $a > 0$ 且对于任意纬度 $\\varphi \\in [-\\pi/2, \\pi/2]$，都有 $\\cos\\varphi \\ge 0$，所以我们有 $ds = a \\cos\\varphi d\\lambda$。\n对于经度方向一个小的正角度增量 $\\Delta\\lambda$，其弧长 $L_{\\text{lat}}$ 可以通过将 $ds$ 从 $\\lambda_0$ 积分到 $\\lambda_0 + \\Delta\\lambda$ 来求得。由于 $a$ 和 $\\varphi$ 在此路径上是常数：\n$L_{\\text{lat}} = \\int_{\\lambda_0}^{\\lambda_0 + \\Delta\\lambda} a \\cos\\varphi \\, d\\lambda = a \\cos\\varphi \\int_{\\lambda_0}^{\\lambda_0 + \\Delta\\lambda} d\\lambda = a \\cos\\varphi [\\lambda]_{\\lambda_0}^{\\lambda_0 + \\Delta\\lambda} = a \\cos\\varphi \\Delta\\lambda$\n\n2.  **沿子午线的弧长, $L_{\\text{mer}}$**\n子午线由一个恒定的经度定义，即 $\\lambda = \\text{const}$。沿着这条路径，经度的微分变化为零，即 $d\\lambda = 0$。线元简化为：\n$ds^2 = a^2 (d\\varphi)^2$\n无穷小弧长为 $ds = \\sqrt{a^2 (d\\varphi)^2} = |a d\\varphi| = a|d\\varphi|$，因为 $a > 0$。\n问题指定了一个小的正角度增量 $\\Delta\\varphi$，所以我们可以设 $|d\\varphi| = d\\varphi$。弧长 $L_{\\text{mer}}$ 可以通过将 $ds$ 从 $\\varphi_0$ 积分到 $\\varphi_0 + \\Delta\\varphi$ 来求得：\n$L_{\\text{mer}} = \\int_{\\varphi_0}^{\\varphi_0 + \\Delta\\varphi} a \\, d\\varphi = a \\int_{\\varphi_0}^{\\varphi_0 + \\Delta\\varphi} d\\varphi = a [\\varphi]_{\\varphi_0}^{\\varphi_0 + \\Delta\\varphi} = a \\Delta\\varphi$\n\n所求的两个弧长是 $L_{\\text{lat}} = a \\cos\\varphi \\Delta\\lambda$ 和 $L_{\\text{mer}} = a \\Delta\\varphi$。最终结果要求以行矩阵 $[L_{\\text{lat}}\\;\\;L_{\\text{mer}}]$ 的形式给出。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\na \\cos\\varphi \\Delta\\lambda  a \\Delta\\varphi\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在建立了球面几何基础之后，我们的下一步是以有意义的方式表示风等物理量。本练习演示了如何将一个全局笛卡尔坐标系下的风矢量，转换为物理上直观的局地球面分量：垂直、经向和纬向风。这种转换对于分析模型输出和构建预报方程都至关重要。",
            "id": "4108650",
            "problem": "在全球数值天气预报 (NWP) 和气候大气环流模型 (GCM) 中，风通常以地心笛卡尔坐标表示，但预报方程和诊断在球面上表达最为自然。考虑一个地心地固笛卡尔坐标系，其坐标轴为 $\\hat{\\mathbf{i}}$（指向赤道上经度为 $\\phi=0$ 的方向）、$\\hat{\\mathbf{j}}$（指向赤道上经度为 $\\phi=\\pi/2$ 的方向）和 $\\hat{\\mathbf{k}}$（与地球自转轴对齐并指向北极）。设球极坐标 $(r,\\theta,\\phi)$ 由 $x=r\\sin\\theta\\cos\\phi$、$y=r\\sin\\theta\\sin\\phi$ 和 $z=r\\cos\\theta$ 定义，其中 $\\theta$ 是余纬（从北极开始计算的角度），$\\phi$ 是东经。角度以弧度为单位。\n\n位于点 $(r,\\theta,\\phi)$ 的局部风矢量 $\\mathbf{V}$ 以笛卡尔分量形式给出：$\\mathbf{V}=u\\,\\hat{\\mathbf{i}}+v\\,\\hat{\\mathbf{j}}+w\\,\\hat{\\mathbf{k}}$，其中 $u$、$v$ 和 $w$ 分别是笛卡尔基下的东-格林尼治、北-赤道和上-极地分量。\n\n仅从球坐标的基本定义、点 $(r,\\theta,\\phi)$ 处的标准正交球坐标基矢量以及通过点积将矢量投影到基上的方法出发，推导出用 $(u,v,w)$ 和 $(\\theta,\\phi)$ 表示 $\\mathbf{V}$ 的球坐标分量 $(v_r,v_\\theta,v_\\phi)$ 的变换公式。然后，在大尺度大气动力学的背景下，解释每个球坐标分量在旋转球体上的物理意义。\n\n你的最终答案必须是 $(v_r,v_\\theta,v_\\phi)$ 的单个解析表达式，形式为一个行矩阵，其元素依赖于 $u$、$v$、$w$、$\\theta$ 和 $\\phi$。无需四舍五入。角度必须以弧度为单位，且最终表达式中不包含任何单位。",
            "solution": "该问题是有效的，因为它具有科学依据、提法恰当、客观、自洽，并要求在矢量微积分中进行标准的、可验证的推导，且直接应用于地球物理流体动力学。\n\n任务是推导矢量 $\\mathbf{V}$ 从全局笛卡尔基到局部球坐标基的变换，并解释所得分量的物理意义。\n\n设地心地固笛卡尔坐标为 $(x,y,z)$，相应的标准正交基矢量为 $(\\hat{\\mathbf{i}},\\hat{\\mathbf{j}},\\hat{\\mathbf{k}})$。球极坐标为 $(r,\\theta,\\phi)$，其中 $r$ 是距原点的径向距离，$\\theta$ 是余纬（从正 z 轴量起的极角），$\\phi$ 是经度（在 xy 平面中从正 x 轴量起的方位角）。两个坐标系之间的关系如下：\n$$x=r\\sin\\theta\\cos\\phi$$\n$$y=r\\sin\\theta\\sin\\phi$$\n$$z=r\\cos\\theta$$\n\n位置矢量 $\\mathbf{r}$ 在笛卡尔坐标中可以写成 $\\mathbf{r} = x\\,\\hat{\\mathbf{i}} + y\\,\\hat{\\mathbf{j}} + z\\,\\hat{\\mathbf{k}}$。代入球坐标的定义，我们得到：\n$$\\mathbf{r}(r,\\theta,\\phi) = (r\\sin\\theta\\cos\\phi)\\,\\hat{\\mathbf{i}} + (r\\sin\\theta\\sin\\phi)\\,\\hat{\\mathbf{j}} + (r\\cos\\theta)\\,\\hat{\\mathbf{k}}$$\n\n为了找到球坐标系的局部标准正交基矢量 $(\\hat{\\mathbf{e}}_r, \\hat{\\mathbf{e}}_\\theta, \\hat{\\mathbf{e}}_\\phi)$，我们取位置矢量 $\\mathbf{r}$ 对每个坐标的偏导数，并将所得矢量单位化。\n\n径向基矢量 $\\hat{\\mathbf{e}}_r$ 指向 r 增大的方向：\n$$\\frac{\\partial\\mathbf{r}}{\\partial r} = \\sin\\theta\\cos\\phi\\,\\hat{\\mathbf{i}} + \\sin\\theta\\sin\\phi\\,\\hat{\\mathbf{j}} + \\cos\\theta\\,\\hat{\\mathbf{k}}$$\n该矢量的模为：\n$$\\left|\\frac{\\partial\\mathbf{r}}{\\partial r}\\right| = \\sqrt{(\\sin\\theta\\cos\\phi)^2 + (\\sin\\theta\\sin\\phi)^2 + (\\cos\\theta)^2} = \\sqrt{\\sin^2\\theta(\\cos^2\\phi+\\sin^2\\phi) + \\cos^2\\theta} = \\sqrt{\\sin^2\\theta + \\cos^2\\theta} = 1$$\n由于该矢量已经是单位矢量，我们有：\n$$\\hat{\\mathbf{e}}_r = \\sin\\theta\\cos\\phi\\,\\hat{\\mathbf{i}} + \\sin\\theta\\sin\\phi\\,\\hat{\\mathbf{j}} + \\cos\\theta\\,\\hat{\\mathbf{k}}$$\n\n余纬基矢量 $\\hat{\\mathbf{e}}_\\theta$ 指向 $\\theta$ 增大的方向：\n$$\\frac{\\partial\\mathbf{r}}{\\partial\\theta} = r\\cos\\theta\\cos\\phi\\,\\hat{\\mathbf{i}} + r\\cos\\theta\\sin\\phi\\,\\hat{\\mathbf{j}} - r\\sin\\theta\\,\\hat{\\mathbf{k}}$$\n该矢量的模为：\n$$\\left|\\frac{\\partial\\mathbf{r}}{\\partial\\theta}\\right| = \\sqrt{(r\\cos\\theta\\cos\\phi)^2 + (r\\cos\\theta\\sin\\phi)^2 + (-r\\sin\\theta)^2} = \\sqrt{r^2\\cos^2\\theta(\\cos^2\\phi+\\sin^2\\phi) + r^2\\sin^2\\theta} = \\sqrt{r^2(\\cos^2\\theta + \\sin^2\\theta)} = r$$\n用其模进行单位化，得到单位矢量：\n$$\\hat{\\mathbf{e}}_\\theta = \\frac{1}{r}\\frac{\\partial\\mathbf{r}}{\\partial\\theta} = \\cos\\theta\\cos\\phi\\,\\hat{\\mathbf{i}} + \\cos\\theta\\sin\\phi\\,\\hat{\\mathbf{j}} - \\sin\\theta\\,\\hat{\\mathbf{k}}$$\n\n方位基矢量 $\\hat{\\mathbf{e}}_\\phi$ 指向 $\\phi$ 增大的方向：\n$$\\frac{\\partial\\mathbf{r}}{\\partial\\phi} = -r\\sin\\theta\\sin\\phi\\,\\hat{\\mathbf{i}} + r\\sin\\theta\\cos\\phi\\,\\hat{\\mathbf{j}}$$\n该矢量的模为：\n$$\\left|\\frac{\\partial\\mathbf{r}}{\\partial\\phi}\\right| = \\sqrt{(-r\\sin\\theta\\sin\\phi)^2 + (r\\sin\\theta\\cos\\phi)^2} = \\sqrt{r^2\\sin^2\\theta(\\sin^2\\phi+\\cos^2\\phi)} = \\sqrt{r^2\\sin^2\\theta} = r\\sin\\theta$$ （对于 $\\theta \\in [0, \\pi]$）。\n单位化后得到单位矢量：\n$$\\hat{\\mathbf{e}}_\\phi = \\frac{1}{r\\sin\\theta}\\frac{\\partial\\mathbf{r}}{\\partial\\phi} = -\\sin\\phi\\,\\hat{\\mathbf{i}} + \\cos\\phi\\,\\hat{\\mathbf{j}}$$\n\n集合 $\\{\\hat{\\mathbf{e}}_r, \\hat{\\mathbf{e}}_\\theta, \\hat{\\mathbf{e}}_\\phi\\}$ 在每个点 $(r,\\theta,\\phi)$ 处构成一个右手标准正交基。\n\n风矢量 $\\mathbf{V}$ 在笛卡尔基中给出为 $\\mathbf{V} = u\\,\\hat{\\mathbf{i}} + v\\,\\hat{\\mathbf{j}} + w\\,\\hat{\\mathbf{k}}$。我们希望在局部球坐标基中将其表示为 $\\mathbf{V} = v_r\\,\\hat{\\mathbf{e}}_r + v_\\theta\\,\\hat{\\mathbf{e}}_\\theta + v_\\phi\\,\\hat{\\mathbf{e}}_\\phi$。由于球坐标基矢量构成一个标准正交集，分量 $(v_r, v_\\theta, v_\\phi)$ 可以通过将 $\\mathbf{V}$ 用点积投影到每个球坐标基矢量上求得。\n\n径向分量 $v_r$：\n$$v_r = \\mathbf{V} \\cdot \\hat{\\mathbf{e}}_r = (u\\,\\hat{\\mathbf{i}} + v\\,\\hat{\\mathbf{j}} + w\\,\\hat{\\mathbf{k}}) \\cdot (\\sin\\theta\\cos\\phi\\,\\hat{\\mathbf{i}} + \\sin\\theta\\sin\\phi\\,\\hat{\\mathbf{j}} + \\cos\\theta\\,\\hat{\\mathbf{k}})$$\n$$v_r = u\\sin\\theta\\cos\\phi + v\\sin\\theta\\sin\\phi + w\\cos\\theta$$\n\n余纬分量 $v_\\theta$：\n$$v_\\theta = \\mathbf{V} \\cdot \\hat{\\mathbf{e}}_\\theta = (u\\,\\hat{\\mathbf{i}} + v\\,\\hat{\\mathbf{j}} + w\\,\\hat{\\mathbf{k}}) \\cdot (\\cos\\theta\\cos\\phi\\,\\hat{\\mathbf{i}} + \\cos\\theta\\sin\\phi\\,\\hat{\\mathbf{j}} - \\sin\\theta\\,\\hat{\\mathbf{k}})$$\n$$v_\\theta = u\\cos\\theta\\cos\\phi + v\\cos\\theta\\sin\\phi - w\\sin\\theta$$\n\n方位分量 $v_\\phi$：\n$$v_\\phi = \\mathbf{V} \\cdot \\hat{\\mathbf{e}}_\\phi = (u\\,\\hat{\\mathbf{i}} + v\\,\\hat{\\mathbf{j}} + w\\,\\hat{\\mathbf{k}}) \\cdot (-\\sin\\phi\\,\\hat{\\mathbf{i}} + \\cos\\phi\\,\\hat{\\mathbf{j}})$$\n$$v_\\phi = -u\\sin\\phi + v\\cos\\phi$$\n\n这些就是所求的变换公式。\n\n球坐标分量的物理意义：\n在大气动力学中，风矢量 $\\mathbf{V}$ 代表空气的运动。对于像地球这样的旋转球体上的大尺度流动，球坐标分量有直接的物理诠释。\n\n$1$. $v_r$：这是速度的径向分量。在一个半径为 $r$ 的代表地球的球体上，该分量直接指向远离地心的方向。因此，它就是**垂直速度**。正的 $v_r$ 表示向上运动（上升），而负的 $v_r$ 表示向下运动（下沉）。对于大尺度（天气尺度）的大气运动， $|v_r|$ 通常远小于水平风速，这一事实是许多数值天气预报模型中采用静力平衡近似的动机。然而，垂直运动对于云的形成、降水和对流等天气现象至关重要。\n\n$2$. $v_\\theta$：这是速度在余纬 $\\theta$ 增大方向上的分量。由于北极为 $\\theta=0$，南极为 $\\theta=\\pi$，因此 $\\theta$ 增大的方向是向南。所以，$v_\\theta$ 代表**向南的速度**。正的 $v_\\theta$ 对应于向南吹的风，负的 $v_\\theta$ 对应于向北吹的风。这是**经向风**分量。经向风对于全球能量平衡至关重要，因为它们将热量从热带输送到极地。\n\n$3$. $v_\\phi$：这是速度在经度 $\\phi$ 增大方向上的分量。按照惯例，经度向东增加。因此，$v_\\phi$ 代表**向东的速度**。正的 $v_\\phi$ 对应于来自西边的风（西风），负的 $v_\\phi$ 对应于来自东边的风（东风）。这是**纬向风**分量。纬向风通常是大尺度大气环流的主要分量，以中纬度强大的急流为典型例子。",
            "answer": "$$\\boxed{\\begin{pmatrix} u\\sin\\theta\\cos\\phi + v\\sin\\theta\\sin\\phi + w\\cos\\theta  u\\cos\\theta\\cos\\phi + v\\cos\\theta\\sin\\phi - w\\sin\\theta  -u\\sin\\phi + v\\cos\\phi \\end{pmatrix}}$$"
        },
        {
            "introduction": "最后的这项练习将我们的几何和矢量微积分技能综合成一个完整的数值分析任务，这与气候科学家或数值建模者的日常工作非常相似。您将推导、实现并应用拉普拉斯-贝尔特拉米算子，从海平面气压场中识别高压和低压系统。这项练习弥合了理论微积分与其在诊断大气现象中的强大应用之间的鸿沟。",
            "id": "4108682",
            "problem": "要求您推导并实现作用于球形地球上的标量场海平面气压（SLP）的拉普拉斯-贝尔特拉米算子（曲面拉普拉斯算子），并用它来识别与气旋和反气旋相关的高曲率区域。在适用于地球物理应用的球坐标系中进行操作：半径 $r$、纬度 $\\phi$（北半球为正）和经度 $\\lambda$。地球被建模为半径为常数 $R$ 的球体。\n\n从第一性原理出发，使用以下基本依据：\n- 黎曼流形上的梯度和散度，由度量张量定义，以及拉普拉斯-贝尔特拉米算子定义为标量场梯度的散度。\n- 半径为 $R$ 的球面上的线元，用纬度和经度表示：\n  $$ds^2 = R^2\\,d\\phi^2 + R^2\\cos^2\\phi\\,d\\lambda^2.$$\n- 与上述度量相关的雅可比因子：度量张量行列式的平方根是\n  $$\\sqrt{|g|} = R^2 \\cos\\phi.$$\n- 海平面气压（SLP）是一个在球面上（$r=R$）定义的标量场 $p(\\phi,\\lambda)$，单位为帕斯卡。\n\n您的任务：\n1. 基于上述基础，推导作用于球面上标量场 $p(\\phi,\\lambda)$ 的拉普拉斯-贝尔特拉米算子的显式表达式，以纬度 $\\phi$ 和经度 $\\lambda$ 表示，不得使用预先记忆的公式走捷径。\n2. 使用二阶精度的有限差分法，在均匀的经纬度网格上设计并实现此算子的数值近似：\n   - 对内部点使用中心差分。\n   - 在经度方向上，强制使用周期性边界条件。\n   - 在纬度方向上，在两个纬度边界处使用单侧二阶精度格式。\n3. 将您的算子应用于下面的测试套件，并对每种情况，按如下方式识别气旋和反气旋中心：\n   - 气旋：一个网格点，其 $p(\\phi,\\lambda)$ 值相对于其八个直接邻点是严格的局部最小值，且该点计算出的曲面拉普拉斯算子为严格正值，其绝对值至少为阈值 $T$。\n   - 反气旋：一个网格点，其 $p(\\phi,\\lambda)$ 值相对于其八个直接邻点是严格的局部最大值，且该点计算出的曲面拉普拉斯算子为严格负值，其绝对值至少为阈值 $T$。\n   - 高曲率阈值：$$T = 10^{-9}\\ \\text{Pa}\\,\\text{m}^{-2}.$$\n4. 对每个测试用例，计算整个网格上拉普拉斯算子的最大绝对值。以帕斯卡每平方米为单位报告此值。\n5. 角度必须以弧度为单位。地球半径必须为\n   $$R = 6{,}371{,}000\\ \\text{m}.$$\n6. 使用一个排除极点的均匀网格，以避免坐标奇点：\n   - 纬度 $\\phi$ 从 $-89.5^\\circ$ 到 $+89.5^\\circ$，增量为 $0.5^\\circ$。\n   - 经度 $\\lambda$ 从 $0^\\circ$ 到 $360^\\circ$，增量为 $0.5^\\circ$，经度具有周期性，并排除 $360^\\circ$ 的重复值。\n   在您的实现中将角度转换为弧度。\n\n测试套件：\n- 情况1（高斯气旋）：\n  - 基准气压 $p_0 = 101{,}325\\ \\text{Pa}$。\n  - 异常振幅 $A = -3{,}000\\ \\text{Pa}$。\n  - 水平尺度 $L = 150{,}000\\ \\text{m}$。\n  - 中心位于纬度 $\\phi_0 = 30^\\circ$ 和经度 $\\lambda_0 = 0^\\circ$。\n  - 异常是大圆距离 $d = R\\,\\gamma$ 的函数，其中 $\\gamma$ 是 $(\\phi,\\lambda)$ 和 $(\\phi_0,\\lambda_0)$ 之间的中心角：\n    $$p(\\phi,\\lambda) = p_0 + A\\exp\\left(-\\frac{d^2}{2L^2}\\right).$$\n- 情况2（高斯反气旋）：\n  - 基准气压 $p_0 = 101{,}325\\ \\text{Pa}$。\n  - 异常振幅 $A = +3{,}000\\ \\text{Pa}$。\n  - 水平尺度 $L = 120{,}000\\ \\text{m}$。\n  - 中心位于纬度 $\\phi_0 = 80^\\circ$ 和经度 $\\lambda_0 = 90^\\circ$。\n  - 与情况1相同的大圆高斯形式。\n- 情况3（纬向波数和经向波数模式）：\n  - 基准气压 $p_0 = 101{,}325\\ \\text{Pa}$。\n  - 振幅 $A = 1{,}000\\ \\text{Pa}$。\n  - 纬向波数 $m = 6$，经向波数 $n = 4$。\n  - 场：\n    $$p(\\phi,\\lambda) = p_0 + A\\cos(m\\lambda)\\cos(n\\phi).$$\n\n要求的输出：\n- 对每个测试用例，生成三元组 $[C,A,M]$，其中 $C$ 是气旋中心的整数计数， $A$ 是反气旋中心的整数计数， $M$ 是整个网格上拉普拉斯算子的最大绝对值，以 $\\text{Pa}\\,\\text{m}^{-2}$ 表示。\n- 您的程序应生成单行输出，其中包含三个测试用例的结果，形式为方括号内包含的、以逗号分隔的这些三元组列表，其中浮点数 $M$ 值以六位有效数字的科学记数法格式化（例如，$1.234567\\times 10^{-9}$ 应打印为 `1.234567e-09`）。例如：\n  $$[[C_1,A_1,M_1],[C_2,A_2,M_2],[C_3,A_3,M_3]].$$\n\n所有气压值单位为帕斯卡，拉普拉斯算子单位为帕斯卡每平方米。角度必须以弧度为单位；相应地构建异常和导数。数值网格必须严格遵循上述规范。通过在整个过程中保持单位和球面几何的一致性来确保科学真实性。",
            "solution": "我们从拉普拉斯-贝尔特拉米算子的定义开始，这是拉普拉斯算子到弯曲流形的几何推广。对于黎曼流形上度量张量为 $g_{ij}$ 的标量场 $p$，其拉普拉斯-贝尔特拉米算子为\n$$\n\\nabla^2 p \\equiv \\nabla\\cdot(\\nabla p) = \\frac{1}{\\sqrt{|g|}}\\partial_i\\left(\\sqrt{|g|}\\,g^{ij}\\,\\partial_j p\\right),\n$$\n其中 $g^{ij}$ 是 $g_{ij}$ 的逆， $|g|$ 是 $g_{ij}$ 的行列式，我们使用爱因斯坦求和约定。在由纬度 $\\phi$ 和经度 $\\lambda$ 参数化的半径为 $R$ 的球面上，线元是\n$$\nds^2 = R^2\\,d\\phi^2 + R^2\\cos^2\\phi\\,d\\lambda^2.\n$$\n因此，在 $(\\phi,\\lambda)$ 坐标系中，度量张量是对角的：\n$$\ng_{\\phi\\phi} = R^2,\\quad g_{\\lambda\\lambda} = R^2\\cos^2\\phi,\\quad g_{\\phi\\lambda}=g_{\\lambda\\phi}=0.\n$$\n逆度量是\n$$\ng^{\\phi\\phi} = \\frac{1}{R^2},\\quad g^{\\lambda\\lambda} = \\frac{1}{R^2\\cos^2\\phi}.\n$$\n行列式为 $|g| = R^4\\cos^2\\phi$，因此 $\\sqrt{|g|} = R^2\\cos\\phi$。\n\n将拉普拉斯-贝尔特拉米算子的一般公式应用于 $p(\\phi,\\lambda)$ 得出\n$$\n\\nabla^2 p = \\frac{1}{\\sqrt{|g|}}\\left[\\partial_\\phi\\left(\\sqrt{|g|}g^{\\phi\\phi}\\partial_\\phi p\\right)+\\partial_\\lambda\\left(\\sqrt{|g|}g^{\\lambda\\lambda}\\partial_\\lambda p\\right)\\right].\n$$\n代入 $\\sqrt{|g|}=R^2\\cos\\phi$，$g^{\\phi\\phi}=1/R^2$ 和 $g^{\\lambda\\lambda}=1/(R^2\\cos^2\\phi)$：\n$$\n\\nabla^2 p = \\frac{1}{R^2\\cos\\phi}\\left[\\partial_\\phi\\left(\\cos\\phi\\,\\partial_\\phi p\\right)+\\partial_\\lambda\\left(\\frac{1}{\\cos\\phi}\\,\\partial_\\lambda p\\right)\\right].\n$$\n因为 $\\cos\\phi$ 只依赖于 $\\phi$，经度项简化为：\n$$\n\\partial_\\lambda\\left(\\frac{1}{\\cos\\phi}\\,\\partial_\\lambda p\\right) = \\frac{1}{\\cos\\phi}\\,\\partial_{\\lambda\\lambda}p.\n$$\n展开纬度项得到\n$$\n\\partial_\\phi\\left(\\cos\\phi\\,\\partial_\\phi p\\right) = \\cos\\phi\\,\\partial_{\\phi\\phi}p - \\sin\\phi\\,\\partial_\\phi p.\n$$\n合并并除以 $R^2\\cos\\phi$ 得出显式算子\n$$\n\\nabla^2 p = \\frac{1}{R^2}\\left[\\partial_{\\phi\\phi}p - \\tan\\phi\\,\\partial_\\phi p + \\frac{1}{\\cos^2\\phi}\\,\\partial_{\\lambda\\lambda}p\\right].\n$$\n当应用于单位为帕斯卡的海平面气压时，该算子的单位是 $\\text{Pa}\\,\\text{m}^{-2}$，因为二阶导数贡献了角度的平方反比单位，而前置因子贡献了 $1/R^2$。\n\n在经纬度网格上的数值近似：\n- 设网格在纬度和经度上是均匀的，间距分别为 $\\Delta\\phi$ 和 $\\Delta\\lambda$（弧度）。对内部点使用中心差分：\n  - 一阶纬度导数：\n    $$\n    \\partial_\\phi p\\big|_{i,j} \\approx \\frac{p_{i+1,j}-p_{i-1,j}}{2\\Delta\\phi}.\n    $$\n  - 二阶纬度导数：\n    $$\n    \\partial_{\\phi\\phi}p\\big|_{i,j} \\approx \\frac{p_{i+1,j}-2p_{i,j}+p_{i-1,j}}{\\Delta\\phi^2}.\n    $$\n  - 一阶经度导数（仅用于中间检查，上述算子不需要），和二阶经度导数（需要）：\n    $$\n    \\partial_{\\lambda\\lambda}p\\big|_{i,j} \\approx \\frac{p_{i,j+1}-2p_{i,j}+p_{i,j-1}}{\\Delta\\lambda^2}.\n    $$\n- 通过环绕索引在经度上强制使用周期性边界条件：$p_{i,-1}\\equiv p_{i,N_\\lambda-1}$ 和 $p_{i,N_\\lambda}\\equiv p_{i,0}$。\n- 在两个纬度边界（索引 $i=0$ 和 $i=N_\\phi-1$）处使用单侧二阶精度格式：\n  - 对于一阶导数：\n    $$\n    \\partial_\\phi p\\big|_{0,j} \\approx \\frac{-3p_{0,j}+4p_{1,j}-p_{2,j}}{2\\Delta\\phi},\\quad\n    \\partial_\\phi p\\big|_{N_\\phi-1,j} \\approx \\frac{3p_{N_\\phi-1,j}-4p_{N_\\phi-2,j}+p_{N_\\phi-3,j}}{2\\Delta\\phi}.\n    $$\n  - 对于二阶导数：\n    $$\n    \\partial_{\\phi\\phi}p\\big|_{0,j} \\approx \\frac{2p_{0,j}-5p_{1,j}+4p_{2,j}-p_{3,j}}{\\Delta\\phi^2},\\quad\n    \\partial_{\\phi\\phi}p\\big|_{N_\\phi-1,j} \\approx \\frac{2p_{N_\\phi-1,j}-5p_{N_\\phi-2,j}+4p_{N_\\phi-3,j}-p_{N_\\phi-4,j}}{\\Delta\\phi^2}.\n    $$\n- 使用以下公式在每个网格点计算拉普拉斯-贝尔特拉米算子\n  $$\n  \\nabla^2 p\\big|_{i,j} = \\frac{1}{R^2}\\left[\\partial_{\\phi\\phi}p\\big|_{i,j} - \\tan\\phi_i\\,\\partial_\\phi p\\big|_{i,j} + \\frac{1}{\\cos^2\\phi_i}\\,\\partial_{\\lambda\\lambda}p\\big|_{i,j}\\right].\n  $$\n\n构建测试场：\n- 对于高斯异常，使用大圆距离 $d=R\\gamma$，其中 $(\\phi,\\lambda)$ 和 $(\\phi_0,\\lambda_0)$ 之间的中心角 $\\gamma$ 满足\n  $$\n  \\cos\\gamma = \\sin\\phi\\,\\sin\\phi_0 + \\cos\\phi\\,\\cos\\phi_0\\,\\cos(\\lambda-\\lambda_0),\n  $$\n  并定义\n  $$\n  p(\\phi,\\lambda) = p_0 + A\\exp\\left(-\\frac{d^2}{2L^2}\\right).\n  $$\n- 对于波型模式，\n  $$\n  p(\\phi,\\lambda) = p_0 + A\\cos(m\\lambda)\\cos(n\\phi).\n  $$\n\n识别气旋和反气旋：\n- 在每个网格点，将 $p_{i,j}$ 与其八个邻点 $\\{p_{i\\pm1,j},p_{i,j\\pm1},p_{i\\pm1,j\\pm1}\\}$ 进行比较，使用经度周期性并排除纬度环绕（不要在边界处环绕纬度）。\n- 气旋中心要求 $p_{i,j}$ 严格小于所有邻点，$\\nabla^2p_{i,j}>0$，并且 $|\\nabla^2p_{i,j}|\\ge T$。\n- 反气旋中心要求 $p_{i,j}$ 严格大于所有邻点，$\\nabla^2p_{i,j}0$，并且 $|\\nabla^2p_{i,j}|\\ge T$。\n- 最大绝对拉普拉斯值为\n  $$\n  M = \\max_{i,j}|\\nabla^2p_{i,j}|.\n  $$\n\n单位和格式化：\n- 气压单位为帕斯卡，拉普拉斯算子单位为帕斯卡每平方米。\n- 角度以弧度为单位；转换以度为单位提供的网格和参数。\n- 将每种情况报告为三元组 $[C,A,M]$，其中 $M$ 以六位有效数字的科学记数法打印。\n- 输出单行：\n  $$\n  [[C_1,A_1,M_1],[C_2,A_2,M_2],[C_3,A_3,M_3]].\n  $$\n\n此设计将球面上算子的几何推导与一个有限差分算法相结合，该算法对经度周期性具有鲁棒性，并通过从网格中排除极点来避免极点奇点。通过局部极值和拉普拉斯算子符号对气旋和反气旋进行分类，这与将拉普拉斯算子解释为曲率度量是一致的：在 $p$ 的局部最小值附近，曲率为正（上凹），而在局部最大值附近，曲率为负（下凹）。",
            "answer": "```python\nimport numpy as np\n\nR_EARTH = 6_371_000.0  # meters\nDEG2RAD = np.pi / 180.0\n\ndef central_angle(lat, lon, lat0, lon0):\n    \"\"\"\n    Compute the central angle gamma between (lat, lon) and (lat0, lon0)\n    using the spherical law of cosines. All inputs in radians.\n    \"\"\"\n    cos_gamma = np.sin(lat) * np.sin(lat0) + np.cos(lat) * np.cos(lat0) * np.cos(lon - lon0)\n    # Numerical safety\n    cos_gamma = np.clip(cos_gamma, -1.0, 1.0)\n    return np.arccos(cos_gamma)\n\ndef gaussian_slp(lat, lon, lat0_deg, lon0_deg, A, L, p0=101_325.0):\n    \"\"\"\n    Construct a Gaussian anomaly on the sphere centered at (lat0_deg, lon0_deg) with amplitude A (Pa),\n    horizontal scale L (m), on top of baseline p0 (Pa).\n    lat, lon arrays are in radians.\n    \"\"\"\n    lat0 = lat0_deg * DEG2RAD\n    lon0 = lon0_deg * DEG2RAD\n    gamma = central_angle(lat, lon, lat0, lon0)\n    d = R_EARTH * gamma\n    return p0 + A * np.exp(-(d**2) / (2.0 * L**2))\n\ndef wave_slp(lat, lon, m, n, A, p0=101_325.0):\n    \"\"\"\n    Construct a wave pattern p = p0 + A cos(m lambda) cos(n phi).\n    lat, lon arrays are in radians.\n    \"\"\"\n    return p0 + A * np.cos(m * lon) * np.cos(n * lat)\n\ndef finite_difference_derivatives(p, dphi, dlam):\n    \"\"\"\n    Compute first and second derivatives w.r.t. latitude (phi) and longitude (lambda)\n    on a regular lat-lon grid.\n    Longitude is periodic. Latitude uses one-sided second-order stencils at boundaries.\n    Returns:\n        dp_dphi, d2p_dphi2, d2p_dlam2\n    Shapes match p.\n    \"\"\"\n    nphi, nlam = p.shape\n\n    # First derivative in phi\n    dp_dphi = np.empty_like(p)\n    # Interior\n    dp_dphi[1:-1, :] = (p[2:, :] - p[:-2, :]) / (2.0 * dphi)\n    # Boundaries (one-sided, second-order)\n    dp_dphi[0, :] = (-3.0 * p[0, :] + 4.0 * p[1, :] - p[2, :]) / (2.0 * dphi)\n    dp_dphi[-1, :] = (3.0 * p[-1, :] - 4.0 * p[-2, :] + p[-3, :]) / (2.0 * dphi)\n\n    # Second derivative in phi\n    d2p_dphi2 = np.empty_like(p)\n    # Interior\n    d2p_dphi2[1:-1, :] = (p[2:, :] - 2.0 * p[1:-1, :] + p[:-2, :]) / (dphi**2)\n    # Boundaries (one-sided, second-order, 4-point)\n    d2p_dphi2[0, :] = (2.0 * p[0, :] - 5.0 * p[1, :] + 4.0 * p[2, :] - p[3, :]) / (dphi**2)\n    d2p_dphi2[-1, :] = (2.0 * p[-1, :] - 5.0 * p[-2, :] + 4.0 * p[-3, :] - p[-4, :]) / (dphi**2)\n\n    # Second derivative in lambda (periodic)\n    p_roll_plus = np.roll(p, -1, axis=1)\n    p_roll_minus = np.roll(p, 1, axis=1)\n    d2p_dlam2 = (p_roll_plus - 2.0 * p + p_roll_minus) / (dlam**2)\n\n    return dp_dphi, d2p_dphi2, d2p_dlam2\n\ndef laplacian_on_sphere(p, lat_radians, dphi, dlam, R):\n    \"\"\"\n    Compute Laplace-Beltrami operator for scalar p on the sphere using latitude-latitude grid.\n    p shape: (nphi, nlam), lat_radians shape: (nphi,), dphi, dlam in radians.\n    Returns Laplacian with units Pa/m^2.\n    \"\"\"\n    dp_dphi, d2p_dphi2, d2p_dlam2 = finite_difference_derivatives(p, dphi, dlam)\n    coslat = np.cos(lat_radians)[:, None]  # shape (nphi,1)\n    tanlat = np.tan(lat_radians)[:, None]\n    # Avoid division by very small coslat by leaving grid that excludes poles\n    inv_cos2 = 1.0 / (coslat**2)\n    lap = (1.0 / (R**2)) * (d2p_dphi2 - tanlat * dp_dphi + inv_cos2 * d2p_dlam2)\n    return lap\n\ndef local_extrema_counts(p, lap, threshold, periodic_lon=True):\n    \"\"\"\n    Count cyclonic and anticyclonic centers based on local extremum and Laplacian sign/magnitude.\n    Cyclone: strict local minimum, lap > 0, |lap| >= threshold.\n    Anticyclone: strict local maximum, lap  0, |lap| >= threshold.\n    Uses 8-neighbor stencil. Longitude periodicity optional; latitude NOT wrapped.\n    \"\"\"\n    nphi, nlam = p.shape\n\n    # Build neighbor arrays via roll for longitude, and slices for latitude.\n    # We'll construct comparisons using rolled arrays, but we will exclude latitude edges from detection.\n    neighbors = []\n    # Cardinal directions\n    neighbors.append(np.roll(p, 1, axis=1))   # east (lon+)\n    neighbors.append(np.roll(p, -1, axis=1))  # west (lon-)\n    neighbors.append(np.vstack([p[1:, :], p[-1:, :]]))  # south (lat+); duplicate last for boundary\n    neighbors.append(np.vstack([p[:1, :], p[:-1, :]]))  # north (lat-); duplicate first for boundary\n    # Diagonals\n    neighbors.append(np.roll(np.vstack([p[1:, :], p[-1:, :]]), 1, axis=1))   # south-east\n    neighbors.append(np.roll(np.vstack([p[1:, :], p[-1:, :]]), -1, axis=1))  # south-west\n    neighbors.append(np.roll(np.vstack([p[:1, :], p[:-1, :]]), 1, axis=1))   # north-east\n    neighbors.append(np.roll(np.vstack([p[:1, :], p[:-1, :]]), -1, axis=1))  # north-west\n\n    # Strict local minima/maxima masks\n    is_min = np.ones_like(p, dtype=bool)\n    is_max = np.ones_like(p, dtype=bool)\n    for nbr in neighbors:\n        is_min = (p  nbr)\n        is_max = (p > nbr)\n\n    # Exclude latitude edges from consideration (no wrapping in latitude)\n    is_min[0, :] = False\n    is_min[-1, :] = False\n    is_max[0, :] = False\n    is_max[-1, :] = False\n\n    lap_pos = lap > 0.0\n    lap_neg = lap  0.0\n    lap_mag_ok = np.abs(lap) >= threshold\n\n    cyclone_mask = is_min  lap_pos  lap_mag_ok\n    anticyclone_mask = is_max  lap_neg  lap_mag_ok\n\n    C = int(np.count_nonzero(cyclone_mask))\n    A = int(np.count_nonzero(anticyclone_mask))\n    return C, A\n\ndef format_results(results):\n    \"\"\"\n    Format results as [[C1,A1,M1],[C2,A2,M2],...], with M in scientific notation with six significant digits.\n    \"\"\"\n    chunks = []\n    for C, A, M in results:\n        chunks.append(f\"[{C},{A},{format(M, '.6e')}]\")\n    return \"[\" + \",\".join(chunks) + \"]\"\n\ndef solve():\n    # Grid specification\n    lat_deg = np.arange(-89.5, 90.0, 0.5)\n    lon_deg = np.arange(0.0, 360.0, 0.5)  # exclude 360 to avoid duplicate\n    lat = lat_deg * DEG2RAD\n    lon = lon_deg * DEG2RAD\n    nphi = lat.size\n    nlam = lon.size\n    # 2D mesh\n    LAT, LON = np.meshgrid(lat, lon, indexing='ij')\n    dphi = (0.5) * DEG2RAD\n    dlam = (0.5) * DEG2RAD\n\n    # Threshold for high curvature\n    T = 1e-9  # Pa/m^2\n\n    test_cases = [\n        # Case 1: Gaussian cyclone\n        (\"gaussian\", {\"lat0_deg\": 30.0, \"lon0_deg\": 0.0, \"A\": -3000.0, \"L\": 150_000.0}),\n        # Case 2: Gaussian anticyclone near pole\n        (\"gaussian\", {\"lat0_deg\": 80.0, \"lon0_deg\": 90.0, \"A\": +3000.0, \"L\": 120_000.0}),\n        # Case 3: Wave pattern\n        (\"wave\", {\"m\": 6, \"n\": 4, \"A\": 1000.0}),\n    ]\n\n    results = []\n    for kind, params in test_cases:\n        if kind == \"gaussian\":\n            p = gaussian_slp(LAT, LON,\n                             params[\"lat0_deg\"], params[\"lon0_deg\"],\n                             params[\"A\"], params[\"L\"])\n        elif kind == \"wave\":\n            p = wave_slp(LAT, LON,\n                         params[\"m\"], params[\"n\"],\n                         params[\"A\"])\n        else:\n            raise ValueError(\"Unknown test case kind\")\n\n        lap = laplacian_on_sphere(p, lat, dphi, dlam, R_EARTH)\n        C, A = local_extrema_counts(p, lap, T)\n        M = float(np.max(np.abs(lap)))\n        results.append((C, A, M))\n\n    print(format_results(results))\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}