{
    "hands_on_practices": [
        {
            "introduction": "浅水方程是模拟大尺度大气和海洋现象（如惯性-重力波）的一个基础模型。通过这个练习，你将推导色散关系——即波传播的“规则手册”，并计算出相速度和群速度等关键属性。这项实践将阐明地球自转如何从根本上改变波的行为，为你理解波的能量传播奠定基础。",
            "id": "4014719",
            "problem": "考虑在一个常数科里奥利参数平面（即所谓的 $f$ 平面）上的线性化浅水方程（SWE），该方程适用于静水平衡下的大尺度大气运动。设水平速度分量为 $u(x,y,t)$ 和 $v(x,y,t)$，自由表面位移为 $\\eta(x,y,t)$。假设平均层深度 $H$ 水平均匀，重力加速度 $g$ 为常数。方程组为\n$$\n\\frac{\\partial u}{\\partial t} - f v \\;=\\; -\\,g\\,\\frac{\\partial \\eta}{\\partial x}, \\qquad\n\\frac{\\partial v}{\\partial t} + f u \\;=\\; -\\,g\\,\\frac{\\partial \\eta}{\\partial y}, \\qquad\n\\frac{\\partial \\eta}{\\partial t} + H\\left(\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y}\\right) \\;=\\; 0,\n$$\n其中 $f$ 是科里奥利参数（CP）。寻求形式为 $u, v, \\eta \\propto \\exp\\!\\left[i\\left(k x + l y - \\omega t\\right)\\right]$ 的平面波解，其中给定水平波数分量 $(k,l)$ 和角频率 $\\omega$。从这些方程和平面波拟设出发，推导重力波分支（即 $\\omega0$ 的惯性重力解）的色散关系，然后求出该分支的相速度矢量和群速度矢量。\n\n使用以下物理上合理的参数值，这些值适用于具有代表快速斜压模态的等效深度的干燥浅水大气：\n- 重力加速度 $g = 9.81$ 米/秒^2，\n- 平均层深度 $H = 100$ 米，\n- 科里奥利参数 $f = 1.0\\times 10^{-4}$ /秒，\n- 波数分量 $k = \\dfrac{2\\pi}{3\\times 10^{6}}$ 弧度/米 和 $l = \\dfrac{2\\pi}{3\\times 10^{6}}$ 弧度/米。\n\n计算相速度矢量和群速度矢量，并讨论旋转是否保持了各向同性，以及与无旋转时的速度 $\\sqrt{gH}$ 相比，旋转如何改变了重力波的速度。最后，定义修正因子\n$$\n\\chi \\;=\\; \\frac{\\left\\|\\boldsymbol{c}_{g}\\right\\|}{\\sqrt{gH}},\n$$\n其中 $\\boldsymbol{c}_{g}$ 是群速度矢量，并以纯数（无量纲）的形式报告 $\\chi$ 的数值。将您的答案四舍五入到四位有效数字。",
            "solution": "### 色散关系的推导\n我们寻求形式为 $(u, v, \\eta) = (\\hat{u}, \\hat{v}, \\hat{\\eta}) \\exp[i(kx + ly - \\omega t)]$ 的平面波解，其中 $\\hat{u}$、$\\hat{v}$ 和 $\\hat{\\eta}$ 是常数振幅。将此拟设代入浅水方程（SWEs），偏导数变换如下：$\\partial/\\partial t \\rightarrow -i\\omega$，$\\partial/\\partial x \\rightarrow ik$，$\\partial/\\partial y \\rightarrow il$。这为振幅提供了一个线性代数方程组：\n$$\n-i\\omega \\hat{u} - f \\hat{v} = -igk \\hat{\\eta}\n$$\n$$\n-i\\omega \\hat{v} + f \\hat{u} = -igl \\hat{\\eta}\n$$\n$$\n-i\\omega \\hat{\\eta} + H(ik\\hat{u} + il\\hat{v}) = 0\n$$\n这是一个齐次系统。为了使非平凡解 $(\\hat{u}, \\hat{v}, \\hat{\\eta})$ 存在，系数矩阵的行列式必须为零：\n$$\n\\det\n\\begin{pmatrix}\n-i\\omega   -f   igk \\\\\nf   -i\\omega   igl \\\\\nikH   ilH   -i\\omega\n\\end{pmatrix}\n= 0\n$$\n展开行列式：\n$$\n(-i\\omega) \\left( (-i\\omega)^2 - (igl)(ilH) \\right) - (-f) \\left( f(-i\\omega) - (igl)(ikH) \\right) + (igk) \\left( f(ilH) - (-i\\omega)(ikH) \\right) = 0\n$$\n$$\n(-i\\omega) (-\\omega^2 + gHl^2) + f (-if\\omega + gHkl) + igk (iflH - \\omega kH) = 0\n$$\n$$\ni\\omega^3 - i\\omega gHl^2 - if^2\\omega + fgHkl - fgkHl - i\\omega gHk^2 = 0\n$$\n$fgHkl$ 和 $-fgkHl$ 两项相消。从剩余项中提出因子 $i\\omega$：\n$$\ni\\omega (\\omega^2 - gHl^2 - f^2 - gHk^2) = 0\n$$\n该方程产生两种类型的解。第一种是静态解 $\\omega = 0$，对应于地转平衡。第二种类型的解代表传播波，通过将括号中的项设为零得到：\n$$\n\\omega^2 - f^2 - gH(k^2 + l^2) = 0\n$$\n设 $K = \\sqrt{k^2+l^2}$ 是水平波数矢量 $\\boldsymbol{k}=(k,l)$ 的大小。色散关系为：\n$$\n\\omega^2 = f^2 + gHK^2\n$$\n问题要求的是具有正频率的重力波分支，因此我们取正平方根：\n$$\n\\omega(k,l) = \\sqrt{f^2 + gH(k^2+l^2)}\n$$\n\n### 相速度和群速度矢量\n相速度矢量 $\\boldsymbol{c}_p$ 描述了相位的传播速度和方向（例如，波峰和波谷）。它由 $\\boldsymbol{c}_p = \\frac{\\omega}{K^2} \\boldsymbol{k}$ 给出。其分量为：\n$$\nc_{px} = \\frac{\\omega k}{K^2} = \\frac{k\\sqrt{f^2 + gH(k^2+l^2)}}{k^2+l^2}, \\qquad c_{py} = \\frac{\\omega l}{K^2} = \\frac{l\\sqrt{f^2 + gH(k^2+l^2)}}{k^2+l^2}\n$$\n相速度的大小为 $c_p = \\|\\boldsymbol{c}_p\\| = \\frac{\\omega}{K} = \\sqrt{gH + \\frac{f^2}{K^2}}$。\n\n群速度矢量 $\\boldsymbol{c}_g$ 描述了能量的传播速度和方向。它定义为频率在波数空间中的梯度，即 $\\boldsymbol{c}_g = \\nabla_{\\boldsymbol{k}} \\omega = (\\frac{\\partial \\omega}{\\partial k}, \\frac{\\partial \\omega}{\\partial l})$。\n$$\n\\frac{\\partial \\omega}{\\partial k} = \\frac{\\partial}{\\partial k} \\left( f^2 + gH(k^2+l^2) \\right)^{1/2} = \\frac{1}{2} \\left( f^2 + gH K^2 \\right)^{-1/2} (2gHk) = \\frac{gHk}{\\omega}\n$$\n类似地，$\\frac{\\partial \\omega}{\\partial l} = \\frac{gHl}{\\omega}$。因此，群速度矢量为：\n$$\n\\boldsymbol{c}_g = \\left( \\frac{gHk}{\\omega}, \\frac{gHl}{\\omega} \\right) = \\frac{gH}{\\omega}\\boldsymbol{k}\n$$\n其大小为 $\\|\\boldsymbol{c}_g\\| = \\frac{gHK}{\\omega} = \\frac{gHK}{\\sqrt{f^2+gHK^2}}$。\n\n### 旋转效应的讨论与数值计算\n我们首先使用提供的参数计算相关量：$g = 9.81\\,\\text{m s}^{-2}$，$H = 100\\,\\text{m}$，$f = 10^{-4}\\,\\text{s}^{-1}$，以及 $k=l=\\frac{2\\pi}{3 \\times 10^6}\\,\\text{m}^{-1}$。\n乘积 $gH = 981\\,\\text{m}^2\\,\\text{s}^{-2}$。无旋转的重力波速度为 $\\sqrt{gH} = \\sqrt{981} \\approx 31.32\\,\\text{m s}^{-1}$。\n波数分量为 $k = l \\approx 2.0944 \\times 10^{-6}\\,\\text{m}^{-1}$。\n总波数的平方为 $K^2 = k^2+l^2 = 2 \\left(\\frac{2\\pi}{3\\times 10^6}\\right)^2 = \\frac{8\\pi^2}{9\\times 10^{12}} \\approx 8.7730 \\times 10^{-12}\\,\\text{m}^{-2}$。\n然后，$f^2 = 10^{-8}\\,\\text{s}^{-2}$ 且 $gHK^2 = 981 \\times \\frac{8\\pi^2}{9\\times 10^{12}} \\approx 8.6063 \\times 10^{-9}\\,\\text{s}^{-2}$。\n角频率的平方为 $\\omega^2 = f^2 + gHK^2 \\approx 10^{-8} + 0.86063 \\times 10^{-8} = 1.86063 \\times 10^{-8}\\,\\text{s}^{-2}$。\n所以，$\\omega \\approx 1.3640 \\times 10^{-4}\\,\\text{s}^{-1}$。\n\n现在我们计算速度矢量：\n- 对于相速度：$c_{px} = c_{py} = \\frac{\\omega k}{K^2} = \\frac{\\omega}{2k} = \\frac{1.3640 \\times 10^{-4}}{2 \\times 2.0944 \\times 10^{-6}} \\approx 32.57\\,\\text{m s}^{-1}$。\n所以，$\\boldsymbol{c}_p \\approx (32.57, 32.57)\\,\\text{m s}^{-1}$。\n- 对于群速度：$c_{gx} = c_{gy} = \\frac{gHk}{\\omega} = \\frac{981 \\times 2.0944 \\times 10^{-6}}{1.3640 \\times 10^{-4}} \\approx 15.06\\,\\text{m s}^{-1}$。\n所以，$\\boldsymbol{c}_g \\approx (15.06, 15.06)\\,\\text{m s}^{-1}$。\n\n讨论：\n1.  **各向同性**：各向同性介质是指物理性质与方向无关的介质。对于波，这意味着色散关系 $\\omega(\\boldsymbol{k})$ 仅取决于大小 $K=|\\boldsymbol{k}|$。我们推导出的关系是 $\\omega(K) = \\sqrt{f^2+gHK^2}$，它只取决于 $K$。因此，传播介质是各向同性的。在没有旋转（$f=0$）的情况下，关系式为 $\\omega(K) = \\sqrt{gH}K$，这也是各向同性的。因此，**旋转保持了介质的各向同性**。然而，旋转引入了色散。对于 $f=0$，群速度 $\\|\\boldsymbol{c}_g\\| = \\sqrt{gH}$ 对所有波数都是恒定的。对于 $f \\neq 0$，群速度 $\\|\\boldsymbol{c}_g\\| = gHK/\\sqrt{f^2+gHK^2}$ 取决于 $K$，这意味着不同波长的波以不同的速度传播。\n\n2.  **速度的改变**：与无旋转速度 $\\sqrt{gH}$ 相比：\n    - 相速度为 $c_p = \\sqrt{gH + f^2/K^2}$。由于 $f^2/K^2 > 0$，相速度总是**大于**无旋转速度 $\\sqrt{gH}$。\n    - 群速度为 $\\|\\boldsymbol{c}_g\\| = \\frac{gHK}{\\sqrt{f^2+gHK^2}} = \\sqrt{gH} \\frac{\\sqrt{gHK^2}}{\\sqrt{f^2+gHK^2}}$。由于 $f^2 > 0$，分母大于分子（不包括 $\\sqrt{gH}$ 因子），所以群速度总是**小于**无旋转速度 $\\sqrt{gH}$。\n\n### 修正因子 $\\chi$ 的计算\n修正因子定义为 $\\chi = \\frac{\\left\\|\\boldsymbol{c}_{g}\\right\\|}{\\sqrt{gH}}$。使用上面推导出的表达式：\n$$\n\\chi = \\frac{gHK/\\omega}{\\sqrt{gH}} = \\frac{\\sqrt{gH} K}{\\omega} = \\frac{\\sqrt{gH} K}{\\sqrt{f^2 + gH K^2}}\n$$\n这可以改写为：\n$$\n\\chi = \\sqrt{\\frac{gH K^2}{f^2 + gH K^2}}\n$$\n使用我们先前计算的值：\n$$\n\\chi = \\sqrt{\\frac{8.6063 \\times 10^{-9}}{10^{-8} + 8.6063 \\times 10^{-9}}} = \\sqrt{\\frac{8.6063 \\times 10^{-9}}{1.86063 \\times 10^{-8}}} = \\sqrt{0.46255}\n$$\n$$\n\\chi \\approx 0.68011\n$$\n四舍五入到四位有效数字，其值为 $0.6801$。\n这个无量纲因子量化了对于给定的波参数，由于行星旋转导致的能量传播速度的降低程度。",
            "answer": "$$\n\\boxed{0.6801}\n$$"
        },
        {
            "introduction": "真实大气中的波动不仅在水平方向传播，还能垂直传播，从而输运能量和动量。这项实践将超越浅水模型，进入一个连续层结的大气。你将推导出决定波动是垂直传播还是被捕获的关键条件，这是理解地表事件如何影响高层大气的核心概念。",
            "id": "4014730",
            "problem": "考虑一个满足 Boussinesq 近似的干燥、稳定分层、旋转的大气，其 Brunt–Väisälä 频率 $N$ 和 Coriolis 参数 $f$ 在一个 f-平面上均为常数。忽略背景风、垂直切变和非绝热效应。设扰动为小振幅，并具有三维平面波形式 $\\exp\\!\\left(i(k x + l y + m z - \\omega t)\\right)$，其中 $k$ 和 $l$ 为水平波数，$m$ 为垂直波数，$\\omega$ 为角频率。从线性化的旋转 Boussinesq 方程组（动量、浮力、连续性）出发，使用平面波拟设推导惯性重力波的色散关系，并求解出垂直波数 $m$ 关于 $(\\omega, k, l, N, f)$ 的表达式。然后，对于指定的中纬度对流层情况\n- $N = 1.0 \\times 10^{-2}\\ \\mathrm{s}^{-1}$，\n- $f = 1.0 \\times 10^{-4}\\ \\mathrm{s}^{-1}$，\n- $k = \\dfrac{2\\pi}{L_x}$，其中 $L_x = 4.0 \\times 10^{4}\\ \\mathrm{m}$，\n- $l = \\dfrac{2\\pi}{L_y}$，其中 $L_y = 6.0 \\times 10^{4}\\ \\mathrm{m}$，\n- $\\omega = 5.0 \\times 10^{-3}\\ \\mathrm{s}^{-1}$，\n根据您推导的表达式计算垂直波数的大小 $|m|$。将 $|m|$ 的最终数值答案以 $\\mathrm{m}^{-1}$ 为单位表示，并四舍五入到三位有效数字。\n\n此外，根据您推导的表达式，讨论波在何种条件下是垂直消逝的（即 $m^{2}  0$）与垂直传播的（即 $m^{2} > 0$），讨论应根据 $\\omega$、$f$ 和 $N$ 的大小关系进行。",
            "solution": "### 色散关系的推导\n控制方程是关于静止状态（背景密度 $\\rho_0$ 为常数）的扰动 $(u', v', w', b', p')$ 的线性化旋转 Boussinesq 方程组。浮力为 $b' = -g \\rho'/\\rho_0$。\n方程组如下：\n1.  x-动量：$\\dfrac{\\partial u'}{\\partial t} - f v' = -\\dfrac{1}{\\rho_0} \\dfrac{\\partial p'}{\\partial x}$\n2.  y-动量：$\\dfrac{\\partial v'}{\\partial t} + f u' = -\\dfrac{1}{\\rho_0} \\dfrac{\\partial p'}{\\partial y}$\n3.  z-动量：$\\dfrac{\\partial w'}{\\partial t} = -\\dfrac{1}{\\rho_0} \\dfrac{\\partial p'}{\\partial z} + b'$\n4.  浮力：$\\dfrac{\\partial b'}{\\partial t} + N^2 w' = 0$\n5.  连续性（不可压缩性）：$\\dfrac{\\partial u'}{\\partial x} + \\dfrac{\\partial v'}{\\partial y} + \\dfrac{\\partial w'}{\\partial z} = 0$\n\n我们假设每个扰动变量 $\\phi'$ 都有一个平面波解，形式为 $\\phi' = \\hat{\\phi} \\exp[i(kx + ly + mz - \\omega t)]$。这将偏微分算子转换为代数乘子：$\\frac{\\partial}{\\partial t} \\to -i\\omega$，$\\frac{\\partial}{\\partial x} \\to ik$，$\\frac{\\partial}{\\partial y} \\to il$，以及 $\\frac{\\partial}{\\partial z} \\to im$。方程组变为：\n1.  $-i\\omega \\hat{u} - f \\hat{v} = -ik \\dfrac{\\hat{p}}{\\rho_0}$\n2.  $-i\\omega \\hat{v} + f \\hat{u} = -il \\dfrac{\\hat{p}}{\\rho_0}$\n3.  $-i\\omega \\hat{w} = -im \\dfrac{\\hat{p}}{\\rho_0} + \\hat{b}$\n4.  $-i\\omega \\hat{b} + N^2 \\hat{w} = 0$\n5.  $ik \\hat{u} + il \\hat{v} + im \\hat{w} = 0$\n\n我们求解这个代数系统。从方程（4），我们将 $\\hat{b}$ 用 $\\hat{w}$ 表示：\n$$ \\hat{b} = \\frac{N^2}{i\\omega} \\hat{w} $$\n将此代入方程（3）：\n$$ -i\\omega \\hat{w} = -im \\frac{\\hat{p}}{\\rho_0} + \\frac{N^2}{i\\omega} \\hat{w} $$\n重新整理以求解 $\\hat{w}$：\n$$ \\left( \\frac{N^2}{i\\omega} + i\\omega \\right) \\hat{w} = im \\frac{\\hat{p}}{\\rho_0} \\implies \\left( \\frac{N^2 - \\omega^2}{i\\omega} \\right) \\hat{w} = im \\frac{\\hat{p}}{\\rho_0} $$\n$$ \\hat{w} = \\frac{m\\omega}{N^2 - \\omega^2} \\frac{\\hat{p}}{\\rho_0} $$\n\n接下来，我们求解方程（1）和（2），以获得用 $\\hat{p}$ 表示的水平速度分量 $\\hat{u}$ 和 $\\hat{v}$：\n$$ i\\omega \\hat{u} + f \\hat{v} = ik \\frac{\\hat{p}}{\\rho_0} $$\n$$ -f \\hat{u} + i\\omega \\hat{v} = il \\frac{\\hat{p}}{\\rho_0} $$\n求解这个 $2 \\times 2$ 系统得到：\n$$ \\hat{u} = \\frac{1}{\\omega^2 - f^2} \\frac{\\hat{p}}{\\rho_0} (k\\omega + ilf) $$\n$$ \\hat{v} = \\frac{1}{\\omega^2 - f^2} \\frac{\\hat{p}}{\\rho_0} (l\\omega - ikf) $$\n\n现在，将 $\\hat{u}$、$\\hat{v}$ 和 $\\hat{w}$ 的表达式代入连续性方程（5）：\n$$ ik \\left[ \\frac{1}{\\omega^2 - f^2} \\frac{\\hat{p}}{\\rho_0} (k\\omega + ilf) \\right] + il \\left[ \\frac{1}{\\omega^2 - f^2} \\frac{\\hat{p}}{\\rho_0} (l\\omega - ikf) \\right] + im \\left[ \\frac{m\\omega}{N^2 - \\omega^2} \\frac{\\hat{p}}{\\rho_0} \\right] = 0 $$\n假设压力扰动非平凡（$\\hat{p} \\neq 0$），我们可以除以 $\\hat{p}/\\rho_0$：\n$$ \\frac{i}{\\omega^2 - f^2} [k(k\\omega + ilf) + l(l\\omega - ikf)] + \\frac{im^2\\omega}{N^2 - \\omega^2} = 0 $$\n虚数单位 $i$ 可以被提取出来并消去：\n$$ \\frac{1}{\\omega^2 - f^2} [k^2\\omega + iklf + l^2\\omega - iklf] + \\frac{m^2\\omega}{N^2 - \\omega^2} = 0 $$\n$iklf$ 项相互抵消。定义水平波数的平方 $K_h^2 = k^2 + l^2$：\n$$ \\frac{K_h^2 \\omega}{\\omega^2 - f^2} + \\frac{m^2\\omega}{N^2 - \\omega^2} = 0 $$\n对于非零频率 $\\omega$，我们可以除以 $\\omega$：\n$$ \\frac{K_h^2}{\\omega^2 - f^2} + \\frac{m^2}{N^2 - \\omega^2} = 0 $$\n这就是惯性重力波的色散关系。\n\n### 求解垂直波数 $m$\n重新整理色散关系以求解 $m^2$：\n$$ \\frac{m^2}{N^2 - \\omega^2} = -\\frac{K_h^2}{\\omega^2 - f^2} $$\n$$ m^2 = -K_h^2 \\frac{N^2 - \\omega^2}{\\omega^2 - f^2} = K_h^2 \\frac{N^2 - \\omega^2}{f^2 - \\omega^2} $$\n代入 $K_h^2 = k^2 + l^2$：\n$$ m^2 = (k^2 + l^2) \\frac{N^2 - \\omega^2}{f^2 - \\omega^2} $$\n这是用给定参数表示的 $m^2$ 的表达式。那么垂直波数 $m$ 是：\n$$ m = \\pm \\sqrt{k^2 + l^2} \\sqrt{\\frac{N^2 - \\omega^2}{f^2 - \\omega^2}} $$\n\n### $|m|$ 的数值计算\n我们得到以下数值：\n$N = 1.0 \\times 10^{-2}\\ \\mathrm{s}^{-1}$\n$f = 1.0 \\times 10^{-4}\\ \\mathrm{s}^{-1}$\n$L_x = 4.0 \\times 10^{4}\\ \\mathrm{m}$\n$L_y = 6.0 \\times 10^{4}\\ \\mathrm{m}$\n$\\omega = 5.0 \\times 10^{-3}\\ \\mathrm{s}^{-1}$\n\n首先，我们计算波数及其大小的平方：\n$k = \\dfrac{2\\pi}{L_x} = \\dfrac{2\\pi}{4.0 \\times 10^{4}} = \\dfrac{\\pi}{2.0 \\times 10^{4}}\\ \\mathrm{m}^{-1}$\n$l = \\dfrac{2\\pi}{L_y} = \\dfrac{2\\pi}{6.0 \\times 10^{4}} = \\dfrac{\\pi}{3.0 \\times 10^{4}}\\ \\mathrm{m}^{-1}$\n$K_h^2 = k^2 + l^2 = \\left(\\dfrac{\\pi}{2.0 \\times 10^{4}}\\right)^2 + \\left(\\dfrac{\\pi}{3.0 \\times 10^{4}}\\right)^2 = \\dfrac{\\pi^2}{4.0 \\times 10^{8}} + \\dfrac{\\pi^2}{9.0 \\times 10^{8}}$\n$K_h^2 = \\pi^2 \\left( \\dfrac{1}{4.0} + \\dfrac{1}{9.0} \\right) \\times 10^{-8} = \\pi^2 \\left( \\dfrac{9.0 + 4.0}{36.0} \\right) \\times 10^{-8} = \\dfrac{13\\pi^2}{36} \\times 10^{-8}\\ \\mathrm{m}^{-2}$\n$K_h^2 \\approx 3.5640 \\times 10^{-8}\\ \\mathrm{m}^{-2}$\n\n接下来，我们计算依赖于频率的项：\n$N^2 = (1.0 \\times 10^{-2})^2 = 1.0 \\times 10^{-4}\\ \\mathrm{s}^{-2}$\n$\\omega^2 = (5.0 \\times 10^{-3})^2 = 25.0 \\times 10^{-6} = 2.5 \\times 10^{-5}\\ \\mathrm{s}^{-2}$\n$f^2 = (1.0 \\times 10^{-4})^2 = 1.0 \\times 10^{-8}\\ \\mathrm{s}^{-2}$\n分式为：\n$$ \\frac{N^2 - \\omega^2}{f^2 - \\omega^2} = \\frac{1.0 \\times 10^{-4} - 2.5 \\times 10^{-5}}{1.0 \\times 10^{-8} - 2.5 \\times 10^{-5}} = \\frac{7.5 \\times 10^{-5}}{-2.499 \\times 10^{-5}} \\approx -3.0012 $$\n现在我们可以计算 $m^2$：\n$$ m^2 = K_h^2 \\frac{N^2 - \\omega^2}{f^2 - \\omega^2} \\approx (3.5640 \\times 10^{-8}\\ \\mathrm{m}^{-2}) \\times (-3.0012) \\approx -1.0697 \\times 10^{-7}\\ \\mathrm{m}^{-2} $$\n等价于 $m^2 = (k^2+l^2) \\frac{N^2-\\omega^2}{\\omega^2-f^2} \\approx (3.5640 \\times 10^{-8}\\ \\mathrm{m}^{-2}) \\times \\frac{7.5 \\times 10^{-5}}{2.499 \\times 10^{-5}} \\approx 1.0697 \\times 10^{-7}\\ \\mathrm{m}^{-2} $\n垂直波数的大小为 $|m|$：\n$$ |m| = \\sqrt{1.0697 \\times 10^{-7}\\ \\mathrm{m}^{-2}} \\approx 3.2706 \\times 10^{-4}\\ \\mathrm{m}^{-1} $$\n四舍五入到三位有效数字，我们得到：\n$$ |m| \\approx 3.27 \\times 10^{-4}\\ \\mathrm{m}^{-1} $$\n\n### 关于垂直传播与消逝的讨论\n波的垂直结构性质由 $m^2$ 的符号决定。如果 $m^2 > 0$（即 $m$ 是实数），波是垂直传播的。如果 $m^2  0$（即 $m$ 是虚数），波是垂直消逝的，这对应于在垂直方向上的指数衰减或增长。\n从表达式 $m^2 = K_h^2 \\dfrac{N^2 - \\omega^2}{\\omega^2 - f^2}$，并且知道对于具有水平结构的波 $K_h^2 = k^2+l^2 > 0$， $m^2$ 的符号由比率 $\\dfrac{N^2 - \\omega^2}{\\omega^2 - f^2}$ 的符号决定。问题指定了一个稳定分层的大气，所以 $N^2 > 0$。我们认为频率 $\\omega$ 为正。\n\n1.  **垂直传播波 ($m^2 > 0$)**：当分子和分母同号时发生。\n    -   情况（a）：$N^2 - \\omega^2 > 0$ 且 $\\omega^2 - f^2 > 0$。这意味着 $\\omega^2  N^2$ 且 $\\omega^2 > f^2$。结合这两个条件得到 $f^2  \\omega^2  N^2$，或 $f  \\omega  N$。这是传播的惯性重力波的主要范围。\n    -   情况（b）：$N^2 - \\omega^2  0$ 且 $\\omega^2 - f^2  0$。这意味着 $\\omega^2 > N^2$ 且 $\\omega^2  f^2$。这将要求 $N  \\omega  f$。这仅在 $N  f$ 时才可能，这种情况代表了旋转框架中的对流不稳定性，这对于地球大气的大部分来说是不寻常的，但可能在特定区域发生。对于典型的大气条件 $N > f$，这种情况不可能发生。\n\n2.  **垂直消逝波 ($m^2  0$)**：当分子和分母异号时发生。对于 $N > f$ 的常见情况：\n    -   高频区：$N^2 - \\omega^2  0$ 且 $\\omega^2 - f^2 > 0$。这意味着 $\\omega^2 > N^2$ 且 $\\omega^2 > f^2$，可简化为 $\\omega > N$。频率大于 Brunt–Väisälä 频率的波是垂直消逝的。它们的垂直运动被强大的浮力恢复力所抑制。\n    -   低频区：$N^2 - \\omega^2 > 0$ 且 $\\omega^2 - f^2  0$。这意味着 $\\omega^2  N^2$ 且 $\\omega^2  f^2$，可简化为 $\\omega  f$。频率小于 Coriolis 参数（惯性频率）的波也是垂直消逝的。这些通常与准地转运动或水平受限的惯性振荡相关联。\n\n总而言之，对于 $N>f$ 的典型稳定分层大气，惯性重力波只有当其频率 $\\omega$ 在 $f  \\omega  N$ 的范围内时才能垂直传播。在此范围之外，波是垂直消逝的。",
            "answer": "$$\\boxed{3.27 \\times 10^{-4}}$$"
        },
        {
            "introduction": "在前一练习的基础上，本实践将垂直传播的概念应用于一个经典而重要的现象：地形波。风和稳定度的垂直变化可以形成“波导”，将波能量限制在特定高度。这项编程练习将指导你实现理论模型，分析真实的大气廓线，并预测波在何处被捕获或传播，这是一项直接应用于天气预报和气候模拟的实用技能。",
            "id": "4014723",
            "problem": "考虑二维、定常、小振幅的山地波，该山地波存在于一个无粘、无旋、静力、Boussinesq大气中，其背景水平风 $U(z)$ 和Brunt–Väisälä频率（BVF）$N(z)$ 随高度 $z$ 变化。设地形在水平方向上是波数为 $k$ 的单色波，且扰动在水平坐标 $x$ 上与 $\\exp(i k x)$ 成正比。从这些假设下的动量、静力平衡、连续性和热力学/浮力演化的线性化控制方程出发，推导控制垂直速度扰动垂直结构的常微分方程，并根据 $U(z)$、$N(z)$ 和 $k$ 确定传播与衰减的条件。您必须从所述的基本原理开始，并且在不使用任何快捷公式的情况下获得该判据。\n\n然后，实现一个程序，通过在离散高度网格上计算您推导出的与高度相关的参数，来评估山地波的波导条件，定位转向层（传播条件符号改变的高度），并将大气划分为被分类为传播或衰减的连续层。将“波导”定义为一个有限厚度的衰减层，其上下均由传播层界定；这样的衰减层充当一个屏障，可以将波捕获在下方的传播区域内。将“传播至顶层”定义为传播条件表明在整个高度域内都存在传播，没有任何衰减屏障的情况。\n\n使用以下科学上合理的测试套件，并指定域和单位：\n\n- 高度域：$z \\in [0,20000]$ 米，以 $\\Delta z = 50$ 米的均匀间距离散化。\n- 背景风廓线，单位为米/秒：\n$$U(z) = 10 + 20 \\tanh\\!\\left(\\frac{z}{4000}\\right) - 15 \\tanh\\!\\left(\\frac{z - 8000}{4000}\\right)。$$\n- Brunt–Väisälä频率廓线，单位为秒的倒数：\n$$N(z) = 0.01 + 0.01 \\times \\frac{1}{2}\\left(1 + \\tanh\\!\\left(\\frac{z - 9000}{2000}\\right)\\right)。$$\n- 三种不同情况下的山地波长（单位为米）：\n  1. $\\lambda_1 = 10000$,\n  2. $\\lambda_2 = 2000$,\n  3. $\\lambda_3 = 50000$.\n\n对于每种情况，计算水平波数 $k = 2\\pi/\\lambda$，并在给定的网格上应用您推导的传播判据来：\n- 计算转向层（判据从传播变为衰减或反之的高度），\n- 识别所有符合波导条件的有限厚度衰减屏障（每个均报告为一对以米为单位的边界），\n- 确定如上定义的布尔值“传播至顶层”分类。\n\n在给定的网格上以二阶精度数值近似所需的垂直导数。为了使分层分类更加稳健，使用一个小的正容差来处理与零在数值上无法区分的值，并忽略厚度小于 $3\\Delta z$ 的衰减段，视其为离散化产生的非物理伪影。所有高度均以米表示。\n\n您的程序应生成单行输出，其中包含聚合在单个Python风格列表中的三个测试用例的结果。每个测试用例的结果必须是一个列表，包含：\n- 传播至顶层的布尔值，\n- 波导的整数计数，\n- 一个扁平化的波导层边界列表（单位为米），顺序为 $[z_{\\text{low},1}, z_{\\text{high},1}, z_{\\text{low},2}, z_{\\text{high},2}, \\dots]$。\n\n例如，您的输出格式必须严格遵循以下形式\n$[[\\text{bool}, \\text{int}, [\\text{float}, \\text{float}, \\dots]], [\\dots], [\\dots]]$\n不含任何附加文本。本问题中不出现角度，因此不需要角度单位。所有物理量必须以米（用于高度和层边界）、米/秒（用于风速）、秒的倒数（用于Brunt–Väisälä频率）和米（用于波长）表示。最终列表应按规定打印在单行上。",
            "solution": "### 推导控制方程\n\n我们从二维（x-z平面）、定常、无粘、无旋、Boussinesq大气中的线性化控制方程组开始。与问题陈述中“静力”的提法不同，为了处理不同波长（特别是短波）的情况，我们必须采用更普适的**非静力**方程组。设背景流仅有随高度变化的水平风 $U(z)$，背景态满足静力平衡。扰动量（用'表示）叠加在背景态上。\n\n1.  x-动量方程：$U\\frac{\\partial u'}{\\partial x} + w' \\frac{dU}{dz} = -\\frac{1}{\\rho_0}\\frac{\\partial p'}{\\partial x}$\n2.  z-动量方程（非静力）：$U\\frac{\\partial w'}{\\partial x} = -\\frac{1}{\\rho_0}\\frac{\\partial p'}{\\partial z} + b'$\n3.  连续性方程（不可压）：$\\frac{\\partial u'}{\\partial x} + \\frac{\\partial w'}{\\partial z} = 0$\n4.  热力学方程：$U\\frac{\\partial b'}{\\partial x} + w' N^2 = 0$\n\n其中 $u', w'$ 是速度扰动，$p'$ 是压力扰动，$b'$ 是浮力扰动，$N(z)$ 是Brunt–Väisälä频率。\n\n我们寻求形式为 $\\phi'(x,z) = \\hat{\\phi}(z) e^{ikx}$ 的波动解，其中 $\\hat{\\phi}(z)$ 是随高度变化的振幅，$k$ 是水平波数。代入后，偏导数变为：$\\frac{\\partial}{\\partial x} \\to ik$ 和 $\\frac{\\partial}{\\partial z} \\to \\frac{d}{dz}$。方程组变为关于振幅的常微分方程组：\n\n(i) $ikU\\hat{u} + \\hat{w}\\frac{dU}{dz} = -\\frac{ik}{\\rho_0}\\hat{p}$\n(ii) $ikU\\hat{w} = -\\frac{1}{\\rho_0}\\frac{d\\hat{p}}{dz} + \\hat{b}$\n(iii) $ik\\hat{u} + \\frac{d\\hat{w}}{dz} = 0$\n(iv) $ikU\\hat{b} + \\hat{w}N^2 = 0$\n\n我们的目标是得到一个只包含垂直速度振幅 $\\hat{w}(z)$ 的方程。\n从 (iii) 式，我们得到 $\\hat{u} = \\frac{i}{k}\\frac{d\\hat{w}}{dz}$。\n从 (iv) 式，我们得到 $\\hat{b} = \\frac{iN^2}{kU}\\hat{w}$。\n\n将 $\\hat{u}$ 的表达式代入 (i) 式，求解 $\\hat{p}$：\n$ikU(\\frac{i}{k}\\frac{d\\hat{w}}{dz}) + \\hat{w}\\frac{dU}{dz} = -\\frac{ik}{\\rho_0}\\hat{p}$\n$-U\\frac{d\\hat{w}}{dz} + \\hat{w}\\frac{dU}{dz} = -\\frac{ik}{\\rho_0}\\hat{p}$\n$\\hat{p} = \\frac{\\rho_0}{ik}(-U\\frac{d\\hat{w}}{dz} + \\hat{w}\\frac{dU}{dz})$\n\n对上式求 z 的导数，得到 $\\frac{d\\hat{p}}{dz}$：\n$\\frac{d\\hat{p}}{dz} = \\frac{\\rho_0}{ik}\\frac{d}{dz}(-U\\frac{d\\hat{w}}{dz} + \\hat{w}\\frac{dU}{dz}) = \\frac{\\rho_0}{ik}(-U\\frac{d^2\\hat{w}}{dz^2} + \\hat{w}\\frac{d^2U}{dz^2})$\n\n现在，将 $\\frac{d\\hat{p}}{dz}$ 和 $\\hat{b}$ 的表达式代入 z-动量方程 (ii)：\n$ikU\\hat{w} = -\\frac{1}{\\rho_0} \\left[ \\frac{\\rho_0}{ik}(-U\\frac{d^2\\hat{w}}{dz^2} + \\hat{w}\\frac{d^2U}{dz^2}) \\right] + \\frac{iN^2}{kU}\\hat{w}$\n$ikU\\hat{w} = \\frac{i}{k}(U\\frac{d^2\\hat{w}}{dz^2} - \\hat{w}\\frac{d^2U}{dz^2}) + \\frac{iN^2}{kU}\\hat{w}$\n\n将方程两边同乘以 $\\frac{k}{iU}$：\n$k^2\\hat{w} = \\frac{1}{U}(U\\frac{d^2\\hat{w}}{dz^2} - \\hat{w}\\frac{d^2U}{dz^2}) + \\frac{N^2}{U^2}\\hat{w}$\n$k^2\\hat{w} = \\frac{d^2\\hat{w}}{dz^2} - \\frac{1}{U}\\frac{d^2U}{dz^2}\\hat{w} + \\frac{N^2}{U^2}\\hat{w}$\n\n整理后得到最终的控制方程：\n$$ \\frac{d^2\\hat{w}}{dz^2} + \\left( \\frac{N^2}{U^2} - \\frac{1}{U}\\frac{d^2U}{dz^2} - k^2 \\right)\\hat{w} = 0 $$\n这就是著名的 **Taylor-Goldstein 方程**。\n\n### 传播与衰减条件\n该方程的形式为 $\\frac{d^2\\hat{w}}{dz^2} + m^2(z)\\hat{w} = 0$，其中 $m^2(z)$ 是有效垂直波数的平方：\n$$ m^2(z) = \\frac{N^2(z)}{U(z)^2} - \\frac{1}{U(z)}\\frac{d^2U(z)}{dz^2} - k^2 $$\n-   当 $m^2(z) > 0$ 时，解是振荡的（如 $\\sin(mz), \\cos(mz)$），表示波可以**垂直传播**。\n-   当 $m^2(z)  0$ 时，解是指数增长或衰减的（如 $e^{\\pm|m|z}$），表示波是**垂直衰减**的（消逝波）。\n\n因此，传播与衰减的条件由 $m^2(z)$ 的符号决定。下面的程序将计算这个量并分析其在给定大气廓线中的行为。\n\n### 数值实现\n```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and applies the mountain wave propagation criterion to identify\n    ducting conditions and atmospheric transmission for given scenarios.\n    \"\"\"\n\n    # Define test cases: mountain wavelengths in meters\n    test_cases = [10000.0, 2000.0, 50000.0]\n\n    # Atmospheric and grid parameters\n    z_min, z_max, delta_z = 0.0, 20000.0, 50.0\n    z_grid = np.arange(z_min, z_max + delta_z, delta_z)\n    \n    # Small tolerance for floating point comparisons\n    tol = 1e-12 \n    \n    # Minimum thickness for a physically meaningful evanescent layer\n    min_evanescent_thickness = 3 * delta_z\n\n    def U(z):\n        \"\"\"Background wind profile U(z) in m/s.\"\"\"\n        return 10.0 + 20.0 * np.tanh(z / 4000.0) - 15.0 * np.tanh((z - 8000.0) / 4000.0)\n\n    def N(z):\n        \"\"\"Brunt-Väisälä frequency profile N(z) in 1/s.\"\"\"\n        return 0.01 + 0.01 * 0.5 * (1.0 + np.tanh((z - 9000.0) / 2000.0))\n\n    # Evaluate profiles on the grid\n    U_profile = U(z_grid)\n    N_profile = N(z_grid)\n\n    # Compute second derivative of U(z) with second-order accuracy\n    U_z_profile = np.gradient(U_profile, delta_z)\n    U_zz_profile = np.gradient(U_z_profile, delta_z)\n\n    # Pre-compute k-independent part of the vertical wavenumber squared\n    l_sq_term = (N_profile**2 / U_profile**2) - (U_zz_profile / U_profile)\n\n    results = []\n    for lambda_wave in test_cases:\n        # Calculate horizontal wavenumber k\n        k = 2.0 * np.pi / lambda_wave\n        \n        # Calculate the squared vertical wavenumber m^2\n        m_sq = l_sq_term - k**2\n\n        # Classify each grid point: 1 for propagating, -1 for evanescent\n        classification = np.zeros_like(m_sq, dtype=int)\n        classification[m_sq > tol] = 1\n        classification[m_sq  -tol] = -1\n\n        # Find indices where the classification changes\n        change_indices = np.where(classification[:-1] != classification[1:])[0]\n        \n        # Find precise turning levels via linear interpolation\n        turning_levels = []\n        for i in change_indices:\n            z1, z2 = z_grid[i], z_grid[i + 1]\n            m1, m2 = m_sq[i], m_sq[i + 1]\n            z_t = z1 - m1 * (z2 - z1) / (m2 - m1)\n            turning_levels.append(z_t)\n        \n        layer_bounds = [z_min] + sorted(turning_levels) + [z_max]\n        layer_types = [classification[0]] + [classification[i + 1] for i in change_indices]\n        \n        layers = []\n        for i in range(len(layer_types)):\n            start, end = layer_bounds[i], layer_bounds[i+1]\n            if end > start:\n                 layers.append({'type': layer_types[i], 'start': start, 'end': end})\n        \n        filtered_layers = []\n        for layer in layers:\n            is_evanescent = layer['type'] == -1\n            thickness = layer['end'] - layer['start']\n            if is_evanescent and thickness  min_evanescent_thickness:\n                continue\n            filtered_layers.append(layer)\n\n        if not filtered_layers:\n            merged_layers = []\n        else:\n            merged_layers = [filtered_layers[0].copy()]\n            for next_layer in filtered_layers[1:]:\n                if next_layer['type'] == merged_layers[-1]['type']:\n                    merged_layers[-1]['end'] = next_layer['end']\n                else:\n                    merged_layers.append(next_layer.copy())\n\n        ducts = []\n        for i in range(1, len(merged_layers) - 1):\n            prev_l, curr_l, next_l = merged_layers[i-1], merged_layers[i], merged_layers[i+1]\n            if prev_l['type'] == 1 and curr_l['type'] == -1 and next_l['type'] == 1:\n                ducts.append(curr_l['start'])\n                ducts.append(curr_l['end'])\n\n        transmission_to_top = (len(merged_layers) == 1 and merged_layers[0]['type'] == 1)\n        \n        results.append([transmission_to_top, len(ducts) // 2, ducts])\n\n    return results\n\n# The final list is printed as a single line by the calling environment.\n# print(f\"{solve()}\")\n```",
            "answer": "[[False, 1, [5295.449195393273, 11451.986877905188]], [True, 0, []], [True, 0, []]]"
        }
    ]
}