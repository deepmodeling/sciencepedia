{
    "hands_on_practices": [
        {
            "introduction": "地球物理流体动力学通常涉及包含众多项的复杂方程。尺度分析是一种强大的技术，可以简化这些方程并获得物理洞察。通过估算特定运动尺度下不同项的典型量级，我们可以确定哪些物理效应占主导地位，哪些可以忽略。本练习  将指导你对浅水动量方程进行尺度分析，推导出罗斯贝数（Rossby number），这是一个关键的无量纲参数，用于量化天气尺度系统中非线性平流与科里奥利力的相对重要性。",
            "id": "4103362",
            "problem": "考虑一个 $f$ 平面上的旋转浅水方程（SWE），将其作为天气尺度大气动力学的原型。对于具有自由表面位移 $\\eta(x,y,t)$ 和平均深度 $H$ 的单层浅流体，其水平速度场 $\\boldsymbol{u}(x,y,t)$ 的动量方程可以通过对流体质点应用牛顿第二定律和静力平衡写为：\n$$\n\\frac{\\partial \\boldsymbol{u}}{\\partial t} + (\\boldsymbol{u}\\cdot\\nabla)\\boldsymbol{u} + f\\,\\hat{\\boldsymbol{k}}\\times \\boldsymbol{u} = -g\\,\\nabla \\eta,\n$$\n其中 $f$ 是科里奥利参数，$g$ 是重力加速度，$\\hat{\\boldsymbol{k}}$ 是垂直方向的单位向量。使用基于上述动力学方程的尺度分析和天气尺度的中纬度数值 $U\\sim 10\\,{\\rm m\\,s^{-1}}$，$L\\sim 10^{6}\\,{\\rm m}$，$f\\sim 10^{-4}\\,{\\rm s^{-1}}$ 以及 $H\\sim 10^{4}\\,{\\rm m}$，从第一性原理推导非线性平流加速度 $(\\boldsymbol{u}\\cdot\\nabla)\\boldsymbol{u}$ 与科里奥利加速度 $f\\,\\hat{\\boldsymbol{k}}\\times \\boldsymbol{u}$ 的主导阶无量纲比率。将你的最终答案表示为一个单一的无量纲数。无需四舍五入。",
            "solution": "该问题被验证为科学上合理、适定且客观。为完成指定任务提供了所有必要信息，物理背景正确，问题明确。浅水方程是地球物理流体动力学中一个有效且基本的模型，而尺度分析是理解不同物理效应相对重要性的标准技术。给定的特征尺度是中纬度天气尺度大气现象的代表。\n\n问题要求计算非线性平流加速度与科里奥利加速度的主导阶无量纲比率。这些项可以在所提供的旋转浅水系统的动量方程中找到：\n$$\n\\frac{\\partial \\boldsymbol{u}}{\\partial t} + (\\boldsymbol{u}\\cdot\\nabla)\\boldsymbol{u} + f\\,\\hat{\\boldsymbol{k}}\\times \\boldsymbol{u} = -g\\,\\nabla \\eta\n$$\n我们感兴趣的两个项是：\n1.  非线性平流加速度：$(\\boldsymbol{u}\\cdot\\nabla)\\boldsymbol{u}$\n2.  科里奥利加速度：$f\\,\\hat{\\boldsymbol{k}}\\times \\boldsymbol{u}$\n\n我们进行尺度分析来估计每一项的特征量级。问题提供了以下天气尺度：\n-   特征水平速度，$U \\sim 10\\,{\\rm m\\,s^{-1}}$\n-   特征水平长度尺度，$L \\sim 10^{6}\\,{\\rm m}$\n-   特征科里奥利参数，$f \\sim 10^{-4}\\,{\\rm s^{-1}}$\n\n像梯度 $\\nabla$ 这样的微分算子的尺度，是由其作用的场发生显著变化的长度尺度决定的。在此背景下，该尺度为 $L$。因此，梯度算子的量级为 $L^{-1}$。\n$$\n|\\nabla| \\sim \\frac{1}{L}\n$$\n类似地，水平速度场 $\\boldsymbol{u}$ 的特征量级为 $U$。\n$$\n|\\boldsymbol{u}| \\sim U\n$$\n现在，我们来估计非线性平流加速度项 $(\\boldsymbol{u}\\cdot\\nabla)\\boldsymbol{u}$ 的量级。该项表示流体质点因其在空间变化的速速场中运动而产生的加速度。其量级可以通过其组成部分的尺度乘积来估计：\n$$\n|(\\boldsymbol{u}\\cdot\\nabla)\\boldsymbol{u}| \\sim |\\boldsymbol{u}| \\cdot |\\nabla| \\cdot |\\boldsymbol{u}| \\sim U \\cdot \\frac{1}{L} \\cdot U = \\frac{U^2}{L}\n$$\n接下来，我们估计科里奥利加速度项 $f\\,\\hat{\\boldsymbol{k}}\\times \\boldsymbol{u}$ 的量级。该项表示由于参考系旋转而产生的视加速度。向量 $\\hat{\\boldsymbol{k}}$ 是一个单位向量，叉积 $\\hat{\\boldsymbol{k}}\\times \\boldsymbol{u}$ 产生一个水平向量，其大小为 $|\\boldsymbol{u}|\\sin\\theta$，其中 $\\theta$ 是 $\\hat{\\boldsymbol{k}}$ 和 $\\boldsymbol{u}$ 之间的夹角。由于 $\\boldsymbol{u}$ 在水平面内，它垂直于垂直向量 $\\hat{\\boldsymbol{k}}$，因此 $\\theta = \\pi/2$ 且 $\\sin\\theta = 1$。所以，叉积的大小就是 $|\\boldsymbol{u}|$。整个项的量级是：\n$$\n|f\\,\\hat{\\boldsymbol{k}}\\times \\boldsymbol{u}| \\sim f \\cdot |\\boldsymbol{u}| \\sim fU\n$$\n非线性平流加速度与科里奥利加速度的无量纲比率是它们特征量级的比值。这个特定的比率在流体动力学中被称为罗斯贝数，记为 $Ro$。\n$$\nRo \\equiv \\frac{\\text{平流加速度的量级}}{\\text{科里奥利加速度的量级}} \\sim \\frac{|(\\boldsymbol{u}\\cdot\\nabla)\\boldsymbol{u}|}{|f\\,\\hat{\\boldsymbol{k}}\\times \\boldsymbol{u}|} \\sim \\frac{U^2/L}{fU}\n$$\n简化罗斯贝数的表达式可得：\n$$\nRo \\sim \\frac{U}{fL}\n$$\n问题要求使用所提供的值来计算这个比率。我们将给定的尺度代入罗斯贝数的表达式中：\n-   $U = 10\\,{\\rm m\\,s^{-1}}$\n-   $f = 10^{-4}\\,{\\rm s^{-1}}$\n-   $L = 10^{6}\\,{\\rm m}$\n\n计算如下：\n$$\nRo \\sim \\frac{10\\,{\\rm m\\,s^{-1}}}{(10^{-4}\\,{\\rm s^{-1}})(10^{6}\\,{\\rm m})} = \\frac{10}{10^{-4} \\cdot 10^{6}} = \\frac{10}{10^{2}} = \\frac{1}{10} = 0.1\n$$\n单位相互抵消，正如无量纲数所预期的那样：$({\\rm m\\,s^{-1}}) \\cdot ({\\rm s}) \\cdot ({\\rm m^{-1}}) = 1$。数值 $0.1$ 表明，对于天气尺度的运动，科里奥利加速度比平流加速度大一个数量级，这是地转平衡的基础。另一个提供的数据 $H\\sim 10^{4}\\,{\\rm m}$ 在本次具体计算中并未用到。",
            "answer": "$$\n\\boxed{0.1}\n$$"
        },
        {
            "introduction": "偏微分方程解的行为与其数学分类密切相关。浅水方程构成了一个双曲型系统，这意味着信息沿着称为特征线的特定路径传播。理解这些特征线不仅仅是理论练习，它对数值模拟具有至关重要的实际意义，尤其是在定义流体可以流入或流出区域的开放边界时。本练习  探讨了一维浅水方程的特征分析，让你能够确定如何为亚临界流和超临界流正确指定边界条件，这是建立河流、河口和大气急流等稳定、准确模型的关键技能。",
            "id": "4103318",
            "problem": "考虑一个水平底床上的一维、无粘性、无摩擦的浅水系统，该系统在数值天气预报 (NWP) 和气候模拟中用作开边界处理的原型。令 $x \\in [0,L]$ 表示流向坐标，其中 $x=0$ 为上游边界，$x=L$ 为下游边界。平均流是均匀的，速度为 $U>0$，平均深度为 $H>0$，重力加速度 $g>0$ 是一个常数。令 $\\eta(x,t)$ 为相对于平均深度的自由表面位移，$u(x,t)$ 为相对于均匀平均流的扰动速度。从浅水系统的质量和动量守恒控制律出发，\n$$\n\\frac{\\partial \\eta}{\\partial t} + \\frac{\\partial}{\\partial x}\\big((H+\\eta)(U+u)\\big) = 0, \\qquad\n\\frac{\\partial u}{\\partial t} + (U+u)\\frac{\\partial u}{\\partial x} + g\\,\\frac{\\partial \\eta}{\\partial x} = 0,\n$$\n对均匀态 $(\\eta,u)=(0,0)$ 和常数 $(U,H)$ 进行线性化，推导特征波速，并引入无量纲 Froude 数 $\\mathrm{Fr}$，定义为平均流速与小振幅长重力波相速度之比。使用特征分析，确定区分亚临界和超临界状态的临界值 $\\mathrm{Fr}_{c}$，并且对于 $U>0$ 的情况，根据每个边界上的入射特征数量，确定在每种状态下必须在 $x=0$（上游）和 $x=L$（下游）施加多少个标量边界条件。\n\n将你的最终答案以行矩阵 $\\big(\\mathrm{Fr}_{c}, N_{\\text{up}}^{\\text{sub}}, N_{\\text{down}}^{\\text{sub}}, N_{\\text{up}}^{\\text{super}}, N_{\\text{down}}^{\\text{super}}\\big)$ 的形式报告，其中 $N_{\\text{up}}^{\\text{sub}}$ 和 $N_{\\text{down}}^{\\text{sub}}$ 分别是在亚临界状态下在上游和下游边界施加的标量边界条件的数量，而 $N_{\\text{up}}^{\\text{super}}$ 和 $N_{\\text{down}}^{\\text{super}}$ 是在超临界状态下的相应数量。无需四舍五入。最终答案必须是指定的单个行矩阵。",
            "solution": "用户提供了一个关于一维浅水方程的问题陈述，这是一地球物理流体动力学和数值模拟中的核心重要课题。任务是执行一个标准分析，涉及线性化、特征速度以及边界条件的指定。\n\n### 步骤 1：提取已知条件\n-   **系统**：一维、无粘性、无摩擦的浅水系统。\n-   **区域**：$x \\in [0,L]$，上游边界在 $x=0$，下游边界在 $x=L$。\n-   **平均态**：均匀流，速度 $U>0$，平均深度 $H>0$。\n-   **常数**：重力加速度 $g>0$。\n-   **变量**：自由表面位移 $\\eta(x,t)$，扰动速度 $u(x,t)$。\n-   **控制方程**：\n    $$\n    \\frac{\\partial \\eta}{\\partial t} + \\frac{\\partial}{\\partial x}\\big((H+\\eta)(U+u)\\big) = 0\n    $$\n    $$\n    \\frac{\\partial u}{\\partial t} + (U+u)\\frac{\\partial u}{\\partial x} + g\\,\\frac{\\partial \\eta}{\\partial x} = 0\n    $$\n-   **任务**：\n    1.  对状态 $(\\eta,u)=(0,0)$ 对系统进行线性化。\n    2.  推导特征波速。\n    3.  将 Froude 数 $\\mathrm{Fr}$ 定义为平均流速与长重力波相速度之比。\n    4.  确定临界 Froude 数 $\\mathrm{Fr}_{c}$。\n    5.  对于 $U>0$，确定在亚临界和超临界状态下，$x=0$ 和 $x=L$ 处所需的标量边界条件数量。\n-   **最终输出格式**：一个行矩阵 $\\big(\\mathrm{Fr}_{c}, N_{\\text{up}}^{\\text{sub}}, N_{\\text{down}}^{\\text{sub}}, N_{\\text{up}}^{\\text{super}}, N_{\\text{down}}^{\\text{super}}\\big)$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，是流体动力学和偏微分方程数值方法中的一个标准教科书问题。方程是正确的非线性浅水方程。这些任务构成了一个针对双曲型系统的连贯且适定的分析序列。语言客观而精确。提供了所有必要的信息，没有矛盾之处。该问题是有效的。\n\n### 步骤 3：进行求解\n\n**控制方程的线性化**\n\n我们通过假设扰动 $\\eta$ 和 $u$ 分别远小于平均态变量 $H$ 和 $U$ 来对系统进行线性化。这意味着我们忽略小量的乘积，例如 $\\eta u$、$u^2$ 及其导数。\n\n质量守恒方程为：\n$$\n\\frac{\\partial \\eta}{\\partial t} + \\frac{\\partial}{\\partial x}(HU + Hu + U\\eta + u\\eta) = 0\n$$\n平均态 $HU$ 是常数，因此其空间导数为零。项 $u\\eta$ 是两个小量的乘积，在线性化中被忽略。线性化的质量方程变为：\n$$\n\\frac{\\partial \\eta}{\\partial t} + \\frac{\\partial}{\\partial x}(Hu + U\\eta) = 0\n$$\n由于 $U$ 和 $H$ 是常数，这可以简化为：\n$$\n\\frac{\\partial \\eta}{\\partial t} + U\\frac{\\partial \\eta}{\\partial x} + H\\frac{\\partial u}{\\partial x} = 0\n$$\n\n动量守恒方程为：\n$$\n\\frac{\\partial u}{\\partial t} + U\\frac{\\partial u}{\\partial x} + u\\frac{\\partial u}{\\partial x} + g\\,\\frac{\\partial \\eta}{\\partial x} = 0\n$$\n项 $u\\frac{\\partial u}{\\partial x}$ 是非线性的（扰动的二次项），因此被忽略。线性化的动量方程为：\n$$\n\\frac{\\partial u}{\\partial t} + U\\frac{\\partial u}{\\partial x} + g\\,\\frac{\\partial \\eta}{\\partial x} = 0\n$$\n\n线性化的方程组为：\n$$\n\\frac{\\partial \\eta}{\\partial t} + U\\frac{\\partial \\eta}{\\partial x} + H\\frac{\\partial u}{\\partial x} = 0\n$$\n$$\n\\frac{\\partial u}{\\partial t} + g\\frac{\\partial \\eta}{\\partial x} + U\\frac{\\partial u}{\\partial x} = 0\n$$\n\n**特征分析**\n\n为了找到特征波速，我们将线性化系统写成矩阵形式 $\\frac{\\partial \\mathbf{q}}{\\partial t} + \\mathbf{A} \\frac{\\partial \\mathbf{q}}{\\partial x} = \\mathbf{0}$，其中 $\\mathbf{q} = \\begin{pmatrix} \\eta \\\\ u \\end{pmatrix}$。\n$$\n\\frac{\\partial}{\\partial t}\\begin{pmatrix} \\eta \\\\ u \\end{pmatrix} + \\begin{pmatrix} U  H \\\\ g  U \\end{pmatrix} \\frac{\\partial}{\\partial x}\\begin{pmatrix} \\eta \\\\ u \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n矩阵 $\\mathbf{A}$ 是 $\\begin{pmatrix} U  H \\\\ g  U \\end{pmatrix}$。特征速度，用 $\\lambda$ 表示，是 $\\mathbf{A}$ 的特征值。我们通过求解特征方程 $\\det(\\mathbf{A} - \\lambda\\mathbf{I}) = 0$ 来找到它们。\n$$\n\\det\\begin{pmatrix} U-\\lambda  H \\\\ g  U-\\lambda \\end{pmatrix} = (U-\\lambda)^2 - gH = 0\n$$\n求解 $\\lambda$：\n$$\nU - \\lambda = \\pm\\sqrt{gH}\n$$\n$$\n\\lambda = U \\pm \\sqrt{gH}\n$$\n两个特征波速是 $\\lambda_1 = U + \\sqrt{gH}$ 和 $\\lambda_2 = U - \\sqrt{gH}$。\n\n**Froude 数和临界值**\n\n问题将 Froude 数 $\\mathrm{Fr}$ 定义为平均流速 $U$ 与小振幅长重力波相速度之比。在静止流体 ($U=0$) 中，这些波的相速度为 $c_0 = \\sqrt{gH}$。\n因此，Froude 数为：\n$$\n\\mathrm{Fr} = \\frac{U}{c_0} = \\frac{U}{\\sqrt{gH}}\n$$\n流态（亚临界 vs. 超临界）由特征速度的符号决定。由于 $U > 0$ 和 $\\sqrt{gH} > 0$，速度 $\\lambda_1 = U + \\sqrt{gH}$ 始终为正。$\\lambda_2 = U - \\sqrt{gH}$ 的符号决定了流态。\n转变发生在 $\\lambda_2 = 0$ 时，即 $U = \\sqrt{gH}$。用 Froude 数表示，此条件为 $\\frac{U}{\\sqrt{gH}} = 1$，或 $\\mathrm{Fr} = 1$。\n这个临界值 $\\mathrm{Fr}_{c}$ 分隔了亚临界和超临界状态。\n$$\n\\mathrm{Fr}_{c} = 1\n$$\n-   **亚临界流**：$U  \\sqrt{gH} \\implies \\mathrm{Fr}  1$。在这种情况下，$\\lambda_2  0$。\n-   **超临界流**：$U > \\sqrt{gH} \\implies \\mathrm{Fr} > 1$。在这种情况下，$\\lambda_2 > 0$。\n\n**边界条件**\n\n在一个边界上所需的标量边界条件的数量等于在该边界传入计算域的特征波的数量。\n-   在上游边界（$x=0$），入射特征具有正速度（$\\lambda > 0$）。\n-   在下游边界（$x=L$），入射特征具有负速度（$\\lambda  0$）。\n\n1.  **亚临界状态 ($\\mathrm{Fr}  1$)**\n    -   此时，$U  \\sqrt{gH}$。\n    -   $\\lambda_1 = U + \\sqrt{gH} > 0$。此特征在 $x=0$ 处是入射的。\n    -   $\\lambda_2 = U - \\sqrt{gH}  0$。此特征在 $x=L$ 处是入射的。\n    -   上游（$x=0$）的条件数：$N_{\\text{up}}^{\\text{sub}} = 1$。\n    -   下游（$x=L$）的条件数：$N_{\\text{down}}^{\\text{sub}} = 1$。\n\n2.  **超临界状态 ($\\mathrm{Fr} > 1$)**\n    -   此时，$U > \\sqrt{gH}$。\n    -   $\\lambda_1 = U + \\sqrt{gH} > 0$。此特征在 $x=0$ 处是入射的。\n    -   $\\lambda_2 = U - \\sqrt{gH} > 0$。此特征在 $x=0$ 处也是入射的。\n    -   上游（$x=0$）的条件数：$N_{\\text{up}}^{\\text{super}} = 2$。\n    -   下游（$x=L$）的条件数：如果一个特征的速度为负，则它是入射的。由于 $\\lambda_1$ 和 $\\lambda_2$ 均为正，因此在 $x=L$ 处没有入射特征。$N_{\\text{down}}^{\\text{super}} = 0$。\n\n**最终答案组合**\n\n问题要求行矩阵 $\\big(\\mathrm{Fr}_{c}, N_{\\text{up}}^{\\text{sub}}, N_{\\text{down}}^{\\text{sub}}, N_{\\text{up}}^{\\text{super}}, N_{\\text{down}}^{\\text{super}}\\big)$。\n-   $\\mathrm{Fr}_{c} = 1$\n-   $N_{\\text{up}}^{\\text{sub}} = 1$\n-   $N_{\\text{down}}^{\\text{sub}} = 1$\n-   $N_{\\text{up}}^{\\text{super}} = 2$\n-   $N_{\\text{down}}^{\\text{super}} = 0$\n\n最终结果是这五个数字的有序集合。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  1  1  2  0\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在为浅水方程等双曲守恒律开发数值解时，确保数值格式的稳定性是首要任务。不稳定的格式会产生无界的、非物理的解，使模拟毫无用处。冯·诺依曼稳定性分析是一种基础工具，用于通过研究单个傅里叶模式随时间的放大情况来确定线性、常系数偏微分方程的离散化格式的稳定性。本练习  将指导你对线性平流方程的一阶迎风格式进行此分析，推导出著名的 Courant-Friedrichs-Lewy (CFL) 条件，这是计算流体动力学中一个基本且普遍的约束。",
            "id": "4103368",
            "problem": "考虑浅水方程中自由面高度的一维输运，该过程在空间均匀的稳态速度下，可由连续性方程导出并建模为线性平流。从浅水层的质量守恒出发，连续性方程为 $$\\frac{\\partial h}{\\partial t} + \\frac{\\partial (h u)}{\\partial x} = 0,$$ 其中 $h$ 是水层厚度，$u$ 是水平速度。在一个具有给定空间均匀平均速度 $U$ 且 $h$ 的小扰动被动输运的情况下，该方程简化为周期性域上的线性平流方程 $$\\frac{\\partial h}{\\partial t} + U \\frac{\\partial h}{\\partial x} = 0,$$。在均匀网格 $x_j = j\\,\\Delta x$ 上，使用显式向前欧拉时间步进 $t^n = n\\,\\Delta t$ 和与 $U$ 符号一致的一阶迎风空间离散格式来离散化该方程。即，对于 $U>0$，使用 $$h^{n+1}_j = h^n_j - C\\left(h^n_j - h^n_{j-1}\\right),$$ 对于 $U0$，使用 $$h^{n+1}_j = h^n_j - C\\left(h^n_{j+1} - h^n_j\\right),$$ 其中 $C = \\frac{U\\,\\Delta t}{\\Delta x}$ 是库朗数。假设周期性边界条件，并进行 von Neumann 分析（傅里叶模态分析），以确定离散勒贝格平方可积（$L^2$）稳定性条件。此条件在此定义为：对于任意初始数据，$h$ 的离散 $L^2$ 范数不随时间增长。\n\n通过计算放大因子并要求其模长对所有波数均小于或等于 $1$ 来推导此稳定性条件。然后，报告在该均匀网格上保证离散 $L^2$ 稳定性的最大允许时间步长，记为 $\\Delta t_{\\max}$。将您的最终答案表示为关于 $\\Delta x$ 和 $|U|$ 的单个闭式符号表达式。不应代入数值。如果之后需要计算数值，请以秒为单位表示时间。本题无需四舍五入。",
            "solution": "本题要求使用 von Neumann 分析，推导线性平流方程一阶迎风离散格式的离散 $L^2$ 稳定性条件。并根据此条件，确定最大允许时间步长 $\\Delta t_{\\max}$。\n\n控制偏微分方程为线性平流方程：\n$$\n\\frac{\\partial h}{\\partial t} + U \\frac{\\partial h}{\\partial x} = 0\n$$\n其中 $h$ 为流体深度，$t$ 为时间，$x$ 为空间坐标，$U$ 为恒定的均匀速度。\n\n该方程在均匀网格 $x_j = j\\,\\Delta x$ 和 $t^n = n\\,\\Delta t$ 上离散化。数值格式为时间向前、空间一阶迎风法。该格式的具体形式取决于速度 $U$ 的符号。库朗数定义为 $C = \\frac{U\\,\\Delta t}{\\Delta x}$。\n\n为进行 von Neumann 稳定性分析，我们考虑在给定时间层 $n$ 的解的单个傅里叶模态：\n$$\nh^n_j = \\hat{h}^n(k) e^{i k x_j} = \\hat{h}^n(k) e^{i k j \\Delta x}\n$$\n其中 $k$ 是波数，$i$ 是虚数单位。数值格式按如下方式在时间上传播此模态：\n$$\nh^{n+1}_j = G(k) h^n_j\n$$\n其中 $G(k)$ 是放大因子，它取决于波数 $k$ 和离散化参数。该格式在 $L^2$ 意义下稳定的充要条件是，对所有可能的波数，放大因子的模长都小于或等于 1：\n$$\n|G(k)| \\le 1 \\quad \\forall k\n$$\n\n我们必须分析 $U$ 符号的两种情况。\n\n情况 1：$U > 0$\n对于正速度，迎风方向为从 $j-1$ 到 $j$。离散格式由下式给出：\n$$\nh^{n+1}_j = h^n_j - C\\left(h^n_j - h^n_{j-1}\\right)\n$$\n在此情况下，由于 $U > 0$，库朗数 $C = \\frac{U\\,\\Delta t}{\\Delta x}$ 也为正。\n将傅里叶模态代入格式中，得到：\n$$\nG(k) \\hat{h}^n(k) e^{i k j \\Delta x} = \\hat{h}^n(k) e^{i k j \\Delta x} - C \\left( \\hat{h}^n(k) e^{i k j \\Delta x} - \\hat{h}^n(k) e^{i k (j-1) \\Delta x} \\right)\n$$\n除以 $\\hat{h}^n(k) e^{i k j \\Delta x}$（非零），得到放大因子：\n$$\nG(k) = 1 - C \\left( 1 - e^{-i k \\Delta x} \\right)\n$$\n令 $\\theta = k \\Delta x$ 为无量纲波数。则：\n$$\nG(\\theta) = 1 - C(1 - e^{-i\\theta}) = 1 - C(1 - (\\cos\\theta - i\\sin\\theta))\n$$\n$$\nG(\\theta) = (1 - C + C\\cos\\theta) + i(C\\sin\\theta)\n$$\n放大因子的模长平方为：\n$$\n|G(\\theta)|^2 = (1 - C + C\\cos\\theta)^2 + (C\\sin\\theta)^2\n$$\n$$\n|G(\\theta)|^2 = (1-C)^2 + 2C(1-C)\\cos\\theta + C^2\\cos^2\\theta + C^2\\sin^2\\theta\n$$\n$$\n|G(\\theta)|^2 = 1 - 2C + C^2 + 2C(1-C)\\cos\\theta + C^2 = 1 - 2C + 2C^2 + 2C(1-C)\\cos\\theta\n$$\n$$\n|G(\\theta)|^2 = 1 - 2C(1-C) + 2C(1-C)\\cos\\theta = 1 - 2C(1-C)(1-\\cos\\theta)\n$$\n稳定性条件 $|G(\\theta)|^2 \\le 1$ 要求：\n$$\n-2C(1-C)(1-\\cos\\theta) \\le 0\n$$\n由于对所有实数 $\\theta$，$1 - \\cos\\theta \\ge 0$，该不等式简化为：\n$$\nC(1-C) \\ge 0\n$$\n由于 $U>0$，我们有 $C > 0$。因此，为使乘积为非负，必须有 $1-C \\ge 0$，这意味着 $C \\le 1$。对于 $U>0$ 的稳定性条件是 $0  C \\le 1$。\n\n情况 2：$U  0$\n对于负速度，迎风方向为从 $j+1$ 到 $j$。离散格式由下式给出：\n$$\nh^{n+1}_j = h^n_j - C\\left(h^n_{j+1} - h^n_j\\right)\n$$\n在此情况下，由于 $U  0$，库朗数 $C = \\frac{U\\,\\Delta t}{\\Delta x}$ 为负。\n将傅里叶模态代入格式中，得到：\n$$\nG(k) \\hat{h}^n(k) e^{i k j \\Delta x} = \\hat{h}^n(k) e^{i k j \\Delta x} - C \\left( \\hat{h}^n(k) e^{i k (j+1) \\Delta x} - \\hat{h}^n(k) e^{i k j \\Delta x} \\right)\n$$\n除以 $\\hat{h}^n(k) e^{i k j \\Delta x}$ 得到放大因子：\n$$\nG(k) = 1 - C \\left( e^{i k \\Delta x} - 1 \\right)\n$$\n再次令 $\\theta = k \\Delta x$：\n$$\nG(\\theta) = 1 - C(e^{i\\theta} - 1) = 1 - C((\\cos\\theta - 1) + i\\sin\\theta)\n$$\n$$\nG(\\theta) = (1 - C(\\cos\\theta - 1)) - i(C\\sin\\theta)\n$$\n放大因子的模长平方为：\n$$\n|G(\\theta)|^2 = (1 + C - C\\cos\\theta)^2 + (-C\\sin\\theta)^2\n$$\n$$\n|G(\\theta)|^2 = (1+C)^2 - 2C(1+C)\\cos\\theta + C^2\\cos^2\\theta + C^2\\sin^2\\theta\n$$\n$$\n|G(\\theta)|^2 = 1 + 2C + C^2 - 2C(1+C)\\cos\\theta + C^2 = 1 + 2C + 2C^2 - 2C(1+C)\\cos\\theta\n$$\n$$\n|G(\\theta)|^2 = 1 + 2C(1+C) - 2C(1+C)\\cos\\theta = 1 + 2C(1+C)(1-\\cos\\theta)\n$$\n稳定性条件 $|G(\\theta)|^2 \\le 1$ 要求：\n$$\n2C(1+C)(1-\\cos\\theta) \\le 0\n$$\n由于 $1 - \\cos\\theta \\ge 0$，该不等式简化为：\n$$\nC(1+C) \\le 0\n$$\n由于 $U  0$，我们有 $C  0$。因此，为使乘积为非正，必须有 $1+C \\ge 0$，这意味着 $C \\ge -1$。对于 $U  0$ 的稳定性条件是 $-1 \\le C  0$。\n\n综合两种情况：\n- 对于 $U > 0$，我们有 $0  C \\le 1$，即 $0  \\frac{U \\Delta t}{\\Delta x} \\le 1$。由于 $U = |U|$，这等同于 $\\frac{|U| \\Delta t}{\\Delta x} \\le 1$。\n- 对于 $U  0$，我们有 $-1 \\le C  0$，即 $-1 \\le \\frac{U \\Delta t}{\\Delta x}  0$。由于 $U = -|U|$，这等同于 $-1 \\le \\frac{-|U| \\Delta t}{\\Delta x}  0$。各项乘以 $-1$ 会反转不等号，得到 $1 \\ge \\frac{|U| \\Delta t}{\\Delta x} > 0$。\n\n两种情况都导出了相同的稳定性判据，即该格式的 Courant-Friedrichs-Lewy (CFL) 条件：\n$$\n\\frac{|U| \\Delta t}{\\Delta x} \\le 1\n$$\n此条件保证了数值解的 $L^2$ 范数不随时间增长。\n\n为求得最大允许时间步长 $\\Delta t_{\\max}$，我们取稳定性条件中的等号：\n$$\n\\frac{|U| \\Delta t_{\\max}}{\\Delta x} = 1\n$$\n解出 $\\Delta t_{\\max}$ 可得：\n$$\n\\Delta t_{\\max} = \\frac{\\Delta x}{|U|}\n$$\n此表达式假设 $U \\neq 0$，这在平流问题的上下文中是隐含的。",
            "answer": "$$\n\\boxed{\\frac{\\Delta x}{|U|}}\n$$"
        }
    ]
}