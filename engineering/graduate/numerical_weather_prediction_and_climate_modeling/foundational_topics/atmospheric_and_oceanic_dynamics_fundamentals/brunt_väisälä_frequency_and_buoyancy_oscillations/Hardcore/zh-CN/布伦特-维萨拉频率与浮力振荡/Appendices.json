{
    "hands_on_practices": [
        {
            "introduction": "掌握一个新概念的最佳方式之一就是通过计算来加深理解。本练习将引导你从第一性原理出发，推导一个在稳定大气中垂直位移的空气块的运动方程，从而揭示布伦特-维萨拉频率 $N$ 作为浮力振荡角频率的物理本质。通过计算一个理想化场景下的振荡周期和最大速度，你将能够巩固对 $N$ 的核心物理意义的理解 ()。",
            "id": "4019099",
            "problem": "一个中性浮力的仪器化气球被用作拉格朗日示踪剂，在一个稳定分层的大气层中进行观测。该大气层由一个在布辛涅斯克近似下的数值天气预报（NWP）模型的一维垂直气柱表示。基态是静力平衡且水平均匀的，具有单调递增的基态位温廓线。考虑气球相对于其平衡位置的小振幅、绝热垂直运动，并忽略粘性和辐射效应。\n\n从拉格朗日气块的垂直动量方程和连接扰动位温与垂直位移的绝热热力学关系出发，推导气块垂直位移随时间变化的控制常微分方程，并用基态量表示所得振荡的角频率。已知该分层由布伦特-维萨拉频率（BVF）$N$ 表征，其值为 $N = 0.01\\,\\mathrm{s^{-1}}$。气球初始时从其平衡位置向上位移一个振幅 $A = 100\\,\\mathrm{m}$，然后从静止释放进行自由振荡。\n\n计算振荡周期，并估算在自由振荡期间达到的最大垂直速度。周期以 $\\mathrm{s}$ 为单位，最大垂直速度以 $\\mathrm{m\\,s^{-1}}$ 为单位表示。将你的两个答案四舍五入到四位有效数字。",
            "solution": "问题陈述已经过验证，被认为是有效的。它在科学上基于大气流体动力学原理，问题设定良好，具有充分的初始条件，并且陈述客观。我们可以进行求解。\n\n该问题要求推导在稳定分层大气中垂直位移气块的控制方程，并计算其振荡周期和最大速度。\n\n设 $z'$ 为中性浮力气球距其平衡高度 $z_0$ 的垂直位移。气球作为拉格朗日气块的垂直运动由垂直动量方程控制。在布辛涅斯克近似下，气块的垂直加速度由浮力驱动，该浮力源于气块与其周围环境之间的密度差。对于小垂直位移 $z'$，运动方程为：\n$$\n\\frac{d^2 z'}{dt^2} = a_z = g \\frac{\\rho_e - \\rho_p}{\\rho_0}\n$$\n其中 $a_z$ 是垂直加速度，$g$ 是重力加速度，$\\rho_p$ 是气块的密度，$\\rho_e$ 是气块所在高度处环境的密度，$\\rho_0$ 是一个常数参考密度。项 $\\rho_e - \\rho_p$ 表示密度异常。\n\n使用位温 $\\theta$ 更为方便，它在绝热过程中是守恒的。布辛涅斯克状态方程将密度扰动与位温扰动联系起来：\n$$\n\\frac{\\rho'}{\\rho_0} = -\\frac{\\theta'}{\\theta_0}\n$$\n这里，扰动 $\\rho' = \\rho_p - \\rho_e$ 是气块相对于环境的密度，而 $\\theta' = \\theta_p - \\theta_e$ 是气块相对于环境的位温。将 $\\rho_p - \\rho_e$ 代入加速度方程：\n$$\n\\frac{d^2 z'}{dt^2} = g \\frac{-(\\rho_p - \\rho_e)}{\\rho_0} = -g \\frac{\\rho'}{\\rho_0}\n$$\n使用热力学关系，这变为：\n$$\n\\frac{d^2 z'}{dt^2} = -g \\left(-\\frac{\\theta'}{\\theta_0}\\right) = \\frac{g}{\\theta_0} \\theta'\n$$\n其中 $\\theta_0$ 是一个参考位温。\n\n接下来，我们将位温扰动 $\\theta'$ 与垂直位移 $z'$ 联系起来。气球的运动是绝热的，因此其位温 $\\theta_p$ 是守恒的。气球从平衡高度 $z_0$ 开始运动，所以其位温等于该高度的环境位温 $\\bar{\\theta}(z_0)$。因此，$\\theta_p = \\bar{\\theta}(z_0)$。\n\n当气球被位移到一个新高度 $z_0 + z'$ 时，其位温保持为 $\\bar{\\theta}(z_0)$。这个新高度的环境位温是 $\\bar{\\theta}(z_0 + z')$。位温扰动是气块与环境在该新高度的位温之差：\n$$\n\\theta' = \\theta_p - \\bar{\\theta}(z_0 + z') = \\bar{\\theta}(z_0) - \\bar{\\theta}(z_0 + z')\n$$\n对于小位移 $z'$，我们可以对环境位温廓线 $\\bar{\\theta}(z)$ 在 $z_0$ 附近使用一阶泰勒级数展开：\n$$\n\\bar{\\theta}(z_0 + z') \\approx \\bar{\\theta}(z_0) + z' \\frac{d\\bar{\\theta}}{dz}\\bigg|_{z_0}\n$$\n将此代入 $\\theta'$ 的表达式中：\n$$\n\\theta' \\approx \\bar{\\theta}(z_0) - \\left(\\bar{\\theta}(z_0) + z' \\frac{d\\bar{\\theta}}{dz}\\bigg|_{z_0}\\right) = -z' \\frac{d\\bar{\\theta}}{dz}\n$$\n现在，我们将这个 $\\theta'$ 的表达式代回运动方程中：\n$$\n\\frac{d^2 z'}{dt^2} = \\frac{g}{\\theta_0} \\left(-z' \\frac{d\\bar{\\theta}}{dz}\\right) = -\\left(\\frac{g}{\\theta_0} \\frac{d\\bar{\\theta}}{dz}\\right) z'\n$$\n这是气块垂直位移的控制常微分方程。它是一个简谐振子的方程。我们可以将其重新排列为：\n$$\n\\frac{d^2 z'}{dt^2} + \\left(\\frac{g}{\\theta_0} \\frac{d\\bar{\\theta}}{dz}\\right) z' = 0\n$$\n括号中的项是振荡角频率的平方。这个量被定义为布伦特-维萨拉频率 $N$ 的平方：\n$$\nN^2 \\equiv \\frac{g}{\\theta_0} \\frac{d\\bar{\\theta}}{dz}\n$$\n由于问题陈述大气是稳定分层的，位温随高度增加，所以 $\\frac{d\\bar{\\theta}}{dz} > 0$，这保证了 $N^2 > 0$ 且 $N$ 是一个实频率，从而导致稳定的振荡。\n因此，控制常微分方程为：\n$$\n\\frac{d^2 z'}{dt^2} + N^2 z' = 0\n$$\n振荡的角频率是 $N$，即布伦特-维萨拉频率。\n\n该常微分方程的通解是 $z'(t) = C_1 \\cos(Nt) + C_2 \\sin(Nt)$，其中 $C_1$ 和 $C_2$ 是由初始条件决定的常数。\n给定的初始条件是：\n1. 初始位移：$z'(0) = A = 100\\,\\mathrm{m}$。\n2. 从静止释放：初始垂直速度为 $v'(0) = \\frac{dz'}{dt}\\bigg|_{t=0} = 0$。\n\n将第一个条件应用于通解：\n$z'(0) = C_1 \\cos(0) + C_2 \\sin(0) = C_1 = A$。所以，$C_1 = 100\\,\\mathrm{m}$。\n\n垂直速度是位移的时间导数：\n$v'(t) = \\frac{dz'}{dt} = -C_1 N \\sin(Nt) + C_2 N \\cos(Nt)$。\n应用第二个条件：\n$v'(0) = -A N \\sin(0) + C_2 N \\cos(0) = C_2 N = 0$。\n因为 $N \\neq 0$，所以 $C_2 = 0$。\n\n气球垂直位移的特解是：\n$$\nz'(t) = A \\cos(Nt)\n$$\n其垂直速度为：\n$$\nv'(t) = -A N \\sin(Nt)\n$$\n\n我们现在可以计算所需的值。给定 $N = 0.01\\,\\mathrm{s^{-1}}$ 和 $A = 100\\,\\mathrm{m}$。\n\n首先，我们计算振荡周期 $T$。周期与角频率 $N$ 之间的关系是 $T = \\frac{2\\pi}{N}$。\n$$\nT = \\frac{2\\pi}{0.01\\,\\mathrm{s^{-1}}} = 200\\pi\\,\\mathrm{s}\n$$\n数值上，使用 $\\pi \\approx 3.14159265$：\n$$\nT \\approx 200 \\times 3.14159265\\,\\mathrm{s} \\approx 628.3185\\,\\mathrm{s}\n$$\n四舍五入到四位有效数字，周期为 $T = 628.3\\,\\mathrm{s}$。\n\n其次，我们计算最大垂直速度 $v_{max}$。速度由 $v'(t) = -A N \\sin(Nt)$ 给出。速度的大小为 $|v'(t)| = | -A N \\sin(Nt) | = A N |\\sin(Nt)|$。$|\\sin(Nt)|$ 的最大值为 $1$。因此，最大垂直速度为：\n$$\nv_{max} = A N\n$$\n代入给定值：\n$$\nv_{max} = (100\\,\\mathrm{m}) \\times (0.01\\,\\mathrm{s^{-1}}) = 1\\,\\mathrm{m\\,s^{-1}}\n$$\n表示为四位有效数字，我们得到 $v_{max} = 1.000\\,\\mathrm{m\\,s^{-1}}$。\n\n振荡周期是 $628.3\\,\\mathrm{s}$，最大垂直速度是 $1.000\\,\\mathrm{m\\,s^{-1}}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 628.3  1.000 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "真实大气并非干燥的，水汽的存在会显著影响空气密度，从而改变大气的稳定性。本练习要求你通过编程实践，比较在忽略和考虑水汽影响（即分别使用位温 $\\theta$ 和虚位温 $\\theta_v$）时，静态稳定性的计算结果有何不同。通过处理真实的探空数据廓线，你将亲身体会到在数值天气预报和气候模型中，精确处理湿度对稳定性分析的极端重要性 ()。",
            "id": "4019084",
            "problem": "考虑一个由垂直探空观测到的静力平衡、水平均匀的大气柱，该数据旨在用于数值天气预报 (NWP) 和气候模拟。探空数据提供了离散层次的气压、温度和比湿。您的任务是推导、实现并比较两种静力稳定度的度量方法：一种基于干位温，另一种基于虚位温。基于这些，推断并对比一个湿热带探空和一个忽略湿度的干计算的整层平均布伦特-维萨拉频率。\n\n出发点和允许的基础原理：\n- 静力平衡：$\\,\\dfrac{\\partial p}{\\partial z} = -\\rho g\\,$，其中 $\\,p\\,$ 是气压，$\\,z\\,$ 是高度，$\\,\\rho\\,$ 是密度，$\\,g\\,$ 是重力加速度。\n- 通过虚温表示的湿空气混合物的理想气体定律：$\\,p = \\rho R_d T_v\\,$，其中 $\\,R_d\\,$ 是干空气的比气体常数，$\\,T_v\\,$ 是虚温，其定义使得该混合物遵循干空气气体常数。\n- 用于非饱和绝热位移的位温：$\\,\\theta\\,$ 由 $\\,T = \\theta \\left(\\dfrac{p}{p_0}\\right)^{\\kappa}\\,$ 定义，其中 $\\,\\kappa = \\dfrac{R_d}{c_{p,d}}\\,$，$\\,T\\,$ 是温度，$\\,p\\,$ 是气压，$\\,p_0\\,$ 是参考气压，$\\,c_{p,d}\\,$ 是干空气的定压比热。\n- 虚位温 $\\,\\theta_v\\,$ 使用 $\\,T_v\\,$ 进行类似定义。\n\n您必须：\n1. 从静力学定律和理想气体定律出发，使用以层平均虚温表示的测高关系，推导两个相邻气压层之间的层厚。使用此关系计算每对相邻探空层次之间的几何高度差 $\\,\\Delta z\\,$。\n2. 从稳定层结大气中微小绝热垂直位移的浮力定义出发，推导以位温垂直梯度表示的布伦特-维萨拉频率表达式。分别对干位温 $\\,\\theta\\,$ 和虚位温 $\\,\\theta_v\\,$ 进行此推导，得到分层表达式，并使用关于 $\\,\\Delta z\\,$ 的有限差分进行数值实现。\n3. 对于每种方法（干方法与虚方法），定义一个代表性的“整层平均浮力频率” $\\,N_{\\text{col}}\\,$（单位为 $\\mathrm{s}^{-1}$），其值为探空所有分层中各层 $\\,N^2\\,$ 的垂直厚度加权平均值的平方根。如果 $\\,N^2\\,$ 的厚度加权平均值为负，则报告 $\\,N_{\\text{col}} = 0\\,$ 以避免出现非实数值。\n4. 对每个测试用例，计算并报告差值 $\\,\\Delta N = N_{\\text{col,virtual}} - N_{\\text{col,dry}}\\,$（单位为 $\\mathrm{s}^{-1}$）。\n\n虚温和湿度说明：\n- 通过转换为混合比 $\\,r = \\dfrac{q}{1-q}\\,$，并使用 $\\,T_v = T \\,\\dfrac{1 + r/\\epsilon}{1 + r}\\,$（其中 $\\,\\epsilon = \\dfrac{R_d}{R_v}\\,$，$\\,R_v\\,$ 是水汽的比气体常数），精确地用比湿 $\\,q\\,$ 表示虚温 $\\,T_v\\,$。假设不存在液态水或冰（非饱和条件），因此可以忽略凝结水项。\n\n数值实现要求：\n- 使用国际单位制 (SI)：$\\,p\\,$ 单位为 $\\mathrm{Pa}$，$\\,T\\,$ 和 $\\,T_v\\,$ 单位为 $\\mathrm{K}$，$\\,q\\,$ 单位为 $\\mathrm{kg/kg}$，$\\,z\\,$ 单位为 $\\mathrm{m}$，$\\,N\\,$ 单位为 $\\mathrm{s}^{-1}$。\n- 常数：$\\,g = 9.80665\\,\\mathrm{m\\,s^{-2}}\\,$, $\\,R_d = 287.05\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}\\,$, $\\,R_v = 461.5\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}\\,$, $\\,c_{p,d} = 1004\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}\\,$, $\\,p_0 = 10^5\\,\\mathrm{Pa}\\,$, 以及 $\\,\\kappa = \\dfrac{R_d}{c_{p,d}}\\,$。\n- 离散层：对于相邻层次 $\\,i\\,$ 和 $\\,i+1\\,$，使用层平均 $\\,T_v\\,$ 近似计算测高厚度，并计算在 $\\,\\Delta z\\,$ 上的 $\\,\\theta\\,$ 和 $\\,\\theta_v\\,$ 的有限差分。在各自的稳定性尺度计算中使用层平均的 $\\,\\theta\\,$ 和 $\\,\\theta_v\\,$。\n\n测试套件：\n为以下三个探空数据提供计算，每个探空由气压 $\\,p\\,$、温度 $\\,T\\,$ 和比湿 $\\,q\\,$ 的数组定义：\n- 用例 A（湿热带低层）：\n  - $\\,p = [100000,\\,95000,\\,90000,\\,85000]\\,\\mathrm{Pa}\\,$\n  - $\\,T = [300.0,\\,296.0,\\,292.5,\\,289.0]\\,\\mathrm{K}\\,$\n  - $\\,q = [0.0180,\\,0.0160,\\,0.0120,\\,0.0090]\\,\\mathrm{kg/kg}\\,$\n- 用例 B（干中纬度对流层低层）：\n  - $\\,p = [100000,\\,90000,\\,80000,\\,70000]\\,\\mathrm{Pa}\\,$\n  - $\\,T = [288.0,\\,281.0,\\,274.0,\\,267.0]\\,\\mathrm{K}\\,$\n  - $\\,q = [0.0020,\\,0.0015,\\,0.0010,\\,0.0008]\\,\\mathrm{kg/kg}\\,$\n- 用例 C（带湿度梯度的干中性基线）：\n  - $\\,p = [100000,\\,95000,\\,90000]\\,\\mathrm{Pa}\\,$\n  - $\\,T = [300.0,\\,295.65,\\,291.00]\\,\\mathrm{K}\\,$\n  - $\\,q = [0.0100,\\,0.0080,\\,0.0060]\\,\\mathrm{kg/kg}\\,$\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表。每个测试用例对应一个子列表。每个子列表必须包含三个单位为 $\\mathrm{s}^{-1}$ 的浮点数：$[N_{\\text{col,dry}}, N_{\\text{col,virtual}}, \\Delta N]$。所有浮点数必须四舍五入到六位小数。例如：$[[0.010000,0.011000,0.001000],[...],[...]]$。",
            "solution": "用户提供了一个有科学依据、良定且客观的问题。它根植于大气热力学和流体动力学的基本原理，特别是关于静力稳定度的原理。该问题为推导和计算唯一解提供了所有必需的方程、常数和数据。所指定的方法，包括从第一性原理进行推导，以及使用测高方程和有限差分等标准技术进行数值实现，是气象学和地球物理学中的标准做法。测试用例在物理上是现实的，旨在阐明关键的物理概念：湿度对大气稳定度的影响。因此，该问题是有效的。\n\n解题过程按要求分四个阶段进行：\n1.  推导层厚的测高方程。\n2.  从浮力原​​理推导布伦特-维萨拉频率。\n3.  定义整层平均频率。\n4.  将这些原理应用于所提供的测试用例。\n\n**1. 从测高方程推导层厚**\n\n推导从两个给定的基本原理开始：静力平衡和湿空气的理想气体定律。\n静力平衡方程为：\n$$\n\\frac{\\partial p}{\\partial z} = -\\rho g\n$$\n其中 $p$ 是气压，$z$ 是几何高度，$\\rho$ 是空气密度，$g$ 是重力加速度。\n\n湿空气的理想气体定律使用虚温 $T_v$ 表示：\n$$\np = \\rho R_d T_v\n$$\n其中 $R_d$ 是干空气的比气体常数。\n\n将理想气体定律中的密度表达式 $\\rho = \\frac{p}{R_d T_v}$ 代入静力平衡方程，我们得到：\n$$\n\\frac{\\partial p}{\\partial z} = -\\frac{p g}{R_d T_v}\n$$\n这个方程可以重新排列，以压力的微分变化 $dp$ 来表示高度的微分变化 $dz$：\n$$\ndz = -\\frac{R_d T_v}{g} \\frac{dp}{p}\n$$\n为了求出两个气压层 $p_1$ 和 $p_2$（其中 $p_2  p_1$）之间的厚度 $\\Delta z = z_2 - z_1$，我们对这个表达式进行积分：\n$$\n\\Delta z = \\int_{z_1}^{z_2} dz = -\\frac{R_d}{g} \\int_{p_1}^{p_2} T_v d(\\ln p)\n$$\n对于离散层次间的数值计算，我们通过假设虚温在整个层中是恒定的，等于其平均值 $\\overline{T_v}$，来近似该积分：\n$$\n\\Delta z \\approx -\\frac{R_d}{g} \\overline{T_v} \\int_{p_1}^{p_2} d(\\ln p) = -\\frac{R_d}{g} \\overline{T_v} (\\ln p_2 - \\ln p_1)\n$$\n这简化为层厚的测高方程：\n$$\n\\Delta z = \\frac{R_d \\overline{T_v}}{g} \\ln\\left(\\frac{p_1}{p_2}\\right)\n$$\n对于探空层次 $i$ 和 $i+1$ 之间的一层，我们使用 $\\overline{T_{v,i}} = \\frac{T_{v,i} + T_{v,i+1}}{2}$，层厚为 $\\Delta z_i = \\frac{R_d \\overline{T_v}}{g} \\ln\\left(\\frac{p_i}{p_{i+1}}\\right)$。\n\n**2. 布伦特-维萨拉频率 ($N^2$) 的推导**\n\n布伦特-维萨拉频率 $N$ 量化了一个气块在稳定层结环境中被绝热位移时所经历的垂直振荡频率。它是由作用在位移气块上的浮力推导出来的。\n\n考虑一个处于平衡状态的气块，其在高度 $z$ 处的密度为 $\\rho(z)$，虚温为 $T_v(z)$。如果这个气块在不与周围环境混合的情况下垂直位移一小段距离 $\\delta z$，它的气压将变为与高度 $z+\\delta z$ 处的环境气压 $p(z+\\delta z)$ 相匹配。然而，它的温度和密度将绝热演变。作用在气块上单位质量的净垂直力是浮力：\n$$\nF_b = g \\frac{\\rho_{env}(z+\\delta z) - \\rho_{parcel}(z+\\delta z)}{\\rho_{parcel}(z+\\delta z)}\n$$\n对于微小位移，$\\rho_{parcel} \\approx \\rho_{env}$，因此恢复加速度为：\n$$\n\\frac{d^2(\\delta z)}{dt^2} \\approx g \\frac{\\rho_{env} - \\rho_{parcel}}{\\rho_{env}}\n$$\n使用理想气体定律 $p = \\rho R_d T_v$，我们可以用在共同气压层 $p(z+\\delta z)$ 处的虚温来表示密度。这得出 $\\rho \\propto 1/T_v$。加速度变为：\n$$\n\\frac{d^2(\\delta z)}{dt^2} = g \\frac{T_{v,parcel}(z+\\delta z) - T_{v,env}(z+\\delta z)}{T_{v,env}(z+\\delta z)}\n$$\n对于绝热位移，气块保持其虚位温 $\\theta_v$ 不变。虚位温由 $T_v = \\theta_v \\left(\\frac{p}{p_0}\\right)^{\\kappa}$ 定义，其中 $\\kappa = R_d/c_{p,d}$，$p_0$ 是参考气压。气块在新高度的虚位温与其原始高度的虚位温相同，即 $\\theta_{v,parcel}(z+\\delta z) = \\theta_{v,env}(z)$。因此，其虚温为 $T_{v,parcel}(z+\\delta z) = \\theta_{v,env}(z) \\left(\\frac{p(z+\\delta z)}{p_0}\\right)^{\\kappa}$。\n环境在新高度的虚温为 $T_{v,env}(z+\\delta z) = \\theta_{v,env}(z+\\delta z) \\left(\\frac{p(z+\\delta z)}{p_0}\\right)^{\\kappa}$。\n\n将这些代入加速度方程并消去气压项：\n$$\n\\frac{d^2(\\delta z)}{dt^2} = g \\frac{\\theta_{v,env}(z) - \\theta_{v,env}(z+\\delta z)}{\\theta_{v,env}(z+\\delta z)}\n$$\n使用一阶泰勒级数展开 $\\theta_{v,env}(z+\\delta z) \\approx \\theta_{v,env}(z) + \\frac{d\\theta_{v,env}}{dz}\\delta z$，并近似分母 $\\theta_{v,env}(z+\\delta z) \\approx \\theta_{v,env}(z)$，我们得到：\n$$\n\\frac{d^2(\\delta z)}{dt^2} = - \\left( \\frac{g}{\\theta_{v,env}(z)} \\frac{d\\theta_{v,env}}{dz} \\right) \\delta z\n$$\n这是简谐振子的方程，$\\frac{d^2 x}{dt^2} = -\\omega^2 x$。因此，振荡角频率的平方，即布伦特-维萨拉频率的平方为：\n$$\nN_v^2 = \\frac{g}{\\theta_v} \\frac{d\\theta_v}{dz}\n$$\n这是“虚”或“湿”情况的表达式。“干”情况的推导完全相同，但假设湿度为零，因此 $T_v \\to T$ 且 $\\theta_v \\to \\theta$：\n$$\nN_d^2 = \\frac{g}{\\theta} \\frac{d\\theta}{dz}\n$$\n对于跨越厚度为 $\\Delta z$ 的层的数值实现，我们按规定使用有限差分和层平均量：\n$$\nN_{v,i}^2 = \\frac{g}{\\overline{\\theta_{v,i}}} \\frac{\\theta_{v,i+1} - \\theta_{v,i}}{\\Delta z_i} \\quad \\text{和} \\quad N_{d,i}^2 = \\frac{g}{\\overline{\\theta_{i}}} \\frac{\\theta_{i+1} - \\theta_i}{\\Delta z_i}\n$$\n其中 $\\overline{\\theta_i} = \\frac{\\theta_i + \\theta_{i+1}}{2}$ 且 $\\overline{\\theta_{v,i}} = \\frac{\\theta_{v,i} + \\theta_{v,i+1}}{2}$。\n\n**3. 整层平均浮力频率**\n\n根据规定，整层平均浮力频率 $N_{\\text{col}}$ 是逐层 $N^2$ 值的垂直厚度加权平均值的平方根。\n加权平均值为：\n$$\n\\overline{N^2}_{\\text{col}} = \\frac{\\sum_{i=1}^{M-1} N_i^2 \\Delta z_i}{\\sum_{i=1}^{M-1} \\Delta z_i} = \\frac{\\sum_i N_i^2 \\Delta z_i}{\\Delta z_{total}}\n$$\n其中 $M$ 是探空中的层次数量，求和遍及所有 $M-1$ 个层。\n整层频率则为：\n$$\nN_{\\text{col}} = \\begin{cases} \\sqrt{\\overline{N^2}_{\\text{col}}}  \\text{如果 } \\overline{N^2}_{\\text{col}} \\geq 0 \\\\ 0  \\text{如果 } \\overline{N^2}_{\\text{col}}  0 \\end{cases}\n$$\n此计算分别对干（$N_{\\text{col,dry}}$）和虚（$N_{\\text{col,virtual}}$）情况进行。最终要求的量是差值 $\\Delta N = N_{\\text{col,virtual}} - N_{\\text{col,dry}}$。\n\n**4. 计算流程总结**\n\n对于每个测试用例：\n1.  定义常数：$g=9.80665$, $R_d=287.05$, $R_v=461.5$, $c_{p,d}=1004$, $p_0=10^5$。计算 $\\epsilon = R_d/R_v$ 和 $\\kappa=R_d/c_{p,d}$。\n2.  输入气压 ($p$)、温度 ($T$) 和比湿 ($q$) 的数组。\n3.  在每个垂直层次 $j$：\n    -   计算混合比：$r_j = q_j / (1 - q_j)$。\n    -   计算虚温：$T_{v,j} = T_j (1 + r_j/\\epsilon) / (1 + r_j)$。\n    -   计算位温：$\\theta_j = T_j (p_0 / p_j)^\\kappa$。\n    -   计算虚位温：$\\theta_{v,j} = T_{v,j} (p_0 / p_j)^\\kappa$。\n4.  对于层次 $i$ 和 $i+1$ 之间的每一层 $i$：\n    -   计算层平均虚温 $\\overline{T_{v,i}} = (T_{v,i} + T_{v,i+1})/2$。\n    -   计算层厚 $\\Delta z_i = (R_d/g) \\overline{T_{v,i}} \\ln(p_i/p_{i+1})$。\n    -   计算层平均位温 $\\overline{\\theta_i}$ 和 $\\overline{\\theta_{v,i}}$。\n    -   使用有限差分公式计算逐层的 $N_{d,i}^2$ 和 $N_{v,i}^2$。\n5.  计算厚度加权的整层平均值 $\\overline{N^2}_{\\text{d,col}}$ 和 $\\overline{N^2}_{\\text{v,col}}$。\n6.  使用平方根计算 $N_{\\text{col,dry}}$ 和 $N_{\\text{col,virtual}}$，并应用非负约束。\n7.  计算差值 $\\Delta N = N_{\\text{col,virtual}} - N_{\\text{col,dry}}$。\n\n这个全面的流程能够正确且可复现地计算所需的稳定性度量。\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and contrasts dry and virtual Brunt-Väisälä frequencies for\n    three atmospheric sounding test cases.\n    \"\"\"\n\n    # Define physical and thermodynamic constants in SI units\n    G = 9.80665  # Gravitational acceleration (m/s^2)\n    RD = 287.05    # Specific gas constant for dry air (J/kg/K)\n    RV = 461.5     # Specific gas constant for water vapor (J/kg/K)\n    CPD = 1004.0   # Specific heat of dry air at constant pressure (J/kg/K)\n    P0 = 100000.0  # Reference pressure (Pa)\n    EPSILON = RD / RV  # Ratio of gas constants\n    KAPPA = RD / CPD   # Poisson constant exponent\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A (humid tropical low levels)\n        {\n            \"p\": np.array([100000.0, 95000.0, 90000.0, 85000.0]),  # Pa\n            \"T\": np.array([300.0, 296.0, 292.5, 289.0]),         # K\n            \"q\": np.array([0.0180, 0.0160, 0.0120, 0.0090]),     # kg/kg\n        },\n        # Case B (dry midlatitude lower troposphere)\n        {\n            \"p\": np.array([100000.0, 90000.0, 80000.0, 70000.0]),\n            \"T\": np.array([288.0, 281.0, 274.0, 267.0]),\n            \"q\": np.array([0.0020, 0.0015, 0.0010, 0.0008]),\n        },\n        # Case C (dry-neutral baseline with a humidity gradient)\n        {\n            \"p\": np.array([100000.0, 95000.0, 90000.0]),\n            \"T\": np.array([300.0, 295.65, 291.00]),\n            \"q\": np.array([0.0100, 0.0080, 0.0060]),\n        }\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        p, T, q = case[\"p\"], case[\"T\"], case[\"q\"]\n        \n        # 1. Calculate thermodynamic quantities at each level\n        # Mixing ratio (r)\n        r = q / (1.0 - q)\n        \n        # Virtual temperature (Tv)\n        Tv = T * (1.0 + r / EPSILON) / (1.0 + r)\n        \n        # Potential temperature (theta)\n        theta = T * (P0 / p)**KAPPA\n        \n        # Virtual potential temperature (theta_v)\n        theta_v = Tv * (P0 / p)**KAPPA\n        \n        n_levels = len(p)\n        n_layers = n_levels - 1\n        \n        delta_z_layers = np.zeros(n_layers)\n        N2_d_layers = np.zeros(n_layers)\n        N2_v_layers = np.zeros(n_layers)\n\n        # 2. Iterate through layers to calculate layer-wise properties\n        for i in range(n_layers):\n            # Layer properties (mean and differences)\n            Tv_mean = 0.5 * (Tv[i] + Tv[i+1])\n            theta_mean = 0.5 * (theta[i] + theta[i+1])\n            theta_v_mean = 0.5 * (theta_v[i] + theta_v[i+1])\n            \n            delta_theta = theta[i+1] - theta[i]\n            delta_theta_v = theta_v[i+1] - theta_v[i]\n            \n            # Hypsometric equation for layer thickness\n            delta_z = (RD / G) * Tv_mean * np.log(p[i] / p[i+1])\n            delta_z_layers[i] = delta_z\n            \n            # Layer-wise squared Brunt-Väisälä frequency\n            # Dry calculation\n            N2_d_layers[i] = (G / theta_mean) * (delta_theta / delta_z)\n            # Virtual (moist) calculation\n            N2_v_layers[i] = (G / theta_v_mean) * (delta_theta_v / delta_z)\n\n        # 3. Compute column-mean frequencies\n        delta_z_total = np.sum(delta_z_layers)\n        \n        # Thickness-weighted mean of N^2\n        if delta_z_total > 0:\n            N2_d_col_mean = np.sum(N2_d_layers * delta_z_layers) / delta_z_total\n            N2_v_col_mean = np.sum(N2_v_layers * delta_z_layers) / delta_z_total\n        else:\n            N2_d_col_mean = 0.0\n            N2_v_col_mean = 0.0\n\n        # Column-mean frequency, handling potential negative N^2 (unstable layers)\n        N_col_dry = np.sqrt(max(0.0, N2_d_col_mean))\n        N_col_virtual = np.sqrt(max(0.0, N2_v_col_mean))\n        \n        # 4. Compute the difference\n        delta_N = N_col_virtual - N_col_dry\n        \n        all_results.append([N_col_dry, N_col_virtual, delta_N])\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"[{','.join(f'{x:.6f}' for x in res)}]\" for res in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```",
            "answer": "[[0.011689,0.009088,-0.002602],[0.011739,0.011613,-0.000126],[0.000000,0.000000,0.000000]]"
        },
        {
            "introduction": "大气的稳定性不仅取决于其热力分层，还受到风垂直切变的强烈影响，后者是驱动动态不稳定性的能量来源。本练习将布伦特-维萨拉频率 $N^2$ 置于一个更广阔的动力学框架中，引入了衡量浮力稳定与切变失稳趋势之间竞争的无量纲参数——理查森数 $\\mathrm{Ri}$。通过计算并应用经典的开尔文-亥姆霍兹不稳定性判据，你将学会如何利用稳定性知识来预测诸如波状云等复杂的动力学现象的发生区域 ()。",
            "id": "4019135",
            "problem": "给定您在干Boussinesq近似下几个理想化大气柱的水平风速 $U(z)$ 和位温 $\\theta(z)$ 的垂直廓线。您的任务是从第一性原理出发，推导出一个衡量分层平行流中静力稳定度与垂直切变之间竞争关系的物理量，然后实现一个数值程序，从所提供的离散廓线中计算该量。利用这个物理量和一个经典的切变不稳定性必要条件，识别出易于产生开尔文-亥姆霍兹波的垂直层。您必须使用国际单位制，并以 $\\mathrm{m}$ 为单位报告高度。\n\n推导要求：从干Boussinesq框架下的线性化浮力方程和位温的定义出发，推导浮力（布伦特-维萨拉）频率平方的表达式，该表达式用位温的垂直梯度表示。然后，在一个单向、水平均匀的平行流 $U(z)$ 中，定义一个基于梯度的无量纲度量，用于比较起稳定作用的浮力与起失稳作用的垂直切变。使用无粘切变不稳定性的经典必要条件，根据此无量纲量来建立一个易于产生开尔文-亥姆霍兹波的阈值。不要假设任何快捷公式；您的推导必须从定义和线性动力学出发，您的实现必须遵循推导出的表达式。\n\n数值程序要求：对于每个测试用例，您将获得在均匀垂直层 $z_0, z_1, \\dots, z_N$ 上的数组 $z_i$、$U_i$ 和 $\\theta_i$，层间距为 $\\Delta z = z_{i+1} - z_i$，其中 $z_0 = 0$ 且 $z_N = 1000$。使用相邻层之间的一阶层间差分，在层中点计算所需的梯度。对于 $z_i$ 和 $z_{i+1}$ 之间的每一层：\n- 使用 $U$ 的层间差分除以层厚度来计算垂直切变的大小。\n- 使用 $\\theta$ 的层间差分除以层厚度，并采用层内一个合适的位温Boussinesq参考值来计算静力稳定度。\n- 构建该层中比较稳定度与切变平方的无量纲比。\n如果此无量纲比严格小于经典的无粘阈值 $1/4$，并且切变大小超过一个小的容差 $\\varepsilon_{\\mathrm{shear}}$（以避免除零伪影），则将该层分类为易于产生开尔文-亥姆霍兹波。采用 $\\varepsilon_{\\mathrm{shear}} = 10^{-6}\\ \\mathrm{s^{-1}}$。使用重力加速度 $g = 9.80665\\ \\mathrm{m\\,s^{-2}}$。\n\n单位和角度约定：全程使用 $\\mathrm{m}$、$\\mathrm{s}$ 和 $\\mathrm{K}$。不涉及角度。\n\n输出规格：对于每个测试用例，输出所有被分类为易受影响的层的层中点高度 $z_{i+1/2} = (z_i + z_{i+1})/2$（单位为 $\\mathrm{m}$）的列表。您的程序应生成单行输出，其中包含一个列表，其元素是五个测试用例的结果（每个结果本身也是一个中点列表），列表以逗号分隔，并用方括号括起来，不含空格，例如，“[[50.0,150.0],[...],[]]”。\n\n测试套件：使用以下五个测试用例，每个用例都在相同的均匀网格上定义，$z_i = i \\times 100$，$i \\in \\{0,1,\\dots,10\\}$，因此 $\\Delta z = 100$，$z_0 = 0$，$z_{10} = 1000$。将 $U(z)$ 和 $\\theta(z)$ 定义为线性函数 $U(z) = U_0 + S z$ 和 $\\theta(z) = \\theta_0 + \\Gamma z$，其中 $U_0$ 和 $\\theta_0$ 是常数，$S$ 和 $\\Gamma$ 是指定的垂直梯度。对于所有情况，取 $\\theta_0 = 300\\ \\mathrm{K}$。\n\n- 情况A（近阈值稳定切变流）：$U_0 = 0\\ \\mathrm{m\\,s^{-1}}$，$S = 0.02\\ \\mathrm{s^{-1}}$，$\\Gamma = 0.003\\ \\mathrm{K\\,m^{-1}}$。\n- 情况B（有限切变的弱稳定流）：$U_0 = 0\\ \\mathrm{m\\,s^{-1}}$，$S = 0.02\\ \\mathrm{s^{-1}}$，$\\Gamma = 0.0005\\ \\mathrm{K\\,m^{-1}}$。\n- 情况C（弱切变的强逆温）：$U_0 = 0\\ \\mathrm{m\\,s^{-1}}$，$S = 0.005\\ \\mathrm{s^{-1}}$，$\\Gamma = 0.010\\ \\mathrm{K\\,m^{-1}}$。\n- 情况D（无切变）：$U_0 = 10\\ \\mathrm{m\\,s^{-1}}$，$S = 0.0\\ \\mathrm{s^{-1}}$，$\\Gamma = 0.005\\ \\mathrm{K\\,m^{-1}}$。\n- 情况E（有限切变的不稳定分层）：$U_0 = 0\\ \\mathrm{m\\,s^{-1}}$，$S = 0.01\\ \\mathrm{s^{-1}}$，$\\Gamma = -0.001\\ \\mathrm{K\\,m^{-1}}$。\n\n最终答案类型和格式：最终输出必须是单行，包含一个列表，其元素是情况A到E的五个易受影响层中点（单位为$\\mathrm{m}$）的列表，按顺序排列，不含任何空格。例如，一个有效的输出看起来像这样：“[[50.0,150.0,250.0],[...],[],[],[...]]”。",
            "solution": "该问题要求推导分层流体中切变不稳定性的判据，并将其数值应用于识别理想化大气廓线中的易受影响层。推导将从Boussinesq近似下的基本运动方程出发，数值实现将遵循指定的离散化方案。\n\n### 稳定性判据的推导\n\n#### 1. 浮力与布伦特-维萨拉频率 ($N^2$)\n\n我们从干Boussinesq近似的框架开始。在此框架中，密度变化相对于参考密度被认为是小的，并且仅在动量方程的浮力项中是重要的。作用在流体微团上的浮力加速度 $a_b$ 由 $a_b = g(\\rho_{env} - \\rho_{parcel}) / \\rho_{ref}$ 给出，其中 $\\rho_{env}$ 是环境密度，$\\rho_{parcel}$ 是微团密度，$\\rho_{ref}$ 是一个恒定的参考密度。\n\n在干大气中，对于绝热位移，微团的位温 $\\theta$ 是守恒的。在Boussinesq近似下，状态方程将密度扰动 $\\rho'$ 与围绕参考态 $(\\rho_{ref}, \\theta_{ref})$ 的位温扰动 $\\theta'$ 联系起来，即 $\\rho'/\\rho_{ref} \\approx -\\theta'/\\theta_{ref}$。因此，浮力加速度可以用位温表示：\n$$ a_b = g \\frac{\\theta_{parcel} - \\theta_{env}}{\\theta_{ref}} $$\n现在，考虑一个具有位温廓线 $\\theta(z)$ 的背景大气。一个最初在高度 $z_p$ 处静止的流体微团被垂直位移了一个小量 $\\delta z$。它的位温是守恒的，所以 $\\theta_{parcel} = \\theta(z_p)$。在它的新高度 $z' = z_p + \\delta z$，环境位温为 $\\theta_{env}(z') = \\theta(z_p + \\delta z)$。对于小位移，我们可以对环境廓线进行泰勒展开：\n$$ \\theta_{env}(z') \\approx \\theta(z_p) + \\frac{d\\theta}{dz} \\bigg|_{z_p} \\delta z $$\n在高度 $z'$ 处，作用于该微团的浮力加速度是：\n$$ a_b \\approx g \\frac{\\theta(z_p) - \\left( \\theta(z_p) + \\frac{d\\theta}{dz} \\delta z \\right)}{\\theta_{ref}} = - \\left( \\frac{g}{\\theta_{ref}} \\frac{d\\theta}{dz} \\right) \\delta z $$\n微团位移的垂直运动方程是 $\\frac{d^2(\\delta z)}{dt^2} = a_b$。代入 $a_b$ 的表达式，我们得到一个简谐振子方程：\n$$ \\frac{d^2(\\delta z)}{dt^2} = - \\left( \\frac{g}{\\theta_{ref}} \\frac{d\\theta}{dz} \\right) \\delta z $$\n这个方程描述了浮力振荡。这些振荡的角频率的平方被定义为布伦特-维萨拉（或浮力）频率的平方，$N^2$：\n$$ N^2 \\equiv \\frac{g}{\\theta_{ref}} \\frac{d\\theta}{dz} $$\n$N^2$ 是流体静力稳定度的一个度量。如果 $d\\theta/dz > 0$，则 $N^2 > 0$，一个被位移的微团将在其平衡位置附近振荡，表明是稳定分层。如果 $d\\theta/dz  0$，则 $N^2  0$，恢复力变成了一个放大力，微团会加速离开其初始位置，表明是不稳定分层（对流）。\n\n#### 2. 梯度理查森数 ($Ri$) 与不稳定性判据\n\n在水平速度 $U(z)$ 随高度变化的平行流中，垂直切变 $dU/dz$ 可以成为不稳定性的动能来源。浮力的稳定效应与切变的失稳效应之间的竞争由一个无量纲参数——梯度理查森数 $Ri$ 来量化。它被定义为浮力频率的平方与垂直切变的平方之比：\n$$ Ri = \\frac{N^2}{\\left(\\frac{dU}{dz}\\right)^2} $$\n代入我们推导的 $N^2$ 表达式：\n$$ Ri = \\frac{\\frac{g}{\\theta_{ref}} \\frac{d\\theta}{dz}}{\\left(\\frac{dU}{dz}\\right)^2} $$\n低理查森数表明切变效应主导浮力效应，使得流体易于发生切变不稳定性。迈尔斯-霍华德定理为此提供了严谨的基础：一个无粘、平行、分层的切变流不稳定的一个必要条件是，流场中某处的梯度理查森数必须小于 $1/4$。因此，如果满足以下条件，我们就将一个层分类为易于产生开尔文-亥姆霍兹波：\n$$ Ri  \\frac{1}{4} $$\n问题增加了一个实际约束，以避免在切变为零或可忽略不计时出现数值问题，要求切变大小必须超过一个小的容差 $\\varepsilon_{\\mathrm{shear}}$。\n\n### 数值程序与测试用例分析\n\n所提供的大气廓线是离散的，定义在均匀网格 $z_i = i \\cdot \\Delta z$（$i \\in \\{0, 1, \\dots, 10\\}$）上，其中 $\\Delta z = 100\\ \\mathrm{m}$。我们计算 $z_i$ 和 $z_{i+1}$ 之间每一层的理查森数。\n\n对于每一层 $i$（从 $i=0$ 到 $i=9$），我们执行以下计算：\n1.  **梯度**：垂直梯度使用跨层的一阶有限差分来近似：\n    - 垂直切变：$\\left(\\frac{dU}{dz}\\right)_i = \\frac{U_{i+1} - U_i}{\\Delta z}$\n    - 位温梯度：$\\left(\\frac{d\\theta}{dz}\\right)_i = \\frac{\\theta_{i+1} - \\theta_i}{\\Delta z}$\n2.  **参考温度**：层的参考位温 $\\theta_{ref}$ 取为层平均值：$\\theta_{ref, i} = (\\theta_i + \\theta_{i+1}) / 2$。\n3.  **理查森数**：第 $i$ 层的离散理查森数为：\n    $$ Ri_i = \\frac{\\frac{g}{\\theta_{ref, i}} \\left(\\frac{\\theta_{i+1} - \\theta_i}{\\Delta z}\\right)}{\\left(\\frac{U_{i+1} - U_i}{\\Delta z}\\right)^2} = \\frac{g \\cdot \\Delta z \\cdot (\\theta_{i+1} - \\theta_i)}{(\\frac{\\theta_i + \\theta_{i+1}}{2}) \\cdot (U_{i+1} - U_i)^2} $$\n4.  **不稳定性检查**：如果同时满足以下两个条件，则该层被标记为易受影响：\n    - $Ri_i  0.25$\n    - $\\left|\\frac{U_{i+1} - U_i}{\\Delta z}\\right| > \\varepsilon_{\\mathrm{shear}}$，其中 $\\varepsilon_{\\mathrm{shear}} = 10^{-6}\\ \\mathrm{s^{-1}}$。\n\n对于给定的测试用例，廓线是线性的：$U(z) = U_0 + S z$ 和 $\\theta(z) = \\theta_0 + \\Gamma z$，其中 $\\theta_0 = 300\\ \\mathrm{K}$。这简化了梯度：$dU/dz = S$ 和 $d\\theta/dz = \\Gamma$。数值差分可以精确地恢复这些常数梯度。对于中点为 $z_{i+1/2}$ 的层，理查森数变为：\n$$ Ri_i = \\frac{g \\Gamma}{S^2 \\cdot (\\theta_0 + \\Gamma z_{i+1/2})} $$\n我们使用 $g = 9.80665\\ \\mathrm{m\\,s^{-2}}$。\n\n-   **情况A**：$S = 0.02\\ \\mathrm{s^{-1}}$，$\\Gamma = 0.003\\ \\mathrm{K\\,m^{-1}}$。切变为 $|S| = 0.02 > \\varepsilon_{\\mathrm{shear}}$。\n    $Ri_i = \\frac{9.80665 \\cdot 0.003}{(0.02)^2 (300 + 0.003 z_{i+1/2})} = \\frac{73.549875}{300 + 0.003 z_{i+1/2}}$。对于最低层中点 $z=50\\ \\mathrm{m}$，$Ri \\approx 0.245  0.25$。对于最高层中点 $z=950\\ \\mathrm{m}$，$Ri \\approx 0.243  0.25$。由于 $Ri$ 是 $z$ 的单调递减函数，所有层都满足 $Ri  0.25$。所有10个层都易受影响。\n\n-   **情况B**：$S = 0.02\\ \\mathrm{s^{-1}}$，$\\Gamma = 0.0005\\ \\mathrm{K\\,m^{-1}}$。切变为 $|S| = 0.02 > \\varepsilon_{\\mathrm{shear}}$。\n    $Ri_i = \\frac{9.80665 \\cdot 0.0005}{(0.02)^2 (300 + 0.0005 z_{i+1/2})} = \\frac{12.2583125}{300 + 0.0005 z_{i+1/2}}$。对于定义域中的所有 $z$，分母略大于 $300$，因此 $Ri \\approx 12.26/300 \\approx 0.04$，远低于 $0.25$。所有10个层都易受影响。\n\n-   **情况C**：$S = 0.005\\ \\mathrm{s^{-1}}$，$\\Gamma = 0.010\\ \\mathrm{K\\,m^{-1}}$。切变为 $|S| = 0.005 > \\varepsilon_{\\mathrm{shear}}$。\n    $Ri_i = \\frac{9.80665 \\cdot 0.01}{(0.005)^2 (300 + 0.01 z_{i+1/2})} = \\frac{3922.66}{300 + 0.01 z_{i+1/2}}$。分母总是大于 $300$，因此 $Ri > 3922.66/310 \\approx 12.6$。所有 $Ri_i$ 值都远大于 $0.25$。没有层是易受影响的。\n\n-   **情况D**：$S = 0.0\\ \\mathrm{s^{-1}}$。切变大小为 $0$，不大于 $\\varepsilon_{\\mathrm{shear}}$。无论稳定性如何，都不满足易受影响的条件。没有层是易受影响的。\n\n-   **情况E**：$S = 0.01\\ \\mathrm{s^{-1}}$，$\\Gamma = -0.001\\ \\mathrm{K\\,m^{-1}}$。切变为 $|S| = 0.01 > \\varepsilon_{\\mathrm{shear}}$。\n    位温梯度 $\\Gamma$ 为负，这意味着静力不稳定性（$N^2  0$）。这使得所有层的理查森数 $Ri_i$ 都为负。由于任何负数都严格小于 $0.25$，所有层都满足不稳定性条件 $Ri  0.25$。所有10个层都易受影响。\n```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes layers susceptible to Kelvin-Helmholtz instability for several\n    idealized atmospheric profiles.\n    \"\"\"\n    g = 9.80665  # Gravitational acceleration in m/s^2\n    epsilon_shear = 1e-6  # Shear tolerance in 1/s\n    ri_threshold = 0.25  # Critical Richardson number\n\n    # Test cases: (U0, S, Gamma)\n    # U(z) = U0 + S*z\n    # theta(z) = 300 + Gamma*z\n    test_cases = [\n        # Case A\n        (0.0, 0.02, 0.003),\n        # Case B\n        (0.0, 0.02, 0.0005),\n        # Case C\n        (0.0, 0.005, 0.010),\n        # Case D\n        (10.0, 0.0, 0.005),\n        # Case E\n        (0.0, 0.01, -0.001),\n    ]\n\n    # Grid setup\n    z_min = 0.0\n    z_max = 1000.0\n    num_points = 11\n    z_levels = np.linspace(z_min, z_max, num_points)\n    delta_z = z_levels[1] - z_levels[0]\n    num_layers = len(z_levels) - 1\n\n    all_results = []\n\n    for case in test_cases:\n        U0, S, Gamma = case\n        theta0_profile = 300.0\n\n        # Generate profiles on grid points\n        U_profile = U0 + S * z_levels\n        theta_profile = theta0_profile + Gamma * z_levels\n\n        susceptible_midpoints = []\n        for i in range(num_layers):\n            # Values at layer boundaries\n            U_i = U_profile[i]\n            U_i_plus_1 = U_profile[i+1]\n            theta_i = theta_profile[i]\n            theta_i_plus_1 = theta_profile[i+1]\n            z_i = z_levels[i]\n            z_i_plus_1 = z_levels[i+1]\n            \n            # Compute shear\n            delta_U = U_i_plus_1 - U_i\n            shear = delta_U / delta_z\n            \n            # Check shear magnitude condition\n            if abs(shear) > epsilon_shear:\n                # Compute quantities for Ri\n                delta_theta = theta_i_plus_1 - theta_i\n                theta_ref = (theta_i + theta_i_plus_1) / 2.0\n                \n                # N^2 = (g / theta_ref) * (dtheta/dz)\n                N_squared = (g / theta_ref) * (delta_theta / delta_z)\n                \n                # Ri = N^2 / (dU/dz)^2\n                richardson_number = N_squared / (shear**2)\n                \n                # Check instability condition\n                if richardson_number  ri_threshold:\n                    midpoint = (z_i + z_i_plus_1) / 2.0\n                    susceptible_midpoints.append(midpoint)\n        \n        all_results.append(susceptible_midpoints)\n\n    # Format output as a single string\n    # e.g., \"[[50.0,150.0],[...],[]]\"\n    output_str = \"[\"\n    for i, result_list in enumerate(all_results):\n        # Format each list of floats\n        list_str = \"[\" + \",\".join(map(str, result_list)) + \"]\"\n        output_str += list_str\n        if i  len(all_results) - 1:\n            output_str += \",\"\n    output_str += \"]\"\n    \n    print(output_str)\n\nsolve()\n```",
            "answer": "[[50.0,150.0,250.0,350.0,450.0,550.0,650.0,750.0,850.0,950.0],[50.0,150.0,250.0,350.0,450.0,550.0,650.0,750.0,850.0,950.0],[],[],[50.0,150.0,250.0,350.0,450.0,550.0,650.0,750.0,850.0,950.0]]"
        }
    ]
}