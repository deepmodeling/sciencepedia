{
    "hands_on_practices": [
        {
            "introduction": "对于大尺度大气运动，存在一个被称为地转平衡的强大近似。这一平衡关系使得我们能够直接从气压场或位势高度场诊断出风场及其相关属性（如涡度）。本练习将提供一个动手实践的机会，帮助你熟练掌握这一基本关系，通过给定的位势高度场解析计算地转涡度。",
            "id": "4078464",
            "problem": "考虑一个中纬度笛卡尔域，其中东向坐标为 $x$，北向坐标为 $y$，位于固定气压层 $p$ 的气压坐标系中。旋转、静力平衡大气的原始方程中的水平动量方程是出发点。假设科里奥利参数为常数（$f$-平面），即 $f=f_0$，并忽略摩擦。\n\n给定气压层 $p$ 上的一个水平变化的地球位势场\n$$\n\\Phi(x,y,p) \\;=\\; \\Phi_b(p) \\;+\\; \\alpha \\,\\exp\\!\\left(-\\frac{x^{2}}{L_x^{2}} \\,-\\, \\frac{y^{2}}{L_y^{2}}\\right) \\;+\\; \\gamma\\, x^{2} \\;-\\; \\delta\\, y^{2},\n$$\n其中 $\\Phi_b(p)$ 是水平均匀的，常数为\n$$\nf_0 \\;=\\; 1.0 \\times 10^{-4},\\quad L_x \\;=\\; 8.0 \\times 10^{5},\\quad L_y \\;=\\; 1.2 \\times 10^{6},\\quad \\alpha \\;=\\; 1.5 \\times 10^{4},\\quad \\gamma \\;=\\; 5.0 \\times 10^{-10},\\quad \\delta \\;=\\; 3.0 \\times 10^{-10},\n$$\n$f_0$ 的单位是 $\\mathrm{s}^{-1}$，$L_x$ 和 $L_y$ 的单位是 $\\mathrm{m}$，$\\alpha$ 和 $\\Phi$ 的单位是 $\\mathrm{m}^{2}\\,\\mathrm{s}^{-2}$，$\\gamma$ 和 $\\delta$ 的单位是 $\\mathrm{s}^{-2}$。\n\n从原始水平动量方程和地转近似出发，在 $f$ 为常数的假设下，推导地转流函数与地球位势之间的关系，并由此得到地转相对涡度以地球位势表示的表达式。利用此关系，计算与给定 $\\Phi(x,y,p)$ 对应的地转相对涡度 $\\zeta_g(x,y,p)$ 的闭合形式解析表达式。你的最终结果 $\\zeta_g$ 应以 $\\mathrm{s}^{-1}$ 为单位。无需四舍五入。\n\n最后，清晰地讨论使用恒定 $f$ 所涉及的近似，以及在什么条件下 $\\psi=\\Phi/f$ 和 $\\zeta_g=\\nabla_{p}^{2}\\psi$ 能准确地表示气压坐标系中的地转流及其相对涡度，包括当 $f$ 沿经向变化时表达式将如何修正。",
            "solution": "该问题要求在 f-平面近似下，从给定的地球位势场推导地转相对涡度，并随后讨论所涉及的近似。\n\n**问题验证**\n\n**第一步：提取已知条件**\n- 坐标系：笛卡尔域，东向坐标为 $x$，北向坐标为 $y$，位于固定气压层 $p$。\n- 控制方程框架：旋转、静力平衡大气的气压坐标系原始方程。\n- 假设：科里奥利参数 $f=f_0$ 为常数（$f$-平面），忽略摩擦。\n- 地球位势场：$\\Phi(x,y,p) \\;=\\; \\Phi_b(p) \\;+\\; \\alpha \\,\\exp\\!\\left(-\\frac{x^{2}}{L_x^{2}} \\,-\\, \\frac{y^{2}}{L_y^{2}}\\right) \\;+\\; \\gamma\\, x^{2} \\;-\\; \\delta\\, y^{2}$。\n- 常数：\n    -   $f_0 = 1.0 \\times 10^{-4} \\, \\mathrm{s}^{-1}$\n    -   $L_x = 8.0 \\times 10^{5} \\, \\mathrm{m}$\n    -   $L_y = 1.2 \\times 10^{6} \\, \\mathrm{m}$\n    -   $\\alpha = 1.5 \\times 10^{4} \\, \\mathrm{m}^{2}\\,\\mathrm{s}^{-2}$\n    -   $\\gamma = 5.0 \\times 10^{-10} \\, \\mathrm{s}^{-2}$\n    -   $\\delta = 3.0 \\times 10^{-10} \\, \\mathrm{s}^{-2}$\n- $\\Phi_b(p)$ 是一个水平均匀的气压函数。\n- 任务1：在 $f$ 为常数的情况下，推导地转流函数 $\\psi_g$ 与地球位势 $\\Phi$ 之间的关系。\n- 任务2：推导地转相对涡度 $\\zeta_g$ 用 $\\Phi$ 表示的表达式。\n- 任务3：计算给定 $\\Phi$ 的地转相对涡度 $\\zeta_g(x,y,p)$ 的闭合形式解析表达式。\n- 任务4：讨论常数 $f$ 近似以及所推导关系有效性的条件，包括当 $f$ 沿经向变化时的修正。\n\n**第二步：使用提取的已知条件进行验证**\n该问题在地球物理流体动力学的既定原理上具有科学依据。它使用标准方程（原始方程）、标准坐标系（气压坐标）和标准近似（地转平衡、f-平面）。所提供的地球位势函数在数学上是良态的，且常数对于中纬度天气尺度大气系统是物理上现实的。该问题是适定的、客观的、自洽的，并要求基于形式推导和计算的解答。它不违反任何无效性标准。\n\n**第三步：结论与行动**\n该问题被视为有效。将提供完整解答。\n\n**地转关系的推导**\n\n在气压坐标系中，忽略摩擦的原始水平动量方程为：\n$$\n\\frac{Du}{Dt} - fv = -\\frac{\\partial \\Phi}{\\partial x}\n$$\n$$\n\\frac{Dv}{Dt} + fu = -\\frac{\\partial \\Phi}{\\partial y}\n$$\n其中 $u$ 和 $v$ 分别是纬向（东向）和经向（北向）风分量，$f$ 是科里奥利参数，$\\Phi$ 是地球位势，$\\frac{D}{Dt}$ 是物质导数。\n\n地转近似假设流动处于稳定状态，并且加速度项（$\\frac{Du}{Dt}$、$\\frac{Dv}{Dt}$）与科里奥利力和气压梯度力相比可以忽略不计。这种平衡是大尺度、缓慢演变的中纬度大气运动的特征。应用此近似，动量方程简化为地转平衡方程：\n$$\n- fv_g = -\\frac{\\partial \\Phi}{\\partial x} \\quad \\implies \\quad v_g = \\frac{1}{f} \\frac{\\partial \\Phi}{\\partial x}\n$$\n$$\nfu_g = -\\frac{\\partial \\Phi}{\\partial y} \\quad \\implies \\quad u_g = -\\frac{1}{f} \\frac{\\partial \\Phi}{\\partial y}\n$$\n此处，$(u_g, v_g)$ 表示地转风矢量。\n\n二维流函数 $\\psi$ 的定义使得速度分量由 $u = -\\frac{\\partial \\psi}{\\partial y}$ 和 $v = \\frac{\\partial \\psi}{\\partial x}$ 给出。对于地转风，我们定义一个地转流函数 $\\psi_g$。\n比较地转风关系与流函数的定义：\n$$\nu_g = -\\frac{\\partial \\psi_g}{\\partial y} = -\\frac{1}{f} \\frac{\\partial \\Phi}{\\partial y} \\quad \\implies \\quad \\frac{\\partial \\psi_g}{\\partial y} = \\frac{1}{f} \\frac{\\partial \\Phi}{\\partial y}\n$$\n$$\nv_g = \\frac{\\partial \\psi_g}{\\partial x} = \\frac{1}{f} \\frac{\\partial \\Phi}{\\partial x}\n$$\n在 $f$ 是常数 $f=f_0$ 的假设下，我们可以对这些方程进行积分。由第一个方程对 $y$ 积分得到 $\\psi_g = \\frac{\\Phi}{f_0} + C_1(x)$。由第二个方程对 $x$ 积分得到 $\\psi_g = \\frac{\\Phi}{f_0} + C_2(y)$。为保持一致性，$C_1(x)$ 和 $C_2(y)$ 必须等于同一个常数。由于流函数的定义只差一个任意的加法常数（这不影响速度场），我们可以将此常数设为零。因此，对于恒定的科里奥利参数 $f_0$，地转流函数与地球位势成正比：\n$$\n\\psi_g = \\frac{\\Phi}{f_0}\n$$\n相对涡度 $\\zeta$ 是速度场旋度的垂直分量。在笛卡尔坐标系中，$\\zeta = \\frac{\\partial v}{\\partial x} - \\frac{\\partial u}{\\partial y}$。因此，地转相对涡度 $\\zeta_g$ 为：\n$$\n\\zeta_g = \\frac{\\partial v_g}{\\partial x} - \\frac{\\partial u_g}{\\partial y}\n$$\n代入流函数定义：\n$$\n\\zeta_g = \\frac{\\partial}{\\partial x}\\left(\\frac{\\partial \\psi_g}{\\partial x}\\right) - \\frac{\\partial}{\\partial y}\\left(-\\frac{\\partial \\psi_g}{\\partial y}\\right) = \\frac{\\partial^2 \\psi_g}{\\partial x^2} + \\frac{\\partial^2 \\psi_g}{\\partial y^2} = \\nabla_p^2 \\psi_g\n$$\n其中 $\\nabla_p^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2}$ 是恒定气压面上的水平拉普拉斯算子。\n代入关系式 $\\psi_g = \\Phi/f_0$：\n$$\n\\zeta_g = \\nabla_p^2 \\left(\\frac{\\Phi}{f_0}\\right) = \\frac{1}{f_0} \\nabla_p^2 \\Phi\n$$\n这个最终表达式将地转相对涡度直接与地球位势场的拉普拉斯算子联系起来，在地转和 f-平面近似下有效。\n\n**地转相对涡度的计算**\n\n我们给定的地球位势场为：\n$$\n\\Phi(x,y,p) = \\Phi_b(p) + \\alpha \\exp\\left(-\\frac{x^{2}}{L_x^{2}} - \\frac{y^{2}}{L_y^{2}}\\right) + \\gamma x^{2} - \\delta y^{2}\n$$\n为了找到 $\\zeta_g$，我们必须计算 $\\nabla_p^2 \\Phi = \\frac{\\partial^2 \\Phi}{\\partial x^2} + \\frac{\\partial^2 \\Phi}{\\partial y^2}$。项 $\\Phi_b(p)$ 是水平均匀的，因此它对 $x$ 和 $y$ 的偏导数为零。\n\n首先，我们求关于 $x$ 的二阶偏导数：\n$$\n\\frac{\\partial \\Phi}{\\partial x} = \\alpha \\left(-\\frac{2x}{L_x^2}\\right) \\exp\\left(-\\frac{x^{2}}{L_x^{2}} - \\frac{y^{2}}{L_y^{2}}\\right) + 2\\gamma x\n$$\n$$\n\\frac{\\partial^2 \\Phi}{\\partial x^2} = \\frac{\\partial}{\\partial x} \\left[ \\alpha \\left(-\\frac{2x}{L_x^2}\\right) \\exp\\left(-\\frac{x^{2}}{L_x^{2}} - \\frac{y^{2}}{L_y^{2}}\\right) + 2\\gamma x \\right]\n$$\n对第一项使用乘法法则：\n$$\n\\frac{\\partial^2 \\Phi}{\\partial x^2} = \\alpha \\left(-\\frac{2}{L_x^2}\\right) \\exp\\left(-\\frac{x^{2}}{L_x^{2}} - \\frac{y^{2}}{L_y^{2}}\\right) + \\alpha \\left(-\\frac{2x}{L_x^2}\\right)\\left(-\\frac{2x}{L_x^2}\\right) \\exp\\left(-\\frac{x^{2}}{L_x^{2}} - \\frac{y^{2}}{L_y^{2}}\\right) + 2\\gamma\n$$\n$$\n\\frac{\\partial^2 \\Phi}{\\partial x^2} = \\alpha \\left(\\frac{4x^2}{L_x^4} - \\frac{2}{L_x^2}\\right) \\exp\\left(-\\frac{x^{2}}{L_x^{2}} - \\frac{y^{2}}{L_y^{2}}\\right) + 2\\gamma\n$$\n根据对称性，关于 $y$ 的二阶偏导数为：\n$$\n\\frac{\\partial \\Phi}{\\partial y} = \\alpha \\left(-\\frac{2y}{L_y^2}\\right) \\exp\\left(-\\frac{x^{2}}{L_x^{2}} - \\frac{y^{2}}{L_y^{2}}\\right) - 2\\delta y\n$$\n$$\n\\frac{\\partial^2 \\Phi}{\\partial y^2} = \\alpha \\left(\\frac{4y^2}{L_y^4} - \\frac{2}{L_y^2}\\right) \\exp\\left(-\\frac{x^{2}}{L_x^{2}} - \\frac{y^{2}}{L_y^{2}}\\right) - 2\\delta\n$$\n地球位势的拉普拉斯算子是这两个导数的和：\n$$\n\\nabla_p^2 \\Phi = \\frac{\\partial^2 \\Phi}{\\partial x^2} + \\frac{\\partial^2 \\Phi}{\\partial y^2} = \\alpha \\left(\\frac{4x^2}{L_x^4} - \\frac{2}{L_x^2} + \\frac{4y^2}{L_y^4} - \\frac{2}{L_y^2}\\right) \\exp\\left(-\\frac{x^{2}}{L_x^{2}} - \\frac{y^{2}}{L_y^{2}}\\right) + 2\\gamma - 2\\delta\n$$\n最后，地转相对涡度是 $\\zeta_g = \\frac{1}{f_0} \\nabla_p^2 \\Phi$：\n$$\n\\zeta_g(x,y,p) = \\frac{1}{f_0} \\left[ \\alpha \\left( \\frac{4x^2}{L_x^4} - \\frac{2}{L_x^2} + \\frac{4y^2}{L_y^4} - \\frac{2}{L_y^2} \\right) \\exp\\left(-\\frac{x^{2}}{L_x^{2}} - \\frac{y^{2}}{L_y^{2}}\\right) + 2(\\gamma - \\delta) \\right]\n$$\n这是所要求的 $\\zeta_g$ 的闭合形式解析表达式，单位为 $\\mathrm{s}^{-1}$。\n\n**近似的讨论**\n\n关系式 $\\psi_g = \\Phi/f_0$ 和 $\\zeta_g = \\nabla_p^2 \\psi_g$ 是准地转理论的基础，并依赖于两个关键近似：\n\n1.  **地转近似**：这种平衡要求罗斯贝数 $Ro = U/(fL)$ 很小（$Ro \\ll 1$），其中 $U$ 和 $L$ 分别是运动的特征速度和长度尺度。这意味着流体加速度与科里奥利力和气压梯度力相比可以忽略不计。这个近似对于中纬度自由大气中的大尺度（天气尺度，$L \\sim 1000 \\, \\mathrm{km}$）、缓慢演变的运动很适用。\n\n2.  **f-平面近似**：这涉及将科里奥利参数 $f$ 视为常数 $f=f_0$。实际上，$f = 2\\Omega\\sin\\phi$，其中 $\\Omega$ 是地球的角转速，$\\phi$ 是纬度。这个参数随北向坐标 $y$ 而变化。f-平面近似仅在运动的经向范围 $L_y$ 足够小，以至于 $f$ 在整个区域的变化与 $f_0$ 相比可以忽略时才有效。更高一级的近似是 $\\beta$-平面，其中 $f$ 在中心纬度 $\\phi_0$ 附近线性化：$f(y) \\approx f_0 + \\beta y$，其中 $\\beta = (df/dy)_{\\phi_0}$。f-平面近似要求 $\\beta L_y \\ll f_0$。\n\n如果允许科里奥利参数随纬度变化，$f=f(y)$，则上述推导的关系必须进行修正。地转风分量变为 $u_g = -\\frac{1}{f(y)}\\frac{\\partial \\Phi}{\\partial y}$ 和 $v_g = \\frac{1}{f(y)}\\frac{\\partial \\Phi}{\\partial x}$。一个重要的后果是地转风不再是无辐散的：\n$$\n\\nabla_p \\cdot \\mathbf{v}_g = \\frac{\\partial u_g}{\\partial x} + \\frac{\\partial v_g}{\\partial y} = \\frac{\\partial}{\\partial y}\\left(\\frac{1}{f(y)}\\frac{\\partial \\Phi}{\\partial x}\\right) = -\\frac{1}{f^2}\\frac{df}{dy}\\frac{\\partial \\Phi}{\\partial x} = -\\frac{\\beta}{f}v_g \\neq 0\n$$\n由于流具有非零辐散，严格意义上不存在一个流函数 $\\psi_g$ 使得 $(u_g, v_g) = (-\\frac{\\partial \\psi_g}{\\partial y}, \\frac{\\partial \\psi_g}{\\partial x})$。因此，简单的关系 $\\psi_g = \\Phi/f$ 不再作为流函数有效。\n\n地转相对涡度 $\\zeta_g = \\frac{\\partial v_g}{\\partial x} - \\frac{\\partial u_g}{\\partial y}$ 必须重新推导：\n$$\n\\zeta_g = \\frac{\\partial}{\\partial x}\\left(\\frac{1}{f}\\frac{\\partial \\Phi}{\\partial x}\\right) - \\frac{\\partial}{\\partial y}\\left(-\\frac{1}{f}\\frac{\\partial \\Phi}{\\partial y}\\right) = \\frac{1}{f}\\frac{\\partial^2 \\Phi}{\\partial x^2} + \\frac{\\partial}{\\partial y}\\left(\\frac{1}{f}\\frac{\\partial \\Phi}{\\partial y}\\right)\n$$\n$$\n\\zeta_g = \\frac{1}{f}\\frac{\\partial^2 \\Phi}{\\partial x^2} + \\frac{1}{f}\\frac{\\partial^2 \\Phi}{\\partial y^2} - \\frac{1}{f^2}\\frac{df}{dy}\\frac{\\partial \\Phi}{\\partial y} = \\frac{1}{f}\\nabla_p^2 \\Phi - \\frac{\\beta}{f^2}\\frac{\\partial \\Phi}{\\partial y}\n$$\n利用 $\\frac{\\partial \\Phi}{\\partial y} = -f u_g$，这可以写成：\n$$\n\\zeta_g = \\frac{1}{f}\\nabla_p^2 \\Phi + \\frac{\\beta}{f}u_g\n$$\n这个修正后的表达式表明，在 $\\beta$-平面上，地转涡度不仅取决于地球位势的拉普拉斯算子，还取决于纬向地转风本身。简单的关系 $\\zeta_g = \\frac{1}{f_0}\\nabla_p^2\\Phi$ 是一种特例，仅在 f-平面上有效。",
            "answer": "$$\n\\boxed{\\frac{1}{f_0} \\left[ \\alpha \\left( \\frac{4x^2}{L_x^4} + \\frac{4y^2}{L_y^4} - \\frac{2}{L_x^2} - \\frac{2}{L_y^2} \\right) \\exp\\left(-\\frac{x^{2}}{L_x^{2}} - \\frac{y^{2}}{L_y^{2}}\\right) + 2(\\gamma - \\delta) \\right]}\n$$"
        },
        {
            "introduction": "厄特尔位涡（PV）是现代动力气象学的基石之一。它巧妙地将流体旋转（绝对涡度）和热力分层（静力稳定度）这两个概念结合成一个在特定条件下物质守恒的物理量。本练习将演示如何利用标准的大气分析数据计算这个强大的诊断和预报变量。",
            "id": "4078408",
            "problem": "在北纬 $\\phi = 50^{\\circ}$ 的一个中纬度地区，对 $p = 500\\,\\mathrm{hPa}$ 的 $p$ 坐标面进行天气尺度分析。风场分析得出，在等压面上的相对涡度垂直分量为 $\\zeta = 3.0 \\times 10^{-5}\\,\\mathrm{s}^{-1}$。附近的无线电探空数据显示，在 $p = 700\\,\\mathrm{hPa}$ 处的位温为 $\\theta = 316\\,\\mathrm{K}$，在 $p = 500\\,\\mathrm{hPa}$ 处的位温为 $\\theta = 336\\,\\mathrm{K}$。\n\n从高度坐标系中的厄特位涡 (PV) 定义、原始方程中的静力学关系以及涡度的运动学定义出发，推导气压坐标系中仅依赖于绝对涡度垂直分量和位温垂直梯度的厄特位涡表达式。在推导过程中，明确陈述并使用适用于天气尺度流动的、有物理依据的假设，这些假设使你能够忽略涉及位温水平梯度和垂直风切变的斜压项和倾斜项。然后，使用以下常数计算该位置 $p = 500\\,\\mathrm{hPa}$ 面上的厄特位涡：\n- 地球自转速率 $\\Omega = 7.292 \\times 10^{-5}\\,\\mathrm{s}^{-1}$，\n- 重力加速度 $g = 9.81\\,\\mathrm{m}\\,\\mathrm{s}^{-2}$。\n\n使用科里奥利参数的传统定义 $f = 2 \\Omega \\sin \\phi$。将最终数值结果以位涡单位 (PVU) 表示，其中 $1\\,\\mathrm{PVU} = 10^{-6}\\,\\mathrm{K}\\,\\mathrm{m}^{2}\\,\\mathrm{kg}^{-1}\\,\\mathrm{s}^{-1}$。将答案四舍五入到三位有效数字。",
            "solution": "该问题要求推导适用于天气尺度分析的气压坐标系中厄特位涡 (PV) 的近似表达式，然后使用给定的大气数据进行数值计算。\n\n### 步骤 1：提取已知条件\n问题陈述中提供了以下数据：\n- p坐标面上的分析层面：$p = 500\\,\\mathrm{hPa}$\n- 纬度：$\\phi = 50^{\\circ}\\,\\mathrm{N}$\n- 等压面上的相对涡度垂直分量：$\\zeta = 3.0 \\times 10^{-5}\\,\\mathrm{s}^{-1}$\n- $p_1 = 700\\,\\mathrm{hPa}$ 处的位温：$\\theta_1 = 316\\,\\mathrm{K}$\n- $p_2 = 500\\,\\mathrm{hPa}$ 处的位温：$\\theta_2 = 336\\,\\mathrm{K}$\n- 地球自转速率：$\\Omega = 7.292 \\times 10^{-5}\\,\\mathrm{s}^{-1}$\n- 重力加速度：$g = 9.81\\,\\mathrm{m}\\,\\mathrm{s}^{-2}$\n- 科里奥利参数的定义：$f = 2 \\Omega \\sin \\phi$\n- 位涡单位的定义：$1\\,\\mathrm{PVU} = 10^{-6}\\,\\mathrm{K}\\,\\mathrm{m}^{2}\\,\\mathrm{kg}^{-1}\\,\\mathrm{s}^{-1}$\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，是良定的、客观的。这是动力气象学中的一个标准问题，涉及基本量厄特位涡的推导和应用。该问题为得出唯一解提供了所有必要的数据和定义。所规定的物理假设（静力平衡、忽略天气尺度流动的特定项）是标准的，并且适用于此背景。提供的数值对于地球中纬度大气是物理上现实的。该问题没有违反任何无效标准。\n\n### 步骤 3：结论与行动\n问题有效。将提供完整解。\n\n### 第 1 部分：气压坐标系中厄特位涡的推导\n\n高度（$z$）坐标系中的厄特位涡（$PV$）定义为：\n$$\nPV = \\frac{1}{\\rho} \\boldsymbol{\\omega}_a \\cdot \\boldsymbol{\\nabla}\\theta\n$$\n其中 $\\rho$ 是空气密度，$\\boldsymbol{\\omega}_a$ 是三维绝对涡度矢量，$\\boldsymbol{\\nabla}\\theta$ 是位温 $\\theta$ 的三维梯度。\n\n绝对涡度矢量 $\\boldsymbol{\\omega}_a$ 是相对涡度矢量（$\\boldsymbol{\\omega}_r = \\boldsymbol{\\nabla} \\times \\mathbf{v}$）和行星涡度（$2\\boldsymbol{\\Omega}$）之和：\n$$\n\\boldsymbol{\\omega}_a = \\boldsymbol{\\nabla} \\times \\mathbf{v} + 2\\boldsymbol{\\Omega}\n$$\n在一个具有单位矢量 $(\\mathbf{i}, \\mathbf{j}, \\mathbf{k})$ 的局部笛卡尔坐标系 $(x, y, z)$ 中，对于天气尺度运动，当地球自转矢量的水平分量被忽略时，我们可以写出：\n$$\n\\boldsymbol{\\omega}_a = \\left(\\frac{\\partial w}{\\partial y} - \\frac{\\partial v}{\\partial z}\\right)\\mathbf{i} + \\left(\\frac{\\partial u}{\\partial z} - \\frac{\\partial w}{\\partial x}\\right)\\mathbf{j} + \\left(f + \\frac{\\partial v}{\\partial x} - \\frac{\\partial u}{\\partial y}\\right)\\mathbf{k}\n$$\n其中 $u, v, w$ 分别是 $x, y, z$ 方向的风分量，而 $f = 2\\Omega\\sin\\phi$ 是科里奥利参数。设 $\\zeta = \\frac{\\partial v}{\\partial x} - \\frac{\\partial u}{\\partial y}$ 为相对涡度的垂直分量。\n\n位温的梯度是：\n$$\n\\boldsymbol{\\nabla}\\theta = \\frac{\\partial \\theta}{\\partial x}\\mathbf{i} + \\frac{\\partial \\theta}{\\partial y}\\mathbf{j} + \\frac{\\partial \\theta}{\\partial z}\\mathbf{k}\n$$\n\n那么点积 $\\boldsymbol{\\omega}_a \\cdot \\boldsymbol{\\nabla}\\theta$ 是：\n$$\n\\boldsymbol{\\omega}_a \\cdot \\boldsymbol{\\nabla}\\theta = \\left(\\frac{\\partial w}{\\partial y} - \\frac{\\partial v}{\\partial z}\\right)\\frac{\\partial \\theta}{\\partial x} + \\left(\\frac{\\partial u}{\\partial z} - \\frac{\\partial w}{\\partial x}\\right)\\frac{\\partial \\theta}{\\partial y} + (f+\\zeta)\\frac{\\partial \\theta}{\\partial z}\n$$\n问题指明我们应该使用适用于天气尺度流动的假设。\n1.  **尺度分析**：对于大尺度天气运动，$\\theta$ 的水平变化远小于其垂直变化（$|\\boldsymbol{\\nabla}_h \\theta| \\ll |\\partial\\theta/\\partial z|$）。此外，涉及垂直风切变（$|\\partial u/\\partial z|, |\\partial v/\\partial z|$）的项是显著的，但涉及垂直速度水平梯度（$|\\partial w/\\partial x|, |\\partial w/\\partial y|$）的项非常小。因此，点积展开式中的前两项，即所谓的倾斜项和斜压项，比第三项小一个数量级。\n    $$\n    \\left| \\left(\\frac{\\partial w}{\\partial y} - \\frac{\\partial v}{\\partial z}\\right)\\frac{\\partial \\theta}{\\partial x} + \\left(\\frac{\\partial u}{\\partial z} - \\frac{\\partial w}{\\partial x}\\right)\\frac{\\partial \\theta}{\\partial y} \\right| \\ll \\left| (f+\\zeta)\\frac{\\partial \\theta}{\\partial z} \\right|\n    $$\n    忽略这些较小的项，PV 的表达式简化为：\n    $$\n    PV \\approx \\frac{1}{\\rho}(f+\\zeta_z)\\frac{\\partial \\theta}{\\partial z}\n    $$\n    其中 $\\zeta_z$ 表示 z 坐标系中相对涡度的垂直分量。\n\n2.  **静力平衡**：对于天气尺度运动，大气处于近似静力平衡状态。来自原始方程的静力关系是：\n    $$\n    \\frac{\\partial p}{\\partial z} = -\\rho g\n    $$\n为了将表达式从高度坐标系转换到气压坐标系，我们对位温的垂直导数使用链式法则：\n$$\n\\frac{\\partial \\theta}{\\partial z} = \\frac{\\partial \\theta}{\\partial p} \\frac{\\partial p}{\\partial z}\n$$\n将静力关系代入链式法则表达式得到：\n$$\n\\frac{\\partial \\theta}{\\partial z} = \\frac{\\partial \\theta}{\\partial p} (-\\rho g)\n$$\n现在，我们将此代入 $PV$ 的简化表达式中：\n$$\nPV \\approx \\frac{1}{\\rho}(f+\\zeta_z) \\left( -\\rho g \\frac{\\partial \\theta}{\\partial p} \\right)\n$$\n密度 $\\rho$ 被消去，得出气压坐标系中的厄特位涡表达式：\n$$\nPV \\approx -g (f+\\zeta_p) \\frac{\\partial \\theta}{\\partial p}\n$$\n在此，我们用等压面上的相对涡度垂直分量 $\\zeta_p$ 替换了 $\\zeta_z$，因为对于天气尺度运动，它们近似相等。给定的值 $\\zeta$ 是在等压面上的，对应于 $\\zeta_p$。\n\n这就是所求的表达式，它仅依赖于等压面上的绝对涡度垂直分量 $\\eta_p = f+\\zeta_p$ 和气压坐标系中位温的垂直梯度 $\\frac{\\partial \\theta}{\\partial p}$。\n\n### 第 2 部分：厄特位涡的数值计算\n\n我们使用推导出的公式 $PV = -g(f+\\zeta)\\frac{\\partial \\theta}{\\partial p}$ 和给定的值。\n\n1.  **计算科里奥利参数 $f$**：\n    $$\n    f = 2 \\Omega \\sin \\phi = 2 \\times (7.292 \\times 10^{-5}\\,\\mathrm{s}^{-1}) \\times \\sin(50^{\\circ})\n    $$\n    使用 $\\sin(50^{\\circ}) \\approx 0.766044$：\n    $$\n    f \\approx 2 \\times (7.292 \\times 10^{-5}\\,\\mathrm{s}^{-1}) \\times 0.766044 \\approx 1.11736 \\times 10^{-4}\\,\\mathrm{s}^{-1}\n    $$\n\n2.  **计算绝对涡度 $(f+\\zeta)$**：\n    $$\n    f + \\zeta \\approx (1.11736 \\times 10^{-4}\\,\\mathrm{s}^{-1}) + (3.0 \\times 10^{-5}\\,\\mathrm{s}^{-1}) = 1.41736 \\times 10^{-4}\\,\\mathrm{s}^{-1}\n    $$\n\n3.  **近似计算位温垂直梯度 $\\frac{\\partial \\theta}{\\partial p}$**：\n    我们使用基于无线电探空数据的有限差分近似：\n    $$\n    \\frac{\\partial \\theta}{\\partial p} \\approx \\frac{\\Delta \\theta}{\\Delta p} = \\frac{\\theta_2 - \\theta_1}{p_2 - p_1} = \\frac{336\\,\\mathrm{K} - 316\\,\\mathrm{K}}{500\\,\\mathrm{hPa} - 700\\,\\mathrm{hPa}} = \\frac{20\\,\\mathrm{K}}{-200\\,\\mathrm{hPa}}\n    $$\n    $$\n    \\frac{\\partial \\theta}{\\partial p} = -0.1\\,\\mathrm{K}\\,\\mathrm{hPa}^{-1}\n    $$\n    为了使用国际单位制，我们将百帕（hPa）转换为帕斯卡（Pa），其中 $1\\,\\mathrm{hPa} = 100\\,\\mathrm{Pa}$：\n    $$\n    \\frac{\\partial \\theta}{\\partial p} = -0.1\\,\\mathrm{K}\\,(100\\,\\mathrm{Pa})^{-1} = -0.001\\,\\mathrm{K}\\,\\mathrm{Pa}^{-1} = -1.0 \\times 10^{-3}\\,\\mathrm{K}\\,\\mathrm{Pa}^{-1}\n    $$\n\n4.  **计算位涡 $PV$**：\n    将数值代入公式：\n    $$\n    PV \\approx -g (f+\\zeta) \\frac{\\partial \\theta}{\\partial p}\n    $$\n    $$\n    PV \\approx -(9.81\\,\\mathrm{m}\\,\\mathrm{s}^{-2}) \\times (1.41736 \\times 10^{-4}\\,\\mathrm{s}^{-1}) \\times (-1.0 \\times 10^{-3}\\,\\mathrm{K}\\,\\mathrm{Pa}^{-1})\n    $$\n    单位是 $(\\mathrm{m}\\,\\mathrm{s}^{-2}) \\cdot (\\mathrm{s}^{-1}) \\cdot (\\mathrm{K}\\,\\mathrm{Pa}^{-1}) = \\mathrm{K}\\,\\mathrm{m}\\,\\mathrm{s}^{-3}\\,\\mathrm{Pa}^{-1}$。因为 $1\\,\\mathrm{Pa} = 1\\,\\mathrm{kg}\\,\\mathrm{m}^{-1}\\,\\mathrm{s}^{-2}$，所以 $1\\,\\mathrm{Pa}^{-1} = 1\\,\\mathrm{kg}^{-1}\\,\\mathrm{m}\\,\\mathrm{s}^{2}$。因此 PV 的单位是 $\\mathrm{K}\\,\\mathrm{m}\\,\\mathrm{s}^{-3}\\,(\\mathrm{kg}^{-1}\\,\\mathrm{m}\\,\\mathrm{s}^{2}) = \\mathrm{K}\\,\\mathrm{m}^{2}\\,\\mathrm{kg}^{-1}\\,\\mathrm{s}^{-1}$，这是一致的。\n    $$\n    PV \\approx 9.81 \\times 1.41736 \\times 10^{-4} \\times 1.0 \\times 10^{-3} \\,\\mathrm{K}\\,\\mathrm{m}^{2}\\,\\mathrm{kg}^{-1}\\,\\mathrm{s}^{-1}\n    $$\n    $$\n    PV \\approx 1.3904... \\times 10^{-6}\\,\\mathrm{K}\\,\\mathrm{m}^{2}\\,\\mathrm{kg}^{-1}\\,\\mathrm{s}^{-1}\n    $$\n\n5.  **以位涡单位 (PVU) 表示结果**：\n    已知 $1\\,\\mathrm{PVU} = 10^{-6}\\,\\mathrm{K}\\,\\mathrm{m}^{2}\\,\\mathrm{kg}^{-1}\\,\\mathrm{s}^{-1}$：\n    $$\n    PV \\approx \\frac{1.3904... \\times 10^{-6}}{10^{-6}} \\,\\mathrm{PVU} \\approx 1.3904... \\,\\mathrm{PVU}\n    $$\n\n四舍五入到三位有效数字，厄特位涡为 $1.39\\,\\mathrm{PVU}$。",
            "answer": "$$\n\\boxed{1.39}\n$$"
        },
        {
            "introduction": "数值天气预报模型必须在离散的网格上求解原始方程组。其中一个关键变量——P坐标系中的垂直速度（$ω$）——无法直接测量，而必须通过水平风场来诊断。本练习将引导你完成一个基本过程：通过对连续方程进行数值积分来计算垂直速度廓线，这是任何大气模型中的核心步骤。",
            "id": "4078442",
            "problem": "考虑为数值天气预报 (NWP) 和全球气候模式 (GCM) 应用而建立在气压坐标系下的流体静力原始方程。设水平风为 $\\mathbf{v} = (u,v)$，水平散度为 $D = \\nabla \\cdot \\mathbf{v}$，气压坐标系中的垂直速度为 $\\omega = \\dfrac{D p}{D t}$，其中 $p$ 是气压。从质量连续性方程和静力平衡出发，推导 $\\omega$ 的垂直导数与水平散度 $D$ 之间的关系。然后，设计一个数值算法，通过向下积分来计算一组离散气压层上的 $\\omega(p)$，给定以下条件：\n- 一个从模式顶 $p_t$ 到下边界 $p_s$ 的严格递增的气压层数组 $\\{p_k\\}$，\n- 一个在相同气压层上计算出的相应水平散度值数组 $\\{D_k\\}$，\n- 以及上边界条件 $\\omega(p_t) = 0$。\n\n您的推导和算法必须仅基于第一性原理（质量连续性和静力平衡），不得引用简化公式。您还必须确定并明确说明在气压坐标系中下边界所需的运动学边界条件，即将 $\\omega(p_s)$ 用地面气压的物质导数表示。\n\n数值实现要求：\n- 使用一致的离散求积法从 $p_t$ 向下积分到每个 $p_k$；如果能从您推导的连续关系中明确论证梯形法则的合理性，则该法则是可接受的。\n- 程序必须接受以数组形式硬编码的给定测试套件，并在没有外部输入的情况下生成所要求的输出。\n\n单位和输出：\n- 散度 $D$ 的单位为 $\\text{s}^{-1}$，气压 $p$ 的单位为 $\\text{Pa}$，计算出的 $\\omega$ 必须以 $\\text{Pa}\\,\\text{s}^{-1}$ 为单位表示。\n- 不涉及角度，因此不需要角度单位。\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表。此外部列表的每个元素本身也必须是一个列表，包含一个测试案例在指定气压层上的 $\\omega$ 值（单位为 $\\text{Pa}\\,\\text{s}^{-1}$），并按从 $p_t$ 到 $p_s$ 的顺序排列（例如：`\"[[\\omega(p_1),\\omega(p_2),\\dots,\\omega(p_N)],[\\dots],[\\dots]]\"`）。\n\n测试套件：\n- 情况 A（一般情况，单调辐合）：$p = [20000, 40000, 60000, 80000, 100000]$ (单位 $\\text{Pa}$)，$D = [-1.0 \\times 10^{-6}, -1.2 \\times 10^{-6}, -1.5 \\times 10^{-6}, -1.9 \\times 10^{-6}, -2.4 \\times 10^{-6}]$ (单位 $\\text{s}^{-1}$)，且 $\\omega(p_t) = 0$ (单位 $\\text{Pa}\\,\\text{s}^{-1}$)。\n- 情况 B（边界条件检查，零散度）：$p = [20000, 40000, 60000, 80000, 100000]$ (单位 $\\text{Pa}$)，$D = [0.0, 0.0, 0.0, 0.0, 0.0]$ (单位 $\\text{s}^{-1}$)，且 $\\omega(p_t) = 0$ (单位 $\\text{Pa}\\,\\text{s}^{-1}$)。\n- 情况 C（散度符号变化，整层积分中性）：$p = [20000, 40000, 60000, 80000, 100000]$ (单位 $\\text{Pa}$)，$D = [2.0 \\times 10^{-6}, 1.0 \\times 10^{-6}, 0.0, -1.0 \\times 10^{-6}, -2.0 \\times 10^{-6}]$ (单位 $\\text{s}^{-1}$)，且 $\\omega(p_t) = 0$ (单位 $\\text{Pa}\\,\\text{s}^{-1}$)。\n\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表（例如：`\"[[\\omega\\_A(p\\_1),\\dots,\\omega\\_A(p\\_N)],[\\omega\\_B(p\\_1),\\dots,\\omega\\_B(p\\_N)],[\\omega\\_C(p\\_1),\\dots,\\omega\\_C(p\\_N)]]\"`），其中 $\\omega\\_A$、$\\omega\\_B$ 和 $\\omega\\_C$ 分别表示情况 A、B 和 C 的解。每个 $\\omega$ 值都必须以 $\\text{Pa}\\,\\text{s}^{-1}$ 为单位。",
            "solution": "我们从适用于气压坐标系下流体静力原始方程的第一性原理开始。基本定律是：\n\n1. 可压缩流体在高度坐标系中的质量连续性方程为\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\nabla_h \\cdot (\\rho \\mathbf{v}) + \\frac{\\partial (\\rho w)}{\\partial z} = 0,\n$$\n其中 $\\rho$ 是密度，$\\mathbf{v}=(u,v)$ 是水平速度，$w$ 是高度坐标系中的垂直速度，$\\nabla_h$ 表示水平散度算子，$z$ 是几何高度。\n\n2. 静力平衡将气压与密度和高度联系起来：\n$$\n\\frac{\\partial p}{\\partial z} = - \\rho g,\n$$\n其中 $g$ 是重力加速度。\n\n3. 气压坐标系中垂直速度的定义是气压的拉格朗日（物质）导数：\n$$\n\\omega = \\frac{D p}{D t} = \\frac{\\partial p}{\\partial t} + \\mathbf{v} \\cdot \\nabla_h p + w \\frac{\\partial p}{\\partial z}.\n$$\n在气压坐标系中，气压本身被用作垂直坐标，这种变换使得在静力平衡下，连续性方程变得异常简单。\n\n基于这些基础，我们将连续性方程转换到气压坐标系。在静力近似下，并使用 $\\omega$ 的定义，连续性方程在气压坐标系中简化为一个紧凑且广泛使用的形式：\n$$\n\\nabla_h \\cdot \\mathbf{v} + \\frac{\\partial \\omega}{\\partial p} = 0.\n$$\n这是通过应用链式法则，利用静力关系替换 $z$ 的导数，并以单位气压而非单位高度的质量通量来表示而推导出来的；静力关系确保了变换的雅可比行列式消去了 $\\rho$ 因子，从而得到一个不再显式依赖于 $\\rho$ 的连续性方程。该关系是从水平散度诊断垂直运动的基石。\n\n重新整理上式，可得到以水平散度表示的气压垂直速度的垂直导数：\n$$\n\\frac{\\partial \\omega}{\\partial p} = - D,\n$$\n其中 $D = \\nabla_h \\cdot \\mathbf{v}$。\n\n向下积分算法：\n给定离散气压层 $p_1, p_2, \\dots, p_N$（其中 $p_1 = p_t$ 且 $p_N = p_s$）以及在这些层上的散度值 $D_1, D_2, \\dots, D_N$，我们使用上边界条件 $\\omega(p_t) = 0$ 从 $p_t$ 向下积分常微分方程 $\\dfrac{\\partial \\omega}{\\partial p} = -D$。一种二阶精确且稳健的选择是梯形法则，该法则是通过在每一层上对连续关系进行积分，并在线性近似相邻层之间的 $D(p)$ 积分而得出的。在气压层 $[p_k, p_{k+1}]$ 上，\n$$\n\\omega(p_{k+1}) - \\omega(p_k) = \\int_{p_k}^{p_{k+1}} \\frac{\\partial \\omega}{\\partial p} \\, dp = - \\int_{p_k}^{p_{k+1}} D(p) \\, dp \\approx - \\frac{D_k + D_{k+1}}{2} \\left(p_{k+1} - p_k\\right).\n$$\n因此，在 $\\omega(p_1) = 0$ 的条件下，我们对 $k=1,2,\\dots,N-1$ 进行迭代计算：\n$$\n\\omega(p_{k+1}) = \\omega(p_k) - \\frac{D_k + D_{k+1}}{2} \\left(p_{k+1} - p_k\\right).\n$$\n这就得出了所有层 $k = 1, \\dots, N$ 上的 $\\omega(p_k)$。\n\n气压坐标系中的下边界条件：\n物理下边界的不可穿透条件（没有法向流穿过地面）意味着在高度坐标系中，地表处的 $w=0$。在气压坐标系中，下边界位于随时间变化的地面气压 $p_s(x,y,t)$ 处。相应的运动学边界条件是，地表处气压坐标系中的垂直速度等于地面气压的物质导数：\n$$\n\\omega(p_s) = \\frac{D p_s}{D t} = \\frac{\\partial p_s}{\\partial t} + u_s \\frac{\\partial p_s}{\\partial x} + v_s \\frac{\\partial p_s}{\\partial y}.\n$$\n在此处的诊断计算中，将 $\\frac{\\partial \\omega}{\\partial p} = -D$ 从 $p_t$ 积分到 $p_s$（在 $\\omega(p_t)=0$ 的条件下）会得到一个 $\\omega(p_s)$ 的值，该值必须等于 $\\dfrac{D p_s}{D t}$ 以满足质量连续性和运动学边界条件。如果一个模式指定了 $\\dfrac{\\partial p_s}{\\partial t}$ 或对 $p_s$ 的约束，这就提供了所需的下边界条件；否则，积分提供了隐含的 $\\omega(p_s)$，从中可以推导出 $\\dfrac{D p_s}{D t}$。\n\n单位一致性：\n- $D$ 的单位是 $\\text{s}^{-1}$。\n- $p$ 的单位是 $\\text{Pa}$。\n- 积分 $\\int -D \\, dp$ 得出 $\\omega$ 的单位为 $\\text{Pa}\\,\\text{s}^{-1}$，这与 $\\omega = \\dfrac{D p}{D t}$ 一致。\n\n测试案例和预期的定性行为：\n- 情况 A：所有层中 $D0$（水平辐合）应产生向下递增的 $\\omega0$，代表在气压坐标系中的下沉运动（气压沿气块轨迹增加）。\n- 情况 B：$D=0$ 导致处处 $\\omega=0$ 并且下边界条件为 $\\omega(p_s)=0$。\n- 情况 C：$D$ 的符号发生变化，且垂直积分散度近似为零，导致 $\\omega(p_s) \\approx 0$ 以及一个廓线，其中 $\\omega$ 在高空可能为负，在低空为正。\n\n算法实现细节：\n- 验证 $p$ 是严格递增的 ($p_{k+1}  p_k$)，以确保向下积分与物理方向一致。\n- 将 $\\omega(p_1)$ 初始化为 $0$ (单位 $\\text{Pa}\\,\\text{s}^{-1}$)。\n- 对每对相邻的气压层应用梯形更新，以获得完整的 $\\omega$ 廓线。\n- 为每个测试案例返回 $\\omega$ 值的列表（单位 $\\text{Pa}\\,\\text{s}^{-1}$）。\n- 每个列表中的最后一个值等于 $\\omega(p_s)$，满足运动学下边界条件 $\\omega(p_s)=\\dfrac{D p_s}{D t}$。\n\n所提供的程序为指定的测试套件计算这些廓线，并打印包含 $\\omega$ 值列表的列表的单行输出，每个值以 $\\text{Pa}\\,\\text{s}^{-1}$ 为单位，并按从 $p_t$ 到 $p_s$ 的顺序排列。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef integrate_omega(pressures_pa, divergence_s_inv, omega_top_pa_per_s=0.0):\n    \"\"\"\n    Compute omega(p) by downward integration using the trapezoidal rule.\n    pressures_pa: 1D array-like of pressures [Pa], strictly increasing from top to bottom.\n    divergence_s_inv: 1D array-like of horizontal divergence D [s^-1], same length as pressures.\n    omega_top_pa_per_s: omega at the top boundary [Pa s^-1], default 0.\n    Returns: list of omega values [Pa s^-1] at each pressure level.\n    \"\"\"\n    p = np.array(pressures_pa, dtype=float)\n    D = np.array(divergence_s_inv, dtype=float)\n    if p.ndim != 1 or D.ndim != 1 or p.size != D.size or p.size  1:\n        raise ValueError(\"Invalid input shapes for pressures/divergence.\")\n    # Ensure strictly increasing pressures\n    if not np.all(np.diff(p) > 0):\n        raise ValueError(\"Pressures must be strictly increasing (top to bottom).\")\n\n    omega = np.zeros_like(p, dtype=float)\n    omega[0] = float(omega_top_pa_per_s)\n    # Trapezoidal downward integration of ∂ω/∂p = -D\n    for k in range(0, p.size - 1):\n        dp = p[k + 1] - p[k]\n        D_avg = 0.5 * (D[k] + D[k + 1])\n        domega = - D_avg * dp\n        omega[k + 1] = omega[k] + domega\n\n    # Clean small numerical artifacts like -0.0 to +0.0\n    omega[np.isclose(omega, 0.0, atol=1e-15)] = 0.0\n    return [float(x) for x in omega]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: monotonic convergence (negative D)\n        (\n            [20000.0, 40000.0, 60000.0, 80000.0, 100000.0],  # pressures [Pa]\n            [-1.0e-6, -1.2e-6, -1.5e-6, -1.9e-6, -2.4e-6],   # divergence [s^-1]\n            0.0                                              # omega at top [Pa s^-1]\n        ),\n        # Case B: zero divergence\n        (\n            [20000.0, 40000.0, 60000.0, 80000.0, 100000.0],\n            [0.0, 0.0, 0.0, 0.0, 0.0],\n            0.0\n        ),\n        # Case C: sign-changing divergence, column-integrated neutrality\n        (\n            [20000.0, 40000.0, 60000.0, 80000.0, 100000.0],\n            [2.0e-6, 1.0e-6, 0.0, -1.0e-6, -2.0e-6],\n            0.0\n        ),\n    ]\n\n    results = []\n    for pressures, divergences, omega_top in test_cases:\n        omega_profile = integrate_omega(pressures, divergences, omega_top)\n        results.append(omega_profile)\n\n    # Final print statement in the exact required format.\n    # Print as a single line: list of lists of floats.\n    def format_list(lst):\n        return \"[\" + \",\".join(f\"{x:.12g}\" for x in lst) + \"]\"\n    print(\"[\" + \",\".join(format_list(r) for r in results) + \"]\")\n\nsolve()\n```"
        }
    ]
}