{
    "hands_on_practices": [
        {
            "introduction": "在气压坐标系下，质量连续性方程将水平运动与垂直运动优美地联系在一起。垂直速度（在气压坐标系中以 $\\omega$ 表示）是大气动力学中的一个关键诊断变量，但它通常不直接测量，而是通过其他可观测或可预测的场（如水平散度）计算得出。这个实践练习（）将指导您从连续性方程出发，设计一个数值算法，通过对水平散度场的垂直积分来计算 $\\omega$ 的垂直廓线，这是数值天气预报模型中一项基础而重要的诊断技术。",
            "id": "4078442",
            "problem": "考虑用于数值天气预报（NWP）和全球气候模式（GCM）应用的、在气压坐标系下表述的静力学原始方程。设水平风为 $\\mathbf{v} = (u,v)$，水平散度为 $D = \\nabla \\cdot \\mathbf{v}$，气压坐标系下的垂直速度为 $\\omega = \\dfrac{D p}{D t}$，其中 $p$ 是气压。从质量连续性方程和静力平衡方程出发，推导 $\\omega$ 的垂直导数与水平散度 $D$ 之间的关系。然后，设计一个数值算法，通过向下积分计算一组离散气压层上的 $\\omega(p)$，给定：\n- 从模式顶层 $p_t$ 到下边界 $p_s$ 的严格递增的气压层数组 $\\{p_k\\}$，\n- 在相同气压层上评估的相应水平散度值数组 $\\{D_k\\}$，\n- 以及上边界条件 $\\omega(p_t) = 0$。\n\n您的推导和算法必须仅基于第一性原理（质量连续性和静力平衡），不得引用任何简化公式。您还必须确定并明确说明在气压坐标系中下边界所需的运动学边界条件，即将 $\\omega(p_s)$ 用地表气压的物质导数表示。\n\n数值实现要求：\n- 使用一致的离散求积方法从 $p_t$ 向下积分到每个 $p_k$；梯形法则是可接受的，前提是您能根据所推导的连续关系明确证明其合理性。\n- 程序必须接受以数组形式硬编码的给定测试套件，并在没有外部输入的情况下产生所要求的输出。\n\n单位和输出：\n- 散度 $D$ 的单位为 $\\text{s}^{-1}$，气压 $p$ 的单位为 $\\text{Pa}$，计算出的 $\\omega$ 必须以 $\\text{Pa}\\,\\text{s}^{-1}$ 为单位。\n- 计算不涉及角度，因此不需要角度单位。\n- 您的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表。该外层列表的每个元素本身必须是一个列表，包含一个测试案例在指定气压层上的 $\\omega$ 值（单位为 $\\text{Pa}\\,\\text{s}^{-1}$），并按从 $p_t$ 到 $p_s$ 的顺序排列（例如：$\"[[\\omega(p_1),\\omega(p_2),\\dots,\\omega(p_N)],[\\dots],[\\dots]]\"$)。\n\n测试套件：\n- 案例 A（一般情况，单调辐合）：$p = [20000, 40000, 60000, 80000, 100000]$ (单位 $\\text{Pa}$)，$D = [-1.0 \\times 10^{-6}, -1.2 \\times 10^{-6}, -1.5 \\times 10^{-6}, -1.9 \\times 10^{-6}, -2.4 \\times 10^{-6}]$ (单位 $\\text{s}^{-1}$)，$\\omega(p_t) = 0$ (单位 $\\text{Pa}\\,\\text{s}^{-1}$)。\n- 案例 B（边界条件检查，零散度）：$p = [20000, 40000, 60000, 80000, 100000]$ (单位 $\\text{Pa}$)，$D = [0.0, 0.0, 0.0, 0.0, 0.0]$ (单位 $\\text{s}^{-1}$)，$\\omega(p_t) = 0$ (单位 $\\text{Pa}\\,\\text{s}^{-1}$)。\n- 案例 C（散度变号，整层积分中性）：$p = [20000, 40000, 60000, 80000, 100000]$ (单位 $\\text{Pa}$)，$D = [2.0 \\times 10^{-6}, 1.0 \\times 10^{-6}, 0.0, -1.0 \\times 10^{-6}, -2.0 \\times 10^{-6}]$ (单位 $\\text{s}^{-1}$)，$\\omega(p_t) = 0$ (单位 $\\text{Pa}\\,\\text{s}^{-1}$)。\n\n您的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如：$\"[[\\omega\\_A(p\\_1),\\dots,\\omega\\_A(p\\_N)],[\\omega\\_B(p\\_1),\\dots,\\omega\\_B(p\\_N)],[\\omega\\_C(p\\_1),\\dots,\\omega\\_C(p\\_N)]]\"$)，其中 $\\omega\\_A$、$\\omega\\_B$ 和 $\\omega\\_C$ 分别表示案例 A、B 和 C 的解。每个 $\\omega$ 值都必须以 $\\text{Pa}\\,\\text{s}^{-1}$ 为单位。",
            "solution": "我们从适用于气压坐标系下静力学原始方程的第一性原理出发。基本定律是：\n\n1. 对于可压缩流体，高度坐标系中的质量连续性方程为\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\nabla_h \\cdot (\\rho \\mathbf{v}) + \\frac{\\partial (\\rho w)}{\\partial z} = 0,\n$$\n其中 $\\rho$ 是密度，$\\mathbf{v}=(u,v)$ 是水平速度，$w$ 是高度坐标系中的垂直速度，$\\nabla_h$ 表示水平散度算子，$z$ 是几何高度。\n\n2. 静力平衡将气压与密度和高度联系起来：\n$$\n\\frac{\\partial p}{\\partial z} = - \\rho g,\n$$\n其中 $g$ 是重力加速度。\n\n3. 气压坐标系中垂直速度的定义是气压的拉格朗日（物质）导数：\n$$\n\\omega = \\frac{D p}{D t} = \\frac{\\partial p}{\\partial t} + \\mathbf{v} \\cdot \\nabla_h p + w \\frac{\\partial p}{\\partial z}.\n$$\n在气压坐标系中，气压本身被用作垂直坐标，通过坐标变换，连续性方程在静力平衡下变得异常简洁。\n\n基于这些基础，我们将连续性方程转换到气压坐标系。在静力平衡近似下，并使用 $\\omega$ 的定义，连续性方程在气压坐标系中简化为一个紧凑且广泛使用的形式：\n$$\n\\nabla_h \\cdot \\mathbf{v} + \\frac{\\partial \\omega}{\\partial p} = 0.\n$$\n这是通过应用链式法则，利用静力关系替换 $z$ 的导数，并以单位气压而不是单位高度的质量通量来表示而推导出来的；静力关系确保了坐标变换的雅可比行列式消去了 $\\rho$ 因子，从而得到一个不再显式依赖于 $\\rho$ 的连续性方程。这个关系是从水平散度诊断垂直运动的基石。\n\n重新整理上式，得到气压垂直速度的垂直导数用水平散度表示的形式：\n$$\n\\frac{\\partial \\omega}{\\partial p} = - D,\n$$\n其中 $D = \\nabla_h \\cdot \\mathbf{v}$。\n\n向下积分算法：\n给定离散气压层 $p_1, p_2, \\dots, p_N$（其中 $p_1 = p_t$，$p_N = p_s$）以及在这些层上的散度值 $D_1, D_2, \\dots, D_N$，我们使用上边界条件 $\\omega(p_t) = 0$，从 $p_t$ 开始向下积分常微分方程 $\\dfrac{\\partial \\omega}{\\partial p} = -D$。一个二阶精确且稳健的选择是梯形法则，它通过在每个层上积分连续关系，并在相邻层之间线性近似 $D(p)$ 的积分而得到。在一个层 $[p_k, p_{k+1}]$ 上，\n$$\n\\omega(p_{k+1}) - \\omega(p_k) = \\int_{p_k}^{p_{k+1}} \\frac{\\partial \\omega}{\\partial p} \\, dp = - \\int_{p_k}^{p_{k+1}} D(p) \\, dp \\approx - \\frac{D_k + D_{k+1}}{2} \\left(p_{k+1} - p_k\\right).\n$$\n因此，在 $\\omega(p_1) = 0$ 的条件下，我们对 $k=1,2,\\dots,N-1$ 进行迭代计算：\n$$\n\\omega(p_{k+1}) = \\omega(p_k) - \\frac{D_k + D_{k+1}}{2} \\left(p_{k+1} - p_k\\right).\n$$\n这就生成了在所有层 $k = 1, \\dots, N$ 上的 $\\omega(p_k)$。\n\n气压坐标系中的下边界条件：\n物理下边界的不可穿透条件（没有法向流穿过地面）意味着在高度坐标系中，地表处的 $w=0$。在气压坐标系中，下边界位于随时间变化的地表气压 $p_s(x,y,t)$ 处。相应的运动学边界条件是，地表处的气压坐标垂直速度等于地表气压的物质导数：\n$$\n\\omega(p_s) = \\frac{D p_s}{D t} = \\frac{\\partial p_s}{\\partial t} + u_s \\frac{\\partial p_s}{\\partial x} + v_s \\frac{\\partial p_s}{\\partial y}.\n$$\n在此诊断计算中，将 $\\frac{\\partial \\omega}{\\partial p} = -D$ 从 $p_t$ 积分到 $p_s$（在 $\\omega(p_t)=0$ 条件下）得到一个 $\\omega(p_s)$ 值，该值必须等于 $\\dfrac{D p_s}{D t}$ 才能满足质量连续性和运动学边界条件。如果一个模式指定了 $\\dfrac{\\partial p_s}{\\partial t}$ 或对 $p_s$ 的约束，这就提供了所需的下边界条件；否则，积分提供了隐含的 $\\omega(p_s)$，由此可得出 $\\dfrac{D p_s}{D t}$。\n\n单位一致性：\n- $D$ 的单位是 $\\text{s}^{-1}$。\n- $p$ 的单位是 $\\text{Pa}$。\n- 积分 $\\int -D \\, dp$ 得到的 $\\omega$ 单位为 $\\text{Pa}\\,\\text{s}^{-1}$，这与 $\\omega = \\dfrac{D p}{D t}$ 一致。\n\n测试案例及预期的定性行为：\n- 案例 A：所有层中 $D0$（水平辐合）应产生随高度下降而增大的 $\\omega>0$，代表气压坐标系中的下沉运动（气块轨迹上的气压增加）。\n- 案例 B：$D=0$ 导致各处 $\\omega=0$，且下边界条件为 $\\omega(p_s)=0$。\n- 案例 C：$D$ 变号，且垂直积分的散度近似为零，导致 $\\omega(p_s) \\approx 0$，廓线表现为 $\\omega$ 在高层可能为负，在低层为正。\n\n算法实现细节：\n- 验证 $p$ 是严格递增的（$p_{k+1} > p_k$），以确保向下积分与物理方向一致。\n- 初始化 $\\omega(p_1)=0$（单位 $\\text{Pa}\\,\\text{s}^{-1}$）。\n- 对每对相邻的气压层应用梯形更新，以获得完整的 $\\omega$ 廓线。\n- 为每个测试案例返回 $\\omega$ 值的列表（单位 $\\text{Pa}\\,\\text{s}^{-1}$）。\n- 每个列表中的最后一个值等于 $\\omega(p_s)$，满足运动学下边界条件 $\\omega(p_s)=\\dfrac{D p_s}{D t}$。\n\n所提供的程序为指定的测试套件计算这些廓线，并打印单行输出，该行包含一个列表的列表，其中含有 $\\omega$ 的值（每个值的单位均为 $\\text{Pa}\\,\\text{s}^{-1}$），并按从 $p_t$ 到 $p_s$ 的顺序排列。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef integrate_omega(pressures_pa, divergence_s_inv, omega_top_pa_per_s=0.0):\n    \"\"\"\n    Compute omega(p) by downward integration using the trapezoidal rule.\n    pressures_pa: 1D array-like of pressures [Pa], strictly increasing from top to bottom.\n    divergence_s_inv: 1D array-like of horizontal divergence D [s^-1], same length as pressures.\n    omega_top_pa_per_s: omega at the top boundary [Pa s^-1], default 0.\n    Returns: list of omega values [Pa s^-1] at each pressure level.\n    \"\"\"\n    p = np.array(pressures_pa, dtype=float)\n    D = np.array(divergence_s_inv, dtype=float)\n    if p.ndim != 1 or D.ndim != 1 or p.size != D.size or p.size  1:\n        raise ValueError(\"Invalid input shapes for pressures/divergence.\")\n    # Ensure strictly increasing pressures\n    if p.size > 1 and not np.all(np.diff(p) > 0):\n        raise ValueError(\"Pressures must be strictly increasing (top to bottom).\")\n\n    omega = np.zeros_like(p, dtype=float)\n    if p.size == 0:\n        return []\n    omega[0] = float(omega_top_pa_per_s)\n    # Trapezoidal downward integration of ∂ω/∂p = -D\n    for k in range(0, p.size - 1):\n        dp = p[k + 1] - p[k]\n        D_avg = 0.5 * (D[k] + D[k + 1])\n        domega = - D_avg * dp\n        omega[k + 1] = omega[k] + domega\n\n    # Clean small numerical artifacts like -0.0 to +0.0\n    omega[np.isclose(omega, 0.0, atol=1e-15)] = 0.0\n    return [float(x) for x in omega]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: monotonic convergence (negative D)\n        (\n            [20000.0, 40000.0, 60000.0, 80000.0, 100000.0],  # pressures [Pa]\n            [-1.0e-6, -1.2e-6, -1.5e-6, -1.9e-6, -2.4e-6],   # divergence [s^-1]\n            0.0                                              # omega at top [Pa s^-1]\n        ),\n        # Case B: zero divergence\n        (\n            [20000.0, 40000.0, 60000.0, 80000.0, 100000.0],\n            [0.0, 0.0, 0.0, 0.0, 0.0],\n            0.0\n        ),\n        # Case C: sign-changing divergence, column-integrated neutrality\n        (\n            [20000.0, 40000.0, 60000.0, 80000.0, 100000.0],\n            [2.0e-6, 1.0e-6, 0.0, -1.0e-6, -2.0e-6],\n            0.0\n        ),\n    ]\n\n    results = []\n    for pressures, divergences, omega_top in test_cases:\n        omega_profile = integrate_omega(pressures, divergences, omega_top)\n        results.append(omega_profile)\n\n    # Final print statement in the exact required format.\n    # Print as a single line: list of lists of floats.\n    def format_list(lst):\n        return \"[\" + \",\".join(f\"{x:.12g}\" for x in lst) + \"]\"\n    print(\"[\" + \",\".join(format_list(r) for r in results) + \"]\")\n\nsolve()\n```"
        },
        {
            "introduction": "计算出垂直速度 $\\omega$ 后，一个自然而然的问题是：它对大气状态有何物理影响？其中最直接和最重要的效应之一便是绝热温度变化，这是控制大气稳定度和云形成的关键过程。这个练习（）将动力学与热力学联系起来，要求您从热力学第一定律出发，推导并量化由气块垂直运动引起的温度倾向，从而巩固对上升运动导致绝热冷却、下沉运动导致绝热增温这一核心概念的理解。",
            "id": "4078428",
            "problem": "考虑一个在数值天气预报（NWP）和气候模拟中使用的气压坐标系原始方程框架下的对流层中层气块。从理想气体的热力学第一定律和气压坐标系中垂直运动的定义出发，推导垂直运动对给定气压层上局地温度倾向的干绝热贡献。清晰地陈述垂直运动的符号约定，并使用比容的静力理想气体关系。然后，对于一个位于气压 $p=600\\,\\mathrm{hPa}$、温度 $T=270\\,\\mathrm{K}$，并正在经历以 $\\omega = \\mathrm{D}p/\\mathrm{D}t = -0.1\\,\\mathrm{Pa}\\,\\mathrm{s}^{-1}$ 为特征的大尺度上升运动的气块，评估垂直运动对局地温度倾向的贡献量级，单位为 $\\mathrm{K}\\,\\mathrm{s}^{-1}$。取干空气常数 $\\kappa = R_{d}/c_{p} = 0.286$，并在计算中使用帕斯卡（Pascals）为单位的气压 $p$。将最终数值答案四舍五入至四位有效数字。在你的推导中，解释上升运动（$\\omega0$）和下沉运动（$\\omega>0$）时该倾向的符号，但最终数值答案只提供其大小。",
            "solution": "首先对问题陈述进行验证。\n\n**步骤 1：提取给定条件**\n- 系统：对流层中层气块。\n- 框架：气压坐标系中的原始方程。\n- 起始原理：理想气体的热力学第一定律，气压坐标系中垂直运动的定义（$\\omega = \\mathrm{D}p/\\mathrm{D}t$）。\n- 任务：推导垂直运动对局地温度倾向的干绝热贡献。\n- 辅助关系：比容的静力理想气体关系。\n- 需要在以下条件下进行数值评估：\n    - 气压：$p = 600\\,\\mathrm{hPa}$\n    - 温度：$T = 270\\,\\mathrm{K}$\n    - 垂直运动：$\\omega = -0.1\\,\\mathrm{Pa}\\,\\mathrm{s}^{-1}$\n    - 干空气常数比：$\\kappa = R_{d}/c_{p} = 0.286$\n- 要求输出：以 $\\mathrm{K}\\,\\mathrm{s}^{-1}$ 为单位的倾向大小，并四舍五入至四位有效数字。\n- 要求解释：上升运动（$\\omega0$）和下沉运动（$\\omega>0$）时该倾向的符号。\n\n**步骤 2：使用提取的给定条件进行验证**\n该问题具有科学依据，植根于数值天气预报中使用的大气热力学和动力学基本原理。所有给定的值（$p$, $T$, $\\omega$, $\\kappa$）对于地球对流层中层都是物理上现实的。该问题提法明确、客观、自洽，包含足够的信息以进行所要求的推导和计算。不存在矛盾、模糊不清或事实错误。\n\n**步骤 3：结论与行动**\n该问题被认定为有效。将提供一个完整的、有理有据的解答。\n\n**推导**\n\n推导从单位质量理想气体的热力学第一定律开始，可以写成：\n$$\n\\mathrm{d}q = c_p \\mathrm{d}T - \\alpha \\mathrm{d}p\n$$\n其中 $\\mathrm{d}q$ 是每单位质量增加的非绝热加热量，$c_p$ 是定压比热，$T$ 是绝对温度，$\\alpha$ 是比容，$p$ 是气压。\n\n对于干绝热过程，与环境没有热量交换，因此 $\\mathrm{d}q = 0$。方程简化为：\n$$\nc_p \\mathrm{d}T = \\alpha \\mathrm{d}p\n$$\n为了求出移动气块的温度变化率（拉格朗日导数或物质导数），我们除以时间微分 $\\mathrm{d}t$：\n$$\nc_p \\frac{\\mathrm{D}T}{\\mathrm{D}t} = \\alpha \\frac{\\mathrm{D}p}{\\mathrm{D}t}\n$$\n在气压坐标系中，垂直运动 $\\omega$ 定义为气压的物质导数，即 $\\omega \\equiv \\mathrm{D}p/\\mathrm{D}t$。代入此定义可得：\n$$\nc_p \\frac{\\mathrm{D}T}{\\mathrm{D}t} = \\alpha \\omega\n$$\n整理后得到气块的温度倾向为：\n$$\n\\frac{\\mathrm{D}T}{\\mathrm{D}t} = \\frac{\\alpha}{c_p} \\omega\n$$\n物质导数 $\\mathrm{D}/\\mathrm{D}t$ 代表随运动的总变化，在气压坐标系中可以展开为局地项和平流项：\n$$\n\\frac{\\mathrm{D}}{\\mathrm{D}t} = \\frac{\\partial}{\\partial t} + \\mathbf{v}_h \\cdot \\nabla_p + \\omega \\frac{\\partial}{\\partial p}\n$$\n其中 $\\partial/\\partial t$ 是在固定点 $(x, y, p)$ 的局地（欧拉）时间导数，$\\mathbf{v}_h$ 是水平速度矢量，$\\nabla_p$ 是等压面上的水平梯度算子。\n\n将此展开式应用于温度 $T$，我们得到：\n$$\n\\frac{\\mathrm{D}T}{\\mathrm{D}t} = \\frac{\\partial T}{\\partial t} + \\mathbf{v}_h \\cdot \\nabla_p T + \\omega \\frac{\\partial T}{\\partial p}\n$$\n将其代回我们的热力学方程，得到完整的热力学能量方程：\n$$\n\\frac{\\partial T}{\\partial t} + \\mathbf{v}_h \\cdot \\nabla_p T + \\omega \\frac{\\partial T}{\\partial p} = \\frac{\\alpha}{c_p} \\omega\n$$\n通过整理各项，可以分离出局地温度倾向 $\\partial T/\\partial t$：\n$$\n\\frac{\\partial T}{\\partial t} = -\\mathbf{v}_h \\cdot \\nabla_p T - \\omega \\frac{\\partial T}{\\partial p} + \\frac{\\alpha}{c_p} \\omega\n$$\n右边的各项分别代表水平温度平流、垂直温度平流以及由绝热压缩/膨胀引起的温度变化。问题要求的是“垂直运动的干绝热贡献”，这正是最后一项，它代表了由于气块垂直位移而引起的加热或冷却的物理过程。\n$$\n\\left( \\frac{\\partial T}{\\partial t} \\right)_{\\text{adiabatic vert}} = \\frac{\\alpha}{c_p} \\omega\n$$\n接下来，我们使用干空气的理想气体定律 $pv = R_d T$，其中 $v$ 是比容（此处用 $\\alpha$ 表示）。因此，$\\alpha = R_d T / p$。将其代入我们的表达式中得到：\n$$\n\\left( \\frac{\\partial T}{\\partial t} \\right)_{\\text{adiabatic vert}} = \\frac{1}{c_p} \\left( \\frac{R_d T}{p} \\right) \\omega = \\frac{R_d}{c_p} \\frac{T}{p} \\omega\n$$\n使用给定的常数 $\\kappa = R_d / c_p$，我们得到倾向的最终表达式：\n$$\n\\left( \\frac{\\partial T}{\\partial t} \\right)_{\\text{adiabatic vert}} = \\frac{\\kappa T}{p} \\omega\n$$\n\n**符号解释**\n\n$\\omega$ 的符号约定至关重要。由于在大气中气压随高度增加而减小，一个向上移动（上升）的气块会经历气压的降低。因此，上升运动对应于 $\\omega = \\mathrm{D}p/\\mathrm{D}t  0$。相反，一个向下移动（下沉）的气块会经历气压的增加，因此下沉运动对应于 $\\omega > 0$。\n\n在推导出的表达式中，$\\kappa$、绝对温度 $T$ 和绝对气压 $p$ 均为正值。因此，温度倾向的符号完全由 $\\omega$ 的符号决定。\n- 对于**上升运动**，$\\omega  0$，导致负倾向 $\\left( \\partial T / \\partial t \\right)_{\\text{adiabatic vert}}  0$。这代表**绝热冷却**，因为上升的气块在较低的环境气压下膨胀，对环境做功，从而损失内能。\n- 对于**下沉运动**，$\\omega > 0$，导致正倾向 $\\left( \\partial T / \\partial t \\right)_{\\text{adiabatic vert}} > 0$。这代表**绝热增温**，因为下沉的气块被较高的环境气压压缩，环境对其做功，从而获得内能。\n\n**数值评估**\n\n我们有以下给定值：\n- $\\kappa = 0.286$\n- $T = 270\\,\\mathrm{K}$\n- $p = 600\\,\\mathrm{hPa} = 600 \\times 100\\,\\mathrm{Pa} = 60000\\,\\mathrm{Pa}$\n- $\\omega = -0.1\\,\\mathrm{Pa}\\,\\mathrm{s}^{-1}$\n\n将这些值代入推导出的方程：\n$$\n\\left( \\frac{\\partial T}{\\partial t} \\right)_{\\text{adiabatic vert}} = \\frac{(0.286) (270\\,\\mathrm{K})}{60000\\,\\mathrm{Pa}} (-0.1\\,\\mathrm{Pa}\\,\\mathrm{s}^{-1})\n$$\n$$\n\\left( \\frac{\\partial T}{\\partial t} \\right)_{\\text{adiabatic vert}} = \\frac{77.22\\,\\mathrm{K}}{60000\\,\\mathrm{Pa}} (-0.1\\,\\mathrm{Pa}\\,\\mathrm{s}^{-1})\n$$\n$$\n\\left( \\frac{\\partial T}{\\partial t} \\right)_{\\text{adiabatic vert}} = (0.001287\\,\\mathrm{K}\\,\\mathrm{Pa}^{-1}) (-0.1\\,\\mathrm{Pa}\\,\\mathrm{s}^{-1})\n$$\n$$\n\\left( \\frac{\\partial T}{\\partial t} \\right)_{\\text{adiabatic vert}} = -0.0001287\\,\\mathrm{K}\\,\\mathrm{s}^{-1} = -1.287 \\times 10^{-4}\\,\\mathrm{K}\\,\\mathrm{s}^{-1}\n$$\n问题要求的是这个贡献的大小。\n$$\n\\left| \\left( \\frac{\\partial T}{\\partial t} \\right)_{\\text{adiabatic vert}} \\right| = |-1.287 \\times 10^{-4}\\,\\mathrm{K}\\,\\mathrm{s}^{-1}| = 1.287 \\times 10^{-4}\\,\\mathrm{K}\\,\\mathrm{s}^{-1}\n$$\n此结果已按要求表示为四位有效数字。",
            "answer": "$$\n\\boxed{1.287 \\times 10^{-4}}\n$$"
        },
        {
            "introduction": "在诊断大气运动时，一个能够综合反映流动动力学和热力学特性的综合性物理量显得尤为强大，而位涡（PV）正是这样的量。在绝热无摩擦的假设下，位涡的守恒性使其成为追踪气团和诊断天气系统（如气旋发展）的宝贵工具。这项实践（）将引导您推导Ertel位涡在天气尺度分析中最常用的近似形式，并利用典型的气象分析数据进行实际计算，为您提供一项进行天气分析和动力诊断的关键技能。",
            "id": "4078408",
            "problem": "在纬度 $\\phi = 50^{\\circ}\\,\\mathrm{N}$ 的中纬度地区，对 $p = 500\\,\\mathrm{hPa}$ 的 $p$ 坐标面进行天气学分析。风场分析得出等压面上的相对涡度垂直分量为 $\\zeta = 3.0 \\times 10^{-5}\\,\\mathrm{s}^{-1}$。附近的无线电探空仪探测报告了在 $p = 700\\,\\mathrm{hPa}$ 处的位温值为 $\\theta = 316\\,\\mathrm{K}$，在 $p = 500\\,\\mathrm{hPa}$ 处的位温值为 $\\theta = 336\\,\\mathrm{K}$。\n\n从高度坐标中的埃特尔位涡（PV）定义、原始方程中的静力学关系以及涡度的运动学定义出发，推导在压力坐标中仅依赖于绝对涡度垂直分量和位温垂直梯度的埃特尔位涡表达式。在您的推导中，明确陈述并使用适用于天气尺度流动的、有物理依据的假设，这些假设允许您忽略涉及位温水平梯度和垂直风切变的斜压项和倾斜项。然后，使用以下常数计算该位置 $p = 500\\,\\mathrm{hPa}$ 面上的埃特尔位涡：\n- 地球自转速率 $\\Omega = 7.292 \\times 10^{-5}\\,\\mathrm{s}^{-1}$，\n- 重力加速度 $g = 9.81\\,\\mathrm{m}\\,\\mathrm{s}^{-2}$。\n\n使用科里奥利参数的传统定义 $f = 2 \\Omega \\sin \\phi$。用位涡单位（PVU）表示您的最终数值结果，其中 $1\\,\\mathrm{PVU} = 10^{-6}\\,\\mathrm{K}\\,\\mathrm{m}^{2}\\,\\mathrm{kg}^{-1}\\,\\mathrm{s}^{-1}$。将您的答案四舍五入到三位有效数字。",
            "solution": "题目要求推导适用于天气尺度分析的压力坐标系下埃特尔位涡（PV）的近似表达式，然后使用给定的大气数据进行数值计算。\n\n### 第 1 步：提取已知条件\n题目中给出了以下数据：\n- p 坐标面上的分析层：$p = 500\\,\\mathrm{hPa}$\n- 纬度：$\\phi = 50^{\\circ}\\,\\mathrm{N}$\n- 等压面上的相对涡度垂直分量：$\\zeta = 3.0 \\times 10^{-5}\\,\\mathrm{s}^{-1}$\n- 在 $p_1 = 700\\,\\mathrm{hPa}$ 处的位温：$\\theta_1 = 316\\,\\mathrm{K}$\n- 在 $p_2 = 500\\,\\mathrm{hPa}$ 处的位温：$\\theta_2 = 336\\,\\mathrm{K}$\n- 地球自转速率：$\\Omega = 7.292 \\times 10^{-5}\\,\\mathrm{s}^{-1}$\n- 重力加速度：$g = 9.81\\,\\mathrm{m}\\,\\mathrm{s}^{-2}$\n- 科里奥利参数的定义：$f = 2 \\Omega \\sin \\phi$\n- 位涡单位的定义：$1\\,\\mathrm{PVU} = 10^{-6}\\,\\mathrm{K}\\,\\mathrm{m}^{2}\\,\\mathrm{kg}^{-1}\\,\\mathrm{s}^{-1}$\n\n### 第 2 步：使用提取的已知条件进行验证\n该问题具有科学依据，提法明确且客观。这是动力气象学中的一个标准问题，涉及基本量埃特尔位涡的推导和应用。该问题为唯一解提供了所有必要的数据和定义。规定的物理假设（静力平衡，忽略天气尺度流动的特定项）是标准的，并且适用于此背景。所提供的数值对于地球中纬度大气是物理上真实的。该问题不违反任何无效性标准。\n\n### 第 3 步：结论和行动\n该问题有效。将提供完整解答。\n\n### 第 1 部分：压力坐标中埃特尔位涡的推导\n\n高度（$z$）坐标中的埃特尔位涡（$PV$）定义为：\n$$\nPV = \\frac{1}{\\rho} \\boldsymbol{\\omega}_a \\cdot \\boldsymbol{\\nabla}\\theta\n$$\n其中 $\\rho$ 是空气密度，$\\boldsymbol{\\omega}_a$ 是三维绝对涡度矢量，$\\boldsymbol{\\nabla}\\theta$ 是位温 $\\theta$ 的三维梯度。\n\n绝对涡度矢量 $\\boldsymbol{\\omega}_a$ 是相对涡度矢量（$\\boldsymbol{\\omega}_r = \\boldsymbol{\\nabla} \\times \\mathbf{v}$）和行星涡度（$2\\boldsymbol{\\Omega}$）之和：\n$$\n\\boldsymbol{\\omega}_a = \\boldsymbol{\\nabla} \\times \\mathbf{v} + 2\\boldsymbol{\\Omega}\n$$\n在一个局部笛卡尔坐标系 $(x, y, z)$ 中，单位矢量为 $(\\mathbf{i}, \\mathbf{j}, \\mathbf{k})$，对于天气尺度运动，忽略地球自转矢量的水平分量，我们可以写出：\n$$\n\\boldsymbol{\\omega}_a = \\left(\\frac{\\partial w}{\\partial y} - \\frac{\\partial v}{\\partial z}\\right)\\mathbf{i} + \\left(\\frac{\\partial u}{\\partial z} - \\frac{\\partial w}{\\partial x}\\right)\\mathbf{j} + \\left(f + \\frac{\\partial v}{\\partial x} - \\frac{\\partial u}{\\partial y}\\right)\\mathbf{k}\n$$\n其中 $u, v, w$ 分别是 $x, y, z$ 方向上的风分量，$f = 2\\Omega\\sin\\phi$ 是科里奥利参数。设 $\\zeta = \\frac{\\partial v}{\\partial x} - \\frac{\\partial u}{\\partial y}$ 为相对涡度的垂直分量。\n\n位温的梯度是：\n$$\n\\boldsymbol{\\nabla}\\theta = \\frac{\\partial \\theta}{\\partial x}\\mathbf{i} + \\frac{\\partial \\theta}{\\partial y}\\mathbf{j} + \\frac{\\partial \\theta}{\\partial z}\\mathbf{k}\n$$\n\n点积 $\\boldsymbol{\\omega}_a \\cdot \\boldsymbol{\\nabla}\\theta$ 于是为：\n$$\n\\boldsymbol{\\omega}_a \\cdot \\boldsymbol{\\nabla}\\theta = \\left(\\frac{\\partial w}{\\partial y} - \\frac{\\partial v}{\\partial z}\\right)\\frac{\\partial \\theta}{\\partial x} + \\left(\\frac{\\partial u}{\\partial z} - \\frac{\\partial w}{\\partial x}\\right)\\frac{\\partial \\theta}{\\partial y} + (f+\\zeta)\\frac{\\partial \\theta}{\\partial z}\n$$\n题目指明我们应使用适用于天气尺度流动的假设。\n1.  **尺度分析**：对于大尺度天气运动，$\\theta$ 的水平变化远小于其垂直变化（$|\\boldsymbol{\\nabla}_h \\theta| \\ll |\\partial\\theta/\\partial z|$）。此外，涉及垂直风切变（$|\\partial u/\\partial z|, |\\partial v/\\partial z|$）的项是显著的，但涉及垂直速度水平梯度（$|\\partial w/\\partial x|, |\\partial w/\\partial y|$）的项非常小。因此，点积展开式中的前两项，即倾斜项和斜压项，比第三项小一个数量级。\n    $$\n    \\left| \\left(\\frac{\\partial w}{\\partial y} - \\frac{\\partial v}{\\partial z}\\right)\\frac{\\partial \\theta}{\\partial x} + \\left(\\frac{\\partial u}{\\partial z} - \\frac{\\partial w}{\\partial x}\\right)\\frac{\\partial \\theta}{\\partial y} \\right| \\ll \\left| (f+\\zeta)\\frac{\\partial \\theta}{\\partial z} \\right|\n    $$\n    忽略这些较小的项，$PV$ 的表达式简化为：\n    $$\n    PV \\approx \\frac{1}{\\rho}(f+\\zeta_z)\\frac{\\partial \\theta}{\\partial z}\n    $$\n    其中 $\\zeta_z$ 表示 z 坐标系中相对涡度的垂直分量。\n\n2.  **静力平衡**：对于天气尺度运动，大气近似处于静力平衡状态。原始方程中的静力学关系是：\n    $$\n    \\frac{\\partial p}{\\partial z} = -\\rho g\n    $$\n为了将表达式从高度坐标转换为压力坐标，我们对位温的垂直导数使用链式法则：\n$$\n\\frac{\\partial \\theta}{\\partial z} = \\frac{\\partial \\theta}{\\partial p} \\frac{\\partial p}{\\partial z}\n$$\n将静力学关系代入链式法则表达式中，得到：\n$$\n\\frac{\\partial \\theta}{\\partial z} = \\frac{\\partial \\theta}{\\partial p} (-\\rho g)\n$$\n现在，我们将其代入 $PV$ 的简化表达式中：\n$$\nPV \\approx \\frac{1}{\\rho}(f+\\zeta_z) \\left( -\\rho g \\frac{\\partial \\theta}{\\partial p} \\right)\n$$\n密度 $\\rho$ 被消去，得到压力坐标中埃特尔位涡的表达式：\n$$\nPV \\approx -g (f+\\zeta_p) \\frac{\\partial \\theta}{\\partial p}\n$$\n这里，我们用等压面上的相对涡度垂直分量 $\\zeta_p$ 替换了 $\\zeta_z$，因为对于天气尺度运动，它们近似相等。给定的值 $\\zeta$ 是在等压面上的，对应于 $\\zeta_p$。\n\n这就是所求的表达式，它仅依赖于等压面上的绝对涡度垂直分量 $\\eta_p = f+\\zeta_p$ 和压力坐标中的位温垂直梯度 $\\frac{\\partial \\theta}{\\partial p}$。\n\n### 第 2 部分：埃特尔位涡的数值计算\n\n我们使用推导出的公式 $PV = -g(f+\\zeta)\\frac{\\partial \\theta}{\\partial p}$ 和给定的数值。\n\n1.  **计算科里奥利参数 $f$**：\n    $$\n    f = 2 \\Omega \\sin \\phi = 2 \\times (7.292 \\times 10^{-5}\\,\\mathrm{s}^{-1}) \\times \\sin(50^{\\circ})\n    $$\n    使用 $\\sin(50^{\\circ}) \\approx 0.766044$：\n    $$\n    f \\approx 2 \\times (7.292 \\times 10^{-5}\\,\\mathrm{s}^{-1}) \\times 0.766044 \\approx 1.11736 \\times 10^{-4}\\,\\mathrm{s}^{-1}\n    $$\n\n2.  **计算绝对涡度 $(f+\\zeta)$**：\n    $$\n    f + \\zeta \\approx (1.11736 \\times 10^{-4}\\,\\mathrm{s}^{-1}) + (3.0 \\times 10^{-5}\\,\\mathrm{s}^{-1}) = 1.41736 \\times 10^{-4}\\,\\mathrm{s}^{-1}\n    $$\n\n3.  **近似位温的垂直梯度 $\\frac{\\partial \\theta}{\\partial p}$**：\n    我们使用基于无线电探空数据的有限差分近似：\n    $$\n    \\frac{\\partial \\theta}{\\partial p} \\approx \\frac{\\Delta \\theta}{\\Delta p} = \\frac{\\theta_2 - \\theta_1}{p_2 - p_1} = \\frac{336\\,\\mathrm{K} - 316\\,\\mathrm{K}}{500\\,\\mathrm{hPa} - 700\\,\\mathrm{hPa}} = \\frac{20\\,\\mathrm{K}}{-200\\,\\mathrm{hPa}}\n    $$\n    $$\n    \\frac{\\partial \\theta}{\\partial p} = -0.1\\,\\mathrm{K}\\,\\mathrm{hPa}^{-1}\n    $$\n    为了使用国际单位制（SI），我们将百帕（hPa）转换为帕斯卡（Pa），其中 $1\\,\\mathrm{hPa} = 100\\,\\mathrm{Pa}$：\n    $$\n    \\frac{\\partial \\theta}{\\partial p} = -0.1\\,\\mathrm{K}\\,(100\\,\\mathrm{Pa})^{-1} = -0.001\\,\\mathrm{K}\\,\\mathrm{Pa}^{-1} = -1.0 \\times 10^{-3}\\,\\mathrm{K}\\,\\mathrm{Pa}^{-1}\n    $$\n\n4.  **计算位涡 $PV$**：\n    将数值代入公式：\n    $$\n    PV \\approx -g (f+\\zeta) \\frac{\\partial \\theta}{\\partial p}\n    $$\n    $$\n    PV \\approx -(9.81\\,\\mathrm{m}\\,\\mathrm{s}^{-2}) \\times (1.41736 \\times 10^{-4}\\,\\mathrm{s}^{-1}) \\times (-1.0 \\times 10^{-3}\\,\\mathrm{K}\\,\\mathrm{Pa}^{-1})\n    $$\n    单位是 $(\\mathrm{m}\\,\\mathrm{s}^{-2}) \\cdot (\\mathrm{s}^{-1}) \\cdot (\\mathrm{K}\\,\\mathrm{Pa}^{-1}) = \\mathrm{K}\\,\\mathrm{m}\\,\\mathrm{s}^{-3}\\,\\mathrm{Pa}^{-1}$。因为 $1\\,\\mathrm{Pa} = 1\\,\\mathrm{kg}\\,\\mathrm{m}^{-1}\\,\\mathrm{s}^{-2}$，所以 $1\\,\\mathrm{Pa}^{-1} = 1\\,\\mathrm{kg}^{-1}\\,\\mathrm{m}\\,\\mathrm{s}^{2}$。因此 PV 的单位是 $\\mathrm{K}\\,\\mathrm{m}\\,\\mathrm{s}^{-3}\\,(\\mathrm{kg}^{-1}\\,\\mathrm{m}\\,\\mathrm{s}^{2}) = \\mathrm{K}\\,\\mathrm{m}^{2}\\,\\mathrm{kg}^{-1}\\,\\mathrm{s}^{-1}$，这是一致的。\n    $$\n    PV \\approx 9.81 \\times 1.41736 \\times 10^{-4} \\times 1.0 \\times 10^{-3} \\,\\mathrm{K}\\,\\mathrm{m}^{2}\\,\\mathrm{kg}^{-1}\\,\\mathrm{s}^{-1}\n    $$\n    $$\n    PV \\approx 1.3904... \\times 10^{-6}\\,\\mathrm{K}\\,\\mathrm{m}^{2}\\,\\mathrm{kg}^{-1}\\,\\mathrm{s}^{-1}\n    $$\n\n5.  **用位涡单位（PVU）表示结果**：\n    给定 $1\\,\\mathrm{PVU} = 10^{-6}\\,\\mathrm{K}\\,\\mathrm{m}^{2}\\,\\mathrm{kg}^{-1}\\,\\mathrm{s}^{-1}$：\n    $$\n    PV \\approx \\frac{1.3904... \\times 10^{-6}}{10^{-6}} \\,\\mathrm{PVU} \\approx 1.3904... \\,\\mathrm{PVU}\n    $$\n\n四舍五入到三位有效数字，埃特尔位涡为 $1.39\\,\\mathrm{PVU}$。",
            "answer": "$$\n\\boxed{1.39}\n$$"
        }
    ]
}