{
    "hands_on_practices": [
        {
            "introduction": "任何波动现象的分析都始于其“主宰方程”——频散关系。本练习将引导你从流体动力学基本方程出发，亲手推导出惯性重力波的频散关系。这个过程将揭示波的频率 $\\omega$ 如何依赖于其水平波数 $k_{h}$ 和垂直波数 $m$，为理解波的传播特性奠定坚实的理论基础。",
            "id": "4054689",
            "problem": "考虑一个用于数值天气预报和气候模拟的、代表中纬度大气柱的、在f平面上的稳定分层、无粘、旋转的布辛涅斯克流体。背景具有恒定的参考密度 $\\rho_{0}$ 和恒定的浮力频率 $N$。设 $(u,v,w)$ 为扰动速度分量，$p$ 为扰动压力，$b$ 为浮力。线性化方程为动量方程\n$$\\frac{\\partial u}{\\partial t} - f\\,v = -\\frac{1}{\\rho_{0}}\\,\\frac{\\partial p}{\\partial x}, \\qquad \\frac{\\partial v}{\\partial t} + f\\,u = -\\frac{1}{\\rho_{0}}\\,\\frac{\\partial p}{\\partial y}, \\qquad \\frac{\\partial w}{\\partial t} = -\\frac{1}{\\rho_{0}}\\,\\frac{\\partial p}{\\partial z} + b,$$\n浮力方程\n$$\\frac{\\partial b}{\\partial t} + N^{2}\\,w = 0,$$\n和连续性方程\n$$\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} + \\frac{\\partial w}{\\partial z} = 0.$$\n假设平面波解的形式为 $\\exp\\!\\big(i(k x + l y + m z - \\omega t)\\big)$，其中 $k$ 和 $l$ 是实水平波数，$m$ 是垂直波数，$\\omega$ 是角频率。定义水平波数大小 $k_{h} \\equiv \\sqrt{k^{2} + l^{2}}$。从以上方程出发，推导惯性重力波的色散关系，该关系对于固定的 $N$ 和 $f$ 将 $\\omega$ 与 $(k_{h}, m)$ 联系起来，并用它来分析当 $k_{h}$ 保持不变时 $\\omega$ 如何随 $m$ 变化。然后，通过取 $m^{2} \\gg k_{h}^{2}$ 并相应地简化色散关系，确定 $\\omega$ 的静力学极限。以弧度每秒为单位表示最终的角频率表达式。你的最终答案必须是一个单一的闭合形式表达式或一对闭合形式表达式。如果提供两个表达式（完整的色散关系及其静力学极限形式），请将它们一起写成一个行矩阵。不需要进行数值计算或四舍五入。",
            "solution": "我们从f平面上的线性化旋转布辛涅斯克系统开始，该系统具有恒定的浮力频率 $N$。在平面波拟设 $\\exp\\!\\big(i(k x + l y + m z - \\omega t)\\big)$ 下，所有空间导数的作用等同于乘以 $i$ 和相应的波数，而时间导数的作用等同于乘以 $-i \\omega$。为了代数上的方便，定义 $\\phi \\equiv p/\\rho_{0}$。变换后的方程变为\n$$-i \\omega\\,u - f\\,v = -i k\\,\\phi, \\qquad -i \\omega\\,v + f\\,u = -i l\\,\\phi,$$\n$$-i \\omega\\,w = -i m\\,\\phi + b,$$\n$$-i \\omega\\,b + N^{2}\\,w = 0,$$\n$$i k\\,u + i l\\,v + i m\\,w = 0.$$\n从浮力方程，我们解出用 $w$ 表示的 $b$：\n$$-i \\omega\\,b + N^{2}\\,w = 0 \\quad \\Longrightarrow \\quad b = \\frac{N^{2}}{i \\omega}\\,w = -i\\,\\frac{N^{2}}{\\omega}\\,w.$$\n将 $b$ 代入垂直动量方程以消去 $b$：\n$$-i \\omega\\,w = -i m\\,\\phi - i\\,\\frac{N^{2}}{\\omega}\\,w.$$\n两边同乘以 $i$ 得到一个实代数关系，\n$$\\omega\\,w = m\\,\\phi + \\frac{N^{2}}{\\omega}\\,w,$$\n并重新整理以用 $w$ 表示 $\\phi$：\n$$m\\,\\phi = \\frac{\\omega^{2} - N^{2}}{\\omega}\\,w \\quad \\Longrightarrow \\quad \\phi = \\frac{\\omega^{2} - N^{2}}{\\omega\\,m}\\,w.$$\n接下来，使用水平动量方程将水平流与压力场联系起来，然后利用连续性方程连接水平和垂直运动。水平动量系统可以写成矩阵形式\n$$\\begin{pmatrix} -i \\omega  -f \\\\ f  -i \\omega \\end{pmatrix} \\begin{pmatrix} u \\\\ v \\end{pmatrix} = -i \\begin{pmatrix} k \\\\ l \\end{pmatrix} \\phi.$$\n对这个 $2 \\times 2$ 矩阵求逆。其行列式为 $(-i \\omega)^{2} + f^{2} = -\\omega^{2} + f^{2}$。逆矩阵是\n$$\\frac{1}{-\\omega^{2} + f^{2}} \\begin{pmatrix} -i \\omega  f \\\\ -f  -i \\omega \\end{pmatrix}.$$\n相乘以得到 $u$ 和 $v$，\n$$u = \\frac{(-i \\omega)(-i k \\phi) + f(-i l \\phi)}{-\\omega^{2} + f^{2}} = \\frac{-\\omega\\,k\\,\\phi - i f\\,l\\,\\phi}{-\\omega^{2} + f^{2}},$$\n$$v = \\frac{-f(-i k \\phi) + (-i \\omega)(-i l \\phi)}{-\\omega^{2} + f^{2}} = \\frac{i f\\,k\\,\\phi - \\omega\\,l\\,\\phi}{-\\omega^{2} + f^{2}}.$$\n构造连续性组合 $k u + l v$，由于虚数交叉项的抵消，该式得以简化：\n$$k u + l v = \\frac{-\\omega (k^{2} + l^{2}) \\phi}{-\\omega^{2} + f^{2}} = \\frac{\\omega\\,k_{h}^{2}\\,\\phi}{\\omega^{2} - f^{2}}.$$\n连续性要求 $k u + l v + m w = 0$，因此\n$$k u + l v = -m\\,w.$$\n结合最后两个结果，通过 $k_{h}$ 和 $m$ 关联 $\\phi$ 和 $w$：\n$$-m\\,w = \\frac{\\omega\\,k_{h}^{2}\\,\\phi}{\\omega^{2} - f^{2}} \\quad \\Longrightarrow \\quad \\phi = -\\frac{(\\omega^{2} - f^{2})\\,m}{\\omega\\,k_{h}^{2}}\\,w.$$\n我们现在有两个用 $w$ 表示 $\\phi$ 的表达式，即\n$$\\phi = \\frac{\\omega^{2} - N^{2}}{\\omega\\,m}\\,w, \\qquad \\phi = -\\frac{(\\omega^{2} - f^{2})\\,m}{\\omega\\,k_{h}^{2}}\\,w.$$\n令它们相等并消去公因子 $\\omega$ 和 $w$：\n$$\\frac{\\omega^{2} - N^{2}}{m} = -\\frac{(\\omega^{2} - f^{2})\\,m}{k_{h}^{2}}.$$\n两边同乘以 $m\\,k_{h}^{2}$ 以获得一个关于 $\\omega^{2}$ 的代数关系，\n$$(\\omega^{2} - N^{2})\\,k_{h}^{2} + (\\omega^{2} - f^{2})\\,m^{2} = 0.$$\n合并含 $\\omega^{2}$ 的项并解出 $\\omega^{2}$，\n$$\\omega^{2}\\,(k_{h}^{2} + m^{2}) - \\big(N^{2}\\,k_{h}^{2} + f^{2}\\,m^{2}\\big) = 0 \\quad \\Longrightarrow \\quad \\omega^{2} = \\frac{N^{2}\\,k_{h}^{2} + f^{2}\\,m^{2}}{k_{h}^{2} + m^{2}}.$$\n因此，完整的惯性重力波色散关系是\n$$\\omega(k_{h},m) = \\sqrt{\\frac{N^{2}\\,k_{h}^{2} + f^{2}\\,m^{2}}{k_{h}^{2} + m^{2}}}.$$\n为了分析在 $k_{h}$ 固定时 $\\omega$ 随 $m$ 的变化，重写\n$$\\omega^{2} = f^{2} + \\frac{(N^{2} - f^{2})\\,k_{h}^{2}}{k_{h}^{2} + m^{2}}.$$\n对于固定的 $N$、$f$ 和 $k_{h}$，第二项随着 $m^{2}$ 的增加而单调递减，因此 $\\omega$ 随着 $m$ 的增加而减小。极限值为当 $m \\to 0$ 时 $\\omega \\to N$ 以及当 $m \\to \\infty$ 时 $\\omega \\to f$。在静力学极限 $m^{2} \\gg k_{h}^{2}$ 下，分母 $k_{h}^{2} + m^{2}$ 可以近似为 $m^{2}$，得到\n$$\\omega^{2} \\approx \\frac{N^{2}\\,k_{h}^{2} + f^{2}\\,m^{2}}{m^{2}} = f^{2} + N^{2}\\,\\frac{k_{h}^{2}}{m^{2}},$$\n从而\n$$\\omega_{\\text{hyd}}(k_{h},m) \\approx \\sqrt{f^{2} + N^{2}\\,\\frac{k_{h}^{2}}{m^{2}}}.$$\n两个表达式都是角频率，单位应为弧度每秒。",
            "answer": "$$\\boxed{\\begin{pmatrix}\\sqrt{\\dfrac{N^{2}\\,k_{h}^{2} + f^{2}\\,m^{2}}{k_{h}^{2} + m^{2}}}  \\sqrt{f^{2} + N^{2}\\,\\dfrac{k_{h}^{2}}{m^{2}}}\\end{pmatrix}}$$"
        },
        {
            "introduction": "在推导出抽象的频散关系之后，下一步是将其中的物理参数与真实大气联系起来。本练习聚焦于计算布伦特-维萨拉频率 $N$，它是衡量大气稳定度的关键指标。通过一个给定的温度廓线，你将计算出 $N$ 的具体数值，从而深化对大气稳定度物理意义的理解，并明白它为何决定了内波垂直传播的频率上限。",
            "id": "4054699",
            "problem": "一个旋转行星上的干燥、静力、可压缩大气被建模为理想气体，其重力加速度 $g$、定压比热 $c_p$ 和干空气气体常数 $R_d$ 均为常数。位温 $\\theta$ 定义为 $\\theta = T \\left( \\frac{p_0}{p} \\right)^{\\kappa}$，其中 $\\kappa = \\frac{R_d}{c_p}$，$T$ 是绝对温度，$p$ 是气压，$p_0$ 是一个固定的参考气压。Brunt–Väisälä频率（也称浮力频率）$N$ 定义为 $N^2 = \\frac{g}{\\theta} \\frac{d\\theta}{dz}$。假设静力平衡 $\\frac{dp}{dz} = -\\rho g$ 和理想气体定律 $p = \\rho R_d T$。考虑一个垂直变化的温度剖面 $T(z) = T_0 - \\Gamma z$，其中 $T_0 = 290\\,\\mathrm{K}$ 且 $\\Gamma = 6.5\\,\\mathrm{K\\,km^{-1}}$。在海拔 $z = 5\\,\\mathrm{km}$ 处，计算 $N$ 的值，并附加假设：在该高度附近的一个薄层内，气压标高 $H$ 可被视为常数且等于其局部值。使用 $g = 9.81\\,\\mathrm{m\\,s^{-2}}$，$R_d = 287\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$ 和 $c_p = 1004\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$。\n\n任务：\n- 仅从给定的定义和平衡关系出发，推导出一个用 $g$、$T$、$\\Gamma$ 和 $c_p$ 表示 $z=5\\,\\mathrm{km}$ 处 $N$ 的表达式，并明确指出在何处使用了气压标高为常数的假设。\n- 根据给定的剖面和常数，计算 $z=5\\,\\mathrm{km}$ 处 $N$ 的数值。最终答案以 $\\mathrm{s^{-1}}$ 为单位，并四舍五入到四位有效数字。\n- 根据计算出的 $N$ 值，简要说明该结果对于内重力波在此环境中相对于其本征频率垂直传播的能力意味着什么。\n\n您的最终数值答案必须仅为按上述规定计算的 $N$ 值。",
            "solution": "Brunt–Väisälä频率 $N$ 由以下关系定义：\n$$N^2 = \\frac{g}{\\theta} \\frac{d\\theta}{dz}$$\n其中 $g$ 是重力加速度，$z$ 是垂直坐标，$\\theta$ 是位温。位温 $\\theta$ 由下式给出：\n$$\\theta = T \\left( \\frac{p_0}{p} \\right)^{\\kappa}$$\n此处，$T$ 是绝对温度，$p$ 是气压，$p_0$ 是一个恒定的参考气压，$\\kappa = \\frac{R_d}{c_p}$，其中 $R_d$ 是干空气的比气体常数，$c_p$ 是定压比热。\n\n为求得 $N^2$ 的表达式，我们必须首先计算 $\\frac{1}{\\theta}\\frac{d\\theta}{dz}$ 这一项。最方便的方法是先对 $\\theta$ 的表达式取自然对数：\n$$\\ln(\\theta) = \\ln(T) + \\kappa \\ln(p_0) - \\kappa \\ln(p)$$\n对 $z$ 求导得出：\n$$\\frac{1}{\\theta}\\frac{d\\theta}{dz} = \\frac{1}{T}\\frac{dT}{dz} - \\frac{\\kappa}{p}\\frac{dp}{dz}$$\n这个表达式将位温的垂直梯度与温度和气压的垂直梯度联系起来。\n\n接下来，我们使用所给的物理定律来替换气压梯度 $\\frac{dp}{dz}$。假设大气处于静力平衡状态：\n$$\\frac{dp}{dz} = -\\rho g$$\n其中 $\\rho$ 是密度。大气也被建模为理想气体：\n$$p = \\rho R_d T$$\n从理想气体定律解出密度，得 $\\rho = \\frac{p}{R_d T}$。将其代入静力平衡方程，得：\n$$\\frac{dp}{dz} = -\\frac{p g}{R_d T}$$\n这个方程可以重新整理来定义气压标高 $H$：\n$$\\frac{1}{p}\\frac{dp}{dz} = -\\frac{g}{R_d T} = -\\frac{1}{H(z)}$$\n其中 $H(z) = \\frac{R_d T(z)}{g}$。气压标高 $H(z)$ 通常是海拔的函数，因为温度 $T$ 是。\n\n题目要求明确指出局部标高为常数的假设在何处引入。这个假设允许我们将关系式 $\\frac{1}{p}\\frac{dp}{dz} = -\\frac{1}{H}$ 视为用一个恒定的 $H$ 值（即感兴趣的特定高度 $z = 5\\,\\mathrm{km}$ 处的 $H$ 值）进行计算。将这个关于气压梯度的关系式代入我们的位温梯度表达式中，得到：\n$$\\frac{1}{\\theta}\\frac{d\\theta}{dz} = \\frac{1}{T}\\frac{dT}{dz} - \\kappa \\left(-\\frac{1}{H}\\right) = \\frac{1}{T}\\frac{dT}{dz} + \\frac{\\kappa}{H}$$\n这一步明确地使用局部标高 $H$ 来描述局部气压变化，体现了题目要求的假设。\n\n现在，我们将其代回 $N^2$ 的定义中：\n$$N^2 = g \\left( \\frac{1}{\\theta}\\frac{d\\theta}{dz} \\right) = g \\left( \\frac{1}{T}\\frac{dT}{dz} + \\frac{\\kappa}{H} \\right)$$\n为了得到以所需项（$g$，$T$，$\\Gamma$ 和 $c_p$）表示的表达式，我们代入 $\\kappa$ 和 $H$ 的定义：\n$$N^2 = g \\left( \\frac{1}{T}\\frac{dT}{dz} + \\frac{R_d/c_p}{R_d T / g} \\right) = g \\left( \\frac{1}{T}\\frac{dT}{dz} + \\frac{g}{c_p T} \\right)$$\n提出因子 $\\frac{1}{T}$：\n$$N^2 = \\frac{g}{T} \\left( \\frac{dT}{dz} + \\frac{g}{c_p} \\right)$$\n温度剖面由 $T(z) = T_0 - \\Gamma z$ 给出。因此，环境温度直减率是 $\\frac{dT}{dz} = -\\Gamma$。将此代入方程，得到最终的推导表达式：\n$$N^2 = \\frac{g}{T(z)} \\left( \\frac{g}{c_p} - \\Gamma \\right)$$\n这个表达式将 $N^2$ 与海拔 $z$ 处的温度 $T$、重力加速度 $g$、定压比热 $c_p$ 和环境直减率 $\\Gamma$ 联系起来。项 $\\frac{g}{c_p}$ 被认为是干绝热直减率 $\\Gamma_d$。\n\n接下来，我们计算在 $z = 5\\,\\mathrm{km}$ 处的 $N$ 的数值。\n给定的常数是：\n-   $g = 9.81\\,\\mathrm{m\\,s^{-2}}$\n-   $c_p = 1004\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$\n-   $T_0 = 290\\,\\mathrm{K}$\n-   $\\Gamma = 6.5\\,\\mathrm{K\\,km^{-1}} = 0.0065\\,\\mathrm{K\\,m^{-1}}$\n-   $z = 5\\,\\mathrm{km} = 5000\\,\\mathrm{m}$\n\n首先，我们计算 $z = 5\\,\\mathrm{km}$ 处的温度：\n$$T(5000\\,\\mathrm{m}) = T_0 - \\Gamma z = 290\\,\\mathrm{K} - (0.0065\\,\\mathrm{K\\,m^{-1}})(5000\\,\\mathrm{m}) = 290\\,\\mathrm{K} - 32.5\\,\\mathrm{K} = 257.5\\,\\mathrm{K}$$\n接下来，我们计算干绝热直减率 $\\Gamma_d$：\n$$\\Gamma_d = \\frac{g}{c_p} = \\frac{9.81\\,\\mathrm{m\\,s^{-2}}}{1004\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}} \\approx 0.0097709\\,\\mathrm{K\\,m^{-1}}$$\n现在，我们可以计算 $N^2$：\n$$N^2 = \\frac{9.81\\,\\mathrm{m\\,s^{-2}}}{257.5\\,\\mathrm{K}} \\left( 0.0097709\\,\\mathrm{K\\,m^{-1}} - 0.0065\\,\\mathrm{K\\,m^{-1}} \\right)$$\n$$N^2 = \\frac{9.81}{257.5} (0.0032709)\\,\\mathrm{s^{-2}} \\approx (0.038097)(0.0032709)\\,\\mathrm{s^{-2}} \\approx 0.00012461\\,\\mathrm{s^{-2}}$$\n最后，我们取平方根来求 $N$：\n$$N = \\sqrt{0.00012461\\,\\mathrm{s^{-2}}} \\approx 0.0111630\\,\\mathrm{s^{-1}}$$\n四舍五入到四位有效数字，我们得到 $N = 0.01116\\,\\mathrm{s^{-1}}$。\n\n关于对内重力波传播的影响：\n结果 $N^2  0$ 表明大气在该高度是静力稳定的，这是内重力波存在的必要条件。Brunt–Väisälä 频率 $N$ 代表了垂直传播的内重力波的高频极限。对于一个本征频率为 $\\omega$ 的波，其垂直传播的条件是 $f  \\omega  N$，其中 $f$ 是科里奥利频率（对于惯性重力波），或者在忽略旋转时为 $0  \\omega  N$。因此，计算出的值 $N \\approx 0.01116\\,\\mathrm{s^{-1}}$ 意味着只有本征频率低于此值的内重力波才能垂直传播。频率 $\\omega  N$ 的波是倏逝的；它们不能垂直传播，其能量被限制在源附近的薄层内。这个频率对应的最小浮力周期为 $T_{min} = 2\\pi/N \\approx 563\\,\\mathrm{s}$（约 $9.4$ 分钟），意味着周期更短的波不能垂直传播。",
            "answer": "$$\\boxed{0.01116}$$"
        },
        {
            "introduction": "这项综合性练习是理论与应用的桥梁，要求你构建一个计算模型来模拟重力波从源地到饱和破碎的完整生命周期。通过这项实践，你将模拟重力波拖曳这一在气候和天气模型中至关重要的过程，即追踪波的传播、计算其饱和高度并量化其动量通量沉积。这项动手编程任务充分展示了波传播和破碎的理论如何在最先进的数值模型中被参数化，体现了本领域的精髓。",
            "id": "4054710",
            "problem": "考虑一个垂直变化、静力平衡、稳定层结的大气，以及与数值天气预报和气候模拟相关的内重力波的垂直传播。从第一性原理出发，推导一个计算模型，该模型从一个以源高度上的水平波数和垂直波数描述的指定离散波源谱开始，并利用Wentzel–Kramers–Brillouin (WKB) 理论积分其垂直传播过程直至饱和。然后，计算由波破碎引起的水平动量通量的垂直沉积廓线。\n\n假设与设置：\n- 使用二维空间中的线性化Boussinesq方程，针对具有缓慢变化的参考密度的可压缩基态，并为简化起见忽略科里奥利效应。\n- 假设一个水平均匀的背景，具有恒定的Brunt–Väisälä频率 $N$ 和一个非弹性参考密度廓线 $\\rho(z) = \\rho_{\\mathrm{ref}} \\exp(-z/H)$，其中 $\\rho_{\\mathrm{ref}}$ 是 $z=0$ 处的参考密度，$H$ 是密度标高。\n- 考虑形式为 $\\exp(i(k_h x + m z - \\omega t))$ 的平面波，其中 $k_h$ 是水平波数，$m$ 是垂直波数，$\\omega$ 是由线性色散关系以及给定的 $N$、$k_h$ 和 $m$ 决定的内禀频率。\n\n必须使用的基本原理：\n- 线性化的Boussinesq动量、浮力和连续性方程。\n- 平面波拟设及由此得到的联系内重力波的 $\\omega$、$N$、$k_h$ 和 $m$ 的色散关系。\n- 内重力波的水平和垂直速度扰动之间的极化关系。\n- 在无耗散的缓慢变化介质中的波作用量守恒和WKB振幅标度律。\n- 一个基于物理的翻转饱和判据，定义为垂直位移振幅 $\\xi$ 满足 $m |\\xi| = 1$，这对应于对流不稳定阈值。\n\n计算建模要求：\n1. 从线性化Boussinesq方程和平面波拟设出发，推导在无旋转极限下联系 $\\omega$、$N$、$k_h$ 和 $m$ 的内重力波色散关系，以及连接水平和垂直速度振幅的极化关系。\n2. 推导一个以背景密度、$k_h$、$m$ 和源高度 $z_0$ 处的垂直速度扰动振幅表示的水平动量的时间平均垂直通量（即应力）的表达式。在没有耗散的情况下，根据WKB传播和恒定的 $N$，该应力必须随高度守恒。\n3. 使用Wentzel–Kramers–Brillouin (WKB) 理论下的波作用量守恒，推导垂直速度振幅 $|w|(z)$ 如何随背景密度 $\\rho(z)$ 在向上传播时进行标度。用 $|w|(z)$ 和 $\\omega$ 表示垂直位移振幅 $|\\xi|(z)$。\n4. 实现一个饱和判据：确定从 $z_0$ 向上（垂直）传播时首次满足 $m |\\xi|(z_s) = 1$ 的饱和高度 $z_s$。如果该判据在 $z_0$ 处已满足，则设 $z_s = z_0$。如果在模拟域内始终未满足，则该域内没有沉积。\n5. 通过在饱和高度沉积守恒的波应力，计算水平动量通量的垂直沉积廓线。对于数值输出，将沉积近似为高度箱上的分段常数廓线：如果饱和高度落入某个箱内，则每个箱接收的沉积量为波应力除以箱厚度。如果饱和发生在第一个箱以下，则沉积在第一个箱中。如果饱和发生在最后一个箱以上，则在域内不沉积任何物质。\n6. 模型必须汇集来自离散源谱 $S$ 的各分量的贡献，该谱由源高度 $z_0$ 处的 $(k_h, m)$ 和垂直速度振幅 $|w|$ 组成。对于每个分量，计算其频率 $\\omega$、在 $z_0$ 处的守恒应力及其饱和高度，然后将其沉积累加到相应的高度箱中。\n\n单位和输出规格：\n- 最终沉积值以牛顿每立方米 (N/m^3) 为单位表示。如果适用，角度使用弧度；然而，此问题未明确涉及角度。\n- 您的程序必须将指定测试套件的沉积廓线作为单行输出，该行包含一个由方括号括起来的逗号分隔列表。列表中的每个元素对应一个测试用例，并且本身必须是一个浮点数列表，表示每个高度箱中的沉积量（单位为 N/m^3）。例如：\"[[bin1_case1,bin2_case1,...],[bin1_case2,bin2_case2,...],...]\"。数值可以使用标准或科学记数法。\n\n测试套件：\n- 所有测试用例的通用参数：\n  - 源高度 $z_0 = 10000$ m。\n  - 模拟域顶部 $z_{\\mathrm{top}} = 40000$ m。\n  - 高度箱厚度 $\\Delta z = 5000$ m，得到的箱为 $[10000,15000)$、$[15000,20000)$、$[20000,25000)$、$[25000,30000)$、$[30000,35000)$、$[35000,40000)$。\n  - $z=0$ 处的参考密度：$\\rho_{\\mathrm{ref}} = 1.225$ kg/m^3。\n  - 密度标高：$H = 7000$ m。\n- 测试用例 1（内部和下边界饱和的一般情况）：\n  - Brunt–Väisälä频率：$N = 0.01$ s$^{-1}$。\n  - 在 $z_0$ 处的源谱 $S_1$ 由三个分量给出，每个分量由 $(k_h, m, |w|)$ 指定，单位为国际单位制：\n    - 分量 A: $k_h = 2 \\times 10^{-5}$ m$^{-1}$, $m = 1.2 \\times 10^{-3}$ m$^{-1}$, $|w| = 0.05$ m/s。\n    - 分量 B: $k_h = 1 \\times 10^{-5}$ m$^{-1}$, $m = 8 \\times 10^{-4}$ m$^{-1}$, $|w| = 0.02$ m/s。\n    - 分量 C: $k_h = 3 \\times 10^{-5}$ m$^{-1}$, $m = 2 \\times 10^{-3}$ m$^{-1}$, $|w| = 0.08$ m/s。\n- 测试用例 2（在域内不饱和）：\n  - Brunt–Väisälä频率：$N = 0.01$ s$^{-1}$。\n  - 在 $z_0$ 处的源谱 $S_2$：\n    - 分量 D: $k_h = 2 \\times 10^{-5}$ m$^{-1}$, $m = 1 \\times 10^{-3}$ m$^{-1}$, $|w| = 0.005$ m/s。\n    - 分量 E: $k_h = 1.5 \\times 10^{-5}$ m$^{-1}$, $m = 5 \\times 10^{-4}$ m$^{-1}$, $|w| = 0.01$ m/s。\n- 测试用例 3（下边界饱和和内部饱和的混合情况）：\n  - Brunt–Väisälä频率：$N = 0.01$ s$^{-1}$。\n  - 在 $z_0$ 处的源谱 $S_3$：\n    - 分量 F: $k_h = 4 \\times 10^{-5}$ m$^{-1}$, $m = 1 \\times 10^{-3}$ m$^{-1}$, $|w| = 0.06$ m/s。\n    - 分量 G: $k_h = 6 \\times 10^{-5}$ m$^{-1}$, $m = 2.5 \\times 10^{-3}$ m$^{-1}$, $|w| = 0.1$ m/s。\n    - 分量 H: $k_h = 1 \\times 10^{-5}$ m$^{-1}$, $m = 5 \\times 10^{-4}$ m$^{-1}$, $|w| = 0.015$ m/s。\n\n您的程序必须实现满足上述要求的基于推导的算法，并以指定格式生成单行输出。每个沉积值必须以 N/m^3 表示。不允许外部输入，除了单行最终结果外，不应打印任何其他文本。",
            "solution": "### 1. 色散关系与极化关系\n我们从一个无旋转、无粘性、具有恒定Brunt–Väisälä频率 $N$ 和零平均流的流体的二维线性化Boussinesq方程开始。水平速度（$u'$）、垂直速度（$w'$）和浮力（$b' = -g\\rho'/\\rho_0$）扰动的方程为：\n$$\n\\frac{\\partial u'}{\\partial t} = -\\frac{1}{\\rho_0}\\frac{\\partial p'}{\\partial x} \\quad (1)\n$$\n$$\n\\frac{\\partial w'}{\\partial t} = -\\frac{1}{\\rho_0}\\frac{\\partial p'}{\\partial z} + b' \\quad (2)\n$$\n$$\n\\frac{\\partial b'}{\\partial t} = -N^2 w' \\quad (3)\n$$\n$$\n\\frac{\\partial u'}{\\partial x} + \\frac{\\partial w'}{\\partial z} = 0 \\quad (4)\n$$\n我们寻求形式为 $\\phi'(x,z,t) = \\hat{\\phi} \\exp(i(k_h x + m z - \\omega t))$ 的平面波解，其中 $\\hat{\\phi}$ 是复振幅，$k_h$ 是水平波数，$m$ 是垂直波数，$\\omega$ 是内禀频率。将此拟设代入方程 $(1)$-$(4)$ 得到一个关于振幅的代数方程组：\n$$\n-i\\omega \\hat{u} = -ik_h \\frac{\\hat{p}}{\\rho_0} \\quad (5)\n$$\n$$\n-i\\omega \\hat{w} = -im \\frac{\\hat{p}}{\\rho_0} + \\hat{b} \\quad (6)\n$$\n$$\n-i\\omega \\hat{b} = -N^2 \\hat{w} \\quad (7)\n$$\n$$\nik_h \\hat{u} + im \\hat{w} = 0 \\quad (8)\n$$\n从 $(7)$，我们用垂直速度振幅表示浮力振幅：$\\hat{b} = \\frac{N^2}{i\\omega}\\hat{w}$。\n从连续性方程 $(8)$，我们找到水平和垂直速度分量之间的极化关系：\n$$\n\\hat{u} = -\\frac{m}{k_h} \\hat{w} \\quad (9)\n$$\n该关系表明流体质点运动与总波数矢量 $\\mathbf{k} = (k_h, m)$ 正交。速度振幅之比为 $|\\hat{u}|/|\\hat{w}| = |m/k_h|$。\n\n为推导色散关系，我们从方程组中消去 $\\hat{p}$、$\\hat{u}$ 和 $\\hat{b}$。从 $(5)$，$\\hat{p} = \\rho_0 \\frac{\\omega}{k_h} \\hat{u}$。将 $(9)$ 代入此式，得到 $\\hat{p} = -\\rho_0 \\frac{\\omega m}{k_h^2} \\hat{w}$。现在，我们将 $\\hat{p}$ 和 $\\hat{b}$ 的表达式代入垂直动量方程 $(6)$：\n$$\n-i\\omega \\hat{w} = -im \\frac{1}{\\rho_0} \\left(-\\rho_0 \\frac{\\omega m}{k_h^2} \\hat{w}\\right) + \\frac{N^2}{i\\omega}\\hat{w}\n$$\n两边同除以 $\\hat{w}$（假设非平凡解）和 $i$：\n$$\n-\\omega = \\frac{\\omega m^2}{k_h^2} - \\frac{N^2}{\\omega}\n$$\n两边同乘以 $\\omega$ 并重新整理：\n$$\n\\omega^2\\left(1 + \\frac{m^2}{k_h^2}\\right) = N^2 \\implies \\omega^2\\left(\\frac{k_h^2 + m^2}{k_h^2}\\right) = N^2\n$$\n这就给出了内重力波的色散关系：\n$$\n\\omega^2 = N^2 \\frac{k_h^2}{k_h^2 + m^2} \\quad (10)\n$$\n该关系正确地显示了 $\\omega  N$。为了计算，我们使用给定的正值 $N$、$k_h$ 和 $m$ 求解 $\\omega$：$\\omega = N k_h / \\sqrt{k_h^2 + m^2}$。\n\n### 2. 水平动量的垂直通量\n单位面积上水平动量的时间平均垂直通量，也称为雷诺应力，由 $F_p(z) = \\langle \\rho_0(z) u' w' \\rangle$ 给出，其中 $\\langle \\cdot \\rangle$ 表示在一个波周期内的时间平均。对于平面波，该平均计算为 $\\frac{1}{2} \\Re(\\hat{u} \\hat{w}^*)$，其中 $*$ 表示复共轭。\n设 $\\hat{w} = |w|$ 为实数振幅（通过选择相位）。根据极化关系 $(9)$，$\\hat{u} = -\\frac{m}{k_h}|w|$。这也是实数。动量通量则为：\n$$\n\\langle u' w' \\rangle = \\frac{1}{2} \\Re\\left( \\left(-\\frac{m}{k_h}|w|\\right) |w|^* \\right) = -\\frac{1}{2} \\frac{m}{k_h} |w|^2\n$$\n垂直群速为 $c_{gz} = \\frac{\\partial \\omega}{\\partial m} = -N k_h m (k_h^2 + m^2)^{-3/2}$。对于向上的能量传播（$c_{gz} > 0$），我们需要 $m  0$（假设 $k_h, N > 0$）。问题给出了正的 $m$ 值，我们将其解释为垂直波数的大小 $|m|$。因此，对于向上传播的波，物理上的垂直波数是 $-|m|$。动量通量则为：\n$$\nF_p(z) = \\rho_0(z) \\langle u' w' \\rangle = \\frac{1}{2} \\rho_0(z) \\frac{|m|}{k_h} |w(z)|^2\n$$\n在没有耗散的情况下，此通量在饱和高度以下随高度守恒。我们在源高度 $z_0$ 处计算它：\n$$\nF_{p,0} = \\frac{1}{2} \\rho_0(z_0) \\frac{|m|}{k_h} |w(z_0)|^2 \\quad (11)\n$$\n其中 $|m|$ 和 $k_h$ 是在源处给出的波数大小。\n\n### 3. WKB振幅标度律\n在WKB近似下，对于一个缓慢变化的介质，具有恒定的 $N$、$k_h$ 和 $\\omega$（对于水平均匀背景），垂直波数 $m$ 也是恒定的。波作用量通量的守恒要求 $\\rho_0(z)|w(z)|^2 = \\text{constant}$。这可以通过考虑必须恒定的波能通量来推导。所以，对于一个从 $z_0$ 传播到 $z$ 的波：\n$$\n\\rho_0(z_0)|w(z_0)|^2 = \\rho_0(z)|w(z)|^2\n$$\n这给出了垂直速度振幅随高度的标度关系：\n$$\n|w(z)| = |w(z_0)| \\sqrt{\\frac{\\rho_0(z_0)}{\\rho_0(z)}}\n$$\n使用指定的非弹性密度廓线 $\\rho_0(z) = \\rho_{\\mathrm{ref}} \\exp(-z/H)$，我们得到：\n$$\n|w(z)| = |w(z_0)| \\sqrt{\\frac{\\exp(-z_0/H)}{\\exp(-z/H)}} = |w(z_0)| \\exp\\left(\\frac{z-z_0}{2H}\\right) \\quad (12)\n$$\n垂直位移振幅 $|\\xi|$ 与垂直速度振幅 $|w|$ 的关系为 $w' = d\\xi'/dt$。对于没有背景流的单色波，这意味着 $\\hat{w} = -i\\omega\\hat{\\xi}$，所以它们的振幅关系为：\n$$\n|\\xi(z)| = \\frac{|w(z)|}{\\omega} \\quad (13)\n$$\n\n### 4. 饱和判据和高度\n当波变得对流不稳定时，假定波会破碎或饱和。这发生在总位温梯度变为零或负值时。对于小振幅波，此阈值近似为波引起的垂直质点位移使得一个高度的流体质点到达另一个具有相同浮力的高度，这对应于波陡度达到1。该条件由 $|m||\\xi(z)| = 1$ 给出。发生这种情况的高度 $z_s$ 即为饱和高度。\n$$\n|m| |\\xi(z_s)| = 1 \\implies |m| \\frac{|w(z_s)|}{\\omega} = 1\n$$\n代入 $(12)$ 中 $|w(z_s)|$ 的WKB标度关系：\n$$\n|m| \\frac{|w(z_0)| \\exp\\left(\\frac{z_s-z_0}{2H}\\right)}{\\omega} = 1\n$$\n我们现在可以解出 $z_s$。如果波在源高度没有饱和，即 $|m||\\xi(z_0)|  1$，我们可以取对数：\n$$\n\\exp\\left(\\frac{z_s-z_0}{2H}\\right) = \\frac{\\omega}{|m||w(z_0)|}\n$$\n$$\nz_s = z_0 + 2H \\ln\\left(\\frac{\\omega}{|m||w(z_0)|}\\right) \\quad (14)\n$$\n如果波在源处已经饱和（即 $|m||w(z_0)|/\\omega \\geq 1$），则对数的参数小于或等于 $1$，导致 $z_s \\leq z_0$。在这种情况下，根据问题说明，我们将饱和高度设置为源高度，即 $z_s = z_0$。\n\n### 5. 动量沉积廓线\n波向上（垂直）传播，其动量通量 $F_{p,0}$ 保持守恒，直到达到饱和高度 $z_s$，此时假定波破碎并沉积其全部动量通量。动量通量的变化率，代表单位面积上的力，为 $-\\nabla \\cdot \\mathbf{F}_p$。在我们的模型中，这被近似为在 $z_s$ 处的局地沉积。单位体积的沉积量 $D$（单位 N/m$^3$）是通量 $F_{p,0}$（单位 N/m$^2$）除以发生沉积的高度箱的厚度 $\\Delta z$。\n- 模拟域从 $z_0 = 10000$ m 到 $z_{\\mathrm{top}} = 40000$ m，被划分为厚度为 $\\Delta z = 5000$ m 的箱。\n- 对每个波分量，我们计算 $z_s$。\n- 如果 $z_s \\ge z_{\\mathrm{top}}$，波在模拟域内不饱和，其沉积为零。\n- 如果 $z_0 \\le z_s  z_{\\mathrm{top}}$，我们找到包含 $z_s$ 的箱索引 $i = \\lfloor(z_s - z_0) / \\Delta z\\rfloor$。该波的动量通量 $F_{p,0}$ 被加到要在箱 $i$ 中沉积的总通量上。问题指出，如果饱和发生在第一个箱以下，则沉积在第一个箱中。我们对预饱和波设定 $z_s = z_0$ 的公式处理了这种情况，因为 $z_s = z_0$ 会落入第一个箱。\n- 箱 $i$ 中的总沉积量为 $D_i = (\\sum_j F_{p,0}^{(j)}) / \\Delta z$，其中求和是对所有在箱 $i$ 中饱和的波 $j$ 进行的。\n\n### 6. 在源谱上进行汇集\n最终的沉积廓线是来自离散源谱 $S$ 中所有分量贡献的总和。算法如下：\n1. 初始化一个零数组 `deposition_fluxes`，其维度为高度箱的数量。\n2. 对于源谱 $S$ 中的每个波分量 $(k_h, m, |w(z_0)|)$：\n    a. 使用色散关系 $(10)$ 计算频率 $\\omega$。\n    b. 使用 $(11)$ 计算源高度 $z_0$ 处的守恒动量通量 $F_{p,0}$，其中 $\\rho_0(z_0) = \\rho_{\\mathrm{ref}} \\exp(-z_0/H)$。问题给出的 $m$ 是正值，我们将其解释为 $|m|$。\n    c. 使用 $(14)$ 计算饱和高度 $z_s$，并附加条件：如果波在源处饱和，则 $z_s = z_0$。\n    d. 如果 $z_0 \\le z_s  z_{\\mathrm{top}}$，确定包含 $z_s$ 的高度箱的索引。将 $F_{p,0}$ 加到 `deposition_fluxes` 数组的相应元素上。\n3. 遍历所有波分量后，通过将 `deposition_fluxes` 数组除以箱厚度 $\\Delta z$ 来获得最终的沉积廓线 $D$。\n对每个测试用例重复此过程。",
            "answer": "```\n[[1.259929e-05,2.463372e-06,0.000000e+00,0.000000e+00,0.000000e+00,0.000000e+00],[0.000000e+00,0.000000e+00,0.000000e+00,0.000000e+00,0.000000e+00,0.000000e+00],[4.558359e-05,4.717182e-06,0.000000e+00,0.000000e+00,0.000000e+00,0.000000e+00]]\n```"
        }
    ]
}