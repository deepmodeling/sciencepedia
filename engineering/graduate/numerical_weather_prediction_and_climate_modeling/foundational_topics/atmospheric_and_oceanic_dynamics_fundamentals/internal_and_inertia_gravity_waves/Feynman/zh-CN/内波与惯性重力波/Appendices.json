{
    "hands_on_practices": [
        {
            "introduction": "理解任何波动现象的核心在于其色散关系，它如同波动的“规则手册”，决定了波的传播特性。本练习将引导你从基本的Boussinesq方程组出发，一步步推导出惯性重力波的完整色散关系。通过这个过程，你将深刻理解浮力频率 $N$、科里奥利参数 $f$ 以及波的几何结构（由水平波数 $k_h$ 和垂直波数 $m$ 描述）是如何共同决定波的频率 $\\omega$ 的。",
            "id": "4054689",
            "problem": "考虑一个稳定分层、无粘性、旋转的Boussinesq流体，它位于一个$f$平面上，代表了数值天气预报和气候模型中使用的中纬度大气柱。背景具有恒定的参考密度$\\rho_{0}$和恒定的浮力频率$N$。设$(u,v,w)$为扰动速度分量，$p$为扰动压力，$b$为浮力。线性化方程为动量方程\n$$\\frac{\\partial u}{\\partial t} - f\\,v = -\\frac{1}{\\rho_{0}}\\,\\frac{\\partial p}{\\partial x}, \\qquad \\frac{\\partial v}{\\partial t} + f\\,u = -\\frac{1}{\\rho_{0}}\\,\\frac{\\partial p}{\\partial y}, \\qquad \\frac{\\partial w}{\\partial t} = -\\frac{1}{\\rho_{0}}\\,\\frac{\\partial p}{\\partial z} + b,$$\n浮力方程\n$$\\frac{\\partial b}{\\partial t} + N^{2}\\,w = 0,$$\n以及连续性方程\n$$\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} + \\frac{\\partial w}{\\partial z} = 0.$$\n假设形式为 $\\exp\\!\\big(i(k x + l y + m z - \\omega t)\\big)$ 的平面波解，其中$k$和$l$为实水平波数，$m$为垂直波数，$\\omega$为角频率。定义水平波数大小 $k_{h} \\equiv \\sqrt{k^{2} + l^{2}}$。从上述方程出发，推导惯性重力波的色散关系，该关系将$\\omega$与$(k_{h}, m)$联系起来（对于固定的$N$和$f$），并用它来分析当$k_{h}$保持不变时，$\\omega$如何随$m$变化。然后，通过取$m^{2} \\gg k_{h}^{2}$并相应地简化色散关系，确定$\\omega$的静水平衡极限。将最终的角频率表达式以弧度/秒为单位表示。你的最终答案必须是单个闭式表达式或一对闭式表达式。如果你提供两个表达式（完整的色散关系及其静水平衡极限形式），请将它们一起写成一个行矩阵。不需要进行数值计算或四舍五入。",
            "solution": "我们从$f$平面上具有恒定浮力频率$N$的线性化旋转Boussinesq系统开始。在平面波假设 $\\exp\\!\\big(i(k x + l y + m z - \\omega t)\\big)$下，所有空间导数的作用相当于乘以$i$和相应的波数，而时间导数的作用相当于乘以$-i \\omega$。为方便代数运算，定义$\\phi \\equiv p/\\rho_{0}$。变换后的方程变为\n$$-i \\omega\\,u - f\\,v = -i k\\,\\phi, \\qquad -i \\omega\\,v + f\\,u = -i l\\,\\phi,$$\n$$-i \\omega\\,w = -i m\\,\\phi + b,$$\n$$-i \\omega\\,b + N^{2}\\,w = 0,$$\n$$i k\\,u + i l\\,v + i m\\,w = 0.$$\n从浮力方程中，我们求解$b$（用$w$表示）：\n$$-i \\omega\\,b + N^{2}\\,w = 0 \\quad \\Longrightarrow \\quad b = \\frac{N^{2}}{i \\omega}\\,w = -i\\,\\frac{N^{2}}{\\omega}\\,w.$$\n将$b$代入垂直动量方程以消去$b$：\n$$-i \\omega\\,w = -i m\\,\\phi - i\\,\\frac{N^{2}}{\\omega}\\,w.$$\n两边同乘以$i$以获得一个实数代数关系，\n$$\\omega\\,w = m\\,\\phi + \\frac{N^{2}}{\\omega}\\,w,$$\n并重新整理以用$w$表示$\\phi$：\n$$m\\,\\phi = \\frac{\\omega^{2} - N^{2}}{\\omega}\\,w \\quad \\Longrightarrow \\quad \\phi = \\frac{\\omega^{2} - N^{2}}{\\omega\\,m}\\,w.$$\n接下来，使用水平动量方程将水平流与压力场联系起来，然后利用连续性方程连接水平和垂直运动。水平动量系统可以写成矩阵形式\n$$\\begin{pmatrix} -i \\omega  -f \\\\ f  -i \\omega \\end{pmatrix} \\begin{pmatrix} u \\\\ v \\end{pmatrix} = -i \\begin{pmatrix} k \\\\ l \\end{pmatrix} \\phi.$$\n对这个$2 \\times 2$矩阵求逆。其行列式为$(-i \\omega)^{2} + f^{2} = -\\omega^{2} + f^{2}$。逆矩阵是\n$$\\frac{1}{-\\omega^{2} + f^{2}} \\begin{pmatrix} -i \\omega  f \\\\ -f  -i \\omega \\end{pmatrix}.$$\n相乘以获得$u$和$v$，\n$$u = \\frac{(-i \\omega)(-i k \\phi) + f(-i l \\phi)}{-\\omega^{2} + f^{2}} = \\frac{-\\omega\\,k\\,\\phi - i f\\,l\\,\\phi}{-\\omega^{2} + f^{2}},$$\n$$v = \\frac{-f(-i k \\phi) + (-i \\omega)(-i l \\phi)}{-\\omega^{2} + f^{2}} = \\frac{i f\\,k\\,\\phi - \\omega\\,l\\,\\phi}{-\\omega^{2} + f^{2}}.$$\n构造连续性组合$k u + l v$，由于虚数交叉项的抵消，该式得以简化：\n$$k u + l v = \\frac{-\\omega (k^{2} + l^{2}) \\phi}{-\\omega^{2} + f^{2}} = \\frac{\\omega\\,k_{h}^{2}\\,\\phi}{\\omega^{2} - f^{2}}.$$\n连续性要求$k u + l v + m w = 0$，因此\n$$k u + l v = -m\\,w.$$\n结合最后两个结果，通过$k_{h}$和$m$来关联$\\phi$和$w$：\n$$-m\\,w = \\frac{\\omega\\,k_{h}^{2}\\,\\phi}{\\omega^{2} - f^{2}} \\quad \\Longrightarrow \\quad \\phi = -\\frac{(\\omega^{2} - f^{2})\\,m}{\\omega\\,k_{h}^{2}}\\,w.$$\n我们现在有两个用$w$表示$\\phi$的表达式，即\n$$\\phi = \\frac{\\omega^{2} - N^{2}}{\\omega\\,m}\\,w, \\qquad \\phi = -\\frac{(\\omega^{2} - f^{2})\\,m}{\\omega\\,k_{h}^{2}}\\,w.$$\n将它们相等，并消去公因子$\\omega$和$w$：\n$$\\frac{\\omega^{2} - N^{2}}{m} = -\\frac{(\\omega^{2} - f^{2})\\,m}{k_{h}^{2}}.$$\n两边同乘以$m\\,k_{h}^{2}$，得到一个关于$\\omega^{2}$的代数关系，\n$$(\\omega^{2} - N^{2})\\,k_{h}^{2} + (\\omega^{2} - f^{2})\\,m^{2} = 0.$$\n将含$\\omega^{2}$的项组合在一起，并解出$\\omega^{2}$，\n$$\\omega^{2}\\,(k_{h}^{2} + m^{2}) - \\big(N^{2}\\,k_{h}^{2} + f^{2}\\,m^{2}\\big) = 0 \\quad \\Longrightarrow \\quad \\omega^{2} = \\frac{N^{2}\\,k_{h}^{2} + f^{2}\\,m^{2}}{k_{h}^{2} + m^{2}}.$$\n因此，完整的惯性重力波色散关系是\n$$\\omega(k_{h},m) = \\sqrt{\\frac{N^{2}\\,k_{h}^{2} + f^{2}\\,m^{2}}{k_{h}^{2} + m^{2}}}.$$\n为了分析在$k_{h}$固定时$\\omega$随$m$的变化，重写\n$$\\omega^{2} = f^{2} + \\frac{(N^{2} - f^{2})\\,k_{h}^{2}}{k_{h}^{2} + m^{2}}.$$\n对于固定的$N$、$f$和$k_{h}$，第二项随着$m^{2}$的增加而单调递减，因此$\\omega$随着$m$的增加而减小。极限值为当$m \\to 0$时$\\omega \\to N$，以及当$m \\to \\infty$时$\\omega \\to f$。在静水平衡极限$m^{2} \\gg k_{h}^{2}$下，分母$k_{h}^{2} + m^{2}$可以近似为$m^{2}$，得到\n$$\\omega^{2} \\approx \\frac{N^{2}\\,k_{h}^{2} + f^{2}\\,m^{2}}{m^{2}} = f^{2} + N^{2}\\,\\frac{k_{h}^{2}}{m^{2}},$$\n因而\n$$\\omega_{\\text{hyd}}(k_{h},m) \\approx \\sqrt{f^{2} + N^{2}\\,\\frac{k_{h}^{2}}{m^{2}}}.$$\n两个表达式都是角频率，应以弧度/秒为单位进行解释。",
            "answer": "$$\\boxed{\\begin{pmatrix}\\sqrt{\\dfrac{N^{2}\\,k_{h}^{2} + f^{2}\\,m^{2}}{k_{h}^{2} + m^{2}}}  \\sqrt{f^{2} + N^{2}\\,\\dfrac{k_{h}^{2}}{m^{2}}}\\end{pmatrix}}$$"
        },
        {
            "introduction": "在掌握了波的内在属性之后，下一步是研究其与非均匀背景环境的相互作用。本练习将探讨临界层这一关键概念，在此高度，波的能量和动量被平均流吸收，导致波的破碎。通过计算一个给定波及其背景流场的临界层高度，你将具体地理解波-流相互作用和动量输送这一大气动力学中的核心过程。",
            "id": "4054707",
            "problem": "考虑一个在垂直切变但水平均匀的纬向流中的小振幅、静力、Boussinesq 内重力波，该过程在 Wentzel–Kramers–Brillouin (WKB) 近似下进行（Wentzel–Kramers–Brillouin (WKB) 意为背景场缓慢变化，因此局地平面波解是有意义的）。背景纬向风指定为 $U(z)=20\\,\\mathrm{m\\,s^{-1}}-2\\,z\\,\\mathrm{m\\,s^{-1}\\,km^{-1}}$，其中 $z$ 是以 $\\mathrm{km}$ 为单位的几何高度，从 $z=0$ 的参考水准面向上为正。一个具有水平结构 $\\exp\\!\\big(i k_x x\\big)$ 的平面波以观测到的（地面）角频率 $\\omega=0.01\\,\\mathrm{s^{-1}}$ 和纬向波数 $k_x=2\\times 10^{-4}\\,\\mathrm{m^{-1}}$ 向东传播。\n\n仅使用平均流的线性平流和内在频率的定义，从第一性原理推导该波临界层的条件，并计算内在频率满足 $\\omega_i=0$ 时的几何高度 $z_c$。将最终答案表示为一个以 $\\mathrm{km}$ 为单位的单个实数，并四舍五入到三位有效数字。如果计算出的 $z_c$ 不在参考水准面之上（$z\\ge 0$），仍需报告从线性廓线获得的值。",
            "solution": "该问题陈述在科学上是合理的、自洽的且适定的。它提出了一个地球物理流体动力学中的标准问题，涉及内重力波与切变平均流的相互作用。给定的参数在物理上是现实的。因此，我们可以进行正式求解。\n\n问题的核心在于固定（地面）参考系中观测到的波频率 $\\omega$ 与随背景流移动的流体质点所经历的频率（即内在频率 $\\omega_i$）之间的关系。这种关系被称为多普勒频移关系。按照规定，我们将从第一性原理推导此关系。\n\n一个量 $\\phi$（例如，扰动压力、速度）的小振幅平面波扰动在 $x$ 方向水平传播，可以表示为以下形式：\n$$ \\phi(x, z, t) = \\hat{\\phi}(z) \\exp\\left[i(k_x x - \\omega t)\\right] $$\n其中 $\\hat{\\phi}(z)$ 是波的垂直结构，$k_x$ 是纬向波数，$\\omega$ 是在静止参考系中观测到的角频率。\n\n内在频率 $\\omega_i$ 是从随平均流运动的参考系中观察到的波相位的变化率。这对应于由物质导数 $D/Dt$ 控制的时间演变。对于一个背景流为 $\\mathbf{U} = (U(z), 0, 0)$ 的二维问题，线性化的物质导数算子为：\n$$ \\frac{D}{Dt} = \\frac{\\partial}{\\partial t} + U(z) \\frac{\\partial}{\\partial x} $$\n将此算子应用于波扰动 $\\phi$，得到流体质点所经历的变化率：\n$$ \\frac{D\\phi}{Dt} = \\left(\\frac{\\partial}{\\partial t} + U(z) \\frac{\\partial}{\\partial x}\\right) \\left(\\hat{\\phi}(z) \\exp\\left[i(k_x x - \\omega t)\\right]\\right) $$\n由于 $\\hat{\\phi}(z)$ 和 $U(z)$ 独立于 $x$ 和 $t$，我们可以进行微分：\n$$ \\frac{D\\phi}{Dt} = \\hat{\\phi}(z) \\left( (-i\\omega) \\exp\\left[i(k_x x - \\omega t)\\right] + U(z) (ik_x) \\exp\\left[i(k_x x - \\omega t)\\right] \\right) $$\n提取公因式：\n$$ \\frac{D\\phi}{Dt} = \\left( -i\\omega + i k_x U(z) \\right) \\left(\\hat{\\phi}(z) \\exp\\left[i(k_x x - \\omega t)\\right]\\right) $$\n$$ \\frac{D\\phi}{Dt} = -i \\left( \\omega - k_x U(z) \\right) \\phi $$\n根据定义，内在频率 $\\omega_i$ 是物质导数表达式中 $-i\\phi$ 的系数，因此我们确定：\n$$ \\omega_i(z) = \\omega - k_x U(z) $$\n这就是要推导的多普勒频移关系。它表明，由于背景流 $U(z)$ 是垂直切变的，内在频率是高度 $z$ 的函数。\n\n临界层，用高度 $z_c$ 表示，被定义为内在频率消失的层面，即 $\\omega_i = 0$。在此层面上，波相位相对于平均流变为静止，这可能导致波动吸收和平均流加速。因此，临界层的条件是：\n$$ \\omega_i(z_c) = 0 $$\n代入推导出的 $\\omega_i$ 表达式：\n$$ \\omega - k_x U(z_c) = 0 $$\n这得出了临界层的基本条件：背景流速度必须与波的水平相速度 $c_x = \\omega/k_x$ 相匹配。\n$$ U(z_c) = \\frac{\\omega}{k_x} $$\n\n现在我们准备使用给定的数据计算临界层的高度 $z_c$。给定条件如下：\n- 背景纬向风：$U(z) = 20\\,\\mathrm{m\\,s^{-1}} - 2\\,z\\,\\mathrm{m\\,s^{-1}\\,km^{-1}}$，其中 $z$ 的单位是公里。为了计算方便，我们可以写成 $U(z) = 20 - 2z$，其中 $z$ 是一个表示高度（单位为 $\\mathrm{km}$）的无量纲数，$U(z)$ 的单位是 $\\mathrm{m\\,s^{-1}}$。\n- 观测到的角频率：$\\omega = 0.01\\,\\mathrm{s^{-1}}$。\n- 纬向波数：$k_x = 2 \\times 10^{-4}\\,\\mathrm{m^{-1}}$。\n\n首先，我们计算波的水平相速度 $c_x$：\n$$ c_x = \\frac{\\omega}{k_x} = \\frac{0.01\\,\\mathrm{s^{-1}}}{2 \\times 10^{-4}\\,\\mathrm{m^{-1}}} = \\frac{1 \\times 10^{-2}}{2 \\times 10^{-4}} \\,\\mathrm{m\\,s^{-1}} = 0.5 \\times 10^2 \\,\\mathrm{m\\,s^{-1}} = 50\\,\\mathrm{m\\,s^{-1}} $$\n波以 $50\\,\\mathrm{m\\,s^{-1}}$ 的速度向东（$x$ 正方向）传播。\n\n现在，我们将临界层处的背景流速 $U(z_c)$ 设为等于该相速度：\n$$ U(z_c) = c_x $$\n$$ 20 - 2z_c = 50 $$\n我们解这个关于 $z_c$ 的线性方程：\n$$ -2z_c = 50 - 20 $$\n$$ -2z_c = 30 $$\n$$ z_c = \\frac{30}{-2} = -15 $$\n$z_c$ 的单位是公里，这是在问题陈述中为变量 $z$ 定义的。因此，临界层位于 $-15\\,\\mathrm{km}$ 的几何高度。尽管这低于 $z=0$ 的参考水准面，但题目要求我们报告所求得的值。\n\n最后，题目要求答案四舍五入到三位有效数字。数值 $-15$ 有两位有效数字。用三位有效数字表示为 $-15.0$。",
            "answer": "$$\\boxed{-15.0}$$"
        },
        {
            "introduction": "本章的最后一个实践练习旨在连接波动理论与数值模式中的实际应用。这个计算任务要求你构建一个简化的重力波拖曳参数化方案，涵盖波的产生、传播、饱和破碎以及动量沉积的全过程。这项动手建模练习综合了前面实践中的概念，并展示了它们在气候和天气预报中的重要性。",
            "id": "4054710",
            "problem": "考虑一个垂直变化的、静力平衡的、稳定分层的大气，以及与数值天气预报和气候模拟相关的内重力波的垂直传播。从第一性原理出发，推导一个计算模型，该模型始于一个在源高度上以水平波数和垂直波数描述的指定的离散波源谱，并利用 Wentzel–Kramers–Brillouin (WKB) 理论积分垂直传播直至饱和。然后，计算由波破碎引起的水平动量通量的垂直沉积廓线。\n\n假设与设置：\n- 使用二维空间中的线性化 Boussinesq 方程组，针对具有缓慢变化的参考密度的可压缩基态，并为简化起见忽略科里奥利效应。\n- 假设一个水平均匀的背景，具有恒定的 Brunt–Väisälä 频率 $N$ 和一个非弹性参考密度廓线 $\\rho(z) = \\rho_{\\mathrm{ref}} \\exp(-z/H)$，其中 $\\rho_{\\mathrm{ref}}$ 是 $z=0$ 处的参考密度，$H$ 是密度标高。\n- 考虑形式为 $\\exp(i(k_h x + m z - \\omega t))$ 的平面波，其中 $k_h$ 是水平波数，$m$ 是垂直波数，$\\omega$ 是由线性色散关系和给定的 $N$、$k_h$ 和 $m$ 决定的内禀频率。\n\n必须使用的基本原理：\n- 线性化的 Boussinesq 动量、浮力和连续性方程。\n- 平面波拟设以及由此产生的联系内重力波的 $\\omega$、$N$、$k_h$ 和 $m$ 的色散关系。\n- 内重力波的水平和垂直速度扰动之间的极化关系。\n- 在无耗散的缓变介质中的波作用量守恒和 WKB 振幅标度。\n- 一个基于物理的翻转饱和判据，定义为垂直位移振幅 $\\xi$ 满足 $m |\\xi| = 1$，这对应于对流不稳定性阈值。\n\n计算建模要求：\n1. 从线性化的 Boussinesq 方程组和平面波拟设出发，推导在无旋转极限下联系 $\\omega$、$N$、$k_h$ 和 $m$ 的内重力波色散关系，以及连接水平和垂直速度振幅的极化关系。\n2. 推导时间平均的水平动量垂直通量（即应力）的表达式，用背景密度、$k_h$、$m$ 和源高度 $z_0$ 处的垂直速度扰动振幅表示。在 WKB 传播且 $N$ 恒定的情况下，若无耗散，该应力必须随高度守恒。\n3. 使用 Wentzel–Kramers–Brillouin (WKB) 理论下的波作用量守恒，推导垂直速度振幅 $|w|(z)$ 如何随背景密度 $\\rho(z)$ 进行向上传播的标度变化。用 $|w|(z)$ 和 $\\omega$ 表示垂直位移振幅 $|\\xi|(z)$。\n4. 实现一个饱和判据：确定从 $z_0$ 向上​​传播时首次满足 $m |\\xi|(z_s) = 1$ 的饱和高度 $z_s$。如果该判据在 $z_0$ 处已经满足，则设 $z_s = z_0$。如果在模拟域内始终未满足，则该域内没有沉积。\n5. 通过在饱和高度沉积守恒的波应力来计算水平动量通量的垂直沉积廓线。对于数值输出，将沉积近似为高度区间上的分段常数廓线：如果饱和高度落入某个区间内，则该区间接收的沉积量为波应力除以区间厚度。如果饱和发生在第一个区间以下，则沉积到第一个区间。如果饱和发生在最后一个区间以上，则在域内不沉积任何物质。\n6. 模型必须聚合一个离散源谱 $S$ 的贡献，该谱由在 $z_0$ 处具有 $(k_h, m)$ 和源高度垂直速度振幅 $|w|$ 的分量组成。对于每个分量，计算其频率 $\\omega$、在 $z_0$ 处的守恒应力及其饱和高度，然后将其沉积累加到相应的高度区间中。\n\n单位和输出规范：\n- 最终沉积值以牛顿每立方米 (N/m^3) 为单位表示。如果适用，角度使用弧度；然而，此问题不明确涉及角度。\n- 您的程序必须将指定测试套件的沉积廓线作为单行输出，该行包含一个用方括号括起来的逗号分隔列表。列表中的每个元素对应一个测试用例，并且本身必须是一个浮点数列表，表示每个高度区间的沉积量（单位为 N/m^3）。例如：“[[bin1_case1,bin2_case1,...],[bin1_case2,bin2_case2,...],...]”。数值可以使用标准或科学记数法。\n\n测试套件：\n- 所有测试用例的通用参数：\n  - 源高度 $z_0 = 10000$ m。\n  - 区域顶部 $z_{\\mathrm{top}} = 40000$ m。\n  - 高度区间厚度 $\\Delta z = 5000$ m，得到的区间为 $[10000,15000)$、$[15000,20000)$、$[20000,25000)$、$[25000,30000)$、$[30000,35000)$、$[35000,40000)$。\n  - $z=0$ 处的参考密度：$\\rho_{\\mathrm{ref}} = 1.225$ kg/m^3。\n  - 密度标高：$H = 7000$ m。\n- 测试用例 1 (具有内部和下边界饱和的通用情况)：\n  - Brunt–Väisälä 频率：$N = 0.01$ s$^{-1}$。\n  - 在 $z_0$ 处的源谱 $S_1$ 由三个分量给出，每个分量由 $(k_h, m, |w|)$ 以 SI 单位指定：\n    - 分量 A：$k_h = 2 \\times 10^{-5}$ m$^{-1}$，$m = 1.2 \\times 10^{-3}$ m$^{-1}$，$|w| = 0.05$ m/s。\n    - 分量 B：$k_h = 1 \\times 10^{-5}$ m$^{-1}$，$m = 8 \\times 10^{-4}$ m$^{-1}$，$|w| = 0.02$ m/s。\n    - 分量 C：$k_h = 3 \\times 10^{-5}$ m$^{-1}$，$m = 2 \\times 10^{-3}$ m$^{-1}$，$|w| = 0.08$ m/s。\n- 测试用例 2 (在域内未饱和)：\n  - Brunt–Väisälä 频率：$N = 0.01$ s$^{-1}$。\n  - 在 $z_0$ 处的源谱 $S_2$：\n    - 分量 D：$k_h = 2 \\times 10^{-5}$ m$^{-1}$，$m = 1 \\times 10^{-3}$ m$^{-1}$，$|w| = 0.005$ m/s。\n    - 分量 E：$k_h = 1.5 \\times 10^{-5}$ m$^{-1}$，$m = 5 \\times 10^{-4}$ m$^{-1}$，$|w| = 0.01$ m/s。\n- 测试用例 3 (下边界饱和和内部饱和的混合情况)：\n  - Brunt–Väisälä 频率：$N = 0.01$ s$^{-1}$。\n  - 在 $z_0$ 处的源谱 $S_3$：\n    - 分量 F：$k_h = 4 \\times 10^{-5}$ m$^{-1}$，$m = 1 \\times 10^{-3}$ m$^{-1}$，$|w| = 0.06$ m/s。\n    - 分量 G：$k_h = 6 \\times 10^{-5}$ m$^{-1}$，$m = 2.5 \\times 10^{-3}$ m$^{-1}$，$|w| = 0.1$ m/s。\n    - 分量 H：$k_h = 1 \\times 10^{-5}$ m$^{-1}$，$m = 5 \\times 10^{-4}$ m$^{-1}$，$|w| = 0.015$ m/s。\n\n您的程序必须实现基于推导的、满足上述要求的算法，并以指定格式生成单行输出。每个沉积值必须以 N/m^3 表示。不允许外部输入，除了单行最终结果外，不应打印任何其他文本。",
            "solution": "该问题陈述经评估具有科学依据、问题明确、客观且内部一致。它提供了所有必要的信息，并基于大气流体动力学的既定原理，特别是内重力波理论。因此，该问题被认为是有效的，并在下面给出解决方案。\n\n解决方案是按照问题陈述中概述的六个计算建模要求制定的。\n\n### 1. 色散关系和极化关系\n我们从适用于无旋转、无粘性流体，且具有恒定 Brunt–Väisälä 频率 $N$ 和零平均流的二维线性化 Boussinesq 方程组开始。水平速度（$u'$）、垂直速度（$w'$）和浮力（$b' = -g\\rho'/\\rho_0$）的扰动方程为：\n$$\n\\frac{\\partial u'}{\\partial t} = -\\frac{1}{\\rho_0}\\frac{\\partial p'}{\\partial x} \\quad (1)\n$$\n$$\n\\frac{\\partial w'}{\\partial t} = -\\frac{1}{\\rho_0}\\frac{\\partial p'}{\\partial z} + b' \\quad (2)\n$$\n$$\n\\frac{\\partial b'}{\\partial t} = -N^2 w' \\quad (3)\n$$\n$$\n\\frac{\\partial u'}{\\partial x} + \\frac{\\partial w'}{\\partial z} = 0 \\quad (4)\n$$\n我们寻求形式为 $\\phi'(x,z,t) = \\hat{\\phi} \\exp(i(k_h x + m z - \\omega t))$ 的平面波解，其中 $\\hat{\\phi}$ 是复振幅，$k_h$ 是水平波数，$m$ 是垂直波数，$\\omega$ 是内禀频率。将此拟设代入方程 $(1)$-$(4)$，得到一个关于振幅的代数方程组：\n$$\n-i\\omega \\hat{u} = -ik_h \\frac{\\hat{p}}{\\rho_0} \\quad (5)\n$$\n$$\n-i\\omega \\hat{w} = -im \\frac{\\hat{p}}{\\rho_0} + \\hat{b} \\quad (6)\n$$\n$$\n-i\\omega \\hat{b} = -N^2 \\hat{w} \\quad (7)\n$$\n$$\nik_h \\hat{u} + im \\hat{w} = 0 \\quad (8)\n$$\n从 $(7)$ 式，我们用垂直速度振幅表示浮力振幅：$\\hat{b} = \\frac{N^2}{i\\omega}\\hat{w}$。\n从连续性方程 $(8)$，我们找到水平和垂直速度分量之间的极化关系：\n$$\n\\hat{u} = -\\frac{m}{k_h} \\hat{w} \\quad (9)\n$$\n此关系表明，流体质点运动与总波数矢量 $\\mathbf{k} = (k_h, m)$ 正交。速度振幅之比为 $|\\hat{u}|/|\\hat{w}| = |m/k_h|$。\n\n为推导色散关系，我们从方程组中消去 $\\hat{p}$、$\\hat{u}$ 和 $\\hat{b}$。从 $(5)$ 式，$\\hat{p} = \\rho_0 \\frac{\\omega}{k_h} \\hat{u}$。将 $(9)$ 式代入此式得到 $\\hat{p} = -\\rho_0 \\frac{\\omega m}{k_h^2} \\hat{w}$。现在，我们将 $\\hat{p}$ 和 $\\hat{b}$ 的表达式代入垂直动量方程 $(6)$：\n$$\n-i\\omega \\hat{w} = -im \\frac{1}{\\rho_0} \\left(-\\rho_0 \\frac{\\omega m}{k_h^2} \\hat{w}\\right) + \\frac{N^2}{i\\omega}\\hat{w}\n$$\n两边同除以 $\\hat{w}$（假设非平凡解）和 $i$：\n$$\n-\\omega = \\frac{\\omega m^2}{k_h^2} - \\frac{N^2}{\\omega}\n$$\n两边同乘以 $\\omega$ 并重新排列得到：\n$$\n\\omega^2\\left(1 + \\frac{m^2}{k_h^2}\\right) = N^2 \\implies \\omega^2\\left(\\frac{k_h^2 + m^2}{k_h^2}\\right) = N^2\n$$\n这就给出了内重力波的色散关系：\n$$\n\\omega^2 = N^2 \\frac{k_h^2}{k_h^2 + m^2} \\quad (10)\n$$\n此关系正确地显示了 $\\omega \\le N$。为了计算，我们使用给定的正值 $N$、$k_h$ 和 $m$ 来求解 $\\omega$：$\\omega = N k_h / \\sqrt{k_h^2 + m^2}$。\n\n### 2. 水平动量的垂直通量\n单位面积上时间平均的水平动量垂直通量，也称为雷诺应力，由 $F_p(z) = \\langle \\rho_0(z) u' w' \\rangle$ 给出，其中 $\\langle \\cdot \\rangle$ 表示在一个波周期内的时间平均。对于平面波，该平均计算为 $\\frac{1}{2} \\Re(\\hat{u} \\hat{w}^*)$，其中 $*$ 表示复共轭。\n设 $\\hat{w} = |w|$ 为实振幅（通过选择相位）。根据极化关系 $(9)$，$\\hat{u} = -\\frac{m}{k_h}|w|$。这也是实数。于是动量通量为：\n$$\n\\langle u' w' \\rangle = \\frac{1}{2} \\Re\\left( \\left(-\\frac{m}{k_h}|w|\\right) |w|^* \\right) = -\\frac{1}{2} \\frac{m}{k_h} |w|^2\n$$\n垂直群速为 $c_{gz} = \\frac{\\partial \\omega}{\\partial m} = -N k_h m (k_h^2 + m^2)^{-3/2}$。对于能量向上传播（$c_{gz} > 0$），我们需要 $m  0$（假设 $k_h, N > 0$）。问题给出的 $m$ 值为正，我们将其解释为垂直波数的大小 $|m|$。因此，对于向上传播的波，物理上的垂直波数为 $-|m|$。动量通量则为：\n$$\nF_p(z) = \\rho_0(z) \\langle u' w' \\rangle = \\rho_0(z) \\frac{1}{2} \\frac{|m|}{k_h} |w(z)|^2\n$$\n在无耗散的情况下，此通量在饱和高度以下随高度守恒。我们在源高度 $z_0$ 处计算它：\n$$\nF_{p,0} = \\frac{1}{2} \\rho_0(z_0) \\frac{|m|}{k_h} |w(z_0)|^2 \\quad (11)\n$$\n其中 $|m|$ 和 $k_h$ 是在源处给出的波数大小。\n\n### 3. WKB 振幅标度\n在缓变介质的 WKB 近似下，对于恒定的 $N$、$k_h$ 和 $\\omega$（对于水平均匀背景），垂直波数 $m$ 也为常数。波作用量通量守恒要求 $\\rho_0(z)|w(z)|^2 = \\text{常数}$。这可以通过考虑必须恒定的波能量通量来推导。因此，对于从 $z_0$ 传播到 $z$ 的波：\n$$\n\\rho_0(z_0)|w(z_0)|^2 = \\rho_0(z)|w(z)|^2\n$$\n这给出了垂直速度振幅随高度的标度关系：\n$$\n|w(z)| = |w(z_0)| \\sqrt{\\frac{\\rho_0(z_0)}{\\rho_0(z)}}\n$$\n使用指定的非弹性密度廓线 $\\rho_0(z) = \\rho_{\\mathrm{ref}} \\exp(-z/H)$，我们得到：\n$$\n|w(z)| = |w(z_0)| \\exp\\left(\\frac{z-z_0}{2H}\\right) \\quad (12)\n$$\n垂直位移振幅 $|\\xi|$ 与垂直速度振幅 $|w|$ 通过 $w' = d\\xi'/dt$ 相关。对于没有背景流的单色波，这意味着 $\\hat{w} = -i\\omega\\hat{\\xi}$，所以它们的振幅关系为：\n$$\n|\\xi(z)| = \\frac{|w(z)|}{\\omega} \\quad (13)\n$$\n\n### 4. 饱和判据与饱和高度\n假设波在变得对流不稳定时发生破碎或饱和。这发生在总位温梯度变为零或负值时。对于小振幅波，此阈值近似为波引起的垂直质块位移使得来自一个高度的流体质块到达另一个具有相同浮力的高度，这对应于波陡达到单位1。该条件由 $|m||\\xi(z)| = 1$ 给出。发生这种情况的高度 $z_s$ 即为饱和高度。\n$$\n|m| |\\xi(z_s)| = 1 \\implies |m| \\frac{|w(z_s)|}{\\omega} = 1\n$$\n代入来自 $(12)$ 式的 $|w(z_s)|$ 的 WKB 标度关系：\n$$\n|m| \\frac{|w(z_0)| \\exp\\left(\\frac{z_s-z_0}{2H}\\right)}{\\omega} = 1\n$$\n我们现在可以解出 $z_s$。如果波在源高度未饱和，即 $|m||\\xi(z_0)|  1$，我们可以取对数：\n$$\n\\exp\\left(\\frac{z_s-z_0}{2H}\\right) = \\frac{\\omega}{|m||w(z_0)|}\n$$\n$$\nz_s = z_0 + 2H \\ln\\left(\\frac{\\omega}{|m||w(z_0)|}\\right) \\quad (14)\n$$\n如果波在源处已经饱和（即 $|m||w(z_0)|/\\omega \\geq 1$），则对数的参数小于或等于 $1$，导致 $z_s \\leq z_0$。在这种情况下，根据问题规范，我们将饱和高度设为源高度，即 $z_s = z_0$。\n\n### 5. 动量沉积廓线\n波向上传播，其动量通量 $F_{p,0}$ 保持守恒，直到达到饱和高度 $z_s$，此时假定它破碎并沉积其全部动量通量。动量通量的变化率代表单位面积上的力，即 $-\\nabla \\cdot \\mathbf{F}_p$。对于我们的模型，这近似为在 $z_s$ 处的局地沉积。单位体积的沉积量 $D$（单位为 N/m$^3$）是通量 $F_{p,0}$（单位为 N/m$^2$）除以发生沉积的高度区间的厚度 $\\Delta z$。\n- 模拟域从 $z_0 = 10000$ m 到 $z_{\\mathrm{top}} = 40000$ m，被划分为厚度为 $\\Delta z = 5000$ m 的区间。\n- 对每个波分量，我们计算 $z_s$。\n- 如果 $z_s \\ge z_{\\mathrm{top}}$，波在模拟域内不饱和，其沉积为零。\n- 如果 $z_0 \\le z_s  z_{\\mathrm{top}}$，我们找到区间索引 $i = \\lfloor(z_s - z_0) / \\Delta z\\rfloor$。该波的动量通量 $F_{p,0}$ 被加到将在区间 $i$ 中沉积的总通量中。问题指出，如果饱和发生在第一个区间以下，则沉积在第一个区间。我们对预饱和波设定 $z_s = z_0$ 的公式处理了这种情况，因为 $z_s = z_0$ 落在第一个区间内。\n- 区间 $i$ 的总沉积量为 $D_i = (\\sum_j F_{p,0}^{(j)}) / \\Delta z$，其中求和是对所有在区间 $i$ 中饱和的波 $j$ 进行的。\n\n### 6. 对源谱进行聚合\n最终的沉积廓线是离散源谱 $S$ 中所有分量贡献的总和。算法如下：\n1. 初始化一个零数组 `deposition_fluxes`，其维度由高度区间的数量决定。\n2. 对于源谱 $S$ 中的每个波分量 $(k_h, m, |w(z_0)|)$：\n    a. 使用色散关系 $(10)$ 计算频率 $\\omega$。\n    b. 使用 $(11)$ 式计算源高度 $z_0$ 处的守恒动量通量 $F_{p,0}$，其中 $\\rho_0(z_0) = \\rho_{\\mathrm{ref}} \\exp(-z_0/H)$。问题给出的 $m$ 是正值，我们将其解释为 $|m|$。\n    c. 使用 $(14)$ 式计算饱和高度 $z_s$，并附带条件：如果波在源处已饱和，则 $z_s = z_0$。\n    d. 如果 $z_0 \\le z_s  z_{\\mathrm{top}}$，确定包含 $z_s$ 的高度区间的索引。将 $F_{p,0}$ 添加到 `deposition_fluxes` 数组的相应元素中。\n3. 遍历所有波分量后，通过将 `deposition_fluxes` 数组除以区间厚度 $\\Delta z$ 来获得最终的沉积廓线 $D$。\n对每个测试用例重复此过程。",
            "answer": "[[1.252033e-05,0.000000e+00,4.401764e-06,0.000000e+00,0.000000e+00,9.390429e-07],[0.000000e+00,0.000000e+00,0.000000e+00,0.000000e+00,0.000000e+00,0.000000e+00],[1.222718e-05,0.000000e+00,0.000000e+00,0.000000e+00,0.000000e+00,2.641316e-06]]"
        }
    ]
}