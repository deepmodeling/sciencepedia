{
    "hands_on_practices": [
        {
            "introduction": "Understanding atmospheric motion begins with mastering the fundamental forces at play. This first exercise tasks you with deriving the gradient wind balance from first principles for a curved flow, a cornerstone of dynamic meteorology. By applying this balance to calculate the wind speed in an idealized cyclone , you will directly connect the abstract concepts of pressure gradient, Coriolis, and centrifugal forces to a tangible and essential meteorological variable.",
            "id": "4027697",
            "problem": "In the context of Numerical Weather Prediction (NWP) and climate modeling, consider an idealized, axisymmetric, circular low-pressure system on a constant-Coriolis-parameter plane (f-plane) with negligible friction. Assume steady, horizontally non-divergent tangential flow and that the air density is uniform. The system has outer radius $R = 200\\,\\mathrm{km}$, and the pressure at the center is lower than the ambient outer value by $\\Delta p = 30\\,\\mathrm{hPa}$. The air density is $\\rho = 1.2\\,\\mathrm{kg\\,m}^{-3}$, and the Coriolis parameter is $f = 10^{-4}\\,\\mathrm{s}^{-1}$. Treat the radial pressure profile between the center and radius $R$ as linear so that the radial pressure gradient magnitude at radius $R$ can be approximated by $\\partial p/\\partial r \\approx \\Delta p / R$. Using only first principles (Newton’s second law in a rotating frame, the pressure gradient force, and the Coriolis force) and the requirement for centripetal acceleration in uniform circular motion, derive the governing balance and compute the physical gradient wind speed $V$ at radius $R$.\n\nExpress your final speed in $\\mathrm{m\\,s}^{-1}$ and round your answer to three significant figures.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and all necessary information is provided.\n\nThe givens are:\n- System: Idealized, axisymmetric, circular low-pressure system.\n- Frame of reference: Constant-Coriolis-parameter plane (f-plane).\n- Dynamics: Negligible friction, steady flow ($\\partial/\\partial t = 0$), horizontally non-divergent tangential flow.\n- Outer radius: $R = 200\\,\\mathrm{km}$.\n- Pressure drop: $\\Delta p = 30\\,\\mathrm{hPa}$.\n- Air density: $\\rho = 1.2\\,\\mathrm{kg\\,m}^{-3}$.\n- Coriolis parameter: $f = 10^{-4}\\,\\mathrm{s}^{-1}$.\n- Pressure gradient approximation: At radius $R$, the magnitude is $\\frac{\\partial p}{\\partial r} \\approx \\frac{\\Delta p}{R}$.\n\nThe problem is valid. It describes a standard physical model in dynamic meteorology (the gradient wind), uses physically plausible values, and is self-contained and well-posed. We can proceed with the solution.\n\nThe motion of a fluid parcel in the atmosphere is governed by Newton's second law in a rotating frame of reference. For horizontal motion, the equation of motion per unit mass is:\n$$ \\frac{d\\vec{u}}{dt} = -\\frac{1}{\\rho}\\nabla_h p - f\\hat{k} \\times \\vec{u} $$\nwhere $\\vec{u}$ is the horizontal velocity vector, $\\frac{d\\vec{u}}{dt}$ is the acceleration of the parcel, $-\\frac{1}{\\rho}\\nabla_h p$ is the horizontal pressure gradient force (PGF) per unit mass, and $-f\\hat{k} \\times \\vec{u}$ is the Coriolis force per unit mass. Friction is stated to be negligible.\n\nThe problem specifies steady, tangential flow, which can be represented in a cylindrical coordinate system $(r, \\theta, z)$ as $\\vec{u} = V\\hat{\\theta}$, where $V$ is the tangential wind speed and is a function of radius $r$ only. The acceleration term $\\frac{d\\vec{u}}{dt}$ for a particle in uniform circular motion is the centripetal acceleration, $\\vec{a}_c$, which is directed radially inward:\n$$ \\vec{a}_c = -\\frac{V^2}{r}\\hat{r} $$\nThe pressure gradient is purely radial for an axisymmetric system, so $\\nabla_h p = \\frac{\\partial p}{\\partial r}\\hat{r}$. The PGF is then:\n$$ -\\frac{1}{\\rho}\\nabla_h p = -\\frac{1}{\\rho}\\frac{\\partial p}{\\partial r}\\hat{r} $$\nFor a low-pressure system, pressure increases with radius, so $\\frac{\\partial p}{\\partial r}  0$, and the PGF is directed radially inward (in the $-\\hat{r}$ direction).\n\nThe Coriolis force term is:\n$$ -f\\hat{k} \\times \\vec{u} = -f\\hat{k} \\times (V\\hat{\\theta}) $$\nUsing the right-hand rule for the cross product in a cylindrical system, $\\hat{k} \\times \\hat{\\theta} = -\\hat{r}$. Therefore, the Coriolis force is:\n$$ -fV(-\\hat{r}) = fV\\hat{r} $$\nFor a cyclonic low in the Northern Hemisphere, we assume $f  0$ and the flow is counter-clockwise, $V  0$. The Coriolis force is directed radially outward (in the $+\\hat{r}$ direction).\n\nSubstituting these vector components into the equation of motion:\n$$ -\\frac{V^2}{r}\\hat{r} = -\\frac{1}{\\rho}\\frac{\\partial p}{\\partial r}\\hat{r} + fV\\hat{r} $$\nEquating the scalar components in the radial ($\\hat{r}$) direction gives the gradient wind equation for cyclonic flow:\n$$ -\\frac{V^2}{r} = -\\frac{1}{\\rho}\\frac{\\partial p}{\\partial r} + fV $$\nThis equation can be rearranged to show the balance of forces, where the inward PGF is balanced by the sum of the outward Coriolis and centrifugal forces (in the rotating frame):\n$$ \\frac{1}{\\rho}\\frac{\\partial p}{\\partial r} = \\frac{V^2}{r} + fV $$\nWe need to solve for the wind speed $V$ at the radius $r=R$. We can rewrite the equation as a standard quadratic equation for $V$:\n$$ \\frac{1}{R}V^2 + fV - \\frac{1}{\\rho}\\left.\\frac{\\partial p}{\\partial r}\\right|_{r=R} = 0 $$\nThe problem provides the approximation for the pressure gradient magnitude at $r=R$: $\\frac{\\partial p}{\\partial r} \\approx \\frac{\\Delta p}{R}$. Substituting this into the equation:\n$$ \\frac{1}{R}V^2 + fV - \\frac{\\Delta p}{\\rho R} = 0 $$\nMultiplying through by $R$ gives:\n$$ V^2 + (fR)V - \\frac{\\Delta p}{\\rho} = 0 $$\nThis is a quadratic equation of the form $a x^2 + b x + c = 0$ with $x=V$, $a=1$, $b=fR$, and $c = -\\frac{\\Delta p}{\\rho}$. The solution is given by the quadratic formula:\n$$ V = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a} = \\frac{-fR \\pm \\sqrt{(fR)^2 - 4(1)(-\\frac{\\Delta p}{\\rho})}}{2} $$\n$$ V = \\frac{-fR \\pm \\sqrt{(fR)^2 + \\frac{4\\Delta p}{\\rho}}}{2} $$\nSince wind speed $V$ must be a positive physical quantity for a cyclonic system in the Northern Hemisphere, we must choose the positive root, as the negative root would yield a negative value for $V$.\n$$ V = \\frac{-fR + \\sqrt{(fR)^2 + \\frac{4\\Delta p}{\\rho}}}{2} $$\nNow, we substitute the given numerical values, ensuring all are in SI units.\n$R = 200\\,\\mathrm{km} = 200 \\times 10^3\\,\\mathrm{m} = 2 \\times 10^5\\,\\mathrm{m}$.\n$\\Delta p = 30\\,\\mathrm{hPa} = 30 \\times 100\\,\\mathrm{Pa} = 3000\\,\\mathrm{Pa}$.\n$\\rho = 1.2\\,\\mathrm{kg\\,m}^{-3}$.\n$f = 10^{-4}\\,\\mathrm{s}^{-1}$.\n\nFirst, calculate the terms inside the formula:\nThe term $fR$:\n$$ fR = (10^{-4}\\,\\mathrm{s}^{-1}) \\times (2 \\times 10^5\\,\\mathrm{m}) = 20\\,\\mathrm{m\\,s}^{-1} $$\nThe term $(fR)^2$:\n$$ (fR)^2 = (20\\,\\mathrm{m\\,s}^{-1})^2 = 400\\,\\mathrm{m^2\\,s^{-2}} $$\nThe term $\\frac{4\\Delta p}{\\rho}$:\n$$ \\frac{4\\Delta p}{\\rho} = \\frac{4 \\times 3000\\,\\mathrm{Pa}}{1.2\\,\\mathrm{kg\\,m}^{-3}} = \\frac{12000}{1.2} \\,\\mathrm{m^2\\,s^{-2}} = 10000\\,\\mathrm{m^2\\,s^{-2}} $$\nNow, substitute these back into the expression for $V$:\n$$ V = \\frac{-20 + \\sqrt{400 + 10000}}{2} \\,\\mathrm{m\\,s}^{-1} $$\n$$ V = \\frac{-20 + \\sqrt{10400}}{2} \\,\\mathrm{m\\,s}^{-1} $$\nCalculating the numerical value:\n$$ \\sqrt{10400} \\approx 101.98039\\,\\mathrm{m\\,s}^{-1} $$\n$$ V = \\frac{-20 + 101.98039}{2} \\,\\mathrm{m\\,s}^{-1} $$\n$$ V = \\frac{81.98039}{2} \\,\\mathrm{m\\,s}^{-1} $$\n$$ V \\approx 40.9902\\,\\mathrm{m\\,s}^{-1} $$\nThe problem requires the answer to be rounded to three significant figures.\n$$ V \\approx 41.0\\,\\mathrm{m\\,s}^{-1} $$",
            "answer": "$$\\boxed{41.0}$$"
        },
        {
            "introduction": "Approximations are powerful tools in science, but knowing their limits is crucial. This practice builds upon the gradient wind balance by challenging you to quantify the error introduced by the geostrophic approximation—which neglects the centrifugal effect—in a high-curvature flow. By analyzing the extreme case of a tropical cyclone eyewall , you will develop a sharp intuition for the critical role that flow curvature plays in intense vortices and the dramatic failures that can result from oversimplification.",
            "id": "4027699",
            "problem": "A Numerical Weather Prediction (NWP) model developer is assessing the consequences of neglecting the centrifugal curvature term in the horizontal momentum balance for the eyewall of a strong tropical cyclone. Assume steady, inviscid, horizontal, axisymmetric flow on an $f$-plane at latitude $\\phi$, with circular isobars of representative radius of curvature $R$. Start from Newton’s second law in a uniformly rotating frame and derive the steady gradient-wind speed $V_{\\text{grad}}$ for cyclonic flow around a low-pressure center in terms of the radial pressure gradient and the Coriolis parameter. Then derive the corresponding geostrophic wind speed $V_{\\text{geo}}$ obtained when the curvature term is neglected. Finally, quantify the percentage error in wind speed (expressed as a decimal fraction, unitless) incurred by neglecting curvature, defined as\n$$E \\equiv \\frac{|V_{\\text{geo}} - V_{\\text{grad}}|}{V_{\\text{grad}}}.$$\nUse the following scientifically realistic parameters representative of a strong tropical cyclone eyewall, and treat air density as constant:\n- Latitude $\\phi = 20^\\circ$.\n- Earth’s rotation rate $\\Omega = 7.292 \\times 10^{-5}\\ \\mathrm{s}^{-1}$.\n- Outward radial pressure increase $\\Delta p = 6.0 \\times 10^{3}\\ \\mathrm{Pa}$ across $\\Delta r = 3.0 \\times 10^{4}\\ \\mathrm{m}$, so the mean radial pressure gradient magnitude is $(\\partial p / \\partial r) \\approx \\Delta p / \\Delta r$.\n- Air density $\\rho = 1.15\\ \\mathrm{kg}\\ \\mathrm{m}^{-3}$.\n- Representative radius of curvature $R = 2.5 \\times 10^{4}\\ \\mathrm{m}$.\n\nCompute $E$ using the physically appropriate cyclonic branch of the gradient-wind solution. Express the final percentage error as a decimal fraction (unitless). Round your answer to four significant figures.",
            "solution": "The problem is first validated and found to be scientifically grounded, well-posed, objective, and internally consistent. The provided parameters, while representing an extreme meteorological event, are physically plausible. We may therefore proceed with the derivation and calculation.\n\nThe horizontal momentum balance for a steady, inviscid, axisymmetric flow in a rotating reference frame is described by Newton's second law. We use a natural coordinate system where the radial coordinate, $r$, points outward from the center of the low-pressure system. The tangential velocity is $V$. For cyclonic flow in the Northern Hemisphere (latitude $\\phi  0$), the flow is counter-clockwise.\n\nThe equation for the radial component of motion balances the pressure gradient force (PGF), the Coriolis force, and the centripetal acceleration of the air parcel.\nThe forces per unit mass acting in the radial direction are:\n1.  Pressure Gradient Force (PGF): $-\\frac{1}{\\rho} \\frac{\\partial p}{\\partial r}$. Since pressure increases outwards for a low-pressure center, $\\frac{\\partial p}{\\partial r}  0$, this force is directed inward (in the negative $r$ direction).\n2.  Coriolis Force: $-f\\hat{k} \\times \\vec{v}$, where $f = 2\\Omega\\sin\\phi$ is the Coriolis parameter, $\\hat{k}$ is the local vertical unit vector, and $\\vec{v}$ is the horizontal velocity vector. For cyclonic flow, $\\vec{v} = V\\hat{\\theta}$. The Coriolis force is $-fV(\\hat{k} \\times \\hat{\\theta}) = -fV(-\\hat{r}) = fV\\hat{r}$. This force is directed outward.\n\nThe acceleration of the air parcel is the centripetal acceleration, directed towards the center of curvature. Its magnitude is $\\frac{V^2}{R}$, where $R$ is the radius of curvature. In our coordinate system, this acceleration is $-\\frac{V^2}{R}\\hat{r}$.\n\nApplying Newton's second law ($\\sum \\vec{F}/m = \\vec{a}$) in the radial direction:\n$$ -\\frac{1}{\\rho}\\frac{\\partial p}{\\partial r} + fV = -\\frac{V^2}{R} $$\nThis equation represents the gradient wind balance. Rearranging it, we get:\n$$ \\frac{1}{\\rho}\\frac{\\partial p}{\\partial r} = fV + \\frac{V^2}{R} $$\nTo find the gradient wind speed, $V_{\\text{grad}}$, we solve the following quadratic equation:\n$$ \\frac{1}{R}V_{\\text{grad}}^2 + fV_{\\text{grad}} - \\frac{1}{\\rho}\\frac{\\partial p}{\\partial r} = 0 $$\nUsing the quadratic formula, $V_{\\text{grad}} = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$, where $a = 1/R$, $b = f$, and $c = -\\frac{1}{\\rho}\\frac{\\partial p}{\\partial r}$:\n$$ V_{\\text{grad}} = \\frac{-f \\pm \\sqrt{f^2 - 4\\left(\\frac{1}{R}\\right)\\left(-\\frac{1}{\\rho}\\frac{\\partial p}{\\partial r}\\right)}}{2/R} $$\n$$ V_{\\text{grad}} = -\\frac{fR}{2} \\pm \\sqrt{\\frac{f^2R^2}{4} + \\frac{R}{\\rho}\\frac{\\partial p}{\\partial r}} $$\nFor a physically meaningful positive wind speed ($V_{\\text{grad}}  0$), we must choose the positive sign, as the term under the square root is larger than $\\frac{fR}{2}$. This is the cyclonic branch of the solution.\n$$ V_{\\text{grad}} = -\\frac{fR}{2} + \\sqrt{\\frac{f^2R^2}{4} + \\frac{R}{\\rho}\\frac{\\partial p}{\\partial r}} $$\nNext, we derive the geostrophic wind speed, $V_{\\text{geo}}$. This is obtained by neglecting the curvature (centripetal acceleration) term, $\\frac{V^2}{R}$, in the momentum balance. This approximation is valid for large-scale flows with small curvature, but its application here is a required step of the problem.\n$$ fV_{\\text{geo}} = \\frac{1}{\\rho}\\frac{\\partial p}{\\partial r} $$\n$$ V_{\\text{geo}} = \\frac{1}{\\rho f}\\frac{\\partial p}{\\partial r} $$\nNow we compute the numerical values. First, we calculate the required physical parameters from the givens:\n- Latitude $\\phi = 20^\\circ$\n- Earth's rotation rate $\\Omega = 7.292 \\times 10^{-5}\\ \\mathrm{s}^{-1}$\n- Outward radial pressure increase $\\Delta p = 6.0 \\times 10^{3}\\ \\mathrm{Pa}$ over $\\Delta r = 3.0 \\times 10^{4}\\ \\mathrm{m}$\n- Air density $\\rho = 1.15\\ \\mathrm{kg}\\ \\mathrm{m}^{-3}$\n- Radius of curvature $R = 2.5 \\times 10^{4}\\ \\mathrm{m}$\n\nThe Coriolis parameter $f$ is:\n$$ f = 2\\Omega\\sin\\phi = 2(7.292 \\times 10^{-5}\\ \\mathrm{s}^{-1})\\sin(20^\\circ) \\approx 4.9886 \\times 10^{-5}\\ \\mathrm{s}^{-1} $$\nThe magnitude of the pressure gradient is approximated as:\n$$ \\frac{\\partial p}{\\partial r} \\approx \\frac{\\Delta p}{\\Delta r} = \\frac{6.0 \\times 10^{3}\\ \\mathrm{Pa}}{3.0 \\times 10^{4}\\ \\mathrm{m}} = 0.2\\ \\mathrm{Pa}\\ \\mathrm{m}^{-1} $$\nThe PGF term per unit mass is:\n$$ \\frac{1}{\\rho}\\frac{\\partial p}{\\partial r} = \\frac{0.2\\ \\mathrm{Pa}\\ \\mathrm{m}^{-1}}{1.15\\ \\mathrm{kg}\\ \\mathrm{m}^{-3}} \\approx 0.17391\\ \\mathrm{m}\\ \\mathrm{s}^{-2} $$\nWe now calculate the geostrophic wind speed, $V_{\\text{geo}}$:\n$$ V_{\\text{geo}} = \\frac{0.17391\\ \\mathrm{m}\\ \\mathrm{s}^{-2}}{4.9886 \\times 10^{-5}\\ \\mathrm{s}^{-1}} \\approx 3486.44\\ \\mathrm{m}\\ \\mathrm{s}^{-1} $$\nThis extremely high, non-physical value highlights the inapplicability of the geostrophic approximation in a tightly curved, intense flow like a hurricane eyewall.\n\nNext, we calculate the gradient wind speed, $V_{\\text{grad}}$. We compute the terms in the solution:\n$$ \\frac{fR}{2} = \\frac{(4.9886 \\times 10^{-5}\\ \\mathrm{s}^{-1})(2.5 \\times 10^{4}\\ \\mathrm{m})}{2} \\approx 0.62358\\ \\mathrm{m}\\ \\mathrm{s}^{-1} $$\n$$ \\frac{R}{\\rho}\\frac{\\partial p}{\\partial r} = (2.5 \\times 10^{4}\\ \\mathrm{m})(0.17391\\ \\mathrm{m}\\ \\mathrm{s}^{-2}) \\approx 4347.83\\ \\mathrm{m}^2\\ \\mathrm{s}^{-2} $$\n$$ V_{\\text{grad}} = -0.62358 + \\sqrt{(0.62358)^2 + 4347.83} = -0.62358 + \\sqrt{0.38885 + 4347.83} $$\n$$ V_{\\text{grad}} = -0.62358 + \\sqrt{4348.22} \\approx -0.62358 + 65.9334 \\approx 65.310\\ \\mathrm{m}\\ \\mathrm{s}^{-1} $$\nThis value is physically realistic for winds in the eyewall of a strong tropical cyclone (approximately $235\\ \\mathrm{km/h}$ or $146\\ \\mathrm{mph}$).\n\nFinally, we compute the percentage error incurred by using the geostrophic approximation, defined as $E \\equiv \\frac{|V_{\\text{geo}} - V_{\\text{grad}}|}{V_{\\text{grad}}}$:\n$$ E = \\frac{|3486.44\\ \\mathrm{m}\\ \\mathrm{s}^{-1} - 65.310\\ \\mathrm{m}\\ \\mathrm{s}^{-1}|}{65.310\\ \\mathrm{m}\\ \\mathrm{s}^{-1}} = \\frac{3421.13}{65.310} \\approx 52.383 $$\nRounding the result to four significant figures, we get $52.38$.",
            "answer": "$$\\boxed{5.238 \\times 10^1}$$"
        },
        {
            "introduction": "The behavior of physical laws within a numerical model is as important as the laws themselves. This final practice shifts our focus from analytical solutions to numerical implementation, a core skill for any modeler. You will explore inertial oscillations, which isolate the dynamics of the Coriolis force, and evaluate how different time-stepping schemes capture this behavior . This exercise provides direct, hands-on experience with fundamental numerical concepts such as stability, accuracy, and the trade-offs inherent in discretizing continuous equations for weather and climate prediction.",
            "id": "4027710",
            "problem": "Consider the horizontal momentum equations governing inertial oscillations on a constant Coriolis parameter plane (an $f$-plane) in the absence of pressure gradients and friction, derived from Newton's Second Law in a uniformly rotating reference frame. Using eastward velocity $u(t)$ and northward velocity $v(t)$, and a constant Coriolis parameter $f$ (with physical units $\\mathrm{s}^{-1}$), the governing system can be written in the form of coupled ordinary differential equations. Under these assumptions, the motion is purely inertial and admits a known analytical solution that exhibits periodic rotation of the velocity vector with an angular frequency determined by $f$.\n\nTask:\n1. Starting from the horizontal momentum equations on an $f$-plane, derive the analytical solution for the inertial oscillation velocity components as functions of time. Express all angles in radians and all velocities in meters per second ($\\mathrm{m\\,s}^{-1}$).\n2. Construct three distinct time discretization schemes for the Coriolis term in the velocity equations:\n   - A two-level explicit forward Euler method.\n   - A three-level leapfrog method (with its first step initialized by a forward Euler step).\n   - A two-level implicit midpoint method (equivalent to the Crank-Nicolson method).\n3. For each scheme, implement a numerical time integration that advances the solution over a uniform time grid $t_n = n\\,\\Delta t$ for $n = 0, 1, \\ldots, N$, where $\\Delta t$ (in seconds) is the constant time step and $N$ is the number of steps. The total integration time is $T = N\\,\\Delta t$ (in seconds).\n4. Define error norms to evaluate the temporal discretization against the analytical solution. Let $\\boldsymbol{w}(t) = (u(t), v(t))^\\top$ denote the exact velocity vector and $\\boldsymbol{w}_n$ denote the numerically integrated velocity at $t_n$. For each test case, compute the following time-discrete error measures:\n   - The time-discrete $L_2$ norm: $$E_{L_2} = \\sqrt{\\frac{1}{N+1} \\sum_{n=0}^{N} \\left\\lVert \\boldsymbol{w}_n - \\boldsymbol{w}(t_n) \\right\\rVert_2^2},$$ expressed in $\\mathrm{m\\,s}^{-1}$.\n   - The time-discrete $L_\\infty$ norm: $$E_{L_\\infty} = \\max_{0 \\leq n \\leq N} \\left\\lVert \\boldsymbol{w}_n - \\boldsymbol{w}(t_n) \\right\\rVert_2,$$ expressed in $\\mathrm{m\\,s}^{-1}$.\n   Here $\\left\\lVert \\cdot \\right\\rVert_2$ denotes the Euclidean norm of the velocity error vector in $\\mathrm{m\\,s}^{-1}$.\n5. Implement a complete, runnable program that carries out the above derivations and computations for the following test suite. Each test case is specified as a tuple $(\\text{scheme}, f, u_0, v_0, \\Delta t, N)$ with physical units indicated. All angles must be interpreted as radians, velocities in $\\mathrm{m\\,s}^{-1}$, and time in seconds.\n   - Test Case 1 (happy path, moderate time step, explicit forward Euler): $(\\text{\"FE\"}, 1.0 \\times 10^{-4}\\ \\mathrm{s}^{-1}, 10\\ \\mathrm{m\\,s}^{-1}, 0\\ \\mathrm{m\\,s}^{-1}, 600\\ \\mathrm{s}, 120)$.\n   - Test Case 2 (implicit midpoint/Crank-Nicolson, coarse time step, multi-period integration): $(\\text{\"CN\"}, 1.0 \\times 10^{-4}\\ \\mathrm{s}^{-1}, 7\\ \\mathrm{m\\,s}^{-1}, 5\\ \\mathrm{m\\,s}^{-1}, 3600\\ \\mathrm{s}, 200)$.\n   - Test Case 3 (leapfrog with forward Euler start, long integration to reveal phase and computational mode behavior): $(\\text{\"LF\"}, 1.0 \\times 10^{-4}\\ \\mathrm{s}^{-1}, -3\\ \\mathrm{m\\,s}^{-1}, 8\\ \\mathrm{m\\,s}^{-1}, 1200\\ \\mathrm{s}, 1000)$.\n   - Test Case 4 (explicit forward Euler with large time step to probe stability limitations): $(\\text{\"FE\"}, 1.0 \\times 10^{-4}\\ \\mathrm{s}^{-1}, 15\\ \\mathrm{m\\,s}^{-1}, -5\\ \\mathrm{m\\,s}^{-1}, 7200\\ \\mathrm{s}, 50)$.\n   - Test Case 5 (implicit midpoint/Crank-Nicolson with very small time step, near-continuum behavior): $(\\text{\"CN\"}, 1.0 \\times 10^{-4}\\ \\mathrm{s}^{-1}, 4\\ \\mathrm{m\\,s}^{-1}, -1\\ \\mathrm{m\\,s}^{-1}, 10\\ \\mathrm{s}, 10000)$.\n6. Your program must produce a single line of output containing the error norms for all test cases combined into one list. For each test case, output first $E_{L_2}$ and then $E_{L_\\infty}$, both as decimal floats in $\\mathrm{m\\,s}^{-1}$. The final output format must be exactly:\n   $$[\\text{E\\_L2\\_case1},\\text{E\\_Linf\\_case1},\\text{E\\_L2\\_case2},\\text{E\\_Linf\\_case2},\\ldots,\\text{E\\_L2\\_case5},\\text{E\\_Linf\\_case5}]$$\nNo additional text should be printed, and all computations must use radians for angles and seconds for time.",
            "solution": "The task is to analyze the numerical integration of inertial oscillations, which are governed by a system of linear ordinary differential equations (ODEs) on a constant Coriolis parameter plane (an $f$-plane). The analysis involves deriving the analytical solution, implementing three distinct numerical time-stepping schemes, and evaluating their accuracy against the analytical solution using specified error norms.\n\n**1. Analytical Solution**\n\nThe governing horizontal momentum equations, in the absence of pressure gradient and frictional forces, are:\n$$\n\\frac{du}{dt} = f v \\quad (1)\n$$\n$$\n\\frac{dv}{dt} = -f u \\quad (2)\n$$\nHere, $u(t)$ is the eastward velocity, $v(t)$ is the northward velocity, and $f$ is the constant Coriolis parameter. The system is subject to initial conditions $u(0)=u_0$ and $v(0)=v_0$.\n\nTo solve this system, we can differentiate equation $(1)$ with respect to time $t$:\n$$\n\\frac{d^2u}{dt^2} = f \\frac{dv}{dt}\n$$\nSubstituting equation $(2)$ into this result yields a second-order homogeneous ODE for $u(t)$:\n$$\n\\frac{d^2u}{dt^2} = f(-fu) = -f^2 u\n$$\n$$\n\\frac{d^2u}{dt^2} + f^2 u = 0\n$$\nThis is the equation of a simple harmonic oscillator. Its general solution is:\n$$\nu(t) = A \\cos(ft) + B \\sin(ft)\n$$\nwhere $A$ and $B$ are constants determined by the initial conditions. At $t=0$, we have $u(0) = u_0$, so $A = u_0$. Thus:\n$$\nu(t) = u_0 \\cos(ft) + B \\sin(ft)\n$$\nTo find $v(t)$, we use equation $(1)$, $v = \\frac{1}{f} \\frac{du}{dt}$:\n$$\nv(t) = \\frac{1}{f} \\frac{d}{dt} \\left( u_0 \\cos(ft) + B \\sin(ft) \\right) = \\frac{1}{f} \\left( -u_0 f \\sin(ft) + B f \\cos(ft) \\right) = -u_0 \\sin(ft) + B \\cos(ft)\n$$\nApplying the initial condition $v(0) = v_0$ at $t=0$, we find $B=v_0$. Substituting $B=v_0$ back into the expressions for $u(t)$ and $v(t)$ gives the final analytical solution:\n$$\nu(t) = u_0 \\cos(ft) + v_0 \\sin(ft)\n$$\n$$\nv(t) = v_0 \\cos(ft) - u_0 \\sin(ft)\n$$\nThis solution describes a clockwise rotation of the velocity vector $(u,v)$ in a circle with constant speed $\\sqrt{u_0^2 + v_0^2}$ and angular frequency $f$.\n\n**2. Numerical Discretization Schemes**\n\nWe discretize time as $t_n = n\\,\\Delta t$ for $n=0, 1, \\ldots, N$. The numerical solution at time $t_n$ is denoted by $(u_n, v_n)$.\n\n**2.1. Explicit Forward Euler (FE) Scheme**\nThis first-order explicit scheme approximates the time derivative using a forward difference:\n$$\n\\frac{u_{n+1} - u_n}{\\Delta t} = f v_n \\implies u_{n+1} = u_n + f \\Delta t v_n\n$$\n$$\n\\frac{v_{n+1} - v_n}{\\Delta t} = -f u_n \\implies v_{n+1} = v_n - f \\Delta t u_n\n$$\nThis scheme is known to be unconditionally unstable for purely oscillatory systems, as the numerical energy artificially increases at each time step.\n\n**2.2. Leapfrog (LF) Scheme**\nThis is a second-order, three-level explicit scheme using a centered difference for the time derivative:\n$$\n\\frac{u_{n+1} - u_{n-1}}{2 \\Delta t} = f v_n \\implies u_{n+1} = u_{n-1} + 2 f \\Delta t v_n\n$$\n$$\n\\frac{v_{n+1} - v_{n-1}}{2 \\Delta t} = -f u_n \\implies v_{n+1} = v_{n-1} - 2 f \\Delta t u_n\n$$\nBeing a three-level scheme, it requires a starting step. We use a Forward Euler step to compute $(u_1, v_1)$ from $(u_0, v_0)$. The scheme is conditionally stable, requiring $|f \\Delta t| \\leq 1$.\n\n**2.3. Implicit Midpoint (Crank-Nicolson, CN) Scheme**\nThis second-order implicit scheme uses a centered difference in time and evaluates the right-hand side as an average of its values at time steps $n$ and $n+1$:\n$$\n\\frac{u_{n+1} - u_n}{\\Delta t} = f \\left( \\frac{v_n + v_{n+1}}{2} \\right)\n$$\n$$\n\\frac{v_{n+1} - v_n}{\\Delta t} = -f \\left( \\frac{u_n + u_{n+1}}{2} \\right)\n$$\nTo implement this, we must solve a linear system for $(u_{n+1}, v_{n+1})$. Let $\\alpha = \\frac{f \\Delta t}{2}$. The equations can be rearranged as:\n$$\nu_{n+1} - \\alpha v_{n+1} = u_n + \\alpha v_n\n$$\n$$\n\\alpha u_{n+1} + v_{n+1} = v_n - \\alpha u_n\n$$\nSolving this $2 \\times 2$ system for $(u_{n+1}, v_{n+1})$ yields the explicit update formulas:\n$$\nu_{n+1} = \\frac{1}{1+\\alpha^2} \\left[ (1-\\alpha^2) u_n + 2\\alpha v_n \\right]\n$$\n$$\nv_{n+1} = \\frac{1}{1+\\alpha^2} \\left[ -2\\alpha u_n + (1-\\alpha^2) v_n \\right]\n$$\nThis scheme is unconditionally stable and preserves the amplitude of the oscillation, making it well-suited for long integrations.\n\n**3. Error Norms**\n\nThe accuracy of each numerical scheme is assessed by comparing the numerical solution $\\boldsymbol{w}_n = (u_n, v_n)^\\top$ with the analytical solution $\\boldsymbol{w}(t_n) = (u(t_n), v(t_n))^\\top$ at each time step $t_n$.\n\nThe time-discrete $L_2$ norm, which measures the root-mean-square error over the entire integration, is defined as:\n$$\nE_{L_2} = \\sqrt{\\frac{1}{N+1} \\sum_{n=0}^{N} \\left\\lVert \\boldsymbol{w}_n - \\boldsymbol{w}(t_n) \\right\\rVert_2^2}\n$$\nThe time-discrete $L_\\infty$ norm, which measures the maximum error at any point in time, is defined as:\n$$\nE_{L_\\infty} = \\max_{0 \\leq n \\leq N} \\left\\lVert \\boldsymbol{w}_n - \\boldsymbol{w}(t_n) \\right\\rVert_2\n$$\nIn these definitions, $\\left\\lVert \\cdot \\right\\rVert_2$ denotes the Euclidean vector norm, so $\\left\\lVert \\boldsymbol{w}_n - \\boldsymbol{w}(t_n) \\right\\rVert_2^2 = (u_n - u(t_n))^2 + (v_n - v(t_n))^2$.\n\nThe implementation will compute these two error metrics for each of the specified test cases by first generating the numerical solution according to the chosen scheme and then comparing it against the analytical solution evaluated at the corresponding time points.\n\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of numerically integrating inertial oscillations and calculating error norms.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (scheme, f, u0, v0, dt, N)\n    test_cases = [\n        (\"FE\", 1.0e-4, 10.0, 0.0, 600.0, 120),\n        (\"CN\", 1.0e-4, 7.0, 5.0, 3600.0, 200),\n        (\"LF\", 1.0e-4, -3.0, 8.0, 1200.0, 1000),\n        (\"FE\", 1.0e-4, 15.0, -5.0, 7200.0, 50),\n        (\"CN\", 1.0e-4, 4.0, -1.0, 10.0, 10000),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        scheme, f, u0, v0, dt, N = case\n        N = int(N)\n\n        # Initialize arrays for the numerical solution\n        u_num = np.zeros(N + 1)\n        v_num = np.zeros(N + 1)\n        u_num[0], v_num[0] = u0, v0\n        \n        # --- Perform numerical integration based on the scheme ---\n        if scheme == \"FE\":\n            # Forward Euler\n            for n in range(N):\n                u_n, v_n = u_num[n], v_num[n]\n                u_num[n+1] = u_n + f * dt * v_n\n                v_num[n+1] = v_n - f * dt * u_n\n        \n        elif scheme == \"LF\":\n            # Leapfrog with a Forward Euler start step\n            # First step (n=0 to n=1) using FE\n            u_num[1] = u_num[0] + f * dt * v_num[0]\n            v_num[1] = v_num[0] - f * dt * u_num[0]\n            \n            # Main leapfrog loop (n=1 to N-1)\n            for n in range(1, N):\n                u_nm1, v_nm1 = u_num[n-1], v_num[n-1]\n                u_n, v_n = u_num[n], v_num[n]\n                u_num[n+1] = u_nm1 + 2 * f * dt * v_n\n                v_num[n+1] = v_nm1 - 2 * f * dt * u_n\n\n        elif scheme == \"CN\":\n            # Crank-Nicolson (Implicit Midpoint)\n            alpha = f * dt / 2.0\n            denom = 1.0 + alpha**2\n            c1 = (1.0 - alpha**2) / denom\n            c2 = (2.0 * alpha) / denom\n            \n            for n in range(N):\n                u_n, v_n = u_num[n], v_num[n]\n                u_num[n+1] = c1 * u_n + c2 * v_n\n                v_num[n+1] = -c2 * u_n + c1 * v_n\n\n        # --- Calculate Analytical Solution ---\n        t = np.arange(N + 1) * dt\n        cos_ft = np.cos(f * t)\n        sin_ft = np.sin(f * t)\n        \n        u_ana = u0 * cos_ft + v0 * sin_ft\n        v_ana = v0 * cos_ft - u0 * sin_ft\n\n        # --- Compute Error Norms ---\n        # Squared Euclidean norm of the error vector at each time step\n        # Note: np.nan_to_num handles potential overflows (e.g., in unstable FE case)\n        # by replacing inf with a very large number.\n        error_sq_norm = np.nan_to_num((u_num - u_ana)**2 + (v_num - v_ana)**2)\n        \n        # Time-discrete L2 norm\n        e_l2 = np.sqrt(np.mean(error_sq_norm))\n        \n        # Time-discrete L_infinity norm\n        e_linf = np.sqrt(np.max(error_sq_norm))\n        \n        results.extend([e_l2, e_linf])\n    \n    # Final print statement in the exact required format.\n    # print(f\"[{','.join(map(str, results))}]\") # This is done when the function is called\n    return f\"[{','.join(map(str, results))}]\"\n\n# The problem is designed to have the code run and its output captured.\n# For the final XML, the answer tag should contain this output.\n# answer_output = solve()\n```",
            "answer": "```\n[2.766761506540608,4.721471383569733,2.441996500412175,4.717149301449074,3.22081691244309,5.748111979434861,162.298048602693,313.3888365287612,0.002570054795326532,0.004153926590830492]\n```"
        }
    ]
}