{
    "hands_on_practices": [
        {
            "introduction": "The primitive equations contain a full description of fluid motion, but for specific scales of atmospheric flow, some terms dominate over others. Scale analysis is the primary tool for identifying these dominant balances, allowing us to simplify the equations and gain physical insight. This first exercise  will guide you through a scale analysis of the horizontal momentum equations to derive the Rossby number, a critical non-dimensional parameter that quantifies the validity of the quasi-geostrophic approximation.",
            "id": "4078709",
            "problem": "Consider a midlatitude synoptic-scale flow described by the hydrostatic primitive equations on an $f$-plane, derived from Newton's second law in a rotating frame. The horizontal momentum equations may be written in terms of the horizontal velocity $\\boldsymbol{u}_{h} = (u, v)$, the Coriolis parameter $f$, and the geopotential $\\Phi$ as\n$$\n\\frac{D \\boldsymbol{u}_{h}}{D t} + f \\,\\hat{\\boldsymbol{k}} \\times \\boldsymbol{u}_{h} = - \\nabla_{h} \\Phi + \\boldsymbol{F}_{h},\n$$\nwhere $D/Dt = \\partial/\\partial t + \\boldsymbol{u}_{h} \\cdot \\nabla_{h} + w \\,\\partial/\\partial z$ is the material derivative, $w$ is the vertical velocity, and $\\boldsymbol{F}_{h}$ denotes frictional forces. Under the Quasi-Geostrophic (QG) approximation, the leading-order geostrophic balance neglects nonlinear advective accelerations. To evaluate the limitations of QG theory for a specific situation, derive from first principles a non-dimensional ratio that quantifies the combined magnitude of the neglected horizontal nonlinear advection term $(\\boldsymbol{u}_{h} \\cdot \\nabla_{h}) \\boldsymbol{u}_{h}$ and the vertical nonlinear advection term $w \\,\\partial \\boldsymbol{u}_{h}/\\partial z$ relative to the Coriolis term $f \\,\\hat{\\boldsymbol{k}} \\times \\boldsymbol{u}_{h}$, using scale analysis with the following scientifically plausible synoptic scales:\n$$\nU = 18 \\ \\mathrm{m} \\ \\mathrm{s}^{-1}, \\quad L = 1.2 \\times 10^{6} \\ \\mathrm{m}, \\quad H = 7.0 \\times 10^{3} \\ \\mathrm{m}, \\quad f = 1.1 \\times 10^{-4} \\ \\mathrm{s}^{-1}.\n$$\nAssume hydrostatic balance, Boussinesq continuity, and midlatitude scaling for the vertical shear. Express the final result as a single pure number representing the magnitude of the neglected nonlinear advection relative to the Coriolis acceleration. Round your answer to four significant figures. State your final numerical result as a non-dimensional quantity (no unit).",
            "solution": "The user has provided a well-posed problem in geophysical fluid dynamics. All givens are scientifically sound and consistent, and the required derivation falls within the established principles of scale analysis applied to the primitive equations of atmospheric motion. The problem is therefore deemed valid.\n\nThe objective is to derive a non-dimensional ratio, let's call it $R$, that quantifies the magnitude of the total nonlinear advection of horizontal momentum relative to the magnitude of the Coriolis acceleration. The total nonlinear advection of horizontal momentum includes both horizontal and vertical advection, as indicated in the material derivative. The Coriolis acceleration is the term involving the Coriolis parameter $f$.\n\nThe ratio $R$ is defined as:\n$$\nR = \\frac{\\text{Magnitude of } [(\\boldsymbol{u}_{h} \\cdot \\nabla_{h}) \\boldsymbol{u}_{h} + w \\,\\partial \\boldsymbol{u}_{h}/\\partial z]}{\\text{Magnitude of } [f \\,\\hat{\\boldsymbol{k}} \\times \\boldsymbol{u}_{h}]}\n$$\n\nWe will use scale analysis to determine the characteristic magnitude of each term. Let $U$, $L$, $H$, and $W$ represent the characteristic scales for horizontal velocity, horizontal length, vertical length, and vertical velocity, respectively. Let $f$ be the scale for the Coriolis parameter. The provided scales are:\n- Horizontal velocity scale: $U = 18 \\ \\mathrm{m} \\ \\mathrm{s}^{-1}$\n- Horizontal length scale: $L = 1.2 \\times 10^{6} \\ \\mathrm{m}$\n- Vertical length scale: $H = 7.0 \\times 10^{3} \\ \\mathrm{m}$\n- Coriolis parameter: $f = 1.1 \\times 10^{-4} \\ \\mathrm{s}^{-1}$\n\nFirst, we analyze the denominator term, the Coriolis acceleration, $f \\,\\hat{\\boldsymbol{k}} \\times \\boldsymbol{u}_{h}$. Its magnitude is $|f| |\\boldsymbol{u}_{h}| \\sin(\\theta)$, where $\\theta$ is the angle between the vertical unit vector $\\hat{\\boldsymbol{k}}$ and the horizontal velocity vector $\\boldsymbol{u}_{h}$. This angle is $\\pi/2$, so $\\sin(\\pi/2)=1$. The characteristic magnitude of this term is:\n$$\n[f \\,\\hat{\\boldsymbol{k}} \\times \\boldsymbol{u}_{h}] \\sim f U\n$$\n\nNext, we analyze the numerator, which represents the nonlinear advection of horizontal momentum. It consists of two terms.\nThe first term is the horizontal advection of horizontal momentum, $(\\boldsymbol{u}_{h} \\cdot \\nabla_{h}) \\boldsymbol{u}_{h}$. Using scale analysis, the magnitude of the horizontal gradient operator $\\nabla_{h}$ is $1/L$. Thus, the scale of this term is:\n$$\n[(\\boldsymbol{u}_{h} \\cdot \\nabla_{h}) \\boldsymbol{u}_{h}] \\sim [u] \\frac{[\\boldsymbol{u}_{h}]}{[x]} \\sim U \\frac{U}{L} = \\frac{U^2}{L}\n$$\n\nThe second term is the vertical advection of horizontal momentum, $w \\,\\partial \\boldsymbol{u}_{h}/\\partial z$. The scale of the vertical derivative $\\partial/\\partial z$ is $1/H$. The scale of this term is:\n$$\n[w \\,\\partial \\boldsymbol{u}_{h}/\\partial z] \\sim W \\frac{U}{H}\n$$\nTo proceed, we must determine the scale $W$ for the vertical velocity. The problem specifies the use of the Boussinesq continuity equation, which is $\\nabla_{h} \\cdot \\boldsymbol{u}_{h} + \\partial w/\\partial z = 0$. We perform a scale analysis on this equation:\n$$\n[\\nabla_{h} \\cdot \\boldsymbol{u}_{h}] + [\\partial w/\\partial z] \\sim 0\n$$\n$$\n\\frac{U}{L} + \\frac{W}{H} \\sim 0\n$$\nFor these terms to balance, their magnitudes must be of the same order:\n$$\n\\frac{W}{H} \\sim \\frac{U}{L} \\implies W \\sim U \\frac{H}{L}\n$$\nNow we can substitute this scale for $W$ back into the expression for the scale of the vertical advection term:\n$$\n[w \\,\\partial \\boldsymbol{u}_{h}/\\partial z] \\sim \\left(U \\frac{H}{L}\\right) \\frac{U}{H} = \\frac{U^2}{L}\n$$\nWe observe that for synoptic-scale motion, both the horizontal and vertical advection of horizontal momentum have the same characteristic scale, $U^2/L$. The problem asks for the \"combined magnitude\" of these terms. In scale analysis, when two terms contributing to a physical process have the same order of magnitude, the order of magnitude of their sum is taken to be that same order. Therefore, the scale of the total nonlinear advection is:\n$$\n[(\\boldsymbol{u}_{h} \\cdot \\nabla_{h}) \\boldsymbol{u}_{h} + w \\,\\partial \\boldsymbol{u}_{h}/\\partial z] \\sim \\frac{U^2}{L}\n$$\nNow we can construct the non-dimensional ratio $R$ by dividing the scale of the nonlinear advection by the scale of the Coriolis acceleration:\n$$\nR = \\frac{U^2/L}{fU} = \\frac{U}{fL}\n$$\nThis ratio is known as the Rossby number, $Ro$. It is the fundamental parameter that measures the importance of advective inertia relative to the Coriolis force. The Quasi-Geostrophic approximation is valid when $Ro \\ll 1$.\n\nWe now substitute the given numerical values into the expression for $R$:\n$$\nU = 18 \\ \\mathrm{m} \\ \\mathrm{s}^{-1}\n$$\n$$\nf = 1.1 \\times 10^{-4} \\ \\mathrm{s}^{-1}\n$$\n$$\nL = 1.2 \\times 10^{6} \\ \\mathrm{m}\n$$\nThe calculation proceeds as follows:\n$$\nR = \\frac{18}{(1.1 \\times 10^{-4}) \\times (1.2 \\times 10^{6})}\n$$\nFirst, calculate the denominator:\n$$\nfL = (1.1 \\times 1.2) \\times (10^{-4} \\times 10^{6}) = 1.32 \\times 10^{2} = 132\n$$\nThe units of the denominator are $(\\mathrm{s}^{-1}) \\times (\\mathrm{m}) = \\mathrm{m} \\ \\mathrm{s}^{-1}$, which are the same as the units of $U$, confirming that $R$ is a non-dimensional quantity.\nNow, calculate the ratio:\n$$\nR = \\frac{18}{132} = \\frac{3}{22} \\approx 0.13636363...\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\nR \\approx 0.1364\n$$\nThis value, being substantially less than $1$, indicates that for the given synoptic scales, the nonlinear advective terms are indeed small compared to the Coriolis term, which provides justification for the geostrophic approximation as the leading-order balance.",
            "answer": "$$\n\\boxed{0.1364}\n$$"
        },
        {
            "introduction": "For large-scale midlatitude flows where the Rossby number is small, the primary balance in the horizontal momentum equations is between the Coriolis force and the pressure gradient force, leading to the geostrophic wind. However, it is the *imbalance* between these forces that drives atmospheric evolution, producing vertical motion and weather. This practice  focuses on quantifying this imbalance by deriving a diagnostic expression for the ageostrophic wind, revealing its direct connection to fluid acceleration.",
            "id": "4078720",
            "problem": "A midlatitude mesoscale flow on an $f$-plane is modeled by the horizontal momentum equations of the primitive system under the Boussinesq approximation, neglecting frictional forces and metric terms, and assuming hydrostatic balance for the vertical pressure distribution. The horizontal momentum equations for the velocity vector $\\boldsymbol{u} = (u,v)$ in Cartesian coordinates are\n$$\n\\frac{D \\boldsymbol{u}}{D t} + f \\, \\boldsymbol{k} \\times \\boldsymbol{u} = - \\frac{1}{\\rho} \\nabla_{h} p,\n$$\nwhere $f$ is the Coriolis parameter, $\\boldsymbol{k}$ is the unit vector in the vertical direction, $\\rho$ is density, and $\\nabla_{h}$ is the horizontal gradient operator. The geostrophic wind $\\boldsymbol{u}_{g}$ is defined by the geostrophic balance\n$$\nf \\, \\boldsymbol{k} \\times \\boldsymbol{u}_{g} = - \\frac{1}{\\rho} \\nabla_{h} p,\n$$\nand the ageostrophic wind is $\\boldsymbol{u}_{a} \\equiv \\boldsymbol{u} - \\boldsymbol{u}_{g}$.\n\nStart from the stated primitive momentum equation and the geostrophic definition to derive a leading-order diagnostic expression for the magnitude of the ageostrophic wind $|\\boldsymbol{u}_{a}|$ in terms of the horizontal acceleration scale $A_{h}$ and the Coriolis parameter $f$. Then, using the Rossby number defined by\n$$\n\\mathrm{Ro} \\equiv \\frac{A_{h}}{f \\, |\\boldsymbol{u}_{g}|},\n$$\nshow how the same magnitude can be expressed in terms of $\\mathrm{Ro}$ and $|\\boldsymbol{u}_{g}|$ under the same assumptions.\n\nFor a specific flow with Coriolis parameter $f = 1.03 \\times 10^{-4} \\ \\mathrm{s}^{-1}$, horizontal acceleration scale $A_{h} = 2.40 \\times 10^{-4} \\ \\mathrm{m} \\ \\mathrm{s}^{-2}$, and Rossby number $\\mathrm{Ro} = 0.16$, compute the numerical value of the magnitude of the ageostrophic wind $|\\boldsymbol{u}_{a}|$. Express your final answer in $\\mathrm{m} \\ \\mathrm{s}^{-1}$ and round your result to four significant figures. Provide only the single numerical value as your final answer.",
            "solution": "The problem is validated according to the specified criteria.\n\n### Step 1: Extract Givens\nThe problem provides the following information:\n-   **Horizontal momentum equation:**\n    $$ \\frac{D \\boldsymbol{u}}{D t} + f \\, \\boldsymbol{k} \\times \\boldsymbol{u} = - \\frac{1}{\\rho} \\nabla_{h} p $$\n    where $\\boldsymbol{u} = (u,v)$ is the horizontal velocity, $f$ is the Coriolis parameter, $\\boldsymbol{k}$ is the vertical unit vector, $\\rho$ is density, $p$ is pressure, and $D/Dt$ is the material derivative.\n-   **Geostrophic wind definition:**\n    $$ f \\, \\boldsymbol{k} \\times \\boldsymbol{u}_{g} = - \\frac{1}{\\rho} \\nabla_{h} p $$\n-   **Ageostrophic wind definition:**\n    $$ \\boldsymbol{u}_{a} \\equiv \\boldsymbol{u} - \\boldsymbol{u}_{g} $$\n-   **Rossby number definition:**\n    $$ \\mathrm{Ro} \\equiv \\frac{A_{h}}{f \\, |\\boldsymbol{u}_{g}|} $$\n    where $A_h$ is the horizontal acceleration scale.\n-   **Numerical values:**\n    -   $f = 1.03 \\times 10^{-4} \\ \\mathrm{s}^{-1}$\n    -   $A_{h} = 2.40 \\times 10^{-4} \\ \\mathrm{m} \\ \\mathrm{s}^{-2}$\n    -   $\\mathrm{Ro} = 0.16$\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed for validity:\n-   **Scientifically Grounded:** The problem is based on the primitive equations of motion, which are fundamental to geophysical fluid dynamics and numerical weather prediction. The equations and definitions for geostrophic and ageostrophic wind are standard. The assumptions (Boussinesq, hydrostatic, f-plane, inviscid) are common and appropriate for modeling midlatitude mesoscale phenomena. The numerical values are physically realistic for such flows.\n-   **Well-Posed:** The problem is well-posed. It asks for specific derivations and a numerical calculation based on a self-contained set of equations and data. The information is sufficient and consistent, allowing for a unique solution.\n-   **Objective:** The problem is stated using precise, standard scientific terminology, free of ambiguity or subjective claims.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A full solution will be provided.\n\n### Derivation of the Ageostrophic Wind Magnitude\n\nThe derivation begins with the horizontal momentum equation provided:\n$$ \\frac{D \\boldsymbol{u}}{D t} + f \\, \\boldsymbol{k} \\times \\boldsymbol{u} = - \\frac{1}{\\rho} \\nabla_{h} p $$\nThe pressure gradient term, $- \\frac{1}{\\rho} \\nabla_{h} p$, is defined by the geostrophic balance:\n$$ - \\frac{1}{\\rho} \\nabla_{h} p = f \\, \\boldsymbol{k} \\times \\boldsymbol{u}_{g} $$\nSubstituting this definition into the momentum equation yields:\n$$ \\frac{D \\boldsymbol{u}}{D t} + f \\, \\boldsymbol{k} \\times \\boldsymbol{u} = f \\, \\boldsymbol{k} \\times \\boldsymbol{u}_{g} $$\nWe can rearrange this equation to isolate the acceleration term:\n$$ \\frac{D \\boldsymbol{u}}{D t} = f \\, \\boldsymbol{k} \\times \\boldsymbol{u}_{g} - f \\, \\boldsymbol{k} \\times \\boldsymbol{u} $$\nFactoring out the common terms on the right-hand side gives:\n$$ \\frac{D \\boldsymbol{u}}{D t} = f \\, \\boldsymbol{k} \\times (\\boldsymbol{u}_{g} - \\boldsymbol{u}) $$\nThe ageostrophic wind is defined as $\\boldsymbol{u}_{a} = \\boldsymbol{u} - \\boldsymbol{u}_{g}$. Therefore, $\\boldsymbol{u}_{g} - \\boldsymbol{u} = -\\boldsymbol{u}_{a}$. Substituting this into the equation results in a direct relationship between the total acceleration and the ageostrophic wind:\n$$ \\frac{D \\boldsymbol{u}}{D t} = -f \\, \\boldsymbol{k} \\times \\boldsymbol{u}_{a} $$\nThe problem asks for an expression for the magnitude of the ageostrophic wind, $|\\boldsymbol{u}_{a}|$. We take the magnitude of both sides of this vector equation:\n$$ \\left| \\frac{D \\boldsymbol{u}}{D t} \\right| = \\left| -f \\, \\boldsymbol{k} \\times \\boldsymbol{u}_{a} \\right| $$\nThe problem defines $A_{h}$ as the horizontal acceleration scale, which we interpret as the magnitude of the total horizontal acceleration, $A_{h} = \\left| \\frac{D \\boldsymbol{u}}{D t} \\right|$. The magnitude of the right-hand side is $|-f| |\\boldsymbol{k}| |\\boldsymbol{u}_{a}| \\sin(\\theta)$, where $\\theta$ is the angle between the vectors $\\boldsymbol{k}$ and $\\boldsymbol{u}_{a}$. Since $\\boldsymbol{k}$ is the vertical unit vector and $\\boldsymbol{u}_{a}$ is a horizontal wind vector, they are orthogonal, so $\\theta = \\pi/2$ and $\\sin(\\theta) = 1$. The magnitude of the unit vector is $|\\boldsymbol{k}| = 1$. Given $f > 0$, we have $|-f| = f$.\nThe equation of magnitudes simplifies to:\n$$ A_{h} = f |\\boldsymbol{u}_{a}| $$\nSolving for the magnitude of the ageostrophic wind gives the first requested expression:\n$$ |\\boldsymbol{u}_{a}| = \\frac{A_{h}}{f} $$\nThis is the leading-order diagnostic expression for $|\\boldsymbol{u}_{a}|$.\n\nNext, we express $|\\boldsymbol{u}_{a}|$ in terms of the Rossby number, $\\mathrm{Ro}$, and the magnitude of the geostrophic wind, $|\\boldsymbol{u}_{g}|$. The Rossby number is defined as:\n$$ \\mathrm{Ro} = \\frac{A_{h}}{f \\, |\\boldsymbol{u}_{g}|} $$\nFrom our first result, we know that $A_{h} = f |\\boldsymbol{u}_{a}|$. Substituting this into the definition of the Rossby number:\n$$ \\mathrm{Ro} = \\frac{f |\\boldsymbol{u}_{a}|}{f \\, |\\boldsymbol{u}_{g}|} $$\nThe Coriolis parameter $f$ cancels out, leading to:\n$$ \\mathrm{Ro} = \\frac{|\\boldsymbol{u}_{a}|}{|\\boldsymbol{u}_{g}|} $$\nRearranging this to solve for $|\\boldsymbol{u}_{a}|$ gives the second requested expression:\n$$ |\\boldsymbol{u}_{a}| = \\mathrm{Ro} \\, |\\boldsymbol{u}_{g}| $$\n\n### Numerical Calculation\n\nThe problem provides the following values to compute the magnitude of the ageostrophic wind:\n-   $f = 1.03 \\times 10^{-4} \\ \\mathrm{s}^{-1}$\n-   $A_{h} = 2.40 \\times 10^{-4} \\ \\mathrm{m} \\ \\mathrm{s}^{-2}$\n\nUsing the first derived formula, we can directly compute $|\\boldsymbol{u}_{a}|$:\n$$ |\\boldsymbol{u}_{a}| = \\frac{A_{h}}{f} = \\frac{2.40 \\times 10^{-4} \\ \\mathrm{m} \\ \\mathrm{s}^{-2}}{1.03 \\times 10^{-4} \\ \\mathrm{s}^{-1}} $$\nThe factor of $10^{-4}$ cancels from the numerator and denominator:\n$$ |\\boldsymbol{u}_{a}| = \\frac{2.40}{1.03} \\ \\mathrm{m} \\ \\mathrm{s}^{-1} $$\nPerforming the division:\n$$ |\\boldsymbol{u}_{a}| \\approx 2.330097087... \\ \\mathrm{m} \\ \\mathrm{s}^{-1} $$\nThe problem requires the result to be rounded to four significant figures. The first four significant figures are $2$, $3$, $3$, and $0$. The fifth digit is $0$, so we round down (i.e., keep the fourth digit as is).\nTherefore, the numerical value of the magnitude of the ageostrophic wind is $2.330 \\ \\mathrm{m} \\ \\mathrm{s}^{-1}$.",
            "answer": "$$\n\\boxed{2.330}\n$$"
        },
        {
            "introduction": "Moving from physical theory to computational practice, a central challenge in numerical weather prediction is efficiently integrating the primitive equations over time. The equations support fast-moving inertia-gravity waves, which can severely constrain the time step of explicit numerical schemes. This final exercise  delves into the numerical stability of the linearized equations, asking you to compare the stability limits of a fully explicit scheme with a more advanced semi-implicit scheme, a technique widely used in modern forecast models to overcome this very limitation.",
            "id": "4078729",
            "problem": "Consider the linearized hydrostatic shallow-water primitive equations on a constant Coriolis parameter ($f$) plane, with mean depth $H$, gravitational acceleration $g$, and linear free-surface displacement $\\eta$. Neglect advection, friction, and diabatic sources. Let $\\mathbf{u} = (u, v)$ denote the horizontal velocity components. The governing equations are\n$$\n\\frac{\\partial u}{\\partial t} - f v = - g \\frac{\\partial \\eta}{\\partial x}, \\quad\n\\frac{\\partial v}{\\partial t} + f u = - g \\frac{\\partial \\eta}{\\partial y}, \\quad\n\\frac{\\partial \\eta}{\\partial t} + H\\left(\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y}\\right) = 0.\n$$\nAssume a doubly periodic domain and analyze a single horizontal Fourier mode with wavenumbers $k$ and $\\ell$, wavenumber magnitude $K = \\sqrt{k^{2} + \\ell^{2}}$, and phase proportional to $\\exp\\!\\left(i(k x + \\ell y - \\omega t)\\right)$. Define the gravity-wave speed $c = \\sqrt{g H}$.\n\nYou will compare two time discretizations applied to the inertia–gravity wave normal mode of this linear system:\n\n$1.$ A fully explicit leapfrog scheme applied to the full linear system:\n$$\n\\mathbf{X}^{n+1} = \\mathbf{X}^{n-1} + 2 \\,\\Delta t \\, \\mathcal{L} \\,\\mathbf{X}^{n},\n$$\nwhere $\\mathbf{X}^{n} = (u^{n}, v^{n}, \\eta^{n})$ and $\\mathcal{L}$ is the constant-coefficient linear operator of the spatially discretized system for the single Fourier mode.\n\n$2.$ A semi-implicit (SI) scheme in which the gravity-wave terms (pressure-gradient and continuity coupling) are time-discretized with the Crank–Nicolson method (which is second-order and centered in time), while the Coriolis terms are kept in the explicit leapfrog form. That is, decompose $\\mathcal{L} = \\mathcal{C} + \\mathcal{G}$ into the Coriolis part $\\mathcal{C}$ and the gravity-wave part $\\mathcal{G}$, and time-step such that $\\mathcal{G}$ is treated semi-implicitly by Crank–Nicolson and $\\mathcal{C}$ remains in the leapfrog right-hand side.\n\nStarting from first principles and without invoking any pre-derived target formulas, do the following:\n\n$-$ Derive the inertia–gravity wave dispersion relation $\\omega$ of the continuous system from the linearized equations and the Fourier-mode ansatz, in terms of $f$, $c$, and $K$.\n\n$-$ For the fully explicit leapfrog scheme, perform a von Neumann normal-mode stability analysis of the inertia–gravity wave mode and obtain the maximum stable time step $\\Delta t_{\\mathrm{E,max}}$ as a function of $f$, $c$, and $K$.\n\n$-$ For the semi-implicit scheme described, argue rigorously from the properties of Crank–Nicolson applied to linear skew-symmetric operators and from the leapfrog stability analysis of an inertial oscillator, to obtain the maximum stable time step $\\Delta t_{\\mathrm{SI,max}}$ imposed by the remaining explicit fast term.\n\nFinally, express your comparison as the closed-form ratio\n$$\nR = \\frac{\\Delta t_{\\mathrm{SI,max}}}{\\Delta t_{\\mathrm{E,max}}}\n$$\nin terms of $f$, $c$, and $K$. Your final answer must be the single analytic expression for $R$. No numerical evaluation is required and no rounding is permitted. No physical units are required since $R$ is dimensionless.",
            "solution": "The problem as stated is scientifically grounded, well-posed, objective, and self-contained. It is a standard exercise in the analysis of numerical methods for geophysical fluid dynamics, based on the fundamental linearized shallow-water equations. All necessary definitions, equations, and parameters are provided, and there are no internal contradictions or ambiguities. Therefore, the problem is deemed valid and a full solution is warranted.\n\nThe solution proceeds by following the sequence of tasks outlined in the problem statement.\n\nFirst, we derive the dispersion relation for inertia-gravity waves in the continuous system. The governing equations are:\n$$\n\\frac{\\partial u}{\\partial t} - f v = - g \\frac{\\partial \\eta}{\\partial x} \\quad (1)\n$$\n$$\n\\frac{\\partial v}{\\partial t} + f u = - g \\frac{\\partial \\eta}{\\partial y} \\quad (2)\n$$\n$$\n\\frac{\\partial \\eta}{\\partial t} + H\\left(\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y}\\right) = 0 \\quad (3)\n$$\nWe assume a plane-wave solution of the form $(u, v, \\eta) = (\\hat{u}, \\hat{v}, \\hat{\\eta}) \\exp\\!\\left(i(k x + \\ell y - \\omega t)\\right)$, where $(\\hat{u}, \\hat{v}, \\hat{\\eta})$ are constant complex amplitudes. Under this ansatz, the partial derivatives become multiplications: $\\frac{\\partial}{\\partial t} \\to -i\\omega$, $\\frac{\\partial}{\\partial x} \\to ik$, and $\\frac{\\partial}{\\partial y} \\to i\\ell$. Substituting this into equations $(1)-(3)$ yields a system of linear algebraic equations for the amplitudes:\n$$\n-i\\omega \\hat{u} - f \\hat{v} = - g (ik) \\hat{\\eta} \\quad (4)\n$$\n$$\n-i\\omega \\hat{v} + f \\hat{u} = - g (i\\ell) \\hat{\\eta} \\quad (5)\n$$\n$$\n-i\\omega \\hat{\\eta} + H\\left(ik \\hat{u} + i\\ell \\hat{v}\\right) = 0 \\quad (6)\n$$\nFrom equations $(4)$ and $(5)$, we solve for $\\hat{u}$ and $\\hat{v}$ in terms of $\\hat{\\eta}$:\n$$\n\\begin{pmatrix} -i\\omega  -f \\\\ f  -i\\omega \\end{pmatrix} \\begin{pmatrix} \\hat{u} \\\\ \\hat{v} \\end{pmatrix} = ig\\hat{\\eta} \\begin{pmatrix} k \\\\ \\ell \\end{pmatrix}\n$$\nThe determinant of the $2 \\times 2$ matrix is $(-i\\omega)^2 - (-f)(f) = f^2 - \\omega^2$. Assuming $\\omega^2 \\neq f^2$, we can invert the matrix to find:\n$$\n\\begin{pmatrix} \\hat{u} \\\\ \\hat{v} \\end{pmatrix} = \\frac{1}{f^2 - \\omega^2} \\begin{pmatrix} -i\\omega  f \\\\ -f  -i\\omega \\end{pmatrix} ig\\hat{\\eta} \\begin{pmatrix} k \\\\ \\ell \\end{pmatrix} = \\frac{ig}{f^2 - \\omega^2} \\begin{pmatrix} -i\\omega k + f\\ell \\\\ -fk -i\\omega\\ell \\end{pmatrix} \\hat{\\eta}\n$$\nSo, we have:\n$$\n\\hat{u} = \\frac{g( \\omega k + if\\ell )}{f^2 - \\omega^2} \\hat{\\eta} \\quad (7)\n$$\n$$\n\\hat{v} = \\frac{g( \\omega \\ell - ifk )}{f^2 - \\omega^2} \\hat{\\eta} \\quad (8)\n$$\nNow, substitute these expressions for $\\hat{u}$ and $\\hat{v}$ into equation $(6)$:\n$$\n-i\\omega \\hat{\\eta} + iH \\left( k \\frac{g(\\omega k + if\\ell)}{f^2 - \\omega^2} \\hat{\\eta} + \\ell \\frac{g(\\omega \\ell - ifk)}{f^2 - \\omega^2} \\hat{\\eta} \\right) = 0\n$$\nAssuming a non-trivial solution ($\\hat{\\eta} \\neq 0$), we can divide through by $i\\hat{\\eta}$:\n$$\n-\\omega + \\frac{gH}{f^2 - \\omega^2} \\left[ k(\\omega k + if\\ell) + \\ell(\\omega \\ell - ifk) \\right] = 0\n$$\n$$\n-\\omega + \\frac{gH}{f^2 - \\omega^2} \\left[ \\omega k^2 + ifk\\ell + \\omega \\ell^2 - ifk\\ell \\right] = 0\n$$\n$$\n-\\omega + \\frac{gH}{f^2 - \\omega^2} \\left[ \\omega (k^2 + \\ell^2) \\right] = 0\n$$\nThis equation admits a solution $\\omega=0$, which corresponds to the stationary geostrophic mode. For the inertia-gravity waves, we assume $\\omega \\neq 0$ and divide by $\\omega$:\n$$\n-1 + \\frac{gH(k^2 + \\ell^2)}{f^2 - \\omega^2} = 0\n$$\nUsing the definitions $K^2 = k^2 + \\ell^2$ and $c^2 = gH$, this simplifies to:\n$$\nf^2 - \\omega^2 = c^2 K^2\n$$\nThis yields the dispersion relation for inertia-gravity waves:\n$$\n\\omega^2 = f^2 + c^2 K^2\n$$\nThe frequencies of the inertia-gravity wave modes are $\\omega = \\pm \\sqrt{f^2 + c^2 K^2}$.\n\nSecond, we analyze the stability of the fully explicit leapfrog scheme. The scheme is given by $\\mathbf{X}^{n+1} = \\mathbf{X}^{n-1} + 2 \\Delta t \\mathcal{L} \\mathbf{X}^{n}$. For a linear system, the stability of this scheme is determined by the eigenvalues of the operator $\\mathcal{L}$. The continuous system is $\\frac{d\\mathbf{X}}{dt} = \\mathcal{L}\\mathbf{X}$. Comparing with the plane-wave time dependence $e^{-i\\omega t}$, we see that the eigenvalues of $\\mathcal{L}$ are $\\mu = -i\\omega$, where $\\omega$ are the eigenfrequencies of the continuous system. The eigenvalues of $\\mathcal{L}$ are therefore purely imaginary: $\\mu_j = -i\\omega_j$.\nFor the leapfrog scheme, we seek an amplification factor $\\lambda$ such that $\\mathbf{X}^n = \\lambda^n \\mathbf{X}^0$. Substituting this into the scheme for a single mode gives $\\lambda^2 \\mathbf{X}^0 = \\mathbf{X}^0 + 2 \\Delta t \\mu \\lambda \\mathbf{X}^0$, leading to the characteristic equation for $\\lambda$:\n$$\n\\lambda^2 - 2\\Delta t \\mu \\lambda - 1 = 0\n$$\nThe solutions for $\\lambda$ are $\\lambda = \\Delta t \\mu \\pm \\sqrt{(\\Delta t \\mu)^2 + 1}$. For stability, we require $|\\lambda| \\leq 1$ for all modes. Substituting $\\mu = -i\\omega$:\n$$\n\\lambda = -i\\omega\\Delta t \\pm \\sqrt{1 - (\\omega\\Delta t)^2}\n$$\nIf $|\\omega\\Delta t| \\leq 1$, then $1 - (\\omega\\Delta t)^2 \\ge 0$, and the term under the square root is real. The magnitude of $\\lambda$ is then $|\\lambda|^2 = (-\\omega\\Delta t)^2 + (1 - (\\omega\\Delta t)^2) = 1$. The scheme is neutrally stable. If $|\\omega\\Delta t|  1$, the term under the square root is imaginary, yielding one root with $|\\lambda|  1$, which leads to exponential growth and instability.\nThe stability condition is therefore $|\\omega\\Delta t| \\leq 1$ for all frequencies $\\omega$ present in the system. The maximum allowable time step is constrained by the highest frequency:\n$$\n\\Delta t \\leq \\frac{1}{\\max|\\omega|}\n$$\nFor the full inertia-gravity system, the highest frequency magnitude is $\\max|\\omega| = \\sqrt{f^2 + c^2 K^2}$. Thus, the maximum stable time step for the fully explicit scheme is:\n$$\n\\Delta t_{\\mathrm{E,max}} = \\frac{1}{\\sqrt{f^2 + c^2 K^2}}\n$$\n\nThird, we analyze the stability of the semi-implicit scheme. The linear operator $\\mathcal{L}$ is split into a Coriolis part $\\mathcal{C}$ and a gravity-wave part $\\mathcal{G}$. The scheme is:\n$$\n\\frac{\\mathbf{X}^{n+1} - \\mathbf{X}^{n-1}}{2\\Delta t} = \\mathcal{C}\\mathbf{X}^n + \\mathcal{G}\\frac{\\mathbf{X}^{n+1} + \\mathbf{X}^{n-1}}{2}\n$$\nThe term involving $\\mathcal{G}$ is treated implicitly using the Crank-Nicolson method (which is centered in time, matching the leapfrog scheme). The eigenvalues of the gravity wave operator $\\mathcal{G}$ are purely imaginary, $\\mu_{\\mathcal{G}} = 0, \\pm i c K$. The Crank-Nicolson scheme applied to an operator with purely imaginary eigenvalues is unconditionally stable; its amplification factor has a magnitude of exactly $1$ for any time step $\\Delta t$. Therefore, the implicit treatment of the gravity-wave terms imposes no stability restriction on the time step.\nThe stability of the overall semi-implicit scheme is thus limited by the explicit part of the calculation, which is the leapfrog treatment of the Coriolis term $\\mathcal{C}\\mathbf{X}^n$. We must analyze the stability of the leapfrog scheme applied to the system $\\frac{d\\mathbf{X}}{dt} = \\mathcal{C}\\mathbf{X}$. This describes inertial oscillations. The frequencies $\\omega_{\\mathcal{C}}$ of this system are given by the eigenvalues of $-i\\mathcal{C}$. The operator $\\mathcal{C}$ for the Fourier mode is:\n$$\n\\mathcal{C} = \\begin{pmatrix} 0  f  0 \\\\ -f  0  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\nIts characteristic equation is $\\det(\\mathcal{C} - \\mu I) = -\\mu(\\mu^2 + f^2) = 0$, giving eigenvalues $\\mu_{\\mathcal{C}} = 0, \\pm if$. The corresponding frequencies are $\\omega_{\\mathcal{C}} = 0, \\pm f$.\nThe leapfrog stability condition for this explicit part is $\\Delta t \\leq \\frac{1}{\\max|\\omega_{\\mathcal{C}}|}$. With $\\max|\\omega_{\\mathcal{C}}| = |f|$, the stability criterion becomes:\n$$\n\\Delta t |f| \\leq 1\n$$\nThus, the maximum stable time step for the semi-implicit scheme is dictated by the Coriolis frequency:\n$$\n\\Delta t_{\\mathrm{SI,max}} = \\frac{1}{|f|}\n$$\n\nFinally, we compute the ratio $R = \\Delta t_{\\mathrm{SI,max}} / \\Delta t_{\\mathrm{E,max}}$.\n$$\nR = \\frac{1/|f|}{1/\\sqrt{f^2 + c^2 K^2}} = \\frac{\\sqrt{f^2 + c^2 K^2}}{|f|}\n$$\nSince $|f|^2 = f^2$, we can write this as:\n$$\nR = \\sqrt{\\frac{f^2 + c^2 K^2}{f^2}} = \\sqrt{1 + \\frac{c^2 K^2}{f^2}}\n$$\nThis ratio quantifies the computational advantage of the semi-implicit scheme, which allows for a much larger time step when the gravity wave speed $c$ or the wavenumber $K$ is large compared to the inertial frequency $f$.",
            "answer": "$$\n\\boxed{\\sqrt{1 + \\frac{c^{2}K^{2}}{f^{2}}}}\n$$"
        }
    ]
}