{
    "hands_on_practices": [
        {
            "introduction": "理解任何波动系统的第一步是确定其基本构件——即“简正模”。这个练习将指导你推导一个纯惯性重力波的精确解，这是一个在旋转浅水系统中的基本波动模式。掌握这种构造对于验证数值天气和气候模型的动力学核心至关重要，因为它提供了一个已知演化的精确基准。",
            "id": "4088680",
            "problem": "考虑在 $f$ 平面上的单层流体，其平均深度为常数 $H$，重力加速度为 $g$ 的线性化旋转浅水方程 (SWE)：\n$$\n\\frac{\\partial u}{\\partial t} - f v = - g \\frac{\\partial \\eta}{\\partial x}, \\qquad\n\\frac{\\partial v}{\\partial t} + f u = - g \\frac{\\partial \\eta}{\\partial y}, \\qquad\n\\frac{\\partial \\eta}{\\partial t} + H \\left( \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} \\right) = 0,\n$$\n其中 $u(x,y,t)$ 和 $v(x,y,t)$ 是水平速度分量，$\\eta(x,y,t)$ 是相对于静止状态的自由表面高度扰动。假设一个尺寸为 $L_x$ 和 $L_y$ 的双周期域，并采用均匀网格，因此一个水平波矢为 $\\boldsymbol{k} = (k_x, k_y)$（其中 $k_x = \\frac{2 \\pi m}{L_x}$ 和 $k_y = \\frac{2 \\pi n}{L_y}$，$m$ 和 $n$ 为整数）的单一平面傅里叶模式可以无混叠地表示。\n\n从上述控制方程出发，不使用任何其他结果，构建一个一致的平面波初始条件，该条件只激发一个向右传播的惯性重力波模式（正频率分支），其自由表面振幅为给定的 $A_\\eta  0$，初始相位为 $\\phi_0 \\in \\mathbb{R}$：\n- 在时间 $t=0$ 时，令 $\\eta(x,y,0)$ 具有振幅为 $A_\\eta$、相位为 $\\phi_0$ 的单一平面波的空间结构，并确定相应的 $u(x,y,0)$ 和 $v(x,y,0)$，以确保不激发任何其他模式。\n- 推导在线性浅水方程下平面波相位和振幅的精确时间演化，并用其来给出自由表面高度随时间变化的精确解。\n\n作为你的最终答案，提供一个关于 $\\eta(x,y,t)$（对所有 $t \\ge 0$）的单一闭合形式解析表达式，该表达式用 $A_\\eta$、$\\phi_0$、$f$、$g$、$H$、$k_x$、$k_y$、$x$、$y$ 和 $t$ 表示。所有三角函数参数均应解释为弧度。无需进行数值计算，也无需四舍五入。最终答案只表达 $\\eta(x,y,t)$。最终答案表达式中不要包含任何单位。",
            "solution": "该问题要求在给定 $t=0$ 时 $\\eta$ 的特定初始形式的条件下，求解单一正频率惯性重力波的自由表面高度扰动 $\\eta(x,y,t)$ 的解析解。为解决此问题，我们必须首先通过求解线性化旋转浅水方程的简正模来确定这些波的性质。\n\n控制方程如下：\n$$\n\\frac{\\partial u}{\\partial t} - f v = - g \\frac{\\partial \\eta}{\\partial x} \\quad (1)\n$$\n$$\n\\frac{\\partial v}{\\partial t} + f u = - g \\frac{\\partial \\eta}{\\partial y} \\quad (2)\n$$\n$$\n\\frac{\\partial \\eta}{\\partial t} + H \\left( \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} \\right) = 0 \\quad (3)\n$$\n\n我们假设平面波解的形式为：\n$$\nu(x,y,t) = \\Re\\{\\hat{u} e^{i(k_x x + k_y y - \\omega t)}\\}\n$$\n$$\nv(x,y,t) = \\Re\\{\\hat{v} e^{i(k_x x + k_y y - \\omega t)}\\}\n$$\n$$\n\\eta(x,y,t) = \\Re\\{\\hat{\\eta} e^{i(k_x x + k_y y - \\omega t)}\\}\n$$\n其中 $\\hat{u}$、$\\hat{v}$ 和 $\\hat{\\eta}$ 是复振幅，$\\boldsymbol{k} = (k_x, k_y)$ 是波矢，$\\omega$ 是角频率。将这些形式代入控制方程，可将偏微分方程组转化为关于振幅的线性代数方程组。微分算子变为：$\\frac{\\partial}{\\partial t} \\rightarrow -i\\omega$、$\\frac{\\partial}{\\partial x} \\rightarrow ik_x$ 和 $\\frac{\\partial}{\\partial y} \\rightarrow ik_y$。\n\n方程组变为：\n$$\n-i\\omega \\hat{u} - f \\hat{v} = - g (ik_x) \\hat{\\eta} \\quad (4)\n$$\n$$\n-i\\omega \\hat{v} + f \\hat{u} = - g (ik_y) \\hat{\\eta} \\quad (5)\n$$\n$$\n-i\\omega \\hat{\\eta} + H (ik_x \\hat{u} + ik_y \\hat{v}) = 0 \\quad (6)\n$$\n\n该方程组可以写成矩阵形式：\n$$\n\\begin{pmatrix}\n-i\\omega  -f  igk_x \\\\\nf  -i\\omega  igk_y \\\\\nik_x H  ik_y H  -i\\omega\n\\end{pmatrix}\n\\begin{pmatrix}\n\\hat{u} \\\\\n\\hat{v} \\\\\n\\hat{\\eta}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\\n0 \\\\\n0\n\\end{pmatrix}\n$$\n为使非平凡解存在，该矩阵的行列式必须为零。我们来计算行列式：\n$$\n\\det = (-i\\omega)((-i\\omega)(-i\\omega) - (ik_y H)(igk_y)) - (-f)(f(-i\\omega) - (ik_x H)(igk_y)) + (igk_x)(f(ik_y H) - (-i\\omega)(ik_x H))\n$$\n$$\n\\det = (-i\\omega)(-\\omega^2 + gHk_y^2) + f(-i\\omega f + gHk_x k_y) + igk_x(ifk_y H + \\omega k_x H)\n$$\n$$\n\\det = i\\omega^3 - i\\omega gHk_y^2 - i\\omega f^2 + f gHk_x k_y - fgHk_x k_y - i\\omega gHk_x^2\n$$\n$$\n\\det = i\\omega^3 - i\\omega f^2 - i\\omega gH(k_x^2 + k_y^2) = i\\omega(\\omega^2 - f^2 - gH(k_x^2 + k_y^2))\n$$\n将行列式设为零，得到色散关系：\n$$\ni\\omega(\\omega^2 - f^2 - gHK^2) = 0, \\quad \\text{其中 } K^2 = k_x^2 + k_y^2\n$$\n对于每个波矢 $\\boldsymbol{k}$，该方程产生三种频率解（模式）：\n1.  $\\omega = 0$ 的定常地转模。\n2.  频率为 $\\omega = \\pm \\sqrt{f^2 + gHK^2}$ 的两个惯性重力波模。\n\n问题指定了要激发一个单一的、向右传播的惯性重力波模式，这对应于正频率分支：\n$$\n\\omega = \\sqrt{f^2 + gH(k_x^2 + k_y^2)}\n$$\n为使系统纯粹按此单一模式演化，初始场 $(u(x,y,0), v(x,y,0), \\eta(x,y,0))$ 必须具有相应特征向量的空间结构。我们通过确定对于这个 $\\omega$ 值，$\\hat{u}$、$\\hat{v}$ 和 $\\hat{\\eta}$ 之间的关系来找到特征向量。\n\n从方程 (4) 和 (5)，我们可以用 $\\hat{\\eta}$ 来表示 $\\hat{u}$ 和 $\\hat{v}$ 的解：\n$$\n\\begin{pmatrix}\n-i\\omega  -f \\\\\nf  -i\\omega\n\\end{pmatrix}\n\\begin{pmatrix}\n\\hat{u} \\\\\n\\hat{v}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-igk_x\\hat{\\eta} \\\\\n-igk_y\\hat{\\eta}\n\\end{pmatrix}\n$$\n这个 $2 \\times 2$ 矩阵的行列式是 $D = (-i\\omega)^2 - (f)(-f) = f^2 - \\omega^2$。利用色散关系，我们有 $f^2 - \\omega^2 = -gHK^2$。\n求解 $\\hat{u}$ 和 $\\hat{v}$（例如，使用克莱姆法则）：\n$$\n\\hat{u} = \\frac{\\det \\begin{pmatrix} -igk_x\\hat{\\eta}  -f \\\\ -igk_y\\hat{\\eta}  -i\\omega \\end{pmatrix}}{f^2 - \\omega^2} = \\frac{-ig\\hat{\\eta}(-i\\omega k_x + f k_y)}{-gHK^2} = \\frac{\\hat{\\eta}}{HK^2}(\\omega k_x + ifk_y)\n$$\n$$\n\\hat{v} = \\frac{\\det \\begin{pmatrix} -i\\omega  -igk_x\\hat{\\eta} \\\\ f  -igk_y\\hat{\\eta} \\end{pmatrix}}{f^2 - \\omega^2} = \\frac{-ig\\hat{\\eta}(-i\\omega k_y - f k_x)}{-gHK^2} = \\frac{\\hat{\\eta}}{HK^2}(\\omega k_y - ifk_x)\n$$\n这些关系定义了惯性重力波模式的结构。任何满足场振幅之间这些比率的初始条件都将作为一个纯模式演化，而不会激发其他模式。\n\n问题陈述在 $t=0$ 时，自由表面高度是一个振幅为 $A_\\eta > 0$、相位为 $\\phi_0 \\in \\mathbb{R}$ 的平面波：\n$$\n\\eta(x,y,0) = A_\\eta \\cos(k_x x + k_y y + \\phi_0)\n$$\n这可以用复数表示法表示为：\n$$\n\\eta(x,y,0) = \\Re\\{ A_\\eta e^{i(k_x x + k_y y + \\phi_0)} \\} = \\Re\\{ (A_\\eta e^{i\\phi_0}) e^{i(k_x x + k_y y)} \\}\n$$\n从我们的一般平面波形式 $\\eta(x,y,0) = \\Re\\{\\hat{\\eta} e^{i(k_x x + k_y y)}\\}$ 出发，通过比较，我们将自由表面高度扰动的复振幅确定为 $\\hat{\\eta} = A_\\eta e^{i\\phi_0}$。\n\n由于初始状态被构造成一个纯本征模，其时间演化可以简单地描述为此模式以其特征频率 $\\omega$ 的传播。通过包含平面波形式的时间相关部分，可以找到任意时间 $t \\ge 0$ 的解：\n$$\n\\eta(x,y,t) = \\Re\\{\\hat{\\eta} e^{i(k_x x + k_y y - \\omega t)}\\}\n$$\n代入 $\\hat{\\eta} = A_\\eta e^{i\\phi_0}$：\n$$\n\\eta(x,y,t) = \\Re\\{ A_\\eta e^{i\\phi_0} e^{i(k_x x + k_y y - \\omega t)} \\} = \\Re\\{ A_\\eta e^{i(k_x x + k_y y - \\omega t + \\phi_0)} \\}\n$$\n取实部得到最终表达式：\n$$\n\\eta(x,y,t) = A_\\eta \\cos(k_x x + k_y y - \\omega t + \\phi_0)\n$$\n最后，我们代入频率 $\\omega$ 的显式表达式：\n$$\n\\eta(x,y,t) = A_\\eta \\cos\\left(k_x x + k_y y - t\\sqrt{f^2 + gH(k_x^2 + k_y^2)} + \\phi_0\\right)\n$$\n这就是对所有 $t \\ge 0$ 的自由表面高度扰动的闭合形式解析表达式。振幅 $A_\\eta$ 保持不变，相位随时间线性演化，这与单个线性波模的行为一致。",
            "answer": "$$\n\\boxed{A_{\\eta} \\cos\\left(k_x x + k_y y - t\\sqrt{f^2 + gH(k_x^2 + k_y^2)} + \\phi_0\\right)}\n$$"
        },
        {
            "introduction": "在无界域中了解了基本波之后，我们自然会问：当引入物理边界（如海岸线）时，会发生什么？这个练习探讨了一种特殊且重要的边界俘获波——开尔文波。通过推导其能量通量，你将揭示为何这种波只能单向沿边界传播，这是理解海岸和赤道海洋及大气动力学的关键一环。",
            "id": "4088768",
            "problem": "考虑一条与 $x$ 轴重合的位于 $y=0$ 的平直海岸线，海洋占据 $y>0$ 的区域。流体是一个平均深度为常数 $H$、密度为常数 $\\rho$ 的均匀层，其运动由 $f$ 平面上的线性化旋转浅水方程控制，其中科里奥利参数 $f$ 和重力加速度 $g$ 均为常数。忽略摩擦和任何行星涡度梯度。设自由面位移为 $\\,\\eta(x,y,t)\\,$，水平速度分量为沿岸（平行于海岸）的 $\\,u(x,y,t)\\,$ 和跨岸（垂直于海岸）的 $\\,v(x,y,t)\\,$。在海岸处施加不可穿透边界条件 $\\,v(x,0,t)=0\\,$。\n\n从旋转浅水方程和这些边界条件出发，考虑一个近岸捕获的小振幅波，并推导其与边界处无辐散法向流相符的跨岸衰减结构和色散关系。然后，使用在离岸方向上衰减的具有物理意义的解分支，计算平行于边界的时间平均机械能通量密度，并将其在跨岸方向（$y$）上从 $0$ 到 $\\infty$ 积分，以获得波沿边界输运的总时间平均功率。明确证明这种沿岸能量输运是单向的，其方向仅由 $f$ 的符号决定。\n\n假设海岸处的自由面振幅为在波峰处计算的 $\\,A_{0}=\\eta(x,0,t)\\,$，并将您的最终答案表示为关于 $\\,\\rho\\,$, $\\,g\\,$, $\\,H\\,$, $\\,f\\,$ 和 $\\,A_{0}\\,$ 的跨岸积分、时间平均的沿岸能量输运的单一闭合形式解析表达式。您必须从控制方程和基本守恒原理推导出此结果；不要引用任何未从第一性原理证明的快捷公式。以瓦特（国际单位制，SI）表示最终的能量输运。无需四舍五入；提供一个精确的符号表达式。不要在您的方框最终答案中包含单位。",
            "solution": "分析始于对问题陈述的验证。\n\n### 步骤 1：提取已知条件\n-   **几何**：一条平直海岸线与 $x$ 轴重合，位于 $y=0$。海洋占据 $y>0$ 区域。\n-   **流体属性**：流体是一个平均深度为常数 $H$、密度为常数 $\\rho$ 的均匀层。\n-   **控制动力学**：该系统由 $f$ 平面上的线性化旋转浅水方程描述，其中科里奥利参数 $f$ 和重力加速度 $g$ 均为常数。\n-   **假设**：忽略摩擦和行星涡度梯度（$\\beta$-效应）。\n-   **变量**：自由面位移为 $\\eta(x,y,t)$，沿岸速度为 $u(x,y,t)$，跨岸速度为 $v(x,y,t)$。\n-   **边界条件**：不可穿透的海岸施加了条件 $v(x,0,t)=0$。波是“近岸捕获”的，这意味着其振幅在 $y \\to \\infty$ 时必须衰减至零。\n-   **波振幅**：海岸处的自由面振幅给定为 $A_0$，对应于波峰，即 $A_0 = \\eta(x,0,t)|_{\\text{crest}}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学依据**：该问题描述的是海岸开尔文波，它是旋转浅水方程的一个基本且已确立的解。其物理模型和指定条件是地球物理流体动力学中的标准内容。该问题是科学合理的。\n-   **适定性**：该偏微分方程组，连同海岸处（$y=0$）的不可穿透边界条件和远离海岸（$y \\to \\infty$）的衰减条件，构成了一个适定问题，它允许一个与开尔文波对应的唯一、稳定的解。\n-   **客观性**：问题陈述使用了物理学和数学中精确、标准的术语，没有任何主观或模糊的语言。\n\n### 步骤 3：结论与行动\n该问题是有效的。它是地球物理流体动力学中的一个标准、自洽且适定的问题。将从第一性原理推导一个完整的解。\n\n### 解的推导\n\n在 $f$ 平面上的控制性线性化旋转浅水方程为：\n$$\n\\frac{\\partial u}{\\partial t} - fv = -g \\frac{\\partial \\eta}{\\partial x} \\quad (1)\n$$\n$$\n\\frac{\\partial v}{\\partial t} + fu = -g \\frac{\\partial \\eta}{\\partial y} \\quad (2)\n$$\n$$\n\\frac{\\partial \\eta}{\\partial t} + H \\left( \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} \\right) = 0 \\quad (3)\n$$\n我们寻求一个沿 $x$ 轴传播的近岸捕获波解。开尔文波的特征是在跨岸方向上存在精确的地转平衡，这意味着跨岸速度 $v$ 在各处都恒为零。我们检验拟设 $v(x,y,t) = 0$。\n\n当 $v=0$ 时，控制方程简化为：\n$$\n\\frac{\\partial u}{\\partial t} = -g \\frac{\\partial \\eta}{\\partial x} \\quad (1')\n$$\n$$\nfu = -g \\frac{\\partial \\eta}{\\partial y} \\quad (2')\n$$\n$$\n\\frac{\\partial \\eta}{\\partial t} + H \\frac{\\partial u}{\\partial x} = 0 \\quad (3')\n$$\n该拟设平凡地满足边界条件 $v(x,0,t)=0$。我们寻找形如 $u = \\text{Re}[\\hat{u}(y)e^{i(kx-\\omega t)}]$ 和 $\\eta = \\text{Re}[\\hat{\\eta}(y)e^{i(kx-\\omega t)}]$ 的解。将它们代入方程 $(1')$ 和 $(3')$ 得到：\n$$\n-i\\omega \\hat{u} = -ikg \\hat{\\eta} \\implies \\omega \\hat{u} = kg \\hat{\\eta} \\quad (4)\n$$\n$$\n-i\\omega \\hat{\\eta} + ikH \\hat{u} = 0 \\implies \\omega \\hat{\\eta} = kH \\hat{u} \\quad (5)\n$$\n将 $(4)$ 中的 $\\hat{u}$ 代入 $(5)$：\n$$\n\\omega \\hat{\\eta} = kH \\left(\\frac{kg}{\\omega}\\hat{\\eta}\\right) \\implies \\omega^2 \\hat{\\eta} = gHk^2 \\hat{\\eta}\n$$\n对于非平凡解（$\\hat{\\eta} \\neq 0$），我们得到色散关系：\n$$\n\\omega^2 = gHk^2 \\implies \\frac{\\omega}{k} = \\pm\\sqrt{gH}\n$$\n相速度为 $c_p = \\omega/k = \\pm c$，其中 $c = \\sqrt{gH}$ 是无旋转浅水波的相速度。\n\n接下来，我们从方程 $(2')$, $fu = -g \\frac{d\\eta}{dy}$ 确定跨岸结构。使用波解的形式，这变为 $f\\hat{u} = -g \\frac{d\\hat{\\eta}}{dy}$。代入来自 $(4)$ 的 $\\hat{u}=(kg/\\omega)\\hat{\\eta}$：\n$$\nf \\left(\\frac{kg}{\\omega}\\hat{\\eta}\\right) = -g \\frac{d\\hat{\\eta}}{dy} \\implies \\frac{d\\hat{\\eta}}{dy} = -\\frac{fk}{\\omega} \\hat{\\eta}\n$$\n这是一个关于 $\\hat{\\eta}(y)$ 的一阶常微分方程，其解为：\n$$\n\\hat{\\eta}(y) = \\hat{\\eta}(0) \\exp\\left(-\\frac{fk}{\\omega} y\\right)\n$$\n为了使波被“近岸捕获”，其振幅必须在 $y \\to \\infty$ 时衰减。这要求指数的参数为负实数：\n$$\n\\frac{fk}{\\omega} > 0 \\implies \\frac{f}{c_p} > 0\n$$\n这个条件决定了传播方向。如果 $f > 0$（北半球），则 $c_p > 0$，波沿 $+x$ 方向传播（海岸在其右侧）。如果 $f  0$（南半球），则 $c_p  0$，波沿 $-x$ 方向传播（海岸在其左侧）。我们可以将相速度简明地写为 $c_p = \\omega/k = \\text{sgn}(f)c$。\n衰减尺度是罗斯贝变形半径， $L_R = \\frac{\\omega}{fk} = \\frac{c_p}{f} = \\frac{\\text{sgn}(f)c}{f} = \\frac{c}{|f|}$。\n表面位移为 $\\eta(x,y,t) = A_0 \\exp(-y/L_R) \\cos(kx-\\omega t) = A_0 \\exp\\left(-\\frac{|f|y}{c}\\right) \\cos(kx-\\omega t)$，其中 $A_0$ 是在波峰时海岸处（$y=0$）的振幅。\n\n相应的沿岸速度 $u$ 可从 $fu = -g \\frac{\\partial\\eta}{\\partial y}$ 求得：\n$$\nu = -\\frac{g}{f} \\frac{\\partial\\eta}{\\partial y} = -\\frac{g}{f} \\left[ A_0 \\left(-\\frac{|f|}{c}\\right) \\exp\\left(-\\frac{|f|y}{c}\\right) \\cos(kx-\\omega t) \\right]\n$$\n$$\nu = \\frac{g|f|}{fc} \\eta = \\frac{g}{c} \\text{sgn}(f) \\eta = \\text{sgn}(f) \\sqrt{\\frac{g}{H}} \\eta\n$$\n所以，$u(x,y,t) = A_0 \\text{sgn}(f) \\sqrt{\\frac{g}{H}} \\exp\\left(-\\frac{|f|y}{c}\\right) \\cos(kx-\\omega t)$。\n\n为了求能量输运，我们首先建立能量守恒定律。总能量密度（单位面积） $E$ 是动能密度和势能密度之和：\n$$\nE = E_k + E_p = \\frac{1}{2}\\rho H (u^2 + v^2) + \\frac{1}{2}\\rho g \\eta^2\n$$\n对于我们的开尔文波解（其中 $v=0$），能量密度为 $E = \\frac{1}{2}\\rho H u^2 + \\frac{1}{2}\\rho g \\eta^2$。线性化系统的能量守恒方程为 $\\frac{\\partial E}{\\partial t} + \\nabla \\cdot \\vec{F} = 0$，其中 $\\vec{F}$ 是能通量矢量。我们推导 $\\vec{F}$：\n$$\n\\frac{\\partial E}{\\partial t} = \\rho H u \\frac{\\partial u}{\\partial t} + \\rho g \\eta \\frac{\\partial \\eta}{\\partial t}\n$$\n使用控制方程 $(1')$ 和 $(3')$：\n$$\n\\frac{\\partial E}{\\partial t} = \\rho H u \\left(-g \\frac{\\partial \\eta}{\\partial x}\\right) + \\rho g \\eta \\left(-H \\frac{\\partial u}{\\partial x}\\right) = -g\\rho H \\left(u \\frac{\\partial \\eta}{\\partial x} + \\eta \\frac{\\partial u}{\\partial x}\\right) = -g\\rho H \\frac{\\partial(u\\eta)}{\\partial x}\n$$\n由于 $v=0$，通量的散度为 $\\nabla \\cdot \\vec{F} = \\frac{\\partial F_x}{\\partial x} + \\frac{\\partial F_y}{\\partial y}$。这意味着沿岸能通量为 $F_x = g\\rho H u\\eta$，而跨岸能通量 $F_y=0$。因此，能通量矢量为 $\\vec{F} = (g\\rho H u\\eta, 0)$。\n\n我们需要时间平均的沿岸能通量，记为 $\\langle F_x \\rangle$。\n$$\nF_x(x,y,t) = g\\rho H u \\eta = g\\rho H \\left(\\text{sgn}(f)\\sqrt{\\frac{g}{H}}\\eta\\right) \\eta = \\rho g\\sqrt{gH} \\text{sgn}(f) \\eta^2 = \\rho g c \\, \\text{sgn}(f) \\eta^2\n$$\n代入 $\\eta$ 的表达式：\n$$\nF_x(x,y,t) = \\rho g c \\, \\text{sgn}(f) \\left[ A_0 \\exp\\left(-\\frac{|f|y}{c}\\right) \\cos(kx-\\omega t) \\right]^2\n$$\n$$\nF_x(x,y,t) = \\rho g c \\, \\text{sgn}(f) A_0^2 \\exp\\left(-\\frac{2|f|y}{c}\\right) \\cos^2(kx-\\omega t)\n$$\n在一个波周期内 $\\cos^2(kx-\\omega t)$ 的时间平均值为 $\\frac{1}{2}$。时间平均的通量密度为：\n$$\n\\langle F_x \\rangle(y) = \\frac{1}{2} \\rho g c \\, \\text{sgn}(f) A_0^2 \\exp\\left(-\\frac{2|f|y}{c}\\right)\n$$\n沿边界输运的总时间平均功率 $P_{total}$ 是该通量密度在跨岸方向上从 $y=0$ 到 $y=\\infty$ 的积分：\n$$\nP_{total} = \\int_0^\\infty \\langle F_x \\rangle(y) dy = \\frac{1}{2} \\rho g c \\, \\text{sgn}(f) A_0^2 \\int_0^\\infty \\exp\\left(-\\frac{2|f|y}{c}\\right) dy\n$$\n该积分计算结果为：\n$$\n\\int_0^\\infty \\exp\\left(-\\frac{2|f|y}{c}\\right) dy = \\left[ \\frac{c}{-2|f|} \\exp\\left(-\\frac{2|f|y}{c}\\right) \\right]_0^\\infty = 0 - \\frac{c}{-2|f|} = \\frac{c}{2|f|}\n$$\n将此结果代入 $P_{total}$ 的表达式中：\n$$\nP_{total} = \\left( \\frac{1}{2} \\rho g c \\, \\text{sgn}(f) A_0^2 \\right) \\left( \\frac{c}{2|f|} \\right) = \\frac{1}{4} \\rho g c^2 A_0^2 \\frac{\\text{sgn}(f)}{|f|}\n$$\n由于 $\\frac{\\text{sgn}(f)}{|f|} = \\frac{f}{|f|^2} = \\frac{f}{f^2} = \\frac{1}{f}$，我们有：\n$$\nP_{total} = \\frac{\\rho g c^2 A_0^2}{4f}\n$$\n最后，通过代入 $c^2=gH$，用给定参数表示答案：\n$$\nP_{total} = \\frac{\\rho g (gH) A_0^2}{4f} = \\frac{\\rho g^2 H A_0^2}{4f}\n$$\n该表达式表明沿岸能量输运是单向的。由于 $\\rho, g, H$ 和 $A_0^2$ 均为正， $P_{total}$ 的符号仅由 $f$ 的符号决定。对于 $f>0$，$P_{total}>0$，表示能量向 $+x$ 方向输运。对于 $f0$，$P_{total}0$，表示能量向 $-x$ 方向输运。这个方向与前面推导的相传播方向一致。",
            "answer": "$$\n\\boxed{\\frac{\\rho g^2 H A_0^2}{4f}}\n$$"
        },
        {
            "introduction": "在真实的大气和海洋中，初始状态很少是纯粹的平衡态或单一的波动模式。这个练习将带你探究一个核心概念：地转适应。你将从一个不平衡的初始扰动出发，通过运用位涡守恒原理，计算系统在通过辐射重力波达到最终地转平衡态后，有多少初始能量被耗散掉了。",
            "id": "4088766",
            "problem": "考虑在一个恒定科里奥利参数平面（$f$平面）上的线性地转适应过程，该过程由一维、与$y$无关的线性浅水方程描述，其中平均深度为$H$，重力加速度为$g$，科里奥利参数为常数$f$：\n$$\nu_{t} - f v = - g\\,\\eta_{x}, \\qquad v_{t} + f u = 0, \\qquad \\eta_{t} + H\\,u_{x} = 0,\n$$\n其中 $u(x,t)$ 和 $v(x,t)$ 分别是纬向和经向速度，$\\eta(x,t)$ 是自由面高度位移。线性位涡（PV）异常定义为\n$$\nq' = \\frac{\\zeta}{H} - \\frac{f}{H^{2}}\\,\\eta, \\qquad \\zeta = v_{x} - u_{y} = v_{x},\n$$\n在没有强迫和耗散的情况下，它是物质守恒的。假设在 $x$ 方向上为无限域，当 $|x|\\to\\infty$ 时，各物理场趋于零。$t=0$ 时的初始条件是一个速度为零的纯静力平衡高度扰动，\n$$\n\\eta(x,0) = \\eta_{0}(x) = A\\,\\exp\\!\\left(-\\frac{x^{2}}{2\\sigma^{2}}\\right), \\qquad u(x,0)=0, \\qquad v(x,0)=0,\n$$\n其中 $A>0$ 是振幅，$\\sigma>0$ 是高斯半宽。\n\n从控制方程和线性位涡的定义出发，推导适应过程后得到的渐近、稳定的地转高度场 $\\eta_{G}(x)$（即重力波辐射消散后剩余的平衡、零频率分量）。将 $\\eta_{G}(x)$ 以米为单位表示。\n\n然后，利用线性浅水系统的二次能量，\n$$\nE = \\frac{1}{2}\\,g\\int_{-\\infty}^{\\infty}\\eta^{2}\\,dx + \\frac{1}{2}\\,H\\int_{-\\infty}^{\\infty}\\left(u^{2}+v^{2}\\right)\\,dx,\n$$\n以闭合形式量化在适应过程中因重力波而损失的初始能量 $E_{0}$ 的比例，即，\n$$\nF = 1 - \\frac{E_{G}}{E_{0}},\n$$\n其中 $E_{G}$ 是最终地转态所包含的能量，$E_{0}$ 是初始条件的能量。你的最终表达式应以 $A$、$\\sigma$、$H$、$g$ 和 $f$ 表示，并可能包含特殊函数。将形变半径 $L_{D}$ 定义为 $L_{D}^{2} = gH/f^{2}$。请提供精确的解析表达式；不要进行近似或四舍五入。最终的 $\\eta_{G}(x)$ 以米为单位表示。能量分数 $F$ 是无量纲的，应以解析形式的纯数字表示（不带百分号）。",
            "solution": "### 第1步：提取已知条件\n问题提供了以下信息：\n- **控制方程**：f平面上的一维线性浅水方程：\n$$ u_{t} - f v = - g\\,\\eta_{x} $$\n$$ v_{t} + f u = 0 $$\n$$ \\eta_{t} + H\\,u_{x} = 0 $$\n- **变量**：$u(x,t)$（纬向速度），$v(x,t)$（经向速度），$\\eta(x,t)$（自由面高度位移）。\n- **常数**：$H$（平均深度），$g$（重力加速度），$f$（恒定科里奥利参数）。\n- **线性位涡（PV）异常**：\n$$ q' = \\frac{\\zeta}{H} - \\frac{f}{H^{2}}\\,\\eta, \\quad \\text{其中} \\quad \\zeta = v_{x} $$\n- **域和边界条件**：x 方向上为无限域，当 $|x|\\to\\infty$ 时场量趋于零。\n- **$t=0$ 时的初始条件**：\n$$ \\eta(x,0) = \\eta_{0}(x) = A\\,\\exp\\!\\left(-\\frac{x^{2}}{2\\sigma^{2}}\\right), \\quad u(x,0)=0, \\quad v(x,0)=0 $$\n其中 $A>0$ 是振幅，$\\sigma>0$ 是高斯半宽。\n- **能量定义**：系统的二次能量为\n$$ E = \\frac{1}{2}\\,g\\int_{-\\infty}^{\\infty}\\eta^{2}\\,dx + \\frac{1}{2}\\,H\\int_{-\\infty}^{\\infty}\\left(u^{2}+v^{2}\\right)\\,dx $$\n- **形变半径定义**：$L_{D}^{2} = gH/f^{2}$。\n- **任务**：\n  1. 推导适应后剩余的渐近、稳定的地转高度场 $\\eta_{G}(x)$。\n  2. 量化因重力波损失的初始能量分数，$F = 1 - E_{G}/E_{0}$，其中 $E_0$ 是初始能量，$E_G$ 是最终地转态的能量。\n\n### 第2步：使用提取的已知条件进行验证\n对问题进行以下验证检查：\n- **科学依据**：该问题描述了地转适应，这是地球物理流体动力学中的一个基本概念。控制方程是标准的线性浅水方程，位涡和能量的定义是正确的。该设置在科学上是合理的。\n- **适定性**：该问题是适定的。给定初始条件和控制方程，预期存在一个唯一且稳定的最终状态。初始条件是一个局部扰动，这是此类问题的标准设置。\n- **客观性**：语言精确且数学化。所有术语都有明确的定义。\n- **完整性**：提供了解决问题所需的所有必要信息（方程、定义、初始条件）。\n- **一致性**：所提供的信息中没有矛盾。\n\n### 第3步：结论和行动\n该问题是**有效的**，因为它在科学上合理、适定且自洽。现在将进行求解过程。\n\n### 最终地转态和能量损失的推导\n\n求解过程分为两部分：首先，确定最终的地转态 $\\eta_{G}(x)$；其次，计算初始和最终能量以求得能量损失的比例。\n\n#### 第1部分：地转高度场 $\\eta_{G}(x)$ 的推导\n\n寻找最终适应态的关键原理是线性位涡（PV）$q'$的物质守恒。在没有强迫和耗散的情况下，$Dq'/Dt = 0$。对于位移较小的线性系统，这意味着最终状态下固定点 $x$ 的PV等于初始状态下同一点的PV：$q'(x, \\infty) = q'(x, 0)$。\n\n1.  **计算初始PV, $q'(x, 0)$**：\n    在 $t=0$ 时，我们有 $u(x,0)=0$ 和 $v(x,0)=0$。初始涡度为 $\\zeta(x,0) = v_{x}(x,0) = 0$。\n    因此，初始PV为：\n    $$ q'(x,0) = \\frac{\\zeta(x,0)}{H} - \\frac{f}{H^{2}}\\eta(x,0) = -\\frac{f}{H^2}\\eta_0(x) $$\n\n2.  **描述最终地转态的特征**：\n    最终状态是稳定的（时间导数为零）且处于地转平衡。我们用下标 $G$ 表示最终状态的变量。\n    稳态控制方程为：\n    $$ -f v_{G} = -g \\frac{d\\eta_{G}}{dx} \\implies v_{G}(x) = \\frac{g}{f} \\frac{d\\eta_{G}}{dx} $$\n    $$ f u_{G} = 0 \\implies u_{G}(x) = 0 $$\n    $$ H \\frac{du_G}{dx} = 0 \\quad (\\text{与 } u_{G}=0 \\text{ 一致}) $$\n    最终状态的特征是纬向速度为零，经向速度与高度场处于地转平衡。\n\n3.  **计算最终PV, $q'_G(x)$**：\n    最终状态的涡度为 $\\zeta_G(x) = \\frac{dv_G}{dx} = \\frac{g}{f} \\frac{d^2\\eta_G}{dx^2}$。\n    最终状态的PV为：\n    $$ q'_G(x) = \\frac{\\zeta_G}{H} - \\frac{f}{H^2}\\eta_G = \\frac_g{fH} \\frac{d^2\\eta_G}{dx^2} - \\frac{f}{H^2}\\eta_G $$\n\n4.  **令初始和最终PV相等**：\n    令 $q'_G(x) = q'(x,0)$：\n    $$ \\frac{g}{fH} \\frac{d^2\\eta_G}{dx^2} - \\frac{f}{H^2}\\eta_G = -\\frac{f}{H^2}\\eta_0(x) $$\n    乘以 $-H^2/f$ 并重新整理得到：\n    $$ \\eta_G - \\frac{gH}{f^2} \\frac{d^2\\eta_G}{dx^2} = \\eta_0(x) $$\n    使用罗斯贝形变半径的定义，$L_D^2 = gH/f^2$，我们得到PV反演方程：\n    $$ \\eta_G(x) - L_D^2 \\frac{d^2\\eta_G(x)}{dx^2} = \\eta_0(x) $$\n这是一个非齐次二阶常微分方程。其解可以通过与算子 $(1 - L_D^2 d^2/dx^2)$ 的格林函数进行卷积来求得。格林函数 $G(x)$ 满足 $G(x) - L_D^2 G''(x) = \\delta(x)$，其解为 $G(x) = \\frac{1}{2L_D}\\exp(-|x|/L_D)$。\n$\\eta_G(x)$ 的解是卷积：\n$$ \\eta_G(x) = (\\eta_0 * G)(x) = \\int_{-\\infty}^{\\infty} \\eta_0(y) G(x-y) dy $$\n$$ \\eta_G(x) = \\int_{-\\infty}^{\\infty} A\\,\\exp\\left(-\\frac{y^2}{2\\sigma^2}\\right) \\frac{1}{2L_D}\\exp\\left(-\\frac{|x-y|}{L_D}\\right) dy $$\n该积分的计算结果得到一个包含互补误差函数的表达式，$\\text{erfc}(z) = \\frac{2}{\\sqrt{\\pi}}\\int_z^\\infty \\exp(-t^2)dt$：\n$$ \\eta_G(x) = \\frac{A}{2} \\exp\\left( \\frac{\\sigma^2}{2L_D^2} \\right) \\left[ \\exp\\left(-\\frac{x}{L_D}\\right)\\text{erfc}\\left(\\frac{\\sigma}{\\sqrt{2}L_D}-\\frac{x}{\\sqrt{2}\\sigma}\\right) + \\exp\\left(\\frac{x}{L_D}\\right)\\text{erfc}\\left(\\frac{\\sigma}{\\sqrt{2}L_D}+\\frac{x}{\\sqrt{2}\\sigma}\\right) \\right] $$\n该表达式用给定的参数表示，并以长度单位给出 $\\eta_G(x)$（如果所有输入均为国际单位制，则单位为米）。\n\n#### 第2部分：能量损失分数\n为了求得能量损失分数 $F = 1 - E_G/E_0$，我们必须计算初始能量 $E_0$ 和最终能量 $E_G$。\n\n1.  **计算初始能量, $E_0$**：\n    在 $t=0$ 时，$u=v=0$ 且 $\\eta = \\eta_0(x) = A\\exp(-x^2/(2\\sigma^2))$。\n    $$ E_0 = \\frac{1}{2}g\\int_{-\\infty}^{\\infty} \\eta_0^2\\,dx = \\frac{1}{2}gA^2 \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{x^2}{\\sigma^2}\\right)dx $$\n    使用标准高斯积分 $\\int_{-\\infty}^{\\infty} \\exp(-ax^2)dx = \\sqrt{\\pi/a}$，其中 $a=1/\\sigma^2$：\n    $$ E_0 = \\frac{1}{2}gA^2 \\sqrt{\\pi\\sigma^2} = \\frac{\\sqrt{\\pi}}{2} g A^2 \\sigma $$\n\n2.  **计算最终地转能量, $E_G$**：\n    最终能量包含在地转高度场和速度场中：\n    $$ E_G = \\frac{1}{2}g\\int_{-\\infty}^{\\infty}\\eta_G^2\\,dx + \\frac{1}{2}H\\int_{-\\infty}^{\\infty}(u_G^2+v_G^2)\\,dx $$\n    由于 $u_G=0$ 且 $v_G = (g/f)d\\eta_G/dx$：\n    $$ E_G = \\frac{1}{2}g\\int_{-\\infty}^{\\infty}\\eta_G^2\\,dx + \\frac{1}{2}H\\left(\\frac{g}{f}\\right)^2\\int_{-\\infty}^{\\infty}\\left(\\frac{d\\eta_G}{dx}\\right)^2\\,dx = \\frac{g}{2}\\int_{-\\infty}^{\\infty}\\left[\\eta_G^2 + L_D^2\\left(\\frac{d\\eta_G}{dx}\\right)^2\\right]dx $$\n    直接计算这个积分很繁琐。在傅里叶空间中使用帕塞瓦尔定理更为直接。令 $\\hat{f}(k) = \\int_{-\\infty}^{\\infty} f(x) e^{-ikx} dx$。帕塞瓦尔定理指出 $\\int |f(x)|^2 dx = \\frac{1}{2\\pi}\\int |\\hat{f}(k)|^2 dk$。\n    $d\\eta_G/dx$ 的傅里叶变换是 $ik\\hat{\\eta}_G(k)$。\n    $$ E_G = \\frac{g}{2(2\\pi)}\\int_{-\\infty}^{\\infty}\\left[|\\hat{\\eta}_G(k)|^2 + L_D^2|ik\\hat{\\eta}_G(k)|^2\\right]dk = \\frac{g}{4\\pi}\\int_{-\\infty}^{\\infty}|\\hat{\\eta}_G(k)|^2 (1+k^2L_D^2) dk $$\n    从傅里叶空间中的PV反演方程，我们有 $\\hat{\\eta}_G(k)(1+k^2L_D^2) = \\hat{\\eta}_0(k)$，因此 $\\hat{\\eta}_G(k) = \\hat{\\eta}_0(k)/(1+k^2L_D^2)$。将此代入能量表达式中：\n    $$ E_G = \\frac{g}{4\\pi}\\int_{-\\infty}^{\\infty}\\frac{|\\hat{\\eta}_0(k)|^2}{(1+k^2L_D^2)^2}(1+k^2L_D^2) dk = \\frac{g}{4\\pi}\\int_{-\\infty}^{\\infty}\\frac{|\\hat{\\eta}_0(k)|^2}{1+k^2L_D^2} dk $$\n    初始高斯函数的傅里叶变换是 $\\hat{\\eta}_0(k) = A\\sqrt{2\\pi}\\sigma \\exp(-\\sigma^2k^2/2)$，所以 $|\\hat{\\eta}_0(k)|^2 = 2\\pi\\sigma^2 A^2 \\exp(-\\sigma^2k^2)$。\n    $$ E_G = \\frac{g}{4\\pi}\\int_{-\\infty}^{\\infty}\\frac{2\\pi\\sigma^2 A^2 \\exp(-\\sigma^2k^2)}{1+k^2L_D^2} dk = \\frac{gA^2\\sigma^2}{2} \\int_{-\\infty}^{\\infty}\\frac{\\exp(-\\sigma^2k^2)}{1+k^2L_D^2} dk $$\n    该积分为标准形式：$\\int_{-\\infty}^{\\infty}\\frac{e^{-ax^2}}{b+x^2}dx = \\frac{\\pi}{\\sqrt{b}} e^{ab} \\text{erfc}(\\sqrt{ab})$。这里，从分母中提出因子 $L_D^2$ 后，有 $a=\\sigma^2$ 和 $b=1/L_D^2$。\n    $$ \\int_{-\\infty}^{\\infty}\\frac{\\exp(-\\sigma^2k^2)}{1+k^2L_D^2} dk = \\frac{1}{L_D^2}\\int_{-\\infty}^{\\infty}\\frac{\\exp(-\\sigma^2k^2)}{1/L_D^2+k^2} dk = \\frac{1}{L_D^2} \\frac{\\pi}{1/L_D} \\exp\\left(\\frac{\\sigma^2}{L_D^2}\\right) \\text{erfc}\\left(\\frac{\\sigma}{L_D}\\right) = \\frac{\\pi}{L_D} \\exp\\left(\\frac{\\sigma^2}{L_D^2}\\right) \\text{erfc}\\left(\\frac{\\sigma}{L_D}\\right) $$\n    所以，最终能量是：\n    $$ E_G = \\frac{gA^2\\sigma^2}{2} \\left[ \\frac{\\pi}{L_D} \\exp\\left(\\frac{\\sigma^2}{L_D^2}\\right) \\text{erfc}\\left(\\frac{\\sigma}{L_D}\\right) \\right] = \\frac{\\pi g A^2 \\sigma^2}{2L_D} \\exp\\left(\\frac{\\sigma^2}{L_D^2}\\right) \\text{erfc}\\left(\\frac{\\sigma}{L_D}\\right) $$\n\n3.  **计算能量损失分数, $F$**：\n    地转态中剩余的能量分数为 $E_G/E_0$：\n    $$ \\frac{E_G}{E_0} = \\frac{\\frac{\\pi g A^2 \\sigma^2}{2L_D} \\exp(\\frac{\\sigma^2}{L_D^2}) \\text{erfc}(\\frac{\\sigma}{L_D})}{\\frac{\\sqrt{\\pi}}{2} g A^2 \\sigma} = \\frac{\\sqrt{\\pi}\\sigma}{L_D}\\exp\\left(\\frac{\\sigma^2}{L_D^2}\\right) \\text{erfc}\\left(\\frac{\\sigma}{L_D}\\right) $$\n    因重力波损失的能量分数为 $F = 1 - E_G/E_0$：\n    $$ F = 1 - \\frac{\\sqrt{\\pi}\\sigma}{L_D}\\exp\\left(\\frac{\\sigma^2}{L_D^2}\\right) \\text{erfc}\\left(\\frac{\\sigma}{L_D}\\right) $$\n其中 $L_D=\\sqrt{gH}/|f|$。",
            "answer": "$$ \\boxed{\n\\begin{pmatrix}\n\\frac{A}{2} \\exp\\left( \\frac{\\sigma^2}{2L_D^2} \\right) \\left[ \\exp\\left(-\\frac{x}{L_D}\\right)\\text{erfc}\\left(\\frac{\\sigma}{\\sqrt{2}L_D}-\\frac{x}{\\sqrt{2}\\sigma}\\right) + \\exp\\left(\\frac{x}{L_D}\\right)\\text{erfc}\\left(\\frac{\\sigma}{\\sqrt{2}L_D}+\\frac{x}{\\sqrt{2}\\sigma}\\right) \\right] \\\\ 1 - \\frac{\\sqrt{\\pi}\\sigma}{L_D}\\exp\\left(\\frac{\\sigma^2}{L_D^2}\\right) \\text{erfc}\\left(\\frac{\\sigma}{L_D}\\right)\n\\end{pmatrix}\n} $$"
        }
    ]
}