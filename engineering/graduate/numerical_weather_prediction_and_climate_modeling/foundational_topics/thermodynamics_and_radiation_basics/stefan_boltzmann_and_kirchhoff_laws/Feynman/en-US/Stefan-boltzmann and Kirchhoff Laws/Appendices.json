{
    "hands_on_practices": [
        {
            "introduction": "To build a robust understanding of radiative transfer in climate models, we begin with a foundational analytical exercise. This problem explores the net radiative exchange between two infinite parallel gray surfaces, a canonical model for interactions between the Earth's surface and a cloud base or an atmospheric layer. By deriving the net flux from first principles, you will directly apply the Stefan-Boltzmann law and Kirchhoff's law to a closed system, reinforcing the core concepts of radiosity and radiative equilibrium. ",
            "id": "4094485",
            "problem": "Consider a canonical two-surface longwave radiative exchange configuration relevant to Numerical Weather Prediction (NWP) and climate modeling: two parallel, infinite, plane, diffuse–gray, opaque surfaces separated by a non-participating gap (no emission, absorption, or scattering in the intervening medium). Let the lower surface represent land or ocean with emissivity $\\epsilon_{1}$ and thermodynamic temperature $T_{1}$, and the upper surface represent the base of a stratiform cloud deck with emissivity $\\epsilon_{2}$ and thermodynamic temperature $T_{2}$. The geometry implies a unity view factor, so $F_{12}=1$.\n\nUsing only first principles appropriate to radiative transfer (energy conservation, blackbody radiative behavior arising from spectral integration, and Kirchhoff’s law of thermal radiation stating the equality of emissivity and absorptivity for an opaque surface), derive from scratch the closed-form analytic expression for the net longwave radiative heat flux per unit area from the lower surface to the upper surface. Adopt the sign convention that positive flux is directed from the lower surface ($T_{1}$, $\\epsilon_{1}$) to the upper surface ($T_{2}$, $\\epsilon_{2}$). Express your final answer as a function of $\\epsilon_{1}$, $\\epsilon_{2}$, $T_{1}$, $T_{2}$, and the Stefan–Boltzmann constant $\\sigma$. Your final answer must be a single closed-form expression. If you choose to interpret the derived expression numerically in other contexts, the corresponding physical unit would be $\\mathrm{W\\,m^{-2}}$, but for this task no numerical evaluation or rounding is required.",
            "solution": "The problem is subjected to validation and is deemed valid. It is a standard, well-posed problem in radiative heat transfer, grounded in fundamental physical principles, and is free of ambiguities or contradictions. We may therefore proceed with the derivation.\n\nThe objective is to derive the net longwave radiative heat flux per unit area, denoted as $q_{12}$, from a lower surface (surface $1$) to an upper surface (surface $2$). The sign convention specifies that a positive flux is directed from surface $1$ to surface $2$. The derivation will be based on first principles as mandated.\n\nLet $J_i$ be the radiosity of surface $i$, defined as the total radiant energy leaving the surface per unit area. Let $G_i$ be the irradiation on surface $i$, defined as the total radiant energy incident upon the surface per unit area. For an opaque, diffuse-gray surface, the radiosity is the sum of the emitted energy and the reflected incident energy:\n$$J_i = E_i + \\rho_i G_i$$\nwhere $E_i$ is the emissive power of surface $i$ and $\\rho_i$ is its reflectivity.\n\nAccording to the Stefan-Boltzmann law, the emissive power of a gray body is given by:\n$$E_i = \\epsilon_i \\sigma T_i^4$$\nwhere $\\epsilon_i$ is the emissivity of surface $i$, $T_i$ is its absolute thermodynamic temperature, and $\\sigma$ is the Stefan-Boltzmann constant.\n\nAccording to Kirchhoff’s law of thermal radiation, for a surface in thermal equilibrium, its emissivity $\\epsilon_i$ is equal to its absorptivity $\\alpha_i$. For an opaque surface, the sum of absorptivity and reflectivity is unity, i.e., $\\alpha_i + \\rho_i = 1$. Combining these principles, we can express the reflectivity in terms of emissivity:\n$$\\rho_i = 1 - \\alpha_i = 1 - \\epsilon_i$$\n\nSubstituting the expressions for $E_i$ and $\\rho_i$ into the radiosity equation, we obtain the radiosity for each of the two surfaces:\nFor surface $1$:\n$$J_1 = \\epsilon_1 \\sigma T_1^4 + (1 - \\epsilon_1) G_1 \\quad (1)$$\nFor surface $2$:\n$$J_2 = \\epsilon_2 \\sigma T_2^4 + (1 - \\epsilon_2) G_2 \\quad (2)$$\n\nNext, we relate the irradiation on one surface to the radiosity of the other. The problem states that the surfaces are infinite and parallel. This geometric configuration implies that all radiation leaving one surface must be intercepted by the other. In the language of radiative heat transfer, the view factor from surface $1$ to surface $2$, $F_{12}$, is unity. By the reciprocity relation, $A_1 F_{12} = A_2 F_{21}$, and since the areas are infinite (or we consider equal unit areas, $A_1 = A_2$), we also have $F_{21} = 1$.\n\nThe irradiation on surface $1$, $G_1$, is the radiant energy leaving surface $2$ that reaches surface $1$. This is given by $G_1 = J_2 F_{21}$. Since $F_{21} = 1$, we have:\n$$G_1 = J_2$$\nSimilarly, the irradiation on surface $2$, $G_2$, is the radiant energy leaving surface $1$ that reaches surface $2$. This is given by $G_2 = J_1 F_{12}$. Since $F_{12} = 1$, we have:\n$$G_2 = J_1$$\n\nWe can now substitute these geometric relations back into the radiosity equations $(1)$ and $(2)$:\n$$J_1 = \\epsilon_1 \\sigma T_1^4 + (1 - \\epsilon_1) J_2 \\quad (3)$$\n$$J_2 = \\epsilon_2 \\sigma T_2^4 + (1 - \\epsilon_2) J_1 \\quad (4)$$\nEquations $(3)$ and $(4)$ form a system of two linear algebraic equations for the two unknown radiosities, $J_1$ and $J_2$.\n\nThe net radiative heat flux per unit area leaving a surface is the difference between its radiosity (energy leaving) and its irradiation (energy arriving). For surface $1$, the net flux is $q_1 = J_1 - G_1$. Using the relation $G_1 = J_2$, we get $q_1 = J_1 - J_2$. By our sign convention, the net flux from surface $1$ to surface $2$, $q_{12}$, is precisely this quantity:\n$$q_{12} = J_1 - J_2$$\nTo find $q_{12}$, we must solve the system of equations for $J_1$ and $J_2$. We can substitute equation $(4)$ into equation $(3)$:\n$$J_1 = \\epsilon_1 \\sigma T_1^4 + (1 - \\epsilon_1) \\left[ \\epsilon_2 \\sigma T_2^4 + (1 - \\epsilon_2) J_1 \\right]$$\n$$J_1 = \\epsilon_1 \\sigma T_1^4 + (1 - \\epsilon_1)\\epsilon_2 \\sigma T_2^4 + (1 - \\epsilon_1)(1 - \\epsilon_2) J_1$$\nNow, we collect terms involving $J_1$:\n$$J_1 \\left[ 1 - (1 - \\epsilon_1)(1 - \\epsilon_2) \\right] = \\epsilon_1 \\sigma T_1^4 + (1 - \\epsilon_1)\\epsilon_2 \\sigma T_2^4$$\nThe term in the square brackets simplifies to:\n$$1 - (1 - \\epsilon_1 - \\epsilon_2 + \\epsilon_1 \\epsilon_2) = \\epsilon_1 + \\epsilon_2 - \\epsilon_1 \\epsilon_2$$\nSo, we can solve for $J_1$:\n$$J_1 = \\frac{\\epsilon_1 \\sigma T_1^4 + (1 - \\epsilon_1)\\epsilon_2 \\sigma T_2^4}{\\epsilon_1 + \\epsilon_2 - \\epsilon_1 \\epsilon_2}$$\nBy symmetry (swapping indices $1$ and $2$), we can write the expression for $J_2$:\n$$J_2 = \\frac{\\epsilon_2 \\sigma T_2^4 + (1 - \\epsilon_2)\\epsilon_1 \\sigma T_1^4}{\\epsilon_2 + \\epsilon_1 - \\epsilon_2 \\epsilon_1}$$\nNow we compute the net flux $q_{12} = J_1 - J_2$:\n$$q_{12} = \\frac{1}{\\epsilon_1 + \\epsilon_2 - \\epsilon_1 \\epsilon_2} \\left[ (\\epsilon_1 \\sigma T_1^4 + \\epsilon_2(1-\\epsilon_1)\\sigma T_2^4) - (\\epsilon_2 \\sigma T_2^4 + \\epsilon_1(1-\\epsilon_2)\\sigma T_1^4) \\right]$$\nLet's expand the terms inside the brackets:\n$$ \\epsilon_1 \\sigma T_1^4 + \\epsilon_2 \\sigma T_2^4 - \\epsilon_1 \\epsilon_2 \\sigma T_2^4 - \\epsilon_2 \\sigma T_2^4 - \\epsilon_1 \\sigma T_1^4 + \\epsilon_1 \\epsilon_2 \\sigma T_1^4 $$\nThe terms $\\epsilon_1 \\sigma T_1^4$ and $\\epsilon_2 \\sigma T_2^4$ cancel out, leaving:\n$$ \\epsilon_1 \\epsilon_2 \\sigma (T_1^4 - T_2^4) $$\nSubstituting this back into the expression for $q_{12}$:\n$$q_{12} = \\frac{\\epsilon_1 \\epsilon_2 \\sigma (T_1^4 - T_2^4)}{\\epsilon_1 + \\epsilon_2 - \\epsilon_1 \\epsilon_2}$$\nThis is a correct closed-form expression. However, it can be rearranged into a more conventional form by dividing the numerator and the denominator by the product $\\epsilon_1 \\epsilon_2$:\n$$q_{12} = \\frac{\\sigma (T_1^4 - T_2^4)}{\\frac{\\epsilon_1 + \\epsilon_2 - \\epsilon_1 \\epsilon_2}{\\epsilon_1 \\epsilon_2}}$$\n$$q_{12} = \\frac{\\sigma (T_1^4 - T_2^4)}{\\frac{\\epsilon_1}{\\epsilon_1 \\epsilon_2} + \\frac{\\epsilon_2}{\\epsilon_1 \\epsilon_2} - \\frac{\\epsilon_1 \\epsilon_2}{\\epsilon_1 \\epsilon_2}}$$\n$$q_{12} = \\frac{\\sigma (T_1^4 - T_2^4)}{\\frac{1}{\\epsilon_2} + \\frac{1}{\\epsilon_1} - 1}$$\nThis final form elegantly separates the temperature-dependent blackbody exchange term, $\\sigma (T_1^4 - T_2^4)$, from a factor that accounts for the non-ideal (gray) nature of the surfaces.",
            "answer": "$$\\boxed{\\frac{\\sigma (T_1^4 - T_2^4)}{\\frac{1}{\\epsilon_1} + \\frac{1}{\\epsilon_2} - 1}}$$"
        },
        {
            "introduction": "Having established the framework for integrated fluxes, we now delve into the spectral details that underpin them. This computational practice focuses on Planck's law, the fundamental description of the blackbody radiation spectrum. You will write a program to calculate the fraction of energy emitted within the crucial longwave atmospheric window ($8$–$12\\,\\mu\\mathrm{m}$), a key pathway for Earth's radiative cooling to space. This exercise not only hones essential numerical integration skills but also provides quantitative insight into how temperature governs the distribution of radiated energy across different wavelengths. ",
            "id": "4094506",
            "problem": "Consider a thermally emitting surface that behaves as a blackbody at temperature $T$. In numerical weather prediction and climate modeling, the longwave atmospheric window spanning $8$–$12\\,\\mu\\mathrm{m}$ plays a central role in regulating the outgoing longwave radiation. The fundamental base is Planck's law for spectral radiance per unit wavelength per unit solid angle,\n$$\nB_{\\lambda}(T) = \\frac{2 h c^2}{\\lambda^5}\\,\\frac{1}{\\exp\\!\\left(\\frac{h c}{\\lambda k_{\\mathrm{B}} T}\\right) - 1},\n$$\nwhere $h$ is Planck's constant, $c$ is the speed of light, $k_{\\mathrm{B}}$ is the Boltzmann constant, and $\\lambda$ is the wavelength. For a diffuse (Lambertian) emitter, the hemispheric spectral exitance (emissive power) is\n$$\nM_{\\lambda}(T) = \\pi\\,B_{\\lambda}(T).\n$$\nThe total emitted flux integrated over all wavelengths is\n$$\nM(T) = \\int_{0}^{\\infty} M_{\\lambda}(T)\\,\\mathrm{d}\\lambda,\n$$\nand the band-limited emitted flux in a window $[\\lambda_1,\\lambda_2]$ is\n$$\nM_{[\\lambda_1,\\lambda_2]}(T) = \\int_{\\lambda_1}^{\\lambda_2} M_{\\lambda}(T)\\,\\mathrm{d}\\lambda.\n$$\nDefine the fraction of the total blackbody flux emitted into the window $[\\lambda_1,\\lambda_2]$ at temperature $T$ as\n$$\nF(\\lambda_1,\\lambda_2;T) = \\frac{M_{[\\lambda_1,\\lambda_2]}(T)}{M(T)}.\n$$\nKirchhoff’s law of thermal radiation states that, for a body in local thermodynamic equilibrium, the spectral emissivity equals the spectral absorptivity. For a blackbody, the spectral emissivity is unity at all wavelengths, so $M_{\\lambda}(T)$ fully characterizes the emission.\n\nYour task is to write a complete, runnable program that computes $F(\\lambda_1,\\lambda_2;T)$ by numerically integrating Planck’s spectrum over the wavelength band $[\\lambda_1,\\lambda_2]$ and normalizing by the numerically integrated total flux over $[0,\\infty)$. All computations must use the constants $h$, $c$, and $k_{\\mathrm{B}}$ as defined by the International System of Units. The fraction $F(\\lambda_1,\\lambda_2;T)$ is dimensionless, so no physical units are required in the output. The wavelength inputs in the test suite below are given in micrometers and must be correctly converted to meters inside the program. Angles do not appear in this calculation.\n\nImplement the program to evaluate the following test suite:\n1. $T = 300\\,\\mathrm{K}$, $\\lambda_1 = 8\\,\\mu\\mathrm{m}$, $\\lambda_2 = 12\\,\\mu\\mathrm{m}$.\n2. $T = 300\\,\\mathrm{K}$, $\\lambda_1 = 0.1\\,\\mu\\mathrm{m}$, $\\lambda_2 = 1000\\,\\mu\\mathrm{m}$.\n3. $T = 200\\,\\mathrm{K}$, $\\lambda_1 = 8\\,\\mu\\mathrm{m}$, $\\lambda_2 = 12\\,\\mu\\mathrm{m}$.\n4. $T = 1000\\,\\mathrm{K}$, $\\lambda_1 = 8\\,\\mu\\mathrm{m}$, $\\lambda_2 = 12\\,\\mu\\mathrm{m}$.\n5. $T = 300\\,\\mathrm{K}$, $\\lambda_1 = 9.5\\,\\mu\\mathrm{m}$, $\\lambda_2 = 10.0\\,\\mu\\mathrm{m}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each fraction rounded to ten decimal places, for example, \"[0.1234567890,0.9876543210,...]\". The output must be dimensionless decimals.\n\nEnsure numerical stability and accuracy for the semi-infinite integration in the denominator. The algorithm should be general and principled, not relying on empirically fitted shortcuts or pre-tabulated values.",
            "solution": "The problem is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\n\n- **Planck's Law for Spectral Radiance**:\n$$\nB_{\\lambda}(T) = \\frac{2 h c^2}{\\lambda^5}\\,\\frac{1}{\\exp\\!\\left(\\frac{h c}{\\lambda k_{\\mathrm{B}} T}\\right) - 1}\n$$\n- **Hemispheric Spectral Exitance for a Lambertian Emitter**:\n$$\nM_{\\lambda}(T) = \\pi\\,B_{\\lambda}(T)\n$$\n- **Total Emitted Flux**:\n$$\nM(T) = \\int_{0}^{\\infty} M_{\\lambda}(T)\\,\\mathrm{d}\\lambda\n$$\n- **Band-Limited Emitted Flux**:\n$$\nM_{[\\lambda_1,\\lambda_2]}(T) = \\int_{\\lambda_1}^{\\lambda_2} M_{\\lambda}(T)\\,\\mathrm{d}\\lambda\n$$\n- **Fraction of Total Flux in a Wavelength Window**:\n$$\nF(\\lambda_1,\\lambda_2;T) = \\frac{M_{[\\lambda_1,\\lambda_2]}(T)}{M(T)}\n$$\n- **Constants**: $h$ (Planck's constant), $c$ (speed of light), $k_{\\mathrm{B}}$ (Boltzmann constant) are to be used as defined by the International System of Units (SI).\n- **Task**: Compute $F(\\lambda_1,\\lambda_2;T)$ by numerically integrating Planck’s spectrum.\n- **Input Data Format**: Wavelengths ($\\lambda_1, \\lambda_2$) are provided in micrometers ($\\mu\\mathrm{m}$).\n- **Test Suite**:\n    1. $T = 300\\,\\mathrm{K}$, $\\lambda_1 = 8\\,\\mu\\mathrm{m}$, $\\lambda_2 = 12\\,\\mu\\mathrm{m}$.\n    2. $T = 300\\,\\mathrm{K}$, $\\lambda_1 = 0.1\\,\\mu\\mathrm{m}$, $\\lambda_2 = 1000\\,\\mu\\mathrm{m}$.\n    3. $T = 200\\,\\mathrm{K}$, $\\lambda_1 = 8\\,\\mu\\mathrm{m}$, $\\lambda_2 = 12\\,\\mu\\mathrm{m}$.\n    4. $T = 1000\\,\\mathrm{K}$, $\\lambda_1 = 8\\,\\mu\\mathrm{m}$, $\\lambda_2 = 12\\,\\mu\\mathrm{m}$.\n    5. $T = 300\\,\\mathrm{K}$, $\\lambda_1 = 9.5\\,\\mu\\mathrm{m}$, $\\lambda_2 = 10.0\\,\\mu\\mathrm{m}$.\n\n### Step 2: Validate Using Extracted Givens\n\n- **Scientifically Grounded**: The problem is based on Planck's law of blackbody radiation, a fundamental and experimentally verified principle of quantum physics. Its application to atmospheric science is standard. This problem is scientifically sound.\n- **Well-Posed**: The problem provides a clear definition of the quantity to be calculated, $F(\\lambda_1,\\lambda_2;T)$, as a ratio of two definite integrals. The integrand is a well-behaved physical function, and the integration domains are specified. All necessary parameters for the test cases are provided. A unique numerical solution exists for each test case.\n- **Objective**: The problem is stated in precise mathematical and physical terms, free of any subjectivity or ambiguity.\n\nThe problem does not exhibit any of the flaws listed in the validation checklist. It is a well-defined computational physics problem.\n\n### Step 3: Verdict and Action\n\nThe problem is **valid**. A solution will be developed.\n\n### Solution\n\nThe objective is to compute the fraction $F(\\lambda_1,\\lambda_2;T)$ of total blackbody emissive power that falls within the spectral band $[\\lambda_1, \\lambda_2]$. The fraction is defined as:\n$$\nF(\\lambda_1,\\lambda_2;T) = \\frac{\\int_{\\lambda_1}^{\\lambda_2} M_{\\lambda}(T)\\,\\mathrm{d}\\lambda}{\\int_{0}^{\\infty} M_{\\lambda}(T)\\,\\mathrm{d}\\lambda}\n$$\nSubstituting the expression for $M_{\\lambda}(T) = \\pi B_{\\lambda}(T)$ gives:\n$$\nF(\\lambda_1,\\lambda_2;T) = \\frac{\\int_{\\lambda_1}^{\\lambda_2} \\pi \\frac{2 h c^2}{\\lambda^5}\\,\\frac{1}{\\exp\\left(\\frac{h c}{\\lambda k_{\\mathrm{B}} T}\\right) - 1} \\,\\mathrm{d}\\lambda}{\\int_{0}^{\\infty} \\pi \\frac{2 h c^2}{\\lambda^5}\\,\\frac{1}{\\exp\\left(\\frac{h c}{\\lambda k_{\\mathrm{B}} T}\\right) - 1} \\,\\mathrm{d}\\lambda}\n$$\nThe constant pre-factor $2 \\pi h c^2$ is present in both the numerator and the denominator, and thus cancels. The expression simplifies to:\n$$\nF(\\lambda_1,\\lambda_2;T) = \\frac{\\int_{\\lambda_1}^{\\lambda_2} \\frac{1}{\\lambda^5} \\frac{1}{\\exp\\left(\\frac{hc}{\\lambda k_{\\mathrm{B}} T}\\right)-1} \\mathrm{d}\\lambda}{\\int_{0}^{\\infty} \\frac{1}{\\lambda^5} \\frac{1}{\\exp\\left(\\frac{hc}{\\lambda k_{\\mathrm{B}} T}\\right)-1} \\mathrm{d}\\lambda}\n$$\nTo make the integrals more amenable to numerical evaluation, we perform a change of variables. Let $x$ be the dimensionless quantity:\n$$\nx = \\frac{hc}{\\lambda k_{\\mathrm{B}} T}\n$$\nFrom this, we derive the expressions for $\\lambda$ and its differential $\\mathrm{d}\\lambda$:\n$$\n\\lambda = \\frac{hc}{x k_{\\mathrm{B}} T} \\implies \\mathrm{d}\\lambda = -\\frac{hc}{x^2 k_{\\mathrm{B}} T} \\mathrm{d}x\n$$\nThe integration limits also transform:\n- As $\\lambda \\to \\lambda_1$, $x \\to x_1 = \\frac{hc}{\\lambda_1 k_{\\mathrm{B}} T}$.\n- As $\\lambda \\to \\lambda_2$, $x \\to x_2 = \\frac{hc}{\\lambda_2 k_{\\mathrm{B}} T}$.\n- As $\\lambda \\to 0$, $x \\to \\infty$.\n- As $\\lambda \\to \\infty$, $x \\to 0$.\n\nSubstituting these into the integrand term $\\frac{\\mathrm{d}\\lambda}{\\lambda^5}$:\n$$\n\\frac{\\mathrm{d}\\lambda}{\\lambda^5} = \\frac{-\\frac{hc}{x^2 k_{\\mathrm{B}} T} \\mathrm{d}x}{\\left(\\frac{hc}{x k_{\\mathrm{B}} T}\\right)^5} = -\\left(\\frac{k_{\\mathrm{B}} T}{hc}\\right)^4 x^3 \\mathrm{d}x\n$$\nThe integrals can now be rewritten in terms of $x$. The band-limited integral in the numerator becomes:\n$$\n\\int_{\\lambda_1}^{\\lambda_2} \\dots = \\int_{x_1}^{x_2} \\frac{1}{\\exp(x)-1} \\left[-\\left(\\frac{k_{\\mathrm{B}} T}{hc}\\right)^4 x^3\\right] \\mathrm{d}x = \\left(\\frac{k_{\\mathrm{B}} T}{hc}\\right)^4 \\int_{x_2}^{x_1} \\frac{x^3}{\\exp(x)-1} \\mathrm{d}x\n$$\nNote that since $\\lambda_1  \\lambda_2$, we have $x_1  x_2$, so the integration interval $[x_2, x_1]$ is correctly ordered.\nThe total integral in the denominator becomes:\n$$\n\\int_{0}^{\\infty} \\dots = \\int_{\\infty}^{0} \\frac{1}{\\exp(x)-1} \\left[-\\left(\\frac{k_{\\mathrm{B}} T}{hc}\\right)^4 x^3\\right] \\mathrm{d}x = \\left(\\frac{k_{\\mathrm{B}} T}{hc}\\right)^4 \\int_{0}^{\\infty} \\frac{x^3}{\\exp(x)-1} \\mathrm{d}x\n$$\nThe constant factor $\\left(\\frac{k_{\\mathrm{B}} T}{hc}\\right)^4$ again cancels from the fraction, yielding the final, elegant form:\n$$\nF(\\lambda_1,\\lambda_2;T) = \\frac{\\int_{x_2}^{x_1} \\frac{x^3}{\\exp(x)-1} \\mathrm{d}x}{\\int_{0}^{\\infty} \\frac{x^3}{\\exp(x)-1} \\mathrm{d}x}\n$$\nThe problem statement requires that the total flux (denominator) be computed numerically. Let the integrand be $g(x) = \\frac{x^3}{\\exp(x)-1}$. The task thus reduces to calculating the ratio of two numerical integrals:\n$$\nF(\\lambda_1,\\lambda_2;T) = \\frac{\\int_{x_2}^{x_1} g(x) \\mathrm{d}x}{\\int_{0}^{\\infty} g(x) \\mathrm{d}x}\n$$\nThe denominator is related to the Riemann zeta function and is analytically known to be $\\int_{0}^{\\infty} g(x) \\mathrm{d}x = \\frac{\\pi^4}{15}$. We will compute it numerically as instructed and use this value for normalization across all test cases. The `scipy.integrate.quad` function is suitable for these high-precision numerical integrations. For numerical stability, especially for small values of $x$, the term $\\exp(x)-1$ is best computed using `numpy.expm1(x)`.\n\nThe algorithm is as follows:\n1.  Define the universal physical constants $h$, $c$, and $k_{\\mathrm{B}}$ from the `scipy.constants` module.\n2.  Define the function $g(x) = x^3/(\\exp(x)-1)$.\n3.  Compute the value of the denominator integral, $I_{total} = \\int_{0}^{\\infty} g(x) \\mathrm{d}x$, once using `scipy.integrate.quad`.\n4.  For each test case $(T, \\lambda_1, \\lambda_2)$:\n    a. Convert the input wavelengths $\\lambda_1, \\lambda_2$ from micrometers to SI units (meters) by multiplying by $10^{-6}$.\n    b. Calculate the dimensionless integration limits $x_1 = \\frac{hc}{\\lambda_1 k_{\\mathrm{B}} T}$ and $x_2 = \\frac{hc}{\\lambda_2 k_{\\mathrm{B}} T}$.\n    c. Compute the numerator integral, $I_{band} = \\int_{x_2}^{x_1} g(x) \\mathrm{d}x$, using `scipy.integrate.quad`.\n    d. Calculate the fraction $F = I_{band} / I_{total}$.\n5.  Collect the results, format them to ten decimal places, and print them according to the specified output format.\nThis procedure is robust, scientifically principled, and directly implements the requirements of the problem.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\nfrom scipy import constants\n\ndef solve():\n    \"\"\"\n    Computes the fraction of total blackbody flux emitted into a specified\n    wavelength window for several test cases.\n    \"\"\"\n    # Define physical constants from the International System of Units (SI).\n    h = constants.h      # Planck constant (J s)\n    c = constants.c      # Speed of light in vacuum (m/s)\n    k_B = constants.k    # Boltzmann constant (J/K)\n\n    # Define the integrand g(x) = x^3 / (e^x - 1) after the change of variables.\n    # The change of variables x = hc / (lambda * k_B * T) makes the integral\n    # dimensionless and numerically stable.\n    def g(x):\n        \"\"\"\n        The integrand for the dimensionless form of Planck's law.\n        Uses np.expm1(x) for numerical precision when x is close to zero.\n        \"\"\"\n        # The limit of g(x) as x - 0 is 0. Explicitly handle this case to avoid\n        # potential division by zero if quad samples x=0.\n        if x == 0:\n            return 0.0\n        return x**3 / np.expm1(x)\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (T in Kelvin, lambda_1 in micrometers, lambda_2 in micrometers).\n    test_cases = [\n        (300.0, 8.0, 12.0),\n        (300.0, 0.1, 1000.0),\n        (200.0, 8.0, 12.0),\n        (1000.0, 8.0, 12.0),\n        (300.0, 9.5, 10.0),\n    ]\n\n    results = []\n\n    # Per the problem, we normalize by the numerically integrated total flux.\n    # This integral is constant, so we compute it once.\n    # The analytical value is pi^4 / 15. The numerical integration should be very close.\n    I_total, _ = quad(g, 0, np.inf)\n\n    # Pre-calculate the constant factor for the change of variables.\n    const_factor = (h * c) / k_B\n\n    for T, lam1_um, lam2_um in test_cases:\n        # Convert wavelengths from micrometers to meters (SI units).\n        lam1_m = lam1_um * 1e-6\n        lam2_m = lam2_um * 1e-6\n\n        # Calculate the dimensionless integration limits x1 and x2.\n        # Note that since lam1  lam2, we will have x1  x2.\n        # The integration is correctly performed from x2 to x1.\n        x1 = const_factor / (lam1_m * T)\n        x2 = const_factor / (lam2_m * T)\n\n        # Numerically compute the band-limited integral.\n        I_band, _ = quad(g, x2, x1)\n\n        # Calculate the fraction F by normalizing with the total integral.\n        F = I_band / I_total\n\n        # Append the result, formatted to 10 decimal places.\n        results.append(f\"{F:.10f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Real-world surfaces are neither ideal blackbodies nor simple gray bodies; their ability to emit radiation varies with wavelength. This advanced practice bridges theory and application by examining the thermal emission from a water surface, using realistic, spectrally-dependent emissivity data. You will quantify the error introduced by the common \"grey-body\" approximation—a simplification used in many radiation codes—by comparing its results to a more accurate, spectrally-resolved calculation. This exercise is critical for developing a professional skepticism of model parameterizations and provides hands-on experience in evaluating the trade-offs between physical accuracy and computational efficiency in numerical modeling. ",
            "id": "4094481",
            "problem": "Consider a water surface emitting thermal radiation into a hemisphere under the assumptions of isotropic emission and local thermodynamic equilibrium. The problem is anchored in radiative transfer fundamentals used in Numerical Weather Prediction (NWP) and climate modeling, specifically relying on Planck’s law of blackbody radiation and Kirchhoff’s law of thermal radiation. The objective is to evaluate the error introduced by assuming a wavelength-independent grey emissivity for water across the atmospheric window band $8$–$14\\,\\mu\\mathrm{m}$ at temperature $T=300\\,\\mathrm{K}$, and to quantify its impact on band-limited longwave fluxes. You must derive and implement the band-integrated hemispheric radiative exitance using first principles and compute the error caused by the grey emissivity approximation in several scientifically plausible scenarios.\n\nUse the following foundational base:\n\n- The spectral radiance of a blackbody at temperature $T$ is given by Planck’s law, expressed as $B_{\\lambda}(T)$, where the variable $\\lambda$ denotes wavelength.\n- Lambert’s cosine law for a diffuse emitter implies a relationship between spectral radiance and spectral hemispheric exitance, denoted $M_{\\lambda}(T)$.\n- Kirchhoff’s law of thermal radiation states that, for an opaque surface in local thermodynamic equilibrium, spectral emissivity equals spectral absorptivity and determines the emitted power via multiplicative weighting of the blackbody emission at each $\\lambda$.\n\nFrom these, formulate the band-limited hemispheric exitance in the interval $\\lambda \\in [8\\,\\mu\\mathrm{m},14\\,\\mu\\mathrm{m}]$ as an integral over wavelength of the product of spectral emissivity and blackbody spectral exitance. The grey emissivity approximation assumes a constant emissivity $\\varepsilon_{\\mathrm{grey}}$ across the band and yields a different band-integrated flux. Define and compute the absolute error $\\Delta F$ and the relative error $r$ between the grey approximation and the spectrally resolved calculation. The absolute error must be expressed in $\\mathrm{W}\\,\\mathrm{m}^{-2}$, and the relative error must be expressed as a decimal fraction.\n\nImplement the following mathematical definitions and requirements in your program:\n\n- Let $B_{\\lambda}(T)$ denote the spectral radiance of a blackbody. Let $M_{\\lambda}(T)$ denote the spectral hemispheric exitance. Use the appropriate physical constants for Planck’s law and the radiometric conversion to $M_{\\lambda}(T)$ from $B_{\\lambda}(T)$.\n- Let $\\varepsilon(\\lambda)$ denote the spectral emissivity of water. The true band-limited hemispheric exitance is\n$$F_{\\mathrm{true}}(T) = \\int_{\\lambda_1}^{\\lambda_2} \\varepsilon(\\lambda)\\,M_{\\lambda}(T)\\,\\mathrm{d}\\lambda,$$\nwith $\\lambda_1=8\\,\\mu\\mathrm{m}$ and $\\lambda_2=14\\,\\mu\\mathrm{m}$.\n- The grey-emissivity band-limited hemispheric exitance is\n$$F_{\\mathrm{grey}}(T) = \\varepsilon_{\\mathrm{grey}} \\int_{\\lambda_1}^{\\lambda_2} M_{\\lambda}(T)\\,\\mathrm{d}\\lambda.$$\n- The absolute error is\n$$\\Delta F = F_{\\mathrm{grey}} - F_{\\mathrm{true}},$$\nexpressed in $\\mathrm{W}\\,\\mathrm{m}^{-2}$.\n- The relative error is\n$$r = \\frac{\\Delta F}{F_{\\mathrm{true}}},$$\nexpressed as a decimal.\n\nNumerical implementation requirements:\n\n- Discretize the wavelength interval $[8\\,\\mu\\mathrm{m},14\\,\\mu\\mathrm{m}]$ uniformly using a step $\\Delta\\lambda = 0.001\\,\\mu\\mathrm{m}$ and perform numerical integration via the trapezoidal rule, ensuring unit consistency by converting $\\lambda$ into $\\mathrm{m}$ in all radiometric expressions. The final answers $F_{\\mathrm{true}}$, $F_{\\mathrm{grey}}$, and $\\Delta F$ must be in $\\mathrm{W}\\,\\mathrm{m}^{-2}$ and $r$ must be unitless.\n- Define $\\varepsilon(\\lambda)$ by piecewise-linear interpolation over specified nodes $\\{(\\lambda_i,\\varepsilon_i)\\}$ with $\\lambda_i$ in $\\mu\\mathrm{m}$ and $\\varepsilon_i$ unitless. Between nodes, use linear interpolation; outside the node range, do not extrapolate (all nodes span the entire band in this problem).\n- Use the following test suite of parameter values that cover typical and edge-case behavior for water surface emissivity in the thermal infrared:\n    - Case $1$ (representative water): nodes $\\{(8,0.965),(9.5,0.980),(10,0.985),(11.5,0.980),(12.5,0.975),(14,0.980)\\}$, with $\\varepsilon_{\\mathrm{grey}}=0.980$.\n    - Case $2$ (sea foam, high emissivity): nodes $\\{(8,0.985),(10,0.990),(12,0.988),(14,0.989)\\}$, with $\\varepsilon_{\\mathrm{grey}}=0.980$.\n    - Case $3$ (glassy water, lower emissivity): nodes $\\{(8,0.950),(9.5,0.960),(10.5,0.967),(12.5,0.955),(14,0.960)\\}$, with $\\varepsilon_{\\mathrm{grey}}=0.980$.\n    - Case $4$ (Planck-weighted grey emissivity for self-consistency): use the same nodes as Case $1$, and set $\\varepsilon_{\\mathrm{grey}}$ equal to the Planck-weighted band average of $\\varepsilon(\\lambda)$, i.e.,\n    $$\\varepsilon_{\\mathrm{grey}}^{\\star} = \\frac{\\int_{\\lambda_1}^{\\lambda_2} \\varepsilon(\\lambda)\\,M_{\\lambda}(T)\\,\\mathrm{d}\\lambda}{\\int_{\\lambda_1}^{\\lambda_2} M_{\\lambda}(T)\\,\\mathrm{d}\\lambda}.$$\n    This case should assess the limiting behavior where the grey approximation is tuned to the band, yielding minimal error.\n- Use $T=300\\,\\mathrm{K}$ for all cases.\n\nYour program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case’s result must be a list of two floating-point numbers $[\\Delta F,r]$, in the order of the cases above. The required final output format is\n$$[[\\Delta F_1,r_1],[\\Delta F_2,r_2],[\\Delta F_3,r_3],[\\Delta F_4,r_4]],$$\nwith $\\Delta F_i$ in $\\mathrm{W}\\,\\mathrm{m}^{-2}$ and $r_i$ unitless, for $i=1,2,3,4$.",
            "solution": "The problem is scientifically and mathematically well-posed, providing all necessary definitions, constants, and data to perform a complete analysis. It is grounded in the fundamental principles of radiative transfer, including Planck's law, Lambert's law, and Kirchhoff's law, and applies them to a standard problem in atmospheric science and remote sensing—the calculation of thermal emission from a water surface. The premises are physically realistic, and the numerical requirements are clearly specified. Therefore, the problem is valid and a solution can be formulated.\n\nThe solution framework is constructed from first principles of thermal radiation physics and numerical analysis.\n\n**1. Fundamental Radiative Quantities**\n\nThe foundation of thermal radiation is Planck's law, which describes the spectral radiance $B_{\\lambda}(T)$ of a blackbody at an absolute temperature $T$ as a function of wavelength $\\lambda$. The radiance is the power emitted per unit area, per unit solid angle, per unit wavelength. The expression for $B_{\\lambda}(T)$ is:\n$$\nB_{\\lambda}(T) = \\frac{2hc^2}{\\lambda^5} \\frac{1}{e^{\\frac{hc}{\\lambda k_B T}} - 1}\n$$\nwhere $h$ is the Planck constant, $c$ is the speed of light in vacuum, and $k_B$ is the Boltzmann constant. The units of $B_{\\lambda}(T)$ are $\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mathrm{m}^{-1}$.\n\nFor many natural surfaces, including water, emission is approximately diffuse or Lambertian. This implies that the radiance is uniform in all directions within the hemisphere above the surface. For a Lambertian emitter, the spectral hemispheric exitance $M_{\\lambda}(T)$, which is the total power radiated from a unit area into the hemisphere per unit wavelength, is related to the spectral radiance by a factor of $\\pi$:\n$$\nM_{\\lambda}(T) = \\pi B_{\\lambda}(T) = \\frac{2\\pi hc^2}{\\lambda^5} \\frac{1}{e^{\\frac{hc}{\\lambda k_B T}} - 1}\n$$\nThe units of $M_{\\lambda}(T)$ are $\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{m}^{-1}$. This quantity represents the maximum possible thermal emission at a given wavelength and temperature, as defined by an ideal blackbody.\n\n**2. Emission from a Real Surface (Water)**\n\nReal surfaces are not perfect blackbodies. Their ability to emit radiation is described by the spectral emissivity, $\\varepsilon(\\lambda)$, a dimensionless quantity ranging from $0$ to $1$. According to Kirchhoff's law of thermal radiation, for an opaque body in local thermodynamic equilibrium, the spectral emissivity is equal to its spectral absorptivity. The spectral hemispheric exitance of a real surface is thus the product of its spectral emissivity and the blackbody spectral exitance:\n$$\nM_{\\lambda}^{\\text{real}}(T) = \\varepsilon(\\lambda) M_{\\lambda}(T)\n$$\n\n**3. Band-Integrated Hemispheric Exitance**\n\nThe total power emitted within a specific spectral band $[\\lambda_1, \\lambda_2]$ is found by integrating the spectral exitance over that wavelength interval. For a surface with a spectrally varying emissivity $\\varepsilon(\\lambda)$, the true band-limited hemispheric exitance, denoted $F_{\\mathrm{true}}$, is:\n$$\nF_{\\mathrm{true}}(T) = \\int_{\\lambda_1}^{\\lambda_2} \\varepsilon(\\lambda) M_{\\lambda}(T) \\, \\mathrm{d}\\lambda\n$$\nIn this problem, the band is specified as $\\lambda_1 = 8\\,\\mu\\mathrm{m}$ and $\\lambda_2 = 14\\,\\mu\\mathrm{m}$.\n\n**4. The Grey Emissivity Approximation**\n\nIn many practical applications, it is convenient to assume that the emissivity is constant across the spectral band of interest. This constant value is termed the grey emissivity, $\\varepsilon_{\\mathrm{grey}}$. Under this approximation, the band-limited hemispheric exitance, $F_{\\mathrm{grey}}$, is calculated as:\n$$\nF_{\\mathrm{grey}}(T) = \\varepsilon_{\\mathrm{grey}} \\int_{\\lambda_1}^{\\lambda_2} M_{\\lambda}(T) \\, \\mathrm{d}\\lambda\n$$\nThis approximation simplifies calculations but introduces an error, which this problem requires us to quantify.\n\n**5. Error Quantification**\n\nThe error resulting from the grey emissivity approximation is assessed through two metrics:\n- The absolute error, $\\Delta F$, is the difference between the approximated flux and the true flux:\n$$\n\\Delta F = F_{\\mathrm{grey}}(T) - F_{\\mathrm{true}}(T)\n$$\n- The relative error, $r$, normalizes the absolute error by the true flux:\n$$\nr = \\frac{\\Delta F}{F_{\\mathrm{true}}(T)} = \\frac{F_{\\mathrm{grey}}(T)}{F_{\\mathrm{true}}(T)} - 1\n$$\n\n**6. Numerical Implementation**\n\nTo compute the integrals, we will employ a numerical approach as specified.\n- **Discretization:** The wavelength interval $[\\lambda_1, \\lambda_2] = [8\\,\\mu\\mathrm{m}, 14\\,\\mu\\mathrm{m}]$ is discretized into a uniform grid of wavelengths $\\lambda_j$ with a step size of $\\Delta\\lambda = 0.001\\,\\mu\\mathrm{m}$. All radiometric calculations require wavelength to be in meters, so a conversion $\\lambda_j[\\mathrm{m}] = \\lambda_j[\\mu\\mathrm{m}] \\times 10^{-6}$ is performed.\n- **Interpolation:** The spectral emissivity of water, $\\varepsilon(\\lambda)$, is defined by a set of nodes $\\{(\\lambda_i, \\varepsilon_i)\\}$. For any wavelength $\\lambda_j$ on our fine grid, the value of $\\varepsilon(\\lambda_j)$ is found using piecewise-linear interpolation between the given nodes.\n- **Integration:** The definite integrals for $F_{\\mathrm{true}}$ and the integral component of $F_{\\mathrm{grey}}$ are calculated using the trapezoidal rule, which is well-suited for finely sampled functions. For an integral $\\int_a^b f(\\lambda) \\mathrm{d}\\lambda$ evaluated on the grid $\\lambda_j$, the numerical approximation is $\\sum_{j=1}^{N-1} \\frac{1}{2}(f(\\lambda_j) + f(\\lambda_{j+1}))(\\lambda_{j+1} - \\lambda_j)$.\n\n**7. Special Case 4: Planck-Weighted Emissivity**\n\nCase 4 introduces a special definition for $\\varepsilon_{\\mathrm{grey}}$ as the Planck-weighted average emissivity, $\\varepsilon_{\\mathrm{grey}}^{\\star}$:\n$$\n\\varepsilon_{\\mathrm{grey}}^{\\star} = \\frac{\\int_{\\lambda_1}^{\\lambda_2} \\varepsilon(\\lambda) M_{\\lambda}(T) \\, \\mathrm{d}\\lambda}{\\int_{\\lambda_1}^{\\lambda_2} M_{\\lambda}(T) \\, \\mathrm{d}\\lambda}\n$$\nSubstituting the definition of $F_{\\mathrm{true}}$, this simplifies to:\n$$\n\\varepsilon_{\\mathrm{grey}}^{\\star} = \\frac{F_{\\mathrm{true}}(T)}{\\int_{\\lambda_1}^{\\lambda_2} M_{\\lambda}(T) \\, \\mathrm{d}\\lambda}\n$$\nThe grey flux for this case is then $F_{\\mathrm{grey}}(T) = \\varepsilon_{\\mathrm{grey}}^{\\star} \\int_{\\lambda_1}^{\\lambda_2} M_{\\lambda}(T) \\, \\mathrm{d}\\lambda$. By substituting the expression for $\\varepsilon_{\\mathrm{grey}}^{\\star}$, we find that $F_{\\mathrm{grey}}(T) = F_{\\mathrm{true}}(T)$. Consequently, the absolute and relative errors, $\\Delta F$ and $r$, should be computationally indistinguishable from zero (i.e., on the order of machine precision). This serves as an internal consistency check for the numerical implementation.\n\nThe following program implements this logic for each of the four specified cases.",
            "answer": "```python\nimport numpy as np\nfrom scipy import constants\n\ndef solve():\n    \"\"\"\n    Calculates the error introduced by the grey emissivity approximation for a water surface.\n    \"\"\"\n    # Physical constants from scipy.constants\n    h = constants.h      # Planck constant (J*s)\n    c = constants.c      # Speed of light (m/s)\n    k_B = constants.k    # Boltzmann constant (J/K)\n\n    # Problem parameters\n    T = 300.0  # Temperature in Kelvin\n    lambda1_um = 8.0   # Start wavelength in micrometers\n    lambda2_um = 14.0  # End wavelength in micrometers\n    d_lambda_um = 0.001 # Wavelength step in micrometers\n\n    # Create the discretized wavelength grid for numerical integration\n    num_points = int(round((lambda2_um - lambda1_um) / d_lambda_um)) + 1\n    lambda_um = np.linspace(lambda1_um, lambda2_um, num_points)\n    lambda_m = lambda_um * 1e-6 # Convert wavelength to meters for physical calculation\n\n    # Calculate blackbody spectral hemispheric exitance M_lambda(T) over the grid\n    # M_lambda(T) = pi * B_lambda(T) = (2 * pi * h * c^2) / (lambda^5 * (exp(h*c / (lambda*k*T)) - 1))\n    # Units: W / m^2 / m\n    exponent_term = (h * c) / (lambda_m * k_B * T)\n    M_lambda_T = (2.0 * np.pi * h * c**2) / (lambda_m**5 * (np.exp(exponent_term) - 1.0))\n\n    # Calculate the band-integrated blackbody exitance, used for the grey approximation\n    # This integral is constant for all cases.\n    M_integral = np.trapz(M_lambda_T, x=lambda_m)\n\n    # Define the test cases as per the problem statement\n    test_cases = [\n        {'id': 1, 'nodes': [(8.0, 0.965), (9.5, 0.980), (10.0, 0.985), (11.5, 0.980), (12.5, 0.975), (14.0, 0.980)], 'eps_grey': 0.980},\n        {'id': 2, 'nodes': [(8.0, 0.985), (10.0, 0.990), (12.0, 0.988), (14.0, 0.989)], 'eps_grey': 0.980},\n        {'id': 3, 'nodes': [(8.0, 0.950), (9.5, 0.960), (10.5, 0.967), (12.5, 0.955), (14.0, 0.960)], 'eps_grey': 0.980},\n        {'id': 4, 'nodes': [(8.0, 0.965), (9.5, 0.980), (10.0, 0.985), (11.5, 0.980), (12.5, 0.975), (14.0, 0.980)], 'eps_grey': 'planck_weighted'}\n    ]\n\n    results = []\n    for case in test_cases:\n        # Extract node data for spectral emissivity interpolation\n        node_lambdas_um = [p[0] for p in case['nodes']]\n        node_epsilons = [p[1] for p in case['nodes']]\n\n        # Perform piecewise-linear interpolation to get emissivity at each grid point\n        epsilon_lambda = np.interp(lambda_um, node_lambdas_um, node_epsilons)\n        \n        # Calculate the true band-limited hemispheric exitance\n        # F_true = integral(epsilon(lambda) * M_lambda(T) * d_lambda)\n        integrand_true = epsilon_lambda * M_lambda_T\n        F_true = np.trapz(integrand_true, x=lambda_m)\n\n        # Determine the grey emissivity value for the current case\n        if case['eps_grey'] == 'planck_weighted':\n            # Case 4: eps_grey is the Planck-weighted average\n            eps_grey = F_true / M_integral\n        else:\n            # Cases 1, 2, 3: eps_grey is a fixed value\n            eps_grey = case['eps_grey']\n\n        # Calculate the grey-body approximation of the band-limited exitance\n        # F_grey = eps_grey * integral(M_lambda(T) * d_lambda)\n        F_grey = eps_grey * M_integral\n\n        # Calculate absolute and relative errors\n        delta_F = F_grey - F_true\n        r = delta_F / F_true if F_true != 0.0 else 0.0\n\n        results.append([delta_F, r])\n\n    # Format the final output string exactly as required\n    output_str = \"[\" + \",\".join([f\"[{df},{r}]\" for df, r in results]) + \"]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}