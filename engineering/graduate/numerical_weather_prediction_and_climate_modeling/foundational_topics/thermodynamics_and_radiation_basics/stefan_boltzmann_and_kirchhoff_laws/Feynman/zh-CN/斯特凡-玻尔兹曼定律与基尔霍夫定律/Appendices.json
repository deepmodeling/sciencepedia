{
    "hands_on_practices": [
        {
            "introduction": "掌握斯特藩-玻尔兹曼定律和基尔霍夫定律的精髓，首先要能从第一性原理出发，构建和求解简化的物理模型。本练习  将引导您推导两个无限大平行平面之间的净长波辐射交换，这是一个在辐射传输理论中具有典范意义的构型。通过这个推导，您将深刻理解发射率、反射率和温度如何共同决定了表面间的能量平衡。",
            "id": "4094485",
            "problem": "考虑一个与数值天气预报(NWP)和气候模拟相关的典型双表面长波辐射交换配置：两个平行、无限、平面、漫-灰、不透明的表面，由一个非参与性间隙（中间介质中无发射、吸收或散射）隔开。令下表面代表发射率为 $\\epsilon_{1}$、热力学温度为 $T_{1}$ 的陆地或海洋，上表面代表发射率为 $\\epsilon_{2}$、热力学温度为 $T_{2}$ 的层状云底。该几何结构意味着角系数为1，因此 $F_{12}=1$。\n\n仅使用适用于辐射传输的第一性原理（能量守恒、源于光谱积分的黑体辐射行为，以及阐明不透明表面发射率等于吸收率的 Kirchhoff 热辐射定律），从头推导从下表面到上表面的单位面积净长波辐射热通量的闭式解析表达式。采用符号约定，正通量方向为从下表面（$T_{1}$, $\\epsilon_{1}$）指向上表面（$T_{2}$, $\\epsilon_{2}$）。将最终答案表示为 $\\epsilon_{1}$、$\\epsilon_{2}$、$T_{1}$、$T_{2}$ 和 Stefan–Boltzmann 常数 $\\sigma$ 的函数。你的最终答案必须是单一的闭式表达式。如果你选择在其他情境下对推导出的表达式进行数值解释，相应的物理单位将是 $\\mathrm{W\\,m^{-2}}$，但本任务不要求进行数值计算或四舍五入。",
            "solution": "该问题已经过验证，被认为是有效的。这是一个辐射传热学中的标准、适定问题，基于基本物理原理，没有歧义或矛盾。因此，我们可以开始推导。\n\n目标是推导从下表面（表面1）到上表面（表面2）的单位面积净长波辐射热通量，记为 $q_{12}$。符号约定规定正通量从表面1指向表面2。推导将按要求基于第一性原理进行。\n\n令 $J_i$ 为表面 $i$ 的辐射度，定义为单位面积离开表面的总辐射能量。令 $G_i$ 为表面 $i$ 的辐照度，定义为单位面积入射到表面的总辐射能量。对于不透明的漫-灰表面，辐射度是发射能量和反射的入射能量之和：\n$$J_i = E_i + \\rho_i G_i$$\n其中 $E_i$ 是表面 $i$ 的发射功率，$\\rho_i$ 是其反射率。\n\n根据 Stefan-Boltzmann 定律，灰体的发射功率由下式给出：\n$$E_i = \\epsilon_i \\sigma T_i^4$$\n其中 $\\epsilon_i$ 是表面 $i$ 的发射率，$T_i$ 是其绝对热力学温度，$\\sigma$ 是 Stefan-Boltzmann 常数。\n\n根据 Kirchhoff 热辐射定律，对于处于热平衡状态的表面，其发射率 $\\epsilon_i$ 等于其吸收率 $\\alpha_i$。对于不透明表面，吸收率和反射率之和为1，即 $\\alpha_i + \\rho_i = 1$。结合这些原理，我们可以用发射率来表示反射率：\n$$\\rho_i = 1 - \\alpha_i = 1 - \\epsilon_i$$\n\n将 $E_i$ 和 $\\rho_i$ 的表达式代入辐射度方程，我们得到两个表面的辐射度：\n对于表面1：\n$$J_1 = \\epsilon_1 \\sigma T_1^4 + (1 - \\epsilon_1) G_1 \\quad (1)$$\n对于表面2：\n$$J_2 = \\epsilon_2 \\sigma T_2^4 + (1 - \\epsilon_2) G_2 \\quad (2)$$\n\n接下来，我们将一个表面的辐照度与另一个表面的辐射度联系起来。问题陈述表面是无限且平行的。这种几何配置意味着离开一个表面的所有辐射都必须被另一个表面截获。用辐射传热的术语来说，从表面1到表面2的角系数 $F_{12}$ 为1。根据相互关系 $A_1 F_{12} = A_2 F_{21}$，并且由于面积是无限的（或者我们考虑相等的单位面积，$A_1 = A_2$），我们也有 $F_{21} = 1$。\n\n表面1上的辐照度 $G_1$ 是离开表面2并到达表面1的辐射能量。这由 $G_1 = J_2 F_{21}$ 给出。由于 $F_{21} = 1$，我们有：\n$$G_1 = J_2$$\n类似地，表面2上的辐照度 $G_2$ 是离开表面1并到达表面2的辐射能量。这由 $G_2 = J_1 F_{12}$ 给出。由于 $F_{12} = 1$，我们有：\n$$G_2 = J_1$$\n\n现在我们可以将这些几何关系代回辐射度方程 $(1)$ 和 $(2)$：\n$$J_1 = \\epsilon_1 \\sigma T_1^4 + (1 - \\epsilon_1) J_2 \\quad (3)$$\n$$J_2 = \\epsilon_2 \\sigma T_2^4 + (1 - \\epsilon_2) J_1 \\quad (4)$$\n方程 $(3)$ 和 $(4)$ 构成了一个关于两个未知辐射度 $J_1$ 和 $J_2$ 的二元线性代数方程组。\n\n离开表面的单位面积净辐射热通量是其辐射度（离开的能量）与辐照度（到达的能量）之差。对于表面1，净通量为 $q_1 = J_1 - G_1$。使用关系式 $G_1 = J_2$，我们得到 $q_1 = J_1 - J_2$。根据我们的符号约定，从表面1到表面2的净通量 $q_{12}$ 正是这个量：\n$$q_{12} = J_1 - J_2$$\n为了求得 $q_{12}$，我们必须求解关于 $J_1$ 和 $J_2$ 的方程组。我们可以将方程 $(4)$ 代入方程 $(3)$：\n$$J_1 = \\epsilon_1 \\sigma T_1^4 + (1 - \\epsilon_1) \\left[ \\epsilon_2 \\sigma T_2^4 + (1 - \\epsilon_2) J_1 \\right]$$\n$$J_1 = \\epsilon_1 \\sigma T_1^4 + (1 - \\epsilon_1)\\epsilon_2 \\sigma T_2^4 + (1 - \\epsilon_1)(1 - \\epsilon_2) J_1$$\n现在，我们合并包含 $J_1$ 的项：\n$$J_1 \\left[ 1 - (1 - \\epsilon_1)(1 - \\epsilon_2) \\right] = \\epsilon_1 \\sigma T_1^4 + (1 - \\epsilon_1)\\epsilon_2 \\sigma T_2^4$$\n方括号中的项化简为：\n$$1 - (1 - \\epsilon_1 - \\epsilon_2 + \\epsilon_1 \\epsilon_2) = \\epsilon_1 + \\epsilon_2 - \\epsilon_1 \\epsilon_2$$\n所以，我们可以解出 $J_1$：\n$$J_1 = \\frac{\\epsilon_1 \\sigma T_1^4 + (1 - \\epsilon_1)\\epsilon_2 \\sigma T_2^4}{\\epsilon_1 + \\epsilon_2 - \\epsilon_1 \\epsilon_2}$$\n根据对称性（交换下标1和2），我们可以写出 $J_2$ 的表达式：\n$$J_2 = \\frac{\\epsilon_2 \\sigma T_2^4 + (1 - \\epsilon_2)\\epsilon_1 \\sigma T_1^4}{\\epsilon_2 + \\epsilon_1 - \\epsilon_2 \\epsilon_1}$$\n现在我们计算净通量 $q_{12} = J_1 - J_2$：\n$$q_{12} = \\frac{1}{\\epsilon_1 + \\epsilon_2 - \\epsilon_1 \\epsilon_2} \\left[ (\\epsilon_1 \\sigma T_1^4 + \\epsilon_2(1-\\epsilon_1)\\sigma T_2^4) - (\\epsilon_2 \\sigma T_2^4 + \\epsilon_1(1-\\epsilon_2)\\sigma T_1^4) \\right]$$\n让我们展开括号内的项：\n$$ \\epsilon_1 \\sigma T_1^4 + \\epsilon_2 \\sigma T_2^4 - \\epsilon_1 \\epsilon_2 \\sigma T_2^4 - \\epsilon_2 \\sigma T_2^4 - \\epsilon_1 \\sigma T_1^4 + \\epsilon_1 \\epsilon_2 \\sigma T_1^4 $$\n项 $\\epsilon_1 \\sigma T_1^4$ 和 $\\epsilon_2 \\sigma T_2^4$ 相互抵消，剩下：\n$$ \\epsilon_1 \\epsilon_2 \\sigma (T_1^4 - T_2^4) $$\n将此结果代回 $q_{12}$ 的表达式中：\n$$q_{12} = \\frac{\\epsilon_1 \\epsilon_2 \\sigma (T_1^4 - T_2^4)}{\\epsilon_1 + \\epsilon_2 - \\epsilon_1 \\epsilon_2}$$\n这是一个正确的闭式表达式。然而，通过将分子和分母同除以乘积 $\\epsilon_1 \\epsilon_2$，可以将其重新整理成更常规的形式：\n$$q_{12} = \\frac{\\sigma (T_1^4 - T_2^4)}{\\frac{\\epsilon_1 + \\epsilon_2 - \\epsilon_1 \\epsilon_2}{\\epsilon_1 \\epsilon_2}}$$\n$$q_{12} = \\frac{\\sigma (T_1^4 - T_2^4)}{\\frac{\\epsilon_1}{\\epsilon_1 \\epsilon_2} + \\frac{\\epsilon_2}{\\epsilon_1 \\epsilon_2} - \\frac{\\epsilon_1 \\epsilon_2}{\\epsilon_1 \\epsilon_2}}$$\n$$q_{12} = \\frac{\\sigma (T_1^4 - T_2^4)}{\\frac{1}{\\epsilon_2} + \\frac{1}{\\epsilon_1} - 1}$$\n这个最终形式巧妙地将依赖于温度的黑体交换项 $\\sigma (T_1^4 - T_2^4)$ 与一个解释表面非理想（灰体）性质的因子分离开来。",
            "answer": "$$\\boxed{\\frac{\\sigma (T_1^4 - T_2^4)}{\\frac{1}{\\epsilon_1} + \\frac{1}{\\epsilon_2} - 1}}$$"
        },
        {
            "introduction": "理论模型的解析解是理解物理过程的基石，但在实际的数值天气预报和气候模型中，我们必须处理离散化的光谱和有限的波段。本练习  要求您通过数值积分普朗克函数，来计算在重要的 $8$–$12\\,\\mu\\mathrm{m}$ 大气窗口内黑体辐射通量的占比。这项实践不仅能锻炼您的编程和数值计算能力，还能让您具体地体会到地球长波辐射是如何通过特定“窗口”逃逸到太空的。",
            "id": "4094506",
            "problem": "考虑一个热发射表面，其行为类似于温度为 $T$ 的黑体。在数值天气预报和气候模型中，跨越 $8$–$12\\,\\mu\\mathrm{m}$ 的长波大气窗口在调节出射长波辐射方面起着核心作用。其基本依据是 Planck 关于单位波长、单位立体角的光谱辐射度的定律，\n$$\nB_{\\lambda}(T) = \\frac{2 h c^2}{\\lambda^5}\\,\\frac{1}{\\exp\\!\\left(\\frac{h c}{\\lambda k_{\\mathrm{B}} T}\\right) - 1},\n$$\n其中 $h$ 是 Planck 常数，$c$ 是光速，$k_{\\mathrm{B}}$ 是 Boltzmann 常数，$\\lambda$ 是波长。对于一个漫射（Lambertian）发射体，其半球光谱出射度（发射功率）为\n$$\nM_{\\lambda}(T) = \\pi\\,B_{\\lambda}(T).\n$$\n在所有波长上积分的总发射通量为\n$$\nM(T) = \\int_{0}^{\\infty} M_{\\lambda}(T)\\,\\mathrm{d}\\lambda,\n$$\n而在窗口 $[\\lambda_1,\\lambda_2]$ 内的带限发射通量为\n$$\nM_{[\\lambda_1,\\lambda_2]}(T) = \\int_{\\lambda_1}^{\\lambda_2} M_{\\lambda}(T)\\,\\mathrm{d}\\lambda.\n$$\n将在温度 $T$ 时，发射到窗口 $[\\lambda_1,\\lambda_2]$ 内的总黑体通量的分数定义为\n$$\nF(\\lambda_1,\\lambda_2;T) = \\frac{M_{[\\lambda_1,\\lambda_2]}(T)}{M(T)}.\n$$\nKirchhoff 热辐射定律指出，对于处于局部热力学平衡的物体，其光谱发射率等于光谱吸收率。对于黑体，其在所有波长上的光谱发射率均为 1，因此 $M_{\\lambda}(T)$ 完全表征了其发射特性。\n\n您的任务是编写一个完整、可运行的程序，通过对 Planck 光谱在波段 $[\\lambda_1,\\lambda_2]$ 上进行数值积分，并用在 $[0,\\infty)$ 上数值积分得到的总通量进行归一化，来计算 $F(\\lambda_1,\\lambda_2;T)$。所有计算都必须使用国际单位制定义的常数 $h$、$c$ 和 $k_{\\mathrm{B}}$。分数 $F(\\lambda_1,\\lambda_2;T)$ 是无量纲的，因此输出中不需要物理单位。下面测试套件中的波长输入以微米为单位，必须在程序内部正确转换为米。此计算中不涉及角度。\n\n实现该程序以评估以下测试套件：\n1. $T = 300\\,\\mathrm{K}$，$\\lambda_1 = 8\\,\\mu\\mathrm{m}$，$\\lambda_2 = 12\\,\\mu\\mathrm{m}$。\n2. $T = 300\\,\\mathrm{K}$，$\\lambda_1 = 0.1\\,\\mu\\mathrm{m}$，$\\lambda_2 = 1000\\,\\mu\\mathrm{m}$。\n3. $T = 200\\,\\mathrm{K}$，$\\lambda_1 = 8\\,\\mu\\mathrm{m}$，$\\lambda_2 = 12\\,\\mu\\mathrm{m}$。\n4. $T = 1000\\,\\mathrm{K}$，$\\lambda_1 = 8\\,\\mu\\mathrm{m}$，$\\lambda_2 = 12\\,\\mu\\mathrm{m}$。\n5. $T = 300\\,\\mathrm{K}$，$\\lambda_1 = 9.5\\,\\mu\\mathrm{m}$，$\\lambda_2 = 10.0\\,\\mu\\mathrm{m}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，每个分数都四舍五入到十位小数，例如，“[0.1234567890,0.9876543210,...]”。输出必须是无量纲的小数。\n\n确保分母中半无限积分的数值稳定性和准确性。该算法应具有通用性和原则性，不依赖于经验拟合的快捷方式或预制表格值。",
            "solution": "在尝试解决方案之前，需要对问题进行验证。\n\n### 第一步：提取已知条件\n\n- **Planck 光谱辐射度定律**：\n$$\nB_{\\lambda}(T) = \\frac{2 h c^2}{\\lambda^5}\\,\\frac{1}{\\exp\\!\\left(\\frac{h c}{\\lambda k_{\\mathrm{B}} T}\\right) - 1}\n$$\n- **Lambertian 发射体的半球光谱出射度**：\n$$\nM_{\\lambda}(T) = \\pi\\,B_{\\lambda}(T)\n$$\n- **总发射通量**：\n$$\nM(T) = \\int_{0}^{\\infty} M_{\\lambda}(T)\\,\\mathrm{d}\\lambda\n$$\n- **带限发射通量**：\n$$\nM_{[\\lambda_1,\\lambda_2]}(T) = \\int_{\\lambda_1}^{\\lambda_2} M_{\\lambda}(T)\\,\\mathrm{d}\\lambda\n$$\n- **波长窗口内的总通量分数**：\n$$\nF(\\lambda_1,\\lambda_2;T) = \\frac{M_{[\\lambda_1,\\lambda_2]}(T)}{M(T)}\n$$\n- **常数**：$h$（Planck 常数）、$c$（光速）、$k_{\\mathrm{B}}$（Boltzmann 常数）将按照国际单位制（SI）的定义使用。\n- **任务**：通过对 Planck 光谱进行数值积分来计算 $F(\\lambda_1,\\lambda_2;T)$。\n- **输入数据格式**：波长（$\\lambda_1, \\lambda_2$）以微米（$\\mu\\mathrm{m}$）为单位提供。\n- **测试套件**：\n    1. $T = 300\\,\\mathrm{K}$，$\\lambda_1 = 8\\,\\mu\\mathrm{m}$，$\\lambda_2 = 12\\,\\mu\\mathrm{m}$。\n    2. $T = 300\\,\\mathrm{K}$，$\\lambda_1 = 0.1\\,\\mu\\mathrm{m}$，$\\lambda_2 = 1000\\,\\mu\\mathrm{m}$。\n    3. $T = 200\\,\\mathrm{K}$，$\\lambda_1 = 8\\,\\mu\\mathrm{m}$，$\\lambda_2 = 12\\,\\mu\\mathrm{m}$。\n    4. $T = 1000\\,\\mathrm{K}$，$\\lambda_1 = 8\\,\\mu\\mathrm{m}$，$\\lambda_2 = 12\\,\\mu\\mathrm{m}$。\n    5. $T = 300\\,\\mathrm{K}$，$\\lambda_1 = 9.5\\,\\mu\\mathrm{m}$，$\\lambda_2 = 10.0\\,\\mu\\mathrm{m}$。\n\n### 第二步：使用提取的已知条件进行验证\n\n- **科学依据**：该问题基于 Planck 的黑体辐射定律，这是量子物理学中一个基本的、经实验验证的原理。其在大气科学中的应用是标准化的。该问题在科学上是合理的。\n- **适定性**：该问题明确定义了待计算量 $F(\\lambda_1,\\lambda_2;T)$，即两个定积分之比。被积函数是一个性态良好的物理函数，积分域也已指定。测试用例所需的所有参数都已提供。每个测试用例都存在唯一的数值解。\n- **客观性**：该问题以精确的数学和物理术语陈述，没有任何主观性或歧义。\n\n该问题未表现出验证清单中列出的任何缺陷。这是一个定义明确的计算物理问题。\n\n### 第三步：结论与行动\n\n问题**有效**。将着手开发解决方案。\n\n### 解决方案\n\n目标是计算落在光谱带 $[\\lambda_1, \\lambda_2]$ 内的总黑体发射功率的分数 $F(\\lambda_1,\\lambda_2;T)$。该分数定义为：\n$$\nF(\\lambda_1,\\lambda_2;T) = \\frac{\\int_{\\lambda_1}^{\\lambda_2} M_{\\lambda}(T)\\,\\mathrm{d}\\lambda}{\\int_{0}^{\\infty} M_{\\lambda}(T)\\,\\mathrm{d}\\lambda}\n$$\n代入 $M_{\\lambda}(T) = \\pi B_{\\lambda}(T)$ 的表达式可得：\n$$\nF(\\lambda_1,\\lambda_2;T) = \\frac{\\int_{\\lambda_1}^{\\lambda_2} \\pi \\frac{2 h c^2}{\\lambda^5}\\,\\frac{1}{\\exp\\left(\\frac{h c}{\\lambda k_{\\mathrm{B}} T}\\right) - 1} \\,\\mathrm{d}\\lambda}{\\int_{0}^{\\infty} \\pi \\frac{2 h c^2}{\\lambda^5}\\,\\frac{1}{\\exp\\left(\\frac{h c}{\\lambda k_{\\mathrm{B}} T}\\right) - 1} \\,\\mathrm{d}\\lambda}\n$$\n常数前置因子 $2 \\pi h c^2$ 同时存在于分子和分母中，因此可以消去。表达式简化为：\n$$\nF(\\lambda_1,\\lambda_2;T) = \\frac{\\int_{\\lambda_1}^{\\lambda_2} \\frac{1}{\\lambda^5} \\frac{1}{\\exp\\left(\\frac{hc}{\\lambda k_{\\mathrm{B}} T}\\right)-1} \\mathrm{d}\\lambda}{\\int_{0}^{\\infty} \\frac{1}{\\lambda^5} \\frac{1}{\\exp\\left(\\frac{hc}{\\lambda k_{\\mathrm{B}} T}\\right)-1} \\mathrm{d}\\lambda}\n$$\n为了使积分更便于数值计算，我们进行变量替换。设 $x$ 为无量纲量：\n$$\nx = \\frac{hc}{\\lambda k_{\\mathrm{B}} T}\n$$\n由此，我们推导出 $\\lambda$ 及其微分 $\\mathrm{d}\\lambda$ 的表达式：\n$$\n\\lambda = \\frac{hc}{x k_{\\mathrm{B}} T} \\implies \\mathrm{d}\\lambda = -\\frac{hc}{x^2 k_{\\mathrm{B}} T} \\mathrm{d}x\n$$\n积分限也相应变换：\n- 当 $\\lambda \\to \\lambda_1$ 时, $x \\to x_1 = \\frac{hc}{\\lambda_1 k_{\\mathrm{B}} T}$。\n- 当 $\\lambda \\to \\lambda_2$ 时, $x \\to x_2 = \\frac{hc}{\\lambda_2 k_{\\mathrm{B}} T}$。\n- 当 $\\lambda \\to 0$ 时, $x \\to \\infty$。\n- 当 $\\lambda \\to \\infty$ 时, $x \\to 0$。\n\n将这些代入被积项 $\\frac{\\mathrm{d}\\lambda}{\\lambda^5}$ 中：\n$$\n\\frac{\\mathrm{d}\\lambda}{\\lambda^5} = \\frac{-\\frac{hc}{x^2 k_{\\mathrm{B}} T} \\mathrm{d}x}{\\left(\\frac{hc}{x k_{\\mathrm{B}} T}\\right)^5} = -\\left(\\frac{k_{\\mathrm{B}} T}{hc}\\right)^4 x^3 \\mathrm{d}x\n$$\n现在可以用 $x$ 重写积分。分子中的带限积分变为：\n$$\n\\int_{\\lambda_1}^{\\lambda_2} \\dots = \\int_{x_1}^{x_2} \\frac{1}{\\exp(x)-1} \\left[-\\left(\\frac{k_{\\mathrm{B}} T}{hc}\\right)^4 x^3\\right] \\mathrm{d}x = \\left(\\frac{k_{\\mathrm{B}} T}{hc}\\right)^4 \\int_{x_2}^{x_1} \\frac{x^3}{\\exp(x)-1} \\mathrm{d}x\n$$\n请注意，由于 $\\lambda_1  \\lambda_2$，我们有 $x_1 > x_2$，因此积分区间 $[x_2, x_1]$ 的顺序是正确的。\n分母中的总积分变为：\n$$\n\\int_{0}^{\\infty} \\dots = \\int_{\\infty}^{0} \\frac{1}{\\exp(x)-1} \\left[-\\left(\\frac{k_{\\mathrm{B}} T}{hc}\\right)^4 x^3\\right] \\mathrm{d}x = \\left(\\frac{k_{\\mathrm{B}} T}{hc}\\right)^4 \\int_{0}^{\\infty} \\frac{x^3}{\\exp(x)-1} \\mathrm{d}x\n$$\n常数因子 $\\left(\\frac{k_{\\mathrm{B}} T}{hc}\\right)^4$ 再次从分数中消去，得到最终的简洁形式：\n$$\nF(\\lambda_1,\\lambda_2;T) = \\frac{\\int_{x_2}^{x_1} \\frac{x^3}{\\exp(x)-1} \\mathrm{d}x}{\\int_{0}^{\\infty} \\frac{x^3}{\\exp(x)-1} \\mathrm{d}x}\n$$\n问题陈述要求总通量（分母）通过数值方法计算。设被积函数为 $g(x) = \\frac{x^3}{\\exp(x)-1}$。因此，任务简化为计算两个数值积分之比：\n$$\nF(\\lambda_1,\\lambda_2;T) = \\frac{\\int_{x_2}^{x_1} g(x) \\mathrm{d}x}{\\int_{0}^{\\infty} g(x) \\mathrm{d}x}\n$$\n分母与 Riemann zeta 函数有关，其解析解已知为 $\\int_{0}^{\\infty} g(x) \\mathrm{d}x = \\frac{\\pi^4}{15}$。我们将按照指示对其进行数值计算，并使用该值对所有测试用例进行归一化。`scipy.integrate.quad` 函数适用于这些高精度的数值积分。为了保证数值稳定性，特别是对于较小的 $x$ 值，最好使用 `numpy.expm1(x)` 来计算 $\\exp(x)-1$ 项。\n\n算法如下：\n1.  从 `scipy.constants` 模块中定义通用物理常数 $h$、$c$ 和 $k_{\\mathrm{B}}$。\n2.  定义函数 $g(x) = x^3/(\\exp(x)-1)$。\n3.  使用 `scipy.integrate.quad` 一次性计算分母积分的值 $I_{total} = \\int_{0}^{\\infty} g(x) \\mathrm{d}x$。\n4.  对于每个测试用例 $(T, \\lambda_1, \\lambda_2)$：\n    a. 通过乘以 $10^{-6}$ 将输入波长 $\\lambda_1, \\lambda_2$ 从微米转换为国际单位制（米）。\n    b. 计算无量纲积分限 $x_1 = \\frac{hc}{\\lambda_1 k_{\\mathrm{B}} T}$ 和 $x_2 = \\frac{hc}{\\lambda_2 k_{\\mathrm{B}} T}$。\n    c. 使用 `scipy.integrate.quad` 计算分子积分 $I_{band} = \\int_{x_2}^{x_1} g(x) \\mathrm{d}x$。\n    d. 计算分数 $F = I_{band} / I_{total}$。\n5.  收集结果，将其格式化为十位小数，并按照指定的输出格式打印。\n此过程稳健、遵循科学原理，并直接实现了问题的要求。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\nfrom scipy import constants\n\ndef solve():\n    \"\"\"\n    Computes the fraction of total blackbody flux emitted into a specified\n    wavelength window for several test cases.\n    \"\"\"\n    # Define physical constants from the International System of Units (SI).\n    h = constants.h      # Planck constant (J s)\n    c = constants.c      # Speed of light in vacuum (m/s)\n    k_B = constants.k    # Boltzmann constant (J/K)\n\n    # Define the integrand g(x) = x^3 / (e^x - 1) after the change of variables.\n    # The change of variables x = hc / (lambda * k_B * T) makes the integral\n    # dimensionless and numerically stable.\n    def g(x):\n        \"\"\"\n        The integrand for the dimensionless form of Planck's law.\n        Uses np.expm1(x) for numerical precision when x is close to zero.\n        \"\"\"\n        # The limit of g(x) as x -> 0 is 0. Explicitly handle this case to avoid\n        # potential division by zero if quad samples x=0.\n        if x == 0:\n            return 0.0\n        return x**3 / np.expm1(x)\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (T in Kelvin, lambda_1 in micrometers, lambda_2 in micrometers).\n    test_cases = [\n        (300.0, 8.0, 12.0),\n        (300.0, 0.1, 1000.0),\n        (200.0, 8.0, 12.0),\n        (1000.0, 8.0, 12.0),\n        (300.0, 9.5, 10.0),\n    ]\n\n    results = []\n\n    # Per the problem, we normalize by the numerically integrated total flux.\n    # This integral is constant, so we compute it once.\n    # The analytical value is pi^4 / 15. The numerical integration should be very close.\n    I_total, _ = quad(g, 0, np.inf)\n\n    # Pre-calculate the constant factor for the change of variables.\n    const_factor = (h * c) / k_B\n\n    for T, lam1_um, lam2_um in test_cases:\n        # Convert wavelengths from micrometers to meters (SI units).\n        lam1_m = lam1_um * 1e-6\n        lam2_m = lam2_um * 1e-6\n\n        # Calculate the dimensionless integration limits x1 and x2.\n        # Note that since lam1  lam2, we will have x1 > x2.\n        # The integration is correctly performed from x2 to x1.\n        x1 = const_factor / (lam1_m * T)\n        x2 = const_factor / (lam2_m * T)\n\n        # Numerically compute the band-limited integral.\n        I_band, _ = quad(g, x2, x1)\n\n        # Calculate the fraction F by normalizing with the total integral.\n        F = I_band / I_total\n\n        # Append the result, formatted to 10 decimal places.\n        results.append(f\"{F:.10f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "真实地表既非理想黑体，其发射率也常常随波长变化，这为辐射通量的精确计算带来了挑战。本练习  将引导您研究一个更为接近现实的场景：水体的光谱发射率，并量化在计算大气窗口波段辐射通量时，采用“灰体”这一简化假设所引入的误差。通过这项分析，您将学会评估模型简化所带来的不确定性，这是发展和改进气候模型过程中一项至关重要的技能。",
            "id": "4094481",
            "problem": "考虑一个水面，在各向同性发射和局地热力学平衡的假设下，向半球空间发射热辐射。该问题基于数值天气预报（NWP）和气候模拟中使用的辐射传输基本原理，特别依赖于Planck的黑体辐射定律和Kirchhoff的热辐射定律。目标是评估在温度$T=300\\,\\mathrm{K}$时，对于$8$–$14\\,\\mu\\mathrm{m}$大气窗口波段内的水体，假设其具有一个与波长无关的灰体发射率所引入的误差，并量化该误差对波段限制的长波通量的影响。您必须从第一性原理出发，推导并实现波段积分的半球辐射出射度，并在几种科学上合理的情景中，计算由灰体发射率近似引起的误差。\n\n使用以下基本原理：\n\n- 温度为 $T$ 的黑体的光谱辐射亮度由Planck定律给出，表示为 $B_{\\lambda}(T)$，其中变量 $\\lambda$ 表示波长。\n- 对于漫射体，Lambert余弦定律意味着光谱辐射亮度与光谱半球辐射出射度之间存在关系，后者记作 $M_{\\lambda}(T)$。\n- Kirchhoff热辐射定律指出，对于处于局地热力学平衡状态的不透明表面，光谱发射率等于光谱吸收率，并通过对每个 $\\lambda$ 处的黑体发射进行乘法加权来决定发射功率。\n\n基于这些原理，将区间 $\\lambda \\in [8\\,\\mu\\mathrm{m},14\\,\\mu\\mathrm{m}]$ 内的波段限制半球辐射出射度，表示为光谱发射率与黑体光谱出射度的乘积在波长上的积分。灰体发射率近似假设在整个波段内发射率 $\\varepsilon_{\\mathrm{grey}}$ 为一个常数，并产生一个不同的波段积分通量。定义并计算灰体近似与光谱分辨计算之间的绝对误差 $\\Delta F$ 和相对误差 $r$。绝对误差必须以 $\\mathrm{W}\\,\\mathrm{m}^{-2}$ 为单位表示，相对误差必须以小数形式表示。\n\n在您的程序中实现以下数学定义和要求：\n\n- 令 $B_{\\lambda}(T)$ 表示黑体的光谱辐射亮度。令 $M_{\\lambda}(T)$ 表示光谱半球辐射出射度。使用Planck定律的相应物理常数以及从 $B_{\\lambda}(T)$ 到 $M_{\\lambda}(T)$ 的辐射度转换关系。\n- 令 $\\varepsilon(\\lambda)$ 表示水的光谱发射率。真实的波段限制半球辐射出射度为\n$$F_{\\mathrm{true}}(T) = \\int_{\\lambda_1}^{\\lambda_2} \\varepsilon(\\lambda)\\,M_{\\lambda}(T)\\,\\mathrm{d}\\lambda,$$\n其中 $\\lambda_1=8\\,\\mu\\mathrm{m}$ 且 $\\lambda_2=14\\,\\mu\\mathrm{m}$。\n- 灰体发射率的波段限制半球辐射出射度为\n$$F_{\\mathrm{grey}}(T) = \\varepsilon_{\\mathrm{grey}} \\int_{\\lambda_1}^{\\lambda_2} M_{\\lambda}(T)\\,\\mathrm{d}\\lambda.$$\n- 绝对误差为\n$$\\Delta F = F_{\\mathrm{grey}} - F_{\\mathrm{true}},$$\n以 $\\mathrm{W}\\,\\mathrm{m}^{-2}$ 为单位。\n- 相对误差为\n$$r = \\frac{\\Delta F}{F_{\\mathrm{true}}},$$\n以小数表示。\n\n数值实现要求：\n\n- 使用步长 $\\Delta\\lambda = 0.001\\,\\mu\\mathrm{m}$ 对波长区间 $[8\\,\\mu\\mathrm{m},14\\,\\mu\\mathrm{m}]$ 进行均匀离散化，并通过梯形法则进行数值积分。在所有辐射度表达式中将 $\\lambda$ 转换为 $\\mathrm{m}$ 以确保单位一致性。最终答案 $F_{\\mathrm{true}}$、$F_{\\mathrm{grey}}$ 和 $\\Delta F$ 必须以 $\\mathrm{W}\\,\\mathrm{m}^{-2}$ 为单位，$r$ 必须是无量纲的。\n- 通过在指定节点 $\\{(\\lambda_i,\\varepsilon_i)\\}$（其中 $\\lambda_i$ 单位为 $\\mu\\mathrm{m}$，$\\varepsilon_i$ 无量纲）上进行分段线性插值来定义 $\\varepsilon(\\lambda)$。在节点之间使用线性插值；在节点范围之外不要进行外插（在此问题中，所有节点覆盖了整个波段）。\n- 使用以下参数值测试套件，这些值涵盖了热红外波段水面发射率的典型和边缘情况行为：\n    - 情况 $1$（代表性水体）：节点 $\\{(8,0.965),(9.5,0.980),(10,0.985),(11.5,0.980),(12.5,0.975),(14,0.980)\\}$，$\\varepsilon_{\\mathrm{grey}}=0.980$。\n    - 情况 $2$（海沫，高发射率）：节点 $\\{(8,0.985),(10,0.990),(12,0.988),(14,0.989)\\}$，$\\varepsilon_{\\mathrm{grey}}=0.980$。\n    - 情况 $3$（镜面水，低发射率）：节点 $\\{(8,0.950),(9.5,0.960),(10.5,0.967),(12.5,0.955),(14,0.960)\\}$，$\\varepsilon_{\\mathrm{grey}}=0.980$。\n    - 情况 $4$（用于自洽性的Planck加权灰体发射率）：使用与情况 $1$ 相同的节点，并将 $\\varepsilon_{\\mathrm{grey}}$ 设置为 $\\varepsilon(\\lambda)$ 的Planck加权波段平均值，即：\n    $$\\varepsilon_{\\mathrm{grey}}^{\\star} = \\frac{\\int_{\\lambda_1}^{\\lambda_2} \\varepsilon(\\lambda)\\,M_{\\lambda}(T)\\,\\mathrm{d}\\lambda}{\\int_{\\lambda_1}^{\\lambda_2} M_{\\lambda}(T)\\,\\mathrm{d}\\lambda}.$$\n    此情况旨在评估当灰体近似值针对该波段进行调优时的极限行为，此时误差最小。\n- 对所有情况均使用 $T=300\\,\\mathrm{K}$。\n\n您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。每个测试用例的结果必须是包含两个浮点数 $[\\Delta F,r]$ 的列表，并按上述情况的顺序排列。要求的最终输出格式为\n$$[[\\Delta F_1,r_1],[\\Delta F_2,r_2],[\\Delta F_3,r_3],[\\Delta F_4,r_4]],$$\n其中 $\\Delta F_i$ 的单位是 $\\mathrm{W}\\,\\mathrm{m}^{-2}$，$r_i$ 是无量纲的，对于 $i=1,2,3,4$。",
            "solution": "该问题在科学和数学上是适定的，提供了进行完整分析所需的所有必要定义、常数和数据。它基于辐射传输的基本原理，包括Planck定律、Lambert定律和Kirchhoff定律，并将这些原理应用于大气科学和遥感领域的一个标准问题——水面热发射的计算。问题的前提在物理上是现实的，并且数值要求也已明确规定。因此，该问题是有效的，可以构建解决方案。\n\n该解决方案框架是根据热辐射物理学和数值分析的第一性原理构建的。\n\n**1. 基本辐射量**\n\n热辐射的基础是Planck定律，该定律描述了黑体在绝对温度 $T$ 下的光谱辐射亮度 $B_{\\lambda}(T)$ 作为波长 $\\lambda$ 的函数。辐射亮度是每单位面积、每单位立体角、每单位波长发射的功率。$B_{\\lambda}(T)$ 的表达式为：\n$$\nB_{\\lambda}(T) = \\frac{2hc^2}{\\lambda^5} \\frac{1}{e^{\\frac{hc}{\\lambda k_B T}} - 1}\n$$\n其中 $h$ 是普朗克常数，$c$ 是真空中光速，$k_B$ 是玻尔兹曼常数。$B_{\\lambda}(T)$ 的单位是 $\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mathrm{m}^{-1}$。\n\n对于包括水在内的许多自然表面，其发射近似为漫射或朗伯体。这意味着在表面上方的半球空间内，辐射亮度在所有方向上是均匀的。对于朗伯发射体，光谱半球辐射出射度 $M_{\\lambda}(T)$（即从单位面积辐射到半球空间内的每单位波长的总功率）与光谱辐射亮度之间通过一个因子 $\\pi$ 相关联：\n$$\nM_{\\lambda}(T) = \\pi B_{\\lambda}(T) = \\frac{2\\pi hc^2}{\\lambda^5} \\frac{1}{e^{\\frac{hc}{\\lambda k_B T}} - 1}\n$$\n$M_{\\lambda}(T)$ 的单位是 $\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{m}^{-1}$。该量代表了在给定波长和温度下，由理想黑体所定义的最大可能的热发射。\n\n**2. 真实表面（水）的发射**\n\n真实表面不是完美的黑体。它们发射辐射的能力由光谱发射率 $\\varepsilon(\\lambda)$ 描述，这是一个介于0和1之间的无量纲量。根据Kirchhoff热辐射定律，对于处于局地热力学平衡状态的不透明体，其光谱发射率等于其光谱吸收率。因此，真实表面的光谱半球辐射出射度是其光谱发射率与黑体光谱出射度的乘积：\n$$\nM_{\\lambda}^{\\text{real}}(T) = \\varepsilon(\\lambda) M_{\\lambda}(T)\n$$\n\n**3. 波段积分的半球辐射出射度**\n\n在特定光谱波段 $[\\lambda_1, \\lambda_2]$ 内发射的总功率，是通过在该波长区间上对光谱出射度进行积分得到的。对于一个光谱发射率 $\\varepsilon(\\lambda)$ 随光谱变化的表面，其真实的波段限制半球辐射出射度，记作 $F_{\\mathrm{true}}$，为：\n$$\nF_{\\mathrm{true}}(T) = \\int_{\\lambda_1}^{\\lambda_2} \\varepsilon(\\lambda) M_{\\lambda}(T) \\, \\mathrm{d}\\lambda\n$$\n在此问题中，该波段被指定为 $\\lambda_1 = 8\\,\\mu\\mathrm{m}$ 和 $\\lambda_2 = 14\\,\\mu\\mathrm{m}$。\n\n**4. 灰体发射率近似**\n\n在许多实际应用中，假设发射率在感兴趣的光谱波段内是恒定的会很方便。这个恒定值被称为灰体发射率，$\\varepsilon_{\\mathrm{grey}}$。在此近似下，波段限制的半球辐射出射度 $F_{\\mathrm{grey}}$ 计算如下：\n$$\nF_{\\mathrm{grey}}(T) = \\varepsilon_{\\mathrm{grey}} \\int_{\\lambda_1}^{\\lambda_2} M_{\\lambda}(T) \\, \\mathrm{d}\\lambda\n$$\n这种近似简化了计算，但引入了误差，本问题要求我们量化这个误差。\n\n**5. 误差量化**\n\n由灰体发射率近似产生的误差通过以下两个指标进行评估：\n- 绝对误差 $\\Delta F$ 是近似通量与真实通量之间的差值：\n$$\n\\Delta F = F_{\\mathrm{grey}}(T) - F_{\\mathrm{true}}(T)\n$$\n- 相对误差 $r$ 是将绝对误差用真实通量进行归一化：\n$$\nr = \\frac{\\Delta F}{F_{\\mathrm{true}}(T)} = \\frac{F_{\\mathrm{grey}}(T)}{F_{\\mathrm{true}}(T)} - 1\n$$\n\n**6. 数值实现**\n\n为了计算这些积分，我们将采用指定的数值方法。\n- **离散化：** 将波长区间 $[\\lambda_1, \\lambda_2] = [8\\,\\mu\\mathrm{m}, 14\\,\\mu\\mathrm{m}]$ 离散化为一个均匀的波长网格 $\\lambda_j$，步长为 $\\Delta\\lambda = 0.001\\,\\mu\\mathrm{m}$。所有辐射度计算都要求波长单位为米，因此需要执行转换 $\\lambda_j[\\mathrm{m}] = \\lambda_j[\\mu\\mathrm{m}] \\times 10^{-6}$。\n- **插值：** 水的光谱发射率 $\\varepsilon(\\lambda)$ 由一组节点 $\\{(\\lambda_i, \\varepsilon_i)\\}$ 定义。对于我们精细网格上的任何波长 $\\lambda_j$，$\\varepsilon(\\lambda_j)$ 的值通过在给定节点之间进行分段线性插值得到。\n- **积分：** $F_{\\mathrm{true}}$ 的定积分以及 $F_{\\mathrm{grey}}$ 的积分部分使用梯形法则计算，该法则非常适用于精细采样的函数。对于在网格 $\\lambda_j$ 上计算的积分 $\\int_a^b f(\\lambda) \\mathrm{d}\\lambda$，其数值近似为 $\\sum_{j=1}^{N-1} \\frac{1}{2}(f(\\lambda_j) + f(\\lambda_{j+1}))(\\lambda_{j+1} - \\lambda_j)$。\n\n**7. 特殊情况4：Planck加权发射率**\n\n情况4为 $\\varepsilon_{\\mathrm{grey}}$ 引入了一个特殊定义，即Planck加权平均发射率 $\\varepsilon_{\\mathrm{grey}}^{\\star}$：\n$$\n\\varepsilon_{\\mathrm{grey}}^{\\star} = \\frac{\\int_{\\lambda_1}^{\\lambda_2} \\varepsilon(\\lambda) M_{\\lambda}(T) \\, \\mathrm{d}\\lambda}{\\int_{\\lambda_1}^{\\lambda_2} M_{\\lambda}(T) \\, \\mathrm{d}\\lambda}\n$$\n代入 $F_{\\mathrm{true}}$ 的定义，上式可简化为：\n$$\n\\varepsilon_{\\mathrm{grey}}^{\\star} = \\frac{F_{\\mathrm{true}}(T)}{\\int_{\\lambda_1}^{\\lambda_2} M_{\\lambda}(T) \\, \\mathrm{d}\\lambda}\n$$\n此时的灰体通量为 $F_{\\mathrm{grey}}(T) = \\varepsilon_{\\mathrm{grey}}^{\\star} \\int_{\\lambda_1}^{\\lambda_2} M_{\\lambda}(T) \\, \\mathrm{d}\\lambda$。通过代入 $\\varepsilon_{\\mathrm{grey}}^{\\star}$ 的表达式，我们发现 $F_{\\mathrm{grey}}(T) = F_{\\mathrm{true}}(T)$。因此，绝对误差 $\\Delta F$ 和相对误差 $r$ 在计算上应与零无法区分（即，在机器精度的量级上）。这可作为数值实现的内部一致性检查。\n\n以下程序为四个指定情况分别实现了这一逻辑。",
            "answer": "```python\nimport numpy as np\nfrom scipy import constants\n\ndef solve():\n    \"\"\"\n    Calculates the error introduced by the grey emissivity approximation for a water surface.\n    \"\"\"\n    # Physical constants from scipy.constants\n    h = constants.h      # Planck constant (J*s)\n    c = constants.c      # Speed of light (m/s)\n    k_B = constants.k    # Boltzmann constant (J/K)\n\n    # Problem parameters\n    T = 300.0  # Temperature in Kelvin\n    lambda1_um = 8.0   # Start wavelength in micrometers\n    lambda2_um = 14.0  # End wavelength in micrometers\n    d_lambda_um = 0.001 # Wavelength step in micrometers\n\n    # Create the discretized wavelength grid for numerical integration\n    num_points = int(round((lambda2_um - lambda1_um) / d_lambda_um)) + 1\n    lambda_um = np.linspace(lambda1_um, lambda2_um, num_points)\n    lambda_m = lambda_um * 1e-6 # Convert wavelength to meters for physical calculation\n\n    # Calculate blackbody spectral hemispheric exitance M_lambda(T) over the grid\n    # M_lambda(T) = pi * B_lambda(T) = (2 * pi * h * c^2) / (lambda^5 * (exp(h*c / (lambda*k*T)) - 1))\n    # Units: W / m^2 / m\n    exponent_term = (h * c) / (lambda_m * k_B * T)\n    M_lambda_T = (2.0 * np.pi * h * c**2) / (lambda_m**5 * (np.exp(exponent_term) - 1.0))\n\n    # Calculate the band-integrated blackbody exitance, used for the grey approximation\n    # This integral is constant for all cases.\n    M_integral = np.trapz(M_lambda_T, x=lambda_m)\n\n    # Define the test cases as per the problem statement\n    test_cases = [\n        {'id': 1, 'nodes': [(8.0, 0.965), (9.5, 0.980), (10.0, 0.985), (11.5, 0.980), (12.5, 0.975), (14.0, 0.980)], 'eps_grey': 0.980},\n        {'id': 2, 'nodes': [(8.0, 0.985), (10.0, 0.990), (12.0, 0.988), (14.0, 0.989)], 'eps_grey': 0.980},\n        {'id': 3, 'nodes': [(8.0, 0.950), (9.5, 0.960), (10.5, 0.967), (12.5, 0.955), (14.0, 0.960)], 'eps_grey': 0.980},\n        {'id': 4, 'nodes': [(8.0, 0.965), (9.5, 0.980), (10.0, 0.985), (11.5, 0.980), (12.5, 0.975), (14.0, 0.980)], 'eps_grey': 'planck_weighted'}\n    ]\n\n    results = []\n    for case in test_cases:\n        # Extract node data for spectral emissivity interpolation\n        node_lambdas_um = [p[0] for p in case['nodes']]\n        node_epsilons = [p[1] for p in case['nodes']]\n\n        # Perform piecewise-linear interpolation to get emissivity at each grid point\n        epsilon_lambda = np.interp(lambda_um, node_lambdas_um, node_epsilons)\n        \n        # Calculate the true band-limited hemispheric exitance\n        # F_true = integral(epsilon(lambda) * M_lambda(T) * d_lambda)\n        integrand_true = epsilon_lambda * M_lambda_T\n        F_true = np.trapz(integrand_true, x=lambda_m)\n\n        # Determine the grey emissivity value for the current case\n        if case['eps_grey'] == 'planck_weighted':\n            # Case 4: eps_grey is the Planck-weighted average\n            eps_grey = F_true / M_integral\n        else:\n            # Cases 1, 2, 3: eps_grey is a fixed value\n            eps_grey = case['eps_grey']\n\n        # Calculate the grey-body approximation of the band-limited exitance\n        # F_grey = eps_grey * integral(M_lambda(T) * d_lambda)\n        F_grey = eps_grey * M_integral\n\n        # Calculate absolute and relative errors\n        delta_F = F_grey - F_true\n        r = delta_F / F_true if F_true != 0.0 else 0.0\n\n        results.append([delta_F, r])\n\n    # Format the final output string exactly as required\n    output_str = \"[\" + \",\".join([f\"[{df},{r}]\" for df, r in results]) + \"]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}