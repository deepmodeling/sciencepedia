{
    "hands_on_practices": [
        {
            "introduction": "在将辐射定律应用于气候模型之前，深刻理解其物理基础至关重要。本练习旨在巩固能量的光谱分布（普朗克定律）与总发射能量（斯特藩-玻尔兹曼定律）之间的联系。通过从第一性原理出发进行推导，您将亲手计算出斯特藩-玻尔兹曼常数 $\\sigma$，这是任何地表能量收支计算中的基石 。",
            "id": "4017702",
            "problem": "在用于数值天气预报（NWP）和气候模拟的大气环流模型（GCM）中，来自水平均匀表面的向上长波辐射通量是通过对所有频率和向上半球的光谱辐射率进行积分来计算的。从温度为 $T$ 的黑体的 Planck 单位频率光谱辐射率公式出发：\n$$\nB_{\\nu}(T) = \\frac{2 h \\nu^{3}}{c^{2}} \\left(\\frac{1}{\\exp\\!\\left(\\frac{h \\nu}{k_{B} T}\\right) - 1}\\right),\n$$\n并假设发射是各向同性的，请从第一性原理推导频率积分的半球辐射通量，将其表示为 $T$ 和基本常数的函数。请确定乘以 $T^{4}$ 的比例常数，并用 $\\sigma$ 表示。将 $\\sigma$ 表示为包含 $h$、$k_{B}$、$c$ 和一个无量纲积分的闭式解析表达式，然后精确计算该积分的值。使用以下国际单位制（SI）中基本常数的精确值：\n$$\nh = 6.62607015 \\times 10^{-34}\\ \\mathrm{J\\,s},\\quad\nk_{B} = 1.380649 \\times 10^{-23}\\ \\mathrm{J\\,K^{-1}},\\quad\nc = 2.99792458 \\times 10^{8}\\ \\mathrm{m\\,s^{-1}},\n$$\n计算 $\\sigma$ 的数值。将最终数值结果四舍五入到四位有效数字，并以 $\\mathrm{W\\,m^{-2}\\,K^{-4}}$ 为单位表示。根据您的推导，简要阐述 $\\sigma$ 的准确性如何影响气候模型中地表能量收支的闭合，但请确保您最终报告的答案仅为所指定的 $\\sigma$ 的数值。",
            "solution": "该问题要求推导黑体表面的频率积分半球辐射通量，即 Stefan-Boltzmann 定律。我们从给定的 Planck 单位频率光谱辐射率 $B_{\\nu}(T)$ 开始。这个量表示源单位面积、单位立体角、单位频率发射的功率。其单位是 $\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,Hz^{-1}}$。\n$$\nB_{\\nu}(T) = \\frac{2 h \\nu^{3}}{c^{2}} \\left(\\frac{1}{\\exp\\left(\\frac{h \\nu}{k_{B} T}\\right) - 1}\\right)\n$$\n这里，$h$ 是 Planck 常数，$k_B$ 是 Boltzmann 常数，$c$ 是真空中光速，$T$ 是黑体的绝对温度，$\\nu$ 是辐射的频率。\n\n光谱辐射通量 $F_{\\nu}(T)$，也称为光谱出射度，是单位面积、单位频率向整个向上半球发射的功率。假设发射是各向同性的（即辐射率 $B_{\\nu}(T)$ 与方向无关），我们可以通过对辐射率在半球立体角上积分来求得光谱通量。来自立体角微元 $d\\Omega$ 的贡献需要乘以 $\\cos\\theta$（其中 $\\theta$ 是天顶角）进行加权，以考虑发射的投影面积（Lambert 余弦定律）。\n$$\nF_{\\nu}(T) = \\int_{\\Omega} B_{\\nu}(T) \\cos\\theta \\, d\\Omega\n$$\n在球坐标系中，立体角微元为 $d\\Omega = \\sin\\theta \\, d\\theta \\, d\\phi$，其中 $\\phi$ 是方位角。积分范围是向上半球，因此积分限为 $\\theta \\in [0, \\pi/2]$ 和 $\\phi \\in [0, 2\\pi]$。\n由于 $B_{\\nu}(T)$ 与方向无关，可以将其从积分中提出：\n$$\nF_{\\nu}(T) = B_{\\nu}(T) \\int_{0}^{2\\pi} d\\phi \\int_{0}^{\\pi/2} \\cos\\theta \\sin\\theta \\, d\\theta\n$$\n关于方位角的积分是 $\\int_{0}^{2\\pi} d\\phi = 2\\pi$。关于天顶角的积分可以通过换元法求解，例如令 $u = \\sin\\theta$，则 $du = \\cos\\theta \\, d\\theta$：\n$$\n\\int_{0}^{\\pi/2} \\cos\\theta \\sin\\theta \\, d\\theta = \\int_{0}^{1} u \\, du = \\left[ \\frac{u^2}{2} \\right]_{0}^{1} = \\frac{1}{2}\n$$\n因此，总的角度积分是 $2\\pi \\times \\frac{1}{2} = \\pi$。这得到了光谱通量和各向同性光谱辐射率之间的关系：\n$$\nF_{\\nu}(T) = \\pi B_{\\nu}(T) = \\frac{2 \\pi h \\nu^{3}}{c^{2}} \\left(\\frac{1}{\\exp\\left(\\frac{h \\nu}{k_{B} T}\\right) - 1}\\right)\n$$\n为了求得总半球辐射通量 $F(T)$，我们必须将光谱通量 $F_{\\nu}(T)$ 在所有频率上（从 $\\nu = 0$ 到 $\\nu = \\infty$）进行积分。\n$$\nF(T) = \\int_{0}^{\\infty} F_{\\nu}(T) \\, d\\nu = \\int_{0}^{\\infty} \\frac{2 \\pi h \\nu^{3}}{c^{2}} \\frac{1}{\\exp\\left(\\frac{h \\nu}{k_{B} T}\\right) - 1} \\, d\\nu\n$$\n我们可以将常数项移到积分外：\n$$\nF(T) = \\frac{2 \\pi h}{c^{2}} \\int_{0}^{\\infty} \\frac{\\nu^{3}}{\\exp\\left(\\frac{h \\nu}{k_{B} T}\\right) - 1} \\, d\\nu\n$$\n为了计算这个积分，我们进行变量替换，引入一个无量纲量 $x$：\n$$\nx = \\frac{h \\nu}{k_{B} T} \\implies \\nu = \\frac{k_{B} T}{h} x \\implies d\\nu = \\frac{k_{B} T}{h} dx\n$$\n将这些代入积分表达式：\n$$\nF(T) = \\frac{2 \\pi h}{c^{2}} \\int_{0}^{\\infty} \\frac{\\left(\\frac{k_{B} T}{h}x\\right)^{3}}{\\exp(x) - 1} \\left(\\frac{k_{B} T}{h} dx\\right)\n$$\n现在，我们整理所有包含常数和温度 $T$ 的项：\n$$\nF(T) = \\frac{2 \\pi h}{c^{2}} \\left(\\frac{k_{B} T}{h}\\right)^{4} \\int_{0}^{\\infty} \\frac{x^{3}}{\\exp(x) - 1} \\, dx\n$$\n$$\nF(T) = \\left( \\frac{2 \\pi k_{B}^{4}}{c^{2} h^{3}} \\int_{0}^{\\infty} \\frac{x^{3}}{\\exp(x) - 1} \\, dx \\right) T^{4}\n$$\n此方程的形式为 $F(T) = \\sigma T^{4}$，即 Stefan-Boltzmann 定律。比例常数 $\\sigma$ 被确定为：\n$$\n\\sigma = \\frac{2 \\pi k_{B}^{4}}{c^{2} h^{3}} \\int_{0}^{\\infty} \\frac{x^{3}}{\\exp(x) - 1} \\, dx\n$$\n剩下的任务是计算无量纲积分 $I = \\int_{0}^{\\infty} \\frac{x^{3}}{\\exp(x) - 1} \\, dx$。我们可以利用几何级数展开来重写被积函数：\n$$\n\\frac{1}{\\exp(x) - 1} = \\frac{\\exp(-x)}{1 - \\exp(-x)} = \\sum_{n=1}^{\\infty} \\exp(-nx)\n$$\n将此式代入积分，并交换求和与积分的次序（由于一致收敛，这是允许的）：\n$$\nI = \\int_{0}^{\\infty} x^{3} \\sum_{n=1}^{\\infty} \\exp(-nx) \\, dx = \\sum_{n=1}^{\\infty} \\int_{0}^{\\infty} x^{3} \\exp(-nx) \\, dx\n$$\n求和号内的积分可以通过换元法 $u = nx$ 计算，因此 $x = u/n$ 且 $dx = du/n$。\n$$\n\\int_{0}^{\\infty} x^{3} \\exp(-nx) \\, dx = \\int_{0}^{\\infty} \\left(\\frac{u}{n}\\right)^{3} \\exp(-u) \\left(\\frac{du}{n}\\right) = \\frac{1}{n^{4}} \\int_{0}^{\\infty} u^{3} \\exp(-u) \\, du\n$$\n积分 $\\int_{0}^{\\infty} u^{3} \\exp(-u) \\, du$ 是 Gamma 函数 $\\Gamma(4)$ 的定义。对于整数宗量，$\\Gamma(z) = (z-1)!$，所以 $\\Gamma(4) = 3! = 6$。\n因此，求和号内的积分为 $\\frac{6}{n^{4}}$，无量纲积分 $I$ 变为：\n$$\nI = \\sum_{n=1}^{\\infty} \\frac{6}{n^{4}} = 6 \\sum_{n=1}^{\\infty} \\frac{1}{n^{4}}\n$$\n该求和是 Riemann zeta 函数 $\\zeta(4)$ 的定义。其精确值已知为 $\\zeta(4) = \\frac{\\pi^{4}}{90}$。\n$$\nI = 6 \\left(\\frac{\\pi^{4}}{90}\\right) = \\frac{\\pi^{4}}{15}\n$$\n将此结果代回 $\\sigma$ 的表达式，我们得到其用基本常数表示的闭式解析表达式：\n$$\n\\sigma = \\frac{2 \\pi k_{B}^{4}}{c^{2} h^{3}} \\left(\\frac{\\pi^{4}}{15}\\right) = \\frac{2 \\pi^{5} k_{B}^{4}}{15 c^{2} h^{3}}\n$$\n现在我们使用提供的精确 SI 值计算 $\\sigma$ 的数值：\n$h = 6.62607015 \\times 10^{-34}\\ \\mathrm{J\\,s}$\n$k_{B} = 1.380649 \\times 10^{-23}\\ \\mathrm{J\\,K^{-1}}$\n$c = 2.99792458 \\times 10^{8}\\ \\mathrm{m\\,s^{-1}}$\n将这些值代入 $\\sigma$ 的表达式中：\n$$\n\\sigma = \\frac{2 \\pi^{5} (1.380649 \\times 10^{-23})^{4}}{15 (2.99792458 \\times 10^{8})^{2} (6.62607015 \\times 10^{-34})^{3}}\n$$\n高精度计算得出：\n$$\n\\sigma \\approx 5.670374419... \\times 10^{-8}\\ \\mathrm{W\\,m^{-2}\\,K^{-4}}\n$$\n按要求将此结果四舍五入到四位有效数字：\n$$\n\\sigma \\approx 5.670 \\times 10^{-8}\\ \\mathrm{W\\,m^{-2}\\,K^{-4}}\n$$\n关于 $\\sigma$ 的准确性对气候模型的重要意义：地表能量收支是任何气候模型的核心组成部分，用于确定地表温度 $T_s$。该收支平衡了传入和传出的能量通量。其中的一个关键项是地表向上长波辐射，由 $L_{\\uparrow} = \\epsilon \\sigma T_s^4$ 给出，其中 $\\epsilon$ 是地表发射率。计算出的地表温度是一个关键的预报变量，它对这一项高度敏感，因为该项与 $T_s^4$ 成正比，并由 $\\sigma$ 进行缩放。$\\sigma$ 数值的任何不准确性都会给模型的能量平衡引入系统性偏差。一个被错误高估的 $\\sigma$ 会导致模型高估辐射冷却，从而计算出人为偏低的地表温度，而一个偏低的 $\\sigma$ 则会产生相反的效果。然而，正如推导所示，$\\sigma$ 不是一个经验参数，而是由基本常数 $h$、$k_B$ 和 $c$ 推导出的常数。在2019年国际单位制基本单位重新定义之后，这些基本常数具有确切的、被定义的值。因此，$\\sigma$ 也是一个可以精确得知的常数，在现代、正确实现的模型中，它不是数值不确定性的来源。准确性的挑战在于能量收支的其他部分，例如发射率、云和湍流通量的参数化方案。",
            "answer": "$$\\boxed{5.670 \\times 10^{-8}}$$"
        },
        {
            "introduction": "气候模型的准确性在很大程度上依赖于其边界条件的真实性。虽然理想黑体是理解热辐射的一个良好起点，但现实世界中的地表（如沙漠和海洋）具有独特的光谱“指纹”。这项计算练习将指导您如何在辐射通量计算中考虑这种复杂性，并量化简化黑体假设所带来的误差，这是辐射传输方案中一项至关重要的实际任务 。",
            "id": "4017764",
            "problem": "在数值天气预报和气候模拟中，用作下边界条件的地表向上长波通量必须考虑随光谱变化的表面发射率，而不是假设理想的黑体行为。考虑一个处于热力学平衡状态、温度为 $T_s$ 的水平均匀、各向同性的朗伯面发射热辐射。对于所有波段规格，波长用 $\\lambda$ 表示，单位为微米（$\\mu\\mathrm{m}$），而所有物理定律均以国际单位制（SI units）应用，在任何计算中 $\\lambda$ 会被内部转换为米。在波长区间 $[\\lambda_1,\\lambda_2]$ 上的波段限制的半球发射通量，必须通过将光谱发射率与相应的平衡光谱辐射量之积对 $\\lambda$ 积分来获得。对于真实表面，光谱发射率取决于 $\\lambda$ 和材料。使用以下随光谱变化的发射率函数，这些函数被选择为在热红外波段对沙漠和海洋表面是物理上合理的：\n\n- 沙漠发射率 $\\epsilon_\\lambda(\\mathrm{desert})$，单位 $\\mu\\mathrm{m}$：\n$$\n\\epsilon_\\lambda(\\mathrm{desert}) = \\mathrm{clip}\\!\\left(0.975 - 0.080\\,\\exp\\!\\left(-\\frac{(\\lambda-9.0)^2}{2\\times 0.4^2}\\right) - 0.015\\,\\exp\\!\\left(-\\frac{(\\lambda-12.5)^2}{2\\times 0.9^2}\\right), 0.85, 0.99\\right)\n$$\n\n- 海洋发射率 $\\epsilon_\\lambda(\\mathrm{ocean})$，单位 $\\mu\\mathrm{m}$：\n$$\n\\epsilon_\\lambda(\\mathrm{ocean}) = \\mathrm{clip}\\!\\left(0.986 - 0.003\\,\\cos\\!\\left(\\frac{2\\pi(\\lambda-10)}{20}\\right) - 0.002\\,\\exp\\!\\left(-\\frac{(\\lambda-8.0)^2}{2\\times 0.6^2}\\right), 0.97, 0.995\\right)\n$$\n\n从一个有效的热力学-辐射平衡基础出发，推导出在 $[\\lambda_1,\\lambda_2]$ 上具有随光谱变化的发射率的朗伯面的波段限制半球发射通量，以及相应的理想化黑体波段通量（黑体假设对应于单位发射率）。然后实现一个程序，针对下面的测试套件，为每个案例计算基于发射率的波段通量与黑体波段通量之间的相对差异，定义为\n$$\n\\delta = \\frac{F_{\\epsilon} - F_{\\mathrm{bb}}}{F_{\\mathrm{bb}}},\n$$\n该值是无量纲的，应以小数形式报告（不使用百分号）。\n\n您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$[\\delta_1,\\delta_2,\\dots]$）。所需的测试套件涵盖了典型和边缘条件：\n\n- 案例 1：沙漠表面，$T_s = 320\\,\\mathrm{K}$，波段 $[8,13]\\,\\mu\\mathrm{m}$。\n- 案例 2：海洋表面，$T_s = 295\\,\\mathrm{K}$，波段 $[8,13]\\,\\mu\\mathrm{m}$。\n- 案例 3：沙漠表面，$T_s = 320\\,\\mathrm{K}$，波段 $[4,50]\\,\\mu\\mathrm{m}$。\n- 案例 4：海洋表面，$T_s = 295\\,\\mathrm{K}$，波段 $[4,50]\\,\\mu\\mathrm{m}$。\n- 案例 5：海洋表面（冷），$T_s = 260\\,\\mathrm{K}$，波段 $[10,12]\\,\\mu\\mathrm{m}$。\n- 案例 6：沙漠表面（已知硅酸盐特征附近的窄窗），$T_s = 320\\,\\mathrm{K}$，波段 $[8.8,9.2]\\,\\mu\\mathrm{m}$。\n\n所有涉及波长的内部物理计算必须使用米，任何通量单位均为瓦特/平方米（$\\mathrm{W}\\,\\mathrm{m}^{-2}$），但最终报告的 $\\delta$ 值必须是无量纲小数。您的实现必须是自包含的，无需用户输入即可运行，并且必须遵守上面指定的输出格式。",
            "solution": "在温度 $T$ 下处于热力学平衡状态的物体发射热辐射所遵循的物理原理是 Planck 定律。对于一个完美的黑体，该定律描述了光谱辐亮度 $B_\\lambda(\\lambda, T)$，即单位面积、单位立体角、单位波长所发射的功率，是波长 $\\lambda$ 和温度 $T$ 的函数。在国际单位制（SI units）中，其表达式为：\n$$\nB_\\lambda(\\lambda, T) = \\frac{2hc^2}{\\lambda^5} \\frac{1}{\\exp\\left(\\frac{hc}{\\lambda k_B T}\\right) - 1} \\quad [\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{sr}^{-1}\\,\\mathrm{m}^{-1}]\n$$\n其中 $h$ 是 Planck 常数，$c$ 是真空中的光速，$k_B$ 是 Boltzmann 常数。\n\n问题指明发射表面是朗伯面，意味着它各向同性地辐射（在所有方向上具有相同的辐亮度）。对于朗伯面，光谱半球出射度 $E_\\lambda(\\lambda, T)$——即单位面积、单位波长向表面上方的半球发射的总功率——与光谱辐亮度通过 $E_\\lambda = \\pi B_\\lambda$ 相关联。真实表面由光谱发射率 $\\epsilon_\\lambda(\\lambda)$（其中 $0 \\le \\epsilon_\\lambda \\le 1$）来表征，它是其光谱出射度与同温下黑体光谱出射度的比值。因此，来自温度为 $T_s$ 的真实朗伯面的光谱半球出射度为：\n$$\nE_\\lambda(\\lambda, T_s) = \\epsilon_\\lambda(\\lambda) \\cdot \\pi B_\\lambda(\\lambda, T_s) = \\epsilon_\\lambda(\\lambda) \\cdot E_{\\mathrm{b}\\lambda}(\\lambda, T_s)\n$$\n其中 $E_{\\mathrm{b}\\lambda}(\\lambda, T_s)$ 是黑体的光谱半球出射度。它通常使用第一和第二辐射常数书写，$c_1 = 2\\pi h c^2$ 和 $c_2 = hc/k_B$：\n$$\nE_{\\mathrm{b}\\lambda}(\\lambda, T_s) = \\frac{c_1}{\\lambda^5 \\left( \\exp\\left(\\frac{c_2}{\\lambda T_s}\\right) - 1 \\right)} \\quad [\\mathrm{W}\\,\\mathrm{m}^{-2}\\,\\mathrm{m}^{-1}]\n$$\n问题要求计算在波长区间 $[\\lambda_1, \\lambda_2]$ 上的波段限制的半球发射通量 $F$。这通过在指定波长波段上对光谱半球出射度进行积分来获得。对于具有随光谱变化的发射率 $\\epsilon_\\lambda(\\lambda)$ 的表面，其通量 $F_{\\epsilon}$ 为：\n$$\nF_{\\epsilon}(T_s, \\lambda_1, \\lambda_2) = \\int_{\\lambda_1}^{\\lambda_2} E_\\lambda(\\lambda, T_s) \\, d\\lambda = \\int_{\\lambda_1}^{\\lambda_2} \\epsilon_\\lambda(\\lambda) E_{\\mathrm{b}\\lambda}(\\lambda, T_s) \\, d\\lambda\n$$\n对于理想化的黑体情况，所有波长的发射率均为1，即 $\\epsilon_\\lambda(\\lambda) = 1$。相应的黑体波段通量 $F_{\\mathrm{bb}}$ 是：\n$$\nF_{\\mathrm{bb}}(T_s, \\lambda_1, \\lambda_2) = \\int_{\\lambda_1}^{\\lambda_2} E_{\\mathrm{b}\\lambda}(\\lambda, T_s) \\, d\\lambda\n$$\n目标量是基于发射率的通量与黑体通量之间的相对差异 $\\delta$：\n$$\n\\delta = \\frac{F_{\\epsilon} - F_{\\mathrm{bb}}}{F_{\\mathrm{bb}}} = \\frac{F_{\\epsilon}}{F_{\\mathrm{bb}}} - 1\n$$\n用于计算 $F_{\\epsilon}$ 和 $F_{\\mathrm{bb}}$ 的积分没有通用的解析解，必须使用数值积分来计算。实现将定义给定的发射率函数 $\\epsilon_\\lambda(\\mathrm{desert})$ 和 $\\epsilon_\\lambda(\\mathrm{ocean})$，以及 Planck 函数 $E_{\\mathrm{b}\\lambda}(\\lambda, T_s)$。一个关键细节是单位的处理：发射率函数定义时波长 $\\lambda$ 的单位是微米（$\\mu\\mathrm{m}$），而物理常数和 Planck 定律使用国际单位制，要求 $\\lambda$ 的单位是米（$m$）。因此，在评估发射率函数之前，必须执行从米（积分变量）到微米的单位转换。\n\n每个测试案例的算法步骤如下：\n$1$。 确定表面类型（沙漠或海洋）、表面温度 $T_s$ 和波长波段 $[\\lambda_1, \\lambda_2]$。\n$2$。 定义用于数值积分的两个被积函数：第一个用于真实表面，$I_{\\epsilon}(\\lambda) = \\epsilon_\\lambda(\\lambda) E_{\\mathrm{b}\\lambda}(\\lambda, T_s)$，第二个用于黑体，$I_{\\mathrm{bb}}(\\lambda) = E_{\\mathrm{b}\\lambda}(\\lambda, T_s)$。根据表面类型选择适当的发射率函数 $\\epsilon_\\lambda(\\lambda)$。Planck 函数中所有涉及 $\\lambda$ 的计算都使用米。发射率函数必须在将 $\\lambda$ 转换为微米后进行评估。\n$3$。 对 $I_{\\epsilon}(\\lambda)$ 从 $\\lambda_1$ 到 $\\lambda_2$ 进行数值积分以求得 $F_{\\epsilon}$。以 $\\mu\\mathrm{m}$ 给出的积分限必须首先转换为米。\n$4$。 对 $I_{\\mathrm{bb}}(\\lambda)$ 从 $\\lambda_1$ 到 $\\lambda_2$ 进行数值积分以求得 $F_{\\mathrm{bb}}$。\n$5$。 计算相对差异 $\\delta = (F_{\\epsilon} - F_{\\mathrm{bb}}) / F_{\\mathrm{bb}}$。\n\n此过程将对问题陈述中提供的所有 6 个测试案例重复。最终输出将是计算出的 $\\delta$ 值的列表。由于 $\\epsilon_\\lambda(\\lambda) \\le 1$，预计 $F_{\\epsilon} \\le F_{\\mathrm{bb}}$，因此所有 $\\delta$ 值都将小于或等于 0。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate, constants\n\ndef solve():\n    \"\"\"\n    Solves for the fractional difference in band-limited thermal flux between\n    a real surface and a blackbody for several test cases.\n    \"\"\"\n\n    # Physical constants from scipy.constants in SI units\n    h = constants.h  # Planck constant (J.s)\n    c = constants.c  # Speed of light (m/s)\n    k = constants.k  # Boltzmann constant (J/K)\n\n    # Derived radiation constants for Planck's law for hemispheric exitance\n    c1 = 2 * np.pi * h * c**2  # First radiation constant (W.m^2)\n    c2 = h * c / k              # Second radiation constant (m.K)\n\n    # Emissivity functions are defined with wavelength input in micrometers (um).\n    def epsilon_desert(lam_um: float) - float:\n        \"\"\"\n        Calculates the spectral emissivity for a desert surface.\n        \n        Args:\n            lam_um: Wavelength in micrometers.\n        \n        Returns:\n            The dimensionless spectral emissivity.\n        \"\"\"\n        term1 = 0.080 * np.exp(-((lam_um - 9.0)**2) / (2 * 0.4**2))\n        term2 = 0.015 * np.exp(-((lam_um - 12.5)**2) / (2 * 0.9**2))\n        val = 0.975 - term1 - term2\n        return np.clip(val, 0.85, 0.99)\n\n    def epsilon_ocean(lam_um: float) - float:\n        \"\"\"\n        Calculates the spectral emissivity for an ocean surface.\n        \n        Args:\n            lam_um: Wavelength in micrometers.\n        \n        Returns:\n            The dimensionless spectral emissivity.\n        \"\"\"\n        term1 = 0.003 * np.cos(2 * np.pi * (lam_um - 10.0) / 20.0)\n        term2 = 0.002 * np.exp(-((lam_um - 8.0)**2) / (2 * 0.6**2))\n        val = 0.986 - term1 - term2\n        return np.clip(val, 0.97, 0.995)\n\n    # Planck's law for spectral hemispheric exitance E_bλ (W/m^2/m).\n    # The function is defined with wavelength input in meters (m).\n    def planck_exitance(lam_m: float, T: float) - float:\n        \"\"\"\n        Calculates blackbody spectral hemispheric exitance.\n        \n        Args:\n            lam_m: Wavelength in meters.\n            T: Temperature in Kelvin.\n        \n        Returns:\n            Spectral hemispheric exitance in W/m^3 (i.e., W/m^2 per m).\n        \"\"\"\n        # Avoid division by zero at lambda = 0\n        if lam_m == 0:\n            return 0.0\n        \n        # Calculate the exponent term in Planck's law\n        exponent = c2 / (lam_m * T)\n        \n        # Avoid overflow for large exponents (exp(~709) overflows float64)\n        if exponent  690:\n            return 0.0\n        \n        return c1 / (lam_m**5 * (np.exp(exponent) - 1.0))\n\n    # Define the integrands for use with scipy.integrate.quad.\n    # The integration variable 'lam_m' is in meters.\n    def integrand_emissivity(lam_m: float, T: float, epsilon_func) - float:\n        \"\"\"Integrand for real surface flux: ε(λ) * E_bλ(λ, T).\"\"\"\n        lam_um = lam_m * 1e6  # Convert wavelength to micrometers for emissivity function\n        epsilon = epsilon_func(lam_um)\n        return epsilon * planck_exitance(lam_m, T)\n\n    def integrand_blackbody(lam_m: float, T: float) - float:\n        \"\"\"Integrand for blackbody flux: E_bλ(λ, T).\"\"\"\n        return planck_exitance(lam_m, T)\n\n    # Test cases as defined in the problem statement\n    test_cases = [\n        {'type': 'desert', 'Ts': 320.0, 'band': (8.0, 13.0)},\n        {'type': 'ocean', 'Ts': 295.0, 'band': (8.0, 13.0)},\n        {'type': 'desert', 'Ts': 320.0, 'band': (4.0, 50.0)},\n        {'type': 'ocean', 'Ts': 295.0, 'band': (4.0, 50.0)},\n        {'type': 'ocean', 'Ts': 260.0, 'band': (10.0, 12.0)},\n        {'type': 'desert', 'Ts': 320.0, 'band': (8.8, 9.2)},\n    ]\n    \n    emissivity_map = {\n        'desert': epsilon_desert,\n        'ocean': epsilon_ocean\n    }\n\n    results = []\n    for case in test_cases:\n        surface_type = case['type']\n        Ts = case['Ts']\n        lam1_um, lam2_um = case['band']\n        epsilon_func = emissivity_map[surface_type]\n\n        # Convert wavelength band limits from micrometers to meters for integration\n        lam1_m = lam1_um * 1e-6\n        lam2_m = lam2_um * 1e-6\n\n        # Calculate F_epsilon (flux with spectrally varying emissivity)\n        F_eps, _ = integrate.quad(\n            integrand_emissivity, lam1_m, lam2_m, args=(Ts, epsilon_func)\n        )\n\n        # Calculate F_bb (ideal blackbody flux)\n        F_bb, _ = integrate.quad(\n            integrand_blackbody, lam1_m, lam2_m, args=(Ts,)\n        )\n        \n        # Calculate the fractional difference delta\n        # F_bb for these physical conditions will not be zero\n        delta = (F_eps - F_bb) / F_bb\n        \n        results.append(delta)\n\n    # Final print statement in the exact required format.\n    # Using .10f for sufficient precision.\n    print(f\"[{','.join([f'{r:.10f}' for r in results])}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "普朗克函数是描述热辐射源的强大工具，但其在辐射传输方程中作为源函数的有效性，取决于一个关键假设：局地热力学平衡（Local Thermodynamic Equilibrium, LTE）。本练习将引导您探讨高层大气中的物理条件，在这些条件下LTE假设会失效。准确理解这一点，对于模拟高空大气的冷却率和动力学过程至关重要 。",
            "id": "4017730",
            "problem": "气候模型的长波辐射方案通常在每个层中使用源函数 $S_\\nu$ 求解沿路径坐标 $s$ 的强度为 $I_\\nu$ 的单色辐射传输方程。在局地热力学平衡 (LTE) 中，源函数通常被取为局地动理学温度 $T$ 下的普朗克函数 $B_\\nu(T)$。考虑夜间高层大气中，二氧化碳在频率为 $\\nu_0$ 的 $15\\,\\mu\\mathrm{m}$ 波段上的一次主要振动跃迁的双能级表示。假设空气的数密度 $n$ 由理想气体关系式 $n = p/(k_\\mathrm{B} T)$ 给出，其中 $p$ 是压强，$k_\\mathrm{B}$ 是玻尔兹曼常数。从上能级到下能级跃迁的自发辐射系数为 $A_{ul} = 1.5\\,\\mathrm{s^{-1}}$，在 $T = 220\\,\\mathrm{K}$ 时，与温度相关的碰撞去激发速率系数为 $k_{ul}(T) = 1.0 \\times 10^{-20}\\,\\mathrm{m^3\\,s^{-1}}$。为本问题之目的，取 $T=220\\,\\mathrm{K}$，忽略太阳泵浦（夜间），并认为谱线在平流层上层和中间层是光学薄的。\n\n仅使用辐射传输和微观平衡的基本原理，从第一性原理出发进行推理，确定在这种跃迁的 LTE 假设预计会在何种大气条件下失效，以及这种失效在数值天气预报 (NWP) 和冷却率的气候计算中用 $B_\\nu(T)$ 替代源函数 $S_\\nu$ 会产生何种定性影响。你的分析应明确地将微观速率与宏观辐射行为联系起来，并指出当碰撞不足以维持玻尔兹曼分布时平均辐射场的作用。\n\n下列陈述中哪些是正确的？\n\nA. 对于这个 $15\\,\\mu\\mathrm{m}$ 的跃迁，LTE 预计在 $n\\,k_{ul} \\gg A_{ul}$ 时成立；在光学薄的中间层，当 $n\\,k_{ul} \\lesssim A_{ul}$ 时，夜间源函数 $S_\\nu$ 变得小于 $B_\\nu(T)$，因此使用 $B_\\nu(T)$ 作为源项倾向于高估谱线中心的发射和相关的冷却率。\n\nB. 在光学薄层中，由于辐射场很弱，源函数 $S_\\nu$ 总是等于 $B_\\nu(T)$；因此，在平流层上层，无论碰撞速率如何，使用 $B_\\nu(T)$ 都是准确的。\n\nC. 对 LTE 的偏离纯粹由光学厚度控制；只要光学深度 $\\tau_\\nu \\ll 1$，即使 $n\\,k_{ul} \\gg A_{ul}$，$S_\\nu$ 也会强烈偏离 $B_\\nu(T)$。\n\nD. 当 $n\\,k_{ul} \\ll A_{ul}$ 时，源函数 $S_\\nu$ 通过能级布居数的辐射耦合依赖于平均强度 $J_\\nu$；用一个包含与 $J_\\nu$ 成正比的因子的源项替代 $B_\\nu(T)$，可以减少计算出的冷却率的偏差。\n\nE. 在高层大气中使用 $B_\\nu(T)$ 导致的误差总是导致对冷却的低估，因为在夜间 $B_\\nu(T)$ 小于非局地热力学平衡源函数 $S_\\nu$。\n\n选择所有适用项。",
            "solution": "一条谱线的源函数 $S_\\nu$ 定义为发射系数 $j_\\nu$ 与吸收系数 $\\kappa_\\nu$ 之比。对于一个具有下能级 $l$ 和上能级 $u$，数密度分别为 $n_l$ 和 $n_u$ 的双能级系统，这些系数由下式给出：\n$$j_\\nu = n_u A_{ul} \\frac{h\\nu}{4\\pi} \\phi(\\nu)$$\n$$\\kappa_\\nu = (n_l B_{lu} - n_u B_{ul}) \\frac{h\\nu}{4\\pi} \\phi(\\nu)$$\n其中 $A_{ul}$、$B_{lu}$ 和 $B_{ul}$ 分别是自发辐射、吸收和受激辐射的爱因斯坦系数，$h$ 是普朗克常数，$\\nu$ 是频率，$\\phi(\\nu)$ 是谱线线型函数。\n\n因此，源函数为：\n$$S_\\nu = \\frac{j_\\nu}{\\kappa_\\nu} = \\frac{n_u A_{ul}}{n_l B_{lu} - n_u B_{ul}}$$\n使用爱因斯坦关系式 $g_l B_{lu} = g_u B_{ul}$ 和 $A_{ul} = \\frac{2h\\nu^3}{c^2} B_{ul}$（对于强度单位），其中 $g_l$ 和 $g_u$ 是能级的统计权重，$c$ 是光速，我们可以将源函数重写为：\n$$S_\\nu = \\frac{A_{ul}/B_{ul}}{\\frac{n_l}{n_u}\\frac{B_{lu}}{B_{ul}} - 1} = \\frac{2h\\nu^3/c^2}{\\frac{g_u}{g_l}\\frac{n_l}{n_u} - 1}$$\n\n布居数比 $n_u/n_l$ 由统计平衡原理确定，该原理指出，在稳态下，进入上能级的跃迁速率等于离开上能级的跃迁速率。\n$$ \\text{进入速率} = \\text{离开速率} $$\n$$ n_l (C_{lu} + B_{lu} \\bar{J}_\\nu) = n_u (C_{ul} + A_{ul} + B_{ul} \\bar{J}_\\nu) $$\n此处，$C_{lu} = n k_{lu}$ 和 $C_{ul} = n k_{ul}$ 分别是单个分子的碰撞激发和去激发速率，其中 $n$ 是碰撞粒子（空气）的数密度。$\\bar{J}_\\nu = \\int_0^\\infty J_\\nu \\phi(\\nu) d\\nu$ 是辐射场在谱线线型上的频率积分平均强度。\n\n从这个平衡关系中，我们解出布居数比：\n$$ \\frac{n_u}{n_l} = \\frac{C_{lu} + B_{lu} \\bar{J}_\\nu}{C_{ul} + A_{ul} + B_{ul} \\bar{J}_\\nu} $$\n\n**LTE的条件：**\n局地热力学平衡 (LTE) 是指能级布居数由碰撞主导的条件，从而有效地与气体的局地动能分布保持热平衡。这种情况发生在碰撞速率远大于辐射速率时。去布居的主要辐射速率通常是自发辐射 $A_{ul}$。因此，LTE 的主要条件是：\n$$ C_{ul} \\gg A_{ul} \\implies n k_{ul} \\gg A_{ul} $$\n当此条件成立时（并且 $C_{ul} \\gg B_{ul}\\bar{J}_\\nu$），布居数比简化为：\n$$ \\frac{n_u}{n_l} \\approx \\frac{C_{lu}}{C_{ul}} = \\frac{n k_{lu}}{n k_{ul}} $$\n根据碰撞的细致平衡原理，速率之间的关系为 $k_{lu} = k_{ul} \\frac{g_u}{g_l} \\exp(-\\frac{h\\nu}{k_B T})$。因此，布居数比变为玻尔兹曼分布：\n$$ \\left(\\frac{n_u}{n_l}\\right)_{LTE} = \\frac{g_u}{g_l} \\exp\\left(-\\frac{h\\nu}{k_B T}\\right) $$\n将此代入 $S_\\nu$ 的表达式：\n$$ S_\\nu = \\frac{2h\\nu^3/c^2}{\\frac{g_u}{g_l}\\left(\\frac{g_l}{g_u} \\exp\\left(\\frac{h\\nu}{k_B T}\\right)\\right) - 1} = \\frac{2h\\nu^3}{c^2} \\frac{1}{\\exp(\\frac{h\\nu}{k_B T}) - 1} = B_\\nu(T) $$\n因此，在 $n k_{ul} \\gg A_{ul}$ 的条件下，源函数等于普朗克函数，这就是 LTE 假设。\n\n**LTE的失效（非LTE）：**\n当碰撞速率不再占主导地位时，即当 $n k_{ul} \\lesssim A_{ul}$ 时，LTE 失效。这种情况发生在高海拔地区（平流层上层和中间层），那里的空气数密度 $n$ 变得非常低。\n\n在这个非LTE（NLTE）区域，我们必须使用完整的统计平衡方程。让我们分析条件 $S_\\nu  B_\\nu(T)$。这等同于要求布居数比是亚热的，即 $n_u/n_l  (n_u/n_l)_{LTE}$。\n$$ \\frac{C_{lu} + B_{lu} \\bar{J}_\\nu}{C_{ul} + A_{ul} + B_{ul} \\bar{J}_\\nu}  \\frac{C_{lu}}{C_{ul}} $$\n对这个不等式进行代数运算，得到条件：\n$$ \\bar{J}_\\nu  B_\\nu(T) $$\n在本问题的背景下（夜间高层大气），这个条件是满足的。局地动理学温度 $T$ 约为 $220\\,\\mathrm{K}$ 的量级。辐射场 $\\bar{J}_\\nu$ 是来自较暖的低层大气的上行辐射（被几何稀释）和来自寒冷太空（有效温度 $T \\approx 3\\,\\mathrm{K}$）的下行辐射的组合。因此，辐射场非常弱，且 $\\bar{J}_\\nu \\ll B_\\nu(T)$。\n\n这意味着在 NLTE 区域（$n k_{ul} \\lesssim A_{ul}$），自发辐射使上能级去布居的效率远高于通过碰撞或吸收微弱环境辐射进行的再布居。因此，上能级的布居数 $n_u$ 降至其热平衡（玻尔兹曼）值以下，导致 $S_\\nu  B_\\nu(T)$。\n\n**对冷却率的影响：**\n大气层中的净辐射冷却率由净辐射通量的散度决定。对于一个向太空发射的光学薄层，冷却率主要由发射的总功率决定，该功率与积分发射率 $\\int j_\\nu d\\nu$ 成正比。由于 $j_\\nu = \\kappa_\\nu S_\\nu$，冷却率近似与 $\\int \\kappa_\\nu S_\\nu d\\nu$ 成正比。如果一个模型错误地假设 LTE，它会使用 $S_\\nu = B_\\nu(T)$。由于真实的源函数更小，即 $S_\\nu  B_\\nu(T)$，LTE 假设会导致计算出的发射量过大。因此，在 NLTE 区域使用 $B_\\nu(T)$ 作为源函数会**高估**大气冷却率。\n\n**平均辐射场的作用：**\n当 $n k_{ul} \\ll A_{ul}$ 时，统计平衡方程表明，布居数比 $n_u/n_l$ 以及源函数 $S_\\nu$ 都变得依赖于平均强度 $\\bar{J}_\\nu$：\n$$ S_\\nu \\text{ 依赖于 } \\frac{n_u}{n_l} = f(C_{lu}, C_{ul}, A_{ul}, \\bar{J}_\\nu) $$\n源函数与辐射场的这种耦合使得辐射传输方程变为非局地和非线性的。精确的 NLTE 计算需要自洽地求解辐射场和能级布居数。使用一个恰当考虑了对 $J_\\nu$ 依赖性的源项是在该区域中模拟辐射传输的正确方法，从而减少由 LTE 近似引入的偏差。\n\n### 逐项分析\n\n**A. 对于这个 $15\\,\\mu\\mathrm{m}$ 的跃迁，LTE 预计在 $n\\,k_{ul} \\gg A_{ul}$ 时成立；在光学薄的中间层，当 $n\\,k_{ul} \\lesssim A_{ul}$ 时，夜间源函数 $S_\\nu$ 变得小于 $B_\\nu(T)$，因此使用 $B_\\nu(T)$ 作为源项倾向于高估谱线中心的发射和相关的冷却率。**\n该陈述与上述推导完全一致。\n- LTE 的条件被正确地确定为 $n\\,k_{ul} \\gg A_{ul}$。\n- LTE 失效的条件 $n\\,k_{ul} \\lesssim A_{ul}$ 被正确地置于低密度的中间层。\n- 由此产生的夜间关系 $S_\\nu  B_\\nu(T)$ 是正确的。\n- 关于使用 $B_\\nu(T)$ 会高估发射和冷却的结论是正确的。\n**结论：正确。**\n\n**B. 在光学薄层中，由于辐射场很弱，源函数 $S_\\nu$ 总是等于 $B_\\nu(T)$；因此，在平流层上层，无论碰撞速率如何，使用 $B_\\nu(T)$ 都是准确的。**\n该陈述不正确。$S_\\nu = B_\\nu(T)$ 的条件是碰撞占主导地位（$n k_{ul} \\gg A_{ul}$），而不是光学薄或弱辐射场。事实上，在低碰撞环境中，弱辐射场恰恰是 $S_\\nu$ 与 $B_\\nu(T)$ 解耦并变得小于后者的原因。关于这与碰撞速率无关的结论是根本错误的。\n**结论：不正确。**\n\n**C. 对 LTE 的偏离纯粹由光学厚度控制；只要光学深度 $\\tau_\\nu \\ll 1$，即使 $n\\,k_{ul} \\gg A_{ul}$，$S_\\nu$ 也会强烈偏离 $B_\\nu(T)$。**\n该陈述不正确。对 LTE 偏离的主要控制因素是碰撞速率和辐射速率（$n k_{ul}$ vs $A_{ul}$）之间的竞争，这是密度和温度的函数，而不仅仅是光学厚度。一个大气层可能光学薄，但如果密度足够高，仍然可以处于 LTE 状态。声称“即使 $n\\,k_{ul} \\gg A_{ul}$”也会发生偏离，这直接与 LTE 条件的定义相矛盾。\n**结论：不正确。**\n\n**D. 当 $n\\,k_{ul} \\ll A_{ul}$ 时，源函数 $S_\\nu$ 通过能级布居数的辐射耦合依赖于平均强度 $J_\\nu$；用一个包含与 $J_\\nu$ 成正比的因子的源项替代 $B_\\nu(T)$，可以减少计算出的冷却率的偏差。**\n该陈述准确地描述了 NLTE 的物理过程。如统计平衡方程所示，当碰撞项很小时，涉及 $J_\\nu$ 的辐射项在决定布居数比以及源函数方面变得重要。这产生了一种非局地耦合。一个恰当的 NLTE 处理必须考虑这种对 $J_\\nu$ 的依赖性。这样做可以纠正简单（且错误）的 LTE 假设，从而减少计算出的冷却率中的偏差。\n**结论：正确。**\n\n**E. 在高层大气中使用 $B_\\nu(T)$ 导致的误差总是导致对冷却的低估，因为在夜间 $B_\\nu(T)$ 小于非局地热力学平衡源函数 $S_\\nu$。**\n该陈述的前提和结论都错了。如前所推导，在寒冷的夜间高层大气中，辐射损失导致上能级布居不足，所以真实的源函数小于普朗克函数：$S_\\nu  B_\\nu(T)$。因此，使用 $B_\\nu(T)$ 作为源函数会导致对冷却的**高估**，而不是低估。\n**结论：不正确。**",
            "answer": "$$\\boxed{AD}$$"
        }
    ]
}