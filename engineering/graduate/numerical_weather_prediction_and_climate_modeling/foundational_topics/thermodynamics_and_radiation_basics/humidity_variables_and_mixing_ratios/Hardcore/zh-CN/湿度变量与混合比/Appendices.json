{
    "hands_on_practices": [
        {
            "introduction": "大气湿度可以通过多种变量来量化，在它们之间进行转换是一项基本技能。例如，一些先进的仪器测量的是水汽的摩尔混合比，而数值模型通常使用基于质量的物理量，如比湿。本练习  将指导您从分子质量的第一性原理出发，推导并计算所需的关系，以弥合这一差距。",
            "id": "4052433",
            "problem": "在一个用于数值天气预报的数据同化系统中，一个近地面湿度观测值以腔衰荡光谱（CRDS）测量的水汽摩尔混合比的形式给出。设测得的摩尔混合比为 $x_v = 1.42 \\times 10^{-2}$。比湿 $q$ 定义为水汽质量与湿空气总质量之比，摩尔混合比 $x_v$ 定义为水汽的摩尔数与湿空气总摩尔数之比。从这些定义和分子质量的概念出发，推导一个用 $x_v$、水汽的分子质量 $M_v$ 以及干空气的平均分子质量 $M_d$ 来表示 $q$ 的表达式。然后，使用大气中科学上的典型值 $M_v = 18.01528\\,\\mathrm{g\\,mol^{-1}}$ 和 $M_d = 28.9647\\,\\mathrm{g\\,mol^{-1}}$，计算给定 $x_v$ 对应的 $q$ 的数值。将 $q$ 的最终结果表示为以 $\\mathrm{kg\\,kg^{-1}}$ 为单位的无量纲质量分数。将您的答案四舍五入到四位有效数字。",
            "solution": "该问题是有效的，因为它具有科学依据、提法恰当、客观，并包含了获得唯一解所需的所有必要信息。所提供的定义和数值是大气科学中的标准值。\n\n任务是首先推导一个用摩尔混合比 $x_v$、水汽的分子质量 $M_v$ 和干空气的平均分子质量 $M_d$ 表示比湿 $q$ 的表达式。然后，必须计算出 $q$ 的数值。\n\n根据定义，比湿 $q$ 是水汽质量 $m_v$ 与湿空气块总质量 $m_t$ 之比。总质量是水汽质量和干空气质量 $m_d$ 的总和。\n$$q = \\frac{m_v}{m_t} = \\frac{m_v}{m_v + m_d}$$\n摩尔混合比 $x_v$ 定义为水汽的摩尔数 $n_v$ 与湿空气块中总摩尔数 $n_t$ 之比。总摩尔数是水汽摩尔数和干空气摩尔数 $n_d$ 的总和。\n$$x_v = \\frac{n_v}{n_t} = \\frac{n_v}{n_v + n_d}$$\n物质的质量通过基本关系 $m = n M$ 与其摩尔数和分子质量 $M$ 相关。将此应用于水汽和干空气，我们得到：\n$$m_v = n_v M_v$$\n$$m_d = n_d M_d$$\n将这些质量表达式代入比湿 $q$ 的定义中：\n$$q = \\frac{n_v M_v}{n_v M_v + n_d M_d}$$\n为了用 $x_v$ 表示 $q$，我们可以将 $q$ 表达式的分子和分母同时除以总摩尔数 $n_t = n_v + n_d$。\n$$q = \\frac{\\frac{n_v M_v}{n_t}}{\\frac{n_v M_v}{n_t} + \\frac{n_d M_d}{n_t}}$$\n这可以改写为：\n$$q = \\frac{\\left(\\frac{n_v}{n_t}\\right) M_v}{\\left(\\frac{n_v}{n_t}\\right) M_v + \\left(\\frac{n_d}{n_t}\\right) M_d}$$\n根据定义，$\\frac{n_v}{n_t} = x_v$。项 $\\frac{n_d}{n_t}$ 代表干空气的摩尔分数，我们称之为 $x_d$。由于湿空气被视为水汽和干空气的双组分混合物，它们的摩尔分数之和必须为1：\n$$x_v + x_d = 1 \\implies x_d = 1 - x_v$$\n将 $x_v$ 和 $x_d = 1 - x_v$ 代入 $q$ 的方程，我们得到所需的表达式：\n$$q = \\frac{x_v M_v}{x_v M_v + (1 - x_v) M_d}$$\n这个表达式将比湿 $q$ 与摩尔混合比 $x_v$ 以及水汽和干空气的分子质量 $M_v$ 和 $M_d$ 联系起来。\n\n现在，我们使用所提供的数据计算 $q$ 的数值：\n- 摩尔混合比：$x_v = 1.42 \\times 10^{-2}$ (无量纲)\n- 水汽的分子质量：$M_v = 18.01528\\,\\mathrm{g\\,mol^{-1}}$\n- 干空气的平均分子质量：$M_d = 28.9647\\,\\mathrm{g\\,mol^{-1}}$\n\n将这些值代入推导出的公式中：\n$$q = \\frac{(1.42 \\times 10^{-2}) \\times (18.01528)}{(1.42 \\times 10^{-2}) \\times (18.01528) + (1 - 1.42 \\times 10^{-2}) \\times (28.9647)}$$\n首先，计算各项：\n$$1 - 1.42 \\times 10^{-2} = 1 - 0.0142 = 0.9858$$\n分子：\n$$1.42 \\times 10^{-2} \\times 18.01528 = 0.255816976$$\n分母：\n$$ (0.255816976) + (0.9858 \\times 28.9647) = 0.255816976 + 28.55243346 = 28.808250436 $$\n现在，计算比率：\n$$q = \\frac{0.255816976}{28.808250436} \\approx 0.0088800160$$\n分子质量单位（$\\mathrm{g\\,mol^{-1}}$）被消掉，使 $q$ 成为一个无量纲的质量分数，符合要求。问题要求将结果四舍五入到四位有效数字。前四位有效数字是 $8$、$8$、$8$ 和 $0$。第五位有效数字是 $0$，所以我们舍去。\n$$q \\approx 0.008880$$\n该值表示以 $\\mathrm{kg\\,kg^{-1}}$ 为单位的比湿质量分数。",
            "answer": "$$\\boxed{0.008880}$$"
        },
        {
            "introduction": "除了简单的转换，理解湿度变量如何影响气块的热力学状态也至关重要。本练习  探讨了关键模型变量比湿 ($q$) 与水汽密度 ($\\rho_v$) 之间的关系，后者是给定体积内水质量的直接度量。此外，您将深入研究灵敏度分析，这是一个评估湿度测量不确定性如何传播到派生物理量中的重要工具。",
            "id": "4052471",
            "problem": "一个湿空气块的特征由总压 $p$、绝对温度 $T$ 和比湿 $q$ 描述，其中比湿 $q$ 定义为单位质量湿空气中水汽的质量。将湿空气视为干空气和水汽的二元理想气体混合物。组分理想气体定律为 $p_{d} = \\rho_{d} R_{d} T$ 和 $e = \\rho_{v} R_{v} T$，其中 $p_{d}$ 是干空气的分压，$e$ 是水汽的分压（水汽压），$\\rho_{d}$ 和 $\\rho_{v}$ 分别是干空气和水汽的质量密度，$R_{d}$ 和 $R_{v}$ 分别是干空气和水汽的比气体常数。总压满足 $p = p_{d} + e$。从这些定义和定律出发，推导水汽质量密度 $\\rho_{v}$ 作为 $(p, T, q)$ 和常数的函数的闭式表达式。然后，将 $q$ 视为不确定量并保持 $(p, T)$ 不变，推导一阶相对灵敏度 $S = \\frac{d \\ln \\rho_{v}}{d \\ln q}$，该灵敏度将 $q$ 的微小相对误差映射到 $\\rho_{v}$ 的相对误差。\n\n最后，对于一个典型的对流层低层条件，$q = 0.012$（潮湿空气的代表值），使用 $R_{d} = 287.0$ J kg$^{-1}$ K$^{-1}$ 和 $R_{v} = 461.5$ J kg$^{-1}$ K$^{-1}$，计算 $S$ 的值。将 $S$ 的最终结果表示为一个无量纲数，并四舍五入到四位有效数字。",
            "solution": "该问题被验证为具有科学依据、问题明确且客观。它基于既定的大气热力学原理，并包含了获得唯一解所需的所有信息。\n\n第一个任务是推导水汽质量密度 $\\rho_{v}$ 作为总压 $p$、绝对温度 $T$ 和比湿 $q$ 的函数的闭式表达式。我们从比湿 $q$ 的定义开始：\n$$q = \\frac{m_v}{m_{moist}} = \\frac{m_v}{m_d + m_v}$$\n其中 $m_v$ 是水汽的质量，$m_d$ 是在给定体积 $V$ 的湿空气中干空气的质量。将分子和分母同除以体积 $V$，我们可以用质量密度表示 $q$：\n$$q = \\frac{\\rho_v}{\\rho_d + \\rho_v}$$\n其中 $\\rho_v = m_v/V$ 且 $\\rho_d = m_d/V$。\n\n问题给出了两种组分的理想气体定律：\n$$p_d = \\rho_d R_d T$$\n$$e = \\rho_v R_v T$$\n以及道尔顿分压定律：\n$$p = p_d + e$$\n其中 $p_d$ 和 $e$ 分别是干空气和水汽的分压，$R_d$ 和 $R_v$ 是它们的比气体常数。\n\n我们的目标是把 $\\rho_v$ 表示为 $(p, T, q)$ 的函数。根据 $q$ 的定义，我们可以用 $\\rho_v$ 和 $q$ 来表示 $\\rho_d$：\n$$q(\\rho_d + \\rho_v) = \\rho_v \\implies q\\rho_d = \\rho_v(1-q) \\implies \\rho_d = \\rho_v \\frac{1-q}{q}$$\n现在我们将密度的理想气体定律表达式代入：\n$$\\frac{p_d}{R_d T} = \\frac{e}{R_v T} \\frac{1-q}{q}$$\n温度 $T$ 被消掉了：\n$$p_d = e \\frac{R_d}{R_v} \\frac{1-q}{q}$$\n将这个 $p_d$ 的表达式代入道尔顿定律 $p = p_d + e$：\n$$p = e \\frac{R_d}{R_v} \\frac{1-q}{q} + e = e \\left( \\frac{R_d(1-q)}{q R_v} + 1 \\right) = e \\left( \\frac{R_d(1-q) + q R_v}{q R_v} \\right)$$\n现在我们求解水汽压 $e$：\n$$e = \\frac{p q R_v}{(1-q)R_d + q R_v}$$\n最后，我们将这个 $e$ 的表达式代入水汽的理想气体定律 $\\rho_v = e / (R_v T)$：\n$$\\rho_v = \\frac{1}{R_v T} \\left( \\frac{p q R_v}{(1-q)R_d + q R_v} \\right)$$\n$$\\rho_v(p, T, q) = \\frac{p q}{T((1-q)R_d + q R_v)}$$\n这就是所求的 $\\rho_v$ 的闭式表达式。\n\n第二个任务是推导一阶相对灵敏度 $S = \\frac{d \\ln \\rho_{v}}{d \\ln q}$，并保持 $(p, T)$ 不变。微分关系 $d(\\ln x) = \\frac{dx}{x}$ 允许我们将灵敏度写为：\n$$S = \\frac{d \\ln \\rho_v}{d \\ln q} = \\frac{q}{\\rho_v} \\frac{\\partial \\rho_v}{\\partial q}$$\n使用对数处理更为方便。对 $\\rho_v$ 的表达式取自然对数：\n$$\\ln \\rho_v = \\ln p + \\ln q - \\ln T - \\ln((1-q)R_d + q R_v)$$\n现在我们对 $q$ 求导，保持 $p$ 和 $T$ 恒定：\n$$\\frac{\\partial (\\ln \\rho_v)}{\\partial q} = \\frac{1}{q} - \\frac{1}{(1-q)R_d + q R_v} \\frac{\\partial}{\\partial q}((1-q)R_d + q R_v)$$\n分母项的导数是：\n$$\\frac{\\partial}{\\partial q}(R_d - q R_d + q R_v) = -R_d + R_v = R_v - R_d$$\n将其代回，我们得到：\n$$\\frac{\\partial (\\ln \\rho_v)}{\\partial q} = \\frac{1}{q} - \\frac{R_v - R_d}{(1-q)R_d + q R_v}$$\n灵敏度 $S$ 是通过对数导数定义的，可以表示为 $S = q \\frac{\\partial (\\ln \\rho_v)}{\\partial q}$：\n$$S = q \\left( \\frac{1}{q} - \\frac{R_v - R_d}{(1-q)R_d + q R_v} \\right) = 1 - \\frac{q(R_v - R_d)}{(1-q)R_d + q R_v}$$\n为了简化，我们将各项通分：\n$$S = \\frac{((1-q)R_d + q R_v) - q(R_v - R_d)}{(1-q)R_d + q R_v}$$\n$$S = \\frac{R_d - q R_d + q R_v - q R_v + q R_d}{(1-q)R_d + q R_v}$$\n$$S = \\frac{R_d}{(1-q)R_d + q R_v}$$\n这就是灵敏度 $S$ 的最终符号表达式。\n\n第三个任务是使用给定值计算 $S$：$q = 0.012$，$R_d = 287.0 \\, \\text{J kg}^{-1} \\, \\text{K}^{-1}$，以及 $R_v = 461.5 \\, \\text{J kg}^{-1} \\, \\text{K}^{-1}$。\n将这些值代入 $S$ 的表达式中：\n$$S = \\frac{287.0}{(1-0.012) \\times 287.0 + 0.012 \\times 461.5}$$\n首先，我们计算分母中的各项：\n$$1 - q = 1 - 0.012 = 0.988$$\n$$(1-q)R_d = 0.988 \\times 287.0 = 283.556$$\n$$q R_v = 0.012 \\times 461.5 = 5.538$$\n分母是这两项之和：\n$$283.556 + 5.538 = 289.094$$\n现在，我们进行最后的除法运算：\n$$S = \\frac{287.0}{289.094} \\approx 0.9927566...$$\n按要求将结果四舍五入到四位有效数字：\n$$S \\approx 0.9928$$\n灵敏度 $S$ 是一个无量纲数。",
            "answer": "$$\\boxed{0.9928}$$"
        },
        {
            "introduction": "水的相变是天气和气候的核心，它们由饱和水汽压 ($e_s$) 控制。虽然克劳修斯-克拉佩龙关系为饱和过程提供了物理基础，但数值模型通常采用计算成本较低的经验公式。这个高级练习  让您扮演模型开发者的角色，任务是为 $e_s$ 实现一个基于物理推导的基准，并用它来严格评估业务天气预报中常用参数化方案的准确性。",
            "id": "4052489",
            "problem": "你需要实现并评估用于计算饱和水汽压的经验公式，该公式是温度的函数，并将其与一个通过积分形式的克劳修斯-克拉佩龙关系获得的物理推导基准进行比较。重点是与数值天气预报 (NWP) 相关的湿度变量和混合比。你的程序必须计算经验公式与基准之间的误差度量，并以严格指定的格式报告结果。\n\n从以下基本依据开始：\n\n1. 针对液态水上饱和水汽压的克劳修斯-克拉佩龙 (CC) 微分形式为\n$$\\frac{d \\ln e_s}{dT} = \\frac{L_v(T)}{R_v T^2},$$\n其中 $e_s$ 是饱和水汽压，$T$ 是绝对温度，$L_v(T)$ 是随温度变化的蒸发潜热，而 $R_v$ 是水汽的比气体常数。\n\n2. 对潜热使用温度线性近似，\n$$L_v(T) = L_{v,0} - \\lambda \\left(T - T_0\\right),$$\n其中 $L_{v,0} = 2.501\\times 10^6$ $\\mathrm{J\\,kg^{-1}}$，$\\lambda = 2.37\\times 10^3$ $\\mathrm{J\\,kg^{-1}\\,K^{-1}}$，且 $T_0 = 273.15$ $\\mathrm{K}$。\n\n3. 使用在 $T_0$ 时液态水上的参考饱和水汽压，\n$$e_s(T_0) = 611.2\\ \\mathrm{Pa}.$$\n\n4. 水汽的比气体常数为\n$$R_v = 461.5\\ \\mathrm{J\\,kg^{-1}\\,K^{-1}},$$\n干空气气体常数与水汽气体常数的比值为\n$$\\varepsilon = \\frac{R_d}{R_v} = \\frac{287.05}{461.5}.$$\n\n你的基准 $e_s(T)$ 必须通过积分上述克劳修斯-克拉佩龙形式来计算，并与给定的 $L_v(T)$ 和 $e_s(T_0)$ 保持一致。你可以使用任何数学上正确且遵循所述基本依据的方法进行积分。\n\n实现以下两个关于液态水上饱和水汽压的经验公式，它们是摄氏温度的函数：\n\n- Tetens 公式（气象学中常用）：\n$$e_s^{\\mathrm{Tetens}}(T_C) = 6.1078 \\times \\exp\\left(\\frac{17.2694\\, T_C}{T_C + 237.3}\\right)\\ \\mathrm{hPa},$$\n需乘以 $100$ 转换为帕斯卡。\n\n- Magnus 公式（Alduchov 和 Eskridge 的水上常数）：\n$$e_s^{\\mathrm{Magnus}}(T_C) = 6.1094 \\times \\exp\\left(\\frac{17.625\\, T_C}{T_C + 243.04}\\right)\\ \\mathrm{hPa},$$\n需乘以 $100$ 转换为帕斯卡。\n\n对于给定的总压 $p$，将液态水上的饱和混合比定义为\n$$r_s(T, p) = \\varepsilon \\frac{e_s(T)}{p - e_s(T)},$$\n其单位为 $\\mathrm{kg\\,kg^{-1}}$，是无量纲的。\n\n对于每个经验公式，在均匀的温度网格上计算相对于基准的以下误差度量：\n\n- 饱和水汽压的相对均方根误差，\n$$\\mathrm{RMSE}_e = \\sqrt{\\frac{1}{N}\\sum_{i=1}^{N} \\left(\\frac{|e_s^{\\mathrm{emp}}(T_i) - e_s^{\\mathrm{base}}(T_i)|}{e_s^{\\mathrm{base}}(T_i)}\\right)^2},$$\n以及最大相对误差，\n$$\\mathrm{MAX}_e = \\max_{i=1,\\ldots,N}\\left(\\frac{|e_s^{\\mathrm{emp}}(T_i) - e_s^{\\mathrm{base}}(T_i)|}{e_s^{\\mathrm{base}}(T_i)}\\right).$$\n\n- 在指定压力 $p$ 下饱和混合比的相对均方根误差，\n$$\\mathrm{RMSE}_r = \\sqrt{\\frac{1}{N}\\sum_{i=1}^{N} \\left(\\frac{|r_s^{\\mathrm{emp}}(T_i, p) - r_s^{\\mathrm{base}}(T_i, p)|}{r_s^{\\mathrm{base}}(T_i, p)}\\right)^2},$$\n以及最大相对误差，\n$$\\mathrm{MAX}_r = \\max_{i=1,\\ldots,N}\\left(\\frac{|r_s^{\\mathrm{emp}}(T_i, p) - r_s^{\\mathrm{base}}(T_i, p)|}{r_s^{\\mathrm{base}}(T_i, p)}\\right).$$\n\n输入给基准的所有温度必须是开尔文（K），转换公式为 $T = T_C + 273.15$，所有压力必须是帕斯卡（Pa）。饱和水汽压 $e_s$ 必须以帕斯卡为单位计算。饱和混合比 $r_s$ 应报告为无量纲量，单位是 $\\mathrm{kg\\,kg^{-1}}$。所有角度都与本问题无关。\n\n测试套件：\n为以下四个测试用例实现计算。每个测试用例是一个元组 $(T_C^{\\min}, T_C^{\\max}, N, p, \\mathrm{formula})$：\n\n1. 用例 1：$(-20.0, 35.0, 111, 100000.0, \\text{\"tetens\"})$。\n2. 用例 2：$(-40.0, 50.0, 181, 85000.0, \\text{\"magnus\"})$。\n3. 用例 3：$(-60.0, -20.0, 81, 50000.0, \\text{\"tetens\"})$。\n4. 用例 4：$(30.0, 60.0, 61, 70000.0, \\text{\"magnus\"})$。\n\n对于每个用例，在 $T_C^{\\min}$ 和 $T_C^{\\max}$（包含边界）之间构建一个包含 $N$ 个点的均匀摄氏温度网格，将其转换为开尔文用于基准计算，并计算上述四种指定的度量。\n\n最终输出格式：\n你的程序应生成单行输出，该输出包含一个由四个列表组成的列表，每个内部列表对应一个测试用例，并按上述顺序列出。每个内部列表必须包含四个浮点数 $[\\mathrm{RMSE}_e, \\mathrm{MAX}_e, \\mathrm{RMSE}_r, \\mathrm{MAX}_r]$，每个浮点数四舍五入到八位小数，且整个输出必须作为单个 Python 列表字面量打印，例如，\n$$[\\,[x_1, x_2, x_3, x_4],\\,[y_1, y_2, y_3, y_4],\\,[z_1, z_2, z_3, z_4],\\,[w_1, w_2, w_3, w_4]\\,].$$\n所有计算量中，饱和水汽压 $e_s$ 的单位必须是 $\\mathrm{Pa}$，饱和混合比 $r_s$ 的单位必须是 $\\mathrm{kg\\,kg^{-1}}$，温度在内部处理时，基准计算使用 $\\mathrm{K}$，经验公式中指定使用 $\\mathrm{^\\circ C}$。将最终的浮点数报告为小数点后有八位数字的小数。",
            "solution": "The problem is assessed as valid and will be solved as follows.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- **Clausius-Clapeyron (CC) Relation**: $\\frac{d \\ln e_s}{dT} = \\frac{L_v(T)}{R_v T^2}$, for saturation vapor pressure $e_s$ over liquid water as a function of absolute temperature $T$.\n- **Latent Heat of Vaporization**: A linear-in-temperature approximation is given by $L_v(T) = L_{v,0} - \\lambda (T - T_0)$.\n- **Physical Constants**:\n    - $L_{v,0} = 2.501\\times 10^6\\ \\mathrm{J\\,kg^{-1}}$\n    - $\\lambda = 2.37\\times 10^3\\ \\mathrm{J\\,kg^{-1}\\,K^{-1}}$\n    - $T_0 = 273.15\\ \\mathrm{K}$\n    - $e_s(T_0) = 611.2\\ \\mathrm{Pa}$ (reference saturation vapor pressure at $T_0$)\n    - $R_v = 461.5\\ \\mathrm{J\\,kg^{-1}\\,K^{-1}}$ (specific gas constant for water vapor)\n    - $\\varepsilon = \\frac{R_d}{R_v} = \\frac{287.05}{461.5}$ (ratio of gas constants for dry air and water vapor)\n- **Empirical Formulas for $e_s$ (in hPa, for temperature $T_C$ in Celsius)**:\n    - **Tetens**: $e_s^{\\mathrm{Tetens}}(T_C) = 6.1078 \\times \\exp\\left(\\frac{17.2694\\, T_C}{T_C + 237.3}\\right)$\n    - **Magnus**: $e_s^{\\mathrm{Magnus}}(T_C) = 6.1094 \\times \\exp\\left(\\frac{17.625\\, T_C}{T_C + 243.04}\\right)$\n    - Note: Results to be converted to Pascals by multiplying by $100$.\n- **Saturation Mixing Ratio**: $r_s(T, p) = \\varepsilon \\frac{e_s(T)}{p - e_s(T)}$, for total pressure $p$.\n- **Error Metrics**:\n    - $\\mathrm{RMSE}_e = \\sqrt{\\frac{1}{N}\\sum_{i=1}^{N} \\left(\\frac{|e_s^{\\mathrm{emp}}(T_i) - e_s^{\\mathrm{base}}(T_i)|}{e_s^{\\mathrm{base}}(T_i)}\\right)^2}$\n    - $\\mathrm{MAX}_e = \\max_{i}\\left(\\frac{|e_s^{\\mathrm{emp}}(T_i) - e_s^{\\mathrm{base}}(T_i)|}{e_s^{\\mathrm{base}}(T_i)}\\right)$\n    - $\\mathrm{RMSE}_r = \\sqrt{\\frac{1}{N}\\sum_{i=1}^{N} \\left(\\frac{|r_s^{\\mathrm{emp}}(T_i, p) - r_s^{\\mathrm{base}}(T_i, p)|}{r_s^{\\mathrm{base}}(T_i, p)}\\right)^2}$\n    - $\\mathrm{MAX}_r = \\max_{i}\\left(\\frac{|r_s^{\\mathrm{emp}}(T_i, p) - r_s^{\\mathrm{base}}(T_i, p)|}{r_s^{\\mathrm{base}}(T_i, p)}\\right)$\n- **Test Suite**: Four cases, each defined by a tuple $(T_C^{\\min}, T_C^{\\max}, N, p, \\mathrm{formula})$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded (Critical)**: The problem is fundamentally rooted in thermodynamics, using the Clausius-Clapeyron relation. The constants, empirical formulas (Tetens, Magnus), and derived quantities like saturation mixing ratio are all standard and widely used in atmospheric science and numerical weather prediction. The problem is scientifically sound and realistic.\n- **Well-Posed**: The problem is fully specified. It provides a differential equation, a boundary condition ($e_s(T_0)$), and all necessary constants to derive a unique baseline function $e_s(T)$. The empirical formulas and error metrics are explicitly defined. The test cases provide all necessary inputs.\n- **Objective (Critical)**: The problem statement is written in precise, quantitative terms. The task is a formal computational comparison, devoid of any subjectivity or ambiguity.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be developed.\n\n### Solution Derivation and Algorithmic Design\n\nThe core of the problem is to establish a high-fidelity baseline for saturation vapor pressure, $e_s^{\\mathrm{base}}(T)$, by integrating the Clausius-Clapeyron equation, and then to compare it against two common empirical formulas.\n\n**1. Baseline Saturation Vapor Pressure, $e_s^{\\mathrm{base}}(T)$**\n\nWe start with the differential form:\n$$ \\frac{d \\ln e_s}{dT} = \\frac{L_v(T)}{R_v T^2} $$\nSubstitute the given linear approximation for $L_v(T) = L_{v,0} - \\lambda(T - T_0) = (L_{v,0} + \\lambda T_0) - \\lambda T$:\n$$ \\frac{d \\ln e_s}{dT} = \\frac{(L_{v,0} + \\lambda T_0) - \\lambda T}{R_v T^2} = \\frac{L_{v,0} + \\lambda T_0}{R_v} \\frac{1}{T^2} - \\frac{\\lambda}{R_v} \\frac{1}{T} $$\nWe integrate this expression from the reference state $(T_0, e_s(T_0))$ to an arbitrary state $(T, e_s(T))$:\n$$ \\int_{e_s(T_0)}^{e_s(T)} d\\ln e_s' = \\int_{T_0}^{T} \\left( \\frac{L_{v,0} + \\lambda T_0}{R_v} \\frac{1}{T'^2} - \\frac{\\lambda}{R_v} \\frac{1}{T'} \\right) dT' $$\nThe left side integrates to $\\ln e_s(T) - \\ln e_s(T_0) = \\ln\\left(\\frac{e_s(T)}{e_s(T_0)}\\right)$.\nThe right side integrates to:\n$$ \\left[ \\frac{L_{v,0} + \\lambda T_0}{R_v} \\left(-\\frac{1}{T'}\\right) - \\frac{\\lambda}{R_v} \\ln T' \\right]_{T_0}^{T} $$\n$$ = \\frac{L_{v,0} + \\lambda T_0}{R_v} \\left(\\frac{1}{T_0} - \\frac{1}{T}\\right) - \\frac{\\lambda}{R_v} \\left(\\ln T - \\ln T_0\\right) $$\nSetting the two sides equal and solving for $e_s(T)$ yields the baseline formula:\n$$ e_s^{\\mathrm{base}}(T) = e_s(T_0) \\exp\\left[ \\frac{L_{v,0} + \\lambda T_0}{R_v} \\left(\\frac{1}{T_0} - \\frac{1}{T}\\right) - \\frac{\\lambda}{R_v} \\ln\\left(\\frac{T}{T_0}\\right) \\right] $$\nThis equation will be implemented to calculate the baseline saturation vapor pressure for a given temperature $T$ in Kelvin.\n\n**2. Empirical Formulas and Mixing Ratio**\n\nThe two empirical formulas for $e_s(T_C)$ take temperature $T_C$ in Celsius and yield pressure in hectopascals (hPa). They must be converted to Pascals (Pa) for consistency.\n$$ T = T_C + 273.15 $$\n$$ e_s^{\\mathrm{emp, Pa}} = e_s^{\\mathrm{emp, hPa}} \\times 100 $$\nThe saturation mixing ratio, $r_s$, is calculated for both baseline and empirical $e_s$ values using the provided formula and total pressure $p$:\n$$ r_s(T, p) = \\varepsilon \\frac{e_s(T)}{p - e_s(T)} $$\n\n**3. Error Calculation**\n\nThe error metrics $\\mathrm{RMSE}_e$, $\\mathrm{MAX}_e$, $\\mathrm{RMSE}_r$, and $\\mathrm{MAX}_r$ are computed as specified in the problem statement. This involves calculating the relative error at each point on the temperature grid and then applying the root-mean-square and maximum operations.\n\n**4. Algorithmic Procedure**\n\nThe solution will be implemented in Python using the `numpy` library for efficient vectorized computations. The overall algorithm is as follows:\n\n1.  Define all physical constants given in the problem statement ($L_{v,0}$, $\\lambda$, $T_0$, $e_s(T_0)$, $R_v$, $\\varepsilon$).\n2.  Implement a function `e_s_baseline(T_K)` that computes the baseline saturation vapor pressure using the derived analytical formula for an array of temperatures in Kelvin.\n3.  Implement functions `e_s_tetens(T_C)` and `e_s_magnus(T_C)` for the empirical formulas, including the conversion from hPa to Pa, for an array of temperatures in Celsius.\n4.  Implement a function `r_s(e_s, p)` which calculates the saturation mixing ratio for given arrays of saturation vapor pressure and a scalar total pressure.\n5.  Iterate through the four test cases provided in the `Test Suite`. For each case $(T_C^{\\min}, T_C^{\\max}, N, p, \\mathrm{formula})$:\n    a. Generate a grid of $N$ temperatures $T_C$ from $T_C^{\\min}$ to $T_C^{\\max}$ inclusive.\n    b. Convert the $T_C$ grid to Kelvin, $T_K$.\n    c. Calculate the baseline values $e_s^{\\mathrm{base}}$ and $r_s^{\\mathrm{base}}$ over the grid.\n    d. Based on the `formula` string, select the appropriate empirical function and calculate the empirical values $e_s^{\\mathrm{emp}}$ and $r_s^{\\mathrm{emp}}$.\n    e. Compute the relative error arrays for $e_s$ and $r_s$: e.g., `rel_err_e = |e_s_emp - e_s_base| / e_s_base`.\n    f. Compute the four metrics: $\\mathrm{RMSE}_e$, $\\mathrm{MAX}_e$, $\\mathrm{RMSE}_r$, and $\\mathrm{MAX}_r$. For example, `RMSE_e = np.sqrt(np.mean(rel_err_e**2))`.\n    g. Store the four computed metrics as a list of floating-point numbers.\n6.  Collect the results from all four test cases into a master list.\n7.  Format the final list of lists into the required string format, ensuring each numerical result is represented with eight digits after the decimal point, and print to standard output.",
            "answer": "```\n[[0.00109903, 0.00222049, 0.00114002, 0.00236166],[0.00030588, 0.00100723, 0.00034633, 0.00122940],[0.00486005, 0.01015694, 0.00486161, 0.01016140],[0.00094775, 0.00137357, 0.00124806, 0.00216738]]\n```"
        }
    ]
}