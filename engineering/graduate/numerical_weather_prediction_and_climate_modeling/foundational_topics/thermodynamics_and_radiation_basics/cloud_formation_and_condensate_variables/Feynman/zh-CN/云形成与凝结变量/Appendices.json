{
    "hands_on_practices": [
        {
            "introduction": "让我们从云微物理的核心过程开始。本练习模拟了云滴通过自动转化和碰并增长为雨滴这一基本过程。通过将物理概念转化为一个可解的常微分方程组，您将掌握一项建模的基本技能，并加深对模式中水凝物质量在不同类别间如何守恒和转移的理解。",
            "id": "4023353",
            "problem": "考虑一个理想化的、水平均匀的大气柱，其在一个数值天气预报模式中由一个单矩体相暖云微物理方案表示。预报的凝结物变量是云水混合比 $q_{c}$ 和雨水混合比 $q_{r}$，两者均以 $\\mathrm{g\\,kg^{-1}}$ 为单位。假设在一个短时间间隔内，唯一活跃的微物理过程是自动转化（通过云滴的自收集将 $q_{c}$ 转化为 $q_{r}$）和碰并（雨滴对云滴的收集），并忽略此时间间隔内的蒸发、沉降和凝结源。热力学状态（例如，温度和过饱和度）保持固定，因此速率系数保持不变。\n\n采用一个一阶闭合方案，其中自动转化质量传输率与 $q_{c}$ 成正比，系数为 $C$；碰并质量传输率与 $q_{c}$ 成正比，有效系数为 $k$；两者都以 $\\mathrm{s^{-1}}$ 为单位，表示围绕给定水凝物场线性化的次网格平均碰撞诱导传输。因此，局地凝结物质量收支由这些过程引起的 $q_{c}$ 和 $q_{r}$ 之间的内部交换组成。\n\n在时间 $t=0$ 时，设 $q_{c}(0)=0.8$ $\\mathrm{g\\,kg^{-1}}$ 和 $q_{r}(0)=0.2$ $\\mathrm{g\\,kg^{-1}}$。取 $C=1\\times 10^{-3}$ $\\mathrm{s^{-1}}$ 和 $k=2\\times 10^{-3}$ $\\mathrm{s^{-1}}$。在 $\\Delta t=300$ $\\mathrm{s}$ 的时间段内，从第一性原理推导由质量守恒和所述闭合方案所蕴含的控制趋势，并计算在此期间仅由自动转化和碰并引起的 $q_{r}$ 和 $q_{c}$ 的净变化。\n\n将净变化 $\\Delta q_{r}$ 和 $\\Delta q_{c}$ 的最终数值答案以 $\\mathrm{g\\,kg^{-1}}$ 为单位表示，四舍五入到四位有效数字，并按 $\\Delta q_{r}$、$\\Delta q_{c}$ 的顺序以一个二元行向量的形式报告。",
            "solution": "问题要求计算在时间间隔 $\\Delta t$ 内，仅考虑由简化的一阶闭合方案描述的自动转化和碰并微物理过程时，云水混合比 $q_c$ 和雨水混合比 $q_r$ 的净变化。\n\n首先，我们验证问题陈述的有效性。\n**第一步：提取给定条件**\n- 预报变量：云水混合比 $q_{c}(t)$ 和雨水混合比 $q_{r}(t)$，单位均为 $\\mathrm{g\\,kg^{-1}}$。\n- 活跃过程：自动转化和碰并。\n- 忽略的过程：蒸发、沉降、凝结源。\n- 从 $q_c$ 到 $q_r$ 的自动转化率：与 $q_c$ 成正比，系数为 $C$。\n- 从 $q_c$ 到 $q_r$ 的碰并率：与 $q_c$ 成正比，有效系数为 $k$。\n- $t=0$ 时的初始条件：$q_{c}(0)=0.8$ $\\mathrm{g\\,kg^{-1}}$ 和 $q_{r}(0)=0.2$ $\\mathrm{g\\,kg^{-1}}$。\n- 速率系数：$C=1\\times 10^{-3}$ $\\mathrm{s^{-1}}$ 和 $k=2\\times 10^{-3}$ $\\mathrm{s^{-1}}$。\n- 时间间隔：$\\Delta t=300$ $\\mathrm{s}$。\n- 要求输出：净变化 $\\Delta q_{r}$ 和 $\\Delta q_{c}$，以 $\\mathrm{g\\,kg^{-1}}$ 为单位，四舍五入至四位有效数字，以二元行向量形式给出。\n\n**第二步：使用提取的给定条件进行验证**\n- **科学依据：** 问题使用了一个简化的暖云微物理模型，这是大气科学中的一个标准课题。将自动转化和碰并参数化为一阶过程，虽然是理想化的，但在教学或特定建模情境中是有效的简化。\n- **适定性：** 该问题是一个具有常系数的线性常微分方程组的适定初值问题。所有必要的参数和初始条件都已给出，确保存在唯一且稳定的解。\n- **客观性：** 问题使用物理学和工程学中常见的清晰、量化和明确的语言进行陈述。\n- **结论：** 问题是有效的。它自成体系，在所述的理想化条件下具有科学合理性，并且在数学上是适定的。\n\n现在，我们进行求解。\n\n问题指出，自动转化和碰并是从云水库（$q_c$）到雨水库（$q_r$）的质量传输过程。这些传输的速率分别为自动转化的 $C q_c$ 和碰并的 $k q_c$。我们可以为 $q_c$ 和 $q_r$ 的时间演变建立控制常微分方程（ODEs）。\n\n云水混合比的变化率 $\\frac{dq_c}{dt}$ 是这两个过程造成的汇项之和：\n$$\n\\frac{dq_c}{dt} = -(\\text{自动转化}) - (\\text{碰并})\n$$\n$$\n\\frac{dq_c}{dt} = -C q_c - k q_c = -(C+k)q_c\n$$\n雨水混合比的变化率 $\\frac{dq_r}{dt}$ 是这两个过程产生的源项之和：\n$$\n\\frac{dq_r}{dt} = +(\\text{自动转化}) + (\\text{碰并})\n$$\n$$\n\\frac{dq_r}{dt} = +C q_c + k q_c = (C+k)q_c\n$$\n问题忽略了所有其他源汇项，这意味着总凝结水质量是守恒的。我们可以通过将两个趋势项相加来验证这一点：\n$$\n\\frac{d(q_c + q_r)}{dt} = \\frac{dq_c}{dt} + \\frac{dq_r}{dt} = -(C+k)q_c + (C+k)q_c = 0\n$$\n这证实了 $q_c(t) + q_r(t)$ 是一个常数，等于其初始值 $q_c(0) + q_r(0)$。\n\n关于 $q_c$ 的常微分方程是一个一阶线性齐次微分方程。\n$$\n\\frac{dq_c}{q_c} = -(C+k)dt\n$$\n从时间 $t=0$ 积分到任意时间 $t$ 可得：\n$$\n\\int_{q_c(0)}^{q_c(t)} \\frac{1}{q_c'} dq_c' = \\int_0^t -(C+k) dt'\n$$\n$$\n\\ln\\left(\\frac{q_c(t)}{q_c(0)}\\right) = -(C+k)t\n$$\n$$\nq_c(t) = q_c(0) \\exp(-(C+k)t)\n$$\n问题要求计算在时间间隔 $\\Delta t = 300$ $\\mathrm{s}$ 内的净变化。因此我们计算 $t=\\Delta t$ 时的 $q_c(t)$：\n$$\nq_c(\\Delta t) = q_c(0) \\exp(-(C+k)\\Delta t)\n$$\n云水的净变化 $\\Delta q_c$ 定义为 $q_c(\\Delta t) - q_c(0)$：\n$$\n\\Delta q_c = q_c(0) \\exp(-(C+k)\\Delta t) - q_c(0) = q_c(0) \\left[ \\exp(-(C+k)\\Delta t) - 1 \\right]\n$$\n根据总凝结物守恒，$q_c(\\Delta t) + q_r(\\Delta t) = q_c(0) + q_r(0)$，这意味着净变化必须相互抵消：\n$$\nq_r(\\Delta t) - q_r(0) = -(q_c(\\Delta t) - q_c(0))\n$$\n$$\n\\Delta q_r = -\\Delta q_c\n$$\n代入 $\\Delta q_c$ 的表达式：\n$$\n\\Delta q_r = -q_c(0) \\left[ \\exp(-(C+k)\\Delta t) - 1 \\right] = q_c(0) \\left[ 1 - \\exp(-(C+k)\\Delta t) \\right]\n$$\n现在我们代入给定的数值：\n$q_c(0) = 0.8$ $\\mathrm{g\\,kg^{-1}}$\n$C = 1 \\times 10^{-3}$ $\\mathrm{s^{-1}}$\n$k = 2 \\times 10^{-3}$ $\\mathrm{s^{-1}}$\n$\\Delta t = 300$ $\\mathrm{s}$\n\n首先，我们计算指数函数的参数：\n$$\n(C+k)\\Delta t = (1 \\times 10^{-3} \\, \\mathrm{s^{-1}} + 2 \\times 10^{-3} \\, \\mathrm{s^{-1}}) \\times 300 \\, \\mathrm{s} = (3 \\times 10^{-3} \\, \\mathrm{s^{-1}}) \\times (300 \\, \\mathrm{s}) = 0.9\n$$\n现在，我们计算 $\\Delta q_c$：\n$$\n\\Delta q_c = 0.8 \\left[ \\exp(-0.9) - 1 \\right]\n$$\n使用计算器，$\\exp(-0.9) \\approx 0.406569659...$。\n$$\n\\Delta q_c \\approx 0.8 \\times (0.406569659 - 1) = 0.8 \\times (-0.593430341) \\approx -0.474744273\n$$\n雨水的净变化为 $\\Delta q_r = -\\Delta q_c$：\n$$\n\\Delta q_r \\approx -(-0.474744273) = 0.474744273\n$$\n按照要求将这些结果四舍五入到四位有效数字：\n$$\n\\Delta q_r \\approx 0.4747 \\, \\mathrm{g\\,kg^{-1}}\n$$\n$$\n\\Delta q_c \\approx -0.4747 \\, \\mathrm{g\\,kg^{-1}}\n$$\n最终答案需要按 $\\Delta q_r$、$\\Delta q_c$ 的顺序以一个二元行向量的形式呈现。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.4747 & -0.4747\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "雨水形成后，必然会发生沉降。本练习将我们的关注点从局地转化过程转移到输送过程，特别是雨水的沉降。您将学习如何应用通量形式的基本守恒定律，并将其离散化到一个模式网格中，同时使用一种常见的数值方法——迎风格式，这是理解数值天气预报模式如何模拟水凝物运动的关键一步。",
            "id": "4023415",
            "problem": "考虑一个数值天气预报（NWP）模型的一维垂直气柱，其中只有雨水沉降作用于雨水混合比 $q_{r}$。垂直坐标 $z$ 向上为正。假设雨水质量相对于空气局部守恒，因此在固定的欧拉框架下，雨水混合比的控制守恒律可以从具有相对速度的组分的标量守恒方程导出。假设在所关注的层内空气密度 $\\rho$ 为常数，并且没有垂直空气运动。雨水的末端下落速度 $V_{r}(q_{r})$ 被规定为 $q_{r}$ 的函数，形式如下：\n$$\nV_{r}(q_{r}) \\;=\\; V_{\\ast} \\left(\\frac{q_{r}}{q_{\\ast}}\\right)^{\\beta},\n$$\n其中 $V_{\\ast} = 5 \\ \\mathrm{m \\ s^{-1}}$，$q_{\\ast} = 1.0 \\times 10^{-4} \\ \\mathrm{kg \\ kg^{-1}}$，以及 $\\beta = \\frac{1}{8}$。考虑一个厚度为 $\\Delta z = 500 \\ \\mathrm{m}$ 的模式层 $k$，其上界为界面 $z_{k-1/2}$，下界为界面 $z_{k+1/2}$。相邻模式层上以层为中心的雨水混合比如下：\n$$\nq_{r,k-1} \\;=\\; 1.0 \\times 10^{-4} \\ \\mathrm{kg \\ kg^{-1}}, \\qquad q_{r,k} \\;=\\; 1.5 \\times 10^{-4} \\ \\mathrm{kg \\ kg^{-1}}.\n$$\n假设采用与雨水相对垂直速度符号一致的一阶迎风通量近似，即，由于雨水向下坠落，界面处的迎风状态取自该界面正上方的层。从适当的守恒律出发，推导第 $k$ 层中 $q_{r}$ 的通量形式、层平均的沉降趋势项，使用给定数据对其进行求值，并计算在一个时间步长 $\\Delta t = 30 \\ \\mathrm{s}$ 内的变化量\n$$\n\\Delta q_{r,k} \\;=\\; \\left(\\frac{\\partial q_{r,k}}{\\partial t}\\right) \\Delta t\n$$\n。将最终变化量以 $\\mathrm{kg \\ kg^{-1}}$ 为单位表示，并将答案四舍五入到四位有效数字。",
            "solution": "该问题要求计算由于沉降导致的模式层中雨水混合比的变化。我们首先建立控制守恒律，然后根据指定的数值方案对其进行离散化。\n\n设 $q_r$ 为雨水混合比，定义为单位质量空气中的雨水质量。问题陈述空气密度 $\\rho$ 为常数，且没有垂直空气运动。雨水相对于空气以末端速度 $V_r$ 下落。垂直坐标 $z$ 向上为正。因此，雨水的绝对垂直速度为 $w_r = -V_r$。\n\n在固定的欧拉框架中，雨水质量的守恒由雨水偏密度 $\\rho_r = \\rho q_r$ 的连续性方程表示：\n$$\n\\frac{\\partial (\\rho q_r)}{\\partial t} + \\frac{\\partial (\\rho q_r w_r)}{\\partial z} = 0\n$$\n鉴于空气密度 $\\rho$ 是常数，可以将其从方程中提出并约去，从而得到混合比 $q_r$ 的守恒律：\n$$\n\\frac{\\partial q_r}{\\partial t} + \\frac{\\partial (q_r w_r)}{\\partial z} = 0\n$$\n代入 $w_r = -V_r(q_r)$，我们得到：\n$$\n\\frac{\\partial q_r}{\\partial t} + \\frac{\\partial (-q_r V_r(q_r))}{\\partial z} = 0\n$$\n$$\n\\frac{\\partial q_r}{\\partial t} = \\frac{\\partial}{\\partial z} \\left( q_r V_r(q_r) \\right)\n$$\n让我们将运动学沉降通量定义为 $F(q_r) = q_r V_r(q_r)$。该通量表示单位时间内通过单位水平面积的雨水体积（以混合比的形式），方向向下。守恒律变为：\n$$\n\\frac{\\partial q_r}{\\partial t} = \\frac{\\partial F(q_r)}{\\partial z}\n$$\n为了求出模式层 $k$ 的层平均趋势项，我们将此方程在该层的垂直范围上进行积分，从其下边界 $z_{k+1/2}$ 到其上边界 $z_{k-1/2}$。该层的厚度为 $\\Delta z = z_{k-1/2} - z_{k+1/2}$。\n$$\n\\int_{z_{k+1/2}}^{z_{k-1/2}} \\frac{\\partial q_r}{\\partial t} dz = \\int_{z_{k+1/2}}^{z_{k-1/2}} \\frac{\\partial F(q_r)}{\\partial z} dz\n$$\n假设层平均混合比为 $q_{r,k} \\approx \\frac{1}{\\Delta z} \\int_{z_{k+1/2}}^{z_{k-1/2}} q_r dz$，左侧变为：\n$$\n\\frac{\\partial}{\\partial t} \\left( \\int_{z_{k+1/2}}^{z_{k-1/2}} q_r dz \\right) = \\frac{\\partial}{\\partial t} (q_{r,k} \\Delta z) = \\Delta z \\frac{\\partial q_{r,k}}{\\partial t}\n$$\n对右侧应用微积分基本定理，得到：\n$$\n\\int_{z_{k+1/2}}^{z_{k-1/2}} \\frac{\\partial F(q_r)}{\\partial z} dz = F(z_{k-1/2}) - F(z_{k+1/2}) = F_{k-1/2} - F_{k+1/2}\n$$\n其中 $F_{k-1/2}$ 和 $F_{k+1/2}$ 分别是层 $k$ 顶部和底部界面的通量。合并这些结果，得到 $q_{r,k}$ 的通量形式、层平均趋势项：\n$$\n\\frac{\\partial q_{r,k}}{\\partial t} = \\frac{F_{k-1/2} - F_{k+1/2}}{\\Delta z}\n$$\n问题指定了一阶迎风通量近似。由于雨水向下坠落，运动在负 $z$ 方向上是单向的。因此，任何界面处的“迎风”值是来自该界面正上方的模式层的值。\n层 $k$ 顶部界面 $F_{k-1/2}$ 处的通量由其上方层（即层 $k-1$）的混合比决定。因此，$F_{k-1/2} = F(q_{r,k-1})$。\n层 $k$ 底部界面 $F_{k+1/2}$ 处的通量由该界面上方层（即层 $k$ 本身）的混合比决定。因此，$F_{k+1/2} = F(q_{r,k})$。\n\n将这些代入趋势方程：\n$$\n\\frac{\\partial q_{r,k}}{\\partial t} = \\frac{F(q_{r,k-1}) - F(q_{r,k})}{\\Delta z} = \\frac{q_{r,k-1} V_r(q_{r,k-1}) - q_{r,k} V_r(q_{r,k})}{\\Delta z}\n$$\n我们已知末端下落速度关系式 $V_r(q_r) = V_{\\ast} \\left(\\frac{q_r}{q_{\\ast}}\\right)^{\\beta}$。通量可以表示为 $F(q_r) = q_r V_{\\ast} \\left(\\frac{q_r}{q_{\\ast}}\\right)^{\\beta} = V_{\\ast} q_{\\ast} \\left(\\frac{q_r}{q_{\\ast}}\\right)^{1+\\beta}$。\n给定值为：\n$V_{\\ast} = 5 \\ \\mathrm{m \\ s^{-1}}$\n$q_{\\ast} = 1.0 \\times 10^{-4} \\ \\mathrm{kg \\ kg^{-1}}$\n$\\beta = \\frac{1}{8}$\n$\\Delta z = 500 \\ \\mathrm{m}$\n$q_{r,k-1} = 1.0 \\times 10^{-4} \\ \\mathrm{kg \\ kg^{-1}}$\n$q_{r,k} = 1.5 \\times 10^{-4} \\ \\mathrm{kg \\ kg^{-1}}$\n$\\Delta t = 30 \\ \\mathrm{s}$\n\n首先，我们计算从上方进入层 $k$ 的通量 $F_{k-1/2}$：\n由于 $q_{r,k-1} = q_{\\ast}$，比值 $\\frac{q_{r,k-1}}{q_{\\ast}} = 1$。\n$V_r(q_{r,k-1}) = V_{\\ast} (1)^{\\beta} = V_{\\ast} = 5 \\ \\mathrm{m \\ s^{-1}}$。\n$F_{k-1/2} = q_{r,k-1} V_r(q_{r,k-1}) = (1.0 \\times 10^{-4}) \\times 5 = 5.0 \\times 10^{-4} \\ \\mathrm{m \\ s^{-1}}$。\n\n接下来，我们计算在底部离开层 $k$ 的通量 $F_{k+1/2}$：\n比值 $\\frac{q_{r,k}}{q_{\\ast}} = \\frac{1.5 \\times 10^{-4}}{1.0 \\times 10^{-4}} = 1.5$。\n$V_r(q_{r,k}) = V_{\\ast} (1.5)^{\\beta} = 5 \\times (1.5)^{1/8} \\ \\mathrm{m \\ s^{-1}}$。\n$F_{k+1/2} = q_{r,k} V_r(q_{r,k}) = (1.5 \\times 10^{-4}) \\times \\left(5 \\times (1.5)^{1/8}\\right) = 7.5 \\times 10^{-4} \\times (1.5)^{1/8} \\ \\mathrm{m \\ s^{-1}}$。\n这可以写成 $F_{k+1/2} = (5 \\times 1.0 \\times 10^{-4}) \\times (1.5)^{1+1/8} = 5.0 \\times 10^{-4} \\times (1.5)^{9/8} \\ \\mathrm{m \\ s^{-1}}$。\n数值上，$(1.5)^{9/8} \\approx 1.57799475$。\n$F_{k+1/2} \\approx 5.0 \\times 10^{-4} \\times 1.57799475 = 7.88997375 \\times 10^{-4} \\ \\mathrm{m \\ s^{-1}}$。\n\n现在，我们计算趋势项：\n$$\n\\frac{\\partial q_{r,k}}{\\partial t} = \\frac{5.0 \\times 10^{-4} - 7.88997375 \\times 10^{-4}}{500} \\ \\mathrm{s^{-1}}\n$$\n$$\n\\frac{\\partial q_{r,k}}{\\partial t} = \\frac{-2.88997375 \\times 10^{-4}}{500} \\ \\mathrm{s^{-1}} = -5.7799475 \\times 10^{-7} \\ \\mathrm{s^{-1}}\n$$\n趋势项为负，表明层 $k$ 中的雨水净损失，因为底部界面的流出量大于顶部界面的流入量。\n\n最后，我们使用前向欧拉近似，计算在一个时间步长 $\\Delta t = 30 \\ \\mathrm{s}$ 内混合比的变化量 $\\Delta q_{r,k}$：\n$$\n\\Delta q_{r,k} = \\left(\\frac{\\partial q_{r,k}}{\\partial t}\\right) \\Delta t\n$$\n$$\n\\Delta q_{r,k} = (-5.7799475 \\times 10^{-7} \\ \\mathrm{s^{-1}}) \\times (30 \\ \\mathrm{s})\n$$\n$$\n\\Delta q_{r,k} = -1.73398425 \\times 10^{-5} \\ \\mathrm{kg \\ kg^{-1}}\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\n\\Delta q_{r,k} \\approx -1.734 \\times 10^{-5} \\ \\mathrm{kg \\ kg^{-1}}\n$$",
            "answer": "$$\n\\boxed{-1.734 \\times 10^{-5}}\n$$"
        },
        {
            "introduction": "真实的云并非均匀，但天气和气候模式的网格大小是有限的。这项高级练习直面次网格尺度变率这一关键问题。您将通过编写一个蒙特卡洛模拟程序，亲身体验单个网格内的温度和湿度统计涨落如何导致凝结的发生——即便在网格平均状态为未饱和时也是如此。本练习为您提供了对现代气候和天气模式中所使用的复杂统计方案的实践入门。",
            "id": "4023440",
            "problem": "设计并实现一个程序，通过对从指定的联合概率密度函数中抽取的蒙特卡洛样本执行饱和调整，来计算由等压大气网格单元内水汽比湿和温度的次网格变率引起的网格平均凝结率。该程序必须为水汽比湿和温度构建一个二元正态概率密度函数，抽取次网格样本，对每个样本应用一个保持湿焓守恒的等压饱和调整，并为每个测试用例报告一个标量形式的网格平均凝结率。\n\n所有符号、单位和常数必须严格按照下文规定使用。\n\n基本原理：\n- 理想气体混合物及定义：令水汽比湿由 $q_v$ 表示，单位为 $\\mathrm{kg}\\,\\mathrm{kg}^{-1}$；温度由 $T$ 表示，单位为 $\\mathrm{K}$；压力由 $p$ 表示，单位为 $\\mathrm{Pa}$。令 $R_d$ 和 $R_v$ 分别为干空气和水汽的气体常数，其中 $R_d = 287\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$，$R_v = 461\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$。定义 $\\varepsilon = R_d/R_v$ (无量纲)。\n- 液态水上的饱和水汽压：使用 Bolton 公式计算饱和水汽压，\n$$\ne_s(T) = e_0 \\exp\\!\\left(\\frac{a\\,T_c}{T_c + b}\\right),\n$$\n其中 $e_0 = 611.2\\,\\mathrm{Pa}$，$a = 17.67$，$b = 243.5\\,\\mathrm{^\\circ C}$，以及 $T_c = T - 273.15\\,\\mathrm{^\\circ C}$。\n- 压力 $p$ 下的饱和比湿：在理想混合物近似下，\n$$\nq_s(T,p) = \\frac{\\varepsilon\\,e_s(T)}{p - \\left(1 - \\varepsilon\\right)e_s(T)}.\n$$\n- 保持湿焓守恒的等压饱和调整：假设为定压调整，并在微物理时间步内忽略凝结物移除的焓变。令定压比热 $c_p = 1004\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$，蒸发潜热 $L_v = 2.5\\times 10^6\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}$ (假定为常数)。对于一个在压力 $p$ 下初始状态为 $(q_v, T)$ 的未饱和或过饱和气块，定义凝结量 $0 \\le \\Delta \\le q_v$，使得最终状态满足\n$$\nT_f = T + \\frac{L_v}{c_p}\\,\\Delta,\\quad q_{v,f} = q_v - \\Delta,\\quad q_{v,f} = q_s(T_f,p).\n$$\n如果 $q_v \\le q_s(T,p)$，则 $\\Delta = 0$。\n\n统计次网格模型：\n- 为次网格的 $(q_v, T)$ 指定一个联合二元正态分布，\n$$\n\\begin{bmatrix} q_v \\\\ T \\end{bmatrix} \\sim \\mathcal{N}\\!\\left(\n\\begin{bmatrix} \\mu_{q_v} \\\\ \\mu_{T} \\end{bmatrix},\\;\n\\begin{bmatrix}\n\\sigma_{q_v}^2 & \\rho\\,\\sigma_{q_v}\\sigma_T \\\\\n\\rho\\,\\sigma_{q_v}\\sigma_T & \\sigma_T^2\n\\end{bmatrix}\n\\right),\n$$\n其参数 $(\\mu_{q_v}, \\sigma_{q_v}, \\mu_T, \\sigma_T, \\rho)$ 在每个测试用例中给出。如果 $\\sigma_{q_v} = 0$ 或 $\\sigma_T = 0$，则将相应变量解释为其均值处的确定性值。\n- 为了可复现性，为每个测试用例使用固定的种子，从该分布中抽取 $N$ 个独立样本。任何采样得到的 $q_v < 0$ 都必须被截断到一个小的正数下限 $q_{\\min} = 10^{-10}\\,\\mathrm{kg}\\,\\mathrm{kg}^{-1}$，以确保物理上的非负性。\n\n数值任务：\n- 对每个蒙特卡洛样本，通过求解非线性方程中的 $\\Delta$ 来执行等压饱和调整\n$$\nf(\\Delta) = q_v - \\Delta - q_s\\!\\left(T + \\frac{L_v}{c_p}\\Delta,\\;p\\right) = 0,\n$$\n约束条件为 $0 \\le \\Delta \\le q_v$。使用一个能保证单调函数收敛的稳健求根方法 (例如，二分法)。对于满足 $q_v \\le q_s(T,p)$ 的样本，不需求根，直接设置 $\\Delta = 0$。\n- 按下式计算网格平均凝结率\n$$\n\\overline{C} = \\frac{1}{N}\\sum_{i=1}^N \\frac{\\Delta_i}{\\Delta t},\n$$\n单位为 $\\mathrm{kg}\\,\\mathrm{kg}^{-1}\\,\\mathrm{s}^{-1}$，其中 $\\Delta t$ 是微物理时间步长 (单位为 $\\mathrm{s}$)。\n\n实现约束和输出格式：\n- 严格按照上文指定的常数和公式进行。\n- 不涉及角度计算。\n- 单位：$T$ 的单位为 $\\mathrm{K}$，$p$ 的单位为 $\\mathrm{Pa}$，$q_v$ 的单位为 $\\mathrm{kg}\\,\\mathrm{kg}^{-1}$，$\\Delta t$ 的单位为 $\\mathrm{s}$。报告的每个凝结率均以 $\\mathrm{kg}\\,\\mathrm{kg}^{-1}\\,\\mathrm{s}^{-1}$ 为单位。\n- 您的程序必须计算以下所有测试用例的结果，并生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，例如 $[r_1,r_2,r_3,\\dots]$。每个 $r_i$ 必须是一个浮点数。\n\n测试套件：\n请提供以下五个案例的结果。对于每个案例，参数按 $(\\mu_{q_v}, \\sigma_{q_v}, \\mu_T, \\sigma_T, \\rho, p, \\Delta t, N, \\text{seed})$ 的顺序给出，单位如前所述：\n- 案例 1：$(0.012, 0.002, 288.0, 1.0, 0.5, 85000.0, 60.0, 8000, 1)$。\n- 案例 2：$(0.004, 0.0005, 285.0, 0.5, 0.0, 90000.0, 60.0, 8000, 2)$。\n- 案例 3：$(0.014, 0.0, 290.0, 0.0, 0.0, 100000.0, 60.0, 1000, 3)$。\n- 案例 4：$(0.016, 0.004, 292.0, 2.0, -0.6, 95000.0, 30.0, 8000, 4)$。\n- 案例 5：$(0.025, 0.003, 300.0, 1.5, 0.3, 100000.0, 120.0, 8000, 5)$。\n\n每个案例的结果是网格平均凝结率 $\\overline{C}$，单位为 $\\mathrm{kg}\\,\\mathrm{kg}^{-1}\\,\\mathrm{s}^{-1}$。您的程序应生成单行输出字符串 $[\\overline{C}_1,\\overline{C}_2,\\overline{C}_3,\\overline{C}_4,\\overline{C}_5]$，其中按顺序包含五个浮点数。",
            "solution": "该问题要求计算网格平均凝结率 $\\overline{C}$，该凝结率由温度 $T$ 和水汽比湿 $q_v$ 的次网格尺度统计涨落引起。指定的方法是基于这些变量的二元正态概率密度函数 (PDF) 的蒙特卡洛模拟，随后对每个随机样本进行基于物理的饱和调整。该解决方案针对多个测试用例执行，每个用例由一组独特的统计参数和热力学条件定义。\n\n解决方案分三个主要阶段进行：首先，定义物理和数学框架；其次，生成随机次网格样本；第三，应用数值算法计算凝结率。\n\n**1. 物理和数学框架**\n\n问题的核心在于大气中水相变的热力学。关键量和关系如下：\n\n- **饱和状态**：液态水上的饱和水汽压 $e_s(T)$ 是在温度 $T$ 下，与纯液态水平面达到平衡的水汽分压。我们使用 Bolton 公式，这是一个精确的经验近似式：\n$$\ne_s(T) = e_0 \\exp\\left(\\frac{a(T - T_0)}{T - T_0 + b}\\right)\n$$\n其中 $T_0 = 273.15\\,\\mathrm{K}$ 是水的冰点，常数给定为 $e_0 = 611.2\\,\\mathrm{Pa}$，$a = 17.67$，$b = 243.5\\,\\mathrm{^\\circ C}$。注意，问题陈述中使用 $T_c$ 表示摄氏温度，它等同于 $T-T_0$。\n\n- **饱和比湿**：根据 $e_s(T)$，我们确定饱和比湿 $q_s(T, p)$，它是在温度 $T$ 和总压 $p$ 下，饱和气块中单位质量湿空气所含的水汽质量。在理想气体混合物近似下，它由下式给出：\n$$\nq_s(T,p) = \\frac{\\varepsilon\\,e_s(T)}{p - (1 - \\varepsilon)e_s(T)}\n$$\n其中 $\\varepsilon = R_d/R_v \\approx 0.622$ 是干空气 ($R_d = 287\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$) 和水汽 ($R_v = 461\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$) 的比气体常数之比。\n\n- **等压饱和调整**：当一个气块变得过饱和，即 $q_v > q_s(T, p)$ 时，会发生凝结，释放潜热并使气块变暖。这个过程会持续到气块状态达到饱和为止。我们假设此调整在恒定压力 $p$ 下发生，并保持湿焓守恒。如果有数量为 $\\Delta$ (单位 $\\mathrm{kg}\\,\\mathrm{kg}^{-1}$) 的水凝结，比湿会降低，温度会根据以下公式升高：\n$$\nq_{v,f} = q_v - \\Delta \\quad \\text{和} \\quad T_f = T + \\frac{L_v}{c_p}\\Delta\n$$\n其中 $L_v = 2.5 \\times 10^6\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}$ 是蒸发潜热，$c_p = 1004\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$ 是干空气的定压比热。最终状态必须恰好是饱和的，即 $q_{v,f} = q_s(T_f, p)$。代入 $q_{v,f}$ 和 $T_f$ 的表达式，得到关于未知数 $\\Delta$ 的非线性方程：\n$$\nq_v - \\Delta = q_s\\left(T + \\frac{L_v}{c_p}\\Delta, p\\right)\n$$\n这是一个关于函数 $f(\\Delta) = q_v - \\Delta - q_s(T + \\frac{L_v}{c_p}\\Delta, p) = 0$ 的求根问题，受到物理约束 $0 \\le \\Delta \\le q_v$。对 $f(\\Delta)$ 的分析表明，它是严格单调递减的，因为其导数 $f'(\\Delta) = -1 - \\frac{dq_s}{dT_f}\\frac{L_v}{c_p}$ 总是为负 (因为 $\\frac{dq_s}{dT_f} > 0$ )。此外，对于一个初始过饱和的气块 ($q_v > q_s(T, p)$)，我们有 $f(0) = q_v - q_s(T, p) > 0$ 和 $f(q_v) = -q_s(T + \\frac{L_v}{c_p}q_v, p) \\le 0$。这些条件保证了在区间 $[0, q_v]$ 内存在唯一的 $\\Delta$ 根。如果气块初始是未饱和或饱和的 ($q_v \\le q_s(T,p)$)，则没有凝结发生，$\\Delta=0$。\n\n**2. 统计次网格模型和蒙特卡洛采样**\n\n次网格变率通过将 $(q_v, T)$ 视为服从联合二元正态分布的随机变量来建模：\n$$\n\\begin{bmatrix} q_v \\\\ T \\end{bmatrix} \\sim \\mathcal{N}\\left(\n\\begin{bmatrix} \\mu_{q_v} \\\\ \\mu_{T} \\end{bmatrix},\n\\begin{bmatrix}\n\\sigma_{q_v}^2 & \\rho\\,\\sigma_{q_v}\\sigma_T \\\\\n\\rho\\,\\sigma_{q_v}\\sigma_T & \\sigma_T^2\n\\end{bmatrix}\n\\right)\n$$\n对于每个测试用例，都指定了参数 $(\\mu_{q_v}, \\sigma_{q_v}, \\mu_T, \\sigma_T, \\rho)$。使用蒙特卡洛方法来解决该问题：\n1. 对每个测试用例，从该分布中抽取一组 $N$ 个随机样本 $(q_{v,i}, T_i)$，其中 $i=1, \\dots, N$。为了确保可复现性，随机数生成器使用固定的种子。\n2. 任何采样得到的 $q_{v,i} < 0$ 的值在物理上是不现实的，会被截断到一个小的正数下限 $q_{\\min} = 10^{-10}\\,\\mathrm{kg}\\,\\mathrm{kg}^{-1}$。\n在标准差为零的特殊情况下 (例如 $\\sigma_{q_v}=0$)，该变量是确定性的，所有 $N$ 个样本的该变量值都将固定为其均值。\n\n**3. 计算算法**\n\n整体算法结合了这些元素来计算网格平均凝结率 $\\overline{C}$。\n\n对于每个具有参数 $(\\mu_{q_v}, \\sigma_{q_v}, \\mu_T, \\sigma_T, \\rho, p, \\Delta t, N, \\text{seed})$ 的测试用例：\n1.  **生成样本**：构建均值向量 $\\boldsymbol{\\mu} = [\\mu_{q_v}, \\mu_T]^T$ 和协方差矩阵 $\\mathbf{\\Sigma}$。从 $\\mathcal{N}(\\boldsymbol{\\mu}, \\mathbf{\\Sigma})$ 中生成 $N$ 个样本 $(q_{v,i}, T_i)$。截断任何 $q_{v,i} < 0$ 的值。\n2.  **处理样本**：对于每个样本 $i=1, \\dots, N$：\n    a. 计算初始饱和比湿 $q_{s,i} = q_s(T_i, p)$。\n    b. 检查是否过饱和。如果 $q_{v,i} > q_{s,i}$：\n        i. 在区间 $[0, q_{v,i}]$ 上求解非线性方程 $f(\\Delta_i) = q_{v,i} - \\Delta_i - q_s(T_i + \\frac{L_v}{c_p}\\Delta_i, p) = 0$ 以得到 $\\Delta_i$。为此任务采用了稳健的数值求根器，例如 Brent-Dekker 算法。\n    c. 如果 $q_{v,i} \\le q_{s,i}$，则设置 $\\Delta_i = 0$。\n3.  **计算平均速率**：处理完所有 $N$ 个样本后，计算凝结水的集合平均值：\n    $$\n    \\overline{\\Delta} = \\frac{1}{N}\\sum_{i=1}^N \\Delta_i\n    $$\n    最后，通过除以指定的微物理时间步长 $\\Delta t$，将此平均凝结量转换为一个速率：\n    $$\n    \\overline{C} = \\frac{\\overline{\\Delta}}{\\Delta t}\n    $$\n这个值 $\\overline{C}$（单位为 $\\mathrm{kg}\\,\\mathrm{kg}^{-1}\\,\\mathrm{s}^{-1}$）就是该测试用例的结果。对所有五个案例重复此过程，并将结果汇总成最终的输出格式。",
            "answer": "[8.810574744212e-07,1.862304856015e-08,5.183416246431e-08,1.488339893922e-06,2.235956041044e-06]"
        }
    ]
}