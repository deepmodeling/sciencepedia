## 引言
云的形成是地球大气系统中最核心且最复杂的过程之一。从日常天气变化到全球气候的长期演变，云通过其对[辐射平衡](@entry_id:1130505)、[水循环](@entry_id:144834)和潜热释放的深刻影响，扮演着至关重要的角色。然而，云的物理过程发生在远小于天气和气候模型网格的微观尺度上，这给准确模拟其行为带来了巨大挑战。理解并准确地将这些微观物理过程（如水滴和冰晶的诞生与成长）转化为宏观模型能够处理的[参数化](@entry_id:265163)形式，是现代大气科学面临的关键难题。本文旨在系统性地解决这一挑战。我们将从第一章“原理与机制”开始，深入剖析云形成背后的[热力学](@entry_id:172368)和微物理学基础，并介绍如何在数值模式中定义和预报[水凝物](@entry_id:1126277)变量。接着，在第二章“应用与交叉学科联系”中，我们将展示这些基本原理如何被应用于天气预报、气候模拟、[气溶胶-云相互作用](@entry_id:1120855)研究以及遥感数据解译等前沿领域。最后，在第三章“动手实践”中，您将有机会通过具体的编程练习，将理论知识转化为解决实际问题的能力，从而全面掌握云过程建模的核心技术。

## 原理与机制

本章深入探讨了云形成的核心原理，以及如何在模式中表示[水凝物](@entry_id:1126277)变量。我们将从定义用于描述水在不同相态下的基本[状态变量](@entry_id:138790)开始，然后探讨相变所需的[热力学](@entry_id:172368)条件、粒子成核和增长的微物理机制，最后介绍用于模拟这些复杂过程的[预报方程](@entry_id:1130221)和数值方法。

### 大气[水凝物](@entry_id:1126277)的基本变量

为了在数值模式中定量地表示云和降水，我们必须首先定义一套变量来描述水的各种形态的数量和性质。现代大气模式采用 **体相微物理方案 (bulk microphysics schemes)**，这种方案不追踪单个云粒子，而是预测一个网格单元内整个[水凝物](@entry_id:1126277)群体的总体属性。这些属性通常表示为粒子尺度[分布的矩](@entry_id:156454)。

最基本的变量是 **比湿 (specific humidity)**，记为 $q_x$，它表示特定水物质 $x$ 的质量与单位质量湿空气的质量之比。其单位通常为 $\mathrm{kg}\,\mathrm{kg}^{-1}$。这些物质根据相态和大小进行分类，包括：
- $q_v$: 水汽 (water vapor)
- $q_c$: 云水 (cloud liquid water, 小液滴)
- $q_r$: 雨水 (rain water, 大液滴)
- $q_i$: 云冰 (cloud ice, 小冰晶)
- $q_s$: 雪 (snow, 较大的冰晶聚合体)
- $q_g$: 霰 (graupel or hail, 密实的淞化冰粒子)

物质 $x$ 的比湿的正式定义为 $q_x \equiv \rho_x / \rho$，其中 $\rho_x$ 是物质 $x$ 的分密度（单位体积内 $x$ 的质量），$\rho$ 是湿空气的总密度 。

虽然[比湿](@entry_id:1132076)描述了总质量，但它没有提供关于粒子数量或大小的信息。为了增加更多细节，许多方案还考虑了每种凝结物 $y \in \{c, r, i, s, g\}$ 的 **粒子数浓度 (particle number concentration)** $N_y$。这个变量表示单位体积空气中给定种类粒子的总数，单位通常是 $\mathrm{m}^{-3}$。它是粒子尺度[分布函数](@entry_id:145626) $n_y(D)$ 对所有粒子直径 $D$ 积分得到的零阶矩：
$$
N_y \equiv \int_0^{\infty} n_y(D)\, \mathrm{d}D
$$
比湿 $q_y$ 与同一分布的三阶矩成正比。

体相微物理方案的复杂性通常根据其为每个[水凝物](@entry_id:1126277)类别预测的矩的数量来分类。在这种背景下，区分 **预报变量 (prognostic variables)** 和 **诊断变量 (diagnostic variables)** 至关重要 。预报变量是模式通过其自身的演变方程明确地随时间推进的变量。相比之下，诊断变量是在每个时间步中根据预报变量和其他[参数化](@entry_id:265163)关系代数计算出来的。

- **单矩 (single-moment)** 方案为每个物种只预测一个矩，按惯例是[比湿](@entry_id:1132076) ($q_y$)。在这种方案中，$q_y$ 是预报变量。所有其他属性，如数浓度 $N_y$，必须被诊断得出，通常是通过假设一个固定的粒子尺度分布形状（例如，Gamma分布），其参数根据经验与 $q_y$ 相关联。

- **双矩 (two-moment)** 方案为每个物种预测两个矩。最常见的选择是同时预报[比湿](@entry_id:1132076) ($q_y$) 和数浓度 ($N_y$)。这允许对粒子尺度分布进行更灵活、更真实的表示，因为总质量和粒子总数可以独立演变。

例如，一个混合方案可能使用单[矩方法](@entry_id:277025)处理暖雨过程（预报 $q_c$ 和 $q_r$，诊断 $N_c$ 和 $N_r$），同时对冰相过程使用更复杂的双[矩方法](@entry_id:277025)（预报 $q_i, N_i, q_s, N_s, q_g, N_g$）。水汽 ($q_v$) 始终被视为一个核心的预报变量，因为它的演变对模式的动力和[热力学](@entry_id:172368)至关重要 。

### 相变的热力学原理

云粒子的形成本质上是水汽向液态或固态的[相变过程](@entry_id:147919)，受热力学定律支配。其核心概念是 **饱和 (saturation)**。

**饱和水汽压 (saturation vapor pressure)** $e_s(T)$ 是在给定温度 $T$ 下，与凝结相（液态水或冰）的平坦表面处于[热力学平衡](@entry_id:141660)状态的水汽[分压](@entry_id:168927)。它只是温度的一个强[非线性](@entry_id:637147)函数。这种关系由 **[克劳修斯-克拉佩龙方程](@entry_id:1122419) (Clausius–Clapeyron relation)** 描述 ：
$$
\frac{d\ln e_s}{dT}=\frac{L}{R_v T^2}
$$
这里，$R_v$ 是水汽的比气体常数，$L$ 是相变的潜热。关键是，潜热取决于相态。对于汽-液相变，我们使用汽化潜热 $L_v$。对于汽-固相变，我们使用[升华潜热](@entry_id:187184) $L_s$。通过从一个已知的参考点（例如，[水的三相点](@entry_id:141589)，$T_0 = 273.15\,\mathrm{K}$）积分这个方程，我们可以在任何温度下找到饱和水汽压。

一个关键的推论是，在低于[三相点](@entry_id:142815)的温度下（$T  T_0$），[过冷液态水](@entry_id:1132638)的饱和水汽压 $e_{sl}(T)$ 大于冰的饱和水汽压 $e_{si}(T)$。这是因为 $L_s > L_v$（因为 $L_s = L_v + L_f$，其中 $L_f$ 是[熔化潜热](@entry_id:144988)）。这个压差 $e_{sl}(T) - e_{si}(T)$ 是我们稍后将讨论的韦格纳-贝吉龙-芬德森过程的[热力学驱动力](@entry_id:1133063) 。

在大气模式中，使用[比湿](@entry_id:1132076)比使用分压更方便。因此，我们定义 **饱和[比湿](@entry_id:1132076) (saturation specific humidity)** $q_s(T, p)$，即饱和气块中水汽的[比湿](@entry_id:1132076)。它是温度 $T$（通过 $e_s(T)$）和总气压 $p$ 的函数：
$$
q_s(T, p) = \frac{\epsilon \, e_s(T)}{p - (1 - \epsilon) e_s(T)}
$$
其中 $\epsilon = R_d/R_v \approx 0.622$ 是干空气和水汽的比气体常数之比。在模式中，当实际水汽[比湿](@entry_id:1132076) $q_v$ 超过相关相态的饱和比湿 $q_s$ 时，就会引发凝结或凝华。这种 $q_v > q_s$ 的状态被称为 **[过饱和](@entry_id:200794) (supersaturation)**。例如，在一个温度为 $T=268\,\mathrm{K}$ 的[混合相云](@entry_id:1127959)模式中，饱和度调节可能是相对于冰进行的。如果一个气块的状态使其 $q_v$ 大于冰面饱和比湿 $q_{si}(T,p)$，即使该气块相对于液态水是次饱和的（即 $q_v  q_{sl}(T,p)$），冰晶也会形成 。

### 成核作用：云凝物粒子的诞生

[过饱和](@entry_id:200794)为相变提供了[热力学驱动力](@entry_id:1133063)，但一个新的液滴或冰晶的实际形成——这个过程被称为 **成核 (nucleation)**——必须克服一个能量障碍。

#### 液滴的形成（暖云）

液滴形成存在两种理论途径：

1.  **同质[核化](@entry_id:262547) (Homogeneous Nucleation)**: 通过水分子的随机碰撞直接从水汽中自发形成纯水滴。[经典成核理论](@entry_id:138144)表明，形成一个新液滴的曲面需要大量能量（与表面张力有关）。为了克服这个能量障碍，需要极高的过饱和度——在典型的对流层温度下，大约需要几百个百分点。这种情况在地球低层大气中几乎从未出现，那里的峰值过饱和度很少超过 1% 。因此，液态水的同质[核化](@entry_id:262547)对于大气云的形成不是一个重要过程。

2.  **异质[核化](@entry_id:262547) (Heterogeneous Nucleation)**: 在预先存在的气溶胶颗粒表面上形成液滴，这种颗粒被称为 **云凝结核 (Cloud Condensation Nucleus, CCN)**。CCN的存在极大地降低了能量障碍。这个过程由 **[科勒理论](@entry_id:1126986) (Köhler theory)** 描述，它综合了两种相互竞争的效应：
    -   **曲率效应 (Curvature Effect)**: 由[开尔文关系](@entry_id:147784)描述，该效应指出，由于表面张力，小液滴的曲面比平坦表面需要更高的环境蒸汽压来维持平衡。这种效应阻碍液滴生长。
    -   **溶质效应 (Solute Effect)**: 由[拉乌尔定律](@entry_id:139880)描述，该效应指出，溶解在水中的溶质会降低液滴的平衡蒸汽压。这种效应促进凝结。

科勒方程关于溶液滴上平衡过饱和度 $s$ 和半径 $r$ 的近似形式为：
$$
s(r) \approx \frac{A}{r} - \frac{B}{r^3}
$$
其中，$A/r$ 项代表曲率效应（$A$ 取决于表面张力和温度），$B/r^3$ 项代表溶质效应（$B$ 取决于溶质的数量和吸湿性，通常用参数 $\kappa$ 表示）。

这个方程揭示了一个关键的能量障碍。对于给定的CCN，存在一个 **[临界半径](@entry_id:142431) (critical radius)** $r_c$ 和一个相应的 **[临界过饱和度](@entry_id:1123211) (critical supersaturation)** $s_c$。如果环境[过饱和](@entry_id:200794)度超过这个 $s_c$，CCN就被称为 **活化 (activated)**，并可以自由地生长成云滴。对于典型的大气气溶胶，这些[临界过饱和度](@entry_id:1123211)在 0.1% 到 1% 的范围内，这与云中观测到的[过饱和](@entry_id:200794)度完全一致。因此，异质[核化](@entry_id:262547)是暖云形成中占绝对主导地位的途径 。CCN属性和[临界过饱和度](@entry_id:1123211)之间的关系可以推导为 $s_c \approx \sqrt{4A^3 / (27 \kappa r_d^3)}$，其中 $r_d$ 是气溶胶颗粒的干半径 。在模式中，气溶胶和云之间的联系是通过 **CCN谱 (CCN spectrum)** $N_{\mathrm{CCN}}(S_w)$ 建立的，它指定了在给定水面过饱和度 $S_w$ 或更低时活化的气溶胶颗粒的累积数量 。

#### 冰晶的形成（冷云和[混合相云](@entry_id:1127959)）

冰晶的形成比液滴活化更复杂，且人们对其了解较少。它也通过异质方式在一种特殊的气溶胶子集上发生，称为 **冰核 (Ice Nuclei, IN)** 或冰成核颗粒 (INPs)。INP的效率是温度和颗粒性质的强函数。与CCN谱类似，**IN谱 (IN spectrum)** $N_{\mathrm{IN}}(T,S_i)$ 被用来[参数化](@entry_id:265163)作为温度和冰面[过饱和](@entry_id:200794)度函数的活化冰核数量 。异质冰成核有四个主要途径：

1.  **凝华[核化](@entry_id:262547) (Deposition Nucleation)**: 水汽直接在INP表面沉积为冰。这通常要求空气相对于冰是[过饱和](@entry_id:200794)的（$S_i > 1$），但可以在相对于液态水是次饱和的（$S_w  1$）情况下发生。

2.  **凝结-冻结[核化](@entry_id:262547) (Condensation-Freezing)**: 水滴首先在INP上凝结（要求 $S_w > 1$），然后不久之后冻结。

3.  **浸润冻结[核化](@entry_id:262547) (Immersion Freezing)**: 一个已经浸没在过冷液滴中的INP触发冻结。这是[混合相云](@entry_id:1127959)中的一个主导机制。

4.  **接触冻结[核化](@entry_id:262547) (Contact Freezing)**: 一个过冷液滴在与环境中的INP碰撞时冻结。

这些不同的途径对温度和[过饱和](@entry_id:200794)度有不同的依赖性，它们的相对重要性随大气条件而变化 。

### 微物理过程：凝结物的增长和相互作用

一旦成核，云粒子通过各种微物理过程生长和相互作用。这些过程可以大致分为[扩散过程](@entry_id:268015)（与蒸汽场的相互作用）和[碰并](@entry_id:1122642)过程（粒子间的相互作用）。

#### 扩散增长和蒸发/[升华](@entry_id:139006)

粒子通过水汽分子向其表面或从其表面扩散而生长或收缩。这个过程由环境水汽压和[粒子平衡](@entry_id:753197)水汽压之间的差异驱动。

-   **凝结/凝华 (Condensation/Deposition)**: 当空气过饱和时 ($q_v > q_s$)，水汽向粒子扩散，导致液滴通过凝结生长或冰晶通过凝华生长。凝华过程释放[升华潜热](@entry_id:187184) ($L_s$)，并直接将质量从水汽相转移到冰相 ($q_v \to q_i$) 。

-   **蒸发/升华 (Evaporation/Sublimation)**: 当空气次饱和时 ($q_v  q_s$)，水从粒子表面扩散出去，导致它们收缩。蒸发消耗液态水，而升华消耗冰。升华需要能量，从环境中吸收[升华潜热](@entry_id:187184) ($L_s$)，并将质量从冰转移到水汽 ($q_i \to q_v$) 。

在[混合相云](@entry_id:1127959)（同时含有[过冷液体](@entry_id:158222)和冰）中，一个特别重要的[扩散过程](@entry_id:268015)是 **韦格纳-贝吉龙-芬德森过程 (Wegener-Bergeron-Findeisen, WBF, process)**。如前所述，在冰点以下的温度，冰的饱和水汽压低于水的饱和水汽压 ($e_{si}(T)  e_{sl}(T)$)。这创造了一个独特环境，使得环境水汽压 $e$ 可以同时相对于冰是[过饱和](@entry_id:200794)的 ($e > e_{si}$)，而相对于液态水是次饱和的 ($e  e_{sl}$)。在这种状态下，冰晶通过凝华生长，而[过冷](@entry_id:162134)液滴则蒸发。这个过程是增长冰晶的一种极其有效的机制，也是冷云中形成降水的主要途径之一 。该过程发生所需的最低液面相对湿度可以表示为 $RH_l^{\min}(T) = e_{si}(T)/e_{sl}(T)$，对于 $T  T_0$，该值小于1。

#### 碰并过程

随着粒子的生长，它们产生不同的下落速度，导致碰撞。这些碰撞是导致弹开还是合并取决于多种因素，但在体相方案中，它们被[参数化](@entry_id:265163)为[水凝物](@entry_id:1126277)类别之间的净转换率。

在 **暖雨 (warm rain)** 过程中，只涉及液态水，我们根据一个直径阈值 $D^*$ 将小的云滴 ($q_c$) 和大的雨滴 ($q_r$) 分开，并区分三种关键的碰并机制 ：

-   **自动转化 (Autoconversion)**: 降水开始的过程。它代表云滴之间的碰撞，形成一个直径超过 $D^*$ 的新大液滴。这将质量从云水类别转移到雨水类别 ($q_c \to q_r$)，并且是雨滴数浓度 $N_r$ 的主要源项。
-   **碰吸 (Accretion)**: 现有的雨滴通过收集较小的云滴而生长的过程。这是雨滴生长的一种非常有效的机制，也将质量从 $q_c$ 转移到 $q_r$。碰吸率通常与雨水和云水的浓度成比例。
-   **自收集 (Self-collection)**: 同一类别粒子之间（云-云或雨-雨）的碰撞，其结果不跨越 $D^*$ 阈值。这个过程保持比湿不变（$q_c$ 和 $q_r$ 不变），但通过将两个粒子合并为一个来减少数浓度（$N_c$ 或 $N_r$）。

在 **冰相和混合相 (ice and mixed-phase)** 过程中，也发生类似的碰并机制：

-   **淞化 (Riming)**: 一个冰粒子（例如雪晶）与一个[过冷](@entry_id:162134)液滴碰撞，后者在接触时冻结。这是冰粒子生长的一种高效机制，可以导致形成密实的霰。该过程将液态水转化为冰 ($q_c \to q_i$ or $q_g$) 并释放[熔化潜热](@entry_id:144988) ($L_f$) 。
-   **聚合 (Aggregation)**: 两个或多个冰粒子碰撞并粘在一起，形成一个更大的聚合体（雪）。这个过程在冰类别之间转移质量（例如，从云冰 $q_i$ 到雪 $q_s$），但不涉及相变，因此不释放潜热 。

### 凝结物演变的模拟：[预报方程](@entry_id:1130221)

为了模拟云和降水的演变，大气模式求解一套针对预报凝结物变量的收支方程。

#### 凝结物收支方程

对于任何预报的比湿，例如云水[比湿](@entry_id:1132076) $q_c$，其在[欧拉框架](@entry_id:749109)中的演变由一个守恒定律描述。$q_c$ 的一般[预报方程](@entry_id:1130221)的[通量形式](@entry_id:273811)可以写成 ：
$$
\frac{\partial q_c}{\partial t} + \nabla \cdot (\mathbf{u} q_c) = \text{Microphysics} - \nabla \cdot \mathbf{F}_{sed,c}
$$
让我们分解每个组成部分：
-   $\frac{\partial q_c}{\partial t}$: 云水比湿的局地变化率。
-   $\nabla \cdot (\mathbf{u} q_c)$: 平流项，表示由解析风场 $\mathbf{u}$ 引起的云水输送。通量的散度表示一个网格体积的净输送。
-   $\text{Microphysics}$: 这是所有微物理过程的净源/汇项。对于云水 ($q_c$)，该项是诸如 $S_{cond} - P_{auto} - P_{accr}$ 之类的速率之和，其中 $S_{cond}$ 是凝结/蒸发的净源项，$P_{auto}$ 是由于[自动转化](@entry_id:1121257)为雨水的汇项，$P_{accr}$ 是由于被雨水碰吸的汇项。符号至关重要：产生 $q_c$ 的过程为正，消耗 $q_c$ 的过程为负 。类似地，对于像 $q_i$ 这样的冰物种，源/汇项将包括凝华、[升华](@entry_id:139006)、淞化和聚合的速率，每个速率都带有适当的符号，并通过潜热释放与其它物种（如 $q_v$, $q_c$, $q_s$）和温度的相应变化相耦合 。
-   $\nabla \cdot \mathbf{F}_{sed,c}$: 由于 **重力沉降 (gravitational settling)** 或沉降造成的非平流通量的散度。较重的粒子如雨和雪相对于周围空气下落。这种向下的通量 $\mathbf{F}_{sed,c}$ 导致高层[水凝物](@entry_id:1126277)的净移除和低层[水凝物](@entry_id:1126277)的净来源。

#### 数值实施中的考虑

求解这些耦合的[非线性方程](@entry_id:145852)带来了显著的数值挑战。

首先，微物理的[常微分方程组](@entry_id:907499)通常是 **数值刚性 (numerically stiff)** 的 。当一个系统包含在截然不同时间尺度上发生的过程时，它就是刚性的。具体来说，当某些过程的特征弛豫时间 ($\tau$) 远小于模式的[积分时间步长](@entry_id:162921) ($\Delta t$) 时，刚性问题就会出现。对于[显式时间步进](@entry_id:168157)方案，这个条件 ($\tau \ll \Delta t$) 迫使我们使用极小的时间步长来维持数值稳定性，这在计算上是不可行的。

在[云微物理学](@entry_id:1122517)中，涉及扩散的[相变过程](@entry_id:147919)，如凝结、蒸发和冻结，通常非常快。例如，一个小云滴适应过饱和度变化的特征时间可能在秒级或更短，而液滴冻结的时间可能是毫秒级的。相比之下，依赖于粒子相遇概率的碰并过程，如聚合，其特征时间可能从几分钟到几小时不等。对于一个典型的模式时间步长 $\Delta t=30\,\mathrm{s}$，快速的[扩散过程](@entry_id:268015)是数值刚性的，而慢速的碰并过程是非刚性的。这要求对微物理代码的刚性部分使用隐式或半[隐式时间积分](@entry_id:171761)方案，或子步长方法 。

其次，微物理过程必须与模式的动力学（平流、压力梯度）耦合。完整的[演化方程](@entry_id:268137)形式为 $\frac{d\mathbf{x}}{dt} = \mathcal{D}(\mathbf{x}) + \mathcal{M}(\mathbf{x})$，其中 $\mathcal{D}$ 代表动力学，$\mathcal{M}$ 代表微物理。模式通常不一次性求解完整方程，而是使用 **算子分裂 (operator splitting)** 在一个时间步内分别求解各个部分 。两种主要策略是：

-   **顺序分裂 (Sequential Splitting)**: 算子一个接一个地应用。例如，首先求解动力学在 $\Delta t$ 内的影响，然后使用更新后的状态求解微物理在 $\Delta t$ 内的影响。这种方法如果每个子步骤都是守恒的，那么就很容易实现总量的守恒。然而，它引入了一个与[算子对易子](@entry_id:152475) $[\mathcal{M}, \mathcal{D}]$ 成正比的“分裂误差”，使方案成为[一阶精度](@entry_id:749410)。

-   **并行分裂 (Parallel Splitting)**: 两个算子的倾向都在相同的初始状态下计算，然后相加并用于更新状态。这种方法更具一致性，因为所有物理过程都是基于相同的大气状态评估的。但是，它可能导致实际问题，例如多个汇项过程（如[自动转化](@entry_id:1121257)和碰吸）过度消耗一个储存库（如 $q_c$）并导致不符合物理的负值，除非施加一个协调的限制器。该方法也是[一阶精度](@entry_id:749410)的。

理解这些数值技术与理解物理本身同样重要，因为它们从根本上影响着天气和气候模式中模拟的云和降水场的稳定性、准确性和守恒性 。