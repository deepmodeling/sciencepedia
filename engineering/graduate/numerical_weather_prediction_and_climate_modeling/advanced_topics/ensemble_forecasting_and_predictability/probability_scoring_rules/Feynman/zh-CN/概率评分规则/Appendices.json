{
    "hands_on_practices": [
        {
            "introduction": "为了掌握概率评分规则，我们首先从最基本的情景开始。布莱尔分数（Brier Score）是评估二元事件（例如，是否下雨）概率预报质量的基石。这个练习旨在通过一个理想化的思想实验来建立对布莱尔分数基本性质的直观理解：一个完美的“神谕”预报所能达到的最佳分数。然后，我们引入一个在现实世界中普遍存在的复杂因素——观测误差，并定量地推导它如何影响预报评分的期望值。通过这个练习，你将深入理解评估一个预报系统性能的理论极限，以及现实世界中的不完美性（如观测误差）是如何设定这个极限的 。",
            "id": "4079336",
            "problem": "考虑一个在数值天气预报和气候模拟中的二元事件验证情景，其中事件指示符表示为 $y \\in \\{0,1\\}$，预报给出的概率为 $p \\in [0,1]$。对于单个二元预报-观测对，Brier 分数定义为 $S(p,y) = (p - y)^{2}$。假设存在一个确定性神谕，它可以访问真实事件，并在每种情况下都给出 $p = y$。\n\n现在考虑两种验证情景：\n- 完美验证：评估使用真实指示符 $y$。\n- 观测误差：验证使用一个受污染的指示符 $\\tilde{y}$，使得在给定 $y$ 的条件下，观测到的 $\\tilde{y}$ 等于 $y$ 的概率为 $1 - \\epsilon$，等于 $1 - y$ 的概率为 $\\epsilon$，其中 $0 \\leq \\epsilon \\leq 1$。假设该错误分类与预报以及 $y$ 的数据生成机制无关。\n\n在这些假设下，从第一性原理推导确定性神谕 $p=y$ 在每种情景下的期望 Brier 分数。在观测误差情景中，期望必须是关于由真实 $y$ 和 $\\tilde{y}$ 的误差过程所构成的联合分布来计算，并且最终答案必须纯粹表示为 $\\epsilon$ 的函数（即，它不能依赖于 $y$ 的分布）。\n\n将最终答案以一个包含两个元素的行矩阵形式给出：\n- 完美验证下的期望 Brier 分数，以及\n- 上述观测误差模型下的期望 Brier 分数。\n\n不需要进行数值近似。如果选择简化，请将任何最终表达式以精确的符号形式表示。最终答案必须是无单位的，并以精确形式表示。",
            "solution": "题目要求计算一个确定性神谕在两种不同的验证情景下的期望 Brier 分数：一种是完美观测，另一种是受污染的观测。我们将分别处理每种情景。\n\n对于单个预报-观测对，Brier 分数由 $S(p,y) = (p - y)^{2}$ 给出，其中 $p \\in [0,1]$ 是预报概率，$y \\in \\{0,1\\}$ 是二元事件指示符。\n确定性神谕被定义为对真实事件有完美的了解，因此给出预报 $p = y$。\n\n**情景1：完美验证**\n在此情景中，评估使用真实事件指示符 $y$。神谕的预报为 $p = y$。我们将其代入 Brier 分数的定义中：\n$$\nS(p,y) = S(y,y) = (y - y)^{2}\n$$\n对于事件的任何实现，无论是 $y=0$ 还是 $y=1$，分数都是：\n$$\nS(y,y) = (0)^{2} = 0\n$$\n由于对于事件 $y$ 的每一个可能结果，分数都恒等于 $0$，因此其期望值也为 $0$。令 $E[\\cdot]$ 表示关于 $y$ 分布的期望算子。\n$$\nE[S(p,y)] = E[(y-y)^{2}] = E[0] = 0\n$$\n因此，在完美验证下，完美神谕的期望 Brier 分数为 $0$。这个结果与事件 $y$ 的潜在气候学概率无关。\n\n**情景2：观测误差**\n在此情景中，评估使用一个受污染的事件指示符 $\\tilde{y}$。神谕的预报仍然基于真实事件，因此 $p=y$。Brier 分数现在计算为 $S(p, \\tilde{y}) = (p - \\tilde{y})^{2}$。代入 $p=y$，分数变为：\n$$\nS(y, \\tilde{y}) = (y - \\tilde{y})^{2}\n$$\n我们需要计算该分数的期望值 $E[(y - \\tilde{y})^{2}]$，其中期望是关于真实事件 $y$ 和受污染观测 $\\tilde{y}$ 的联合分布来计算的。我们可以使用全期望定律，以真实事件 $y$ 为条件来计算它：\n$$\nE[(y - \\tilde{y})^{2}] = E_{y} \\left[ E_{\\tilde{y}|y} \\left[ (y - \\tilde{y})^{2} | y \\right] \\right]\n$$\n让我们首先计算内部期望，即在真实事件 $y$ 的特定实现下的条件期望分数。受污染观测 $\\tilde{y}$ 的分布是在给定 $y$ 的条件下给出的：\n$P(\\tilde{y} = y | y) = 1 - \\epsilon$\n$P(\\tilde{y} = 1 - y | y) = \\epsilon$\n\n项 $(y - \\tilde{y})^{2}$ 可以根据 $\\tilde{y}$ 的值取两个可能的值：\n1. 如果 $\\tilde{y} = y$（无误差），则 $(y - \\tilde{y})^{2} = (y-y)^{2} = 0$。这种情况发生的概率为 $1 - \\epsilon$。\n2. 如果 $\\tilde{y} = 1 - y$（有误差），则 $(y - \\tilde{y})^{2} = (y - (1-y))^{2} = (2y - 1)^{2}$。这种情况发生的概率为 $\\epsilon$。\n\n因此，内部的条件期望为：\n$$\nE_{\\tilde{y}|y} \\left[ (y - \\tilde{y})^{2} | y \\right] = 0 \\cdot P(\\tilde{y}=y|y) + (2y - 1)^{2} \\cdot P(\\tilde{y}=1-y|y)\n$$\n$$\nE_{\\tilde{y}|y} \\left[ (y - \\tilde{y})^{2} | y \\right] = 0 \\cdot (1-\\epsilon) + (2y - 1)^{2} \\cdot \\epsilon = (2y - 1)^{2} \\epsilon\n$$\n现在，我们必须计算关于真实事件 $y$ 分布的外部期望：\n$$\nE[(y - \\tilde{y})^{2}] = E_{y} \\left[ (2y - 1)^{2} \\epsilon \\right]\n$$\n由于 $\\epsilon$ 是一个常数，我们可以将其从期望中提出：\n$$\nE[(y - \\tilde{y})^{2}] = \\epsilon \\cdot E_{y} \\left[ (2y - 1)^{2} \\right]\n$$\n随机变量 $y$ 只能取值于 $\\{0, 1\\}$。让我们对每种情况评估项 $(2y-1)^{2}$：\n- 如果 $y=1$，则 $(2(1)-1)^{2} = (1)^{2} = 1$。\n- 如果 $y=0$，则 $(2(0)-1)^{2} = (-1)^{2} = 1$。\n在真实事件 $y$ 的两种可能状态下，量 $(2y-1)^{2}$ 都恒等于 $1$。因此，其期望值也为 $1$，而与 $y$ 的概率分布无关（即，与 $P(y=1)$ 无关）：\n$$\nE_{y} \\left[ (2y - 1)^{2} \\right] = 1\n$$\n将此结果代回到我们关于总期望分数的表达式中：\n$$\nE[(y - \\tilde{y})^{2}] = \\epsilon \\cdot 1 = \\epsilon\n$$\n在指定的观测误差模型下，完美神谕的期望 Brier 分数为 $\\epsilon$。此结果仅依赖于误差概率 $\\epsilon$，而不依赖于事件 $y$ 的气候学特性，这与问题陈述的要求一致。\n\n总结一下，所需的两个值为：\n1. 完美验证下的期望 Brier 分数：$0$。\n2. 观测误差下的期望 Brier 分数：$\\epsilon$。\n\n这些值以一个包含两个元素的行矩阵形式呈现。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & \\epsilon\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在掌握了针对二元事件的评分规则之后，我们将注意力转向对连续变量（如温度或气压）的概率预报，这类预报通常以集合预报的形式发布。连续分级概率评分（Continuous Ranked Probability Score, CRPS）是评估这类预报的黄金标准。这个实践练习的核心任务是将CRPS看似复杂的积分定义，转化为一个针对有限集合成员的高效计算公式。通过推导一个计算复杂度为 $\\mathcal{O}(m \\log m)$ 的算法，你将学习到如何将抽象的理论应用到实际的数值天气预报产品中，并能亲手计算出一个集合预报的CRPS值 。",
            "id": "4079332",
            "problem": "一个数值天气预报系统发布了一个单站点的每日$2$米气温（开尔文）的等权重集合预报，包含 $m$ 个集合成员 $\\{x_{i}\\}_{i=1}^{m}$ 和一个验证观测值 $y$。任务是使用连续分级概率评分（Continuous Ranked Probability Score, CRPS）来评估此概率预报的质量。对于一个预报累积分布函数 $F$ 和观测值 $y$，CRPS 由以下积分定义\n$$\n\\mathrm{CRPS}(F,y) = \\int_{-\\infty}^{\\infty} \\left(F(z) - \\mathbb{1}\\{z \\ge y\\}\\right)^{2} \\, dz,\n$$\n其中 $\\mathbb{1}\\{\\cdot\\}$ 表示指示函数。对于等权重的集合，预报累积分布函数是经验分布\n$$\nF(z) = \\frac{1}{m} \\sum_{i=1}^{m} \\mathbb{1}\\{x_{i} \\le z\\}.\n$$\n仅从这些定义出发，推导出一个关于排序后的集合 $\\{x_{(i)}\\}_{i=1}^{m}$、观测值 $y$ 以及可在排序后计算的累积和的 $\\mathrm{CRPS}(F,y)$ 的闭式代数表达式。你的表达式必须清楚地说明如何通过对 $\\{x_{i}\\}$ 进行排序并使用累积和来评估所需量，从而实现计算复杂度为 $\\mathcal{O}(m \\log m)$ 的算法。\n\n然后，将你推导的表达式应用于以下未排序的集合（开尔文）和观测值（开尔文）：\n$$\n\\{x_{i}\\}_{i=1}^{8} = \\{300, 295, 303, 289, 298, 301, 296, 292\\}, \\quad y = 297.\n$$\n计算以开尔文为单位的 CRPS，并将最终数值结果四舍五入到四位有效数字。以开尔文表示最终得分。作为背景知识，请注意，其他概率评分规则，如 Brier Score (BS) 和 Receiver Operating Characteristic (ROC) 曲线，针对的是预报质量的不同方面，但本问题专注于 CRPS。",
            "solution": "我们的目标是从 CRPS 的积分定义推导出一个针对包含 $m$ 个成员的等权重集合预报 $\\{x_i\\}$ 的高效计算公式。\n\n一个已知的 CRPS 恒等式为：\n$$\n\\mathrm{CRPS}(F,y) = E_F|X-y| - \\frac{1}{2} E_F|X-X'|\n$$\n其中 $X$ 和 $X'$ 是从预报分布 $F$ 中独立抽取的随机变量。这一恒等式将 CRPS 解释为预报与观测值之间的平均绝对误差，并减去一个衡量预报锐度（或确定性）的项。\n\n对于由集合 $\\{x_i\\}_{i=1}^m$ 定义的经验分布函数 $F$，这两个期望项可以写成：\n1.  $E_F|X-y| = \\frac{1}{m} \\sum_{i=1}^{m} |x_i - y|$。这是集合成员与观测值之间的平均绝对误差（MAE）。\n2.  $E_F|X-X'| = \\frac{1}{m^2} \\sum_{i=1}^{m} \\sum_{j=1}^{m} |x_i - x_j|$。这是所有成员对之间平均绝对差。\n\n因此，\n$$\n\\mathrm{CRPS}(F,y) = \\frac{1}{m} \\sum_{i=1}^{m} |x_i - y| - \\frac{1}{2m^2} \\sum_{i=1}^{m} \\sum_{j=1}^{m} |x_i - x_j|\n$$\n虽然这个公式是正确的，但计算第二个项中的双重求和需要 $\\mathcal{O}(m^2)$ 的时间复杂度。为了得到一个更高效的算法，我们可以对第二个项进行简化。\n\n首先，将集合成员按升序排列，得到 $x_{(1)} \\le x_{(2)} \\le \\dots \\le x_{(m)}$。双重求和可以重写为：\n$$\n\\sum_{i=1}^{m} \\sum_{j=1}^{m} |x_i - x_j| = 2 \\sum_{j>i} (x_{(j)} - x_{(i)})\n$$\n对这个求和进行进一步的代数操作，可以证明：\n$$\n\\sum_{j>i} (x_{(j)} - x_{(i)}) = \\sum_{i=1}^{m} (2i - m - 1) x_{(i)}\n$$\n将这个结果代回 CRPS 的表达式中，我们得到一个高效的计算公式：\n$$\n\\mathrm{CRPS}(F,y) = \\frac{1}{m} \\sum_{i=1}^{m} |x_i - y| - \\frac{1}{m^2} \\sum_{i=1}^{m} (2i - m - 1) x_{(i)}\n$$\n这个表达式的计算复杂度由排序步骤决定，即 $\\mathcal{O}(m \\log m)$，因为排序之后的所有求和都只需要 $\\mathcal{O}(m)$ 的时间。\n\n现在，我们将此公式应用于给定的数据：\n-   未排序集合：$\\{300, 295, 303, 289, 298, 301, 296, 292\\}$\n-   观测值：$y = 297$\n-   集合大小：$m = 8$\n\n**步骤1：对集合进行排序**\n$$\nx_{(i)}: \\{289, 292, 295, 296, 298, 300, 301, 303\\}\n$$\n\n**步骤2：计算第一项（MAE）**\n$$\n\\frac{1}{8} \\sum_{i=1}^{8} |x_i - 297| = \\frac{1}{8} (|289-297| + |292-297| + \\dots + |303-297|)\n$$\n$$\n= \\frac{1}{8} (8 + 5 + 2 + 1 + 1 + 3 + 4 + 6) = \\frac{30}{8} = 3.75\n$$\n\n**步骤3：计算第二项（锐度项）**\n权重 $(2i - m - 1)$ 对于 $m=8$ 是 $(2i-9)$，其值为：$-7, -5, -3, -1, 1, 3, 5, 7$。\n$$\n\\sum_{i=1}^{8} (2i - 9) x_{(i)} = (-7)(289) + (-5)(292) + (-3)(295) + (-1)(296) + (1)(298) + (3)(300) + (5)(301) + (7)(303)\n$$\n$$\n= -2023 - 1460 - 885 - 296 + 298 + 900 + 1505 + 2121 = -4664 + 4824 = 160\n$$\n因此，第二项的值为：\n$$\n\\frac{1}{m^2} \\sum_{i=1}^{m} (2i - m - 1) x_{(i)} = \\frac{1}{8^2} (160) = \\frac{160}{64} = 2.5\n$$\n\n**步骤4：计算最终的 CRPS**\n$$\n\\mathrm{CRPS} = 3.75 - 2.5 = 1.25\n$$\n根据要求，将结果四舍五入到四位有效数字，得到 $1.250$。最终得分为 $1.250$ 开尔文。",
            "answer": "$$\\boxed{1.250}$$"
        },
        {
            "introduction": "一个预报的“好坏”并非单一维度。高水平的预报评估需要我们解构预报质量的不同方面。这个高级练习将引导你区分概率预报的两个关键属性：辨识度（discrimination）和校准度（calibration）。辨识度衡量预报区分事件发生与不发生的能力，通常用受试者工作特征（ROC）曲线来评估；而校准度则衡量预报概率的可靠性。通过严格证明辨识度对于校准变换是不变的，而精确率（precision）等指标则会受其影响，你将深刻理解为何需要独立评估这两个属性，从而形成对预报系统性能更全面、更细致的认识 。",
            "id": "4079328",
            "problem": "在数值天气预报的背景下，考虑一个二元事件 $Y \\in \\{0,1\\}$ 的概率预报，该事件表示某给定站点的日降雨量是否超过一个具有科学意义的阈值（例如 $20\\,\\mathrm{mm}$）。设一个预报系统输出一个标量得分 $s \\in [0,1]$，用于对 $Y=1$ 的可能性进行排序。一个校准的概率预报 $p$ 是 $s$ 的一个可测函数，满足校准的定义属性：对于几乎所有的 $\\lambda \\in [0,1]$，都有 $P(Y=1 \\mid p=\\lambda)=\\lambda$。一个重新校准或未校准的预报是 $q=g(p)$，其中 $g:[0,1]\\to[0,1]$ 是一个非恒等的严格递增函数，并且通常不满足 $P(Y=1 \\mid q=\\lambda)=\\lambda$。\n\n受试者工作特征（ROC）分析通过随着分类阈值变化而描绘出的一系列配对 $(\\mathrm{TPR}(\\theta),\\mathrm{FPR}(\\theta))$ 来评估排序技巧，其中 $\\mathrm{TPR}(\\theta)=P(s \\ge \\theta \\mid Y=1)$（真阳性率）和 $\\mathrm{FPR}(\\theta)=P(s \\ge \\theta \\mid Y=0)$（假阳性率）。在阈值 $\\tau \\in (0,1)$ 处的精确率（也称为阳性预测值）对于校准预报是 $P(Y=1 \\mid p \\ge \\tau)$，对于未校准预报是 $P(Y=1 \\mid q \\ge \\tau)$，其预测规则为“如果预报概率至少为 $\\tau$，则预测 $Y=1$”。\n\n从上述基本定义和贝叶斯定理出发，完成以下任务：\n\n1. 证明严格递增的校准变换 $q=g(p)$ 不会改变ROC曲线，即通过对 $p$ 进行阈值处理得到的集合 $\\{(\\mathrm{TPR}(\\theta),\\mathrm{FPR}(\\theta)):\\theta \\in [0,1]\\}$ 与通过对 $q$ 进行阈值处理得到的集合是相同的（在阈值的重新参数化下）。你的论证必须从 $\\mathrm{TPR}$ 和 $\\mathrm{FPR}$ 的定义以及 $g$ 是严格递增的性质出发；你不能引用任何预先推导的ROC不变性公式。\n\n2. 证明校准变换 $q=g(p)$ 确实会影响在固定数值阈值 $\\tau$ 下的精确率，并通过推导一个用 $P(p \\ge g^{-1}(\\tau) \\mid Y=1)$ 和 $P(p \\ge g^{-1}(\\tau) \\mid Y=0)$ 表示 $P(Y=1 \\mid q \\ge \\tau)$ 的表达式，来分离出“通过分母”起作用的机制，并明确显示 $P(q \\ge \\tau)$ 的作用。\n\n3. 构建一对具有相同ROC但不同精确率的校准与未校准预报，方法是指定一个在 $Y=1$ 和 $Y=0$ 条件下排序得分 $s$ 的科学上合理的条件分布，一个与极端降雨气候学一致的基础率 $P(Y=1)$，以及一个严格递增的重新校准函数 $g$。使用以下具体选择：$P(Y=1)=\\pi=0.3$，条件分布为 $s \\mid Y=1 \\sim \\mathrm{Uniform}(0.2, 1)$ 和 $s \\mid Y=0 \\sim \\mathrm{Uniform}(0, 0.9)$，校准概率为 $p=s$，未校准概率为 $q=g(p)$ 且 $g(x)=x^{2}$。采用操作性警报阈值 $\\tau=0.64$ (等于 $\\frac{16}{25}$)。计算校准预报在阈值 $\\tau$ 处的精确率和未校准预报在相同数值阈值 $\\tau$ 处的精确率，然后计算它们的差值“未校准减去校准”。将你的最终答案表示为一个无单位的最简有理数。无需四舍五入。",
            "solution": "该问题探讨了概率预报的两个关键属性之间的区别：辨识度（discrimination）和校准度（calibration）。辨识度，即区分事件与非事件的能力，由ROC曲线来衡量。校准度指的是预报概率的统计一致性。我们被要求证明ROC曲线对于校准变换是不变的，而精确率（一个同时依赖于辨识度、校准度和基础率的指标）则不是。\n\n在整个分析过程中，我们根据第3部分的具体示例，将排序得分 $s$ 等同于校准概率 $p$。因此，$\\mathrm{TPR}$ 和 $\\mathrm{FPR}$ 可以通过对 $p$ 进行阈值处理来定义。\n\n**第1部分：ROC不变性的证明**\n\nROC曲线是对于所有可能的分类阈值，真阳性率对假阳性率的图。对于预报 $p$，其ROC曲线上的点集 $\\mathcal{C}_p$ 由下式给出：\n$$ \\mathcal{C}_p = \\{ (P(p \\ge \\theta \\mid Y=1), P(p \\ge \\theta \\mid Y=0)) : \\theta \\in [0,1] \\} $$\n对于变换后的预报 $q=g(p)$，其ROC曲线 $\\mathcal{C}_q$ 类似地通过对 $q$ 进行阈值处理来定义：\n$$ \\mathcal{C}_q = \\{ (P(q \\ge \\theta' \\mid Y=1), P(q \\ge \\theta' \\mid Y=0)) : \\theta' \\in [0,1] \\} $$\n我们已知 $g: [0,1] \\to [0,1]$ 是一个严格递增函数。这个性质意味着 $g$ 存在一个在其值域上定义的严格递增的反函数 $g^{-1}$。条件 $a \\ge b$ 等价于 $g(a) \\ge g(b)$，同样地，对于值域中的 $c, d$，条件 $c \\ge d$ 等价于 $g^{-1}(c) \\ge g^{-1}(d)$。\n\n我们来证明 $\\mathcal{C}_q$ 上的任意一点也在 $\\mathcal{C}_p$ 上。\n考虑由阈值 $\\theta'$ 生成的 $\\mathcal{C}_q$ 上的任意一点。该点的坐标为 $(P(q \\ge \\theta' \\mid Y=1), P(q \\ge \\theta' \\mid Y=0))$。\n不等式 $q \\ge \\theta'$ 等价于 $g(p) \\ge \\theta'$。因为 $g$ 是严格递增的，我们可以对其两边应用其反函数 $g^{-1}$ 而不改变不等式的方向。这得到 $p \\ge g^{-1}(\\theta')$。\n让我们定义一个新阈值 $\\theta = g^{-1}(\\theta')$。当 $\\theta'$ 遍历其定义域（即 $g$ 的值域）时，$\\theta$ 会遍历 $g$ 的定义域，即 $[0,1]$。\n因此，$\\mathcal{C}_q$ 上的点的坐标可以重写为：\n$$ P(q \\ge \\theta' \\mid Y=1) = P(p \\ge g^{-1}(\\theta') \\mid Y=1) = P(p \\ge \\theta \\mid Y=1) $$\n$$ P(q \\ge \\theta' \\mid Y=0) = P(p \\ge g^{-1}(\\theta') \\mid Y=0) = P(p \\ge \\theta \\mid Y=0) $$\n这证明了 $q$ 的ROC曲线上的任意一点都与 $p$ 的ROC曲线上与阈值 $\\theta = g^{-1}(\\theta')$ 相关联的某一点相同。因此，$\\mathcal{C}_q \\subseteq \\mathcal{C}_p$。\n\n反之，我们来证明 $\\mathcal{C}_p$ 上的任意一点也在 $\\mathcal{C}_q$ 上。\n考虑由阈值 $\\theta$ 生成的 $\\mathcal{C}_p$ 上的任意一点。条件是 $p \\ge \\theta$。由于 $g$ 是严格递增的，这等价于 $g(p) \\ge g(\\theta)$。\n让我们定义一个新阈值 $\\theta' = g(\\theta)$。条件变为 $q \\ge \\theta'$。\n$\\mathcal{C}_p$ 上的点的坐标可以重写为：\n$$ P(p \\ge \\theta \\mid Y=1) = P(g(p) \\ge g(\\theta) \\mid Y=1) = P(q \\ge \\theta' \\mid Y=1) $$\n$$ P(p \\ge \\theta \\mid Y=0) = P(g(p) \\ge g(\\theta) \\mid Y=0) = P(q \\ge \\theta' \\mid Y=0) $$\n这表明 $p$ 的ROC曲线上的任意一点都与 $q$ 的ROC曲线上与阈值 $\\theta' = g(\\theta)$ 相关联的某一点相同。因此，$\\mathcal{C}_p \\subseteq \\mathcal{C}_q$。\n\n因为 $\\mathcal{C}_q \\subseteq \\mathcal{C}_p$ 且 $\\mathcal{C}_p \\subseteq \\mathcal{C}_q$，所以这两个集合是相同的：$\\mathcal{C}_p = \\mathcal{C}_q$。变换 $g$ 只是对曲线进行了重新参数化。证明完毕。\n\n**第2部分：校准对精确率的影响**\n\n精确率，或称阳性预测值（PPV），定义为 $P(Y=1 \\mid \\text{预报} \\ge \\tau)$。对于未校准预报 $q$，在固定的数值阈值 $\\tau$ 下，精确率为 $P(Y=1 \\mid q \\ge \\tau)$。\n使用条件概率的定义（贝叶斯定理）：\n$$ P(Y=1 \\mid q \\ge \\tau) = \\frac{P(q \\ge \\tau \\mid Y=1) P(Y=1)}{P(q \\ge \\tau)} $$\n问题要求显示分母 $P(q \\ge \\tau)$ 的作用，并将分子用包含 $p$ 的概率来表示。\n如第1部分所示，事件 $q \\ge \\tau$ 等同于事件 $p \\ge g^{-1}(\\tau)$。\n因此，我们可以将分子项 $P(q \\ge \\tau \\mid Y=1)$ 重写为 $P(p \\ge g^{-1}(\\tau) \\mid Y=1)$。\n将此代入精确率的表达式中，得到：\n$$ P(Y=1 \\mid q \\ge \\tau) = \\frac{P(p \\ge g^{-1}(\\tau) \\mid Y=1) P(Y=1)}{P(q \\ge \\tau)} $$\n这个表达式通过明确显示 $P(q \\ge \\tau)$，分离出了“通过分母”起作用的机制。\n为展开分母并显示完整的依赖关系，我们使用全概率公式：\n$$ P(q \\ge \\tau) = P(q \\ge \\tau \\mid Y=1)P(Y=1) + P(q \\ge \\tau \\mid Y=0)P(Y=0) $$\n再次利用事件的等价性，这变为：\n$$ P(q \\ge \\tau) = P(p \\ge g^{-1}(\\tau) \\mid Y=1)P(Y=1) + P(p \\ge g^{-1}(\\tau) \\mid Y=0)P(Y=0) $$\n对于校准预报 $p$，在相同的数值阈值 $\\tau$ 下的精确率为：\n$$ P(Y=1 \\mid p \\ge \\tau) = \\frac{P(p \\ge \\tau \\mid Y=1) P(Y=1)}{P(p \\ge \\tau)} $$\n由于 $g$ 不是恒等函数，通常情况下 $g^{-1}(\\tau) \\neq \\tau$。这意味着对于这两个预报，发布警报的条件是不同的，即 $p \\ge g^{-1}(\\tau)$ 对比 $p \\ge \\tau$。因此，警报的真阳性率（$P(p \\ge \\text{threshold} \\mid Y=1)$）和发布警报的总概率（$P(p \\ge \\text{threshold})$）都不同。这导致在相同的数值阈值 $\\tau$ 下，校准和未校准预报的精确率值不同。\n\n**第3部分：具体示例与计算**\n\n我们已知：\n-   $P(Y=1) = \\pi = 0.3 = \\frac{3}{10}$，所以 $P(Y=0) = 1-\\pi = 0.7 = \\frac{7}{10}$。\n-   给定 $Y=1$ 时 $s$ 的概率密度函数（PDF）是 $f_1(s) = \\frac{1}{1-0.2} = \\frac{1}{0.8} = \\frac{5}{4}$，其中 $s \\in [0.2, 1]$。\n-   给定 $Y=0$ 时 $s$ 的概率密度函数（PDF）是 $f_0(s) = \\frac{1}{0.9-0} = \\frac{1}{0.9} = \\frac{10}{9}$，其中 $s \\in [0, 0.9]$。\n-   校准预报 $p=s$。未校准预报 $q=p^2=s^2$。\n-   阈值 $\\tau=0.64 = \\frac{16}{25}$。\n\n首先，我们计算校准预报的精确率，$\\text{Prec}_p = P(Y=1 \\mid p \\ge \\tau) = P(Y=1 \\mid s \\ge 0.64)$。\n根据贝叶斯定理：$\\text{Prec}_p = \\frac{P(s \\ge 0.64 \\mid Y=1)P(Y=1)}{P(s \\ge 0.64)}$。\n\n计算条件概率：\n$P(s \\ge 0.64 \\mid Y=1) = \\int_{0.64}^{1} f_1(s) ds = \\int_{0.64}^{1} \\frac{5}{4} ds = \\frac{5}{4}[s]_{0.64}^{1} = \\frac{5}{4}(1 - 0.64) = \\frac{5}{4}(0.36) = \\frac{9}{20}$。\n$P(s \\ge 0.64 \\mid Y=0) = \\int_{0.64}^{0.9} f_0(s) ds = \\int_{0.64}^{0.9} \\frac{10}{9} ds = \\frac{10}{9}[s]_{0.64}^{0.9} = \\frac{10}{9}(0.9 - 0.64) = \\frac{10}{9}(0.26) = \\frac{26}{90} = \\frac{13}{45}$。\n\n计算发出警报的总概率，$P(s \\ge 0.64)$：\n$P(s \\ge 0.64) = P(s \\ge 0.64 \\mid Y=1)P(Y=1) + P(s \\ge 0.64 \\mid Y=0)P(Y=0)$\n$P(s \\ge 0.64) = \\left(\\frac{9}{20}\\right)\\left(\\frac{3}{10}\\right) + \\left(\\frac{13}{45}\\right)\\left(\\frac{7}{10}\\right) = \\frac{27}{200} + \\frac{91}{450} = \\frac{27 \\times 9}{1800} + \\frac{91 \\times 4}{1800} = \\frac{243+364}{1800} = \\frac{607}{1800}$。\n\n现在，计算 $\\text{Prec}_p$：\n$\\text{Prec}_p = \\frac{(9/20)(3/10)}{607/1800} = \\frac{27/200}{607/1800} = \\frac{27}{200} \\times \\frac{1800}{607} = \\frac{27 \\times 9}{607} = \\frac{243}{607}$。\n\n接下来，我们计算未校准预报的精确率，$\\text{Prec}_q = P(Y=1 \\mid q \\ge \\tau)$。\n条件是 $q \\ge 0.64$，即 $s^2 \\ge 0.64$。由于 $s \\ge 0$，这等价于 $s \\ge \\sqrt{0.64} = 0.8$。\n所以，$\\text{Prec}_q = P(Y=1 \\mid s \\ge 0.8) = \\frac{P(s \\ge 0.8 \\mid Y=1)P(Y=1)}{P(s \\ge 0.8)}$。\n\n计算新的条件概率：\n$P(s \\ge 0.8 \\mid Y=1) = \\int_{0.8}^{1} \\frac{5}{4} ds = \\frac{5}{4}(1 - 0.8) = \\frac{5}{4}(0.2) = \\frac{1}{4}$。\n$P(s \\ge 0.8 \\mid Y=0) = \\int_{0.8}^{0.9} \\frac{10}{9} ds = \\frac{10}{9}(0.9 - 0.8) = \\frac{10}{9}(0.1) = \\frac{1}{9}$。\n\n计算新的发出警报的总概率，$P(s \\ge 0.8)$：\n$P(s \\ge 0.8) = P(s \\ge 0.8 \\mid Y=1)P(Y=1) + P(s \\ge 0.8 \\mid Y=0)P(Y=0)$\n$P(s \\ge 0.8) = \\left(\\frac{1}{4}\\right)\\left(\\frac{3}{10}\\right) + \\left(\\frac{1}{9}\\right)\\left(\\frac{7}{10}\\right) = \\frac{3}{40} + \\frac{7}{90} = \\frac{27}{360} + \\frac{28}{360} = \\frac{55}{360} = \\frac{11}{72}$。\n\n现在，计算 $\\text{Prec}_q$：\n$\\text{Prec}_q = \\frac{(1/4)(3/10)}{11/72} = \\frac{3/40}{11/72} = \\frac{3}{40} \\times \\frac{72}{11} = \\frac{3 \\times 9}{5 \\times 11} = \\frac{27}{55}$。\n\n最后，我们计算差值：未校准减去校准的精确率。\n差值 $= \\text{Prec}_q - \\text{Prec}_p = \\frac{27}{55} - \\frac{243}{607}$。\n为了相减，我们找到一个公分母，即 $55 \\times 607 = 33385$。\n差值 $= \\frac{27 \\times 607}{55 \\times 607} - \\frac{243 \\times 55}{55 \\times 607} = \\frac{16389 - 13365}{33385} = \\frac{3024}{33385}$。\n分母是 $33385 = 5 \\times 11 \\times 607$。素数 $607$ 不是分子 $3024$ 的因子（因为 $5 \\times 607 = 3035$）。分子不能被 $5$ 或 $11$ 整除。因此，该分数是其最简形式。",
            "answer": "$$\\boxed{\\frac{3024}{33385}}$$"
        }
    ]
}