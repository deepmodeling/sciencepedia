## 引言
在现代地球系统科学中，数值模型是预测天气和模拟气候变化不可或缺的工具。然而，由于计算资源的限制，这些模型无法解析所有尺度的物理过程，必须依赖[参数化](@entry_id:265163)方案来描述[次网格尺度过程](@entry_id:1132602)（如[湍流](@entry_id:151300)和对流）的平均效应。传统的确定性[参数化](@entry_id:265163)方案虽然能够修正模式的部分系统性偏差，但其固有的缺陷在于忽略了次网格过程围绕其平均值的随机涨落。这种简化导致模式预报的[离散度](@entry_id:168823)不足，难以捕捉极端事件，并可能歪曲对[气候变率](@entry_id:1122483)的模拟。

本文旨在深入探讨随机参数化这一前沿领域，它通过在模式中引入具有物理约束的随机性，来系统性地解决上述问题。文章将为读者提供一个从基本原理到前沿应用的全面图景。在接下来的内容中，你将学习到：

第一章，“原理与机制”，将从[湍流](@entry_id:151300)[闭包问题](@entry_id:160656)出发，阐明引入随机性的必要性，并详细剖析随机动能背散射（SKEB）和[随机对流](@entry_id:1132416)等核心方案的设计思想与数学基础。

第二章，“应用与交叉学科联系”，将展示这些方案如何在实际的数值天气预报和气候模拟中发挥作用，如何改善对关键天气气候现象的预报，以及它们与数据同化、[海洋学](@entry_id:149256)等领域的深刻联系。

第三章，“动手实践”，将通过具体的计算问题，引导读者将理论知识转化为解决实际问题的能力，例如如何构建时空相关的[随机场](@entry_id:177952)以及如何处理[非线性](@entry_id:637147)过程中的随机偏差。

通过这三个章节的层层递进，本文将揭示[随机参数化](@entry_id:1132435)如何成为提升[地球系统模型](@entry_id:1124096)真实性和可靠性的关键技术。

## 原理与机制

继前一章对随机参数化概念的介绍之后，本章将深入探讨支撑现代数值天气预报和气候模型中[随机参数化](@entry_id:1132435)方案的核心科学原理与关键技术机制。我们将从问题的根源——即模式的[闭包问题](@entry_id:160656)——出发，阐明为何需要引入随机性。随后，我们将详细剖析两种主流的[随机参数化](@entry_id:1132435)方法：旨在弥补模式动力学能量亏损的随机动能背散射（SKEB），以及旨在表达物理过程不确定性的随机扰动方案（如SPPT和[随机对流](@entry_id:1132416)）。最后，我们将讨论实现这些方案所必需的、更为深入的数学基础，包括不同类型[随机过程](@entry_id:268487)的选择及其在数学上的处理方式。

### [闭包问题](@entry_id:160656)与随机性的必要性

为了理解随机参数化的动机，我们必须首先回顾数值模式中的一个根本性挑战：[湍流](@entry_id:151300)[闭包问题](@entry_id:160656)。

#### 从[雷诺平均](@entry_id:754341)到[闭包问题](@entry_id:160656)

大气和海洋的运动遵循流体动力学方程，例如[Navier-Stokes](@entry_id:276387)方程。这些方程本质上是[非线性](@entry_id:637147)的，这意味着不同尺度的运动之间存在着复杂的相互作用。数值模式由于计算资源的限制，只能显式地解析（即计算）某一格点尺度（例如，几十公里）以上的运动，而所有小于该尺度的运动（即“次级网格”过程）都无法被直接解析。

为了推导出控制已解析尺度运动的方程，我们采用一种称为**[雷诺平均](@entry_id:754341)** (Reynolds averaging) 的数学方法。我们将任何物理量（如速度分量 $u_i$）分解为一个平均部分（已解析尺度，记为 $\overline{u_i}$）和一个脉动部分（次级网格尺度，记为 $u_i'$)，即 $u_i = \overline{u_i} + u_i'$。将这个分解代入原始的动量方程并对其进行平均运算，我们发现，由于[非线性平流](@entry_id:1128854)项（如 $u_j \frac{\partial u_i}{\partial x_j}$）的存在，会出现一些涉及脉动量乘积的平均项 。

具体来说，[非线性平流](@entry_id:1128854)项的平均变为：
$$
\overline{u_j \frac{\partial u_i}{\partial x_j}} = \overline{(\overline{u_j} + u_j') \frac{\partial (\overline{u_i} + u_i')}{\partial x_j}} = \overline{u_j} \frac{\partial \overline{u_i}}{\partial x_j} + \overline{u_j' \frac{\partial u_i'}{\partial x_j}}
$$
在满足不可压缩条件时，右侧第二项可以写成 $\frac{\partial}{\partial x_j} \overline{u_i' u_j'}$。最终，已解析尺度的动量方程中出现了一个新项，即**[雷诺应力张量](@entry_id:270803)** $\overline{u_i' u_j'}$ 的散度。这一项描述了未解析的[湍流](@entry_id:151300)脉动如何通过输送动量来影响已解析尺度的大尺度流动。

这个新出现的项无法仅通过已解析的平均量（如 $\overline{u_i}$ 和 $\overline{p}$）来表达。换言之，描述已解析尺度运动的方程组本身是不封闭的。这就是**[湍流](@entry_id:151300)[闭包问题](@entry_id:160656)** (turbulence closure problem)。为了使模式能够求解，我们必须引入一个**[参数化](@entry_id:265163)** (parameterization) 方案，即一个基于已解析尺度变量来估算这些未解析过程（如[雷诺应力](@entry_id:263788)）平均效应的数学模型。

#### 确定性与随机参数化的分野

传统的[参数化](@entry_id:265163)方案是**确定性**的。给定一个已解析的模式状态，确定性[参数化](@entry_id:265163)方案会给出一个唯一的、确定的次级网格过程倾向值。从统计学的角度看，这相当于用次级网格过程在给定大尺度条件下的**[条件期望](@entry_id:159140)**（或条件均值）来近似其真实效应 。例如，一个确定性方案可能将雷诺应力建模为与大尺度[速度梯度](@entry_id:261686)成正比的耗散项（即涡粘性），这代表了次级网格[湍流](@entry_id:151300)通常会耗散大尺度动能的平均效应。这种方法主要旨在修正模式的系统性偏差。

然而，这种方法存在一个根本性的缺陷：它忽略了次级网格过程围绕其平均值的**涨落**或**变率**。真实的次级网格过程（如单个对流云团或湍涡）是间歇和混沌的。对于同一个大尺度状态，次级网格的反馈在不同时刻可能是不同的。确定性[参数化](@entry_id:265163)用一个单一的平均值取代了整个概率分布，从而系统性地低估了模式的变率，导致诸如“过于无聊”的气候、过窄的[集合预报](@entry_id:1124525)[离散度](@entry_id:168823)等问题。

**[随机参数化](@entry_id:1132435)** (stochastic parameterization) 正是为了解决这一问题而生。它不再提供一个单一的倾向值，而是试图从次级网格倾向的[条件概率分布](@entry_id:163069)中进行一次随机抽样。其核心思想是，一个完整的[参数化](@entry_id:265163)方案不仅应代表次级网格过程的平均效应（一阶矩），还应代表其变率（二阶或更高阶矩）。

随机性主要来源于两个方面：
1.  **内蕴变率（[偶然不确定性](@entry_id:634772)）**: 由次级网格过程本身固有的混沌和[间歇性](@entry_id:275330)导致。例如，即使大尺度环境完全相同，对流的触发和强度也可能因为微小的、不可预测的扰动而有所不同。
2.  **模式结构不确定性（认知不确定性）**: 由于我们对物理过程的认识不完美以及[参数化](@entry_id:265163)方案本身的简化，我们所构建的[参数化](@entry_id:265163)模型本身就是不确定的。随机地扰动[参数化](@entry_id:265163)方案的参数或结构，可以看作是在“[模型空间](@entry_id:635763)”中进行抽样，以表达我们对“最优”模型形式的不确定性。

因此，[随机参数化](@entry_id:1132435)通过引入依赖于模式状态的、具有特定时空相关性的[随机过程](@entry_id:268487)，为模式注入了更真实的变率，从而改善了[概率预报](@entry_id:183505)的可靠性和气候模拟的现实性。

### 随机参数化的核心机制

目前，随机参数化方案主要分为两大类：一类旨在表示未解析的动力学过程（特别是能量的[跨尺度](@entry_id:754544)输送），另一类则旨在表示[物理参数化](@entry_id:1129649)过程（如对流、辐射）本身的不确定性。

#### 随机动能背散射 (SKEB): 描述未解析的动力学反馈

**物理基础：准[二维湍流](@entry_id:198015)中的能量反尺度级串**

在理想的三维[各向同性湍流](@entry_id:199323)中，能量从大尺度向小尺度传递，最终在黏性尺度上耗散，这被称为**正向能量级串**。然而，地球大气和海洋的宏观运动受到旋转和层结的强烈约束，其行为更接近于准[二维湍流](@entry_id:198015)。

准[二维湍流](@entry_id:198015)的一个显著特征是**双级串**现象：能量倾向于从注入尺度向更大尺度传递（**反向能量级串**），而另一个[守恒量](@entry_id:161475)——涡度方差（即**恩斯特洛菲**）则向更小尺度传递（**正向恩斯特洛菲级串**）。这意味着，中尺度的天气过程（如[锋生](@entry_id:189043)、[气旋](@entry_id:262310)发展）会将能量传递给更大尺度的[行星波](@entry_id:195650)和急流，维持着大尺度环流的能量。

数值模式为了维持计算稳定，必须在小尺度（接近格点尺度）引入[数值耗散](@entry_id:168584)或物理耗散，以去除不断在小尺度累积的恩斯特洛菲。然而，这种耗散不可避免地会同[时移](@entry_id:261541)除本应通过反向级串回到大尺度的动能。这导致模式系统性地损失能量，使得大尺度环流的变率偏低，天气系统（如气旋）的强度偏弱。

**SKEB方案的设计原理**

**随机动能背散射**（Stochastic Kinetic Energy Backscatter, SKEB）方案正是为了弥补这一能量损失而设计的。其核心思想是，将模式诊断出的耗散能量的一部分，以随机强迫的形式“背散射”回已解析尺度 。一个设计良好的SKEB方案遵循以下关键原则：

1.  **能量守恒性注入**: SKEB方案会实时诊断模式中由于数值和物理[耗散算子](@entry_id:262598) $\mathcal{D}$ 导致的[动能耗散](@entry_id:751026)率 $P_{\text{diss}} = -\int_{\Omega} \mathbf{u} \cdot \mathcal{D}(\mathbf{u}) \, \mathrm{d}V$。然后，它通过一个随机[强迫项](@entry_id:165986) $\mathbf{f}_{B}$ 向模式注入能量，其注入率在系综平均意义上等于耗散率的一个比例 $\alpha$：$\langle \int_{\Omega} \mathbf{u} \cdot \mathbf{f}_{B} \, \mathrm{d}V \rangle = \alpha P_{\text{diss}}$。这使得能量注入是流依赖的，即耗散越强的地方，背散射也越强。

2.  **尺度和模态选择性**: 注入的能量并非均匀分布或白噪声。根据准[二维湍流](@entry_id:198015)理论，能量主要向上游的**天气尺度**（synoptic scales）传递，并且主要贡献给流场的**旋转分量**（而非辐散分量或重力波）。因此，SKEB的随机强迫场在[谱空间](@entry_id:1132107)上是“红色的”，即能量集中在较低的波数，并且其空间结构通常被设计为**无辐散的**（divergence-free），以确保能量主要进入[涡旋运动](@entry_id:198769)，而不是产生虚假的重力波 [@problem_id:40803, @problem_id:40925]。

3.  **时空相关性**: 真实的[湍流](@entry_id:151300)涡旋在时间和空间上是相关的。因此，SKEB的随机强迫场并非时空上独立的[白噪声](@entry_id:145248)，而是通过一个[随机过程](@entry_id:268487)（如[Ornstein-Uhlenbeck过程](@entry_id:140047)，详见后文）生成，使其具有物理上合理的**时间相关尺度**和**空间相关尺度**。

总而言之，SKEB通过一个能量守恒、谱选择性且时空相关的随机强迫，模拟了未解析尺度向已解析尺度的能量输运，从而有效改善了模式的动[能谱](@entry_id:181780)、天气系统变率和概率预报技巧。

#### 描述[参数化](@entry_id:265163)物理过程中的不确定性

除了动力学过程，模式中的物理过程[参数化](@entry_id:265163)（如云、辐射、对流）也是不确定性的主要来源。

**随机扰动[参数化](@entry_id:265163)趋势项 (SPPT)**

**随机扰动[参数化](@entry_id:265163)趋势项**（Stochastically Perturbed Parameterization Tendencies, SPPT）是一种概念简单但非常有效的方案。它并不修改[物理参数化](@entry_id:1129649)方案的内部逻辑，而是将所有物理过程（辐射、[湍流](@entry_id:151300)、对流等）计算出的总倾向项 $T(\mathbf{x}, t)$ 进行一个乘性的随机扰动 ：
$$
T'(\mathbf{x}, t) = \left(1 + \alpha(\mathbf{x}, t)\right) T(\mathbf{x}, t)
$$
其中 $T'$ 是最终应用到模式[状态变量](@entry_id:138790)上的扰动后倾向，而 $\alpha(\mathbf{x}, t)$ 是一个时空相关的随机扰动场。

为了保证物理真实性，扰动场 $\alpha$ 必须满足以下条件 ：
- **均值为零**: $\mathbb{E}[\alpha] = 0$。这是为了确保在长时间平均下，SPPT不会引入系统性的倾向偏差。
- **有界支持**: 扰动的大小必须被限制在一个合理的范围内，例如 $|\alpha(\mathbf{x}, t)| \le a$，其中 $a$ 是一个小于1的常数。这可以防止倾向被过度放大或出现不符合物理的符号反转。一种常见的实现方式是，首先生成一个标准[高斯随机场](@entry_id:749757) $\xi$，然后通过一个[S型函数](@entry_id:137244)（如[双曲正切函数](@entry_id:634307) $\tanh$）将其映射到有界区间内：$\alpha = a \tanh(\kappa \xi)$。
- **时空相关性**: 与SKEB类似，$\alpha$ 场也应具有物理上合理的时空相关性，以代表模式误差的系统性结构。

SPPT的主要优点是通用性强，可以应用于任何模式，并且能够有效增加集合预报的离散度。其主要缺点在于，它是在所有物理过程之后进行的总扰动，因此通常会**破坏**原始物理参数化方案所满足的**守恒定律**（如总能量或水汽守恒）。这是因为它对不同[守恒量](@entry_id:161475)的倾向项乘以了同一个随机数，而没有考虑它们之间的物理约束。

**[随机对流](@entry_id:1132416)**

对流是大气中最具间歇性和不确定性的过程之一。即使网格平均的[热力学](@entry_id:172368)廓线（如对流有效位能CAPE）完全相同，次级网格的微小抬升、湿度不均匀性等因素也会导致对流是否触发以及其强度变得非常不确定。[随机对流](@entry_id:1132416)方案旨在将这种不确定性直接引入对流[参数化](@entry_id:265163)方案内部。

一种常见的方法是**随机触发** (stochastic triggering)。传统的确定性方案通常设定一个阈值，例如当网格平均的CAPE超过某个值且对流抑制能（CIN）低于某个值时，对流就被触发。而随机方案则将此过程概率化。

例如，我们可以定义一个“净激活变量” $X$ ：
$$
X = C - \beta I - C_{0} + \eta
$$
其中 $C$ 和 $I$ 分别代表次级网格尺度的[CAPE和CIN](@entry_id:1122051)，它们本身因为次级网格的异质性而是[随机变量](@entry_id:195330)；$\beta$ 是一个权重系数；$C_0$ 是一个确定性的阈值（例如代表干空气卷入的影响）；而 $\eta$ 则可以代表其他未解析的[随机动力学](@entry_id:187867)强迫（如来自SKEB的扰动）。

在这个模型中，对流被触发的条件是 $X > 0$。由于 $C, I, \eta$ 都是[随机变量](@entry_id:195330)，即使它们的均值（对应于网格平均值）使得 $\mathbb{E}[X]$ 为负，仍然存在一个正的概率 $P(X>0)$ 使得对流在网格的某处被触发。反之，即使 $\mathbb{E}[X]$ 为正，也存在一个非零概率 $P(X \le 0)$ 使得对流不被触发。通过这种方式，随机触发机制将确定性的“开/关”决策转变为平滑的概率激活，这更符合对流的真实物理行为。例如，对于一组参数 $\mu_{C} = 200, \sigma_{C} = 60, \mu_{I} = 80, \sigma_{I} = 50, \rho = -0.3, \beta = 1.5, C_{0} = 50, \sigma_{\eta} = 40$（单位均为 $J/kg$），确定性判断（仅基于均值）会得到净激活量为 $200 - 1.5 \times 80 - 50 = 30 > 0$，意味着对流总是触发。而随机模型则计算出触发概率约为 $0.6018$，这更加真实地反映了近阈值状态下的不确定性 。

除了随机触发，其他[随机对流](@entry_id:1132416)方法还包括随机扰动对流方案中的关键参数，如夹卷率、质量通量[闭包](@entry_id:148169)参数等。

### [随机建模](@entry_id:261612)的数学基础

有效实施[随机参数化](@entry_id:1132435)方案不仅需要物理洞察力，还需要对[随机过程](@entry_id:268487)的数学工具有深入的理解。

#### [有色噪声](@entry_id:265434)与白噪声

在构建随机强迫时，最简单的选择是**[高斯白噪声](@entry_id:749762)** (Gaussian white noise)。它在数学上被定义为一个均值为零、且在任意不同时刻都完全不相关的[随机过程](@entry_id:268487)。其[自协方差函数](@entry_id:262114)是一个狄拉克 $\delta$ 函数：$\mathbb{E}[\xi(t)\xi(s)] = \delta(t-s)$。根据[维纳-辛钦定理](@entry_id:188017)，其功率谱密度在所有频率上都是一个常数，即 $S(\omega) = \text{const}$，这也是“白”噪声名称的由来 。

然而，白噪声是一个物理上不真实的理想化模型。首先，它意味着无穷大的总能量（[功率谱](@entry_id:159996)的积分发散）。其次，物理过程中的随机波动总是在某个时间尺度上相关的。一个更真实且常用的模型是**Ornstein-Uhlenbeck (OU) 过程**。这是一个均值为零的平稳[高斯过程](@entry_id:182192)，其[自协方差函数](@entry_id:262114)随时间差呈指数衰减：$\mathbb{E}[\eta(t)\eta(s)] = \exp(-|t-s|/\tau)$，其中 $\tau$ 是**相关时间**。这种具有非零[相关时间](@entry_id:176698)的噪声被称为**有色噪声** (colored noise)。OU过程的[功率谱](@entry_id:159996)是一个洛伦兹谱 $S(\omega) \propto (1+(\omega\tau)^2)^{-1}$，它在低频区近似为常数，但在高频区以 $\omega^{-2}$ 的速率衰减。

在数值模式中，使用有色噪声（如OU过程）而非白噪声至关重要。由于模式的时间步长 $\Delta t$ 是有限的，任何高于[奈奎斯特频率](@entry_id:276417) $\pi/\Delta t$ 的频率分量都会被“[混叠](@entry_id:146322)”到低频部分，造成误差。[白噪声](@entry_id:145248)在所有频率上都有能量，因此[混叠](@entry_id:146322)效应非常严重。而OU过程的高频能量衰减，显著减轻了[混叠](@entry_id:146322)问题。这两种噪声的另一个关键区别体现在它们对离散时间步内变量增量的影响上：对于[白噪声](@entry_id:145248)，增量的方差正比于 $\Delta t$；而对于OU过程，当 $\Delta t \ll \tau$ 时，增量的方差正比于 $(\Delta t)^2$，这表明OU过程在小时间尺度上是“更平滑”的 。

#### [Itô积分](@entry_id:272774)与[Stratonovich积分](@entry_id:266086)

当随机噪声以**乘性**方式（即噪声项的系数依赖于[状态变量](@entry_id:138790)本身，如 $b(X_t)dW_t$）进入方程时，如何定义这个随机项的积分就变得不唯一。最主要的两种解释是**[Itô积分](@entry_id:272774)**和**[Stratonovich积分](@entry_id:266086)** 。

- **Itô 积分**: 在定义[黎曼和](@entry_id:137667)时，被积函数 $b(X_t)$ 在每个小区间的**左端点**取值。这使得积分是非预期的（non-anticipative），即在时刻 $t$ 的积分增量仅依赖于时刻 $t$ 之前的信息。这在数学上带来了便利（例如，积分结果是[鞅](@entry_id:267779)），但其链式法则（称为Itô引理）与普通微积分不同，会多出一个二阶导数项：
  $$
  df(X_t) = \left[ a(X_t)f'(X_t) + \frac{1}{2} b(X_t)^2 f''(X_t) \right] dt + b(X_t)f'(X_t) dW_t
  $$

- **Stratonovich 积分**: 在定义[黎曼和](@entry_id:137667)时，被积函数在每个小区间的**中点**取值。这种定义的优点是其[链式法则](@entry_id:190743)与普通微积分的形式完全相同。更重要的是，根据[Wong-Zakai定理](@entry_id:260756)，一个由[相关时间](@entry_id:176698)趋于零的[有色噪声](@entry_id:265434)驱动的随机微分方程，其极限形式是Stratonovich方程。因此，Stratonovich解释通常被认为更接近物理现实，因为它代表了将快速但非瞬时的物理扰动理想化为[白噪声](@entry_id:145248)的过程。

这两种解释可以通过一个确定的“漂移修正”项相互转换。一个Stratonovich形式的方程：
$$
dX_t = a(X_t)\,dt + b(X_t)\,\circ dW_t
$$
等价于以下Itô形式的方程：
$$
dX_t = \left[ a(X_t) + \frac{1}{2}b(X_t)b'(X_t) \right] dt + b(X_t)\,dW_t
$$
其中 $b'(X_t)$ 是 $b$ 对 $X_t$ 的导数，$\circ$ 符号表示[Stratonovich积分](@entry_id:266086) [@problem_id:40938, @problem_id:40952]。这个修正项 $\frac{1}{2}b(X_t)b'(X_t)$ 被称为**噪声诱导漂移** (noise-induced drift)。

在设计随机参数化方案时，理解这一区别至关重要。例如，一个物理上看似“无偏”的Stratonovich方案（例如，随机项的确定性部分为零），在计算其系综平均演化时，必须先将其转换为Itô形式。转换后出现的噪声诱导漂移项可能会给系综平均带来一个系统性的偏差。为了实现真正的无偏，方案的设计必须包含一个确定性部分，以精确抵消这个噪声诱导漂移 。例如，对于一个动能方程 $dE/dt = \dots + (aE + \sigma E \circ dW_t)$, 要使其系综平均无偏，必须设定 $a = -\sigma^2/2$。

总之，随机参数化已经从一个前沿研究思想发展成为业务化数值预报和气候模拟中不可或缺的一部分。它通过在模式中系统性地代表次级网格过程的不确定性，为提升预报的可靠性和气候模拟的真实性提供了强有力的途径。