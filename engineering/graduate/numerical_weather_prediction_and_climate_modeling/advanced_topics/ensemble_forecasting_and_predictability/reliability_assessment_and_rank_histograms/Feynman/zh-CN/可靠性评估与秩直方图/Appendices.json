{
    "hands_on_practices": [
        {
            "introduction": "我们从基础开始。如果一个集合预报系统是完全可靠的，其秩直方图在统计上应该是什么样子？本练习旨在建立一个理论基准——即均匀分布——并量化围绕此理想状态的预期随机波动。这是从定性的“平坦”直方图概念到定量化模型的关键第一步。",
            "id": "4081430",
            "problem": "考虑一个用于在单个位置和预报时效对标量进行概率性检验的数值天气预报（NWP）集合预报系统。使用一个成员数为 $m$ 的集合为 $N$ 个独立的检验时间构建集合排序直方图。在可靠性假设下，检验观测值与集合成员是可交换的，因此观测值在 $m$ 个确定性集合成员中的排序在 $m+1$ 个可能的排序区间内呈均匀分布。\n\n假设以下基本条件：\n- 集合成员数为 $m=20$，因此有 $m+1$ 个排序区间。\n- $N$ 个检验时间是独立的，其中 $N=400$。\n- 在可靠性假设下，每次检验的排序落入每个区间的概率相等。\n\n仅使用基本概率定义（伯努利试验的指示变量、期望和方差）以及从具有分类结果的独立试验构建多项式模型的方法，推导每个排序区间的期望计数和单个区间内计数的标准差。然后，根据给定的 $m$ 和 $N$ 计算这些量的值。\n\n将最终数值表示为一个单行矩阵中的数对，顺序为“每个排序区间的期望计数”和“单个区间内计数的标准差”。将答案四舍五入到四位有效数字。不需要单位。",
            "solution": "本题要求推导并计算一个可靠的集合预报系统中，单个排序区间内计数的期望值和标准差。\n\n首先，我们必须验证题目陈述的有效性。\n\n### 步骤 1：提取已知条件\n- 集合成员数：$m$\n- 独立检验时间的数量：$N$\n- 在可靠性假设下，观测值的排序在 $m+1$ 个可能的排序区间内呈均匀分布。\n- 具体数值：$m=20$， $N=400$。\n- 任务：使用基本概率定义（指示变量、期望、方差）和多项式模型背景，推导每个排序区间的期望计数和单个区间内计数的标准差。并根据给定的 $m$ 和 $N$ 进行计算。\n- 输出格式：一对数值（期望计数，标准差），四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，因为排序直方图及其统计特性是气象学中集合预报检验的基石。诸如可靠性导致均匀排序分布的假设，以及统计模型（独立试验导致多项式分布）都是该领域的标准方法。该问题是适定的，为得到唯一解提供了所有必要的参数（$m$、$N$）和假设。语言客观而精确。给定的数值（$m=20$，$N=400$）是符合实际的。因此，该问题被认为是有效的。\n\n### 步骤 3：结论与行动\n问题有效。我们继续进行求解。\n\n### 推导\n\n设 $K$ 为可能的排序数或区间数。由于观测值是在 $m$ 个集合成员中进行排序，因此有 $m+1$ 个可能的排序（从小于所有成员到大于所有成员）。\n$$K = m+1$$\n题目指出，对于一个可靠的集合，检验观测值落入这 $K$ 个区间中任意一个的概率是均匀的。设 $p_j$ 为观测值落入区间 $j$ 的概率，其中 $j \\in \\{1, 2, ..., K\\}$。\n$$p_j = p = \\frac{1}{K} = \\frac{1}{m+1}$$\n这对所有区间 $j$ 都成立。\n\n我们考虑 $N$ 次独立的检验时间。落入特定区间 $j$ 的观测计数，我们用随机变量 $C_j$ 表示，是 $N$ 次独立试验的结果。\n\n为了推导 $C_j$ 的期望和方差，我们按要求使用指示变量法。对于每次检验时间 $i \\in \\{1, 2, ..., N\\}$，我们为一个特定的、任意的区间 $j$ 定义一个指示随机变量 $I_{i,j}$：\n$$\nI_{i,j} =\n\\begin{cases}\n1  \\text{如果观测 } i \\text{ 落入区间 } j \\\\\n0  \\text{其他情况}\n\\end{cases}\n$$\n每个 $I_{i,j}$ 服从伯努利分布，其“成功”概率为 $p = \\frac{1}{m+1}$。一个伯努利随机变量的期望是其成功概率：\n$$\\mathbb{E}[I_{i,j}] = 1 \\cdot P(I_{i,j}=1) + 0 \\cdot P(I_{i,j}=0) = p = \\frac{1}{m+1}$$\n一个伯努利随机变量的方差由 $p(1-p)$ 给出：\n$$\\text{Var}(I_{i,j}) = \\mathbb{E}[I_{i,j}^2] - (\\mathbb{E}[I_{i,j}])^2$$\n对于指示变量，$I_{i,j}^2 = I_{i,j}$，所以 $\\mathbb{E}[I_{i,j}^2] = \\mathbb{E}[I_{i,j}] = p$。\n$$\\text{Var}(I_{i,j}) = p - p^2 = p(1-p) = \\frac{1}{m+1}\\left(1 - \\frac{1}{m+1}\\right)$$\n\n在所有 $N$ 次检验时间中，区间 $j$ 的总计数 $C_j$ 是这些独立指示变量的总和：\n$$C_j = \\sum_{i=1}^{N} I_{i,j}$$\n这种结构，即 $N$ 次独立同分布的伯努利试验之和，定义了一个二项分布 $C_j \\sim B(N, p)$。这与题目要求的多项式模型背景相符，因为多项式分布中任何单一类别的计数其边际分布是二项分布。\n\n区间 $j$ 中的期望计数 $\\mathbb{E}[C_j]$，可以使用期望的线性性质求得：\n$$\\mathbb{E}[C_j] = \\mathbb{E}\\left[\\sum_{i=1}^{N} I_{i,j}\\right] = \\sum_{i=1}^{N} \\mathbb{E}[I_{i,j}]$$\n由于对所有 $i$ 都有 $\\mathbb{E}[I_{i,j}] = p$：\n$$\\mathbb{E}[C_j] = \\sum_{i=1}^{N} p = Np = \\frac{N}{m+1}$$\n这就是每个排序区间的期望计数的一般表达式。\n\n区间 $j$ 中计数的方差 $\\text{Var}(C_j)$，可以通过注意到检验时间是独立的来求得，这意味着对于不同的 $i$ ，指示变量 $I_{i,j}$ 是独立的。对于独立随机变量的和，其方差是各方差之和：\n$$\\text{Var}(C_j) = \\text{Var}\\left(\\sum_{i=1}^{N} I_{i,j}\\right) = \\sum_{i=1}^{N} \\text{Var}(I_{i,j})$$\n由于对所有 $i$ 都有 $\\text{Var}(I_{i,j}) = p(1-p)$：\n$$\\text{Var}(C_j) = \\sum_{i=1}^{N} p(1-p) = Np(1-p)$$\n代入 $p = \\frac{1}{m+1}$：\n$$\\text{Var}(C_j) = N \\left(\\frac{1}{m+1}\\right) \\left(1 - \\frac{1}{m+1}\\right) = N \\frac{1}{m+1} \\frac{m+1-1}{m+1} = \\frac{Nm}{(m+1)^2}$$\n单个区间内计数的标准差 $\\sigma_{C_j}$ 是方差的平方根：\n$$\\sigma_{C_j} = \\sqrt{\\text{Var}(C_j)} = \\sqrt{\\frac{Nm}{(m+1)^2}}$$\n\n现在，我们使用给定的数值 $m=20$ 和 $N=400$ 计算这些量。\n区间数为 $K = m+1 = 20+1 = 21$。\n\n每个排序区间的期望计数为：\n$$\\mathbb{E}[C_j] = \\frac{N}{m+1} = \\frac{400}{21} \\approx 19.047619...$$\n四舍五入到四位有效数字，我们得到 $19.05$。\n\n单个区间内计数的标准差为：\n$$\\sigma_{C_j} = \\sqrt{\\frac{Nm}{(m+1)^2}} = \\sqrt{\\frac{400 \\cdot 20}{(20+1)^2}} = \\sqrt{\\frac{8000}{21^2}} = \\sqrt{\\frac{8000}{441}} \\approx \\sqrt{18.140589...} \\approx 4.259176...$$\n四舍五入到四位有效数字，我们得到 $4.259$。\n\n最终答案是这两个值的数对。",
            "answer": "$$\\boxed{\\begin{pmatrix} 19.05 & 4.259 \\end{pmatrix}}$$"
        },
        {
            "introduction": "在建立了理想模型的统计特性之后，一个实际问题随之而来：我们如何判断一个观测到的秩直方图是否“足够平坦”，从而认为它是可靠的？本练习引入了卡方拟合优度检验，这是一个用于此目的的标准统计工具。它为预报检验中的假设检验提供了一种形式化的方法。",
            "id": "4081467",
            "problem": "在基于集合的数值天气预报中，概率预报的可靠性通常通过检验观测值相对于一个 $m$ 成员集合的等级直方图来评估。对于每个检验时间，使用中间秩将观测值在 $m$ 个有序的集合成员中排序，从而创建 $k=m+1$ 个互斥的等级区间。在一个可靠的集合和独立的个例下，等级在 $k$ 个区间上是均匀分布的。\n\n考虑 $n$ 个独立的预报-观测对，它们在 $k$ 个区间上产生等级计数 $\\{O_{r}\\}_{r=1}^{k}$。假设可靠性零假设成立，这意味着一个多项抽样模型，其中各区间的概率相等，即 $p_{r}=1/k$。\n\n仅使用多项模型的基本定义和多元中心极限定理，通过以下步骤推导一个用于检验等级分布均匀性的大样本拟合优度检验：\n1. 基于计数向量关于其期望的渐近协方差构建一个二次型，以及\n2. 将其简化为一个标量统计量，该统计量加性地依赖于观测计数与其期望之间的逐区间差异。\n\n证明您的检验统计量的零假设渐近分布是自由度为 $k-1$ 的卡方分布，并解释损失一个自由度的原因。\n\n然后，对于一个有 $m=10$ 个成员的集合，在 $n=220$ 个独立个例中进行观测，得到的等级直方图有 $k=m+1=11$ 个区间，其观测计数为\n$\\{O_{r}\\}_{r=1}^{11}=\\{14, 19, 20, 26, 25, 22, 21, 24, 18, 17, 14\\}$。\n在可靠性零假设下，使用零模型隐含的期望计数 $E_{r}$，计算您的检验统计量的值。将您的最终数值结果表示为一个无单位的纯数，并四舍五入到四位有效数字。",
            "solution": "该问题要求推导一个用于检验等级直方图均匀性的大样本拟合优度检验、其渐近分布，并将其应用于一个特定数据集。对问题陈述的验证证实了其科学和数学上的合理性、完整性和清晰性。因此，我们可以着手进行解答。\n\n设集合成员的数量为 $m$。观测值的等级被分到 $k = m+1$ 个区间中。给定 $n$ 个独立的预报-观测对，得到每个区间中的观测计数的向量 $\\mathbf{O} = (O_1, O_2, \\ldots, O_k)^T$，其中 $\\sum_{r=1}^{k} O_r = n$。\n\n零假设 $H_0$ 指出集合是可靠的，这意味着观测值落入任何等级区间的概率是相等的。因此，任何区间 $r$ 的概率为 $p_r = 1/k$。在 $H_0$ 下，计数向量 $\\mathbf{O}$ 服从多项分布，$\\mathbf{O} \\sim \\text{Multinomial}(n; p_1, p_2, \\ldots, p_k)$，其中对所有 $r$ 都有 $p_r = 1/k$。\n\n每个区间中的期望计数为 $E_r = E[O_r] = n p_r = n/k$。期望计数的向量为 $\\mathbf{E} = (E_1, E_2, \\ldots, E_k)^T$。\n\n向量 $\\mathbf{O}$ 的 $k \\times k$ 协方差矩阵 $\\boldsymbol{\\Sigma}$ 的元素由以下公式给出：\n$$\n\\text{Var}(O_r) = \\Sigma_{rr} = n p_r (1 - p_r) = n \\frac{1}{k} \\left(1 - \\frac{1}{k}\\right) = \\frac{n(k-1)}{k^2}\n$$\n$$\n\\text{Cov}(O_r, O_s) = \\Sigma_{rs} = -n p_r p_s = -n \\frac{1}{k} \\frac{1}{k} = -\\frac{n}{k^2} \\quad \\text{for } r \\neq s\n$$\n\n由于约束 $\\sum_{r=1}^k O_r = n$，向量 $\\mathbf{O}$ 的分量不是线性无关的。这意味着协方差矩阵 $\\boldsymbol{\\Sigma}$ 是奇异的，其秩为 $\\text{rank}(\\boldsymbol{\\Sigma}) = k-1$。\n\n根据多元中心极限定理，对于大的 $n$，$\\mathbf{O}$ 的分布趋近于均值为 $\\mathbf{E}$、协方差矩阵为 $\\boldsymbol{\\Sigma}$ 的多元正态分布。也就是说，偏差向量 $\\mathbf{d} = \\mathbf{O} - \\mathbf{E}$ 渐近地服从 $N(\\mathbf{0}, \\boldsymbol{\\Sigma})$ 分布。\n\n为了构建所需的二次型，我们需要协方差矩阵的逆。由于 $\\boldsymbol{\\Sigma}$ 是奇异的，我们不能使用标准的逆。一个常见的方法是考虑前 $k-1$ 个计数的降维向量 $\\mathbf{O}^* = (O_1, O_2, \\ldots, O_{k-1})^T$。该向量渐近地服从一个 $(k-1)$ 元正态分布，其均值为 $\\mathbf{E}^* = (E_1, \\ldots, E_{k-1})^T$，协方差矩阵为一个非奇异的 $(k-1) \\times (k-1)$ 矩阵 $\\boldsymbol{\\Sigma}^*$，即 $\\boldsymbol{\\Sigma}$ 的左上角子矩阵。\n\n检验统计量 $Q$ 于是可以构建为一个二次型：\n$$\nQ = (\\mathbf{O}^* - \\mathbf{E}^*)^T (\\boldsymbol{\\Sigma}^*)^{-1} (\\mathbf{O}^* - \\mathbf{E}^*)\n$$\n根据其构造，该统计量将渐近地服从自由度为 $k-1$ 的卡方分布。\n\n矩阵 $\\boldsymbol{\\Sigma}^*$ 可以写成 $\\boldsymbol{\\Sigma}^* = a\\mathbf{I}_{k-1} + b\\mathbf{J}_{k-1}$，其中 $\\mathbf{I}_{k-1}$ 是单位矩阵，$\\mathbf{J}_{k-1}$ 是全一矩阵。我们有 $\\Sigma^*_{rr} = a+b = \\frac{n(k-1)}{k^2}$ 以及 $\\Sigma^*_{rs} = b = -\\frac{n}{k^2}$。这得出 $a = \\frac{n(k-1)}{k^2} - (-\\frac{n}{k^2}) = \\frac{nk}{k^2} = \\frac{n}{k}$。其逆矩阵已知为 $(\\boldsymbol{\\Sigma}^*)^{-1} = \\frac{1}{a}\\mathbf{I}_{k-1} - \\frac{b}{a(a+(k-1)b)}\\mathbf{J}_{k-1}$。\n代入 $a = n/k$ 和 $b = -n/k^2$：\n$$\na + (k-1)b = \\frac{n}{k} + (k-1)\\left(-\\frac{n}{k^2}\\right) = \\frac{nk - n(k-1)}{k^2} = \\frac{n}{k^2}\n$$\n所以，逆矩阵为：\n$$\n(\\boldsymbol{\\Sigma}^*)^{-1} = \\frac{k}{n}\\mathbf{I}_{k-1} - \\frac{-n/k^2}{(n/k)(n/k^2)}\\mathbf{J}_{k-1} = \\frac{k}{n}\\mathbf{I}_{k-1} + \\frac{k}{n}\\mathbf{J}_{k-1} = \\frac{k}{n}(\\mathbf{I}_{k-1} + \\mathbf{J}_{k-1})\n$$\n令 $\\mathbf{d}^* = \\mathbf{O}^* - \\mathbf{E}^* = (O_1-E_1, \\ldots, O_{k-1}-E_{k-1})^T$。该二次型为：\n$$\nQ = (\\mathbf{d}^*)^T \\left[\\frac{k}{n}(\\mathbf{I}_{k-1} + \\mathbf{J}_{k-1})\\right] \\mathbf{d}^* = \\frac{k}{n} \\left( (\\mathbf{d}^*)^T \\mathbf{d}^* + (\\mathbf{d}^*)^T \\mathbf{J}_{k-1} \\mathbf{d}^* \\right)\n$$\n这可以简化为：\n$$\nQ = \\frac{k}{n} \\left( \\sum_{r=1}^{k-1} (O_r - E_r)^2 + \\left(\\sum_{r=1}^{k-1} (O_r - E_r)\\right)^2 \\right)\n$$\n根据约束 $\\sum_{r=1}^{k} O_r = n$ 和 $\\sum_{r=1}^{k} E_r = n$，我们有 $\\sum_{r=1}^{k} (O_r - E_r) = 0$。\n这意味着 $\\sum_{r=1}^{k-1} (O_r - E_r) = -(O_k - E_k)$。将此代入 $Q$ 的表达式中：\n$$\nQ = \\frac{k}{n} \\left( \\sum_{r=1}^{k-1} (O_r - E_r)^2 + (-(O_k - E_k))^2 \\right) = \\frac{k}{n} \\sum_{r=1}^{k} (O_r - E_r)^2\n$$\n由于 $E_r = n/k$，我们可以将其写为：\n$$\nQ = \\sum_{r=1}^{k} \\frac{(O_r - E_r)^2}{n/k} = \\sum_{r=1}^{k} \\frac{(O_r - E_r)^2}{E_r}\n$$\n这就是著名的皮尔逊卡方统计量。该推导满足了构建一个二次型并将其简化为基于逐区间差异的标量统计量的要求。\n\n该统计量的零假设渐近分布是 $\\chi^2_{k-1}$（一个自由度为 $k-1$ 的卡方分布）。从 $k$ 个区间中损失一个自由度是由于施加在计数上的单个线性约束：$\\sum_{r=1}^k O_r = n$。这个约束意味着，如果任何 $k-1$ 个计数的值是已知的，那么第 $k$ 个计数就完全确定了。因此，系统中只有 $k-1$ 个自由变化的量或“自由度”。在数学上，偏差向量 $\\mathbf{d} = \\mathbf{O} - \\mathbf{E}$ 被约束在 $\\mathbb{R}^k$ 的一个 $(k-1)$ 维子空间内，并且协方差矩阵 $\\boldsymbol{\\Sigma}$ 的秩是 $k-1$，这决定了最终得到的卡方分布的自由度。\n\n现在，我们将此检验应用于给定的数据：\n- 集合成员数 $m = 10$。\n- 区间数 $k = m+1 = 11$。\n- 个例数 $n = 220$。\n- 观测计数 $\\{O_r\\}_{r=1}^{11} = \\{14, 19, 20, 26, 25, 22, 21, 24, 18, 17, 14\\}$。\n\n在可靠性零假设下，每个区间的期望计数为：\n$$\nE_r = \\frac{n}{k} = \\frac{220}{11} = 20\n$$\n检验统计量计算如下：\n$$\n\\chi^2 = \\sum_{r=1}^{11} \\frac{(O_r - E_r)^2}{E_r} = \\sum_{r=1}^{11} \\frac{(O_r - 20)^2}{20}\n$$\n让我们计算每个区间的项：\n$$\n\\chi^2 = \\frac{(14-20)^2}{20} + \\frac{(19-20)^2}{20} + \\frac{(20-20)^2}{20} + \\frac{(26-20)^2}{20} + \\frac{(25-20)^2}{20} + \\frac{(22-20)^2}{20} + \\frac{(21-20)^2}{20} + \\frac{(24-20)^2}{20} + \\frac{(18-20)^2}{20} + \\frac{(17-20)^2}{20} + \\frac{(14-20)^2}{20}\n$$\n$$\n\\chi^2 = \\frac{(-6)^2}{20} + \\frac{(-1)^2}{20} + \\frac{0^2}{20} + \\frac{6^2}{20} + \\frac{5^2}{20} + \\frac{2^2}{20} + \\frac{1^2}{20} + \\frac{4^2}{20} + \\frac{(-2)^2}{20} + \\frac{(-3)^2}{20} + \\frac{(-6)^2}{20}\n$$\n$$\n\\chi^2 = \\frac{36}{20} + \\frac{1}{20} + \\frac{0}{20} + \\frac{36}{20} + \\frac{25}{20} + \\frac{4}{20} + \\frac{1}{20} + \\frac{16}{20} + \\frac{4}{20} + \\frac{9}{20} + \\frac{36}{20}\n$$\n$$\n\\chi^2 = \\frac{36+1+0+36+25+4+1+16+4+9+36}{20} = \\frac{168}{20} = 8.4\n$$\n问题要求结果四舍五入到四位有效数字。\n$$\n\\chi^2 = 8.400\n$$",
            "answer": "$$\n\\boxed{8.400}\n$$"
        },
        {
            "introduction": "本练习揭示了解读秩直方图时的一个关键陷阱。它通过一个精心构建的反例表明，一个看似完美的、均匀的（即“可靠的”）无条件秩直方图，可能掩盖了显著的、系统性的预报误差。这些误差只有在根据相关条件（如天气型）对数据进行分层时才会显现出来。这个练习强调了条件检验的重要性，并深化了对可靠性真正含义的理解。",
            "id": "4081443",
            "problem": "在基于集合的数值天气预报 (NWP) 和气候模拟中，预报集合的可靠性可以通过检验观测值在集合成员中的等级所构成的等级直方图来评估。对于一个大小为 $m$ 的可交换集合，在可靠的情况下，观测值在 $m$ 个排序后的集合成员中的等级 $R$ 在集合 $\\{1,2,\\ldots,m+1\\}$ 上是均匀分布的，这在无条件情况下以及在可能影响预报和观测联合分布的任何协变量 $C$ 的条件下均成立。考虑一个二元状态指示器 $C \\in \\{0,1\\}$，它捕捉了两种不同的气象状态（例如，天气尺度稳定与对流）。假设一个大小为 $m=2$ 的可交换集合，并定义条件等级分布如下：\n- 在状态 $C=0$（系统性离散度不足的情况）下，观测值倾向于落在集合离散度之外。条件等级概率为\n$$\n\\mathbb{P}(R=1 \\mid C=0)=\\mathbb{P}(R=3 \\mid C=0)=\\frac{9}{20}, \\quad \\mathbb{P}(R=2 \\mid C=0)=\\frac{1}{10}.\n$$\n- 在状态 $C=1$（系统性离散度过大的情况）下，观测值倾向于落在集合成员之间。条件等级概率为\n$$\n\\mathbb{P}(R=1 \\mid C=1)=\\mathbb{P}(R=3 \\mid C=1)=\\frac{1}{5}, \\quad \\mathbb{P}(R=2 \\mid C=1)=\\frac{3}{5}.\n$$\n设状态频率为 $\\mathbb{P}(C=0)=p$ 和 $\\mathbb{P}(C=1)=1-p$。仅使用等级直方图的定义和全概率定律，确定使无条件等级直方图完全平坦的 $p$ 值，即，\n$$\n\\mathbb{P}(R=r)=\\frac{1}{3} \\quad \\text{对每个 } r \\in \\{1,2,3\\}.\n$$\n将你的答案表示为精确分数。",
            "solution": "问题要求我们确定参数 $p$ 的值，该参数代表气象状态 $C=0$ 的频率，使得集合预报的无条件等级直方图是平坦的。给定集合大小为 $m=2$，这意味着检验观测的等级 $R$ 可以在集合 $\\{1, 2, \\ldots, m+1\\}$ 中取值，即 $R \\in \\{1, 2, 3\\}$。\n\n平坦或均匀的无条件等级直方图意味着观测值落在 $m+1 = 3$ 个可能等级中任何一个的概率是相等的。这个条件可以正式表述为：\n$$\n\\mathbb{P}(R=r) = \\frac{1}{m+1} = \\frac{1}{3} \\quad \\text{对每个 } r \\in \\{1, 2, 3\\}.\n$$\n问题给出了在气象状态 $C \\in \\{0, 1\\}$ 条件下等级 $R$ 的条件概率。这些状态发生的概率为 $\\mathbb{P}(C=0)=p$ 和 $\\mathbb{P}(C=1)=1-p$。\n\n为了求无条件概率 $\\mathbb{P}(R=r)$，我们必须使用全概率定律，该定律允许我们通过对由各条件概率加权的条件概率求和来计算无条件概率。对于这两种状态，该定律表示为：\n$$\n\\mathbb{P}(R=r) = \\mathbb{P}(R=r \\mid C=0)\\mathbb{P}(C=0) + \\mathbb{P}(R=r \\mid C=1)\\mathbb{P}(C=1).\n$$\n代入给定的状态频率，我们得到：\n$$\n\\mathbb{P}(R=r) = \\mathbb{P}(R=r \\mid C=0) \\cdot p + \\mathbb{P}(R=r \\mid C=1) \\cdot (1-p).\n$$\n我们可以通过对任意一个等级 $r \\in \\{1, 2, 3\\}$ 强制施加条件 $\\mathbb{P}(R=r) = \\frac{1}{3}$ 来建立一个关于 $p$ 的方程。因为概率之和 $\\sum_{r=1}^3 \\mathbb{P}(R=r)$ 必须等于 $1$，所以满足任意两个等级的条件会自动满足第三个等级的条件。因此，我们只需要对单个等级求解方程。我们选择 $r=1$。\n\n给定的 $r=1$ 的条件概率是：\n$$\n\\mathbb{P}(R=1 \\mid C=0) = \\frac{9}{20}\n$$\n$$\n\\mathbb{P}(R=1 \\mid C=1) = \\frac{1}{5}\n$$\n将无条件概率 $\\mathbb{P}(R=1)$ 设为 $\\frac{1}{3}$，我们得到方程：\n$$\n\\frac{1}{3} = \\left(\\frac{9}{20}\\right) p + \\left(\\frac{1}{5}\\right)(1-p).\n$$\n现在我们求解这个关于 $p$ 的线性方程。首先，展开项 $(1-p)$：\n$$\n\\frac{1}{3} = \\frac{9}{20} p + \\frac{1}{5} - \\frac{1}{5} p.\n$$\n接下来，我们将所有含 $p$ 的项移到方程的一边，常数项移到另一边：\n$$\n\\frac{1}{3} - \\frac{1}{5} = \\frac{9}{20} p - \\frac{1}{5} p.\n$$\n为了合并这些项，我们找到公分母。对于左边，公分母是 $15$。对于右边，公分母是 $20$。\n$$\n\\frac{5}{15} - \\frac{3}{15} = \\left(\\frac{9}{20} - \\frac{4}{20}\\right) p.\n$$\n化简两边得到：\n$$\n\\frac{2}{15} = \\left(\\frac{5}{20}\\right) p.\n$$\n右边的分数可以化简为 $\\frac{5}{20} = \\frac{1}{4}$。\n$$\n\\frac{2}{15} = \\frac{1}{4} p.\n$$\n最后，为了分离出 $p$，我们将两边都乘以 $4$：\n$$\np = 4 \\times \\frac{2}{15} = \\frac{8}{15}.\n$$\n这就得到了所需的 $p$ 值。为确保一致性，我们可以验证这个 $p$ 值同样能得出 $\\mathbb{P}(R=2) = \\frac{1}{3}$。我们有 $p = \\frac{8}{15}$ 和 $1-p = 1 - \\frac{8}{15} = \\frac{7}{15}$。对于 $r=2$ 的条件概率是：\n$$\n\\mathbb{P}(R=2 \\mid C=0)=\\frac{1}{10}, \\quad \\mathbb{P}(R=2 \\mid C=1)=\\frac{3}{5}.\n$$\n无条件概率是：\n$$\n\\mathbb{P}(R=2) = \\left(\\frac{1}{10}\\right) \\left(\\frac{8}{15}\\right) + \\left(\\frac{3}{5}\\right) \\left(\\frac{7}{15}\\right) = \\frac{8}{150} + \\frac{21}{75}.\n$$\n使用公分母 $150$：\n$$\n\\mathbb{P}(R=2) = \\frac{8}{150} + \\frac{21 \\times 2}{75 \\times 2} = \\frac{8}{150} + \\frac{42}{150} = \\frac{50}{150} = \\frac{1}{3}.\n$$\n$r=2$ 的条件也成立。$r=3$ 的条件概率与 $r=1$ 的相同，因此相同的 $p$ 值也会满足 $\\mathbb{P}(R=3) = \\frac{1}{3}$。因此，解是正确的。使无条件等级直方图平坦的 $p$ 值为 $\\frac{8}{15}$。",
            "answer": "$$\n\\boxed{\\frac{8}{15}}\n$$"
        }
    ]
}