{
    "hands_on_practices": [
        {
            "introduction": "在评估实际的集合预报系统之前，我们必须首先理解“完美可靠”的预报所具备的理论特性。秩直方图为我们提供了评估可靠性的直观工具，而一个理想的、可靠的集合预报系统会产生一个均匀（或“平坦”）的秩直方图。本练习将通过第一性原理，推导理想秩直方图中每个分箱的期望计数值及其变异性，为我们后续的可靠性评估提供关键的统计基准。",
            "id": "4081430",
            "problem": "考虑一个数值天气预报 (NWP) 中的集合预报系统，该系统设计用于在单个位置和预报时效对一个标量进行概率性检验。使用一个大小为 $m$ 的集合为 $N$ 个独立的检验时间构建集合排序直方图。在可靠性假设下，检验观测值与集合成员是可交换的，因此观测值在 $m$ 个确定性集合成员中的排序在 $m+1$ 个可能的排序位置上是均匀分布的。\n\n假设以下基本条件：\n- 集合大小为 $m=20$，因此有 $m+1$ 个排序区间。\n- $N$ 个检验时间是独立的，其中 $N=400$。\n- 在可靠性假设下，每次检验的排序落入每个区间的概率相等。\n\n仅使用基本概率定义（指示变量、伯努利试验的期望和方差）以及从具有分类结果的独立试验构建多项式模型的方法，推导每个排序区间的期望计数和单个区间中计数的标准差。然后，为给定的 $m$ 和 $N$ 计算这些量的值。\n\n将最终数值表示为一个单行矩阵中的一对值，顺序为“每个排序区间的期望计数”和“单个区间中计数的标准差”。将您的答案四舍五入到四位有效数字。不需要单位。",
            "solution": "该问题要求推导和评估一个可靠的集合预报系统中，单个排序区间内计数的期望值和标准差。\n\n首先，我们必须验证问题陈述。\n\n### 步骤 1：提取已知条件\n- 集合大小：$m$\n- 独立检验次数：$N$\n- 在可靠性假设下，观测值的排序在 $m+1$ 个可能的排序位置上是均匀分布的。\n- 具体数值：$m=20$， $N=400$。\n- 任务：使用基本概率定义（指示变量、期望、方差）和多项式模型背景，推导每个排序区间的期望计数和单个区间中计数的标准差。并为给定的 $m$ 和 $N$ 进行计算。\n- 输出格式：一对数值（期望计数，标准差），四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，因为排序直方图及其统计特性是气象学中集合预报检验的基石。诸如可靠性导致均匀排序分布的假设，以及统计模型（独立试验导致多项式分布）都是该领域的标准方法。该问题提法明确，为获得唯一解提供了所有必要的参数（$m$、$N$）和假设。语言客观、精确。指定的数值（$m=20$，$N=400$）是符合实际的。因此，该问题被认为是有效的。\n\n### 步骤 3：结论与行动\n问题有效。我们继续进行解答。\n\n### 推导过程\n\n设 $K$ 为可能的排序位置或区间的数量。由于观测值是在 $m$ 个集合成员中进行排序的，因此有 $m+1$ 个可能的排序位置（从小于所有成员到大于所有成员）。\n$$K = m+1$$\n问题陈述，对于一个可靠的集合，检验观测值落入这 $K$ 个区间中任意一个的概率是均匀的。设 $p_j$ 为观测值落入区间 $j$ 的概率，其中 $j \\in \\{1, 2, ..., K\\}$。\n$$p_j = p = \\frac{1}{K} = \\frac{1}{m+1}$$\n这对所有区间 $j$ 都成立。\n\n我们考虑 $N$ 次独立的检验时间。落入特定区间 $j$ 的观测计数，我们用随机变量 $C_j$ 表示，是 $N$ 次独立试验的结果。\n\n为了推导 $C_j$ 的期望和方差，我们按要求使用指示变量法。对于每个检验时间 $i \\in \\{1, 2, ..., N\\}$，我们为一个特定的、任意的区间 $j$ 定义一个指示随机变量 $I_{i,j}$：\n$$\nI_{i,j} =\n\\begin{cases}\n1  \\text{如果观测 } i \\text{ 落入区间 } j \\\\\n0  \\text{其他情况}\n\\end{cases}\n$$\n每个 $I_{i,j}$ 都服从伯努利分布，其“成功”概率为 $p = \\frac{1}{m+1}$。伯努利随机变量的期望是其成功概率：\n$$\\mathbb{E}[I_{i,j}] = 1 \\cdot P(I_{i,j}=1) + 0 \\cdot P(I_{i,j}=0) = p = \\frac{1}{m+1}$$\n伯努利随机变量的方差由 $p(1-p)$ 给出：\n$$\\text{Var}(I_{i,j}) = \\mathbb{E}[I_{i,j}^2] - (\\mathbb{E}[I_{i,j}])^2$$\n对于指示变量，有 $I_{i,j}^2 = I_{i,j}$，所以 $\\mathbb{E}[I_{i,j}^2] = \\mathbb{E}[I_{i,j}] = p$。\n$$\\text{Var}(I_{i,j}) = p - p^2 = p(1-p) = \\frac{1}{m+1}\\left(1 - \\frac{1}{m+1}\\right)$$\n\n在所有 $N$ 次检验时间中，区间 $j$ 的总计数 $C_j$ 是这些独立指示变量的总和：\n$$C_j = \\sum_{i=1}^{N} I_{i,j}$$\n这种结构，即 $N$ 次独立同分布的伯努利试验之和，定义了一个二项分布 $C_j \\sim B(N, p)$。这与所要求的多项式模型背景是一致的，因为多项式分布中任何单个类别的计数的边际分布是二项分布。\n\n区间 $j$ 中的期望计数 $\\mathbb{E}[C_j]$，可以使用期望的线性性质求得：\n$$\\mathbb{E}[C_j] = \\mathbb{E}\\left[\\sum_{i=1}^{N} I_{i,j}\\right] = \\sum_{i=1}^{N} \\mathbb{E}[I_{i,j}]$$\n由于对所有 $i$ 都有 $\\mathbb{E}[I_{i,j}] = p$：\n$$\\mathbb{E}[C_j] = \\sum_{i=1}^{N} p = Np = \\frac{N}{m+1}$$\n这是每个排序区间期望计数的一般表达式。\n\n区间 $j$ 中计数的方差 $\\text{Var}(C_j)$，可以通过注意到检验时间是独立的来找到，这意味着对于不同的 $i$ ，指示变量 $I_{i,j}$ 是独立的。对于独立随机变量的和，和的方差是方差的和：\n$$\\text{Var}(C_j) = \\text{Var}\\left(\\sum_{i=1}^{N} I_{i,j}\\right) = \\sum_{i=1}^{N} \\text{Var}(I_{i,j})$$\n由于对所有 $i$ 都有 $\\text{Var}(I_{i,j}) = p(1-p)$：\n$$\\text{Var}(C_j) = \\sum_{i=1}^{N} p(1-p) = Np(1-p)$$\n代入 $p = \\frac{1}{m+1}$：\n$$\\text{Var}(C_j) = N \\left(\\frac{1}{m+1}\\right) \\left(1 - \\frac{1}{m+1}\\right) = N \\frac{1}{m+1} \\frac{m+1-1}{m+1} = \\frac{Nm}{(m+1)^2}$$\n单个区间中计数的标准差 $\\sigma_{C_j}$ 是方差的平方根：\n$$\\sigma_{C_j} = \\sqrt{\\text{Var}(C_j)} = \\sqrt{\\frac{Nm}{(m+1)^2}}$$\n\n现在，我们为给定的值 $m=20$ 和 $N=400$ 计算这些量。\n区间的数量是 $K = m+1 = 20+1 = 21$。\n\n每个排序区间的期望计数是：\n$$\\mathbb{E}[C_j] = \\frac{N}{m+1} = \\frac{400}{21} \\approx 19.047619...$$\n四舍五入到四位有效数字，我们得到 $19.05$。\n\n单个区间中计数的标准差是：\n$$\\sigma_{C_j} = \\sqrt{\\frac{Nm}{(m+1)^2}} = \\sqrt{\\frac{400 \\cdot 20}{(20+1)^2}} = \\sqrt{\\frac{8000}{21^2}} = \\sqrt{\\frac{8000}{441}} \\approx \\sqrt{18.140589...} \\approx 4.259176...$$\n四舍五入到四位有效数字，我们得到 $4.259$。\n\n最终答案是这两个值的组合。",
            "answer": "$$\\boxed{\\begin{pmatrix} 19.05  4.259 \\end{pmatrix}}$$"
        },
        {
            "introduction": "在练习  中，我们推导了理想秩直方图的统计特性。下一步自然是开发一种形式化的方法来检验观测到的秩直方图是否显著偏离了这种理想的均匀分布。本练习将引导你推导和应用一个经典的统计检验工具——皮尔逊卡方（$\\chi^2$）拟合优度检验，通过这个实践，你将掌握如何量化秩直方图与理想可靠性假设之间的偏差，并作出统计上合理的判断。",
            "id": "4081467",
            "problem": "在基于集合的数值天气预报中，通常使用检验观测值相对于一个包含 $m$ 个成员的集合的秩直方图来评估概率预报的可靠性。对于每个检验时间，观测值在 $m$ 个有序的集合成员中进行排序，使用中间等级法将其分入 $k=m+1$ 个互斥的等级区间。在集合可靠且各预报个例独立的条件下，观测值的等级在 $k$ 个区间上呈均匀分布。\n\n考虑 $n$ 个独立的预报-观测对，它们在 $k$ 个区间上产生的等级频数为 $\\{O_{r}\\}_{r=1}^{k}$。假设可靠性零假设成立，这意味着一个多项式抽样模型，其中每个区间的概率相等，即 $p_{r}=1/k$。\n\n仅使用多项式模型和多元中心极限定理的基本定义，推导一个用于检验等级分布均匀性的大样本拟合优度检验，方法如下：\n1. 基于频数向量与其期望的渐近协方差构造一个二次型，以及\n2. 将其简化为一个标量统计量，该统计量取决于观测频数与其期望值之间在各区间内的差异的加和。\n\n证明你的检验统计量在零假设下的渐近分布是自由度为 $k-1$ 的卡方分布，并解释损失一个自由度的原因。\n\n然后，对于一个包含 $m=10$ 个成员的集合，在 $n=220$ 个独立个例中进行观测，得到的秩直方图有 $k=m+1=11$ 个区间，其观测频数为\n$\\{O_{r}\\}_{r=1}^{11}=\\{14,\\,19,\\,20,\\,26,\\,25,\\,22,\\,21,\\,24,\\,18,\\,17,\\,14\\}$。\n在可靠性零假设下，使用零模型所隐含的期望频数 $E_{r}$，计算你的检验统计量的值。将最终数值结果表示为一个无单位的纯数，并四舍五入到四位有效数字。",
            "solution": "该问题要求推导一个用于检验秩直方图均匀性的大样本拟合优度检验，其渐近分布，并将其应用于一个特定数据集。对问题陈述的验证确认了其科学和数学上的合理性、完整性和清晰性。因此，我们可以着手进行解答。\n\n设集合成员的数量为 $m$。观测值的等级被分入 $k = m+1$ 个区间。给定 $n$ 个独立的预报-观测对，得到每个区间中的观测频数向量 $\\mathbf{O} = (O_1, O_2, \\ldots, O_k)^T$，其中 $\\sum_{r=1}^{k} O_r = n$。\n\n零假设 $H_0$ 指出集合是可靠的，这意味着观测值落入任何等级区间的概率是相等的。因此，任何区间 $r$ 的概率为 $p_r = 1/k$。在 $H_0$ 下，频数向量 $\\mathbf{O}$ 服从多项式分布，$\\mathbf{O} \\sim \\text{Multinomial}(n; p_1, p_2, \\ldots, p_k)$，其中对所有 $r$ 都有 $p_r = 1/k$。\n\n每个区间的期望频数为 $E_r = E[O_r] = n p_r = n/k$。期望频数向量为 $\\mathbf{E} = (E_1, E_2, \\ldots, E_k)^T$。\n\n向量 $\\mathbf{O}$ 的 $k \\times k$ 协方差矩阵 $\\boldsymbol{\\Sigma}$ 的元素由下式给出：\n$$\n\\text{Var}(O_r) = \\Sigma_{rr} = n p_r (1 - p_r) = n \\frac{1}{k} \\left(1 - \\frac{1}{k}\\right) = \\frac{n(k-1)}{k^2}\n$$\n$$\n\\text{Cov}(O_r, O_s) = \\Sigma_{rs} = -n p_r p_s = -n \\frac{1}{k} \\frac{1}{k} = -\\frac{n}{k^2} \\quad \\text{for } r \\neq s\n$$\n\n由于约束条件 $\\sum_{r=1}^k O_r = n$，向量 $\\mathbf{O}$ 的分量不是线性无关的。这意味着协方差矩阵 $\\boldsymbol{\\Sigma}$ 是奇异的，其秩为 $\\text{rank}(\\boldsymbol{\\Sigma}) = k-1$。\n\n根据多元中心极限定理，对于大的 $n$，$\\mathbf{O}$ 的分布趋近于一个均值为 $\\mathbf{E}$、协方差矩阵为 $\\boldsymbol{\\Sigma}$ 的多元正态分布。也就是说，偏差向量 $\\mathbf{d} = \\mathbf{O} - \\mathbf{E}$ 渐近地服从 $N(\\mathbf{0}, \\boldsymbol{\\Sigma})$ 分布。\n\n为了构造所需的二次型，我们需要协方差矩阵的逆。由于 $\\boldsymbol{\\Sigma}$ 是奇异的，我们不能使用标准的逆。一个常用的方法是考虑前 $k-1$ 个频数的降维向量，$\\mathbf{O}^* = (O_1, O_2, \\ldots, O_{k-1})^T$。该向量渐近地服从一个 $(k-1)$ 元正态分布，其均值为 $\\mathbf{E}^* = (E_1, \\ldots, E_{k-1})^T$，协方差矩阵为一个非奇异的 $(k-1) \\times (k-1)$ 矩阵 $\\boldsymbol{\\Sigma}^*$，它是 $\\boldsymbol{\\Sigma}$ 的左上角子矩阵。\n\n检验统计量 $Q$ 于是可以构造为一个二次型：\n$$\nQ = (\\mathbf{O}^* - \\mathbf{E}^*)^T (\\boldsymbol{\\Sigma}^*)^{-1} (\\mathbf{O}^* - \\mathbf{E}^*)\n$$\n根据构造，该统计量将渐近地服从自由度为 $k-1$ 的卡方分布。\n\n矩阵 $\\boldsymbol{\\Sigma}^*$ 可以写成 $\\boldsymbol{\\Sigma}^* = a\\mathbf{I}_{k-1} + b\\mathbf{J}_{k-1}$，其中 $\\mathbf{I}_{k-1}$ 是单位矩阵，$\\mathbf{J}_{k-1}$ 是全1矩阵。我们有 $\\Sigma^*_{rr} = a+b = \\frac{n(k-1)}{k^2}$ 和 $\\Sigma^*_{rs} = b = -\\frac{n}{k^2}$。这得到 $a = \\frac{n(k-1)}{k^2} - (-\\frac{n}{k^2}) = \\frac{nk}{k^2} = \\frac{n}{k}$。已知其逆为 $(\\boldsymbol{\\Sigma}^*)^{-1} = \\frac{1}{a}\\mathbf{I}_{k-1} - \\frac{b}{a(a+(k-1)b)}\\mathbf{J}_{k-1}$。\n代入 $a = n/k$ 和 $b = -n/k^2$：\n$$\na + (k-1)b = \\frac{n}{k} + (k-1)\\left(-\\frac{n}{k^2}\\right) = \\frac{nk - n(k-1)}{k^2} = \\frac{n}{k^2}\n$$\n所以，逆矩阵是：\n$$\n(\\boldsymbol{\\Sigma}^*)^{-1} = \\frac{k}{n}\\mathbf{I}_{k-1} - \\frac{-n/k^2}{(n/k)(n/k^2)}\\mathbf{J}_{k-1} = \\frac{k}{n}\\mathbf{I}_{k-1} + \\frac{k}{n}\\mathbf{J}_{k-1} = \\frac{k}{n}(\\mathbf{I}_{k-1} + \\mathbf{J}_{k-1})\n$$\n设 $\\mathbf{d}^* = \\mathbf{O}^* - \\mathbf{E}^* = (O_1-E_1, \\ldots, O_{k-1}-E_{k-1})^T$。二次型为：\n$$\nQ = (\\mathbf{d}^*)^T \\left[\\frac{k}{n}(\\mathbf{I}_{k-1} + \\mathbf{J}_{k-1})\\right] \\mathbf{d}^* = \\frac{k}{n} \\left( (\\mathbf{d}^*)^T \\mathbf{d}^* + (\\mathbf{d}^*)^T \\mathbf{J}_{k-1} \\mathbf{d}^* \\right)\n$$\n这可以简化为：\n$$\nQ = \\frac{k}{n} \\left( \\sum_{r=1}^{k-1} (O_r - E_r)^2 + \\left(\\sum_{r=1}^{k-1} (O_r - E_r)\\right)^2 \\right)\n$$\n根据约束条件 $\\sum_{r=1}^{k} O_r = n$ 和 $\\sum_{r=1}^{k} E_r = n$，我们有 $\\sum_{r=1}^{k} (O_r - E_r) = 0$。\n这意味着 $\\sum_{r=1}^{k-1} (O_r - E_r) = -(O_k - E_k)$。将此代入 $Q$ 的表达式中：\n$$\nQ = \\frac{k}{n} \\left( \\sum_{r=1}^{k-1} (O_r - E_r)^2 + (-(O_k - E_k))^2 \\right) = \\frac{k}{n} \\sum_{r=1}^{k} (O_r - E_r)^2\n$$\n由于 $E_r = n/k$，我们可以将其写为：\n$$\nQ = \\sum_{r=1}^{k} \\frac{(O_r - E_r)^2}{n/k} = \\sum_{r=1}^{k} \\frac{(O_r - E_r)^2}{E_r}\n$$\n这就是著名的 Pearson 卡方统计量。这个推导满足了构造一个二次型并将其简化为基于各区间差异的标量统计量的要求。\n\n该统计量的零假设下的渐近分布是 $\\chi^2_{k-1}$（自由度为 $k-1$ 的卡方分布）。从 $k$ 个区间中损失一个自由度的原因在于施加在频数上的单一线性约束：$\\sum_{r=1}^k O_r = n$。这个约束意味着，如果任意 $k-1$ 个区间的频数值已知，则第 $k$ 个区间的频数值就完全确定了。因此，系统中只有 $k-1$ 个可以自由变化的量，即“自由度”。从数学上讲，偏差向量 $\\mathbf{d} = \\mathbf{O} - \\mathbf{E}$ 被约束在 $\\mathbb{R}^k$ 的一个 $(k-1)$ 维子空间内，协方差矩阵 $\\boldsymbol{\\Sigma}$ 的秩为 $k-1$，这决定了最终得到的卡方分布的自由度。\n\n现在，我们将此检验应用于给定数据：\n- 集合成员数 $m = 10$。\n- 区间数 $k = m+1 = 11$。\n- 个例数 $n = 220$。\n- 观测频数 $\\{O_r\\}_{r=1}^{11} = \\{14, 19, 20, 26, 25, 22, 21, 24, 18, 17, 14\\}$。\n\n在可靠性零假设下，每个区间的期望频数为：\n$$\nE_r = \\frac{n}{k} = \\frac{220}{11} = 20\n$$\n检验统计量计算如下：\n$$\n\\chi^2 = \\sum_{r=1}^{11} \\frac{(O_r - E_r)^2}{E_r} = \\sum_{r=1}^{11} \\frac{(O_r - 20)^2}{20}\n$$\n让我们计算每个区间的项：\n$$\n\\chi^2 = \\frac{(14-20)^2}{20} + \\frac{(19-20)^2}{20} + \\frac{(20-20)^2}{20} + \\frac{(26-20)^2}{20} + \\frac{(25-20)^2}{20} + \\frac{(22-20)^2}{20} + \\frac{(21-20)^2}{20} + \\frac{(24-20)^2}{20} + \\frac{(18-20)^2}{20} + \\frac{(17-20)^2}{20} + \\frac{(14-20)^2}{20}\n$$\n$$\n\\chi^2 = \\frac{(-6)^2}{20} + \\frac{(-1)^2}{20} + \\frac{0^2}{20} + \\frac{6^2}{20} + \\frac{5^2}{20} + \\frac{2^2}{20} + \\frac{1^2}{20} + \\frac{4^2}{20} + \\frac{(-2)^2}{20} + \\frac{(-3)^2}{20} + \\frac{(-6)^2}{20}\n$$\n$$\n\\chi^2 = \\frac{36}{20} + \\frac{1}{20} + \\frac{0}{20} + \\frac{36}{20} + \\frac{25}{20} + \\frac{4}{20} + \\frac{1}{20} + \\frac{16}{20} + \\frac{4}{20} + \\frac{9}{20} + \\frac{36}{20}\n$$\n$$\n\\chi^2 = \\frac{36+1+0+36+25+4+1+16+4+9+36}{20} = \\frac{168}{20} = 8.4\n$$\n问题要求结果四舍五入到四位有效数字。\n$$\n\\chi^2 = 8.400\n$$",
            "answer": "$$\n\\boxed{8.400}\n$$"
        },
        {
            "introduction": "一个看似“平坦”的秩直方图，即使通过了如练习  中所述的卡方检验，也可能掩盖了潜在的系统性预报误差。本练习设计了一个思想实验，旨在揭示无条件秩直方图的一个关键局限性。通过构建一个混合了两种不同气象情景的例子，你将看到一个总体上平坦的直方图如何可能由两种截然相反且存在系统性偏差的条件分布组合而成，这突显了条件检验在预报评估中的重要性。",
            "id": "4081443",
            "problem": "在基于集合的数值天气预报 (NWP) 和气候模拟中，预报集合的可靠性可以通过检验观测值在集合成员中的等级所构成的秩直方图来评估。对于一个大小为 $m$ 的可交换集合，在可靠性条件下，观测值在 $m$ 个排序后的集合成员中的等级 $R$ 在 $\\{1,2,\\ldots,m+1\\}$ 上是均匀分布的，无论是在无条件下还是在任何可能影响预报和观测联合分布的协变量 $C$ 的条件下。考虑一个二元模态指示器 $C \\in \\{0,1\\}$，它表示两种不同的气象模态（例如，天气尺度稳定与对流性）。假设一个大小为 $m=2$ 的可交换集合，并定义条件等级分布如下：\n- 在模态 $C=0$（系统性离散不足的情况）下，观测值倾向于落在集合离散度之外。条件等级概率为\n$$\n\\mathbb{P}(R=1 \\mid C=0)=\\mathbb{P}(R=3 \\mid C=0)=\\frac{9}{20}, \\quad \\mathbb{P}(R=2 \\mid C=0)=\\frac{1}{10}.\n$$\n- 在模态 $C=1$（系统性离散过度的情况）下，观测值倾向于位于集合成员之间。条件等级概率为\n$$\n\\mathbb{P}(R=1 \\mid C=1)=\\mathbb{P}(R=3 \\mid C=1)=\\frac{1}{5}, \\quad \\mathbb{P}(R=2 \\mid C=1)=\\frac{3}{5}.\n$$\n设模态频率为 $\\mathbb{P}(C=0)=p$ 和 $\\mathbb{P}(C=1)=1-p$。仅使用等级直方图的定义和全概率定律，确定使无条件秩直方图完全平坦的 $p$ 值，即，\n$$\n\\mathbb{P}(R=r)=\\frac{1}{3} \\quad \\text{for each } r \\in \\{1,2,3\\}.\n$$\n将你的答案表示为一个精确的分数。",
            "solution": "该问题要求我们确定参数 $p$ 的值，该参数代表气象模态 $C=0$ 的频率，使得集合预报的无条件秩直方图是平坦的。给定的集合大小为 $m=2$，这意味着检验观测的等级 $R$ 可以在集合 $\\{1, 2, \\ldots, m+1\\}$ 中取值，即 $R \\in \\{1, 2, 3\\}$。\n\n一个平坦或均匀的无条件秩直方图意味着观测值落入 $m+1 = 3$ 个可能等级中任何一个的概率是相等的。这个条件正式表述为：\n$$\n\\mathbb{P}(R=r) = \\frac{1}{m+1} = \\frac{1}{3} \\quad \\text{for each } r \\in \\{1, 2, 3\\}.\n$$\n问题给出了在给定气象模态 $C \\in \\{0, 1\\}$ 的条件下等级 $R$ 的条件概率。这些模态发生的概率为 $\\mathbb{P}(C=0)=p$ 和 $\\mathbb{P}(C=1)=1-p$。\n\n为了求无条件概率 $\\mathbb{P}(R=r)$，我们必须使用全概率定律，该定律允许我们通过对由每个条件的概率加权的条件概率求和来计算无条件概率。对于这两种模态，该定律表示为：\n$$\n\\mathbb{P}(R=r) = \\mathbb{P}(R=r \\mid C=0)\\mathbb{P}(C=0) + \\mathbb{P}(R=r \\mid C=1)\\mathbb{P}(C=1).\n$$\n代入给定的模态频率，我们得到：\n$$\n\\mathbb{P}(R=r) = \\mathbb{P}(R=r \\mid C=0) \\cdot p + \\mathbb{P}(R=r \\mid C=1) \\cdot (1-p).\n$$\n我们可以通过对任意一个等级 $r \\in \\{1, 2, 3\\}$ 强制执行条件 $\\mathbb{P}(R=r) = \\frac{1}{3}$ 来建立一个关于 $p$ 的方程。因为概率之和 $\\sum_{r=1}^3 \\mathbb{P}(R=r)$ 必须等于 $1$，所以满足任意两个等级的条件会自动满足第三个等级的条件。因此，我们只需要对单个等级求解方程。让我们选择 $r=1$。\n\n对于 $r=1$ 给定的条件概率是：\n$$\n\\mathbb{P}(R=1 \\mid C=0) = \\frac{9}{20}\n$$\n$$\n\\mathbb{P}(R=1 \\mid C=1) = \\frac{1}{5}\n$$\n将无条件概率 $\\mathbb{P}(R=1)$ 设为 $\\frac{1}{3}$，我们得到方程：\n$$\n\\frac{1}{3} = \\left(\\frac{9}{20}\\right) p + \\left(\\frac{1}{5}\\right)(1-p).\n$$\n现在我们求解这个关于 $p$ 的线性方程。首先，展开项 $(1-p)$：\n$$\n\\frac{1}{3} = \\frac{9}{20} p + \\frac{1}{5} - \\frac{1}{5} p.\n$$\n接下来，我们将所有含 $p$ 的项移到方程的一边，常数项移到另一边：\n$$\n\\frac{1}{3} - \\frac{1}{5} = \\frac{9}{20} p - \\frac{1}{5} p.\n$$\n为了合并这些项，我们找到公分母。对于左边，公分母是 $15$。对于右边，是 $20$。\n$$\n\\frac{5}{15} - \\frac{3}{15} = \\left(\\frac{9}{20} - \\frac{4}{20}\\right) p.\n$$\n化简两边得到：\n$$\n\\frac{2}{15} = \\left(\\frac{5}{20}\\right) p.\n$$\n右边的分数可以化简为 $\\frac{5}{20} = \\frac{1}{4}$。\n$$\n\\frac{2}{15} = \\frac{1}{4} p.\n$$\n最后，为了分离出 $p$，我们将两边都乘以 $4$：\n$$\np = 4 \\times \\frac{2}{15} = \\frac{8}{15}.\n$$\n这就得到了所要求的 $p$ 值。为确保一致性，我们可以验证这个 $p$ 值同样能得出 $\\mathbb{P}(R=2) = \\frac{1}{3}$。我们有 $p = \\frac{8}{15}$ 和 $1-p = 1 - \\frac{8}{15} = \\frac{7}{15}$。对于 $r=2$ 的条件概率是：\n$$\n\\mathbb{P}(R=2 \\mid C=0)=\\frac{1}{10}, \\quad \\mathbb{P}(R=2 \\mid C=1)=\\frac{3}{5}.\n$$\n无条件概率是：\n$$\n\\mathbb{P}(R=2) = \\left(\\frac{1}{10}\\right) \\left(\\frac{8}{15}\\right) + \\left(\\frac{3}{5}\\right) \\left(\\frac{7}{15}\\right) = \\frac{8}{150} + \\frac{21}{75}.\n$$\n使用公分母 $150$：\n$$\n\\mathbb{P}(R=2) = \\frac{8}{150} + \\frac{21 \\times 2}{75 \\times 2} = \\frac{8}{150} + \\frac{42}{150} = \\frac{50}{150} = \\frac{1}{3}.\n$$\n条件对于 $r=2$ 成立。$r=3$ 的条件概率与 $r=1$ 的相同，所以相同的 $p$ 值也会满足 $\\mathbb{P}(R=3) = \\frac{1}{3}$。因此，解是正确的。使无条件秩直方图平坦的 $p$ 值为 $\\frac{8}{15}$。",
            "answer": "$$\n\\boxed{\\frac{8}{15}}\n$$"
        }
    ]
}