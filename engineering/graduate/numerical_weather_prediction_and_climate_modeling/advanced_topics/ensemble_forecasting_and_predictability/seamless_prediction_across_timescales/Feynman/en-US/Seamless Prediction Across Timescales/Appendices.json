{
    "hands_on_practices": [
        {
            "introduction": "A fundamental challenge in creating seamless prediction models is efficiently handling the wide range of timescales present in the Earth system. Fast-moving gravity waves, while physically present, can impose cripplingly small time steps on explicit numerical schemes due to the Courant-Friedrichs-Lewy (CFL) stability condition. This exercise  guides you through a core technique to overcome this limitation by designing an Implicit-Explicit (IMEX) scheme, which selectively treats fast waves implicitly to remove the harsh time step constraint, allowing the model's performance to be dictated by the slower, more dynamically significant advective motions.",
            "id": "4086415",
            "problem": "A one-dimensional, periodic, linearized shallow-water system on an Arakawa C-grid is used to represent fast gravity waves and slower advective motions relevant to seamless prediction across timescales in numerical weather prediction and climate modeling. Let the free-surface height be $\\,\\eta_j(t)\\,$ defined at integer indices $\\,j\\,$, and the velocity be $\\,u_{j+1/2}(t)\\,$ defined at half-integer indices $\\,j+1/2\\,$. The governing equations linearized about a uniform mean depth $\\,H>0\\,$ and a uniform mean zonal flow $\\,U\\,$ are\n$$\n\\eta_t + U\\,\\eta_x + H\\,u_x = 0,\\qquad u_t + U\\,u_x + g\\,\\eta_x = 0,\n$$\nwhere $\\,g>0\\,$ is gravitational acceleration and the gravity-wave phase speed is $\\,c=\\sqrt{gH}\\,$. The grid has uniform spacing $\\,\\Delta x\\,$ and periodic boundary conditions.\n\nPart A (explicit gravity-wave dynamics): Ignore the advective terms (set $\\,U=0\\,$) and discretize the remaining fast linear gravity-wave system using the forward–backward time-stepping scheme on the Arakawa C-grid:\n- For the mass equation, use a forward Euler step with the centered C-grid difference for $\\,u_x\\,$, namely\n$$\n\\eta^{n+1}_j \\;=\\; \\eta^n_j \\;-\\; \\Delta t\\,H\\,\\frac{u^n_{j+1/2} - u^n_{j-1/2}}{\\Delta x}.\n$$\n- For the momentum equation, use a backward Euler step that treats $\\,\\eta_x\\,$ implicitly at half points with the centered C-grid difference, namely\n$$\nu^{n+1}_{j+1/2} \\;=\\; u^n_{j+1/2} \\;-\\; \\Delta t\\,g\\,\\frac{\\eta^{n+1}_{j+1} - \\eta^{n+1}_j}{\\Delta x}.\n$$\nUsing a standard von Neumann (Fourier) stability analysis consistent with the staggered grid, derive the stability condition on $\\,\\Delta t\\,$ and identify the maximum stable explicit time step for the gravity-wave dynamics in terms of $\\,\\Delta x\\,$ and $\\,c\\,$.\n\nPart B (Implicit–Explicit workaround): Now consider the full linearized system with $\\,U\\neq 0\\,$. Design an Implicit–Explicit (IMEX) scheme that treats the fast gravity-wave coupling terms $\\,H\\,u_x\\,$ and $\\,g\\,\\eta_x\\,$ with backward Euler (implicitly) on the same Arakawa C-grid operators as above, while treating the slow advective terms $\\,U\\,\\eta_x\\,$ and $\\,U\\,u_x\\,$ with forward Euler (explicitly) using first-order upwind differences appropriate to the sign of $\\,U\\,$. Using von Neumann analysis, show that the implicit treatment of gravity-wave terms removes the gravity-wave Courant–Friedrichs–Lewy (CFL) restriction and that stability is instead controlled by the advective CFL condition. Determine the maximum stable time step for the IMEX scheme in terms of $\\,\\Delta x\\,$ and $\\,U\\,$.\n\nAnswer specification:\n- Provide the pair consisting of the maximum stable explicit gravity-wave time step from Part A and the maximum stable IMEX time step from Part B as a single closed-form analytic expression depending on $\\,c\\,$, $\\,U\\,$, and $\\,\\Delta x\\,$.\n- Express the final answers in units of seconds.\n- No numerical substitution is required; do not round.",
            "solution": "This problem requires the derivation of stability conditions for two different numerical schemes applied to the one-dimensional linearized shallow-water equations. We will use the von Neumann stability analysis method for both parts.\n\nPart A: Explicit Forward-Backward Scheme for Gravity Waves\n\nThe linearized shallow-water equations with the mean advection term set to zero ($U=0$) are:\n$$\n\\frac{\\partial \\eta}{\\partial t} + H \\frac{\\partial u}{\\partial x} = 0\n$$\n$$\n\\frac{\\partial u}{\\partial t} + g \\frac{\\partial \\eta}{\\partial x} = 0\n$$\nThe problem specifies a forward-backward time-stepping scheme on an Arakawa C-grid:\n$$\n\\frac{\\eta^{n+1}_j - \\eta^n_j}{\\Delta t} = -H \\frac{u^n_{j+1/2} - u^n_{j-1/2}}{\\Delta x} \\quad (1)\n$$\n$$\n\\frac{u^{n+1}_{j+1/2} - u^n_{j+1/2}}{\\Delta t} = -g \\frac{\\eta^{n+1}_{j+1} - \\eta^{n+1}_j}{\\Delta x} \\quad (2)\n$$\nFor the von Neumann analysis, we introduce Fourier modal solutions for the height $\\eta$ and velocity $u$. Due to the staggered grid, the ansatz is:\n$$\n\\eta^n_j = \\hat{\\eta}^n(k) e^{i k j \\Delta x}\n$$\n$$\nu^n_{j+1/2} = \\hat{u}^n(k) e^{i k (j+1/2) \\Delta x}\n$$\nwhere $k$ is the wavenumber, $i=\\sqrt{-1}$, and $\\hat{\\eta}^n$ and $\\hat{u}^n$ are the Fourier amplitudes at time step $n$. Substituting these into equations $(1)$ and $(2)$:\n\nFrom $(1)$:\n$$\n\\frac{\\hat{\\eta}^{n+1} - \\hat{\\eta}^n}{\\Delta t} e^{i k j \\Delta x} = - \\frac{H}{\\Delta x} \\left( \\hat{u}^n e^{i k (j+1/2) \\Delta x} - \\hat{u}^n e^{i k (j-1/2) \\Delta x} \\right)\n$$\nDividing by $e^{i k j \\Delta x}$:\n$$\n\\frac{\\hat{\\eta}^{n+1} - \\hat{\\eta}^n}{\\Delta t} = - \\frac{H \\hat{u}^n}{\\Delta x} \\left( e^{i k \\Delta x / 2} - e^{-i k \\Delta x / 2} \\right) = - \\frac{2 i H \\hat{u}^n}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n$$\n\\hat{\\eta}^{n+1} = \\hat{\\eta}^n - \\frac{2 i \\Delta t H}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right) \\hat{u}^n \\quad (3)\n$$\n\nFrom $(2)$:\n$$\n\\frac{\\hat{u}^{n+1} - \\hat{u}^n}{\\Delta t} e^{i k (j+1/2) \\Delta x} = - \\frac{g}{\\Delta x} \\left( \\hat{\\eta}^{n+1} e^{i k (j+1) \\Delta x} - \\hat{\\eta}^{n+1} e^{i k j \\Delta x} \\right)\n$$\nDividing by $e^{i k (j+1/2) \\Delta x}$:\n$$\n\\frac{\\hat{u}^{n+1} - \\hat{u}^n}{\\Delta t} = - \\frac{g \\hat{\\eta}^{n+1}}{\\Delta x} \\left( e^{i k \\Delta x / 2} - e^{-i k \\Delta x / 2} \\right) = - \\frac{2 i g \\hat{\\eta}^{n+1}}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n$$\n\\hat{u}^{n+1} = \\hat{u}^n - \\frac{2 i \\Delta t g}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right) \\hat{\\eta}^{n+1} \\quad (4)\n$$\nTo find the amplification factor $\\lambda$, we seek a recurrence relation for a single variable. From $(3)$, we can write $\\hat{u}^n$ in terms of $\\hat{\\eta}$ at steps $n$ and $n+1$. A more direct method is to advance $(3)$ one time step to $n+2$:\n$$\n\\hat{\\eta}^{n+2} = \\hat{\\eta}^{n+1} - \\frac{2 i \\Delta t H}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right) \\hat{u}^{n+1}\n$$\nSubstitute $\\hat{u}^{n+1}$ from $(4)$:\n$$\n\\hat{\\eta}^{n+2} = \\hat{\\eta}^{n+1} - \\frac{2 i \\Delta t H}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right) \\left[ \\hat{u}^n - \\frac{2 i \\Delta t g}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right) \\hat{\\eta}^{n+1} \\right]\n$$\n$$\n\\hat{\\eta}^{n+2} = \\hat{\\eta}^{n+1} - \\left( \\frac{2 i \\Delta t H}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right) \\right) \\hat{u}^n - \\frac{4 \\Delta t^2 g H}{\\Delta x^2} \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\hat{\\eta}^{n+1}\n$$\nFrom $(3)$, we replace the term with $\\hat{u}^n$:\n$$\n- \\frac{2 i \\Delta t H}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right) \\hat{u}^n = \\hat{\\eta}^{n+1} - \\hat{\\eta}^n\n$$\nSubstituting this into the equation for $\\hat{\\eta}^{n+2}$:\n$$\n\\hat{\\eta}^{n+2} = \\hat{\\eta}^{n+1} + (\\hat{\\eta}^{n+1} - \\hat{\\eta}^n) - \\frac{4 c^2 \\Delta t^2}{\\Delta x^2} \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\hat{\\eta}^{n+1}\n$$\nwhere $c^2 = gH$. Let $K = \\left(\\frac{2 c \\Delta t}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right)\\right)^2$. The recurrence relation is:\n$$\n\\hat{\\eta}^{n+2} - (2-K)\\hat{\\eta}^{n+1} + \\hat{\\eta}^n = 0\n$$\nAssuming a solution of the form $\\hat{\\eta}^n = \\lambda^n$, we obtain the characteristic equation for the amplification factor $\\lambda$:\n$$\n\\lambda^2 - (2-K)\\lambda + 1 = 0\n$$\nFor the scheme to be stable, the magnitudes of the roots $\\lambda$ must not exceed $1$, i.e., $|\\lambda| \\le 1$. The roots are given by the quadratic formula:\n$$\n\\lambda = \\frac{(2-K) \\pm \\sqrt{(2-K)^2 - 4}}{2} = \\frac{2-K \\pm \\sqrt{K^2 - 4K}}{2}\n$$\nIf the discriminant is negative or zero, $K^2 - 4K \\le 0 \\implies K(K-4) \\le 0$. As $K \\ge 0$, this implies $0 \\le K \\le 4$. In this case, the roots are complex conjugates, and $|\\lambda|^2 = \\left(\\frac{2-K}{2}\\right)^2 + \\frac{4K-K^2}{4} = \\frac{4-4K+K^2+4K-K^2}{4} = 1$.\nThus, for $0 \\le K \\le 4$, we have $|\\lambda|=1$ and the scheme is neutrally stable. If $K > 4$, the roots are real and their product is $1$. Their sum is $2-K  -2$, which implies one root must be less than $-1$, making the scheme unstable.\nThe stability condition is $K \\le 4$:\n$$\n\\left(\\frac{2 c \\Delta t}{\\Delta x} \\sin\\left(\\frac{k \\Delta x}{2}\\right)\\right)^2 \\le 4 \\implies \\frac{c \\Delta t}{\\Delta x} \\left|\\sin\\left(\\frac{k \\Delta x}{2}\\right)\\right| \\le 1\n$$\nThis condition must hold for all possible wavenumbers $k$. The most restrictive case occurs when $\\left|\\sin(k \\Delta x/2)\\right|$ is maximal, which is $1$ (at the Nyquist wavenumber $k = \\pi/\\Delta x$). Therefore, the stability condition simplifies to the Courant-Friedrichs-Lewy (CFL) condition for gravity waves:\n$$\n\\frac{c \\Delta t}{\\Delta x} \\le 1 \\implies \\Delta t \\le \\frac{\\Delta x}{c}\n$$\nThe maximum stable time step for Part A is $\\Delta t_{\\text{max}} = \\frac{\\Delta x}{c}$.\n\nPart B: Implicit-Explicit (IMEX) Scheme\n\nNow we consider the full system with $U \\neq 0$. The IMEX scheme treats advection terms explicitly with first-order upwind differences and gravity wave terms implicitly. For $U>0$, the upwind differences are $(\\partial_x f)_j \\approx (f_j - f_{j-1})/\\Delta x$. The discretized equations are:\n$$\n\\frac{\\eta_j^{n+1} - \\eta_j^n}{\\Delta t} + U \\frac{\\eta_j^n - \\eta_{j-1}^n}{\\Delta x} + H \\frac{u_{j+1/2}^{n+1} - u_{j-1/2}^{n+1}}{\\Delta x} = 0\n$$\n$$\n\\frac{u_{j+1/2}^{n+1} - u_{j+1/2}^n}{\\Delta t} + U \\frac{u_{j+1/2}^n - u_{j-1/2}^n}{\\Delta x} + g \\frac{\\eta_{j+1}^{n+1} - \\eta_j^{n+1}}{\\Delta x} = 0\n$$\nApplying the same Fourier ansatz:\n$$\n\\frac{\\hat{\\eta}^{n+1} - \\hat{\\eta}^n}{\\Delta t} + \\frac{U}{\\Delta x}\\hat{\\eta}^n(1 - e^{-ik\\Delta x}) + \\frac{H}{\\Delta x}\\hat{u}^{n+1}(2i\\sin\\frac{k\\Delta x}{2}) = 0\n$$\n$$\n\\frac{\\hat{u}^{n+1} - \\hat{u}^n}{\\Delta t} + \\frac{U}{\\Delta x}\\hat{u}^n(1 - e^{-ik\\Delta x}) + \\frac{g}{\\Delta x}\\hat{\\eta}^{n+1}(2i\\sin\\frac{k\\Delta x}{2}) = 0\n$$\nLet $\\mathbf{v}^n = [\\hat{\\eta}^n, \\hat{u}^n]^T$. This system can be written in matrix form $\\mathbf{M} \\mathbf{v}^{n+1} = \\mathbf{N} \\mathbf{v}^n$:\n$$\n\\begin{pmatrix} 1  \\frac{2i\\Delta t H}{\\Delta x} S \\\\ \\frac{2i\\Delta t g}{\\Delta x} S  1 \\end{pmatrix} \\begin{pmatrix} \\hat{\\eta}^{n+1} \\\\ \\hat{u}^{n+1} \\end{pmatrix} = \\begin{pmatrix} 1 - \\frac{U\\Delta t}{\\Delta x}(1-e^{-ik\\Delta x})  0 \\\\ 0  1 - \\frac{U\\Delta t}{\\Delta x}(1-e^{-ik\\Delta x}) \\end{pmatrix} \\begin{pmatrix} \\hat{\\eta}^{n} \\\\ \\hat{u}^{n} \\end{pmatrix}\n$$\nwhere $S = \\sin(k\\Delta x/2)$. The amplification matrix is $G = \\mathbf{M}^{-1}\\mathbf{N}$.\nLet $A_U = 1 - \\frac{U\\Delta t}{\\Delta x}(1-e^{-ik\\Delta x})$ be the amplification factor of the explicit upwind advection scheme. Then $\\mathbf{N} = A_U \\mathbf{I}$, where $\\mathbf{I}$ is the identity matrix.\nThe determinant of $\\mathbf{M}$ is $\\det(\\mathbf{M}) = 1 - (i^2) \\frac{4\\Delta t^2 gH}{\\Delta x^2}S^2 = 1 + \\frac{4c^2\\Delta t^2}{\\Delta x^2}S^2 = 1 + K_c$, where $K_c = K$ from Part A.\nThe eigenvalues $\\lambda_G$ of $G$ are the product of $A_U$ and the eigenvalues of $\\mathbf{M}^{-1}$. The eigenvalues of $\\mathbf{M}$ are $1 \\pm \\sqrt{-K_c} = 1 \\pm i\\sqrt{K_c}$. Thus, the eigenvalues of $\\mathbf{M}^{-1}$ are $\\frac{1}{1 \\pm i\\sqrt{K_c}} = \\frac{1 \\mp i\\sqrt{K_c}}{1+K_c}$.\nThe eigenvalues of the full amplification matrix $G$ are $\\lambda_G = A_U \\left(\\frac{1 \\mp i\\sqrt{K_c}}{1+K_c}\\right)$.\nFor stability, we require $|\\lambda_G| \\le 1$.\n$$\n|\\lambda_G|^2 = |A_U|^2 \\left|\\frac{1 \\mp i\\sqrt{K_c}}{1+K_c}\\right|^2 = |A_U|^2 \\frac{1+K_c}{(1+K_c)^2} = \\frac{|A_U|^2}{1+K_c}\n$$\nThe stability condition is $\\frac{|A_U|^2}{1+K_c} \\le 1$, or $|A_U|^2 \\le 1+K_c$.\nSince $K_c = (\\frac{2c\\Delta t}{\\Delta x}\\sin(\\frac{k\\Delta x}{2}))^2 \\ge 0$, we have $1+K_c \\ge 1$. This means the implicit treatment of the gravity wave terms has a stabilizing effect. As the problem suggests, the stability is controlled by the explicit advection term. A sufficient condition for stability is $|A_U| \\le 1$, since this would imply $|A_U|^2 \\le 1 \\le 1+K_c$.\nLet's analyze $|A_U| \\le 1$. Let $\\alpha = U\\Delta t/\\Delta x$ (the advective Courant number) and $\\theta=k\\Delta x$.\n$$\nA_U = 1 - \\alpha(1-\\cos\\theta+i\\sin\\theta)\n$$\n$$\n|A_U|^2 = (1-\\alpha(1-\\cos\\theta))^2 + (\\alpha\\sin\\theta)^2 = 1 - 2\\alpha(1-\\cos\\theta) + \\alpha^2(1-\\cos\\theta)^2 + \\alpha^2\\sin^2\\theta\n$$\n$$\n|A_U|^2 = 1 - 2\\alpha(1-\\cos\\theta) + \\alpha^2(1-2\\cos\\theta+\\cos^2\\theta+\\sin^2\\theta) = 1 - 2\\alpha(1-\\cos\\theta) + 2\\alpha^2(1-\\cos\\theta)\n$$\n$$\n|A_U|^2 = 1 + 2\\alpha(\\alpha-1)(1-\\cos\\theta)\n$$\nFor stability, $|A_U|^2 \\le 1$, which requires $2\\alpha(\\alpha-1)(1-\\cos\\theta) \\le 0$.\nSince $\\alpha = U\\Delta t/\\Delta x > 0$ and $1-\\cos\\theta \\ge 0$, this inequality holds if and only if $\\alpha-1 \\le 0$, meaning $\\alpha \\le 1$.\nThe analysis for $U0$ would involve a forward spatial difference for the upwind scheme, leading to the condition $|U|\\Delta t/\\Delta x \\le 1$. Thus, the stability is generally determined by the advective CFL condition.\n$$\n\\frac{|U|\\Delta t}{\\Delta x} \\le 1 \\implies \\Delta t \\le \\frac{\\Delta x}{|U|}\n$$\nThe maximum stable time step for the IMEX scheme is $\\Delta t_{\\text{max}} = \\frac{\\Delta x}{|U|}$. This successfully removes the dependency on the fast gravity wave speed $c$.\n\nCombining the results, the pair of maximum stable time steps for Part A and Part B is $(\\frac{\\Delta x}{c}, \\frac{\\Delta x}{|U|})$. These expressions have units of seconds as required.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\Delta x}{c}  \\frac{\\Delta x}{|U|}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Predictability on subseasonal-to-seasonal (S2S) timescales hinges on the \"memory\" within slowly evolving components of the Earth system, like the ocean, sea ice, and land surface. These components integrate atmospheric forcing over time and provide a persistent signal that can guide forecasts beyond the chaotic limit of the atmosphere alone. This practice  asks you to quantify this memory by deriving the e-folding timescale of Sea Surface Temperature (SST) anomalies from a simplified ocean mixed-layer heat budget, providing a tangible link between fundamental physical principles and the practical limits of long-range prediction.",
            "id": "4086435",
            "problem": "Consider a simplified bulk ocean mixed-layer model used in numerical weather prediction and climate modeling to assess seamless prediction across timescales. Let the mixed layer of the ocean have constant thickness $h$ and be subjected to surface heat fluxes and entrainment at its base. Define Sea Surface Temperature (SST) anomalies $T'(t)$ relative to a climatological mean, and assume horizontal advection is negligible on subseasonal timescales. The mixed-layer heat content obeys conservation of energy: the product of seawater density $\\rho_w$, specific heat capacity at constant pressure $c_p$, and mixed-layer thickness $h$ multiplied by the SST tendency equals the sum of surface heat flux into the ocean and the net heat flux into the mixed layer due to entrainment across its base. Parameterize the anomalous surface heat flux using a linear bulk flux feedback $Q'(t) = -\\Lambda\\,T'(t)$, and the entrainment heat flux using an entrainment velocity $w_e$ acting on the temperature jump $(T_b - T)$ at the base of the mixed layer. For subseasonal anomalies, assume deeper ocean temperature anomalies vanish, i.e., $T_b'(t) = 0$, and there is no external stochastic forcing. Starting from these assumptions and energy conservation, derive the autonomous linear ordinary differential equation governing $T'(t)$ and obtain the closed-form expression for the e-folding time $\\tau$ of SST anomalies, defined by $T'(t) = T'(0)\\exp(-t/\\tau)$ in the absence of external forcing. Then, evaluate $\\tau$ numerically for the following scientifically plausible parameter values representative of a subtropical ocean regime relevant to Subseasonal to Seasonal (S2S) forecasting:\n- $\\rho_w = 1025$ (seawater density),\n- $c_p = 3990$ (specific heat capacity at constant pressure),\n- $h = 40$ (mixed-layer depth),\n- $\\Lambda = 30$ (linear bulk heat flux feedback coefficient),\n- $w_e = 0.8$ (entrainment velocity given in meters per day).\nExpress the final e-folding time in days. Round your answer to $4$ significant figures. Use $86400$ seconds per day for unit conversion if needed.",
            "solution": "The problem asks for the derivation of the governing ordinary differential equation (ODE) for Sea Surface Temperature (SST) anomalies, $T'(t)$, and the subsequent calculation of the e-folding time, $\\tau$. The starting point is the principle of energy conservation for the ocean mixed layer, which has a constant thickness $h$.\n\nThe rate of change of heat content per unit area of the mixed layer is equal to the net heat flux into it. The heat content per unit area is given by the product of the volumetric heat capacity, $\\rho_w c_p$, the mixed-layer thickness, $h$, and its temperature, $T$. Assuming $h$ is constant, the energy balance equation is:\n$$\n\\rho_w c_p h \\frac{dT}{dt} = Q_{net}\n$$\nwhere $\\rho_w$ is the seawater density, $c_p$ is the specific heat capacity, and $Q_{net}$ is the net heat flux into the layer. $Q_{net}$ is the sum of the surface heat flux, $Q_{surf}$, and the heat flux from entrainment at the base, $Q_{ent}$.\n$$\n\\rho_w c_p h \\frac{dT}{dt} = Q_{surf} + Q_{ent}\n$$\nThe temperature $T$ can be decomposed into a constant climatological mean $T_{clim}$ and a time-varying anomaly $T'$, such that $T(t) = T_{clim} + T'(t)$. Consequently, $\\frac{dT}{dt} = \\frac{dT'}{dt}$. The fluxes are likewise decomposed. The anomalous surface heat flux is given by the linear feedback parameterization $Q'(t) = -\\Lambda T'(t)$, so the total surface flux is $Q_{surf} = Q_{clim} + Q' = Q_{clim} - \\Lambda T'(t)$.\n\nThe entrainment heat flux results from mixing colder water from below the mixed layer into it. This flux is proportional to the entrainment velocity, $w_e$, and the temperature difference between the water below the mixed layer, $T_b$, and the mixed layer itself, $T$. This represents a cooling effect, as typically $T_b  T$. A standard physical formulation for this flux is $Q_{ent} = \\rho_w c_p w_e (T_b - T)$. The base temperature $T_b$ is also decomposed as $T_b(t) = T_{b,clim} + T_b'(t)$.\n\nSubstituting these parameterizations into the energy balance equation yields:\n$$\n\\rho_w c_p h \\frac{d(T_{clim} + T')}{dt} = [Q_{clim} - \\Lambda T'] + [\\rho_w c_p w_e ((T_{b,clim} + T_b') - (T_{clim} + T'))]\n$$\nSince $\\frac{dT_{clim}}{dt} = 0$, the left side becomes $\\rho_w c_p h \\frac{dT'}{dt}$. Expanding the right side gives:\n$$\n\\rho_w c_p h \\frac{dT'}{dt} = Q_{clim} - \\Lambda T' + \\rho_w c_p w_e (T_{b,clim} - T_{clim}) + \\rho_w c_p w_e (T_b' - T')\n$$\nIn the climatological steady state, all anomalies and time derivatives are zero. Thus, the mean state is balanced by:\n$$\n0 = Q_{clim} + \\rho_w c_p w_e (T_{b,clim} - T_{clim})\n$$\nSubtracting this mean-state equation from the full equation for the anomalies yields the governing equation for $T'$:\n$$\n\\rho_w c_p h \\frac{dT'}{dt} = -\\Lambda T' + \\rho_w c_p w_e (T_b' - T')\n$$\nThe problem specifies that for subseasonal anomalies, the deeper ocean temperature anomalies vanish, i.e., $T_b' = 0$. Applying this condition simplifies the equation to:\n$$\n\\rho_w c_p h \\frac{dT'}{dt} = -\\Lambda T' - \\rho_w c_p w_e T'\n$$\nThis is the autonomous linear ordinary differential equation for $T'(t)$. We can factor out $T'$ on the right-hand side:\n$$\n\\rho_w c_p h \\frac{dT'}{dt} = -(\\Lambda + \\rho_w c_p w_e) T'\n$$\nRearranging the equation into the standard form $\\frac{dT'}{dt} = -k T'$ gives:\n$$\n\\frac{dT'}{dt} = -\\left( \\frac{\\Lambda + \\rho_w c_p w_e}{\\rho_w c_p h} \\right) T'\n$$\nThe solution to this ODE is of the form $T'(t) = T'(0) \\exp(-kt)$. The problem defines the e-folding time $\\tau$ via the relation $T'(t) = T'(0)\\exp(-t/\\tau)$. By comparing these forms, we identify the decay rate $k$ as the reciprocal of the e-folding time, $1/\\tau$.\n$$\n\\frac{1}{\\tau} = \\frac{\\Lambda + \\rho_w c_p w_e}{\\rho_w c_p h}\n$$\nTherefore, the closed-form expression for the e-folding time $\\tau$ is:\n$$\n\\tau = \\frac{\\rho_w c_p h}{\\Lambda + \\rho_w c_p w_e}\n$$\nNext, we evaluate $\\tau$ numerically using the provided parameter values. For consistency, all units must be converted to the International System of Units (SI).\nThe given parameters are:\n- $\\rho_w = 1025 \\text{ kg} \\cdot \\text{m}^{-3}$\n- $c_p = 3990 \\text{ J} \\cdot \\text{kg}^{-1} \\cdot \\text{K}^{-1}$\n- $h = 40 \\text{ m}$\n- $\\Lambda = 30 \\text{ W} \\cdot \\text{m}^{-2} \\cdot \\text{K}^{-1} = 30 \\text{ J} \\cdot \\text{s}^{-1} \\cdot \\text{m}^{-2} \\cdot \\text{K}^{-1}$\n- $w_e = 0.8 \\text{ m/day}$\n\nThe entrainment velocity $w_e$ must be converted from meters per day to meters per second using the conversion factor $1 \\text{ day} = 86400 \\text{ s}$:\n$$\nw_e = 0.8 \\frac{\\text{m}}{\\text{day}} \\times \\frac{1 \\text{ day}}{86400 \\text{ s}} = \\frac{0.8}{86400} \\text{ m} \\cdot \\text{s}^{-1}\n$$\nFirst, calculate the numerator, which represents the heat capacity of the mixed layer per unit area:\n$$\n\\text{Numerator} = \\rho_w c_p h = 1025 \\times 3990 \\times 40 = 163,590,000 \\text{ J} \\cdot \\text{m}^{-2} \\cdot \\text{K}^{-1}\n$$\nNext, calculate the denominator, which represents the total damping coefficient. The two terms in the denominator must have the same units of $\\text{J} \\cdot \\text{s}^{-1} \\cdot \\text{m}^{-2} \\cdot \\text{K}^{-1}$.\n$$\n\\text{Denominator} = \\Lambda + \\rho_w c_p w_e = 30 + (1025 \\times 3990 \\times \\frac{0.8}{86400})\n$$\nCalculating the second term:\n$$\n\\rho_w c_p w_e = 4,089,750 \\times \\frac{0.8}{86400} = \\frac{3,271,800}{86,400} \\approx 37.868056 \\text{ J} \\cdot \\text{s}^{-1} \\cdot \\text{m}^{-2} \\cdot \\text{K}^{-1}\n$$\nSo the denominator is:\n$$\n\\text{Denominator} = 30 + 37.868056 = 67.868056 \\text{ J} \\cdot \\text{s}^{-1} \\cdot \\text{m}^{-2} \\cdot \\text{K}^{-1}\n$$\nNow, we can calculate $\\tau$. The resulting unit will be seconds.\n$$\n\\tau_s = \\frac{163,590,000}{67.868056} \\approx 2,410,389.6 \\text{ s}\n$$\nFinally, we convert the e-folding time from seconds to days:\n$$\n\\tau_{days} = \\frac{\\tau_s}{86400} = \\frac{2,410,389.6}{86400} \\approx 27.90034 \\text{ days}\n$$\nRounding the result to $4$ significant figures as requested gives $27.90$ days.",
            "answer": "$$\n\\boxed{27.90}\n$$"
        },
        {
            "introduction": "A robust seamless prediction system requires that its various components—such as the dynamical core and the data assimilation system—work together without violating fundamental physical laws. In practice, numerical methods optimized for one purpose (e.g., accuracy in semi-Lagrangian advection) may not inherently respect constraints that are crucial for long-term stability, such as mass conservation. This problem  explores how mass can be spuriously gained or lost at the interface of a forecast model and a variational data assimilation analysis, and challenges you to derive a practical correction scheme, a common and essential tool for maintaining the physical integrity of operational models.",
            "id": "4086386",
            "problem": "Consider a bounded domain discretized into $N$ quasi-Lagrangian control volumes (cells) with areas $\\{A_i\\}_{i=1}^{N}$ that form a partition of the horizontal plane. A passive tracer with mixing ratio $q$ evolves under advection by a non-divergent velocity field (i.e., $\\nabla \\cdot \\boldsymbol{u} = 0$), with no sources or sinks. In the continuous setting, the integral form of the continuity equation for $q$ implies that the domain-integrated mass $M(t) = \\int_{\\Omega} q(\\boldsymbol{x}, t) \\,\\mathrm{d}A$ is invariant in time.\n\nYou advance $q$ over a single time step $\\Delta t$ using a semi-Lagrangian method that reconstructs the forecast field $\\{q_f^i\\}_{i=1}^{N}$ at cell centers from departure points via linear interpolation. This discrete mapping can be written abstractly as\n$$\nq_f^i = \\sum_{j=1}^{N} W_{ij} \\, q^n_j,\n$$\nwhere $q^n_j$ is the tracer mixing ratio in cell $j$ at the previous time level and $W_{ij} \\ge 0$ are interpolation weights determined by the semi-Lagrangian scheme and the geometry of the departure point relative to the grid. The global mass after the semi-Lagrangian step is $M_f = \\sum_{i=1}^{N} A_i \\, q_f^i$.\n\nNext, you perform a Three-Dimensional Variational (3D-Var) data assimilation analysis that updates the forecast to an analyzed field via increments $\\{d^i\\}_{i=1}^{N}$,\n$$\nq_a^i = q_f^i + d^i.\n$$\nThe 3D-Var increment vector $\\boldsymbol{d}$ is the minimizer of a quadratic cost function defined through a symmetric positive-definite background-error covariance matrix and a symmetric positive-definite observation-error covariance matrix, but there is no explicit mass constraint in the analysis.\n\nAssume $\\nabla \\cdot \\boldsymbol{u} = 0$ and no sources or sinks, and assume there are no boundary fluxes across $\\partial \\Omega$. Starting from the integral conservation law and the discrete forms above:\n\n- Derive the condition on the interpolation weights $\\{W_{ij}\\}$ that would be sufficient for the semi-Lagrangian step to be discretely mass-conservative, and show why generic linear interpolation in semi-Lagrangian schemes may violate this condition.\n- Show that, in general, the 3D-Var analysis can introduce a global mass discrepancy at the discrete level.\n- Propose a single scalar correction strategy applied uniformly to the analyzed field, $q_c^i = s \\, q_a^i$, that restores the domain-integrated mass to the semi-Lagrangian forecast mass $M_f$ to machine precision.\n- Derive the closed-form analytic expression for the scalar $s$ in terms of $\\{A_i\\}_{i=1}^{N}$, $\\{q_f^i\\}_{i=1}^{N}$, and $\\{q_a^i\\}_{i=1}^{N}$, under the assumptions above. Your final answer must be the expression for $s$ only. No numerical evaluation is required.\n\nExpress your final answer as an analytic expression. Do not include any units, and do not round. The answer must be a single expression.",
            "solution": "The fundamental base for conservation of a passive tracer mixing ratio under advection by a non-divergent flow with no sources or sinks is the continuity equation. Let $q(\\boldsymbol{x}, t)$ be a passive tracer mixing ratio. The Eulerian form is\n$$\n\\frac{\\partial q}{\\partial t} + \\boldsymbol{u} \\cdot \\nabla q = 0,\n$$\nand with $\\nabla \\cdot \\boldsymbol{u} = 0$ (non-divergent flow), the flux form $\\frac{\\partial q}{\\partial t} + \\nabla \\cdot (q \\boldsymbol{u}) = 0$ reduces to the advection equation. Integrating the flux form over a closed domain $\\Omega$ with no boundary flux,\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{\\Omega} q \\,\\mathrm{d}A = - \\int_{\\partial \\Omega} q \\, \\boldsymbol{u} \\cdot \\boldsymbol{n} \\,\\mathrm{d}S = 0,\n$$\nso the domain-integrated mass $M(t) = \\int_{\\Omega} q \\,\\mathrm{d}A$ is constant in time.\n\nIn a discrete setting with $N$ control volumes of areas $\\{A_i\\}$ and cell-centered values, the domain mass at time level $n$ is $M^n = \\sum_{j=1}^{N} A_j \\, q^n_j$. The semi-Lagrangian forecast is\n$$\nq_f^i = \\sum_{j=1}^{N} W_{ij}\\, q^n_j,\n$$\nwith weights $W_{ij}\\ge 0$ determined by departure point interpolations. The global mass after the semi-Lagrangian step is\n$$\nM_f = \\sum_{i=1}^{N} A_i \\, q_f^i = \\sum_{i=1}^{N} A_i \\sum_{j=1}^{N} W_{ij}\\, q^n_j = \\sum_{j=1}^{N} \\left(\\sum_{i=1}^{N} A_i \\, W_{ij}\\right) q^n_j.\n$$\nFor the semi-Lagrangian step to be discretely mass-conservative for arbitrary $\\{q^n_j\\}$, it is sufficient that the mapping preserves the area weights from origin to target, namely\n$$\n\\sum_{i=1}^{N} A_i \\, W_{ij} = A_j \\quad \\text{for all } j \\in \\{1,\\dots,N\\}.\n$$\nUnder this condition,\n$$\nM_f = \\sum_{j=1}^{N} A_j \\, q^n_j = M^n,\n$$\nand mass is conserved discretely. Generic linear interpolation used in semi-Lagrangian schemes is designed to be accurate for field values along trajectories but does not generally enforce the area-weighted identity $\\sum_{i} A_i W_{ij} = A_j$. The weights $\\{W_{ij}\\}$ are typically normalized such that $\\sum_{j} W_{ij} = 1$ for each $i$ to ensure consistency of local reconstruction, but there is no guarantee on the area-weighted column sums. Therefore, in the absence of conservative remapping, the semi-Lagrangian step can introduce a global mass error\n$$\n\\varepsilon_{\\mathrm{SL}} = M_f - M^n = \\sum_{j=1}^{N} \\left(\\sum_{i=1}^{N} A_i \\, W_{ij} - A_j\\right) q^n_j,\n$$\nwhich is nonzero in general.\n\nThe Three-Dimensional Variational (3D-Var) analysis constructs $\\boldsymbol{d}$ as the minimizer of a quadratic cost function, typically\n$$\nJ(\\boldsymbol{x}) = \\frac{1}{2}(\\boldsymbol{x}-\\boldsymbol{x}_f)^{\\top} \\boldsymbol{B}^{-1} (\\boldsymbol{x}-\\boldsymbol{x}_f) + \\frac{1}{2}(\\boldsymbol{H}\\boldsymbol{x}-\\boldsymbol{y})^{\\top} \\boldsymbol{R}^{-1} (\\boldsymbol{H}\\boldsymbol{x}-\\boldsymbol{y}),\n$$\nwhere $\\boldsymbol{x}$ collects the discrete state, $\\boldsymbol{x}_f$ is the forecast, $\\boldsymbol{B}$ is the background-error covariance matrix, $\\boldsymbol{H}$ is the observation operator, and $\\boldsymbol{R}$ is the observation-error covariance matrix. In the standard formulation, there is no hard constraint enforcing $\\sum_{i=1}^{N} A_i \\, d^i = 0$. Therefore, after analysis\n$$\nq_a^i = q_f^i + d^i,\n$$\nthe analyzed mass is\n$$\nM_a = \\sum_{i=1}^{N} A_i \\, q_a^i = \\sum_{i=1}^{N} A_i \\, q_f^i + \\sum_{i=1}^{N} A_i \\, d^i = M_f + \\varepsilon_{\\mathrm{3DVar}},\n$$\nwith\n$$\n\\varepsilon_{\\mathrm{3DVar}} = \\sum_{i=1}^{N} A_i \\, d^i,\n$$\nwhich is generally nonzero. The combined effect is that $M_a \\ne M^n$ and $M_a \\ne M_f$ unless special compatibility constraints or conservative re-mapping are enforced.\n\nTo restore mass exactly to the semi-Lagrangian forecast mass $M_f$ at machine precision, a simple scalar correction strategy is to rescale the analyzed field by a uniform multiplicative factor $s$:\n$$\nq_c^i = s \\, q_a^i, \\quad i = 1,\\dots,N.\n$$\nThe corrected mass is\n$$\nM_c = \\sum_{i=1}^{N} A_i \\, q_c^i = \\sum_{i=1}^{N} A_i \\, s \\, q_a^i = s \\sum_{i=1}^{N} A_i \\, q_a^i = s \\, M_a.\n$$\nImposing the requirement $M_c = M_f$ yields a single scalar equation for $s$:\n$$\ns \\, M_a = M_f \\quad \\Longrightarrow \\quad s = \\frac{M_f}{M_a}.\n$$\nExpressed in terms of the discrete fields,\n$$\nM_f = \\sum_{i=1}^{N} A_i \\, q_f^i, \\qquad M_a = \\sum_{i=1}^{N} A_i \\, q_a^i,\n$$\nso the closed-form analytic expression for the correction factor is\n$$\ns = \\frac{\\sum_{i=1}^{N} A_i \\, q_f^i}{\\sum_{i=1}^{N} A_i \\, q_a^i}.\n$$\nThis multiplicative correction restores the analyzed global mass to equal the semi-Lagrangian forecast mass to machine precision, because the resulting corrected mass is $M_c = s M_a = M_f$ up to floating-point roundoff in the summations. It is a minimal-rank correction (scalar) that preserves the analyzed spatial shape relative to $\\boldsymbol{q}_a$ and maintains positivity if $\\boldsymbol{q}_a$ is positive and $M_f/M_a  0$.",
            "answer": "$$\\boxed{\\frac{\\sum_{i=1}^{N} A_i \\, q_f^i}{\\sum_{i=1}^{N} A_i \\, q_a^i}}$$"
        }
    ]
}