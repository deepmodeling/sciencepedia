## 引言
在[数值天气预报](@entry_id:191656)和气候建模中，任何预报都天然伴随着不确定性。一个完美的预报需要对地球系统的当前状态有完美的认知，并拥有一个能完美描述其演化的模型，但这在现实中是不可能实现的。因此，除了预测大气状态本身，理解、量化并预测不确定性的演变变得同等重要。本文旨在填补这一知识鸿沟，为读者提供一个关于[集合预报系统](@entry_id:1124526)及不确定性来源的全面框架。

本文将通过三个章节逐步展开。第一章“原理与机制”将深入剖析不确定性的根本来源，包括初始条件和模型缺陷，探讨不确定性的增长动力学，并详细介绍构建[集合预报系统](@entry_id:1124526)的核心技术。第二章“应用与跨学科联系”将展示这些原理的实际应用，探讨如何利用[集合预报系统](@entry_id:1124526)进行科学探究、优化业务决策，并揭示其与水文学、[理论化学](@entry_id:199050)等其他学科的联系。最后，在“动手实践”部分，读者将通过具体计算，亲身体验不确定性量化和集合预报评估的关键概念。通过学习本文，读者将能够系统地掌握[不确定性量化](@entry_id:138597)的理论基础与实践方法。

## 原理与机制

在[数值天气预报](@entry_id:191656)（NWP）和气候建模领域，任何预测都不可避免地伴随着不确定性。一个完美的预测需要对系统的初始状态有完美的了解，并拥有一个能完美描述系统演化的模型。然而，这两者在现实中都无法实现。因此，理解、量化和预测不确定性的演变，与预测大气状态本身同样重要。本章将深入探讨不确定性的基本来源、其增长的[动力学机制](@entry_id:904736)、用于表征这些不确定性的[集合预报系统](@entry_id:1124526)（EPS）的构建方法，以及评估这些概率性预测的框架。

### 不确定性的基本来源

[地球系统模型](@entry_id:1124096)试图通过一组[微分](@entry_id:158422)方程来近似真实大气的演化，其一般形式可以写作 $\frac{\mathrm{d}\boldsymbol{x}}{\mathrm{d}t} = \mathcal{M}(\boldsymbol{x}; \boldsymbol{\theta})$，其中 $\boldsymbol{x}$ 是模型的[状态向量](@entry_id:154607)（例如温度、风场），$\mathcal{M}$ 是代表物理和动力学过程的模型算子，而 $\boldsymbol{\theta}$ 是模型中的参数。预测的不确定性主要源于我们对这个理想化系统的三个组成部分——初始状态 $\boldsymbol{x}_0$、模型算子 $\mathcal{M}$ 和模型参数 $\boldsymbol{\theta}$——的知识不完备。这些不确定性可以被归类为两大范畴：认知不确定性（epistemic uncertainty）和[偶然不确定性](@entry_id:634772)（aleatory uncertainty）。

#### 认知不确定性与[偶然不确定性](@entry_id:634772)

**认知不确定性**（Epistemic Uncertainty）源于知识的缺乏。理论上，这种不确定性是可以通过更多的信息、更好的观测或更完善的理论来减少的。它主要包括以下几个方面：

1.  **初始条件不确定性（Initial Condition Uncertainty）**：这是[天气预报不确定性](@entry_id:1134015)的一个经典来源。由于观测网络在空间和时间上的稀疏性，以及观测本身的误差，我们无法精确地知道大气的当前状态 $\boldsymbol{x}_{\text{true}}$。数据同化系统结合观测和背景场，提供一个最优估计的分析场 $\boldsymbol{x}_0^{\text{an}}$，但这个分析场仍然与真实状态存在一个分析误差 $\boldsymbol{\epsilon}$。这个误差的统计特性（例如其[协方差矩阵](@entry_id:139155) $\mathbf{A}$）是初始条件不确定性的核心。原则上，通过增加或改进观测，我们可以减小这种不确定性 。

2.  **[模型不确定性](@entry_id:265539)（Model Uncertainty）**：这指的是我们的模型算子 $\mathcal{M}$ 本身是对真实物理过程的一个不完美近似。它又可细分为：
    *   **结构不确定性（Structural Uncertainty）**：这源于模型方程形式的根本性缺陷或简化。例如，一个模型可能完全忽略了某个重要的物理过程（如忘记在层积云顶边界层方案中包含云顶长波[辐射冷却](@entry_id:1130496)这一驱动[湍流](@entry_id:151300)的关键过程），或者使用了物理假设完全不同的[参数化](@entry_id:265163)方案（例如，用一个简单的对流调整方案代替基于质量通量的积云对流方案）。从单矩微物理方案（只预报水物质的质量[混合比](@entry_id:1127970)）升级到[双矩方案](@entry_id:1123945)（同时预报质量和数浓度）也是一个改变模型结构以减少结构不确定性的例子 。
    *   **[参数不确定性](@entry_id:264387)（Parameter Uncertainty）**：即使模型的基本结构是固定的，其中许多参数 $\boldsymbol{\theta}$ 的值也是不确定的。这些参数通常是通过经验或半经验关系得到的（例如，云微物理过程中的自动转化阈值、边界层方案中的[冯·卡门常数](@entry_id:261117) $\kappa$）。对这些参数进行调优可以在一定程度上补偿模型的结构性缺陷，但无法从根本上修复由缺失物理过程导致的系统性偏差  。

**[偶然不确定性](@entry_id:634772)**（Aleatory Uncertainty）则被认为是系统固有的、不可约减的随机性。它并非源于知识的缺乏，而是反映了那些从宏观层面看本质上不可预测的过程。在NWP中，这通常与模型无法解析的[次网格尺度过程](@entry_id:1132602)有关。例如，单个对流单体或[湍流](@entry_id:151300)涡旋的触发和发展具有随机性。为了表示这种行为，一些[参数化](@entry_id:265163)方案会引入随机项 $\boldsymbol{\eta}(t)$，即 $\frac{\mathrm{d}\boldsymbol{x}}{\mathrm{d}t} = \mathcal{M}(\boldsymbol{x}; \boldsymbol{\theta}) + \boldsymbol{\eta}(t)$。由这个随机项产生的预报多样性，即使在初始条件和模型参数完全相同的情况下依然存在，这便是[偶然不确定性](@entry_id:634772)。一个典型的例子是，在[随机对流](@entry_id:1132416)方案中使用不同的随机种子，即使宏观初始条件完全相同，也会产生不同的降水预报场 。

此外，与观测相关的**表示性误差（Representation Error）**也是一个重要概念。它发生在将模型状态与观测进行比较时。模型变量（如一个网格的平均温度）和观测值（如一个站点的单点温度）所代表的物理量在尺度上存在差异。例如，一个大像元的卫星辐射观测值与一个“点状”的探空仪观测值相比，通常会由于集成了更多[次网格尺度](@entry_id:1132591)的非均匀性而表现出更大的表示性误差。表示性误差与观测仪器本身的噪声（即**观测误差**, $e_{\text{obs}}$）是不同的；提高仪器精度可以减少观测误差，但无法消除表示性误差 。

### 不确定性的增长：[可预报性极限](@entry_id:147847)

不确定性一旦存在于系统中，便会随着模型的积分而增长和演变。这种增长的特性决定了我们预测能力的极限。著名气象学家Edward Lorenz将可预报性问题划分为两类。

#### 第一类可预报性

**第一类可预报性**（Predictability of the First Kind）是典型的[初值问题](@entry_id:142753)，它关注的是：给定一个尽可能精确的初始状态，我们能在多长时间内准确预测系统的未来轨迹？这正是日常天气预报的核心问题。大气是一个混沌系统，这意味着它对初始条件具有敏感依赖性，即著名的“[蝴蝶效应](@entry_id:143006)”。任何微小的初始误差都会随着时间呈指数级增长。

这种增长率可以通过**[最大李雅普诺夫指数](@entry_id:188872)**（Largest Lyapunov Exponent）$\lambda$ 来量化。在线性近似下，一个初始扰动 $\delta\boldsymbol{x}(0)$ 的大小（范数）将按 $e(t) \approx e(0)\exp(\lambda t)$ 的形式增长 。这种[指数增长](@entry_id:141869)意味着，无论初始误差有多小，它最终都会增长到与系统自身变率相当的量级，此时预报将完全失去技巧。这个时间尺度定义了天气预报的**[可预报性极限](@entry_id:147847)**，通常在10到14天左右。因此，第一类可预报性的主要限制因素是初始条件的不确定性 。

对于一个给定的[常系数](@entry_id:269842)线性系统 $\dot{\delta \mathbf{x}} = \mathbf{J}\,\delta \mathbf{x}$，李雅普诺夫指数就是矩阵 $\mathbf{J}$ 特征值的实部。例如，对于一个代表斜压扰动的二维系统，其[雅可比矩阵](@entry_id:178326)为 $\mathbf{J} = \begin{pmatrix} 0.25  0.80 \\ -1.20  0.25 \end{pmatrix}$，其特征值为 $0.25 \pm i\sqrt{0.96}$。因此，[最大李雅普诺夫指数](@entry_id:188872)为 $\lambda_{\text{max}} = 0.25 \text{ day}^{-1}$ 。

#### 第二类可预报性

**第二类可预报性**（Predictability of the Second Kind）则是一个边值问题，它关注的是：当外部强迫或边界条件（如[海表温度](@entry_id:1131347)、温室气体浓度、太阳辐射）发生变化时，系统的长期统计特性（即“气候”）会如何响应？在这种情况下，我们放弃了预测系统在遥远未来的精确瞬时状态，转而预测其统计分布，例如季节平均温度或年平均降水量。

这些统计特性由系统的**[不变测度](@entry_id:202044)** $\mu_\beta$ 决定，它依赖于边界条件/强迫参数 $\beta$。因此，第二类可预报性的主要限制因素是边界条件的不确定性。例如，预测21世纪末全[球平均](@entry_id:165984)温度的不确定性，主要不是来自今天大气状态的微小误差，而是来自我们对未来温室气体排放情景（即强迫 $\beta$）的不确定性。只要我们能约束边界条件，即使在第一类可预报性完全丧失之后，对气候统计量的预测仍然可能具有技巧 。

### 构建[集合预报系统](@entry_id:1124526)

为了量化预报中的不确定性并提供概率性预报，我们使用**[集合预报系统](@entry_id:1124526)**（Ensemble Prediction Systems, EPS）。其核心思想是通过对不确定性的主要来源进行采样，生成一组（一个集合）平行的预报，每个预报成员都代表一种可能的大气演变路径。集合成员的离散程度（spread）旨在反映预报的不确定性。

#### 生成初始条件扰动

由于初始条件不确定性是短期预报误差的主要来源，因此生成初始扰动是EPS的关键技术。目标不是简单地加入随机噪声，而是要找到那些对预报结果影响最大的“增长最快”的扰动结构。

*   **[奇异向量](@entry_id:143538)（Singular Vectors, SVs）**：这是一种基于[线性动力学](@entry_id:177848)的优化方法。[奇异向量](@entry_id:143538)被定义为在有限时间段内，在特定范数（通常是[能量范数](@entry_id:274966)）下线性增长最快的初始扰动。计算SV需要模型正切线性算子及其[伴随算子](@entry_id:140236)。它们是针对特定时间窗口和范数的最优[线性增长](@entry_id:157553)模态，能够有效捕捉斜压不稳定等快速增长的误差  。需要强调的是，[奇异向量](@entry_id:143538)与瞬时动力学算子 $\boldsymbol{A}(t)$ 的[特征向量](@entry_id:151813)不同。在非正规（non-normal）系统中（[大气动力学](@entry_id:746558)系统通常是强非正规的），[奇异向量](@entry_id:143538)和[特征向量](@entry_id:151813)通常不一致，正是这种不一致性导致了即使在所有特征值实部都为负的稳定系统中也可能出现[瞬时增长](@entry_id:263654) 。

*   **增长模繁殖法（Bred Vectors, BVs）**：这是一种更符合实际的、基于非线性模型的方法。它通过在一个短的“繁殖”周期内，反[复积分](@entry_id:202758)一个有限振幅的扰动，然后将其重新缩放到原始大小来实现。这个过程不依赖于[切线](@entry_id:268870)性或[伴随模型](@entry_id:1120820)，而是直接利用完整的[非线性模型](@entry_id:276864)。经过多次循环，保留下来的扰动结构倾向于与系统的主要[非线性不稳定性](@entry_id:752642)（即李雅普诺夫向量）对齐。BVs的形态依赖于繁殖周期长度和重缩放的振幅   。

*   **集合卡尔曼滤波扰动（ETKF Perturbations）**：这种方法将扰动生成与数据同化过程紧密结合。在[集合卡尔曼滤波](@entry_id:166109)（EnKF）框架下，分析[误差协方差](@entry_id:194780)是根据[预报集合](@entry_id:749510)成员的离散度动态计算的。因此，通过EnKF更新得到的分析集合，其成员间的差异（即分析扰动）自然地代表了与当前大气流动和观测网络相适应的初始不确定性结构。这些扰动被限制在由[预报集合](@entry_id:749510)张成的子空间内 。

#### 表示模型不确定性

除了初始扰动，现代EPS还必须考虑模型不确定性。这通常通过以下方式实现：

*   **随机物理过程（Stochastic Physics）**：在模型的[参数化](@entry_id:265163)方案中引入随机扰动，例如随机扰动[参数化](@entry_id:265163)倾向（SPPT）方案。这可以代表次网格过程的[偶然不确定性](@entry_id:634772)，也能部分模拟结构不确定性的影响。
*   **多模型集合（Multi-model Ensembles）**：联合来自不同NWP中心的多个不同模型，这是捕捉结构不确定性的最直接方式。
*   **参数扰动（Perturbed Parameters）**：在集合的不同成员中，对关键的物理参数（如对流夹卷率、拖曳系数等）赋予略微不同的值，以采样参数不确定性。

### 数据同化中的作用：流依赖协方差

EPS的初始条件来自数据同化系统，而数据同化本身也越来越依赖于集合方法来估计误差统计。在贝叶斯框架下，数据同化的目标是融合[先验信息](@entry_id:753750)（背景场，即短期预报）和新的观测，得到一个[后验概率](@entry_id:153467)分布（分析场）。

在传统的[三维变分同化](@entry_id:755953)（**3D-Var**）中，背景误差的统计特性由一个静态的、气候平均的**[背景误差协方差](@entry_id:1121308)矩阵** $\mathbf{B}$ 描述。这个矩阵 $\mathbf{B}$ 不随具体的预报情况变化，因此无法捕捉到特定天气形势下的误差结构，例如与锋面或急流相关的各向异性误差。

相比之下，**[集合卡尔曼滤波](@entry_id:166109)（EnKF）** 使用[预报集合](@entry_id:749510)成员来实时估计背景误差协方差。其分析[更新方程](@entry_id:264802)为：
$$
\bar{\boldsymbol{x}}^a = \bar{\boldsymbol{x}}^f + \mathbf{K}(\boldsymbol{y} - \mathbf{H}\bar{\boldsymbol{x}}^f)
$$
$$
\mathbf{P}^a = (\mathbf{I} - \mathbf{K}\mathbf{H})\mathbf{P}^f
$$
其中，关键在于背景误差协方差 $\mathbf{P}^f$ 是由[预报集合](@entry_id:749510)的样本协方差计算得出的。由于集合成员是通过非线性模型积分得到的，$\mathbf{P}^f$ 自然地包含了当前大气流动的印记，是**流依赖的（flow-dependent）**和各向异性的。这是EnKF相对于3D-Var的根本优势 。

然而，EnKF也面临着严峻的挑战。在实际应用中，集合成员数 $K$（通常为几十到一百）远小于模型状态向量的维数 $n$（可达 $10^7$ 到 $10^9$）。这种 $K \ll n$ 的情况导致样本协方差 $\mathbf{P}^f$ 是严重[秩亏](@entry_id:754065)的，并且由于[采样误差](@entry_id:182646)，会产生大量虚假的**远距离相关**。例如，两个物理上毫无关联的遥远地点之间的样本相关性，其方差约为 $1/(K-1)$。尽管这个值很小，但由于远距离格点对的数量巨大（与 $n^2$ 成正比），其中出现显著虚假相关的概率非常高。这些[虚假相关](@entry_id:755254)会允许一个局地观测错误地影响到遥远地区的分析场，从而破坏分析质量。

为了解决这个问题，**[协方差局地化](@entry_id:164747)（Covariance Localization）**成为EnKF系统必不可少的一部分。它通过将样本[协方差矩阵](@entry_id:139155)与一个随距离衰减的“锥化”函数进行逐元素（Schur）乘积，强制性地消除或减弱远距离相关。这确保了观测只对其物理上相关的邻近区域产生影响 。

### 评估[集合预报](@entry_id:1124525)

EPS的输出是概率性的，因此其评估方法也不同于确定性预报。对于一个二元事件（例如，日降水量超过10毫米），预报给出的是事件发生的概率 $p$，而观测结果为 $Y \in \{0,1\}$。一个常用的评估指标是**布里尔分数（Brier Score）**，$BS = \mathbb{E}[(p - Y)^2]$，其值越小越好。布里尔分数可以分解为三个部分，揭示了[概率预报](@entry_id:183505)质量的不同维度：
$$
BS = \mathbb{E}[(\mathbb{E}[Y | p] - p)^2] - \mathbb{E}[(\mathbb{E}[Y | p] - \bar{Y})^2] + \bar{Y}(1 - \bar{Y})
$$
这三个组成部分分别是：

1.  **可靠性（Reliability）**：第一项 $\mathbb{E}[(\mathbb{E}[Y | p] - p)^2]$。一个可靠的预报系统应具有[统计一致性](@entry_id:162814)，即当预报概率为 $p$ 时，事件发生的观测频率也应为 $p$。完美可靠性意味着 $\mathbb{E}[Y | p] = p$，此时该项为零。

2.  **分辨率（Resolution）**：第二项 $\mathbb{E}[(\mathbb{E}[Y | p] - \bar{Y})^2]$，其中 $\bar{Y}$ 是事件的气候平均频率。分辨率衡量的是预报系统根据不同的预报概率 $p$ 来区分不同事件频率的能力。如果系统能够对高风险和低风险情况给出显著不同的概率，且这些概率与观测频率对应良好，则其分辨率高。

3.  **不确定性（Uncertainty）**：第三项 $\bar{Y}(1 - \bar{Y})$。它只与事件本身的气候频率有关，代表了事件固有的可变性，与预报系统无关。

一个好的概率预报系统应该在保持高**可靠性**（即校准良好）的同时，追求高**分辨率**。此外，还有一个概念是**锐度（Sharpness）**，它描述预报概率 $p$ 偏离气候平均值 $\bar{Y}$、趋向于0或1的程度。一个锐利的预报（例如给出99%或1%的概率）比一个模糊的预报（例如给出50%的概率）包含更多信息，也更有用。然而，锐度本身不保证预报质量；一个过度自信（锐利）但不可靠的预报是无用的。高质量的[概率预报](@entry_id:183505)是在可靠的前提下，尽可能地提高其锐度，从而实现高分辨率 。例如，一个总是预报气候概率的系统（$p \equiv \bar{Y}$），虽然是可靠的，但其分辨率为零，没有任何预报技巧 。