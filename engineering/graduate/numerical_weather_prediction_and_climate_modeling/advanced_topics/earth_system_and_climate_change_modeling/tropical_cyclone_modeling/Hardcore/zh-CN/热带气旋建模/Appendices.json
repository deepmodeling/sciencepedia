{
    "hands_on_practices": [
        {
            "introduction": "位涡（Potential Vorticity, PV）是理解热带气旋等涡旋动力学结构与演化的核心物理量。通过计算给定风场的位涡分布，我们可以揭示涡旋的“动力学基因”。这项练习旨在通过一个理想化的轴对称风场模型，让您亲手推导位涡的径向分布，并定位位涡环的位置，从而加深对风场切变、涡度与位涡之间内在联系的理解。",
            "id": "4106198",
            "problem": "考虑一个位于常数科里奥利参数 ($f$) 平面上的理想化、轴对称热带气旋，其方位风由 $v(r) = V_{m} \\left(\\frac{r}{R_{m}}\\right) \\exp\\!\\left(1 - \\frac{r}{R_{m}}\\right)$ 给出，其中 $V_{m}  0$ 和 $R_{m}  0$ 是常数，$r$ 是距离气旋中心的半径。假设流动是稳态、无粘、静力平衡的，并且可以很好地用 Boussinesq 近似来描述。设位温 $\\theta$ 仅随高度变化，并通过 Brunt–Väisälä 频率 $N$ 定义一个均匀的静力稳定度，使得 $N^{2}  0$ 为常数。\n\n使用位涡 (PV) 的 Rossby–Ertel 定义，计算在固定高度上的轴对称径向分布 $q(r)$，该分布由 $V_{m}$、$R_{m}$、$f$ 和 $N$ 参数化。然后，将“PV 环”半径 $r_{\\ast}$ 定义为 $q(r)$ 达到环状极值时的径向位置 $r  0$ (即，当 $r  0$ 时 $\\frac{dq}{dr} = 0$)。解析地确定 $r_{\\ast}$，并用 $R_{m}$ 表示。仅报告 $r_{\\ast}$ 的解析表达式作为最终答案。无需代入数值，也无需四舍五入。",
            "solution": "问题要求计算在给定的理想化热带气旋模型中，位涡 (PV) 环状极值所在的径向位置 $r_{\\ast}$。\n\n首先，我们建立 Rossby-Ertel 位涡 $q$ 的相关表达式。其一般定义为 $q = \\frac{1}{\\rho} \\vec{\\eta} \\cdot \\nabla \\theta$，其中 $\\rho$ 是密度，$\\vec{\\eta}$ 是绝对涡度矢量，$\\theta$ 是位温。\n\n问题陈述该流动可以很好地用 Boussinesq 近似来描述。在此近似下，PV 定义中的密度 $\\rho$ 被一个常数参考密度 $\\rho_0$ 替代。\n$$q = \\frac{1}{\\rho_0} \\vec{\\eta} \\cdot \\nabla \\theta$$\n绝对涡度 $\\vec{\\eta}$ 是相对涡度 $\\vec{\\omega} = \\nabla \\times \\vec{u}$ 和行星涡度 $f\\hat{e}_z$ 的和，其中 $\\vec{u}$ 是速度矢量，$f$ 是常数科里奥利参数。流动是轴对称的，因此我们使用柱坐标系 $(r, \\lambda, z)$。速度矢量是纯方位向的：$\\vec{u} = v(r) \\hat{e}_{\\lambda}$。\n\n在柱坐标系中，相对涡度 $\\vec{\\omega}$ 为：\n$$ \\vec{\\omega} = \\nabla \\times \\vec{u} = \\left(\\frac{1}{r}\\frac{\\partial u_z}{\\partial \\lambda} - \\frac{\\partial u_{\\lambda}}{\\partial z}\\right)\\hat{e}_r + \\left(\\frac{\\partial u_r}{\\partial z} - \\frac{\\partial u_z}{\\partial r}\\right)\\hat{e}_{\\lambda} + \\frac{1}{r}\\left(\\frac{\\partial(r u_{\\lambda})}{\\partial r} - \\frac{\\partial u_r}{\\partial \\lambda}\\right)\\hat{e}_z $$\n给定 $\\vec{u} = (u_r, u_{\\lambda}, u_z) = (0, v(r), 0)$，速度的径向和垂直分量为零，方位分量 $v$ 仅依赖于 $r$。$\\vec{\\omega}$ 的表达式简化为其仅有的垂直分量：\n$$ \\vec{\\omega} = \\left( \\frac{1}{r}\\frac{d(rv(r))}{dr} \\right) \\hat{e}_z $$\n相对涡度的垂直分量记为 $\\zeta(r) = \\frac{1}{r}\\frac{d(rv(r))}{dr}$。\n于是绝对涡度矢量为 $\\vec{\\eta} = \\vec{\\omega} + f\\hat{e}_z = (\\zeta(r) + f)\\hat{e}_z$。\n\n问题陈述位温 $\\theta$ 仅随高度变化，即 $\\theta = \\theta(z)$。因此，其梯度是纯垂直的：$\\nabla \\theta = \\frac{d\\theta}{dz} \\hat{e}_z$。\n\n将这些代入 PV 方程：\n$$ q(r, z) = \\frac{1}{\\rho_0} \\left( (\\zeta(r) + f)\\hat{e}_z \\right) \\cdot \\left( \\frac{d\\theta}{dz} \\hat{e}_z \\right) = \\frac{1}{\\rho_0} (\\zeta(r) + f) \\frac{d\\theta}{dz} $$\n静力稳定度由常数 Brunt–Väisälä 频率的平方定义，$N^2 = \\frac{g}{\\theta_0} \\frac{d\\theta}{dz}$，其中 $g$ 是重力加速度，$\\theta_0$ 是参考位温。因此，$\\frac{d\\theta}{dz} = \\frac{\\theta_0 N^2}{g}$。由于 $N^2$ 是一个正常数，$\\frac{d\\theta}{dz}$ 也是一个正常数。\n因此，在固定高度上的 PV 为：\n$$ q(r) = \\frac{\\theta_0 N^2}{\\rho_0 g} (\\zeta(r) + f) $$\n项 $\\frac{\\theta_0 N^2}{\\rho_0 g}$ 是一个正常数。为了找到 $q(r)$ 的径向极值，我们需要找到相对涡度的垂直分量 $\\zeta(r)$ 的极值，因为科里奥利参数 $f$ 也是一个常数。极值的位置可以通过求解 $\\frac{dq}{dr} = 0$ 找到，这等价于求解 $\\frac{d\\zeta}{dr} = 0$。\n\n接下来，我们使用给定的方位风廓线计算 $\\zeta(r)$：\n$$ v(r) = V_{m} \\left(\\frac{r}{R_{m}}\\right) \\exp\\left(1 - \\frac{r}{R_{m}}\\right) $$\n让我们将其重写为 $v(r) = \\frac{V_m e}{R_m} r \\exp(-\\frac{r}{R_m})$。首先，我们计算环流项 $rv(r)$：\n$$ rv(r) = \\frac{V_m e}{R_m} r^2 \\exp\\left(-\\frac{r}{R_m}\\right) $$\n现在，我们对 $r$ 求导：\n$$ \\frac{d(rv(r))}{dr} = \\frac{V_m e}{R_m} \\frac{d}{dr}\\left[r^2 \\exp\\left(-\\frac{r}{R_m}\\right)\\right] $$\n使用乘积法则求导：\n$$ \\frac{d(rv(r))}{dr} = \\frac{V_m e}{R_m} \\left[ 2r \\exp\\left(-\\frac{r}{R_m}\\right) + r^2 \\left(-\\frac{1}{R_m}\\right) \\exp\\left(-\\frac{r}{R_m}\\right) \\right] $$\n$$ \\frac{d(rv(r))}{dr} = \\frac{V_m e}{R_m} r \\exp\\left(-\\frac{r}{R_m}\\right) \\left(2 - \\frac{r}{R_m}\\right) $$\n相对涡度 $\\zeta(r)$ 通过除以 $r$ 得到：\n$$ \\zeta(r) = \\frac{1}{r} \\frac{d(rv(r))}{dr} = \\frac{V_m e}{R_m} \\exp\\left(-\\frac{r}{R_m}\\right) \\left(2 - \\frac{r}{R_m}\\right) $$\n为了找到极值，我们对 $\\zeta(r)$ 关于 $r$ 求导，并令结果为零。\n$$ \\frac{d\\zeta}{dr} = \\frac{d}{dr} \\left[ \\frac{V_m e}{R_m} \\exp\\left(-\\frac{r}{R_m}\\right) \\left(2 - \\frac{r}{R_m}\\right) \\right] $$\n$$ \\frac{d\\zeta}{dr} = \\frac{V_m e}{R_m} \\left[ \\left(-\\frac{1}{R_m}\\right) \\exp\\left(-\\frac{r}{R_m}\\right) \\left(2 - \\frac{r}{R_m}\\right) + \\exp\\left(-\\frac{r}{R_m}\\right) \\left(-\\frac{1}{R_m}\\right) \\right] $$\n提取公因式：\n$$ \\frac{d\\zeta}{dr} = -\\frac{V_m e}{R_m^2} \\exp\\left(-\\frac{r}{R_m}\\right) \\left[ \\left(2 - \\frac{r}{R_m}\\right) + 1 \\right] $$\n$$ \\frac{d\\zeta}{dr} = -\\frac{V_m e}{R_m^2} \\exp\\left(-\\frac{r}{R_m}\\right) \\left(3 - \\frac{r}{R_m}\\right) $$\n当 $r  0$ 时，极值的条件是 $\\frac{d\\zeta}{dr} = 0$。由于 $V_m  0$、$R_m  0$ 且 $\\exp\\left(-\\frac{r}{R_m}\\right)  0$，此条件仅在括号中的项为零时满足：\n$$ 3 - \\frac{r}{R_m} = 0 $$\n对 $r$ 求解，得到 PV 环的半径 $r_{\\ast}$：\n$$ \\frac{r_{\\ast}}{R_m} = 3 $$\n$$ r_{\\ast} = 3R_m $$\n这是位涡环状极值径向位置的解析表达式。",
            "answer": "$$\\boxed{3R_{m}}$$"
        },
        {
            "introduction": "一个热带气旋究竟能变得多强？最大潜在强度（Maximum Potential Intensity, MPI）理论为我们提供了回答这个问题的理论框架，它将气旋视为一个热力学上的卡诺热机。本练习将引导您探索决定气旋强度上限的物理平衡：即从海洋获取的热力学能量输入与边界层内摩擦耗散之间的抗衡。通过这个练习，您将不仅能理解MPI理论的精髓，还能体会到当前关于高风速下拖曳系数等前沿研究对强度预报的直接影响。",
            "id": "4106233",
            "problem": "考虑一个位于水平均匀海洋上的轴对称、稳态热带气旋，使用整体空气动力学平板边界层模型进行分析。假设以下基本要素，这些要素在热带气旋边界层的数值天气预报和气候模拟中是标准配置：\n- 地表动量通量（应力）参数化为 $\\boldsymbol{\\tau} = \\rho\\, C_{d}(U)\\, U\\, \\boldsymbol{U}$，其中 $\\rho$ 是空气密度，$U$ 是10米中性风速大小，$C_{d}(U)$ 是拖曳系数。\n- 地表焓通量为 $Q_{k} = \\rho\\, C_{k}\\, U\\, \\left(k_{s}^{\\ast} - k\\right)$，其中 $C_{k}$ 是焓交换系数，$k_{s}^{\\ast}$ 是海表温度下的饱和湿焓，$k$ 是边界层湿焓。\n- 飓风热机的热力学效率为 $\\epsilon = \\left(T_{s} - T_{o}\\right)/T_{o}$，其中 $T_{s}$ 是海表温度，$T_{o}$ 是对流层上层的代表性出流温度。\n\n假设最大风速由边界层中的机械耗散与焓通量产生的卡诺功之间的平衡决定，请利用上述要素从第一性原理出发，推导出一个关于平衡态最大10米风速 $U_{\\max}$ 的诊断关系式，该关系式用比率 $C_{k}/C_{d}(U_{\\max})$、$T_{s}$、$T_{o}$ 和 $\\left(k_{s}^{\\ast} - k\\right)$ 表示。\n\n现在，通过比较两种参数化方案，评估在极高风速下减小拖曳系数 $C_{d}$ 的效应：\n- 基准方案：对于所有 $U$，$C_{d}(U) = C_{d0} + \\alpha\\, U$，其中 $C_{d0} = 1.5 \\times 10^{-3}$ 且 $\\alpha = 2.0 \\times 10^{-5}$。\n- 高风速拖曳减小方案：$C_{d}(U) = \\min\\!\\left(C_{d0} + \\alpha\\, U,\\, C_{d,\\mathrm{sat}}\\right)$，其中 $C_{d,\\mathrm{sat}} = 2.2 \\times 10^{-3}$。\n\n在最大风速半径处使用以下热力学参数：\n- 海表温度 (SST) $T_{s} = 302\\,\\mathrm{K}$。\n- 出流温度 $T_{o} = 200\\,\\mathrm{K}$。\n- 湿焓不平衡量 $\\left(k_{s}^{\\ast} - k\\right) = 3.0 \\times 10^{4}\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}$。\n- 焓交换系数 $C_{k} = 1.2 \\times 10^{-3}$。\n\n假设平衡态最大风速出现在中性、空气动力学粗糙区，并且为此诊断目的，最大梯度风等于最大10米中性风。\n\n计算比率 $R \\equiv U_{\\max}^{(\\mathrm{sat})} / U_{\\max}^{(\\mathrm{base})}$，其中 $U_{\\max}^{(\\mathrm{sat})}$ 是高风速拖曳减小参数化方案下的平衡态最大风速，$U_{\\max}^{(\\mathrm{base})}$ 是上述基准参数化方案下的平衡态最大风速。将您的最终答案 $R$ 四舍五入到四位有效数字。将您的最终答案表示为一个无量纲数。",
            "solution": "目标是从一个连接边界层耗散和热力学功率的、有物理基础的诊断关系中获得 $U_{\\max}$。出发点是单位表面积的机械耗散率与焓通量提供的卡诺功之间的平衡：\n$$\n\\epsilon\\, Q_{k} = D,\n$$\n其中 $Q_{k} = \\rho\\, C_{k}\\, U\\, \\left(k_{s}^{\\ast} - k\\right)$ 是焓通量，$D$ 是边界层中单位表面积的机械耗散率。在整体空气动力学应力参数化下，单位面积的机械能耗散率为\n$$\nD = \\boldsymbol{\\tau} \\cdot \\boldsymbol{U} = \\rho\\, C_{d}(U)\\, U^{3}.\n$$\n热机的热力学效率是\n$$\n\\epsilon = \\frac{T_{s} - T_{o}}{T_{o}}.\n$$\n令卡诺功功率 $\\epsilon\\, Q_{k}$ 等于 $D$ 可得\n$$\n\\epsilon\\, \\rho\\, C_{k}\\, U\\, \\left(k_{s}^{\\ast} - k\\right) = \\rho\\, C_{d}(U)\\, U^{3}.\n$$\n消去 $\\rho$ 和一个因子 $U$，得到平衡态最大风速的基本诊断关系式：\n$$\nU_{\\max}^{2} = \\frac{C_{k}}{C_{d}(U_{\\max})}\\, \\epsilon\\, \\left(k_{s}^{\\ast} - k\\right).\n$$\n定义热力学因子\n$$\nA \\equiv \\epsilon\\, \\left(k_{s}^{\\ast} - k\\right) = \\frac{T_{s} - T_{o}}{T_{o}}\\, \\left(k_{s}^{\\ast} - k\\right).\n$$\n则\n$$\nU_{\\max}^{2} = \\frac{C_{k}}{C_{d}(U_{\\max})}\\, A.\n$$\n\n对于基准参数化方案 $C_{d}(U) = C_{d0} + \\alpha\\, U$，这是一个关于 $U_{\\max}$ 的隐式方程：\n$$\nU_{\\max}^{2}\\, \\left(C_{d0} + \\alpha\\, U_{\\max}\\right) = C_{k}\\, A,\n$$\n可以写成三次方程\n$$\n\\alpha\\, U_{\\max}^{3} + C_{d0}\\, U_{\\max}^{2} - C_{k}\\, A = 0.\n$$\n对于高风速拖曳减小参数化方案，如果解落在 $C_{d}(U) = C_{d,\\mathrm{sat}}$ 的饱和区，则诊断关系式简化为\n$$\nU_{\\max}^{2} = \\frac{C_{k}}{C_{d,\\mathrm{sat}}}\\, A.\n$$\n自洽性要求所得的 $U_{\\max}$ 超过饱和阈值风速 $U_{t} = \\left(C_{d,\\mathrm{sat}} - C_{d0}\\right)/\\alpha$，我们将在计算出 $U_{\\max}$ 后进行检验。\n\n我们现在计算必要的数值。首先，热力学因子 $A$ 为\n$$\nA = \\frac{T_{s} - T_{o}}{T_{o}}\\, \\left(k_{s}^{\\ast} - k\\right) = \\frac{302 - 200}{200}\\, \\left(3.0 \\times 10^{4}\\right) = 0.51 \\times 3.0 \\times 10^{4} = 1.53 \\times 10^{4}.\n$$\n乘以 $C_{k}$，\n$$\nC_{k}\\, A = \\left(1.2 \\times 10^{-3}\\right)\\, \\left(1.53 \\times 10^{4}\\right) = 18.36.\n$$\n\n高风速拖曳减小情况（饱和）：\n$$\nU_{\\max}^{(\\mathrm{sat})} = \\sqrt{\\frac{C_{k}\\, A}{C_{d,\\mathrm{sat}}}} = \\sqrt{\\frac{18.36}{2.2 \\times 10^{-3}}} = \\sqrt{8345.454545\\ldots}.\n$$\n计算平方根可得\n$$\nU_{\\max}^{(\\mathrm{sat})} \\approx 91.3535.\n$$\n饱和阈值风速为\n$$\nU_{t} = \\frac{C_{d,\\mathrm{sat}} - C_{d0}}{\\alpha} = \\frac{2.2 \\times 10^{-3} - 1.5 \\times 10^{-3}}{2.0 \\times 10^{-5}} = \\frac{0.7 \\times 10^{-3}}{2.0 \\times 10^{-5}} = 35.\n$$\n由于 $91.3535  35$，饱和假设是自洽的。\n\n基准情况（非饱和，对所有 $U$ 均为线性 $C_{d}(U)$）：求解\n$$\n\\left(2.0 \\times 10^{-5}\\right)\\, U^{3} + \\left(1.5 \\times 10^{-3}\\right)\\, U^{2} - 18.36 = 0.\n$$\n这个三次方程对于 $U$ 有一个物理上相关的正根。通过区间限定和迭代优化可得\n$$\nU_{\\max}^{(\\mathrm{base})} \\approx 77.5418.\n$$\n这个解在残差上满足三次方程，精度在 $\\mathcal{O}\\!\\left(10^{-4}\\right)$ 以内，对于计算四位有效数字的比率来说已经足够。\n\n最后，计算比率\n$$\nR \\equiv \\frac{U_{\\max}^{(\\mathrm{sat})}}{U_{\\max}^{(\\mathrm{base})}} \\approx \\frac{91.3535}{77.5418} \\approx 1.17812.\n$$\n四舍五入到四位有效数字，\n$$\nR \\approx 1.178.\n$$\n\n对边界层结构的解释：在一个深度为 $h$、科里奥利参数为 $f$ 的稳态平板边界层中，入流角 $\\delta$ 的一个简单诊断关系是 $\\delta \\approx \\arctan\\!\\left(\\frac{C_{d}\\, U}{h\\, f}\\right)$，这表明在固定的 $U$ 下，减小 $C_{d}$ 会减小 $\\delta$（转向更急）。在本问题中，饱和状态下 $C_{d}$ 的减小会增加 $U$，同时限制了 $C_{d}$ 的上限，因此对 $\\delta$ 的净效应取决于乘积 $C_{d}\\, U$。计算出的比率 $R  1$ 量化了在指定热力学约束下，由于高风速时 $C_{d}$ 减小而导致的最大风速增加量。",
            "answer": "$$\\boxed{1.178}$$"
        },
        {
            "introduction": "从理论模型到业务化预报，我们面临着巨大的挑战，其中之一便是准确预测热带气旋的快速增强（Rapid Intensification, RI）。这项练习将带您进入现代天气预报的实践前沿，模拟一个真实的预报场景。您将利用一个统计模型和集合预报数据，来生成关于RI事件的概率预报，切身体会如何量化预报的不确定性，以及如何将原始的模式输出转化为具有决策价值的概率性指导信息。",
            "id": "4106217",
            "problem": "给定一个用于热带气旋在 $48$ 小时内快速增强 (RI) 的二元事件模型。事件指示器 $Y$ 在 $48$ 小时内发生 RI 时等于 $1$，否则为 $0$。假设如下：\n\n- 给定预测变量 $\\mathbf{x} \\in \\mathbb{R}^d$，$Y=1$ 的条件概率由带有逻辑斯谛联结函数的伯努利分布建模。具体来说，使用训练时均值 $\\boldsymbol{\\mu}$ 和标准差 $\\boldsymbol{\\sigma}$ 从原始预测变量 $\\mathbf{x}$ 形成标准化预测变量 $\\mathbf{z}$，线性预测器为\n$$\\eta = \\beta_0 + \\sum_{j=1}^{d} \\beta_j z_j,$$\n其中\n$$z_j = \\frac{x_j - \\mu_j}{\\sigma_j}。$$\n事件概率为\n$$p = \\mathbb{P}(Y=1 \\mid \\mathbf{x}) = \\frac{1}{1 + e^{-\\eta}}。$$\n\n- 对于每个情景（测试用例），您会得到一个包含 $M$ 个成员的集合。每个成员 $k \\in \\{1,\\dots,M\\}$ 提供一个包含 $d$ 个预测变量的向量 $\\mathbf{x}^{(k)}$，假设这些成员在给定环境下是条件独立的。对于每个成员，通过上述模型计算 $p^{(k)}$。\n\n- 从集合成员概率 $\\{p^{(k)}\\}_{k=1}^{M}$ 中，计算以下三个集合摘要诊断：\n    1. 集合平均概率：\n    $$\\bar{p} = \\frac{1}{M} \\sum_{k=1}^{M} p^{(k)}。$$\n    2. 在条件独立假设下，至少有一个成员在 $48$ 小时内经历 RI 的概率：\n    $$p_{\\mathrm{any}} = 1 - \\prod_{k=1}^{M} \\left(1 - p^{(k)}\\right)。$$\n    3. 个体概率达到或超过决策阈值 $\\tau$ 的成员比例：\n    $$f_{\\ge \\tau} = \\frac{1}{M} \\sum_{k=1}^{M} \\mathbf{1}\\left(p^{(k)} \\ge \\tau\\right)。$$\n\n使用以下在大型代表性数据集上训练的固定模型规格：\n\n- 预测变量维度 $d = 6$，包含以下分量和单位：\n    1. 海面温度 (开尔文): $x_1$ 单位 $\\mathrm{K}$。\n    2. $200$–$850$ hPa 深层垂直风切变 (米/秒): $x_2$ 单位 $\\mathrm{m\\,s^{-1}}$。\n    3. $600$ hPa 中层相对湿度 (无单位分数，范围在 $[0,1]$): $x_3$ 单位 $\\text{fraction}$。\n    4. 前 $24$ 小时强度变化 (米/秒): $x_4$ 单位 $\\mathrm{m\\,s^{-1}}$。\n    5. 潜在强度差，定义为 (最大潜在强度减去当前最大持续风速) (米/秒): $x_5$ 单位 $\\mathrm{m\\,s^{-1}}$。\n    6. 上层海洋热含量，对顶层海洋积分 (焦耳/平方米): $x_6$ 单位 $\\mathrm{J\\,m^{-2}}$。\n\n- 标准化参数 (训练均值 $\\boldsymbol{\\mu}$ 和标准差 $\\boldsymbol{\\sigma}$):\n$$\\boldsymbol{\\mu} = \\left[300.0,\\, 10.0,\\, 0.6,\\, 0.0,\\, 10.0,\\, 3.0\\times 10^9\\right],$$\n$$\\boldsymbol{\\sigma} = \\left[1.5,\\, 6.0,\\, 0.15,\\, 3.0,\\, 6.0,\\, 1.5\\times 10^9\\right].$$\n\n- Logistic 回归系数 (截距后跟特征权重):\n$$\\beta_0 = -2.0,$$\n$$(\\beta_1, \\beta_2, \\beta_3, \\beta_4, \\beta_5, \\beta_6) = (0.8,\\, -1.0,\\, 0.7,\\, 0.5,\\, 0.6,\\, 0.4)。$$\n\n- 成员级分类的决策阈值：\n$$\\tau = 0.5。$$\n\n测试用例。对于下面的每个测试用例，给定一个包含 $M=5$ 个成员的集合。对于每个成员，向量 $(x_1, x_2, x_3, x_4, x_5, x_6)$ 以以上单位提供。您的任务是计算 $(\\bar{p}, p_{\\mathrm{any}}, f_{\\ge \\tau})$。这些输出是无量纲的，必须表示为小数，而不是百分比。\n\n- 测试用例 1 (中等有利环境)：\n    - 成员 1：$(301.0,\\, 8.0,\\, 0.65,\\, 1.0,\\, 12.0,\\, 4.0\\times 10^9)$\n    - 成员 2：$(300.5,\\, 9.0,\\, 0.62,\\, 0.0,\\, 11.0,\\, 3.2\\times 10^9)$\n    - 成员 3：$(301.5,\\, 7.0,\\, 0.68,\\, 2.0,\\, 13.0,\\, 4.5\\times 10^9)$\n    - 成员 4：$(299.8,\\, 10.5,\\, 0.58,\\, -1.0,\\, 9.0,\\, 2.8\\times 10^9)$\n    - 成员 5：$(300.2,\\, 8.5,\\, 0.63,\\, 0.5,\\, 10.0,\\, 3.6\\times 10^9)$\n\n- 测试用例 2 (高度有利环境)：\n    - 成员 1：$(302.0,\\, 5.0,\\, 0.80,\\, 4.0,\\, 20.0,\\, 6.5\\times 10^9)$\n    - 成员 2：$(302.8,\\, 3.5,\\, 0.85,\\, 5.0,\\, 25.0,\\, 8.0\\times 10^9)$\n    - 成员 3：$(301.8,\\, 4.5,\\, 0.78,\\, 3.0,\\, 18.0,\\, 6.0\\times 10^9)$\n    - 成员 4：$(303.0,\\, 4.0,\\, 0.82,\\, 4.5,\\, 22.0,\\, 7.5\\times 10^9)$\n    - 成员 5：$(302.5,\\, 5.5,\\, 0.76,\\, 3.5,\\, 19.0,\\, 6.8\\times 10^9)$\n\n- 测试用例 3 (恶劣环境)：\n    - 成员 1：$(298.5,\\, 22.0,\\, 0.50,\\, -2.0,\\, 7.0,\\, 1.8\\times 10^9)$\n    - 成员 2：$(299.0,\\, 24.0,\\, 0.52,\\, -3.0,\\, 6.0,\\, 1.5\\times 10^9)$\n    - 成员 3：$(297.8,\\, 28.0,\\, 0.45,\\, -1.0,\\, 5.0,\\, 1.2\\times 10^9)$\n    - 成员 4：$(298.8,\\, 20.0,\\, 0.55,\\, 0.0,\\, 8.0,\\, 2.0\\times 10^9)$\n    - 成员 5：$(299.5,\\, 18.0,\\, 0.58,\\, -0.5,\\, 9.0,\\, 2.2\\times 10^9)$\n\n实现细节：\n\n- 对每个集合成员，使用提供的 $\\boldsymbol{\\mu}$ 和 $\\boldsymbol{\\sigma}$ 标准化每个预测变量，计算 $\\eta$，然后通过 logistic 函数计算 $p$。在适当情况下，使用数值稳定的 logistic 函数评估方法。\n- 对每个 $M=5$ 的测试用例，按上述定义计算 $\\bar{p}$、$p_{\\mathrm{any}}$ 和 $f_{\\ge \\tau}$。\n- 输出没有物理单位，必须以小数形式呈现，四舍五入到小数点后恰好 $6$ 位。\n- 最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个元素对应一个测试用例，并且本身是三个浮点数 $[\\bar{p}, p_{\\mathrm{any}}, f_{\\ge \\tau}]$ 的列表。例如：$[[a_1,b_1,c_1],[a_2,b_2,c_2],[a_3,b_3,c_3]]$，其中每个 $a_i,b_i,c_i$ 都四舍五入到 $6$ 位小数。",
            "solution": "解决方案首先实现给定的统计模型，为集合中的每个单独成员计算 RI 概率。随后，将这些个体概率聚合起来，为每个测试用例计算三个指定的集合摘要诊断。\n\n基础模型是一个 logistic 回归模型，用于建模二元结果的概率。事件 $Y=1$ 表示在 $48$ 小时窗口内发生 RI。此事件的概率 $p = \\mathbb{P}(Y=1 \\mid \\mathbf{x})$，是条件于一个包含 $d=6$ 个大气和海洋预测变量的向量 $\\mathbf{x} = (x_1, \\dots, x_6)$。\n\n首先，将原始预测变量 $\\mathbf{x}$ 标准化为 $\\mathbf{z}$，以确保它们处于可比较的尺度上，这是机器学习中的常见做法。标准化过程对每个预测变量 $j$ 使用训练数据集的均值 $\\mu_j$ 和标准差 $\\sigma_j$：\n$$z_j = \\frac{x_j - \\mu_j}{\\sigma_j}$$\n问题提供了向量 $\\boldsymbol{\\mu} = [\\mu_1, \\dots, \\mu_6]$ 和 $\\boldsymbol{\\sigma} = [\\sigma_1, \\dots, \\sigma_6]$。\n\n接下来，形成这些标准化预测变量的线性组合。这就是线性预测器 $\\eta$：\n$$\\eta = \\beta_0 + \\sum_{j=1}^{d} \\beta_j z_j = \\beta_0 + \\boldsymbol{\\beta} \\cdot \\mathbf{z}$$\n其中 $\\beta_0$ 是截距 (偏差)，$\\boldsymbol{\\beta} = (\\beta_1, \\dots, \\beta_6)$ 是系数 (权重) 向量。问题提供了这些系数。每个 $\\beta_j$ 的符号表示预测变量 $z_j$ 与 RI 的对数几率之间的关系方向。例如，垂直风切变的负系数 ($\\beta_2 = -1.0$) 正确地反映了增加的风切变对增强是不利的。\n\n然后使用 logistic (或 sigmoid) 函数将线性预测器 $\\eta$ 转换为范围在 $[0, 1]$ 内的概率 $p$：\n$$p = \\frac{1}{1 + e^{-\\eta}}$$\n\n对于每个测试用例，给定一个包含 $M=5$ 个成员的集合。对于每个成员 $k \\in \\{1, \\dots, M\\}$，我们得到一个预测向量 $\\mathbf{x}^{(k)}$。我们应用上述三个步骤来为每个成员计算 RI 概率 $p^{(k)}$。\n\n在获得集合的概率集 $\\{p^{(k)}\\}_{k=1}^{M}$ 之后，我们计算三个所需的摘要诊断：\n\n1.  集合平均概率 $\\bar{p}$。这代表了 RI 的期望概率，是在集合所代表的不确定性上取平均值。\n    $$\\bar{p} = \\frac{1}{M} \\sum_{k=1}^{M} p^{(k)}$$\n\n2.  至少有一个成员预报 RI 的概率 $p_{\\mathrm{any}}$。在所述的集合成员条件独立的假设下 (即，在给定其特定大气状态的情况下，每个成员的 RI 结果是一个独立事件)，*没有*成员经历 RI 的概率是每个成员*不*经历 RI 的个体概率的乘积，即 $\\prod_{k=1}^{M} (1 - p^{(k)})$。至少有一个成员经历 RI 的概率是该事件的补集。\n    $$p_{\\mathrm{any}} = 1 - \\prod_{k=1}^{M} \\left(1 - p^{(k)}\\right)$$\n\n3.  个体概率达到或超过决策阈值 $\\tau=0.5$ 的成员比例，表示为 $f_{\\ge \\tau}$。这是衡量集合内部对于高概率事件共识的一个简单度量。指示函数 $\\mathbf{1}(A)$ 在条件 $A$ 为真时为 $1$，否则为 $0$。\n    $$f_{\\ge \\tau} = \\frac{1}{M} \\sum_{k=1}^{M} \\mathbf{1}\\left(p^{(k)} \\ge \\tau\\right)$$\n\n算法实现如下：对于三个测试用例中的每一个，我们遍历其 $M=5$ 个成员。对于每个成员的预测向量 $\\mathbf{x}^{(k)}$，我们计算标准化向量 $\\mathbf{z}^{(k)}$，然后是线性预测器 $\\eta^{(k)}$，最后是概率 $p^{(k)}$。这五个概率被存储起来。从这个概率集合中，计算出 $\\bar{p}$、$p_{\\mathrm{any}}$ 和 $f_{\\ge \\tau}$。数值计算使用 `numpy` 库进行高效的向量化操作。最后，每个诊断的结果被格式化为精确到 $6$ 位小数的十进制数，并构造最终的输出字符串以匹配指定格式 `[[a_1,b_1,c_1],[a_2,b_2,c_2],[a_3,b_3,c_3]]`。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes ensemble diagnostics for a tropical cyclone rapid intensification model.\n    \"\"\"\n    # Define the fixed model specification.\n    # Training means for standardization.\n    mu = np.array([300.0, 10.0, 0.6, 0.0, 10.0, 3.0e9])\n    # Training standard deviations for standardization.\n    sigma = np.array([1.5, 6.0, 0.15, 3.0, 6.0, 1.5e9])\n    # Logistic regression intercept.\n    beta0 = -2.0\n    # Logistic regression coefficients for the 6 predictors.\n    betas = np.array([0.8, -1.0, 0.7, 0.5, 0.6, 0.4])\n    # Decision threshold for member-level classification.\n    tau = 0.5\n\n    # Define the test cases, each with an ensemble of M=5 members.\n    test_cases = [\n        # Test case 1 (moderately favorable environment)\n        [\n            [301.0, 8.0, 0.65, 1.0, 12.0, 4.0e9],\n            [300.5, 9.0, 0.62, 0.0, 11.0, 3.2e9],\n            [301.5, 7.0, 0.68, 2.0, 13.0, 4.5e9],\n            [299.8, 10.5, 0.58, -1.0, 9.0, 2.8e9],\n            [300.2, 8.5, 0.63, 0.5, 10.0, 3.6e9]\n        ],\n        # Test case 2 (highly favorable environment)\n        [\n            [302.0, 5.0, 0.80, 4.0, 20.0, 6.5e9],\n            [302.8, 3.5, 0.85, 5.0, 25.0, 8.0e9],\n            [301.8, 4.5, 0.78, 3.0, 18.0, 6.0e9],\n            [303.0, 4.0, 0.82, 4.5, 22.0, 7.5e9],\n            [302.5, 5.5, 0.76, 3.5, 19.0, 6.8e9]\n        ],\n        # Test case 3 (hostile environment)\n        [\n            [298.5, 22.0, 0.50, -2.0, 7.0, 1.8e9],\n            [299.0, 24.0, 0.52, -3.0, 6.0, 1.5e9],\n            [297.8, 28.0, 0.45, -1.0, 5.0, 1.2e9],\n            [298.8, 20.0, 0.55, 0.0, 8.0, 2.0e9],\n            [299.5, 18.0, 0.58, -0.5, 9.0, 2.2e9]\n        ]\n    ]\n\n    all_case_results = []\n    \n    for ensemble_data in test_cases:\n        M = float(len(ensemble_data))\n        member_probabilities = []\n        \n        for member_x_list in ensemble_data:\n            x = np.array(member_x_list, dtype=np.float64)\n            \n            # Standardize predictors using the provided means and standard deviations.\n            z = (x - mu) / sigma\n            \n            # Compute the linear predictor eta.\n            eta = beta0 + np.dot(z, betas)\n            \n            # Compute the probability p using the logistic function.\n            p = 1.0 / (1.0 + np.exp(-eta))\n            member_probabilities.append(p)\n        \n        p_k = np.array(member_probabilities, dtype=np.float64)\n        \n        # 1. Compute the ensemble-mean probability.\n        p_bar = np.mean(p_k)\n        \n        # 2. Compute the probability of at least one member experiencing RI.\n        p_any = 1.0 - np.prod(1.0 - p_k)\n        \n        # 3. Compute the fraction of members with probability at or above the threshold.\n        f_ge_tau = np.sum(p_k = tau) / M\n        \n        all_case_results.append((p_bar, p_any, f_ge_tau))\n\n    # Format the results into the required string format with 6 decimal places.\n    result_strings = []\n    for result_tuple in all_case_results:\n        p_bar_str = f\"{result_tuple[0]:.6f}\"\n        p_any_str = f\"{result_tuple[1]:.6f}\"\n        f_ge_tau_str = f\"{result_tuple[2]:.6f}\"\n        result_strings.append(f\"[{p_bar_str},{p_any_str},{f_ge_tau_str}]\")\n    \n    final_output = f\"[{','.join(result_strings)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}