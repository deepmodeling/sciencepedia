{
    "hands_on_practices": [
        {
            "introduction": "Parametric models provide a powerful yet simple way to describe the essential structure of a tropical cyclone. This first practice explores the widely-used Holland model for the surface pressure field. By applying the fundamental principle of gradient wind balance, you will derive the direct relationship between the storm's central pressure and its maximum wind speed, a cornerstone of diagnostic analysis for hurricane intensity. ",
            "id": "4106241",
            "problem": "Consider an idealized, axisymmetric tropical cyclone in steady, frictionless balance on an $f$-plane, where the tangential wind $V_{t}(r)$ satisfies the gradient wind balance derived from the radial momentum equation. The Holland parametric pressure profile represents the sea-level pressure $p(r)$ as\n$$\np(r) = p_{c} + \\left(p_{e} - p_{c}\\right)\\exp\\!\\left(-\\left(\\frac{R_{m}}{r}\\right)^{B}\\right),\n$$\nwhere $p_{c}$ is the central pressure, $p_{e}$ is the environmental pressure, $R_{m}$ is the Radius of Maximum Wind (RMW), and $B$ is a dimensionless shape parameter. Starting from the gradient wind balance and the given pressure profile, derive the explicit relationship between $V_{t}(r)$ and the radial pressure gradient $\\partial p/\\partial r$. Then specialize your result at $r = R_{m}$ to obtain $p_{c}$ in terms of $V_{\\max} = V_{t}(R_{m})$, $B$, $f$, $R_{m}$, $\\rho$, and $p_{e}$, where $\\rho$ is the air density and $f$ is the Coriolis parameter.\n\nUse the following scientifically realistic values: $V_{\\max} = 60\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$, $B = 1.5$, $R_{m} = 30\\,\\mathrm{km}$, $f = 5.0\\times 10^{-5}\\,\\mathrm{s}^{-1}$, $\\rho = 1.15\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, and $p_{e} = 1010\\,\\mathrm{hPa}$. Compute the numerical value of $p_{c}$ based on your derived expression. Express the final central pressure in hectopascals (hPa) and round your answer to four significant figures. Assume the maximum tangential wind occurs at $r=R_{m}$ in the sense of the gradient wind, consistent with the Holland model’s use of $R_{m}$ as the RMW.",
            "solution": "The problem will be validated before a solution is attempted.\n\n### Step 1: Extract Givens\nThe problem provides the following information:\n1.  An idealized, axisymmetric tropical cyclone in steady, frictionless, gradient wind balance.\n2.  The setting is an $f$-plane, with Coriolis parameter $f$.\n3.  The sea-level pressure profile is given by the Holland model:\n    $$p(r) = p_{c} + \\left(p_{e} - p_{c}\\right)\\exp\\!\\left(-\\left(\\frac{R_{m}}{r}\\right)^{B}\\right)$$\n    where $p(r)$ is the pressure at radius $r$, $p_c$ is the central pressure, $p_e$ is the environmental pressure, $R_m$ is the Radius of Maximum Wind (RMW), and $B$ is a dimensionless shape parameter.\n4.  The tangential wind is denoted by $V_t(r)$.\n5.  Air density $\\rho$ is assumed constant.\n6.  The maximum tangential wind is $V_{\\max} = V_t(R_m)$.\n7.  The problem assumes the maximum tangential wind occurs at $r=R_m$ in the sense of the gradient wind.\n8.  Numerical values are provided: $V_{\\max} = 60\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$, $B = 1.5$, $R_{m} = 30\\,\\mathrm{km}$, $f = 5.0\\times 10^{-5}\\,\\mathrm{s}^{-1}$, $\\rho = 1.15\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, and $p_{e} = 1010\\,\\mathrm{hPa}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the validation criteria.\n\n-   **Scientifically Grounded**: The problem is firmly rooted in the principles of geophysical fluid dynamics, specifically the dynamics of tropical cyclones. The gradient wind balance is a standard and fundamental approximation for the radial momentum equation in rotating flows. The Holland pressure profile is a widely used and empirically validated parametric model for the surface pressure field in hurricanes. All concepts are standard within atmospheric science. The provided numerical values are physically realistic for a major tropical cyclone.\n-   **Well-Posed**: The problem is well-defined. It provides a clear set of governing equations and assumptions and asks for a specific derivation and a subsequent numerical calculation. All necessary parameters and constants are provided. The assumption that the maximum wind speed occurs at $r=R_m$ simplifies the problem and ensures a unique solution can be found without requiring a more complex extremum analysis.\n-   **Objective**: The problem is stated in precise, quantitative, and unbiased language. It is free from any subjective or speculative content.\n\n### Step 3: Verdict and Action\nThe problem is found to be valid. It is scientifically sound, well-posed, and objective. A solution will be provided.\n\n---\n\nThe radial momentum equation for an axisymmetric, steady, frictionless flow on an $f$-plane, expressed in cylindrical coordinates $(r, \\theta, z)$, is the gradient wind balance equation:\n$$\n\\frac{1}{\\rho}\\frac{\\partial p}{\\partial r} = \\frac{V_{t}^{2}}{r} + fV_{t}\n$$\nHere, $\\frac{\\partial p}{\\partial r}$ is the radial pressure gradient force, $\\frac{V_t^2}{r}$ is the centrifugal acceleration, and $fV_t$ is the Coriolis acceleration.\n\nThe first task is to derive the explicit relationship between $V_t(r)$ and the radial pressure gradient $\\frac{\\partial p}{\\partial r}$. We can rearrange the gradient wind balance equation into a quadratic equation for $V_t$:\n$$\n\\frac{V_{t}^{2}}{r} + fV_{t} - \\frac{1}{\\rho}\\frac{\\partial p}{\\partial r} = 0\n$$\nMultiplying by $r$ gives:\n$$\nV_{t}^{2} + (fr)V_{t} - \\frac{r}{\\rho}\\frac{\\partial p}{\\partial r} = 0\n$$\nUsing the quadratic formula $V_t = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ with $a=1$, $b=fr$, and $c = -\\frac{r}{\\rho}\\frac{\\partial p}{\\partial r}$, we obtain:\n$$\nV_{t}(r) = \\frac{-fr \\pm \\sqrt{(fr)^{2} + \\frac{4r}{\\rho}\\frac{\\partial p}{\\partial r}}}{2}\n$$\nFor a tropical cyclone (a low-pressure center), the pressure increases with radius, so $\\frac{\\partial p}{\\partial r}  0$. In the Northern Hemisphere, $f  0$, and by convention, the cyclonic tangential wind speed $V_t$ is positive. The term under the square root is $\\sqrt{(fr)^2 + \\text{positive term}}  \\sqrt{(fr)^2} = fr$. To ensure $V_t  0$, we must choose the positive root. Thus, the explicit relationship is:\n$$\nV_{t}(r) = \\frac{-fr + \\sqrt{(fr)^2 + \\frac{4r}{\\rho}\\frac{\\partial p}{\\partial r}}}{2}\n$$\nThe second task is to find an expression for the central pressure $p_c$. We begin by calculating the pressure gradient, $\\frac{\\partial p}{\\partial r}$, from the Holland profile:\n$$\np(r) = p_{c} + \\left(p_{e} - p_{c}\\right)\\exp\\!\\left(-\\left(\\frac{R_{m}}{r}\\right)^{B}\\right)\n$$\nDifferentiating with respect to $r$ using the chain rule:\n$$\n\\frac{\\partial p}{\\partial r} = (p_{e} - p_{c}) \\cdot \\frac{d}{dr} \\left[ \\exp\\left(-R_{m}^{B}r^{-B}\\right) \\right]\n$$\n$$\n\\frac{\\partial p}{\\partial r} = (p_{e} - p_{c}) \\cdot \\exp\\left(-R_{m}^{B}r^{-B}\\right) \\cdot (-R_{m}^{B})(-B r^{-B-1})\n$$\n$$\n\\frac{\\partial p}{\\partial r} = (p_{e} - p_{c}) \\frac{B R_{m}^{B}}{r^{B+1}} \\exp\\left(-\\left(\\frac{R_{m}}{r}\\right)^{B}\\right)\n$$\nThe problem states that the maximum wind speed, $V_{\\max}$, occurs at the radius of maximum winds, $r=R_m$. We evaluate the pressure gradient at this radius:\n$$\n\\left.\\frac{\\partial p}{\\partial r}\\right|_{r=R_{m}} = (p_{e} - p_{c}) \\frac{B R_{m}^{B}}{R_{m}^{B+1}} \\exp\\left(-\\left(\\frac{R_{m}}{R_{m}}\\right)^{B}\\right) = (p_{e} - p_{c}) \\frac{B}{R_{m}} \\exp(-1)\n$$\nSo,\n$$\n\\left.\\frac{\\partial p}{\\partial r}\\right|_{r=R_{m}} = \\frac{B(p_{e} - p_{c})}{e R_{m}}\n$$\nwhere $e$ is Euler's number.\n\nNow, we evaluate the gradient wind balance equation at $r=R_m$, where $V_t=V_{\\max}$:\n$$\n\\left.\\frac{1}{\\rho}\\frac{\\partial p}{\\partial r}\\right|_{r=R_{m}} = \\frac{V_{\\max}^{2}}{R_{m}} + fV_{\\max}\n$$\n$$\n\\left.\\frac{\\partial p}{\\partial r}\\right|_{r=R_{m}} = \\rho\\left(\\frac{V_{\\max}^{2}}{R_{m}} + fV_{\\max}\\right)\n$$\nEquating the two expressions for the pressure gradient at $r=R_m$:\n$$\n\\frac{B(p_{e} - p_{c})}{e R_{m}} = \\rho\\left(\\frac{V_{\\max}^{2}}{R_{m}} + fV_{\\max}\\right)\n$$\nWe now solve for $p_c$. First, isolate the term $(p_e - p_c)$:\n$$\np_{e} - p_{c} = \\frac{e R_{m} \\rho}{B} \\left(\\frac{V_{\\max}^{2}}{R_{m}} + fV_{\\max}\\right)\n$$\n$$\np_{e} - p_{c} = \\frac{e\\rho}{B} (V_{\\max}^{2} + f R_{m} V_{\\max})\n$$\nFinally, solving for $p_c$:\n$$\np_{c} = p_{e} - \\frac{e\\rho}{B} (V_{\\max}^{2} + f R_{m} V_{\\max})\n$$\nThis is the desired expression for $p_c$.\n\nNow, we compute the numerical value of $p_c$ using the provided constants. All values must be in base SI units (meters, kilograms, seconds, Pascals).\n-   $V_{\\max} = 60\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$\n-   $B = 1.5$\n-   $R_{m} = 30\\,\\mathrm{km} = 30 \\times 10^{3}\\,\\mathrm{m}$\n-   $f = 5.0\\times 10^{-5}\\,\\mathrm{s}^{-1}$\n-   $\\rho = 1.15\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$\n-   $p_{e} = 1010\\,\\mathrm{hPa} = 1010 \\times 100\\,\\mathrm{Pa} = 101000\\,\\mathrm{Pa}$\n-   $e \\approx 2.71828$\n\nFirst, compute the term in the parentheses:\n$$\nV_{\\max}^{2} = (60\\,\\mathrm{m}\\,\\mathrm{s}^{-1})^{2} = 3600\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-2}\n$$\n$$\nf R_{m} V_{\\max} = (5.0\\times 10^{-5}\\,\\mathrm{s}^{-1}) \\cdot (30 \\times 10^{3}\\,\\mathrm{m}) \\cdot (60\\,\\mathrm{m}\\,\\mathrm{s}^{-1}) = 90\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-2}\n$$\n$$\nV_{\\max}^{2} + f R_{m} V_{\\max} = 3600 + 90 = 3690\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-2}\n$$\nNow, compute the pressure drop term $\\Delta p = \\frac{e\\rho}{B} (V_{\\max}^{2} + f R_{m} V_{\\max})$:\n$$\n\\Delta p = \\frac{e \\cdot (1.15\\,\\mathrm{kg}\\,\\mathrm{m}^{-3})}{1.5} \\cdot (3690\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-2})\n$$\n$$\n\\Delta p \\approx \\frac{2.71828 \\cdot 1.15}{1.5} \\cdot 3690 \\,\\mathrm{Pa} \\approx 2.084015 \\cdot 3690 \\,\\mathrm{Pa} \\approx 7690.015\\,\\mathrm{Pa}\n$$\nFinally, calculate $p_c$:\n$$\np_c = p_e - \\Delta p = 101000\\,\\mathrm{Pa} - 7690.015\\,\\mathrm{Pa} = 93309.985\\,\\mathrm{Pa}\n$$\nThe problem requires the answer in hectopascals (hPa), rounded to four significant figures.\n$$\np_c = \\frac{93309.985}{100}\\,\\mathrm{hPa} = 933.09985\\,\\mathrm{hPa}\n$$\nRounding to four significant figures gives:\n$$\np_c \\approx 933.1\\,\\mathrm{hPa}\n$$",
            "answer": "$$\n\\boxed{933.1}\n$$"
        },
        {
            "introduction": "Beyond its static structure, a tropical cyclone is a powerful thermodynamic heat engine, converting heat from the warm ocean into kinetic energy. This exercise delves into the theory of maximum potential intensity by balancing the energy generated by surface enthalpy fluxes with the energy lost to frictional dissipation. You will investigate how crucial parameterizations, such as the air-sea drag coefficient $C_{d}$ at high wind speeds, can dramatically alter a storm's theoretical intensity limit. ",
            "id": "4106233",
            "problem": "Consider an axisymmetric, steady tropical cyclone over a horizontally uniform ocean, analyzed with a bulk-aerodynamic slab boundary layer model. Assume the following foundational elements, which are standard in numerical weather prediction and climate modeling of tropical cyclone boundary layers:\n- The surface momentum flux (stress) is parameterized as $\\boldsymbol{\\tau} = \\rho\\, C_{d}(U)\\, U\\, \\boldsymbol{U}$, where $\\rho$ is air density, $U$ is the 10 m neutral wind speed magnitude, and $C_{d}(U)$ is the drag coefficient.\n- The surface enthalpy flux is $Q_{k} = \\rho\\, C_{k}\\, U\\, \\left(k_{s}^{\\ast} - k\\right)$, where $C_{k}$ is the enthalpy exchange coefficient, $k_{s}^{\\ast}$ is the saturated moist enthalpy at sea surface temperature, and $k$ is the boundary layer moist enthalpy.\n- The thermodynamic efficiency of the hurricane heat engine is $\\epsilon = \\left(T_{s} - T_{o}\\right)/T_{o}$, where $T_{s}$ is the sea surface temperature and $T_{o}$ is a representative outflow temperature in the upper troposphere.\n\nUnder the assumption that the maximum wind is set by the balance between the mechanical dissipation in the boundary layer and the Carnot work generated by enthalpy fluxes, derive, from first principles using the above elements, a diagnostic relation for the equilibrium maximum 10 m wind speed $U_{\\max}$ in terms of the ratio $C_{k}/C_{d}(U_{\\max})$, $T_{s}$, $T_{o}$, and $\\left(k_{s}^{\\ast} - k\\right)$.\n\nNow evaluate the effect of reducing the drag coefficient $C_{d}$ at very high wind speeds by comparing two parameterizations:\n- Baseline: $C_{d}(U) = C_{d0} + \\alpha\\, U$ for all $U$, with $C_{d0} = 1.5 \\times 10^{-3}$ and $\\alpha = 2.0 \\times 10^{-5}$.\n- Reduced high-wind drag: $C_{d}(U) = \\min\\!\\left(C_{d0} + \\alpha\\, U,\\, C_{d,\\mathrm{sat}}\\right)$ with $C_{d,\\mathrm{sat}} = 2.2 \\times 10^{-3}$.\n\nUse the following thermodynamic parameters at the radius of maximum wind:\n- Sea Surface Temperature (SST) $T_{s} = 302\\,\\mathrm{K}$.\n- Outflow temperature $T_{o} = 200\\,\\mathrm{K}$.\n- Moist enthalpy disequilibrium $\\left(k_{s}^{\\ast} - k\\right) = 3.0 \\times 10^{4}\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}$.\n- Enthalpy exchange coefficient $C_{k} = 1.2 \\times 10^{-3}$.\n\nAssume that the equilibrium maximum wind occurs in the neutral, aerodynamically rough regime, and that the maximum gradient wind is equal to the maximum 10 m neutral wind for the purpose of this diagnostic.\n\nCompute the ratio $R \\equiv U_{\\max}^{(\\mathrm{sat})} / U_{\\max}^{(\\mathrm{base})}$, where $U_{\\max}^{(\\mathrm{sat})}$ is the equilibrium maximum wind under the reduced high-wind drag parameterization, and $U_{\\max}^{(\\mathrm{base})}$ is the equilibrium maximum wind under the baseline parameterization described above. Round your final answer for $R$ to four significant figures. Express your final answer as a dimensionless number.",
            "solution": "The goal is to obtain $U_{\\max}$ from a physically grounded diagnostic that connects boundary layer dissipation and thermodynamic power. The starting point is the balance between the mechanical dissipation rate per unit surface area and the Carnot work supplied by the enthalpy flux:\n$$\n\\epsilon\\, Q_{k} = D,\n$$\nwhere $Q_{k} = \\rho\\, C_{k}\\, U\\, \\left(k_{s}^{\\ast} - k\\right)$ is the enthalpy flux and $D$ is the mechanical dissipation rate per unit surface area in the boundary layer. Under the bulk-aerodynamic stress parameterization, the rate of mechanical energy dissipation per unit area is\n$$\nD = \\boldsymbol{\\tau} \\cdot \\boldsymbol{U} = \\rho\\, C_{d}(U)\\, U^{3}.\n$$\nThe thermodynamic efficiency of the heat engine is\n$$\n\\epsilon = \\frac{T_{s} - T_{o}}{T_{o}}.\n$$\nEquating the Carnot work rate $\\epsilon\\, Q_{k}$ to $D$ gives\n$$\n\\epsilon\\, \\rho\\, C_{k}\\, U\\, \\left(k_{s}^{\\ast} - k\\right) = \\rho\\, C_{d}(U)\\, U^{3}.\n$$\nCanceling $\\rho$ and one factor of $U$ yields the fundamental diagnostic for the equilibrium maximum wind:\n$$\nU_{\\max}^{2} = \\frac{C_{k}}{C_{d}(U_{\\max})}\\, \\epsilon\\, \\left(k_{s}^{\\ast} - k\\right).\n$$\nDefine the thermodynamic factor\n$$\nA \\equiv \\epsilon\\, \\left(k_{s}^{\\ast} - k\\right) = \\frac{T_{s} - T_{o}}{T_{o}}\\, \\left(k_{s}^{\\ast} - k\\right).\n$$\nThen\n$$\nU_{\\max}^{2} = \\frac{C_{k}}{C_{d}(U_{\\max})}\\, A.\n$$\n\nFor the baseline parameterization $C_{d}(U) = C_{d0} + \\alpha\\, U$, this is an implicit equation for $U_{\\max}$:\n$$\nU_{\\max}^{2}\\, \\left(C_{d0} + \\alpha\\, U_{\\max}\\right) = C_{k}\\, A,\n$$\nwhich can be written as the cubic equation\n$$\n\\alpha\\, U_{\\max}^{3} + C_{d0}\\, U_{\\max}^{2} - C_{k}\\, A = 0.\n$$\nFor the reduced high-wind drag parameterization, if the solution falls in the saturated regime where $C_{d}(U) = C_{d,\\mathrm{sat}}$, the diagnostic simplifies to\n$$\nU_{\\max}^{2} = \\frac{C_{k}}{C_{d,\\mathrm{sat}}}\\, A.\n$$\nSelf-consistency requires that the resulting $U_{\\max}$ exceed the saturation threshold speed $U_{t} = \\left(C_{d,\\mathrm{sat}} - C_{d0}\\right)/\\alpha$, which we will check after computing $U_{\\max}$.\n\nWe now compute the necessary numerical values. First, the thermodynamic factor $A$ is\n$$\nA = \\frac{T_{s} - T_{o}}{T_{o}}\\, \\left(k_{s}^{\\ast} - k\\right) = \\frac{302 - 200}{200}\\, \\left(3.0 \\times 10^{4}\\right) = 0.51 \\times 3.0 \\times 10^{4} = 1.53 \\times 10^{4}.\n$$\nMultiplying by $C_{k}$,\n$$\nC_{k}\\, A = \\left(1.2 \\times 10^{-3}\\right)\\, \\left(1.53 \\times 10^{4}\\right) = 18.36.\n$$\n\nReduced high-wind drag case (saturated):\n$$\nU_{\\max}^{(\\mathrm{sat})} = \\sqrt{\\frac{C_{k}\\, A}{C_{d,\\mathrm{sat}}}} = \\sqrt{\\frac{18.36}{2.2 \\times 10^{-3}}} = \\sqrt{8345.454545\\ldots}.\n$$\nEvaluating the square root gives\n$$\nU_{\\max}^{(\\mathrm{sat})} \\approx 91.3535.\n$$\nThe saturation threshold wind speed is\n$$\nU_{t} = \\frac{C_{d,\\mathrm{sat}} - C_{d0}}{\\alpha} = \\frac{2.2 \\times 10^{-3} - 1.5 \\times 10^{-3}}{2.0 \\times 10^{-5}} = \\frac{0.7 \\times 10^{-3}}{2.0 \\times 10^{-5}} = 35.\n$$\nSince $91.3535 > 35$, the saturated assumption is self-consistent.\n\nBaseline case (unsaturated, linear $C_{d}(U)$ for all $U$): solve\n$$\n\\left(2.0 \\times 10^{-5}\\right)\\, U^{3} + \\left(1.5 \\times 10^{-3}\\right)\\, U^{2} - 18.36 = 0.\n$$\nThis cubic has one physically relevant positive root for $U$. Bracketing and refinement yield\n$$\nU_{\\max}^{(\\mathrm{base})} \\approx 77.5418.\n$$\nThis satisfies the cubic to within $\\mathcal{O}\\!\\left(10^{-4}\\right)$ in the residual, which is sufficient for a four-significant-figure ratio.\n\nFinally, compute the ratio\n$$\nR \\equiv \\frac{U_{\\max}^{(\\mathrm{sat})}}{U_{\\max}^{(\\mathrm{base})}} \\approx \\frac{91.3535}{77.5418} \\approx 1.17812.\n$$\nRounded to four significant figures,\n$$\nR \\approx 1.178.\n$$\n\nInterpretation for boundary layer structure: In a steady slab boundary layer with depth $h$ and Coriolis parameter $f$, a simple diagnostic for the inflow angle $\\delta$ is $\\delta \\approx \\arctan\\!\\left(\\frac{C_{d}\\, U}{h\\, f}\\right)$, showing that, at fixed $U$, reducing $C_{d}$ reduces $\\delta$ (sharper turning). In this problem, the saturated reduction in $C_{d}$ increases $U$ while capping $C_{d}$, so the net effect on $\\delta$ depends on the product $C_{d}\\, U$. The computed ratio $R > 1$ quantifies the increase in maximum wind due to reducing $C_{d}$ at high wind speeds under the specified thermodynamic constraints.",
            "answer": "$$\\boxed{1.178}$$"
        },
        {
            "introduction": "Moving from idealized theory to operational reality, this final practice addresses the formidable challenge of forecasting rapid intensification (RI). You will engage with modern statistical post-processing techniques by applying a logistic regression model to ensemble forecast data. This exercise provides hands-on experience in translating complex, multi-dimensional model output into a single, actionable probabilistic forecast of RI, a critical component of contemporary weather prediction. ",
            "id": "4106217",
            "problem": "You are provided with a binary-event model for Rapid Intensification (RI) of a tropical cyclone within $48$ hours. The event indicator $Y$ equals $1$ if RI occurs within $48$ hours and $0$ otherwise. Assume the following:\n\n- The conditional probability of $Y=1$ given predictors $\\mathbf{x} \\in \\mathbb{R}^d$ is modeled by a Bernoulli distribution with a logistic link. Specifically, with standardized predictors $\\mathbf{z}$ formed from raw predictors $\\mathbf{x}$ using training-time means $\\boldsymbol{\\mu}$ and standard deviations $\\boldsymbol{\\sigma}$, the linear predictor is\n$$\\eta = \\beta_0 + \\sum_{j=1}^{d} \\beta_j z_j,$$\nwith\n$$z_j = \\frac{x_j - \\mu_j}{\\sigma_j}.$$\nThe event probability is\n$$p = \\mathbb{P}(Y=1 \\mid \\mathbf{x}) = \\frac{1}{1 + e^{-\\eta}}.$$\n\n- You are given an ensemble of $M$ members for each scenario (test case). Each member $k \\in \\{1,\\dots,M\\}$ provides a vector of $d$ predictors $\\mathbf{x}^{(k)}$, which are assumed conditionally independent given the environment. For each member, compute $p^{(k)}$ via the above model.\n\n- From the ensemble member probabilities $\\{p^{(k)}\\}_{k=1}^{M}$, compute the following three ensemble summary diagnostics:\n    1. The ensemble-mean probability:\n    $$\\bar{p} = \\frac{1}{M} \\sum_{k=1}^{M} p^{(k)}.$$\n    2. The probability that at least one member experiences RI within $48$ hours under the conditional independence assumption:\n    $$p_{\\mathrm{any}} = 1 - \\prod_{k=1}^{M} \\left(1 - p^{(k)}\\right).$$\n    3. The fraction of members with individual probability at or above a decision threshold $\\tau$:\n    $$f_{\\ge \\tau} = \\frac{1}{M} \\sum_{k=1}^{M} \\mathbf{1}\\left(p^{(k)} \\ge \\tau\\right).$$\n\nUse the following fixed model specification that was trained on a large, representative dataset:\n\n- Predictor dimension $d = 6$ with components and units:\n    1. Sea surface temperature (Kelvin): $x_1$ in $\\mathrm{K}$.\n    2. Deep-layer vertical wind shear $200$–$850$ hPa (meters per second): $x_2$ in $\\mathrm{m\\,s^{-1}}$.\n    3. Mid-level relative humidity at $600$ hPa (unitless fraction in $[0,1]$): $x_3$.\n    4. Previous $24$-hour intensity change (meters per second): $x_4$ in $\\mathrm{m\\,s^{-1}}$.\n    5. Potential intensity gap, defined as (maximum potential intensity minus current maximum sustained wind) (meters per second): $x_5$ in $\\mathrm{m\\,s^{-1}}$.\n    6. Upper-ocean heat content integrated over the top ocean layer (Joules per square meter): $x_6$ in $\\mathrm{J\\,m^{-2}}$.\n\n- Standardization parameters (training means $\\boldsymbol{\\mu}$ and standard deviations $\\boldsymbol{\\sigma}$):\n$$\\boldsymbol{\\mu} = \\left[300.0,\\, 10.0,\\, 0.6,\\, 0.0,\\, 10.0,\\, 3.0\\times 10^9\\right],$$\n$$\\boldsymbol{\\sigma} = \\left[1.5,\\, 6.0,\\, 0.15,\\, 3.0,\\, 6.0,\\, 1.5\\times 10^9\\right].$$\n\n- Logistic regression coefficients (intercept followed by feature weights):\n$$\\beta_0 = -2.0,$$\n$$(\\beta_1, \\beta_2, \\beta_3, \\beta_4, \\beta_5, \\beta_6) = (0.8,\\, -1.0,\\, 0.7,\\, 0.5,\\, 0.6,\\, 0.4).$$\n\n- Decision threshold for the member-level classification:\n$$\\tau = 0.5.$$\n\nTest suite. For each test case below, you are given an ensemble with $M=5$ members. For each member, the vector $(x_1, x_2, x_3, x_4, x_5, x_6)$ is provided in the units above. Your task is to compute $(\\bar{p}, p_{\\mathrm{any}}, f_{\\ge \\tau})$. These outputs are dimensionless and must be expressed as decimals, not percentages.\n\n- Test case $1$ (moderately favorable environment):\n    - Member $1$: $(301.0,\\, 8.0,\\, 0.65,\\, 1.0,\\, 12.0,\\, 4.0\\times 10^9)$\n    - Member $2$: $(300.5,\\, 9.0,\\, 0.62,\\, 0.0,\\, 11.0,\\, 3.2\\times 10^9)$\n    - Member $3$: $(301.5,\\, 7.0,\\, 0.68,\\, 2.0,\\, 13.0,\\, 4.5\\times 10^9)$\n    - Member $4$: $(299.8,\\, 10.5,\\, 0.58,\\, -1.0,\\, 9.0,\\, 2.8\\times 10^9)$\n    - Member $5$: $(300.2,\\, 8.5,\\, 0.63,\\, 0.5,\\, 10.0,\\, 3.6\\times 10^9)$\n\n- Test case $2$ (highly favorable environment):\n    - Member $1$: $(302.0,\\, 5.0,\\, 0.80,\\, 4.0,\\, 20.0,\\, 6.5\\times 10^9)$\n    - Member $2$: $(302.8,\\, 3.5,\\, 0.85,\\, 5.0,\\, 25.0,\\, 8.0\\times 10^9)$\n    - Member $3$: $(301.8,\\, 4.5,\\, 0.78,\\, 3.0,\\, 18.0,\\, 6.0\\times 10^9)$\n    - Member $4$: $(303.0,\\, 4.0,\\, 0.82,\\, 4.5,\\, 22.0,\\, 7.5\\times 10^9)$\n    - Member $5$: $(302.5,\\, 5.5,\\, 0.76,\\, 3.5,\\, 19.0,\\, 6.8\\times 10^9)$\n\n- Test case $3$ (hostile environment):\n    - Member $1$: $(298.5,\\, 22.0,\\, 0.50,\\, -2.0,\\, 7.0,\\, 1.8\\times 10^9)$\n    - Member $2$: $(299.0,\\, 24.0,\\, 0.52,\\, -3.0,\\, 6.0,\\, 1.5\\times 10^9)$\n    - Member $3$: $(297.8,\\, 28.0,\\, 0.45,\\, -1.0,\\, 5.0,\\, 1.2\\times 10^9)$\n    - Member $4$: $(298.8,\\, 20.0,\\, 0.55,\\, 0.0,\\, 8.0,\\, 2.0\\times 10^9)$\n    - Member $5$: $(299.5,\\, 18.0,\\, 0.58,\\, -0.5,\\, 9.0,\\, 2.2\\times 10^9)$\n\nImplementation details:\n\n- For every ensemble member, standardize each predictor using the provided $\\boldsymbol{\\mu}$ and $\\boldsymbol{\\sigma}$, compute $\\eta$, then compute $p$ via the logistic function. Use numerically stable evaluation of the logistic function where appropriate.\n- Compute $\\bar{p}$, $p_{\\mathrm{any}}$, and $f_{\\ge \\tau}$ as defined above for each test case with $M=5$.\n- The outputs have no physical units and must be presented as decimals rounded to exactly $6$ places after the decimal point.\n- Final output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to a test case and is itself a list of the three floats $[\\bar{p}, p_{\\mathrm{any}}, f_{\\ge \\tau}]$. For example: $[[a_1,b_1,c_1],[a_2,b_2,c_2],[a_3,b_3,c_3]]$ with each $a_i,b_i,c_i$ rounded to $6$ decimal places.",
            "solution": "The problem is deemed valid as it is scientifically grounded, well-posed, complete, and algorithmically tractable. It presents a standard application of a logistic regression model within the context of ensemble forecasting for a meteorological phenomenon, Rapid Intensification (RI) of tropical cyclones. All necessary data, including model parameters and test cases, are provided, and the required calculations are explicitly defined.\n\nThe solution proceeds by first implementing the given statistical model to calculate the RI probability for each individual member of an ensemble. Subsequently, these individual probabilities are aggregated to compute the three specified ensemble summary diagnostics for each test case.\n\nThe foundational model is a logistic regression, which models the probability of a binary outcome. The event $Y=1$ represents RI occurring within a $48$-hour window. The probability of this event, $p = \\mathbb{P}(Y=1 \\mid \\mathbf{x})$, is conditional on a vector of $d=6$ atmospheric and oceanic predictors, $\\mathbf{x} = (x_1, \\dots, x_6)$.\n\nFirst, the raw predictors $\\mathbf{x}$ are standardized to $\\mathbf{z}$ to ensure they are on a comparable scale, which is common practice in machine learning. The standardization uses the mean $\\mu_j$ and standard deviation $\\sigma_j$ from the training dataset for each predictor $j$:\n$$z_j = \\frac{x_j - \\mu_j}{\\sigma_j}$$\nThe problem provides the vectors $\\boldsymbol{\\mu} = [\\mu_1, \\dots, \\mu_6]$ and $\\boldsymbol{\\sigma} = [\\sigma_1, \\dots, \\sigma_6]$.\n\nNext, a linear combination of these standardized predictors is formed. This is the linear predictor, $\\eta$:\n$$\\eta = \\beta_0 + \\sum_{j=1}^{d} \\beta_j z_j = \\beta_0 + \\boldsymbol{\\beta} \\cdot \\mathbf{z}$$\nwhere $\\beta_0$ is the intercept (bias) and $\\boldsymbol{\\beta} = (\\beta_1, \\dots, \\beta_6)$ is the vector of coefficients (weights). The problem provides these coefficients. The sign of each $\\beta_j$ indicates the direction of the relationship between the predictor $z_j$ and the log-odds of RI. For instance, the negative coefficient for vertical wind shear ($\\beta_2 = -1.0$) correctly reflects that increasing shear is detrimental to intensification.\n\nThe linear predictor $\\eta$ is then transformed into a probability $p$ in the range $[0, 1]$ using the logistic (or sigmoid) function:\n$$p = \\frac{1}{1 + e^{-\\eta}}$$\n\nFor each test case, we are given an ensemble of $M=5$ members. For each member $k \\in \\{1, \\dots, M\\}$, we are given a predictor vector $\\mathbf{x}^{(k)}$. We apply the above three steps to compute the RI probability $p^{(k)}$ for each member.\n\nAfter obtaining the set of probabilities for the ensemble, $\\{p^{(k)}\\}_{k=1}^{M}$, we compute the three required summary diagnostics:\n\n1.  The ensemble-mean probability, $\\bar{p}$. This represents the expected probability of RI, averaged over the uncertainty represented by the ensemble.\n    $$\\bar{p} = \\frac{1}{M} \\sum_{k=1}^{M} p^{(k)}$$\n\n2.  The probability of at least one member forecasting RI, $p_{\\mathrm{any}}$. Under the stated assumption of conditional independence of the ensemble members (i.e., each member's RI outcome is an independent event given its specific atmospheric state), the probability that *no* member experiences RI is the product of the individual probabilities of *not* experiencing RI, $\\prod_{k=1}^{M} (1 - p^{(k)})$. The probability of at least one member experiencing RI is the complement of this event.\n    $$p_{\\mathrm{any}} = 1 - \\prod_{k=1}^{M} \\left(1 - p^{(k)}\\right)$$\n\n3.  The fraction of members with an individual probability at or above a decision threshold $\\tau=0.5$, denoted $f_{\\ge \\tau}$. This is a simple measure of the consensus within the ensemble for a high-probability event. The indicator function $\\mathbf{1}(A)$ is $1$ if condition $A$ is true, and $0$ otherwise.\n    $$f_{\\ge \\tau} = \\frac{1}{M} \\sum_{k=1}^{M} \\mathbf{1}\\left(p^{(k)} \\ge \\tau\\right)$$\n\nThe algorithm is implemented as follows:\nFor each of the three test cases, we iterate through its $M=5$ members. For each member's predictor vector $\\mathbf{x}^{(k)}$, we calculate the standardized vector $\\mathbf{z}^{(k)}$, then the linear predictor $\\eta^{(k)}$, and finally the probability $p^{(k)}$. These five probabilities are stored. From this collection of probabilities, $\\bar{p}$, $p_{\\mathrm{any}}$, and $f_{\\ge \\tau}$ are computed. The numerical calculations are performed using the `numpy` library for efficient vectorized operations. Finally, the results for each diagnostic are formatted as decimal numbers rounded to exactly $6$ places, and the final output string is constructed to match the specified format `[[a_1,b_1,c_1],[a_2,b_2,c_2],[a_3,b_3,c_3]]`.",
            "answer": "```\n[[0.443916,0.923145,0.400000],[0.903743,0.999986,1.000000],[0.043997,0.201476,0.000000]]\n```"
        }
    ]
}