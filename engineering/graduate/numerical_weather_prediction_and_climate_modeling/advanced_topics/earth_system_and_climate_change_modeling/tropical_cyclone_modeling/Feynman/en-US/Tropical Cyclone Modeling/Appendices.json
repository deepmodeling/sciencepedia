{
    "hands_on_practices": [
        {
            "introduction": "This practice focuses on Potential Vorticity (PV), a cornerstone concept in geophysical fluid dynamics. By deriving the PV distribution from a given wind field, you will gain a deeper understanding of how a tropical cyclone's rotational structure is encapsulated in this powerful conserved quantity. This exercise  will sharpen your analytical skills by having you identify the location of the PV ring, a key structural feature related to vortex stability and interaction with the environment.",
            "id": "4106198",
            "problem": "Consider an idealized, axisymmetric tropical cyclone on a constant Coriolis parameter ($f$) plane, with azimuthal wind given by $v(r) = V_{m} \\left(\\frac{r}{R_{m}}\\right) \\exp\\!\\left(1 - \\frac{r}{R_{m}}\\right)$, where $V_{m} > 0$ and $R_{m} > 0$ are constants and $r$ is the radius from the cyclone center. Assume the flow is steady, inviscid, hydrostatic, and well described by the Boussinesq approximation. Let the potential temperature $\\theta$ vary only with height and define a uniform static stability through the Brunt–Väisälä frequency $N$, so that $N^{2} > 0$ is constant.\n\nUsing the Rossby–Ertel definition of Potential Vorticity (PV), compute the axisymmetric radial distribution $q(r)$ at a fixed height, parameterized by $V_{m}$, $R_{m}$, $f$, and $N$. Then, define the “PV ring” radius $r_{\\ast}$ as the radial position $r > 0$ where $q(r)$ attains an annular extremum (i.e., $\\frac{dq}{dr} = 0$ with $r > 0$). Determine $r_{\\ast}$ analytically in terms of $R_{m}$. Report only the analytic expression for $r_{\\ast}$ as your final answer. No numerical values are to be substituted, and no rounding is required.",
            "solution": "The problem asks for the radial position $r_{\\ast}$ of the annular extremum of the Potential Vorticity (PV) for a given idealized tropical cyclone model.\n\nFirst, we establish the relevant expression for the Rossby-Ertel Potential Vorticity, $q$. The general definition is $q = \\frac{1}{\\rho} \\vec{\\eta} \\cdot \\nabla \\theta$, where $\\rho$ is the density, $\\vec{\\eta}$ is the absolute vorticity vector, and $\\theta$ is the potential temperature.\n\nThe problem states that the flow is well described by the Boussinesq approximation. In this approximation, the density $\\rho$ in the PV definition is replaced by a constant reference density, $\\rho_0$.\n$$q = \\frac{1}{\\rho_0} \\vec{\\eta} \\cdot \\nabla \\theta$$\nThe absolute vorticity $\\vec{\\eta}$ is the sum of the relative vorticity $\\vec{\\omega} = \\nabla \\times \\vec{u}$ and the planetary vorticity $f\\hat{e}_z$, where $\\vec{u}$ is the velocity vector and $f$ is the constant Coriolis parameter. The flow is axisymmetric, so we use cylindrical coordinates $(r, \\lambda, z)$. The velocity vector is purely azimuthal: $\\vec{u} = v(r) \\hat{e}_{\\lambda}$.\n\nThe relative vorticity $\\vec{\\omega}$ in cylindrical coordinates is:\n$$ \\vec{\\omega} = \\nabla \\times \\vec{u} = \\left(\\frac{1}{r}\\frac{\\partial u_z}{\\partial \\lambda} - \\frac{\\partial u_{\\lambda}}{\\partial z}\\right)\\hat{e}_r + \\left(\\frac{\\partial u_r}{\\partial z} - \\frac{\\partial u_z}{\\partial r}\\right)\\hat{e}_{\\lambda} + \\frac{1}{r}\\left(\\frac{\\partial(r u_{\\lambda})}{\\partial r} - \\frac{\\partial u_r}{\\partial \\lambda}\\right)\\hat{e}_z $$\nGiven $\\vec{u} = (u_r, u_{\\lambda}, u_z) = (0, v(r), 0)$, the radial and vertical components of the velocity are zero, and the azimuthal component $v$ depends only on $r$. The expression for $\\vec{\\omega}$ simplifies to its vertical component alone:\n$$ \\vec{\\omega} = \\left( \\frac{1}{r}\\frac{d(rv(r))}{dr} \\right) \\hat{e}_z $$\nThe vertical component of the relative vorticity is denoted by $\\zeta(r) = \\frac{1}{r}\\frac{d(rv(r))}{dr}$.\nThe absolute vorticity vector is then $\\vec{\\eta} = \\vec{\\omega} + f\\hat{e}_z = (\\zeta(r) + f)\\hat{e}_z$.\n\nThe problem states that the potential temperature $\\theta$ varies only with height, $\\theta = \\theta(z)$. Therefore, its gradient is purely vertical: $\\nabla \\theta = \\frac{d\\theta}{dz} \\hat{e}_z$.\n\nSubstituting these into the PV equation:\n$$ q(r, z) = \\frac{1}{\\rho_0} \\left( (\\zeta(r) + f)\\hat{e}_z \\right) \\cdot \\left( \\frac{d\\theta}{dz} \\hat{e}_z \\right) = \\frac{1}{\\rho_0} (\\zeta(r) + f) \\frac{d\\theta}{dz} $$\nThe static stability is defined by the constant Brunt–Väisälä frequency squared, $N^2 = \\frac{g}{\\theta_0} \\frac{d\\theta}{dz}$, where $g$ is the acceleration due to gravity and $\\theta_0$ is a reference potential temperature. Thus, $\\frac{d\\theta}{dz} = \\frac{\\theta_0 N^2}{g}$. Since $N^2$ is a positive constant, $\\frac{d\\theta}{dz}$ is also a positive constant.\nThe PV at a fixed height is therefore:\n$$ q(r) = \\frac{\\theta_0 N^2}{\\rho_0 g} (\\zeta(r) + f) $$\nThe term $\\frac{\\theta_0 N^2}{\\rho_0 g}$ is a positive constant. To find the radial extremum of $q(r)$, we need to find the extremum of the vertical component of the relative vorticity, $\\zeta(r)$, since the Coriolis parameter $f$ is also a constant. The location of the extremum is found by solving $\\frac{dq}{dr} = 0$, which is equivalent to solving $\\frac{d\\zeta}{dr} = 0$.\n\nNext, we calculate $\\zeta(r)$ using the given azimuthal wind profile:\n$$ v(r) = V_{m} \\left(\\frac{r}{R_{m}}\\right) \\exp\\left(1 - \\frac{r}{R_{m}}\\right) $$\nLet's rewrite this as $v(r) = \\frac{V_m e}{R_m} r \\exp(-\\frac{r}{R_m})$. First, we compute the circulation term $rv(r)$:\n$$ rv(r) = \\frac{V_m e}{R_m} r^2 \\exp\\left(-\\frac{r}{R_m}\\right) $$\nNow, we differentiate with respect to $r$:\n$$ \\frac{d(rv(r))}{dr} = \\frac{V_m e}{R_m} \\frac{d}{dr}\\left[r^2 \\exp\\left(-\\frac{r}{R_m}\\right)\\right] $$\nUsing the product rule for differentiation:\n$$ \\frac{d(rv(r))}{dr} = \\frac{V_m e}{R_m} \\left[ 2r \\exp\\left(-\\frac{r}{R_m}\\right) + r^2 \\left(-\\frac{1}{R_m}\\right) \\exp\\left(-\\frac{r}{R_m}\\right) \\right] $$\n$$ \\frac{d(rv(r))}{dr} = \\frac{V_m e}{R_m} r \\exp\\left(-\\frac{r}{R_m}\\right) \\left(2 - \\frac{r}{R_m}\\right) $$\nThe relative vorticity $\\zeta(r)$ is obtained by dividing by $r$:\n$$ \\zeta(r) = \\frac{1}{r} \\frac{d(rv(r))}{dr} = \\frac{V_m e}{R_m} \\exp\\left(-\\frac{r}{R_m}\\right) \\left(2 - \\frac{r}{R_m}\\right) $$\nTo find the extremum, we differentiate $\\zeta(r)$ with respect to $r$ and set the result to zero.\n$$ \\frac{d\\zeta}{dr} = \\frac{d}{dr} \\left[ \\frac{V_m e}{R_m} \\exp\\left(-\\frac{r}{R_m}\\right) \\left(2 - \\frac{r}{R_m}\\right) \\right] $$\n$$ \\frac{d\\zeta}{dr} = \\frac{V_m e}{R_m} \\left[ \\left(-\\frac{1}{R_m}\\right) \\exp\\left(-\\frac{r}{R_m}\\right) \\left(2 - \\frac{r}{R_m}\\right) + \\exp\\left(-\\frac{r}{R_m}\\right) \\left(-\\frac{1}{R_m}\\right) \\right] $$\nFactor out the common terms:\n$$ \\frac{d\\zeta}{dr} = -\\frac{V_m e}{R_m^2} \\exp\\left(-\\frac{r}{R_m}\\right) \\left[ \\left(2 - \\frac{r}{R_m}\\right) + 1 \\right] $$\n$$ \\frac{d\\zeta}{dr} = -\\frac{V_m e}{R_m^2} \\exp\\left(-\\frac{r}{R_m}\\right) \\left(3 - \\frac{r}{R_m}\\right) $$\nThe condition for an extremum for $r > 0$ is $\\frac{d\\zeta}{dr} = 0$. Since $V_m > 0$, $R_m > 0$, and $\\exp\\left(-\\frac{r}{R_m}\\right) > 0$, this condition is met only when the term in the parenthesis is zero:\n$$ 3 - \\frac{r}{R_m} = 0 $$\nSolving for $r$ gives the radius of the PV ring, $r_{\\ast}$:\n$$ \\frac{r_{\\ast}}{R_m} = 3 $$\n$$ r_{\\ast} = 3R_m $$\nThis is the analytical expression for the radial position of the annular extremum of the potential vorticity.",
            "answer": "$$\\boxed{3R_{m}}$$"
        },
        {
            "introduction": "Building on the structure of the vortex, this exercise explores the fundamental relationship between a tropical cyclone's wind and pressure fields. You will apply the principle of gradient wind balance to the widely used Holland parametric pressure profile, a standard tool in both research and operational settings. This practice  offers a concrete example of how theoretical dynamics are used to interpret and constrain observational models, culminating in the calculation of a critical storm metric: the central pressure.",
            "id": "4106241",
            "problem": "Consider an idealized, axisymmetric tropical cyclone in steady, frictionless balance on an $f$-plane, where the tangential wind $V_{t}(r)$ satisfies the gradient wind balance derived from the radial momentum equation. The Holland parametric pressure profile represents the sea-level pressure $p(r)$ as\n$$\np(r) = p_{c} + \\left(p_{e} - p_{c}\\right)\\exp\\!\\left(-\\left(\\frac{R_{m}}{r}\\right)^{B}\\right),\n$$\nwhere $p_{c}$ is the central pressure, $p_{e}$ is the environmental pressure, $R_{m}$ is the Radius of Maximum Wind (RMW), and $B$ is a dimensionless shape parameter. Starting from the gradient wind balance and the given pressure profile, derive the explicit relationship between $V_{t}(r)$ and the radial pressure gradient $\\partial p/\\partial r$. Then specialize your result at $r = R_{m}$ to obtain $p_{c}$ in terms of $V_{\\max} = V_{t}(R_{m})$, $B$, $f$, $R_{m}$, $\\rho$, and $p_{e}$, where $\\rho$ is the air density and $f$ is the Coriolis parameter.\n\nUse the following scientifically realistic values: $V_{\\max} = 60\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$, $B = 1.5$, $R_{m} = 30\\,\\mathrm{km}$, $f = 5.0\\times 10^{-5}\\,\\mathrm{s}^{-1}$, $\\rho = 1.15\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$, and $p_{e} = 1010\\,\\mathrm{hPa}$. Compute the numerical value of $p_{c}$ based on your derived expression. Express the final central pressure in hectopascals (hPa) and round your answer to four significant figures. Assume the maximum tangential wind occurs at $r=R_{m}$ in the sense of the gradient wind, consistent with the Holland model’s use of $R_{m}$ as the RMW.",
            "solution": "The radial momentum equation for an axisymmetric, steady, frictionless flow on an $f$-plane, expressed in cylindrical coordinates $(r, \\theta, z)$, is the gradient wind balance equation:\n$$\n\\frac{1}{\\rho}\\frac{\\partial p}{\\partial r} = \\frac{V_{t}^{2}}{r} + fV_{t}\n$$\nHere, $\\frac{\\partial p}{\\partial r}$ is the radial pressure gradient force, $\\frac{V_t^2}{r}$ is the centrifugal acceleration, and $fV_t$ is the Coriolis acceleration.\n\nThe first task is to derive the explicit relationship between $V_t(r)$ and the radial pressure gradient $\\frac{\\partial p}{\\partial r}$. We can rearrange the gradient wind balance equation into a quadratic equation for $V_t$:\n$$\n\\frac{V_{t}^{2}}{r} + fV_{t} - \\frac{1}{\\rho}\\frac{\\partial p}{\\partial r} = 0\n$$\nMultiplying by $r$ gives:\n$$\nV_{t}^{2} + (fr)V_{t} - \\frac{r}{\\rho}\\frac{\\partial p}{\\partial r} = 0\n$$\nUsing the quadratic formula $V_t = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ with $a=1$, $b=fr$, and $c = -\\frac{r}{\\rho}\\frac{\\partial p}{\\partial r}$, we obtain:\n$$\nV_{t}(r) = \\frac{-fr \\pm \\sqrt{(fr)^{2} + \\frac{4r}{\\rho}\\frac{\\partial p}{\\partial r}}}{2}\n$$\nFor a tropical cyclone (a low-pressure center), the pressure increases with radius, so $\\frac{\\partial p}{\\partial r} > 0$. In the Northern Hemisphere, $f > 0$, and by convention, the cyclonic tangential wind speed $V_t$ is positive. The term under the square root is $\\sqrt{(fr)^2 + \\text{positive term}} > \\sqrt{(fr)^2} = fr$. To ensure $V_t > 0$, we must choose the positive root. Thus, the explicit relationship is:\n$$\nV_{t}(r) = \\frac{-fr + \\sqrt{(fr)^2 + \\frac{4r}{\\rho}\\frac{\\partial p}{\\partial r}}}{2}\n$$\nThe second task is to find an expression for the central pressure $p_c$. We begin by calculating the pressure gradient, $\\frac{\\partial p}{\\partial r}$, from the Holland profile:\n$$\np(r) = p_{c} + \\left(p_{e} - p_{c}\\right)\\exp\\!\\left(-\\left(\\frac{R_{m}}{r}\\right)^{B}\\right)\n$$\nDifferentiating with respect to $r$ using the chain rule:\n$$\n\\frac{\\partial p}{\\partial r} = (p_{e} - p_{c}) \\cdot \\frac{d}{dr} \\left[ \\exp\\left(-R_{m}^{B}r^{-B}\\right) \\right]\n$$\n$$\n\\frac{\\partial p}{\\partial r} = (p_{e} - p_{c}) \\cdot \\exp\\left(-R_{m}^{B}r^{-B}\\right) \\cdot (-R_{m}^{B})(-B r^{-B-1})\n$$\n$$\n\\frac{\\partial p}{\\partial r} = (p_{e} - p_{c}) \\frac{B R_{m}^{B}}{r^{B+1}} \\exp\\left(-\\left(\\frac{R_{m}}{r}\\right)^{B}\\right)\n$$\nThe problem states that the maximum wind speed, $V_{\\max}$, occurs at the radius of maximum winds, $r=R_m$. We evaluate the pressure gradient at this radius:\n$$\n\\left.\\frac{\\partial p}{\\partial r}\\right|_{r=R_{m}} = (p_{e} - p_{c}) \\frac{B R_{m}^{B}}{R_{m}^{B+1}} \\exp\\left(-\\left(\\frac{R_{m}}{R_{m}}\\right)^{B}\\right) = (p_{e} - p_{c}) \\frac{B}{R_{m}} \\exp(-1)\n$$\nSo,\n$$\n\\left.\\frac{\\partial p}{\\partial r}\\right|_{r=R_{m}} = \\frac{B(p_{e} - p_{c})}{e R_{m}}\n$$\nwhere $e$ is Euler's number.\n\nNow, we evaluate the gradient wind balance equation at $r=R_m$, where $V_t=V_{\\max}$:\n$$\n\\left.\\frac{1}{\\rho}\\frac{\\partial p}{\\partial r}\\right|_{r=R_{m}} = \\frac{V_{\\max}^{2}}{R_{m}} + fV_{\\max}\n$$\n$$\n\\left.\\frac{\\partial p}{\\partial r}\\right|_{r=R_{m}} = \\rho\\left(\\frac{V_{\\max}^{2}}{R_{m}} + fV_{\\max}\\right)\n$$\nEquating the two expressions for the pressure gradient at $r=R_m$:\n$$\n\\frac{B(p_{e} - p_{c})}{e R_{m}} = \\rho\\left(\\frac{V_{\\max}^{2}}{R_{m}} + fV_{\\max}\\right)\n$$\nWe now solve for $p_c$. First, isolate the term $(p_e - p_c)$:\n$$\np_{e} - p_{c} = \\frac{e R_{m} \\rho}{B} \\left(\\frac{V_{\\max}^{2}}{R_{m}} + fV_{\\max}\\right)\n$$\n$$\np_{e} - p_{c} = \\frac{e\\rho}{B} (V_{\\max}^{2} + f R_{m} V_{\\max})\n$$\nFinally, solving for $p_c$:\n$$\np_{c} = p_{e} - \\frac{e\\rho}{B} (V_{\\max}^{2} + f R_{m} V_{\\max})\n$$\nThis is the desired expression for $p_c$.\n\nNow, we compute the numerical value of $p_c$ using the provided constants. All values must be in base SI units (meters, kilograms, seconds, Pascals).\n-   $V_{\\max} = 60\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$\n-   $B = 1.5$\n-   $R_{m} = 30\\,\\mathrm{km} = 30 \\times 10^{3}\\,\\mathrm{m}$\n-   $f = 5.0\\times 10^{-5}\\,\\mathrm{s}^{-1}$\n-   $\\rho = 1.15\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$\n-   $p_{e} = 1010\\,\\mathrm{hPa} = 1010 \\times 100\\,\\mathrm{Pa} = 101000\\,\\mathrm{Pa}$\n-   $e \\approx 2.71828$\n\nFirst, compute the term in the parentheses:\n$$\nV_{\\max}^{2} = (60\\,\\mathrm{m}\\,\\mathrm{s}^{-1})^{2} = 3600\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-2}\n$$\n$$\nf R_{m} V_{\\max} = (5.0\\times 10^{-5}\\,\\mathrm{s}^{-1}) \\cdot (30 \\times 10^{3}\\,\\mathrm{m}) \\cdot (60\\,\\mathrm{m}\\,\\mathrm{s}^{-1}) = 90\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-2}\n$$\n$$\nV_{\\max}^{2} + f R_{m} V_{\\max} = 3600 + 90 = 3690\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-2}\n$$\nNow, compute the pressure drop term $\\Delta p = \\frac{e\\rho}{B} (V_{\\max}^{2} + f R_{m} V_{\\max})$:\n$$\n\\Delta p = \\frac{e \\cdot (1.15\\,\\mathrm{kg}\\,\\mathrm{m}^{-3})}{1.5} \\cdot (3690\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-2})\n$$\n$$\n\\Delta p \\approx \\frac{2.71828 \\cdot 1.15}{1.5} \\cdot 3690 \\,\\mathrm{Pa} \\approx 2.084015 \\cdot 3690 \\,\\mathrm{Pa} \\approx 7690.015\\,\\mathrm{Pa}\n$$\nFinally, calculate $p_c$:\n$$\np_c = p_e - \\Delta p = 101000\\,\\mathrm{Pa} - 7690.015\\,\\mathrm{Pa} = 93309.985\\,\\mathrm{Pa}\n$$\nThe problem requires the answer in hectopascals (hPa), rounded to four significant figures.\n$$\np_c = \\frac{93309.985}{100}\\,\\mathrm{hPa} = 933.09985\\,\\mathrm{hPa}\n$$\nRounding to four significant figures gives:\n$$\np_c \\approx 933.1\\,\\mathrm{hPa}\n$$",
            "answer": "$$\n\\boxed{933.1}\n$$"
        },
        {
            "introduction": "This final practice transitions from idealized dynamics to the modern, data-driven realm of tropical cyclone forecasting. You will implement a statistical post-processing model to calculate the probability of rapid intensification, one of the most challenging and critical forecast problems. By working with a realistic logistic regression model and ensemble data , you will gain hands-on experience with the techniques used to translate complex numerical model output into actionable, probabilistic guidance.",
            "id": "4106217",
            "problem": "You are provided with a binary-event model for Rapid Intensification (RI) of a tropical cyclone within $48$ hours. The event indicator $Y$ equals $1$ if RI occurs within $48$ hours and $0$ otherwise. Assume the following:\n\n- The conditional probability of $Y=1$ given predictors $\\mathbf{x} \\in \\mathbb{R}^d$ is modeled by a Bernoulli distribution with a logistic link. Specifically, with standardized predictors $\\mathbf{z}$ formed from raw predictors $\\mathbf{x}$ using training-time means $\\boldsymbol{\\mu}$ and standard deviations $\\boldsymbol{\\sigma}$, the linear predictor is\n$$\\eta = \\beta_0 + \\sum_{j=1}^{d} \\beta_j z_j,$$\nwith\n$$z_j = \\frac{x_j - \\mu_j}{\\sigma_j}.$$\nThe event probability is\n$$p = \\mathbb{P}(Y=1 \\mid \\mathbf{x}) = \\frac{1}{1 + e^{-\\eta}}.$$\n\n- You are given an ensemble of $M$ members for each scenario (test case). Each member $k \\in \\{1,\\dots,M\\}$ provides a vector of $d$ predictors $\\mathbf{x}^{(k)}$, which are assumed conditionally independent given the environment. For each member, compute $p^{(k)}$ via the above model.\n\n- From the ensemble member probabilities $\\{p^{(k)}\\}_{k=1}^{M}$, compute the following three ensemble summary diagnostics:\n    1. The ensemble-mean probability:\n    $$\\bar{p} = \\frac{1}{M} \\sum_{k=1}^{M} p^{(k)}.$$\n    2. The probability that at least one member experiences RI within $48$ hours under the conditional independence assumption:\n    $$p_{\\mathrm{any}} = 1 - \\prod_{k=1}^{M} \\left(1 - p^{(k)}\\right).$$\n    3. The fraction of members with individual probability at or above a decision threshold $\\tau$:\n    $$f_{\\ge \\tau} = \\frac{1}{M} \\sum_{k=1}^{M} \\mathbf{1}\\left(p^{(k)} \\ge \\tau\\right).$$\n\nUse the following fixed model specification that was trained on a large, representative dataset:\n\n- Predictor dimension $d = 6$ with components and units:\n    1. Sea surface temperature (Kelvin): $x_1$ in $\\mathrm{K}$.\n    2. Deep-layer vertical wind shear $200$–$850$ hPa (meters per second): $x_2$ in $\\mathrm{m\\,s^{-1}}$.\n    3. Mid-level relative humidity at $600$ hPa (unitless fraction in $[0,1]$): $x_3$.\n    4. Previous $24$-hour intensity change (meters per second): $x_4$ in $\\mathrm{m\\,s^{-1}}$.\n    5. Potential intensity gap, defined as (maximum potential intensity minus current maximum sustained wind) (meters per second): $x_5$ in $\\mathrm{m\\,s^{-1}}$.\n    6. Upper-ocean heat content integrated over the top ocean layer (Joules per square meter): $x_6$ in $\\mathrm{J\\,m^{-2}}$.\n\n- Standardization parameters (training means $\\boldsymbol{\\mu}$ and standard deviations $\\boldsymbol{\\sigma}$):\n$$\\boldsymbol{\\mu} = \\left[300.0,\\, 10.0,\\, 0.6,\\, 0.0,\\, 10.0,\\, 3.0\\times 10^9\\right],$$\n$$\\boldsymbol{\\sigma} = \\left[1.5,\\, 6.0,\\, 0.15,\\, 3.0,\\, 6.0,\\, 1.5\\times 10^9\\right].$$\n\n- Logistic regression coefficients (intercept followed by feature weights):\n$$\\beta_0 = -2.0,$$\n$$(\\beta_1, \\beta_2, \\beta_3, \\beta_4, \\beta_5, \\beta_6) = (0.8,\\, -1.0,\\, 0.7,\\, 0.5,\\, 0.6,\\, 0.4).$$\n\n- Decision threshold for the member-level classification:\n$$\\tau = 0.5.$$\n\nTest suite. For each test case below, you are given an ensemble with $M=5$ members. For each member, the vector $(x_1, x_2, x_3, x_4, x_5, x_6)$ is provided in the units above. Your task is to compute $(\\bar{p}, p_{\\mathrm{any}}, f_{\\ge \\tau})$. These outputs are dimensionless and must be expressed as decimals, not percentages.\n\n- Test case $1$ (moderately favorable environment):\n    - Member $1$: $(301.0,\\, 8.0,\\, 0.65,\\, 1.0,\\, 12.0,\\, 4.0\\times 10^9)$\n    - Member $2$: $(300.5,\\, 9.0,\\, 0.62,\\, 0.0,\\, 11.0,\\, 3.2\\times 10^9)$\n    - Member $3$: $(301.5,\\, 7.0,\\, 0.68,\\, 2.0,\\, 13.0,\\, 4.5\\times 10^9)$\n    - Member $4$: $(299.8,\\, 10.5,\\, 0.58,\\, -1.0,\\, 9.0,\\, 2.8\\times 10^9)$\n    - Member $5$: $(300.2,\\, 8.5,\\, 0.63,\\, 0.5,\\, 10.0,\\, 3.6\\times 10^9)$\n\n- Test case $2$ (highly favorable environment):\n    - Member $1$: $(302.0,\\, 5.0,\\, 0.80,\\, 4.0,\\, 20.0,\\, 6.5\\times 10^9)$\n    - Member $2$: $(302.8,\\, 3.5,\\, 0.85,\\, 5.0,\\, 25.0,\\, 8.0\\times 10^9)$\n    - Member $3$: $(301.8,\\, 4.5,\\, 0.78,\\, 3.0,\\, 18.0,\\, 6.0\\times 10^9)$\n    - Member $4$: $(303.0,\\, 4.0,\\, 0.82,\\, 4.5,\\, 22.0,\\, 7.5\\times 10^9)$\n    - Member $5$: $(302.5,\\, 5.5,\\, 0.76,\\, 3.5,\\, 19.0,\\, 6.8\\times 10^9)$\n\n- Test case $3$ (hostile environment):\n    - Member $1$: $(298.5,\\, 22.0,\\, 0.50,\\, -2.0,\\, 7.0,\\, 1.8\\times 10^9)$\n    - Member $2$: $(299.0,\\, 24.0,\\, 0.52,\\, -3.0,\\, 6.0,\\, 1.5\\times 10^9)$\n    - Member $3$: $(297.8,\\, 28.0,\\, 0.45,\\, -1.0,\\, 5.0,\\, 1.2\\times 10^9)$\n    - Member $4$: $(298.8,\\, 20.0,\\, 0.55,\\, 0.0,\\, 8.0,\\, 2.0\\times 10^9)$\n    - Member $5$: $(299.5,\\, 18.0,\\, 0.58,\\, -0.5,\\, 9.0,\\, 2.2\\times 10^9)$\n\nImplementation details:\n\n- For every ensemble member, standardize each predictor using the provided $\\boldsymbol{\\mu}$ and $\\boldsymbol{\\sigma}$, compute $\\eta$, then compute $p$ via the logistic function. Use numerically stable evaluation of the logistic function where appropriate.\n- Compute $\\bar{p}$, $p_{\\mathrm{any}}$, and $f_{\\ge \\tau}$ as defined above for each test case with $M=5$.\n- The outputs have no physical units and must be presented as decimals rounded to exactly $6$ places after the decimal point.\n- Final output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to a test case and is itself a list of the three floats $[\\bar{p}, p_{\\mathrm{any}}, f_{\\ge \\tau}]$. For example: $[[a_1,b_1,c_1],[a_2,b_2,c_2],[a_3,b_3,c_3]]$ with each $a_i,b_i,c_i$ rounded to $6$ decimal places.",
            "solution": "The solution proceeds by first implementing the given statistical model to calculate the RI probability for each individual member of an ensemble. Subsequently, these individual probabilities are aggregated to compute the three specified ensemble summary diagnostics for each test case.\n\nThe foundational model is a logistic regression, which models the probability of a binary outcome. The event $Y=1$ represents RI occurring within a $48$-hour window. The probability of this event, $p = \\mathbb{P}(Y=1 \\mid \\mathbf{x})$, is conditional on a vector of $d=6$ atmospheric and oceanic predictors, $\\mathbf{x} = (x_1, \\dots, x_6)$.\n\nFirst, the raw predictors $\\mathbf{x}$ are standardized to $\\mathbf{z}$ to ensure they are on a comparable scale, which is common practice in machine learning. The standardization uses the mean $\\mu_j$ and standard deviation $\\sigma_j$ from the training dataset for each predictor $j$:\n$$z_j = \\frac{x_j - \\mu_j}{\\sigma_j}$$\nThe problem provides the vectors $\\boldsymbol{\\mu} = [\\mu_1, \\dots, \\mu_6]$ and $\\boldsymbol{\\sigma} = [\\sigma_1, \\dots, \\sigma_6]$.\n\nNext, a linear combination of these standardized predictors is formed. This is the linear predictor, $\\eta$:\n$$\\eta = \\beta_0 + \\sum_{j=1}^{d} \\beta_j z_j = \\beta_0 + \\boldsymbol{\\beta} \\cdot \\mathbf{z}$$\nwhere $\\beta_0$ is the intercept (bias) and $\\boldsymbol{\\beta} = (\\beta_1, \\dots, \\beta_6)$ is the vector of coefficients (weights). The problem provides these coefficients. The sign of each $\\beta_j$ indicates the direction of the relationship between the predictor $z_j$ and the log-odds of RI. For instance, the negative coefficient for vertical wind shear ($\\beta_2 = -1.0$) correctly reflects that increasing shear is detrimental to intensification.\n\nThe linear predictor $\\eta$ is then transformed into a probability $p$ in the range $[0, 1]$ using the logistic (or sigmoid) function:\n$$p = \\frac{1}{1 + e^{-\\eta}}$$\n\nFor each test case, we are given an ensemble of $M=5$ members. For each member $k \\in \\{1, \\dots, M\\}$, we are given a predictor vector $\\mathbf{x}^{(k)}$. We apply the above three steps to compute the RI probability $p^{(k)}$ for each member.\n\nAfter obtaining the set of probabilities for the ensemble, $\\{p^{(k)}\\}_{k=1}^{M}$, we compute the three required summary diagnostics:\n\n1.  The ensemble-mean probability, $\\bar{p}$. This represents the expected probability of RI, averaged over the uncertainty represented by the ensemble.\n    $$\\bar{p} = \\frac{1}{M} \\sum_{k=1}^{M} p^{(k)}$$\n\n2.  The probability of at least one member forecasting RI, $p_{\\mathrm{any}}$. Under the stated assumption of conditional independence of the ensemble members (i.e., each member's RI outcome is an independent event given its specific atmospheric state), the probability that *no* member experiences RI is the product of the individual probabilities of *not* experiencing RI, $\\prod_{k=1}^{M} (1 - p^{(k)})$. The probability of at least one member experiencing RI is the complement of this event.\n    $$p_{\\mathrm{any}} = 1 - \\prod_{k=1}^{M} \\left(1 - p^{(k)}\\right)$$\n\n3.  The fraction of members with an individual probability at or above a decision threshold $\\tau=0.5$, denoted $f_{\\ge \\tau}$. This is a simple measure of the consensus within the ensemble for a high-probability event. The indicator function $\\mathbf{1}(A)$ is $1$ if condition $A$ is true, and $0$ otherwise.\n    $$f_{\\ge \\tau} = \\frac{1}{M} \\sum_{k=1}^{M} \\mathbf{1}\\left(p^{(k)} \\ge \\tau\\right)$$\n\nThe algorithm is implemented as follows:\nFor each of the three test cases, we iterate through its $M=5$ members. For each member's predictor vector $\\mathbf{x}^{(k)}$, we calculate the standardized vector $\\mathbf{z}^{(k)}$, then the linear predictor $\\eta^{(k)}$, and finally the probability $p^{(k)}$. These five probabilities are stored. From this collection of probabilities, $\\bar{p}$, $p_{\\mathrm{any}}$, and $f_{\\ge \\tau}$ are computed. The numerical calculations are performed using the `numpy` library for efficient vectorized operations. Finally, the results for each diagnostic are formatted as decimal numbers rounded to exactly $6$ places, and the final output string is constructed to match the specified format `[[a_1,b_1,c_1],[a_2,b_2,c_2],[a_3,b_3,c_3]]`.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes ensemble diagnostics for a tropical cyclone rapid intensification model.\n    \"\"\"\n    # Define the fixed model specification.\n    # Training means for standardization.\n    mu = np.array([300.0, 10.0, 0.6, 0.0, 10.0, 3.0e9])\n    # Training standard deviations for standardization.\n    sigma = np.array([1.5, 6.0, 0.15, 3.0, 6.0, 1.5e9])\n    # Logistic regression intercept.\n    beta0 = -2.0\n    # Logistic regression coefficients for the 6 predictors.\n    betas = np.array([0.8, -1.0, 0.7, 0.5, 0.6, 0.4])\n    # Decision threshold for member-level classification.\n    tau = 0.5\n\n    # Define the test cases, each with an ensemble of M=5 members.\n    test_cases = [\n        # Test case 1 (moderately favorable environment)\n        [\n            [301.0, 8.0, 0.65, 1.0, 12.0, 4.0e9],\n            [300.5, 9.0, 0.62, 0.0, 11.0, 3.2e9],\n            [301.5, 7.0, 0.68, 2.0, 13.0, 4.5e9],\n            [299.8, 10.5, 0.58, -1.0, 9.0, 2.8e9],\n            [300.2, 8.5, 0.63, 0.5, 10.0, 3.6e9]\n        ],\n        # Test case 2 (highly favorable environment)\n        [\n            [302.0, 5.0, 0.80, 4.0, 20.0, 6.5e9],\n            [302.8, 3.5, 0.85, 5.0, 25.0, 8.0e9],\n            [301.8, 4.5, 0.78, 3.0, 18.0, 6.0e9],\n            [303.0, 4.0, 0.82, 4.5, 22.0, 7.5e9],\n            [302.5, 5.5, 0.76, 3.5, 19.0, 6.8e9]\n        ],\n        # Test case 3 (hostile environment)\n        [\n            [298.5, 22.0, 0.50, -2.0, 7.0, 1.8e9],\n            [299.0, 24.0, 0.52, -3.0, 6.0, 1.5e9],\n            [297.8, 28.0, 0.45, -1.0, 5.0, 1.2e9],\n            [298.8, 20.0, 0.55, 0.0, 8.0, 2.0e9],\n            [299.5, 18.0, 0.58, -0.5, 9.0, 2.2e9]\n        ]\n    ]\n\n    all_case_results = []\n    \n    for ensemble_data in test_cases:\n        M = float(len(ensemble_data))\n        member_probabilities = []\n        \n        for member_x_list in ensemble_data:\n            x = np.array(member_x_list, dtype=np.float64)\n            \n            # Standardize predictors using the provided means and standard deviations.\n            z = (x - mu) / sigma\n            \n            # Compute the linear predictor eta.\n            eta = beta0 + np.dot(z, betas)\n            \n            # Compute the probability p using the logistic function.\n            p = 1.0 / (1.0 + np.exp(-eta))\n            member_probabilities.append(p)\n        \n        p_k = np.array(member_probabilities, dtype=np.float64)\n        \n        # 1. Compute the ensemble-mean probability.\n        p_bar = np.mean(p_k)\n        \n        # 2. Compute the probability of at least one member experiencing RI.\n        p_any = 1.0 - np.prod(1.0 - p_k)\n        \n        # 3. Compute the fraction of members with probability at or above the threshold.\n        f_ge_tau = np.sum(p_k >= tau) / M\n        \n        all_case_results.append((p_bar, p_any, f_ge_tau))\n\n    # Format the results into the required string format with 6 decimal places.\n    result_strings = []\n    for result_tuple in all_case_results:\n        p_bar_str = f\"{result_tuple[0]:.6f}\"\n        p_any_str = f\"{result_tuple[1]:.6f}\"\n        f_ge_tau_str = f\"{result_tuple[2]:.6f}\"\n        result_strings.append(f\"[{p_bar_str},{p_any_str},{f_ge_tau_str}]\")\n    \n    final_output = f\"[{','.join(result_strings)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}