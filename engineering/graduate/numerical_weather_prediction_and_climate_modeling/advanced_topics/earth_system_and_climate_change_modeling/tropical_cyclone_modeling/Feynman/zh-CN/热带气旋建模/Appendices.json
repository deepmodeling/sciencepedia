{
    "hands_on_practices": [
        {
            "introduction": "在热带气旋建模中，一个核心任务是建立压力场和风场之间的关系。这个练习将引导你使用一个广泛应用的经验模型——Holland压力剖面，并结合梯度风平衡这一基本动力学原理。通过推导和计算，你将亲身体验如何从一个给定的压力结构中确定出气旋的关键特征，例如其中心气压，这是理解和预报气旋强度的基础。",
            "id": "4106241",
            "problem": "考虑一个位于$f$平面上的理想化、轴对称的热带气旋，该气 cyclone 处于稳定、无摩擦的平衡状态，其切向风$V_{t}(r)$满足由径向动量方程导出的梯度风平衡。Holland参数化气压廓线将海平面气压$p(r)$表示为\n$$\np(r) = p_{c} + \\left(p_{e} - p_{c}\\right)\\exp\\!\\left(-\\left(\\frac{R_{m}}{r}\\right)^{B}\\right),\n$$\n其中$p_{c}$是中心气压，$p_{e}$是环境气压，$R_{m}$是最大风速半径（RMW），$B$是一个无量纲的形状参数。从梯度风平衡和给定的气压廓线出发，推导$V_{t}(r)$与径向气压梯度$\\partial p/\\partial r$之间的显式关系。然后，将您的结果应用于$r = R_{m}$处，以$V_{\\max} = V_{t}(R_{m})$、$B$、$f$、$R_{m}$、$\\rho$和$p_{e}$的形式求出$p_{c}$，其中$\\rho$是空气密度，$f$是科里奥利参数。\n\n使用以下科学上符合实际的数值：$V_{\\max} = 60\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$，$B = 1.5$，$R_{m} = 30\\,\\mathrm{km}$，$f = 5.0\\times 10^{-5}\\,\\mathrm{s}^{-1}$，$\\rho = 1.15\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$，以及$p_{e} = 1010\\,\\mathrm{hPa}$。根据您推导的表达式计算$p_{c}$的数值。将最终的中心气压以百帕（hPa）为单位表示，并四舍五入到四位有效数字。假设最大切向风发生在$r=R_{m}$处，这与梯度风的意义以及Holland模型中使用$R_{m}$作为最大风速半径是一致的。",
            "solution": "在尝试求解之前，将对问题进行验证。\n\n### 第一步：提取已知条件\n问题提供了以下信息：\n1.  一个理想化的、轴对称的热带气旋，处于稳定、无摩擦的梯度风平衡状态。\n2.  背景设定在一个$f$平面上，科里奥利参数为$f$。\n3.  海平面气压廓线由Holland模型给出：\n    $$p(r) = p_{c} + \\left(p_{e} - p_{c}\\right)\\exp\\!\\left(-\\left(\\frac{R_{m}}{r}\\right)^{B}\\right)$$\n    其中$p(r)$是半径$r$处的气压，$p_c$是中心气压，$p_e$是环境气压，$R_m$是最大风速半径（RMW），$B$是一个无量纲的形状参数。\n4.  切向风表示为$V_t(r)$。\n5.  假设空气密度$\\rho$为常数。\n6.  最大切向风为$V_{\\max} = V_t(R_m)$。\n7.  问题假设最大切向风发生在$r=R_m$处，这符合梯度风的意义。\n8.  提供了数值：$V_{\\max} = 60\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$，$B = 1.5$，$R_{m} = 30\\,\\mathrm{km}$，$f = 5.0\\times 10^{-5}\\,\\mathrm{s}^{-1}$，$\\rho = 1.15\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$，以及$p_{e} = 1010\\,\\mathrm{hPa}$。\n\n### 第二步：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n\n-   **科学依据**：该问题坚实地植根于地球物理流体动力学原理，特别是热带气旋动力学。梯度风平衡是旋转流中径向动量方程的标准和基本近似。Holland气压廓线是一个广泛使用且经过经验验证的参数模型，用于描述飓风中的地表气压场。所有概念在大气科学中都是标准的。所提供的数值对于一个大型热带气旋是物理上符合实际的。\n-   **适定性**：该问题定义明确。它提供了一套清晰的控制方程和假设，并要求进行具体的推导和随后的数值计算。所有必需的参数和常数都已提供。最大风速发生在$r=R_m$的假设简化了问题，并确保可以找到唯一解，而无需进行更复杂的极值分析。\n-   **客观性**：该问题以精确、定量和无偏见的语言陈述。它不含任何主观或推测性内容。\n\n### 第三步：结论与行动\n该问题被认定为有效。它在科学上是合理的，问题是适定的，并且是客观的。将提供解答。\n\n---\n\n对于$f$平面上的轴对称、稳定、无摩擦流动，以柱坐标系$(r, \\theta, z)$表示的径向动量方程即为梯度风平衡方程：\n$$\n\\frac{1}{\\rho}\\frac{\\partial p}{\\partial r} = \\frac{V_{t}^{2}}{r} + fV_{t}\n$$\n此处，$\\frac{1}{\\rho}\\frac{\\partial p}{\\partial r}$是单位质量的径向气压梯度力，$\\frac{V_t^2}{r}$是离心加速度，$fV_t$是科里奥利加速度。\n\n第一个任务是推导$V_t(r)$与径向气压梯度$\\frac{\\partial p}{\\partial r}$之间的显式关系。我们可以将梯度风平衡方程重新排列成一个关于$V_t$的二次方程：\n$$\n\\frac{V_{t}^{2}}{r} + fV_{t} - \\frac{1}{\\rho}\\frac{\\partial p}{\\partial r} = 0\n$$\n两边乘以$r$得到：\n$$\nV_{t}^{2} + (fr)V_{t} - \\frac{r}{\\rho}\\frac{\\partial p}{\\partial r} = 0\n$$\n使用二次公式 $V_t = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$，其中$a=1$，$b=fr$，且$c = -\\frac{r}{\\rho}\\frac{\\partial p}{\\partial r}$，我们得到：\n$$\nV_{t}(r) = \\frac{-fr \\pm \\sqrt{(fr)^{2} + \\frac{4r}{\\rho}\\frac{\\partial p}{\\partial r}}}{2}\n$$\n对于热带气旋（一个低压中心），气压随半径增加，因此$\\frac{\\partial p}{\\partial r} > 0$。在北半球，$f > 0$，并且按照惯例，气旋式切向风速$V_t$为正值。平方根下的项为$\\sqrt{(fr)^2 + \\text{正数项}} > \\sqrt{(fr)^2} = fr$。为确保$V_t > 0$，我们必须选择正根。因此，显式关系为：\n$$\nV_{t}(r) = \\frac{-fr + \\sqrt{(fr)^2 + \\frac{4r}{\\rho}\\frac{\\partial p}{\\partial r}}}{2}\n$$\n第二个任务是求出中心气压$p_c$的表达式。我们首先从Holland廓线计算气压梯度$\\frac{\\partial p}{\\partial r}$：\n$$\np(r) = p_{c} + \\left(p_{e} - p_{c}\\right)\\exp\\!\\left(-\\left(\\frac{R_{m}}{r}\\right)^{B}\\right)\n$$\n使用链式法则对$r$求导：\n$$\n\\frac{\\partial p}{\\partial r} = (p_{e} - p_{c}) \\cdot \\frac{d}{dr} \\left[ \\exp\\left(-R_{m}^{B}r^{-B}\\right) \\right]\n$$\n$$\n\\frac{\\partial p}{\\partial r} = (p_{e} - p_{c}) \\cdot \\exp\\left(-R_{m}^{B}r^{-B}\\right) \\cdot (-R_{m}^{B})(-B r^{-B-1})\n$$\n$$\n\\frac{\\partial p}{\\partial r} = (p_{e} - p_{c}) \\frac{B R_{m}^{B}}{r^{B+1}} \\exp\\left(-\\left(\\frac{R_{m}}{r}\\right)^{B}\\right)\n$$\n问题指出，最大风速$V_{\\max}$发生在最大风速半径处，即$r=R_m$。我们计算该半径处的气压梯度：\n$$\n\\left.\\frac{\\partial p}{\\partial r}\\right|_{r=R_{m}} = (p_{e} - p_{c}) \\frac{B R_{m}^{B}}{R_{m}^{B+1}} \\exp\\left(-\\left(\\frac{R_{m}}{R_{m}}\\right)^{B}\\right) = (p_{e} - p_{c}) \\frac{B}{R_{m}} \\exp(-1)\n$$\n所以，\n$$\n\\left.\\frac{\\partial p}{\\partial r}\\right|_{r=R_{m}} = \\frac{B(p_{e} - p_{c})}{e R_{m}}\n$$\n其中$e$是欧拉数。\n\n现在，我们在$r=R_m$处（此处$V_t=V_{\\max}$）计算梯度风平衡方程：\n$$\n\\left.\\frac{1}{\\rho}\\frac{\\partial p}{\\partial r}\\right|_{r=R_{m}} = \\frac{V_{\\max}^{2}}{R_{m}} + fV_{\\max}\n$$\n$$\n\\left.\\frac{\\partial p}{\\partial r}\\right|_{r=R_{m}} = \\rho\\left(\\frac{V_{\\max}^{2}}{R_{m}} + fV_{\\max}\\right)\n$$\n将$r=R_m$处气压梯度的两个表达式相等：\n$$\n\\frac{B(p_{e} - p_{c})}{e R_{m}} = \\rho\\left(\\frac{V_{\\max}^{2}}{R_{m}} + fV_{\\max}\\right)\n$$\n我们现在求解$p_c$。首先，分离出项$(p_e - p_c)$：\n$$\np_{e} - p_{c} = \\frac{e R_{m} \\rho}{B} \\left(\\frac{V_{\\max}^{2}}{R_{m}} + fV_{\\max}\\right)\n$$\n$$\np_{e} - p_{c} = \\frac{e\\rho}{B} (V_{\\max}^{2} + f R_{m} V_{\\max})\n$$\n最后，求解$p_c$：\n$$\np_{c} = p_{e} - \\frac{e\\rho}{B} (V_{\\max}^{2} + f R_{m} V_{\\max})\n$$\n这就是所求的$p_c$表达式。\n\n现在，我们使用给定的常数计算$p_c$的数值。所有数值都必须使用国际单位制基本单位（米、千克、秒、帕斯卡）。\n-   $V_{\\max} = 60\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$\n-   $B = 1.5$\n-   $R_{m} = 30\\,\\mathrm{km} = 30 \\times 10^{3}\\,\\mathrm{m}$\n-   $f = 5.0\\times 10^{-5}\\,\\mathrm{s}^{-1}$\n-   $\\rho = 1.15\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$\n-   $p_{e} = 1010\\,\\mathrm{hPa} = 1010 \\times 100\\,\\mathrm{Pa} = 101000\\,\\mathrm{Pa}$\n-   $e \\approx 2.71828$\n\n首先，计算括号中的项：\n$$\nV_{\\max}^{2} = (60\\,\\mathrm{m}\\,\\mathrm{s}^{-1})^{2} = 3600\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-2}\n$$\n$$\nf R_{m} V_{\\max} = (5.0\\times 10^{-5}\\,\\mathrm{s}^{-1}) \\cdot (30 \\times 10^{3}\\,\\mathrm{m}) \\cdot (60\\,\\mathrm{m}\\,\\mathrm{s}^{-1}) = 90\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-2}\n$$\n$$\nV_{\\max}^{2} + f R_{m} V_{\\max} = 3600 + 90 = 3690\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-2}\n$$\n现在，计算气压降项 $\\Delta p = \\frac{e\\rho}{B} (V_{\\max}^{2} + f R_{m} V_{\\max})$：\n$$\n\\Delta p = \\frac{e \\cdot (1.15\\,\\mathrm{kg}\\,\\mathrm{m}^{-3})}{1.5} \\cdot (3690\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-2})\n$$\n$$\n\\Delta p \\approx \\frac{2.71828 \\cdot 1.15}{1.5} \\cdot 3690 \\,\\mathrm{Pa} \\approx 2.084015 \\cdot 3690 \\,\\mathrm{Pa} \\approx 7690.015\\,\\mathrm{Pa}\n$$\n最后，计算$p_c$：\n$$\np_c = p_e - \\Delta p = 101000\\,\\mathrm{Pa} - 7690.015\\,\\mathrm{Pa} = 93309.985\\,\\mathrm{Pa}\n$$\n问题要求答案以百帕（hPa）为单位，并四舍五入到四位有效数字。\n$$\np_c = \\frac{93309.985}{100}\\,\\mathrm{hPa} = 933.09985\\,\\mathrm{hPa}\n$$\n四舍五入到四位有效数字得到：\n$$\np_c \\approx 933.1\\,\\mathrm{hPa}\n$$",
            "answer": "$$\n\\boxed{933.1}\n$$"
        },
        {
            "introduction": "热带气旋的强度究竟能达到多大？这个问题的答案深植于热力学和边界层物理之中，将气旋视为一个从温暖海洋中汲取能量的“热机”。本练习将带你探究决定气旋最大风速的物理机制，即海洋能量输入与边界层摩擦耗散之间的平衡。通过对比不同的海气拖曳系数参数化方案，你将分析一个前沿研究领域中的关键问题如何影响气旋的潜势强度预报。",
            "id": "4106233",
            "problem": "考虑一个在水平均匀海洋上方的轴对称、稳态热带气旋，使用整体空气动力学平板边界层模型进行分析。假设以下基本要素，这些要素在热带气旋边界层的数值天气预报和气候模拟中是标准的：\n- 表面动量通量（应力）被参数化为 $\\boldsymbol{\\tau} = \\rho\\, C_{d}(U)\\, U\\, \\boldsymbol{U}$，其中 $\\rho$ 是空气密度，$U$ 是 10 米中性风速大小，$C_{d}(U)$ 是拖曳系数。\n- 表面焓通量为 $Q_{k} = \\rho\\, C_{k}\\, U\\, \\left(k_{s}^{\\ast} - k\\right)$，其中 $C_{k}$ 是焓交换系数，$k_{s}^{\\ast}$ 是海表温度下的饱和湿焓，$k$ 是边界层湿焓。\n- 飓风热机的热力学效率为 $\\epsilon = \\left(T_{s} - T_{o}\\right)/T_{o}$，其中 $T_{s}$ 是海表温度，$T_{o}$ 是对流层上层的代表性流出温度。\n\n在最大风速由边界层中的机械耗散与焓通量产生的卡诺功之间的平衡决定的假设下，使用上述要素从第一性原理推导出一个关于平衡最大 10 米风速 $U_{\\max}$ 的诊断关系式，该关系式用比率 $C_{k}/C_{d}(U_{\\max})$、$T_{s}$、$T_{o}$ 和 $\\left(k_{s}^{\\ast} - k\\right)$ 表示。\n\n现在，通过比较两种参数化方案，评估在非常高的风速下减小拖曳系数 $C_{d}$ 的效应：\n- 基准方案：对于所有 $U$，$C_{d}(U) = C_{d0} + \\alpha\\, U$，其中 $C_{d0} = 1.5 \\times 10^{-3}$ 且 $\\alpha = 2.0 \\times 10^{-5}$。\n- 高风速下减小拖曳的方案：$C_{d}(U) = \\min\\!\\left(C_{d0} + \\alpha\\, U,\\, C_{d,\\mathrm{sat}}\\right)$，其中 $C_{d,\\mathrm{sat}} = 2.2 \\times 10^{-3}$。\n\n在最大风速半径处使用以下热力学参数：\n- 海表温度 (SST) $T_{s} = 302\\,\\mathrm{K}$。\n- 流出温度 $T_{o} = 200\\,\\mathrm{K}$。\n- 湿焓不平衡 $\\left(k_{s}^{\\ast} - k\\right) = 3.0 \\times 10^{4}\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}$。\n- 焓交换系数 $C_{k} = 1.2 \\times 10^{-3}$。\n\n假设平衡最大风速出现在中性、空气动力学粗糙区，并且为此诊断目的，最大梯度风等于最大 10 米中性风。\n\n计算比率 $R \\equiv U_{\\max}^{(\\mathrm{sat})} / U_{\\max}^{(\\mathrm{base})}$，其中 $U_{\\max}^{(\\mathrm{sat})}$ 是高风速下减小拖曳参数化方案下的平衡最大风速，而 $U_{\\max}^{(\\mathrm{base})}$ 是上述基准参数化方案下的平衡最大风速。将您的最终答案 $R$ 四舍五入到四位有效数字。将您的最终答案表示为无量纲数。",
            "solution": "目标是从一个连接边界层耗散和热力学功率的、有物理基础的诊断式中求得 $U_{\\max}$。出发点是单位表面积的机械耗散率与焓通量提供的卡诺功之间的平衡：\n$$\n\\epsilon\\, Q_{k} = D,\n$$\n其中 $Q_{k} = \\rho\\, C_{k}\\, U\\, \\left(k_{s}^{\\ast} - k\\right)$ 是焓通量，$D$ 是边界层中单位表面积的机械耗散率。在整体空气动力学应力参数化下，单位面积的机械能耗散率为\n$$\nD = \\boldsymbol{\\tau} \\cdot \\boldsymbol{U} = \\rho\\, C_{d}(U)\\, U^{3}.\n$$\n热机的热力学效率为\n$$\n\\epsilon = \\frac{T_{s} - T_{o}}{T_{o}}.\n$$\n将卡诺功率率 $\\epsilon\\, Q_{k}$ 与 $D$ 相等，得到\n$$\n\\epsilon\\, \\rho\\, C_{k}\\, U\\, \\left(k_{s}^{\\ast} - k\\right) = \\rho\\, C_{d}(U)\\, U^{3}.\n$$\n消去 $\\rho$ 和一个因子 $U$，得到平衡最大风速的基本诊断式：\n$$\nU_{\\max}^{2} = \\frac{C_{k}}{C_{d}(U_{\\max})}\\, \\epsilon\\, \\left(k_{s}^{\\ast} - k\\right).\n$$\n定义热力学因子\n$$\nA \\equiv \\epsilon\\, \\left(k_{s}^{\\ast} - k\\right) = \\frac{T_{s} - T_{o}}{T_{o}}\\, \\left(k_{s}^{\\ast} - k\\right).\n$$\n那么\n$$\nU_{\\max}^{2} = \\frac{C_{k}}{C_{d}(U_{\\max})}\\, A.\n$$\n\n对于基准参数化方案 $C_{d}(U) = C_{d0} + \\alpha\\, U$，这是一个关于 $U_{\\max}$ 的隐式方程：\n$$\nU_{\\max}^{2}\\, \\left(C_{d0} + \\alpha\\, U_{\\max}\\right) = C_{k}\\, A,\n$$\n它可以写成三次方程\n$$\n\\alpha\\, U_{\\max}^{3} + C_{d0}\\, U_{\\max}^{2} - C_{k}\\, A = 0.\n$$\n对于高风速下减小拖曳的参数化方案，如果解落在 $C_{d}(U) = C_{d,\\mathrm{sat}}$ 的饱和区，则诊断式简化为\n$$\nU_{\\max}^{2} = \\frac{C_{k}}{C_{d,\\mathrm{sat}}}\\, A.\n$$\n自洽性要求所得的 $U_{\\max}$ 超过饱和阈值风速 $U_{t} = \\left(C_{d,\\mathrm{sat}} - C_{d0}\\right)/\\alpha$，我们将在计算出 $U_{\\max}$ 后对此进行检验。\n\n我们现在计算必要的数值。首先，热力学因子 $A$ 是\n$$\nA = \\frac{T_{s} - T_{o}}{T_{o}}\\, \\left(k_{s}^{\\ast} - k\\right) = \\frac{302 - 200}{200}\\, \\left(3.0 \\times 10^{4}\\right) = 0.51 \\times 3.0 \\times 10^{4} = 1.53 \\times 10^{4}.\n$$\n乘以 $C_{k}$，\n$$\nC_{k}\\, A = \\left(1.2 \\times 10^{-3}\\right)\\, \\left(1.53 \\times 10^{4}\\right) = 18.36.\n$$\n\n高风速下减小拖曳的情况（饱和）：\n$$\nU_{\\max}^{(\\mathrm{sat})} = \\sqrt{\\frac{C_{k}\\, A}{C_{d,\\mathrm{sat}}}} = \\sqrt{\\frac{18.36}{2.2 \\times 10^{-3}}} = \\sqrt{8345.454545\\ldots}.\n$$\n计算平方根得到\n$$\nU_{\\max}^{(\\mathrm{sat})} \\approx 91.3535.\n$$\n饱和阈值风速是\n$$\nU_{t} = \\frac{C_{d,\\mathrm{sat}} - C_{d0}}{\\alpha} = \\frac{2.2 \\times 10^{-3} - 1.5 \\times 10^{-3}}{2.0 \\times 10^{-5}} = \\frac{0.7 \\times 10^{-3}}{2.0 \\times 10^{-5}} = 35.\n$$\n因为 $91.3535 > 35$，所以饱和的假设是自洽的。\n\n基准情况（非饱和，对所有 $U$ 均使用线性 $C_{d}(U)$）：求解\n$$\n\\left(2.0 \\times 10^{-5}\\right)\\, U^{3} + \\left(1.5 \\times 10^{-3}\\right)\\, U^{2} - 18.36 = 0.\n$$\n这个三次方程对 $U$ 有一个物理上相关的正根。通过区间限定和细化求解得到\n$$\nU_{\\max}^{(\\mathrm{base})} \\approx 77.5418.\n$$\n这个解在残差上满足三次方程的精度在 $\\mathcal{O}\\!\\left(10^{-4}\\right)$ 以内，对于计算四位有效数字的比率来说是足够的。\n\n最后，计算比率\n$$\nR \\equiv \\frac{U_{\\max}^{(\\mathrm{sat})}}{U_{\\max}^{(\\mathrm{base})}} \\approx \\frac{91.3535}{77.5418} \\approx 1.17812.\n$$\n四舍五入到四位有效数字，\n$$\nR \\approx 1.178.\n$$\n\n对边界层结构的解释：在一个深度为 $h$、科里奥利参数为 $f$ 的稳态平板边界层中，入流角 $\\delta$ 的一个简单诊断式为 $\\delta \\approx \\arctan\\!\\left(\\frac{C_{d}\\, U}{h\\, f}\\right)$，这表明在固定的 $U$下，减小 $C_{d}$ 会减小 $\\delta$（转向更急）。在这个问题中，饱和情况下 $C_{d}$ 的减小会增加 $U$，同时为 $C_{d}$ 设定上限，因此对 $\\delta$ 的净效应取决于乘积 $C_{d}\\, U$。计算出的比率 $R > 1$ 量化了在指定的热力学约束下，由于在高风速时减小 $C_{d}$ 而导致的最大风速增加。",
            "answer": "$$\\boxed{1.178}$$"
        },
        {
            "introduction": "从理论物理模型到实际业务预报，现代气象学越来越多地依赖于统计和机器学习方法，尤其是在处理像热带气旋“快速增强”（RI）这样的复杂、高影响现象时。这个练习将让你扮演预报员和模型开发者的角色，应用一个逻辑回归模型来处理集合预报的输出。你将学习如何将多个物理预测因子转化为一个简洁的概率预报，并计算不同的集合诊断量，这体现了当今数值天气预报中概率化预报的精髓。",
            "id": "4106217",
            "problem": "您将获得一个用于热带气旋在 $48$ 小时内快速增强 (Rapid Intensification, RI) 的二元事件模型。如果 RI 在 $48$ 小时内发生，事件指示符 $Y$ 等于 $1$，否则等于 $0$。假设如下：\n\n- 给定预报因子 $\\mathbf{x} \\in \\mathbb{R}^d$ 时 $Y=1$ 的条件概率由一个带有 logistic 链接函数的伯努利分布建模。具体来说，使用训练时的均值 $\\boldsymbol{\\mu}$ 和标准差 $\\boldsymbol{\\sigma}$ 从原始预报因子 $\\mathbf{x}$ 生成标准化预报因子 $\\mathbf{z}$，线性预报量为\n$$\\eta = \\beta_0 + \\sum_{j=1}^{d} \\beta_j z_j,$$\n其中\n$$z_j = \\frac{x_j - \\mu_j}{\\sigma_j}.$$\n事件概率为\n$$p = \\mathbb{P}(Y=1 \\mid \\mathbf{x}) = \\frac{1}{1 + e^{-\\eta}}.$$\n\n- 对于每个情景（测试用例），您会得到一个包含 $M$ 个成员的集合。每个成员 $k \\in \\{1,\\dots,M\\}$ 提供一个包含 $d$ 个预报因子的向量 $\\mathbf{x}^{(k)}$，这些预报因子在给定环境的条件下被假定为条件独立的。对于每个成员，通过上述模型计算 $p^{(k)}$。\n\n- 根据集合成员概率 $\\{p^{(k)}\\}_{k=1}^{M}$，计算以下三个集合汇总诊断量：\n    1. 集合平均概率：\n    $$\\bar{p} = \\frac{1}{M} \\sum_{k=1}^{M} p^{(k)}.$$\n    2. 在条件独立性假设下，至少一个成员在 $48$ 小时内经历 RI 的概率：\n    $$p_{\\mathrm{any}} = 1 - \\prod_{k=1}^{M} \\left(1 - p^{(k)}\\right).$$\n    3. 个体概率达到或超过决策阈值 $\\tau$ 的成员比例：\n    $$f_{\\ge \\tau} = \\frac{1}{M} \\sum_{k=1}^{M} \\mathbf{1}\\left(p^{(k)} \\ge \\tau\\right).$$\n\n使用以下在一个大型代表性数据集上训练得到的固定模型规格：\n\n- 预报因子维度 $d = 6$，其分量和单位如下：\n    1. 海面温度 (开尔文): $x_1$，单位为 $\\mathrm{K}$。\n    2. 200–850 hPa 深层垂直风切变 (米/秒): $x_2$，单位为 $\\mathrm{m\\,s^{-1}}$。\n    3. 600 hPa 中层相对湿度 (在 $[0,1]$ 内的无量纲分数): $x_3$，单位为 $\\text{分数}$。\n    4. 过去 $24$ 小时强度变化 (米/秒): $x_4$，单位为 $\\mathrm{m\\,s^{-1}}$。\n    5. 潜在强度间隙，定义为 (最大潜在强度减去当前最大持续风速) (米/秒): $x_5$，单位为 $\\mathrm{m\\,s^{-1}}$。\n    6. 在海洋顶层积分的上层海洋热含量 (焦耳/平方米): $x_6$，单位为 $\\mathrm{J\\,m^{-2}}$。\n\n- 标准化参数 (训练均值 $\\boldsymbol{\\mu}$ 和标准差 $\\boldsymbol{\\sigma}$):\n$$\\boldsymbol{\\mu} = \\left[300.0,\\, 10.0,\\, 0.6,\\, 0.0,\\, 10.0,\\, 3.0\\times 10^9\\right],$$\n$$\\boldsymbol{\\sigma} = \\left[1.5,\\, 6.0,\\, 0.15,\\, 3.0,\\, 6.0,\\, 1.5\\times 10^9\\right].$$\n\n- 逻辑回归系数 (截距后跟特征权重):\n$$\\beta_0 = -2.0,$$\n$$(\\beta_1, \\beta_2, \\beta_3, \\beta_4, \\beta_5, \\beta_6) = (0.8,\\, -1.0,\\, 0.7,\\, 0.5,\\, 0.6,\\, 0.4).$$\n\n- 成员级别分类的决策阈值:\n$$\\tau = 0.5.$$\n\n测试套件。对于下方的每个测试用例，您会得到一个包含 $M=5$ 个成员的集合。对于每个成员，向量 $(x_1, x_2, x_3, x_4, x_5, x_6)$ 均以上述单位提供。您的任务是计算 $(\\bar{p}, p_{\\mathrm{any}}, f_{\\ge \\tau})$。这些输出无量纲，必须表示为小数，而不是百分比。\n\n- 测试用例 1 (中等有利环境):\n    - 成员 1: $(301.0,\\, 8.0,\\, 0.65,\\, 1.0,\\, 12.0,\\, 4.0\\times 10^9)$\n    - 成员 2: $(300.5,\\, 9.0,\\, 0.62,\\, 0.0,\\, 11.0,\\, 3.2\\times 10^9)$\n    - 成员 3: $(301.5,\\, 7.0,\\, 0.68,\\, 2.0,\\, 13.0,\\, 4.5\\times 10^9)$\n    - 成员 4: $(299.8,\\, 10.5,\\, 0.58,\\, -1.0,\\, 9.0,\\, 2.8\\times 10^9)$\n    - 成员 5: $(300.2,\\, 8.5,\\, 0.63,\\, 0.5,\\, 10.0,\\, 3.6\\times 10^9)$\n\n- 测试用例 2 (高度有利环境):\n    - 成员 1: $(302.0,\\, 5.0,\\, 0.80,\\, 4.0,\\, 20.0,\\, 6.5\\times 10^9)$\n    - 成员 2: $(302.8,\\, 3.5,\\, 0.85,\\, 5.0,\\, 25.0,\\, 8.0\\times 10^9)$\n    - 成员 3: $(301.8,\\, 4.5,\\, 0.78,\\, 3.0,\\, 18.0,\\, 6.0\\times 10^9)$\n    - 成员 4: $(303.0,\\, 4.0,\\, 0.82,\\, 4.5,\\, 22.0,\\, 7.5\\times 10^9)$\n    - 成员 5: $(302.5,\\, 5.5,\\, 0.76,\\, 3.5,\\, 19.0,\\, 6.8\\times 10^9)$\n\n- 测试用例 3 (不利环境):\n    - 成员 1: $(298.5,\\, 22.0,\\, 0.50,\\, -2.0,\\, 7.0,\\, 1.8\\times 10^9)$\n    - 成员 2: $(299.0,\\, 24.0,\\, 0.52,\\, -3.0,\\, 6.0,\\, 1.5\\times 10^9)$\n    - 成员 3: $(297.8,\\, 28.0,\\, 0.45,\\, -1.0,\\, 5.0,\\, 1.2\\times 10^9)$\n    - 成员 4: $(298.8,\\, 20.0,\\, 0.55,\\, 0.0,\\, 8.0,\\, 2.0\\times 10^9)$\n    - 成员 5: $(299.5,\\, 18.0,\\, 0.58,\\, -0.5,\\, 9.0,\\, 2.2\\times 10^9)$\n\n实现细节:\n\n- 对于每个集合成员，使用提供的 $\\boldsymbol{\\mu}$ 和 $\\boldsymbol{\\sigma}$ 标准化每个预报因子，计算 $\\eta$，然后通过 logistic 函数计算 $p$。在适当情况下，使用数值稳定的 logistic 函数评估方法。\n- 对于每个包含 $M=5$ 个成员的测试用例，按上述定义计算 $\\bar{p}$、$p_{\\mathrm{any}}$ 和 $f_{\\ge \\tau}$。\n- 输出没有物理单位，必须以小数形式呈现，并精确到小数点后 $6$ 位。\n- 最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。每个元素对应一个测试用例，并且本身是包含三个浮点数 $[\\bar{p}, p_{\\mathrm{any}}, f_{\\ge \\tau}]$ 的列表。例如：$[[a_1,b_1,c_1],[a_2,b_2,c_2],[a_3,b_3,c_3]]$。",
            "solution": "该问题被认为是有效的，因为它具有科学依据、提法得当、内容完整且在算法上是可处理的。它展示了逻辑回归模型在热带气旋快速增强 (Rapid Intensification, RI) 这一气象现象的集合预报背景下的标准应用。所有必要的数据，包括模型参数和测试用例，都已提供，并且所需的计算也已明确定义。\n\n解决方案首先通过实现给定的统计模型来计算集合中每个独立成员的 RI 概率。随后，将这些个体概率进行聚合，以计算每个测试用例的三个指定集合汇总诊断量。\n\n基础模型是一个逻辑回归模型，它对二元结果的概率进行建模。事件 $Y=1$ 表示 RI 在 $48$ 小时窗口内发生。该事件的概率 $p = \\mathbb{P}(Y=1 \\mid \\mathbf{x})$，是基于一个包含 $d=6$ 个大气和海洋预报因子的向量 $\\mathbf{x} = (x_1, \\dots, x_6)$ 的条件概率。\n\n首先，将原始预报因子 $\\mathbf{x}$ 标准化为 $\\mathbf{z}$，以确保它们处于可比较的尺度上，这是机器学习中的常见做法。对于每个预报因子 $j$，标准化使用来自训练数据集的均值 $\\mu_j$ 和标准差 $\\sigma_j$：\n$$z_j = \\frac{x_j - \\mu_j}{\\sigma_j}$$\n问题提供了向量 $\\boldsymbol{\\mu} = [\\mu_1, \\dots, \\mu_6]$ 和 $\\boldsymbol{\\sigma} = [\\sigma_1, \\dots, \\sigma_6]$。\n\n接下来，构建这些标准化预报因子的线性组合。这就是线性预报量 $\\eta$：\n$$\\eta = \\beta_0 + \\sum_{j=1}^{d} \\beta_j z_j = \\beta_0 + \\boldsymbol{\\beta} \\cdot \\mathbf{z}$$\n其中 $\\beta_0$ 是截距（偏差），$\\boldsymbol{\\beta} = (\\beta_1, \\dots, \\beta_6)$ 是系数（权重）向量。问题提供了这些系数。每个 $\\beta_j$ 的符号表示预报因子 $z_j$ 与 RI 的对数几率之间关系的方向。例如，垂直风切变的负系数 ($\\beta_2 = -1.0$) 正确地反映了增大的风切变不利于增强。\n\n然后，使用 logistic (或 sigmoid) 函数将线性预报量 $\\eta$ 转换为范围在 $[0, 1]$ 内的概率 $p$：\n$$p = \\frac{1}{1 + e^{-\\eta}}$$\n\n对于每个测试用例，我们都得到一个包含 $M=5$ 个成员的集合。对于每个成员 $k \\in \\{1, \\dots, M\\}$，我们都得到一个预报因子向量 $\\mathbf{x}^{(k)}$。我们应用上述三个步骤来计算每个成员的 RI 概率 $p^{(k)}$。\n\n在获得集合的概率集 $\\{p^{(k)}\\}_{k=1}^{M}$ 之后，我们计算三个所需的汇总诊断量：\n\n1.  集合平均概率 $\\bar{p}$。这表示 RI 的期望概率，是在集合所代表的不确定性上进行平均的结果。\n    $$\\bar{p} = \\frac{1}{M} \\sum_{k=1}^{M} p^{(k)}$$\n\n2.  至少一个成员预报 RI 的概率 $p_{\\mathrm{any}}$。在集合成员条件独立的既定假设下（即，给定其特定的大气状态，每个成员的 RI 结果是独立事件），*没有*成员经历 RI 的概率是每个成员*不*经历 RI 的个体概率的乘积，即 $\\prod_{k=1}^{M} (1 - p^{(k)})$。至少一个成员经历 RI 的概率是该事件的补集。\n    $$p_{\\mathrm{any}} = 1 - \\prod_{k=1}^{M} \\left(1 - p^{(k)}\\right)$$\n\n3.  个体概率达到或超过决策阈值 $\\tau=0.5$ 的成员比例，记为 $f_{\\ge \\tau}$。这是一个衡量集合内部对于高概率事件共识的简单指标。指示函数 $\\mathbf{1}(A)$ 在条件 $A$ 为真时为 $1$，否则为 $0$。\n    $$f_{\\ge \\tau} = \\frac{1}{M} \\sum_{k=1}^{M} \\mathbf{1}\\left(p^{(k)} \\ge \\tau\\right)$$\n\n该算法实现如下：对于三个测试用例中的每一个，我们遍历其 $M=5$ 个成员。对于每个成员的预报因子向量 $\\mathbf{x}^{(k)}$，我们计算标准化的向量 $\\mathbf{z}^{(k)}$，然后是线性预报量 $\\eta^{(k)}$，最后是概率 $p^{(k)}$。这五个概率被存储起来。从这个概率集合中，计算出 $\\bar{p}$、$p_{\\mathrm{any}}$ 和 $f_{\\ge \\tau}$。数值计算使用 `numpy` 库以实现高效的矢量化操作。最后，每个诊断量的结果被格式化为精确到 $6$ 位小数的小数，并构建最终输出字符串以匹配指定的格式 `[[a_1,b_1,c_1],[a_2,b_2,c_2],[a_3,b_3,c_3]]`。",
            "answer": "$[[0.444760,0.923485,0.400000],[0.865961,0.999719,1.000000],[0.043322,0.198909,0.000000]]$"
        }
    ]
}