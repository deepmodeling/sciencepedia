{
    "hands_on_practices": [
        {
            "introduction": "准两年振荡（QBO）从根本上是由从对流层上传的赤道波动驱动的。本练习将引导你构建一个简化的线性波流相互作用模型，以探索波源（对流层加热）的特征与最终平流层振荡之间的物理联系。通过这个练习，你将有机会亲手搭建一个“玩具模型”，捕捉波动产生、传播和动量沉积等关键物理过程，从而深化对QBO机理的理解。",
            "id": "4079911",
            "problem": "考虑一个简化的、有科学依据的线性波-平均流相互作用框架，用以表示对流层对流产生的赤道波强迫如何影响平流层准两年振荡（QBO）的振幅。目标是量化对流层对流加热深度的变化如何改变赤道波的垂直波数谱，并进而改变最终的QBO振幅。\n\n假设以下具有物理动机的分量：\n\n1. 对流层加热和垂直模态：\n   - 对流层顶的高度为 $H_t$。\n   - 对流加热廓线为：当 $0 \\le z \\le H$ 时，$Q(z) = Q_0$；当 $H  z \\le H_t$ 时，$Q(z) = 0$。其中 $H$ 是加热深度，$Q_0$ 是一个常数振幅。\n   - 对流层中的垂直模态由本征函数 $\\phi_n(z) = \\sin\\left(\\frac{n \\pi z}{H_t}\\right)$ 表示，其中整数 $n \\ge 1$。\n   - 加热在这些本征函数上的模态投影系数 $a_n$ 由基本定义给出\n     $$a_n = \\int_0^{H_t} Q(z)\\,\\phi_n(z)\\,dz = Q_0 \\int_0^{H} \\sin\\left(\\frac{n \\pi z}{H_t}\\right)\\,dz = Q_0 \\frac{H_t}{n \\pi}\\left[1 - \\cos\\left(\\frac{n \\pi H}{H_t}\\right)\\right].$$\n\n2. 垂直模态相速和等效深度：\n   - 对于具有近似恒定的浮力频率 $N_t$ 的稳定分层对流层，斜压垂直模态的相速近似为\n     $$c_n = \\frac{N_t H_t}{n \\pi}.$$\n   - 模态 $n$ 的等效深度为 $h_n = \\frac{c_n^2}{g}$，其中 $g$ 是重力加速度。\n   - 考虑两种波动族：\n     - 赤道开尔文波（东传），其纬向相速为 $c_K = c_n$。\n     - 混合罗斯贝-重力波（西传），其纬向相速为 $c_W = \\gamma c_n$，其中固定值 $0  \\gamma  1$。\n\n3. 平流层垂直波数和传播：\n   - 在一个静力、等温的平流层中，其标高为 $H_s$，浮力频率为 $N_s$，忽略水平波数的影响，垂直传播模态的垂直波数近似为\n     $$m_{s,n}^2 = \\frac{N_s^2}{c_s^2} - \\frac{1}{4 H_s^2},$$\n     其中 $c_s$ 是对应波动族（$c_K$ 或 $c_W$）的纬向相速。如果 $m_{s,n}^2 \\le 0$，则该模态是倏逝的，对平流层动量通量沉积没有贡献。\n\n4. 波动动量通量和平均流强迫：\n   - 在对流层顶，对于波动族 $s \\in \\{K,W\\}$ 和模态 $n$，垂直动量通量假定与模态能量通量成正比，\n     $$F_{s0,n} \\propto a_n^2 c_s.$$\n     使用一个相对比例因子 $\\eta$ 来表示混合罗斯贝-重力波相对于开尔文波的强度，即 $F_{W0,n} = \\eta\\, a_n^2 c_W$ 和 $F_{K0,n} = a_n^2 c_K$。\n   - 垂直耗散导致通量随高度 $z$ 指数衰减，表示为\n     $$F_{s,n}(z) = F_{s0,n} \\exp(-\\lambda_{s,n} z), \\quad \\lambda_{s,n} = \\mu\\, m_{s,n},$$\n     其中 $\\mu > 0$ 是一个无量纲常数。\n   - 在高度 $z$ 处，纬向平均流感受到的波阻力由动量通量的辐散给出，\n     $$D_{s,n}(z) = -\\frac{d F_{s,n}}{dz} = \\lambda_{s,n} F_{s0,n} \\exp(-\\lambda_{s,n} z).$$\n     $D_{s,n}$ 的符号反映了动量沉积的方向；将开尔文波阻力视为东向（正），混合罗斯贝-重力波阻力视为西向（负）。\n\n5. 瑞利阻尼下的QBO振幅：\n   - 设高度 $z$ 处的纬向平均流受到速率为 $r$ 的线性瑞利阻尼作用。在交替的东向和西向波强迫阶段之间达到稳定振荡平衡时，$z = z^\\*$ 处的振幅近似为\n     $$U_{\\mathrm{raw}}(z^\\*) = \\frac{1}{r}\\left|\\sum_{n=1}^{N_{\\max}} \\left(D_{K,n}(z^\\*) + D_{W,n}(z^\\*)\\right)\\right|.$$\n   - 为了以物理单位表示结果，通过设置参考加热深度 $H_{\\mathrm{ref}}$ 和在 $z^\\*$ 处的期望参考振幅 $U_{\\mathrm{ref}}$ 来校准一个总比例乘数 $S$，使得\n     $$S = \\frac{U_{\\mathrm{ref}}}{U_{\\mathrm{raw}}(H_{\\mathrm{ref}}, z^\\*)}, \\quad U(z^\\*) = S \\cdot U_{\\mathrm{raw}}(H, z^\\*).$$\n\n6. 垂直波数谱的表征：\n   - 通过以下方式定义在 $z^\\*$ 处每个模态的组合贡献权重\n     $$W_n(z^\\*) = \\left|D_{K,n}(z^\\*)\\right| + \\left|D_{W,n}(z^\\*)\\right|.$$\n   - 对于每个模态 $n$，定义一个有效垂直波数 $m_{\\mathrm{eff},n}$，作为跨波动族的加权平均值，\n     $$m_{\\mathrm{eff},n} = \\frac{\\left|D_{K,n}(z^\\*)\\right|\\, m_{K,n} + \\left|D_{W,n}(z^\\*)\\right|\\, m_{W,n}}{W_n(z^\\*)},$$\n     约定如果 $W_n(z^\\*) = 0$，则该模态不予考虑。\n   - 设 $m_{\\mathrm{peak}}$ 为使 $W_n(z^\\*)$ 最大化的模态 $n$ 所对应的 $m_{\\mathrm{eff},n}$。报告相应的主导垂直波长\n     $$\\lambda_{z,\\mathrm{peak}} = \\frac{2 \\pi}{m_{\\mathrm{peak}}},$$\n     以公里为单位表示。\n\n常数和参数：\n- 重力加速度: $g = 9.81\\,\\mathrm{m/s^2}$。\n- 对流层顶高度: $H_t = 16{,}000\\,\\mathrm{m}$。\n- 对流层浮力频率: $N_t = 0.011\\,\\mathrm{s^{-1}}$。\n- 平流层浮力频率: $N_s = 0.020\\,\\mathrm{s^{-1}}$。\n- 平流层标高: $H_s = 7{,}000\\,\\mathrm{m}$。\n- 混合罗斯贝-重力波的相对速度因子: $\\gamma = 0.6$。\n- 混合罗斯贝-重力波的相对通量比例因子: $\\eta = 0.8$。\n- 耗散常数: $\\mu = 0.25$。\n- 瑞利阻尼率: $r = 1/(30 \\times 86400)\\,\\mathrm{s^{-1}}$。\n- 加热振幅：$Q_0 = 1$（无量纲；被吸收到校准过程中）。\n- 包含的垂直模态数: $N_{\\max} = 10$。\n- 参考高度: $z^\\* = 25{,}000\\,\\mathrm{m}$。\n- 用于校准的参考加热深度和振幅: $H_{\\mathrm{ref}} = 12{,}000\\,\\mathrm{m}$ 和 $U_{\\mathrm{ref}} = 20\\,\\mathrm{m/s}$。\n\n任务：\n- 实现上述公式，为每个测试案例的加热深度 $H$ 计算主导垂直波长 $\\lambda_{z,\\mathrm{peak}}$（单位：公里）和校准后的QBO振幅 $U(z^\\*)$（单位：米/秒）。\n- 如果某个测试案例中所有有贡献的模态都是倏逝的或可忽略不计，以至于没有垂直传播发生，则定义 $\\lambda_{z,\\mathrm{peak}} = 0$ 和 $U(z^\\*) = 0$。\n\n测试案例的加热深度：\n- $H = 1{,}000\\,\\mathrm{m}$ (边缘案例：非常浅的加热)。\n- $H = 4{,}000\\,\\mathrm{m}$ (浅层)。\n- $H = 8{,}000\\,\\mathrm{m}$ (中等深度)。\n- $H = 12{,}000\\,\\mathrm{m}$ (参考深度)。\n- $H = 16{,}000\\,\\mathrm{m}$ (边界案例：全对流层深度)。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。该列表必须按照上面给出的顺序，为每个测试案例交替显示主导垂直波长（公里）和校准后的QBO振幅（米/秒）。例如，输出格式为\n  $[\\lambda_{z,\\mathrm{peak}}(H_1), U(H_1), \\lambda_{z,\\mathrm{peak}}(H_2), U(H_2), \\dots].$\n- 将 $\\lambda_{z,\\mathrm{peak}}$ 以 $\\mathrm{km}$ 为单位表示，保留三位小数；将 $U(z^\\*)$ 以 $\\mathrm{m/s}$ 为单位表示，保留三位小数。",
            "solution": "该问题要求建立一个简化的、一维的模型，以研究对流层对流加热深度与平流层准两年振荡（QBO）特性之间的关系。具体来说，我们必须为一组给定的加热深度计算QBO振幅和波强迫的主导垂直波长。该模型基于线性波理论和已建立的波-平均流相互作用原理。\n\n验证过程证实了该问题具有科学依据、适定且客观。它提供了一整套方程、参数和测试案例。在用于波耗散的垂直坐标定义上存在一个微小歧义。问题将衰减项表述为 $\\exp(-\\lambda_{s,n} z)$，其中 $z$ 是高度。一个更标准的物理公式会使用对流层顶以上的高度，即 $z-H_t$。然而，为了严格遵守所给出的公式，我们将按照问题陈述，将 $z$ 解释为绝对高度，$z = z^\\*$。\n\n该解决方案是通过对每个指定的加热深度 $H$ 执行以下计算序列来构建的。\n\n1.  **加热的模态投影 ($a_n$)**：\n    将对流层加热廓线 $Q(z)$ 投影到垂直模态 $\\phi_n(z) = \\sin\\left(\\frac{n \\pi z}{H_t}\\right)$ 上。投影系数 $a_n$ 代表每个垂直模态 $n$ 的强迫强度。它们由以下公式给出：\n    $$a_n = Q_0 \\frac{H_t}{n \\pi}\\left[1 - \\cos\\left(\\frac{n \\pi H}{H_t}\\right)\\right]$$\n    我们将使用给定的无量纲加热振幅 $Q_0 = 1$ 和对流层顶高度 $H_t = 16{,}000\\,\\mathrm{m}$，对从 $n = 1$ 到 $N_{\\max} = 10$ 的每个模态进行计算。\n\n2.  **波动相速 ($c_{s,n}$)**：\n    每个垂直模态 $n$ 都与对流层中的一个垂直模态相速 $c_n$ 相关联。这对应于进入平流层的赤道波的水平纬向相速。\n    $$c_n = \\frac{N_t H_t}{n \\pi}$$\n    其中 $N_t = 0.011\\,\\mathrm{s^{-1}}$ 是对流层浮力频率。所考虑的两种波动族是：\n    -   开尔文波（东传）：$c_{K,n} = c_n$。\n    -   混合罗斯贝-重力（MRG）波（西传）：$c_{W,n} = \\gamma c_n$，其中 $\\gamma = 0.6$。\n\n3.  **平流层垂直波数 ($m_{s,n}$)**：\n    为了使波能够垂直传播到平流层，其垂直波数必须为实数。垂直波数的平方 $m_{s,n}^2$ 由波的纬向相速 $c_s$ 和平流层特性（浮力频率 $N_s = 0.020\\,\\mathrm{s^{-1}}$ 和标高 $H_s = 7{,}000\\,\\mathrm{m}$）决定。\n    $$m_{s,n}^2 = \\frac{N_s^2}{c_s^2} - \\frac{1}{4 H_s^2}$$\n    如果 $m_{s,n}^2 \\le 0$，则该模态是倏逝的且不传播，因此它对平流层中的动量沉积没有贡献。对于传播模态（$m_{s,n}^2 > 0$），垂直波数为 $m_{s,n} = \\sqrt{m_{s,n}^2}$。\n\n4.  **波驱动的平均流强迫（阻力, $D_{s,n}$)**：\n    波携带的动量沉积在平流层中，从而驱动平均流。在对流层顶的垂直动量通量 $F_{s0,n}$ 与模态能量成正比。\n    $$F_{K0,n} = a_n^2 c_{K,n}$$\n    $$F_{W0,n} = \\eta\\, a_n^2 c_{W,n}$$\n    其中 $\\eta = 0.8$ 表示MRG波强迫的相对强度。由于耗散，该通量随高度呈指数衰减。耗散率为 $\\lambda_{s,n} = \\mu\\, m_{s,n}$，其中 $\\mu = 0.25$。高度 $z$ 处的通量为 $F_{s,n}(z) = F_{s0,n} \\exp(-\\lambda_{s,n} z)$。在参考高度 $z^\\* = 25{,}000\\,\\mathrm{m}$ 处的阻力（单位高度的动量沉积）是通量的垂直辐散：\n    $$D_{s,n}(z^\\*) = -\\frac{d F_{s,n}}{dz}\\bigg|_{z=z^\\*} = \\lambda_{s,n} F_{s0,n} \\exp(-\\lambda_{s,n} z^\\*)$$\n    按照惯例，开尔文波沉积东向（正）动量，而MRG波沉积西向（负）动量。我们通过将 $D_{K,n}$ 取为正值，并将MRG波的贡献定义为 $-D_{W,n}$ 来应用这一点。对于倏逝模态，$m_{s,n} = 0$，因此 $\\lambda_{s,n} = 0$，阻力 $D_{s,n}(z^\\*) = 0$。\n\n5.  **QBO振幅 ($U(z^\\*)$)**：\n    QBO的振幅是通过假设净波动强迫与速率为 $r = 1/(30 \\times 86400)\\,\\mathrm{s^{-1}}$ 的线性瑞利阻尼之间达到平衡来估计的。原始振幅为：\n    $$U_{\\mathrm{raw}}(H, z^\\*) = \\frac{1}{r}\\left|\\sum_{n=1}^{N_{\\max}} \\left(D_{K,n}(z^\\*) - D_{W,n}(z^\\*)\\right)\\right|$$\n    该模型使用一个参考案例（$H_{\\mathrm{ref}} = 12{,}000\\,\\mathrm{m}$，$U_{\\mathrm{ref}} = 20\\,\\mathrm{m/s}$）进行校准。比例因子为 $S = U_{\\mathrm{ref}} / U_{\\mathrm{raw}}(H_{\\mathrm{ref}}, z^\\*)$。对于任何加热深度 $H$，校准后的振幅则为：\n    $$U(z^\\*) = S \\cdot U_{\\mathrm{raw}}(H, z^\\*)$$\n\n6.  **主导垂直波长 ($\\lambda_{z,\\mathrm{peak}}$)**：\n    为了表征波强迫的垂直尺度，我们确定主导垂直波长。首先，我们找到在 $z^\\*$ 处每个模态的贡献权重：\n    $$W_n(z^\\*) = |D_{K,n}(z^\\*)| + |D_{W,n}(z^\\*)| = D_{K,n}(z^\\*) + D_{W,n}(z^\\*)$$\n    模态 $n_{\\mathrm{peak}}$ 是使 $W_n(z^\\*)$ 最大化的那个。此峰值模态的有效垂直波数是开尔文波和MRG波波数的加权平均值：\n    $$m_{\\mathrm{peak}} = m_{\\mathrm{eff},n_{\\mathrm{peak}}} = \\frac{D_{K,n_{\\mathrm{peak}}}(z^\\*) m_{K,n_{\\mathrm{peak}}} + D_{W,n_{\\mathrm{peak}}}(z^\\*) m_{W,n_{\\mathrm{peak}}}}{W_{n_{\\mathrm{peak}}}(z^\\*)}$$\n    主导垂直波长则为 $\\lambda_{z,\\mathrm{peak}} = 2\\pi / m_{\\mathrm{peak}}$。如果所有模态都是倏逝的或其贡献可以忽略不计，我们设定 $\\lambda_{z,\\mathrm{peak}} = 0$ 和 $U(z^\\*) = 0$。\n\n计算过程首先涉及为参考案例 $H_{\\mathrm{ref}}$ 计算 $U_{\\mathrm{raw}}$ 以找到比例因子 $S$。然后，对于测试集中的每个加热深度 $H$，我们计算 $U_{\\mathrm{raw}}(H, z^\\*)$ 和 $\\lambda_{z,\\mathrm{peak}}(H, z^\\*)$，最后应用比例因子 $S$ 得到校准后的振幅 $U(H, z^\\*)$。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of calculating QBO amplitude and dominant vertical wavelength\n    based on a simplified wave-mean flow interaction model.\n    \"\"\"\n\n    # Constants and parameters from the problem statement\n    G = 9.81  # Gravitational acceleration, m/s^2\n    H_T = 16000.0  # Tropospheric top height, m\n    N_T = 0.011  # Tropospheric buoyancy frequency, s^-1\n    N_S = 0.020  # Stratospheric buoyancy frequency, s^-1\n    H_S = 7000.0  # Stratospheric scale height, m\n    GAMMA = 0.6  # Relative speed factor for MRG waves\n    ETA = 0.8  # Relative flux scaling for MRG waves\n    MU = 0.25  # Dissipation constant\n    R_DAMP = 1.0 / (30.0 * 86400.0)  # Rayleigh damping rate, s^-1\n    Q0 = 1.0  # Heating amplitude (non-dimensional)\n    N_MAX = 10  # Number of vertical modes\n    Z_STAR = 25000.0  # Reference level, m\n    H_REF = 12000.0  # Reference heating depth for calibration, m\n    U_REF = 20.0  # Reference QBO amplitude for calibration, m/s\n\n    # Test suite of heating depths\n    test_cases_H = [1000.0, 4000.0, 8000.0, 12000.0, 16000.0]\n\n    def compute_model_outputs(H):\n        \"\"\"\n        Computes the raw QBO amplitude and dominant vertical wavelength for a given heating depth H.\n        \"\"\"\n        n = np.arange(1, N_MAX + 1)\n        \n        # 1. Modal projection coefficients (a_n)\n        cos_term = np.cos(n * np.pi * H / H_T)\n        a_n = Q0 * (H_T / (n * np.pi)) * (1.0 - cos_term)\n\n        # 2. Wave phase speeds (c_n, c_K, c_W)\n        c_n = (N_T * H_T) / (n * np.pi)\n        c_k = c_n\n        c_w = GAMMA * c_n\n        \n        # 3. Stratospheric vertical wavenumbers (m_s,n)\n        m_sq_k = (N_S**2 / c_k**2) - (1.0 / (4.0 * H_S**2))\n        m_sq_w = (N_S**2 / c_w**2) - (1.0 / (4.0 * H_S**2))\n        \n        # Set m to 0 for evanescent modes (m_sq = 0)\n        m_k = np.sqrt(np.maximum(0, m_sq_k))\n        m_w = np.sqrt(np.maximum(0, m_sq_w))\n\n        # 4. Wave drag (D_s,n)\n        # Tropopause flux\n        F0_k = a_n**2 * c_k\n        F0_w = ETA * a_n**2 * c_w\n        \n        # Dissipation rate\n        lambda_k = MU * m_k\n        lambda_w = MU * m_w\n\n        # Drag magnitudes\n        # Note: If m=0, then lambda=0, and D=0 automatically.\n        D_k = lambda_k * F0_k * np.exp(-lambda_k * Z_STAR)\n        D_w = lambda_w * F0_w * np.exp(-lambda_w * Z_STAR)\n        \n        # 5. Raw QBO amplitude (U_raw)\n        # Total drag sum: D_k is positive (eastward), D_w is negative (westward)\n        total_drag = np.sum(D_k - D_w)\n        U_raw = (1.0 / R_DAMP) * np.abs(total_drag)\n        \n        # 6. Dominant vertical wavelength (lambda_z,peak)\n        # Contribution weights\n        W_n = D_k + D_w # Since D_k and D_w are magnitudes of drag contributions\n        \n        if np.sum(W_n) == 0:\n            lambda_z_peak_km = 0.0\n        else:\n            n_peak_idx = np.argmax(W_n)\n            D_k_peak = D_k[n_peak_idx]\n            D_w_peak = D_w[n_peak_idx]\n            m_k_peak = m_k[n_peak_idx]\n            m_w_peak = m_w[n_peak_idx]\n            W_n_peak = W_n[n_peak_idx]\n            \n            # Effective vertical wavenumber for the peak mode\n            if W_n_peak  0:\n                m_eff_peak = (D_k_peak * m_k_peak + D_w_peak * m_w_peak) / W_n_peak\n            else: # Should not happen if sum(W_n)  0, but for safety\n                m_eff_peak = 0\n            \n            if m_eff_peak  0:\n                lambda_z_peak = (2.0 * np.pi) / m_eff_peak\n                lambda_z_peak_km = lambda_z_peak / 1000.0  # Convert to km\n            else:\n                lambda_z_peak_km = 0.0\n\n        return U_raw, lambda_z_peak_km\n\n    # Calibration step\n    U_raw_ref, _ = compute_model_outputs(H_REF)\n    if U_raw_ref  0:\n        S = U_REF / U_raw_ref\n    else:\n        # Handles case where reference calculation yields zero amplitude\n        S = 0.0 \n\n    results = []\n    for H in test_cases_H:\n        U_raw, lambda_z_peak_km = compute_model_outputs(H)\n        \n        # Apply calibration\n        U_calibrated = S * U_raw\n        \n        # Handle the edge case for both outputs\n        if U_calibrated == 0:\n            lambda_z_peak_km = 0.0\n\n        results.append(f\"{lambda_z_peak_km:.3f}\")\n        results.append(f\"{U_calibrated:.3f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在概念上理解了波动强迫的物理过程后，下一步是掌握如何在实际的数值模式中诊断和量化这种强迫。本练习聚焦于Eliassen-Palm（EP）通量散度，这是波流相互作用分析中的一个关键诊断量。你将研究该诊断量的计算精度如何依赖于模式的垂直分辨率，这是数值建模中的一个基本挑战。",
            "id": "4079907",
            "problem": "考虑一个垂直变化的纬向平均埃利亚森-帕尔姆（EP）通量，该量在数值天气预报和气候模拟中与准两年周期振荡（QBO）的表示以及平流层突然增温（SSW）相关。\n\n目标诊断量是出现在转换欧拉平均的纬向平均加速度中的垂直EP通量散度，此处写作密度加权动量通量的负垂直导数，即 $-\\partial_z\\!\\left(\\rho_0 \\,\\overline{u'w'}\\right)$，其中 $\\rho_0$ 是背景密度，$\\overline{u'w'}$ 是纬向平均涡动动量通量。\n\n您将处理一个在区域 $z \\in [0,H]$（其中 $H = 40000\\,\\mathrm{m}$）上按如下方式构建的理想化解析垂直廓线。背景密度为 $\\rho_0(z) = \\rho_s \\exp(-z/H_s)$，其中 $\\rho_s = 1.2\\,\\mathrm{kg\\,m^{-3}}$ 且 $H_s = 7000\\,\\mathrm{m}$。涡动动量通量由两个高斯分量之和给出，用以模拟赤道平流层内垂直局地化的重力波动量通量沉积：\n$$\\overline{u'w'}(z) = A_1 \\exp\\!\\left(-\\frac{(z-z_1)^2}{2\\sigma_1^2}\\right) - A_2 \\exp\\!\\left(-\\frac{(z-z_2)^2}{2\\sigma_2^2}\\right).$$\n定义 $F(z) = \\rho_0(z)\\,\\overline{u'w'}(z)$ 和真实诊断量 $g(z) = -\\frac{dF}{dz}$。符号的选择与常规的波-平均流相互作用强迫项一致。\n\n您的任务是通过以下方式评估诊断出的 $g(z)$ 对垂直分辨率的敏感性：\n- 在 $[0,H]$ 范围内的均匀网格上构建高分辨率参考场 $F(z)$，网格间距为 $\\Delta z_{\\mathrm{hr}} = 100\\,\\mathrm{m}$，\n- 通过计算以粗网格中点为中心的每个粗网格层内 $F(z)$ 的层平均值，将 $F(z)$ 粗化到一组间距为 $\\Delta z$ 的粗网格上，\n- 对粗化后的廓线应用中心差分，以近似计算内部粗网格中点处的 $g(z)$，\n- 利用在粗网格中点处求值的 $F(z)$ 的解析三阶导数，通过导数近似的泰勒级数主阶项来量化中心差分算子的截断误差，\n- 报告与解析真值相比的数值误差。\n\n使用的基本假设和事实：\n- 密度廓线 $\\rho_0(z)$ 是指数形式，具有恒定的标高，因此其各阶导数都是解析的。\n- $\\overline{u'w'}(z)$ 的每个高斯分量都具有任意阶的解析导数。\n- 对于一个足够光滑的函数，其一阶导数的中心差分近似存在一个二阶截断误差，该误差可通过在求值点进行泰勒级数展开得到。\n- 层平均粗化是通过对以粗网格中点为中心的、厚度为 $\\Delta z$ 的每个粗网格层上的 $F(z)$ 进行平均来执行的。\n\n在程序中实现以下步骤：\n1. 生成高分辨率网格 $z_k = k\\,\\Delta z_{\\mathrm{hr}}$，其中 $k=0,1,\\dots,\\lfloor H/\\Delta z_{\\mathrm{hr}} \\rfloor$。\n2. 在高分辨率网格上解析地计算 $F(z)$。\n3. 对于给定的粗网格间距 $\\Delta z$，构建粗网格中点 $z_i^{(c)} = \\Delta z/2 + i\\,\\Delta z$（其中 $i$ 为整数，使得 $z_i^{(c)} \\in [\\Delta z/2, H - \\Delta z/2]$），并利用高分辨率样本，通过在区间 $[z_i^{(c)}-\\Delta z/2, z_i^{(c)}+\\Delta z/2]$ 上对 $F(z)$ 进行平均，计算层平均值 $F_i^{(c)}$。\n4. 在内部粗网格中点 $z_i^{(c)}$（其中 $i=1,\\dots,N_c-2$）处，计算 $g(z)$ 的中心差分近似：\n$$g_{\\mathrm{cd}}(z_i^{(c)}) = -\\frac{F^{(c)}_{i+1} - F^{(c)}_{i-1}}{2\\,\\Delta z}.$$\n5. 通过解析地对 $F(z)$ 求导，并在相同的内部粗网格中点上求值，来计算解析真值 $g_{\\mathrm{true}}(z_i^{(c)})$。\n6. 使用 $F(z)$ 的解析三阶导数和粗网格间距 $\\Delta z$，在 $z_i^{(c)}$ 处计算 $F(z)$ 中心差分导数的泰勒级数展开式中的主阶截断项；用此项计算每个内部粗网格中点上 $g_{\\mathrm{cd}}$ 误差的预测截断贡献。\n7. 对于每个粗网格间距和参数集，计算并报告两个浮点数：\n   - 在所有内部粗网格中点上，绝对差 $\\left|g_{\\mathrm{cd}} - g_{\\mathrm{true}}\\right|$ 的均方根（RMS），\n   - 在所有内部粗网格中点上，主阶截断项绝对值的均方根（RMS）。\n\n所有涉及力的物理量必须以 $\\mathrm{N\\,m^{-3}}$ 表示，距离以 $\\mathrm{m}$ 表示。不涉及角度。将每个RMS报告为浮点数。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个元素对应一个测试用例，并且本身是一个双元素列表 $[\\mathrm{RMS}_{\\mathrm{true}}, \\mathrm{RMS}_{\\mathrm{trunc}}]$。\n\n测试套件。使用以下四个测试用例，每个用例由元组 $(\\Delta z, A_1, z_1, \\sigma_1, A_2, z_2, \\sigma_2)$ 指定：\n- 用例 1： $(1000,\\,0.12,\\,20000,\\,4000,\\,0.09,\\,28000,\\,5000)$。\n- 用例 2： $(2000,\\,0.10,\\,18000,\\,2500,\\,0.08,\\,25000,\\,2000)$。\n- 用例 3： $(5000,\\,0.11,\\,22000,\\,4000,\\,0.07,\\,30000,\\,3000)$。\n- 用例 4： $(8000,\\,0.10,\\,21000,\\,1500,\\,0.09,\\,27000,\\,1200)$。\n\n您的程序必须实现以上步骤，计算每个用例在所有内部粗网格中点上的两个RMS指标，并打印形式为\n$[[r_1,t_1],[r_2,t_2],[r_3,t_3],[r_4,t_4]]$ 的单行输出，其中每个 $r_i$ 和 $t_i$ 都是以 $\\mathrm{N\\,m^{-3}}$ 为单位的浮点数。",
            "solution": "问题陈述已经过严格验证，被认为是内容自洽、科学上合理且良定的。任务是分析埃利亚森-帕尔姆（EP）通量垂直散度的数值近似误差，这是大气动力学中理解波-平均流相互作用的一个关键诊断量。问题提供了一个密度加权动量通量 $F(z)$ 垂直廓线的理想化解析模型，并要求将其负导数 $g(z) = -dF/dz$ 的数值近似与解析真值进行比较。误差分析涉及将中心有限差分格式应用于层平均场，并计算理论截断误差项。\n\n解决方案遵循问题陈述中概述的步骤。首先，我们建立函数 $F(z)$ 及其相关导数的解析形式。函数 $F(z)$ 定义为指数密度廓线 $\\rho_0(z) = \\rho_s \\exp(-z/H_s)$ 和涡动动量通量廓线 $\\overline{u'w'}(z)$（即两个高斯函数之和）的乘积。\n$$F(z) = \\rho_0(z) \\, \\overline{u'w'}(z) = \\rho_s e^{-z/H_s} \\left( A_1 e^{-\\frac{(z-z_1)^2}{2\\sigma_1^2}} - A_2 e^{-\\frac{(z-z_2)^2}{2\\sigma_2^2}} \\right)$$\n$F(z)$ 是两个形如 $P_j(z) = \\exp(-z/H_s) \\exp\\left(-\\frac{(z-z_j)^2}{2\\sigma_j^2}\\right)$ 的项的线性组合。设指数的参数为 $h_j(z) = -z/H_s - (z-z_j)^2/(2\\sigma_j^2)$。则 $P_j(z) = \\exp(h_j(z))$。\n\n主要诊断量是真实强迫项 $g_{\\mathrm{true}}(z) = -dF/dz = -F'(z)$。使用链式法则，可以系统地计算出 $P_j(z)$ 的导数。\n$h_j(z)$ 对 $z$ 的一阶导数是：\n$$h'_j(z) = \\frac{d}{dz}\\left(-\\frac{z}{H_s} - \\frac{(z-z_j)^2}{2\\sigma_j^2}\\right) = -\\frac{1}{H_s} - \\frac{z-z_j}{\\sigma_j^2}$$\n因此，$P_j(z)$ 的一阶导数是 $P'_j(z) = h'_j(z) P_j(z)$。解析诊断量则为：\n$$g_{\\mathrm{true}}(z) = -F'(z) = -\\rho_s \\left( A_1 P'_1(z) - A_2 P'_2(z) \\right) = -\\rho_s \\left( A_1 h'_1(z) P_1(z) - A_2 h'_2(z) P_2(z) \\right)$$\n\n第二个任务是计算一阶导数中心差分近似的主阶截断误差项。该项由 $\\frac{(\\Delta z)^2}{6} F'''(z)$ 给出，其中 $\\Delta z$ 是粗网格间距。为了计算这个值，我们需要 $F(z)$ 的三阶导数。我们再次求通用项 $P_j(z)$ 的三阶导数。$h_j(z)$ 的导数为 $h''_j(z) = -1/\\sigma_j^2$ 和 $h'''_j(z) = 0$。\n复合函数 $P(z) = \\exp(h(z))$ 的三阶导数由下式给出：\n$$P'''(z) = \\left( h'''(z) + 3h'(z)h''(z) + (h'(z))^3 \\right) P(z)$$\n代入 $h_j(z)$ 的导数表达式：\n$$P'''_j(z) = \\left( 3\\left(-\\frac{1}{H_s} - \\frac{z-z_j}{\\sigma_j^2}\\right)\\left(-\\frac{1}{\\sigma_j^2}\\right) + \\left(-\\frac{1}{H_s} - \\frac{z-z_j}{\\sigma_j^2}\\right)^3 \\right) P_j(z)$$\n$$P'''_j(z) = h'_j(z) \\left( (h'_j(z))^2 + 3h''_j(z) \\right) P_j(z)$$\n$F(z)$ 的三阶导数则为 $F'''(z) = \\rho_s \\left( A_1 P'''_1(z) - A_2 P'''_2(z) \\right)$。需要计算的主阶截断项是 $E_T(z) = \\frac{(\\Delta z)^2}{6}F'''(z)$。\n\n数值实现过程如下：\n1. 在域 $[0, H]$ 上创建一个间距为 $\\Delta z_{\\mathrm{hr}} = 100\\,\\mathrm{m}$ 的高分辨率网格 $z_{\\mathrm{hr}}$。在该网格上计算解析函数 $F(z)$，得到高分辨率廓线 $F_{\\mathrm{hr}}$。\n2. 对每个测试用例，定义一个间距为 $\\Delta z$ 的粗网格。粗网格由宽度为 $\\Delta z$ 的单元格组成，中点为 $z_i^{(c)}$。\n3. 通过层平均对高分辨率廓线 $F_{\\mathrm{hr}}$ 进行粗化。由于在所有测试用例中 $\\Delta z$ 都是 $\\Delta z_{\\mathrm{hr}}$ 的整数倍，因此可以高效地完成此操作。我们将高分辨率单元格 $[z_k, z_{k+1}]$ 中的平均值建模为 $(F(z_k) + F(z_{k+1}))/2$，这等同于梯形积分法则。粗单元格上的平均值则是这些单元格中点值的平均值。这样就得到了粗网格廓线 $F^{(c)}$。\n4. 在粗网格的内部点上，使用二阶中心有限差分公式计算数值诊断量 $g_{\\mathrm{cd}}$：$g_{\\mathrm{cd}}(z_i^{(c)}) = -(F^{(c)}_{i+1} - F^{(c)}_{i-1})/(2\\Delta z)$。\n5. 在相同的内部粗网格点上计算 $g_{\\mathrm{true}}(z)$ 和截断项 $E_T(z)$ 的解析表达式。\n6. 最后，在这些内部点上计算两个均方根（RMS）指标：\n   - $\\mathrm{RMS}_{\\mathrm{true}} = \\sqrt{\\frac{1}{N} \\sum_{i} (g_{\\mathrm{cd}}(z_i^{(c)}) - g_{\\mathrm{true}}(z_i^{(c)}))^2}$\n   - $\\mathrm{RMS}_{\\mathrm{trunc}} = \\sqrt{\\frac{1}{N} \\sum_{i} (E_T(z_i^{(c)}))^2}$\n为每个测试用例报告这两个值。\n此过程允许将实际数值误差与其主阶理论估计进行直接比较，从而突显网格分辨率对一个关键大气诊断量准确性的影响。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of evaluating the sensitivity of a diagnosed atmospheric forcing\n    to vertical grid resolution.\n    \"\"\"\n    \n    # Global constants\n    H = 40000.0  # Domain height in m\n    rho_s = 1.2  # Surface density in kg m^-3\n    H_s = 7000.0  # Density scale height in m\n    dz_hr = 100.0  # High-resolution grid spacing in m\n\n    # Test suite: (dz, A1, z1, sigma1, A2, z2, sigma2)\n    test_cases = [\n        (1000.0, 0.12, 20000.0, 4000.0, 0.09, 28000.0, 5000.0),\n        (2000.0, 0.10, 18000.0, 2500.0, 0.08, 25000.0, 2000.0),\n        (5000.0, 0.11, 22000.0, 4000.0, 0.07, 30000.0, 3000.0),\n        (8000.0, 0.10, 21000.0, 1500.0, 0.09, 27000.0, 1200.0),\n    ]\n\n    # --- high-resolution grid setup ---\n    num_pts_hr = int(H / dz_hr) + 1\n    z_hr = np.linspace(0.0, H, num_pts_hr)\n\n    def P_and_derivatives(z, z_j, sigma_j):\n        \"\"\"\n        Computes the combined exponential-Gaussian term P_j(z) and quantities\n        needed for its derivatives.\n        \"\"\"\n        P_j = np.exp(-z / H_s) * np.exp(-((z - z_j)**2) / (2 * sigma_j**2))\n        \n        # h'(z) term\n        h_prime_j = -1.0 / H_s - (z - z_j) / (sigma_j**2)\n        \n        # h''(z) term\n        h_double_prime_j = -1.0 / (sigma_j**2)\n        \n        return P_j, h_prime_j, h_double_prime_j\n\n    def F_analytic(z, A1, z1, sigma1, A2, z2, sigma2):\n        \"\"\"Computes the analytic function F(z).\"\"\"\n        P1, _, _ = P_and_derivatives(z, z1, sigma1)\n        P2, _, _ = P_and_derivatives(z, z2, sigma2)\n        return rho_s * (A1 * P1 - A2 * P2)\n\n    def g_true_analytic(z, A1, z1, sigma1, A2, z2, sigma2):\n        \"\"\"Computes the analytic diagnostic g_true(z) = -F'(z).\"\"\"\n        P1, h_prime_1, _ = P_and_derivatives(z, z1, sigma1)\n        P2, h_prime_2, _ = P_and_derivatives(z, z2, sigma2)\n        F_prime = rho_s * (A1 * h_prime_1 * P1 - A2 * h_prime_2 * P2)\n        return -F_prime\n\n    def F_triple_prime_analytic(z, A1, z1, sigma1, A2, z2, sigma2):\n        \"\"\"Computes the analytic third derivative F'''(z).\"\"\"\n        P1, h_prime_1, h_double_prime_1 = P_and_derivatives(z, z1, sigma1)\n        P2, h_prime_2, h_double_prime_2 = P_and_derivatives(z, z2, sigma2)\n        \n        P_triple_prime_1 = (h_prime_1**3 + 3 * h_prime_1 * h_double_prime_1) * P1\n        P_triple_prime_2 = (h_prime_2**3 + 3 * h_prime_2 * h_double_prime_2) * P2\n        \n        return rho_s * (A1 * P_triple_prime_1 - A2 * P_triple_prime_2)\n\n    results = []\n    for case in test_cases:\n        dz, A1, z1, sigma1, A2, z2, sigma2 = case\n\n        # --- Evaluate F on high-resolution grid ---\n        F_hr = F_analytic(z_hr, A1, z1, sigma1, A2, z2, sigma2)\n\n        # --- Coarsening by layer-averaging ---\n        num_coarse_cells = int(H / dz)\n        pts_per_cell = int(dz / dz_hr)\n        \n        # Use trapezoidal rule on high-res intervals for better accuracy\n        F_hr_mid = (F_hr[:-1] + F_hr[1:]) / 2.0\n        \n        # Reshape and average to get coarse-grained F\n        F_c = F_hr_mid.reshape(num_coarse_cells, pts_per_cell).mean(axis=1)\n\n        # --- Define coarse grid and interior points ---\n        z_c = np.arange(dz / 2.0, H, dz)\n        z_c_interior = z_c[1:-1]\n        \n        # --- Compute numerical derivative g_cd ---\n        g_cd = -(F_c[2:] - F_c[:-2]) / (2 * dz)\n\n        # --- Evaluate analytic truth and truncation term on interior coarse grid ---\n        g_true_on_c_interior = g_true_analytic(z_c_interior, A1, z1, sigma1, A2, z2, sigma2)\n        F_ppp_on_c_interior = F_triple_prime_analytic(z_c_interior, A1, z1, sigma1, A2, z2, sigma2)\n        \n        lead_trunc_term = (dz**2 / 6.0) * F_ppp_on_c_interior\n\n        # --- Compute RMS metrics ---\n        rms_true_error = np.sqrt(np.mean((g_cd - g_true_on_c_interior)**2))\n        rms_trunc_term = np.sqrt(np.mean(lead_trunc_term**2))\n        \n        results.append([rms_true_error, rms_trunc_term])\n\n    # --- Format and print final output ---\n    output_str = \"[\" + \",\".join([f\"[{r[0]},{r[1]}]\" for r in results]) + \"]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "在数值模式中，对波动的精确模拟不仅取决于空间分辨率，还与时间积分方案密切相关。本练习将检验Robert-Asselin滤波器（一种常用于维持数值稳定性的工具）对驱动QBO的物理波动的影响。通过计算，你将能够量化这类数值方法引入的非预期阻尼，并评估其对QBO模拟的重要性。",
            "id": "4079935",
            "problem": "考虑一个有助于维持平流层低层准两年期振荡 (QBO) 切变极值的线性、单频、赤道俘获波分量。假设代表波在离散模型时间点振幅的预报变量随时间以纯正弦形式演变，即 $x^{n} = A \\exp(i \\omega n \\Delta t)$，其中角频率为 $\\omega$，$n$ 是整数时间指数，$\\Delta t$ 是基于蛙跃格式的数值天气预报方案的固定时间步长。为抑制计算模，该模型在每个时间步对中心时间层应用系数为 $\\nu$ 的 Robert–Asselin (RA) 滤波器，定义为\n$$\nx^{n} \\leftarrow x^{n} + \\nu \\left(x^{n+1} - 2 x^{n} + x^{n-1}\\right).\n$$\n假设在应用 RA 滤波器的过程中，物理波模随时间保持正弦形式。将滤波器对物理模引起的每步有效振幅因子定义为 $F(\\omega \\Delta t)$，并将滤波器引入到解析波段中的有效阻尼率 $\\gamma(\\omega)$ 定义为\n$$\n\\gamma(\\omega) \\equiv -\\frac{1}{\\Delta t} \\ln\\left(|F(\\omega \\Delta t)|\\right).\n$$\n从上述定义和正弦信号的三角时移恒等式出发，推导 $F(\\theta)$ 作为 $\\theta \\equiv \\omega \\Delta t$ 的函数的解析表达式，然后计算一个解析的赤道 Kelvin 波分量的有效阻尼率 $\\gamma$ 的数值，该波分量的周期 $P = 10\\,\\text{天}$，模型时间步长 $\\Delta t = 600\\,\\text{s}$，RA 滤波器系数 $\\nu = 0.06$。以 $\\text{day}^{-1}$ 为单位表示最终的 $\\gamma$，并将您的答案四舍五入到四位有效数字。在最终的方框答案中不要提供任何单位。作为参考，$1\\,\\text{天} = 86400\\,\\text{s}$。您可以假设角度以弧度为单位。作为背景信息，您可以在解题过程中简要评论该阻尼率对于维持 QBO 切变极值以及对平流层突然增温 (SSW) 调制的潜在敏感性的影响，但最终答案必须是所要求的计算结果。",
            "solution": "该问题要求推导 Robert–Asselin (RA) 滤波器的每步有效振幅因子 $F(\\theta)$ 的解析表达式，并随后计算特定赤道波的有效阻尼率 $\\gamma$。\n\n首先，我们验证问题陈述的有效性。\n\n**第一步：提取已知条件**\n- 预报变量演变：$x^{n} = A \\exp(i \\omega n \\Delta t)$\n- $n$：整数时间指数\n- $\\Delta t$：固定时间步长\n- $\\omega$：角频率\n- RA 滤波器定义：$x^{n} \\leftarrow x^{n} + \\nu \\left(x^{n+1} - 2 x^{n} + x^{n-1}\\right)$\n- $\\nu$：RA 滤波器系数\n- 假设：物理波模随时间保持正弦形式。\n- 每步有效振幅因子：$F(\\omega \\Delta t)$\n- 有效阻尼率定义：$\\gamma(\\omega) \\equiv -\\frac{1}{\\Delta t} \\ln\\left(|F(\\omega \\Delta t)|\\right)$\n- 推导用定义：$\\theta \\equiv \\omega \\Delta t$\n- 波周期：$P = 10\\,\\text{天}$\n- 模型时间步长：$\\Delta t = 600\\,\\text{s}$\n- RA 滤波器系数：$\\nu = 0.06$\n- 转换因子：$1\\,\\text{天} = 86400\\,\\text{s}$\n\n**第二步：使用提取的已知条件进行验证**\n问题具有科学依据，描述了在采用蛙跃时间步进格式的数值模型中使用的标准 Robert–Asselin 滤波器。赤道 Kelvin 波、准两年期振荡 (QBO) 和平流层突然增温 (SSW) 的背景是大气动力学和气候模拟中的一个成熟课题。问题提法很严谨，提供了所有必要的定义、常数和明确的目标。语言客观且正式。所提供的波周期、时间步长和滤波器系数值在物理上是现实的。问题是自洽且内部一致的。\n\n**第三步：结论与行动**\n问题有效。将继续进行求解。\n\n**第一部分：振幅因子 $F(\\theta)$ 的推导**\n\n令 $x_{\\text{filt}}^{n}$ 表示在应用 RA 滤波器后，变量在时间指数 $n$ 处的值，并令 $x^k$ (其中 $k=n-1, n, n+1$) 为应用滤波器前的值。滤波器的定义为：\n$$\nx_{\\text{filt}}^{n} = x^{n} + \\nu \\left(x^{n+1} - 2 x^{n} + x^{n-1}\\right)\n$$\n我们已知波分量的形式为 $x^{k} = A \\exp(i \\omega k \\Delta t)$，对于任何整数时间指数 $k$。将此形式代入滤波器方程：\n$$\nx_{\\text{filt}}^{n} = A \\exp(i \\omega n \\Delta t) + \\nu \\left( A \\exp(i \\omega (n+1) \\Delta t) - 2 A \\exp(i \\omega n \\Delta t) + A \\exp(i \\omega (n-1) \\Delta t) \\right)\n$$\n我们可以提出因子 $A \\exp(i \\omega n \\Delta t)$，它等于 $x^n$：\n$$\nx_{\\text{filt}}^{n} = A \\exp(i \\omega n \\Delta t) \\left[ 1 + \\nu \\left( \\exp(i \\omega \\Delta t) - 2 + \\exp(-i \\omega \\Delta t) \\right) \\right]\n$$\n$$\nx_{\\text{filt}}^{n} = x^{n} \\left[ 1 + \\nu \\left( \\exp(i \\omega \\Delta t) + \\exp(-i \\omega \\Delta t) - 2 \\right) \\right]\n$$\n使用恒等式 $2\\cos(\\alpha) = \\exp(i\\alpha) + \\exp(-i\\alpha)$，我们简化括号中的项：\n$$\n\\exp(i \\omega \\Delta t) + \\exp(-i \\omega \\Delta t) - 2 = 2\\cos(\\omega \\Delta t) - 2 = -2(1 - \\cos(\\omega \\Delta t))\n$$\n将其代回 $x_{\\text{filt}}^{n}$ 的表达式中：\n$$\nx_{\\text{filt}}^{n} = x^{n} \\left[ 1 - 2\\nu(1 - \\cos(\\omega \\Delta t)) \\right]\n$$\n每步有效振幅因子 $F(\\omega \\Delta t)$ 由关系式 $x_{\\text{filt}}^{n} = F(\\omega \\Delta t) x^{n}$ 定义。通过比较，我们确定该因子为：\n$$\nF(\\omega \\Delta t) = 1 - 2\\nu(1 - \\cos(\\omega \\Delta t))\n$$\n根据定义 $\\theta \\equiv \\omega \\Delta t$，$F(\\theta)$ 的表达式为：\n$$\nF(\\theta) = 1 - 2\\nu(1 - \\cos(\\theta))\n$$\n这就是所要求的解析表达式。我们也可以使用半角恒等式 $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$ 来表示，这给出了等价形式 $F(\\theta) = 1 - 4\\nu\\sin^2(\\theta/2)$。对于我们的计算，两种形式都是正确的。\n\n**第二部分：阻尼率 $\\gamma$ 的计算**\n\n我们需要根据给定的参数计算 $\\gamma$ 的数值：\n- 周期 $P = 10\\,\\text{天} = 10 \\times 86400\\,\\text{s} = 864000\\,\\text{s}$。\n- 时间步长 $\\Delta t = 600\\,\\text{s}$。\n- RA 系数 $\\nu = 0.06$。\n\n首先，我们根据周期 $P$ 计算角频率 $\\omega$：\n$$\n\\omega = \\frac{2\\pi}{P} = \\frac{2\\pi}{864000\\,\\text{s}}\n$$\n接下来，我们计算无量纲频率 $\\theta = \\omega \\Delta t$：\n$$\n\\theta = \\left(\\frac{2\\pi}{864000\\,\\text{s}}\\right) (600\\,\\text{s}) = \\frac{1200\\pi}{864000} = \\frac{12\\pi}{8640} = \\frac{\\pi}{720}\n$$\n现在，我们计算 $\\theta$ 取此值时的振幅因子 $F(\\theta)$：\n$$\nF\\left(\\frac{\\pi}{720}\\right) = 1 - 2(0.06)\\left(1 - \\cos\\left(\\frac{\\pi}{720}\\right)\\right) = 1 - 0.12\\left(1 - \\cos\\left(\\frac{\\pi}{720}\\right)\\right)\n$$\n由于 $\\pi/720$ 是一个小的正角，$\\cos(\\pi/720)$ 略小于 $1$，这使得 $1 - \\cos(\\pi/720)$ 是一个小的正数。因此，$F(\\pi/720)$ 将是一个略小于 $1$ 的实数。所以，其绝对值为 $|F(\\pi/720)| = F(\\pi/720)$。\n\n有效阻尼率 $\\gamma$ 定义为：\n$$\n\\gamma = -\\frac{1}{\\Delta t} \\ln\\left(\\left|F(\\omega \\Delta t)\\right|\\right) = -\\frac{1}{600\\,\\text{s}} \\ln\\left(1 - 0.12\\left(1 - \\cos\\left(\\frac{\\pi}{720}\\right)\\right)\\right)\n$$\n我们现在进行数值计算：\n$$\n\\cos\\left(\\frac{\\pi}{720}\\right) \\approx \\cos(0.00436332\\,\\text{rad}) \\approx 0.9999904791\n$$\n$$\n1 - \\cos\\left(\\frac{\\pi}{720}\\right) \\approx 1 - 0.9999904791 = 9.5208 \\times 10^{-6}\n$$\n$$\nF\\left(\\frac{\\pi}{720}\\right) \\approx 1 - 0.12 \\times (9.5208 \\times 10^{-6}) = 1 - 1.1425 \\times 10^{-6} = 0.9999988575\n$$\n$$\n\\ln\\left(F\\left(\\frac{\\pi}{720}\\right)\\right) \\approx \\ln(0.9999988575) \\approx -1.1425 \\times 10^{-6}\n$$\n注意，对于一个小的数值 $x$，$\\ln(1-x) \\approx -x$。数值结果与此近似一致。\n现在我们以 $\\text{s}^{-1}$ 为单位计算 $\\gamma$：\n$$\n\\gamma \\approx -\\frac{1}{600\\,\\text{s}} \\left(-1.1425 \\times 10^{-6}\\right) \\approx 1.9042 \\times 10^{-9}\\,\\text{s}^{-1}\n$$\n问题要求答案以 $\\text{day}^{-1}$ 为单位。我们使用转换因子 $1\\,\\text{day} = 86400\\,\\text{s}$：\n$$\n\\gamma \\,[\\text{day}^{-1}] = \\gamma \\,[\\text{s}^{-1}] \\times \\frac{86400\\,\\text{s}}{1\\,\\text{day}}\n$$\n$$\n\\gamma \\approx (1.9042 \\times 10^{-9}) \\times 86400 \\,\\text{day}^{-1} \\approx 0.00016452 \\,\\text{day}^{-1}\n$$\n将结果四舍五入到四位有效数字得到 $0.0001645$。\n\n作为背景信息，该阻尼率对应的 e-折时间尺度为 $1/\\gamma \\approx 1/0.0001645 \\approx 6079\\,\\text{天}$，即超过 $16$ 年。这种极弱的阻尼证实了具有此标准系数的 RA 滤波器能有效地保留长周期物理模（如驱动 QBO 的 Kelvin 波）的能量。这是一个理想的特性，因为滤波器的主要作用是抑制非物理的计算模，而不是干涉维持关键气候特征的、被解析的波动力学过程。对这些波-流相互作用的忠实表示，对于精确模拟 QBO 对诸如 SSW 等扰动的响应尤为重要。\n使用更高精度进行中间计算：\n$\\theta = \\pi/720$。\n$F(\\theta) = 1 - 0.12(1-\\cos(\\pi/720)) \\approx 0.9999988577008$。\n$\\ln(F(\\theta)) \\approx -1.1422992... \\times 10^{-6}$。\n先前的计算有误，重新计算：\n$F(\\theta) = 1 - 4 \\nu \\sin^2(\\theta/2) = 1 - 0.24 \\sin^2(\\pi/1440)$。\n$\\sin(\\pi/1440) \\approx 0.002181643$。\n$\\sin^2(\\pi/1440) \\approx 4.75958 \\times 10^{-6}$。\n$F(\\theta) \\approx 1 - 0.24 \\times (4.75958 \\times 10^{-6}) = 1 - 1.142299 \\times 10^{-6} = 0.9999988577$。\n$\\ln(F(\\theta)) \\approx -1.1423005 \\times 10^{-6}$。\n$\\gamma = -(-1.1423005 \\times 10^{-6}) / 600 \\approx 1.903834 \\times 10^{-9}\\,\\text{s}^{-1}$。\n$\\gamma \\,[\\text{day}^{-1}] = (1.903834 \\times 10^{-9}) \\times 86400 \\approx 0.000164491$。\n四舍五入到四位有效数字得到 $0.0001645$。",
            "answer": "$$\n\\boxed{0.0001645}\n$$"
        }
    ]
}