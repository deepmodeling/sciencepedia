{
    "hands_on_practices": [
        {
            "introduction": "Understanding the global carbon budget is foundational to climate science. This exercise demonstrates how the fundamental principle of mass conservation can be used to constrain large-scale carbon fluxes. By combining observed atmospheric growth with emission data, you will employ a weighted least squares optimization to reconcile these 'top-down' estimates with 'bottom-up' process-based estimates of land and ocean sinks, a core technique in modern carbon cycle analysis .",
            "id": "4100253",
            "problem": "Consider a single-year global carbon budget analysis used to constrain surface fluxes in Earth System Models (ESMs) embedded within Numerical Weather Prediction (NWP) and climate modeling workflows. Let the atmospheric carbon mass $M_{\\mathrm{atm}}$ obey conservation of mass over a year such that the tendency $dM_{\\mathrm{atm}}/dt$ equals emissions minus sinks. For this exercise, assume the only anthropogenic source considered is fossil fuel and cement production emissions $E_{\\mathrm{ff}}$, and neglect land-use change emissions and any budget residuals. The observed atmospheric growth rate is denoted $G_{\\mathrm{atm}}$. The implied combined sink is then constrained by conservation of mass.\n\nThe combined sink is partitioned between land and ocean as $S_{\\mathrm{land}}$ and $S_{\\mathrm{ocn}}$. In the absence of full process-resolving constraints, adopt the parameterization $S_{\\mathrm{land}} = \\alpha S_{\\mathrm{tot}}$ and $S_{\\mathrm{ocn}} = (1-\\alpha) S_{\\mathrm{tot}}$, where $S_{\\mathrm{tot}}$ is the combined sink implied by the budget. Independent estimates of annual mean sinks from process models and observation-based reconstructions for this year are $S_{\\mathrm{land}}^{\\ast}$ and $S_{\\mathrm{ocn}}^{\\ast}$, with associated one-standard-deviation uncertainties $\\sigma_{\\mathrm{land}}$ and $\\sigma_{\\mathrm{ocn}}$. Use a weighted least squares misfit to determine the optimal partition coefficient $\\alpha$:\n$$\nJ(\\alpha) = w_{\\mathrm{land}}\\left(\\alpha S_{\\mathrm{tot}} - S_{\\mathrm{land}}^{\\ast}\\right)^{2} + w_{\\mathrm{ocn}}\\left((1-\\alpha) S_{\\mathrm{tot}} - S_{\\mathrm{ocn}}^{\\ast}\\right)^{2},\n$$\nwhere $w_{\\mathrm{land}} = 1/\\sigma_{\\mathrm{land}}^{2}$ and $w_{\\mathrm{ocn}} = 1/\\sigma_{\\mathrm{ocn}}^{2}$.\n\nData for the target year are:\n- Fossil fuel and cement emissions $E_{\\mathrm{ff}} = 9.8$ petagrams of carbon per year ($\\text{PgC yr}^{-1}$).\n- Observed atmospheric growth rate $G_{\\mathrm{atm}} = 5.3 \\, \\text{PgC yr}^{-1}$.\n- Independent land sink estimate $S_{\\mathrm{land}}^{\\ast} = 3.0 \\, \\text{PgC yr}^{-1}$ with uncertainty $\\sigma_{\\mathrm{land}} = 0.4 \\, \\text{PgC yr}^{-1}$.\n- Independent ocean sink estimate $S_{\\mathrm{ocn}}^{\\ast} = 2.6 \\, \\text{PgC yr}^{-1}$ with uncertainty $\\sigma_{\\mathrm{ocn}} = 0.2 \\, \\text{PgC yr}^{-1}$.\n\nTasks:\n1. Starting from conservation of mass, derive $S_{\\mathrm{tot}}$ in terms of $E_{\\mathrm{ff}}$ and $G_{\\mathrm{atm}}$ for this simplified budget.\n2. Formulate and analytically minimize $J(\\alpha)$ to obtain a closed-form expression for the optimal $\\alpha$ in terms of $S_{\\mathrm{tot}}$, $S_{\\mathrm{land}}^{\\ast}$, $S_{\\mathrm{ocn}}^{\\ast}$, $w_{\\mathrm{land}}$, and $w_{\\mathrm{ocn}}$.\n3. Using the provided numerical values, compute the numerical value of the optimal $\\alpha$.\n4. Using this optimal $\\alpha$, compute the implied sinks $S_{\\mathrm{land}}$ and $S_{\\mathrm{ocn}}$ and discuss, based on their magnitudes, how they compare to the independent estimates $S_{\\mathrm{land}}^{\\ast}$ and $S_{\\mathrm{ocn}}^{\\ast}$.\n\nReport the optimal partition coefficient $\\alpha$ as the final answer. Round your reported $\\alpha$ to four significant figures. Express the final answer as a unitless number. Any intermediate quantities you compute should be expressed in $\\text{PgC yr}^{-1}$ where appropriate.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective. The problem statement describes a simplified but standard method for carbon budget closure, a common task in climate science. It uses the principle of mass conservation and the mathematical technique of weighted least squares optimization to reconcile different data sources. All provided data are physically realistic and dimensionally consistent. The problem is well-defined, contains no contradictions, and has a unique, stable solution. Therefore, the problem is deemed valid. We proceed with the solution, addressing each of the four tasks in sequence.\n\nFirst, we address Task 1: the derivation of the total sink $S_{\\mathrm{tot}}$. The problem states that the rate of change of atmospheric carbon mass, $dM_{\\mathrm{atm}}/dt$, which is observed as the atmospheric growth rate $G_{\\mathrm{atm}}$, is equal to the total emissions minus the total sinks. In this simplified budget, the only emission source is $E_{\\mathrm{ff}}$ and the total sink is $S_{\\mathrm{tot}}$. The conservation of mass equation is thus:\n$$\nG_{\\mathrm{atm}} = \\frac{dM_{\\mathrm{atm}}}{dt} = E_{\\mathrm{ff}} - S_{\\mathrm{tot}}\n$$\nSolving for the total sink $S_{\\mathrm{tot}}$ yields:\n$$\nS_{\\mathrm{tot}} = E_{\\mathrm{ff}} - G_{\\mathrm{atm}}\n$$\nUsing the provided numerical data, $E_{\\mathrm{ff}} = 9.8 \\, \\text{PgC yr}^{-1}$ and $G_{\\mathrm{atm}} = 5.3 \\, \\text{PgC yr}^{-1}$, we can compute the value of the total sink:\n$$\nS_{\\mathrm{tot}} = 9.8 - 5.3 = 4.5 \\, \\text{PgC yr}^{-1}\n$$\n\nNext, for Task 2, we find the optimal partition coefficient $\\alpha$ by minimizing the cost function $J(\\alpha)$. The cost function is given as:\n$$\nJ(\\alpha) = w_{\\mathrm{land}}\\left(\\alpha S_{\\mathrm{tot}} - S_{\\mathrm{land}}^{\\ast}\\right)^{2} + w_{\\mathrm{ocn}}\\left((1-\\alpha) S_{\\mathrm{tot}} - S_{\\mathrm{ocn}}^{\\ast}\\right)^{2}\n$$\nTo find the minimum, we must find the value of $\\alpha$ for which the first derivative of $J(\\alpha)$ with respect to $\\alpha$ is zero, i.e., $dJ/d\\alpha = 0$. Using the chain rule for differentiation:\n$$\n\\frac{dJ}{d\\alpha} = w_{\\mathrm{land}} \\cdot 2 \\left(\\alpha S_{\\mathrm{tot}} - S_{\\mathrm{land}}^{\\ast}\\right) \\cdot (S_{\\mathrm{tot}}) + w_{\\mathrm{ocn}} \\cdot 2 \\left((1-\\alpha) S_{\\mathrm{tot}} - S_{\\mathrm{ocn}}^{\\ast}\\right) \\cdot (-S_{\\mathrm{tot}})\n$$\nSetting the derivative to zero:\n$$\n2 S_{\\mathrm{tot}} \\left[ w_{\\mathrm{land}}\\left(\\alpha S_{\\mathrm{tot}} - S_{\\mathrm{land}}^{\\ast}\\right) - w_{\\mathrm{ocn}}\\left((1-\\alpha) S_{\\mathrm{tot}} - S_{\\mathrm{ocn}}^{\\ast}\\right) \\right] = 0\n$$\nSince $S_{\\mathrm{tot}} = 4.5 \\neq 0$, we can divide by $2 S_{\\mathrm{tot}}$:\n$$\nw_{\\mathrm{land}}\\left(\\alpha S_{\\mathrm{tot}} - S_{\\mathrm{land}}^{\\ast}\\right) - w_{\\mathrm{ocn}}\\left(S_{\\mathrm{tot}} - \\alpha S_{\\mathrm{tot}} - S_{\\mathrm{ocn}}^{\\ast}\\right) = 0\n$$\nWe now solve for $\\alpha$. Expanding the terms:\n$$\nw_{\\mathrm{land}} \\alpha S_{\\mathrm{tot}} - w_{\\mathrm{land}} S_{\\mathrm{land}}^{\\ast} - w_{\\mathrm{ocn}} S_{\\mathrm{tot}} + w_{\\mathrm{ocn}} \\alpha S_{\\mathrm{tot}} + w_{\\mathrm{ocn}} S_{\\mathrm{ocn}}^{\\ast} = 0\n$$\nGroup terms containing $\\alpha$ on one side of the equation:\n$$\n\\alpha S_{\\mathrm{tot}} (w_{\\mathrm{land}} + w_{\\mathrm{ocn}}) = w_{\\mathrm{land}} S_{\\mathrm{land}}^{\\ast} + w_{\\mathrm{ocn}} S_{\\mathrm{tot}} - w_{\\mathrm{ocn}} S_{\\mathrm{ocn}}^{\\ast}\n$$\nIsolating $\\alpha$ gives the closed-form expression for the optimal partition coefficient:\n$$\n\\alpha = \\frac{w_{\\mathrm{land}} S_{\\mathrm{land}}^{\\ast} + w_{\\mathrm{ocn}} (S_{\\mathrm{tot}} - S_{\\mathrm{ocn}}^{\\ast})}{S_{\\mathrm{tot}} (w_{\\mathrm{land}} + w_{\\mathrm{ocn}})}\n$$\nTo confirm this is a minimum, we check the second derivative: $\\frac{d^2 J}{d\\alpha^2} = 2 S_{\\mathrm{tot}}^2 (w_{\\mathrm{land}} + w_{\\mathrm{ocn}})$. Since the weights $w = 1/\\sigma^2$ are positive and $S_{\\mathrm{tot}}^2$ is positive, $\\frac{d^2 J}{d\\alpha^2} > 0$, confirming a minimum.\n\nFor Task 3, we compute the numerical value of $\\alpha$. First, we calculate the weights $w_{\\mathrm{land}}$ and $w_{\\mathrm{ocn}}$ from the given uncertainties $\\sigma_{\\mathrm{land}} = 0.4 \\, \\text{PgC yr}^{-1}$ and $\\sigma_{\\mathrm{ocn}} = 0.2 \\, \\text{PgC yr}^{-1}$:\n$$\nw_{\\mathrm{land}} = \\frac{1}{\\sigma_{\\mathrm{land}}^{2}} = \\frac{1}{(0.4)^{2}} = \\frac{1}{0.16} = 6.25 \\, (\\text{PgC yr}^{-1})^{-2}\n$$\n$$\nw_{\\mathrm{ocn}} = \\frac{1}{\\sigma_{\\mathrm{ocn}}^{2}} = \\frac{1}{(0.2)^{2}} = \\frac{1}{0.04} = 25 \\, (\\text{PgC yr}^{-1})^{-2}\n$$\nNow, we substitute all numerical values into the expression for $\\alpha$:\n$S_{\\mathrm{tot}} = 4.5$, $S_{\\mathrm{land}}^{\\ast} = 3.0$, $S_{\\mathrm{ocn}}^{\\ast} = 2.6$, $w_{\\mathrm{land}} = 6.25$, $w_{\\mathrm{ocn}} = 25$.\nThe numerator is:\n$$\nw_{\\mathrm{land}} S_{\\mathrm{land}}^{\\ast} + w_{\\mathrm{ocn}} (S_{\\mathrm{tot}} - S_{\\mathrm{ocn}}^{\\ast}) = 6.25 \\times 3.0 + 25 \\times (4.5 - 2.6) = 18.75 + 25 \\times 1.9 = 18.75 + 47.5 = 66.25\n$$\nThe denominator is:\n$$\nS_{\\mathrm{tot}} (w_{\\mathrm{land}} + w_{\\mathrm{ocn}}) = 4.5 \\times (6.25 + 25) = 4.5 \\times 31.25 = 140.625\n$$\nThus, the optimal $\\alpha$ is:\n$$\n\\alpha = \\frac{66.25}{140.625} = 0.47111...\n$$\nRounding to four significant figures, we get $\\alpha \\approx 0.4711$.\n\nFinally, for Task 4, we compute the implied sinks and discuss the result. Using the unrounded value of $\\alpha$ for precision, the implied land and ocean sinks are:\n$$\nS_{\\mathrm{land}} = \\alpha S_{\\mathrm{tot}} = \\left(\\frac{66.25}{140.625}\\right) \\times 4.5 = 2.12 \\, \\text{PgC yr}^{-1}\n$$\n$$\nS_{\\mathrm{ocn}} = (1-\\alpha) S_{\\mathrm{tot}} = S_{\\mathrm{tot}} - S_{\\mathrm{land}} = 4.5 - 2.12 = 2.38 \\, \\text{PgC yr}^{-1}\n$$\nWe compare these optimized sinks to the independent estimates:\n- Implied land sink $S_{\\mathrm{land}} = 2.12 \\, \\text{PgC yr}^{-1}$ versus independent estimate $S_{\\mathrm{land}}^{\\ast} = 3.0 \\, \\text{PgC yr}^{-1}$.\n- Implied ocean sink $S_{\\mathrm{ocn}} = 2.38 \\, \\text{PgC yr}^{-1}$ versus independent estimate $S_{\\mathrm{ocn}}^{\\ast} = 2.6 \\, \\text{PgC yr}^{-1}$.\n\nThe sum of the independent sink estimates is $S_{\\mathrm{land}}^{\\ast} + S_{\\mathrm{ocn}}^{\\ast} = 3.0 + 2.6 = 5.6 \\, \\text{PgC yr}^{-1}$, which is larger than the total sink of $S_{\\mathrm{tot}} = 4.5 \\, \\text{PgC yr}^{-1}$ required by mass conservation. The optimization procedure therefore finds a compromise that adjusts the sinks to satisfy this conservation law. Both optimized sinks, $S_{\\mathrm{land}}$ and $S_{\\mathrm{ocn}}$, are smaller than their respective independent estimates.\n\nThe magnitude of the adjustment is dictated by the uncertainties. The ocean sink estimate has a smaller uncertainty ($\\sigma_{\\mathrm{ocn}} = 0.2$) than the land sink estimate ($\\sigma_{\\mathrm{land}} = 0.4$), resulting in a much larger weight ($w_{\\mathrm{ocn}}=25$ versus $w_{\\mathrm{land}}=6.25$). Consequently, the cost function penalizes deviations from the ocean estimate more heavily. The result is that the optimized ocean sink ($2.38 \\, \\text{PgC yr}^{-1}$) is kept much closer to its independent estimate ($2.6 \\, \\text{PgC yr}^{-1}$), with a difference of only $|2.38 - 2.6| = 0.22 \\, \\text{PgC yr}^{-1}$. In contrast, the optimized land sink ($2.12 \\, \\text{PgC yr}^{-1}$) is pulled much further from its more uncertain independent estimate ($3.0 \\, \\text{PgC yr}^{-1}$), with a larger difference of $|2.12 - 3.0| = 0.88 \\, \\text{PgC yr}^{-1}$. The final partitioning reflects a greater confidence in the ocean sink estimate compared to the land sink estimate.",
            "answer": "$$\\boxed{0.4711}$$"
        },
        {
            "introduction": "Land surface models are critical components of Earth System Models, and their representation of soil carbon is a major source of uncertainty in climate projections. This practice delves into the mathematical heart of many soil carbon models, treating them as a system of linear compartments with first-order kinetics . By deriving the steady-state solution and analyzing its response to a temperature increase using a $Q_{10}$ function, you will uncover the fundamental inverse relationship between decomposition rates and equilibrium carbon storage, which governs a crucial carbon-climate feedback.",
            "id": "4100261",
            "problem": "A land surface carbon module within a comprehensive Numerical Weather Prediction (NWP) and climate modeling system represents soil organic carbon as a set of $n$ communicating compartments (pools) with first-order decomposition. Let the soil carbon state vector be $\\mathbf{C}(t) \\in \\mathbb{R}^{n}$, and the constant litter input vector be $\\mathbf{L} \\in \\mathbb{R}^{n}$ with each component nonnegative. Each pool $i$ decomposes with a base rate constant $k_{i} > 0$, collected into the diagonal matrix $\\mathbf{K} = \\mathrm{diag}(k_{1}, \\dots, k_{n})$. A fraction $a_{ij} \\in [0,1]$ of the decomposition flux from pool $i$ is instantaneously transferred to pool $j$, and the remaining fraction is respired to the atmosphere; define the transfer matrix $\\mathbf{A} \\in \\mathbb{R}^{n \\times n}$ with entries $a_{ij}$ and assume the row sums satisfy $\\sum_{j=1}^{n} a_{ij} < 1$ for all $i$. Environmental conditions modulate all decomposition fluxes multiplicatively by a scalar $s(T,\\theta)$, where $T$ is temperature (expressed in degrees Celsius) and $\\theta$ is a nondimensional soil moisture index. The modifier is given by $s(T,\\theta) = f_{T}(T)\\,f_{\\theta}(\\theta)$, where the temperature sensitivity factor ($Q_{10}$) is used: $f_{T}(T) = Q_{10}^{(T - T_{\\mathrm{ref}})/10}$ with $Q_{10} > 1$ and reference temperature $T_{\\mathrm{ref}}$, and the moisture scalar $f_{\\theta}(\\theta) \\in (0,1]$ is a fixed function of $\\theta$.\n\nUnder these assumptions, model the soil carbon dynamics as a linear compartment system driven by $\\mathbf{L}$ and governed by mass conservation. Assume that the matrix $\\mathbf{M} = (\\mathbf{I} - \\mathbf{A})\\,\\mathbf{K}$ is nonsingular. Suppose the system is at an initial environmental state $(T_{0},\\theta_{0})$ with modifier $s_{0} = s(T_{0},\\theta_{0})$, and the system has equilibrated to a steady state $\\mathbf{C}^{*}_{0}$. At time $t=0$, an abrupt climate warming step changes the temperature to a new constant $T_{1}$ while moisture remains at $\\theta_{0}$, so the modifier becomes $s_{1} = s(T_{1},\\theta_{0})$. The system re-equilibrates to a new steady state $\\mathbf{C}^{*}_{1}$. Let the total soil carbon stock at steady state be $S = \\mathbf{1}^{\\top}\\mathbf{C}^{*}$, where $\\mathbf{1}$ is the $n$-dimensional vector of ones.\n\nStarting from the fundamental laws of mass conservation and the specified first-order kinetics and transfer structure, derive the steady-state solution and explain how the environmental scalar $s$ enters the equilibrium. Then, determine a single closed-form analytic expression for the ratio $R$ of post-step to pre-step total steady-state soil carbon stock, $R = S_{1}/S_{0}$, expressed only in terms of $Q_{10}$, $T_{0}$, $T_{1}$, and $T_{\\mathrm{ref}}$. You may assume $f_{\\theta}(\\theta_{0})$ is unchanged across the step. Provide your final answer as the expression for $R$. No numerical evaluation is required, and no rounding is needed. The final answer must be dimensionless.",
            "solution": "The problem asks for the ratio of total steady-state soil carbon stocks before and after an abrupt temperature change. The system is described as a linear compartment model. The solution requires first deriving the governing equations, finding the steady-state solution, and then calculating the desired ratio.\n\nLet $\\mathbf{C}(t) = [C_1(t), C_2(t), \\dots, C_n(t)]^{\\top}$ be the vector of carbon stocks in the $n$ soil compartments at time $t$. The dynamics of the carbon stock in an arbitrary compartment $i$ are governed by a mass balance equation: the rate of change of carbon in the pool is equal to the sum of all inputs minus the sum of all outputs.\n\nThe inputs to compartment $i$ are:\n1.  Litter input from outside the system, given by the $i$-th component of the vector $\\mathbf{L}$, which is $L_i$.\n2.  Transfers from other compartments $j$ into compartment $i$. The problem states that a fraction $a_{ji}$ of the decomposition flux from pool $j$ is transferred to pool $i$. The decomposition flux from pool $j$ is given by $s(T,\\theta) k_j C_j(t)$. Therefore, the total input to pool $i$ from all other pools is $\\sum_{j=1}^{n} a_{ji} s(T,\\theta) k_j C_j(t)$.\n\nThe output from compartment $i$ is its total decomposition flux, which is $s(T,\\theta) k_i C_i(t)$. This flux is partitioned into respiration to the atmosphere and transfers to other compartments.\n\nCombining these terms, the mass balance for compartment $i$ is:\n$$ \\frac{dC_i}{dt} = L_i + \\sum_{j=1}^{n} a_{ji} s(T,\\theta) k_j C_j(t) - s(T,\\theta) k_i C_i(t) $$\n\nThis system of $n$ ordinary differential equations can be written in matrix-vector form. Let $\\mathbf{A}$ be the matrix with entries $a_{ij}$ and $\\mathbf{K}$ be the diagonal matrix with entries $k_i$. The term $\\sum_{j=1}^{n} a_{ji} s(T,\\theta) k_j C_j(t)$ is the $i$-th element of the vector $s(T,\\theta) \\mathbf{A}^{\\top} \\mathbf{K} \\mathbf{C}(t)$. The term $s(T,\\theta) k_i C_i(t)$ is the $i$-th element of the vector $s(T,\\theta) \\mathbf{K} \\mathbf{C}(t)$. Thus, the system of equations is:\n$$ \\frac{d\\mathbf{C}}{dt} = \\mathbf{L} + s(T,\\theta) \\mathbf{A}^{\\top} \\mathbf{K} \\mathbf{C} - s(T,\\theta) \\mathbf{K} \\mathbf{C} $$\n$$ \\frac{d\\mathbf{C}}{dt} = \\mathbf{L} - s(T,\\theta) (\\mathbf{I} - \\mathbf{A}^{\\top}) \\mathbf{K} \\mathbf{C} $$\nHowever, the problem specifies the matrix $\\mathbf{M} = (\\mathbf{I} - \\mathbf{A})\\mathbf{K}$ as being significant, which suggests an alternative indexing convention for the transfers. Let's reconsider the formulation. If $a_{ij}$ is the fraction of decomposition from pool $i$ transferred *to* pool $j$, the mass balance for compartment $j$ is:\n$$ \\frac{dC_j}{dt} = L_j + \\sum_{i=1}^{n} (\\text{transfer } i \\to j) - (\\text{decomposition of } j) $$\n$$ \\frac{dC_j}{dt} = L_j + \\sum_{i=1}^{n} a_{ij} s(T,\\theta) k_i C_i(t) - s(T,\\theta) k_j C_j(t) $$\nThe summation term $\\sum_{i=1}^{n} a_{ij} s k_i C_i$ is the $j$-th component of the matrix-vector product $s \\mathbf{A} \\mathbf{K} \\mathbf{C}$. Thus, the system becomes:\n$$ \\frac{d\\mathbf{C}}{dt} = \\mathbf{L} + s(T,\\theta) \\mathbf{A} \\mathbf{K} \\mathbf{C} - s(T,\\theta) \\mathbf{K} \\mathbf{C} $$\n$$ \\frac{d\\mathbf{C}}{dt} = \\mathbf{L} - s(T,\\theta) (\\mathbf{I} - \\mathbf{A}) \\mathbf{K} \\mathbf{C} $$\nUsing the provided definition $\\mathbf{M} = (\\mathbf{I} - \\mathbf{A}) \\mathbf{K}$, the system dynamics are:\n$$ \\frac{d\\mathbf{C}}{dt} = \\mathbf{L} - s(T,\\theta) \\mathbf{M} \\mathbf{C} $$\nThis formulation is consistent with the information given in the problem statement.\n\nAt steady state, the carbon stocks are constant, so $\\frac{d\\mathbf{C}}{dt} = \\mathbf{0}$. Let the steady-state carbon vector be $\\mathbf{C}^{*}$. The equation becomes:\n$$ \\mathbf{0} = \\mathbf{L} - s \\mathbf{M} \\mathbf{C}^{*} $$\n$$ s \\mathbf{M} \\mathbf{C}^{*} = \\mathbf{L} $$\nThe problem states that $\\mathbf{M}$ is nonsingular. The environmental scalar $s(T,\\theta) = f_T(T) f_\\theta(\\theta)$ is strictly positive since $Q_{10} > 1$ and $f_\\theta(\\theta) \\in (0,1]$. Therefore, we can solve for the unique steady-state vector $\\mathbf{C}^{*}$:\n$$ \\mathbf{C}^{*} = \\frac{1}{s} \\mathbf{M}^{-1} \\mathbf{L} $$\nThis expression shows that the steady-state carbon stock vector $\\mathbf{C}^{*}$ is inversely proportional to the environmental scalar $s$. Physically, this means that higher decomposition rates (larger $s$) lead to lower equilibrium carbon storage for a fixed input rate $\\mathbf{L}$.\n\nThe total soil carbon stock at steady state, $S$, is the sum of the elements of $\\mathbf{C}^{*}$, which can be written as $S = \\mathbf{1}^{\\top}\\mathbf{C}^{*}$, where $\\mathbf{1}$ is the $n$-dimensional column vector of ones.\n$$ S = \\mathbf{1}^{\\top} \\left( \\frac{1}{s} \\mathbf{M}^{-1} \\mathbf{L} \\right) = \\frac{1}{s} \\left( \\mathbf{1}^{\\top} \\mathbf{M}^{-1} \\mathbf{L} \\right) $$\nThe term in the parenthesis, $\\mathbf{1}^{\\top} \\mathbf{M}^{-1} \\mathbf{L}$, is a scalar constant determined by the intrinsic properties of the soil system ($\\mathbf{A}$, $\\mathbf{K}$) and the litter inputs ($\\mathbf{L}$), but it is independent of the environmental conditions encapsulated in $s$.\n\nWe now apply this result to the two specified environmental states.\n1.  **Pre-step state (subscript $0$)**: The system is at steady state with temperature $T_0$ and moisture $\\theta_0$. The environmental scalar is $s_0 = s(T_0, \\theta_0)$. The total steady-state carbon stock is $S_0$.\n    $$ S_0 = \\frac{1}{s_0} \\left( \\mathbf{1}^{\\top} \\mathbf{M}^{-1} \\mathbf{L} \\right) $$\n\n2.  **Post-step state (subscript $1$)**: The system equilibrates to a new steady state with temperature $T_1$ and moisture $\\theta_0$. The environmental scalar is $s_1 = s(T_1, \\theta_0)$. The new total steady-state carbon stock is $S_1$.\n    $$ S_1 = \\frac{1}{s_1} \\left( \\mathbf{1}^{\\top} \\mathbf{M}^{-1} \\mathbf{L} \\right) $$\n\nThe problem asks for the ratio $R = S_1 / S_0$.\n$$ R = \\frac{S_1}{S_0} = \\frac{\\frac{1}{s_1} \\left( \\mathbf{1}^{\\top} \\mathbf{M}^{-1} \\mathbf{L} \\right)}{\\frac{1}{s_0} \\left( \\mathbf{1}^{\\top} \\mathbf{M}^{-1} \\mathbf{L} \\right)} = \\frac{s_0}{s_1} $$\nAll the details of the compartment model parameters ($\\mathbf{A}$, $\\mathbf{K}$, $\\mathbf{L}$) cancel out in the ratio.\n\nNow, we substitute the definitions of $s_0$ and $s_1$.\nThe environmental modifier is $s(T,\\theta) = f_{T}(T)\\,f_{\\theta}(\\theta) = Q_{10}^{(T - T_{\\mathrm{ref}})/10} f_{\\theta}(\\theta)$.\nSo, for the pre-step state:\n$$ s_0 = Q_{10}^{(T_0 - T_{\\mathrm{ref}})/10} f_{\\theta}(\\theta_0) $$\nAnd for the post-step state (with $T_1$ and unchanged $\\theta_0$):\n$$ s_1 = Q_{10}^{(T_1 - T_{\\mathrm{ref}})/10} f_{\\theta}(\\theta_0) $$\nSubstituting these into the expression for $R$:\n$$ R = \\frac{s_0}{s_1} = \\frac{Q_{10}^{(T_0 - T_{\\mathrm{ref}})/10} f_{\\theta}(\\theta_0)}{Q_{10}^{(T_1 - T_{\\mathrm{ref}})/10} f_{\\theta}(\\theta_0)} $$\nThe moisture scalar $f_{\\theta}(\\theta_0)$ is common to both numerator and denominator and cancels out.\n$$ R = \\frac{Q_{10}^{(T_0 - T_{\\mathrm{ref}})/10}}{Q_{10}^{(T_1 - T_{\\mathrm{ref}})/10}} $$\nUsing the exponent rule $x^a / x^b = x^{a-b}$:\n$$ R = Q_{10}^{\\left( \\frac{T_0 - T_{\\mathrm{ref}}}{10} - \\frac{T_1 - T_{\\mathrm{ref}}}{10} \\right)} $$\n$$ R = Q_{10}^{\\frac{(T_0 - T_{\\mathrm{ref}}) - (T_1 - T_{\\mathrm{ref}})}{10}} $$\n$$ R = Q_{10}^{\\frac{T_0 - T_{\\mathrm{ref}} - T_1 + T_{\\mathrm{ref}}}{10}} $$\n$$ R = Q_{10}^{\\frac{T_0 - T_1}{10}} $$\nThis is the final closed-form expression for the ratio of the total steady-state soil carbon stocks. It depends only on the temperature sensitivity $Q_{10}$ and the initial and final temperatures $T_0$ and $T_1$, as required.",
            "answer": "$$\\boxed{Q_{10}^{\\frac{T_{0} - T_{1}}{10}}}$$"
        },
        {
            "introduction": "The airborne fraction, the proportion of anthropogenic emissions that remains in the atmosphere, is a key metric for the efficiency of global carbon sinks. This computational exercise tasks you with analyzing time series of emissions and atmospheric growth to quantify the airborne fraction and its interannual variability . You will implement a first-order perturbation analysis to decompose the variance, providing insight into whether emission patterns or sink dynamics are the primary drivers of change in this critical Earth system diagnostic.",
            "id": "4100181",
            "problem": "Consider the global carbon cycle within numerical weather prediction and climate modeling and the role of anthropogenic carbon dioxide emissions in altering atmospheric carbon. Use conservation of mass for atmospheric carbon as the fundamental base: the temporal change in atmospheric carbon stock equals the net imbalance between anthropogenic emissions and total sinks. Define the concept of airborne fraction as the dimensionless measure of how much of anthropogenic emissions remain in the atmosphere over a specified period, consistent with conservation of mass and anthropogenic attribution, and compute its decadal mean from time series of emissions and atmospheric growth. Then, quantify and interpret the interannual variability of the airborne fraction by decomposing it into components attributable to variability in emissions, variability in atmospheric growth, and their covariance.\n\nYou must build a complete, runnable program that, for each test case, performs the following tasks grounded in the above principles without presupposing any shortcut formulas:\n- Compute the decadal airborne fraction as the dimensionless ratio consistent with mass conservation between atmospheric growth and anthropogenic emissions aggregated over the decade.\n- Compute the interannual standard deviation of the annual airborne fraction over years where it is well-defined.\n- Using a first-order perturbation analysis around the decadal means, decompose the variance of the annual airborne fraction into contributions from emissions variability, atmospheric growth variability, and their covariance. Express each contribution as a share of the total variance. If the decadal variance of annual airborne fraction is zero, define all shares as $0$.\n- If the decadal airborne fraction is undefined due to zero decadal emissions, signal this condition.\n\nAll physical quantities must be handled with appropriate units: anthropogenic emissions $E_t$ and atmospheric growth $G_t$ are in gigatonnes of carbon per year ($\\text{GtC/yr}$). The airborne fraction is a unitless decimal. All trigonometric angles are to be interpreted in radians. Express all outputs as decimals or integers; do not use percentage signs.\n\nYour program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the format:\n- For each test case, output a list in the form $[a_f, a_\\sigma, s_e, s_g, s_c, d]$ where:\n    - $a_f$ is the decadal airborne fraction as a unitless decimal.\n    - $a_\\sigma$ is the interannual standard deviation of annual airborne fraction (unitless).\n    - $s_e$ is the variance share attributable to emissions variability (unitless decimal).\n    - $s_g$ is the variance share attributable to atmospheric growth variability (unitless decimal).\n    - $s_c$ is the variance share attributable to covariance between emissions and atmospheric growth (unitless decimal, can be negative).\n    - $d$ is an integer diagnostic flag equal to $1$ if decadal emissions are strictly positive and the decadal airborne fraction is defined, otherwise $0$.\nAggregate the three test case outputs into a single list, e.g., $[[\\dots],[\\dots],[\\dots]]$.\n\nTest Suite:\nUse the following three decadal test cases. Each decade is indexed by $t \\in \\{0,1,2,3,4,5,6,7,8,9\\}$, with trigonometric arguments in radians.\n\n- Case A (growing emissions, moderate sink variability):\n    - Emissions: $E_t = 10 + 0.2\\,(t - 4.5) + 0.1\\,\\cos\\left(\\pi t / 5\\right)$ in GtC/yr.\n    - Atmospheric growth: $G_t = 0.48\\,E_t + 0.5\\,\\sin\\left(2\\pi t / 10\\right) + 0.05\\,\\cos\\left(\\pi t / 5\\right)$ in GtC/yr.\n\n- Case B (low emissions with zero years, weak sink variability):\n    - Emissions: $E_t$ given explicitly by the sequence in GtC/yr\n      $[0.0,\\,0.5,\\,1.0,\\,1.5,\\,2.0,\\,1.5,\\,1.0,\\,0.5,\\,0.0,\\,0.5]$.\n    - Atmospheric growth: $G_t = 0.55\\,E_t + 0.1\\,\\sin\\left(2\\pi t / 10\\right)$ in GtC/yr.\n\n- Case C (constant emissions, strong sink variability):\n    - Emissions: $E_t = 9.5$ in GtC/yr for all $t$.\n    - Atmospheric growth: $G_t = 0.45\\,E_t + 1.0\\,\\sin\\left(2\\pi t / 10\\right)$ in GtC/yr.\n\nAlgorithmic requirements and definitions to follow in your program:\n- Annual airborne fraction for year $t$ is well-defined only when $E_t > 0$, and is the unitless ratio consistent with mass conservation between $G_t$ and $E_t$ for that year.\n- The decadal airborne fraction is the unique unitless ratio consistent with mass conservation between $\\sum_t G_t$ and $\\sum_t E_t$ over the decade. If $\\sum_t E_t = 0$, set the diagnostic flag $d=0$ and define $a_f$ as not-a-number to indicate undefined.\n- For variance decomposition of annual airborne fraction $A_t$, use valid years with $E_t > 0$ and compute means $\\bar{E}$ and $\\bar{G}$ over those years. Let $e_t = E_t - \\bar{E}$ and $g_t = G_t - \\bar{G}$. Using a first-order perturbation of $A_t$ about $(\\bar{E},\\bar{G})$, the approximate variance contributions are functions of $\\mathrm{Var}(e_t)$, $\\mathrm{Var}(g_t)$, and $\\mathrm{Cov}(g_t,e_t)$ along with $\\bar{E}$ and $\\bar{G}$. Report the shares $s_e$, $s_g$, and $s_c$ as the contributions divided by the total variance of $A_t$. If the variance of $A_t$ is zero, set $s_e=s_g=s_c=0$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[[0.5,0.1,0.3,0.7,0.0,1],[\\dots],[\\dots]]$).",
            "solution": "The problem is evaluated as valid. It is scientifically grounded in the principle of mass conservation as applied to the global carbon cycle, a core concept in climate science. The problem is well-posed, providing all necessary data, explicit functional forms, and clear, unambiguous definitions for the quantities to be computed. The terminology used, such as airborne fraction, anthropogenic emissions, and atmospheric growth, are standard in the field. The mathematical task, involving time series analysis and a first-order perturbation for variance decomposition, is a standard and appropriate technique for sensitivity analysis. The problem is objective, quantitative, and free of any logical contradictions or factual inaccuracies.\n\nThe solution proceeds by first establishing the theoretical framework and then deriving the formulas for the required quantities.\n\nThe foundational principle is the conservation of mass for atmospheric carbon. The rate of change of the mass of carbon in the atmosphere, known as the atmospheric growth rate ($G_t$), is equal to the rate of anthropogenic emissions ($E_t$) minus the rate of uptake by natural sinks (ocean and land), $S_{nat}$.\n$$ \\frac{dC_{atm}}{dt} = G_t = E_t - S_{nat, t} $$\nAll quantities are measured in gigatonnes of carbon per year ($GtC/yr$).\n\n1.  **Airborne Fraction ($a_f$ and $A_t$)**\n    The airborne fraction is the dimensionless ratio of the atmospheric growth to the anthropogenic emissions over a given time period.\n\n    The **annual airborne fraction** for a specific year $t$ is defined as:\n    $$ A_t = \\frac{G_t}{E_t} $$\n    This quantity is only physically and mathematically meaningful when emissions are strictly positive, i.e., $E_t > 0$.\n\n    The **decadal airborne fraction** ($a_f$) is defined based on the total mass conservation over the entire decade ($t=0$ to $t=9$). It is the ratio of the total mass of carbon that accumulated in the atmosphere over the decade to the total mass of carbon emitted over the same period. Assuming annual time steps ($\\Delta t = 1$ year), this is:\n    $$ a_f = \\frac{\\text{Total Atmospheric Growth}}{\\text{Total Emissions}} = \\frac{\\sum_{t=0}^{9} G_t}{\\sum_{t=0}^{9} E_t} $$\n    This value is undefined if the total decadal emissions $\\sum_{t=0}^{9} E_t = 0$. The diagnostic flag $d$ is set to $1$ if $\\sum_{t=0}^{9} E_t > 0$, and $0$ otherwise.\n\n2.  **Interannual Variability ($a_\\sigma$)**\n    The interannual variability of the airborne fraction is quantified by the standard deviation of the annual airborne fraction series, $A_t$. This calculation is performed only over the set of years $\\mathcal{T}_{valid}$ for which $E_t > 0$. Let $N_{valid}$ be the number of such years. The standard deviation, $a_\\sigma$, is:\n    $$ a_\\sigma = \\sqrt{\\frac{1}{N_{valid}} \\sum_{t \\in \\mathcal{T}_{valid}} (A_t - \\bar{A})^2} $$\n    where $\\bar{A}$ is the mean of the annual airborne fraction over the valid years:\n    $$ \\bar{A} = \\frac{1}{N_{valid}} \\sum_{t \\in \\mathcal{T}_{valid}} A_t $$\n    We use the population standard deviation, as the decade represents the entire population of interest.\n\n3.  **Variance Decomposition ($s_e, s_g, s_c$)**\n    To decompose the variance of the annual airborne fraction, $\\mathrm{Var}(A_t)$, into components attributable to the variability in emissions ($E_t$) and atmospheric growth ($G_t$), we use a first-order Taylor expansion (perturbation analysis). The analysis is performed on the data from the valid years, $\\mathcal{T}_{valid}$.\n\n    Let $\\bar{E}$ and $\\bar{G}$ be the mean emissions and mean growth over these valid years. We express the annual values as a mean plus a perturbation:\n    $$ E_t = \\bar{E} + e_t $$\n    $$ G_t = \\bar{G} + g_t $$\n    where $e_t$ and $g_t$ are the deviations from the mean for year $t$.\n\n    The annual airborne fraction $A_t$ can be written as:\n    $$ A_t = \\frac{G_t}{E_t} = \\frac{\\bar{G} + g_t}{\\bar{E} + e_t} = \\frac{\\bar{G}}{\\bar{E}} \\left( \\frac{1 + g_t/\\bar{G}}{1 + e_t/\\bar{E}} \\right) $$\n    Using the first-order approximation $(1+x)^{-1} \\approx 1-x$ for small $x = e_t/\\bar{E}$, we get:\n    $$ A_t \\approx \\frac{\\bar{G}}{\\bar{E}} (1 + g_t/\\bar{G})(1 - e_t/\\bar{E}) \\approx \\frac{\\bar{G}}{\\bar{E}} \\left(1 + \\frac{g_t}{\\bar{G}} - \\frac{e_t}{\\bar{E}} \\right) $$\n    where we have neglected the second-order term $(g_t e_t)/(\\bar{G}\\bar{E})$. This simplifies to the first-order approximation of $A_t$:\n    $$ A_t \\approx \\frac{\\bar{G}}{\\bar{E}} + \\frac{g_t}{\\bar{E}} - \\frac{\\bar{G} e_t}{\\bar{E}^2} $$\n    The variance of this approximate expression for $A_t$ is:\n    $$ \\mathrm{Var}(A_t) \\approx \\mathrm{Var}\\left( \\frac{g_t}{\\bar{E}} - \\frac{\\bar{G} e_t}{\\bar{E}^2} \\right) $$\n    Using the property $\\mathrm{Var}(aX + bY) = a^2\\mathrm{Var}(X) + b^2\\mathrm{Var}(Y) + 2ab\\mathrm{Cov}(X,Y)$, this expands to:\n    $$ \\mathrm{Var}(A_t) \\approx \\frac{1}{\\bar{E}^2}\\mathrm{Var}(g_t) + \\frac{\\bar{G}^2}{\\bar{E}^4}\\mathrm{Var}(e_t) - \\frac{2\\bar{G}}{\\bar{E}^3}\\mathrm{Cov}(g_t, e_t) $$\n    Since $\\mathrm{Var}(g_t) = \\mathrm{Var}(G_t)$, $\\mathrm{Var}(e_t) = \\mathrm{Var}(E_t)$, and $\\mathrm{Cov}(g_t, e_t) = \\mathrm{Cov}(G_t, E_t)$, we can identify the three contributions to the approximate variance:\n    -   Contribution from growth variability: $V_g = \\frac{\\mathrm{Var}(G_t)}{\\bar{E}^2}$\n    -   Contribution from emissions variability: $V_e = \\frac{\\bar{G}^2 \\mathrm{Var}(E_t)}{\\bar{E}^4}$\n    -   Contribution from covariance: $V_c = -\\frac{2\\bar{G} \\mathrm{Cov}(G_t, E_t)}{\\bar{E}^3}$\n\n    The problem requires expressing these contributions as shares of the total *actual* variance of the annual airborne fraction, $\\sigma_A^2 = \\mathrm{Var}(A_t)$, computed directly from the series $\\{A_t\\}_{t \\in \\mathcal{T}_{valid}}$. The shares are therefore:\n    $$ s_g = \\frac{V_g}{\\sigma_A^2} \\quad, \\quad s_e = \\frac{V_e}{\\sigma_A^2} \\quad, \\quad s_c = \\frac{V_c}{\\sigma_A^2} $$\n    If $\\sigma_A^2 = 0$, all shares are defined to be $0$. Note that because this is a first-order approximation, the sum of a shares $s_e + s_g + s_c$ is not guaranteed to be equal to $1$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_metrics(E_t, G_t):\n    \"\"\"\n    Computes carbon cycle metrics for a given decadal time series.\n\n    Args:\n        E_t (np.ndarray): Time series of anthropogenic emissions (GtC/yr).\n        G_t (np.ndarray): Time series of atmospheric growth (GtC/yr).\n\n    Returns:\n        list: A list containing [a_f, a_sigma, s_e, s_g, s_c, d].\n    \"\"\"\n    sum_E = np.sum(E_t)\n\n    # Check for non-positive total decadal emissions\n    if not sum_E > 0:\n        d = 0\n        a_f = np.nan\n        a_sigma = np.nan\n        s_e, s_g, s_c = np.nan, np.nan, np.nan\n        return [a_f, a_sigma, s_e, s_g, s_c, d]\n    \n    d = 1\n    \n    # 1. Decadal airborne fraction\n    sum_G = np.sum(G_t)\n    a_f = sum_G / sum_E\n    \n    # 2. Interannual variability\n    # Identify valid years where annual AF is well-defined (E_t > 0)\n    valid_indices = E_t > 0\n    E_valid = E_t[valid_indices]\n    G_valid = G_t[valid_indices]\n    \n    if E_valid.size == 0:\n        # No years with positive emissions, so no basis for interannual variability\n        return [a_f, 0.0, 0.0, 0.0, 0.0, d]\n        \n    A_t_valid = G_valid / E_valid\n    a_sigma = np.std(A_t_valid)  # Population standard deviation (ddof=0 is default)\n    \n    # 3. Variance Decomposition\n    var_A = np.var(A_t_valid) # Population variance (ddof=0 is default)\n    \n    # Per problem spec, if variance is zero, all shares are zero.\n    if np.isclose(var_A, 0):\n        s_e, s_g, s_c = 0.0, 0.0, 0.0\n    else:\n        # Calculate means, variances, and covariance over valid years\n        E_bar = np.mean(E_valid)\n        G_bar = np.mean(G_valid)\n        \n        var_E = np.var(E_valid)\n        var_G = np.var(G_valid)\n        \n        # Must use ddof=0 for population covariance to be consistent\n        cov_GE = np.cov(G_valid, E_valid, ddof=0)[0, 1]\n        \n        # First-order perturbation contributions to variance\n        V_g = var_G / (E_bar**2)\n        V_e = (G_bar**2 * var_E) / (E_bar**4)\n        V_c = (-2 * G_bar * cov_GE) / (E_bar**3)\n        \n        # Shares of total actual variance\n        s_g = V_g / var_A\n        s_e = V_e / var_A\n        s_c = V_c / var_A\n        \n    return [a_f, a_sigma, s_e, s_g, s_c, d]\n\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the final result.\n    \"\"\"\n    all_results = []\n    \n    # Define the time vector for the decade\n    t = np.arange(10, dtype=float)\n\n    # --- Test Case A ---\n    E_t_A = 10.0 + 0.2 * (t - 4.5) + 0.1 * np.cos(np.pi * t / 5.0)\n    G_t_A = 0.48 * E_t_A + 0.5 * np.sin(2.0 * np.pi * t / 10.0) + 0.05 * np.cos(np.pi * t / 5.0)\n    results_A = calculate_metrics(E_t_A, G_t_A)\n    all_results.append(results_A)\n\n    # --- Test Case B ---\n    E_t_B = np.array([0.0, 0.5, 1.0, 1.5, 2.0, 1.5, 1.0, 0.5, 0.0, 0.5])\n    G_t_B = 0.55 * E_t_B + 0.1 * np.sin(2.0 * np.pi * t / 10.0)\n    results_B = calculate_metrics(E_t_B, G_t_B)\n    all_results.append(results_B)\n\n    # --- Test Case C ---\n    E_t_C = np.full_like(t, 9.5)\n    G_t_C = 0.45 * E_t_C + 1.0 * np.sin(2.0 * np.pi * t / 10.0)\n    results_C = calculate_metrics(E_t_C, G_t_C)\n    all_results.append(results_C)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        }
    ]
}