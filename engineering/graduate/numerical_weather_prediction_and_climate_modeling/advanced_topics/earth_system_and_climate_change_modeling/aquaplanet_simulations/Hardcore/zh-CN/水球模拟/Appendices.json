{
    "hands_on_practices": [
        {
            "introduction": "水行星模型依赖于对海洋和大气之间能量交换的精确参数化，而潜热通量是大气环流的主要驱动力之一。本练习将实践应用整体空气动力学公式，这是在气候模型中估算地表通量的基本工具。通过计算潜热通量及其对风速的敏感性，您将深入了解海气相互作用的关键机制 。",
            "id": "4011849",
            "problem": "考虑一个为数值天气预报和气候模拟配置的中纬度水行星。该水行星全球被海洋覆盖，水平均一，并具有均一的海洋表面性质，无大陆边界。关注纬度$45^{\\circ}$海洋上的中性大气边界层，并假设条件是稳定、水平均匀的。设参考高度 $z=10$ 米处的近地表空气比湿为 $q_a$，海平面的饱和比湿为 $q_s$，以及 $z=10$ 米处的风速为 $U$。假设在中性稳定条件下，整体输送描述是有效的，且水汽交换系数 $C_E$ 为常数。\n\n从中性稳定条件下的水汽守恒、雷诺分解和湍流通量-梯度假设出发，推导海-气潜热通量的适当的整体空气动力学表达式。使用此表达式计算指定的中纬度水行星案例的潜热通量，然后评估在此状态下潜热通量对风速的敏感性。\n\n给定：\n- 空气密度 $\\rho_a = 1.225\\,\\text{kg m}^{-3}$，\n- 蒸发潜热 $L_v = 2.5 \\times 10^{6}\\,\\text{J kg}^{-1}$，\n- 中性整体水汽交换系数 $C_E = 1.2 \\times 10^{-3}$，\n- $z=10\\,$ 米处的风速 $U = 8\\,\\text{m s}^{-1}$，\n- 海平面饱和比湿 $q_s = 0.017\\,\\text{kg kg}^{-1}$，\n- $z=10\\,$ 米处的近地表空气比湿 $q_a = 0.012\\,\\text{kg kg}^{-1}$。\n\n任务：\n1. 使用第一性原理，推导适用于具有均一表面性质的水行星的中性海洋大气表面层的潜热通量的整体空气动力学形式。\n2. 使用推导的表达式和给定值计算潜热通量。以 $\\text{W m}^{-2}$ 为单位表示潜热通量，并四舍五入到四位有效数字。\n3. 在固定的 $q_s$、$q_a$、$C_E$、$\\rho_a$ 和 $L_v$下，定义风速敏感度 $S_U = \\partial F_E / \\partial U$。对给定状态，数值计算 $S_U$。以 $\\text{W m}^{-2} (\\text{m s}^{-1})^{-1}$ 为单位表示 $S_U$，并将最终答案四舍五入到四位有效数字。\n\n仅提供风速敏感度 $S_U$ 作为最终答案。",
            "solution": "首先对问题陈述进行验证。\n\n### 步骤1：提取给定条件\n- **背景设定**：一个位于纬度 $45^{\\circ}$ 的中纬度水行星，其全球均一海洋上有一个中性大气边界层。条件是稳定且水平均匀的。\n- **参考高度**：$z = 10\\,$ m。\n- **参考高度处的变量**：\n    - 近地表空气比湿：$q_a$。\n    - 风速：$U$。\n- **地表变量**：\n    - 海平面饱和比湿：$q_s$。\n- **模型**：整体输送描述在水汽交换系数 $C_E$ 为常数的中性稳定条件下有效。\n- **常数和给定值**：\n    - 空气密度：$\\rho_a = 1.225\\,\\text{kg m}^{-3}$。\n    - 蒸发潜热：$L_v = 2.5 \\times 10^{6}\\,\\text{J kg}^{-1}$。\n    - 中性整体水汽交换系数：$C_E = 1.2 \\times 10^{-3}$。\n    - $z=10\\,$ 米处的风速：$U = 8\\,\\text{m s}^{-1}$。\n    - 海平面饱和比湿：$q_s = 0.017\\,\\text{kg kg}^{-1}$。\n    - $z=10\\,$ 米处的近地表空气比湿：$q_a = 0.012\\,\\text{kg kg}^{-1}$。\n\n### 步骤2：使用提取的给定条件进行验证\n- **科学依据**：该问题很好地基于边界层气象学和海-气相互作用的原理。水行星的概念、整体空气动力学公式、雷诺分解和通量-梯度假设是气候模拟和数值天气预报中的标准工具。所提供的物理常数和状态变量对于中纬度海洋环境是现实的。\n- **适定性**：该问题是适定的。它提供了所有必要的信息和一组清晰的任务，从而导出一个唯一的、可计算的解。\n- **客观性**：该问题使用精确、客观的科学语言陈述，没有任何主观性或歧义。\n- **完整性和一致性**：该问题是自洽且内部一致的。稳定、水平均匀的假设是标准的简化，定义了推导和应用整体公式的物理机制。\n- **可行性和现实性**：数值是物理上现实的。例如，$q_s > q_a$ 表明存在一个从海洋到大气的向上的湿度梯度，这驱动了蒸发，是一个典型的情景。\n\n### 步骤3：结论与行动\n该问题被认为是 **有效的**，因为它是科学合理的、适定的、客观的且内部一致的。将提供解答。\n\n---\n\n### 任务1：潜热通量整体空气动力学公式的推导\n\n推导始于一个标量（在此情况下为水汽，由比湿 $q$ 表示）的守恒。使用雷诺分解，任何瞬时量都可以写成平均分量（上划线）和湍流脉动（撇号）之和，例如，$w = \\bar{w} + w'$ 和 $q = \\bar{q} + q'$。对于假设的稳态（$\\frac{\\partial}{\\partial t} = 0$）和水平均匀（$\\frac{\\partial}{\\partial x} = \\frac{\\partial}{\\partial y} = 0$）条件，并假设平均垂直速度为零（$\\bar{w} = 0$），平均比湿的守恒方程简化为表明湍流通量的垂直散度为零：\n$$\n\\frac{\\partial (\\overline{w'q'})}{\\partial z} = 0\n$$\n这意味着在大气表面层中，水汽的湍流运动学通量 $E = \\overline{w'q'}$ 随高度是恒定的。\n\n湍流通量-梯度假设（K-理论）将此通量与比湿的平均梯度联系起来：\n$$\nE = \\overline{w'q'} = -K_E \\frac{d\\bar{q}}{dz}\n$$\n其中 $K_E$ 是水汽的涡动扩散系数。负号表示通量沿着梯度的反方向（即从高浓度到低浓度）。\n\n这个方程可以从地表积分到参考高度 $z_r = 10\\,$ m。然而，问题要求的是一个整体空气动力学表达式，它是对此湍流输送积分结果的参数化。整体公式直接将通量与参考高度和地表的平均量联系起来。水汽的质量通量 $F_q$（单位为 $\\text{kg m}^{-2} \\text{s}^{-1}$）由以下公式给出：\n$$\nF_q = \\rho_a C_E U (q_s - q_a)\n$$\n这里，$\\rho_a$ 是空气密度，$U$ 是参考高度的风速，$(q_s - q_a)$ 是海平面与参考高度空气之间的比湿差，而 $C_E$ 是无量纲的水汽整体交换系数（也称为道尔顿数）。这个表达式将复杂的湍流输送直接参数化为平均状态变量的简单乘积。\n\n潜热通量 $F_E$（单位为 $\\text{W m}^{-2}$ 或 $\\text{J s}^{-1} \\text{m}^{-2}$）是与水的相变相关的能量通量。它是通过将水汽质量通量 $F_q$ 乘以蒸发潜热 $L_v$ 得到的：\n$$\nF_E = L_v F_q\n$$\n代入 $F_q$ 的表达式，我们得到潜热通量的整体空气动力学公式：\n$$\nF_E = \\rho_a L_v C_E U (q_s - q_a)\n$$\n这就是所要求的表达式。它在问题指定的中性稳定条件下有效。\n\n### 任务2：潜热通量（$F_E$）的计算\n\n使用推导的表达式和给定值：\n- $\\rho_a = 1.225\\,\\text{kg m}^{-3}$\n- $L_v = 2.5 \\times 10^{6}\\,\\text{J kg}^{-1}$\n- $C_E = 1.2 \\times 10^{-3}$\n- $U = 8\\,\\text{m s}^{-1}$\n- $q_s = 0.017\\,\\text{kg kg}^{-1}$\n- $q_a = 0.012\\,\\text{kg kg}^{-1}$\n\n首先，计算比湿差：\n$$\nq_s - q_a = 0.017 - 0.012 = 0.005\n$$\n现在，将所有值代入 $F_E$ 的公式：\n$$\nF_E = (1.225) \\times (2.5 \\times 10^{6}) \\times (1.2 \\times 10^{-3}) \\times (8) \\times (0.005)\n$$\n$$\nF_E = (1.225 \\times 2.5 \\times 1.2 \\times 8 \\times 0.005) \\times (10^{6} \\times 10^{-3})\n$$\n$$\nF_E = (29.4 \\times 0.005) \\times 10^{3}\n$$\n$$\nF_E = 0.147 \\times 10^{3}\n$$\n$$\nF_E = 147.0 \\, \\text{W m}^{-2}\n$$\n潜热通量为 $147.0\\,$ W m$^{-2}$，四舍五入到四位有效数字。\n\n### 任务3：风速敏感度（$S_U$）的评估\n\n风速敏感度 $S_U$ 定义为潜热通量 $F_E$ 对风速 $U$ 的偏导数，同时保持所有其他参数不变：\n$$\nS_U = \\frac{\\partial F_E}{\\partial U}\n$$\n我们将此算子应用于推导出的 $F_E$ 表达式：\n$$\nS_U = \\frac{\\partial}{\\partial U} \\left[ \\rho_a L_v C_E U (q_s - q_a) \\right]\n$$\n由于 $\\rho_a$、$L_v$、$C_E$、$q_s$ 和 $q_a$ 保持不变，所以 $F_E$ 的表达式是关于 $U$ 的线性函数。因此，导数是乘以 $U$ 的常数系数的集合：\n$$\nS_U = \\rho_a L_v C_E (q_s - q_a)\n$$\n这个表达式也可以看作是 $F_E / U$。我们现在可以计算 $S_U$ 的数值：\n$$\nS_U = (1.225) \\times (2.5 \\times 10^{6}) \\times (1.2 \\times 10^{-3}) \\times (0.017 - 0.012)\n$$\n$$\nS_U = (1.225) \\times (2.5 \\times 10^{6}) \\times (1.2 \\times 10^{-3}) \\times (0.005)\n$$\n$$\nS_U = (1.225 \\times 2.5 \\times 1.2 \\times 0.005) \\times (10^{6} \\times 10^{-3})\n$$\n$$\nS_U = (0.018375) \\times 10^{3}\n$$\n$$\nS_U = 18.375 \\, \\text{W m}^{-2} \\, (\\text{m s}^{-1})^{-1}\n$$\n根据问题要求，四舍五入到四位有效数字：\n$$\nS_U = 18.38 \\, \\text{W m}^{-2} \\, (\\text{m s}^{-1})^{-1}\n$$\n这是所要求的最终答案。",
            "answer": "$$\n\\boxed{18.38}\n$$"
        },
        {
            "introduction": "理解气候系统如何响应不同时间尺度的强迫至关重要，上层海洋作为一个巨大的热库，对温度波动起着调节作用。在本练习中，您将为一个“平板海洋”构建一个简单的能量平衡模型，以探究其热惯性如何影响地表温度 。这个练习将演示混合层深度 $H_m$ 如何抑制气候系统对高频（天气尺度）和低频（类季节尺度）强迫的响应，这是气候变率中的一个核心概念。",
            "id": "4011831",
            "problem": "您的任务是，从第一性原理出发，形式化并计算一个水行星的表面温度响应对海洋混合层深度变化的敏感性。考虑一个由均匀混合层深度为 $H_m$ 的板状海洋所代表的水行星，该海洋与大气交换能量。该行星没有轨道季节（无轨道倾角和恒定的日照），因此任何类似季节的变化都必须源于一个施加的、理想化的周期性强迫。假设以下物理设置：\n\n- 表面混合层的单位面积热容为 $C = \\rho_w c_p H_m$，其中 $\\rho_w$ 是海水密度， $c_p$ 是海水在恒压下的比热容， $H_m$ 是混合层深度。\n- 表面能量平衡是一个一阶线性系统：表面温度 $T(t)$ 的变化趋势由外部强迫和线性辐射反馈控制。外部强迫可以代表一个假设的“类季节性”循环或天气尺度变化，每个都被理想化为角频率为 $\\omega$、振幅为 $F_0$ 的正弦热通量。辐射反馈与温度成正比，反馈参数为 $\\lambda$。\n- 混合层温度的控制方程遵循能量守恒和线性反馈：混合层能量的变化率等于净表面通量减去反馈项。\n\n仅使用这些基础，从第一性原理推导出表面温度对正弦热通量强迫的响应的归一化振幅比（相对于零惯性极限）。然后，实现一个程序来评估指定测试用例的该归一化比率。归一化比率定义为在有限 $H_m$ 下 $T(t)$ 的稳态振幅与在 $H_m \\to 0$ 极限下的振幅之比。根据其构造，该比率是无量纲的。\n\n采用以下科学上现实的参数值：\n- 海水密度 $\\rho_w = 1025\\,\\text{kg m}^{-3}$，\n- 海水比热容 $c_p = 3990\\,\\text{J kg}^{-1} \\text{K}^{-1}$，\n- 气候反馈参数 $\\lambda = 1.2\\,\\text{W m}^{-2} \\text{K}^{-1}$。\n\n角频率的单位定义为弧度/秒。如果指定了周期 $P$（单位为天），则使用 $P_s = P \\times 86400$ 将其转换为秒，并计算 $\\omega = 2\\pi / P_s$。\n\n您的程序必须为每个测试用例计算温度响应的归一化振幅比，针对两种不同的强迫：\n- 周期为 $P_\\text{syn} = 4$ 天的天气尺度强迫（中心天气时间尺度），\n- 周期为 $P_\\text{seas} = 365$ 天的假设类季节性强迫（类年度时间尺度），尽管该水行星没有轨道季节。这量化了如果施加此类低频强迫可能产生的阻尼效应。\n\n此外，为了探究边界条件，包括一个 $H_m = 50\\,\\text{m}$ 时的零频率情况（$\\omega = 0$），并报告其归一化比率。\n\n单位和格式要求：\n- 所有输出都是无量纲的归一化振幅比。\n- 将最终数值输出表示为四舍五入到六位小数的浮点数。\n\n测试套件：\n计算混合层深度 $H_m$ (单位:米) 为 $10$、$25$、$50$ 和 $100$ 时的归一化振幅比。对于每个 $H_m$，按以下顺序计算两个值：首先是 $P_\\text{syn} = 4$ 天的情况，然后是 $P_\\text{seas} = 365$ 天的情况。在这八个值之后，附加上 $H_m = 50$ 米时的零频率边界情况。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，“[result1,result2,...]”）。顺序必须是：\n$[$G_\\text{syn}(10)$, $G_\\text{seas}(10)$, $G_\\text{syn}(25)$, $G_\\text{seas}(25)$, $G_\\text{syn}(50)$, $G_\\text{seas}(50)$, $G_\\text{syn}(100)$, $G_\\text{seas}(100)$, $G_\\text{zero}(50)]$，\n其中每个 $G$ 表示指定情况下的归一化振幅比。",
            "solution": "用户提供了一个来自物理海洋学和气候动力学领域的、定义明确的问题陈述。该问题在科学上基于热力学第一定律（能量守恒），并使用了一个标准的理想化模型，即用于板状海洋的零维能量平衡模型（EBM）。所有参数都已提供且物理上是现实的。因此，该问题是有效的。\n\n任务是推导表面温度对正弦强迫响应的归一化振幅比。该比率定义为有限混合层深度 $H_m$ 下的振幅除以零惯性极限（$H_m \\to 0$）下的振幅。\n\n**步骤 1：构建控制常微分方程 (ODE)**\n\n该问题受海洋混合层能量守恒原理的支配。单位面积混合层中储存的能量变化率等于进入表面的净能量通量。\n\n单位面积储存的能量 $E$ 由单位面积热容 $C$ 和表面温度 $T(t)$ 的乘积给出。\n$$E = C T(t)$$\n单位面积热容 $C$ 定义为：\n$$C = \\rho_w c_p H_m$$\n其中 $\\rho_w$ 是海水密度， $c_p$ 是海水比热容， $H_m$ 是混合层深度。\n\n该能量的变化率为：\n$$\\frac{dE}{dt} = \\frac{d}{dt}(C T(t)) = C \\frac{dT}{dt} = \\rho_w c_p H_m \\frac{dT}{dt}$$\n\n进入表面的净能量通量是外部强迫和辐射反馈之和。\n外部强迫是一个正弦热通量，我们可以用复数形式表示为 $F(t) = F_0 e^{i\\omega t}$，其中 $F_0$ 是实数振幅，$\\omega$ 是角频率。\n辐射反馈是一个线性恢复项，代表向外的长波辐射。它与表面温度成正比，即 $-\\lambda T(t)$，其中 $\\lambda$ 是气候反馈参数。负号表示正温度异常会导致系统能量损失。\n\n将能量变化率与净通量相等，我们得到控制ODE：\n$$\\rho_w c_p H_m \\frac{dT}{dt} = F_0 e^{i\\omega t} - \\lambda T(t)$$\n将其整理成一阶线性ODE的标准形式可得：\n$$\\rho_w c_p H_m \\frac{dT}{dt} + \\lambda T(t) = F_0 e^{i\\omega t}$$\n\n**步骤 2：求解稳态振幅**\n\n我们寻求该受迫ODE的稳态（或特解）解。解的瞬态（齐次）部分随时间衰减。我们假设解的形式为 $T(t) = \\hat{T} e^{i\\omega t}$，其中 $\\hat{T}$ 是温度响应的复振幅。\n\n其导数为 $\\frac{dT}{dt} = i\\omega \\hat{T} e^{i\\omega t}$。将假设的解及其导数代入ODE中：\n$$\\rho_w c_p H_m (i\\omega \\hat{T} e^{i\\omega t}) + \\lambda (\\hat{T} e^{i\\omega t}) = F_0 e^{i\\omega t}$$\n我们可以用含时项 $e^{i\\omega t}$ 两边相除：\n$$i\\omega \\rho_w c_p H_m \\hat{T} + \\lambda \\hat{T} = F_0$$\n现在，我们求解复振幅 $\\hat{T}$：\n$$\\hat{T} ( \\lambda + i\\omega \\rho_w c_p H_m ) = F_0$$\n$$\\hat{T} = \\frac{F_0}{\\lambda + i\\omega \\rho_w c_p H_m}$$\n\n温度振荡的物理振幅，记为 $A_T$，是复振幅 $\\hat{T}$ 的模：\n$$A_T = |\\hat{T}| = \\left| \\frac{F_0}{\\lambda + i\\omega \\rho_w c_p H_m} \\right| = \\frac{|F_0|}{|\\lambda + i\\omega \\rho_w c_p H_m|}$$\n由于 $F_0$ 是一个实数正振幅，所以 $|F_0| = F_0$。复数分母的模为 $\\sqrt{(\\text{Re})^2 + (\\text{Im})^2}$。\n$$A_T(H_m, \\omega) = \\frac{F_0}{\\sqrt{\\lambda^2 + (\\omega \\rho_w c_p H_m)^2}}$$\n\n**步骤 3：确定零惯性极限下的振幅**\n\n问题要求相对于“零惯性极限”进行归一化，这对应于混合层深度趋近于零，$H_m \\to 0$。我们用 $A_{T,0}$ 表示此极限下的振幅。\n$$A_{T,0}(\\omega) = \\lim_{H_m \\to 0} A_T(H_m, \\omega) = \\lim_{H_m \\to 0} \\frac{F_0}{\\sqrt{\\lambda^2 + (\\omega \\rho_w c_p H_m)^2}}$$\n当 $H_m \\to 0$ 时，项 $(\\omega \\rho_w c_p H_m)^2 \\to 0$。因此，极限为：\n$$A_{T,0} = \\frac{F_0}{\\sqrt{\\lambda^2 + 0}} = \\frac{F_0}{\\lambda}$$\n这个结果在物理上是直观的：在零热惯性的情况下，表面温度与强迫处于瞬时平衡状态，因此辐射反馈通量 $\\lambda T$ 必须平衡强迫通量。\n\n**步骤 4：推导归一化振幅比**\n\n归一化振幅比 $G$ 定义为有限深度振幅 $A_T$ 与零惯性振幅 $A_{T,0}$ 之比。\n$$G(H_m, \\omega) = \\frac{A_T(H_m, \\omega)}{A_{T,0}}$$\n$$G(H_m, \\omega) = \\frac{\\frac{F_0}{\\sqrt{\\lambda^2 + (\\omega \\rho_w c_p H_m)^2}}}{\\frac{F_0}{\\lambda}}$$\n强迫振幅 $F_0$ 被消掉了：\n$$G(H_m, \\omega) = \\frac{\\lambda}{\\sqrt{\\lambda^2 + (\\omega \\rho_w c_p H_m)^2}}$$\n通过从平方根中提出因子 $\\lambda$ 可以简化此表达式：\n$$G(H_m, \\omega) = \\frac{\\lambda}{\\lambda \\sqrt{1 + \\frac{(\\omega \\rho_w c_p H_m)^2}{\\lambda^2}}} = \\frac{1}{\\sqrt{1 + \\left(\\frac{\\omega \\rho_w c_p H_m}{\\lambda}\\right)^2}}$$\n这就是归一化振幅比的最终公式。它描述了一个低通滤波器的行为，其中响应在较高频率 $\\omega$ 或较大热惯性（与 $H_m$ 成正比）时被衰减。\n\n**步骤 5：分析零频率情况**\n\n对于零频率的特殊情况，$\\omega = 0$：\n$$G(H_m, 0) = \\frac{1}{\\sqrt{1 + \\left(\\frac{0 \\cdot \\rho_w c_p H_m}{\\lambda}\\right)^2}} = \\frac{1}{\\sqrt{1+0}} = 1$$\n这意味着对于一个恒定的强迫（$\\omega = 0$），稳态温度响应与混合层热容无关。最终的平衡完全由反馈参数 $\\lambda$ 决定。因此，归一化比率总是 $1$。问题要求计算 $H_m = 50\\,\\text{m}$ 时的这个值，该值将为 $1.0$。\n\n**步骤 6：实施计划**\n\n程序将使用提供的物理常量和测试用例来实现推导出的公式 $G(H_m, \\omega)$。\n- 常量：$\\rho_w = 1025\\,\\text{kg m}^{-3}$，$c_p = 3990\\,\\text{J kg}^{-1} \\text{K}^{-1}$，$\\lambda = 1.2\\,\\text{W m}^{-2} \\text{K}^{-1}$。\n- 从周期 $P$（天）到角频率 $\\omega$ 的转换：$\\omega = 2\\pi / (P \\times 86400)$。\n- 程序将遍历指定的 $H_m$ 值（$10$、$25$、$50$、$100\\,\\text{m}$），并为 $P_\\text{syn} = 4\\,\\text{天}$ 和 $P_\\text{seas} = 365\\,\\text{天}$ 计算 $G$。\n- 最后，它将附加 $H_m=50\\,\\text{m}$ 时 $\\omega = 0$ 情况的结果，即 $1.0$。\n- 所有结果将格式化为六位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the sensitivity of an aquaplanet's surface temperature response\n    to changes in ocean mixed-layer depth.\n    \"\"\"\n\n    # --- Given Physical Parameters ---\n    # Seawater density in kg/m^3\n    RHO_W = 1025.0\n    # Seawater specific heat capacity in J/(kg*K)\n    C_P = 3990.0\n    # Climate feedback parameter in W/(m^2*K)\n    LAMBDA = 1.2\n\n    # --- Test Case Definitions ---\n    # Mixed-layer depths in meters\n    H_m_values = [10.0, 25.0, 50.0, 100.0]\n    # Forcing periods in days\n    P_syn = 4.0  # Synoptic-scale\n    P_seas = 365.0 # Seasonal-like\n\n    def calculate_normalized_ratio(Hm, P_days):\n        \"\"\"\n        Calculates the normalized amplitude ratio G(Hm, omega).\n\n        Args:\n            Hm (float): Mixed-layer depth in meters.\n            P_days (float): Forcing period in days. If 0, assumes zero frequency.\n\n        Returns:\n            float: The unitless normalized amplitude ratio.\n        \"\"\"\n        # Handle the zero-frequency case, where omega = 0\n        if P_days == 0:\n            return 1.0\n\n        # Convert period from days to seconds\n        P_seconds = P_days * 86400.0\n        # Calculate angular frequency in rad/s\n        omega = 2 * np.pi / P_seconds\n\n        # Calculate heat capacity per unit area in J/(m^2*K)\n        C = RHO_W * C_P * Hm\n\n        # The core argument inside the square root\n        arg = (omega * C) / LAMBDA\n\n        # Derived formula for the normalized amplitude ratio G\n        # G = 1 / sqrt(1 + (omega * C / lambda)^2)\n        ratio = 1.0 / np.sqrt(1.0 + arg**2)\n\n        return ratio\n\n    # List to store the results in the required order\n    results = []\n\n    # Iterate through each mixed-layer depth\n    for Hm in H_m_values:\n        # 1. Synoptic-scale forcing\n        g_syn = calculate_normalized_ratio(Hm, P_syn)\n        results.append(g_syn)\n\n        # 2. Seasonal-like forcing\n        g_seas = calculate_normalized_ratio(Hm, P_seas)\n        results.append(g_seas)\n\n    # 3. Append the special zero-frequency case for Hm = 50m\n    # As derived, the result for omega=0 is always 1, independent of Hm.\n    # We pass P_days=0 to the function to handle this case.\n    g_zero = calculate_normalized_ratio(50.0, 0)\n    results.append(g_zero)\n\n    # Format the results to six decimal places and create the final output string\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    output_string = f\"[{','.join(formatted_results)}]\"\n\n    # Final print statement in the exact required format.\n    print(output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "诸如热带辐合带（ITCZ）这样的大尺度大气特征，是由基本守恒定律支配的气候系统的涌现属性，从模型输出或观测数据中诊断这些特征是一项关键技能。这个高级练习将指导您通过实现整层水汽收支方程来诊断降水，即 $P = E - \\nabla \\cdot \\mathbf{F}_q - \\partial_t W$ 。通过计算蒸发、水汽储存和水汽通量辐合，您将能确定ITCZ的位置，并探究其如何响应海表温度的变化，从而将基础物理学与大尺度气候动力学联系起来。",
            "id": "4011842",
            "problem": "考虑一个理想化的水行星，即一个完全被海洋覆盖且具有纬向均匀条件的行星，用于研究数值天气预报（NWP）和气候模型中的大尺度大气行为。热带辐合带（ITCZ）的位置可以通过柱积分最大降水量的纬度来推断。您的任务是基于柱积分水汽收支推导、实现并应用一种降水的诊断计算方法，然后在给定的海表温度（SST）变化下推断ITCZ的纬度。角度必须以度为单位表示，任何使用三角函数的内部计算都必须转换为弧度。最终程序必须生成单行输出，其中包含所提供测试套件推断出的ITCZ纬度（以度为单位），格式为方括号内以逗号分隔的列表。程序必须是自包含的，并且不得读取任何外部输入。\n\n从一个基本原理开始：静力平衡和浅层大气近似下水汽质量守恒。在一个垂直气柱上，单位面积的水汽质量积分（表示为 $W$）遵循一个局地守恒定律，其源汇项来自蒸发和降水，以及水汽通量的水平输送。柱水汽通量矢量表示为 $\\mathbf{F}_q$。诊断降水是通过结合蒸发、储存趋势项以及柱水汽通量的球面辐散来计算的。利用此守恒原理推导出诊断降水的表达式，然后针对球体上的纬向对称条件进行数值实现。\n\n假设与定义：\n- 将热带辐合带（ITCZ）定义为诊断降水在纬向平均上达到最大值的纬度 $\\phi$。\n- 定义海表温度（SST）。令 $T_s(\\phi)$ 为作为纬度 $\\phi$ 函数的SST。\n- 定义相对湿度（RH）。令 $RH_{10}(\\phi)$ 为近地面相对湿度，$RH_c(\\phi)$ 为整层相对湿度。\n- 令 $p_s$ 为地表气压，$g$ 为重力加速度，$a$ 为地球半径，$R_d$ 为干空气比气体常数，$R_v$ 为水汽比气体常数，$L_v$ 为蒸发潜热，$C_E$ 为蒸发的总体输送系数。\n- 使用以下饱和水汽压公式： $$e_s(T) = e_0 \\exp\\!\\left(\\frac{L_v}{R_v}\\left(\\frac{1}{T_0} - \\frac{1}{T}\\right)\\right),$$ 其中 $e_0$ 是参考温度 $T_0$ 下的参考饱和水汽压。\n- 地表饱和比湿为 $$q_s(T_s) = \\epsilon \\frac{e_s(T_s)}{p_s},$$ 其中 $\\epsilon = R_d/R_v$。\n- 假设近地面气温等于SST，即 $T_a(\\phi) = T_s(\\phi)$，并且近地面空气密度为 $$\\rho_a(\\phi) = \\frac{p_s}{R_d T_a(\\phi)}.$$\n- 通过假设垂直均匀的比湿与 $RH_c$ 成正比，来参数化单位面积的柱积分水汽质量（可降水量）： $$W(\\phi) = RH_c(\\phi)\\, q_s\\!\\left(T_s(\\phi)\\right)\\, \\frac{p_s}{g}.$$\n- 使用标准的总体空气动力学公式参数化蒸发： $$E(\\phi) = \\rho_a(\\phi)\\, C_E\\, U_{10}(\\phi)\\,\\left(q_s\\!\\left(T_s(\\phi)\\right) - q_a(\\phi)\\right),$$ 其中近地面比湿为 $q_a(\\phi) = RH_{10}(\\phi)\\, q_s\\!\\left(T_s(\\phi)\\right)$，$U_{10}(\\phi)$ 为10米风速大小。\n- 由于纬向对称性，将柱水汽通量参数化为纯经向： $$\\mathbf{F}_q(\\phi) = \\left(0,\\, F_\\phi(\\phi)\\right),\\quad F_\\phi(\\phi) = v(\\phi)\\, W(\\phi),$$ 其中 $v(\\phi)$ 是柱平均的经向风速。\n- 在球体上，对于纬向对称性，纯经向通量的辐散为 $$\\nabla\\cdot\\mathbf{F}_q(\\phi) = \\frac{1}{a\\cos\\phi}\\, \\frac{\\partial}{\\partial \\phi}\\big(F_\\phi(\\phi)\\cos\\phi\\big),$$ 其中在导数中 $\\phi$ 以弧度表示。\n\n网格和单位：\n- 使用从-87.5度到+87.5度（含）的纬度网格 $\\phi_i$，间距为5度（不包括两极），即 $\\phi_i \\in \\{-87.5, -82.5, \\dots, 82.5, 87.5\\}$。\n- 对于涉及三角函数和球面导数的内部计算，将度转换为弧度。\n- 诊断降水应在内部以 $\\text{kg m}^{-2} \\text{s}^{-1}$ 为单位计算，然后使用 $1$ $\\text{kg m}^{-2} = 1$ $\\text{mm}$ 液态水的恒等关系转换为 $\\text{mm/day}$，因此通过乘以 $86400$ 将 $\\text{kg m}^{-2} \\text{s}^{-1}$ 转换为 $\\text{mm/day}$。\n- 角度必须以度为单位报告。最终输出要求纬度以度为单位。\n\n常数：\n- 使用 $a = 6.371\\times 10^6 \\, \\text{m}$, $g = 9.81 \\, \\text{m s}^{-2}$, $p_s = 10^5 \\, \\text{Pa}$, $R_d = 287 \\, \\text{J kg}^{-1} \\text{K}^{-1}$, $R_v = 461 \\, \\text{J kg}^{-1} \\text{K}^{-1}$, $L_v = 2.5\\times 10^6 \\, \\text{J kg}^{-1}$, $e_0 = 610.78 \\, \\text{Pa}$, $T_0 = 273.15 \\, \\text{K}$, $C_E = 1.2\\times 10^{-3}$ (无量纲)。\n\n数值方法：\n- 使用二阶中心有限差分计算内部网格点的球面辐散，并在区域边界使用一阶单边有限差分。令 $\\Delta \\phi$ 为以弧度为单位的纬度间距。对于内部点 $i$，计算 $$\\frac{\\partial}{\\partial \\phi}(F_\\phi\\cos\\phi)\\bigg|_i \\approx \\frac{(F_\\phi\\cos\\phi)_{i+1} - (F_\\phi\\cos\\phi)_{i-1}}{2\\,\\Delta \\phi}.$$ 在边界处，使用前向或后向差分。\n- 根据水汽收支计算诊断降水，并确定其最大值所在的纬度 $\\phi$。\n\n测试套件：\n提供四个案例来测试计算和ITCZ推断。在所有案例中，三角函数中的角度在内部以弧度处理，但输出的纬度必须以度为单位。\n- 案例1（控制水行星）：\n  - $T_s(\\phi) = 300 - 20\\, \\sin^2\\!\\phi$ （其中正弦函数中的 $\\phi$ 以弧度为单位），单位为 $\\text{K}$。\n  - $U_{10}(\\phi) = 8 \\, \\text{m s}^{-1}$ （常数）。\n  - $RH_{10}(\\phi) = 0.8$ （常数）。\n  - $RH_c(\\phi) = \\min\\!\\big(\\max\\!\\big(0.6 + 0.2 \\cos\\phi,\\, 0.3\\big),\\, 0.95\\big)$ （限制在区间 $[0.3, 0.95]$ 内）。\n  - $v(\\phi) = 2\\, \\sin(2\\phi) \\, \\text{m s}^{-1}$。\n  - $\\partial_t W(\\phi) = 0 \\, \\text{kg m}^{-2} \\text{s}^{-1}$。\n- 案例2（北半球增温）：与案例1相同，除了\n  - $T_s(\\phi) \\leftarrow T_s(\\phi) + \\Delta_H\\, \\tanh\\!\\left(\\frac{\\phi}{\\phi_w}\\right)$,\n  - 其中 $\\Delta_H = 2 \\, \\text{K}$，$\\phi_w = 10$ 度（在 $\\tanh$ 的参数中将 $\\phi_w$ 转换为弧度）。\n- 案例3（南半球增温且经向输送为零）：与案例1相同，除了\n  - $T_s(\\phi) \\leftarrow T_s(\\phi) - \\Delta_H\\, \\tanh\\!\\left(\\frac{\\phi}{\\phi_w}\\right)$,\n  - 其中 $\\Delta_H = 2 \\, \\text{K}$，$\\phi_w = 10$ 度（转换为弧度），\n  - 并且对于所有 $\\phi$，$v(\\phi) = 0 \\, \\text{m s}^{-1}$。\n- 案例4（北半球增温伴随瞬时增湿）：与案例2相同，除了\n  - $\\partial_t W(\\phi) = A\\, \\exp\\!\\big(-(\\phi/\\sigma)^2\\big) \\, \\text{kg m}^{-2} \\text{s}^{-1}$,\n  - 其中 $A = 1\\times 10^{-5} \\, \\text{kg m}^{-2} \\text{s}^{-1}$，$\\sigma = 15$ 度（在指数中将 $\\sigma$ 转换为弧度）。\n\n要求的最终输出：\n- 对于每个案例，计算以 $\\text{mm/day}$ 为单位的诊断降水场，然后确定其全球最大值所在的纬度（ITCZ纬度）。将这四个纬度以浮点数（单位为度）报告。\n- 您的程序应生成单行输出，其中包含一个方括号内的逗号分隔列表的结果（例如，$[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4]$）。\n\n科学真实性约束：\n- 所有常数和参数化必须在物理上是合理的。\n- 算法必须正确处理单位转换和球面几何。\n- 离散化方法必须稳定且适用于给定的网格。\n\n注意：最终报告的纬度必须以度为单位。内部降水计算必须使用 $\\text{kg m}^{-2} \\text{s}^{-1}$，然后为诊断目的转换为 $\\text{mm/day}$，但唯一要求的输出是四个测试案例的ITCZ纬度（以度为单位）。",
            "solution": "问题陈述已经过严格审查，并被确定为**有效**。它在科学上植根于大气物理学原理，特别是水汽质量守恒定律。该问题是适定的，提供了推导和实现唯一解所需的完整且一致的定义、常数和参数化方案。数值方法和边界条件已明确指定，并且理想化水行星模拟的背景是气候科学中的标准实践。该问题是计算大气科学中一个非平凡但可解的练习。\n\n核心任务是在水行星上不同气候情景下，确定热带辐合带（ITCZ）的纬度，该纬度定义为最大降水量的纬度。这需要推导和数值求解用于诊断降水的柱积分水汽收支方程。\n\n垂直积分的水汽质量 $W$（单位为 $\\text{kg m}^{-2}$）守恒定律由下式给出：\n$$\n\\frac{\\partial W}{\\partial t} + \\nabla \\cdot \\mathbf{F}_q = E - P\n$$\n其中 $\\frac{\\partial W}{\\partial t}$ 是水汽的储存趋势项，$\\nabla \\cdot \\mathbf{F}_q$ 是垂直积分水汽通量的辐散，$E$ 是地表蒸发率，$P$ 是降水率。所有项的单位均为 $\\text{kg m}^{-2} \\text{s}^{-1}$。\n\n为了求得诊断降水 $P$，我们重排该方程：\n$$\nP(\\phi) = E(\\phi) - \\frac{\\partial W(\\phi)}{\\partial t} - \\nabla \\cdot \\mathbf{F}_q(\\phi)\n$$\n该问题是纬向对称的，因此所有量都仅是纬度 $\\phi$ 的函数。我们必须使用提供的参数化方案计算右侧的每一项。\n\n求解过程遵循以下步骤：\n1.  **网格设置**：建立一个从-87.5°到+87.5°的纬度网格 $\\phi_i$，间距为 $\\Delta\\phi = 5^\\circ$。对于所有计算，此网格都将转换为弧度。\n\n2.  **热力学量计算**：我们首先计算几个依赖于纬度的热力学变量，这些是收支项的先决条件。\n    -   海表温度 $T_s(\\phi)$ 是为每个测试案例定义的。假设近地面气温相等，$T_a(\\phi) = T_s(\\phi)$。\n    -   温度 $T$ 下的饱和水汽压 $e_s(T)$ 由Clausius-Clapeyron关系给出：\n        $$e_s(T) = e_0 \\exp\\left(\\frac{L_v}{R_v}\\left(\\frac{1}{T_0} - \\frac{1}{T}\\right)\\right)$$\n        其中 $e_0 = 610.78 \\, \\text{Pa}$ 是参考温度 $T_0 = 273.15 \\, \\text{K}$ 下的参考饱和水汽压。$L_v=2.5 \\times 10^6 \\, \\text{J kg}^{-1}$ 是蒸发潜热，$R_v=461 \\, \\text{J kg}^{-1} \\text{K}^{-1}$ 是水汽比气体常数。\n    -   然后，地表饱和比湿计算如下：\n        $$q_s(\\phi) = \\epsilon \\frac{e_s(T_s(\\phi))}{p_s}$$\n        其中 $\\epsilon = R_d/R_v \\approx 0.622$ 是干空气（$R_d = 287 \\, \\text{J kg}^{-1} \\text{K}^{-1}$）和水汽的气体常数之比，而 $p_s = 10^5 \\, \\text{Pa}$ 是地表气压。\n\n3.  **收支项计算**：\n    -   **蒸发（$E$）**：地表蒸发通量使用总体空气动力学公式进行参数化：\n        $$E(\\phi) = \\rho_a(\\phi)\\, C_E\\, U_{10}(\\phi)\\,\\left(q_s(\\phi) - q_a(\\phi)\\right)$$\n        此处，$C_E = 1.2 \\times 10^{-3}$ 是无量纲的总体输送系数，$U_{10}(\\phi)$ 是给定的近地面风速。近地面空气密度为 $\\rho_a(\\phi) = p_s / (R_d T_a(\\phi))$，近地面比湿为 $q_a(\\phi) = RH_{10}(\\phi)\\, q_s(\\phi)$，其中 $RH_{10}(\\phi)$ 是给定的近地面相对湿度。\n    -   **储存趋势项（$\\partial_t W$）**：项 $\\frac{\\partial W}{\\partial t}$ 对每个案例都有明确规定。对于前3个案例，它为零。对于第四个案例，它是一个非零的纬度函数。\n    -   **水汽通量辐散（$\\nabla \\cdot \\mathbf{F}_q$）**：该项需要几个步骤。\n        -   首先，柱积分水汽（可降水量）$W$ 参数化为：\n            $$W(\\phi) = RH_c(\\phi)\\, q_s(\\phi)\\, \\frac{p_s}{g}$$\n            其中 $RH_c(\\phi)$ 是给定的整层相对湿度，$g = 9.81 \\, \\text{m s}^{-2}$ 是重力加速度。\n        -   由于纬向对称性，水汽通量是纯经向的，$\\mathbf{F}_q(\\phi) = (0, F_\\phi(\\phi))$，其中经向分量为：\n            $$F_\\phi(\\phi) = v(\\phi)\\, W(\\phi)$$\n            其中 $v(\\phi)$ 是给定的柱平均经向风。\n        -   该通量在球体上的辐散是：\n            $$\\nabla\\cdot\\mathbf{F}_q(\\phi) = \\frac{1}{a\\cos\\phi}\\, \\frac{\\partial}{\\partial \\phi}\\left(F_\\phi(\\phi)\\cos\\phi\\right)$$\n            其中 $a = 6.371 \\times 10^6 \\, \\text{m}$ 是地球半径，$\\phi$ 以弧度为单位。\n        -   导数 $\\frac{\\partial}{\\partial \\phi}(F_\\phi\\cos\\phi)$ 在离散网格上使用有限差分进行数值计算。令 $Y_i = (F_\\phi \\cos\\phi)_i$ 为网格点 $i$ 处的值。\n            -   对于内部点（$i=1, \\dots, N-2$）：使用二阶中心差分：\n                $$\\frac{\\partial Y}{\\partial\\phi}\\bigg|_i \\approx \\frac{Y_{i+1} - Y_{i-1}}{2\\,\\Delta \\phi}$$\n            -   对于南边界（$i=0$）：使用一阶前向差分：\n                $$\\frac{\\partial Y}{\\partial\\phi}\\bigg|_0 \\approx \\frac{Y_1 - Y_0}{\\Delta \\phi}$$\n            -   对于北边界（$i=N-1$）：使用一阶后向差分：\n                $$\\frac{\\partial Y}{\\partial\\phi}\\bigg|_{N-1} \\approx \\frac{Y_{N-1} - Y_{N-2}}{\\Delta \\phi}$$\n            然后将得到的导数向量除以 $a\\cos\\phi_i$ 以获得辐散。\n\n4.  **最终降水和ITCZ位置**：\n    -   通过将计算出的项 $E(\\phi_i)$、$\\frac{\\partial W}{\\partial t}(\\phi_i)$ 和 $\\nabla \\cdot \\mathbf{F}_q(\\phi_i)$ 代入收支方程，在每个网格点上计算降水 $P(\\phi_i)$。\n    -   通过找到数组 $P$ 中 $P(\\phi_{i_{max}})$ 为最大值的网格点 $i_{max}$ 来确定ITCZ纬度。与该索引对应的纬度（以度为单位），$\\phi_{deg}[i_{max}]$，即为该测试案例的最终结果。\n\n此程序应用于4个测试案例中的每一个，这些案例通过改变 $T_s(\\phi)$、$v(\\phi)$ 和 $\\frac{\\partial W}{\\partial t}(\\phi)$ 的函数来模拟不同的气候状态。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and applies a diagnostic calculation of precipitation to infer the \n    ITCZ latitude on an idealized aquaplanet for four test cases.\n    \"\"\"\n\n    # --- Constants ---\n    a = 6.371e6      # Earth radius (m)\n    g = 9.81         # Gravitational acceleration (m/s^2)\n    p_s = 1.0e5      # Surface pressure (Pa)\n    R_d = 287.0      # Specific gas constant for dry air (J/kg/K)\n    R_v = 461.0      # Specific gas constant for water vapor (J/kg/K)\n    L_v = 2.5e6      # Latent heat of vaporization (J/kg)\n    e_0 = 610.78     # Reference saturation vapor pressure (Pa)\n    T_0 = 273.15     # Reference temperature (K)\n    C_E = 1.2e-3     # Bulk transfer coefficient (dimensionless)\n    epsilon = R_d / R_v\n\n    # --- Grid Setup ---\n    phi_deg = np.arange(-87.5, 87.5 + 5.0, 5.0)\n    phi_rad = np.deg2rad(phi_deg)\n    delta_phi_rad = np.deg2rad(5.0)\n    num_points = len(phi_deg)\n\n    # --- Test Case Definitions ---\n    test_cases = [\n        # Case 1: Control aquaplanet\n        {\n            \"name\": \"Case 1: Control\",\n            \"Ts_func\": lambda p: 300.0 - 20.0 * np.sin(p)**2,\n            \"U10_func\": lambda p: 8.0 * np.ones_like(p),\n            \"RH10_func\": lambda p: 0.8 * np.ones_like(p),\n            \"RHc_func\": lambda p: np.clip(0.6 + 0.2 * np.cos(p), 0.3, 0.95),\n            \"v_func\": lambda p: 2.0 * np.sin(2.0 * p),\n            \"dWdt_func\": lambda p: np.zeros_like(p)\n        },\n        # Case 2: Northern Hemisphere warming\n        {\n            \"name\": \"Case 2: NH Warming\",\n            \"Ts_func\": lambda p: (300.0 - 20.0 * np.sin(p)**2) + 2.0 * np.tanh(p / np.deg2rad(10.0)),\n            \"U10_func\": lambda p: 8.0 * np.ones_like(p),\n            \"RH10_func\": lambda p: 0.8 * np.ones_like(p),\n            \"RHc_func\": lambda p: np.clip(0.6 + 0.2 * np.cos(p), 0.3, 0.95),\n            \"v_func\": lambda p: 2.0 * np.sin(2.0 * p),\n            \"dWdt_func\": lambda p: np.zeros_like(p)\n        },\n        # Case 3: Southern Hemisphere warming, zero transport\n        {\n            \"name\": \"Case 3: SH Warming, No Transport\",\n            \"Ts_func\": lambda p: (300.0 - 20.0 * np.sin(p)**2) - 2.0 * np.tanh(p / np.deg2rad(10.0)),\n            \"U10_func\": lambda p: 8.0 * np.ones_like(p),\n            \"RH10_func\": lambda p: 0.8 * np.ones_like(p),\n            \"RHc_func\": lambda p: np.clip(0.6 + 0.2 * np.cos(p), 0.3, 0.95),\n            \"v_func\": lambda p: np.zeros_like(p),\n            \"dWdt_func\": lambda p: np.zeros_like(p)\n        },\n        # Case 4: NH warming, transient moistening\n        {\n            \"name\": \"Case 4: NH Warming, Transient\",\n            \"Ts_func\": lambda p: (300.0 - 20.0 * np.sin(p)**2) + 2.0 * np.tanh(p / np.deg2rad(10.0)),\n            \"U10_func\": lambda p: 8.0 * np.ones_like(p),\n            \"RH10_func\": lambda p: 0.8 * np.ones_like(p),\n            \"RHc_func\": lambda p: np.clip(0.6 + 0.2 * np.cos(p), 0.3, 0.95),\n            \"v_func\": lambda p: 2.0 * np.sin(2.0 * p),\n            \"dWdt_func\": lambda p: 1.0e-5 * np.exp(-(p / np.deg2rad(15.0))**2)\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        # --- Step 1: Calculate thermodynamic quantities ---\n        Ts = case[\"Ts_func\"](phi_rad)\n        es = e_0 * np.exp((L_v / R_v) * (1.0 / T_0 - 1.0 / Ts))\n        qs = epsilon * es / p_s\n        \n        # --- Step 2: Calculate budget terms ---\n        \n        # Evaporation (E)\n        rho_a = p_s / (R_d * Ts)\n        U10 = case[\"U10_func\"](phi_rad)\n        RH10 = case[\"RH10_func\"](phi_rad)\n        qa = RH10 * qs\n        E = rho_a * C_E * U10 * (qs - qa)\n\n        # Storage Tendency (dW/dt)\n        dWdt = case[\"dWdt_func\"](phi_rad)\n\n        # Moisture Flux Divergence (div F_q)\n        RHc = case[\"RHc_func\"](phi_rad)\n        W = RHc * qs * (p_s / g)\n        v = case[\"v_func\"](phi_rad)\n        F_phi = v * W\n        \n        Y = F_phi * np.cos(phi_rad)\n        dYdphi = np.zeros_like(phi_rad)\n        \n        # Interior points: 2nd-order centered difference\n        dYdphi[1:-1] = (Y[2:] - Y[:-2]) / (2.0 * delta_phi_rad)\n        \n        # Boundaries: 1st-order one-sided difference\n        dYdphi[0] = (Y[1] - Y[0]) / delta_phi_rad       # Forward difference\n        dYdphi[-1] = (Y[-1] - Y[-2]) / delta_phi_rad  # Backward difference\n        \n        # Add a small epsilon to avoid division by zero at poles, though not needed for this grid\n        cos_phi = np.cos(phi_rad)\n        \n        div_Fq = (1.0 / (a * cos_phi)) * dYdphi\n        \n        # --- Step 3: Calculate Precipitation and find ITCZ ---\n        # P = E - dW/dt - div(F_q) [kg m^-2 s^-1]\n        P = E - dWdt - div_Fq\n        \n        # Find the latitude of maximum precipitation\n        itcz_index = np.argmax(P)\n        itcz_latitude = phi_deg[itcz_index]\n        results.append(itcz_latitude)\n\n    # --- Final Output ---\n    # The format must be exactly a comma-separated list in brackets.\n    print(f\"[{','.join(f'{res:.1f}' for res in results)}]\")\n\nsolve()\n```"
        }
    ]
}