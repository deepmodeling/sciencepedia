{
    "hands_on_practices": [
        {
            "introduction": "地球气候系统的根本驱动力源于太阳辐射在不同纬度的不均匀分布，这造成了热带地区的能量盈余和极地的能量亏损。为了维持全球能量平衡，大气和海洋必须通过环流将能量从赤道输送到两极。本练习将引导你通过一个理想化的水行星模型，从第一性原理出发，定量推导出维持这种平衡所需的经向能量输送 。这个练习不仅能加深你对全球能量收支的理解，还能让你熟练运用物理和数学工具来解决核心的气候科学问题。",
            "id": "4011855",
            "problem": "考虑一个处于年平均辐射平衡且具有纬向对称性的理想化水行星。设纬度为 $\\phi$（单位为弧度），行星半径为 $a$，行星反照率为 $A$（假设不随纬度变化）。大气层顶部的纬向平均太阳辐射被规定为\n$$\nS(\\phi) = S_{0}\\left[1 - s_{2}\\,P_{2}(\\sin\\phi)\\right],\n$$\n其中 $S_{0}$ 是全球平均太阳辐射，$s_{2}$ 是一个无量纲的振幅参数，$P_{2}(x)$ 是二阶勒让德多项式，定义为 $P_{2}(x) = \\frac{1}{2}\\left(3x^{2} - 1\\right)$。假设大气-地表系统的行星反照率 $A$ 为常数，因此吸收的短波辐射为 $(1 - A)\\,S(\\phi)$。进一步假设，出射长波辐射 (OLR) 在空间上是均匀的，等于 $O_{0}$，其值由全球平均稳态能量平衡的要求确定。在稳态、纬向对称、垂直积分的湿静力能量收支中，假设储存和地表热量吸收可以忽略不计，经向能量通量的辐散等于大气层顶部的净辐射。\n\n仅使用这些假设和定义：\n- 计算大气层顶部的净辐射 $R_{\\mathrm{TOA}}(\\phi)$。\n- 推导出隐含的经向能量通量辐散以及相应的穿过纬度 $\\phi$ 的纬圈的总向北经向能量输送 $H(\\phi)$（单位为瓦特）。\n\n以 $a$、$A$、$S_{0}$、$s_{2}$ 和 $\\phi$ 的形式，给出 $H(\\phi)$ 的单个闭合形式的解析表达式。角度必须以弧度处理。不要进行任何数值代入。",
            "solution": "该问题是有效的，因为它代表了基于已建立的物理和数学原理的入门级气候动力学中的一个标准的、适定的问题。我们将继续进行求解。\n\n主要目标是推导出总向北经向能量输送 $H(\\phi)$。这首先需要确定大气层顶部的净辐射 $R_{\\mathrm{TOA}}(\\phi)$，而这又需要确定出射长波辐射 $O_{0}$。\n\n**步骤 1：确定出射长波辐射, $O_{0}$**\n\n大气层顶部的净辐射 $R_{\\mathrm{TOA}}(\\phi)$ 是吸收的短波辐射 (ASR) 与出射长波辐射 (OLR) 之间的差值。\nASR 由 $(1 - A)S(\\phi)$ 给出，其中 $A$ 是反照率，$S(\\phi)$ 是太阳辐射。OLR 被假定为常数 $O_{0}$。\n$$\nR_{\\mathrm{TOA}}(\\phi) = (1 - A)S(\\phi) - O_{0}\n$$\n问题指出 $O_{0}$ 由全球平均稳态能量平衡的要求确定。这意味着 $R_{\\mathrm{TOA}}(\\phi)$ 的全球平均值必须为零。我们将一个量 $f(\\phi)$ 的全球平均值表示为 $\\langle f \\rangle$。\n$$\n\\langle R_{\\mathrm{TOA}}(\\phi) \\rangle = 0\n$$\n对于一个纬向对称的量 $f(\\phi)$，其在全球球面上的平均值计算如下：\n$$\n\\langle f \\rangle = \\frac{\\int_{-\\pi/2}^{\\pi/2} f(\\phi) \\cos\\phi \\, d\\phi}{\\int_{-\\pi/2}^{\\pi/2} \\cos\\phi \\, d\\phi} = \\frac{1}{2} \\int_{-\\pi/2}^{\\pi/2} f(\\phi) \\cos\\phi \\, d\\phi\n$$\n将此应用于能量平衡方程：\n$$\n\\langle (1 - A)S(\\phi) - O_{0} \\rangle = (1-A)\\langle S(\\phi) \\rangle - \\langle O_{0} \\rangle = 0\n$$\n由于 $O_{0}$ 是一个常数，其全球平均值就是 $O_{0}$。因此：\n$$\nO_{0} = (1 - A)\\langle S(\\phi) \\rangle\n$$\n我们现在使用给定的表达式 $S(\\phi) = S_{0}\\left[1 - s_{2}\\,P_{2}(\\sin\\phi)\\right]$ 来计算 $\\langle S(\\phi) \\rangle$：\n$$\n\\langle S(\\phi) \\rangle = \\left\\langle S_{0}\\left[1 - s_{2}\\,P_{2}(\\sin\\phi)\\right] \\right\\rangle = S_{0} \\langle 1 \\rangle - S_{0}s_{2} \\langle P_{2}(\\sin\\phi) \\rangle\n$$\n常数的平均值就是其本身，所以 $\\langle 1 \\rangle = 1$。勒让德多项式项的平均值为：\n$$\n\\langle P_{2}(\\sin\\phi) \\rangle = \\frac{1}{2} \\int_{-\\pi/2}^{\\pi/2} P_{2}(\\sin\\phi) \\cos\\phi \\, d\\phi\n$$\n令 $x = \\sin\\phi$。则 $dx = \\cos\\phi \\, d\\phi$。积分限从 $\\phi \\in [-\\pi/2, \\pi/2]$ 变为 $x \\in [-1, 1]$。\n$$\n\\langle P_{2}(\\sin\\phi) \\rangle = \\frac{1}{2} \\int_{-1}^{1} P_{2}(x) \\, dx\n$$\n勒让德多项式 $P_n(x)$ 在区间 $[-1, 1]$ 上对于权重函数 $1$ 是正交的。其正交关系为 $\\int_{-1}^{1} P_n(x)P_m(x) dx = \\frac{2}{2n+1}\\delta_{nm}$。我们可以将该积分写成 $\\int_{-1}^{1} P_{2}(x) P_{0}(x) dx$，因为 $P_{0}(x) = 1$。由于 $n=2$ 和 $m=0$ 不相等，该积分为零。\n$$\n\\langle P_{2}(\\sin\\phi) \\rangle = 0\n$$\n这将全球平均太阳辐射的表达式简化为 $\\langle S(\\phi) \\rangle = S_{0}$。这证实了 $S_{0}$ 确实是全球平均太阳辐射。将此代入 $O_{0}$ 的方程中：\n$$\nO_{0} = (1 - A)S_{0}\n$$\n\n**步骤 2：计算大气层顶部的净辐射, $R_{\\mathrm{TOA}}(\\phi)$**\n\n现在我们得到了 $O_{0}$，可以写出 $R_{\\mathrm{TOA}}(\\phi)$ 的完整表达式：\n$$\nR_{\\mathrm{TOA}}(\\phi) = (1 - A)S(\\phi) - O_{0} = (1 - A)S_{0}\\left[1 - s_{2}\\,P_{2}(\\sin\\phi)\\right] - (1 - A)S_{0}\n$$\n$$\nR_{\\mathrm{TOA}}(\\phi) = (1 - A)S_{0} - (1 - A)S_{0}s_{2}P_{2}(\\sin\\phi) - (1 - A)S_{0}\n$$\n$$\nR_{\\mathrm{TOA}}(\\phi) = -(1 - A)S_{0}s_{2}P_{2}(\\sin\\phi)\n$$\n\n**步骤 3：推导向北经向能量输送, $H(\\phi)$**\n\n问题指出，经向能量通量的辐散等于大气层顶部的净辐射。设 $H(\\phi)$ 为穿过纬度 $\\phi$ 处纬圈的总向北能量输送（单位为瓦特）。纬度 $\\phi$ 以北的极帽的能量平衡要求，进入该极帽的向北输送量 $H(\\phi)$ 必须平衡该极帽向太空的净能量损失。一个等效的陈述是将输送的辐散与局地净辐射联系起来。对于宽度为 $a\\,d\\phi$、长度为 $2\\pi a \\cos\\phi$ 的纬度带，通量的辐散由以下公式给出：\n$$\n\\frac{1}{2\\pi a^2 \\cos\\phi} \\frac{dH(\\phi)}{d\\phi} = R_{\\mathrm{TOA}}(\\phi)\n$$\n通过积分重新整理以求解 $H(\\phi)$：\n$$\n\\frac{dH(\\phi)}{d\\phi} = 2\\pi a^2 \\cos\\phi \\, R_{\\mathrm{TOA}}(\\phi)\n$$\n代入推导出的 $R_{\\mathrm{TOA}}(\\phi)$ 表达式：\n$$\n\\frac{dH(\\phi)}{d\\phi} = -2\\pi a^2 (1 - A)S_{0}s_{2} \\cos\\phi \\, P_{2}(\\sin\\phi)\n$$\n为了求得 $H(\\phi)$，我们将此表达式从南极（$\\phi = -\\pi/2$）对纬度积分至一个通用纬度 $\\phi$。物理边界条件是穿过极点没有能量输送，因此 $H(-\\pi/2) = 0$。\n$$\nH(\\phi) = \\int_{-\\pi/2}^{\\phi} \\frac{dH(\\phi')}{d\\phi'} \\, d\\phi' = \\int_{-\\pi/2}^{\\phi} \\left( -2\\pi a^2 (1 - A)S_{0}s_{2} \\cos\\phi' \\, P_{2}(\\sin\\phi') \\right) d\\phi'\n$$\n$$\nH(\\phi) = -2\\pi a^2 (1 - A)S_{0}s_{2} \\int_{-\\pi/2}^{\\phi} \\cos\\phi' \\, P_{2}(\\sin\\phi') \\, d\\phi'\n$$\n我们再次使用换元法，令 $x = \\sin\\phi'$，则 $dx = \\cos\\phi' \\, d\\phi'$。积分限变为 $x = \\sin(-\\pi/2) = -1$ 和 $x = \\sin\\phi$。\n$$\nH(\\phi) = -2\\pi a^2 (1 - A)S_{0}s_{2} \\int_{-1}^{\\sin\\phi} P_{2}(x) \\, dx\n$$\n使用二阶勒让德多项式的定义 $P_{2}(x) = \\frac{1}{2}(3x^2 - 1)$：\n$$\n\\int P_{2}(x) dx = \\int \\frac{1}{2}(3x^2 - 1) dx = \\frac{1}{2}(x^3 - x) + C\n$$\n计算定积分：\n$$\n\\int_{-1}^{\\sin\\phi} P_{2}(x) dx = \\left[\\frac{1}{2}(x^3 - x)\\right]_{-1}^{\\sin\\phi} = \\frac{1}{2}\\left(\\sin^3\\phi - \\sin\\phi\\right) - \\frac{1}{2}\\left((-1)^3 - (-1)\\right)\n$$\n第二项计算结果为 $\\frac{1}{2}(-1 + 1) = 0$。所以积分为：\n$$\n\\int_{-1}^{\\sin\\phi} P_{2}(x) dx = \\frac{1}{2}(\\sin^3\\phi - \\sin\\phi) = \\frac{1}{2}\\sin\\phi(\\sin^2\\phi - 1) = -\\frac{1}{2}\\sin\\phi\\cos^2\\phi\n$$\n将此结果代回 $H(\\phi)$ 的表达式：\n$$\nH(\\phi) = -2\\pi a^2 (1 - A)S_{0}s_{2} \\left(-\\frac{1}{2}\\sin\\phi\\cos^2\\phi\\right)\n$$\n这可以简化为总向北经向能量输送的最终表达式：\n$$\nH(\\phi) = \\pi a^2 (1 - A)S_{0}s_{2} \\sin\\phi \\cos^2\\phi\n$$\n此表达式满足边界条件 $H(-\\pi/2)=0$ 和 $H(\\pi/2)=0$，表明没有能量穿过两极，这与要求相符。",
            "answer": "$$ \\boxed{\\pi a^{2} (1 - A)S_{0}s_{2} \\sin\\phi \\cos^{2}\\phi} $$"
        },
        {
            "introduction": "在理解了全球能量输送的必要性之后，我们将深入探究一个关键的能量交换过程：蒸发。蒸发通过潜热通量的形式，将大量能量从海洋表面转移到大气中，是驱动天气和气候的重要一环。本练习将运用一个在气候模型中广泛使用的块状空气动力学公式，来计算这一关键通量，并评估其对风速等环境因素的敏感性 。通过这个实践，你将把抽象的边界层理论与具体的数值计算联系起来，体会参数化方案在气候模拟中的重要作用。",
            "id": "4011849",
            "problem": "考虑一个用于数值天气预报和气候模拟的中纬度水行星。该水行星全球被海洋覆盖，水平均质，并且具有均匀的海面性质，没有大陆边界。关注纬度 $45^{\\circ}$ 处海洋上的一个中性大气边界层，并假设条件是稳定且水平均匀的。设参考高度 $z=10$ 米处的近地表空气比湿为 $q_a$，海面的饱和比湿为 $q_s$，以及 $z=10$ 米处的风速为 $U$。假设在中性稳定度下，整体输送描述是有效的，且水汽的交换系数 $C_E$ 为常数。\n\n从水汽守恒、雷诺分解和中性稳定度下的湍流通量-梯度假说出发，推导海-气潜热通量的适当整体空气动力学表达式。使用此表达式计算指定中纬度水行星情况下的潜热通量，然后评估在此状态下潜热通量对风速的敏感性。\n\n已知：\n- 空气密度 $\\,\\rho_a = 1.225\\,$ kg m$^{-3}$，\n- 蒸发潜热 $\\,L_v = 2.5 \\times 10^{6}\\,$ J kg$^{-1}$，\n- 中性整体水汽交换系数 $\\,C_E = 1.2 \\times 10^{-3}$，\n- $z=10\\,$ 米处的风速 $\\,U = 8\\,$ m s$^{-1}$，\n- 海面饱和比湿 $\\,q_s = 0.017\\,$ kg kg$^{-1}$，\n- $z=10\\,$ 米处的近地表空气比湿 $\\,q_a = 0.012\\,$ kg kg$^{-1}$。\n\n任务：\n1. 从第一性原理出发，推导适用于具有均匀表面性质的水行星的中性海洋大气表面层的潜热通量整体空气动力学形式。\n2. 使用推导的表达式和给定的值计算潜热通量。将潜热通量以 W m$^{-2}$ 为单位表示，并四舍五入到四位有效数字。\n3. 定义风速敏感度 $\\,S_U = \\partial F_E / \\partial U\\,$，其中 $q_s$、$q_a$、$C_E$、$\\rho_a$ 和 $L_v$ 固定。对给定状态下的$S_U$进行数值计算。将 $\\,S_U\\,$ 以 W m$^{-2}$ 每 (m s$^{-1}$) 为单位表示，并将最终答案四舍五入到四位有效数字。\n\n仅提供风速敏感度 $\\,S_U\\,$ 作为最终答案。",
            "solution": "首先对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n- **背景设置**：一个位于纬度 $45^{\\circ}$ 的中纬度水行星，在全球均匀的海洋上有一个中性大气边界层。条件是稳定且水平均匀的。\n- **参考高度**：$z = 10\\,$ m。\n- **参考高度的变量**：\n    - 近地表空气比湿：$q_a$。\n    - 风速：$U$。\n- **海面的变量**：\n    - 海面饱和比湿：$q_s$。\n- **模型**：整体输送描述有效，水汽交换系数 $C_E$ 为常数。\n- **常数和给定值**：\n    - 空气密度：$\\rho_a = 1.225\\,$ kg m$^{-3}$。\n    - 蒸发潜热：$L_v = 2.5 \\times 10^{6}\\,$ J kg$^{-1}$。\n    - 中性整体水汽交换系数：$C_E = 1.2 \\times 10^{-3}$。\n    - $z=10\\,$ 米处的风速：$U = 8\\,$ m s$^{-1}$。\n    - 海面饱和比湿：$q_s = 0.017\\,$ kg kg$^{-1}$。\n    - $z=10\\,$ 米处的近地表空气比湿：$q_a = 0.012\\,$ kg kg$^{-1}$。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题在边界层气象学和海-气相互作用的原理方面有充分的依据。水行星的概念、整体空气动力学公式、雷诺分解和通量-梯度假说是气候模拟和数值天气预报中的标准工具。所提供的物理常数和状态变量对于中纬度海洋环境是符合实际的。\n- **适定性**：该问题是适定的。它提供了所有必要的信息和一组明确的任务，可以导出一个唯一且可计算的解。\n- **客观性**：该问题使用精确、客观的科学语言陈述，没有任何主观性或模糊性。\n- **完整性与一致性**：该问题是自洽且内部一致的。稳定、水平均匀流的假设是标准的简化，定义了推导和应用整体公式的物理范畴。\n- **可行性与真实性**：数值是物理上真实的。例如，$q_s > q_a$ 表明从海洋到大气的向上湿度梯度，这驱动了蒸发，是一个典型的情景。\n\n### 步骤3：结论与行动\n该问题被认为是**有效的**，因为它在科学上是合理的、适定的、客观的且内部一致的。将提供一个解。\n\n---\n\n### 任务1：潜热通量整体空气动力学公式的推导\n\n推导从一个标量（在此情况下为水汽，用比湿 $q$ 表示）的守恒开始。使用雷诺分解，任何瞬时量都可以写成平均分量（上划线）和湍流脉动（撇号）之和，例如，$w = \\bar{w} + w'$ 和 $q = \\bar{q} + q'$。对于假设的稳态（$\\frac{\\partial}{\\partial t} = 0$）和水平均匀（$\\frac{\\partial}{\\partial x} = \\frac{\\partial}{\\partial y} = 0$）条件，并假设平均垂直速度为零（$\\bar{w} = 0$），平均比湿的守恒方程简化为表明湍流通量的垂直散度为零：\n$$\n\\frac{\\partial (\\overline{w'q'})}{\\partial z} = 0\n$$\n这意味着水汽的湍流运动学通量 $E = \\overline{w'q'}$ 在大气表面层中随高度保持不变。\n\n湍流通量-梯度假说（K-理论）将此通量与比湿的平均梯度联系起来：\n$$\nE = \\overline{w'q'} = -K_E \\frac{d\\bar{q}}{dz}\n$$\n其中 $K_E$ 是水汽的涡动扩散系数。负号表示通量沿着梯度的反方向（即从高浓度到低浓度）。\n\n这个方程可以从地表积分到参考高度 $z_r = 10\\,$ m。然而，问题要求的是一个整体空气动力学表达式，它是对此湍流输送积分结果的一种参数化。整体公式直接将通量与参考高度和地表的平均量联系起来。水汽的质量通量 $F_q$（单位为 kg m$^{-2}$ s$^{-1}$）由以下公式给出：\n$$\nF_q = \\rho_a C_E U (q_s - q_a)\n$$\n这里，$\\rho_a$ 是空气密度，$U$ 是参考高度的风速，$(q_s - q_a)$ 是海面与参考高度空气之间的比湿差，$C_E$ 是无量纲的水汽整体交换系数（也称为道尔顿数）。这个表达式将复杂的湍流输送直接参数化为平均状态变量的简单乘积。\n\n潜热通量 $F_E$（单位为 W m$^{-2}$ 或 J s$^{-1}$ m$^{-2}$）是与水相变相关的能量通量。它通过将水汽质量通量 $F_q$ 乘以蒸发潜热 $L_v$ 得到：\n$$\nF_E = L_v F_q\n$$\n代入 $F_q$ 的表达式，我们得到潜热通量的整体空气动力学公式：\n$$\nF_E = \\rho_a L_v C_E U (q_s - q_a)\n$$\n这就是所要求的表达式。它在问题指定的中性稳定度条件下有效。\n\n### 任务2：潜热通量（$F_E$）的计算\n\n使用推导的表达式和给定的值：\n- $\\rho_a = 1.225\\,$ kg m$^{-3}$\n- $L_v = 2.5 \\times 10^{6}\\,$ J kg$^{-1}$\n- $C_E = 1.2 \\times 10^{-3}$\n- $U = 8\\,$ m s$^{-1}$\n- $q_s = 0.017\\,$ kg kg$^{-1}$\n- $q_a = 0.012\\,$ kg kg$^{-1}$\n\n首先，计算比湿差：\n$$\nq_s - q_a = 0.017 - 0.012 = 0.005\n$$\n现在，将所有值代入 $F_E$ 的公式：\n$$\nF_E = (1.225) \\times (2.5 \\times 10^{6}) \\times (1.2 \\times 10^{-3}) \\times (8) \\times (0.005)\n$$\n$$\nF_E = (1.225 \\times 2.5 \\times 1.2 \\times 8 \\times 0.005) \\times (10^{6} \\times 10^{-3})\n$$\n$$\nF_E = (29.4 \\times 0.005) \\times 10^{3}\n$$\n$$\nF_E = 0.147 \\times 10^{3}\n$$\n$$\nF_E = 147.0 \\, \\text{W m}^{-2}\n$$\n潜热通量为 $147.0\\,$ W m$^{-2}$，四舍五入到四位有效数字。\n\n### 任务3：风速敏感度（$S_U$）的评估\n\n风速敏感度 $S_U$ 定义为潜热通量 $F_E$ 对风速 $U$ 的偏导数，同时保持所有其他参数不变：\n$$\nS_U = \\frac{\\partial F_E}{\\partial U}\n$$\n我们将此算子应用于推导出的 $F_E$ 表达式：\n$$\nS_U = \\frac{\\partial}{\\partial U} \\left[ \\rho_a L_v C_E U (q_s - q_a) \\right]\n$$\n由于 $\\rho_a$、$L_v$、$C_E$、$q_s$ 和 $q_a$ 保持不变，$F_E$ 的表达式是关于 $U$ 的线性函数。因此，导数是乘以 $U$ 的常数系数的集合：\n$$\nS_U = \\rho_a L_v C_E (q_s - q_a)\n$$\n这个表达式也可以看作是 $F_E / U$。我们现在可以计算 $S_U$ 的数值：\n$$\nS_U = (1.225) \\times (2.5 \\times 10^{6}) \\times (1.2 \\times 10^{-3}) \\times (0.017 - 0.012)\n$$\n$$\nS_U = (1.225) \\times (2.5 \\times 10^{6}) \\times (1.2 \\times 10^{-3}) \\times (0.005)\n$$\n$$\nS_U = (1.225 \\times 2.5 \\times 1.2 \\times 0.005) \\times (10^{6} \\times 10^{-3})\n$$\n$$\nS_U = (0.018375) \\times 10^{3}\n$$\n$$\nS_U = 18.375 \\, \\text{W m}^{-2} \\, (\\text{m s}^{-1})^{-1}\n$$\n根据问题要求，四舍五入到四位有效数字：\n$$\nS_U = 18.38 \\, \\text{W m}^{-2} \\, (\\text{m s}^{-1})^{-1}\n$$\n这是所要求的最终答案。",
            "answer": "$$\n\\boxed{18.38}\n$$"
        },
        {
            "introduction": "当能量通过潜热等方式进入大气后，大气环流将如何响应？本练习将构建一个简化的计算模型，以探究热带气候的主导特征——哈德利环流——如何对大气中长波辐射冷却的垂直分布作出反应。这个实践整合了辐射、热力学和动力学，完美展示了水行星模拟在检验关于基本物理过程如何控制大尺度环流的科学假说方面的强大能力 。完成这个练习将使你能够亲手搭建一个概念模型，并用它来探索气候系统内部复杂的相互作用。",
            "id": "4011806",
            "problem": "您的任务是在一个理想化的水行星框架内，实施一项计算实验，以量化纬向平均哈德莱环流强度对红外长波（LW）吸收体垂直分布的敏感性。长波吸收体廓线将由依赖于气压的光学厚度函数 $\\tau_{LW}(p)$ 表示，并且由此产生的翻转环流的差异将通过在赤道处计算的质量流函数度量来诊断。\n\n该实验必须基于适用于水行星模拟的数值天气预报和气候模拟的基本原理。必须使用以下物理基础：\n\n- 静力平衡和理想气体定律。使用指数为 $\\kappa = R/c_p$ 的泊松关系来表示对流层：\n  $$T(\\phi,p) = T_s(\\phi)\\left(\\frac{p}{p_s}\\right)^\\kappa,$$\n  其中 $T(\\phi,p)$ 是温度，$T_s(\\phi)$ 是地表温度，$p$ 是气压，$p_s$ 是地表气压。\n\n- 在 Eddington 近似下的灰体长波辐射，用于计算辐射平衡温度：\n  $$T_{eq}^4(\\phi,p) = \\frac{3}{4} T_{eff}^4(\\phi)\\left(\\tau_{LW}(p) + \\frac{2}{3}\\right),$$\n  其中 $T_{eff}(\\phi)$ 是由局部吸收的太阳辐射决定的有效发射温度。\n\n- 经向日射分布（春分/秋分时纬向对称的水行星）由以下公式指定：\n  $$S(\\phi) = \\bar{S}\\left[1 - s_2 P_2(\\sin\\phi)\\right],\\quad P_2(\\mu) = \\frac{1}{2}(3\\mu^2 - 1),$$\n  以及大气层顶部的局地能量平衡：\n  $$(1-\\alpha) S(\\phi) = \\sigma T_{eff}^4(\\phi),$$\n  其中 $\\bar{S}$ 是全球平均入射太阳通量，$\\alpha$ 是行星反照率，$\\sigma$ 是斯特藩-玻尔兹曼常数。\n\n- 一个随高度变化的辐射弛豫时间尺度参数化方案，它将长波光学厚度与牛顿冷却时间尺度联系起来：\n  $$\\tau_{rad}(p) = \\tau_{ref}\\left[1 + \\tau_{LW}(p)\\right],$$\n  其中 $\\tau_{ref}$ 是一个参考时间尺度。\n\n- 稳态热能方程中的近赤道弱温度梯度（WTG）平衡（纬向平均、轴对称、忽略经向平流）：\n  $$\\omega(\\phi,p)\\,\\frac{\\partial T(\\phi,p)}{\\partial p} \\approx \\frac{T_{eq}(\\phi,p) - T(\\phi,p)}{\\tau_{rad}(p)},$$\n  其中 $\\omega$ 是气压坐标系中的垂直速度（向下为正）。给定 $T_{eq}$ 和 $T$，该平衡为 $\\omega$ 提供了一个诊断方程。\n\n将纬向平均赤道哈德莱环流圈强度度量定义为穿过赤道大气柱的向上质量通量，在气压上积分并乘以赤道周长：\n$$M = 2\\pi a \\cos\\phi_0 \\int_{p_t}^{p_s} \\max\\left(0,\\,-\\omega(\\phi_0,p)\\right)\\,\\frac{dp}{g},$$\n其中 $\\phi_0 = 0$，$p_t$ 是模式顶部的气压。量 $M$ 的单位是千克/秒（kg/s），对于对称、稳态的环流，它等于赤道处的纬向平均质量流函数的大小。\n\n仅使用上述原理，实施以下计算步骤：\n1. 设置行星和物理常数：行星半径 $a$、重力加速度 $g$、干空气气体常数 $R$、定压比热 $c_p$、指数 $\\kappa = R/c_p$、斯特藩-玻尔兹曼常数 $\\sigma$、平均太阳通量 $\\bar{S}$、反照率 $\\alpha$ 和日射形状参数 $s_2$。\n2. 定义长波光学厚度廓线：\n   $$\\tau_{LW}(p) = \\tau_0\\left(\\frac{p}{p_s}\\right)^n,$$\n   其中 $\\tau_0$ 控制整层光学厚度，$n$ 控制垂直分布（较大的 $n$ 使吸收体更集中于大气低层）。\n3. 从 $(1-\\alpha) S(\\phi) = \\sigma T_{eff}^4(\\phi)$ 计算 $T_{eff}(\\phi)$，然后根据灰体 Eddington 公式计算 $T_{eq}(\\phi,p)$。\n4. 将 $T_s(\\phi)$ 设置为局地辐射平衡地表温度，即 $T_s(\\phi) = T_{eq}(\\phi,p_s)$，并使用泊松关系构建对流层温度廓线 $T(\\phi,p)$。\n5. 从对流廓线解析计算 $\\partial T/\\partial p$。\n6. 使用时间尺度参数化计算 $\\tau_{rad}(p)$，并从 WTG 稳态平衡诊断出 $\\omega(\\phi,p)$。\n7. 按上述定义计算赤道向上质量通量度量 $M$。\n\n角度单位：弧度。气压单位：帕斯卡（Pa）。时间单位：秒（s）。温度单位：开尔文（K）。输出质量输送的单位为千克/秒（kg/s）。\n\n测试套件：\n使用赤道 $\\phi_0 = 0$，$p_s = 10^5$ Pa，$p_t = 10^4$ Pa，$\\bar{S} = 340$ W m$^{-2}$，$\\alpha = 0.3$，$s_2 = 0.2$，$\\sigma = 5.670374419\\times 10^{-8}$ W m$^{-2}$ K$^{-4}$，$a = 6.371\\times 10^6$ m，$g = 9.81$ m s$^{-2}$，$R = 287$ J kg$^{-1}$ K$^{-1}$，$c_p = 1004$ J kg$^{-1}$ K$^{-1}$，以及 $\\tau_{ref} = 20$ 天。评估以下四种 $(\\tau_0, n)$ 的情况：\n- 情况1（常规路径）：$(\\tau_0, n) = (2.0, 1.0)$。\n- 情况2（吸收体集中于底层）：$(\\tau_0, n) = (2.0, 4.0)$。\n- 情况3（光学较薄的大气柱）：$(\\tau_0, n) = (0.8, 1.0)$。\n- 情况4（吸收体集中于高层）：$(\\tau_0, n) = (2.0, 0.5)$。\n\n要求的最终输出：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个值都是等于 $M$ 的浮点数（单位为千克/秒，kg/s），并四舍五入到三位有效数字。例如：\n$$[\\text{result1},\\text{result2},\\text{result3},\\text{result4}]$$",
            "solution": "该问题被评估为有效。它在科学上基于理论大气科学的既定原理，特别是使用了一个定义明确但理想化的水行星模型。该问题是适定的，提供了一套完整且一致的方程、常数和参数，可以计算出唯一且有意义的解。语言客观而精确。因此，下面将逐步介绍解决方案。\n\n问题的核心是基于一个简化的大气模型，计算赤道哈德莱环流的强度，该强度由质量通量度量 $M$ 表示。这涉及到诊断垂直速度 $\\omega$ 并对整个大气柱的向上质量通量进行积分。计算在赤道 $\\phi_0 = 0$ 处进行。\n\n首先，我们确定物理常数和参数。泊松关系的指数为 $\\kappa = R/c_p = 287 / 1004 \\approx 0.285856$。参考辐射时间尺度必须转换为国际单位制（SI）：$\\tau_{ref} = 20 \\text{ 天} \\times 86400 \\text{ 秒/天} = 1,728,000$ 秒。所有其他常数均以国际单位制给出。\n\n计算过程首先要确定赤道大气的热力状态。所有量都在 $\\phi = \\phi_0 = 0$ 处进行评估。经向日射分布 $S(\\phi) = \\bar{S}\\left[1 - s_2 P_2(\\sin\\phi)\\right]$ 在赤道处简化，因为 $\\sin\\phi_0 = 0$。二阶勒让德多项式为 $P_2(0) = \\frac{1}{2}(3 \\cdot 0^2 - 1) = -1/2$。\n因此，赤道的日射量为：\n$$S(\\phi_0) = \\bar{S}\\left(1 - s_2 \\left(-\\frac{1}{2}\\right)\\right) = \\bar{S}\\left(1 + \\frac{s_2}{2}\\right)$$\n使用给定值，$S(0) = 340 \\text{ W m}^{-2} \\left(1 + \\frac{0.2}{2}\\right) = 374$ W m$^{-2}$。\n\n根据大气层顶部的能量平衡方程 $(1-\\alpha) S(\\phi_0) = \\sigma T_{eff}^4(\\phi_0)$，我们可以求解出赤道的有效发射温度 $T_{eff}(\\phi_0)$：\n$$T_{eff}(\\phi_0) = \\left(\\frac{(1-\\alpha)S(\\phi_0)}{\\sigma}\\right)^{1/4}$$\n该值对于所有测试用例都是恒定的，因为它不依赖于长波吸收体廓线参数 $(\\tau_0, n)$。\n\n接下来，我们定义温度廓线。辐射平衡温度 $T_{eq}(\\phi_0, p)$ 由 Eddington 近似给出：\n$$T_{eq}(\\phi_0,p) = T_{eff}(\\phi_0) \\left[\\frac{3}{4}\\left(\\tau_{LW}(p) + \\frac{2}{3}\\right)\\right]^{1/4}$$\n其中光学厚度廓线为 $\\tau_{LW}(p) = \\tau_0\\left(p/p_s\\right)^n$。\n\n该模型指定了一个对流层，其温度廓线 $T(\\phi_0, p)$ 遵循泊松关系（代表一条绝热线）：\n$$T(\\phi_0,p) = T_s(\\phi_0)\\left(\\frac{p}{p_s}\\right)^\\kappa$$\n地表温度 $T_s(\\phi_0)$ 由地表辐射平衡条件设定，即 $T_s(\\phi_0) = T_{eq}(\\phi_0, p_s)$。在 $p=p_s$ 处，光学厚度为 $\\tau_{LW}(p_s) = \\tau_0$。因此，$T_s(\\phi_0)$ 由下式给出：\n$$T_s(\\phi_0) = T_{eff}(\\phi_0) \\left[\\frac{3}{4}\\left(\\tau_0 + \\frac{2}{3}\\right)\\right]^{1/4}$$\n请注意，$T_s(\\phi_0)$ 依赖于参数 $\\tau_0$，并且在每个 $\\tau_0$ 发生变化的测试用例中都必须重新计算。\n\n气压坐标系中的垂直速度 $\\omega(p)$ 是根据弱温度梯度（WTG）近似下的稳态热能方程诊断出来的：\n$$\\omega(p)\\,\\frac{\\partial T(p)}{\\partial p} = \\frac{T_{eq}(p) - T(p)}{\\tau_{rad}(p)}$$\n为了求解 $\\omega(p)$，我们需要温度的垂直梯度 $\\partial T/\\partial p$ 和辐射弛豫时间尺度 $\\tau_{rad}(p)$。对 $T(p)$ 的表达式关于 $p$ 求导，得到：\n$$\\frac{\\partial T(p)}{\\partial p} = T_s(\\phi_0) \\frac{\\kappa}{p_s^\\kappa} p^{\\kappa-1} = \\frac{\\kappa}{p} \\left(T_s(\\phi_0) \\left(\\frac{p}{p_s}\\right)^\\kappa\\right) = \\frac{\\kappa T(p)}{p}$$\n辐射时间尺度参数化为：\n$$\\tau_{rad}(p) = \\tau_{ref}\\left[1 + \\tau_{LW}(p)\\right]$$\n将这些代入 WTG 平衡方程并整理得到 $\\omega(p)$：\n$$\\omega(p) = \\frac{T_{eq}(p) - T(p)}{\\tau_{rad}(p)} \\left(\\frac{\\partial T(p)}{\\partial p}\\right)^{-1} = \\frac{T_{eq}(p) - T(p)}{\\tau_{ref}\\left[1 + \\tau_{LW}(p)\\right]} \\frac{p}{\\kappa T(p)}$$\n在对流廓线温度低于辐射平衡廓线温度的区域，即 $T(p) < T_{eq}(p)$，诊断为上升运动（$\\omega < 0$）。这表示一种辐射加热趋势，它驱动向上的运动以维持热力平衡。\n\n最后，哈德莱环流强度度量 $M$ 是通过对从模式顶部 $p_t$ 到地表 $p_s$ 的整个大气柱中，单位长度的向上质量通量进行积分，再乘以赤道周长来计算的：\n$$M = 2\\pi a \\cos\\phi_0 \\int_{p_t}^{p_s} \\max\\left(0,\\,-\\omega(p)\\right)\\,\\frac{dp}{g}$$\n当 $\\phi_0=0$ 时，$\\cos\\phi_0=1$。项 $\\max(0, -\\omega)$ 筛选出向上运动，因为只有当 $\\omega$ 为负时，$-\\omega$ 才为正。对于每种情况，该积分都通过数值方法计算。\n总的计算流程是为被积函数 $\\max(0, -\\omega(p))$ 定义一个函数，该函数依赖于情况参数 $(\\tau_0, n)$，然后使用数值积分方法来评估该定积分。然后将结果乘以常数前因子 $2\\pi a / g$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Computes the Hadley circulation strength for an idealized aquaplanet model.\n    \"\"\"\n    # 1. Set planetary and physical constants\n    a = 6.371e6  # Planetary radius (m)\n    g = 9.81  # Gravitational acceleration (m/s^2)\n    R = 287.0  # Gas constant for dry air (J/kg/K)\n    cp = 1004.0  # Specific heat at constant pressure (J/kg/K)\n    kappa = R / cp  # Poisson relation exponent\n    sigma = 5.670374419e-8  # Stefan-Boltzmann constant (W/m^2/K^4)\n    S_bar = 340.0  # Global-mean incident solar flux (W/m^2)\n    alpha = 0.3  # Planetary albedo\n    s2 = 0.2  # Insolation shape parameter\n    ps = 1e5  # Surface pressure (Pa)\n    pt = 1e4  # Model top pressure (Pa)\n    tau_ref = 20.0 * 24 * 3600  # Reference timescale (s)\n    phi0 = 0.0  # Latitude of interest: equator (radians)\n\n    # Define the test cases for (tau0, n)\n    test_cases = [\n        (2.0, 1.0),  # Case 1 (happy path)\n        (2.0, 4.0),  # Case 2 (bottom-heavy absorbers)\n        (0.8, 1.0),  # Case 3 (optically thinner column)\n        (2.0, 0.5),  # Case 4 (top-heavy absorbers)\n    ]\n\n    results = []\n\n    # Pre-calculate values that are constant across all test cases\n    # Insolation at the equator\n    P2_0 = 0.5 * (3 * np.sin(phi0)**2 - 1)\n    S0 = S_bar * (1 - s2 * P2_0)\n    \n    # Effective temperature at the equator (to the fourth power and absolute)\n    T_eff_equator_4 = (1 - alpha) * S0 / sigma\n    T_eff_equator = T_eff_equator_4**0.25\n\n    # Loop through each test case\n    for tau0, n in test_cases:\n        # Step 3  4: Compute temperature profiles, which depend on the case\n        \n        # Calculate surface temperature Ts based on radiative equilibrium at the surface\n        # tau_lw at surface is tau0\n        T_s_equator_4 = 0.75 * T_eff_equator_4 * (tau0 + 2./3.)\n        T_s_equator = T_s_equator_4**0.25\n\n        # Define the function to be integrated\n        def integrand(p: float) -> float:\n            # LW optical depth at pressure p\n            tau_lw_p = tau0 * (p / ps)**n\n            \n            # Radiative equilibrium temperature at p\n            T_eq_p_4 = 0.75 * T_eff_equator_4 * (tau_lw_p + 2./3.)\n            T_eq_p = T_eq_p_4**0.25\n            \n            # Convective temperature at p\n            T_conv_p = T_s_equator * (p / ps)**kappa\n            \n            # Avoid division by zero for T_conv_p, although unlikely\n            if T_conv_p < 1e-9:\n                return 0.0\n\n            # Step 6: Diagnose omega from WTG balance\n            # Net radiative heating/cooling determines the sign of omega\n            T_diff = T_eq_p - T_conv_p\n            \n            # Radiative timescale at p\n            tau_rad_p = tau_ref * (1.0 + tau_lw_p)\n            \n            # Temperature gradient dT/dp for the convective profile\n            dTdp = kappa * T_conv_p / p\n            \n            # Vertical velocity omega\n            omega = T_diff / (tau_rad_p * dTdp)\n            \n            # We need to integrate max(0, -omega) for upward mass flux\n            return np.maximum(0.0, -omega)\n\n        # Step 7: Compute the mass flux metric M\n        # Integrate from model top (pt) to surface (ps)\n        integral_val, _ = integrate.quad(integrand, pt, ps, limit=100)\n        \n        # M = 2 * pi * a * cos(phi0) * integral / g\n        M = (2 * np.pi * a * np.cos(phi0) / g) * integral_val\n        \n        results.append(M)\n\n    # Format output to 3 significant figures using the 'g' format specifier\n    formatted_results = [f\"{res:.3g}\" for res in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}