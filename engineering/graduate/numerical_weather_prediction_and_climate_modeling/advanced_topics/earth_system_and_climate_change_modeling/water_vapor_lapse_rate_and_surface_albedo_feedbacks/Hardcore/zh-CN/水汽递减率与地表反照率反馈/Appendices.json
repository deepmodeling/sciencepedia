{
    "hands_on_practices": [
        {
            "introduction": "要理解复杂的气候反馈，我们必须首先掌握其基本组成部分。第一个练习聚焦于地表反照率，这是一个控制地球能量平衡的关键参数。通过这个练习，你将应用能量守恒原理，以重要的雪盖景观为例，量化地表吸收的太阳辐射量。",
            "id": "4111686",
            "problem": "在用于数值天气预报(NWP)和气候模拟的单柱地表能量平衡模型中，地表的下行短波(SW)辐照度用 $S$ 表示，地表反照率用 $\\alpha$ 表示。反照率定义为地表反射的入射短波辐射的比例，它是气候系统中与水汽和直减率反馈相耦合的地表反照率反馈中的一个关键参数。\n\n从地表反照率的定义（地表上行反射短波通量与下行短波通量之比）出发，并利用地表短波波段的辐射能量守恒，推导一个仅用 $\\alpha$ 和 $S$ 表示的地表吸收短波通量的表达式。\n\n然后，对于一个积雪覆盖的表面，当 $\\alpha = 0.60$ 且入射下行短波辐射 $S = 300\\ \\mathrm{W\\,m^{-2}}$ 时，计算这个吸收的短波通量。以 $\\mathrm{W\\,m^{-2}}$ 为单位表示最终的吸收短波通量，并将您的答案四舍五入到三位有效数字。",
            "solution": "在尝试解答之前，将对问题进行验证。\n\n### 步骤1：提取已知条件\n-   地表下行短波(SW)辐照度：$S$。\n-   地表反照率：$\\alpha$。\n-   反照率的定义：地表上行反射短波通量与下行短波通量之比。\n-   使用的原理：地表短波波段的辐射能量守恒。\n-   任务1：推导地表吸收的短波通量的表达式，用 $\\alpha$ 和 $S$ 表示。\n-   任务2：计算当 $\\alpha = 0.60$ 且 $S = 300\\ \\mathrm{W\\,m^{-2}}$ 时的吸收短波通量。\n-   任务3：将最终数值答案四舍五入到三位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n-   **科学依据：** 该问题基于辐射传输和能量守恒的基本原理，这些是大气物理学、气象学和气候科学的核心概念。反照率的定义是标准的。提供的数值，积雪的 $\\alpha = 0.60$ 和入射太阳辐射的 $S = 300\\ \\mathrm{W\\,m^{-2}}$，在物理上是现实的。\n-   **适定性：** 问题陈述清晰，并提供了推导唯一且有意义的解所需的所有信息。给定物理量之间的关系由既定的物理定律定义。\n-   **客观性：** 问题以精确、无偏见的技术语言表述，不含任何主观或推测性内容。\n\n### 步骤3：结论与行动\n该问题科学上合理，适定，客观，且不含可识别的缺陷。因此，它被视为**有效**。将提供解答。\n\n问题要求推导地表吸收的短波(SW)辐射的表达式，并在给定特定参数的情况下进行数值计算。我们用 $S$ 表示地表入射的下行短波通量，用 $\\alpha$ 表示地表反照率，用 $S_{\\text{up}}$ 表示反射的上行短波通量，用 $S_{\\text{abs}}$ 表示吸收的短波通量。\n\n问题给出了地表反照率 $\\alpha$ 的定义，即上行反射短波通量与下行入射短波通量之比。在数学上，这表示为：\n$$ \\alpha = \\frac{S_{\\text{up}}}{S} $$\n根据这个定义，我们可以用入射通量和反照率来表示反射的短波通量：\n$$ S_{\\text{up}} = \\alpha S $$\n\n问题指导我们使用地表短波波段的辐射能量守恒原理。该原理指出，总的入射短波通量必须等于反射通量和吸收通量之和。任何未被反射的短波辐射都被地表系统吸收。因此，我们可以将能量平衡方程写为：\n$$ S = S_{\\text{up}} + S_{\\text{abs}} $$\n\n为了找到吸收短波通量 $S_{\\text{abs}}$ 的表达式，我们将反照率定义中的 $S_{\\text{up}}$ 表达式代入能量守恒方程：\n$$ S = (\\alpha S) + S_{\\text{abs}} $$\n通过重新整理各项来求解 $S_{\\text{abs}}$，我们得到：\n$$ S_{\\text{abs}} = S - \\alpha S $$\n将入射通量 $S$ 提取出来，我们得到吸收短波通量关于 $\\alpha$ 和 $S$ 的最终表达式：\n$$ S_{\\text{abs}} = S(1 - \\alpha) $$\n\n接下来，我们被要求为一个反照率 $\\alpha = 0.60$、入射下行短波通量 $S = 300\\ \\mathrm{W\\,m^{-2}}$ 的积雪覆盖表面计算该表达式的值。将这些值代入我们推导的表达式中：\n$$ S_{\\text{abs}} = 300 \\times (1 - 0.60) $$\n首先，我们计算括号中的项：\n$$ 1 - 0.60 = 0.40 $$\n现在，我们进行乘法运算：\n$$ S_{\\text{abs}} = 300 \\times 0.40 = 120 $$\n吸收通量的单位是 $\\mathrm{W\\,m^{-2}}$。\n\n问题要求最终答案四舍五入到三位有效数字。计算出的值恰好是 $120$。为了用三位有效数字表示这个结果，我们必须用一种能明确表示其精度的形式来书写，比如科学记数法。\n$$ 120 = 1.20 \\times 10^2 $$\n因此，吸收的短波通量是 $1.20 \\times 10^2\\ \\mathrm{W\\,m^{-2}}$。",
            "answer": "$$\\boxed{1.20 \\times 10^2}$$"
        },
        {
            "introduction": "从地表转向大气，我们现在来研究水汽反馈中的一个关键细微之处，这在反照率变化最显著的寒冷地区尤为重要。这个练习探讨了过冷水与冰上饱和度的热力学差异。理解这一差异对于准确模拟高纬度气候系统中的大气湿度和云形成至关重要。",
            "id": "4111697",
            "problem": "在热力学中，与数值天气预报（NWP）和气候模拟相关的一个核心区别是，液态水的饱和水汽压与冰的饱和水汽压源于不同的相变能量学：凝结涉及汽化潜热，而凝华涉及升华潜热。在寒冷地区，这一区别调节着水汽浓度，从而调节着与地表反照率变化耦合的水汽和温度直减率反馈的强度。从相平衡时吉布斯自由能相等以及纯物质的克劳修斯–克拉佩龙微分关系出发，假设水蒸气表现为理想气体，且凝聚相（液态和冰）是不可压缩的。使用参考温度 $T_{0}=273.15\\ \\mathrm{K}$ 和在 $T_{0}$ 时液态水和冰的共同参考饱和水汽压 $e_{s,0}=611.2\\ \\mathrm{Pa}$，并假设在区间 $[260\\ \\mathrm{K},\\ 273.15\\ \\mathrm{K}]$ 内潜热为常数。取水蒸气的比气体常数 $R_{v}=461.5\\ \\mathrm{J}\\ \\mathrm{kg}^{-1}\\ \\mathrm{K}^{-1}$，在 $T_{0}$ 时的汽化潜热为 $L_{v}=2.500\\times 10^{6}\\ \\mathrm{J}\\ \\mathrm{kg}^{-1}$，在 $T_{0}$ 附近的熔化潜热为 $L_{f}=3.337\\times 10^{5}\\ \\mathrm{J}\\ \\mathrm{kg}^{-1}$，因此升华潜热为 $L_{s}=L_{v}+L_{f}$。通过对克劳修斯–克拉佩龙关系式积分，推导出 $e_{s,\\mathrm{liq}}(T)$ 和 $e_{s,\\mathrm{ice}}(T)$ 的表达式，并在 $T=260\\ \\mathrm{K}$ 时对它们求值，中间的饱和水汽压以帕斯卡表示。然后，将无量纲比值 $e_{s,\\mathrm{ice}}(260\\ \\mathrm{K})/e_{s,\\mathrm{liq}}(260\\ \\mathrm{K})$ 作为最终答案报告。将最终比值四舍五入到四位有效数字，并以小数形式表示。",
            "solution": "该问题在科学上是有效的、提法得当且客观的。它基于热力学中的基本克劳修斯–克拉佩龙关系式，并使用了大气科学中常见的标准近似和数值。所有必要信息均已提供。\n\n出发点是描述凝聚相和气相之间平衡的克劳修斯–克拉佩龙关系式：\n$$ \\frac{de_s}{dT} = \\frac{L}{T(\\alpha_v - \\alpha_c)} $$\n其中 $e_s$ 是饱和水汽压，$T$ 是绝对温度，$L$ 是相变的比潜热，$\\alpha_v$ 是气相的比容，$\\alpha_c$ 是凝聚相（液态或冰）的比容。\n\n我们应用问题陈述中给出的假设。首先，水蒸气被视为理想气体，其状态方程为 $e_s \\alpha_v = R_v T$。这使得气相的比容可以表示为 $\\alpha_v = \\frac{R_v T}{e_s}$。其次，与气相的比容相比，凝聚相的比容可以忽略不计，即 $\\alpha_c \\ll \\alpha_v$，因此差值 $\\alpha_v - \\alpha_c$ 可以近似为 $\\alpha_v$。\n\n将这些近似代入克劳修斯–克拉佩龙关系式，得到：\n$$ \\frac{de_s}{dT} = \\frac{L}{T\\left(\\frac{R_v T}{e_s}\\right)} = \\frac{L e_s}{R_v T^2} $$\n这是一个可分离的一阶常微分方程。我们可以重新整理各项进行积分：\n$$ \\frac{de_s}{e_s} = \\frac{L}{R_v} \\frac{dT}{T^2} $$\n我们按照问题陈述，假设潜热 $L$ 在温度区间内为常数，将此方程从参考状态 $(T_0, e_{s,0})$ 积分到一个任意状态 $(T, e_s(T))$。\n$$ \\int_{e_{s,0}}^{e_s(T)} \\frac{de'_s}{e'_s} = \\frac{L}{R_v} \\int_{T_0}^{T} \\frac{dT'}{T'^2} $$\n执行积分得到：\n$$ [\\ln(e'_s)]_{e_{s,0}}^{e_s(T)} = \\frac{L}{R_v} \\left[ -\\frac{1}{T'} \\right]_{T_0}^{T} $$\n$$ \\ln(e_s(T)) - \\ln(e_{s,0}) = \\frac{L}{R_v} \\left( -\\frac{1}{T} + \\frac{1}{T_0} \\right) $$\n$$ \\ln\\left(\\frac{e_s(T)}{e_{s,0}}\\right) = \\frac{L}{R_v} \\left( \\frac{1}{T_0} - \\frac{1}{T} \\right) $$\n通过对两边取指数来求解 $e_s(T)$，我们得到该关系的积分形式：\n$$ e_s(T) = e_{s,0} \\exp\\left[ \\frac{L}{R_v} \\left( \\frac{1}{T_0} - \\frac{1}{T} \\right) \\right] $$\n这个通用表达式可以具体用于液态水上和冰上的饱和水汽压。对于过冷液态水上的饱和，$e_{s,\\mathrm{liq}}(T)$，潜热为 $L = L_v$：\n$$ e_{s,\\mathrm{liq}}(T) = e_{s,0} \\exp\\left[ \\frac{L_v}{R_v} \\left( \\frac{1}{T_0} - \\frac{1}{T} \\right) \\right] $$\n对于冰上的饱和，$e_{s,\\mathrm{ice}}(T)$，潜热为升华潜热 $L = L_s$。给定 $L_s=L_v+L_f$：\n$$ e_{s,\\mathrm{ice}}(T) = e_{s,0} \\exp\\left[ \\frac{L_s}{R_v} \\left( \\frac{1}{T_0} - \\frac{1}{T} \\right) \\right] = e_{s,0} \\exp\\left[ \\frac{L_v + L_f}{R_v} \\left( \\frac{1}{T_0} - \\frac{1}{T} \\right) \\right] $$\n问题要求在 $T = 260\\ \\mathrm{K}$ 时进行求值，使用以下常数：$T_0 = 273.15\\ \\mathrm{K}$，$e_{s,0} = 611.2\\ \\mathrm{Pa}$，$R_v = 461.5\\ \\mathrm{J}\\ \\mathrm{kg}^{-1}\\ \\mathrm{K}^{-1}$，$L_v = 2.500 \\times 10^6\\ \\mathrm{J}\\ \\mathrm{kg}^{-1}$，以及 $L_f = 3.337 \\times 10^5\\ \\mathrm{J}\\ \\mathrm{kg}^{-1}$。\n\n作为中间步骤，我们计算 $e_{s,\\mathrm{liq}}(260\\ \\mathrm{K})$ 和 $e_{s,\\mathrm{ice}}(260\\ \\mathrm{K})$。首先，对于液态水：\n$$ \\frac{L_v}{R_v} = \\frac{2.500 \\times 10^6\\ \\mathrm{J}\\ \\mathrm{kg}^{-1}}{461.5\\ \\mathrm{J}\\ \\mathrm{kg}^{-1}\\ \\mathrm{K}^{-1}} \\approx 5417.118\\ \\mathrm{K} $$\n$$ \\frac{1}{T_0} - \\frac{1}{T} = \\frac{1}{273.15\\ \\mathrm{K}} - \\frac{1}{260\\ \\mathrm{K}} \\approx -1.8515 \\times 10^{-4}\\ \\mathrm{K}^{-1} $$\n$$ e_{s,\\mathrm{liq}}(260\\ \\mathrm{K}) = (611.2\\ \\mathrm{Pa}) \\exp\\left[ (5417.118\\ \\mathrm{K}) (-1.8515 \\times 10^{-4}\\ \\mathrm{K}^{-1}) \\right] \\approx (611.2\\ \\mathrm{Pa}) \\exp(-1.00288) \\approx 224.20\\ \\mathrm{Pa} $$\n接下来，对于冰，有 $L_s = L_v + L_f = 2.500 \\times 10^6\\ \\mathrm{J}\\ \\mathrm{kg}^{-1} + 3.337 \\times 10^5\\ \\mathrm{J}\\ \\mathrm{kg}^{-1} = 2.8337 \\times 10^6\\ \\mathrm{J}\\ \\mathrm{kg}^{-1}$：\n$$ \\frac{L_s}{R_v} = \\frac{2.8337 \\times 10^6\\ \\mathrm{J}\\ \\mathrm{kg}^{-1}}{461.5\\ \\mathrm{J}\\ \\mathrm{kg}^{-1}\\ \\mathrm{K}^{-1}} \\approx 6140.206\\ \\mathrm{K} $$\n$$ e_{s,\\mathrm{ice}}(260\\ \\mathrm{K}) = (611.2\\ \\mathrm{Pa}) \\exp\\left[ (6140.206\\ \\mathrm{K}) (-1.8515 \\times 10^{-4}\\ \\mathrm{K}^{-1}) \\right] \\approx (611.2\\ \\mathrm{Pa}) \\exp(-1.13676) \\approx 196.11\\ \\mathrm{Pa} $$\n最终目标是比值 $\\frac{e_{s,\\mathrm{ice}}(260\\ \\mathrm{K})}{e_{s,\\mathrm{liq}}(260\\ \\mathrm{K})}$。我们可以为此比值构建一个更简单的符号表达式：\n$$ \\frac{e_{s,\\mathrm{ice}}(T)}{e_{s,\\mathrm{liq}}(T)} = \\frac{e_{s,0} \\exp\\left[ \\frac{L_s}{R_v} \\left( \\frac{1}{T_0} - \\frac{1}{T} \\right) \\right]}{e_{s,0} \\exp\\left[ \\frac{L_v}{R_v} \\left( \\frac{1}{T_0} - \\frac{1}{T} \\right) \\right]} = \\exp\\left[ \\frac{L_s - L_v}{R_v} \\left( \\frac{1}{T_0} - \\frac{1}{T} \\right) \\right] $$\n使用热力学恒等式 $L_s = L_v + L_f$，我们发现 $L_s - L_v = L_f$。该比值巧妙地简化为一个仅依赖于熔化潜热的表达式：\n$$ \\frac{e_{s,\\mathrm{ice}}(T)}{e_{s,\\mathrm{liq}}(T)} = \\exp\\left[ \\frac{L_f}{R_v} \\left( \\frac{1}{T_0} - \\frac{1}{T} \\right) \\right] $$\n现在我们代入 $T=260\\ \\mathrm{K}$ 的数值：\n$$ \\frac{L_f}{R_v} = \\frac{3.337 \\times 10^5\\ \\mathrm{J}\\ \\mathrm{kg}^{-1}}{461.5\\ \\mathrm{J}\\ \\mathrm{kg}^{-1}\\ \\mathrm{K}^{-1}} \\approx 723.0878\\ \\mathrm{K} $$\n指数为：\n$$ \\text{Exponent} = (723.0878\\ \\mathrm{K}) \\times \\left( \\frac{1}{273.15\\ \\mathrm{K}} - \\frac{1}{260\\ \\mathrm{K}} \\right) \\approx (723.0878) \\times (-1.85152 \\times 10^{-4}) \\approx -0.133883 $$\n因此，该比值为：\n$$ \\frac{e_{s,\\mathrm{ice}}(260\\ \\mathrm{K})}{e_{s,\\mathrm{liq}}(260\\ \\mathrm{K})} = \\exp(-0.133883) \\approx 0.874697 $$\n按要求四舍五入到四位有效数字，最终结果为 $0.8747$。",
            "answer": "$$\\boxed{0.8747}$$"
        },
        {
            "introduction": "我们最后的练习将反照率、温度和季节性等概念整合到一个动态建模问题中，这反映了真实气候模型科学家的工作。气候反馈不是固定不变的常数，而是依赖于气候系统的状态。在这个高级练习中，你将构建一个完整的模型来计算地表反照率反馈参数（$\\lambda_\\alpha$），并发现其强度如何根据增温事件发生的时间而变化，从而揭示气候系统内部的非线性相互作用。",
            "id": "4111728",
            "problem": "您需要设计并实现一个完整的、可运行的程序，该程序构建一个物理上合理的、包含融化-再冻结循环滞后效应的雪地表面反照率参数化方案，并在一个简单的能量平衡框架内使用该方案，以量化变暖的季节性时间如何改变表面反照率反馈参数。此任务必须从适用于数值天气预报和气候模拟的第一性原理出发解决，使用能量守恒、大气层顶（TOA）辐射通量的标准定义以及雪的基本热力学阈值。\n\n从以下基础开始：\n- 大气层顶（TOA）的能量守恒：向下的净辐射通量是吸收的短波辐射与出射的长波辐射之差。您需要分离出表面反照率变化对吸收的短波辐射的贡献。\n- 表面反照率的定义：地表反射的入射短波辐射的比例。表面反照率对TOA吸收的短波辐射的贡献是入射短波辐射乘以（1减去反照率）。\n- 日照和温度的季节性周期由年内的平滑函数表示。\n- 由融化-再冻结循环引起的雪地反照率滞后效应：一旦雪经历了一次春季融化事件，随后的再冻结并不会完全恢复新雪的高反照率，直到下一个寒冷季节的新降雪出现，并且在再冻结状态下反照率会一直保持较低水平，直到发生季节性重置。\n\n您必须实现以下模型组件和计算：\n\n1. TOA的季节性日照。设时间 $t$ 跨度为一年，作为区间 $[0,1)$ 内的无量纲变量，具有每日分辨率。将TOA日照定义为\n$$\nS(t) = S_0 + S_1 \\cos\\left(2\\pi\\left(t - t_S\\right)\\right),\n$$\n其中 $S_0 = 340\\,\\mathrm{W\\,m^{-2}}$，$S_1 = 120\\,\\mathrm{W\\,m^{-2}}$，且 $t_S = 0.5$（仲夏时日照峰值）。\n\n2. 基准近地表气温季节周期。定义\n$$\nT_{\\mathrm{base}}(t) = T_{\\mathrm{mean}} + T_{\\mathrm{amp}} \\cos\\left(2\\pi\\left(t - t_T\\right)\\right),\n$$\n其中 $T_{\\mathrm{mean}} = 270\\,\\mathrm{K}$，$T_{\\mathrm{amp}} = 18\\,\\mathrm{K}$，且 $t_T = 0.0$。\n\n3. 季节性定时变暖扰动。叠加一个加性高斯形异常，\n$$\nG(t; t_{\\mathrm{warm}}, \\sigma) = \\exp\\left(-\\frac{d(t,t_{\\mathrm{warm}})^2}{2\\sigma^2}\\right),\n$$\n其中 $d(t,t_{\\mathrm{warm}})$ 是单位圆上 $t$ 和 $t_{\\mathrm{warm}}$ 之间的最短周期距离，$\\sigma$ 控制宽度。扰动后的温度为\n$$\nT_{\\mathrm{pert}}(t) = T_{\\mathrm{base}}(t) + \\Delta T_{\\mathrm{amp}}\\,G(t; t_{\\mathrm{warm}}, \\sigma),\n$$\n其中 $\\Delta T_{\\mathrm{amp}} = 2\\,\\mathrm{K}$ 且 $\\sigma = 0.08$（即，以年分数为单位，约一个月）。基准情况对应 $\\Delta T_{\\mathrm{amp}} = 0\\,\\mathrm{K}$。\n\n4. 积雪覆盖率参数化。将积雪覆盖率定义为温度的逻辑斯谛函数，\n$$\nF_s\\!\\left(T(t)\\right) = \\frac{1}{1 + \\exp\\left(\\frac{T(t) - T_s}{k_T}\\right)},\n$$\n其中 $T_s = 273.15\\,\\mathrm{K}$ 且 $k_T = 2\\,\\mathrm{K}$。\n\n5. 雪地反照率滞后效应。令雪地反照率根据一个编码滞后效应的状态变量取两个值之一：\n- 新雪反照率 $ \\alpha_{\\mathrm{fresh}} = 0.85$。\n- 再冻结/旧雪反照率 $ \\alpha_{\\mathrm{old}} = 0.65$。\n- 地面反照率（无雪） $ \\alpha_{\\mathrm{ground}} = 0.20$。\n\n设一个二进制状态 $h(t) \\in \\{0,1\\}$ 表示雪是新雪（$h=1$）还是再冻结/旧雪（$h=0$）。在 $t=0$ 时初始化 $h$，如果 $T_{\\mathrm{series}}(0) \\le T_m - 5\\,\\mathrm{K}$，则 $h(0) = 1$，否则 $h(0) = 0$，其中 $T_m = 273.15\\,\\mathrm{K}$。每日使用以下滞后规则更新 $h(t)$，这些规则应用于所考虑的温度序列（$T_{\\mathrm{series}}$ 表示基准或扰动温度时间序列）：\n- 融化转换：如果存在任何连续 $d_m = 5$ 天或更长时间，期间 $T_{\\mathrm{series}}(t) > T_m$，则将所有后续时间 $t'$ 的 $h(t')$ 设为 0，直到发生季节性重置。\n- 季节性重置（新雪）：如果在 $t > 0.75$ 之后，存在任何连续 $d_f = 5$ 天或更长时间，期间 $T_{\\mathrm{series}}(t)  T_f$（其中 $T_f = 268.15\\,\\mathrm{K}$），则将所有后续时间 $t'$ 的 $h(t')$ 设为 1，直到下一次融化转换发生。\n\n给定 $h(t)$，将瞬时雪地反照率定义为\n$$\n\\alpha_{\\mathrm{snow}}(t) = h(t)\\,\\alpha_{\\mathrm{fresh}} + \\left(1 - h(t)\\right)\\,\\alpha_{\\mathrm{old}},\n$$\n并将有效表面反照率定义为\n$$\n\\alpha(t) = F_s\\!\\left(T(t)\\right)\\,\\alpha_{\\mathrm{snow}}(t) + \\left(1 - F_s\\!\\left(T(t)\\right)\\right)\\,\\alpha_{\\mathrm{ground}}.\n$$\n\n6. 反照率反馈参数。将表面反照率对TOA吸收短波辐射的贡献定义为\n$$\nR_\\alpha(t) = \\frac{S(t)}{4}\\left(1 - \\alpha(t)\\right).\n$$\n对于基准和扰动情况，计算仅由反照率引起的TOA净向下通量的年平均变化，\n$$\n\\Delta \\overline{R}_\\alpha = \\left\\langle \\frac{S(t)}{4}\\left(\\alpha_{\\mathrm{base}}(t) - \\alpha_{\\mathrm{pert}}(t)\\right) \\right\\rangle_t,\n$$\n以及年平均温度变化\n$$\n\\Delta \\overline{T} = \\left\\langle T_{\\mathrm{pert}}(t) - T_{\\mathrm{base}}(t) \\right\\rangle_t.\n$$\n那么表面反照率反馈参数为\n$$\n\\lambda_\\alpha = \\frac{\\Delta \\overline{R}_\\alpha}{\\Delta \\overline{T}},\n$$\n其单位必须表示为 $\\mathrm{W\\,m^{-2}\\,K^{-1}}$。\n\n实现要求：\n- 在一年内使用每日分辨率，即在 $t \\in [0,1)$ 中有 $N = 365$ 个均匀间隔的点。\n- 将滞后规则分别应用于基准和扰动温度序列，以获得 $\\alpha_{\\mathrm{base}}(t)$ 和 $\\alpha_{\\mathrm{pert}}(t)$。\n- 为每个测试案例按上述规定计算 $\\lambda_\\alpha$。\n\n测试套件：\n评估以下四组参数集，每组由变暖阶段 $t_{\\mathrm{warm}}$ 指定：\n- 案例1：$t_{\\mathrm{warm}} = 0.33$（变暖峰值在春季中期）。\n- 案例2：$t_{\\mathrm{warm}} = 0.00$（变暖峰值在深冬）。\n- 案例3：$t_{\\mathrm{warm}} = 0.50$（变暖峰值在仲夏）。\n- 案例4：$t_{\\mathrm{warm}} = 0.75$（变暖峰值在深秋）。\n\n所有其他参数均如上所述。对于每个案例，计算 $\\lambda_\\alpha$，单位为 $\\mathrm{W\\,m^{-2}\\,K^{-1}}$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含四个结果，以逗号分隔的列表形式包含在方括号内，每个值四舍五入到三位小数，例如 $[\\lambda_{\\alpha,1},\\lambda_{\\alpha,2},\\lambda_{\\alpha,3},\\lambda_{\\alpha,4}]$，单位为 $\\mathrm{W\\,m^{-2}\\,K^{-1}}$。",
            "solution": "` 文本将是：\n- 问题介绍：量化状态依赖的反照率反馈。\n- 数学公式：\n    - 日照和温度的季节周期。\n    - 扰动函数。\n    - 积雪覆盖率参数化。\n- 雪地反照率的滞后模型：\n    - “新雪”和“旧雪”状态的描述。\n    - 基于融化和重置条件的状态转换规则。这是模型的关键部分。\n- 反照率反馈参数 $\\lambda_{\\alpha}$ 的计算：\n    - 有效表面反照率的定义。\n    - 反照率引起的辐射扰动 $\\Delta \\overline{R}_\\alpha$ 的定义。\n    - 反馈参数本身的定义。\n- 数值实现策略：\n    - 一年周期的离散化。\n    - 滞后状态机的算法实现。\n    - 计算最终参数的平均过程。\n\nPython 的实现将遵循该计划。我将定义所有函数，然后主 `solve` 函数将协调四个测试用例的计算。打印前的最后一步是四舍五入到三位小数。\n该问题提法明确，具有科学依据，且内部一致。它提出了一个概念模型，用于研究表面反照率反馈的季节依赖性，并结合了具有物理动机的雪属性滞后效应。\n\n解决方案的构建首先是建立环境条件（日照和温度），然后对地表响应进行建模。问题的核心在于正确实现雪地反照率的状态依赖滞后逻辑。最终的计算量化了表面反照率反馈参数 $\\lambda_\\alpha$，该参数衡量了单位地表变暖引起的大气层顶（TOA）辐射收支的变化。\n\n首先，我们定义为期一年周期的时间依赖性外部强迫，用 $t \\in [0,1)$ 表示，包含 $N=365$ 个日步长。TOA日照 $S(t)$ 和基准近地表气温 $T_{\\mathrm{base}}(t)$ 由余弦函数给出：\n$$\nS(t) = S_0 + S_1 \\cos\\left(2\\pi\\left(t - t_S\\right)\\right)\n$$\n$$\nT_{\\mathrm{base}}(t) = T_{\\mathrm{mean}} + T_{\\mathrm{amp}} \\cos\\left(2\\pi\\left(t - t_T\\right)\\right)\n$$\n参数为 $S_0 = 340\\,\\mathrm{W\\,m^{-2}}$，$S_1 = 120\\,\\mathrm{W\\,m^{-2}}$，$t_S = 0.5$，$T_{\\mathrm{mean}} = 270\\,\\mathrm{K}$，$T_{\\mathrm{amp}} = 18\\,\\mathrm{K}$，及 $t_T = 0.0$。\n\n引入一个气候扰动，作为季节性定时的、高斯形状的温度异常 $G(t; t_{\\mathrm{warm}}, \\sigma)$。扰动后的温度序列 $T_{\\mathrm{pert}}(t)$ 为：\n$$\nT_{\\mathrm{pert}}(t) = T_{\\mathrm{base}}(t) + \\Delta T_{\\mathrm{amp}}\\,G(t; t_{\\mathrm{warm}}, \\sigma)\n$$\n其中 $\\Delta T_{\\mathrm{amp}} = 2\\,\\mathrm{K}$ 且 $\\sigma = 0.08$。函数 $d(t,t_{\\mathrm{warm}})$ 表示单位圆上的最短距离，即 $d(t,t_{\\mathrm{warm}}) = \\min(|t-t_{\\mathrm{warm}}|, 1-|t-t_{\\mathrm{warm}}|)$。\n\n表面反照率 $\\alpha(t)$ 取决于积雪覆盖的地面比例 $F_s(t)$ 和雪本身的内在反照率 $\\alpha_{\\mathrm{snow}}(t)$。积雪比例是温度的逻辑斯谛函数：\n$$\nF_s(T) = \\frac{1}{1 + \\exp\\left(\\frac{T - T_s}{k_T}\\right)}\n$$\n熔点 $T_s = 273.15\\,\\mathrm{K}$，过渡宽度 $k_T = 2\\,\\mathrm{K}$。\n\n关键步骤是为雪的内在反照率建模，它表现出滞后效应。假设雪处于两种状态之一：高反照率的“新雪”（$\\alpha_{\\mathrm{fresh}} = 0.85$）或低反照率的“旧/再冻结雪”（$\\alpha_{\\mathrm{old}} = 0.65$）。一个二进制状态变量 $h(t) \\in \\{1, 0\\}$ 跟踪此状态（新雪=1，旧雪=0）。$h(t)$ 的演化由一个依赖于温度历史的双态有限自动机控制：\n- 如果温度 $T(t)$ 连续 $d_m=5$ 天超过熔点 $T_m = 273.15\\,\\mathrm{K}$，则发生从新雪到旧雪的状态转换（$h: 1 \\to 0$）。\n- 如果在深秋/冬季（$t > 0.75$），温度连续 $d_f=5$ 天降至阈值 $T_f = 268.15\\,\\mathrm{K}$ 以下，则发生从旧雪到新雪的状态转换（$h: 0 \\to 1$）。\n此逻辑按时间顺序应用于全年。瞬时雪地反照率为 $\\alpha_{\\mathrm{snow}}(t) = h(t)\\,\\alpha_{\\mathrm{fresh}} + (1 - h(t))\\,\\alpha_{\\mathrm{old}}$。\n\n有效表面反照率是雪和地面反照率的面积加权平均值：\n$$\n\\alpha(t) = F_s\\left(T(t)\\right)\\,\\alpha_{\\mathrm{snow}}(t) + \\left(1 - F_s\\left(T(t)\\right)\\right)\\,\\alpha_{\\mathrm{ground}}\n$$\n其中 $\\alpha_{\\mathrm{ground}} = 0.20$。此计算针对基准（$T_{\\mathrm{base}}$，得到 $\\alpha_{\\mathrm{base}}$）和扰动（$T_{\\mathrm{pert}}$，得到 $\\alpha_{\\mathrm{pert}}$）两种情景进行。\n\n最后，计算表面反照率反馈参数 $\\lambda_\\alpha$。它被定义为由反照率变化引起的TOA吸收短波辐射的年平均变化量 $\\Delta \\overline{R}_\\alpha$ 与地表温度的年平均变化量 $\\Delta \\overline{T}$ 之比。吸收辐射的变化由下式给出：\n$$\n\\Delta \\overline{R}_\\alpha = \\left\\langle \\frac{S(t)}{4}\\left(\\alpha_{\\mathrm{base}}(t) - \\alpha_{\\mathrm{pert}}(t)\\right) \\right\\rangle_t\n$$\n因子 $1/4$ 考虑了地球的球形几何。年平均温度变化为：\n$$\n\\Delta \\overline{T} = \\left\\langle T_{\\mathrm{pert}}(t) - T_{\\mathrm{base}}(t) \\right\\rangle_t\n$$\n反馈参数则为 $\\lambda_\\alpha = \\frac{\\Delta \\overline{R}_\\alpha}{\\Delta \\overline{T}}$，单位为 $\\mathrm{W\\,m^{-2}\\,K^{-1}}$。\n\n数值实现通过离散化一年周期并计算所有指定量的时间序列来进行。滞后状态 $h(t)$ 是通过遍历全年并在每个每日时间步长应用状态转换规则，为基准和扰动温度序列分别计算的。生成的反照率序列用于计算年平均辐射和温度变化，并从中推导出由 $t_{\\mathrm{warm}}$ 定义的每个测试用例的 $\\lambda_\\alpha$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the surface albedo feedback parameter for seasonally timed warming\n    scenarios within a simple energy balance model with snow albedo hysteresis.\n    \"\"\"\n    \n    # Model parameters\n    params = {\n        'N': 365,               # Number of days in a year\n        'S0': 340.0,            # W m^-2, Mean TOA insolation\n        'S1': 120.0,            # W m^-2, Amplitude of seasonal insolation\n        't_S': 0.5,             # Fractional year, Peak insolation time (summer solstice)\n        'T_mean': 270.0,        # K, Mean annual temperature\n        'T_amp': 18.0,          # K, Amplitude of seasonal temperature cycle\n        't_T': 0.0,             # Fractional year, Peak temperature time (offset from winter solstice)\n        'Delta_T_amp': 2.0,     # K, Amplitude of warming perturbation\n        'sigma': 0.08,          # Fractional year, Width of warming perturbation\n        'T_s': 273.15,          # K, Snow/melt threshold for snow cover fraction\n        'k_T': 2.0,             # K, Width of snow cover transition\n        'alpha_fresh': 0.85,    # Albedo of fresh snow\n        'alpha_old': 0.65,      # Albedo of old/refrozen snow\n        'alpha_ground': 0.20,   # Albedo of snow-free ground\n        'T_m': 273.15,          # K, Temperature threshold for melt transition\n        'T_f': 268.15,          # K, Temperature threshold for fresh snow reset\n        'd_m': 5,               # days, Duration for melt transition\n        'd_f': 5,               # days, Duration for seasonal reset\n        'reset_t_start': 0.75   # Fractional year, Start of season for reset\n    }\n\n    # Time grid\n    t = np.linspace(0, 1, params['N'], endpoint=False)\n\n    # --- Helper Functions ---\n    def get_insolation(t_arr):\n        return params['S0'] + params['S1'] * np.cos(2 * np.pi * (t_arr - params['t_S']))\n\n    def get_temp_base(t_arr):\n        return params['T_mean'] + params['T_amp'] * np.cos(2 * np.pi * (t_arr - params['t_T']))\n\n    def get_temp_pert(t_arr, T_base_arr, t_warm):\n        diff = np.abs(t_arr - t_warm)\n        periodic_dist = np.minimum(diff, 1.0 - diff)\n        G = np.exp(-periodic_dist**2 / (2 * params['sigma']**2))\n        return T_base_arr + params['Delta_T_amp'] * G\n\n    def get_snow_cover_fraction(T_arr):\n        return 1.0 / (1.0 + np.exp((T_arr - params['T_s']) / params['k_T']))\n    \n    def process_hysteresis_state(T_series, t_series):\n        N = len(T_series)\n        h = np.zeros(N)\n        \n        # Initial state at t=0\n        if T_series[0] = params['T_m'] - 5.0:\n            h[0] = 1\n        else:\n            h[0] = 0\n            \n        for i in range(1, N):\n            current_h_state = h[i-1]\n            \n            # Check for melt transition condition\n            melt_condition_met = False\n            if i >= params['d_m'] - 1:\n                window = T_series[i - params['d_m'] + 1 : i + 1]\n                if np.all(window > params['T_m']):\n                    melt_condition_met = True\n            \n            # Check for seasonal reset condition\n            reset_condition_met = False\n            if t_series[i] > params['reset_t_start'] and i >= params['d_f'] - 1:\n                window = T_series[i - params['d_f'] + 1 : i + 1]\n                if np.all(window  params['T_f']):\n                    reset_condition_met = True\n            \n            # Apply state transition rules\n            if current_h_state == 1 and melt_condition_met:\n                h[i] = 0  # Fresh -> Old\n            elif current_h_state == 0 and reset_condition_met:\n                h[i] = 1  # Old -> Fresh\n            else:\n                h[i] = current_h_state # Persist state\n        \n        return h\n\n    def get_surface_albedo(T_arr, h_arr):\n        Fs = get_snow_cover_fraction(T_arr)\n        alpha_snow = h_arr * params['alpha_fresh'] + (1 - h_arr) * params['alpha_old']\n        return Fs * alpha_snow + (1 - Fs) * params['alpha_ground']\n\n    # --- Main Calculation Loop ---\n    test_cases = [0.33, 0.00, 0.50, 0.75]\n    results = []\n\n    # Pre-calculate time-series that are independent of the test case\n    S_t = get_insolation(t)\n    T_base_t = get_temp_base(t)\n    h_base_t = process_hysteresis_state(T_base_t, t)\n    alpha_base_t = get_surface_albedo(T_base_t, h_base_t)\n\n    for t_warm in test_cases:\n        # Calculate perturbed temperature series\n        T_pert_t = get_temp_pert(t, T_base_t, t_warm)\n\n        # Calculate hysteresis and albedo for the perturbed case\n        h_pert_t = process_hysteresis_state(T_pert_t, t)\n        alpha_pert_t = get_surface_albedo(T_pert_t, h_pert_t)\n        \n        # Calculate annual-mean changes\n        delta_R_alpha = np.mean((S_t / 4.0) * (alpha_base_t - alpha_pert_t))\n        delta_T = np.mean(T_pert_t - T_base_t)\n        \n        # Calculate feedback parameter\n        lambda_alpha = delta_R_alpha / delta_T if delta_T != 0 else 0.0\n        results.append(lambda_alpha)\n\n    # Format and print the final output\n    formatted_results = [f\"{res:.3f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}