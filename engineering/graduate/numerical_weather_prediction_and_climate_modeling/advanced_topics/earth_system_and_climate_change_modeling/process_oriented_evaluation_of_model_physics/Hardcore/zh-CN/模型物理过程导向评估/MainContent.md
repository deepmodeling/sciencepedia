## 引言
在[数值天气预报](@entry_id:191656)（NWP）和气候模拟领域，模型的物理过程[参数化](@entry_id:265163)方案是其性能的基石，直接决定了预报的准确性和对[未来气候预测](@entry_id:1125421)的可信度。然而，评估这些方案的保真度远比想象中复杂。传统的评估方法往往依赖于技巧评分，如均方根误差，但这些指标只能告诉我们模型预测的“结果”是否准确，却无法揭示其“过程”是否正确。一个模型可能因为不同物理过程间的“补偿性误差”——即一个偏差恰好抵消了另一个偏差——而侥幸得到正确答案。这种“殊途同归”的现象掩盖了模型内部深层的、结构性的缺陷，使其在面对新的气候态或极端事件时变得不可靠。

为了解决这一核心挑战，本文系统地介绍了“面向过程的评估”（Process-oriented Evaluation）这一强大方法论。它引导我们从问“模型是否正确？”转向问“模型是否因正确的原因而正确？”。通过深入探究模型内部的物理因果链，该方法为识别和修正模式偏差提供了清晰的路[线图](@entry_id:264599)。在接下来的章节中，我们将踏上一段从理论到实践的旅程。第一章“原理与机制”将奠定该方法论的理论基础，阐明其如何基于物理守恒律和因果推断来诊断[参数化](@entry_id:265163)方案。第二章“应用与交叉学科联系”将通过一系列生动的案例，展示该方法在评估地气交换、对流、云微物理乃至季风和极端事件等复杂现象中的实际应用。最后，第三章“动手实践”将提供具体练习，帮助读者将这些概念应用于解决实际问题。通过本次学习，你将掌握一套能够揭示模型内在行为、提升预报与预测信心的核心技能。

## 原理与机制

在数值天气预报（NWP）和气候模型中，物理过程的准确表示是预报技巧和气候预测可信度的基石。然而，评估这些物理过程[参数化](@entry_id:265163)方案的保真度是一项艰巨的挑战。本章旨在深入探讨“面向过程的评估”（process-oriented evaluation）的核心原理与机制。我们将阐明它如何超越传统的技巧评分，并提供一个系统性的框架，用于诊断模型物理过程的因果路径和内在缺陷。

### 超越技巧评分：面向过程评估的定义

传统的模型评估通常依赖于对预报或模拟的最终[状态变量](@entry_id:138790)（如温度、湿度、风场）进行技巧评分。这些评分，如**均方根误差 (Root Mean Square Error, RMSE)** 或 **[距平相关系数](@entry_id:1121047) (anomaly correlation)**，量化了模型的整体性能。然而，它们本身并不能揭示误差的来源。一个模型可能因为错误的物理原因而得到正确的结果——这种现象被称为“**补偿性误差**”(compensating errors)。例如，一个过强的对流加热偏误可能被一个过强的辐射冷却偏误所抵消，导致温度预报的总体误差很小，但这掩盖了模型物理机制的根本缺陷。

面向过程的评估正是为了解决这一难题而设计的。其核心目标是评估[参数化](@entry_id:265163)的物理过程是否通过物理上可信的**机制路径 (mechanistic pathways)** 来运作，而不仅仅是产生小的集合误差 。这一方法论植根于物理学的基本**守恒律 (conservation laws)**。考虑一个守恒的示踪物 $q$（如比湿）或能量 $h$（如湿静力能），其控制方程可示意性地写为：

$$
\frac{\partial q}{\partial t} = - \nabla \cdot \mathbf{F}_q + S_q^{\text{phys}}
$$

$$
\frac{\partial h}{\partial t} = - \nabla \cdot \mathbf{F}_h + S_h^{\text{phys}} + Q
$$

其中，$\mathbf{F}_q$ 和 $\mathbf{F}_h$ 是由可分辨的动力学过程（如平流）引起的通量，而 $S_q^{\text{phys}}$ 和 $S_h^{\text{phys}}$ 是由[参数化](@entry_id:265163)方案表示的[次网格尺度物理](@entry_id:1132594)过程（如对流、微物理、[湍流](@entry_id:151300)）产生的倾向项。$Q$ 代表外部非绝热强迫（如辐射）。

面向过程的评估不关注最终的 $q$ 或 $h$ 场，而是直接审视这些**物理倾向项** $S^{\text{phys}}$。它试图回答这样的问题：[参数化](@entry_id:265163)方案是否以物理上合理的方式响应其驱动因子？例如，对流[参数化](@entry_id:265163)产生的加热 $S_h^{\text{phys}}$ 是否随着大气不稳定度（如**对流有效位能 (Convective Available Potential Energy, CAPE)**）的增加而增强？地表上空的对流活动是否与日循环的[辐射强迫](@entry_id:155289) $Q$ 具有正确的相位关系？

因此，一个**过程度量 (process metric)** 被定义为量化这些因果关系的诊断量。这些度量通常涉及在特定条件下（例如，按 CAPE 或 **低层对流层稳定度 (Lower Tropospheric Stability, LTS)** [分箱](@entry_id:264748)）对倾向项进行分析，例如计算[条件期望](@entry_id:159140)、[回归系数](@entry_id:634860)或相[干性](@entry_id:900268)。通过这种方式，即使模型的总体技巧评分很高，我们也能揭示出其内部错误的因果路径或补偿性误差，从而为模型改进提供更具针对性的指导  。

### 基石：守恒律与[因果结构](@entry_id:159914)

面向过程评估的逻辑起点是物理守恒律，以及将[参数化](@entry_id:265163)方案视为一个因果映射的观念。

#### [离散守恒](@entry_id:1123819)与收支诊断

在连续介质中，守恒律通过[偏微分](@entry_id:194612)方程表达。然而，在数值模型中，这些方程在离散的网格上求解。确保物理量在离散层面上的守恒至关重要。一种常用的数值方法是**[有限体积法](@entry_id:141374) (finite-volume method)**。对于一个示踪物质量 $\rho q$，其守恒方程为：

$$
\frac{\partial}{\partial t}(\rho q) + \nabla \cdot (\rho q \mathbf{u}) = \rho S_{\text{phys}}
$$

在[有限体积法](@entry_id:141374)中，如果采用**通量形式 (flux-form)** 离散，即通过计算跨越网格单元边界的通量来更新单元内的总量，那么只要内部界面的通量是反对称的（即一个单元流出的等于相邻单元流入的），并且没有外部源汇，那么整个计算域的总量将在数值上精确守恒（不计[浮点误差](@entry_id:173912)）。相反，如果采用**平流形式 (advective-form)**，如 $\partial_t q = -\mathbf{u} \cdot \nabla q + S_{\text{phys}}$，在可压缩流中，由于质量[连续性方程](@entry_id:195013)和示踪物[平流方程](@entry_id:144869)的离散算子通常不满足精确的[乘积法则](@entry_id:158393)，总的示踪物质量 $\int \rho q \, dV$ 的守恒性无法得到保证 。

这一区别对于模型评估至关重要。我们可以设计一种称为**收支残差诊断 (budget residual diagnostic)** 的工具。该诊断通过比较模型[状态变量](@entry_id:138790)在一段时间内的实际变化与所有已知的、模型明确计算的倾向项（包括动力学和物理过程）的时间积分之和来进行。在一个无程序错误的保守模型中，这个残差应该恒等于零（在[浮点精度](@entry_id:138433)范围内）。如果出现持续的非零残差，则表明模型中存在一个不守恒的“漏洞”，例如代码错误、一个未被计入的数值平滑过程，或者物理过程与动力核心之间不恰当的耦合。

值得注意的是，收支残差诊断主要用于检验模型的**[自洽性](@entry_id:160889)与守恒性**，即程序实现的正确性。它本身无法判断物理过程的保真度。例如，一个采用保守[通量形式](@entry_id:273811)实现的数值方案，其固有的**数值扩散 (numerical diffusion)** 也是作为通量的一部分被计算的。这种扩散会平滑梯度，重新分布示踪物，但不会改变总量。因此，收支残差诊断无法探测到这种数值扩散的存在，因为它已经被计入“已知的”[通量散度](@entry_id:1125154)项中 。

#### [参数化](@entry_id:265163)作为因果映射

从概念上讲，一个[物理参数化](@entry_id:1129649)方案可以被视为一个因果映射函数 $\mathcal{F}_{\text{phys}}$。它接收当前的可分辨尺度大气[状态向量](@entry_id:154607) $\mathbf{X}(t)$（包括温度、湿度、风、云等）作为输入，并输出一个瞬时物理倾向向量 $\mathbf{T}_{\text{phys}}(t)$：

$$
\mathbf{T}_{\text{phys}}(t) = \mathcal{F}_{\text{phys}}(\mathbf{X}(t))
$$

面向过程评估的本质，就是检验这个映射函数 $\mathcal{F}_{\text{phys}}$ 是否正确。要做到这一点，我们必须设计实验来隔离单个过程，并为这个函数提供已知的输入 $\mathbf{X}(t)$，然后将其输出 $\mathbf{T}_{\text{phys}}(t)$ 与基于观测或更高保真度模型的基准进行比较 。

### 隔离过程的[实验设计](@entry_id:142447)

为了可靠地评估[参数化](@entry_id:265163)方案的因果行为，必须精心设计实验来将其与其他模型分量和误差源隔离开来。

#### 因果归因与受控实验

在复杂的非线性系统中，**相关不等于因果**。例如，在一个包含多个[历史模拟](@entry_id:136441)的数据库中，我们可能会观察到某个对流参数 $\theta$ 与区域平均降水 $Y$ 之间存在[统计关联](@entry_id:172897)。然而，这种关联可能是虚假的。也许在开发过程中，模型开发者倾向于为具有较高海表温度（一个外部驱动因子 $S$）的实验选择较高的 $\theta$ 值。由于较高的海温本身也能导致更多的降水，观测到的 $\theta$ 和 $Y$ 之间的关联可能被 $S$ 所**混淆 (confound)**。

要确定 $\theta$ 对 $Y$ 的**因果效应 (causal effect)**，我们必须进行受控实验。在模型中，这通常通过“**孪生实验 (twin experiments)**”来实现：运行两个模拟，它们具有完全相同的初始条件、外部强迫 $S$ 以及除待测参数外所有其他模型设置。唯一的区别是一个模拟使用参数值 $\theta_1$，另一个使用 $\theta_2$。这两个模拟结果的差异就可以归因于参数 $\theta$ 的改变。这种方法通过固定所有其他变量来阻断混淆路径，从而实现对因果关系的严格探究 。

#### 实验工具箱

多种实验框架被用于实现过程隔离：

1.  **离线测试 (Offline Tests)**：这是最纯粹的隔离形式。例如，将一个辐射[参数化](@entry_id:265163)方案从完整模型中剥离出来，用观测到的温度、湿度和气体廓线作为输入，并将其计算出的辐射通量与一个高精度的**逐[线积分](@entry_id:141417)[辐射传输模型](@entry_id:1130513) (line-by-line radiative transfer model)** 的结果进行比较。因为输入状态是固定的，所以这种测试完全独立于模型其他部分的累积误差 。

2.  **[单柱模型](@entry_id:1131703) (Single Column Models, SCMs)**：SCM 是一个强大的工具，它在一个单独的垂直气柱中运行完整的物理参数化包。气柱的演变受到来自**密集观测期 (Intensive Observation Period, IOP)** 数据驱动的大尺度强迫的控制。有两种主要的强迫方法 ：
    *   **给定平流倾向 (Prescribed advective tendencies)**：直接将观测到的大尺度平流对温度和湿度的贡献（$F_{\phi}^{\text{adv}}$）作为外部源汇项加入到 SCM 的控制方程中。这种方法提供了一个与模型状态无关的“干净”强迫，使得[参数化](@entry_id:265163)物理倾向（$T_{\phi}^{\text{phys}}$）与已知外部驱动之间的关系清晰明了，便于进行因果归因。在准[稳态](@entry_id:139253)下，物理倾向必须平衡所有外部强迫：$\overline{T_{\phi}^{\text{phys}}} \approx -(\overline{F_{\phi}^{\text{adv}}} + \overline{S_{\phi}^{\text{rad}}} + \dots)$。
    *   **弛豫或牛顿逼近 (Relaxation or Nudging)**：用一个“拉向”观测廓线 $\phi^{\text{obs}}$ 的项 $R_{\phi} = (\phi^{\text{obs}} - \phi)/\tau$ 来代替或补充平流强迫，其中 $\tau$ 是一个人为设定的[弛豫时间尺度](@entry_id:1130826)。这种方法能有效地将模型状态约束在观测附近，避免其“漂移”，但代价是引入了一个非物理的、依赖于模型自身误差的反馈项。这使得物理倾向的诊断结果依赖于 $\tau$ 的选择，从而模糊了物理过程对真实大尺度环境的因果响应。

3.  **[云解析模型](@entry_id:1122507) (Cloud-Resolving Models, CRMs) 作为“[虚拟现实](@entry_id:1133827)”**：CRM 在非常高的分辨率（例如，水平网格间距小于 1 公里）下运行，能够显式地解析对流等过程，而无需对其进行[参数化](@entry_id:265163)。因此，CRM 的模拟输出可以作为一种“虚拟真理”，用于生成评估 GCM [参数化](@entry_id:265163)方案的基准。然而，这种比较必须小心进行，以确保尺度匹配 。
    *   一个关键步骤是**保守[粗粒化](@entry_id:141933) (conservative coarse-graining)**。必须使用一个保守的空间滤波器（其积分核为1）将高分辨率的 CRM 场进行平滑，使其尺度与 GCM 的网格尺度（如 100 公里）相匹配。同时，时间上也需要进行匹配的平均（如平均到 GCM 的一个时间步长）。
    *   只有经过这样处理后，才能进行有意义的比较。有效的基准包括：比较[粗粒化](@entry_id:141933)后的能量和水汽收支、从[粗粒化](@entry_id:141933)场中诊断出的有效垂直质量通量 $\overline{M}(z)$、或者关键环境控制因子（如稳定度）与对流响应（如云底质量通量）之间的统计关系。
    *   直接比较不同尺度上的量是无意义的，例如，将 CRM 中瞬时的、点状的最大上升气流速度与 GCM 网格平均的输出进行比较，这在概念上是错误的。

### 高级诊断框架

在掌握了基本原理和实验方法之后，我们可以应用更高级的框架来深化对模型物理过程的理解。

#### 区分结构与[参数不确定性](@entry_id:264387)

模型的不确定性可以分为两类 ：
*   **结构不确定性 (Structural uncertainty)**：源于[参数化](@entry_id:265163)方案的基本方程、假设和所包含过程的选择。例如，选择不同的对流触发函数或微物理过程表示，都属于结构上的差异。探测这种不确定性需要进行模型互比较，即在相同的强迫下运行具有不同结构（$s_1, s_2, s_3, \dots$）的方案。
*   **参数不确定性 (Parametric uncertainty)**：源于在一个**固定**的结构内，可调参数 $\boldsymbol{\theta}$ 的取值不确定。例如，对流方案中的夹卷率或微物理方案中雨滴的下落末速。探测这种不确定性通常通过运行**[扰动参数集合](@entry_id:1129539) (perturbed-parameter ensemble)** 来实现，即对同一方案的多个参数在其不确定性范围内进行系统性的抽样。

SCM 和 CRM 等过程导向的实验是区分和量化这两种不确定性的理想平台。通过精心设计的实验（例如，比较不同的方案或对单个方案进行参数扰动），我们可以将总[不确定性分解](@entry_id:183314)为来自结构和参数的贡献。

#### 依赖于过程机制的诊断

物理过程的行为强烈依赖于其所处的大气环境。因此，一刀切式的评估是不够的，必须采用**依赖于机制的诊断 (regime-dependent diagnostics)**。这意味着需要首先根据物理判据对不同的天气或气候机制进行分类，然后为每个机制应用量身定制的诊断方法 。

三个经典云机制的例子是：
*   **层积云 (Stratocumulus)**：通常出现在由强大的**低层对流层稳定度 (LTS)** 和 **估算逆温强度 (Estimated Inversion Strength, EIS)** 表征的稳定副热带地区。其维持主要依赖于云顶长波[辐射冷却](@entry_id:1130496)驱动的湍流混合和对逆温顶的夹卷。因此，针对性的诊断应关注云顶夹卷速度 $w_e$ 与辐射冷却和逆温强度的关系、液态水路径 (LWP) 与辐射的耦合，以及[湍流](@entry_id:151300)能量收支。
*   **浅积云 (Shallow cumulus)**：常见于信风带，由边界层内的热力泡触发。其强度受到次云层能量收支的制约，其中地表[潜热通量](@entry_id:1127093)是关键驱动力。合适的诊断包括评估云底质量通量 $M_b$ 与地表通量的关系，以及云中夹卷和卷出的垂直廓线。
*   **深对流 (Deep convection)**：发生在具有高 **CAPE** 和低**对流抑制 (Convective Inhibition, CIN)** 的不稳定环境中。其核心是能量的快速垂直输送和潜热释放。关键诊断包括对流对 CAPE 的消耗率、垂直质量通量 $M(z)$ 的廓线、降水的日循环和[强度分布](@entry_id:163068)，以及由下沉气流形成的冷池动力学。

#### 过程网络与偏差传播

[模型偏差](@entry_id:184783)的产生和发展往往不是单个过程的孤立行为，而是多个过程通过反馈相互作用的结果。我们可以将模型中的物理过程和状态变量看作一个**过程网络 (process network)** 。在这个网络中，一个过程的偏差可以沿着复杂的路径传播，并影响其他过程。

考虑一个简化的[线性系统](@entry_id:147850)，其中比湿 $q$ 和云液态水 $L$ 的演变由对流（C）、微物理（M）和辐射（R）过程共同决定：
$$
\frac{d}{dt}
\begin{bmatrix}
q \\
L
\end{bmatrix}
= (\mathbf{J}_C + \mathbf{J}_M + \mathbf{J}_R)
\begin{bmatrix}
q \\
L
\end{bmatrix}
+ \dots = \mathbf{A}
\begin{bmatrix}
q \\
L
\end{bmatrix}
+ \dots
$$
其中 $\mathbf{A}$ 是总的[雅可比矩阵](@entry_id:178326)。矩阵 $\mathbf{A}$ 的对角线元素代表每个变量的**自阻尼 (self-damping)**（例如，云液态水越多，辐射冷却越强，导致自身减少），而非对角[线元](@entry_id:196833)素则代表**交叉变量耦合 (cross-variable couplings)**（例如，[比湿](@entry_id:1132076)增加通过微物理过程导致云液态水增加）。

假设辐射方案存在一个恒定的正偏差，直接导致 $L$ 倾向偏高。这个偏差不仅会通过 $L$ 的自阻尼产生一个“直接”的 $L$ 状态偏差，还会通过交叉耦合产生“间接”的偏差。例如，偏高的 $L$ 可能通过微物理过程影响 $q$，而 $q$ 的变化反过来又会通过其他微物理路径影响 $L$。通过分析[雅可比矩阵](@entry_id:178326) $\mathbf{A}$ 的结构，我们可以将总的[稳态](@entry_id:139253)偏差分解为直接贡献和通过特定过程（如微物理）介导的间接贡献，从而追踪偏差的传播路径。

#### 涌现约束：连接过程与气候变化

面向过程评估的最终目标之一是增强我们对未来气候变化预测的信心。**[涌现约束](@entry_id:189677) (Emergent Constraint)** 是连接过程级理解与宏观气候预测的强大概念 。

一个涌现约束是指在一个多模型集合中，某个未来气候响应 $R$（如全球变暖下的云反馈，难以直接观测）与某个当前气候中可观测的量 $O$（如某区域的云量对海温的敏感度）之间存在的一个统计上显著的相关关系。如果这种关系成立，我们就可以通过精确观测现实世界中的 $O^{\text{obs}}$，来约束 $R$ 的真实值。

然而，一个可靠的涌现约束必须具有**坚实的物理机制基础**。仅仅是[统计相关](@entry_id:200201)是不够的，因为它可能源于模型的共同缺陷或如前述的[混淆变量](@entry_id:199777)。一个基于过程的涌现约束要求存在一个共同的、可识别的物理驱动因子或参数 $\theta$（例如，浅云夹卷效率），它在因果上同时影响了 $O$ 和 $R$。即，存在因果链 $O \leftarrow \theta \rightarrow R$。

面向过程的评估通过诊断和理解这条因果链，为[涌现约束](@entry_id:189677)的有效性提供了证据。通过检验这一机制在不同条件下的[不变性](@entry_id:140168)，并排除混淆因子的影响，我们可以建立对从当前气候向未来气候进行外推的信心。从数学上讲，只有在消除了混淆（例如，$\theta$ 与其他模型特征无关）和[自变量](@entry_id:267118)的测量误差（$O$ 的观测足够精确）之后，观测到的统计斜率才能准确地反映潜在的物理关系，从而提供一个鲁棒的约束。

总之，面向过程的评估提供了一套从基本原理到高级应用的完整方法论。它通过关注物理机制、设计隔离实验、采用针对性诊断以及理解过程间的相互作用，使我们能够超越简单的技巧评分，深入洞察数值模型的内在行为，并最终为提升天气预报和[气候预测](@entry_id:184747)的可靠性奠定科学基础。