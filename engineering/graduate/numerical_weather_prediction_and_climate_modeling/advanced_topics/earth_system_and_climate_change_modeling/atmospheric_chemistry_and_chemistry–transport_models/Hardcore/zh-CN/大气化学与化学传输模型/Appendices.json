{
    "hands_on_practices": [
        {
            "introduction": "在大气化学-输送模型 (CTM) 中，化学反应速率对温度高度敏感。本练习  旨在通过应用阿伦尼乌斯方程 (Arrhenius equation) 来量化这种依赖性。通过推导和计算两条竞争反应路径速率相等的“交叉温度”($T^{\\ast}$)，您将亲身体验温度如何决定大气中主导的化学转化途径，这是理解和模拟真实大气化学过程的关键技能。",
            "id": "4013335",
            "problem": "在用于对流层低层的化学输送模型（CTM）中实施一个简化的气相反应机理时，两个竞争性的羟基自由基与挥发性有机化合物的反应被表示为平行的、基元的、双分子步骤。在所研究的温度范围内，每个反应的温度依赖性遵循阿伦尼乌斯定律，具有恒定的指前因子和单一的活化能，并且在对流层条件下，压力效应可以忽略不计。\n\n- 反应 $\\mathrm{R1}$: $\\mathrm{OH} + \\mathrm{VOC1} \\rightarrow \\text{products}$ 的指前因子为 $A_{1} = 5.0 \\times 10^{-12}$ (单位为 $\\text{cm}^{3}\\ \\text{molecule}^{-1}\\ \\text{s}^{-1}$)，活化能为 $E_{a,1} = 15.00$ (单位为 $\\text{kJ mol}^{-1}$)。\n- 反应 $\\mathrm{R2}$: $\\mathrm{OH} + \\mathrm{VOC2} \\rightarrow \\text{products}$ 的指前因子为 $A_{2} = 1.0 \\times 10^{-12}$ (单位为 $\\text{cm}^{3}\\ \\text{molecule}^{-1}\\ \\text{s}^{-1}$)，活化能为 $E_{a,2} = 11.05$ (单位为 $\\text{kJ mol}^{-1}$)。\n\n假设两个反应速率均由上述参数表征的阿伦尼乌斯依赖关系描述。从基本动力学原理和作为经过充分检验的经验关系的阿伦尼乌斯定律出发，推导当两个双分子反应速率系数相等时的交叉温度 $T^{\\ast}$ 的闭式表达式，并使用普适气体常数 $R = 8.314$ (单位为 $\\text{J mol}^{-1}\\ \\text{K}^{-1}$) 对 $T^{\\ast}$ 进行数值计算。清晰地说明推导过程中使用的任何变换。最终温度以开尔文表示，并将答案四舍五入至四位有效数字。\n\n为使推理完整，也请推导通用阿伦尼乌斯速率系数的一般对数温度敏感度 $S_{k}(T) \\equiv \\mathrm{d}\\ln k/\\mathrm{d}\\ln T$；但是，只需按照四舍五入的指示，将 $T^{\\ast}$ 的数值（以开尔文为单位）作为最终答案报告。",
            "solution": "该问题陈述已经过严格验证，被认为是具有科学依据、问题设定良好且客观的。它基于已确立的化学动力学原理（阿伦尼乌斯定律），并设置在大气化学的现实背景中。所有必要的数据均已提供，问题没有内部矛盾或歧义。\n\n核心任务是找到“交叉温度”$T^{\\ast}$，在该温度下，两个竞争性双分子反应 R1 和 R2 的速率系数相等。每个速率系数 $k(T)$ 的温度依赖性由阿伦尼乌斯方程描述：\n$$k(T) = A \\exp\\left(-\\frac{E_a}{RT}\\right)$$\n其中 $A$ 是指前因子，$E_a$ 是活化能，$R$ 是普适气体常数，$T$ 是绝对温度（以开尔文为单位）。\n\n对于这两个反应，我们有：\n- 反应 R1：$k_1(T) = A_1 \\exp\\left(-\\frac{E_{a,1}}{RT}\\right)$\n- 反应 R2：$k_2(T) = A_2 \\exp\\left(-\\frac{E_{a,2}}{RT}\\right)$\n\n交叉温度 $T^{\\ast}$ 由条件 $k_1(T^{\\ast}) = k_2(T^{\\ast})$ 定义。我们可以将两个速率系数的表达式设为相等，以求解 $T^{\\ast}$：\n$$A_1 \\exp\\left(-\\frac{E_{a,1}}{RT^{\\ast}}\\right) = A_2 \\exp\\left(-\\frac{E_{a,2}}{RT^{\\ast}}\\right)$$\n\n为了求解 $T^{\\ast}$，我们首先通过将指前因子和指数项分组来重排方程：\n$$\\frac{A_1}{A_2} = \\frac{\\exp\\left(-\\frac{E_{a,2}}{RT^{\\ast}}\\right)}{\\exp\\left(-\\frac{E_{a,1}}{RT^{\\ast}}\\right)}$$\n使用指数性质 $\\exp(a)/\\exp(b) = \\exp(a-b)$，方程右侧简化为：\n$$\\frac{A_1}{A_2} = \\exp\\left(-\\frac{E_{a,2}}{RT^{\\ast}} - \\left(-\\frac{E_{a,1}}{RT^{\\ast}}\\right)\\right) = \\exp\\left(\\frac{E_{a,1} - E_{a,2}}{RT^{\\ast}}\\right)$$\n\n为了分离出 $T^{\\ast}$，我们对等式两边取自然对数。这是处理涉及指数的方程的标准变换：\n$$\\ln\\left(\\frac{A_1}{A_2}\\right) = \\ln\\left(\\exp\\left(\\frac{E_{a,1} - E_{a,2}}{RT^{\\ast}}\\right)\\right)$$\n$$\\ln\\left(\\frac{A_1}{A_2}\\right) = \\frac{E_{a,1} - E_{a,2}}{RT^{\\ast}}$$\n\n最后，我们对该表达式进行代数重排以求解 $T^{\\ast}$：\n$$T^{\\ast} = \\frac{E_{a,1} - E_{a,2}}{R \\ln\\left(\\frac{A_1}{A_2}\\right)}$$\n这就是推导出的交叉温度的闭式表达式。\n\n现在，我们代入给定的数值来计算 $T^{\\ast}$。\n给定的参数为：\n- $A_1 = 5.0 \\times 10^{-12}\\ \\text{cm}^{3}\\ \\text{molecule}^{-1}\\ \\text{s}^{-1}$\n- $A_2 = 1.0 \\times 10^{-12}\\ \\text{cm}^{3}\\ \\text{molecule}^{-1}\\ \\text{s}^{-1}$\n- $E_{a,1} = 15.00\\ \\text{kJ mol}^{-1}$\n- $E_{a,2} = 11.05\\ \\text{kJ mol}^{-1}$\n- $R = 8.314\\ \\text{J mol}^{-1}\\ \\text{K}^{-1}$\n\n在代入之前，我们必须确保单位一致。活化能的单位是 $\\text{kJ mol}^{-1}$，而气体常数的单位是 $\\text{J mol}^{-1}\\ \\text{K}^{-1}$。我们将活化能转换为焦耳：\n$E_{a,1} = 15.00\\ \\text{kJ mol}^{-1} \\times 1000\\ \\text{J kJ}^{-1} = 15000\\ \\text{J mol}^{-1}$\n$E_{a,2} = 11.05\\ \\text{kJ mol}^{-1} \\times 1000\\ \\text{J kJ}^{-1} = 11050\\ \\text{J mol}^{-1}$\n\n活化能之差为：\n$E_{a,1} - E_{a,2} = 15000\\ \\text{J mol}^{-1} - 11050\\ \\text{J mol}^{-1} = 3950\\ \\text{J mol}^{-1}$\n\n指前因子之比为：\n$\\frac{A_1}{A_2} = \\frac{5.0 \\times 10^{-12}}{1.0 \\times 10^{-12}} = 5.0$\n\n现在，将这些值代入 $T^{\\ast}$ 的表达式中：\n$$T^{\\ast} = \\frac{3950\\ \\text{J mol}^{-1}}{(8.314\\ \\text{J mol}^{-1}\\ \\text{K}^{-1}) \\times \\ln(5.0)}$$\n$$T^{\\ast} = \\frac{3950}{8.314 \\times 1.6094379...}\\ \\text{K}$$\n$$T^{\\ast} \\approx \\frac{3950}{13.38154}\\ \\text{K} \\approx 295.185\\ \\text{K}$$\n按照指示将结果四舍五入至四位有效数字，得到 $T^{\\ast} = 295.2\\ \\text{K}$。\n\n为了完整起见，按照要求，我们推导阿伦尼乌斯速率系数 $k(T) = A \\exp(-E_a/RT)$ 的一般对数温度敏感度 $S_{k}(T) \\equiv \\mathrm{d}\\ln k/\\mathrm{d}\\ln T$。\n首先，我们对 $k(T)$ 取自然对数：\n$$\\ln k(T) = \\ln\\left(A \\exp\\left(-\\frac{E_a}{RT}\\right)\\right) = \\ln A + \\ln\\left(\\exp\\left(-\\frac{E_a}{RT}\\right)\\right) = \\ln A - \\frac{E_a}{RT}$$\n为了求 $\\ln k$ 关于 $\\ln T$ 的导数，我们使用链式法则：\n$$S_k(T) = \\frac{\\mathrm{d}\\ln k}{\\mathrm{d}\\ln T} = \\frac{\\mathrm{d}(\\ln k) / \\mathrm{d}T}{\\mathrm{d}(\\ln T) / \\mathrm{d}T}$$\n我们分别计算这两个导数：\n$$\\frac{\\mathrm{d}(\\ln k)}{\\mathrm{d}T} = \\frac{\\mathrm{d}}{\\mathrm{d}T}\\left(\\ln A - \\frac{E_a}{R}T^{-1}\\right) = 0 - \\frac{E_a}{R}(-1)T^{-2} = \\frac{E_a}{RT^2}$$\n$$\\frac{\\mathrm{d}(\\ln T)}{\\mathrm{d}T} = \\frac{1}{T}$$\n将它们代入 $S_k(T)$ 的表达式中：\n$$S_k(T) = \\frac{\\frac{E_a}{RT^2}}{\\frac{1}{T}} = \\frac{E_a}{RT^2} \\times T = \\frac{E_a}{RT}$$\n这个量 $E_a/(RT)$ 代表了速率系数对温度相对变化的无量纲敏感度。",
            "answer": "$$\\boxed{295.2}$$"
        },
        {
            "introduction": "化学-输送模型需要同时求解输送和化学反应等多个过程，算子分裂 (operator splitting) 是一种常用的数值方法。然而，由于这些过程在物理上是相互耦合的，顺序求解会引入误差。本练习  通过一个编程实践，让您亲手量化这种分裂误差：您将比较“先输送后化学”与“先化学后输送”两种方案的差异，从而直观地理解模型中一个核心的误差来源。",
            "id": "4013367",
            "problem": "考虑一个大气化学中的一维反应输运问题，该问题定义在一个周期性域上，旨在模拟一个具有空间变化光解速率（例如云和太阳天顶角变化）的理想化光化学损失过程。浓度场 $c(x,t)$（其中 $x \\in [0,L)$，时间 $t \\ge 0$）的控制方程为\n$$\n\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = -k(x)\\, c,\n$$\n其中 $u$ 是一个恒定的平流速度，$k(x)$ 是一个空间变化的一阶损失率。设损失率指定为\n$$\nk(x) = k_0 + k_1 \\sin\\left(\\frac{2\\pi x}{L}\\right),\n$$\n其中 $k_0  0$ 且 $k_1 \\ge 0$，初始浓度为\n$$\nc_0(x) = c_b + A \\sin\\left(\\frac{4\\pi x}{L}\\right) + \\frac{A}{2} \\cos\\left(\\frac{6\\pi x}{L}\\right),\n$$\n其中 $c_b  0$ 且 $A  0$。边界条件在区间 $[0,L)$ 上是周期性的。\n\n本问题研究了在数值天气预报 (NWP) 和气候模拟中的化学输运模型 (CTMs) 中常用的两种一阶算子分裂方法：\n\n- 输运-化学 (TC)：在一个长度为 $\\Delta t$ 的时间步长内应用平流输运，然后应用 $\\Delta t$ 内的化学损失。\n- 化学-输运 (CT)：在一个长度为 $\\Delta t$ 的时间步长内应用化学损失，然后应用 $\\Delta t$ 内的平流输运。\n\n对于恒定的 $u$，在时间 $\\Delta t$ 内的平流输运等效于一个位移 $x \\mapsto x - u \\Delta t$（具有周期性环绕）。在时间 $\\Delta t$ 内的化学损失算子是一个局部乘法，乘以因子 $\\exp\\left(-k(x)\\, \\Delta t\\right)$。仅使用这些基本算子，这两种在一个时间步长内的顺序组合产生的场为\n$$\nc_{\\mathrm{TC}}(x) = \\exp\\left(-k(x)\\, \\Delta t\\right)\\, c_0\\!\\left(x - u\\Delta t\\right),\n$$\n$$\nc_{\\mathrm{CT}}(x) = \\exp\\left(-k\\!\\left(x - u\\Delta t\\right)\\, \\Delta t\\right)\\, c_0\\!\\left(x - u\\Delta t\\right).\n$$\n将在一个步长后域上的均方根 (RMS) 差定义为\n$$\nE = \\sqrt{\\frac{1}{L}\\int_0^L \\left(c_{\\mathrm{TC}}(x) - c_{\\mathrm{CT}}(x)\\right)^2\\, dx},\n$$\n并以 mol m$^{-3}$ 为单位报告 $E$。\n\n从质量守恒和上述输运与化学算子的定义出发，推导 $c_{\\mathrm{TC}}(x)$ 和 $c_{\\mathrm{CT}}(x)$ 的表达式，然后构建一个算法，通过用 $N_x$ 个均匀间隔的网格点离散化域、在这些点上计算 $c_0(x)$ 和 $k(x)$、通过 $u\\Delta t$ 进行周期性环绕位移、应用适当的指数因子，并用离散平均近似 RMS 积分来数值计算 $E$。\n\n您的程序必须实现此算法，并为以下每个测试用例计算 $E$。请完全按照规定使用指定的物理单位，并以 mol m$^{-3}$ 为单位生成结果。\n\n- 测试用例 1（相对于平流是刚性的，正速度）：\n  - $L = 1.0\\times 10^{5}$ m, $u = 10$ m s$^{-1}$, $\\Delta t = 600$ s, $k_0 = 1.0\\times 10^{-3}$ s$^{-1}$, $k_1 = 5.0\\times 10^{-4}$ s$^{-1}$, $c_b = 2.0\\times 10^{-6}$ mol m$^{-3}$, $A = 1.0\\times 10^{-6}$ mol m$^{-3}$, $N_x = 4096$。\n- 测试用例 2（强刚性，正速度，更长的时间步）：\n  - $L = 1.0\\times 10^{5}$ m, $u = 10$ m s$^{-1}$, $\\Delta t = 1800$ s, $k_0 = 1.0\\times 10^{-2}$ s$^{-1}$, $k_1 = 5.0\\times 10^{-3}$ s$^{-1}$, $c_b = 2.0\\times 10^{-6}$ mol m$^{-3}$, $A = 1.0\\times 10^{-6}$ mol m$^{-3}$, $N_x = 4096$。\n- 测试用例 3（非刚性，恒定化学速率作为交换性检验）：\n  - $L = 1.0\\times 10^{5}$ m, $u = 10$ m s$^{-1}$, $\\Delta t = 600$ s, $k_0 = 1.0\\times 10^{-4}$ s$^{-1}$, $k_1 = 0$ s$^{-1}$, $c_b = 2.0\\times 10^{-6}$ mol m$^{-3}$, $A = 1.0\\times 10^{-6}$ mol m$^{-3}$, $N_x = 4096$。\n- 测试用例 4（无输运作为交换性检验）：\n  - $L = 1.0\\times 10^{5}$ m, $u = 0$ m s$^{-1}$, $\\Delta t = 600$ s, $k_0 = 1.0\\times 10^{-3}$ s$^{-1}$, $k_1 = 5.0\\times 10^{-4}$ s$^{-1}$, $c_b = 2.0\\times 10^{-6}$ mol m$^{-3}$, $A = 1.0\\times 10^{-6}$ mol m$^{-3}$, $N_x = 4096$。\n- 测试用例 5（刚性，负速度以测试周期性环绕对称性）：\n  - $L = 1.0\\times 10^{5}$ m, $u = -10$ m s$^{-1}$, $\\Delta t = 600$ s, $k_0 = 1.0\\times 10^{-3}$ s$^{-1}$, $k_1 = 5.0\\times 10^{-4}$ s$^{-1}$, $c_b = 2.0\\times 10^{-6}$ mol m$^{-3}$, $A = 1.0\\times 10^{-6}$ mol m$^{-3}$, $N_x = 4096$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，“[result1,result2,...]”），其中每个条目是相应测试用例的 RMS 差 $E$，以 mol m$^{-3}$ 为单位，表示为十进制浮点数。",
            "solution": "用户提供的问题已经过分析，被认为是有效的。它在科学上植根于大气化学数值方法领域，问题设定良好，提供了所有必要的参数和定义，并以客观、正式的语言表述。该问题要求推导两种算子分裂方案，并为一组测试用例数值计算它们之间的均方根 (RMS) 差。\n\n### 控制方程与算子分裂\n\n该问题由周期域 $x \\in [0,L)$ 上的一维反应输运方程描述：\n$$\n\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = -k(x)\\, c\n$$\n这个偏微分方程 (PDE) 可以在概念上分裂为两个更简单的方程，一个用于纯输运（平流），一个用于纯化学反应。\n输运算子 $\\mathcal{T}$ 根据纯平流方程演化浓度场：\n$$\n\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = 0\n$$\n对于恒定速度 $u$，此方程在一个时间步长 $\\Delta t$ 内的解是一个简单的空间位移。使用特征线法，我们发现浓度沿着 $dx/dt = u$ 的线是恒定的。积分得到 $x(t) = x_0 + ut$，其中 $x_0$ 是 $t=0$ 时的位置。因此，位置 $x$ 和时间 $t$ 处的浓度是位置 $x-ut$ 处的初始浓度。因此，作用于函数 $f(x)$ 的时间步长 $\\Delta t$ 上的输运算子为：\n$$\n\\mathcal{T}(\\Delta t)f(x) = f(x - u\\Delta t)\n$$\n\n化学算子 $\\mathcal{C}$ 根据纯反应方程演化浓度场：\n$$\n\\frac{\\partial c}{\\partial t} = -k(x)\\, c\n$$\n对于一个固定的位置 $x$，这是一个关于时间的常微分方程 (ODE)。从 $t$ 到 $t+\\Delta t$ 积分得到：\n$$\n\\int_{c(t)}^{c(t+\\Delta t)} \\frac{dc}{c} = \\int_t^{t+\\Delta t} -k(x) dt' \\implies \\ln\\left(\\frac{c(t+\\Delta t)}{c(t)}\\right) = -k(x)\\Delta t\n$$\n解为 $c(t+\\Delta t) = c(t) \\exp(-k(x)\\Delta t)$。作用于函数 $f(x)$ 的时间步长 $\\Delta t$ 上的化学算子为：\n$$\n\\mathcal{C}(\\Delta t)f(x) = f(x) \\exp(-k(x)\\Delta t)\n$$\n\n### 输运-化学 (TC) 和化学-输运 (CT) 方案的推导\n\n这两种一阶算子分裂方案由算子应用于初始浓度场 $c_0(x)$ 的顺序定义。\n\n**输运-化学 (TC)：**\n首先，将输运算子 $\\mathcal{T}(\\Delta t)$ 应用于初始场 $c_0(x)$ 以获得中间场 $c'(x)$。其次，将化学算子 $\\mathcal{C}(\\Delta t)$ 应用于 $c'(x)$。\n$$\nc'(x) = \\mathcal{T}(\\Delta t) c_0(x) = c_0(x - u\\Delta t)\n$$\n$$\nc_{\\mathrm{TC}}(x) = \\mathcal{C}(\\Delta t) c'(x) = c'(x) \\exp(-k(x)\\Delta t) = c_0(x - u\\Delta t) \\exp(-k(x)\\Delta t)\n$$\n这证实了问题陈述中提供的 $c_{\\mathrm{TC}}(x)$ 的表达式。\n\n**化学-输运 (CT)：**\n首先，将化学算子 $\\mathcal{C}(\\Delta t)$ 应用于初始场 $c_0(x)$ 以获得中间场 $c''(x)$。其次，将输运算子 $\\mathcal{T}(\\Delta t)$ 应用于 $c''(x)$。\n$$\nc''(x) = \\mathcal{C}(\\Delta t) c_0(x) = c_0(x) \\exp(-k(x)\\Delta t)\n$$\n$$\nc_{\\mathrm{CT}}(x) = \\mathcal{T}(\\Delta t) c''(x) = c''(x-u\\Delta t) = c_0(x - u\\Delta t) \\exp(-k(x-u\\Delta t)\\Delta t)\n$$\n这证实了问题陈述中提供的 $c_{\\mathrm{CT}}(x)$ 的表达式。\n\n### 分裂误差与 RMS 差\n\n这两种方案之间的差异，即分裂误差，是因为输运和化学算子通常不可交换。也就是说，$\\mathcal{C}(\\Delta t)\\mathcal{T}(\\Delta t) \\neq \\mathcal{T}(\\Delta t)\\mathcal{C}(\\Delta t)$。差异为：\n$$\nc_{\\mathrm{TC}}(x) - c_{\\mathrm{CT}}(x) = c_0(x - u\\Delta t) \\left[ \\exp(-k(x)\\Delta t) - \\exp(-k(x-u\\Delta t)\\Delta t) \\right]\n$$\n这个差异非零，当且仅当 $c_0(x-u\\Delta t) \\neq 0$ 和 $k(x) \\neq k(x-u\\Delta t)$。后一个条件意味着，如果输运速度 $u=0$（测试用例 4）或反应速率 $k(x)$ 是常数（即 $k_1=0$，测试用例 3），则误差为零。\n\n均方根 (RMS) 差 $E$ 定义为：\n$$\nE = \\sqrt{\\frac{1}{L}\\int_0^L \\left(c_{\\mathrm{TC}}(x) - c_{\\mathrm{CT}}(x)\\right)^2\\, dx}\n$$\n\n### 数值算法\n\n为了数值计算 $E$，我们离散化空间域并近似积分。\n\n1.  **离散化域：** 将域 $[0,L)$ 离散化为 $N_x$ 个均匀间隔的网格点 $x_j = j \\cdot \\Delta x$，其中 $j = 0, 1, \\dots, N_x-1$，网格间距为 $\\Delta x = L/N_x$。\n\n2.  **在网格点上计算场：**\n    初始浓度 $c_0(x)$ 和损失率 $k(x)$ 由以下公式定义：\n    $$\n    k(x) = k_0 + k_1 \\sin\\left(\\frac{2\\pi x}{L}\\right)\n    $$\n    $$\n    c_0(x) = c_b + A \\sin\\left(\\frac{4\\pi x}{L}\\right) + \\frac{A}{2} \\cos\\left(\\frac{6\\pi x}{L}\\right)\n    $$\n    我们需要在原始网格点 $x_j$ 和平流位移后的网格点 $x'_j = (x_j - u\\Delta t) \\pmod L$ 上计算这些函数的值。我们创建表示在这些点上的场的离散数组：\n    - $\\mathbf{x}$：网格点 $x_j$ 的数组。\n    - $\\mathbf{x}_{\\text{shifted}}$：位移后的网格点 $(x_j - u\\Delta t) \\pmod L$ 的数组。\n    - $\\mathbf{k}$：在 $\\mathbf{x}$ 处计算的反应速率，即 $k(x_j)$。\n    - $\\mathbf{k}_{\\text{shifted}}$：在 $\\mathbf{x}_{\\text{shifted}}$ 处计算的反应速率。\n    - $\\mathbf{c}_{0, \\text{shifted}}$：在 $\\mathbf{x}_{\\text{shifted}}$ 处计算的初始浓度。\n\n3.  **计算离散解：** 使用上一步的数组，我们在每个网格点 $x_j$ 上计算 $c_{\\mathrm{TC}}$ 和 $c_{\\mathrm{CT}}$ 的离散版本。设 $\\odot$ 表示逐元素乘法。\n    $$\n    \\mathbf{c}_{\\mathrm{TC}} = \\exp(-\\mathbf{k} \\cdot \\Delta t) \\odot \\mathbf{c}_{0, \\text{shifted}}\n    $$\n    $$\n    \\mathbf{c}_{\\mathrm{CT}} = \\exp(-\\mathbf{k}_{\\text{shifted}} \\cdot \\Delta t) \\odot \\mathbf{c}_{0, \\text{shifted}}\n    $$\n    \n4.  **计算 RMS 差：** $E$ 定义中的积分通过离散网格点上的平均值来近似。$E^2$ 的表达式变为：\n    $$\n    E^2 = \\frac{1}{L}\\int_0^L \\left(c_{\\mathrm{TC}}(x) - c_{\\mathrm{CT}}(x)\\right)^2\\, dx \\approx \\frac{1}{L} \\sum_{j=0}^{N_x-1} \\left(c_{\\mathrm{TC}}(x_j) - c_{\\mathrm{CT}}(x_j)\\right)^2 \\Delta x\n    $$\n    代入 $\\Delta x = L/N_x$，我们得到：\n    $$\n    E^2 \\approx \\frac{1}{L} \\frac{L}{N_x} \\sum_{j=0}^{N_x-1} \\left(c_{\\mathrm{TC},j} - c_{\\mathrm{CT},j}\\right)^2 = \\frac{1}{N_x} \\sum_{j=0}^{N_x-1} \\left(c_{\\mathrm{TC},j} - c_{\\mathrm{CT},j}\\right)^2\n    $$\n    这是均方误差的定义。因此，RMS 差 $E$ 是两个解数组之间差的平方的平均值的平方根：\n    $$\n    E = \\sqrt{\\frac{1}{N_x} \\sum_{j=0}^{N_x-1} \\left(\\mathbf{c}_{\\mathrm{TC}} - \\mathbf{c}_{\\mathrm{CT}}\\right)_j^2} = \\text{RMS}(\\mathbf{c}_{\\mathrm{TC}} - \\mathbf{c}_{\\mathrm{CT}})\n    $$\n    该算法将为每个测试用例实现，以计算所需的 $E$ 值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the RMS difference between Transport-then-Chemistry (TC) and\n    Chemistry-then-Transport (CT) operator splitting schemes for a 1D\n    advection-reaction problem.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (L, u, dt, k0, k1, cb, A, Nx)\n        # Test Case 1: stiff, positive velocity\n        (1.0e5, 10.0, 600.0, 1.0e-3, 5.0e-4, 2.0e-6, 1.0e-6, 4096),\n        # Test Case 2: strongly stiff, positive velocity, longer step\n        (1.0e5, 10.0, 1800.0, 1.0e-2, 5.0e-3, 2.0e-6, 1.0e-6, 4096),\n        # Test Case 3: non-stiff, constant chemistry (commutation check)\n        (1.0e5, 10.0, 600.0, 1.0e-4, 0.0, 2.0e-6, 1.0e-6, 4096),\n        # Test Case 4: no transport (commutation check)\n        (1.0e5, 0.0, 600.0, 1.0e-3, 5.0e-4, 2.0e-6, 1.0e-6, 4096),\n        # Test Case 5: stiff, negative velocity\n        (1.0e5, -10.0, 600.0, 1.0e-3, 5.0e-4, 2.0e-6, 1.0e-6, 4096),\n    ]\n\n    results = []\n    for case in test_cases:\n        L, u, dt, k0, k1, cb, A, Nx = case\n\n        # 1. Discretize the domain [0, L)\n        # endpoint=False is crucial for a periodic domain to avoid duplicating x=0 and x=L\n        x = np.linspace(0, L, Nx, endpoint=False)\n\n        # 2. Define analytical functions for k(x) and c0(x)\n        def k_func(pos, L_val, k0_val, k1_val):\n            return k0_val + k1_val * np.sin(2 * np.pi * pos / L_val)\n        \n        def c0_func(pos, L_val, cb_val, A_val):\n            return (cb_val + \n                    A_val * np.sin(4 * np.pi * pos / L_val) + \n                    (A_val / 2) * np.cos(6 * np.pi * pos / L_val))\n\n        # 3. Evaluate fields at original and shifted grid points\n        # Calculate shifted coordinates with periodic wrap-around\n        x_shifted = (x - u * dt) % L\n        \n        # Evaluate k(x) on the original grid\n        k_x = k_func(x, L, k0, k1)\n        \n        # Evaluate k(x) on the shifted grid for the CT scheme\n        k_x_shifted = k_func(x_shifted, L, k0, k1)\n\n        # Evaluate c0(x) on the shifted grid for both schemes\n        c0_x_shifted = c0_func(x_shifted, L, cb, A)\n\n        # 4. Compute the discrete solutions for TC and CT\n        \n        # Transport-then-Chemistry (TC)\n        # c_tc(x) = exp(-k(x) * dt) * c0(x - u*dt)\n        c_tc = np.exp(-k_x * dt) * c0_x_shifted\n\n        # Chemistry-then-Transport (CT)\n        # c_ct(x) = exp(-k(x - u*dt) * dt) * c0(x - u*dt)\n        c_ct = np.exp(-k_x_shifted * dt) * c0_x_shifted\n        \n        # 5. Compute the RMS difference\n        # The integral approximation simplifies to the standard discrete RMS\n        # E = sqrt(mean((c_tc - c_ct)^2))\n        diff_sq = (c_tc - c_ct)**2\n        rms_error = np.sqrt(np.mean(diff_sq))\n        \n        results.append(rms_error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在运行化学-输送模型时，保证数值稳定性是首要任务。对于显式时间积分方案，最大允许时间步长 ($\\Delta t_{\\max}$) 受到模型中最快物理和化学过程的严格限制。本练习  将平流、扩散和化学反应的稳定性要求结合起来，要求您计算出一个综合性的最大稳定时间步长。通过这个实践，您将掌握在真实模型配置中平衡计算效率与数值稳定性的核心技能。",
            "id": "3863647",
            "problem": "在一个三维大气化学输运模型中，一个守恒化学示踪剂的浓度场 $C(\\mathbf{x},t)$ 在平流、扩散和气相化学的共同作用下演变。其控制性守恒定律为\n$$\n\\frac{\\partial C}{\\partial t} + \\nabla \\cdot \\left( \\mathbf{u}\\, C \\right) \\;=\\; \\nabla \\cdot \\left( \\mathbf{K}\\, \\nabla C \\right) \\;+\\; R(C),\n$$\n其中 $\\mathbf{u} = (u,v,w)$ 是风速，$\\mathbf{K} = \\mathrm{diag}(K_{x},K_{y},K_{z})$ 是涡动扩散张量，而 $R(C)$ 代表净化学趋势项。考虑一个显式时间步进格式，该格式对平流使用通量形式的有限体积、非分裂的供体单元（迎风）离散化，对沿每个坐标轴独立进行的扩散使用显式二阶中心差分离散化，并对气相化学使用带有显式前向欧拉步的算子分裂方法。\n\n计算网格是笛卡尔均匀网格，间距为 $\\Delta x$、$\\Delta y$ 和 $\\Delta z$。该区域的高度范围为 $z \\in [0,\\, 5\\,\\mathrm{km}]$，风场和扩散场随高度的变化如下：\n- $u(z) = 12 + 6\\,\\frac{z}{5\\,\\mathrm{km}}$ $\\mathrm{m}\\,\\mathrm{s}^{-1}$,\n- $v(z) = 8 + 4\\,\\frac{z}{5\\,\\mathrm{km}}$ $\\mathrm{m}\\,\\mathrm{s}^{-1}$,\n- $w(z) = 0.6$ $\\mathrm{m}\\,\\mathrm{s}^{-1}$,\n- $K_{x}(z) = 50 + 60\\,\\frac{z}{5\\,\\mathrm{km}}$ $\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$,\n- $K_{y}(z) = 40 + 40\\,\\frac{z}{5\\,\\mathrm{km}}$ $\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$,\n- $K_{z}(z) = 0.3 + 0.4\\,\\frac{z}{5\\,\\mathrm{km}}$ $\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$.\n\n均匀网格间距为\n- $\\Delta x = 12\\,\\mathrm{km}$,\n- $\\Delta y = 8\\,\\mathrm{km}$,\n- $\\Delta z = 200\\,\\mathrm{m}$.\n\n在算子分裂的气相求解器中，化学机制的最刚性一阶速率由最大特征值模 $k_{\\max} = 0.004$ $\\mathrm{s}^{-1}$ 表征。\n\n从守恒定律和给定的数值格式出发，使用适用于显式方法的稳定性和正定性论证，以闭合形式确定最大允许全局时间步长 $\\Delta t_{\\max}$，该步长在区域内的任何地方都同时满足以下要求：\n- 针对非分裂迎风平流离散化的多维库朗型约束，\n- 沿每个坐标方向的显式中心差分扩散稳定性约束，\n- 与 $k_{\\max}$ 相关的显式前向欧拉化学稳定性界限。\n\n使用给定的场和网格间距计算得到的 $\\Delta t_{\\max}$。以秒为单位表示您的最终时间步长，并将答案四舍五入到四位有效数字。",
            "solution": "首先验证问题，以确保其具有科学依据、是适定的，并且提供了所有必要信息。\n\n**第一步：提取已知条件**\n- 控制性偏微分方程：$\\frac{\\partial C}{\\partial t} + \\nabla \\cdot \\left( \\mathbf{u}\\, C \\right) = \\nabla \\cdot \\left( \\mathbf{K}\\, \\nabla C \\right) + R(C)$\n- 风速矢量：$\\mathbf{u} = (u,v,w)$\n- 涡动扩散张量：$\\mathbf{K} = \\mathrm{diag}(K_{x},K_{y},K_{z})$\n- 化学趋势项：$R(C)$\n- 数值格式细节：\n  - 时间积分：显式，算子分裂\n  - 平流：通量形式的有限体积、非分裂的供体单元（迎风）\n  - 扩散：显式二阶中心差分\n  - 化学：显式前向欧拉\n- 网格：笛卡尔均匀网格，间距为 $\\Delta x = 12\\,\\mathrm{km}$、$\\Delta y = 8\\,\\mathrm{km}$、$\\Delta z = 200\\,\\mathrm{m}$。\n- 区域高度范围：$z \\in [0,\\, 5\\,\\mathrm{km}]$\n- 随高度变化的风场：\n  - $u(z) = 12 + 6\\,\\frac{z}{5\\,\\mathrm{km}}$ $\\mathrm{m}\\,\\mathrm{s}^{-1}$\n  - $v(z) = 8 + 4\\,\\frac{z}{5\\,\\mathrm{km}}$ $\\mathrm{m}\\,\\mathrm{s}^{-1}$\n  - $w(z) = 0.6$ $\\mathrm{m}\\,\\mathrm{s}^{-1}$\n- 随高度变化的扩散场：\n  - $K_{x}(z) = 50 + 60\\,\\frac{z}{5\\,\\mathrm{km}}$ $\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$\n  - $K_{y}(z) = 40 + 40\\,\\frac{z}{5\\,\\mathrm{km}}$ $\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$\n  - $K_{z}(z) = 0.3 + 0.4\\,\\frac{z}{5\\,\\mathrm{km}}$ $\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$\n- 最刚性化学速率：最大特征值模 $k_{\\max} = 0.004$ $\\mathrm{s}^{-1}$。\n- 目标：找到满足平流、扩散和化学的稳定性和正定性约束的最大允许全局时间步长 $\\Delta t_{\\max}$，并计算其值，四舍五入到四位有效数字。\n\n**第二步：使用提取的已知条件进行验证**\n该问题具有科学依据，描述了大气化学输运模型的标准数值实现。控制方程是标准的平流-扩散-反应方程。所提及的数值方法在该领域是常见的。参数值对于一个中尺度模型而言在物理上是合理的。该问题是适定的，因为它要求根据已建立的原则推导出一个特定的数值稳定性约束。问题是完整、客观的，并且不包含矛盾。\n\n**第三步：结论与行动**\n问题有效。将提供完整解答。\n\n**解答推导**\n对于一个显式、算子分裂的格式，其总体最大允许时间步长 $\\Delta t_{\\max}$ 受所有独立过程（平流、扩散和化学）中最严格的时间步长限制的约束。\n$$\n\\Delta t_{\\max} = \\min(\\Delta t_{\\text{adv}}, \\Delta t_{\\text{diff}}, \\Delta t_{\\text{chem}})\n$$\n我们分别推导每个过程的限制。\n\n**1. 平流稳定性约束 (Courant-Friedrichs-Lewy, CFL)**\n对于三维空间中的显式、非分裂、一阶迎风（供体单元）有限体积格式，其稳定性条件由下式给出：\n$$\n\\Delta t_{\\text{adv}} \\leq \\left( \\frac{|u|}{\\Delta x} + \\frac{|v|}{\\Delta y} + \\frac{|w|}{\\Delta z} \\right)^{-1}\n$$\n此约束必须在区域内的任何地方都得到满足。因此，我们必须使用速度分量的最大可能值来找到最严格的时间步长。风分量 $u(z)$ 和 $v(z)$ 是高度 $z$ 的线性增函数，而 $w(z)$ 是常数。因此，最大值出现在区域顶部，$z = 5\\,\\mathrm{km}$。\n\n首先，将所有网格间距转换为米：\n- $\\Delta x = 12\\,\\mathrm{km} = 12000\\,\\mathrm{m}$\n- $\\Delta y = 8\\,\\mathrm{km} = 8000\\,\\mathrm{m}$\n- $\\Delta z = 200\\,\\mathrm{m}$\n\n接下来，计算在 $z=5\\,\\mathrm{km} = 5000\\,\\mathrm{m}$ 处的最大速度：\n- $u_{\\max} = u(5000\\,\\mathrm{m}) = 12 + 6\\left(\\frac{5000}{5000}\\right) = 18\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$\n- $v_{\\max} = v(5000\\,\\mathrm{m}) = 8 + 4\\left(\\frac{5000}{5000}\\right) = 12\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$\n- $w_{\\max} = w = 0.6\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$ （常数）\n\n库朗数之和为：\n$$\n\\frac{|u_{\\max}|}{\\Delta x} + \\frac{|v_{\\max}|}{\\Delta y} + \\frac{|w_{\\max}|}{\\Delta z} = \\frac{18}{12000} + \\frac{12}{8000} + \\frac{0.6}{200}\n$$\n$$\n= 0.0015\\,\\mathrm{s}^{-1} + 0.0015\\,\\mathrm{s}^{-1} + 0.003\\,\\mathrm{s}^{-1} = 0.006\\,\\mathrm{s}^{-1}\n$$\n平流的最大时间步长是此和的倒数：\n$$\n\\Delta t_{\\text{adv}} = \\frac{1}{0.006\\,\\mathrm{s}^{-1}} = \\frac{1000}{6}\\,\\mathrm{s} = \\frac{500}{3}\\,\\mathrm{s} \\approx 166.67\\,\\mathrm{s}\n$$\n\n**2. 扩散稳定性约束**\n对于带有对角扩散张量的三维扩散方程，采用显式、二阶中心差分格式，其稳定性约束为：\n$$\n\\Delta t_{\\text{diff}} \\leq \\frac{1}{2 \\left( \\frac{K_x}{(\\Delta x)^2} + \\frac{K_y}{(\\Delta y)^2} + \\frac{K_z}{(\\Delta z)^2} \\right)}\n$$\n与平流情况类似，此约束必须在任何地方都得到满足。扩散系数分量 $K_x(z)$、$K_y(z)$ 和 $K_z(z)$ 都是高度 $z$ 的线性增函数。导致最严格约束的它们的最大值出现在 $z = 5\\,\\mathrm{km}$。\n\n计算在 $z=5000\\,\\mathrm{m}$ 处的最大扩散系数：\n- $K_{x,\\max} = K_x(5000\\,\\mathrm{m}) = 50 + 60\\left(\\frac{5000}{5000}\\right) = 110\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$\n- $K_{y,\\max} = K_y(5000\\,\\mathrm{m}) = 40 + 40\\left(\\frac{5000}{5000}\\right) = 80\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$\n- $K_{z,\\max} = K_z(5000\\,\\mathrm{m}) = 0.3 + 0.4\\left(\\frac{5000}{5000}\\right) = 0.7\\,\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$\n\n扩散项之和为：\n$$\n\\frac{K_{x,\\max}}{(\\Delta x)^2} + \\frac{K_{y,\\max}}{(\\Delta y)^2} + \\frac{K_{z,\\max}}{(\\Delta z)^2} = \\frac{110}{(12000)^2} + \\frac{80}{(8000)^2} + \\frac{0.7}{(200)^2}\n$$\n$$\n= \\frac{110}{144 \\times 10^6} + \\frac{80}{64 \\times 10^6} + \\frac{0.7}{4 \\times 10^4}\n$$\n$$\n\\approx 7.639 \\times 10^{-7} + 1.25 \\times 10^{-6} + 1.75 \\times 10^{-5} \\approx 1.9514 \\times 10^{-5}\\,\\mathrm{s}^{-1}\n$$\n扩散的最大时间步长为：\n$$\n\\Delta t_{\\text{diff}} = \\frac{1}{2 \\times (1.9514 \\times 10^{-5}\\,\\mathrm{s}^{-1})} \\approx \\frac{1}{3.9028 \\times 10^{-5}\\,\\mathrm{s}^{-1}} \\approx 25623\\,\\mathrm{s}\n$$\n\n**3. 化学稳定性和正定性约束**\n对于使用显式前向欧拉格式的算子分裂化学步骤，我们考虑一个代表性的一阶损耗过程 $\\frac{dC}{dt} = -kC$。其前向欧拉更新为 $C^{n+1} = C^n - \\Delta t \\cdot k C^n = (1 - k\\Delta t)C^n$。\n问题要求同时满足稳定性和正定性。\n- 纯数值稳定性要求放大因子 $|1 - k\\Delta t|$ 小于或等于 $1$。这导致 $-1 \\leq 1-k\\Delta t \\leq 1$，意味着 $\\Delta t \\leq \\frac{2}{k}$。\n- 正定性要求如果 $C^n \\geq 0$，则 $C^{n+1} \\geq 0$。这意味着 $1 - k\\Delta t \\geq 0$，从而导出更严格的条件 $\\Delta t \\leq \\frac{1}{k}$。\n\n我们必须应用更严格的条件，即正定性约束。此约束必须对由最大特征值模 $k_{\\max}$ 表征的最刚性（最快）反应成立。\n$$\n\\Delta t_{\\text{chem}} \\leq \\frac{1}{k_{\\max}}\n$$\n给定 $k_{\\max} = 0.004\\,\\mathrm{s}^{-1}$：\n$$\n\\Delta t_{\\text{chem}} = \\frac{1}{0.004\\,\\mathrm{s}^{-1}} = 250\\,\\mathrm{s}\n$$\n\n**总体最大时间步长**\n全局最大时间步长 $\\Delta t_{\\max}$ 是各个时间步长限制中的最小值：\n$$\n\\Delta t_{\\max} = \\min(\\Delta t_{\\text{adv}}, \\Delta t_{\\text{diff}}, \\Delta t_{\\text{chem}})\n$$\n$$\n\\Delta t_{\\max} = \\min\\left(\\frac{500}{3}\\,\\mathrm{s}, 25623\\,\\mathrm{s}, 250\\,\\mathrm{s}\\right)\n$$\n$$\n\\Delta t_{\\max} = \\min(166.666...\\,\\mathrm{s}, 25623\\,\\mathrm{s}, 250\\,\\mathrm{s}) = 166.666...\\,\\mathrm{s}\n$$\n最严格的约束是由平流格式（CFL 条件）施加的。\n\n将结果四舍五入到四位有效数字，得到 $166.7\\,\\mathrm{s}$。",
            "answer": "$$\n\\boxed{166.7}\n$$"
        }
    ]
}