{
    "hands_on_practices": [
        {
            "introduction": "在高纬度地区，水平气压梯度力可能变得非常微弱，使得科里奥利力在动力平衡中占据主导地位。在这种理想化的无摩擦、无外力情景下，气块会展现出一种称为“惯性振荡”的纯粹由地球自转效应驱动的圆周运动。这项实践将引导你从旋转坐标系下的基本动量方程出发，推导出惯性振荡的周期，并计算其在极区的值，从而深刻理解为何这个基本动力学时间尺度对极地数值天气预报模型的稳定性和准确性构成了独特的挑战 。",
            "id": "4021925",
            "problem": "在高纬度地区的数值天气预报（NWP）和气候模型中，一个具有挑战性的重要动力学时间尺度是旋转作用下水平运动的惯性周期。考虑一个位于地球局部切平面（f-平面近似）上纬度为 $\\phi$ 的水平均匀干空气块，其水平气压梯度可忽略不计，摩擦力可忽略不计，并且除了旋转参考系公式中隐含的力之外，没有其他外力。从应用于旋转参考系的牛顿第二定律出发，推导由此产生的水平惯性振荡周期（用科里奥利参数表示）。然后，使用地球自转角速度 $\\Omega = 7.292 \\times 10^{-5}\\,\\mathrm{s^{-1}}$，计算在纬度 $\\phi = 80^{\\circ}$ 处的该周期。\n\n要求：\n- 从旋转参考系下的动量方程开始，并明确陈述所有假设。\n- 将惯性振荡周期推导为以科里奥利参数 $f$ 和纬度 $\\phi$ 表示的解析表达式，不得引用任何预先推导出的惯性周期公式。\n- 角度以度为单位处理；相应地写作 $\\sin(80^{\\circ})$。\n- 以小时为单位计算最终周期，并将最终数值答案四舍五入至四位有效数字。\n- 以小时为单位表示最终周期作为答案。",
            "solution": "该问题陈述经评估具有科学依据、提法恰当且客观。它基于地球物理流体动力学的基本原理，包含了所有必要信息，并且没有歧义或矛盾。该问题有效，将提供解答。\n\n我们从旋转地球参考系中流体质点的牛顿第二定律开始。动量方程为：\n$$\n\\frac{d\\vec{v}}{dt} + 2\\vec{\\Omega} \\times \\vec{v} = -\\frac{1}{\\rho}\\nabla p - \\vec{g}_{eff} + \\vec{F}_r\n$$\n在这里，$\\vec{v}$ 是空气块相对于旋转地球的速度，$\\vec{\\Omega}$ 是地球的角速度矢量，$\\rho$ 是空气密度，$p$ 是气压，$\\vec{g}_{eff}$ 是有效重力（真实重力加上尚未被吸收到旋转参考系定义中的离心力分量），而 $\\vec{F}_r$ 代表摩擦力。\n\n我们应用问题陈述中指定的条件：\n1.  我们考虑一个局部切平面，称为 f-平面。我们使用一个笛卡尔坐标系，其中 $x$ 指向东方（纬向），$y$ 指向北方（经向），$z$ 指向垂直向上。速度分量为 $\\vec{v} = (u, v, w)$。\n2.  在纬度 $\\phi$ 处，地球的角速度矢量为 $\\vec{\\Omega} = (0, \\Omega\\cos\\phi, \\Omega\\sin\\phi)$。\n3.  科里奥利加速度项是 $2\\vec{\\Omega} \\times \\vec{v}$。对于大尺度大气运动，水平速度（$u, v$）远大于垂直速度（$w$），因此我们可以在科里奥利项中近似认为 $w \\approx 0$。这是地球物理流体动力学中传统近似的一个标准部分。\n    $$\n    2\\vec{\\Omega} \\times \\vec{v} = 2 \\begin{vmatrix} \\hat{i}  \\hat{j}  \\hat{k} \\\\ 0  \\Omega\\cos\\phi  \\Omega\\sin\\phi \\\\ u  v  0 \\end{vmatrix} = 2(-v\\Omega\\sin\\phi)\\hat{i} + 2(u\\Omega\\sin\\phi)\\hat{j} - 2(u\\Omega\\cos\\phi)\\hat{k}\n    $$\n4.  我们将科里奥利参数定义为 $f = 2\\Omega\\sin\\phi$。科里奥利加速度的水平分量是 $(-fv, fu)$。\n5.  水平气压梯度可忽略不计：$\\frac{\\partial p}{\\partial x} = 0$ 和 $\\frac{\\partial p}{\\partial y} = 0$。\n6.  摩擦力可忽略不计：$\\vec{F}_r = 0$。\n\n在这些假设下，我们研究的是纯惯性运动，其中气块的加速度仅由科里奥利力平衡。动量方程的水平分量变为：\n$$\n\\frac{du}{dt} = f v\n$$\n$$\n\\frac{dv}{dt} = -f u\n$$\n这是一个一阶线性常微分方程组。为了求解它，我们可以将第一个方程对时间 $t$ 求导：\n$$\n\\frac{d^2u}{dt^2} = f \\frac{dv}{dt}\n$$\n现在，从第二个方程中代入 $\\frac{dv}{dt}$ 的表达式：\n$$\n\\frac{d^2u}{dt^2} = f (-f u) = -f^2 u\n$$\n这得到了一个关于纬向速度分量 $u$ 的单一二阶齐次微分方程：\n$$\n\\frac{d^2u}{dt^2} + f^2 u = 0\n$$\n这是简谐振子的方程。$u(t)$ 的通解是\n$$\nu(t) = C_1 \\cos(ft) + C_2 \\sin(ft)\n$$\n其中 $C_1$ 和 $C_2$ 是由初始条件决定的常数。$v(t)$ 的解可以从方程 $\\frac{du}{dt} = fv$ 中找到，这给出 $v = \\frac{1}{f}\\frac{du}{dt}$：\n$$\nv(t) = \\frac{1}{f} \\frac{d}{dt} \\left( C_1 \\cos(ft) + C_2 \\sin(ft) \\right) = \\frac{1}{f} \\left( -C_1 f \\sin(ft) + C_2 f \\cos(ft) \\right)\n$$\n$$\nv(t) = -C_1 \\sin(ft) + C_2 \\cos(ft)\n$$\n速度分量 $u(t)$ 和 $v(t)$ 以角频率 $\\omega_i = |f|$ 振荡。振荡周期 $T_i$ 与其角频率的关系为 $T_i = \\frac{2\\pi}{\\omega_i}$。因此，惯性振荡的周期是：\n$$\nT_i = \\frac{2\\pi}{|f|}\n$$\n代入科里奥利参数的定义 $f = 2\\Omega\\sin\\phi$，我们得到惯性周期的解析表达式：\n$$\nT_i = \\frac{2\\pi}{|2\\Omega\\sin\\phi|} = \\frac{\\pi}{\\Omega|\\sin\\phi|}\n$$\n周期总是正的，因此使用绝对值。对于给定的纬度 $\\phi = 80^{\\circ}$（在北半球），$\\sin\\phi  0$，所以我们可以去掉绝对值符号。\n\n现在，我们对这个周期进行数值计算。给定：\n地球自转角速度 $\\Omega = 7.292 \\times 10^{-5}\\,\\mathrm{s^{-1}}$\n纬度 $\\phi = 80^{\\circ}$\n\n首先，我们以秒为单位计算周期：\n$$\nT_i = \\frac{\\pi}{(7.292 \\times 10^{-5}\\,\\mathrm{s^{-1}}) \\times \\sin(80^{\\circ})}\n$$\n使用 $\\sin(80^{\\circ}) \\approx 0.98480775$：\n$$\nT_i \\approx \\frac{\\pi}{(7.292 \\times 10^{-5}\\,\\mathrm{s^{-1}}) \\times 0.98480775} \\approx \\frac{\\pi}{7.182503 \\times 10^{-5}\\,\\mathrm{s^{-1}}}\\,\\mathrm{s} \\approx 43748.69\\,\\mathrm{s}\n$$\n问题要求最终答案以小时为单位。要将秒转换为小时，我们除以 $3600$：\n$$\nT_i (\\text{小时}) = \\frac{T_i (\\text{秒})}{3600} = \\frac{43748.69}{3600} \\approx 12.15241\\,\\text{小时}\n$$\n将结果四舍五入至四位有效数字，我们得到 $12.15$。第五位有效数字是 $2$，因此我们不对第四位数字进行进位。",
            "answer": "$$\n\\boxed{12.15}\n$$"
        },
        {
            "introduction": "极夜期间，地表强烈的辐射冷却常常导致近地表大气形成强稳定边界层，这极大地抑制了垂直混合并对地-气交换的模拟构成了严峻挑战。莫宁-奥布霍夫相似性理论提供了一个关键的理论框架，其中的核心参数——莫宁-奥布霍夫长度（$L$）——量化了机械切变产生的湍流与浮力抑制作用之间的相对重要性。本练习将利用一个极地通量塔的假设测量数据，让你亲手计算$L$值，并解读其物理意义，从而判断在给定的稳定条件下湍流的特征 。",
            "id": "4021991",
            "problem": "在一个北极通量塔观测到一次极夜期间的地面逆温。在近地表常通量层内，测量得到摩擦速度 $u_*$、虚位温的运动学湍流通量 $\\overline{w'\\theta_v'}$ 和平均虚位温 $\\theta_v$。请使用莫宁-奥布霍夫相似性理论（MOST）的框架，确定一个控制近地层湍流的切变生成与浮力破坏之间相对重要性的特征稳定度长度尺度。假设重力加速度 $g=9.81\\,\\mathrm{m\\,s^{-2}}$ 且冯·卡门常数 $\\kappa=0.40$。测量值如下：$u_*=0.2\\,\\mathrm{m\\,s^{-1}}$、$\\overline{w'\\theta_v'}=-0.01\\,\\mathrm{K\\,m\\,s^{-1}}$ 以及 $\\theta_v=260\\,\\mathrm{K}$。\n\n请计算这些测量值所对应的莫宁-奥布霍夫长度 $L$。将您的答案四舍五入到三位有效数字，并以米为单位。然后，根据极夜条件下 $L$ 的符号和大小，用文字解释近地层湍流是弱的、间歇性的还是强烈的，并说明原因。最终答案仅报告 $L$ 的数值。",
            "solution": "莫宁-奥布霍夫相似性理论（MOST）指出，在大气近地层中，湍流的统计特征和平均梯度由一个特征长度尺度控制，该尺度由机械切变和浮力效应之间的竞争决定。代表浮力效应的相关通量是地表浮力通量 $B_0$，它由虚位温的运动学湍流通量定义为\n$$\nB_0 \\equiv \\frac{g}{\\theta_v}\\,\\overline{w'\\theta_v'}.\n$$\n在静力稳定层结中，$\\overline{w'\\theta_v'}  0$，因此 $B_0  0$。MOST引入莫宁-奥布霍夫长度 $L$ 作为唯一的长度尺度，它由湍流速度尺度 $u_*$、浮力通量 $B_0$ 和无量纲的冯·卡门常数 $\\kappa$ 构建，使得 $L$ 具有长度量纲，并在湍流能量收支中表征了切变生成与浮力破坏的比率。量纲分析和常规符号约定给出\n$$\nL \\equiv -\\frac{u_*^{3}}{\\kappa B_0}\n= -\\frac{u_*^{3}\\,\\theta_v}{\\kappa\\,g\\,\\overline{w'\\theta_v'}}.\n$$\n这种形式确保了在稳定条件下 $L0$，因为 $\\overline{w'\\theta_v'}0$，而负号使得结果为正。代入给定值，\n$$\nu_* = 0.2,\\quad \\theta_v = 260,\\quad \\overline{w'\\theta_v'} = -0.01,\\quad \\kappa = 0.40,\\quad g = 9.81,\n$$\n我们计算\n$$\nB_0 = \\frac{g}{\\theta_v}\\,\\overline{w'\\theta_v'} = \\frac{9.81}{260}\\times(-0.01)\\ \\mathrm{m\\,s^{-3}} = -3.7692\\times 10^{-4}\\ \\mathrm{m\\,s^{-3}},\n$$\n和\n$$\nu_*^{3} = (0.2)^{3} = 8.0\\times 10^{-3}\\ \\mathrm{m^{3}\\,s^{-3}}.\n$$\n因此，\n$$\nL = -\\frac{8.0\\times 10^{-3}}{0.40\\times(-3.7692\\times 10^{-4})}\\ \\mathrm{m}\n= \\frac{8.0\\times 10^{-3}}{1.50768\\times 10^{-4}}\\ \\mathrm{m}\n= 53.007\\ \\mathrm{m}.\n$$\n四舍五入到三位有效数字并以米表示，$L = 53.0\\ \\mathrm{m}$。\n\n对于极夜逆温的解释：负的 $\\overline{w'\\theta_v'}$ 表明是稳定层结，从而得到 $L0$。在极夜条件下，当 $u_*=0.2\\,\\mathrm{m\\,s^{-1}}$ 时，量级为 $10^{1}$–$10^{2}\\,\\mathrm{m}$ 的莫宁-奥布霍夫长度 $L$ 表明这是一个弱到中等强度的稳定近地层。典型的塔测量近地表高度 $z$（例如，$z\\sim 10\\,\\mathrm{m}$）将有 $z/L\\sim 0.2$，这是一个切变仍然产生湍流但浮力抑制混合的状态，有利于形成间歇性的弱湍流，而不是强烈的对流。相对适中的 $u_*$ 值表明，湍流由切变维持，但在逆温层下是浅薄且脆弱的，这与极夜的挑战相一致：间歇性爆发、混合效率降低，以及对风和辐射冷却的微小变化敏感。",
            "answer": "$$\\boxed{53.0}$$"
        },
        {
            "introduction": "气候和天气预报模型的网格单元通常有数十至数百公里宽，无法分辨极地海冰上广泛存在的冰间水道（leads）等次网格尺度特征。然而，这些狭窄的开阔水域与周围冰面的性质截然不同，对动量和热量通量有着不成比例的巨大影响。本练习将挑战你构建一个次网格参数化方案，通过贯彻“面积平均通量一致性”原则，为一个包含冰和水的混合地表推导有效的动量粗糙度长度和感热通量增强因子，这是一个模拟真实模型开发过程的高级实践 。",
            "id": "4021937",
            "problem": "在北极地区的数值天气预报 (NWP) 和气候模型中，一个粗网格单元包含非均匀海冰以及次网格尺度的海冰冰间水道（狭窄的开阔水域通道）。任务是为这些次网格冰间水道构建一个参数化方案，以得出粗网格尺度上的有效动量粗糙度长度和感热通量增强因子。假设在粗网格尺度上，参考高度的风速和气温是水平均一的，大气稳定度为中性，并忽略内部边界层的发展或遮蔽效应。使用基于原理的推导，从近地层理论和面积平均通量一致性出发，不借助任何直接给出有效参数的简化公式。\n\n使用的基本原理：\n- 雷诺平均地表动量通量由 $\\tau = \\rho \\, u_*^2$ 给出，其中 $\\rho$ 是空气密度， $u_*$ 是摩擦速度。\n- 在中性层结下，对数风廓线得出 $U(z) = \\frac{u_*}{\\kappa} \\ln\\left(\\frac{z}{z_{0m}}\\right)$，其中 $U(z)$ 是高度 $z$ 处的风速，$\\kappa$ 是冯·卡门常数， $z_{0m}$ 是动量粗糙度长度。\n- 参考高度 $z$ 处的中性总体拖曳系数满足 $C_D = \\left[\\frac{\\kappa}{\\ln\\left(\\frac{z}{z_{0m}}\\right)}\\right]^2$。\n- 中性总体感热输送系数满足 $C_H = \\frac{\\kappa^2}{\\ln\\left(\\frac{z}{z_{0m}}\\right)\\,\\ln\\left(\\frac{z}{z_{0t}}\\right)}$，其中 $z_{0t}$ 是标量（热力）粗糙度长度。\n- 总体感热通量为 $H = \\rho \\, c_p \\, C_H \\, U(z) \\, \\left(T_s - T_a\\right)$，其中 $c_p$ 是空气定压比热，$T_s$ 是地表温度，$T_a$ 是高度 $z$ 处的空气温度。\n- 对于开阔水域，使用带有粘性修正的 Charnock 关系式从 $u_*$ 确定 $z_{0m}$：$z_{0m} = \\alpha \\frac{u_*^2}{g} + \\beta \\frac{\\nu_a}{u_*}$，其中 $\\alpha$ 是 Charnock 系数，$g$ 是重力加速度，$\\beta$ 是粘性修正系数，$\\nu_a$ 是空气运动粘度。\n\n情景与参数：\n- 考虑一个粗网格单元，其冰间水道面积分数为 $f_\\ell \\in [0,1]$。剩余的分数 $1 - f_\\ell$ 为海冰。\n- 参考高度为 $z = 10\\,\\mathrm{m}$，给定值为 $10$。\n- 空气密度为 $\\rho = 1.3\\,\\mathrm{kg\\,m^{-3}}$，给定值为 $1.3$。\n- 定压比热为 $c_p = 1004\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$，给定值为 $1004$。\n- 冯·卡门常数为 $\\kappa = 0.4$，给定值为 $0.4$。\n- 重力加速度为 $g = 9.81\\,\\mathrm{m\\,s^{-2}}$，给定值为 $9.81$。\n- 空气运动粘度为 $\\nu_a = 1.5\\times 10^{-5}\\,\\mathrm{m^2\\,s^{-1}}$，给定值为 $1.5\\times 10^{-5}$。\n- Charnock 系数为 $\\alpha = 0.014$，给定值为 $0.014$；粘性修正系数为 $\\beta = 0.11$，给定值为 $0.11$。\n- 高度 $z$ 处的风速为 $U(z) = 8\\,\\mathrm{m\\,s^{-1}}$，给定值为 $8$。\n- 气温为 $T_a = -25\\,^\\circ\\mathrm{C}$，给定值为 $-25$；海冰表面温度为 $T_{s,i} = -20\\,^\\circ\\mathrm{C}$，给定值为 $-20$；冰间水道（开阔水域）表面温度为 $T_{s,w} = -1.8\\,^\\circ\\mathrm{C}$，给定值为 $-1.8$。\n- 海冰动量粗糙度长度为 $z_{0m,i} = 0.003\\,\\mathrm{m}$，给定值为 $0.003$。\n- 假设热力粗糙度长度与动量粗糙度长度之比为常数，$z_{0t} = r_t \\, z_{0m}$，其中 $r_t = 0.1$，给定值为 $0.1$，应用于两种表面。\n\n任务：\n- 仅使用上述基本原理，通过在参考高度 $z$ 强制实现面积平均通量一致性来为次网格冰间水道构建参数化方案，以获得混合表面的有效总体动量输送。由此，确定有效动量粗糙度长度 $z_{0m,\\mathrm{eff}}$（单位：米）。\n- 使用相同原理，计算混合表面的面积平均感热通量，并将感热通量增强因子 $E$ 定义为在相同参考条件下，混合表面感热通量与纯冰表面感热通量之比。将 $E$ 表示为小数（无量纲）。\n\n测试组：\n- 评估参数化方案在以下冰间水道分数 $f_\\ell$ 下的表现：$0$、$0.01$、$0.05$、$0.3$、$1$。\n\n答案规格与输出格式：\n- 对于每个测试用例，返回一个包含两个元素的列表，其中包含 $z_{0m,\\mathrm{eff}}$（单位：米）和 $E$（小数形式）。\n- 你的程序应生成单行输出，其中包含所有测试用例的结果，格式为一个由方括号括起来的逗号分隔列表，其中每个元素是如上所述的双元素列表。例如，输出形式应为 `[[z0_1,E_1],[z0_2,E_2],...]`。",
            "solution": "问题要求在一个粗网格模型单元内，推导并实现一个针对次网格尺度海冰冰间水道的参数化方案。目标是基于面积平均通量一致性原理，为非均匀表面找到有效动量粗糙度长度 $z_{0m,\\mathrm{eff}}$ 和感热通量增强因子 $E$。\n\n基本假设是，来自粗网格单元的总通量是其组成的次网格表面（海冰，下标为 $i$；开阔水域冰间水道，下标为 $w$）通量的面积加权平均值。冰的面积分数为 $1 - f_\\ell$，冰间水道的面积分数为 $f_\\ell$。假设参考高度风速 $U(z)$ 和气温 $T_a$ 在整个单元上是水平均一的。\n\n### 第 1 部分：有效动量粗糙度长度 ($z_{0m,\\mathrm{eff}}$) 的推导\n\n应用于地表动量通量 $\\tau$（应力）的面积平均通量一致性原理表明：\n$$ \\tau_{\\mathrm{eff}} = (1 - f_\\ell)\\tau_i + f_\\ell \\tau_w $$\n使用定义 $\\tau = \\rho u_*^2 = \\rho C_D U(z)^2$，其中 $u_*$ 是摩擦速度，$C_D$ 是总体拖曳系数，$\\rho$ 是恒定的空气密度，我们可以将有效拖曳系数 $C_{D,\\mathrm{eff}}$ 表示为次网格拖曳系数的面积加权平均值：\n$$ C_{D,\\mathrm{eff}} = (1 - f_\\ell)C_{D,i} + f_\\ell C_{D,w} $$\n我们的目标是找到 $z_{0m,\\mathrm{eff}}$，它通过中性总体拖曳系数公式与 $C_{D,\\mathrm{eff}}$ 相关：\n$$ C_{D,\\mathrm{eff}} = \\left[\\frac{\\kappa}{\\ln\\left(\\frac{z}{z_{0m,\\mathrm{eff}}}\\right)}\\right]^2 $$\n对此方程求解 $z_{0m,\\mathrm{eff}}$ 可得：\n$$ z_{0m,\\mathrm{eff}} = z \\cdot \\exp\\left(-\\frac{\\kappa}{\\sqrt{C_{D,\\mathrm{eff}}}}\\right) $$\n为计算 $z_{0m,\\mathrm{eff}}$，我们必须首先确定 $C_{D,i}$ 和 $C_{D,w}$。\n\n**1.a. 海冰上的拖曳系数 ($C_{D,i}$)**\n海冰的动量粗糙度长度 $z_{0m,i}$ 是一个给定的常数。因此，$C_{D,i}$ 可以直接计算：\n$$ C_{D,i} = \\left[\\frac{\\kappa}{\\ln\\left(\\frac{z}{z_{0m,i}}\\right)}\\right]^2 $$\n使用给定参数，$z = 10\\,\\mathrm{m}$，$\\kappa=0.4$，以及 $z_{0m,i} = 0.003\\,\\mathrm{m}$。\n\n**1.b. 水面上的拖曳系数 ($C_{D,w}$)**\n水面的粗糙度 $z_{0m,w}$ 是动态的，并通过 Charnock 关系式依赖于水面上的摩擦速度 $u_{*,w}$。而摩擦速度又通过对数风廓线依赖于粗糙度长度。这构成了一个必须迭代求解的非线性方程组：\n1.  $$ z_{0m,w} = \\alpha \\frac{u_{*,w}^2}{g} + \\beta \\frac{\\nu_a}{u_{*,w}} $$\n2.  $$ u_{*,w} = \\frac{\\kappa U(z)}{\\ln\\left(\\frac{z}{z_{0m,w}}\\right)} $$\n迭代求解过程如下：\n- 从 $u_{*,w}$ 的一个初始猜测值开始（例如，冰面上的值 $u_{*,i}$）。\n- 使用当前的 $u_{*,w}$，根据方程 (1) 重复更新 $z_{0m,w}$。\n- 接着使用新的 $z_{0m,w}$，根据方程 (2) 更新 $u_{*,w}$。\n- 持续此过程直到 $u_{*,w}$ 的值收敛。\n\n一旦找到收敛的 $u_{*,w}$ 值，拖曳系数 $C_{D,w}$ 就由关系式 $u_{*,w}^2 = C_{D,w} U(z)^2$ 确定：\n$$ C_{D,w} = \\left(\\frac{u_{*,w}}{U(z)}\\right)^2 $$\n在 $C_{D,i}$ 和 $C_{D,w}$ 都已知的情况下，对于任何给定的 $f_\\ell$ 都可以计算出 $C_{D,\\mathrm{eff}}$，并由此计算出 $z_{0m,\\mathrm{eff}}$。\n\n### 第 2 部分：感热通量增强因子 ($E$) 的推导\n\n增强因子 $E$ 是混合表面的总感热通量 $H_{\\mathrm{eff}}$ 与纯冰表面的通量 $H_{i, \\text{pure}}$ 之比：\n$$ E = \\frac{H_{\\mathrm{eff}}}{H_{i, \\text{pure}}} $$\n面积平均感热通量 $H_{\\mathrm{eff}}$ 是来自冰和水的通量的加权平均值：\n$$ H_{\\mathrm{eff}} = (1 - f_\\ell)H_i + f_\\ell H_w $$\n使用总体公式 $H = \\rho c_p C_H U(z) (T_s - T_a)$，其中 $C_H$ 是总体感热输送系数，我们有：\n$$ H_{\\mathrm{eff}} = \\rho c_p U(z) \\left[ (1 - f_\\ell)C_{H,i}(T_{s,i} - T_a) + f_\\ell C_{H,w}(T_{s,w} - T_a) \\right] $$\n参考通量 $H_{i, \\text{pure}}$ 是 100% 冰面上的通量：\n$$ H_{i, \\text{pure}} = \\rho c_p C_{H,i} U(z) (T_{s,i} - T_a) $$\n将 $H_{\\mathrm{eff}}$ 除以 $H_{i, \\text{pure}}$ 得到 $E$ 的表达式：\n$$ E = (1 - f_\\ell) + f_\\ell \\frac{C_{H,w}}{C_{H,i}} \\frac{(T_{s,w} - T_a)}{(T_{s,i} - T_a)} $$\n\n为计算 $E$，我们需要热输送系数 $C_{H,i}$ 和 $C_{H,w}$。它们由以下公式给出：\n$$ C_H = \\frac{\\kappa^2}{\\ln\\left(\\frac{z}{z_{0m}}\\right)\\,\\ln\\left(\\frac{z}{z_{0t}}\\right)} $$\n其中 $z_{0t}$ 是热力粗糙度长度，通过 $z_{0t} = r_t z_{0m}$ 与动量粗糙度长度相关，其中 $r_t=0.1$。\n\n**2.a. 冰面上的热输送系数 ($C_{H,i}$)**\n在已知 $z_{0m,i}$ 的情况下，我们求出 $z_{0t,i} = r_t z_{0m,i}$，然后直接根据其公式计算 $C_{H,i}$。\n\n**2.b. 水面上的热输送系数 ($C_{H,w}$)**\n使用第 1.b 部分得到的收敛的 $u_{*,w}$ 和 $z_{0m,w}$ 值，我们求出 $z_{0t,w} = r_t z_{0m,w}$，然后计算 $C_{H,w}$。\n\n所有系数都定义后，就可以对任何给定的 $f_\\ell$ 计算 $E$。至此，所需的推导完成。上面概述的计算步骤将被执行以评估测试用例。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Constructs a parameterization for subgrid sea-ice leads to find the\n    effective momentum roughness length and sensible heat flux enhancement.\n    \"\"\"\n    # --- Given Parameters ---\n    z = 10.0  # Reference height (m)\n    rho = 1.3  # Air density (kg/m^3)\n    c_p = 1004.0  # Specific heat of air (J/kg/K)\n    kappa = 0.4  # Von Kármán constant (-)\n    g = 9.81  # Gravitational acceleration (m/s^2)\n    nu_a = 1.5e-5  # Kinematic viscosity of air (m^2/s)\n    alpha = 0.014  # Charnock coefficient (-)\n    beta = 0.11  # Viscous correction coefficient (-)\n    U_z = 8.0  # Wind speed at reference height (m/s)\n    T_a = -25.0  # Air temperature (°C)\n    T_si = -20.0  # Sea-ice surface temperature (°C)\n    T_sw = -1.8  # Lead (water) surface temperature (°C)\n    z0m_i = 0.003  # Sea-ice momentum roughness length (m)\n    r_t = 0.1  # Ratio z_0t / z_0m (-)\n\n    # --- Test Cases ---\n    test_cases_fl = [0.0, 0.01, 0.05, 0.3, 1.0]\n\n    # --- Part 1: Ice Surface Properties (Constant) ---\n    ln_z_z0m_i = np.log(z / z0m_i)\n    C_D_i = (kappa / ln_z_z0m_i)**2\n    \n    z0t_i = r_t * z0m_i\n    ln_z_z0t_i = np.log(z / z0t_i)\n    C_H_i = kappa**2 / (ln_z_z0m_i * ln_z_z0t_i)\n    \n    delta_T_i = T_si - T_a\n    \n    # --- Part 2: Water Surface Properties (Iterative Solution) ---\n    # Initial guess for friction velocity over water, u_*,w\n    u_star_i = np.sqrt(C_D_i) * U_z\n    u_star_w = u_star_i \n\n    # Fixed-point iteration to find u_star_w and z_0m,w\n    for _ in range(15):  # Convergence is rapid\n        # Charnock relation to find z_0m,w from u_*,w\n        z0m_w_current = alpha * u_star_w**2 / g + beta * nu_a / u_star_w\n        # Update u_*,w using the log wind profile\n        u_star_w_new = kappa * U_z / np.log(z / z0m_w_current)\n        u_star_w = u_star_w_new\n\n    # Final converged properties for water surface\n    z0m_w = alpha * u_star_w**2 / g + beta * nu_a / u_star_w\n    C_D_w = (u_star_w / U_z)**2\n\n    z0t_w = r_t * z0m_w\n    ln_z_z0m_w = np.log(z / z0m_w)\n    ln_z_z0t_w = np.log(z / z0t_w)\n    C_H_w = kappa**2 / (ln_z_z0m_w * ln_z_z0t_w)\n    \n    delta_T_w = T_sw - T_a\n\n    # --- Part 3: Calculate Effective Properties for Each Test Case ---\n    results = []\n    for f_l in test_cases_fl:\n        # Calculate effective drag coefficient\n        C_D_eff = (1 - f_l) * C_D_i + f_l * C_D_w\n        \n        # Calculate effective momentum roughness length\n        sqrt_C_D_eff = np.sqrt(C_D_eff)\n        z0m_eff = z * np.exp(-kappa / sqrt_C_D_eff)\n        \n        # Calculate sensible heat flux enhancement factor\n        # This general formula correctly handles f_l=0 and f_l=1 cases.\n        E = (1 - f_l) + f_l * (C_H_w / C_H_i) * (delta_T_w / delta_T_i)\n        \n        results.append([round(z0m_eff, 8), round(E, 8)])\n\n    # --- Final Output Formatting ---\n    # Manually construct the string to match the required format `[[z0_1,E_1],[z0_2,E_2],...]`\n    # without spaces inside the inner lists.\n    formatted_results = [f\"[{res[0]},{res[1]}]\" for res in results]\n    final_output = f\"[{','.join(formatted_results)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}