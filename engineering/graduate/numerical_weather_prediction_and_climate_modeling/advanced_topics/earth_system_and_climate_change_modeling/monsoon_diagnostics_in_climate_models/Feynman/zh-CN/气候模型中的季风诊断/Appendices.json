{
    "hands_on_practices": [
        {
            "introduction": "季风环流的一个标志性特征是其强大的纬向风垂直切变——低层盛行西风，高层转为东风急流。这个实践练习从著名的韦伯斯特-杨指数（WYI）入手，该指数正是用于量化这种垂直风切变。通过这个练习，你将把这一可观测的指数与热成风平衡这一基本动力学原理联系起来，从而揭示大尺度经向温度梯度是如何驱动季风环流的。此外，该练习还将探讨在气候模式中，对流参数化（如对流性动量输送）是如何修正这一基本关系的。",
            "id": "4067435",
            "problem": "考虑韦伯斯特-杨指数（WYI），其在此定义为南亚季风区对流层低层和高层之间纬向风的区域平均差异，$$\\mathrm{WYI} \\equiv \\overline{u}(p_{l}) - \\overline{u}(p_{u}),$$ 其中 $\\overline{u}$ 表示在指定区域上平均的纬向风，上划线表示区域平均，$p_{l} = 8.5 \\times 10^{4} \\ \\mathrm{Pa}$，$p_{u} = 2.0 \\times 10^{4} \\ \\mathrm{Pa}$。假设大尺度气流是静力平衡且近似地转的，并以热成风平衡为基本依据。推导 $\\mathrm{WYI}$ 与经向温度梯度的垂直积分之间的关系。然后，引入一个简单的对流-切变耦合表示，其中对流性动量输送 (CMT) 将有效垂直切变减小一个无量纲因子 $\\lambda$，使得模型的有效切变为热成风平衡值的 $(1 - \\lambda)$ 倍，其中 $\\lambda = 0.30$。\n\n给定一个在对数气压坐标系下科学上合理的经向温度梯度廓线，\n$$\\frac{\\partial T}{\\partial y}(p) = g_{0} + g_{1} \\ln\\left(\\frac{p}{p_{0}}\\right),$$\n其中 $g_{0} = 2.0 \\times 10^{-6} \\ \\mathrm{K} \\ \\mathrm{m}^{-1}$，$g_{1} = 0.5 \\times 10^{-6} \\ \\mathrm{K} \\ \\mathrm{m}^{-1}$，$p_{0} = 1.0 \\times 10^{5} \\ \\mathrm{Pa}$。假设科里奥利参数 $f$ 在该层内垂直方向上是均匀的，并使用 $f = 2 \\Omega \\sin \\phi$ 在纬度 $\\phi = 15$ 度处计算，其中地球自转速率为 $\\Omega = 7.292 \\times 10^{-5} \\ \\mathrm{s}^{-1}$。使用干空气的理想气体常数 $R = 287 \\ \\mathrm{J} \\ \\mathrm{kg}^{-1} \\ \\mathrm{K}^{-1}$。\n\n1. 使用热成风平衡和给定的 $\\frac{\\partial T}{\\partial y}(p)$，推导热成风平衡的 WYI（记为 $\\mathrm{WYI}_{\\mathrm{TW}}$）的闭式表达式。\n2. 使用上述简单的对流-切变耦合，将模型有效的 $\\mathrm{WYI}$ 写成 $\\mathrm{WYI}_{\\mathrm{TW}}$ 和 $\\lambda$ 的函数，然后使用所提供的参数对其进行数值计算。\n\n将 $\\mathrm{WYI}$ 的最终值以 $\\mathrm{m} \\ \\mathrm{s}^{-1}$ 为单位表示，并将您的答案四舍五入至四位有效数字。三角函数中使用的角度应解释为度。",
            "solution": "用户要求我验证并解决一个关于 Webster–Yang 指数（WYI）的问题，该指数是南亚季风的一个诊断量，基于热成风平衡和对流效应的参数化方案。\n\n### 第 1 步：问题验证\n我将首先提取给定信息并验证问题陈述。\n\n**给定条件：**\n-   Webster–Yang 指数（WYI）定义：$\\mathrm{WYI} \\equiv \\overline{u}(p_{l}) - \\overline{u}(p_{u})$，其中 $\\overline{u}$ 是区域平均纬向风。\n-   低气压层：$p_{l} = 8.5 \\times 10^{4} \\ \\mathrm{Pa}$。\n-   高气压层：$p_{u} = 2.0 \\times 10^{4} \\ \\mathrm{Pa}$。\n-   假设：大尺度气流为静力平衡且近似地转。\n-   基本原理：热成风平衡。\n-   对流-切变耦合：模型的有效切变为热成风平衡切变的 $(1 - \\lambda)$ 倍，其中 $\\lambda = 0.30$。\n-   对数气压坐标系下的经向温度梯度廓线：$\\frac{\\partial T}{\\partial y}(p) = g_{0} + g_{1} \\ln\\left(\\frac{p}{p_{0}}\\right)$。\n-   梯度廓线的常数：$g_{0} = 2.0 \\times 10^{-6} \\ \\mathrm{K} \\ \\mathrm{m}^{-1}$ 和 $g_{1} = 0.5 \\times 10^{-6} \\ \\mathrm{K} \\ \\mathrm{m}^{-1}$。\n-   参考气压：$p_{0} = 1.0 \\times 10^{5} \\ \\mathrm{Pa}$。\n-   科里奥利参数 $f$ 假设为垂直均匀，并在纬度 $\\phi = 15$ 度处计算。\n-   科里奥利参数公式：$f = 2 \\Omega \\sin \\phi$。\n-   地球自转速率：$\\Omega = 7.292 \\times 10^{-5} \\ \\mathrm{s}^{-1}$。\n-   干空气的理想气体常数：$R = 287 \\ \\mathrm{J} \\ \\mathrm{kg}^{-1} \\ \\mathrm{K}^{-1}$。\n\n**验证：**\n1.  **科学依据：** 该问题牢固地植根于大气动力学的基本原理，特别是地转平衡和静力平衡，它们结合起来得到热成风方程。WYI 是季风研究中一个标准且成熟的诊断量。将对流性动量输送参数化为切变的线性减少，是一个简化但具有物理动机的概念，常用于气候模拟。所有常数和参数的数值对于地球大气和指定的地理背景来说都是物理上现实的。\n2.  **适定性：** 该问题是适定的。它提供了所有必要的方程、常数和边界条件，以推导出唯一的解析表达式并计算出单一的数值。任务定义清晰且逻辑上是顺序的。\n3.  **客观性：** 问题以精确、定量和无偏见的科学语言陈述。\n\n**结论：** 该问题科学上合理、适定且客观。可以进行求解。\n\n### 第 2 步：求解推导\n\n按照问题陈述的要求，求解过程分为两部分。\n\n**第 1 部分：热成风平衡的 WYI ($\\mathrm{WYI}_{\\mathrm{TW}}$) 的推导**\n\n我们从气压坐标中纬向风 $u$ 的热成风方程开始，该方程由地转平衡和静力平衡推导得出。对于近似地转的气流，我们可以用纬向地转风 $u_g$ 代替区域平均纬向风 $\\overline{u}$。热成风方程的相关分量是：\n$$\n\\frac{\\partial u_g}{\\partial p} = \\frac{R}{fp} \\left(\\frac{\\partial T}{\\partial y}\\right)_p\n$$\n这里，$R$ 是比气体常数，$f$ 是科里奥利参数，$p$ 是气压，$\\left(\\frac{\\partial T}{\\partial y}\\right)_p$ 是等压面上的经向温度梯度。\n\nWebster–Yang 指数（WYI）定义为低气压层 $p_l$ 和高气压层 $p_u$ 之间的纬向风差异。这个差异代表了纬向风的垂直切变。我们可以通过将热成风方程从 $p_u$ 到 $p_l$ 对气压进行积分来求得这个差异：\n$$\n\\int_{p_u}^{p_l} \\frac{\\partial u_g}{\\partial p} dp = \\int_{p_u}^{p_l} \\frac{R}{fp} \\left(\\frac{\\partial T}{\\partial y}\\right)_p dp\n$$\n方程的左边计算结果为：\n$$\n\\int_{p_u}^{p_l} d u_g = u_g(p_l) - u_g(p_u)\n$$\n根据定义，这就是热成风平衡的 WYI，我们将其记为 $\\mathrm{WYI}_{\\mathrm{TW}}$：\n$$\n\\mathrm{WYI}_{\\mathrm{TW}} = u_g(p_l) - u_g(p_u)\n$$\n因此，$\\mathrm{WYI}_{\\mathrm{TW}}$ 的表达式为：\n$$\n\\mathrm{WYI}_{\\mathrm{TW}} = \\frac{R}{f} \\int_{p_u}^{p_l} \\frac{1}{p} \\left(\\frac{\\partial T}{\\partial y}\\right)_p dp\n$$\n问题给出了经向温度梯度的函数形式：\n$$\n\\frac{\\partial T}{\\partial y}(p) = g_{0} + g_{1} \\ln\\left(\\frac{p}{p_{0}}\\right)\n$$\n我们将此表达式代入积分中：\n$$\n\\mathrm{WYI}_{\\mathrm{TW}} = \\frac{R}{f} \\int_{p_u}^{p_l} \\frac{1}{p} \\left[ g_{0} + g_{1} \\ln\\left(\\frac{p}{p_{0}}\\right) \\right] dp\n$$\n该积分可以分为两部分：\n$$\n\\mathrm{WYI}_{\\mathrm{TW}} = \\frac{R}{f} \\left[ \\int_{p_u}^{p_l} \\frac{g_0}{p} dp + \\int_{p_u}^{p_l} \\frac{g_1}{p} \\ln\\left(\\frac{p}{p_{0}}\\right) dp \\right]\n$$\n我们计算每个积分。第一个积分是：\n$$\n\\int_{p_u}^{p_l} \\frac{g_0}{p} dp = g_0 [\\ln(p)]_{p_u}^{p_l} = g_0 (\\ln(p_l) - \\ln(p_u)) = g_0 \\ln\\left(\\frac{p_l}{p_u}\\right)\n$$\n对于第二个积分，我们使用换元法 $x = \\ln(p/p_0)$，因此有 $dx = (1/p)dp$。该积分变成一个简单的多项式积分：\n$$\n\\int \\frac{g_1}{p} \\ln\\left(\\frac{p}{p_{0}}\\right) dp = g_1 \\int x dx = \\frac{g_1}{2} x^2 = \\frac{g_1}{2} \\left( \\ln\\left(\\frac{p}{p_{0}}\\right) \\right)^2\n$$\n计算该定积分得出：\n$$\n\\int_{p_u}^{p_l} \\frac{g_1}{p} \\ln\\left(\\frac{p}{p_{0}}\\right) dp = \\frac{g_1}{2} \\left[ \\left( \\ln\\left(\\frac{p}{p_{0}}\\right) \\right)^2 \\right]_{p_u}^{p_l} = \\frac{g_1}{2} \\left[ \\left( \\ln\\left(\\frac{p_l}{p_{0}}\\right) \\right)^2 - \\left( \\ln\\left(\\frac{p_u}{p_{0}}\\right) \\right)^2 \\right]\n$$\n结合这些结果，我们得到 $\\mathrm{WYI}_{\\mathrm{TW}}$ 的闭式表达式：\n$$\n\\mathrm{WYI}_{\\mathrm{TW}} = \\frac{R}{f} \\left[ g_0 \\ln\\left(\\frac{p_l}{p_u}\\right) + \\frac{g_1}{2} \\left( \\left( \\ln\\left(\\frac{p_l}{p_{0}}\\right) \\right)^2 - \\left( \\ln\\left(\\frac{p_u}{p_{0}}\\right) \\right)^2 \\right) \\right]\n$$\n这样就完成了第一个任务。\n\n**第 2 部分：模型有效的 WYI 的计算**\n\n问题陈述，对流性动量输送 (CMT) 将有效垂直切变减小一个无量纲因子 $\\lambda$。模型的有效切变为热成风平衡值的 $(1 - \\lambda)$ 倍。由于 $\\mathrm{WYI}$ 是垂直切变的一个度量，模型有效的 $\\mathrm{WYI}$ 由下式给出：\n$$\n\\mathrm{WYI} = (1 - \\lambda) \\mathrm{WYI}_{\\mathrm{TW}}\n$$\n这就是所要求解的函数关系。现在我们必须对此表达式进行数值计算。\n\n首先，我们计算在 $\\phi = 15$ 度处的科里奥利参数 $f$：\n$$\nf = 2 \\Omega \\sin \\phi = 2 \\times (7.292 \\times 10^{-5} \\ \\mathrm{s}^{-1}) \\times \\sin(15^{\\circ}) \\approx 2 \\times (7.292 \\times 10^{-5}) \\times 0.258819 \\ \\mathrm{s}^{-1} \\approx 3.77539 \\times 10^{-5} \\ \\mathrm{s}^{-1}\n$$\n接下来，我们使用给定的气压值计算对数项：$p_l = 8.5 \\times 10^{4} \\ \\mathrm{Pa}$，$p_u = 2.0 \\times 10^{4} \\ \\mathrm{Pa}$，$p_0 = 1.0 \\times 10^{5} \\ \\mathrm{Pa}$。\n$$\n\\ln\\left(\\frac{p_l}{p_u}\\right) = \\ln\\left(\\frac{8.5 \\times 10^{4}}{2.0 \\times 10^{4}}\\right) = \\ln(4.25) \\approx 1.446919\n$$\n$$\n\\ln\\left(\\frac{p_l}{p_{0}}\\right) = \\ln\\left(\\frac{8.5 \\times 10^{4}}{1.0 \\times 10^{5}}\\right) = \\ln(0.85) \\approx -0.162519\n$$\n$$\n\\ln\\left(\\frac{p_u}{p_{0}}\\right) = \\ln\\left(\\frac{2.0 \\times 10^{4}}{1.0 \\times 10^{5}}\\right) = \\ln(0.20) \\approx -1.609438\n$$\n现在，我们使用 $g_{0} = 2.0 \\times 10^{-6} \\ \\mathrm{K} \\ \\mathrm{m}^{-1}$ 和 $g_{1} = 0.5 \\times 10^{-6} \\ \\mathrm{K} \\ \\mathrm{m}^{-1}$ 计算 $\\mathrm{WYI}_{\\mathrm{TW}}$ 表达式中方括号内的各项：\n$$\ng_0 \\ln\\left(\\frac{p_l}{p_u}\\right) \\approx (2.0 \\times 10^{-6}) \\times 1.446919 = 2.893838 \\times 10^{-6} \\ \\mathrm{K} \\ \\mathrm{m}^{-1}\n$$\n$$\n\\frac{g_1}{2} \\left[ \\left( \\ln\\left(\\frac{p_l}{p_{0}}\\right) \\right)^2 - \\left( \\ln\\left(\\frac{p_u}{p_{0}}\\right) \\right)^2 \\right] \\approx \\frac{0.5 \\times 10^{-6}}{2} \\left[ (-0.162519)^2 - (-1.609438)^2 \\right]\n$$\n$$\n\\approx (0.25 \\times 10^{-6}) \\left[ 0.026412 - 2.59029 \\right] = (0.25 \\times 10^{-6}) \\times (-2.563878) \\approx -0.640970 \\times 10^{-6} \\ \\mathrm{K} \\ \\mathrm{m}^{-1}\n$$\n方括号内的和为：\n$$\n(2.893838 - 0.640970) \\times 10^{-6} \\ \\mathrm{K} \\ \\mathrm{m}^{-1} = 2.252868 \\times 10^{-6} \\ \\mathrm{K} \\ \\mathrm{m}^{-1}\n$$\n现在，我们使用 $R = 287 \\ \\mathrm{J} \\ \\mathrm{kg}^{-1} \\ \\mathrm{K}^{-1}$ 计算 $\\mathrm{WYI}_{\\mathrm{TW}}$：\n$$\n\\mathrm{WYI}_{\\mathrm{TW}} = \\frac{R}{f} \\times (2.252868 \\times 10^{-6} \\ \\mathrm{K} \\ \\mathrm{m}^{-1}) \\approx \\frac{287}{3.77539 \\times 10^{-5}} \\times (2.252868 \\times 10^{-6}) \\ \\mathrm{m} \\ \\mathrm{s}^{-1}\n$$\n$$\n\\mathrm{WYI}_{\\mathrm{TW}} \\approx (7.602008 \\times 10^{6}) \\times (2.252868 \\times 10^{-6}) \\ \\mathrm{m} \\ \\mathrm{s}^{-1} \\approx 17.1263 \\ \\mathrm{m} \\ \\mathrm{s}^{-1}\n$$\n最后，我们应用对流-切变耦合因子 $(1 - \\lambda) = (1 - 0.30) = 0.70$：\n$$\n\\mathrm{WYI} = 0.70 \\times \\mathrm{WYI}_{\\mathrm{TW}} \\approx 0.70 \\times 17.1263 \\ \\mathrm{m} \\ \\mathrm{s}^{-1} \\approx 11.98841 \\ \\mathrm{m} \\ \\mathrm{s}^{-1}\n$$\n问题要求答案四舍五入至四位有效数字。\n$$\n\\mathrm{WYI} \\approx 11.99 \\ \\mathrm{m} \\ \\mathrm{s}^{-1}\n$$\n正值表示低层纬向风比高层纬向风更偏西，这是南亚季风环流（低层西风，高空东风急流）的特征。其量级在物理上是合理的。",
            "answer": "$$\n\\boxed{11.99}\n$$"
        },
        {
            "introduction": "在理解了驱动季风的大尺度动力学之后，我们将注意力转向其最核心的影响——降水。本实践练习聚焦于大气水汽收支，这是降水的直接来源。你将构建一个简化但机理明确的诊断模型，以探索气候模式中的一个关键且不确定性较大的参数——对流夹带率——是如何通过影响降水效率及相关反馈过程，进而影响季节性总降水量的。这项练习是进行模式参数化敏感性分析的经典范例。",
            "id": "4067500",
            "problem": "需要实现一个简化的、有科学依据的诊断模型，用以量化对流夹带率的变化如何影响两个地区——孟加拉湾和印度中部——在六月至九月（JJAS）期间的降雨量。推导和计算必须从整层大气水汽收支恒等式开始，这是季风诊断中一个被广泛接受的基础。该恒等式为\n$$\nP - E = -\\nabla \\cdot (q \\mathbf{v}) - \\frac{\\partial W}{\\partial t},\n$$\n其中 $P$ 是降水量，$E$ 是蒸发量，$q$ 是比湿，$\\mathbf{v}$ 是风矢量，$W = \\int q \\rho \\, dz$ 是整层大气水汽含量（其中 $\\rho$ 是密度，$z$ 是高度）。对于JJAS期间的季节平均而言，储存项相对于平均通量很小，这一点已经得到了很好的验证，因此可以设定 $\\frac{\\partial W}{\\partial t} \\approx 0$。于是，季节平均的收支平衡变为\n$$\nP = E + C,\n$$\n其中 $C \\equiv -\\nabla \\cdot (q \\mathbf{v})$ 是总水汽辐合。在参数化的对流系统中，对流夹带通过将环境中的干燥空气混入上升气流，降低了对流云团将湿润入流转化为降水的效率。为分析敏感性，定义一个无量纲的降水效率函数，该函数随标准化的夹带率单调递减。设 $\\varepsilon$ 是单位为 $\\text{km}^{-1}$ 的对流夹带率，定义标准化夹带 $s = \\varepsilon / \\varepsilon_{\\mathrm{ref}}$，其中 $\\varepsilon_{\\mathrm{ref}}$ 是一个参考夹带率。设降水效率为\n$$\n\\varphi(s) = \\frac{\\varphi_{\\max}}{1 + \\alpha s},\n$$\n其中 $\\varphi_{\\max}$ 是零夹带时的最大效率，$\\alpha$ 是一个正的敏感性系数。季节性的蒸发和水汽辐合并非完全由外部强迫决定；它们会通过近地表湿度亏损和季风环流强度来适应对流强度。为了在一个与JJAS收支一致的线性化诊断闭合方案中从第一性原理表示这些调整，我们相对于基准夹带率 $\\varepsilon_0$（其效率为 $\\varphi_0 = \\varphi(\\varepsilon_0 / \\varepsilon_{\\mathrm{ref}})$）来定义变化。对于一个给定的区域，其基准蒸发为 $E_0$，基准辐合为 $C_0$，定义\n$$\nE(\\varepsilon) = E_0 \\left[1 - \\gamma \\left(\\varphi(\\varepsilon / \\varepsilon_{\\mathrm{ref}}) - \\varphi_0 \\right)\\right],\n$$\n$$\nC(\\varepsilon) = C_0 \\left[1 + \\chi \\left(\\varphi(\\varepsilon / \\varepsilon_{\\mathrm{ref}}) - \\varphi_0 \\right)\\right],\n$$\n其中 $\\gamma$ 和 $\\chi$ 是无量纲的敏感性系数：较大的 $\\varphi$ 会使边界层变得湿润，并通常减少 $E$（因此是负号），同时它会加强季风环流并增加 $C$（正号）。那么，JJAS期间的降水量为\n$$\nP(\\varepsilon) = E(\\varepsilon) + C(\\varepsilon),\n$$\n相对于基准的变化量为 $\\Delta P = P(\\varepsilon) - P(\\varepsilon_0)$，$\\Delta E = E(\\varepsilon) - E(\\varepsilon_0)$ 和 $\\Delta C = C(\\varepsilon) - C(\\varepsilon_0)$。定义一个闭合残差\n$$\nR(\\varepsilon) = P(\\varepsilon) - E(\\varepsilon) - C(\\varepsilon),\n$$\n在诊断公式下，该值在数值上应为零。所有降水量和通量都必须以 $\\text{mm day}^{-1}$ 为单位表示。\n\n使用以下具有科学合理性和自洽性的JJAS平均参数值来实现该模型：\n基准夹带率 $\\varepsilon_0 = 1.0$（单位 $\\text{km}^{-1}$），参考夹带率 $\\varepsilon_{\\mathrm{ref}} = 1.0$（单位 $\\text{km}^{-1}$），最大效率 $\\varphi_{\\max} = 0.9$，敏感性系数 $\\alpha = 0.5$，蒸发敏感性系数 $\\gamma = 0.15$，辐合敏感性系数 $\\chi = 0.25$。区域基准值：孟加拉湾的 $E_0 = 4.0$ $\\text{mm day}^{-1}$ 和 $C_0 = 8.0$ $\\text{mm day}^{-1}$；印度中部的 $E_0 = 3.0$ $\\text{mm day}^{-1}$ 和 $C_0 = 7.0$ $\\text{mm day}^{-1}$。\n\n对于每个测试用例的夹带率，你的程序必须计算列表 $[\\Delta P_{\\mathrm{BoB}}, \\Delta P_{\\mathrm{CI}}, \\Delta E_{\\mathrm{BoB}}, \\Delta E_{\\mathrm{CI}}, \\Delta C_{\\mathrm{BoB}}, \\Delta C_{\\mathrm{CI}}, B_{\\mathrm{BoB}}, B_{\\mathrm{CI}}]$，其中变化量 $\\Delta(\\cdot)$ 的单位是 $\\text{mm day}^{-1}$，$B_{\\mathrm{region}}$ 是一个布尔值，表示对于该区域，不等式 $|R(\\varepsilon)|  \\tau$ 是否成立，容差 $\\tau = 10^{-12}$ $\\text{mm day}^{-1}$。\n\n使用以下单位为 $\\text{km}^{-1}$ 的夹带率测试套件来探测不同的状况：$0.0$（无夹带，下限），$1.0$（基准，正常路径），$4.0$（高夹带，强混合），以及 $10.0$（极端夹带，边界情况）。\n\n最终输出格式：你的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果。每个元素对应一个测试用例，其本身也是一个列表，完全按照上述为孟加拉湾和印度中部描述的顺序排列。例如，一个有效的输出格式是 $[[\\dots],[\\dots],[\\dots],[\\dots]]$，其中所有浮点数的数值单位为 $\\text{mm day}^{-1}$，并包含用于收支闭合标志的布尔值。",
            "solution": "该问题具有科学依据，提法明确且客观。它基于大气整层水汽收支这一既定原则，这是气候科学中用于诊断降水及其驱动因素的标准框架。对流效率及其对蒸发和水汽辐合的反馈的参数化方案，虽然经过简化，但在概念上是对物理过程的合理解释。所有必需的参数和初始条件都已提供，从而可以得到一个唯一且可计算的解。因此，该问题是有效的，并且可以推导出解决方案。\n\n该解决方案通过构建一个基于所提供方程的诊断模型来实现。问题的核心是计算由于对流夹带率 $\\varepsilon$ 的变化而导致的六月至九月（JJAS）季节平均降水量的变化 $\\Delta P$。\n\n出发点是季节平均的水汽收支方程：\n$$\nP = E + C\n$$\n其中 $P$ 是降水量，$E$ 是蒸发量，$C$ 是水汽辐合。所有量的单位均为 $\\text{mm day}^{-1}$。\n\n该模型将这些分量如何随对流夹带率 $\\varepsilon$（单位为 $\\text{km}^{-1}$）变化进行参数化。\n\n首先，定义无量纲的降水效率 $\\varphi$ 作为标准化夹带率 $s = \\varepsilon / \\varepsilon_{\\mathrm{ref}}$ 的函数：\n$$\n\\varphi(s) = \\frac{\\varphi_{\\max}}{1 + \\alpha s}\n$$\n这里，$\\varepsilon_{\\mathrm{ref}} = 1.0$ $\\text{km}^{-1}$ 是参考夹带率，$\\varphi_{\\max} = 0.9$ 是最大效率，$\\alpha = 0.5$ 是敏感性系数。\n\n该模型计算相对于由基准夹带率 $\\varepsilon_0 = 1.0$ $\\text{km}^{-1}$ 定义的基准状态的变化。第一个计算步骤是确定基准降水效率 $\\varphi_0$：\n$$\ns_0 = \\frac{\\varepsilon_0}{\\varepsilon_{\\mathrm{ref}}} = \\frac{1.0}{1.0} = 1.0\n$$\n$$\n\\varphi_0 = \\varphi(s_0) = \\frac{\\varphi_{\\max}}{1 + \\alpha s_0} = \\frac{0.9}{1 + (0.5)(1.0)} = 0.6\n$$\n每个区域的基准降水量 $P_0$ 是基准蒸发量 $E_0$ 和基准辐合量 $C_0$ 的和：\n-   对于孟加la湾（BoB）：$P_{0, \\mathrm{BoB}} = E_{0, \\mathrm{BoB}} + C_{0, \\mathrm{BoB}} = 4.0 + 8.0 = 12.0$ $\\text{mm day}^{-1}$。\n-   对于印度中部（CI）：$P_{0, \\mathrm{CI}} = E_{0, \\mathrm{CI}} + C_{0, \\mathrm{CI}} = 3.0 + 7.0 = 10.0$ $\\text{mm day}^{-1}$。\n\n接下来，对于任何给定的测试夹带率 $\\varepsilon$，调整后的蒸发量 $E(\\varepsilon)$ 和辐合量 $C(\\varepsilon)$ 基于效率的变化量 $\\varphi(\\varepsilon / \\varepsilon_{\\mathrm{ref}}) - \\varphi_0$ 来计算。调整方程为：\n$$\nE(\\varepsilon) = E_0 \\left[1 - \\gamma \\left(\\varphi(\\varepsilon / \\varepsilon_{\\mathrm{ref}}) - \\varphi_0 \\right)\\right]\n$$\n$$\nC(\\varepsilon) = C_0 \\left[1 + \\chi \\left(\\varphi(\\varepsilon / \\varepsilon_{\\mathrm{ref}}) - \\varphi_0 \\right)\\right]\n$$\n其中敏感性系数 $\\gamma = 0.15$ 和 $\\chi = 0.25$。\n\n然后，通过将调整后的分量相加来计算给定 $\\varepsilon$ 下的总降水量：\n$$\nP(\\varepsilon) = E(\\varepsilon) + C(\\varepsilon)\n$$\n我们感兴趣的量是相对于基准的变化：\n$$\n\\Delta P = P(\\varepsilon) - P_0\n$$\n$$\n\\Delta E = E(\\varepsilon) - E_0\n$$\n$$\n\\Delta C = C(\\varepsilon) - C_0\n$$\n\n最后，计算收支闭合残差 $R(\\varepsilon)$。由于 $P(\\varepsilon)$ 被定义为 $E(\\varepsilon)$ 和 $C(\\varepsilon)$ 的和，该残差在解析上为零：\n$$\nR(\\varepsilon) = P(\\varepsilon) - E(\\varepsilon) - C(\\varepsilon) = (E(\\varepsilon) + C(\\varepsilon)) - (E(\\varepsilon) + C(\\varepsilon)) = 0\n$$\n使用一个小的容差 $\\tau = 10^{-12}$ 来检查 $|R(\\varepsilon)|  \\tau$ 是否成立，这是一个数值上的健全性检查，以确保实现中的浮点运算是一致的。\n\n对每个测试用例 $\\varepsilon$ 的计算步骤如下：\n1.  计算当前的降水效率 $\\varphi(\\varepsilon / \\varepsilon_{\\mathrm{ref}})$。\n2.  对于每个区域（BoB 和 CI）：\n    a. 使用差值 $\\varphi(\\varepsilon / \\varepsilon_{\\mathrm{ref}}) - \\varphi_0$ 和区域基准值（$E_0, C_0$）计算调整后的通量 $E(\\varepsilon)$ 和 $C(\\varepsilon)$。\n    b. 计算调整后的总降水量 $P(\\varepsilon)$。\n    c. 计算变化量 $\\Delta P$、$\\Delta E$ 和 $\\Delta C$。\n    d. 计算残差 $R(\\varepsilon)$ 并检查其绝对值是否小于容差 $\\tau$。\n3.  按指定顺序将两个区域的结果组合成一个列表：$[\\Delta P_{\\mathrm{BoB}}, \\Delta P_{\\mathrm{CI}}, \\Delta E_{\\mathrm{BoB}}, \\Delta E_{\\mathrm{CI}}, \\Delta C_{\\mathrm{BoB}}, \\Delta C_{\\mathrm{CI}}, B_{\\mathrm{BoB}}, B_{\\mathrm{CI}}]$。对测试套件中的所有夹带率重复此过程。",
            "answer": "[[0.45, 0.35, -0.045, -0.03375, 0.495, 0.38375, True, True], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, True, True], [-0.4, -0.31111111111111115, 0.04, 0.03, -0.44, -0.34111111111111115, True, True], [-0.5625, -0.4375, 0.05625, 0.0421875, -0.61875, -0.4796875, True, True]]"
        },
        {
            "introduction": "要全面理解季风，就必须能够诊断其变率，例如活跃期和中断期。这项高级实践练习利用位涡（PV）这一强大的动力学框架，深入探讨季风中断事件的动力学机制。通过构建和分析一个模拟的位涡收支，你将学习如何诊断来自中高纬度的高位涡空气入侵是如何抑制对流并导致季风中断的。这是一种在评估气候模式性能时经常使用的高级诊断方法。",
            "id": "4067465",
            "problem": "您的任务是构建并分析一个代表印度次大陆上空季风中断事件的等熵面上的合成位涡收支。目标是通过水平平流计算温带位涡丝状入侵对等熵位涡趋势的区域平均贡献，并量化它们在抑制对流中的作用。分析必须从厄特位涡定义和位涡收支方程开始，然后推导出一个数值上适定的算法，为每个测试用例产生一个单一的诊断数值。\n\n从干燥大气中的厄特位涡定义开始，\n$$\nq = \\frac{1}{\\rho}\\,\\boldsymbol{\\omega}_{a}\\cdot\\nabla\\theta,\n$$\n其中 $\\rho$ 是密度，$\\boldsymbol{\\omega}_{a}$ 是绝对涡度，$\\theta$ 是位温。在等熵面 $\\theta=\\theta_{0}$ 上，$q$ 的演变满足收支方程\n$$\n\\frac{\\partial q}{\\partial t} = -\\boldsymbol{u}\\cdot\\nabla q + S_{d} + S_{f},\n$$\n其中 $\\boldsymbol{u}$ 是等熵面上的水平风，$S_{d}$ 代表由加热或冷却（跨等熵面的质量通量）引起的位涡的非绝热生成或破坏，$S_{f}$ 代表摩擦源或汇。在季风中断期间，次大陆上空 $q$ 值的增加在动力学上与下沉运动和高层静力稳定度的增加相一致，这会抑制深对流。在本问题中，您将定量诊断由水平平流引起的等熵位涡趋势，分离出可归因于温带丝状入侵的部分，并在一个指定的次大陆区域内计算其区域平均值。\n\n建立一个经纬度网格，纬度 $\\phi$ 的范围为 $5$ 度到 $40$ 度，经度 $\\lambda$ 的范围为 $60$ 度到 $95$ 度，使用均匀间距 $\\Delta\\phi = 0.5$ 和 $\\Delta\\lambda = 0.5$。设地球半径为 $R = 6.371\\times 10^{6}$ 米。构建一个合成的基准位涡场，单位为位涡单位（PVU，其中 $1$ PVU $=10^{-6}\\ \\mathrm{K\\,m^{2}\\,kg^{-1}\\,s^{-1}}$），该场在低的季风值和高的温带值之间具有平滑的经向过渡，\n$$\nq_{\\mathrm{base}}(\\phi) = q_{\\ell} + \\frac{q_{h}-q_{\\ell}}{2}\\left[1+\\tanh\\left(\\frac{\\phi-\\phi_{0}}{s}\\right)\\right],\n$$\n其中 $q_{\\ell} = 0.7$，$q_{h} = 2.0$，$\\phi_{0} = 30$，$s = 2$。在此基准场上叠加一个理想化的温带丝状入侵，该入侵在等熵面上被建模为一个旋转的椭圆高斯函数，\n$$\nq_{\\mathrm{fil}}(\\phi,\\lambda) = A\\exp\\left(-\\left[\\left(\\frac{x'}{L}\\right)^{2}+\\left(\\frac{y'}{W}\\right)^{2}\\right]\\right),\n$$\n其中 $A$ 是丝状物的振幅（单位为 PVU），$L$ 是丝状物的半长（单位为度），$W$ 是丝状物的半宽（单位为度），$(x,y)=(\\lambda-\\lambda_{c},\\,\\phi-\\phi_{c})$ 是以 $(\\phi_{c},\\lambda_{c})$ 为中心的坐标，$(x',y')$ 是由下式给出的旋转坐标\n$$\nx' = x\\cos\\alpha + y\\sin\\alpha,\\quad y' = -x\\sin\\alpha + y\\cos\\alpha,\n$$\n方位角 $\\alpha$ 的单位为度。总位涡为 $q(\\phi,\\lambda)=q_{\\mathrm{base}}(\\phi)+q_{\\mathrm{fil}}(\\phi,\\lambda)$。\n\n指定一个代表季风中断期间对流层中层等熵面上的水平无辐散风场：一个均匀的西风分量和一个依赖于纬度的弱南风分量，\n$$\nu(\\phi,\\lambda) = u_{0},\\qquad v(\\phi,\\lambda) = -v_{0}\\exp\\left(-\\frac{(\\phi-\\phi_{c,v})^{2}}{\\sigma_{v}^{2}}\\right),\n$$\n其中 $u_{0}=20$ 米/秒，$v_{0}=5$ 米/秒，$\\phi_{c,v}=26$，$\\sigma_{v}=10$。使用中心有限差分法，在物理单位下计算水平平流项 $-\\boldsymbol{u}\\cdot\\nabla q = -\\left(u\\,\\frac{\\partial q}{\\partial x} + v\\,\\frac{\\partial q}{\\partial y}\\right)$。使用以下公式将经纬度导数转换为米：\n$$\n\\Delta x(\\phi) = R\\cos\\left(\\phi\\frac{\\pi}{180}\\right)\\,\\Delta\\lambda\\frac{\\pi}{180},\\qquad\n\\Delta y = R\\,\\Delta\\phi\\frac{\\pi}{180}.\n$$\n在区域边界使用单边差分。设次大陆诊断区域为纬度 $\\phi\\in[8,28]$ 和经度 $\\lambda\\in[68,88]$ 的网格单元集合。\n\n通过以下条件定义一个温带丝状物掩码：\n$$\nq(\\phi,\\lambda)\\ge q_{\\mathrm{th}},\\quad \\left\\|\\nabla q\\right\\|\\ge G_{\\mathrm{th}},\\quad \\phi\\ge \\phi_{\\mathrm{ex}},\n$$\n阈值为 $q_{\\mathrm{th}}=1.5$ PVU，$G_{\\mathrm{th}}=3\\times 10^{-6}$ PVU/米，以及 $\\phi_{\\mathrm{ex}}=20$。该掩码分离出来自温带、穿透到诊断区域内的高位涡、陡峭梯度特征。\n\n设诊断区域内的非绝热源项为均匀常数 $S_{d} = s_{d}$（单位为 PVU/小时），且 $S_{f}=0$。每个网格单元的面积元为\n$$\n\\Delta A(\\phi) = R^{2}\\cos\\left(\\phi\\frac{\\pi}{180}\\right)\\,\\Delta\\lambda\\frac{\\pi}{180}\\,\\Delta\\phi\\frac{\\pi}{180}.\n$$\n计算诊断区域内的区域平均平流趋势，\n$$\n\\langle \\mathcal{A} \\rangle = \\frac{\\sum_{\\mathrm{box}}\\left[-\\boldsymbol{u}\\cdot\\nabla q\\right]\\,\\Delta A}{\\sum_{\\mathrm{box}} \\Delta A},\n$$\n单位为 PVU/秒，并通过乘以 $3600$ 将其转换为 PVU/小时。通过用丝状物掩码对平流项进行加权，并按诊断区域总面积进行归一化，来计算区域平均的丝状物平流贡献，\n$$\n\\langle \\mathcal{A}_{\\mathrm{fil}} \\rangle = \\frac{\\sum_{\\mathrm{box}}\\left[-\\boldsymbol{u}\\cdot\\nabla q\\right]\\mathbb{1}_{\\mathrm{fil}}\\,\\Delta A}{\\sum_{\\mathrm{box}} \\Delta A}\\times 3600,\n$$\n单位为 PVU/小时，其中，当丝状物掩码为真时 $\\mathbb{1}_{\\mathrm{fil}}$ 为 $1$，否则为 $0$。该量作为温带丝状物入侵对等熵位涡趋势贡献的诊断量，并且根据物理解释，也作为对季风中断期间对流抑制的诊断量。\n\n您的程序必须实现以上步骤，并为每个测试用例生成单行输出，其中包含 $\\langle \\mathcal{A}_{\\mathrm{fil}} \\rangle$ 的值（单位为 PVU/小时，四舍五入到三位小数），格式为用方括号括起来的逗号分隔列表。\n\n使用以下参数集测试套件 $(A,W,L,\\alpha,\\phi_{c},\\lambda_{c},s_{d})$：\n\n- 案例 1（具有中等强度丝状物的一般季风中断）：$(1.2,\\ 2.0,\\ 8.0,\\ -30.0,\\ 24.0,\\ 75.0,\\ -0.05)$。\n- 案例 2（无丝状物入侵）：$(0.0,\\ 2.0,\\ 8.0,\\ -30.0,\\ 24.0,\\ 75.0,\\ -0.05)$。\n- 案例 3（强而窄的丝状物深度入侵）：$(2.5,\\ 1.0,\\ 8.0,\\ -20.0,\\ 26.0,\\ 78.0,\\ -0.03)$。\n- 案例 4（丝状物中心位于诊断区域以北，穿透有限）：$(1.8,\\ 1.5,\\ 8.0,\\ 0.0,\\ 31.0,\\ 75.0,\\ -0.04)$。\n\n角度单位必须为度。以 PVU/小时为单位表示最终诊断值，四舍五入到三位小数。您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，$[v_{1},v_{2},v_{3},v_{4}]$）。",
            "solution": "用户提供的问题已经过严格验证，并被确定为有效。该问题在科学上基于大气动力学，数学上是适定的，客观且自洽。所提供的参数和方程足以构建唯一的数值解。风场被标记为“无辐散”而实际上并非如此，这一微小的描述不一致性并不妨碍明确的计算任务，因为所提供的风分量公式是明确的。因此，我们可以继续进行求解。\n\n解决方案是构建一个数值算法，该算法模拟指定的大气状态并计算诊断量 $\\langle \\mathcal{A}_{\\mathrm{fil}} \\rangle$。对测试套件中提供的每组参数执行此过程。\n\n首先，我们建立计算域和网格。计算域的纬度范围为 $\\phi \\in [5^\\circ, 40^\\circ]$，经度范围为 $\\lambda \\in [60^\\circ, 95^\\circ]$。我们使用间距为 $\\Delta\\phi = 0.5^\\circ$ 和 $\\Delta\\lambda = 0.5^\\circ$ 的均匀网格对此域进行离散化。所有计算都将在对应于此网格的二维数组上执行。地球半径取为 $R = 6.371\\times 10^{6}$ 米。\n\n对于由参数 $(A,W,L,\\alpha,\\phi_{c},\\lambda_{c},s_{d})$ 指定的每个测试用例，构建总位涡（PV）场 $q(\\phi,\\lambda)$。它是基准场 $q_{\\mathrm{base}}(\\phi)$ 和丝状物扰动 $q_{\\mathrm{fil}}(\\phi,\\lambda)$ 的和。\n基准场模拟背景经向PV梯度，由下式给出：\n$$\nq_{\\mathrm{base}}(\\phi) = q_{\\ell} + \\frac{q_{h}-q_{\\ell}}{2}\\left[1+\\tanh\\left(\\frac{\\phi-\\phi_{0}}{s}\\right)\\right]\n$$\n其中常数参数为 $q_{\\ell} = 0.7$ PVU，$q_{h} = 2.0$ PVU，$\\phi_{0} = 30^\\circ$，$s = 2$。\n\n丝状物代表温带入侵，被建模为一个旋转的椭圆高斯函数：\n$$\nq_{\\mathrm{fil}}(\\phi,\\lambda) = A\\exp\\left(-\\left[\\left(\\frac{x'}{L}\\right)^{2}+\\left(\\frac{y'}{W}\\right)^{2}\\right]\\right)\n$$\n此处，$(A, W, L, \\alpha, \\phi_c, \\lambda_c)$ 是特定案例的振幅、半宽、半长、方位角和中心坐标参数。旋转坐标 $(x', y')$ 是通过标准旋转从相对于丝状物中心的网格坐标 $(x, y) = (\\lambda - \\lambda_c, \\phi - \\phi_c)$ 计算得出的：\n$$\nx' = x\\cos\\alpha + y\\sin\\alpha \\\\\ny' = -x\\sin\\alpha + y\\cos\\alpha\n$$\n注意，角度 $\\alpha$ 在用于三角函数之前必须从度转换为弧度。那么总PV场为 $q = q_{\\mathrm{base}} + q_{\\mathrm{fil}}$。\n\n接下来，在网格上构建指定的风场。纬向分量是一个常数 $u(\\phi, \\lambda) = u_{0} = 20$ 米/秒。经向分量是一个依赖于纬度的函数：\n$$\nv(\\phi,\\lambda) = -v_{0}\\exp\\left(-\\frac{(\\phi-\\phi_{c,v})^{2}}{\\sigma_{v}^{2}}\\right)\n$$\n其中 $v_{0} = 5$ 米/秒，$\\phi_{c,v} = 26^\\circ$，$\\sigma_{v} = 10$。\n\n诊断的核心是位涡的水平平流，$-\\boldsymbol{u}\\cdot\\nabla q$。为了计算这个量，我们首先需要物理单位（PVU/米）下的PV场梯度 $\\nabla q$。我们采用有限差分法。关于物理坐标 $(x, y)$ 的偏导数通过球坐标系的度量项与关于网格坐标 $(\\lambda, \\phi)$ 的导数相关联：\n$$\n\\frac{\\partial q}{\\partial x} = \\frac{1}{R\\cos(\\phi_{\\mathrm{rad}})}\\frac{\\partial q}{\\partial \\lambda_{\\mathrm{rad}}} \\quad , \\quad \\frac{\\partial q}{\\partial y} = \\frac{1}{R}\\frac{\\partial q}{\\partial \\phi_{\\mathrm{rad}}}\n$$\n在数值上，我们计算离散 $q$ 场相对于网格索引的梯度，这近似于相对于网格坐标的导数。然后，我们除以对应于一个网格步长的物理距离。我们使用一个标准的数值梯度函数，它对内部网格点实现中心差分，并在边界处实现单边差分。物理网格间距为 $\\Delta y = R\\,\\Delta\\phi_{\\mathrm{rad}}$（常数）和 $\\Delta x(\\phi) = R\\cos(\\phi_{\\mathrm{rad}})\\,\\Delta\\lambda_{\\mathrm{rad}}$（依赖于纬度）。\n一旦梯度分量 $\\frac{\\partial q}{\\partial x}$ 和 $\\frac{\\partial q}{\\partial y}$ 已知，就在每个网格点上计算平流场：\n$$\n\\mathcal{A}(\\phi, \\lambda) = -\\boldsymbol{u}\\cdot\\nabla q = -\\left(u\\,\\frac{\\partial q}{\\partial x} + v\\,\\frac{\\partial q}{\\partial y}\\right)\n$$\n结果是一个二维数组，表示由平流引起的PV趋势（单位为PVU/秒）。\n\n为了分离丝状物入侵的贡献，创建了一个丝状物掩码 $\\mathbb{1}_{\\mathrm{fil}}$。这是一个二元场，在满足以下所有三个条件的网格点上等于 $1$，否则等于 $0$：\n1.  $q(\\phi,\\lambda) \\ge q_{\\mathrm{th}} = 1.5$ PVU\n2.  $\\|\\nabla q\\| \\ge G_{\\mathrm{th}} = 3\\times 10^{-6}$ PVU/米，其中 $\\|\\nabla q\\| = \\sqrt{(\\frac{\\partial q}{\\partial x})^2 + (\\frac{\\partial q}{\\partial y})^2}$\n3.  $\\phi \\ge \\phi_{\\mathrm{ex}} = 20^\\circ$\n\n最后，我们计算指定次大陆诊断区域（$\\phi\\in[8,28]^\\circ$，$\\lambda\\in[68,88]^\\circ$）上的区域平均丝状物平流贡献。这涉及一个加权平均，其中平流项由丝状物掩码加权，并且平均值由诊断区域的总面积归一化。每个网格单元的面积元为 $\\Delta A(\\phi) = R^{2}\\cos(\\phi_{\\mathrm{rad}})\\,\\Delta\\lambda_{\\mathrm{rad}}\\,\\Delta\\phi_{\\mathrm{rad}}$。诊断量为：\n$$\n\\langle \\mathcal{A}_{\\mathrm{fil}} \\rangle = \\frac{\\sum_{\\mathrm{box}}\\left[\\mathcal{A}(\\phi, \\lambda)\\right]\\,\\mathbb{1}_{\\mathrm{fil}}(\\phi,\\lambda)\\,\\Delta A(\\phi)}{\\sum_{\\mathrm{box}} \\Delta A(\\phi)}\n$$\n求和 $\\sum_{\\mathrm{box}}$ 是对诊断区域内的所有网格单元进行的。结果最初以 PVU/s 为单位，乘以 $3600$ 以获得以 PVU/小时为单位的最终值，然后四舍五入到三位小数。对四个测试用例中的每一个都重复此整个过程。",
            "answer": "[0.019, 0.0, 0.04, -0.0]"
        }
    ]
}