{
    "hands_on_practices": [
        {
            "introduction": "地球气候系统的主要能量来源是太阳辐射。理解太阳辐射如何在大气层顶（TOA）分布，是研究地球能量收支的第一步。本练习 () 要求从球体几何学的基本原理出发，推导出日平均太阳入射辐射的解析表达式，这将加深您对决定气候模式和季节变化的关键驱动因素——纬度和太阳赤纬——之间关系的理解。",
            "id": "4033595",
            "problem": "考虑一个自转速率和几何形状与地球相同的行星。在没有大气层的情况下，入射到当地水平面上的瞬时大气层顶（TOA）短波辐照度与太阳天顶角的余弦成正比。设一个天文单位处的总太阳辐照度（TSI）为 $S_0$，并假设在一个太阳日内其为常数。设纬度为 $\\phi$，太阳赤纬为 $\\delta$，地方时角为 $h$（在地方太阳正午时为零），日落时角为 $H_0$。所有角度均以弧度为单位。\n\n从地日构造和行星均速自转的球面几何第一性原理出发，推导在给定太阳赤纬 $\\delta$ 和日落时角 $H_0$ 的情况下，纬度 $\\phi$ 处的日均大气层顶日照 $Q(\\phi,\\delta)$ 的闭式解析表达式。您的推导必须：\n\n- 从日均辐照度的定义（即一个太阳日内的时间平均）开始，使用太阳天顶角的余弦来表示太阳光束在当地水平面上的投影。\n- 仅使用适用于地日系统的基本几何关系和均速自转的假设，将积分变量从时间转换为时角。\n- 明确陈述所使用的所有假设，包括关于行星球形、无大气效应、$S_0$ 在一天内恒定不变，以及通过给定的 $H_0$ 处理极昼或极夜的假设。\n\n将您的最终答案表示为包含 $S_0$、$\\phi$、$\\delta$ 和 $H_0$ 的单个闭式解析表达式。无需进行数值计算。所有角度必须以弧度为单位，日均日照必须以瓦特每平方米为单位表示。无需四舍五入；请提供精确表达式。",
            "solution": "该问题要求推导在给定纬度 $\\phi$ 和太阳赤纬 $\\delta$ 下，日均大气层顶（TOA）日照 $Q(\\phi,\\delta)$ 的闭式解析表达式。推导将按规定从第一性原理出发。\n\n首先，我们将日均日照 $Q$ 定义为在一个太阳日内单位面积接收的总能量除以该日的时间长度 $T_d$。一个太阳日对应于时角 $2\\pi$ 的旋转。水平面上的瞬时日照 $I$ 是总太阳辐照度（$S_0$）垂直于该平面的分量。其表达式为 $I = S_0 \\cos(\\theta_z)$，其中 $\\theta_z$ 是太阳天顶角。只有当太阳在地平线以上时，即当 $\\cos(\\theta_z) > 0$ 时，日照才不为零。\n\n因此，日均日照是在一个持续时间为 $T_d$ 的完整太阳日内对瞬时日照的时间平均：\n$$ Q = \\frac{1}{T_d} \\int_{0}^{T_d} I(t) dt = \\frac{1}{T_d} \\int_{\\text{sunrise}}^{\\text{sunset}} S_0 \\cos(\\theta_z(t)) dt $$\n积分范围为白昼时段，从日出到日落，因为夜间 $I(t) = 0$。\n\n下一步是将太阳天顶角 $\\theta_z$ 用观测者纬度 $\\phi$、太阳赤纬 $\\delta$ 和地方时角 $h$ 来表示。对天球上由天极、天顶和太阳构成的三角形使用球面余弦定律，我们得到基本关系式：\n$$ \\cos(\\theta_z) = \\sin(\\phi)\\sin(\\delta) + \\cos(\\phi)\\cos(\\delta)\\cos(h) $$\n时角 $h$ 定义为在地方太阳正午时为零，并随时间增加。\n\n假设行星以匀角速度 $\\Omega = 2\\pi/T_d$ 自转。时角 $h$ 与时间 $t$（从地方正午开始测量）的关系为 $h = \\Omega t$。这使得我们可以在积分中进行变量替换，从时间 $t$ 替换为时角 $h$。求导可得 $dh = \\Omega dt$，即 $dt = \\frac{dh}{\\Omega}$。我们也可以将周期表示为 $T_d = 2\\pi/\\Omega$。将这些代入 $Q$ 的表达式中：\n$$ Q = \\frac{\\Omega}{2\\pi} \\int_{t_{\\text{sunrise}}}^{t_{\\text{sunset}}} S_0 \\cos(\\theta_z(t)) dt $$\n将积分变量更改为 $h$：\n$$ Q = \\frac{\\Omega}{2\\pi} \\int_{h_{\\text{sunrise}}}^{h_{\\text{sunset}}} S_0 (\\sin(\\phi)\\sin(\\delta) + \\cos(\\phi)\\cos(\\delta)\\cos(h)) \\frac{dh}{\\Omega} $$\n日落时角给定为 $H_0$。根据对称性，日出时角为 $-H_0$。以时角表示的积分限为从 $-H_0$ 到 $H_0$。\n$$ Q = \\frac{S_0}{2\\pi} \\int_{-H_0}^{H_0} (\\sin(\\phi)\\sin(\\delta) + \\cos(\\phi)\\cos(\\delta)\\cos(h)) dh $$\n被积函数是 $h$ 的偶函数，因为 $\\cos(h) = \\cos(-h)$。因此，我们可以简化积分为：\n$$ Q = 2 \\cdot \\frac{S_0}{2\\pi} \\int_{0}^{H_0} (\\sin(\\phi)\\sin(\\delta) + \\cos(\\phi)\\cos(\\delta)\\cos(h)) dh $$\n$$ Q = \\frac{S_0}{\\pi} \\int_{0}^{H_0} (\\sin(\\phi)\\sin(\\delta) + \\cos(\\phi)\\cos(\\delta)\\cos(h)) dh $$\n现在我们可以将积分分成两部分来计算：\n$$ Q = \\frac{S_0}{\\pi} \\left[ \\int_{0}^{H_0} \\sin(\\phi)\\sin(\\delta) dh + \\int_{0}^{H_0} \\cos(\\phi)\\cos(\\delta)\\cos(h) dh \\right] $$\n第一个积分是：\n$$ \\int_{0}^{H_0} \\sin(\\phi)\\sin(\\delta) dh = \\sin(\\phi)\\sin(\\delta) [h]_{0}^{H_0} = H_0 \\sin(\\phi)\\sin(\\delta) $$\n第二个积分是：\n$$ \\int_{0}^{H_0} \\cos(\\phi)\\cos(\\delta)\\cos(h) dh = \\cos(\\phi)\\cos(\\delta) \\int_{0}^{H_0} \\cos(h) dh = \\cos(\\phi)\\cos(\\delta) [\\sin(h)]_{0}^{H_0} = \\cos(\\phi)\\cos(\\delta)\\sin(H_0) $$\n将这些结果代回 $Q$ 的表达式中：\n$$ Q(\\phi,\\delta) = \\frac{S_0}{\\pi} [H_0 \\sin(\\phi)\\sin(\\delta) + \\cos(\\phi)\\cos(\\delta)\\sin(H_0)] $$\n这就是日均大气层顶日照的最终闭式解析表达式。\n\n此推导过程中作出的假设如下：\n1.  行星是一个完美的球体，从而可以使用球面三角学。\n2.  不存在大气层，意味着入射的太阳辐射没有吸收、散射或折射。\n3.  总太阳辐照度 $S_0$ 在一个太阳日内是恒定的。这是一个合理的近似，因为行星与太阳的距离在24小时内变化很小。\n4.  太阳赤纬 $\\delta$ 在一个太阳日内是恒定的。鉴于地球自转轴相对于其轨道平面的变化缓慢，这也是一个有效的近似。\n5.  行星以匀角速度 $\\Omega$ 自转。\n6.  日落时角 $H_0$ 是一个给定参数。该参数涵盖了正常昼夜循环（$0  H_0  \\pi$）、连续极昼（$H_0 = \\pi$）和连续极夜（$H_0 = 0$）的情况。当 $H_0 = 0$ 时，表达式正确地得出 $Q=0$。当 $H_0 = \\pi$ 时，表达式给出24小时白昼的日照。\n\n所有表示角度的变量（$\\phi$, $\\delta$, $h$, $H_0$）均以弧度为单位，这与它们在三角函数和积分过程中的使用相一致。最终表达式的单位是瓦特每平方米，继承自 $S_0$。",
            "answer": "$$\n\\boxed{\\frac{S_0}{\\pi} \\left( H_0 \\sin(\\phi)\\sin(\\delta) + \\cos(\\phi)\\cos(\\delta)\\sin(H_0) \\right)}\n$$"
        },
        {
            "introduction": "在理解了能量输入之后，下一步是模拟气候系统如何响应能量收支的变化。本练习 () 运用一个简化的单箱能量平衡模型（EBM），揭示了气候响应的核心动态。通过推导一个受非瞬时辐射强迫 $F(t)$ 作用下系统的瞬态温度演变 $T(t)$，您将掌握平衡态气候敏感度等关键概念是如何由反馈参数 $\\lambda$ 决定的，并理解系统的热容 $C$ 如何调节其达到新平衡态的时间尺度。",
            "id": "4033508",
            "problem": "考虑一个用于地球气候系统的全球平均单箱能量平衡模型（EBM），该模型由一个有效热储库（热容为 $C$，单位：$\\mathrm{J\\,m^{-2}\\,K^{-1}}$）和一个线性反馈参数 $\\lambda$（单位：$\\mathrm{W\\,m^{-2}\\,K^{-1}}$）与大气层顶辐射收支耦合而成。能量守恒意味着全球平均地表气温异常 $T(t)$（单位：$\\mathrm{K}$）的变化率满足 $C\\,\\frac{dT}{dt} = N(t)$，其中 $N(t)$（单位：$\\mathrm{W\\,m^{-2}}$）是净辐射不平衡。在线性反馈框架中，净不平衡由 $N(t) = F(t) - \\lambda\\,T(t)$ 给出，其中 $F(t)$（单位：$\\mathrm{W\\,m^{-2}}$）是外部施加的辐射强迫。假设 $C  0$ 且 $\\lambda  0$。设辐射强迫在一个特征强迫时间尺度 $\\tau_{f}  0$（单位：$\\mathrm{s}$）上从 $0$ 平滑增加到一个恒定的渐近振幅 $F_{\\infty}$（单位：$\\mathrm{W\\,m^{-2}}$），其变化规律为 $F(t) = F_{\\infty}\\,\\big(1 - \\exp(-t/\\tau_{f})\\big)$（对于 $t \\ge 0$）。初始条件为 $T(0) = 0$。定义内在气候响应时间尺度 $\\tau \\equiv C/\\lambda$（单位：$\\mathrm{s}$）。\n\n仅从上述物理原理出发，推导：\n- 单位强迫的平衡气候敏感度，定义为在极限 $t \\to \\infty$ 下，对于恒定强迫振幅 $F_{\\infty}$ 的 $S_{\\mathrm{eq}} \\equiv \\frac{dT_{\\mathrm{eq}}}{dF_{\\infty}}$，以 $\\mathrm{K\\,(W\\,m^{-2})^{-1}}$ 为单位表示。\n- 在指定的强迫 $F(t)$ 下，对于 $t \\ge 0$ 的精确瞬态全球平均温度异常 $T(t)$（单位：$\\mathrm{K}$），用 $C$, $\\lambda$, $\\tau_{f}$, $F_{\\infty}$ 和 $t$ 表示。\n\n假设一般情况 $\\tau_{f} \\ne \\tau$。提供闭合形式的解析表达式。无需进行数值计算或四舍五入。将最终的敏感度以 $\\mathrm{K\\,(W\\,m^{-2})^{-1}}$ 为单位表示，瞬态温度以 $\\mathrm{K}$ 为单位表示。对于最终答案，请将两个结果按 $\\big(S_{\\mathrm{eq}},\\,T(t)\\big)$ 的顺序写成一个单行矩阵。",
            "solution": "该模型由具有线性反馈的全球能量平衡方程控制：\n$$\nC\\,\\frac{dT}{dt} \\;=\\; F(t) \\;-\\; \\lambda\\,T(t),\n$$\n其中 $F(t) = F_{\\infty}\\,\\big(1 - \\exp(-t/\\tau_{f})\\big)$，$C  0$，$\\lambda  0$ 且 $T(0) = 0$。定义内在响应时间尺度 $\\tau \\equiv \\frac{C}{\\lambda}  0$。这是一个带时变强迫的线性、一阶、非齐次常微分方程。\n\n单位强迫的平衡气候敏感度。在恒定强迫振幅 $F_{\\infty}$ 下达到平衡时，时间导数消失（当 $t \\to \\infty$ 时，$\\frac{dT}{dt} \\to 0$），净通量条件变为\n$$\n0 \\;=\\; F_{\\infty} \\;-\\; \\lambda\\,T_{\\mathrm{eq}},\n$$\n因此\n$$\nT_{\\mathrm{eq}} \\;=\\; \\frac{F_{\\infty}}{\\lambda}.\n$$\n单位强迫的平衡气候敏感度定义为\n$$\nS_{\\mathrm{eq}} \\;\\equiv\\; \\frac{dT_{\\mathrm{eq}}}{dF_{\\infty}} \\;=\\; \\frac{1}{\\lambda},\n$$\n单位为 $\\mathrm{K\\,(W\\,m^{-2})^{-1}}$。这表明平衡敏感度完全由反馈强度决定，与 $C$ 无关。\n\n瞬态解。将趋势方程重写为标准线性形式：\n$$\n\\frac{dT}{dt} \\;+\\; \\frac{\\lambda}{C}\\,T \\;=\\; \\frac{F(t)}{C} \\;=\\; \\frac{F_{\\infty}}{C}\\,\\Big(1 - \\exp(-t/\\tau_{f})\\Big).\n$$\n积分因子为\n$$\n\\mu(t) \\;=\\; \\exp\\!\\left(\\int \\frac{\\lambda}{C}\\,dt\\right) \\;=\\; \\exp\\!\\left(\\frac{\\lambda}{C}\\,t\\right) \\;=\\; \\exp\\!\\left(\\frac{t}{\\tau}\\right).\n$$\n乘以 $\\mu(t)$ 并从 $0$ 到 $t$ 积分，利用 $T(0) = 0$，得到\n$$\nT(t) \\;=\\; \\exp\\!\\left(-\\frac{t}{\\tau}\\right)\\,\n\\int_{0}^{t} \\exp\\!\\left(\\frac{s}{\\tau}\\right)\\,\\frac{F_{\\infty}}{C}\\,\\Big(1 - \\exp(-s/\\tau_{f})\\Big)\\,ds.\n$$\n将积分分成两部分：\n$$\nI_{1}(t) \\;=\\; \\int_{0}^{t} \\exp\\!\\left(\\frac{s}{\\tau}\\right)\\,ds \\;=\\; \\tau\\,\\Big(\\exp\\!\\left(\\frac{t}{\\tau}\\right) - 1\\Big),\n$$\n和\n$$\nI_{2}(t) \\;=\\; \\int_{0}^{t} \\exp\\!\\left(\\frac{s}{\\tau}\\right)\\,\\exp\\!\\left(-\\frac{s}{\\tau_{f}}\\right)\\,ds\n\\;=\\; \\int_{0}^{t} \\exp\\!\\left(s\\left(\\frac{1}{\\tau} - \\frac{1}{\\tau_{f}}\\right)\\right)\\,ds.\n$$\n定义 $\\alpha \\equiv \\frac{1}{\\tau} - \\frac{1}{\\tau_{f}}$。在所述的一般情况 $\\tau_{f} \\ne \\tau$ 下，我们有 $\\alpha \\ne 0$ 并且\n$$\nI_{2}(t) \\;=\\; \\frac{\\exp\\!\\left(\\alpha\\,t\\right) - 1}{\\alpha}.\n$$\n因此，\n$$\nT(t) \\;=\\; \\exp\\!\\left(-\\frac{t}{\\tau}\\right)\\,\\frac{F_{\\infty}}{C}\\,\\Big[\\,I_{1}(t) - I_{2}(t)\\,\\Big]\n\\;=\\; \\exp\\!\\left(-\\frac{t}{\\tau}\\right)\\,\\frac{F_{\\infty}}{C}\\,\\left[\\,\\tau\\left(\\exp\\!\\left(\\frac{t}{\\tau}\\right) - 1\\right) \\;-\\; \\frac{\\exp\\!\\left(\\alpha\\,t\\right) - 1}{\\alpha}\\,\\right].\n$$\n逐项简化。首先，$\\exp\\!\\left(-\\frac{t}{\\tau}\\right)\\,\\tau\\left(\\exp\\!\\left(\\frac{t}{\\tau}\\right) - 1\\right) = \\tau\\left(1 - \\exp\\!\\left(-\\frac{t}{\\tau}\\right)\\right)$。接下来，观察到\n$$\n\\exp\\!\\left(-\\frac{t}{\\tau}\\right)\\,\\Big(\\exp\\!\\left(\\alpha\\,t\\right) - 1\\Big)\n\\;=\\; \\exp\\!\\left(t\\left(\\alpha - \\frac{1}{\\tau}\\right)\\right) - \\exp\\!\\left(-\\frac{t}{\\tau}\\right)\n\\;=\\; \\exp\\!\\left(-\\frac{t}{\\tau_{f}}\\right) - \\exp\\!\\left(-\\frac{t}{\\tau}\\right),\n$$\n因为 $\\alpha - \\frac{1}{\\tau} = -\\frac{1}{\\tau_{f}}$。此外，$\\alpha = \\frac{1}{\\tau} - \\frac{1}{\\tau_{f}} = \\frac{\\tau_{f} - \\tau}{\\tau\\,\\tau_{f}}$，所以 $\\frac{1}{\\alpha} = \\frac{\\tau\\,\\tau_{f}}{\\tau_{f} - \\tau}$。将这些放在一起，\n$$\nT(t) \\;=\\; \\frac{F_{\\infty}}{C}\\,\\left[\\,\\tau\\left(1 - \\exp\\!\\left(-\\frac{t}{\\tau}\\right)\\right)\n\\;-\\; \\frac{\\tau\\,\\tau_{f}}{\\tau_{f} - \\tau}\\left(\\exp\\!\\left(-\\frac{t}{\\tau_{f}}\\right) - \\exp\\!\\left(-\\frac{t}{\\tau}\\right)\\right)\\,\\right].\n$$\n使用 $\\frac{F_{\\infty}}{C}\\,\\tau = \\frac{F_{\\infty}}{\\lambda}$ 和 $\\frac{F_{\\infty}}{C}\\,\\tau\\,\\tau_{f} = \\frac{F_{\\infty}\\,\\tau_{f}}{\\lambda}$，\n$$\nT(t) \\;=\\; \\frac{F_{\\infty}}{\\lambda}\\,\\left[\\,1 - \\exp\\!\\left(-\\frac{t}{\\tau}\\right)\n\\;-\\; \\frac{\\tau_{f}}{\\tau_{f} - \\tau}\\,\\exp\\!\\left(-\\frac{t}{\\tau_{f}}\\right)\n\\;+\\; \\frac{\\tau_{f}}{\\tau_{f} - \\tau}\\,\\exp\\!\\left(-\\frac{t}{\\tau}\\right)\\,\\right].\n$$\n合并 $\\exp\\!\\left(-\\frac{t}{\\tau}\\right)$ 项，系数为 $-1 + \\frac{\\tau_{f}}{\\tau_{f} - \\tau} = \\frac{\\tau}{\\tau_{f} - \\tau}$。因此得到紧凑形式\n$$\nT(t) \\;=\\; \\frac{F_{\\infty}}{\\lambda}\\,\\left[\\,1\n\\;-\\; \\frac{\\tau_{f}}{\\tau_{f} - \\tau}\\,\\exp\\!\\left(-\\frac{t}{\\tau_{f}}\\right)\n\\;+\\; \\frac{\\tau}{\\tau_{f} - \\tau}\\,\\exp\\!\\left(-\\frac{t}{\\tau}\\right)\\,\\right],\n$$\n这明确地展示了瞬态响应对系统热容（通过 $\\tau = C/\\lambda$）和强迫时间尺度 $\\tau_{f}$ 的依赖性。在极限 $t \\to \\infty$ 下，两个指数项都消失，恢复到 $T_{\\mathrm{eq}} = \\frac{F_{\\infty}}{\\lambda}$，从而得到 $S_{\\mathrm{eq}} = \\frac{1}{\\lambda}$。\n\n单位。表达式 $S_{\\mathrm{eq}} = \\frac{1}{\\lambda}$ 的单位是 $\\mathrm{K\\,(W\\,m^{-2})^{-1}}$，$T(t)$ 的单位是 $\\mathrm{K}$，符合要求。",
            "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{\\lambda}  \\frac{F_{\\infty}}{\\lambda}\\left[1-\\frac{\\tau_{f}}{\\tau_{f}-\\tau}\\,\\exp\\!\\left(-\\frac{t}{\\tau_{f}}\\right)+\\frac{\\tau}{\\tau_{f}-\\tau}\\,\\exp\\!\\left(-\\frac{t}{\\tau}\\right)\\right]\\end{pmatrix}}$$"
        },
        {
            "introduction": "气候系统对强迫的响应被各种反馈机制显著放大或抑制，其中冰-反照率反馈是关键之一。本练习 () 提供了一个将这一重要物理过程付诸实践的机会，要求您通过编程来量化由变暖引起的积雪减少所导致的额外太阳能吸收。通过处理光谱反照率和季节性数据，您将具体了解地表特性如何影响地球的能量收支，并获得评估气候模型中反馈强度的实用技能。",
            "id": "4033588",
            "problem": "考虑一个中纬度陆地区域，其地表由积雪和无雪地面镶嵌而成。吸收的地面短波（SW）辐射通量由能量守恒和反照率的定义决定。在平行平面几何、朗伯反射、反射率的线性亚网格混合，以及在指定的增温条件下入射辐射场或内在光学特性不变的假设下，吸收的地面短波辐射可以通过对整个短波光谱上的向下光谱辐照度进行积分得到，积分时使用（1 - 地表光谱反照率）作为权重。为了近似该积分，光谱维度被离散为少数几个波段。均匀增温仅改变月度积雪覆盖率。任务是，在所有其他输入保持不变的情况下，计算由于幅度为 $\\Delta T$ 的均匀增温所引起的积雪覆盖率变化而导致的吸收地面短波辐射的年平均变化。\n\n提供了三个测试案例的输入数据。在每个案例中，短波光谱被离散为 $B=3$ 个波段：紫外（波段指数 $b=0$）、可见光（$b=1$）和近红外（$b=2$）。以下定义和数据适用：\n\n- 对于代表一月至十二月的月份指数 $m \\in \\{0,1,\\dots,11\\}$，令 $Q_m$ 表示月平均向下宽带地面短波辐照度，单位为 $\\mathrm{W\\,m^{-2}}$。波段 $b$ 的月平均地表向下光谱辐照度为 $I_{m,b} = Q_m \\cdot w_b$，其中 $w_b$ 是固定的波段权重，其总和为 $1$。\n- 令 $\\alpha_{\\mathrm{snow},b}$ 和 $\\alpha_{\\mathrm{ground},b}$ 分别表示波段 $b$ 的积雪和无雪地面的光谱反照率（无量纲）。\n- 令 $f_m$ 表示增温前的月度积雪覆盖率（无量纲）。在幅度为 $\\Delta T$（单位为 $\\mathrm{K}$）的均匀增温下，积雪覆盖率变为 $f'_m = \\min\\{\\max\\{f_m + s \\cdot \\Delta T, 0\\}, 1\\}$，其中 $s$ 是一个给定的常数敏感度（单位温度下积雪覆盖率的变化，单位为 $\\mathrm{K^{-1}}$），该敏感度在时间上均匀应用，并且该操作强制积雪覆盖率处于物理上允许的界限内。\n- 月份 $m$ 波段 $b$ 的混合像元光谱反照率在增温前为 $\\alpha_{m,b} = f_m \\,\\alpha_{\\mathrm{snow},b} + (1-f_m)\\,\\alpha_{\\mathrm{ground},b}$，增温后为 $\\alpha'_{m,b} = f'_m \\,\\alpha_{\\mathrm{snow},b} + (1-f'_m)\\,\\alpha_{\\mathrm{ground},b}$。\n- 增温前后的月平均吸收地面短波辐射分别为 $A_m = \\sum_{b=0}^{B-1} I_{m,b}\\,\\left(1-\\alpha_{m,b}\\right)$ 和 $A'_m = \\sum_{b=0}^{B-1} I_{m,b}\\,\\left(1-\\alpha'_{m,b}\\right)$，单位均为 $\\mathrm{W\\,m^{-2}}$。\n- 年平均吸收地面短波辐射是通过使用格里高利历的月份天数 $d_m$（单位为天）对月平均值进行时间平均得到的：$\\overline{A} = \\dfrac{\\sum_{m=0}^{11} d_m\\,A_m}{\\sum_{m=0}^{11} d_m}$ 和 $\\overline{A'} = \\dfrac{\\sum_{m=0}^{11} d_m\\,A'_m}{\\sum_{m=0}^{11} d_m}$。所需的诊断量是吸收短波辐射的年平均变化，$\\Delta \\overline{A} = \\overline{A'} - \\overline{A}$，以 $\\mathrm{W\\,m^{-2}}$ 表示。\n\n您的程序必须为以下三个测试案例中的每一个计算 $\\Delta \\overline{A}$。对于所有案例，请使用格里高利历的月份天数 $d_m = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31]$（单位为天）。\n\n通用波段权重和光谱反照率（适用于所有测试案例）：\n- 波段权重 $w_b = [0.05, 0.50, 0.45]$（无量纲），按紫外、可见光、近红外排序。\n- 积雪光谱反照率 $\\alpha_{\\mathrm{snow},b} = [0.90, 0.85, 0.55]$（无量纲）。\n- 地面光谱反照率 $\\alpha_{\\mathrm{ground},b} = [0.12, 0.20, 0.35]$（无量纲）。\n\n测试案例 1（季节性积雪，典型的中纬度）：\n- 月度 $Q_m$（单位 $\\mathrm{W\\,m^{-2}}$）：$[120, 160, 220, 260, 300, 320, 310, 280, 220, 180, 140, 110]$。\n- 月度 $f_m$（无量纲）：$[0.60, 0.50, 0.40, 0.20, 0.05, 0.00, 0.00, 0.00, 0.05, 0.20, 0.40, 0.55]$。\n- 敏感度 $s = -0.08$（单位 $\\mathrm{K^{-1}}$）。\n- 增温幅度 $\\Delta T = 2.0$（单位 $\\mathrm{K}$）。\n\n测试案例 2（无雪的中纬度）：\n- 月度 $Q_m$（单位 $\\mathrm{W\\,m^{-2}}$）：$[120, 160, 220, 260, 300, 320, 310, 280, 220, 180, 140, 110]$。\n- 月度 $f_m$（无量纲）：$[0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00]$。\n- 敏感度 $s = -0.08$（单位 $\\mathrm{K^{-1}}$）。\n- 增温幅度 $\\Delta T = 2.0$（单位 $\\mathrm{K}$）。\n\n测试案例 3（积雪主导的中纬度高原）：\n- 月度 $Q_m$（单位 $\\mathrm{W\\,m^{-2}}$）：$[90, 130, 200, 260, 290, 300, 290, 260, 210, 160, 110, 80]$。\n- 月度 $f_m$（无量纲）：$[0.95, 0.90, 0.85, 0.60, 0.20, 0.05, 0.05, 0.10, 0.40, 0.70, 0.85, 0.90]$。\n- 敏感度 $s = -0.06$（单位 $\\mathrm{K^{-1}}$）。\n- 增温幅度 $\\Delta T = 2.0$（单位 $\\mathrm{K}$）。\n\n要求：\n- 按照描述实现计算，通过在边界处截断来强制 $f'_m \\in [0,1]$。\n- 以 $\\mathrm{W\\,m^{-2}}$ 为单位表示每个测试案例的最终结果 $\\Delta \\overline{A}$，并四舍五入到三位小数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[x_1,x_2,x_3]$），$x_i$ 分别是测试案例 1、2 和 3 的三个四舍五入后的值。",
            "solution": "问题陈述已经过验证，被认为是有效的。它在科学上基于辐射传输和气候物理学原理，在数学上是适定的、内部一致的，并包含计算唯一解所需的所有必要信息。\n\n目标是计算因均匀增温 $\\Delta T$ 导致的积雪覆盖率变化而引起的吸收地面短波（SW）辐射的年平均变化，记为 $\\Delta \\overline{A}$。所求量定义为：\n$$\n\\Delta \\overline{A} = \\overline{A'} - \\overline{A}\n$$\n其中 $\\overline{A}$ 和 $\\overline{A'}$ 分别是增温前后的年平均吸收地面短波辐射。\n\n年平均是一种线性运算。年平均值的变化等于月变化的年平均值。令 $\\Delta A_m = A'_m - A_m$ 为月份 $m$ 吸收短波辐射的变化。那么，年平均变化为：\n$$\n\\Delta \\overline{A} = \\frac{\\sum_{m=0}^{11} d_m \\Delta A_m}{\\sum_{m=0}^{11} d_m}\n$$\n其中 $d_m$ 是月份 $m$ 的天数。\n\n我们首先推导月度变化 $\\Delta A_m$ 的表达式。增温前（$A_m$）和后（$A'_m$）的月平均吸收短波辐射由下式给出：\n$$\nA_m = \\sum_{b=0}^{B-1} I_{m,b}\\,(1 - \\alpha_{m,b})\n$$\n$$\nA'_m = \\sum_{b=0}^{B-1} I_{m,b}\\,(1 - \\alpha'_{m,b})\n$$\n其中 $I_{m,b}$ 是月份 $m$ 波段 $b$ 的向下光谱辐照度，$\\alpha_{m,b}$ 和 $\\alpha'_{m,b}$ 是相应的混合像元光谱反照率。假定入射辐射场 $I_{m,b}$ 不受增温影响。\n\n因此，变化量 $\\Delta A_m$ 为：\n$$\n\\Delta A_m = A'_m - A_m = \\sum_{b=0}^{B-1} I_{m,b}\\,(1 - \\alpha'_{m,b}) - \\sum_{b=0}^{B-1} I_{m,b}\\,(1 - \\alpha_{m,b})\n$$\n$$\n\\Delta A_m = \\sum_{b=0}^{B-1} I_{m,b} \\left[ (1 - \\alpha'_{m,b}) - (1 - \\alpha_{m,b}) \\right] = \\sum_{b=0}^{B-1} I_{m,b} (\\alpha_{m,b} - \\alpha'_{m,b})\n$$\n这表明吸收辐射的变化是由地表反照率的变化驱动的。\n\n接下来，我们用积雪覆盖率的变化来表示反照率的变化 $\\alpha_{m,b} - \\alpha'_{m,b}$。混合像元光谱反照率由线性混合定义：\n$$\n\\alpha_{m,b} = f_m \\,\\alpha_{\\mathrm{snow},b} + (1-f_m)\\,\\alpha_{\\mathrm{ground},b}\n$$\n$$\n\\alpha'_{m,b} = f'_m \\,\\alpha_{\\mathrm{snow},b} + (1-f'_m)\\,\\alpha_{\\mathrm{ground},b}\n$$\n其中 $f_m$ 和 $f'_m$ 是增温前后的积雪覆盖率。将这两个方程相减得到：\n$$\n\\alpha_{m,b} - \\alpha'_{m,b} = (f_m - f'_m)\\,\\alpha_{\\mathrm{snow},b} + ((1-f_m) - (1-f'_m))\\,\\alpha_{\\mathrm{ground},b}\n$$\n$$\n\\alpha_{m,b} - \\alpha'_{m,b} = (f_m - f'_m)\\,\\alpha_{\\mathrm{snow},b} + (f'_m - f_m)\\,\\alpha_{\\mathrm{ground},b}\n$$\n$$\n\\alpha_{m,b} - \\alpha'_{m,b} = (f_m - f'_m) (\\alpha_{\\mathrm{snow},b} - \\alpha_{\\mathrm{ground},b})\n$$\n令 $\\Delta f_m = f'_m - f_m$。则 $f_m - f'_m = -\\Delta f_m$。反照率的变化变为：\n$$\n\\alpha_{m,b} - \\alpha'_{m,b} = -\\Delta f_m (\\alpha_{\\mathrm{snow},b} - \\alpha_{\\mathrm{ground},b})\n$$\n积雪覆盖的减少（$\\Delta f_m  0$）导致反照率的降低，因为 $\\alpha_{\\mathrm{snow},b} > \\alpha_{\\mathrm{ground},b}$。\n\n将此表达式代回 $\\Delta A_m$ 的方程中：\n$$\n\\Delta A_m = \\sum_{b=0}^{B-1} I_{m,b} \\left[ -\\Delta f_m (\\alpha_{\\mathrm{snow},b} - \\alpha_{\\mathrm{ground},b}) \\right]\n$$\n由于 $\\Delta f_m$ 不依赖于光谱波段指数 $b$，我们可以将其从求和中提取出来：\n$$\n\\Delta A_m = -\\Delta f_m \\sum_{b=0}^{B-1} I_{m,b} (\\alpha_{\\mathrm{snow},b} - \\alpha_{\\mathrm{ground},b})\n$$\n使用定义 $I_{m,b} = Q_m \\cdot w_b$，其中 $Q_m$ 是宽带辐照度，而 $w_b$ 是波段权重：\n$$\n\\Delta A_m = -\\Delta f_m \\sum_{b=0}^{B-1} (Q_m \\cdot w_b) (\\alpha_{\\mathrm{snow},b} - \\alpha_{\\mathrm{ground},b})\n$$\n宽带辐照度 $Q_m$ 也不依赖于 $b$，可以被提取出来：\n$$\n\\Delta A_m = -Q_m \\cdot \\Delta f_m \\left[ \\sum_{b=0}^{B-1} w_b (\\alpha_{\\mathrm{snow},b} - \\alpha_{\\mathrm{ground},b}) \\right]\n$$\n方括号中的项是一个由地表和入射辐射的固定光谱特性决定的常数值。我们将这个光谱加权的有效反照率差异定义为 $\\Delta \\alpha_{\\text{eff}}$：\n$$\n\\Delta \\alpha_{\\text{eff}} = \\sum_{b=0}^{B-1} w_b (\\alpha_{\\mathrm{snow},b} - \\alpha_{\\mathrm{ground},b})\n$$\n使用提供的通用数据：\n$w_b = [0.05, 0.50, 0.45]$, $\\alpha_{\\mathrm{snow},b} = [0.90, 0.85, 0.55]$, and $\\alpha_{\\mathrm{ground},b} = [0.12, 0.20, 0.35]$.\n$$\n\\Delta \\alpha_{\\text{eff}} = 0.05(0.90 - 0.12) + 0.50(0.85 - 0.20) + 0.45(0.55 - 0.35)\n$$\n$$\n\\Delta \\alpha_{\\text{eff}} = 0.05(0.78) + 0.50(0.65) + 0.45(0.20) = 0.039 + 0.325 + 0.090 = 0.454\n$$\n因此，月度变化简化为：\n$$\n\\Delta A_m = -Q_m \\cdot \\Delta f_m \\cdot \\Delta \\alpha_{\\text{eff}}\n$$\n最后，我们可以写出年平均变化 $\\Delta \\overline{A}$ 的表达式：\n$$\n\\Delta \\overline{A} = \\frac{\\sum_{m=0}^{11} d_m (-Q_m \\cdot \\Delta f_m \\cdot \\Delta \\alpha_{\\text{eff}})}{\\sum_{m=0}^{11} d_m} = - \\Delta \\alpha_{\\text{eff}} \\frac{\\sum_{m=0}^{11} d_m \\, Q_m \\, \\Delta f_m}{\\sum_{m=0}^{11} d_m}\n$$\n其中 $\\Delta f_m = \\min\\{\\max\\{f_m + s \\cdot \\Delta T, 0\\}, 1\\} - f_m$。一年中的总天数为 $\\sum d_m = 365$。\n\n算法如下：\n1. 预先计算常数 $\\Delta \\alpha_{\\text{eff}} = 0.454$ 和年总天数 365。\n2. 对于每个测试案例，遍历从 0 到 11 的每个月份 $m$：\n   a. 计算扰动后的积雪覆盖率 $f'_m = \\min\\{\\max\\{f_m + s \\cdot \\Delta T, 0\\}, 1\\}$。\n   b. 计算积雪覆盖率的变化 $\\Delta f_m = f'_m - f_m$。\n3. 计算分子中的加权和：$\\sum_{m=0}^{11} d_m \\, Q_m \\, \\Delta f_m$。\n4. 使用最终的简化公式计算 $\\Delta \\overline{A}$。\n5. 将结果四舍五入到三位小数。\n与分别计算 $\\overline{A'}$ 和 $\\overline{A}$ 的大总量再相减相比，这种简化的公式计算效率更高，且更不容易产生浮点误差。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the annual-mean change in absorbed surface shortwave radiation\n    due to changes in snow cover under a uniform warming scenario.\n    \"\"\"\n    \n    # Common data for all test cases\n    # Gregorian month lengths in days (non-leap year)\n    d_m = np.array([31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31])\n    total_days = np.sum(d_m)\n\n    # Band weights for UV, VIS, NIR\n    w_b = np.array([0.05, 0.50, 0.45])\n    \n    # Spectral albedos for snow\n    alpha_snow_b = np.array([0.90, 0.85, 0.55])\n    \n    # Spectral albedos for snow-free ground\n    alpha_ground_b = np.array([0.12, 0.20, 0.35])\n\n    # Pre-compute the spectrally-weighted effective albedo difference\n    # This term is constant across all cases and months.\n    delta_alpha_eff = np.sum(w_b * (alpha_snow_b - alpha_ground_b))\n\n    # Define the three test cases as a list of tuples.\n    # Each tuple contains: (monthly Q_m, monthly f_m, sensitivity s, warming delta_T)\n    test_cases = [\n        # Test case 1: seasonal snow, typical midlatitude\n        (\n            np.array([120, 160, 220, 260, 300, 320, 310, 280, 220, 180, 140, 110]),\n            np.array([0.60, 0.50, 0.40, 0.20, 0.05, 0.00, 0.00, 0.00, 0.05, 0.20, 0.40, 0.55]),\n            -0.08,\n            2.0\n        ),\n        # Test case 2: snow-free midlatitude\n        (\n            np.array([120, 160, 220, 260, 300, 320, 310, 280, 220, 180, 140, 110]),\n            np.array([0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00]),\n            -0.08,\n            2.0\n        ),\n        # Test case 3: snow-dominated midlatitude plateau\n        (\n            np.array([90, 130, 200, 260, 290, 300, 290, 260, 210, 160, 110, 80]),\n            np.array([0.95, 0.90, 0.85, 0.60, 0.20, 0.05, 0.05, 0.10, 0.40, 0.70, 0.85, 0.90]),\n            -0.06,\n            2.0\n        )\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        Q_m, f_m, s, delta_T = case\n        \n        # Calculate the change in snow fraction due to warming\n        raw_change = s * delta_T\n        \n        # Calculate the new snow fraction, f'_m, enforcing the bounds [0, 1]\n        f_prime_m = np.clip(f_m + raw_change, 0, 1)\n        \n        # Calculate the month-by-month change in snow fraction, delta_f_m\n        delta_f_m = f_prime_m - f_m\n        \n        # Calculate the numerator of the final expression: sum over months of\n        # (days_in_month * irradiance * change_in_snow_fraction)\n        numerator_sum = np.sum(d_m * Q_m * delta_f_m)\n        \n        # Calculate the annual-mean change in absorbed SW using the simplified formula\n        # delta_A_bar = -delta_alpha_eff * (numerator / total_days)\n        # A negative delta_f_m (less snow) leads to a positive delta_A_bar (more absorption).\n        delta_A_bar = -delta_alpha_eff * numerator_sum / total_days\n        \n        # Append the rounded result to the list\n        results.append(round(delta_A_bar, 3))\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}