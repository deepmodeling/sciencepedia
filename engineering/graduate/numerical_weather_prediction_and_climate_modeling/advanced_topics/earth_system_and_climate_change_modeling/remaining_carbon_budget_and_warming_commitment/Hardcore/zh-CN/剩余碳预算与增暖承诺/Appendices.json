{
    "hands_on_practices": [
        {
            "introduction": "实现净零排放的时间点是气候政策讨论的核心。本练习旨在阐明累积二氧化碳排放量与峰值升温之间的直接线性关系，即“瞬时气候响应与累积碳排放量”（TCRE）这一核心概念。通过计算不同净零情景下的升温差异，您将具体理解为何在限制全球变暖的竞赛中“每一年都至关重要”。",
            "id": "4081694",
            "problem": "考虑一个由线性能量平衡模型表示的全球综合气候系统，其中全球平均地表气温（GMSAT）异常 $T(t)$ 对总辐射强迫 $F(t)$ 的响应遵循方程 $C\\,\\frac{dT}{dt} = F(t) - \\lambda\\,T(t)$，其中 $C$ 是有效热容，$\\lambda$ 是气候反馈参数。总强迫分解为二氧化碳（$\\mathrm{CO_2}$）和非二氧化碳（non-$\\mathrm{CO_2}$）部分，$F(t) = F_{\\mathrm{CO_2}}(t) + F_{\\mathrm{nc}}(t)$。假设非二氧化碳强迫随时间保持恒定，即 $F_{\\mathrm{nc}}(t) = F_{\\mathrm{nc},0}$。\n\n以综合气候模型中一个得到广泛支持的涌现特性——对累积碳排放的瞬态气候响应（TCRE）为基础：由二氧化碳引起的升温可以近似为 $T_{\\mathrm{CO_2}}(t) \\approx \\beta\\,E_{\\mathrm{cum}}(t)$，其中 $E_{\\mathrm{cum}}(t)$ 是截至时间 $t$ 的累积人为二氧化碳排放量，$\\beta$ 是一个常数。进一步假设，在数十年时间尺度上的零排放承诺（ZEC）可以忽略不计，即在实现净零二氧化碳排放后，$T_{\\mathrm{CO_2}}(t)$ 不会表现出系统性漂移。在这些假设下，峰值升温在实现净零二氧化碳排放时达到。\n\n假设当前（$t_0 = 2025$年）的人为二氧化碳年排放量为 $E_0 = 40$ Gt$\\mathrm{CO_2}$ yr$^{-1}$，并且排放量从 $t_0$ 开始线性下降，在指定的年份 $Y$ 达到净零，因此 $E(t)$ 从 $t_0$ 时的 $E_0$ 线性减少到 $Y$ 时的 $0$。使用对累积碳排放的瞬态气候响应值为 $\\beta = 4.5 \\times 10^{-4}$ K 每 Gt$\\mathrm{CO_2}$。\n\n使用上述基本平衡和TCRE近似，首先分析性地证明，在非二氧化碳强迫恒定的情况下，为什么更早的净零日期意味着更低的峰值升温。然后，对于在 $Y = 2040$ 年与 $Y = 2050$ 年实现净零两种情况，计算由二氧化碳引起的峰值GMSAT异常的定量差异（在两种情景中，非二氧化碳的贡献是相同的），并将此差异作为最终答案。将你的答案四舍五入至四位有效数字，并以摄氏度表示。",
            "solution": "### 步骤 1：建立分析性关系\n\n根据问题陈述，二氧化碳引起的峰值升温在实现净零排放时达到，并且与累积二氧化碳排放量 $E_{\\mathrm{cum}}$ 成正比，关系为 $\\Delta T_{\\mathrm{CO_2, peak}} = \\beta \\cdot E_{\\mathrm{cum, total}}$。总累积排放量是历史累积量加上从现在 ($t_0=2025$) 到净零年 ($Y$) 的额外排放量。\n\n从 $t_0$ 到 $Y$ 的年排放速率 $E(t)$ 呈线性下降：\n$$ E(t) = E_0 \\left( 1 - \\frac{t - t_0}{Y - t_0} \\right) $$\n其中 $E_0 = 40$ GtCO₂/年。\n\n从 $t_0$ 到 $Y$ 的累积排放量 $\\Delta E_{\\mathrm{cum}}$ 是对 $E(t)$ 在此期间的积分，即排放路径曲线下的面积（一个三角形）：\n$$ \\Delta E_{\\mathrm{cum}}(Y) = \\int_{t_0}^{Y} E(t) dt = \\frac{1}{2} \\times \\text{基底} \\times \\text{高} = \\frac{1}{2} \\times (Y - t_0) \\times E_0 $$\n总累积排放量为 $E_{\\mathrm{cum, total}} = E_{\\mathrm{cum, historical}} + \\Delta E_{\\mathrm{cum}}(Y)$。因此，峰值升温为：\n$$ \\Delta T_{\\mathrm{CO_2, peak}}(Y) = \\beta \\cdot (E_{\\mathrm{cum, historical}} + \\frac{1}{2} E_0 (Y - t_0)) $$\n由于 $\\beta > 0$ 和 $E_0 > 0$，峰值升温 $\\Delta T_{\\mathrm{CO_2, peak}}(Y)$ 是净零年份 $Y$ 的单调递增函数。因此，一个更早的净零日期（一个更小的 $Y$）必然导致更低的累积排放量和更低的峰值升温。这就完成了分析性证明。\n\n### 步骤 2：计算两种情景下的累积排放差异\n\n我们现在计算两个情景下的额外累积排放量：\n-   **情景 1：净零年份 $Y_1 = 2040$**\n    持续时间为 $2040 - 2025 = 15$ 年。\n    额外排放量 $\\Delta E_1 = \\frac{1}{2} \\times 15 \\, \\text{yr} \\times 40 \\, \\text{GtCO}_2/\\text{yr} = 300 \\, \\text{GtCO}_2$。\n\n-   **情景 2：净零年份 $Y_2 = 2050$**\n    持续时间为 $2050 - 2025 = 25$ 年。\n    额外排放量 $\\Delta E_2 = \\frac{1}{2} \\times 25 \\, \\text{yr} \\times 40 \\, \\text{GtCO}_2/\\text{yr} = 500 \\, \\text{GtCO}_2$。\n\n两种情景之间的累积排放量差异为：\n$$ \\Delta E_{\\mathrm{diff}} = \\Delta E_2 - \\Delta E_1 = 500 \\, \\text{GtCO}_2 - 300 \\, \\text{GtCO}_2 = 200 \\, \\text{GtCO}_2 $$\n\n### 步骤 3：计算峰值升温差异\n\n由二氧化碳引起的峰值 GMSAT 异常差异是累积排放量差异乘以 TCRE 常数 $\\beta$：\n$$ \\Delta T_{\\mathrm{diff}} = \\beta \\times \\Delta E_{\\mathrm{diff}} $$\n代入给定值 $\\beta = 4.5 \\times 10^{-4} \\, \\text{K / GtCO}_2$：\n$$ \\Delta T_{\\mathrm{diff}} = (4.5 \\times 10^{-4} \\, \\text{K / GtCO}_2) \\times (200 \\, \\text{GtCO}_2) $$\n$$ \\Delta T_{\\mathrm{diff}} = 4.5 \\times 10^{-4} \\times 2 \\times 10^2 \\, \\text{K} = 9.0 \\times 10^{-2} \\, \\text{K} = 0.0900 \\, \\text{K} $$\n由于温度变化 $1$ K 等于 $1^\\circ \\mathrm{C}$，因此差异为 $0.0900^\\circ \\mathrm{C}$。根据要求，答案应有四位有效数字，最终答案为 $0.09000$ 以匹配指定的精度。",
            "answer": "$$\\boxed{0.09000}$$"
        },
        {
            "introduction": "不同科学报告中剩余碳预算的估算值常常存在差异。本练习将探讨一个看似技术性的选择——全球平均温度的定义——如何系统性地改变对当前变暖程度的评估，并因此影响剩余碳预算。通过这个练习，您将学会欣赏气候科学中精确定义的重要性，并学会如何量化这类不确定性相对于其他因素的显著性。",
            "id": "4081709",
            "problem": "考虑一个全球变暖的上限，$T^{\\star} = 1.5^\\circ \\mathrm{C}$，高于工业化前水平。设瞬时气候对累积碳排放的响应（TCRE）为一个常数 $\\lambda = 0.45^\\circ \\mathrm{C}$ 每 $1000\\,\\mathrm{GtCO_2}$，这是气候模型中一个广泛使用的涌现关系。使用全球平均地表温度（GMST）推断的当前变暖为 $T_0 = 1.1^\\circ \\mathrm{C}$。另一种度量标准，全球地表气温（GSAT），使得报告的变暖相对于 GMST 有一个偏移量 $\\delta T$；取 $\\delta T = 0.075^\\circ \\mathrm{C}$，代表了 $0.05$–$0.1^\\circ \\mathrm{C}$ 的范围。假设非二氧化碳强迫保持不变，且剩余碳预算定义为在线性 TCRE 关系下，不超过 $T^{\\star}$ 所允许的额外人为 $\\mathrm{CO_2}$ 排放量。\n\n使用基本定义和经过充分检验的关系，推导 $\\delta T$ 如何映射到剩余碳预算的变化量 $\\Delta B$，然后计算比率\n$$\nR = \\frac{|\\Delta B|}{s_B},\n$$\n其中 $s_B = 230\\,\\mathrm{GtCO_2}$ 是剩余碳预算中一个代表性的单西格玛不确定性，它源于多种因素的组合（非二氧化碳强迫、地球系统反馈、观测不确定性和 TCRE 不确定性）。将 $R$ 表示为一个纯数（无单位），并将您的答案四舍五入到三位有效数字。",
            "solution": "该问题的基础是瞬时气候对累积碳排放的响应（TCRE），它假设全球平均温度的升高量 $\\Delta T$ 与二氧化碳总累积排放量 $C$ 之间存在线性关系。问题给出了 TCRE 常数 $\\lambda$，即每排放 $1000\\,\\mathrm{GtCO_2}$ 导致的升温。设 $\\Delta T$ 是高于工业化前水平的升温，单位为摄氏度（$^\\circ \\mathrm{C}$），设 $C$ 是导致此升温的累积 $\\mathrm{CO_2}$ 排放量，单位为十亿吨二氧化碳（$\\mathrm{GtCO_2}$）。该关系可表示为：\n$$\n\\Delta T = \\lambda \\left( \\frac{C}{1000\\,\\mathrm{GtCO_2}} \\right)\n$$\n其中 $\\lambda = 0.45^\\circ \\mathrm{C}$。\n\n剩余碳预算，我们用 $B$ 表示，是在超过全球变暖上限 $T^{\\star}$ 之前可以额外排放的 $\\mathrm{CO_2}$ 量。设 $T_0$ 为当前升温。剩余的升温容量为 $T^{\\star} - T_0$。这个剩余的升温通过相同的 TCRE 关系对应于剩余碳预算 $B$：\n$$\nT^{\\star} - T_0 = \\lambda \\left( \\frac{B}{1000\\,\\mathrm{GtCO_2}} \\right)\n$$\n由此方程，我们可以推导出剩余碳预算 $B$ 作为当前升温 $T_0$ 的函数表达式：\n$$\nB(T_0) = \\frac{T^{\\star} - T_0}{\\lambda} \\times 1000\\,\\mathrm{GtCO_2}\n$$\n问题指出，对当前升温的评估取决于度量标准的选择，可能存在一个偏移量 $\\delta T$。这意味着我们对当前升温 $T_0$ 的估计可能会变为 $T_0 + \\delta T$。我们需要求解的是，由于当前升温评估的这种变化所导致的剩余碳预算的变化量 $\\Delta B$。\n\n设初始预算为 $B_1$，用当前升温 $T_0$ 计算。\n$$\nB_1 = B(T_0) = \\frac{T^{\\star} - T_0}{\\lambda} \\times 1000\\,\\mathrm{GtCO_2}\n$$\n设新预算为 $B_2$，用调整后的当前升温 $T_0 + \\delta T$ 计算。\n$$\nB_2 = B(T_0 + \\delta T) = \\frac{T^{\\star} - (T_0 + \\delta T)}{\\lambda} \\times 1000\\,\\mathrm{GtCO_2}\n$$\n预算的变化量 $\\Delta B$ 是 $B_2 - B_1$ 的差值：\n$$\n\\Delta B = B_2 - B_1 = \\left( \\frac{T^{\\star} - T_0 - \\delta T}{\\lambda} - \\frac{T^{\\star} - T_0}{\\lambda} \\right) \\times 1000\\,\\mathrm{GtCO_2}\n$$\n简化括号内的表达式：\n$$\n\\Delta B = \\left( \\frac{(T^{\\star} - T_0 - \\delta T) - (T^{\\star} - T_0)}{\\lambda} \\right) \\times 1000\\,\\mathrm{GtCO_2}\n$$\n$$\n\\Delta B = \\frac{-\\delta T}{\\lambda} \\times 1000\\,\\mathrm{GtCO_2}\n$$\n这个方程显示了温度评估中的偏移量 $\\delta T$ 如何映射到剩余碳预算的变化量 $\\Delta B$。这个变化是负的，表明评估的当前升温越高（即一个正的 $\\delta T$），剩余碳预算就越小。\n\n现在，我们代入给定的数值来计算 $\\Delta B$。\n给定的数值是：\n- 温度度量标准的偏移量：$\\delta T = 0.075^\\circ \\mathrm{C}$\n- TCRE 常数：$\\lambda = 0.45^\\circ \\mathrm{C}$ 每 $1000\\,\\mathrm{GtCO_2}$\n\n将这些值代入我们推导出的 $\\Delta B$ 关系式中：\n$$\n\\Delta B = - \\frac{0.075^\\circ \\mathrm{C}}{0.45^\\circ \\mathrm{C}} \\times 1000\\,\\mathrm{GtCO_2}\n$$\n$$\n\\Delta B = - \\frac{75}{450} \\times 1000\\,\\mathrm{GtCO_2} = - \\frac{1}{6} \\times 1000\\,\\mathrm{GtCO_2} = - \\frac{1000}{6}\\,\\mathrm{GtCO_2} = - \\frac{500}{3}\\,\\mathrm{GtCO_2}\n$$\n这个变化的大小是：\n$$\n|\\Delta B| = \\frac{500}{3}\\,\\mathrm{GtCO_2} \\approx 166.67\\,\\mathrm{GtCO_2}\n$$\n最后一步是计算比率 $R$，它将此预算变化的幅度与剩余碳预算的代表性单西格玛不确定性 $s_B$ 进行比较。\n给定 $s_B = 230\\,\\mathrm{GtCO_2}$。比率 $R$ 定义为：\n$$\nR = \\frac{|\\Delta B|}{s_B}\n$$\n代入我们已有的数值：\n$$\nR = \\frac{\\frac{500}{3}\\,\\mathrm{GtCO_2}}{230\\,\\mathrm{GtCO_2}} = \\frac{500}{3 \\times 230} = \\frac{500}{690} = \\frac{50}{69}\n$$\n为了给出最终答案，我们计算这个分数的值，并将其四舍五入到三位有效数字。\n$$\nR = \\frac{50}{69} \\approx 0.72463768...\n$$\n四舍五入到三位有效数字得到 $0.725$。",
            "answer": "$$\n\\boxed{0.725}\n$$"
        },
        {
            "introduction": "简单的碳预算计算常常忽略了非二氧化碳强迫（如气溶胶）的复杂动态效应。这项数值实验要求您构建一个简单的气候模型，以探究气溶胶强迫的空间差异及其最终移除如何揭示一种“已承诺的”或“被揭示的”变暖。通过比较考虑了这种隐藏变暖的预算和未考虑的预算，您将理解气候预测中的一个关键细微差别，以及静态预算估算的局限性。",
            "id": "4081665",
            "problem": "您的任务是设计并实现一个完整的数值实验，以量化简化全球气候模型中气溶胶辐射强迫的空间异质性如何影响剩余碳预算估算和变暖承诺。您的程序必须模拟全球平均温度对具有不同功效的区域分布气溶胶强迫的响应，然后计算达到指定变暖阈值的两种剩余碳预算估算。所有答案必须以指定单位表示，并如下所述汇总到单行输出中。\n\n请基于以下基本定律和核心定义进行推导和算法设计：\n\n1. 全球平均单箱能量平衡模型：气候系统的全球平均温度对外部施加的有效辐射强迫的响应由以下公式决定\n$$\nC \\frac{dT_a(t)}{dt} = R_{\\mathrm{eff}}(t) - \\lambda T_a(t),\n$$\n其中 $T_a(t)$ 是气溶胶引起的全球平均温度贡献，单位为 $\\mathrm{K}$，$C$ 是有效热容，单位为 $\\mathrm{W \\, yr \\, m^{-2} \\, K^{-1}}$，$\\lambda$ 是气候反馈参数，单位为 $\\mathrm{W \\, m^{-2} \\, K^{-1}}$，$R_{\\mathrm{eff}}(t)$ 是全球平均有效辐射强迫，单位为 $\\mathrm{W \\, m^{-2}}$。使用年度时间步长的离散时间近似。\n\n2. 区域气溶胶强迫和功效：考虑一个由 $r = 1, 2, \\dots, R$ 索引的有限区域集。每个区域都有一个面积分数 $f_r$（满足 $\\sum_r f_r = 1$），一个以 $\\mathrm{W \\, m^{-2}}$ 为单位的气溶胶辐射强迫 $F_r$（负值表示冷却），以及一个无量纲的功效 $e_r$，该功效相对于参考强迫，缩放了 $F_r$ 的温度有效性。在时间 $t$ 的全球平均有效强迫为\n$$\nR_{\\mathrm{eff}}(t) = \\sum_{r=1}^R f_r \\, e_r \\, F_r(t).\n$$\n假设 $F_r(t)$ 是分段常数：当 $t  < t_{\\mathrm{stop}}$ 时，$F_r(t) = F_r$；当 $t \\ge t_{\\mathrm{stop}}$ 时，$F_r(t) = 0$，以表示气溶胶的逐步淘汰。\n\n3. 对累积碳排放的瞬态气候响应 (TCRE)：由二氧化碳引起的全球平均升温约与累积排放量成正比，\n$$\n\\Delta T_{\\mathrm{CO_2}}(t) = \\gamma E(t),\n$$\n其中 $\\gamma$ 是 TCRE，单位为 $\\mathrm{K / GtCO_2}$，$E(t)$ 是自工业化前以来累积的二氧化碳排放量，单位为 $\\mathrm{GtCO_2}$。在这个简化框架中，将 $\\Delta T_{\\mathrm{CO_2}}(t)$ 视为与气溶胶强迫无关。\n\n您的任务：\n\n- 使用年度时间步长 $\\Delta t = 1 \\, \\mathrm{yr}$ 实现能量平衡方程的离散时间求解器，以根据给定参数计算从 $t=0$ 到 $t=t_{\\mathrm{eval}}$ 的 $T_a(t)$。初始化 $T_a(0) = 0$。\n- 计算气溶胶时代开始后 $t_0$ 年的当前时间，由气溶胶引起的全球平均温度，记为 $T_a(t_0)$（单位 $\\mathrm{K}$），以及在气溶胶已淘汰（即 $t_{\\mathrm{eval}} > t_{\\mathrm{stop}}$）的评估时间 $t_{\\mathrm{eval}}$ 年时的温度，记为 $T_a(t_{\\mathrm{eval}})$（单位 $\\mathrm{K}$）。\n- 设当前累积二氧化碳排放量为 $E_0$（单位 $\\mathrm{GtCO_2}$），因此当前的二氧化碳变暖为 $T_{\\mathrm{CO_2},0} = \\gamma E_0$（单位 $\\mathrm{K}$）。对于变暖阈值 $T^*$（单位 $\\mathrm{K}$），计算两种剩余碳预算的估算值（单位 $\\mathrm{GtCO_2}$）：\n    1. 一种包含当前气溶胶冷却效应的“遮蔽”瞬时估算：\n    $$\n    B_{\\mathrm{masked}} = \\max\\left(0, \\frac{T^* - \\left(T_{\\mathrm{CO_2},0} + T_a(t_0)\\right)}{\\gamma}\\right).\n    $$\n    2. 一种考虑气溶胶淘汰后变暖承诺的“移除后”估算：\n    $$\n    B_{\\mathrm{true}} = \\max\\left(0, \\frac{T^* - \\left(T_{\\mathrm{CO_2},0} + T_a(t_{\\mathrm{eval}})\\right)}{\\gamma}\\right).\n    $$\n\n物理单位和角度规定：\n- 温度必须以 $\\mathrm{K}$ 为单位。\n- 辐射强迫必须以 $\\mathrm{W \\, m^{-2}}$ 为单位。\n- 气候反馈参数必须以 $\\mathrm{W \\, m^{-2} \\, K^{-1}}$ 为单位。\n- 有效热容必须以 $\\mathrm{W \\, yr \\, m^{-2} \\, K^{-1}}$ 为单位。\n- TCRE必须以 $\\mathrm{K / GtCO_2}$ 为单位。\n- 排放和预算必须以 $\\mathrm{GtCO_2}$ 为单位。\n- 不涉及角度量。\n\n数值方案要求：\n- 使用年度前向欧拉离散化，\n$$\nT_a(t+\\Delta t) = T_a(t) + \\frac{\\Delta t}{C}\\left(R_{\\mathrm{eff}}(t) - \\lambda T_a(t)\\right),\n$$\n其中 $\\Delta t = 1 \\, \\mathrm{yr}$。\n\n测试套件：\n您的程序必须运行以下四组测试用例。对于每个用例，参数以列表和标量的元组形式给出，顺序为 $(\\{f_r\\}, \\{F_r\\}, \\{e_r\\}, \\lambda, C, t_0, t_{\\mathrm{stop}}, t_{\\mathrm{eval}}, \\gamma, E_0, T^*)$：\n\n1. 异质功效，中纬度和热带地区：\n    - $\\{f_r\\} = [0.3, 0.7]$\n    - $\\{F_r\\} = [-0.6, -0.3] \\, \\mathrm{W \\, m^{-2}}$\n    - $\\{e_r\\} = [1.3, 0.8]$\n    - $\\lambda = 1.0 \\, \\mathrm{W \\, m^{-2} \\, K^{-1}}$\n    - $C = 8.0 \\, \\mathrm{W \\, yr \\, m^{-2} \\, K^{-1}}$\n    - $t_0 = 50 \\, \\mathrm{yr}$\n    - $t_{\\mathrm{stop}} = 60 \\, \\mathrm{yr}$\n    - $t_{\\mathrm{eval}} = 80 \\, \\mathrm{yr}$\n    - $\\gamma = 4.5 \\times 10^{-4} \\, \\mathrm{K / GtCO_2}$\n    - $E_0 = 2000 \\, \\mathrm{GtCO_2}$\n    - $T^* = 1.5 \\, \\mathrm{K}$\n\n2. 同质功效基线：\n    - $\\{f_r\\} = [0.3, 0.7]$\n    - $\\{F_r\\} = [-0.6, -0.3] \\, \\mathrm{W \\, m^{-2}}$\n    - $\\{e_r\\} = [1.0, 1.0]$\n    - $\\lambda = 1.0 \\, \\mathrm{W \\, m^{-2} \\, K^{-1}}$\n    - $C = 8.0 \\, \\mathrm{W \\, yr \\, m^{-2} \\, K^{-1}}$\n    - $t_0 = 50 \\, \\mathrm{yr}$\n    - $t_{\\mathrm{stop}} = 60 \\, \\mathrm{yr}$\n    - $t_{\\mathrm{eval}} = 80 \\, \\mathrm{yr}$\n    - $\\gamma = 4.5 \\times 10^{-4} \\, \\mathrm{K / GtCO_2}$\n    - $E_0 = 2000 \\, \\mathrm{GtCO_2}$\n    - $T^* = 1.5 \\, \\mathrm{K}$\n\n3. 强异质性，带有一个小的高功效区域：\n    - $\\{f_r\\} = [0.1, 0.9]$\n    - $\\{F_r\\} = [-1.0, -0.2] \\, \\mathrm{W \\, m^{-2}}$\n    - $\\{e_r\\} = [2.0, 0.7]$\n    - $\\lambda = 1.0 \\, \\mathrm{W \\, m^{-2} \\, K^{-1}}$\n    - $C = 8.0 \\, \\mathrm{W \\, yr \\, m^{-2} \\, K^{-1}}$\n    - $t_0 = 50 \\, \\mathrm{yr}$\n    - $t_{\\mathrm{stop}} = 60 \\, \\mathrm{yr}$\n    - $t_{\\mathrm{eval}} = 80 \\, \\mathrm{yr}$\n    - $\\gamma = 4.5 \\times 10^{-4} \\, \\mathrm{K / GtCO_2}$\n    - $E_0 = 2000 \\, \\mathrm{GtCO_2}$\n    - $T^* = 1.5 \\, \\mathrm{K}$\n\n4. 无气溶胶边缘情况：\n    - $\\{f_r\\} = [0.5, 0.5]$\n    - $\\{F_r\\} = [0.0, 0.0] \\, \\mathrm{W \\, m^{-2}}$\n    - $\\{e_r\\} = [1.5, 0.7]$\n    - $\\lambda = 1.0 \\, \\mathrm{W \\, m^{-2} \\, K^{-1}}$\n    - $C = 8.0 \\, \\mathrm{W \\, yr \\, m^{-2} \\, K^{-1}}$\n    - $t_0 = 50 \\, \\mathrm{yr}$\n    - $t_{\\mathrm{stop}} = 60 \\, \\mathrm{yr}$\n    - $t_{\\mathrm{eval}} = 80 \\, \\mathrm{yr}$\n    - $\\gamma = 4.5 \\times 10^{-4} \\, \\mathrm{K / GtCO_2}$\n    - $E_0 = 2000 \\, \\mathrm{GtCO_2}$\n    - $T^* = 1.5 \\, \\mathrm{K}$\n\n最终输出格式要求：\n- 对于每个测试用例，计算列表 $[T_a(t_0), T_a(t_{\\mathrm{eval}}), B_{\\mathrm{masked}}, B_{\\mathrm{true}}]$。您的程序应生成单行输出，其中包含这些四元素列表的逗号分隔列表形式的结果，并用方括号括起来。温度单位必须是 $\\mathrm{K}$，预算单位必须是 $\\mathrm{GtCO_2}$。将每个浮点数四舍五入到六位小数。例如：“[[val11,val12,val13,val14],[val21,val22,val23,val24],...]”。",
            "solution": "此问题经评估为有效。它在科学上基于已建立的气候科学原理（能量平衡模型、辐射强迫和TCRE），问题陈述清晰，具有完整的参数集和明确的目标，并且没有歧义或矛盾。因此，我们可以着手解决。\n\n该问题要求进行数值模拟，以量化空间异质性气溶胶强迫对剩余碳预算估算的影响。解决方案的推导首先通过求解一个与时间相关的能量平衡方程来获得气溶胶引起的温度变化，然后利用此结果计算两种不同的碳预算估算。\n\n**1. 控制物理和数学原理**\n\n模拟的核心是全球平均单箱能量平衡模型，它描述了气溶胶引起的全球平均地表温度异常 $T_a(t)$ 随时间 $t$ 的演变：\n$$\nC \\frac{dT_a(t)}{dt} = R_{\\mathrm{eff}}(t) - \\lambda T_a(t)\n$$\n在这里，$C$ 是气候系统的有效热容，$\\lambda$ 是气候反馈参数，$R_{\\mathrm{eff}}(t)$ 是由气溶胶引起的全球平均有效辐射强迫。项 $\\lambda T_a(t)$ 代表随着地球变暖而向太空恢复的能量通量，$C \\frac{dT_a(t)}{dt}$ 代表系统的净能量吸收。\n\n有效辐射强迫 $R_{\\mathrm{eff}}(t)$ 并非均匀。它被计算为 $R$ 个不同地理区域的加权平均值：\n$$\nR_{\\mathrm{eff}}(t) = \\sum_{r=1}^R f_r \\, e_r \\, F_r(t)\n$$\n其中对于每个区域 $r$，$f_r$ 是其占全球的面积分数（$\\sum_r f_r = 1$），$F_r(t)$ 是区域辐射强迫，$e_r$ 是功效。功效是一个关键的无量纲参数，它说明了给定大小的强迫（单位为 $\\mathrm{W \\, m^{-2}}$）根据其施加位置的不同，可以产生更大或更小的全球温度响应。\n\n气溶胶强迫被规定为在淘汰时间 $t_{\\mathrm{stop}}$ 之前是恒定的，之后突然变为零：\n$$\nF_r(t) = \\begin{cases} F_r  \\text{ for } t  < t_{\\mathrm{stop}} \\\\ 0  \\text{ for } t \\ge t_{\\mathrm{stop}} \\end{cases}\n$$\n这模拟了气溶胶污染被完全消除的情景。\n\n由二氧化碳引起的变暖使用对累积碳排放的瞬态气候响应（TCRE）进行建模，该模型假定变暖与总排放碳之间存在线性关系：\n$$\n\\Delta T_{\\mathrm{CO_2}}(t) = \\gamma E(t)\n$$\n其中 $\\gamma$ 是 TCRE 常数，$E(t)$ 是累积的 $\\mathrm{CO_2}$ 排放量。\n\n**2. 数值离散化与模拟算法**\n\n$T_a(t)$ 的微分方程必须进行数值求解。问题指定了使用年度时间步长 $\\Delta t = 1 \\, \\mathrm{yr}$ 的前向欧拉方法。将导数离散化为 $\\frac{dT_a}{dt} \\approx \\frac{T_a(t+\\Delta t) - T_a(t)}{\\Delta t}$，我们可以重新排列能量平衡方程，以获得基于当前时间步长 $t$ 的值来计算下一个时间步长 $t+\\Delta t$ 的温度的显式更新规则：\n$$\nT_a(t+\\Delta t) = T_a(t) + \\frac{\\Delta t}{C}\\left(R_{\\mathrm{eff}}(t) - \\lambda T_a(t)\\right)\n$$\n这可以被组合成一个在计算上更方便的形式：\n$$\nT_a(t+\\Delta t) = T_a(t) \\left(1 - \\frac{\\lambda \\Delta t}{C}\\right) + R_{\\mathrm{eff}}(t) \\frac{\\Delta t}{C}\n$$\n模拟过程如下：\n1.  **初始化**：将初始温度异常设置为零，$T_a(0) = 0$。初始化一个数组来存储从 $t=0$ 到 $t=t_{\\mathrm{eval}}$ 每一年的温度值。\n2.  **强迫计算**：对于给定的测试用例，预先计算气溶胶时代（$t  < t_{\\mathrm{stop}}$）期间的恒定有效辐射强迫：$R_{\\mathrm{eff,on}} = \\sum_{r=1}^R f_r e_r F_r$。对于 $t \\ge t_{\\mathrm{stop}}$，强迫为 $R_{\\mathrm{eff,off}} = 0$。\n3.  **时间步进循环**：一个循环从 $t = 0$ 到 $t = t_{\\mathrm{eval}} - 1$ 以 $\\Delta t=1 \\, \\mathrm{yr}$ 的步长进行迭代。在每次迭代中：\n    a. 根据当前时间 $t$ 是否小于 $t_{\\mathrm{stop}}$ 来选择适当的强迫 $R_{\\mathrm{eff}}(t)$。\n    b. 应用前向欧拉更新规则来计算 $T_a(t+\\Delta t)$ 并存储它。\n4.  **结果提取**：循环完成后，模拟的温度时间序列就完全填充好了。从存储的数组中在相应的时间索引处提取所需的值 $T_a(t_0)$ 和 $T_a(t_{\\mathrm{eval}})$。\n\n**3. 碳预算计算**\n\n利用模拟出的气溶胶引起的温度，计算两个剩余碳预算估算值。首先，计算由 $\\mathrm{CO_2}$ 引起的当前变暖：\n$$\nT_{\\mathrm{CO_2},0} = \\gamma E_0\n$$\n当前总变暖是 $\\mathrm{CO_2}$ 和气溶胶贡献的总和：$T_{\\mathrm{total},0} = T_{\\mathrm{CO_2},0} + T_a(t_0)$。请注意，由于 $T_a(t_0)$ 是负值，它代表了一种冷却效应，这种效应“遮蔽”了部分 $\\mathrm{CO_2}$ 变暖。\n\n第一个预算估算 $B_{\\mathrm{masked}}$ 计算了假设这种遮蔽效应无限期持续下去时剩余的允许排放量。达到目标 $T^*$ 的剩余变暖“余量”是 $T^* - T_{\\mathrm{total},0}$。利用 TCRE 关系，这被转换为一个碳预算：\n$$\nB_{\\mathrm{masked}} = \\max\\left(0, \\frac{T^* - (T_{\\mathrm{CO_2},0} + T_a(t_0))}{\\gamma}\\right)\n$$\n第二个估算 $B_{\\mathrm{true}}$ 考虑了在气溶胶被移除后将会实现的“承诺变暖”。在时间 $t_{\\mathrm{eval}}$（远在气溶胶淘汰时间 $t_{\\mathrm{stop}}$ 之后），温度 $T_a(t_{\\mathrm{eval}})$ 代表了过去气溶胶强迫的残留（衰减中）温度效应。由当前 $\\mathrm{CO_2}$ 水平和过去气溶胶效应共同造成的总承诺变暖为 $T_{\\mathrm{commit}} = T_{\\mathrm{CO_2},0} + T_a(t_{\\mathrm{eval}})$。注意 $T_a(t_{\\mathrm{eval}})$ 将会是一个比 $T_a(t_0)$ 更小的负数，甚至接近于零，反映了变暖的暴露。因此，真实的剩余碳预算是：\n$$\nB_{\\mathrm{true}} = \\max\\left(0, \\frac{T^* - (T_{\\mathrm{CO_2},0} + T_a(t_{\\mathrm{eval}}))}{\\gamma}\\right)\n$$\n此过程应用于四个测试用例中的每一个，以生成最终结果。$B_{\\mathrm{masked}}$ 和 $B_{\\mathrm{true}}$ 之间的比较直接量化了如果忽略未来因气溶胶移除而产生的变暖承诺，将会导致的碳预算高估。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the climate modeling problem for all specified test cases.\n    \"\"\"\n    \n    test_cases = [\n        # Case 1: Heterogeneous efficacies\n        ([0.3, 0.7], [-0.6, -0.3], [1.3, 0.8], 1.0, 8.0, 50, 60, 80, 4.5e-4, 2000, 1.5),\n        # Case 2: Homogeneous efficacies baseline\n        ([0.3, 0.7], [-0.6, -0.3], [1.0, 1.0], 1.0, 8.0, 50, 60, 80, 4.5e-4, 2000, 1.5),\n        # Case 3: Strong heterogeneity\n        ([0.1, 0.9], [-1.0, -0.2], [2.0, 0.7], 1.0, 8.0, 50, 60, 80, 4.5e-4, 2000, 1.5),\n        # Case 4: No aerosols edge case\n        ([0.5, 0.5], [0.0, 0.0], [1.5, 0.7], 1.0, 8.0, 50, 60, 80, 4.5e-4, 2000, 1.5),\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        f_r, F_r_vals, e_r, lambda_val, C, t0, t_stop, t_eval, gamma, E0, T_star = case\n\n        # Convert lists to numpy arrays for vectorized operations\n        f_r = np.array(f_r)\n        F_r_vals = np.array(F_r_vals)\n        e_r = np.array(e_r)\n\n        # Calculate the constant effective radiative forcing for t  t_stop\n        R_eff_on = np.sum(f_r * e_r * F_r_vals)\n\n        # Numerical integration using Forward Euler\n        dt = 1.0  # Annual time step\n        \n        # Array to store temperature anomaly time series\n        # Size is t_eval + 1 to include t=0 through t=t_eval\n        Ta = np.zeros(t_eval + 1)\n        Ta[0] = 0.0 # Initial condition\n\n        # Time-stepping loop from t=0 to t=t_eval-1 to compute Ta[1] through Ta[t_eval]\n        for t in range(t_eval):\n            # Determine effective radiative forcing at time t\n            if t  t_stop:\n                R_eff_t = R_eff_on\n            else:\n                R_eff_t = 0.0\n\n            # Forward Euler update rule\n            Ta[t + 1] = Ta[t] + (dt / C) * (R_eff_t - lambda_val * Ta[t])\n\n        # Extract temperatures at required times\n        Ta_t0 = Ta[t0]\n        Ta_teval = Ta[t_eval]\n\n        # Calculate carbon budgets\n        T_co2_0 = gamma * E0\n\n        # Masked budget (includes current aerosol cooling)\n        numerator_masked = T_star - (T_co2_0 + Ta_t0)\n        B_masked = max(0.0, numerator_masked / gamma)\n\n        # True budget (accounts for warming after aerosol removal)\n        numerator_true = T_star - (T_co2_0 + Ta_teval)\n        B_true = max(0.0, numerator_true / gamma)\n\n        # Collect and round results for the current case\n        case_results = [\n            round(Ta_t0, 6),\n            round(Ta_teval, 6),\n            round(B_masked, 6),\n            round(B_true, 6)\n        ]\n        all_results.append(case_results)\n\n    # Format the final output string exactly as specified, without spaces\n    output_str = str(all_results).replace(\" \", \"\")\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}