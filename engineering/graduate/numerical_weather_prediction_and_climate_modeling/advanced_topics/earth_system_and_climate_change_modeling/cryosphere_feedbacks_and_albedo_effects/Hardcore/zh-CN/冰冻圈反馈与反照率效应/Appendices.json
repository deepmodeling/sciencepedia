{
    "hands_on_practices": [
        {
            "introduction": "为了在气候模型中准确表示反馈，我们必须能够量化它们。这个练习使用了一个核心分析技术——线性化——来推导在融化开始时，地表反照率反馈的局部强度。通过计算吸收的短波辐射对地表温度的敏感性 ()，您可以直接衡量这个关键反馈过程的大小。",
            "id": "4086014",
            "problem": "考虑在数值天气预报（NWP）和气候模型中使用的单柱海冰表面方案，其中冰面的净吸收短波辐射由下行短波辐照度和地表短波反照率决定。在融化开始附近，地表经历快速的微物理转变（例如，湿雪变质和早期融池形成），这使得反照率对地表皮温敏感。假设，在融化开始附近的次日时间尺度上，地表的下行短波辐照度（用 $S$ 表示）近似恒定。\n\n使用基本定义，即地表的净吸收短波通量是下行短波通量减去反射部分，其中反射部分由反照率控制。设地表反照率由一个关于融化开始的线性化温度依赖参数化表示，\n$$\n\\alpha(T_s) = \\alpha_0 + \\alpha_1\\, T_s,\n$$\n其中 $T_s$ 是以摄氏度为单位的地表皮温（因此 $T_s = 0$ 对应融化开始），$\\alpha_0$ 是融化开始时的反照率，$\\alpha_1$ 是一个小的常数斜率（单位为 $\\mathrm{K}^{-1}$，等于 $\\mathrm{^{\\circ}C}^{-1}$），代表反照率对温度的一阶敏感性。\n\n仅从基于物理的定义和一阶扰动分析出发，推导地表吸收短波通量对融化开始时 $T_s$ 微小变化的局地敏感性，即求出 $\\frac{\\partial Q_{\\mathrm{abs}}}{\\partial T_s}$ 在 $T_s = 0$ 处的解析表达式。然后，针对以下科学上合理的融化季节午间条件，数值计算该敏感性：\n- $\\alpha_0 = 0.62$，\n- $\\alpha_1 = -1.2 \\times 10^{-2}\\ \\mathrm{K}^{-1}$，\n- $S = 3.20 \\times 10^{2}\\ \\mathrm{W\\, m^{-2}}$。\n\n将最终数值答案四舍五入至四位有效数字。以 $\\mathrm{W\\, m^{-2}\\, K^{-1}}$ 为单位表示该敏感性。",
            "solution": "在尝试求解之前，对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n- 上下文是数值天气预报（NWP）和气候模型中的单柱海冰表面方案。\n- 地表的下行短波辐照度为 $S$，假定为常数。\n- 地表反照率 $\\alpha(T_s)$ 是地表皮温 $T_s$ 的线性化函数：\n$$\n\\alpha(T_s) = \\alpha_0 + \\alpha_1\\, T_s\n$$\n- $T_s$ 是以摄氏度为单位的地表皮温。\n- $T_s = 0$ 对应融化开始。\n- $\\alpha_0$ 是融化开始时的反照率。\n- $\\alpha_1$ 是反照率对温度的一阶敏感性。\n- 任务是推导吸收短波通量 $Q_{\\mathrm{abs}}$ 对 $T_s$ 的敏感性的解析表达式，并在融化开始时求值：$\\frac{\\partial Q_{\\mathrm{abs}}}{\\partial T_s} \\Big|_{T_s=0}$。\n- 第二个任务是使用以下数值计算该敏感性：\n  - $\\alpha_0 = 0.62$\n  - $\\alpha_1 = -1.2 \\times 10^{-2}\\ \\mathrm{K}^{-1}$\n  - $S = 3.20 \\times 10^{2}\\ \\mathrm{W\\, m^{-2}}$\n- 最终数值答案必须四舍五入至四位有效数字，并以 $\\mathrm{W\\, m^{-2}\\, K^{-1}}$ 为单位表示。\n\n### 步骤2：使用提取的已知条件进行验证\n根据既定标准对问题进行评估：\n- **科学依据**：该问题很好地基于气候物理和海冰模拟的原理。温度依赖反照率的概念是冰-反照率反馈机制的关键组成部分，这是气候系统中的一个基本过程。反照率的线性化是对于小温度扰动的标准且有效的近似。提供的融化开始时反照率（$\\alpha_0 = 0.62$）、其对温度的敏感性（$\\alpha_1 = -1.2 \\times 10^{-2}\\ \\mathrm{K}^{-1}$）以及下行短波辐射（$S = 320\\ \\mathrm{W\\, m^{-2}}$）的数值对于极地夏季融化的海冰表面是物理上合理的。$\\alpha_1$ 的负号正确地表示了当表面温度在熔点附近增加时反照率会降低。\n- **适定性**：问题定义清晰。它要求一个特定的数学推导（偏导数）及其随后的数值计算。给定的信息是充分和自洽的，能够导出一个唯一且有意义的解。\n- **客观性**：问题使用精确、客观和科学的术语陈述。它没有任何模糊性、主观性或基于观点的陈述。\n\n问题没有表现出任何列出的无效性缺陷。它在科学上是合理的，结构上是形式化的，内部是一致的，并且在物理上是现实的。\n\n### 步骤3：结论与行动\n问题被判定为**有效**。将推导解答。\n\n### 解答推导\n\n地表的净吸收短波通量，我们记为 $Q_{\\mathrm{abs}}$，定义为入射的下行短波辐照度 $S$ 减去被反射的部分。反射部分是下行辐照度与地表反照率 $\\alpha(T_s)$ 的乘积。\n\n因此，吸收短波通量的控制方程是：\n$$\nQ_{\\mathrm{abs}}(T_s) = S - S \\cdot \\alpha(T_s) = S(1 - \\alpha(T_s))\n$$\n问题提供了一个地表反照率作为地表皮温 $T_s$ 函数的线性化参数化：\n$$\n\\alpha(T_s) = \\alpha_0 + \\alpha_1 T_s\n$$\n将此反照率参数化代入 $Q_{\\mathrm{abs}}(T_s)$ 的方程中，得到：\n$$\nQ_{\\mathrm{abs}}(T_s) = S(1 - (\\alpha_0 + \\alpha_1 T_s))\n$$\n展开此表达式得到：\n$$\nQ_{\\mathrm{abs}}(T_s) = S - S\\alpha_0 - S\\alpha_1 T_s\n$$\n问题要求推导吸收短波通量对 $T_s$ 微小变化的局地敏感性。这在数学上表示为 $Q_{\\mathrm{abs}}$ 对 $T_s$ 的偏导数：\n$$\n\\frac{\\partial Q_{\\mathrm{abs}}}{\\partial T_s} = \\frac{\\partial}{\\partial T_s} (S - S\\alpha_0 - S\\alpha_1 T_s)\n$$\n在此表达式中，$S$、$\\alpha_0$ 和 $\\alpha_1$ 是关于微分变量 $T_s$ 的常数。常数项 $S$ 和 $-S\\alpha_0$ 对 $T_s$ 的导数为 $0$。项 $-S\\alpha_1 T_s$ 对 $T_s$ 的导数为 $-S\\alpha_1$。因此，敏感性为：\n$$\n\\frac{\\partial Q_{\\mathrm{abs}}}{\\partial T_s} = -S\\alpha_1\n$$\n这是敏感性的解析表达式。问题要求在融化开始时，即 $T_s = 0$ 处，计算该敏感性。由于导出的敏感性表达式 $-S\\alpha_1$ 与 $T_s$无关，因此其在 $T_s = 0$ 处的值就是 $-S\\alpha_1$。这是反照率线性模型的一个预期结果，该模型导致了吸收通量的线性模型，其导数为常数。\n\n该结果的物理解释是，它量化了冰-反照率反馈对短波吸收的强度。由于 $\\alpha_1$ 是负的（变暖降低反照率），敏感性 $\\frac{\\partial Q_{\\mathrm{abs}}}{\\partial T_s}$ 是正的，这表明随着地表变暖，它吸收更多的短波辐射，从而促进进一步变暖。\n\n接下来，我们使用所给数值来数值计算该敏感性：\n- $S = 3.20 \\times 10^{2}\\ \\mathrm{W\\, m^{-2}}$\n- $\\alpha_1 = -1.2 \\times 10^{-2}\\ \\mathrm{K}^{-1}$\n\n将这些值代入推导出的表达式中：\n$$\n\\frac{\\partial Q_{\\mathrm{abs}}}{\\partial T_s} \\Big|_{T_s=0} = - (3.20 \\times 10^{2}\\ \\mathrm{W\\, m^{-2}}) \\times (-1.2 \\times 10^{-2}\\ \\mathrm{K}^{-1})\n$$\n$$\n= (3.20 \\times 1.2) \\times (10^{2} \\times 10^{-2})\\ \\mathrm{W\\, m^{-2}\\, K^{-1}}\n$$\n$$\n= 3.84 \\ \\mathrm{W\\, m^{-2}\\, K^{-1}}\n$$\n问题要求最终数值答案四舍五入至四位有效数字。计算值为 $3.84$。为了用四位有效数字表示，我们添加一个尾随零。\n$$\n3.840\\ \\mathrm{W\\, m^{-2}\\, K^{-1}}\n$$\n敏感性的解析表达式是 $-S\\alpha_1$，其数值为 $3.840\\ \\mathrm{W\\, m^{-2}\\, K^{-1}}$。",
            "answer": "$$\\boxed{3.840}$$"
        },
        {
            "introduction": "冰-反照率反馈不仅仅是一个局部效应；它对整个气候系统的稳定性有着深远的影响。本练习将探讨一个简单的能量平衡模型（EBM），以揭示这种反馈如何能够产生多种稳定的气候状态和“临界点”（即鞍结分岔）()。理解这种行为对于预测和解释气候突变至关重要。",
            "id": "3865534",
            "problem": "考虑一个零维能量平衡模型（EBM），用于描述一个气候子系统，其中地表温度 $T$ 根据能量守恒定律演化，\n$$\nC\\,\\frac{dT}{dt} \\;=\\; N(T),\n$$\n其中 $C$ 是一个正的有效热容，$N(T)$ 是大气层顶部的净辐射通量。假设净辐射是吸收的短波辐射和发射的长波辐射之差，其模型基于经过充分检验的黑体发射的 Stefan–Boltzmann 定律和一个依赖于温度的行星反照率，\n$$\nN(T) \\;=\\; S\\,(1-\\alpha(T)) \\;-\\; \\epsilon\\,\\sigma\\,T^{4},\n$$\n其中 $S$ 是有效日照（在整个球面上平均的短波输入），$\\epsilon$ 是有效长波发射率，满足 $0\\epsilon\\leq 1$，而 $\\sigma$ 是 Stefan–Boltzmann 常数。冰-反照率反馈由以下分段线性参数化表示，\n$$\n\\alpha(T) \\;=\\;\n\\begin{cases}\n\\alpha_{i},  T \\le T_{c}-\\Delta, \\\\[6pt]\n\\alpha_{i} \\;+\\; m\\left[T - (T_{c}-\\Delta)\\right],  T_{c}-\\Delta  T  T_{c}+\\Delta, \\\\[6pt]\n\\alpha_{w},  T \\ge T_{c}+\\Delta,\n\\end{cases}\n$$\n其中\n$$\nm \\;=\\; \\frac{\\alpha_{w}-\\alpha_{i}}{2\\,\\Delta}  0,\n$$\n此处 $\\alpha_{i}$ 是高反照率的冰态，$\\alpha_{w}$ 是低反照率的暖态，$T_{c}$ 是一个特征转变温度，而 $\\Delta0$ 设定了转变区间的半宽度。所有参数均为常数。\n\n一个平衡态 $T^{\\ast}$ 满足 $N(T^{\\ast})=0$。平衡态的线性稳定性由 $N'(T^{\\ast})$ 的符号决定：如果 $N'(T^{\\ast})0$，则为线性稳定；如果 $N'(T^{\\ast})0$，则为不稳定。当存在一个温度 $T_{f}$ 同时满足 $N(T_{f})=0$ 和 $N'(T_{f})=0$ 时，对于某个 $S$ 值会发生折叠（鞍-节）分岔，这对应于净辐射曲线与零线相切。\n\n从上述物理定律出发，推导 $N'(T)$ 的表达式，并用它来计算在转变区间 $T_{c}-\\Delta  T  T_{c}+\\Delta$ 内发生折叠分岔时的临界日照 $S_{\\mathrm{fold}}$ 的精确解析表达式（用 $\\epsilon$、$\\sigma$、$\\alpha_{i}$、$\\alpha_{w}$、$T_{c}$ 和 $\\Delta$ 表示）。请将您的最终答案以 $\\mathrm{W}\\,\\mathrm{m}^{-2}$ 为单位，表示为一个单一的闭式解析表达式。无需代入数值，也无需四舍五入。您的推导必须清楚地说明冰-反照率反馈如何改变 $\\frac{d}{dT}N(T)$ 的符号以允许折叠分岔的发生。",
            "solution": "首先验证问题陈述的科学合理性、一致性和完整性。\n\n### 步骤 1：提取已知条件\n问题定义了一个零维能量平衡模型（EBM），包含以下组成部分：\n- **演化方程**：$C\\,\\frac{dT}{dt} = N(T)$，其中 $C0$ 是有效热容，$T$ 是地表温度。\n- **净辐射通量**：$N(T) = S\\,(1-\\alpha(T)) - \\epsilon\\,\\sigma\\,T^{4}$，其中 $S$ 是有效日照，$\\epsilon$ 是长波发射率（$0  \\epsilon \\le 1$），$\\sigma$ 是 Stefan–Boltzmann 常数。\n- **依赖于温度的反照率**：反照率 $\\alpha(T)$ 由一个分段线性函数给出：\n$$\n\\alpha(T) =\n\\begin{cases}\n\\alpha_{i},  T \\le T_{c}-\\Delta \\\\\n\\alpha_{i} + m\\left[T - (T_{c}-\\Delta)\\right],  T_{c}-\\Delta  T  T_{c}+\\Delta \\\\\n\\alpha_{w},  T \\ge T_{c}+\\Delta\n\\end{cases}\n$$\n- **反照率转变斜率**：$m = \\frac{\\alpha_{w}-\\alpha_{i}}{2\\,\\Delta}  0$。此处，$\\alpha_i$ 是冰的反照率，$\\alpha_w$ 是水的反照率，$T_c$ 是一个特征温度，而 $\\Delta  0$ 是转变的半宽度。\n- **平衡条件**：一个平衡温度 $T^{\\ast}$ 满足 $N(T^{\\ast})=0$。\n- **线性稳定性条件**：如果 $N'(T^{\\ast})0$，平衡态是稳定的；如果 $N'(T^{\\ast})0$，则是不稳定的。\n- **折叠分岔条件**：在某个日照 $S$ 值下发生，此时存在一个温度 $T_{f}$ 同时满足 $N(T_{f})=0$ 和 $N'(T_{f})=0$。\n- **关注区域**：规定分岔发生在转变区间内，即 $T_{c}-\\Delta  T_f  T_{c}+\\Delta$。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学基础**：该问题基于气候科学中一个标准的、尽管是简化的能量平衡模型。使用 Stefan-Boltzmann 定律和依赖于温度的反照率来表示冰-反照率反馈的公式是环境建模中一个成熟的概念。给定的关系 $m  0$ 在物理上是正确的，因为较暖的状态（水）比较冷的状态（冰）具有更低的反照率，意味着 $\\alpha_w  \\alpha_i$。\n- **适定性**：问题要求一个可以从给定方程推导出的特定解析表达式。分岔的条件在数学上是精确的，从而导出一个可解的方程组。\n- **客观性**：问题以精确、客观的数学和物理语言陈述。没有主观或模糊的术语。\n- **完整性与一致性**：问题是自洽的。所有必要的参数和方程都已提供。所提供的信息中没有明显的矛盾。\n\n### 步骤 3：结论与行动\n该问题是有效的。这是一个应用于气候子系统模型的分岔分析问题，具有良好的适定性和科学基础。我现在将开始推导解答。\n\n### 解答推导\n目标是找到发生折叠分岔时的临界日照 $S_{\\mathrm{fold}}$。这需要求解由两个方程组成的方程组，$N(T_f)=0$ 和 $N'(T_f)=0$，以得到 $S$ 和 $T_f$，其中 $T_f$ 位于转变区间 $T_{c}-\\Delta  T_f  T_{c}+\\Delta$ 内。\n\n首先，我们通过代入 $\\alpha(T)$ 在转变区间内的相应形式，写出净辐射 $N(T)$ 的表达式：\n$$\nN(T) = S\\left(1 - \\left(\\alpha_{i} + m\\left[T - (T_{c}-\\Delta)\\right]\\right)\\right) - \\epsilon\\sigma T^4\n$$\n$$\nN(T) = S\\left(1 - \\alpha_{i} - m(T - T_c + \\Delta)\\right) - \\epsilon\\sigma T^4\n$$\n接下来，我们推导 $N(T)$ 相对于 $T$ 的导数表达式，即 $N'(T) = \\frac{d}{dT}N(T)$。\n$$\nN'(T) = \\frac{d}{dT} \\left[ S\\left(1 - \\alpha_{i} - m(T - T_c + \\Delta)\\right) - \\epsilon\\sigma T^4 \\right]\n$$\n$$\nN'(T) = -S m - 4\\epsilon\\sigma T^3\n$$\n这个导数 $N'(T)$ 决定了平衡态的稳定性。它由两项组成：\n1.  $-4\\epsilon\\sigma T^3$ 项是 Planck 反馈。由于所有量都是正的，这一项总是负的。它代表一种稳定化反馈：温度升高导致更强的长波辐射发射，从而冷却系统。\n2.  $-S m$ 项代表冰-反照率反馈。由于日照 $S  0$ 且斜率 $m  0$（因为 $\\alpha_w  \\alpha_i$），这一项是正的。它代表一种非稳定化反馈：温度升高导致冰融化，降低反照率，增加吸收的辐射，并进一步升高温度。\n\n要发生折叠分岔，$N'(T)$ 必须能够改变符号。如果不存在冰-反照率反馈（$m=0$），那么对于所有 $T0$，都有 $N'(T) = -4\\epsilon\\sigma T^3  0$。系统将永远是稳定的，不会发生分岔。因此，由冰-反照率反馈产生的正项 $-Sm$ 是能够抵消稳定化的 Planck 反馈的关键机制，从而允许 $N'(T) > 0$（不稳定平衡）和 $N'(T)=0$（分岔点）的出现。\n\n在折叠分岔温度 $T_f$ 处，必须同时满足两个条件：\n1) $N(T_f) = S_{\\mathrm{fold}}\\left(1 - \\alpha_{i} - m(T_f - T_c + \\Delta)\\right) - \\epsilon\\sigma T_f^4 = 0$\n2) $N'(T_f) = -S_{\\mathrm{fold}} m - 4\\epsilon\\sigma T_f^3 = 0$\n\n从科学角度看，$S_{\\mathrm{fold}}$ 是日照参数 $S$ 在分岔发生时的特定值。我们从第二个方程中解出 $S_{\\mathrm{fold}}$（用 $T_f$ 表示）：\n$$\nS_{\\mathrm{fold}} = -\\frac{4\\epsilon\\sigma T_f^3}{m}\n$$\n现在，将这个 $S_{\\mathrm{fold}}$ 的表达式代入第一个方程：\n$$\n\\left(-\\frac{4\\epsilon\\sigma T_f^3}{m}\\right) \\left(1 - \\alpha_{i} - m(T_f - T_c + \\Delta)\\right) - \\epsilon\\sigma T_f^4 = 0\n$$\n假设 $T_f  0$ 且 $\\epsilon\\sigma \\ne 0$，我们可以将整个方程除以 $\\epsilon\\sigma T_f^3$：\n$$\n-\\frac{4}{m} \\left(1 - \\alpha_{i} - m(T_f - T_c + \\Delta)\\right) - T_f = 0\n$$\n分配 $-\\frac{4}{m}$ 项：\n$$\n-\\frac{4(1 - \\alpha_{i})}{m} - (-\\frac{4}{m}) m(T_f - T_c + \\Delta) - T_f = 0\n$$\n$$\n-\\frac{4(1 - \\alpha_{i})}{m} + 4(T_f - T_c + \\Delta) - T_f = 0\n$$\n合并包含 $T_f$ 的项并解出 $T_f$：\n$$\n3T_f = 4(T_c - \\Delta) + \\frac{4(1 - \\alpha_{i})}{m}\n$$\n$$\nT_f = \\frac{4}{3}(T_c - \\Delta) + \\frac{4(1 - \\alpha_{i})}{3m}\n$$\n现在我们得到了用模型参数表示的分岔温度 $T_f$。为了找到 $S_{\\mathrm{fold}}$，我们将这个 $T_f$ 的表达式代回到方程 $S_{\\mathrm{fold}} = -4\\epsilon\\sigma T_f^3 / m$ 中：\n$$\nS_{\\mathrm{fold}} = -\\frac{4\\epsilon\\sigma}{m} \\left[ \\frac{4}{3}(T_c - \\Delta) + \\frac{4(1 - \\alpha_{i})}{3m} \\right]^3\n$$\n为了用给定的基本参数表示这个式子，我们代入 $m = \\frac{\\alpha_{w}-\\alpha_{i}}{2\\,\\Delta}$：\n$$\nS_{\\mathrm{fold}} = -\\frac{4\\epsilon\\sigma}{\\frac{\\alpha_{w}-\\alpha_{i}}{2\\,\\Delta}} \\left[ \\frac{4}{3} \\left( (T_c - \\Delta) + \\frac{1 - \\alpha_{i}}{\\frac{\\alpha_{w}-\\alpha_{i}}{2\\,\\Delta}} \\right) \\right]^3\n$$\n$$\nS_{\\mathrm{fold}} = -\\frac{8\\Delta\\epsilon\\sigma}{\\alpha_{w}-\\alpha_{i}} \\left[ \\frac{4}{3} \\left( (T_c - \\Delta) + \\frac{2\\Delta(1 - \\alpha_{i})}{\\alpha_{w}-\\alpha_{i}} \\right) \\right]^3\n$$\n让我们将这个表达式简化为单一的闭式形式。我们可以提出 $(\\frac{4}{3})^3$ 项：\n$$\nS_{\\mathrm{fold}} = -\\frac{8\\Delta\\epsilon\\sigma}{\\alpha_{w}-\\alpha_{i}} \\frac{64}{27} \\left( (T_c - \\Delta) + \\frac{2\\Delta(1 - \\alpha_{i})}{\\alpha_{w}-\\alpha_{i}} \\right)^3\n$$\n$$\nS_{\\mathrm{fold}} = -\\frac{512\\Delta\\epsilon\\sigma}{27(\\alpha_{w}-\\alpha_{i})} \\left( \\frac{(T_c - \\Delta)(\\alpha_{w}-\\alpha_{i}) + 2\\Delta(1 - \\alpha_{i})}{\\alpha_{w}-\\alpha_{i}} \\right)^3\n$$\n$$\nS_{\\mathrm{fold}} = -\\frac{512\\Delta\\epsilon\\sigma \\left[ (T_c - \\Delta)(\\alpha_{w}-\\alpha_{i}) + 2\\Delta(1 - \\alpha_{i}) \\right]^3}{27(\\alpha_{w}-\\alpha_{i})^4}\n$$\n方括号中的项可以展开：\n$$\n(T_c - \\Delta)(\\alpha_{w}-\\alpha_{i}) + 2\\Delta(1 - \\alpha_{i}) = T_c(\\alpha_{w}-\\alpha_{i}) - \\Delta(\\alpha_{w}-\\alpha_{i}) + 2\\Delta - 2\\Delta\\alpha_i\n$$\n$$\n= T_c(\\alpha_{w}-\\alpha_{i}) - \\Delta\\alpha_{w} + \\Delta\\alpha_i + 2\\Delta - 2\\Delta\\alpha_i = T_c(\\alpha_{w}-\\alpha_{i}) - \\Delta\\alpha_{w} - \\Delta\\alpha_i + 2\\Delta\n$$\n$$\n= T_c(\\alpha_{w}-\\alpha_{i}) - \\Delta(\\alpha_{w}+\\alpha_i-2)\n$$\n将此代回到 $S_{\\mathrm{fold}}$ 的表达式中：\n$$\nS_{\\mathrm{fold}} = -\\frac{512\\Delta\\epsilon\\sigma \\left[ T_c(\\alpha_{w}-\\alpha_{i}) - \\Delta(\\alpha_{w}+\\alpha_i-2) \\right]^3}{27(\\alpha_{w}-\\alpha_{i})^4}\n$$\n为了消除前面的负号，我们可以反转立方内的项，因为 $-(A-B)^3 = (B-A)^3$：\n$$\nS_{\\mathrm{fold}} = \\frac{512\\Delta\\epsilon\\sigma \\left[ \\Delta(\\alpha_{w}+\\alpha_i-2) - T_c(\\alpha_{w}-\\alpha_{i}) \\right]^3}{27(\\alpha_{w}-\\alpha_{i})^4}\n$$\n这就是在折叠分岔点处临界日照的最终解析表达式，用模型的基本参数表示。",
            "answer": "$$ \\boxed{ \\frac{512\\Delta\\epsilon\\sigma \\left[\\Delta(\\alpha_w+\\alpha_i-2) - T_c(\\alpha_w-\\alpha_i)\\right]^3}{27(\\alpha_w-\\alpha_i)^4} } $$"
        },
        {
            "introduction": "将理论付诸实践是建模科学的核心。在这个练习中，您将通过编写一个计算机程序来数值求解一个更真实的地表能量平衡方程 ()。您需要整合辐射通量、湍流通量以及一个复杂的反照率反馈参数化方案，以找到平衡地表温度，这是天气和气候模型中的一项基本任务。",
            "id": "4029213",
            "problem": "考虑在数值天气预报和气候模拟中使用的单柱框架下的一个水平均质陆面单元。任务是通过求解满足地表能量守恒的平衡地表温度 $T_s$（单位为开尔文）来闭合地表能量平衡，同时明确考虑冰冻圈驱动的反照率反馈。从应用于地表控制体的能量守恒出发，在平衡状态下，净地表能量趋势必须为零。对于干燥地表，忽略潜热通量，并假设感热通量和地热通量采用线性整体空气动力学公式，您必须建立平衡方程并确定 $T_s$ 使得残差等于零。\n\n使用以下基本原理和定义作为出发点：\n\n- 地表层的能量守恒表明，在平衡状态下，所有进入地表的能量通量之和等于所有离开地表的能量通量之和，从而产生一个在平衡时必须等于零的残差函数 $F(T_s)$。\n- 地表吸收的净短波辐射由 $(1 - \\alpha(T_s)) S_\\downarrow$ 给出，其中反照率 $\\alpha(T_s)$ 是一个与温度相关的函数，捕捉了冰冻圈从积雪（$\\alpha$ 高）到无雪（$\\alpha$ 低）状态的转变。使用平滑的逻辑斯蒂函数来模拟反照率反馈：\n$$\n\\alpha(T_s) = \\alpha_{\\mathrm{bare}} + \\frac{\\alpha_{\\mathrm{snow}} - \\alpha_{\\mathrm{bare}}}{1 + \\exp\\left(\\frac{T_s - T_m}{\\Delta}\\right)} \\, ,\n$$\n其中 $\\alpha_{\\mathrm{snow}}$ 是雪的反照率，$\\alpha_{\\mathrm{bare}}$ 是无雪地面的反照率，$T_m$ 是融化转变温度，$\\Delta$ 是控制转变陡峭程度的逻辑斯蒂斜率尺度。\n- 地表净长波辐射为 $L_\\downarrow - \\varepsilon \\sigma T_s^4$，其中 $L_\\downarrow$ 是来自大气的向下长波辐射，$\\varepsilon$ 是地表发射率，$\\sigma$ 是 Stefan–Boltzmann 常数。\n- 感热通量参数化为 $H = C_H (T_s - T_a)$，其中 $C_H$ 是整体输送系数（单位为 $\\mathrm{W\\,m^{-2}\\,K^{-1}}$），$T_a$ 是近地表气温（单位为开尔文）。\n- 地（土壤）热通量参数化为 $G = C_G (T_s - T_d)$，其中 $C_G$ 是耦合系数（单位为 $\\mathrm{W\\,m^{-2}\\,K^{-1}}$），$T_d$ 是深层土壤温度（单位为开尔文）。\n- Stefan–Boltzmann 常数为 $\\sigma = 5.670374419 \\times 10^{-8}\\ \\mathrm{W\\,m^{-2}\\,K^{-4}}$。\n- 发射率为 $\\varepsilon \\in (0,1]$。\n\n通过净辐射减去湍流通量和地热通量来定义残差函数 $F(T_s)$，并求解 $T_s$ 使得 $F(T_s) = 0$。\n\n你的任务是编写一个完整、可运行的程序，该程序：\n\n1. 实现上述基于物理的残差函数 $F(T_s)$。\n2. 通过在物理上合理的区间内寻找 $F(T_s)$ 的根，稳健地计算平衡地表温度 $T_s$。\n3. 使用以下科学上合理的参数集测试套件，这些参数集探测了不同的状况，包括中纬度冬季晴天、有雪存在的情况、极夜、近融化过渡以及伴随强日照的暖空气入侵。对于每种情况，都指定了所有的量和单位：\n\n- 情况1（中纬度冬季晴天，有雪存在）：\n    - $S_\\downarrow = 300\\ \\mathrm{W\\,m^{-2}}$\n    - $L_\\downarrow = 250\\ \\mathrm{W\\,m^{-2}}$\n    - $T_a = 268\\ \\mathrm{K}$\n    - $T_d = 265\\ \\mathrm{K}$\n    - $C_H = 10\\ \\mathrm{W\\,m^{-2}\\,K^{-1}}$\n    - $C_G = 5\\ \\mathrm{W\\,m^{-2}\\,K^{-1}}$\n    - $\\alpha_{\\mathrm{snow}} = 0.8$\n    - $\\alpha_{\\mathrm{bare}} = 0.2$\n    - $T_m = 273.15\\ \\mathrm{K}$\n    - $\\Delta = 2.0\\ \\mathrm{K}$\n    - $\\varepsilon = 0.98$\n\n- 情况2（极夜，强逆温）：\n    - $S_\\downarrow = 0\\ \\mathrm{W\\,m^{-2}}$\n    - $L_\\downarrow = 150\\ \\mathrm{W\\,m^{-2}}$\n    - $T_a = 255\\ \\mathrm{K}$\n    - $T_d = 250\\ \\mathrm{K}$\n    - $C_H = 15\\ \\mathrm{W\\,m^{-2}\\,K^{-1}}$\n    - $C_G = 3\\ \\mathrm{W\\,m^{-2}\\,K^{-1}}$\n    - $\\alpha_{\\mathrm{snow}} = 0.8$\n    - $\\alpha_{\\mathrm{bare}} = 0.2$\n    - $T_m = 273.15\\ \\mathrm{K}$\n    - $\\Delta = 2.0\\ \\mathrm{K}$\n    - $\\varepsilon = 0.98$\n\n- 情况3（近融化过渡，强日照）：\n    - $S_\\downarrow = 500\\ \\mathrm{W\\,m^{-2}}$\n    - $L_\\downarrow = 300\\ \\mathrm{W\\,m^{-2}}$\n    - $T_a = 271\\ \\mathrm{K}$\n    - $T_d = 268\\ \\mathrm{K}$\n    - $C_H = 12\\ \\mathrm{W\\,m^{-2}\\,K^{-1}}$\n    - $C_G = 6\\ \\mathrm{W\\,m^{-2}\\,K^{-1}}$\n    - $\\alpha_{\\mathrm{snow}} = 0.8$\n    - $\\alpha_{\\mathrm{bare}} = 0.2$\n    - $T_m = 273.15\\ \\mathrm{K}$\n    - $\\Delta = 2.0\\ \\mathrm{K}$\n    - $\\varepsilon = 0.98$\n\n- 情况4（暖空气入侵，极强日照）：\n    - $S_\\downarrow = 700\\ \\mathrm{W\\,m^{-2}}$\n    - $L_\\downarrow = 350\\ \\mathrm{W\\,m^{-2}}$\n    - $T_a = 280\\ \\mathrm{K}$\n    - $T_d = 275\\ \\mathrm{K}$\n    - $C_H = 10\\ \\mathrm{W\\,m^{-2}\\,K^{-1}}$\n    - $C_G = 5\\ \\mathrm{W\\,m^{-2}\\,K^{-1}}$\n    - $\\alpha_{\\mathrm{snow}} = 0.8$\n    - $\\alpha_{\\mathrm{bare}} = 0.2$\n    - $T_m = 273.15\\ \\mathrm{K}$\n    - $\\Delta = 2.0\\ \\mathrm{K}$\n    - $\\varepsilon = 0.98$\n\n实现细节：\n\n- 将每个测试用例的最终平衡地表温度以 $\\mathrm{K}$ 为单位表示，并四舍五入到两位小数。\n- 对 $T_s$ 使用一个物理上合理的求根区间，例如 $[220\\ \\mathrm{K},\\ 310\\ \\mathrm{K}]$，并采用一种适用于具有潜在反馈的非线性方程的稳健求根方法。\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔的结果列表，例如 $[T_{s,1},T_{s,2},T_{s,3},T_{s,4}]$，每个 $T_{s,i}$ 都格式化为两位小数，其数值隐式地以 $\\mathrm{K}$ 为单位。\n\n通过保持所有参数值和函数形式与物理定律一致来确保科学真实性，并且除了上面提供的基本定义之外，不要使用任何捷径。每个测试用例的答案必须是浮点数。",
            "solution": "通过闭合地表能量平衡来确定平衡地表温度 $T_s$ 的问题是气候和大气科学中的一个基本课题。问题陈述在科学上是合理的，适定于数值求解，并提供了所有必要的参数和物理公式。我们将进行正式求解。\n\n主导原则是地表能量守恒。在平衡状态下，进入地表的净能量通量必须为零。总通量由辐射和非辐射分量组成。我们定义一个残差函数 $F(T_s)$，表示进入地表的净能量通量。平衡温度 $T_s$ 是使 $F(T_s) = 0$ 的值。\n\n能量通量定义如下，指向地表的通量被认为是正值：\n$1$. 净短波辐射 ($R_{s,net}$): 入射太阳辐射 ($S_\\downarrow$) 中被地表吸收的部分。它由 $R_{s,net} = (1 - \\alpha(T_s)) S_\\downarrow$ 给出，其中 $\\alpha(T_s)$ 是地表反照率。\n$2$. 净长波辐射 ($R_{l,net}$): 来自大气的向下长波辐射 ($L_\\downarrow$) 与地表向上发射的热辐射 ($L_\\uparrow$) 之间的差值。根据 Stefan-Boltzmann 定律，$L_\\uparrow = \\varepsilon \\sigma T_s^4$，其中 $\\varepsilon$ 是地表发射率，$\\sigma$ 是 Stefan-Boltzmann 常数。因此，$R_{l,net} = L_\\downarrow - \\varepsilon \\sigma T_s^4$。\n$3$. 感热通量 ($H$): 由于温度差异，地表与大气之间的热通量。它被定义为离开地表的通量，$H = C_H (T_s - T_a)$，其中 $C_H$ 是整体输送系数，$T_a$ 是近地表气温。\n$4$. 地热通量 ($G$): 进入下层土壤或冰的热通量。它也被定义为离开地表的通量，$G = C_G (T_s - T_d)$，其中 $C_G$ 是土壤耦合系数，$T_d$ 是深层土壤温度。\n\n总能量平衡方程是净辐射通量之和减去离开地表的湍流通量和地热通量：\n$$\nF(T_s) = R_{s,net} + R_{l,net} - H - G = 0\n$$\n代入每个通量的表达式，我们得到残差函数的显式形式：\n$$\nF(T_s) = (1 - \\alpha(T_s)) S_\\downarrow + L_\\downarrow - \\varepsilon \\sigma T_s^4 - C_H (T_s - T_a) - C_G (T_s - T_d)\n$$\n反照率 $\\alpha(T_s)$ 不是一个常数，而是地表温度本身的函数。这代表了一个关键的冰冻圈反馈：当地表变暖超过水的熔点时，雪和冰会融化，急剧降低地表反射率，从而导致进一步吸收太阳辐射。这使用逻辑斯蒂函数进行建模：\n$$\n\\alpha(T_s) = \\alpha_{\\mathrm{bare}} + \\frac{\\alpha_{\\mathrm{snow}} - \\alpha_{\\mathrm{bare}}}{1 + \\exp\\left(\\frac{T_s - T_m}{\\Delta}\\right)}\n$$\n此处，$\\alpha_{\\mathrm{snow}}$ 是积雪地表的反照率，$\\alpha_{\\mathrm{bare}}$ 是无雪地表的反照率，$T_m$ 是融化转变温度（例如 $273.15\\ \\mathrm{K}$），$\\Delta$ 是一个决定转变陡峭程度的尺度参数。当温度 $T_s \\ll T_m$ 时，$\\alpha(T_s) \\to \\alpha_{\\mathrm{snow}}$。当温度 $T_s \\gg T_m$ 时，$\\alpha(T_s) \\to \\alpha_{\\mathrm{bare}}$。\n\n由于 $T_s^4$ 项和 $\\alpha(T_s)$ 中的指数项，方程 $F(T_s) = 0$ 是一个关于 $T_s$ 的非线性超越方程。该方程没有通用的解析解，因此需要使用数值求根算法。问题为求解指定了一个 $[220\\ \\mathrm{K}, 310\\ \\mathrm{K}]$ 的求根区间。函数 $F(T_s)$ 的一个关键特性是，对于非常低的 $T_s$，出射辐射项 $\\varepsilon \\sigma T_s^4$ 很小，$F(T_s)$ 通常为正。对于非常高的 $T_s$，这个 $T_s^4$ 项占主导地位，使得 $F(T_s)$ 呈强负值。这确保了如果函数是连续的，在足够宽的区间内必定存在至少一个根。反照率反馈项的存在，在某些条件下可能导致多重平衡态，但像 Brent 方法这样的区间法，如果区间端点的函数值符号相反，就能可靠地找到一个根。\n\n解决该问题的算法如下：\n$1$. 按照定义实现反照率函数 $\\alpha(T_s)$。\n$2$. 使用完整的能量平衡方程实现残差函数 $F(T_s)$。\n$3$. 对于提供的四个测试用例中的每一个，将指定的参数值提供给函数 $F(T_s)$。\n$4$. 使用一个稳健的数值求根算法，例如 Brent 方法 (`scipy.optimize.brentq`)，在物理上合理的区间 $[220\\ \\mathrm{K}, 310\\ \\mathrm{K}]$ 内找到 $F(T_s)=0$ 的根。\n$5$. 收集每个案例得到的平衡地表温度 $T_s$，将其格式化为两位小数，并以指定的输出格式呈现。\n\n每个案例的物理参数是：\n- Stefan-Boltzmann 常数，$\\sigma = 5.670374419 \\times 10^{-8}\\ \\mathrm{W\\,m^{-2}\\,K^{-4}}$。\n- 发射率，$\\varepsilon = 0.98$。\n- 融化温度，$T_m = 273.15\\ \\mathrm{K}$。\n- 反照率转变宽度，$\\Delta = 2.0\\ \\mathrm{K}$。\n- 问题陈述中给出了每个案例特定的 $S_\\downarrow$、$L_\\downarrow$、$T_a$、$T_d$、$C_H$、$C_G$、$\\alpha_{\\mathrm{snow}}$ 和 $\\alpha_{\\mathrm{bare}}$ 参数，并将在数值实现中使用。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves for the equilibrium surface temperature by finding the root of the \n    surface energy balance equation for multiple test cases.\n    \"\"\"\n    \n    # Define the Stefan-Boltzmann constant\n    sigma = 5.670374419e-8  # W m^-2 K^-4\n\n    # Define the test cases from the problem statement as a list of dictionaries.\n    test_cases = [\n        # Case 1 (midlatitude winter sun, snow present)\n        {\n            \"S_down\": 300.0, \"L_down\": 250.0, \"Ta\": 268.0, \"Td\": 265.0,\n            \"CH\": 10.0, \"CG\": 5.0, \"alpha_snow\": 0.8, \"alpha_bare\": 0.2,\n            \"Tm\": 273.15, \"Delta\": 2.0, \"epsilon\": 0.98\n        },\n        # Case 2 (polar night, strong inversion)\n        {\n            \"S_down\": 0.0, \"L_down\": 150.0, \"Ta\": 255.0, \"Td\": 250.0,\n            \"CH\": 15.0, \"CG\": 3.0, \"alpha_snow\": 0.8, \"alpha_bare\": 0.2,\n            \"Tm\": 273.15, \"Delta\": 2.0, \"epsilon\": 0.98\n        },\n        # Case 3 (near-melting transition, strong sun)\n        {\n            \"S_down\": 500.0, \"L_down\": 300.0, \"Ta\": 271.0, \"Td\": 268.0,\n            \"CH\": 12.0, \"CG\": 6.0, \"alpha_snow\": 0.8, \"alpha_bare\": 0.2,\n            \"Tm\": 273.15, \"Delta\": 2.0, \"epsilon\": 0.98\n        },\n        # Case 4 (warm-air intrusion, very strong sun)\n        {\n            \"S_down\": 700.0, \"L_down\": 350.0, \"Ta\": 280.0, \"Td\": 275.0,\n            \"CH\": 10.0, \"CG\": 5.0, \"alpha_snow\": 0.8, \"alpha_bare\": 0.2,\n            \"Tm\": 273.15, \"Delta\": 2.0, \"epsilon\": 0.98\n        },\n    ]\n\n    def albedo_func(Ts, alpha_snow, alpha_bare, Tm, Delta):\n        \"\"\"Calculates temperature-dependent surface albedo using a logistic function.\"\"\"\n        return alpha_bare + (alpha_snow - alpha_bare) / (1.0 + np.exp((Ts - Tm) / Delta))\n\n    def residual_F(Ts, S_down, L_down, Ta, Td, CH, CG, alpha_snow, alpha_bare, Tm, Delta, epsilon):\n        \"\"\"\n        Calculates the residual of the surface energy balance equation.\n        F(Ts) = Net Radiation - Sensible Heat Flux - Ground Heat Flux\n        \"\"\"\n        # Calculate current albedo\n        alpha = albedo_func(Ts, alpha_snow, alpha_bare, Tm, Delta)\n        \n        # Radiative fluxes (towards surface is positive)\n        net_sw = (1.0 - alpha) * S_down\n        net_lw = L_down - epsilon * sigma * Ts**4\n        \n        # Non-radiative fluxes (away from surface is positive convention, so subtract)\n        H = CH * (Ts - Ta)\n        G = CG * (Ts - Td)\n        \n        # Residual of all fluxes\n        residual = net_sw + net_lw - H - G\n        return residual\n\n    results = []\n    # Define the bracketing interval for the root finder\n    bracket = [220.0, 310.0]\n\n    for case in test_cases:\n        # Define arguments for the residual function from the case dictionary\n        args = (\n            case[\"S_down\"], case[\"L_down\"], case[\"Ta\"], case[\"Td\"],\n            case[\"CH\"], case[\"CG\"], case[\"alpha_snow\"], case[\"alpha_bare\"],\n            case[\"Tm\"], case[\"Delta\"], case[\"epsilon\"]\n        )\n        \n        # Find the root of the residual function F(Ts) = 0\n        try:\n            Ts_equilibrium = brentq(residual_F, bracket[0], bracket[1], args=args)\n            # Append the result rounded to two decimal places\n            results.append(round(Ts_equilibrium, 2))\n        except ValueError:\n            # Handle cases where root is not bracketed, though not expected here\n            results.append(np.nan)\n\n    # Final print statement in the exact required format.\n    # The output spec asks for \"formatted to two decimals\", which is achieved\n    # by using .2f format specifier. The result is a list of floats,\n    # which are then converted to strings for printing.\n    print(f\"[{','.join([f'{r:.2f}' for r in results])}]\")\n\nsolve()\n```"
        }
    ]
}