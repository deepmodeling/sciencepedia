{
    "hands_on_practices": [
        {
            "introduction": "植被与大气之间错综复杂的相互作用始于地表，这里是能量和水分交换的地方。第一个实践将我们的理解建立在陆地-大气耦合的基本物理学之上，探索由气孔（以阻力形式表示）的生理控制如何与地表能量平衡相互作用。通过从第一性原理推导净辐射和冠层温度之间的关系，你将深入了解气候系统中的一个关键反馈机制。",
            "id": "4028684",
            "problem": "在一个数值天气预报（NWP）配置中，动态全球植被模型（DGVM）中的单层冠层通过能量平衡和气孔控制与大气边界层耦合。假设在正午时分，冠层-空气界面处于稳态能量平衡，储存热通量和地表热通量可忽略不计，并且热量和水汽的湍流输送可以用串联电阻表示。在此时间步长，气孔阻力由DGVM碳循环求解器给定。使用以下物理上一致的参数：\n- 净辐射：$R_n = 350$ W m$^{-2}$。\n- 空气密度：$\\rho = 1.20$ kg m$^{-3}$。\n- 恒压下空气比热：$c_p = 1.005 \\times 10^{3}$ J kg$^{-1}$ K$^{-1}$。\n- 蒸发潜热：$\\lambda = 2.45 \\times 10^{6}$ J kg$^{-1}$。\n- 热量和水汽的空气动力学阻力：$r_a = 5.0 \\times 10^{1}$ s m$^{-1}$。\n- 水汽的气孔（表面）阻力：$r_s = 1.00 \\times 10^{2}$ s m$^{-1}$。\n- 空气温度下饱和水汽压曲线的斜率：$s = 1.89 \\times 10^{2}$ Pa K$^{-1}$。\n- 干湿表常数：$\\gamma = 6.60 \\times 10^{1}$ Pa K$^{-1}$。\n- 水汽压亏缺：$D = 1.50 \\times 10^{3}$ Pa。\n\n仅从感热和水汽的通量-梯度关系定义、比湿和水汽压之间的理想气体关系以及地表的稳态能量平衡出发，推导冠层与空气的温差 $\\Delta T = T_s - T_a$ 作为给定量的函数的解析表达式。然后，使用上述参数计算该表达式的值。将最终数值答案四舍五入至三位有效数字，并以K为单位表示温度增量。",
            "solution": "该问题要求推导冠层与空气温差 $\\Delta T = T_s - T_a$ 的解析表达式，并根据一组给定参数进行数值计算。推导将从指定的能量平衡和通量-梯度关系的基本原理开始。\n\n控制原理如下：\n1.  **稳态能量平衡：** 在冠层-空气界面，当储存热通量和地表热通量可忽略不计时，净辐射（$R_n$）由感热通量（$H$）和潜热通量（$\\lambda E$）平衡。\n    $$R_n = H + \\lambda E$$\n    其中 $\\lambda$ 是蒸发潜热，$E$ 是水汽通量（蒸散）。\n\n2.  **通量-梯度关系（电阻类比）：**\n    感热和水汽的湍流通量使用电阻类比来定义。\n    从温度为 $T_s$ 的冠层表面到温度为 $T_a$ 的空气的感热通量为：\n    $$H = \\rho c_p \\frac{T_s - T_a}{r_a} = \\rho c_p \\frac{\\Delta T}{r_a}$$\n    其中 $\\rho$ 是空气密度，$c_p$ 是恒压下空气比热，$r_a$ 是热量的空气动力学阻力。\n\n    潜热通量涉及水汽从温度为 $T_s$ 的饱和表面到周围空气的输送。总阻力是空气动力学阻力（$r_a$）和表面（气孔）阻力（$r_s$）之和。该通量由比湿梯度 $q_s(T_s) - q_a$ 驱动。\n    $$\\lambda E = \\lambda \\rho \\frac{q_s(T_s) - q_a}{r_a + r_s}$$\n    比湿（$q$）可以通过理想气体定律和干湿表常数的定义 $\\gamma = \\frac{c_p P}{\\epsilon \\lambda}$（其中 $P$ 是大气压力，$\\epsilon$ 是水与干空气的摩尔质量之比）与水汽压（$e$）联系起来。这导出了关系式 $\\lambda E = \\frac{\\rho c_p}{\\gamma} \\frac{e_s(T_s) - e_a}{r_a + r_s}$，其中 $e_s(T_s)$ 是表面温度 $T_s$ 下的饱和水汽压，$e_a$ 是周围空气的水汽压。\n\n3.  **饱和水汽压的线性化：**\n    为了将表面水汽压 $e_s(T_s)$ 与空气温度 $T_a$ 联系起来，我们使用围绕 $T_a$ 的一阶泰勒展开。问题给出了在 $T_a$ 处计算的饱和水汽压曲线斜率 $s = \\frac{de_s}{dT}$。\n    $$e_s(T_s) \\approx e_s(T_a) + s(T_s - T_a) = e_s(T_a) + s \\Delta T$$\n    其中 $e_s(T_a)$ 是空气温度下的饱和水汽压。\n\n水汽压差项 $e_s(T_s) - e_a$ 现在可以用饱和水汽压亏缺 $D = e_s(T_a) - e_a$ 和 $\\Delta T$ 来表示：\n$$e_s(T_s) - e_a = (e_s(T_a) + s \\Delta T) - e_a = (e_s(T_a) - e_a) + s \\Delta T = D + s \\Delta T$$\n将此代入潜热通量的表达式中，得到：\n$$\\lambda E = \\frac{\\rho c_p}{\\gamma} \\frac{D + s \\Delta T}{r_a + r_s}$$\n\n现在，我们将 $H$ 和 $\\lambda E$ 的表达式代入能量平衡方程：\n$$R_n = \\left(\\rho c_p \\frac{\\Delta T}{r_a}\\right) + \\left(\\frac{\\rho c_p}{\\gamma} \\frac{D + s \\Delta T}{r_a + r_s}\\right)$$\n我们的目标是解出此方程中的 $\\Delta T$。我们重新整理方程，将含有 $\\Delta T$ 的项组合在一起：\n$$R_n = \\frac{\\rho c_p}{r_a}\\Delta T + \\frac{\\rho c_p D}{\\gamma (r_a + r_s)} + \\frac{\\rho c_p s \\Delta T}{\\gamma (r_a + r_s)}$$\n$$R_n - \\frac{\\rho c_p D}{\\gamma (r_a + r_s)} = \\Delta T \\left(\\frac{\\rho c_p}{r_a} + \\frac{\\rho c_p s}{\\gamma (r_a + r_s)}\\right)$$\n解出 $\\Delta T$：\n$$\\Delta T = \\frac{R_n - \\frac{\\rho c_p D}{\\gamma (r_a + r_s)}}{\\rho c_p \\left(\\frac{1}{r_a} + \\frac{s}{\\gamma (r_a + r_s)}\\right)}$$\n为了获得更紧凑的形式，我们可以通过 $\\Delta T = \\frac{H r_a}{\\rho c_p}$ 将 $\\Delta T$ 与 $H$ 联系起来。我们首先求解能量平衡方程以得到 $H$。\n$$R_n = H + \\lambda E \\implies R_n = H + \\frac{\\rho c_p D + s (\\rho c_p \\frac{\\Delta T}{r_a}) r_a}{\\gamma(r_a+r_s)} = H + \\frac{\\rho c_p D + s H r_a}{\\gamma(r_a+r_s)}$$\n$$R_n \\gamma (r_a+r_s) = H \\gamma (r_a+r_s) + \\rho c_p D + s H r_a$$\n$$R_n \\gamma (r_a+r_s) - \\rho c_p D = H \\left( \\gamma (r_a+r_s) + s r_a \\right)$$\n$$H = \\frac{R_n \\gamma (r_a+r_s) - \\rho c_p D}{\\gamma (r_a+r_s) + s r_a}$$\n将此代入关系式 $\\Delta T = \\frac{H r_a}{\\rho c_p}$，我们得到冠层与空气温差的最终解析表达式：\n$$\\Delta T = \\frac{r_a}{\\rho c_p} \\left( \\frac{R_n \\gamma (r_a+r_s) - \\rho c_p D}{\\gamma (r_a+r_s) + s r_a} \\right)$$\n\n现在，我们使用给定的参数来计算这个表达式的值：\n$R_n = 350$ W m$^{-2}$\n$\\rho = 1.20$ kg m$^{-3}$\n$c_p = 1.005 \\times 10^{3}$ J kg$^{-1}$ K$^{-1}$\n$r_a = 5.0 \\times 10^{1}$ s m$^{-1}$\n$r_s = 1.00 \\times 10^{2}$ s m$^{-1}$\n$s = 1.89 \\times 10^{2}$ Pa K$^{-1}$\n$\\gamma = 6.60 \\times 10^{1}$ Pa K$^{-1}$\n$D = 1.50 \\times 10^{3}$ Pa\n\n首先，我们计算一些中间产物：\n$\\rho c_p = 1.20 \\, \\text{kg m}^{-3} \\times 1.005 \\times 10^{3} \\, \\text{J kg}^{-1} \\text{K}^{-1} = 1206$ J m$^{-3}$ K$^{-1}$\n$r_a + r_s = 50 \\, \\text{s m}^{-1} + 100 \\, \\text{s m}^{-1} = 150$ s m$^{-1}$\n\n接下来，我们计算 $H$ 的分数中的分子和分母：\n分子：$R_n \\gamma (r_a+r_s) - \\rho c_p D$\n$ = (350) \\times (66.0) \\times (150) - (1206) \\times (1500)$\n$ = 3465000 - 1809000 = 1656000$ J Pa K$^{-1}$ m$^{-3}$\n\n分母：$\\gamma (r_a+r_s) + s r_a$\n$ = (66.0) \\times (150) + (189) \\times (50)$\n$ = 9900 + 9450 = 19350$ Pa s K$^{-1}$ m$^{-1}$\n\n现在我们计算感热通量 $H$：\n$$H = \\frac{1656000}{19350} \\approx 85.5814 \\, \\text{W m}^{-2}$$\n\n最后，我们计算 $\\Delta T$：\n$$\\Delta T = \\frac{r_a}{\\rho c_p} H = \\frac{50}{1206} \\times 85.5814 \\approx 3.54815 \\, \\text{K}$$\n按照要求四舍五入到三位有效数字，温度增量为：\n$\\Delta T \\approx 3.55$ K。",
            "answer": "$$\\boxed{3.55}$$"
        },
        {
            "introduction": "从叶片表面尺度放大，我们现在考虑整个生态系统碳储量的动态变化。本练习将指导你构建一个基础的双库碳模型，分别代表植被和土壤有机质。通过实现该模型并检验其对温度的响应，你将练习如何将光合作用、周转和温度敏感性呼吸等核心生态过程转化为一个定量的、可预测的框架。",
            "id": "4028685",
            "problem": "您需要设计并实现一个最小耦合碳循环和动态植ベ模型，该模型能够解析具有明确温度敏感性的自养呼吸和异养呼吸过程。从质量守恒和广泛使用的经验性温度响应关系出发，推导出一阶显式时间步进格式，并计算在指定时期内多个测试用例的累积净生态系统交换。所有带有物理单位的量都必须以指定的SI兼容单位表示。\n\n考虑一个由植被生物量碳库 $V$ 和土壤有机碳库 $S$ 组成的双库陆地生态系统模型，每个库的单位均为千克碳每平方米 ($kg\\ C\\ m^{-2}$)。该系统由一个预设的日均总初级生产力 $G$ ($kg\\ C\\ m^{-2}\\ d^{-1}$) 驱动，该值在每个模拟周期内假定为恒定。必须使用以下假设和基本关系，不得添加其他过程：\n\n1. 植被库和土壤碳库的质量守恒：\n   - 植被库 $V$ 因净初级生产力 $N$ 和速率为 $\\tau_{v}$ ($d^{-1}$) 的一级周转而变化。周转通量的一部分（比例为 $f_{\\ell}$，无量纲）作为凋落物进入土壤。\n   - 土壤库 $S$ 因凋落物输入而增加，并通过异养呼吸减少，后者遵循一级分解动力学。\n\n2. 根据生态生理学惯例，自养呼吸分为生长呼吸和维持呼吸：\n   - 生长呼吸被视为日总初级生产力 $G$ 的一个固定比例 $f_{g}$（无量纲）。\n   - 维持呼吸与现有植被生物量成正比，在参考温度 $T_{\\mathrm{ref}}$ 下的基础速率为 $r_{m,\\mathrm{ref}}$ ($d^{-1}$)，并遵循 $Q_{10}$ 温度依赖性。\n\n3. 异养呼吸遵循一级分解，在参考温度 $T_{\\mathrm{ref}}$ 下的基础速率常数为 $k_{d}$ ($d^{-1}$)，并遵循 $Q_{10}$ 温度依赖性。\n\n4. $Q_{10}$ 法则：对于任何具有 $Q_{10}$ 值 $Q$ 的呼吸过程，在温度 $T$（单位为摄氏度）下相对于参考温度 $T_{\\mathrm{ref}}$（单位为摄氏度）的温度乘法因子为 $Q^{(T - T_{\\mathrm{ref}})/10}$。\n\n5. 净初级生产力 $N$ 是总初级生产力 $G$ 减去自养呼吸（生长呼吸加维持呼吸），即 $N = G - R_{g} - R_{m}$，其中 $R_{g}$ 是生长呼吸，$R_{m}$ 是维持呼吸。\n\n6. 净生态系统交换 (NEE) 定义为呼吸减去光合吸收，当流向大气时为正值，具体为 $\\mathrm{NEE} = R_{m} + R_{g} + R_{h} - G$，其中 $R_{h}$ 是异养呼吸。\n\n根据这些基本关系，推导出关于 $V$ 和 $S$ 的常微分方程连续时间系统。然后，使用时间步长 $\\Delta t = 1$ 天的一阶显式前向欧拉格式，推导出将第 $n$ 天的状态 $(V_{n}, S_{n})$ 映射到第 $n+1$ 天状态 $(V_{n+1}, S_{n+1})$ 的离散时间更新方程。第 $n$ 天的日净生态系统交换必须使用当天开始时的状态计算，而 $N_{\\mathrm{days}}$ 天的累积NEE必须通过将每日NEE乘以 $\\Delta t$ 再求和得到。\n\n所有温度必须以摄氏度为单位提供和使用。所有通量必须以千克碳每平方米每天 ($kg\\ C\\ m^{-2}\\ d^{-1}$) 为单位，所有碳库必须以千克碳每平方米 ($kg\\ C\\ m^{-2}$) 为单位。最终的累积NEE必须表示为千克碳每平方米 ($kg\\ C\\ m^{-2}$)，并四舍五入到六位小数的浮点数。\n\n在程序中实现您推导的格式，并对所有测试用例应用以下共享参数：\n- 参考温度 $T_{\\mathrm{ref}} = 15$ (摄氏度)。\n- 植被周转速率 $\\tau_{v} = 0.01$ ($d^{-1}$)。\n- 进入土壤的周转比例 $f_{\\ell} = 0.9$ (无量纲)。\n- 生长呼吸比例 $f_{g} = 0.25$ (无量纲)。\n- 植被维持呼吸基础速率 $r_{m,\\mathrm{ref}} = 0.002$ ($d^{-1}$)。\n- 土壤分解基础速率 $k_{d} = 0.0005$ ($d^{-1}$)。\n- 植被维持呼吸 $Q_{10}$ 值 $Q_{m} = 2.0$ (无量纲)。\n- 异养呼吸 $Q_{10}$ 值 $Q_{h} = 2.0$ (无量纲)。\n- 日时间步长 $\\Delta t = 1$ (天)。\n\n您的程序必须为每个测试用例运行指定天数的模型，从提供的初始条件、恒定的日总初级生产力 $G$ 和恒定温度 $T$ 开始。对于每一天 $n$，使用 $Q_{10}$ 法则计算温度乘数，并应用前向欧拉更新。\n\n测试套件。为以下四个案例运行模型：\n\n- 案例1（参考温度下的基准情况）：\n  - $T = 15$ (摄氏度), $G = 0.03$ ($kg\\ C\\ m^{-2}\\ d^{-1}$), $N_{\\mathrm{days}} = 30$ (天), $V_{0} = 5.0$ ($kg\\ C\\ m^{-2}$), $S_{0} = 20.0$ ($kg\\ C\\ m^{-2}$)。\n\n- 案例2（低温边界）：\n  - $T = 0$ (摄氏度), $G = 0.03$ ($kg\\ C\\ m^{-2}\\ d^{-1}$), $N_{\\mathrm{days}} = 30$ (天), $V_{0} = 5.0$ ($kg\\ C\\ m^{-2}$), $S_{0} = 20.0$ ($kg\\ C\\ m^{-2}$)。\n\n- 案例3（高温边界）：\n  - $T = 30$ (摄氏度), $G = 0.03$ ($kg\\ C\\ m^{-2}\\ d^{-1}$), $N_{\\mathrm{days}} = 30$ (天), $V_{0} = 5.0$ ($kg\\ C\\ m^{-2}$), $S_{0} = 20.0$ ($kg\\ C\\ m^{-2}$)。\n\n- 案例4（无初始植被的边缘情况）：\n  - $T = 15$ (摄氏度), $G = 0.03$ ($kg\\ C\\ m^{-2}\\ d^{-1}$), $N_{\\mathrm{days}} = 10$ (天), $V_{0} = 0.0$ ($kg\\ C\\ m^{-2}$), $S_{0} = 20.0$ ($kg\\ C\\ m^{-2}$)。\n\n要求的最终输出格式。您的程序应生成单行输出，其中包含累积NEE结果，单位为千克碳每平方米 ($kg\\ C\\ m^{-2}$)，四舍五入到六位小数，并按上述案例的精确顺序，格式化为方括号括起来的逗号分隔列表，例如 $[x_{1},x_{2},x_{3},x_{4}]$，其中每个 $x_{i}$ 是一个小数点后恰好有六位的浮点数。",
            "solution": "该问题提出了一个基于生态系统碳循环建模标准原则的、有效的、适定的初值问题。该问题是自洽的，数值模拟所需的所有参数和初始条件都已提供。我们将首先推导常微分方程（ODEs）系统，然后使用前向欧拉法推导其离散时间对应形式，最后详细说明计算累积净生态系统交换（NEE）的算法。\n\n### 步骤1：温度依赖速率的公式化\n\n维持呼吸和异养呼吸的温度依赖性使用 $Q_{10}$ 公式进行建模。对于一个在参考温度 $T_{\\mathrm{ref}}$ 下具有基础速率和 $Q_{10}$ 值为 $Q$ 的过程，其在温度 $T$ 下的速率由基础速率乘以一个温度缩放因子 $f(T)$ 给出。\n\n温度缩放因子为 $f(T) = Q^{(T - T_{\\mathrm{ref}})/10}$。\n\n依赖于温度的维持呼吸速率 $r_m(T)$（单位为 d$^{-1}$）为：\n$$\nr_m(T) = r_{m,\\mathrm{ref}} \\cdot Q_m^{(T - T_{\\mathrm{ref}})/10}\n$$\n依赖于温度的异养呼吸速率常数 $k_h(T)$（单位为 d$^{-1}$）为：\n$$\nk_h(T) = k_d \\cdot Q_h^{(T - T_{\\mathrm{ref}})/10}\n$$\n\n### 步骤2：连续时间动态（ODEs）\n\n我们基于质量守恒原则（$\\frac{d(\\text{碳库})}{dt} = \\text{输入} - \\text{输出}$）为植被碳库 $V$ 和土壤有机碳库 $S$ 建立常微分方程系统。\n\n首先，根据问题陈述定义所有相关的碳通量：\n- 总初级生产力（光合吸收）：$G$ (kg C m$^{-2}$ d$^{-1}$)。\n- 生长呼吸：$R_g = f_g G$。\n- 维持呼吸：$R_m = r_m(T) V$。\n- 总自养呼吸：$R_a = R_g + R_m = f_g G + r_m(T) V$。\n- 净初级生产力（可用于生长的碳）：$N = G - R_a = G - (f_g G + r_m(T) V) = (1 - f_g)G - r_m(T) V$。\n- 植被周转损失：$F_{v,\\text{loss}} = \\tau_v V$。\n- 凋落物（对土壤的输入）：$F_{\\ell} = f_{\\ell} F_{v,\\text{loss}} = f_{\\ell} \\tau_v V$。\n- 异养呼吸（土壤碳损失）：$R_h = k_h(T) S$。\n\n植被库 $V$ 的变化率是净初级生产力减去总周转损失：\n$$\n\\frac{dV}{dt} = N - F_{v,\\text{loss}} = \\left( (1 - f_g)G - r_m(T)V \\right) - \\tau_v V\n$$\n合并与 $V$ 成比例的项，我们得到第一个ODE：\n$$\n\\frac{dV}{dt} = (1 - f_g)G - (r_m(T) + \\tau_v)V\n$$\n\n土壤库 $S$ 的变化率是凋落物输入减去异养呼吸损失：\n$$\n\\frac{dS}{dt} = F_{\\ell} - R_h = f_{\\ell} \\tau_v V - k_h(T)S\n$$\n这是第二个ODE。\n\n完整的连续时间系统为：\n$$\n\\begin{cases}\n\\frac{dV}{dt} = (1 - f_g)G - (r_m(T) + \\tau_v)V \\\\\n\\frac{dS}{dt} = f_{\\ell} \\tau_v V - k_h(T)S\n\\end{cases}\n$$\n\n### 步骤3：使用前向欧拉格式进行离散化\n\n我们现在使用一阶显式前向欧拉法对该系统进行离散化，该方法将导数近似为 $\\frac{dy}{dt} \\approx \\frac{y_{n+1} - y_n}{\\Delta t}$。重新排列得到更新规则 $y_{n+1} = y_n + \\Delta t \\cdot \\frac{dy}{dt}|_{t=t_n}$。\n\n将此应用于我们的系统，状态变量为 $(V_n, S_n)$，时间步长为 $\\Delta t$：\n$$\nV_{n+1} = V_n + \\Delta t \\left[ (1 - f_g)G - (r_m(T) + \\tau_v)V_n \\right]\n$$\n$$\nS_{n+1} = S_n + \\Delta t \\left[ f_{\\ell} \\tau_v V_n - k_h(T)S_n \\right]\n$$\n问题指定时间步长 $\\Delta t = 1$ 天，从而得到简化的更新方程：\n$$\nV_{n+1} = V_n + (1 - f_g)G - (r_m(T) + \\tau_v)V_n = (1 - r_m(T) - \\tau_v)V_n + (1 - f_g)G\n$$\n$$\nS_{n+1} = S_n + f_{\\ell} \\tau_v V_n - k_h(T)S_n = (1 - k_h(T))S_n + f_{\\ell} \\tau_v V_n\n$$\n这些方程将用于迭代模拟碳库的演变。\n\n### 步骤4：计算净生态系统交换（NEE）\n\n净生态系统交换（NEE）定义为生态系统总呼吸减去总光合吸收。正值的NEE表示碳净通量流向大气。\n$$\n\\mathrm{NEE} = (R_g + R_m + R_h) - G\n$$\n问题规定，在第 $n$ 天的日净生态系统交换，记为 $\\mathrm{NEE}_n$，必须使用当天开始时的状态，即 $(V_n, S_n)$ 来计算。\n$$\n\\mathrm{NEE}_n = (f_g G) + (r_m(T)V_n) + (k_h(T)S_n) - G\n$$\n重新整理得到：\n$$\n\\mathrm{NEE}_n = r_m(T)V_n + k_h(T)S_n - (1 - f_g)G\n$$\n\n在 $N_{\\mathrm{days}}$ 天内的累积NEE是每日NEE值乘以时间步长 $\\Delta t$ 的总和。\n$$\n\\mathrm{NEE}_{\\mathrm{cum}} = \\sum_{n=0}^{N_{\\mathrm{days}}-1} \\mathrm{NEE}_n \\cdot \\Delta t\n$$\n由于 $\\Delta t = 1$ 天，这简化为每日NEE值的直接求和：\n$$\n\\mathrm{NEE}_{\\mathrm{cum}} = \\sum_{n=0}^{N_{\\mathrm{days}}-1} \\mathrm{NEE}_n\n$$\n模拟算法将首先初始化碳库 $(V_0, S_0)$，然后从第 $n=0$ 天到第 $N_{\\mathrm{days}}-1$ 天，每天首先根据当前状态 $(V_n, S_n)$ 计算 $\\mathrm{NEE}_n$，将其加到运行总和中，然后使用更新方程计算下一天的状态 $(V_{n+1}, S_{n+1})$。对每个测试用例重复此过程以获得所需的结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and implements a two-pool carbon cycle model to compute\n    cumulative net ecosystem exchange (NEE).\n    \"\"\"\n\n    # Shared parameters from the problem statement\n    T_ref = 15.0  # Reference temperature in degrees Celsius\n    tau_v = 0.01  # Vegetation turnover rate in d^-1\n    f_ell = 0.9  # Fraction of turnover entering soil (dimensionless)\n    f_g = 0.25  # Growth respiration fraction (dimensionless)\n    r_m_ref = 0.002  # Maintenance respiration base rate in d^-1\n    k_d = 0.0005  # Soil decomposition base rate in d^-1\n    Q_m = 2.0  # Q10 for maintenance respiration (dimensionless)\n    Q_h = 2.0  # Q10 for heterotrophic respiration (dimensionless)\n    delta_t = 1.0  # Time step in days\n\n    # Test suite definition\n    test_cases = [\n        # Case 1 (baseline at the reference temperature)\n        {'T': 15.0, 'G': 0.03, 'N_days': 30, 'V0': 5.0, 'S0': 20.0},\n        # Case 2 (cold boundary)\n        {'T': 0.0, 'G': 0.03, 'N_days': 30, 'V0': 5.0, 'S0': 20.0},\n        # Case 3 (warm boundary)\n        {'T': 30.0, 'G': 0.03, 'N_days': 30, 'V0': 5.0, 'S0': 20.0},\n        # Case 4 (edge case with no initial vegetation)\n        {'T': 15.0, 'G': 0.03, 'N_days': 10, 'V0': 0.0, 'S0': 20.0},\n    ]\n\n    results = []\n\n    for case in test_cases:\n        # Unpack case-specific parameters\n        T = case['T']\n        G = case['G']\n        N_days = case['N_days']\n        V = case['V0']\n        S = case['S0']\n\n        # Calculate temperature-dependent rates once per simulation\n        # r_m(T) = r_m_ref * Q_m^((T - T_ref) / 10)\n        temp_exp = (T - T_ref) / 10.0\n        r_m_T = r_m_ref * (Q_m ** temp_exp)\n        \n        # k_h(T) = k_d * Q_h^((T - T_ref) / 10)\n        k_h_T = k_d * (Q_h ** temp_exp)\n\n        cumulative_nee = 0.0\n\n        for n in range(N_days):\n            # 1. Calculate fluxes and NEE for the current day 'n' using the state (V, S)\n            #    at the beginning of the day.\n            #    NEE_n = R_m_n + R_h_n + R_g_n - G\n            #    where R_m_n = r_m_T * V, R_h_n = k_h_T * S, R_g_n = f_g * G\n            \n            # The definition is NEE = R_m + R_h + R_g - G, which can be expressed as:\n            # NEE_n = r_m_T * V + k_h_T * S + f_g * G - G\n            # or NEE_n = r_m_T * V + k_h_T * S - (1 - f_g) * G\n            \n            nee_daily = r_m_T * V + k_h_T * S - (1.0 - f_g) * G\n\n            # 2. Update the cumulative NEE\n            cumulative_nee += nee_daily * delta_t\n\n            # 3. Calculate state for the next day (n+1) using forward Euler\n            #    V_{n+1} = V_n + delta_t * ( (1-f_g)G - (r_m_T + tau_v)V_n )\n            #    S_{n+1} = S_n + delta_t * ( f_ell * tau_v * V_n - k_h_T * S_n )\n            \n            # Since delta_t = 1.0\n            V_next = V + ((1.0 - f_g) * G - (r_m_T + tau_v) * V)\n            S_next = S + (f_ell * tau_v * V - k_h_T * S)\n\n            # 4. Update state variables for the next iteration\n            V = V_next\n            S = S_next\n            \n        results.append(cumulative_nee)\n\n    # Format the final output string as required\n    # e.g., [x1,x2,x3,x4] with 6 decimal places.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "现实世界生态系统的生长限制因素通常不仅仅是光和水，营养物质的可利用性是一个主要制约因素。这最后一个实践通过将碳循环与动态的氮循环耦合，引入了这种复杂性。通过这次模拟，你将研究氮限制如何调节至关重要的“$CO_2$施肥效应”——这是预测未来碳汇的一个关键不确定性，并对地球生物地球化学循环的相互关联性产生更深刻的理解。",
            "id": "4028688",
            "problem": "考虑一个碳循环与动态全球植被之间的简化耦合，该耦合被构建为一个年度的、空间集总的系统，并明确依赖于养分限制和二氧化碳施肥效应。植被生物量由单个碳库表示，并与单个土壤碳库和单个矿物氮库相互作用。该公式必须源自质量守恒定律和经验支持的功能响应。\n\n你必须编写一个程序，模拟以下常微分方程组在一个固定的时间范围内的演变，并返回在恒定强迫下的平衡量。变量为植被碳 $\\mathrm{V}$（单位：$\\mathrm{kg\\ C\\ m^{-2}}$）、土壤碳 $\\mathrm{S}$（单位：$\\mathrm{kg\\ C\\ m^{-2}}$）和矿物氮 $\\mathrm{N_m}$（单位：$\\mathrm{kg\\ N\\ m^{-2}}$）。强迫包括光合有效辐射 $\\mathrm{PAR}$（单位：$\\mathrm{MJ\\ m^{-2}\\ yr^{-1}}$）、大气二氧化碳摩尔分数 $C_a$（单位：$\\mathrm{ppm}$）和氮沉降 $I_N$（单位：$\\mathrm{kg\\ N\\ m^{-2}\\ yr^{-1}}$）。\n\n使用的基本原理和定义：\n- 碳和氮的质量守恒。\n- 用于冠层光截获的 Beer–Lambert 定律。\n- 用于二氧化碳施肥效应的 Michaelis–Menten 型饱和。\n- 用于氮限制的 Michaelis–Menten 型饱和。\n- 总初级生产力 (GPP)、净初级生产力 (NPP)、叶面积指数 (LAI) 和动态全球植被模型 (DGVM) 的定义。\n- 用于吸收和矿化的碳氮比 (C:N) 约束。\n\n模型结构：\n1. 源自 Beer–Lambert 定律和光利用效率的冠层辐射传输和潜在同化：\n$$\\mathrm{LAI} = f_{\\text{leaf}} \\, \\mathrm{V} \\, \\mathrm{SLA},$$\n$$\\mathrm{APAR} = \\mathrm{PAR} \\left(1 - e^{-k_{\\text{ext}} \\, \\mathrm{LAI}}\\right),$$\n$$f_{\\mathrm{CO}_2}(C_a) = \\frac{C_a}{C_a + K_{\\mathrm{CO}_2}},\\quad 0 \\le f_{\\mathrm{CO}_2} \\le 1,$$\n$$\\mathrm{GPP}_{\\text{pot}} = \\varepsilon \\, \\mathrm{APAR} \\, f_{\\mathrm{CO}_2}(C_a).$$\n2. 对光合作用的养分限制：\n$$f_N(\\mathrm{N_m}) = \\frac{\\mathrm{N_m}}{\\mathrm{N_m} + K_N},\\quad 0 \\le f_N \\le 1,$$\n$$\\mathrm{GPP} = \\mathrm{GPP}_{\\text{pot}} \\, f_N.$$\n3. 净初级生产力和植被动态：\n$$\\mathrm{NPP} = (1 - f_{\\text{auto}})\\,\\mathrm{GPP},$$\n$$\\frac{d\\mathrm{V}}{dt} = \\mathrm{NPP} - m_V \\, \\mathrm{V}.$$\n4. 土壤碳动态和氮矿化：\n$$\\frac{d\\mathrm{S}}{dt} = m_V \\, \\mathrm{V} - k_S \\, \\mathrm{S},$$\n$$R_N(\\mathrm{S}) = \\alpha_N \\, k_S \\, \\mathrm{S}.$$\n5. 矿物氮动态和化学计量的吸收约束：\n$$U_N = \\frac{\\mathrm{NPP}}{r_{\\mathrm{CN,veg}}},$$\n$$\\frac{d\\mathrm{N_m}}{dt} = I_N + R_N(\\mathrm{S}) - U_N - \\lambda \\, \\mathrm{N_m}.$$\n\n所有计算必须使用指定的单位进行。使用显式前向欧拉法和固定时间步长 $\\Delta t$（单位：$\\mathrm{yr}$）对系统进行时间上的向前演化，在每一步将状态变量限制为非负值。模拟必须运行总时长 $T$ 年以接近平衡。\n\n使用的参数值（常量）：\n- 光利用效率：$\\varepsilon = 0.0008$，单位：$\\mathrm{kg\\ C\\ MJ^{-1}}$。\n- 自养呼吸分数：$f_{\\text{auto}} = 0.5$。\n- 冠层消光系数：$k_{\\text{ext}} = 0.5$。\n- 比叶面积：$\\mathrm{SLA} = 20.0$，单位：$\\mathrm{m^{2}\\ kg^{-1}\\ C}$。\n- 叶碳分数：$f_{\\text{leaf}} = 0.25$（无量纲）。\n- 植被周转率：$m_V = 0.05$，单位：$\\mathrm{yr^{-1}}$。\n- 土壤分解率：$k_S = 0.05$，单位：$\\mathrm{yr^{-1}}$。\n- 二氧化碳半饱和常数：$K_{\\mathrm{CO}_2} = 300.0$，单位：$\\mathrm{ppm}$。\n- 氮半饱和常数：$K_N = 0.002$，单位：$\\mathrm{kg\\ N\\ m^{-2}}$。\n- 氮淋溶率：$\\lambda = 0.2$，单位：$\\mathrm{yr^{-1}}$。\n- 植被碳氮比：$r_{\\mathrm{CN,veg}} = 25.0$，单位：$\\mathrm{kg\\ C\\ kg^{-1}\\ N}$。\n- 土壤碳氮矿化系数：$\\alpha_N = 1 / r_{\\mathrm{CN,soil}}$，其中 $r_{\\mathrm{CN,soil}} = 12.0$，单位：$\\mathrm{kg\\ C\\ kg^{-1}\\ N}$。\n- 时间步长：$\\Delta t = 0.25$，单位：$\\mathrm{yr}$。\n- 总时长：$T = 200.0$，单位：$\\mathrm{yr}$。\n\n$t=0$ 时的初始条件：\n- 植被碳：$\\mathrm{V}(0) = 1.0$，单位：$\\mathrm{kg\\ C\\ m^{-2}}$。\n- 土壤碳：$\\mathrm{S}(0) = 5.0$，单位：$\\mathrm{kg\\ C\\ m^{-2}}$。\n- 矿物氮：$\\mathrm{N_m}(0) = 0.001$，单位：$\\mathrm{kg\\ N\\ m^{-2}}$。\n\n测试套件（运行四个案例）：\n- 案例 A（理想路径）：$\\mathrm{PAR} = 1500.0$，单位：$\\mathrm{MJ\\ m^{-2}\\ yr^{-1}}$，$C_a = 420.0$，单位：$\\mathrm{ppm}$，$I_N = 0.0040$，单位：$\\mathrm{kg\\ N\\ m^{-2}\\ yr^{-1}}$。\n- 案例 B（贫养分边界）：$\\mathrm{PAR} = 1500.0$，单位：$\\mathrm{MJ\\ m^{-2}\\ yr^{-1}}$，$C_a = 420.0$，单位：$\\mathrm{ppm}$，$I_N = 0.0000$，单位：$\\mathrm{kg\\ N\\ m^{-2}\\ yr^{-1}}$。\n- 案例 C（高 $\\mathrm{CO_2}$ 施肥效应）：$\\mathrm{PAR} = 1500.0$，单位：$\\mathrm{MJ\\ m^{-2}\\ yr^{-1}}$，$C_a = 800.0$，单位：$\\mathrm{ppm}$，$I_N = 0.0020$，单位：$\\mathrm{kg\\ N\\ m^{-2}\\ yr^{-1}}$。\n- 案例 D（低光照，高沉降边缘）：$\\mathrm{PAR} = 700.0$，单位：$\\mathrm{MJ\\ m^{-2}\\ yr^{-1}}$，$C_a = 420.0$，单位：$\\mathrm{ppm}$，$I_N = 0.0060$，单位：$\\mathrm{kg\\ N\\ m^{-2}\\ yr^{-1}}$。\n\n要求输出：\n- 对于每个案例，计算模拟结束时的平衡植被碳 $\\mathrm{V}_e$ 和平衡土壤碳 $\\mathrm{S}_e$，两者均以 $\\mathrm{kg\\ C\\ m^{-2}}$ 为单位，表示为四舍五入到三位小数的浮点数。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表必须遵循 $\\left[\\mathrm{V}_A,\\mathrm{S}_A,\\mathrm{V}_B,\\mathrm{S}_B,\\mathrm{V}_C,\\mathrm{S}_C,\\mathrm{V}_D,\\mathrm{S}_D\\right]$ 的顺序，其中下标表示案例。例如，一个有效的格式是 $\\left[1.234,5.678,2.345,6.789,3.456,7.890,4.567,8.901\\right]$。",
            "solution": "该问题是有效的。它提出了一个定义明确、有科学依据的常微分方程组（ODE），描述了陆地生态系统中碳循环和氮循环之间的简化耦合。所有参数、初始条件、强迫数据和数值程序都得到了完整且一致的规定，从而可以得到唯一且可验证的解。\n\n解决方案需要模拟三个状态变量的时间演化：植被碳（$\\mathrm{V}$）、土壤碳（$\\mathrm{S}$）和矿物氮（$\\mathrm{N_m}$）。动力学由一个基于质量守恒原理的三耦合一阶常微分方程组控制，其中每个库的变化率是其流入量之和减去其流出量之和。\n\n$$\n\\frac{d\\mathrm{V}}{dt} = \\mathrm{NPP} - m_V \\, \\mathrm{V}\n$$\n$$\n\\frac{d\\mathrm{S}}{dt} = m_V \\, \\mathrm{V} - k_S \\, \\mathrm{S}\n$$\n$$\n\\frac{d\\mathrm{N_m}}{dt} = I_N + R_N(\\mathrm{S}) - U_N - \\lambda \\, \\mathrm{N_m}\n$$\n\n这些方程中的通量是状态变量和外部强迫的函数，融合了生态学和植物生理学中已建立的经验和理论关系。净初级生产力（$\\mathrm{NPP}$）是生态系统的最终碳源，源自总初级生产力（$\\mathrm{GPP}$）。$\\mathrm{GPP}$ 本身由吸收的光合有效辐射（$\\mathrm{APAR}$）决定，并同时受到大气 $\\mathrm{CO_2}$ 浓度（$C_a$）和土壤矿物氮有效性（$\\mathrm{N_m}$）的限制。限制函数 $f_{\\mathrm{CO}_2}(C_a)$ 和 $f_N(\\mathrm{N_m})$ 采用 Michaelis-Menten 形式，这是资源饱和的标准表示方法。冠层内的辐射传输使用 Beer-Lambert 定律建模，其中光截获取决于叶面积指数（$\\mathrm{LAI}$），而叶面积指数与植被碳库 $\\mathrm{V}$ 成线性比例。\n\n氮循环通过化学计量约束与碳循环耦合。氮吸收（$U_N$）与碳同化（$\\mathrm{NPP}$）成正比，并受到固定的植被碳氮比（$r_{\\mathrm{CN,veg}}$）的约束。氮通过土壤有机质的矿化返回到矿物库（$\\mathrm{N_m}$），其中氮释放（$R_N$）与土壤碳分解速率成正比。\n\n为找到恒定强迫下系统的平衡态，我们将对常微分方程组进行数值时间积分。问题指定使用显式前向欧拉法。对于一个状态变量 $X$，其在时间 $t+\\Delta t$ 的值由其在时间 $t$ 的值近似得出：\n$$\nX(t + \\Delta t) = X(t) + \\Delta t \\cdot \\frac{dX}{dt}\\bigg|_t\n$$\n此计算以 $\\Delta t = 0.25$ 年的固定时间步长重复进行，总模拟时长为 $T = 200$ 年。该时长是系统特征时间尺度（例如，植被和土壤周转时间为 $1/m_V = 20$ 年）的数倍，足以让系统接近一个稳定的稳态。由于生物量和养分库在物理上是非负量，$\\mathrm{V}$、$\\mathrm{S}$ 和 $\\mathrm{N_m}$ 的值在每个时间步后将被限制为最小值为 $0$。\n\n四个测试案例中每个案例的算法如下：\n1. 将状态变量初始化为其起始值：$\\mathrm{V}(0) = 1.0$，$\\mathrm{S}(0) = 5.0$，和 $\\mathrm{N_m}(0) = 0.001$。\n2. 为特定案例设置恒定强迫变量（$\\mathrm{PAR}$，$C_a$，$I_N$）。\n3. 开始一个从 $t=0$ 到 $t=T$ 以 $\\Delta t$ 为步长迭代的循环。在每一步内：\n    a. 计算叶面积指数：$\\mathrm{LAI} = f_{\\text{leaf}} \\, \\mathrm{V} \\, \\mathrm{SLA}$。\n    b. 计算吸收的光合有效辐射：$\\mathrm{APAR} = \\mathrm{PAR} \\left(1 - e^{-k_{\\text{ext}} \\, \\mathrm{LAI}}\\right)$。\n    c. 计算 $\\mathrm{CO_2}$ 限制因子：$f_{\\mathrm{CO}_2}(C_a) = \\frac{C_a}{C_a + K_{\\mathrm{CO}_2}}$。\n    d. 计算潜在总初级生产力：$\\mathrm{GPP}_{\\text{pot}} = \\varepsilon \\, \\mathrm{APAR} \\, f_{\\mathrm{CO}_2}(C_a)$。\n    e. 计算氮限制因子：$f_N(\\mathrm{N_m}) = \\frac{\\mathrm{N_m}}{\\mathrm{N_m} + K_N}$。\n    f. 计算实际总初级生产力：$\\mathrm{GPP} = \\mathrm{GPP}_{\\text{pot}} \\, f_N$。\n    g. 计算净初级生产力：$\\mathrm{NPP} = (1 - f_{\\text{auto}})\\,\\mathrm{GPP}$。\n    h. 计算氮通量：矿化 $R_N = \\alpha_N \\, k_S \\, \\mathrm{S}$ 和吸收 $U_N = \\frac{\\mathrm{NPP}}{r_{\\mathrm{CN,veg}}}$。\n    i. 使用质量平衡方程计算导数 $\\frac{d\\mathrm{V}}{dt}$、$\\frac{d\\mathrm{S}}{dt}$ 和 $\\frac{d\\mathrm{N_m}}{dt}$。\n    j. 使用前向欧拉步更新状态变量：$\\mathrm{V} \\leftarrow \\mathrm{V} + \\Delta t \\cdot \\frac{d\\mathrm{V}}{dt}$，$\\mathrm{S} \\leftarrow \\mathrm{S} + \\Delta t \\cdot \\frac{d\\mathrm{S}}{dt}$，和 $\\mathrm{N_m} \\leftarrow \\mathrm{N_m} + \\Delta t \\cdot \\frac{d\\mathrm{N_m}}{dt}$。\n    k. 强制非负性：$\\mathrm{V} \\leftarrow \\max(0, \\mathrm{V})$，$\\mathrm{S} \\leftarrow \\max(0, \\mathrm{S})$，$\\mathrm{N_m} \\leftarrow \\max(0, \\mathrm{N_m})$。\n4. 循环完成后，将 $\\mathrm{V}$ 和 $\\mathrm{S}$ 的最终值记录为该案例的平衡量。\n5. 收集所有四个案例的最终结果，四舍五入到三位小数，并格式化为指定的字符串格式。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Simulates a simplified carbon-nitrogen coupled ecosystem model to find\n    equilibrium carbon stocks under different environmental conditions.\n    \"\"\"\n\n    # Parameter values\n    eps = 0.0008  # Light-use efficiency (kg C MJ^-1)\n    f_auto = 0.5  # Autotrophic respiration fraction (dimensionless)\n    k_ext = 0.5  # Canopy extinction coefficient (dimensionless)\n    SLA = 20.0  # Specific Leaf Area (m^2 kg^-1 C)\n    f_leaf = 0.25  # Leaf carbon fraction (dimensionless)\n    m_V = 0.05  # Vegetation turnover (yr^-1)\n    k_S = 0.05  # Soil decomposition (yr^-1)\n    K_CO2 = 300.0  # CO2 half-saturation (ppm)\n    K_N = 0.002  # N half-saturation (kg N m^-2)\n    lam = 0.2  # N leaching rate (yr^-1)\n    r_CN_veg = 25.0  # Vegetation C:N ratio (kg C kg^-1 N)\n    r_CN_soil = 12.0  # Soil C:N ratio for mineralization (kg C kg^-1 N)\n    alpha_N = 1.0 / r_CN_soil  # N mineralization coefficient (kg N kg^-1 C)\n    \n    # Numerical integration parameters\n    dt = 0.25  # Time step (yr)\n    T = 200.0  # Total duration (yr)\n    num_steps = int(T / dt)\n\n    # Initial conditions\n    V_init = 1.0  # Vegetation carbon (kg C m^-2)\n    S_init = 5.0  # Soil carbon (kg C m^-2)\n    Nm_init = 0.001  # Mineral nitrogen (kg N m^-2)\n\n    # Test suite: (PAR, Ca, IN)\n    test_cases = [\n        # Case A: Happy path\n        (1500.0, 420.0, 0.0040),\n        # Case B: Nutrient-poor boundary\n        (1500.0, 420.0, 0.0000),\n        # Case C: High CO2 fertilization\n        (1500.0, 800.0, 0.0020),\n        # Case D: Low light, high deposition edge\n        (700.0, 420.0, 0.0060),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        PAR, Ca, IN = case\n        \n        # Reset state variables to initial conditions for each case\n        V = V_init\n        S = S_init\n        Nm = Nm_init\n\n        # Time integration loop\n        for _ in range(num_steps):\n            # 1. Canopy radiative transfer and potential assimilation\n            LAI = f_leaf * V * SLA\n            APAR = PAR * (1.0 - np.exp(-k_ext * LAI))\n            f_CO2 = Ca / (Ca + K_CO2)\n            GPP_pot = eps * APAR * f_CO2\n            \n            # 2. Nutrient limitation on photosynthesis\n            f_N = Nm / (Nm + K_N)\n            GPP = GPP_pot * f_N\n            \n            # 3. Net Primary Productivity\n            NPP = (1.0 - f_auto) * GPP\n            \n            # 4. Nitrogen mineralization\n            R_N = alpha_N * k_S * S\n            \n            # 5. Nitrogen uptake\n            U_N = NPP / r_CN_veg\n            \n            # Calculate derivatives\n            dV_dt = NPP - m_V * V\n            dS_dt = m_V * V - k_S * S\n            dNm_dt = IN + R_N - U_N - lam * Nm\n            \n            # Update state variables using forward Euler method\n            V += dV_dt * dt\n            S += dS_dt * dt\n            Nm += dNm_dt * dt\n            \n            # Clamp state variables to be non-negative\n            V = np.maximum(0.0, V)\n            S = np.maximum(0.0, S)\n            Nm = np.maximum(0.0, Nm)\n            \n        # Store equilibrium values rounded to three decimal places\n        results.append(round(V, 3))\n        results.append(round(S, 3))\n\n    # Format and print the final output\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}