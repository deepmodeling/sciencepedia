{
    "hands_on_practices": [
        {
            "introduction": "任何动态全球植被模型（DGVM）的核心都是对生态系统碳库动态的数学描述。本练习将指导您将关键的生物地球化学过程——例如总初级生产力、呼吸作用和凋落物周转——转化为一个可计算的数值模型 。此练习的重点是创建一个包含植被和土壤两个碳库的简化模型，并实现呼吸作用对温度的敏感性（通常用 $Q_{10}$ 关系表示），这是气候系统中一个至关重要的反馈机制。",
            "id": "4028685",
            "problem": "您需要设计并实现一个最小耦合碳循环和动态植被模型，该模型能解析具有明确温度敏感性的自养和异养呼吸过程。从质量守恒和广泛使用的经验性温度响应关系出发，推导一个一阶显式时间步进方案，并为多个测试案例计算指定时期内的累积净生态系统交换量。所有带有物理单位的量都必须以指定的国际单位制（SI）兼容单位表示。\n\n考虑一个由植被生物量碳库 $V$ 和土壤有机碳库 $S$ 组成的双库陆地生态系统模型，每个库都以千克碳每平方米（kg C m$^{-2}$）表示。该系统由一个规定的日均总初级生产力 $G$（kg C m$^{-2}$ d$^{-1}$）驱动，该值在每个模拟周期内被外部施加并假定为恒定。必须使用以下假设和基本关系，不得添加其他过程：\n\n1. 植被库和土壤碳库的质量守恒：\n   - 植被库 $V$ 因净初级生产力 $N$ 和速率为 $\\tau_{v}$ (d$^{-1}$) 的一阶周转而变化。周转通量的一部分（无量纲分数 $f_{\\ell}$）以凋落物的形式进入土壤。\n   - 土壤库 $S$ 因凋落物输入而增加，并通过异养呼吸减少，后者遵循一级分解动力学。\n\n2. 自养呼吸分为生长呼吸和维持呼吸，这与生态生理学惯例一致：\n   - 生长呼吸被视为日总初级生产力 $G$ 的一个固定比例 $f_{g}$（无量纲）。\n   - 维持呼吸与现有植被生物量成正比，在参考温度 $T_{\\mathrm{ref}}$ 下的基础速率为 $r_{m,\\mathrm{ref}}$ (d$^{-1}$)，并遵循 $Q_{10}$ 温度依赖关系。\n\n3. 异养呼吸遵循一级分解，在参考温度 $T_{\\mathrm{ref}}$ 下的基础速率常数为 $k_{d}$ (d$^{-1}$)，并遵循 $Q_{10}$ 温度依赖关系。\n\n4. $Q_{10}$ 法则：对于任何具有 $Q_{10}$ 值 $Q$ 的呼吸过程，在温度 $T$（摄氏度）下相对于 $T_{\\mathrm{ref}}$（摄氏度）的温度乘法因子是 $Q^{(T - T_{\\mathrm{ref}})/10}$。\n\n5. 净初级生产力 $N$ 是总初级生产力 $G$ 减去自养呼吸（生长呼吸加维持呼吸），即 $N = G - R_{g} - R_{m}$，其中 $R_{g}$ 是生长呼吸，$R_{m}$ 是维持呼吸。\n\n6. 净生态系统交换（NEE）定义为呼吸减去光合吸收，朝向大气为正值，具体为 $\\mathrm{NEE} = R_{m} + R_{g} + R_{h} - G$，其中 $R_{h}$ 是异养呼吸。\n\n从这些基本关系出发，为 $V$ 和 $S$ 推导一个连续时间常微分方程组。然后，使用固定时间步长 $\\Delta t = 1$ 天的一阶显式前向欧拉（Euler）方案，推导将日期索引 $n$ 的 $(V_{n}, S_{n})$ 映射到日期索引 $n+1$ 的 $(V_{n+1}, S_{n+1})$ 的离散时间更新方程。日期索引为 $n$ 的日 NEE 必须使用当天开始时的状态计算，并且在 $N_{\\mathrm{days}}$ 天的模拟中的累积 NEE 必须通过将日 NEE 乘以 $\\Delta t$ 再求和得到。\n\n所有温度必须以摄氏度为单位提供和使用。所有通量必须以千克碳每平方米每天（kg C m$^{-2}$ d$^{-1}$）为单位，所有库必须以千克碳每平方米（kg C m$^{-2}$）为单位。最终的累积 NEE 必须表示为千克碳每平方米（kg C m$^{-2}$），并以四舍五入到六位小数的浮点数形式给出。\n\n在程序中实现您推导的方案，该程序对所有测试案例应用以下共享参数：\n- 参考温度 $T_{\\mathrm{ref}} = 15$（摄氏度）。\n- 植被周转率 $\\tau_{v} = 0.01$ (d$^{-1}$)。\n- 进入土壤的周转比例 $f_{\\ell} = 0.9$（无量纲）。\n- 生长呼吸比例 $f_{g} = 0.25$（无量纲）。\n- 植被维持呼吸基础速率 $r_{m,\\mathrm{ref}} = 0.002$ (d$^{-1}$)。\n- 土壤分解基础速率 $k_{d} = 0.0005$ (d$^{-1}$)。\n- 植被维持呼吸 $Q_{10}$ 值 $Q_{m} = 2.0$（无量纲）。\n- 异养呼吸 $Q_{10}$ 值 $Q_{h} = 2.0$（无量纲）。\n- 日时间步长 $\\Delta t = 1$（天）。\n\n您的程序必须针对每个测试案例，从提供的初始条件、恒定的日总初级生产力 $G$ 和恒定的温度 $T$ 开始，运行模型指定的天数。对于每一天 $n$，使用 $Q_{10}$ 法则计算温度乘数，并应用前向欧拉更新。\n\n测试套件。为以下四种情况运行模型：\n\n- 情况 1（参考温度下的基线）：\n  - $T = 15$（摄氏度），$G = 0.03$（kg C m$^{-2}$ d$^{-1}$），$N_{\\mathrm{days}} = 30$（天），$V_{0} = 5.0$（kg C m$^{-2}$），$S_{0} = 20.0$（kg C m$^{-2}$）。\n\n- 情况 2（冷边界）：\n  - $T = 0$（摄氏度），$G = 0.03$（kg C m$^{-2}$ d$^{-1}$），$N_{\\mathrm{days}} = 30$（天），$V_{0} = 5.0$（kg C m$^{-2}$），$S_{0} = 20.0$（kg C m$^{-2}$）。\n\n- 情况 3（暖边界）：\n  - $T = 30$（摄氏度），$G = 0.03$（kg C m$^{-2}$ d$^{-1}$），$N_{\\mathrm{days}} = 30$（天），$V_{0} = 5.0$（kg C m$^{-2}$），$S_{0} = 20.0$（kg C m$^{-2}$）。\n\n- 情况 4（无初始植被的边缘情况）：\n  - $T = 15$（摄氏度），$G = 0.03$（kg C m$^{-2}$ d$^{-1}$），$N_{\\mathrm{days}} = 10$（天），$V_{0} = 0.0$（kg C m$^{-2}$），$S_{0} = 20.0$（kg C m$^{-2}$）。\n\n要求的最终输出格式。您的程序应生成单行输出，包含按上述顺序排列的各案例的累积 NEE 结果，单位为千克碳每平方米（kg C m$^{-2}$），四舍五入到六位小数，格式为用方括号括起来的逗号分隔列表，例如 $[x_{1},x_{2},x_{3},x_{4}]$，其中每个 $x_{i}$ 是一个小数点后恰好有六位数字的浮点数。",
            "solution": "该问题提出了一个有效的、适定的初值问题，其基础是生态系统碳循环建模的标准原则。它是自洽的，数值模拟所需的所有参数和初始条件都已提供。我们将首先推导常微分方程（ODE）系统，然后使用前向欧拉（Euler）方法推导其离散时间对应形式，最后详细说明计算累积净生态系统交换（NEE）的算法。\n\n### 步骤1：温度依赖速率的公式化\n\n维持呼吸和异养呼吸的温度依赖性使用 $Q_{10}$ 公式进行建模。对于一个在参考温度 $T_{\\mathrm{ref}}$ 下具有基础速率和 $Q_{10}$ 值为 $Q$ 的过程，其在温度 $T$ 下的速率由基础速率乘以一个温度缩放因子 $f(T)$ 给出。\n\n温度缩放因子为 $f(T) = Q^{(T - T_{\\mathrm{ref}})/10}$。\n\n温度依赖的维持呼吸速率 $r_m(T)$（单位 d$^{-1}$）为：\n$$\nr_m(T) = r_{m,\\mathrm{ref}} \\cdot Q_m^{(T - T_{\\mathrm{ref}})/10}\n$$\n温度依赖的异养呼吸速率常数 $k_h(T)$（单位 d$^{-1}$）为：\n$$\nk_h(T) = k_d \\cdot Q_h^{(T - T_{\\mathrm{ref}})/10}\n$$\n\n### 步骤2：连续时间动力学（ODE）\n\n我们根据质量守恒原理（$\\frac{d(\\text{库})}{dt} = \\text{输入} - \\text{输出}$）为植被碳库 $V$ 和土壤有机碳库 $S$ 构建常微分方程组。\n\n首先，我们根据问题陈述定义所有相关的碳通量：\n- 总初级生产力（光合吸收）：$G$ (kg C m$^{-2}$ d$^{-1}$)。\n- 生长呼吸：$R_g = f_g G$。\n- 维持呼吸：$R_m = r_m(T) V$。\n- 总自养呼吸：$R_a = R_g + R_m = f_g G + r_m(T) V$。\n- 净初级生产力（可用于生长的碳）：$N = G - R_a = G - (f_g G + r_m(T) V) = (1 - f_g)G - r_m(T) V$。\n- 植被周转损失：$F_{v,\\text{loss}} = \\tau_v V$。\n- 凋落物（到土壤的输入）：$F_{\\ell} = f_{\\ell} F_{v,\\text{loss}} = f_{\\ell} \\tau_v V$。\n- 异养呼吸（土壤碳损失）：$R_h = k_h(T) S$。\n\n植被库 $V$ 的变化率是净初级生产力减去总周转损失：\n$$\n\\frac{dV}{dt} = N - F_{v,\\text{loss}} = \\left( (1 - f_g)G - r_m(T)V \\right) - \\tau_v V\n$$\n合并与 $V$ 成比例的项，我们得到第一个 ODE：\n$$\n\\frac{dV}{dt} = (1 - f_g)G - (r_m(T) + \\tau_v)V\n$$\n\n土壤库 $S$ 的变化率是凋落物输入减去异养呼吸损失：\n$$\n\\frac{dS}{dt} = F_{\\ell} - R_h = f_{\\ell} \\tau_v V - k_h(T)S\n$$\n这是第二个 ODE。\n\n完整的连续时间系统是：\n$$\n\\begin{cases}\n\\frac{dV}{dt} = (1 - f_g)G - (r_m(T) + \\tau_v)V \\\\\n\\frac{dS}{dt} = f_{\\ell} \\tau_v V - k_h(T)S\n\\end{cases}\n$$\n\n### 步骤3：使用前向欧拉方案进行离散化\n\n我们现在使用一阶显式前向欧拉方法对该系统进行离散化，该方法将导数近似为 $\\frac{dy}{dt} \\approx \\frac{y_{n+1} - y_n}{\\Delta t}$。重新整理得到更新规则 $y_{n+1} = y_n + \\Delta t \\cdot \\frac{dy}{dt}|_{t=t_n}$。\n\n将此应用于我们的系统，其在时间步长 $n$ 的状态变量为 $(V_n, S_n)$，时间步长为 $\\Delta t$：\n$$\nV_{n+1} = V_n + \\Delta t \\left[ (1 - f_g)G - (r_m(T) + \\tau_v)V_n \\right]\n$$\n$$\nS_{n+1} = S_n + \\Delta t \\left[ f_{\\ell} \\tau_v V_n - k_h(T)S_n \\right]\n$$\n问题指定时间步长 $\\Delta t = 1$ 天，得到简化的更新方程：\n$$\nV_{n+1} = V_n + (1 - f_g)G - (r_m(T) + \\tau_v)V_n = (1 - r_m(T) - \\tau_v)V_n + (1 - f_g)G\n$$\n$$\nS_{n+1} = S_n + f_{\\ell} \\tau_v V_n - k_h(T)S_n = (1 - k_h(T))S_n + f_{\\ell} \\tau_v V_n\n$$\n这些方程将被迭代使用以模拟碳库的演变。\n\n### 步骤4：净生态系统交换（NEE）的计算\n\n净生态系统交换（NEE）定义为总生态系统呼吸减去总光合吸收。正的 NEE 表示碳向大气的净通量。\n$$\n\\mathrm{NEE} = (R_g + R_m + R_h) - G\n$$\n问题规定，在日期索引为 $n$ 的日 NEE，记为 $\\mathrm{NEE}_n$，必须使用当天开始时的状态，即 $(V_n, S_n)$ 来计算。\n$$\n\\mathrm{NEE}_n = (f_g G) + (r_m(T)V_n) + (k_h(T)S_n) - G\n$$\n重新整理得到：\n$$\n\\mathrm{NEE}_n = r_m(T)V_n + k_h(T)S_n - (1 - f_g)G\n$$\n\n在 $N_{\\mathrm{days}}$ 天期间的累积 NEE 是每日 NEE 值的总和，每个值都乘以时间步长 $\\Delta t$。\n$$\n\\mathrm{NEE}_{\\mathrm{cum}} = \\sum_{n=0}^{N_{\\mathrm{days}}-1} \\mathrm{NEE}_n \\cdot \\Delta t\n$$\n由于 $\\Delta t = 1$ 天，这简化为每日 NEE 值的直接求和：\n$$\n\\mathrm{NEE}_{\\mathrm{cum}} = \\sum_{n=0}^{N_{\\mathrm{days}}-1} \\mathrm{NEE}_n\n$$\n模拟算法将首先初始化碳库 $(V_0, S_0)$，然后对于从 $n=0$ 到 $N_{\\mathrm{days}}-1$ 的每一天，它将首先根据当前状态 $(V_n, S_n)$ 计算 $\\mathrm{NEE}_n$，将其加到一个运行总和中，然后使用更新方程计算下一天的状态 $(V_{n+1}, S_{n+1})$。对每个测试案例重复此过程以获得所需结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and implements a two-pool carbon cycle model to compute\n    cumulative net ecosystem exchange (NEE).\n    \"\"\"\n\n    # Shared parameters from the problem statement\n    T_ref = 15.0  # Reference temperature in degrees Celsius\n    tau_v = 0.01  # Vegetation turnover rate in d^-1\n    f_ell = 0.9  # Fraction of turnover entering soil (dimensionless)\n    f_g = 0.25  # Growth respiration fraction (dimensionless)\n    r_m_ref = 0.002  # Maintenance respiration base rate in d^-1\n    k_d = 0.0005  # Soil decomposition base rate in d^-1\n    Q_m = 2.0  # Q10 for maintenance respiration (dimensionless)\n    Q_h = 2.0  # Q10 for heterotrophic respiration (dimensionless)\n    delta_t = 1.0  # Time step in days\n\n    # Test suite definition\n    test_cases = [\n        # Case 1 (baseline at the reference temperature)\n        {'T': 15.0, 'G': 0.03, 'N_days': 30, 'V0': 5.0, 'S0': 20.0},\n        # Case 2 (cold boundary)\n        {'T': 0.0, 'G': 0.03, 'N_days': 30, 'V0': 5.0, 'S0': 20.0},\n        # Case 3 (warm boundary)\n        {'T': 30.0, 'G': 0.03, 'N_days': 30, 'V0': 5.0, 'S0': 20.0},\n        # Case 4 (edge case with no initial vegetation)\n        {'T': 15.0, 'G': 0.03, 'N_days': 10, 'V0': 0.0, 'S0': 20.0},\n    ]\n\n    results = []\n\n    for case in test_cases:\n        # Unpack case-specific parameters\n        T = case['T']\n        G = case['G']\n        N_days = case['N_days']\n        V = case['V0']\n        S = case['S0']\n\n        # Calculate temperature-dependent rates once per simulation\n        # r_m(T) = r_m_ref * Q_m^((T - T_ref) / 10)\n        temp_exp = (T - T_ref) / 10.0\n        r_m_T = r_m_ref * (Q_m ** temp_exp)\n        \n        # k_h(T) = k_d * Q_h^((T - T_ref) / 10)\n        k_h_T = k_d * (Q_h ** temp_exp)\n\n        cumulative_nee = 0.0\n\n        for n in range(N_days):\n            # 1. Calculate fluxes and NEE for the current day 'n' using the state (V, S)\n            #    at the beginning of the day.\n            #    NEE_n = R_m_n + R_h_n + R_g_n - G\n            #    where R_m_n = r_m_T * V, R_h_n = k_h_T * S, R_g_n = f_g * G\n            \n            # The definition is NEE = R_m + R_h + R_g - G, which can be expressed as:\n            # NEE_n = r_m_T * V + k_h_T * S + f_g * G - G\n            # or NEE_n = r_m_T * V + k_h_T * S - (1 - f_g) * G\n            \n            nee_daily = r_m_T * V + k_h_T * S - (1.0 - f_g) * G\n\n            # 2. Update the cumulative NEE\n            cumulative_nee += nee_daily * delta_t\n\n            # 3. Calculate state for the next day (n+1) using forward Euler\n            #    V_{n+1} = V_n + delta_t * ( (1-f_g)G - (r_m_T + tau_v)V_n )\n            #    S_{n+1} = S_n + delta_t * ( f_ell * tau_v * V_n - k_h_T * S_n )\n            \n            # Since delta_t = 1.0\n            V_next = V + ((1.0 - f_g) * G - (r_m_T + tau_v) * V)\n            S_next = S + (f_ell * tau_v * V - k_h_T * S)\n\n            # 4. Update state variables for the next iteration\n            V = V_next\n            S = S_next\n            \n        results.append(cumulative_nee)\n\n    # Format the final output string as required\n    # e.g., [x1,x2,x3,x4] with 6 decimal places.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "有了碳循环模块后，下一步是将其与大气模型连接起来，这种连接发生在地球表面，即能量和物质交换的界面。本练习将深入探讨该界面的物理过程 。它演示了植被的生理特性（如由碳模块决定的气孔阻力 $r_s$）如何控制地表净辐射在感热和潜热通量之间的分配，进而影响地表温度，清晰地揭示了植被与大气之间的双向耦合关系。",
            "id": "4028684",
            "problem": "动态全球植被模型（DGVM）中的单层冠层通过能量平衡和气孔控制，在数值天气预报（NWP）配置中与大气边界层耦合。假设在正午时分，冠层-空气界面的能量平衡处于稳态，储存热通量和地表热通量可忽略不计，且湍流输送可以用热量和水汽的串联阻力来表示。在此时间步长下，气孔阻力由 DGVM 碳循环求解器给定。使用以下物理上一致的参数：\n- 净辐射：$R_n = 350$ W m$^{-2}$。\n- 空气密度：$\\rho = 1.20$ kg m$^{-3}$。\n- 空气定压比热：$c_p = 1.005 \\times 10^{3}$ J kg$^{-1}$ K$^{-1}$。\n- 蒸发潜热：$\\lambda = 2.45 \\times 10^{6}$ J kg$^{-1}$。\n- 热量和水汽的空气动力学阻力：$r_a = 5.0 \\times 10^{1}$ s m$^{-1}$。\n- 水汽的气孔（表面）阻力：$r_s = 1.00 \\times 10^{2}$ s m$^{-1}$。\n- 空气温度下饱和水汽压曲线的斜率：$s = 1.89 \\times 10^{2}$ Pa K$^{-1}$。\n- 干湿表常数：$\\gamma = 6.60 \\times 10^{1}$ Pa K$^{-1}$。\n- 水汽压亏缺：$D = 1.50 \\times 10^{3}$ Pa。\n\n仅从感热和水汽的通量-梯度关系、比湿和水汽压之间的理想气体关系，以及地表稳态能量平衡的定义出发，推导冠层与空气温差 $\\Delta T = T_s - T_a$ 作为给定物理量的函数解析表达式。然后用上述参数计算该表达式的值。将最终数值答案四舍五入至三位有效数字，并以 K 为单位表示温度增量。",
            "solution": "题目要求推导冠层与空气温差 $\\Delta T = T_s - T_a$ 的解析表达式，并根据一组给定参数进行数值计算。推导将从指定的能量平衡和通量-梯度关系的基本原理开始。\n\n控制原理如下：\n1.  **稳态能量平衡：** 在冠层-空气界面，当储存热通量和地表热通量可忽略不计时，净辐射（$R_n$）由感热通量（$H$）和潜热通量（$\\lambda E$）平衡。\n    $$R_n = H + \\lambda E$$\n    其中 $\\lambda$ 是蒸发潜热，$E$ 是水汽通量（蒸散）。\n\n2.  **通量-梯度关系（阻力类比）：**\n    感热和水汽的湍流通量是使用阻力类比来定义的。\n    从温度为 $T_s$ 的冠层表面到温度为 $T_a$ 的空气的感热通量为：\n    $$H = \\rho c_p \\frac{T_s - T_a}{r_a} = \\rho c_p \\frac{\\Delta T}{r_a}$$\n    其中 $\\rho$ 是空气密度，$c_p$ 是空气定压比热，$r_a$ 是热量的空气动力学阻力。\n\n    潜热通量涉及水汽从温度为 $T_s$ 的饱和表面向周围空气的输送。总阻力是空气动力学阻力（$r_a$）和表面（气孔）阻力（$r_s$）之和。该通量由比湿梯度 $q_s(T_s) - q_a$ 驱动。\n    $$\\lambda E = \\lambda \\rho \\frac{q_s(T_s) - q_a}{r_a + r_s}$$\n    比湿（$q$）可以通过理想气体定律和干湿表常数的定义 $\\gamma = \\frac{c_p P}{\\epsilon \\lambda}$（其中 $P$ 是大气压力，$\\epsilon$ 是水与干空气的摩尔质量比）与水汽压（$e$）联系起来。这导出了关系式 $\\lambda E = \\frac{\\rho c_p}{\\gamma} \\frac{e_s(T_s) - e_a}{r_a + r_s}$，其中 $e_s(T_s)$ 是表面温度 $T_s$ 下的饱和水汽压，$e_a$ 是周围空气的水汽压。\n\n3.  **饱和水汽压的线性化：**\n    为了将表面的水汽压 $e_s(T_s)$ 与空气温度 $T_a$ 联系起来，我们使用在 $T_a$ 附近的一阶泰勒展开。题目给出了在 $T_a$ 处计算的饱和水汽压曲线的斜率 $s = \\frac{de_s}{dT}$。\n    $$e_s(T_s) \\approx e_s(T_a) + s(T_s - T_a) = e_s(T_a) + s \\Delta T$$\n    其中 $e_s(T_a)$ 是空气温度下的饱和水汽压。\n\n水汽压差项 $e_s(T_s) - e_a$ 现在可以用饱和水汽压亏缺 $D = e_s(T_a) - e_a$ 和 $\\Delta T$ 来表示：\n$$e_s(T_s) - e_a = (e_s(T_a) + s \\Delta T) - e_a = (e_s(T_a) - e_a) + s \\Delta T = D + s \\Delta T$$\n将此代入潜热通量的表达式中，得到：\n$$\\lambda E = \\frac{\\rho c_p}{\\gamma} \\frac{D + s \\Delta T}{r_a + r_s}$$\n\n现在，我们将 $H$ 和 $\\lambda E$ 的表达式代入能量平衡方程：\n$$R_n = \\left(\\rho c_p \\frac{\\Delta T}{r_a}\\right) + \\left(\\frac{\\rho c_p}{\\gamma} \\frac{D + s \\Delta T}{r_a + r_s}\\right)$$\n目标是求解该方程以得到 $\\Delta T$。我们重新整理方程，将含有 $\\Delta T$ 的项组合在一起：\n$$R_n = \\frac{\\rho c_p}{r_a}\\Delta T + \\frac{\\rho c_p D}{\\gamma (r_a + r_s)} + \\frac{\\rho c_p s \\Delta T}{\\gamma (r_a + r_s)}$$\n$$R_n - \\frac{\\rho c_p D}{\\gamma (r_a + r_s)} = \\Delta T \\left(\\frac{\\rho c_p}{r_a} + \\frac{\\rho c_p s}{\\gamma (r_a + r_s)}\\right)$$\n求解 $\\Delta T$：\n$$\\Delta T = \\frac{R_n - \\frac{\\rho c_p D}{\\gamma (r_a + r_s)}}{\\rho c_p \\left(\\frac{1}{r_a} + \\frac{s}{\\gamma (r_a + r_s)}\\right)}$$\n为了得到更紧凑的形式，我们可以通过 $\\Delta T = \\frac{H r_a}{\\rho c_p}$ 将 $\\Delta T$ 与 $H$ 联系起来。我们首先求解能量平衡方程得到 $H$。\n$$R_n = H + \\lambda E \\implies R_n = H + \\frac{\\rho c_p D + s (\\rho c_p \\frac{\\Delta T}{r_a}) r_a}{\\gamma(r_a+r_s)} = H + \\frac{\\rho c_p D + s H r_a}{\\gamma(r_a+r_s)}$$\n$$R_n \\gamma (r_a+r_s) = H \\gamma (r_a+r_s) + \\rho c_p D + s H r_a$$\n$$R_n \\gamma (r_a+r_s) - \\rho c_p D = H \\left( \\gamma (r_a+r_s) + s r_a \\right)$$\n$$H = \\frac{R_n \\gamma (r_a+r_s) - \\rho c_p D}{\\gamma (r_a+r_s) + s r_a}$$\n将此代入关系式 $\\Delta T = \\frac{H r_a}{\\rho c_p}$，我们得到冠层与空气温差的最终解析表达式：\n$$\\Delta T = \\frac{r_a}{\\rho c_p} \\left( \\frac{R_n \\gamma (r_a+r_s) - \\rho c_p D}{\\gamma (r_a+r_s) + s r_a} \\right)$$\n\n现在，我们使用给定的参数来计算这个表达式：\n$R_n = 350$ W m$^{-2}$\n$\\rho = 1.20$ kg m$^{-3}$\n$c_p = 1.005 \\times 10^{3}$ J kg$^{-1}$ K$^{-1}$\n$r_a = 5.0 \\times 10^{1}$ s m$^{-1}$\n$r_s = 1.00 \\times 10^{2}$ s m$^{-1}$\n$s = 1.89 \\times 10^{2}$ Pa K$^{-1}$\n$\\gamma = 6.60 \\times 10^{1}$ Pa K$^{-1}$\n$D = 1.50 \\times 10^{3}$ Pa\n\n首先，我们计算一些中间产物：\n$\\rho c_p = 1.20 \\, \\text{kg m}^{-3} \\times 1.005 \\times 10^{3} \\, \\text{J kg}^{-1} \\text{K}^{-1} = 1206$ J m$^{-3}$ K$^{-1}$\n$r_a + r_s = 50 \\, \\text{s m}^{-1} + 100 \\, \\text{s m}^{-1} = 150$ s m$^{-1}$\n\n接下来，我们计算 $H$ 的分数表达式的分子和分母：\n分子：$R_n \\gamma (r_a+r_s) - \\rho c_p D$\n$ = (350) \\times (66.0) \\times (150) - (1206) \\times (1500)$\n$ = 3465000 - 1809000 = 1656000$ J Pa K$^{-1}$ m$^{-3}$\n\n分母：$\\gamma (r_a+r_s) + s r_a$\n$ = (66.0) \\times (150) + (189) \\times (50)$\n$ = 9900 + 9450 = 19350$ Pa s K$^{-1}$ m$^{-1}$\n\n现在我们计算感热通量 $H$：\n$$H = \\frac{1656000}{19350} \\approx 85.5814 \\, \\text{W m}^{-2}$$\n\n最后，我们计算 $\\Delta T$：\n$$\\Delta T = \\frac{r_a}{\\rho c_p} H = \\frac{50}{1206} \\times 85.5814 \\approx 3.54815 \\, \\text{K}$$\n根据要求四舍五入到三位有效数字，温度增量为：\n$\\Delta T \\approx 3.55$ K。",
            "answer": "$$\\boxed{3.55}$$"
        },
        {
            "introduction": "在模型中耦合具有迥异时间尺度的过程——例如快速的土壤呼吸和缓慢的植被生长——会产生所谓的“刚性”（stiff）系统，这对数值求解器构成了挑战。本练习通过分析一个常用时间积分方案的稳定性，来探讨这种刚性带来的实际后果 。完成这个练习将帮助您理解，为何模型开发者必须谨慎选择其数值方案和时间步长，以确保模型的稳定和准确。",
            "id": "4028696",
            "problem": "考虑一个在数值天气预报 (NWP) 中将碳循环与动态全球植被模型 (DGVM) 耦合时产生的简化线性化异常系统。设 $x(t) = (\\delta V(t), \\delta S(t))^\\top$ 表示在固定气象强迫下，围绕气候稳态的植被碳和土壤碳的微小异常。质量守恒和一级动力学意味着微小扰动的线性系统如下：\n$$\n\\frac{d}{dt}\n\\begin{pmatrix}\n\\delta V \\\\\n\\delta S\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-c_v  a \\\\\n\\ell  -c_s\n\\end{pmatrix}\n\\begin{pmatrix}\n\\delta V \\\\\n\\delta S\n\\end{pmatrix},\n$$\n其中 $c_v$ 是植被碳弛豫率，$\\ell$ 是从植被到土壤的凋落物耦合， $a$ 是从土壤到植被的反馈耦合， $c_s$ 是有效土壤呼吸速率。土壤呼吸速率根据标准的 Arrhenius 型敏感性依赖于温度 $c_s = k_s \\exp\\!\\big(\\beta (T - T_{\\mathrm{ref}})\\big)$，其中 $k_s$ 是参考温度 $T_{\\mathrm{ref}}$ 下的基准异养呼吸速率，$\\beta$ 是每开尔文的经验灵敏度系数， $T$ 是环境温度。所有速率 $c_v$、$k_s$、$a$ 和 $\\ell$ 的单位均为 $\\mathrm{day}^{-1}$，温度 $T$ 和 $T_{\\mathrm{ref}}$ 的单位均为开尔文。\n\n你将分析应用于此线性化系统的显式前向欧拉时间步进法。设 $\\Delta t$ 表示以天为单位的时间步长。显式欧拉更新为\n$$\nx_{n+1} = x_n + \\Delta t \\, A \\, x_n,\n$$\n其中\n$$\nA =\n\\begin{pmatrix}\n-c_v  a \\\\\n\\ell  -c_s\n\\end{pmatrix}.\n$$\n\n你的任务是为每组给定的参数确定能确保异常系统的显式欧拉格式线性稳定性的最大 $\\Delta t$（以天为单位）。也就是说，找到最大的 $\\Delta t > 0$，使得离散时间放大矩阵的谱半径严格小于 $1$。\n\n使用以下测试套件。对于每种情况，根据上面定义的 $k_s$、$\\beta$、$T$ 和 $T_{\\mathrm{ref}}$ 计算 $c_s$，然后组装 $A$ 并确定最大的稳定 $\\Delta t$。\n\n所有速率的单位均为 $\\mathrm{day}^{-1}$，所有温度的单位均为开尔文，并且要求的输出必须以天为单位。\n\n- 情况 1（硬土、弱耦合、中度变暖）：$c_v = 0.05$, $k_s = 1.0$, $\\beta = 0.07$, $T = 298$, $T_{\\mathrm{ref}} = 293$, $\\ell = 0.1$, $a = 0.02$。\n- 情况 2（等弛豫、非耦合、等温）：$c_v = 0.5$, $k_s = 0.5$, $\\beta = 0.0$, $T = 293$, $T_{\\mathrm{ref}} = 293$, $\\ell = 0.0$, $a = 0.0$。\n- 情况 3（强交叉耦合伴随负反馈、轻度变暖）：$c_v = 0.2$, $k_s = 0.8$, $\\beta = 0.05$, $T = 295$, $T_{\\mathrm{ref}} = 293$, $\\ell = 2.0$, $a = -2.0$。\n- 情况 4（极硬土、弱耦合、强烈变暖）：$c_v = 0.05$, $k_s = 10.0$, $\\beta = 0.1$, $T = 300$, $T_{\\mathrm{ref}} = 293$, $\\ell = 0.1$, $a = 0.01$。\n- 情况 5（慢植被、轻度耦合、等温）：$c_v = 0.001$, $k_s = 0.2$, $\\beta = 0.0$, $T = 293$, $T_{\\mathrm{ref}} = 293$, $\\ell = 0.01$, $a = 0.005$。\n\n要求：\n- 以浮点数形式表示最终答案（单位：天）。\n- 你的程序的输出必须是单行，包含一个逗号分隔的列表，其中包含五个案例计算出的最大稳定 $\\Delta t$ 值，用方括号括起来，并与上面列出的顺序相同（例如，$[x_1,x_2,x_3,x_4,x_5]$）。",
            "solution": "首先对问题陈述进行严格的验证过程。\n\n### 第 1 步：提取已知条件\n- **方程组**：线性化异常系统由 $\\frac{d}{dt} x(t) = A x(t)$ 描述，其中 $x(t) = (\\delta V(t), \\delta S(t))^\\top$。\n- **系统矩阵**：$A = \\begin{pmatrix} -c_v  a \\\\ \\ell  -c_s \\end{pmatrix}$。\n- **参数定义**：\n    - $c_v$：植被碳弛豫率 ($\\mathrm{day}^{-1}$)。\n    - $\\ell$：凋落物耦合 ($\\mathrm{day}^{-1}$)。\n    - $a$：土壤到植被的反馈耦合 ($\\mathrm{day}^{-1}$)。\n    - $c_s$：有效土壤呼吸速率 ($\\mathrm{day}^{-1}$)。\n- **土壤呼吸公式**：$c_s = k_s \\exp(\\beta (T - T_{\\mathrm{ref}}))$，其中：\n    - $k_s$：基线呼吸速率 ($\\mathrm{day}^{-1}$)。\n    - $\\beta$：温度敏感性系数 ($\\mathrm{K}^{-1}$)。\n    - $T$：环境温度 ($\\mathrm{K}$)。\n    - $T_{\\mathrm{ref}}$：参考温度 ($\\mathrm{K}$)。\n- **数值方法**：显式前向欧拉格式，$x_{n+1} = (I + \\Delta t \\, A) \\, x_n$，其中 $\\Delta t$ 是以天为单位的时间步长。\n- **稳定性条件**：放大矩阵 $G = I + \\Delta t \\, A$ 的谱半径必须严格小于 $1$，即 $\\rho(G) < 1$。\n- **目标**：找到满足五个给定参数集的稳定性条件的最大 $\\Delta t > 0$。\n- **测试案例**：\n    - 情况 1：$c_v = 0.05$, $k_s = 1.0$, $\\beta = 0.07$, $T = 298$, $T_{\\mathrm{ref}} = 293$, $\\ell = 0.1$, $a = 0.02$。\n    - 情况 2：$c_v = 0.5$, $k_s = 0.5$, $\\beta = 0.0$, $T = 293$, $T_{\\mathrm{ref}} = 293$, $\\ell = 0.0$, $a = 0.0$。\n    - 情况 3：$c_v = 0.2$, $k_s = 0.8$, $\\beta = 0.05$, $T = 295$, $T_{\\mathrm{ref}} = 293$, $\\ell = 2.0$, $a = -2.0$。\n    - 情况 4：$c_v = 0.05$, $k_s = 10.0$, $\\beta = 0.1$, $T = 300$, $T_{\\mathrm{ref}} = 293$, $\\ell = 0.1$, $a = 0.01$。\n    - 情况 5：$c_v = 0.001$, $k_s = 0.2$, $\\beta = 0.0$, $T = 293$, $T_{\\mathrm{ref}} = 293$, $\\ell = 0.01$, $a = 0.005$。\n\n### 第 2 步：使用提取的已知条件进行验证\n根据验证标准对问题进行分析。\n- **科学依据**：该问题基于气候建模中的标准实践，特别是围绕平衡点的系统动力学线性化和使用 Arrhenius 型方程表示温度依赖性。这些都是已建立且科学合理的概念。\n- **适定性**：该问题在数学上是适定的。它要求找到一个正实数 $\\Delta t$ 的最大值，该值受一组从矩阵特征值得出的不等式约束。显式欧拉方法的稳定域是数值分析中一个明确定义的概念，确保对于一个稳定的连续系统存在唯一解。\n- **客观性**：问题陈述使用了精确的数学定义和客观的参数值。没有歧义或主观性语言。\n- **完整性和一致性**：解决问题所需的所有参数、方程和条件都已提供。单位是一致的。没有矛盾之处。\n\n### 第 3 步：结论和行动\n**结论**：该问题是**有效的**。它自成体系，有科学依据，且在数学上是适定的。\n\n**行动**：继续提供一个完整的、有理有据的解决方案。\n\n### 解决方案\n问题要求找到最大时间步长 $\\Delta t$，使得应用于系统 $\\frac{dx}{dt} = Ax$ 的显式欧拉方法是稳定的。离散更新规则为 $x_{n+1} = (I + \\Delta t A)x_n$。\n\n此格式的稳定性取决于放大矩阵 $G = I + \\Delta t A$ 的特征值。设 $\\{\\lambda_i\\}$ 是矩阵 $A$ 的特征值集合。那么 $G$ 的特征值为 $\\{1 + \\Delta t \\lambda_i\\}$。稳定性条件要求 $G$ 的谱半径严格小于 $1$，这意味着 $G$ 的每个特征值的模都必须小于 $1$：\n$$\n|1 + \\Delta t \\lambda_i|  1 \\quad \\text{for all } i.\n$$\n这个不等式表明，对于每个特征值 $\\lambda_i$，复数 $z_i = \\Delta t \\lambda_i$ 必须位于复平面上以 $-1$ 为中心、半径为 $1$ 的开圆盘内部。设一个特征值为 $\\lambda_i = \\text{Re}(\\lambda_i) + j \\text{Im}(\\lambda_i)$。稳定性条件变为：\n$$\n(1 + \\Delta t \\text{Re}(\\lambda_i))^2 + (\\Delta t \\text{Im}(\\lambda_i))^2  1^2\n$$\n$$\n1 + 2\\Delta t \\text{Re}(\\lambda_i) + (\\Delta t)^2 (\\text{Re}(\\lambda_i))^2 + (\\Delta t)^2 (\\text{Im}(\\lambda_i))^2  1\n$$\n简化并认识到 $(\\text{Re}(\\lambda_i))^2 + (\\text{Im}(\\lambda_i))^2 = |\\lambda_i|^2$，我们得到：\n$$\n2\\Delta t \\text{Re}(\\lambda_i) + (\\Delta t)^2 |\\lambda_i|^2  0\n$$\n由于我们寻找的是 $\\Delta t > 0$，我们可以除以 $\\Delta t$：\n$$\n2\\text{Re}(\\lambda_i) + \\Delta t |\\lambda_i|^2  0\n$$\n为了使这个不等式对任何正 $\\Delta t$ 成立，必须有 $\\text{Re}(\\lambda_i)  0$。这对应于连续系统本身的物理稳定性。如果任何 $\\text{Re}(\\lambda_i) \\geq 0$，则连续系统是不稳定或中性稳定的，并且对于任何 $\\Delta t > 0$，显式欧拉方法都将是不稳定的。这个 $2 \\times 2$ 系统的物理稳定性可以通过检查是否 $\\text{Tr}(A)  0$ 和 $\\det(A) > 0$ 来确认。对于所有给定的测试案例，系统都是物理稳定的。\n\n当 $\\text{Re}(\\lambda_i)  0$ 时，我们可以解出 $\\Delta t$：\n$$\n\\Delta t |\\lambda_i|^2  -2\\text{Re}(\\lambda_i)\n$$\n$$\n\\Delta t  \\frac{-2\\text{Re}(\\lambda_i)}{|\\lambda_i|^2}\n$$\n这个条件必须对所有特征值 $\\lambda_i$ 都成立。因此，时间步长 $\\Delta t$ 必须小于这些上界的最小值。最大稳定时间步长是允许范围的下确界：\n$$\n\\Delta t_{\\text{max}} = \\min_{i} \\left( \\frac{-2\\text{Re}(\\lambda_i)}{|\\lambda_i|^2} \\right)\n$$\n\n解决每个案例问题的算法如下：\n1.  给定参数 $c_v$、$k_s$、$\\beta$、$T$、$T_{\\mathrm{ref}}$、$\\ell$ 和 $a$，首先计算土壤呼吸速率 $c_s = k_s \\exp(\\beta (T - T_{\\mathrm{ref}}))$。\n2.  组装矩阵 $A = \\begin{pmatrix} -c_v  a \\\\ \\ell  -c_s \\end{pmatrix}$。\n3.  计算矩阵 $A$ 的两个特征值 $\\lambda_1$ 和 $\\lambda_2$。\n4.  对于每个特征值 $\\lambda_i$，计算稳定性界限 $S_i = \\frac{-2\\text{Re}(\\lambda_i)}{|\\lambda_i|^2}$。\n5.  最大稳定时间步长是这些界限的最小值：$\\Delta t_{\\text{max}} = \\min(S_1, S_2)$。\n\n将此程序应用于五个测试案例中的每一个，以找到相应的最大稳定时间步长。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the maximum stable time step for the explicit Euler scheme\n    for a linearized carbon cycle model for several parameter sets.\n    \"\"\"\n\n    # test_cases stores parameters in the order:\n    # (c_v, k_s, beta, T, T_ref, l, a)\n    test_cases = [\n        # Case 1 (stiff soil, weak coupling, moderate warming)\n        (0.05, 1.0, 0.07, 298.0, 293.0, 0.1, 0.02),\n        # Case 2 (equal relaxation, uncoupled, isothermal)\n        (0.5, 0.5, 0.0, 293.0, 293.0, 0.0, 0.0),\n        # Case 3 (strong cross-coupling with negative feedback, mild warming)\n        (0.2, 0.8, 0.05, 295.0, 293.0, 2.0, -2.0),\n        # Case 4 (very stiff soil, weak coupling, strong warming)\n        (0.05, 10.0, 0.1, 300.0, 293.0, 0.1, 0.01),\n        # Case 5 (slow vegetation, mild coupling, isothermal)\n        (0.001, 0.2, 0.0, 293.0, 293.0, 0.01, 0.005),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        c_v, k_s, beta, T, T_ref, l, a = case\n\n        # Step 1: Calculate the effective soil respiration rate c_s\n        c_s = k_s * np.exp(beta * (T - T_ref))\n\n        # Step 2: Assemble the system matrix A\n        A = np.array([\n            [-c_v, a],\n            [l, -c_s]\n        ])\n\n        # Step 3: Compute the eigenvalues of A\n        eigenvalues = np.linalg.eigvals(A)\n\n        # Check for physical stability. If any Re(lambda) = 0, the continuous\n        # system is unstable, and explicit Euler is unstable for any dt  0.\n        # This is equivalent to checking if Tr(A)  0 and det(A)  0.\n        # Here we directly check the eigenvalues.\n        if np.any(eigenvalues.real = 0):\n            max_dt = 0.0\n        else:\n            # Step 4: Calculate the stability constraint for each eigenvalue\n            # The constraint is dt  -2*Re(lambda) / |lambda|^2\n            # We calculate this upper bound for each eigenvalue.\n            stability_bounds = -2 * eigenvalues.real / (np.abs(eigenvalues)**2)\n\n            # Step 5: The maximum stable time step is the minimum of these bounds\n            max_dt = np.min(stability_bounds)\n        \n        results.append(max_dt)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.7f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}