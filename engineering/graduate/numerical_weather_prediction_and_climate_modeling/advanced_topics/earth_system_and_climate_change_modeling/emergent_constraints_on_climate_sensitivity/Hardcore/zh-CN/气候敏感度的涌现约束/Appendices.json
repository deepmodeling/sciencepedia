{
    "hands_on_practices": [
        {
            "introduction": "本次练习将我们对气候敏感度的理解建立在基础物理学之上。通过使用一个简化的双箱能量平衡模型，您将推导出瞬态气候响应 ($TCR$) 和平衡气候敏感度 ($ECS$) 的表达式，揭示海洋热量吸收在造成短期和长期变暖差异中的关键作用。这个练习  阐明了为什么涌现约束必须经常区分这两个关键指标。",
            "id": "4035774",
            "problem": "考虑一个气候系统的全球平均双箱能量平衡模型，其中上层箱代表大气-混合层海洋，下层箱代表深海。上层箱的全球平均温度异常 $T_{u}(t)$ 和深海的全球平均温度异常 $T_{d}(t)$ 的演变由能量守恒定律决定：\n$$\nC_{u}\\,\\frac{d T_{u}}{dt} \\;=\\; F(t) \\;-\\; \\lambda\\,T_{u}(t) \\;-\\; \\gamma\\,\\big(T_{u}(t) - T_{d}(t)\\big),\n$$\n$$\nC_{d}\\,\\frac{d T_{d}}{dt} \\;=\\; \\gamma\\,\\big(T_{u}(t) - T_{d}(t)\\big),\n$$\n其中，$C_{u}$ 和 $C_{d}$ 分别是上层和深海箱的有效热容，$F(t)$ 是外部施加的辐射强迫，$\\lambda$ 是净气候反馈参数（对于稳定反馈为正值），$\\gamma$ 是两箱之间的有效热交换系数。将大气层顶净向下能量不平衡定义为 $N(t) \\equiv F(t) - \\lambda\\,T_{u}(t)$，将海洋吸热效率定义为 $\\kappa$，这是瞬态响应的一种涌现特性，使得在数十年时间尺度上，随着辐射强迫的增加，$N(t)$ 与 $T_{u}(t)$ 近似成正比，即 $N(t) \\approx \\kappa\\,T_{u}(t)$。\n\n假设一个理想情景，即大气二氧化碳浓度以每年 $1\\%$ 的速率指数增长，使得辐射强迫随时间单调增加，直到二氧化碳浓度加倍。令 $F_{2\\times\\mathrm{CO_{2}}}$ 表示二氧化碳浓度加倍时的辐射强迫，并定义平衡气候敏感性为 $\\mathrm{ECS} \\equiv T_{\\mathrm{eq}}$，满足平衡关系 $0 = F_{2\\times\\mathrm{CO_{2}}} - \\lambda\\,T_{\\mathrm{eq}}$。在上述瞬态情景下，定义瞬态气候响应为二氧化碳浓度加倍时刻 $t_{2}$ 的温度 $\\mathrm{TCR} \\equiv T_{u}(t_{2})$。\n\n仅使用控制平衡方程、$N(t)$ 的定义以及在瞬态过程中成立的涌现比例关系 $N(t) \\approx \\kappa\\,T_{u}(t)$，推导用 $F_{2\\times\\mathrm{CO_{2}}}$、$\\lambda$ 和 $\\kappa$ 表示的 $\\mathrm{TCR}$ 表达式，以及用 $F_{2\\times\\mathrm{CO_{2}}}$ 和 $\\lambda$ 表示的 $\\mathrm{ECS}$ 表达式。然后，使用假设但科学上合理的参数值 $F_{2\\times\\mathrm{CO_{2}}} = 3.70\\,\\mathrm{W\\,m^{-2}}$、$\\lambda = 1.30\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}$ 和 $\\kappa = 0.70\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}$，计算无量纲比率\n$$\nR \\equiv \\frac{\\mathrm{TCR}}{\\mathrm{ECS}}\n$$\n作为时间尺度效应的定量度量。\n\n将 $R$ 的最终答案四舍五入到四位有效数字。将最终答案表示为无单位的纯数。",
            "solution": "问题陈述已经过严格验证，被认为是科学可靠、定义明确、客观且自洽的。所提供的双箱能量平衡模型是气候动力学中的一个标准概念工具，平衡气候敏感性(ECS)、瞬态气候响应(TCR)和海洋吸热效率($\\kappa$)的定义是正确的。给定的参数值在物理上是合理的。因此，该问题被视为有效，并提供完整解答如下。\n\n该问题要求推导平衡气候敏感性($\\mathrm{ECS}$)和瞬态气候响应($\\mathrm{TCR}$)的表达式，然后计算它们的比率 $R$。\n\n首先，我们推导 $\\mathrm{ECS}$ 的表达式。$\\mathrm{ECS}$ 被定义为对持续辐射强迫 $F_{2\\times\\mathrm{CO_{2}}}$ 响应的平衡温度异常 $T_{\\mathrm{eq}}$。在平衡状态下，所有时间导数均为零，即 $\\frac{dT_u}{dt} = 0$ 和 $\\frac{dT_d}{dt} = 0$。第二个控制方程 $C_{d}\\,\\frac{d T_{d}}{dt} = \\gamma\\,\\big(T_{u}(t) - T_{d}(t)\\big)$ 意味着在平衡状态下，$T_{u} - T_{d} = 0$，因此 $T_u = T_d = T_{\\mathrm{eq}}$。将这些条件代入第一个控制方程，得到：\n$$\nC_{u} \\cdot 0 = F_{2\\times\\mathrm{CO_{2}}} - \\lambda\\,T_{\\mathrm{eq}} - \\gamma\\,\\big(T_{\\mathrm{eq}} - T_{\\mathrm{eq}}\\big)\n$$\n$$\n0 = F_{2\\times\\mathrm{CO_{2}}} - \\lambda\\,T_{\\mathrm{eq}}\n$$\n这与问题陈述中提供的平衡关系相符。$\\mathrm{ECS}$ 定义为 $\\mathrm{ECS} \\equiv T_{\\mathrm{eq}}$。求解 $T_{\\mathrm{eq}}$ 得到 $\\mathrm{ECS}$ 的表达式：\n$$\n\\mathrm{ECS} = \\frac{F_{2\\times\\mathrm{CO_{2}}}}{\\lambda}\n$$\n\n接下来，我们推导 $\\mathrm{TCR}$ 的表达式。$\\mathrm{TCR}$ 定义为 $\\mathrm{CO_2}$ 浓度加倍时的上层箱温度异常，即 $\\mathrm{TCR} \\equiv T_{u}(t_{2})$。在这个特定时刻，辐射强迫为 $F(t_2) = F_{2\\times\\mathrm{CO_{2}}}$。问题陈述指出，在瞬态增温情景中，大气层顶净向下能量不平衡 $N(t)$ 与上层箱温度异常 $T_u(t)$ 近似成正比，关系为 $N(t) \\approx \\kappa\\,T_{u}(t)$。问题还给出了能量不平衡的物理定义：$N(t) \\equiv F(t) - \\lambda\\,T_{u}(t)$。\n\n通过在浓度加倍时刻 $t_2$ 将这两个 $N(t)$ 的表达式相等，我们可以建立瞬态的关系。根据问题设置的指示（“使用...涌现比例关系”），我们将这个近似视为等式。\n$$\n\\kappa\\,T_{u}(t_{2}) = F(t_{2}) - \\lambda\\,T_{u}(t_{2})\n$$\n将定义 $\\mathrm{TCR} \\equiv T_{u}(t_{2})$ 和 $F(t_{2}) = F_{2\\times\\mathrm{CO_{2}}}$ 代入此方程：\n$$\n\\kappa\\,\\mathrm{TCR} = F_{2\\times\\mathrm{CO_{2}}} - \\lambda\\,\\mathrm{TCR}\n$$\n现在我们可以重排这个代数方程来求解 $\\mathrm{TCR}$：\n$$\n\\kappa\\,\\mathrm{TCR} + \\lambda\\,\\mathrm{TCR} = F_{2\\times\\mathrm{CO_{2}}}\n$$\n$$\n(\\lambda + \\kappa)\\,\\mathrm{TCR} = F_{2\\times\\mathrm{CO_{2}}}\n$$\n这给出了用指定参数表示的 $\\mathrm{TCR}$ 表达式：\n$$\n\\mathrm{TCR} = \\frac{F_{2\\times\\mathrm{CO_{2}}}}{\\lambda + \\kappa}\n$$\n\n最后，我们需要计算无量纲比率 $R \\equiv \\frac{\\mathrm{TCR}}{\\mathrm{ECS}}$。使用上面推导出的表达式：\n$$\nR = \\frac{\\mathrm{TCR}}{\\mathrm{ECS}} = \\frac{\\left( \\frac{F_{2\\times\\mathrm{CO_{2}}}}{\\lambda + \\kappa} \\right)}{\\left( \\frac{F_{2\\times\\mathrm{CO_{2}}}}{\\lambda} \\right)}\n$$\n项 $F_{2\\times\\mathrm{CO_{2}}}$ 从分子和分母中约去，得到比率 $R$ 的简化符号表达式：\n$$\nR = \\frac{\\lambda}{\\lambda + \\kappa}\n$$\n该表达式表明，瞬态响应与平衡响应之比取决于气候反馈参数与反馈参数和海洋吸热效率之和的比值。由于 $\\kappa > 0$，因此 $R  1$，这在物理上是符合预期的，因为海洋吸热会延迟地表增温。\n\n现在，我们代入给定的数值来计算 $R$ 的值：\n$\\lambda = 1.30\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}$\n$\\kappa = 0.70\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}$\n\n$$\nR = \\frac{1.30}{1.30 + 0.70} = \\frac{1.30}{2.00} = 0.65\n$$\n问题要求将最终答案四舍五入到四位有效数字。因此，我们将结果表示为：\n$$\nR = 0.6500\n$$",
            "answer": "$$\\boxed{0.6500}$$"
        },
        {
            "introduction": "在建立了物理概念之后，我们现在转向涌现约束的统计核心。这个问题要求您推导量化一个可观测的预测因子（即使其自身存在测量不确定性）如何约束 $ECS$ 估计值的数学公式。通过这个线性高斯框架  的练习，您将对信息如何在贝叶斯背景下减少不确定性有一个精确的理解。",
            "id": "4035788",
            "problem": "考虑气候建模中的一个涌现约束框架，其中平衡气候敏感度 (ECS)，记为 $Y$，以及一个变率或反馈强度的候选预测因子，记为潜在真实预测因子 $X^{\\ast}$，在一个模式集合中联合分布。假设如下：\n\n- 对 $(X^{\\ast}, Y)$ 服从联合高斯分布，其均值向量为 $\\left(\\mu_{X}, \\mu_{Y}\\right)$，协方差矩阵为\n$$\n\\begin{pmatrix}\n\\sigma_{X}^{2}  r\\,\\sigma_{X}\\sigma_{Y} \\\\\nr\\,\\sigma_{X}\\sigma_{Y}  \\sigma_{Y}^{2}\n\\end{pmatrix},\n$$\n其中 $r$ 是 $X^{\\ast}$ 和 $Y$ 之间的集合相关性，$\\sigma_{X}^{2}$ 是 $X^{\\ast}$ 的集合方差，$\\sigma_{Y}^{2}$ 是 $Y$ 的集合方差。\n\n- 预测因子的观测估计值 $X_{o}$ 由一个带加性误差的线性测量模型给出，\n$$\nX_{o} \\;=\\; X^{\\ast} \\,+\\, \\eta,\n$$\n其中 $\\eta \\sim \\mathcal{N}(0, \\sigma_{\\eta}^{2})$ 是高斯测量误差，与 $X^{\\ast}$ 和 $Y$ 均独立。\n\n假设 $\\mu_{X}$、$\\mu_{Y}$、$\\sigma_{X}^{2}$、$\\sigma_{Y}^{2}$、$r$ 和 $\\sigma_{\\eta}^{2}$ 是表征模式集合和观测系统的已知常数，且 $X_{o}$ 是一个单一的观测值。\n\n从协方差、相关性的定义以及联合高斯随机变量在线性变换下的性质出发，推导后验均值 $\\mathbb{E}[Y \\mid X_{o}]$ 和后验方差 $\\operatorname{Var}(Y \\mid X_{o})$，作为 $r$、$\\sigma_{X}^{2}$、$\\sigma_{Y}^{2}$、$\\mu_{X}$、$\\mu_{Y}$、$\\sigma_{\\eta}^{2}$ 和 $X_{o}$ 的解析函数。以后验均值的单位为开尔文，后验方差的单位为平方开尔文来表示。最终答案必须是单一的闭式表达式，将后验均值和方差一起以行矩阵的形式列出。",
            "solution": "首先，对问题进行验证。\n\n### 步骤 1：提取已知条件\n- 潜在变量 $(X^{\\ast}, Y)$ 服从联合高斯分布。\n- 均值向量：$(\\mu_{X}, \\mu_{Y})$。\n- 协方差矩阵：\n$$\n\\begin{pmatrix}\n\\sigma_{X}^{2}  r\\,\\sigma_{X}\\sigma_{Y} \\\\\nr\\,\\sigma_{X}\\sigma_{Y}  \\sigma_{Y}^{2}\n\\end{pmatrix}\n$$\n- $Y$ 是平衡气候敏感度 (ECS)。\n- $X^{\\ast}$ 是一个潜在的真实预测因子。\n- $r$ 是 $X^{\\ast}$ 和 $Y$ 之间的集合相关性。\n- $\\sigma_{X}^{2}$ 是 $X^{\\ast}$ 的集合方差。\n- $\\sigma_{Y}^{2}$ 是 $Y$ 的集合方差。\n- 预测因子的观测估计值为 $X_{o}$。\n- 测量模型：$X_{o} = X^{\\ast} + \\eta$。\n- 测量误差 $\\eta \\sim \\mathcal{N}(0, \\sigma_{\\eta}^{2})$。\n- 误差 $\\eta$ 与 $X^{\\ast}$ 和 $Y$ 均独立。\n- $\\mu_{X}$, $\\mu_{Y}$, $\\sigma_{X}^{2}$, $\\sigma_{Y}^{2}$, $r$ 和 $\\sigma_{\\eta}^{2}$ 是已知常数。\n- $X_{o}$ 是一个单一的观测值。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题是多元统计学中的一个标准练习，具体涉及条件高斯分布的性质。\n- **科学依据：** 所描述的框架是对气候科学中使用的“涌现约束”分析的一个简化但概念上合理的表示。对此类问题，使用线性高斯模型是一种常见且有效的统计方法。\n- **适定性：** 该问题是适定的。鉴于所有底层随机变量（$X^{\\ast}$, $Y$, $\\eta$）都是高斯变量，它们的线性组合和联合分布也是高斯分布。联合高斯变量的一个子集在给定其他变量的情况下的条件分布是良定义的，并具有唯一的高斯形式。所有必需的参数和关系都已指定。\n- **客观性：** 问题以精确的数学语言陈述，没有任何歧义或主观性。\n\n### 步骤 3：结论和行动\n问题被判定为**有效**。将提供完整的解析解。\n\n目标是推导后验均值 $\\mathbb{E}[Y \\mid X_{o}]$ 和后验方差 $\\operatorname{Var}(Y \\mid X_{o})$。由于 $Y$ 是联合高斯向量 $(X^{\\ast}, Y)$ 的一个分量，而 $X_{o}$ 是 $X^{\\ast}$ 和另一个独立高斯变量 $\\eta$ 的线性函数，因此对 $(Y, X_{o})$ 也是联合高斯分布。因此，$Y$ 在给定 $X_{o}$ 的条件下的分布将是高斯分布，我们的任务是求出这个条件分布的均值和方差。\n\n我们首先确定 $(Y, X_{o})$ 联合分布的参数。这是一个由其均值向量和协方差矩阵表征的二元正态分布。\n\n均值向量为 $\\boldsymbol{\\mu} = (\\mathbb{E}[Y], \\mathbb{E}[X_{o}])^{T}$。\n其分量为：\n1.  $\\mathbb{E}[Y] = \\mu_{Y}$，这是已知的。\n2.  $\\mathbb{E}[X_{o}] = \\mathbb{E}[X^{\\ast} + \\eta]$。根据期望的线性性质，这等于 $\\mathbb{E}[X^{\\ast}] + \\mathbb{E}[\\eta]$。我们已知 $\\mathbb{E}[X^{\\ast}] = \\mu_{X}$ 和 $\\mathbb{E}[\\eta] = 0$。因此，$\\mathbb{E}[X_{o}] = \\mu_{X}$。\n\n所以，均值向量为 $\\begin{pmatrix} \\mu_{Y} \\\\ \\mu_{X} \\end{pmatrix}$。\n\n协方差矩阵为 $\\mathbf{\\Sigma} = \\begin{pmatrix} \\operatorname{Var}(Y)  \\operatorname{Cov}(Y, X_{o}) \\\\ \\operatorname{Cov}(Y, X_{o})  \\operatorname{Var}(X_{o}) \\end{pmatrix}$。\n我们来计算它的分量：\n1.  $\\operatorname{Var}(Y) = \\sigma_{Y}^{2}$，这是已知的。\n2.  $\\operatorname{Var}(X_{o}) = \\operatorname{Var}(X^{\\ast} + \\eta)$。由于 $X^{\\ast}$ 和 $\\eta$ 是独立的，它们的和的方差是它们方差的和：\n    $$\n    \\operatorname{Var}(X_{o}) = \\operatorname{Var}(X^{\\ast}) + \\operatorname{Var}(\\eta) = \\sigma_{X}^{2} + \\sigma_{\\eta}^{2}.\n    $$\n3.  $\\operatorname{Cov}(Y, X_{o}) = \\operatorname{Cov}(Y, X^{\\ast} + \\eta)$。根据协方差的双线性性：\n    $$\n    \\operatorname{Cov}(Y, X_{o}) = \\operatorname{Cov}(Y, X^{\\ast}) + \\operatorname{Cov}(Y, \\eta).\n    $$\n    根据问题设定，我们已知 $\\eta$ 与 $X^{\\ast}$ 和 $Y$ 均独立。因此，$\\operatorname{Cov}(Y, \\eta) = 0$。剩下：\n    $$\n    \\operatorname{Cov}(Y, X_{o}) = \\operatorname{Cov}(Y, X^{\\ast}).\n    $$\n    $X^{\\ast}$ 和 $Y$ 之间的协方差在协方差矩阵中给出为 $r\\sigma_{X}\\sigma_{Y}$。因此，$\\operatorname{Cov}(Y, X_{o}) = r\\sigma_{X}\\sigma_{Y}$。\n\n因此，$(Y, X_{o})$ 的联合分布是一个二元正态分布，其均值向量为 $\\begin{pmatrix} \\mu_{Y} \\\\ \\mu_{X} \\end{pmatrix}$，协方差矩阵为：\n$$\n\\mathbf{\\Sigma} = \\begin{pmatrix}\n\\sigma_{Y}^{2}  r\\sigma_{X}\\sigma_{Y} \\\\\nr\\sigma_{X}\\sigma_{Y}  \\sigma_{X}^{2} + \\sigma_{\\eta}^{2}\n\\end{pmatrix}.\n$$\n\n现在我们使用联合高斯变量条件分布的标准公式。如果 $(V_{1}, V_{2})$ 服从联合高斯分布，均值为 $(\\mu_{1}, \\mu_{2})$，协方差矩阵为 $\\begin{pmatrix} \\Sigma_{11}  \\Sigma_{12} \\\\ \\Sigma_{21}  \\Sigma_{22} \\end{pmatrix}$，那么给定 $V_{2} = v_{2}$ 时 $V_{1}$ 的条件分布是高斯分布，其参数为：\n-   条件均值：$\\mathbb{E}[V_{1} \\mid V_{2}=v_{2}] = \\mu_{1} + \\Sigma_{12}\\Sigma_{22}^{-1}(v_{2} - \\mu_{2})$\n-   条件方差：$\\operatorname{Var}(V_{1} \\mid V_{2}=v_{2}) = \\Sigma_{11} - \\Sigma_{12}\\Sigma_{22}^{-1}\\Sigma_{21}$\n\n我们进行以下替换：\n$V_{1} \\to Y$, $V_{2} \\to X_{o}$\n$\\mu_{1} \\to \\mu_{Y}$, $\\mu_{2} \\to \\mu_{X}$\n$v_{2} \\to X_{o}$（观测值）\n$\\Sigma_{11} \\to \\sigma_{Y}^{2}$\n$\\Sigma_{12} \\to r\\sigma_{X}\\sigma_{Y}$\n$\\Sigma_{21} \\to r\\sigma_{X}\\sigma_{Y}$\n$\\Sigma_{22} \\to \\sigma_{X}^{2} + \\sigma_{\\eta}^{2}$\n\n后验均值 $\\mathbb{E}[Y \\mid X_{o}]$ 为：\n$$\n\\mathbb{E}[Y \\mid X_{o}] = \\mu_{Y} + (r\\sigma_{X}\\sigma_{Y})(\\sigma_{X}^{2} + \\sigma_{\\eta}^{2})^{-1}(X_{o} - \\mu_{X})\n$$\n$$\n\\mathbb{E}[Y \\mid X_{o}] = \\mu_{Y} + \\frac{r\\sigma_{X}\\sigma_{Y}}{\\sigma_{X}^{2} + \\sigma_{\\eta}^{2}}(X_{o} - \\mu_{X}).\n$$\n物理上，$\\mu_Y$ 和 $\\sigma_Y$ 的单位是开尔文，所以这个后验均值的表达式的单位正确地计算为开尔文。\n\n后验方差 $\\operatorname{Var}(Y \\mid X_{o})$ 为：\n$$\n\\operatorname{Var}(Y \\mid X_{o}) = \\sigma_{Y}^{2} - (r\\sigma_{X}\\sigma_{Y})(\\sigma_{X}^{2} + \\sigma_{\\eta}^{2})^{-1}(r\\sigma_{X}\\sigma_{Y})\n$$\n$$\n\\operatorname{Var}(Y \\mid X_{o}) = \\sigma_{Y}^{2} - \\frac{(r\\sigma_{X}\\sigma_{Y})^{2}}{\\sigma_{X}^{2} + \\sigma_{\\eta}^{2}} = \\sigma_{Y}^{2} - \\frac{r^{2}\\sigma_{X}^{2}\\sigma_{Y}^{2}}{\\sigma_{X}^{2} + \\sigma_{\\eta}^{2}}\n$$\n提取公因式 $\\sigma_{Y}^{2}$：\n$$\n\\operatorname{Var}(Y \\mid X_{o}) = \\sigma_{Y}^{2} \\left( 1 - \\frac{r^{2}\\sigma_{X}^{2}}{\\sigma_{X}^{2} + \\sigma_{\\eta}^{2}} \\right).\n$$\n这个表达式表示在观测到 $X_o$ 后 $Y$ 的方差减少量。项 $\\frac{r^{2}\\sigma_{X}^{2}}{\\sigma_{X}^{2} + \\sigma_{\\eta}^{2}}$ 是 $Y$ 和 $X_o$ 之间相关系数的平方，因此方差的减少量与这个相关系数的平方成正比，这与预期相符。鉴于 $\\sigma_Y^2$ 的单位是平方开尔文，这个后验方差的表达式的单位正确地计算为平方开尔文。\n\n所需的两个量是后验均值和后验方差。它们在最终答案中以一个行矩阵的形式一起呈现。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\mu_{Y} + \\frac{r\\sigma_{X}\\sigma_{Y}}{\\sigma_{X}^{2} + \\sigma_{\\eta}^{2}}(X_{o} - \\mu_{X})  \\sigma_{Y}^{2} \\left( 1 - \\frac{r^{2}\\sigma_{X}^{2}}{\\sigma_{X}^{2} + \\sigma_{\\eta}^{2}} \\right) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在实践中，涌现约束通常是从数量有限的气候模型中得出的，这使得结果可能对单个数据点很敏感。本练习介绍了一些关键的诊断技术，通过计算“留一法”(leave-one-out)影响函数来评估线性约束的稳健性 。您将学习如何识别具有影响力的异常值和高杠杆点，这是批判性地评估任何基于回归的科学发现的一项至关重要的技能。",
            "id": "4035783",
            "problem": "考虑一个线性普通最小二乘法（OLS）涌现约束，该约束将预测变量 $x$（一个无量纲的可观测指标）与响应变量 $y$（单位为开尔文的平衡气候敏感度）在一组气候模式集合上联系起来。假设关系式为\n$$\ny_i = \\beta_0 + \\beta_1 x_i + \\varepsilon_i,\n$$\n其中 $\\varepsilon_i$ 是独立同分布的加性噪声，服从零均值和等方差的高斯分布，且 $x_i$ 没有误差。设设计矩阵为 $X \\in \\mathbb{R}^{n \\times p}$，其中 $p = 2$，第一列全为1，第二列为预测变量向量 $x$。OLS 估计量为\n$$\n\\hat{\\beta} = (X^\\top X)^{-1} X^\\top y,\n$$\n拟合值为 $\\hat{y} = X \\hat{\\beta}$。定义帽子矩阵\n$$\nH = X (X^\\top X)^{-1} X^\\top\n$$\n其对角线元素为 $h_i = H_{ii}$，残差为 $u_i = y_i - \\hat{y}_i$。在目标预测值 $x_\\star$ 处的涌现约束预测为\n$$\n\\hat{y}_\\star = \\hat{\\beta}_0 + \\hat{\\beta}_1 x_\\star.\n$$\n对于每个模式 $i$，考虑在移除第 $i$ 行后重新拟合回归得到的留一法（LOO）估计量 $\\hat{\\beta}_{(i)}$。系数的案例删除影响函数可以从 Sherman–Morrison 公式导出，得到\n$$\n\\hat{\\beta}_{(i)} = \\hat{\\beta} - (X^\\top X)^{-1} x_i \\frac{u_i}{1 - h_i},\n$$\n其中 $x_i = \\begin{bmatrix}1 \\\\ x_i\\end{bmatrix}$ 是包含截距项的设计矩阵的第 $i$ 行。在 $x_\\star$ 处对应的 LOO 预测为\n$$\n\\hat{y}_{\\star,(i)} = x_\\star^\\top \\hat{\\beta}_{(i)},\n$$\n其中 $x_\\star = \\begin{bmatrix}1 \\\\ x_\\star\\end{bmatrix}$。定义涌现约束对移除模式 $i$ 的敏感度为\n$$\n\\Delta_i = \\hat{y}_\\star - \\hat{y}_{\\star,(i)}.\n$$\n为识别潜在的离群点和高杠杆点，使用以下公式计算外部学生化残差\n$$\ns^2 = \\frac{\\sum_{j=1}^n u_j^2}{n - p}, \\quad s_{(i)}^2 = \\frac{\\sum_{j=1}^n u_j^2 - \\frac{u_i^2}{1 - h_i}}{n - p - 1}, \\quad t_i = \\frac{u_i}{\\sqrt{s_{(i)}^2} \\sqrt{1 - h_i}},\n$$\n并采用以下决策规则：\n- 离群点判据：$|t_i| > 2.0$。\n- 高杠杆点判据：$h_i > \\frac{2p}{n}$，其中 $p = 2$。\n\n您的任务是实现一个程序，对每个测试用例计算：\n1. 基准涌现约束预测值 $\\hat{y}_\\star$（单位：开尔文）。\n2. 使 $|\\Delta_i|$ 最大化的模式的索引（从零开始）。\n3. 最大绝对敏感度 $\\max_i |\\Delta_i|$（单位：开尔文）。\n4. 使用判据 $|t_i| > 2.0$ 分类为离群点的索引列表（从零开始）。\n5. 使用判据 $h_i > \\frac{2p}{n}$ 分类为高杠杆点的索引列表（从零开始）。\n\n所有模式索引均使用从零开始的编号。将所有气候敏感度值（上述第1项和第3项）以普通十进制数表示，单位为开尔文。不涉及角度。任何地方都不要使用百分号；如果需要比例，必须使用小数表示。\n\n测试套件：\n- 案例 A（均衡，中度离散）：$x = [0.1, 0.2, 0.3, 0.5, 0.7, 0.9, 1.1, 1.2]$，$y = [2.6, 2.62, 2.8, 2.93, 3.04, 3.23, 3.33, 3.5]$，$x_\\star = 0.6$。\n- 案例 B（$y$ 中有一个离群点）：$x = [0.1, 0.2, 0.3, 0.5, 0.7, 0.9, 1.1, 1.2]$，$y = [2.6, 2.62, 4.5, 2.93, 3.04, 3.23, 3.33, 3.5]$，$x_\\star = 0.6$。\n- 案例 C（$x$ 中有高杠杆点）：$x = [0.0, 0.2, 0.4, 0.6, 0.8, 1.0, 3.0, 3.2]$，$y = [2.48, 2.69, 2.83, 3.06, 3.22, 3.42, 5.16, 5.39]$，$x_\\star = 0.75$。\n\n您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表。对于每个测试用例，输出子列表\n$[\\hat{y}_\\star, i_{\\max}, \\max_i |\\Delta_i|, \\text{outlier\\_indices}, \\text{leverage\\_indices}]$，\n并将三个测试用例的结果聚合到一个顶层列表中。例如，输出格式必须类似于\n$[[\\dots], [\\dots], [\\dots]]$\n在同一行上，无额外文本。",
            "solution": "该问题要求实现一个标准的普通最小二乘法（OLS）回归分析，并辅以计量经济学和统计学中常见的特定诊断程序，以评估气候建模中的一个涌现约束。该分析必须针对三个不同的测试用例进行。\n\n问题的核心是拟合一个简单线性模型 $y_i = \\beta_0 + \\beta_1 x_i + \\varepsilon_i$，其中 $y_i$ 表示集合中第 $i$ 个模式的平衡气候敏感度，$x_i$ 是一个对应的可观测指标。参数 $\\beta_0$（截距）和 $\\beta_1$（斜率）是未知的，将根据所提供的数据 $(x_i, y_i)$（$i=1, \\dots, n$）进行估计。\n\n每个测试用例的总体流程如下：\n\n1.  **模型设定与 OLS 估计**：线性回归模型可以用矩阵形式表示为 $y = X \\beta + \\varepsilon$。对于带截距项的简单线性回归，设计矩阵 $X \\in \\mathbb{R}^{n \\times p}$ 有 $p=2$ 列。第一列是全为1的向量，第二列包含预测变量值 $x_i$。向量 $y \\in \\mathbb{R}^n$ 包含响应变量值 $y_i$。系数向量 $\\beta = [\\beta_0, \\beta_1]^\\top$ 的 OLS 估计量由正规方程给出：\n    $$\n    \\hat{\\beta} = (X^\\top X)^{-1} X^\\top y\n    $$\n    在高斯-马尔可夫假设（问题中已说明：零均值、等方差的非相关误差）下，这为 $\\beta_0$ 和 $\\beta_1$ 提供了最佳线性无偏估计。\n\n2.  **基准预测**：模型拟合后，可用于进行预测。涌现约束预测 $\\hat{y}_\\star$ 是针对给定的目标预测变量值 $x_\\star$ 预测的气候敏感度。这通过使用估计出的系数来计算：\n    $$\n    \\hat{y}_\\star = \\hat{\\beta}_0 + \\hat{\\beta}_1 x_\\star = x_\\star^\\top \\hat{\\beta}\n    $$\n    其中 $x_\\star$ 表示为向量 $x_\\star = [1, x_\\star]^\\top$。该值构成第一个要求的输出。\n\n3.  **影响与敏感度分析**：回归分析的一个关键方面是理解单个数据点如何影响结果。问题要求计算预测值 $\\hat{y}_\\star$ 对数据集中移除每个模式 $i$ 的敏感度。该敏感度用 $\\Delta_i$ 表示。\n    $$\n    \\Delta_i = \\hat{y}_\\star - \\hat{y}_{\\star,(i)}\n    $$\n    此处，$\\hat{y}_{\\star,(i)}$ 是排除第 $i$ 个数据点后重新拟合模型在 $x_\\star$ 处的预测值。问题提供了一个源自案例删除诊断法的高效公式，从而避免了进行 $n$ 次独立回归的需要：\n    $$\n    \\Delta_i = x_\\star^\\top (X^\\top X)^{-1} x_i \\frac{u_i}{1 - h_i}\n    $$\n    在此公式中，$u_i = y_i - \\hat{y}_i$ 是来自完整回归的第 $i$ 个观测值的残差，$h_i$ 是帽子矩阵 $H = X (X^\\top X)^{-1} X^\\top$ 的第 $i$ 个对角元素。量 $h_i$ 是观测值 $i$ 的杠杆值。我们需要找到使 $|\\Delta_i|$ 最大化的模式索引以及该最大敏感度的值。\n\n4.  **离群点与杠杆点检测**：为了系统地识别影响点，计算了两种标准诊断指标：\n    -   **高杠杆点**：杠杆值 $h_i$ 衡量了观测值 $i$ 基于其在预测变量空间中位置的潜在影响。$x_i$ 值远离 $x$ 值均值的点将具有高杠杆值。问题指定了一个用于识别高杠杆点的常用启发式规则：$h_i > \\frac{2p}{n}$，其中 $p=2$。要求提供所有满足此条件的索引列表。\n    -   **离群点**：离群点是具有大残差的点，表明它们不能被回归模型很好地解释。为了恰当地评估这一点，我们使用外部学生化残差 $t_i$。它们的计算公式为：\n        $$\n        t_i = \\frac{u_i}{\\sqrt{s_{(i)}^2} \\sqrt{1 - h_i}}\n        $$\n        其中 $s_{(i)}^2$ 是在不包含第 $i$ 个数据点的情况下进行回归拟合所得到的误差方差的估计值。在观测值 $i$ 不是离群点的原假设下，这使得分子和分母相互独立。问题陈述了离群点的决策规则是 $|t_i| > 2.0$。同样要求提供所有满足此条件的索引列表。\n\n实现过程将通过构建必要的矩阵来处理每个测试用例，计算 OLS 估计和预测，然后为所有数据点计算全套诊断指标（$\\Delta_i$，$t_i$，$h_i$）。每个案例的结果将汇总成指定的列表格式。所有数学运算都使用数值线性代数程序执行。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function that processes all test cases and prints the final result.\n    \"\"\"\n    test_cases = [\n        {\n            \"x\": [0.1, 0.2, 0.3, 0.5, 0.7, 0.9, 1.1, 1.2],\n            \"y\": [2.6, 2.62, 2.8, 2.93, 3.04, 3.23, 3.33, 3.5],\n            \"x_star\": 0.6\n        },\n        {\n            \"x\": [0.1, 0.2, 0.3, 0.5, 0.7, 0.9, 1.1, 1.2],\n            \"y\": [2.6, 2.62, 4.5, 2.93, 3.04, 3.23, 3.33, 3.5],\n            \"x_star\": 0.6\n        },\n        {\n            \"x\": [0.0, 0.2, 0.4, 0.6, 0.8, 1.0, 3.0, 3.2],\n            \"y\": [2.48, 2.69, 2.83, 3.06, 3.22, 3.42, 5.16, 5.39],\n            \"x_star\": 0.75\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = _process_case(case[\"x\"], case[\"y\"], case[\"x_star\"])\n        results.append(result)\n\n    # Convert the list of lists to the required string format.\n    # The default str() for a list includes spaces, which is standard.\n    # The primary requirement is the comma separation between sublists.\n    str_results = ','.join(map(str, results))\n    print(f\"[{str_results}]\")\n\ndef _process_case(x_data, y_data, x_star_val):\n    \"\"\"\n    Performs the OLS regression and diagnostics for a single test case.\n    \n    Args:\n        x_data (list): List of predictor values.\n        y_data (list): List of response values.\n        x_star_val (float): The target predictor value for prediction.\n\n    Returns:\n        list: A list containing the five required results for the case.\n    \"\"\"\n    x = np.array(x_data)\n    y = np.array(y_data)\n    n = len(x)\n    p = 2  # Simple linear regression (intercept + slope)\n\n    # 1. Setup Matrices\n    # Design matrix X with an intercept column\n    X = np.vstack([np.ones(n), x]).T\n    # Target predictor vector\n    x_star_vec = np.array([1.0, x_star_val])\n\n    # 2. OLS Regression\n    XTX = X.T @ X\n    XTX_inv = np.linalg.inv(XTX)\n    XTy = X.T @ y\n    beta_hat = XTX_inv @ XTy\n\n    # 3. Baseline Emergent Constraint Prediction (y_star)\n    y_star_hat = x_star_vec.T @ beta_hat\n\n    # 4. Calculate Diagnostics (Residuals and Leverages)\n    H = X @ XTX_inv @ X.T\n    h = np.diag(H)\n    y_hat = X @ beta_hat\n    u = y - y_hat\n\n    # 5. Calculate Sensitivity (Delta_i)\n    # Delta_i = x_star^T * (X^T*X)^-1 * x_i * u_i / (1 - h_i)\n    # We can pre-calculate the term v_i = x_star^T * (X^T*X)^-1 * x_i for all i\n    v = X @ XTX_inv @ x_star_vec\n    delta_i = v * u / (1 - h)\n    \n    abs_delta_i = np.abs(delta_i)\n    max_abs_delta = np.max(abs_delta_i)\n    i_max_delta = np.argmax(abs_delta_i)\n\n    # 6. Identify Outliers using Externally Studentized Residuals (t_i)\n    RSS = np.sum(u**2)\n    df_res = n - p\n    df_loo = n - p - 1\n\n    # s_i^2 = (RSS - u_i^2 / (1 - h_i)) / (n - p - 1)\n    s2_i = (RSS - u**2 / (1 - h)) / df_loo\n    \n    # Handle case where s2_i might be negative due to numerical precision\n    s_i = np.sqrt(np.maximum(0, s2_i))\n    \n    # t_i = u_i / (s_i * sqrt(1 - h_i))\n    # Add a small epsilon to the denominator to avoid division by zero if h_i=1\n    ti = u / (s_i * np.sqrt(1 - h) + 1e-15)\n\n    outlier_indices = [i for i, t_val in enumerate(ti) if abs(t_val) > 2.0]\n\n    # 7. Identify High Leverage Points\n    leverage_threshold = (2.0 * p) / n\n    leverage_indices = [i for i, h_val in enumerate(h) if h_val > leverage_threshold]\n\n    return [y_star_hat, int(i_max_delta), max_abs_delta, outlier_indices, leverage_indices]\n\nif __name__ == \"__main__\":\n    solve()\n\n```"
        }
    ]
}