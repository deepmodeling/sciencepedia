{
    "hands_on_practices": [
        {
            "introduction": "The land-surface is a critical component of the Earth system, mediating the exchange of energy, water, and carbon between the ground and the atmosphere. This exercise grounds your understanding in the fundamental principle of surface energy balance, which is governed by the First Law of Thermodynamics. By deriving the balance equation and applying it to observational data, you will practice a core skill in diagnosing how Earth System Models partition incoming solar radiation into sensible heat, latent heat, and ground heat fluxes, which collectively drive near-surface weather and climate .",
            "id": "4033905",
            "problem": "Consider a single land-surface grid cell in an Earth System Model (ESM) with interactive land, atmosphere, and soil components. The land surface exchanges energy with the atmosphere through turbulent sensible and latent heat fluxes, with the soil through conductive heat flux, and with space via shortwave and longwave radiation. Adopt the following sign conventions: net radiation is defined positive when there is a net radiative energy input to the surface, turbulent sensible and latent heat fluxes are defined positive when energy leaves the surface to the atmosphere, and ground heat flux is defined positive when energy leaves the surface into the soil. Let the radiative components be shortwave downwelling $S_{\\mathrm{d}}$, shortwave upwelling $S_{\\mathrm{u}}$, longwave downwelling $L_{\\mathrm{d}}$, and longwave upwelling $L_{\\mathrm{u}}$, and define the net radiation as $R_{n} = (S_{\\mathrm{d}} - S_{\\mathrm{u}}) + (L_{\\mathrm{d}} - L_{\\mathrm{u}})$. Assume quasi-steady midday conditions such that storage in the canopy air, biomass, and the thin surface skin layer is negligible over the averaging interval.\n\nTask:\n1. Starting from the First Law of Thermodynamics applied to a thin control volume enclosing the land-surface interface, and using the above sign conventions and definitions, derive the steady-state surface energy balance that relates net radiation to the non-radiative energy fluxes at the surface.\n2. An observational site collocated with this grid cell reports the following midday averages: net radiation $R_{n} = 547.2~\\mathrm{W}\\,\\mathrm{m}^{-2}$, sensible heat flux $H = 132.5~\\mathrm{W}\\,\\mathrm{m}^{-2}$, and latent heat flux $LE = 389.7~\\mathrm{W}\\,\\mathrm{m}^{-2}$. Using your derived balance, compute the ground heat flux $G$.\nExpress the final ground heat flux in $\\mathrm{W}\\,\\mathrm{m}^{-2}$ and round your answer to four significant figures.",
            "solution": "The problem is well-posed and scientifically grounded in the principles of thermodynamics and micrometeorology. It provides a complete set of definitions, sign conventions, and data necessary to derive the surface energy balance and compute the unknown flux. We may therefore proceed with the solution.\n\nThe problem consists of two parts. First, we must derive the steady-state surface energy balance equation. Second, we must apply this equation to compute the ground heat flux, $G$, from the provided observational data.\n\n**Part 1: Derivation of the Surface Energy Balance Equation**\n\nThe First Law of Thermodynamics, applied to a control volume, states that the rate of change of internal energy within the volume is equal to the net rate of energy transfer across its boundaries. For the infinitesimally thin control volume enclosing the land-surface interface, we can write this principle as:\n$$\n\\frac{dS}{dt} = \\sum F_{net}\n$$\nwhere $\\frac{dS}{dt}$ is the rate of change of energy stored in the control volume (in units of $\\mathrm{W}\\,\\mathrm{m}^{-2}$), and $\\sum F_{net}$ is the sum of all net energy fluxes into the control volume. The energy fluxes involved are the net radiation ($R_{n}$), a radiative term, and the non-radiative fluxes: the sensible heat flux ($H$), the latent heat flux ($LE$), and the ground heat flux ($G$).\n\nTo correctly formulate the balance, we must strictly adhere to the sign conventions provided in the problem statement. We will define a net flux as positive if it represents energy entering the control volume (the surface).\n\n1.  **Net Radiation ($R_{n}$):** The problem defines $R_{n}$ as a net radiative energy input to the surface. Therefore, a positive $R_{n}$ corresponds to a flux *into* the control volume. Its contribution to the net flux is $+R_{n}$. The definition is given as $R_{n} = (S_{\\mathrm{d}} - S_{\\mathrm{u}}) + (L_{\\mathrm{d}} - L_{\\mathrm{u}})$, where the terms are shortwave downwelling, shortwave upwelling, longwave downwelling, and longwave upwelling, respectively. This correctly represents the net radiative gain.\n\n2.  **Sensible Heat Flux ($H$):** The problem defines $H$ as positive when energy *leaves* the surface to the atmosphere. Therefore, its contribution to the net flux *into* the control volume is $-H$.\n\n3.  **Latent Heat Flux ($LE$):** Similar to $H$, $LE$ is defined as positive when energy *leaves* the surface to the atmosphere (due to evapotranspiration). Its contribution to the net flux *into* the control volume is $-LE$.\n\n4.  **Ground Heat Flux ($G$):** The ground heat flux $G$ is defined as positive when energy *leaves* the surface into the soil. Thus, its contribution to the net flux *into* the control volume is $-G$.\n\nSumming these contributions, the total net flux into the control volume is:\n$$\n\\sum F_{net} = R_{n} - H - LE - G\n$$\nSubstituting this into the energy balance equation gives:\n$$\n\\frac{dS}{dt} = R_{n} - H - LE - G\n$$\nThe problem specifies \"quasi-steady midday conditions\" and that energy \"storage in the canopy air, biomass, and the thin surface skin layer is negligible\". This is the steady-state assumption, which mathematically translates to the storage term being zero:\n$$\n\\frac{dS}{dt} = 0\n$$\nTherefore, the steady-state surface energy balance equation is:\n$$\n0 = R_{n} - H - LE - G\n$$\nThis equation is conventionally rearranged to express the balance between the net available energy ($R_n$) and the fluxes that dissipate this energy ($H$, $LE$, and $G$):\n$$\nR_{n} = H + LE + G\n$$\nThis is the required steady-state surface energy balance equation. It signifies that, under steady-state conditions, the net radiative energy supplied to the surface is perfectly balanced by the energy transported away from the surface into the atmosphere (as sensible and latent heat) and into the ground (as conducted heat).\n\n**Part 2: Computation of Ground Heat Flux**\n\nWe now use the derived equation to calculate the ground heat flux, $G$. Rearranging the equation to solve for $G$ yields:\n$$\nG = R_{n} - H - LE\n$$\nThe problem provides the following midday average values:\n- Net radiation: $R_{n} = 547.2~\\mathrm{W}\\,\\mathrm{m}^{-2}$\n- Sensible heat flux: $H = 132.5~\\mathrm{W}\\,\\mathrm{m}^{-2}$\n- Latent heat flux: $LE = 389.7~\\mathrm{W}\\,\\mathrm{m}^{-2}$\n\nSubstituting these values into the equation for $G$:\n$$\nG = 547.2 - 132.5 - 389.7\n$$\nPerforming the subtraction:\n$$\nG = 547.2 - (132.5 + 389.7)\n$$\n$$\nG = 547.2 - 522.2\n$$\n$$\nG = 25.0~\\mathrm{W}\\,\\mathrm{m}^{-2}\n$$\nThe calculated value for the ground heat flux is exactly $25.0~\\mathrm{W}\\,\\mathrm{m}^{-2}$. The positive sign indicates that, according to the specified convention, energy is leaving the surface and entering the soil, which is physically expected during midday.\n\nThe problem requires the final answer to be rounded to four significant figures. The calculated value $25.0$ has three significant figures. To express this number with four significant figures, we must add a trailing zero, yielding $25.00$. It is important to note that, according to standard rules for propagating precision in calculations, since all input values are given to one decimal place, the result of the subtraction is most properly reported to one decimal place ($25.0$). The instruction to use four significant figures is an explicit formatting requirement that we will adhere to, although it implies a level of precision not strictly supported by the input data.",
            "answer": "$$\\boxed{25.00}$$"
        },
        {
            "introduction": "A primary challenge in Earth System Modeling is ensuring that the coupled system conserves fundamental quantities like mass and energy over long integration periods. This practice explores the real-world problem of \"model drift,\" where small, persistent biases in individual model components can lead to unphysical long-term trends, such as a steady rise or fall in global sea level. By calculating a freshwater flux adjustment, you will engage with a classic technique used to maintain the stability of climate models, gaining insight into the practical difficulties of coupling complex, imperfect systems .",
            "id": "4033885",
            "problem": "Consider an interactive Earth System Model (ESM) in which the atmosphere, ocean, sea ice, and land hydrology components exchange freshwater. Let the global ocean volume budget follow conservation of mass: \n$$\\frac{dV_{o}}{dt} = \\int_{\\Omega} F_{\\mathrm{fw}}(t,\\mathbf{x})\\, dA,$$\nwhere $V_{o}$ is the total ocean volume, $\\Omega$ is the ocean surface domain, $A$ denotes area, and $F_{\\mathrm{fw}}$ is the net surface freshwater flux into the ocean. Adopting the sign convention where fluxes into the ocean are positive, the net flux is \n$$F_{\\mathrm{fw}} = P_{o} - E_{o} + R + M,$$\nwith $P_{o}$ precipitation onto the ocean, $E_{o}$ evaporation from the ocean, $R$ river discharge into the ocean, and $M$ the freshwater-equivalent melting/freezing flux from sea ice (positive for net melting). Due to coupled model biases, the annually averaged, globally integrated component-wise freshwater flux biases relative to a reference analysis are:\n$$\\delta P_{o} = +0.80 \\times 10^{12}\\ \\mathrm{m^{3}\\,yr^{-1}},\\quad \\delta E_{o} = +0.50 \\times 10^{12}\\ \\mathrm{m^{3}\\,yr^{-1}},$$\n$$\\delta R = -0.30 \\times 10^{12}\\ \\mathrm{m^{3}\\,yr^{-1}},\\quad \\delta M = +0.20 \\times 10^{12}\\ \\mathrm{m^{3}\\,yr^{-1}},$$\nwhere each $\\delta$ denotes the bias in the flux into the ocean (positive means the model puts more freshwater into the ocean than the reference, negative the opposite). The global ocean surface area is \n$$A_{o} = 3.61 \\times 10^{14}\\ \\mathrm{m^{2}}.$$\nTo enforce global freshwater budget closure without corrupting variability, a flux adjustment $\\phi$ is added uniformly in space and constant in time to the ocean surface freshwater flux. The adjustment must be chosen so that the time-mean of $\\frac{dV_{o}}{dt}$ is zero while leaving the time-varying anomalies of $F_{\\mathrm{fw}}$ unchanged.\n\nUsing conservation of mass and the given data, derive the required $\\phi$ and compute its value. Use $1$ year $=$ $365.25$ days. Express the final surface freshwater flux adjustment in $\\mathrm{m\\,s^{-1}}$ and round your answer to four significant figures.",
            "solution": "The problem is to determine the magnitude of a spatially uniform and temporally constant freshwater flux adjustment, denoted by $\\phi$, required to eliminate the long-term drift in the total ocean volume in an Earth System Model. The drift is caused by biases in the model's representation of freshwater fluxes.\n\nThe conservation of mass for the global ocean volume, $V_o$, is given by:\n$$\n\\frac{dV_{o}}{dt} = \\int_{\\Omega} F_{\\mathrm{fw}}(t,\\mathbf{x})\\, dA\n$$\nwhere $F_{\\mathrm{fw}}$ is the net surface freshwater flux into the ocean, and $\\Omega$ is the ocean surface domain with total area $A_o$. A flux adjustment $\\phi$ is added to $F_{\\mathrm{fw}}$, resulting in an adjusted flux $F_{\\mathrm{fw}}^{\\mathrm{adj}} = F_{\\mathrm{fw}} + \\phi$. The rate of change of ocean volume is then modified to:\n$$\n\\frac{dV_{o}^{\\mathrm{adj}}}{dt} = \\int_{\\Omega} (F_{\\mathrm{fw}}(t,\\mathbf{x}) + \\phi) \\, dA\n$$\nSince $\\phi$ is uniform in space and constant in time, we can separate the integral:\n$$\n\\frac{dV_{o}^{\\mathrm{adj}}}{dt} = \\int_{\\Omega} F_{\\mathrm{fw}}(t,\\mathbf{x})\\, dA + \\phi \\int_{\\Omega} dA = \\int_{\\Omega} F_{\\mathrm{fw}}(t,\\mathbf{x})\\, dA + \\phi A_{o}\n$$\nThe problem requires that the flux adjustment eliminates the long-term drift, which means the time-mean of the adjusted rate of volume change must be zero. Denoting the time-mean by $\\langle \\cdot \\rangle$:\n$$\n\\left\\langle \\frac{dV_{o}^{\\mathrm{adj}}}{dt} \\right\\rangle = 0\n$$\nApplying the time-mean operator to the equation for the adjusted volume change rate:\n$$\n\\left\\langle \\frac{dV_{o}^{\\mathrm{adj}}}{dt} \\right\\rangle = \\left\\langle \\int_{\\Omega} F_{\\mathrm{fw}}(t,\\mathbf{x})\\, dA \\right\\rangle + \\langle \\phi A_{o} \\rangle = 0\n$$\nSince $\\phi$ and $A_o$ are constants, $\\langle \\phi A_{o} \\rangle = \\phi A_{o}$. The first term, $\\langle \\int_{\\Omega} F_{\\mathrm{fw}}(t,\\mathbf{x})\\, dA \\rangle$, represents the time-mean of the total, globally integrated freshwater volume flux into the ocean. This is the source of the model drift and is caused by the sum of the biases in the individual flux components. Let us denote this total volume flux bias as $\\langle Q_{\\mathrm{bias}} \\rangle$. The condition for stability becomes:\n$$\n\\langle Q_{\\mathrm{bias}} \\rangle + \\phi A_{o} = 0\n$$\nThe problem provides the annually averaged, globally integrated component-wise freshwater flux biases, $\\delta X$. The wording \"`$\\delta$` denotes the bias in the flux into the ocean\" implies that these values represent the net contribution of each component's bias to the total flux *into* the ocean. Therefore, the total volume flux bias is the algebraic sum of these components.\n$$\n\\langle Q_{\\mathrm{bias}} \\rangle = \\delta P_{o} + \\delta E_{o} + \\delta R + \\delta M\n$$\nThe sign convention is such that a positive value for $\\delta X$ signifies that the model flux component $X$ contributes more freshwater to the ocean than the reference, regardless of whether the physical process is inherently an input (like precipitation) or an output (like evaporation).\n\nSubstituting the given values:\n$\\delta P_{o} = +0.80 \\times 10^{12}\\ \\mathrm{m^{3}\\,yr^{-1}}$\n$\\delta E_{o} = +0.50 \\times 10^{12}\\ \\mathrm{m^{3}\\,yr^{-1}}$\n$\\delta R = -0.30 \\times 10^{12}\\ \\mathrm{m^{3}\\,yr^{-1}}$\n$\\delta M = +0.20 \\times 10^{12}\\ \\mathrm{m^{3}\\,yr^{-1}}$\n\nThe total volume flux bias is:\n$$\n\\langle Q_{\\mathrm{bias}} \\rangle = (0.80 + 0.50 - 0.30 + 0.20) \\times 10^{12}\\ \\mathrm{m^{3}\\,yr^{-1}}\n$$\n$$\n\\langle Q_{\\mathrm{bias}} \\rangle = (1.50 - 0.30) \\times 10^{12}\\ \\mathrm{m^{3}\\,yr^{-1}} = 1.20 \\times 10^{12}\\ \\mathrm{m^{3}\\,yr^{-1}}\n$$\nThis positive value indicates a net spurious gain of water by the model ocean. The flux adjustment $\\phi$ must introduce a flux that removes this excess water. From the stability condition, we solve for $\\phi$:\n$$\n\\phi = - \\frac{\\langle Q_{\\mathrm{bias}} \\rangle}{A_{o}}\n$$\nWe are given the global ocean surface area $A_{o} = 3.61 \\times 10^{14}\\ \\mathrm{m^{2}}$. Substituting the values:\n$$\n\\phi = - \\frac{1.20 \\times 10^{12}\\ \\mathrm{m^{3}\\,yr^{-1}}}{3.61 \\times 10^{14}\\ \\mathrm{m^{2}}} \\approx -0.0033241\\ \\mathrm{m\\,yr^{-1}}\n$$\nThe problem requires the answer in units of $\\mathrm{m\\,s^{-1}}$. We must perform a unit conversion for time, using $1 \\ \\text{year} = 365.25 \\ \\text{days}$.\nThe number of seconds in one year is:\n$$\n1\\ \\mathrm{yr} = 365.25\\ \\mathrm{days} \\times 24\\ \\mathrm{hr\\,day^{-1}} \\times 3600\\ \\mathrm{s\\,hr^{-1}} = 31,557,600\\ \\mathrm{s}\n$$\nNow, we convert $\\phi$ from $\\mathrm{m\\,yr^{-1}}$ to $\\mathrm{m\\,s^{-1}}$:\n$$\n\\phi = - \\frac{1.20 \\times 10^{12}\\ \\mathrm{m^{3}}}{3.61 \\times 10^{14}\\ \\mathrm{m^{2}}} \\times \\frac{1}{31,557,600\\ \\mathrm{s}}\n$$\n$$\n\\phi = - \\frac{1.20 \\times 10^{12}}{3.61 \\times 10^{14} \\times 3.15576 \\times 10^{7}}\\ \\mathrm{m\\,s^{-1}}\n$$\n$$\n\\phi = - \\frac{1.20}{3.61 \\times 3.15576 \\times 10^{9}}\\ \\mathrm{m\\,s^{-1}}\n$$\n$$\n\\phi = - \\frac{1.20}{11.3922936 \\times 10^{9}}\\ \\mathrm{m\\,s^{-1}}\n$$\n$$\n\\phi \\approx -0.105334 \\times 10^{-9}\\ \\mathrm{m\\,s^{-1}} = -1.05334 \\times 10^{-10}\\ \\mathrm{m\\,s^{-1}}\n$$\nRounding the result to four significant figures, we get:\n$$\n\\phi \\approx -1.053 \\times 10^{-10}\\ \\mathrm{m\\,s^{-1}}\n$$\nThis negative sign indicates that the corrective flux must be directed out of the ocean, which is consistent with countering a positive bias (a spurious net input of freshwater).",
            "answer": "$$\n\\boxed{-1.053 \\times 10^{-10}}\n$$"
        },
        {
            "introduction": "Modern Earth System Models are among the most computationally demanding applications, requiring massive High-Performance Computing (HPC) resources to simulate climate. The overall efficiency of a coupled model simulation is often limited by the slowest component, making optimal resource allocation a critical task. This exercise places you in the role of a computational climate scientist, using performance models to solve a load-balancing problem and improve the parallel efficiency of a coupled system, a crucial skill for maximizing scientific output on modern supercomputers .",
            "id": "4033933",
            "problem": "Consider a two-way coupled Earth system model with interactive atmosphere and ocean components, run on a distributed-memory High Performance Computing (HPC) system using the Message Passing Interface (MPI). Each component uses a block-structured domain decomposition over its grid, and the coupled model advances in synchronous timesteps with a coupling exchange at the end of each step. The atmosphere and ocean components execute concurrently, and the timestep wall-clock time is determined by the slower component because of the synchronization implied by the coupling exchange.\n\nYou are given the following data for a representative timestep under an initial processor allocation. The atmosphere uses $P_{a}^{0} = 1280$ MPI ranks and the ocean uses $P_{o}^{0} = 768$ MPI ranks, with $P = P_{a}^{0} + P_{o}^{0} = 2048$ total ranks. Measured per-rank compute times (exclusive of coupling wait) for this timestep are summarized by the rank-mean and rank-maximum within each component:\n- Atmosphere: $\\bar{t}_{a} = 0.50$ s, $t_{a}^{\\max} = 0.56$ s.\n- Ocean: $\\bar{t}_{o} = 0.68$ s, $t_{o}^{\\max} = 0.74$ s.\n\nAssume the component timestep wall-clock times, as functions of their rank allocations, can be modeled by well-tested performance scaling forms that capture a parallelizable compute term, a non-parallelizable base term, and a communication overhead that grows logarithmically with rank count due to collective operations:\n$$\nT_{a}(P_{a}) = \\frac{\\alpha_{a}}{P_{a}} + \\beta_{a} + \\gamma_{a} \\ln(P_{a}), \\quad\nT_{o}(P_{o}) = \\frac{\\alpha_{o}}{P_{o}} + \\beta_{o} + \\gamma_{o} \\ln(P_{o}),\n$$\nwith constants $\\alpha_{a} = 300$ s, $\\beta_{a} = 0.18$ s, $\\gamma_{a} = 0.015$ s, and $\\alpha_{o} = 360$ s, $\\beta_{o} = 0.12$ s, $\\gamma_{o} = 0.020$ s. Here $\\ln(\\cdot)$ is the natural logarithm. For the coupled timestep, the wall-clock time is $T_{\\text{step}}(P_{a},P_{o}) = \\max\\{T_{a}(P_{a}), T_{o}(P_{o})\\}$ under the constraint $P_{a} + P_{o} = P$.\n\nTasks:\n- Using first-principles definitions of load imbalance, compute the component-level load imbalance metrics $L_{a}$ and $L_{o}$ for the given measurements under the initial allocation.\n- Based on first-principles reasoning about barrier synchronization and the given performance models, design a processor allocation strategy to improve parallel efficiency across components under the fixed total-rank constraint $P = 2048$. Then determine the optimal integer allocation $(P_{a}^{*}, P_{o}^{*})$ that minimizes the coupled timestep wall-clock time $T_{\\text{step}}$, and compute this minimal coupled timestep wall-clock time.\n\nRound your final numerical answer to four significant figures, and express the final wall-clock time in seconds. Only report the minimal coupled timestep wall-clock time as your final answer.",
            "solution": "The problem is valid. It presents a well-posed optimization problem grounded in the principles of high-performance computing and performance modeling for coupled Earth system models. All data, models, and constraints are provided, are scientifically and numerically consistent, and are free of ambiguity or contradiction.\n\nThe problem requires a two-part solution: first, to compute the load imbalance for the initial configuration based on measured data, and second, to find the optimal processor allocation that minimizes the coupled timestep wall-clock time using the provided performance models.\n\nFirst, we compute the component-level load imbalance metrics, $L_{a}$ and $L_{o}$. The load imbalance $L$ is defined as the ratio of the maximum execution time to the average execution time over a set of parallel ranks. Using the provided mean ($\\bar{t}$) and maximum ($t^{\\max}$) per-rank compute times:\n\nFor the atmosphere component:\n$$L_{a} = \\frac{t_{a}^{\\max}}{\\bar{t}_{a}} = \\frac{0.56 \\, \\text{s}}{0.50 \\, \\text{s}} = 1.12$$\n\nFor the ocean component:\n$$L_{o} = \\frac{t_{o}^{\\max}}{\\bar{t}_{o}} = \\frac{0.74 \\, \\text{s}}{0.68 \\, \\text{s}} \\approx 1.0882$$\nThese metrics quantify the degree of work imbalance *within* each component under the initial allocation of $P_{a}^{0} = 1280$ and $P_{o}^{0} = 768$ ranks.\n\nNext, we address the optimization of the processor allocation between the two components. The total number of MPI ranks is fixed at $P = 2048$. Let $P_{a}$ be the number of ranks allocated to the atmosphere and $P_{o}$ be the number for the ocean, such that $P_{a} + P_{o} = P = 2048$. The wall-clock time for the coupled timestep is given by $T_{\\text{step}}(P_{a}, P_{o}) = \\max\\{T_{a}(P_{a}), T_{o}(P_{o})\\}$.\n\nThe strategy to minimize $T_{\\text{step}}$ is to balance the execution times of the two components. An imbalance between $T_{a}$ and $T_{o}$ means one component sits idle waiting for the other, which is an inefficient use of resources. The minimum of $\\max\\{f(x), g(x)\\}$ is typically achieved when $f(x) \\approx g(x)$. Therefore, we seek an allocation $(P_{a}^{*}, P_{o}^{*})$ where the modeled times are equal:\n$$T_{a}(P_{a}) = T_{o}(P_{o})$$\nSubstituting the constraint $P_{o} = 2048 - P_{a}$ and the given performance models, we get the equation:\n$$\\frac{\\alpha_{a}}{P_{a}} + \\beta_{a} + \\gamma_{a} \\ln(P_{a}) = \\frac{\\alpha_{o}}{2048 - P_{a}} + \\beta_{o} + \\gamma_{o} \\ln(2048 - P_{a})$$\nPlugging in the provided constants:\n$$\\frac{300}{P_{a}} + 0.18 + 0.015 \\ln(P_{a}) = \\frac{360}{2048 - P_{a}} + 0.12 + 0.020 \\ln(2048 - P_{a})$$\nThis is a transcendental equation for $P_{a}$ which must be solved numerically. Let's define a function $f(P_a) = T_{a}(P_{a}) - T_{o}(2048 - P_{a})$ and find its root.\n$$f(P_a) = \\left(\\frac{300}{P_{a}} + 0.18 + 0.015 \\ln(P_{a})\\right) - \\left(\\frac{360}{2048 - P_{a}} + 0.12 + 0.020 \\ln(2048 - P_{a})\\right)$$\nThe derivative of $T_{a}(P_a)$ with respect to $P_a$ is negative for $P_a < \\alpha_a/\\gamma_a = 20000$, and the derivative of $T_{o}(2048-P_a)$ with respect to $P_a$ is positive for $2048-P_a < \\alpha_o/\\gamma_o = 18000$. Both conditions hold in our domain of $1 \\le P_a \\le 2047$. Therefore, $f(P_a)$ is a monotonically decreasing function, guaranteeing a unique root.\n\nThe number of ranks $P_{a}$ and $P_{o}$ must be integers. The optimal integer allocation will be one of the two pairs of integers bracketing the continuous solution to $f(P_a) = 0$. We can find the interval containing the root by testing integer values of $P_a$.\n\nLet's test $P_{a}=968$:\n$P_{o} = 2048 - 968 = 1080$.\n$T_{a}(968) = \\frac{300}{968} + 0.18 + 0.015 \\ln(968) \\approx 0.309917 + 0.18 + 0.015(6.87523) \\approx 0.593046 \\, \\text{s}$.\n$T_{o}(1080) = \\frac{360}{1080} + 0.12 + 0.020 \\ln(1080) \\approx 0.333333 + 0.12 + 0.020(6.98472) \\approx 0.593028 \\, \\text{s}$.\nFor this allocation, $T_{\\text{step}} = \\max\\{0.593046, 0.593028\\} \\approx 0.593046 \\, \\text{s}$. Note that $f(968) = T_a(968) - T_o(1080) > 0$.\n\nLet's test the next integer, $P_{a}=969$:\n$P_{o} = 2048 - 969 = 1079$.\n$T_{a}(969) = \\frac{300}{969} + 0.18 + 0.015 \\ln(969) \\approx 0.309598 + 0.18 + 0.015(6.87626) \\approx 0.592741 \\, \\text{s}$.\n$T_{o}(1079) = \\frac{360}{1079} + 0.12 + 0.020 \\ln(1079) \\approx 0.333642 + 0.12 + 0.020(6.98379) \\approx 0.593318 \\, \\text{s}$.\nFor this allocation, $T_{\\text{step}} = \\max\\{0.592741, 0.593318\\} \\approx 0.593318 \\, \\text{s}$. Note that $f(969) = T_a(969) - T_o(1079) < 0$.\n\nThe continuous root for $P_a$ lies between $968$ and $969$. We must compare the coupled timestep times for these two integer allocations to find the minimum.\n- For $(P_{a}, P_{o}) = (968, 1080)$, $T_{\\text{step}} \\approx 0.593046 \\, \\text{s}$.\n- For $(P_{a}, P_{o}) = (969, 1079)$, $T_{\\text{step}} \\approx 0.593318 \\, \\text{s}$.\n\nComparing the two outcomes, $0.593046 \\, \\text{s} < 0.593318 \\, \\text{s}$.\nThe optimal integer allocation is therefore $(P_{a}^{*}, P_{o}^{*}) = (968, 1080)$, which yields the minimal coupled timestep wall-clock time.\n\nThe minimal time is approximately $0.593046 \\, \\text{s}$. Rounding to four significant figures as required, we obtain $0.5930 \\, \\text{s}$.",
            "answer": "$$\\boxed{0.5930}$$"
        }
    ]
}