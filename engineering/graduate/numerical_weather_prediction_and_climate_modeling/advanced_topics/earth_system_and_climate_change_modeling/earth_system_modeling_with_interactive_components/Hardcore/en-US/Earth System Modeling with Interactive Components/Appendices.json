{
    "hands_on_practices": [
        {
            "introduction": "The principle of energy conservation is the bedrock of physical climate modeling. In an Earth System Model, this principle is most tangibly expressed in the surface energy balance, which governs the partitioning of incoming solar radiation into heat that warms the air, evaporates water, and warms the ground. This exercise  challenges you to derive this fundamental balance from the First Law of Thermodynamics and apply it to observational data, providing a foundational understanding of how land and atmosphere components interact.",
            "id": "4033905",
            "problem": "Consider a single land-surface grid cell in an Earth System Model (ESM) with interactive land, atmosphere, and soil components. The land surface exchanges energy with the atmosphere through turbulent sensible and latent heat fluxes, with the soil through conductive heat flux, and with space via shortwave and longwave radiation. Adopt the following sign conventions: net radiation is defined positive when there is a net radiative energy input to the surface, turbulent sensible and latent heat fluxes are defined positive when energy leaves the surface to the atmosphere, and ground heat flux is defined positive when energy leaves the surface into the soil. Let the radiative components be shortwave downwelling $S_{\\mathrm{d}}$, shortwave upwelling $S_{\\mathrm{u}}$, longwave downwelling $L_{\\mathrm{d}}$, and longwave upwelling $L_{\\mathrm{u}}$, and define the net radiation as $R_{n} = (S_{\\mathrm{d}} - S_{\\mathrm{u}}) + (L_{\\mathrm{d}} - L_{\\mathrm{u}})$. Assume quasi-steady midday conditions such that storage in the canopy air, biomass, and the thin surface skin layer is negligible over the averaging interval.\n\nTask:\n1. Starting from the First Law of Thermodynamics applied to a thin control volume enclosing the land-surface interface, and using the above sign conventions and definitions, derive the steady-state surface energy balance that relates net radiation to the non-radiative energy fluxes at the surface.\n2. An observational site collocated with this grid cell reports the following midday averages: net radiation $R_{n} = 547.2~\\mathrm{W}\\,\\mathrm{m}^{-2}$, sensible heat flux $H = 132.5~\\mathrm{W}\\,\\mathrm{m}^{-2}$, and latent heat flux $LE = 389.7~\\mathrm{W}\\,\\mathrm{m}^{-2}$. Using your derived balance, compute the ground heat flux $G$.\nExpress the final ground heat flux in $\\mathrm{W}\\,\\mathrm{m}^{-2}$ and round your answer to four significant figures.",
            "solution": "The problem is well-posed and scientifically grounded in the principles of thermodynamics and micrometeorology. It provides a complete set of definitions, sign conventions, and data necessary to derive the surface energy balance and compute the unknown flux. We may therefore proceed with the solution.\n\nThe problem consists of two parts. First, we must derive the steady-state surface energy balance equation. Second, we must apply this equation to compute the ground heat flux, $G$, from the provided observational data.\n\n**Part 1: Derivation of the Surface Energy Balance Equation**\n\nThe First Law of Thermodynamics, applied to a control volume, states that the rate of change of internal energy within the volume is equal to the net rate of energy transfer across its boundaries. For the infinitesimally thin control volume enclosing the land-surface interface, we can write this principle as:\n$$\n\\frac{dS}{dt} = \\sum F_{net}\n$$\nwhere $\\frac{dS}{dt}$ is the rate of change of energy stored in the control volume (in units of $\\mathrm{W}\\,\\mathrm{m}^{-2}$), and $\\sum F_{net}$ is the sum of all net energy fluxes into the control volume. The energy fluxes involved are the net radiation ($R_{n}$), a radiative term, and the non-radiative fluxes: the sensible heat flux ($H$), the latent heat flux ($LE$), and the ground heat flux ($G$).\n\nTo correctly formulate the balance, we must strictly adhere to the sign conventions provided in the problem statement. We will define a net flux as positive if it represents energy entering the control volume (the surface).\n\n1.  **Net Radiation ($R_{n}$):** The problem defines $R_{n}$ as a net radiative energy input to the surface. Therefore, a positive $R_{n}$ corresponds to a flux *into* the control volume. Its contribution to the net flux is $+R_{n}$. The definition is given as $R_{n} = (S_{\\mathrm{d}} - S_{\\mathrm{u}}) + (L_{\\mathrm{d}} - L_{\\mathrm{u}})$, where the terms are shortwave downwelling, shortwave upwelling, longwave downwelling, and longwave upwelling, respectively. This correctly represents the net radiative gain.\n\n2.  **Sensible Heat Flux ($H$):** The problem defines $H$ as positive when energy *leaves* the surface to the atmosphere. Therefore, its contribution to the net flux *into* the control volume is $-H$.\n\n3.  **Latent Heat Flux ($LE$):** Similar to $H$, $LE$ is defined as positive when energy *leaves* the surface to the atmosphere (due to evapotranspiration). Its contribution to the net flux *into* the control volume is $-LE$.\n\n4.  **Ground Heat Flux ($G$):** The ground heat flux $G$ is defined as positive when energy *leaves* the surface into the soil. Thus, its contribution to the net flux *into* the control volume is $-G$.\n\nSumming these contributions, the total net flux into the control volume is:\n$$\n\\sum F_{net} = R_{n} - H - LE - G\n$$\nSubstituting this into the energy balance equation gives:\n$$\n\\frac{dS}{dt} = R_{n} - H - LE - G\n$$\nThe problem specifies \"quasi-steady midday conditions\" and that energy \"storage in the canopy air, biomass, and the thin surface skin layer is negligible\". This is the steady-state assumption, which mathematically translates to the storage term being zero:\n$$\n\\frac{dS}{dt} = 0\n$$\nTherefore, the steady-state surface energy balance equation is:\n$$\n0 = R_{n} - H - LE - G\n$$\nThis equation is conventionally rearranged to express the balance between the net available energy ($R_n$) and the fluxes that dissipate this energy ($H$, $LE$, and $G$):\n$$\nR_{n} = H + LE + G\n$$\nThis is the required steady-state surface energy balance equation. It signifies that, under steady-state conditions, the net radiative energy supplied to the surface is perfectly balanced by the energy transported away from the surface into the atmosphere (as sensible and latent heat) and into the ground (as conducted heat).\n\n**Part 2: Computation of Ground Heat Flux**\n\nWe now use the derived equation to calculate the ground heat flux, $G$. Rearranging the equation to solve for $G$ yields:\n$$\nG = R_{n} - H - LE\n$$\nThe problem provides the following midday average values:\n- Net radiation: $R_{n} = 547.2~\\mathrm{W}\\,\\mathrm{m}^{-2}$\n- Sensible heat flux: $H = 132.5~\\mathrm{W}\\,\\mathrm{m}^{-2}$\n- Latent heat flux: $LE = 389.7~\\mathrm{W}\\,\\mathrm{m}^{-2}$\n\nSubstituting these values into the equation for $G$:\n$$\nG = 547.2 - 132.5 - 389.7\n$$\nPerforming the subtraction:\n$$\nG = 547.2 - (132.5 + 389.7)\n$$\n$$\nG = 547.2 - 522.2\n$$\n$$\nG = 25.0~\\mathrm{W}\\,\\mathrm{m}^{-2}\n$$\nThe calculated value for the ground heat flux is exactly $25.0~\\mathrm{W}\\,\\mathrm{m}^{-2}$. The positive sign indicates that, according to the specified convention, energy is leaving the surface and entering the soil, which is physically expected during midday.\n\nThe problem requires the final answer to be rounded to four significant figures. The calculated value $25.0$ has three significant figures. To express this number with four significant figures, we must add a trailing zero, yielding $25.00$. It is important to note that, according to standard rules for propagating precision in calculations, since all input values are given to one decimal place, the result of the subtraction is most properly reported to one decimal place ($25.0$). The instruction to use four significant figures is an explicit formatting requirement that we will adhere to, although it implies a level of precision not strictly supported by the input data.",
            "answer": "$$\\boxed{25.00}$$"
        },
        {
            "introduction": "Transitioning from continuous physical laws to discrete numerical algorithms is a core task in ESM development, and it comes with its own set of challenges, such as maintaining physical realism. This practice  delves into the numerical engine of a model to address the transport of tracers. You will implement a key concept from Flux-Corrected Transport (FCT) to ensure that a tracer's concentration never becomes physically nonsensical (i.e., negative), a crucial step for the stability and credibility of any simulation.",
            "id": "4033902",
            "problem": "Consider a one-dimensional finite-volume advection of a passive chemical tracer in an Earth system model with interactive components. The tracer concentration is denoted by the cell-averaged value $Q_i^n$ in cell $i$ at time level $n$. The governing conservation law is the advection equation $\\partial_t Q + \\partial_x (u Q) = 0$, where $u$ is the velocity. A low-order upwind step is first performed to produce a positivity-preserving intermediate state, followed by a high-order remapping step that produces high-order interfacial fluxes. A Flux-Corrected Transport (FCT) step is then applied to limit the antidiffusive fluxes so that nonnegativity is enforced while maintaining global conservation.\n\nYou are given a uniform grid with cell width $\\Delta x = 20000$ $\\mathrm{m}$ and a time step $\\Delta t = 600$ $\\mathrm{s}$. Focus on the central cell $i=2$, with initial tracer concentration $Q_2^n = 0.05$ $\\mathrm{kg}\\,\\mathrm{m}^{-3}$. The interfacial velocities are $u_{1.5} = -10$ $\\mathrm{m}\\,\\mathrm{s}^{-1}$ at the left face between cells $i=1$ and $i=2$, and $u_{2.5} = +20$ $\\mathrm{m}\\,\\mathrm{s}^{-1}$ at the right face between cells $i=2$ and $i=3$. The low-order upwind interfacial fluxes per unit area are\n$F^{L}_{1.5} = u_{1.5} Q_2^n = -0.5$ $\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$ and $F^{L}_{2.5} = u_{2.5} Q_2^n = 1.0$ $\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$.\nThe high-order remap yields interfacial fluxes\n$F^{H}_{1.5} = -0.8$ $\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$ and $F^{H}_{2.5} = 1.6$ $\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$.\n\nAssume the lower bound on the tracer concentration is $Q_{\\min} = 0$ and there is no upper bound. Starting from the advection conservation law and the finite-volume update, derive the positivity constraint for cell $i=2$ after adding antidiffusive fluxes. Compute the single scalar limiter coefficient $\\alpha_2 \\in [0,1]$ that must be applied uniformly to the outgoing antidiffusive fluxes at faces $x_{1.5}$ and $x_{2.5}$ of cell $i=2$ to enforce $Q_2^{n+1} \\ge 0$ while maintaining global conservation across these faces.\n\nExpress your final answer for $\\alpha_2$ as a dimensionless number rounded to four significant figures.",
            "solution": "The analysis of the problem proceeds from the fundamental principles of finite-volume methods for conservation laws, specifically focusing on the Flux-Corrected Transport (FCT) methodology for enforcing positivity in an advection scheme.\n\nFirst, we begin with the semi-discrete form of the one-dimensional conservation law for the cell-averaged tracer concentration $Q_i$ in cell $i$ of width $\\Delta x$:\n$$ \\frac{dQ_i}{dt} = - \\frac{1}{\\Delta x} (F_{i+1/2} - F_{i-1/2}) $$\nwhere $F_{i \\pm 1/2}$ are the fluxes at the cell interfaces. Using a forward Euler time-stepping scheme with a time step $\\Delta t$, the fully discrete update is:\n$$ Q_i^{n+1} = Q_i^n - \\frac{\\Delta t}{\\Delta x} (F_{i+1/2} - F_{i-1/2}) $$\n\nThe FCT method involves a sequence of steps. First, a low-order, positivity-preserving update is computed to obtain an intermediate state $Q_i^L$:\n$$ Q_i^L = Q_i^n - \\frac{\\Delta t}{\\Delta x} (F^L_{i+1/2} - F^L_{i-1/2}) $$\nwhere $F^L$ are the low-order fluxes.\nNext, antidiffusive fluxes, $A_{i \\pm 1/2}$, are defined as the difference between high-order fluxes $F^H$ and low-order fluxes $F^L$:\n$$ A_{i \\pm 1/2} = F^H_{i \\pm 1/2} - F^L_{i \\pm 1/2} $$\nThe final update is performed by adding a limited or corrected version of the antidiffusive fluxes, $A^C$, to the low-order solution:\n$$ Q_i^{n+1} = Q_i^L - \\frac{\\Delta t}{\\Delta x} (A^C_{i+1/2} - A^C_{i-1/2}) $$\nThis formulation ensures that the final scheme is conservative.\n\nWe are tasked with finding the limiter $\\alpha_2$ for cell $i=2$ to ensure positivity, i.e., $Q_2^{n+1} \\ge Q_{\\min}$. The given lower bound is $Q_{\\min} = 0$. Thus, we must satisfy:\n$$ Q_2^{n+1} \\ge 0 $$\nSubstituting the FCT update equation for cell $i=2$:\n$$ Q_2^L - \\frac{\\Delta t}{\\Delta x} (A^C_{2.5} - A^C_{1.5}) \\ge 0 $$\n\nThe problem states that a single scalar limiter coefficient $\\alpha_2$ is applied uniformly to the outgoing antidiffusive fluxes from cell $2$. We must first identify these outgoing fluxes. An antidiffusive flux $A_f$ at face $f$ is considered outgoing from a cell if it acts to transport mass out of that cell.\n- At face $x_{2.5}$, the velocity is $u_{2.5} = 20 \\, \\mathrm{m\\,s^{-1}} > 0$, so flow is from cell $2$ to cell $3$. An antidiffusive flux is outgoing if it is positive.\n- At face $x_{1.5}$, the velocity is $u_{1.5} = -10 \\, \\mathrm{m\\,s^{-1}} < 0$, so flow is from cell $2$ to cell $1$. An antidiffusive flux is outgoing if it is negative (representing leftward transport).\n\nLet's compute the raw antidiffusive fluxes using the given values:\n$F^L_{1.5} = -0.5 \\, \\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$\n$F^L_{2.5} = 1.0 \\, \\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$\n$F^H_{1.5} = -0.8 \\, \\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$\n$F^H_{2.5} = 1.6 \\, \\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$\n\n$$ A_{1.5} = F^H_{1.5} - F^L_{1.5} = -0.8 - (-0.5) = -0.3 \\, \\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1} $$\n$$ A_{2.5} = F^H_{2.5} - F^L_{2.5} = 1.6 - 1.0 = 0.6 \\, \\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1} $$\nSince $A_{1.5} < 0$ and $u_{1.5} < 0$, $A_{1.5}$ is an outgoing flux from cell $2$.\nSince $A_{2.5} > 0$ and $u_{2.5} > 0$, $A_{2.5}$ is also an outgoing flux from cell $2$.\nTherefore, the limiter $\\alpha_2$ applies to both $A_{1.5}$ and $A_{2.5}$. The corrected antidiffusive fluxes are:\n$$ A^C_{1.5} = \\alpha_2 A_{1.5} $$\n$$ A^C_{2.5} = \\alpha_2 A_{2.5} $$\nSubstituting these into the positivity constraint:\n$$ Q_2^L - \\frac{\\Delta t}{\\Delta x} (\\alpha_2 A_{2.5} - \\alpha_2 A_{1.5}) \\ge 0 $$\n$$ Q_2^L \\ge \\alpha_2 \\frac{\\Delta t}{\\Delta x} (A_{2.5} - A_{1.5}) $$\nThis inequality gives an upper bound on $\\alpha_2$. The problem asks for the coefficient that must be applied to enforce the condition, which corresponds to the maximum permissible value of $\\alpha_2$ that just satisfies the constraint.\n$$ \\alpha_2 \\le \\frac{Q_2^L}{\\frac{\\Delta t}{\\Delta x} (A_{2.5} - A_{1.5})} $$\nTo proceed, we must compute the value of the low-order state $Q_2^L$.\nGiven: $Q_2^n = 0.05 \\, \\mathrm{kg}\\,\\mathrm{m}^{-3}$, $\\Delta x = 20000 \\, \\mathrm{m}$, $\\Delta t = 600 \\, \\mathrm{s}$.\nThe ratio $\\frac{\\Delta t}{\\Delta x} = \\frac{600}{20000} = 0.03 \\, \\mathrm{s}\\,\\mathrm{m}^{-1}$.\n$$ Q_2^L = Q_2^n - \\frac{\\Delta t}{\\Delta x} (F^L_{2.5} - F^L_{1.5}) = 0.05 - 0.03 \\times (1.0 - (-0.5)) $$\n$$ Q_2^L = 0.05 - 0.03 \\times 1.5 = 0.05 - 0.045 = 0.005 \\, \\mathrm{kg}\\,\\mathrm{m}^{-3} $$\nThis is the total concentration available in cell $2$ that can be removed by antidiffusive fluxes without causing an undershoot below $Q_{\\min}=0$.\nThe total concentration that would be removed by the unlimited antidiffusive fluxes is:\n$$ \\frac{\\Delta t}{\\Delta x} (A_{2.5} - A_{1.5}) = 0.03 \\times (0.6 - (-0.3)) = 0.03 \\times 0.9 = 0.027 \\, \\mathrm{kg}\\,\\mathrm{m}^{-3} $$\nNow we can solve for $\\alpha_2$:\n$$ \\alpha_2 = \\frac{Q_2^L}{\\frac{\\Delta t}{\\Delta x} (A_{2.5} - A_{1.5})} = \\frac{0.005}{0.027} = \\frac{5}{27} $$\nThe numerical value is:\n$$ \\alpha_2 \\approx 0.185185... $$\nRounding to four significant figures as requested, we get $\\alpha_2 = 0.1852$. This value lies in the required range $[0, 1]$. It represents the largest fraction of the outgoing antidiffusive fluxes that can be applied to cell $2$ without violating the local positivity constraint.",
            "answer": "$$ \\boxed{0.1852} $$"
        },
        {
            "introduction": "The complexity of Earth System Models requires the immense power of High-Performance Computing (HPC), but harnessing this power efficiently is a major challenge. Since an ESM is a collection of distinct component models (e.g., atmosphere, ocean) that must synchronize, the overall speed is limited by the slowest component in any given timestep. This final practice  places you in the role of a computational scientist, tasked with optimizing the allocation of processors between components to minimize the total wall-clock time and maximize scientific throughput.",
            "id": "4033933",
            "problem": "Consider a two-way coupled Earth system model with interactive atmosphere and ocean components, run on a distributed-memory High Performance Computing (HPC) system using the Message Passing Interface (MPI). Each component uses a block-structured domain decomposition over its grid, and the coupled model advances in synchronous timesteps with a coupling exchange at the end of each step. The atmosphere and ocean components execute concurrently, and the timestep wall-clock time is determined by the slower component because of the synchronization implied by the coupling exchange.\n\nYou are given the following data for a representative timestep under an initial processor allocation. The atmosphere uses $P_{a}^{0} = 1280$ MPI ranks and the ocean uses $P_{o}^{0} = 768$ MPI ranks, with $P = P_{a}^{0} + P_{o}^{0} = 2048$ total ranks. Measured per-rank compute times (exclusive of coupling wait) for this timestep are summarized by the rank-mean and rank-maximum within each component:\n- Atmosphere: $\\bar{t}_{a} = 0.50$ s, $t_{a}^{\\max} = 0.56$ s.\n- Ocean: $\\bar{t}_{o} = 0.68$ s, $t_{o}^{\\max} = 0.74$ s.\n\nAssume the component timestep wall-clock times, as functions of their rank allocations, can be modeled by well-tested performance scaling forms that capture a parallelizable compute term, a non-parallelizable base term, and a communication overhead that grows logarithmically with rank count due to collective operations:\n$$\nT_{a}(P_{a}) = \\frac{\\alpha_{a}}{P_{a}} + \\beta_{a} + \\gamma_{a} \\ln(P_{a}), \\quad\nT_{o}(P_{o}) = \\frac{\\alpha_{o}}{P_{o}} + \\beta_{o} + \\gamma_{o} \\ln(P_{o}),\n$$\nwith constants $\\alpha_{a} = 300$ s, $\\beta_{a} = 0.18$ s, $\\gamma_{a} = 0.015$ s, and $\\alpha_{o} = 360$ s, $\\beta_{o} = 0.12$ s, $\\gamma_{o} = 0.020$ s. Here $\\ln(\\cdot)$ is the natural logarithm. For the coupled timestep, the wall-clock time is $T_{\\text{step}}(P_{a},P_{o}) = \\max\\{T_{a}(P_{a}), T_{o}(P_{o})\\}$ under the constraint $P_{a} + P_{o} = P$.\n\nTasks:\n- Using first-principles definitions of load imbalance, compute the component-level load imbalance metrics $L_{a}$ and $L_{o}$ for the given measurements under the initial allocation.\n- Based on first-principles reasoning about barrier synchronization and the given performance models, design a processor allocation strategy to improve parallel efficiency across components under the fixed total-rank constraint $P = 2048$. Then determine the optimal integer allocation $(P_{a}^{*}, P_{o}^{*})$ that minimizes the coupled timestep wall-clock time $T_{\\text{step}}$, and compute this minimal coupled timestep wall-clock time.\n\nRound your final numerical answer to four significant figures, and express the final wall-clock time in seconds. Only report the minimal coupled timestep wall-clock time as your final answer.",
            "solution": "The problem is valid. It presents a well-posed optimization problem grounded in the principles of high-performance computing and performance modeling for coupled Earth system models. All data, models, and constraints are provided, are scientifically and numerically consistent, and are free of ambiguity or contradiction.\n\nThe problem requires a two-part solution: first, to compute the load imbalance for the initial configuration based on measured data, and second, to find the optimal processor allocation that minimizes the coupled timestep wall-clock time using the provided performance models.\n\nFirst, we compute the component-level load imbalance metrics, $L_{a}$ and $L_{o}$. The load imbalance $L$ is defined as the ratio of the maximum execution time to the average execution time over a set of parallel ranks. Using the provided mean ($\\bar{t}$) and maximum ($t^{\\max}$) per-rank compute times:\n\nFor the atmosphere component:\n$$L_{a} = \\frac{t_{a}^{\\max}}{\\bar{t}_{a}} = \\frac{0.56 \\, \\mathrm{s}}{0.50 \\, \\mathrm{s}} = 1.12$$\n\nFor the ocean component:\n$$L_{o} = \\frac{t_{o}^{\\max}}{\\bar{t}_{o}} = \\frac{0.74 \\, \\mathrm{s}}{0.68 \\, \\mathrm{s}} \\approx 1.0882$$\nThese metrics quantify the degree of work imbalance *within* each component under the initial allocation of $P_{a}^{0} = 1280$ and $P_{o}^{0} = 768$ ranks.\n\nNext, we address the optimization of the processor allocation between the two components. The total number of MPI ranks is fixed at $P = 2048$. Let $P_{a}$ be the number of ranks allocated to the atmosphere and $P_{o}$ be the number for the ocean, such that $P_{a} + P_{o} = P = 2048$. The wall-clock time for the coupled timestep is given by $T_{\\text{step}}(P_{a}, P_{o}) = \\max\\{T_{a}(P_{a}), T_{o}(P_{o})\\}$.\n\nThe strategy to minimize $T_{\\text{step}}$ is to balance the execution times of the two components. An imbalance between $T_{a}$ and $T_{o}$ means one component sits idle waiting for the other, which is an inefficient use of resources. The minimum of $\\max\\{f(x), g(x)\\}$ is typically achieved when $f(x) \\approx g(x)$. Therefore, we seek an allocation $(P_{a}^{*}, P_{o}^{*})$ where the modeled times are equal:\n$$T_{a}(P_{a}) = T_{o}(P_{o})$$\nSubstituting the constraint $P_{o} = 2048 - P_{a}$ and the given performance models, we get the equation:\n$$\\frac{\\alpha_{a}}{P_{a}} + \\beta_{a} + \\gamma_{a} \\ln(P_{a}) = \\frac{\\alpha_{o}}{2048 - P_{a}} + \\beta_{o} + \\gamma_{o} \\ln(2048 - P_{a})$$\nPlugging in the provided constants:\n$$\\frac{300}{P_{a}} + 0.18 + 0.015 \\ln(P_{a}) = \\frac{360}{2048 - P_{a}} + 0.12 + 0.020 \\ln(2048 - P_{a})$$\nThis is a transcendental equation for $P_{a}$ which must be solved numerically. Let's define a function $f(P_a) = T_{a}(P_{a}) - T_{o}(2048 - P_{a})$ and find its root.\n$$f(P_a) = \\left(\\frac{300}{P_{a}} + 0.18 + 0.015 \\ln(P_{a})\\right) - \\left(\\frac{360}{2048 - P_{a}} + 0.12 + 0.020 \\ln(2048 - P_{a})\\right)$$\nThe derivative of $T_{a}(P_a)$ with respect to $P_a$ is negative for $P_a < \\alpha_a/\\gamma_a = 20000$, and the derivative of $T_{o}(2048-P_a)$ with respect to $P_a$ is positive for $2048-P_a < \\alpha_o/\\gamma_o = 18000$. Both conditions hold in our domain of $1 \\le P_a \\le 2047$. Therefore, $f(P_a)$ is a monotonically decreasing function, guaranteeing a unique root.\n\nThe number of ranks $P_{a}$ and $P_{o}$ must be integers. The optimal integer allocation will be one of the two pairs of integers bracketing the continuous solution to $f(P_a) = 0$. We can find the interval containing the root by testing integer values of $P_a$.\n\nLet's test $P_{a}=968$:\n$P_{o} = 2048 - 968 = 1080$.\n$T_{a}(968) = \\frac{300}{968} + 0.18 + 0.015 \\ln(968) \\approx 0.309917 + 0.18 + 0.015(6.87523) \\approx 0.593046 \\, \\mathrm{s}$.\n$T_{o}(1080) = \\frac{360}{1080} + 0.12 + 0.020 \\ln(1080) \\approx 0.333333 + 0.12 + 0.020(6.98472) \\approx 0.593028 \\, \\mathrm{s}$.\nFor this allocation, $T_{\\text{step}} = \\max\\{0.593046, 0.593028\\} \\approx 0.593046 \\, \\mathrm{s}$. Note that $f(968) = T_a(968) - T_o(1080) > 0$.\n\nLet's test the next integer, $P_{a}=969$:\n$P_{o} = 2048 - 969 = 1079$.\n$T_{a}(969) = \\frac{300}{969} + 0.18 + 0.015 \\ln(969) \\approx 0.309598 + 0.18 + 0.015(6.87626) \\approx 0.592741 \\, \\mathrm{s}$.\n$T_{o}(1079) = \\frac{360}{1079} + 0.12 + 0.020 \\ln(1079) \\approx 0.333642 + 0.12 + 0.020(6.98379) \\approx 0.593318 \\, \\mathrm{s}$.\nFor this allocation, $T_{\\text{step}} = \\max\\{0.592741, 0.593318\\} \\approx 0.593318 \\, \\mathrm{s}$. Note that $f(969) = T_a(969) - T_o(1079) < 0$.\n\nThe continuous root for $P_a$ lies between $968$ and $969$. We must compare the coupled timestep times for these two integer allocations to find the minimum.\n- For $(P_{a}, P_{o}) = (968, 1080)$, $T_{\\text{step}} \\approx 0.593046 \\, \\mathrm{s}$.\n- For $(P_{a}, P_{o}) = (969, 1079)$, $T_{\\text{step}} \\approx 0.593318 \\, \\mathrm{s}$.\n\nComparing the two outcomes, $0.593046 \\, \\mathrm{s}  0.593318 \\, \\mathrm{s}$.\nThe optimal integer allocation is therefore $(P_{a}^{*}, P_{o}^{*}) = (968, 1080)$, which yields the minimal coupled timestep wall-clock time.\n\nThe minimal time is approximately $0.593046 \\, \\mathrm{s}$. Rounding to four significant figures as required, we obtain $0.5930 \\, \\mathrm{s}$.",
            "answer": "$$\\boxed{0.5930}$$"
        }
    ]
}