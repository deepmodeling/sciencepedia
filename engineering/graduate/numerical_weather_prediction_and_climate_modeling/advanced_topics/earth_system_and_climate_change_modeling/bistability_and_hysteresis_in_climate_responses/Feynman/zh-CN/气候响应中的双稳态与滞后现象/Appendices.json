{
    "hands_on_practices": [
        {
            "introduction": "能量平衡模型（Energy Balance Models, EBMs）是理解基本气候动力学的强大工具。本练习旨在通过一个包含非线性水汽反馈的零维能量平衡模型，来揭示气候系统多重稳定态的起源 。通过数值方法求解平衡点并分析其稳定性，您将亲手验证强正反馈机制如何导致在相同外部强迫下可能出现多个稳定的气候状态，这是理解气候突变和临界点的第一步。",
            "id": "4017395",
            "problem": "考虑一个基于大气层顶能量守恒的零维全球平均能量平衡模型。进入气候系统的净能量通量，记为 $N(T)$，控制着全球平均地表温度异常 $T$ 的时间变化趋势。温度异常 $T$ 是相对于一个以开尔文为单位的固定基线温度 $T_b$ 定义的。其时间演化遵循 $C \\, dT/dt = N(T)$，其中 $C$ 是气候系统的有效热容。\n\n辐射响应的基本依据是斯蒂芬-玻尔兹曼定律，该定律指出出射长波辐射 (OLR) 与 $\\sigma \\, \\Theta^4$ 成比例，其中 $\\sigma$ 是斯蒂芬-玻尔兹曼常数，$\\Theta$ 是以开尔文为单位的绝对温度。因此，由温度异常 $T$ 引起的 OLR 相对于基线 $T_b$ 的变化为 $\\sigma \\left[(T_b + T)^4 - T_b^4\\right]$。\n\n我们引入两类反馈：\n- 一个恒定的线性反馈 $-\\lambda_0 T$，代表总的非水汽辐射阻尼（例如，在所考虑的范围内近似为线性的递减率或云反馈）。\n- 一个依赖于温度的水汽反馈，参数化为 $\\lambda_{\\text{wv}}(T) = \\lambda_1 \\exp(\\gamma T)$，单位为瓦特每平方米每开尔文。作为一种微分反馈，它在温度异常 $T$ 上的累积效应对净通量的影响是积分 $\\int_{0}^{T} \\lambda_{\\text{wv}}(\\tau) \\, d\\tau = (\\lambda_1/\\gamma)\\left[\\exp(\\gamma T) - 1\\right]$，这会减小有效辐射阻尼（即，它为 $N(T)$ 增加了一个正项，因为水汽是增温的正反馈）。\n\n我们包含一个外部施加的辐射强迫 $F$（例如，由二氧化碳变化引起），其单位为瓦特每平方米，并视为一个常数。结合这些要素，净能量通量函数定义为\n$$\nN(T) = F - \\sigma\\left[(T_b + T)^4 - T_b^4\\right] - \\lambda_0 T + \\frac{\\lambda_1}{\\gamma}\\left[\\exp(\\gamma T) - 1\\right].\n$$\n\n平衡态（不动点）是任何满足 $N(T^\\ast) = 0$ 的 $T^\\ast$。绝对平衡温度为 $T_{\\text{eq}} = T_b + T^\\ast$，单位为开尔文。平衡态的线性稳定性由线性化增长率 $\\left.\\frac{dN}{dT}\\right|_{T^\\ast}$ 的符号决定：如果 $\\left.\\frac{dN}{dT}\\right|_{T^\\ast}  0$，则平衡态是稳定的；如果 $\\left.\\frac{dN}{dT}\\right|_{T^\\ast} > 0$，则是不稳定的。由上述 $N(T)$ 推导出的导数为\n$$\n\\frac{dN}{dT} = -4\\sigma (T_b + T)^3 - \\lambda_0 + \\lambda_1 \\exp(\\gamma T).\n$$\n\n任务：\n- 对于下面测试套件中的每一组参数，在搜索区间 $T \\in [T_{\\min}, T_{\\max}]$ 内计算所有满足 $N(T^\\ast) = 0$ 的平衡态异常 $T^\\ast$，其中 $T_{\\min}$ 和 $T_{\\max}$ 对每个案例均已给出。\n- 通过评估 $\\left.\\frac{dN}{dT}\\right|_{T^\\ast}$ 的符号来对每个平衡态的稳定性进行分类。\n- 报告以开尔文为单位的绝对平衡温度 $T_{\\text{eq}} = T_b + T^\\ast$，四舍五入到三位小数。\n- 确定参数集是否表现出双稳态，这里定义为在搜索区间内至少有两个不同的稳定平衡态。\n- 确定参数集是否在搜索区间内恰好有三个不动点，且其中恰好有两个是稳定的。\n\n单位：\n- 温度必须以开尔文报告。\n- 通量和反馈参数的单位是瓦特每平方米 ($\\mathrm{W\\, m^{-2}}$)。\n- 指数斜率 $\\gamma$ 的单位是逆开尔文 ($\\mathrm{K^{-1}}$)。\n\n测试套件规格：\n每个测试案例是一个元组 $(F, T_b, \\lambda_0, \\lambda_1, \\gamma, T_{\\min}, T_{\\max})$，其值如下：\n1. $(4.0, 288.0, 1.0, 4.0, 0.12, -10.0, 25.0)$\n2. $(4.0, 288.0, 1.5, 1.5, 0.08, -10.0, 25.0)$\n3. $(8.0, 288.0, 0.5, 5.0, 0.20, -10.0, 25.0)$\n4. $(2.0, 288.0, 1.2, 3.2, 0.11, -10.0, 25.0)$\n\n最终输出格式：\n您的程序应生成单行输出，按顺序包含每个测试案例的结构化摘要，包含以下字段：\n- 找到的平衡态的整数数量。\n- 一个包含以开尔文为单位的绝对平衡温度的列表，每个温度四舍五入到三位小数。\n- 一个布尔值列表，按与温度相同的顺序列出每个平衡态的稳定性（True 表示稳定，False 表示不稳定）。\n- 一个布尔值，指示该案例是否为双稳态。\n- 一个布尔值，指示该案例是否恰好有三个不动点且其中恰好有两个是稳定的。\n\n将所有测试案例的摘要聚合到一个列表中，并以单行形式打印，例如：\n\"[[num, [T1,T2,...], [s1,s2,...], bistable, triple_two_stable], [...], ...]\".",
            "solution": "用户提供了一个有效、适定（well-posed）的问题，该问题基于气候科学和动力系统理论的原理。任务是寻找并分析一个零维能量平衡模型的平衡态。\n\n系统的状态由相对于基线温度 $T_b$ 的全球平均地表温度异常 $T$ 来描述。$T$ 的演化由一阶常微分方程 $C \\, dT/dt = N(T)$ 控制，其中 $C$ 是系统的热容，$N(T)$ 是大气层顶的净能量通量。\n\n净能量通量函数 $N(T)$ 由下式给出：\n$$\nN(T) = F - \\sigma\\left[(T_b + T)^4 - T_b^4\\right] - \\lambda_0 T + \\frac{\\lambda_1}{\\gamma}\\left[\\exp(\\gamma T) - 1\\right]\n$$\n其中：\n- $F$ 是一个恒定的外部辐射强迫。\n- 项 $\\sigma\\left[(T_b + T)^4 - T_b^4\\right]$ 代表基于斯蒂芬-玻尔兹曼定律的出射长波辐射 (OLR) 的变化，其中 $\\sigma$ 是斯蒂芬-玻尔兹曼常数。\n- 项 $-\\lambda_0 T$ 是一个线性反馈，代表各种阻尼过程。\n- 项 $\\frac{\\lambda_1}{\\gamma}\\left[\\exp(\\gamma T) - 1\\right]$ 代表非线性水汽反馈的积分效应，其作用是减小辐射阻尼（即一个正反馈）。\n\n系统的平衡态或不动点 $T^\\ast$ 是指系统不随时间变化的温度，即 $dT/dt = 0$。这要求净能量通量为零：\n$$\nN(T^\\ast) = 0\n$$\n由于这是一个包含 $T$ 的多项式和指数项的超越方程，其根 $T^\\ast$ 必须使用数值方法求解。\n\n平衡态 $T^\\ast$ 的稳定性由系统对小扰动的响应决定。对于一个由 $dT/dt \\propto N(T)$ 控制的系统，其稳定性由 $N(T)$ 在平衡点处的导数 $\\left.\\frac{dN}{dT}\\right|_{T^\\ast}$ 的符号决定。该导数由下式给出：\n$$\n\\frac{dN}{dT} = -4\\sigma (T_b + T)^3 - \\lambda_0 + \\lambda_1 \\exp(\\gamma T)\n$$\n- 如果 $\\left.\\frac{dN}{dT}\\right|_{T^\\ast}  0$，一个小的正向扰动会使 $N(T)$ 为负，导致 $T$ 减小并回到 $T^\\ast$。类似地，一个负向扰动会导致 $T$ 增加。因此，该平衡态是 **稳定的**。\n- 如果 $\\left.\\frac{dN}{dT}\\right|_{T^\\ast} > 0$，一个小扰动会被放大，导致 $T$ 进一步偏离 $T^\\ast$。因此，该平衡态是 **不稳定的**。\n- $\\left.\\frac{dN}{dT}\\right|_{T^\\ast} = 0$ 的情况对应于一个分岔点，这种线性稳定性分析无法对其进行分类。\n\n解决每个参数集问题的计算策略如下：\n1.  **定义搜索网格**：在指定的搜索区间 $[T_{\\min}, T_{\\max}]$ 上为温度异常 $T$ 定义一个密集的点网格。\n2.  **确定根的区间**：在网格的每个点上计算函数 $N(T)$ 的值。如果在两个连续的网格点（例如 $T_i$ 和 $T_{i+1}$）之间，$N(T)$ 的符号发生变化，则表明在 $(T_i, T_{i+1})$ 区间内存在一个根 $T^\\ast$。这对点构成了根的一个“括号”区间。\n3.  **求解根**：对于每个确定的括号区间，采用一个稳健的数值求根算法，特别是 `scipy.optimize.brentq`，来找到满足 $N(T^\\ast)=0$ 的根 $T^\\ast$ 的精确值。\n4.  **分析平衡态**：对于找到的每个唯一的根 $T^\\ast$：\n    a. 计算绝对平衡温度 $T_{\\text{eq}} = T_b + T^\\ast$。\n    b. 通过计算 $\\frac{dN}{dT}$ 在 $T^\\ast$ 处的符号来评估稳定性。\n5.  **描述系统行为**：\n    a. 统计平衡态的总数和稳定平衡态的数量。\n    b. 确定系统是否是双稳态的（即至少有2个稳定平衡态）。\n    c. 确定系统是否恰好有3个不动点，其中恰好有2个是稳定的。\n6.  **格式化输出**：将每个测试案例的结果编译成指定的列表结构并打印。\n\n此数值过程将用 Python 实现，利用 `numpy` 库进行高效的数组计算，并利用 `scipy` 库实现求根算法和获取物理常数 $\\sigma$ 的值。绝对温度将按要求四舍五入到三位小数。",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\nfrom scipy.constants import sigma\n\ndef solve():\n    \"\"\"\n    Main function to solve the climate model problem for all test cases.\n    It defines helper functions for the model equations and the solution logic.\n    \"\"\"\n\n    def N_flux(T, F, Tb, lambda0, lambda1, gamma):\n        \"\"\"\n        Calculates the net energy flux N(T) for a given temperature anomaly T.\n\n        Args:\n            T (float or np.ndarray): Temperature anomaly in Kelvin.\n            F (float): Radiative forcing in W/m^2.\n            Tb (float): Baseline temperature in Kelvin.\n            lambda0 (float): Linear feedback parameter in W/m^2/K.\n            lambda1 (float): Water vapor feedback magnitude parameter in W/m^2/K.\n            gamma (float): Water vapor feedback exponential parameter in 1/K.\n\n        Returns:\n            float or np.ndarray: Net energy flux N(T) in W/m^2.\n        \"\"\"\n        term_olr = sigma * ((Tb + T)**4 - Tb**4)\n        term_lin_feedback = lambda0 * T\n        term_wv_feedback = (lambda1 / gamma) * (np.exp(gamma * T) - 1.0)\n        \n        return F - term_olr - term_lin_feedback + term_wv_feedback\n\n    def dN_dT(T, Tb, lambda0, lambda1, gamma):\n        \"\"\"\n        Calculates the derivative of the net energy flux, dN/dT.\n\n        Args:\n            T (float or np.ndarray): Temperature anomaly in Kelvin.\n            Tb (float): Baseline temperature in Kelvin.\n            lambda0 (float): Linear feedback parameter in W/m^2/K.\n            lambda1 (float): Water vapor feedback magnitude parameter in W/m^2/K.\n            gamma (float): Water vapor feedback exponential parameter in 1/K.\n\n        Returns:\n            float or np.ndarray: Derivative of net energy flux in W/m^2/K.\n        \"\"\"\n        term_olr_deriv = -4.0 * sigma * (Tb + T)**3\n        term_lin_deriv = -lambda0\n        term_wv_deriv = lambda1 * np.exp(gamma * T)\n        \n        return term_olr_deriv + term_lin_deriv + term_wv_deriv\n\n    def find_and_analyze_equilibria(params):\n        \"\"\"\n        Finds and analyzes equilibria for a given parameter set.\n        \n        Args:\n            params (tuple): A tuple containing (F, Tb, lambda0, lambda1, gamma, T_min, T_max).\n            \n        Returns:\n            list: A list containing the number of equilibria, a list of absolute equilibrium\n                  temperatures, a list of their stabilities, a boolean for bistability, and\n                  a boolean for the triple-point/two-stable case.\n        \"\"\"\n        F, Tb, lambda0, lambda1, gamma, T_min, T_max = params\n        \n        # Create a fine grid to search for root brackets.\n        num_points = 4000\n        T_grid = np.linspace(T_min, T_max, num_points)\n        N_values = N_flux(T_grid, F, Tb, lambda0, lambda1, gamma)\n        \n        roots = []\n        # Find brackets where the sign of N(T) changes, indicating a root.\n        for i in range(num_points - 1):\n            if np.sign(N_values[i]) != np.sign(N_values[i+1]):\n                try:\n                    root = brentq(\n                        lambda t: N_flux(t, F, Tb, lambda0, lambda1, gamma),\n                        T_grid[i], T_grid[i+1]\n                    )\n                    roots.append(root)\n                except ValueError:\n                    # This handles rare cases where brentq might fail.\n                    continue\n\n        if not roots:\n            return [0, [], [], False, False]\n        \n        # Sort roots and remove duplicates that might arise from adjacent brackets.\n        unique_roots = []\n        sorted_roots = sorted(roots)\n        unique_roots.append(sorted_roots[0])\n        for i in range(1, len(sorted_roots)):\n            if not np.isclose(sorted_roots[i], sorted_roots[i-1]):\n                unique_roots.append(sorted_roots[i])\n\n        abs_temps = []\n        stabilities = []\n        \n        for T_star in unique_roots:\n            T_eq = Tb + T_star\n            abs_temps.append(round(T_eq, 3))\n            \n            stability_derivative = dN_dT(T_star, Tb, lambda0, lambda1, gamma)\n            stabilities.append(stability_derivative  0)\n            \n        num_equilibria = len(unique_roots)\n        num_stable = sum(stabilities)\n        \n        is_bistable = num_stable >= 2\n        is_triple_two_stable = (num_equilibria == 3) and (num_stable == 2)\n        \n        return [num_equilibria, abs_temps, stabilities, is_bistable, is_triple_two_stable]\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (4.0, 288.0, 1.0, 4.0, 0.12, -10.0, 25.0),\n        (4.0, 288.0, 1.5, 1.5, 0.08, -10.0, 25.0),\n        (8.0, 288.0, 0.5, 5.0, 0.20, -10.0, 25.0),\n        (2.0, 288.0, 1.2, 3.2, 0.11, -10.0, 25.0)\n    ]\n\n    results = []\n    for case in test_cases:\n        result = find_and_analyze_equilibria(case)\n        results.append(result)\n\n    # The final print statement produces the single-line format specified.\n    # The str() conversion of the inner lists and the join method together\n    # correctly construct the final output string.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "当我们认识到气候系统可能存在多个稳定状态后，一个自然而然的问题是：系统在不同状态之间转换的条件是什么？本练习通过一个概念性的温盐环流模型，模拟了触发“临界事件”的过程 。您将通过施加一个短时的强迫脉冲（如热量或淡水通量），来量化将系统从一个吸引盆推向另一个吸引盆所需的最小扰动，从而将“临界点”这一抽象概念转化为一个可计算的恢复力阈值。",
            "id": "4017333",
            "problem": "考虑一个海洋温盐环流的双箱概念模型，该模型在 Boussinesq 近似和线性状态方程下，具有高纬度箱和低纬度箱之间的无量纲温差 $T$ 和盐差 $S$。翻转输运 $q$ 与密度差成正比，并建模为 $q = T - S$，其中平流项由 $|q|$ 缩放，以确保混合率为非负。控制常微分方程组为：\n$$\\frac{dT}{dt} = \\eta \\left(\\Delta T_a(t) - T\\right) - |q|\\,T,$$\n$$\\frac{dS}{dt} = F(t) - |q|\\,S,$$\n以及\n$$q = T - S,$$\n其中 $\\eta$ 是无量纲热弛豫率，$\\Delta T_a(t)$ 是无量纲的强迫大气温差，$F(t)$ 是无量纲的强迫淡水通量。平流项中使用绝对值 $|q|$ 是为了反映与方向无关的混合率。\n\n当系统在恒定强迫下存在多个稳定平衡时，盐平流反馈会引起双稳态。脉冲扰动实验包括向其中一个强迫添加一个振幅为 $A$ 的有限时长脉冲，同时将另一个强迫保持在其基线值：\n- 热脉冲：当 $t \\in [0,\\tau_p]$ 时，$\\Delta T_a(t) = \\Delta T_{a,0} + A$；当 $t  \\tau_p$ 时，$\\Delta T_a(t) = \\Delta T_{a,0}$，同时 $F(t) = F_0$ 固定在基线值。\n- 淡水脉冲：当 $t \\in [0,\\tau_p]$ 时，$F(t) = F_0 + A$；当 $t  \\tau_p$ 时，$F(t) = F_0$，同时 $\\Delta T_a(t) = \\Delta T_{a,0}$ 固定在基线值。\n\n从通过在恒定基线强迫 $(\\Delta T_{a,0}, F_0)$ 下对系统进行足够长的弛豫时间积分所获得的稳定基线平衡开始，应用所选的脉冲扰动，然后继续在基线强迫下积分，直到一个较长的最终时间。如果在最终时刻 $q$ 的符号与基线平衡的符号不同，并且 $|q|$ 超过一个小的阈值 $\\epsilon$（以排除近中性状态），则检测到向另一个吸引子的转变。请确定在指定搜索区间内引起这种转变的最小脉冲振幅 $A$。如果在该区间内没有发生转变，则返回 $-1$。\n\n此问题中的所有变量都是无量纲的，不使用物理单位。\n\n您必须实现一个程序，该程序：\n- 通过在初始条件 $T(0) = \\Delta T_{a,0}$ 和 $S(0) = F_0$ 下，使用 $(\\Delta T_a(t) = \\Delta T_{a,0}, F(t) = F_0)$ 对系统积分一个弛豫时间 $t_{\\mathrm{relax}}$ 来计算基线平衡。\n- 在弛豫结束点检测 $q$ 的基线符号。\n- 在振幅 $A \\in [A_{\\min}, A_{\\max}]$ 上实现二分搜索，以找到在所选脉冲类型和持续时间 $\\tau_p$ 下触发转变的最小 $A$，并积分至最终时间 $t_{\\mathrm{end}}$。对 $A$ 使用收敛容差 $\\delta$ 和最大二分迭代次数 $N_{\\mathrm{bisect}}$。如果在 $A_{\\max}$ 处没有发生转变，则对该测试用例输出 $-1$。\n\n使用以下测试套件，其中每个测试用例由 $(\\text{脉冲类型}, \\eta, \\Delta T_{a,0}, F_0, \\tau_p, t_{\\mathrm{relax}}, t_{\\mathrm{end}}, A_{\\min}, A_{\\max}, \\epsilon, \\delta, N_{\\mathrm{bisect}})$ 指定：\n- 测试用例 1（理想情况，淡水脉冲）：\n  - $(\\text{freshwater},\\, \\eta = $1.0$,\\, \\Delta T_{a,0} = $1.2$,\\, F_0 = $0.2$,\\, \\tau_p = $5.0$,\\, t_{\\mathrm{relax}} = $200.0$,\\, t_{\\mathrm{end}} = $300.0$,\\, A_{\\min} = $0.0$,\\, A_{\\max} = $0.8$,\\, \\epsilon = $1\\times 10^{-3}$,\\, \\delta = $1\\times 10^{-3}$,\\, N_{\\mathrm{bisect}} = $30$)$.\n- 测试用例 2（热脉冲）：\n  - $(\\text{heat},\\, \\eta = $1.0$,\\, \\Delta T_{a,0} = $1.2$,\\, F_0 = $0.2$,\\, \\tau_p = $5.0$,\\, t_{\\mathrm{relax}} = $200.0$,\\, t_{\\mathrm{end}} = $300.0$,\\, A_{\\min} = $0.0$,\\, A_{\\max} = $2.0$,\\, \\epsilon = $1\\times 10^{-3}$,\\, \\delta = $1\\times 10^{-3}$,\\, N_{\\mathrm{bisect}} = $30$)$.\n- 测试用例 3（边界情况，预期在界限内不会发生转变）：\n  - $(\\text{freshwater},\\, \\eta = $1.0$,\\, \\Delta T_{a,0} = $1.2$,\\, F_0 = $0.2$,\\, \\tau_p = $5.0$,\\, t_{\\mathrm{relax}} = $200.0$,\\, t_{\\mathrm{end}} = $300.0$,\\, A_{\\min} = $0.0$,\\, A_{\\max} = $0.05$,\\, \\epsilon = $1\\times 10^{-3}$,\\, \\delta = $1\\times 10^{-3}$,\\, N_{\\mathrm{bisect}} = $30$)$.\n\n您的程序应生成一行输出，其中包含一个逗号分隔的列表，用方括号括起来，结果顺序与测试用例相同。对于每个测试用例，输出导致转变的最小振幅 $A$（浮点数），如果 $[A_{\\min}, A_{\\max}]$ 内没有发生转变，则输出 $-1$。例如，输出必须具有格式 $[\\text{result}_1,\\text{result}_2,\\text{result}_3]$。",
            "solution": "该问题要求确定一个有限时长强迫脉冲的最小振幅，该脉冲能在海洋温盐环流的双箱概念模型中引发状态转变。这是一个非线性动力学和气候科学领域的问题，具体涉及双稳态和临界点现象。解决方案涉及数值积分一个常微分方程组（ODEs），并结合二分搜索算法来寻找临界脉冲振幅。\n\n无量纲温差 $T$ 和盐差 $S$ 的控制方程为：\n$$ \\frac{dT}{dt} = \\eta \\left(\\Delta T_a(t) - T\\right) - |q|\\,T $$\n$$ \\frac{dS}{dt} = F(t) - |q|\\,S $$\n其中翻转输运 $q$ 定义为：\n$$ q = T - S $$\n绝对值 $|q| = |T-S|$ 确保平流混合项始终为非负，代表一个速率。系统的动力学由以下无量纲参数控制：$\\eta$（热弛豫率）、$\\Delta T_a(t)$（强迫大气温差）和 $F(t)$（强迫淡水通量）。\n\n问题的核心是找到一个扰动将系统从一个稳定平衡态转换到另一个稳定平衡态的阈值。这是探测多稳态系统稳定性结构的一种常用方法。解决此问题的算法流程如下：\n\n1.  **基线平衡计算**：第一步是确定系统在恒定基线强迫 $(\\Delta T_{a,0}, F_0)$ 下的初始稳定状态。我们通过从初始条件 $(T(0), S(0)) = (\\Delta T_{a,0}, F_0)$ 在一个长的弛豫周期 $[0, t_{\\mathrm{relax}}]$ 内数值积分常微分方程组来模拟系统动力学。系统在 $t_{\\mathrm{relax}}$ 时的状态，表示为 $(T_{base}, S_{base})$，被视为基线平衡。记录基线翻转环流的符号 $\\text{sign}(q_{base}) = \\text{sign}(T_{base} - S_{base})$，它表征了初始吸引子（例如，热驱动的“开启”状态或盐驱动的“关闭”状态）。\n\n2.  **脉冲扰动模拟**：为了测试给定振幅 $A$ 的脉冲是否引起转变，我们进行第二次模拟。此模拟从先前计算的基线平衡 $(T(0), S(0)) = (T_{base}, S_{base})$ 开始，运行到最终时间 $t_{\\mathrm{end}}$。在时间区间 $[0, \\tau_p]$ 内，其中一个强迫受到振幅为 $A$ 的扰动。\n    - 对于热脉冲：当 $t \\in [0, \\tau_p]$ 时，$\\Delta T_a(t) = \\Delta T_{a,0} + A$；否则，$\\Delta T_a(t) = \\Delta T_{a,0}$。\n    - 对于淡水脉冲：当 $t \\in [0, \\tau_p]$ 时，$F(t) = F_0 + A$；否则，$F(t) = F_0$。\n    在 $t = t_{\\mathrm{end}}$ 时获得最终状态 $(T_{final}, S_{final})$。\n\n3.  **转变检测**：如果在扰动实验结束时翻转环流的符号与基线符号相反，并且其量值足够大以至于不处于近中性状态，则认为发生了转变。条件是：\n    $$ \\text{sign}(q_{final}) \\neq \\text{sign}(q_{base}) \\quad \\text{并且} \\quad |q_{final}|  \\epsilon $$\n    其中 $q_{final} = T_{final} - S_{final}$，$\\epsilon$ 是一个小的阈值。此逻辑被封装在一个布尔函数中，我们称之为 `check_transition(A)`。\n\n4.  **二分搜索**：主要目标是找到在给定范围 $[A_{\\min}, A_{\\max}]$ 内触发转变的最小振幅 $A$。二分法是完成此任务的合适求根算法。它能有效地缩小包含临界振幅的区间。\n    - 首先，我们通过测试上界 $A_{\\max}$ 来检查在给定范围内是否可能发生转变。如果 `check_transition(A_{\\max})` 为假，则不可能发生转变，我们返回 $-1$。\n    - 否则，我们用 `low` = $A_{\\min}$ 和 `high` = $A_{\\max}$ 初始化一个搜索区间。\n    - 我们最多迭代 $N_{\\mathrm{bisect}}$ 次，或直到区间宽度（`high` - `low`）小于容差 $\\delta$。在每次迭代中：\n        - 我们计算中点振幅 $A_{mid} = (\\text{low} + \\text{high}) / 2$。\n        - 我们测试这个振幅：如果 `check_transition(A_{mid})` 为真，意味着在 $A_{mid}$ 处发生了转变。这个振幅可能是新的最小值，所以我们通过设置 `high` = $A_{mid}$ 在区间的下半部分搜索一个可能更小的值。\n        - 如果 `check_transition(A_{mid})` 为假，则该振幅不足。临界阈值必须更大，所以我们通过设置 `low` = $A_{mid}$ 在上半部分搜索。\n    - 循环终止后，`high` 的值提供了转变所需最小振幅的近似值。\n\n常微分方程组的数值积分使用标准求解器执行，例如 Runge-Kutta 方法。绝对值函数 $|q| = |T-S|$ 的使用使得常微分方程组的右侧在 $T=S$ 时不可微，但它仍然是 Lipschitz 连续的，确保了解的存在性和唯一性。现代的自适应步长求解器可以毫无问题地处理这种轻微的非光滑性。所提供的实现将使用 `scipy.integrate.solve_ivp` 来完成此任务。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test suite.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"pulse_type\": \"freshwater\", \"eta\": 1.0, \"Delta_T_a_0\": 1.2, \"F_0\": 0.2,\n            \"tau_p\": 5.0, \"t_relax\": 200.0, \"t_end\": 300.0,\n            \"A_min\": 0.0, \"A_max\": 0.8, \"epsilon\": 1e-3, \"delta\": 1e-3, \"N_bisect\": 30\n        },\n        {\n            \"pulse_type\": \"heat\", \"eta\": 1.0, \"Delta_T_a_0\": 1.2, \"F_0\": 0.2,\n            \"tau_p\": 5.0, \"t_relax\": 200.0, \"t_end\": 300.0,\n            \"A_min\": 0.0, \"A_max\": 2.0, \"epsilon\": 1e-3, \"delta\": 1e-3, \"N_bisect\": 30\n        },\n        {\n            \"pulse_type\": \"freshwater\", \"eta\": 1.0, \"Delta_T_a_0\": 1.2, \"F_0\": 0.2,\n            \"tau_p\": 5.0, \"t_relax\": 200.0, \"t_end\": 300.0,\n            \"A_min\": 0.0, \"A_max\": 0.05, \"epsilon\": 1e-3, \"delta\": 1e-3, \"N_bisect\": 30\n        }\n    ]\n\n    results = []\n    for params in test_cases:\n        result = find_minimal_amplitude(**params)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"{r:.6f}\" if r != -1 else str(r) for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef ode_system(t, y, eta, Delta_T_a_0, F_0, pulse_type, A, tau_p):\n    \"\"\"\n    Defines the system of ordinary differential equations for the two-box model.\n    \"\"\"\n    T, S = y\n    \n    # Apply pulse based on time t\n    if t = tau_p:\n        if pulse_type == \"heat\":\n            Delta_T_a_t = Delta_T_a_0 + A\n            F_t = F_0\n        elif pulse_type == \"freshwater\":\n            Delta_T_a_t = Delta_T_a_0\n            F_t = F_0 + A\n        else: # baseline calculation\n            Delta_T_a_t = Delta_T_a_0\n            F_t = F_0\n    else:\n        Delta_T_a_t = Delta_T_a_0\n        F_t = F_0\n\n    q = T - S\n    abs_q = np.abs(q)\n\n    dT_dt = eta * (Delta_T_a_t - T) - abs_q * T\n    dS_dt = F_t - abs_q * S\n\n    return [dT_dt, dS_dt]\n\ndef run_simulation(y0, t_span, args):\n    \"\"\"\n    Wrapper for the ODE solver.\n    \"\"\"\n    sol = solve_ivp(\n        fun=ode_system,\n        t_span=t_span,\n        y0=y0,\n        method='RK45',\n        args=tuple(args.values()),\n        dense_output=False\n    )\n    return sol.y[:, -1]\n\ndef find_minimal_amplitude(pulse_type, eta, Delta_T_a_0, F_0, tau_p, t_relax, t_end, A_min, A_max, epsilon, delta, N_bisect):\n    \"\"\"\n    Finds the minimal pulse amplitude A that causes a state transition.\n    \"\"\"\n    # 1. Compute baseline equilibrium\n    y0_base = [Delta_T_a_0, F_0]\n    base_args = {\n        \"eta\": eta, \"Delta_T_a_0\": Delta_T_a_0, \"F_0\": F_0,\n        \"pulse_type\": \"none\", \"A\": 0.0, \"tau_p\": 0.0\n    }\n    T_base, S_base = run_simulation(y0_base, [0, t_relax], base_args)\n    \n    q_base = T_base - S_base\n    sign_q_base = np.sign(q_base)\n\n    y0_pert = [T_base, S_base]\n\n    def check_transition(A_test):\n        \"\"\"\n        Checks if a given amplitude A_test causes a transition.\n        \"\"\"\n        pert_args = {\n            \"eta\": eta, \"Delta_T_a_0\": Delta_T_a_0, \"F_0\": F_0,\n            \"pulse_type\": pulse_type, \"A\": A_test, \"tau_p\": tau_p\n        }\n        T_final, S_final = run_simulation(y0_pert, [0, t_end], pert_args)\n        \n        q_final = T_final - S_final\n        sign_q_final = np.sign(q_final)\n        \n        return sign_q_final != sign_q_base and np.abs(q_final) > epsilon\n\n    # 2. Check if a transition is possible at A_max\n    if not check_transition(A_max):\n        return -1.0\n\n    # 3. Bisection search\n    low = A_min\n    high = A_max\n    \n    for _ in range(N_bisect):\n        if high - low  delta:\n            break\n        \n        mid = (low + high) / 2.0\n        \n        if check_transition(mid):\n            high = mid  # A transition occurred, try smaller A\n        else:\n            low = mid   # No transition, need larger A\n\n    return high\n\nif __name__ == '__main__':\n    solve()\n```"
        },
        {
            "introduction": "真实的气候系统并非完全确定性的，而是持续受到内部变率和随机扰动（即“噪音”）的影响。本练习探讨了当系统接近临界点时，这些随机波动的统计特性如何发生变化 。通过推导系统稳定性（由恢复率 $\\lambda$ 表征）与可观测的时间序列统计量（如方差和自相关）之间的关系，您将掌握“临界慢化”（critical slowing down）现象的理论基础，这是发展气候突变早期预警信号的关键。",
            "id": "4017367",
            "problem": "考虑一个由于非线性反馈（例如，冰-反照率和海洋热量吸收）而表现出双稳态的气候子系统，其具有两个由一个不稳定的鞍点分隔的稳定平衡点。在其中一个稳定平衡点附近，将慢流形动力学的确定性分量线性化，以获得关于该平衡点的一个小异常量 $x(t)$ 的一维随机演化，其形式为 Ornstein–Uhlenbeck (OU) 过程\n$$\n\\mathrm{d}x(t) = \\lambda\\,x(t)\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W(t),\n$$\n其中 $\\lambda  0$ 是局部线性稳定性率，$\\sigma0$ 是代表未解析变率的噪声振幅，而 $W(t)$ 是标准维纳过程。您以均匀的时间间隔 $\\Delta0$ 对 $x(t)$ 进行采样，得到离散时间序列 $\\{x_n\\}_{n\\in\\mathbb{Z}}$，其中 $x_n = x(n\\Delta)$。假设 $\\Delta$ 足够小，使得 OU 近似有效但非零，并且系统保持在线性化平衡点的吸引盆内，远离有限振幅的逃逸。在数值天气预报和气候建模中，这种粗粒度采样通常由一个一阶自回归 (AR(1)) 过程表示，\n$$\nx_{n+1} = \\phi\\,x_n + \\eta_n,\n$$\n其中 $\\phi$ 是自回归系数，$\\{\\eta_n\\}$ 是一个均值为零的独立同分布新息序列。\n\n从线性化的连续时间 OU 动力学和维纳积分的基本性质出发，推导出在采样间隔为 $\\Delta$ 时，从连续时间系统到离散 AR(1) 表示的精确映射。使用此映射将自回归系数 $\\phi$ 与连续时间线性稳定性率 $\\lambda$ 联系起来，并推导 $\\{x_n\\}$ 的平稳方差和任意固定整数 $k\\ge 1$ 的滞后 $k$ 自相关。讨论当 $\\lambda\\uparrow 0$（接近临界点：临界慢化）时，方差增长和自相关增加方面的特征，但不要依赖任何预先给定的简化公式。\n\n将您的最终结果以 $\\phi$、平稳方差 $\\operatorname{Var}(x_n)$ 和滞后 $k$ 自相关 $\\rho(k)$ 的闭式解析表达式形式报告，每个表达式都用 $\\lambda$、$\\Delta$、$\\sigma$ 和 $k$ 表示。以 $\\mathrm{pmatrix}$ 格式的单行矩阵形式提供您的最终答案。不需要进行数值计算，也不允许四舍五入。不需要单位。",
            "solution": "问题陈述提供了一个气候异常的连续时间随机模型，并要求给出其离散时间表示和统计特性。在进行求解之前，我将首先验证问题的完整性。\n\n### 步骤 1：提取已知条件\n-   **连续时间动力学**：异常量 $x(t)$ 遵循由以下随机微分方程 (SDE) 描述的 Ornstein–Uhlenbeck (OU) 过程：\n    $$\n    \\mathrm{d}x(t) = \\lambda\\,x(t)\\,\\mathrm{d}t + \\sigma\\,\\mathrm{d}W(t)\n    $$\n-   **参数**：\n    -   $\\lambda  0$：表示局部线性稳定性率的常数。\n    -   $\\sigma > 0$：表示噪声振幅的常数。\n    -   $W(t)$：一个标准维纳过程。\n-   **离散时间序列**：连续过程以均匀间隔 $\\Delta > 0$ 进行采样，得到序列 $\\{x_n\\}_{n\\in\\mathbb{Z}}$，其中 $x_n = x(n\\Delta)$。\n-   **离散时间表示**：序列 $\\{x_n\\}$ 由一个一阶自回归 (AR(1)) 过程表示：\n    $$\n    x_{n+1} = \\phi\\,x_n + \\eta_n\n    $$\n-   **AR(1) 属性**：\n    -   $\\phi$：自回归系数。\n    -   $\\{\\eta_n\\}$：一个均值为零的独立同分布 (i.i.d.) 新息序列，$\\mathbb{E}[\\eta_n] = 0$。\n-   **任务**：\n    1.  推导从连续 OU 过程到离散 AR(1) 模型的精确映射。\n    2.  将 $\\phi$ 与 $\\lambda$ 联系起来。\n    3.  推导 $\\{x_n\\}$ 的平稳方差，记为 $\\operatorname{Var}(x_n)$。\n    4.  推导整数 $k \\ge 1$ 时 $\\{x_n\\}$ 的滞后 $k$ 自相关，记为 $\\rho(k)$。\n    5.  讨论当 $\\lambda \\uparrow 0$ 时方差和自相关的行为。\n    6.  所有结果必须用 $\\lambda$、$\\Delta$、$\\sigma$ 和 $k$ 表示。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学依据**：该问题在物理学和应用数学方面有充分的依据。Ornstein-Uhlenbeck 过程是受白噪声强迫的线性系统的典范模型。将其离散化为 AR(1) 过程是时间序列分析中的标准程序。气候临界点、双稳态和临界慢化的背景是当代气候科学研究的一个主要领域，而此问题抓住了早期预警信号的基本数学基础。这些前提在科学上是合理的。\n-   **适定性**：该问题是适定的。它提供了一个清晰的数学模型，并要求基于给定参数推导出特定、唯一可确定的量（$\\phi$、方差、自相关）。\n-   **客观性**：该问题以精确、客观的数学语言陈述。\n-   **完备性与一致性**：该问题是自洽的。它提供了进行推导所需的所有必要方程、定义和假设。没有内部矛盾。条件 $\\lambda  0$ 确保了稳定平衡点和平稳态的存在。\n\n### 步骤 3：结论与行动\n该问题是有效的。这是随机微积分和时间序列分析中的一个标准的、非平凡的练习，与指定的科学领域直接相关。我将继续进行推导。\n\n### 推导\n求解过程分为几个步骤：求解连续时间 SDE，将解离散化以找到 AR(1) 参数，然后计算所需的统计特性。\n\n**1. Ornstein-Uhlenbeck SDE 的精确解**\n\n该 SDE 为 $\\mathrm{d}x(t) = \\lambda x(t) \\mathrm{d}t + \\sigma \\mathrm{d}W(t)$。这是一个线性 SDE。我们可以使用积分因子法来求解，类似于常微分方程。考虑过程 $Y(t) = \\exp(-\\lambda t) x(t)$。使用 Itô 微分乘积法则，我们有：\n$$\n\\mathrm{d}Y(t) = \\mathrm{d}(\\exp(-\\lambda t) x(t)) = (\\mathrm{d}\\exp(-\\lambda t)) x(t) + \\exp(-\\lambda t) \\mathrm{d}x(t)\n$$\n第一项是确定性的：$\\mathrm{d}\\exp(-\\lambda t) = -\\lambda \\exp(-\\lambda t) \\mathrm{d}t$。将此式和 $\\mathrm{d}x(t)$ 的 SDE 代入：\n$$\n\\mathrm{d}Y(t) = -\\lambda \\exp(-\\lambda t) x(t) \\mathrm{d}t + \\exp(-\\lambda t) (\\lambda x(t) \\mathrm{d}t + \\sigma \\mathrm{d}W(t))\n$$\n包含 $x(t)$ 的项相互抵消：\n$$\n\\mathrm{d}Y(t) = \\sigma \\exp(-\\lambda t) \\mathrm{d}W(t)\n$$\n将此方程从时间 $t_0$ 积分到稍后的时间 $t$：\n$$\nY(t) - Y(t_0) = \\int_{t_0}^{t} \\sigma \\exp(-\\lambda s) \\mathrm{d}W(s)\n$$\n将 $Y(t) = \\exp(-\\lambda t)x(t)$ 代回：\n$$\n\\exp(-\\lambda t)x(t) - \\exp(-\\lambda t_0)x(t_0) = \\sigma \\int_{t_0}^{t} \\exp(-\\lambda s) \\mathrm{d}W(s)\n$$\n求解 $x(t)$，我们得到 OU 过程的形式解：\n$$\nx(t) = \\exp(\\lambda(t - t_0)) x(t_0) + \\sigma \\int_{t_0}^{t} \\exp(\\lambda(t - s)) \\mathrm{d}W(s)\n$$\n\n**2. 到离散 AR(1) 过程的映射**\n\n我们希望找到 $x_{n+1} = x((n+1)\\Delta)$ 和 $x_n = x(n\\Delta)$ 之间的关系。我们使用上面推导出的解，设置 $t_0 = n\\Delta$ 和 $t = (n+1)\\Delta$：\n$$\nx((n+1)\\Delta) = \\exp(\\lambda((n+1)\\Delta - n\\Delta)) x(n\\Delta) + \\sigma \\int_{n\\Delta}^{(n+1)\\Delta} \\exp(\\lambda((n+1)\\Delta - s)) \\mathrm{d}W(s)\n$$\n用离散符号表示，即为：\n$$\nx_{n+1} = \\exp(\\lambda\\Delta) x_n + \\sigma \\int_{n\\Delta}^{(n+1)\\Delta} \\exp(\\lambda((n+1)\\Delta - s)) \\mathrm{d}W(s)\n$$\n该方程具有 AR(1) 过程 $x_{n+1} = \\phi x_n + \\eta_n$ 的确切形式。通过直接比较，我们确定自回归系数 $\\phi$ 和新息项 $\\eta_n$：\n$$\n\\phi = \\exp(\\lambda\\Delta)\n$$\n$$\n\\eta_n = \\sigma \\int_{n\\Delta}^{(n+1)\\Delta} \\exp(\\lambda((n+1)\\Delta - s)) \\mathrm{d}W(s)\n$$\n由于 $\\lambda  0$ 且 $\\Delta > 0$，我们有 $\\lambda\\Delta  0$，这保证了 $|\\phi| = \\exp(\\lambda\\Delta)  1$，这是 AR(1) 过程平稳性的一个必要条件。\n\n**3. 新息项 $\\eta_n$ 的性质**\n\n项 $\\eta_n$ 是一个确定性函数对维纳过程的 Itô 积分。因此，它是一个高斯随机变量。\n-   **均值**：Itô 积分的期望值为零。因此，$\\mathbb{E}[\\eta_n] = 0$，与问题陈述一致。\n-   **方差**：$\\eta_n$ 的方差是 $\\operatorname{Var}(\\eta_n) = \\mathbb{E}[\\eta_n^2]$。使用 Itô 等距性质，该性质表明 $\\mathbb{E}[(\\int_a^b f(s) \\mathrm{d}W(s))^2] = \\int_a^b f(s)^2 \\mathrm{d}s$：\n$$\n\\operatorname{Var}(\\eta_n) = \\sigma^2 \\int_{n\\Delta}^{(n+1)\\Delta} \\left(\\exp(\\lambda((n+1)\\Delta - s))\\right)^2 \\mathrm{d}s = \\sigma^2 \\int_{n\\Delta}^{(n+1)\\Delta} \\exp(2\\lambda((n+1)\\Delta - s)) \\mathrm{d}s\n$$\n为了计算该积分，令 $u = (n+1)\\Delta - s$，所以 $\\mathrm{d}u = -\\mathrm{d}s$。积分上下限从 $s=n\\Delta \\to u=\\Delta$ 和 $s=(n+1)\\Delta \\to u=0$ 改变。\n$$\n\\operatorname{Var}(\\eta_n) = \\sigma^2 \\int_{\\Delta}^{0} \\exp(2\\lambda u) (-\\mathrm{d}u) = \\sigma^2 \\int_{0}^{\\Delta} \\exp(2\\lambda u) \\mathrm{d}u\n$$\n$$\n\\operatorname{Var}(\\eta_n) = \\sigma^2 \\left[ \\frac{\\exp(2\\lambda u)}{2\\lambda} \\right]_0^{\\Delta} = \\sigma^2 \\frac{\\exp(2\\lambda\\Delta) - 1}{2\\lambda}\n$$\n由于此表达式不依赖于 $n$，新息具有恒定方差。此外，因为维纳增量 $\\mathrm{d}W(s)$ 在不重叠的时间区间上是独立的，所以当 $n \\neq m$ 时 $\\eta_n$ 和 $\\eta_m$ 是独立的。这证实了 $\\{\\eta_n\\}$ 是一个独立同分布变量序列。\n\n**4. $\\{x_n\\}$ 的平稳方差**\n\n对于平稳 AR(1) 过程 $x_{n+1} = \\phi x_n + \\eta_n$，方差是恒定的，$\\operatorname{Var}(x_{n+1}) = \\operatorname{Var}(x_n)$。对 AR(1) 方程两边取方差：\n$$\n\\operatorname{Var}(x_{n+1}) = \\operatorname{Var}(\\phi x_n + \\eta_n)\n$$\n状态 $x_n$ 是截至时间 $n\\Delta$ 的维纳增量的函数。新息 $\\eta_n$ 是从 $n\\Delta$ 到 $(n+1)\\Delta$ 的增量的函数。因此，$x_n$ 和 $\\eta_n$ 是不相关的，所以 $\\operatorname{Cov}(x_n, \\eta_n) = 0$。\n$$\n\\operatorname{Var}(x_{n+1}) = \\operatorname{Var}(\\phi x_n) + \\operatorname{Var}(\\eta_n) = \\phi^2 \\operatorname{Var}(x_n) + \\operatorname{Var}(\\eta_n)\n$$\n令 $V_x = \\operatorname{Var}(x_n)$ 为平稳方差。那么 $V_x = \\phi^2 V_x + \\operatorname{Var}(\\eta_n)$，得到：\n$$\nV_x(1 - \\phi^2) = \\operatorname{Var}(\\eta_n) \\implies V_x = \\frac{\\operatorname{Var}(\\eta_n)}{1 - \\phi^2}\n$$\n代入我们关于 $\\phi$ 和 $\\operatorname{Var}(\\eta_n)$ 的表达式：\n$$\n\\operatorname{Var}(x_n) = \\frac{\\sigma^2 \\frac{\\exp(2\\lambda\\Delta) - 1}{2\\lambda}}{1 - (\\exp(\\lambda\\Delta))^2} = \\frac{\\sigma^2 \\frac{\\exp(2\\lambda\\Delta) - 1}{2\\lambda}}{1 - \\exp(2\\lambda\\Delta)} = \\frac{\\sigma^2}{2\\lambda} \\frac{\\exp(2\\lambda\\Delta) - 1}{-(\\exp(2\\lambda\\Delta) - 1)}\n$$\n$$\n\\operatorname{Var}(x_n) = -\\frac{\\sigma^2}{2\\lambda}\n$$\n这个结果证实了离散采样平穩过程的方差与底层连续时间 OU 过程的平穩方差相同。\n\n**5. 滞后 $k$ 自相关**\n\n滞后 $k$ 自相关定义为 $\\rho(k) = \\frac{\\operatorname{Cov}(x_{n+k}, x_n)}{\\operatorname{Var}(x_n)}$，其中 $k \\ge 1$。首先，我们计算自协方差 $\\gamma(k) = \\operatorname{Cov}(x_{n+k}, x_n)$。由于平稳均值为零，$\\gamma(k) = \\mathbb{E}[x_{n+k}x_n]$。\n我们可以建立一个递归关系。将 AR(1) 方程 $x_{n+k} = \\phi x_{n+k-1} + \\eta_{n+k-1}$ 两边同乘以 $x_n$ 并取期望：\n$$\n\\mathbb{E}[x_{n+k}x_n] = \\phi \\mathbb{E}[x_{n+k-1}x_n] + \\mathbb{E}[\\eta_{n+k-1}x_n]\n$$\n对于 $k \\ge 1$，新息 $\\eta_{n+k-1}$ 与 $x_n$ 不相关，所以 $\\mathbb{E}[\\eta_{n+k-1}x_n] = 0$。这给出了 AR(1) 过程的 Yule-Walker 方程：\n$$\n\\gamma(k) = \\phi \\gamma(k-1)\n$$\n通过递归，得到 $\\gamma(k) = \\phi^k \\gamma(0)$。滞后为 0 的协方差就是方差，$\\gamma(0) = \\operatorname{Var}(x_n)$。\n因此，自相关为：\n$$\n\\rho(k) = \\frac{\\gamma(k)}{\\gamma(0)} = \\frac{\\phi^k \\gamma(0)}{\\gamma(0)} = \\phi^k\n$$\n代入我们关于 $\\phi$ 的结果：\n$$\n\\rho(k) = (\\exp(\\lambda\\Delta))^k = \\exp(\\lambda k \\Delta)\n$$\n\n**6. 临界慢化（$\\lambda \\uparrow 0$）的讨论**\n\n在此模型中，接近临界点由稳定性率 $\\lambda$ 从负侧趋近于零（$\\lambda \\uparrow 0$）来表示。\n-   **方差增长**：平稳方差为 $\\operatorname{Var}(x_n) = -\\frac{\\sigma^2}{2\\lambda}$。当 $\\lambda \\to 0^{-}$ 时，分母趋近于零，因此 $\\operatorname{Var}(x_n) \\to +\\infty$。随着恢复力的减弱，系统的涨落变得无限大。\n-   **自相关增加**：滞后 $k$ 自相关为 $\\rho(k) = \\exp(\\lambda k \\Delta)$。当 $\\lambda \\to 0^{-}$ 时，指数 $\\lambda k \\Delta$ 趋近于 0。因此，对于任何固定的滞后 $k$，$\\rho(k) \\to \\exp(0) = 1$。这表明系统的“记忆”急剧增加。扰动衰减得慢得多（e-折衰减时间为 $\\tau = -1/\\lambda \\to \\infty$），导致连续状态高度相关。\n这两种现象——方差增长和自相关增加——是“临界慢化”的主要特征，被用作气候等复杂系统中即将发生临界转变的早期预警信号。\n\n### 结果总结\n-   自回归系数：$\\phi = \\exp(\\lambda \\Delta)$\n-   平稳方差：$\\operatorname{Var}(x_n) = -\\frac{\\sigma^2}{2\\lambda}$\n-   滞后 $k$ 自相关：$\\rho(k) = \\exp(\\lambda k \\Delta)$\n这些就是所要求的闭式解析表达式。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\exp(\\lambda \\Delta)  -\\frac{\\sigma^{2}}{2\\lambda}  \\exp(\\lambda k \\Delta)\n\\end{pmatrix}\n}\n$$"
        }
    ]
}