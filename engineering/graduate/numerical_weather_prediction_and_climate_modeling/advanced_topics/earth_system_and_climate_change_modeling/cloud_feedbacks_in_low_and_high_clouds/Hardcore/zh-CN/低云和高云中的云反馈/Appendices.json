{
    "hands_on_practices": [
        {
            "introduction": "要理解云反馈，我们首先必须掌握如何计算它们对地球能量收支的直接影响。本练习旨在量化不同云类型之间相互竞争的短波和长波辐射效应，是一项基础性实践。通过解决这个问题 ，您将学会计算由低云和高云云量同时变化引起的大气层顶净辐射变化，这是诊断气候扰动的关键一步。",
            "id": "4022990",
            "problem": "考虑大气层顶（TOA）的全球平均能量收支，其中净向下辐射通量定义为 $F_{\\mathrm{net}} = F_{\\mathrm{SW,abs}} - F_{\\mathrm{LW,up}}$，其中 $F_{\\mathrm{SW,abs}}$ 是净吸收的短波（SW）辐射，$F_{\\mathrm{LW,up}}$ 是向太空的上行长波（LW）辐射。云通过改变短波辐射的反射和捕获长波辐射来影响 $F_{\\mathrm{net}}$。对于云量的微小扰动，围绕基准气候态进行线性化是合适的。设 $F_{\\mathrm{net}}$ 对云量的特定类型敏感性由恒定的偏导数给出（假定在扰动范围内局部有效）。\n\n假设 $F_{\\mathrm{net}}$ 对云量的以下代表性、按类型平均的敏感性：\n- 低云：$\\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{\\ell}} \\big|_{\\mathrm{SW}} = -110~\\mathrm{W\\,m^{-2}}$ 每单位云量，以及 $\\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{\\ell}} \\big|_{\\mathrm{LW}} = +12~\\mathrm{W\\,m^{-2}}$ 每单位云量。\n- 高云：$\\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{h}} \\big|_{\\mathrm{SW}} = -70~\\mathrm{W\\,m^{-2}}$ 每单位云量，以及 $\\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{h}} \\big|_{\\mathrm{LW}} = +95~\\mathrm{W\\,m^{-2}}$ 每单位云量。\n\n此处，$C_{\\ell}$ 和 $C_{h}$ 分别表示全球平均低云量和高云量。符号约定为，正的 $\\Delta F_{\\mathrm{net}}$ 对应于大气层顶净向下通量的增加（增温效应）。\n\n假设全球平均低云量减少 $1\\%$，全球平均高云量增加 $0.5\\%$。将这些扰动视为应用于上述敏感性的 $\\Delta C_{\\ell}$ 和 $\\Delta C_{h}$，并忽略除所述云量变化之外的地表反照率、大气成分和环流的任何变化。使用线性近似，计算净变化 $\\Delta F_{\\mathrm{net}}$，单位为 $\\mathrm{W\\,m^{-2}}$，并将您的答案四舍五入到四位有效数字。用 $\\mathrm{W\\,m^{-2}}$ 表示您的最终答案。",
            "solution": "问题要求计算由指定的低云量和高云量变化所导致的全球平均大气层顶（TOA）净向下辐射通量的净变化 $\\Delta F_{\\mathrm{net}}$。净通量 $F_{\\mathrm{net}}$ 是低云量 $C_{\\ell}$ 和高云量 $C_{h}$ 的函数。问题指出，对于给定的微小扰动，线性近似是合适的。这对应于使用 $F_{\\mathrm{net}}$ 的全微分来近似其变化量 $\\Delta F_{\\mathrm{net}}$。\n\n$F_{\\mathrm{net}}(C_{\\ell}, C_{h})$ 的全微分由下式给出：\n$$\n\\Delta F_{\\mathrm{net}} \\approx \\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{\\ell}} \\Delta C_{\\ell} + \\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{h}} \\Delta C_{h}\n$$\n其中 $\\Delta C_{\\ell}$ 和 $\\Delta C_{h}$ 分别是各自云量的变化。问题假设其他变量保持不变。\n\n净通量对给定云类型变化的总结感性是其短波（SW）和长波（LW）分量的总和。问题以恒定偏导数的形式提供了这些分量敏感性。\n\n首先，我们计算对低云的总敏感性 $\\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{\\ell}}$。这是短波和长波敏感性的总和：\n$$\n\\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{\\ell}} = \\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{\\ell}} \\bigg|_{\\mathrm{SW}} + \\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{\\ell}} \\bigg|_{\\mathrm{LW}}\n$$\n代入给定值：\n$$\n\\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{\\ell}} = (-110~\\mathrm{W\\,m^{-2}}) + (12~\\mathrm{W\\,m^{-2}}) = -98~\\mathrm{W\\,m^{-2}}\n$$\n这个结果表明，低云量的增加会导致净冷却效应（净向下通量的减少）。\n\n接下来，我们计算对高云的总敏感性 $\\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{h}}$：\n$$\n\\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{h}} = \\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{h}} \\bigg|_{\\mathrm{SW}} + \\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{h}} \\bigg|_{\\mathrm{LW}}\n$$\n代入给定值：\n$$\n\\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{h}} = (-70~\\mathrm{W\\,m^{-2}}) + (95~\\mathrm{W\\,m^{-2}}) = 25~\\mathrm{W\\,m^{-2}}\n$$\n这个结果显示，高云量的增加会导致净增温效应（净向下通量的增加）。\n\n问题指定了云量的变化。低云量减少 $1\\%$ 表示为单位云量的变化：\n$$\n\\Delta C_{\\ell} = -1\\% = -0.01\n$$\n高云量增加 $0.5\\%$ 表示为：\n$$\n\\Delta C_{h} = +0.5\\% = +0.005\n$$\n\n现在我们可以使用线性近似来计算总变化 $\\Delta F_{\\mathrm{net}}$。该变化包括低云变化的贡献和高云变化的贡献。\n\n来自低云的贡献，$\\Delta F_{\\mathrm{net}, \\ell}$：\n$$\n\\Delta F_{\\mathrm{net}, \\ell} = \\left( \\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{\\ell}} \\right) \\Delta C_{\\ell} = (-98~\\mathrm{W\\,m^{-2}}) \\times (-0.01) = 0.98~\\mathrm{W\\,m^{-2}}\n$$\n低云（净效应为冷却）的减少导致一个正的通量变化，即增温效应。\n\n来自高云的贡献，$\\Delta F_{\\mathrm{net}, h}$：\n$$\n\\Delta F_{\\mathrm{net}, h} = \\left( \\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{h}} \\right) \\Delta C_{h} = (25~\\mathrm{W\\,m^{-2}}) \\times (0.005) = 0.125~\\mathrm{W\\,m^{-2}}\n$$\n高云（净效应为增温）的增加导致一个正的通量变化，同样是增温效应。\n\n总净变化 $\\Delta F_{\\mathrm{net}}$ 是这两个贡献的总和：\n$$\n\\Delta F_{\\mathrm{net}} = \\Delta F_{\\mathrm{net}, \\ell} + \\Delta F_{\\mathrm{net}, h} = 0.98~\\mathrm{W\\,m^{-2}} + 0.125~\\mathrm{W\\,m^{-2}} = 1.105~\\mathrm{W\\,m^{-2}}\n$$\n问题要求答案四舍五入到四位有效数字。计算值 $1.105$ 已经有四位有效数字，因此不需要进一步四舍五入。这些云变化的净效应是一个 $1.105~\\mathrm{W\\,m^{-2}}$ 的正辐射强迫。",
            "answer": "$$\n\\boxed{1.105}\n$$"
        },
        {
            "introduction": "探讨了云的直接辐射效应之后，我们现在进入反馈的概念，即这些效应与温度变化相互耦合。本练习  使用一个简化的能量平衡模型，来探索云反馈强度对整体气候敏感度的深远影响。通过推导由云反馈参数 $\\lambda_c$ 的变化所引起的平衡气候敏感度（ECS）的变化，您将对云如何调节我们的星球对辐射强迫的响应，获得一个清晰的、定量的理解。",
            "id": "4022991",
            "problem": "考虑处于平衡状态的气候系统的全球平均线性能力平衡，表示为 $N = F - \\lambda\\,\\Delta T$，其中 $N$ 是行星能量不平衡，$F$ 是外部施加的辐射强迫，$\\lambda$ 是净气候反馈参数，单位为 $\\mathrm{W\\,m^{-2}\\,K^{-1}}$，$\\Delta T$ 是平衡态全球平均地表气温变化。在平衡状态下，$N=0$，因此 $\\Delta T = F/\\lambda$。此处将大气二氧化碳加倍的平衡气候敏感度（ECS）定义为，在线性反馈的假设下，对典型加倍强迫 $F=3.7\\,\\mathrm{W\\,m^{-2}}$ 的平衡响应。\n\n设净反馈参数可分解为 $\\lambda = \\lambda_{\\mathrm{P}} + \\lambda_{\\mathrm{wv}} + \\lambda_{\\mathrm{lr}} + \\lambda_{\\mathrm{c}} + \\lambda_{\\mathrm{al}}$，其中 $\\lambda_{\\mathrm{P}}$ 是普朗克（黑体）响应，$\\lambda_{\\mathrm{wv}}$ 是水汽贡献，$\\lambda_{\\mathrm{lr}}$ 是递减率贡献，$\\lambda_{\\mathrm{c}}$ 是云贡献，$\\lambda_{\\mathrm{al}}$ 是地表反照率贡献。将基线净反馈参数（包括基线云贡献）定义为 $\\lambda_{b} > 0$。\n\n假设一个基于过程的模型开发仅改变了云反馈贡献，增量为 $\\Delta \\lambda_{\\mathrm{c}} = +0.3\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}$（所有其他分量保持不变），这可以解释为与云相关的辐射恢复效应的增强。仅使用线性能量平衡框架和物理上一致的符号约定，推导平衡气候敏感度变化量 $\\Delta \\mathrm{ECS} \\equiv \\mathrm{ECS}^{\\prime} - \\mathrm{ECS}_{b}$ 的解析表达式，其中 $\\mathrm{ECS}_{b}$ 是基线ECS，$\\mathrm{ECS}^{\\prime}$ 是应用云反馈增量后的ECS。最终答案以开尔文表示。\n\n在推导过程中，从平衡能量平衡关系和给定的分解开始，并明确指出 $\\lambda_{\\mathrm{c}}$ 的增量如何改变净辐射恢复效应。你的推理应阐明其在低云短波反射和高云长波捕获方面的物理解释，但最终报告的答案必须是 $\\Delta \\mathrm{ECS}$ 关于 $\\lambda_{b}$ 和给定数值的单一闭合形式解析表达式。不需要进行数值计算或四舍五入，也未提供额外数据。最终答案必须是单一表达式。",
            "solution": "首先对问题进行验证，以确保其科学上合理、适定且客观。\n\n**步骤1：提取已知条件**\n- 平衡状态下的全球平均线性能量平衡：$N = F - \\lambda\\,\\Delta T$。\n- 在平衡状态下，$N=0$，这意味着 $\\Delta T = F/\\lambda$。\n- $F$ 是辐射强迫。\n- $\\lambda$ 是净气候反馈参数，单位为 $\\mathrm{W\\,m^{-2}\\,K^{-1}}$。\n- $\\Delta T$ 是平衡态全球平均地表气温变化。\n- 平衡气候敏感度（ECS）定义为二氧化碳加倍强迫 $F = 3.7\\,\\mathrm{W\\,m^{-2}}$ 所导致的 $\\Delta T$。\n- 净反馈参数分解为 $\\lambda = \\lambda_{\\mathrm{P}} + \\lambda_{\\mathrm{wv}} + \\lambda_{\\mathrm{lr}} + \\lambda_{\\mathrm{c}} + \\lambda_{\\mathrm{al}}$。\n- 给定的基线净反馈参数为 $\\lambda_{b} > 0$。\n- 仅对云反馈分量进行了改变，增量为 $\\Delta \\lambda_{\\mathrm{c}} = +0.3\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}$。\n- 目标是推导ECS变化量 $\\Delta \\mathrm{ECS} \\equiv \\mathrm{ECS}^{\\prime} - \\mathrm{ECS}_{b}$ 的解析表达式，其中 $\\mathrm{ECS}_{b}$ 是基线敏感度，$\\mathrm{ECS}^{\\prime}$ 是变化后的新敏感度。\n\n**步骤2：验证**\n- **科学基础：** 该问题基于标准的线性能量平衡模型，这是气候科学中用于概念化气候敏感度的基本工具。反馈参数 $\\lambda$ 的分解以及二氧化碳加倍的典型强迫值（$F=3.7\\,\\mathrm{W\\,m^{-2}}$）是该领域的标准，并与主要的气候评估报告（例如，IPCC的报告）一致。符号约定，即正的 $\\lambda$ 代表一个稳定（负）反馈，对于此模型结构在物理上是正确的。条件 $\\lambda_b > 0$ 确保了稳定的基线气候。\n- **适定性：** 问题提供了推导唯一解析解所需的所有必要定义、方程和数值。目标陈述清晰。\n- **客观性：** 问题使用精确、定量和无偏见的科学语言进行表述。\n\n**步骤3：结论**\n问题是有效的，因为它在科学上是合理的、适定的和客观的。可以推导出解。\n\n**推导**\n\n该问题的核心是平衡气候敏感度（ECS）的概念，在指定的线性框架内，它是对特定辐射强迫 $F$ 的平衡温度变化 $\\Delta T$。\n\n基线平衡气候敏感度 $\\mathrm{ECS}_{b}$ 由对二氧化碳加倍的典型强迫 $F = 3.7\\,\\mathrm{W\\,m^{-2}}$ 的响应定义，使用基线净反馈参数 $\\lambda_{b}$。根据平衡关系 $\\Delta T = F/\\lambda$，我们有：\n$$\n\\mathrm{ECS}_{b} = \\frac{F}{\\lambda_{b}}\n$$\n\n问题指出，模型开发导致云反馈分量 $\\lambda_c$ 发生改变，增量为 $\\Delta \\lambda_{\\mathrm{c}} = +0.3\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}$。所有其他反馈分量（$\\lambda_{\\mathrm{P}}$、$\\lambda_{\\mathrm{wv}}$、$\\lambda_{\\mathrm{lr}}$、$\\lambda_{\\mathrm{al}}$）保持不变。因此，新的净反馈参数 $\\lambda^{\\prime}$ 是基线参数与此增量之和：\n$$\n\\lambda^{\\prime} = \\lambda_{b} + \\Delta \\lambda_{\\mathrm{c}}\n$$\n在此，$\\lambda$ 代表气候系统的净辐射恢复效应。一个更大的正 $\\lambda$ 值表示，对于给定的温度升高，地球向太空辐射更多能量，从而对变暖提供更强的阻尼效应。增量 $\\Delta \\lambda_{\\mathrm{c}} = +0.3\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}$ 构成了对这种辐射恢复的增强。在物理上，云反馈的这种变化可能对应于随着变暖，低层云的覆盖范围或光学厚度增加，这增强了对入射短波辐射的反射（一种冷却效应）。它也可能与高空卷云量的减少有关，这将减少其长波捕获效应（也是一种冷却效应）。\n\n新的平衡气候敏感度 $\\mathrm{ECS}^{\\prime}$ 使用新的反馈参数 $\\lambda^{\\prime}$ 和相同的强迫 $F$ 计算：\n$$\n\\mathrm{ECS}^{\\prime} = \\frac{F}{\\lambda^{\\prime}} = \\frac{F}{\\lambda_{b} + \\Delta \\lambda_{c}}\n$$\n平衡气候敏感度的变化量 $\\Delta \\mathrm{ECS}$ 是新敏感度与基线敏感度之差：\n$$\n\\Delta \\mathrm{ECS} = \\mathrm{ECS}^{\\prime} - \\mathrm{ECS}_{b}\n$$\n代入 $\\mathrm{ECS}^{\\prime}$ 和 $\\mathrm{ECS}_{b}$ 的表达式：\n$$\n\\Delta \\mathrm{ECS} = \\frac{F}{\\lambda_{b} + \\Delta \\lambda_{c}} - \\frac{F}{\\lambda_{b}}\n$$\n为了简化此表达式，我们提出公因子强迫 $F$ 并通分：\n$$\n\\Delta \\mathrm{ECS} = F \\left( \\frac{1}{\\lambda_{b} + \\Delta \\lambda_{c}} - \\frac{1}{\\lambda_{b}} \\right) = F \\left( \\frac{\\lambda_{b} - (\\lambda_{b} + \\Delta \\lambda_{c})}{\\lambda_{b}(\\lambda_{b} + \\Delta \\lambda_{c})} \\right)\n$$\n简化分子可得：\n$$\n\\Delta \\mathrm{ECS} = F \\left( \\frac{-\\Delta \\lambda_{c}}{\\lambda_{b}(\\lambda_{b} + \\Delta \\lambda_{c})} \\right) = - \\frac{F \\Delta \\lambda_{c}}{\\lambda_{b}(\\lambda_{b} + \\Delta \\lambda_{c})}\n$$\n这是ECS变化量的一般解析表达式。由于 $F > 0$，$\\Delta\\lambda_{\\mathrm{c}} > 0$，且系统是稳定的（$\\lambda_{b} > 0$），很明显 $\\Delta \\mathrm{ECS}$ 将为负。这在物理上是一致的：净负反馈的增强（即 $\\lambda$ 的增加）使系统对强迫的敏感度降低，导致更小的温度响应。\n\n问题要求最终答案是关于 $\\lambda_b$ 和给定数值的表达式。我们将 $F = 3.7\\,\\mathrm{W\\,m^{-2}}$ 和 $\\Delta \\lambda_{\\mathrm{c}} = 0.3\\,\\mathrm{W\\,m^{-2}\\,K^{-1}}$ 代入表达式。分子中的乘积为 $F \\Delta \\lambda_{c} = (3.7)(0.3) = 1.11$。该乘积的单位是 $(\\mathrm{W\\,m^{-2}})(\\mathrm{W\\,m^{-2}\\,K^{-1}})$。分母的单位是 $(\\mathrm{W\\,m^{-2}\\,K^{-1}})^2$。因此，最终表达式的单位是 $\\mathrm{K}$，符合要求。\n\n$\\Delta \\mathrm{ECS}$ 的最终解析表达式为：\n$$\n\\Delta \\mathrm{ECS} = - \\frac{1.11}{\\lambda_{b}(\\lambda_{b} + 0.3)}\n$$\n此表达式表示平衡气候敏感度的变化量（以开尔文为单位），是基线反馈参数 $\\lambda_{b}$ 的函数。",
            "answer": "$$\n\\boxed{- \\frac{1.11}{\\lambda_{b}(\\lambda_{b} + 0.3)}}\n$$"
        },
        {
            "introduction": "当我们能够从气候模型模拟中估算反馈参数时，这些理论概念才真正显示出其强大的威力。这项综合性练习  将引导您完成气候科学家用于从“abrupt-$4\\times\\mathrm{CO_2}$”实验输出中诊断反馈的标准工作流程。通过实施格雷戈里回归（Gregory regression）来找出净反馈参数 $\\lambda$，然后使用预先计算的辐射核（radiative kernel）结果来分离出云的贡献部分 $\\lambda_c$，您将获得评估和理解气候模型所必需的实用数据分析技能。",
            "id": "4022996",
            "problem": "要求您实现一个算法，在一个瞬时四倍二氧化碳（abrupt-$4\\times\\mathrm{CO_2}$）实验中，使用辐射核分解和 Gregory 回归来估算云反馈参数。您的程序必须根据一小组综合但物理上一致的实验测试集计算云反馈参数，并将结果输出为单行。\n\n目标是形式化、实现并验证以下方法。\n\n- 基础能量平衡。设全球平均的大气层顶（TOA）净向下能量不平衡为 $N$，单位为 $\\mathrm{W\\,m^{-2}}$。考虑广泛使用的 Gregory 回归框架，该框架假设 $N$ 与全球平均地表气温异常 $\\Delta T_s$（单位为 $\\mathrm{K}$）之间存在近似线性关系：\n$$\nN \\approx F - \\lambda\\,\\Delta T_s,\n$$\n其中 $F$ 是有效辐射强迫，单位为 $\\mathrm{W\\,m^{-2}}$；$\\lambda$ 是净气候反馈参数，单位为 $\\mathrm{W\\,m^{-2}\\,K^{-1}}$。对 $N$ 与 $\\Delta T_s$ 随时间的变化进行线性回归，可以得到截距 $F$ 和等于 $-\\lambda$ 的斜率。\n\n- 辐射核分解。辐射核是 TOA 辐射对状态变量微小扰动的敏感度。辐射核方法通过将辐射核与这些状态变量的模拟变化进行卷积，然后进行适当的积分和平均，来估算与非云状态变化相关的模拟辐射响应。对于本问题，您将获得预先聚合的、全球平均的非云辐射响应分量的时间序列，这些分量已经与 $N$ 采用相同的符号约定（向下为正），对应于：\n  - 普朗克，\n  - 递减率，\n  - 水汽，\n  - 地表反照率。\n  将在时间 $t$ 的这些分量之和记为 $R_{\\mathrm{nc}}(t)$，单位为 $\\mathrm{W\\,m^{-2}}$。在线性假设下，每个分量 $x$ 都可以通过 $R_x \\approx -\\lambda_x \\,\\Delta T_s$ 与一个反馈强度 $\\lambda_x$ 相关联，因此非云部分的总和满足 $R_{\\mathrm{nc}} \\approx -\\lambda_{\\mathrm{nc}}\\,\\Delta T_s$，其中 $\\lambda_{\\mathrm{nc}} = \\sum_x \\lambda_x$。\n\n- 云反馈定义。由云变化引起的净辐射响应为 $R_{\\mathrm{c}} \\equiv N - F - R_{\\mathrm{nc}}$。在同样的线性假设下，$R_{\\mathrm{c}} \\approx -\\lambda_{\\mathrm{c}}\\,\\Delta T_s$，且云反馈参数为 $\\lambda_{\\mathrm{c}} = \\lambda - \\lambda_{\\mathrm{nc}}$。\n\n对于每个测试用例，您的程序必须：\n1. 通过对 $N$ 与 $\\Delta T_s$ 进行普通最小二乘法（OLS）回归来估算 $\\lambda$，拟合 $N \\approx a + b\\,\\Delta T_s$；然后设 $\\lambda = -b$ 且 $F = a$。\n2. 将提供的非云分量时间序列相加形成 $R_{\\mathrm{nc}}$，对 $R_{\\mathrm{nc}}$ 与 $\\Delta T_s$ 进行 OLS 回归，即 $R_{\\mathrm{nc}} \\approx c + d\\,\\Delta T_s$，并设 $\\lambda_{\\mathrm{nc}} = -d$。您不需要显式使用 $c$。\n3. 计算 $\\lambda_{\\mathrm{c}} = \\lambda - \\lambda_{\\mathrm{nc}}$。\n4. 以 $\\mathrm{W\\,m^{-2}\\,K^{-1}}$ 为单位，报告 $\\lambda_{\\mathrm{c}}$，结果为浮点数，四舍五入到小数点后四位。\n\n所有回归必须是未加权的普通最小二乘法。如果您手动实现回归，请使用\n$$\nb = \\frac{\\sum_i (\\Delta T_{s,i}-\\overline{\\Delta T_s})(N_i-\\overline{N})}{\\sum_i (\\Delta T_{s,i}-\\overline{\\Delta T_s})^2}, \\quad a = \\overline{N} - b\\,\\overline{\\Delta T_s},\n$$\n对于斜率 $d$，用 $R_{\\mathrm{nc}}$ 替换 $N$ 进行类似计算。不涉及角度。所有物理量必须按其规定单位处理；仅报告 $\\lambda_{\\mathrm{c}}$ 的数值，四舍五入到小数点后四位，该数值隐含单位 $\\mathrm{W\\,m^{-2}\\,K^{-1}}$。\n\n测试集数据如下。每个测试用例提供 $\\Delta T_s$（单位为 $\\mathrm{K}$）、$N$（单位为 $\\mathrm{W\\,m^{-2}}$）的时间序列数组，以及四个由辐射核导出的非云分量（单位为 $\\mathrm{W\\,m^{-2}}$），这些分量已采用 TOA 净向下为正的符号约定。\n\n- 测试用例 1 (一般情况)：\n  - $\\Delta T_s = [\\,0.3,\\,0.6,\\,0.9,\\,1.2,\\,1.5\\,] \\ \\mathrm{K}$\n  - $N = [\\,7.04,\\,6.68,\\,6.32,\\,5.96,\\,5.60\\,] \\ \\mathrm{W\\,m^{-2}}$\n  - 普朗克 $= [\\,-0.96,\\,-1.92,\\,-2.88,\\,-3.84,\\,-4.80\\,] \\ \\mathrm{W\\,m^{-2}}$\n  - 递减率 $= [\\,0.24,\\,0.48,\\,0.72,\\,0.96,\\,1.20\\,] \\ \\mathrm{W\\,m^{-2}}$\n  - 水汽 $= [\\,0.45,\\,0.90,\\,1.35,\\,1.80,\\,2.25\\,] \\ \\mathrm{W\\,m^{-2}}$\n  - 地表反照率 $= [\\,-0.03,\\,-0.06,\\,-0.09,\\,-0.12,\\,-0.15\\,] \\ \\mathrm{W\\,m^{-2}}$\n\n- 测试用例 2 (非云部分近中性)：\n  - $\\Delta T_s = [\\,0.2,\\,0.5,\\,0.8,\\,1.1,\\,1.4\\,] \\ \\mathrm{K}$\n  - $N = [\\,6.80,\\,6.50,\\,6.20,\\,5.90,\\,5.60\\,] \\ \\mathrm{W\\,m^{-2}}$\n  - 普朗克 $= [\\,-0.38,\\,-0.95,\\,-1.52,\\,-2.09,\\,-2.66\\,] \\ \\mathrm{W\\,m^{-2}}$\n  - 递减率 $= [\\,0.20,\\,0.50,\\,0.80,\\,1.10,\\,1.40\\,] \\ \\mathrm{W\\,m^{-2}}$\n  - 水汽 $= [\\,0.16,\\,0.40,\\,0.64,\\,0.88,\\,1.12\\,] \\ \\mathrm{W\\,m^{-2}}$\n  - 地表反照率 $= [\\,0.00,\\,0.00,\\,0.00,\\,0.00,\\,0.00\\,] \\ \\mathrm{W\\,m^{-2}}$\n\n- 测试用例 3 (云反馈不稳定)：\n  - $\\Delta T_s = [\\,0.2,\\,0.4,\\,0.6,\\,0.8,\\,1.0\\,] \\ \\mathrm{K}$\n  - $N = [\\,6.90,\\,6.80,\\,6.70,\\,6.60,\\,6.50\\,] \\ \\mathrm{W\\,m^{-2}}$\n  - 普朗克 $= [\\,-0.64,\\,-1.28,\\,-1.92,\\,-2.56,\\,-3.20\\,] \\ \\mathrm{W\\,m^{-2}}$\n  - 递减率 $= [\\,0.22,\\,0.44,\\,0.66,\\,0.88,\\,1.10\\,] \\ \\mathrm{W\\,m^{-2}}$\n  - 水汽 $= [\\,0.18,\\,0.36,\\,0.54,\\,0.72,\\,0.90\\,] \\ \\mathrm{W\\,m^{-2}}$\n  - 地表反照率 $= [\\,0.00,\\,0.00,\\,0.00,\\,0.00,\\,0.00\\,] \\ \\mathrm{W\\,m^{-2}}$\n\n- 测试用例 4 (小 $\\Delta T_s$ 范围)：\n  - $\\Delta T_s = [\\,0.05,\\,0.10,\\,0.15,\\,0.20,\\,0.25\\,] \\ \\mathrm{K}$\n  - $N = [\\,7.225,\\,7.150,\\,7.075,\\,7.000,\\,6.925\\,] \\ \\mathrm{W\\,m^{-2}}$\n  - 普朗克 $= [\\,-0.14,\\,-0.28,\\,-0.42,\\,-0.56,\\,-0.70\\,] \\ \\mathrm{W\\,m^{-2}}$\n  - 递减率 $= [\\,0.04,\\,0.08,\\,0.12,\\,0.16,\\,0.20\\,] \\ \\mathrm{W\\,m^{-2}}$\n  - 水汽 $= [\\,0.03,\\,0.06,\\,0.09,\\,0.12,\\,0.15\\,] \\ \\mathrm{W\\,m^{-2}}$\n  - 地表反照率 $= [\\,0.00,\\,0.00,\\,0.00,\\,0.00,\\,0.00\\,] \\ \\mathrm{W\\,m^{-2}}$\n\n要求与交付物：\n- 按照描述实现 OLS 回归。不要使用任何外部数据或要求输入。\n- 对于每个测试用例，计算一个标量 $\\lambda_{\\mathrm{c}}$，单位为 $\\mathrm{W\\,m^{-2}\\,K^{-1}}$。\n- 最终输出格式：您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表，每个数字四舍五入到小数点后四位，不带单位（例如，$[\\,0.1234,\\,-0.5678,\\,\\ldots\\,]$）。\n\n您的程序必须是一个完整的、可运行的程序，并且不得提示输入。评分将检查单行输出是否与要求格式完全匹配，并且数值与所提供测试集的正确值相符。",
            "solution": "该问题被认为是有效的，因为它科学上基于既有的气候科学方法论，数学上是适定的，并提供了一套完整且明确的指令和数据。任务是从代表瞬时四倍二氧化碳（abrupt-$4\\times\\mathrm{CO_2}$）气候模型实验的合成数据中计算云反馈参数 $\\lambda_{\\mathrm{c}}$。计算过程通过结合辐射核分解实现 Gregory 回归方法。该过程包括三个主要步骤。\n\n首先，估算净气候反馈参数 $\\lambda$。假设大气层顶（TOA）净向下能量不平衡 $N$ 与全球平均地表气温异常 $\\Delta T_s$ 线性相关。该关系表示为：\n$$\nN(t) \\approx F - \\lambda\\,\\Delta T_s(t)\n$$\n其中 $F$ 是有效辐射强迫，$\\lambda$ 是净气候反馈参数，单位为 $\\mathrm{W\\,m^{-2}\\,K^{-1}}$。为了估算这些参数，我们对 $N$ 的时间序列与 $\\Delta T_s$ 的时间序列进行普通最小二乘法（OLS）回归，拟合模型 $N \\approx a + b\\,\\Delta T_s$。通过比较这两种形式，我们将斜率 $b$ 等同于 $-\\lambda$，因此 $\\lambda = -b$。截距 $a$ 对应于强迫 $F$。OLS 斜率 $b$ 的计算公式如下：\n$$\nb = \\frac{\\sum_{i=1}^{n} (\\Delta T_{s,i}-\\overline{\\Delta T_s})(N_i-\\overline{N})}{\\sum_{i=1}^{n} (\\Delta T_{s,i}-\\overline{\\Delta T_s})^2}\n$$\n其中 $\\overline{\\Delta T_s}$ 和 $\\overline{N}$ 分别是 $n$ 个数据点上相应变量的时间平均值。\n\n其次，确定总的非云反馈参数 $\\lambda_{\\mathrm{nc}}$。问题提供了由辐射核导出的非云过程引起的辐射响应的时间序列。这些分量是普朗克响应、递减率响应、水汽响应和地表反照率响应。它们的总和构成了总的非云辐射响应 $R_{\\mathrm{nc}}(t)$。\n$$\nR_{\\mathrm{nc}}(t) = R_{\\mathrm{Planck}}(t) + R_{\\mathrm{lapse-rate}}(t) + R_{\\mathrm{water\\,vapor}}(t) + R_{\\mathrm{albedo}}(t)\n$$\n与净反馈类似，总的非云反馈被假定与温度异常成线性比例关系，$R_{\\mathrm{nc}} \\approx -\\lambda_{\\mathrm{nc}}\\,\\Delta T_s$。我们通过进行第二次 OLS 回归来估算 $\\lambda_{\\mathrm{nc}}$，这次是对 $R_{\\mathrm{nc}}$ 与 $\\Delta T_s$ 进行回归，拟合模型 $R_{\\mathrm{nc}} \\approx c + d\\,\\Delta T_s$。斜率 $d$ 等同于 $-\\lambda_{\\mathrm{nc}}$，因此 $\\lambda_{\\mathrm{nc}} = -d$。斜率 $d$ 的计算公式与 $b$ 的类似：\n$$\nd = \\frac{\\sum_{i=1}^{n} (\\Delta T_{s,i}-\\overline{\\Delta T_s})(R_{\\mathrm{nc},i}-\\overline{R_{\\mathrm{nc}}})}{\\sum_{i=1}^{n} (\\Delta T_{s,i}-\\overline{\\Delta T_s})^2}\n$$\n其中 $\\overline{R_{\\mathrm{nc}}}$ 是总非云响应的时间平均值。\n\n第三，计算云反馈参数 $\\lambda_{\\mathrm{c}}$。总反馈参数 $\\lambda$ 可以分解为非云分量和云分量：\n$$\n\\lambda = \\lambda_{\\mathrm{nc}} + \\lambda_{\\mathrm{c}}\n$$\n这是辐射响应可加性的直接结果，$N - F \\approx R_{\\mathrm{nc}} + R_{\\mathrm{c}}$，其中 $R_{\\mathrm{c}}$ 是云辐射响应。通过重新排列方程，我们可以将云反馈参数分离出来，作为净反馈和非云反馈之间的差值：\n$$\n\\lambda_{\\mathrm{c}} = \\lambda - \\lambda_{\\mathrm{nc}}\n$$\n这是每个测试用例需要计算的最终量。实现过程将涉及定义一个函数，该函数根据提供的公式从两个数据序列计算 OLS 斜率，应用它来获得 $b$ 和 $d$，然后组合结果以找到 $\\lambda_{\\mathrm{c}}$。结果以 $\\mathrm{W\\,m^{-2}\\,K^{-1}}$ 为单位报告，并四舍五入到小数点后四位。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the cloud feedback parameter for a suite of test cases using\n    Gregory regression and radiative kernel decomposition.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"dTs\": [0.3, 0.6, 0.9, 1.2, 1.5],\n            \"N\": [7.04, 6.68, 6.32, 5.96, 5.60],\n            \"planck\": [-0.96, -1.92, -2.88, -3.84, -4.80],\n            \"lapse_rate\": [0.24, 0.48, 0.72, 0.96, 1.20],\n            \"water_vapor\": [0.45, 0.90, 1.35, 1.80, 2.25],\n            \"surface_albedo\": [-0.03, -0.06, -0.09, -0.12, -0.15],\n        },\n        {\n            \"dTs\": [0.2, 0.5, 0.8, 1.1, 1.4],\n            \"N\": [6.80, 6.50, 6.20, 5.90, 5.60],\n            \"planck\": [-0.38, -0.95, -1.52, -2.09, -2.66],\n            \"lapse_rate\": [0.20, 0.50, 0.80, 1.10, 1.40],\n            \"water_vapor\": [0.16, 0.40, 0.64, 0.88, 1.12],\n            \"surface_albedo\": [0.00, 0.00, 0.00, 0.00, 0.00],\n        },\n        {\n            \"dTs\": [0.2, 0.4, 0.6, 0.8, 1.0],\n            \"N\": [6.90, 6.80, 6.70, 6.60, 6.50],\n            \"planck\": [-0.64, -1.28, -1.92, -2.56, -3.20],\n            \"lapse_rate\": [0.22, 0.44, 0.66, 0.88, 1.10],\n            \"water_vapor\": [0.18, 0.36, 0.54, 0.72, 0.90],\n            \"surface_albedo\": [0.00, 0.00, 0.00, 0.00, 0.00],\n        },\n        {\n            \"dTs\": [0.05, 0.10, 0.15, 0.20, 0.25],\n            \"N\": [7.225, 7.150, 7.075, 7.000, 6.925],\n            \"planck\": [-0.14, -0.28, -0.42, -0.56, -0.70],\n            \"lapse_rate\": [0.04, 0.08, 0.12, 0.16, 0.20],\n            \"water_vapor\": [0.03, 0.06, 0.09, 0.12, 0.15],\n            \"surface_albedo\": [0.00, 0.00, 0.00, 0.00, 0.00],\n        },\n    ]\n\n    def calculate_ols_slope(x, y):\n        \"\"\"\n        Calculates the slope of a simple linear regression of y on x\n        using the formula provided in the problem description.\n        \n        Args:\n            x (np.ndarray): Independent variable.\n            y (np.ndarray): Dependent variable.\n            \n        Returns:\n            float: The slope of the regression line.\n        \"\"\"\n        x_mean = np.mean(x)\n        y_mean = np.mean(y)\n        \n        numerator = np.sum((x - x_mean) * (y - y_mean))\n        denominator = np.sum((x - x_mean)**2)\n        \n        # Avoid division by zero if all x values are the same.\n        if denominator == 0:\n            return 0.0\n            \n        return numerator / denominator\n\n    results = []\n    for case in test_cases:\n        # Convert lists to numpy arrays for vectorized operations\n        dTs = np.array(case[\"dTs\"])\n        N = np.array(case[\"N\"])\n        \n        # Step 1: Estimate the net feedback parameter lambda\n        # Fit N = a + b*dTs, then lambda = -b\n        b = calculate_ols_slope(dTs, N)\n        lambda_net = -b\n        \n        # Step 2: Estimate the non-cloud feedback parameter lambda_nc\n        # Sum the non-cloud components\n        R_nc = (np.array(case[\"planck\"]) + \n                np.array(case[\"lapse_rate\"]) + \n                np.array(case[\"water_vapor\"]) + \n                np.array(case[\"surface_albedo\"]))\n        \n        # Fit R_nc = c + d*dTs, then lambda_nc = -d\n        d = calculate_ols_slope(dTs, R_nc)\n        lambda_nc = -d\n        \n        # Step 3: Compute the cloud feedback parameter lambda_c\n        lambda_c = lambda_net - lambda_nc\n        \n        results.append(lambda_c)\n\n    # Final print statement in the exact required format.\n    # Format each result to four decimal places.\n    print(f\"[{','.join([f'{res:.4f}' for res in results])}]\")\n\nsolve()\n```"
        }
    ]
}