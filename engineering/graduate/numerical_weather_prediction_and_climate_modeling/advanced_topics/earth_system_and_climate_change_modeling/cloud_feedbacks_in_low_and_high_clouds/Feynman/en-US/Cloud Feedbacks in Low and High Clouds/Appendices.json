{
    "hands_on_practices": [
        {
            "introduction": "Understanding cloud feedbacks begins with the fundamental principle that clouds have competing effects on the Earth's energy budget. This exercise provides a direct, quantitative look at this \"tug-of-war\" by examining how changes in low and high cloud fractions separately impact the top-of-atmosphere net radiation, $F_{\\mathrm{net}}$. By applying a linear approximation, you will calculate the net warming or cooling effect, building a core intuition for why cloud altitude is a primary determinant of a cloud's climatic impact .",
            "id": "4022990",
            "problem": "Consider a global mean energy budget at the Top of Atmosphere (TOA), where the net downward radiative flux is defined as $F_{\\mathrm{net}} = F_{\\mathrm{SW,abs}} - F_{\\mathrm{LW,up}}$, with $F_{\\mathrm{SW,abs}}$ the net absorbed shortwave (SW) radiation and $F_{\\mathrm{LW,up}}$ the upwelling longwave (LW) radiation to space. Clouds modify $F_{\\mathrm{net}}$ through changes in reflection of SW radiation and trapping of LW radiation. For small perturbations in cloud fraction, a linearization around the baseline climate state is appropriate. Let the regime-specific sensitivities of $F_{\\mathrm{net}}$ to cloud fraction be given by constant partial derivatives (assumed valid locally in the perturbation regime).\n\nAssume the following representative, regime-averaged sensitivities of $F_{\\mathrm{net}}$ to cloud fraction:\n- Low clouds: $\\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{\\ell}} \\big|_{\\mathrm{SW}} = -110~\\mathrm{W\\,m^{-2}}$ per unit cloud fraction, and $\\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{\\ell}} \\big|_{\\mathrm{LW}} = +12~\\mathrm{W\\,m^{-2}}$ per unit cloud fraction.\n- High clouds: $\\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{h}} \\big|_{\\mathrm{SW}} = -70~\\mathrm{W\\,m^{-2}}$ per unit cloud fraction, and $\\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{h}} \\big|_{\\mathrm{LW}} = +95~\\mathrm{W\\,m^{-2}}$ per unit cloud fraction.\n\nHere, $C_{\\ell}$ and $C_{h}$ denote the global mean low-cloud and high-cloud fractions, respectively. The sign convention is that positive $\\Delta F_{\\mathrm{net}}$ corresponds to an increase in net downward TOA flux (a warming effect).\n\nSuppose the global mean low-cloud fraction decreases by $1\\%$ and the global mean high-cloud fraction increases by $0.5\\%$. Treat the perturbations as $\\Delta C_{\\ell}$ and $\\Delta C_{h}$ applied to the sensitivities above, and neglect any changes in surface albedo, atmospheric composition, and circulation other than the stated cloud fraction changes. Using the linear approximation, compute the net change $\\Delta F_{\\mathrm{net}}$ in units of $\\mathrm{W\\,m^{-2}}$, and round your answer to four significant figures. Express your final answer in $\\mathrm{W\\,m^{-2}}$.",
            "solution": "The problem asks for the net change in the global mean downward radiative flux at the Top of Atmosphere (TOA), $\\Delta F_{\\mathrm{net}}$, resulting from specified changes in low-cloud and high-cloud fractions. The net flux $F_{\\mathrm{net}}$ is a function of the low-cloud fraction, $C_{\\ell}$, and the high-cloud fraction, $C_{h}$. The problem states that a linear approximation is appropriate for the small perturbations given. This corresponds to using the total differential of $F_{\\mathrm{net}}$ to approximate the change $\\Delta F_{\\mathrm{net}}$.\n\nThe total differential of $F_{\\mathrm{net}}(C_{\\ell}, C_{h})$ is given by:\n$$\n\\Delta F_{\\mathrm{net}} \\approx \\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{\\ell}} \\Delta C_{\\ell} + \\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{h}} \\Delta C_{h}\n$$\nwhere $\\Delta C_{\\ell}$ and $\\Delta C_{h}$ are the changes in the respective cloud fractions. The problem assumes other variables are constant.\n\nThe total sensitivity of the net flux to a change in a given cloud type is the sum of its shortwave (SW) and longwave (LW) components. The problem provides these component sensitivities as constant partial derivatives.\n\nFirst, we calculate the total sensitivity for low clouds, $\\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{\\ell}}$. This is the sum of the SW and LW sensitivities:\n$$\n\\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{\\ell}} = \\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{\\ell}} \\bigg|_{\\mathrm{SW}} + \\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{\\ell}} \\bigg|_{\\mathrm{LW}}\n$$\nSubstituting the given values:\n$$\n\\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{\\ell}} = (-110~\\mathrm{W\\,m^{-2}}) + (12~\\mathrm{W\\,m^{-2}}) = -98~\\mathrm{W\\,m^{-2}}\n$$\nThis result indicates that an increase in low-cloud fraction leads to a net cooling effect (a decrease in net downward flux).\n\nNext, we calculate the total sensitivity for high clouds, $\\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{h}}$:\n$$\n\\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{h}} = \\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{h}} \\bigg|_{\\mathrm{SW}} + \\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{h}} \\bigg|_{\\mathrm{LW}}\n$$\nSubstituting the given values:\n$$\n\\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{h}} = (-70~\\mathrm{W\\,m^{-2}}) + (95~\\mathrm{W\\,m^{-2}}) = 25~\\mathrm{W\\,m^{-2}}\n$$\nThis result shows that an increase in high-cloud fraction leads to a net warming effect (an increase in net downward flux).\n\nThe problem specifies the changes in cloud fractions. A decrease of $1\\%$ in low-cloud fraction is represented as a change in the unit cloud fraction:\n$$\n\\Delta C_{\\ell} = -1\\% = -0.01\n$$\nAn increase of $0.5\\%$ in high-cloud fraction is represented as:\n$$\n\\Delta C_{h} = +0.5\\% = +0.005\n$$\n\nNow we can compute the total change $\\Delta F_{\\mathrm{net}}$ using the linear approximation. The change consists of the contribution from the change in low clouds and the contribution from the change in high clouds.\n\nContribution from low clouds, $\\Delta F_{\\mathrm{net}, \\ell}$:\n$$\n\\Delta F_{\\mathrm{net}, \\ell} = \\left( \\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{\\ell}} \\right) \\Delta C_{\\ell} = (-98~\\mathrm{W\\,m^{-2}}) \\times (-0.01) = 0.98~\\mathrm{W\\,m^{-2}}\n$$\nThe decrease in low clouds (which are net coolers) results in a positive flux change, i.e., a warming effect.\n\nContribution from high clouds, $\\Delta F_{\\mathrm{net}, h}$:\n$$\n\\Delta F_{\\mathrm{net}, h} = \\left( \\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{h}} \\right) \\Delta C_{h} = (25~\\mathrm{W\\,m^{-2}}) \\times (0.005) = 0.125~\\mathrm{W\\,m^{-2}}\n$$\nThe increase in high clouds (which are net warmers) results in a positive flux change, also a warming effect.\n\nThe total net change $\\Delta F_{\\mathrm{net}}$ is the sum of these two contributions:\n$$\n\\Delta F_{\\mathrm{net}} = \\Delta F_{\\mathrm{net}, \\ell} + \\Delta F_{\\mathrm{net}, h} = 0.98~\\mathrm{W\\,m^{-2}} + 0.125~\\mathrm{W\\,m^{-2}} = 1.105~\\mathrm{W\\,m^{-2}}\n$$\nThe problem requires the answer to be rounded to four significant figures. The calculated value of $1.105$ already has four significant figures, so no further rounding is necessary. The net effect of these cloud changes is a positive radiative forcing of $1.105~\\mathrm{W\\,m^{-2}}$.",
            "answer": "$$\n\\boxed{1.105}\n$$"
        },
        {
            "introduction": "Moving from macroscopic effects to their underlying causes, this practice explores the crucial link between cloud microphysics and radiative properties. The exercise focuses on a mixed-phase cloud, where the partitioning of water between small liquid droplets and larger ice crystals significantly alters the cloud's shortwave albedo $A$ and longwave emissivity $\\epsilon$. This calculation demonstrates the physical basis of the cloud phase feedback, a key process that climate models must accurately represent to project future warming .",
            "id": "4022978",
            "problem": "An overcast, horizontally homogeneous, plane-parallel mixed-phase cloud layer is embedded in a one-dimensional column used in numerical weather prediction and climate modeling. The total condensed water path is fixed at $W_{\\mathrm{tot}} = 0.05 \\ \\mathrm{kg} \\ \\mathrm{m}^{-2}$. Initially, the liquid fraction is $f_{\\ell,0} = 0.5$ and the ice fraction is $f_{i,0} = 1 - f_{\\ell,0}$. The cloud liquid effective radius is $r_{e,\\ell} = 10 \\ \\mu\\mathrm{m}$, the cloud ice effective radius is $r_{e,i} = 30 \\ \\mu\\mathrm{m}$, the bulk density of liquid water is $\\rho_{w} = 1000 \\ \\mathrm{kg} \\ \\mathrm{m}^{-3}$, and the bulk density of ice is $\\rho_{i} = 917 \\ \\mathrm{kg} \\ \\mathrm{m}^{-3}$. The cloud-top temperature is $T_{c} = 260 \\ \\mathrm{K}$ and the surface temperature is $T_{s} = 288 \\ \\mathrm{K}$. The Top of Atmosphere (TOA) downwelling shortwave flux is $F_{SW}^{\\downarrow} = 340 \\ \\mathrm{W} \\ \\mathrm{m}^{-2}$, and the Stefanâ€“Boltzmann constant is $\\sigma = 5.670374419 \\times 10^{-8} \\ \\mathrm{W} \\ \\mathrm{m}^{-2} \\ \\mathrm{K}^{-4}$.\n\nA microphysical perturbation increases the liquid fraction by $20\\%$, so $f_{\\ell,1} = 1.2 f_{\\ell,0}$ with $W_{\\mathrm{tot}}$ held fixed, and $f_{i,1} = 1 - f_{\\ell,1}$. Assume:\n\n- For broadband shortwave, the layer optical depth for each phase is given by the well-tested geometric-optics result for spheres and effective radii, $\\tau_{\\ell} = \\dfrac{3 W_{\\ell}}{2 \\rho_{w} r_{e,\\ell}}$ and $\\tau_{i} = \\dfrac{3 W_{i}}{2 \\rho_{i} r_{e,i}}$, so the total shortwave optical depth is $\\tau = \\tau_{\\ell} + \\tau_{i}$.\n- In the two-stream Eddington closure for broadband shortwave with typical liquid and ice single-scattering properties, the cloud albedo can be represented as a rational function of optical depth, $A(\\tau) = \\dfrac{\\tau}{\\tau + \\Gamma}$, with a closure constant $\\Gamma = 7.7$ appropriate for plane-parallel overcast clouds under representative solar illumination.\n- In broadband longwave (thermal infrared), adopt a grey approximation in which the cloud layer emissivity is $\\epsilon = 1 - \\exp\\!\\big(-\\kappa_{\\ell}^{LW} W_{\\ell} - \\kappa_{i}^{LW} W_{i}\\big)$, with phase-dependent mass absorption coefficients $\\kappa_{\\ell}^{LW} = 30 \\ \\mathrm{m}^{2} \\ \\mathrm{kg}^{-1}$ and $\\kappa_{i}^{LW} = 20 \\ \\mathrm{m}^{2} \\ \\mathrm{kg}^{-1}$.\n\nStarting from these fundamental definitions and closures, compute:\n\n1. The change in shortwave albedo $\\Delta A = A_{1} - A_{0}$ caused by increasing the liquid fraction from $f_{\\ell,0}$ to $f_{\\ell,1}$ at fixed $W_{\\mathrm{tot}}$.\n2. The change in longwave emissivity $\\Delta \\epsilon = \\epsilon_{1} - \\epsilon_{0}$ for the same perturbation.\n\nThen, using the definition of TOA net downward radiative flux $N = F_{SW}^{\\downarrow} - F_{SW}^{\\uparrow} - F_{LW}^{\\uparrow}$, and modeling the upward longwave flux at TOA for the overcast column as $F_{LW}^{\\uparrow} = \\epsilon \\sigma T_{c}^{4} + (1 - \\epsilon) \\sigma T_{s}^{4}$, compute the net change in TOA downward flux $\\Delta N$ due to the perturbation in liquid fraction. Take $F_{SW}^{\\uparrow} = F_{SW}^{\\downarrow} A(\\tau)$ for the overcast layer. Report the single value $\\Delta N$.\n\nRound your final reported value of $\\Delta N$ to three significant figures and express it in $\\mathrm{W} \\ \\mathrm{m}^{-2}$. State clearly whether the sign of $\\Delta N$ implies a net warming (positive $\\Delta N$) or net cooling (negative $\\Delta N$) cloud feedback under this perturbation.",
            "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It is a standard calculation in atmospheric radiative transfer and cloud physics. All necessary parameters are provided, and the models used are well-established approximations in the field.\n\nThe solution proceeds by first calculating the radiative properties of the cloud in its initial state (state $0$) and its perturbed state (state $1$). Then, the changes in these properties are used to compute the net change in the Top of Atmosphere (TOA) downward radiative flux.\n\n**1. Initial State (State 0)**\n\nThe initial liquid fraction is $f_{\\ell,0} = 0.5$, and the initial ice fraction is $f_{i,0} = 1 - f_{\\ell,0} = 0.5$. The total condensed water path is fixed at $W_{\\mathrm{tot}} = 0.05 \\ \\mathrm{kg} \\ \\mathrm{m}^{-2}$.\nThe initial liquid water path ($W_{\\ell,0}$) and ice water path ($W_{i,0}$) are:\n$$W_{\\ell,0} = f_{\\ell,0} W_{\\mathrm{tot}} = 0.5 \\times 0.05 \\ \\mathrm{kg} \\ \\mathrm{m}^{-2} = 0.025 \\ \\mathrm{kg} \\ \\mathrm{m}^{-2}$$\n$$W_{i,0} = f_{i,0} W_{\\mathrm{tot}} = 0.5 \\times 0.05 \\ \\mathrm{kg} \\ \\mathrm{m}^{-2} = 0.025 \\ \\mathrm{kg} \\ \\mathrm{m}^{-2}$$\n\nThe shortwave optical depths for the liquid ($\\tau_{\\ell,0}$) and ice ($\\tau_{i,0}$) phases are calculated using the given formulas, with effective radii $r_{e,\\ell} = 10 \\ \\mu\\mathrm{m} = 10 \\times 10^{-6} \\ \\mathrm{m}$ and $r_{e,i} = 30 \\ \\mu\\mathrm{m} = 30 \\times 10^{-6} \\ \\mathrm{m}$, and densities $\\rho_{w} = 1000 \\ \\mathrm{kg} \\ \\mathrm{m}^{-3}$ and $\\rho_{i} = 917 \\ \\mathrm{kg} \\ \\mathrm{m}^{-3}$.\n$$\\tau_{\\ell,0} = \\frac{3 W_{\\ell,0}}{2 \\rho_{w} r_{e,\\ell}} = \\frac{3 \\times 0.025 \\ \\mathrm{kg} \\ \\mathrm{m}^{-2}}{2 \\times 1000 \\ \\mathrm{kg} \\ \\mathrm{m}^{-3} \\times 10 \\times 10^{-6} \\ \\mathrm{m}} = \\frac{0.075}{0.02} = 3.75$$\n$$\\tau_{i,0} = \\frac{3 W_{i,0}}{2 \\rho_{i} r_{e,i}} = \\frac{3 \\times 0.025 \\ \\mathrm{kg} \\ \\mathrm{m}^{-2}}{2 \\times 917 \\ \\mathrm{kg} \\ \\mathrm{m}^{-3} \\times 30 \\times 10^{-6} \\ \\mathrm{m}} = \\frac{0.075}{0.05502} \\approx 1.36314$$\nThe total initial shortwave optical depth is $\\tau_0 = \\tau_{\\ell,0} + \\tau_{i,0} = 3.75 + 1.36314 = 5.11314$.\n\nThe initial albedo, $A_0$, is computed using the provided rational function with $\\Gamma = 7.7$:\n$$A_0 = \\frac{\\tau_0}{\\tau_0 + \\Gamma} = \\frac{5.11314}{5.11314 + 7.7} = \\frac{5.11314}{12.81314} \\approx 0.39904$$\n\nThe initial longwave emissivity, $\\epsilon_0$, is calculated using the given mass absorption coefficients $\\kappa_{\\ell}^{LW} = 30 \\ \\mathrm{m}^{2} \\ \\mathrm{kg}^{-1}$ and $\\kappa_{i}^{LW} = 20 \\ \\mathrm{m}^{2} \\ \\mathrm{kg}^{-1}$:\n$$\\epsilon_0 = 1 - \\exp(-\\kappa_{\\ell}^{LW} W_{\\ell,0} - \\kappa_{i}^{LW} W_{i,0}) = 1 - \\exp(-(30 \\times 0.025 + 20 \\times 0.025))$$\n$$\\epsilon_0 = 1 - \\exp(-(0.75 + 0.5)) = 1 - \\exp(-1.25) \\approx 1 - 0.28650 = 0.71350$$\n\n**2. Perturbed State (State 1)**\n\nThe liquid fraction is increased by $20\\%$, so $f_{\\ell,1} = 1.2 f_{\\ell,0} = 1.2 \\times 0.5 = 0.6$. The ice fraction adjusts to conserve total water, so $f_{i,1} = 1 - f_{\\ell,1} = 1 - 0.6 = 0.4$.\nThe new liquid and ice water paths are:\n$$W_{\\ell,1} = f_{\\ell,1} W_{\\mathrm{tot}} = 0.6 \\times 0.05 \\ \\mathrm{kg} \\ \\mathrm{m}^{-2} = 0.03 \\ \\mathrm{kg} \\ \\mathrm{m}^{-2}$$\n$$W_{i,1} = f_{i,1} W_{\\mathrm{tot}} = 0.4 \\times 0.05 \\ \\mathrm{kg} \\ \\mathrm{m}^{-2} = 0.02 \\ \\mathrm{kg} \\ \\mathrm{m}^{-2}$$\n\nThe new optical depths are:\n$$\\tau_{\\ell,1} = \\frac{3 W_{\\ell,1}}{2 \\rho_{w} r_{e,\\ell}} = \\frac{3 \\times 0.03 \\ \\mathrm{kg} \\ \\mathrm{m}^{-2}}{2 \\times 1000 \\ \\mathrm{kg} \\ \\mathrm{m}^{-3} \\times 10 \\times 10^{-6} \\ \\mathrm{m}} = \\frac{0.09}{0.02} = 4.5$$\n$$\\tau_{i,1} = \\frac{3 W_{i,1}}{2 \\rho_{i} r_{e,i}} = \\frac{3 \\times 0.02 \\ \\mathrm{kg} \\ \\mathrm{m}^{-2}}{2 \\times 917 \\ \\mathrm{kg} \\ \\mathrm{m}^{-3} \\times 30 \\times 10^{-6} \\ \\mathrm{m}} = \\frac{0.06}{0.05502} \\approx 1.09051$$\nThe total perturbed optical depth is $\\tau_1 = \\tau_{\\ell,1} + \\tau_{i,1} = 4.5 + 1.09051 = 5.59051$.\n\nThe new albedo, $A_1$, is:\n$$A_1 = \\frac{\\tau_1}{\\tau_1 + \\Gamma} = \\frac{5.59051}{5.59051 + 7.7} = \\frac{5.59051}{13.29051} \\approx 0.42064$$\n\nThe new emissivity, $\\epsilon_1$, is:\n$$\\epsilon_1 = 1 - \\exp(-\\kappa_{\\ell}^{LW} W_{\\ell,1} - \\kappa_{i}^{LW} W_{i,1}) = 1 - \\exp(-(30 \\times 0.03 + 20 \\times 0.02))$$\n$$\\epsilon_1 = 1 - \\exp(-(0.9 + 0.4)) = 1 - \\exp(-1.3) \\approx 1 - 0.27253 = 0.72747$$\n\n**3. Change in TOA Net Downward Flux ($\\Delta N$)**\n\nThe change in shortwave albedo is:\n$$\\Delta A = A_1 - A_0 = 0.42064 - 0.39904 = 0.0216$$\nThe change in longwave emissivity is:\n$$\\Delta \\epsilon = \\epsilon_1 - \\epsilon_0 = 0.72747 - 0.71350 = 0.01397$$\n\nThe TOA net downward radiative flux is $N = F_{SW}^{\\downarrow} - F_{SW}^{\\uparrow} - F_{LW}^{\\uparrow}$.\nUsing the given models, $F_{SW}^{\\uparrow} = F_{SW}^{\\downarrow} A$ and $F_{LW}^{\\uparrow} = \\epsilon \\sigma T_{c}^{4} + (1 - \\epsilon) \\sigma T_{s}^{4}$, we have:\n$$N = F_{SW}^{\\downarrow}(1 - A) - \\left( \\epsilon \\sigma T_{c}^{4} + (1 - \\epsilon) \\sigma T_{s}^{4} \\right)$$\nThe change in net flux, $\\Delta N = N_1 - N_0$, is:\n$$\\Delta N = \\left[ F_{SW}^{\\downarrow}(1 - A_1) - \\left( \\epsilon_1 \\sigma T_{c}^{4} + (1 - \\epsilon_1) \\sigma T_{s}^{4} \\right) \\right] - \\left[ F_{SW}^{\\downarrow}(1 - A_0) - \\left( \\epsilon_0 \\sigma T_{c}^{4} + (1 - \\epsilon_0) \\sigma T_{s}^{4} \\right) \\right]$$\n$$\\Delta N = -F_{SW}^{\\downarrow}(A_1 - A_0) - \\left[ (\\epsilon_1 - \\epsilon_0)\\sigma T_{c}^{4} - (\\epsilon_1 - \\epsilon_0)\\sigma T_{s}^{4} \\right]$$\n$$\\Delta N = -F_{SW}^{\\downarrow}\\Delta A - \\Delta \\epsilon \\sigma (T_{c}^{4} - T_{s}^{4})$$\n\nThis expression separates the change in TOA net flux into a shortwave component (due to albedo change) and a longwave component (due to emissivity change).\nGiven $F_{SW}^{\\downarrow} = 340 \\ \\mathrm{W} \\ \\mathrm{m}^{-2}$, $\\sigma = 5.670374419 \\times 10^{-8} \\ \\mathrm{W} \\ \\mathrm{m}^{-2} \\ \\mathrm{K}^{-4}$, $T_c = 260 \\ \\mathrm{K}$, and $T_s = 288 \\ \\mathrm{K}$.\n\nThe shortwave component of the change is:\n$$\\Delta N_{SW} = -F_{SW}^{\\downarrow}\\Delta A = -340 \\ \\mathrm{W} \\ \\mathrm{m}^{-2} \\times 0.0216 = -7.344 \\ \\mathrm{W} \\ \\mathrm{m}^{-2}$$\nThis is a cooling effect because the albedo has increased.\n\nThe longwave component of the change is:\n$$\\Delta N_{LW} = -\\Delta \\epsilon \\sigma (T_{c}^{4} - T_{s}^{4})$$\n$$T_{c}^{4} = (260 \\ \\mathrm{K})^4 = 4.56976 \\times 10^9 \\ \\mathrm{K}^4$$\n$$T_{s}^{4} = (288 \\ \\mathrm{K})^4 \\approx 6.87971 \\times 10^9 \\ \\mathrm{K}^4$$\n$$\\Delta N_{LW} = -0.01397 \\times (5.67037 \\times 10^{-8}) \\times (4.56976 \\times 10^9 - 6.87971 \\times 10^9) \\ \\mathrm{W} \\ \\mathrm{m}^{-2}$$\n$$\\Delta N_{LW} = -0.01397 \\times (5.67037 \\times 10^{-8}) \\times (-2.30995 \\times 10^9) \\ \\mathrm{W} \\ \\mathrm{m}^{-2} \\approx 1.8318 \\ \\mathrm{W} \\ \\mathrm{m}^{-2}$$\nThis is a warming effect because the cloud's increased emissivity traps more of the thermal radiation emitted from the warmer surface.\n\nThe total change in net TOA downward flux is the sum of the components:\n$$\\Delta N = \\Delta N_{SW} + \\Delta N_{LW} = -7.344 \\ \\mathrm{W} \\ \\mathrm{m}^{-2} + 1.8318 \\ \\mathrm{W} \\ \\mathrm{m}^{-2} = -5.5122 \\ \\mathrm{W} \\ \\mathrm{m}^{-2}$$\n\nRounding to three significant figures, we get $\\Delta N = -5.51 \\ \\mathrm{W} \\ \\mathrm{m}^{-2}$.\n\nThe sign of $\\Delta N$ is negative, which indicates a decrease in the net downward radiative flux at the top of the atmosphere. This means more energy is leaving the Earth-atmosphere system than before the perturbation. Therefore, this change represents a net cooling feedback. The increased reflection of shortwave radiation (cooling) dominates over the increased trapping of longwave radiation (warming).",
            "answer": "$$\n\\boxed{-5.51}\n$$"
        },
        {
            "introduction": "This practice transitions from theoretical calculations to a powerful diagnostic technique used in modern climate science to analyze output from complex climate models. You will implement the Gregory regression method to estimate the total climate feedback parameter, $\\lambda$, from a simulated time series of radiative imbalance $N$ and surface temperature change $\\Delta T_s$. By further employing the radiative kernel method to subtract non-cloud contributions, you will learn how to isolate the cloud feedback parameter, $\\lambda_c$, a critical step in model evaluation and intercomparison .",
            "id": "4022996",
            "problem": "You are asked to implement an algorithm that estimates the cloud feedback parameter using the radiative kernel decomposition alongside a Gregory regression in an abrupt-$4\\times\\mathrm{CO_2}$ experiment. Your program must compute the cloud feedback parameter from a small test suite of synthetic yet physically consistent experiments, and output the results in a single line.\n\nThe goal is to formalize, implement, and verify the following approach.\n\n- Base energy balance. Let the globally averaged top-of-atmosphere (TOA) net downward energy imbalance be denoted by $N$ in units of $\\mathrm{W\\,m^{-2}}$. Consider the widely used Gregory regression framework, which assumes an approximate linear relationship between $N$ and the global-mean surface air temperature anomaly $\\Delta T_s$ in units of $\\mathrm{K}$:\n$$\nN \\approx F - \\lambda\\,\\Delta T_s,\n$$\nwhere $F$ is the effective radiative forcing in units of $\\mathrm{W\\,m^{-2}}$ and $\\lambda$ is the net climate feedback parameter in units of $\\mathrm{W\\,m^{-2}\\,K^{-1}}$. A linear regression of $N$ versus $\\Delta T_s$ over time yields an intercept $F$ and a slope equal to $-\\lambda$.\n\n- Radiative kernel decomposition. A radiative kernel is a sensitivity of TOA radiation to a small perturbation in a state variable. The radiative kernel method estimates the simulated radiative response associated with non-cloud state changes by convolving kernels with the simulated changes in those state variables, then integrating and averaging appropriately. For this problem, you are given pre-aggregated, global-mean, time series of non-cloud radiative response components that are already in the same sign convention as $N$ (positive downward), corresponding to:\n  - Planck,\n  - Lapse-rate,\n  - Water vapor,\n  - Surface albedo.\n  Denote the sum of these components at time $t$ by $R_{\\mathrm{nc}}(t)$ in units of $\\mathrm{W\\,m^{-2}}$. Under linearity, each component can be associated with a feedback strength $\\lambda_x$ via $R_x \\approx -\\lambda_x \\,\\Delta T_s$, so that the non-cloud total satisfies $R_{\\mathrm{nc}} \\approx -\\lambda_{\\mathrm{nc}}\\,\\Delta T_s$, where $\\lambda_{\\mathrm{nc}} = \\sum_x \\lambda_x$.\n\n- Cloud feedback definition. The net radiative response due to cloud changes is $R_{\\mathrm{c}} \\equiv N - F - R_{\\mathrm{nc}}$. Under the same linearity assumption, $R_{\\mathrm{c}} \\approx -\\lambda_{\\mathrm{c}}\\,\\Delta T_s$, and the cloud feedback parameter is $\\lambda_{\\mathrm{c}} = \\lambda - \\lambda_{\\mathrm{nc}}$.\n\nYour program must, for each test case:\n1. Estimate $\\lambda$ by ordinary least squares (OLS) regression of $N$ on $\\Delta T_s$, fitting $N \\approx a + b\\,\\Delta T_s$; then set $\\lambda = -b$ and $F = a$.\n2. Sum the provided non-cloud component time series to form $R_{\\mathrm{nc}}$, perform an OLS regression of $R_{\\mathrm{nc}}$ on $\\Delta T_s$, i.e., $R_{\\mathrm{nc}} \\approx c + d\\,\\Delta T_s$, and set $\\lambda_{\\mathrm{nc}} = -d$. You do not need to use $c$ explicitly.\n3. Compute $\\lambda_{\\mathrm{c}} = \\lambda - \\lambda_{\\mathrm{nc}}$.\n4. Report $\\lambda_{\\mathrm{c}}$ in units of $\\mathrm{W\\,m^{-2}\\,K^{-1}}$ as a float rounded to four decimal places.\n\nAll regressions must be unweighted ordinary least squares. If you implement the regression by hand, use\n$$\nb = \\frac{\\sum_i (\\Delta T_{s,i}-\\overline{\\Delta T_s})(N_i-\\overline{N})}{\\sum_i (\\Delta T_{s,i}-\\overline{\\Delta T_s})^2}, \\quad a = \\overline{N} - b\\,\\overline{\\Delta T_s},\n$$\nand similarly for the slope $d$ replacing $N$ with $R_{\\mathrm{nc}}$. Angles are not involved. All physical quantities must be treated with their units as stated; report only the numerical values of $\\lambda_{\\mathrm{c}}$ rounded to four decimals, which implicitly carry units of $\\mathrm{W\\,m^{-2}\\,K^{-1}}$.\n\nTest suite data are given below. Each test case provides time series arrays of $\\Delta T_s$ in $\\mathrm{K}$, $N$ in $\\mathrm{W\\,m^{-2}}$, and the four non-cloud kernel-derived components in $\\mathrm{W\\,m^{-2}}$ that already share the TOA net downward positive sign convention.\n\n- Test case 1 (general case):\n  - $\\Delta T_s = [\\,0.3,\\,0.6,\\,0.9,\\,1.2,\\,1.5\\,] \\ \\mathrm{K}$\n  - $N = [\\,7.04,\\,6.68,\\,6.32,\\,5.96,\\,5.60\\,] \\ \\mathrm{W\\,m^{-2}}$\n  - Planck $= [\\,-0.96,\\,-1.92,\\,-2.88,\\,-3.84,\\,-4.80\\,] \\ \\mathrm{W\\,m^{-2}}$\n  - Lapse-rate $= [\\,0.24,\\,0.48,\\,0.72,\\,0.96,\\,1.20\\,] \\ \\mathrm{W\\,m^{-2}}$\n  - Water vapor $= [\\,0.45,\\,0.90,\\,1.35,\\,1.80,\\,2.25\\,] \\ \\mathrm{W\\,m^{-2}}$\n  - Surface albedo $= [\\,-0.03,\\,-0.06,\\,-0.09,\\,-0.12,\\,-0.15\\,] \\ \\mathrm{W\\,m^{-2}}$\n\n- Test case 2 (non-cloud nearly neutral):\n  - $\\Delta T_s = [\\,0.2,\\,0.5,\\,0.8,\\,1.1,\\,1.4\\,] \\ \\mathrm{K}$\n  - $N = [\\,6.80,\\,6.50,\\,6.20,\\,5.90,\\,5.60\\,] \\ \\mathrm{W\\,m^{-2}}$\n  - Planck $= [\\,-0.38,\\,-0.95,\\,-1.52,\\,-2.09,\\,-2.66\\,] \\ \\mathrm{W\\,m^{-2}}$\n  - Lapse-rate $= [\\,0.20,\\,0.50,\\,0.80,\\,1.10,\\,1.40\\,] \\ \\mathrm{W\\,m^{-2}}$\n  - Water vapor $= [\\,0.16,\\,0.40,\\,0.64,\\,0.88,\\,1.12\\,] \\ \\mathrm{W\\,m^{-2}}$\n  - Surface albedo $= [\\,0.00,\\,0.00,\\,0.00,\\,0.00,\\,0.00\\,] \\ \\mathrm{W\\,m^{-2}}$\n\n- Test case 3 (cloud feedback destabilizing):\n  - $\\Delta T_s = [\\,0.2,\\,0.4,\\,0.6,\\,0.8,\\,1.0\\,] \\ \\mathrm{K}$\n  - $N = [\\,6.90,\\,6.80,\\,6.70,\\,6.60,\\,6.50\\,] \\ \\mathrm{W\\,m^{-2}}$\n  - Planck $= [\\,-0.64,\\,-1.28,\\,-1.92,\\,-2.56,\\,-3.20\\,] \\ \\mathrm{W\\,m^{-2}}$\n  - Lapse-rate $= [\\,0.22,\\,0.44,\\,0.66,\\,0.88,\\,1.10\\,] \\ \\mathrm{W\\,m^{-2}}$\n  - Water vapor $= [\\,0.18,\\,0.36,\\,0.54,\\,0.72,\\,0.90\\,] \\ \\mathrm{W\\,m^{-2}}$\n  - Surface albedo $= [\\,0.00,\\,0.00,\\,0.00,\\,0.00,\\,0.00\\,] \\ \\mathrm{W\\,m^{-2}}$\n\n- Test case 4 (small $\\Delta T_s$ range):\n  - $\\Delta T_s = [\\,0.05,\\,0.10,\\,0.15,\\,0.20,\\,0.25\\,] \\ \\mathrm{K}$\n  - $N = [\\,7.225,\\,7.150,\\,7.075,\\,7.000,\\,6.925\\,] \\ \\mathrm{W\\,m^{-2}}$\n  - Planck $= [\\,-0.14,\\,-0.28,\\,-0.42,\\,-0.56,\\,-0.70\\,] \\ \\mathrm{W\\,m^{-2}}$\n  - Lapse-rate $= [\\,0.04,\\,0.08,\\,0.12,\\,0.16,\\,0.20\\,] \\ \\mathrm{W\\,m^{-2}}$\n  - Water vapor $= [\\,0.03,\\,0.06,\\,0.09,\\,0.12,\\,0.15\\,] \\ \\mathrm{W\\,m^{-2}}$\n  - Surface albedo $= [\\,0.00,\\,0.00,\\,0.00,\\,0.00,\\,0.00\\,] \\ \\mathrm{W\\,m^{-2}}$\n\nRequirements and deliverables:\n- Implement OLS regressions as described. Do not use any external data or require input.\n- For each test case, compute a single scalar $\\lambda_{\\mathrm{c}}$ in $\\mathrm{W\\,m^{-2}\\,K^{-1}}$.\n- Final output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each number rounded to four decimal places and no units (for example, $[\\,0.1234,\\,-0.5678,\\,\\ldots\\,]$).\n\nYour program must be a complete, runnable program and must not prompt for input. The grading will check that the single line of output exactly matches the required format and the numerically correct values for the supplied test suite.",
            "solution": "The problem is deemed valid as it is scientifically grounded in established climate science methodologies, is mathematically well-posed, and provides a complete and unambiguous set of instructions and data. The task is to compute the cloud feedback parameter, $\\lambda_{\\mathrm{c}}$, from synthetic data representing an abrupt-$4\\times\\mathrm{CO_2}$ climate model experiment. The calculation proceeds by implementing the Gregory regression method in conjunction with a radiative kernel decomposition. The procedure involves three primary steps.\n\nFirst, the net climate feedback parameter, $\\lambda$, is estimated. The top-of-atmosphere (TOA) net downward energy imbalance, $N$, is assumed to be linearly related to the global-mean surface air temperature anomaly, $\\Delta T_s$. This relationship is expressed as:\n$$\nN(t) \\approx F - \\lambda\\,\\Delta T_s(t)\n$$\nwhere $F$ is the effective radiative forcing and $\\lambda$ is the net climate feedback parameter in units of $\\mathrm{W\\,m^{-2}\\,K^{-1}}$. To estimate these parameters, we perform an ordinary least squares (OLS) regression of the time series of $N$ on the time series of $\\Delta T_s$, fitting the model $N \\approx a + b\\,\\Delta T_s$. By comparing the two forms, we identify the slope $b$ with $-\\lambda$, thus $\\lambda = -b$. The intercept $a$ corresponds to the forcing $F$. The formula for the OLS slope $b$ is given by:\n$$\nb = \\frac{\\sum_{i=1}^{n} (\\Delta T_{s,i}-\\overline{\\Delta T_s})(N_i-\\overline{N})}{\\sum_{i=1}^{n} (\\Delta T_{s,i}-\\overline{\\Delta T_s})^2}\n$$\nwhere $\\overline{\\Delta T_s}$ and $\\overline{N}$ are the time-averaged means of the respective variables over the $n$ data points.\n\nSecond, the total non-cloud feedback parameter, $\\lambda_{\\mathrm{nc}}$, is determined. The problem provides time series for the radiative responses due to non-cloud processes, derived from radiative kernels. These components are the Planck response, the lapse-rate response, the water vapor response, and the surface albedo response. Their sum constitutes the total non-cloud radiative response, $R_{\\mathrm{nc}}(t)$.\n$$\nR_{\\mathrm{nc}}(t) = R_{\\mathrm{Planck}}(t) + R_{\\mathrm{lapse-rate}}(t) + R_{\\mathrm{water\\,vapor}}(t) + R_{\\mathrm{albedo}}(t)\n$$\nAnalogous to the net feedback, the total non-cloud feedback is assumed to be linearly proportional to the temperature anomaly, $R_{\\mathrm{nc}} \\approx -\\lambda_{\\mathrm{nc}}\\,\\Delta T_s$. We estimate $\\lambda_{\\mathrm{nc}}$ by performing a second OLS regression, this time of $R_{\\mathrm{nc}}$ on $\\Delta T_s$, fitting the model $R_{\\mathrm{nc}} \\approx c + d\\,\\Delta T_s$. The slope $d$ is identified with $-\\lambda_{\\mathrm{nc}}$, so $\\lambda_{\\mathrm{nc}} = -d$. The formula for the slope $d$ is analogous to that for $b$:\n$$\nd = \\frac{\\sum_{i=1}^{n} (\\Delta T_{s,i}-\\overline{\\Delta T_s})(R_{\\mathrm{nc},i}-\\overline{R_{\\mathrm{nc}}})}{\\sum_{i=1}^{n} (\\Delta T_{s,i}-\\overline{\\Delta T_s})^2}\n$$\nwhere $\\overline{R_{\\mathrm{nc}}}$ is the time-averaged mean of the total non-cloud response.\n\nThird, the cloud feedback parameter, $\\lambda_{\\mathrm{c}}$, is calculated. The total feedback parameter $\\lambda$ can be decomposed into its non-cloud and cloud components:\n$$\n\\lambda = \\lambda_{\\mathrm{nc}} + \\lambda_{\\mathrm{c}}\n$$\nThis is a direct consequence of the additivity of radiative responses, $N - F \\approx R_{\\mathrm{nc}} + R_{\\mathrm{c}}$, where $R_{\\mathrm{c}}$ is the cloud radiative response. By rearranging the equation, we can isolate the cloud feedback parameter as the difference between the net feedback and the non-cloud feedback:\n$$\n\\lambda_{\\mathrm{c}} = \\lambda - \\lambda_{\\mathrm{nc}}\n$$\nThis is the final quantity to be computed for each test case. The implementation will involve defining a function that calculates the OLS slope from two data series according to the provided formula, applying it to obtain $b$ and $d$, and then combining the results to find $\\lambda_{\\mathrm{c}}$. The results are to be reported in units of $\\mathrm{W\\,m^{-2}\\,K^{-1}}$, rounded to four decimal places.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the cloud feedback parameter for a suite of test cases using\n    Gregory regression and radiative kernel decomposition.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"dTs\": [0.3, 0.6, 0.9, 1.2, 1.5],\n            \"N\": [7.04, 6.68, 6.32, 5.96, 5.60],\n            \"planck\": [-0.96, -1.92, -2.88, -3.84, -4.80],\n            \"lapse_rate\": [0.24, 0.48, 0.72, 0.96, 1.20],\n            \"water_vapor\": [0.45, 0.90, 1.35, 1.80, 2.25],\n            \"surface_albedo\": [-0.03, -0.06, -0.09, -0.12, -0.15],\n        },\n        {\n            \"dTs\": [0.2, 0.5, 0.8, 1.1, 1.4],\n            \"N\": [6.80, 6.50, 6.20, 5.90, 5.60],\n            \"planck\": [-0.38, -0.95, -1.52, -2.09, -2.66],\n            \"lapse_rate\": [0.20, 0.50, 0.80, 1.10, 1.40],\n            \"water_vapor\": [0.16, 0.40, 0.64, 0.88, 1.12],\n            \"surface_albedo\": [0.00, 0.00, 0.00, 0.00, 0.00],\n        },\n        {\n            \"dTs\": [0.2, 0.4, 0.6, 0.8, 1.0],\n            \"N\": [6.90, 6.80, 6.70, 6.60, 6.50],\n            \"planck\": [-0.64, -1.28, -1.92, -2.56, -3.20],\n            \"lapse_rate\": [0.22, 0.44, 0.66, 0.88, 1.10],\n            \"water_vapor\": [0.18, 0.36, 0.54, 0.72, 0.90],\n            \"surface_albedo\": [0.00, 0.00, 0.00, 0.00, 0.00],\n        },\n        {\n            \"dTs\": [0.05, 0.10, 0.15, 0.20, 0.25],\n            \"N\": [7.225, 7.150, 7.075, 7.000, 6.925],\n            \"planck\": [-0.14, -0.28, -0.42, -0.56, -0.70],\n            \"lapse_rate\": [0.04, 0.08, 0.12, 0.16, 0.20],\n            \"water_vapor\": [0.03, 0.06, 0.09, 0.12, 0.15],\n            \"surface_albedo\": [0.00, 0.00, 0.00, 0.00, 0.00],\n        },\n    ]\n\n    def calculate_ols_slope(x, y):\n        \"\"\"\n        Calculates the slope of a simple linear regression of y on x\n        using the formula provided in the problem description.\n        \n        Args:\n            x (np.ndarray): Independent variable.\n            y (np.ndarray): Dependent variable.\n            \n        Returns:\n            float: The slope of the regression line.\n        \"\"\"\n        x_mean = np.mean(x)\n        y_mean = np.mean(y)\n        \n        numerator = np.sum((x - x_mean) * (y - y_mean))\n        denominator = np.sum((x - x_mean)**2)\n        \n        # Avoid division by zero if all x values are the same.\n        if denominator == 0:\n            return 0.0\n            \n        return numerator / denominator\n\n    results = []\n    for case in test_cases:\n        # Convert lists to numpy arrays for vectorized operations\n        dTs = np.array(case[\"dTs\"])\n        N = np.array(case[\"N\"])\n        \n        # Step 1: Estimate the net feedback parameter lambda\n        # Fit N = a + b*dTs, then lambda = -b\n        b = calculate_ols_slope(dTs, N)\n        lambda_net = -b\n        \n        # Step 2: Estimate the non-cloud feedback parameter lambda_nc\n        # Sum the non-cloud components\n        R_nc = (np.array(case[\"planck\"]) + \n                np.array(case[\"lapse_rate\"]) + \n                np.array(case[\"water_vapor\"]) + \n                np.array(case[\"surface_albedo\"]))\n        \n        # Fit R_nc = c + d*dTs, then lambda_nc = -d\n        d = calculate_ols_slope(dTs, R_nc)\n        lambda_nc = -d\n        \n        # Step 3: Compute the cloud feedback parameter lambda_c\n        lambda_c = lambda_net - lambda_nc\n        \n        results.append(lambda_c)\n\n    # Final print statement in the exact required format.\n    # Format each result to four decimal places.\n    print(f\"[{','.join([f'{res:.4f}' for res in results])}]\")\n\nsolve()\n```"
        }
    ]
}