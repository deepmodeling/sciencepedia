{
    "hands_on_practices": [
        {
            "introduction": "我们首先从一个基础练习开始，建立对云辐射效应的直观理解。这个练习将量化一个众所周知的原则：低云主要通过反射太阳辐射来冷却地球，而高云则主要通过捕获红外辐射来加热地球。通过使用一个简化的线性模型，你将计算出当低云和高云覆盖率同时发生变化时，地球能量平衡的净变化，从而揭示它们之间相互竞争的影响 。",
            "id": "4022990",
            "problem": "考虑大气层顶 (TOA) 的全球平均能量收支，其中净向下辐射通量定义为 $F_{\\mathrm{net}} = F_{\\mathrm{SW,abs}} - F_{\\mathrm{LW,up}}$，其中 $F_{\\mathrm{SW,abs}}$ 是净吸收的短波 (SW) 辐射，$F_{\\mathrm{LW,up}}$ 是向太空的上升长波 (LW) 辐射。云通过改变短波辐射的反射和捕获长波辐射来调节 $F_{\\mathrm{net}}$。对于云量的微小扰动，可以适当地围绕基准气候态进行线性化处理。设 $F_{\\mathrm{net}}$ 对云量的特定模态敏感性由恒定的偏导数给出（假设在扰动范围内局部有效）。\n\n假设 $F_{\\mathrm{net}}$ 对云量的以下具有代表性的、特定模态平均的敏感性：\n- 低云: $\\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{\\ell}} \\big|_{\\mathrm{SW}} = -110~\\mathrm{W\\,m^{-2}}$ 每单位云量，以及 $\\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{\\ell}} \\big|_{\\mathrm{LW}} = +12~\\mathrm{W\\,m^{-2}}$ 每单位云量。\n- 高云: $\\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{h}} \\big|_{\\mathrm{SW}} = -70~\\mathrm{W\\,m^{-2}}$ 每单位云量，以及 $\\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{h}} \\big|_{\\mathrm{LW}} = +95~\\mathrm{W\\,m^{-2}}$ 每单位云量。\n\n此处，$C_{\\ell}$ 和 $C_{h}$ 分别表示全球平均低云量和高云量。符号约定为：正的 $\\Delta F_{\\mathrm{net}}$ 对应于大气层顶净向下通量的增加（即增温效应）。\n\n假设全球平均低云量减少 $1\\%$，全球平均高云量增加 $0.5\\%$。将这些扰动作为 $\\Delta C_{\\ell}$ 和 $\\Delta C_{h}$ 应用于上述敏感性，并忽略除所述云量变化之外的地表反照率、大气成分和环流的任何变化。使用线性近似，计算净变化 $\\Delta F_{\\mathrm{net}}$ (单位为 $\\mathrm{W\\,m^{-2}}$)，并将您的答案四舍五入到四位有效数字。用 $\\mathrm{W\\,m^{-2}}$ 表示您的最终答案。",
            "solution": "该问题要求计算因指定的低云量和高云量变化而导致的大气层顶 (TOA) 全球平均净向下辐射通量的变化量 $\\Delta F_{\\mathrm{net}}$。净通量 $F_{\\mathrm{net}}$ 是低云量 $C_{\\ell}$ 和高云量 $C_{h}$ 的函数。问题指出，对于给定的微小扰动，线性近似是合适的。这对应于使用 $F_{\\mathrm{net}}$ 的全微分来近似其变化量 $\\Delta F_{\\mathrm{net}}$。\n\n$F_{\\mathrm{net}}(C_{\\ell}, C_{h})$ 的全微分由下式给出：\n$$\n\\Delta F_{\\mathrm{net}} \\approx \\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{\\ell}} \\Delta C_{\\ell} + \\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{h}} \\Delta C_{h}\n$$\n其中 $\\Delta C_{\\ell}$ 和 $\\Delta C_{h}$ 分别是相应云量的变化。问题假设其他变量是恒定的。\n\n净通量对给定云类型变化的总结感性是其短波 (SW) 和长波 (LW) 分量的总和。问题以恒定偏导数的形式提供了这些分量敏感性。\n\n首先，我们计算低云的总结感性 $\\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{\\ell}}$。这是短波和长波敏感性的总和：\n$$\n\\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{\\ell}} = \\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{\\ell}} \\bigg|_{\\mathrm{SW}} + \\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{\\ell}} \\bigg|_{\\mathrm{LW}}\n$$\n代入给定值：\n$$\n\\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{\\ell}} = (-110~\\mathrm{W\\,m^{-2}}) + (12~\\mathrm{W\\,m^{-2}}) = -98~\\mathrm{W\\,m^{-2}}\n$$\n这个结果表明，低云量的增加会导致净冷却效应（净向下通量减少）。\n\n接下来，我们计算高云的总结感性 $\\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{h}}$：\n$$\n\\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{h}} = \\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{h}} \\bigg|_{\\mathrm{SW}} + \\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{h}} \\bigg|_{\\mathrm{LW}}\n$$\n代入给定值：\n$$\n\\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{h}} = (-70~\\mathrm{W\\,m^{-2}}) + (95~\\mathrm{W\\,m^{-2}}) = 25~\\mathrm{W\\,m^{-2}}\n$$\n这个结果表明，高云量的增加会导致净增温效应（净向下通量增加）。\n\n问题指明了云量的变化。低云量减少 $1\\%$ 表示为单位云量的变化：\n$$\n\\Delta C_{\\ell} = -1\\% = -0.01\n$$\n高云量增加 $0.5\\%$ 表示为：\n$$\n\\Delta C_{h} = +0.5\\% = +0.005\n$$\n\n现在我们可以使用线性近似来计算总变化 $\\Delta F_{\\mathrm{net}}$。该变化包括低云变化的贡献和高云变化的贡献。\n\n来自低云的贡献，$\\Delta F_{\\mathrm{net}, \\ell}$：\n$$\n\\Delta F_{\\mathrm{net}, \\ell} = \\left( \\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{\\ell}} \\right) \\Delta C_{\\ell} = (-98~\\mathrm{W\\,m^{-2}}) \\times (-0.01) = 0.98~\\mathrm{W\\,m^{-2}}\n$$\n低云（净效应为冷却）的减少导致了正的通量变化，即增温效应。\n\n来自高云的贡献，$\\Delta F_{\\mathrm{net}, h}$：\n$$\n\\Delta F_{\\mathrm{net}, h} = \\left( \\frac{\\partial F_{\\mathrm{net}}}{\\partial C_{h}} \\right) \\Delta C_{h} = (25~\\mathrm{W\\,m^{-2}}) \\times (0.005) = 0.125~\\mathrm{W\\,m^{-2}}\n$$\n高云（净效应为增温）的增加导致了正的通量变化，同样是一个增温效应。\n\n总净变化 $\\Delta F_{\\mathrm{net}}$ 是这两个贡献的总和：\n$$\n\\Delta F_{\\mathrm{net}} = \\Delta F_{\\mathrm{net}, \\ell} + \\Delta F_{\\mathrm{net}, h} = 0.98~\\mathrm{W\\,m^{-2}} + 0.125~\\mathrm{W\\,m^{-2}} = 1.105~\\mathrm{W\\,m^{-2}}\n$$\n问题要求答案四舍五入到四位有效数字。计算出的值 $1.105$ 已经有四位有效数字，因此无需进一步舍入。这些云变化的净效应是 $1.105~\\mathrm{W\\,m^{-2}}$ 的正辐射强迫。",
            "answer": "$$\n\\boxed{1.105}\n$$"
        },
        {
            "introduction": "现在，我们将深入探讨驱动云辐射特性的物理过程。这个练习将探索混合相态云中云相（液态与冰态）的关键作用，这是气候模型不确定性的一个主要来源。你将计算在总含水量不变的情况下，将水从冰相转变为液相如何改变云的反射率和热辐射率，从而揭示一种强大但往往违反直觉的反馈机制 。",
            "id": "4022978",
            "problem": "一个阴天的、水平均匀的、平面平行的混合相云层被嵌入用于数值天气预报和气候模拟的一维气柱模型中。总凝结水路径固定为 $W_{\\mathrm{tot}} = 0.05 \\ \\mathrm{kg} \\ \\mathrm{m}^{-2}$。初始时，液相分数为 $f_{\\ell,0} = 0.5$，冰相分数为 $f_{i,0} = 1 - f_{\\ell,0}$。云液滴有效半径为 $r_{e,\\ell} = 10 \\ \\mu\\mathrm{m}$，云冰晶有效半径为 $r_{e,i} = 30 \\ \\mu\\mathrm{m}$，液态水的体密度为 $\\rho_{w} = 1000 \\ \\mathrm{kg} \\ \\mathrm{m}^{-3}$，冰的体密度为 $\\rho_{i} = 917 \\ \\mathrm{kg} \\ \\mathrm{m}^{-3}$。云顶温度为 $T_{c} = 260 \\ \\mathrm{K}$，地表温度为 $T_{s} = 288 \\ \\mathrm{K}$。大气层顶 (TOA) 的向下短波通量为 $F_{SW}^{\\downarrow} = 340 \\ \\mathrm{W} \\ \\mathrm{m}^{-2}$，Stefan–Boltzmann 常数为 $\\sigma = 5.670374419 \\times 10^{-8} \\ \\mathrm{W} \\ \\mathrm{m}^{-2} \\ \\mathrm{K}^{-4}$。\n\n一次微物理扰动使液相分数增加了 20%，因此 $f_{\\ell,1} = 1.2 f_{\\ell,0}$，而 $W_{\\mathrm{tot}}$ 保持不变，且 $f_{i,1} = 1 - f_{\\ell,1}$。假设：\n\n- 对于宽带短波，每一相的云层光学厚度由经过充分检验的针对球体和有效半径的几何光学结果给出，即 $\\tau_{\\ell} = \\dfrac{3 W_{\\ell}}{2 \\rho_{w} r_{e,\\ell}}$ 和 $\\tau_{i} = \\dfrac{3 W_{i}}{2 \\rho_{i} r_{e,i}}$，因此总短波光学厚度为 $\\tau = \\tau_{\\ell} + \\tau_{i}$。\n- 在具有典型液相和冰相单次散射特性的宽带短波双流 Eddington 闭合方案中，云反照率可以表示为光学厚度的有理函数 $A(\\tau) = \\dfrac{\\tau}{\\tau + \\Gamma}$，其中闭合常数 $\\Gamma = 7.7$ 适用于代表性太阳光照下的平面平行阴天云层。\n- 在宽带长波（热红外）范围内，采用灰体近似，其中云层发射率为 $\\epsilon = 1 - \\exp\\!\\big(-\\kappa_{\\ell}^{LW} W_{\\ell} - \\kappa_{i}^{LW} W_{i}\\big)$，其中与相态相关的质量吸收系数分别为 $\\kappa_{\\ell}^{LW} = 30 \\ \\mathrm{m}^{2} \\ \\mathrm{kg}^{-1}$ 和 $\\kappa_{i}^{LW} = 20 \\ \\mathrm{m}^{2} \\ \\mathrm{kg}^{-1}$。\n\n从这些基本定义和闭合方案出发，计算：\n\n1. 在 $W_{\\mathrm{tot}}$ 固定的情况下，由于液相分数从 $f_{\\ell,0}$ 增加到 $f_{\\ell,1}$ 引起的短波反照率变化 $\\Delta A = A_{1} - A_{0}$。\n2. 对于相同的扰动，长波发射率的变化 $\\Delta \\epsilon = \\epsilon_{1} - \\epsilon_{0}$。\n\n然后，使用 TOA 净向下辐射通量的定义 $N = F_{SW}^{\\downarrow} - F_{SW}^{\\uparrow} - F_{LW}^{\\uparrow}$，并将阴天情况下的 TOA 向上长波通量建模为 $F_{LW}^{\\uparrow} = \\epsilon \\sigma T_{c}^{4} + (1 - \\epsilon) \\sigma T_{s}^{4}$，计算由于液相分数扰动引起的 TOA 向下通量的净变化 $\\Delta N$。对于阴天云层，取 $F_{SW}^{\\uparrow} = F_{SW}^{\\downarrow} A(\\tau)$。报告单一值 $\\Delta N$。\n\n将您最终报告的 $\\Delta N$ 值四舍五入到三位有效数字，并以 $\\mathrm{W} \\ \\mathrm{m}^{-2}$ 为单位表示。明确说明 $\\Delta N$ 的符号在此扰动下是表示净增温（正 $\\Delta N$）还是净冷却（负 $\\Delta N$）的云反馈。",
            "solution": "该问题被验证为具有科学依据、良定且客观。这是大气辐射传输和云物理学中的一个标准计算。所有必要的参数均已提供，所使用的模型是该领域公认的近似方法。\n\n求解过程首先计算云在初始状态（状态 0）和扰动状态（状态 1）下的辐射特性。然后，利用这些特性的变化来计算大气层顶 (TOA) 向下辐射通量的净变化。\n\n**1. 初始状态 (状态 0)**\n\n初始液相分数为 $f_{\\ell,0} = 0.5$，初始冰相分数为 $f_{i,0} = 1 - f_{\\ell,0} = 0.5$。总凝结水路径固定为 $W_{\\mathrm{tot}} = 0.05 \\ \\mathrm{kg} \\ \\mathrm{m}^{-2}$。\n初始液态水路径 ($W_{\\ell,0}$) 和冰水路径 ($W_{i,0}$) 为：\n$$W_{\\ell,0} = f_{\\ell,0} W_{\\mathrm{tot}} = 0.5 \\times 0.05 \\ \\mathrm{kg} \\ \\mathrm{m}^{-2} = 0.025 \\ \\mathrm{kg} \\ \\mathrm{m}^{-2}$$\n$$W_{i,0} = f_{i,0} W_{\\mathrm{tot}} = 0.5 \\times 0.05 \\ \\mathrm{kg} \\ \\mathrm{m}^{-2} = 0.025 \\ \\mathrm{kg} \\ \\mathrm{m}^{-2}$$\n\n使用给定的公式计算液相 ($\\tau_{\\ell,0}$) 和冰相 ($\\tau_{i,0}$) 的短波光学厚度，其中有效半径为 $r_{e,\\ell} = 10 \\ \\mu\\mathrm{m} = 10 \\times 10^{-6} \\ \\mathrm{m}$ 和 $r_{e,i} = 30 \\ \\mu\\mathrm{m} = 30 \\times 10^{-6} \\ \\mathrm{m}$，密度为 $\\rho_{w} = 1000 \\ \\mathrm{kg} \\ \\mathrm{m}^{-3}$ 和 $\\rho_{i} = 917 \\ \\mathrm{kg} \\ \\mathrm{m}^{-3}$。\n$$\\tau_{\\ell,0} = \\frac{3 W_{\\ell,0}}{2 \\rho_{w} r_{e,\\ell}} = \\frac{3 \\times 0.025 \\ \\mathrm{kg} \\ \\mathrm{m}^{-2}}{2 \\times 1000 \\ \\mathrm{kg} \\ \\mathrm{m}^{-3} \\times 10 \\times 10^{-6} \\ \\mathrm{m}} = \\frac{0.075}{0.02} = 3.75$$\n$$\\tau_{i,0} = \\frac{3 W_{i,0}}{2 \\rho_{i} r_{e,i}} = \\frac{3 \\times 0.025 \\ \\mathrm{kg} \\ \\mathrm{m}^{-2}}{2 \\times 917 \\ \\mathrm{kg} \\ \\mathrm{m}^{-3} \\times 30 \\times 10^{-6} \\ \\mathrm{m}} = \\frac{0.075}{0.05502} \\approx 1.36314$$\n总初始短波光学厚度为 $\\tau_0 = \\tau_{\\ell,0} + \\tau_{i,0} = 3.75 + 1.36314 = 5.11314$。\n\n初始反照率 $A_0$ 使用给定的有理函数计算，其中 $\\Gamma = 7.7$：\n$$A_0 = \\frac{\\tau_0}{\\tau_0 + \\Gamma} = \\frac{5.11314}{5.11314 + 7.7} = \\frac{5.11314}{12.81314} \\approx 0.39904$$\n\n初始长波发射率 $\\epsilon_0$ 使用给定的质量吸收系数 $\\kappa_{\\ell}^{LW} = 30 \\ \\mathrm{m}^{2} \\ \\mathrm{kg}^{-1}$ 和 $\\kappa_{i}^{LW} = 20 \\ \\mathrm{m}^{2} \\ \\mathrm{kg}^{-1}$ 计算：\n$$\\epsilon_0 = 1 - \\exp(-\\kappa_{\\ell}^{LW} W_{\\ell,0} - \\kappa_{i}^{LW} W_{i,0}) = 1 - \\exp(-(30 \\times 0.025 + 20 \\times 0.025))$$\n$$\\epsilon_0 = 1 - \\exp(-(0.75 + 0.5)) = 1 - \\exp(-1.25) \\approx 1 - 0.28650 = 0.71350$$\n\n**2. 扰动状态 (状态 1)**\n\n液相分数增加了 20%，因此 $f_{\\ell,1} = 1.2 f_{\\ell,0} = 1.2 \\times 0.5 = 0.6$。冰相分数进行调整以保持总水量守恒，所以 $f_{i,1} = 1 - f_{\\ell,1} = 1 - 0.6 = 0.4$。\n新的液态水路径和冰水路径为：\n$$W_{\\ell,1} = f_{\\ell,1} W_{\\mathrm{tot}} = 0.6 \\times 0.05 \\ \\mathrm{kg} \\ \\mathrm{m}^{-2} = 0.03 \\ \\mathrm{kg} \\ \\mathrm{m}^{-2}$$\n$$W_{i,1} = f_{i,1} W_{\\mathrm{tot}} = 0.4 \\times 0.05 \\ \\mathrm{kg} \\ \\mathrm{m}^{-2} = 0.02 \\ \\mathrm{kg} \\ \\mathrm{m}^{-2}$$\n\n新的光学厚度为：\n$$\\tau_{\\ell,1} = \\frac{3 W_{\\ell,1}}{2 \\rho_{w} r_{e,\\ell}} = \\frac{3 \\times 0.03 \\ \\mathrm{kg} \\ \\mathrm{m}^{-2}}{2 \\times 1000 \\ \\mathrm{kg} \\ \\mathrm{m}^{-3} \\times 10 \\times 10^{-6} \\ \\mathrm{m}} = \\frac{0.09}{0.02} = 4.5$$\n$$\\tau_{i,1} = \\frac{3 W_{i,1}}{2 \\rho_{i} r_{e,i}} = \\frac{3 \\times 0.02 \\ \\mathrm{kg} \\ \\mathrm{m}^{-2}}{2 \\times 917 \\ \\mathrm{kg} \\ \\mathrm{m}^{-3} \\times 30 \\times 10^{-6} \\ \\mathrm{m}} = \\frac{0.06}{0.05502} \\approx 1.09051$$\n总扰动光学厚度为 $\\tau_1 = \\tau_{\\ell,1} + \\tau_{i,1} = 4.5 + 1.09051 = 5.59051$。\n\n新的反照率 $A_1$ 为：\n$$A_1 = \\frac{\\tau_1}{\\tau_1 + \\Gamma} = \\frac{5.59051}{5.59051 + 7.7} = \\frac{5.59051}{13.29051} \\approx 0.42064$$\n\n新的发射率 $\\epsilon_1$ 为：\n$$\\epsilon_1 = 1 - \\exp(-\\kappa_{\\ell}^{LW} W_{\\ell,1} - \\kappa_{i}^{LW} W_{i,1}) = 1 - \\exp(-(30 \\times 0.03 + 20 \\times 0.02))$$\n$$\\epsilon_1 = 1 - \\exp(-(0.9 + 0.4)) = 1 - \\exp(-1.3) \\approx 1 - 0.27253 = 0.72747$$\n\n**3. TOA 净向下通量的变化 ($\\Delta N$)**\n\n短波反照率的变化为：\n$$\\Delta A = A_1 - A_0 = 0.42064 - 0.39904 = 0.0216$$\n长波发射率的变化为：\n$$\\Delta \\epsilon = \\epsilon_1 - \\epsilon_0 = 0.72747 - 0.71350 = 0.01397$$\n\nTOA 净向下辐射通量为 $N = F_{SW}^{\\downarrow} - F_{SW}^{\\uparrow} - F_{LW}^{\\uparrow}$。\n使用给定的模型，$F_{SW}^{\\uparrow} = F_{SW}^{\\downarrow} A$ 和 $F_{LW}^{\\uparrow} = \\epsilon \\sigma T_{c}^{4} + (1 - \\epsilon) \\sigma T_{s}^{4}$，我们有：\n$$N = F_{SW}^{\\downarrow}(1 - A) - \\left( \\epsilon \\sigma T_{c}^{4} + (1 - \\epsilon) \\sigma T_{s}^{4} \\right)$$\n净通量的变化 $\\Delta N = N_1 - N_0$ 为：\n$$\\Delta N = \\left[ F_{SW}^{\\downarrow}(1 - A_1) - \\left( \\epsilon_1 \\sigma T_{c}^{4} + (1 - \\epsilon_1) \\sigma T_{s}^{4} \\right) \\right] - \\left[ F_{SW}^{\\downarrow}(1 - A_0) - \\left( \\epsilon_0 \\sigma T_{c}^{4} + (1 - \\epsilon_0) \\sigma T_{s}^{4} \\right) \\right]$$\n$$\\Delta N = -F_{SW}^{\\downarrow}(A_1 - A_0) - \\left[ (\\epsilon_1 - \\epsilon_0)\\sigma T_{c}^{4} - (\\epsilon_1 - \\epsilon_0)\\sigma T_{s}^{4} \\right]$$\n$$\\Delta N = -F_{SW}^{\\downarrow}\\Delta A - \\Delta \\epsilon \\sigma (T_{c}^{4} - T_{s}^{4})$$\n\n该表达式将 TOA 净通量的变化分解为短波分量（由反照率变化引起）和长波分量（由发射率变化引起）。\n给定 $F_{SW}^{\\downarrow} = 340 \\ \\mathrm{W} \\ \\mathrm{m}^{-2}$，$\\sigma = 5.670374419 \\times 10^{-8} \\ \\mathrm{W} \\ \\mathrm{m}^{-2} \\ \\mathrm{K}^{-4}$，$T_c = 260 \\ \\mathrm{K}$ 和 $T_s = 288 \\ \\mathrm{K}$。\n\n变化的短波分量是：\n$$\\Delta N_{SW} = -F_{SW}^{\\downarrow}\\Delta A = -340 \\ \\mathrm{W} \\ \\mathrm{m}^{-2} \\times 0.0216 = -7.344 \\ \\mathrm{W} \\ \\mathrm{m}^{-2}$$\n这是一个冷却效应，因为反照率增加了。\n\n变化的长波分量是：\n$$\\Delta N_{LW} = -\\Delta \\epsilon \\sigma (T_{c}^{4} - T_{s}^{4})$$\n$$T_{c}^{4} = (260 \\ \\mathrm{K})^4 = 4.56976 \\times 10^9 \\ \\mathrm{K}^4$$\n$$T_{s}^{4} = (288 \\ \\mathrm{K})^4 \\approx 6.87971 \\times 10^9 \\ \\mathrm{K}^4$$\n$$\\Delta N_{LW} = -0.01397 \\times (5.67037 \\times 10^{-8}) \\times (4.56976 \\times 10^9 - 6.87971 \\times 10^9) \\ \\mathrm{W} \\ \\mathrm{m}^{-2}$$\n$$\\Delta N_{LW} = -0.01397 \\times (5.67037 \\times 10^{-8}) \\times (-2.30995 \\times 10^9) \\ \\mathrm{W} \\ \\mathrm{m}^{-2} \\approx 1.8318 \\ \\mathrm{W} \\ \\mathrm{m}^{-2}$$\n这是一个增温效应，因为云层增加的发射率捕获了更多由较暖地表发出的热辐射。\n\nTOA 净向下通量的总变化是各分量之和：\n$$\\Delta N = \\Delta N_{SW} + \\Delta N_{LW} = -7.344 \\ \\mathrm{W} \\ \\mathrm{m}^{-2} + 1.8318 \\ \\mathrm{W} \\ \\mathrm{m}^{-2} = -5.5122 \\ \\mathrm{W} \\ \\mathrm{m}^{-2}$$\n\n四舍五入到三位有效数字，我们得到 $\\Delta N = -5.51 \\ \\mathrm{W} \\ \\mathrm{m}^{-2}$。\n\n$\\Delta N$ 的符号为负，表示大气层顶的净向下辐射通量减少。这意味着离开地-气系统的能量比扰动前更多。因此，这一变化代表了一个净冷却反馈。短波辐射反射的增加（冷却效应）超过了长波辐射捕获的增加（增温效应）。",
            "answer": "$$\n\\boxed{-5.51}\n$$"
        },
        {
            "introduction": "最后的这个实践练习将理论与实际的气候科学研究联系起来。你将学习并实施“格雷戈里回归”（Gregory regression）方法，这是一种从复杂气候模型的输出中估算气候敏感度和反馈参数的标准技术。通过将其与辐射核（radiative kernel）方法相结合，你将学习如何从地球系统的其他反馈中分离出云反馈参数（$\\lambda_c$），这是气候模型评估与分析的一项关键技能 。",
            "id": "4022996",
            "problem": "要求您实现一个算法，在一个瞬时四倍二氧化碳（abrupt-$4\\times\\mathrm{CO_2}$）实验中，使用辐射核分解和 Gregory 回归方法来估算云反馈参数。您的程序必须从一小组综合但物理上一致的实验中计算云反馈参数，并将结果输出为单行。\n\n目标是形式化、实现并验证以下方法。\n\n- 基础能量平衡。设全球平均的大气层顶（TOA）净向下能量不平衡为 $N$，单位为 $\\mathrm{W\\,m^{-2}}$。考虑广泛使用的 Gregory 回归框架，该框架假设 $N$ 与全球平均地表气温异常 $\\Delta T_s$（单位为 $\\mathrm{K}$）之间存在近似的线性关系：\n$$\nN \\approx F - \\lambda\\,\\Delta T_s,\n$$\n其中 $F$ 是有效辐射强迫，单位为 $\\mathrm{W\\,m^{-2}}$，$\\lambda$ 是净气候反馈参数，单位为 $\\mathrm{W\\,m^{-2}\\,K^{-1}}$。对 $N$ 与 $\\Delta T_s$ 随时间变化的序列进行线性回归，会得到截距 $F$ 和等于 $-\\lambda$ 的斜率。\n\n- 辐射核分解。辐射核是 TOA 辐射对状态变量微小扰动的敏感度。辐射核方法通过将核与这些状态变量的模拟变化进行卷积，然后进行适当的积分和平均，来估算与非云状态变化相关的模拟辐射响应。对于本问题，您将获得预先聚合的、全球平均的、非云辐射响应分量的时间序列，这些分量已经与 $N$ 具有相同的符号约定（向下为正），对应于：\n  - 普朗克，\n  - 递减率，\n  - 水汽，\n  - 地表反照率。\n  将这些分量在时间 $t$ 的总和记为 $R_{\\mathrm{nc}}(t)$，单位为 $\\mathrm{W\\,m^{-2}}$。在线性假设下，每个分量都可以通过 $R_x \\approx -\\lambda_x \\,\\Delta T_s$ 与一个反馈强度 $\\lambda_x$ 相关联，从而使得非云总响应满足 $R_{\\mathrm{nc}} \\approx -\\lambda_{\\mathrm{nc}}\\,\\Delta T_s$，其中 $\\lambda_{\\mathrm{nc}} = \\sum_x \\lambda_x$。\n\n- 云反馈定义。由云变化引起的净辐射响应为 $R_{\\mathrm{c}} \\equiv N - F - R_{\\mathrm{nc}}$。在相同的线性假设下，$R_{\\mathrm{c}} \\approx -\\lambda_{\\mathrm{c}}\\,\\Delta T_s$，且云反馈参数为 $\\lambda_{\\mathrm{c}} = \\lambda - \\lambda_{\\mathrm{nc}}$。\n\n您的程序必须为每个测试用例执行以下操作：\n1. 通过对 $N$ 和 $\\Delta T_s$ 进行普通最小二乘（OLS）回归来估算 $\\lambda$，拟合 $N \\approx a + b\\,\\Delta T_s$；然后设置 $\\lambda = -b$ 和 $F = a$。\n2. 将提供的非云分量时间序列相加，形成 $R_{\\mathrm{nc}}$，对 $R_{\\mathrm{nc}}$ 和 $\\Delta T_s$ 进行 OLS 回归，即 $R_{\\mathrm{nc}} \\approx c + d\\,\\Delta T_s$，并设置 $\\lambda_{\\mathrm{nc}} = -d$。您不需要显式使用 $c$。\n3. 计算 $\\lambda_{\\mathrm{c}} = \\lambda - \\lambda_{\\mathrm{nc}}$。\n4. 以 $\\mathrm{W\\,m^{-2}\\,K^{-1}}$ 为单位，将 $\\lambda_{\\mathrm{c}}$ 报告为四舍五入到四位小数的浮点数。\n\n所有回归必须是未加权的普通最小二乘法。如果您手动实现回归，请使用：\n$$\nb = \\frac{\\sum_i (\\Delta T_{s,i}-\\overline{\\Delta T_s})(N_i-\\overline{N})}{\\sum_i (\\Delta T_{s,i}-\\overline{\\Delta T_s})^2}, \\quad a = \\overline{N} - b\\,\\overline{\\Delta T_s},\n$$\n对于斜率 $d$，类似地用 $R_{\\mathrm{nc}}$ 替换 $N$。不涉及角度。所有物理量必须按其所述单位处理；只报告四舍五入到四位小数的 $\\lambda_{\\mathrm{c}}$ 数值，该数值隐含单位 $\\mathrm{W\\,m^{-2}\\,K^{-1}}$。\n\n测试套件数据如下。每个测试用例都提供了时间序列数组，包括单位为 $\\mathrm{K}$ 的 $\\Delta T_s$、单位为 $\\mathrm{W\\,m^{-2}}$ 的 $N$，以及单位为 $\\mathrm{W\\,m^{-2}}$ 的四个由非云核导出的分量，这些分量已经共享 TOA 净向下为正的符号约定。\n\n- 测试用例 1（一般情况）：\n  - $\\Delta T_s = [\\,0.3,\\,0.6,\\,0.9,\\,1.2,\\,1.5\\,] \\ \\mathrm{K}$\n  - $N = [\\,7.04,\\,6.68,\\,6.32,\\,5.96,\\,5.60\\,] \\ \\mathrm{W\\,m^{-2}}$\n  - 普朗克 $= [\\,-0.96,\\,-1.92,\\,-2.88,\\,-3.84,\\,-4.80\\,] \\ \\mathrm{W\\,m^{-2}}$\n  - 递减率 $= [\\,0.24,\\,0.48,\\,0.72,\\,0.96,\\,1.20\\,] \\ \\mathrm{W\\,m^{-2}}$\n  - 水汽 $= [\\,0.45,\\,0.90,\\,1.35,\\,1.80,\\,2.25\\,] \\ \\mathrm{W\\,m^{-2}}$\n  - 地表反照率 $= [\\,-0.03,\\,-0.06,\\,-0.09,\\,-0.12,\\,-0.15\\,] \\ \\mathrm{W\\,m^{-2}}$\n\n- 测试用例 2（非云接近中性）：\n  - $\\Delta T_s = [\\,0.2,\\,0.5,\\,0.8,\\,1.1,\\,1.4\\,] \\ \\mathrm{K}$\n  - $N = [\\,6.80,\\,6.50,\\,6.20,\\,5.90,\\,5.60\\,] \\ \\mathrm{W\\,m^{-2}}$\n  - 普朗克 $= [\\,-0.38,\\,-0.95,\\,-1.52,\\,-2.09,\\,-2.66\\,] \\ \\mathrm{W\\,m^{-2}}$\n  - 递减率 $= [\\,0.20,\\,0.50,\\,0.80,\\,1.10,\\,1.40\\,] \\ \\mathrm{W\\,m^{-2}}$\n  - 水汽 $= [\\,0.16,\\,0.40,\\,0.64,\\,0.88,\\,1.12\\,] \\ \\mathrm{W\\,m^{-2}}$\n  - 地表反照率 $= [\\,0.00,\\,0.00,\\,0.00,\\,0.00,\\,0.00\\,] \\ \\mathrm{W\\,m^{-2}}$\n\n- 测试用例 3（云反馈不稳定）：\n  - $\\Delta T_s = [\\,0.2,\\,0.4,\\,0.6,\\,0.8,\\,1.0\\,] \\ \\mathrm{K}$\n  - $N = [\\,6.90,\\,6.80,\\,6.70,\\,6.60,\\,6.50\\,] \\ \\mathrm{W\\,m^{-2}}$\n  - 普朗克 $= [\\,-0.64,\\,-1.28,\\,-1.92,\\,-2.56,\\,-3.20\\,] \\ \\mathrm{W\\,m^{-2}}$\n  - 递减率 $= [\\,0.22,\\,0.44,\\,0.66,\\,0.88,\\,1.10\\,] \\ \\mathrm{W\\,m^{-2}}$\n  - 水汽 $= [\\,0.18,\\,0.36,\\,0.54,\\,0.72,\\,0.90\\,] \\ \\mathrm{W\\,m^{-2}}$\n  - 地表反照率 $= [\\,0.00,\\,0.00,\\,0.00,\\,0.00,\\,0.00\\,] \\ \\mathrm{W\\,m^{-2}}$\n\n- 测试用例 4（小 $\\Delta T_s$ 范围）：\n  - $\\Delta T_s = [\\,0.05,\\,0.10,\\,0.15,\\,0.20,\\,0.25\\,] \\ \\mathrm{K}$\n  - $N = [\\,7.225,\\,7.150,\\,7.075,\\,7.000,\\,6.925\\,] \\ \\mathrm{W\\,m^{-2}}$\n  - 普朗克 $= [\\,-0.14,\\,-0.28,\\,-0.42,\\,-0.56,\\,-0.70\\,] \\ \\mathrm{W\\,m^{-2}}$\n  - 递减率 $= [\\,0.04,\\,0.08,\\,0.12,\\,0.16,\\,0.20\\,] \\ \\mathrm{W\\,m^{-2}}$\n  - 水汽 $= [\\,0.03,\\,0.06,\\,0.09,\\,0.12,\\,0.15\\,] \\ \\mathrm{W\\,m^{-2}}$\n  - 地表反照率 $= [\\,0.00,\\,0.00,\\,0.00,\\,0.00,\\,0.00\\,] \\ \\mathrm{W\\,m^{-2}}$\n\n要求和交付成果：\n- 按照描述实现 OLS 回归。不要使用任何外部数据或要求输入。\n- 为每个测试用例计算一个单位为 $\\mathrm{W\\,m^{-2}\\,K^{-1}}$ 的标量 $\\lambda_{\\mathrm{c}}$。\n- 最终输出格式：您的程序应产生单行输出，包含用方括号括起来的、以逗号分隔的结果列表，其中每个数字都四舍五入到四位小数且不带单位（例如，$[\\,0.1234,\\,-0.5678,\\,\\ldots\\,]$）。\n\n您的程序必须是一个完整、可运行的程序，并且不得提示输入。评分将检查单行输出是否完全符合要求的格式，以及所提供测试套件的数值是否正确。",
            "solution": "该问题被认为是有效的，因为它在科学上基于既定的气候科学方法论，在数学上是适定的，并且提供了一套完整且明确的指令和数据。任务是从代表瞬时四倍二氧化碳（abrupt-$4\\times\\mathrm{CO_2}$）气候模型实验的合成数据中计算云反馈参数 $\\lambda_{\\mathrm{c}}$。计算过程通过结合使用 Gregory 回归方法和辐射核分解来实现。该过程涉及三个主要步骤。\n\n首先，估算净气候反馈参数 $\\lambda$。大气层顶（TOA）的净向下能量不平衡 $N$ 被假设与全球平均地表气温异常 $\\Delta T_s$ 呈线性关系。这种关系表示为：\n$$\nN(t) \\approx F - \\lambda\\,\\Delta T_s(t)\n$$\n其中 $F$ 是有效辐射强迫，$\\lambda$ 是净气候反馈参数，单位为 $\\mathrm{W\\,m^{-2}\\,K^{-1}}$。为了估算这些参数，我们对 $N$ 的时间序列和 $\\Delta T_s$ 的时间序列进行普通最小二乘（OLS）回归，拟合模型 $N \\approx a + b\\,\\Delta T_s$。通过比较这两种形式，我们将斜率 $b$ 等同于 $-\\lambda$，因此 $\\lambda = -b$。截距 $a$ 对应于强迫 $F$。OLS 斜率 $b$ 的公式由下式给出：\n$$\nb = \\frac{\\sum_{i=1}^{n} (\\Delta T_{s,i}-\\overline{\\Delta T_s})(N_i-\\overline{N})}{\\sum_{i=1}^{n} (\\Delta T_{s,i}-\\overline{\\Delta T_s})^2}\n$$\n其中 $\\overline{\\Delta T_s}$ 和 $\\overline{N}$ 是各自变量在 $n$ 个数据点上的时间平均值。\n\n第二，确定总的非云反馈参数 $\\lambda_{\\mathrm{nc}}$。问题提供了由辐射核导出的、由于非云过程引起的辐射响应的时间序列。这些分量是普朗克响应、递减率响应、水汽响应和地表反照率响应。它们的总和构成了总的非云辐射响应 $R_{\\mathrm{nc}}(t)$。\n$$\nR_{\\mathrm{nc}}(t) = R_{\\mathrm{Planck}}(t) + R_{\\mathrm{lapse-rate}}(t) + R_{\\mathrm{water\\,vapor}}(t) + R_{\\mathrm{albedo}}(t)\n$$\n与净反馈类似，总非云反馈被假设与温度异常成线性比例关系，$R_{\\mathrm{nc}} \\approx -\\lambda_{\\mathrm{nc}}\\,\\Delta T_s$。我们通过执行第二次 OLS 回归来估算 $\\lambda_{\\mathrm{nc}}$，这次是对 $R_{\\mathrm{nc}}$ 和 $\\Delta T_s$ 进行回归，拟合模型 $R_{\\mathrm{nc}} \\approx c + d\\,\\Delta T_s$。斜率 $d$ 被等同于 $-\\lambda_{\\mathrm{nc}}$，因此 $\\lambda_{\\mathrm{nc}} = -d$。斜率 $d$ 的公式与 $b$ 的公式类似：\n$$\nd = \\frac{\\sum_{i=1}^{n} (\\Delta T_{s,i}-\\overline{\\Delta T_s})(R_{\\mathrm{nc},i}-\\overline{R_{\\mathrm{nc}}})}{\\sum_{i=1}^{n} (\\Delta T_{s,i}-\\overline{\\Delta T_s})^2}\n$$\n其中 $\\overline{R_{\\mathrm{nc}}}$ 是总非云响应的时间平均值。\n\n第三，计算云反馈参数 $\\lambda_{\\mathrm{c}}$。总反馈参数 $\\lambda$ 可以分解为其非云分量和云分量：\n$$\n\\lambda = \\lambda_{\\mathrm{nc}} + \\lambda_{\\mathrm{c}}\n$$\n这是辐射响应可加性 $N - F \\approx R_{\\mathrm{nc}} + R_{\\mathrm{c}}$ 的直接结果，其中 $R_{\\mathrm{c}}$ 是云辐射响应。通过重新排列方程，我们可以将云反馈参数分离出来，作为净反馈和非云反馈之间的差值：\n$$\n\\lambda_{\\mathrm{c}} = \\lambda - \\lambda_{\\mathrm{nc}}\n$$\n这是每个测试用例要计算的最终量。实现将涉及定义一个函数，该函数根据提供的公式从两个数据系列计算 OLS 斜率，应用它来获得 $b$ 和 $d$，然后组合结果以找到 $\\lambda_{\\mathrm{c}}$。结果将以 $\\mathrm{W\\,m^{-2}\\,K^{-1}}$ 为单位报告，四舍五入到四位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the cloud feedback parameter for a suite of test cases using\n    Gregory regression and radiative kernel decomposition.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"dTs\": [0.3, 0.6, 0.9, 1.2, 1.5],\n            \"N\": [7.04, 6.68, 6.32, 5.96, 5.60],\n            \"planck\": [-0.96, -1.92, -2.88, -3.84, -4.80],\n            \"lapse_rate\": [0.24, 0.48, 0.72, 0.96, 1.20],\n            \"water_vapor\": [0.45, 0.90, 1.35, 1.80, 2.25],\n            \"surface_albedo\": [-0.03, -0.06, -0.09, -0.12, -0.15],\n        },\n        {\n            \"dTs\": [0.2, 0.5, 0.8, 1.1, 1.4],\n            \"N\": [6.80, 6.50, 6.20, 5.90, 5.60],\n            \"planck\": [-0.38, -0.95, -1.52, -2.09, -2.66],\n            \"lapse_rate\": [0.20, 0.50, 0.80, 1.10, 1.40],\n            \"water_vapor\": [0.16, 0.40, 0.64, 0.88, 1.12],\n            \"surface_albedo\": [0.00, 0.00, 0.00, 0.00, 0.00],\n        },\n        {\n            \"dTs\": [0.2, 0.4, 0.6, 0.8, 1.0],\n            \"N\": [6.90, 6.80, 6.70, 6.60, 6.50],\n            \"planck\": [-0.64, -1.28, -1.92, -2.56, -3.20],\n            \"lapse_rate\": [0.22, 0.44, 0.66, 0.88, 1.10],\n            \"water_vapor\": [0.18, 0.36, 0.54, 0.72, 0.90],\n            \"surface_albedo\": [0.00, 0.00, 0.00, 0.00, 0.00],\n        },\n        {\n            \"dTs\": [0.05, 0.10, 0.15, 0.20, 0.25],\n            \"N\": [7.225, 7.150, 7.075, 7.000, 6.925],\n            \"planck\": [-0.14, -0.28, -0.42, -0.56, -0.70],\n            \"lapse_rate\": [0.04, 0.08, 0.12, 0.16, 0.20],\n            \"water_vapor\": [0.03, 0.06, 0.09, 0.12, 0.15],\n            \"surface_albedo\": [0.00, 0.00, 0.00, 0.00, 0.00],\n        },\n    ]\n\n    def calculate_ols_slope(x, y):\n        \"\"\"\n        Calculates the slope of a simple linear regression of y on x\n        using the formula provided in the problem description.\n        \n        Args:\n            x (np.ndarray): Independent variable.\n            y (np.ndarray): Dependent variable.\n            \n        Returns:\n            float: The slope of the regression line.\n        \"\"\"\n        x_mean = np.mean(x)\n        y_mean = np.mean(y)\n        \n        numerator = np.sum((x - x_mean) * (y - y_mean))\n        denominator = np.sum((x - x_mean)**2)\n        \n        # Avoid division by zero if all x values are the same.\n        if denominator == 0:\n            return 0.0\n            \n        return numerator / denominator\n\n    results = []\n    for case in test_cases:\n        # Convert lists to numpy arrays for vectorized operations\n        dTs = np.array(case[\"dTs\"])\n        N = np.array(case[\"N\"])\n        \n        # Step 1: Estimate the net feedback parameter lambda\n        # Fit N = a + b*dTs, then lambda = -b\n        b = calculate_ols_slope(dTs, N)\n        lambda_net = -b\n        \n        # Step 2: Estimate the non-cloud feedback parameter lambda_nc\n        # Sum the non-cloud components\n        R_nc = (np.array(case[\"planck\"]) + \n                np.array(case[\"lapse_rate\"]) + \n                np.array(case[\"water_vapor\"]) + \n                np.array(case[\"surface_albedo\"]))\n        \n        # Fit R_nc = c + d*dTs, then lambda_nc = -d\n        d = calculate_ols_slope(dTs, R_nc)\n        lambda_nc = -d\n        \n        # Step 3: Compute the cloud feedback parameter lambda_c\n        lambda_c = lambda_net - lambda_nc\n        \n        results.append(lambda_c)\n\n    # Final print statement in the exact required format.\n    # Format each result to four decimal places.\n    print(f\"[{','.join([f'{res:.4f}' for res in results])}]\")\n\nsolve()\n```"
        }
    ]
}