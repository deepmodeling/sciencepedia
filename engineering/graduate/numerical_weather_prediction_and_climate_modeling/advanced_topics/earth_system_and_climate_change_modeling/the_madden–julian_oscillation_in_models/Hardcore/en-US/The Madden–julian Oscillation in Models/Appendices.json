{
    "hands_on_practices": [
        {
            "introduction": "To understand how the Madden–Julian Oscillation (MJO) is sustained, we must first understand the conditions that allow a large-scale tropical disturbance to grow. This practice strips the problem down to its essential components, modeling the MJO as a \"moisture mode\" whose growth depends on a delicate balance of competing physical processes. By analyzing a simplified equation , you will derive the criteria for instability, revealing how feedbacks from cloud-radiation interactions and surface fluxes can overcome the stabilizing effects of atmospheric energy export and diffusion.",
            "id": "4101627",
            "problem": "Consider a simplified column-integrated moist static energy anomaly $m'(x,t)$ describing the large-scale tropical disturbance associated with the Madden–Julian Oscillation (MJO), modeled as a moisture mode under the weak temperature gradient (WTG) approximation. Assume convective quasi-equilibrium (CQE), so that precipitation anomalies $P'(x,t)$ are linearly proportional to $m'(x,t)$ with a finite convective adjustment time scale $\\tau$, namely $P'(x,t) = m'(x,t)/\\tau$. The moist static energy (MSE) budget for $m'(x,t)$ comprises three leading-order contributions:\n- Longwave cloud-radiative feedback, parameterized by a dimensionless coefficient $\\alpha  0$, that provides a column-integrated heating tendency proportional to $P'(x,t)$.\n- Wind-Induced Surface Heat Exchange (WISHE) surface flux feedback, parameterized by a dimensionless coefficient $\\gamma  0$, that provides a moistening/heating tendency proportional to $P'(x,t)$.\n- Export of moist static energy by the large-scale circulation, quantified by the (dimensionless) gross moist stability $\\Lambda  0$, which removes MSE in proportion to $P'(x,t)$.\n\nAssume lateral mixing of $m'$ is represented by a diffusive term with diffusivity $\\kappa  0$ (with units of $\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$), so the one-dimensional governing equation is\n$$\n\\frac{\\partial m'}{\\partial t} \\;=\\; \\left[(\\alpha + \\gamma) - \\Lambda\\right]\\frac{m'}{\\tau} \\;+\\; \\kappa\\,\\frac{\\partial^{2} m'}{\\partial x^{2}}.\n$$\nSeek normal mode solutions of the form $m'(x,t) = \\hat{m}\\,\\exp\\!\\left(\\sigma\\,t + i k x\\right)$, where $k$ is the zonal wavenumber and $\\sigma$ is the complex growth rate. Starting from conservation of moist static energy and the stated parameterizations, derive the real growth rate $\\sigma(k)$ as a function of $\\alpha$, $\\gamma$, $\\Lambda$, $\\tau$, $\\kappa$, and $k$, and state the condition on $\\alpha$ and $\\gamma$ under which the mode is linearly unstable for a given wavenumber $k$. Express the final growth rate in $\\mathrm{s}^{-1}$. No numerical values are provided; give your result as a closed-form analytic expression. Your answer should be a single expression. If you introduce any acronyms, define them upon first use.",
            "solution": "The problem asks us to derive the real growth rate of a large-scale tropical disturbance, modeled as a moisture mode of the Madden–Julian Oscillation (MJO). The model is based on the conservation of column-integrated moist static energy (MSE), and its dynamics are described by a given one-dimensional partial differential equation.\n\nThe governing equation for the MSE anomaly, $m'(x,t)$, is provided as:\n$$\n\\frac{\\partial m'}{\\partial t} \\;=\\; \\left[(\\alpha + \\gamma) - \\Lambda\\right]\\frac{m'}{\\tau} \\;+\\; \\kappa\\,\\frac{\\partial^{2} m'}{\\partial x^{2}}\n$$\nHere, $m'(x,t)$ is the MSE anomaly, $t$ is time, and $x$ is the spatial coordinate. The parameters are all positive constants: $\\tau$ is the convective adjustment time scale, $\\alpha$ is the dimensionless coefficient for longwave cloud-radiative feedback, $\\gamma$ is the dimensionless coefficient for Wind-Induced Surface Heat Exchange (WISHE) surface flux feedback, $\\Lambda$ is the dimensionless gross moist stability, and $\\kappa$ is the diffusivity.\n\nWe are to seek a normal mode solution of the form:\n$$\nm'(x,t) = \\hat{m}\\,\\exp(\\sigma t + i k x)\n$$\nIn this expression, $\\hat{m}$ is a constant amplitude, $k$ is the real-valued zonal wavenumber, and $\\sigma$ is the complex growth rate. The real part of $\\sigma$ determines the growth or decay of the mode's amplitude, and the imaginary part determines its frequency of oscillation or phase speed.\n\nTo find the relationship between $\\sigma$ and $k$, known as the dispersion relation, we substitute the normal mode solution into the governing equation. First, we calculate the required partial derivatives of $m'(x,t)$:\nThe partial derivative with respect to time $t$ is:\n$$\n\\frac{\\partial m'}{\\partial t} = \\frac{\\partial}{\\partial t} \\left[ \\hat{m}\\,\\exp(\\sigma t + i k x) \\right] = \\sigma \\left[ \\hat{m}\\,\\exp(\\sigma t + i k x) \\right] = \\sigma m'\n$$\nThe second partial derivative with respect to the spatial coordinate $x$ is:\n$$\n\\frac{\\partial^{2} m'}{\\partial x^{2}} = \\frac{\\partial^{2}}{\\partial x^{2}} \\left[ \\hat{m}\\,\\exp(\\sigma t + i k x) \\right] = (i k)^{2} \\left[ \\hat{m}\\,\\exp(\\sigma t + i k x) \\right] = -k^2 m'\n$$\nNow, substituting these derivatives into the governing equation gives:\n$$\n\\sigma m' = \\left[(\\alpha + \\gamma) - \\Lambda\\right]\\frac{m'}{\\tau} + \\kappa(-k^2 m')\n$$\nFor a non-trivial solution to exist, we must have $\\hat{m} \\neq 0$, which implies $m'(x,t)$ is not identically zero. We can therefore divide the entire equation by $m'$:\n$$\n\\sigma(k) = \\frac{(\\alpha + \\gamma) - \\Lambda}{\\tau} - \\kappa k^2\n$$\nThis is the dispersion relation for the system. It expresses the complex growth rate $\\sigma$ as a function of the wavenumber $k$ and the physical parameters of the model.\n\nThe problem asks for the real growth rate. The complex growth rate is generally $\\sigma = \\mathrm{Re}(\\sigma) + i\\,\\mathrm{Im}(\\sigma)$. Since all parameters in the derived expression for $\\sigma(k)$—namely $\\alpha$, $\\gamma$, $\\Lambda$, $\\tau$, $\\kappa$—are real constants and the wavenumber $k$ is also real, the entire right-hand side is real. Therefore, the complex growth rate $\\sigma(k)$ is purely real, and its imaginary part is zero.\n$$\n\\mathrm{Re}(\\sigma(k)) = \\sigma(k) = \\frac{(\\alpha + \\gamma) - \\Lambda}{\\tau} - \\kappa k^2\n$$\n$$\n\\mathrm{Im}(\\sigma(k)) = 0\n$$\nThe fact that $\\mathrm{Im}(\\sigma(k)) = 0$ implies that these disturbances are standing waves; they grow or decay in place without propagation. The real growth rate, which governs the stability of the mode, is $\\sigma(k)$ itself. The units of $\\sigma(k)$ are inverse time ($\\mathrm{s}^{-1}$), as required for a growth rate. This can be verified by dimensional analysis: $\\alpha, \\gamma, \\Lambda$ are dimensionless, $\\tau$ is in s, $\\kappa$ is in $\\mathrm{m}^{2}\\,\\mathrm{s}^{-1}$, and $k$ is in $\\mathrm{m}^{-1}$. Thus, $[\\tau^{-1}]=\\mathrm{s}^{-1}$ and $[\\kappa k^2] = (\\mathrm{m}^{2}\\,\\mathrm{s}^{-1})(\\mathrm{m}^{-1})^2 = \\mathrm{s}^{-1}$.\n\nFinally, we determine the condition for linear instability. A mode with wavenumber $k$ is considered linearly unstable if its amplitude grows exponentially with time. This occurs when the real growth rate is positive:\n$$\n\\sigma(k) > 0\n$$\nSubstituting our derived expression for $\\sigma(k)$:\n$$\n\\frac{(\\alpha + \\gamma) - \\Lambda}{\\tau} - \\kappa k^2 > 0\n$$\nRearranging the inequality to find the condition on the feedback parameters $\\alpha$ and $\\gamma$:\n$$\n\\frac{(\\alpha + \\gamma) - \\Lambda}{\\tau} > \\kappa k^2\n$$\nSince $\\tau > 0$, we can multiply by $\\tau$ without changing the direction of the inequality:\n$$\n(\\alpha + \\gamma) - \\Lambda > \\tau \\kappa k^2\n$$\n$$\n\\alpha + \\gamma > \\Lambda + \\tau \\kappa k^2\n$$\nThis condition signifies that for a mode of wavenumber $k$ to be unstable, the destabilizing source terms associated with cloud-radiative feedback ($\\alpha$) and surface flux feedback ($\\gamma$) must exceed the stabilizing sink terms associated with MSE export by the large-scale circulation ($\\Lambda$) and lateral diffusion ($\\kappa k^2 \\tau$). The longest waves (smallest $k$) are the most unstable, as they are least affected by diffusion.\nThe primary result requested is the expression for the real growth rate $\\sigma(k)$.",
            "answer": "$$\n\\boxed{\\frac{(\\alpha + \\gamma) - \\Lambda}{\\tau} - \\kappa k^{2}}\n$$"
        },
        {
            "introduction": "While instability is necessary for the MJO to exist, its slow eastward propagation is what truly defines its character. This practice builds upon the simple moisture mode by coupling the moisture field to the atmospheric wind field, a critical step for simulating propagation. By constructing and analyzing a two-variable linear model , you will explore how the interaction between convective heating and wind response, modulated by factors like gross moist stability and mean winds, gives rise to a propagating disturbance and determines its speed and growth rate.",
            "id": "4101611",
            "problem": "You are asked to implement a sensitivity experiment for the Madden–Julian Oscillation (MJO) within a linear moisture-mode framework commonly used in numerical weather prediction and climate modeling. Use the following scientifically grounded bases and closures, and derive a minimal, self-consistent linear model whose normal-mode analysis yields a complex growth rate and an associated phase speed for a prescribed zonal wavenumber.\n\nFundamental base:\n- The prognostic variable for column-integrated moisture anomaly is denoted by $q(x,t)$ and for the first baroclinic zonal wind anomaly by $u(x,t)$.\n- The column-integrated moisture budget is built from the standard decomposition of sources and sinks: precipitation anomaly $P'$, evaporation anomaly $E'$, and circulation-induced export tied to gross moist stability. Adopt the linear closures:\n  1. Precipitation anomalies are proportional to column moisture anomalies with precipitation efficiency parameter $\\epsilon$, i.e., $P' = \\epsilon q$.\n  2. Evaporation anomalies are proportional to near-surface wind anomalies with coefficient $\\beta$, i.e., $E' = \\beta u$.\n  3. Gross Moist Stability (GMS), denoted $S$, parameterizes the net export of moist static energy per unit convective heating. Its effect on the moisture budget acts as an additional sink proportional to heating, hence $-S P' = -S \\epsilon q$ in the moisture tendency.\n- A background mean zonal wind $U$ advects moisture anomalies, contributing $-U \\partial_x q$ to the moisture tendency.\n- Under the Weak Temperature Gradient (WTG) approximation and first-baroclinic equatorial Kelvin-like response, zonal wind anomalies are linearly forced by the zonal gradients of heating that is tied to moisture anomalies. Adopt a linear closure $u_t = -\\alpha \\partial_x q - \\mu u$, where $\\alpha$ is a coupling coefficient that converts zonal gradients of moisture anomalies into wind tendency through pressure-gradient forcing, and $\\mu$ is a linear friction rate.\n\nStarting from these bases, linearize about a spatially uniform mean state and consider normal modes of the form $q(x,t), u(x,t) \\propto \\exp(i k x - i \\omega t)$, where $k$ is the zonal wavenumber (in $\\text{m}^{-1}$) and $\\omega$ is the angular frequency (in $\\text{s}^{-1}$). Derive the associated linear operator for the coupled $(q,u)$ system and its dispersion relation. From the eigenvalues $\\lambda$ of this operator, identify the complex frequency via $\\lambda = \\sigma - i \\omega$, where $\\sigma$ is the real growth rate (in $\\text{s}^{-1}$) and $\\omega$ is the real angular frequency (in $\\text{s}^{-1}$). Define the phase speed $c_p$ (in $\\text{m}\\,\\text{s}^{-1}$) as $c_p = \\omega/k$ for $k \\neq 0$. For $k=0$, set $c_p = 0$ by definition of non-propagating uniform modes.\n\nImplement a program that:\n1. Constructs the linear operator for given parameters $(\\epsilon, S, k, U)$ and fixed coupling/friction parameters $(\\alpha, \\beta, \\mu)$.\n2. Computes all eigenvalues and selects the eigenvalue with the largest real part $\\sigma$ (the most unstable or least damped mode).\n3. Reports the growth rate $\\sigma$ in $\\text{s}^{-1}$ and phase speed $c_p$ in $\\text{m}\\,\\text{s}^{-1}$ computed from that eigenvalue.\n\nUse the following fixed parameters in all tests:\n- $\\alpha = 0.02$ (constant coupling coefficient),\n- $\\beta = 0.001$ (evaporation-wind coupling),\n- $\\mu = 1.0 \\times 10^{-6}\\,\\text{s}^{-1}$ (linear friction rate).\n\nConstruct the test suite with the following cases, each a tuple $(\\epsilon, S, k, U)$:\n- Case A (baseline negative Gross Moist Stability): $\\epsilon = 2.0 \\times 10^{-6}\\,\\text{s}^{-1}$, $S = -0.5$, $k = 2\\pi / 15{,}000{,}000\\,\\text{m}^{-1}$, $U = 0.0\\,\\text{m}\\,\\text{s}^{-1}$.\n- Case B (strong damping): $\\epsilon = 5.0 \\times 10^{-6}\\,\\text{s}^{-1}$, $S = 0.5$, $k = 2\\pi / 15{,}000{,}000\\,\\text{m}^{-1}$, $U = 0.0\\,\\text{m}\\,\\text{s}^{-1}$.\n- Case C (nearly neutral net precipitation sink): $\\epsilon = 1.5 \\times 10^{-6}\\,\\text{s}^{-1}$, $S = -1.0$, $k = 2\\pi / 15{,}000{,}000\\,\\text{m}^{-1}$, $U = 0.0\\,\\text{m}\\,\\text{s}^{-1}$.\n- Case D (strongly negative Gross Moist Stability with weak mean flow): $\\epsilon = 1.2 \\times 10^{-6}\\,\\text{s}^{-1}$, $S = -2.0$, $k = 2\\pi / 15{,}000{,}000\\,\\text{m}^{-1}$, $U = 1.0\\,\\text{m}\\,\\text{s}^{-1}$.\n- Case E (non-propagating boundary case): $\\epsilon = 2.0 \\times 10^{-6}\\,\\text{s}^{-1}$, $S = -0.5$, $k = 0.0\\,\\text{m}^{-1}$, $U = 0.0\\,\\text{m}\\,\\text{s}^{-1}$.\n- Case F (very negative Gross Moist Stability, westward mean wind): $\\epsilon = 1.8 \\times 10^{-6}\\,\\text{s}^{-1}$, $S = -2.5$, $k = 2\\pi / 15{,}000{,}000\\,\\text{m}^{-1}$, $U = -2.0\\,\\text{m}\\,\\text{s}^{-1}$.\n\nFinal output format:\n- Your program should produce a single line of output containing a comma-separated list of floats enclosed in square brackets, where for each test case you output first the growth rate $\\sigma$ in $\\text{s}^{-1}$ and then the phase speed $c_p$ in $\\text{m}\\,\\text{s}^{-1}$. The results must be flattened in the order of the test suite: $[\\sigma_A, c_{p,A}, \\sigma_B, c_{p,B}, \\sigma_C, c_{p,C}, \\sigma_D, c_{p,D}, \\sigma_E, c_{p,E}, \\sigma_F, c_{p,F}]$.",
            "solution": "The problem requires the derivation and implementation of a solution for a simplified linear moisture-mode model of the Madden–Julian Oscillation (MJO). The solution involves finding the growth rate and phase speed of the most unstable normal mode for a given set of physical parameters.\n\nFirst, we establish the governing system of linear partial differential equations (PDEs) from the provided physical closures. The prognostic variables are the column-integrated moisture anomaly, $q(x,t)$, and the first baroclinic zonal wind anomaly, $u(x,t)$.\n\nThe column-integrated moisture budget equation is given by the tendency $\\partial_t q$. The sources and sinks are:\n1.  Evaporation anomaly, $E' = \\beta u$, which is a source.\n2.  Precipitation anomaly, $P' = \\epsilon q$, which is a sink.\n3.  A moisture sink due to Gross Moist Stability ($S$), which is proportional to convective heating (and thus to precipitation): $-S P' = -S \\epsilon q$. Note that for negative $S$, this term becomes a source, representing moisture recharge.\n4.  Advection of moisture anomaly by the mean zonal wind $U$: $-U \\partial_x q$.\n\nCombining these terms, the moisture equation is:\n$$ \\frac{\\partial q}{\\partial t} = \\beta u - \\epsilon q - S \\epsilon q - U \\frac{\\partial q}{\\partial x} = -\\epsilon(1+S) q - U \\frac{\\partial q}{\\partial x} + \\beta u $$\n\nThe zonal wind tendency, $\\partial_t u$, is governed by:\n1.  Forcing from the zonal pressure gradient, which under the Weak Temperature Gradient (WTG) approximation is related to the gradient of latent heating, and thus moisture: $-\\alpha \\partial_x q$.\n2.  A linear friction (or damping) term: $-\\mu u$.\n\nThis gives the wind equation:\n$$ \\frac{\\partial u}{\\partial t} = -\\alpha \\frac{\\partial q}{\\partial x} - \\mu u $$\n\nWe now have a coupled linear system for the state vector $\\mathbf{v}(x,t) = \\begin{pmatrix} q(x,t) \\\\ u(x,t) \\end{pmatrix}$. To analyze its normal modes, we assume solutions of the form $\\mathbf{v}(x,t) = \\hat{\\mathbf{v}} e^{\\lambda t + ikx}$, where $\\hat{\\mathbf{v}} = \\begin{pmatrix} \\hat{q} \\\\ \\hat{u} \\end{pmatrix}$ is a constant complex vector, $k$ is the zonal wavenumber, and $\\lambda$ is the complex growth rate. This ansatz transforms the time and space derivatives as $\\partial_t \\to \\lambda$ and $\\partial_x \\to ik$.\n\nSubstituting this form into the system of PDEs yields a system of linear algebraic equations:\n$$ \\lambda \\hat{q} = -\\epsilon(1+S) \\hat{q} - U (ik) \\hat{q} + \\beta \\hat{u} $$\n$$ \\lambda \\hat{u} = -\\alpha (ik) \\hat{q} - \\mu \\hat{u} $$\n\nThis can be written in the standard matrix eigenvalue problem form, $\\lambda \\hat{\\mathbf{v}} = \\mathbf{L} \\hat{\\mathbf{v}}$:\n$$ \\lambda \\begin{pmatrix} \\hat{q} \\\\ \\hat{u} \\end{pmatrix} = \\begin{pmatrix} -\\epsilon(1+S) - iUk  \\beta \\\\ -i\\alpha k  -\\mu \\end{pmatrix} \\begin{pmatrix} \\hat{q} \\\\ \\hat{u} \\end{pmatrix} $$\n\nThe $2 \\times 2$ matrix $\\mathbf{L}$ is the linear operator for the system:\n$$ \\mathbf{L} = \\begin{pmatrix} -\\epsilon(1+S) - iUk  \\beta \\\\ -i\\alpha k  -\\mu \\end{pmatrix} $$\n\nThe eigenvalues $\\lambda$ of $\\mathbf{L}$ determine the behavior of the modes. For each set of parameters $(\\epsilon, S, k, U)$ and fixed constants $(\\alpha, \\beta, \\mu)$, we compute the two eigenvalues of $\\mathbf{L}$. The problem specifies to select the eigenvalue with the largest real part, which we denote $\\lambda_{max}$. This corresponds to the most unstable (or least stable) mode.\n\nThe problem defines the relationship between the eigenvalue $\\lambda$ and the physical quantities of interest—the growth rate $\\sigma$ and the real angular frequency $\\omega$—as $\\lambda = \\sigma - i\\omega$. Therefore, once $\\lambda_{max}$ is found, we can extract:\n-   The growth rate: $\\sigma = \\Re(\\lambda_{max})$\n-   The angular frequency: $\\omega = -\\Im(\\lambda_{max})$\n\nThe phase speed, $c_p$, is the speed at which crests of the wave propagate. It is defined as the ratio of the angular frequency to the wavenumber. For a non-zero wavenumber $k \\neq 0$, the phase speed is $c_p = \\omega/k$. For the special case of a spatially uniform mode where $k=0$, the mode is non-propagating, and its phase speed is defined as $c_p = 0$.\n\nThe computational procedure is as follows:\n1.  For each test case, assemble the complex-valued matrix $\\mathbf{L}$ using the given parameters.\n2.  Use a numerical library (e.g., `numpy.linalg.eigvals`) to compute the two eigenvalues of $\\mathbf{L}$.\n3.  Identify the eigenvalue with the maximum real part, $\\lambda_{max}$.\n4.  Calculate $\\sigma = \\Re(\\lambda_{max})$ and $\\omega = -\\Im(\\lambda_{max})$.\n5.  Calculate $c_p$ using the appropriate definition based on the value of $k$.\n6.  Store and format the resulting pair $(\\sigma, c_p)$ for each test case.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the growth rate and phase speed for MJO moisture modes.\n    \"\"\"\n    \n    # Define fixed physical parameters as per the problem statement.\n    alpha = 0.02  # Coupling coefficient\n    beta = 0.001  # Evaporation-wind coupling\n    mu = 1.0e-6   # Linear friction rate [s^-1]\n\n    # Define the test cases, each a tuple of (epsilon, S, k, U).\n    # Units: epsilon [s^-1], S [dimensionless], k [m^-1], U [m/s].\n    k_val = 2 * np.pi / 15_000_000  # Zonal wavenumber for most cases\n\n    test_cases = [\n        # Case A: baseline negative Gross Moist Stability\n        (2.0e-6, -0.5, k_val, 0.0),\n        # Case B: strong damping\n        (5.0e-6, 0.5, k_val, 0.0),\n        # Case C: nearly neutral net precipitation sink\n        (1.5e-6, -1.0, k_val, 0.0),\n        # Case D: strongly negative GMS with weak mean flow\n        (1.2e-6, -2.0, k_val, 1.0),\n        # Case E: non-propagating boundary case\n        (2.0e-6, -0.5, 0.0, 0.0),\n        # Case F: very negative GMS, westward mean wind\n        (1.8e-6, -2.5, k_val, -2.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        epsilon, S, k, U = case\n\n        # Construct the 2x2 linear operator matrix L for the (q, u) system.\n        # The eigenvalue problem is L*v = lambda*v.\n        L11 = -epsilon * (1 + S) - 1j * U * k\n        L12 = beta\n        L21 = -1j * alpha * k\n        L22 = -mu\n        \n        L = np.array([[L11, L12], [L21, L22]], dtype=np.complex128)\n\n        # Compute the eigenvalues of the matrix L.\n        eigenvalues = np.linalg.eigvals(L)\n\n        # Select the eigenvalue with the largest real part (most unstable mode).\n        lambda_max = eigenvalues[np.argmax(np.real(eigenvalues))]\n\n        # Extract growth rate (sigma) and angular frequency (omega) from the\n        # definition provided: lambda = sigma - i*omega.\n        sigma = np.real(lambda_max)\n        omega = -np.imag(lambda_max)\n\n        # Calculate phase speed c_p, handling the k=0 case.\n        if k == 0:\n            c_p = 0.0\n        else:\n            c_p = omega / k\n            \n        results.extend([sigma, c_p])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "A central challenge in simulating the MJO is accurately representing deep convection, a process that occurs on scales far smaller than a climate model's grid. This practice delves into the heart of this issue by modeling a convective scheme as a simple relaxation process, often termed 'convective quasi-equilibrium'. By analyzing how this simplified system responds to forcing at different frequencies , you will gain insight into how the chosen convective adjustment timescale, $\\tau$, can selectively amplify or damp variability, helping to explain why some models produce a realistic MJO while others fail.",
            "id": "4101598",
            "problem": "You are to design and analyze a linear convective quasi-equilibrium closure for the Madden–Julian Oscillation (MJO) in a single-column setting grounded in basic physical principles. Begin from the notion that deep convection rapidly adjusts the column toward neutral buoyancy by consuming Convective Available Potential Energy (CAPE), and that large-scale processes (e.g., radiative tendencies and moisture advection) act as external sources for CAPE. Use the following fundamental base: (i) the tendency of a prognostic variable equals the sum of sinks and sources, (ii) a linear relaxation process implies exponential decay toward equilibrium with a single timescale, and (iii) a linear time-invariant system forced by a sinusoid responds at the same frequency, while linear response to white-noise forcing is characterized by the squared magnitude of its transfer function.\n\nFormulate a scalar linear time-invariant model for CAPE, denoted by $C(t)$, under the following assumptions:\n- Deep convection acts as a linear relaxation sink that removes CAPE on a timescale $\\tau$ (in days).\n- There is an additive large-scale deterministic sinusoidal source representing intraseasonal modulation at a period associated with the Madden–Julian Oscillation (MJO), and an additive stochastic white-noise source representing weather-scale variability.\n- Time is measured in days, $t$ in days, and all angular frequencies $\\omega$ are in radians per day. The CAPE source term amplitude $S_{\\mathrm{a}}$ must be in units of joules per kilogram per day.\n\nFrom this base, derive the linear frequency response and the resulting analytic expressions sufficient to compute, for a given relaxation timescale $\\tau$:\n- The steady-state amplitude of $C(t)$ at the MJO angular frequency $\\omega_{0} = 2\\pi/T_{0}$ due to a sinusoidal source of amplitude $S_{\\mathrm{a}}$ with period $T_{0}$ (in days). Express the amplitude in joules per kilogram (J/kg).\n- The fraction of variance of $C(t)$ induced by the white-noise source that lies in the MJO band defined by periods between $T_{\\mathrm{hi}}$ and $T_{\\mathrm{lo}}$ (in days), i.e., angular frequencies between $\\omega_{\\mathrm{lo}} = 2\\pi/T_{\\mathrm{lo}}$ and $\\omega_{\\mathrm{hi}} = 2\\pi/T_{\\mathrm{hi}}$. Express the fraction as a dimensionless decimal, not a percentage.\n\nSpecifications and parameters:\n- Use $T_{0} = 48$ (days) for the MJO sinusoidal source period.\n- Use $T_{\\mathrm{lo}} = 30$ (days) and $T_{\\mathrm{hi}} = 90$ (days) for the MJO variance band.\n- Use a sinusoidal source amplitude $S_{\\mathrm{a}} = 50$ (J/kg/day).\n- Assume idealized Gaussian white-noise forcing with constant spectral density; ensure your variance-fraction result is independent of the absolute noise level.\n\nTest suite:\n- Evaluate the two outputs for the relaxation timescale values $\\tau \\in \\{0.5, 2, 5, 10, 20, 40\\}$ (all in days).\n- For each $\\tau$, compute:\n  1) The steady-state sinusoidal response amplitude at $T_{0}$ in J/kg.\n  2) The fraction of white-noise-driven variance in the band $[T_{\\mathrm{hi}}, T_{\\mathrm{lo}}]$ as a decimal.\n\nNumerical and output requirements:\n- All angles must be treated in radians; all times are in days; amplitudes are in J/kg.\n- Round both computed quantities for each $\\tau$ to exactly $6$ decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is a two-element list for one $\\tau$: for example, $[[a_{1},f_{1}],[a_{2},f_{2}],\\dots]$, where $a_{k}$ is the amplitude (J/kg) and $f_{k}$ is the variance fraction (decimal).",
            "solution": "The problem statement is analyzed and found to be valid. It is scientifically grounded in the principles of linear systems theory and simplified atmospheric dynamics, specifically the concept of a quasi-equilibrium closure for convection. The problem is well-posed, objective, and provides a complete set of parameters and definitions necessary for a unique solution. We may therefore proceed with the derivation and computation.\n\nThe central task is to formulate and analyze a scalar linear time-invariant model for Convective Available Potential Energy, $C(t)$, governed by physical principles outlined in the problem. The governing ordinary differential equation is constructed based on the principle that the time rate of change of $C(t)$ is the sum of sources and sinks.\n\nThe sink term, representing the consumption of CAPE by deep convection, is modeled as a linear relaxation process with a timescale $\\tau$. This term is expressed as $-\\frac{1}{\\tau}C(t)$. The source term, $S(t)$, comprises a deterministic sinusoidal component, $S_{det}(t)$, and a stochastic white-noise component, $S_{sto}(t)$. The complete governing equation is:\n$$\n\\frac{dC(t)}{dt} + \\frac{1}{\\tau}C(t) = S(t) = S_{det}(t) + S_{sto}(t)\n$$\nThis is a first-order linear ordinary differential equation. Such a system is known to act as a low-pass filter. The analysis of the two required outputs—the steady-state sinusoidal amplitude and the fractional variance from white-noise forcing—relies on the frequency-domain representation of this system.\n\nThe transfer function, $H(\\omega)$, of a linear time-invariant (LTI) system describes its steady-state response to a sinusoidal input of unit amplitude. For our system, we can find $H(\\omega)$ by considering an input $e^{i\\omega t}$ and seeking a solution of the form $C(t) = H(\\omega)e^{i\\omega t}$. Substituting into the differential equation yields:\n$$\ni\\omega H(\\omega)e^{i\\omega t} + \\frac{1}{\\tau}H(\\omega)e^{i\\omega t} = e^{i\\omega t}\n$$\nSolving for $H(\\omega)$, we find the transfer function:\n$$\nH(\\omega) = \\frac{1}{1/\\tau + i\\omega}\n$$\nwhere $i = \\sqrt{-1}$ is the imaginary unit and $\\omega$ is the angular frequency in radians per day.\n\n**1. Steady-State Amplitude Response to Sinusoidal Forcing**\n\nThe first quantity to be computed is the amplitude of $C(t)$ in response to a deterministic sinusoidal source with period $T_0 = 48$ days and amplitude $S_{\\mathrm{a}} = 50$ J/kg/day. The source is $S_{det}(t) = S_{\\mathrma}\\cos(\\omega_0 t)$, where the MJO angular frequency is $\\omega_0 = 2\\pi/T_0$. Using complex notation, the source is the real part of $S_{\\mathrma}e^{i\\omega_0 t}$.\n\nThe steady-state response of the LTI system is $C(t) = \\text{Re}[H(\\omega_0) S_{\\mathrm{a}}e^{i\\omega_0 t}]$. The amplitude of this response, which we denote as $A$, is the magnitude of the complex number $H(\\omega_0) S_{\\mathrma}$:\n$$\nA = |H(\\omega_0) S_{\\mathrma}| = S_{\\mathrma} |H(\\omega_0)| = S_{\\mathrma} \\left| \\frac{1}{1/\\tau + i\\omega_0} \\right|\n$$\nThe magnitude of the transfer function is:\n$$\n|H(\\omega_0)| = \\frac{1}{\\sqrt{(1/\\tau)^2 + \\omega_0^2}}\n$$\nTherefore, the amplitude of the CAPE response is:\n$$\nA(\\tau) = \\frac{S_{\\mathrma}}{\\sqrt{1/\\tau^2 + \\omega_0^2}} = \\frac{S_{\\mathrma}}{\\sqrt{1/\\tau^2 + (2\\pi/T_0)^2}}\n$$\nThe units of $A$ are (J/kg/day) / (1/day) = J/kg, as required.\n\n**2. Fraction of Variance from White-Noise Forcing**\n\nThe second quantity is the fraction of variance of $C(t)$ induced by a white-noise source, $S_{sto}(t)$, that lies within a specific MJO frequency band. We assume $S_{sto}(t)$ is an idealized Gaussian white-noise process with a constant power spectral density (PSD), $P_S(\\omega) = P_0$, for all frequencies $\\omega$.\n\nThe PSD of the output of an LTI system, $P_C(\\omega)$, is related to the input PSD by the squared magnitude of the transfer function:\n$$\nP_C(\\omega) = |H(\\omega)|^2 P_S(\\omega) = \\frac{P_0}{1/\\tau^2 + \\omega^2}\n$$\nThe variance of a stochastic process is the integral of its PSD over all frequencies. The total variance, $\\sigma^2_{\\text{total}}$, is:\n$$\n\\sigma^2_{\\text{total}} = \\int_{-\\infty}^{\\infty} P_C(\\omega) d\\omega = \\int_{-\\infty}^{\\infty} \\frac{P_0}{1/\\tau^2 + \\omega^2} d\\omega\n$$\nUsing the standard integral $\\int \\frac{1}{a^2+x^2}dx = \\frac{1}{a}\\arctan(\\frac{x}{a})$, with $a=1/\\tau$:\n$$\n\\sigma^2_{\\text{total}} = P_0 \\left[ \\tau \\arctan(\\omega\\tau) \\right]_{-\\infty}^{\\infty} = P_0 \\tau (\\pi/2 - (-\\pi/2)) = P_0 \\pi \\tau\n$$\nThe MJO band is defined by periods $T_{\\mathrm{lo}} = 30$ days and $T_{\\mathrm{hi}} = 90$ days. This corresponds to an angular frequency interval $[\\omega_{\\mathrm{hi}}, \\omega_{\\mathrm{lo}}]$, where $\\omega_{\\mathrm{lo}} = 2\\pi/T_{\\mathrm{lo}}$ and $\\omega_{\\mathrm{hi}} = 2\\pi/T_{\\mathrm{hi}}$. The variance within this band, $\\sigma^2_{\\text{band}}$, is found by integrating the PSD over this frequency range (including negative frequencies):\n$$\n\\sigma^2_{\\text{band}} = \\int_{-\\omega_{\\mathrm{lo}}}^{-\\omega_{\\mathrm{hi}}} P_C(\\omega) d\\omega + \\int_{\\omega_{\\mathrm{hi}}}^{\\omega_{\\mathrm{lo}}} P_C(\\omega) d\\omega = 2 \\int_{\\omega_{\\mathrm{hi}}}^{\\omega_{\\mathrm{lo}}} \\frac{P_0}{1/\\tau^2 + \\omega^2} d\\omega\n$$\nThe integral evaluates to:\n$$\n\\sigma^2_{\\text{band}} = 2 P_0 \\left[ \\tau \\arctan(\\omega\\tau) \\right]_{\\omega_{\\mathrm{hi}}}^{\\omega_{\\mathrm{lo}}} = 2 P_0 \\tau (\\arctan(\\omega_{\\mathrmlo}\\tau) - \\arctan(\\omega_{\\mathrmhi}\\tau))\n$$\nThe fraction of variance, $f$, is the ratio $\\sigma^2_{\\text{band}} / \\sigma^2_{\\text{total}}$. The unknown white-noise level $P_0$ cancels out:\n$$\nf(\\tau) = \\frac{2 P_0 \\tau (\\arctan(\\omega_{\\mathrmlo}\\tau) - \\arctan(\\omega_{\\mathrmhi}\\tau))}{P_0 \\pi \\tau} = \\frac{2}{\\pi} (\\arctan(\\omega_{\\mathrmlo}\\tau) - \\arctan(\\omega_{\\mathrmhi}\\tau))\n$$\nSubstituting the expressions for the frequencies:\n$$\nf(\\tau) = \\frac{2}{\\pi} \\left( \\arctan\\left(\\frac{2\\pi\\tau}{T_{\\mathrm{lo}}}\\right) - \\arctan\\left(\\frac{2\\pi\\tau}{T_{\\mathrm{hi}}}\\right) \\right)\n$$\nThis provides a dimensionless fraction, as required. The following Python program implements these two derived formulas, $A(\\tau)$ and $f(\\tau)$, to compute the requested values for the specified test suite of $\\tau$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates MJO-related response metrics for a simplified\n    linear convective quasi-equilibrium model.\n    \"\"\"\n    # Define the test cases and parameters from the problem statement.\n    test_taus = [0.5, 2.0, 5.0, 10.0, 20.0, 40.0]  # Relaxation timescales in days\n\n    # Given physical parameters\n    S_a = 50.0   # Sinusoidal source amplitude in J/kg/day\n    T_0 = 48.0   # MJO period for sinusoidal forcing in days\n    T_lo = 30.0  # Lower bound of MJO period band in days\n    T_hi = 90.0  # Upper bound of MJO period band in days\n\n    # Convert periods to angular frequencies (radians per day)\n    omega_0 = 2.0 * np.pi / T_0\n    # Note: higher period corresponds to lower frequency\n    omega_lo = 2.0 * np.pi / T_lo\n    omega_hi = 2.0 * np.pi / T_hi\n\n    # List to store the results for each tau\n    results = []\n\n    for tau in test_taus:\n        # 1. Calculate the steady-state sinusoidal response amplitude\n        # Formula: A = S_a / sqrt(1/tau^2 + omega_0^2)\n        amplitude = S_a / np.sqrt(1.0 / tau**2 + omega_0**2)\n\n        # 2. Calculate the fraction of white-noise-driven variance in the MJO band\n        # Formula: f = (2/pi) * (arctan(omega_lo * tau) - arctan(omega_hi * tau))\n        variance_fraction = (2.0 / np.pi) * (np.arctan(omega_lo * tau) - np.arctan(omega_hi * tau))\n\n        # Round the computed quantities to 6 decimal places\n        amp_rounded = round(amplitude, 6)\n        frac_rounded = round(variance_fraction, 6)\n\n        # Append the pair of results to the list\n        results.append([amp_rounded, frac_rounded])\n\n    # Format the final output string as specified: [[a1,f1],[a2,f2],...]\n    # without spaces after commas inside the sub-lists.\n    output_parts = [f\"[{res[0]},{res[1]}]\" for res in results]\n    final_output_string = f\"[{','.join(output_parts)}]\"\n\n    # Final print statement in the exact required format.\n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}