{
    "hands_on_practices": [
        {
            "introduction": "本练习从全球水循环最核心的质量守恒原理出发。通过假设全球平均蒸发量等于全球平均降水量，我们可以利用已知的全球降水数据和海陆面积比例，来估算海洋这一关键区域的蒸发率。这项基础的匡算练习有助于我们建立对全球水循环各分量级数的直观认识，并理解简化假设在预算分析中的作用和局限性。",
            "id": "4100576",
            "problem": "在数值天气预报 (NWP) 和气候模拟中，全球水文循环的闭合遵循大气中水物质的守恒。考虑一个统计稳态的气候，其中长期、垂直积分的大气水储量趋势可忽略不计，因此全球、面积平均蒸发量等于全球、面积平均降水量。设地球的海洋面积分数为 $f_{o}$，陆地面积分数为 $f_{\\ell} = 1 - f_{o}$。设全球范围内的长期、面积平均降水量为 $P$（定义为地球表面每单位面积的量）。设海洋和陆地上的长期、面积平均蒸发量（分别定义为其各自表面每单位面积的量）分别为 $E_{o}$ 和 $E_{\\ell}$。那么，全球、面积平均蒸发量满足 $E = f_{o} E_{o} + f_{\\ell} E_{\\ell}$，并且稳态下的全球水量守恒意味着 $E = P$。\n\n根据观测估计值 $P = 2.7$ mm day$^{-1}$ 和 $f_{o} = 0.71$，完成以下任务：\n1) 仅使用上述基本质量守恒陈述和面积加权，在大陆蒸发可忽略不计（$E_{\\ell} \\approx 0$）的假设下，推导并计算出隐含的 $E_{o}$。\n2) 如果实际上大陆蒸发量为 $E_{\\ell} = 0.5$ mm day$^{-1}$，量化由此产生的 $E_{o}$ 的绝对误差。\n\n将所求的两个量都以 mm day$^{-1}$ 为单位表示。将您的答案四舍五入到四位有效数字。",
            "solution": "基本依据是在稳态条件下应用于全球大气的水物质守恒。在足够长的时间内取平均，垂直积分的大气水量收支简化为全球、面积平均蒸发量和降水量的相等关系：\n$$\nE = P.\n$$\n这里 $E$ 表示全球、面积平均蒸发量（地球表面每单位面积的量），$P$ 是全球、面积平均降水量（地球表面每单位面积的量）。由于地表被划分为海洋和陆地，其各自的面积分数为 $f_{o}$ 和 $f_{\\ell} = 1 - f_{o}$，因此全球平均蒸发量是各分量通量的面积加权平均值：\n$$\nE = f_{o} E_{o} + f_{\\ell} E_{\\ell}.\n$$\n将其与质量守恒相结合，得到\n$$\nP = f_{o} E_{o} + f_{\\ell} E_{\\ell}.\n$$\n\n第 1 部分：可忽略的大陆蒸发。如果 $E_{\\ell} \\approx 0$，那么\n$$\nP = f_{o} E_{o} \\quad \\Rightarrow \\quad E_{o} = \\frac{P}{f_{o}}.\n$$\n当 $P = 2.7$ mm day$^{-1}$ 且 $f_{o} = 0.71$ 时，\n$$\nE_{o}^{(0)} = \\frac{2.7}{0.71} \\ \\text{mm day}^{-1}.\n$$\n\n第 2 部分：当 $E_{\\ell} \\neq 0$ 时的绝对误差。如果实际的大陆蒸发量为 $E_{\\ell} = 0.5$ mm day$^{-1}$，那么满足收支的正确海洋蒸发量是\n$$\nE_{o}^{(\\text{true})} = \\frac{P - f_{\\ell} E_{\\ell}}{f_{o}},\n$$\n通过求解 $P = f_{o} E_{o} + f_{\\ell} E_{\\ell}$ 关于 $E_{o}$ 得到。假设 $E_{\\ell} \\approx 0$ 所产生的绝对误差是\n$$\n\\Delta E_{o} = \\left| E_{o}^{(0)} - E_{o}^{(\\text{true})} \\right|\n= \\left| \\frac{P}{f_{o}} - \\frac{P - f_{\\ell} E_{\\ell}}{f_{o}} \\right|\n= \\frac{f_{\\ell} E_{\\ell}}{f_{o}}.\n$$\n使用 $f_{o} = 0.71$，$f_{\\ell} = 1 - 0.71 = 0.29$ 和 $E_{\\ell} = 0.5$ mm day$^{-1}$，\n$$\n\\Delta E_{o} = \\frac{0.29 \\times 0.5}{0.71} \\ \\text{mm day}^{-1}.\n$$\n\n数值计算：\n- 当 $E_{\\ell} \\approx 0$ 时隐含的海洋蒸发量：\n$$\nE_{o}^{(0)} = \\frac{2.7}{0.71} \\approx 3.802816901\\ \\text{mm day}^{-1}.\n$$\n- 当 $E_{\\ell} = 0.5$ mm day$^{-1}$ 时的绝对误差：\n$$\n\\Delta E_{o} = \\frac{0.145}{0.71} = \\frac{29}{142} \\approx 0.204225352\\ \\text{mm day}^{-1}.\n$$\n\n将两个量都四舍五入到四位有效数字并以 mm day$^{-1}$ 为单位表示，得到 $E_{o}^{(0)} \\approx 3.803$ mm day$^{-1}$ 和 $\\Delta E_{o} \\approx 0.2042$ mm day$^{-1}$。",
            "answer": "$$\\boxed{\\begin{pmatrix}3.803 & 0.2042\\end{pmatrix}}$$"
        },
        {
            "introduction": "在全球稳态平衡的基础上，我们需要进一步理解大气水汽收支在不同时空尺度上的动态变化。本练习通过尺度分析方法，探讨大气水汽存储的局地变化项（$\\partial_{t} W$）与地表净淡水通量（$E - P$）在日、周、季节等不同时间尺度下的相对重要性。掌握这一技能对于理解为何在天气预报（短时间尺度）和气候研究（长时间尺度）中可以采用不同的水汽收支简化方程至关重要。",
            "id": "4100545",
            "problem": "在数值天气预报（NWP）和气候模拟中，用于全球水循环的一个核心诊断量是整层大气水汽收支，它指出整层水汽储存的局地变化趋势由地表淡水通量和水平水汽输送来平衡。考虑在高度或气压坐标系下的整层大气水汽收支，其示意性写法为：\n$$\n\\partial_{t} W + \\nabla \\cdot \\mathbf{F} = E - P,\n$$\n其中，$W$ 是可降水量（通过 $1\\,\\mathrm{kg}\\,\\mathrm{m}^{-2} \\equiv 1\\,\\mathrm{mm}$ 换算成毫米的整层积分比湿），$\\mathbf{F}$ 是垂直积分的水平水汽通量，$E$ 是从地表到大气的蒸发，$P$ 是从大气到地表的降水。在尺度分析中，局地储存趋势的量级在时间尺度 $\\tau$ 上估计为 $|\\partial_t W| \\sim W/\\tau$，而净地表淡水通量的量级由 $|E-P|$ 表示。\n\n从上述收支方程和定义出发，推导一个无量纲比率，用于量化在时间尺度 $\\tau$ 上，局地储存趋势相对于净地表淡水通量的相对重要性。然后，使用科学上合理且广泛使用的深热带地区和中纬度温带地区的特征量级，评估该比率在日、周和季节性应用中的数值：\n\n- 深热带地区：可降水量 $W_{\\mathrm{trop}} = 50$ mm；特征净地表淡水通量量级 $|E-P|_{\\mathrm{trop}} = 6$ mm day$^{-1}$。\n- 中纬度温带地区：可降水量 $W_{\\mathrm{extr}} = 20$ mm；特征净地表淡水通量量级 $|E-P|_{\\mathrm{extr}} = 3$ mm day$^{-1}$。\n\n使用时间尺度 $\\tau_{\\mathrm{day}} = 1$ 天，$\\tau_{\\mathrm{week}} = 7$ 天，以及 $\\tau_{\\mathrm{season}} = 90$ 天。按以下顺序报告六个无量纲比率：热带地区（日、周、季节），温带地区（日、周、季节）。所有答案均表示为无量纲数，并四舍五入至三位有效数字。最终报告的值中不要包含单位。",
            "solution": "任务首先是推导一个无量纲比率，用于量化局地储存趋势相对于净地表淡水通量的相对重要性，然后针对两种不同的气候区域在三种不同的时间尺度上评估该比率。\n\n设无量纲比率为 $\\mathcal{R}$。根据定义，该比率是局地储存趋势项的量级除以净地表淡水通量项的量级。\n$$\n\\mathcal{R} = \\frac{|\\partial_t W|}{|E - P|}\n$$\n问题为局地储存趋势项的量级 $|\\partial_t W|$ 在特征时间尺度 $\\tau$ 上提供了一个尺度分析近似：\n$$\n|\\partial_t W| \\sim \\frac{W}{\\tau}\n$$\n其中 $W$ 是可降水量的特征量级。净地表淡水通量的量级作为特征值 $|E - P|$ 给出。\n\n将尺度分析近似代入 $\\mathcal{R}$ 的定义，我们得到该无量纲比率的公式：\n$$\n\\mathcal{R} = \\frac{W / \\tau}{|E - P|} = \\frac{W}{\\tau |E - P|}\n$$\n我们必须验证该比率确实是无量纲的。单位如下：\n-   $W$ 的单位是 mm。\n-   $\\tau$ 的单位是天。\n-   $|E - P|$ 的单位是 mm day$^{-1}$。\n因此，该表达式的单位为 $\\frac{[\\text{mm}]}{[\\text{day}] \\times [\\text{mm day}^{-1}]} = \\frac{[\\text{mm}]}{[\\text{mm}]}$，这是无量纲的。推导出的公式是正确的。\n\n现在，我们针对六个指定情况计算该比率，并将结果四舍五入到三位有效数字。\n\n**1. 深热带地区 ($W = W_{\\mathrm{trop}} = 50$ mm, $|E-P| = |E-P|_{\\mathrm{trop}} = 6$ mm day$^{-1}$)**\n\n-   **日时间尺度 ($\\tau = \\tau_{\\mathrm{day}} = 1$ 天):**\n    $$\n    \\mathcal{R}_{\\mathrm{trop, day}} = \\frac{50 \\text{ mm}}{(1 \\text{ day}) \\times (6 \\text{ mm day}^{-1})} = \\frac{50}{6} = \\frac{25}{3} \\approx 8.333... \\approx 8.33\n    $$\n\n-   **周时间尺度 ($\\tau = \\tau_{\\mathrm{week}} = 7$ 天):**\n    $$\n    \\mathcal{R}_{\\mathrm{trop, week}} = \\frac{50 \\text{ mm}}{(7 \\text{ days}) \\times (6 \\text{ mm day}^{-1})} = \\frac{50}{42} = \\frac{25}{21} \\approx 1.1904... \\approx 1.19\n    $$\n\n-   **季节时间尺度 ($\\tau = \\tau_{\\mathrm{season}} = 90$ 天):**\n    $$\n    \\mathcal{R}_{\\mathrm{trop, season}} = \\frac{50 \\text{ mm}}{(90 \\text{ days}) \\times (6 \\text{ mm day}^{-1})} = \\frac{50}{540} = \\frac{5}{54} \\approx 0.09259... \\approx 0.0926\n    $$\n\n**2. 中纬度温带地区 ($W = W_{\\mathrm{extr}} = 20$ mm, $|E-P| = |E-P|_{\\mathrm{extr}} = 3$ mm day$^{-1}$)**\n\n-   **日时间尺度 ($\\tau = \\tau_{\\mathrm{day}} = 1$ 天):**\n    $$\n    \\mathcal{R}_{\\mathrm{extr, day}} = \\frac{20 \\text{ mm}}{(1 \\text{ day}) \\times (3 \\text{ mm day}^{-1})} = \\frac{20}{3} \\approx 6.666... \\approx 6.67\n    $$\n\n-   **周时间尺度 ($\\tau = \\tau_{\\mathrm{week}} = 7$ 天):**\n    $$\n    \\mathcal{R}_{\\mathrm{extr, week}} = \\frac{20 \\text{ mm}}{(7 \\text{ days}) \\times (3 \\text{ mm day}^{-1})} = \\frac{20}{21} \\approx 0.95238... \\approx 0.952\n    $$\n\n-   **季节时间尺度 ($\\tau = \\tau_{\\mathrm{season}} = 90$ 天):**\n    $$\n    \\mathcal{R}_{\\mathrm{extr, season}} = \\frac{20 \\text{ mm}}{(90 \\text{ days}) \\times (3 \\text{ mm day}^{-1})} = \\frac{20}{270} = \\frac{2}{27} \\approx 0.07407... \\approx 0.0741\n    $$\n\n按照要求的顺序——热带地区（日、周、季节），然后是温带地区（日、周、季节）——计算出的六个无量纲比率是：$8.33$、$1.19$、$0.0926$、$6.67$、$0.952$ 和 $0.0741$。这些结果表明，大气水的局地储存在日时间尺度上是水汽收支中的主导项，在周时间尺度上与地表通量相当，而在季节时间尺度上是一个相对次要的项，此时收支主要表现为水汽通量辐散与净地表通量之间的平衡。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 8.33 & 1.19 & 0.0926 & 6.67 & 0.952 & 0.0741 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "本练习将视角从宏观理论转向区域性的数据驱动分析。通过应用海洋混合层中的盐度守恒原理，我们可以利用现场观测的盐度数据和卫星遥感的蒸发-降水（$E - P$）数据来构建区域淡水收支，并推算如垂直混合等难以直接观测的过程。这项练习模拟了物理海洋学和气候科学中的真实研究任务，它强调了在处理不完整观测数据时如何估算收支的残余项及其不确定性，是数值模型评估和数据分析中的一项高级技能。",
            "id": "4100550",
            "problem": "您的任务是根据模拟实时地转海洋学观测阵(Argo)盐度剖面和卫星衍生的蒸发减去降水(E-P)通量的理想化、区域平均观测数据，构建一个区域混合层淡水收支。从海洋混合层中的盐量守恒出发，推导出一个代表未解析的垂直混合和夹带的可计算残差项。然后，使用一组综合但物理上真实的测试案例，实现该计算及其一阶不确定性。\n\n基本原理：\n- 混合层中的盐量守恒：混合层盐含量的瞬时变化率由那些不通过海-气界面传输盐分，但能通过淡水通量的稀释或浓缩、水平输运、夹带和垂直湍流扩散来改变盐度的过程所决定。\n- 混合层平均绝对盐度（由《2010年海水热力学方程》定义，单位为克/千克）用 $S(t)$ 表示，单位为 $\\mathrm{g\\,kg^{-1}}$；混合层厚度用 $h$ 表示，单位为 $\\mathrm{m}$；淡水通量用 $F_{\\mathrm{fw}}$ 表示，单位为 $\\mathrm{m\\,s^{-1}}$。卫星观测提供蒸发减去降水(E-P)的估计值，表示为 $E - P$，因此 $F_{\\mathrm{fw}} = E - P$。\n- 表面淡水通量对混合层盐度的浓缩/稀释效应源于盐量守恒，并与盐度本身成正比。水平平流可以表示为一个趋势项 $A$，单位为 $\\mathrm{g\\,kg^{-1}\\,s^{-1}}$。\n- 海-气界面上没有盐通量；因此，淡水通量通过改变混合层的淡水含量来影响 $S$，而不是通过增加或减少盐量。\n\n目标量：\n- 将残余混合趋势 $T_{\\mathrm{mix}}$（单位 $\\mathrm{g\\,kg^{-1}\\,s^{-1}}$）定义为使用观测到的 $S$、$E - P$ 和 $h$ 以及一个给定的平流趋势 $A$ 来闭合混合层盐度趋势收支所需的项。将 $T_{\\mathrm{mix}}$ 完全用可观测的盐度趋势、淡水浓缩/稀释项和 $A$ 来表示。\n\n不确定性要求：\n- 将测量不确定性视为不相关且在平均周期内是平稳的。使用一阶（线性）误差传播来传播不确定性，以获得一西格玛标准不确定度 $u(T_{\\mathrm{mix}})$。使用中心差分法，根据在 $t_{0}$ 两侧对称间隔 $\\Delta t$ 的时间点 $t_{-}$ 和 $t_{+}$ 的盐度，来估计时间导数 $dS/dt$。\n\n数值定义和单位：\n- 绝对盐度 $S$ 的单位为 $\\mathrm{g\\,kg^{-1}}$。\n- 混合层厚度 $h$ 的单位为 $\\mathrm{m}$。\n- 淡水通量 $E - P$ 的单位为 $\\mathrm{m\\,s^{-1}}$，由给定的 $\\mathrm{mm\\,day^{-1}}$ 值推导得出：$(E - P)_{\\mathrm{m\\,s^{-1}}} = (E - P)_{\\mathrm{mm\\,day^{-1}}} \\times 10^{-3} / 86400$。\n- 平流趋势 $A$ 的单位为 $\\mathrm{g\\,kg^{-1}\\,s^{-1}}$。\n- 时间间隔 $\\Delta t$ 的单位为 $\\mathrm{s}$，由给定的天数值推导得出：$\\Delta t = (\\Delta t)_{\\mathrm{days}} \\times 86400$。\n\n计算规定：\n- 使用中心差分法估计 $t_{0}$ 处的盐度趋势：$dS/dt \\approx \\left(S(t_{+}) - S(t_{-})\\right) / (2 \\Delta t)$。\n- 在淡水浓缩/稀释项中使用 $t_{0}$ 时的混合层盐度，表示为 $S(t_{0})$。\n- 残余混合趋势被定义为在给定上述过程的情况下闭合收支的项。\n\n不确定性传播：\n- 假设不确定性 $u(S(t_{-}))$、$u(S(t_{+}))$、$u(S(t_{0}))$、$u(E - P)$、$u(h)$ 和 $u(A)$ 是独立的。使用一阶泰勒级数传播来计算 $u(T_{\\mathrm{mix}})$。\n- 程序必须显式地实现这种传播。\n\n测试套件：\n为以下四个案例实施计算。下文中的每个符号和数字都必须严格按给定的方式使用。所有数字都以物理上一致的单位提供；任何转换都必须遵循上述定义。\n\n- 案例1 (中纬度区域，中等强度强迫):\n  - $S(t_{-}) = 34.92\\,\\mathrm{g\\,kg^{-1}}$, $S(t_{+}) = 34.98\\,\\mathrm{g\\,kg^{-1}}$, $S(t_{0}) = 34.95\\,\\mathrm{g\\,kg^{-1}}$。\n  - $\\Delta t = 30\\,\\mathrm{days}$。\n  - $(E - P) = 3.5\\,\\mathrm{mm\\,day^{-1}}$。\n  - $h = 40\\,\\mathrm{m}$。\n  - $A = -0.5 \\times 10^{-8}\\,\\mathrm{g\\,kg^{-1}\\,s^{-1}}$。\n  - 不确定性: $u(S(t_{-})) = 0.01\\,\\mathrm{g\\,kg^{-1}}$, $u(S(t_{+})) = 0.01\\,\\mathrm{g\\,kg^{-1}}$, $u(S(t_{0})) = 0.01\\,\\mathrm{g\\,kg^{-1}}$, $u(E - P) = 0.7\\,\\mathrm{mm\\,day^{-1}}$, $u(h) = 2\\,\\mathrm{m}$, $u(A) = 0.3 \\times 10^{-8}\\,\\mathrm{g\\,kg^{-1}\\,s^{-1}}$。\n\n- 案例2 (薄混合层，弱强迫):\n  - $S(t_{-}) = 34.90\\,\\mathrm{g\\,kg^{-1}}$, $S(t_{+}) = 34.92\\,\\mathrm{g\\,kg^{-1}}$, $S(t_{0}) = 34.91\\,\\mathrm{g\\,kg^{-1}}$。\n  - $\\Delta t = 30\\,\\mathrm{days}$。\n  - $(E - P) = 1.5\\,\\mathrm{mm\\,day^{-1}}$。\n  - $h = 5\\,\\mathrm{m}$。\n  - $A = 0.0\\,\\mathrm{g\\,kg^{-1}\\,s^{-1}}$。\n  - 不确定性: $u(S(t_{-})) = 0.01\\,\\mathrm{g\\,kg^{-1}}$, $u(S(t_{+})) = 0.01\\,\\mathrm{g\\,kg^{-1}}$, $u(S(t_{0})) = 0.01\\,\\mathrm{g\\,kg^{-1}}$, $u(E - P) = 0.3\\,\\mathrm{mm\\,day^{-1}}$, $u(h) = 0.5\\,\\mathrm{m}$, $u(A) = 0.0\\,\\mathrm{g\\,kg^{-1}\\,s^{-1}}$。\n\n- 案例3 (净表面淡水通量为零):\n  - $S(t_{-}) = 35.00\\,\\mathrm{g\\,kg^{-1}}$, $S(t_{+}) = 35.02\\,\\mathrm{g\\,kg^{-1}}$, $S(t_{0}) = 35.01\\,\\mathrm{g\\,kg^{-1}}$。\n  - $\\Delta t = 30\\,\\mathrm{days}$。\n  - $(E - P) = 0.0\\,\\mathrm{mm\\,day^{-1}}$。\n  - $h = 30\\,\\mathrm{m}$。\n  - $A = 0.0\\,\\mathrm{g\\,kg^{-1}\\,s^{-1}}$。\n  - 不确定性: $u(S(t_{-})) = 0.005\\,\\mathrm{g\\,kg^{-1}}$, $u(S(t_{+})) = 0.005\\,\\mathrm{g\\,kg^{-1}}$, $u(S(t_{0})) = 0.005\\,\\mathrm{g\\,kg^{-1}}$, $u(E - P) = 0.2\\,\\mathrm{mm\\,day^{-1}}$, $u(h) = 1.0\\,\\mathrm{m}$, $u(A) = 0.0\\,\\mathrm{g\\,kg^{-1}\\,s^{-1}}$。\n\n- 案例4 (伴有平流的淡化):\n  - $S(t_{-}) = 34.80\\,\\mathrm{g\\,kg^{-1}}$, $S(t_{+}) = 34.76\\,\\mathrm{g\\,kg^{-1}}$, $S(t_{0}) = 34.78\\,\\mathrm{g\\,kg^{-1}}$。\n  - $\\Delta t = 30\\,\\mathrm{days}$。\n  - $(E - P) = -4.0\\,\\mathrm{mm\\,day^{-1}}$。\n  - $h = 50\\,\\mathrm{m}$。\n  - $A = 1.0 \\times 10^{-8}\\,\\mathrm{g\\,kg^{-1}\\,s^{-1}}$。\n  - 不确定性: $u(S(t_{-})) = 0.01\\,\\mathrm{g\\,kg^{-1}}$, $u(S(t_{+})) = 0.01\\,\\mathrm{g\\,kg^{-1}}$, $u(S(t_{0})) = 0.01\\,\\mathrm{g\\,kg^{-1}}$, $u(E - P) = 1.0\\,\\mathrm{mm\\,day^{-1}}$, $u(h) = 3.0\\,\\mathrm{m}$, $u(A) = 0.4 \\times 10^{-8}\\,\\mathrm{g\\,kg^{-1}\\,s^{-1}}$。\n\n所需输出：\n- 对于每个案例，计算 $T_{\\mathrm{mix}}$ 和 $u(T_{\\mathrm{mix}})$，单位均为 $\\mathrm{g\\,kg^{-1}\\,s^{-1}}$。\n- 将最终输出表示为四舍五入到十位有效数字的浮点数。\n- 您的程序应生成单行输出，其中包含结果，格式为逗号分隔的列表，并用方括号括起来，顺序为 $[T_{\\mathrm{mix},1},u(T_{\\mathrm{mix},1}),T_{\\mathrm{mix},2},u(T_{\\mathrm{mix},2}),T_{\\mathrm{mix},3},u(T_{\\mathrm{mix},3}),T_{\\mathrm{mix},4},u(T_{\\mathrm{mix},4})]$。",
            "solution": "目标是建立并计算一个残余混合趋势 $T_{\\mathrm{mix}}$，该趋势可以闭合混合层盐度收支，并确定其相关的不确定性。推导始于海洋混合层内盐量守恒的基本原理。\n\n混合层平均绝对盐度 $S$ 的时间变化率由各种物理过程引起的趋势之和决定。如问题所述，这些过程包括表面淡水通量、水平平流以及一个包含垂直混合和夹带的残余项。控制收支方程可以表示为：\n$$\n\\frac{dS}{dt} = \\left(\\frac{dS}{dt}\\right)_{\\text{fw}} + A + T_{\\mathrm{mix}}\n$$\n其中 $\\frac{dS}{dt}$ 是总的观测盐度趋势，$(\\frac{dS}{dt})_{\\text{fw}}$ 是由表面淡水通量引起的趋势，$A$ 是给定的平流趋势，而 $T_{\\mathrm{mix}}$ 是我们旨在确定的残余混合趋势。所有项的单位均为 $\\mathrm{g\\,kg^{-1}\\,s^{-1}}$。\n\n表面淡水通量项 $(\\frac{dS}{dt})_{\\text{fw}}$ 是由于混合层中盐的浓缩或稀释而产生的，因为海-气界面上没有盐通量。考虑一个单位面积的水柱，其混合层深度为 $h$，盐度为 $S$。此体积中的总盐量与乘积 $S \\cdot h$ 成正比。表面淡水通量 $F_{\\mathrm{fw}} = E - P$（其中 $E-P > 0$ 表示净蒸发）会在一个短时间间隔 $dt$ 内改变混合层的体积，但不会改变其盐含量。混合层的深度从 $h$ 变为 $h' = h - F_{\\mathrm{fw}} dt$。根据盐量守恒，新的盐度 $S'$ 必须满足 $S'h' = Sh$。\n因此，$S' = S \\frac{h}{h'} = S \\frac{h}{h - F_{\\mathrm{fw}} dt}$。\n对于一个微小的时间步长 $dt$，我们可以使用一阶泰勒展开：$S' \\approx S (1 + \\frac{F_{\\mathrm{fw}}}{h} dt)$。\n盐度的变化是 $\\Delta S = S' - S \\approx S \\frac{F_{\\mathrm{fw}}}{h} dt$。\n除以 $dt$ 得到由淡水通量引起的盐度趋势：\n$$\n\\left(\\frac{dS}{dt}\\right)_{\\text{fw}} = \\frac{S F_{\\mathrm{fw}}}{h} = \\frac{S (E-P)}{h}\n$$\n问题指定在此项中使用 $t_0$ 时刻的盐度，表示为 $S(t_0)$。这在数值模型中是常见的做法。将其代入收支方程可得：\n$$\n\\frac{dS}{dt} = \\frac{S(t_0) (E-P)}{h} + A + T_{\\mathrm{mix}}\n$$\n问题进一步规定，总盐度趋势 $\\frac{dS}{dt}$ 应使用基于 $t_{-} = t_0 - \\Delta t$ 和 $t_{+} = t_0 + \\Delta t$ 时刻盐度测量的中心差分格式在 $t_0$ 时刻进行估计：\n$$\n\\frac{dS}{dt} \\approx \\frac{S(t_{+}) - S(t_{-})}{2 \\Delta t}\n$$\n将此近似值代入收支方程并求解 $T_{\\mathrm{mix}}$，得到最终的计算公式：\n$$\nT_{\\mathrm{mix}} = \\frac{S(t_{+}) - S(t_{-})}{2 \\Delta t} - \\frac{S(t_{0})(E-P)}{h} - A\n$$\n该方程用给定的可观测数量表示了残余混合趋势。\n\n接下来，我们处理不确定性要求。$T_{\\mathrm{mix}}$ 的标准不确定度，表示为 $u(T_{\\mathrm{mix}})$，将使用一阶泰勒级数传播进行计算。假设输入变量——$S(t_{+})$、$S(t_{-})$、$S(t_0)$、$E-P$、$h$ 和 $A$——是独立的，则 $T_{\\mathrm{mix}}$ 的不确定度的平方（方差）由下式给出：\n$$\nu^2(T_{\\mathrm{mix}}) = \\sum_i \\left( \\frac{\\partial T_{\\mathrm{mix}}}{\\partial x_i} \\right)^2 u^2(x_i)\n$$\n其中 $x_i$ 代表每个独立变量，$u(x_i)$ 是其标准不确定度。$T_{\\mathrm{mix}}$ 的偏导数如下：\n- $\\frac{\\partial T_{\\mathrm{mix}}}{\\partial S(t_{+})} = \\frac{1}{2 \\Delta t}$\n- $\\frac{\\partial T_{\\mathrm{mix}}}{\\partial S(t_{-})} = -\\frac{1}{2 \\Delta t}$\n- $\\frac{\\partial T_{\\mathrm{mix}}}{\\partial S(t_0)} = -\\frac{E-P}{h}$\n- $\\frac{\\partial T_{\\mathrm{mix}}}{\\partial (E-P)} = -\\frac{S(t_0)}{h}$\n- $\\frac{\\partial T_{\\mathrm{mix}}}{\\partial h} = -S(t_0)(E-P) \\left(-\\frac{1}{h^2}\\right) = \\frac{S(t_0)(E-P)}{h^2}$\n- $\\frac{\\partial T_{\\mathrm{mix}}}{\\partial A} = -1$\n\n将这些导数代入不确定性传播公式，得到 $T_{\\mathrm{mix}}$ 方差的表达式：\n$$\nu^2(T_{\\mathrm{mix}}) = \\left(\\frac{1}{2 \\Delta t}\\right)^2 u^2(S(t_{+})) + \\left(-\\frac{1}{2 \\Delta t}\\right)^2 u^2(S(t_{-})) + \\left(-\\frac{E-P}{h}\\right)^2 u^2(S(t_0)) + \\left(-\\frac{S(t_0)}{h}\\right)^2 u^2(E-P) + \\left(\\frac{S(t_0)(E-P)}{h^2}\\right)^2 u^2(h) + (-1)^2 u^2(A)\n$$\n简化后，我们得到最终的方差公式：\n$$\nu^2(T_{\\mathrm{mix}}) = \\frac{u^2(S(t_{+})) + u^2(S(t_{-}))}{(2 \\Delta t)^2} + \\left(\\frac{E-P}{h}\\right)^2 u^2(S(t_0)) + \\left(\\frac{S(t_0)}{h}\\right)^2 u^2(E-P) + \\left(\\frac{S(t_0)(E-P)}{h^2}\\right)^2 u^2(h) + u^2(A)\n$$\n标准不确定度是该方差的平方根：$u(T_{\\mathrm{mix}}) = \\sqrt{u^2(T_{\\mathrm{mix}})}$。\n\n所有计算都必须在一组一致的单位中进行。基本单位是米 ($\\mathrm{m}$)、秒 ($\\mathrm{s}$) 和 $\\mathrm{g\\,kg^{-1}}$。所需的单位转换如下：\n- 时间：$(\\Delta t)_{\\mathrm{s}} = (\\Delta t)_{\\mathrm{days}} \\times 86400 \\, \\mathrm{s\\,day^{-1}}$\n- 淡水通量：$(E-P)_{\\mathrm{m\\,s^{-1}}} = (E-P)_{\\mathrm{mm\\,day^{-1}}} \\times \\frac{10^{-3} \\, \\mathrm{m\\,mm^{-1}}}{86400 \\, \\mathrm{s\\,day^{-1}}}$。不确定度 $u(E-P)$ 也必须使用相同的转换因子。\n\n实现过程将把这些公式应用于所提供的四个测试案例。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the residual mixing tendency (T_mix) and its uncertainty \n    for four test cases based on a mixed-layer salinity budget.\n    \"\"\"\n\n    SECONDS_PER_DAY = 86400.0\n    MM_PER_M = 1000.0\n    EP_CONVERSION_FACTOR = (1.0 / MM_PER_M) / SECONDS_PER_DAY\n\n    # Test cases as provided in the problem statement.\n    # Each tuple contains:\n    # (S_minus, S_plus, S_0, dt_days, EP_mm_day, h, A, \n    #  u_S_minus, u_S_plus, u_S_0, u_EP_mm_day, u_h, u_A)\n    test_cases = [\n        # Case 1 (Midlatitude box, moderate forcing)\n        (34.92, 34.98, 34.95, 30.0, 3.5, 40.0, -0.5e-8,\n         0.01, 0.01, 0.01, 0.7, 2.0, 0.3e-8),\n        # Case 2 (Thin mixed layer, weak forcing)\n        (34.90, 34.92, 34.91, 30.0, 1.5, 5.0, 0.0,\n         0.01, 0.01, 0.01, 0.3, 0.5, 0.0),\n        # Case 3 (Zero net surface freshwater flux)\n        (35.00, 35.02, 35.01, 30.0, 0.0, 30.0, 0.0,\n         0.005, 0.005, 0.005, 0.2, 1.0, 0.0),\n        # Case 4 (Freshening with advection)\n        (34.80, 34.76, 34.78, 30.0, -4.0, 50.0, 1.0e-8,\n         0.01, 0.01, 0.01, 1.0, 3.0, 0.4e-8)\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack case data\n        S_minus, S_plus, S_0, dt_days, EP_mm_day, h, A, \\\n        u_S_minus, u_S_plus, u_S_0, u_EP_mm_day, u_h, u_A = case\n\n        # Unit conversions to SI: seconds, m/s\n        dt_s = dt_days * SECONDS_PER_DAY\n        EP_m_s = EP_mm_day * EP_CONVERSION_FACTOR\n        u_EP_m_s = u_EP_mm_day * EP_CONVERSION_FACTOR\n\n        # --- Calculate T_mix ---\n        # Salinity tendency term\n        dS_dt_term = (S_plus - S_minus) / (2.0 * dt_s)\n        # Freshwater flux term\n        fw_flux_term = (S_0 * EP_m_s) / h\n        # Advection term is already in correct units\n        adv_term = A\n\n        T_mix = dS_dt_term - fw_flux_term - adv_term\n\n        # --- Calculate uncertainty u(T_mix) ---\n        # Variance from salinity tendency (S_plus, S_minus)\n        var_dS_dt = (u_S_plus**2 + u_S_minus**2) / (2.0 * dt_s)**2\n        \n        # Variance from S_0 in the freshwater flux term\n        var_S0 = ((EP_m_s / h)**2) * (u_S_0**2)\n        \n        # Variance from E-P in the freshwater flux term\n        var_EP = ((S_0 / h)**2) * (u_EP_m_s**2)\n        \n        # Variance from h in the freshwater flux term\n        var_h = (((S_0 * EP_m_s) / h**2)**2) * (u_h**2)\n        \n        # Variance from advection term A\n        var_A = u_A**2\n\n        # Total variance is the sum of independent contributions\n        total_variance = var_dS_dt + var_S0 + var_EP + var_h + var_A\n        \n        # Standard uncertainty is the square root of the total variance\n        u_T_mix = np.sqrt(total_variance)\n\n        # Format results to 10 significant digits as per problem description.\n        # This can be achieved by using a formatter like \"{:.9e}\".format(x)\n        # but the prompt's template uses `str()`, which we follow.\n        # The default precision of float64 and `str()` is sufficient.\n        results.extend([T_mix, u_T_mix])\n\n    # Format the final output string exactly as required.\n    # The default string representation of floats provides sufficient precision.\n    formatted_results = [f'{x:.9e}' for x in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}