{
    "hands_on_practices": [
        {
            "introduction": "The performance of an iterative solver is fundamentally characterized by its convergence factor, $\\rho$, which measures the rate of error reduction per iteration. However, for practical applications in forecasting or climate simulation, we need to translate this abstract factor into a concrete cost. This exercise provides hands-on practice in making this connection, asking you to estimate the number of multigrid V-cycles required to achieve a target level of accuracy, a critical skill for predicting solver performance and cost. ",
            "id": "4068391",
            "problem": "In a semi-implicit discretization of the rotating shallow-water equations used in Numerical Weather Prediction (NWP), the elliptic Helmholtz operator arising from off-centering of fast gravity-wave terms is symmetric positive definite (SPD). A Preconditioned Conjugate Gradient (PCG) method employs a single geometric multigrid V-cycle as a right preconditioner per outer iteration. Consider the stand-alone contraction of the V-cycle applied to the linear system residual. Let the two-grid convergence factor, defined as the asymptotic ratio of successive residual norms per V-cycle, be measured as $\\rho = 0.12$ under a red–black Gauss–Seidel smoother and standard coarsening on a latitude–longitude grid with moderate anisotropy typical of a midlatitude configuration.\n\nStarting from the definition of the residual $r_k$ and the convergence factor for a linear stationary process, determine the minimal integer $k$ such that the residual norm after $k$ V-cycles satisfies $\\|r_k\\| \\le 10^{-8}\\,\\|r_0\\|$. Validate your estimate by explicitly computing the achieved reduction factor $\\rho^{k}$. Report your answer as the pair $\\big(k,\\ \\rho^{k}\\big)$, with $\\rho^{k}$ rounded to $3$ significant figures. No units are required.",
            "solution": "The problem requires determining the minimum number of iterations, denoted by the integer $k$, for a stationary iterative process to achieve a specified reduction in the residual norm. The iterative process in question is a multigrid V-cycle, and its stand-alone convergence behavior is characterized by a given convergence factor.\n\nLet $r_i$ be the residual vector after $i$ applications of the V-cycle, with $r_0$ being the initial residual. The problem provides the asymptotic convergence factor, $\\rho$, defined as the ratio of the norms of successive residual vectors. For a linear stationary iterative method, this relationship is expressed as:\n$$ \\frac{\\|r_i\\|}{\\|r_{i-1}\\|} \\approx \\rho $$\nBy repeated application of this relation, we can express the norm of the residual after $k$ cycles, $\\|r_k\\|$, in terms of the initial residual norm, $\\|r_0\\|$:\n$$ \\|r_k\\| = \\frac{\\|r_k\\|}{\\|r_{k-1}\\|} \\frac{\\|r_{k-1}\\|}{\\|r_{k-2}\\|} \\cdots \\frac{\\|r_1\\|}{\\|r_0\\|} \\|r_0\\| \\approx \\rho^k \\|r_0\\| $$\nWe will treat this approximation as an equality for the purpose of this analysis, which is standard for estimating iteration counts based on an asymptotic factor.\n\nThe problem specifies the target for the residual reduction:\n$$ \\|r_k\\| \\le 10^{-8} \\|r_0\\| $$\nSubstituting the expression for $\\|r_k\\|$ into this inequality yields:\n$$ \\rho^k \\|r_0\\| \\le 10^{-8} \\|r_0\\| $$\nGiven that the initial residual must be non-zero for the problem to be meaningful (i.e., $\\|r_0\\|  0$), we can divide both sides by $\\|r_0\\|$:\n$$ \\rho^k \\le 10^{-8} $$\nThe given convergence factor is $\\rho = 0.12$. The inequality becomes:\n$$ (0.12)^k \\le 10^{-8} $$\nTo solve for $k$, we apply the natural logarithm to both sides. Since $\\ln(x)$ is a strictly increasing function, the direction of the inequality is preserved:\n$$ \\ln \\left( (0.12)^k \\right) \\le \\ln(10^{-8}) $$\nUsing the logarithm power rule $\\ln(a^b) = b \\ln(a)$, we get:\n$$ k \\ln(0.12) \\le -8 \\ln(10) $$\nTo isolate $k$, we must divide by $\\ln(0.12)$. Since the argument of the logarithm, $0.12$, is in the interval $(0, 1)$, its logarithm, $\\ln(0.12)$, is a negative number. Dividing an inequality by a negative number requires reversing the direction of the inequality sign:\n$$ k \\ge \\frac{-8 \\ln(10)}{\\ln(0.12)} $$\nUsing the numerical values for the logarithms, $\\ln(10) \\approx 2.302585$ and $\\ln(0.12) \\approx -2.120264$:\n$$ k \\ge \\frac{-8 \\times 2.302585}{-2.120264} \\approx \\frac{18.42068}{2.120264} \\approx 8.6879 $$\nThe problem requires the minimal integer value of $k$. Since $k$ must be greater than or equal to $8.6879$, the smallest integer that satisfies this condition is $k=9$.\n\nThe second task is to validate this result by computing the achieved reduction factor, $\\rho^k$, for $k=9$. We must round this value to $3$ significant figures.\n$$ \\rho^k = (0.12)^9 $$\n$$ (0.12)^9 \\approx 5.159780352 \\times 10^{-9} $$\nRounding this value to $3$ significant figures, we get $5.16 \\times 10^{-9}$. This value is indeed less than or equal to $10^{-8}$, confirming that $k=9$ is sufficient. For $k=8$, the reduction $\\rho^8 = (0.12)^8 \\approx 4.2998 \\times 10^{-8}$, which is greater than $10^{-8}$, confirming that $k=9$ is minimal.\n\nThus, the minimal number of V-cycles is $k=9$, and the corresponding residual norm reduction factor is approximately $5.16 \\times 10^{-9}$. The required answer is the pair $(k, \\rho^k)$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 9  5.16 \\times 10^{-9} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "In an ideal world, we would always choose the algorithm with the best convergence factor. In practice, especially in large-scale modeling, we must also consider how well an algorithm maps to parallel hardware. This problem delves into a classic trade-off by comparing lexicographic and red-black Gauss-Seidel smoothers. You will use Local Fourier Analysis and Amdahl's Law to quantify both the degradation in numerical smoothing and the significant gain in parallel speedup, illustrating a core design challenge in modern scientific computing. ",
            "id": "4068346",
            "problem": "Consider the semi-implicit pressure correction arising in a barotropic primitive-equation model used in numerical weather prediction and climate modeling. On a uniform latitude–longitude patch, the elliptic subproblem that must be solved at each time step can be idealized along a single horizontal line by the discrete one-dimensional Poisson operator with three-point stencil. Let the discrete operator be defined on the infinite uniform grid by $A u_i = -u_{i-1} + 2 u_i - u_{i+1}$, and consider iterative smoothing with the Gauss–Seidel (GS) method as part of a multigrid preconditioner for a Krylov solver such as the Preconditioned Conjugate Gradient (PCG).\n\nYou are to analyze the effect of red–black coloring on parallel Gauss–Seidel and quantify its impact relative to lexicographic order in two ways:\n\n1. Smoothing factor change: Using local Fourier analysis on the infinite grid, derive the error-amplification factor for a single forward lexicographic Gauss–Seidel sweep acting on a Fourier mode $e_i = \\exp(\\mathrm{i} \\theta i)$, and determine the lexicographic smoothing factor $\\mu_{\\mathrm{lex}}$ as the maximum of the amplification magnitude over the high-frequency set $\\Theta_{\\mathrm{hf}} = [\\pi/2,\\pi]$. Then, analyze a two-color red–black Gauss–Seidel sweep and determine its smoothing factor $\\mu_{\\mathrm{RB}}$ over the same high-frequency set. Finally, compute the change in smoothing, defined as the ratio $\\mu_{\\mathrm{RB}} / \\mu_{\\mathrm{lex}}$, and express this ratio as an exact closed-form expression.\n\n2. Parallel speedup: Model parallel execution on $P=64$ identical processing elements with Amdahl’s law. Assume that, due to wavefront dependencies, the fraction of work that can be parallelized under lexicographic ordering is $\\phi_{\\mathrm{lex}} = 0.70$, whereas under red–black coloring it is $\\phi_{\\mathrm{RB}} = 0.97$ (the remaining fractions account for synchronization and communication overhead). Let the parallel time factors relative to a purely sequential baseline be $t_{\\mathrm{lex}}(P) = (1 - \\phi_{\\mathrm{lex}}) + \\phi_{\\mathrm{lex}}/P$ and $t_{\\mathrm{RB}}(P) = (1 - \\phi_{\\mathrm{RB}}) + \\phi_{\\mathrm{RB}}/P$. Compute the expected speedup of red–black Gauss–Seidel relative to lexicographic, defined as $S = t_{\\mathrm{lex}}(P) / t_{\\mathrm{RB}}(P)$.\n\nRound the speedup $S$ to four significant figures and express it as a pure number. Express the smoothing-factor change $\\mu_{\\mathrm{RB}} / \\mu_{\\mathrm{lex}}$ as an exact expression. Your final answer must be given as a two-entry row matrix $\\begin{pmatrix} S  \\mu_{\\mathrm{RB}}/\\mu_{\\mathrm{lex}} \\end{pmatrix}$.",
            "solution": "The user wants me to analyze the performance of lexicographic versus red-black Gauss-Seidel smoothing for a 1D discrete Poisson operator, evaluating both the numerical smoothing factor and the parallel speedup.\n\n### Problem Validation\n\nFirst, I will validate the problem statement.\n\n**Step 1: Extract Givens**\n\n*   **Context:** Semi-implicit pressure correction in a barotropic primitive-equation model (numerical weather prediction and climate modeling).\n*   **Problem Domain:** Idealized one-dimensional elliptic subproblem on an infinite uniform grid.\n*   **Discrete Operator:** $A u_i = -u_{i-1} + 2 u_i - u_{i+1}$.\n*   **Iterative Method:** Gauss–Seidel (GS) smoothing.\n*   **Task 1: Smoothing Factor Analysis**\n    *   Analysis method: Local Fourier analysis.\n    *   Fourier mode: $e_i = \\exp(\\mathrm{i} \\theta i)$.\n    *   High-frequency set: $\\Theta_{\\mathrm{hf}} = [\\pi/2, \\pi]$.\n    *   Goal: Derive lexicographic smoothing factor $\\mu_{\\mathrm{lex}}$ and red–black smoothing factor $\\mu_{\\mathrm{RB}}$, then compute the ratio $\\mu_{\\mathrm{RB}} / \\mu_{\\mathrm{lex}}$.\n*   **Task 2: Parallel Speedup Analysis**\n    *   Model: Amdahl’s law.\n    *   Number of processing elements: $P = 64$.\n    *   Parallelizable fraction (lexicographic): $\\phi_{\\mathrm{lex}} = 0.70$.\n    *   Parallelizable fraction (red–black): $\\phi_{\\mathrm{RB}} = 0.97$.\n    *   Parallel time factor (lexicographic): $t_{\\mathrm{lex}}(P) = (1 - \\phi_{\\mathrm{lex}}) + \\phi_{\\mathrm{lex}}/P$.\n    *   Parallel time factor (red–black): $t_{\\mathrm{RB}}(P) = (1 - \\phi_{\\mathrm{RB}}) + \\phi_{\\mathrm{RB}}/P$.\n    *   Goal: Compute the relative speedup $S = t_{\\mathrm{lex}}(P) / t_{\\mathrm{RB}}(P)$ and round to four significant figures.\n*   **Final Answer Format:** A two-entry row matrix $\\begin{pmatrix} S  \\mu_{\\mathrm{RB}}/\\mu_{\\mathrm{lex}} \\end{pmatrix}$.\n\n**Step 2: Validate Using Extracted Givens**\n\n*   **Scientifically Grounded:** The problem is firmly grounded in the established field of numerical analysis for partial differential equations. The 1D Poisson operator, Gauss-Seidel methods (both lexicographic and red-black), local Fourier analysis (von Neumann analysis), and Amdahl's law are all standard, well-understood concepts. The application context in climate modeling is appropriate.\n*   **Well-Posed:** All necessary information, including the operator stencil, the definitions of the smoothing factors, the high-frequency range, and all parameters for the Amdahl's law calculation, are explicitly provided. The tasks are clearly defined and lead to unique, meaningful results.\n*   **Objective:** The problem is stated in precise, formal, and objective mathematical language.\n*   **Check for Flaws:** The problem does not violate any scientific principles, is not metaphorical, is complete, is physically and mathematically consistent, is well-posed, is not trivial, and is scientifically verifiable. The choice of $\\mu_{\\mathrm{RB}} = 1$ may seem counter-intuitive but it is the correct mathematical consequence of the definitions, highlighting a known weakness of point-wise red-black GS smoothing.\n\n**Step 3: Verdict and Action**\n\nThe problem is valid. I will proceed with providing a complete solution.\n\n### Solution\n\nThe solution is partitioned into two parts as requested: the smoothing factor analysis and the parallel speedup calculation.\n\n**Part 1: Smoothing Factor Analysis**\n\nWe analyze the convergence of the error $e^k = u^k - u^*$, where $u^k$ is the solution at iteration $k$ and $u^*$ is the exact solution. The error satisfies the homogeneous equation $A e^k = 0$. We seek the amplification factor $g(\\theta)$ of a Fourier mode $e_i^k = (g(\\theta))^k \\exp(\\mathrm{i} \\theta i)$ for one iteration.\n\n**A. Lexicographic Gauss–Seidel (GS) Smoothing**\n\nThe GS iteration updates points in a sequential, \"lexicographic\" order (e.g., from $i=...-1, 0, 1, ...$). For the operator $A u_i = -u_{i-1} + 2 u_i - u_{i+1} = f_i$, the error update at point $i$ uses the most recently computed values. For a forward sweep, this gives:\n$$2 e_i^{k+1} - e_{i-1}^{k+1} - e_{i+1}^{k} = 0$$\nWe substitute the ansatz for the error, where $e_i^{k+1} = g_{\\mathrm{lex}}(\\theta) e_i^k$:\n$$2 g_{\\mathrm{lex}}(\\theta) \\exp(\\mathrm{i} \\theta i) - g_{\\mathrm{lex}}(\\theta) \\exp(\\mathrm{i} \\theta (i-1)) - \\exp(\\mathrm{i} \\theta (i+1)) = 0$$\nDividing by $\\exp(\\mathrm{i} \\theta i)$:\n$$2 g_{\\mathrm{lex}}(\\theta) - g_{\\mathrm{lex}}(\\theta) \\exp(-\\mathrm{i} \\theta) - \\exp(\\mathrm{i} \\theta) = 0$$\nSolving for the amplification factor $g_{\\mathrm{lex}}(\\theta)$:\n$$g_{\\mathrm{lex}}(\\theta) (2 - \\exp(-\\mathrm{i} \\theta)) = \\exp(\\mathrm{i} \\theta)$$\n$$g_{\\mathrm{lex}}(\\theta) = \\frac{\\exp(\\mathrm{i} \\theta)}{2 - \\exp(-\\mathrm{i} \\theta)}$$\nWe find its magnitude:\n$$|g_{\\mathrm{lex}}(\\theta)|^2 = \\frac{|\\exp(\\mathrm{i} \\theta)|^2}{|2 - \\exp(-\\mathrm{i} \\theta)|^2} = \\frac{1}{|(2 - \\cos(\\theta)) + \\mathrm{i} \\sin(\\theta)|^2} = \\frac{1}{(2 - \\cos(\\theta))^2 + \\sin^2(\\theta)} = \\frac{1}{4 - 4\\cos(\\theta) + \\cos^2(\\theta) + \\sin^2(\\theta)} = \\frac{1}{5 - 4\\cos(\\theta)}$$\nSo, $|g_{\\mathrm{lex}}(\\theta)| = \\frac{1}{\\sqrt{5 - 4\\cos(\\theta)}}$.\nThe smoothing factor $\\mu_{\\mathrm{lex}}$ is the maximum of this magnitude over the high-frequency range $\\Theta_{\\mathrm{hf}} = [\\pi/2, \\pi]$. To maximize $|g_{\\mathrm{lex}}(\\theta)|$, we must minimize the denominator term $5 - 4\\cos(\\theta)$. On the interval $[\\pi/2, \\pi]$, the function $\\cos(\\theta)$ is monotonically decreasing. Thus, $-4\\cos(\\theta)$ is monotonically increasing, and so is $5 - 4\\cos(\\theta)$. The minimum of $5 - 4\\cos(\\theta)$ therefore occurs at the left endpoint, $\\theta = \\pi/2$.\n$$\\mu_{\\mathrm{lex}} = \\max_{\\theta \\in [\\pi/2, \\pi]} |g_{\\mathrm{lex}}(\\theta)| = |g_{\\mathrm{lex}}(\\pi/2)| = \\frac{1}{\\sqrt{5 - 4\\cos(\\pi/2)}} = \\frac{1}{\\sqrt{5 - 0}} = \\frac{1}{\\sqrt{5}}$$\n\n**B. Red–Black Gauss–Seidel (GS) Smoothing**\n\nIn red–black ordering, the grid points are partitioned into two sets (red and black), such that all neighbors of a red point are black, and vice versa. The iteration proceeds in two stages:\n1. Update all red points in parallel, using old values from their black neighbors.\n2. Update all black points in parallel, using the newly computed values from their red neighbors.\n\nThe iteration matrix for red-black GS applied to this problem is known to have eigenvalues $\\lambda(\\theta) = \\cos^2(\\theta)$. Thus, the amplification factor is $g_{\\mathrm{RB}}(\\theta) = \\cos^2(\\theta)$. This result stems from the fact that the iteration matrix is a product related to a Jacobi-like update, whose spectral radius is $|\\cos(\\theta)|$, and for red-black GS, the spectral radius of the iteration is the square of the Jacobi spectral radius.\nThe smoothing factor $\\mu_{\\mathrm{RB}}$ is the maximum of $|g_{\\mathrm{RB}}(\\theta)|$ over $\\Theta_{\\mathrm{hf}} = [\\pi/2, \\pi]$.\n$$\\mu_{\\mathrm{RB}} = \\max_{\\theta \\in [\\pi/2, \\pi]} |\\cos^2(\\theta)|$$\nOn the interval $[\\pi/2, \\pi]$, $\\cos(\\theta)$ ranges from $0$ to $-1$. Therefore, $\\cos^2(\\theta)$ ranges from $0$ to $1$. The function $\\cos^2(\\theta)$ is monotonically increasing on this interval. The maximum occurs at the right endpoint, $\\theta = \\pi$.\n$$\\mu_{\\mathrm{RB}} = \\cos^2(\\pi) = (-1)^2 = 1$$\nThis smoothing factor of $1$ indicates that the red-black GS method fails to damp the highest frequency mode $\\theta=\\pi$ (the checkerboard mode), a known deficiency of this point-wise smoother for the standard Laplacian.\n\n**C. Change in Smoothing Factor**\n\nThe change in smoothing is the ratio $\\mu_{\\mathrm{RB}} / \\mu_{\\mathrm{lex}}$:\n$$\\frac{\\mu_{\\mathrm{RB}}}{\\mu_{\\mathrm{lex}}} = \\frac{1}{1/\\sqrt{5}} = \\sqrt{5}$$\n\n**Part 2: Parallel Speedup Analysis**\n\nWe use the provided formulation of Amdahl's Law to calculate the parallel time factor for each method and then their ratio.\n\nGiven: $P = 64$, $\\phi_{\\mathrm{lex}} = 0.70$, $\\phi_{\\mathrm{RB}} = 0.97$.\n\nThe parallel time factor for the lexicographic method is:\n$$t_{\\mathrm{lex}}(P) = (1 - \\phi_{\\mathrm{lex}}) + \\frac{\\phi_{\\mathrm{lex}}}{P} = (1 - 0.70) + \\frac{0.70}{64}$$\n$$t_{\\mathrm{lex}}(64) = 0.30 + 0.0109375 = 0.3109375$$\n\nThe parallel time factor for the red–black method is:\n$$t_{\\mathrm{RB}}(P) = (1 - \\phi_{\\mathrm{RB}}) + \\frac{\\phi_{\\mathrm{RB}}}{P} = (1 - 0.97) + \\frac{0.97}{64}$$\n$$t_{\\mathrm{RB}}(64) = 0.03 + 0.01515625 = 0.04515625$$\n\nThe expected speedup $S$ of red–black relative to lexicographic GS is the ratio of their execution times:\n$$S = \\frac{t_{\\mathrm{lex}}(64)}{t_{\\mathrm{RB}}(64)} = \\frac{0.3109375}{0.04515625} \\approx 6.8860759...$$\nRounding to four significant figures, we get:\n$$S \\approx 6.886$$\n\nThis analysis highlights the trade-off: red–black ordering has superior parallel properties (higher speedup $S  1$) but inferior numerical smoothing properties for high-frequency modes (higher smoothing factor ratio $\\mu_{\\mathrm{RB}}/\\mu_{\\mathrm{lex}}  1$).\n\n**Final Answer Compilation**\n\nThe two requested values are the speedup $S$ and the smoothing-factor ratio $\\mu_{\\mathrm{RB}}/\\mu_{\\mathrm{lex}}$.\n$S \\approx 6.886$\n$\\mu_{\\mathrm{RB}}/\\mu_{\\mathrm{lex}} = \\sqrt{5}$\n\nThese are combined into a two-entry row matrix.",
            "answer": "$$\\boxed{\\begin{pmatrix} 6.886  \\sqrt{5} \\end{pmatrix}}$$"
        },
        {
            "introduction": "After analyzing individual components, we now turn to the performance of the entire multigrid V-cycle on a large-scale distributed system. The ultimate justification for using multigrid in demanding applications like NWP is its exceptional scalability. This exercise guides you through building a detailed parallel performance model from first principles, incorporating both computation and communication costs, to formally prove that multigrid's efficiency approaches the ideal limit as problem sizes grow. ",
            "id": "4068340",
            "problem": "Consider the semi-implicit discretization of the hydrostatic primitive equations used in numerical weather prediction, where a three-dimensional elliptic Helmholtz problem for the pressure correction is solved at each time step by a Krylov method, specifically Conjugate Gradient (CG), preconditioned by a geometric multigrid V-cycle. The global grid has $N$ scalar unknowns. The computation is executed on a distributed-memory system with $p$ processes using a regular three-dimensional domain decomposition into $p$ equal cubic subdomains, so that each process holds a local $n \\times n \\times n$ grid with $n = (N/p)^{1/3}$.\n\nAssume the following modeling assumptions grounded in standard performance modeling and multigrid methodology:\n\n- The geometric multigrid V-cycle has levels indexed by $\\ell = 0, 1, \\dots, L-1$, where the local grid on level $\\ell$ has dimensions $n_{\\ell} \\times n_{\\ell} \\times n_{\\ell}$ with $n_{\\ell} = n / 2^{\\ell}$, and the number of levels $L$ is such that $n_{L}$ is an $\\mathcal{O}(1)$ constant independent of $n$.\n- At each level $\\ell$, the smoother performs $\\nu$ total sweeps (sum of pre- and post-smoothing), and the floating-point work per unknown per sweep is $\\theta$ seconds (a hardware-dependent constant). Thus, the compute time per process on level $\\ell$ is $\\nu \\theta n_{\\ell}^{3}$ seconds.\n- Interlevel transfers (restriction and prolongation) are implemented locally and their compute work is linear in the number of local unknowns. Their communication costs are of the same order as a single halo exchange, and for the purpose of this model, their contribution is absorbed into the per-level halo exchange count below.\n- Each smoother sweep on level $\\ell$ requires one nearest-neighbor halo exchange of width $h$ grid points in each coordinate direction (with $h$ a small fixed integer), communicating with the $6$ face neighbors. The message size per neighbor per exchange on level $\\ell$ is proportional to the local face area, modeled as $\\sigma h n_{\\ell}^{2}$ unknowns, where $\\sigma$ is a fixed constant counting the number of communicated scalar fields per grid point in the halo. Using the latency-bandwidth (Hockney) model, the time per message is $t_{\\text{msg}} = \\tau + \\frac{\\sigma h n_{\\ell}^{2}}{\\beta}$, where $\\tau$ is the latency (seconds) and $\\beta$ is the sustainable bandwidth measured in unknowns per second.\n- Let $q$ denote the total number of halo exchanges per level, per V-cycle, per process, after absorbing restriction/prolongation contributions (so that for pure smoothing-only exchanges, $q = \\nu$; if restriction/prolongation also exchange halos, $q$ increases accordingly).\n\nUnder these assumptions:\n\n1. Derive the parallel execution time per process for one V-cycle, $T_{p}(N,p)$, as a function of $N$, $p$, $n$, $\\nu$, $\\theta$, $q$, $h$, $\\sigma$, $\\tau$, $\\beta$, and $L$, by summing the compute and communication contributions across levels.\n2. Derive the serial execution time for one V-cycle, $T_{1}(N)$, on a single process, under the same compute model.\n3. Define the parallel efficiency for one V-cycle as $E(N,p) = \\frac{T_{1}(N)}{p \\, T_{p}(N,p)}$. Using your derived expressions, evaluate the limit $\\lim_{N \\to \\infty} E(N,p)$ with $p$ held fixed. Provide the limiting value as a pure number without units.\n\nExpress any intermediate expressions symbolically. The final answer must be a single real-valued number. If you introduce any logarithms, clearly specify their base. No rounding is required for the final number.",
            "solution": "We begin with a performance model based on two foundational facts:\n\n- For a geometric multigrid V-cycle in three dimensions with uniform coarsening by a factor of $2$ in each coordinate per level, the number of unknowns per level decreases by a factor of $8$, so the sum of per-level compute work across a V-cycle is proportional to the total number of fine-grid unknowns times a geometric series with ratio $1/8$. This yields an $\\mathcal{O}(N)$ work model for compute.\n- The latency-bandwidth (Hockney) communication model states that the time to send a message of $m$ data items is $t_{\\text{msg}} = \\tau + \\frac{m}{\\beta}$, where $\\tau$ is the latency and $\\beta$ is the sustainable data rate (unknowns per second here). For halo exchanges on a cubic subdomain with local edge length $n_{\\ell}$, the communicated face area scales as $n_{\\ell}^{2}$, so message size per neighbor scales as $m \\propto n_{\\ell}^{2}$.\n\nWe now derive the per-process parallel execution time for a V-cycle, $T_{p}(N,p)$, by summing over levels:\n\n- Compute time per process on level $\\ell$ is\n$$\nT_{\\text{comp},\\ell} = \\nu \\theta n_{\\ell}^{3}.\n$$\n- Communication time per process on level $\\ell$ is\n$$\nT_{\\text{comm},\\ell} = 6 q \\left( \\tau + \\frac{\\sigma h n_{\\ell}^{2}}{\\beta} \\right),\n$$\nbecause there are $6$ neighbors, and $q$ total halo exchanges per level and per V-cycle.\n\nSumming from $\\ell = 0$ to $\\ell = L-1$ and using $n_{\\ell} = n/2^{\\ell}$, we obtain\n$$\nT_{\\text{comp}}(n,L) = \\sum_{\\ell=0}^{L-1} \\nu \\theta \\left( \\frac{n}{2^{\\ell}} \\right)^{3}\n= \\nu \\theta n^{3} \\sum_{\\ell=0}^{L-1} \\left( \\frac{1}{8} \\right)^{\\ell}.\n$$\nSimilarly,\n$$\nT_{\\text{comm}}(n,L) = \\sum_{\\ell=0}^{L-1} 6 q \\left[ \\tau + \\frac{\\sigma h}{\\beta} \\left( \\frac{n}{2^{\\ell}} \\right)^{2} \\right]\n= 6 q \\left[ L \\tau + \\frac{\\sigma h}{\\beta} n^{2} \\sum_{\\ell=0}^{L-1} \\left( \\frac{1}{4} \\right)^{\\ell} \\right].\n$$\n\nBoth sums are geometric. For the compute sum,\n$$\n\\sum_{\\ell=0}^{L-1} \\left( \\frac{1}{8} \\right)^{\\ell} = \\frac{1 - (1/8)^{L}}{1 - 1/8} = \\frac{1 - (1/8)^{L}}{7/8} = \\frac{8}{7} \\left[ 1 - \\left( \\frac{1}{8} \\right)^{L} \\right].\n$$\nFor the communication sum,\n$$\n\\sum_{\\ell=0}^{L-1} \\left( \\frac{1}{4} \\right)^{\\ell} = \\frac{1 - (1/4)^{L}}{1 - 1/4} = \\frac{1 - (1/4)^{L}}{3/4} = \\frac{4}{3} \\left[ 1 - \\left( \\frac{1}{4} \\right)^{L} \\right].\n$$\n\nFor a cubic local grid with $n = (N/p)^{1/3}$, the number of levels $L$ is the largest integer such that $n/2^{L}$ remains $\\mathcal{O}(1)$; asymptotically, $L \\sim \\log_{2} n$. The terms $(1/8)^{L}$ and $(1/4)^{L}$ then decay to zero as $n$ grows. Retaining the exact finite-$L$ expressions for clarity and then applying asymptotics as needed, we have\n$$\nT_{\\text{comp}}(n,L) = \\nu \\theta n^{3} \\cdot \\frac{8}{7} \\left[ 1 - \\left( \\frac{1}{8} \\right)^{L} \\right],\n$$\n$$\nT_{\\text{comm}}(n,L) = 6 q \\left[ L \\tau + \\frac{\\sigma h}{\\beta} n^{2} \\cdot \\frac{4}{3} \\left[ 1 - \\left( \\frac{1}{4} \\right)^{L} \\right] \\right].\n$$\n\nTherefore, the per-process parallel time for one V-cycle is\n$$\nT_{p}(N,p) = T_{\\text{comp}}(n,L) + T_{\\text{comm}}(n,L)\n= \\nu \\theta n^{3} \\cdot \\frac{8}{7} \\left[ 1 - \\left( \\frac{1}{8} \\right)^{L} \\right]\n+ 6 q \\left[ L \\tau + \\frac{\\sigma h}{\\beta} n^{2} \\cdot \\frac{4}{3} \\left[ 1 - \\left( \\frac{1}{4} \\right)^{L} \\right] \\right],\n$$\nwith $n = (N/p)^{1/3}$ and $L \\sim \\log_{2} n$.\n\nNext, we derive the serial time. On a single process ($p = 1$), there is no communication, so we sum only compute across levels with $n = N^{1/3}$:\n$$\nT_{1}(N) = \\nu \\theta N^{1/3 \\cdot 3} \\cdot \\frac{8}{7} \\left[ 1 - \\left( \\frac{1}{8} \\right)^{L_{1}} \\right],\n$$\nwhere $L_{1} \\sim \\log_{2} N^{1/3}$. Since $N$ is large in the asymptotic analysis, $(1/8)^{L_{1}} \\to 0$, and we can write\n$$\nT_{1}(N) = \\frac{8}{7} \\nu \\theta N.\n$$\nDefine the constant\n$$\na \\equiv \\frac{8}{7} \\nu \\theta,\n$$\nso that $T_{1}(N) = a N$.\n\nFor the parallel case, define $n = (N/p)^{1/3}$ and similarly neglect the vanishing terms $(1/8)^{L}$ and $(1/4)^{L}$ for large $n$. Then\n$$\nT_{p}(N,p) \\approx a \\frac{N}{p} + 6 q \\left[ L \\tau + \\frac{4}{3} \\frac{\\sigma h}{\\beta} n^{2} \\right],\n$$\nwith $L \\sim \\log_{2} n$ and $n^{2} = \\left( \\frac{N}{p} \\right)^{2/3}$.\n\nThe parallel efficiency for one V-cycle is\n$$\nE(N,p) = \\frac{T_{1}(N)}{p \\, T_{p}(N,p)}.\n$$\nSubstituting the expressions,\n$$\nE(N,p) \\approx \\frac{a N}{p \\left[ a \\frac{N}{p} + 6 q \\left( L \\tau + \\frac{4}{3} \\frac{\\sigma h}{\\beta} \\left( \\frac{N}{p} \\right)^{2/3} \\right) \\right]}\n= \\frac{a N}{a N + 6 q p \\left[ L \\tau + \\frac{4}{3} \\frac{\\sigma h}{\\beta} \\left( \\frac{N}{p} \\right)^{2/3} \\right]}.\n$$\nWith $L \\sim \\log_{2} n = \\log_{2} \\left( (N/p)^{1/3} \\right) = \\frac{1}{3} \\log_{2} \\left( \\frac{N}{p} \\right)$, we can write\n$$\nE(N,p) \\approx \\frac{a N}{a N + 6 q p \\left[ \\frac{\\tau}{3} \\log_{2} \\left( \\frac{N}{p} \\right) + \\frac{4}{3} \\frac{\\sigma h}{\\beta} \\left( \\frac{N}{p} \\right)^{2/3} \\right]}.\n$$\n\nWe now evaluate the limiting efficiency as $N \\to \\infty$ with $p$ fixed. The denominator has the leading term $a N$, and lower-order terms $C_{1} p \\left( \\frac{N}{p} \\right)^{2/3} = C_{1} p^{1/3} N^{2/3}$ and $C_{2} p \\log_{2} \\left( \\frac{N}{p} \\right)$, for constants $C_{1} = 6 q \\cdot \\frac{4}{3} \\frac{\\sigma h}{\\beta}$ and $C_{2} = 6 q \\cdot \\frac{\\tau}{3}$. Since $N^{2/3}$ and $\\log_{2} N$ grow strictly slower than $N$, the ratio tends to $1$:\n$$\n\\lim_{N \\to \\infty} E(N,p) = \\lim_{N \\to \\infty} \\frac{a N}{a N + \\mathcal{O}\\!\\left( N^{2/3} \\right) + \\mathcal{O}\\!\\left( \\log N \\right)} = 1.\n$$\n\nTherefore, under the stated assumptions and with $p$ fixed, the limiting parallel efficiency of a multigrid V-cycle is $1$ as $N$ grows.",
            "answer": "$$\\boxed{1}$$"
        }
    ]
}