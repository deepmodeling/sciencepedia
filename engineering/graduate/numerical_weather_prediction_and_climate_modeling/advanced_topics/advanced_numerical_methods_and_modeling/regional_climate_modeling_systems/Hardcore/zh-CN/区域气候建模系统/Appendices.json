{
    "hands_on_practices": [
        {
            "introduction": "在区域气候模型中，准确表示复杂地形是一项基本挑战。本练习探讨了在地形跟随坐标系中产生的虚假气压梯度力误差，这是一个关键的数值伪影。通过推导该误差的尺度估计并设计平滑策略，您将亲身体验模型数值计算中的一个核心问题及其在实践中的缓解方法。",
            "id": "4081110",
            "problem": "考虑一个用于数值天气预报（NWP）和气候模拟的区域气候模型（RCM）中所使用的地形追随（sigma）垂直坐标。假设大气为处于静力平衡状态的等温干空气。静力学关系为 $ \\frac{\\partial p}{\\partial z} = - \\rho g $，理想气体定律为 $ p = \\rho R_{d} T $，其中 $ p $ 是气压，$ \\rho $ 是空气密度，$ g $ 是重力加速度，$ R_{d} $ 是干空气气体常数，$ T $ 是温度。对于等温大气，气压廓线为 $ p(z) = p_{0} \\exp(-z/H) $，其中标高 $ H = \\frac{R_{d} T}{g} $。在同一 sigma 等级面上，相邻气柱的几何高度因地形坡度而不同。考虑在网格间距 $ \\Delta x = 1.0 \\times 10^{3}\\ \\mathrm{m} $ 上存在均匀的地形坡度 $ m = \\frac{\\partial z_{s}}{\\partial x} = 0.2 $，使得相邻气柱之间的高度偏移为 $ \\Delta z_{s} = m \\Delta x $。在完全静止的等温大气中，连续的水平气压梯度力与倾斜坐标面相关的度规项完全抵消，但离散有限差分会引入一个残余的虚假水平加速度。\n\n从静力学关系和理想气体定律出发，推导虚假水平气压梯度加速度大小关于 $ g $、$ H $、$ m $ 和 $ \\Delta x $ 的主阶标度估计。然后，设计一种地形平滑策略，使用一维显式拉普拉斯滤波器应用于地形场 $ z_{s}(x) $：\n$$ z_{s}^{(n+1)}(i) = z_{s}^{(n)}(i) + \\alpha \\left[z_{s}^{(n)}(i+1) - 2 z_{s}^{(n)}(i) + z_{s}^{(n)}(i-1)\\right], $$\n其中 $ \\alpha $ 是平滑系数，$ i $ 是网格点索引，$ n $ 是迭代指数。对于波长为 $ L = 1.0 \\times 10^{4}\\ \\mathrm{m} $ 的正弦地形 $ z_{s}(x) = A \\sin\\left(\\frac{2\\pi x}{L}\\right) $，该滤波器每次迭代将振幅（因此也包括坡度振幅）减小一个因子，该因子由下式给出：\n$$ F = 1 - 4 \\alpha \\sin^{2}\\!\\left(\\frac{\\pi \\Delta x}{L}\\right). $$\n假设 $ H = 8.0 \\times 10^{3}\\ \\mathrm{m} $，$ g = 9.81\\ \\mathrm{m}\\ \\mathrm{s}^{-2} $，$ \\alpha = 0.25 $，并要求平滑后的虚假加速度低于阈值 $ a_{\\mathrm{thr}} = 1.0 \\times 10^{-3}\\ \\mathrm{m}\\ \\mathrm{s}^{-2} $。计算最小平滑迭代整数次数 $ N $，使得滤波后的坡度振幅 $ m_{\\mathrm{new}} = F^{N} m $ 满足您推导出的阈值条件。在您的最终答案中仅给出最小整数 $ N $。如果在中间步骤中需要任何数值近似，请保持一致地进行，但最终报告的 $ N $ 必须是满足要求的最小整数。",
            "solution": "用户提供了一个分为两部分的问题。第一部分，推导地形追随坐标系中虚假水平气压梯度加速度的标度估计。第二部分，计算将此加速度减小到指定阈值以下所需的最少地形平滑迭代次数。\n\n**第一部分：虚假加速度标度的推导**\n\n在恒定几何高度 $z$ 上，$x$ 方向单位质量的水平气压梯度力（PGF）由 $a_x = -\\frac{1}{\\rho}\\frac{\\partial p}{\\partial x}$ 给出。在静止的静力平衡大气中，气压 $p$ 仅是高度 $z$ 的函数，因此真实的水平气压梯度力为零。\n\n在使用地形追随坐标（例如 sigma 坐标）的数值模型中，水平气压梯度力通常由两个项计算得出，这两个项在解析上应完全抵消，但由于离散化误差而不然。从 $(x,z)$ 坐标系转换到广义坐标系 $(x,\\sigma)$（其中 $\\sigma$ 在坐标面上是常数）的水平气压梯度力表达式为：\n$$ a_x = -\\frac{1}{\\rho}\\left(\\frac{\\partial p}{\\partial x}\\right)_z = -\\frac{1}{\\rho}\\left(\\frac{\\partial p}{\\partial x}\\right)_{\\sigma} + g \\left(\\frac{\\partial z}{\\partial x}\\right)_{\\sigma} $$\n在有限差分模型中，这些项在同一 $\\sigma$ 等级面上的两个相邻网格点 $i$ 和 $i+1$ 之间进行近似：\n$$ a_s \\approx -\\frac{1}{\\bar{\\rho}}\\frac{p_{i+1} - p_i}{\\Delta x} + g\\frac{z_{i+1} - z_i}{\\Delta x} $$\n此处，$a_s$ 是虚假加速度，$\\bar{\\rho}$ 是两点之间的平均密度。令 $z_i = z$ 和 $z_{i+1} = z + \\Delta z$。在静止大气中，气压仅是高度的函数，因此 $p_i = p(z)$ 且 $p_{i+1} = p(z+\\Delta z)$。表达式变为：\n$$ a_s \\approx -\\frac{1}{\\bar{\\rho}\\Delta x}\\left[p(z+\\Delta z) - p(z)\\right] + \\frac{g \\Delta z}{\\Delta x} $$\n为求主阶误差，我们对 $p(z+\\Delta z)$ 在 $z$ 附近进行泰勒级数展开：\n$$ p(z+\\Delta z) \\approx p(z) + \\frac{dp}{dz}\\Delta z + \\frac{1}{2}\\frac{d^2p}{dz^2}(\\Delta z)^2 + \\dots $$\n将此式代入 $a_s$ 的表达式中，并取 $\\bar{\\rho} \\approx \\rho(z)$：\n$$ a_s \\approx -\\frac{1}{\\rho \\Delta x}\\left[\\left(\\frac{dp}{dz}\\Delta z + \\frac{1}{2}\\frac{d^2p}{dz^2}(\\Delta z)^2\\right)\\right] + \\frac{g \\Delta z}{\\Delta x} $$\n根据静力学关系，$\\frac{dp}{dz} = -\\rho g$。一阶项变为：\n$$ -\\frac{1}{\\rho \\Delta x}\\left(\\frac{dp}{dz}\\Delta z\\right) = -\\frac{1}{\\rho \\Delta x}(-\\rho g \\Delta z) = \\frac{g \\Delta z}{\\Delta x} $$\n该项与 $a_s$ 表达式中的第二项完全抵消。残余项，即虚假加速度，是由泰勒展开中的二阶项引起的：\n$$ a_s \\approx -\\frac{1}{2\\rho \\Delta x} \\frac{d^2p}{dz^2}(\\Delta z)^2 $$\n对于等温大气，气压廓线为 $p(z) = p_0 \\exp(-z/H)$，其中 $H = \\frac{R_d T}{g}$ 是标高。其导数为：$\\frac{dp}{dz} = -\\frac{1}{H}p(z)$ 和 $\\frac{d^2p}{dz^2} = \\frac{1}{H^2}p(z)$。\n将二阶导数代入 $a_s$ 的表达式中：\n$$ a_s \\approx -\\frac{1}{2\\rho \\Delta x} \\frac{p}{H^2}(\\Delta z)^2 $$\n使用理想气体定律 $p=\\rho R_d T$ 和标高定义 $H=\\frac{R_d T}{g}$，我们得到关系式 $\\frac{p}{\\rho} = R_d T = gH$。代入此式：\n$$ a_s \\approx -\\frac{1}{2 \\Delta x} \\left(\\frac{p}{\\rho}\\right) \\frac{(\\Delta z)^2}{H^2} = -\\frac{gH}{2 \\Delta x} \\frac{(\\Delta z)^2}{H^2} = -\\frac{g(\\Delta z)^2}{2H \\Delta x} $$\n在水平距离 $\\Delta x$ 上，$\\sigma$ 等级面上相邻网格点之间的高度差 $\\Delta z$ 与地形坡度 $m = \\frac{\\partial z_s}{\\partial x}$ 成正比。对于主阶标度估计，我们可以将此关系近似为 $\\Delta z \\approx m \\Delta x$。\n将此代入 $a_s$ 的表达式中：\n$$ a_s \\approx -\\frac{g(m \\Delta x)^2}{2H \\Delta x} = -\\frac{g m^2 \\Delta x}{2H} $$\n因此，虚假水平加速度的大小为：\n$$ |a_s| \\approx \\frac{g m^2 \\Delta x}{2H} $$\n\n**第二部分：平滑迭代次数的计算**\n\n每次应用拉普拉斯滤波器，地形坡度 $m$ 会减小一个因子 $F$。经过 $N$ 次迭代后，新的坡度为 $m_{\\text{new}} = m F^N$。我们要求由此产生的虚假加速度 $|a_s(m_{\\text{new}})|$ 小于阈值 $a_{\\text{thr}}$。\n$$ \\frac{g (m_{\\text{new}})^2 \\Delta x}{2H}  a_{\\text{thr}} $$\n代入 $m_{\\text{new}} = m F^N$：\n$$ \\frac{g (m F^N)^2 \\Delta x}{2H}  a_{\\text{thr}} \\implies F^{2N} \\frac{g m^2 \\Delta x}{2H}  a_{\\text{thr}} $$\n求解 $N$：\n$$ F^{2N}  \\frac{2 H a_{\\text{thr}}}{g m^2 \\Delta x} $$\n对两边取自然对数：\n$$ 2N \\ln(F)  \\ln\\left(\\frac{2 H a_{\\text{thr}}}{g m^2 \\Delta x}\\right) $$\n振幅减小因子 $F$ 由 $F = 1 - 4 \\alpha \\sin^{2}\\!\\left(\\frac{\\pi \\Delta x}{L}\\right)$ 给出。当 $\\alpha = 0.25$ 时，我们有 $4\\alpha = 1$，因此 $F = 1 - \\sin^{2}\\!\\left(\\frac{\\pi \\Delta x}{L}\\right) = \\cos^{2}\\!\\left(\\frac{\\pi \\Delta x}{L}\\right)$。对于给定的值，$0  \\frac{\\pi \\Delta x}{L}  \\frac{\\pi}{2}$，所以 $0  F  1$，这意味着 $\\ln(F)$ 是负数。除以 $2\\ln(F)$ 会使不等号反向：\n$$ N > \\frac{1}{2\\ln(F)} \\ln\\left(\\frac{2H a_{\\text{thr}}}{g m^2 \\Delta x}\\right) $$\n现在，我们代入给定的数值：\n$g = 9.81\\ \\mathrm{m}\\ \\mathrm{s}^{-2}$\n$H = 8.0 \\times 10^{3}\\ \\mathrm{m}$\n$m = 0.2$\n$\\Delta x = 1.0 \\times 10^{3}\\ \\mathrm{m}$\n$\\alpha = 0.25$\n$L = 1.0 \\times 10^{4}\\ \\mathrm{m}$\n$a_{\\text{thr}} = 1.0 \\times 10^{-3}\\ \\mathrm{m}\\ \\mathrm{s}^{-2}$\n\n首先，计算减小因子 $F$：\n$$ \\frac{\\pi \\Delta x}{L} = \\frac{\\pi (1.0 \\times 10^3)}{(1.0 \\times 10^4)} = \\frac{\\pi}{10} $$\n$$ F = \\cos^2\\left(\\frac{\\pi}{10}\\right) $$\n接下来，计算对数的参数：\n$$ \\frac{2H a_{\\text{thr}}}{g m^2 \\Delta x} = \\frac{2(8.0 \\times 10^3)(1.0 \\times 10^{-3})}{(9.81)(0.2)^2(1.0 \\times 10^3)} = \\frac{16}{9.81 \\times 0.04 \\times 1000} = \\frac{16}{392.4} $$\n现在，将这些代入关于 $N$ 的不等式中：\n$$ N > \\frac{1}{2\\ln\\left(\\cos^2\\left(\\frac{\\pi}{10}\\right)\\right)} \\ln\\left(\\frac{16}{392.4}\\right) = \\frac{\\ln\\left(\\frac{16}{392.4}\\right)}{4\\ln\\left(\\cos\\left(\\frac{\\pi}{10}\\right)\\right)} $$\n计算数值：\n$$ \\ln\\left(\\frac{16}{392.4}\\right) \\approx \\ln(0.0407747) \\approx -3.19970 $$\n$$ \\cos\\left(\\frac{\\pi}{10}\\right) \\approx 0.9510565 $$\n$$ \\ln\\left(\\cos\\left(\\frac{\\pi}{10}\\right)\\right) \\approx -0.050167 $$\n$$ N > \\frac{-3.19970}{4(-0.050167)} \\approx \\frac{-3.19970}{-0.200668} \\approx 15.94565 $$\n由于 $N$ 必须是整数，所以最少迭代次数是大于 $15.94565$ 的最小整数。因此，$N=16$。",
            "answer": "$$\\boxed{16}$$"
        },
        {
            "introduction": "区域气候模型的模拟在很大程度上受到大尺度模型提供的侧边界条件的影响。本练习从第一性原理出发，计算气流穿过模型区域的平流输运时间，为模型对这些边界条件的“记忆”提供了一个基本的时间尺度。理解这一概念对于设计试验和解释模型内部产生的气候变率与边界驱动信号至关重要。",
            "id": "4081150",
            "problem": "一个在区域气候模拟系统中使用的有限区域模型（LAM）被配置在一个长度为 $L = 2000\\,\\mathrm{km}$ 的纬向域上。假设一个被动标量被一股空间均匀且稳定的水平风平流输送，风速大小为 $U = 10\\,\\mathrm{m\\,s^{-1}}$，从西侧边界进入。从平流的运动学定义出发，不引用任何预先推导的“时间尺度”公式，推导在这些假设下气块从入流边界传播到相对边界所需的入流渡越时间 $t_{\\mathrm{in}}$ 的表达式。然后，对于给定的 $L$ 和 $U$ 计算 $t_{\\mathrm{in}}$，并以小时为单位表示最终数值。将您的最终数值答案四舍五入到四位有效数字。\n\n最后，基于基本的动力学考虑，简要解释 $t_{\\mathrm{in}}$ 的大小如何限制有限区域模型中侧边界条件的记忆，以及在何种动力学情况下，有效记忆可能比 $t_{\\mathrm{in}}$ 更短或更长，不使用任何启发式或简化公式。",
            "solution": "出发点是气块在空间均匀且稳定的水平风中平流的运动学定义。设 $x(t)$ 表示气块沿与平均风对齐的纬向轴的位置，并设入流边界在 $x = 0$ 处，相对边界在 $x = L$ 处。气块的运动由以下方程控制：\n$$\n\\frac{dx}{dt} = U\n$$\n其中 $U$ 是恒定的纬向风速。这个常微分方程表明，位置随时间的变化率等于恒定的平流速度，这反映了匀速直线运动的基本定义。\n\n将此方程从入流位置 $x(0) = 0$ 到出流位置 $x(t_{\\mathrm{in}}) = L$ 对时间进行积分，我们得到：\n$$\n\\int_{x(0)=0}^{x(t_{\\mathrm{in}})=L} dx = \\int_{t=0}^{t=t_{\\mathrm{in}}} U\\, dt\n$$\n这得到：\n$$\nL = U\\, t_{\\mathrm{in}}\n$$\n解出入流渡越时间，得到：\n$$\nt_{\\mathrm{in}} = \\frac{L}{U}\n$$\n现在我们为给定参数计算 $t_{\\mathrm{in}}$。首先，将区域长度转换为米，以便与以米/秒表示的风速单位保持一致：\n$$\nL = 2000\\,\\mathrm{km} = 2000 \\times 10^{3}\\,\\mathrm{m} = 2.0 \\times 10^{6}\\,\\mathrm{m}\n$$\n风速为：\n$$\nU = 10\\,\\mathrm{m\\,s^{-1}}\n$$\n因此，\n$$\nt_{\\mathrm{in}} = \\frac{2.0 \\times 10^{6}\\,\\mathrm{m}}{10\\,\\mathrm{m\\,s^{-1}}} = 2.0 \\times 10^{5}\\,\\mathrm{s}\n$$\n为了以小时为单位表示，使用 $1\\,\\mathrm{h} = 3600\\,\\mathrm{s}$：\n$$\nt_{\\mathrm{in,\\,h}} = \\frac{2.0 \\times 10^{5}\\,\\mathrm{s}}{3600\\,\\mathrm{s\\,h^{-1}}} = \\frac{200000}{3600}\\,\\mathrm{h} = 55.\\overline{5}\\,\\mathrm{h}\n$$\n四舍五入到四位有效数字，得到：\n$$\nt_{\\mathrm{in,\\,h}} \\approx 55.56\\,\\mathrm{h}\n$$\n对有限区域模型（LAM）中侧边界条件记忆的影响：时间 $t_{\\mathrm{in}}$ 代表了一个平流时间尺度，在此尺度上，由边界施加的异常或信息可以通过平均流平流穿过整个区域。在一个纯平流、稳定且均匀的流场中，入流边界下游的内部场在 $t_{\\mathrm{in}}$ 量级的时间尺度上保留了来自侧边界条件的直接影响，因为在边界进入的气块会继续将其属性平流输送穿过整个区域。\n\n然而，有效记忆可能比 $t_{\\mathrm{in}}$ 更短或更长，这取决于动力学状况：\n- 比 $t_{\\mathrm{in}}$ 更短：如果诸如重力波之类的快速传播扰动以超过 $U$ 的速度传递边界信息，内部调整可能在小于 $\\frac{L}{U}$ 的时间尺度上发生。此外，强烈的内部动力过程（例如，深对流、斜压不稳定）可以迅速改变气块的属性，从而削弱边界条件的直接平流记忆。\n- 比 $t_{\\mathrm{in}}$ 更长：如果平均流很弱、被阻塞或存在再循环，或者区域几何形状和内部强迫（例如，地形引起的定常波）捕获了异常，那么内部区域可以继续反映边界施加的条件，其时间超过单个平流穿越时间。此外，如果侧边界松弛（例如，谱逼近或松弛区）很弱或受到限制，内部解可能比名义上的平流时间尺度更长时间地保留特征。\n因此，$\\frac{L}{U}$ 为平流记忆提供了一个第一性原理的基线，该基线受到波传播、非绝热过程、扩散和内部变率的调制，这些因素既可以加速内部调整，也可以延长边界强迫信号的驻留时间。",
            "answer": "$$\\boxed{55.56}$$"
        },
        {
            "introduction": "检验质量和能量等基本物理量的守恒性，是评估任何气候模型模拟完整性的关键步骤。本练习将指导您完成计算区域模型大气水收支闭合项的过程。通过量化收支余项，您将学会诊断由数值方案、物理参数化或资料同化技术等引起的潜在问题。",
            "id": "4081156",
            "problem": "考虑一个用于数值天气预报和气候模拟的有限区域区域气候模式 (RCM) 域。一个气柱的大气水物质收支遵循质量守恒定律。在一个水平面积为 $A$ 的区域上，月域平均降水量 $P$、蒸发量 $E$、穿过开放边界的侧向水汽通量以及整层积分大气水储量的变化，提供了评估月度水收支闭合所需的各项。侧边界通量被模式记录为月平均质量速率：穿过所有侧边界的总流入量 $I$ 和总流出量 $O$，其中使用向外的正法线方向定义流出。月份时长为 $\\Delta t$。\n\n给定一个为期30天的月份的以下科学上一致的量：\n- 区域面积: $A = 1.00 \\times 10^{12}\\ \\mathrm{m}^{2}$。\n- 月份时长: $\\Delta t = 30 \\times 24 \\times 3600\\ \\mathrm{s}$。\n- 域平均降水量: $P = 87.4\\ \\mathrm{mm\\ month}^{-1}$。\n- 域平均蒸发量: $E = 83.2\\ \\mathrm{mm\\ month}^{-1}$。\n- 月内域平均整层积分大气水储量的净增加量（至少包括水汽；是否包含云凝结物取决于模式诊断量）: $\\Delta W = +0.8\\ \\mathrm{mm\\ month}^{-1}$。\n- 月平均侧向水汽流入速率（边界积分）: $I = 1.118 \\times 10^{9}\\ \\mathrm{kg\\ s}^{-1}$。\n- 月平均侧向水汽流出速率（边界积分）: $O = 1.117 \\times 10^{9}\\ \\mathrm{kg\\ s}^{-1}$。\n\n从大气水物质的基本守恒和散度定理的恰当应用出发，推导区域积分的月度收支恒等式，并将月度水收支余项 $r$ 定义为与精确闭合的偏差。然后，使用给定数据计算該月的 $r$ 值，以毫米/月为单位表示您的最终结果。将您的答案四舍五入到四位有效数字。最后，在区域气候模拟系统的背景下，简要解释非零 $r$ 值的物理上合理的来源。在您的推理中，不要使用任何未经第一性原理推导的快捷公式。",
            "solution": "该问题要求推导和计算一个区域气候模式域的月度水收支余项。分析必须从大气水物质质量守恒的基本原理开始。\n\n设 $q$ 为比湿（单位质量湿空气中的水汽质量），$\\rho_a$ 为湿空气的密度。大气中的总水物质含量还包括云液态水和冰，因此 $q$ 应被解释为总水物质混合比。大气水的守恒由以下连续性方程描述：\n$$\n\\frac{\\partial (\\rho_a q)}{\\partial t} + \\nabla \\cdot (\\rho_a q \\mathbf{v}) = S\n$$\n其中 $\\mathbf{v}$ 是三维风矢量，$S$ 表示由于相变（例如，凝结、蒸发、升华）和降水过程导致的单位体积水物质的净源/汇率。\n\n为了得到整个模式域的收支，我们将此方程对区域的大气体积 $V$ 进行积分，该区域的水平面积为 $A$，并从地表延伸到大气层顶。\n$$\n\\int_V \\frac{\\partial (\\rho_a q)}{\\partial t} dV + \\int_V \\nabla \\cdot (\\rho_a q \\mathbf{v}) dV = \\int_V S dV\n$$\n第一项表示储存在大气体积中的总水质量 $M$ 的变化率：\n$$\n\\frac{dM}{dt} = \\frac{d}{dt} \\int_V \\rho_a q dV\n$$\n将散度定理应用于第二项，将散度的体积分转换为穿过区域边界 $\\partial V$ 的通量的面积分：\n$$\n\\int_V \\nabla \\cdot (\\rho_a q \\mathbf{v}) dV = \\oint_{\\partial V} (\\rho_a q \\mathbf{v}) \\cdot \\mathbf{n} dS\n$$\n其中 $\\mathbf{n}$ 是指向面元 $dS$ 外部的法矢量。边界 $\\partial V$ 由侧边界、地表（$z=0$）和大气层顶（$z=z_{top}$）组成。穿过大气层顶的通量可以忽略不计。穿过侧边界的净通量是总流出量 $O$ 减去总流入量 $I$。注意，问题中定义 $O$ 使用向外的正法线，因此净侧向通量散度（流出）确实是 $O-I$。对于整个大气水柱的源/汇项 $\\int_V S dV$，主要由地表通量决定：从地表到大气的蒸发（$E_{rate}$，源）和从大气到地表的降水（$P_{rate}$，汇）。因此，$\\int_V S dV = E_{rate} - P_{rate}$，其中这些是单位为 $\\mathrm{kg\\ s}^{-1}$ 的区域积分质量速率。\n\n结合这些项，区域的瞬时质量收支方程变为：\n$$\n\\frac{dM}{dt} + (O-I) = E_{rate} - P_{rate}\n$$\n整理可得储量的变化率：\n$$\n\\frac{dM}{dt} = E_{rate} - P_{rate} + (I-O)\n$$\n该方程表明，区域内水质量的变化率等于蒸发速率减去降水速率，再加上净侧向水汽流入速率。\n\n为了得到月度收支，我们将此方程在一个月的时长 $\\Delta t$ 内进行积分：\n$$\n\\int_0^{\\Delta t} \\frac{dM}{dt} dt = \\int_0^{\\Delta t} (E_{rate} - P_{rate} + I - O) dt\n$$\n左侧是该月内水储量的净变化，$\\Delta M = M(\\Delta t) - M(0)$。右侧的各项是该月内的总质量贡献。问题提供了 $I$ 和 $O$ 的月平均速率，我们假设它们在 $\\Delta t$ 期间是恒定的。量 $P$ 和 $E$ 是以一个月内累积的域平均深度给出的。我们将所有项转换为一个共同的基准，例如，区域面积 $A$ 上的等效深度（以毫米为单位）。\n\n设 $\\rho_w$ 为液态水的密度，约为 $1000 \\ \\mathrm{kg\\ m}^{-3}$。质量为 $m$ 的水对应于体积 $m/\\rho_w$ 和在面积 $A$ 上的等效深度 $d = m/(A \\rho_w)$。\n总储量深度变化由 $\\Delta W$ 给出。\n总降水深度由 $P$ 给出。\n总蒸发深度由 $E$ 给出。\n一个月内由净侧向通量辐合产生的总质量为 $(I-O)\\Delta t$。其等效深度，我们称之为 $F_c$，为：\n$$\nF_c = \\frac{(I-O)\\Delta t}{A \\rho_w}\n$$\n将积分质量收支方程除以 $A \\rho_w$，我们得到以月总深度表示的收支方程：\n$$\n\\Delta W = E - P + F_c\n$$\n在真实的数值模式中，由于数值误差、参数化方案中的不一致性以及潜在的逼近项（nudging terms），该收支不会完美闭合。月度水收支余项 $r$ 被定义为与此精确闭合的偏差。我们将余项定义为观测到的储量变化减去由通量预测的储量变化：\n$$\nr = \\Delta W - (E - P + F_c) = \\Delta W - E + P - F_c\n$$\n\n现在，我们使用提供的数据计算 $r$ 的值。\n已知条件为：\n- $A = 1.00 \\times 10^{12}\\ \\mathrm{m}^{2}$\n- $\\Delta t = 30 \\times 24 \\times 3600\\ \\mathrm{s} = 2.592 \\times 10^6\\ \\mathrm{s}$\n- $P = 87.4\\ \\mathrm{mm}$\n- $E = 83.2\\ \\mathrm{mm}$\n- $\\Delta W = +0.8\\ \\mathrm{mm}$\n- $I = 1.118 \\times 10^{9}\\ \\mathrm{kg\\ s}^{-1}$\n- $O = 1.117 \\times 10^{9}\\ \\mathrm{kg\\ s}^{-1}$\n- $\\rho_w = 1000 \\ \\mathrm{kg\\ m}^{-3}$\n\n首先，计算净侧向通量辐合 $F_c$（以毫米为单位）。\n净质量流入速率为 $I - O = (1.118 - 1.117) \\times 10^9 \\ \\mathrm{kg\\ s}^{-1} = 0.001 \\times 10^9 \\ \\mathrm{kg\\ s}^{-1} = 1.0 \\times 10^6 \\ \\mathrm{kg\\ s}^{-1}$。\n一个月内输送到区域内的总质量为：\n$$\n(I-O)\\Delta t = (1.0 \\times 10^6 \\ \\mathrm{kg\\ s}^{-1}) \\times (2.592 \\times 10^6 \\ \\mathrm{s}) = 2.592 \\times 10^{12} \\ \\mathrm{kg}\n$$\n现在，将此质量转换为区域面积 $A$ 上的等效水深：\n$$\nF_c = \\frac{(I-O)\\Delta t}{A \\rho_w} = \\frac{2.592 \\times 10^{12} \\ \\mathrm{kg}}{(1.00 \\times 10^{12} \\ \\mathrm{m}^{2}) \\times (1000 \\ \\mathrm{kg\\ m}^{-3})} = \\frac{2.592}{1000} \\ \\mathrm{m} = 0.002592 \\ \\mathrm{m}\n$$\n转换为毫米，$F_c = 2.592 \\ \\mathrm{mm}$。\n\n现在，将所有值代入余项 $r$ 的方程中：\n$$\nr = \\Delta W - E + P - F_c\n$$\n$$\nr = 0.8 - 83.2 + 87.4 - 2.592\n$$\n$$\nr = (87.4 - 83.2) + 0.8 - 2.592 = 4.2 + 0.8 - 2.592 = 5.0 - 2.592 = 2.408 \\ \\mathrm{mm}\n$$\n问题要求答案四舍五入到四位有效数字。结果 $2.408$ 已经有四位有效数字。\n\n在区域气候模式中，出现非零余项 $r$ 是预料之中的，并且可能由几个来源引起。物理上合理的来源包括：\n1.  **数值离散误差**：连续的守恒定律是在离散网格上求解的，这会引入截断误差。负责输送水汽的平流方案是此类误差的主要来源，因为它们可能不是完全质量守恒的。\n2.  **模式分量耦合不一致**：模式由不同的模块（例如，大气动力学、云微物理、陆面模式）组成。这些分量之间的水质量交换可能不完全平衡，导致人为的增益或损失。\n3.  **资料同化/逼近（Nudging）**：RCMs 通常会被“逼近”到一个来自全球模式的大尺度分析场，以防止模拟结果漂移。这种逼近充当了热量、动量和水汽的非物理源或汇，而这些并未在物理守恒方程中计入。这通常是水收支余项的最大贡献者。\n4.  **诊断输出不一致**：在模式的后处理过程中，不同收支项（通量、降水、储量变化）的计算和时间平均/累积可能不一致，即使模式本身内部是质量守恒的，这也会导致表面上的不平衡。",
            "answer": "$$\\boxed{2.408}$$"
        }
    ]
}