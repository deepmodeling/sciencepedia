{
    "hands_on_practices": [
        {
            "introduction": "A fundamental challenge in designing a limited-area model is ensuring the problem is mathematically well-posed. This begins with determining the correct number of boundary conditions to prescribe. This practice guides you through a characteristic analysis of a linearized shallow-water system, a cornerstone of geophysical fluid dynamics, to establish this number based on first principles . By calculating the eigenvalues of the system's flux Jacobian, you will determine the direction and speed of information propagation, thereby revealing precisely how many physical constraints are needed at inflow and outflow boundaries.",
            "id": "4018138",
            "problem": "Consider lateral boundary condition design for a one-dimensional Limited-Area Model (LAM) used in Numerical Weather Prediction (NWP). Take the rotating shallow-water system on a constant Coriolis parameter $f$ (an $f$-plane), linearized about a uniform background zonal flow $U$ and constant mean depth $H$ with gravitational acceleration $g$. Let the model domain be $x \\in [0,L]$, with the western boundary at $x=0$ and the eastern boundary at $x=L$. Assume disturbances are uniform in the meridional direction (no $y$-dependence). The prognostic variables are the zonal velocity $u$, meridional velocity $v$, and free-surface displacement $\\eta$. Define the gravity-wave speed $c = \\sqrt{g H}$. \n\nUsing only first principles for hyperbolic systems and characteristic analysis of the flux Jacobian normal to the boundary, determine whether the inflow–outflow regime is supercritical or subcritical when $|U|<c$, and compute the ordered pair $(n_{\\text{inflow}}, n_{\\text{outflow}})$ of the minimum number of independent boundary conditions that must be prescribed at the inflow boundary and at the outflow boundary, respectively, to ensure a well-posed lateral boundary value problem for the linearized system. Express your final numerical result for $(n_{\\text{inflow}}, n_{\\text{outflow}})$ as a row vector using the $\\mathrm{pmatrix}$ convention. No rounding is required, and no physical units are involved in the final answer.",
            "solution": "The problem asks for an analysis of the lateral boundary conditions for a linearized one-dimensional rotating shallow-water system. The key to determining the number of required boundary conditions for a well-posed problem is to perform a characteristic analysis of the system of hyperbolic partial differential equations.\n\nFirst, we write down the governing equations. The system is described by the prognostic variables for zonal velocity $u$, meridional velocity $v$, and free-surface displacement $\\eta$. The system is linearized about a background state of constant zonal flow $U$ and constant mean depth $H$. There is no meridional dependence, so all derivatives with respect to $y$ are zero. The linearized equations are:\n$$ \\frac{\\partial u}{\\partial t} + U \\frac{\\partial u}{\\partial x} - f v + g \\frac{\\partial \\eta}{\\partial x} = 0 $$\n$$ \\frac{\\partial v}{\\partial t} + U \\frac{\\partial v}{\\partial x} + f u = 0 $$\n$$ \\frac{\\partial \\eta}{\\partial t} + U \\frac{\\partial \\eta}{\\partial x} + H \\frac{\\partial u}{\\partial x} = 0 $$\nHere, $f$ is the Coriolis parameter, and $g$ is the gravitational acceleration.\n\nTo perform a characteristic analysis, we write this system in the matrix form $\\frac{\\partial \\mathbf{q}}{\\partial t} + \\mathbf{A} \\frac{\\partial \\mathbf{q}}{\\partial x} = \\mathbf{S}$, where $\\mathbf{q}$ is the state vector of prognostic variables, $\\mathbf{A}$ is the flux Jacobian matrix, and $\\mathbf{S}$ contains non-flux-gradient terms. Let the state vector be $\\mathbf{q} = \\begin{pmatrix} u \\\\ v \\\\ \\eta \\end{pmatrix}$. The system can be rewritten as:\n$$ \\frac{\\partial}{\\partial t}\\begin{pmatrix} u \\\\ v \\\\ \\eta \\end{pmatrix} + \\begin{pmatrix} U & 0 & g \\\\ 0 & U & 0 \\\\ H & 0 & U \\end{pmatrix} \\frac{\\partial}{\\partial x}\\begin{pmatrix} u \\\\ v \\\\ \\eta \\end{pmatrix} = \\begin{pmatrix} fv \\\\ -fu \\\\ 0 \\end{pmatrix} $$\nThe matrix $\\mathbf{A}$ is the flux Jacobian normal to the boundary (in the $x$-direction):\n$$ \\mathbf{A} = \\begin{pmatrix} U & 0 & g \\\\ 0 & U & 0 \\\\ H & 0 & U \\end{pmatrix} $$\nThe eigenvalues $\\lambda$ of $\\mathbf{A}$ represent the characteristic speeds, which are the speeds at which information propagates along characteristic curves. The eigenvalues are found by solving the characteristic equation $\\det(\\mathbf{A} - \\lambda\\mathbf{I}) = 0$.\n$$ \\det \\begin{pmatrix} U - \\lambda & 0 & g \\\\ 0 & U - \\lambda & 0 \\\\ H & 0 & U - \\lambda \\end{pmatrix} = 0 $$\nExpanding the determinant along the second row gives:\n$$ (U - \\lambda) \\det \\begin{pmatrix} U - \\lambda & g \\\\ H & U - \\lambda \\end{pmatrix} = 0 $$\n$$ (U - \\lambda) \\left[ (U - \\lambda)^2 - gH \\right] = 0 $$\nThe problem defines the gravity-wave speed as $c = \\sqrt{gH}$. Substituting this, we get:\n$$ (U - \\lambda) \\left[ (U - \\lambda)^2 - c^2 \\right] = 0 $$\nThis equation yields three eigenvalues:\n$$ \\lambda_1 = U - c $$\n$$ \\lambda_2 = U $$\n$$ \\lambda_3 = U + c $$\nThese eigenvalues are the speeds of the three characteristic modes of the system: two gravity waves propagating at speeds $U \\pm c$ relative to the ground, and one mode (associated with $v$) advected with the mean flow $U$.\n\nThe problem asks whether the inflow–outflow regime is supercritical or subcritical. This is determined by comparing the mean flow speed $|U|$ to the gravity-wave speed $c$.\n- A flow is **subcritical** if $|U| < c$. In this case, gravity waves can propagate both upstream and downstream relative to the mean flow.\n- A flow is **supercritical** if $|U| > c$. In this case, all waves are swept downstream.\nThe problem states the condition $|U| < c$, which explicitly defines the regime as **subcritical**.\n\nFor a hyperbolic system to have a well-posed boundary value problem, the number of boundary conditions prescribed at a given boundary must be equal to the number of characteristic curves entering the domain at that boundary.\n- At the western boundary ($x=0$), a characteristic enters the domain if its speed $\\lambda$ is positive ($\\lambda > 0$).\n- At the eastern boundary ($x=L$), a characteristic enters the domain if its speed $\\lambda$ is negative ($\\lambda < 0$).\n\nWe are given $|U| < c$, which is equivalent to $-c < U < c$. We must determine the number of boundary conditions at a generic inflow boundary and a generic outflow boundary. The result should be independent of whether the mean flow is westerly ($U>0$) or easterly ($U<0$). Let's analyze the signs of the eigenvalues under the condition $|U|<c$, assuming $U \\neq 0$.\n- $\\lambda_1 = U - c$: Since $U < c$, it follows that $U - c < 0$. So, $\\lambda_1$ is always negative.\n- $\\lambda_3 = U + c$: Since $U > -c$, it follows that $U + c > 0$. So, $\\lambda_3$ is always positive.\n- $\\lambda_2 = U$: The sign of this eigenvalue is the same as the sign of $U$.\n\nLet's consider the two cases for the direction of the mean flow.\n\nCase 1: Westerly flow ($U > 0$).\nThe inflow boundary is at $x=0$, and the outflow boundary is at $x=L$.\n- **Inflow boundary ($x=0$):** The number of required boundary conditions, $n_{\\text{inflow}}$, is the number of positive eigenvalues.\n  The eigenvalues are $\\lambda_1 = U-c < 0$, $\\lambda_2 = U > 0$, and $\\lambda_3 = U+c > 0$.\n  There are two positive eigenvalues ($\\lambda_2$ and $\\lambda_3$).\n  Therefore, $n_{\\text{inflow}} = 2$.\n- **Outflow boundary ($x=L$):** The number of required boundary conditions, $n_{\\text{outflow}}$, is the number of negative eigenvalues.\n  There is one negative eigenvalue ($\\lambda_1$).\n  Therefore, $n_{\\text{outflow}} = 1$.\n\nCase 2: Easterly flow ($U < 0$).\nThe inflow boundary is at $x=L$, and the outflow boundary is at $x=0$.\n- **Inflow boundary ($x=L$):** The number of required boundary conditions, $n_{\\text{inflow}}$, is the number of negative eigenvalues.\n  The eigenvalues are $\\lambda_1 = U-c < 0$, $\\lambda_2 = U < 0$, and $\\lambda_3 = U+c > 0$.\n  There are two negative eigenvalues ($\\lambda_1$ and $\\lambda_2$).\n  Therefore, $n_{\\text{inflow}} = 2$.\n- **Outflow boundary ($x=0$):** The number of required boundary conditions, $n_{\\text{outflow}}$, is the number of positive eigenvalues.\n  There is one positive eigenvalue ($\\lambda_3$).\n  Therefore, $n_{\\text{outflow}} = 1$.\n\nIn both cases, the result is the same. For the subcritical flow regime ($|U|<c$), two independent boundary conditions must be prescribed at the inflow boundary, and one independent boundary condition must be prescribed at the outflow boundary.\n\nThe ordered pair of the minimum number of independent boundary conditions is $(n_{\\text{inflow}}, n_{\\text{outflow}}) = (2, 1)$.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 2 & 1 \\end{pmatrix} } $$"
        },
        {
            "introduction": "Once we know how many conditions to specify, the next challenge is defining them in a way that allows internally generated waves to exit the domain transparently. This practice introduces the concept of an adaptive radiation boundary condition, famously formulated by Orlanski, which estimates the local wave phase speed $c$ to advect disturbances out of the model domain . You will first derive this condition and then perform a sensitivity analysis to see how its performance degrades in the presence of noisy gradient information, providing critical insight into the practical robustness of this widely used technique.",
            "id": "4018160",
            "problem": "Consider a nested limited-area model (LAM) embedded within a larger driving model. Along one open boundary with outward unit normal direction denoted by $n$, suppose a scalar prognostic field $\\phi(n,t)$ near the boundary is locally governed by the one-dimensional linear advection–wave equation, consistent with outgoing disturbances,\n$$\n\\frac{\\partial \\phi}{\\partial t} + c\\,\\frac{\\partial \\phi}{\\partial n} = 0,\n$$\nwhere $c$ is an unknown, slowly varying phase speed of the wave packet in the normal direction. You may assume the field is sufficiently smooth and that characteristics are quasi-stationary over the temporal window used to estimate local gradients.\n\nTask 1 (Derivation): Starting from the above fundamental partial differential equation and the observation that locally plane-wave-like signals satisfy a constant phase speed, derive a radiation-type open boundary condition for $\\phi$ at the boundary that advects information outward using a locally estimated phase speed based on the temporal and spatial gradients of $\\phi$ evaluated at the boundary.\n\nTask 2 (Noisy-gradient sensitivity): In practice, within a nested configuration, the local temporal and spatial gradients used to estimate the phase speed are contaminated by small additive errors arising from interpolation mismatch, representativeness differences, and numerical noise. Model the measured gradients at the boundary by\n$$\na_m = a + \\eta_t, \\quad b_m = b + \\eta_n,\n$$\nwhere $a = \\left.\\frac{\\partial \\phi}{\\partial t}\\right|_{\\text{true}}$, $b = \\left.\\frac{\\partial \\phi}{\\partial n}\\right|_{\\text{true}}$, and $\\eta_t$, $\\eta_n$ are zero-mean random perturbations with $\\mathbb{E}[\\eta_t]=0$, $\\mathbb{E}[\\eta_n]=0$, variances $\\mathbb{E}[\\eta_t^2]=\\sigma_t^2$, $\\mathbb{E}[\\eta_n^2]=\\sigma_n^2$, and covariance $\\mathbb{E}[\\eta_t \\eta_n]=\\rho\\,\\sigma_t \\sigma_n$, where $-1 \\le \\rho \\le 1$. Assume the small-noise regime where terms beyond second order in $(\\eta_t, \\eta_n)$ can be neglected in expectations.\n\nDefine the phase-speed estimator that is consistent with your radiation boundary condition from Task 1 using the measured gradients $a_m$ and $b_m$, and compute the leading-order analytical expression for its expected value $\\mathbb{E}[\\hat{c}]$ under the above noise model. Express your final answer in closed form in terms of $c$, $b$, $\\sigma_t$, $\\sigma_n$, and $\\rho$ only, using the advection–wave relationship to eliminate $a$ where appropriate.\n\nYour final answer must be a single closed-form analytic expression. No numerical evaluation is required.",
            "solution": "The problem consists of two tasks. The first is to derive a radiation-type open boundary condition. The second is to analyze the statistical bias of the phase-speed estimator used in this boundary condition when the gradient measurements are noisy.\n\n### Task 1: Derivation of the Radiation Boundary Condition\n\nThe physical system near the open boundary is described by the one-dimensional linear advection–wave equation for a scalar field $\\phi(n,t)$:\n$$\n\\frac{\\partial \\phi}{\\partial t} + c\\,\\frac{\\partial \\phi}{\\partial n} = 0\n$$\nHere, $n$ is the coordinate in the direction of the outward unit normal, $t$ is time, and $c$ is the phase speed of outgoing disturbances. This equation establishes a fundamental relationship between the temporal and spatial gradients of the field $\\phi$.\n\nFor a solution that is locally wave-like, the phase speed $c$ can be expressed in terms of the local gradients. Assuming that the spatial gradient $\\frac{\\partial \\phi}{\\partial n}$ is non-zero, we can rearrange the governing equation to solve for $c$:\n$$\nc = - \\frac{\\partial \\phi / \\partial t}{\\partial \\phi / \\partial n}\n$$\nA radiation boundary condition is designed to allow waves to pass out of the computational domain with minimal reflection. This is accomplished by enforcing the advective dynamics, as described by the governing equation, at the boundary itself. However, the true phase speed $c$ is unknown. The core idea of an adaptive radiation boundary condition, such as that proposed by Orlanski (1976), is to *estimate* the phase speed from the behavior of the solution near the boundary and use this estimate in the boundary condition.\n\nLet $\\hat{c}$ be the locally estimated phase speed. This estimator is naturally defined by the same relationship that holds for the true phase speed, but using the measured or computed gradients of the field $\\phi$ at or near the boundary:\n$$\n\\hat{c} = - \\frac{\\left(\\frac{\\partial \\phi}{\\partial t}\\right)_{\\text{local}}}{\\left(\\frac{\\partial \\phi}{\\partial n}\\right)_{\\text{local}}}\n$$\nThe radiation-type open boundary condition is then the prognostic equation for $\\phi$ at the boundary, which imposes that the field be advected outward with this estimated phase speed $\\hat{c}$. The mathematical formulation of the boundary condition is:\n$$\n\\frac{\\partial \\phi}{\\partial t} + \\hat{c}\\,\\frac{\\partial \\phi}{\\partial n} = 0\n$$\nThis equation, applied at the boundary, combined with the definition of the estimator $\\hat{c}$, constitutes the derived radiation boundary condition. In a practical implementation, the gradients are computed using finite differences from the numerical solution, and constraints (e.g., $0 \\le \\hat{c} \\le c_{\\max}$) are often applied to ensure numerical stability and to prevent inflow.\n\n### Task 2: Noisy-Gradient Sensitivity Analysis\n\nIn the second task, we analyze the statistical properties of the phase-speed estimator $\\hat{c}$ when the gradients are contaminated with noise. The measured temporal and spatial gradients, $a_m$ and $b_m$, are given by:\n$$\na_m = a + \\eta_t, \\quad b_m = b + \\eta_n\n$$\nwhere $a = \\left.\\frac{\\partial \\phi}{\\partial t}\\right|_{\\text{true}}$ and $b = \\left.\\frac{\\partial \\phi}{\\partial n}\\right|_{\\text{true}}$. The noise terms $\\eta_t$ and $\\eta_n$ are random variables with zero mean ($\\mathbb{E}[\\eta_t]=0$, $\\mathbb{E}[\\eta_n]=0$), variances $\\mathbb{E}[\\eta_t^2]=\\sigma_t^2$ and $\\mathbb{E}[\\eta_n^2]=\\sigma_n^2$, and covariance $\\mathbb{E}[\\eta_t \\eta_n]=\\rho\\,\\sigma_t \\sigma_n$.\n\nThe phase-speed estimator $\\hat{c}$, consistent with the derivation in Task 1, is defined using the measured gradients:\n$$\n\\hat{c} = - \\frac{a_m}{b_m} = - \\frac{a + \\eta_t}{b + \\eta_n}\n$$\nThe true gradients $a$ and $b$ are not independent; they are linked by the governing equation with the true phase speed $c$: $a + c b = 0$, which implies $a = -c b$. Substituting this relationship into the expression for $\\hat{c}$:\n$$\n\\hat{c} = - \\frac{-c b + \\eta_t}{b + \\eta_n} = \\frac{c b - \\eta_t}{b + \\eta_n}\n$$\nWe are asked to compute the expected value of $\\hat{c}$, denoted $\\mathbb{E}[\\hat{c}]$, in the small-noise regime where terms beyond second order in $(\\eta_t, \\eta_n)$ are negligible. This suggests a second-order Taylor series expansion of $\\hat{c}$ around the point $(\\eta_t, \\eta_n) = (0, 0)$.\n\nTo facilitate the expansion, we factor out $b$ from the denominator:\n$$\n\\hat{c} = \\frac{c b - \\eta_t}{b(1 + \\eta_n/b)} = \\left(\\frac{c b - \\eta_t}{b}\\right) \\left(1 + \\frac{\\eta_n}{b}\\right)^{-1}\n$$\nUsing the geometric series approximation $(1+x)^{-1} \\approx 1 - x + x^2$ for small $x = \\eta_n/b$, we have:\n$$\n\\hat{c} \\approx \\left(c - \\frac{\\eta_t}{b}\\right) \\left(1 - \\frac{\\eta_n}{b} + \\frac{\\eta_n^2}{b^2}\\right)\n$$\nNow, we expand this product and retain terms up to the second order in the noise variables $\\eta_t$ and $\\eta_n$:\n$$\n\\hat{c} \\approx c\\left(1 - \\frac{\\eta_n}{b} + \\frac{\\eta_n^2}{b^2}\\right) - \\frac{\\eta_t}{b}\\left(1 - \\frac{\\eta_n}{b} + \\frac{\\eta_n^2}{b^2}\\right)\n$$\n$$\n\\hat{c} \\approx c - \\frac{c\\eta_n}{b} + \\frac{c\\eta_n^2}{b^2} - \\frac{\\eta_t}{b} + \\frac{\\eta_t \\eta_n}{b^2} - \\frac{\\eta_t \\eta_n^2}{b^3}\n$$\nNeglecting the third-order term $\\frac{\\eta_t \\eta_n^2}{b^3}$, the second-order approximation for $\\hat{c}$ is:\n$$\n\\hat{c} \\approx c - \\frac{\\eta_t}{b} - \\frac{c\\eta_n}{b} + \\frac{c\\eta_n^2}{b^2} + \\frac{\\eta_t \\eta_n}{b^2}\n$$\nTo find the expected value, we apply the expectation operator $\\mathbb{E}[\\cdot]$ to this expression. Using the linearity of expectation:\n$$\n\\mathbb{E}[\\hat{c}] \\approx \\mathbb{E}\\left[c - \\frac{\\eta_t}{b} - \\frac{c\\eta_n}{b} + \\frac{c\\eta_n^2}{b^2} + \\frac{\\eta_t \\eta_n}{b^2}\\right]\n$$\n$$\n\\mathbb{E}[\\hat{c}] \\approx \\mathbb{E}[c] - \\frac{1}{b}\\mathbb{E}[\\eta_t] - \\frac{c}{b}\\mathbb{E}[\\eta_n] + \\frac{c}{b^2}\\mathbb{E}[\\eta_n^2] + \\frac{1}{b^2}\\mathbb{E}[\\eta_t \\eta_n]\n$$\nNow, we substitute the given statistical properties of the noise: $\\mathbb{E}[\\eta_t]=0$, $\\mathbb{E}[\\eta_n]=0$, $\\mathbb{E}[\\eta_n^2]=\\sigma_n^2$, and $\\mathbb{E}[\\eta_t \\eta_n]=\\rho\\,\\sigma_t \\sigma_n$. The true values $c$ and $b$ are treated as constants in this context.\n$$\n\\mathbb{E}[\\hat{c}] \\approx c - \\frac{1}{b}(0) - \\frac{c}{b}(0) + \\frac{c}{b^2}(\\sigma_n^2) + \\frac{1}{b^2}(\\rho\\,\\sigma_t \\sigma_n)\n$$\nThis simplifies to the final leading-order expression for the expected value of the phase-speed estimator:\n$$\n\\mathbb{E}[\\hat{c}] \\approx c + \\frac{c \\sigma_n^2}{b^2} + \\frac{\\rho \\sigma_t \\sigma_n}{b^2}\n$$\nThis result can be rearranged to highlight the true value and the bias term:\n$$\n\\mathbb{E}[\\hat{c}] \\approx c \\left(1 + \\frac{\\sigma_n^2}{b^2}\\right) + \\frac{\\rho \\sigma_t \\sigma_n}{b^2}\n$$\nThis expression shows that the estimator $\\hat{c}$ is biased, with the bias depending on the noise variances, their correlation, and, critically, the inverse square of the true spatial gradient $b$. This indicates that the estimator is particularly sensitive to noise when the wave is spatially flat near the boundary.",
            "answer": "$$\n\\boxed{c \\left(1 + \\frac{\\sigma_n^2}{b^2}\\right) + \\frac{\\rho \\sigma_t \\sigma_n}{b^2}}\n$$"
        },
        {
            "introduction": "In a nested modeling framework, boundary conditions are not arbitrary but are supplied by a larger, often coarser, parent model at discrete time intervals $\\Delta t$. The method used to reconstruct a continuous-in-time boundary forcing from these discrete updates can have profound impacts on the nested solution. This practice uses Fourier analysis to quantify the spurious high-frequency forcing generated by two common reconstruction methods: zero-order hold (piecewise constant) and first-order hold (linear interpolation) . By comparing the spectral power of the forcing at the true signal's frequency, you will gain a deeper understanding of how the temporal coupling between models can either preserve or corrupt the integrity of the nested simulation.",
            "id": "4018123",
            "problem": "Consider a one-dimensional limited-area atmospheric model on a zonal strip with a single open lateral boundary at $x = 0$. The model applies Lateral Boundary Conditions (LBC) through relaxation (also called nudging) in a boundary zone of negligible thickness, idealized so that the boundary forcing time series experienced by the interior is $F(t) = \\gamma \\, Q_{b}(t)$, where $\\gamma > 0$ is a constant relaxation rate and $Q_{b}(t)$ is the boundary value prescribed from a driving model. Assume that the large-scale driving signal at the boundary is a single-frequency gravity-wave mode with true boundary value $Q_{\\text{true}}(t) = Q_{0} \\cos(\\omega_{g} t)$, where $Q_{0} > 0$ is the amplitude and $\\omega_{g} > 0$ is the model’s intrinsic gravity-wave angular frequency. The LBC updates are available at times $t_{n} = n \\Delta t$ for $n = 0, 1, \\dots, N-1$, with $\\Delta t > 0$ fixed and $T = N \\Delta t$ the total analysis window. Assume that $\\omega_{g}$ is commensurate with $T$, i.e., there exists an integer $p$ such that $\\omega_{g} = 2 \\pi p / T$.\n\nDefine two reconstruction strategies for $Q_{b}(t)$ between LBC updates:\n- Zero-Order Hold (ZOH): $Q_{b}^{\\text{pc}}(t) = Q_{\\text{true}}(t_{n})$ for $t \\in [t_{n}, t_{n+1})$.\n- First-Order Hold (FOH): $Q_{b}^{\\text{lin}}(t)$ is the unique linear interpolant on each interval $[t_{n}, t_{n+1}]$ matching $Q_{\\text{true}}(t_{n})$ and $Q_{\\text{true}}(t_{n+1})$.\n\nLet the forcing spectrum be defined by the complex Fourier series coefficients of $F(t)$ over $[0, T]$ at integer wavenumbers $k$, i.e., for $\\omega_{k} = 2 \\pi k / T$, the coefficient is $C_{k} = \\frac{1}{T} \\int_{0}^{T} F(t) \\exp(-i \\omega_{k} t) \\, dt$. Focus on the spectral component at the gravity-wave frequency $k = p$, so $\\omega_{p} = \\omega_{g}$. For each reconstruction (ZOH and FOH), compute the modulus of the corresponding coefficient at $\\omega_{g}$, denoted $|C_{p}^{\\text{pc}}|$ and $|C_{p}^{\\text{lin}}|$. Then, derive the closed-form expression for the ratio\n$$\nR \\equiv \\frac{|C_{p}^{\\text{pc}}|}{|C_{p}^{\\text{lin}}|},\n$$\nexpressed purely in terms of $\\omega_{g}$ and $\\Delta t$. Provide your final answer as a single analytic expression. No numerical rounding is required. The ratio $R$ is dimensionless; do not include any units in your final expression.",
            "solution": "The goal is to compute the ratio $R = |C_{p}^{\\text{pc}}| / |C_{p}^{\\text{lin}}|$, where $C_p$ are the Fourier series coefficients of the forcing function $F(t) = \\gamma Q_b(t)$ at the frequency $\\omega_g = \\omega_p$. Since $\\gamma$ is a constant, this ratio is equivalent to the ratio of the moduli of the Fourier coefficients of the reconstructed boundary signals $Q_b(t)$ themselves. Let these be $c_p^{\\text{pc}}$ and $c_p^{\\text{lin}}$.\n\n**1. Zero-Order Hold (ZOH) Coefficient**\n\nThe ZOH reconstruction samples the true signal at times $t_n$ and holds the value constant over the interval $[t_n, t_{n+1})$. From the perspective of signal processing, this reconstruction acts as a low-pass filter on the true signal. The Fourier coefficient of the reconstructed signal at frequency $\\omega_g$ is the coefficient of the true signal, $Q_0/2$, multiplied by the filter's transfer function, which is a sinc function. The modulus of the coefficient is:\n$$\n|c_{p}^{\\text{pc}}| = \\frac{Q_0}{2} \\left| \\frac{\\sin(\\omega_g \\Delta t / 2)}{\\omega_g \\Delta t / 2} \\right|\n$$\n\n**2. First-Order Hold (FOH) Coefficient**\n\nThe FOH reconstruction uses linear interpolation between sample points. This process is equivalent to convolving the sampled signal with a triangular basis function. In the frequency domain, this corresponds to multiplying the true spectrum by a transfer function that is a squared sinc function. This filter provides better attenuation of high-frequency artifacts compared to ZOH. The resulting coefficient modulus is:\n$$\n|c_{p}^{\\text{lin}}| = \\frac{Q_0}{2} \\left( \\frac{\\sin(\\omega_g \\Delta t / 2)}{\\omega_g \\Delta t / 2} \\right)^2\n$$\n\n**3. The Ratio**\n\nThe ratio $R$ is now straightforward to compute by dividing the modulus of the ZOH coefficient by the modulus of the FOH coefficient:\n$$\nR = \\frac{|c_{p}^{\\text{pc}}|}{|c_{p}^{\\text{lin}}|} = \\frac{\\frac{Q_0}{2} \\left| \\frac{\\sin(\\omega_{g} \\Delta t/2)}{\\omega_{g} \\Delta t/2} \\right|}{\\frac{Q_0}{2} \\left( \\frac{\\sin(\\omega_{g} \\Delta t/2)}{\\omega_{g} \\Delta t/2} \\right)^2} = \\frac{1}{\\left| \\frac{\\sin(\\omega_{g} \\Delta t/2)}{\\omega_{g} \\Delta t/2} \\right|}\n$$\nIn typical modeling scenarios, the sampling interval $\\Delta t$ is chosen to resolve the wave, meaning $\\omega_g \\Delta t  2\\pi$. In this case, the argument of the sinc function is in $(-\\pi, \\pi)$, and the function is non-negative, allowing the absolute value to be removed.\n$$\nR = \\frac{\\omega_{g} \\Delta t / 2}{\\sin(\\omega_{g} \\Delta t / 2)} = \\frac{\\omega_{g} \\Delta t}{2 \\sin(\\omega_{g} \\Delta t / 2)}\n$$\nThis is the final closed-form expression for the ratio.",
            "answer": "$$\n\\boxed{\\frac{\\omega_{g} \\Delta t}{2 \\sin\\left(\\frac{\\omega_{g} \\Delta t}{2}\\right)}}\n$$"
        }
    ]
}