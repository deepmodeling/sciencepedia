{
    "hands_on_practices": [
        {
            "introduction": "A fundamental requirement for any limited-area model is a well-posed set of lateral boundary conditions. Prescribing too few conditions leads to an underspecified problem with non-unique solutions, while prescribing too many over-constrains the system, generating spurious waves that contaminate the forecast. This exercise provides hands-on practice with characteristic analysis, the mathematical tool used to determine the precise number of boundary conditions required for a hyperbolic system, using the classic rotating shallow-water equations as a testbed .",
            "id": "4018138",
            "problem": "Consider lateral boundary condition design for a one-dimensional Limited-Area Model (LAM) used in Numerical Weather Prediction (NWP). Take the rotating shallow-water system on a constant Coriolis parameter $f$ (an $f$-plane), linearized about a uniform background zonal flow $U$ and constant mean depth $H$ with gravitational acceleration $g$. Let the model domain be $x \\in [0,L]$, with the western boundary at $x=0$ and the eastern boundary at $x=L$. Assume disturbances are uniform in the meridional direction (no $y$-dependence). The prognostic variables are the zonal velocity $u$, meridional velocity $v$, and free-surface displacement $\\eta$. Define the gravity-wave speed $c = \\sqrt{g H}$. \n\nUsing only first principles for hyperbolic systems and characteristic analysis of the flux Jacobian normal to the boundary, determine whether the inflow–outflow regime is supercritical or subcritical when $|U|c$, and compute the ordered pair $(n_{\\text{inflow}}, n_{\\text{outflow}})$ of the minimum number of independent boundary conditions that must be prescribed at the inflow boundary and at the outflow boundary, respectively, to ensure a well-posed lateral boundary value problem for the linearized system. Express your final numerical result for $(n_{\\text{inflow}}, n_{\\text{outflow}})$ as a row vector using the $\\mathrm{pmatrix}$ convention. No rounding is required, and no physical units are involved in the final answer.",
            "solution": "The problem asks for an analysis of the lateral boundary conditions for a linearized one-dimensional rotating shallow-water system. The key to determining the number of required boundary conditions for a well-posed problem is to perform a characteristic analysis of the system of hyperbolic partial differential equations.\n\nFirst, we write down the governing equations. The system is described by the prognostic variables for zonal velocity $u$, meridional velocity $v$, and free-surface displacement $\\eta$. The system is linearized about a background state of constant zonal flow $U$ and constant mean depth $H$. There is no meridional dependence, so all derivatives with respect to $y$ are zero. The linearized equations are:\n$$ \\frac{\\partial u}{\\partial t} + U \\frac{\\partial u}{\\partial x} - f v + g \\frac{\\partial \\eta}{\\partial x} = 0 $$\n$$ \\frac{\\partial v}{\\partial t} + U \\frac{\\partial v}{\\partial x} + f u = 0 $$\n$$ \\frac{\\partial \\eta}{\\partial t} + U \\frac{\\partial \\eta}{\\partial x} + H \\frac{\\partial u}{\\partial x} = 0 $$\nHere, $f$ is the Coriolis parameter, and $g$ is the gravitational acceleration.\n\nTo perform a characteristic analysis, we write this system in the matrix form $\\frac{\\partial \\mathbf{q}}{\\partial t} + \\mathbf{A} \\frac{\\partial \\mathbf{q}}{\\partial x} = \\mathbf{S}$, where $\\mathbf{q}$ is the state vector of prognostic variables, $\\mathbf{A}$ is the flux Jacobian matrix, and $\\mathbf{S}$ contains non-flux-gradient terms. Let the state vector be $\\mathbf{q} = \\begin{pmatrix} u \\\\ v \\\\ \\eta \\end{pmatrix}$. The system can be rewritten as:\n$$ \\frac{\\partial}{\\partial t}\\begin{pmatrix} u \\\\ v \\\\ \\eta \\end{pmatrix} + \\begin{pmatrix} U  0  g \\\\ 0  U  0 \\\\ H  0  U \\end{pmatrix} \\frac{\\partial}{\\partial x}\\begin{pmatrix} u \\\\ v \\\\ \\eta \\end{pmatrix} = \\begin{pmatrix} fv \\\\ -fu \\\\ 0 \\end{pmatrix} $$\nThe matrix $\\mathbf{A}$ is the flux Jacobian normal to the boundary (in the $x$-direction):\n$$ \\mathbf{A} = \\begin{pmatrix} U  0  g \\\\ 0  U  0 \\\\ H  0  U \\end{pmatrix} $$\nThe eigenvalues $\\lambda$ of $\\mathbf{A}$ represent the characteristic speeds, which are the speeds at which information propagates along characteristic curves. The eigenvalues are found by solving the characteristic equation $\\det(\\mathbf{A} - \\lambda\\mathbf{I}) = 0$.\n$$ \\det \\begin{pmatrix} U - \\lambda  0  g \\\\ 0  U - \\lambda  0 \\\\ H  0  U - \\lambda \\end{pmatrix} = 0 $$\nExpanding the determinant along the second row gives:\n$$ (U - \\lambda) \\det \\begin{pmatrix} U - \\lambda  g \\\\ H  U - \\lambda \\end{pmatrix} = 0 $$\n$$ (U - \\lambda) \\left[ (U - \\lambda)^2 - gH \\right] = 0 $$\nThe problem defines the gravity-wave speed as $c = \\sqrt{gH}$. Substituting this, we get:\n$$ (U - \\lambda) \\left[ (U - \\lambda)^2 - c^2 \\right] = 0 $$\nThis equation yields three eigenvalues:\n$$ \\lambda_1 = U - c $$\n$$ \\lambda_2 = U $$\n$$ \\lambda_3 = U + c $$\nThese eigenvalues are the speeds of the three characteristic modes of the system: two gravity waves propagating at speeds $U \\pm c$ relative to the ground, and one mode (associated with $v$) advected with the mean flow $U$.\n\nThe problem asks whether the inflow–outflow regime is supercritical or subcritical. This is determined by comparing the mean flow speed $|U|$ to the gravity-wave speed $c$.\n- A flow is **subcritical** if $|U|  c$. In this case, gravity waves can propagate both upstream and downstream relative to the mean flow.\n- A flow is **supercritical** if $|U|  c$. In this case, all waves are swept downstream.\nThe problem states the condition $|U|  c$, which explicitly defines the regime as **subcritical**.\n\nFor a hyperbolic system to have a well-posed boundary value problem, the number of boundary conditions prescribed at a given boundary must be equal to the number of characteristic curves entering the domain at that boundary.\n- At the western boundary ($x=0$), a characteristic enters the domain if its speed $\\lambda$ is positive ($\\lambda  0$).\n- At the eastern boundary ($x=L$), a characteristic enters the domain if its speed $\\lambda$ is negative ($\\lambda  0$).\n\nWe are given $|U|  c$, which is equivalent to $-c  U  c$. We must determine the number of boundary conditions at a generic inflow boundary and a generic outflow boundary. The result should be independent of whether the mean flow is westerly ($U0$) or easterly ($U0$). Let's analyze the signs of the eigenvalues under the condition $|U|c$, assuming $U \\neq 0$.\n- $\\lambda_1 = U - c$: Since $U  c$, it follows that $U - c  0$. So, $\\lambda_1$ is always negative.\n- $\\lambda_3 = U + c$: Since $U  -c$, it follows that $U + c  0$. So, $\\lambda_3$ is always positive.\n- $\\lambda_2 = U$: The sign of this eigenvalue is the same as the sign of $U$.\n\nLet's consider the two cases for the direction of the mean flow.\n\nCase 1: Westerly flow ($U  0$).\nThe inflow boundary is at $x=0$, and the outflow boundary is at $x=L$.\n- **Inflow boundary ($x=0$):** The number of required boundary conditions, $n_{\\text{inflow}}$, is the number of positive eigenvalues.\n  The eigenvalues are $\\lambda_1 = U-c  0$, $\\lambda_2 = U  0$, and $\\lambda_3 = U+c  0$.\n  There are two positive eigenvalues ($\\lambda_2$ and $\\lambda_3$).\n  Therefore, $n_{\\text{inflow}} = 2$.\n- **Outflow boundary ($x=L$):** The number of required boundary conditions, $n_{\\text{outflow}}$, is the number of negative eigenvalues.\n  There is one negative eigenvalue ($\\lambda_1$).\n  Therefore, $n_{\\text{outflow}} = 1$.\n\nCase 2: Easterly flow ($U  0$).\nThe inflow boundary is at $x=L$, and the outflow boundary is at $x=0$.\n- **Inflow boundary ($x=L$):** The number of required boundary conditions, $n_{\\text{inflow}}$, is the number of negative eigenvalues.\n  The eigenvalues are $\\lambda_1 = U-c  0$, $\\lambda_2 = U  0$, and $\\lambda_3 = U+c  0$.\n  There are two negative eigenvalues ($\\lambda_1$ and $\\lambda_2$).\n  Therefore, $n_{\\text{inflow}} = 2$.\n- **Outflow boundary ($x=0$):** The number of required boundary conditions, $n_{\\text{outflow}}$, is the number of positive eigenvalues.\n  There is one positive eigenvalue ($\\lambda_3$).\n  Therefore, $n_{\\text{outflow}} = 1$.\n\nIn both cases, the result is the same. For the subcritical flow regime ($|U|c$), two independent boundary conditions must be prescribed at the inflow boundary, and one independent boundary condition must be prescribed at the outflow boundary.\n\nThe ordered pair of the minimum number of independent boundary conditions is $(n_{\\text{inflow}}, n_{\\text{outflow}}) = (2, 1)$.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 2  1 \\end{pmatrix} } $$"
        },
        {
            "introduction": "Moving from continuous equations to a discrete grid introduces new challenges, especially on the staggered grids commonly used in atmospheric and oceanic models. This practice problem bridges theory and application by asking you to design a boundary operator for the Arakawa C-grid, a popular choice for its favorable wave dispersion properties. You will explore how to implement physical conditions like 'no-normal-flow' and 'free-slip' in a way that preserves the delicate geostrophic balance, a crucial step for preventing spurious noise at the model boundaries .",
            "id": "4018130",
            "problem": "Consider a barotropic, constant-depth limited-area model governed by the linear rotating shallow-water equations on an $f$-plane:\n$$\n\\frac{\\partial u}{\\partial t} - f v = - g \\frac{\\partial h}{\\partial x}, \\quad\n\\frac{\\partial v}{\\partial t} + f u = - g \\frac{\\partial h}{\\partial y}, \\quad\n\\frac{\\partial h}{\\partial t} + H \\left( \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} \\right) = 0,\n$$\nwhere $u$ and $v$ are the horizontal velocity components, $h$ is the free-surface height, $g$ is gravitational acceleration, $f$ is the Coriolis parameter, and $H$ is the mean depth. The domain is a rectangle with the western lateral boundary at $x = 0$. Variables are discretized on the Arakawa C-grid (C-grid): $u$ is stored at $(x_{i+1/2}, y_j)$, $v$ at $(x_i, y_{j+1/2})$, and $h$ at $(x_i, y_j)$ for uniform spacings $\\Delta x$ and $\\Delta y$. At interior $u$ points, the discrete pressure gradient is approximated by\n$$\n\\left. g \\frac{\\partial h}{\\partial x} \\right|_{x_{i+1/2}, y_j} \\approx g \\frac{h_{i+1,j} - h_{i,j}}{\\Delta x}.\n$$\nFor a limited-area model nested one-way inside a larger parent model, appropriate lateral boundary conditions must be imposed at $x=0$ to ensure consistency and stability. Construct a discrete boundary operator acting at the western boundary that enforces (i) no-normal-flow and (ii) free-slip conditions on the C-grid using ghost-cell values, and that, when coupled to the above discrete pressure gradient stencil at the boundary $u$-points,\n$$\n\\left. g \\frac{\\partial h}{\\partial x} \\right|_{x_{1/2}, y_j} \\approx g \\frac{h_{1,j} - h_{0,j}}{\\Delta x},\n$$\npreserves geostrophic balance to leading order. Here $h_{0,j}$ denotes the ghost-cell height immediately outside the boundary. Assume the parent model provides a smoothly varying geostrophically balanced state that, at the nested boundary, is consistent with a linear height field in the normal direction, namely\n$$\nh(x,y) = H_0 + \\alpha x, \\quad \\frac{\\partial h}{\\partial y} = 0, \\quad u(x,y) = 0, \\quad v(x,y) = \\frac{g \\alpha}{f},\n$$\nwith constant $\\alpha$, $H_0$, $f$, and $g$. Using your constructed operator, compute the discrete geostrophic residual in the $u$-momentum equation at the western boundary $u$-point,\n$$\nR_u \\equiv - f v_{1/2,j} + g \\frac{h_{1,j} - h_{0,j}}{\\Delta x},\n$$\nunder the above linear parent state. Express your final answer as a single simplified symbolic expression in terms of $f$, $g$, $\\alpha$, and $\\Delta x$. No rounding is required, and no units should be included with the final answer. Clearly state any intermediate assumptions you invoke to ensure scientific realism of the operator and its consistency with the C-grid placement.",
            "solution": "The goal is to compute the discrete geostrophic residual, $R_u$, at the western boundary. This requires constructing a boundary operator that specifies ghost-cell values for the tangential velocity $v$ and the height $h$, and then evaluating the terms of $R_u$ using these specifications.\n\n**1. Arakawa C-grid Staggering at the Boundary**\nThe problem states that the western boundary is at $x=0$ and the $u$-velocity points are at locations indexed by $i+1/2$. The pressure gradient is evaluated at the boundary $u$-point, indexed as $1/2$. This implies that the boundary itself passes through the $u$-velocity points. We establish the grid layout where the domain is for $x0$. Let the discrete coordinates be defined such that the boundary $u$-point $u_{1/2,j}$ is at $x=0$.\n-   $u$-points are at $x_{i+1/2} = i \\Delta x$ for $i=0, 1, 2, ...$. The boundary $u$-point is $u_{1/2}$ at $x_{1/2}=0 \\cdot \\Delta x = 0$.\n-   $h$-points and $v$-points (in their $x$-location) are at $x_i = (i-1/2)\\Delta x$ for $i=1, 2, ...$ in the interior and $i=0, -1, ...$ in the ghost region.\nThe resulting grid structure along the $x$-axis near the boundary is:\n-   Ghost-cell $h_{0,j}$ and $v_{0,j\\pm 1/2}$ are at $x_0 = -\\frac{\\Delta x}{2}$.\n-   Boundary normal velocity $u_{1/2,j}$ is at $x_{1/2} = 0$.\n-   First interior $h_{1,j}$ and $v_{1,j\\pm 1/2}$ are at $x_1 = \\frac{\\Delta x}{2}$.\n\n**2. Constructing the Discrete Boundary Operator**\nThe operator sets the ghost-cell values based on the physical conditions and the nesting strategy.\n\n-   **Free-slip condition:** The free-slip condition at the western wall ($x=0$) is $\\frac{\\partial v}{\\partial x} = 0$. We implement this using a second-order accurate centered finite difference centered at $x=0$, which uses the first interior point $v_{1, \\cdot}$ (at $x_1 = \\Delta x/2$) and the ghost point $v_{0, \\cdot}$ (at $x_0 = -\\Delta x/2$):\n    $$ \\left. \\frac{\\partial v}{\\partial x} \\right|_{x=0} \\approx \\frac{v_{1,j\\pm 1/2} - v_{0,j\\pm 1/2}}{\\Delta x} = 0 $$\n    This implies that the ghost-cell value for the tangential velocity is set equal to the first interior value:\n    $$ v_{0,j\\pm 1/2} = v_{1,j\\pm 1/2} $$\n\n-   **No-normal-flow condition:** The condition $u=0$ at the boundary $x=0$ is applied directly, since $u_{1/2, j}$ is located on the boundary: $u_{1/2, j} = 0$. This condition is satisfied by the given parent state.\n\n-   **Height boundary condition:** For a one-way nested model, boundary conditions are supplied by the parent model. To ensure consistency, the ghost-cell values are set to the values of the parent model's analytical field at the ghost-cell locations. The ghost-cell height $h_{0,j}$ is located at $(x_0, y_j) = (-\\frac{\\Delta x}{2}, y_j)$. The parent model's height is $h(x,y) = H_0 + \\alpha x$. Thus, the operator sets:\n    $$ h_{0,j} = h(-\\frac{\\Delta x}{2}, y_j) = H_0 - \\frac{\\alpha\\Delta x}{2} $$\n\n**3. Calculating the Geostrophic Residual**\nThe residual is defined as $R_u \\equiv - f v_{1/2,j} + g \\frac{h_{1,j} - h_{0,j}}{\\Delta x}$. We evaluate each term separately.\n\n-   **Pressure Gradient Term:**\n    The term $g \\frac{h_{1,j} - h_{0,j}}{\\Delta x}$ requires the height at the first interior point, $h_{1,j}$, and the ghost point, $h_{0,j}$.\n    The interior point $h_{1,j}$ is at $(x_1, y_j) = (\\frac{\\Delta x}{2}, y_j)$. Its value is taken from the parent state:\n    $$ h_{1,j} = h(\\frac{\\Delta x}{2}, y_j) = H_0 + \\frac{\\alpha\\Delta x}{2} $$\n    The ghost-cell value $h_{0,j}$ was determined by our operator to be $H_0 - \\frac{\\alpha\\Delta x}{2}$.\n    Substituting these into the pressure gradient term:\n    $$ g \\frac{h_{1,j} - h_{0,j}}{\\Delta x} = g \\frac{(H_0 + \\frac{\\alpha\\Delta x}{2}) - (H_0 - \\frac{\\alpha\\Delta x}{2})}{\\Delta x} = g \\frac{\\alpha\\Delta x}{\\Delta x} = g\\alpha $$\n    This result is exact because the centered difference of a linear function is equal to its derivative.\n\n-   **Coriolis Term:**\n    The term $-f v_{1/2,j}$ requires the value of $v$ at the $u$-point $(x_{1/2}, y_j) = (0, y_j)$. On the C-grid, $v$ is not co-located with $u$. Its value must be interpolated from surrounding $v$-points. The standard, second-order accurate interpolation for the Coriolis term at $u_{1/2,j}$ is a four-point average of the neighboring $v$-points: $v_{0,j-1/2}$, $v_{0,j+1/2}$, $v_{1,j-1/2}$, and $v_{1,j+1/2}$.\n    $$ v_{1/2,j} = \\frac{1}{4} (v_{0,j-1/2} + v_{0,j+1/2} + v_{1,j-1/2} + v_{1,j+1/2}) $$\n    The parent model state for tangential velocity is $v(x,y) = \\frac{g\\alpha}{f}$, which is a constant. Therefore, all discrete $v$ values in the interior are equal to this constant:\n    $$ v_{1,j-1/2} = \\frac{g\\alpha}{f} \\quad \\text{and} \\quad v_{1,j+1/2} = \\frac{g\\alpha}{f} $$\n    Using the free-slip condition from our operator, $v_{0,\\cdot} = v_{1,\\cdot}$, we find the ghost-cell values:\n    $$ v_{0,j-1/2} = \\frac{g\\alpha}{f} \\quad \\text{and} \\quad v_{0,j+1/2} = \\frac{g\\alpha}{f} $$\n    Substituting all four values into the interpolation formula:\n    $$ v_{1/2,j} = \\frac{1}{4} \\left(\\frac{g\\alpha}{f} + \\frac{g\\alpha}{f} + \\frac{g\\alpha}{f} + \\frac{g\\alpha}{f}\\right) = \\frac{g\\alpha}{f} $$\n    The Coriolis term is therefore:\n    $$ -f v_{1/2,j} = -f \\left( \\frac{g\\alpha}{f} \\right) = -g\\alpha $$\n\n-   **Total Residual:**\n    Combining the two terms, the geostrophic residual is:\n    $$ R_u = (-g\\alpha) + (g\\alpha) = 0 $$\n\nThe constructed boundary operator, which uses standard numerical practice for a C-grid (free-slip via ghost cells, height specification from a parent model, and 4-point Coriolis interpolation), perfectly preserves the geostrophic balance of the linear parent state. This is because the second-order finite-difference schemes used are exact for linear or constant fields. The requirement to preserve balance \"to leading order\" is more than satisfied, as all error terms are zero.",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "While inflow boundaries can be directly specified from a parent model, outflow boundaries pose a greater challenge: we need to let information pass out of the domain without generating artificial reflections. This practice explores the elegant and widely used Orlanski radiation boundary condition, an adaptive method that estimates the local phase speed of outgoing waves. You will first derive this condition from the advection equation and then analyze its sensitivity to the noisy gradients inevitably present in a numerical simulation, revealing a key trade-off in its practical application .",
            "id": "4018160",
            "problem": "Consider a nested limited-area model (LAM) embedded within a larger driving model. Along one open boundary with outward unit normal direction denoted by $n$, suppose a scalar prognostic field $\\phi(n,t)$ near the boundary is locally governed by the one-dimensional linear advection–wave equation, consistent with outgoing disturbances,\n$$\n\\frac{\\partial \\phi}{\\partial t} + c\\,\\frac{\\partial \\phi}{\\partial n} = 0,\n$$\nwhere $c$ is an unknown, slowly varying phase speed of the wave packet in the normal direction. You may assume the field is sufficiently smooth and that characteristics are quasi-stationary over the temporal window used to estimate local gradients.\n\nTask 1 (Derivation): Starting from the above fundamental partial differential equation and the observation that locally plane-wave-like signals satisfy a constant phase speed, derive a radiation-type open boundary condition for $\\phi$ at the boundary that advects information outward using a locally estimated phase speed based on the temporal and spatial gradients of $\\phi$ evaluated at the boundary.\n\nTask 2 (Noisy-gradient sensitivity): In practice, within a nested configuration, the local temporal and spatial gradients used to estimate the phase speed are contaminated by small additive errors arising from interpolation mismatch, representativeness differences, and numerical noise. Model the measured gradients at the boundary by\n$$\na_m = a + \\eta_t, \\quad b_m = b + \\eta_n,\n$$\nwhere $a = \\left.\\frac{\\partial \\phi}{\\partial t}\\right|_{\\text{true}}$, $b = \\left.\\frac{\\partial \\phi}{\\partial n}\\right|_{\\text{true}}$, and $\\eta_t$, $\\eta_n$ are zero-mean random perturbations with $\\mathbb{E}[\\eta_t]=0$, $\\mathbb{E}[\\eta_n]=0$, variances $\\mathbb{E}[\\eta_t^2]=\\sigma_t^2$, $\\mathbb{E}[\\eta_n^2]=\\sigma_n^2$, and covariance $\\mathbb{E}[\\eta_t \\eta_n]=\\rho\\,\\sigma_t \\sigma_n$, where $-1 \\le \\rho \\le 1$. Assume the small-noise regime where terms beyond second order in $(\\eta_t, \\eta_n)$ can be neglected in expectations.\n\nDefine the phase-speed estimator that is consistent with your radiation boundary condition from Task 1 using the measured gradients $a_m$ and $b_m$, and compute the leading-order analytical expression for its expected value $\\mathbb{E}[\\hat{c}]$ under the above noise model. Express your final answer in closed form in terms of $c$, $b$, $\\sigma_t$, $\\sigma_n$, and $\\rho$ only, using the advection–wave relationship to eliminate $a$ where appropriate.\n\nYour final answer must be a single closed-form analytic expression. No numerical evaluation is required.",
            "solution": "The problem consists of two tasks. The first is to derive a radiation-type open boundary condition. The second is to analyze the statistical bias of the phase-speed estimator used in this boundary condition when the gradient measurements are noisy.\n\n### Task 1: Derivation of the Radiation Boundary Condition\n\nThe physical system near the open boundary is described by the one-dimensional linear advection–wave equation for a scalar field $\\phi(n,t)$:\n$$\n\\frac{\\partial \\phi}{\\partial t} + c\\,\\frac{\\partial \\phi}{\\partial n} = 0\n$$\nHere, $n$ is the coordinate in the direction of the outward unit normal, $t$ is time, and $c$ is the phase speed of outgoing disturbances. This equation establishes a fundamental relationship between the temporal and spatial gradients of the field $\\phi$.\n\nFor a solution that is locally wave-like, the phase speed $c$ can be expressed in terms of the local gradients. Assuming that the spatial gradient $\\frac{\\partial \\phi}{\\partial n}$ is non-zero, we can rearrange the governing equation to solve for $c$:\n$$\nc = - \\frac{\\partial \\phi / \\partial t}{\\partial \\phi / \\partial n}\n$$\nA radiation boundary condition is designed to allow waves to pass out of the computational domain with minimal reflection. This is accomplished by enforcing the advective dynamics, as described by the governing equation, at the boundary itself. However, the true phase speed $c$ is unknown. The core idea of an adaptive radiation boundary condition, such as that proposed by Orlanski (1976), is to *estimate* the phase speed from the behavior of the solution near the boundary and use this estimate in the boundary condition.\n\nLet $\\hat{c}$ be the locally estimated phase speed. This estimator is naturally defined by the same relationship that holds for the true phase speed, but using the measured or computed gradients of the field $\\phi$ at or near the boundary:\n$$\n\\hat{c} = - \\frac{\\left(\\frac{\\partial \\phi}{\\partial t}\\right)_{\\text{local}}}{\\left(\\frac{\\partial \\phi}{\\partial n}\\right)_{\\text{local}}}\n$$\nThe radiation-type open boundary condition is then the prognostic equation for $\\phi$ at the boundary, which imposes that the field be advected outward with this estimated phase speed $\\hat{c}$. The mathematical formulation of the boundary condition is:\n$$\n\\frac{\\partial \\phi}{\\partial t} + \\hat{c}\\,\\frac{\\partial \\phi}{\\partial n} = 0\n$$\nThis equation, applied at the boundary, combined with the definition of the estimator $\\hat{c}$, constitutes the derived radiation boundary condition. In a practical implementation, the gradients are computed using finite differences from the numerical solution, and constraints (e.g., $0 \\le \\hat{c} \\le c_{\\max}$) are often applied to ensure numerical stability and to prevent inflow.\n\n### Task 2: Noisy-Gradient Sensitivity Analysis\n\nIn the second task, we analyze the statistical properties of the phase-speed estimator $\\hat{c}$ when the gradients are contaminated with noise. The measured temporal and spatial gradients, $a_m$ and $b_m$, are given by:\n$$\na_m = a + \\eta_t, \\quad b_m = b + \\eta_n\n$$\nwhere $a = \\left.\\frac{\\partial \\phi}{\\partial t}\\right|_{\\text{true}}$ and $b = \\left.\\frac{\\partial \\phi}{\\partial n}\\right|_{\\text{true}}$. The noise terms $\\eta_t$ and $\\eta_n$ are random variables with zero mean ($\\mathbb{E}[\\eta_t]=0$, $\\mathbb{E}[\\eta_n]=0$), variances $\\mathbb{E}[\\eta_t^2]=\\sigma_t^2$ and $\\mathbb{E}[\\eta_n^2]=\\sigma_n^2$, and covariance $\\mathbb{E}[\\eta_t \\eta_n]=\\rho\\,\\sigma_t \\sigma_n$.\n\nThe phase-speed estimator $\\hat{c}$, consistent with the derivation in Task 1, is defined using the measured gradients:\n$$\n\\hat{c} = - \\frac{a_m}{b_m} = - \\frac{a + \\eta_t}{b + \\eta_n}\n$$\nThe true gradients $a$ and $b$ are not independent; they are linked by the governing equation with the true phase speed $c$: $a + c b = 0$, which implies $a = -c b$. Substituting this relationship into the expression for $\\hat{c}$:\n$$\n\\hat{c} = - \\frac{-c b + \\eta_t}{b + \\eta_n} = \\frac{c b - \\eta_t}{b + \\eta_n}\n$$\nWe are asked to compute the expected value of $\\hat{c}$, denoted $\\mathbb{E}[\\hat{c}]$, in the small-noise regime where terms beyond second order in $(\\eta_t, \\eta_n)$ are negligible. This suggests a second-order Taylor series expansion of $\\hat{c}$ around the point $(\\eta_t, \\eta_n) = (0, 0)$.\n\nTo facilitate the expansion, we factor out $b$ from the denominator:\n$$\n\\hat{c} = \\frac{c b - \\eta_t}{b(1 + \\eta_n/b)} = \\left(\\frac{c b - \\eta_t}{b}\\right) \\left(1 + \\frac{\\eta_n}{b}\\right)^{-1}\n$$\nUsing the geometric series approximation $(1+x)^{-1} \\approx 1 - x + x^2$ for small $x = \\eta_n/b$, we have:\n$$\n\\hat{c} \\approx \\left(c - \\frac{\\eta_t}{b}\\right) \\left(1 - \\frac{\\eta_n}{b} + \\frac{\\eta_n^2}{b^2}\\right)\n$$\nNow, we expand this product and retain terms up to the second order in the noise variables $\\eta_t$ and $\\eta_n$:\n$$\n\\hat{c} \\approx c\\left(1 - \\frac{\\eta_n}{b} + \\frac{\\eta_n^2}{b^2}\\right) - \\frac{\\eta_t}{b}\\left(1 - \\frac{\\eta_n}{b} + \\frac{\\eta_n^2}{b^2}\\right)\n$$\n$$\n\\hat{c} \\approx c - \\frac{c\\eta_n}{b} + \\frac{c\\eta_n^2}{b^2} - \\frac{\\eta_t}{b} + \\frac{\\eta_t \\eta_n}{b^2} - \\frac{\\eta_t \\eta_n^2}{b^3}\n$$\nNeglecting the third-order term $\\frac{\\eta_t \\eta_n^2}{b^3}$, the second-order approximation for $\\hat{c}$ is:\n$$\n\\hat{c} \\approx c - \\frac{\\eta_t}{b} - \\frac{c\\eta_n}{b} + \\frac{c\\eta_n^2}{b^2} + \\frac{\\eta_t \\eta_n}{b^2}\n$$\nTo find the expected value, we apply the expectation operator $\\mathbb{E}[\\cdot]$ to this expression. Using the linearity of expectation:\n$$\n\\mathbb{E}[\\hat{c}] \\approx \\mathbb{E}\\left[c - \\frac{\\eta_t}{b} - \\frac{c\\eta_n}{b} + \\frac{c\\eta_n^2}{b^2} + \\frac{\\eta_t \\eta_n}{b^2}\\right]\n$$\n$$\n\\mathbb{E}[\\hat{c}] \\approx \\mathbb{E}[c] - \\frac{1}{b}\\mathbb{E}[\\eta_t] - \\frac{c}{b}\\mathbb{E}[\\eta_n] + \\frac{c}{b^2}\\mathbb{E}[\\eta_n^2] + \\frac{1}{b^2}\\mathbb{E}[\\eta_t \\eta_n]\n$$\nNow, we substitute the given statistical properties of the noise: $\\mathbb{E}[\\eta_t]=0$, $\\mathbb{E}[\\eta_n]=0$, $\\mathbb{E}[\\eta_n^2]=\\sigma_n^2$, and $\\mathbb{E}[\\eta_t \\eta_n]=\\rho\\,\\sigma_t \\sigma_n$. The true values $c$ and $b$ are treated as constants in this context.\n$$\n\\mathbb{E}[\\hat{c}] \\approx c - \\frac{1}{b}(0) - \\frac{c}{b}(0) + \\frac{c}{b^2}(\\sigma_n^2) + \\frac{1}{b^2}(\\rho\\,\\sigma_t \\sigma_n)\n$$\nThis simplifies to the final leading-order expression for the expected value of the phase-speed estimator:\n$$\n\\mathbb{E}[\\hat{c}] \\approx c + \\frac{c \\sigma_n^2}{b^2} + \\frac{\\rho \\sigma_t \\sigma_n}{b^2}\n$$\nThis result can be rearranged to highlight the true value and the bias term:\n$$\n\\mathbb{E}[\\hat{c}] \\approx c \\left(1 + \\frac{\\sigma_n^2}{b^2}\\right) + \\frac{\\rho \\sigma_t \\sigma_n}{b^2}\n$$\nThis expression shows that the estimator $\\hat{c}$ is biased, with the bias depending on the noise variances, their correlation, and, critically, the inverse square of the true spatial gradient $b$. This indicates that the estimator is particularly sensitive to noise when the wave is spatially flat near the boundary.",
            "answer": "$$\n\\boxed{c \\left(1 + \\frac{\\sigma_n^2}{b^2}\\right) + \\frac{\\rho \\sigma_t \\sigma_n}{b^2}}\n$$"
        }
    ]
}