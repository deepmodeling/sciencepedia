{
    "hands_on_practices": [
        {
            "introduction": "在构建任何嵌套模型之前，理解单向耦合的根本局限性至关重要。本练习将探讨父模型的分辨率如何限制子模型在其边界上可获取的信息，通过信号处理的基本原理，将网格间距与信息内容联系起来。通过这个练习，你将能深入理解并量化在边界上传递信息时固有的信息损失。",
            "id": "4032869",
            "problem": "考虑在数值天气预报（NWP）中的一个单向嵌套动力降尺度配置。一个父模式为一个更精细的子区域气候模式（RCM）提供侧边界条件。两个模式都使用直角、水平均匀的网格，其排列方式使得子网格点位于父网格单元内。父模式的水平网格间距为 $\\Delta x_p = 12$ km，子模式的水平网格间距为 $\\Delta x_c = 4$ km。假设子模式侧边界上的边界更新使用了父模式最近四个网格点（即包围的父网格单元的四个角点）上预报变量的空间双线性插值，以及时间上的线性插值（本问题忽略时间方面）。假设没有应用预滤波或平滑，并且子边界点不正好落在父单元的边或角上。\n\n从奈奎斯特-香农采样定理和单向嵌套（信息仅从父模式流向子模式）的定义出发，回答以下问题：\n\n1. 确定为单个子边界点更新进行空间插值时，有多少个不同的父网格单元参与贡献。\n\n2. 将边界上的潜在信息损失定义为：在端点效应可忽略不计的长直边界极限下，子网格可以接受但父网格未提供的单位长度独立空间样本所占的比例。以精确形式（小数或分数）表示此比例，不要使用百分号。\n\n将你的最终答案以一对数的形式给出，第一个条目是贡献的父网格单元数，第二个条目是信息损失比例。不需要四舍五入。",
            "solution": "这个问题包含两个部分，都与单向嵌套动力降尺度设置有关。第一部分涉及空间插值方案，第二部分量化父模式和子模式之间边界上的信息损失。\n\n第1部分：确定为单个子边界点更新进行空间插值时，有多少个不同的父网格单元参与贡献。\n\n问题陈述，子模式的边界更新使用“父模式最近四个网格点（即包围的父网格单元的四个角点）上预报变量的空间双线性插值”。\n\n双线性插值是一种在直角网格上对两个变量（例如经度和纬度）的函数进行插值的方法。对于位于由四个角点 $(x_1, y_1)$、$(x_2, y_1)$、$(x_1, y_2)$ 和 $(x_2, y_2)$ 定义的矩形单元内的任何点 $(x, y)$，其插值是这四个角点值的加权平均。\n\n问题明确指出，子边界点不正好落在父单元的边或角上，这确保了任何给定的子边界点都明确地被单个父网格单元所*包围*。根据定义，用于插值的四个父网格点是这个单一包围单元的顶点。因此，用于单个子点插值的数据来自恰好一个父网格单元的角点。\n\n为一个子边界点更新提供贡献的不同父网格单元的数量是 $1$。\n\n第2部分：定义并计算边界上的潜在信息损失。\n\n潜在信息损失被定义为“子网格可以接受但父网格未提供的单位长度独立空间样本所占的比例”。这个概念植根于奈奎斯特-香农采样定理，该定理将网格间距与最大可分辨空间频率（或最小波长）联系起来。\n\n根据采样定理，间距为 $\\Delta x$ 的网格可以分辨的最小波长为 $\\lambda_{\\text{min}} = 2\\Delta x$。单位长度内的独立空间样本数，我们记为 $S$，与这个最小可分辨特征尺寸成反比，或者更直接地说，与网格间距本身成反比。因此，我们可以写出 $S \\propto \\frac{1}{\\Delta x}$。\n\n子网格的间距为 $\\Delta x_c$，它可以接受或表示对应于以下采样密度的信息内容：\n$$S_c \\propto \\frac{1}{\\Delta x_c}$$\n\n父模式具有较粗的网格间距 $\\Delta x_p$，提供边界条件。它所包含的信息受其自身分辨率的限制。父网格提供的信息内容对应于以下采样密度：\n$$S_p \\propto \\frac{1}{\\Delta x_p}$$\n\n由于是单向嵌套，信息仅从父模式流向子模式，因此子模式的边界不能包含比父模式能分辨和提供的更精细尺度的信息。插值过程传递了父模式的信息，但不会创造新的、更高频率的信息。\n\n子网格可以接受但父网格未提供的单位长度样本数是差值 $S_c - S_p$。信息损失比例 $L$ 是这个差值除以子网格的总容量 $S_c$ 进行归一化：\n$$L = \\frac{S_c - S_p}{S_c} = 1 - \\frac{S_p}{S_c}$$\n\n代入 $S_c$ 和 $S_p$ 的比例关系：\n$$L = 1 - \\frac{k/\\Delta x_p}{k/\\Delta x_c}$$\n其中 $k$ 是比例常数。常数 $k$ 被消去，得到：\n$$L = 1 - \\frac{\\Delta x_c}{\\Delta x_p}$$\n\n我们已知的网格间距为：\n- 父网格间距：$\\Delta x_p = 12$ km\n- 子网格间距：$\\Delta x_c = 4$ km\n\n将这些值代入损失比例 $L$ 的表达式中：\n$$L = 1 - \\frac{4}{12} = 1 - \\frac{1}{3} = \\frac{2}{3}$$\n\n这个比例代表了子模式设计用于分辨但父模式在边界上未提供任何信息的空间尺度部分。\n\n最终答案由第1部分的贡献单元数和第2部分的信息损失比例组成。\n- 贡献单元数：$1$\n- 信息损失比例：$\\frac{2}{3}$",
            "answer": "$$\\boxed{\\begin{pmatrix} 1  \\frac{2}{3} \\end{pmatrix}}$$"
        },
        {
            "introduction": "有限区域模型的一个主要挑战是防止在边界上产生的人为波扰动污染区域内部的解。本练习将演示牛顿弛豫或“缓冲”区的核心工作原理，这是一种广泛用于平滑吸收和衰减传入扰动的技术。你将通过第一性原理推导并量化这种缓冲区的有效性，这是确保嵌套模型稳定性和准确性的关键一步。",
            "id": "4032871",
            "problem": "一个侧向宽度为 $600\\ \\mathrm{km}$ 的单向嵌套区域模式（LAM）采用了一个宽度均匀为 $W=60\\ \\mathrm{km}$ 的侧向缓冲带，在该缓冲带内，牛顿弛豫（也称为Davies型弛豫）在时间上以恒定的弛豫时间尺度 $\\tau=600\\ \\mathrm{s}$ 被均匀应用。考虑一个无源标量振幅为 $a$ 的天气尺度扰动，它从外边界进入缓冲带，并以垂直于边界的恒定相速 $U=15\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$ 稳定地向内平流。假设扰动在缓冲带内的演变仅受线性平流和线性牛顿弛豫的影响，没有源、汇或非线性作用，并且 $a$ 足够小，可以进行线性叠加。\n\n从线性平流和沿拉格朗日轨迹的牛顿弛豫的第一性原理出发，推导衰减因子 $A$ 的表达式。$A$ 定义为擾动振幅在缓冲带内边缘与其在外边界处振幅之比。然后根据给定的参数计算 $A$ 的值。将最终答案表示为一个无量纲数，并四舍五入到三位有效数字。",
            "solution": "该问题涉及在一个缓冲带中受牛頓弛豫作用的无源平流扰动的振幅演变。其基本要素如下：\n\n1. 物质守恒量的线性平流意味着，沿着拉格朗日轨迹，仅平流过程本身不会改变振幅 $a$；物质变化由非平流过程引起。\n2. 时间尺度为 $\\tau$ 的扰动 $a$ 的牛顿弛豫会产生一个与 $-a/\\tau$ 成正比的线性阻尼趋势。\n\n设 $a(t)$ 表示气块穿过缓冲带时跟随其的扰动振幅。在所述假设下，缓冲带内沿拉格朗日轨迹的振幅演变由以下常微分方程给出\n$$\n\\frac{\\mathrm{d}a}{\\mathrm{d}t} \\;=\\; -\\frac{1}{\\tau}\\,a.\n$$\n该方程基于以下事实：平流沿轨迹输送 $a$ 但不改变其值，而作用于 $a$ 的唯一局地过程是速率为 $1/\\tau$ 的牛顿弛豫。\n\n使用分离变量法求解此线性常微分方程，可得\n$$\n\\frac{\\mathrm{d}a}{a} \\;=\\; -\\frac{\\mathrm{d}t}{\\tau}\n\\quad\\Rightarrow\\quad\n\\ln a(t) - \\ln a(0) \\;=\\; -\\frac{t}{\\tau}\n\\quad\\Rightarrow\\quad\na(t) \\;=\\; a(0)\\,\\exp\\!\\left(-\\frac{t}{\\tau}\\right).\n$$\n扰动在时间 $t=0$ 时于外边界进入缓冲带，并在时间 $t=t_{\\mathrm{buf}}$ 时于内边缘离开缓冲带。以速度 $U$ 穿过宽度为 $W$ 的缓冲带所需的时间即为平流时间\n$$\nt_{\\mathrm{buf}} \\;=\\; \\frac{W}{U}.\n$$\n因此，衰减因子 $A$（定义为内边缘振幅与外边界振幅之比）为\n$$\nA \\;\\equiv\\; \\frac{a(t_{\\mathrm{buf}})}{a(0)} \\;=\\; \\exp\\!\\left(-\\frac{t_{\\mathrm{buf}}}{\\tau}\\right) \\;=\\; \\exp\\!\\left(-\\frac{W}{U\\,\\tau}\\right).\n$$\n\n对于给定的值 $W=60\\ \\mathrm{km}=60{,}000\\ \\mathrm{m}$，$U=15\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$ 和 $\\tau=600\\ \\mathrm{s}$，我们计算\n$$\nt_{\\mathrm{buf}} \\;=\\; \\frac{60{,}000\\ \\mathrm{m}}{15\\ \\mathrm{m}\\ \\mathrm{s}^{-1}} \\;=\\; 4{,}000\\ \\mathrm{s},\n$$\n从而\n$$\n\\frac{t_{\\mathrm{buf}}}{\\tau} \\;=\\; \\frac{4{,}000\\ \\mathrm{s}}{600\\ \\mathrm{s}} \\;=\\; \\frac{20}{3} \\;\\approx\\; 6.666\\overline{6}.\n$$\n因此，\n$$\nA \\;=\\; \\exp\\!\\left(-\\frac{20}{3}\\right) \\;\\approx\\; 1.2726338\\times 10^{-3}.\n$$\n\n四舍五入到三位有效数字，衰减因子为 $1.27\\times 10^{-3}$。对此值进行解释，扰动在穿过缓冲带的过程中经历了大约 $6.67$ 个e-折衰减，这在缓冲带渡越时间内强力地阻尼了传入的天气尺度扰动，表明所选的弛豫时间尺度对于 $U=15\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$ 的天气尺度运动是足够的。然而，根据要求，所求的最终答案是 $A$ 的数值。",
            "answer": "$$\\boxed{1.27 \\times 10^{-3}}$$"
        },
        {
            "introduction": "动力降尺度的最终目标是生成更准确、更精细的局地预报，但这需要客观的评估。本练习将带你进入模型评估的关键环节：检验。你将实现并应用一种先进的检验指标——分位数评分（Quantile Score），来客观地衡量高分辨率子模型相较于其父模型是否提供了切实的改进，即“附加价值”（added value），尤其是在预报极端事件方面。",
            "id": "4032939",
            "problem": "考虑数值天气预报（NWP）中的一个嵌套动力降尺度设置，其中一个 $12\\,\\mathrm{km}$ 的“父”模型提供侧边界条件，而一个 $3\\,\\mathrm{km}$ 的“子”模型在更小的区域上精细化求解。针对以极端降水为特征的事件，使用聚合到 $5\\,\\mathrm{km}$ 尺度的观测数据进行检验。目标是量化父模型和子模型在极值分位数技巧上的差异，并解释子模型的附加价值。完全使用以下定义和测试数据以数学术语进行分析。\n\n定义：\n- 令 $\\tau \\in (0,1)$ 表示分位数水平。对于极值，取接近 $1$ 的 $\\tau$ (例如, $\\tau=0.98$)。\n- 对于一组 $n$ 个检验点，其观测降水强度为 $y_i$（单位 $\\mathrm{mm}/\\mathrm{h}$），模型的预测 $\\tau$-分位数为 $q_i$，定义分位数评分（QS），也称为弹球损失，为\n$$\n\\mathrm{QS}_\\tau(y,q) \\equiv \\frac{1}{n}\\sum_{i=1}^{n} \\left(\\tau - \\mathbb{I}\\{y_i  q_i\\}\\right)\\,(y_i - q_i),\n$$\n其中 $\\mathbb{I}\\{\\cdot\\}$ 是指示函数。\n- 给定一个共同的参考分位数预测器 $q_i^{\\mathrm{ref}}$（例如，气候学上的 $\\tau$-分位数）且 $\\mathrm{QS}_\\tau(y,q^{\\mathrm{ref}}) > 0$，为具有分位数预测 $q$ 的模型定义分位数技巧评分（QSS）为\n$$\n\\mathrm{QSS}_\\tau(y,q; q^{\\mathrm{ref}}) \\equiv 1 - \\frac{\\mathrm{QS}_\\tau(y,q)}{\\mathrm{QS}_\\tau(y,q^{\\mathrm{ref}})}.\n$$\n$\\mathrm{QSS}_\\tau$ 的值越高，表示相对于参考预报的技巧越好。\n- 定义技巧差异\n$$\n\\Delta \\mathrm{QSS}_\\tau \\equiv \\mathrm{QSS}_\\tau(y,q^{\\mathrm{child}}; q^{\\mathrm{ref}}) - \\mathrm{QSS}_\\tau(y,q^{\\mathrm{parent}}; q^{\\mathrm{ref}}),\n$$\n其中 $q^{\\mathrm{parent}}$ 和 $q^{\\mathrm{child}}$ 分别是父模型和子模型的 $\\tau$-分位数预测。正的 $\\Delta \\mathrm{QSS}_\\tau$ 表示相对于同一参考，子模型比父模型具有更高的技巧。\n- 为了解释附加价值，还需考虑子模型相对于父模型在分位数评分方面的分数改进：\n$$\n\\mathrm{AV}_\\tau \\equiv \\frac{\\mathrm{QS}_\\tau(y,q^{\\mathrm{parent}}) - \\mathrm{QS}_\\tau(y,q^{\\mathrm{child}})}{\\mathrm{QS}_\\tau(y,q^{\\mathrm{parent}})}.\n$$\n正的 $\\mathrm{AV}_\\tau$ 表示子模型带来了附加价值。\n\n使用以下测试套件，其中 $\\tau = 0.98$，降水强度单位为 $\\mathrm{mm}/\\mathrm{h}$：\n\n- 测试用例 1（包含干点和强降水点的常规极端事件）：\n  - 观测值 $y$：$[0, 12, 35, 0.5, 60, 80]$。\n  - 父模型 $\\tau$-分位数预测 $q^{\\mathrm{parent}}$：$[5, 20, 40, 5, 50, 70]$。\n  - 子模型 $\\tau$-分位数预测 $q^{\\mathrm{child}}$：$[3, 25, 45, 2, 55, 85]$。\n  - 参考 $\\tau$-分位数预测 $q^{\\mathrm{ref}}$：$[10, 10, 10, 10, 10, 10]$。\n\n- 测试用例 2（父模型和子模型预测相同的边界条件）：\n  - 观测值 $y$：$[10, 10, 10, 10]$。\n  - 父模型 $\\tau$-分位数预测 $q^{\\mathrm{parent}}$：$[12, 12, 12, 12]$。\n  - 子模型 $\\tau$-分位数预测 $q^{\\mathrm{child}}$：$[12, 12, 12, 12]$。\n  - 参考 $\\tau$-分位数预测 $q^{\\mathrm{ref}}$：$[15, 15, 15, 15]$。\n\n- 测试用例 3（结合干点和极端强降水的边缘案例）：\n  - 观测值 $y$：$[0, 0, 0, 40, 100]$。\n  - 父模型 $\\tau$-分位数预测 $q^{\\mathrm{parent}}$：$[5, 5, 5, 50, 90]$。\n  - 子模型 $\\tau$-分位数预测 $q^{\\mathrm{child}}$：$[1, 1, 1, 60, 110]$。\n  - 参考 $\\tau$-分位数预测 $q^{\\mathrm{ref}}$：$[8, 8, 8, 40, 100]$。\n\n要求：\n- 实现上述定义，为每个测试用例计算 $\\Delta \\mathrm{QSS}_\\tau$。\n- 所有降水值的单位都是 $\\mathrm{mm}/\\mathrm{h}$；输出是无量纲的技巧差异。\n- 你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表（例如，$[result_1,result_2,result_3]$），其中每个 $result_i$ 是测试用例 $i$ 的 $\\Delta \\mathrm{QSS}_\\tau$ 值，四舍五入到六位小数。",
            "solution": "我们从概率预报中 $\\tau$-分位数估计器的定义开始，该定义基于最小化期望弹球损失。对于给定的 $\\tau \\in (0,1)$ 和预测的 $\\tau$-分位数 $q_i$，单个观测值 $y_i$ 的弹球损失由以下函数定义\n$$\n\\ell_\\tau(y_i,q_i) = \\left(\\tau - \\mathbb{I}\\{y_i  q_i\\}\\right)\\,(y_i - q_i).\n$$\n该损失是非负的，因为当 $y_i \\ge q_i$ 时，该项为 $\\tau (y_i - q_i) \\ge 0$，而当 $y_i  q_i$ 时，它变为 $(1-\\tau)(q_i - y_i) \\ge 0$。对 $n$ 个检验点进行汇总，得到分位数评分（QS），\n$$\n\\mathrm{QS}_\\tau(y,q) = \\frac{1}{n}\\sum_{i=1}^{n} \\ell_\\tau(y_i,q_i) = \\frac{1}{n}\\sum_{i=1}^{n}\\left(\\tau - \\mathbb{I}\\{y_i  q_i\\}\\right)\\,(y_i - q_i).\n$$\n$\\mathrm{QS}_\\tau$ 的值越小越好，因为它表示更小的弹球损失。\n\n为了获得相对于固定参考预报 $q^{\\mathrm{ref}}$ 的技巧度量，我们定义分位数技巧评分（QSS）为\n$$\n\\mathrm{QSS}_\\tau(y,q; q^{\\mathrm{ref}}) = 1 - \\frac{\\mathrm{QS}_\\tau(y,q)}{\\mathrm{QS}_\\tau(y,q^{\\mathrm{ref}})}.\n$$\n这种构造类似于常规的技巧评分：如果 $\\mathrm{QS}_\\tau(y,q)$ 远小于 $\\mathrm{QS}_\\tau(y,q^{\\mathrm{ref}})$，则 $\\mathrm{QSS}_\\tau$ 接近 $1$；如果模型比参考预报差，则 $\\mathrm{QSS}_\\tau$ 变为负值。\n\n子模型和父模型之间的技巧差异为\n$$\n\\Delta \\mathrm{QSS}_\\tau = \\mathrm{QSS}_\\tau(y,q^{\\mathrm{child}}; q^{\\mathrm{ref}}) - \\mathrm{QSS}_\\tau(y,q^{\\mathrm{parent}}; q^{\\mathrm{ref}})\n= \\left(1 - \\frac{\\mathrm{QS}_\\tau(y,q^{\\mathrm{child}})}{\\mathrm{QS}_\\tau(y,q^{\\mathrm{ref}})}\\right) - \\left(1 - \\frac{\\mathrm{QS}_\\tau(y,q^{\\mathrm{parent}})}{\\mathrm{QS}_\\tau(y,q^{\\mathrm{ref}})}\\right),\n$$\n可简化为\n$$\n\\Delta \\mathrm{QSS}_\\tau = \\frac{\\mathrm{QS}_\\tau(y,q^{\\mathrm{parent}}) - \\mathrm{QS}_\\tau(y,q^{\\mathrm{child}})}{\\mathrm{QS}_\\tau(y,q^{\\mathrm{ref}})}.\n$$\n这表明 $\\Delta \\mathrm{QSS}_\\tau$ 的符号和大小取决于父模型和子模型之间弹球损失的差异，并由参考损失进行缩放。正的 $\\Delta \\mathrm{QSS}_\\tau$ 意味着子模型的弹球损失低于父模型，因此相对于同一参考预报具有更高的技巧。\n\n为了解释附加价值，我们还定义\n$$\n\\mathrm{AV}_\\tau = \\frac{\\mathrm{QS}_\\tau(y,q^{\\mathrm{parent}}) - \\mathrm{QS}_\\tau(y,q^{\\mathrm{child}})}{\\mathrm{QS}_\\tau(y,q^{\\mathrm{parent}})}.\n$$\n这是一个分数改进度量：$\\mathrm{AV}_\\tau > 0$ 表示子模型相对于父模型减少了损失，其大小表示父模型损失被消除的比例。\n\n算法步骤：\n1. 对所有测试用例，固定 $\\tau = 0.98$。\n2. 对每个测试用例，读取数组 $y$、$q^{\\mathrm{parent}}$、$q^{\\mathrm{child}}$ 和 $q^{\\mathrm{ref}}$。\n3. 通过 $\\ell_\\tau(y_i,q_i)$ 的公式并对所有点取平均，计算 $q \\in \\{q^{\\mathrm{parent}}, q^{\\mathrm{child}}, q^{\\mathrm{ref}}\\}$ 的 $\\mathrm{QS}_\\tau(y,q)$。\n4. 使用参考预报计算父模型和子模型的 $\\mathrm{QSS}_\\tau$。\n5. 计算子模型和父模型技巧的差值 $\\Delta \\mathrm{QSS}_\\tau$。\n6. 将每个 $\\Delta \\mathrm{QSS}_\\tau$ 四舍五入到六位小数，并按规定将三个结果输出到单个列表中。\n\n测试用例1的解析验证（以确认量级）：\n- 使用 $\\tau = 0.98$，计算每个点的弹球损失并取平均值，得到 $\\mathrm{QS}_\\tau(y,q^{\\mathrm{parent}}) \\approx 3.341667$，$\\mathrm{QS}_\\tau(y,q^{\\mathrm{child}}) \\approx 0.925000$，以及 $\\mathrm{QS}_\\tau(y,q^{\\mathrm{ref}}) \\approx 24.075000$。\n- 然后 $\\mathrm{QSS}_\\tau(y,q^{\\mathrm{parent}}; q^{\\mathrm{ref}}) \\approx 1 - 3.341667/24.075 \\approx 0.8613$，$\\mathrm{QSS}_\\tau(y,q^{\\mathrm{child}}; q^{\\mathrm{ref}}) \\approx 1 - 0.925/24.075 \\approx 0.9616$，得到 $\\Delta \\mathrm{QSS}_\\tau \\approx 0.1003 > 0$，表明子模型具有更高的技巧和正的附加价值。\n\n对于测试用例2，由于 $q^{\\mathrm{child}} = q^{\\mathrm{parent}}$，两个技巧评分相等，因此 $\\Delta \\mathrm{QSS}_\\tau = 0$，意味着没有附加价值。\n\n对于测试用例3，子模型相对于父模型显著减少了弹球损失，而参考预报对于强降水点异常地接近观测值，导致 $\\mathrm{QS}_\\tau(y,q^{\\mathrm{ref}})$ 很小，从而产生一个大的正值 $\\Delta \\mathrm{QSS}_\\tau$。这对应于子模型在表示极值方面具有强大的附加价值。\n\n程序实现了这些步骤以生成所需的输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef quantile_score(y: np.ndarray, q: np.ndarray, tau: float) - float:\n    \"\"\"\n    Compute the Quantile Score (pinball loss) for quantile level tau.\n    QS_tau(y,q) = mean( (tau - I[y  q]) * (y - q) )\n    \"\"\"\n    indicator = (y  q).astype(float)\n    loss = (tau - indicator) * (y - q)\n    return float(np.mean(loss))\n\ndef compute_delta_qss(y: np.ndarray, q_parent: np.ndarray, q_child: np.ndarray,\n                      q_ref: np.ndarray, tau: float) - float:\n    \"\"\"\n    Compute ΔQSS_tau = QSS_child - QSS_parent using a common reference.\n    \"\"\"\n    qs_parent = quantile_score(y, q_parent, tau)\n    qs_child = quantile_score(y, q_child, tau)\n    qs_ref = quantile_score(y, q_ref, tau)\n    # To avoid division by zero (should not occur with provided test cases),\n    # add a minimal epsilon safeguard if qs_ref is extremely small.\n    eps = 1e-12\n    denom = qs_ref if qs_ref > eps else eps\n    qss_parent = 1.0 - (qs_parent / denom)\n    qss_child = 1.0 - (qs_child / denom)\n    delta_qss = qss_child - qss_parent\n    return delta_qss\n\ndef solve():\n    tau = 0.98\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test Case 1\n        (\n            np.array([0.0, 12.0, 35.0, 0.5, 60.0, 80.0]),\n            np.array([5.0, 20.0, 40.0, 5.0, 50.0, 70.0]),\n            np.array([3.0, 25.0, 45.0, 2.0, 55.0, 85.0]),\n            np.array([10.0, 10.0, 10.0, 10.0, 10.0, 10.0]),\n        ),\n        # Test Case 2\n        (\n            np.array([10.0, 10.0, 10.0, 10.0]),\n            np.array([12.0, 12.0, 12.0, 12.0]),\n            np.array([12.0, 12.0, 12.0, 12.0]),\n            np.array([15.0, 15.0, 15.0, 15.0]),\n        ),\n        # Test Case 3\n        (\n            np.array([0.0, 0.0, 0.0, 40.0, 100.0]),\n            np.array([5.0, 5.0, 5.0, 50.0, 90.0]),\n            np.array([1.0, 1.0, 1.0, 60.0, 110.0]),\n            np.array([8.0, 8.0, 8.0, 40.0, 100.0]),\n        ),\n    ]\n\n    results = []\n    for (y, q_parent, q_child, q_ref) in test_cases:\n        delta_qss = compute_delta_qss(y, q_parent, q_child, q_ref, tau)\n        # Round to six decimal places as required\n        results.append(round(delta_qss, 6))\n\n    # Final print statement in the exact required format (no spaces).\n    print(\"[\" + \",\".join(f\"{r:.6f}\" for r in results) + \"]\")\n\nsolve()\n```"
        }
    ]
}