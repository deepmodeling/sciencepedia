{
    "hands_on_practices": [
        {
            "introduction": "Radiation boundary conditions are essential for allowing disturbances to exit a regional model domain without generating spurious reflections. The Orlanski condition is a classic and elegant approach that estimates the local phase speed directly from the evolving solution. This practice guides you through the fundamental derivation of this condition, bridging the gap from the continuous advection equation to a practical finite-difference implementation .",
            "id": "4059114",
            "problem": "Consider a one-dimensional limited-area regional model with outward normal coordinate $n \\geq 0$ and a lateral boundary at $n=0$. A passive scalar field $\\phi(n,t)$ is governed locally by the one-dimensional advection equation\n$$\n\\partial_{t}\\phi + u(n,t)\\,\\partial_{n}\\phi = 0,\n$$\nwhere $u(n,t)$ is the true advective velocity that can vary in space and time. At the lateral boundary, the goal is to impose a non-reflecting closure that allows disturbances with locally estimated phase speed to radiate out of the computational domain. The Orlanski radiation boundary condition is a data-driven closure that enforces the boundary-normal propagation relation\n$$\n\\partial_{t}\\phi + c_{b}(t)\\,\\partial_{n}\\phi = 0 \\quad \\text{at} \\quad n=0,\n$$\nwhere $c_{b}(t)$ is a single boundary-normal phase speed to be estimated at each time based on the local behavior of $\\phi$.\n\nStarting from the fundamental base of characteristic propagation for linear advection and the definition of phase speed for locally planar disturbances, derive the Orlanski radiation boundary condition by expressing the boundary-normal phase speed estimate $c_{b}(t)$ in terms of $\\partial_{t}\\phi$ and $\\partial_{n}\\phi$ evaluated at the boundary. Then, for a first-order finite-difference implementation, consider the following discrete configuration:\n\n- Spatial grid points $i=0$ at the boundary ($n=0$) and $i=1$ as the first interior point ($n=\\Delta x$), with uniform grid spacing $\\Delta x>0$.\n- Time levels $t^{m}=m\\,\\Delta t$ for integers $m$, with uniform time step $\\Delta t>0$.\n- Known boundary and interior values $\\phi_{0}^{n}$, $\\phi_{0}^{n-1}$, $\\phi_{1}^{n}$ at times $t^{n}$ and $t^{n-1}$, and the newly advanced interior value $\\phi_{1}^{n+1}$ at $t^{n+1}$.\n- A one-sided first-order spatial difference for the boundary-normal derivative,\n$$\n\\left.\\partial_{n}\\phi\\right|_{n=0,t=t^{m}} \\approx \\frac{\\phi_{1}^{m}-\\phi_{0}^{m}}{\\Delta x},\n$$\nand a first-order backward difference for the time derivative at the boundary,\n$$\n\\left.\\partial_{t}\\phi\\right|_{n=0,t=t^{n}} \\approx \\frac{\\phi_{0}^{n}-\\phi_{0}^{n-1}}{\\Delta t}.\n$$\n\nAssume that the boundary-normal phase speed used to advance from $t^{n}$ to $t^{n+1}$ is the local estimate computed at $t^{n}$, and enforce the Orlanski radiation boundary condition at $t^{n+1}$ using the same first-order spatial difference at that time level. Under these assumptions, derive a closed-form analytic expression for the updated boundary value $\\phi_{0}^{n+1}$ in terms of the given discrete quantities $\\phi_{0}^{n}$, $\\phi_{0}^{n-1}$, $\\phi_{1}^{n}$, $\\phi_{1}^{n+1}$, $\\Delta x$, and $\\Delta t$.\n\nYour final answer must be a single closed-form symbolic expression for $\\phi_{0}^{n+1}$. No rounding is required. Express the final answer without units and do not include any inequalities or equations in the final answer. Clearly define any intermediate symbols you introduce in your derivation within your solution.",
            "solution": "The problem requires a two-part derivation concerning the Orlanski radiation boundary condition for a one-dimensional advection equation. First, we derive the expression for the estimated phase speed from fundamental principles. Second, we use a specified finite-difference scheme to derive a closed-form expression for the updated boundary value of the scalar field.\n\nThe governing equation for the passive scalar field $\\phi(n,t)$ is the one-dimensional advection equation:\n$$\n\\partial_{t}\\phi + u(n,t)\\,\\partial_{n}\\phi = 0\n$$\nThe Orlanski radiation boundary condition is designed to allow wave-like disturbances to propagate out of the domain. It models the behavior at the boundary $n=0$ by assuming the field locally satisfies a simple wave equation:\n$$\n\\partial_{t}\\phi + c_{b}(t)\\,\\partial_{n}\\phi = 0 \\quad \\text{at} \\quad n=0\n$$\nwhere $c_{b}(t)$ is the phase speed of the disturbance at the boundary. This form is motivated by considering locally planar waves of the form $\\phi \\approx f(n-ct)$, for which $\\partial_t \\phi = -c f'$ and $\\partial_n \\phi = f'$. The ratio of these derivatives gives the phase speed $c = -\\frac{\\partial_t \\phi}{\\partial_n \\phi}$.\n\nFollowing this principle, the Orlanski condition determines the phase speed $c_b(t)$ by evaluating this ratio at the boundary itself. By rearranging the boundary condition equation, we obtain the expression for the boundary-normal phase speed estimate:\n$$\nc_{b}(t) = - \\frac{\\left.\\partial_{t}\\phi\\right|_{n=0}}{\\left.\\partial_{n}\\phi\\right|_{n=0}}\n$$\nThis completes the first part of the derivation as requested.\n\nFor the second part, we use a discrete implementation to find an expression for the new boundary value $\\phi_{0}^{n+1}$. The process is as follows:\n\n1.  **Estimate the phase speed at time $t^n$**: The problem states that the phase speed for the update is computed at time $t=t^n$. Let's denote this estimated speed as $c_{b}^{n}$. We use the provided finite-difference approximations for the derivatives at $t^n$:\n    $$\n    \\left.\\partial_{t}\\phi\\right|_{n=0,t=t^{n}} \\approx \\frac{\\phi_{0}^{n}-\\phi_{0}^{n-1}}{\\Delta t}\n    $$\n    $$\n    \\left.\\partial_{n}\\phi\\right|_{n=0,t=t^{n}} \\approx \\frac{\\phi_{1}^{n}-\\phi_{0}^{n}}{\\Delta x}\n    $$\n    Substituting these into the expression for the phase speed, we get the discrete estimate:\n    $$\n    c_{b}^{n} = - \\frac{(\\phi_{0}^{n}-\\phi_{0}^{n-1})/\\Delta t}{(\\phi_{1}^{n}-\\phi_{0}^{n})/\\Delta x} = - \\frac{\\Delta x}{\\Delta t} \\frac{\\phi_{0}^{n}-\\phi_{0}^{n-1}}{\\phi_{1}^{n}-\\phi_{0}^{n}}\n    $$\n\n2.  **Enforce the boundary condition at time $t^{n+1}$**: We apply the Orlanski condition at the new time level $t^{n+1}$ using the phase speed $c_{b}^{n}$ computed at the previous time level:\n    $$\n    \\left.\\partial_{t}\\phi\\right|_{n=0,t=t^{n+1}} + c_{b}^{n} \\left.\\partial_{n}\\phi\\right|_{n=0,t=t^{n+1}} = 0\n    $$\n    We discretize the derivatives at $t=t^{n+1}$. For the spatial derivative, we use the specified first-order one-sided difference. For the time derivative, we use a first-order backward difference, which is consistent with the scheme given for $t^n$ and allows for solving for $\\phi_0^{n+1}$ implicitly.\n    $$\n    \\left.\\partial_{t}\\phi\\right|_{n=0,t=t^{n+1}} \\approx \\frac{\\phi_{0}^{n+1}-\\phi_{0}^{n}}{\\Delta t}\n    $$\n    $$\n    \\left.\\partial_{n}\\phi\\right|_{n=0,t=t^{n+1}} \\approx \\frac{\\phi_{1}^{n+1}-\\phi_{0}^{n+1}}{\\Delta x}\n    $$\n    Substituting these into the boundary condition equation gives:\n    $$\n    \\frac{\\phi_{0}^{n+1}-\\phi_{0}^{n}}{\\Delta t} + c_{b}^{n} \\left( \\frac{\\phi_{1}^{n+1}-\\phi_{0}^{n+1}}{\\Delta x} \\right) = 0\n    $$\n\n3.  **Solve for $\\phi_{0}^{n+1}$**: We now algebraically solve this equation for $\\phi_{0}^{n+1}$. First, we rearrange the terms to group those containing $\\phi_{0}^{n+1}$:\n    $$\n    \\phi_{0}^{n+1} \\left( \\frac{1}{\\Delta t} - \\frac{c_{b}^{n}}{\\Delta x} \\right) = \\frac{\\phi_{0}^{n}}{\\Delta t} - \\frac{c_{b}^{n}\\phi_{1}^{n+1}}{\\Delta x}\n    $$\n    To eliminate the denominators, we multiply the entire equation by $\\Delta t \\Delta x$:\n    $$\n    \\phi_{0}^{n+1} (\\Delta x - c_{b}^{n} \\Delta t) = \\Delta x \\phi_{0}^{n} - c_{b}^{n} \\Delta t \\phi_{1}^{n+1}\n    $$\n    Isolating $\\phi_{0}^{n+1}$ yields:\n    $$\n    \\phi_{0}^{n+1} = \\frac{\\Delta x \\phi_{0}^{n} - c_{b}^{n} \\Delta t \\phi_{1}^{n+1}}{\\Delta x - c_{b}^{n} \\Delta t}\n    $$\n\n4.  **Substitute the expression for $c_{b}^{n}$**: Finally, we substitute the previously derived discrete expression for $c_{b}^{n}$ into this equation.\n    $$\n    \\phi_{0}^{n+1} = \\frac{\\Delta x \\phi_{0}^{n} - \\left(- \\frac{\\Delta x}{\\Delta t} \\frac{\\phi_{0}^{n}-\\phi_{0}^{n-1}}{\\phi_{1}^{n}-\\phi_{0}^{n}}\\right) \\Delta t \\phi_{1}^{n+1}}{\\Delta x - \\left(- \\frac{\\Delta x}{\\Delta t} \\frac{\\phi_{0}^{n}-\\phi_{0}^{n-1}}{\\phi_{1}^{n}-\\phi_{0}^{n}}\\right) \\Delta t}\n    $$\n    The terms $\\Delta t$ in the numerator and denominator cancel out:\n    $$\n    \\phi_{0}^{n+1} = \\frac{\\Delta x \\phi_{0}^{n} + \\Delta x \\left(\\frac{\\phi_{0}^{n}-\\phi_{0}^{n-1}}{\\phi_{1}^{n}-\\phi_{0}^{n}}\\right) \\phi_{1}^{n+1}}{\\Delta x + \\Delta x \\left(\\frac{\\phi_{0}^{n}-\\phi_{0}^{n-1}}{\\phi_{1}^{n}-\\phi_{0}^{n}}\\right)}\n    $$\n    We can factor out $\\Delta x$ from the numerator and denominator, which then cancels:\n    $$\n    \\phi_{0}^{n+1} = \\frac{\\phi_{0}^{n} + \\frac{(\\phi_{0}^{n}-\\phi_{0}^{n-1})\\phi_{1}^{n+1}}{\\phi_{1}^{n}-\\phi_{0}^{n}}}{1 + \\frac{\\phi_{0}^{n}-\\phi_{0}^{n-1}}{\\phi_{1}^{n}-\\phi_{0}^{n}}}\n    $$\n    To simplify this complex fraction, we multiply the numerator and denominator by $(\\phi_{1}^{n}-\\phi_{0}^{n})$:\n    $$\n    \\phi_{0}^{n+1} = \\frac{\\phi_{0}^{n}(\\phi_{1}^{n}-\\phi_{0}^{n}) + (\\phi_{0}^{n}-\\phi_{0}^{n-1})\\phi_{1}^{n+1}}{(\\phi_{1}^{n}-\\phi_{0}^{n}) + (\\phi_{0}^{n}-\\phi_{0}^{n-1})}\n    $$\n    Simplifying the denominator gives the final closed-form expression for the updated boundary value:\n    $$\n    \\phi_{0}^{n+1} = \\frac{\\phi_{0}^{n}(\\phi_{1}^{n}-\\phi_{0}^{n}) + (\\phi_{0}^{n}-\\phi_{0}^{n-1})\\phi_{1}^{n+1}}{\\phi_{1}^{n}-\\phi_{0}^{n-1}}\n    $$\n    This expression provides the value of $\\phi$ at the boundary at time $t^{n+1}$ in terms of the known values $\\phi_{0}^{n}$, $\\phi_{0}^{n-1}$, $\\phi_{1}^{n}$, and $\\phi_{1}^{n+1}$.",
            "answer": "$$\n\\boxed{\\frac{\\phi_{0}^{n}(\\phi_{1}^{n}-\\phi_{0}^{n}) + (\\phi_{0}^{n}-\\phi_{0}^{n-1})\\phi_{1}^{n+1}}{\\phi_{1}^{n}-\\phi_{0}^{n-1}}}\n$$"
        },
        {
            "introduction": "Regional models are driven by data from global models, which are available only at discrete time intervals. This practice explores the consequences of this temporal discretization by examining how linear interpolation of boundary conditions affects a propagating front . By applying the method of characteristics, you will quantify the positional error of the front, directly linking the lateral boundary condition update frequency to forecast accuracy.",
            "id": "4059159",
            "problem": "Consider a one-dimensional regional limited-area model with an open western lateral boundary at position $x=0$, driven by a coarse-resolution external model that provides lateral boundary conditions (LBCs) at discrete update times $t_k = k \\,\\Delta T$ for integer $k$. The regional model applies linear temporal interpolation of the LBCs between successive updates. A sharp frontal discontinuity in a passive scalar of amplitude $A$ enters the domain at the boundary and propagates eastward at a constant phase speed $v>0$, governed by the linear advection equation $\\partial_t \\phi + v \\,\\partial_x \\phi = 0$. Assume negligible internal numerical diffusion and reflection so that the interior solution is solely determined by advection of the boundary signal along characteristics.\n\nLet the true boundary signal at $x=0$ be a step function in time: $\\phi(0,t)=A\\,H(t-t_0)$, where $H$ is the Heaviside function and $t_0 \\in (t_k, t_{k+1})$ is the unknown true front arrival time at the boundary. The regional model, using linear temporal interpolation of $\\phi(0,t)$ between $t_k$ and $t_{k+1}$ based on the coarse updates, represents $\\phi(0,t)$ over that interval as a linear ramp from $0$ to $A$.\n\nDefine the instantaneous front position at any time $t$ as the unique position $x_f(t)$ where $\\phi(x_f(t),t)=A/2$. Let the forecast horizon be $T=24\\,\\mathrm{h}$. For a given LBC update interval $\\Delta T$, the linear temporal interpolation of the step at the boundary induces a timing error in the $A/2$ crossing at $x=0$, which then propagates into the interior via advection.\n\nUsing only the advection equation, the method of characteristics, and the definition of the front position via the $A/2$ isovalue, derive the worst-case (over $t_0 \\in (t_k,t_{k+1})$) absolute front-position error at time $T$ as a function of $v$ and $\\Delta T$, and show how it depends on $T$. Then specialize to the two LBC update intervals $\\Delta T_1=3\\,\\mathrm{h}$ and $\\Delta T_2=1\\,\\mathrm{h}$, and determine the increase in the worst-case front-position error at time $T=24\\,\\mathrm{h}$ when using $\\Delta T_1$ instead of $\\Delta T_2$.\n\nExpress your final answer as a single closed-form analytic expression in terms of $v$ and in units of kilometers, assuming that $v$ is provided in $\\mathrm{m}\\,\\mathrm{s}^{-1}$. Do not round your answer.",
            "solution": "The governing equation for the passive scalar $\\phi$ is the one-dimensional linear advection equation:\n$$\n\\frac{\\partial \\phi}{\\partial t} + v \\frac{\\partial \\phi}{\\partial x} = 0\n$$\nwhere $v > 0$ is the constant phase speed.\n\nWe solve this partial differential equation using the method of characteristics. The characteristic curves are defined by $\\frac{dx}{dt} = v$. Integrating this gives the characteristic lines $x - vt = C$, where $C$ is a constant. Along these lines, $\\phi$ is constant. This implies that the solution at any point $(x, t)$ is determined by the value of $\\phi$ at the western boundary ($x=0$) at an earlier time $t' = t - x/v$. The general solution is therefore:\n$$\n\\phi(x,t) = \\phi(0, t - x/v)\n$$\nThis relationship states that any signal introduced at the boundary $x=0$ propagates into the domain at speed $v$ without changing its shape, under the ideal conditions specified (no numerical diffusion or reflection).\n\nThe true physical process involves a sharp front arriving at the boundary at time $t_0$. This is represented by the boundary condition:\n$$\n\\phi_{\\text{true}}(0,t) = A H(t-t_0)\n$$\nwhere $H$ is the Heaviside step function and $t_0 \\in (t_k, t_{k+1})$. The true solution in the domain is found by substituting this into the general solution:\n$$\n\\phi_{\\text{true}}(x,t) = A H(t - x/v - t_0)\n$$\nThe instantaneous front position, $x_{f,\\text{true}}(t)$, is defined as the location where $\\phi = A/2$. For a sharp step function, this corresponds to the location of the discontinuity itself. We find this by setting the argument of the Heaviside function to zero:\n$$\nt - \\frac{x_{f,\\text{true}}(t)}{v} - t_0 = 0\n$$\nSolving for the true front position gives:\n$$\nx_{f,\\text{true}}(t) = v(t - t_0)\n$$\nThis equation shows that the true front propagates linearly with time from its initial arrival time $t_0$ at the boundary.\n\nThe regional model does not have access to the continuous function $\\phi_{\\text{true}}(0,t)$. Instead, it samples the boundary state at discrete times $t_k = k \\Delta T$. Because the true front arrives at $t_0 \\in (t_k, t_{k+1})$, the coarse model provides the values $\\phi(0, t_k) = 0$ and $\\phi(0, t_{k+1}) = A$. The regional model then applies linear temporal interpolation between these two points. For $t \\in [t_k, t_{k+1}]$, the modeled boundary condition, $\\phi_{\\text{model}}(0,t)$, is given by the line connecting $(t_k, 0)$ and $(t_{k+1}, A)$:\n$$\n\\phi_{\\text{model}}(0,t) = 0 + \\frac{A - 0}{t_{k+1} - t_k} (t - t_k) = \\frac{A}{\\Delta T}(t - t_k)\n$$\nThe modeled solution in the interior is obtained by advecting this boundary signal:\n$$\n\\phi_{\\text{model}}(x,t) = \\phi_{\\text{model}}(0, t - x/v) = \\frac{A}{\\Delta T}\\left(t - \\frac{x}{v} - t_k\\right)\n$$\nThis is valid for times and positions where the argument of the boundary function, $t - x/v$, falls within the interpolation interval $[t_k, t_{k+1}]$.\n\nThe modeled front position, $x_{f,\\text{model}}(t)$, is where $\\phi_{\\text{model}} = A/2$:\n$$\n\\frac{A}{2} = \\frac{A}{\\Delta T}\\left(t - \\frac{x_{f,\\text{model}}(t)}{v} - t_k\\right)\n$$\nSolving for $x_{f,\\text{model}}(t)$:\n$$\n\\frac{\\Delta T}{2} = t - \\frac{x_{f,\\text{model}}(t)}{v} - t_k\n$$\n$$\n\\frac{x_{f,\\text{model}}(t)}{v} = t - t_k - \\frac{\\Delta T}{2}\n$$\n$$\nx_{f,\\text{model}}(t) = v\\left(t - t_k - \\frac{\\Delta T}{2}\\right)\n$$\nThis shows that the model effectively treats the front as if it arrived at the boundary at time $t_k + \\Delta T / 2$, the midpoint of the LBC update interval.\n\nThe front-position error at time $t$ is the difference between the modeled and true front positions:\n$$\n\\epsilon(t) = x_{f,\\text{model}}(t) - x_{f,\\text{true}}(t)\n$$\n$$\n\\epsilon(t) = v\\left(t - t_k - \\frac{\\Delta T}{2}\\right) - v(t - t_0) = v\\left(t_0 - t_k - \\frac{\\Delta T}{2}\\right)\n$$\nThe error $\\epsilon$ is independent of the forecast time $t$ and depends only on the phase speed $v$, the LBC update interval $\\Delta T$, and the true arrival time $t_0$ relative to the start of the interval $t_k$.\n\nWe are asked to find the worst-case (maximum absolute) front-position error. This corresponds to maximizing $|\\epsilon|$ with respect to the unknown true arrival time $t_0 \\in (t_k, t_{k+1})$.\n$$\n|\\epsilon|_{\\text{max}} = \\max_{t_0 \\in (t_k, t_{k+1})} \\left|v\\left(t_0 - t_k - \\frac{\\Delta T}{2}\\right)\\right| = v \\cdot \\max_{t_0 \\in (t_k, t_k+\\Delta T)} \\left|t_0 - \\left(t_k + \\frac{\\Delta T}{2}\\right)\\right|\n$$\nThe term $|t_0 - (t_k + \\Delta T/2)|$ represents the deviation of the true arrival time from the midpoint of the interval. This deviation is maximized when $t_0$ is near the endpoints of the interval, $t_k$ or $t_{k+1} = t_k + \\Delta T$.\nAs $t_0 \\to t_k$, the term approaches $|t_k - (t_k + \\Delta T/2)| = |-\\Delta T/2| = \\Delta T/2$.\nAs $t_0 \\to t_{k+1}$, the term approaches $|t_{k+1} - (t_k + \\Delta T/2)| = |(t_k+\\Delta T) - (t_k + \\Delta T/2)| = |\\Delta T/2| = \\Delta T/2$.\nThus, the worst-case absolute position error is:\n$$\n|\\epsilon|_{\\text{max}} = v \\frac{\\Delta T}{2}\n$$\nThis error is independent of the forecast horizon $T$.\n\nNow, we specialize to the two given LBC update intervals, $\\Delta T_1 = 3\\,\\mathrm{h}$ and $\\Delta T_2 = 1\\,\\mathrm{h}$.\nThe worst-case error for $\\Delta T_1$ is $E_1 = v \\frac{\\Delta T_1}{2}$.\nThe worst-case error for $\\Delta T_2$ is $E_2 = v \\frac{\\Delta T_2}{2}$.\n\nThe problem asks for the increase in the worst-case front-position error when using $\\Delta T_1$ instead of $\\Delta T_2$. This is the difference $E_1 - E_2$:\n$$\n\\text{Increase in error} = E_1 - E_2 = v \\frac{\\Delta T_1}{2} - v \\frac{\\Delta T_2}{2} = \\frac{v}{2}(\\Delta T_1 - \\Delta T_2)\n$$\nWe are given $\\Delta T_1 = 3\\,\\mathrm{h}$ and $\\Delta T_2 = 1\\,\\mathrm{h}$. Therefore, $\\Delta T_1 - \\Delta T_2 = 2\\,\\mathrm{h}$.\n$$\n\\text{Increase in error} = \\frac{v}{2}(2\\,\\mathrm{h}) = v \\cdot (1\\,\\mathrm{h})\n$$\nTo express the answer in kilometers, with $v$ in units of $\\mathrm{m}\\,\\mathrm{s}^{-1}$, we must perform unit conversions.\n$$\n1\\,\\mathrm{h} = 60\\,\\mathrm{min/h} \\times 60\\,\\mathrm{s/min} = 3600\\,\\mathrm{s}\n$$\nThe increase in error, in meters, is:\n$$\n\\text{Increase in error [m]} = v \\,[\\mathrm{m}\\,\\mathrm{s}^{-1}] \\times 3600 \\,[\\mathrm{s}] = 3600 v \\,[\\mathrm{m}]\n$$\nTo convert from meters to kilometers, we divide by $1000$:\n$$\n\\text{Increase in error [km]} = \\frac{3600 v}{1000} = 3.6 v \\,[\\mathrm{km}]\n$$\nThis is the final analytical expression for the increase in the worst-case front-position error.",
            "answer": "$$\n\\boxed{3.6 v}\n$$"
        },
        {
            "introduction": "An ideal lateral boundary condition should be perfectly transparent to outgoing waves, but small implementation errors can lead to non-physical reflections that contaminate the model solution. This exercise investigates the performance of a radiation boundary condition where the assumed wave speed contains an error, a common practical issue . By deriving the complex reflection coefficient for an incident gravity wave, you will gain a quantitative understanding of how such imperfections generate spurious signals.",
            "id": "4059131",
            "problem": "Consider a one-dimensional lateral boundary of a regional atmospheric model in Numerical Weather Prediction (NWP) and climate modeling, where linearized shallow-water gravity waves propagate with phase speed $c = \\sqrt{g H}$ and satisfy the non-dispersive dispersion relation $\\omega = c k$, with $g$ denoting gravitational acceleration, $H$ the mean fluid depth, $k$ the wavenumber, and $\\omega$ the angular frequency. At the modelâ€™s left boundary located at $x=0$, the intended open (radiation) boundary condition is implemented in the usual Sommerfeld form for outbound left-going waves, but with a phase speed error: the boundary operator uses $c_{b} = c + \\delta c$ instead of the true $c$, resulting in an imperfect radiation condition. Let a monochromatic, left-going, plane gravity wave be incident upon the boundary from the interior (domain $x>0$). The total field near the boundary is the superposition of the incident left-going wave and a reflected right-going wave.\n\nStarting from the linearized shallow-water wave kinematics and the standard radiation boundary operator for left-going waves at $x=0$, namely $(\\partial_{t} - c_{b}\\,\\partial_{x})$ applied to the prognostic field at the boundary, derive the complex reflection coefficient $R$ defined as the ratio of the reflected-wave amplitude to the incident-wave amplitude, expressed as a function of $\\delta c$, $k$, and $c$. Then, quantitatively assess the sensitivity of $R$ to the phase speed error by computing the first derivative $\\partial R / \\partial(\\delta c)$ evaluated at $\\delta c = 0$.\n\nProvide your final answer as a row vector containing two closed-form analytic expressions: the reflection coefficient $R(\\delta c,k,c)$ and the sensitivity $\\left.\\frac{\\partial R}{\\partial(\\delta c)}\\right|_{\\delta c=0}$. No numerical evaluation is required. The reflection coefficient is dimensionless, and the sensitivity has dimensions of inverse speed. Do not include physical units in your final answer. If a numerical approximation is produced, round it to four significant figures; otherwise, provide exact expressions.",
            "solution": "Let the prognostic field variable, such as the free-surface elevation in the shallow-water system, be denoted by $\\eta(x,t)$. The problem states that a monochromatic, left-going plane wave is incident upon the boundary at $x=0$ from the domain interior, which is $x>0$. A wave propagating in the negative $x$-direction (left-going) with angular frequency $\\omega$ and wavenumber $k$ can be represented in complex exponential form as:\n$$ \\eta_I(x,t) = A_I \\exp\\left[i(kx + \\omega t)\\right] $$\nHere, $A_I$ is the complex amplitude of the incident wave. The dispersion relation is given as $\\omega = ck$, where $c$ is the true phase speed. The phase velocity of this wave is $v_p = -\\omega/k = -c$, confirming it is left-going.\n\nUpon encountering the imperfect boundary at $x=0$, a portion of this wave is reflected. The reflected wave must propagate away from the boundary back into the domain, i.e., in the positive $x$-direction (right-going). This wave will have the same frequency $\\omega$ and wavenumber magnitude $k$ because the medium is linear, homogeneous, and time-invariant. The form of the reflected wave is:\n$$ \\eta_R(x,t) = A_R \\exp\\left[i(-kx + \\omega t)\\right] $$\nHere, $A_R$ is the complex amplitude of the reflected wave. The phase velocity is $v_p = \\omega/k = c$, confirming it is right-going.\n\nThe total field $\\eta(x,t)$ in the vicinity of the boundary is the linear superposition of the incident and reflected waves:\n$$ \\eta(x,t) = \\eta_I(x,t) + \\eta_R(x,t) = A_I \\exp\\left[i(kx + \\omega t)\\right] + A_R \\exp\\left[i(-kx + \\omega t)\\right] $$\n\nThe radiation boundary condition is applied at $x=0$. The operator is given as $(\\partial_{t} - c_{b}\\,\\partial_{x})$, where $c_b = c + \\delta c$ is the erroneous phase speed used in the boundary condition implementation. The condition is:\n$$ \\left. \\left( \\frac{\\partial}{\\partial t} - c_b \\frac{\\partial}{\\partial x} \\right) \\eta(x,t) \\right|_{x=0} = 0 $$\nTo apply this condition, we first compute the partial derivatives of the total field $\\eta(x,t)$:\n$$ \\frac{\\partial \\eta}{\\partial t} = i\\omega A_I \\exp\\left[i(kx + \\omega t)\\right] + i\\omega A_R \\exp\\left[i(-kx + \\omega t)\\right] $$\n$$ \\frac{\\partial \\eta}{\\partial x} = ik A_I \\exp\\left[i(kx + \\omega t)\\right] - ik A_R \\exp\\left[i(-kx + \\omega t)\\right] $$\nNow, we evaluate these derivatives at the boundary $x=0$:\n$$ \\left. \\frac{\\partial \\eta}{\\partial t} \\right|_{x=0} = i\\omega (A_I + A_R) \\exp(i\\omega t) $$\n$$ \\left. \\frac{\\partial \\eta}{\\partial x} \\right|_{x=0} = ik (A_I - A_R) \\exp(i\\omega t) $$\nSubstituting these expressions into the boundary condition equation gives:\n$$ i\\omega (A_I + A_R) \\exp(i\\omega t) - c_b \\left[ ik (A_I - A_R) \\exp(i\\omega t) \\right] = 0 $$\nThe common factor $i \\exp(i\\omega t)$ is non-zero and can be canceled:\n$$ \\omega (A_I + A_R) - c_b k (A_I - A_R) = 0 $$\nOur goal is to find the complex reflection coefficient $R$, defined as $R = A_R / A_I$. We rearrange the equation to solve for this ratio:\n$$ \\omega A_I + \\omega A_R - c_b k A_I + c_b k A_R = 0 $$\n$$ A_R (\\omega + c_b k) = A_I (c_b k - \\omega) $$\n$$ R = \\frac{A_R}{A_I} = \\frac{c_b k - \\omega}{\\omega + c_b k} $$\nNow, we substitute the given relations $\\omega = ck$ and $c_b = c + \\delta c$:\n$$ R = \\frac{(c + \\delta c) k - ck}{ck + (c + \\delta c) k} $$\n$$ R = \\frac{ck + k \\delta c - ck}{ck + ck + k \\delta c} $$\n$$ R = \\frac{k \\delta c}{2ck + k \\delta c} $$\nSince $k$ is the wavenumber of a physical wave, $k \\neq 0$, and we can cancel it from the numerator and denominator. This yields the first requested expression, the reflection coefficient $R$ as a function of $\\delta c$ and $c$:\n$$ R(\\delta c,c) = \\frac{\\delta c}{2c + \\delta c} $$\nNote that for a perfect boundary condition, $\\delta c = 0$, which gives $R=0$ (no reflection), as expected.\n\nThe second part of the task is to assess the sensitivity of $R$ to the phase speed error $\\delta c$ by computing the first derivative $\\partial R / \\partial(\\delta c)$ and evaluating it at the point of no error, $\\delta c = 0$. We differentiate $R$ with respect to $\\delta c$, treating $c$ as a constant. Using the quotient rule for derivatives, $\\frac{d}{dx}(\\frac{u}{v}) = \\frac{u'v - uv'}{v^2}$, with $u = \\delta c$ and $v = 2c + \\delta c$:\n$$ \\frac{\\partial R}{\\partial(\\delta c)} = \\frac{\\frac{\\partial}{\\partial(\\delta c)}(\\delta c) \\cdot (2c + \\delta c) - (\\delta c) \\cdot \\frac{\\partial}{\\partial(\\delta c)}(2c + \\delta c)}{(2c + \\delta c)^2} $$\n$$ \\frac{\\partial R}{\\partial(\\delta c)} = \\frac{1 \\cdot (2c + \\delta c) - \\delta c \\cdot 1}{(2c + \\delta c)^2} $$\n$$ \\frac{\\partial R}{\\partial(\\delta c)} = \\frac{2c + \\delta c - \\delta c}{(2c + \\delta c)^2} = \\frac{2c}{(2c + \\delta c)^2} $$\nNow, we evaluate this derivative at $\\delta c = 0$:\n$$ \\left. \\frac{\\partial R}{\\partial(\\delta c)} \\right|_{\\delta c=0} = \\frac{2c}{(2c + 0)^2} = \\frac{2c}{(2c)^2} = \\frac{2c}{4c^2} = \\frac{1}{2c} $$\nThis expression represents the first-order sensitivity of the reflection coefficient to small errors in the boundary phase speed. This is the second requested expression.\n\nThe final answer is a row vector containing the two derived expressions.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\delta c}{2c + \\delta c} & \\frac{1}{2c}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}