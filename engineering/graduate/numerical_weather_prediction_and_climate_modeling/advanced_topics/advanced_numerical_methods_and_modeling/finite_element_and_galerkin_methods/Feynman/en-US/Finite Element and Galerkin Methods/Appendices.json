{
    "hands_on_practices": [
        {
            "introduction": "To accurately model atmospheric or oceanic flows, we must map our idealized computational elements onto complex, curved, or distorted physical domains. The isoparametric finite element method provides an elegant way to do this by using the same set of basis functions—the shape functions—to both describe the element's geometry and approximate the solution field within it. This exercise walks you through the fundamental mechanics of this mapping for a quadrilateral element, culminating in the calculation of the Jacobian determinant, a crucial quantity that relates integrals in the physical domain back to the simple reference domain.",
            "id": "4042751",
            "problem": "Consider a horizontally oriented isoparametric quadrilateral spectral element of polynomial degree $p=3$ used in a limited-area Numerical Weather Prediction (NWP) model to discretize the shallow-water equations on a locally planar Earth patch. The reference element is the square $\\{(\\xi,\\eta) \\in \\mathbb{R}^{2} : -1 \\le \\xi \\le 1, -1 \\le \\eta \\le 1\\}$. Let the interpolation (nodal) points in each parametric coordinate be the four equispaced locations $\\xi_{1}=-1$, $\\xi_{2}=-\\frac{1}{3}$, $\\xi_{3}=\\frac{1}{3}$, $\\xi_{4}=1$, and similarly $\\eta_{1}=-1$, $\\eta_{2}=-\\frac{1}{3}$, $\\eta_{3}=\\frac{1}{3}$, $\\eta_{4}=1$. Define the one-dimensional cubic Lagrange basis functions $\\{ \\ell_{i}(\\xi) \\}_{i=1}^{4}$ by the fundamental Lagrange interpolation definition over the set $\\{-1,-\\frac{1}{3},\\frac{1}{3},1\\}$, and similarly $\\{ \\ell_{j}(\\eta) \\}_{j=1}^{4}$ over $\\{-1,-\\frac{1}{3},\\frac{1}{3},1\\}$.\n\nThe two-dimensional shape functions for the isoparametric element are $\\{ \\phi_{ij}(\\xi,\\eta) \\}_{i,j=1}^{4}$ defined as tensor products $\\phi_{ij}(\\xi,\\eta) = \\ell_{i}(\\xi)\\,\\ell_{j}(\\eta)$. The isoparametric mapping from the reference element to physical coordinates $\\mathbf{x}(\\xi,\\eta) = (x(\\xi,\\eta),y(\\xi,\\eta))$ is defined by\n$$\nx(\\xi,\\eta) = \\sum_{i=1}^{4}\\sum_{j=1}^{4} \\phi_{ij}(\\xi,\\eta)\\,x_{ij}, \\qquad\ny(\\xi,\\eta) = \\sum_{i=1}^{4}\\sum_{j=1}^{4} \\phi_{ij}(\\xi,\\eta)\\,y_{ij},\n$$\nwhere the physical nodal coordinates are assigned by\n$$\nx_{ij} = \\frac{L_{x}}{2}\\left(\\xi_{i}+1\\right), \\qquad y_{ij} = \\frac{L_{y}}{2}\\left(\\eta_{j}+1\\right),\n$$\nwith $L_{x}=250$ (kilometers) and $L_{y}=300$ (kilometers), representing a rectangular atmospheric element of size $250 \\times 300$ kilometers aligned with the coordinate axes.\n\nUsing these definitions:\n- Write the explicit one-dimensional basis functions $\\ell_{i}(\\xi)$ for $i=1,2,3,4$ at the stated nodes and the two-dimensional shape functions $\\phi_{ij}(\\xi,\\eta)$.\n- Write the mapping $\\mathbf{x}(\\xi,\\eta)$ and compute the Jacobian matrix $\\mathbf{J}(\\xi,\\eta) = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}$ and its determinant $J(\\xi,\\eta) = \\det \\mathbf{J}(\\xi,\\eta)$.\n- Evaluate $J(\\xi,\\eta)$ at the four-point Gauss–Legendre quadrature nodes in each direction (order $4$), whose abscissae are\n$$\n\\xi^{(1)} = -\\sqrt{\\frac{3}{7} - \\frac{2}{7}\\sqrt{\\frac{6}{5}}}, \\quad\n\\xi^{(2)} = -\\sqrt{\\frac{3}{7} + \\frac{2}{7}\\sqrt{\\frac{6}{5}}}, \\quad\n\\xi^{(3)} = \\sqrt{\\frac{3}{7} + \\frac{2}{7}\\sqrt{\\frac{6}{5}}}, \\quad\n\\xi^{(4)} = \\sqrt{\\frac{3}{7} - \\frac{2}{7}\\sqrt{\\frac{6}{5}}},\n$$\nand similarly for $\\eta^{(1)},\\eta^{(2)},\\eta^{(3)},\\eta^{(4)}$; the two-dimensional Gauss points are the $16$ pairs $(\\xi^{(a)},\\eta^{(b)})$ with $a,b \\in \\{1,2,3,4\\}$.\n\nRound your final numerical answer for the determinant at the Gauss points to four significant figures, and express the result in square kilometers. If the determinant is the same at all Gauss points, report the single value.",
            "solution": "### Step 1: Extract Givens\nThe problem provides the following information:\n- **Element type**: Horizontally oriented isoparametric quadrilateral spectral element.\n- **Polynomial degree**: $p=3$.\n- **Reference element domain**: $\\{(\\xi,\\eta) \\in \\mathbb{R}^{2} : -1 \\le \\xi \\le 1, -1 \\le \\eta \\le 1\\}$.\n- **One-dimensional interpolation node locations**: $\\xi_{1}=-1$, $\\xi_{2}=-\\frac{1}{3}$, $\\xi_{3}=\\frac{1}{3}$, $\\xi_{4}=1$. The same nodes apply for the $\\eta$ coordinate: $\\eta_{1}=-1$, $\\eta_{2}=-\\frac{1}{3}$, $\\eta_{3}=\\frac{1}{3}$, $\\eta_{4}=1$.\n- **One-dimensional basis functions**: Cubic Lagrange basis functions $\\{ \\ell_{i}(\\xi) \\}_{i=1}^{4}$ defined over the given nodes.\n- **Two-dimensional shape functions**: Tensor products $\\phi_{ij}(\\xi,\\eta) = \\ell_{i}(\\xi)\\,\\ell_{j}(\\eta)$.\n- **Isoparametric mapping**: $x(\\xi,\\eta) = \\sum_{i=1}^{4}\\sum_{j=1}^{4} \\phi_{ij}(\\xi,\\eta)\\,x_{ij}$ and $y(\\xi,\\eta) = \\sum_{i=1}^{4}\\sum_{j=1}^{4} \\phi_{ij}(\\xi,\\eta)\\,y_{ij}$.\n- **Physical nodal coordinates**: $x_{ij} = \\frac{L_{x}}{2}\\left(\\xi_{i}+1\\right)$ and $y_{ij} = \\frac{L_{y}}{2}\\left(\\eta_{j}+1\\right)$.\n- **Constants**: $L_{x}=250$ (kilometers) and $L_{y}=300$ (kilometers).\n- **Gauss-Legendre quadrature abscissae (order 4)**:\n$\\xi^{(1)} = -\\sqrt{\\frac{3}{7} - \\frac{2}{7}\\sqrt{\\frac{6}{5}}}$,\n$\\xi^{(2)} = -\\sqrt{\\frac{3}{7} + \\frac{2}{7}\\sqrt{\\frac{6}{5}}}$,\n$\\xi^{(3)} = \\sqrt{\\frac{3}{7} + \\frac{2}{7}\\sqrt{\\frac{6}{5}}}$,\n$\\xi^{(4)} = \\sqrt{\\frac{3}{7} - \\frac{2}{7}\\sqrt{\\frac{6}{5}}}$.\nSimilar abscissae are used for the $\\eta$ coordinate.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective.\n1.  **Scientific Soundness**: The problem describes a standard application of the isoparametric finite element method. All definitions (Lagrange basis, tensor products, isoparametric mapping, Jacobian) are standard in numerical analysis and computational mechanics. The context is numerical weather prediction, where such methods are employed. The given values for nodal coordinates and Gauss points are mathematically correct.\n2.  **Well-Posedness**: The problem asks for specific calculations based on a complete set of definitions and data. A unique solution exists and can be derived through direct computation.\n3.  **Objectivity**: The language is precise and mathematical.\n4.  **Completeness and Consistency**: The problem provides all necessary information. While the setup appears complex, it is internally consistent. The choice of physical nodal coordinates leads to a simplification, but this is a feature of the problem design, not a flaw. It tests the user's understanding of the properties of Lagrange interpolation.\n5.  **No other flaws detected**: The problem is not metaphorical, contradictory, unrealistic, or unverifiable. The specific choice of physical nodal coordinates makes the final calculation of the Jacobian determinant simpler than a general case would suggest, but it does not render the problem trivial as the derivation of this simplification requires substantive reasoning.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. Proceed with the solution.\n\n### Solution Derivation\n\nThe solution proceeds by first determining the explicit forms of the basis functions, then deriving the simplified coordinate mapping, and finally computing the Jacobian determinant.\n\n**1. One-dimensional Lagrange Basis Functions**\nThe one-dimensional cubic Lagrange basis functions $\\ell_{i}(\\xi)$ are defined on the nodes $\\xi_1 = -1$, $\\xi_2 = -1/3$, $\\xi_3 = 1/3$, $\\xi_4 = 1$. The general formula is $\\ell_i(\\xi) = \\prod_{j=1, j\\neq i}^{4} \\frac{\\xi - \\xi_j}{\\xi_i - \\xi_j}$.\n\nFor $i=1$ (node $\\xi_1 = -1$):\n$$ \\ell_1(\\xi) = \\frac{(\\xi - (-1/3))(\\xi - 1/3)(\\xi - 1)}{(-1 - (-1/3))(-1 - 1/3)(-1 - 1)} = \\frac{(\\xi^2 - 1/9)(\\xi - 1)}{(-2/3)(-4/3)(-2)} = -\\frac{9}{16}(\\xi^2 - 1/9)(\\xi - 1) = -\\frac{1}{16}(9\\xi^3 - 9\\xi^2 - \\xi + 1) $$\nFor $i=2$ (node $\\xi_2 = -1/3$):\n$$ \\ell_2(\\xi) = \\frac{(\\xi - (-1))(\\xi - 1/3)(\\xi - 1)}{(-1/3 - (-1))(-1/3 - 1/3)(-1/3 - 1)} = \\frac{(\\xi+1)(\\xi-1/3)(\\xi-1)}{(2/3)(-2/3)(-4/3)} = \\frac{27}{16}(\\xi^2 - 1)(\\xi - 1/3) = \\frac{9}{16}(3\\xi^3 - \\xi^2 - 3\\xi + 1) $$\nFor $i=3$ (node $\\xi_3 = 1/3$):\n$$ \\ell_3(\\xi) = \\frac{(\\xi - (-1))(\\xi - (-1/3))(\\xi - 1)}{(1/3 - (-1))(1/3 - (-1/3))(1/3 - 1)} = \\frac{(\\xi+1)(\\xi+1/3)(\\xi-1)}{(4/3)(2/3)(-2/3)} = -\\frac{27}{16}(\\xi^2 - 1)(\\xi + 1/3) = -\\frac{9}{16}(3\\xi^3 + \\xi^2 - 3\\xi - 1) $$\nFor $i=4$ (node $\\xi_4 = 1$):\n$$ \\ell_4(\\xi) = \\frac{(\\xi - (-1))(\\xi - (-1/3))(\\xi - 1/3)}{(1 - (-1))(1 - (-1/3))(1 - 1/3)} = \\frac{(\\xi+1)(\\xi^2-1/9)}{(2)(4/3)(2/3)} = \\frac{9}{16}(\\xi+1)(\\xi^2-1/9) = \\frac{1}{16}(9\\xi^3 + 9\\xi^2 - \\xi - 1) $$\nThe basis functions for the $\\eta$ coordinate, $\\{ \\ell_j(\\eta) \\}_{j=1}^4$, are identical in form.\n\n**2. Two-dimensional Shape Functions**\nThe two-dimensional shape functions are the tensor products of the one-dimensional basis functions:\n$$ \\phi_{ij}(\\xi,\\eta) = \\ell_i(\\xi) \\ell_j(\\eta) \\quad \\text{for } i,j \\in \\{1,2,3,4\\} $$\n\n**3. Isoparametric Mapping**\nThe mapping from the reference element $(\\xi, \\eta)$ to the physical element $(x,y)$ is given by:\n$$ x(\\xi,\\eta) = \\sum_{i=1}^{4}\\sum_{j=1}^{4} \\phi_{ij}(\\xi,\\eta)\\,x_{ij} = \\sum_{i=1}^{4}\\sum_{j=1}^{4} \\ell_i(\\xi)\\ell_j(\\eta) \\frac{L_{x}}{2}(\\xi_{i}+1) $$\nWe can separate the sums over $i$ and $j$:\n$$ x(\\xi,\\eta) = \\left( \\sum_{i=1}^{4} \\ell_i(\\xi) \\frac{L_{x}}{2}(\\xi_{i}+1) \\right) \\left( \\sum_{j=1}^{4} \\ell_j(\\eta) \\right) $$\nA fundamental property of Lagrange basis functions is that they sum to unity: $\\sum_{j=1}^{4} \\ell_j(\\eta) = 1$. The expression for $x(\\xi, \\eta)$ thus simplifies to:\n$$ x(\\xi,\\eta) = \\sum_{i=1}^{4} \\ell_i(\\xi) \\frac{L_{x}}{2}(\\xi_{i}+1) $$\nThis expression is the cubic Lagrange interpolant of the function $f(\\xi) = \\frac{L_x}{2}(\\xi+1)$ at the four nodes $\\xi_1, \\xi_2, \\xi_3, \\xi_4$. Since $f(\\xi)$ is a linear polynomial (degree $1$), and the interpolation is of degree $3$, the interpolant is exact. Therefore:\n$$ x(\\xi,\\eta) = \\frac{L_{x}}{2}(\\xi+1) $$\nSimilarly, for the $y$-coordinate:\n$$ y(\\xi,\\eta) = \\sum_{i=1}^{4}\\sum_{j=1}^{4} \\phi_{ij}(\\xi,\\eta)\\,y_{ij} = \\left( \\sum_{i=1}^{4} \\ell_i(\\xi) \\right) \\left( \\sum_{j=1}^{4} \\ell_j(\\eta) \\frac{L_{y}}{2}(\\eta_{j}+1) \\right) $$\nUsing the property $\\sum_{i=1}^{4} \\ell_i(\\xi) = 1$, we get:\n$$ y(\\xi,\\eta) = \\sum_{j=1}^{4} \\ell_j(\\eta) \\frac{L_{y}}{2}(\\eta_{j}+1) = \\frac{L_{y}}{2}(\\eta+1) $$\nThe mapping is thus the simple affine transformation:\n$$ \\mathbf{x}(\\xi,\\eta) = \\left( \\frac{L_{x}}{2}(\\xi+1), \\frac{L_{y}}{2}(\\eta+1) \\right) $$\n\n**4. Jacobian Matrix and Determinant**\nThe Jacobian matrix of this transformation is found by taking partial derivatives:\n$$ \\mathbf{J}(\\xi,\\eta) = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} \\frac{L_x}{2} & 0 \\\\ 0 & \\frac{L_y}{2} \\end{pmatrix} $$\nThe determinant of the Jacobian matrix, $J(\\xi,\\eta)$, is:\n$$ J(\\xi,\\eta) = \\det(\\mathbf{J}) = \\left(\\frac{L_x}{2}\\right) \\left(\\frac{L_y}{2}\\right) - (0)(0) = \\frac{L_x L_y}{4} $$\n\n**5. Evaluation at Gauss-Legendre Quadrature Nodes**\nThe Jacobian determinant $J(\\xi,\\eta)$ is a constant, independent of the coordinates $(\\xi, \\eta)$. Therefore, its value is the same at all points within the element, including the specified $16$ Gauss-Legendre quadrature points. We can now substitute the given values for $L_x$ and $L_y$:\n$$ L_x = 250 \\, \\text{km}, \\quad L_y = 300 \\, \\text{km} $$\n$$ J = \\frac{(250 \\, \\text{km})(300 \\, \\text{km})}{4} = \\frac{75000 \\, \\text{km}^2}{4} = 18750 \\, \\text{km}^2 $$\nThe problem requires the answer to be rounded to four significant figures. The calculated value $18750$ can be written in scientific notation as $1.875 \\times 10^4$, which already has exactly four significant figures. Thus, no rounding is necessary. The value is $18750$.",
            "answer": "$$\\boxed{18750}$$"
        },
        {
            "introduction": "When we apply the finite element method to time-dependent problems like wave propagation, we obtain a system of ordinary differential equations governed by mass and stiffness matrices. This practice explores the critical choice between using a \"consistent\" mass matrix, which is accurate but computationally expensive, and a \"lumped\" mass matrix, which is diagonal and ideal for efficient time-stepping but alters the solution's properties. By analyzing the eigenvalues of the resulting system, you will directly quantify how this practical choice impacts the numerical dispersion of gravity waves, a key consideration in climate and weather modeling.",
            "id": "4042711",
            "problem": "Consider gravity waves in the linearized Shallow Water Equations (SWE) for free-surface height $\\eta$ over a flat bottom with constant mean depth $H$, neglecting rotation and horizontal advection. The governing equation is the scalar wave equation $\\partial_{tt} \\eta = g H \\nabla^{2} \\eta$, where $g$ is gravitational acceleration. Discretize this equation using the Continuous Galerkin (CG) Finite Element Method (FEM) with linear shape functions on a single equilateral triangular element with side length $\\ell$, whose vertices are at $(0,0)$, $(\\ell,0)$, and $(\\ell/2, \\sqrt{3}\\ell/2)$. Let $N_{1}$, $N_{2}$, and $N_{3}$ be the standard linear shape functions associated with the three vertices.\n\n1. Using the definition $M_{ij} = \\int_{T} N_{i} N_{j} \\,\\mathrm{d}A$, compute the element-level consistent mass matrix $M_{c}$ for the scalar field $\\eta$. Then construct the lumped mass matrix $M_{l}$ by the standard row-sum lumping, $M_{l} = \\mathrm{diag}(M_{c} \\mathbf{1})$, where $\\mathbf{1}$ is the vector of ones.\n2. Using the definition $K_{ij} = \\int_{T} \\nabla N_{i} \\cdot \\nabla N_{j} \\,\\mathrm{d}A$, compute the element-level stiffness matrix $K$ associated with the operator $\\nabla^{2}$.\n3. The semi-discrete system on this single element takes the form $M \\,\\ddot{\\eta} + g H \\, K \\,\\eta = 0$. For each choice of element mass matrix $M$ (consistent $M_{c}$ and lumped $M_{l}$), form the generalized eigenproblem $K x = \\lambda M x$. The discrete squared angular frequencies are then $\\omega^{2} = g H \\,\\lambda$. Because of the presence of the constant mode, one eigenvalue is zero; focus on the largest nonzero eigenvalue of $K x = \\lambda M x$ in each case.\n4. Compute the ratio of the largest nonzero discrete squared angular frequency using the lumped mass matrix to that using the consistent mass matrix. Express your final answer as a single exact real number. No rounding is required. No units are required for the ratio.",
            "solution": "The user wants to find the ratio of the largest nonzero discrete squared angular frequency from a Finite Element Method (FEM) semi-discretization of the linear wave equation, comparing a lumped mass matrix formulation to a consistent mass matrix formulation on a single equilateral triangular element.\n\nThe problem is first validated.\n\n### Step 1: Extract Givens\n- **Governing Equation**: $\\partial_{tt} \\eta = g H \\nabla^{2} \\eta$, where $\\eta$ is the free-surface height, $g$ is gravitational acceleration, and $H$ is the constant mean depth.\n- **Discretization Method**: Continuous Galerkin (CG) Finite Element Method (FEM) with linear shape functions $N_i$.\n- **Domain**: A single equilateral triangular element $T$ with side length $\\ell$. Vertices are at $(0,0)$, $(\\ell,0)$, and $(\\ell/2, \\sqrt{3}\\ell/2)$.\n- **Consistent Mass Matrix**: $M_{ij} = \\int_{T} N_{i} N_{j} \\,\\mathrm{d}A$, denoted $M_c$.\n- **Lumped Mass Matrix**: $M_{l} = \\mathrm{diag}(M_{c} \\mathbf{1})$, formed by row-sum lumping.\n- **Stiffness Matrix**: $K_{ij} = \\int_{T} \\nabla N_{i} \\cdot \\nabla N_{j} \\,\\mathrm{d}A$, denoted $K$.\n- **Semi-discrete System**: $M \\,\\ddot{\\eta} + g H \\, K \\,\\eta = 0$.\n- **Eigenproblem**: $Kx = \\lambda M x$, where $\\lambda = \\omega^2 / (gH)$ and $\\omega$ is the angular frequency.\n- **Objective**: Compute the ratio $\\frac{\\omega_{l, \\max}^2}{\\omega_{c, \\max}^2} = \\frac{\\lambda_{l, \\max}}{\\lambda_{c, \\max}}$, where $\\lambda_{\\max}$ denotes the largest nonzero eigenvalue for the lumped ($l$) and consistent ($c$) mass matrix cases.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is based on the standard linear shallow water wave equation and the canonical Continuous Galerkin FEM formulation. All definitions and equations are standard and scientifically sound.\n- **Well-Posed**: The problem provides a clearly defined geometry, governing equation, and discretization method, and asks for a specific, computable quantity. A unique solution exists.\n- **Objective**: The problem is expressed in precise mathematical language, free of ambiguity or subjective claims.\n- All other criteria for a valid problem are met. There are no contradictions, missing information, or unrealistic assumptions.\n\n### Step 3: Verdict and Action\nThe problem is valid. A detailed solution is provided below.\n\n### Solution\nThe task is to solve the generalized eigenvalue problem $K x = \\lambda M x$ for two different mass matrices, $M_c$ (consistent) and $M_l$ (lumped), and then to find the ratio of their largest non-zero eigenvalues.\n\nFirst, we establish the element matrices $K$, $M_c$, and $M_l$. For a linear triangular element, these matrices have standard forms.\nThe area of the equilateral triangle with side length $\\ell$ is $A = \\frac{1}{2} \\times \\text{base} \\times \\text{height} = \\frac{1}{2} \\ell \\left(\\frac{\\sqrt{3}}{2}\\ell\\right) = \\frac{\\sqrt{3}}{4}\\ell^2$.\n\n**1. Consistent Mass Matrix, $M_c$**\nThe components of the consistent mass matrix are given by $M_{ij} = \\int_T N_i N_j \\, \\mathrm{d}A$. For linear shape functions on a triangle, the standard integration formulas yield:\n$$ \\int_T N_i^2 \\, \\mathrm{d}A = \\frac{A}{6} \\quad \\text{and} \\quad \\int_T N_i N_j \\, \\mathrm{d}A = \\frac{A}{12} \\quad (i \\neq j) $$\nThus, the consistent mass matrix $M_c$ is:\n$$ M_c = \\frac{A}{12} \\begin{pmatrix} 2 & 1 & 1 \\\\ 1 & 2 & 1 \\\\ 1 & 1 & 2 \\end{pmatrix} $$\nSubstituting the area $A = \\frac{\\sqrt{3}}{4}\\ell^2$:\n$$ M_c = \\frac{\\sqrt{3}\\ell^2}{48} \\begin{pmatrix} 2 & 1 & 1 \\\\ 1 & 2 & 1 \\\\ 1 & 1 & 2 \\end{pmatrix} $$\n\n**2. Lumped Mass Matrix, $M_l$**\nThe lumped mass matrix $M_l$ is obtained by the row-sum lumping procedure, $M_l = \\mathrm{diag}(M_c \\mathbf{1})$. First, we compute the row sums of $M_c$:\n$$ M_c \\mathbf{1} = \\frac{A}{12} \\begin{pmatrix} 2 & 1 & 1 \\\\ 1 & 2 & 1 \\\\ 1 & 1 & 2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\frac{A}{12} \\begin{pmatrix} 4 \\\\ 4 \\\\ 4 \\end{pmatrix} = \\frac{A}{3} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} $$\nPlacing these sums on the diagonal gives $M_l$:\n$$ M_l = \\frac{A}{3} \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} = \\frac{A}{3} I $$\nSubstituting the area $A$:\n$$ M_l = \\frac{\\sqrt{3}\\ell^2}{12} I $$\nwhere $I$ is the $3 \\times 3$ identity matrix.\n\n**3. Stiffness Matrix, $K$**\nThe components of the stiffness matrix are $K_{ij} = \\int_T \\nabla N_i \\cdot \\nabla N_j \\, \\mathrm{d}A$. For an equilateral triangle, all internal angles are $\\pi/3 = 60^\\circ$. The standard formula for the entries of the stiffness matrix using the cotangents of the angles opposite the edges is:\n$$ K_{ij} = \\frac{1}{2} (\\cot \\alpha_k + \\cot \\alpha_j) \\quad (\\text{for } i=j) $$\n$$ K_{ij} = -\\frac{1}{2} \\cot \\alpha_k \\quad (\\text{for } i \\neq j, \\text{edge } ij \\text{ is opposite angle } \\alpha_k) $$\nFor an equilateral triangle, all opposite angles are $\\pi/3$, and $\\cot(\\pi/3) = 1/\\sqrt{3}$.\nThis gives:\n$$ K_{ii} = \\frac{1}{2} \\left(\\frac{1}{\\sqrt{3}} + \\frac{1}{\\sqrt{3}}\\right) = \\frac{1}{\\sqrt{3}} $$\n$$ K_{ij} = -\\frac{1}{2\\sqrt{3}} \\quad (i \\neq j) $$\nSo, the stiffness matrix $K$ is:\n$$ K = \\frac{1}{2\\sqrt{3}} \\begin{pmatrix} 2 & -1 & -1 \\\\ -1 & 2 & -1 \\\\ -1 & -1 & 2 \\end{pmatrix} = \\frac{\\sqrt{3}}{6} \\begin{pmatrix} 2 & -1 & -1 \\\\ -1 & 2 & -1 \\\\ -1 & -1 & 2 \\end{pmatrix} $$\n\n**4. Eigenproblem for the Consistent Mass Matrix**\nWe must solve $Kx = \\lambda_c M_c x$. Let's define the matrix patterns $K' = \\begin{pmatrix} 2 & -1 & -1 \\\\ -1 & 2 & -1 \\\\ -1 & -1 & 2 \\end{pmatrix}$ and $M_c' = \\begin{pmatrix} 2 & 1 & 1 \\\\ 1 & 2 & 1 \\\\ 1 & 1 & 2 \\end{pmatrix}$.\nSubstituting the expressions for $K$ and $M_c$:\n$$ \\frac{\\sqrt{3}}{6} K' x = \\lambda_c \\frac{\\sqrt{3}\\ell^2}{48} M_c' x $$\n$$ K' x = \\lambda_c \\left(\\frac{6\\ell^2}{48}\\right) M_c' x = \\lambda_c \\frac{\\ell^2}{8} M_c' x $$\nLet $\\mu_c = \\lambda_c \\frac{\\ell^2}{8}$. The problem becomes a generalized eigenvalue problem $K' x = \\mu_c M_c' x$.\nBoth $K'$ and $M_c'$ are circulant matrices. They are simultaneously diagonalizable by the DFT matrix, and the eigenvalues of the generalized system, $\\mu_c$, are the ratios of the eigenvalues of $K'$ and $M_c'$.\nThe eigenvalues of a $3 \\times 3$ circulant matrix $\\begin{pmatrix} c_0 & c_2 & c_1 \\\\ c_1 & c_0 & c_2 \\\\ c_2 & c_1 & c_0 \\end{pmatrix}$ are $c_0 + c_1\\omega^k + c_2\\omega^{2k}$ for $k=0,1,2$, where $\\omega = \\exp(i2\\pi/3)$.\nFor $K'$, $c_0=2, c_1=-1, c_2=-1$. Its eigenvalues $\\sigma_k$ are:\n$\\sigma_0 = 2 - 1 - 1 = 0$\n$\\sigma_1 = 2 - \\omega - \\omega^2 = 2 - (-1) = 3$\n$\\sigma_2 = 2 - \\omega^2 - \\omega^4 = 2 - \\omega^2 - \\omega = 3$\nFor $M_c'$, $c_0=2, c_1=1, c_2=1$. Its eigenvalues $\\nu_k$ are:\n$\\nu_0 = 2 + 1 + 1 = 4$\n$\\nu_1 = 2 + \\omega + \\omega^2 = 2 + (-1) = 1$\n$\\nu_2 = 2 + \\omega^2 + \\omega^4 = 2 + \\omega^2 + \\omega = 1$\nThe eigenvalues $\\mu_c$ are the ratios $\\sigma_k / \\nu_k$: $\\{0/4, 3/1, 3/1\\} = \\{0, 3, 3\\}$.\nThe largest nonzero eigenvalue is $\\mu_{c, \\max} = 3$.\nWe find $\\lambda_{c, \\max}$ from $\\mu_{c, \\max} = \\lambda_{c, \\max} \\frac{\\ell^2}{8}$:\n$$ \\lambda_{c, \\max} = \\frac{8 \\mu_{c, \\max}}{\\ell^2} = \\frac{8 \\times 3}{\\ell^2} = \\frac{24}{\\ell^2} $$\n\n**5. Eigenproblem for the Lumped Mass Matrix**\nWe now solve $Kx = \\lambda_l M_l x$.\n$$ \\frac{\\sqrt{3}}{6} K' x = \\lambda_l \\left(\\frac{\\sqrt{3}\\ell^2}{12} I\\right) x $$\n$$ K' x = \\lambda_l \\left(\\frac{6\\ell^2}{12}\\right) I x = \\lambda_l \\frac{\\ell^2}{2} x $$\nThis is a standard eigenvalue problem for the matrix $K'$. The eigenvalues of $K'$ are $\\sigma_k = \\{0, 3, 3\\}$.\nSo, the values of $\\lambda_l \\frac{\\ell^2}{2}$ must be $\\{0, 3, 3\\}$.\nThe largest nonzero eigenvalue $\\lambda_{l, \\max}$ is found from the largest nonzero $\\sigma_k$:\n$$ \\lambda_{l, \\max} \\frac{\\ell^2}{2} = 3 $$\n$$ \\lambda_{l, \\max} = \\frac{6}{\\ell^2} $$\n\n**6. Compute the Ratio**\nThe required ratio is that of the largest nonzero discrete squared angular frequencies, which is equivalent to the ratio of the eigenvalues $\\lambda$.\n$$ \\text{Ratio} = \\frac{\\omega_{l, \\max}^2}{\\omega_{c, \\max}^2} = \\frac{\\lambda_{l, \\max}}{\\lambda_{c, \\max}} = \\frac{6/\\ell^2}{24/\\ell^2} = \\frac{6}{24} = \\frac{1}{4} $$",
            "answer": "$$\\boxed{\\frac{1}{4}}$$"
        },
        {
            "introduction": "Modeling incompressible flows, a cornerstone of ocean and atmospheric dynamics, requires solving for velocity and pressure fields simultaneously. This \"mixed\" formulation is notoriously sensitive to the choice of discrete function spaces for each variable; an incompatible pairing can lead to catastrophic, non-physical pressure oscillations. This exercise makes this abstract stability issue concrete by demonstrating how a seemingly intuitive choice of equal-order elements violates the crucial Ladyzhenskaya–Babuška–Brezzi (LBB) or \"inf-sup\" condition, allowing a spurious \"checkerboard\" pressure mode to pollute the solution.",
            "id": "4042765",
            "problem": "Consider the incompressible Stokes subsystem, which is a core building block in many hydrostatic ocean and atmosphere formulations used in Numerical Weather Prediction (NWP) and climate modeling: find velocity $\\boldsymbol{u}$ and pressure $p$ such that the weak momentum and mass-conservation statements hold over a domain $\\Omega$ with sufficiently smooth test functions $\\boldsymbol{v}$ and $q$:\n$$\n\\int_{\\Omega} \\nu \\nabla \\boldsymbol{u} : \\nabla \\boldsymbol{v} \\,\\mathrm{d}\\boldsymbol{x} + \\int_{\\Omega} p \\,\\nabla \\cdot \\boldsymbol{v} \\,\\mathrm{d}\\boldsymbol{x} = \\int_{\\Omega} \\boldsymbol{f} \\cdot \\boldsymbol{v} \\,\\mathrm{d}\\boldsymbol{x}, \\qquad \\int_{\\Omega} q \\,\\nabla \\cdot \\boldsymbol{u} \\,\\mathrm{d}\\boldsymbol{x} = 0,\n$$\nwhere $\\nu$ is the kinematic viscosity and $\\boldsymbol{f}$ is a body force. In mixed Finite Element Method (FEM) discretizations, stability requires the Ladyzhenskaya–Babuška–Brezzi (LBB) inf-sup condition between the discrete velocity and pressure spaces. Equal-order bilinear ($Q_1$–$Q_1$) elements on quadrilateral meshes are known to violate this condition and produce spurious pressure modes (checkerboarding) in collocated discretizations used in geophysical models.\n\nLet $\\Omega = [0,1] \\times [0,1]$ and consider the uniform quadrilateral mesh obtained by subdividing $\\Omega$ into $2 \\times 2$ equal squares, so the node coordinates are $(x_i,y_j)$ with $x_i \\in \\{0, \\tfrac{1}{2}, 1\\}$ and $y_j \\in \\{0, \\tfrac{1}{2}, 1\\}$. Use conforming equal-order $Q_1$–$Q_1$ spaces:\n- The discrete velocity space $\\boldsymbol{V}_h \\subset [H_0^1(\\Omega)]^2$ has two components and is spanned by tensor-product bilinear nodal basis functions that vanish on $\\partial \\Omega$ (homogeneous Dirichlet boundary conditions).\n- The discrete pressure space $Q_h \\subset L_0^2(\\Omega)$ (mean-zero pressure) is spanned by the same scalar $Q_1$ nodal basis functions on the mesh.\n\nDefine the scalar $Q_1$ one-dimensional hat functions $\\{h_0, h_1, h_2\\}$ on $[0,1]$ by\n$$\nh_0(x) = \\begin{cases} 1 - 2x, & 0 \\le x \\le \\tfrac{1}{2}, \\\\ 0, & \\text{elsewhere}, \\end{cases}\n\\quad\nh_1(x) = \\begin{cases} 2x, & 0 \\le x \\le \\tfrac{1}{2}, \\\\ 2(1-x), & \\tfrac{1}{2} \\le x \\le 1, \\\\ 0, & \\text{elsewhere}, \\end{cases}\n\\quad\nh_2(x) = \\begin{cases} 2x - 1, & \\tfrac{1}{2} \\le x \\le 1, \\\\ 0, & \\text{elsewhere}. \\end{cases}\n$$\nand similarly in $y$. The global $Q_1$ nodal basis at $(x_i,y_j)$ is $N_{ij}(x,y) = h_i(x) h_j(y)$. The only interior velocity basis functions are\n$$\n\\boldsymbol{\\psi}_x(x,y) = \\big(h_1(x) h_1(y),\\, 0\\big), \\qquad \\boldsymbol{\\psi}_y(x,y) = \\big(0,\\, h_1(x) h_1(y)\\big),\n$$\nassociated with the interior node $(\\tfrac{1}{2},\\tfrac{1}{2})$ in the $x$ and $y$ components, respectively.\n\nConstruct the discrete checkerboard pressure $q_h \\in Q_h$ with nodal values $p_{ij} = (-1)^{i+j}$ for $(i,j) \\in \\{0,1,2\\} \\times \\{0,1,2\\}$ and\n$$\nq_h(x,y) = \\sum_{i=0}^{2} \\sum_{j=0}^{2} p_{ij} \\, h_i(x) h_j(y).\n$$\nUsing the Galerkin coupling $b(\\boldsymbol{v}_h,q_h) = \\int_{\\Omega} q_h \\,\\nabla \\cdot \\boldsymbol{v}_h \\,\\mathrm{d}\\boldsymbol{x}$, compute explicitly the value of\n$$\n\\sup_{\\boldsymbol{v}_h \\neq \\boldsymbol{0}} \\frac{b(\\boldsymbol{v}_h, q_h)}{\\|\\boldsymbol{v}_h\\|_{H^1(\\Omega)}}\n$$\nfor the given $q_h$ on this mesh, and hence deduce the implied discrete inf-sup lower bound $\\beta_h$ on this mesh and element pair. Express your final answer as a single real number. If a numerical approximation were needed, rounding instructions would be provided, but here an exact value is expected.",
            "solution": "The objective is to compute the value of the expression\n$$\n\\sup_{\\boldsymbol{v}_h \\neq \\boldsymbol{0}} \\frac{b(\\boldsymbol{v}_h, q_h)}{\\|\\boldsymbol{v}_h\\|_{H^1(\\Omega)}}\n$$\nwhere $b(\\boldsymbol{v}_h, q_h) = \\int_{\\Omega} q_h \\,\\nabla \\cdot \\boldsymbol{v}_h \\,\\mathrm{d}\\boldsymbol{x}$, for a specific checkerboard pressure mode $q_h$ and a discrete velocity space $\\boldsymbol{V}_h$.\n\nThe domain is $\\Omega = [0,1] \\times [0,1]$. The discrete velocity space $\\boldsymbol{V}_h \\subset [H_0^1(\\Omega)]^2$ consists of continuous piecewise-bilinear functions that are zero on the boundary $\\partial\\Omega$. On the given $2 \\times 2$ mesh, the nodes are at coordinates $(x_i, y_j)$ where $x_i, y_j \\in \\{0, \\frac{1}{2}, 1\\}$. Due to the homogeneous Dirichlet boundary condition, the only nodal basis functions for velocity that are not identically zero are those associated with the single interior node at $(\\frac{1}{2}, \\frac{1}{2})$. The basis for $\\boldsymbol{V}_h$ is therefore given by the two vector-valued functions provided:\n$$\n\\boldsymbol{\\psi}_x(x,y) = \\big(h_1(x) h_1(y),\\, 0\\big), \\qquad \\boldsymbol{\\psi}_y(x,y) = \\big(0,\\, h_1(x) h_1(y)\\big).\n$$\nAny function $\\boldsymbol{v}_h \\in \\boldsymbol{V}_h$ can be written as a linear combination of these basis functions:\n$$\n\\boldsymbol{v}_h(x,y) = c_x \\boldsymbol{\\psi}_x(x,y) + c_y \\boldsymbol{\\psi}_y(x,y) = \\big(c_x h_1(x)h_1(y),\\, c_y h_1(x)h_1(y)\\big)\n$$\nfor some real coefficients $c_x$ and $c_y$.\n\nThe divergence of $\\boldsymbol{v}_h$ is\n$$\n\\nabla \\cdot \\boldsymbol{v}_h = \\frac{\\partial}{\\partial x}\\left(c_x h_1(x)h_1(y)\\right) + \\frac{\\partial}{\\partial y}\\left(c_y h_1(x)h_1(y)\\right) = c_x h_1'(x)h_1(y) + c_y h_1(x)h_1'(y).\n$$\nThe coupling term $b(\\boldsymbol{v}_h, q_h)$ is then\n$$\nb(\\boldsymbol{v}_h, q_h) = \\int_{\\Omega} q_h(x,y) \\left(c_x h_1'(x)h_1(y) + c_y h_1(x)h_1'(y)\\right) \\,\\mathrm{d}x\\,\\mathrm{d}y.\n$$\nBy linearity of the integral, we can write this as\n$$\nb(\\boldsymbol{v}_h, q_h) = c_x \\int_{\\Omega} q_h(x,y) h_1'(x)h_1(y) \\,\\mathrm{d}x\\,\\mathrm{d}y + c_y \\int_{\\Omega} q_h(x,y) h_1(x)h_1'(y) \\,\\mathrm{d}x\\,\\mathrm{d}y.\n$$\nThe pressure mode $q_h$ is given by $q_h(x,y) = \\sum_{i=0}^{2} \\sum_{j=0}^{2} p_{ij} \\, h_i(x) h_j(y)$ with $p_{ij} = (-1)^{i+j}$. To show that $b(\\boldsymbol{v}_h, q_h) = 0$ for all $\\boldsymbol{v}_h \\in \\boldsymbol{V}_h$, we must show that both integrals in the expression above are zero.\n\nLet's evaluate the first integral, $I_x$:\n$$\nI_x = \\int_{\\Omega} q_h(x,y) h_1'(x)h_1(y) \\,\\mathrm{d}x\\,\\mathrm{d}y = \\int_0^1 \\int_0^1 \\left(\\sum_{i=0}^2 \\sum_{j=0}^2 p_{ij} h_i(x)h_j(y)\\right) h_1'(x)h_1(y) \\,\\mathrm{d}x\\,\\mathrm{d}y.\n$$\nUsing the separability of the basis functions and Fubini's theorem:\n$$\nI_x = \\sum_{i=0}^2 \\sum_{j=0}^2 p_{ij} \\left(\\int_0^1 h_i(x)h_1'(x)\\,\\mathrm{d}x\\right) \\left(\\int_0^1 h_j(y)h_1(y)\\,\\mathrm{d}y\\right).\n$$\nLet's define the one-dimensional integrals $A_i = \\int_0^1 h_i(x)h_1'(x)\\,\\mathrm{d}x$ and $B_j = \\int_0^1 h_j(y)h_1(y)\\,\\mathrm{d}y$.\nThe derivative $h_1'(x)$ is a piecewise constant function: $h_1'(x) = 2$ for $x \\in (0, \\frac{1}{2})$ and $h_1'(x) = -2$ for $x \\in (\\frac{1}{2}, 1)$.\nCalculating $A_i$:\n$A_0 = \\int_0^{1/2} (1-2x)(2)\\,\\mathrm{d}x = [2x-2x^2]_0^{1/2} = 1 - \\frac{1}{2} = \\frac{1}{2}$.\n$A_1 = \\int_0^1 h_1(x)h_1'(x)\\,\\mathrm{d}x = \\frac{1}{2}\\int_0^1 \\frac{\\mathrm{d}}{\\mathrm{d}x}(h_1(x)^2)\\,\\mathrm{d}x = \\frac{1}{2}[h_1(x)^2]_0^1 = \\frac{1}{2}(0^2-0^2) = 0$.\n$A_2 = \\int_{1/2}^1 (2x-1)(-2)\\,\\mathrm{d}x = [-2x^2+2x]_{1/2}^1 = (-2+2) - (-\\frac{1}{2}+1) = -\\frac{1}{2}$.\nSo the vector of integrals is $\\boldsymbol{A} = [A_0, A_1, A_2]^T = [\\frac{1}{2}, 0, -\\frac{1}{2}]^T$.\n\nCalculating $B_j$:\n$B_0 = \\int_0^{1/2} (1-2y)(2y)\\,\\mathrm{d}y = \\int_0^{1/2} (2y-4y^2)\\,\\mathrm{d}y = [y^2 - \\frac{4}{3}y^3]_0^{1/2} = \\frac{1}{4} - \\frac{4}{3}\\frac{1}{8} = \\frac{1}{4} - \\frac{1}{6} = \\frac{1}{12}$.\n$B_1 = \\int_0^1 h_1(y)^2\\,\\mathrm{d}y = \\int_0^{1/2} (2y)^2\\,\\mathrm{d}y + \\int_{1/2}^1 (2(1-y))^2\\,\\mathrm{d}y = [\\frac{4}{3}y^3]_0^{1/2} + 4[-\\frac{(1-y)^3}{3}]_{1/2}^1 = \\frac{4}{3}\\frac{1}{8} - \\frac{4}{3}(0 - (\\frac{1}{2})^3) = \\frac{1}{6} + \\frac{4}{3}\\frac{1}{8} = \\frac{1}{3}$.\nBy symmetry of the basis functions about $x=\\frac{1}{2}$, $B_2 = \\int_{1/2}^1 h_2(y)h_1(y)\\,\\mathrm{d}y = \\int_0^{1/2} h_0(y)h_1(y)\\,\\mathrm{d}y = B_0 = \\frac{1}{12}$.\nSo the vector of integrals is $\\boldsymbol{B} = [B_0, B_1, B_2]^T = [\\frac{1}{12}, \\frac{1}{3}, \\frac{1}{12}]^T$.\n\nThe sum for $I_x$ can be expressed in matrix form as $I_x = \\boldsymbol{B}^T \\boldsymbol{P} \\boldsymbol{A}$, where $\\boldsymbol{P}$ is the matrix with entries $p_{ij}$.\n$$\n\\boldsymbol{P} = \\begin{pmatrix} 1 & -1 & 1 \\\\ -1 & 1 & -1 \\\\ 1 & -1 & 1 \\end{pmatrix}.\n$$\nFirst, let's compute $\\boldsymbol{P}\\boldsymbol{A}$:\n$$\n\\boldsymbol{P}\\boldsymbol{A} = \\begin{pmatrix} 1 & -1 & 1 \\\\ -1 & 1 & -1 \\\\ 1 & -1 & 1 \\end{pmatrix} \\begin{pmatrix} 1/2 \\\\ 0 \\\\ -1/2 \\end{pmatrix} = \\begin{pmatrix} 1(\\frac{1}{2}) - 1(0) + 1(-\\frac{1}{2}) \\\\ -1(\\frac{1}{2}) + 1(0) - 1(-\\frac{1}{2}) \\\\ 1(\\frac{1}{2}) - 1(0) + 1(-\\frac{1}{2}) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}.\n$$\nThus, $I_x = \\boldsymbol{B}^T (\\boldsymbol{P}\\boldsymbol{A}) = [\\frac{1}{12}, \\frac{1}{3}, \\frac{1}{12}] \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = 0$.\n\nNow, let's evaluate the second integral, $I_y$:\n$$\nI_y = \\int_{\\Omega} q_h(x,y) h_1(x)h_1'(y) \\,\\mathrm{d}x\\,\\mathrm{d}y = \\sum_{i=0}^2 \\sum_{j=0}^2 p_{ij} \\left(\\int_0^1 h_i(x)h_1(x)\\,\\mathrm{d}x\\right) \\left(\\int_0^1 h_j(y)h_1'(y)\\,\\mathrm{d}y\\right).\n$$\nUsing our previously defined integrals, this is $I_y = \\sum_{i,j} p_{ij} B_i A_j$. In matrix form, $I_y = \\boldsymbol{A}^T \\boldsymbol{P} \\boldsymbol{B}$.\nLet's compute $\\boldsymbol{P}\\boldsymbol{B}$:\n$$\n\\boldsymbol{P}\\boldsymbol{B} = \\begin{pmatrix} 1 & -1 & 1 \\\\ -1 & 1 & -1 \\\\ 1 & -1 & 1 \\end{pmatrix} \\begin{pmatrix} 1/12 \\\\ 1/3 \\\\ 1/12 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{12} - \\frac{1}{3} + \\frac{1}{12} \\\\ -\\frac{1}{12} + \\frac{1}{3} - \\frac{1}{12} \\\\ \\frac{1}{12} - \\frac{1}{3} + \\frac{1}{12} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{6} - \\frac{1}{3} \\\\ -\\frac{1}{6} + \\frac{1}{3} \\\\ \\frac{1}{6} - \\frac{1}{3} \\end{pmatrix} = \\begin{pmatrix} -1/6 \\\\ 1/6 \\\\ -1/6 \\end{pmatrix}.\n$$\nThen, $I_y = \\boldsymbol{A}^T (\\boldsymbol{P}\\boldsymbol{B}) = [\\frac{1}{2}, 0, -\\frac{1}{2}] \\begin{pmatrix} -1/6 \\\\ 1/6 \\\\ -1/6 \\end{pmatrix} = (\\frac{1}{2})(-\\frac{1}{6}) + (0)(\\frac{1}{6}) + (-\\frac{1}{2})(-\\frac{1}{6}) = -\\frac{1}{12} + \\frac{1}{12} = 0$.\n\nSince both integrals $I_x$ and $I_y$ are zero, we have $b(\\boldsymbol{v}_h, q_h) = c_x \\cdot 0 + c_y \\cdot 0 = 0$ for any choice of $c_x$ and $c_y$. This demonstrates that for the given checkerboard pressure mode $q_h$, the coupling term $b(\\boldsymbol{v}_h, q_h)$ is identically zero for all functions $\\boldsymbol{v}_h$ in the discrete velocity space $\\boldsymbol{V}_h$.\n\nThe expression to be evaluated is $\\sup_{\\boldsymbol{v}_h \\neq \\boldsymbol{0}} \\frac{b(\\boldsymbol{v}_h, q_h)}{\\|\\boldsymbol{v}_h\\|_{H^1(\\Omega)}}$.\nSince the numerator $b(\\boldsymbol{v}_h, q_h)$ is $0$ for any $\\boldsymbol{v}_h \\in \\boldsymbol{V}_h$, and the denominator $\\|\\boldsymbol{v}_h\\|_{H^1(\\Omega)}$ is strictly positive for any $\\boldsymbol{v}_h \\neq \\boldsymbol{0}$, the fraction is always $0$. The supremum of a set containing only the value $0$ is $0$.\n\nTherefore, the value of the supremum is $0$.\n\nThe problem also asks to deduce the implied discrete inf-sup lower bound $\\beta_h$. The Ladyzhenskaya–Babuška–Brezzi (LBB) condition requires the existence of a constant $\\beta_h > 0$ such that:\n$$\n\\inf_{q_h \\in Q_h^0, q_h \\neq \\boldsymbol{0}} \\sup_{\\boldsymbol{v}_h \\in \\boldsymbol{V}_h, \\boldsymbol{v}_h \\neq \\boldsymbol{0}} \\frac{b(\\boldsymbol{v}_h, q_h)}{\\|\\boldsymbol{v}_h\\|_{H^1(\\Omega)}\\|q_h\\|_{L^2(\\Omega)}} \\ge \\beta_h.\n$$\nWe have found a specific non-zero pressure mode $q_h$ (it is non-zero because its nodal values are not all zero, and it has zero mean as required for $q_h \\in Q_h \\subset L_0^2(\\Omega)$) for which the term $\\sup_{\\boldsymbol{v}_h \\neq \\boldsymbol{0}} \\frac{b(\\boldsymbol{v}_h, q_h)}{\\|\\boldsymbol{v}_h\\|_{H^1(\\Omega)}}$ is exactly $0$.\nThis means that for this particular $q_h$, the term inside the infimum, $\\frac{\\sup(\\dots)}{\\|q_h\\|_{L^2(\\Omega)}}$, is also $0$.\nSince the infimum is taken over a set of non-negative values which includes $0$, the infimum must be $0$. This implies that for this choice of mesh and finite element spaces, the inf-sup constant $\\beta_h = 0$. This violates the stability condition $\\beta_h > 0$, confirming the known instability of the $Q_1-Q_1$ element pair for the Stokes problem. The value explicitly computed as requested is that of the supremum, which is $0$.",
            "answer": "$$\\boxed{0}$$"
        }
    ]
}