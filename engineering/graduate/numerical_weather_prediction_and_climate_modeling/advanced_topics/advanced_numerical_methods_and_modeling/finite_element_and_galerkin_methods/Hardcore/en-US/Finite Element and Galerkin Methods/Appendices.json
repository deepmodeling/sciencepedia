{
    "hands_on_practices": [
        {
            "introduction": "The power of the finite element method lies in its ability to handle complex geometries. This is achieved through isoparametric mapping, a technique that uses the same basis functions to define both the geometry of an element and the solution field upon it. This exercise  provides practice in a fundamental skill: calculating the Jacobian determinant, which acts as a local scaling factor for transforming integrals from the physical domain to a standardized reference element.",
            "id": "4042751",
            "problem": "Consider a horizontally oriented isoparametric quadrilateral spectral element of polynomial degree $p=3$ used in a limited-area Numerical Weather Prediction (NWP) model to discretize the shallow-water equations on a locally planar Earth patch. The reference element is the square $\\{(\\xi,\\eta) \\in \\mathbb{R}^{2} : -1 \\le \\xi \\le 1, -1 \\le \\eta \\le 1\\}$. Let the interpolation (nodal) points in each parametric coordinate be the four equispaced locations $\\xi_{1}=-1$, $\\xi_{2}=-\\frac{1}{3}$, $\\xi_{3}=\\frac{1}{3}$, $\\xi_{4}=1$, and similarly $\\eta_{1}=-1$, $\\eta_{2}=-\\frac{1}{3}$, $\\eta_{3}=\\frac{1}{3}$, $\\eta_{4}=1$. Define the one-dimensional cubic Lagrange basis functions $\\{ \\ell_{i}(\\xi) \\}_{i=1}^{4}$ by the fundamental Lagrange interpolation definition over the set $\\{-1,-\\frac{1}{3},\\frac{1}{3},1\\}$, and similarly $\\{ \\ell_{j}(\\eta) \\}_{j=1}^{4}$ over $\\{-1,-\\frac{1}{3},\\frac{1}{3},1\\}$.\n\nThe two-dimensional shape functions for the isoparametric element are $\\{ \\phi_{ij}(\\xi,\\eta) \\}_{i,j=1}^{4}$ defined as tensor products $\\phi_{ij}(\\xi,\\eta) = \\ell_{i}(\\xi)\\,\\ell_{j}(\\eta)$. The isoparametric mapping from the reference element to physical coordinates $\\mathbf{x}(\\xi,\\eta) = (x(\\xi,\\eta),y(\\xi,\\eta))$ is defined by\n$$\nx(\\xi,\\eta) = \\sum_{i=1}^{4}\\sum_{j=1}^{4} \\phi_{ij}(\\xi,\\eta)\\,x_{ij}, \\qquad\ny(\\xi,\\eta) = \\sum_{i=1}^{4}\\sum_{j=1}^{4} \\phi_{ij}(\\xi,\\eta)\\,y_{ij},\n$$\nwhere the physical nodal coordinates are assigned by\n$$\nx_{ij} = \\frac{L_{x}}{2}\\left(\\xi_{i}+1\\right), \\qquad y_{ij} = \\frac{L_{y}}{2}\\left(\\eta_{j}+1\\right),\n$$\nwith $L_{x}=250$ (kilometers) and $L_{y}=300$ (kilometers), representing a rectangular atmospheric element of size $250 \\times 300$ kilometers aligned with the coordinate axes.\n\nUsing these definitions:\n- Write the explicit one-dimensional basis functions $\\ell_{i}(\\xi)$ for $i=1,2,3,4$ at the stated nodes and the two-dimensional shape functions $\\phi_{ij}(\\xi,\\eta)$.\n- Write the mapping $\\mathbf{x}(\\xi,\\eta)$ and compute the Jacobian matrix $\\mathbf{J}(\\xi,\\eta) = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}$ and its determinant $J(\\xi,\\eta) = \\det \\mathbf{J}(\\xi,\\eta)$.\n- Evaluate $J(\\xi,\\eta)$ at the four-point Gauss–Legendre quadrature nodes in each direction (order $4$), whose abscissae are\n$$\n\\xi^{(1)} = -\\sqrt{\\frac{3}{7} - \\frac{2}{7}\\sqrt{\\frac{6}{5}}}, \\quad\n\\xi^{(2)} = -\\sqrt{\\frac{3}{7} + \\frac{2}{7}\\sqrt{\\frac{6}{5}}}, \\quad\n\\xi^{(3)} = \\sqrt{\\frac{3}{7} + \\frac{2}{7}\\sqrt{\\frac{6}{5}}}, \\quad\n\\xi^{(4)} = \\sqrt{\\frac{3}{7} - \\frac{2}{7}\\sqrt{\\frac{6}{5}}},\n$$\nand similarly for $\\eta^{(1)},\\eta^{(2)},\\eta^{(3)},\\eta^{(4)}$; the two-dimensional Gauss points are the $16$ pairs $(\\xi^{(a)},\\eta^{(b)})$ with $a,b \\in \\{1,2,3,4\\}$.\n\nRound your final numerical answer for the determinant at the Gauss points to four significant figures, and express the result in square kilometers. If the determinant is the same at all Gauss points, report the single value.",
            "solution": "### Step 1: Extract Givens\nThe problem provides the following information:\n- **Element type**: Horizontally oriented isoparametric quadrilateral spectral element.\n- **Polynomial degree**: $p=3$.\n- **Reference element domain**: $\\{(\\xi,\\eta) \\in \\mathbb{R}^{2} : -1 \\le \\xi \\le 1, -1 \\le \\eta \\le 1\\}$.\n- **One-dimensional interpolation node locations**: $\\xi_{1}=-1$, $\\xi_{2}=-\\frac{1}{3}$, $\\xi_{3}=\\frac{1}{3}$, $\\xi_{4}=1$. The same nodes apply for the $\\eta$ coordinate: $\\eta_{1}=-1$, $\\eta_{2}=-\\frac{1}{3}$, $\\eta_{3}=\\frac{1}{3}$, $\\eta_{4}=1$.\n- **One-dimensional basis functions**: Cubic Lagrange basis functions $\\{ \\ell_{i}(\\xi) \\}_{i=1}^{4}$ defined over the given nodes.\n- **Two-dimensional shape functions**: Tensor products $\\phi_{ij}(\\xi,\\eta) = \\ell_{i}(\\xi)\\,\\ell_{j}(\\eta)$.\n- **Isoparametric mapping**: $x(\\xi,\\eta) = \\sum_{i=1}^{4}\\sum_{j=1}^{4} \\phi_{ij}(\\xi,\\eta)\\,x_{ij}$ and $y(\\xi,\\eta) = \\sum_{i=1}^{4}\\sum_{j=1}^{4} \\phi_{ij}(\\xi,\\eta)\\,y_{ij}$.\n- **Physical nodal coordinates**: $x_{ij} = \\frac{L_{x}}{2}\\left(\\xi_{i}+1\\right)$ and $y_{ij} = \\frac{L_{y}}{2}\\left(\\eta_{j}+1\\right)$.\n- **Constants**: $L_{x}=250$ (kilometers) and $L_{y}=300$ (kilometers).\n- **Gauss-Legendre quadrature abscissae (order 4)**:\n$\\xi^{(1)} = -\\sqrt{\\frac{3}{7} - \\frac{2}{7}\\sqrt{\\frac{6}{5}}}$,\n$\\xi^{(2)} = -\\sqrt{\\frac{3}{7} + \\frac{2}{7}\\sqrt{\\frac{6}{5}}}$,\n$\\xi^{(3)} = \\sqrt{\\frac{3}{7} + \\frac{2}{7}\\sqrt{\\frac{6}{5}}}$,\n$\\xi^{(4)} = \\sqrt{\\frac{3}{7} - \\frac{2}{7}\\sqrt{\\frac{6}{5}}}$.\nSimilar abscissae are used for the $\\eta$ coordinate.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective.\n1.  **Scientific Soundness**: The problem describes a standard application of the isoparametric finite element method. All definitions (Lagrange basis, tensor products, isoparametric mapping, Jacobian) are standard in numerical analysis and computational mechanics. The context is numerical weather prediction, where such methods are employed. The given values for nodal coordinates and Gauss points are mathematically correct.\n2.  **Well-Posedness**: The problem asks for specific calculations based on a complete set of definitions and data. A unique solution exists and can be derived through direct computation.\n3.  **Objectivity**: The language is precise and mathematical.\n4.  **Completeness and Consistency**: The problem provides all necessary information. While the setup appears complex, it is internally consistent. The choice of physical nodal coordinates leads to a simplification, but this is a feature of the problem design, not a flaw. It tests the user's understanding of the properties of Lagrange interpolation.\n5.  **No other flaws detected**: The problem is not metaphorical, contradictory, unrealistic, or unverifiable. The specific choice of physical nodal coordinates makes the final calculation of the Jacobian determinant simpler than a general case would suggest, but it does not render the problem trivial as the derivation of this simplification requires substantive reasoning.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. Proceed with the solution.\n\n### Solution Derivation\n\nThe solution proceeds by first determining the explicit forms of the basis functions, then deriving the simplified coordinate mapping, and finally computing the Jacobian determinant.\n\n**1. One-dimensional Lagrange Basis Functions**\nThe one-dimensional cubic Lagrange basis functions $\\ell_{i}(\\xi)$ are defined on the nodes $\\xi_1 = -1$, $\\xi_2 = -1/3$, $\\xi_3 = 1/3$, $\\xi_4 = 1$. The general formula is $\\ell_i(\\xi) = \\prod_{j=1, j\\neq i}^{4} \\frac{\\xi - \\xi_j}{\\xi_i - \\xi_j}$.\n\nFor $i=1$ (node $\\xi_1 = -1$):\n$$ \\ell_1(\\xi) = \\frac{(\\xi - (-1/3))(\\xi - 1/3)(\\xi - 1)}{(-1 - (-1/3))(-1 - 1/3)(-1 - 1)} = \\frac{(\\xi^2 - 1/9)(\\xi - 1)}{(-2/3)(-4/3)(-2)} = -\\frac{9}{16}(\\xi^2 - 1/9)(\\xi - 1) = -\\frac{1}{16}(9\\xi^3 - 9\\xi^2 - \\xi + 1) $$\nFor $i=2$ (node $\\xi_2 = -1/3$):\n$$ \\ell_2(\\xi) = \\frac{(\\xi - (-1))(\\xi - 1/3)(\\xi - 1)}{(-1/3 - (-1))(-1/3 - 1/3)(-1/3 - 1)} = \\frac{(\\xi+1)(\\xi-1/3)(\\xi-1)}{(2/3)(-2/3)(-4/3)} = \\frac{27}{16}(\\xi^2 - 1)(\\xi - 1/3) = \\frac{9}{16}(3\\xi^3 - \\xi^2 - 3\\xi + 1) $$\nFor $i=3$ (node $\\xi_3 = 1/3$):\n$$ \\ell_3(\\xi) = \\frac{(\\xi - (-1))(\\xi - (-1/3))(\\xi - 1)}{(1/3 - (-1))(1/3 - (-1/3))(1/3 - 1)} = \\frac{(\\xi+1)(\\xi+1/3)(\\xi-1)}{(4/3)(2/3)(-2/3)} = -\\frac{27}{16}(\\xi^2 - 1)(\\xi + 1/3) = -\\frac{9}{16}(3\\xi^3 + \\xi^2 - 3\\xi - 1) $$\nFor $i=4$ (node $\\xi_4 = 1$):\n$$ \\ell_4(\\xi) = \\frac{(\\xi - (-1))(\\xi - (-1/3))(\\xi - 1/3)}{(1 - (-1))(1 - (-1/3))(1 - 1/3)} = \\frac{(\\xi+1)(\\xi^2-1/9)}{(2)(4/3)(2/3)} = \\frac{9}{16}(\\xi+1)(\\xi^2-1/9) = \\frac{1}{16}(9\\xi^3 + 9\\xi^2 - \\xi - 1) $$\nThe basis functions for the $\\eta$ coordinate, $\\{ \\ell_j(\\eta) \\}_{j=1}^4$, are identical in form.\n\n**2. Two-dimensional Shape Functions**\nThe two-dimensional shape functions are the tensor products of the one-dimensional basis functions:\n$$ \\phi_{ij}(\\xi,\\eta) = \\ell_i(\\xi) \\ell_j(\\eta) \\quad \\text{for } i,j \\in \\{1,2,3,4\\} $$\n\n**3. Isoparametric Mapping**\nThe mapping from the reference element $(\\xi, \\eta)$ to the physical element $(x,y)$ is given by:\n$$ x(\\xi,\\eta) = \\sum_{i=1}^{4}\\sum_{j=1}^{4} \\phi_{ij}(\\xi,\\eta)\\,x_{ij} = \\sum_{i=1}^{4}\\sum_{j=1}^{4} \\ell_i(\\xi)\\ell_j(\\eta) \\frac{L_{x}}{2}(\\xi_{i}+1) $$\nWe can separate the sums over $i$ and $j$:\n$$ x(\\xi,\\eta) = \\left( \\sum_{i=1}^{4} \\ell_i(\\xi) \\frac{L_{x}}{2}(\\xi_{i}+1) \\right) \\left( \\sum_{j=1}^{4} \\ell_j(\\eta) \\right) $$\nA fundamental property of Lagrange basis functions is that they sum to unity: $\\sum_{j=1}^{4} \\ell_j(\\eta) = 1$. The expression for $x(\\xi, \\eta)$ thus simplifies to:\n$$ x(\\xi,\\eta) = \\sum_{i=1}^{4} \\ell_i(\\xi) \\frac{L_{x}}{2}(\\xi_{i}+1) $$\nThis expression is the cubic Lagrange interpolant of the function $f(\\xi) = \\frac{L_x}{2}(\\xi+1)$ at the four nodes $\\xi_1, \\xi_2, \\xi_3, \\xi_4$. Since $f(\\xi)$ is a linear polynomial (degree $1$), and the interpolation is of degree $3$, the interpolant is exact. Therefore:\n$$ x(\\xi,\\eta) = \\frac{L_{x}}{2}(\\xi+1) $$\nSimilarly, for the $y$-coordinate:\n$$ y(\\xi,\\eta) = \\sum_{i=1}^{4}\\sum_{j=1}^{4} \\phi_{ij}(\\xi,\\eta)\\,y_{ij} = \\left( \\sum_{i=1}^{4} \\ell_i(\\xi) \\right) \\left( \\sum_{j=1}^{4} \\ell_j(\\eta) \\frac{L_{y}}{2}(\\eta_{j}+1) \\right) $$\nUsing the property $\\sum_{i=1}^{4} \\ell_i(\\xi) = 1$, we get:\n$$ y(\\xi,\\eta) = \\sum_{j=1}^{4} \\ell_j(\\eta) \\frac{L_{y}}{2}(\\eta_{j}+1) = \\frac{L_{y}}{2}(\\eta+1) $$\nThe mapping is thus the simple affine transformation:\n$$ \\mathbf{x}(\\xi,\\eta) = \\left( \\frac{L_{x}}{2}(\\xi+1), \\frac{L_{y}}{2}(\\eta+1) \\right) $$\n\n**4. Jacobian Matrix and Determinant**\nThe Jacobian matrix of this transformation is found by taking partial derivatives:\n$$ \\mathbf{J}(\\xi,\\eta) = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} \\frac{L_x}{2} & 0 \\\\ 0 & \\frac{L_y}{2} \\end{pmatrix} $$\nThe determinant of the Jacobian matrix, $J(\\xi,\\eta)$, is:\n$$ J(\\xi,\\eta) = \\det(\\mathbf{J}) = \\left(\\frac{L_x}{2}\\right) \\left(\\frac{L_y}{2}\\right) - (0)(0) = \\frac{L_x L_y}{4} $$\n\n**5. Evaluation at Gauss-Legendre Quadrature Nodes**\nThe Jacobian determinant $J(\\xi,\\eta)$ is a constant, independent of the coordinates $(\\xi, \\eta)$. Therefore, its value is the same at all points within the element, including the specified $16$ Gauss-Legendre quadrature points. We can now substitute the given values for $L_x$ and $L_y$:\n$$ L_x = 250 \\, \\text{km}, \\quad L_y = 300 \\, \\text{km} $$\n$$ J = \\frac{(250 \\, \\text{km})(300 \\, \\text{km})}{4} = \\frac{75000 \\, \\text{km}^2}{4} = 18750 \\, \\text{km}^2 $$\nThe problem requires the answer to be rounded to four significant figures. The calculated value $18750$ can be written in scientific notation as $1.875 \\times 10^4$, which already has exactly four significant figures. Thus, no rounding is necessary. The value is $18750$.",
            "answer": "$$\\boxed{18750}$$"
        },
        {
            "introduction": "Discretizing a time-dependent partial differential equation like the wave equation using FEM results in a system of ordinary differential equations governed by mass and stiffness matrices. This practice  explores the crucial trade-off between the 'consistent' mass matrix, derived directly from the Galerkin principle, and the computationally convenient 'lumped' mass matrix. By analyzing the eigenvalues of the resulting systems, you will gain insight into how this choice affects the numerical dispersion properties of the scheme, a key factor in the fidelity of wave propagation in climate and weather models.",
            "id": "4042711",
            "problem": "Consider gravity waves in the linearized Shallow Water Equations (SWE) for free-surface height $\\eta$ over a flat bottom with constant mean depth $H$, neglecting rotation and horizontal advection. The governing equation is the scalar wave equation $\\partial_{tt} \\eta = g H \\nabla^{2} \\eta$, where $g$ is gravitational acceleration. Discretize this equation using the Continuous Galerkin (CG) Finite Element Method (FEM) with linear shape functions on a single equilateral triangular element with side length $\\ell$, whose vertices are at $(0,0)$, $(\\ell,0)$, and $(\\ell/2, \\sqrt{3}\\ell/2)$. Let $N_{1}$, $N_{2}$, and $N_{3}$ be the standard linear shape functions associated with the three vertices.\n\n1. Using the definition $M_{ij} = \\int_{T} N_{i} N_{j} \\,\\mathrm{d}A$, compute the element-level consistent mass matrix $M_{c}$ for the scalar field $\\eta$. Then construct the lumped mass matrix $M_{l}$ by the standard row-sum lumping, $M_{l} = \\mathrm{diag}(M_{c} \\mathbf{1})$, where $\\mathbf{1}$ is the vector of ones.\n2. Using the definition $K_{ij} = \\int_{T} \\nabla N_{i} \\cdot \\nabla N_{j} \\,\\mathrm{d}A$, compute the element-level stiffness matrix $K$ associated with the operator $\\nabla^{2}$.\n3. The semi-discrete system on this single element takes the form $M \\,\\ddot{\\eta} + g H \\, K \\,\\eta = 0$. For each choice of element mass matrix $M$ (consistent $M_{c}$ and lumped $M_{l}$), form the generalized eigenproblem $K x = \\lambda M x$. The discrete squared angular frequencies are then $\\omega^{2} = g H \\,\\lambda$. Because of the presence of the constant mode, one eigenvalue is zero; focus on the largest nonzero eigenvalue of $K x = \\lambda M x$ in each case.\n4. Compute the ratio of the largest nonzero discrete squared angular frequency using the lumped mass matrix to that using the consistent mass matrix. Express your final answer as a single exact real number. No rounding is required. No units are required for the ratio.",
            "solution": "The user wants to find the ratio of the largest nonzero discrete squared angular frequency from a Finite Element Method (FEM) semi-discretization of the linear wave equation, comparing a lumped mass matrix formulation to a consistent mass matrix formulation on a single equilateral triangular element.\n\nThe problem is first validated.\n\n### Step 1: Extract Givens\n- **Governing Equation**: $\\partial_{tt} \\eta = g H \\nabla^{2} \\eta$, where $\\eta$ is the free-surface height, $g$ is gravitational acceleration, and $H$ is the constant mean depth.\n- **Discretization Method**: Continuous Galerkin (CG) Finite Element Method (FEM) with linear shape functions $N_i$.\n- **Domain**: A single equilateral triangular element $T$ with side length $\\ell$. Vertices are at $(0,0)$, $(\\ell,0)$, and $(\\ell/2, \\sqrt{3}\\ell/2)$.\n- **Consistent Mass Matrix**: $M_{ij} = \\int_{T} N_{i} N_{j} \\,\\mathrm{d}A$, denoted $M_c$.\n- **Lumped Mass Matrix**: $M_{l} = \\mathrm{diag}(M_{c} \\mathbf{1})$, formed by row-sum lumping.\n- **Stiffness Matrix**: $K_{ij} = \\int_{T} \\nabla N_{i} \\cdot \\nabla N_{j} \\,\\mathrm{d}A$, denoted $K$.\n- **Semi-discrete System**: $M \\,\\ddot{\\eta} + g H \\, K \\,\\eta = 0$.\n- **Eigenproblem**: $K x = \\lambda M x$, where $\\lambda = \\omega^2 / (gH)$ and $\\omega$ is the angular frequency.\n- **Objective**: Compute the ratio $\\frac{\\omega_{l, \\max}^2}{\\omega_{c, \\max}^2} = \\frac{\\lambda_{l, \\max}}{\\lambda_{c, \\max}}$, where $\\lambda_{\\max}$ denotes the largest nonzero eigenvalue for the lumped ($l$) and consistent ($c$) mass matrix cases.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is based on the standard linear shallow water wave equation and the canonical Continuous Galerkin FEM formulation. All definitions and equations are standard and scientifically sound.\n- **Well-Posed**: The problem provides a clearly defined geometry, governing equation, and discretization method, and asks for a specific, computable quantity. A unique solution exists.\n- **Objective**: The problem is expressed in precise mathematical language, free of ambiguity or subjective claims.\n- All other criteria for a valid problem are met. There are no contradictions, missing information, or unrealistic assumptions.\n\n### Step 3: Verdict and Action\nThe problem is valid. A detailed solution is provided below.\n\n### Solution\nThe task is to solve the generalized eigenvalue problem $K x = \\lambda M x$ for two different mass matrices, $M_c$ (consistent) and $M_l$ (lumped), and then to find the ratio of their largest non-zero eigenvalues.\n\nFirst, we establish the element matrices $K$, $M_c$, and $M_l$. For a linear triangular element, these matrices have standard forms.\nThe area of the equilateral triangle with side length $\\ell$ is $A = \\frac{1}{2} \\times \\text{base} \\times \\text{height} = \\frac{1}{2} \\ell \\left(\\frac{\\sqrt{3}}{2}\\ell\\right) = \\frac{\\sqrt{3}}{4}\\ell^2$.\n\n**1. Consistent Mass Matrix, $M_c$**\nThe components of the consistent mass matrix are given by $M_{ij} = \\int_T N_i N_j \\, \\mathrm{d}A$. For linear shape functions on a triangle, the standard integration formulas yield:\n$$ \\int_T N_i^2 \\, \\mathrm{d}A = \\frac{A}{6} \\quad \\text{and} \\quad \\int_T N_i N_j \\, \\mathrm{d}A = \\frac{A}{12} \\quad (i \\neq j) $$\nThus, the consistent mass matrix $M_c$ is:\n$$ M_c = \\frac{A}{12} \\begin{pmatrix} 2 & 1 & 1 \\\\ 1 & 2 & 1 \\\\ 1 & 1 & 2 \\end{pmatrix} $$\nSubstituting the area $A = \\frac{\\sqrt{3}}{4}\\ell^2$:\n$$ M_c = \\frac{\\sqrt{3}\\ell^2}{48} \\begin{pmatrix} 2 & 1 & 1 \\\\ 1 & 2 & 1 \\\\ 1 & 1 & 2 \\end{pmatrix} $$\n\n**2. Lumped Mass Matrix, $M_l$**\nThe lumped mass matrix $M_l$ is obtained by the row-sum lumping procedure, $M_l = \\mathrm{diag}(M_c \\mathbf{1})$. First, we compute the row sums of $M_c$:\n$$ M_c \\mathbf{1} = \\frac{A}{12} \\begin{pmatrix} 2 & 1 & 1 \\\\ 1 & 2 & 1 \\\\ 1 & 1 & 2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\frac{A}{12} \\begin{pmatrix} 4 \\\\ 4 \\\\ 4 \\end{pmatrix} = \\frac{A}{3} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} $$\nPlacing these sums on the diagonal gives $M_l$:\n$$ M_l = \\frac{A}{3} \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} = \\frac{A}{3} I $$\nSubstituting the area $A$:\n$$ M_l = \\frac{\\sqrt{3}\\ell^2}{12} I $$\nwhere $I$ is the $3 \\times 3$ identity matrix.\n\n**3. Stiffness Matrix, $K$**\nThe components of the stiffness matrix are $K_{ij} = \\int_T \\nabla N_i \\cdot \\nabla N_j \\, \\mathrm{d}A$. For an equilateral triangle, all internal angles are $\\pi/3 = 60^\\circ$. The standard formula for the entries of the stiffness matrix using the cotangents of the angles opposite the edges is:\n$$ K_{ij} = \\frac{1}{2} (\\cot \\alpha_k + \\cot \\alpha_j) \\quad (\\text{for } i=j) $$\n$$ K_{ij} = -\\frac{1}{2} \\cot \\alpha_k \\quad (\\text{for } i \\neq j, \\text{edge } ij \\text{ is opposite angle } \\alpha_k) $$\nFor an equilateral triangle, all opposite angles are $\\pi/3$, and $\\cot(\\pi/3) = 1/\\sqrt{3}$.\nThis gives:\n$$ K_{ii} = \\frac{1}{2} \\left(\\frac{1}{\\sqrt{3}} + \\frac{1}{\\sqrt{3}}\\right) = \\frac{1}{\\sqrt{3}} $$\n$$ K_{ij} = -\\frac{1}{2\\sqrt{3}} \\quad (i \\neq j) $$\nSo, the stiffness matrix $K$ is:\n$$ K = \\frac{1}{2\\sqrt{3}} \\begin{pmatrix} 2 & -1 & -1 \\\\ -1 & 2 & -1 \\\\ -1 & -1 & 2 \\end{pmatrix} = \\frac{\\sqrt{3}}{6} \\begin{pmatrix} 2 & -1 & -1 \\\\ -1 & 2 & -1 \\\\ -1 & -1 & 2 \\end{pmatrix} $$\n\n**4. Eigenproblem for the Consistent Mass Matrix**\nWe must solve $Kx = \\lambda_c M_c x$. Let's define the matrix patterns $K' = \\begin{pmatrix} 2 & -1 & -1 \\\\ -1 & 2 & -1 \\\\ -1 & -1 & 2 \\end{pmatrix}$ and $M_c' = \\begin{pmatrix} 2 & 1 & 1 \\\\ 1 & 2 & 1 \\\\ 1 & 1 & 2 \\end{pmatrix}$.\nSubstituting the expressions for $K$ and $M_c$:\n$$ \\frac{\\sqrt{3}}{6} K' x = \\lambda_c \\frac{\\sqrt{3}\\ell^2}{48} M_c' x $$\n$$ K' x = \\lambda_c \\left(\\frac{6\\ell^2}{48}\\right) M_c' x = \\lambda_c \\frac{\\ell^2}{8} M_c' x $$\nLet $\\mu_c = \\lambda_c \\frac{\\ell^2}{8}$. The problem becomes a generalized eigenvalue problem $K' x = \\mu_c M_c' x$.\nBoth $K'$ and $M_c'$ are circulant matrices. They are simultaneously diagonalizable by the DFT matrix, and the eigenvalues of the generalized system, $\\mu_c$, are the ratios of the eigenvalues of $K'$ and $M_c'$.\nThe eigenvalues of a $3 \\times 3$ circulant matrix $\\begin{pmatrix} c_0 & c_2 & c_1 \\\\ c_1 & c_0 & c_2 \\\\ c_2 & c_1 & c_0 \\end{pmatrix}$ are $c_0 + c_1\\omega^k + c_2\\omega^{2k}$ for $k=0,1,2$, where $\\omega = \\exp(i2\\pi/3)$.\nFor $K'$, $c_0=2, c_1=-1, c_2=-1$. Its eigenvalues $\\sigma_k$ are:\n$\\sigma_0 = 2 - 1 - 1 = 0$\n$\\sigma_1 = 2 - \\omega - \\omega^2 = 2 - (-1) = 3$\n$\\sigma_2 = 2 - \\omega^2 - \\omega^4 = 2 - \\omega^2 - \\omega = 3$\nFor $M_c'$, $c_0=2, c_1=1, c_2=1$. Its eigenvalues $\\nu_k$ are:\n$\\nu_0 = 2 + 1 + 1 = 4$\n$\\nu_1 = 2 + \\omega + \\omega^2 = 2 + (-1) = 1$\n$\\nu_2 = 2 + \\omega^2 + \\omega^4 = 2 + \\omega^2 + \\omega = 1$\nThe eigenvalues $\\mu_c$ are the ratios $\\sigma_k / \\nu_k$: $\\{0/4, 3/1, 3/1\\} = \\{0, 3, 3\\}$.\nThe largest nonzero eigenvalue is $\\mu_{c, \\max} = 3$.\nWe find $\\lambda_{c, \\max}$ from $\\mu_{c, \\max} = \\lambda_{c, \\max} \\frac{\\ell^2}{8}$:\n$$ \\lambda_{c, \\max} = \\frac{8 \\mu_{c, \\max}}{\\ell^2} = \\frac{8 \\times 3}{\\ell^2} = \\frac{24}{\\ell^2} $$\n\n**5. Eigenproblem for the Lumped Mass Matrix**\nWe now solve $Kx = \\lambda_l M_l x$.\n$$ \\frac{\\sqrt{3}}{6} K' x = \\lambda_l \\left(\\frac{\\sqrt{3}\\ell^2}{12} I\\right) x $$\n$$ K' x = \\lambda_l \\left(\\frac{6\\ell^2}{12}\\right) I x = \\lambda_l \\frac{\\ell^2}{2} x $$\nThis is a standard eigenvalue problem for the matrix $K'$. The eigenvalues of $K'$ are $\\sigma_k = \\{0, 3, 3\\}$.\nSo, the values of $\\lambda_l \\frac{\\ell^2}{2}$ must be $\\{0, 3, 3\\}$.\nThe largest nonzero eigenvalue $\\lambda_{l, \\max}$ is found from the largest nonzero $\\sigma_k$:\n$$ \\lambda_{l, \\max} \\frac{\\ell^2}{2} = 3 $$\n$$ \\lambda_{l, \\max} = \\frac{6}{\\ell^2} $$\n\n**6. Compute the Ratio**\nThe required ratio is that of the largest nonzero discrete squared angular frequencies, which is equivalent to the ratio of the eigenvalues $\\lambda$.\n$$ \\text{Ratio} = \\frac{\\omega_{l, \\max}^2}{\\omega_{c, \\max}^2} = \\frac{\\lambda_{l, \\max}}{\\lambda_{c, \\max}} = \\frac{6/\\ell^2}{24/\\ell^2} = \\frac{6}{24} = \\frac{1}{4} $$",
            "answer": "$$\\boxed{\\frac{1}{4}}$$"
        },
        {
            "introduction": "For advection-dominated transport, a cornerstone of atmospheric modeling, Discontinuous Galerkin (DG) methods offer significant advantages in stability and conservation. This exercise  walks through the fundamental steps of building a DG scheme: defining a weak form on an element, introducing an 'upwind' numerical flux to ensure stability, and performing a stability analysis to derive the Courant–Friedrichs–Lewy (CFL) condition. This provides a practical understanding of how to construct a stable, explicit DG scheme for hyperbolic conservation laws.",
            "id": "4042731",
            "problem": "Consider the linear tracer advection equation on the two-dimensional sphere of radius $R$, written in flux form as\n$$\n\\partial_{t} q + \\nabla_{s} \\cdot (\\mathbf{u} \\, q) = 0,\n$$\nwhere $q$ is the tracer concentration, $\\mathbf{u}$ is the prescribed horizontal wind velocity tangent to the sphere, and $\\nabla_{s} \\cdot (\\cdot)$ denotes the surface divergence on the sphere. The sphere is discretized by a quasi-uniform triangulation into spherical triangles whose geodesic edges have maximum length $h$, with elements approximately equilateral at the mesh scale.\n\nUse a Discontinuous Galerkin (DG) finite element method of polynomial degree zero (piecewise constant basis per element) and the forward Euler time discretization to derive the fully discrete update for the element-averaged tracer $q_{K}^{n}$ in an element $K$. Employ a mass-lumped form (the element mass equals the spherical element area $|K|$) and an upwind numerical flux across each edge $e \\subset \\partial K$ of geodesic length $\\ell_{e}$. Show how the update reduces to a flux-balance over edges with the mass-lumped denominator $|K|$.\n\nThen, obtain a sufficient Courant–Friedrichs–Lewy (CFL) time-step limit of the form\n$$\n\\Delta t \\le C \\, \\frac{h}{\\|\\mathbf{u}\\|_{\\infty}},\n$$\nby bounding the total outgoing edge flux in terms of the element perimeter and the maximum wind speed $\\|\\mathbf{u}\\|_{\\infty}$. Assume the triangles are sufficiently small that their spherical areas and edge lengths can be approximated by their planar equilateral counterparts, so that $|K| \\approx (\\sqrt{3}/4) h^{2}$ and each edge length satisfies $\\ell_{e} \\approx h$.\n\nFinally, evaluate this CFL bound numerically for a spherical mesh with maximum edge length $h = 1.2 \\times 10^{5}$ m and maximum wind speed $\\|\\mathbf{u}\\|_{\\infty} = 80$ $m s^{-1}$, and report the maximum allowable time step $\\Delta t_{\\max}$ in seconds. Round your numerical answer to four significant figures. Express the final time step in seconds.",
            "solution": "The fundamental starting point is the conservation law in flux form on the sphere,\n$$\n\\partial_{t} q + \\nabla_{s} \\cdot (\\mathbf{u} \\, q) = 0,\n$$\nwhich expresses local conservation of the tracer under advection by the wind field $\\mathbf{u}$.\n\nWe partition the sphere into a quasi-uniform triangulation of spherical triangles and select a Discontinuous Galerkin (DG) finite element space of polynomial degree zero (piecewise constants). Let $K$ denote a single spherical triangle with area $|K|$ and boundary $\\partial K$ composed of geodesic edges $e$ with outward unit normal $\\mathbf{n}_{K,e}$ (tangent to the sphere and normal to the edge).\n\nWith a piecewise constant basis over $K$, the weak form with test function $1$ reduces to the integral balance over the control volume $K$:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{K} q \\, \\mathrm{d}S \\;+\\; \\int_{\\partial K} (\\mathbf{u} \\cdot \\mathbf{n}_{K,e}) \\, q \\, \\mathrm{d}s \\;=\\; 0.\n$$\nDefine the element average $q_{K}(t) = \\frac{1}{|K|} \\int_{K} q \\, \\mathrm{d}S$. Since the basis is constant, mass-lumping is exact and the element mass is $|K|$. The semi-discrete conservation law thus becomes\n$$\n|K| \\, \\frac{\\mathrm{d}}{\\mathrm{d}t} q_{K}(t) \\;+\\; \\sum_{e \\subset \\partial K} \\int_{e} (\\mathbf{u} \\cdot \\mathbf{n}_{K,e}) \\, q \\, \\mathrm{d}s \\;=\\; 0.\n$$\nTo close the edge fluxes with a stable explicit scheme, we use an upwind numerical flux. Let $K'$ denote the neighbor across edge $e$ and define the edge-normal velocity $u_{n,e} = \\mathbf{u}_{e} \\cdot \\mathbf{n}_{K,e}$ evaluated appropriately on $e$. The standard upwind edge flux for a piecewise constant DG scheme is\n$$\n\\widehat{F}_{e}(q^{n}) \\;=\\; \\int_{e} \\left[ u_{n,e}^{+} \\, q_{K}^{n} \\;+\\; u_{n,e}^{-} \\, q_{K'}^{n} \\right] \\, \\mathrm{d}s,\n$$\nwhere $u_{n,e}^{+} = \\max(u_{n,e}, 0)$ and $u_{n,e}^{-} = \\min(u_{n,e}, 0)$. Approximating $\\mathbf{u}$ and $q$ as constant along $e$ at time level $n$, the edge integral reduces to the geodesic edge length $\\ell_{e}$ times the upwind state:\n$$\n\\widehat{F}_{e}(q^{n}) \\;\\approx\\; \\ell_{e} \\left[ u_{n,e}^{+} \\, q_{K}^{n} \\;+\\; u_{n,e}^{-} \\, q_{K'}^{n} \\right].\n$$\nWith forward Euler time stepping, the fully discrete, mass-lumped update for element $K$ is\n$$\nq_{K}^{n+1} \\;=\\; q_{K}^{n} \\;-\\; \\frac{\\Delta t}{|K|} \\sum_{e \\subset \\partial K} \\widehat{F}_{e}(q^{n})\n\\;=\\; q_{K}^{n} \\;-\\; \\frac{\\Delta t}{|K|} \\sum_{e \\subset \\partial K} \\ell_{e} \\left[ u_{n,e}^{+} \\, q_{K}^{n} \\;+\\; u_{n,e}^{-} \\, q_{K'}^{n} \\right].\n$$\nTo derive a sufficient Courant–Friedrichs–Lewy (CFL) time-step restriction, we require that the forward Euler update be monotone (a convex combination of current and neighbor states). Collect the coefficient of $q_{K}^{n}$:\n$$\nq_{K}^{n+1} \\;=\\; q_{K}^{n} \\left[ 1 \\;-\\; \\frac{\\Delta t}{|K|} \\sum_{e \\subset \\partial K} \\ell_{e} \\, u_{n,e}^{+} \\right] \\;+\\; \\sum_{e \\subset \\partial K} \\left[ \\frac{\\Delta t}{|K|} \\, \\ell_{e} \\, |u_{n,e}^{-}| \\, q_{K'}^{n} \\right].\n$$\nA sufficient condition for positivity and monotonicity is that the coefficient multiplying $q_{K}^{n}$ be nonnegative:\n$$\n1 \\;-\\; \\frac{\\Delta t}{|K|} \\sum_{e \\subset \\partial K} \\ell_{e} \\, u_{n,e}^{+} \\;\\ge\\; 0,\n$$\nwhich yields\n$$\n\\Delta t \\;\\le\\; \\frac{|K|}{\\sum_{e \\subset \\partial K} \\ell_{e} \\, u_{n,e}^{+}}.\n$$\nSince $u_{n,e}^{+} \\le |u_{n,e}|$ and $|u_{n,e}| \\le \\|\\mathbf{u}\\|_{\\infty}$, we obtain the uniform bound\n$$\n\\Delta t \\;\\le\\; \\frac{|K|}{\\sum_{e \\subset \\partial K} \\ell_{e} \\, |u_{n,e}|} \\;\\le\\; \\frac{|K|}{\\|\\mathbf{u}\\|_{\\infty} \\sum_{e \\subset \\partial K} \\ell_{e}}.\n$$\nFor a quasi-uniform mesh with elements approximately equilateral at the mesh scale, each element has three edges with $\\ell_{e} \\approx h$, so $\\sum_{e \\subset \\partial K} \\ell_{e} \\approx 3 h$. For sufficiently small spherical triangles, the area can be approximated by the planar equilateral triangle formula $|K| \\approx (\\sqrt{3}/4) h^{2}$. Substituting these approximations gives\n$$\n\\Delta t \\;\\le\\; \\frac{(\\sqrt{3}/4) h^{2}}{\\|\\mathbf{u}\\|_{\\infty} \\, (3 h)} \\;=\\; \\left( \\frac{\\sqrt{3}}{12} \\right) \\frac{h}{\\|\\mathbf{u}\\|_{\\infty}}.\n$$\nThus, the CFL constant is $C = \\sqrt{3}/12$:\n$$\n\\Delta t \\;\\le\\; C \\, \\frac{h}{\\|\\mathbf{u}\\|_{\\infty}}, \\qquad C \\;=\\; \\frac{\\sqrt{3}}{12}.\n$$\n\nWe now evaluate this bound numerically for the given mesh and wind speed. With $h = 1.2 \\times 10^{5}$ m and $\\|\\mathbf{u}\\|_{\\infty} = 80$ $m s^{-1}$, we have\n$$\nC \\;=\\; \\frac{\\sqrt{3}}{12} \\;\\approx\\; 0.1443375673,\n$$\nso\n$$\n\\Delta t_{\\max} \\;=\\; C \\, \\frac{h}{\\|\\mathbf{u}\\|_{\\infty}} \\;=\\; 0.1443375673 \\times \\frac{1.2 \\times 10^{5}}{80}\n\\;=\\; 0.1443375673 \\times 1500\n\\;=\\; 216.50635095.\n$$\nRounded to four significant figures, the maximum allowable time step is $216.5$ seconds. The final answer should be expressed as a single number in seconds.",
            "answer": "$$\\boxed{216.5}$$"
        }
    ]
}