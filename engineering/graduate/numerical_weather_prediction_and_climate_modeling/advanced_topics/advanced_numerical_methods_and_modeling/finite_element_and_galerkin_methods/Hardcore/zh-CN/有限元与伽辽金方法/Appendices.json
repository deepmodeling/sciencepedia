{
    "hands_on_practices": [
        {
            "introduction": "有限元方法的核心优势在于其能够处理任意复杂的几何形状。这是通过等参元映射实现的，该技术将计算上方便的、形状规则的参考单元（如正方形或立方体）映射到物理域中的实际、可能扭曲的单元。本练习将引导您完成为四边形谱元构建形函数和计算雅可比行列式的过程，这是理解坐标变换如何影响积分和导数计算的关键一步 。",
            "id": "4042751",
            "problem": "考虑一个水平方向的等参四边形谱元，多项式次数为 $p=3$。该谱元用于局地区域数值天气预报（NWP）模型中，在一个局部平坦的地球片块上对浅水方程进行离散化。参考单元为正方形 $\\{(\\xi,\\eta) \\in \\mathbb{R}^{2} : -1 \\le \\xi \\le 1, -1 \\le \\eta \\le 1\\}$。设每个参数坐标中的插值（节点）点为四个等距位置 $\\xi_{1}=-1$, $\\xi_{2}=-\\frac{1}{3}$, $\\xi_{3}=\\frac{1}{3}$, $\\xi_{4}=1$，同样地，$\\eta_{1}=-1$, $\\eta_{2}=-\\frac{1}{3}$, $\\eta_{3}=\\frac{1}{3}$, $\\eta_{4}=1$。根据集合 $\\{-1,-\\frac{1}{3},\\frac{1}{3},1\\}$ 上的基本拉格朗日插值定义，定义一维三次拉格朗日基函数 $\\{ \\ell_{i}(\\xi) \\}_{i=1}^{4}$，同样地，在 $\\{-1,-\\frac{1}{3},\\frac{1}{3},1\\}$ 上定义 $\\{ \\ell_{j}(\\eta) \\}_{j=1}^{4}$。\n\n该等参单元的二维形函数为 $\\{ \\phi_{ij}(\\xi,\\eta) \\}_{i,j=1}^{4}$，定义为张量积 $\\phi_{ij}(\\xi,\\eta) = \\ell_{i}(\\xi)\\,\\ell_{j}(\\eta)$。从参考单元到物理坐标 $\\mathbf{x}(\\xi,\\eta) = (x(\\xi,\\eta),y(\\xi,\\eta))$ 的等参映射定义为\n$$\nx(\\xi,\\eta) = \\sum_{i=1}^{4}\\sum_{j=1}^{4} \\phi_{ij}(\\xi,\\eta)\\,x_{ij}, \\qquad\ny(\\xi,\\eta) = \\sum_{i=1}^{4}\\sum_{j=1}^{4} \\phi_{ij}(\\xi,\\eta)\\,y_{ij},\n$$\n其中物理节点坐标被赋值为\n$$\nx_{ij} = \\frac{L_{x}}{2}\\left(\\xi_{i}+1\\right), \\qquad y_{ij} = \\frac{L_{y}}{2}\\left(\\eta_{j}+1\\right),\n$$\n$L_{x}=250$（公里），$L_{y}=300$（公里），代表一个尺寸为 $250 \\times 300$ 公里且与坐标轴对齐的矩形大气单元。\n\n使用这些定义：\n- 在给定节点上，写出 $i=1,2,3,4$ 的显式一维基函数 $\\ell_{i}(\\xi)$ 和二维形函数 $\\phi_{ij}(\\xi,\\eta)$。\n- 写出映射 $\\mathbf{x}(\\xi,\\eta)$，并计算雅可比矩阵 $\\mathbf{J}(\\xi,\\eta) = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}$ 及其行列式 $J(\\xi,\\eta) = \\det \\mathbf{J}(\\xi,\\eta)$。\n- 在每个方向上的四点高斯-勒让德求积节点（4阶）处计算 $J(\\xi,\\eta)$ 的值，其横坐标为\n$$\n\\xi^{(1)} = -\\sqrt{\\frac{3}{7} - \\frac{2}{7}\\sqrt{\\frac{6}{5}}}, \\quad\n\\xi^{(2)} = -\\sqrt{\\frac{3}{7} + \\frac{2}{7}\\sqrt{\\frac{6}{5}}}, \\quad\n\\xi^{(3)} = \\sqrt{\\frac{3}{7} + \\frac{2}{7}\\sqrt{\\frac{6}{5}}}, \\quad\n\\xi^{(4)} = \\sqrt{\\frac{3}{7} - \\frac{2}{7}\\sqrt{\\frac{6}{5}}},\n$$\n$\\eta^{(1)},\\eta^{(2)},\\eta^{(3)},\\eta^{(4)}$ 也类似；二维高斯点是16对 $(\\xi^{(a)},\\eta^{(b)})$，其中 $a,b \\in \\{1,2,3,4\\}$。\n\n将您在高斯点处计算的行列式的最终数值答案四舍五入到四位有效数字，并以平方公里为单位表示结果。如果行列式在所有高斯点处的值都相同，则报告该单一值。",
            "solution": "### 第1步：提取已知条件\n题目提供了以下信息：\n- **单元类型**：水平方向的等参四边形谱元。\n- **多项式次数**：$p=3$。\n- **参考单元域**：$\\{(\\xi,\\eta) \\in \\mathbb{R}^{2} : -1 \\le \\xi \\le 1, -1 \\le \\eta \\le 1\\}$。\n- **一维插值节点位置**：$\\xi_{1}=-1$, $\\xi_{2}=-\\frac{1}{3}$, $\\xi_{3}=\\frac{1}{3}$, $\\xi_{4}=1$。同样的节点也适用于 $\\eta$ 坐标：$\\eta_{1}=-1$, $\\eta_{2}=-\\frac{1}{3}$, $\\eta_{3}=\\frac{1}{3}$, $\\eta_{4}=1$。\n- **一维基函数**：在给定节点上定义的三次拉格朗日基函数 $\\{ \\ell_{i}(\\xi) \\}_{i=1}^{4}$。\n- **二维形函数**：张量积 $\\phi_{ij}(\\xi,\\eta) = \\ell_{i}(\\xi)\\,\\ell_{j}(\\eta)$。\n- **等参映射**：$x(\\xi,\\eta) = \\sum_{i=1}^{4}\\sum_{j=1}^{4} \\phi_{ij}(\\xi,\\eta)\\,x_{ij}$ 和 $y(\\xi,\\eta) = \\sum_{i=1}^{4}\\sum_{j=1}^{4} \\phi_{ij}(\\xi,\\eta)\\,y_{ij}$。\n- **物理节点坐标**：$x_{ij} = \\frac{L_{x}}{2}\\left(\\xi_{i}+1\\right)$ 和 $y_{ij} = \\frac{L_{y}}{2}\\left(\\eta_{j}+1\\right)$。\n- **常量**：$L_{x}=250$（公里）和 $L_{y}=300$（公里）。\n- **高斯-勒让德求积横坐标（4阶）**：\n$\\xi^{(1)} = -\\sqrt{\\frac{3}{7} - \\frac{2}{7}\\sqrt{\\frac{6}{5}}}$,\n$\\xi^{(2)} = -\\sqrt{\\frac{3}{7} + \\frac{2}{7}\\sqrt{\\frac{6}{5}}}$,\n$\\xi^{(3)} = \\sqrt{\\frac{3}{7} + \\frac{2}{7}\\sqrt{\\frac{6}{5}}}$,\n$\\xi^{(4)} = \\sqrt{\\frac{3}{7} - \\frac{2}{7}\\sqrt{\\frac{6}{5}}}$。\n$\\eta$ 坐标使用类似的横坐标。\n\n### 第2步：使用提取的已知条件进行验证\n该问题具有科学依据，是适定的、客观的。\n1.  **科学合理性**：该问题描述了等参有限元法的一个标准应用。所有定义（拉格朗日基、张量积、等参映射、雅可比矩阵）在数值分析和计算力学中都是标准的。其背景是数值天气预报，这些方法在该领域有所应用。给定的节点坐标和高斯点的值在数学上是正确的。\n2.  **适定性**：该问题要求基于一套完整的定义和数据进行具体计算。存在唯一解，可通过直接计算得出。\n3.  **客观性**：语言是精确和数学化的。\n4.  **完整性与一致性**：问题提供了所有必要的信息。虽然设置看起来复杂，但内部是一致的。物理节点坐标的选择导致了简化，但这是问题设计的一个特点，而不是缺陷。它考验了用户对拉格朗日插值性质的理解。\n5.  **未检测到其他缺陷**：问题不是隐喻性的、矛盾的、不切实际的或无法验证的。物理节点坐标的特定选择使得雅可比行列式的最终计算比一般情况所暗示的要简单，但这并未使问题变得微不足道，因为这种简化的推导需要实质性的推理。\n\n### 第3步：结论与行动\n问题是**有效的**。继续进行解答。\n\n### 解题推导\n\n解题过程首先确定基函数的显式形式，然后推导简化的坐标映射，最后计算雅可比行列式。\n\n**1. 一维拉格朗日基函数**\n一维三次拉格朗日基函数 $\\ell_{i}(\\xi)$ 定义在节点 $\\xi_1 = -1$, $\\xi_2 = -1/3$, $\\xi_3 = 1/3$, $\\xi_4 = 1$ 上。通用公式为 $\\ell_i(\\xi) = \\prod_{j=1, j\\neq i}^{4} \\frac{\\xi - \\xi_j}{\\xi_i - \\xi_j}$。\n\n对于 $i=1$（节点 $\\xi_1 = -1$）：\n$$ \\ell_1(\\xi) = \\frac{(\\xi - (-1/3))(\\xi - 1/3)(\\xi - 1)}{(-1 - (-1/3))(-1 - 1/3)(-1 - 1)} = \\frac{(\\xi^2 - 1/9)(\\xi - 1)}{(-2/3)(-4/3)(-2)} = -\\frac{9}{16}(\\xi^2 - 1/9)(\\xi - 1) = -\\frac{1}{16}(9\\xi^3 - 9\\xi^2 - \\xi + 1) $$\n对于 $i=2$（节点 $\\xi_2 = -1/3$）：\n$$ \\ell_2(\\xi) = \\frac{(\\xi - (-1))(\\xi - 1/3)(\\xi - 1)}{(-1/3 - (-1))(-1/3 - 1/3)(-1/3 - 1)} = \\frac{(\\xi+1)(\\xi-1/3)(\\xi-1)}{(2/3)(-2/3)(-4/3)} = \\frac{27}{16}(\\xi^2 - 1)(\\xi - 1/3) = \\frac{9}{16}(3\\xi^3 - \\xi^2 - 3\\xi + 1) $$\n对于 $i=3$（节点 $\\xi_3 = 1/3$）：\n$$ \\ell_3(\\xi) = \\frac{(\\xi - (-1))(\\xi - (-1/3))(\\xi - 1)}{(1/3 - (-1))(1/3 - (-1/3))(1/3 - 1)} = \\frac{(\\xi+1)(\\xi+1/3)(\\xi-1)}{(4/3)(2/3)(-2/3)} = -\\frac{27}{16}(\\xi^2 - 1)(\\xi + 1/3) = -\\frac{9}{16}(3\\xi^3 + \\xi^2 - 3\\xi - 1) $$\n对于 $i=4$（节点 $\\xi_4 = 1$）：\n$$ \\ell_4(\\xi) = \\frac{(\\xi - (-1))(\\xi - (-1/3))(\\xi - 1/3)}{(1 - (-1))(1 - (-1/3))(1 - 1/3)} = \\frac{(\\xi+1)(\\xi^2-1/9)}{(2)(4/3)(2/3)} = \\frac{9}{16}(\\xi+1)(\\xi^2-1/9) = \\frac{1}{16}(9\\xi^3 + 9\\xi^2 - \\xi - 1) $$\n$\\eta$ 坐标的基函数 $\\{ \\ell_j(\\eta) \\}_{j=1}^4$ 形式相同。\n\n**2. 二维形函数**\n二维形函数是一维基函数的张量积：\n$$ \\phi_{ij}(\\xi,\\eta) = \\ell_i(\\xi) \\ell_j(\\eta) \\quad \\text{for } i,j \\in \\{1,2,3,4\\} $$\n\n**3. 等参映射**\n从参考单元 $(\\xi, \\eta)$ 到物理单元 $(x,y)$ 的映射由下式给出：\n$$ x(\\xi,\\eta) = \\sum_{i=1}^{4}\\sum_{j=1}^{4} \\phi_{ij}(\\xi,\\eta)\\,x_{ij} = \\sum_{i=1}^{4}\\sum_{j=1}^{4} \\ell_i(\\xi)\\ell_j(\\eta) \\frac{L_{x}}{2}(\\xi_{i}+1) $$\n我们可以将关于 $i$ 和 $j$ 的求和分开：\n$$ x(\\xi,\\eta) = \\left( \\sum_{i=1}^{4} \\ell_i(\\xi) \\frac{L_{x}}{2}(\\xi_{i}+1) \\right) \\left( \\sum_{j=1}^{4} \\ell_j(\\eta) \\right) $$\n拉格朗日基函数的一个基本性质是其和为1：$\\sum_{j=1}^{4} \\ell_j(\\eta) = 1$。因此，$x(\\xi, \\eta)$ 的表达式简化为：\n$$ x(\\xi,\\eta) = \\sum_{i=1}^{4} \\ell_i(\\xi) \\frac{L_{x}}{2}(\\xi_{i}+1) $$\n该表达式是函数 $f(\\xi) = \\frac{L_x}{2}(\\xi+1)$ 在四个节点 $\\xi_1, \\xi_2, \\xi_3, \\xi_4$ 处的三次拉格朗日插值。由于 $f(\\xi)$ 是一个线性多项式（1次），而插值是3次的，因此插值是精确的。所以：\n$$ x(\\xi,\\eta) = \\frac{L_{x}}{2}(\\xi+1) $$\n类似地，对于 $y$ 坐标：\n$$ y(\\xi,\\eta) = \\sum_{i=1}^{4}\\sum_{j=1}^{4} \\phi_{ij}(\\xi,\\eta)\\,y_{ij} = \\left( \\sum_{i=1}^{4} \\ell_i(\\xi) \\right) \\left( \\sum_{j=1}^{4} \\ell_j(\\eta) \\frac{L_{y}}{2}(\\eta_{j}+1) \\right) $$\n利用性质 $\\sum_{i=1}^{4} \\ell_i(\\xi) = 1$，我们得到：\n$$ y(\\xi,\\eta) = \\sum_{j=1}^{4} \\ell_j(\\eta) \\frac{L_{y}}{2}(\\eta_{j}+1) = \\frac{L_{y}}{2}(\\eta+1) $$\n因此，该映射是简单的仿射变换：\n$$ \\mathbf{x}(\\xi,\\eta) = \\left( \\frac{L_{x}}{2}(\\xi+1), \\frac{L_{y}}{2}(\\eta+1) \\right) $$\n\n**4. 雅可比矩阵和行列式**\n此变换的雅可比矩阵通过求偏导数得到：\n$$ \\mathbf{J}(\\xi,\\eta) = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} \\frac{L_x}{2} & 0 \\\\ 0 & \\frac{L_y}{2} \\end{pmatrix} $$\n雅可比矩阵的行列式 $J(\\xi,\\eta)$ 为：\n$$ J(\\xi,\\eta) = \\det(\\mathbf{J}) = \\left(\\frac{L_x}{2}\\right) \\left(\\frac{L_y}{2}\\right) - (0)(0) = \\frac{L_x L_y}{4} $$\n\n**5. 在高斯-勒让德求积节点处的求值**\n雅可比行列式 $J(\\xi,\\eta)$ 是一个常数，与坐标 $(\\xi, \\eta)$ 无关。因此，它在单元内所有点的值都相同，包括指定的16个高斯-勒让德求积点。我们现在可以代入 $L_x$ 和 $L_y$ 的给定值：\n$$ L_x = 250 \\, \\text{km}, \\quad L_y = 300 \\, \\text{km} $$\n$$ J = \\frac{(250 \\, \\text{km})(300 \\, \\text{km})}{4} = \\frac{75000 \\, \\text{km}^2}{4} = 18750 \\, \\text{km}^2 $$\n题目要求将答案四舍五入到四位有效数字。计算出的值 $18750$ 可以写成科学记数法 $1.875 \\times 10^4$，这已经恰好是四位有效数字。因此，无需四舍五入。该值为 $18750$。",
            "answer": "$$\\boxed{18750}$$"
        },
        {
            "introduction": "在求解与时间相关的偏微分方程（如波动方程）时，质量矩阵的构造对数值方案的效率和准确性有深远影响。本练习将探讨两种常见的质量矩阵形式：精确表示耦合的“一致质量矩阵”和简化计算的对角“集中质量矩阵”。通过对一个简单的三角形单元进行分析，您将计算这两种矩阵，并比较它们的广义特征值，从而揭示它们在模拟波传播时的不同色散特性 。",
            "id": "4042711",
            "problem": "考虑在线性化浅水方程（SWE）中的重力波，用于描述平坦底部上平均深度为常数 $H$ 的自由表面高度 $\\eta$，忽略旋转和水平平流。控制方程为标量波动方程 $\\partial_{tt} \\eta = g H \\nabla^{2} \\eta$，其中 $g$ 是重力加速度。使用连续伽辽金（CG）有限元法（FEM）和线性形函数，在边长为 $\\ell$ 的单个等边三角形单元上对此方程进行离散化，该单元的顶点位于 $(0,0)$、$(\\ell,0)$ 和 $(\\ell/2, \\sqrt{3}\\ell/2)$。设 $N_{1}$、$N_{2}$ 和 $N_{3}$ 是与三个顶点相关的标准线性形函数。\n\n1. 使用定义 $M_{ij} = \\int_{T} N_{i} N_{j} \\,\\mathrm{d}A$，计算标量场 $\\eta$ 的单元级一致质量矩阵 $M_{c}$。然后通过标准的行和集中法构造集中质量矩阵 $M_{l}$，$M_{l} = \\mathrm{diag}(M_{c} \\mathbf{1})$，其中 $\\mathbf{1}$ 是全一向量。\n2. 使用定义 $K_{ij} = \\int_{T} \\nabla N_{i} \\cdot \\nabla N_{j} \\,\\mathrm{d}A$，计算与算子 $\\nabla^{2}$ 相关的单元级刚度矩阵 $K$。\n3. 在这个单个单元上的半离散系统形式为 $M \\,\\ddot{\\eta} + g H \\, K \\,\\eta = 0$。对于每种单元质量矩阵 $M$（一致质量矩阵 $M_{c}$ 和集中质量矩阵 $M_{l}$）的选择，建立广义特征问题 $K x = \\lambda M x$。离散角频率的平方则为 $\\omega^{2} = g H \\,\\lambda$。由于存在常数模态，一个特征值为零；关注每种情况下 $K x = \\lambda M x$ 的最大非零特征值。\n4. 计算使用集中质量矩阵得到的最大非零离散角频率平方与使用一致质量矩阵得到的最大非零离散角频率平方之比。将最终答案表示为一个精确的实数。无需四舍五入。该比率无需单位。",
            "solution": "用户希望找到线性波动方程的有限元法（FEM）半离散化所产生的最大非零离散角频率平方之比，该比值是比较在单个等边三角形单元上使用集中质量矩阵公式与一致质量矩阵公式得到的结果。\n\n首先验证问题。\n\n### 步骤 1：提取已知条件\n- **控制方程**：$\\partial_{tt} \\eta = g H \\nabla^{2} \\eta$，其中 $\\eta$ 是自由表面高度，$g$ 是重力加速度，$H$ 是恒定的平均深度。\n- **离散化方法**：使用线性形函数 $N_i$ 的连续伽辽金（CG）有限元法（FEM）。\n- **区域**：边长为 $\\ell$ 的单个等边三角形单元 $T$。顶点位于 $(0,0)$、$(\\ell,0)$ 和 $(\\ell/2, \\sqrt{3}\\ell/2)$。\n- **一致质量矩阵**：$M_{ij} = \\int_{T} N_{i} N_{j} \\,\\mathrm{d}A$，记为 $M_c$。\n- **集中质量矩阵**：$M_{l} = \\mathrm{diag}(M_{c} \\mathbf{1})$，通过行和集中法形成。\n- **刚度矩阵**：$K_{ij} = \\int_{T} \\nabla N_{i} \\cdot \\nabla N_{j} \\,\\mathrm{d}A$，记为 $K$。\n- **半离散系统**：$M \\,\\ddot{\\eta} + g H \\, K \\,\\eta = 0$。\n- **特征问题**：$K x = \\lambda M x$，其中 $\\lambda = \\omega^2 / (gH)$，$\\omega$ 是角频率。\n- **目标**：计算比值 $\\frac{\\omega_{l, \\max}^2}{\\omega_{c, \\max}^2} = \\frac{\\lambda_{l, \\max}}{\\lambda_{c, \\max}}$，其中 $\\lambda_{\\max}$ 表示集中质量矩阵（$l$）和一致质量矩阵（$c$）情况下的最大非零特征值。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题基于标准的线性浅水波动方程和典型的连续伽辽金有限元法（FEM）公式。所有定义和方程都是标准的且科学上是合理的。\n- **适定性**：该问题提供了明确定义的几何形状、控制方程和离散化方法，并要求一个具体、可计算的量。存在唯一解。\n- **客观性**：该问题以精确的数学语言表述，没有歧义或主观论断。\n- 满足有效问题的所有其他标准。没有矛盾、缺失信息或不切实际的假设。\n\n### 步骤 3：结论与行动\n该问题是有效的。下面提供详细解答。\n\n### 解答\n任务是针对两种不同的质量矩阵 $M_c$（一致）和 $M_l$（集中），求解广义特征值问题 $K x = \\lambda M x$，然后求出它们最大非零特征值的比值。\n\n首先，我们建立单元矩阵 $K$、$M_c$ 和 $M_l$。对于线性三角形单元，这些矩阵具有标准形式。\n边长为 $\\ell$ 的等边三角形的面积是 $A = \\frac{1}{2} \\times \\text{底} \\times \\text{高} = \\frac{1}{2} \\ell \\left(\\frac{\\sqrt{3}}{2}\\ell\\right) = \\frac{\\sqrt{3}}{4}\\ell^2$。\n\n**1. 一致质量矩阵, $M_c$**\n一致质量矩阵的分量由 $M_{ij} = \\int_T N_i N_j \\, \\mathrm{d}A$ 给出。对于三角形上的线性形函数，标准积分公式得出：\n$$ \\int_T N_i^2 \\, \\mathrm{d}A = \\frac{A}{6} \\quad \\text{且} \\quad \\int_T N_i N_j \\, \\mathrm{d}A = \\frac{A}{12} \\quad (i \\neq j) $$\n因此，一致质量矩阵 $M_c$ 为：\n$$ M_c = \\frac{A}{12} \\begin{pmatrix} 2 & 1 & 1 \\\\ 1 & 2 & 1 \\\\ 1 & 1 & 2 \\end{pmatrix} $$\n代入面积 $A = \\frac{\\sqrt{3}}{4}\\ell^2$：\n$$ M_c = \\frac{\\sqrt{3}\\ell^2}{48} \\begin{pmatrix} 2 & 1 & 1 \\\\ 1 & 2 & 1 \\\\ 1 & 1 & 2 \\end{pmatrix} $$\n\n**2. 集中质量矩阵, $M_l$**\n集中质量矩阵 $M_l$ 是通过行和集中法得到的，$M_l = \\mathrm{diag}(M_c \\mathbf{1})$。首先，我们计算 $M_c$ 的行和：\n$$ M_c \\mathbf{1} = \\frac{A}{12} \\begin{pmatrix} 2 & 1 & 1 \\\\ 1 & 2 & 1 \\\\ 1 & 1 & 2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\frac{A}{12} \\begin{pmatrix} 4 \\\\ 4 \\\\ 4 \\end{pmatrix} = \\frac{A}{3} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} $$\n将这些和放在对角线上得到 $M_l$：\n$$ M_l = \\frac{A}{3} \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} = \\frac{A}{3} I $$\n代入面积 $A$：\n$$ M_l = \\frac{\\sqrt{3}\\ell^2}{12} I $$\n其中 $I$ 是 $3 \\times 3$ 的单位矩阵。\n\n**3. 刚度矩阵, $K$**\n刚度矩阵的分量为 $K_{ij} = \\int_T \\nabla N_i \\cdot \\nabla N_j \\, \\mathrm{d}A$。对于等边三角形，所有内角均为 $\\pi/3 = 60^\\circ$。使用边对角的余切值计算刚度矩阵元素的标准公式为：\n$$ K_{ij} = \\frac{1}{2} (\\cot \\alpha_k + \\cot \\alpha_j) \\quad (\\text{对于 } i=j) $$\n$$ K_{ij} = -\\frac{1}{2} \\cot \\alpha_k \\quad (\\text{对于 } i \\neq j, \\text{边 } ij \\text{ 相对的角为 } \\alpha_k) $$\n对于等边三角形，所有对角都是 $\\pi/3$，且 $\\cot(\\pi/3) = 1/\\sqrt{3}$。\n这得出：\n$$ K_{ii} = \\frac{1}{2} \\left(\\frac{1}{\\sqrt{3}} + \\frac{1}{\\sqrt{3}}\\right) = \\frac{1}{\\sqrt{3}} $$\n$$ K_{ij} = -\\frac{1}{2\\sqrt{3}} \\quad (i \\neq j) $$\n所以，刚度矩阵 $K$ 为：\n$$ K = \\frac{1}{2\\sqrt{3}} \\begin{pmatrix} 2 & -1 & -1 \\\\ -1 & 2 & -1 \\\\ -1 & -1 & 2 \\end{pmatrix} = \\frac{\\sqrt{3}}{6} \\begin{pmatrix} 2 & -1 & -1 \\\\ -1 & 2 & -1 \\\\ -1 & -1 & 2 \\end{pmatrix} $$\n\n**4. 一致质量矩阵的特征问题**\n我们必须求解 $Kx = \\lambda_c M_c x$。我们定义矩阵模式 $K' = \\begin{pmatrix} 2 & -1 & -1 \\\\ -1 & 2 & -1 \\\\ -1 & -1 & 2 \\end{pmatrix}$ 和 $M_c' = \\begin{pmatrix} 2 & 1 & 1 \\\\ 1 & 2 & 1 \\\\ 1 & 1 & 2 \\end{pmatrix}$。\n代入 $K$ 和 $M_c$ 的表达式：\n$$ \\frac{\\sqrt{3}}{6} K' x = \\lambda_c \\frac{\\sqrt{3}\\ell^2}{48} M_c' x $$\n$$ K' x = \\lambda_c \\left(\\frac{6\\ell^2}{48}\\right) M_c' x = \\lambda_c \\frac{\\ell^2}{8} M_c' x $$\n令 $\\mu_c = \\lambda_c \\frac{\\ell^2}{8}$。问题变成一个广义特征值问题 $K' x = \\mu_c M_c' x$。\n$K'$ 和 $M_c'$ 都是循环矩阵。它们可以被DFT矩阵同时对角化，广义系统的特征值 $\\mu_c$ 是 $K'$ 和 $M_c'$ 特征值的比值。\n$3 \\times 3$ 循环矩阵 $\\begin{pmatrix} c_0 & c_2 & c_1 \\\\ c_1 & c_0 & c_2 \\\\ c_2 & c_1 & c_0 \\end{pmatrix}$ 的特征值为 $c_0 + c_1\\omega^k + c_2\\omega^{2k}$，其中 $k=0,1,2$，$\\omega = \\exp(i2\\pi/3)$。\n对于 $K'$，$c_0=2, c_1=-1, c_2=-1$。其特征值 $\\sigma_k$ 为：\n$\\sigma_0 = 2 - 1 - 1 = 0$\n$\\sigma_1 = 2 - \\omega - \\omega^2 = 2 - (-1) = 3$\n$\\sigma_2 = 2 - \\omega^2 - \\omega^4 = 2 - \\omega^2 - \\omega = 3$\n对于 $M_c'$，$c_0=2, c_1=1, c_2=1$。其特征值 $\\nu_k$ 为：\n$\\nu_0 = 2 + 1 + 1 = 4$\n$\\nu_1 = 2 + \\omega + \\omega^2 = 2 + (-1) = 1$\n$\\nu_2 = 2 + \\omega^2 + \\omega^4 = 2 + \\omega^2 + \\omega = 1$\n特征值 $\\mu_c$ 是比值 $\\sigma_k / \\nu_k$：$\\{0/4, 3/1, 3/1\\} = \\{0, 3, 3\\}$。\n最大非零特征值为 $\\mu_{c, \\max} = 3$。\n我们从 $\\mu_{c, \\max} = \\lambda_{c, \\max} \\frac{\\ell^2}{8}$ 中求出 $\\lambda_{c, \\max}$：\n$$ \\lambda_{c, \\max} = \\frac{8 \\mu_{c, \\max}}{\\ell^2} = \\frac{8 \\times 3}{\\ell^2} = \\frac{24}{\\ell^2} $$\n\n**5. 集中质量矩阵的特征问题**\n我们现在求解 $Kx = \\lambda_l M_l x$。\n$$ \\frac{\\sqrt{3}}{6} K' x = \\lambda_l \\left(\\frac{\\sqrt{3}\\ell^2}{12} I\\right) x $$\n$$ K' x = \\lambda_l \\left(\\frac{6\\ell^2}{12}\\right) I x = \\lambda_l \\frac{\\ell^2}{2} x $$\n这是一个关于矩阵 $K'$ 的标准特征值问题。$K'$ 的特征值为 $\\sigma_k = \\{0, 3, 3\\}$。\n因此，$\\lambda_l \\frac{\\ell^2}{2}$ 的值必须是 $\\{0, 3, 3\\}$。\n最大非零特征值 $\\lambda_{l, \\max}$ 由最大非零 $\\sigma_k$ 求得：\n$$ \\lambda_{l, \\max} \\frac{\\ell^2}{2} = 3 $$\n$$ \\lambda_{l, \\max} = \\frac{6}{\\ell^2} $$\n\n**6. 计算比值**\n所求的比值是最大非零离散角频率平方的比值，这等价于特征值 $\\lambda$ 的比值。\n$$ \\text{比值} = \\frac{\\omega_{l, \\max}^2}{\\omega_{c, \\max}^2} = \\frac{\\lambda_{l, \\max}}{\\lambda_{c, \\max}} = \\frac{6/\\ell^2}{24/\\ell^2} = \\frac{6}{24} = \\frac{1}{4} $$",
            "answer": "$$\\boxed{\\frac{1}{4}}$$"
        },
        {
            "introduction": "在流体动力学等领域，混合有限元方法常用于同时求解速度和压力等多个场。然而，为不同变量选择的离散函数空间必须满足特定的相容性条件，即所谓的 Ladyzhenskaya–Babuška–Brezzi (LBB) 或 inf-sup 条件，以确保解的稳定性和唯一性。本练习将通过一个经典的例子，具体展示当使用不稳定的等阶单元（$Q_1$-$Q_1$）求解斯托克斯问题时，inf-sup 条件是如何被违反的，并导致非物理的棋盘状伪压力模式的出现 。",
            "id": "4042765",
            "problem": "考虑不可压缩斯托克斯子系统，它是许多用于数值天气预报 (NWP) 和气候模拟的静水海洋和大气公式中的核心组成部分：求解速度 $\\boldsymbol{u}$ 和压力 $p$，使得对于具有足够光滑的测试函数 $\\boldsymbol{v}$ 和 $q$ 的域 $\\Omega$，弱动量和质量守恒陈述成立：\n$$\n\\int_{\\Omega} \\nu \\nabla \\boldsymbol{u} : \\nabla \\boldsymbol{v} \\,\\mathrm{d}\\boldsymbol{x} + \\int_{\\Omega} p \\,\\nabla \\cdot \\boldsymbol{v} \\,\\mathrm{d}\\boldsymbol{x} = \\int_{\\Omega} \\boldsymbol{f} \\cdot \\boldsymbol{v} \\,\\mathrm{d}\\boldsymbol{x}, \\qquad \\int_{\\Omega} q \\,\\nabla \\cdot \\boldsymbol{u} \\,\\mathrm{d}\\boldsymbol{x} = 0,\n$$\n其中 $\\nu$ 是运动粘度，$\\boldsymbol{f}$ 是彻体力。在混合有限元法 (FEM) 离散化中，稳定性要求离散速度和压力空间之间满足 Ladyzhenskaya–Babuška–Brezzi (LBB) inf-sup 条件。已知在四边形网格上使用等阶双线性 ($Q_1$–$Q_1$) 单元会违反此条件，并在地球物理模型中使用的同位离散化中产生伪压力模式（棋盘格）。\n\n令 $\\Omega = [0,1] \\times [0,1]$，并考虑通过将 $\\Omega$ 细分为 $2 \\times 2$ 个相等正方形而获得的均匀四边形网格，因此节点坐标为 $(x_i,y_j)$，其中 $x_i \\in \\{0, \\tfrac{1}{2}, 1\\}$ 且 $y_j \\in \\{0, \\tfrac{1}{2}, 1\\}$。使用协调等阶 $Q_1$–$Q_1$ 空间：\n- 离散速度空间 $\\boldsymbol{V}_h \\subset [H_0^1(\\Omega)]^2$ 有两个分量，由在 $\\partial \\Omega$ 上为零的张量积双线性节点基函数张成（齐次狄利克雷边界条件）。\n- 离散压力空间 $Q_h \\subset L_0^2(\\Omega)$（零均值压力）由网格上相同的标量 $Q_1$ 节点基函数张成。\n\n定义 $[0,1]$ 上的标量 $Q_1$ 一维帽子函数 $\\{h_0, h_1, h_2\\}$ 为\n$$\nh_0(x) = \\begin{cases} 1 - 2x, & 0 \\le x \\le \\tfrac{1}{2}, \\\\ 0, & \\text{其他情况}, \\end{cases}\n\\quad\nh_1(x) = \\begin{cases} 2x, & 0 \\le x \\le \\tfrac{1}{2}, \\\\ 2(1-x), & \\tfrac{1}{2} \\le x \\le 1, \\\\ 0, & \\text{其他情况}, \\end{cases}\n\\quad\nh_2(x) = \\begin{cases} 2x - 1, & \\tfrac{1}{2} \\le x \\le 1, \\\\ 0, & \\text{其他情况}. \\end{cases}\n$$\n在 $y$ 方向上类似。在 $(x_i,y_j)$ 处的全局 $Q_1$ 节点基为 $N_{ij}(x,y) = h_i(x) h_j(y)$。唯一的内部速度基函数是\n$$\n\\boldsymbol{\\psi}_x(x,y) = \\big(h_1(x) h_1(y),\\, 0\\big), \\qquad \\boldsymbol{\\psi}_y(x,y) = \\big(0,\\, h_1(x) h_1(y)\\big),\n$$\n分别与内部节点 $(\\tfrac{1}{2},\\tfrac{1}{2})$ 的 $x$ 和 $y$ 分量相关联。\n\n构建离散棋盘格压力 $q_h \\in Q_h$，其节点值为 $p_{ij} = (-1)^{i+j}$，其中 $(i,j) \\in \\{0,1,2\\} \\times \\{0,1,2\\}$，并且\n$$\nq_h(x,y) = \\sum_{i=0}^{2} \\sum_{j=0}^{2} p_{ij} \\, h_i(x) h_j(y).\n$$\n使用伽辽金耦合 $b(\\boldsymbol{v}_h,q_h) = \\int_{\\Omega} q_h \\,\\nabla \\cdot \\boldsymbol{v}_h \\,\\mathrm{d}\\boldsymbol{x}$，显式计算\n$$\n\\sup_{\\boldsymbol{v}_h \\neq \\boldsymbol{0}} \\frac{b(\\boldsymbol{v}_h, q_h)}{\\|\\boldsymbol{v}_h\\|_{H^1(\\Omega)}}\n$$\n对于此网格上给定的 $q_h$ 的值，并由此推导出此网格和单元对所隐含的离散 inf-sup 下界 $\\beta_h$。将您的最终答案表示为单个实数。如果需要数值近似，将会提供四舍五-入的说明，但此处期望得到精确值。",
            "solution": "目标是计算表达式的值\n$$\n\\sup_{\\boldsymbol{v}_h \\neq \\boldsymbol{0}} \\frac{b(\\boldsymbol{v}_h, q_h)}{\\|\\boldsymbol{v}_h\\|_{H^1(\\Omega)}}\n$$\n其中 $b(\\boldsymbol{v}_h, q_h) = \\int_{\\Omega} q_h \\,\\nabla \\cdot \\boldsymbol{v}_h \\,\\mathrm{d}\\boldsymbol{x}$，针对特定的棋盘格压力模式 $q_h$ 和离散速度空间 $\\boldsymbol{V}_h$。\n\n域为 $\\Omega = [0,1] \\times [0,1]$。离散速度空间 $\\boldsymbol{V}_h \\subset [H_0^1(\\Omega)]^2$ 由在边界 $\\partial\\Omega$ 上为零的连续分片双线性函数组成。在给定的 $2 \\times 2$ 网格上，节点位于坐标 $(x_i, y_j)$ 处，其中 $x_i, y_j \\in \\{0, \\frac{1}{2}, 1\\}$。由于齐次狄利克雷边界条件，唯一不恒等于零的速度节点基函数是与单个内部节点 $(\\frac{1}{2}, \\frac{1}{2})$ 相关联的那些。因此，$\\boldsymbol{V}_h$ 的基由所提供的两个向量值函数给出：\n$$\n\\boldsymbol{\\psi}_x(x,y) = \\big(h_1(x) h_1(y),\\, 0\\big), \\qquad \\boldsymbol{\\psi}_y(x,y) = \\big(0,\\, h_1(x) h_1(y)\\big).\n$$\n任何函数 $\\boldsymbol{v}_h \\in \\boldsymbol{V}_h$ 都可以写成这些基函数的线性组合：\n$$\n\\boldsymbol{v}_h(x,y) = c_x \\boldsymbol{\\psi}_x(x,y) + c_y \\boldsymbol{\\psi}_y(x,y) = \\big(c_x h_1(x)h_1(y),\\, c_y h_1(x)h_1(y)\\big)\n$$\n对于某些实系数 $c_x$ 和 $c_y$。\n\n$\\boldsymbol{v}_h$ 的散度是\n$$\n\\nabla \\cdot \\boldsymbol{v}_h = \\frac{\\partial}{\\partial x}\\left(c_x h_1(x)h_1(y)\\right) + \\frac{\\partial}{\\partial y}\\left(c_y h_1(x)h_1(y)\\right) = c_x h_1'(x)h_1(y) + c_y h_1(x)h_1'(y).\n$$\n耦合项 $b(\\boldsymbol{v}_h, q_h)$ 于是为\n$$\nb(\\boldsymbol{v}_h, q_h) = \\int_{\\Omega} q_h(x,y) \\left(c_x h_1'(x)h_1(y) + c_y h_1(x)h_1'(y)\\right) \\,\\mathrm{d}x\\,\\mathrm{d}y.\n$$\n根据积分的线性性质，我们可以将其写为\n$$\nb(\\boldsymbol{v}_h, q_h) = c_x \\int_{\\Omega} q_h(x,y) h_1'(x)h_1(y) \\,\\mathrm{d}x\\,\\mathrm{d}y + c_y \\int_{\\Omega} q_h(x,y) h_1(x)h_1'(y) \\,\\mathrm{d}x\\,\\mathrm{d}y.\n$$\n压力模式 $q_h$ 由 $q_h(x,y) = \\sum_{i=0}^{2} \\sum_{j=0}^{2} p_{ij} \\, h_i(x) h_j(y)$ 给出，其中 $p_{ij} = (-1)^{i+j}$。要证明对于所有 $\\boldsymbol{v}_h \\in \\boldsymbol{V}_h$ 都有 $b(\\boldsymbol{v}_h, q_h) = 0$，我们必须证明上述表达式中的两个积分都为零。\n\n我们来计算第一个积分 $I_x$：\n$$\nI_x = \\int_{\\Omega} q_h(x,y) h_1'(x)h_1(y) \\,\\mathrm{d}x\\,\\mathrm{d}y = \\int_0^1 \\int_0^1 \\left(\\sum_{i=0}^2 \\sum_{j=0}^2 p_{ij} h_i(x)h_j(y)\\right) h_1'(x)h_1(y) \\,\\mathrm{d}x\\,\\mathrm{d}y.\n$$\n利用基函数的可分离性和 Fubini 定理：\n$$\nI_x = \\sum_{i=0}^2 \\sum_{j=0}^2 p_{ij} \\left(\\int_0^1 h_i(x)h_1'(x)\\,\\mathrm{d}x\\right) \\left(\\int_0^1 h_j(y)h_1(y)\\,\\mathrm{d}y\\right).\n$$\n我们定义一维积分 $A_i = \\int_0^1 h_i(x)h_1'(x)\\,\\mathrm{d}x$ 和 $B_j = \\int_0^1 h_j(y)h_1(y)\\,\\mathrm{d}y$。\n导数 $h_1'(x)$ 是一个分片常数函数：当 $x \\in (0, \\frac{1}{2})$ 时 $h_1'(x) = 2$，当 $x \\in (\\frac{1}{2}, 1)$ 时 $h_1'(x) = -2$。\n计算 $A_i$：\n$A_0 = \\int_0^{1/2} (1-2x)(2)\\,\\mathrm{d}x = [2x-2x^2]_0^{1/2} = 1 - \\frac{1}{2} = \\frac{1}{2}$。\n$A_1 = \\int_0^1 h_1(x)h_1'(x)\\,\\mathrm{d}x = \\frac{1}{2}\\int_0^1 \\frac{\\mathrm{d}}{\\mathrm{d}x}(h_1(x)^2)\\,\\mathrm{d}x = \\frac{1}{2}[h_1(x)^2]_0^1 = \\frac{1}{2}(0^2-0^2) = 0$。\n$A_2 = \\int_{1/2}^1 (2x-1)(-2)\\,\\mathrm{d}x = [-2x^2+2x]_{1/2}^1 = (-2+2) - (-\\frac{1}{2}+1) = -\\frac{1}{2}$。\n所以积分向量为 $\\boldsymbol{A} = [A_0, A_1, A_2]^T = [\\frac{1}{2}, 0, -\\frac{1}{2}]^T$。\n\n计算 $B_j$：\n$B_0 = \\int_0^{1/2} (1-2y)(2y)\\,\\mathrm{d}y = \\int_0^{1/2} (2y-4y^2)\\,\\mathrm{d}y = [y^2 - \\frac{4}{3}y^3]_0^{1/2} = \\frac{1}{4} - \\frac{4}{3}\\frac{1}{8} = \\frac{1}{4} - \\frac{1}{6} = \\frac{1}{12}$。\n$B_1 = \\int_0^1 h_1(y)^2\\,\\mathrm{d}y = \\int_0^{1/2} (2y)^2\\,\\mathrm{d}y + \\int_{1/2}^1 (2(1-y))^2\\,\\mathrm{d}y = [\\frac{4}{3}y^3]_0^{1/2} + 4[-\\frac{(1-y)^3}{3}]_{1/2}^1 = \\frac{4}{3}\\frac{1}{8} - \\frac{4}{3}(0 - (\\frac{1}{2})^3) = \\frac{1}{6} + \\frac{4}{3}\\frac{1}{8} = \\frac{1}{3}$。\n根据基函数关于 $x=\\frac{1}{2}$ 的对称性，$B_2 = \\int_{1/2}^1 h_2(y)h_1(y)\\,\\mathrm{d}y = \\int_0^{1/2} h_0(y)h_1(y)\\,\\mathrm{d}y = B_0 = \\frac{1}{12}$。\n所以积分向量为 $\\boldsymbol{B} = [B_0, B_1, B_2]^T = [\\frac{1}{12}, \\frac{1}{3}, \\frac{1}{12}]^T$。\n\n$I_x$ 的求和可以用矩阵形式表示为 $I_x = \\boldsymbol{B}^T \\boldsymbol{P} \\boldsymbol{A}$，其中 $\\boldsymbol{P}$ 是元素为 $p_{ij}$ 的矩阵。\n$$\n\\boldsymbol{P} = \\begin{pmatrix} 1 & -1 & 1 \\\\ -1 & 1 & -1 \\\\ 1 & -1 & 1 \\end{pmatrix}.\n$$\n首先，我们计算 $\\boldsymbol{P}\\boldsymbol{A}$：\n$$\n\\boldsymbol{P}\\boldsymbol{A} = \\begin{pmatrix} 1 & -1 & 1 \\\\ -1 & 1 & -1 \\\\ 1 & -1 & 1 \\end{pmatrix} \\begin{pmatrix} 1/2 \\\\ 0 \\\\ -1/2 \\end{pmatrix} = \\begin{pmatrix} 1(\\frac{1}{2}) - 1(0) + 1(-\\frac{1}{2}) \\\\ -1(\\frac{1}{2}) + 1(0) - 1(-\\frac{1}{2}) \\\\ 1(\\frac{1}{2}) - 1(0) + 1(-\\frac{1}{2}) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}.\n$$\n因此，$I_x = \\boldsymbol{B}^T (\\boldsymbol{P}\\boldsymbol{A}) = [\\frac{1}{12}, \\frac{1}{3}, \\frac{1}{12}] \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = 0$。\n\n现在，我们计算第二个积分 $I_y$：\n$$\nI_y = \\int_{\\Omega} q_h(x,y) h_1(x)h_1'(y) \\,\\mathrm{d}x\\,\\mathrm{d}y = \\sum_{i=0}^2 \\sum_{j=0}^2 p_{ij} \\left(\\int_0^1 h_i(x)h_1(x)\\,\\mathrm{d}x\\right) \\left(\\int_0^1 h_j(y)h_1'(y)\\,\\mathrm{d}y\\right).\n$$\n使用我们先前定义的积分，这可以表示为 $I_y = \\sum_{i,j} p_{ij} B_i A_j$。以矩阵形式表示，$I_y = \\boldsymbol{A}^T \\boldsymbol{P} \\boldsymbol{B}$。\n我们来计算 $\\boldsymbol{P}\\boldsymbol{B}$：\n$$\n\\boldsymbol{P}\\boldsymbol{B} = \\begin{pmatrix} 1 & -1 & 1 \\\\ -1 & 1 & -1 \\\\ 1 & -1 & 1 \\end{pmatrix} \\begin{pmatrix} 1/12 \\\\ 1/3 \\\\ 1/12 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{12} - \\frac{1}{3} + \\frac{1}{12} \\\\ -\\frac{1}{12} + \\frac{1}{3} - \\frac{1}{12} \\\\ \\frac{1}{12} - \\frac{1}{3} + \\frac{1}{12} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{6} - \\frac{1}{3} \\\\ -\\frac{1}{6} + \\frac{1}{3} \\\\ \\frac{1}{6} - \\frac{1}{3} \\end{pmatrix} = \\begin{pmatrix} -1/6 \\\\ 1/6 \\\\ -1/6 \\end{pmatrix}.\n$$\n然后，$I_y = \\boldsymbol{A}^T (\\boldsymbol{P}\\boldsymbol{B}) = [\\frac{1}{2}, 0, -\\frac{1}{2}] \\begin{pmatrix} -1/6 \\\\ 1/6 \\\\ -1/6 \\end{pmatrix} = (\\frac{1}{2})(-\\frac{1}{6}) + (0)(\\frac{1}{6}) + (-\\frac{1}{2})(-\\frac{1}{6}) = -\\frac{1}{12} + \\frac{1}{12} = 0$。\n\n由于积分 $I_x$ 和 $I_y$ 均为零，对于任何 $c_x$ 和 $c_y$ 的选择，我们都有 $b(\\boldsymbol{v}_h, q_h) = c_x \\cdot 0 + c_y \\cdot 0 = 0$。这表明对于给定的棋盘格压力模式 $q_h$，耦合项 $b(\\boldsymbol{v}_h, q_h)$ 对离散速度空间 $\\boldsymbol{V}_h$ 中的所有函数 $\\boldsymbol{v}_h$ 恒等于零。\n\n需要计算的表达式是 $\\sup_{\\boldsymbol{v}_h \\neq \\boldsymbol{0}} \\frac{b(\\boldsymbol{v}_h, q_h)}{\\|\\boldsymbol{v}_h\\|_{H^1(\\Omega)}}$。\n由于对于任何 $\\boldsymbol{v}_h \\in \\boldsymbol{V}_h$，分子 $b(\\boldsymbol{v}_h, q_h)$ 都为 $0$，而对于任何 $\\boldsymbol{v}_h \\neq \\boldsymbol{0}$，分母 $\\|\\boldsymbol{v}_h\\|_{H^1(\\Omega)}$ 都是严格为正的，所以该分式总是 $0$。一个只包含值 $0$ 的集合的上确界是 $0$。\n\n因此，上确界的值为 $0$。\n\n该问题还要求推导所隐含的离散 inf-sup 下界 $\\beta_h$。Ladyzhenskaya–Babuška–Brezzi (LBB) 条件要求存在一个常数 $\\beta_h > 0$ 使得：\n$$\n\\inf_{q_h \\in Q_h^0, q_h \\neq \\boldsymbol{0}} \\sup_{\\boldsymbol{v}_h \\in \\boldsymbol{V}_h, \\boldsymbol{v}_h \\neq \\boldsymbol{0}} \\frac{b(\\boldsymbol{v}_h, q_h)}{\\|\\boldsymbol{v}_h\\|_{H^1(\\Omega)}\\|q_h\\|_{L^2(\\Omega)}} \\ge \\beta_h.\n$$\n我们找到了一个特定的非零压力模式 $q_h$（它非零是因为其节点值不全为零，并且根据 $q_h \\in Q_h \\subset L_0^2(\\Omega)$ 的要求，其均值为零），对于该模式，项 $\\sup_{\\boldsymbol{v}_h \\neq \\boldsymbol{0}} \\frac{b(\\boldsymbol{v}_h, q_h)}{\\|\\boldsymbol{v}_h\\|_{H^1(\\Omega)}}$ 精确为 $0$。\n这意味着对于这个特定的 $q_h$，下确界内的项 $\\frac{\\sup(\\dots)}{\\|q_h\\|_{L^2(\\Omega)}}$ 也为 $0$。\n由于下确界是在一个包含 $0$ 的非负值集合上取的，所以下确界必须是 $0$。这意味着对于这种网格和有限元空间的选择，inf-sup 常数 $\\beta_h = 0$。这违反了稳定性条件 $\\beta_h > 0$，从而证实了 $Q_1-Q_1$ 单元对对于斯托克斯问题的已知不稳定性。按要求显式计算的值是上确界的值，即 $0$。",
            "answer": "$$\\boxed{0}$$"
        }
    ]
}