{
    "hands_on_practices": [
        {
            "introduction": "The primary challenge in implementing superparameterization is its immense computational cost, largely driven by the stability constraints of the embedded Cloud-Resolving Model (CRM). This exercise delves into the Courant–Friedrichs–Lewy (CFL) condition, which dictates the maximum stable time step for explicit numerical schemes. By calculating the time step limits imposed by different physical processes and grid scales, you will identify the single most restrictive constraint that governs the entire coupled model's integration speed .",
            "id": "4096898",
            "problem": "In a superparameterized numerical weather and climate model, each grid column of the host Global Climate Model (GCM) contains an embedded two-dimensional Cloud-Resolving Model (CRM) that is integrated explicitly without directional splitting. The CRM resolves internal gravity waves and advection. The large-scale GCM dynamics also include fast external gravity waves.\n\nStarting from the Courant–Friedrichs–Lewy (CFL) stability condition for explicit time stepping applied to linearized hyperbolic dynamics (advection and gravity-wave propagation), derive the allowable explicit time step in the vertical and horizontal directions of the CRM and for the large-scale GCM horizontal dynamics by identifying the relevant characteristic speeds and grid spacings. Then determine the single limiting explicit time step that must be respected by the coupled superparameterized system (i.e., the minimum among the CRM vertical constraint, the CRM horizontal constraint, and the host GCM horizontal constraint).\n\nUse the following scientifically plausible parameters:\n- CRM fastest internal gravity wave phase speed: $c_{g} = 48 \\,\\text{m s}^{-1}$.\n- CRM vertical grid spacing: $\\Delta z = 32 \\,\\text{m}$.\n- CRM horizontal grid spacing: $\\Delta x = 1000 \\,\\text{m}$.\n- Maximum resolved CRM horizontal advection speed: $U_{\\max} = 22 \\,\\text{m s}^{-1}$.\n- GCM horizontal grid spacing: $\\Delta X = 25000 \\,\\text{m}$.\n- GCM fastest external gravity wave speed: $c_{\\text{ext}} = 300 \\,\\text{m s}^{-1}$.\n\nAssume the explicit scheme requires a Courant number less than one in each direction based on the maximum characteristic speed present in that direction, and that the coupled scheme uses a single global explicit time step that must satisfy all directional and component constraints simultaneously. Compute the limiting explicit time step $\\delta t_{\\text{lim}}$. Express your final answer in seconds and round your answer to four significant figures.",
            "solution": "The problem requires the determination of the limiting explicit time step for a superparameterized numerical model, which consists of a host Global Climate Model (GCM) and embedded Cloud-Resolving Models (CRMs). The stability of the explicit time-stepping scheme is governed by the Courant–Friedrichs–Lewy (CFL) condition.\n\nThe CFL condition for a one-dimensional linear hyperbolic partial differential equation, which describes processes like advection and wave propagation, states that the numerical domain of dependence must contain the physical domain of dependence. For a simple explicit finite-difference scheme, this can be expressed in terms of the Courant number, $C$. The condition is typically given by $C \\le 1$. The Courant number is defined as:\n$$C = \\frac{v_{\\text{char}} \\delta t}{\\delta s}$$\nwhere $v_{\\text{char}}$ is the characteristic speed of the fastest propagating signal, $\\delta t$ is the time step, and $\\delta s$ is the grid spacing in the direction of propagation. To ensure stability, the time step must satisfy:\n$$\\delta t \\le \\frac{\\delta s}{v_{\\text{char}}}$$\n\nWe must apply this condition to all relevant processes and spatial directions within the coupled model. The problem specifies three distinct constraints that must be evaluated.\n\n1.  **CRM Vertical Constraint:**\n    In the vertical direction of the CRM, the fastest propagating signals are the internal gravity waves. The problem states the fastest internal gravity wave phase speed is $c_g$ and the vertical grid spacing is $\\Delta z$. Therefore, the characteristic speed is $v_{\\text{char}, z} = c_g$. The maximum allowable time step based on this vertical constraint, $\\delta t_{CRM, z}$, is:\n    $$\\delta t \\le \\frac{\\Delta z}{c_g}$$\n    Substituting the given values:\n    $c_{g} = 48 \\,\\text{m s}^{-1}$\n    $\\Delta z = 32 \\,\\text{m}$\n    $$\\delta t_{CRM, z} \\le \\frac{32 \\,\\text{m}}{48 \\,\\text{m s}^{-1}} = \\frac{2}{3} \\,\\text{s} \\approx 0.6667 \\,\\text{s}$$\n\n2.  **CRM Horizontal Constraint:**\n    In the horizontal direction of the CRM, two processes contribute to the propagation of signals: advection by the resolved flow and the horizontal propagation of internal gravity waves. The problem states that the maximum resolved horizontal advection speed is $U_{\\max}$ and the internal gravity wave speed is $c_g$. For a linear system, the fastest-moving signal will have a speed equal to the sum of the advection speed and the wave phase speed (for a wave propagating in the same direction as the flow). Thus, the characteristic speed in the horizontal direction of the CRM is $v_{\\text{char}, x} = U_{\\max} + c_g$. The horizontal grid spacing is $\\Delta x$. The maximum allowable time step based on this horizontal constraint, $\\delta t_{CRM, x}$, is:\n    $$\\delta t \\le \\frac{\\Delta x}{U_{\\max} + c_g}$$\n    Substituting the given values:\n    $\\Delta x = 1000 \\,\\text{m}$\n    $U_{\\max} = 22 \\,\\text{m s}^{-1}$\n    $c_g = 48 \\,\\text{m s}^{-1}$\n    $$\\delta t_{CRM, x} \\le \\frac{1000 \\,\\text{m}}{22 \\,\\text{m s}^{-1} + 48 \\,\\text{m s}^{-1}} = \\frac{1000 \\,\\text{m}}{70 \\,\\text{m s}^{-1}} = \\frac{100}{7} \\,\\text{s} \\approx 14.2857 \\,\\text{s}$$\n\n3.  **GCM Horizontal Constraint:**\n    The host GCM has its own dynamics, which include fast external gravity waves. These waves typically propagate much faster than large-scale advective flows and thus set the time step limit for explicit GCMs. The problem gives the fastest external gravity wave speed as $c_{\\text{ext}}$ and the GCM horizontal grid spacing as $\\Delta X$. The characteristic speed is $v_{\\text{char}, X} = c_{\\text{ext}}$. The corresponding maximum allowable time step, $\\delta t_{GCM, X}$, is:\n    $$\\delta t \\le \\frac{\\Delta X}{c_{\\text{ext}}}$$\n    Substituting the given values:\n    $\\Delta X = 25000 \\,\\text{m}$\n    $c_{\\text{ext}} = 300 \\,\\text{m s}^{-1}$\n    $$\\delta t_{GCM, X} \\le \\frac{25000 \\,\\text{m}}{300 \\,\\text{m s}^{-1}} = \\frac{250}{3} \\,\\text{s} \\approx 83.3333 \\,\\text{s}$$\n\n**Limiting Time Step for the Coupled System:**\nThe superparameterized model uses a single global explicit time step, $\\delta t$, which must satisfy all three stability constraints simultaneously to ensure numerical stability throughout the entire system. Therefore, the chosen time step must be less than or equal to the minimum of the three individual maximums. The limiting explicit time step, $\\delta t_{\\text{lim}}$, is:\n$$\\delta t_{\\text{lim}} = \\min(\\delta t_{CRM, z}, \\delta t_{CRM, x}, \\delta t_{GCM, X})$$\nSubstituting the calculated values:\n$$\\delta t_{\\text{lim}} = \\min \\left( \\frac{2}{3} \\,\\text{s}, \\frac{100}{7} \\,\\text{s}, \\frac{250}{3} \\,\\text{s} \\right)$$\nTo compare these values, we can use their decimal approximations:\n$\\delta t_{CRM, z} \\approx 0.6667 \\,\\text{s}$\n$\\delta t_{CRM, x} \\approx 14.2857 \\,\\text{s}$\n$\\delta t_{GCM, X} \\approx 83.3333 \\,\\text{s}$\n\nThe minimum of these values is clearly the one associated with the vertical propagation of internal gravity waves in the CRM:\n$$\\delta t_{\\text{lim}} = \\frac{2}{3} \\,\\text{s}$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\\delta t_{\\text{lim}} \\approx 0.666666... \\,\\text{s}$$\nRounding this value to four significant figures gives $0.6667 \\,\\text{s}$. This result highlights a key challenge in superparameterization: the explicit time step for the entire coupled system is often severely constrained by the fine-scale, fast processes in the embedded CRM, particularly by vertically propagating waves in high-resolution vertical grids.",
            "answer": "$$\\boxed{0.6667}$$"
        },
        {
            "introduction": "Beyond computational time, superparameterization also places heavy demands on system memory. Embedding a high-resolution, multi-variable CRM within every column of a General Circulation Model (GCM) can lead to a massive memory footprint. This practice guides you through calculating this memory cost and introduces fundamental concepts in high-performance computing, such as data layout choices that are critical for optimizing performance on modern processors .",
            "id": "4096886",
            "problem": "In a superparameterization framework for numerical weather prediction and climate modeling, a Cloud-Resolving Model (CRM) is embedded within each column of a General Circulation Model (GCM). Consider a two-dimensional CRM domain with $N_x$ horizontal points and $N_z$ vertical levels. The CRM stores a set of prognostic state variables at every grid point: the three velocity components $u$, $v$, $w$, the potential temperature $\\theta$, and the water vapor mixing ratio $q_v$. In addition, the CRM carries $K$ passive tracers that are advected and diffused but do not feed back to dynamics or thermodynamics.\n\nAssume that:\n- Every stored variable is represented in $64$-bit binary floating point format compliant with Institute of Electrical and Electronics Engineers (IEEE) $754$, so each value occupies $8$ bytes.\n- No halo or ghost-cell padding is used, and only the physical domain of size $N_x \\times N_z$ is allocated for each array.\n- The CRM stores only the primary state variables as described and does not allocate separate tendency, workspace, or diagnostic arrays.\n\nStarting from the definition that total memory is the product of the number of stored elements and the bytes per element, derive an exact symbolic expression for the total memory footprint per CRM, measured in mebibytes (MiB), where $1$ mebibyte equals $2^{20}$ bytes. Express your final answer solely in terms of $K$, $N_x$, and $N_z$.\n\nThen, discuss data layout choices that optimize cache performance on modern processors, comparing a structure-of-arrays versus an array-of-structures approach, and the implications of choosing $N_x$ or $N_z$ as the stride-$1$ (contiguous) dimension. The discussion should be qualitative and grounded in first principles of spatial and temporal locality, without referring to specific compiler or hardware details.\n\nProvide the final memory footprint as an exact symbolic expression in MiB. Do not approximate or round.",
            "solution": "The solution is presented in two parts. First, we derive the symbolic expression for the memory footprint. Second, we discuss the implications of data layout choices.\n\n**Part 1: Derivation of Memory Footprint**\n\nThe total memory footprint of the Cloud-Resolving Model (CRM) is determined by the product of the total number of stored numerical values and the memory size of each value. We proceed step-by-step.\n\n1.  **Total Number of Grid Points:** The CRM domain is a two-dimensional grid with $N_x$ horizontal points and $N_z$ vertical levels. Assuming every grid cell stores state variables, the total number of grid points is the product of the dimensions:\n    $$ \\text{Total Grid Points} = N_x \\times N_z $$\n\n2.  **Number of Variables per Grid Point:** At each grid point, the model stores a set of state variables. These are given as:\n    - $3$ velocity components: $u$, $v$, $w$.\n    - $1$ potential temperature: $\\theta$.\n    - $1$ water vapor mixing ratio: $q_v$.\n    - $K$ passive tracers.\n    The total number of variables stored at each grid point is the sum of these, which is $3 + 1 + 1 + K$.\n    $$ \\text{Variables per Grid Point} = 5 + K $$\n\n3.  **Total Number of Stored Elements:** The total number of individual floating-point values stored by the CRM is the product of the total number of grid points and the number of variables per grid point.\n    $$ \\text{Total Stored Elements} = (\\text{Total Grid Points}) \\times (\\text{Variables per Grid Point}) = (N_x N_z) \\times (5 + K) $$\n\n4.  **Total Memory in Bytes:** Each stored element is a $64$-bit binary floating-point number, which occupies $8$ bytes of memory. The total memory footprint in bytes is therefore:\n    $$ \\text{Memory (bytes)} = (\\text{Total Stored Elements}) \\times (\\text{Bytes per Element}) $$\n    $$ \\text{Memory (bytes)} = (5 + K) N_x N_z \\times 8 $$\n\n5.  **Total Memory in Mebibytes (MiB):** The problem requires the answer in mebibytes (MiB), where $1 \\text{ MiB} = 2^{20}$ bytes. We convert the total memory from bytes to MiB by dividing by $2^{20}$.\n    $$ \\text{Memory (MiB)} = \\frac{\\text{Memory (bytes)}}{2^{20}} = \\frac{8 (5 + K) N_x N_z}{2^{20}} $$\n    Since $8 = 2^3$, we can simplify the expression:\n    $$ \\text{Memory (MiB)} = \\frac{2^3 (5 + K) N_x N_z}{2^{20}} = (5 + K) N_x N_z \\times 2^{3-20} = (5 + K) N_x N_z \\times 2^{-17} $$\n    This is the exact symbolic expression for the total memory footprint per CRM in mebibytes.\n\n**Part 2: Discussion of Data Layout Choices**\n\nThe arrangement of data in memory has profound implications for the performance of numerical models on modern computer architectures, which rely on a deep memory hierarchy (registers, L1/L2/L3 caches, main memory). Efficient use of the cache is paramount and is achieved by maximizing locality of reference, particularly spatial locality, which posits that data elements that are close in memory are likely to be accessed close in time. We analyze the specified layout choices based on this principle.\n\n**Structure-of-Arrays (SoA) versus Array-of-Structures (AoS):**\n\nAn SoA layout allocates a separate, contiguous block of memory (an array) for each state variable. For this problem, we would have $5+K$ distinct arrays, e.g., `double u[Nx][Nz]`, `double v[Nx][Nz]`, etc. In this layout, all values of a single field, say potential temperature $\\theta$, are grouped together in memory. This layout is highly advantageous for operations that are performed on-mass across all grid points for a single variable, such as calculating a spatial derivative or applying a horizontal diffusion operator. When the code iterates over all points to update $\\theta$, it can stream through the `theta` array with a regular, predictable access pattern. This maximizes spatial locality for that operation, allows the hardware prefetcher to work effectively, and is highly amenable to Single Instruction, Multiple Data (SIMD) vectorization, where a single instruction can be applied to a vector of data (e.g., $4$ or $8$ adjacent $\\theta$ values) simultaneously.\n\nAn AoS layout, conversely, groups all variables for a single grid point into a structure, and then creates an array of these structures. For this problem, one would define `struct State { double u, v, w, ...; };` and then declare `State grid[Nx][Nz]`. In this layout, `grid[i][j].u` and `grid[i][j].v` are adjacent in memory. This layout excels at providing spatial locality for point-wise or \"vertical\" computations, where multiple fields are needed at the same grid location. For instance, a cloud microphysics parameterization might require $\\theta$, $q_v$, and $w$ at a specific point `(i, j)` to compute tendencies. With AoS, fetching the first variable, e.g., $\\theta$, likely loads the other required variables into the same cache line, resulting in subsequent fast cache hits. The primary drawback of AoS is poor performance for field-wise operations. Accessing all `u` values requires striding across memory, jumping over all the other interleaved variables, which disrupts spatial locality, defeats SIMD vectorization, and pollutes the cache with data that is not immediately needed.\n\nIn atmospheric models, both types of operations exist. Dynamics solvers often favor SoA, while physics parameterizations (radiation, microphysics) favor AoS. The choice is a trade-off, and some modern frameworks even use hybrid AoSoA (Array-of-Structures-of-Arrays) layouts to balance these competing demands.\n\n**Choice of Stride-1 (Contiguous) Dimension:**\n\nThe stride-1 dimension is the one whose elements are arranged contiguously in memory. For a 2D array, this choice determines whether rows or columns are stored sequentially. The decision should be guided by the dominant computational access pattern.\n\nIn atmospheric models, many of the most computationally intensive processes, such as a parameterizations for convection, radiation, and boundary layer turbulence, operate on vertical columns of the model grid. That is, for a fixed horizontal position $(i)$, the algorithm iterates through all vertical levels $j$ from $1$ to $N_z$. This is often termed \"column physics.\" To optimize for these operations, it is critical that data within a vertical column be contiguous in memory.\n\nIf the vertical dimension ($N_z$) is chosen as the stride-$1$ dimension, then the data for a column at horizontal position $i$, i.e., `(i, 1), (i, 2), ..., (i, Nz)`, will be laid out sequentially. When the column physics module processes this column, it reads from and writes to memory with a unit stride, which is the most efficient access pattern. This ensures maximal use of cache lines and enables effective hardware prefetching.\n\nConversely, if the horizontal dimension ($N_x$) were chosen as the stride-$1$ dimension, the data in a vertical column would be separated by a stride of $N_x$ elements. For typical model resolutions where $N_x$ can be large, this access pattern would lead to very poor cache performance, as each access might fetch a new cache line, only to use one element from it before jumping to another memory location. While a contiguous $N_x$ dimension would benefit purely horizontal operations, the computational cost of column physics is typically so dominant that it dictates the optimal data layout. Therefore, in virtually all production-level weather and climate models, the vertical dimension is made the contiguous, stride-$1$ dimension.",
            "answer": "$$\\boxed{(5 + K) N_x N_z \\times 2^{-17}}$$"
        },
        {
            "introduction": "The core rationale for superparameterization is to improve physical fidelity, but this goal is in constant tension with computational cost. Modelers must make difficult choices about the CRM's resolution, balancing the need to resolve fine-scale convective processes against practical resource limitations. This problem provides a quantitative framework for exploring this trade-off, using a spectral representation to estimate the loss in resolved convective heating that occurs when the CRM grid is coarsened to save computational expense .",
            "id": "4096921",
            "problem": "A global atmospheric General Circulation Model (GCM) employs superparameterization by embedding a two-dimensional Cloud-Resolving Model (CRM) with horizontal coordinate $x$ and vertical coordinate $z$ within each GCM column. The CRM domain has fixed horizontal length $L$ and periodic lateral boundary conditions. The CRM prognoses the domain-mean convective heating rate $Q$ (in Kelvin per day) as the horizontal average of the vertical convergence of moist static energy flux, which, for a horizontally homogeneous and stationary state, can be represented spectrally as\n$$\nQ \\;=\\; \\int_{k_{\\min}}^{k_{\\mathrm{N}}} S_Q(k)\\,\\mathrm{d}k,\n$$\nwhere $k$ is the horizontal wavenumber, $k_{\\min} = \\frac{2\\pi}{L}$ is the fundamental wavenumber of the domain, $k_{\\mathrm{N}} = \\frac{\\pi}{\\Delta x_{\\mathrm{CRM}}}$ is the Nyquist wavenumber set by the CRM grid spacing $\\Delta x_{\\mathrm{CRM}}$, and $S_Q(k)$ is the cross-spectral density that quantifies the contribution of scale $k$ to $Q$.\n\nAssume the following scientifically plausible and widely used spectral scaling for inertial-range convective transport:\n$$\nS_Q(k) \\;=\\; A\\,k^{-p}, \\quad p \\;=\\; \\frac{5}{3}, \\quad k \\in [k_{\\min},\\,k_{\\mathrm{N}}],\n$$\nwith constant amplitude $A>0$. In a baseline configuration with $\\Delta x_{\\mathrm{CRM}} = \\Delta x_0$, the model has $L = 128\\,\\mathrm{km}$ and $\\Delta x_0 = 1\\,\\mathrm{km}$, and the diagnosed domain-mean convective heating rate is $Q_0 = 4\\,\\mathrm{K\\,day^{-1}}$. To reduce computational cost, modelers consider doubling the CRM grid spacing to $\\Delta x_1 = 2\\,\\mathrm{km}$ while keeping $L$ fixed, which halves $k_{\\mathrm{N}}$.\n\nStarting from the spectral definition of $Q$ and the given scaling, and using only standard sampling theory (Nyquist wavenumber) and power-law integration, derive an expression for the absolute error $\\Delta Q = Q_0 - Q_1$ introduced in the domain-mean heating rate by doubling $\\Delta x_{\\mathrm{CRM}}$ from $\\Delta x_0$ to $\\Delta x_1$. Then evaluate $\\Delta Q$ numerically under the given parameters. Express your final answer in $\\mathrm{K\\,day^{-1}}$ and round your answer to four significant figures.\n\nAdditionally, briefly analyze, from first principles, how the computational cost per fixed wall-clock simulation time scales with $\\Delta x_{\\mathrm{CRM}}$ for an explicit time-stepping scheme constrained by a Courant–Friedrichs–Lewy (CFL) condition with a characteristic wave speed $c$ and Courant number $C_{\\mathrm{CFL}}$; no numerical value is required for this part.",
            "solution": "### Derivation and Calculation\n\nThe domain-mean convective heating rate $Q$ is given by the integral of the spectral density $S_Q(k)$ from the fundamental wavenumber $k_{\\min}$ to the Nyquist wavenumber $k_{\\mathrm{N}}$:\n$$\nQ = \\int_{k_{\\min}}^{k_{\\mathrm{N}}} S_Q(k)\\,\\mathrm{d}k\n$$\nSubstituting the given power-law scaling $S_Q(k) = A\\,k^{-p}$ with $p = 5/3$:\n$$\nQ = \\int_{k_{\\min}}^{k_{\\mathrm{N}}} A\\,k^{-5/3}\\,\\mathrm{d}k\n$$\nPerforming the integration:\n$$\nQ = A \\left[ \\frac{k^{-5/3 + 1}}{-5/3 + 1} \\right]_{k_{\\min}}^{k_{\\mathrm{N}}} = A \\left[ \\frac{k^{-2/3}}{-2/3} \\right]_{k_{\\min}}^{k_{\\mathrm{N}}} = -\\frac{3A}{2} \\left[ k^{-2/3} \\right]_{k_{\\min}}^{k_{\\mathrm{N}}}\n$$\n$$\nQ = \\frac{3A}{2} (k_{\\min}^{-2/3} - k_{\\mathrm{N}}^{-2/3})\n$$\nThis general expression relates the heating rate $Q$ to the model parameters $L$ (via $k_{\\min}$) and $\\Delta x_{\\mathrm{CRM}}$ (via $k_{\\mathrm{N}}$).\n\nFor the baseline configuration (subscript $0$), we have $Q_0$, $k_{\\min}$, and $k_{\\mathrm{N},0} = \\frac{\\pi}{\\Delta x_0}$.\n$$\nQ_0 = \\frac{3A}{2} (k_{\\min}^{-2/3} - k_{\\mathrm{N},0}^{-2/3})\n$$\nWe can solve for the term $\\frac{3A}{2}$:\n$$\n\\frac{3A}{2} = \\frac{Q_0}{k_{\\min}^{-2/3} - k_{\\mathrm{N},0}^{-2/3}}\n$$\nFor the modified configuration (subscript $1$), the grid spacing is changed to $\\Delta x_1$, resulting in a new Nyquist wavenumber $k_{\\mathrm{N},1} = \\frac{\\pi}{\\Delta x_1}$. The heating rate $Q_1$ is:\n$$\nQ_1 = \\frac{3A}{2} (k_{\\min}^{-2/3} - k_{\\mathrm{N},1}^{-2/3})\n$$\nThe absolute error $\\Delta Q$ is the difference $Q_0 - Q_1$:\n$$\n\\Delta Q = Q_0 - Q_1 = \\frac{3A}{2} (k_{\\min}^{-2/3} - k_{\\mathrm{N},0}^{-2/3}) - \\frac{3A}{2} (k_{\\min}^{-2/3} - k_{\\mathrm{N},1}^{-2/3})\n$$\n$$\n\\Delta Q = \\frac{3A}{2} (k_{\\mathrm{N},1}^{-2/3} - k_{\\mathrm{N},0}^{-2/3})\n$$\nNow, substitute the expression for $\\frac{3A}{2}$ derived from the baseline case:\n$$\n\\Delta Q = \\left( \\frac{Q_0}{k_{\\min}^{-2/3} - k_{\\mathrm{N},0}^{-2/3}} \\right) (k_{\\mathrm{N},1}^{-2/3} - k_{\\mathrm{N},0}^{-2/3})\n$$\nThis gives the desired analytical expression for the error $\\Delta Q$:\n$$\n\\Delta Q = Q_0 \\frac{k_{\\mathrm{N},1}^{-2/3} - k_{\\mathrm{N},0}^{-2/3}}{k_{\\min}^{-2/3} - k_{\\mathrm{N},0}^{-2/3}}\n$$\nTo evaluate this numerically, we first compute the wavenumbers using the given parameters: $L = 128\\,\\mathrm{km}$, $\\Delta x_0 = 1\\,\\mathrm{km}$, and $\\Delta x_1 = 2\\,\\mathrm{km}$.\n$$\nk_{\\min} = \\frac{2\\pi}{L} = \\frac{2\\pi}{128} = \\frac{\\pi}{64}\\,\\mathrm{km}^{-1}\n$$\n$$\nk_{\\mathrm{N},0} = \\frac{\\pi}{\\Delta x_0} = \\frac{\\pi}{1} = \\pi\\,\\mathrm{km}^{-1}\n$$\n$$\nk_{\\mathrm{N},1} = \\frac{\\pi}{\\Delta x_1} = \\frac{\\pi}{2}\\,\\mathrm{km}^{-1}\n$$\nSubstituting these into the expression for $\\Delta Q$:\n$$\n\\Delta Q = Q_0 \\frac{(\\frac{\\pi}{2})^{-2/3} - (\\pi)^{-2/3}}{(\\frac{\\pi}{64})^{-2/3} - (\\pi)^{-2/3}}\n$$\nThe factor of $\\pi^{-2/3}$ can be factored out from both the numerator and denominator and canceled:\n$$\n\\Delta Q = Q_0 \\frac{\\pi^{-2/3} ((\\frac{1}{2})^{-2/3} - 1^{-2/3})}{\\pi^{-2/3} ((\\frac{1}{64})^{-2/3} - 1^{-2/3})} = Q_0 \\frac{2^{2/3} - 1}{64^{2/3} - 1}\n$$\nWe can evaluate $64^{2/3}$ as $(64^{1/3})^2 = 4^2 = 16$.\n$$\n\\Delta Q = Q_0 \\frac{2^{2/3} - 1}{16 - 1} = Q_0 \\frac{2^{2/3} - 1}{15}\n$$\nNow, we substitute the value of $Q_0 = 4\\,\\mathrm{K\\,day^{-1}}$:\n$$\n\\Delta Q = 4 \\times \\frac{2^{2/3} - 1}{15}\n$$\nUsing a calculator, $2^{2/3} \\approx 1.58740105$.\n$$\n\\Delta Q \\approx 4 \\times \\frac{1.58740105 - 1}{15} = 4 \\times \\frac{0.58740105}{15} = \\frac{2.3496042}{15} \\approx 0.15664028\\,\\mathrm{K\\,day^{-1}}\n$$\nRounding to four significant figures, the absolute error is $\\Delta Q = 0.1566\\,\\mathrm{K\\,day^{-1}}$.\n\n### Computational Cost Scaling Analysis\n\nThe computational cost $\\mathcal{C}$ for a fixed wall-clock simulation time $T_{\\mathrm{sim}}$ is proportional to the total number of grid points in the CRM and the total number of time steps required.\nThe total number of grid points is $N_{\\mathrm{grid}} = N_x \\times N_z$, where $N_x = L / \\Delta x_{\\mathrm{CRM}}$ is the number of horizontal grid points and $N_z$ is the number of vertical grid points. We assume $L$ and $N_z$ are constant.\n$$\nN_{\\mathrm{grid}} \\propto N_x = \\frac{L}{\\Delta x_{\\mathrm{CRM}}} \\propto (\\Delta x_{\\mathrm{CRM}})^{-1}\n$$\nFor an explicit time-stepping scheme, the time step size $\\Delta t$ is constrained by the Courant–Friedrichs–Lewy (CFL) condition:\n$$\nC_{\\mathrm{CFL}} = \\frac{c\\,\\Delta t}{\\Delta x_{\\mathrm{CRM}}} \\le C_{\\mathrm{max}}\n$$\nwhere $c$ is a characteristic wave speed and $C_{\\mathrm{max}}$ is the Courant number stability limit. To maximize efficiency, one chooses $\\Delta t$ at this limit, so $\\Delta t = \\frac{C_{\\mathrm{max}}}{c} \\Delta x_{\\mathrm{CRM}}$. Therefore, the time step is directly proportional to the grid spacing:\n$$\n\\Delta t \\propto \\Delta x_{\\mathrm{CRM}}\n$$\nThe number of time steps $N_t$ required to simulate a fixed duration $T_{\\mathrm{sim}}$ is $N_t = T_{\\mathrm{sim}} / \\Delta t$.\n$$\nN_t \\propto \\frac{1}{\\Delta t} \\propto (\\Delta x_{\\mathrm{CRM}})^{-1}\n$$\nThe total computational cost $\\mathcal{C}$ is the product of the cost per time step (proportional to $N_{\\mathrm{grid}}$) and the number of time steps ($N_t$):\n$$\n\\mathcal{C} \\propto N_{\\mathrm{grid}} \\times N_t \\propto (\\Delta x_{\\mathrm{CRM}})^{-1} \\times (\\Delta x_{\\mathrm{CRM}})^{-1} = (\\Delta x_{\\mathrm{CRM}})^{-2}\n$$\nThus, the computational cost per fixed wall-clock simulation time scales with the inverse square of the CRM horizontal grid spacing. Doubling the grid spacing (e.g., from $1\\,\\mathrm{km}$ to $2\\,\\mathrm{km}$) would reduce the computational cost by a factor of $(2)^{-2} = 1/4$.",
            "answer": "$$\n\\boxed{0.1566}\n$$"
        }
    ]
}