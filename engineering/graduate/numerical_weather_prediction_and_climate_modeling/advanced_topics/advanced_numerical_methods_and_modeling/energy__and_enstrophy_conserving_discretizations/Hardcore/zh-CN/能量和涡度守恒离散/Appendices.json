{
    "hands_on_practices": [
        {
            "introduction": "在构建能够守恒能量和涡量的数值格式之前，我们必须首先在连续的物理框架下精确理解这些不变量。本练习将通过一个理想化的二维不可压缩流场，引导我们回顾动能和涡量的基本定义。通过对一个给定的流函数进行直接计算，我们可以得到这两个守恒量的解析表达式，这为我们后续评估数值离散格式的性能提供了重要的理论基准 。",
            "id": "4036083",
            "problem": "考虑在周期性方形域 $\\mathcal{D} = [0, 2\\pi] \\times [0, 2\\pi]$ 上的二维不可压缩流，其在 $x$ 和 $y$ 方向均具有周期性边界条件。设流场由流函数 $\\psi(x,y)$ 表示，使得速度场 $\\mathbf{u}(x,y) = (u(x,y), v(x,y))$ 由 $u(x,y) = -\\frac{\\partial \\psi}{\\partial y}(x,y)$ 和 $v(x,y) = \\frac{\\partial \\psi}{\\partial x}(x,y)$ 给出。假设流函数为\n$$\n\\psi(x,y) = A \\cos(k x)\\cos(\\ell y),\n$$\n其中 $A>0$ 是一个常数振幅，$k,\\ell \\in \\mathbb{N}$ 是正整数。\n\n仅使用二维不可压缩流的动能和拟涡能的基本定义，计算该流在 $\\mathcal{D}$ 上的动能 $E$ 和拟涡能 $Z$。动能定义为\n$$\nE = \\frac{1}{2} \\int_{\\mathcal{D}} \\left( u(x,y)^{2} + v(x,y)^{2} \\right) \\, \\mathrm{d}x\\,\\mathrm{d}y,\n$$\n涡度 $\\zeta$ 定义为\n$$\n\\zeta(x,y) = \\frac{\\partial v}{\\partial x}(x,y) - \\frac{\\partial u}{\\partial y}(x,y),\n$$\n拟涡能为\n$$\nZ = \\frac{1}{2} \\int_{\\mathcal{D}} \\zeta(x,y)^{2} \\, \\mathrm{d}x\\,\\mathrm{d}y.\n$$\n\n将您关于 $E$ 和 $Z$ 的最终结果表示为以 $A$、$k$、$\\ell$ 和 $\\pi$ 表示的精确解析表达式。不要提供任何数值近似。您的最终答案必须同时包含 $E$ 和 $Z$。",
            "solution": "该问题是有效的，因为它科学地基于流体动力学原理，具有所有必要的定义和约束，定义明确，并以客观的数学语言表达。这是二维湍流和地球物理流体动力学研究中的一个标准计算。\n\n任务是计算由给定流函数 $\\psi(x,y)$ 在周期性方形域 $\\mathcal{D} = [0, 2\\pi] \\times [0, 2\\pi]$ 上定义的流的总动能 $E$ 和总拟涡能 $Z$。\n\n流函数给定为\n$$\n\\psi(x,y) = A \\cos(k x)\\cos(\\ell y)\n$$\n其中 $A > 0$ 且 $k, \\ell \\in \\mathbb{N}$ 为正整数。\n\n首先，我们根据流函数的定义计算速度场 $\\mathbf{u}(x,y) = (u(x,y), v(x,y))$ 的分量。\n速度的 $x$ 分量是\n$$\nu(x,y) = -\\frac{\\partial \\psi}{\\partial y}(x,y) = -\\frac{\\partial}{\\partial y} \\left( A \\cos(k x)\\cos(\\ell y) \\right) = -A \\cos(k x) (-\\ell \\sin(\\ell y)) = A\\ell \\cos(k x)\\sin(\\ell y).\n$$\n速度的 $y$ 分量是\n$$\nv(x,y) = \\frac{\\partial \\psi}{\\partial x}(x,y) = \\frac{\\partial}{\\partial x} \\left( A \\cos(k x)\\cos(\\ell y) \\right) = A (-k \\sin(k x)) \\cos(\\ell y) = -Ak \\sin(k x)\\cos(\\ell y).\n$$\n\n接下来，我们计算动能 $E$，其定义为\n$$\nE = \\frac{1}{2} \\int_{\\mathcal{D}} \\left( u(x,y)^{2} + v(x,y)^{2} \\right) \\, \\mathrm{d}x\\,\\mathrm{d}y.\n$$\n被积函数，代表两倍的动能密度，是\n$$\nu^{2} + v^{2} = (A\\ell \\cos(k x)\\sin(\\ell y))^{2} + (-Ak \\sin(k x)\\cos(\\ell y))^{2}\n$$\n$$\nu^{2} + v^{2} = A^{2}\\ell^{2} \\cos^{2}(k x)\\sin^{2}(\\ell y) + A^{2}k^{2} \\sin^{2}(k x)\\cos^{2}(\\ell y).\n$$\n现在我们将这个表达式在域 $\\mathcal{D} = [0, 2\\pi] \\times [0, 2\\pi]$ 上积分：\n$$\nE = \\frac{A^{2}}{2} \\int_{0}^{2\\pi} \\int_{0}^{2\\pi} \\left( \\ell^{2} \\cos^{2}(k x)\\sin^{2}(\\ell y) + k^{2} \\sin^{2}(k x)\\cos^{2}(\\ell y) \\right) \\, \\mathrm{d}x\\,\\mathrm{d}y.\n$$\n由于 $x$ 和 $y$ 的函数是可分的，我们可以将其写成积分乘积的和：\n$$\nE = \\frac{A^{2}}{2} \\left( \\ell^{2} \\left(\\int_{0}^{2\\pi} \\cos^{2}(k x) \\, \\mathrm{d}x\\right) \\left(\\int_{0}^{2\\pi} \\sin^{2}(\\ell y) \\, \\mathrm{d}y\\right) + k^{2} \\left(\\int_{0}^{2\\pi} \\sin^{2}(k x) \\, \\mathrm{d}x\\right) \\left(\\int_{0}^{2\\pi} \\cos^{2}(\\ell y) \\, \\mathrm{d}y\\right) \\right).\n$$\n我们使用在一个完整周期上的标准定积分。对于任何非零整数 $m$：\n$$\n\\int_{0}^{2\\pi} \\cos^{2}(mx) \\, \\mathrm{d}x = \\int_{0}^{2\\pi} \\frac{1 + \\cos(2mx)}{2} \\, \\mathrm{d}x = \\left[ \\frac{x}{2} + \\frac{\\sin(2mx)}{4m} \\right]_{0}^{2\\pi} = \\frac{2\\pi}{2} = \\pi.\n$$\n$$\n\\int_{0}^{2\\pi} \\sin^{2}(mx) \\, \\mathrm{d}x = \\int_{0}^{2\\pi} \\frac{1 - \\cos(2mx)}{2} \\, \\mathrm{d}x = \\left[ \\frac{x}{2} - \\frac{\\sin(2mx)}{4m} \\right]_{0}^{2\\pi} = \\frac{2\\pi}{2} = \\pi.\n$$\n由于 $k$ 和 $\\ell$ 是正整数，这些结果适用。将这些值代回 $E$ 的表达式中：\n$$\nE = \\frac{A^{2}}{2} \\left( \\ell^{2} (\\pi)(\\pi) + k^{2} (\\pi)(\\pi) \\right) = \\frac{A^{2}\\pi^{2}}{2} (k^{2} + \\ell^{2}).\n$$\n\n接下来，我们计算拟涡能 $Z$。首先，我们必须求出涡度 $\\zeta$，其定义为\n$$\n\\zeta(x,y) = \\frac{\\partial v}{\\partial x}(x,y) - \\frac{\\partial u}{\\partial y}(x,y).\n$$\n让我们计算所需的偏导数：\n$$\n\\frac{\\partial v}{\\partial x} = \\frac{\\partial}{\\partial x} \\left( -Ak \\sin(k x)\\cos(\\ell y) \\right) = -Ak^{2} \\cos(k x)\\cos(\\ell y).\n$$\n$$\n\\frac{\\partial u}{\\partial y} = \\frac{\\partial}{\\partial y} \\left( A\\ell \\cos(k x)\\sin(\\ell y) \\right) = A\\ell^{2} \\cos(k x)\\cos(\\ell y).\n$$\n将这些代入涡度的定义中：\n$$\n\\zeta(x,y) = -Ak^{2} \\cos(k x)\\cos(\\ell y) - A\\ell^{2} \\cos(k x)\\cos(\\ell y) = -A(k^{2} + \\ell^{2}) \\cos(k x)\\cos(\\ell y).\n$$\n注意 $\\zeta = \\nabla^{2}\\psi$。这是二维不可压缩流的一个普遍结果。\n\n拟涡能 $Z$ 定义为\n$$\nZ = \\frac{1}{2} \\int_{\\mathcal{D}} \\zeta(x,y)^{2} \\, \\mathrm{d}x\\,\\mathrm{d}y.\n$$\n我们将涡度的表达式平方：\n$$\n\\zeta^{2} = \\left( -A(k^{2} + \\ell^{2}) \\cos(k x)\\cos(\\ell y) \\right)^{2} = A^{2}(k^{2} + \\ell^{2})^{2} \\cos^{2}(k x)\\cos^{2}(\\ell y).\n$$\n现在我们将其在域 $\\mathcal{D}$ 上积分：\n$$\nZ = \\frac{1}{2} \\int_{0}^{2\\pi} \\int_{0}^{2\\pi} A^{2}(k^{2} + \\ell^{2})^{2} \\cos^{2}(k x)\\cos^{2}(\\ell y) \\, \\mathrm{d}x\\,\\mathrm{d}y.\n$$\n我们可以将常数因子提出并将积分分离：\n$$\nZ = \\frac{A^{2}(k^{2} + \\ell^{2})^{2}}{2} \\left( \\int_{0}^{2\\pi} \\cos^{2}(k x) \\, \\mathrm{d}x \\right) \\left( \\int_{0}^{2\\pi} \\cos^{2}(\\ell y) \\, \\mathrm{d}y \\right).\n$$\n使用积分结果 $\\int_{0}^{2\\pi} \\cos^{2}(mx) \\, \\mathrm{d}x = \\pi$（对于非零整数 $m$）：\n$$\nZ = \\frac{A^{2}(k^{2} + \\ell^{2})^{2}}{2} (\\pi)(\\pi) = \\frac{A^{2}\\pi^{2}(k^{2} + \\ell^{2})^{2}}{2}.\n$$\n\n动能 $E$ 和拟涡能 $Z$ 的最终表达式为：\n$$\nE = \\frac{A^{2}\\pi^{2}(k^{2} + \\ell^{2})}{2}\n$$\n$$\nZ = \\frac{A^{2}\\pi^{2}(k^{2} + \\ell^{2})^{2}}{2}\n$$\n这些结果共同作为最终答案呈现。",
            "answer": "$$\n\\boxed{\\begin{aligned} E = \\frac{A^{2}\\pi^{2}(k^{2} + \\ell^{2})}{2} \\\\ Z = \\frac{A^{2}\\pi^{2}(k^{2} + \\ell^{2})^{2}}{2} \\end{aligned}}\n$$"
        },
        {
            "introduction": "从连续世界过渡到离散世界，我们需要精心设计数值算子以模仿连续微积分的性质。本练习将我们带入Arakawa C-网格，这是许多大气和海洋模型的核心。通过在一个周期性二维网格上计算离散散度和推导分部求和恒等式，我们将亲手验证交错网格上压力梯度项和散度项的搭配如何确保能量守恒，这正是离散守恒律背后的核心数学机制 。",
            "id": "4036086",
            "problem": "考虑一个在二维、均匀 Arakawa C-网格上的无粘、可压缩流，两个方向均为周期性边界条件。该区域在 $x$ 方向包含 $N_x = 2$ 个网格单元，在 $y$ 方向包含 $N_y = 2$ 个网格单元，无量纲网格间距为 $\\Delta x = 1$ 和 $\\Delta y = 1$。Arakawa C-网格的交错布局将 $x$ 方向速度置于东西向的网格单元面上，$y$ 方向速度置于南北向的网格单元面上，压力置于网格单元中心。将 $x$ 方向速度分量记为 $u_{i+1/2,j}$，$y$ 方向速度分量记为 $v_{i,j+1/2}$，压力记为 $p_{i,j}$，其中 $i \\in \\{1,2\\}$ 且 $j \\in \\{1,2\\}$，采用周期性索引。\n\n网格单元中心的离散散度定义为\n$$\n(\\delta_x u)_{i,j} = \\frac{u_{i+1/2,j} - u_{i-1/2,j}}{\\Delta x}, \\qquad\n(\\delta_y v)_{i,j} = \\frac{v_{i,j+1/2} - v_{i,j-1/2}}{\\Delta y}, \\qquad\n(\\nabla_h \\cdot \\mathbf{u})_{i,j} = (\\delta_x u)_{i,j} + (\\delta_y v)_{i,j},\n$$\n采用周期性索引（例如，$u_{1-1/2,j} = u_{2+1/2,j}$ 且 $v_{i,1-1/2} = v_{i,2+1/2}$）。网格单元面上的离散压力梯度由中心差分定义为\n$$\n(\\delta_x p)_{i+1/2,j} = \\frac{p_{i+1,j} - p_{i,j}}{\\Delta x}, \\qquad\n(\\delta_y p)_{i,j+1/2} = \\frac{p_{i,j+1} - p_{i,j}}{\\Delta y}.\n$$\n\n给定以下无量纲场：\n- 体心压力：\n$$\np_{1,1} = 2, \\quad p_{2,1} = 1, \\quad p_{1,2} = 0, \\quad p_{2,2} = 3.\n$$\n- 面心 $x$ 方向速度：\n$$\nu_{1+1/2,1} = 1, \\quad u_{2+1/2,1} = -1, \\quad u_{1+1/2,2} = 0, \\quad u_{2+1/2,2} = 2.\n$$\n- 面心 $y$ 方向速度：\n$$\nv_{1,1+1/2} = \\frac{1}{2}, \\quad v_{2,1+1/2} = -\\frac{3}{2}, \\quad v_{1,2+1/2} = 1, \\quad v_{2,2+1/2} = -\\frac{1}{2}.\n$$\n\n任务：\n- 首先，计算四个网格单元中每一个的离散散度 $(\\nabla_h \\cdot \\mathbf{u})_{i,j}$。\n- 然后，从无粘压力功的连续乘积法则恒等式\n$$\n\\mathbf{u} \\cdot \\left(-\\nabla p\\right) = -\\nabla \\cdot \\left(p \\,\\mathbf{u}\\right) + p \\,\\nabla \\cdot \\mathbf{u},\n$$\n出发，推导在此周期性边界的 C-网格上相应的离散分部求和关系式，该关系式将全域求和的面心压力功与一个涉及 $p_{i,j}$ 和 $(\\nabla_h \\cdot \\mathbf{u})_{i,j}$ 的体心求和联系起来。\n- 最后，使用你推导的离散关系式和给定的场，计算仅由压力梯度项引起的全域积分动能趋势。使用无量纲单位，并给出精确值（不要四舍五入）。你的最终答案必须是一个实数。",
            "solution": "首先，我们为四个单元 $(i,j) \\in \\{ (1,1), (2,1), (1,2), (2,2) \\}$ 中的每一个计算离散散度 $(\\nabla_h \\cdot \\mathbf{u})_{i,j}$。由于 $\\Delta x = 1$ 和 $\\Delta y = 1$，公式简化为 $(\\nabla_h \\cdot \\mathbf{u})_{i,j} = (u_{i+1/2,j} - u_{i-1/2,j}) + (v_{i,j+1/2} - v_{i,j-1/2})$。我们必须使用周期性边界条件来找到 $2 \\times 2$ 区域边界上的 $u$ 和 $v$ 的值。\n\n周期性边界条件是：\n对于 $u$：$u_{1/2,j} = u_{2+1/2,j} = u_{5/2,j}$ 和 $u_{1+1/2,j} = u_{3/2,j}$。索引 $i+1/2$ 处的值从 $i=2$ 环绕到 $i=1$。\n- $u_{1/2,1} = u_{5/2,1} = -1$\n- $u_{1/2,2} = u_{5/2,2} = 2$\n\n对于 $v$：$v_{i,1/2} = v_{i,2+1/2} = v_{i,5/2}$ 和 $v_{i,1+1/2} = v_{i,3/2}$。索引 $j+1/2$ 处的值从 $j=2$ 环绕到 $j=1$。\n- $v_{1,1/2} = v_{1,5/2} = 1$\n- $v_{2,1/2} = v_{2,5/2} = -\\frac{1}{2}$\n\n现在我们计算每个单元的散度：\n- **单元 (1,1):**\n$$ (\\nabla_h \\cdot \\mathbf{u})_{1,1} = (u_{3/2,1} - u_{1/2,1}) + (v_{1,3/2} - v_{1,1/2}) = (1 - (-1)) + (\\frac{1}{2} - 1) = 2 - \\frac{1}{2} = \\frac{3}{2} $$\n- **单元 (2,1):**\n$$ (\\nabla_h \\cdot \\mathbf{u})_{2,1} = (u_{5/2,1} - u_{3/2,1}) + (v_{2,3/2} - v_{2,1/2}) = (-1 - 1) + (-\\frac{3}{2} - (-\\frac{1}{2})) = -2 - 1 = -3 $$\n- **单元 (1,2):**\n$$ (\\nabla_h \\cdot \\mathbf{u})_{1,2} = (u_{3/2,2} - u_{1/2,2}) + (v_{1,5/2} - v_{1,3/2}) = (0 - 2) + (1 - \\frac{1}{2}) = -2 + \\frac{1}{2} = -\\frac{3}{2} $$\n- **单元 (2,2):**\n$$ (\\nabla_h \\cdot \\mathbf{u})_{2,2} = (u_{5/2,2} - u_{3/2,2}) + (v_{2,5/2} - v_{2,3/2}) = (2 - 0) + (-\\frac{1}{2} - (-\\frac{3}{2})) = 2 + 1 = 3 $$\n\n作为验证，周期性区域上散度的总和应为零：$\\frac{3}{2} - 3 - \\frac{3}{2} + 3 = 0$。此式成立。\n\n接下来，我们推导离散分部求和关系式。由压力梯度引起的全域积分动能趋势由 $\\mathbf{u} \\cdot (-\\nabla p)$ 在区域面积 $A$ 上的积分给出。其离散模拟，我们记为 $W$，是所有速度点上速度分量与相应压力梯度分量乘积的总和，再乘以单元面积 $\\Delta A = \\Delta x \\Delta y$。在 C-网格上，压力梯度分量与速度分量自然地位于同一位置。\n$$ W = \\sum_{j=1}^{N_y} \\sum_{i=1}^{N_x} \\left[ u_{i+1/2,j} (-(\\delta_x p)_{i+1/2,j}) + v_{i,j+1/2} (-(\\delta_y p)_{i,j+1/2}) \\right] \\Delta x \\Delta y $$\n代入离散梯度的定义：\n$$ W = - \\sum_{j=1}^{N_y} \\sum_{i=1}^{N_x} \\left[ u_{i+1/2,j} \\frac{p_{i+1,j} - p_{i,j}}{\\Delta x} + v_{i,j+1/2} \\frac{p_{i,j+1} - p_{i,j}}{\\Delta y} \\right] \\Delta x \\Delta y $$\n$$ W = - \\sum_{j=1}^{N_y} \\sum_{i=1}^{N_x} \\left[ u_{i+1/2,j} (p_{i+1,j} - p_{i,j}) \\Delta y + v_{i,j+1/2} (p_{i,j+1} - p_{i,j}) \\Delta x \\right] $$\n我们可以将这个和分成四个部分：\n$$ W = - \\sum_{j,i} u_{i+1/2,j} p_{i+1,j} \\Delta y + \\sum_{j,i} u_{i+1/2,j} p_{i,j} \\Delta y - \\sum_{j,i} v_{i,j+1/2} p_{i,j+1} \\Delta x + \\sum_{j,i} v_{i,j+1/2} p_{i,j} \\Delta x $$\n现在，我们通过重新索引求和来进行分部求和。对于第一项，令 $i' = i+1$。由于求和是在周期性区域上进行的，对 $i'$ 从 $2$ 到 $N_x+1$ 求和等价于对 $i$ 从 $1$ 到 $N_x$ 求和。该项变为 $-\\sum_{j,i'} u_{i'-1/2,j} p_{i',j} \\Delta y$，我们可以写成 $-\\sum_{j,i} u_{i-1/2,j} p_{i,j} \\Delta y$。类似地，对于第三项，令 $j' = j+1$，得到 $-\\sum_{j,i} v_{i,j-1/2} p_{i,j} \\Delta x$。\n将这些代回，我们可以合并具有公因子 $p_{i,j}$ 的项：\n$$ W = \\sum_{j,i} p_{i,j} \\left[ u_{i+1/2,j} \\Delta y - u_{i-1/2,j} \\Delta y + v_{i,j+1/2} \\Delta x - v_{i,j-1/2} \\Delta x \\right] $$\n提出因子 $\\Delta x \\Delta y$：\n$$ W = \\sum_{j,i} p_{i,j} \\left[ \\frac{u_{i+1/2,j} - u_{i-1/2,j}}{\\Delta x} + \\frac{v_{i,j+1/2} - v_{i,j-1/2}}{\\Delta y} \\right] \\Delta x \\Delta y $$\n方括号中的项是离散散度 $(\\nabla_h \\cdot \\mathbf{u})_{i,j}$ 的定义。因此，我们得到了所需的关系式：\n$$ W = \\sum_{j=1}^{N_y} \\sum_{i=1}^{N_x} p_{i,j} (\\nabla_h \\cdot \\mathbf{u})_{i,j} \\Delta x \\Delta y $$\n这个恒等式表明，在速度点上压力功的总和精确地等于在单元中心上 $p$ 乘以散度的总和。这是周期性区域上恒等式 $\\int_A \\mathbf{u} \\cdot (-\\nabla p) dA = \\int_A p (\\nabla \\cdot \\mathbf{u}) dA$ 的离散模拟。\n\n最后，使用推导的关系式和计算出的散度值，我们可以评估总压力功 $W$。当 $\\Delta x=1$ 和 $\\Delta y=1$ 时，表达式为：\n$$ W = \\sum_{j=1}^{2} \\sum_{i=1}^{2} p_{i,j} (\\nabla_h \\cdot \\mathbf{u})_{i,j} $$\n我们将四个单元中每一个的压力与散度的乘积相加：\n- 来自单元 (1,1) 的贡献：$p_{1,1} (\\nabla_h \\cdot \\mathbf{u})_{1,1} = 2 \\times \\frac{3}{2} = 3$\n- 来自单元 (2,1) 的贡献：$p_{2,1} (\\nabla_h \\cdot \\mathbf{u})_{2,1} = 1 \\times (-3) = -3$\n- 来自单元 (1,2) 的贡献：$p_{1,2} (\\nabla_h \\cdot \\mathbf{u})_{1,2} = 0 \\times (-\\frac{3}{2}) = 0$\n- 来自单元 (2,2) 的贡献：$p_{2,2} (\\nabla_h \\cdot \\mathbf{u})_{2,2} = 3 \\times 3 = 9$\n\n全域积分动能趋势是这些贡献的总和：\n$$ W = 3 + (-3) + 0 + 9 = 9 $$\n最终结果以无量纲单位表示。",
            "answer": "$$\n\\boxed{9}\n$$"
        },
        {
            "introduction": "理解了如何构建守恒格式后，一个更深刻的问题是：如果破坏了这些设计原则会发生什么？本练习通过引入一个与标准能量守恒格式略有偏差的“非伴随”压力梯度算子，来精确地揭示这一点。通过推导由这个非伴随项引起的虚假能量源或汇，我们能够从根本上理解为什么离散算子之间的伴随关系对于防止非物理解答和保证模型的长期稳定性至关重要 。",
            "id": "4036089",
            "problem": "考虑一个长度为 $L$ 的一维周期性域，离散为 $N$ 个均匀单元格，其单元中心索引为 $i \\in \\{1,2,\\dots,N\\}$，单元面索引为 $i+\\tfrac{1}{2} \\in \\{ \\tfrac{3}{2}, \\tfrac{5}{2}, \\dots, N+\\tfrac{1}{2}, \\tfrac{1}{2} \\}$，间距为 $\\Delta x = L/N$。设速度 $u_{i+\\tfrac{1}{2}}(t)$ 定义在单元面上，压力 $p_i(t)$ 定义在单元中心。假设采用周期性边界条件，因此索引以 $N$ 为模进行循环（例如，$p_{0} \\equiv p_{N}$ 和 $p_{N+1} \\equiv p_{1}$）。考虑在数值天气预报（NWP）和气候模式动力核心中使用的可压缩流方程的线性声学子系统，其半离散形式写作：\n$$\n\\frac{d u_{i+\\tfrac{1}{2}}}{d t} \\;=\\; -\\frac{1}{\\rho}\\,\\big(G p\\big)_{i+\\tfrac{1}{2}}, \n\\qquad\n\\frac{d p_i}{d t} \\;=\\; -\\rho c^{2}\\,\\big(D u\\big)_i,\n$$\n其中 $\\rho$ 是一个恒定的参考密度，$c$ 是一个恒定的声速。离散散度算子 $D$ 定义为\n$$\n\\big(D u\\big)_i \\;=\\; \\frac{u_{i+\\tfrac{1}{2}} - u_{i-\\tfrac{1}{2}}}{\\Delta x},\n$$\n而压力梯度算子 $G$ 被视为标准能量守恒选择的一个非伴随修正。具体来说，将能量守恒（伴随相容）的压力梯度算子 $G_c$ 定义为\n$$\n\\big(G_c p\\big)_{i+\\tfrac{1}{2}} \\;=\\; \\frac{p_{i+1} - p_{i}}{\\Delta x},\n$$\n并定义一个非伴随压力梯度算子 $G_{\\mathrm{na}}$ 为\n$$\n\\big(G_{\\mathrm{na}} p\\big)_{i+\\tfrac{1}{2}} \\;=\\; \\big(G_c p\\big)_{i+\\tfrac{1}{2}} \\;+\\; \\eta\\,\\frac{p_{i+1} - 2 p_i + p_{i-1}}{\\Delta x},\n$$\n其中 $\\eta$ 是一个衡量偏离伴随性程度的无量纲系数。考虑离散总声能\n$$\nE(t) \\;=\\; \\frac{\\Delta x}{2}\\,\\sum_{i=1}^{N}\\left[ \\rho\\,u_{i+\\tfrac{1}{2}}^{2}(t) \\;+\\; \\frac{1}{\\rho c^{2}}\\,p_{i}^{2}(t) \\right].\n$$\n从这些定义和半离散方程出发，推导仅由压力梯度的非伴随部分引起的离散能量瞬时变化率 $\\frac{dE}{dt}$ 的精确表达式，即当 $\\eta = 0$ 时会消失的贡献。您的推导必须从给定的半离散方程和能量定义开始，仅使用在周期性网格上有效的代数恒等式，并清楚地指出代表虚假能量产生或损失的项。请将您的最终答案表示为关于 $\\eta$、$\\Delta x$ 以及离散场 $u_{i+\\tfrac{1}{2}}$ 和 $p_i$ 的单个闭式解析表达式。最终的能量变化率以焦耳/秒为单位。无需四舍五入。此外，请简要解释虚假能量的来源，从业已违反的 $D$ 和 $G$ 关于能量内积的离散伴随关系方面进行说明。",
            "solution": "总离散声能 $E(t)$ 由下式给出：\n$$\nE(t) \\;=\\; \\frac{\\Delta x}{2}\\,\\sum_{i=1}^{N}\\left[ \\rho\\,u_{i+\\tfrac{1}{2}}^{2}(t) \\;+\\; \\frac{1}{\\rho c^{2}}\\,p_{i}^{2}(t) \\right]\n$$\n为了求能量的瞬时变化率 $\\frac{dE}{dt}$，我们将 $E(t)$ 对时间 $t$ 求导。使用链式法则，我们得到：\n$$\n\\frac{dE}{dt} \\;=\\; \\frac{\\Delta x}{2}\\,\\sum_{i=1}^{N}\\left[ \\rho \\cdot 2 u_{i+\\tfrac{1}{2}} \\frac{d u_{i+\\tfrac{1}{2}}}{d t} \\;+\\; \\frac{1}{\\rho c^{2}} \\cdot 2 p_{i} \\frac{d p_{i}}{d t} \\right] \\\\\n\\frac{dE}{dt} \\;=\\; \\Delta x\\,\\sum_{i=1}^{N}\\left[ \\rho\\,u_{i+\\tfrac{1}{2}}\\frac{d u_{i+\\tfrac{1}{2}}}{d t} \\;+\\; \\frac{1}{\\rho c^{2}}\\,p_{i}\\frac{d p_{i}}{d t} \\right]\n$$\n接下来，我们将给定的半离散方程代入此表达式。这些方程是：\n$$\n\\frac{d u_{i+\\tfrac{1}{2}}}{d t} \\;=\\; -\\frac{1}{\\rho}\\,\\big(G_{\\mathrm{na}} p\\big)_{i+\\tfrac{1}{2}} \n\\qquad \\text{和} \\qquad\n\\frac{d p_i}{d t} \\;=\\; -\\rho c^{2}\\,\\big(D u\\big)_i\n$$\n这里，$G_{\\mathrm{na}}$ 是指定的非伴随压力梯度算子。代入这些导数得：\n$$\n\\frac{dE}{dt} \\;=\\; \\Delta x\\,\\sum_{i=1}^{N}\\left[ \\rho\\,u_{i+\\tfrac{1}{2}}\\left(-\\frac{1}{\\rho}\\,\\big(G_{\\mathrm{na}} p\\big)_{i+\\tfrac{1}{2}}\\right) \\;+\\; \\frac{1}{\\rho c^{2}}\\,p_{i}\\left(-\\rho c^{2}\\,\\big(D u\\big)_i\\right) \\right]\n$$\n简化表达式得：\n$$\n\\frac{dE}{dt} \\;=\\; -\\Delta x\\,\\sum_{i=1}^{N}\\left[ u_{i+\\tfrac{1}{2}}\\big(G_{\\mathrm{na}} p\\big)_{i+\\tfrac{1}{2}} \\;+\\; p_{i}\\big(D u\\big)_i \\right]\n$$\n为了继续，我们使用周期性网格上的分部求和技术来分析和中的第二项 $\\sum_{i=1}^{N} p_{i}\\big(D u\\big)_i$。我们代入散度算子 $D$ 的定义：\n$$\n\\sum_{i=1}^{N} p_{i}\\big(D u\\big)_i \\;=\\; \\sum_{i=1}^{N} p_{i} \\frac{u_{i+\\tfrac{1}{2}} - u_{i-\\tfrac{1}{2}}}{\\Delta x} \\;=\\; \\frac{1}{\\Delta x} \\left( \\sum_{i=1}^{N} p_{i} u_{i+\\tfrac{1}{2}} - \\sum_{i=1}^{N} p_{i} u_{i-\\tfrac{1}{2}} \\right)\n$$\n我们在第二个和式中进行指数变换。令 $j=i-1$，则 $i=j+1$。当 $i$ 从 $1$ 到 $N$ 时，$j$ 从 $0$ 到 $N-1$。\n$$\n\\sum_{i=1}^{N} p_{i} u_{i-\\tfrac{1}{2}} \\;=\\; \\sum_{j=0}^{N-1} p_{j+1} u_{j+\\tfrac{1}{2}}\n$$\n由于周期性边界条件，指数以 $N$ 为模。这使我们能够将求和范围从 $\\{0, \\dots, N-1\\}$ 移至 $\\{1, \\dots, N\\}$，将索引 $0$ 与 $N$ 等同。因此，我们可以将哑索引 $j$ 重命名为 $i$：\n$$\n\\sum_{j=0}^{N-1} p_{j+1} u_{j+\\tfrac{1}{2}} \\;=\\; \\sum_{i=1}^{N} p_{i+1} u_{i+\\tfrac{1}{2}}\n$$\n将此代回散度和的表达式：\n$$\n\\sum_{i=1}^{N} p_{i}\\big(D u\\big)_i \\;=\\; \\frac{1}{\\Delta x} \\left( \\sum_{i=1}^{N} p_{i} u_{i+\\tfrac{1}{2}} - \\sum_{i=1}^{N} p_{i+1} u_{i+\\tfrac{1}{2}} \\right) \\;=\\; -\\sum_{i=1}^{N} \\frac{p_{i+1} - p_i}{\\Delta x} u_{i+\\tfrac{1}{2}}\n$$\n识别出能量守恒梯度算子的定义 $\\big(G_c p\\big)_{i+\\tfrac{1}{2}} = \\frac{p_{i+1} - p_{i}}{\\Delta x}$，我们有：\n$$\n\\sum_{i=1}^{N} p_{i}\\big(D u\\big)_i \\;=\\; -\\sum_{i=1}^{N} u_{i+\\tfrac{1}{2}} \\big(G_c p\\big)_{i+\\tfrac{1}{2}}\n$$\n这个恒等式揭示了 $D$ 和 $G_c$ 之间的离散伴随关系：就离散内积而言，$\\langle p, Du \\rangle = -\\langle G_c p, u \\rangle$。\n\n现在，我们将此结果代回 $\\frac{dE}{dt}$ 的表达式中：\n$$\n\\frac{dE}{dt} \\;=\\; -\\Delta x \\left( \\sum_{i=1}^{N} u_{i+\\tfrac{1}{2}}\\big(G_{\\mathrm{na}} p\\big)_{i+\\tfrac{1}{2}} - \\sum_{i=1}^{N} u_{i+\\tfrac{1}{2}}\\big(G_c p\\big)_{i+\\tfrac{1}{2}} \\right)\n$$\n$$\n\\frac{dE}{dt} \\;=\\; \\Delta x \\sum_{i=1}^{N} u_{i+\\tfrac{1}{2}} \\left( \\big(G_c p\\big)_{i+\\tfrac{1}{2}} - \\big(G_{\\mathrm{na}} p\\big)_{i+\\tfrac{1}{2}} \\right)\n$$\n该表达式表明，能量变化率等于零当且仅当 $G_{\\mathrm{na}} = G_c$。虚假的能量产生完全是由于 $G_{\\mathrm{na}}$ 偏离能量守恒算子 $G_c$ 所致。\n\n问题将非伴随算子定义为：\n$$\n\\big(G_{\\mathrm{na}} p\\big)_{i+\\tfrac{1}{2}} \\;=\\; \\big(G_c p\\big)_{i+\\tfrac{1}{2}} \\;+\\; \\eta\\,\\frac{p_{i+1} - 2 p_i + p_{i-1}}{\\Delta x}\n$$\n因此，差值项为：\n$$\n\\big(G_c p\\big)_{i+\\tfrac{1}{2}} - \\big(G_{\\mathrm{na}} p\\big)_{i+\\tfrac{1}{2}} \\;=\\; -\\eta\\,\\frac{p_{i+1} - 2 p_i + p_{i-1}}{\\Delta x}\n$$\n将此代入 $\\frac{dE}{dt}$ 的方程中：\n$$\n\\frac{dE}{dt} \\;=\\; \\Delta x \\sum_{i=1}^{N} u_{i+\\tfrac{1}{2}} \\left( -\\eta\\,\\frac{p_{i+1} - 2 p_i + p_{i-1}}{\\Delta x} \\right)\n$$\n$\\Delta x$ 项抵消，得到虚假能量变化率的最终表达式：\n$$\n\\frac{dE}{dt} \\;=\\; - \\eta \\sum_{i=1}^{N} u_{i+\\tfrac{1}{2}} \\left( p_{i+1} - 2 p_i + p_{i-1} \\right)\n$$\n这个量具有功率的单位（能量/时间），在国际单位制中等同于焦耳/秒。\n\n虚假能量变化的来源是违反了离散伴随性质。如果一个离散系统的算子满足特定的对称性（或反对称性）关系，它就能守恒像能量这样的二次量。对于本系统，能量守恒要求压力梯度算子 $G$ 是散度算子 $D$ 的负伴随，即 $G = -D^*$，此处的伴随是关于能量内积而言的。算子 $G_c$ 满足此条件，因此 $\\big(G_c, D\\big)$ 构成一个能量守恒对。\n修正后的算子 $G_{\\mathrm{na}}$ 定义为 $G_{\\mathrm{na}} = G_c + \\eta \\Delta G$，其中 $(\\Delta G p)_{i+\\tfrac{1}{2}} = (p_{i+1} - 2p_i + p_{i-1})/\\Delta x$。附加项 $\\eta \\Delta G$ 不满足伴随性质。具体而言，它将单元中心 $i$ 处的计算与单元面 $i+\\tfrac{1}{2}$ 处的力联系起来，破坏了分部求和导致抵消所需的对称性。这个“非伴随”项充当能量的源或汇，代表对系统做的非物理功，其大小由系数 $\\eta$ 以及速度场与压力场曲率之间的相关性决定。",
            "answer": "$$\\boxed{- \\eta \\sum_{i=1}^{N} u_{i+\\tfrac{1}{2}} \\left( p_{i+1} - 2 p_i + p_{i-1} \\right)}$$"
        }
    ]
}