{
    "hands_on_practices": [
        {
            "introduction": "Global cloud-resolving models (GCRMs) represent a major step forward in climate simulation, but their high resolution comes at a tremendous computational price. This exercise provides a foundational \"back-of-the-envelope\" calculation to connect key model parameters, such as grid spacing ($\\Delta x$) and time step ($\\Delta t$), to the total number of floating-point operations required for a climate simulation. By performing this estimate , you will gain a tangible appreciation for the immense computational demands of GCRMs and understand why they necessitate the use of state-of-the-art \"exascale\" supercomputers.",
            "id": "4049766",
            "problem": "A global cloud-resolving model (CRM) that explicitly resolves deep convection is to be run on a quasi-uniform spherical mesh covering the entire Earth. Assume a horizontal grid spacing of $\\Delta x = 3\\,\\mathrm{km}$, a vertical grid spacing of $\\Delta z = 250\\,\\mathrm{m}$ up to a model top at $H = 30\\,\\mathrm{km}$, and a time step of $\\Delta t = 1\\,\\mathrm{s}$ for a total simulated duration of $T_{\\mathrm{sim}} = 30\\,\\mathrm{days}$. Let the Earth’s radius be $R = 6.371\\times 10^{6}\\,\\mathrm{m}$. For a quasi-uniform mesh, approximate the number of horizontal grid cells by the Earth’s surface area divided by the cell area, i.e., use $N_{h} \\approx \\dfrac{4\\pi R^{2}}{\\Delta x^{2}}$. The number of vertical levels is $N_{z} \\approx \\dfrac{H}{\\Delta z}$, and the number of time steps is $N_{t} \\approx \\dfrac{T_{\\mathrm{sim}}}{\\Delta t}$. Assume an average computational cost of $f = 2.0\\times 10^{7}$ floating-point operations per grid point per time step, aggregated over dynamics and physics. Define an “exascale” system as one that sustains $E = 1.0\\times 10^{18}$ floating-point operations per second (FLOPS).\n\nStarting from these definitions and fundamental geometric relations, derive symbolic expressions for $N_{h}$, $N_{z}$, $N_{t}$, and the total floating-point operations $F_{\\mathrm{tot}}$ required for the full $30\\,\\mathrm{day}$ integration. Then compute the wallclock time $T_{\\mathrm{wall}}$ (in seconds) needed on the ideal exascale system, and finally convert it to days. Express your final answer for $T_{\\mathrm{wall}}$ in $\\mathrm{days}$, rounded to three significant figures.",
            "solution": "The problem requires an estimation of the total computational cost and the resulting wallclock time for a global cloud-resolving model simulation on an exascale computing system. The validation process confirms that the problem is well-posed, scientifically grounded, and provides all necessary data for a unique solution.\n\nFirst, we establish the symbolic expressions for the number of grid cells and time steps based on the provided parameters.\n\nThe number of horizontal grid cells, $N_{h}$, is approximated by dividing the Earth's surface area, $4\\pi R^{2}$, by the area of a single grid cell, approximated as $\\Delta x^{2}$.\n$$N_{h} \\approx \\frac{4\\pi R^{2}}{\\Delta x^{2}}$$\n\nThe number of vertical levels, $N_{z}$, is the model top height, $H$, divided by the vertical grid spacing, $\\Delta z$.\n$$N_{z} \\approx \\frac{H}{\\Delta z}$$\n\nThe number of time steps, $N_{t}$, is the total simulation duration, $T_{\\mathrm{sim}}$, divided by the time step, $\\Delta t$.\n$$N_{t} \\approx \\frac{T_{\\mathrm{sim}}}{\\Delta t}$$\n\nThe total number of grid points in the three-dimensional model domain is the product of the horizontal and vertical grid cell counts.\n$$N_{\\mathrm{grid}} = N_{h} N_{z}$$\n\nThe total number of floating-point operations, $F_{\\mathrm{tot}}$, is the product of the total number of grid points, the number of time steps, and the computational cost per grid point per time step, $f$. The symbolic expression for $F_{\\mathrm{tot}}$ is:\n$$F_{\\mathrm{tot}} = N_{h} N_{z} N_{t} f$$\nSubstituting the expressions for $N_{h}$, $N_{z}$, and $N_{t}$, we obtain:\n$$F_{\\mathrm{tot}} \\approx \\left( \\frac{4\\pi R^{2}}{\\Delta x^{2}} \\right) \\left( \\frac{H}{\\Delta z} \\right) \\left( \\frac{T_{\\mathrm{sim}}}{\\Delta t} \\right) f$$\n\nThe wallclock time, $T_{\\mathrm{wall}}$, required to complete the simulation is the total number of floating-point operations, $F_{\\mathrm{tot}}$, divided by the sustained performance of the computer system, $E$.\n$$T_{\\mathrm{wall}} = \\frac{F_{\\mathrm{tot}}}{E} \\approx \\frac{1}{E} \\left[ \\left( \\frac{4\\pi R^{2}}{\\Delta x^{2}} \\right) \\left( \\frac{H}{\\Delta z} \\right) \\left( \\frac{T_{\\mathrm{sim}}}{\\Delta t} \\right) f \\right]$$\n\nTo compute the numerical value, we first ensure all parameters are in consistent SI units (meters, seconds).\nThe given parameters are:\n- Earth's radius: $R = 6.371\\times 10^{6}\\,\\mathrm{m}$\n- Horizontal grid spacing: $\\Delta x = 3\\,\\mathrm{km} = 3 \\times 10^{3}\\,\\mathrm{m}$\n- Model top height: $H = 30\\,\\mathrm{km} = 3 \\times 10^{4}\\,\\mathrm{m}$\n- Vertical grid spacing: $\\Delta z = 250\\,\\mathrm{m}$\n- Total simulation duration: $T_{\\mathrm{sim}} = 30\\,\\mathrm{days} = 30 \\times 24 \\times 3600\\,\\mathrm{s} = 2.592 \\times 10^{6}\\,\\mathrm{s}$\n- Time step: $\\Delta t = 1\\,\\mathrm{s}$\n- Computational cost: $f = 2.0\\times 10^{7}\\,\\mathrm{FLOPS / (grid\\,point \\cdot time\\,step)}$\n- System performance: $E = 1.0\\times 10^{18}\\,\\mathrm{FLOPS}$\n\nWe now compute the numerical values for $N_{h}$, $N_{z}$, and $N_{t}$.\n$$N_{h} \\approx \\frac{4\\pi (6.371\\times 10^{6}\\,\\mathrm{m})^{2}}{(3 \\times 10^{3}\\,\\mathrm{m})^{2}} = \\frac{4\\pi (6.371)^{2} \\times 10^{12}\\,\\mathrm{m}^{2}}{9 \\times 10^{6}\\,\\mathrm{m}^{2}} \\approx 5.6678 \\times 10^{7}$$\n$$N_{z} \\approx \\frac{3 \\times 10^{4}\\,\\mathrm{m}}{250\\,\\mathrm{m}} = 120$$\n$$N_{t} \\approx \\frac{2.592 \\times 10^{6}\\,\\mathrm{s}}{1\\,\\mathrm{s}} = 2.592 \\times 10^{6}$$\n\nNext, we calculate the total floating-point operations, $F_{\\mathrm{tot}}$.\n$$F_{\\mathrm{tot}} \\approx N_{h} N_{z} N_{t} f \\approx (5.6678 \\times 10^{7}) \\times (120) \\times (2.592 \\times 10^{6}) \\times (2.0 \\times 10^{7})$$\n$$F_{\\mathrm{tot}} \\approx (5.6678 \\times 120 \\times 2.592 \\times 2.0) \\times 10^{(7 + 6 + 7)} \\approx 3523.5 \\times 10^{20}$$\n$$F_{\\mathrm{tot}} \\approx 3.5235 \\times 10^{23}\\,\\mathrm{FLOPS}$$\n\nNow, we compute the wallclock time in seconds, $T_{\\mathrm{wall, s}}$.\n$$T_{\\mathrm{wall, s}} = \\frac{F_{\\mathrm{tot}}}{E} \\approx \\frac{3.5235 \\times 10^{23}\\,\\mathrm{FLOPS}}{1.0 \\times 10^{18}\\,\\mathrm{FLOPS}} = 3.5235 \\times 10^{5}\\,\\mathrm{s}$$\n\nFinally, we convert the wallclock time from seconds to days. There are $24 \\times 60 \\times 60 = 86400$ seconds in one day.\n$$T_{\\mathrm{wall, days}} = \\frac{T_{\\mathrm{wall, s}}}{86400\\,\\mathrm{s/day}} \\approx \\frac{3.5235 \\times 10^{5}\\,\\mathrm{s}}{86400\\,\\mathrm{s/day}} \\approx 4.0781\\,\\mathrm{days}$$\n\nRounding the result to three significant figures, as required, we get:\n$$T_{\\mathrm{wall, days}} \\approx 4.08\\,\\mathrm{days}$$",
            "answer": "$$\\boxed{4.08}$$"
        },
        {
            "introduction": "The computational cost estimated in the previous exercise is directly proportional to the total number of time steps. The size of this time step, $\\Delta t$, is not arbitrary but is strictly limited by numerical stability criteria that depend on the underlying physics. This practice explores the Courant-Friedrichs-Lewy (CFL) condition, a fundamental principle governing explicit numerical methods, by analyzing how different physical processes impose their own constraints on $\\Delta t$. Completing this exercise  will clarify which phenomena—such as fluid advection, sound waves, or gravity waves—are most restrictive in a typical GCRM, revealing the physical reasons for the small time steps that make these models so computationally intensive.",
            "id": "4049813",
            "problem": "A global Cloud-Resolving Model (CRM) in the nonhydrostatic, fully compressible formulation is discretized on a uniform grid with horizontal spacing $\\Delta x = 3\\,\\mathrm{km}$ and vertical spacing $\\Delta z = 100\\,\\mathrm{m}$. The maximum horizontal wind speed is $U = 50\\,\\mathrm{m\\,s^{-1}}$, and the speed of sound is $c = 340\\,\\mathrm{m\\,s^{-1}}$. For the fastest external gravity wave, adopt the shallow-water phase speed approximation $c_{g} = \\sqrt{g H}$ with gravitational acceleration $g = 9.81\\,\\mathrm{m\\,s^{-2}}$ and equivalent depth $H = 10\\,\\mathrm{km}$. Consider a proposed explicit large time step $\\Delta t = 1.0\\,\\mathrm{s}$.\n\nStarting from the principle that explicit numerical schemes must respect the Courant-Friedrichs-Lewy (CFL) stability condition, derive from first principles the process-specific Courant numbers for horizontal advection, vertical acoustic waves, and external gravity waves. Using these, compute the maximum among the three Courant numbers at the proposed $\\Delta t$. Round your answer to four significant figures and express it as a dimensionless number.\n\nAdditionally, in your derivation, explain how the CFL condition constrains the time step for each process and identify which process is most restrictive for the given grid and parameters. Do not provide any intermediate or final answers in units other than those specified, and do not include the final numerical value for any quantity other than the requested maximum Courant number.",
            "solution": "The problem as stated is scientifically grounded, well-posed, objective, and contains all necessary information for a unique solution. It is based on the fundamental principles of numerical fluid dynamics, specifically the Courant-Friedrichs-Lewy (CFL) stability condition for explicit numerical schemes. A solution can therefore be derived.\n\nThe Courant-Friedrichs-Lewy (CFL) condition is a necessary condition for the stability of explicit time-integration schemes when solving hyperbolic partial differential equations numerically. The principle dictates that the numerical domain of dependence must contain the physical domain of dependence. For a one-dimensional problem, this is expressed through the dimensionless Courant number, $C$, which must remain below a certain threshold, typically $1$, for stability. The Courant number is defined as the ratio of the distance a wave or signal travels in one time step, $\\Delta t$, to the grid spacing, $\\Delta x$. The general form is:\n$$C = \\frac{\\lambda \\Delta t}{\\Delta x} \\le C_{max}$$\nwhere $\\lambda$ is the fastest characteristic speed of the physical process being modeled, and $C_{max}$ is a constant of order $1$, dependent on the specific numerical scheme. For the simulation to be stable, the time step $\\Delta t$ must be chosen such that this condition is satisfied for all relevant wave-like and advective processes resolved on the computational grid. The process with the highest characteristic speed relative to its corresponding grid spacing will impose the most severe constraint on the maximum allowable time step.\n\nWe will now derive the process-specific Courant numbers for the three phenomena specified—horizontal advection, vertical acoustic waves, and external gravity waves—using the proposed time step $\\Delta t = 1.0\\,\\mathrm{s}$. The provided grid spacings must be in consistent units, so we convert kilometers to meters: $\\Delta x = 3\\,\\mathrm{km} = 3000\\,\\mathrm{m}$ and $H = 10\\,\\mathrm{km} = 10000\\,\\mathrm{m}$.\n\n1.  **Horizontal Advection:** Advection describes the transport of a substance or property by the bulk motion of the fluid. The characteristic speed for this process is the fluid velocity itself. The problem specifies a maximum horizontal wind speed of $U = 50\\,\\mathrm{m\\,s^{-1}}$. The relevant grid spacing is in the horizontal direction, $\\Delta x = 3000\\,\\mathrm{m}$. The Courant number for horizontal advection, $C_{adv}$, is therefore:\n    $$C_{adv} = \\frac{U \\Delta t}{\\Delta x}$$\n    Substituting the given values:\n    $$C_{adv} = \\frac{(50\\,\\mathrm{m\\,s^{-1}})(1.0\\,\\mathrm{s})}{3000\\,\\mathrm{m}} = \\frac{50}{3000} = \\frac{1}{60}$$\n\n2.  **External Gravity Waves:** These long, horizontally propagating waves are a feature of a fluid with a free surface or a sharp density interface under gravity. In atmospheric models, the \"equivalent depth\" $H$ represents the effective depth of the atmosphere for these large-scale waves. The problem specifies the shallow-water phase speed approximation, $c_g = \\sqrt{gH}$, where $g = 9.81\\,\\mathrm{m\\,s^{-2}}$ and $H = 10000\\,\\mathrm{m}$. This gives the characteristic speed:\n    $$c_g = \\sqrt{(9.81\\,\\mathrm{m\\,s^{-2}})(10000\\,\\mathrm{m})} = \\sqrt{98100}\\,\\mathrm{m\\,s^{-1}}$$\n    Since these waves propagate horizontally, the relevant grid spacing is $\\Delta x = 3000\\,\\mathrm{m}$. The Courant number for external gravity waves, $C_g$, is:\n    $$C_g = \\frac{c_g \\Delta t}{\\Delta x} = \\frac{\\sqrt{98100}\\,\\mathrm{m\\,s^{-1}} \\times 1.0\\,\\mathrm{s}}{3000\\,\\mathrm{m}} = \\frac{\\sqrt{98100}}{3000}$$\n\n3.  **Vertical Acoustic Waves:** The model formulation is \"fully compressible,\" meaning it resolves sound waves, which propagate at the speed of sound, $c$. The problem asks to consider vertically propagating acoustic waves. The characteristic speed is the speed of sound, $c = 340\\,\\mathrm{m\\,s^{-1}}$, and the relevant grid spacing is the vertical spacing, $\\Delta z = 100\\,\\mathrm{m}$. The Courant number for vertical acoustic waves, $C_{ac,z}$, is:\n    $$C_{ac,z} = \\frac{c \\Delta t}{\\Delta z}$$\n    Substituting the given values:\n    $$C_{ac,z} = \\frac{(340\\,\\mathrm{m\\,s^{-1}})(1.0\\,\\mathrm{s})}{100\\,\\mathrm{m}} = \\frac{340}{100} = 3.4$$\n\nNow, we compute the numerical values for comparison:\n- $C_{adv} = \\frac{1}{60} \\approx 0.016666...$\n- $C_g = \\frac{\\sqrt{98100}}{3000} \\approx \\frac{313.20919...}{3000} \\approx 0.104403...$\n- $C_{ac,z} = 3.4$\n\nThe CFL condition requires that the time step $\\Delta t$ be small enough to satisfy the stability criterion for all resolved phenomena simultaneously. This means $\\Delta t$ must be constrained by the most restrictive process, which is the one that yields the largest Courant number for a given $\\Delta t$. Comparing the three computed values:\n$$\\max(C_{adv}, C_g, C_{ac,z}) = \\max(0.0166..., 0.1044..., 3.4) = 3.4$$\nThe largest Courant number is $C_{ac,z} = 3.4$. This value is significantly greater than $1$, indicating that the proposed time step of $\\Delta t = 1.0\\,\\mathrm{s}$ would lead to catastrophic numerical instability in the model.\n\nThe most restrictive process for the given grid and parameters is the vertical propagation of acoustic waves. The combination of a high propagation speed ($c = 340\\,\\mathrm{m\\,s^{-1}}$) and a fine grid resolution in the vertical ($\\Delta z = 100\\,\\mathrm{m}$) imposes the most stringent limit on the time step. To maintain stability (assuming $C_{max}=1$), the time step would need to be reduced to at most $\\Delta t \\le \\frac{C_{max} \\Delta z}{c} = \\frac{1 \\times 100\\,\\mathrm{m}}{340\\,\\mathrm{m\\,s^{-1}}} \\approx 0.29\\,\\mathrm{s}$. This is a common challenge in nonhydrostatic models, often addressed with time-splitting techniques where fast-moving waves are integrated with a shorter time step.\n\nThe problem asks for the maximum among the three Courant numbers, rounded to four significant figures. The maximum value is exactly $3.4$, which, when expressed to four significant figures, is $3.400$.",
            "answer": "$$\n\\boxed{3.400}\n$$"
        },
        {
            "introduction": "Beyond stability and overall cost, the accuracy of a GCRM depends on how faithfully its numerical algorithms represent the continuous equations of fluid motion. The process of discretization inevitably introduces errors, and one of the most common and illustrative is numerical diffusion. This exercise uses modified equation analysis, a powerful technique to diagnose the behavior of a numerical scheme, to reveal an artificial diffusion term that is not present in the original physical laws. By quantifying this numerical diffusion coefficient, $K_{\\mathrm{num}}$, and modeling its impact on a cloud edge , you will gain insight into how numerical choices can degrade a simulation's realism by artificially smearing sharp physical gradients.",
            "id": "4049788",
            "problem": "Consider one-dimensional linear advection of a passive scalar $q(x,t)$ representing a sharp cloud–clear-air transition in a global cloud-resolving model, governed by the conservation law $\\partial_t q + U \\partial_x q = 0$ with a constant, positive wind speed $U$. The numerical model employs a second-order upwind advection scheme with a monotonicity-preserving flux limiter that reverts locally to first-order upwind (donor–cell) near sharp gradients such as cloud edges. In the limiter-activated region, the update at grid point $i$ is\n$$\nq_i^{n+1} \\;=\\; q_i^n \\;-\\; \\lambda \\left(q_i^n - q_{i-1}^n\\right),\n$$\nwhere $\\Delta x$ is the uniform grid spacing, $\\Delta t$ is the time step, and $\\lambda = U \\Delta t / \\Delta x$ is the Courant–Friedrichs–Lewy (CFL) number.\n\nUsing Taylor-series and modified-equation analysis, derive the leading-order diffusive term that this scheme adds to the continuous equation in the limiter-activated region, and thereby identify the equivalent numerical diffusion coefficient $K_{\\mathrm{num}}$ as a function of $U$, $\\Delta x$, and $\\lambda$. Then quantify the impact on cloud-edge sharpness by modeling the local edge profile as Gaussian with an initial standard deviation $\\sigma_0 = 0.5\\,\\mathrm{km}$ and assuming that numerical diffusion alone governs the subsequent spreading. Use the Gaussian variance evolution law under diffusion,\n$$\n\\sigma^2(t) \\;=\\; \\sigma_0^2 \\;+\\; 2 K_{\\mathrm{num}} t,\n$$\nto evaluate $\\sigma(t)$ at $t = 600\\ \\mathrm{s}$ for $\\Delta x = 3\\,\\mathrm{km}$, $U = 12\\,\\mathrm{m\\,s^{-1}}$, and $\\lambda = 0.8$. Round your answer to three significant figures. Express the final result in $\\mathrm{km}$. For grading, report only the final value of $\\sigma(t)$ in $\\mathrm{km}$.",
            "solution": "The problem statement is validated as scientifically grounded, well-posed, objective, and complete. All provided information is consistent and physically realistic within the context of numerical weather prediction. The problem requires a standard modified-equation analysis of a well-known numerical scheme, followed by a calculation based on the derived result. There are no identifiable flaws.\n\nThe solution process consists of two main parts: first, the derivation of the numerical diffusion coefficient using modified-equation analysis, and second, the calculation of the cloud-edge broadening using this coefficient.\n\nPart 1: Derivation of the Numerical Diffusion Coefficient $K_{\\mathrm{num}}$.\n\nThe numerical scheme for the first-order upwind (donor-cell) method is given as:\n$$\nq_i^{n+1} \\;=\\; q_i^n \\;-\\; \\lambda \\left(q_i^n - q_{i-1}^n\\right)\n$$\nwhere $q_i^n$ is the numerical approximation of the continuous function $q(x,t)$ at grid point $x_i = i \\Delta x$ and time $t_n = n \\Delta t$. The Courant number is $\\lambda = U \\Delta t / \\Delta x$.\n\nTo perform the modified-equation analysis, we first rearrange the scheme into a form resembling a time derivative:\n$$\n\\frac{q_i^{n+1} - q_i^n}{\\Delta t} \\;=\\; -\\frac{\\lambda}{\\Delta t} \\left(q_i^n - q_{i-1}^n\\right)\n$$\nSubstituting the definition of $\\lambda$, we get:\n$$\n\\frac{q_i^{n+1} - q_i^n}{\\Delta t} \\;=\\; -\\frac{U \\Delta t / \\Delta x}{\\Delta t} \\left(q_i^n - q_{i-1}^n\\right) \\;=\\; -U \\frac{q_i^n - q_{i-1}^n}{\\Delta x}\n$$\nNow, we expand each term in a Taylor series around the point $(x_i, t_n)$, assuming $q(x,t)$ is sufficiently smooth. Let $\\partial_t q$ and $\\partial_x q$ denote the partial derivatives of $q$ evaluated at $(x_i, t_n)$.\n\nThe left-hand side (LHS) term is expanded in time:\n$$\nq_i^{n+1} = q(x_i, t_n + \\Delta t) = q(x_i, t_n) + \\Delta t \\, \\partial_t q + \\frac{(\\Delta t)^2}{2} \\partial_{tt} q + \\mathcal{O}((\\Delta t)^3)\n$$\nThus, the LHS of our equation becomes:\n$$\n\\frac{q_i^{n+1} - q_i^n}{\\Delta t} = \\frac{1}{\\Delta t} \\left( \\left[ q + \\Delta t \\, \\partial_t q + \\frac{(\\Delta t)^2}{2} \\partial_{tt} q + \\dots \\right] - q \\right) = \\partial_t q + \\frac{\\Delta t}{2} \\partial_{tt} q + \\mathcal{O}((\\Delta t)^2)\n$$\nThe right-hand side (RHS) term $q_{i-1}^n$ is expanded in space:\n$$\nq_{i-1}^n = q(x_i - \\Delta x, t_n) = q(x_i, t_n) - \\Delta x \\, \\partial_x q + \\frac{(\\Delta x)^2}{2} \\partial_{xx} q - \\frac{(\\Delta x)^3}{6} \\partial_{xxx} q + \\mathcal{O}((\\Delta x)^4)\n$$\nThus, the RHS of our equation becomes:\n$$\n-U \\frac{q_i^n - q_{i-1}^n}{\\Delta x} = -\\frac{U}{\\Delta x} \\left( q - \\left[ q - \\Delta x \\, \\partial_x q + \\frac{(\\Delta x)^2}{2} \\partial_{xx} q + \\dots \\right] \\right)\n$$\n$$\n= -\\frac{U}{\\Delta x} \\left( \\Delta x \\, \\partial_x q - \\frac{(\\Delta x)^2}{2} \\partial_{xx} q + \\dots \\right) = -U \\partial_x q + \\frac{U \\Delta x}{2} \\partial_{xx} q + \\mathcal{O}((\\Delta x)^2)\n$$\nEquating the expanded LHS and RHS, we obtain the modified equation that the numerical scheme actually solves:\n$$\n\\partial_t q + \\frac{\\Delta t}{2} \\partial_{tt} q + \\dots = -U \\partial_x q + \\frac{U \\Delta x}{2} \\partial_{xx} q + \\dots\n$$\nRearranging to match the form of the original advection equation, $\\partial_t q + U \\partial_x q = 0$:\n$$\n\\partial_t q + U \\partial_x q = \\frac{U \\Delta x}{2} \\partial_{xx} q - \\frac{\\Delta t}{2} \\partial_{tt} q + \\dots\n$$\nThe term $\\partial_{tt} q$ is not a spatial derivative. To find the leading-order truncation error in terms of spatial derivatives, we differentiate the lowest-order approximation of the equation, which is the original PDE itself: $\\partial_t q = -U \\partial_x q$. Differentiating with respect to $t$ gives $\\partial_{tt} q = \\partial_t (-U \\partial_x q) = -U \\partial_{xt} q$. Differentiating with respect to $x$ gives $\\partial_{xt} q = \\partial_x (-U \\partial_x q) = -U \\partial_{xx} q$. Therefore, $\\partial_{tt} q \\approx (-U)(-U \\partial_{xx} q) = U^2 \\partial_{xx} q$.\n\nSubstituting this back into the modified equation:\n$$\n\\partial_t q + U \\partial_x q = \\frac{U \\Delta x}{2} \\partial_{xx} q - \\frac{\\Delta t}{2} (U^2 \\partial_{xx} q) + \\text{H.O.T.}\n$$\n$$\n\\partial_t q + U \\partial_x q = \\left( \\frac{U \\Delta x}{2} - \\frac{U^2 \\Delta t}{2} \\right) \\partial_{xx} q + \\text{H.O.T.}\n$$\nFactoring out $\\frac{U \\Delta x}{2}$:\n$$\n\\partial_t q + U \\partial_x q = \\frac{U \\Delta x}{2} \\left( 1 - \\frac{U \\Delta t}{\\Delta x} \\right) \\partial_{xx} q + \\text{H.O.T.}\n$$\nRecognizing that $\\lambda = U \\Delta t / \\Delta x$, the modified equation is:\n$$\n\\partial_t q + U \\partial_x q = \\frac{U \\Delta x}{2} (1 - \\lambda) \\partial_{xx} q + \\text{H.O.T.}\n$$\nThe leading-order error term is a diffusive term, $K_{\\mathrm{num}} \\partial_{xx} q$. By comparison, the numerical diffusion coefficient is:\n$$\nK_{\\mathrm{num}} = \\frac{U \\Delta x}{2} (1 - \\lambda)\n$$\n\nPart 2: Calculation of Edge Broadening.\n\nWe are given the following values:\n$U = 12\\,\\mathrm{m\\,s^{-1}}$\n$\\Delta x = 3\\,\\mathrm{km} = 3000\\,\\mathrm{m}$\n$\\lambda = 0.8$\n$\\sigma_0 = 0.5\\,\\mathrm{km} = 500\\,\\mathrm{m}$\n$t = 600\\,\\mathrm{s}$\n\nFirst, calculate the numerical value of $K_{\\mathrm{num}}$. All units must be consistent, so we use SI units (meters, seconds).\n$$\nK_{\\mathrm{num}} = \\frac{(12\\,\\mathrm{m\\,s^{-1}}) (3000\\,\\mathrm{m})}{2} (1 - 0.8)\n$$\n$$\nK_{\\mathrm{num}} = \\frac{36000\\,\\mathrm{m^2\\,s^{-1}}}{2} (0.2)\n$$\n$$\nK_{\\mathrm{num}} = (18000\\,\\mathrm{m^2\\,s^{-1}}) (0.2) = 3600\\,\\mathrm{m^2\\,s^{-1}}\n$$\nNext, we use the Gaussian variance evolution law to find the new standard deviation $\\sigma(t)$:\n$$\n\\sigma^2(t) = \\sigma_0^2 + 2 K_{\\mathrm{num}} t\n$$\nThe initial variance is $\\sigma_0^2 = (500\\,\\mathrm{m})^2 = 250000\\,\\mathrm{m^2}$.\nNow, we substitute the values into the equation:\n$$\n\\sigma^2(t=600\\,\\mathrm{s}) = 250000\\,\\mathrm{m^2} + 2 (3600\\,\\mathrm{m^2\\,s^{-1}}) (600\\,\\mathrm{s})\n$$\n$$\n\\sigma^2(t=600\\,\\mathrm{s}) = 250000\\,\\mathrm{m^2} + (7200\\,\\mathrm{m^2}) (600)\n$$\n$$\n\\sigma^2(t=600\\,\\mathrm{s}) = 250000\\,\\mathrm{m^2} + 4320000\\,\\mathrm{m^2}\n$$\n$$\n\\sigma^2(t=600\\,\\mathrm{s}) = 4570000\\,\\mathrm{m^2}\n$$\nThe standard deviation $\\sigma(t)$ is the square root of the variance:\n$$\n\\sigma(t=600\\,\\mathrm{s}) = \\sqrt{4570000\\,\\mathrm{m^2}} \\approx 2137.7558\\,\\mathrm{m}\n$$\nThe problem requests the answer in kilometers, rounded to three significant figures.\n$$\n\\sigma(t=600\\,\\mathrm{s}) \\approx 2.1377558\\,\\mathrm{km}\n$$\nRounding to three significant figures, we get:\n$$\n\\sigma(t=600\\,\\mathrm{s}) \\approx 2.14\\,\\mathrm{km}\n$$",
            "answer": "$$\\boxed{2.14}$$"
        }
    ]
}