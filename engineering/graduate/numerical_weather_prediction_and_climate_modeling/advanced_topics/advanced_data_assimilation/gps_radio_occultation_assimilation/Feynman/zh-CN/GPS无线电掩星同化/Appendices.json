{
    "hands_on_practices": [
        {
            "introduction": "Smith-Weintraub 公式是将 GPS 无线电掩星 (RO) 信号与大气热力学状态联系起来的基石。本练习  旨在探讨该公式对湿度的敏感性，并量化一种常见简化——忽略水汽项——所引入的显著误差。通过计算“干温”偏差，您将具体理解为何在对流层低层同化 RO 数据时，精确模拟水汽是至关重要的。",
            "id": "4050120",
            "problem": "考虑在数值天气预报 (NWP) 中同化全球定位系统 (GPS) 无线电掩星 (RO) 数据。折射率的正向算子使用了经过充分检验的 Smith–Weintraub 公式，该公式通过以下关系将折射率 $N$ 与热力学状态变量联系起来：\n$$\nN \\;=\\; k_{1}\\,\\frac{p}{T} \\;+\\; k_{2}\\,\\frac{e}{T^{2}},\n$$\n其中 $p$ 是总压，$T$ 是温度，$e$ 是水汽分压，$k_{1} = 77.6\\,\\mathrm{K/hPa}$，$k_{2} = 3.73\\times 10^{5}\\,\\mathrm{K^{2}/hPa}$。在一个简单的“干”反演中，湿项 $k_{2}\\,e/T^{2}$ 被忽略，温度通过 $N \\approx k_{1}\\,p/T$ 从折射率中推断出来。\n\n假设一个代表对流层低层的湿层，其状态为 $p = 850\\,\\mathrm{hPa}$，$T = 295\\,\\mathrm{K}$，$e = 20\\,\\mathrm{hPa}$。一次 GPS RO 观测提供了折射率 $N$，该值与在上述真实状态下使用完整的 Smith–Weintraub 关系式计算出的值一致。一个忽略了湿项的数据同化系统，使用测量得到的 $N$ 和已知的气压 $p$ 来反演干关系式，从而得到一个“干”温度 $T_{d}$。\n\n从 Smith–Weintraub 公式出发，并仅使用经过充分检验的物理关系，完成以下任务：\n- 当观测折射率 $N$ 是由完整的湿关系式计算得出时，推导干反演温度 $T_{d}$ 的表达式。\n- 从第一性原理出发，推导因忽略湿项而引入的精确偏差 $\\Delta T \\equiv T_{d} - T$，并以 $\\{k_{1},k_{2},p,T,e\\}$ 的闭合形式表示。\n- 对给定的湿层状态，数值计算 $\\Delta T$ 并给出最终的数值。\n\n以开尔文为单位表示最终的数值偏差。将答案四舍五入至四位有效数字。仅使用指定的常数和给定的状态值；除明确说明的近似外，不要引入任何其他近似。",
            "solution": "分析始于对问题陈述的验证。\n\n### 第1步：提取已知条件\n-   折射率 $N$ 的 Smith–Weintraub 公式：$N = k_{1}\\,\\frac{p}{T} + k_{2}\\,\\frac{e}{T^{2}}$。\n-   干反演近似：$N \\approx k_{1}\\,\\frac{p}{T}$。\n-   常数 $k_{1}$：$77.6\\,\\mathrm{K/hPa}$。\n-   常数 $k_{2}$：$3.73 \\times 10^{5}\\,\\mathrm{K^{2}/hPa}$。\n-   真实总压：$p = 850\\,\\mathrm{hPa}$。\n-   真实温度：$T = 295\\,\\mathrm{K}$。\n-   真实水汽分压：$e = 20\\,\\mathrm{hPa}$。\n-   观测折射率 $N$ 的定义：它由真实状态下的完整湿关系式计算得出。\n-   干反演温度 $T_d$ 的定义：它使用观测到的 $N$ 和已知的 $p$ 从干关系式 $N = k_{1}\\,\\frac{p}{T_d}$ 反演得出。\n-   偏差的定义：$\\Delta T \\equiv T_{d} - T$。\n-   任务1：推导 $T_d$ 关于 $\\{k_{1},k_{2},p,T,e\\}$ 的表达式。\n-   任务2：推导精确偏差 $\\Delta T$ 关于 $\\{k_{1},k_{2},p,T,e\\}$ 的闭合形式表达式。\n-   任务3：对给定状态数值计算 $\\Delta T$，并四舍五入到四位有效数字。\n\n### 第2步：使用提取的已知条件进行验证\n该问题具有科学依据，因为它基于大气遥感中使用的标准 Smith–Weintraub 公式。压力、温度和水汽的物理数值对于对流层低层是符合实际的。该问题是适定的，提供了所有必要的信息，并有一组明确的目标，可导出一个唯一解。语言客观且精确。该问题是分析数据同化中反演误差的标准练习，并且完全有效。\n\n### 第3步：推导与求解\n\n该问题要求系统地推导因忽略水汽对大气折射率的贡献而产生的温度偏差。\n\n首先，我们确定观测折射率 $N$ 的值。该值由真实大气状态 $\\{p, T, e\\}$ 使用完整的 Smith–Weintraub 公式确定：\n$$\nN = k_{1}\\,\\frac{p}{T} + k_{2}\\,\\frac{e}{T^{2}}\n$$\n这个 $N$ 值就是 GPS RO 仪器在该大气层中会测量到的值。\n\n接下来，一个使用简单的“干”正向算子的数据同化系统尝试反演温度。它假设折射率通过简化的干公式与反演温度 $T_d$ 和已知压力 $p$ 相关：\n$$\nN = k_{1}\\,\\frac{p}{T_{d}}\n$$\n该系统使用观测到的 $N$ 和已知的 $p$ 来求解 $T_d$。\n\n为了推导 $T_d$ 的表达式，我们将两个 $N$ 的表达式相等：\n$$\nk_{1}\\,\\frac{p}{T_{d}} = k_{1}\\,\\frac{p}{T} + k_{2}\\,\\frac{e}{T^{2}}\n$$\n我们现在对这个方程求解 $T_d$。首先，我们可以取等式两边的倒数：\n$$\n\\frac{T_{d}}{k_{1}p} = \\frac{1}{k_{1}\\,\\frac{p}{T} + k_{2}\\,\\frac{e}{T^{2}}}\n$$\n两边乘以 $k_1 p$ 得到干反演温度 $T_d$ 的表达式：\n$$\nT_d = \\frac{k_{1}p}{k_{1}\\,\\frac{p}{T} + k_{2}\\,\\frac{e}{T^{2}}}\n$$\n为了得到一个更方便的形式，我们可以将分子和分母同乘以 $T^2$：\n$$\nT_d = \\frac{k_{1}pT^{2}}{T^2 \\left(k_{1}\\,\\frac{p}{T} + k_{2}\\,\\frac{e}{T^{2}}\\right)} = \\frac{k_{1}pT^{2}}{k_{1}pT + k_{2}e}\n$$\n这就是所要求的 $T_d$ 关于真实状态变量和物理常数的表达式。\n\n现在，我们推导偏差 $\\Delta T = T_d - T$ 的表达式。我们将 $T_d$ 的表达式代入此定义：\n$$\n\\Delta T = \\frac{k_{1}pT^{2}}{k_{1}pT + k_{2}e} - T\n$$\n为了简化，我们进行通分：\n$$\n\\Delta T = \\frac{k_{1}pT^{2} - T(k_{1}pT + k_{2}e)}{k_{1}pT + k_{2}e}\n$$\n展开分子中的项得到：\n$$\n\\Delta T = \\frac{k_{1}pT^{2} - k_{1}pT^{2} - k_{2}eT}{k_{1}pT + k_{2}e}\n$$\n分子中的前两项相消，留下偏差的最终闭合形式表达式：\n$$\n\\Delta T = \\frac{-k_{2}eT}{k_{1}pT + k_{2}e}\n$$\n该表达式表明，对于正的物理量，偏差总是负值，这意味着在湿润大气中，干反演总是低估真实温度。\n\n最后，我们使用给定的值对该偏差进行数值计算：\n- $k_{1} = 77.6\\,\\mathrm{K/hPa}$\n- $k_{2} = 3.73 \\times 10^{5}\\,\\mathrm{K^{2}/hPa}$\n- $p = 850\\,\\mathrm{hPa}$\n- $T = 295\\,\\mathrm{K}$\n- $e = 20\\,\\mathrm{hPa}$\n\n我们计算 $\\Delta T$ 表达式的分子和分母。\n分子：\n$$\n-k_{2}eT = -(3.73 \\times 10^{5}\\,\\mathrm{K^{2}/hPa}) \\times (20\\,\\mathrm{hPa}) \\times (295\\,\\mathrm{K}) = -2200700000\\,\\mathrm{K^{3}}\n$$\n分母：\n$$\nk_{1}pT + k_{2}e = (77.6\\,\\mathrm{K/hPa} \\times 850\\,\\mathrm{hPa} \\times 295\\,\\mathrm{K}) + (3.73 \\times 10^{5}\\,\\mathrm{K^{2}/hPa} \\times 20\\,\\mathrm{hPa})\n$$\n$$\nk_{1}pT + k_{2}e = (19458200\\,\\mathrm{K^{2}}) + (7460000\\,\\mathrm{K^{2}}) = 26918200\\,\\mathrm{K^{2}}\n$$\n现在，我们计算比值：\n$$\n\\Delta T = \\frac{-2200700000\\,\\mathrm{K^{3}}}{26918200\\,\\mathrm{K^{2}}} \\approx -81.75549\\,\\mathrm{K}\n$$\n问题要求将最终数值四舍五入到四位有效数字。第五位有效数字是 $5$，所以我们将第四位数字向上取整。\n$$\n\\Delta T \\approx -81.76\\,\\mathrm{K}\n$$\n这一显著的负偏差凸显了在折射率计算中考虑湿项的关键重要性，尤其是在水汽丰富的对流层低层。",
            "answer": "$$\n\\boxed{-81.76}\n$$"
        },
        {
            "introduction": "在分析中性大气之前，必须对原始的 GPS 信号进行电离层效应校正，因为这是主要的误差来源。本练习  深入探讨了标准的双频校正方法，该方法可以消除一阶电离层项。您将推导高阶效应引起的残余误差并量化其大小，从而深入了解这一基本预处理步骤的精度限制。",
            "id": "4050100",
            "problem": "在用于数值天气预报和气候模型数据同化的全球定位系统（GPS）无线电掩星（RO）技术中，双频校正旨在消除电离层对弯曲角的主要贡献，同时保留中性大气信号。考虑电离层中的冷等离子体色散（忽略碰撞）以及从Maxwell方程组和Appleton–Hartree关系导出的相关磁离子折射率展开式。在高频、弱磁化极限下，相折射率可以展开为 $f^{-1}$ 的幂的渐近级数，其主要项引起的弯曲角贡献分别按 $f^{-2}$（一阶等离子体项）、$f^{-3}$（与磁场相关的二階项）和 $f^{-4}$（二次等离子体项）的比例缩放。在中性大气中，微波波段的弯曲与频率无关。\n\n您在两个GPS载波频率 $f_1$ 和 $f_2$ 处测量弯曲角，其中 $f_1 = 1.57542 \\times 10^{9}\\ \\mathrm{Hz}$ 且 $f_2 = 1.22760 \\times 10^{9}\\ \\mathrm{Hz}$。设频率 $f$ 处的弯曲角可分解为\n$$\n\\alpha(f) \\;=\\; \\alpha_{\\mathrm{N}} \\;+\\; \\frac{A_2}{f^{2}} \\;+\\; \\frac{A_3}{f^{3}} \\;+\\; \\frac{A_4}{f^{4}} \\;,\n$$\n其中 $\\alpha_{\\mathrm{N}}$ 是较低平流层切点高度处的中性大气弯曲角，而 $A_2$、$A_3$、$A_4$ 是由射线路径上的电离层特性（电子密度、磁场方向及其梯度）决定的与频率无关的系数。构建一个保留中性大气信号的线性组合 $\\alpha_{\\mathrm{c}} = w_1 \\alpha(f_1) + w_2 \\alpha(f_2)$，使其能够精确消除 $f^{-2}$ 项。然后，推导经过此双频校正后，由 $f^{-3}$ 和 $f^{-4}$ 项引起的剩余电离层弯曲的解析表达式。\n\n为了进行定量估算，请在地磁平静的中纬度掩星事件中，使用以下在 $f_1$ 频率下科学上合理的高阶单频电离层弯曲值：\n- 在 $f_1$ 处与磁场相关的二阶弯曲为 $\\alpha_3(f_1) = 3.2 \\times 10^{-8}\\ \\mathrm{rad}$。\n- 在 $f_1$ 处的二次等离子体弯曲为 $\\alpha_4(f_1) = 4.5 \\times 10^{-10}\\ \\mathrm{rad}$。\n\n假设这些高阶贡献分别严格按 $f^{-3}$ 和 $f^{-4}$ 缩放，因此有 $\\alpha_3(f) = \\alpha_3(f_1)\\, (f_1/f)^3$ 和 $\\alpha_4(f) = \\alpha_4(f_1)\\, (f_1/f)^4$。取 $20\\ \\mathrm{km}$ 切点高度处的中性大气弯曲角为 $\\alpha_{\\mathrm{N}} = 2.0 \\times 10^{-4}\\ \\mathrm{rad}$。\n\n计算双频校正后剩余电离层弯曲的量级（包括 $f^{-3}$ 和 $f^{-4}$ 的贡献）与中性大气弯曲角 $\\alpha_{\\mathrm{N}}$ 的比值 $r$。将您的最终答案四舍五入到三位有效数字。将比值 $r$ 表示为无单位的小数。",
            "solution": "用户提供的问题已经过严格验证，并被确定为**有效**。该问题在科学上基于无线电波在等离子体中传播的物理学，问题设定良好，具有唯一且有意义的解，是GPS无线电掩星数据分析领域的标准问题。所提供的参数是真实且一致的。我现在将进行完整解答。\n\n给定频率 $f$ 下的弯曲角 $\\alpha$ 建模为：\n$$\n\\alpha(f) = \\alpha_{\\mathrm{N}} + \\frac{A_2}{f^{2}} + \\frac{A_3}{f^{3}} + \\frac{A_4}{f^{4}}\n$$\n其中 $\\alpha_{\\mathrm{N}}$ 是与频率无关的中性大气弯曲角，后续各项是来自电离层的贡献。对于给定的掩星事件，系数 $A_2$、$A_3$ 和 $A_4$ 被认为是常数。\n\n我们的任务是构建在两个频率 $f_1$ 和 $f_2$ 处测量的弯曲角的线性组合，以分离出中性大气弯曲角。设此校正后的弯曲角为 $\\alpha_{\\mathrm{c}}$：\n$$\n\\alpha_{\\mathrm{c}} = w_1 \\alpha(f_1) + w_2 \\alpha(f_2)\n$$\n权重 $w_1$ 和 $w_2$ 必须满足两个条件：\n1.  该组合必须“保留中性大气信号”，这意味着如果只有中性大气存在（即 $A_2=A_3=A_4=0$），该组合将得到 $\\alpha_{\\mathrm{N}}$。这要求权重之和为1：\n    $$\n    w_1 + w_2 = 1 \\quad (*_1)\n    $$\n2.  主导的电离层项，即按 $f^{-2}$ 比例缩放的项，必须被精确消除。将 $\\alpha(f)$ 的模型代入 $\\alpha_{\\mathrm{c}}$ 的表达式中，$A_2$ 项的组合系数为 $\\left(\\frac{w_1}{f_1^2} + \\frac{w_2}{f_2^2}\\right)$。将其设为零，得到我们的第二个条件：\n    $$\n    \\frac{w_1}{f_1^{2}} + \\frac{w_2}{f_2^{2}} = 0 \\quad (*_2)\n    $$\n我们得到了关于 $w_1$ 和 $w_2$ 的一个二元线性方程组。由 $(*_1)$，我们有 $w_2 = 1 - w_1$。将其代入 $(*_2)$：\n$$\n\\frac{w_1}{f_1^{2}} + \\frac{1 - w_1}{f_2^{2}} = 0\n$$\n两边乘以 $f_1^2 f_2^2$ 以消去分母：\n$$\nw_1 f_2^2 + (1 - w_1) f_1^2 = 0\n$$\n$$\nw_1 f_2^2 + f_1^2 - w_1 f_1^2 = 0\n$$\n$$\nw_1 (f_2^2 - f_1^2) = -f_1^2\n$$\n求解 $w_1$：\n$$\nw_1 = \\frac{-f_1^2}{f_2^2 - f_1^2} = \\frac{f_1^2}{f_1^2 - f_2^2}\n$$\n现在，求解 $w_2$：\n$$\nw_2 = 1 - w_1 = 1 - \\frac{f_1^2}{f_1^2 - f_2^2} = \\frac{(f_1^2 - f_2^2) - f_1^2}{f_1^2 - f_2^2} = \\frac{-f_2^2}{f_1^2 - f_2^2}\n$$\n使用这些权重，校正后的弯曲角 $\\alpha_{\\mathrm{c}}$ 变为：\n$$\n\\alpha_{\\mathrm{c}} = (w_1 + w_2) \\alpha_{\\mathrm{N}} + A_2 \\left( \\frac{w_1}{f_1^2} + \\frac{w_2}{f_2^2} \\right) + A_3 \\left( \\frac{w_1}{f_1^3} + \\frac{w_2}{f_2^3} \\right) + A_4 \\left( \\frac{w_1}{f_1^4} + \\frac{w_2}{f_2^4} \\right)\n$$\n根据构造，$w_1+w_2=1$ 且 $A_2$ 项为零。因此：\n$$\n\\alpha_{\\mathrm{c}} = \\alpha_{\\mathrm{N}} + A_3 \\left( \\frac{w_1}{f_1^3} + \\frac{w_2}{f_2^3} \\right) + A_4 \\left( \\frac{w_1}{f_1^4} + \\frac{w_2}{f_2^4} \\right)\n$$\n剩余电离层弯曲 $\\Delta \\alpha_{\\mathrm{iono}}$ 是校正角 $\\alpha_{\\mathrm{c}}$ 与真实中性大气角 $\\alpha_{\\mathrm{N}}$ 之间的差值：\n$$\n\\Delta \\alpha_{\\mathrm{iono}} = \\alpha_{\\mathrm{c}} - \\alpha_{\\mathrm{N}} = A_3 \\left( \\frac{w_1}{f_1^3} + \\frac{w_2}{f_2^3} \\right) + A_4 \\left( \\frac{w_1}{f_1^4} + \\frac{w_2}{f_2^4} \\right)\n$$\n现在我们将 $w_1$ 和 $w_2$ 的表达式代入括号中的项。\n对于 $A_3$ 项：\n$$\n\\frac{w_1}{f_1^3} + \\frac{w_2}{f_2^3} = \\frac{1}{f_1^2 - f_2^2} \\left[ \\frac{f_1^2}{f_1^3} - \\frac{f_2^2}{f_2^3} \\right] = \\frac{1}{f_1^2 - f_2^2} \\left( \\frac{1}{f_1} - \\frac{1}{f_2} \\right) = \\frac{1}{(f_1-f_2)(f_1+f_2)} \\frac{f_2-f_1}{f_1f_2} = - \\frac{1}{f_1 f_2 (f_1+f_2)}\n$$\n对于 $A_4$ 项：\n$$\n\\frac{w_1}{f_1^4} + \\frac{w_2}{f_2^4} = \\frac{1}{f_1^2 - f_2^2} \\left[ \\frac{f_1^2}{f_1^4} - \\frac{f_2^2}{f_2^4} \\right] = \\frac{1}{f_1^2 - f_2^2} \\left( \\frac{1}{f_1^2} - \\frac{1}{f_2^2} \\right) = \\frac{1}{f_1^2 - f_2^2} \\frac{f_2^2-f_1^2}{f_1^2 f_2^2} = - \\frac{1}{f_1^2 f_2^2}\n$$\n剩余弯曲的解析表达式为：\n$$\n\\Delta \\alpha_{\\mathrm{iono}} = - \\frac{A_3}{f_1 f_2 (f_1+f_2)} - \\frac{A_4}{f_1^2 f_2^2}\n$$\n问题提供了在频率 $f_1$ 处的高阶弯曲项：$\\alpha_3(f_1) = A_3/f_1^3$ 和 $\\alpha_4(f_1) = A_4/f_1^4$。我们可以将 $A_3$ 和 $A_4$ 表示为 $A_3 = \\alpha_3(f_1) f_1^3$ 和 $A_4 = \\alpha_4(f_1) f_1^4$。将这些代入剩余表达式中：\n$$\n\\Delta \\alpha_{\\mathrm{iono}} = - \\frac{\\alpha_3(f_1)f_1^3}{f_1 f_2 (f_1+f_2)} - \\frac{\\alpha_4(f_1)f_1^4}{f_1^2 f_2^2} = - \\alpha_3(f_1) \\frac{f_1^2}{f_2(f_1+f_2)} - \\alpha_4(f_1) \\frac{f_1^2}{f_2^2}\n$$\n为简化数值计算，令 $\\gamma = f_1/f_2$。表达式变为：\n$$\n\\Delta \\alpha_{\\mathrm{iono}} = - \\alpha_3(f_1) \\frac{\\gamma^2}{\\gamma+1} - \\alpha_4(f_1) \\gamma^2\n$$\n给定的值为：\n$f_1 = 1.57542 \\times 10^{9}\\ \\mathrm{Hz}$\n$f_2 = 1.22760 \\times 10^{9}\\ \\mathrm{Hz}$\n$\\alpha_{\\mathrm{N}} = 2.0 \\times 10^{-4}\\ \\mathrm{rad}$\n$\\alpha_3(f_1) = 3.2 \\times 10^{-8}\\ \\mathrm{rad}$\n$\\alpha_4(f_1) = 4.5 \\times 10^{-10}\\ \\mathrm{rad}$\n\n频率之比为 $\\gamma = \\frac{1.57542}{1.22760} = \\frac{77}{60}$。\n我们计算涉及 $\\gamma$ 的因子：\n$$\n\\gamma^2 = \\left(\\frac{77}{60}\\right)^2 = \\frac{5929}{3600}\n$$\n$$\n\\frac{\\gamma^2}{\\gamma+1} = \\frac{(77/60)^2}{77/60 + 1} = \\frac{5929/3600}{137/60} = \\frac{5929}{3600} \\frac{60}{137} = \\frac{5929}{60 \\times 137} = \\frac{5929}{8220}\n$$\n现在我们计算剩余弯曲：\n$$\n\\Delta \\alpha_{\\mathrm{iono}} = - (3.2 \\times 10^{-8}) \\left(\\frac{5929}{8220}\\right) - (4.5 \\times 10^{-10}) \\left(\\frac{5929}{3600}\\right)\n$$\n$$\n\\Delta \\alpha_{\\mathrm{iono}} \\approx - (3.2 \\times 10^{-8})(0.7212895) - (4.5 \\times 10^{-10})(1.646944)\n$$\n$$\n\\Delta \\alpha_{\\mathrm{iono}} \\approx -2.3081265 \\times 10^{-8} - 0.741125 \\times 10^{-9}\n$$\n$$\n\\Delta \\alpha_{\\mathrm{iono}} \\approx -2.3081265 \\times 10^{-8} - 0.0741125 \\times 10^{-8} \\approx -2.382239 \\times 10^{-8}\\ \\mathrm{rad}\n$$\n剩余电离层弯曲的量级为 $|\\Delta \\alpha_{\\mathrm{iono}}| \\approx 2.382239 \\times 10^{-8}\\ \\mathrm{rad}$。\n问题要求计算该量级与中性大气弯曲角 $\\alpha_{\\mathrm{N}}$ 的比值 $r$：\n$$\nr = \\frac{|\\Delta \\alpha_{\\mathrm{iono}}|}{\\alpha_{\\mathrm{N}}} = \\frac{2.382239 \\times 10^{-8}}{2.0 \\times 10^{-4}} = 1.1911195 \\times 10^{-4}\n$$\n$r$ 的小数值为 $0.00011911195$。四舍五入到三位有效数字得到 $0.000119$。",
            "answer": "$$\\boxed{0.000119}$$"
        },
        {
            "introduction": "诸如 4D-Var 等变分资料同化系统依赖于观测算子的伴随算子来高效地计算代价函数的梯度。这个高级练习  将指导您推导线性化 Abel 变换的伴随算子，该变换将大气折射率剖面与弯曲角联系起来。掌握这一推导过程是理解 GPS RO 观测如何被整合到现代数值天气预报系统核心机制的关键。",
            "id": "4050135",
            "problem": "在三维数值天气预报和气候模拟中，同化全球定位系统 (GPS) 无线电掩星 (RO) 弯曲角需要一个正演算子的切线性与伴随算子，该正演算子将大气的垂直结构映射为作为影响参数函数的观测弯曲角。考虑一个球对称大气，其折射率 $n(r)$ 仅依赖于距曲率中心的半径 $r$（为此，地球可被局部视为球对称）。根据几何光学中的斯涅尔定律，射线的​​影响参数 $a$ 沿路径守恒，即 $a = n(r)\\,r\\,\\sin\\theta$，其中 $\\theta$ 是射线的局部天顶角。\n\n使用以下基本依据：\n- 球对称介质中的几何光学，包括 $a = n(r)\\,r\\,\\sin\\theta$ 是沿射线路径的运动不变量。\n- 影响参数为 $a$ 的射线的弯曲角 $\\alpha(a)$ 是通过沿路径对局部射线曲率从拐点 $r_{t}$（其中 $n(r_{t})\\,r_{t} = a$）到无穷大进行积分得到的。\n- 围绕参考大气进行线性化，其中 $n(r) \\approx 1$（即折射率差 $\\epsilon(r) = n(r)-1$ 很小），且角度以弧度表示。\n\n从这些基本依据出发，在 $n(r) \\approx 1$ 的近似条件下，推导切线性弯曲角正演算子的 Abel 相关积分形式，该算子将状态变量 $x(r) = \\frac{d}{dr}\\ln n(r)$ 映射到观测弯曲角 $\\alpha(a)$。然后，通过 $\\alpha(a) = (F x)(a)$ 定义算子 $F$，并通过 $\\langle x_{1}, x_{2} \\rangle_{r} = \\int_{0}^{\\infty} x_{1}(r)\\,x_{2}(r)\\,dr$ 和 $\\langle y_{1}, y_{2} \\rangle_{a} = \\int_{0}^{\\infty} y_{1}(a)\\,y_{2}(a)\\,da$ 分别定义状态空间和观测空间上的标准内积。构建伴随算子 $F^{\\dagger}$，使得对于所有测试函数 $\\lambda(a)$，都有 $\\langle F x, \\lambda \\rangle_{a} = \\langle x, F^{\\dagger} \\lambda \\rangle_{r}$ 成立，并推导伴随 Abel 相关积分的显式转置核。\n\n讨论实现正演和伴随算子的数值稳定性，包括近拐点奇点的处理和为保持伴随性而进行的一致离散化。\n\n你的最终答案必须是出现在 $(F^{\\dagger}\\lambda)(r) = \\int_{0}^{\\infty} K^{\\dagger}(r,a)\\,\\lambda(a)\\,da$ 中的伴随核 $K^{\\dagger}(r,a)$ 的单个闭式解析表达式。无需进行数值计算，最终表达式中不应包含任何单位。",
            "solution": "该问题要求在特定近似条件下，推导 GPS 无线电掩星 (RO) 弯曲角的切线性正演算子，构建其伴随算子，并推导伴随核。此外，还要求讨论数值实现的问题。\n\n**第一部分：切线性正演算子的推导**\n\n起点是在球对称介质中，弯曲角 $\\alpha$ 作为影响参数 $a$ 的函数的基本表达式，其中折射率为 $n(r)$：\n$$ \\alpha(a) = -2a \\int_{r_t}^{\\infty} \\frac{\\frac{d}{dr}\\ln n(r)}{\\sqrt{n(r)^2 r^2 - a^2}} dr $$\n此处，$r$ 是距曲率中心的径向距离，$r_t$ 是拐点半径，由条件 $n(r_t)r_t = a$ 定义。因子 2 是考虑到射线路径相对于拐点的对称性。\n\n问题将状态变量定义为 $x(r) = \\frac{d}{dr}\\ln n(r)$。将其代入弯曲角公式可得：\n$$ \\alpha(a) = -2a \\int_{r_t}^{\\infty} \\frac{x(r)}{\\sqrt{n(r)^2 r^2 - a^2}} dr $$\n这个表达式还不是一个将 $x(r)$ 映射到 $\\alpha(a)$ 的线性算子，因为被积函数的分母（通过 $n(r)$）和积分下限 $r_t$ 都依赖于 $x(r)$（因为 $\\ln n(r) = \\int \\! x(r) \\, dr$）。\n\n问题指定在“$n(r) \\approx 1$ 的近似条件下”进行推导。该近似用于线性化算子。应用 $n(r) \\approx 1$：\n1.  拐点条件 $n(r_t)r_t = a$ 简化为 $r_t \\approx a$。\n2.  分母平方根中的项简化为 $n(r)^2 r^2 - a^2 \\approx r^2 - a^2$。\n\n在这些近似条件下，弯曲角公式变为：\n$$ \\alpha(a) = -2a \\int_{a}^{\\infty} \\frac{x(r)}{\\sqrt{r^2 - a^2}} dr $$\n这是一个将状态函数 $x(r)$ 映射到观测函数 $\\alpha(a)$ 的线性积分算子。我们将其定义为正演算子 $F$：\n$$ (Fx)(a) = \\alpha(a) = \\int_{0}^{\\infty} K(a,r) x(r) dr $$\n其中正演算子的核 $K(a,r)$ 为：\n$$ K(a,r) = \\begin{cases} \\frac{-2a}{\\sqrt{r^2 - a^2}} & \\text{当 } r > a \\\\ 0 & \\text{当 } r \\le a \\end{cases} $$\n这可以用 Heaviside 阶跃函数 $H(\\cdot)$ 紧凑地写为 $K(a,r) = \\frac{-2a}{\\sqrt{r^2 - a^2}} H(r-a)$。\n\n**第二部分：伴随算子及其核的构建**\n\n伴随算子 $F^{\\dagger}$ 由关系式 $\\langle F x, \\lambda \\rangle_{a} = \\langle x, F^{\\dagger} \\lambda \\rangle_{r}$ 定义，适用于任何合适的测试函数 $x(r)$ 和 $\\lambda(a)$。内积定义如下：\n$$ \\langle y_1, y_2 \\rangle_{a} = \\int_{0}^{\\infty} y_1(a) y_2(a) da $$\n$$ \\langle x_1, x_2 \\rangle_{r} = \\int_{0}^{\\infty} x_1(r) x_2(r) dr $$\n\n我们从伴随定义的左侧开始：\n$$ \\langle F x, \\lambda \\rangle_{a} = \\int_{0}^{\\infty} (Fx)(a) \\lambda(a) da $$\n代入 $(Fx)(a)$ 的表达式：\n$$ \\langle F x, \\lambda \\rangle_{a} = \\int_{0}^{\\infty} \\left( -2a \\int_{a}^{\\infty} \\frac{x(r)}{\\sqrt{r^2 - a^2}} dr \\right) \\lambda(a) da $$\n这可以写成在 $(a,r)$ 平面上的二重积分：\n$$ \\langle F x, \\lambda \\rangle_{a} = \\int_{0}^{\\infty} \\int_{a}^{\\infty} \\frac{-2a \\, x(r) \\, \\lambda(a)}{\\sqrt{r^2 - a^2}} dr \\, da $$\n积分域为 $\\{(a,r) \\in \\mathbb{R}^2 \\mid 0 \\le a  \\infty, a \\le r  \\infty\\}$。这等价于积分域 $\\{(a,r) \\in \\mathbb{R}^2 \\mid 0 \\le r  \\infty, 0 \\le a \\le r\\}$。因此，我们可以交换积分顺序（根据 Fubini 定理）：\n$$ \\langle F x, \\lambda \\rangle_{a} = \\int_{0}^{\\infty} \\int_{0}^{r} \\frac{-2a \\, x(r) \\, \\lambda(a)}{\\sqrt{r^2 - a^2}} da \\, dr $$\n现在，我们可以将仅依赖于 $r$ 的项从内层积分（对 $a$ 的积分）中提出来：\n$$ \\langle F x, \\lambda \\rangle_{a} = \\int_{0}^{\\infty} x(r) \\left( \\int_{0}^{r} \\frac{-2a \\, \\lambda(a)}{\\sqrt{r^2 - a^2}} da \\right) dr $$\n该表达式现在具有伴随定义右侧的形式，即 $\\langle x, F^{\\dagger} \\lambda \\rangle_{r} = \\int_{0}^{\\infty} x(r) (F^{\\dagger}\\lambda)(r) dr$。通过比较，我们可以确定伴随算子 $F^{\\dagger}$ 对函数 $\\lambda(a)$ 的作用：\n$$ (F^{\\dagger}\\lambda)(r) = \\int_{0}^{r} \\frac{-2a \\, \\lambda(a)}{\\sqrt{r^2 - a^2}} da $$\n伴随算子定义为 $(F^{\\dagger}\\lambda)(r) = \\int_{0}^{\\infty} K^{\\dagger}(r,a) \\lambda(a) da$。将此与我们推导的表达式进行比较，可以提取出伴随算子的显式核 $K^{\\dagger}(r,a)$：\n$$ K^{\\dagger}(r,a) = \\begin{cases} \\frac{-2a}{\\sqrt{r^2 - a^2}}  \\text{当 } 0 \\le a  r \\\\ 0  \\text{当 } a \\ge r \\end{cases} $$\n使用 Heaviside 阶跃函数 $H(z)$（当 $z>0$ 时为 1，当 $z0$ 时为 0），该核可以写成单个表达式：\n$$ K^{\\dagger}(r,a) = \\frac{-2a}{\\sqrt{r^2 - a^2}} H(r - a) $$\n这是原始正演算子的转置核。对于实核，伴随核是正演核的转置：$K^{\\dagger}(r,a) = K(a,r)$。\n\n**第三部分：关于数值稳定性的讨论**\n\n正演算子 $F$ 及其伴随算子 $F^{\\dagger}$ 的数值实现面临挑战，主要与一个可积奇点以及在离散系统中保持伴随性质有关。\n\n1.  **奇点处理**：\n    正演和伴随积分核在积分区间的一端（对于 $F$ 是在 $r=a$ 处，对于 $F^{\\dagger}$ 是在 $a=r$ 处）都有一个 $(u^2-v^2)^{-1/2}$ 形式的奇点。虽然积分是收敛的，但如果网格点与奇点重合，标准的数值积分方案（如梯形法则）会失效或精度很差。\n    处理此奇点的有效策略包括：\n    *   **变量替换**：通过适当的变量替换可以消除奇点。对于正演积分，像 $r = a \\cosh(t)$ 这样的替换将积分转换为 $\\alpha(a) = -2a \\int_0^\\infty x(a \\cosh t) dt$，其被积函数是正则的。对于伴随积分，像 $a = r \\sin(\\phi)$ 这样的替换得到 $(F^{\\dagger}\\lambda)(r) = -2r \\int_0^{\\pi/2} \\sin(\\phi) \\lambda(r \\sin \\phi) d\\phi$，这也是正则的。\n    *   **专用求积法**：可以使用为这类权重函数设计的高斯求积法则，例如，在将积分重构为有相应求积法则表格的标准形式后。\n    *   **奇点减去法**：可将被积函数分解为一个可解析积分的奇异部分和一个可用标准求积法处理的正则部分。例如，可以写出 $x(r) = x(a) + (x(r)-x(a))$，解析地积分包含 $x(a)$ 的项，然后数值积分剩下的正则部分。\n\n2.  **离散化中伴随性的保持**：\n    在同化系统中，算子被离散化为矩阵。连续的伴随性质 $\\langle F x, \\lambda \\rangle = \\langle x, F^{\\dagger} \\lambda \\rangle$ 必须转换为其离散形式 $\\mathbf{y}^T (\\mathbf{F} \\mathbf{x}) = (\\mathbf{F}^T \\mathbf{y})^T \\mathbf{x}$，这意味着伴随算子的矩阵表示 $\\mathbf{F}^{\\dagger}$ 必须是正演算子矩阵的转置 $\\mathbf{F}^T$。\n    一个常见的陷阱是先离散化解析的正演算子 $F$ 得到矩阵 $\\mathbf{F}$，然后分别离散化解析的伴随算子 $F^{\\dagger}$ 得到矩阵 $\\mathbf{G}$。通常情况下，$\\mathbf{G} \\ne \\mathbf{F}^T$，除非离散化方案以一种非常特定且一致的方式选择。这种不一致性，被称为“破坏伴随性”，会降低或破坏变分资料同化中使用的最小化算法的收敛性。\n    正确的步骤是首先定义离散的正演算子 $\\mathbf{F}$（即实现正演模型的代码），然后将其精确的矩阵转置作为离散伴随 $\\mathbf{F}^{\\dagger}$。这通常通过直接从正演模型代码开发伴随代码来实现，可以是手动逆转操作流程并转置每个线性操作，也可以通过使用自动微分工具。这确保了离散伴随性质能够保持到机器精度。",
            "answer": "$$\\boxed{\\frac{-2a}{\\sqrt{r^2 - a^2}} H(r - a)}$$"
        }
    ]
}