{
    "hands_on_practices": [
        {
            "introduction": "在集合卡尔曼滤波中，背景误差协方差是通过有限的集合成员来估计的，这不可避免地会引入抽样误差。本练习将通过一个简单的例子，让您亲手计算并揭示这种误差如何导致物理上不相关的远距离变量之间产生“伪相关”。理解这个问题是认识到为何需要像LETKF这样的局地化集合方法的关键第一步。",
            "id": "4060583",
            "problem": "在数值天气预报和气候模拟中，局地集合变换卡尔曼滤波（LETKF）依赖于从有限个集合成员中估计的协方差结构来更新状态。考虑一个玩具三变量模型状态，代表三个不同的空间位置，其中变量 $x_{1}$ 和 $x_{2}$ 相邻，而 $x_{3}$ 与两者都相距较远。假设由于 $x_{1}$ 和 $x_{3}$ 之间的距离很远，它们之间的真实背景协方差可以忽略不计，但它是从一个大小为 $m=3$ 的有限集合中估计出来的。\n\n给定三个集合成员的状态向量，\n$$\n\\mathbf{x}^{(1)} = \\begin{pmatrix} 2 \\\\ 1 \\\\ -1 \\end{pmatrix}, \\quad\n\\mathbf{x}^{(2)} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 2 \\end{pmatrix}, \\quad\n\\mathbf{x}^{(3)} = \\begin{pmatrix} 3 \\\\ 2 \\\\ -1 \\end{pmatrix},\n$$\n其中每个分量都是无量纲的。\n\n从核心定义出发：\n- 集合均值为 $\\bar{\\mathbf{x}} = \\frac{1}{m} \\sum_{k=1}^{m} \\mathbf{x}^{(k)}$。\n- 集合扰动为 $\\mathbf{a}^{(k)} = \\mathbf{x}^{(k)} - \\bar{\\mathbf{x}}$。\n- 无偏样本协方差为 $\\mathbf{C} = \\frac{1}{m-1} \\sum_{k=1}^{m} \\mathbf{a}^{(k)} \\mathbf{a}^{(k)\\top}$。\n\n请执行以下操作：\n1. 计算集合均值 $\\bar{\\mathbf{x}}$ 和当 $k=1,2,3$ 时的集合扰动 $\\mathbf{a}^{(k)}$。\n2. 使用无偏估计量计算 $3 \\times 3$ 的样本协方差矩阵 $\\mathbf{C}$。\n3. 确定 $\\mathbf{C}$ 的秩，并根据 $m=3$ 个集合成员所施加的结构，从第一性原理出发证明你的结论。\n4. 使用 $\\mathbf{C}$ 计算 $x_{1}$ 和 $x_{3}$ 之间的样本相关系数，其定义为 $r_{13} = \\frac{C_{13}}{\\sqrt{C_{11} C_{33}}}$，并简要解释为什么在这里出现非零值构成了 LETKF 背景下的伪长程相关，以及局地化在概念上是如何解决这个问题的（不需要具体的局地化锥化函数公式）。\n\n将你的最终答案表示为一个单行矩阵，其中包含按行优先顺序排列的 $\\mathbf{C}$ 的九个元素，其后是作为第十个元素的 $\\mathbf{C}$ 的秩。无需四舍五入。所有量均为无量纲。",
            "solution": "用户提供了一个在局地集合变换卡尔曼滤波（LETKF）背景下的问题，并要求基于一组给定的集合状态向量进行若干计算和概念性解释。该问题定义明确，科学上合理，并提供了所有必要的数据和定义。\n\n给定的集合大小为 $m=3$。状态向量是三维的，因此状态维数是 $n=3$。集合成员为：\n$$\n\\mathbf{x}^{(1)} = \\begin{pmatrix} 2 \\\\ 1 \\\\ -1 \\end{pmatrix}, \\quad\n\\mathbf{x}^{(2)} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 2 \\end{pmatrix}, \\quad\n\\mathbf{x}^{(3)} = \\begin{pmatrix} 3 \\\\ 2 \\\\ -1 \\end{pmatrix}\n$$\n\n**1. 计算集合均值和扰动**\n\n集合均值 $\\bar{\\mathbf{x}}$ 定义为 $\\bar{\\mathbf{x}} = \\frac{1}{m} \\sum_{k=1}^{m} \\mathbf{x}^{(k)}$。当 $m=3$ 时，我们有：\n$$\n\\bar{\\mathbf{x}} = \\frac{1}{3} \\left( \\mathbf{x}^{(1)} + \\mathbf{x}^{(2)} + \\mathbf{x}^{(3)} \\right) = \\frac{1}{3} \\left( \\begin{pmatrix} 2 \\\\ 1 \\\\ -1 \\end{pmatrix} + \\begin{pmatrix} 1 \\\\ 0 \\\\ 2 \\end{pmatrix} + \\begin{pmatrix} 3 \\\\ 2 \\\\ -1 \\end{pmatrix} \\right) = \\frac{1}{3} \\begin{pmatrix} 2+1+3 \\\\ 1+0+2 \\\\ -1+2-1 \\end{pmatrix} = \\frac{1}{3} \\begin{pmatrix} 6 \\\\ 3 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\n集合扰动 $\\mathbf{a}^{(k)}$ 定义为 $\\mathbf{a}^{(k)} = \\mathbf{x}^{(k)} - \\bar{\\mathbf{x}}$。\n对于 $k=1$：\n$$\n\\mathbf{a}^{(1)} = \\mathbf{x}^{(1)} - \\bar{\\mathbf{x}} = \\begin{pmatrix} 2 \\\\ 1 \\\\ -1 \\end{pmatrix} - \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ -1 \\end{pmatrix}\n$$\n对于 $k=2$：\n$$\n\\mathbf{a}^{(2)} = \\mathbf{x}^{(2)} - \\bar{\\mathbf{x}} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 2 \\end{pmatrix} - \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ -1 \\\\ 2 \\end{pmatrix}\n$$\n对于 $k=3$：\n$$\n\\mathbf{a}^{(3)} = \\mathbf{x}^{(3)} - \\bar{\\mathbf{x}} = \\begin{pmatrix} 3 \\\\ 2 \\\\ -1 \\end{pmatrix} - \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\\\ -1 \\end{pmatrix}\n$$\n作为一致性检查，所有扰动之和必须为零向量：\n$$\n\\sum_{k=1}^{3} \\mathbf{a}^{(k)} = \\begin{pmatrix} 0 \\\\ 0 \\\\ -1 \\end{pmatrix} + \\begin{pmatrix} -1 \\\\ -1 \\\\ 2 \\end{pmatrix} + \\begin{pmatrix} 1 \\\\ 1 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 0-1+1 \\\\ 0-1+1 \\\\ -1+2-1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n检查通过。\n\n**2. 计算样本协方差矩阵**\n\n无偏样本协方差矩阵 $\\mathbf{C}$ 由 $\\mathbf{C} = \\frac{1}{m-1} \\sum_{k=1}^{m} \\mathbf{a}^{(k)} \\mathbf{a}^{(k)\\top}$ 给出。一个等价的公式使用扰动矩阵 $\\mathbf{A} = \\begin{bmatrix} \\mathbf{a}^{(1)}  \\mathbf{a}^{(2)}  \\dots  \\mathbf{a}^{(m)} \\end{bmatrix}$，由此 $\\mathbf{C} = \\frac{1}{m-1} \\mathbf{A} \\mathbf{A}^\\top$。当 $m=3$ 时，前置因子为 $\\frac{1}{2}$。\n扰动矩阵 $\\mathbf{A}$ 是：\n$$\n\\mathbf{A} = \\begin{pmatrix} 0  -1  1 \\\\ 0  -1  1 \\\\ -1  2  -1 \\end{pmatrix}\n$$\n现在我们计算乘积 $\\mathbf{A} \\mathbf{A}^\\top$：\n$$\n\\mathbf{A} \\mathbf{A}^\\top = \\begin{pmatrix} 0  -1  1 \\\\ 0  -1  1 \\\\ -1  2  -1 \\end{pmatrix} \\begin{pmatrix} 0  0  -1 \\\\ -1  -1  2 \\\\ 1  1  -1 \\end{pmatrix}\n$$\n$$\n\\mathbf{A} \\mathbf{A}^\\top = \\begin{pmatrix} (0)(0)+(-1)(-1)+(1)(1)  (0)(0)+(-1)(-1)+(1)(1)  (0)(-1)+(-1)(2)+(1)(-1) \\\\ (0)(0)+(-1)(-1)+(1)(1)  (0)(0)+(-1)(-1)+(1)(1)  (0)(-1)+(-1)(2)+(1)(-1) \\\\ (-1)(0)+(2)(-1)+(-1)(1)  (-1)(0)+(2)(-1)+(-1)(1)  (-1)(-1)+(2)(2)+(-1)(-1) \\end{pmatrix}\n$$\n$$\n\\mathbf{A} \\mathbf{A}^\\top = \\begin{pmatrix} 2  2  -3 \\\\ 2  2  -3 \\\\ -3  -3  6 \\end{pmatrix}\n$$\n最后，我们乘以 $\\frac{1}{m-1} = \\frac{1}{2}$ 得到 $\\mathbf{C}$：\n$$\n\\mathbf{C} = \\frac{1}{2} \\begin{pmatrix} 2  2  -3 \\\\ 2  2  -3 \\\\ -3  -3  6 \\end{pmatrix} = \\begin{pmatrix} 1  1  -\\frac{3}{2} \\\\ 1  1  -\\frac{3}{2} \\\\ -\\frac{3}{2}  -\\frac{3}{2}  3 \\end{pmatrix}\n$$\n\n**3. 协方差矩阵的秩**\n\n样本协方差矩阵 $\\mathbf{C}$ 的秩由线性无关的扰动向量的数量决定。矩阵 $\\mathbf{C}$ 是从 $n \\times m$ 的扰动矩阵 $\\mathbf{A}$ 计算得出的，其中状态维数 $n=3$，集合大小 $m=3$。\n从第一性原理可知，$\\mathbf{A}$ 的列（即扰动向量 $\\mathbf{a}^{(k)}$）之和为零向量。这意味着这些列是线性相关的，因此 $\\mathbf{A}$ 的秩最多为 $m-1$。在本例中，$\\text{rank}(\\mathbf{A}) \\le 3-1 = 2$。\n线性代数中的一个基本结论指出，对于任何实矩阵 $\\mathbf{M}$，都有 $\\text{rank}(\\mathbf{M}\\mathbf{M}^\\top) = \\text{rank}(\\mathbf{M})$。由于 $\\mathbf{C}$ 是 $\\mathbf{A}\\mathbf{A}^\\top$ 的标量倍，我们有 $\\text{rank}(\\mathbf{C}) = \\text{rank}(\\mathbf{A}\\mathbf{A}^\\top) = \\text{rank}(\\mathbf{A})$。\n因此，我们得出结论 $\\text{rank}(\\mathbf{C}) \\le m-1 = 2$。\n为了确定秩是否恰好为 $2$，我们检查是否存在至少两个线性无关的扰动向量。让我们检查 $\\mathbf{a}^{(1)}$ 和 $\\mathbf{a}^{(2)}$：\n$$\n\\mathbf{a}^{(1)} = \\begin{pmatrix} 0 \\\\ 0 \\\\ -1 \\end{pmatrix}, \\quad \\mathbf{a}^{(2)} = \\begin{pmatrix} -1 \\\\ -1 \\\\ 2 \\end{pmatrix}\n$$\n这两个向量不是彼此的标量倍数，所以它们是线性无关的。这意味着 $\\mathbf{A}$ 的列空间维数为 $2$。因此，$\\text{rank}(\\mathbf{A}) = 2$。\n因此，样本协方差矩阵 $\\mathbf{C}$ 的秩为 $2$。\n这也可以通过检查 $\\mathbf{C}$ 本身来看出。前两行是相同的，所以秩小于 $3$。第三行 $(-\\frac{3}{2}, -\\frac{3}{2}, 3)$ 不是第一行 $(1, 1, -\\frac{3}{2})$ 的标量倍。由于我们有两行线性无关的行，所以秩为 $2$。\n\n**4. 伪相关和局地化**\n\n$x_1$ 和 $x_3$ 之间的样本相关系数定义为 $r_{13} = \\frac{C_{13}}{\\sqrt{C_{11} C_{33}}}$。使用计算出的矩阵 $\\mathbf{C}$ 中的元素：\n- $C_{11} = 1$\n- $C_{33} = 3$\n- $C_{13} = -\\frac{3}{2}$\n$$\nr_{13} = \\frac{-\\frac{3}{2}}{\\sqrt{(1)(3)}} = \\frac{-\\frac{3}{2}}{\\sqrt{3}} = -\\frac{3}{2\\sqrt{3}} = -\\frac{3\\sqrt{3}}{2 \\cdot 3} = -\\frac{\\sqrt{3}}{2}\n$$\n计算出的相关性为 $r_{13} \\approx -0.866$。这是一个强的负相关。\n\n**解释：** 问题指出，变量 $x_1$ 和 $x_3$ 代表相距较远的位置，它们之间的真实背景协方差可以忽略不计。我们计算出的大非零相关 $r_{13} = -\\frac{\\sqrt{3}}{2}$ 是由于从一个过小的集合（$m=3$）中估计协方差结构而产生的伪影。这被称为**伪相关**或采样误差。在卡尔曼滤波更新中使用这个样本协方差矩阵 $\\mathbf{C}$ 将错误地导致位置 $3$ 的观测值强烈影响位置 $1$ 的状态估计，这在物理上是不现实的。\n\n**局地化**是集合卡尔曼滤波中用来解决这个问题的技术。它的工作原理是通过物理距离来锥化样本协方差。一个局地化函数（通过逐元素相乘）被应用于样本协方差矩阵。对于同位的变量，该函数的值为 $1$，并随着变量之间距离的增加而衰减到 $0$。对于相距较远的变量 $x_1$ 和 $x_3$，局地化因子将接近于零，从而有效地在修正后的矩阵中将伪协方差 $C_{13}$ 强制为零。这可以防止在数据同化更新过程中的非物理长程影响，并确保得到物理上合理的分析结果。\n\n总而言之，已按要求计算出必要的量。最终答案要求按行优先顺序给出 $\\mathbf{C}$ 的元素，然后是它的秩。\n$\\mathbf{C}$ 的元素为：$C_{11}=1$，$C_{12}=1$，$C_{13}=-\\frac{3}{2}$，$C_{21}=1$，$C_{22}=1$，$C_{23}=-\\frac{3}{2}$，$C_{31}=-\\frac{3}{2}$，$C_{32}=-\\frac{3}{2}$，$C_{33}=3$。\n秩为 $2$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1  1  -\\frac{3}{2}  1  1  -\\frac{3}{2}  -\\frac{3}{2}  -\\frac{3}{2}  3  2 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "针对伪相关问题，LETKF采用了一种名为“协方差局地化”的关键技术。本练习将指导您推导并应用一个常用的锥化函数（taper function），通过该函数可以根据观测与分析点之间的物理距离平滑地调整观测的影响权重。通过这个实践，您将掌握如何量化并消除远距离观测带来的虚假影响。",
            "id": "4060590",
            "problem": "在数值天气预报和气候模拟的数据同化中，局地集合变换卡尔曼滤波（LETKF）将观测的影响限制在每个模式格点周围的地理局部邻域内，并通过一个锥形函数应用协方差局地化，该函数在有限的截断距离处将观测影响平滑地减小到零。考虑一个位于原点的二维水平格点，其坐标为 $(0,0)$，单位为千米。相对于该格点，一组六个观测站位于以下笛卡尔坐标（单位：千米）：\n$(30,40)$, $(15,20)$, $(3,4)$, $(35,0)$, $(0,0)$, $(60,0)$。\n设局地化半径为 $r=50$ 千米。\n\n采用以下基本设定：\n- 从格点到位于 $(x,y)$ 的站点的水平距离 $d$ 由欧几里得范数 $d=\\sqrt{x^{2}+y^{2}}$ 给出。\n- 局地化锥形权重 $w(d)$ 是无量纲的，仅取决于距离 $d$，并且必须满足适用于LETKF中协方差局地化的平滑性和边界约束：$w(0)=1$，$w(r)=0$，以及 $w'(0)=0$，$w'(r)=0$，对于所有 $d \\ge r$，$w(d)=0$。\n- 在与这些约束一致的函数中，使用在 $[0,r]$ 上二阶连续可微且紧支撑的最简单三角函数形式。\n\n任务：\n- 确定哪些观测被包含在局地分析域中，局地分析域定义为满足 $d \\le r$ 的观测。\n- 根据所述约束推导相应的锥形函数 $w(d)$，并按上面列出的顺序计算每个站点的权重。对于任何 $d>r$ 的观测，将其权重设为 $0$。\n\n将最终答案表示为一个单一行向量，包含按给定站点顺序排列的六个权重，并四舍五入到五位有效数字。权重是无量纲数。",
            "solution": "经评估，该问题陈述具有科学依据、问题适定、客观且完整。它描述了数据同化中的一个标准程序，特别是在局地集合变换卡尔曼滤波（LETKF）背景下协方差局地化锥形函数的应用。所提供的数据和约束足以且一致地推导出唯一解。因此，该问题是有效的。\n\n任务是确定一组六个观测站相对于原点 $(0,0)$ 处格点的局地化锥形权重。这需要两个主要步骤：首先，根据给定约束推导出锥形权重函数 $w(d)$ 的解析形式；其次，在计算每个观测点与原点的距离 $d$ 后，将此函数应用于该观测。\n\n首先，我们推导锥形函数 $w(d)$。问题指定 $w(d)$ 必须是在区间 $[0, r]$（其中 $r$ 是局地化半径）上定义的二阶连续可微的最简单三角函数形式，并满足以下四个边界条件：\n1. $w(0) = 1$ (在格点处权重为1)\n2. $w(r) = 0$ (在截断半径处权重为0)\n3. $w'(0) = 0$ (在格点处斜率为0，以保证平滑)\n4. $w'(r) = 0$ (在截断半径处斜率为0，以保证平滑)\n\n该函数还被定义为对于所有 $d \\ge r$，$w(d) = 0$。对三角函数形式的要求表明函数涉及正弦和/或余弦。一个简单的候选形式是 $w(d) = A\\cos(kd) + B\\sin(kd) + C$。\n\n让我们应用边界条件。条件 $w'(0) = 0$ 是一个强约束。其导数为 $w'(d) = -Ak\\sin(kd) + Bk\\cos(kd)$。在 $d=0$ 处，我们有 $w'(0) = Bk\\cos(0) = Bk$。要使其为零，必须 $B=0$ 或 $k=0$。如果 $k=0$，则函数为常数，无法满足其他条件。因此，必须有 $B=0$。这将我们的候选函数简化为 $w(d) = A\\cos(kd) + C$，这是一个偶函数，与原点周围预期的对称性一致。\n\n现在我们将剩下的三个条件应用于 $w(d) = A\\cos(kd) + C$：\n- $w(0) = 1 \\implies A\\cos(0) + C = A + C = 1$。\n- $w'(r) = 0 \\implies -Ak\\sin(kr) = 0$。由于对于非平凡解，$A \\ne 0$ 且 $k \\ne 0$，我们必须有 $\\sin(kr) = 0$。这意味着对于某个整数 $n$，$kr = n\\pi$。为了得到最简单的非常数函数，我们选择 $n=1$，这给出 $k = \\frac{\\pi}{r}$。\n- $w(r) = 0 \\implies A\\cos(kr) + C = 0$。代入 $k=\\frac{\\pi}{r}$，我们得到 $A\\cos(\\pi) + C = -A + C = 0$。\n\n我们现在有一个关于 $A$ 和 $C$ 的二元线性方程组：\n$$ A + C = 1 $$\n$$ -A + C = 0 \\implies A = C $$\n将 $A=C$ 代入第一个方程得到 $2A=1$，所以 $A = \\frac{1}{2}$ 且 $C = \\frac{1}{2}$。\n\n由此得到的局地化函数在 $d \\in [0, r]$ 上为：\n$$ w(d) = \\frac{1}{2}\\cos\\left(\\frac{\\pi d}{r}\\right) + \\frac{1}{2} = \\frac{1}{2}\\left(1 + \\cos\\left(\\frac{\\pi d}{r}\\right)\\right) $$\n这个函数是升余弦窗或汉宁窗的一种形式。它在区间 $[0, r]$ 上是无限可微的，因此满足其支撑域上“二阶连续可微”的要求。它是局地化锥形函数的一个标准而简单的选择。\n\n给定局地化半径 $r=50$ 千米，具体的锥形函数是：\n$$ w(d) = \\frac{1}{2}\\left(1 + \\cos\\left(\\frac{\\pi d}{50}\\right)\\right) \\quad \\text{for } 0 \\le d \\le 50 $$\n并且对于 $d > 50$，$w(d)=0$。\n\n接下来，我们为六个站点中的每一个计算距离 $d$ 和相应的权重 $w(d)$。\n\n1. 站点1，位于 $(30, 40)$:\n$d_1 = \\sqrt{30^2 + 40^2} = \\sqrt{900 + 1600} = \\sqrt{2500} = 50$ 千米。\n由于 $d_1 = r = 50$，该观测位于局地分析域的边缘。根据边界条件 $w(r)=0$，权重为 $w_1 = w(50) = 0$。\n$w_1 = 0.00000$。\n\n2. 站点2，位于 $(15, 20)$:\n$d_2 = \\sqrt{15^2 + 20^2} = \\sqrt{225 + 400} = \\sqrt{625} = 25$ 千米。\n由于 $d_2 \\le r$，该观测被包括在内。\n$w_2 = w(25) = \\frac{1}{2}\\left(1 + \\cos\\left(\\frac{25\\pi}{50}\\right)\\right) = \\frac{1}{2}\\left(1 + \\cos\\left(\\frac{\\pi}{2}\\right)\\right) = \\frac{1}{2}(1+0) = 0.5$。\n$w_2 = 0.50000$。\n\n3. 站点3，位于 $(3, 4)$:\n$d_3 = \\sqrt{3^2 + 4^2} = \\sqrt{9 + 16} = \\sqrt{25} = 5$ 千米。\n由于 $d_3 \\le r$，该观测被包括在内。\n$w_3 = w(5) = \\frac{1}{2}\\left(1 + \\cos\\left(\\frac{5\\pi}{50}\\right)\\right) = \\frac{1}{2}\\left(1 + \\cos\\left(\\frac{\\pi}{10}\\right)\\right)$。\n数值上，$\\cos(\\frac{\\pi}{10}) \\approx 0.9510565163$。\n$w_3 \\approx \\frac{1}{2}(1 + 0.9510565163) = 0.975528258$。\n四舍五入到五位有效数字，$w_3 = 0.97553$。\n\n4. 站点4，位于 $(35, 0)$:\n$d_4 = \\sqrt{35^2 + 0^2} = 35$ 千米。\n由于 $d_4 \\le r$，该观测被包括在内。\n$w_4 = w(35) = \\frac{1}{2}\\left(1 + \\cos\\left(\\frac{35\\pi}{50}\\right)\\right) = \\frac{1}{2}\\left(1 + \\cos\\left(\\frac{7\\pi}{10}\\right)\\right)$。\n数值上，$\\cos(\\frac{7\\pi}{10}) \\approx -0.5877852523$。\n$w_4 \\approx \\frac{1}{2}(1 - 0.5877852523) = 0.20610737385$。\n四舍五入到五位有效数字，$w_4 = 0.20611$。\n\n5. 站点5，位于 $(0, 0)$:\n$d_5 = \\sqrt{0^2 + 0^2} = 0$ 千米。\n该观测位于格点本身。\n根据边界条件，$w_5 = w(0) = 1$。\n$w_5 = 1.0000$。\n\n6. 站点6，位于 $(60, 0)$:\n$d_6 = \\sqrt{60^2 + 0^2} = 60$ 千米。\n由于 $d_6 > r$，该观测位于局地分析域之外。\n根据问题定义，对于 $d \\ge r$，$w(d)=0$。\n$w_6 = 0.00000$。\n\n最终答案是按指定顺序排列的这六个权重的行向量。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 0.00000  0.50000  0.97553  0.20611  1.0000  0.00000 \\end{pmatrix} } $$"
        },
        {
            "introduction": "在确定了局地分析域并对观测值进行加权后，LETKF的核心步骤是在该局地域内执行一次卡尔曼滤波更新。本练习将此过程简化为一个标量问题，让您能够专注于其最核心的数学机制。通过计算卡尔曼增益并更新状态，您将深入理解观测数据是如何被融合以修正预报并减小分析不确定性的。",
            "id": "4060613",
            "problem": "考虑在用于数值天气预报和气候模拟的局地集合变换卡尔曼滤波（LETKF）的局部分析域内的一个单个局部状态变量 $x$。假设一个线性观测模型 $y = H x + \\epsilon$，其中 $H$ 是标量观测算子，$\\epsilon$ 是方差为 $R$ 的零均值高斯观测误差。先验（预报）状态 $x$ 服从高斯分布，其均值为 $\\bar{x}^{f}$，方差为 $P^{f}$。在标量情况下，LETKF 分析与线性高斯模型的贝叶斯后验一致。从高斯先验和高斯似然的贝叶斯公式出发，针对一般的标量 $H$、$P^{f}$ 和 $R$，推导后验（分析）均值 $\\bar{x}^{a}$ 和后验方差 $P^{a}$，并用新息 $y - H \\bar{x}^{f}$ 来表示。然后，将问题特殊化到 $H = 1$，$P^{f} = 4$，$R = 1$ 且新息 $y - H \\bar{x}^{f} = 2$ 的情况，计算卡尔曼增益 $K$、分析均值 $\\bar{x}^{a}$，并量化从 $P^{f}$ 到 $P^{a}$ 的方差减少量，即差值 $P^{f} - P^{a}$。精确地表示最终的量。最终答案必须以一个单行矩阵的形式呈现，其中依次包含卡尔曼增益 $K$、分析均值 $\\bar{x}^{a}$ 和方差减少量 $P^{f} - P^{a}$。",
            "solution": "本问题要求在线性高斯模型的框架内推导标量状态变量的分析均值和方差，这在当前简化设定下等价于局地集合变换卡尔曼滤波（LETKF）的更新。推导将使用贝叶斯推断从第一性原理进行。\n\n设标量状态变量为 $x$。状态的先验知识由一个均值为 $\\bar{x}^f$、方差为 $P^f$ 的高斯概率分布给出：\n$$p(x) = \\mathcal{N}(x; \\bar{x}^f, P^f) \\propto \\exp\\left(-\\frac{1}{2} \\frac{(x - \\bar{x}^f)^2}{P^f}\\right)$$\n\n观测 $y$ 通过线性观测模型 $y = Hx + \\epsilon$ 与状态 $x$ 相关，其中 $H$ 是一个标量观测算子，$\\epsilon$ 是观测误差。误差被假定为一个均值为零、方差为 $R$ 的高斯随机变量，即 $\\epsilon \\sim \\mathcal{N}(0, R)$。这意味着在给定状态 $x$ 的条件下观测到 $y$ 的条件概率（即似然函数）也是高斯分布的：\n$$p(y|x) = \\mathcal{N}(y; Hx, R) \\propto \\exp\\left(-\\frac{1}{2} \\frac{(y - Hx)^2}{R}\\right)$$\n\n根据贝叶斯定理，给定观测 $y$ 后状态 $x$ 的后验概率分布（记为 $p(x|y)$）与似然和先验的乘积成正比：\n$$p(x|y) \\propto p(y|x) p(x)$$\n将先验和似然的高斯形式代入，得到：\n$$p(x|y) \\propto \\exp\\left(-\\frac{1}{2} \\frac{(y - Hx)^2}{R}\\right) \\exp\\left(-\\frac{1}{2} \\frac{(x - \\bar{x}^f)^2}{P^f}\\right)$$\n$$p(x|y) \\propto \\exp\\left(-\\frac{1}{2} \\left[ \\frac{(y - Hx)^2}{R} + \\frac{(x - \\bar{x}^f)^2}{P^f} \\right]\\right)$$\n\n后验分布与一个关于 $x$ 的二次函数的指数成正比，这意味着后验分布也是高斯分布。设其均值为分析均值 $\\bar{x}^a$，方差为分析方差 $P^a$，因此 $p(x|y) \\propto \\exp\\left(-\\frac{1}{2} \\frac{(x - \\bar{x}^a)^2}{P^a}\\right)$。为了求出 $\\bar{x}^a$ 和 $P^a$，我们分析指数的参数，记为 $J(x)$：\n$$J(x) = \\frac{(y - Hx)^2}{R} + \\frac{(x - \\bar{x}^f)^2}{P^f}$$\n展开平方项：\n$$J(x) = \\frac{y^2 - 2yHx + H^2x^2}{R} + \\frac{x^2 - 2x\\bar{x}^f + (\\bar{x}^f)^2}{P^f}$$\n我们合并包含 $x$ 的幂的项：\n$$J(x) = x^2 \\left(\\frac{H^2}{R} + \\frac{1}{P^f}\\right) - 2x \\left(\\frac{Hy}{R} + \\frac{\\bar{x}^f}{P^f}\\right) + \\text{不依赖于 } x \\text{ 的项}$$\n通过将其与标准形式 $\\frac{(x - \\bar{x}^a)^2}{P^a} + C = \\frac{x^2}{P^a} - \\frac{2x\\bar{x}^a}{P^a} + \\text{const.}$ 进行比较，我们可以通过令 $x$ 的各次幂的系数相等来确定后验参数。\n\n对于 $x^2$ 的系数：\n$$\\frac{1}{P^a} = \\frac{1}{P^f} + \\frac{H^2}{R} = \\frac{R + H^2 P^f}{P^f R}$$\n这给出了后验方差：\n$$P^a = \\frac{P^f R}{R + H^2 P^f}$$\n\n对于 $x$ 的系数：\n$$\\frac{\\bar{x}^a}{P^a} = \\frac{Hy}{R} + \\frac{\\bar{x}^f}{P^f}$$\n$$\\bar{x}^a = P^a \\left(\\frac{Hy}{R} + \\frac{\\bar{x}^f}{P^f}\\right)$$\n代入 $P^a$ 的表达式：\n$$\\bar{x}^a = \\frac{P^f R}{R + H^2 P^f} \\left(\\frac{HyP^f + \\bar{x}^f R}{P^f R}\\right) = \\frac{HyP^f + \\bar{x}^f R}{R + H^2 P^f}$$\n为了用新息 $y - H\\bar{x}^f$ 来表示，我们处理 $\\bar{x}^a$ 的表达式：\n$$\\bar{x}^a = \\frac{\\bar{x}^f(R + H^2 P^f) - \\bar{x}^f H^2 P^f + HyP^f}{R + H^2 P^f} = \\bar{x}^f + \\frac{HyP^f - H^2 \\bar{x}^f P^f}{R + H^2 P^f}$$\n$$\\bar{x}^a = \\bar{x}^f + \\frac{P^f H}{R + H^2 P^f} (y - H\\bar{x}^f)$$\n这就是标准的卡尔曼更新方程 $\\bar{x}^a = \\bar{x}^f + K(y - H\\bar{x}^f)$，其中卡尔曼增益 $K$ 为：\n$$K = \\frac{P^f H}{H^2 P^f + R}$$\n后验方差也可以用卡尔曼增益表示：\n$$P^a = (1 - KH)P^f = \\left(1 - \\frac{P^f H^2}{H^2 P^f + R}\\right)P^f = \\left(\\frac{H^2 P^f + R - P^f H^2}{H^2 P^f + R}\\right)P^f = \\frac{R P^f}{H^2 P^f + R}$$\n这证实了所推导表达式的一致性。\n\n现在，我们将问题特殊化到给定情况：$H=1$，$P^f=4$，$R=1$，且新息 $y - H\\bar{x}^f = 2$。\n\n首先，我们计算卡尔曼增益 $K$：\n$$K = \\frac{P^f H}{H^2 P^f + R} = \\frac{4 \\cdot 1}{1^2 \\cdot 4 + 1} = \\frac{4}{4+1} = \\frac{4}{5}$$\n\n接下来，我们计算分析均值 $\\bar{x}^a$。问题没有提供 $\\bar{x}^f$ 的值，因此分析均值必须用 $\\bar{x}^f$ 来表示。\n$$\\bar{x}^a = \\bar{x}^f + K(y - H\\bar{x}^f) = \\bar{x}^f + \\frac{4}{5} \\cdot 2 = \\bar{x}^f + \\frac{8}{5}$$\n\n最后，我们量化方差的减少量 $P^f - P^a$。我们首先求出分析方差 $P^a$：\n$$P^a = \\frac{P^f R}{R + H^2 P^f} = \\frac{4 \\cdot 1}{1 + 1^2 \\cdot 4} = \\frac{4}{5}$$\n因此，方差减少量为：\n$$P^f - P^a = 4 - \\frac{4}{5} = \\frac{20}{5} - \\frac{4}{5} = \\frac{16}{5}$$\n另外，使用公式 $P^f - P^a = K H P^f$：\n$$P^f - P^a = \\left(\\frac{4}{5}\\right) \\cdot 1 \\cdot 4 = \\frac{16}{5}$$\n结果是一致的。\n\n所需的量是卡尔曼增益 $K$、分析均值 $\\bar{x}^a$ 和方差减少量 $P^f - P^a$。我们按要求将它们呈现在一个单行矩阵中。\n$K = \\frac{4}{5}$\n$\\bar{x}^a = \\bar{x}^f + \\frac{8}{5}$\n$P^f - P^a = \\frac{16}{5}$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{4}{5}  \\bar{x}^f + \\frac{8}{5}  \\frac{16}{5}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}