{
    "hands_on_practices": [
        {
            "introduction": "第一个实践练习旨在深入探究耦合资料同化的基本机制。我们将探讨来自地球系统某一分量（例如大气）的观测信息，如何能够直接改进另一分量（例如海洋）的状态估计。通过具体计算局地化的卡尔曼增益，这个练习  将跨域更新这一抽象概念具象化，展示了背景误差跨协方差所扮演的关键角色。",
            "id": "4028471",
            "problem": "考虑一个用于数值天气预报和气候模拟数据同化的耦合大气-海洋状态，其状态向量为 $\\mathbf{x} = \\begin{pmatrix} x_{a} \\\\ x_{o} \\end{pmatrix}$，表示在同一水平位置上的一个大气标量变量 $x_{a}$ 和一个海洋标量变量 $x_{o}$。假设一个线性、高斯框架，该框架与经典卡尔曼滤波 (KF) 和集合卡尔曼滤波 (EnKF) 在线性观测算子和高斯误差的条件下是一致的。背景（先验）均值为 $\\mathbf{x}_{b} = \\begin{pmatrix} x_{a,b} \\\\ x_{o,b} \\end{pmatrix}$，背景误差协方差为\n$$\n\\mathbf{B} = \\begin{pmatrix}\n\\sigma_{a}^{2}  \\mathcal{C}_{ao} \\\\\n\\mathcal{C}_{ao}  \\sigma_{o}^{2}\n\\end{pmatrix},\n$$\n其中 $\\sigma_{a}^{2} > 0$, $\\sigma_{o}^{2} > 0$，以及一个非零的跨域协方差 $\\mathcal{C}_{ao} \\neq 0$。有一个单一的大气观测值 $y_{a}$，其线性观测算子为 $\\mathbf{H} = \\begin{pmatrix} 1  0 \\end{pmatrix}$，观测误差方差为 $r_{a} > 0$，因此标量新息为 $d = y_{a} - x_{a,b}$。\n\n为确保科学上真实的耦合增量，通过舒尔（哈达玛）积 $\\mathbf{B}_{\\mathrm{loc}} = \\mathbf{B} \\circ \\mathbf{L}$ 应用协方差局地化，其中对称的局地化矩阵为\n$$\n\\mathbf{L} = \\begin{pmatrix}\n1  \\rho_{ao} \\\\\n\\rho_{ao}  1\n\\end{pmatrix},\n$$\n其中 $0 \\le \\rho_{ao} \\le 1$ 是为大气-海洋耦合规定的跨域局地化系数。局地化的卡尔曼增益 $\\mathbf{K}_{\\mathrm{loc}}$ 作用于标量新息 $d$ 以产生分析增量 $\\delta \\mathbf{x} = \\mathbf{K}_{\\mathrm{loc}}\\, d$。\n\n设物理上一致的参数值为\n$$\n\\sigma_{a}^{2} = 4,\\quad \\sigma_{o}^{2} = 9,\\quad \\mathcal{C}_{ao} = 3,\\quad r_{a} = 1,\\quad \\rho_{ao} = \\tfrac{1}{2},\\quad d = 2.\n$$\n\n对于这个单观测、双变量的耦合系统，从第一性原理出发，通过从线性高斯最小方差分析框架开始并显式地通过 $\\mathbf{B}_{\\mathrm{loc}}$ 引入局地化，来推导局地化的卡尔曼增益向量 $\\mathbf{K}_{\\mathrm{loc}}$。然后计算海洋分析增量 $\\delta x_{o}$，并解析地证明非零的 $\\mathcal{C}_{ao}$ 是如何通过 $\\rho_{ao}\\,\\mathcal{C}_{ao}$ 对 $\\delta x_{o}$ 做出贡献的。\n\n将您的最终数值答案四舍五入到三位有效数字。用开尔文表示该增量。",
            "solution": "分析状态向量 $\\mathbf{x}_{a}$ 是通过利用观测值 $y_{a}$ 的信息来更新背景状态向量 $\\mathbf{x}_{b}$ 而获得的。在线性高斯框架中，分析更新方程为：\n$$\n\\mathbf{x}_{a} = \\mathbf{x}_{b} + \\mathbf{K} (\\mathbf{y} - \\mathbf{H}\\mathbf{x}_{b})\n$$\n其中 $\\mathbf{K}$ 是卡尔曼增益，$\\mathbf{y}$ 是观测向量，$\\mathbf{H}$ 是观测算子。分析增量定义为 $\\delta \\mathbf{x} = \\mathbf{x}_{a} - \\mathbf{x}_{b}$。在本问题中，我们有一个单一的标量观测值 $y_{a}$，因此新息项 $y_{a} - \\mathbf{H}\\mathbf{x}_{b}$ 变为标量 $d = y_{a} - x_{a,b}$。因此，分析增量为 $\\delta \\mathbf{x} = \\mathbf{K} d$。\n\n最小化分析误差方差的卡尔曼增益 $\\mathbf{K}$ 由下式给出：\n$$\n\\mathbf{K} = \\mathbf{B} \\mathbf{H}^{\\mathrm{T}} (\\mathbf{H} \\mathbf{B} \\mathbf{H}^{\\mathrm{T}} + \\mathbf{R})^{-1}\n$$\n其中 $\\mathbf{B}$ 是背景误差协方差，$\\mathbf{R}$ 是观测误差协方差。\n\n该问题要求使用局地化的背景误差协方差 $\\mathbf{B}_{\\mathrm{loc}}$。因此，局地化的卡尔曼增益 $\\mathbf{K}_{\\mathrm{loc}}$ 是通过将 $\\mathbf{B}$ 替换为 $\\mathbf{B}_{\\mathrm{loc}}$ 来计算的：\n$$\n\\mathbf{K}_{\\mathrm{loc}} = \\mathbf{B}_{\\mathrm{loc}} \\mathbf{H}^{\\mathrm{T}} (\\mathbf{H} \\mathbf{B}_{\\mathrm{loc}} \\mathbf{H}^{\\mathrm{T}} + \\mathbf{R})^{-1}\n$$\n\n首先，我们必须使用舒尔（逐元素）积，从背景协方差 $\\mathbf{B}$ 和局地化矩阵 $\\mathbf{L}$ 构建局地化协方差矩阵 $\\mathbf{B}_{\\mathrm{loc}}$：\n$$\n\\mathbf{B}_{\\mathrm{loc}} = \\mathbf{B} \\circ \\mathbf{L} = \\begin{pmatrix} \\sigma_{a}^{2}  \\mathcal{C}_{ao} \\\\ \\mathcal{C}_{ao}  \\sigma_{o}^{2} \\end{pmatrix} \\circ \\begin{pmatrix} 1  \\rho_{ao} \\\\ \\rho_{ao}  1 \\end{pmatrix} = \\begin{pmatrix} \\sigma_{a}^{2}  \\rho_{ao}\\mathcal{C}_{ao} \\\\ \\rho_{ao}\\mathcal{C}_{ao}  \\sigma_{o}^{2} \\end{pmatrix}\n$$\n\n接下来，我们计算 $\\mathbf{K}_{\\mathrm{loc}}$ 公式所需的各项。观测算子为 $\\mathbf{H} = \\begin{pmatrix} 1  0 \\end{pmatrix}$，因此其转置为 $\\mathbf{H}^{\\mathrm{T}} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。对于方差为 $r_{a}$ 的单个观测，其观测误差协方差矩阵 $\\mathbf{R}$ 是标量 $r_{a}$。\n\n我们来计算乘积 $\\mathbf{B}_{\\mathrm{loc}} \\mathbf{H}^{\\mathrm{T}}$：\n$$\n\\mathbf{B}_{\\mathrm{loc}} \\mathbf{H}^{\\mathrm{T}} = \\begin{pmatrix} \\sigma_{a}^{2}  \\rho_{ao}\\mathcal{C}_{ao} \\\\ \\rho_{ao}\\mathcal{C}_{ao}  \\sigma_{o}^{2} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\sigma_{a}^{2} \\\\ \\rho_{ao}\\mathcal{C}_{ao} \\end{pmatrix}\n$$\n\n现在，我们计算新息方差项 $\\mathbf{H} \\mathbf{B}_{\\mathrm{loc}} \\mathbf{H}^{\\mathrm{T}} + r_{a}$：\n$$\n\\mathbf{H} \\mathbf{B}_{\\mathrm{loc}} \\mathbf{H}^{\\mathrm{T}} = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} \\sigma_{a}^{2}  \\rho_{ao}\\mathcal{C}_{ao} \\\\ \\rho_{ao}\\mathcal{C}_{ao}  \\sigma_{o}^{2} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} \\sigma_{a}^{2} \\\\ \\rho_{ao}\\mathcal{C}_{ao} \\end{pmatrix} = \\sigma_{a}^{2}\n$$\n如预期，这是一个标量。总新息方差为 $\\sigma_{a}^{2} + r_{a}$。其逆为 $(\\sigma_{a}^{2} + r_{a})^{-1} = \\frac{1}{\\sigma_{a}^{2} + r_{a}}$。\n\n现在我们可以组装出局地化的卡尔曼增益向量 $\\mathbf{K}_{\\mathrm{loc}}$：\n$$\n\\mathbf{K}_{\\mathrm{loc}} = \\begin{pmatrix} \\sigma_{a}^{2} \\\\ \\rho_{ao}\\mathcal{C}_{ao} \\end{pmatrix} \\frac{1}{\\sigma_{a}^{2} + r_{a}} = \\begin{pmatrix} \\frac{\\sigma_{a}^{2}}{\\sigma_{a}^{2} + r_{a}} \\\\ \\frac{\\rho_{ao}\\mathcal{C}_{ao}}{\\sigma_{a}^{2} + r_{a}} \\end{pmatrix}\n$$\n\n分析增量向量为 $\\delta \\mathbf{x} = \\mathbf{K}_{\\mathrm{loc}} d$：\n$$\n\\delta \\mathbf{x} = \\begin{pmatrix} \\delta x_{a} \\\\ \\delta x_{o} \\end{pmatrix} = \\begin{pmatrix} \\frac{\\sigma_{a}^{2}}{\\sigma_{a}^{2} + r_{a}} d \\\\ \\frac{\\rho_{ao}\\mathcal{C}_{ao}}{\\sigma_{a}^{2} + r_{a}} d \\end{pmatrix}\n$$\n问题要求的是海洋分析增量 $\\delta x_{o}$，即该向量的第二个分量：\n$$\n\\delta x_{o} = \\frac{\\rho_{ao}\\mathcal{C}_{ao}}{\\sigma_{a}^{2} + r_{a}} d\n$$\n这个解析表达式表明，由于非零的背景跨域协方差 $\\mathcal{C}_{ao}$，大气观测会产生一个非零的海洋增量 $\\delta x_{o}$。此更新的幅度由局地化系数 $\\rho_{ao}$ 调节。如果 $\\mathcal{C}_{ao}=0$ 或 $\\rho_{ao}=0$，则在此线性更新步骤中，大气观测将对海洋状态没有影响。\n\n最后，我们代入给定的数值来计算 $\\delta x_{o}$：\n$\\sigma_{a}^{2} = 4$, $\\mathcal{C}_{ao} = 3$, $r_{a} = 1$, $\\rho_{ao} = \\frac{1}{2}$，以及 $d = 2$。\n$$\n\\delta x_{o} = \\frac{(\\frac{1}{2})(3)}{4 + 1} \\times 2 = \\frac{1.5}{5} \\times 2 = 0.3 \\times 2 = 0.6\n$$\n问题要求答案四舍五入到三位有效数字，即 $0.600$。按照指示，该值被解释为以开尔文为单位。因此，海洋分析增量为 $\\delta x_o = 0.600$ 开尔文。",
            "answer": "$$\n\\boxed{0.600}\n$$"
        },
        {
            "introduction": "在了解了数学机制之后，我们现在来探究这些关键的跨域相关的物理起源。这些相关性并不仅仅是统计上的巧合，而是植根于控制不同地球系统分量相互作用的物理定律。这个练习  要求您从海-气热通量的物理公式出发，推导出一个大气和海洋变量之间的线性化关系，从而阐明物理定律如何为系统状态施加耦合约束。",
            "id": "4028430",
            "problem": "在数值天气预报和气候模拟中，考虑一个耦合的大气-海洋分析，其中海气感热通量由广泛使用的块体公式 $Q=\\rho c_p C_H U (T_a - T_s)$ 表示，其中 $Q$ 是地表感热通量，$\\rho$ 是空气密度，$c_p$ 是空气的定压比热容，$C_H$ 是感热的输送系数，$U$ 是近地面风速，$T_a$ 是近地面气温，$T_s$ 是海洋表面（表层）温度。在一个约束变分分析中，假设我们施加一个硬等式约束，要求分析增量在背景态 $(T_a^b, U^b, T_s^b)$ 周围必须保持通量一阶不变，即 $Q$ 的一阶增量为零。设大气增量向量为 $x_a=(\\delta T_a,\\delta U)$，海洋增量向量为 $x_o=(\\delta T_s)$，并在整个线性化过程中将 $\\rho$、$c_p$ 和 $C_H$ 视为常数。\n\n从块体通量定义和在背景态处求值的 $Q$ 的一阶泰勒展开出发，构建耦合通量约束，并推导在线性化关系下，当要求 $\\delta Q=0$ 时，大气近地面温度增量 $\\delta T_a$ 作为海洋表面温度增量 $\\delta T_s$ 和风速增量 $\\delta U$ 的函数。\n\n只需提供 $\\delta T_a$ 以 $\\delta T_s$ 和 $\\delta U$ 表示的最终闭合形式解析表达式。无需进行数值计算。",
            "solution": "目标是推导在特定约束条件下，大气近地面温度增量 $\\delta T_a$ 作为海洋表面温度增量 $\\delta T_s$ 和风速增量 $\\delta U$ 的函数表达式。分析始于感热通量的块体公式 $Q$。\n\n感热通量 $Q$ 是近地面风速 $U$、近地面气温 $T_a$ 和海洋表面温度 $T_s$ 的函数，表示为：\n$$\nQ(U, T_a, T_s) = \\rho c_p C_H U (T_a - T_s)\n$$\n在这里，空气密度 $\\rho$、比热容 $c_p$ 和输送系数 $C_H$ 被视为常数。\n\n问题施加的约束是，通量的一阶增量 $\\delta Q$ 在指定的背景态 $(T_a^b, U^b, T_s^b)$ 周围必须为零。该约束表示为 $\\delta Q = 0$。\n\n一阶增量 $\\delta Q$ 通过对 $Q$ 关于变量 $U$、$T_a$ 和 $T_s$ 求全微分得到。\n$$\n\\delta Q = \\frac{\\partial Q}{\\partial T_a} \\delta T_a + \\frac{\\partial Q}{\\partial U} \\delta U + \\frac{\\partial Q}{\\partial T_s} \\delta T_s\n$$\n函数 $Q$ 的偏导数计算如下：\n$$\n\\frac{\\partial Q}{\\partial T_a} = \\frac{\\partial}{\\partial T_a} \\left[ \\rho c_p C_H U (T_a - T_s) \\right] = \\rho c_p C_H U\n$$\n$$\n\\frac{\\partial Q}{\\partial U} = \\frac{\\partial}{\\partial U} \\left[ \\rho c_p C_H U (T_a - T_s) \\right] = \\rho c_p C_H (T_a - T_s)\n$$\n$$\n\\frac{\\partial Q}{\\partial T_s} = \\frac{\\partial}{\\partial T_s} \\left[ \\rho c_p C_H U (T_a - T_s) \\right] = -\\rho c_p C_H U\n$$\n为了进行线性化，这些偏导数必须在背景态 $(T_a^b, U^b, T_s^b)$ 处求值。\n$$\n\\left. \\frac{\\partial Q}{\\partial T_a} \\right|_b = \\rho c_p C_H U^b\n$$\n$$\n\\left. \\frac{\\partial Q}{\\partial U} \\right|_b = \\rho c_p C_H (T_a^b - T_s^b)\n$$\n$$\n\\left. \\frac{\\partial Q}{\\partial T_s} \\right|_b = -\\rho c_p C_H U^b\n$$\n将这些求出的导数代入 $\\delta Q$ 的表达式中，得到线性化的通量增量：\n$$\n\\delta Q = (\\rho c_p C_H U^b) \\delta T_a + (\\rho c_p C_H (T_a^b - T_s^b)) \\delta U - (\\rho c_p C_H U^b) \\delta T_s\n$$\n现在，我们应用约束 $\\delta Q = 0$：\n$$\n0 = (\\rho c_p C_H U^b) \\delta T_a + (\\rho c_p C_H (T_a^b - T_s^b)) \\delta U - (\\rho c_p C_H U^b) \\delta T_s\n$$\n项 $\\rho c_p C_H$ 是所有项的公因子。假设 $\\rho \\neq 0$，$c_p \\neq 0$ 且 $C_H \\neq 0$，可以从方程中约去该因子：\n$$\n0 = U^b \\delta T_a + (T_a^b - T_s^b) \\delta U - U^b \\delta T_s\n$$\n目标是求解 $\\delta T_a$。我们重排方程以分离出包含 $\\delta T_a$ 的项：\n$$\nU^b \\delta T_a = - (T_a^b - T_s^b) \\delta U + U^b \\delta T_s\n$$\n这可以重写为：\n$$\nU^b \\delta T_a = (T_s^b - T_a^b) \\delta U + U^b \\delta T_s\n$$\n为得到 $\\delta T_a$ 的最终表达式，我们除以 $U^b$。在背景风速非零（$U^b \\neq 0$）这个物理上合理的假设下，此步骤是有效的。\n$$\n\\delta T_a = \\frac{(T_s^b - T_a^b) \\delta U}{U^b} + \\frac{U^b \\delta T_s}{U^b}\n$$\n化简第二项得到最终的线性化关系：\n$$\n\\delta T_a = \\delta T_s + \\frac{T_s^b - T_a^b}{U^b} \\delta U\n$$\n该表达式提供了满足零通量增量约束的大气温度增量 $\\delta T_a$ 作为海洋温度增量 $\\delta T_s$ 和风速增量 $\\delta U$ 的函数关系。",
            "answer": "$$\n\\boxed{\\delta T_a = \\delta T_s + \\frac{T_s^b - T_a^b}{U^b} \\delta U}\n$$"
        },
        {
            "introduction": "在理解了跨域更新的“如何”与“为何”之后，一个关键的最后步骤是量化其影响。本次实践将从理论推导转向实验验证，这是科学研究中的一个常规工作流程。在这个练习  中，您将设计并实施一个数值实验，以精确测量大气观测在多大程度上减少了海洋分析的不确定性（方差），从而为耦合资料同化的价值提供具体证据。",
            "id": "4028482",
            "problem": "在一个简化的耦合数据同化设置中，设计并实现一个验证实验，通过开关跨域协方差和计算差异指标，来分离并量化大气观测对海洋分析技巧的贡献。\n\n考虑一个线性、瞬时的双分量状态向量 $x = [x_{\\mathrm{a}}, x_{\\mathrm{o}}]^{\\top}$，它代表一个大气标量 $x_{\\mathrm{a}}$ 和一个海洋标量 $x_{\\mathrm{o}}$。假设一个高斯背景（先验）分布 $x \\sim \\mathcal{N}(\\mu_{\\mathrm{b}}, B)$，其背景协方差矩阵为\n$$\nB = \\begin{bmatrix}\nB_{\\mathrm{aa}}  B_{\\mathrm{ao}} \\\\\nB_{\\mathrm{oa}}  B_{\\mathrm{oo}}\n\\end{bmatrix}, \\quad B_{\\mathrm{oa}} = B_{\\mathrm{ao}},\n$$\n其中 $B_{\\mathrm{aa}}$ 和 $B_{\\mathrm{oo}}$ 分别是大气和海洋的背景方差，而 $B_{\\mathrm{ao}}$ 是捕捉跨域相关的跨域协方差。将跨域协方差参数化为 $B_{\\mathrm{ao}} = \\rho \\sqrt{B_{\\mathrm{aa}} B_{\\mathrm{oo}}}$，其中相关系数为 $\\rho \\in (-1, 1)$。\n\n假设有一个单个大气观测 $y$，其线性观测算子为 $H = [1, 0]$，观测误差模型为 $y = H x + \\varepsilon$，其中 $\\varepsilon \\sim \\mathcal{N}(0, R)$ 且 $R$ 是观测误差方差。在线性高斯假设下，Kalman 分析（后验）协方差由下式给出：\n$$\nP_{\\mathrm{a}} = (I - K H) B, \\quad K = B H^{\\top} (H B H^{\\top} + R)^{-1},\n$$\n其中 $I$ 是单位矩阵，$K$ 是 Kalman 增益。\n\n你的任务是编写一个程序，该程序为每个测试用例计算两个标量指标，以分离在只同化大气观测时跨域协方差对海洋分析技巧的影响：\n\n1. 仅由跨域耦合引起的海洋分析方差的绝对减少量，定义为\n$$\n\\Delta_{\\mathrm{var}} = P_{\\mathrm{oo}}^{\\mathrm{decoupled}} - P_{\\mathrm{oo}}^{\\mathrm{coupled}},\n$$\n其中 $P_{\\mathrm{oo}}^{\\mathrm{coupled}}$ 是当 $B_{\\mathrm{ao}}$ 设置为参数化的非零值时的分析协方差的海洋分量，而 $P_{\\mathrm{oo}}^{\\mathrm{decoupled}}$ 是在保持 $B_{\\mathrm{aa}}$、$B_{\\mathrm{oo}}$ 和 $R$ 不变的情况下关闭（设为$0$）跨域协方差时的海洋分量。\n\n2. 由耦合引起的海洋分析方差的相对减少量（无量纲分数），定义为\n$$\n\\delta_{\\mathrm{rel}} = \\frac{\\Delta_{\\mathrm{var}}}{B_{\\mathrm{oo}}}.\n$$\n\n将你的推导和算法建立在线性高斯估计和 Kalman 滤波协方差更新的基本原理之上，即上述定义以及对于联合高斯变量，条件化会沿着观测方向按协方差的比例减少方差这一事实。\n\n使用指定的参数值实现以下测试套件：\n- 测试用例 $1$：$B_{\\mathrm{aa}} = 1.0$, $B_{\\mathrm{oo}} = 1.0$, $\\rho = 0.5$, $R = 0.25$。\n- 测试用例 $2$：$B_{\\mathrm{aa}} = 1.0$, $B_{\\mathrm{oo}} = 1.0$, $\\rho = 0.0$, $R = 0.25$。\n- 测试用例 $3$：$B_{\\mathrm{aa}} = 1.0$, $B_{\\mathrm{oo}} = 2.0$, $\\rho = 0.7$, $R = 1000000.0$。\n- 测试用例 $4$：$B_{\\mathrm{aa}} = 4.0$, $B_{\\mathrm{oo}} = 0.25$, $\\rho = 0.9$, $R = 0.01$。\n- 测试用例 $5$：$B_{\\mathrm{aa}} = 0.01$, $B_{\\mathrm{oo}} = 1.0$, $\\rho = 0.8$, $R = 1.0$。\n- 测试用例 $6$：$B_{\\mathrm{aa}} = 2.0$, $B_{\\mathrm{oo}} = 3.0$, $\\rho = -0.7$, $R = 0.5$。\n\n对于每个测试用例，计算并报告浮点数对 $[\\Delta_{\\mathrm{var}}, \\delta_{\\mathrm{rel}}]$。你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，$[ [\\Delta_{\\mathrm{var}}^{(1)}, \\delta_{\\mathrm{rel}}^{(1)}], [\\Delta_{\\mathrm{var}}^{(2)}, \\delta_{\\mathrm{rel}}^{(2)}], \\dots ]$）。由于所有量都是方差和无量纲比率，使用任意但一致的单位，因此不需要物理单位。不涉及角度。不要将任何量表示为百分比；将 $\\delta_{\\mathrm{rel}}$ 表示为小数。",
            "solution": "该问题要求设计一个验证实验，以量化跨域协方差对海洋分析技巧的影响。我们给定一个简化的双分量系统（大气 $x_{\\mathrm{a}}$，海洋 $x_{\\mathrm{o}}$），一个用于大气的线性观测算子，以及 Kalman 滤波分析协方差的标准方程。我们必须推导并计算两个指标：由于同化大气观测而导致的海洋状态绝对方差减少量 $\\Delta_{\\mathrm{var}}$ 和相对方差减少量 $\\delta_{\\mathrm{rel}}$。\n\n首先，我们将推导这些指标的解析表达式。状态向量为 $x = [x_{\\mathrm{a}}, x_{\\mathrm{o}}]^{\\top}$。背景协方差矩阵 $B$、观测算子 $H$ 和单位矩阵 $I$ 为：\n$$\nB = \\begin{bmatrix} B_{\\mathrm{aa}}  B_{\\mathrm{ao}} \\\\ B_{\\mathrm{oa}}  B_{\\mathrm{oo}} \\end{bmatrix}, \\quad H = [1 \\quad 0], \\quad I = \\begin{bmatrix} 1  0 \\\\ 0  1 \\end{bmatrix}\n$$\n其中跨域协方差被参数化为 $B_{\\mathrm{ao}} = B_{\\mathrm{oa}} = \\rho \\sqrt{B_{\\mathrm{aa}} B_{\\mathrm{oo}}}$。观测误差方差是一个标量 $R$。\n\nKalman 分析协方差由 $P_{\\mathrm{a}} = (I - K H) B$ 给出，其中 Kalman 增益为 $K = B H^{\\top} (H B H^{\\top} + R)^{-1}$。\n\n我们来推导 Kalman 增益 $K$ 的分量。\n项 $B H^{\\top}$ 为：\n$$\nB H^{\\top} = \\begin{bmatrix} B_{\\mathrm{aa}}  B_{\\mathrm{ao}} \\\\ B_{\\mathrm{oa}}  B_{\\mathrm{oo}} \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} B_{\\mathrm{aa}} \\\\ B_{\\mathrm{oa}} \\end{bmatrix}\n$$\n新息协方差项 $H B H^{\\top} + R$ 是一个标量：\n$$\nH B H^{\\top} + R = [1 \\quad 0] \\begin{bmatrix} B_{\\mathrm{aa}} \\\\ B_{\\mathrm{oa}} \\end{bmatrix} + R = B_{\\mathrm{aa}} + R\n$$\n由于 $B_{\\mathrm{aa}}$ 是方差，$R$ 是正的误差方差，分母 $(B_{\\mathrm{aa}} + R)$ 总是正的，因此其逆存在。Kalman 增益 $K$ 是一个 $2 \\times 1$ 的列向量：\n$$\nK = \\begin{bmatrix} B_{\\mathrm{aa}} \\\\ B_{\\mathrm{oa}} \\end{bmatrix} (B_{\\mathrm{aa}} + R)^{-1} = \\frac{1}{B_{\\mathrm{aa}} + R} \\begin{bmatrix} B_{\\mathrm{aa}} \\\\ B_{\\mathrm{oa}} \\end{bmatrix}\n$$\n接下来，我们计算矩阵因子 $(I - K H)$：\n$$\nK H = \\frac{1}{B_{\\mathrm{aa}} + R} \\begin{bmatrix} B_{\\mathrm{aa}} \\\\ B_{\\mathrm{oa}} \\end{bmatrix} [1 \\quad 0] = \\frac{1}{B_{\\mathrm{aa}} + R} \\begin{bmatrix} B_{\\mathrm{aa}}  0 \\\\ B_{\\mathrm{oa}}  0 \\end{bmatrix}\n$$\n$$\nI - K H = \\begin{bmatrix} 1  0 \\\\ 0  1 \\end{bmatrix} - \\frac{1}{B_{\\mathrm{aa}} + R} \\begin{bmatrix} B_{\\mathrm{aa}}  0 \\\\ B_{\\mathrm{oa}}  0 \\end{bmatrix} = \\begin{bmatrix} 1 - \\frac{B_{\\mathrm{aa}}}{B_{\\mathrm{aa}} + R}  0 \\\\ -\\frac{B_{\\mathrm{oa}}}{B_{\\mathrm{aa}} + R}  1 \\end{bmatrix} = \\begin{bmatrix} \\frac{R}{B_{\\mathrm{aa}} + R}  0 \\\\ -\\frac{B_{\\mathrm{oa}}}{B_{\\mathrm{aa}} + R}  1 \\end{bmatrix}\n$$\n现在，我们计算完整的分析协方差矩阵 $P_{\\mathrm{a}} = (I - K H) B$：\n$$\nP_{\\mathrm{a}} = \\begin{bmatrix} \\frac{R}{B_{\\mathrm{aa}} + R}  0 \\\\ -\\frac{B_{\\mathrm{oa}}}{B_{\\mathrm{aa}} + R}  1 \\end{bmatrix} \\begin{bmatrix} B_{\\mathrm{aa}}  B_{\\mathrm{ao}} \\\\ B_{\\mathrm{oa}}  B_{\\mathrm{oo}} \\end{bmatrix} = \\begin{bmatrix} \\frac{R B_{\\mathrm{aa}}}{B_{\\mathrm{aa}} + R}  \\frac{R B_{\\mathrm{ao}}}{B_{\\mathrm{aa}} + R} \\\\ \\frac{-B_{\\mathrm{oa}} B_{\\mathrm{aa}}}{B_{\\mathrm{aa}} + R} + B_{\\mathrm{oa}}  \\frac{-B_{\\mathrm{oa}} B_{\\mathrm{ao}}}{B_{\\mathrm{aa}} + R} + B_{\\mathrm{oo}} \\end{bmatrix}\n$$\n非对角项 $P_{\\mathrm{oa}}$ 简化为 $\\frac{B_{\\mathrm{oa}}(-B_{\\mathrm{aa}} + B_{\\mathrm{aa}} + R)}{B_{\\mathrm{aa}} + R} = \\frac{R B_{\\mathrm{oa}}}{B_{\\mathrm{aa}} + R}$，这证实了 $P_{\\mathrm{a}}$ 的对称性，因为 $B_{\\mathrm{oa}} = B_{\\mathrm{ao}}$。\n\n我们的重点是海洋分析方差，即 $P_{\\mathrm{a}}$ 的右下角元素，记为 $P_{\\mathrm{oo}}$：\n$$\nP_{\\mathrm{oo}} = B_{\\mathrm{oo}} - \\frac{B_{\\mathrm{oa}} B_{\\mathrm{ao}}}{B_{\\mathrm{aa}} + R}\n$$\n由于 $B_{\\mathrm{oa}} = B_{\\mathrm{ao}}$，这简化为：\n$$\nP_{\\mathrm{oo}} = B_{\\mathrm{oo}} - \\frac{B_{\\mathrm{ao}}^2}{B_{\\mathrm{aa}} + R}\n$$\n这个表达式使我们能够计算“耦合”和“解耦”两种情况下的海洋分析方差。\n\n对于**耦合**情况，我们使用参数化的跨域协方差 $B_{\\mathrm{ao}} = \\rho \\sqrt{B_{\\mathrm{aa}} B_{\\mathrm{oo}}}$。将其平方得到 $B_{\\mathrm{ao}}^2 = \\rho^2 B_{\\mathrm{aa}} B_{\\mathrm{oo}}$。将此代入 $P_{\\mathrm{oo}}$ 的表达式中，得到耦合的海洋分析方差：\n$$\nP_{\\mathrm{oo}}^{\\mathrm{coupled}} = B_{\\mathrm{oo}} - \\frac{\\rho^2 B_{\\mathrm{aa}} B_{\\mathrm{oo}}}{B_{\\mathrm{aa}} + R}\n$$\n对于**解耦**情况，跨域协方差被关闭，即我们设置 $B_{\\mathrm{ao}} = 0$。这对应于设置相关系数 $\\rho = 0$。得到的海洋分析方差是：\n$$\nP_{\\mathrm{oo}}^{\\mathrm{decoupled}} = B_{\\mathrm{oo}} - \\frac{0^2}{B_{\\mathrm{aa}} + R} = B_{\\mathrm{oo}}\n$$\n这个结果是直观的：如果海洋和大气在背景中不相关，那么对大气的观测不提供任何更新海洋状态的信息，因此其方差与背景值 $B_{\\mathrm{oo}}$ 相比保持不变。\n\n现在，我们可以计算所需的指标。\n\n1.  海洋分析方差的绝对减少量 $\\Delta_{\\mathrm{var}}$：\n    $$\n    \\Delta_{\\mathrm{var}} = P_{\\mathrm{oo}}^{\\mathrm{decoupled}} - P_{\\mathrm{oo}}^{\\mathrm{coupled}} = B_{\\mathrm{oo}} - \\left(B_{\\mathrm{oo}} - \\frac{\\rho^2 B_{\\mathrm{aa}} B_{\\mathrm{oo}}}{B_{\\mathrm{aa}} + R}\\right)\n    $$\n    $$\n    \\Delta_{\\mathrm{var}} = \\frac{\\rho^2 B_{\\mathrm{aa}} B_{\\mathrm{oo}}}{B_{\\mathrm{aa}} + R}\n    $$\n    这个量代表了由于通过跨域相关性 $\\rho$ 从大气观测中传递的信息而导致的海洋状态不确定性（方差）的直接减少。\n\n2.  海洋分析方差的相对减少量 $\\delta_{\\mathrm{rel}}$：\n    $$\n    \\delta_{\\mathrm{rel}} = \\frac{\\Delta_{\\mathrm{var}}}{B_{\\mathrm{oo}}} = \\frac{1}{B_{\\mathrm{oo}}} \\left(\\frac{\\rho^2 B_{\\mathrm{aa}} B_{\\mathrm{oo}}}{B_{\\mathrm{aa}} + R}\\right)\n    $$\n    $$\n    \\delta_{\\mathrm{rel}} = \\frac{\\rho^2 B_{\\mathrm{aa}}}{B_{\\mathrm{aa}} + R}\n    $$\n    这个无量纲指标给出了海洋方差的分数减少量。有趣的是，它独立于海洋的背景方差 $B_{\\mathrm{oo}}$，并且仅仅是平方相关性 $\\rho^2$ 乘以因子 $\\frac{B_{\\mathrm{aa}}}{B_{\\mathrm{aa}} + R}$，该因子代表了被观测的大气变量本身的分数方差减少量。\n\n该程序的算法是将这两个最终公式应用于每个给定的测试用例。",
            "answer": "```\n[[0.2, 0.2], [0.0, 0.0], [9.799990200009799e-07, 4.8999951000049e-07], [0.2019950124688279, 0.8079800498753116], [0.006336633663366337, 0.00633663366337], [1.176, 0.392]]\n```"
        }
    ]
}