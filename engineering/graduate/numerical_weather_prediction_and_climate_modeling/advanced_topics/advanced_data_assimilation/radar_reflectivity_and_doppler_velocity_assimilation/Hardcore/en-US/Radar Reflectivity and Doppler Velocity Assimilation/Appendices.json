{
    "hands_on_practices": [
        {
            "introduction": "Data assimilation fundamentally relies on a \"forward operator\" that translates the model's internal state variables into quantities that can be directly compared with observations. This exercise provides foundational practice in deriving such an operator by connecting a simplified microphysical model—the exponential drop size distribution—to the equivalent radar reflectivity factor, $Z$. Mastering this derivation  is the first step toward understanding and building the observation operators used in modern numerical weather prediction systems.",
            "id": "4080608",
            "problem": "A weather radar observation operator used in variational data assimilation maps model hydrometeor properties to observed radar reflectivity via electromagnetic scattering. Consider a warm-rain microphysical state whose Drop Size Distribution (DSD) is modeled as an exponential distribution\n$$\nN(D) = N_{0}\\,\\exp(-\\Lambda D),\n$$\nwhere $D$ is the drop diameter in meters, $N(D)$ has units $\\mathrm{m}^{-4}$ so that $N(D)\\,\\mathrm{d}D$ is the number concentration in $\\mathrm{m}^{-3}$ of drops with diameters in $[D,D+\\mathrm{d}D]$, $N_{0}$ is a positive intercept parameter, and $\\Lambda$ is a positive slope parameter. Assume the Rayleigh-scattering regime applies for all $D$ of interest at a fixed radar wavelength $\\lambda$, and that the bulk dielectric factor $|K|^{2}$ is constant for liquid water at that wavelength and temperature.\n\nStarting from the definition of the volume backscattering coefficient\n$$\n\\eta \\equiv \\int_{0}^{\\infty} \\sigma_{b}(D)\\,N(D)\\,\\mathrm{d}D,\n$$\nwhere the single-particle backscattering cross section under Rayleigh scattering is that of a sphere, and using the definition of the equivalent radar reflectivity factor $Z$ by the relation\n$$\n\\eta = \\left(\\frac{\\pi^{5}\\,|K|^{2}}{\\lambda^{4}}\\right)\\,Z,\n$$\nderive a closed-form analytical expression for $Z$ in terms of $N_{0}$ and $\\Lambda$. Your derivation must begin from the Rayleigh backscattering cross section for a sphere and the above definitions; you may assume standard integral identities where appropriate. Express your final answer for $Z$ in coherent International System of Units, and give the final expression in its simplest exact form. The final answer must be a single closed-form expression.",
            "solution": "The problem statement is evaluated for validity prior to attempting a solution.\n\n### Step 1: Extract Givens\n- Drop Size Distribution (DSD): $N(D) = N_{0}\\,\\exp(-\\Lambda D)$, where $D$ is drop diameter in meters, $N(D)$ has units $\\mathrm{m}^{-4}$, $N_{0}$ is a positive intercept parameter, and $\\Lambda$ is a positive slope parameter.\n- The Rayleigh-scattering regime is assumed to apply.\n- The radar wavelength is a fixed value $\\lambda$.\n- The bulk dielectric factor $|K|^{2}$ is a constant for liquid water.\n- The volume backscattering coefficient is defined as $\\eta \\equiv \\int_{0}^{\\infty} \\sigma_{b}(D)\\,N(D)\\,\\mathrm{d}D$.\n- The single-particle backscattering cross section $\\sigma_{b}(D)$ is that of a sphere in the Rayleigh regime.\n- The equivalent radar reflectivity factor $Z$ is defined by the relation $\\eta = \\left(\\frac{\\pi^{5}\\,|K|^{2}}{\\lambda^{4}}\\right)\\,Z$.\n- The objective is to derive a closed-form analytical expression for $Z$ in terms of $N_{0}$ and $\\Lambda$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is firmly based on the principles of radar meteorology. The exponential DSD, Rayleigh scattering, and the definitions of $\\eta$ and $Z$ are standard concepts and models in atmospheric science. The context of variational data assimilation is appropriate and relevant.\n- **Well-Posed:** All necessary information and definitions are provided, assuming the standard formula for Rayleigh backscattering cross-section, as implied. The problem is self-contained and specifies a clear objective, enabling the derivation of a unique analytical solution.\n- **Objective:** The problem is stated in precise, objective language, free of ambiguity or subjective claims.\n\n### Step 3: Verdict and Action\nThe problem is found to be valid as it is scientifically sound, well-posed, and objective. A solution will be derived.\n\nThe derivation begins from the fundamental definitions provided. The volume backscattering coefficient, $\\eta$, is given by the integral of the single-particle backscattering cross section, $\\sigma_{b}(D)$, weighted by the number distribution of particles, $N(D)$, over all possible drop diameters $D$.\n$$\n\\eta = \\int_{0}^{\\infty} \\sigma_{b}(D)\\,N(D)\\,\\mathrm{d}D\n$$\nThe problem specifies that the scattering occurs in the Rayleigh regime. For a spherical particle of diameter $D$, the Rayleigh backscattering cross section is given by:\n$$\n\\sigma_{b}(D) = \\frac{\\pi^{5} |K|^{2} D^{6}}{\\lambda^{4}}\n$$\nwhere $|K|^{2}$ is the dielectric factor and $\\lambda$ is the radar wavelength.\n\nThe Drop Size Distribution (DSD) is given as an exponential function:\n$$\nN(D) = N_{0}\\,\\exp(-\\Lambda D)\n$$\nSubstituting the expressions for $\\sigma_{b}(D)$ and $N(D)$ into the integral for $\\eta$:\n$$\n\\eta = \\int_{0}^{\\infty} \\left(\\frac{\\pi^{5} |K|^{2} D^{6}}{\\lambda^{4}}\\right) \\left(N_{0}\\,\\exp(-\\Lambda D)\\right)\\,\\mathrm{d}D\n$$\nThe terms that do not depend on the integration variable $D$ can be factored out of the integral:\n$$\n\\eta = \\frac{\\pi^{5} |K|^{2} N_{0}}{\\lambda^{4}} \\int_{0}^{\\infty} D^{6}\\,\\exp(-\\Lambda D)\\,\\mathrm{d}D\n$$\nThe integral portion is a standard form of the Gamma function. We use the general integral identity:\n$$\n\\int_{0}^{\\infty} x^{n}\\,\\exp(-ax)\\,\\mathrm{d}x = \\frac{\\Gamma(n+1)}{a^{n+1}} = \\frac{n!}{a^{n+1}}\n$$\nfor integer $n \\ge 0$ and $a > 0$. In our case, the variables correspond to $x=D$, $n=6$, and $a=\\Lambda$. Applying this identity, the integral evaluates to:\n$$\n\\int_{0}^{\\infty} D^{6}\\,\\exp(-\\Lambda D)\\,\\mathrm{d}D = \\frac{6!}{\\Lambda^{6+1}} = \\frac{6!}{\\Lambda^{7}}\n$$\nThe factorial $6!$ is calculated as $6 \\times 5 \\times 4 \\times 3 \\times 2 \\times 1 = 720$. Therefore, the integral is $\\frac{720}{\\Lambda^{7}}$.\n\nSubstituting this result back into the expression for $\\eta$:\n$$\n\\eta = \\frac{\\pi^{5} |K|^{2} N_{0}}{\\lambda^{4}} \\left(\\frac{720}{\\Lambda^{7}}\\right)\n$$\nThe problem provides the definitive relationship between $\\eta$ and the equivalent radar reflectivity factor $Z$:\n$$\n\\eta = \\left(\\frac{\\pi^{5}\\,|K|^{2}}{\\lambda^{4}}\\right)\\,Z\n$$\nBy equating the two derived and given expressions for $\\eta$, we can solve for $Z$:\n$$\n\\left(\\frac{\\pi^{5}\\,|K|^{2}}{\\lambda^{4}}\\right)\\,Z = \\frac{\\pi^{5} |K|^{2} N_{0}}{\\lambda^{4}} \\frac{720}{\\Lambda^{7}}\n$$\nThe term $\\frac{\\pi^{5}\\,|K|^{2}}{\\lambda^{4}}$ is a non-zero factor common to both sides of the equation and can be cancelled. This leaves the expression for $Z$:\n$$\nZ = N_{0} \\frac{720}{\\Lambda^{7}}\n$$\nThis expression is the closed-form analytical solution for $Z$ in terms of $N_{0}$ and $\\Lambda$. As requested, it is in its simplest exact form and corresponds to coherent International System of Units. The units of $Z$ are $\\mathrm{m}^{3}$, which can be verified from the units of $N_{0}$ ($\\mathrm{m}^{-4}$) and $\\Lambda$ ($\\mathrm{m}^{-1}$), yielding $\\mathrm{m}^{-4} / (\\mathrm{m}^{-1})^{7} = \\mathrm{m}^{3}$.",
            "answer": "$$\\boxed{\\frac{720 N_{0}}{\\Lambda^{7}}}$$"
        },
        {
            "introduction": "While variational data assimilation seeks the optimal model state by minimizing a cost function, this optimization must adhere to physical laws, such as ensuring that quantities like hydrometeor mixing ratios remain non-negative. This practice explores how to enforce this fundamental physical constraint using the formal mathematical machinery of constrained optimization. By applying the Karush-Kuhn-Tucker (KKT) conditions , you will develop a crucial skill for building robust and physically consistent assimilation systems.",
            "id": "4080660",
            "problem": "Consider a single-column, single-level variational data assimilation problem for rainwater mixing ratio in the context of numerical weather prediction and climate modeling with Weather Radar Reflectivity and Doppler Velocity. The hydrometeor variable of interest is the rainwater mixing ratio $q_{r}$, which must remain nonnegative on physical grounds. You will derive and compute the constrained variational estimate that avoids unphysical negative values by treating the nonnegativity as an inequality constraint. As an alternative, you will briefly justify a variable transform that enforces positivity by construction, but you will not compute with that transform.\n\nStart from the Bayesian estimation framework under Gaussian error assumptions: the negative log-posterior is a sum of squared deviations weighted by the inverse error variances. Let the Three-Dimensional Variational (3D-Var) cost function for a single point be\n$$\nJ(q_{r}) \\equiv \\frac{1}{2}\\frac{(q_{r}-q_{b})^{2}}{\\sigma_{b}^{2}} + \\frac{1}{2}\\frac{\\big(h_{Z}(q_{r}) - z\\big)^{2}}{\\sigma_{Z}^{2}} + \\frac{1}{2}\\frac{\\big(h_{V}(q_{r}) - v_{\\text{obs}}\\big)^{2}}{\\sigma_{V}^{2}},\n$$\nwhere $q_{b}$ is the background rainwater mixing ratio, $\\sigma_{b}$ is the background standard deviation, $z$ is the radar reflectivity-related observation, $\\sigma_{Z}$ is its standard deviation, $v_{\\text{obs}}$ is the Doppler radial velocity observation, and $\\sigma_{V}$ is its standard deviation. Assume the radar forward operators are first-order linearizations around the background state:\n$$\nh_{Z}(q_{r}) \\approx c\\,q_{r}, \\quad h_{V}(q_{r}) \\approx v_{b} + k\\,q_{r},\n$$\nwith $c>0$ representing an effective linear sensitivity of the reflectivity-based quantity to $q_{r}$, $v_{b}$ the background radial velocity exclusive of hydrometeor terminal fall speed, and $k>0$ the effective linear sensitivity of the Doppler radial velocity to $q_{r}$ through hydrometeor terminal fall speed contributions. Enforce the physical constraint $q_{r} \\ge 0$.\n\nYou will derive the Karush-Kuhn-Tucker (KKT) optimality conditions for the inequality-constrained minimization; use them to identify whether the constraint is active. Then compute the constrained minimizer. Use the following physically plausible values:\n- $q_{b} = 0.2$ (g/kg), $\\sigma_{b} = 0.3$ (g/kg),\n- $c = 5$ (arbitrary linearized reflectivity units per g/kg), $z = 0.1$ (same units), $\\sigma_{Z} = 0.7$,\n- $v_{b} = 10$ (m/s), $k = 4$ (m s$^{-1}$ per g/kg), $v_{\\text{obs}} = 4$ (m/s), $\\sigma_{V} = 2$ (m/s).\n\nTo avoid negative hydrometeor mixing ratios, you must consider the inequality constraint $q_{r} \\ge 0$ and proceed via constrained optimization. As an alternative approach, justify how a logarithmic variable transform $s \\equiv \\ln(q_{r}+q_{0})$ with a small positive $q_{0}$ would enforce positivity by construction, and explain at a high level how the cost would be re-expressed in terms of $s$.\n\nCompute the constrained minimizer $q_{r}^{\\ast}$ and express your final answer in g/kg. If any numerical approximation is used, provide the exact arithmetic wherever possible; no rounding specification is necessary beyond what is required to convey the exact value in closed form.",
            "solution": "The problem requires finding the optimal estimate for the rainwater mixing ratio, $q_r$, by minimizing a variational cost function $J(q_r)$ subject to the physical nonnegativity constraint $q_r \\ge 0$. The analysis will proceed in two parts: first, solving the constrained optimization problem using the Karush-Kuhn-Tucker (KKT) conditions, and second, justifying an alternative approach using a variable transformation.\n\nFirst, we validate the problem statement.\n**Step 1: Extract Givens**\n- Cost function: $J(q_{r}) \\equiv \\frac{1}{2}\\frac{(q_{r}-q_{b})^{2}}{\\sigma_{b}^{2}} + \\frac{1}{2}\\frac{\\big(h_{Z}(q_{r}) - z\\big)^{2}}{\\sigma_{Z}^{2}} + \\frac{1}{2}\\frac{\\big(h_{V}(q_{r}) - v_{\\text{obs}}\\big)^{2}}{\\sigma_{V}^{2}}$\n- Linearized forward operators: $h_{Z}(q_{r}) \\approx c\\,q_{r}$ and $h_{V}(q_{r}) \\approx v_{b} + k\\,q_{r}$\n- Constraint: $q_r \\ge 0$\n- Numerical values:\n  - $q_{b} = 0.2$ g/kg\n  - $\\sigma_{b} = 0.3$ g/kg\n  - $c = 5$ (arbitrary units per g/kg)\n  - $z = 0.1$ (arbitrary units)\n  - $\\sigma_{Z} = 0.7$ (arbitrary units)\n  - $v_{b} = 10$ m/s\n  - $k = 4$ m s$^{-1}$ per g/kg\n  - $v_{\\text{obs}} = 4$ m/s\n  - $\\sigma_{V} = 2$ m/s\n- Alternative approach: Variable transform $s \\equiv \\ln(q_r + q_0)$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded in the field of numerical weather prediction, specifically variational data assimilation. The cost function is a standard Bayesian negative log-posterior under Gaussian error assumptions. The forward operators are linearized, a common and valid simplification. The nonnegativity constraint on a mixing ratio is physically correct. The proposed optimization method using KKT conditions is a standard and rigorous mathematical technique for such problems. The alternative logarithmic transform is also a standard method for enforcing positivity. The problem is well-posed, self-contained, and provides all necessary information. The numerical values are physically plausible. No flaws are identified.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A full solution will be provided.\n\n**Part 1: Constrained Minimization using KKT Conditions**\n\nWe substitute the linearized forward operators into the cost function:\n$$\nJ(q_{r}) = \\frac{1}{2\\sigma_{b}^{2}}(q_{r}-q_{b})^{2} + \\frac{1}{2\\sigma_{Z}^{2}}(c q_{r} - z)^{2} + \\frac{1}{2\\sigma_{V}^{2}}(v_{b} + k q_{r} - v_{\\text{obs}})^{2}\n$$\nThis is a quadratic function of $q_r$. The optimization problem is to find $q_r^*$ that minimizes $J(q_r)$ subject to the inequality constraint $g(q_r) = -q_r \\le 0$.\n\nWe use the method of Lagrange multipliers for inequality constraints. The Lagrangian function is:\n$$\n\\mathcal{L}(q_r, \\lambda) = J(q_r) - \\lambda q_r\n$$\nwhere $\\lambda$ is the Karush-Kuhn-Tucker (KKT) multiplier. The KKT conditions for optimality are:\n1.  **Stationarity:** $\\frac{\\partial \\mathcal{L}}{\\partial q_r} = \\frac{dJ}{dq_r} - \\lambda = 0$\n2.  **Primal Feasibility:** $q_r \\ge 0$\n3.  **Dual Feasibility:** $\\lambda \\ge 0$\n4.  **Complementary Slackness:** $\\lambda q_r = 0$\n\nFrom the complementary slackness condition, there are two possibilities:\n- Case A: The constraint is inactive, so $q_r > 0$. This implies $\\lambda=0$.\n- Case B: The constraint is active, so $q_r = 0$. This implies $\\lambda \\ge 0$.\n\nWe first investigate Case A by finding the unconstrained minimizer, denoted $q_{r, \\text{unc}}$, which corresponds to setting $\\lambda=0$. From the stationarity condition, we have $\\frac{dJ}{dq_r} = 0$. The derivative of the cost function is:\n$$\n\\frac{dJ}{dq_r} = \\frac{q_r - q_b}{\\sigma_b^2} + \\frac{c(c q_r - z)}{\\sigma_Z^2} + \\frac{k(v_b + k q_r - v_{\\text{obs}})}{\\sigma_V^2}\n$$\nSetting $\\frac{dJ}{dq_r} = 0$ and solving for $q_r$:\n$$\nq_r \\left( \\frac{1}{\\sigma_b^2} + \\frac{c^2}{\\sigma_Z^2} + \\frac{k^2}{\\sigma_V^2} \\right) = \\frac{q_b}{\\sigma_b^2} + \\frac{cz}{\\sigma_Z^2} - \\frac{k(v_b - v_{\\text{obs}})}{\\sigma_V^2}\n$$\nThe unconstrained minimizer is:\n$$\nq_{r, \\text{unc}} = \\frac{\\frac{q_b}{\\sigma_b^2} + \\frac{cz}{\\sigma_Z^2} - \\frac{k(v_b - v_{\\text{obs}})}{\\sigma_V^2}}{\\frac{1}{\\sigma_b^2} + \\frac{c^2}{\\sigma_Z^2} + \\frac{k^2}{\\sigma_V^2}}\n$$\nNow, we substitute the given numerical values:\n- $q_b = 0.2$, $\\sigma_b = 0.3 \\implies \\sigma_b^2 = 0.09$\n- $c = 5$, $z = 0.1$, $\\sigma_Z = 0.7 \\implies \\sigma_Z^2 = 0.49$\n- $k = 4$, $v_b = 10$, $v_{\\text{obs}} = 4$, $\\sigma_V = 2 \\implies \\sigma_V^2 = 4$\n\nThe numerator term is:\n$$\n\\frac{0.2}{0.09} + \\frac{5 \\cdot 0.1}{0.49} - \\frac{4(10 - 4)}{4} = \\frac{20}{9} + \\frac{50}{49} - 6 = \\frac{20 \\cdot 49 + 50 \\cdot 9 - 6 \\cdot 441}{441} = \\frac{980 + 450 - 2646}{441} = \\frac{1430 - 2646}{441} = -\\frac{1216}{441}\n$$\nThe denominator term is:\n$$\n\\frac{1}{0.09} + \\frac{5^2}{0.49} + \\frac{4^2}{4} = \\frac{100}{9} + \\frac{2500}{49} + 4 = \\frac{100 \\cdot 49 + 2500 \\cdot 9 + 4 \\cdot 441}{441} = \\frac{4900 + 22500 + 1764}{441} = \\frac{29164}{441}\n$$\nThus, the unconstrained minimizer is:\n$$\nq_{r, \\text{unc}} = \\frac{-1216/441}{29164/441} = -\\frac{1216}{29164} = -\\frac{304}{7291}\n$$\nSince $q_{r, \\text{unc}} = -304/7291 < 0$, the unconstrained solution violates the primal feasibility condition $q_r \\ge 0$. Therefore, Case A is invalid, and the constraint must be active. This leads us to Case B.\n\nIn Case B, the constraint is active, meaning the solution lies on the boundary of the feasible region. The constrained minimizer is therefore $q_r^* = 0$.\nTo confirm this is the correct KKT point, we must verify that a corresponding $\\lambda \\ge 0$ exists. From the stationarity condition, $\\lambda = \\frac{dJ}{dq_r}$ evaluated at the proposed solution $q_r^* = 0$.\n$$\n\\lambda = \\frac{dJ}{dq_r}\\bigg|_{q_r=0} = \\frac{0 - q_b}{\\sigma_b^2} + \\frac{c(0 - z)}{\\sigma_Z^2} + \\frac{k(v_b + 0 - v_{\\text{obs}})}{\\sigma_V^2} = -\\frac{q_b}{\\sigma_b^2} - \\frac{cz}{\\sigma_Z^2} + \\frac{k(v_b - v_{\\text{obs}})}{\\sigma_V^2}\n$$\nThis expression is the negative of the term $\\frac{q_b}{\\sigma_b^2} + \\frac{cz}{\\sigma_Z^2} - \\frac{k(v_b - v_{\\text{obs}})}{\\sigma_V^2} = -\\frac{1216}{441}$ divided by the denominator. No, wait.\nLet's re-evaluate $\\lambda$:\n$$\n\\lambda = \\frac{dJ}{dq_r}\\bigg|_{q_r=0} = \\frac{-q_b}{\\sigma_b^2} - \\frac{cz}{\\sigma_Z^2} + \\frac{k(v_b - v_{\\text{obs}})}{\\sigma_V^2} = - \\left( \\frac{q_b}{\\sigma_b^2} + \\frac{cz}{\\sigma_Z^2} - \\frac{k(v_b - v_{\\text{obs}})}{\\sigma_V^2} \\right)\n$$\nWe already calculated the term in the parenthesis as the numerator of $q_{r, \\text{unc}}$, which was $-\\frac{1216}{441}$.\nSo, $\\lambda = - \\left(-\\frac{1216}{441}\\right) = \\frac{1216}{441}$.\nSo we have the solution candidate $(q_r^*, \\lambda) = (0, 1216/441)$. Let's check all KKT conditions:\n1.  Stationarity: $\\frac{dJ}{dq_r}|_{q_r=0} - \\lambda = \\frac{1216}{441} - \\frac{1216}{441} = 0$. (Holds)\n2.  Primal Feasibility: $q_r^* = 0 \\ge 0$. (Holds)\n3.  Dual Feasibility: $\\lambda = \\frac{1216}{441} > 0$. (Holds)\n4.  Complementary Slackness: $\\lambda q_r^* = \\frac{1216}{441} \\cdot 0 = 0$. (Holds)\nAll conditions are satisfied. Thus, the constrained minimizer is $q_r^* = 0$.\n\n**Part 2: Justification of the Logarithmic Variable Transform**\n\nAn alternative method to enforce positivity is through a variable transformation. Consider the transformation $s = \\ln(q_r + q_0)$, where $q_0$ is a small positive constant to handle cases where $q_r$ might be zero. The inverse transformation is $q_r(s) = \\exp(s) - q_0$.\n\nThe new control variable is $s$, which is unconstrained and can take any value on the real line $(-\\infty, \\infty)$. For any real $s$, the exponential function $\\exp(s)$ is strictly positive. Consequently, the physical variable $q_r = \\exp(s) - q_0$ is guaranteed to be greater than $-q_0$. By choosing a small $q_0$, we effectively ensure $q_r$ remains non-negative for practical purposes. The optimization problem is thus transformed from a constrained problem in $q_r$ to an unconstrained problem in $s$.\n\nThe cost function would be rewritten in terms of $s$:\n$$\nJ(s) = J(q_r(s)) = \\frac{1}{2\\sigma_{b}^{2}}\\big((\\exp(s) - q_0) - q_{b}\\big)^{2} + \\frac{1}{2\\sigma_{Z}^{2}}\\big(c(\\exp(s)-q_0) - z\\big)^{2} + \\frac{1}{2\\sigma_{V}^{2}}\\big(v_{b} + k(\\exp(s)-q_0) - v_{\\text{obs}}\\big)^{2}\n$$\nThis new cost function $J(s)$ is no longer quadratic in the control variable $s$. Its minimization would require an iterative numerical algorithm, such as a quasi-Newton method. This approach trades the complexity of handling constraints for the complexity of solving a non-linear unconstrained optimization problem.\n\nThe computed constrained minimizer is $q_r^*=0$ g/kg.",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "The engine of any variational data assimilation system is the gradient of the cost function, which directs the minimization algorithm towards an improved atmospheric state. An error in this gradient, which is calculated by the adjoint model, can lead to catastrophic failure of the assimilation. This hands-on coding exercise  walks you through the \"gradient check,\" a critical verification procedure where the analytically derived gradient is compared against a numerical finite-difference approximation to ensure its correctness.",
            "id": "4080555",
            "problem": "You are given a synthetic single-column state for a Numerical Weather Prediction (NWP) model with prognostic variables horizontal wind in the $x$-direction $u$ (in $\\mathrm{m/s}$), horizontal wind in the $y$-direction $v$ (in $\\mathrm{m/s}$), vertical wind $w$ (in $\\mathrm{m/s}$), and rainwater mixing ratio $q_r$ (in $\\mathrm{kg/kg}$). You will construct a cost function that compares model-predicted radar observables to synthetic observations, and then perform a rigorous gradient check by comparing adjoint-derived analytical gradients to finite-difference approximations.\n\nFundamental base for the observation operators:\n- The radar reflectivity factor $Z$ (linear units) is defined as the sixth moment of the raindrop size distribution $N(D)$ with respect to drop diameter $D$, i.e., $Z = \\int_0^\\infty D^6 N(D) \\,\\mathrm{d}D$, where $D$ is measured in $\\mathrm{m}$.\n- Assume an exponential drop size distribution $N(D) = N_0 \\exp(-\\Lambda D)$ (Marshall–Palmer), with constant intercept parameter $N_0$ (in $\\mathrm{m}^{-4}$) and slope parameter $\\Lambda$ (in $\\mathrm{m}^{-1}$) that is constrained by the rainwater content $W$. The rainwater content is $W = \\rho_a q_r$, where $\\rho_a$ is air density (in $\\mathrm{kg/m^3}$), and $q_r \\ge 0$.\n- The mass content $W$ relates to the third moment via $W = \\frac{\\pi \\rho_w}{6} \\int_0^\\infty D^3 N(D) \\,\\mathrm{d}D$, where $\\rho_w$ is liquid water density (in $\\mathrm{kg/m^3}$).\n- The Doppler radial velocity $v_r$ is the line-of-sight projection of the wind vector onto the radar beam: for elevation angle $\\theta$ (in radians) and azimuth angle $\\phi$ (in radians, measured clockwise from the positive $y$-axis, i.e., North), the operator is $v_r(u,v,w,\\theta,\\phi) = u \\cos\\theta \\sin\\phi + v \\cos\\theta \\cos\\phi + w \\sin\\theta$.\n\nDefine the scalar cost function to be minimized as\n$$\nJ(u,v,w,q_r) = \\frac{1}{2}\\left(\\frac{Z(u,v,w,q_r) - Z_\\text{obs}}{\\sigma_Z}\\right)^2 + \\frac{1}{2}\\left(\\frac{v_r(u,v,w,\\theta,\\phi) - v_\\text{obs}}{\\sigma_v}\\right)^2,\n$$\nwhere $Z_\\text{obs}$ and $v_\\text{obs}$ are synthetic observations generated from a specified true state, and $\\sigma_Z$ and $\\sigma_v$ are the observation error standard deviations (in the same units as their respective observables).\n\nYour task is to:\n1. Starting strictly from the above fundamental definitions and relationships, analytically derive the adjoint-compatible gradient $\\nabla J$ with respect to $(u,v,w,q_r)$, expressing all needed intermediate relationships that follow from the exponential drop size distribution and the projection definition of Doppler radial velocity. Angles must be handled in radians.\n2. Implement a program that computes, for each test case, the analytical gradient and a finite-difference approximation to the gradient of $J$ using central differences with a small perturbation. When a symmetric perturbation for $q_r$ would violate the physical bound $q_r \\ge 0$, use a one-sided forward difference for $q_r$. Use perturbations $\\epsilon_u = \\epsilon_v = \\epsilon_w = 10^{-6}\\,\\mathrm{m/s}$ and $\\epsilon_{q_r} = 10^{-8}\\,\\mathrm{kg/kg}$.\n3. For each test case, report the relative discrepancy between the analytical (adjoint-derived) gradient and the finite-difference gradient as the ratio of the Euclidean norm of their difference to the Euclidean norm of the analytical gradient. To avoid division by zero, add a small positive stabilizer $\\delta = 10^{-16}$ in the denominator:\n$$\n\\mathrm{rel\\_err} = \\frac{\\left\\|\\nabla J_\\text{fd} - \\nabla J_\\text{adj}\\right\\|_2}{\\left\\|\\nabla J_\\text{adj}\\right\\|_2 + \\delta}.\n$$\nThe final answers for the test cases must be unitless floats.\n\nUse the following constants in all computations: $N_0 = 8\\times 10^{6}\\,\\mathrm{m}^{-4}$, $\\rho_w = 1000\\,\\mathrm{kg/m^3}$.\n\nAngles must be in radians. All velocities must be in $\\mathrm{m/s}$. Air density must be in $\\mathrm{kg/m^3}$. Rainwater mixing ratio must be in $\\mathrm{kg/kg}$. The reflectivity $Z$ must be computed in linear units, not in decibels.\n\nSynthetic observations are generated by evaluating the operators at the specified “true” state for each test case.\n\nTest suite (each case gives $(u,v,w,q_r)$, $(u_\\text{true},v_\\text{true},w_\\text{true},q_{r,\\text{true}})$, $\\theta$, $\\phi$, $\\rho_a$, $\\sigma_Z$, $\\sigma_v$):\n- Case $1$ (general nonzero winds and moderate rain): $(10,-5,0.5,10^{-3})$, $(12,-4,0.6,1.2\\times 10^{-3})$, $\\theta=0.25$, $\\phi=1.0$, $\\rho_a=1.2$, $\\sigma_Z=10^{-15}$, $\\sigma_v=0.5$.\n- Case $2$ (near-zero rainwater, test physical bound handling): $(2,3,0.1,10^{-8})$, $(1.8,3.2,0.15,5\\times 10^{-8})$, $\\theta=0.4$, $\\phi=2.0$, $\\rho_a=1.2$, $\\sigma_Z=10^{-15}$, $\\sigma_v=0.5$.\n- Case $3$ (zero vertical wind at analysis point): $(-8,6,0,8\\times 10^{-4})$, $(-7.5,6.5,0.05,9\\times 10^{-4})$, $\\theta=0.7$, $\\phi=0.3$, $\\rho_a=1.2$, $\\sigma_Z=10^{-15}$, $\\sigma_v=0.5$.\n- Case $4$ (horizontal beam, no sensitivity to $w$): $(15,0,3.0,10^{-3})$, $(15.5,-0.5,2.5,1.1\\times 10^{-3})$, $\\theta=0.0$, $\\phi=1.57$, $\\rho_a=1.2$, $\\sigma_Z=10^{-15}$, $\\sigma_v=0.5$.\n- Case $5$ (larger rainwater mixing ratio and high elevation): $(-20,10,1.5,5\\times 10^{-3})$, $(-19,11,1.4,4.8\\times 10^{-3})$, $\\theta=1.0$, $\\phi=2.8$, $\\rho_a=1.2$, $\\sigma_Z=10^{-15}$, $\\sigma_v=0.5$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,r_3,r_4,r_5]$), where each $r_i$ is the relative error for the corresponding test case as defined above.",
            "solution": "The problem requires the derivation and verification of the gradient of a data assimilation cost function. The cost function, $J$, quantifies the misfit between model-predicted radar observables (reflectivity $Z$ and Doppler velocity $v_r$) and their corresponding synthetic observations ($Z_\\text{obs}, v_\\text{obs}$). The gradient of this cost function with respect to the model state variables $(u, v, w, q_r)$ is essential for variational data assimilation methods, as it directs the minimization algorithm towards a model state that better fits the observations. The verification is a crucial step known as a gradient check, where the analytically derived gradient (the \"adjoint\" method) is compared against a numerical approximation obtained through finite differences.\n\nThe state vector is $\\mathbf{x} = (u, v, w, q_r)$, where $u$, $v$, and $w$ are the wind components in $\\mathrm{m/s}$ and $q_r$ is the rainwater mixing ratio in $\\mathrm{kg/kg}$. The cost function is given by:\n$$\nJ(\\mathbf{x}) = \\frac{1}{2}\\left(\\frac{Z(q_r) - Z_\\text{obs}}{\\sigma_Z}\\right)^2 + \\frac{1}{2}\\left(\\frac{v_r(u,v,w) - v_\\text{obs}}{\\sigma_v}\\right)^2\n$$\nThe derivation and verification process proceeds as follows.\n\nFirst, we must establish the analytical forms of the forward operators, $v_r(u,v,w)$ and $Z(q_r)$, which map the model state to the observation space.\n\n**1. Doppler Velocity Operator, $v_r(u,v,w,\\theta,\\phi)$**\nThe Doppler radial velocity $v_r$ is defined as the projection of the wind vector $\\mathbf{v} = (u, v, w)$ onto the unit vector along the radar beam, $\\hat{\\mathbf{d}}$. With an elevation angle $\\theta$ (from the horizontal plane) and a meteorological azimuth angle $\\phi$ (clockwise from North), the Cartesian components of the beam direction vector are $(\\sin\\phi, \\cos\\phi, 0)$ for the horizontal part, rotated up by $\\theta$. The unit beam vector is $(\\cos\\theta \\sin\\phi, \\cos\\theta \\cos\\phi, \\sin\\theta)$. The projection is the dot product:\n$$\nv_r = \\mathbf{v} \\cdot \\hat{\\mathbf{d}} = u \\cos\\theta \\sin\\phi + v \\cos\\theta \\cos\\phi + w \\sin\\theta\n$$\nNote that the reflectivity $Z$ is independent of the wind components $(u, v, w)$, and the Doppler velocity $v_r$ is independent of the rainwater mixing ratio $q_r$.\n\n**2. Reflectivity Operator, $Z(q_r)$**\nThe derivation of $Z$ as a function of $q_r$ requires several steps based on the provided microphysical assumptions.\nWe start with the assumed Marshall-Palmer drop size distribution, $N(D) = N_0 \\exp(-\\Lambda D)$.\nThe general form of the $n$-th moment of this distribution is given by the integral:\n$$\nM_n = \\int_0^\\infty D^n N(D) \\,\\mathrm{d}D = N_0 \\int_0^\\infty D^n e^{-\\Lambda D} \\,\\mathrm{d}D\n$$\nThis integral is related to the Gamma function, $\\Gamma(z) = \\int_0^\\infty t^{z-1} e^{-t} \\,\\mathrm{d}t$. With the substitution $t = \\Lambda D$, we find:\n$$\n\\int_0^\\infty D^n e^{-\\Lambda D} \\,\\mathrm{d}D = \\frac{\\Gamma(n+1)}{\\Lambda^{n+1}} = \\frac{n!}{\\Lambda^{n+1}}\n$$\nThus, $M_n = N_0 n! / \\Lambda^{n+1}$.\n\nNext, we relate the slope parameter $\\Lambda$ to the rainwater mixing ratio $q_r$. The rainwater content $W$ (in $\\mathrm{kg/m^3}$) is given by $W = \\rho_a q_r$, where $\\rho_a$ is the air density. $W$ is also defined as the mass of all drops per unit volume, which corresponds to the third moment of the DSD:\n$$\nW = \\frac{\\pi \\rho_w}{6} \\int_0^\\infty D^3 N(D) \\,\\mathrm{d}D = \\frac{\\pi \\rho_w}{6} M_3\n$$\nSubstituting $M_3 = N_0 3! / \\Lambda^4 = 6 N_0 / \\Lambda^4$:\n$$\nW = \\rho_a q_r = \\frac{\\pi \\rho_w}{6} \\frac{6 N_0}{\\Lambda^4} = \\frac{\\pi \\rho_w N_0}{\\Lambda^4}\n$$\nSolving for $\\Lambda$ gives its dependence on $q_r$:\n$$\n\\Lambda(q_r) = \\left( \\frac{\\pi \\rho_w N_0}{\\rho_a q_r} \\right)^{1/4}\n$$\nThis relationship is valid for $q_r > 0$.\n\nThe radar reflectivity factor $Z$ is the sixth moment of the DSD:\n$$\nZ = \\int_0^\\infty D^6 N(D) \\,\\mathrm{d}D = M_6 = \\frac{N_0 6!}{\\Lambda^7} = \\frac{720 N_0}{\\Lambda^7}\n$$\nSubstituting the expression for $\\Lambda(q_r)$ into the equation for $Z$:\n$$\nZ(q_r) = 720 N_0 \\left[ \\left( \\frac{\\pi \\rho_w N_0}{\\rho_a q_r} \\right)^{1/4} \\right]^{-7} = 720 N_0 \\left( \\frac{\\pi \\rho_w N_0}{\\rho_a q_r} \\right)^{-7/4}\n$$\nThis simplifies to the final forward operator for reflectivity:\n$$\nZ(q_r) = 720 N_0 \\left( \\frac{\\rho_a}{\\pi \\rho_w N_0} \\right)^{7/4} q_r^{7/4}\n$$\nFor $q_r \\le 0$, the reflectivity is physically $Z=0$.\n\n**3. Analytical Gradient (Adjoint) Derivation**\nThe gradient $\\nabla J = (\\frac{\\partial J}{\\partial u}, \\frac{\\partial J}{\\partial v}, \\frac{\\partial J}{\\partial w}, \\frac{\\partial J}{\\partial q_r})$ is computed using the chain rule. The cost function is a sum of two independent terms, $J = J_v + J_Z$.\n\nFor the wind components, the gradient of $J$ is simply the gradient of $J_v$:\n$$\n\\frac{\\partial J}{\\partial u} = \\frac{\\partial J_v}{\\partial u} = \\frac{\\partial J_v}{\\partial v_r} \\frac{\\partial v_r}{\\partial u} = \\frac{1}{\\sigma_v^2} (v_r - v_\\text{obs}) \\cdot (\\cos\\theta \\sin\\phi)\n$$\n$$\n\\frac{\\partial J}{\\partial v} = \\frac{\\partial J_v}{\\partial v} = \\frac{\\partial J_v}{\\partial v_r} \\frac{\\partial v_r}{\\partial v} = \\frac{1}{\\sigma_v^2} (v_r - v_\\text{obs}) \\cdot (\\cos\\theta \\cos\\phi)\n$$\n$$\n\\frac{\\partial J}{\\partial w} = \\frac{\\partial J_v}{\\partial w} = \\frac{\\partial J_v}{\\partial v_r} \\frac{\\partial v_r}{\\partial w} = \\frac{1}{\\sigma_v^2} (v_r - v_\\text{obs}) \\cdot (\\sin\\theta)\n$$\n\nFor the rainwater mixing ratio, the gradient of $J$ is the gradient of $J_Z$:\n$$\n\\frac{\\partial J}{\\partial q_r} = \\frac{\\partial J_Z}{\\partial q_r} = \\frac{\\partial J_Z}{\\partial Z} \\frac{\\partial Z}{\\partial q_r}\n$$\nThe first term is $\\frac{\\partial J_Z}{\\partial Z} = \\frac{1}{\\sigma_Z^2} (Z - Z_\\text{obs})$.\nThe second term, the Jacobian of the reflectivity operator, is derived from $Z(q_r) \\propto q_r^{7/4}$:\n$$\n\\frac{\\partial Z}{\\partial q_r} = \\frac{d}{dq_r} \\left[ C \\cdot q_r^{7/4} \\right] = C \\cdot \\frac{7}{4} q_r^{3/4}\n$$\nwhere $C$ is the constant of proportionality. A more elegant form is obtained by noticing that $Z/q_r = C \\cdot q_r^{3/4}$. Thus, for $q_r > 0$:\n$$\n\\frac{\\partial Z}{\\partial q_r} = \\frac{7}{4} \\frac{Z(q_r)}{q_r}\n$$\nFor $q_r = 0$, the derivative is $0$.\nCombining these gives the gradient component for $q_r$:\n$$\n\\frac{\\partial J}{\\partial q_r} = \\frac{1}{\\sigma_Z^2} (Z(q_r) - Z_\\text{obs}) \\cdot \\left( \\frac{7}{4} \\frac{Z(q_r)}{q_r} \\right)\n$$\n\n**4. Finite-Difference Gradient and Verification**\nTo verify the analytical gradient, $\\nabla J_\\text{adj}$, we compute a numerical approximation, $\\nabla J_\\text{fd}$, using finite differences. For a state variable $x_i$ with perturbation $\\epsilon_i$, the centered difference approximation is:\n$$\n\\frac{\\partial J}{\\partial x_i} \\approx \\frac{J(\\mathbf{x} + \\epsilon_i \\hat{\\mathbf{e}}_i) - J(\\mathbf{x} - \\epsilon_i \\hat{\\mathbf{e}}_i)}{2\\epsilon_i}\n$$\nwhere $\\hat{\\mathbf{e}}_i$ is the unit vector for the $i$-th component. This is used for $u, v, w$. For $q_r$, this formula is used only if the backward perturbation $q_r - \\epsilon_{q_r}$ is non-negative. If $q_r - \\epsilon_{q_r} < 0$, a one-sided forward difference is used to respect the physical boundary $q_r \\ge 0$:\n$$\n\\frac{\\partial J}{\\partial q_r} \\approx \\frac{J(\\mathbf{x} + \\epsilon_{q_r} \\hat{\\mathbf{e}}_{q_r}) - J(\\mathbf{x})}{\\epsilon_{q_r}}\n$$\nThe discrepancy between the analytical and numerical gradients is measured by the relative error:\n$$\n\\mathrm{rel\\_err} = \\frac{\\left\\|\\nabla J_\\text{fd} - \\nabla J_\\text{adj}\\right\\|_2}{\\left\\|\\nabla J_\\text{adj}\\right\\|_2 + \\delta}\n$$\nwhere $\\|\\cdot\\|_2$ denotes the Euclidean norm and $\\delta=10^{-16}$ is a stabilizer to prevent division by zero. A small relative error indicates that the analytical gradient (and by extension the adjoint model) is correctly implemented.\nThe computational procedure involves implementing these operators and gradients, processing each test case by generating synthetic observations from the \"true\" state, evaluating the cost function and its gradients at the \"analysis\" state, and finally computing the relative error.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to perform gradient checks for the radar data assimilation problem.\n    \"\"\"\n    # Define physical and numerical constants\n    N0 = 8.0e6  # Marshall-Palmer intercept parameter (m^-4)\n    RHO_W = 1000.0  # Density of liquid water (kg/m^3)\n    PI = np.pi\n    DELTA_STABILIZER = 1.0e-16\n\n    # Perturbations for finite-difference calculations\n    PERTURBATIONS = {\n        'u': 1.0e-6,\n        'v': 1.0e-6,\n        'w': 1.0e-6,\n        'qr': 1.0e-8,\n    }\n\n    # Test cases as provided in the problem statement\n    # Each tuple contains:\n    # (analysis_state, true_state, radar_params, atmosphere_params, error_std_devs)\n    # state = (u, v, w, qr)\n    # radar_params = (theta, phi)\n    # atmosphere_params = (rho_a,)\n    # error_std_devs = (sigma_Z, sigma_v)\n    test_cases = [\n        # Case 1\n        ((10.0, -5.0, 0.5, 1.0e-3), (12.0, -4.0, 0.6, 1.2e-3),\n         (0.25, 1.0), (1.2,), (1.0e-15, 0.5)),\n        # Case 2\n        ((2.0, 3.0, 0.1, 1.0e-8), (1.8, 3.2, 0.15, 5.0e-8),\n         (0.4, 2.0), (1.2,), (1.0e-15, 0.5)),\n        # Case 3\n        ((-8.0, 6.0, 0.0, 8.0e-4), (-7.5, 6.5, 0.05, 9.0e-4),\n         (0.7, 0.3), (1.2,), (1.0e-15, 0.5)),\n        # Case 4\n        ((15.0, 0.0, 3.0, 1.0e-3), (15.5, -0.5, 2.5, 1.1e-3),\n         (0.0, 1.57), (1.2,), (1.0e-15, 0.5)),\n        # Case 5\n        ((-20.0, 10.0, 1.5, 5.0e-3), (-19.0, 11.0, 1.4, 4.8e-3),\n         (1.0, 2.8), (1.2,), (1.0e-15, 0.5)),\n    ]\n\n    # --- Forward Operators ---\n    def calculate_Z(qr, rho_a):\n        \"\"\"Computes radar reflectivity Z from rainwater mixing ratio qr.\"\"\"\n        if qr = 0.0:\n            return 0.0\n        # Z = 720 * N0 * (rho_a / (pi * rho_w * N0))**(7/4) * qr**(7/4)\n        factor = (rho_a / (PI * RHO_W * N0))\n        return 720.0 * N0 * (factor**1.75) * (qr**1.75)\n\n    def calculate_vr(u, v, w, theta, phi):\n        \"\"\"Computes Doppler radial velocity vr from wind components (meteorological convention).\"\"\"\n        return (u * np.cos(theta) * np.sin(phi) +\n                v * np.cos(theta) * np.cos(phi) +\n                w * np.sin(theta))\n\n    # --- Cost Function ---\n    def cost_function(state, Z_obs, v_obs, params):\n        \"\"\"Computes the scalar cost function J.\"\"\"\n        u, v, w, qr = state\n        theta, phi, rho_a, sigma_Z, sigma_v = params\n        \n        Z_model = calculate_Z(qr, rho_a)\n        vr_model = calculate_vr(u, v, w, theta, phi)\n        \n        J_Z = 0.5 * ((Z_model - Z_obs) / sigma_Z)**2\n        J_v = 0.5 * ((vr_model - v_obs) / sigma_v)**2\n        \n        return J_Z + J_v\n\n    # --- Gradient Calculations ---\n    def analytical_gradient(state, Z_obs, v_obs, params):\n        \"\"\"Computes the analytical gradient of J (adjoint method).\"\"\"\n        u, v, w, qr = state\n        theta, phi, rho_a, sigma_Z, sigma_v = params\n        \n        Z_model = calculate_Z(qr, rho_a)\n        vr_model = calculate_vr(u, v, w, theta, phi)\n        \n        # Innovation terms scaled by observation error variance\n        innov_Z = (Z_model - Z_obs) / (sigma_Z**2)\n        innov_v = (vr_model - v_obs) / (sigma_v**2)\n\n        # Gradient w.r.t. wind components\n        grad_u = innov_v * np.cos(theta) * np.sin(phi)\n        grad_v = innov_v * np.cos(theta) * np.cos(phi)\n        grad_w = innov_v * np.sin(theta)\n\n        # Gradient w.r.t. rainwater mixing ratio\n        if qr > 0.0:\n            dZ_dqr = (7.0 / 4.0) * Z_model / qr\n            grad_qr = innov_Z * dZ_dqr\n        else:\n            grad_qr = 0.0\n            \n        return np.array([grad_u, grad_v, grad_w, grad_qr])\n\n    def finite_difference_gradient(state, Z_obs, v_obs, params):\n        \"\"\"Computes the numerical gradient of J using finite differences.\"\"\"\n        grad = np.zeros(4)\n        state_vars = list(state)\n        pert_keys = ['u', 'v', 'w', 'qr']\n\n        for i in range(4):\n            x_i = state_vars[i]\n            eps_i = PERTURBATIONS[pert_keys[i]]\n            \n            # Forward perturbation\n            state_p = state_vars[:]\n            state_p[i] += eps_i\n            J_p = cost_function(tuple(state_p), Z_obs, v_obs, params)\n\n            # Special handling for qr to respect physical bound\n            if i == 3 and (x_i - eps_i  0): # One-sided forward difference for qr\n                J_base = cost_function(tuple(state_vars), Z_obs, v_obs, params)\n                grad[i] = (J_p - J_base) / eps_i\n            else: # Centered difference\n                state_m = state_vars[:]\n                state_m[i] -= eps_i\n                J_m = cost_function(tuple(state_m), Z_obs, v_obs, params)\n                grad[i] = (J_p - J_m) / (2 * eps_i)\n        \n        return grad\n\n    # --- Main processing loop ---\n    results = []\n    for case in test_cases:\n        analysis_state, true_state, radar_params, atmos_params, err_stds = case\n\n        u_true, v_true, w_true, qr_true = true_state\n        theta, phi = radar_params\n        rho_a, = atmos_params\n        sigma_Z, sigma_v = err_stds\n\n        # Generate synthetic observations from the \"true\" state\n        Z_obs = calculate_Z(qr_true, rho_a)\n        v_obs = calculate_vr(u_true, v_true, w_true, theta, phi)\n        \n        # Combine all parameters for function calls\n        all_params = (theta, phi, rho_a, sigma_Z, sigma_v)\n\n        # Calculate analytical and finite-difference gradients at the \"analysis\" state\n        grad_adj = analytical_gradient(analysis_state, Z_obs, v_obs, all_params)\n        grad_fd = finite_difference_gradient(analysis_state, Z_obs, v_obs, all_params)\n\n        # Calculate the relative error\n        norm_diff = np.linalg.norm(grad_fd - grad_adj)\n        norm_adj = np.linalg.norm(grad_adj)\n        \n        rel_err = norm_diff / (norm_adj + DELTA_STABILIZER)\n        results.append(rel_err)\n\n    # Print results in the required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```[1.144884210214845e-08,1.487820102581622e-07,3.0336214371971713e-08,1.1095913495804364e-08,2.7237086885387934e-09]"
        }
    ]
}