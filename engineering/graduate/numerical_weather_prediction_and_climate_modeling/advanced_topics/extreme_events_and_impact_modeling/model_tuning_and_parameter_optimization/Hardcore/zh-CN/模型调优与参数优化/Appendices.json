{
    "hands_on_practices": [
        {
            "introduction": "在复杂的地球系统模型中，并非所有参数都能被观测数据同等地约束。费雪信息矩阵 (Fisher Information Matrix, FIM) 是一个强大的工具，用于量化参数估计的确定性。本练习将指导您为一个简化的气候模型计算FIM及其特征值，通过一个称为“草率性”(sloppiness)的度量来具体评估参数空间中的“刚性”和“草率”方向，这是参数优化前至关重要的诊断步骤 ()。",
            "id": "4065525",
            "problem": "考虑一个用于数值天气预报和气候模拟的简化单柱模型 (SCM)。该 SCM 有两个可调参数，收集到一个向量 $ \\theta = (\\alpha, \\tau)^{\\top} $ 中，其中 $ \\alpha $ 是夹带效率（无量纲），$ \\tau $ 是对流调整时间尺度（单位为秒）。令 $ y(\\theta) \\in \\mathbb{R}^{3} $ 表示由模型预测的三个可观测量组成的向量（例如，在三个不同时刻的柱平均位温）。\n\n假设以下在此情境下适用的基本假设：\n- 观测误差服从零均值高斯分布，其协方差为 $ R = \\sigma^{2} I $，其中 $ \\sigma = 0.2 $ （与 $ y $ 具有相同的物理单位），$ I $ 是 $ 3 \\times 3 $ 的单位矩阵。\n- 在名义参数值 $ \\theta_{0} $ 附近，模型-观测映射可线性化为 $ y(\\theta_{0} + \\delta \\theta) \\approx y(\\theta_{0}) + J \\, \\delta \\theta $，其中 $ J = \\partial y / \\partial \\theta \\big|_{\\theta_{0}} $ 是可观测量相对于参数的 $ 3 \\times 2 $ 灵敏度（雅可比）矩阵。\n- Fisher 信息矩阵 $ I(\\theta_{0}) $ 在这些假设下由负对数似然的期望曲率定义。\n\n在 $ \\theta = \\theta_{0} $ 处，测得的灵敏度为\n$$\nJ \\;=\\;\n\\begin{pmatrix}\n0.80  0.02 \\\\\n0.78  0.01 \\\\\n0.81  0.03\n\\end{pmatrix}.\n$$\n\n从上述基本假设出发，用 $ J $ 和 $ R $ 推导出 Fisher 信息矩阵 $ I(\\theta_{0}) $。使用给定数据数值计算 $ I(\\theta_{0}) $，然后计算其两个特征值，并根据参数的含糊性（即关于参数空间中方向的相对信息量）解释它们的量级。定义一个标量含糊性度量 $ s $ 为较小特征值与较大特征值的比值，即 $ s = \\lambda_{\\min} / \\lambda_{\\max} $。报告 $ s $ 的数值。\n\n将 $ s $ 的最终值四舍五入到四位有效数字。最终报告的值是无量纲的；在最终答案中不要包含任何单位。",
            "solution": "我们从观测误差的标准高斯似然出发。如果 $ y^{\\text{obs}} \\in \\mathbb{R}^{3} $ 是观测值，模型预测为 $ y(\\theta) $，误差 $ \\varepsilon = y^{\\text{obs}} - y(\\theta) $ 服从协方差为 $ R $ 的多元高斯分布，那么负对数似然为\n$$\n\\ell(\\theta)\n=\n\\frac{1}{2} \\left( y^{\\text{obs}} - y(\\theta) \\right)^{\\top} R^{-1} \\left( y^{\\text{obs}} - y(\\theta) \\right)\n+ \\text{const}.\n$$\n在名义参数 $ \\theta_{0} $ 附近的线性化下，我们有 $ y(\\theta_{0} + \\delta \\theta) \\approx y(\\theta_{0}) + J \\, \\delta \\theta $，其中 $ J = \\partial y / \\partial \\theta \\big|_{\\theta_{0}} $ 是 $ 3 \\times 2 $ 的雅可比矩阵。$ \\ell $ 关于 $ \\delta \\theta $ 的二阶导数（Hessian 矩阵），在观测噪声的期望下，由下式给出\n$$\nI(\\theta_{0})\n=\nJ^{\\top} R^{-1} J,\n$$\n这就是 Fisher 信息矩阵。对于参数估计中的高斯误差和线性化模型，这是一个经过充分检验的事实。\n\n给定 $ R = \\sigma^{2} I $ 且 $ \\sigma = 0.2 $，所以 $ R = 0.04 \\, I $，因此 $ R^{-1} = 25 \\, I $。所以，\n$$\nI(\\theta_{0})\n=\nJ^{\\top} R^{-1} J\n=\n25 \\, J^{\\top} J.\n$$\n根据给定的 $ J $ 计算 $ J^{\\top} J $：\n$$\nJ\n=\n\\begin{pmatrix}\n0.80  0.02 \\\\\n0.78  0.01 \\\\\n0.81  0.03\n\\end{pmatrix},\n\\quad\nJ^{\\top} J\n=\n\\begin{pmatrix}\n\\sum_{i=1}^{3} J_{i1}^{2}  \\sum_{i=1}^{3} J_{i1} J_{i2} \\\\\n\\sum_{i=1}^{3} J_{i1} J_{i2}  \\sum_{i=1}^{3} J_{i2}^{2}\n\\end{pmatrix}.\n$$\n计算每个元素：\n- 第一列的平方和：\n$$\n\\sum_{i=1}^{3} J_{i1}^{2}\n=\n(0.80)^{2} + (0.78)^{2} + (0.81)^{2}\n=\n0.6400 + 0.6084 + 0.6561\n=\n1.9045.\n$$\n- 第二列的平方和：\n$$\n\\sum_{i=1}^{3} J_{i2}^{2}\n=\n(0.02)^{2} + (0.01)^{2} + (0.03)^{2}\n=\n0.0004 + 0.0001 + 0.0009\n=\n0.0014.\n$$\n- 交叉项之和：\n$$\n\\sum_{i=1}^{3} J_{i1} J_{i2}\n=\n(0.80)(0.02) + (0.78)(0.01) + (0.81)(0.03)\n=\n0.016 + 0.0078 + 0.0243\n=\n0.0481.\n$$\n因此，\n$$\nJ^{\\top} J\n=\n\\begin{pmatrix}\n1.9045  0.0481 \\\\\n0.0481  0.0014\n\\end{pmatrix},\n\\qquad\nI(\\theta_{0})\n=\n25 \\begin{pmatrix}\n1.9045  0.0481 \\\\\n0.0481  0.0014\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n47.6125  1.2025 \\\\\n1.2025  0.035\n\\end{pmatrix}.\n$$\n\n由于 $ I(\\theta_{0}) $ 是对称正定的，其特征值 $ \\lambda_{\\max} $ 和 $ \\lambda_{\\min} $ 是实数且为正。对于一个 $ 2 \\times 2 $ 的对称矩阵\n$$\nM\n=\n\\begin{pmatrix}\na  b \\\\\nb  c\n\\end{pmatrix},\n$$\n其特征值为\n$$\n\\lambda_{\\pm}\n=\n\\frac{a + c \\pm \\sqrt{(a + c)^{2} - 4(ac - b^{2})}}{2}.\n$$\n这里，$ a = 47.6125 $，$ b = 1.2025 $，且 $ c = 0.035 $。令 $ t = a + c $ 和 $ d = ac - b^{2} $。计算\n$$\nt\n=\n47.6125 + 0.035\n=\n47.6475,\n\\qquad\nac\n=\n(47.6125)(0.035)\n=\n1.6664375,\n\\qquad\nb^{2}\n=\n(1.2025)^{2}\n=\n1.44600625,\n$$\n所以\n$$\nd\n=\nac - b^{2}\n=\n1.6664375 - 1.44600625\n=\n0.22043125.\n$$\n那么\n$$\n\\Delta\n=\n\\sqrt{t^{2} - 4d}\n=\n\\sqrt{(47.6475)^{2} - 4(0.22043125)}.\n$$\n通过展开精确计算 $ (47.6475)^{2} $：\n$$\n(47.6475)^{2}\n=\n(47.6 + 0.0475)^{2}\n=\n(47.6)^{2} + 2(47.6)(0.0475) + (0.0475)^{2}\n=\n2265.76 + 4.522 + 0.00225625\n=\n2270.28425625.\n$$\n因此，\n$$\nt^{2} - 4d\n=\n2270.28425625 - 0.881725\n=\n2269.40253125,\n\\quad\n\\Delta\n=\n\\sqrt{2269.40253125}\n\\approx\n47.63824644,\n$$\n那么特征值为\n$$\n\\lambda_{\\max}\n=\n\\frac{t + \\Delta}{2}\n=\n\\frac{47.6475 + 47.63824644}{2}\n\\approx\n47.64287322,\n$$\n$$\n\\lambda_{\\min}\n=\n\\frac{t - \\Delta}{2}\n=\n\\frac{47.6475 - 47.63824644}{2}\n\\approx\n0.00462678.\n$$\n\n含糊性度量 $ s $ 定义为 $ s = \\lambda_{\\min} / \\lambda_{\\max} $。使用上述值，\n$$\ns\n=\n\\frac{0.00462678}{47.64287322}\n\\approx\n9.711 \\times 10^{-5}.\n$$\n四舍五入到四位有效数字，最终值为 $ 9.711 \\times 10^{-5} $。\n\n解释：Fisher 信息矩阵 $ I(\\theta_{0}) $ 编码了数据对参数空间中方向的约束强度。一个非常小的比值 $ s = \\lambda_{\\min} / \\lambda_{\\max} $ 表明了强的各向异性：一个参数组合（对应于 $ \\lambda_{\\max} $ 的特征向量）受到数据的严格约束，而其正交组合（对应于 $ \\lambda_{\\min} $）的约束则极弱。在这个 SCM 例子中，可观测量对 $ \\tau $ 的灵敏度远小于对 $ \\alpha $ 的灵敏度（并且几乎与 $ \\alpha $ 方向共线），从而得到 $ s \\approx 9.711 \\times 10^{-5} $，这是一个含糊参数方向的典型特征，如果没有额外的信息或信息更丰富的观测，这个方向将难以被可靠地估计。",
            "answer": "$$\\boxed{9.711 \\times 10^{-5}}$$"
        },
        {
            "introduction": "当模型参数的“草率性”达到极致时，它们就变得不可识别，这通常源于参数效应之间的共线性。本练习将从理论上揭示模型的敏感度矩阵与费雪信息矩阵奇异性之间的深刻联系，阐明参数不可识别的根本原因。更重要的是，您将通过一个具体的例子学习如何运用重参数化这一关键技术 () 来分离可识别与不可识别的参数组合，从而改善优化问题的适定性。",
            "id": "4065497",
            "problem": "考虑一个在数值天气预报和气候模拟中使用的简化柱状模型中的调优任务，其中三个标量参数 $\\boldsymbol{\\theta} = (\\theta_{1}, \\theta_{2}, \\theta_{3})^{\\top}$ 控制着影响 $m$ 个可观测物理量（例如，多个层次或时间的短波辐射通量）的次网格过程参数化。在背景态的小扰动下，假设模型输出与参数之间的线性化关系由 $\\Delta \\boldsymbol{y} = S \\, \\Delta \\boldsymbol{\\theta}$ 给出，其中 $S \\in \\mathbb{R}^{m \\times p}$ 是由列向量 $s_{1}, s_{2}, s_{3} \\in \\mathbb{R}^{m}$ 组成的敏感度矩阵。假设观测误差是独立同分布的高斯分布，其方差为 $\\sigma^{2}$，因此权重矩阵为 $W = \\sigma^{-2} I_{m}$。\n\n1. 从高斯误差下的费雪信息矩阵 (FIM) 的定义出发，推导一个由于敏感度矩阵列之间的共线性而导致参数线性组合局部不可辨识的充要条件。你的推导必须用敏感度矩阵 $S$ 的秩和零空间以及 FIM 的正定性来表示。\n\n2. 现在考虑一个具体设置，其中有 $m=4$ 个输出和 $p=3$ 个参数，敏感度矩阵如下：\n$$\nS \\;=\\;\n\\begin{pmatrix}\n1  0  0 \\\\\n0  2  1 \\\\\n1  0  0 \\\\\n0  2  1\n\\end{pmatrix}.\n$$\n假设对于某个 $\\sigma^{2} > 0$，$W = \\sigma^{-2} I_{4}$。识别一个局部不可辨识的非平凡参数线性组合和一个局部可辨识的组合。构造一个线性重参数化 $\\boldsymbol{\\phi} = R \\boldsymbol{\\theta}$，其中 $R \\in \\mathbb{R}^{3 \\times 3}$ 具有整数项且行满秩，使得 $\\boldsymbol{\\phi}$ 的前两个分量张成可辨识方向，而第三个分量完全位于参数空间的不可辨识子空间中。明确地将重参数化的参数矢量 $\\boldsymbol{\\phi}$ 表示为 $\\theta_{1}$、$\\theta_{2}$ 和 $\\theta_{3}$ 的函数。你的最终答案必须是写成行矩阵形式的 $\\boldsymbol{\\phi}$ 的闭式解析表达式。不需要进行数值舍入。最终答案不带单位。",
            "solution": "该问题是有效的，因为它在参数估计理论方面有科学依据，问题设定良好，目标明确，且没有矛盾或含糊之处。\n\n此问题分为两部分。第一部分要求对局部不可辨识性的条件进行理论推导。第二部分将此理论应用于一个具体示例。\n\n**第一部分：局部不可辨识性的条件**\n\n模型参数的小扰动 $\\Delta \\boldsymbol{\\theta} \\in \\mathbb{R}^{p}$ 与模型输出的小扰动 $\\Delta \\boldsymbol{y} \\in \\mathbb{R}^{m}$ 之间的关系由以下线性模型给出：\n$$ \\Delta \\boldsymbol{y} = S \\, \\Delta \\boldsymbol{\\theta} $$\n其中 $S \\in \\mathbb{R}^{m \\times p}$ 是敏感度矩阵。假设观测误差是独立同分布的高斯分布，其方差为 $\\sigma^{2}$。相应的误差协方差矩阵为 $C_e = \\sigma^{2} I_{m}$。权重矩阵是误差协方差矩阵的逆，即 $W = C_e^{-1} = \\sigma^{-2} I_{m}$。\n\n费雪信息矩阵 (FIM)，记作 $\\mathcal{I}$，量化了可观测数据 $\\boldsymbol{y}$ 携带的关于未知参数 $\\boldsymbol{\\theta}$ 的信息量。对于带有加性高斯噪声的线性模型，FIM 由以下表达式给出：\n$$ \\mathcal{I} = S^{\\top} W S $$\n代入给定的权重矩阵 $W = \\sigma^{-2} I_{m}$：\n$$ \\mathcal{I} = S^{\\top} (\\sigma^{-2} I_{m}) S = \\sigma^{-2} S^{\\top} S $$\n由于 $\\sigma^{2} > 0$，常数 $\\sigma^{-2}$ 是一个正标量，除了缩放之外，不影响 FIM 的正（半）定性。\n\n参数矢量 $\\boldsymbol{\\theta}$ 的局部可辨识性要求 FIM $\\mathcal{I}$ 是可逆的，这意味着它必须是严格正定的。如果 $\\mathcal{I}$ 是奇异的（即仅为半正定），则参数是局部不可辨识的。这种奇异性意味着在参数空间中存在非零方向，沿这些方向模型输出不发生变化，从而无法区分沿这些方向的不同参数值。\n\n对于一个非零向量 $c \\in \\mathbb{R}^{p}$，由 $c^{\\top} \\boldsymbol{\\theta}$ 给出的特定参数线性组合是局部不可辨识的，如果其估计量的方差为无穷大。根据 Cramér-Rao 下界，当向量 $c$ 位于 FIM 的零空间中时，会发生这种情况。因此，组合 $c^{\\top} \\boldsymbol{\\theta}$ 不可辨识的条件是：\n$$ \\mathcal{I} c = 0 $$\n对于一个非零向量 $c$。代入 $\\mathcal{I}$ 的表达式：\n$$ (\\sigma^{-2} S^{\\top} S) c = 0 $$\n$$ S^{\\top} S c = 0 $$\n此方程表明 FIM $\\mathcal{I}$ 的零空间与矩阵 $S^{\\top} S$ 的零空间相同。\n\n现在，我们建立 $S^{\\top} S$ 的零空间与 $S$ 的零空间之间的关系。设 $c \\in \\text{Null}(S)$。这意味着 $S c = 0$。由此得出 $S^{\\top} S c = S^{\\top}(0) = 0$，所以 $c \\in \\text{Null}(S^{\\top} S)$。反之，设 $c \\in \\text{Null}(S^{\\top} S)$，所以 $S^{\\top} S c = 0$。用 $c^{\\top}$ 左乘得到 $c^{\\top} S^{\\top} S c = 0$。这可以重写为 $(Sc)^{\\top}(Sc) = \\|Sc\\|_{2}^{2} = 0$。一个向量的欧几里得范数的平方为零，当且仅当该向量本身是零向量。因此，$Sc=0$，这意味着 $c \\in \\text{Null}(S)$。所以，零空间是相同的：$\\text{Null}(S^{\\top} S) = \\text{Null}(S)$。\n\n这导出了一个充要条件：线性组合 $c^{\\top} \\boldsymbol{\\theta}$ 是局部不可辨识的，当且仅当向量 $c$ 是敏感度矩阵 $S$ 零空间中的一个非零向量，即 $Sc = 0$。这样一个非零向量 $c$ 的存在等价于 $S$ 的列是线性相关的（共线），这又意味着 $S$ 的秩小于参数数量 $p$，即 $\\text{rank}(S) < p$。参数空间中的不可辨识方向正是由 $S$ 的零空间的基向量所张成的方向。\n\n**第二部分：具体应用**\n\n我们得到一个具有 $m=4$ 个输出和 $p=3$ 个参数的系统的敏感度矩阵：\n$$\nS =\n\\begin{pmatrix}\n1  0  0 \\\\\n0  2  1 \\\\\n1  0  0 \\\\\n0  2  1\n\\end{pmatrix}\n$$\n设 $S$ 的列为 $s_{1}, s_{2}, s_{3}$。我们检查这些列的线性相关性：\n$s_{1} = (1, 0, 1, 0)^{\\top}$，$s_{2} = (0, 2, 0, 2)^{\\top}$，$s_{3} = (0, 1, 0, 1)^{\\top}$。\n通过观察，我们发现 $s_{2} = 2 s_{3}$。这意味着存在线性相关性：\n$$ 0 \\cdot s_{1} + 1 \\cdot s_{2} - 2 \\cdot s_{3} = 0 $$\n这是一个形如 $S c = 0$ 的方程，其中 $c = (0, 1, -2)^{\\top}$。由于 $S$ 的零空间中存在一个非零向量 $c$，因此 $S$ 的秩小于 $3$。具体来说，由于 $s_{1}$ 和 $s_{3}$ 是线性无关的，所以 $S$ 的秩为 $2$。$S$ 的零空间是一个由向量 $c = (0, 1, -2)^{\\top}$ 张成的一维子空间。\n\n一个局部不可辨识的非平凡参数线性组合对应于这个向量 $c$。该组合是 $c^{\\top} \\boldsymbol{\\theta}$：\n$$ 0 \\cdot \\theta_{1} + 1 \\cdot \\theta_{2} - 2 \\cdot \\theta_{3} = \\theta_{2} - 2\\theta_{3} $$\n这个组合是局部不可辨识的。\n\n如果向量 $d$ 不在 $S$ 的零空间中，则线性组合 $d^{\\top} \\boldsymbol{\\theta}$ 是局部可辨识的。一个简单的选择是 $d = (1, 0, 0)^{\\top}$，它显然不是 $(0, 1, -2)^{\\top}$ 的标量倍。相应的可辨识组合是 $d^{\\top} \\boldsymbol{\\theta} = \\theta_{1}$。\n\n接下来，我们构造重参数化 $\\boldsymbol{\\phi} = R \\boldsymbol{\\theta}$。矩阵 $R$ 必须具有整数项且满秩。新参数 $\\phi_{1}, \\phi_{2}, \\phi_{3}$ 由 $R$ 的行定义。\n第三个分量 $\\phi_{3}$ 必须完全位于不可辨识子空间中。这意味着它在 $R$ 中对应的行向量，我们称之为 $r_{3}^{\\top}$，必须是 $S$ 的零空间的基向量。我们可以选择 $r_{3}^{\\top} = (0, 1, -2)$。这得到 $\\phi_{3} = \\theta_{2} - 2\\theta_{3}$。\n\n前两个分量 $\\phi_{1}$ 和 $\\phi_{2}$ 必须张成可辨识方向。可辨识子空间是 $S$ 零空间的正交补。这是满足 $v \\cdot (0, 1, -2)^{\\top} = 0$ 的向量 $v$ 的集合。行向量 $r_{1}^{\\top}$ 和 $r_{2}^{\\top}$ 必须是满足此条件的线性无关向量。我们要求它们具有整数项。\n\n设 $r_{1}^{\\top} = (a, b, c)$。条件是 $b - 2c = 0$。一个简单的选择是 $r_{1}^{\\top} = (1, 0, 0)$，它满足 $0 - 2(0) = 0$。这得到 $\\phi_{1} = \\theta_{1}$。\n\n对于 $r_{2}^{\\top} = (d, e, f)$，我们需要 $e - 2f = 0$ 且 $r_{2}^{\\top}$ 与 $r_{1}^{\\top}$ 线性无关。一个简单的选择是设 $f=1$，这意味着 $e=2$，并且我们可以取 $d=0$。所以，$r_{2}^{\\top} = (0, 2, 1)$。这得到 $\\phi_{2} = 2\\theta_{2} + \\theta_{3}$。\n\n现在我们组装矩阵 $R$：\n$$\nR = \\begin{pmatrix}\n1  0  0 \\\\\n0  2  1 \\\\\n0  1  -2\n\\end{pmatrix}\n$$\n这些项都是整数。我们通过计算其行列式来检查 $R$ 是否满秩：$\\det(R) = 1(2(-2) - 1(1)) - 0 + 0 = -5 \\neq 0$。因此，$R$ 是满秩的。\n\n重参数化的向量 $\\boldsymbol{\\phi} = (\\phi_{1}, \\phi_{2}, \\phi_{3})^{\\top}$ 由以下公式给出：\n$$ \\phi_{1} = \\theta_{1} $$\n$$ \\phi_{2} = 2\\theta_{2} + \\theta_{3} $$\n$$ \\phi_{3} = \\theta_{2} - 2\\theta_{3} $$\n此构造满足了问题的所有要求。最终答案是 $\\boldsymbol{\\phi}$ 作为行矩阵的表达式。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\theta_{1}  & 2\\theta_{2} + \\theta_{3}  & \\theta_{2} - 2\\theta_{3}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在诊断并构建了一个适定性良好的参数优化问题后，下一步是利用高效的算法来求解。Levenberg-Marquardt (LM) 算法是求解非线性最小二乘问题的核心方法之一，它巧妙地结合了梯度下降法的稳定性和高斯-牛顿法的快速收敛性。本练习将引导您从第一性原理出发，推导LM算法的参数更新公式 ()，从而深入理解其在模型调优中的工作机制。",
            "id": "4065506",
            "problem": "考虑在一个用于数值天气预报 (NWP) 和长期气候预测的全球气候模型中，调优一个不确定的次网格过程参数矢量 $\\boldsymbol{\\theta} \\in \\mathbb{R}^{p}$。设观测算子 $H(\\boldsymbol{\\theta}) \\in \\mathbb{R}^{m}$ 将参数映射到一组 $m$ 个诊断量（例如，区域平均降水量、大气层顶辐射和近地表温度），这些诊断量与受观测约束的目标 $\\mathbf{y} \\in \\mathbb{R}^{m}$ 进行比较。定义残差矢量 $r(\\boldsymbol{\\theta}) = H(\\boldsymbol{\\theta}) - \\mathbf{y}$ 和最小二乘目标 $\\Phi(\\boldsymbol{\\theta}) = \\frac{1}{2}\\|r(\\boldsymbol{\\theta})\\|^{2}$，其中 $\\|\\cdot\\|$ 表示欧几里得范数。在当前迭代点 $\\boldsymbol{\\theta}_{k}$，记 $r = r(\\boldsymbol{\\theta}_{k})$ 和雅可比矩阵 $J' = \\frac{\\partial r}{\\partial \\boldsymbol{\\theta}}\\big|_{\\boldsymbol{\\theta}_{k}} \\in \\mathbb{R}^{m \\times p}$。\n\n为了获得一个能平衡曲率信息与稳健性的稳定参数更新 $\\delta \\in \\mathbb{R}^{p}$，您决定使用 Levenberg-Marquardt (LM) 方法，也称为阻尼 Gauss-Newton 方法。该方法通过一个由阻尼系数 $\\lambda > 0$ 控制的各向同性正则化项来增广局部二次模型。\n\n从最小二乘最小化的基本定义和残差的一阶泰勒展开出发，推导阻尼局部模型的平稳性条件，并获得 LM 更新 $\\delta$ 关于 $J'$、$r$ 和 $\\lambda$ 的显式闭式表达式。您的推导应从围绕 $\\boldsymbol{\\theta}_{k}$ 的线性化残差开始，通过最小化目标函数的阻尼二次近似来进行。请以单个闭式解析表达式的形式给出 $\\delta$ 的最终答案。无需进行数值计算。如果引入任何其他符号，请明确定义它们。最终答案不带单位。",
            "solution": "问题 R-0391 要求推导一个非线性最小二乘优化问题的 Levenberg-Marquardt (LM) 参数更新步骤，特别是在气候模型参数调优的背景下。推导必须从基本定义开始，并逻辑地进行到最终表达式。\n\n首先，我们对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- 参数矢量：$\\boldsymbol{\\theta} \\in \\mathbb{R}^{p}$\n- 观测算子：$H(\\boldsymbol{\\theta}) \\in \\mathbb{R}^{m}$\n- 观测目标：$\\mathbf{y} \\in \\mathbb{R}^{m}$\n- 残差矢量：$r(\\boldsymbol{\\theta}) = H(\\boldsymbol{\\theta}) - \\mathbf{y}$\n- 最小二乘目标函数：$\\Phi(\\boldsymbol{\\theta}) = \\frac{1}{2}\\|r(\\boldsymbol{\\theta})\\|^{2}$，其中 $\\|\\cdot\\|$ 是欧几里得范数。\n- 当前参数迭代点：$\\boldsymbol{\\theta}_{k}$\n- 当前迭代点的残差：$r = r(\\boldsymbol{\\theta}_{k})$\n- 当前迭代点残差的雅可比矩阵：$J' = \\frac{\\partial r}{\\partial \\boldsymbol{\\theta}}\\big|_{\\boldsymbol{\\theta}_{k}} \\in \\mathbb{R}^{m \\times p}$\n- 参数更新步长：$\\delta \\in \\mathbb{R}^{p}$\n- 阻尼系数：$\\lambda > 0$\n- 方法：Levenberg-Marquardt (阻尼 Gauss-Newton)\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在科学和数学上都是合理的。它描述了数值优化中的一种标准且成熟的技术——Levenberg-Marquardt 算法。如问题所述，该方法广泛应用于许多科学和工程领域，包括数值天气预报和气候科学中使用的复杂模型的参数调优。问题是适定的、客观的、自洽的，提供了推导所需表达式的所有必要定义和变量。没有矛盾、歧义或事实错误。问题要求进行形式化的数学推导，这是应用数学和计算科学中的标准程序。\n\n### 步骤 3：结论与行动\n该问题是 **有效的**。将提供解答。\n\n### Levenberg-Marquardt 更新的推导\n目标是找到一个参数更新 $\\delta$ 来最小化目标函数 $\\Phi(\\boldsymbol{\\theta})$。我们旨在确定更新 $\\delta$，使得下一个迭代点 $\\boldsymbol{\\theta}_{k+1} = \\boldsymbol{\\theta}_{k} + \\delta$ 能减小 $\\Phi$ 的值。Levenberg-Marquardt 方法通过最小化目标函数的一个局部的、阻尼的二次模型来实现这一目标。\n\n目标函数为 $\\Phi(\\boldsymbol{\\theta}) = \\frac{1}{2} \\|r(\\boldsymbol{\\theta})\\|^{2}$。我们希望分析其在新点 $\\boldsymbol{\\theta}_{k} + \\delta$ 处的值。为此，我们首先使用一阶泰勒级数展开，构建残差矢量 $r(\\boldsymbol{\\theta})$ 在当前迭代点 $\\boldsymbol{\\theta}_{k}$ 周围的线性近似：\n$$\nr(\\boldsymbol{\\theta}_{k} + \\delta) \\approx r(\\boldsymbol{\\theta}_{k}) + \\left.\\frac{\\partial r}{\\partial \\boldsymbol{\\theta}}\\right|_{\\boldsymbol{\\theta}_{k}} \\delta\n$$\n使用问题陈述中提供的记号，$r = r(\\boldsymbol{\\theta}_{k})$ 和 $J' = \\frac{\\partial r}{\\partial \\boldsymbol{\\theta}}\\big|_{\\boldsymbol{\\theta}_{k}}$，这个近似变为：\n$$\nr(\\boldsymbol{\\theta}_{k} + \\delta) \\approx r + J' \\delta\n$$\n将这个残差的线性近似代入目标函数 $\\Phi$，得到一个局部二次模型，我们记为 $\\tilde{\\Phi}(\\delta)$：\n$$\n\\Phi(\\boldsymbol{\\theta}_{k} + \\delta) \\approx \\tilde{\\Phi}(\\delta) = \\frac{1}{2} \\|r + J' \\delta\\|^{2}\n$$\n纯 Gauss-Newton 方法旨在最小化 $\\tilde{\\Phi}(\\delta)$。然而，如果雅可比矩阵 $J'$ 是病态的或秩亏的，这种方法可能不稳定。Levenberg-Marquardt 方法引入一个阻尼（或正则化）项 $\\frac{1}{2}\\lambda\\|\\delta\\|^2$ 来稳定问题。该项惩罚大的更新步长，从而将新的迭代点 $\\boldsymbol{\\theta}_{k} + \\delta$ 保持在残差的线性近似更可能有效的区域内。\n\n因此，我们将阻尼目标函数定义为 $L(\\delta)$：\n$$\nL(\\delta) = \\frac{1}{2} \\|r + J' \\delta\\|^{2} + \\frac{1}{2} \\lambda \\|\\delta\\|^{2}\n$$\n其中 $\\lambda > 0$ 是阻尼系数。我们的目标是找到最小化 $L(\\delta)$ 的更新矢量 $\\delta$。为此，我们将范数用矢量转置的形式重写：\n$$\nL(\\delta) = \\frac{1}{2} (r + J' \\delta)^{T} (r + J' \\delta) + \\frac{1}{2} \\lambda \\delta^{T} \\delta\n$$\n展开第一项：\n$$\n(r + J' \\delta)^{T} (r + J' \\delta) = (r^{T} + \\delta^{T} (J')^{T}) (r + J' \\delta) = r^{T}r + r^{T}J'\\delta + \\delta^{T}(J')^{T}r + \\delta^{T}(J')^{T}J'\\delta\n$$\n由于 $r^{T}J'\\delta$ 是一个标量，它等于其自身的转置 $(\\delta^{T}(J')^{T}r)$。因此，$r^{T}J'\\delta + \\delta^{T}(J')^{T}r = 2r^{T}J'\\delta$。\n目标函数变为：\n$$\nL(\\delta) = \\frac{1}{2} (r^{T}r + 2 r^{T}J'\\delta + \\delta^{T}(J')^{T}J'\\delta) + \\frac{1}{2} \\lambda \\delta^{T} I \\delta\n$$\n其中 $I$ 是大小为 $p \\times p$ 的单位矩阵。\n\n为了找到 $L(\\delta)$ 的最小值，我们计算它关于 $\\delta$ 的梯度，并将其设为零矢量。\n$$\n\\nabla_{\\delta} L(\\delta) = \\frac{\\partial}{\\partial \\delta} \\left[ \\frac{1}{2} r^{T}r + r^{T}J'\\delta + \\frac{1}{2} \\delta^{T}(J')^{T}J'\\delta + \\frac{1}{2} \\lambda \\delta^{T} I \\delta \\right]\n$$\n使用标准的矩阵微积分恒等式，特别是对于对称矩阵 $A$，有 $\\nabla_x (a^T x) = a$ 和 $\\nabla_x (\\frac{1}{2} x^T A x) = Ax$：\n- 项 $\\frac{1}{2} r^{T}r$ 关于 $\\delta$ 是常数，所以其梯度为 $\\mathbf{0}$。\n- $r^{T}J'\\delta$ 的梯度是 $(r^{T}J')^{T} = (J')^{T}r$。\n- 矩阵 $(J')^{T}J'$ 是对称的，所以 $\\frac{1}{2} \\delta^{T}(J')^{T}J'\\delta$ 的梯度是 $(J')^{T}J'\\delta$。\n- 矩阵 $\\lambda I$ 是对称的，所以 $\\frac{1}{2} \\lambda \\delta^{T} I \\delta$ 的梯度是 $\\lambda I \\delta$。\n\n综合这些结果，$L(\\delta)$ 的梯度是：\n$$\n\\nabla_{\\delta} L(\\delta) = (J')^{T}r + (J')^{T}J'\\delta + \\lambda I \\delta\n$$\n通过将梯度设为零矢量 $\\nabla_{\\delta} L(\\delta) = \\mathbf{0}$，可找到平稳性条件：\n$$\n(J')^{T}J'\\delta + \\lambda I \\delta = -(J')^{T}r\n$$\n在左侧提取因子 $\\delta$ 得到：\n$$\n((J')^{T}J' + \\lambda I) \\delta = -(J')^{T}r\n$$\n这是一个关于更新矢量 $\\delta$ 的线性方程组。矩阵 $(J')^{T}J'$ 是 Gauss-Newton 方法中的“近似 Hessian 矩阵”；它是对称半正定的。由于 $\\lambda > 0$，矩阵 $(J')^{T}J' + \\lambda I$ 是对称正定的，这保证了其可逆性。因此，我们可以通过用该矩阵的逆矩阵左乘等式两边来求解 $\\delta$：\n$$\n\\delta = - ((J')^{T}J' + \\lambda I)^{-1} (J')^{T}r\n$$\n这个表达式给出了 Levenberg-Marquardt 更新步长 $\\delta$ 关于雅可比矩阵 $J'$、残差矢量 $r$ 和阻尼参数 $\\lambda$ 的闭式解析解。",
            "answer": "$$\n\\boxed{-((J')^{T} J' + \\lambda I)^{-1} (J')^{T} r}\n$$"
        }
    ]
}