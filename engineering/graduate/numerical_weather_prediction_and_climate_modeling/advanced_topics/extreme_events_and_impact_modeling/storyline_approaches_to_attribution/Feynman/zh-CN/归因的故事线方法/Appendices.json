{
    "hands_on_practices": [
        {
            "introduction": "故事线方法的核心思想之一是通过假定动力学条件不变来分离和量化热力学因素的影响。本练习将通过一个理想化的思想实验，带你深入理解这一基本原则。我们将运用克劳修斯-克拉佩龙（Clausius-Clapeyron）关系式，推导在背景变暖条件下，一个固定天气系统所能产生的极端降水强度的分数增加，这是一个在许多归因研究中至关重要的基础性计算。",
            "id": "4095507",
            "problem": "考虑一个数值天气预报和气候模型中的故事情节归因框架：一个观测到的极端降水事件的条件是，其天气尺度动力学在更暖的气候状态下保持不变，只有热力学变量对变暖做出响应。假设以下基于物理学的基础。\n\n- 在准稳态极端事件中，整层水汽收支表明降水强度与整层凝结汇成正比，在近饱和上升运动下，这可以近似为与一个固定的运动-动力场和饱和比湿的乘积成正比。具体来说，设降水强度表示为 $P \\propto \\int_{p_{\\mathrm{top}}}^{p_{\\mathrm{sfc}}} F(p)\\, q_{s}(T(p))\\, dp$，其中 $F(p)$ 是一个包含垂直运动和微物理效率的平稳函数，在故事情节假设下保持不变（辐合和降水效率不变），$q_{s}$ 是饱和比湿，$T(p)$ 是温度，$p_{\\mathrm{top}}$ 是气柱顶部的气压，$p_{\\mathrm{sfc}}$ 是地表气压。\n- 在气柱均匀增温 $\\Delta T$（一种为分离热力学效应而采用的标准理想化方法）的情况下，$T(p)$ 变为 $T(p)+\\Delta T$，饱和比湿根据克劳修斯-克拉佩龙（Clausius–Clapeyron）标度律响应，局部表示为微分关系 $\\frac{dq_{s}}{dT}=\\gamma\\, q_{s}$，其中 $\\gamma$ 在相关温度范围内是一个正常数。\n\n从这些基本陈述和克劳修斯-克拉佩龙微分关系出发，推导在故事情节增温 $\\Delta T$ 且 $F(p)$ 不变的条件下，极端降水强度分数增加的闭合形式解析表达式，然后对 $\\gamma=0.07\\,\\mathrm{K}^{-1}$ 和 $\\Delta T=3\\,\\mathrm{K}$ 进行数值计算。将最终的分数增加表示为一个小数，四舍五入到四位有效数字。答案中不要使用百分号。",
            "solution": "用户提交了一个待验证和求解的问题。\n\n### 第1步：提取已知条件\n- **框架**：数值天气预报和气候模型中的故事情节归因。\n- **条件**：天气尺度动力学固定；只有热力学变量对变暖响应。\n- **降水强度模型**：$P \\propto \\int_{p_{\\mathrm{top}}}^{p_{\\mathrm{sfc}}} F(p)\\, q_{s}(T(p))\\, dp$。\n- **$F(p)$**：一个平稳函数（固定的垂直运动和微物理效率）。\n- **$q_{s}(T(p))$**：作为温度廓线 $T(p)$ 函数的饱和比湿。\n- **$p_{\\mathrm{sfc}}$, $p_{\\mathrm{top}}$**：地表和气柱顶部的气压。\n- **扰动**：大气柱均匀增温 $\\Delta T$。\n- **温度变化**：初始温度廓线 $T(p)$ 变为 $T(p)+\\Delta T$。\n- **克劳修斯-克拉佩龙关系**：饱和比湿对温度的响应由微分方程 $\\frac{dq_{s}}{dT}=\\gamma\\, q_{s}$ 给出。\n- **常数**：$\\gamma$ 在相关温度范围内是一个正常数。\n- **任务1**：推导极端降水强度分数增加的闭合形式解析表达式。\n- **任务2**：对数值 $\\gamma=0.07\\,\\mathrm{K}^{-1}$ 和 $\\Delta T=3\\,\\mathrm{K}$ 计算该表达式的值。\n- **任务3**：将最终结果表示为一个四舍五入到四位有效数字的小数。\n\n### 第2步：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n\n- **科学性**：该问题植根于大气热力学的基本原理（克劳修斯-克拉佩龙关系）和气候科学中公认的方法论（故事情节归因）。降水模型虽然简化，但具有物理动机。该问题在科学上是合理的。\n- **适定性**：该问题提供了一个清晰的数学模型、一个明确的扰动以及一个待推导的特定量。它提供了计算分数变化所需的所有信息，这使得未知的比例常数和 $F(p)$ 的具体形式与最终的比率无关。存在一个唯一的、有意义的解。\n- **客观性**：该问题以精确、定量和无偏见的科学语言陈述。\n\n该问题没有指定的缺陷（例如，科学上不合理、不完整、模糊不清）。均匀增温的理想化是此类分析中用于分离特定物理效应的标准技术。\n\n### 第3步：结论与行动\n问题有效。可以开始求解过程。\n\n### 求解推导\n目标是推导降水的分数增加，其定义为 $\\frac{P_{1} - P_0}{P_0}$，其中 $P_0$ 是初始降水强度，$P_1$ 是增温 $\\Delta T$ 后的降水强度。\n\n设降水模型中的比例常数为 $k$。对应于初始温度廓线 $T_0(p)$ 的初始降水强度 $P_0$ 为：\n$$P_0 = k \\int_{p_{\\mathrm{top}}}^{p_{\\mathrm{sfc}}} F(p)\\, q_{s}(T_0(p))\\, dp$$\n\n在均匀增温 $\\Delta T$ 后，新的温度廓线为 $T_1(p) = T_0(p) + \\Delta T$。新的降水强度 $P_1$ 为：\n$$P_1 = k \\int_{p_{\\mathrm{top}}}^{p_{\\mathrm{sfc}}} F(p)\\, q_{s}(T_1(p))\\, dp = k \\int_{p_{\\mathrm{top}}}^{p_{\\mathrm{sfc}}} F(p)\\, q_{s}(T_0(p) + \\Delta T)\\, dp$$\n故事情节假设要求 $F(p)$ 和积分限保持不变。\n\n为了继续，我们必须从给定的微分关系 $\\frac{dq_{s}}{dT}=\\gamma\\, q_{s}$ 中找出 $q_s(T)$ 的函数形式。这是一个可分离的一阶线性常微分方程。\n$$\\frac{1}{q_{s}} dq_{s} = \\gamma dT$$\n两边积分得：\n$$\\int \\frac{1}{q_{s}} dq_{s} = \\int \\gamma dT$$\n$$\\ln(q_{s}) = \\gamma T + C$$\n其中 $C$ 是积分常数。求解 $q_{s}(T)$ 得：\n$$q_{s}(T) = \\exp(\\gamma T + C) = A \\exp(\\gamma T)$$\n其中 $A = \\exp(C)$ 是一个常数。\n\n现在，我们将增温状态下的饱和比湿 $q_s(T_1(p))$ 与初始状态下的饱和比湿 $q_s(T_0(p))$ 联系起来。\n$$q_{s}(T_1(p)) = q_{s}(T_0(p) + \\Delta T) = A \\exp(\\gamma (T_0(p) + \\Delta T))$$\n$$q_{s}(T_1(p)) = A \\exp(\\gamma T_0(p)) \\exp(\\gamma \\Delta T)$$\n认识到 $A \\exp(\\gamma T_0(p)) = q_{s}(T_0(p))$，我们得到关系式：\n$$q_{s}(T_1(p)) = q_{s}(T_0(p)) \\exp(\\gamma \\Delta T)$$\n这表明，对于均匀增温 $\\Delta T$，每个气压层 $p$ 的饱和比湿都增加了一个恒定的乘法因子 $\\exp(\\gamma \\Delta T)$。\n\n将此结果代回 $P_1$ 的表达式中：\n$$P_1 = k \\int_{p_{\\mathrm{top}}}^{p_{\\mathrm{sfc}}} F(p)\\, \\left( q_{s}(T_0(p)) \\exp(\\gamma \\Delta T) \\right) dp$$\n由于 $\\exp(\\gamma \\Delta T)$ 对于积分变量 $p$ 是一个常数，因此可以将其从积分中提出：\n$$P_1 = \\exp(\\gamma \\Delta T) \\left( k \\int_{p_{\\mathrm{top}}}^{p_{\\mathrm{sfc}}} F(p)\\, q_{s}(T_0(p))\\, dp \\right)$$\n括号中的项正是初始降水强度 $P_0$。因此：\n$$P_1 = P_0 \\exp(\\gamma \\Delta T)$$\n\n然后计算降水的分数增加：\n$$\\text{Fractional Increase} = \\frac{P_1 - P_0}{P_0} = \\frac{P_0 \\exp(\\gamma \\Delta T) - P_0}{P_0}$$\n$$\\text{Fractional Increase} = \\frac{P_0 \\left( \\exp(\\gamma \\Delta T) - 1 \\right)}{P_0}$$\n这简化为最终的解析表达式：\n$$\\text{Fractional Increase} = \\exp(\\gamma \\Delta T) - 1$$\n\n现在，我们用给定的数值计算该表达式的值：$\\gamma = 0.07\\,\\mathrm{K}^{-1}$ 和 $\\Delta T = 3\\,\\mathrm{K}$。\n指数中的乘积是一个无量纲量，符合要求：\n$$\\gamma \\Delta T = (0.07\\,\\mathrm{K}^{-1}) \\times (3\\,\\mathrm{K}) = 0.21$$\n将此值代入我们推导的表达式中：\n$$\\text{Fractional Increase} = \\exp(0.21) - 1$$\n计算数值：\n$$\\exp(0.21) \\approx 1.23367809$$\n$$\\exp(0.21) - 1 \\approx 0.23367809$$\n题目要求四舍五入到四位有效数字。前四位有效数字是 $2$、$3$、$3$、$6$。第五位数字是 $7$，所以我们将第四位数字向上取整。\n$$\\text{Fractional Increase} \\approx 0.2337$$",
            "answer": "$$\\boxed{0.2337}$$"
        },
        {
            "introduction": "在量化了气候变暖带来的物理变化之后，归因研究必须明确定义何为“极端事件”，而这个定义并非无关紧要。本练习探讨了在一个非平稳的气候背景下，采用绝对阈值（例如，温度超过 $40\\,^{\\circ}\\mathrm{C}$）与采用相对百分位阈值（例如，历史气候中的第95个百分位事件）对归因结果的深远影响。通过这个练习，你将学会如何辨析不同研究框架如何塑造归因结论，这对于解读和交流归因研究结果至关重要。",
            "id": "4095509",
            "problem": "在一个以大尺度环流保持不变为条件的故事情节框架下，一个区域性夏季日最高气温过程被建模为一个高斯随机变量，其均值因人为变暖而随时间变化。具体来说，设时间指数为 $t$ 时的日最高气温 $T(t)$ 服从分布 $T(t) \\sim \\mathcal{N}(\\mu(t), \\sigma^{2})$，其中 $\\mu(t) = \\mu_{0} + \\gamma t$，且 $\\sigma$ 为常数。假设 $t = 0$ 为基准时代，其参数为 $\\mu_{0} = 30\\,^{\\circ}\\mathrm{C}$ 和 $\\sigma = 3\\,^{\\circ}\\mathrm{C}$；$t = 1$ 为现今时代，其参数为 $\\mu_{1} = 32\\,^{\\circ}\\mathrm{C}$ (因此 $\\gamma = 2\\,^{\\circ}\\mathrm{C}$ 每单位时间)。在非平稳气候学背景下，考虑两种与归因故事情节相关的事件定义：\n\n1) 绝对阈值极端事件：$E_{\\mathrm{abs}}$ 定义为 $T(t) \\ge \\tau_{\\mathrm{abs}}$，其中 $\\tau_{\\mathrm{abs}} = 40\\,^{\\circ}\\mathrm{C}$。\n\n2) 锚定于基准时代的百分位数阈值极端事件：$E_{p}$ 定义为 $T(t) \\ge \\tau_{p}$，其中 $\\tau_{p}$ 是 $T(0)$ 的 $95\\%$ 分位数。\n\n对于每种事件定义，时间 $t$ 的基础发生率是超越概率 $p(t) = \\mathbb{P}[T(t) \\ge \\tau]$，其中 $\\tau$ 是定义中的阈值。使用连续分布分位数的基木定义、高斯分布的累积分布函数以及超越概率的概念，计算 $E_{\\mathrm{abs}}$ 和 $E_{p}$ 的基础发生率 $p_{0}$ 和 $p_{1}$。然后，基于这些基础发生率，选择一个选项，该选项能正确描述在一个固定环流但改变热力学背景的故事情节中，（锚定于基准的）百分位数阈值和绝对阈值之间的选择如何改变基础发生率以及对人为影响的解释。\n\nA) 对于锚定于基准的百分位数阈值事件，$p_{0} = 0.05$ 且 $p_{1} \\approx 0.163$ (增加了约 $3.3$ 倍)，而对于绝对阈值事件，$p_{0} \\approx 4.3 \\times 10^{-4}$ 且 $p_{1} \\approx 3.8 \\times 10^{-3}$ (增加了约 $8.8$ 倍)。因此，百分位数阈值凸显了在基准时代罕见的事件如何变得更加普遍，而绝对阈值则凸显了固定物理极端事件的出现和强烈的相对放大效应；这些不同的基础发生率变化导致了对人为影响的不同故事情节解释。\n\nB) 百分位数阈值事件有 $p_{0} = 0.05$ 和 $p_{1} = 0.05$，因为百分位数总是在时间上保持稀有性，而绝对阈值事件仅增加了约 $3$ 倍；因此，对于固定阈值，人为影响可以忽略不计，但会被基于百分位数的定义所抵消。\n\nC) 对于锚定于基准的百分位数阈值事件，$p_{0} = 0.05$ 但 $p_{1} > 0.05$ 因为方差未变，而对于绝对阈值事件，$p_{0} \\approx 0.01$ 且 $p_{1} \\approx 0.02$；因此，阈值的选择对故事情节解释的影响微乎其微。\n\nD) 绝对阈值事件有 $p_{0} = p_{1}$，因为固定阈值在位置平移下保持基础发生率不变，而锚定于基准的百分位数阈值事件有 $p_{0} = 0.05$ 且 $p_{1} \\approx 0.05$；因此，在非平稳性下，阈值的选择不会改变归因故事情节。",
            "solution": "问题陈述已经过验证，被认为是有效的。它具有科学依据，提法恰当，客观且内部一致。解决该问题所需的所有数据均已提供。\n\n问题要求我们计算并比较在非平稳气候模型下两种极端事件的基础发生率（概率）的变化，并评估其对归因故事情节的影响。时间 $t$ 的温度 $T(t)$ 被建模为一个高斯随机变量 $T(t) \\sim \\mathcal{N}(\\mu(t), \\sigma^2)$，其均值随时间线性增加，$\\mu(t) = \\mu_0 + \\gamma t$。\n\n给定的参数是：\n-   基准气候 ($t=0$): 均值 $\\mu_0 = 30\\,^{\\circ}\\mathrm{C}$，标准差 $\\sigma = 3\\,^{\\circ}\\mathrm{C}$。因此，$T(0) \\sim \\mathcal{N}(30, 3^2)$。\n-   现今气候 ($t=1$): 均值 $\\mu_1 = 32\\,^{\\circ}\\mathrm{C}$。因此，$T(1) \\sim \\mathcal{N}(32, 3^2)$。\n-   变暖速率为 $\\gamma = \\mu_1 - \\mu_0 = 2\\,^{\\circ}\\mathrm{C}$ 每单位时间。\n-   标准正态随机变量表示为 $Z \\sim \\mathcal{N}(0, 1)$，其累积分布函数 (CDF) 为 $\\Phi(z) = \\mathbb{P}[Z \\le z]$。超越概率为 $1 - \\Phi(z)$。\n\n我们将分别分析每种事件定义。\n\n### 1. 百分位数阈值事件 ($E_p$)\n\n该事件定义为 $T(t) \\ge \\tau_p$，其中阈值 $\\tau_p$ 是基准温度分布 $T(0)$ 的 $95\\%$ 分位数。\n\n**基准时代的基础发生率 ($t=0$):**\n基础发生率为 $p_0(E_p) = \\mathbb{P}[T(0) \\ge \\tau_p]$。根据 $\\tau_p$ 作为 $95\\%$ 分位数的定义，我们有 $\\mathbb{P}[T(0)  \\tau_p] = 0.95$。对于连续分布，这意味着 $\\mathbb{P}[T(0) \\ge \\tau_p] = 1 - 0.95 = 0.05$。\n所以，基准概率恰好是：\n$$p_0(E_p) = 0.05$$\n\n**现今时代的基础发生率 ($t=1$):**\n首先，我们必须找到阈值 $\\tau_p$ 的数值。我们对随机变量 $T(0)$ 进行标准化：\n$$ \\mathbb{P}[T(0) \\le \\tau_p] = \\mathbb{P}\\left[ \\frac{T(0) - \\mu_0}{\\sigma} \\le \\frac{\\tau_p - \\mu_0}{\\sigma} \\right] = 0.95 $$\n$$ \\Phi\\left( \\frac{\\tau_p - 30}{3} \\right) = 0.95 $$\n$\\Phi$ 的参数必须是标准正态分布的 $95\\%$ 分位数，$z_{0.95}$。从标准表格或计算器可知，$z_{0.95} \\approx 1.645$。\n$$ \\frac{\\tau_p - 30}{3} = z_{0.95} \\approx 1.645 $$\n$$ \\tau_p \\approx 30 + 3 \\times 1.645 = 30 + 4.935 = 34.935\\,^{\\circ}\\mathrm{C} $$\n现在我们计算在现今气候中超过这个固定阈值的概率，其中 $T(1) \\sim \\mathcal{N}(32, 3^2)$：\n$$ p_1(E_p) = \\mathbb{P}[T(1) \\ge \\tau_p] = \\mathbb{P}[T(1) \\ge 34.935] $$\n使用现今时代的参数进行标准化：\n$$ p_1(E_p) = \\mathbb{P}\\left[ \\frac{T(1) - \\mu_1}{\\sigma} \\ge \\frac{34.935 - 32}{3} \\right] = \\mathbb{P}\\left[ Z \\ge \\frac{2.935}{3} \\right] \\approx \\mathbb{P}[Z \\ge 0.9783] $$\n$$ p_1(E_p) = 1 - \\Phi(0.9783) \\approx 1 - 0.8361 = 0.1639 $$\n所以，$p_1(E_p) \\approx 0.164$。增加的倍数是 $\\frac{p_1(E_p)}{p_0(E_p)} \\approx \\frac{0.1639}{0.05} \\approx 3.28$。\n\n### 2. 绝对阈值事件 ($E_{\\mathrm{abs}}$)\n\n该事件定义为 $T(t) \\ge \\tau_{\\mathrm{abs}}$，其中固定物理阈值为 $\\tau_{\\mathrm{abs}} = 40\\,^{\\circ}\\mathrm{C}$。\n\n**基准时代的基础发生率 ($t=0$):**\n基础发生率为 $p_0(E_{\\mathrm{abs}}) = \\mathbb{P}[T(0) \\ge 40]$。我们使用基准参数进行标准化：\n$$ p_0(E_{\\mathrm{abs}}) = \\mathbb{P}\\left[ \\frac{T(0) - 30}{3} \\ge \\frac{40 - 30}{3} \\right] = \\mathbb{P}\\left[ Z \\ge \\frac{10}{3} \\right] \\approx \\mathbb{P}[Z \\ge 3.333] $$\n$$ p_0(E_{\\mathrm{abs}}) = 1 - \\Phi(3.333) \\approx 1 - 0.99957 = 0.00043 = 4.3 \\times 10^{-4} $$\n\n**现今时代的基础发生率 ($t=1$):**\n基础发生率为 $p_1(E_{\\mathrm{abs}}) = \\mathbb{P}[T(1) \\ge 40]$。我们使用现今时代的参数进行标准化：\n$$ p_1(E_{\\mathrm{abs}}) = \\mathbb{P}\\left[ \\frac{T(1) - 32}{3} \\ge \\frac{40 - 32}{3} \\right] = \\mathbb{P}\\left[ Z \\ge \\frac{8}{3} \\right] \\approx \\mathbb{P}[Z \\ge 2.667] $$\n$$ p_1(E_{\\mathrm{abs}}) = 1 - \\Phi(2.667) \\approx 1 - 0.99617 = 0.00383 = 3.83 \\times 10^{-3} $$\n增加的倍数是 $\\frac{p_1(E_{\\mathrm{abs}})}{p_0(E_{\\mathrm{abs}})} \\approx \\frac{3.83 \\times 10^{-3}}{4.3 \\times 10^{-4}} \\approx 8.91$。\n\n### 总结与选项评估\n\n-   对于 $E_p$：$p_0 = 0.05$ 且 $p_1 \\approx 0.164$。比率 $\\approx 3.3$。\n-   对于 $E_{\\mathrm{abs}}$：$p_0 \\approx 4.3 \\times 10^{-4}$ 且 $p_1 \\approx 3.8 \\times 10^{-3}$。比率 $\\approx 8.9$。\n\n现在我们评估每个选项：\n\n**A) 对于锚定于基准的百分位数阈值事件，$p_{0} = 0.05$ 且 $p_{1} \\approx 0.163$ (增加了约 $3.3$ 倍)，而对于绝对阈值事件，$p_{0} \\approx 4.3 \\times 10^{-4}$ 且 $p_{1} \\approx 3.8 \\times 10^{-3}$ (增加了约 $8.8$ 倍)。因此，百分位数阈值凸显了在基准时代罕见的事件如何变得更加普遍，而绝对阈值则凸显了固定物理极端事件的出现和强烈的相对放大效应；这些不同的基础发生率变化导致了对人为影响的不同故事情节解释。**\n\n-   数值与我们的计算结果一致（$0.163$ 与 $0.164$，$8.8$ 与 $8.9$ 是微小的四舍五入差异）。所有其他数字都精确匹配。\n-   解释是正确的。百分位数事件显示，以前 20 次中发生 1 次的事件变成了 6 次中发生 1 次的事件（更常见），而绝对事件显示，一个物理上极端且非常罕见的事件（2300 次中发生 1 次）变得更有可能发生（260 次中发生 1 次），代表了巨大的*相对*放大。这两种视角（“过去罕见的现在更常见” vs. “过去几乎不可能的现在成为可能”）确实是归因中不同但互补的故事情节。\n-   结论：**正确**。\n\n**B) 百分位数阈值事件有 $p_{0} = 0.05$ 和 $p_{1} = 0.05$，因为百分位数总是在时间上保持稀有性，而绝对阈值事件仅增加了约 $3$ 倍；因此，对于固定阈值，人为影响可以忽略不计，但会被基于百分位数的定义所抵消。**\n\n-   声称 $p_1 = 0.05$ 是不正确的。我们的计算显示 $p_1 \\approx 0.164$。其推理存在缺陷；阈值是锚定于基准的，而不是为现今重新计算的。\n-   声称绝对阈值事件增加了约 $3$ 倍是不正确的。我们的计算显示增加了约 $8.9$ 倍。\n-   结论：**不正确**。\n\n**C) 对于锚定于基准的百分位数阈值事件，$p_{0} = 0.05$ 但 $p_{1} > 0.05$ 因为方差未变，而对于绝对阈值事件，$p_{0} \\approx 0.01$ 且 $p_{1} \\approx 0.02$；因此，阈值的选择对故事情节解释的影响微乎其微。**\n\n-   声称 $p_1 > 0.05$ 是正确的，但后面的数值是错误的。\n-   对于绝对事件，$p_0 \\approx 0.01$ 和 $p_1 \\approx 0.02$ 的值是不正确的。我们的计算得出 $p_0 \\approx 4.3 \\times 10^{-4}$ 和 $p_1 \\approx 3.8 \\times 10^{-3}$。\n-   结论：**不正确**。\n\n**D) 绝对阈值事件有 $p_{0} = p_{1}$，因为固定阈值在位置平移下保持基础发生率不变，而锚定于基准的百分位数阈值事件有 $p_{0} = 0.05$ 且 $p_{1} \\approx 0.05$；因此，在非平稳性下，阈值的选择不会改变归因故事情节。**\n\n-   对于绝对事件，声称 $p_0 = p_1$ 是不正确的。在保持阈值固定的同时移动分布的位置（均值），会明确地改变超越概率。\n-   对于百分位数事件，声称 $p_1 \\approx 0.05$ 是不正确的。我们的计算显示变化是显著的，从 $0.05$ 变为约 $0.164$。\n-   结论：**不正确**。\n\n基于详细的推导，只有选项A同时提供了正确的计算和正确的科学解释。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "真实的归因研究是一个综合性工程，需要整合来自不同模型和观测的数据，并对结果的不确定性进行严格量化。本练习作为一个顶石项目，旨在模拟一个完整的故事线归因分析流程。你将综合运用前面练习中的概念，构建一个包含动力学、热力学、多模式集合、数据同化以及不确定性传播的端到端计算框架，最终得出一个带有置信区间的量化归因声明，从而获得对前沿归因科学方法的宝贵实践经验。",
            "id": "4095527",
            "problem": "考虑一个区域性极端降水事件，该事件在数值天气预报和气候模拟中使用情景叙事法（storyline approach）进行归因分析。该情景叙事法旨在以一个固定的大尺度环流异常为条件，构建一个移除了人为增温的反事实气候状态，结合来自模型层次结构的信息，并纳入数据同化（DA）效应，同时遵循基于物理的收支平衡，并与观测数据进行验证。您的任务是将此情景叙事法形式化为一组数学计算，并为几个测试案例生成最终的附带不确定性的归因声明。\n\n使用以下基本基础：\n\n- 整层积分水汽收支表明 $P - E = C$，其中 $P$ 是降水率，$E$ 是地表蒸发率，$C$ 是整层水汽辐合（均为时间和空间的函数）。对于一个在持续时间内和固定区域内积分的极端事件，在准静止条件下，将累积降水量 $R$ 近似为 $R \\approx R_{\\mathrm{dyn}} + R_{\\mathrm{evap}}$，其中 $R_{\\mathrm{dyn}}$ 是事件期间积分的水汽辐合贡献，$R_{\\mathrm{evap}}$ 是蒸发贡献。\n- 在以环流为条件（固定动力学情景）下，热力学变化占主导地位。天气尺度上的比湿 $q$ 通过克劳修斯-克拉佩龙关系与温度相关联，近似呈指数尺度关系。为方便计算，使用线性化尺度关系 $s(\\Delta T) = 1 + \\gamma \\Delta T$，其中 $\\Delta T$ 是相对于基准的近地表气温变化，$\\gamma$ 是一个有效的敏感性参数（单位：每开尔文）。这表示在固定动力学型式下，水汽可利用性的热力学放大效应。\n- 数据同化通过一个因子减小了估计的动力学振幅（此处建模为 $D$）的不确定性。设先验方差为 $\\sigma_{D0}^2$；数据同化后，方差为 $\\sigma_D^2 = r_{\\mathrm{DA}} \\sigma_{D0}^2$，其中 $0  r_{\\mathrm{DA}}  1$。分析增量 $\\delta_{\\mathrm{DA}}$ 调整均值：$D_{\\mathrm{adj}} = D + \\delta_{\\mathrm{DA}}$。\n- 模型层次结构提供了 $N$ 个模型，其敏感性参数为 $\\gamma_i$，相关方差为 $\\sigma_{\\gamma_i}^2$，并与权重 $w_i$（满足 $\\sum_i w_i = 1$ 和 $w_i \\ge 0$）相结合。加权平均敏感性为 $\\bar{\\gamma} = \\sum_{i=1}^N w_i \\gamma_i$，其方差为 $\\sigma_{\\bar{\\gamma}}^2 = \\sum_{i=1}^N w_i^2 \\sigma_{\\gamma_i}^2 + \\sigma_{\\mathrm{struct}}^2$，其中 $\\sigma_{\\mathrm{struct}}^2$ 用于解释结构模型不确定性。\n- 将动力学贡献表示为 $R_{\\mathrm{dyn}} = k \\, D_{\\mathrm{adj}} \\, s(\\Delta T)$，其中 $k$ 是一个正常数，用于将动力学振幅和热力学尺度关系映射到事件区域的累积降水量。将蒸发贡献表示为 $R_{\\mathrm{evap}} = E_0 \\left(1 + \\zeta \\, \\Delta T \\right)$，其中 $E_0$ 是事件持续时间内的基准累积蒸发量，$\\zeta$ 是一个小的敏感性参数（单位：每开尔文）。\n- 事实状态使用温度变化 $\\Delta T_{\\mathrm{f}}$，其不确定性为 $\\sigma_{T_{\\mathrm{f}}}^2$；反事实状态使用 $\\Delta T_{\\mathrm{c}}$，其不确定性为 $\\sigma_{T_{\\mathrm{c}}}^2$（在反事实中移除了人为增温）。除非另有说明，否则假设下述所有不确定性分量相互独立。\n\n为每个测试案例计算：\n\n1. 事实累积降雨量 $R_{\\mathrm{f}}$ 和反事实累积降雨量 $R_{\\mathrm{c}}$，单位为毫米（$\\mathrm{mm}$）：\n$$\nR_{\\mathrm{f}} = k \\, D_{\\mathrm{adj}} \\, s(\\Delta T_{\\mathrm{f}}) + E_0 \\left(1 + \\zeta \\, \\Delta T_{\\mathrm{f}}\\right), \\quad\nR_{\\mathrm{c}} = k \\, D_{\\mathrm{adj}} \\, s(\\Delta T_{\\mathrm{c}}) + E_0 \\left(1 + \\zeta \\, \\Delta T_{\\mathrm{c}}\\right).\n$$\n使用加权平均值 $\\bar{\\gamma}$ 计算 $s(\\cdot)$。\n\n2. 通过一阶不确定性传播（delta方法）计算方差 $\\mathrm{Var}(R_{\\mathrm{f}})$ 和 $\\mathrm{Var}(R_{\\mathrm{c}})$。对于 $s(\\Delta T) = 1 + \\bar{\\gamma} \\Delta T$，$s$ 的方差为：\n$$\n\\mathrm{Var}\\!\\left(s(\\Delta T)\\right) = \\Delta T^2 \\, \\sigma_{\\bar{\\gamma}}^2 + \\bar{\\gamma}^2 \\, \\sigma_T^2.\n$$\n对于事实状态，令 $\\sigma_T^2$ 为 $\\sigma_{T_{\\mathrm{f}}}^2$；对于反事实状态，令其为 $\\sigma_{T_{\\mathrm{c}}}^2$。$R_{\\mathrm{evap}}$ 的方差为：\n$$\n\\mathrm{Var}(R_{\\mathrm{evap}}) = \\left(1 + \\zeta \\, \\Delta T\\right)^2 \\, \\sigma_{E_0}^2 + \\left(\\zeta \\, E_0\\right)^2 \\, \\sigma_T^2.\n$$\n假设 $D_{\\mathrm{adj}}$、$s(\\Delta T)$ 和 $R_{\\mathrm{evap}}$ 之间相互独立，$R_{\\mathrm{f}}$ 和 $R_{\\mathrm{c}}$ 的方差为：\n$$\n\\mathrm{Var}(R) = k^2 \\, \\mathrm{Var}(D_{\\mathrm{adj}}) \\, s(\\Delta T)^2 + \\left(k \\, D_{\\mathrm{adj}}\\right)^2 \\, \\mathrm{Var}\\!\\left(s(\\Delta T)\\right) + \\mathrm{Var}(R_{\\mathrm{evap}}),\n$$\n其中 $\\mathrm{Var}(D_{\\mathrm{adj}}) = \\sigma_D^2 = r_{\\mathrm{DA}} \\sigma_{D0}^2$。\n\n3. 归因分数（可归因于人为增温的事件强度分数），定义为事实强度中人为贡献的分数：\n$$\n\\mathrm{AF} = \\frac{R_{\\mathrm{f}} - R_{\\mathrm{c}}}{R_{\\mathrm{f}}} = 1 - \\frac{R_{\\mathrm{c}}}{R_{\\mathrm{f}}}.\n$$\n通过一阶传播计算其不确定性，假设 $R_{\\mathrm{f}}$ 和 $R_{\\mathrm{c}}$ 之间存在相关性。令 $\\rho$ 为相关系数，且 $\\mathrm{Cov}(R_{\\mathrm{f}}, R_{\\mathrm{c}}) = \\rho \\sqrt{\\mathrm{Var}(R_{\\mathrm{f}})\\mathrm{Var}(R_{\\mathrm{c}})}$。使用 $g(R_{\\mathrm{f}}, R_{\\mathrm{c}}) = 1 - R_{\\mathrm{c}}/R_{\\mathrm{f}}$，其梯度为：\n$$\n\\frac{\\partial g}{\\partial R_{\\mathrm{f}}} = \\frac{R_{\\mathrm{c}}}{R_{\\mathrm{f}}^2}, \\qquad\n\\frac{\\partial g}{\\partial R_{\\mathrm{c}}} = -\\frac{1}{R_{\\mathrm{f}}}.\n$$\n则\n$$\n\\mathrm{Var}(\\mathrm{AF}) = \\left(\\frac{R_{\\mathrm{c}}}{R_{\\mathrm{f}}^2}\\right)^2 \\mathrm{Var}(R_{\\mathrm{f}}) + \\left(\\frac{1}{R_{\\mathrm{f}}}\\right)^2 \\mathrm{Var}(R_{\\mathrm{c}}) - 2 \\left(\\frac{R_{\\mathrm{c}}}{R_{\\mathrm{f}}^2}\\right)\\left(\\frac{1}{R_{\\mathrm{f}}}\\right)\\mathrm{Cov}(R_{\\mathrm{f}}, R_{\\mathrm{c}}).\n$$\n使用正态近似报告一个 $90\\%$ 的中心区间：$\\mathrm{AF}_{\\mathrm{low}} = \\max(0, \\mathrm{AF} - 1.645 \\, \\sigma_{\\mathrm{AF}})$，$\\mathrm{AF}_{\\mathrm{high}} = \\min(1, \\mathrm{AF} + 1.645 \\, \\sigma_{\\mathrm{AF}})$，其中 $\\sigma_{\\mathrm{AF}} = \\sqrt{\\mathrm{Var}(\\mathrm{AF})}$。\n\n4. 事实降雨收支的动力学分数，定义为：\n$$\nf_{\\mathrm{dyn}} = \\frac{R_{\\mathrm{dyn,f}}}{R_{\\mathrm{f}}} = \\frac{k \\, D_{\\mathrm{adj}} \\, s(\\Delta T_{\\mathrm{f}})}{R_{\\mathrm{f}}}.\n$$\n\n5. 与观测的验证：设 $R_{\\mathrm{obs}}$ 为观测到的累积降雨量，其观测不确定性为 $\\sigma_{\\mathrm{obs}}$，验证容差为 $\\tau$。如果 $|R_{\\mathrm{f}} - R_{\\mathrm{obs}}| \\le \\tau$，则声明该情景叙事法得到验证。\n\n所有涉及物理单位的答案必须以指定单位表示。具体来说：\n- 以毫米（$\\mathrm{mm}$）为单位报告 $R_{\\mathrm{f}}$ 和 $R_{\\mathrm{c}}$，四舍五入到一位小数。\n- 将 $\\mathrm{AF}$、$\\mathrm{AF}_{\\mathrm{low}}$、$\\mathrm{AF}_{\\mathrm{high}}$ 和 $f_{\\mathrm{dyn}}$ 报告为小数（不带百分号），四舍五入到三位小数。\n- 将验证结果报告为布尔值。\n\n测试套件参数值：\n\n- 测试案例1（理想路径）：\n  - $D = 8.0$, $\\delta_{\\mathrm{DA}} = 0.5$, $\\sigma_{D0} = 1.5$, $r_{\\mathrm{DA}} = 0.5$。\n  - $\\Delta T_{\\mathrm{f}} = 2.0$, $\\sigma_{T_{\\mathrm{f}}} = 0.2$; $\\Delta T_{\\mathrm{c}} = 0.6$, $\\sigma_{T_{\\mathrm{c}}} = 0.1$。\n  - $E_0 = 10.0$, $\\sigma_{E_0} = 1.0$, $\\zeta = 0.02$。\n  - 模型层次结构：$\\gamma_1 = 0.065$, $\\sigma_{\\gamma_1} = 0.002$; $\\gamma_2 = 0.070$, $\\sigma_{\\gamma_2} = 0.003$; $\\gamma_3 = 0.080$, $\\sigma_{\\gamma_3} = 0.0025$; 权重 $w_1 = 0.3$, $w_2 = 0.4$, $w_3 = 0.3$; $\\sigma_{\\mathrm{struct}} = 0.005$。\n  - $k = 12.0$。\n  - $R_{\\mathrm{obs}} = 220.0$, $\\sigma_{\\mathrm{obs}} = 10.0$, $\\tau = 25.0$。\n  - $\\rho = 0.8$。\n\n- 测试案例2（人为信号可忽略的边界情况）：\n  - $D = 5.0$, $\\delta_{\\mathrm{DA}} = 0.0$, $\\sigma_{D0} = 1.0$, $r_{\\mathrm{DA}} = 0.6$。\n  - $\\Delta T_{\\mathrm{f}} = 0.5$, $\\sigma_{T_{\\mathrm{f}}} = 0.1$; $\\Delta T_{\\mathrm{c}} = 0.5$, $\\sigma_{T_{\\mathrm{c}}} = 0.1$。\n  - $E_0 = 6.0$, $\\sigma_{E_0} = 0.6$, $\\zeta = 0.02$。\n  - 模型层次结构：$\\gamma_1 = 0.060$, $\\sigma_{\\gamma_1} = 0.002$; $\\gamma_2 = 0.070$, $\\sigma_{\\gamma_2} = 0.003$; $\\gamma_3 = 0.085$, $\\sigma_{\\gamma_3} = 0.004$; 权重 $w_1 = 0.25$, $w_2 = 0.5, w_3 = 0.25$; $\\sigma_{\\mathrm{struct}} = 0.004$。\n  - $k = 11.0$。\n  - $R_{\\mathrm{obs}} = 110.0$, $\\sigma_{\\mathrm{obs}} = 8.0$, $\\tau = 20.0$。\n  - $\\rho = 0.85$。\n\n- 测试案例3（强动力学边缘情况）：\n  - $D = 12.0$, $\\delta_{\\mathrm{DA}} = -0.3$, $\\sigma_{D0} = 2.0$, $r_{\\mathrm{DA}} = 0.4$。\n  - $\\Delta T_{\\mathrm{f}} = 1.2$, $\\sigma_{T_{\\mathrm{f}}} = 0.15$; $\\Delta T_{\\mathrm{c}} = 0.2$, $\\sigma_{T_{\\mathrm{c}}} = 0.1$。\n  - $E_0 = 8.0$, $\\sigma_{E_0} = 0.8$, $\\zeta = 0.015$。\n  - 模型层次结构：$\\gamma_1 = 0.070$, $\\sigma_{\\gamma_1} = 0.003$; $\\gamma_2 = 0.075$, $\\sigma_{\\gamma_2} = 0.002$; $\\gamma_3 = 0.090$, $\\sigma_{\\gamma_3} = 0.004$; 权重 $w_1 = 0.2$, $w_2 = 0.5, w_3 = 0.3$; $\\sigma_{\\mathrm{struct}} = 0.006$。\n  - $k = 13.0$。\n  - $R_{\\mathrm{obs}} = 260.0$, $\\sigma_{\\mathrm{obs}} = 12.0$, $\\tau = 30.0$。\n  - $\\rho = 0.9$。\n\n您的程序必须为每个测试案例计算元组 $[R_{\\mathrm{f}}, R_{\\mathrm{c}}, \\mathrm{AF}, \\mathrm{AF}_{\\mathrm{low}}, \\mathrm{AF}_{\\mathrm{high}}, f_{\\mathrm{dyn}}, \\mathrm{verified}]$，其中 $R_{\\mathrm{f}}$ 和 $R_{\\mathrm{c}}$ 的单位是 $\\mathrm{mm}$（四舍五入到一位小数），$\\mathrm{AF}$、$\\mathrm{AF}_{\\mathrm{low}}$、$\\mathrm{AF}_{\\mathrm{high}}$ 和 $f_{\\mathrm{dyn}}$ 是小数（四舍五入到三位小数），$\\mathrm{verified}$ 是布尔值。\n\n最终输出格式：您的程序应生成单行输出，包含一个以逗号分隔的列表，用方括号括起来，其中每个元素本身是对应测试案例的Python风格列表（例如：$[[\\cdots],[\\cdots],[\\cdots]]$）。",
            "solution": "该问题陈述已经过验证，被认为是合理的。它在科学上基于气候模拟和归因的原理，问题设定良好，提供了所有必要的数据和方程，并且其表述是客观的。任务是将一个简化的情景叙事归因方法形式化为一系列计算，并将其应用于三个不同的测试案例。\n\n解决方案首先从模型层次结构和数据同化（DA）信息中定义必要的中间参数。然后，它计算事实和反事实的降雨量，传播指定的不确定性以找到这些估计的方差，计算归因分数及其置信区间，确定动力学对总降雨量的贡献，最后将模型的实际估计与合成观测值进行验证。\n\n首先，我们计算与模型和观测无关的参数。调整后的动力学振幅 $D_{\\mathrm{adj}}$ 是由数据同化分析增量 $\\delta_{\\mathrm{DA}}$ 校正的先验估计 $D$：\n$$\nD_{\\mathrm{adj}} = D + \\delta_{\\mathrm{DA}}\n$$\n该调整后振幅的方差由因子 $r_{\\mathrm{DA}}$ 从先验方差 $\\sigma_{D0}^2$ 缩减而来：\n$$\n\\mathrm{Var}(D_{\\mathrm{adj}}) = \\sigma_D^2 = r_{\\mathrm{DA}} \\sigma_{D0}^2\n$$\n接下来，我们结合来自模型层次结构的信息。加权平均敏感性参数 $\\bar{\\gamma}$ 是根据各个模型的敏感性 $\\gamma_i$ 及其权重 $w_i$ 计算得出的：\n$$\n\\bar{\\gamma} = \\sum_{i=1}^N w_i \\gamma_i\n$$\n这个组合敏感性的方差 $\\sigma_{\\bar{\\gamma}}^2$ 包含了各个模型方差的加权和以及一个结构不确定性项 $\\sigma_{\\mathrm{struct}}^2$：\n$$\n\\sigma_{\\bar{\\gamma}}^2 = \\sum_{i=1}^N w_i^2 \\sigma_{\\gamma_i}^2 + \\sigma_{\\mathrm{struct}}^2\n$$\n\n有了这些参数，我们就可以计算事实（f）和反事实（c）情景下的主要量。热力学尺度因子 $s(\\Delta T)$ 是克劳修斯-克拉佩龙关系的线性化表示：\n$$\ns(\\Delta T) = 1 + \\bar{\\gamma} \\Delta T\n$$\n总累积降雨量 $R$ 是动力学贡献 $R_{\\mathrm{dyn}}$ 和蒸发贡献 $R_{\\mathrm{evap}}$ 的总和。\n$$\nR_{\\mathrm{f}} = k \\, D_{\\mathrm{adj}} \\, s(\\Delta T_{\\mathrm{f}}) + E_0 \\left(1 + \\zeta \\, \\Delta T_{\\mathrm{f}}\\right)\n$$\n$$\nR_{\\mathrm{c}} = k \\, D_{\\mathrm{adj}} \\, s(\\Delta T_{\\mathrm{c}}) + E_0 \\left(1 + \\zeta \\, \\Delta T_{\\mathrm{c}}\\right)\n$$\n\n为了量化这些降雨量估计的不确定性，我们使用指定的一阶不确定性传播（delta方法）。热力学尺度项的方差 $\\mathrm{Var}(s(\\Delta T))$ 取决于温度和敏感性参数的不确定性：\n$$\n\\mathrm{Var}(s(\\Delta T)) = (\\Delta T)^2 \\sigma_{\\bar{\\gamma}}^2 + \\bar{\\gamma}^2 \\sigma_T^2\n$$\n蒸发贡献的方差 $\\mathrm{Var}(R_{\\mathrm{evap}})$ 取决于基准蒸发量 $E_0$ 和温度的不确定性：\n$$\n\\mathrm{Var}(R_{\\mathrm{evap}}) = (1 + \\zeta \\Delta T)^2 \\sigma_{E_0}^2 + (\\zeta E_0)^2 \\sigma_T^2\n$$\n假设动力学振幅、热力学尺度和蒸发的不确定性相互独立，降雨量的总方差 $\\mathrm{Var}(R)$ 结合了这些来源的不确定性：\n$$\n\\mathrm{Var}(R) = k^2 \\, \\mathrm{Var}(D_{\\mathrm{adj}}) \\, (s(\\Delta T))^2 + (k D_{\\mathrm{adj}})^2 \\mathrm{Var}(s(\\Delta T)) + \\mathrm{Var}(R_{\\mathrm{evap}})\n$$\n此公式分别应用于事实状态（使用 $\\Delta T_{\\mathrm{f}}$, $\\sigma_{T_{\\mathrm{f}}}$）和反事实状态（使用 $\\Delta T_{\\mathrm{c}}$, $\\sigma_{T_{\\mathrm{c}}}$）。\n\n可归因于人为增温的事件强度分数 $\\mathrm{AF}$ 定义为：\n$$\n\\mathrm{AF} = \\frac{R_{\\mathrm{f}} - R_{\\mathrm{c}}}{R_{\\mathrm{f}}} = 1 - \\frac{R_{\\mathrm{c}}}{R_{\\mathrm{f}}}\n$$\n$\\mathrm{AF}$ 的不确定性计算考虑了 $R_{\\mathrm{f}}$ 和 $R_{\\mathrm{c}}$ 之间的相关性 $\\rho$，这种相关性源于它们共享的不确定性来源（例如 $D_{\\mathrm{adj}}$, $\\bar{\\gamma}$, $E_0$）。方差由下式给出：\n$$\n\\mathrm{Var}(\\mathrm{AF}) = \\left(\\frac{R_{\\mathrm{c}}}{R_{\\mathrm{f}}^2}\\right)^2 \\mathrm{Var}(R_{\\mathrm{f}}) + \\left(\\frac{1}{R_{\\mathrm{f}}}\\right)^2 \\mathrm{Var}(R_{\\mathrm{c}}) - 2 \\left(\\frac{R_{\\mathrm{c}}}{R_{\\mathrm{f}}^3}\\right)\\rho \\sqrt{\\mathrm{Var}(R_{\\mathrm{f}})\\mathrm{Var}(R_{\\mathrm{c}})}\n$$\n根据标准差 $\\sigma_{\\mathrm{AF}} = \\sqrt{\\mathrm{Var}(\\mathrm{AF})}$，使用正态近似构建一个 $90\\%$ 的置信区间，并以 $0$ 和 $1$ 作为信息价值边界：\n$$\n\\mathrm{AF}_{\\mathrm{low}} = \\max(0, \\mathrm{AF} - 1.645 \\sigma_{\\mathrm{AF}})\n$$\n$$\n\\mathrm{AF}_{\\mathrm{high}} = \\min(1, \\mathrm{AF} + 1.645 \\sigma_{\\mathrm{AF}})\n$$\n\n事实降雨的动力学分数 $f_{\\mathrm{dyn}}$ 量化了事件水收支中水汽辐合与局地蒸发的相对重要性：\n$$\nf_{\\mathrm{dyn}} = \\frac{R_{\\mathrm{dyn,f}}}{R_{\\mathrm{f}}} = \\frac{k \\, D_{\\mathrm{adj}} \\, s(\\Delta T_{\\mathrm{f}})}{R_{\\mathrm{f}}}\n$$\n\n最后，通过将模拟的事实降雨量 $R_{\\mathrm{f}}$ 与观测降雨量 $R_{\\mathrm{obs}}$ 在给定的容差 $\\tau$ 内进行比较来验证情景叙事：\n$$\n\\mathrm{verified} = |R_{\\mathrm{f}} - R_{\\mathrm{obs}}| \\le \\tau\n$$\n结果为 `False` 表示在指定的故事情节约束和参数下，模型未能充分再现观测到的事件强度。这是归因研究中一个有效且至关重要的结果。\n\n以下程序将为每个提供的测试案例实现这一完整的计算序列。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to orchestrate the calculation for all test cases and print the final result.\n    \"\"\"\n    \n    # Test cases defined as dictionaries for clarity.\n    test_cases = [\n        { # Test Case 1 (happy path)\n            \"D\": 8.0, \"delta_DA\": 0.5, \"sigma_D0\": 1.5, \"r_DA\": 0.5,\n            \"delta_T_f\": 2.0, \"sigma_T_f\": 0.2, \"delta_T_c\": 0.6, \"sigma_T_c\": 0.1,\n            \"E0\": 10.0, \"sigma_E0\": 1.0, \"zeta\": 0.02,\n            \"gammas\": np.array([0.065, 0.070, 0.080]),\n            \"sigma_gammas\": np.array([0.002, 0.003, 0.0025]),\n            \"weights\": np.array([0.3, 0.4, 0.3]),\n            \"sigma_struct\": 0.005,\n            \"k\": 12.0,\n            \"R_obs\": 220.0, \"sigma_obs\": 10.0, \"tau\": 25.0,\n            \"rho\": 0.8\n        },\n        { # Test Case 2 (boundary case with negligible anthropogenic signal)\n            \"D\": 5.0, \"delta_DA\": 0.0, \"sigma_D0\": 1.0, \"r_DA\": 0.6,\n            \"delta_T_f\": 0.5, \"sigma_T_f\": 0.1, \"delta_T_c\": 0.5, \"sigma_T_c\": 0.1,\n            \"E0\": 6.0, \"sigma_E0\": 0.6, \"zeta\": 0.02,\n            \"gammas\": np.array([0.060, 0.070, 0.085]),\n            \"sigma_gammas\": np.array([0.002, 0.003, 0.004]),\n            \"weights\": np.array([0.25, 0.5, 0.25]),\n            \"sigma_struct\": 0.004,\n            \"k\": 11.0,\n            \"R_obs\": 110.0, \"sigma_obs\": 8.0, \"tau\": 20.0,\n            \"rho\": 0.85\n        },\n        { # Test Case 3 (edge case with strong dynamics)\n            \"D\": 12.0, \"delta_DA\": -0.3, \"sigma_D0\": 2.0, \"r_DA\": 0.4,\n            \"delta_T_f\": 1.2, \"sigma_T_f\": 0.15, \"delta_T_c\": 0.2, \"sigma_T_c\": 0.1,\n            \"E0\": 8.0, \"sigma_E0\": 0.8, \"zeta\": 0.015,\n            \"gammas\": np.array([0.070, 0.075, 0.090]),\n            \"sigma_gammas\": np.array([0.003, 0.002, 0.004]),\n            \"weights\": np.array([0.2, 0.5, 0.3]),\n            \"sigma_struct\": 0.006,\n            \"k\": 13.0,\n            \"R_obs\": 260.0, \"sigma_obs\": 12.0, \"tau\": 30.0,\n            \"rho\": 0.9\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        results.append(calculate_case(case))\n    \n    # Format the final output string as a list of lists.\n    # Each inner list contains floats rounded to spec and one boolean.\n    output_str = \"[\"\n    for i, res_tuple in enumerate(results):\n        r_f, r_c, af, af_low, af_high, f_dyn, verified = res_tuple\n        output_str += f\"[{r_f:.1f},{r_c:.1f},{af:.3f},{af_low:.3f},{af_high:.3f},{f_dyn:.3f},{'True' if verified else 'False'}]\"\n        if i  len(results) - 1:\n            output_str += \",\"\n    output_str += \"]\"\n\n    print(output_str)\n\ndef calculate_case(params: dict) -> tuple:\n    \"\"\"\n    Performs the full calculation for a single test case.\n    \"\"\"\n    # Step 1: Calculate intermediate parameters\n    D_adj = params[\"D\"] + params[\"delta_DA\"]\n    var_D_adj = params[\"r_DA\"] * params[\"sigma_D0\"]**2\n    \n    gamma_bar = np.sum(params[\"weights\"] * params[\"gammas\"])\n    var_gamma_bar = np.sum(params[\"weights\"]**2 * params[\"sigma_gammas\"]**2) + params[\"sigma_struct\"]**2\n    \n    # Thermodynamic scaling functions and their variances\n    def s(delta_T):\n        return 1 + gamma_bar * delta_T\n    \n    def var_s(delta_T, sigma_T):\n        return delta_T**2 * var_gamma_bar + gamma_bar**2 * sigma_T**2\n        \n    s_f = s(params[\"delta_T_f\"])\n    s_c = s(params[\"delta_T_c\"])\n    \n    var_s_f = var_s(params[\"delta_T_f\"], params[\"sigma_T_f\"])\n    var_s_c = var_s(params[\"delta_T_c\"], params[\"sigma_T_c\"])\n\n    # Step 2: Calculate factual and counterfactual rainfall\n    R_dyn_f = params[\"k\"] * D_adj * s_f\n    R_evap_f = params[\"E0\"] * (1 + params[\"zeta\"] * params[\"delta_T_f\"])\n    R_f = R_dyn_f + R_evap_f\n\n    R_dyn_c = params[\"k\"] * D_adj * s_c\n    R_evap_c = params[\"E0\"] * (1 + params[\"zeta\"] * params[\"delta_T_c\"])\n    R_c = R_dyn_c + R_evap_c\n\n    # Step 3: Calculate variances of rainfall\n    def var_R_evap(delta_T, sigma_T):\n        term1 = (1 + params[\"zeta\"] * delta_T)**2 * params[\"sigma_E0\"]**2\n        term2 = (params[\"zeta\"] * params[\"E0\"])**2 * sigma_T**2\n        return term1 + term2\n\n    var_R_evap_f = var_R_evap(params[\"delta_T_f\"], params[\"sigma_T_f\"])\n    var_R_evap_c = var_R_evap(params[\"delta_T_c\"], params[\"sigma_T_c\"])\n\n    def var_R(s_val, var_s_val, var_R_evap_val):\n        term1 = params[\"k\"]**2 * var_D_adj * s_val**2\n        term2 = (params[\"k\"] * D_adj)**2 * var_s_val\n        term3 = var_R_evap_val\n        return term1 + term2 + term3\n\n    var_R_f = var_R(s_f, var_s_f, var_R_evap_f)\n    var_R_c = var_R(s_c, var_s_c, var_R_evap_c)\n\n    # Step 4: Calculate attribution fraction (AF) and its uncertainty\n    if R_f == 0:  # Avoid division by zero\n        af = 0 if R_c == 0 else np.nan\n        var_af, af_low, af_high = np.nan, np.nan, np.nan\n    else:\n        af = 1 - (R_c / R_f)\n        \n        # Derivatives for error propagation\n        d_g_d_Rf = R_c / R_f**2\n        d_g_d_Rc = -1 / R_f\n        \n        cov_Rf_Rc = params[\"rho\"] * np.sqrt(var_R_f * var_R_c)\n        \n        var_af = (d_g_d_Rf**2 * var_R_f) + \\\n                 (d_g_d_Rc**2 * var_R_c) + \\\n                 2 * d_g_d_Rf * d_g_d_Rc * cov_Rf_Rc\n        \n        sigma_af = np.sqrt(var_af)\n        z_90 = 1.645 # For a 90% central interval\n        \n        af_low = max(0.0, af - z_90 * sigma_af)\n        af_high = min(1.0, af + z_90 * sigma_af)\n\n    # Step 5: Calculate dynamic fraction\n    f_dyn = R_dyn_f / R_f if R_f != 0 else np.nan\n\n    # Step 6: Perform verification\n    verified = abs(R_f - params[\"R_obs\"]) = params[\"tau\"]\n\n    return R_f, R_c, af, af_low, af_high, f_dyn, verified\n\nsolve()\n```"
        }
    ]
}