{
    "hands_on_practices": [
        {
            "introduction": "构建地球系统的数字孪生，我们首先面临一个基本问题：它到底有多大？这项练习将引导你通过第一性原理，计算全球大气状态单个快照的存储需求。理解这个数据量级是规划和配置所需计算基础设施（如内存和磁盘空间）的第一步，它将抽象的网格分辨率与具体的硬件需求直接联系起来 。",
            "id": "4031476",
            "problem": "一个研究小组正在为一个用于数值天气预报和气候模拟的地球系统全球数字孪生配置存储空间。该孪生系统在一个规则的经纬度网格上表示大气状态，其经度和纬度的水平分辨率均为 $0.25^{\\circ}$，并包含 $70$ 个垂直层次。状态向量由水平风分量 $u$ 和 $v$、绝对温度 $T$ 和比湿 $q$ 组成，所有这些都以双精度浮点数的形式存储。假设如下：\n\n- 经度在 $[0^{\\circ},360^{\\circ})$ 区间上以 $\\Delta \\lambda = 0.25^{\\circ}$ 的均匀间距进行离散化，因此经度点数为 $N_{\\lambda} = 360^{\\circ}/0.25^{\\circ}$。\n- 纬度在闭区间 $[-90^{\\circ},+90^{\\circ}]$ 上以 $\\Delta \\phi = 0.25^{\\circ}$ 的均匀间距进行离散化，且包括两极，因此纬度点数为 $N_{\\phi} = 180^{\\circ}/0.25^{\\circ} + 1$。\n- 在每个垂直层次上，所有四个预报变量 $\\{u,v,T,q\\}$ 都存储在相同的网格上（无交错网格）。\n- 每个标量值以双精度存储，每个值占用 $8$ 字节。\n- 忽略任何元数据、坐标数组、文件头或压缩。\n\n从空间离散化和存储计算的基本原理出发，推导公式并计算：\n1) 存储所有四个三维场的单个分析（单个时间点）的总内存占用；以及\n2) 归档一整天每小时分析所需的总存储空间。\n\n使用十进制定义 $1\\,\\mathrm{TB} = 10^{12}\\,\\mathrm{bytes}$，将两个所求量均以太字节（TB）为单位表示。将两个结果都四舍五入到四位有效数字。以 TB 为单位提供这两个数字作为最终答案。",
            "solution": "问题陈述具有科学依据、提法明确、客观且自洽。它提出了一个计算科学领域的标准计算问题，特别是在数值天气预报和气候模拟方面。所有必要的数据和定义都已提供，并且没有内部矛盾或违反科学原理的地方。因此，该问题被认为是有效的，并将推导其解法。\n\n任务是计算地球系统数字孪生的数据存储需求。我们将首先推导单个时间快照（一次分析）的内存占用公式，然后使用该结果来计算指定归档周期的总存储量。\n\n让我们定义问题中提供的参数：\n- 经度方向的水平分辨率：$\\Delta \\lambda = 0.25^{\\circ}$\n- 纬度方向的水平分辨率：$\\Delta \\phi = 0.25^{\\circ}$\n- 垂直层次数量：$N_z = 70$\n- 预报变量数量：$N_{vars} = 4$（即 $u,v,T,q$）\n- 每个标量值的存储大小（双精度）：$B = 8$ 字节\n\n首先，我们确定每个空间维度上的网格点数量。\n\n经度在区间 $[0^{\\circ}, 360^{\\circ})$ 上被离散化。经度点数 $N_{\\lambda}$ 由总范围除以网格间距得出：\n$$N_{\\lambda} = \\frac{360^{\\circ}}{\\Delta \\lambda} = \\frac{360}{0.25} = 1440$$\n\n纬度在闭区间 $[-90^{\\circ}, +90^{\\circ}]$ 上被离散化，总跨度为 $180^{\\circ}$。由于包含了南北两极，纬度点数 $N_{\\phi}$ 是区间数加一：\n$$N_{\\phi} = \\frac{180^{\\circ}}{\\Delta \\phi} + 1 = \\frac{180}{0.25} + 1 = 720 + 1 = 721$$\n\n单个三维场中的网格点总数是各维度点数的乘积：\n$$N_{grid} = N_{\\lambda} \\times N_{\\phi} \\times N_z$$\n代入数值：\n$$N_{grid} = 1440 \\times 721 \\times 70 = 72,676,800$$\n\n单次分析包含 $N_{vars}=4$ 个这样的三维场。因此，一次分析时间需要存储的标量值总数为：\n$$N_{scalars} = N_{grid} \\times N_{vars} = 72,676,800 \\times 4 = 290,707,200$$\n\n每个标量值都作为双精度数存储，需要 $B=8$ 字节。\n\n1) 单次分析的总内存占用 $S_1$ 是标量总数乘以每个标量的字节数：\n$$S_1 = N_{scalars} \\times B = 290,707,200 \\times 8 = 2,325,657,600\\,\\mathrm{bytes}$$\n\n问题要求使用定义 $1\\,\\mathrm{TB} = 10^{12}\\,\\mathrm{bytes}$ 将此量以太字节（TB）表示。\n$$S_1 (\\mathrm{TB}) = \\frac{2,325,657,600}{10^{12}} = 0.0023256576\\,\\mathrm{TB}$$\n四舍五入到四位有效数字，我们得到：\n$$S_1 \\approx 0.002326\\,\\mathrm{TB}$$\n\n2) 第二个任务是计算归档一整天每小时分析所需的总存储空间。一整天有 $24$ 小时。存储每小时的分析意味着我们每个小时存储一次分析，每天总共进行 $N_{times} = 24$ 次分析。\n\n归档的总存储量 $S_{day}$ 是单次分析的存储量乘以分析次数：\n$$S_{day} = S_1 \\times N_{times}$$\n为保证精度，使用 $S_1$ 的未舍入值：\n$$S_{day} = 2,325,657,600\\,\\mathrm{bytes} \\times 24 = 55,815,782,400\\,\\mathrm{bytes}$$\n\n将其转换为太字节：\n$$S_{day} (\\mathrm{TB}) = \\frac{55,815,782,400}{10^{12}} = 0.0558157824\\,\\mathrm{TB}$$\n四舍五入到四位有效数字，我们得到：\n$$S_{day} \\approx 0.05582\\,\\mathrm{TB}$$\n\n两个所求量现已根据问题的要求计算完毕。单次分析的内存约为 $0.002326\\,\\mathrm{TB}$（或 $2.326\\,\\mathrm{GB}$），而一天每小时数据的存储量约为 $0.05582\\,\\mathrm{TB}$（或 $55.82\\,\\mathrm{GB}$）。",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.002326 & 0.05582 \\end{pmatrix}}$$"
        },
        {
            "introduction": "在解决了数据存储的静态问题后，我们必须考虑模型引擎的动态行为。虽然显式数值格式更易于实现，但它们在球形网格上面临着严格的稳定性约束。这项练习深入探讨了著名的Courant-Friedrichs-Lewy (CFL) 条件，揭示了为何在接近极点时最大稳定时间步长会急剧缩小，并阐明了为何需要采用极地滤波等技术 。这个计算突显了在计算可行性与物理保真度之间必须做出的权衡。",
            "id": "4031504",
            "problem": "一个全球地球系统数字孪生采用显式欧拉平流方案来处理一个被动标量在球形地球上的平流问题，该地球由经纬度网格表示。网格在经度方向上具有均匀角间距 $\\Delta \\lambda$，在纬度方向上具有均匀角间距 $\\Delta \\varphi$（两者均以弧度为单位），球形地球的半径为 $a$。考虑在给定纬度 $\\varphi$ 处，存在一个速度为 $U$（假设为非负，单位为米/秒）的纯纬向、空间上恒定的风，经向风为零。\n\n从球体上的线性平流方程出发，结合空间上的一阶迎风离散化和前向欧拉时间步进方法，推导该显式方案在纬度 $\\varphi$ 的经纬度网格上的 Courant–Friedrichs–Lewy (CFL) 条件（用 Courant 数表示）。根据你推导的 CFL 条件，计算最大稳定时间步长 $\\Delta t_{\\max}(\\varphi)$，其形式为一个关于 $a$、$U$、$\\Delta \\lambda$ 和 $\\varphi$ 的闭式解析表达式。用秒表示 $\\Delta t_{\\max}(\\varphi)$ 的最终结果。无需四舍五入。\n\n然后，在数字孪生的背景下，讨论极地滤波对数值天气预报和气候模拟的影响：根据高纬度地区有效最小可分辨纬向尺度如何随滤波而变化，解释这种滤波是否以及如何能改变从 CFL 条件推断出的实际稳定性约束，并阐明这在保真度与稳定性之间所带来的权衡。你的讨论应该是定性的，但需有简洁的数学推理支持；除了你推导的 $\\Delta t_{\\max}(\\varphi)$ 表达式外，不需要额外的计算。",
            "solution": "该问题要求推导特定数值方案的 Courant–Friedrichs–Lewy (CFL) 稳定性条件，计算最大稳定时间步长，并对极地滤波进行定性讨论。我将首先验证问题陈述。\n\n### 步骤 1：提取已知条件\n- **系统**：使用显式欧拉平流方案处理被动标量的全球地球系统数字孪生。\n- **几何**：半径为 $a$ 的球形地球。\n- **网格**：经纬度网格，经向均匀角间距 $\\Delta \\lambda$（弧度），纬向均匀角间距 $\\Delta \\varphi$（弧度）。\n- **流场**：在给定纬度 $\\varphi$ 处，速度为 $U$（$U \\ge 0$，单位 m/s）的纯纬向恒定风。经向风分量为零。\n- **控制方程**：球体上的线性平流方程。\n- **数值方案**：空间上一阶迎风离散化，结合前向欧拉时间步进。\n- **任务 1**：推导在纬度 $\\varphi$ 处，以 Courant 数表示的 CFL 条件。\n- **任务 2**：计算最大稳定时间步长 $\\Delta t_{\\max}(\\varphi)$，形式为一个关于 $a$、$U$、$\\Delta \\lambda$ 和 $\\varphi$ 的闭式解析表达式。结果必须以秒为单位。\n- **任务 3**：在数字孪生背景下，讨论极地滤波对数值天气预报和气候模拟的影响。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据、适定且客观。它探讨了球形网格上数值模拟的一个基本问题——CFL 条件，这是计算流体力学、数值天气预报和气候科学中的一个核心课题。物理设置（球体上的纬向平流）是用于分析数值稳定性的标准简化模型。指定的数值方案（前向时间、迎风空间或 FTUS）定义明确。推导所需的所有参数（$a$、$U$、$\\Delta \\lambda$、$\\varphi$）均已提供。问题是自洽的，没有矛盾，并要求进行可验证的数学推导和概念上合理的讨论。这是一个考察基本理解的非平凡问题。\n\n### 步骤 3：结论与行动\n问题有效。我将继续解答。\n\n### CFL 条件和最大时间步长的推导\n\n对于一个被动标量浓度 $C$，其在一维空间坐标 $x$ 上以速度 $u$ 平流的线性平流方程为：\n$$\n\\frac{\\partial C}{\\partial t} + u \\frac{\\partial C}{\\partial x} = 0\n$$\n在此问题中，平流是纯纬向的（沿着一条等纬度线）。空间坐标是沿纬度圈的弧长。经度角 $\\lambda$（以弧度为单位）与沿纬度圈 $\\varphi$ 的物理距离 $x$ 之间的关系由球体上的弧长公式给出。经度的微分变化 $d\\lambda$ 对应于物理距离的微分变化 $dx = r d\\lambda$，其中 $r$ 是纬度圈的半径。该半径为 $r = a \\cos(\\varphi)$。因此，$dx = a \\cos(\\varphi) d\\lambda$。\n\n纬向风速为 $U = \\frac{dx}{dt}$。我们可以用坐标 $\\lambda$ 重写平流方程：\n$$\n\\frac{\\partial C}{\\partial t} + \\frac{dx}{dt} \\frac{\\partial C}{\\partial x} = \\frac{\\partial C}{\\partial t} + U \\frac{\\partial C}{a \\cos(\\varphi) \\partial \\lambda} = 0\n$$\n这可以写成：\n$$\n\\frac{\\partial C}{\\partial t} + \\frac{U}{a \\cos(\\varphi)} \\frac{\\partial C}{\\partial \\lambda} = 0\n$$\n这就是给定问题的控制偏微分方程。\n\n现在，我们使用指定的方案离散化该方程。令 $C_j^n$ 表示第 $j$ 个经度网格点在第 $n$ 个时间步的浓度。经度方向的网格间距为 $\\Delta \\lambda$。时间步长为 $\\Delta t$。\n时间导数使用前向欧拉格式：\n$$\n\\frac{\\partial C}{\\partial t} \\approx \\frac{C_j^{n+1} - C_j^n}{\\Delta t}\n$$\n空间导数使用一阶迎风格式。由于 $U \\ge 0$，风向 $\\lambda$ 增大的方向吹（自西向东）。因此，“迎风”方向指向索引较小的网格点 $j-1$。空间导数近似为：\n$$\n\\frac{\\partial C}{\\partial \\lambda} \\approx \\frac{C_j^n - C_{j-1}^n}{\\Delta \\lambda}\n$$\n将这些离散化形式代入控制方程得到：\n$$\n\\frac{C_j^{n+1} - C_j^n}{\\Delta t} + \\frac{U}{a \\cos(\\varphi)} \\left( \\frac{C_j^n - C_{j-1}^n}{\\Delta \\lambda} \\right) = 0\n$$\n我们可以重新整理这个方程来求解 $C_j^{n+1}$：\n$$\nC_j^{n+1} = C_j^n - \\frac{U \\Delta t}{a \\cos(\\varphi) \\Delta \\lambda} (C_j^n - C_{j-1}^n)\n$$\nCourant 数 $c$ 定义为一个时间步内流体质点行进的距离与网格间距之比。在本例中，距离是 $U \\Delta t$，纬向的物理网格间距是 $\\Delta x = a \\cos(\\varphi) \\Delta \\lambda$。\n因此，纬度 $\\varphi$ 处的 Courant 数为：\n$$\nc(\\varphi) = \\frac{U \\Delta t}{\\Delta x} = \\frac{U \\Delta t}{a \\cos(\\varphi) \\Delta \\lambda}\n$$\n将这个定义代入离散化方程得到：\n$$\nC_j^{n+1} = (1 - c(\\varphi)) C_j^n + c(\\varphi) C_{j-1}^n\n$$\n对于前向时间迎风空间 (FTUS) 方案，数值稳定性（确保误差不会无界增长）的充要条件是右侧项的系数为非负。这是一个凸组合的条件，可以防止新极值的形成并保证稳定性。由于 $c(\\varphi)$ 是非负的（因为 $U, \\Delta t, a, \\Delta \\lambda \\ge 0$，且我们考虑的纬度满足 $\\cos(\\varphi) > 0$），我们只需要确保 $C_j^n$ 的系数为非负：\n$$\n1 - c(\\varphi) \\ge 0 \\implies c(\\varphi) \\le 1\n$$\n这个不等式 $c(\\varphi) \\le 1$ 就是该格式的 CFL 条件。代入 $c(\\varphi)$ 的表达式：\n$$\n\\frac{U \\Delta t}{a \\cos(\\varphi) \\Delta \\lambda} \\le 1\n$$\n为了找到最大稳定时间步长 $\\Delta t_{\\max}(\\varphi)$，我们将 Courant 数设为其极限值 1：\n$$\n\\frac{U \\Delta t_{\\max}(\\varphi)}{a \\cos(\\varphi) \\Delta \\lambda} = 1\n$$\n求解 $\\Delta t_{\\max}(\\varphi)$ 得到闭式解析表达式：\n$$\n\\Delta t_{\\max}(\\varphi) = \\frac{a \\cos(\\varphi) \\Delta \\lambda}{U}\n$$\n单位是一致的：$a$ (米)，$\\Delta \\lambda$ (弧度，无量纲) 和 $U$ (米/秒) 得出的 $\\Delta t_{\\max}$ 单位是秒。\n\n### 关于极地滤波的讨论\n\n推导出的表达式 $\\Delta t_{\\max}(\\varphi) = \\frac{a \\cos(\\varphi) \\Delta \\lambda}{U}$ 揭示了使用经纬度网格的全球模型中的一个关键问题。当纬度 $\\varphi$ 趋近两极（$\\varphi \\to \\pm \\frac{\\pi}{2}$）时，$\\cos(\\varphi) \\to 0$。因此，最大稳定时间步长 $\\Delta t_{\\max}(\\varphi)$ 也趋近于零。对于一个在整个区域使用单一时间步长 $\\Delta t$ 的显式全球模型，这个时间步长必须小于所有网格纬度中最小的 $\\Delta t_{\\max}(\\varphi)$。这个最小值出现在最靠近极点的网格纬度上，使得时间步长在实践上和计算上都小到不可行。这通常被称为“极地问题”。\n\n极地滤波是一种旨在放宽这一严格稳定性约束的数值技术。它的工作原理是在高纬度地区人为地衰减或移除短波纬向波。纬向的物理网格间距 $\\Delta x(\\varphi) = a \\cos(\\varphi) \\Delta \\lambda$ 在靠近两极时变得非常小。为了稳定性的目的，极地滤波有效地创建了一个更大的*有效*纬向网格尺度 $\\Delta x_{\\text{eff}}$。通过平滑场，该方法实质上表明，模型将不再解析物理网格间距 $\\Delta x(\\varphi)$ 尺度上的特征，而是在某个更大的、经过滤波的尺度上进行解析。\n\n数学上，如果滤波移除了波长小于（例如）$m$ 个网格单元（其中 $m > 1$）的纬向波，那么有效最小可分辨纬向尺度变为 $\\Delta x_{\\text{eff}} = m \\cdot \\Delta x(\\varphi) = m \\cdot a \\cos(\\varphi) \\Delta \\lambda$。CFL 条件基于最小可分辨尺度，因此实际稳定性约束变为：\n$$\n\\Delta t \\le \\frac{\\Delta x_{\\text{eff}}}{U} = \\frac{m \\cdot a \\cos(\\varphi) \\Delta \\lambda}{U}\n$$\n这个修正后的约束允许的时间步长是未经滤波的网格所允许的 $m$ 倍，从而显著提高了计算可行性。\n\n这引入的权衡对于数字孪生和大气模拟是根本性的：\n- **稳定性/效率 vs. 保真度**：通过应用极地滤波，模型获得了稳定性，并且可以用一个计算上可行的时间步长运行。这对于实际的天气预报和长期的气候模拟至关重要。然而，这是以牺牲保真度为代价的。滤波过程是非物理的；它是一种数值扩散形式，选择性地从模拟中移除信息。它通过平滑掉小尺度特征来扭曲高纬度地区的流体动力学。这可能对某些天气现象的预报准确性以及极地地区气候系统的长期统计特性产生负面影响，而极地地区是全球地球系统的关键组成部分。因此，采用这种方法的地球系统数字孪生必须接受一种折衷：以牺牲极地地区的准确性和物理真实性为代价，来换取计算上的易处理性。滤波器的强度必须仔细校准，使其强度足以确保稳定性，但又不能强到不可接受地降低解的质量。",
            "answer": "$$\n\\boxed{\\frac{a \\cos(\\varphi) \\Delta\\lambda}{U}}\n$$"
        },
        {
            "introduction": "如此规模的模型无法在单个处理器上运行，必须在超级计算机的数千个核心上进行并行化。这最后一项练习探讨了在现代立方球体网格上进行区域分解的关键概念，并要求你计算由此产生的“光环交换”（halo exchange）所带来的通信开销。通过这项实践，你将理解模型的并行架构选择如何直接影响数字孪生的性能和可扩展性 。",
            "id": "4031525",
            "problem": "用于数值天气预报 (NWP) 和气候模拟的地球系统数字孪生 (DTES) 推进了在立方球网格离散化上的半隐式有限差分更新。该立方球由 $6$ 个面组成，每个面是一个 $N \\times N$ 单元的逻辑矩形网格。该模型在高性能计算 (HPC) 环境中运行，使用消息传递接口 (MPI) 进行区域分解。每个面被划分为 $P_{r} \\times P_{c}$ （行×列）个相等的矩形瓦片，每个瓦片分配给一个独立的 MPI 秩。设每个瓦片内部单元的尺寸为 $n_{x} = N / P_{c}$ 和 $n_{y} = N / P_{r}$。\n\n预报更新在两个水平方向上使用宽度为 $w$ 的二维轴对齐有限差分模板（无对角线依赖），这需要围绕每个瓦片交换宽度为 $w$ 的边缘对齐的光环带（halo strips）以进行幽灵单元交换。跨越面边缘时，瓦片与相邻面上的瓦片通过一致的索引映射进行通信；几何旋转或度量变换不会改变光环单元的数量。假设每个时间步对所有 $s$ 个预报场进行一次同步光环交换，每个场的值以双精度存储，每个值占 $b$ 字节。角块不单独交换；只通信边缘对齐的光环。将每个时间步的通信量定义为所有 MPI 秩发送的所有消息的总字节数，其中每个唯一的瓦片间边界的双向通信在每个时间步只计算一次。\n\n给定 $N = 1024$，$P_{r} = 16$，$P_{c} = 16$，$w = 3$，$s = 10$ 以及 $b = 8$ 字节，请按所述设计区域分解，用文字说明相应光环交换模式，并从第一性原理出发，计算整个立方球的光环交换在每个时间步产生的确切总通信量。以字节为单位表示最终通信量。提供精确的整数值，无需四舍五入。",
            "solution": "在尝试任何解答之前，需对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n- **网格系统**：立方球。\n- **面数**：$6$。\n- **每个面维度的单元数**：$N = 1024$。\n- **面分区（行）**：$P_{r} = 16$。\n- **面分区（列）**：$P_{c} = 16$。\n- **每个瓦片内部单元尺寸**：$n_{x} = N / P_{c}$，$n_{y} = N / P_{r}$。\n- **模板宽度 / 光环宽度**：$w = 3$。\n- **预报场数量**：$s = 10$。\n- **每个值的字节数（双精度）**：$b = 8$。\n- **通信模式**：同步、边缘对齐的光环交换；无单独的角块交换。\n- **通信量定义**：所有 MPI 秩发送的总字节数，对每个唯一的瓦片间边界的双向通信求和。\n\n### 步骤2：使用提取的已知条件进行验证\n1.  **科学依据**：该问题描述了在立方球网格上使用消息传递接口 (MPI) 求解偏微分方程的标准区域分解和通信策略（光环交换）。这是高性能计算在数值天气预报和气候模拟领域中一个成熟且基础的实践。这些概念在科学上是合理的。\n2.  **良构性**：该问题提供了所有必要的参数（$N, P_r, P_c, w, s, b$），并清晰地定义了要计算的几何形状和通信量。目标是计算一个特定的数值。问题明确无歧义，并且基于所提供的数据有唯一解。\n3.  **客观性**：问题以精确、定量和技术性的术语陈述，不含主观性或个人观点。\n4.  **一致性与可行性**：这些参数对于现代数值模型而言是一致且物理上现实的。例如，一个立方球 C1024 网格、一个 $16 \\times 16$ 的分解以及一个宽度为 $3$ 的光环都是合理的。\n\n### 步骤3：结论与行动\n该问题有效。它具有科学依据、良构、客观，并包含完整且一致的信息集。将从第一性原理推导解答。\n\n### 解答推导\n目标是计算整个立方球网格上光环交换过程每个时间步的总通信量。该通信量是 MPI 秩之间所有消息中发送的所有字节的总和。\n\n**1. 区域分解与瓦片配置**\n区域分解设计如下所述：\n- 立方球有 $F=6$ 个面。\n- 每个面是一个 $N \\times N$ 单元的逻辑矩形网格，被划分为一个 $P_{r} \\times P_{c}$ 的瓦片网格。\n- 瓦片总数（即 MPI 秩的总数）为 $N_{\\text{tiles}} = F \\times P_{r} \\times P_{c} = 6 \\times 16 \\times 16 = 1536$。\n- 每个瓦片管理一个尺寸为 $n_{x} \\times n_{y}$ 的局部内部单元网格。\n- 给定 $N=1024$，$P_{c}=16$ 和 $P_{r}=16$：\n  - $n_{x} = \\frac{N}{P_{c}} = \\frac{1024}{16} = 64$ 个单元。\n  - $n_{y} = \\frac{N}{P_{r}} = \\frac{1024}{16} = 64$ 个单元。\n每个 MPI 秩负责一个 $64 \\times 64$ 的单元块。\n\n**2. 光环交换模式与每边界通信量**\n光环交换模式如下：\n- 每个瓦片与其四个逻辑邻居（上、下、左、右）交换数据。邻居可以位于同一个面上，也可以位于相邻的面上。\n- 交换过程包括向邻居发送一个局部单元带（一个“光环”），并从邻居接收一个对应的光环来填充幽灵单元。\n- 光环带有 $w=3$ 个单元的宽度。该带的长度对应于共享瓦片边界上的单元数，即 $n_x$ 或 $n_y$。\n- 必须交换 $s=10$ 个预报场的数据，每个值占 $b=8$ 字节。\n- 跨任何单个边界的通信都是双向的。问题将总体积定义为双向发送的字节总和。\n- 跨越长度为 $L$ 的边界的单向消息的数据量为 $V_{\\text{msg}} = L \\times w \\times s \\times b$。\n- 每个时间步跨越一个唯一边界的总通信量为 $V_{\\text{bnd}} = 2 \\times V_{\\text{msg}} = 2 \\times L \\times w \\times s \\times b$。\n- 由于 $n_{x} = n_{y} = 64$，边界长度 $L$ 始终为 $64$ 个单元。因此，每个边界的通信量对所有边界都是恒定的：\n  $$V_{\\text{bnd}} = 2 \\times 64 \\times w \\times s \\times b = 2 \\times 64 \\times 3 \\times 10 \\times 8 = 30720 \\text{ 字节}$$\n\n**3. 瓦片边界的枚举**\n总通信量是唯一边界数量与每边界通信量的乘积。我们将边界分为两类：内部边界（在同一面内）和外部边界（在不同面之间）。\n\n- **内部边界**：这些是同一面上相邻瓦片之间的边界。\n  - 在一个面上，$P_{c} \\times P_{r}$ 的瓦片网格有 $P_{r} \\times (P_{c}-1)$ 个垂直边界和 $P_{c} \\times (P_{r}-1)$ 个水平边界。\n  - 每个面的内部边界总数为 $N_{\\text{int, face}} = P_{r}(P_{c}-1) + P_{c}(P_{r}-1)$。\n  - 当 $P_{r}=P_{c}=16$ 时，$N_{\\text{int, face}} = 16(16-1) + 16(16-1) = 16 \\times 15 + 16 \\times 15 = 480$。\n  - 对于全部 $F=6$ 个面，内部边界总数为 $N_{\\text{int}} = F \\times N_{\\text{int, face}} = 6 \\times 480 = 2880$。\n\n- **外部边界**：这些是位于不同面上的瓦片之间的边界，沿包围立方体的 $12$ 条边分布。\n  - 这 $12$ 条立方体边中的每一条都代表两个面之间的共享边界。\n  - 一条立方体边的长度为 $N$ 个单元，被 $P_{c}$（或 $P_{r}$）个瓦片瓜分。因此，每条立方体边上有 $P_{c}$ 个瓦片间边界。\n  - 外部边界的总数为 $N_{\\text{ext}} = 12 \\times P_{c} = 12 \\times 16 = 192$。\n\n- **边界总数**：唯一通信边界的总数是内部边界和外部边界之和。\n  $$N_{\\text{total bnd}} = N_{\\text{int}} + N_{\\text{ext}} = 2880 + 192 = 3072$$\n\n**4. 总通信量计算**\n每个时间步的总通信量 $V_{\\text{total}}$ 是总边界数与每个边界上交换的数据量的乘积。\n$$V_{\\text{total}} = N_{\\text{total bnd}} \\times V_{\\text{bnd}}$$\n$$V_{\\text{total}} = 3072 \\times 30720 = 94371840 \\text{ 字节}$$\n\n**使用通用公式进行验证：**\n可以推导出总通信量的通用公式。设 $P=P_r=P_c$ 且 $n=N/P$。\n瓦片边界总数为 $N_{\\text{total bnd}} = N_{\\text{int}} + N_{\\text{ext}} = 6 \\times [2P(P-1)] + 12P = 12P^2 - 12P + 12P = 12P^2$。\n总体积为 $V_{\\text{total}} = (12P^2) \\times (2 \\times n \\times w \\times s \\times b)$。\n代入 $n=N/P$：\n$V_{\\text{total}} = 12P^2 \\times (2 \\times \\frac{N}{P} \\times w \\times s \\times b) = 24 \\times P \\times N \\times w \\times s \\times b$。\n使用给定值：\n$P = 16$，$N=1024$，$w=3$，$s=10$，$b=8$。\n$$V_{\\text{total}} = 24 \\times 16 \\times 1024 \\times 3 \\times 10 \\times 8$$\n$$V_{\\text{total}} = 384 \\times 1024 \\times 240$$\n$$V_{\\text{total}} = 393216 \\times 240 = 94371840 \\text{ 字节}$$\n结果得到确认。",
            "answer": "$$\\boxed{94371840}$$"
        }
    ]
}