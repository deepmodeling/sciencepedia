{
    "hands_on_practices": [
        {
            "introduction": "本练习将带您回到大气边界层研究的基石：中性条件下的对数风廓线。我们将从雷诺平均动量方程出发，运用一阶闭合和混合长假设，推导出这一经典廓线，从而将湍流切应力与平均风切变联系起来。通过这个实践，您不仅能掌握理论推导，还将利用给定的观测数据来校准冯·卡门（von Kármán）常数 $\\kappa$，并评估不同混合长模型对切应力预测的敏感性，这些都是发展和评估湍流参数化方案的核心技能 。",
            "id": "4082718",
            "problem": "考虑一个位于平坦地形上方的水平均匀、定常、中性分层的大气近地面层，其中平均风与 $x$ 方向一致。对速度场应用雷诺分解，其中 $\\overline{U}(z)$ 是平均风速，$u'(z,t)$ 是湍流脉动。湍流切应力定义为 $-\\rho\\,\\overline{u'w'}(z)$，其中 $\\rho$ 是空气密度，$w'(z,t)$ 是垂直速度的湍流脉动。假设常通量层近似，使得运动切应力 $\\overline{u'w'}$ 与 $z$ 无关，并通过 $\\rho\\,u_{\\ast}^{2} = -\\rho\\,\\overline{u'w'}$ 定义摩擦速度 $u_{\\ast}$。使用带涡粘性系数 $K_{m}(z)$ 的一阶闭合和混合长假设，将 $K_{m}$ 与混合长 $l(z)$ 及平均切变 $\\partial\\overline{U}/\\partial z$ 联系起来。\n\n从雷诺平均动量方程和这些定义出发，通过选择 $l(z) = \\kappa\\,z$ 来推导中性、无科里奥利力的对数风廓线，其中 $\\kappa$ 是 von Kármán 常数，$z$ 是距有效边界的高度。使用在空气动力学粗糙度长度 $z_{0}$ 处平均风为零的边界条件。\n\n给定以下符合科学实际的测量值和参数：\n- 空气密度 $\\rho = 1.20\\,\\mathrm{kg\\,m^{-3}}$，\n- 地表动量通量（切应力）$\\tau = 0.36\\,\\mathrm{N\\,m^{-2}}$，\n- 空气动力学粗糙度长度 $z_{0} = 0.10\\,\\mathrm{m}$，\n- 在 $z = 10.0\\,\\mathrm{m}$ 处的平均风速为 $\\overline{U}(10\\,\\mathrm{m}) = 6.00\\,\\mathrm{m\\,s^{-1}}$。\n\n使用这些值，根据您推导的对数风廓线来校准 $\\kappa$。\n\n接下来，通过将 $l(z)$ 替换为 Blackadar 型式 $l_{B}(z) = \\frac{\\kappa\\,z}{1 + \\frac{\\kappa\\,z}{\\lambda}}$，其中渐近长度尺度为 $\\lambda = 100\\,\\mathrm{m}$。计算相对变化 $\\delta = \\frac{\\tau_{B}(z) - \\tau_{P}(z)}{\\tau_{P}(z)}$，在 $z = 10.0\\,\\mathrm{m}$ 处，其中 $\\tau_{P}(z)$ 是使用 $l(z) = \\kappa\\,z$ 的混合长闭合以及在 $z$ 处对应的中性对数风切变所预测的切应力，而 $\\tau_{B}(z)$ 是使用 $l_{B}(z)$ 的闭合但在 $z$ 处保持相同的中性对数风切变所预测的切应力。\n\n将 $\\delta$ 的最终值表示为无单位的小数。将您的最终答案四舍五入到四位有效数字。",
            "solution": "首先根据既定准则对问题进行验证。\n\n### 步骤 1：提取给定条件\n- **设定**：位于平坦地形上方的水平均匀、定常、中性分层的大气近地面层。\n- **平均风**：与 $x$ 方向一致，记为 $\\overline{U}(z)$。\n- **湍流**：分解为平均部分和脉动部分，例如 $u = \\overline{U} + u'$。湍流切应力为 $-\\rho\\,\\overline{u'w'}(z)$。\n- **近似**：\n    - 常通量层：运动切应力 $\\overline{u'w'}$ 与高度 $z$ 无关。\n    - 无科里奥利力。\n- **定义**：\n    - 摩擦速度：$\\rho\\,u_{\\ast}^{2} = -\\rho\\,\\overline{u'w'}$。\n    - 一阶闭合：涡粘性系数 $K_{m}(z)$。\n    - 混合长假设：$K_{m}(z) = l(z)^2 |\\partial\\overline{U}/\\partial z|$。\n    - Prandtl 混合长：$l(z) = \\kappa\\,z$，其中 $\\kappa$ 是 von Kármán 常数。\n- **边界条件**：$\\overline{U}(z_0) = 0$，其中 $z_0$ 是空气动力学粗糙度长度。\n- **数据**：\n    - 空气密度 $\\rho = 1.20\\,\\mathrm{kg\\,m^{-3}}$\n    - 地表动量通量（切应力）$\\tau = 0.36\\,\\mathrm{N\\,m^{-2}}$\n    - 空气动力学粗糙度长度 $z_{0} = 0.10\\,\\mathrm{m}$\n    - 在 $z = 10.0\\,\\mathrm{m}$ 处的平均风速为 $\\overline{U}(10.0\\,\\mathrm{m}) = 6.00\\,\\mathrm{m\\,s^{-1}}$\n- **替代混合长 (Blackadar)**：$l_{B}(z) = \\frac{\\kappa\\,z}{1 + \\frac{\\kappa\\,z}{\\lambda}}$，其中 $\\lambda = 100\\,\\mathrm{m}$。\n- **要求计算**：在 $z = 10.0\\,\\mathrm{m}$ 处的相对变化 $\\delta = \\frac{\\tau_{B}(z) - \\tau_{P}(z)}{\\tau_{P}(z)}$，其中 $\\tau_P$ 使用 $l(z) = \\kappa z$，$\\tau_B$ 使用 $l_B(z)$，两者都使用从中性对数廓线推导出的相同风切变。\n\n### 步骤 2：使用提取的给定条件进行验证\n该问题在科学上基于边界层气象学和流体动力学的成熟原理，特别是雷诺平均、混合长理论和壁面律的对数律。该物理情景是该领域使用的标准理想化模型。所提供的数据在物理上是现实的。该问题是适定的，有一组明确的任务：推导、校准和敏感性分析。语言客观且无歧义。未发现不一致或矛盾之处。问题有效。\n\n### 步骤 3：结论与行动\n问题有效。将提供一个完整、合理的解答。\n\n### 解答推导\n\n分析从指定条件下的 $x$ 方向平均风分量 $\\overline{U}$ 的雷诺平均动量方程开始：定常状态 $(\\partial/\\partial t = 0)$、水平均匀 $(\\partial/\\partial x = \\partial/\\partial y = 0)$ 和无平均垂直风 $(\\overline{W} = 0)$。假设在流动方向上没有平均压力梯度，并忽略分子粘性，方程简化为：\n$$\n\\frac{\\partial}{\\partial z} \\overline{u'w'} = 0\n$$\n该方程意味着运动湍流动量通量 $\\overline{u'w'}$ 随高度 $z$ 保持不变。这是常通量层近似的基础。湍流切应力为 $\\tau(z) = -\\rho\\,\\overline{u'w'}$。由于通量恒定，应力 $\\tau$ 也随高度保持不变，且等于地表应力，我们记为 $\\tau_0$。\n\n摩擦速度 $u_{\\ast}$ 由 $\\tau_0 = \\rho u_{\\ast}^{2}$ 定义。根据应力的定义，可得 $u_{\\ast}^2 = -\\overline{u'w'}$。我们假设平均切变为正，即 $\\partial \\overline{U} / \\partial z > 0$，这意味着 $\\overline{u'w'}$ 为负。\n\n接下来，我们采用一阶闭合（K-理论）来模拟湍流通量：\n$$\n-\\overline{u'w'} = K_m \\frac{\\partial \\overline{U}}{\\partial z}\n$$\n其中 $K_m$ 是动量的涡粘性系数。与 $u_{\\ast}$ 的定义相结合，我们得到：\n$$\nu_{\\ast}^2 = K_m \\frac{\\partial \\overline{U}}{\\partial z}\n$$\n混合长假设将 $K_m$ 与平均切变和混合长度尺度 $l(z)$ 联系起来：\n$$\nK_m = l(z)^2 \\left| \\frac{\\partial \\overline{U}}{\\partial z} \\right|\n$$\n假设 $\\partial \\overline{U} / \\partial z > 0$，则上式变为 $K_m = l(z)^2 \\frac{\\partial \\overline{U}}{\\partial z}$。将其代入 $u_{\\ast}^2$ 的表达式中：\n$$\nu_{\\ast}^2 = \\left( l(z)^2 \\frac{\\partial \\overline{U}}{\\partial z} \\right) \\frac{\\partial \\overline{U}}{\\partial z} = l(z)^2 \\left( \\frac{\\partial \\overline{U}}{\\partial z} \\right)^2\n$$\n取正平方根（因为 $u_{\\ast} > 0$ 且 $\\partial \\overline{U} / \\partial z > 0$）：\n$$\nu_{\\ast} = l(z) \\frac{\\partial \\overline{U}}{\\partial z}\n$$\n使用指定的 Prandtl 混合长 $l(z) = \\kappa z$：\n$$\nu_{\\ast} = \\kappa z \\frac{\\partial \\overline{U}}{\\partial z}\n$$\n这是一个关于 $\\overline{U}(z)$ 的一阶常微分方程。我们可以分离变量并积分：\n$$\nd\\overline{U} = \\frac{u_{\\ast}}{\\kappa} \\frac{dz}{z}\n$$\n从空气动力学粗糙度长度 $z_0$ 积分到任意高度 $z$：\n$$\n\\int_{\\overline{U}(z_0)}^{\\overline{U}(z)} d\\overline{U}' = \\int_{z_0}^{z} \\frac{u_{\\ast}}{\\kappa} \\frac{dz'}{z'}\n$$\n使用边界条件 $\\overline{U}(z_0) = 0$：\n$$\n\\overline{U}(z) - 0 = \\frac{u_{\\ast}}{\\kappa} \\left[ \\ln(z') \\right]_{z_0}^z = \\frac{u_{\\ast}}{\\kappa} (\\ln(z) - \\ln(z_0))\n$$\n这就得到了中性对数风廓线：\n$$\n\\overline{U}(z) = \\frac{u_{\\ast}}{\\kappa} \\ln\\left(\\frac{z}{z_0}\\right)\n$$\n\n现在，我们使用所提供的数据来校准 von Kármán 常数 $\\kappa$。\n首先，根据给定的地表应力 $\\tau = 0.36\\,\\mathrm{N\\,m^{-2}}$ 和空气密度 $\\rho = 1.20\\,\\mathrm{kg\\,m^{-3}}$ 计算摩擦速度 $u_{\\ast}$：\n$$\nu_{\\ast} = \\sqrt{\\frac{\\tau}{\\rho}} = \\sqrt{\\frac{0.36}{1.20}} = \\sqrt{0.30}\\,\\mathrm{m\\,s^{-1}}\n$$\n接下来，我们重排对数风廓线方程以求解 $\\kappa$：\n$$\n\\kappa = \\frac{u_{\\ast}}{\\overline{U}(z)} \\ln\\left(\\frac{z}{z_0}\\right)\n$$\n代入给定值 $\\overline{U}(10.0\\,\\mathrm{m}) = 6.00\\,\\mathrm{m\\,s^{-1}}$，$z=10.0\\,\\mathrm{m}$ 和 $z_0 = 0.10\\,\\mathrm{m}$：\n$$\n\\kappa = \\frac{\\sqrt{0.30}}{6.00} \\ln\\left(\\frac{10.0}{0.10}\\right) = \\frac{\\sqrt{0.30}}{6.00} \\ln(100)\n$$\n现在，这个 $\\kappa$ 值被认为是针对该系统校准好的。\n\n问题的最后一部分是评估切应力预测对不同混合长模型 $l_B(z)$ 的敏感性。我们需要计算在 $z=10.0\\,\\mathrm{m}$ 处的相对变化 $\\delta$：\n$$\n\\delta = \\frac{\\tau_{B}(10.0) - \\tau_{P}(10.0)}{\\tau_{P}(10.0)}\n$$\n由混合长模型预测的切应力由 $\\tau = \\rho l^2 (\\partial \\overline{U}/\\partial z)^2$ 给出。问题规定，两次计算都使用“相同的中性对数风切变”。从推导出的廓线得到的切变 $S(z) = \\partial \\overline{U}/\\partial z$ 为：\n$$\nS(z) = \\frac{\\partial}{\\partial z} \\left( \\frac{u_{\\ast}}{\\kappa} \\ln\\left(\\frac{z}{z_0}\\right) \\right) = \\frac{u_{\\ast}}{\\kappa z}\n$$\n对于 Prandtl 模型，$l(z) = l_P(z) = \\kappa z$。预测的应力为：\n$$\n\\tau_P(z) = \\rho (l_P(z))^2 (S(z))^2 = \\rho (\\kappa z)^2 \\left(\\frac{u_{\\ast}}{\\kappa z}\\right)^2 = \\rho u_{\\ast}^2 = \\tau\n$$\n正如预期的，这在所有高度（包括 $z = 10.0\\,\\mathrm{m}$）都恢复了恒定的地表应力 $\\tau = 0.36\\,\\mathrm{N\\,m^{-2}}$。\n\n对于 Blackadar 模型，$l(z) = l_B(z) = \\frac{\\kappa z}{1 + \\frac{\\kappa z}{\\lambda}}$。在高度 $z$ 处预测的应力 $\\tau_B(z)$ 使用此混合长，但使用相同的切变 $S(z)=\\frac{u_{\\ast}}{\\kappa z}$：\n$$\n\\tau_B(z) = \\rho (l_B(z))^2 (S(z))^2 = \\rho \\left( \\frac{\\kappa z}{1 + \\frac{\\kappa z}{\\lambda}} \\right)^2 \\left(\\frac{u_{\\ast}}{\\kappa z}\\right)^2 = \\frac{\\rho u_{\\ast}^2}{\\left(1 + \\frac{\\kappa z}{\\lambda}\\right)^2} = \\frac{\\tau}{\\left(1 + \\frac{\\kappa z}{\\lambda}\\right)^2}\n$$\n现在我们可以写出 $\\delta$ 的表达式：\n$$\n\\delta = \\frac{\\tau_B(z) - \\tau_P(z)}{\\tau_P(z)} = \\frac{\\frac{\\tau}{(1 + \\kappa z/\\lambda)^2} - \\tau}{\\tau} = \\frac{1}{(1 + \\kappa z/\\lambda)^2} - 1\n$$\n我们在 $z = 10.0\\,\\mathrm{m}$ 和 $\\lambda = 100\\,\\mathrm{m}$ 的条件下计算该值。我们需要项 $\\kappa z / \\lambda$ 的值：\n$$\n\\frac{\\kappa z}{\\lambda} = \\frac{\\left(\\frac{\\sqrt{0.30}}{6.00} \\ln(100)\\right) \\times 10.0}{100} = \\frac{\\sqrt{0.30} \\ln(100)}{60.0}\n$$\n我们来计算这个值：\n$$\n\\frac{\\kappa z}{\\lambda} \\approx \\frac{0.54772256 \\times 4.60517019}{60.0} \\approx \\frac{2.5223013}{60.0} \\approx 0.042038355\n$$\n现在将此值代入 $\\delta$ 的表达式中：\n$$\n\\delta = \\frac{1}{(1 + 0.042038355)^2} - 1 = \\frac{1}{(1.042038355)^2} - 1\n$$\n$$\n\\delta = \\frac{1}{1.08584414} - 1 \\approx 0.92094485 - 1 = -0.07905515\n$$\n四舍五入到四位有效数字，我们得到 $\\delta = -0.07906$。",
            "answer": "$$\n\\boxed{-0.07906}\n$$"
        },
        {
            "introduction": "在理解了中性边界层中的动量通量之后，我们现在将注意力转向热量输送，并引入大气稳定度的影响。本练习将引导您应用莫宁-奥布霍夫相似性理论（Monin-Obukhov Similarity Theory, MOST）来处理稳定边界层中的湍流热通量，这是参数化地表能量平衡的关键。您将推导热量涡度扩散系数 $K_{\\theta}$ 的表达式，并探索不同的稳定度订正函数 $\\phi_h(\\zeta)$ 如何影响热通量的计算，从而深刻理解模型对稳定度参数化选择的敏感性 。",
            "id": "4082713",
            "problem": "一个中性层结的流在夜间经过陆地时变得稳定层结，形成一个湍流输送位温的表面层。考虑大气边界层在定常、水平均匀条件下的表面层，其中雷诺平均适用。湍流感热输送由运动学湍流热通量 $\\overline{w'\\theta'}$ 描述，其中 $\\overline{(\\cdot)}$ 表示系综平均，$w$ 是垂直速度，$\\theta$ 是位温。假设：\n\n- 通量-梯度关系（一阶闭合）在表面层中成立，即 $-\\overline{w'\\theta'} = K_{\\theta}(z)\\,\\partial \\overline{\\theta}/\\partial z$，其中 $K_{\\theta}(z)$ 是热量的涡动扩散系数。\n- 混合长度标度 $\\ell = k\\,z$ 在表面层中是合适的，其中 $k$ 是 von Kármán 常数，$z$ 是地表以上的高度。\n- Monin–Obukhov 相似性理论 (MOST) 提供了无量纲热量梯度函数 $\\phi_{h}(\\zeta)$，其中 $\\zeta = z/L$，$L$ 是 Monin–Obukhov 长度。温度尺度由 $\\theta_{*} = -\\overline{w'\\theta'}/u_{*}$ 定义，其中 $u_{*}$ 是摩擦速度。\n\n令平均位温廓线为 $\\overline{\\theta}(z) = \\theta_{0} + \\Gamma\\,z$，适用于 $z \\in [0, h]$，其中常数背景梯度 $\\Gamma$ 代表一个稳定层结的环境。取以下参数值和稳定性函数（在实践中用于稳定条件 $\\zeta > 0$ 的两种候选形式）：\n\n- $k = 0.4$，$u_{*} = 0.35\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$，$L = 10\\ \\mathrm{m}$，以及 $\\Gamma = 0.02\\ \\mathrm{K}\\ \\mathrm{m}^{-1}$。\n- 形式 A (线性 Businger–Dyer 型)：$\\phi_{h}^{A}(\\zeta) = 1 + \\beta\\,\\zeta$，其中 $\\beta = 5$。\n- 形式 B (二次扩展)：$\\phi_{h}^{B}(\\zeta) = 1 + \\beta\\,\\zeta + \\gamma\\,\\zeta^{2}$，其中 $\\beta = 5$ 和 $\\gamma = 0.3$。\n\n任务：\n1. 从以上定义和既定假设出发，推导 $K_{\\theta}(z)$ 关于 $k$、$u_{*}$、$z$ 和 $\\phi_{h}(z/L)$ 的表达式。\n2. 使用推导出的 $K_{\\theta}(z)$ 和通量-梯度关系，获得形式 A 和形式 B 下的垂直湍流运动学热通量廓线 $-\\overline{w'\\theta'}(z)$ 的表达式。\n3. 对形式 A 和形式 B，计算在 $z_{0} = 10\\ \\mathrm{m}$ 处的通量。\n4. 定义在 $z_{0}$ 处的敏感度指标 $S$ 为 $S = \\left|\\left(-\\overline{w'\\theta'}\\right)_{B}(z_{0}) - \\left(-\\overline{w'\\theta'}\\right)_{A}(z_{0})\\right|\\,/\\,\\left|\\left(-\\overline{w'\\theta'}\\right)_{A}(z_{0})\\right|$。计算 $S$。\n\n将通量以 $\\mathrm{K}\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$ 为单位表示。您最终报告的量必须是无量纲的敏感度 $S$。将最终的 $S$ 四舍五入到四位有效数字。",
            "solution": "该问题需要系统地应用大气边界层气象学原理，特别是 Monin-Obukhov 相似性理论 (MOST) 和一阶湍流闭合 (K-理论)。\n\n**任务1：热量涡动扩散系数 $K_{\\theta}(z)$ 的推导**\n分析始于 MOST 中无量纲热量梯度函数 $\\phi_h(\\zeta)$ 的定义：\n$$\n\\phi_h(\\zeta) = \\frac{k z}{\\theta_*} \\frac{\\partial \\overline{\\theta}}{\\partial z}\n$$\n其中 $\\zeta = z/L$，$k$ 是 von Kármán 常数，$z$ 是高度，$\\overline{\\theta}$ 是平均位温，而 $\\theta_*$ 是湍流温度尺度。温度尺度的定义与运动学湍流热通量 $\\overline{w'\\theta'}$ 和摩擦速度 $u_*$ 相关：\n$$\n\\theta_* = -\\frac{\\overline{w'\\theta'}}{u_*}\n$$\n将 $\\theta_*$ 的这个定义代入 $\\phi_h(\\zeta)$ 的方程中，得到：\n$$\n\\phi_h(\\zeta) = \\frac{k z}{(-\\overline{w'\\theta'}/u_*)} \\frac{\\partial \\overline{\\theta}}{\\partial z} = \\frac{k z u_*}{-\\overline{w'\\theta'}} \\frac{\\partial \\overline{\\theta}}{\\partial z}\n$$\n问题假定了一个湍流热通量的一阶闭合（通量-梯度关系）：\n$$\n-\\overline{w'\\theta'} = K_{\\theta}(z) \\frac{\\partial \\overline{\\theta}}{\\partial z}\n$$\n其中 $K_{\\theta}(z)$ 是热量的涡动扩散系数。通过将此关系代入重新整理后的 $\\phi_h(\\zeta)$ 表达式中，我们得到：\n$$\n\\phi_h(\\zeta) = \\frac{k z u_*}{K_{\\theta}(z) (\\partial \\overline{\\theta}/\\partial z)} \\frac{\\partial \\overline{\\theta}}{\\partial z}\n$$\n在位温梯度 $\\partial \\overline{\\theta}/\\partial z$ 非零的条件下（对于给定的廓线，这是成立的），梯度项相互抵消，得到：\n$$\n\\phi_h(\\zeta) = \\frac{k z u_*}{K_{\\theta}(z)}\n$$\n分离出 $K_{\\theta}(z)$ 得到所需的表达式，它将涡动扩散系数与 MOST 的参数联系起来：\n$$\nK_{\\theta}(z) = \\frac{k z u_*}{\\phi_h(z/L)}\n$$\n\n**任务2：湍流运动学热通量廓线的表达式**\n使用通量-梯度关系 $-\\overline{w'\\theta'}(z) = K_{\\theta}(z) (\\partial \\overline{\\theta}/\\partial z)$，我们可以推导出通量廓线。平均位温廓线由 $\\overline{\\theta}(z) = \\theta_0 + \\Gamma z$ 给出，这意味着梯度随高度为常数：\n$$\n\\frac{\\partial \\overline{\\theta}}{\\partial z} = \\Gamma\n$$\n将任务1中得到的 $K_{\\theta}(z)$ 表达式和梯度 $\\Gamma$ 代入通量-梯度方程，得到湍流热通量廓线的一般形式：\n$$\n-\\overline{w'\\theta'}(z) = \\left(\\frac{k z u_*}{\\phi_h(z/L)}\\right) \\Gamma = \\frac{k z u_* \\Gamma}{\\phi_h(z/L)}\n$$\n现在，我们将此表达式应用于提供的两种稳定性函数 $\\phi_h(\\zeta)$ 的形式。\n\n对于形式 A，$\\phi_{h}^{A}(\\zeta) = 1 + \\beta \\zeta$。代入 $\\zeta = z/L$，热通量廓线为：\n$$\n\\left(-\\overline{w'\\theta'}\\right)_{A}(z) = \\frac{k z u_* \\Gamma}{1 + \\beta (z/L)}\n$$\n\n对于形式 B，$\\phi_{h}^{B}(\\zeta) = 1 + \\beta \\zeta + \\gamma \\zeta^2$。代入 $\\zeta = z/L$，热通量廓线为：\n$$\n\\left(-\\overline{w'\\theta'}\\right)_{B}(z) = \\frac{k z u_* \\Gamma}{1 + \\beta(z/L) + \\gamma(z/L)^2}\n$$\n\n**任务3：在 $z_{0} = 10\\ \\mathrm{m}$ 处计算通量**\n给定的参数值为 $k = 0.4$，$u_{*} = 0.35\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$，$L = 10\\ \\mathrm{m}$，$\\Gamma = 0.02\\ \\mathrm{K}\\ \\mathrm{m}^{-1}$，$\\beta = 5$，以及 $\\gamma = 0.3$。计算在 $z_0 = 10\\ \\mathrm{m}$ 处进行。\n\n首先，我们计算在 $z_0$ 处的稳定性参数 $\\zeta$：\n$$\n\\zeta_0 = \\frac{z_0}{L} = \\frac{10\\ \\mathrm{m}}{10\\ \\mathrm{m}} = 1\n$$\n通量表达式的分子 $k z_0 u_* \\Gamma$ 对两种形式都是相同的：\n$$\nk z_0 u_* \\Gamma = (0.4) \\times (10\\ \\mathrm{m}) \\times (0.35\\ \\mathrm{m}\\ \\mathrm{s}^{-1}) \\times (0.02\\ \\mathrm{K}\\ \\mathrm{m}^{-1}) = 0.028\\ \\mathrm{K}\\ \\mathrm{m}\\ \\mathrm{s}^{-1}\n$$\n接下来，我们计算在 $\\zeta_0 = 1$ 处的稳定性函数：\n对于形式 A：\n$$\n\\phi_{h}^{A}(\\zeta_0) = 1 + \\beta \\zeta_0 = 1 + (5)(1) = 6\n$$\n对于形式 B：\n$$\n\\phi_{h}^{B}(\\zeta_0) = 1 + \\beta \\zeta_0 + \\gamma \\zeta_0^2 = 1 + (5)(1) + (0.3)(1)^2 = 1 + 5 + 0.3 = 6.3\n$$\n使用这些值，我们计算在 $z_0$ 处的通量：\n$$\n\\left(-\\overline{w'\\theta'}\\right)_{A}(z_0) = \\frac{0.028}{\\phi_{h}^{A}(\\zeta_0)} = \\frac{0.028}{6}\\ \\mathrm{K}\\ \\mathrm{m}\\ \\mathrm{s}^{-1}\n$$\n$$\n\\left(-\\overline{w'\\theta'}\\right)_{B}(z_0) = \\frac{0.028}{\\phi_{h}^{B}(\\zeta_0)} = \\frac{0.028}{6.3}\\ \\mathrm{K}\\ \\mathrm{m}\\ \\mathrm{s}^{-1}\n$$\n\n**任务4：敏感度指标 $S$ 的计算**\n敏感度指标 $S$ 定义为两种通量公式之间的相对差异：\n$$\nS = \\frac{\\left|\\left(-\\overline{w'\\theta'}\\right)_{B}(z_{0}) - \\left(-\\overline{w'\\theta'}\\right)_{A}(z_{0})\\right|}{\\left|\\left(-\\overline{w'\\theta'}\\right)_{A}(z_{0})\\right|}\n$$\n这可以简化为：\n$$\nS = \\left| \\frac{\\left(-\\overline{w'\\theta'}\\right)_{B}(z_{0})}{\\left(-\\overline{w'\\theta'}\\right)_{A}(z_{0})} - 1 \\right|\n$$\n通量之比由稳定性函数的反比决定：\n$$\n\\frac{\\left(-\\overline{w'\\theta'}\\right)_{B}(z_{0})}{\\left(-\\overline{w'\\theta'}\\right)_{A}(z_{0})} = \\frac{ \\phi_{h}^{A}(\\zeta_0) }{ \\phi_{h}^{B}(\\zeta_0) } = \\frac{6}{6.3} = \\frac{60}{63} = \\frac{20}{21}\n$$\n将此比率代入 $S$ 的表达式中：\n$$\nS = \\left| \\frac{20}{21} - 1 \\right| = \\left| \\frac{20 - 21}{21} \\right| = \\left| -\\frac{1}{21} \\right| = \\frac{1}{21}\n$$\n为了获得最终的数值答案，我们进行除法运算并按要求四舍五入到四位有效数字：\n$$\nS = \\frac{1}{21} \\approx 0.047619047... \\approx 0.04762\n$$",
            "answer": "$$\\boxed{0.04762}$$"
        },
        {
            "introduction": "将湍流物理理论应用于数值模型时，我们必须面对一个新的挑战：数值方法本身可能引入非物理效应。本练习将通过修正方程分析，揭示一个常用的一阶平流格式如何产生“数值扩散”。您将推导该数值扩散系数 $K_{\\text{num}}$，并将其与基于混合长理论推导的物理涡度扩散系数 $K_h$ 进行量级比较。这个实践提供了一个至关重要的警示：在某些情况下，数值误差引入的虚假扩散可能远大于我们试图参数化的真实物理湍流效应，这对模型的设计和结果的解释具有深远影响 。",
            "id": "4082715",
            "problem": "考虑一个水平均匀、中性层结的大气边界层（ABL）。设一个被动标量场 $c(x,t)$ 被一个沿 $x$ 方向的恒定平均风 $u>0$ 平流，其遵循连续平流方程 $\\partial c / \\partial t + u \\, \\partial c / \\partial x = 0$。假设此平流过程在一个均匀网格上进行离散化，空间步长为 $\\Delta x$，时间步长为 $\\Delta t$，空间上采用一阶迎风格式，时间上采用前向欧拉格式。在雷诺平均下，湍流标量通量通过顺梯度闭合方案 $\\overline{w' c'} = - K_h \\, \\partial \\overline{c}/\\partial z$ 进行建模，其中 $K_h$ 是物理标量涡动扩散系数。采用混合长度理论，取 $l = \\kappa z$，其中 $\\kappa$ 是 von Kármán 常数，并且在地表层为中性条件，因此平均风切变满足 $\\partial \\overline{U}/\\partial z = u_* / (\\kappa z)$，其中 $u_*$ 是摩擦速度。假设湍流普朗特数等于 $1$，因此在中性条件下，标量扩散系数等于动量扩散系数。\n\n基于以上基础：\n- 推导一阶迎风平流格式的主阶修正方程，并确定等效数值扩散系数 $K_{\\text{num}}$（单位为 $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$），它是在该修正方程中乘以 $\\partial^2 c/\\partial x^2$ 的系数。\n- 使用雷诺平均和混合长度闭合方案，推导在高度 $z$ 处的物理标量涡动扩散系数 $K_h$（单位为 $\\mathrm{m}^2\\,\\mathrm{s}^{-1}$）。\n\n对于以下典型的大气边界层和数值模型参数：$u = 10 \\,\\mathrm{m}\\,\\mathrm{s}^{-1}$，$\\Delta x = 1000 \\,\\mathrm{m}$，$\\Delta t = 60 \\,\\mathrm{s}$， $z = 100 \\,\\mathrm{m}$，$u_* = 0.30 \\,\\mathrm{m}\\,\\mathrm{s}^{-1}$ 以及 $\\kappa = 0.40$，计算 $K_{\\text{num}}$ 和 $K_h$ 的值，并构成无量纲比率 $R = K_{\\text{num}}/K_h$。将您的最终答案表示为单个无量纲数 $R$，并将您的答案四舍五入到三位有效数字。",
            "solution": "所述问题是有效的。它在科学上基于流体动力学、数值分析和大气边界层理论的原理。该问题是适定的，为获得唯一解提供了所有必要的数据和定义。其语言客观清晰。\n\n解答过程分为三个部分：首先，推导数值扩散系数 $K_{\\text{num}}$；其次，推导物理涡动扩散系数 $K_h$；最后，计算它们的比率 $R$。\n\n第 1 部分：数值扩散系数 $K_{\\text{num}}$ 的推导\n\n被动标量 $c$ 的控制平流方程由下式给出：\n$$\n\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = 0\n$$\n该方程使用时间前向、空间一阶迎风的格式进行离散化。对于时间导数 $\\partial c / \\partial t$ 的前向欧拉时间差分格式为：\n$$\n\\frac{\\partial c}{\\partial t} \\approx \\frac{c_i^{n+1} - c_i^n}{\\Delta t}\n$$\n其中 $n$ 是时间索引，$i$ 是空间索引。由于平均风 $u$ 为正 ($u>0$)，对于空间导数 $\\partial c / \\partial x$ 的一阶迎风格式使用上游网格点 $i-1$ 的值：\n$$\n\\frac{\\partial c}{\\partial x} \\approx \\frac{c_i^n - c_{i-1}^n}{\\Delta x}\n$$\n将这些代入控制方程，得到完全离散化的形式：\n$$\n\\frac{c_i^{n+1} - c_i^n}{\\Delta t} + u \\frac{c_i^n - c_{i-1}^n}{\\Delta x} = 0\n$$\n为了找到修正方程，我们对 $c_i^{n+1}$ 和 $c_{i-1}^n$ 在点 $(x_i, t_n)$ 周围进行泰勒级数展开：\n$$\nc_i^{n+1} = c(x_i, t_n + \\Delta t) = c + \\Delta t \\frac{\\partial c}{\\partial t} + \\frac{(\\Delta t)^2}{2!} \\frac{\\partial^2 c}{\\partial t^2} + O((\\Delta t)^3)\n$$\n$$\nc_{i-1}^n = c(x_i - \\Delta x, t_n) = c - \\Delta x \\frac{\\partial c}{\\partial x} + \\frac{(\\Delta x)^2}{2!} \\frac{\\partial^2 c}{\\partial x^2} - \\frac{(\\Delta x)^3}{3!} \\frac{\\partial^3 c}{\\partial x^3} + O((\\Delta x)^4)\n$$\n其中所有偏导数都在 $(x_i, t_n)$ 处求值。将这些展开式代入离散方程：\n$$\n\\frac{1}{\\Delta t} \\left( \\Delta t \\frac{\\partial c}{\\partial t} + \\frac{(\\Delta t)^2}{2} \\frac{\\partial^2 c}{\\partial t^2} + \\dots \\right) + \\frac{u}{\\Delta x} \\left( c - \\left(c - \\Delta x \\frac{\\partial c}{\\partial x} + \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 c}{\\partial x^2} - \\dots \\right) \\right) = 0\n$$\n简化表达式：\n$$\n\\left( \\frac{\\partial c}{\\partial t} + \\frac{\\Delta t}{2} \\frac{\\partial^2 c}{\\partial t^2} + \\dots \\right) + u \\left( \\frac{\\partial c}{\\partial x} - \\frac{\\Delta x}{2} \\frac{\\partial^2 c}{\\partial x^2} + \\dots \\right) = 0\n$$\n重新整理以匹配原始偏微分方程加上高阶项的形式：\n$$\n\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = - \\frac{\\Delta t}{2} \\frac{\\partial^2 c}{\\partial t^2} + \\frac{u \\Delta x}{2} \\frac{\\partial^2 c}{\\partial x^2} + \\text{H.O.T.}\n$$\n右边的项是主阶截断误差。为了仅用空间导数来表示它，我们对原始偏微分方程 $\\partial c / \\partial t = -u \\, \\partial c / \\partial x$ 对时间求导：\n$$\n\\frac{\\partial^2 c}{\\partial t^2} = \\frac{\\partial}{\\partial t} \\left( -u \\frac{\\partial c}{\\partial x} \\right) = -u \\frac{\\partial}{\\partial x} \\left( \\frac{\\partial c}{\\partial t} \\right)\n$$\n再次代入 $\\partial c / \\partial t = -u \\, \\partial c / \\partial x$：\n$$\n\\frac{\\partial^2 c}{\\partial t^2} = -u \\frac{\\partial}{\\partial x} \\left( -u \\frac{\\partial c}{\\partial x} \\right) = u^2 \\frac{\\partial^2 c}{\\partial x^2}\n$$\n现在，将此结果代回截断误差表达式中：\n$$\n\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = - \\frac{\\Delta t}{2} \\left( u^2 \\frac{\\partial^2 c}{\\partial x^2} \\right) + \\frac{u \\Delta x}{2} \\frac{\\partial^2 c}{\\partial x^2} + \\text{H.O.T.}\n$$\n$$\n\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = \\left( \\frac{u \\Delta x}{2} - \\frac{u^2 \\Delta t}{2} \\right) \\frac{\\partial^2 c}{\\partial x^2} + \\text{H.O.T.}\n$$\n修正方程表明，数值格式隐式地引入了一个类似扩散的项。二阶空间导数的系数就是数值扩散系数 $K_{\\text{num}}$：\n$$\nK_{\\text{num}} = \\frac{u \\Delta x}{2} - \\frac{u^2 \\Delta t}{2} = \\frac{u \\Delta x}{2} \\left( 1 - \\frac{u \\Delta t}{\\Delta x} \\right)\n$$\n\n第 2 部分：物理涡动扩散系数 $K_h$ 的推导\n\n被动标量的物理涡动扩散系数 $K_h$ 是湍流标量通量的顺梯度闭合模型的一部分：\n$$\n\\overline{w' c'} = - K_h \\frac{\\partial \\overline{c}}{\\partial z}\n$$\n给定湍流普朗特数 $Pr_t = K_m / K_h$ 等于 $1$。这意味着标量扩散系数 $K_h$ 等于动量扩散系数 $K_m$。\n动量扩散系数 $K_m$ 将雷诺应力（垂直方向的湍流动量通量）与平均速度梯度联系起来：\n$$\n\\overline{u' w'} = - K_m \\frac{\\partial \\overline{U}}{\\partial z}\n$$\n摩擦速度 $u_*$ 由地表雷诺应力定义为 $u_*^2 = - \\overline{u' w'}_{\\text{surface}}$。假设在地表层中应力随高度保持不变，我们有 $u_*^2 = - \\overline{u' w'}$。\n结合这两个关系式可得：\n$$\nu_*^2 = K_m \\frac{\\partial \\overline{U}}{\\partial z}\n$$\n我们可以解出 $K_m$：\n$$\nK_m = \\frac{u_*^2}{\\partial \\overline{U}/\\partial z}\n$$\n问题指明了中性层结地表层的平均风切变廓线：\n$$\n\\frac{\\partial \\overline{U}}{\\partial z} = \\frac{u_*}{\\kappa z}\n$$\n其中 $\\kappa$ 是 von Kármán 常数，$z$ 是地表以上的高度。将此廓线代入 $K_m$ 的表达式中：\n$$\nK_m = \\frac{u_*^2}{u_*/(\\kappa z)} = \\kappa u_* z\n$$\n由于 $K_h = K_m$（因为 $Pr_t = 1$），物理标量涡动扩散系数为：\n$$\nK_h = \\kappa u_* z\n$$\n\n第 3 部分：比率 $R$ 的计算\n\n我们需要计算无量纲比率 $R = K_{\\text{num}}/K_h$。给定的参数是：\n$u = 10 \\,\\mathrm{m}\\,\\mathrm{s}^{-1}$\n$\\Delta x = 1000 \\,\\mathrm{m}$\n$\\Delta t = 60 \\,\\mathrm{s}$\n$z = 100 \\,\\mathrm{m}$\n$u_* = 0.30 \\,\\mathrm{m}\\,\\mathrm{s}^{-1}$\n$\\kappa = 0.40$\n\n首先，我们计算 $K_{\\text{num}}$：\n$$\nK_{\\text{num}} = \\frac{u \\Delta x}{2} \\left( 1 - \\frac{u \\Delta t}{\\Delta x} \\right)\n$$\n$$\nK_{\\text{num}} = \\frac{(10 \\,\\mathrm{m}\\,\\mathrm{s}^{-1})(1000 \\,\\mathrm{m})}{2} \\left( 1 - \\frac{(10 \\,\\mathrm{m}\\,\\mathrm{s}^{-1})(60 \\,\\mathrm{s})}{1000 \\,\\mathrm{m}} \\right)\n$$\n$$\nK_{\\text{num}} = 5000 \\,\\mathrm{m}^2\\,\\mathrm{s}^{-1} \\left( 1 - \\frac{600}{1000} \\right) = 5000 \\,\\mathrm{m}^2\\,\\mathrm{s}^{-1} (1 - 0.6)\n$$\n$$\nK_{\\text{num}} = 5000 \\,\\mathrm{m}^2\\,\\mathrm{s}^{-1} (0.4) = 2000 \\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}\n$$\n接下来，我们计算 $K_h$：\n$$\nK_h = \\kappa u_* z = (0.40)(0.30 \\,\\mathrm{m}\\,\\mathrm{s}^{-1})(100 \\,\\mathrm{m})\n$$\n$$\nK_h = 12 \\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}\n$$\n最后，我们计算比率 $R$：\n$$\nR = \\frac{K_{\\text{num}}}{K_h} = \\frac{2000 \\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}}{12 \\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}} = \\frac{500}{3} \\approx 166.666...\n$$\n将结果四舍五入到三位有效数字，得到 $167$。这个结果凸显出，对于典型的粗分辨率大气模型，一个简单平流格式所产生的数值扩散可能比它意图表示的物理次网格尺度湍流扩散大几个数量级，这是数值模拟中的一个主要挑战。",
            "answer": "$$\\boxed{167}$$"
        }
    ]
}