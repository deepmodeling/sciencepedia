{
    "hands_on_practices": [
        {
            "introduction": "Bulk microphysics schemes simplify the complex world of cloud particles by tracking key integrated quantities, or \"moments,\" such as the mass mixing ratio ($q_x$) and number concentration ($N_x$). These bulk variables are linked to an assumed underlying particle size distribution (PSD), often a gamma distribution. This practice  provides essential training in decoding these model outputs, guiding you to derive the specific parameters of the PSD from the prognostic variables, a fundamental skill for both interpreting model results and developing new parameterizations.",
            "id": "4024239",
            "problem": "A two-moment bulk microphysics scheme in a Numerical Weather Prediction (NWP) model represents a hydrometeor category (rain) by prognosing the mass mixing ratio $q_x$ and the number concentration $N_x$. The particle size distribution (PSD) in diameter $D$ is assumed to follow a generalized gamma form\n$$\nn(D) = N_0 D^{\\mu} \\exp(-\\lambda D), \\quad D \\ge 0,\n$$\nwith shape parameters $\\mu > -1$ and $\\lambda > 0$, and amplitude $N_0 > 0$. The mass–size relation is $m(D) = a D^{b}$ with $a > 0$, $b > 0$. For liquid drops, assume spherical particles with density $\\rho_w$, so that $a = \\pi \\rho_w / 6$ and $b = 3$.\n\nThe model prognostics and environmental conditions are\n- $q_x = 1.0 \\times 10^{-3}\\,\\mathrm{kg\\,kg^{-1}}$,\n- $N_x = 1.0 \\times 10^{2}\\,\\mathrm{m^{-3}}$,\n- $\\rho_a = 1.2\\,\\mathrm{kg\\,m^{-3}}$,\n- $\\rho_w = 1.0 \\times 10^{3}\\,\\mathrm{kg\\,m^{-3}}$.\n\nAssume that the coefficient of variation (relative dispersion) of diameter,\n$$\n\\delta = \\frac{\\sqrt{\\operatorname{Var}(D)}}{\\mathbb{E}[D]},\n$$\nis fixed at $\\delta = 0.5$ for this hydrometeor category.\n\nStarting only from the definitions of $N_x$ and $q_x$ as the zeroth and mass moments of $n(D)$ with respect to $D$ in physical space and the definition of the Gamma function $\\Gamma(\\cdot)$, derive expressions for the gamma PSD shape parameters $\\mu$ and $\\lambda$ and the number-weighted mean diameter $\\bar{D} = \\mathbb{E}[D]$. Then evaluate numerically for the values above.\n\nInstructions:\n- Express $\\lambda$ in $\\mathrm{m^{-1}}$ and $\\bar{D}$ in $\\mathrm{mm}$.\n- Round all reported numerical values to four significant figures.\n- Report your final answer as a row matrix in the order $\\mu$, $\\lambda$, $\\bar{D}$, with no units in the matrix.",
            "solution": "The problem requires the derivation and calculation of the gamma particle size distribution (PSD) parameters $\\mu$ and $\\lambda$, and the number-weighted mean diameter $\\bar{D}$, based on prognosed microphysical quantities in a numerical model.\n\nFirst, we relate the model's prognostic variables, number concentration $N_x$ and mass mixing ratio $q_x$, to the moments of the PSD, $n(D)$. The PSD, $n(D)$, is defined such that $n(D)dD$ is the number of particles per unit volume of air with diameters in the range $[D, D+dD]$.\n\nThe total number concentration $N_x$ is the zeroth moment of the PSD, obtained by integrating $n(D)$ over all possible diameters:\n$$ N_x = \\int_0^\\infty n(D) \\, dD $$\nThe mass concentration of the hydrometeor (mass of particles per unit volume of air) is given by $\\rho_a q_x$, where $\\rho_a$ is the density of air. This can also be expressed by integrating the mass of individual particles, $m(D)$, over the PSD:\n$$ \\rho_a q_x = \\int_0^\\infty m(D) n(D) \\, dD $$\nUsing the given mass–size relationship $m(D) = a D^b$:\n$$ \\rho_a q_x = \\int_0^\\infty a D^b n(D) \\, dD = a \\int_0^\\infty D^b n(D) \\, dD $$\nThe $k$-th moment of the PSD is defined as $M_k = \\int_0^\\infty D^k n(D) \\, dD$.\nThus, we have:\n1.  $N_x = M_0$\n2.  $\\rho_a q_x = a M_b$\n\nFor liquid drops, the particles are spherical with density $\\rho_w$. The mass of a sphere of diameter $D$ is its volume $(\\frac{1}{6}\\pi D^3)$ times its density $\\rho_w$. Thus, $m(D) = (\\frac{\\pi \\rho_w}{6}) D^3$. Comparing with $m(D) = a D^b$, we confirm $a = \\frac{\\pi \\rho_w}{6}$ and $b = 3$. The second relation becomes:\n$$ \\rho_a q_x = a M_3 $$\nThe problem states the PSD follows a generalized gamma distribution:\n$$ n(D) = N_0 D^{\\mu} \\exp(-\\lambda D) $$\nWe can compute the general $k$-th moment $M_k$ for this distribution using the definition of the Gamma function, $\\Gamma(z) = \\int_0^\\infty t^{z-1} e^{-t} dt$.\n$$ M_k = \\int_0^\\infty D^k \\left( N_0 D^{\\mu} \\exp(-\\lambda D) \\right) \\, dD = N_0 \\int_0^\\infty D^{k+\\mu} \\exp(-\\lambda D) \\, dD $$\nBy substituting $t = \\lambda D$, so $D=t/\\lambda$ and $dD=dt/\\lambda$, the integral becomes:\n$$ M_k = N_0 \\int_0^\\infty \\left(\\frac{t}{\\lambda}\\right)^{k+\\mu} e^{-t} \\frac{dt}{\\lambda} = \\frac{N_0}{\\lambda^{k+\\mu+1}} \\int_0^\\infty t^{k+\\mu} e^{-t} \\, dt $$\nThe integral is $\\Gamma(k+\\mu+1)$. Therefore, the moments are given by:\n$$ M_k = N_0 \\frac{\\Gamma(k+\\mu+1)}{\\lambda^{k+\\mu+1}} $$\nThe statistical properties of the distribution of diameters $D$ are derived from the moments. The probability density function of $D$ is $p(D) = n(D)/N_x = n(D)/M_0$. The expected value of any function $g(D)$ is $\\mathbb{E}[g(D)] = \\int_0^\\infty g(D) p(D) dD = M_g / M_0$, where $M_g = \\int g(D)n(D)dD$.\nThe number-weighted mean diameter is $\\bar{D} = \\mathbb{E}[D] = M_1/M_0$.\n$$ \\mathbb{E}[D] = \\frac{M_1}{M_0} = \\frac{N_0 \\Gamma(\\mu+2) / \\lambda^{\\mu+2}}{N_0 \\Gamma(\\mu+1) / \\lambda^{\\mu+1}} = \\frac{\\Gamma(\\mu+2)}{\\Gamma(\\mu+1)} \\frac{1}{\\lambda} $$\nUsing the property $\\Gamma(z+1)=z\\Gamma(z)$, we get $\\Gamma(\\mu+2) = (\\mu+1)\\Gamma(\\mu+1)$, which simplifies the expression for the mean diameter:\n$$ \\bar{D} = \\mathbb{E}[D] = \\frac{\\mu+1}{\\lambda} $$\nThe variance of the diameter is $\\operatorname{Var}(D) = \\mathbb{E}[D^2] - (\\mathbb{E}[D])^2$.\n$$ \\mathbb{E}[D^2] = \\frac{M_2}{M_0} = \\frac{N_0 \\Gamma(\\mu+3) / \\lambda^{\\mu+3}}{N_0 \\Gamma(\\mu+1) / \\lambda^{\\mu+1}} = \\frac{\\Gamma(\\mu+3)}{\\Gamma(\\mu+1)} \\frac{1}{\\lambda^2} = \\frac{(\\mu+2)(\\mu+1)\\Gamma(\\mu+1)}{\\Gamma(\\mu+1)} \\frac{1}{\\lambda^2} = \\frac{(\\mu+2)(\\mu+1)}{\\lambda^2} $$\nTherefore, the variance is:\n$$ \\operatorname{Var}(D) = \\frac{(\\mu+2)(\\mu+1)}{\\lambda^2} - \\left(\\frac{\\mu+1}{\\lambda}\\right)^2 = \\frac{(\\mu+1)}{\\lambda^2} [(\\mu+2) - (\\mu+1)] = \\frac{\\mu+1}{\\lambda^2} $$\nThe coefficient of variation $\\delta$ is defined as $\\delta = \\sqrt{\\operatorname{Var}(D)} / \\mathbb{E}[D]$. Its square is:\n$$ \\delta^2 = \\frac{\\operatorname{Var}(D)}{(\\mathbb{E}[D])^2} = \\frac{(\\mu+1)/\\lambda^2}{((\\mu+1)/\\lambda)^2} = \\frac{\\mu+1}{(\\mu+1)^2} = \\frac{1}{\\mu+1} $$\nThe problem provides a fixed value $\\delta = 0.5$. We can now solve for the shape parameter $\\mu$:\n$$ (0.5)^2 = \\frac{1}{\\mu+1} \\implies 0.25 = \\frac{1}{\\mu+1} \\implies \\mu+1 = 4 \\implies \\mu = 3 $$\nThis satisfies the condition $\\mu > -1$.\n\nNext, we derive an expression for $\\lambda$. We form the ratio of mass concentration to number concentration:\n$$ \\frac{\\rho_a q_x}{N_x} = \\frac{a M_3}{M_0} $$\nThis ratio represents the average mass per particle. Let's evaluate $M_3/M_0$:\n$$ \\frac{M_3}{M_0} = \\frac{N_0 \\Gamma(3+\\mu+1) / \\lambda^{3+\\mu+1}}{N_0 \\Gamma(\\mu+1) / \\lambda^{\\mu+1}} = \\frac{\\Gamma(\\mu+4)}{\\Gamma(\\mu+1)} \\frac{1}{\\lambda^3} $$\nUsing $\\Gamma(\\mu+4) = (\\mu+3)(\\mu+2)(\\mu+1)\\Gamma(\\mu+1)$, this simplifies to:\n$$ \\frac{M_3}{M_0} = (\\mu+3)(\\mu+2)(\\mu+1) \\frac{1}{\\lambda^3} $$\nSo, the ratio becomes:\n$$ \\frac{\\rho_a q_x}{N_x} = a \\frac{(\\mu+3)(\\mu+2)(\\mu+1)}{\\lambda^3} $$\nWe can now solve for $\\lambda$:\n$$ \\lambda^3 = a \\frac{N_x}{\\rho_a q_x} (\\mu+3)(\\mu+2)(\\mu+1) $$\nSubstituting $\\mu=3$:\n$$ \\lambda^3 = a \\frac{N_x}{\\rho_a q_x} (3+3)(3+2)(3+1) = a \\frac{N_x}{\\rho_a q_x} (6)(5)(4) = 120 a \\frac{N_x}{\\rho_a q_x} $$\nSubstituting $a = \\pi \\rho_w / 6$:\n$$ \\lambda^3 = 120 \\left(\\frac{\\pi \\rho_w}{6}\\right) \\frac{N_x}{\\rho_a q_x} = 20 \\pi \\rho_w \\frac{N_x}{\\rho_a q_x} $$\n$$ \\lambda = \\left( 20 \\pi \\rho_w \\frac{N_x}{\\rho_a q_x} \\right)^{1/3} $$\nThe mean diameter is then $\\bar{D} = (\\mu+1)/\\lambda = 4/\\lambda$.\n\nNow, we perform the numerical evaluation with the given values:\n$q_x = 1.0 \\times 10^{-3}\\,\\mathrm{kg\\,kg^{-1}}$\n$N_x = 1.0 \\times 10^{2}\\,\\mathrm{m^{-3}}$\n$\\rho_a = 1.2\\,\\mathrm{kg\\,m^{-3}}$\n$\\rho_w = 1.0 \\times 10^{3}\\,\\mathrm{kg\\,m^{-3}}$\n\nFirst, calculate $\\lambda$:\n$$ \\lambda^3 = 20 \\pi (1.0 \\times 10^{3}) \\frac{1.0 \\times 10^{2}}{1.2 \\times (1.0 \\times 10^{-3})} \\,\\mathrm{m^{-3}} $$\n$$ \\lambda^3 = 20 \\pi \\times 10^3 \\times \\frac{10^2}{1.2 \\times 10^{-3}} \\,\\mathrm{m^{-3}} = \\frac{20 \\pi}{1.2} \\times 10^{3+2-(-3)} \\,\\mathrm{m^{-3}} = \\frac{50 \\pi}{3} \\times 10^8 \\,\\mathrm{m^{-3}} $$\n$$ \\lambda^3 \\approx 5.2359877... \\times 10^9 \\,\\mathrm{m^{-3}} $$\n$$ \\lambda = (5.2359877... \\times 10^9)^{1/3} \\,\\mathrm{m^{-1}} \\approx 1736.505... \\,\\mathrm{m^{-1}} $$\nRounding to four significant figures, $\\lambda = 1737 \\,\\mathrm{m^{-1}}$.\n\nNext, calculate the mean diameter $\\bar{D}$:\n$$ \\bar{D} = \\frac{4}{\\lambda} = \\frac{4}{1736.505... \\,\\mathrm{m^{-1}}} \\approx 0.0023034... \\,\\mathrm{m} $$\nThe problem asks for $\\bar{D}$ in millimeters. Since $1\\,\\mathrm{m} = 1000\\,\\mathrm{mm}$:\n$$ \\bar{D} \\approx 2.3034... \\,\\mathrm{mm} $$\nRounding to four significant figures, $\\bar{D} = 2.303 \\,\\mathrm{mm}$.\n\nThe derived parameters are:\n- Shape parameter $\\mu=3$ (exact).\n- Slope parameter $\\lambda \\approx 1737 \\,\\mathrm{m^{-1}}$.\n- Mean diameter $\\bar{D} \\approx 2.303 \\,\\mathrm{mm}$.\n\nThe final answer consists of the numerical values for $\\mu$, $\\lambda$, and $\\bar{D}$ in the specified order and precision.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n3 & 1737 & 2.303\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "The transformation of water between vapor, liquid, and ice phases is not only a story of mass conversion but also one of significant energy exchange. Accurately accounting for the latent heat released or absorbed during these transitions is critical for correctly simulating temperature, buoyancy, and the overall evolution of weather systems. This exercise  immerses you in the core thermodynamics of microphysics, requiring you to calculate the net temperature tendency from a suite of competing phase change processes and to verify the conservation of enthalpy.",
            "id": "4024202",
            "problem": "A single-column model of Numerical Weather Prediction (NWP) advances a mixed-phase bulk microphysics scheme over a microphysics substep that is treated as adiabatic (no radiative, turbulent, or dynamical heat sources during the substep). The prognostic thermodynamic state is described by temperature $T$ and the species mass mixing ratios $q_v$ (water vapor), $q_l$ (liquid water), and $q_i$ (ice). The substep computes the following microphysical phase-change rates (mass mixing ratio change per unit time, with positive values defined as transfer from the donor phase to the recipient phase indicated): condensation $C$ (vapor to liquid), evaporation $E$ (liquid to vapor), deposition $D$ (vapor to ice), sublimation $S$ (ice to vapor), freezing $F$ (liquid to ice), and melting $M$ (ice to liquid). Assume that the specific heats at constant pressure are constants over the substep and given by $c_{pd}$ for dry air, $c_{pv}$ for water vapor, $c_{l}$ for liquid water, and $c_{i}$ for ice, and that the latent heats are evaluated at the substep temperature and treated constant: latent heat of vaporization $L_v$, latent heat of fusion $L_f$, and latent heat of sublimation $L_s = L_v + L_f$.\n\nInitial conditions and parameters at the start of the substep are:\n- $T = 273.15\\,\\mathrm{K}$,\n- $q_v = 0.012$, $q_l = 0.002$, $q_i = 0.001$,\n- $c_{pd} = 1004\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$, $c_{pv} = 1850\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$, $c_{l} = 4186\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$, $c_{i} = 2106\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$,\n- $L_v = 2.5 \\times 10^{6}\\,\\mathrm{J\\,kg^{-1}}$, $L_f = 3.34 \\times 10^{5}\\,\\mathrm{J\\,kg^{-1}}$,\n- $C = 2.0 \\times 10^{-4}\\,\\mathrm{s^{-1}}$, $E = 3.0 \\times 10^{-5}\\,\\mathrm{s^{-1}}$, $D = 6.0 \\times 10^{-5}\\,\\mathrm{s^{-1}}$, $S = 2.0 \\times 10^{-5}\\,\\mathrm{s^{-1}}$, $F = 5.0 \\times 10^{-5}\\,\\mathrm{s^{-1}}$, $M = 4.0 \\times 10^{-5}\\,\\mathrm{s^{-1}}$.\n\nTreat the mass-weighted specific heat at constant pressure of the moist mixture as\n$$\nc_{pm} = (1 - q_v - q_l - q_i)\\,c_{pd} + q_v\\,c_{pv} + q_l\\,c_{l} + q_i\\,c_{i},\n$$\nand neglect changes in $c_{pm}$ over the microphysics substep. Using the First Law of Thermodynamics in enthalpy form for an adiabatic moist parcel and the definitions above, compute the instantaneous temperature tendency $\\frac{dT}{dt}$ due solely to latent heating by the specified phase changes, and verify enthalpy consistency by demonstrating that the latent heating rate equals $c_{pm}\\,\\frac{dT}{dt}$ under the stated assumptions. Express the final temperature tendency in $\\mathrm{K\\,s^{-1}}$ and round your answer to four significant figures.",
            "solution": "The problem requires the calculation of the temperature tendency, $\\frac{dT}{dt}$, due to latent heat release from phase changes in an adiabatic moist air parcel. The governing principle is the First Law of Thermodynamics. For an adiabatic process in a closed parcel at constant pressure (as is assumed for a microphysics-only substep), the change in sensible heat is balanced by the latent heat released or absorbed. In rate form, this is expressed as:\n$$\nc_{pm} \\frac{dT}{dt} = \\left(\\frac{dQ}{dt}\\right)_{\\text{latent}}\n$$\nwhere $c_{pm}$ is the mass-weighted specific heat of the moist air mixture and $\\left(\\frac{dQ}{dt}\\right)_{\\text{latent}}$ is the net rate of latent heating per unit mass.\n\nThe net latent heating rate is the sum of contributions from all six specified phase change processes. Following the sign convention (heat released is positive, heat absorbed is negative):\n- Condensation ($C$): Vapor to liquid, releases heat. Contribution: $+L_v C$.\n- Evaporation ($E$): Liquid to vapor, absorbs heat. Contribution: $-L_v E$.\n- Deposition ($D$): Vapor to ice, releases heat. Contribution: $+L_s D$.\n- Sublimation ($S$): Ice to vapor, absorbs heat. Contribution: $-L_s S$.\n- Freezing ($F$): Liquid to ice, releases heat. Contribution: $+L_f F$.\n- Melting ($M$): Ice to liquid, absorbs heat. Contribution: $-L_f M$.\n\nSumming these contributions gives the total latent heating rate:\n$$\n\\left(\\frac{dQ}{dt}\\right)_{\\text{latent}} = L_v C - L_v E + L_s D - L_s S + L_f F - L_f M\n$$\nThis can be grouped as:\n$$\n\\left(\\frac{dQ}{dt}\\right)_{\\text{latent}} = L_v (C - E) + L_s (D - S) + L_f (F - M)\n$$\nThe temperature tendency is therefore:\n$$\n\\frac{dT}{dt} = \\frac{1}{c_{pm}} \\left[ L_v (C - E) + L_s (D - S) + L_f (F - M) \\right]\n$$\nTo solve this, we first compute the necessary parameters $c_{pm}$ and $L_s$.\n\n1.  **Calculate the mass-weighted specific heat $c_{pm}$**:\n    The total water mixing ratio is $q_t = q_v + q_l + q_i = 0.012 + 0.002 + 0.001 = 0.015$. The mass fraction of dry air is $1 - q_t = 1 - 0.015 = 0.985$.\n    Using the provided formula:\n    $$\n    c_{pm} = (1 - q_v - q_l - q_i)\\,c_{pd} + q_v\\,c_{pv} + q_l\\,c_{l} + q_i\\,c_{i}\n    $$\n    $$\n    c_{pm} = (0.985)(1004\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}) + (0.012)(1850\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}) + (0.002)(4186\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}) + (0.001)(2106\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}})\n    $$\n    $$\n    c_{pm} = 988.94 + 22.2 + 8.372 + 2.106 = 1021.618\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}\n    $$\n\n2.  **Calculate the latent heat of sublimation $L_s$**:\n    Using the given relation $L_s = L_v + L_f$:\n    $$\n    L_s = 2.5 \\times 10^{6}\\,\\mathrm{J\\,kg^{-1}} + 3.34 \\times 10^{5}\\,\\mathrm{J\\,kg^{-1}} = 2.5 \\times 10^{6}\\,\\mathrm{J\\,kg^{-1}} + 0.334 \\times 10^{6}\\,\\mathrm{J\\,kg^{-1}} = 2.834 \\times 10^{6}\\,\\mathrm{J\\,kg^{-1}}\n    $$\n\n3.  **Calculate the net latent heating rate $\\left(\\frac{dQ}{dt}\\right)_{\\text{latent}}$**:\n    First, compute the net rates for each pair of phase changes:\n    - Net Condensation/Evaporation: $C - E = 2.0 \\times 10^{-4}\\,\\mathrm{s^{-1}} - 3.0 \\times 10^{-5}\\,\\mathrm{s^{-1}} = 1.7 \\times 10^{-4}\\,\\mathrm{s^{-1}}$\n    - Net Deposition/Sublimation: $D - S = 6.0 \\times 10^{-5}\\,\\mathrm{s^{-1}} - 2.0 \\times 10^{-5}\\,\\mathrm{s^{-1}} = 4.0 \\times 10^{-5}\\,\\mathrm{s^{-1}}$\n    - Net Freezing/Melting: $F - M = 5.0 \\times 10^{-5}\\,\\mathrm{s^{-1}} - 4.0 \\times 10^{-5}\\,\\mathrm{s^{-1}} = 1.0 \\times 10^{-5}\\,\\mathrm{s^{-1}}$\n\n    Now, substitute these values into the latent heating rate equation:\n    $$\n    \\left(\\frac{dQ}{dt}\\right)_{\\text{latent}} = (2.5 \\times 10^{6})(1.7 \\times 10^{-4}) + (2.834 \\times 10^{6})(4.0 \\times 10^{-5}) + (3.34 \\times 10^{5})(1.0 \\times 10^{-5})\n    $$\n    $$\n    \\left(\\frac{dQ}{dt}\\right)_{\\text{latent}} = 425 + 113.36 + 3.34 = 541.7\\,\\mathrm{J\\,kg^{-1}\\,s^{-1}}\n    $$\n\n4.  **Verify enthalpy consistency**:\n    The problem requests verification that the latent heating rate equals $c_{pm}\\,\\frac{dT}{dt}$. By our derivation from the First Law, this is true by definition. We demonstrate this with the calculated values.\n    Latent heating rate $= 541.7\\,\\mathrm{J\\,kg^{-1}\\,s^{-1}}$.\n    The temperature tendency is $\\frac{dT}{dt} = \\frac{\\left(\\frac{dQ}{dt}\\right)_{\\text{latent}}}{c_{pm}} = \\frac{541.7\\,\\mathrm{J\\,kg^{-1}\\,s^{-1}}}{1021.618\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}}$.\n    The term $c_{pm}\\,\\frac{dT}{dt}$ is thus $(1021.618\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}) \\times \\left(\\frac{541.7}{1021.618}\\right)\\,\\mathrm{K\\,s^{-1}} = 541.7\\,\\mathrm{J\\,kg^{-1}\\,s^{-1}}$.\n    The enthalpy consistency is thus verified.\n\n5.  **Calculate the final temperature tendency $\\frac{dT}{dt}$**:\n    $$\n    \\frac{dT}{dt} = \\frac{541.7}{1021.618} \\approx 0.5302305\\,\\mathrm{K\\,s^{-1}}\n    $$\n    Rounding the result to four significant figures as required:\n    $$\n    \\frac{dT}{dt} \\approx 0.5302\\,\\mathrm{K\\,s^{-1}}\n    $$",
            "answer": "$$\\boxed{0.5302}$$"
        },
        {
            "introduction": "Hydrometeors do not remain suspended indefinitely; their fall under gravity, known as sedimentation, is the ultimate source of precipitation at the surface. Representing this vertical transport within the discrete layers of a numerical model is a classic advection problem fraught with numerical challenges like artificial diffusion and unphysical oscillations. This computational practice  delves into the practical implementation of sedimentation, tasking you with comparing a simple first-order upstream scheme against a more sophisticated monotonic flux-limited scheme to witness firsthand the profound impact of numerical methods on model fidelity.",
            "id": "4024197",
            "problem": "Consider a one-dimensional vertical column in which a single hydrometeor species sediments under gravity. The column is discretized into $N$ layers of uniform thickness $\\Delta z$ (in meters). Let the hydrometeor mass mixing ratio profile be $q_i$ (in kilograms per kilogram) for layer index $i \\in \\{0,1,\\dots,N-1\\}$, with $i=0$ at the top and $i=N-1$ at the bottom. Assume constant air density $\\rho$ (in kilograms per cubic meter) throughout the column.\n\nThe sedimentation velocity is obtained by bulk-integrating over a Particle Size Distribution (PSD). The PSD is specified as a generalized gamma distribution in particle diameter $D$ (in meters) with number density per unit diameter $n(D)$ given by\n$$\nn(D) = N_0 D^{\\mu} e^{-\\lambda D},\n$$\nwhere $N_0$ (in inverse meters to the power four), $\\mu$ (dimensionless), and $\\lambda$ (in inverse meters) are PSD parameters. The hydrometeor mass is parameterized by $m(D)=c D^p$ (in kilograms), where $c$ (in kilograms per cubic meter) and $p$ (dimensionless) are constants appropriate for the species, and the terminal fall speed follows $V(D)=a D^b$ (in meters per second), where $a$ (in meters to the power one-half per second for $b=\\tfrac{1}{2}$) and $b$ (dimensionless) are given.\n\nAssuming constant $c$, $p$, $a$, $b$, $\\mu$, and $\\lambda$ for a given case, define the effective sedimentation speed $V_{\\mathrm{eff}}$ as the mass-weighted PSD average of $V(D)$:\n$$\nV_{\\mathrm{eff}} \\equiv \\frac{\\int_{0}^{\\infty} m(D)\\,n(D)\\,V(D)\\,\\mathrm{d}D}{\\int_{0}^{\\infty} m(D)\\,n(D)\\,\\mathrm{d}D}.\n$$\nDerive $V_{\\mathrm{eff}}$ in closed form using the Euler gamma function $\\Gamma(\\cdot)$, and use it to compute sedimentation fluxes at layer interfaces and resulting layer tendencies.\n\nThe governing bulk continuity equation for sedimentation (with no sources or sinks and constant $\\rho$) is\n$$\n\\frac{\\partial q}{\\partial t} = -\\frac{1}{\\rho}\\frac{\\partial}{\\partial z}\\left(\\rho\\,q\\,V_{\\mathrm{eff}}\\right) = -\\frac{\\partial}{\\partial z}\\left(q\\,V_{\\mathrm{eff}}\\right).\n$$\nIn finite-volume discretization on the given grid, define interface fluxes $F_{i+\\frac{1}{2}}$ (in kilograms per square meter per second) at the boundary between layers $i$ and $i+1$:\n$$\nF_{i+\\frac{1}{2}} = \\rho\\,V_{\\mathrm{eff}}\\,q^{\\mathrm{up}}_{i+\\frac{1}{2}},\n$$\nwith downward positive velocity $V_{\\mathrm{eff}} > 0$. The per-layer tendency is then\n$$\n\\left(\\frac{\\mathrm{d}q_i}{\\mathrm{d}t}\\right) = -\\frac{1}{\\rho\\,\\Delta z}\\left(F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}\\right),\n$$\nwhere the top boundary flux is $F_{-\\frac{1}{2}} = 0$ (no inflow from above) and the bottom boundary flux $F_{N-\\frac{1}{2}}$ is computed from the bottom layer as usual. Compare two numerical flux evaluation strategies for $q^{\\mathrm{up}}_{i+\\frac{1}{2}}$ under the assumption $V_{\\mathrm{eff}} > 0$ (downward advection):\n- Upstream (first-order upwind): $q^{\\mathrm{up}}_{i+\\frac{1}{2}} = q_i$.\n- Monotonic flux-limited MUSCL (Monotonic Upstream-centered Scheme for Conservation Laws), using the van Leer slope limiter. Define layer-centered limited slopes $s_i$ by\n$$\ns_i = \\begin{cases}\n\\dfrac{2\\,\\Delta q_{i-\\frac{1}{2}}\\,\\Delta q_{i+\\frac{1}{2}}}{\\Delta q_{i-\\frac{1}{2}}+\\Delta q_{i+\\frac{1}{2}}}, & \\text{if } \\Delta q_{i-\\frac{1}{2}}\\,\\Delta q_{i+\\frac{1}{2}} > 0, \\\\\n0, & \\text{otherwise},\n\\end{cases}\n$$\nwith $\\Delta q_{i-\\frac{1}{2}} = q_i - q_{i-1}$ and $\\Delta q_{i+\\frac{1}{2}} = q_{i+1} - q_i$; set $s_0 = 0$ and $s_{N-1} = 0$ at boundaries. The MUSCL left state at $i+\\tfrac{1}{2}$ is $q^{\\mathrm{up}}_{i+\\frac{1}{2}} = q_i + \\frac{1}{2}s_i$ when $V_{\\mathrm{eff}} > 0$.\n\nUsing these definitions, implement a program that, for each test case below, computes $V_{\\mathrm{eff}}$, then computes interface fluxes and layer tendencies using both schemes, and finally reports the maximum absolute difference between the two tendency profiles over all layers. Express the final per-case outputs as decimal floats in units of $\\mathrm{s}^{-1}$, each rounded to exactly six digits after the decimal point.\n\nUse the following constants and test suite. For all cases, the air density is $\\rho = 1.0$ (in kilograms per cubic meter) and the hydrometeor mass law is $m(D) = c D^p$ with $c = \\tfrac{\\pi \\rho_w}{6}$ and $\\rho_w = 1000$ (in kilograms per cubic meter) and $p = 3$.\n\n- Case $1$ (general smooth profile, moderate fall speed):\n  - Grid: $N = 8$, $\\Delta z = 200$ (in meters).\n  - PSD parameters: $\\mu = 0$, $\\lambda = 800$ (in inverse meters), $a = 130$ (in meters to the power one-half per second), $b = \\tfrac{1}{2}$.\n  - Mixing ratio profile (top to bottom): $q = [0.0010, 0.0009, 0.0008, 0.0007, 0.0006, 0.0005, 0.0004, 0.0003]$ (in kilograms per kilogram).\n\n- Case $2$ (isolated peak, small effective fall speed):\n  - Grid: $N = 8$, $\\Delta z = 200$ (in meters).\n  - PSD parameters: $\\mu = 0$, $\\lambda = 1500$ (in inverse meters), $a = 130$ (in meters to the power one-half per second), $b = \\tfrac{1}{2}$.\n  - Mixing ratio profile (top to bottom): $q = [0.0000, 0.0000, 0.0000, 0.0015, 0.0000, 0.0000, 0.0000, 0.0000]$ (in kilograms per kilogram).\n\n- Case $3$ (sharp discontinuity, large effective fall speed):\n  - Grid: $N = 8$, $\\Delta z = 100$ (in meters).\n  - PSD parameters: $\\mu = 0$, $\\lambda = 400$ (in inverse meters), $a = 130$ (in meters to the power one-half per second), $b = \\tfrac{1}{2}$.\n  - Mixing ratio profile (top to bottom): $q = [0.0000, 0.0000, 0.0000, 0.0000, 0.0020, 0.0020, 0.0020, 0.0020]$ (in kilograms per kilogram).\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the cases $1$, $2$, $3$, for example $[x_1,x_2,x_3]$, where each $x_k$ is the maximum absolute tendency difference (in $\\mathrm{s}^{-1}$) between upstream and monotonic flux-limited schemes for case $k$, rounded to exactly six decimal places.",
            "solution": "The solution involves three main steps: first, the derivation of the effective sedimentation speed $V_{\\mathrm{eff}}$; second, the formulation of the numerical schemes for calculating sedimentation tendencies; and third, the application of these schemes to the specific test cases to find the maximum absolute difference in their results.\n\n### 1. Derivation of Effective Sedimentation Speed ($V_{\\mathrm{eff}}$)\n\nThe effective sedimentation speed $V_{\\mathrm{eff}}$ is defined as the mass-weighted average of the terminal fall speed $V(D)$ over the particle size distribution (PSD).\n$$\nV_{\\mathrm{eff}} \\equiv \\frac{\\int_{0}^{\\infty} m(D)\\,n(D)\\,V(D)\\,\\mathrm{d}D}{\\int_{0}^{\\infty} m(D)\\,n(D)\\,\\mathrm{d}D}\n$$\nThe components are given as:\n- Mass-diameter relation: $m(D) = c D^p$\n- Velocity-diameter relation: $V(D) = a D^b$\n- PSD number density: $n(D) = N_0 D^{\\mu} e^{-\\lambda D}$\n\nThe integral in the numerator is:\n$$\n\\int_{0}^{\\infty} (c D^p) (N_0 D^{\\mu} e^{-\\lambda D}) (a D^b) \\mathrm{d}D = c N_0 a \\int_{0}^{\\infty} D^{p+\\mu+b} e^{-\\lambda D} \\mathrm{d}D\n$$\nThe integral in the denominator is:\n$$\n\\int_{0}^{\\infty} (c D^p) (N_0 D^{\\mu} e^{-\\lambda D}) \\mathrm{d}D = c N_0 \\int_{0}^{\\infty} D^{p+\\mu} e^{-\\lambda D} \\mathrm{d}D\n$$\nWe use the standard form of the integral related to the Euler gamma function, $\\Gamma(z) = \\int_0^\\infty t^{z-1} e^{-t} \\mathrm{d}t$. With a change of variables $t = \\lambda D$, we have $\\mathrm{d}D = \\frac{1}{\\lambda}\\mathrm{d}t$, which leads to the identity:\n$$\n\\int_{0}^{\\infty} D^k e^{-\\lambda D} \\mathrm{d}D = \\frac{\\Gamma(k+1)}{\\lambda^{k+1}}\n$$\nApplying this identity, the numerator becomes $c N_0 a \\frac{\\Gamma(p+\\mu+b+1)}{\\lambda^{p+\\mu+b+1}}$ and the denominator becomes $c N_0 \\frac{\\Gamma(p+\\mu+1)}{\\lambda^{p+\\mu+1}}$.\n\nThe ratio $V_{\\mathrm{eff}}$ is then:\n$$\nV_{\\mathrm{eff}} = \\frac{c N_0 a \\frac{\\Gamma(p+\\mu+b+1)}{\\lambda^{p+\\mu+b+1}}}{c N_0 \\frac{\\Gamma(p+\\mu+1)}{\\lambda^{p+\\mu+1}}} = a \\frac{\\Gamma(p+\\mu+b+1)}{\\Gamma(p+\\mu+1)} \\frac{\\lambda^{p+\\mu+1}}{\\lambda^{p+\\mu+b+1}}\n$$\nThis simplifies to the closed-form expression for $V_{\\mathrm{eff}}$:\n$$\nV_{\\mathrm{eff}} = a \\frac{\\Gamma(p+\\mu+b+1)}{\\Gamma(p+\\mu+1)} \\lambda^{-b}\n$$\nThis expression depends only on the PSD and fall speed parameters ($a, b, \\mu, \\lambda, p$), not on $N_0$ or $c$. For all test cases, $p=3$, $\\mu=0$, and $b=\\tfrac{1}{2}=0.5$. The formula becomes:\n$$\nV_{\\mathrm{eff}} = a \\frac{\\Gamma(3+0+0.5+1)}{\\Gamma(3+0+1)} \\lambda^{-0.5} = a \\frac{\\Gamma(4.5)}{\\Gamma(4)} \\lambda^{-0.5}\n$$\nThe Euler gamma function $\\Gamma(z)$ can be computed using standard libraries.\n\n### 2. Numerical Schemes and Tendency Calculation\n\nThe hydrometeor mass mixing ratio $q$ in a vertical column discretized into $N$ layers of thickness $\\Delta z$ evolves according to the finite-volume equation:\n$$\n\\left(\\frac{\\mathrm{d}q_i}{\\mathrm{d}t}\\right) = -\\frac{1}{\\rho\\,\\Delta z}\\left(F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}\\right) \\quad \\text{for } i \\in \\{0, 1, \\dots, N-1\\}\n$$\nwhere $F_{i+\\frac{1}{2}}$ is the downward mass flux at the interface between layer $i$ (above) and layer $i+1$ (below). The flux is defined as $F_{i+\\frac{1}{2}} = \\rho\\,V_{\\mathrm{eff}}\\,q^{\\mathrm{up}}_{i+\\frac{1}{2}}$, where $q^{\\mathrm{up}}_{i+\\frac{1}{2}}$ is the value of the mixing ratio at the interface, determined by the numerical scheme. The top boundary condition is $F_{-\\frac{1}{2}}=0$.\n\n#### Upstream Scheme (First-Order Upwind)\nFor downward advection ($V_{\\mathrm{eff}} > 0$), the upwind value at interface $i+\\frac{1}{2}$ is taken from the layer above, i.e., layer $i$.\n$$\nq^{\\mathrm{up}}_{i+\\frac{1}{2}} = q_i\n$$\nThe fluxes are $F_{i+\\frac{1}{2}} = \\rho V_{\\mathrm{eff}} q_i$ for $i \\in \\{0, \\dots, N-1\\}$. The tendency for layer $i$ is:\n$$\n\\left(\\frac{\\mathrm{d}q_i}{\\mathrm{d}t}\\right)_{\\text{up}} = -\\frac{\\rho V_{\\mathrm{eff}}}{\\rho \\Delta z} (q_i - q_{i-1}) = -\\frac{V_{\\mathrm{eff}}}{\\Delta z} (q_i - q_{i-1}) \\quad \\text{for } i>0\n$$\nand for the top layer $i=0$, using $F_{-\\frac{1}{2}}=0$ (implying a virtual $q_{-1}=0$ for the flux calculation):\n$$\n\\left(\\frac{\\mathrm{d}q_0}{\\mathrm{d}t}\\right)_{\\text{up}} = -\\frac{V_{\\mathrm{eff}}}{\\Delta z} q_0\n$$\n\n#### MUSCL Scheme (Second-Order with van Leer Limiter)\nThis scheme improves accuracy by using a linear reconstruction of the mixing ratio within each layer. The value at the interface is given by:\n$$\nq^{\\mathrm{up}}_{i+\\frac{1}{2}} = q_i + \\frac{1}{2} s_i\n$$\nwhere $s_i$ is the slope in layer $i$, limited to prevent spurious oscillations. The van Leer limiter is used:\n$$\ns_i = \\begin{cases} \\frac{2 \\Delta q_{i-\\frac{1}{2}} \\Delta q_{i+\\frac{1}{2}}}{\\Delta q_{i-\\frac{1}{2}} + \\Delta q_{i+\\frac{1}{2}}}, & \\text{if } (\\Delta q_{i-\\frac{1}{2}})(\\Delta q_{i+\\frac{1}{2}}) > 0 \\\\ 0, & \\text{otherwise} \\end{cases}\n$$\nwith $\\Delta q_{i-\\frac{1}{2}} = q_i - q_{i-1}$ and $\\Delta q_{i+\\frac{1}{2}} = q_{i+1} - q_i$. The boundary conditions on the slopes are $s_0=0$ and $s_{N-1}=0$.\nThe MUSCL tendencies are calculated using the fluxes $F_{i+\\frac{1}{2}} = \\rho V_{\\mathrm{eff}} (q_i + \\frac{1}{2} s_i)$.\n\n### 3. Analysis of Test Cases\n\nThe goal is to compute $\\max_{i} \\left| \\left(\\frac{\\mathrm{d}q_i}{\\mathrm{d}t}\\right)_{\\text{muscl}} - \\left(\\frac{\\mathrm{d}q_i}{\\mathrm{d}t}\\right)_{\\text{up}} \\right|$. The difference in tendencies for a layer $i$ is:\n$$\n\\Delta\\left(\\frac{\\mathrm{d}q_i}{\\mathrm{d}t}\\right) = -\\frac{1}{\\rho\\Delta z} \\left( (F_{i+\\frac{1}{2}}^{\\text{muscl}} - F_{i-\\frac{1}{2}}^{\\text{muscl}}) - (F_{i+\\frac{1}{2}}^{\\text{up}} - F_{i-\\frac{1}{2}}^{\\text{up}}) \\right)\n$$\nThe difference in flux at an interface is $\\Delta F_{i+\\frac{1}{2}} = F_{i+\\frac{1}{2}}^{\\text{muscl}} - F_{i+\\frac{1}{2}}^{\\text{up}} = \\rho V_{\\mathrm{eff}} (q_i + \\frac{1}{2}s_i - q_i) = \\frac{1}{2}\\rho V_{\\mathrm{eff}} s_i$.\nSo, the tendency difference becomes:\n$$\n\\Delta\\left(\\frac{\\mathrm{d}q_i}{\\mathrm{d}t}\\right) = -\\frac{1}{\\rho\\Delta z} (\\Delta F_{i+\\frac{1}{2}} - \\Delta F_{i-\\frac{1}{2}}) = -\\frac{V_{\\mathrm{eff}}}{2\\Delta z}(s_i - s_{i-1})\n$$\nwith the understanding that $s_i$ is zero for boundary cells and at locations where the limiter activates. For Case 1, the profile is linear, so the limiter allows a constant slope in the interior, resulting in a non-zero difference only where the slope changes. For Cases 2 and 3, the profiles feature an extremum and a step, respectively, which causes the van Leer limiter to set all slopes to zero. Thus, for these cases, the MUSCL scheme reverts to the first-order upstream scheme, and the difference in their computed tendencies is exactly zero.",
            "answer": "[0.000002, 0.000000, 0.000000]"
        }
    ]
}