{
    "hands_on_practices": [
        {
            "introduction": "莫宁-奥布霍夫相似性理论（MOST）是理解地表层的基石。本练习提供了实践机会，利用现实世界中的测量数据（例如来自涡动协方差通量塔的数据）来计算基本的大气边界层标度参数（$u_*$, $\\theta_*$, $L$）。掌握这项技能使我们能够表征地表层的稳定性和湍流状态，并预测近地面的廓线，这是气象学和气候模拟中的一项关键技能。",
            "id": "4075668",
            "problem": "在平坦地形上，一个水平均一、定常的白天地面层被一个位于 $z=\\;10\\,\\mathrm{m}$ 高度的涡动相关系统观测。测得的湍流地表应力大小为 $\\tau=\\;0.30\\,\\mathrm{N}\\,\\mathrm{m}^{-2}$，空气密度为 $\\rho=\\;1.20\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$，运动感热通量为 $w'\\theta'=\\;0.12\\,\\mathrm{K}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$，运动水汽通量（以比湿 $q$ 表示）为 $w'q'=\\;1.0\\times 10^{-5}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$。测量高度处的平均位温和比湿分别为 $\\bar{\\theta}=\\;300\\,\\mathrm{K}$ 和 $\\bar{q}=\\;0.010$。取 von Kármán 常数 $\\kappa=\\;0.40$，重力加速度 $g=\\;9.81\\,\\mathrm{m}\\,\\mathrm{s}^{-2}$。假设为干空气，液态水可忽略不计，并用 $\\bar{\\theta}_{v}\\approx \\bar{\\theta}\\left(1+0.61\\,\\bar{q}\\right)$ 和 $w'\\theta_{v}'\\approx w'\\theta'+0.61\\,\\bar{\\theta}\\,w'q'$ 来近似虚位温及其运动通量。\n\n使用 Monin–Obukhov 相似性理论 (MOST)，从第一性原理出发：\n- 从 $\\tau=\\rho\\,u_{*}^{2}$ 计算摩擦速度 $u_{*}$，\n- 从测得的运动通量计算温度尺度 $\\theta_{*}$ 和湿度尺度 $q_{*}$，\n- 从涉及 $u_{*}$ 和 $w'\\theta_{v}'$ 的定义推导 Obukhov 长度 $L$，以及\n- 使用通量-梯度关系预测在 $z=\\;5\\,\\mathrm{m}$ 高度处的局地位温梯度。\n\n对于稳定度函数，采用经过充分检验的 Businger–Dyer 形式：对于不稳定层结，$\\phi_{h}(\\zeta)=\\left(1-16\\,\\zeta\\right)^{-1/2}$；对于稳定层结，$\\phi_{h}(\\zeta)=1+5\\,\\zeta$，其中 $\\zeta=z/L$。\n\n仅报告在 $z=\\;5\\,\\mathrm{m}$ 处预测的局地位温梯度 $\\mathrm{d}\\theta/\\mathrm{d}z$。将您的答案四舍五入到三位有效数字。以 $\\mathrm{K}\\,\\mathrm{m}^{-1}$ 为单位表示最终梯度。",
            "solution": "该问题要求计算在白天大气地面层中 $z=5\\,\\mathrm{m}$ 高度处的局地位温梯度 $\\frac{\\mathrm{d}\\theta}{\\mathrm{d}z}$。求解过程涉及几个步骤，从 $z=10\\,\\mathrm{m}$ 处的给定测量值开始。在地面层内，湍流通量和 MOST 标度参数（$u_{*}$、$\\theta_{*}$、$L$）被假设为不随高度变化（常数）。\n\n首先，根据定义 $\\tau = \\rho u_{*}^{2}$，由湍流地表应力大小 $\\tau$ 和空气密度 $\\rho$ 计算摩擦速度 $u_{*}$。\n$$u_{*} = \\sqrt{\\frac{\\tau}{\\rho}}$$\n代入给定值 $\\tau = 0.30\\,\\mathrm{N}\\,\\mathrm{m}^{-2}$ 和 $\\rho = 1.20\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$：\n$$u_{*} = \\sqrt{\\frac{0.30}{1.20}} \\,\\mathrm{m}\\,\\mathrm{s}^{-1} = \\sqrt{0.25} \\,\\mathrm{m}\\,\\mathrm{s}^{-1} = 0.50\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$$\n\n第二，特征温度尺度 $\\theta_{*}$ 和特征湿度尺度 $q_{*}$ 由它们与运动通量的关系确定。一个标量的通量与其特征尺度和摩擦速度的关系为 $(w's')_s = -u_{*} s_{*}$，其中 $s$ 是标量，下标 $s$ 表示地表值。假设在 $z=10\\,\\mathrm{m}$ 处测得的通量代表地表通量：\n$$\\theta_{*} = -\\frac{w'\\theta'}{u_{*}}$$\n$$q_{*} = -\\frac{w'q'}{u_{*}}$$\n使用测得的运动感热通量 $w'\\theta' = 0.12\\,\\mathrm{K}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$ 和计算出的 $u_{*} = 0.50\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$：\n$$\\theta_{*} = -\\frac{0.12\\,\\mathrm{K}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}}{0.50\\,\\mathrm{m}\\,\\mathrm{s}^{-1}} = -0.24\\,\\mathrm{K}$$\n使用测得的运动水汽通量 $w'q' = 1.0 \\times 10^{-5}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$：\n$$q_{*} = -\\frac{1.0 \\times 10^{-5}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}}{0.50\\,\\mathrm{m}\\,\\mathrm{s}^{-1}} = -2.0 \\times 10^{-5}$$\n\n第三，我们推导 Obukhov 长度 $L$，它表征了地面层的稳定性。其定义为：\n$$L = - \\frac{u_{*}^3}{\\kappa \\frac{g}{\\bar{\\theta}_v} w'\\theta_{v}'}$$\n为了使用这个公式，我们首先需要计算运动虚位温通量 $w'\\theta_{v}'$ 和一个参考虚位温 $\\bar{\\theta}_v$。问题提供了近似式 $w'\\theta_{v}' \\approx w'\\theta' + 0.61\\,\\bar{\\theta}\\,w'q'$。\n使用 $\\bar{\\theta}=300\\,\\mathrm{K}$，$w'\\theta' = 0.12\\,\\mathrm{K}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$ 和 $w'q' = 1.0 \\times 10^{-5}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$：\n$$w'\\theta_{v}' \\approx 0.12 + 0.61 \\times 300 \\times (1.0 \\times 10^{-5}) = 0.12 + 0.00183 = 0.12183\\,\\mathrm{K}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$$\n$w'\\theta_{v}'$ 的正号表示湍流的浮力产生，这是不稳定（对流）层的特征。\n参考虚位温 $\\bar{\\theta}_v$ 由 $\\bar{\\theta}_{v} \\approx \\bar{\\theta}(1+0.61\\,\\bar{q})$ 近似。使用 $\\bar{\\theta}=300\\,\\mathrm{K}$ 和 $\\bar{q}=0.010$：\n$$\\bar{\\theta}_{v} \\approx 300(1 + 0.61 \\times 0.010) = 300(1.0061) = 301.83\\,\\mathrm{K}$$\n现在，我们可以使用 $u_{*} = 0.50\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$、$\\kappa=0.40$ 和 $g=9.81\\,\\mathrm{m}\\,\\mathrm{s}^{-2}$ 来计算 $L$：\n$$L = - \\frac{(0.50)^3}{0.40 \\times \\frac{9.81}{301.83} \\times 0.12183} = - \\frac{0.125}{0.40 \\times (0.03250\\,\\mathrm{K}^{-1}) \\times 0.12183\\,\\mathrm{K}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}} \\approx -78.92\\,\\mathrm{m}$$\n$L$ 的负值证实了层结是不稳定的。\n\n第四，我们使用位温的通量-梯度关系来求得在指定高度 $z=5\\,\\mathrm{m}$ 处的局地梯度。该关系由下式给出：\n$$\\frac{\\mathrm{d}\\theta}{\\mathrm{d}z} = \\frac{\\theta_{*}}{\\kappa z} \\phi_{h}(\\zeta)$$\n其中 $\\phi_h$ 是热量的无量纲稳定度函数，$\\zeta = z/L$ 是稳定度参数。在 $z=5\\,\\mathrm{m}$ 处：\n$$\\zeta = \\frac{5\\,\\mathrm{m}}{-78.92\\,\\mathrm{m}} \\approx -0.06335$$\n由于 $\\zeta  0$，我们使用适用于不稳定条件的 Businger-Dyer 形式：$\\phi_{h}(\\zeta) = (1 - 16\\zeta)^{-1/2}$。\n$$\\phi_{h}(-0.06335) = (1 - 16 \\times (-0.06335))^{-1/2} = (1 + 1.0136)^{-1/2} = (2.0136)^{-1/2} \\approx 0.7047$$\n最后，我们将所有计算出的值代入梯度方程中：\n$$\\frac{\\mathrm{d}\\theta}{\\mathrm{d}z} = \\frac{-0.24\\,\\mathrm{K}}{0.40 \\times 5\\,\\mathrm{m}} \\times 0.7047 = \\frac{-0.24\\,\\mathrm{K}}{2.0\\,\\mathrm{m}} \\times 0.7047 = -0.12\\,\\mathrm{K}\\,\\mathrm{m}^{-1} \\times 0.7047$$\n$$\\frac{\\mathrm{d}\\theta}{\\mathrm{d}z} \\approx -0.08456\\,\\mathrm{K}\\,\\mathrm{m}^{-1}$$\n将结果四舍五入到三位有效数字，我们得到 $-0.0846\\,\\mathrm{K}\\,\\mathrm{m}^{-1}$。",
            "answer": "$$\\boxed{-0.0846}$$"
        },
        {
            "introduction": "在行星边界层内，确定湍流是活跃还是被抑制是一个核心挑战。本练习将基础的湍流能量（TKE）收支与一个强大的诊断工具——梯度理查森数（$Ri_g$）联系起来。通过为不同的大气廓线实现这一计算，你将掌握一项分析观测数据和模式输出以评估大气稳定性的实用技能。",
            "id": "4075654",
            "problem": "给定大气行星边界层中高度 $z$（单位：$\\mathrm{m}$）、位温 $\\theta$（单位：$\\mathrm{K}$）以及水平风分量 $u$ 和 $v$（单位：$\\mathrm{m/s}$）的观测垂直廓线，要求您基于湍流动能收支的第一性原理，推导、实现并应用一个决策规则，以确定湍流是维持还是被抑制。使用 Boussinesq 近似并在干空气中进行计算。从湍流动能的定义出发，解释切变产生项和浮力产生或耗散项的竞争作用，并将层结与切变之比与一个无量纲量联系起来，该无量纲量与一个依赖于闭合方案的临界值进行比较时，可以区分湍流是维持还是被抑制。实现一种数值上稳健的方法，在离散廓线上评估此量。\n\n您的程序必须使用以下基本原理，不得调用快捷公式：\n- 在 Boussinesq 近似下，浮力与由一个代表性参考温度归一化的温度偏差成正比。\n- 湍流动能收支包含切变产生项和浮力产生或耗散项；在近局地平衡状态下，这些项的相对大小控制着湍流是否能通过切变克服层结的稳定效应而维持。\n- Brunt–Väisälä 频率的平方用干空气中位温的垂直梯度来量化层结。\n\n您必须：\n- 使用上述基本原理推导出一个表示层结与切变之比的无量纲表达式，并清楚地说明相对于一个依赖于闭合方案的临界值，湍流在何种条件下维持或被抑制。\n- 使用相邻层之间的基于中点的单边差分来离散化垂直梯度。具体来说，对于每一对连续的层 $(z_k,\\theta_k,u_k,v_k)$ 和 $(z_{k+1},\\theta_{k+1},u_{k+1},v_{k+1})$，在中点 $z_{k+1/2}$ 处评估该比率。使用差商 $(\\theta_{k+1}-\\theta_k)/(z_{k+1}-z_k)$、$(u_{k+1}-u_k)/(z_{k+1}-z_k)$ 和 $(v_{k+1}-v_k)/(z_{k+1}-z_k)$，并使用中点参考位温 $\\theta_0=\\frac{1}{2}(\\theta_k+\\theta_{k+1})$。\n- 使用重力加速度 $g=9.80665\\,\\mathrm{m/s^2}$。\n- 对极小的切变大小进行数值稳健处理，方法是在除法前为切变平方加上一个极小的正则化项，该正则化项在零切变极限下不改变分类结果。\n- 如果推导出的比率为负或小于特定闭合方案的临界值，则将每个中点分类为“维持”（sustained），否则分类为“抑制”（suppressed）。\n- 使用指定的物理单位进行计算，并将最终数值结果报告为无单位的浮点数和布尔值。\n\n测试套件：\n- 情况A（中等稳定的夜间边界层）：\n  - $z=\\{2,10,20,50,100\\}\\,\\mathrm{m}$,\n  - $\\theta=\\{290,291.5,293,296,300\\}\\,\\mathrm{K}$,\n  - $u=\\{2,3,4,6,8\\}\\,\\mathrm{m/s}$,\n  - $v=\\{0.5,0.8,1.0,1.2,1.5\\}\\,\\mathrm{m/s}$。\n- 情况B（对流的午间边界层）：\n  - $z=\\{2,20,50,100,200\\}\\,\\mathrm{m}$,\n  - $\\theta=\\{310,308,306,304,302\\}\\,\\mathrm{K}$,\n  - $u=\\{3,4,5,6,7\\}\\,\\mathrm{m/s}$,\n  - $v=\\{0.5,0.6,0.7,0.8,0.9\\}\\,\\mathrm{m/s}$。\n- 情况C（静稳、稳定层结的雾）：\n  - $z=\\{2,5,10,20,40\\}\\,\\mathrm{m}$,\n  - $\\theta=\\{288,289,290,292,295\\}\\,\\mathrm{K}$,\n  - $u=\\{0.1,0.1,0.1,0.1,0.1\\}\\,\\mathrm{m/s}$,\n  - $v=\\{0,0,0,0,0\\}\\,\\mathrm{m/s}$。\n- 情况D（强的低空急流切变）：\n  - $z=\\{10,50,100,200,400\\}\\,\\mathrm{m}$,\n  - $\\theta=\\{300,301,302,304,306\\}\\,\\mathrm{K}$,\n  - $u=\\{2,8,15,20,25\\}\\,\\mathrm{m/s}$,\n  - $v=\\{0.0,0.5,1.0,1.5,2.0\\}\\,\\mathrm{m/s}$。\n\n用于分类的临界值，代表不同湍流闭合方案中的典型选择：\n- Mellor–Yamada–Nakanishi–Niino 2.5级 (MYNN)：$Ri_{cr}=\\{0.25\\}$，\n- 涡-扩散质量-通量 (EDMF)：$Ri_{cr}=\\{0.20\\}$，\n- K-廓线参数化 (KPP)：$Ri_{cr}=\\{0.30\\}$。\n\n对于每个测试用例，计算每个中点的无量纲比率，将每个浮点数四舍五入到六位小数，并为所列的三个临界值分别生成分类布尔值。您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果。每个测试用例的结果必须是一个形如 $[\\text{Ri\\_list},\\ \\text{MYNN\\_booleans},\\ \\text{EDMF\\_booleans},\\ \\text{KPP\\_booleans}]$ 的列表，其中 $\\text{Ri\\_list}$ 是一个浮点数列表，随后的每一项都是一个布尔值列表，所有列表都按中点从低到高的顺序排列。",
            "solution": "该问题要求基于湍流动能（TKE）收支的第一性原理，推导并实现一个决策规则，以根据大气数据的垂直廓线判断行星边界层中的湍流是维持还是被抑制。\n\n湍流的状态由TKE收支方程决定。对于水平均匀的平均流，并在 Boussinesq 近似下，TKE 收支方程的简化形式为：\n$$\n\\frac{\\partial e}{\\partial t} = -\\overline{u'w'} \\frac{\\partial \\bar{u}}{\\partial z} - \\overline{v'w'} \\frac{\\partial \\bar{v}}{\\partial z} + \\frac{g}{\\theta_{ref}} \\overline{w'\\theta'} - \\epsilon'\n$$\n此处，$e$ 是单位质量的湍流动能，$\\bar{u}$ 和 $\\bar{v}$ 是平均水平风分量，$z$ 是垂直坐标，$u'$ 和 $v'$ 是湍流速度脉动，$w'$ 是垂直速度脉动，$\\theta'$ 是位温脉动。$g$ 是重力加速度，$\\theta_{ref}$ 是一个参考位温。方程右侧的各项代表了关键过程：\n1.  **切变产生项 ($SP$)**：$SP = -\\overline{u'w'} \\frac{\\partial \\bar{u}}{\\partial z} - \\overline{v'w'} \\frac{\\partial \\bar{v}}{\\partial z}$。此项表示从平均风切变中产生TKE。它几乎总是TKE的源。\n2.  **浮力产生/耗散项 ($BP$)**：$BP = \\frac{g}{\\theta_{ref}} \\overline{w'\\theta'}$。此项表示TKE与势能之间的转换。在不稳定层结中（$\\overline{w'\\theta'} > 0$），较暖的气块上升，较冷的气块下沉，从而产生TKE。在稳定层结中（$\\overline{w'\\theta'}  0$），此项作为一个汇，通过克服稳定的密度梯度做功来耗散TKE。\n3.  **其他项 ($\\epsilon'$)**：此项代表TKE的耗散率和湍流输送项散度的总和。\n\n为了建立一个实用的判据，我们必须将湍流通量项（如 $\\overline{u'w'}$）与平均流变量联系起来。我们采用一阶闭合或K理论，该理论使用涡动扩散-粘性类比来参数化这些通量：\n$$\n\\overline{u'w'} = -K_m \\frac{\\partial \\bar{u}}{\\partial z}\n$$\n$$\n\\overline{v'w'} = -K_m \\frac{\\partial \\bar{v}}{\\partial z}\n$$\n$$\n\\overline{w'\\theta'} = -K_h \\frac{\\partial \\bar{\\theta}}{\\partial z}\n$$\n其中 $K_m$ 是动量的涡动粘性系数，$K_h$ 是热量的涡动扩散系数。$K_m$ 和 $K_h$ 均为正定。\n\n将这些参数化代入产生项中，得到：\n$$\nSP = K_m \\left( \\left(\\frac{\\partial \\bar{u}}{\\partial z}\\right)^2 + \\left(\\frac{\\partial \\bar{v}}{\\partial z}\\right)^2 \\right) = K_m S^2\n$$\n其中 $S^2 = \\left(\\frac{\\partial \\bar{u}}{\\partial z}\\right)^2 + \\left(\\frac{\\partial \\bar{v}}{\\partial z}\\right)^2$ 是垂直风切变大小的平方。\n$$\nBP = -\\frac{g}{\\theta_{ref}} K_h \\frac{\\partial \\bar{\\theta}}{\\partial z}\n$$\n在稳定环境中，切变产生项与浮力耗散项之间的竞争决定了湍流的维持。比较浮力耗散与切变产生的无量纲比率提供了一个有用的判据。这个比率是通量理查森数，$R_f$：\n$$\nR_f = \\frac{-BP}{SP} = \\frac{\\frac{g}{\\theta_{ref}} K_h \\frac{\\partial \\bar{\\theta}}{\\partial z}}{K_m S^2} = \\frac{K_h}{K_m} \\frac{\\frac{g}{\\theta_{ref}} \\frac{\\partial \\bar{\\theta}}{\\partial z}}{S^2}\n$$\n涡动扩散系数之比 $K_m/K_h$ 是湍流普朗特数 $Pr_t$。通过定义**梯度理查森数 $Ri$**，可以重写该表达式，该数不依赖于未知的涡动扩散系数：\n$$\nRi = \\frac{\\frac{g}{\\theta_{ref}} \\frac{\\partial \\bar{\\theta}}{\\partial z}}{\\left(\\frac{\\partial \\bar{u}}{\\partial z}\\right)^2 + \\left(\\frac{\\partial \\bar{v}}{\\partial z}\\right)^2} = \\frac{N^2}{S^2}\n$$\n其中 $N^2 = \\frac{g}{\\theta_{ref}} \\frac{\\partial \\bar{\\theta}}{\\partial z}$ 是 Brunt–Väisälä 频率的平方，是静力稳定度的一个度量。\n\n$Ri$ 的物理释义如下：\n-   若 $Ri  0$（$\\frac{\\partial \\bar{\\theta}}{\\partial z}  0$），层结是静力不稳定的。浮力是TKE的源，湍流被主动产生并维持。\n-   若 $Ri > 0$（$\\frac{\\partial \\bar{\\theta}}{\\partial z} > 0$），层结是静力稳定的。浮力是TKE的汇。只有当切变产生项 $S^2$ 足够大以克服这种浮力耗散时，湍流才能维持。\n-   如果 $Ri$ 超过某个临界值 $Ri_{cr}$，湍流预计会衰减或被抑制。因此，维持湍流的条件是 $Ri  Ri_{cr}$。$Ri_{cr}$ 的值依赖于闭合方案，反映了关于湍流动力学的不同理论和经验假设。问题指定了三个这样的值：$0.25$ (MYNN)，$0.20$ (EDMF) 和 $0.30$ (KPP)。\n\n为了在数值上实现这个判据，我们必须使用给定的垂直廓线对梯度进行离散化。对于由 $k$ 和 $k+1$ 索引的每一对相邻层，我们在中点 $z_{k+1/2}$ 处计算 $Ri$。问题指定了一个有限差分格式：\n-   垂直梯度近似为：\n    $$ \\frac{\\partial \\theta}{\\partial z} \\approx \\frac{\\theta_{k+1} - \\theta_k}{z_{k+1} - z_k}, \\quad \\frac{\\partial u}{\\partial z} \\approx \\frac{u_{k+1} - u_k}{z_{k+1} - z_k}, \\quad \\frac{\\partial v}{\\partial z} \\approx \\frac{v_{k+1} - v_k}{z_{k+1} - z_k} $$\n-   中点的参考位温为：\n    $$ \\theta_0 = \\frac{1}{2}(\\theta_k + \\theta_{k+1}) $$\n-   因此，垂直风切变的平方为：\n    $$ S^2_{k+1/2} = \\left(\\frac{u_{k+1} - u_k}{z_{k+1} - z_k}\\right)^2 + \\left(\\frac{v_{k+1} - v_k}{z_{k+1} - z_k}\\right)^2 $$\n-   Brunt–Väisälä 频率的平方为：\n    $$ N^2_{k+1/2} = \\frac{g}{\\frac{1}{2}(\\theta_k + \\theta_{k+1})} \\frac{\\theta_{k+1} - \\theta_k}{z_{k+1} - z_k} $$\n-   离散的梯度理查森数为：\n    $$ Ri_{k+1/2} = \\frac{N^2_{k+1/2}}{S^2_{k+1/2} + \\epsilon} $$\n    一个小的正则化项 $\\epsilon$（例如 $10^{-12}$）被加到分母中，以防止在零切变情况下除以零，这在稳定层结中会正确地导致一个非常大的正 $Ri$，从而得到“抑制”的分类。\n\n对于每个中点，我们计算 $Ri$，然后对湍流状态进行分类。对于给定的临界值 $Ri_{cr}$，规则是：\n-   如果 $Ri  Ri_{cr}$，则湍流为“维持”（sustained）。\n-   如果 $Ri \\ge Ri_{cr}$，则湍流为“抑制”（suppressed）。\n这个逻辑将应用于给定的三个临界值中的每一个。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives, implements, and applies a decision rule based on the gradient Richardson number\n    to determine if turbulence is sustained or suppressed in the planetary boundary layer.\n    \"\"\"\n\n    # Gravitational acceleration in m/s^2\n    g = 9.80665\n\n    # Test suite of vertical profiles\n    test_cases = [\n        # Case A: Moderately stable nocturnal boundary layer\n        {\n            \"z\": [2, 10, 20, 50, 100],\n            \"theta\": [290, 291.5, 293, 296, 300],\n            \"u\": [2, 3, 4, 6, 8],\n            \"v\": [0.5, 0.8, 1.0, 1.2, 1.5]\n        },\n        # Case B: Convective mid-day boundary layer\n        {\n            \"z\": [2, 20, 50, 100, 200],\n            \"theta\": [310, 308, 306, 304, 302],\n            \"u\": [3, 4, 5, 6, 7],\n            \"v\": [0.5, 0.6, 0.7, 0.8, 0.9]\n        },\n        # Case C: Calm, stably stratified fog\n        {\n            \"z\": [2, 5, 10, 20, 40],\n            \"theta\": [288, 289, 290, 292, 295],\n            \"u\": [0.1, 0.1, 0.1, 0.1, 0.1],\n            \"v\": [0, 0, 0, 0, 0]\n        },\n        # Case D: Strong low-level jet shear\n        {\n            \"z\": [10, 50, 100, 200, 400],\n            \"theta\": [300, 301, 302, 304, 306],\n            \"u\": [2, 8, 15, 20, 25],\n            \"v\": [0.0, 0.5, 1.0, 1.5, 2.0]\n        }\n    ]\n\n    # Closure-specific critical Richardson numbers\n    critical_values = {\n        \"MYNN\": 0.25,\n        \"EDMF\": 0.20,\n        \"KPP\": 0.30\n    }\n\n    def process_case(case_data):\n        \"\"\"\n        Calculates the gradient Richardson number and classifications for a single case.\n        \n        Args:\n            case_data (dict): A dictionary containing 'z', 'theta', 'u', and 'v' lists.\n            \n        Returns:\n            list: A list containing [Ri_list, MYNN_booleans, EDMF_booleans, KPP_booleans].\n        \"\"\"\n        z = np.array(case_data[\"z\"], dtype=float)\n        theta = np.array(case_data[\"theta\"], dtype=float)\n        u = np.array(case_data[\"u\"], dtype=float)\n        v = np.array(case_data[\"v\"], dtype=float)\n\n        # Calculate differences between adjacent levels using np.diff\n        dz = np.diff(z)\n        dtheta = np.diff(theta)\n        du = np.diff(u)\n        dv = np.diff(v)\n        \n        # Calculate midpoint reference potential temperature\n        theta_0 = (theta[:-1] + theta[1:]) / 2.0\n\n        # Calculate vertical gradients\n        dtheta_dz = dtheta / dz\n        du_dz = du / dz\n        dv_dz = dv / dz\n\n        # Calculate Brunt-Väisälä frequency squared (N^2)\n        N2 = (g / theta_0) * dtheta_dz\n\n        # Calculate squared vertical wind shear (S^2)\n        S2 = du_dz**2 + dv_dz**2\n\n        # A small positive regularization to prevent division by zero\n        epsilon = 1e-12\n\n        # Calculate the gradient Richardson number (Ri)\n        Ri = N2 / (S2 + epsilon)\n        \n        # Round Ri values to six decimal places\n        ri_list = [round(r, 6) for r in Ri]\n\n        results_for_case = [ri_list]\n\n        # Perform classification for each critical value\n        for ricr in critical_values.values():\n            sustained_bools = (Ri  ricr).tolist()\n            results_for_case.append(sustained_bools)\n            \n        return results_for_case\n\n    # Process all test cases\n    all_results = []\n    for case in test_cases:\n        result = process_case(case)\n        # The string representation of a list is used for formatting\n        all_results.append(str(result))\n\n    # Print the final output in the exact required format\n    # Join the string-formatted lists with a comma\n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "预测行星边界层的高度是气象学的一个中心目标。本练习超越了局部诊断，旨在建立一个关于日间对流边界层的整体“宏观”视图。通过第一性原理的标度分析，你将学会通过平衡地表加热提供的能量与卷夹自由对流层稳定空气所需的功，来估算对流边界层的高度，从而磨练你的物理直觉和量级估算能力。",
            "id": "4075704",
            "problem": "在陆地上形成一个水平均匀的白天干对流边界层（CBL），其垂直风切变可忽略不计，无大尺度下沉运动，并有一个明显的逆温盖。逆温层下方的空气在位温上近乎充分混合。逆温层上方，背景层结近似均匀，其布伦特-维萨拉频率的平方（静力稳定度）由 $N^{2}$ 给出。地表感热通量在空间上均匀且稳定，其协方差为 $w^{\\prime}\\theta^{\\prime}_{0}$。设 $g$ 表示重力加速度，$\\theta_{0}$ 为一个代表性的参考位温。\n\n从适用于行星边界层数值天气预报和气候模拟的第一性原理出发，使用夹卷通量能量论证，通过平衡来自地表浮力强迫的可用湍流动能与将空气夹卷入以 $N^{2}$ 为特征的稳定层结逆温盖所需的功，来获得对流边界层高度 $h$ 的量级估计。你的推导应明确指出地表浮力通量和与 $N^{2}$ 相关的势能垒，并通过一致的标度分析进行，不引入无根据的经验参数。\n\n取以下数值为已知：\n- 重力加速度 $g = 9.81\\,\\mathrm{m\\,s^{-2}}$，\n- 参考位温 $\\theta_{0} = 300\\,\\mathrm{K}$，\n- 地表感热通量协方差 $w^{\\prime}\\theta^{\\prime}_{0} = 0.28\\,\\mathrm{K\\,m\\,s^{-1}}$，\n- 自由对流层静力稳定度 $N^{2} = 3.0\\times 10^{-6}\\,\\mathrm{s^{-2}}$。\n\n计算所得的边界层高度 $h$（作为一个实数）。最终答案以米为单位表示，并四舍五入到三位有效数字。",
            "solution": "该问题要求通过尺度分析推导干对流边界层（CBL）的高度 $h$，其发展受到上方稳定逆温层的影响。推导的核心是通过平衡驱动CBL增长的能量与抑制其增长的能量来建立一个关系。\n\n**1. 物理框架和标度论证**\n在一个无切变的干CBL中，湍流的主要来源是地表的浮力通量 $B_s$。这些湍流表现为贯穿整个CBL深度 $h$ 的大型热泡或涡旋。这些涡旋的特征速度可以通过对流速度标度 $w_*$ 来量化。\n\nCBL的增长是通过将上方自由对流层中较暖、更稳定的空气“夹卷”到混合层中来实现的。这个过程消耗了湍流能量。一个有效的标度论证可以通过比较两个相互竞争过程的特征频率来构建：CBL中湍流涡旋的翻转频率和上方稳定层的自然振荡频率（即布伦特-维萨拉频率 $N$）。\n\n*   **湍流涡旋翻转频率**: 一个大涡旋翻转整个CBL所需的时间尺度为 $h/w_*$。相应的频率为 $\\omega_{eddy} \\sim w_*/h$。\n*   **稳定层振荡频率**: 自由对流层的静力稳定度由布伦特-维萨拉频率 $N$ 量化。这是垂直位移的气块在该层中振荡的自然频率。\n\n当CBL的湍流翻转足够活跃以克服上方稳定层的恢复力时，CBL就能有效地增长。当湍流频率与稳定层的恢复频率达到平衡时，可以认为CBL达到了一个准稳态高度。因此，该标度论证的核心是：\n$$ \\frac{w_*}{h} \\sim N $$\n\n**2. 高度 $h$ 的推导**\n我们从上述标度关系式开始：\n$$ w_* \\sim N h $$\n对流速度标度 $w_*$ 由地表浮力通量和CBL高度定义：\n$$ w_* = (B_s h)^{1/3} $$\n其中地表浮力通量 $B_s = \\frac{g}{\\theta_0} (w'\\theta')_s$。问题中给出的地表运动学热通量为 $w'\\theta'_0$。\n\n将 $w_*$ 的定义代入我们的标度关系式中：\n$$ (B_s h)^{1/3} \\sim N h $$\n为了求解 $h$，我们将等式两边同时三次方：\n$$ B_s h \\sim (N h)^3 = N^3 h^3 $$\n假设 $h>0$，两边同除以 $h$：\n$$ B_s \\sim N^3 h^2 $$\n最后，分离出 $h$ 得到CBL高度的标度律：\n$$ h^2 \\sim \\frac{B_s}{N^3} \\implies h \\sim \\frac{\\sqrt{B_s}}{N^{3/2}} $$\n由于这是一个量级估计，我们假设比例常数为1。该表达式也可以用 $N^2$ 来表示：\n$$ h = \\frac{\\sqrt{\\frac{g}{\\theta_0} w'\\theta'_0}}{(N^2)^{3/4}} $$\n\n**3. 计算**\n我们使用给定的数值：\n*   $g = 9.81\\,\\mathrm{m\\,s^{-2}}$\n*   $\\theta_{0} = 300\\,\\mathrm{K}$\n*   $w^{\\prime}\\theta^{\\prime}_{0} = 0.28\\,\\mathrm{K\\,m\\,s^{-1}}$\n*   $N^{2} = 3.0\\times 10^{-6}\\,\\mathrm{s^{-2}}$\n\n首先，计算地表浮力通量 $B_s$：\n$$ B_s = \\frac{9.81\\,\\mathrm{m\\,s^{-2}}}{300\\,\\mathrm{K}} \\times 0.28\\,\\mathrm{K\\,m\\,s^{-1}} = 0.0327\\,\\mathrm{s^{-2}} \\times 0.28\\,\\mathrm{m\\,s^{-1}} = 0.009156\\,\\mathrm{m^2\\,s^{-3}} $$\n接着，计算分母 $N^{3/2} = (N^2)^{3/4}$：\n$$ (N^2)^{3/4} = (3.0\\times 10^{-6}\\,\\mathrm{s^{-2}})^{3/4} = (3.0)^{3/4} \\times (10^{-6})^{3/4}\\,\\mathrm{s^{-3/2}} \\approx 2.2795 \\times 10^{-4.5}\\,\\mathrm{s^{-3/2}} \\approx 7.209 \\times 10^{-5}\\,\\mathrm{s^{-3/2}} $$\n最后，计算高度 $h$：\n$$ h = \\frac{\\sqrt{0.009156\\,\\mathrm{m^2\\,s^{-3}}}}{7.209 \\times 10^{-5}\\,\\mathrm{s^{-3/2}}} = \\frac{0.095687\\,\\mathrm{m\\,s^{-3/2}}}{7.209 \\times 10^{-5}\\,\\mathrm{s^{-3/2}}} \\approx 1327.33\\,\\mathrm{m} $$\n根据要求，将结果四舍五入到三位有效数字：\n$$ h \\approx 1330\\,\\mathrm{m} $$",
            "answer": "$$\n\\boxed{1330}\n$$"
        }
    ]
}