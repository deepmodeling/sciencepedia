{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在建立莫宁-奥布霍夫相似性理论（MOST）中通量-廓线关系与整体空气动力学公式之间的基本联系，我们从最简单的情况——中性层结入手。通过推导中性条件下的输送系数，并分析一个常见的模型简化假设（即标量粗糙度长度等于动量粗糙度长度）所引入的偏差，学习者将深刻体会到区分不同粗糙度长度在实际应用中的重要性。",
            "id": "4098811",
            "problem": "在一个数值天气预报陆面模块中，观测到一个水平均一的植被冠层，该冠层处于大气表面层的中性层结条件下。该冠层具有位移高度 $d$ 以及分别表示为 $z_{0m}$、$z_{0t}$ 和 $z_{0q}$ 的动量、温度和湿度的不同粗糙度长度。参考（测量）高度为 $z_{r}$，von Kármán 常数为 $\\kappa$。假设流动是定常的，表面是平坦的且没有水平梯度，并且 Monin–Obukhov 相似理论 (MOST) 在中性条件下适用。\n\n给定以下参数：\n- $z_{0m} = 0.4 \\,\\mathrm{m}$,\n- $z_{0t} = 0.1 \\,\\mathrm{m}$,\n- $z_{0q} = 0.2 \\,\\mathrm{m}$,\n- $d = 6.7 \\,\\mathrm{m}$,\n- $z_{r} = 20.0 \\,\\mathrm{m}$,\n- $\\kappa = 0.4$。\n\n从中性条件下的 MOST 通量-廓线关系以及动量拖曳系数、感热输送系数和水汽输送系数的整体空气动力学定义出发，推导在高度 $z_{r}$ 处的中性整体输送系数的表达式：中性拖曳系数 $C_{DN}$、中性感热系数 $C_{HN}$ 和中性水汽系数 $C_{EN}$。然后，根据给定的参数计算它们的数值。\n\n最后，量化由一个常见的模型假设——即标量粗糙度长度等于动量粗糙度长度（即 $z_{0t} = z_{0m}$ 和 $z_{0q} = z_{0m}$）——所引入的中性感热输送系数的分数偏差。将感热的分数偏差定义为\n$$\nb \\equiv \\frac{C_{HN}^{\\mathrm{assumed}} - C_{HN}^{\\mathrm{true}}}{C_{HN}^{\\mathrm{true}}} \\, ,\n$$\n其中 $C_{HN}^{\\mathrm{true}}$ 使用给定的 $z_{0t}$，而 $C_{HN}^{\\mathrm{assumed}}$ 使用 $z_{0t} = z_{0m}$ 计算。将 $b$ 以无量纲小数形式报告，并将最终答案四舍五入至四位有效数字。",
            "solution": "该问题要求推导和计算植被冠层的中性整体输送系数，并随后分析一个模型假设。此分析的框架是在中性大气层结条件下的 Monin–Obukhov 相似理论 (MOST)。\n\n在中性条件下，具有位移高度 $d$ 的冠层上方的平均水平风速 $u(z)$、位温 $\\theta(z)$ 和比湿 $q(z)$ 的垂直廓线由对数律给出：\n$$\nu(z) = \\frac{u_*}{\\kappa} \\ln\\left(\\frac{z-d}{z_{0m}}\\right)\n$$\n$$\n\\theta(z) - \\theta_s = \\frac{\\theta_*}{\\kappa} \\ln\\left(\\frac{z-d}{z_{0t}}\\right)\n$$\n$$\nq(z) - q_s = \\frac{q_*}{\\kappa} \\ln\\left(\\frac{z-d}{z_{0q}}\\right)\n$$\n在这里，$z$ 是离地高度，$u_*$ 是摩擦速度，$\\kappa$ 是 von Kármán 常数，$d$ 是位移高度，$z_{0m}$、$z_{0t}$ 和 $z_{0q}$ 分别是动量、热量和湿度的粗糙度长度。表面值由下标 $s$ 表示。标度参数是摩擦速度 $u_*$、温度标度 $\\theta_*$ 和湿度标度 $q_*$。\n\n动量 ($\\tau$)、感热 ($H_s$) 和水汽 ($E_s$) 的表面通量与这些标度参数相关：\n$$\n\\tau = \\rho u_*^2\n$$\n$$\nH_s = -\\rho c_p u_* \\theta_*\n$$\n$$\nE_s = -\\rho u_* q_*\n$$\n其中 $\\rho$ 是空气密度，$c_p$ 是空气的定压比热。\n\n整体空气动力学方法定义了将这些通量与参考高度 $z_r$ 处的平均量联系起来的输送系数：\n$$\n\\tau = \\rho C_D u(z_r)^2\n$$\n$$\nH_s = \\rho c_p C_H u(z_r) (\\theta_s - \\theta(z_r))\n$$\n$$\nE_s = \\rho C_E u(z_r) (q_s - q(z_r))\n$$\n在中性条件下，这些输送系数表示为 $C_{DN}$、$C_{HN}$ 和 $C_{EN}$。\n\n我们现在将推导这些中性系数的表达式。\n\n中性拖曳系数 $C_{DN}$ 的推导：\n根据动量通量的两个定义，我们有 $u_*^2 = C_{DN} u(z_r)^2$。整理后得到：\n$$\nC_{DN} = \\left(\\frac{u_*}{u(z_r)}\\right)^2\n$$\n根据高度 $z=z_r$ 处的中性风廓线：\n$$\nu(z_r) = \\frac{u_*}{\\kappa} \\ln\\left(\\frac{z_r-d}{z_{0m}}\\right) \\implies \\frac{u_*}{u(z_r)} = \\frac{\\kappa}{\\ln\\left(\\frac{z_r-d}{z_{0m}}\\right)}\n$$\n将此代入 $C_{DN}$ 的表达式中，得到：\n$$\nC_{DN} = \\left[\\frac{\\kappa}{\\ln\\left(\\frac{z_r-d}{z_{0m}}\\right)}\\right]^2\n$$\n\n中性感热输送系数 $C_{HN}$ 的推导：\n令感热通量 $H_s$ 的两个表达式相等，得到：\n$$\n\\rho c_p C_{HN} u(z_r) (\\theta_s - \\theta(z_r)) = -\\rho c_p u_* \\theta_* \\implies C_{HN} = \\frac{u_*}{u(z_r)} \\frac{-\\theta_*}{\\theta_s - \\theta(z_r)}\n$$\n根据 $z=z_r$ 处的中性温度廓线：\n$$\n\\theta(z_r) - \\theta_s = \\frac{\\theta_*}{\\kappa} \\ln\\left(\\frac{z_r-d}{z_{0t}}\\right) \\implies \\frac{-\\theta_*}{\\theta_s - \\theta(z_r)} = \\frac{\\kappa}{\\ln\\left(\\frac{z_r-d}{z_{0t}}\\right)}\n$$\n将两个比率 $\\frac{u_*}{u(z_r)}$ 和 $\\frac{-\\theta_*}{\\theta_s - \\theta(z_r)}$ 的表达式代入 $C_{HN}$ 的方程中：\n$$\nC_{HN} = \\left[\\frac{\\kappa}{\\ln\\left(\\frac{z_r-d}{z_{0m}}\\right)}\\right] \\left[\\frac{\\kappa}{\\ln\\left(\\frac{z_r-d}{z_{0t}}\\right)}\\right] = \\frac{\\kappa^2}{\\ln\\left(\\frac{z_r-d}{z_{0m}}\\right) \\ln\\left(\\frac{z_r-d}{z_{0t}}\\right)}\n$$\n\n中性水汽输送系数 $C_{EN}$ 的推导：\n$C_{EN}$ 的推导与 $C_{HN}$ 的推导类似。令水汽通量 $E_s$ 的两个表达式相等：\n$$\n\\rho C_{EN} u(z_r) (q_s - q(z_r)) = -\\rho u_* q_* \\implies C_{EN} = \\frac{u_*}{u(z_r)} \\frac{-q_*}{q_s - q(z_r)}\n$$\n根据 $z=z_r$ 处的中性湿度廓线：\n$$\nq(z_r) - q_s = \\frac{q_*}{\\kappa} \\ln\\left(\\frac{z_r-d}{z_{0q}}\\right) \\implies \\frac{-q_*}{q_s - q(z_r)} = \\frac{\\kappa}{\\ln\\left(\\frac{z_r-d}{z_{0q}}\\right)}\n$$\n将相关比率代入 $C_{EN}$ 的方程中：\n$$\nC_{EN} = \\left[\\frac{\\kappa}{\\ln\\left(\\frac{z_r-d}{z_{0m}}\\right)}\\right] \\left[\\frac{\\kappa}{\\ln\\left(\\frac{z_r-d}{z_{0q}}\\right)}\\right] = \\frac{\\kappa^2}{\\ln\\left(\\frac{z_r-d}{z_{0m}}\\right) \\ln\\left(\\frac{z_r-d}{z_{0q}}\\right)}\n$$\n\n现在，我们使用给定参数计算数值：$z_{0m} = 0.4 \\,\\mathrm{m}$，$z_{0t} = 0.1 \\,\\mathrm{m}$，$z_{0q} = 0.2 \\,\\mathrm{m}$，$d = 6.7 \\,\\mathrm{m}$，$z_r = 20.0 \\,\\mathrm{m}$，以及 $\\kappa = 0.4$。\n首先，计算有效高度 $z_r - d = 20.0 - 6.7 = 13.3 \\,\\mathrm{m}$。\n接下来，我们计算对数的参数：\n$$\n\\ln\\left(\\frac{z_r-d}{z_{0m}}\\right) = \\ln\\left(\\frac{13.3}{0.4}\\right) = \\ln(33.25) \\approx 3.50405\n$$\n$$\n\\ln\\left(\\frac{z_r-d}{z_{0t}}\\right) = \\ln\\left(\\frac{13.3}{0.1}\\right) = \\ln(133) \\approx 4.89035\n$$\n$$\n\\ln\\left(\\frac{z_r-d}{z_{0q}}\\right) = \\ln\\left(\\frac{13.3}{0.2}\\right) = \\ln(66.5) \\approx 4.19720\n$$\n当 $\\kappa^2 = 0.4^2 = 0.16$ 时，系数为：\n$$\nC_{DN} = \\left(\\frac{0.4}{3.50405}\\right)^2 \\approx 0.01303\n$$\n$$\nC_{HN} = \\frac{0.16}{3.50405 \\times 4.89035} \\approx \\frac{0.16}{17.1364} \\approx 0.009337\n$$\n$$\nC_{EN} = \\frac{0.16}{3.50405 \\times 4.19720} \\approx \\frac{0.16}{14.7072} \\approx 0.01088\n$$\n值 $C_{HN} \\approx 0.009337$ 是“真实”值，我们将其表示为 $C_{HN}^{\\mathrm{true}}$。\n\n最后，我们量化由常见的模型假设 $z_{0t} = z_{0m}$ 引入的分数偏差 $b$。该偏差定义为：\n$$\nb \\equiv \\frac{C_{HN}^{\\mathrm{assumed}} - C_{HN}^{\\mathrm{true}}}{C_{HN}^{\\mathrm{true}}}\n$$\n值 $C_{HN}^{\\mathrm{assumed}}$ 是使用 $C_{HN}$ 的公式计算的，但将 $z_{0t}$ 替换为 $z_{0m} = 0.4 \\,\\mathrm{m}$：\n$$\nC_{HN}^{\\mathrm{assumed}} = \\frac{\\kappa^2}{\\ln\\left(\\frac{z_r-d}{z_{0m}}\\right) \\ln\\left(\\frac{z_r-d}{z_{0m}}\\right)} = \\left[\\frac{\\kappa}{\\ln\\left(\\frac{z_r-d}{z_{0m}}\\right)}\\right]^2 = C_{DN}\n$$\n因此，$C_{HN}^{\\mathrm{assumed}} \\approx 0.01303$。\n偏差 $b$ 可以解析地表示为：\n$$\nb = \\frac{C_{HN}^{\\mathrm{assumed}}}{C_{HN}^{\\mathrm{true}}} - 1 = \\frac{\\frac{\\kappa^2}{\\left[\\ln\\left(\\frac{z_r-d}{z_{0m}}\\right)\\right]^2}}{\\frac{\\kappa^2}{\\ln\\left(\\frac{z_r-d}{z_{0m}}\\right) \\ln\\left(\\frac{z_r-d}{z_{0t}}\\right)}} - 1 = \\frac{\\ln\\left(\\frac{z_r-d}{z_{0t}}\\right)}{\\ln\\left(\\frac{z_r-d}{z_{0m}}\\right)} - 1\n$$\n使用先前计算的对数值：\n$$\nb = \\frac{\\ln(133)}{\\ln(33.25)} - 1 \\approx \\frac{4.89035}{3.50405} - 1 \\approx 1.39562 - 1 = 0.39562\n$$\n四舍五入到四位有效数字，分数偏差为 $0.3956$。\n这个正偏差表明，假设热量的粗糙度长度等于较大的动量粗糙度长度，会导致对感热输送系数的显著高估。",
            "answer": "$$\n\\boxed{0.3956}\n$$"
        },
        {
            "introduction": "在中性层结的基础上，本实践将探讨更为复杂的稳定边界层情况，这需要引入稳定性订正函数来描述湍流的抑制作用。通过推导热量输送系数 $C_{H}$ 对两个关键物理参数——标量粗糙度长度 $z_{0t}$ 和奥布霍夫长度 $L$——的敏感性，学习者将掌握对模型参数化方案进行不确定性量化的关键技能。",
            "id": "4098820",
            "problem": "考虑一个水平均匀、稳定的平坦地形上的大气表面层，其位移高度为零，且满足 Monin-Obukhov 相似性理论 (MOST)。令 $z$ 表示观测高度，$z_{0m}$ 表示动量的空气动力学粗糙度长度，$z_{0t}$ 表示温度的标量粗糙度长度。假设为稳定层结，因此 Monin-Obukhov 长度 $L$ 为正，并且在表面层内不随高度变化。采用 Businger-Dyer 稳定形式的无量纲梯度函数：$\\phi_{m}(\\zeta) = 1 + \\beta_{m} \\zeta$ 和 $\\phi_{h}(\\zeta) = 1 + \\beta_{h} \\zeta$，其中 $\\zeta = z/L$，$\\beta_{m}$ 和 $\\beta_{h}$ 是正的经验稳定性参数。令 $\\kappa$ 表示 von Kármán 常数。\n\n从平均风速 $U(z)$ 和位温 $\\theta(z)$ 的 MOST 通量-梯度关系出发，利用上述 $\\phi$ 函数，通过积分得到 $U(z)$ 和 $\\theta(z) - \\theta_{s}$ 的整体关系式，其中 $\\theta_{s}$ 是地表（表层）位温。利用湍流动量通量和热通量的定义以及地表感热通量 $H$ 的整体空气动力学公式，推导满足 $H = \\rho c_{p} C_{H} U(z) \\left[\\theta_{s} - \\theta(z)\\right]$ 的热量整体输送系数 $C_{H}$，其中 $\\rho$ 是空气密度，$c_{p}$ 是定压比热。\n\n然后，在保持 $z$、$z_{0m}$、$\\kappa$、$\\beta_{m}$ 和 $\\beta_{h}$ 固定的情况下，推导偏导数 $\\partial C_{H}/\\partial z_{0t}$ 和 $\\partial C_{H}/\\partial L$ 关于 $z$、$z_{0m}$、$z_{0t}$、$L$、$\\beta_{m}$、$\\beta_{h}$ 和 $\\kappa$ 的符号表达式。你可以假设 $z \\gg z_{0m}, z_{0t}$，但不要舍弃由积分 MOST 梯度产生的稳定性修正项中包含 $z_{0m}$ 或 $z_{0t}$ 的项。\n\n最后，使用线性不确定性传播，并假设 $\\rho$、$c_{p}$、$U(z)$ 和 $\\theta_{s} - \\theta(z)$ 已知且没有不确定性，定性讨论在这些稳定条件下，微小误差 $\\delta z_{0t}$ 和 $\\delta L$ 是如何通过 $C_{H}$ 传播到感热通量的。\n\n将你的最终答案以一个行矩阵形式的符号表达式对 $\\left(\\partial C_{H}/\\partial z_{0t}, \\partial C_{H}/\\partial L\\right)$ 给出。不需要进行数值计算，也不需要四舍五入。最终的方框答案中不要包含单位。",
            "solution": "我们从水平均匀、稳定且位移高度为零条件下的 Monin-Obukhov 相似性理论 (MOST) 出发。平均风速 $U(z)$ 和平均位温 $\\theta(z)$ 的通量-梯度关系为\n$$\n\\frac{\\partial U}{\\partial z} = \\frac{u_{*}}{\\kappa z}\\,\\phi_{m}(\\zeta), \n\\qquad\n\\frac{\\partial \\theta}{\\partial z} = \\frac{\\theta_{*}}{\\kappa z}\\,\\phi_{h}(\\zeta),\n$$\n其中 $u_{*}$ 是摩擦速度，$\\theta_{*}$ 是温度尺度，且对于稳定层结 $\\zeta = z/L$，$L0$。在 Businger-Dyer 稳定形式下，我们取\n$$\n\\phi_{m}(\\zeta) = 1 + \\beta_{m}\\zeta, \n\\qquad \n\\phi_{h}(\\zeta) = 1 + \\beta_{h}\\zeta,\n$$\n其中 $\\beta_{m}  0$ 且 $\\beta_{h}  0$。我们假设通量（因此 $L$ 也）在积分范围内不随高度变化。\n\n为获得整体风场关系，从 $z_{0m}$ 积分到 $z$：\n$$\nU(z) - U(z_{0m}) = \\int_{z_{0m}}^{z} \\frac{u_{*}}{\\kappa z'} \\left[1 + \\beta_{m}\\frac{z'}{L}\\right] \\,\\mathrm{d}z'.\n$$\n在空气动力学粗糙度长度处 $U(z_{0m}) \\approx 0$，积分得到\n$$\nU(z) = \\frac{u_{*}}{\\kappa}\\left[\\ln\\!\\left(\\frac{z}{z_{0m}}\\right) + \\beta_{m}\\frac{z - z_{0m}}{L}\\right].\n$$\n在常见的对数-减-修正的表示法中，我们可以将稳定性修正项视为积分函数 $\\Psi_{m}(\\zeta) = -\\beta_{m}\\zeta$。\n\n类似地，对于温度，从 $z_{0t}$ 积分到 $z$：\n$$\n\\theta(z) - \\theta(z_{0t}) = \\int_{z_{0t}}^{z} \\frac{\\theta_{*}}{\\kappa z'} \\left[1 + \\beta_{h}\\frac{z'}{L}\\right] \\,\\mathrm{d}z',\n$$\n并定义 $\\theta_{s} \\equiv \\theta(z_{0t})$ 为地表（表层）位温。这给出\n$$\n\\theta(z) - \\theta_{s} = \\frac{\\theta_{*}}{\\kappa}\\left[\\ln\\!\\left(\\frac{z}{z_{0t}}\\right) + \\beta_{h}\\frac{z - z_{0t}}{L}\\right].\n$$\n\n根据定义，湍流地表通量满足\n$$\n\\tau = \\rho u_{*}^{2}, \n\\qquad \nH = -\\rho c_{p} u_{*}\\theta_{*}.\n$$\n感热的整体空气动力学公式为\n$$\nH = \\rho c_{p} C_{H} U(z)\\left[\\theta_{s} - \\theta(z)\\right].\n$$\n令 $\\Delta \\theta \\equiv \\theta(z) - \\theta_{s}$。则 $H = -\\rho c_{p} C_{H} U(z)\\Delta \\theta$。与通量定义相等，我们得到\n$$\n-\\rho c_{p} u_{*}\\theta_{*} = -\\rho c_{p} C_{H} U(z)\\Delta \\theta\n\\quad \\Longrightarrow \\quad\nC_{H} = \\frac{u_{*}\\theta_{*}}{U(z)\\,\\Delta \\theta}.\n$$\n使用积分后的 MOST 廓线，\n$$\nU(z) = \\frac{u_{*}}{\\kappa} A_{m}, \n\\qquad \n\\Delta \\theta = \\frac{\\theta_{*}}{\\kappa} A_{h},\n$$\n其中我们定义\n$$\nA_{m} \\equiv \\ln\\!\\left(\\frac{z}{z_{0m}}\\right) + \\beta_{m}\\frac{z - z_{0m}}{L}, \n\\qquad \nA_{h} \\equiv \\ln\\!\\left(\\frac{z}{z_{0t}}\\right) + \\beta_{h}\\frac{z - z_{0t}}{L}.\n$$\n将其代入 $C_{H}$ 的表达式，得到在假定的稳定形式下热量的典型整体输送系数：\n$$\nC_{H} = \\frac{\\kappa^{2}}{A_{m} A_{h}}.\n$$\n\n现在我们计算所要求的偏导数，同时保持 $z$、$z_{0m}$、$\\kappa$、$\\beta_{m}$ 和 $\\beta_{h}$ 固定。\n\n首先，$\\partial C_{H}/\\partial z_{0t}$。注意 $A_{m}$ 与 $z_{0t}$ 无关，而\n$$\nA_{h}(z_{0t},L) = \\ln\\!\\left(\\frac{z}{z_{0t}}\\right) + \\beta_{h}\\frac{z - z_{0t}}{L}.\n$$\n因此\n$$\n\\frac{\\partial A_{h}}{\\partial z_{0t}} = -\\frac{1}{z_{0t}} - \\frac{\\beta_{h}}{L}.\n$$\n使用 $C_{H} = \\kappa^{2}(A_{m}A_{h})^{-1}$ 和链式法则，\n$$\n\\frac{\\partial C_{H}}{\\partial z_{0t}} \n= -\\kappa^{2}\\,\\frac{1}{A_{m}}\\frac{1}{A_{h}^{2}}\\frac{\\partial A_{h}}{\\partial z_{0t}}\n= -\\kappa^{2}\\,\\frac{1}{A_{m}}\\frac{1}{A_{h}^{2}}\\left(-\\frac{1}{z_{0t}} - \\frac{\\beta_{h}}{L}\\right)\n= \\frac{\\kappa^{2}}{A_{m}A_{h}^{2}}\\left(\\frac{1}{z_{0t}} + \\frac{\\beta_{h}}{L}\\right).\n$$\n\n其次，$\\partial C_{H}/\\partial L$。$A_{m}$ 和 $A_{h}$ 都依赖于 $L$。我们有\n$$\n\\frac{\\partial A_{m}}{\\partial L} = -\\beta_{m}\\frac{z - z_{0m}}{L^{2}},\n\\qquad\n\\frac{\\partial A_{h}}{\\partial L} = -\\beta_{h}\\frac{z - z_{0t}}{L^{2}}.\n$$\n对 $C_{H}$ 关于 $L$ 求导：\n$$\n\\frac{\\partial C_{H}}{\\partial L}\n= -\\kappa^{2}\\left[\\frac{1}{A_{m}^{2}A_{h}}\\,\\frac{\\partial A_{m}}{\\partial L} + \\frac{1}{A_{m}A_{h}^{2}}\\,\\frac{\\partial A_{h}}{\\partial L}\\right]\n= -\\kappa^{2}\\left[ \\frac{1}{A_{m}^{2}A_{h}}\\left(-\\beta_{m}\\frac{z - z_{0m}}{L^{2}}\\right) + \\frac{1}{A_{m}A_{h}^{2}}\\left(-\\beta_{h}\\frac{z - z_{0t}}{L^{2}}\\right) \\right].\n$$\n因此，\n$$\n\\frac{\\partial C_{H}}{\\partial L}\n= \\frac{\\kappa^{2}}{L^{2}}\\left[ \\frac{\\beta_{m}\\,(z - z_{0m})}{A_{m}^{2}A_{h}} + \\frac{\\beta_{h}\\,(z - z_{0t})}{A_{m}A_{h}^{2}} \\right].\n$$\n\n这些表达式具有稳定层结下的预期符号：由于对于 $L0$，有 $A_{m}0$、$A_{h}0$ 以及 $\\beta_{m},\\beta_{h}0$，我们发现 $\\partial C_{H}/\\partial z_{0t}  0$（更大的标量粗糙度会增加热量输送）和 $\\partial C_{H}/\\partial L  0$（更大的 $L$ 意味着更弱的稳定性，从而导致更大的输送）。\n\n最后，为了讨论误差如何传播到感热通量，考虑整体公式 $H = \\rho c_{p} C_{H} U(z)\\left[\\theta_{s} - \\theta(z)\\right]$。如果 $\\rho$、$c_{p}$、$U(z)$ 和 $\\theta_{s} - \\theta(z)$ 已知且没有不确定性，那么对于微小的不确定性 $\\delta z_{0t}$ 和 $\\delta L$，一阶线性化给出\n$$\n\\delta H \\approx \\rho c_{p}\\,U(z)\\left[\\theta_{s} - \\theta(z)\\right]\\left( \\frac{\\partial C_{H}}{\\partial z_{0t}}\\,\\delta z_{0t} + \\frac{\\partial C_{H}}{\\partial L}\\,\\delta L \\right).\n$$\n因此，$H$ 对 $z_{0t}$ 的敏感度与 $(\\partial C_{H}/\\partial z_{0t})$ 成比例，对稳定性的敏感度与 $(\\partial C_{H}/\\partial L)$ 成比例。在稳定条件下，两种敏感度均为正，这意味着高估 $z_{0t}$ 或 $L$（更弱的稳定性）会增加 $C_{H}$ 的估计值，从而在给定的 $U(z)$ 和 $\\theta_{s}-\\theta(z)$ 下增加 $H$ 的量级。相对贡献由分母 $A_{m}$ 和 $A_{h}$ 调节：对于给定的 $z$，较大的 $A_{h}$ 或 $A_{m}$（例如，更粗糙的动量表面或更强的稳定性）通过增加整体公式中的有效阻力来降低敏感度。",
            "answer": "$$\\boxed{\\begin{pmatrix}\n\\dfrac{\\kappa^{2}}{\\left[\\ln\\!\\left(\\dfrac{z}{z_{0m}}\\right) + \\beta_{m}\\dfrac{z - z_{0m}}{L}\\right]\\left[\\ln\\!\\left(\\dfrac{z}{z_{0t}}\\right) + \\beta_{h}\\dfrac{z - z_{0t}}{L}\\right]^{2}}\\left(\\dfrac{1}{z_{0t}} + \\dfrac{\\beta_{h}}{L}\\right),\n \n\\dfrac{\\kappa^{2}}{L^{2}}\\left[\\dfrac{\\beta_{m}\\left(z - z_{0m}\\right)}{\\left[\\ln\\!\\left(\\dfrac{z}{z_{0m}}\\right) + \\beta_{m}\\dfrac{z - z_{0m}}{L}\\right]^{2}\\left[\\ln\\!\\left(\\dfrac{z}{z_{0t}}\\right) + \\beta_{h}\\dfrac{z - z_{0t}}{L}\\right]} + \\dfrac{\\beta_{h}\\left(z - z_{0t}\\right)}{\\left[\\ln\\!\\left(\\dfrac{z}{z_{0m}}\\right) + \\beta_{m}\\dfrac{z - z_{0m}}{L}\\right]\\left[\\ln\\!\\left(\\dfrac{z}{z_{0t}}\\right) + \\beta_{h}\\dfrac{z - z_{0t}}{L}\\right]^{2}}\\right]\n\\end{pmatrix}}$$"
        },
        {
            "introduction": "这项综合性实践模拟了大气建模者的核心任务之一：评估和选择参数化方案。通过将不同的稳定性订正函数数学形式与基准数据及物理约束进行比较，学习者将深入了解在数值模式中准确表示复杂地表层物理过程所面临的实际挑战与方法。",
            "id": "4098808",
            "problem": "考虑在数值天气预报 (NWP) 和气候模拟中，应用大气表面层中的 Monin–Obukhov 相似性理论来构建动量和热量的总体输送系数。从摩擦速度 $u_*$、温度尺度 $\\theta_*$ 和 Obukhov 长度 $L$ 的定义出发，采用以下基本假设：(i) 湍流动量通量为 $\\tau = \\rho u_*^2$，(ii) 湍流感热通量为 $\\overline{w'\\theta'} = -u_* \\theta_*$，(iii) Obukhov 长度为 $L = -\\dfrac{u_*^3 T_0}{\\kappa g \\overline{w'\\theta'}}$，以及 (iv) 大气表面层的平均廓线由经积分稳定度修正函数调制的对数形式描述。设 von Kármán 常数为 $\\kappa = 0.4$。设 $z$ 为测量高度，$z_0$ 为动量粗糙度长度，$z_{0T}$ 为热量粗糙度长度。设无量纲稳定度参数为 $\\zeta = \\dfrac{z}{L}$，并约定中性条件对应于 $\\zeta = 0$。假设 $z$、$z_0$ 和 $z_{0T}$ 均为正值，且满足 $z \\gg z_0, z_{0T}$。所有物理长度必须以 $\\mathrm{m}$ 为单位表示。\n\n通过使用积分稳定度修正函数 $\\psi_m(\\zeta)$ 和 $\\psi_h(\\zeta)$ 的通量-廓线关系，定义动量总体输送系数 $C_D$ 和热量总体输送系数 $C_H$ 如下：\n$$\nC_D(z,\\zeta) = \\left[\\dfrac{\\kappa}{\\ln\\!\\left(\\dfrac{z}{z_0}\\right) - \\psi_m(\\zeta)}\\right]^2,\n\\qquad\nC_H(z,\\zeta) = \\dfrac{\\kappa^2}{\\left[\\ln\\!\\left(\\dfrac{z}{z_0}\\right) - \\psi_m(\\zeta)\\right]\\left[\\ln\\!\\left(\\dfrac{z}{z_{0T}}\\right) - \\psi_h(\\zeta)\\right]}.\n$$\n这些定义是无量纲的，应被视为待评估的目标量。\n\n您必须评估积分稳定度修正函数 $\\psi_m(\\zeta)$ 和 $\\psi_h(\\zeta)$ 的三种候选参数化方案，并将它们与一个模拟大涡模拟 (LES) 或实地数据的参考表示进行比较。这三种候选方案是：\n\n- 候选方案 $\\mathcal{P}_1$ (Businger–Dyer 风格，线性稳定斜率为 $5$)：\n对于不稳定条件 $\\zeta  0$，令 $x = (1 - 16\\zeta)^{1/4}$ 且\n$$\n\\psi_m(\\zeta) = 2\\ln\\!\\left(\\dfrac{1 + x}{2}\\right) + \\ln\\!\\left(\\dfrac{1 + x^2}{2}\\right) - 2\\arctan(x) + \\dfrac{\\pi}{2}, \\qquad\n\\psi_h(\\zeta) = 2\\ln\\!\\left(\\dfrac{1 + x^2}{2}\\right).\n$$\n对于稳定条件 $\\zeta \\ge 0$，令\n$$\n\\psi_m(\\zeta) = -5\\zeta, \\qquad \\psi_h(\\zeta) = -5\\zeta.\n$$\n\n- 候选方案 $\\mathcal{P}_2$ (修改稳定斜率为 $7$，不稳定形式与 $\\mathcal{P}_1$ 相同)：\n对于不稳定条件 $\\zeta  0$，使用与 $\\mathcal{P}_1$ 相同的公式。\n对于稳定条件 $\\zeta \\ge 0$，令\n$$\n\\psi_m(\\zeta) = -7\\zeta, \\qquad \\psi_h(\\zeta) = -7\\zeta.\n$$\n\n- 候选方案 $\\mathcal{P}_3$ (无稳定度修正)：\n对于所有 $\\zeta$，令\n$$\n\\psi_m(\\zeta) = 0, \\qquad \\psi_h(\\zeta) = 0.\n$$\n\n使用与 $\\mathcal{P}_1$ (Businger–Dyer 风格，线性稳定斜率为 $5$) 相同的形式作为 LES/实地数据仿真 (参考标准)，即参考积分稳定度修正函数 $\\psi_m^{\\mathrm{ref}}(\\zeta)$ 和 $\\psi_h^{\\mathrm{ref}}(\\zeta)$ 与 $\\mathcal{P}_1$ 的函数完全相同。\n\n实现一个程序，对于每个候选方案 $\\mathcal{P}_i$，计算以下五个案例组成的测试套件中的 $C_D$ 和 $C_H$，并将它们与使用 $\\psi_m^{\\mathrm{ref}}$ 和 $\\psi_h^{\\mathrm{ref}}$ 计算出的参考值 $C_D^{\\mathrm{ref}}$ 和 $C_H^{\\mathrm{ref}}$ 进行比较：\n\n- 案例 #1 (中度不稳定，理想路径)：$z = 10\\,\\mathrm{m}$，$z_0 = 0.03\\,\\mathrm{m}$，$z_{0T} = 0.003\\,\\mathrm{m}$，$L = -50\\,\\mathrm{m}$，因此 $\\zeta = -0.2$。\n- 案例 #2 (中度稳定，理想路径)：$z = 10\\,\\mathrm{m}$，$z_0 = 0.03\\,\\mathrm{m}$，$z_{0T} = 0.003\\,\\mathrm{m}$，$L = 50\\,\\mathrm{m}$，因此 $\\zeta = 0.2$。\n- 案例 #3 (中性，边界情况)：$z = 10\\,\\mathrm{m}$，$z_0 = 0.03\\,\\mathrm{m}$，$z_{0T} = 0.003\\,\\mathrm{m}$，$L \\to \\infty$，因此设 $\\zeta = 0$。\n- 案例 #4 (强不稳定，边缘情况)：$z = 10\\,\\mathrm{m}$，$z_0 = 0.03\\,\\mathrm{m}$，$z_{0T} = 0.003\\,\\mathrm{m}$，$L = -5\\,\\mathrm{m}$，因此 $\\zeta = -2$。\n- 案例 #5 (非常稳定，边缘情况)：$z = 10\\,\\mathrm{m}$，$z_0 = 0.03\\,\\mathrm{m}$，$z_{0T} = 0.003\\,\\mathrm{m}$，$L = 5\\,\\mathrm{m}$，因此 $\\zeta = 2$。\n\n对于每个候选方案 $\\mathcal{P}_i$，计算其 $C_D$ 和 $C_H$ 在五个案例中相对于参考标准的均方根误差 (RMSE)：\n$$\n\\mathrm{RMSE}_{C_D} = \\sqrt{\\dfrac{1}{N}\\sum_{j=1}^N\\left[C_D^{(i)}(z_j,\\zeta_j) - C_D^{\\mathrm{ref}}(z_j,\\zeta_j)\\right]^2}, \\qquad\n\\mathrm{RMSE}_{C_H} = \\sqrt{\\dfrac{1}{N}\\sum_{j=1}^N\\left[C_H^{(i)}(z_j,\\zeta_j) - C_H^{\\mathrm{ref}}(z_j,\\zeta_j)\\right]^2},\n$$\n其中 $N = 5$。\n\n此外，对每个候选方案 $\\mathcal{P}_i$ 的稳定度修正函数应用基于物理动机的选择标准：\n- $\\zeta = 0$ 处的中性极限一致性：$\\lvert \\psi_m(0) \\rvert \\le \\varepsilon$ 和 $\\lvert \\psi_h(0) \\rvert \\le \\varepsilon$，其中 $\\varepsilon = 10^{-12}$。\n- 偏离中性条件时的符号约束：对于 $\\zeta  0$，要求 $\\psi_m(\\zeta)  0$ 和 $\\psi_h(\\zeta)  0$；对于 $\\zeta  0$，要求 $\\psi_m(\\zeta) > 0$ 和 $\\psi_h(\\zeta) > 0$。在离散集合 $\\{\\zeta\\}_{\\mathrm{stable}} = \\{0.05, 0.2, 0.5, 1.0, 2.0\\}$ 和 $\\{\\zeta\\}_{\\mathrm{unstable}} = \\{-0.05, -0.2, -0.5, -1.0, -2.0\\}$ 上验证这些约束。\n- 单调性约束：在 $\\{\\zeta\\}_{\\mathrm{stable}}$ 集合中，随着 $\\zeta$ 的增加，$\\psi_m$ 和 $\\psi_h$ 都必须严格递减；在 $\\{\\zeta\\}_{\\mathrm{unstable}}$ 集合中，随着 $\\zeta$ 的减小 (即 $\\lvert \\zeta \\rvert$ 的增加)，$\\psi_m$ 和 $\\psi_h$ 都必须严格递增。\n\n一个候选方案 $\\mathcal{P}_i$ 被认为通过筛选，当且仅当满足上述所有物理约束，并且两个 RMSE 阈值都得到满足：$\\mathrm{RMSE}_{C_D} \\le 2\\times 10^{-4}$ 和 $\\mathrm{RMSE}_{C_H} \\le 10^{-3}$。\n\n您的程序必须：\n- 实现三个候选方案 $\\mathcal{P}_1$、$\\mathcal{P}_2$ 和 $\\mathcal{P}_3$ 以及参考方案。\n- 为每个候选方案和参考方案计算所有五个案例的 $C_D$ 和 $C_H$。\n- 计算每个候选方案相对于参考方案的 $\\mathrm{RMSE}_{C_D}$ 和 $\\mathrm{RMSE}_{C_H}$。\n- 检查物理约束，并计算一个最终的布尔值，指示该候选方案是否通过筛选。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。该列表有三个元素（每个候选方案一个），每个元素本身也是一个包含三个元素的列表：$[\\mathrm{RMSE}_{C_D}, \\mathrm{RMSE}_{C_H}, \\text{pass}]$。例如，输出格式必须为\n$$\n\\left[[r_1,h_1,p_1],[r_2,h_2,p_2],[r_3,h_3,p_3]\\right],\n$$\n其中每个 $r_i$ 和 $h_i$ 是一个浮点数，每个 $p_i$ 是一个布尔值。所有输送系数和 RMSE 值都是无量纲的；长度单位必须是 $\\mathrm{m}$；不涉及角度；不使用百分比。",
            "solution": "该问题已经过验证，并被确定为是合理的。它在科学上基于 Monin-Obukhov 相似性理论，是适定的、内部一致的，并且可以通过编程解决。所有必要的数据和定义均已提供。\n\n目标是评估用于模拟大气表面层的积分稳定度修正函数 $\\psi_m(\\zeta)$ 和 $\\psi_h(\\zeta)$ 的三种候选参数化方案，分别记为 $\\mathcal{P}_1$、$\\mathcal{P}_2$ 和 $\\mathcal{P}_3$。评估方法是：在一组包含 $N=5$ 个代表不同大气稳定度条件的测试案例中，将这些方案产生的动量 ($C_D$) 和热量 ($C_H$) 总体输送系数与一个参考标准进行比较。如果一个候选参数化方案满足一组基于物理动机的约束，并且其 $C_D$ 和 $C_H$ 的均方根误差 (RMSE) 低于指定的阈值，则该方案被视为成功。\n\n总体输送系数被定义为测量高度 $z$、动量表面粗糙度长度 $z_0$ 和热量表面粗糙度长度 $z_{0T}$ 以及稳定度参数 $\\zeta = z/L$ 的函数，其中 $L$ 是 Obukhov 长度。它们的公式是：\n$$\nC_D(z,\\zeta) = \\left[\\dfrac{\\kappa}{\\ln\\!\\left(\\dfrac{z}{z_0}\\right) - \\psi_m(\\zeta)}\\right]^2\n$$\n$$\nC_H(z,\\zeta) = \\dfrac{\\kappa^2}{\\left[\\ln\\!\\left(\\dfrac{z}{z_0}\\right) - \\psi_m(\\zeta)\\right]\\left[\\ln\\!\\left(\\dfrac{z}{z_{0T}}\\right) - \\psi_h(\\zeta)\\right]}\n$$\nvon Kármán 常数给定为 $\\kappa = 0.4$。\n\n三种候选参数化方案 $(\\psi_m, \\psi_h)$ 分别是：\n1.  候选方案 $\\mathcal{P}_1$：一种 Businger-Dyer 风格的公式。对于不稳定条件 ($\\zeta  0$)，使用 $x = (1 - 16\\zeta)^{1/4}$，函数为 $\\psi_m(\\zeta) = 2\\ln\\!\\left(\\frac{1 + x}{2}\\right) + \\ln\\!\\left(\\frac{1 + x^2}{2}\\right) - 2\\arctan(x) + \\frac{\\pi}{2}$ 和 $\\psi_h(\\zeta) = 2\\ln\\!\\left(\\frac{1 + x^2}{2}\\right)$。对于稳定条件 ($\\zeta \\ge 0$)，函数是线性的：$\\psi_m(\\zeta) = -5\\zeta$ 和 $\\psi_h(\\zeta) = -5\\zeta$。\n2.  候选方案 $\\mathcal{P}_2$：该方案使用与 $\\mathcal{P}_1$ 相同的不稳定条件公式，但将稳定部分修改为 $\\psi_m(\\zeta) = -7\\zeta$ 和 $\\psi_h(\\zeta) = -7\\zeta$。\n3.  候选方案 $\\mathcal{P}_3$：这是中性公式，其中忽略了稳定度修正：对于所有 $\\zeta$，$\\psi_m(\\zeta) = 0$ 和 $\\psi_h(\\zeta) = 0$。\n\n参考参数化方案（所有候选方案都将与之比较）与候选方案 $\\mathcal{P}_1$ 完全相同。这意味着 $\\mathcal{P}_1$ 应该表现出零误差，并作为基准。\n\n评估按算法流程进行。首先，我们为三种候选参数化方案和参考方案分别实现函数。然后，对每个候选方案执行以下步骤：\n1.  系数计算：对于由 $(z, z_0, z_{0T}, \\zeta)$ 定义的 5 个测试案例中的每一个，我们为候选方案 $\\mathcal{P}_i$ 计算系数对 $(C_D^{(i)}, C_H^{(i)})$，并为参考方案计算参考对 $(C_D^{\\mathrm{ref}}, C_H^{\\mathrm{ref}})$。\n2.  RMSE 计算：使用标准公式计算 $C_D$ 和 $C_H$ 在 $N=5$ 个案例中的均方根误差：\n    $$\n    \\mathrm{RMSE}_{C_D} = \\sqrt{\\dfrac{1}{N}\\sum_{j=1}^N\\left[C_D^{(i)}(z_j,\\zeta_j) - C_D^{\\mathrm{ref}}(z_j,\\zeta_j)\\right]^2}\n    $$\n    $$\n    \\mathrm{RMSE}_{C_H} = \\sqrt{\\dfrac{1}{N}\\sum_{j=1}^N\\left[C_H^{(i)}(z_j,\\zeta_j) - C_H^{\\mathrm{ref}}(z_j,\\zeta_j)\\right]^2}\n    $$\n3.  物理约束验证：检查每个候选方案的 $\\psi$ 函数是否满足三个物理属性：\n    a.  中性极限：函数在中性稳定度时必须趋近于零，即 $|\\psi_m(0)| \\le \\varepsilon$ 和 $|\\psi_h(0)| \\le \\varepsilon$，其中 $\\varepsilon = 10^{-12}$ 是一个很小的容差。\n    b.  符号约定：函数在稳定条件下 ($\\zeta > 0$) 必须为负，在不稳定条件下 ($\\zeta  0$) 必须为正，这一点通过离散的 $\\zeta$ 值集合进行检查。\n    c.  单调性：在稳定条件下，函数必须随着 $\\zeta$ 的增加而严格递减；在不稳定条件下，函数必须随着 $\\zeta$ 的减小（不稳定性的增加）而严格递增。\n\n一个候选方案 $\\mathcal{P}_i$ 被认为“通过”，当且仅当它满足所有三个物理约束，并且其 RMSE 值满足阈值：$\\mathrm{RMSE}_{C_D} \\le 2\\times 10^{-4}$ 和 $\\mathrm{RMSE}_{C_H} \\le 10^{-3}$。\n\n最终输出汇编了三种候选方案中每一种的结果，以指定格式提供两个 RMSE 值和最终的布尔型通过/失败状态。这个系统性的程序可以对数值大气模型中常见的不同稳定度修正方案进行定量和客观的评估。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Evaluates three candidate parameterizations for atmospheric surface layer \n    stability corrections against a reference, based on RMSE and physical constraints.\n    \"\"\"\n    \n    # --- GLOBAL CONSTANTS AND PARAMETERS ---\n    KAPPA = 0.4\n    RMSE_CD_THRESH = 2e-4\n    RMSE_CH_THRESH = 1e-3\n    EPSILON = 1e-12\n\n    # --- TEST SUITE AND CONSTRAINT CHECKING SETS ---\n    test_cases = [\n        # (z, z0, z0T, zeta)\n        (10.0, 0.03, 0.003, -0.2),  # Case 1: moderately unstable\n        (10.0, 0.03, 0.003, 0.2),   # Case 2: moderately stable\n        (10.0, 0.03, 0.003, 0.0),   # Case 3: neutral\n        (10.0, 0.03, 0.003, -2.0),  # Case 4: strongly unstable\n        (10.0, 0.03, 0.003, 2.0),   # Case 5: very stable\n    ]\n    zetas_stable = [0.05, 0.2, 0.5, 1.0, 2.0]\n    zetas_unstable = [-0.05, -0.2, -0.5, -1.0, -2.0] # Decreasing in zeta\n\n    # --- PARAMETERIZATION FUNCTIONS (psi_m, psi_h) ---\n\n    def psi_p1(zeta):\n        \"\"\"Candidate P1 and Reference.\"\"\"\n        if zeta  0:\n            x = (1 - 16 * zeta)**0.25\n            psi_m = 2 * np.log((1 + x) / 2) + np.log((1 + x**2) / 2) - 2 * np.arctan(x) + np.pi / 2\n            psi_h = 2 * np.log((1 + x**2) / 2)\n        else:\n            psi_m = -5 * zeta\n            psi_h = -5 * zeta\n        return psi_m, psi_h\n\n    def psi_p2(zeta):\n        \"\"\"Candidate P2.\"\"\"\n        if zeta  0:\n            x = (1 - 16 * zeta)**0.25\n            psi_m = 2 * np.log((1 + x) / 2) + np.log((1 + x**2) / 2) - 2 * np.arctan(x) + np.pi / 2\n            psi_h = 2 * np.log((1 + x**2) / 2)\n        else:\n            psi_m = -7 * zeta\n            psi_h = -7 * zeta\n        return psi_m, psi_h\n\n    def psi_p3(zeta):\n        \"\"\"Candidate P3.\"\"\"\n        return 0.0, 0.0\n\n    psi_ref = psi_p1\n    \n    candidates = [psi_p1, psi_p2, psi_p3]\n    \n    # --- HELPER FUNCTIONS ---\n\n    def calc_coeffs(z, z0, z0T, psi_m, psi_h):\n        \"\"\"Calculates bulk transfer coefficients C_D and C_H.\"\"\"\n        log_z_z0 = np.log(z / z0)\n        log_z_z0T = np.log(z / z0T)\n        \n        denom_m = log_z_z0 - psi_m\n        denom_h = log_z_z0T - psi_h\n        \n        # Avoid division by zero in the unlikely event of a zero denominator\n        if abs(denom_m)  1e-15: denom_m = 1e-15\n        if abs(denom_h)  1e-15: denom_h = 1e-15\n        \n        C_D = (KAPPA / denom_m)**2\n        C_H = KAPPA**2 / (denom_m * denom_h)\n        return C_D, C_H\n\n    def check_physical_constraints(psi_func):\n        \"\"\"Verifies neutral limit, sign, and monotonicity constraints.\"\"\"\n        # 1. Neutral limit consistency\n        psi_m_0, psi_h_0 = psi_func(0.0)\n        neutral_limit_ok = abs(psi_m_0) = EPSILON and abs(psi_h_0) = EPSILON\n\n        # 2. Sign constraints\n        sign_stable_ok = all(psi_func(z)[0]  0 and psi_func(z)[1]  0 for z in zetas_stable)\n        sign_unstable_ok = all(psi_func(z)[0] > 0 and psi_func(z)[1] > 0 for z in zetas_unstable)\n        sign_ok = sign_stable_ok and sign_unstable_ok\n\n        # 3. Monotonicity constraints\n        # Stable: psi must be strictly decreasing for increasing zeta\n        psi_m_stable_vals = [psi_func(z)[0] for z in zetas_stable]\n        psi_h_stable_vals = [psi_func(z)[1] for z in zetas_stable]\n        mono_m_stable_ok = all(psi_m_stable_vals[i] > psi_m_stable_vals[i+1] for i in range(len(psi_m_stable_vals) - 1))\n        mono_h_stable_ok = all(psi_h_stable_vals[i] > psi_h_stable_vals[i+1] for i in range(len(psi_h_stable_vals) - 1))\n\n        # Unstable: psi must be strictly increasing for decreasing zeta\n        psi_m_unstable_vals = [psi_func(z)[0] for z in zetas_unstable]\n        psi_h_unstable_vals = [psi_func(z)[1] for z in zetas_unstable]\n        mono_m_unstable_ok = all(psi_m_unstable_vals[i]  psi_m_unstable_vals[i+1] for i in range(len(psi_m_unstable_vals) - 1))\n        mono_h_unstable_ok = all(psi_h_unstable_vals[i]  psi_h_unstable_vals[i+1] for i in range(len(psi_h_unstable_vals) - 1))\n        \n        mono_ok = mono_m_stable_ok and mono_h_stable_ok and mono_m_unstable_ok and mono_h_unstable_ok\n        \n        return neutral_limit_ok and sign_ok and mono_ok\n\n    # --- MAIN EVALUATION LOOP ---\n    final_results = []\n    \n    # Pre-calculate reference values for efficiency\n    C_D_ref_vals = np.array([calc_coeffs(z, z0, z0T, *psi_ref(zeta))[0] for z, z0, z0T, zeta in test_cases])\n    C_H_ref_vals = np.array([calc_coeffs(z, z0, z0T, *psi_ref(zeta))[1] for z, z0, z0T, zeta in test_cases])\n\n    for psi_cand_func in candidates:\n        # Calculate C_D and C_H for the current candidate\n        C_D_cand_vals = np.array([calc_coeffs(z, z0, z0T, *psi_cand_func(zeta))[0] for z, z0, z0T, zeta in test_cases])\n        C_H_cand_vals = np.array([calc_coeffs(z, z0, z0T, *psi_cand_func(zeta))[1] for z, z0, z0T, zeta in test_cases])\n        \n        # Calculate RMSE against the reference\n        rmse_cd = np.sqrt(np.mean((C_D_cand_vals - C_D_ref_vals)**2))\n        rmse_ch = np.sqrt(np.mean((C_H_cand_vals - C_H_ref_vals)**2))\n\n        # Check physical constraints and RMSE thresholds to determine pass/fail\n        phys_constraints_passed = check_physical_constraints(psi_cand_func)\n        rmse_cd_passed = rmse_cd = RMSE_CD_THRESH\n        rmse_ch_passed = rmse_ch = RMSE_CH_THRESH\n        \n        pass_status = phys_constraints_passed and rmse_cd_passed and rmse_ch_passed\n        \n        final_results.append([rmse_cd, rmse_ch, pass_status])\n\n    # --- FORMAT AND PRINT FINAL OUTPUT ---\n    result_strings = []\n    for r in final_results:\n        # Format: [rmse_cd,rmse_ch,pass_status] with lowercase boolean\n        r_str = str(r[0])\n        h_str = str(r[1])\n        p_str = str(r[2]).lower()\n        result_strings.append(f\"[{r_str},{h_str},{p_str}]\")\n    \n    output_string = f\"[{','.join(result_strings)}]\"\n    print(output_string)\n\nsolve()\n```"
        }
    ]
}