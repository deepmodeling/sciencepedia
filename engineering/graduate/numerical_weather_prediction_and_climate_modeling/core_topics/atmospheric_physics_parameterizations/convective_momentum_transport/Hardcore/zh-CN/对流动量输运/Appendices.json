{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在将雷诺平均的抽象理论与具体计算联系起来。通过使用一个简化的质量通量框架，我们将学习如何根据理想化但物理上具有代表性的大气廓线，从第一性原理推导并量化对流引起的动量输送。这个实践将帮助你理解对流参数化方案中动量通量 $\\overline{u'w'}$ 及其垂直梯度的核心计算过程。",
            "id": "4026941",
            "problem": "考虑一个用于数值天气预报和气候模拟的垂直一维、水平均匀的海洋边界层气柱，其中对流性动量输送由质量通量框架表示。假设空气密度恒定为 $\\rho = 1.2~\\mathrm{kg~m^{-3}}$，云底高度为 $z_b = 1000~\\mathrm{m}$，并且对流上升气流及其环境场占据互补的面积分数。给定以下关于单位面积对流质量通量 $M(z)$、条件平均的上升气流水平风 $u_u(z)$ 以及条件平均的环境场水平风 $u_e(z)$ 的指定廓线：\n- 对于云底以下的高度 $z$，$0 \\le z \\le z_b$，质量通量随高度线性增加：$M(z) = M_b \\frac{z}{z_b}$。\n- 对于云底以上的高度 $z$，$z \\ge z_b$，质量通量呈指数衰减：$M(z) = M_b \\exp\\!\\big(-(z - z_b)/H\\big)$，其中 $H = 800~\\mathrm{m}$ 是一个衰减尺度。\n- 环境风廓线为 $u_e(z) = U_0 + S_e z$，其中 $U_0 = 6~\\mathrm{m~s^{-1}}$ 且 $S_e = 6 \\times 10^{-3}~\\mathrm{s^{-1}}$。\n- 上升气流风廓线为 $u_u(z) = U_0 + \\delta + S_u z$，其中 $\\delta = -1~\\mathrm{m~s^{-1}}$ 且 $S_u = 2 \\times 10^{-3}~\\mathrm{s^{-1}}$。\n设基准云底质量通量为 $M_b = 0.050~\\mathrm{kg~m^{-2}~s^{-1}}$。\n\n从有组织对流的雷诺平均和条件采样第一性原理出发，推导运动学对流性动量通量 $\\overline{u'w'}(z)$ 关于 $M(z)$、$\\rho$、$u_u(z)$ 和 $u_e(z)$ 的表达式。使用此表达式和指定的廓线，计算：\n1. 在 $0 \\le z \\le 2000~\\mathrm{m}$ 范围内的廓线 $\\overline{u'w'}(z)$。\n2. 其在所有高度上的垂直散度 $\\partial \\overline{u'w'}/\\partial z$，并明确计算其在 $z \\to 0^+$ 时的极限，以通过平均动量方程获得对流对地面风趋势的贡献。\n\n最后，假设对流的瞬时加深使云底质量通量增加了 $30\\%$，即 $M_b \\to M_b' = M_b \\big(1 + 0.30\\big)$。在保持所有其他参数不变的情况下，计算仅由 $M_b$ 变化引起的对流对地面风趋势贡献的变化量 $\\Delta\\big(\\partial \\overline{u}/\\partial t\\big)\\big|_{z \\to 0^+}$。将您的答案四舍五入至四位有效数字，并以 $\\mathrm{m~s^{-2}}$ 为单位表示。",
            "solution": "首先根据指定标准验证问题。\n\n### 第1步：提取已知条件\n- 空气密度: $\\rho = 1.2~\\mathrm{kg~m^{-3}}$\n- 云底高度: $z_b = 1000~\\mathrm{m}$\n- 对流上升气流和环境场占据互补的面积分数。\n- 单位面积对流质量通量 $M(z)$:\n  - 对于 $0 \\le z \\le z_b$: $M(z) = M_b \\frac{z}{z_b}$\n  - 对于 $z \\ge z_b$: $M(z) = M_b \\exp\\big(-(z - z_b)/H\\big)$\n- 衰减尺度高度: $H = 800~\\mathrm{m}$\n- 基准云底质量通量: $M_b = 0.050~\\mathrm{kg~m^{-2}~s^{-1}}$\n- 环境风廓线: $u_e(z) = U_0 + S_e z$，其中 $U_0 = 6~\\mathrm{m~s^{-1}}$ 且 $S_e = 6 \\times 10^{-3}~\\mathrm{s^{-1}}$\n- 上升气流风廓线: $u_u(z) = U_0 + \\delta + S_u z$，其中 $\\delta = -1~\\mathrm{m~s^{-1}}$ 且 $S_u = 2 \\times 10^{-3}~\\mathrm{s^{-1}}$\n- 云底质量通量的瞬时变化: $M_b' = M_b (1 + 0.30)$\n\n### 第2步：使用提取的已知条件进行验证\n- **科学依据**：该问题在大气流体动力学原理方面有充分的依据，特别是在数值模型中次网格尺度对流过程的参数化。质量通量框架是表示对流的标准方法。所提供的质量通量和风的廓线是简化但物理上合理的表示。\n- **适定性**：问题是适定的。所提供的信息充分且自洽，能够导向所求量的唯一确定解。\n- **客观性**：问题以精确、客观和定量的语言陈述。没有主观或基于意见的元素。\n- **完整性与一致性**：所有必需的参数（$\\rho$、$z_b$、$H$、$M_b$ 以及风廓线系数）均已提供。定义清晰且无矛盾。\n- **可行性**：物理情景和参数值对于海洋大气边界层是现实的。所需的计算是微积分和代数运算的直接应用。\n\n### 第3步：结论与行动\n该问题被认为是有效的。将提供完整解答。\n\n### 解答推导\n\n#### 第1部分：运动学对流性动量通量 $\\overline{u'w'}(z)$ 的推导\n\n我们从雷诺平均和条件采样的原理开始。雷诺平均水平速度 $\\overline{u}$ 可以分解为对流上升气流（下标 $u$）和环境场（下标 $e$）的贡献：\n$$ \\overline{u} = a_u u_u + a_e u_e $$\n其中 $a_u$ 和 $a_e$ 分别是上升气流和环境场的面积分数，$u_u$ 和 $u_e$ 是它们的条件平均水平速度。由于这些面积是互补的，所以 $a_u + a_e = 1$。\n\n在水平均匀的设定中，总垂直质量通量 $\\overline{\\rho w}$ 假定为零。应用条件采样：\n$$ \\overline{\\rho w} = a_u \\rho_u \\overline{w_u} + a_e \\rho_e \\overline{w_e} = 0 $$\n其中 $\\overline{w_u}$ 和 $\\overline{w_e}$ 是条件平均垂直速度。在给定的恒定密度 $\\rho_u = \\rho_e = \\rho$ 条件下，这简化为：\n$$ \\rho (a_u \\overline{w_u} + a_e \\overline{w_e}) = 0 $$\n对流质量通量（单位面积）定义为上升气流内的质量通量，$M(z) = \\rho a_u \\overline{w_u}$。从平均垂直质量通量为零的条件可以得出，环境场中的质量通量为 $\\rho a_e \\overline{w_e} = -M(z)$。\n\n水平动量的垂直通量为 $\\overline{uw}$。假设 $\\overline{w}=0$，这等价于运动学协方差 $\\overline{u'w'}$。使用条件采样：\n$$ \\overline{u'w'} = \\overline{uw} = a_u u_u \\overline{w_u} + a_e u_e \\overline{w_e} $$\n将面积通量用 $M(z)$ 和 $\\rho$ 的表达式代入：\n$$ \\overline{u'w'}(z) = \\frac{M(z)}{\\rho} u_u(z) + \\left(-\\frac{M(z)}{\\rho}\\right) u_e(z) $$\n这简化为质量通量框架中运动学对流性动量通量的标准表达式：\n$$ \\overline{u'w'}(z) = \\frac{M(z)}{\\rho} \\left( u_u(z) - u_e(z) \\right) $$\n\n#### 第2部分：通量廓线 $\\overline{u'w'}(z)$ 的计算\n\n首先，我们确定上升气流和环境场之间的水平风差：\n$$ u_u(z) - u_e(z) = (U_0 + \\delta + S_u z) - (U_0 + S_e z) = \\delta + (S_u - S_e)z $$\n代入给定值，$\\delta = -1~\\mathrm{m~s^{-1}}$ 和 $S_u - S_e = (2 \\times 10^{-3} - 6 \\times 10^{-3})~\\mathrm{s^{-1}} = -4 \\times 10^{-3}~\\mathrm{s^{-1}}$：\n$$ u_u(z) - u_e(z) = -1 - (4 \\times 10^{-3})z $$\n现在，我们可以写出 $\\overline{u'w'}(z)$ 的分段表达式：\n\n对于 $0 \\le z \\le z_b = 1000~\\mathrm{m}$：\n$$ M(z) = M_b \\frac{z}{z_b} $$\n$$ \\overline{u'w'}(z) = \\frac{1}{\\rho} \\left(M_b \\frac{z}{z_b}\\right) (-1 - (4 \\times 10^{-3})z) = \\frac{M_b}{\\rho z_b} z (-1 - (4 \\times 10^{-3})z) $$\n\n对于 $z_b \\le z \\le 2000~\\mathrm{m}$：\n$$ M(z) = M_b \\exp\\left(-\\frac{z - z_b}{H}\\right) $$\n$$ \\overline{u'w'}(z) = \\frac{M_b}{\\rho} \\exp\\left(-\\frac{z - z_b}{H}\\right) (-1 - (4 \\times 10^{-3})z) $$\n\n#### 第3部分：垂直散度 $\\partial \\overline{u'w'}/\\partial z$ 的计算\n\n我们对 $\\overline{u'w'}(z)$ 的分段廓线进行微分。\n\n对于 $0  z  z_b$：\n$$ \\overline{u'w'}(z) = \\frac{M_b z}{\\rho z_b} (\\delta + (S_u - S_e)z) = \\frac{M_b}{\\rho z_b}(\\delta z + (S_u-S_e)z^2) $$\n应用求和法则和幂法则求导：\n$$ \\frac{\\partial \\overline{u'w'}}{\\partial z} = \\frac{M_b}{\\rho z_b}(\\delta + 2(S_u-S_e)z) $$\n\n对于 $z > z_b$：\n对 $\\overline{u'w'}(z) = \\frac{M_b}{\\rho} \\exp\\left(-\\frac{z - z_b}{H}\\right) (\\delta + (S_u - S_e)z)$ 使用乘法法则：\n$$ \\frac{\\partial \\overline{u'w'}}{\\partial z} = \\frac{M_b}{\\rho} \\left[ -\\frac{1}{H}\\exp\\left(-\\frac{z - z_b}{H}\\right)(\\delta + (S_u - S_e)z) + \\exp\\left(-\\frac{z - z_b}{H}\\right)(S_u - S_e) \\right] $$\n$$ \\frac{\\partial \\overline{u'w'}}{\\partial z} = \\frac{M_b}{\\rho} \\exp\\left(-\\frac{z - z_b}{H}\\right) \\left[ -\\frac{1}{H}(\\delta + (S_u - S_e)z) + (S_u - S_e) \\right] $$\n\n平均动量方程由 $\\frac{\\partial \\overline{u}}{\\partial t} = -\\frac{\\partial \\overline{u'w'}}{\\partial z} + \\dots$ 给出。对流对地面风趋势的贡献是 $-\\frac{\\partial \\overline{u'w'}}{\\partial z}$ 在 $z \\to 0^+$ 处的极限。\n使用 $0  z  z_b$ 的散度表达式：\n$$ \\lim_{z \\to 0^+} \\frac{\\partial \\overline{u'w'}}{\\partial z} = \\lim_{z \\to 0^+} \\frac{M_b}{\\rho z_b} (\\delta + 2(S_u - S_e)z) = \\frac{M_b \\delta}{\\rho z_b} $$\n因此，对流对地面风趋势的贡献是：\n$$ \\left(\\frac{\\partial \\overline{u}}{\\partial t}\\right)_{\\text{conv}} \\bigg|_{z \\to 0^+} = - \\lim_{z \\to 0^+} \\frac{\\partial \\overline{u'w'}}{\\partial z} = -\\frac{M_b \\delta}{\\rho z_b} $$\n\n#### 第4部分：地面风趋势的变化\n\n问题要求计算当 $M_b$ 被 $M_b' = M_b(1 + 0.30) = 1.3 M_b$ 替代时，该趋势的变化量 $\\Delta\\left(\\frac{\\partial \\overline{u}}{\\partial t}\\right)\\bigg|_{z \\to 0^+}$。\n\n初始趋势为 $(\\frac{\\partial \\overline{u}}{\\partial t})_1 = -\\frac{M_b \\delta}{\\rho z_b}$。\n新趋势为 $(\\frac{\\partial \\overline{u}}{\\partial t})_2 = -\\frac{M_b' \\delta}{\\rho z_b} = -\\frac{1.3 M_b \\delta}{\\rho z_b}$。\n\n趋势的变化量为：\n$$ \\Delta\\left(\\frac{\\partial \\overline{u}}{\\partial t}\\right)\\bigg|_{z \\to 0^+} = \\left(\\frac{\\partial \\overline{u}}{\\partial t}\\right)_2 - \\left(\\frac{\\partial \\overline{u}}{\\partial t}\\right)_1 $$\n$$ \\Delta\\left(\\frac{\\partial \\overline{u}}{\\partial t}\\right)\\bigg|_{z \\to 0^+} = \\left(-\\frac{1.3 M_b \\delta}{\\rho z_b}\\right) - \\left(-\\frac{M_b \\delta}{\\rho z_b}\\right) = -\\frac{0.3 M_b \\delta}{\\rho z_b} $$\n\n现在，我们代入数值：\n- $M_b = 0.050~\\mathrm{kg~m^{-2}~s^{-1}}$\n- $\\delta = -1~\\mathrm{m~s^{-1}}$\n- $\\rho = 1.2~\\mathrm{kg~m^{-3}}$\n- $z_b = 1000~\\mathrm{m}$\n\n$$ \\Delta\\left(\\frac{\\partial \\overline{u}}{\\partial t}\\right)\\bigg|_{z \\to 0^+} = - \\frac{0.3 \\times 0.050 \\times (-1)}{1.2 \\times 1000} = \\frac{0.015}{1200} $$\n$$ \\Delta\\left(\\frac{\\partial \\overline{u}}{\\partial t}\\right)\\bigg|_{z \\to 0^+} = \\frac{1.5 \\times 10^{-2}}{1.2 \\times 10^3} = 1.25 \\times 10^{-5}~\\mathrm{m~s^{-2}} $$\n四舍五入到四位有效数字，结果是 $1.250 \\times 10^{-5}~\\mathrm{m~s^{-2}}$。",
            "answer": "$$ \\boxed{1.250 \\times 10^{-5}} $$"
        },
        {
            "introduction": "许多湍流闭合方案，例如涡度扩散模型，都依赖于一个核心假设，即通量总是沿着平均梯度的方向“向下”输送。本练习构建了一个关键的概念性反例，展示了在倾斜对流热泡等常见大气现象中，这种降梯度假设会完全失效，甚至预测出方向相反的动量输送。通过这个练习，你将深刻理解为何在对流参数化中需要更复杂的、基于物理过程的非局地模型。",
            "id": "4026982",
            "problem": "考虑数值天气预报模式单柱中的一个水平均匀的对流边界层，其中平均纬向风为 $U(z)$，平均垂直运动为零，即 $W(z)=0$。设雷诺分解为 $u=U(z)+u'(x,y,z,t)$ 和 $w=W(z)+w'(x,y,z,t)$，并将雷诺应力（纬向动量的垂直输送）定义为协方差 $\\overline{u'w'}(z)$，其中上划线表示适当的时空平均。一种广泛使用的顺梯度涡度扩散闭合方案规定 $\\overline{u'w'}(z)=-K_{m}(z)\\,\\partial U/\\partial z$，其中 $K_{m}(z)0$ 是涡粘性系数。\n\n假设大尺度平均风随高度线性增加，$U(z)=U_{0}+S\\,z$，具有恒定的风切变 $S0$，并且涡粘性系数 $K_{m}(z)=K_{m}$ 在所关注的层内不随高度变化。现在考虑对流性动量输送（CMT）主要由非局地的、倾斜的热羽交换主导：流场被划分为两个子区域，一个占据水平面积比例为 $a$ 的上升气流区，其具有恒定的垂直速度异常 $w'_{u}=w_{u}0$；以及一个补偿性的下沉气流区，占据比例为 $1-a$，具有恒定的垂直速度异常 $w'_{d}=w_{d}0$。网格尺度上的质量连续性要求 $a\\,w_{u}+(1-a)\\,w_{d}=0$。假设热羽在纬向平面内均匀倾斜一个小角度 $\\theta$（当 $\\theta0$ 时朝向 $x$ 正方向），以至于在 $\\tan\\theta$ 的主导项上，热羽内的纬向速度异常在几何上受垂直速度异常的约束：$u'_{p}=\\tan\\theta\\,w'_{p}$，其中 $p\\in\\{u,d\\}$。这代表了一种非局地交换，其中热羽动力学施加了一个与垂直运动相关的纬向动量异常，而这个异常与局地的平均风切变无关。\n\n1. 基于这些基础和约束条件，推导由热羽引起的实际协方差 $\\overline{u'w'}$ 的表达式，用 $a$、$w_{u}$、$w_{d}$ 和 $\\theta$ 表示。\n2. 使用质量连续性方程消去 $w_{d}$，将表达式简化为只依赖于 $a$、$w_{u}$ 和 $\\theta$ 的形式。\n3. 对于涡度扩散闭合方案，写出相应的 $\\overline{u'w'}_{\\text{eddy}}$，用 $K_{m}$ 和 $S$ 表示。\n4. 使用以下科学上合理的参数值：$a=0.20$，$w_{u}=2.0\\,\\text{m}\\,\\text{s}^{-1}$，$\\theta=5.710^{\\circ}$（因此 $\\tan\\theta=0.10$），$K_{m}=50\\,\\text{m}^{2}\\,\\text{s}^{-1}$，以及 $S=5.0\\times10^{-3}\\,\\text{s}^{-1}$，计算无量纲比值\n$$\nR=\\frac{\\overline{u'w'}_{\\text{plume}}}{\\overline{u'w'}_{\\text{eddy}}}.\n$$\n这个比值量化了非局地倾斜热羽输送与顺梯度闭合方案之间的符号和相对大小差异。将 $R$ 表示为小数值，并将你的答案四舍五入到四位有效数字。由于 $R$ 是无量纲的，因此不带单位。",
            "solution": "将按顺序回答提出的四个部分来解决此问题。\n\n### 第1部分：推导热羽引起的协方差\n水平网格区域上的总动量协方差 $\\overline{u'w'}$ 定义为来自上升气流区和下沉气流区的局地协方差贡献的面积加权平均值。上升气流区占据比例为 $a$ 的面积，下沉气流区占据剩余的比例为 $1-a$ 的面积。\n\n协方差可以表示为：\n$$\n\\overline{u'w'}_{\\text{plume}} = a \\cdot (u'w')_{\\text{updraft}} + (1-a) \\cdot (u'w')_{\\text{downdraft}}\n$$\n我们已知每个区域内的恒定速度异常：\n在上升气流区：$w'_{u} = w_{u}$ 且 $u'_{u}$ 通过热羽倾斜与 $w'_{u}$ 相关联。\n在下沉气流区：$w'_{d} = w_{d}$ 且 $u'_{d}$ 通过热羽倾斜与 $w'_{d}$ 相关联。\n\n问题陈述，热羽内的纬向速度异常 $u'_{p}$ 通过关系式 $u'_{p} = \\tan\\theta \\, w'_{p}$ 在几何上受垂直速度异常 $w'_{p}$ 的约束，其中 $p \\in \\{u, d\\}$。\n\n对于上升气流区 ($p=u$)：\n异常的乘积为 $(u'w')_{\\text{updraft}} = u'_{u} w'_{u} = (\\tan\\theta \\, w'_{u}) w'_{u} = \\tan\\theta \\, (w'_{u})^2$。因为 $w'_{u} = w_{u}$，所以这变为 $\\tan\\theta \\, w_{u}^2$。\n\n对于下沉气流区 ($p=d$)：\n异常的乘积为 $(u'w')_{\\text{downdraft}} = u'_{d} w'_{d} = (\\tan\\theta \\, w'_{d}) w'_{d} = \\tan\\theta \\, (w'_{d})^2$。因为 $w'_{d} = w_{d}$，所以这变为 $\\tan\\theta \\, w_{d}^2$。\n\n将这些表达式代回面积加权平均公式，得到热羽引起的协方差的所需表达式：\n$$\n\\overline{u'w'}_{\\text{plume}} = a (\\tan\\theta \\, w_{u}^2) + (1-a) (\\tan\\theta \\, w_{d}^2)\n$$\n提取公因式 $\\tan\\theta$：\n$$\n\\overline{u'w'}_{\\text{plume}} = \\tan\\theta \\, (a \\, w_{u}^2 + (1-a) \\, w_{d}^2)\n$$\n\n### 第2部分：使用质量连续性进行简化\n网格尺度的质量连续性约束为 $a \\, w_{u} + (1-a) \\, w_{d} = 0$。我们可以用它来从 $\\overline{u'w'}_{\\text{plume}}$ 的表达式中消去 $w_{d}$。\n从连续性方程中，我们解出 $w_{d}$：\n$$\nw_{d} = -\\frac{a}{1-a} w_{u}\n$$\n现在，我们将 $w_{d}$ 的这个表达式代入第1部分的结果中：\n$$\n\\overline{u'w'}_{\\text{plume}} = \\tan\\theta \\, \\left( a \\, w_{u}^2 + (1-a) \\left( -\\frac{a}{1-a} w_{u} \\right)^2 \\right)\n$$\n简化平方项：\n$$\n\\overline{u'w'}_{\\text{plume}} = \\tan\\theta \\, \\left( a \\, w_{u}^2 + (1-a) \\frac{a^2}{(1-a)^2} w_{u}^2 \\right)\n$$\n$$\n\\overline{u'w'}_{\\text{plume}} = \\tan\\theta \\, \\left( a \\, w_{u}^2 + \\frac{a^2}{1-a} w_{u}^2 \\right)\n$$\n提取公因式 $a \\, w_{u}^2$：\n$$\n\\overline{u'w'}_{\\text{plume}} = \\tan\\theta \\, a \\, w_{u}^2 \\left( 1 + \\frac{a}{1-a} \\right)\n$$\n简化括号中的表达式：\n$$\n1 + \\frac{a}{1-a} = \\frac{1-a}{1-a} + \\frac{a}{1-a} = \\frac{1-a+a}{1-a} = \\frac{1}{1-a}\n$$\n将其代回，我们得到热羽引起的动量输送的最终简化表达式：\n$$\n\\overline{u'w'}_{\\text{plume}} = \\tan\\theta \\, a \\, w_{u}^2 \\left( \\frac{1}{1-a} \\right) = \\frac{a}{1-a} w_{u}^2 \\tan\\theta\n$$\n\n### 第3部分：涡度扩散闭合方案\n顺梯度涡度扩散闭合方案由 $\\overline{u'w'}(z) = -K_{m}(z) \\, \\frac{\\partial U}{\\partial z}$ 给出。\n问题指定平均风廓线为 $U(z) = U_{0} + S\\,z$，涡粘性系数为常数 $K_{m}(z) = K_{m}$。\n首先，我们计算平均纬向风的垂直切变：\n$$\n\\frac{\\partial U}{\\partial z} = \\frac{\\partial}{\\partial z} (U_{0} + S\\,z) = S\n$$\n将 $K_m$ 和 $S$ 代入闭合公式，得到涡度扩散模型预测的动量输送：\n$$\n\\overline{u'w'}_{\\text{eddy}} = -K_{m} S\n$$\n\n### 第4部分：计算比值 $R$\n无量纲比值 $R$ 定义为热羽引起的输送与涡度扩散闭合方案预测的输送之比：\n$$\nR = \\frac{\\overline{u'w'}_{\\text{plume}}}{\\overline{u'w'}_{\\text{eddy}}} = \\frac{\\frac{a}{1-a} w_{u}^2 \\tan\\theta}{-K_{m} S} = -\\frac{a \\, w_{u}^2 \\tan\\theta}{(1-a) K_{m} S}\n$$\n我们被给予以下参数值：\n$a = 0.20$\n$w_{u} = 2.0 \\, \\text{m}\\,\\text{s}^{-1}$\n$\\tan\\theta = 0.10$\n$K_{m} = 50 \\, \\text{m}^{2}\\,\\text{s}^{-1}$\n$S = 5.0 \\times 10^{-3} \\, \\text{s}^{-1}$\n\n我们先计算 $R$ 表达式中分数的分子：\n$$\na \\, w_{u}^2 \\tan\\theta = (0.20) \\cdot (2.0)^2 \\cdot (0.10) = 0.20 \\cdot 4.0 \\cdot 0.10 = 0.080\n$$\n接下来，我们计算分母：\n$$\n(1-a) K_{m} S = (1-0.20) \\cdot (50) \\cdot (5.0 \\times 10^{-3}) = 0.80 \\cdot 50 \\cdot 0.0050 = 40 \\cdot 0.0050 = 0.20\n$$\n现在，我们计算比值 $R$：\n$$\nR = - \\frac{0.080}{0.20} = -0.4\n$$\n问题要求答案表示为小数值并四舍五入到四位有效数字。\n$$\nR = -0.4000\n$$\n负号表示基于物理的热羽模型预测了纬向动量的向上通量（逆梯度输送，因为当 $S0$ 时 $\\overline{u'w'}_{\\text{plume}}  0$），而简单的顺梯度闭合方案预测了向下的通量（因为 $\\overline{u'w'}_{\\text{eddy}}  0$）。这种差异是局地闭合方案在强对流状况下一个众所周知的失败。",
            "answer": "$$\n\\boxed{-0.4000}\n$$"
        },
        {
            "introduction": "在理解了对流冲量输送的物理机制后，下一步是在数值模式中实现它。本练习聚焦于一项核心的数值方法技能：在交错网格上对动量通量的垂直散度 $S_u^{\\mathrm{conv}} = -\\partial_z \\overline{u^{\\prime} w^{\\prime}}$ 进行离散化。这是大气环流模式和数值天气预报中保证守恒性和计算精度的标准技术，对于将物理参数化方案正确地耦合到动力核心至关重要。",
            "id": "4027038",
            "problem": "您的任务是在一维垂直气柱中实现纬向动量的对流输送倾向，该实现需与数值天气预报和气候模拟实践相一致。对纬向动量倾向的对流贡献定义为运动学湍流动量通量的负垂直散度。从第一性原理出发，考虑雷诺平均的纬向动量方程，并将对流贡献解释为通量散度。您必须在垂直交错网格上对垂直散度进行离散化。\n\n网格和变量布置：\n- 垂直坐标为 $z$（单位：$\\mathrm{m}$），向上为正，地表位于 $z=0$，模式层顶位于 $z=H$。\n- 网格是交错的，$w$ 层位于界面 $z_{k+\\frac{1}{2}}$ 处，质量层位于界面之间的单元中心。共有 $N$ 个质量层和 $N+1$ 个界面层。\n- 运动学湍流动量通量为 $\\overline{u^{\\prime} w^{\\prime}}(z)$（单位：$\\mathrm{m}^2\\,\\mathrm{s}^{-2}$），定义在 $w$ 层（界面）上。\n- 对流纬向动量倾向为 $S_u^{\\mathrm{conv}}(z) = -\\partial_z \\overline{u^{\\prime} w^{\\prime}}(z)$（单位：$\\mathrm{m}\\,\\mathrm{s}^{-2}$），需要在质量层上进行计算。\n\n边界条件：\n- 在模式层顶，施加零通量：$\\overline{u^{\\prime} w^{\\prime}}(H) = 0$（单位：$\\mathrm{m}^2\\,\\mathrm{s}^{-2}$）。\n- 在地表，施加指定的运动学地表应力：$\\overline{u^{\\prime} w^{\\prime}}(0) = F_s$（单位：$\\mathrm{m}^2\\,\\mathrm{s}^{-2}$）。此处的 $F_s$ 作为每个测试用例的一部分提供。\n\n离散化要求：\n- 在交错网格上使用二阶中心差分近似，根据界面上的 $\\overline{u^{\\prime} w^{\\prime}}$ 值计算每个质量层上的 $S_u^{\\mathrm{conv}}$。该设计必须与非均匀网格上通量散度的有限体积解释相一致。\n\n单位与输出：\n- $S_u^{\\mathrm{conv}}$ 的每个分量都以 $\\mathrm{m}\\,\\mathrm{s}^{-2}$ 表示。\n- 对于每个测试用例，返回所有质量层上的 $S_u^{\\mathrm{conv}}$ 值列表，四舍五入到 $8$ 位小数。\n\n测试套件：\n请实现您的程序，为以下五个案例计算 $S_u^{\\mathrm{conv}}$。在每个案例中，您会得到界面高度和在这些界面上计算的 $\\overline{u^{\\prime} w^{\\prime}}$ 廓线。您必须首先通过将底部界面的值设置为指定的地表值 $F_s$ 并将顶部界面的值设置为 $0$ 来强制执行边界条件，然后使用要求的格式在质量层上计算离散倾向。\n\n- 案例 1（均匀网格，线性通量廓线）：\n  - $H = 1000\\,\\mathrm{m}$，$N=5$。\n  - 界面高度：$z_{w} = [0, 200, 400, 600, 800, 1000]$（单位：$\\mathrm{m}$）。\n  - 通量廓线：$\\overline{u^{\\prime} w^{\\prime}}(z) = F_0 \\left(1 - \\frac{z}{H}\\right)$，其中 $F_0 = 0.2$（单位：$\\mathrm{m}^2\\,\\mathrm{s}^{-2}$）。\n  - 地表值：$F_s = 0.2$（单位：$\\mathrm{m}^2\\,\\mathrm{s}^{-2}$）。\n\n- 案例 2（非均匀网格，二次通量廓线）：\n  - $H = 2000\\,\\mathrm{m}$，$N=5$。\n  - 界面高度：$z_{w} = [0, 100, 250, 500, 900, 2000]$（单位：$\\mathrm{m}$）。\n  - 通量廓线：$\\overline{u^{\\prime} w^{\\prime}}(z) = F_0 \\left(1 - \\left(\\frac{z}{H}\\right)^2\\right)$，其中 $F_0 = 0.1$（单位：$\\mathrm{m}^2\\,\\mathrm{s}^{-2}$）。\n  - 地表值：$F_s = 0.1$（单位：$\\mathrm{m}^2\\,\\mathrm{s}^{-2}$）。\n\n- 案例 3（脉冲式底部通量，上部为零）：\n  - $H = 500\\,\\mathrm{m}$，$N=5$。\n  - 界面高度：$z_{w} = [0, 100, 200, 300, 400, 500]$（单位：$\\mathrm{m}$）。\n  - 通量廓线：对于 $z  0$，$\\overline{u^{\\prime} w^{\\prime}}(z) = 0$；在地表 $z=0$ 处使用指定的 $F_s$。\n  - 地表值：$F_s = 0.3$（单位：$\\mathrm{m}^2\\,\\mathrm{s}^{-2}$）。\n\n- 案例 4（均匀网格上的变号通量）：\n  - $H = 1000\\,\\mathrm{m}$，$N=4$。\n  - 界面高度：$z_{w} = [0, 250, 500, 750, 1000]$（单位：$\\mathrm{m}$）。\n  - 界面上的通量廓线值：$\\overline{u^{\\prime} w^{\\prime}} = [0.2, 0.1, 0.0, -0.1, 0.0]$（单位：$\\mathrm{m}^2\\,\\mathrm{s}^{-2}$）。\n  - 地表值：$F_s = 0.2$（单位：$\\mathrm{m}^2\\,\\mathrm{s}^{-2}$）。\n\n- 案例 5（顶部层极薄的非均匀网格，线性通量廓线）：\n  - $H = 1000\\,\\mathrm{m}$，$N=5$。\n  - 界面高度：$z_{w} = [0, 200, 400, 700, 999, 1000]$（单位：$\\mathrm{m}$）。\n  - 通量廓线：$\\overline{u^{\\prime} w^{\\prime}}(z) = F_0 \\left(1 - \\frac{z}{H}\\right)$，其中 $F_0 = 0.15$（单位：$\\mathrm{m}^2\\,\\mathrm{s}^{-2}$）。\n  - 地表值：$F_s = 0.15$（单位：$\\mathrm{m}^2\\,\\mathrm{s}^{-2}$）。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个元素本身都是一个用方括号括起来的、针对每个案例的 $S_u^{\\mathrm{conv}}$ 值（单位：$\\mathrm{m}\\,\\mathrm{s}^{-2}$）的逗号分隔列表。数值条目必须四舍五入到 $8$ 位小数，并且打印时不能有空格。例如，格式应类似于 $[[a_1,a_2,\\dots],[b_1,b_2,\\dots],\\dots]$，其中每个 $a_i$ 和 $b_i$ 都是四舍五入到 $8$ 位小数的浮点数。",
            "solution": "用户希望解决一个与数值天气预报中对流动量输送相关的问题。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n-   **控制方程**：对流纬向动量倾向 $S_u^{\\mathrm{conv}}(z)$ 由运动学湍流动量通量 $\\overline{u^{\\prime} w^{\\prime}}(z)$ 的负垂直散度给出。\n    $$ S_u^{\\mathrm{conv}}(z) = -\\frac{\\partial}{\\partial z} \\overline{u^{\\prime} w^{\\prime}}(z) $$\n-   **单位**：$z$ 的单位是 $\\mathrm{m}$，$\\overline{u^{\\prime} w^{\\prime}}$ 的单位是 $\\mathrm{m}^2\\,\\mathrm{s}^{-2}$，而 $S_u^{\\mathrm{conv}}$ 的单位是 $\\mathrm{m}\\,\\mathrm{s}^{-2}$。\n-   **网格结构**：使用垂直交错网格。\n    -   垂直区域从 $z=0$（地表）到 $z=H$（模式层顶）。\n    -   有 $N$ 个质量层（单元中心）和 $N+1$ 个界面层（$w$ 层）。\n    -   通量 $\\overline{u^{\\prime} w^{\\prime}}$ 定义在界面层上。\n    -   倾向 $S_u^{\\mathrm{conv}}$ 需要在质量层上计算。\n-   **边界条件**：\n    -   顶部边界 ($z=H$)：零通量，$\\overline{u^{\\prime} w^{\\prime}}(H) = 0$。\n    -   地表边界 ($z=0$)：指定的运动学地表应力，$\\overline{u^{\\prime} w^{\\prime}}(0) = F_s$。\n-   **离散化**：在交错网格上采用二阶中心差分近似，与非均匀网格上的有限体积解释一致。\n-   **测试用例**：提供了五个具体案例，每个案例包含：\n    -   模式层顶高度 $H$ 和质量层数 $N$。\n    -   一个包含 $N+1$ 个界面高度 $z_w$ 的列表。\n    -   通量廓线 $\\overline{u^{\\prime} w^{\\prime}}(z)$ 的定义，可以是解析函数或界面上的值列表。\n    -   一个特定的地表通量值 $F_s$。\n-   **输出要求**：对于每个案例，返回一个包含 $N$ 个倾向值的列表，四舍五入到 8 位小数。最终输出是这些列表的列表。\n\n**步骤 2：使用提取的已知条件进行验证**\n-   **科学基础（关键）**：该问题在根本上是合理的。将对流动量输送表示为湍流通量的散度是流体动力学中雷诺平均纳维-斯托克斯（RANS）模型化的基石，也是大气环流模型和数值天气预报系统的标准组成部分。交错网格布局（在某些情况下也称为 C-grid）是离散化守恒律的一种常用且有效的方法，因为它能自然地处理通量-散度形式。对于典型的行星边界层，所给的边界条件在物理上是标准的。\n-   **适定性**：该问题是一个直接计算，而不是求解未知场的微分方程。给定网格和界面上的通量值，计算单元中心的离散散度是一个明确定义的算术过程，对每个案例都会产生唯一的结果。\n-   **客观性（关键）**：问题以精确、量化的术语陈述。所有变量、常数和所需方法都得到了明确的定义。\n-   **完整性与一致性**：问题是自洽的。每个测试用例都提供了所有必要的信息（$H$, $N$, 网格点, 通量廓线, 边界值）。单位是一致的：通量（$\\mathrm{m}^2\\,\\mathrm{s}^{-2}$）对高度（$\\mathrm{m}$）的导数正确地得到了加速度单位（$\\mathrm{m}\\,\\mathrm{s}^{-2}$）的倾向。层数（$N$ 个质量层， $N+1$ 个界面层）与离散化方案一致。\n-   **真实性**：参数和物理值（网格间距，高达 $2\\,\\mathrm{km}$ 的高度，量级为 $0.1\\,\\mathrm{m}^2\\,\\mathrm{s}^{-2}$ 的通量值）对于大气边界层现象是符合实际的。\n-   **未检测到其他缺陷**：该问题不是比喻性的、琐碎的、不适定的或无法验证的。它是大气科学中一个标准的数值方法练习。\n\n**步骤 3：结论与行动**\n问题有效。我们将继续进行求解。\n\n### 求解推导与实现\n\n问题要求计算对流动量倾向，其定义为：\n$$ S_u^{\\mathrm{conv}}(z) = -\\frac{\\partial \\overline{u^{\\prime} w^{\\prime}}}{\\partial z} $$\n我们必须在垂直交错网格上对此方程进行离散化。设界面层由索引 $k$ 表示，从 $k=0$（地表）到 $k=N$（模式层顶）。界面高度为 $z_{w,k}$，在这些界面上定义的湍流通量为 $F_k = \\overline{u^{\\prime} w^{\\prime}}(z_{w,k})$。\n\n共有 $N$ 个质量层，或称网格单元。第 $k$ 个质量层（对于 $k=0, 1, \\dots, N-1$）是界面 $k$ 和界面 $k+1$ 之间的区域。倾向 $S_{u,k}^{\\mathrm{conv}}$ 就是为这个单元计算的。\n\n我们应用有限体积法，对于非均匀网格上的一维问题，这等效于中心有限差分。我们将控制方程在第 $k$ 个网格单元上进行积分，从 $z_{w,k}$ 到 $z_{w,k+1}$：\n$$ \\int_{z_{w,k}}^{z_{w,k+1}} S_u^{\\mathrm{conv}}(z) dz = - \\int_{z_{w,k}}^{z_{w,k+1}} \\frac{\\partial \\overline{u^{\\prime} w^{\\prime}}}{\\partial z} dz $$\n将微积分基本定理应用于右侧：\n$$ \\int_{z_{w,k}}^{z_{w,k+1}} S_u^{\\mathrm{conv}}(z) dz = - \\left[ \\overline{u^{\\prime} w^{\\prime}}(z_{w,k+1}) - \\overline{u^{\\prime} w^{\\prime}}(z_{w,k}) \\right] $$\n假设倾向 $S_u^{\\mathrm{conv}}(z)$ 在单元内为常数，其值为 $S_{u,k}^{\\mathrm{conv}}$，则左侧积分为 $S_{u,k}^{\\mathrm{conv}} \\cdot (z_{w,k+1} - z_{w,k})$。代入界面通量符号 $F_k$：\n$$ S_{u,k}^{\\mathrm{conv}} \\cdot (z_{w,k+1} - z_{w,k}) = - (F_{k+1} - F_k) $$\n求解第 $k$ 个质量层上的倾向，得到离散公式：\n$$ S_{u,k}^{\\mathrm{conv}} = - \\frac{F_{k+1} - F_k}{z_{w,k+1} - z_{w,k}} $$\n该公式表示导数的二阶精确中心差分，在区间 $[z_{w,k}, z_{w,k+1}]$ 的中点处求值，该中点即为质量层的位置。\n\n每个测试用例的实现步骤如下：\n1.  定义包含 $N+1$ 个界面高度的数组 $z_w$。\n2.  构建相应的包含 $N+1$ 个界面通量值的数组 $F$。\n    -   如果给定了分析廓线，则在每个 $z_{w,k}$ 处进行计算。\n    -   如果给定了值列表，则直接使用它们。\n3.  通过显式设置通量数组的第一个和最后一个元素来强制执行边界条件：$F_0 = F_s$ 和 $F_N = 0$。此步骤确保了稳健性并遵循问题规范。\n4.  使用推导出的离散公式计算 $N$ 个质量层（从 $k=0$ 到 $N-1$）中每一层的倾向。这可以通过数组操作高效完成。\n5.  收集所有测试用例的结果，并根据指定的输出要求进行格式化，确保每个数值都表示为 8 位小数。",
            "answer": "[[0.00020000,0.00020000,0.00020000,0.00020000,0.00020000],[0.00002500,0.00006500,0.00010875,0.00007875,0.00008275],[0.00300000,0.00000000,0.00000000,0.00000000,0.00000000],[0.00040000,0.00040000,0.00040000,0.00040000],[0.00015000,0.00015000,0.00015000,0.00014900,0.00001500]]"
        }
    ]
}