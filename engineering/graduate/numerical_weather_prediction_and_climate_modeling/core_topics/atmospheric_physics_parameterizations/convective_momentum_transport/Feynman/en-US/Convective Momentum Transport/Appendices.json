{
    "hands_on_practices": [
        {
            "introduction": "Parameterizing convective momentum transport in large-scale models often relies on a mass-flux framework, which explicitly represents the collective effect of convective updrafts and their environment. This first practice grounds this abstract concept in a concrete calculation, starting from the first principles of Reynolds averaging. By working through the derivation and applying it to idealized yet physically representative profiles, you will gain a tangible understanding of how the interplay between convective mass flux and wind shear generates momentum transport and directly influences the evolution of the mean atmospheric state .",
            "id": "4026941",
            "problem": "Consider a vertically one-dimensional, horizontally homogeneous marine boundary layer column used in numerical weather prediction and climate modeling, in which convective momentum transport is represented by a mass-flux framework. Assume constant air density $\\rho = 1.2~\\mathrm{kg~m^{-3}}$, cloud base height $z_b = 1000~\\mathrm{m}$, and that convective updrafts and their environment occupy complementary fractional areas. You are provided the following prescribed profiles for the convective mass flux per unit area $M(z)$, the conditional mean updraft horizontal wind $u_u(z)$, and the conditional mean environmental horizontal wind $u_e(z)$:\n- For height $z$ below cloud base, $0 \\le z \\le z_b$, the mass flux increases linearly with height: $M(z) = M_b \\frac{z}{z_b}$.\n- For height $z$ above cloud base, $z \\ge z_b$, the mass flux decays exponentially: $M(z) = M_b \\exp\\!\\big(-(z - z_b)/H\\big)$, where $H = 800~\\mathrm{m}$ is a decay scale.\n- The environmental wind profile is $u_e(z) = U_0 + S_e z$, where $U_0 = 6~\\mathrm{m~s^{-1}}$ and $S_e = 6 \\times 10^{-3}~\\mathrm{s^{-1}}$.\n- The updraft wind profile is $u_u(z) = U_0 + \\delta + S_u z$, where $\\delta = -1~\\mathrm{m~s^{-1}}$ and $S_u = 2 \\times 10^{-3}~\\mathrm{s^{-1}}$.\nLet the baseline cloud-base mass flux be $M_b = 0.050~\\mathrm{kg~m^{-2}~s^{-1}}$.\n\nWorking from first principles of Reynolds averaging and conditional sampling for organized convective flows, derive an expression for the kinematic convective momentum flux $\\overline{u'w'}(z)$ in terms of $M(z)$, $\\rho$, $u_u(z)$, and $u_e(z)$. Using this expression and the prescribed profiles, compute:\n1. The profile $\\overline{u'w'}(z)$ for $0 \\le z \\le 2000~\\mathrm{m}$.\n2. Its vertical divergence $\\partial \\overline{u'w'}/\\partial z$ at all heights, and explicitly evaluate its limit as $z \\to 0^+$ to obtain the convective contribution to the surface wind tendency via the mean momentum equation.\n\nFinally, suppose a transient deepening of convection increases the cloud-base mass flux by $30\\%$, so that $M_b \\to M_b' = M_b \\big(1 + 0.30\\big)$. Holding all other parameters fixed, compute the resulting change in the convective contribution to the surface wind tendency, $\\Delta\\big(\\partial \\overline{u}/\\partial t\\big)\\big|_{z \\to 0^+}$, due solely to the change in $M_b$. Round your answer to four significant figures and express it in $\\mathrm{m~s^{-2}}$.",
            "solution": "### Part 1: Derivation of the Kinematic Convective Momentum Flux, $\\overline{u'w'}(z)$\n\nWe start from the principles of Reynolds averaging and conditional sampling. The Reynolds-averaged horizontal velocity, $\\overline{u}$, is the sum of contributions from the convective updrafts (subscript $u$) and the environment (subscript $e$), weighted by their respective fractional areas ($a_u, a_e$): $\\overline{u} = a_u u_u + a_e u_e$, where $a_u + a_e = 1$. The total vertical mass flux, $\\overline{\\rho w}$, is assumed to be zero. Applying conditional sampling and assuming constant density $\\rho$:\n$$ \\overline{\\rho w} = \\rho a_u \\overline{w_u} + \\rho a_e \\overline{w_e} = 0 $$\nThe convective mass flux (per unit area) is defined as $M(z) = \\rho a_u \\overline{w_u}$. From the zero mean vertical mass flux condition, the mass flux in the environment must be $\\rho a_e \\overline{w_e} = -M(z)$.\n\nThe vertical flux of horizontal momentum is $\\overline{uw}$. Assuming $\\overline{w}=0$, this is equivalent to the kinematic covariance $\\overline{u'w'}$. Using conditional sampling again:\n$$ \\overline{u'w'} = \\overline{uw} = a_u u_u \\overline{w_u} + a_e u_e \\overline{w_e} $$\nSubstituting the expressions for area-weighted vertical velocities in terms of $M(z)$ and $\\rho$:\n$$ \\overline{u'w'}(z) = u_u(z) \\frac{M(z)}{\\rho} + u_e(z) \\left(-\\frac{M(z)}{\\rho}\\right) $$\nThis simplifies to the standard expression for kinematic convective momentum flux:\n$$ \\overline{u'w'}(z) = \\frac{M(z)}{\\rho} \\left( u_u(z) - u_e(z) \\right) $$\n\n### Part 2: Computation of Flux Profile and its Divergence\n\nFirst, we find the difference in horizontal wind:\n$$ u_u(z) - u_e(z) = (U_0 + \\delta + S_u z) - (U_0 + S_e z) = \\delta + (S_u - S_e)z $$\nSubstituting the given values, $\\delta = -1~\\mathrm{m~s^{-1}}$ and $S_u - S_e = (2 \\times 10^{-3} - 6 \\times 10^{-3})~\\mathrm{s^{-1}} = -4 \\times 10^{-3}~\\mathrm{s^{-1}}$.\n\nFor the sub-cloud layer ($0 \\le z \\le z_b$), the flux is:\n$$ \\overline{u'w'}(z) = \\frac{1}{\\rho} \\left(M_b \\frac{z}{z_b}\\right) \\left(\\delta + (S_u - S_e)z\\right) = \\frac{M_b}{\\rho z_b} \\left(\\delta z + (S_u - S_e)z^2\\right) $$\nThe vertical divergence of the flux in this layer is:\n$$ \\frac{\\partial \\overline{u'w'}}{\\partial z} = \\frac{d}{dz} \\left[ \\frac{M_b}{\\rho z_b} \\left(\\delta z + (S_u - S_e)z^2\\right) \\right] = \\frac{M_b}{\\rho z_b} \\left(\\delta + 2(S_u - S_e)z\\right) $$\nTo find the contribution to the surface wind tendency, we evaluate the limit of the divergence as $z \\to 0^+$:\n$$ \\lim_{z \\to 0^+} \\frac{\\partial \\overline{u'w'}}{\\partial z} = \\frac{M_b \\delta}{\\rho z_b} $$\nThe mean momentum equation is $\\partial \\overline{u}/\\partial t = -\\partial \\overline{u'w'}/\\partial z + \\dots$. The convective contribution to the surface wind tendency is therefore:\n$$ \\left(\\frac{\\partial \\overline{u}}{\\partial t}\\right)_{\\text{conv}} \\bigg|_{z \\to 0^+} = - \\lim_{z \\to 0^+} \\frac{\\partial \\overline{u'w'}}{\\partial z} = -\\frac{M_b \\delta}{\\rho z_b} $$\n\n### Part 3: Change in Surface Wind Tendency\n\nThe problem asks for the change in this tendency, $\\Delta\\left(\\frac{\\partial \\overline{u}}{\\partial t}\\right)\\big|_{z \\to 0^+}$, when $M_b$ is replaced by $M_b' = M_b(1 + 0.30) = 1.3 M_b$.\n\nThe initial tendency is $(\\frac{\\partial \\overline{u}}{\\partial t})_1 = -\\frac{M_b \\delta}{\\rho z_b}$.\nThe new tendency is $(\\frac{\\partial \\overline{u}}{\\partial t})_2 = -\\frac{M_b' \\delta}{\\rho z_b} = -\\frac{1.3 M_b \\delta}{\\rho z_b}$.\n\nThe change in the tendency is the difference between the new and initial values:\n$$ \\Delta\\left(\\frac{\\partial \\overline{u}}{\\partial t}\\right)\\bigg|_{z \\to 0^+} = \\left(\\frac{\\partial \\overline{u}}{\\partial t}\\right)_2 - \\left(\\frac{\\partial \\overline{u}}{\\partial t}\\right)_1 $$\n$$ \\Delta\\left(\\frac{\\partial \\overline{u}}{\\partial t}\\right)\\bigg|_{z \\to 0^+} = \\left(-\\frac{1.3 M_b \\delta}{\\rho z_b}\\right) - \\left(-\\frac{M_b \\delta}{\\rho z_b}\\right) = -\\frac{0.3 M_b \\delta}{\\rho z_b} $$\n\nNow, we substitute the numerical values:\n- $M_b = 0.050~\\mathrm{kg~m^{-2}~s^{-1}}$\n- $\\delta = -1~\\mathrm{m~s^{-1}}$\n- $\\rho = 1.2~\\mathrm{kg~m^{-3}}$\n- $z_b = 1000~\\mathrm{m}$\n\n$$ \\Delta\\left(\\frac{\\partial \\overline{u}}{\\partial t}\\right)\\bigg|_{z \\to 0^+} = - \\frac{0.3 \\times 0.050 \\times (-1)}{1.2 \\times 1000} = \\frac{0.015}{1200} $$\n$$ \\Delta\\left(\\frac{\\partial \\overline{u}}{\\partial t}\\right)\\bigg|_{z \\to 0^+} = 1.25 \\times 10^{-5}~\\mathrm{m~s^{-2}} $$\nRounding to four significant figures gives $1.250 \\times 10^{-5}~\\mathrm{m~s^{-2}}$.",
            "answer": "$$ \\boxed{1.250 \\times 10^{-5}} $$"
        },
        {
            "introduction": "Before the widespread adoption of mass-flux schemes, many models relied on simpler 'eddy-diffusivity' closures, which assume turbulent fluxes act to smooth out gradients in the mean flow, a so-called 'down-gradient' transport. This practice reveals the critical limitations of such local closures in the context of deep convection. By constructing a simple model of a tilted convective plume, you will demonstrate how nonlocal transport mechanisms can lead to 'counter-gradient' momentum flux, a result that directly contradicts the eddy-diffusivity assumption and highlights the need for more physically complete parameterizations .",
            "id": "4026982",
            "problem": "Consider a horizontally homogeneous, convective boundary layer in a numerical weather prediction model column, where the mean zonal wind is $U(z)$ and the vertical mean motion vanishes, $W(z)=0$. Let the Reynolds decomposition be $u=U(z)+u'(x,y,z,t)$ and $w=W(z)+w'(x,y,z,t)$, and define the Reynolds stress (vertical transport of zonal momentum) as the covariance $\\overline{u'w'}(z)$, where the overbar denotes a suitable space-time average. A widely used down-gradient eddy-diffusivity closure prescribes $\\overline{u'w'}(z)=-K_{m}(z)\\,\\partial U/\\partial z$, where $K_{m}(z)>0$ is the eddy viscosity. \n\nSuppose the large-scale mean wind increases linearly with height, $U(z)=U_{0}+S\\,z$, with constant shear $S>0$, and $K_{m}(z)=K_{m}$ is height-independent over the layer of interest. Now consider that convective momentum transport (CMT) is dominated by nonlocal, tilted plume exchange: the flow field is partitioned into two subdomains, an updraft occupying fraction $a$ of the horizontal area, with constant vertical velocity anomaly $w'_{u}=w_{u}>0$, and a compensating downdraft occupying fraction $1-a$, with constant $w'_{d}=w_{d}<0$. Mass continuity at the grid scale enforces $a\\,w_{u}+(1-a)\\,w_{d}=0$. Assume the plumes are uniformly tilted in the zonal plane by a small angle $\\theta$ (toward positive $x$ for $\\theta>0$) such that, to leading order in $\\tan\\theta$, the in-plume zonal velocity anomalies are geometrically slaved to the vertical anomalies: $u'_{p}=\\tan\\theta\\,w'_{p}$ for $p\\in\\{u,d\\}$. This represents nonlocal exchange whereby plume dynamics imprint a zonal momentum anomaly correlated with vertical motion, independent of the local mean shear.\n\n1. Starting from these foundations and constraints, derive an expression for the actual plume-induced covariance $\\overline{u'w'}$ in terms of $a$, $w_{u}$, $w_{d}$, and $\\theta$.\n2. Using mass continuity to eliminate $w_{d}$, simplify the expression to depend only on $a$, $w_{u}$, and $\\theta$.\n3. For the eddy-diffusivity closure, write the corresponding $\\overline{u'w'}_{\\text{eddy}}$ in terms of $K_{m}$ and $S$.\n4. With the following scientifically plausible parameter values: $a=0.20$, $w_{u}=2.0\\,\\text{m}\\,\\text{s}^{-1}$, $\\theta=5.710^{\\circ}$ (so that $\\tan\\theta=0.10$), $K_{m}=50\\,\\text{m}^{2}\\,\\text{s}^{-1}$, and $S=5.0\\times10^{-3}\\,\\text{s}^{-1}$, compute the dimensionless ratio \n$$\nR=\\frac{\\overline{u'w'}_{\\text{plume}}}{\\overline{u'w'}_{\\text{eddy}}}.\n$$\nThis ratio quantifies the sign and relative magnitude discrepancy between the nonlocal tilted-plume transport and the down-gradient closure. Express $R$ as a decimal value and round your answer to four significant figures. State no units for $R$ because it is dimensionless.",
            "solution": "The problem will be addressed by sequentially answering the four parts presented.\n\n### Part 1: Derivation of the Plume-Induced Covariance\nThe total momentum covariance $\\overline{u'w'}$ over the horizontal grid area is the area-weighted average of the local covariance contributions from the updraft (fractional area $a$) and downdraft (fractional area $1-a$) regions.\n$$\n\\overline{u'w'}_{\\text{plume}} = a \\cdot (u'w')_{\\text{updraft}} + (1-a) \\cdot (u'w')_{\\text{downdraft}}\n$$\nWe are given that the in-plume zonal velocity anomalies $u'_{p}$ are geometrically slaved to the vertical anomalies $w'_{p}$ via the relation $u'_{p} = \\tan\\theta \\, w'_{p}$ for $p \\in \\{u, d\\}$.\n\nFor the updraft region, with $w'_u = w_u$:\nThe product of anomalies is $(u'w')_{\\text{updraft}} = u'_{u} w'_{u} = (\\tan\\theta \\, w'_{u}) w'_{u} = \\tan\\theta \\, (w'_{u})^2 = \\tan\\theta \\, w_{u}^2$.\n\nFor the downdraft region, with $w'_d = w_d$:\nThe product of anomalies is $(u'w')_{\\text{downdraft}} = u'_{d} w'_{d} = (\\tan\\theta \\, w'_{d}) w'_{d} = \\tan\\theta \\, (w'_{d})^2 = \\tan\\theta \\, w_{d}^2$.\n\nSubstituting these expressions back into the area-weighted average formula:\n$$\n\\overline{u'w'}_{\\text{plume}} = a (\\tan\\theta \\, w_{u}^2) + (1-a) (\\tan\\theta \\, w_{d}^2)\n$$\nFactoring out the common term $\\tan\\theta$:\n$$\n\\overline{u'w'}_{\\text{plume}} = \\tan\\theta \\, (a \\, w_{u}^2 + (1-a) \\, w_{d}^2)\n$$\n\n### Part 2: Simplification using Mass Continuity\nThe grid-scale mass continuity constraint is $a \\, w_{u} + (1-a) \\, w_{d} = 0$. We use this to solve for $w_{d}$:\n$$\nw_{d} = -\\frac{a}{1-a} w_{u}\n$$\nNow, substitute this expression for $w_{d}$ into the result from Part 1:\n$$\n\\overline{u'w'}_{\\text{plume}} = \\tan\\theta \\, \\left( a \\, w_{u}^2 + (1-a) \\left( -\\frac{a}{1-a} w_{u} \\right)^2 \\right)\n$$\n$$\n\\overline{u'w'}_{\\text{plume}} = \\tan\\theta \\, \\left( a \\, w_{u}^2 + (1-a) \\frac{a^2}{(1-a)^2} w_{u}^2 \\right) = \\tan\\theta \\, \\left( a \\, w_{u}^2 + \\frac{a^2}{1-a} w_{u}^2 \\right)\n$$\nFactoring out the common term $a \\, w_{u}^2$:\n$$\n\\overline{u'w'}_{\\text{plume}} = \\tan\\theta \\, a \\, w_{u}^2 \\left( 1 + \\frac{a}{1-a} \\right) = \\tan\\theta \\, a \\, w_{u}^2 \\left( \\frac{1-a+a}{1-a} \\right)\n$$\nThis gives the final simplified expression for the plume-induced momentum transport:\n$$\n\\overline{u'w'}_{\\text{plume}} = \\frac{a}{1-a} w_{u}^2 \\tan\\theta\n$$\n\n### Part 3: Eddy-Diffusivity Closure\nThe down-gradient eddy-diffusivity closure is given as $\\overline{u'w'}(z) = -K_{m}(z) \\, \\frac{\\partial U}{\\partial z}$.\nThe problem specifies a linear mean wind profile $U(z) = U_{0} + S\\,z$, so the shear $\\frac{\\partial U}{\\partial z} = S$. The eddy viscosity is constant, $K_{m}(z) = K_{m}$.\nSubstituting these into the closure formula gives:\n$$\n\\overline{u'w'}_{\\text{eddy}} = -K_{m} S\n$$\n\n### Part 4: Computation of the Ratio $R$\nThe dimensionless ratio $R$ is defined as:\n$$\nR = \\frac{\\overline{u'w'}_{\\text{plume}}}{\\overline{u'w'}_{\\text{eddy}}} = \\frac{\\frac{a}{1-a} w_{u}^2 \\tan\\theta}{-K_{m} S} = -\\frac{a \\, w_{u}^2 \\tan\\theta}{(1-a) K_{m} S}\n$$\nWe substitute the given parameter values:\n$a = 0.20$\n$w_{u} = 2.0 \\, \\text{m}\\,\\text{s}^{-1}$\n$\\tan\\theta = 0.10$\n$K_{m} = 50 \\, \\text{m}^{2}\\,\\text{s}^{-1}$\n$S = 5.0 \\times 10^{-3} \\, \\text{s}^{-1}$\n\nFirst, compute the numerator of the fraction inside the expression for $R$:\n$$\na \\, w_{u}^2 \\tan\\theta = (0.20) \\cdot (2.0)^2 \\cdot (0.10) = 0.20 \\cdot 4.0 \\cdot 0.10 = 0.080\n$$\nNext, compute the denominator:\n$$\n(1-a) K_{m} S = (1-0.20) \\cdot (50) \\cdot (5.0 \\times 10^{-3}) = 0.80 \\cdot 50 \\cdot 0.0050 = 40 \\cdot 0.0050 = 0.20\n$$\nNow, we compute the ratio $R$:\n$$\nR = - \\frac{0.080}{0.20} = -0.4\n$$\nExpressed as a decimal value rounded to four significant figures, the answer is $-0.4000$. The negative sign indicates that the physically-based plume model predicts an upward flux of zonal momentum (counter-gradient), whereas the simple down-gradient closure predicts a downward flux.",
            "answer": "$$\n\\boxed{-0.4000}\n$$"
        },
        {
            "introduction": "This exercise bridges the gap between the continuous mathematical equations and the discrete algorithms used in weather and climate models. You will implement the vertical divergence of the momentum flux, whose negative gives the convective tendency $S_u^{\\mathrm{conv}}$, on a staggered grid. This is a fundamental technique that ensures momentum is conserved within the model column, providing a critical hands-on skill for computational atmospheric science .",
            "id": "4027038",
            "problem": "You are tasked with implementing the convective transport tendency of zonal momentum in a one-dimensional vertical column, consistent with numerical weather prediction and climate modeling practice. The convective contribution to the zonal momentum tendency is defined by the negative vertical divergence of the kinematic turbulent momentum flux. Starting from first principles, consider the Reynolds-averaged zonal momentum equation and interpret the convective contribution as a flux divergence. You must discretize the vertical divergence on a vertically staggered grid.\n\nGrid and variable arrangement:\n- The vertical coordinate is $z$ (in $\\mathrm{m}$), increasing upward, with the surface at $z=0$ and the model top at $z=H$.\n- The grid is staggered with $w$-levels at interfaces $z_{k+\\frac{1}{2}}$ and mass levels at cell centers between interfaces. There are $N$ mass levels and $N+1$ interface levels.\n- The kinematic turbulent momentum flux is $\\overline{u'w'}(z)$ (in $\\mathrm{m}^2\\,\\mathrm{s}^{-2}$), defined at $w$-levels (interfaces).\n- The convective zonal momentum tendency is $S_u^{\\mathrm{conv}}(z) = -\\partial_z \\overline{u'w'}(z)$ (in $\\mathrm{m}\\,\\mathrm{s}^{-2}$), to be evaluated at mass levels.\n\nBoundary conditions:\n- At the model top, impose zero flux: $\\overline{u'w'}(H) = 0$ (in $\\mathrm{m}^2\\,\\mathrm{s}^{-2}$).\n- At the surface, impose a specified kinematic surface stress: $\\overline{u'w'}(0) = F_s$ (in $\\mathrm{m}^2\\,\\mathrm{s}^{-2}$). Here $F_s$ is provided as part of each test case.\n\nDiscretization requirement:\n- Use a second-order centered-difference approximation on the staggered grid to compute $S_u^{\\mathrm{conv}}$ at each mass level from the interface values of $\\overline{u'w'}$. The design must be consistent with a finite-volume interpretation of flux divergence on nonuniform grids.\n\nUnits and output:\n- Express every component of $S_u^{\\mathrm{conv}}$ in $\\mathrm{m}\\,\\mathrm{s}^{-2}$.\n- For each test case, return the list of $S_u^{\\mathrm{conv}}$ values at all mass levels, rounded to $8$ decimal places.\n\nTest suite:\nImplement your program to compute $S_u^{\\mathrm{conv}}$ for the following five cases. In each case, you are given the interface heights and a profile for $\\overline{u'w'}$ evaluated at those interfaces. You must first enforce the boundary conditions by setting the bottom interface value to the specified surface value $F_s$ and the top interface value to $0$, and then compute the discrete tendency at mass levels using the required scheme.\n\n- Case $1$ (uniform grid, linear flux profile):\n  - $H = 1000\\,\\mathrm{m}$, $N=5$.\n  - Interface heights: $z_{w} = [0, 200, 400, 600, 800, 1000]$ (in $\\mathrm{m}$).\n  - Flux profile: $\\overline{u'w'}(z) = F_0 \\left(1 - \\frac{z}{H}\\right)$ with $F_0 = 0.2$ (in $\\mathrm{m}^2\\,\\mathrm{s}^{-2}$).\n  - Surface value: $F_s = 0.2$ (in $\\mathrm{m}^2\\,\\mathrm{s}^{-2}$).\n\n- Case $2$ (nonuniform grid, quadratic flux profile):\n  - $H = 2000\\,\\mathrm{m}$, $N=5$.\n  - Interface heights: $z_{w} = [0, 100, 250, 500, 900, 2000]$ (in $\\mathrm{m}$).\n  - Flux profile: $\\overline{u'w'}(z) = F_0 \\left(1 - \\left(\\frac{z}{H}\\right)^2\\right)$ with $F_0 = 0.1$ (in $\\mathrm{m}^2\\,\\mathrm{s}^{-2}$).\n  - Surface value: $F_s = 0.1$ (in $\\mathrm{m}^2\\,\\mathrm{s}^{-2}$).\n\n- Case $3$ (impulsive bottom flux, zero above):\n  - $H = 500\\,\\mathrm{m}$, $N=5$.\n  - Interface heights: $z_{w} = [0, 100, 200, 300, 400, 500]$ (in $\\mathrm{m}$).\n  - Flux profile: $\\overline{u'w'}(z) = 0$ for $z > 0$; at the surface $z=0$ use the specified $F_s$.\n  - Surface value: $F_s = 0.3$ (in $\\mathrm{m}^2\\,\\mathrm{s}^{-2}$).\n\n- Case $4$ (sign-changing flux on a uniform grid):\n  - $H = 1000\\,\\mathrm{m}$, $N=4$.\n  - Interface heights: $z_{w} = [0, 250, 500, 750, 1000]$ (in $\\mathrm{m}$).\n  - Flux profile values at interfaces: $\\overline{u'w'} = [0.2, 0.1, 0.0, -0.1, 0.0]$ (in $\\mathrm{m}^2\\,\\mathrm{s}^{-2}$).\n  - Surface value: $F_s = 0.2$ (in $\\mathrm{m}^2\\,\\mathrm{s}^{-2}$).\n\n- Case $5$ (nonuniform grid with a very thin top layer, linear flux profile):\n  - $H = 1000\\,\\mathrm{m}$, $N=5$.\n  - Interface heights: $z_{w} = [0, 200, 400, 700, 999, 1000]$ (in $\\mathrm{m}$).\n  - Flux profile: $\\overline{u'w'}(z) = F_0 \\left(1 - \\frac{z}{H}\\right)$ with $F_0 = 0.15$ (in $\\mathrm{m}^2\\,\\mathrm{s}^{-2}$).\n  - Surface value: $F_s = 0.15$ (in $\\mathrm{m}^2\\,\\mathrm{s}^{-2}$).\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is itself a bracketed, comma-separated list of the rounded $S_u^{\\mathrm{conv}}$ values (in $\\mathrm{m}\\,\\mathrm{s}^{-2}$) for each case. The numerical entries must be rounded to $8$ decimal places and printed without spaces. For example, the format should be like $[[a_1,a_2,\\dots],[b_1,b_2,\\dots],\\dots]$ where each $a_i$ and $b_i$ is a float rounded to $8$ decimals.",
            "solution": "### Discretization Scheme\n\nThe convective momentum tendency is defined as $S_u^{\\mathrm{conv}}(z) = -\\frac{\\partial \\overline{u'w'}}{\\partial z}$. To discretize this on a staggered grid, we use a finite-volume approach. For the $k$-th mass level, which is the volume between interfaces $z_{w,k}$ and $z_{w,k+1}$, the tendency $S_{u,k}^{\\mathrm{conv}}$ is given by the negative of the net flux out of the cell, divided by the cell volume (or, in 1D, height).\n$$ S_{u,k}^{\\mathrm{conv}} = - \\frac{\\overline{u'w'}_{k+1} - \\overline{u'w'}_k}{z_{w,k+1} - z_{w,k}} $$\nwhere $\\overline{u'w'}_k$ is the flux at the $k$-th interface, and this formula is applied for each mass level $k=0, \\dots, N-1$.\n\n### Case-by-Case Calculations\n\nIn each case, we first establish the array of flux values at the $N+1$ interfaces, applying the boundary conditions $F_0=F_s$ and $F_N=0$. Then we apply the formula above.\n\n**Case 1:**\n-   $z_w = [0, 200, 400, 600, 800, 1000]$. $\\Delta z_k = 200$ for all $k$.\n-   Flux profile: $F(z) = 0.2(1 - z/1000)$.\n-   Interface fluxes: $F = [0.2, 0.16, 0.12, 0.08, 0.04, 0]$. These already satisfy the BCs.\n-   Tendency: $S_{u,k}^{\\mathrm{conv}} = -(F_{k+1}-F_k)/200$. Since $F_{k+1}-F_k = -0.04$ for all $k$, the tendency is constant: $-(-0.04)/200 = 0.0002$.\n-   Result: $[0.00020000, 0.00020000, 0.00020000, 0.00020000, 0.00020000]$\n\n**Case 2:**\n-   $z_w = [0, 100, 250, 500, 900, 2000]$. $\\Delta z = [100, 150, 250, 400, 1100]$.\n-   Flux profile: $F(z) = 0.1(1-(z/2000)^2)$.\n-   Interface fluxes: $F_0=0.1$, $F_1=0.09975$, $F_2=0.0984375$, $F_3=0.09375$, $F_4=0.07975$, $F_5=0$.\n-   $S_{u,0}^{\\mathrm{conv}} = -(0.09975-0.1)/100 = 0.0000025$.\n-   $S_{u,1}^{\\mathrm{conv}} = -(0.0984375-0.09975)/150 = 0.00000875$.\n-   $S_{u,2}^{\\mathrm{conv}} = -(0.09375-0.0984375)/250 = 0.00001875$.\n-   $S_{u,3}^{\\mathrm{conv}} = -(0.07975-0.09375)/400 = 0.000035$.\n-   $S_{u,4}^{\\mathrm{conv}} = -(0.0-0.07975)/1100 = 0.0000725$.\n-   Result: $[0.00000250, 0.00000875, 0.00001875, 0.00003500, 0.00007250]$\n\n**Case 3:**\n-   $z_w = [0, 100, 200, 300, 400, 500]$. $\\Delta z = 100$.\n-   Interface fluxes: $F_s=0.3$, $F_{k>0}=0$. So, $F = [0.3, 0, 0, 0, 0, 0]$.\n-   $S_{u,0}^{\\mathrm{conv}} = -(0-0.3)/100 = 0.003$.\n-   $S_{u,k>0}^{\\mathrm{conv}} = -(0-0)/100 = 0$.\n-   Result: $[0.00300000, 0.00000000, 0.00000000, 0.00000000, 0.00000000]$\n\n**Case 4:**\n-   $z_w = [0, 250, 500, 750, 1000]$. $\\Delta z = 250$.\n-   Interface fluxes: $F = [0.2, 0.1, 0.0, -0.1, 0.0]$ (BCs satisfied).\n-   $S_{u,0}^{\\mathrm{conv}} = -(0.1-0.2)/250 = 0.0004$.\n-   $S_{u,1}^{\\mathrm{conv}} = -(0.0-0.1)/250 = 0.0004$.\n-   $S_{u,2}^{\\mathrm{conv}} = -(-0.1-0.0)/250 = 0.0004$.\n-   $S_{u,3}^{\\mathrm{conv}} = -(0.0-(-0.1))/250 = -0.0004$.\n-   Result: $[0.00040000, 0.00040000, 0.00040000, -0.00040000]$\n\n**Case 5:**\n-   $z_w = [0, 200, 400, 700, 999, 1000]$. $\\Delta z = [200, 200, 300, 299, 1]$.\n-   Flux profile: $F(z) = 0.15(1-z/1000)$.\n-   Interface fluxes: $F_0=0.15$, $F_1=0.12$, $F_2=0.09$, $F_3=0.045$, $F_4=0.00015$, $F_5=0$.\n-   The flux divergence of a linear function is constant. Analytically, $\\partial F/\\partial z = -0.15/1000 = -0.00015$. The tendency is $-\\partial F/\\partial z = 0.00015$. The numerical scheme should recover this value for all layers.\n-   $S_{u,0}^{\\mathrm{conv}} = -(0.12-0.15)/200 = 0.00015$.\n-   $S_{u,1}^{\\mathrm{conv}} = -(0.09-0.12)/200 = 0.00015$.\n-   $S_{u,2}^{\\mathrm{conv}} = -(0.045-0.09)/300 = 0.00015$.\n-   $S_{u,3}^{\\mathrm{conv}} = -(0.00015-0.045)/299 = 0.00015$.\n-   $S_{u,4}^{\\mathrm{conv}} = -(0.0-0.00015)/1 = 0.00015$.\n-   Result: $[0.00015000, 0.00015000, 0.00015000, 0.00015000, 0.00015000]$",
            "answer": "[[0.00020000,0.00020000,0.00020000,0.00020000,0.00020000],[0.00000250,0.00000875,0.00001875,0.00003500,0.00007250],[0.00300000,0.00000000,0.00000000,0.00000000,0.00000000],[0.00040000,0.00040000,0.00040000,-0.00040000],[0.00015000,0.00015000,0.00015000,0.00015000,0.00015000]]"
        }
    ]
}