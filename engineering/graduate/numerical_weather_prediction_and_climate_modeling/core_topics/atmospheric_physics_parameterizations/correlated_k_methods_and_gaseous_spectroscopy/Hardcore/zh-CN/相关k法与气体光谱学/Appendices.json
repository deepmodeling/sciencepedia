{
    "hands_on_practices": [
        {
            "introduction": "应用相关k分布方法的第一步是将高分辨率的光谱数据转化为计算上更高效的k分布。本实践为此过程提供了基本蓝图。通过这个练习 ，您将实现其核心算法——对吸收系数进行排序以构建$k(g)$函数，然后使用数值求积法计算波段平均透过率，这是辐射传输建模中的一项基本技能。",
            "id": "4028159",
            "problem": "给定一个均匀大气层的单个光谱带上采样的一组离散单色吸收系数$k_{\\nu}$。您必须从比尔-朗伯定律和单色吸收系数的累积分布定义出发，设计并实现一个算法，以构建k-分布函数$k(g)$的数值近似，然后使用$N$个等间距的g点计算波段透过率。\n\n使用以下基本依据：\n- 比尔-朗伯定律通过$T_{\\nu}=\\exp(-k_{\\nu}u)$将单色透过率$T_{\\nu}$与吸收系数$k_{\\nu}$和吸收物质路径量$u$联系起来。\n- 波段透过率可表示为在$k_{\\nu}$值的累积概率空间上的平均值，这需要使用波段内吸收系数的累积分布函数（CDF）。\n\n您的任务是：\n- 将集合$\\{k_{\\nu}\\}$视为从波段内吸收系数分布中抽取的样本。\n- 通过对样本进行排序并定义一个相关的累积坐标$g\\in(0,1)$来构建单调近似函数$k(g)$。\n- 使用开区间$(0,1)$内的$N$个等间距g点来计算$\\exp(-k(g)u)$，并将其算术平均值作为波段透过率。\n\n数值和单位要求：\n- 吸收系数$k_{\\nu}$的单位为平方米每千克（$\\mathrm{m^2\\,kg^{-1}}$）。\n- 吸收物质路径量$u$的单位为千克每平方米（$\\mathrm{kg\\,m^{-2}}$）。\n- 波段透过率是无量纲的，并且必须表示为小数点后保留八位的小数。\n- 本问题不涉及角度。\n\n算法约束：\n- 使用中点法为已排序的样本定义累积坐标，即对于$M$个样本，排序后的累积位置为$g_{j}=\\frac{j+1/2}{M}$，其中$j\\in\\{0,1,\\dots,M-1\\}$。\n- 在点集$\\{(g_{j}, k_{(j)})\\}$上通过分段线性插值来近似$k(g)$，其中$k_{(j)}$是$\\{k_{\\nu}\\}$升序排序后的第j个元素。\n- 在$N$个等间距的中点$g_{i}=\\frac{i+1/2}{N}$（其中$i\\in\\{0,1,\\dots,N-1\\}$）处进行求值。\n- 将这$N$个评估值的算术平均值作为波段透过率进行计算。\n\n测试套件：\n为下列每组参数计算波段透过率。每个结果必须是一个浮点数（四舍五入到小数点后八位）。\n\n- 情况1（通用，多尺度分布）：$k_{\\nu}=\\left[1.0\\times 10^{-3},\\,5.0\\times 10^{-3},\\,2.0\\times 10^{-2},\\,4.0\\times 10^{-2},\\,1.0\\times 10^{-1},\\,2.0\\times 10^{-1},\\,5.0\\times 10^{-1},\\,1.0,\\,2.0,\\,5.0,\\,10.0,\\,20.0\\right]$，单位 $\\mathrm{m^2\\,kg^{-1}}$，$u=0.01$，单位 $\\mathrm{kg\\,m^{-2}}$，$N=10$。\n- 情况2（求积点数的边界情况）：$k_{\\nu}=\\left[1.0\\times 10^{-2},\\,1.0\\times 10^{-1},\\,1.0,\\,10.0,\\,100.0\\right]$，单位 $\\mathrm{m^2\\,kg^{-1}}$，$u=0.1$，单位 $\\mathrm{kg\\,m^{-2}}$，$N=1$。\n- 情况3（均匀吸收系数）：$k_{\\nu}=\\left[5.0\\times 10^{-2},\\,5.0\\times 10^{-2},\\,5.0\\times 10^{-2},\\,5.0\\times 10^{-2},\\,5.0\\times 10^{-2},\\,5.0\\times 10^{-2},\\,5.0\\times 10^{-2},\\,5.0\\times 10^{-2}\\right]$，单位 $\\mathrm{m^2\\,kg^{-1}}$，$u=1.0$，单位 $\\mathrm{kg\\,m^{-2}}$，$N=4$。\n- 情况4（包含零和强吸收线）：$k_{\\nu}=\\left[0.0,\\,0.0,\\,0.0,\\,1.0\\times 10^{-2},\\,1.0\\times 10^{-1},\\,1.0,\\,10.0\\right]$，单位 $\\mathrm{m^2\\,kg^{-1}}$，$u=10.0$，单位 $\\mathrm{kg\\,m^{-2}}$，$N=7$。\n- 情况5（高度偏斜分布）：$k_{\\nu}=\\left[1.0\\times 10^{-6},\\,2.0\\times 10^{-6},\\,5.0\\times 10^{-6},\\,1.0\\times 10^{-5},\\,2.0\\times 10^{-5},\\,5.0\\times 10^{-5},\\,1.0\\times 10^{-4},\\,2.0\\times 10^{-4},\\,1.0\\times 10^{-3},\\,1.0\\times 10^{-2},\\,1.0\\times 10^{-1}\\right]$，单位 $\\mathrm{m^2\\,kg^{-1}}$，$u=2.0$，单位 $\\mathrm{kg\\,m^{-2}}$，$N=16$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表。这五个波段透过率值必须按照上述测试套件的顺序排列。例如：$[t_{1},t_{2},t_{3},t_{4},t_{5}]$，其中每个$t_{i}$都是一个小数点后保留八位的小数。",
            "solution": "用户提供的问题已经过严格验证，被认为是科学上合理、适定、客观和完整的。所有必要的数据和算法规范都已提供，并且该问题基于大气辐射传输的既定原理。因此，我们可以着手提供完整的解决方案。\n\n此问题的核心是使用相关k分布方法来近似一个波段上的光谱平均透过率$\\bar{T}$。其基本原理是将积分变量从光谱频率$\\nu$变换为吸收系数$k$。\n\n通过一个均匀大气层（吸收物质路径量为$u$）的单色透过率$T_\\nu$由比尔-朗伯定律给出：\n$$ T_\\nu = \\exp(-k_\\nu u) $$\n其中$k_\\nu$是单色吸收系数。\n\n波段平均透过率$\\bar{T}$是$T_\\nu$在光谱带$\\Delta\\nu$上的算术平均值：\n$$ \\bar{T} = \\frac{1}{\\Delta\\nu} \\int_{\\Delta\\nu} T_\\nu \\,d\\nu = \\frac{1}{\\Delta\\nu} \\int_{\\Delta\\nu} \\exp(-k_\\nu u) \\,d\\nu $$\n相关k方法通过考虑波段内$k_\\nu$值的统计分布来重新表述此积分。我们引入一个累积分布函数（CDF）$g(k)$，其定义为光谱带内吸收系数小于或等于某个值$k$的部分所占的比例。该函数的反函数$k(g)$将一个累积概率$g \\in (0,1)$映射到一个特定的吸收系数值。由于$g$在区间$(0,1)$上是均匀分布的，因此波段透过率的积分可以重写为：\n$$ \\bar{T} = \\int_0^1 \\exp(-k(g) u) \\,dg $$\n该公式是精确的。本问题要求我们基于一个包含$M$个吸收系数的离散集合$\\{k_{\\nu, m}\\}_{m=1}^M$来构建此积分的数值近似。\n\n指定的算法按以下步骤进行：\n\n1.  **构建$k(g)$的离散近似**：将提供的$M$个吸收系数集合$\\{k_\\nu\\}$视为潜在分布的代表性样本。\n    -   首先，将这些样本按升序排序，创建一个单调序列，记为$\\{k_{(j)}\\}_{j=0}^{M-1}$。\n    -   接着，为每个排序后的值$k_{(j)}$分配一个累积坐标$g_j$。问题指定使用累积概率空间中每个区间的中心点：\n        $$ g_j = \\frac{j + 1/2}{M} \\quad \\text{for } j=0, 1, \\dots, M-1 $$\n    -   生成的点对$\\{(g_j, k_{(j)})\\}$构成了函数$k(g)$的一个离散表示。问题接着要求通过在这些点上进行分段线性插值来近似连续函数$k(g)$。\n\n2.  **近似透过率积分**：使用数值求积方案来近似关于$g$的积分。\n    -   积分域$(0,1)$被划分为$N$个等间距的区间。求积点选择为这些区间的中点：\n        $$ g^*_i = \\frac{i + 1/2}{N} \\quad \\text{for } i=0, 1, \\dots, N-1 $$\n    -   对于每个求积点$g^*_i$，通过对由点集$\\{(g_j, k_{(j)})\\}$定义的函数进行线性插值，来确定相应的吸收系数$k(g^*_i)$。\n    -   然后，将在这$N$个求积点上计算出的透过率值的算术平均值作为积分的近似值。这等同于数值积分的中点法则：\n        $$ \\bar{T} \\approx \\frac{1}{N} \\sum_{i=0}^{N-1} \\exp(-k(g^*_i) u) $$\n\n最终的实现将封装这一逻辑。给定一组原始吸收系数$\\{k_\\nu\\}$、路径量$u$和求积点数$N$，该算法将：\n1.  确定输入样本的数量$M$。\n2.  对$\\{k_\\nu\\}$进行排序以获得$\\{k_{(j)}\\}$。\n3.  生成累积坐标$g_j = (j+0.5)/M$。\n4.  生成求积点$g^*_i = (i+0.5)/N$。\n5.  使用标准的线性插值程序（例如`numpy.interp`）根据数据点$(g_j, k_{(j)})$来查找$k(g^*_i)$的值。该函数将处理$g^*_i$落在两个$g_j$点之间的情况。对于评估点在范围$[g_0, g_{M-1}]$之外的情况，常数外插是一种标准且合理的选择，等效于当$g<g_0$时使用$k(g)=k_{(0)}$以及当$g>g_{M-1}$时使用$k(g)=k_{(M-1)}$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test suite.\n    It computes band transmittance using the correlated-k method for several cases.\n    \"\"\"\n\n    def calculate_band_transmittance(k_nu: list[float], u: float, N: int) -> float:\n        \"\"\"\n        Calculates the band transmittance using the specified correlated-k algorithm.\n\n        Args:\n            k_nu: A list of monochromatic absorption coefficients [m^2 kg^-1].\n            u: The absorber path amount [kg m^-2].\n            N: The number of equally spaced quadrature points for g-space integration.\n\n        Returns:\n            The dimensionless band transmittance, rounded to 8 decimal places.\n        \"\"\"\n        # Ensure k_nu is a numpy array for vectorized operations.\n        k_nu_arr = np.array(k_nu, dtype=np.float64)\n        M = len(k_nu_arr)\n\n        if M == 0:\n            # Handle empty k_nu list: transmittance is 1.\n            return 1.0\n\n        # Step 1: Create the monotone function k(g) by rank-ordering the samples.\n        # This gives the k_(j) values.\n        k_sorted = np.sort(k_nu_arr)\n\n        # Step 2: Define the associated cumulative coordinate g_j for the sorted samples.\n        # g_j = (j + 0.5) / M for j in {0, 1, ..., M-1}\n        g_j = (np.arange(M) + 0.5) / M\n\n        # Step 3: Define the N equally spaced quadrature midpoints g_i*.\n        # g_i* = (i + 0.5) / N for i in {0, 1, ..., N-1}\n        g_i_star = (np.arange(N) + 0.5) / N\n\n        # Step 4: Approximate k(g) by piecewise-linear interpolation.\n        # Evaluate k at the quadrature points g_i_star using the discrete\n        # (g_j, k_sorted) representation. numpy.interp handles this efficiently.\n        # It uses constant extrapolation by default for points outside the g_j range,\n        # which is a reasonable choice here.\n        k_at_g_i_star = np.interp(g_i_star, g_j, k_sorted)\n\n        # Step 5: Evaluate exp(-k(g)u) at each quadrature point.\n        # This is an array of transmittance values, one for each g-point.\n        transmittances_at_g_i_star = np.exp(-k_at_g_i_star * u)\n\n        # Step 6: Form the arithmetic mean as the band transmittance.\n        # This approximates the integral integral(exp(-k(g)u) dg) from 0 to 1.\n        band_transmittance = np.mean(transmittances_at_g_i_star)\n\n        # Return the final value rounded to the specified precision.\n        return round(band_transmittance, 8)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (general, multi-scale distribution)\n        {'k_nu': [1.0e-3, 5.0e-3, 2.0e-2, 4.0e-2, 1.0e-1, 2.0e-1, 5.0e-1, 1.0, 2.0, 5.0, 10.0, 20.0], 'u': 0.01, 'N': 10},\n        # Case 2 (boundary in quadrature size)\n        {'k_nu': [1.0e-2, 1.0e-1, 1.0, 10.0, 100.0], 'u': 0.1, 'N': 1},\n        # Case 3 (uniform absorption coefficients)\n        {'k_nu': [5.0e-2, 5.0e-2, 5.0e-2, 5.0e-2, 5.0e-2, 5.0e-2, 5.0e-2, 5.0e-2], 'u': 1.0, 'N': 4},\n        # Case 4 (including zeros and strong lines)\n        {'k_nu': [0.0, 0.0, 0.0, 1.0e-2, 1.0e-1, 1.0, 10.0], 'u': 10.0, 'N': 7},\n        # Case 5 (highly skewed distribution)\n        {'k_nu': [1.0e-6, 2.0e-6, 5.0e-6, 1.0e-5, 2.0e-5, 5.0e-5, 1.0e-4, 2.0e-4, 1.0e-3, 1.0e-2, 1.0e-1], 'u': 2.0, 'N': 16}\n    ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_band_transmittance(case['k_nu'], case['u'], case['N'])\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "将相关k分布方法应用于多层大气时，一个关键假设是吸收系数的秩排序在各层之间是完全相关的。本实践  通过构建一个有力的反例来挑战这一假设。利用一个简化的双谱线光谱模型，您将展示依赖于温度的谱线强度交叉如何破坏这种相关性，从而导致可量化的透过率计算误差。",
            "id": "4028133",
            "problem": "本题要求您形式化并量化一个在数值天气预报和气候模拟的辐射方案中使用的相关吸收系数（相关k）近似的一个著名失效模式。该失效模式发生在当谱线强度随温度变化而交叉时，导致吸收系数在频率上的秩次序在不同层之间不被保持。您的任务是构建一个具体的反例，从第一性原理计算精确的复合层带平均透射率，计算相应的完全相关k近似，并报告其导致的相对误差。\n\n从比尔-朗伯定律和一个最小光谱模型开始：\n\n- 通过一层叠层的单色透射率由$T(\\nu) = \\exp\\left(-\\sum_{\\ell} k_{\\ell}(\\nu) u_{\\ell}\\right)$给出，其中$k_{\\ell}(\\nu)$是层$\\ell$中的单色吸收系数，$u_{\\ell}$是层$\\ell$中的吸收体柱量。透射率$T(\\nu)$是无量纲的。\n\n- 假设一个窄光谱带包含两条孤立的谱线，中心分别位于$\\nu_A$和$\\nu_B$。层$\\ell$中的单色吸收系数被建模为两条谱线的叠加：\n$$k_{\\ell}(\\nu) = S_A(T_{\\ell})\\phi(\\nu-\\nu_A;\\sigma) + S_B(T_{\\ell})\\phi(\\nu-\\nu_B;\\sigma)$$\n其中$\\phi$是一个具有完全归一化的归一化高斯线型：\n$$\\phi(\\nu-\\nu_0;\\sigma) = \\frac{1}{\\sqrt{2\\pi}\\sigma}\\exp\\left(-\\frac{(\\nu-\\nu_0)^2}{2\\sigma^2}\\right), \\quad \\int_{-\\infty}^{\\infty}\\phi(\\nu-\\nu_0;\\sigma)d\\nu = 1$$\n且$\\sigma$是高斯函数的标准差。为方便数值计算，将$\\nu$视为一个无量纲的类频率变量。\n\n- 使用一个简化的、有物理动机的谱线强度模型（玻尔兹曼标度，能量以开尔文为单位测量，从而吸收了玻尔兹曼常数）：\n$$S_i(T) = C_i\\exp\\left(-\\frac{E_i}{T}\\right), \\quad i\\in\\{A,B\\}$$\n其中$C_i$是一个正常数，$E_i$是以开尔文为单位的有效低能态能量，$T$是以开尔文为单位的温度。当$S_A(T)$和$S_B(T)$在两个温度之间交换次序时，该模型能捕捉到谱线强度的交叉现象。\n\n- 在离散均匀网格$\\{\\nu_j\\}_{j=1}^{N}$上的精确带平均透射率为：\n$$\\overline{T}_{\\mathrm{exact}} = \\frac{1}{N}\\sum_{j=1}^{N} \\exp\\left( - \\sum_{\\ell} k_{\\ell}(\\nu_j)u_{\\ell} \\right)。$$\n\n- 完全相关k复合层近似的构建方法是：对每一层独立地将吸收系数样本$\\{k_{\\ell}(\\nu_j)\\}_{j=1}^{N}$排序成非递减序列$\\{k_{\\ell}^{\\ast}(g_j)\\}_{j=1}^{N}$，其中$g_j = \\frac{j-1/2}{N}$，然后在相等的$g_j$处跨层配对：\n$$\\overline{T}_{\\mathrm{corr}} = \\frac{1}{N}\\sum_{j=1}^{N} \\exp\\left( - \\sum_{\\ell} k_{\\ell}^{\\ast}(g_j)u_{\\ell} \\right)。$$\n这体现了跨层吸收系数具有完全秩相关的假设。当谱线强度发生交叉时，从$g$到频率的映射因层而异，从而违反了该假设并引入误差。\n\n构建一个离散化反例，并量化其导致的相对误差：\n$$\\epsilon = \\frac{\\overline{T}_{\\mathrm{corr}} - \\overline{T}_{\\mathrm{exact}}}{\\overline{T}_{\\mathrm{exact}}}。$$\n透射率和$\\epsilon$都是无量纲数，必须以小数形式报告。\n\n数值实现所需的实施细节：\n\n- 对于每个测试，使用一个包含$N$个点的$\\nu$的均匀网格，范围从$\\min(\\nu_A,\\nu_B) - 6\\sigma$到$\\max(\\nu_A,\\nu_B) + 6\\sigma$，以捕捉高斯尾部。使用离散算术平均来近似带积分。\n\n- 温度$T$必须以开尔文为单位指定，能量$E_i$以开尔文为单位（即$E_i/k_B$），高斯宽度$\\sigma$使用与$\\nu$相同的无量纲单位。在此构造中，柱量$u_{\\ell}$是无量纲的。所有输出均为无量纲。\n\n您的程序必须为以下每个测试用例计算$\\epsilon$，并将它们作为一个列表打印出来。每个输出值必须四舍五入到8位小数。\n\n测试套件（每行一个用例）：\n\n1. 交叉，中等光学深度：\n   - $T_1 = 250$, $T_2 = 300$, $u_1 = 1.0$, $u_2 = 1.0$, $N = 4001$,\n   - $\\nu_A = -2.0$, $\\nu_B = 2.0$, $\\sigma = 0.5$,\n   - $C_A = 50.0$, $E_A = 1500.0$, $C_B = 1.0$, $E_B = 500.0$。\n\n2. 无交叉，中等光学深度：\n   - $T_1 = 250$, $T_2 = 300$, $u_1 = 1.0$, $u_2 = 1.0$, $N = 4001$,\n   - $\\nu_A = -2.0$, $\\nu_B = 2.0$, $\\sigma = 0.5$,\n   - $C_A = 1.0$, $E_A = 400.0$, $C_B = 0.8$, $E_B = 800.0$。\n\n3. 相同层（完全相关），混合光学深度：\n   - $T_1 = 275$, $T_2 = 275$, $u_1 = 1.3$, $u_2 = 0.7$, $N = 4001$,\n   - $\\nu_A = -2.0$, $\\nu_B = 2.0$, $\\sigma = 0.5$,\n   - $C_A = 50.0$, $E_A = 1500.0$, $C_B = 1.0$, $E_B = 500.0$。\n\n4. 交叉，强光学深度（饱和趋势）：\n   - $T_1 = 250$, $T_2 = 300$, $u_1 = 5.0$, $u_2 = 5.0$, $N = 4001$,\n   - $\\nu_A = -2.0$, $\\nu_B = 2.0$, $\\sigma = 0.5$,\n   - $C_A = 50.0$, $E_A = 1500.0$, $C_B = 1.0$, $E_B = 500.0$。\n\n5. 谱线重叠的交叉：\n   - $T_1 = 260$, $T_2 = 290$, $u_1 = 1.0$, $u_2 = 1.0$, $N = 4001$,\n   - $\\nu_A = -0.3$, $\\nu_B = 0.3$, $\\sigma = 0.4$,\n   - $C_A = 50.0$, $E_A = 1500.0$, $C_B = 1.0$, $E_B = 500.0$。\n\n6. 边界情况，零路径（平凡透射率）：\n   - $T_1 = 250$, $T_2 = 300$, $u_1 = 0.0$, $u_2 = 0.0$, $N = 4001$,\n   - $\\nu_A = -2.0$, $\\nu_B = 2.0$, $\\sigma = 0.5$,\n   - $C_A = 50.0$, $E_A = 1500.0$, $C_B = 1.0$, $E_B = 500.0$。\n\n最终输出格式：\n\n- 您的程序应生成单行输出，其中包含一个 Python 风格的列表，内含六个按测试用例顺序排列的四舍五入后的相对误差。例如，一个可接受的格式是\n  $[\\epsilon_1,\\epsilon_2,\\epsilon_3,\\epsilon_4,\\epsilon_5,\\epsilon_6]$，\n  其中每个$\\epsilon_i$是一个四舍五入到8位小数的小数，并且不打印任何额外文本。",
            "solution": "目标是通过因温度依赖的谱线强度交叉而引发单色吸收系数跨层秩相关性的违背，从而为相关吸收系数（相关k）近似创建并量化一个反例。\n\n原理和定义：\n\n- 比尔-朗伯定律指出，假设没有散射且吸收体路径量固定，通过一层叠层的单色透射率为$T(\\nu) = \\exp\\left(-\\sum_{\\ell} k_{\\ell}(\\nu) u_{\\ell}\\right)$。这源于一个基本定律，即无穷小衰减与当前强度和吸收体量成正比，$dI/I = -k(\\nu)dm$，沿路径积分后得到指数形式。\n\n- 对于包含孤立谱线的窄光谱区间，逐线理论将单色吸收系数建模为谱线贡献的叠加。一条强度为$S(T)$、归一化线型为$\\phi(\\nu-\\nu_0)$的谱线对吸收系数的贡献为$S(T)\\phi(\\nu-\\nu_0)$。线型$\\phi$被归一化，使得$\\int \\phi d\\nu = 1$；因此，谱线强度$S(T)$的含义是吸收系数曲线下的面积，并且是承载热力学依赖性的量。\n\n- 一个有物理动机且广泛使用的谱线强度温度依赖性近似，引用了低能态的玻尔兹曼布居，$S(T) \\propto \\exp(-E/k_B T)$，并附加了由配分函数和受激发射引起的其他因子。在一个适度的温度范围内，并且为了构建一个特定的反例，我们可以建模为：\n  $$S_i(T) = C_i\\exp\\left(-\\frac{E_i}{T}\\right), \\quad i\\in\\{A,B\\}$$\n  其中$E_i$以开尔文（$E_i/k_B$）表示，$C_i$是一个正的比例常数。因为指数函数在$T$上是单调的，不同的$(C_i,E_i)$对可以导致$S_A(T)$与$S_B(T)$的次序在两个温度之间翻转。\n\n- 带平均透射率是单色透射率在整个谱带上的平均值。对于一个均匀网格$\\{\\nu_j\\}_{j=1}^N$：\n  $$\\overline{T}_{\\mathrm{exact}} = \\frac{1}{N}\\sum_{j=1}^N \\exp\\left(-\\sum_{\\ell} k_{\\ell}(\\nu_j)u_{\\ell}\\right)。$$\n  由于网格是均匀的，且高斯尾部迅速衰减，选择距离最外层谱线中心$\\pm 6\\sigma$的边界基本上能捕捉到全部的谱线面积。\n\n- 相关吸收系数（相关k）近似通过对每层在离散求积频率处的吸收系数组进行排序，以构建非递减序列$k_{\\ell}^\\ast(g_j)$，从而从原始频率变量$\\nu$转换到一个累积概率变量$g$。然后通过在各层之间配对相等的$g$点来近似复合层的相关k带平均值：\n  $$\\overline{T}_{\\mathrm{corr}} = \\frac{1}{N}\\sum_{j=1}^{N} \\exp\\left(-\\sum_{\\ell} k_{\\ell}^\\ast(g_j)u_{\\ell}\\right)。$$\n  这假设从$g$到$\\nu$的映射在各层之间是相同的，即吸收系数具有完全秩相关。当秩次序在层与层之间发生变化时，这个假设就失效了。\n\n构建反例：\n\n- 选择两个相对于$\\sigma$良好分离的谱线中心$\\nu_A$和$\\nu_B$，并定义一个高斯线型：\n  $$\\phi(\\nu-\\nu_0;\\sigma) = \\frac{1}{\\sqrt{2\\pi}\\sigma}\\exp\\left(-\\frac{(\\nu-\\nu_0)^2}{2\\sigma^2}\\right)$$\n  两层共用（这是一个为了分离秩次序效应的简化）。\n\n- 选择$(C_A,E_A)$和$(C_B,E_B)$使得：\n  $$S_A(T_1) < S_B(T_1) \\quad \\text{和} \\quad S_A(T_2) > S_B(T_2) \\quad \\text{或反之亦然}，$$\n  确保在温度$T_1$和$T_2$之间发生谱线强度交叉。第一个测试用例使用$C_A=50$, $E_A=1500$, $C_B=1$, $E_B=500$配合$T_1=250$和$T_2=300$，这会产生：\n  $$S_A(250) = 50e^{-1500/250} = 50e^{-6} \\approx 0.124, \\quad S_B(250) = 1e^{-500/250} = e^{-2} \\approx 0.135$$\n  $$S_A(300) = 50e^{-1500/300} = 50e^{-5} \\approx 0.337, \\quad S_B(300) = 1e^{-500/300} = e^{-5/3} \\approx 0.189$$\n  因此较强的谱线从$T_1$时的B变为$T_2$时的A。当从第1层移动到第2层时，这必然会改变$k_{\\ell}(\\nu)$在$\\nu$上的秩次序。\n\n量化误差：\n\n- 通过对跨越谱线的均匀网格上的$T(\\nu_j)$进行直接平均来计算$\\overline{T}_{\\mathrm{exact}}$。\n\n- 通过独立排序$\\{k_1(\\nu_j)\\}$和$\\{k_2(\\nu_j)\\}$并在相等的$g_j$索引处配对来计算$\\overline{T}_{\\mathrm{corr}}$。\n\n- 报告相对误差：\n  $$\\epsilon = \\frac{\\overline{T}_{\\mathrm{corr}} - \\overline{T}_{\\mathrm{exact}}}{\\overline{T}_{\\mathrm{exact}}}。$$\n\n预期的定性行为：\n\n- 对于交叉情况，完全相关配对倾向于将一层中的大吸收系数与另一层中的大吸收系数相匹配，即使在某个给定频率下，一层中的大系数与另一层中的小系数重合。由于映射$x\\mapsto \\exp(-x)$是凸且递减的，这种“同类相配”通常会产生比真实逐频配对更小的平均透射率（这是一种类似于重排不等式与凸性结合的表现），因此$\\overline{T}_{\\mathrm{corr}}$通常偏低，$\\epsilon$倾向于为负值。\n\n- 当没有交叉或两层相同时，秩次序得以保持，$g$到$\\nu$的映射在各层之间相同，因此$\\overline{T}_{\\mathrm{corr}}=\\overline{T}_{\\mathrm{exact}}$，所以$\\epsilon=0$（在数值离散化误差范围内）。\n\n- 在强光学深度区域，饱和效应降低了对详细相关结构的敏感性，但根据重叠情况，非零误差可能仍然存在。\n\n数值步骤：\n\n- 使用$N=4001$个在$\\nu$中均匀间隔的点，域边界设在$\\min(\\nu_A,\\nu_B)-6\\sigma$和$\\max(\\nu_A,\\nu_B)+6\\sigma$，以表示该谱带。\n\n- 对于每个测试用例，根据指数模型评估$S_A(T_{\\ell})$和$S_B(T_{\\ell})$，构建$k_{\\ell}(\\nu_j)$，计算$\\overline{T}_{\\mathrm{exact}}$和$\\overline{T}_{\\mathrm{corr}}$，然后计算$\\epsilon$并四舍五入到8位小数。\n\n- 在单行上返回列表$[\\epsilon_1,\\epsilon_2,\\epsilon_3,\\epsilon_4,\\epsilon_5,\\epsilon_6]$，不含任何额外文本。\n\n提供的程序完全按照规定实现了这些步骤，确保了反例是明确的，所导致的误差被量化，并且边缘情况（无交叉、相同层、零路径）证实了预期的极限行为。运行该程序会产生六个无量纲十进制输出，对应六个测试的相对误差，每个都四舍五入到8位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef gaussian_phi(nu, center, sigma):\n    \"\"\"Normalized Gaussian line shape.\"\"\"\n    inv_norm = 1.0 / (np.sqrt(2.0 * np.pi) * sigma)\n    x = (nu - center) / sigma\n    return inv_norm * np.exp(-0.5 * x * x)\n\ndef line_strength(T, C, E_K):\n    \"\"\"\n    Simplified line strength S(T) = C * exp(-E/T),\n    where E is expressed in Kelvin units (i.e., E/k_B).\n    \"\"\"\n    return C * np.exp(-E_K / T)\n\ndef compute_band_errors(params):\n    \"\"\"\n    Compute exact and correlated-k band-mean transmittances and return fractional error.\n    params is a dict with keys:\n        T1, T2, u1, u2, nuA, nuB, sigma, CA, EA, CB, EB, N\n    \"\"\"\n    T1 = params[\"T1\"]\n    T2 = params[\"T2\"]\n    u1 = params[\"u1\"]\n    u2 = params[\"u2\"]\n    nuA = params[\"nuA\"]\n    nuB = params[\"nuB\"]\n    sigma = params[\"sigma\"]\n    CA = params[\"CA\"]\n    EA = params[\"EA\"]\n    CB = params[\"CB\"]\n    EB = params[\"EB\"]\n    N = int(params[\"N\"])\n\n    # Grid in frequency-like variable nu\n    nu_min = min(nuA, nuB) - 6.0 * sigma\n    nu_max = max(nuA, nuB) + 6.0 * sigma\n    nu = np.linspace(nu_min, nu_max, N)\n\n    # Line strengths in each layer\n    SA1 = line_strength(T1, CA, EA)\n    SB1 = line_strength(T1, CB, EB)\n    SA2 = line_strength(T2, CA, EA)\n    SB2 = line_strength(T2, CB, EB)\n\n    # Line shapes (same sigma in both layers by construction)\n    phiA = gaussian_phi(nu, nuA, sigma)\n    phiB = gaussian_phi(nu, nuB, sigma)\n\n    # Absorption coefficients in each layer\n    k1 = SA1 * phiA + SB1 * phiB\n    k2 = SA2 * phiA + SB2 * phiB\n\n    # Exact band-mean transmittance\n    tau_total = k1 * u1 + k2 * u2\n    T_exact = np.mean(np.exp(-tau_total, dtype=np.float64))\n\n    # Correlated-k band-mean transmittance: sort each layer independently, pair by index\n    k1_sorted = np.sort(k1)\n    k2_sorted = np.sort(k2)\n    tau_corr = k1_sorted * u1 + k2_sorted * u2\n    T_corr = np.mean(np.exp(-tau_corr, dtype=np.float64))\n\n    # Fractional error\n    if T_exact == 0.0:\n        # Avoid division by zero; if exact transmittance is 0, treat error as 0 if both are zero, else inf\n        if T_corr == 0.0:\n            frac_error = 0.0\n        else:\n            frac_error = np.inf\n    else:\n        frac_error = (T_corr - T_exact) / T_exact\n\n    return float(frac_error)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # 1. Crossing, moderate optical depth\n        dict(T1=250.0, T2=300.0, u1=1.0, u2=1.0, nuA=-2.0, nuB=2.0, sigma=0.5,\n             CA=50.0, EA=1500.0, CB=1.0, EB=500.0, N=4001),\n        # 2. No crossing, moderate optical depth\n        dict(T1=250.0, T2=300.0, u1=1.0, u2=1.0, nuA=-2.0, nuB=2.0, sigma=0.5,\n             CA=1.0, EA=400.0, CB=0.8, EB=800.0, N=4001),\n        # 3. Identical layers (perfect correlation), mixed optical depth\n        dict(T1=275.0, T2=275.0, u1=1.3, u2=0.7, nuA=-2.0, nuB=2.0, sigma=0.5,\n             CA=50.0, EA=1500.0, CB=1.0, EB=500.0, N=4001),\n        # 4. Crossing, strong optical depth\n        dict(T1=250.0, T2=300.0, u1=5.0, u2=5.0, nuA=-2.0, nuB=2.0, sigma=0.5,\n             CA=50.0, EA=1500.0, CB=1.0, EB=500.0, N=4001),\n        # 5. Crossing with overlapping lines\n        dict(T1=260.0, T2=290.0, u1=1.0, u2=1.0, nuA=-0.3, nuB=0.3, sigma=0.4,\n             CA=50.0, EA=1500.0, CB=1.0, EB=500.0, N=4001),\n        # 6. Boundary case: zero path\n        dict(T1=250.0, T2=300.0, u1=0.0, u2=0.0, nuA=-2.0, nuB=2.0, sigma=0.5,\n             CA=50.0, EA=1500.0, CB=1.0, EB=500.0, N=4001),\n    ]\n\n    results = []\n    for case in test_cases:\n        err = compute_band_errors(case)\n        # Round to 8 decimal places\n        if not np.isfinite(err):\n            # In practice shouldn't happen for given cases; still handle\n            rounded = \"inf\"\n        else:\n            rounded = f\"{err:.8f}\"\n        results.append(rounded)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "除了垂直非均匀性，另一个主要挑战是模拟多种气体的混合吸收。一种常见的简化是“随机重叠”假设，它将不同气体的光谱特征视为统计独立的。本实践  利用一个巧妙的概率模型，来量化当气体吸收谱线实际上部分相关时，该假设所引入的误差，从而让您深入理解混合气体大气建模中的一个关键问题。",
            "id": "4028085",
            "problem": "考虑一个用于气体吸收的简化谱带模型，该模型用于论证数值天气预报和气候模拟中的相关k分布（CKD）方法。目标是量化当两种气体表现出部分谱线重合时，由随机重叠假设引入的误差。\n\n推导基于比尔-朗伯定律和基础概率论。比尔-朗伯定律指出，在波数$\\nu$处，通过均匀路径的单色透过率为$t(\\nu) = \\exp\\left(-\\sum_{g} k_g(\\nu)u_g\\right)$，其中$k_g(\\nu)$是气体$g$的吸收系数，$u_g$是其路径量，使得$k_g u_g$为无量纲。谱带平均透过率是$t(\\nu)$在该谱带上的平均值。\n\n玩具模型假设：\n- 存在两种气体，记为$A$和$B$。对于每种气体$g \\in \\{A,B\\}$，在谱带内随机选择的任何光谱点上，其吸收系数处于两种状态之一：“谱线”状态，系数为$k_{g,L}$；或“连续谱”状态，系数为$k_{g,C}$。\n- 气体$A$处于其谱线状态的边缘概率为$p_A$，气体$B$处于其谱线状态的边缘概率为$p_B$。\n- 通过对谱线指示符对$(S_A,S_B) \\in \\{\\text{L,C}\\}^2$的联合概率模型引入部分光谱相关性，具体如下：\n  $$\\mathbb{P}(S_A=\\text{L}, S_B=\\text{L}) = q,$$\n  $$\\mathbb{P}(S_A=\\text{L}, S_B=\\text{C}) = p_A - q,$$\n  $$\\mathbb{P}(S_A=\\text{C}, S_B=\\text{L}) = p_B - q,$$\n  $$\\mathbb{P}(S_A=\\text{C}, S_B=\\text{C}) = 1 - p_A - p_B + q,$$\n  其中$q$必须满足$q \\in [\\max(0, p_A + p_B - 1), \\min(p_A, p_B)]$。\n- “重合分数”$c$定义为在气体$A$处于其谱线状态的条件下，气体$B$也处于其谱线状态的条件概率，即$c = \\mathbb{P}(S_B=\\text{L}\\mid S_A=\\text{L})$。因此$q = c p_A$，这意味着约束条件为$c \\in \\left[\\max\\left(0, \\frac{p_A + p_B - 1}{p_A}\\right), \\min\\left(1, \\frac{p_B}{p_A}\\right)\\right]$。\n- 随机重叠近似对应于谱线指示符的统计独立性，这得出$q_{\\text{ran}} = p_A p_B$。\n\n任务：\n1. 从比尔-朗伯定律和上述概率模型出发，将谱带平均透过率表示为$\\exp(-k_A(S_A)u_A - k_B(S_B)u_B)$在$(S_A,S_B)$联合分布上的期望值，其中$k_A(\\text{L}) = k_{A,L}$，$k_A(\\text{C}) = k_{A,C}$，$k_B(\\text{L}) = k_{B,L}$，$k_B(\\text{C}) = k_{B,C}$。推导两种谱带平均透过率：使用$q = c p_A$的“真实”透过率和使用$q_{\\text{ran}} = p_A p_B$的“随机重叠”透过率。\n2. 将绝对误差定义为随机重叠与真实谱带平均透过率之间的绝对差。由于透过率是无量纲的，该误差也是无量纲的。\n3. 实现一个程序，为下面的测试套件计算此绝对误差。所有输入$k_{g,L}$和$k_{g,C}$必须解释为$\\text{m}^2\\cdot\\text{mol}^{-1}$，路径量$u_g$解释为$\\text{mol}\\cdot\\text{m}^{-2}$，概率$p_A$、$p_B$和$c$解释为无量纲小数。对于每个测试用例，输出必须是透过率的绝对误差（无量纲），格式化为四舍五入到$8$位小数的小数。\n4. 您的程序应生成单行输出，其中包含一个用逗号分隔的结果列表，该列表包含在方括号中且无空格，例如$[x_1,x_2,x_3]$。\n\n参数集测试套件$(k_{A,L}, k_{A,C}, u_A, p_A; k_{B,L}, k_{B,C}, u_B, p_B; c)$:\n- 情况1 (一般部分重合):\n  - $k_{A,L} = 5.0$, $k_{A,C} = 0.1$, $u_A = 0.2$, $p_A = 0.3$;\n  - $k_{B,L} = 3.0$, $k_{B,C} = 0.05$, $u_B = 0.4$, $p_B = 0.4$;\n  - $c = 0.6$。\n- 情况2 (随机重叠一致性，其中$c = p_B$，因此误差应为零):\n  - $k_{A,L} = 2.0$, $k_{A,C} = 0.01$, $u_A = 0.3$, $p_A = 0.2$;\n  - $k_{B,L} = 6.0$, $k_{B,C} = 0.02$, $u_B = 0.1$, $p_B = 0.5$;\n  - $c = 0.5$。\n- 情况3 (从$A$到$B$的最大重合，其中$c = 1.0$且$p_B \\ge p_A$):\n  - $k_{A,L} = 4.0$, $k_{A,C} = 0.2$, $u_A = 0.5$, $p_A = 0.2$;\n  - $k_{B,L} = 1.0$, $k_{B,C} = 0.02$, $u_B = 0.7$, $p_B = 0.8$;\n  - $c = 1.0$。\n- 情况4 (最小允许重合的边界，其中$p_A + p_B > 1$且$1 - p_A - p_B + q = 0$):\n  - $k_{A,L} = 8.0$, $k_{A,C} = 0.1$, $u_A = 0.25$, $p_A = 0.7$;\n  - $k_{B,L} = 7.0$, $k_{B,C} = 0.1$, $u_B = 0.35$, $p_B = 0.6$;\n  - $c = 0.42857142857142855$。\n- 情况5 (具有强正重合的对称边缘概率):\n  - $k_{A,L} = 10.0$, $k_{A,C} = 0.05$, $u_A = 0.1$, $p_A = 0.5$;\n  - $k_{B,L} = 10.0$, $k_{B,C} = 0.05$, $u_B = 0.9$, $p_B = 0.5$;\n  - $c = 0.8$。\n\n实现要求：\n- 使用$q = c p_A$计算真实谱带平均透过率。\n- 使用$q_{\\text{ran}} = p_A p_B$计算随机重叠谱带平均透过率。\n- 对于每种情况，返回绝对误差，格式为四舍五入到$8$位小数的小数。\n- 输出格式必须是单行，包含一个按情况顺序排列的五个结果的列表，用逗号分隔，并包含在方括号中，无空格，例如$[x_1,x_2,x_3,x_4,x_5]$。",
            "solution": "该问题定义明确，其科学基础在于辐射传输原理和概率论，并为获得唯一解提供了所有必要信息。因此，该问题是有效的。\n\n核心任务是推导并计算两种谱带平均透过率模型之间的绝对误差：一个考虑了部分谱线相关的“真实”模型，以及一个假设统计独立的近似“随机重叠”模型。\n\n根据问题陈述，谱带平均透过率$\\bar{T}$是单色透过率$t(\\nu)$的光谱平均值。在概率模型的背景下，该平均值等同于$t(\\nu)$在吸收系数分布上的期望值。给定比尔-朗伯定律$t(\\nu) = \\exp(-\\sum_g k_g(\\nu) u_g)$，对于我们的双气体系统（$A$和$B$），谱带平均透过率为：\n$$ \\bar{T} = \\mathbb{E}\\left[\\exp(-k_A(S_A) u_A - k_B(S_B) u_B)\\right] $$\n这里，$S_A$和$S_B$是随机变量，分别代表气体$A$和气体$B$的状态（谱线'L'或连续谱'C'）。期望是基于$(S_A, S_B)$的联合概率分布计算的。\n\n总光学厚度为$\\tau = \\tau_A + \\tau_B$，其中$\\tau_g = k_g(S_g) u_g$。期望值可以通过对四种可能的联合状态求和来展开：\n$$ \\bar{T} = \\sum_{S_A \\in \\{\\text{L,C}\\}} \\sum_{S_B \\in \\{\\text{L,C}\\}} \\mathbb{P}(S_A, S_B) \\exp(-k_A(S_A) u_A - k_B(S_B) u_B) $$\n使用所提供的由$q = \\mathbb{P}(S_A=\\text{L}, S_B=\\text{L})$参数化的联合概率，我们可以写出谱带平均透过率作为$q$的函数的显式公式。设$\\tau_{g,S} = k_{g,S} u_g$对于$g \\in \\{A,B\\}$和$S \\in \\{\\text{L,C}\\}$。\n\n$$\n\\begin{align*}\n\\bar{T}(q) =  \\mathbb{P}(S_A=\\text{L}, S_B=\\text{L}) \\exp(-\\tau_{A,L} - \\tau_{B,L}) \\\\\n + \\mathbb{P}(S_A=\\text{L}, S_B=\\text{C}) \\exp(-\\tau_{A,L} - \\tau_{B,C}) \\\\\n + \\mathbb{P}(S_A=\\text{C}, S_B=\\text{L}) \\exp(-\\tau_{A,C} - \\tau_{B,L}) \\\\\n + \\mathbb{P}(S_A=\\text{C}, S_B=\\text{C}) \\exp(-\\tau_{A,C} - \\tau_{B,C})\n\\end{align*}\n$$\n\n代入问题陈述中的概率：\n$$\n\\begin{align*}\n\\bar{T}(q) =  q \\exp(-\\tau_{A,L} - \\tau_{B,L}) \\\\\n + (p_A - q) \\exp(-\\tau_{A,L} - \\tau_{B,C}) \\\\\n + (p_B - q) \\exp(-\\tau_{A,C} - \\tau_{B,L}) \\\\\n + (1 - p_A - p_B + q) \\exp(-\\tau_{A,C} - \\tau_{B,C})\n\\end{align*}\n$$\n\n该表达式可以通过收集含$q$和不含$q$的项来重新整理：\n$$\n\\begin{align*}\n\\bar{T}(q) = q \\Big[ \\exp(-\\tau_{A,L} - \\tau_{B,L}) - \\exp(-\\tau_{A,L} - \\tau_{B,C}) - \\exp(-\\tau_{A,C} - \\tau_{B,L}) + \\exp(-\\tau_{A,C} - \\tau_{B,C}) \\Big] \\\\\n+ \\Big[ p_A \\exp(-\\tau_{A,L} - \\tau_{B,C}) + p_B \\exp(-\\tau_{A,C} - \\tau_{B,L}) + (1 - p_A - p_B) \\exp(-\\tau_{A,C} - \\tau_{B,C}) \\Big]\n\\end{align*}\n$$\n乘以$q$的项可以被因式分解：\n$$ \\exp(-\\tau_{A,L} - \\tau_{B,L}) - \\exp(-\\tau_{A,L} - \\tau_{B,C}) - \\exp(-\\tau_{A,C} - \\tau_{B,L}) + \\exp(-\\tau_{A,C} - \\tau_{B,C}) = \\left(\\exp(-\\tau_{A,L}) - \\exp(-\\tau_{A,C})\\right) \\left(\\exp(-\\tau_{B,L}) - \\exp(-\\tau_{B,C})\\right) $$\n设$\\Delta T_A = \\exp(-\\tau_{A,L}) - \\exp(-\\tau_{A,C})$和$\\Delta T_B = \\exp(-\\tau_{B,L}) - \\exp(-\\tau_{B,C})$。$\\bar{T}(q)$的表达式表明它是$q$的一个线性函数。\n\n“真实”谱带平均透过率$T_{\\text{true}}$是使用真实联合概率$q_{\\text{true}} = c p_A$计算的：\n$$ T_{\\text{true}} = \\bar{T}(q_{\\text{true}}) = \\bar{T}(c p_A) $$\n\n“随机重叠”透过率$T_{\\text{ran}}$假设两种气体的吸收状态之间是统计独立的。在这种情况下，联合概率$\\mathbb{P}(S_A=\\text{L}, S_B=\\text{L})$是边缘概率的乘积，即$q_{\\text{ran}} = p_A p_B$。\n$$ T_{\\text{ran}} = \\bar{T}(q_{\\text{ran}}) = \\bar{T}(p_A p_B) $$\n另外，在独立性假设下，平均透过率是各自平均透过率的乘积：\n$$ T_{\\text{ran}} = \\mathbb{E}[\\exp(-\\tau_A)] \\cdot \\mathbb{E}[\\exp(-\\tau_B)] = [p_A \\exp(-\\tau_{A,L}) + (1-p_A)\\exp(-\\tau_{A,C})] \\cdot [p_B \\exp(-\\tau_{B,L}) + (1-p_B)\\exp(-\\tau_{B,C})] $$\n展开该乘积可以证实，它与$q = p_A p_B$时的一般公式相同。\n\n绝对误差$\\mathcal{E}$是这两种透过率之间的绝对差：\n$$ \\mathcal{E} = |T_{\\text{ran}} - T_{\\text{true}}| = |\\bar{T}(q_{\\text{ran}}) - \\bar{T}(q_{\\text{true}})| $$\n由于$\\bar{T}(q)$是$q$的线性函数，其差值为：\n$$ \\bar{T}(q_{\\text{ran}}) - \\bar{T}(q_{\\text{true}}) = (q_{\\text{ran}} - q_{\\text{true}}) \\cdot \\Delta T_A \\cdot \\Delta T_B $$\n代入$q_{\\text{ran}}$、$q_{\\text{true}}$、$\\Delta T_A$和$\\Delta T_B$的表达式：\n$$ \\mathcal{E} = |(p_A p_B - c p_A) \\left(\\exp(-k_{A,L}u_A) - \\exp(-k_{A,C}u_A)\\right) \\left(\\exp(-k_{B,L}u_B) - \\exp(-k_{B,C}u_B)\\right)| $$\n这可以简化为：\n$$ \\mathcal{E} = |p_A(p_B - c)| \\cdot |\\exp(-k_{A,L}u_A) - \\exp(-k_{A,C}u_A)| \\cdot |\\exp(-k_{B,L}u_B) - \\exp(-k_{B,C}u_B)| $$\n这个最终表达式在计算上是高效的，在分析上具有洞察力。它表明，误差与偏离统计独立的程度（由$|p_B - c|$量化）以及每种气体在谱线状态和连续谱状态之间的透过率差异成正比。如果$c = p_B$（随机重叠），或$p_A=0$，或对于任一气体有$k_{g,L} = k_{g,C}$，则误差为零。\n\n将实现以下算法：\n1. 对于每个测试用例，解析参数：$k_{A,L}, k_{A,C}, u_A, p_A, k_{B,L}, k_{B,C}, u_B, p_B, c$。\n2. 计算项$|p_A(p_B - c)|$。\n3. 计算气体A的透过率差异项：$|\\exp(-k_{A,L}u_A) - \\exp(-k_{A,C}u_A)|$。\n4. 计算气体B的透过率差异项：$|\\exp(-k_{B,L}u_B) - \\exp(-k_{B,C}u_B)|$。\n5. 通过将这三项相乘来计算绝对误差$\\mathcal{E}$。\n6. 将结果四舍五入到8位小数。\n7. 将所有测试用例的结果整理成指定的输出格式。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Validates and solves the problem concerning the error in the random-overlap\n    assumption for gaseous absorption.\n    \"\"\"\n\n    # test_cases are tuples of the form:\n    # (k_AL, k_AC, u_A, p_A, k_BL, k_BC, u_B, p_B, c)\n    test_cases = [\n        # Case 1 (general partial coincidence)\n        (5.0, 0.1, 0.2, 0.3, 3.0, 0.05, 0.4, 0.4, 0.6),\n        # Case 2 (random-overlap consistency where c = p_B)\n        (2.0, 0.01, 0.3, 0.2, 6.0, 0.02, 0.1, 0.5, 0.5),\n        # Case 3 (maximal coincidence from A into B)\n        (4.0, 0.2, 0.5, 0.2, 1.0, 0.02, 0.7, 0.8, 1.0),\n        # Case 4 (boundary of minimal allowed coincidence)\n        (8.0, 0.1, 0.25, 0.7, 7.0, 0.1, 0.35, 0.6, 0.42857142857142855),\n        # Case 5 (symmetric marginals with strong positive coincidence)\n        (10.0, 0.05, 0.1, 0.5, 10.0, 0.05, 0.9, 0.5, 0.8),\n    ]\n\n    results = []\n    for params in test_cases:\n        error = compute_transmittance_error(params)\n        # Round the result to 8 decimal places as specified\n        results.append(f\"{error:.8f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\ndef compute_transmittance_error(params: tuple) -> float:\n    \"\"\"\n    Computes the absolute error between the true and random-overlap band-mean\n    transmittances using the derived simplified formula.\n\n    The error is given by:\n    E = |p_A * (p_B - c)| * \n        |exp(-k_AL*u_A) - exp(-k_AC*u_A)| * \n        |exp(-k_BL*u_B) - exp(-k_BC*u_B)|\n\n    Args:\n        params: A tuple containing the nine model parameters:\n                (k_AL, k_AC, u_A, p_A, k_BL, k_BC, u_B, p_B, c)\n\n    Returns:\n        The absolute error, a dimensionless float.\n    \"\"\"\n    k_AL, k_AC, u_A, p_A, k_BL, k_BC, u_B, p_B, c = params\n\n    # Term 1: The deviation from statistical independence\n    prob_factor = abs(p_A * (p_B - c))\n\n    # Term 2: The transmittance difference for gas A\n    tau_AL = k_AL * u_A\n    tau_AC = k_AC * u_A\n    trans_diff_A = abs(np.exp(-tau_AL) - np.exp(-tau_AC))\n\n    # Term 3: The transmittance difference for gas B\n    tau_BL = k_BL * u_B\n    tau_BC = k_BC * u_B\n    trans_diff_B = abs(np.exp(-tau_BL) - np.exp(-tau_BC))\n\n    # Total absolute error is the product of the three terms\n    absolute_error = prob_factor * trans_diff_A * trans_diff_B\n    \n    return absolute_error\n\nsolve()\n```"
        }
    ]
}