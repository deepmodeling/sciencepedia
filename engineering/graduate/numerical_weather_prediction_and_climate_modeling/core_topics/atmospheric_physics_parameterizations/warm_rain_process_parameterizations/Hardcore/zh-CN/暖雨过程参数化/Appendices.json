{
    "hands_on_practices": [
        {
            "introduction": "宏观物理参数化方案本质上是关于液滴谱分布矩的方程组。为了理解其基础，将其与更基本的随机碰并方程（Stochastic Collection Equation, SCE）联系起来至关重要。本练习将指导您从 SCE 出发，推导任意阶矩的时间倾向，并揭示在云滴碰并过程中哪个物理量是内禀守恒的，为理解参数化方案提供坚实的理论基础。",
            "id": "4111400",
            "problem": "考虑在数值天气预报和气候模拟中使用的总体微物理方案背景下的暖雨碰撞-合并过程。设半径空间中液滴数密度分布的随机碰并方程 (SCE) 是对二元合并过程的控制性描述，其中液滴半径 $r>0$ 的数密度分布表示为 $n(r,t)$。假设合并后，新液滴的体积是母液滴体积之和，即从母液滴半径 $r_{1}$ 和 $r_{2}$ 到子液滴半径 $r$ 的映射满足 $r^{3}=r_{1}^{3}+r_{2}^{3}$。设碰并核函数 $K(r_{1},r_{2})$ 是一个对称非负函数，即 $K(r_{1},r_{2})=K(r_{2},r_{1})\\ge 0$，并假设 $n(r,t)$ 的支撑集为 $(0,\\infty)$ 且所关注的矩存在。\n\n将半径分布的 $k$ 阶矩定义为 $M_{k}(t)=\\int_{0}^{\\infty} r^{k}\\,n(r,t)\\,dr$，对于任何使该积分存在的实数 $k$。从半径空间中的 SCE 出发，\n$$\n\\frac{\\partial n(r,t)}{\\partial t}\n= \\frac{1}{2} \\int_{0}^{\\infty} \\int_{0}^{\\infty} K(r_{1},r_{2})\\,n(r_{1},t)\\,n(r_{2},t)\\,\\delta\\!\\left(r^{3}-r_{1}^{3}-r_{2}^{3}\\right)\\,3r^{2}\\,dr_{1}\\,dr_{2}\n- n(r,t)\\int_{0}^{\\infty} K(r,r')\\,n(r',t)\\,dr',\n$$\n其中 $\\delta(\\cdot)$ 是狄拉克 $\\delta$ 函数，推导 $k$ 阶矩的时间倾向 $\\frac{dM_{k}}{dt}$ 的一个精确表达式，该表达式应写成一个包含 $K$、$n$ 以及 $r$ 和 $r'$ 的代数函数的对称二重积分形式。然后，在 $K$ 是对称的情况下，找出所有使得碰撞-合并源项（即 SCE 对 $\\frac{dM_{k}}{dt}$ 的右侧项贡献）对每一对容许的 $(r,r')$ 都为零的 $k$ 值。将您的最终答案表示为一个单行矩阵，其第一个元素是推导出的 $\\frac{dM_{k}}{dt}$ 的积分表达式，第二个元素是使源项为零的 $k$ 值（如果存在）。无需进行数值计算，最终答案中不应包含任何物理单位。",
            "solution": "该问题要求推导由随机碰并方程 (SCE) 控制的液滴半径分布的 $k$ 阶矩 $M_{k}(t)$ 的时间倾向，并确定对于哪些 $k$ 值，该倾向因碰撞-合并过程本身而消失。\n\n首先，我们验证问题的有效性。\n步骤1：提取已知条件。\n- 液滴数密度分布为 $n(r,t)$，其中半径 $r>0$。\n- 两个半径为 $r_1$ 和 $r_2$ 的液滴合并形成一个半径为 $r$ 的新液滴的规则是 $r^{3}=r_{1}^{3}+r_{2}^{3}$。\n- 碰并核函数是一个对称非负函数：$K(r_{1},r_{2})=K(r_{2},r_{1})\\ge 0$。\n- $n(r,t)$ 的支撑集为 $(0,\\infty)$。\n- $k$ 阶矩定义为 $M_{k}(t)=\\int_{0}^{\\infty} r^{k}\\,n(r,t)\\,dr$。\n- SCE 方程为：\n$$\n\\frac{\\partial n(r,t)}{\\partial t}\n= \\frac{1}{2} \\int_{0}^{\\infty} \\int_{0}^{\\infty} K(r_{1},r_{2})\\,n(r_{1},t)\\,n(r_{2},t)\\,\\delta\\!\\left(r^{3}-r_{1}^{3}-r_{2}^{3}\\right)\\,3r^{2}\\,dr_{1}\\,dr_{2}\n- n(r,t)\\int_{0}^{\\infty} K(r,r')\\,n(r',t)\\,dr'\n$$\n\n步骤2：使用提取的已知条件进行验证。\n- 该问题具有科学依据。SCE 是云物理学中模拟暖雨的基本方程。合并规则代表了液滴体积（在密度恒定的假设下，也即质量）的守恒，这是一项核心物理原理。\n- 该问题是适定的。它提供了进行所要求的推导所需的所有必要定义和方程。\n- 该问题是客观的，并使用了精确的数学语言。它没有违反任何无效标准。\n\n步骤3：结论与行动。\n该问题被认为是有效的。我们继续进行求解。\n\n$k$ 阶矩的时间倾向 $\\frac{dM_{k}}{dt}$ 可通过将 $M_{k}(t)$ 的定义对时间 $t$ 求导得到。假设满足交换微分和积分顺序的必要条件（这在此类问题中是标准做法），我们有：\n$$\n\\frac{dM_{k}}{dt} = \\frac{d}{dt} \\int_{0}^{\\infty} r^{k}\\,n(r,t)\\,dr = \\int_{0}^{\\infty} r^{k}\\,\\frac{\\partial n(r,t)}{\\partial t}\\,dr\n$$\n我们将 SCE 中给出的 $\\frac{\\partial n(r,t)}{\\partial t}$ 的表达式代入此积分：\n$$\n\\frac{dM_{k}}{dt} = \\int_{0}^{\\infty} r^{k} \\left( \\frac{1}{2} \\int_{0}^{\\infty} \\int_{0}^{\\infty} K(r_{1},r_{2})n_{1}n_{2}\\,\\delta(r^{3}-r_{1}^{3}-r_{2}^{3})3r^{2}\\,dr_{1}dr_{2} - n(r,t)\\int_{0}^{\\infty} K(r,r')n'\\,dr' \\right) dr\n$$\n这里我们使用简写 $n_{1}=n(r_{1},t)$，$n_{2}=n(r_{2},t)$ 和 $n'=n(r',t)$。我们可以将其分为增益项 ($S_{k}^{+}$) 和损失项 ($S_{k}^{-}$)：\n$$\n\\frac{dM_{k}}{dt} = S_{k}^{+} - S_{k}^{-}\n$$\n\n首先，我们计算增益项 $S_{k}^{+}$：\n$$\nS_{k}^{+} = \\int_{0}^{\\infty} r^{k} \\left( \\frac{1}{2} \\int_{0}^{\\infty} \\int_{0}^{\\infty} K(r_{1},r_{2})n_{1}n_{2}\\,\\delta(r^{3}-r_{1}^{3}-r_{2}^{3})3r^{2}\\,dr_{1}dr_{2} \\right) dr\n$$\n根据 Fubini 定理，我们可以改变积分顺序：\n$$\nS_{k}^{+} = \\frac{1}{2} \\int_{0}^{\\infty} \\int_{0}^{\\infty} K(r_{1},r_{2})n_{1}n_{2} \\left( \\int_{0}^{\\infty} r^{k}\\,\\delta(r^{3}-r_{1}^{3}-r_{2}^{3})3r^{2}\\,dr \\right) dr_{1}dr_{2}\n$$\n关于 $r$ 的内部积分可以通过换元法求解。令 $u=r^{3}$，则 $du=3r^{2}\\,dr$。项 $r^{k}$ 变为 $(u^{1/3})^{k} = u^{k/3}$。$u$ 的积分限为从 $0$ 到 $\\infty$。该积分变为：\n$$\n\\int_{0}^{\\infty} u^{k/3}\\,\\delta(u - (r_{1}^{3}+r_{2}^{3}))\\,du\n$$\n利用狄拉克 $\\delta$ 函数的筛选性质 $\\int f(x)\\delta(x-a)dx = f(a)$，其计算结果为：\n$$\n(r_{1}^{3}+r_{2}^{3})^{k/3}\n$$\n将此结果代回 $S_{k}^{+}$ 的表达式中：\n$$\nS_{k}^{+} = \\frac{1}{2} \\int_{0}^{\\infty} \\int_{0}^{\\infty} K(r_{1},r_{2})n_{1}n_{2}\\,(r_{1}^{3}+r_{2}^{3})^{k/3}\\,dr_{1}dr_{2}\n$$\n\n接下来，我们计算损失项 $S_{k}^{-}$：\n$$\nS_{k}^{-} = \\int_{0}^{\\infty} r^{k} \\left( n(r,t)\\int_{0}^{\\infty} K(r,r')n'\\,dr' \\right) dr\n$$\n改写为二重积分并改变积分顺序：\n$$\nS_{k}^{-} = \\int_{0}^{\\infty} \\int_{0}^{\\infty} r^{k}\\,n(r,t)\\,K(r,r')\\,n(r',t)\\,dr\\,dr'\n$$\n为了创建一个可以与增益项合并的对称表达式，我们可以利用被积函数在重命名哑积分变量下的对称性。我们将积分变量 $r$ 和 $r'$ 分别重命名为 $r_{1}$ 和 $r_{2}$：\n$$\nS_{k}^{-} = \\int_{0}^{\\infty} \\int_{0}^{\\infty} r_{1}^{k}\\,n_{1}\\,K(r_{1},r_{2})\\,n_{2}\\,dr_{1}\\,dr_{2}\n$$\n我们也可以交换标签 $r_{1} \\leftrightarrow r_{2}$：\n$$\nS_{k}^{-} = \\int_{0}^{\\infty} \\int_{0}^{\\infty} r_{2}^{k}\\,n_{2}\\,K(r_{2},r_{1})\\,n_{1}\\,dr_{2}\\,dr_{1}\n$$\n由于核函数是对称的，$K(r_{2},r_{1}) = K(r_{1},r_{2})$，且微分元的顺序不影响结果，因此上式也等于：\n$$\nS_{k}^{-} = \\int_{0}^{\\infty} \\int_{0}^{\\infty} r_{2}^{k}\\,K(r_{1},r_{2})\\,n_{1}n_{2}\\,dr_{1}\\,dr_{2}\n$$\n由于 $S_{k}^{-}$ 的两个表达式相等，我们可以将 $S_{k}^{-}$ 写成它们的平均值：\n$$\nS_{k}^{-} = \\frac{1}{2} \\left( \\int_{0}^{\\infty} \\int_{0}^{\\infty} r_{1}^{k}\\,K(r_{1},r_{2})n_{1}n_{2}\\,dr_{1}dr_{2} + \\int_{0}^{\\infty} \\int_{0}^{\\infty} r_{2}^{k}\\,K(r_{1},r_{2})n_{1}n_{2}\\,dr_{1}dr_{2} \\right)\n$$\n$$\nS_{k}^{-} = \\frac{1}{2} \\int_{0}^{\\infty} \\int_{0}^{\\infty} (r_{1}^{k}+r_{2}^{k})\\,K(r_{1},r_{2})\\,n_{1}n_{2}\\,dr_{1}dr_{2}\n$$\n合并增益项和对称化后的损失项，我们得到 $\\frac{dM_{k}}{dt}$ 的表达式：\n$$\n\\frac{dM_{k}}{dt} = \\frac{1}{2} \\int_{0}^{\\infty} \\int_{0}^{\\infty} \\left[ (r_{1}^{3}+r_{2}^{3})^{k/3} - (r_{1}^{k}+r_{2}^{k}) \\right] K(r_{1},r_{2})n(r_{1},t)n(r_{2},t)\\,dr_{1}dr_{2}\n$$\n按照题目要求将积分变量重命名为 $r$ 和 $r'$，得到答案的第一部分：\n$$\n\\frac{dM_{k}}{dt} = \\frac{1}{2} \\int_{0}^{\\infty} \\int_{0}^{\\infty} \\left[ (r^{3}+r'^{3})^{k/3} - (r^{k}+r'^{k}) \\right] K(r,r')n(r,t)n(r',t)\\,dr\\,dr'\n$$\n\n对于第二部分，我们必须找到所有使碰撞-合并源项为零的 $k$ 值。这意味着 $\\frac{dM_{k}}{dt} = 0$。由于 $K(r,r') \\ge 0$ 和 $n(r,t) \\ge 0$ 且不恒为零，该积分对所有容许的分布都为零，当且仅当方括号中的项对所有 $r, r' > 0$ 恒为零：\n$$\n(r^{3}+r'^{3})^{k/3} - (r^{k}+r'^{k}) = 0\n$$\n$$\n(r^{3}+r'^{3})^{k/3} = r^{k}+r'^{k}\n$$\n令 $a = r^{3}$ 和 $b = r'^{3}$。因为 $r, r' > 0$，所以有 $a, b > 0$。方程变为：\n$$\n(a+b)^{k/3} = (a^{1/3})^{k} + (b^{1/3})^{k} = a^{k/3} + b^{k/3}\n$$\n令指数为 $p = k/3$。条件为对所有 $a,b > 0$ 都有 $(a+b)^{p} = a^{p} + b^{p}$。\n- 如果 $p=1$，我们有 $(a+b)^{1} = a^{1}+b^{1}$，即 $a+b=a+b$。这对所有 $a,b$ 都成立。所以 $p=1$ 是一个解。这对应于 $k/3 = 1$，即 $k=3$。\n- 如果 $p>1$，函数 $f(x)=x^p$ 在 $x>0$ 上是严格凸的。一个已知的关于凸函数的不等式表明，对所有 $a,b>0$ 有 $(a+b)^{p} > a^{p} + b^{p}$。因此，当 $p>1$ (即 $k>3$) 时无解。\n- 如果 $0<p<1$，函数 $f(x)=x^p$ 在 $x>0$ 上是严格凹的，这意味着对所有 $a,b>0$ 有 $(a+b)^{p} < a^{p} + b^{p}$。因此，当 $0<p<1$ (即 $0<k<3$) 时无解。\n- 如果 $p=0$ (即 $k=0$)，条件变为 $(a+b)^0 = a^0 + b^0$，即 $1 = 1 + 1 = 2$，这是错误的。因此 $k=0$ 不是一个解。\n- 如果 $p<0$，则 $p$ 可以是任何负实数。令 $p = -q$ 其中 $q>0$。条件变为 $(a+b)^{-q} = a^{-q} + b^{-q}$。令 $a=1, b=1$，我们得到 $2^{-q} = 1^{-q} + 1^{-q} = 1+1=2$，这要求 $2^{-q}=2^1$，因此 $q=-1$。所以 $p=1$，但这与 $p<0$ 矛盾。因此当 $p<0$ (即 $k<0$) 时无解。\n\n唯一的解是 $p=1$，这对应于 $k=3$。$k=3$ 的矩 $M_3$ 与总液滴体积（以及质量）成正比，因此这一结果在物理上证实了在纯碰撞-合并过程中质量是守恒的。\n\n最终答案为 $\\begin{pmatrix}\\frac{1}{2} \\int_{0}^{\\infty} \\int_{0}^{\\infty} \\left[ (r^{3}+r'^{3})^{k/3} - (r^{k}+r'^{k}) \\right] K(r,r')n(r,t)n(r',t)\\,dr\\,dr' & 3\\end{pmatrix}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{2} \\int_{0}^{\\infty} \\int_{0}^{\\infty} \\left[ (r^{3} + r'^{3})^{k/3} - (r^{k} + r'^{k}) \\right] K(r,r') n(r,t) n(r',t) \\,dr\\,dr'  3 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "从连续理论转向实际的宏观模型，我们必须明确定义微物理过程如何影响预测的矩量，例如质量和数浓度。本练习要求您基于一套关于自动转化和碰增过程的物理准则，为双矩参数化方案构建源项。这对于理解模型开发者如何确保物理一致性，并将物理概念转化为模式中的预报方程至关重要。",
            "id": "4111348",
            "problem": "考虑一个嵌入在数值天气预报框架中的暖雨双矩微物理参数化方案。该方案预测两种水凝物类别：云滴和雨滴。设预报的矩为质量混合比 $q_{c}$ 和 $q_{r}$（单位质量湿空气中的液态水质量），以及数浓度 $N_{c}$ 和 $N_{r}$（单位质量湿空气中的粒子数）。每个类别由一个关于粒子质量 $m$ 的滴谱分布（DSD）表示，其形状为由一个规定的形状参数约束的伽马分布：对于云滴，\n$$\nn_{c}(m) \\;=\\; \\frac{N_{c}}{\\Gamma(k_{c})\\, m_{*c}^{k_{c}}}\\, m^{k_{c}-1}\\, \\exp\\!\\left(-\\frac{m}{m_{*c}}\\right),\n$$\n对于雨滴，\n$$\nn_{r}(m) \\;=\\; \\frac{N_{r}}{\\Gamma(k_{r})\\, m_{*r}^{k_{r}}}\\, m^{k_{r}-1}\\, \\exp\\!\\left(-\\frac{m}{m_{*r}}\\right),\n$$\n其中 $k_{c}0$ 和 $k_{r}0$ 是规定的（固定的）形状参数，$\\Gamma(\\cdot)$ 是伽马函数，$m_{*c}$ 和 $m_{*r}$ 是尺度参数。$n_{c}(m)$ 和 $n_{r}(m)$ 的 0 阶矩和 1 阶矩分别给出 $N_{x}$ 和 $q_{x}$（对于 $x\\in\\{c,r\\}$），这意味着平均粒子质量为\n$$\n\\bar{m}_{c} \\;=\\; \\frac{q_{c}}{N_{c}} \\;=\\; k_{c}\\, m_{*c}, \\qquad\n\\bar{m}_{r} \\;=\\; \\frac{q_{r}}{N_{r}} \\;=\\; k_{r}\\, m_{*r}.\n$$\n\n云向雨的转化通过两个过程发生：\n- 自动转化，源于云-云双粒子碰撞，形成超过雨滴阈值质量 $m_{t}$ 的雨滴。\n- 碰并，源于雨-云碰撞，将云水质量转移到雨滴上。\n\n设从云到雨的自动转化质量转移率表示为 $A(q_{c},N_{c})$，碰并质量转移率表示为 $C(q_{c},q_{r},N_{r})$。这些率可以通过对 $n_{c}(m)$ 和 $n_{r}(m)$ 积分适当的碰撞核，从动力学碰并方程（KCE）中正式推导得出；此处不需要它们的显式形式，但它们满足 $A\\ge 0$ 和 $C\\ge 0$，且量纲为单位时间内的 $q$。\n\n从液态水质量守恒和伽马滴谱分布的矩结构出发，根据以下物理上一致的约束条件，推导由于自动转化和碰并过程对预报矩向量 $(q_{c},N_{c},q_{r},N_{r})$ 产生的源项（趋势项）的解析表达式：\n1. 液态水质量在类别之间守恒：自动转化和碰并将质量从云中移除并将其增加到雨中。\n2. 规定的形状参数 $k_{c}$ 和 $k_{r}$ 随时间保持不变。此约束要求每个类别中 $(q_{x},N_{x})$ 的隐含变化与伽马滴谱分布的矩关系一致，即，在当前滴谱分布的意义上，变化反映了谱上均匀的移除或注入。\n3. 自动转化按与 $\\bar{m}_{c}$ 相关的移除云质量的比例减少云滴数，并按与 $\\bar{m}_{r}$ 相关的增加雨质量的比例注入雨滴数。碰并按与 $\\bar{m}_{c}$ 相关的移除云质量的比例减少云滴数，并增加雨滴质量而不改变雨滴数（即，碰并使现有雨滴增长，而不产生新的雨滴）。\n\n请用 $A$、$C$、$q_{c}$、$N_{c}$、$q_{r}$ 和 $N_{r}$ 表示四个源项 $(S_{q_{c}},S_{N_{c}},S_{q_{r}},S_{N_{r}})$，将最终答案表示为单个闭合形式的符号行向量。不需要进行数值计算。最终的方框表达式中不要包含单位。",
            "solution": "用户希望找到暖雨微物理参数化方案中预报变量的源项。\n\n这个问题是**有效的**，因为它科学地基于云微物理学的既定原理，问题设定良好，目标明确，约束条件充分，并使用标准术语客观陈述。推导过程是所提供规则的直接应用。\n\n预报矩的向量是 $(q_{c},N_{c},q_{r},N_{r})$。我们的任务是找到由自动转化和碰并这两个微物理过程引起的源项（或趋势项）向量。设该向量为 $(S_{q_{c}}, S_{N_{c}}, S_{q_{r}}, S_{N_{r}})$，其中每一项代表相应变量的时间变化率。每个变量的总源项是自动转化（速率为 $A$）和碰并（速率为 $C$）贡献的总和。我们将根据给定的约束条件分析每个过程。\n\n首先，我们来处理质量混合比的趋势项 $S_{q_{c}}$ 和 $S_{q_{r}}$。约束条件 1 指出，液态水质量是守恒的，并且自动转化和碰并将质量从云类别转移到雨类别。\n由自动转化引起的从云到雨的质量转移速率为 $A$。\n由碰并引起的从云到雨的质量转移速率为 $C$。\n因此，云类别总的质量损失速率是这两个速率之和。\n$$\nS_{q_{c}} = -A - C = -(A+C)\n$$\n根据质量守恒，雨类别必须获得等量的质量。\n$$\nS_{q_{r}} = A + C\n$$\n快速检查可证实质量守恒：$S_{q_{c}} + S_{q_{r}} = -(A+C) + (A+C) = 0$。\n\n接下来，我们处理数浓度的趋势项 $S_{N_{c}}$ 和 $S_{N_{r}}$。这些由约束条件 3 确定，该条件详细说明了每个过程中粒子数量如何变化。我们分别考虑每个过程。\n\n对于自动转化：\n- 约束条件 3 指出：“自动转化按与 $\\bar{m}_{c}$ 相关的移除云质量的比例减少云滴数”。自动转化移除的云水质量为 $A$。一个云滴的平均质量是 $\\bar{m}_{c} = q_{c}/N_{c}$。因此，由自动转化引起的云数浓度变化率为：\n$$\nS_{N_{c}}^{\\text{auto}} = -\\frac{A}{\\bar{m}_{c}} = -\\frac{A}{q_{c}/N_{c}} = -A\\frac{N_{c}}{q_{c}}\n$$\n- 约束条件 3 还指出：自动转化“按与 $\\bar{m}_{r}$ 相关的增加雨质量的比例注入雨滴数”。增加到雨类别的质量是 $A$。一个雨滴的平均质量是 $\\bar{m}_{r} = q_{r}/N_{r}$。因此，由自动转化产生新雨滴的速率为：\n$$\nS_{N_{r}}^{\\text{auto}} = +\\frac{A}{\\bar{m}_{r}} = +\\frac{A}{q_{r}/N_{r}} = +A\\frac{N_{r}}{q_{r}}\n$$\n这种模型选择意味着自动转化增加的新雨滴与已存在的雨滴群体具有相同的平均质量，这确保了平均质量 $\\bar{m}_{r}$ 仅在自动转化作用下保持不变。\n\n对于碰并：\n- 约束条件 3 指出：“碰并按与 $\\bar{m}_{c}$ 相关的移除云质量的比例减少云滴数”。碰并移除的云水质量为 $C$。这与自动转化对云滴数的影响类似。由碰并引起的云数浓度变化率为：\n$$\nS_{N_{c}}^{\\text{accr}} = -\\frac{C}{\\bar{m}_{c}} = -\\frac{C}{q_{c}/N_{c}} = -C\\frac{N_{c}}{q_{c}}\n$$\n- 约束条件 3 还指出：碰并“增加雨滴质量而不改变雨滴数”。这是一个明确的陈述，即碰并使现有雨滴增长，而不产生新的雨滴。\n$$\nS_{N_{r}}^{\\text{accr}} = 0\n$$\n\n现在，我们将两个过程的贡献相加，以求得数浓度的总趋势项。\n云数浓度的总趋势项 $S_{N_{c}}$ 是自动转化和碰并部分的总和：\n$$\nS_{N_{c}} = S_{N_{c}}^{\\text{auto}} + S_{N_{c}}^{\\text{accr}} = -A\\frac{N_{c}}{q_{c}} - C\\frac{N_{c}}{q_{c}} = -(A+C)\\frac{N_{c}}{q_{c}}\n$$\n雨数浓度的总趋势项 $S_{N_{r}}$ 是自动转化和碰并部分的总和：\n$$\nS_{N_{r}} = S_{N_{r}}^{\\text{auto}} + S_{N_{r}}^{\\text{accr}} = A\\frac{N_{r}}{q_{r}} + 0 = A\\frac{N_{r}}{q_{r}}\n$$\n\n最后，我们按照要求将四个推导出的源项组合成一个单独的行向量。\n源项向量 $(S_{q_{c}}, S_{N_{c}}, S_{q_{r}}, S_{N_{r}})$ 是：\n$S_{q_{c}} = -(A+C)$\n$S_{N_{c}} = -(A+C)\\frac{N_{c}}{q_{c}}$\n$S_{q_{r}} = A+C$\n$S_{N_{r}} = A\\frac{N_{r}}{q_{r}}$\n\n得到的向量是 $\\left( -(A+C), -(A+C)\\frac{N_{c}}{q_{c}}, A+C, A\\frac{N_{r}}{q_{r}} \\right)$。这些表达式与所给的约束条件在物理上是一致的。例如，在这些变换下，平均云滴质量 $\\bar{m}_{c}=q_{c}/N_{c}$ 保持不变，因为 $\\frac{d\\bar{m}_{c}}{dt} \\propto \\frac{S_{q_{c}}}{q_{c}} - \\frac{S_{N_{c}}}{N_{c}} = \\frac{-(A+C)}{q_{c}} - \\frac{-(A+C)}{q_{c}} = 0$。这与约束条件 2 一致。相反，平均雨滴质量 $\\bar{m}_{r}=q_{r}/N_{r}$ 因碰并而增加，因为 $\\frac{d\\bar{m}_{r}}{dt} \\propto \\frac{S_{q_{r}}}{q_{r}} - \\frac{S_{N_{r}}}{N_{r}} = \\frac{A+C}{q_{r}} - \\frac{A}{q_{r}} = \\frac{C}{q_{r}}  0$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix} -(A+C)  -(A+C)\\frac{N_{c}}{q_{c}}  A+C  A\\frac{N_{r}}{q_{r}} \\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在实际应用中，并不存在唯一“正确”的暖雨参数化方案，方案的选择是模型不确定性的一个主要来源。这项高级练习将让您扮演模型开发者的角色，任务是实现并比较三种具有不同结构假设的经典方案。通过对它们的输出进行标准化并计算特定指标，您将学会如何分离和量化因物理过程的不同表达方式而产生的结构不确定性，这是当前模式评估与改进中的核心议题。",
            "id": "4111354",
            "problem": "您需要实现一个零维暖雨微物理试验台，用于在相同的环境和热力学条件下，比较三种暖雨参数化方案——Kessler、Khairoutdinov–Kogan 2000（以下简称KK）和 Seifert–Beheng——的结构行为。目标是通过隔离自动转化和碰并增长过程中的过程级差异，而不是由参数调整引起的差异，来评估结构不确定性。您的程序必须生成单行输出，其中包含一个浮点数列表，每个测试案例对应一个浮点数，每个浮点数是如下定义的复合结构差异度量。在适用情况下，所有结果的单位必须是 $\\mathrm{s^{-1}}$，所有输入的混合比单位必须是 $\\mathrm{kg\\,kg^{-1}}$。\n\n从以下基本且经过充分检验的事实出发：\n- 混合比的质量守恒意味着，在一个具有云水混合比 $q_c$ 和雨水混合比 $q_r$ 的封闭暖雨箱中，由自动转化、碰并增长和蒸发引起的过程级趋势满足\n$$\n\\frac{dq_c}{dt} = -\\left(P_{\\mathrm{aut}} + P_{\\mathrm{accr}}\\right),\\quad\n\\frac{dq_r}{dt} = +\\left(P_{\\mathrm{aut}} + P_{\\mathrm{accr}}\\right) - P_{\\mathrm{evap}},\n$$\n其中，当应用于无量纲的混合比 $q_c$ 和 $q_r$（单位为 $\\mathrm{kg\\,kg^{-1}}$）时，$P_{\\mathrm{aut}}$、$P_{\\mathrm{accr}}$ 和 $P_{\\mathrm{evap}}$ 的单位为 $\\mathrm{s^{-1}}$。\n- 碰撞-合并通过自动转化（仅涉及云的过程）和碰并增长（雨水对云水的收集）来增加雨水质量，而蒸发在次饱和空气中按比例于饱和差因子移除雨水。\n- 云滴数浓度 $N_c$ 和雨滴数浓度 $N_r$（单位均为 $\\mathrm{m^{-3}}$）编码了微物理结构；在双矩方案中，质量传输率取决于从 $q_c$、$q_r$、$N_c$ 和 $N_r$ 推断出的特征尺度。\n\n使用以下数学上明确的过程率公式实现三种参数化方案。所有符号和常数必须严格按照给定值使用。\n\n通用环境和物理常数（在指定处使用）：\n- 空气密度：$\\rho_a = 1.2\\,\\mathrm{kg\\,m^{-3}}$。\n- 液态水密度：$\\rho_w = 1000\\,\\mathrm{kg\\,m^{-3}}$。\n- 参考云滴数浓度：$N_{\\mathrm{ref}} = 1.0\\times 10^{8}\\,\\mathrm{m^{-3}}$。\n- 通用蒸发系数：$E_0 = 2.0\\times 10^{-3}\\,\\mathrm{s^{-1}}$（所有方案共享，以隔离收集过程的结构差异）。\n- 蒸发率：\n$$\nP_{\\mathrm{evap}} = E_0\\, q_r \\,\\max\\left(1 - \\mathrm{RH},\\, 0\\right),\n$$\n其中 $\\mathrm{RH}$ 是相对湿度，为 $[0,1]$ 范围内的分数。\n\nKessler 方案（单矩）：\n- 阈值自动转化：\n$$\nP_{\\mathrm{aut}}^{\\mathrm{Kes}} = A_{\\mathrm{Kes}} \\,\\max\\left(q_c - q_{0},\\, 0\\right),\n$$\n其中 $A_{\\mathrm{Kes}} = 1.0\\times 10^{-3}\\,\\mathrm{s^{-1}}$，$q_{0} = 5.0\\times 10^{-4}\\,\\mathrm{kg\\,kg^{-1}}$。\n- 碰并增长：\n$$\nP_{\\mathrm{accr}}^{\\mathrm{Kes}} = B_{\\mathrm{Kes}}\\, q_c\\, q_r,\n$$\n其中 $B_{\\mathrm{Kes}} = 1.6\\,\\mathrm{s^{-1}}$。\n\nKhairoutdinov–Kogan 2000（在 $q_c$ 和 $q_r$ 上为单矩，但在自动转化中具有明确的 $N_c$ 依赖性）：\n- 自动转化（含 $N_c$ 的幂律）：\n$$\nP_{\\mathrm{aut}}^{\\mathrm{KK}} = A_{\\mathrm{KK}}\\, q_c^{p}\\,\\left(\\frac{N_c}{N_{\\mathrm{ref}}}\\right)^{-r},\n$$\n其中 $A_{\\mathrm{KK}} = 5.0\\times 10^{-4}\\,\\mathrm{s^{-1}}$，$p = 2.2$，$r = 0.5$。\n- 碰并增长（在 $q_r$ 上非线性）：\n$$\nP_{\\mathrm{accr}}^{\\mathrm{KK}} = B_{\\mathrm{KK}}\\, q_c\\, q_r^{\\delta},\n$$\n其中 $B_{\\mathrm{KK}} = 2.2\\,\\mathrm{s^{-1}}$，$\\delta = 0.875$。\n\nSeifert–Beheng（对雨水为双矩；通过特征尺度体现结构依赖性）：\n- 云有效半径（从 $q_c$ 和 $N_c$ 诊断得出）：\n$$\nr_{\\mathrm{eff},c} = \\left(\\frac{3\\, \\rho_a\\, q_c}{4\\pi\\, \\rho_w\\, N_c}\\right)^{1/3}\\ \\mathrm{m}.\n$$\n- 雨水质量加权平均直径（从 $q_r$ 和 $N_r$ 诊断得出）：\n$$\nD_m = \\left(\\frac{6\\, \\rho_a\\, q_r}{\\pi\\, \\rho_w\\, N_r}\\right)^{1/3}\\ \\mathrm{m}.\n$$\n- 自动转化（尺度调制的 $q_c$ 二次方）：\n$$\nP_{\\mathrm{aut}}^{\\mathrm{SB}} = A_{\\mathrm{SB}}\\, q_c^{2}\\, \\left(\\frac{r_{\\mathrm{eff},c}}{r_0}\\right)^{s},\\quad A_{\\mathrm{SB}} = 8.0\\times 10^{-4}\\,\\mathrm{s^{-1}},\\ r_0 = 10\\times 10^{-6}\\,\\mathrm{m},\\ s = 0.5.\n$$\n- 碰并增长（尺度调制的近线性 $q_r$）：\n$$\nP_{\\mathrm{accr}}^{\\mathrm{SB}} = B_{\\mathrm{SB}}\\, q_c\\, q_r^{\\eta}\\, \\left(\\frac{D_m}{D_0}\\right)^{\\beta},\\quad B_{\\mathrm{SB}} = 1.8\\,\\mathrm{s^{-1}},\\ \\eta = 0.95,\\ D_0 = 1.0\\times 10^{-3}\\,\\mathrm{m},\\ \\beta = 0.5.\n$$\n\n幅度对齐以隔离结构差异：\n- 对于一个指定的参考测试案例（如下文所述），计算每种方案的未缩放总雨水质量生成（源）,\n$$\nR^{X}_{\\mathrm{ref}} = P_{\\mathrm{aut}}^{X} + P_{\\mathrm{accr}}^{X},\\quad X\\in\\{\\mathrm{Kes},\\mathrm{KK},\\mathrm{SB}\\}.\n$$\n- 将参考案例下的通用目标生成率定义为\n$$\n\\overline{R}_{\\mathrm{ref}} = \\frac{1}{3}\\left(R^{\\mathrm{Kes}}_{\\mathrm{ref}} + R^{\\mathrm{KK}}_{\\mathrm{ref}} + R^{\\mathrm{SB}}_{\\mathrm{ref}}\\right).\n$$\n- 为每种方案计算一个标量幅度因子：\n$$\ns_X = \\frac{\\overline{R}_{\\mathrm{ref}}}{R^{X}_{\\mathrm{ref}}}.\n$$\n- 对于每个测试案例（包括参考案例），仅使用其对应的 $s_X$ 缩放每种方案的自动转化和碰并增长：\n$$\n\\widetilde{P}_{\\mathrm{aut}}^{X} = s_X\\, P_{\\mathrm{aut}}^{X},\\quad \\widetilde{P}_{\\mathrm{accr}}^{X} = s_X\\, P_{\\mathrm{accr}}^{X},\n$$\n并保持所有方案的 $P_{\\mathrm{evap}}$ 相同（使用上述的 $E_0$）。这隔离了结构（形态）差异，而不是简单的幅度调整。\n\n为每种方案 $X$ 和每个测试案例定义以下诊断量：\n- 总缩放生成率：\n$$\n\\widetilde{R}^{X} = \\widetilde{P}_{\\mathrm{aut}}^{X} + \\widetilde{P}_{\\mathrm{accr}}^{X}.\n$$\n- 归一化生成分配向量（成分），\n$$\n\\mathbf{c}^{X} =\n\\begin{cases}\n\\left[\\dfrac{\\widetilde{P}_{\\mathrm{aut}}^{X}}{\\widetilde{R}^{X}},\\ \\dfrac{\\widetilde{P}_{\\mathrm{accr}}^{X}}{\\widetilde{R}^{X}}\\right],  \\widetilde{R}^{X}  0, \\\\[8pt]\n[0,0],  \\widetilde{R}^{X} = 0.\n\\end{cases}\n$$\n- 相对于生成的蒸发分数（蒸发限制响应），\n$$\ne^{X} = \\frac{P_{\\mathrm{evap}}}{\\widetilde{R}^{X} + \\varepsilon},\\quad \\varepsilon = 10^{-30}.\n$$\n\n对于每个测试案例，计算方案 $X$ 和 $Y$ 之间的成对结构距离：\n- 成分距离：\n$$\nd_1(X,Y) = \\left\\|\\mathbf{c}^{X} - \\mathbf{c}^{Y}\\right\\|_2.\n$$\n- 蒸发分数距离：\n$$\nd_2(X,Y) = \\left|e^{X} - e^{Y}\\right|.\n$$\n- 相对生成形态距离：\n$$\nd_3(X,Y) = \\left|\\log_{10}\\left(\\frac{\\widetilde{R}^{X} + \\varepsilon}{\\widetilde{R}^{Y} + \\varepsilon}\\right)\\right|.\n$$\n- 复合配对度量：\n$$\nm_{\\mathrm{pair}}(X,Y) = \\frac{d_1(X,Y) + d_2(X,Y) + d_3(X,Y)}{3}.\n$$\n将测试案例的结构不确定性度量定义为三对配对的平均值：\n$$\nM_{\\mathrm{case}} = \\frac{1}{3}\\left[m_{\\mathrm{pair}}(\\mathrm{Kes},\\mathrm{KK}) + m_{\\mathrm{pair}}(\\mathrm{Kes},\\mathrm{SB}) + m_{\\mathrm{pair}}(\\mathrm{KK},\\mathrm{SB})\\right].\n$$\n\n测试套件（五个物理上合理的箱状态）。每个测试案例是一个元组 $\\left(q_c, q_r, \\mathrm{RH}, N_c, N_r\\right)$，其中 $q_c$ 和 $q_r$ 的单位是 $\\mathrm{kg\\,kg^{-1}}$，$\\mathrm{RH}$ 是在 $[0,1]$ 区间的无单位分数，$N_c, N_r$ 的单位是 $\\mathrm{m^{-3}}$：\n- 案例 1（亚阈值云，无雨）：$\\left(2.0\\times 10^{-4},\\ 0.0,\\ 0.90,\\ 1.0\\times 10^{8},\\ 5.0\\times 10^{5}\\right)$。\n- 案例 2（中等云量，初生雨）：$\\left(8.0\\times 10^{-4},\\ 1.0\\times 10^{-5},\\ 0.80,\\ 1.5\\times 10^{8},\\ 1.0\\times 10^{6}\\right)$。\n- 案例 3（用于幅度对齐的参考案例）：$\\left(1.5\\times 10^{-3},\\ 5.0\\times 10^{-4},\\ 0.85,\\ 1.0\\times 10^{8},\\ 5.0\\times 10^{5}\\right)$。\n- 案例 4（雨水主导）：$\\left(2.0\\times 10^{-4},\\ 1.5\\times 10^{-3},\\ 0.70,\\ 8.0\\times 10^{7},\\ 2.0\\times 10^{5}\\right)$。\n- 案例 5（近饱和，弱蒸发）：$\\left(1.0\\times 10^{-3},\\ 2.0\\times 10^{-4},\\ 0.98,\\ 1.0\\times 10^{8},\\ 1.0\\times 10^{6}\\right)$。\n\n实现要求：\n- 为每种方案和每个测试案例精确计算上述的 $P_{\\mathrm{aut}}$、$P_{\\mathrm{accr}}$ 和 $P_{\\mathrm{evap}}$。\n- 仅使用案例 3 来计算幅度因子 $s_{\\mathrm{Kes}}$、$s_{\\mathrm{KK}}$、$s_{\\mathrm{SB}}$，然后应用这些因子来缩放所有五个案例的自动转化和碰并增长。\n- 对每个案例，计算定义的 $M_{\\mathrm{case}}$。\n- 最终输出必须是单行，包含一个 Python 风格的五个浮点数列表 $\\left[M_1,M_2,M_3,M_4,M_5\\right]$，按此顺序排列，每个浮点数四舍五入到六位小数。\n- 不涉及角度；不需要角度单位。\n- 所有计算都必须使用提供的单位完成；无需进行所示之外的单位转换。\n- 您的程序必须是自包含的，不得读取任何输入，也不得访问外部资源。它应该严格按照所述格式生成一行输出（例如，$\\left[\\mathrm{result1},\\mathrm{result2},\\mathrm{result3},\\mathrm{result4},\\mathrm{result5}\\right]$）。",
            "solution": "该问题要求实现一个零维箱式模型，以比较三种不同的暖雨参数化方案：Kessler、Khairoutdinov–Kogan 2000 (KK) 和 Seifert–Beheng (SB)。其目标是通过在一组标准化条件下分析这些方案的过程级行为，来量化它们之间的结构不确定性。解决方案分为三个主要阶段：(1) 为每个方案实现物理过程率，(2) 基于一个参考案例对方案的生成幅度进行归一化，以隔离结构差异，(3) 为一套测试案例计算结构相异性的复合度量。\n\n首先，我们按规定定义基本物理常数和模型参数。这些包括例如空气密度 $\\rho_a = 1.2\\,\\mathrm{kg\\,m^{-3}}$ 和液态水密度 $\\rho_w = 1000\\,\\mathrm{kg\\,m^{-3}}$ 等环境常数，以及每种方案的特定过程参数。\n\n模型的核心由代表微物理过程率的函数组成。对于每个方案 $X \\in \\{\\mathrm{Kes},\\mathrm{KK},\\mathrm{SB}\\}$，我们实现其自动转化率 $P_{\\mathrm{aut}}^{X}$ 和碰并增长率 $P_{\\mathrm{accr}}^{X}$。这些率决定了质量从云水（$q_c$）到雨水（$q_r$）的转移。一个单一、通用的蒸发公式 $P_{\\mathrm{evap}}$ 被应用于所有方案，以确保差异仅源于降雨形成过程（自动转化和碰并增长）。\n\nKessler 方案是一种单矩总体参数化，其特点是基于阈值的自动转化和线性的碰并增长：\n$$\nP_{\\mathrm{aut}}^{\\mathrm{Kes}} = A_{\\mathrm{Kes}} \\,\\max\\left(q_c - q_{0},\\, 0\\right)\n$$\n$$\nP_{\\mathrm{accr}}^{\\mathrm{Kes}} = B_{\\mathrm{Kes}}\\, q_c\\, q_r\n$$\n其常数为 $A_{\\mathrm{Kes}} = 1.0\\times 10^{-3}\\,\\mathrm{s^{-1}}$，$q_{0} = 5.0\\times 10^{-4}\\,\\mathrm{kg\\,kg^{-1}}$ 和 $B_{\\mathrm{Kes}} = 1.6\\,\\mathrm{s^{-1}}$。\n\nKhairoutdinov–Kogan 方案在自动转化率中引入了对云滴数浓度 $N_c$ 的依赖，这代表了与 Kessler 方案的一个重要结构差异。其速率由幂律给出：\n$$\nP_{\\mathrm{aut}}^{\\mathrm{KK}} = A_{\\mathrm{KK}}\\, q_c^{p}\\,\\left(\\frac{N_c}{N_{\\mathrm{ref}}}\\right)^{-r}\n$$\n$$\nP_{\\mathrm{accr}}^{\\mathrm{KK}} = B_{\\mathrm{KK}}\\, q_c\\, q_r^{\\delta}\n$$\n其参数为 $A_{\\mathrm{KK}} = 5.0\\times 10^{-4}\\,\\mathrm{s^{-1}}$，$p = 2.2$，$r = 0.5$，$N_{\\mathrm{ref}} = 1.0\\times 10^{8}\\,\\mathrm{m^{-3}}$，$B_{\\mathrm{KK}} = 2.2\\,\\mathrm{s^{-1}}$ 和 $\\delta = 0.875$。\n\nSeifert–Beheng 方案是一个更复杂的、针对雨水的双矩方案，其过程率不仅取决于质量混合比，还取决于特征粒子尺度，这些尺度是根据质量和数浓度（$q_c, N_c, q_r, N_r$）诊断出来的。\n首先，诊断出云有效半径 $r_{\\mathrm{eff},c}$ 和雨水质量加权平均直径 $D_m$：\n$$\nr_{\\mathrm{eff},c} = \\left(\\frac{3\\, \\rho_a\\, q_c}{4\\pi\\, \\rho_w\\, N_c}\\right)^{1/3}\n$$\n$$\nD_m = \\left(\\frac{6\\, \\rho_a\\, q_r}{\\pi\\, \\rho_w\\, N_r}\\right)^{1/3}\n$$\n这些尺度调制了过程率：\n$$\nP_{\\mathrm{aut}}^{\\mathrm{SB}} = A_{\\mathrm{SB}}\\, q_c^{2}\\, \\left(\\frac{r_{\\mathrm{eff},c}}{r_0}\\right)^{s}\n$$\n$$\nP_{\\mathrm{accr}}^{\\mathrm{SB}} = B_{\\mathrm{SB}}\\, q_c\\, q_r^{\\eta}\\, \\left(\\frac{D_m}{D_0}\\right)^{\\beta}\n$$\n其参数集包括用于自动转化的 $A_{\\mathrm{SB}} = 8.0\\times 10^{-4}\\,\\mathrm{s^{-1}}$，$r_0 = 10\\times 10^{-6}\\,\\mathrm{m}$ 和 $s=0.5$，以及用于碰并增长的 $B_{\\mathrm{SB}} = 1.8\\,\\mathrm{s^{-1}}$，$\\eta=0.95$，$D_0=1.0\\times 10^{-3}\\,\\mathrm{m}$ 和 $\\beta=0.5$。如果 $q_r=0$ 或 $N_r=0$，则 $D_m$ 为零，并且由于 $\\eta0$，$P_{\\mathrm{accr}}^{\\mathrm{SB}}$ 正确地计算为零。\n\n一个关键步骤是幅度对齐。为了比较方案的*结构*而不是它们可以调整的基线量级，我们对其进行归一化。使用指定的参考案例（案例 3），我们为每个方案计算未缩放的总降雨生成率 $R^{X}_{\\mathrm{ref}} = P_{\\mathrm{aut}}^{X} + P_{\\mathrm{accr}}^{X}$。目标生成率是它们的平均值 $\\overline{R}_{\\mathrm{ref}}$。由此，我们为每个方案推导出唯一的缩放因子 $s_X = \\overline{R}_{\\mathrm{ref}} / R^{X}_{\\mathrm{ref}}$。然后将这些因子应用于所有测试案例的自动转化和碰并增长率：\n$$\n\\widetilde{P}_{\\mathrm{aut}}^{X} = s_X\\, P_{\\mathrm{aut}}^{X}, \\quad \\widetilde{P}_{\\mathrm{accr}}^{X} = s_X\\, P_{\\mathrm{accr}}^{X}\n$$\n这确保了在参考点，所有方案都以相同的总速率 $\\widetilde{R}^X = \\overline{R}_{\\mathrm{ref}}$ 生成雨水。在其他测试案例中，任何与此等式的偏离都是由于其公式中的结构差异造成的。\n\n利用缩放后的率，我们为每个方案 $X$ 和测试案例计算一组诊断量。这些诊断量旨在探究方案结构的不同方面：\n1.  归一化的生成分配向量 $\\mathbf{c}^{X} = \\left[\\widetilde{P}_{\\mathrm{aut}}^{X}/\\widetilde{R}^{X}, \\widetilde{P}_{\\mathrm{accr}}^{X}/\\widetilde{R}^{X}\\right]$（对于 $\\widetilde{R}^{X}0$），捕捉了自动转化和碰并增长之间的质量通量分配。\n2.  蒸发分数 $e^{X} = P_{\\mathrm{evap}}/(\\widetilde{R}^{X} + \\varepsilon)$，量化了雨水生成与蒸发之间的平衡，其中一个小常数 $\\varepsilon = 10^{-30}$ 确保了数值稳定性。\n3.  总缩放生成率本身 $\\widetilde{R}^{X}$，揭示了总生成响应如何作为输入状态变量的函数而偏离参考案例。\n\n最后，我们使用一个复合度量来量化任意两个方案 $X$ 和 $Y$ 之间的结构差异。该度量由三个成对距离构建而成：\n-   $d_1(X,Y) = \\left\\|\\mathbf{c}^{X} - \\mathbf{c}^{Y}\\right\\|_2$，它们的成分向量之间的欧几里得距离。\n-   $d_2(X,Y) = \\left|e^{X} - e^{Y}\\right|$，它们的蒸发限制响应的差异。\n-   $d_3(X,Y) = \\left|\\log_{10}\\left((\\widetilde{R}^{X} + \\varepsilon)/(\\widetilde{R}^{Y} + \\varepsilon)\\right)\\right|$，它们的总生成率的对数比率，这捕捉了它们响应函数形态上的差异。\n\n复合配对度量是这三个距离的平均值：$m_{\\mathrm{pair}}(X,Y) = (d_1+d_2+d_3)/3$。给定测试案例的最终结构不确定性度量 $M_{\\mathrm{case}}$ 是三个可能的成对度量 $m_{\\mathrm{pair}}(\\mathrm{Kes},\\mathrm{KK})$、$m_{\\mathrm{pair}}(\\mathrm{Kes},\\mathrm{SB})$ 和 $m_{\\mathrm{pair}}(\\mathrm{KK},\\mathrm{SB})$ 的平均值。对所有五个测试案例重复此过程，从而得出一个包含五个 $M_{\\mathrm{case}}$ 值的列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Implements a zero-dimensional warm-rain microphysics testbed to compare\n    Kessler, Khairoutdinov-Kogan 2000, and Seifert-Beheng parameterizations.\n    \"\"\"\n\n    # ----------------------------------------------------------------------\n    # 1. Define Constants and Parameters\n    # ----------------------------------------------------------------------\n\n    # Common environmental and physical constants\n    RHO_A = 1.2         # Air density (kg/m^3)\n    RHO_W = 1000.0      # Liquid water density (kg/m^3)\n    N_REF = 1.0e8       # Reference cloud droplet number (m^-3)\n    E0 = 2.0e-3         # Common evaporation coefficient (s^-1)\n    EPSILON = 1.0e-30   # Small number for numerical stability\n\n    # Kessler scheme parameters\n    A_KES = 1.0e-3      # s^-1\n    Q0_KES = 5.0e-4     # kg/kg\n    B_KES = 1.6         # s^-1\n\n    # Khairoutdinov-Kogan 2000 (KK) parameters\n    A_KK = 5.0e-4       # s^-1\n    P_KK = 2.2\n    R_KK = 0.5\n    B_KK = 2.2          # s^-1\n    DELTA_KK = 0.875\n\n    # Seifert-Beheng (SB) parameters\n    A_SB = 8.0e-4       # s^-1\n    R0_SB = 10.0e-6     # m\n    S_SB = 0.5\n    B_SB = 1.8          # s^-1\n    ETA_SB = 0.95\n    D0_SB = 1.0e-3      # m\n    BETA_SB = 0.5\n\n    # ----------------------------------------------------------------------\n    # 2. Define Process Rate Functions\n    # ----------------------------------------------------------------------\n\n    def p_evap(qr, rh):\n        return E0 * qr * max(1.0 - rh, 0.0)\n\n    # Kessler\n    def p_aut_kes(qc):\n        return A_KES * max(qc - Q0_KES, 0.0)\n\n    def p_accr_kes(qc, qr):\n        return B_KES * qc * qr\n\n    # Khairoutdinov-Kogan\n    def p_aut_kk(qc, nc):\n        if qc == 0: return 0.0\n        return A_KK * (qc**P_KK) * ((nc / N_REF)**(-R_KK))\n\n    def p_accr_kk(qc, qr):\n        if qc == 0 or qr == 0: return 0.0\n        return B_KK * qc * (qr**DELTA_KK)\n\n    # Seifert-Beheng\n    def r_eff_c_sb(qc, nc):\n        if qc == 0 or nc == 0: return 0.0\n        return np.cbrt((3.0 * RHO_A * qc) / (4.0 * np.pi * RHO_W * nc))\n\n    def d_m_sb(qr, nr):\n        if qr == 0 or nr == 0: return 0.0\n        return np.cbrt((6.0 * RHO_A * qr) / (np.pi * RHO_W * nr))\n\n    def p_aut_sb(qc, nc):\n        if qc == 0: return 0.0\n        reff_c = r_eff_c_sb(qc, nc)\n        return A_SB * (qc**2) * ((reff_c / R0_SB)**S_SB)\n\n    def p_accr_sb(qc, qr, nr):\n        if qc == 0 or qr == 0: return 0.0\n        dm = d_m_sb(qr, nr)\n        return B_SB * qc * (qr**ETA_SB) * ((dm / D0_SB)**BETA_SB)\n\n    # ----------------------------------------------------------------------\n    # 3. Define Test Cases\n    # ----------------------------------------------------------------------\n    # (qc, qr, RH, Nc, Nr)\n    test_cases = [\n        (2.0e-4, 0.0,    0.90, 1.0e8, 5.0e5), # Case 1\n        (8.0e-4, 1.0e-5, 0.80, 1.5e8, 1.0e6), # Case 2\n        (1.5e-3, 5.0e-4, 0.85, 1.0e8, 5.0e5), # Case 3 (Reference)\n        (2.0e-4, 1.5e-3, 0.70, 8.0e7, 2.0e5), # Case 4\n        (1.0e-3, 2.0e-4, 0.98, 1.0e8, 1.0e6), # Case 5\n    ]\n    ref_case = test_cases[2]\n\n    # ----------------------------------------------------------------------\n    # 4. Amplitude Alignment\n    # ----------------------------------------------------------------------\n    qc_ref, qr_ref, _, nc_ref, nr_ref = ref_case\n\n    # Kessler\n    R_kes_ref = p_aut_kes(qc_ref) + p_accr_kes(qc_ref, qr_ref)\n    # Khairoutdinov-Kogan\n    R_kk_ref = p_aut_kk(qc_ref, nc_ref) + p_accr_kk(qc_ref, qr_ref)\n    # Seifert-Beheng\n    R_sb_ref = p_aut_sb(qc_ref, nc_ref) + p_accr_sb(qc_ref, qr_ref, nr_ref)\n\n    R_bar_ref = (R_kes_ref + R_kk_ref + R_sb_ref) / 3.0\n\n    s_kes = R_bar_ref / R_kes_ref if R_kes_ref > 0 else 1.0\n    s_kk = R_bar_ref / R_kk_ref if R_kk_ref > 0 else 1.0\n    s_sb = R_bar_ref / R_sb_ref if R_sb_ref > 0 else 1.0\n\n    # ----------------------------------------------------------------------\n    # 5. Main Calculation Loop\n    # ----------------------------------------------------------------------\n    M_cases_results = []\n    \n    scheme_funcs = {\n        'Kes': {'aut': p_aut_kes, 'accr': p_accr_kes, 's': s_kes},\n        'KK':  {'aut': p_aut_kk,  'accr': p_accr_kk,  's': s_kk},\n        'SB':  {'aut': p_aut_sb,  'accr': p_accr_sb,  's': s_sb},\n    }\n    \n    for case in test_cases:\n        qc, qr, rh, nc, nr = case\n        \n        # Calculate diagnostics for each scheme\n        diags = {}\n        for name, funcs in scheme_funcs.items():\n            \n            # Pass only required arguments\n            aut_args = {'qc': qc, 'nc': nc}\n            accr_args = {'qc': qc, 'qr': qr, 'nr': nr}\n            \n            p_aut_unscaled = funcs['aut'](**{k: v for k, v in aut_args.items() if k in funcs['aut'].__code__.co_varnames})\n            p_accr_unscaled = funcs['accr'](**{k: v for k, v in accr_args.items() if k in funcs['accr'].__code__.co_varnames})\n            \n            p_aut_scaled = funcs['s'] * p_aut_unscaled\n            p_accr_scaled = funcs['s'] * p_accr_unscaled\n            \n            R_scaled = p_aut_scaled + p_accr_scaled\n            \n            if R_scaled > 0:\n                c_vec = np.array([p_aut_scaled / R_scaled, p_accr_scaled / R_scaled])\n            else:\n                c_vec = np.array([0.0, 0.0])\n\n            evap_rate = p_evap(qr, rh)\n            e_frac = evap_rate / (R_scaled + EPSILON)\n            \n            diags[name] = {'R': R_scaled, 'c': c_vec, 'e': e_frac}\n\n        # Calculate pairwise metrics\n        pairs = [('Kes', 'KK'), ('Kes', 'SB'), ('KK', 'SB')]\n        m_pair_values = []\n        for X, Y in pairs:\n            # d1: Composition distance\n            d1 = np.linalg.norm(diags[X]['c'] - diags[Y]['c'])\n            # d2: Evaporation-fraction distance\n            d2 = abs(diags[X]['e'] - diags[Y]['e'])\n            # d3: Relative production shape distance\n            d3 = abs(np.log10((diags[X]['R'] + EPSILON) / (diags[Y]['R'] + EPSILON)))\n            \n            m_pair = (d1 + d2 + d3) / 3.0\n            m_pair_values.append(m_pair)\n            \n        # Calculate final case metric\n        M_case = np.mean(m_pair_values)\n        M_cases_results.append(M_case)\n\n    # ----------------------------------------------------------------------\n    # 6. Final Output\n    # ----------------------------------------------------------------------\n    formatted_results = [f\"{r:.6f}\" for r in M_cases_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n\nsolve()\n```"
        }
    ]
}