## 引言
云和降水过程是驱动天气系统、决定区域和全球气候的关键因素。然而，这些发生在微米到厘米尺度的过程，远小于[数值天气预报](@entry_id:191656)和气候模型的网格尺度，无法被直接解析。因此，必须通过被称为“微物理方案”的[参数化](@entry_id:265163)方法来表示它们。如何选择和构建这些方案，在模型的计算效率和物理真实性之间取得平衡，是现代大气科学面临的核心挑战之一。

本文旨在系统地梳理和剖析用于表示云和降水过程的三类主要微物理方案：单矩、双矩和分档方案。通过深入探讨，读者将能够理解这些方案的内在逻辑、各自的优劣以及它们在科学研究和业务预报中的深远影响。文章将依次展开以下几个部分：

首先，在“原理与机制”部分，我们将从粒子[谱分布](@entry_id:158779)的基础数学描述出发，揭示单矩、双矩和分档方案如何表示和演变[水凝物](@entry_id:1126277)粒子群。

接着，在“应用与交叉学科联系”部分，将探讨这些方案如何与[大气热力学](@entry_id:1121211)、动力学以及遥感观测紧密耦合，并阐述它们在研究[气溶胶-云相互作用](@entry_id:1120855)等前沿气候问题中的关键作用。

最后，“动手实践”部分提供了一系列具体问题，旨在巩固理论知识并培养解决实际问题的能力。

现在，让我们从最基本的问题开始：如何用数学语言描述云中的粒子群，并在此基础上构建起整个微物理方案的层级结构。

## 原理与机制

本章旨在深入探讨数值天气预报和气候模型中用于表示云和降水过程的微物理方案的内在原理和机制。继引言之后，我们将直接进入核心概念，阐明不同复杂程度方案（从单矩、双矩到分档方案）如何表示和演变[水凝物](@entry_id:1126277)粒子群。我们将从粒子谱分布的基础数学描述开始，逐步构建一个框架，以理解每种方案的优势、局限性及其对模型动力学和[热力学](@entry_id:172368)的耦合影响。

### 表示粒子群：粒子[谱分布](@entry_id:158779)（PSD）及其矩

描述一个区域内大量[水凝物](@entry_id:1126277)粒子（如云滴、雨滴或冰晶）的物理状态，最完整的方法是通过**粒子[谱分布](@entry_id:158779)（Particle Size Distribution, PSD）**，通常表示为 $n(D)$。该函数定义了单位体积空气中、单位直径间隔内的粒子数密度，因此 $n(D)dD$ 给出了直径在 $[D, D+dD]$ 范围内的粒子数浓度。

虽然 $n(D)$ 提供了最全面的信息，但在计算上直接处理它往往成本高昂。因此，一个常见的简化方法是使用其**[统计矩](@entry_id:268545)（statistical moments）**来概括其宏观特征。PSD的 $k$ 阶矩 $M_k$ 定义为：

$$
M_k = \int_0^\infty D^k n(D) dD
$$

这些矩直接对应着重要的、可观测的物理量 。

- **总数浓度 ($N_t$)**：通[过积分](@entry_id:753033)整个[谱分布](@entry_id:158779)，我们可以得到单位体积内的总粒子数。这对应于零阶矩 ($k=0$)：
  $$
  N_t = \int_0^\infty n(D) dD = M_0
  $$

- **液态水含量 ($LWC$)**：液态水含量定义为单位体积空气中液态水的总质量。假设粒子为密度恒为 $\rho_w$ 的球体，单个直径为 $D$ 的粒子的体积是 $\frac{\pi}{6}D^3$，质量是 $m(D) = \frac{\pi\rho_w}{6}D^3$。因此，总质量是所有[粒子质量](@entry_id:156313)的积分，这与三阶矩 ($k=3$) 成正比：
  $$
  LWC = \int_0^\infty m(D) n(D) dD = \int_0^\infty \left(\frac{\pi\rho_w}{6}D^3\right) n(D) dD = \frac{\pi\rho_w}{6} M_3
  $$

- **雷达[反射率](@entry_id:172768)因子 ($Z$)**：在瑞利散射区（雷达波长远大于粒子直径），单个球形粒子的后向[散射截面](@entry_id:140322)与 $D^6$ 成正比。天气雷达测量的[反射率](@entry_id:172768)因子 $Z$ 定义为单位体积内所有粒子直径的六次方之和。因此，$Z$ 直接等于六阶矩 ($k=6$)：
  $$
  Z = \int_0^\infty D^6 n(D) dD = M_6
  $$

理解矩与物理量之间的这种关系至关重要，因为它构成了**宏观微物理（bulk microphysics）**方案的基础。这类方案不直接预报 $n(D)$ 本身，而是预报其一个或多个低阶矩。

### 微物理方案的层级

根据它们如何表示和演变PSD，微物理方案可以分为一个复杂性递增的层级：
1.  **单矩宏观方案（Single-Moment Bulk Schemes）**：为每种[水凝物](@entry_id:1126277)预报一个矩。
2.  **双矩宏观方案（Double-Moment Bulk Schemes）**：为每种[水凝物](@entry_id:1126277)预报两个矩。
3.  **分档（谱）微物理方案（Bin/Spectral Microphysics Schemes）**：将PSD离散化为多个尺寸“箱”，并直接预报每个箱中的粒子。

接下来我们将详细探讨每一类方案的原理。

### 宏观微物理参数化方案

宏观方案的核心思想是为PSD假设一个[解析函数](@entry_id:139584)形式，然后通过预报该函数的几个积分矩来演变粒子群。最常用的函数形式是**广义伽马分布**：

$$
n(D) = N_0 D^\mu \exp(-\lambda D)
$$

该分布有三个参数：**截距参数** $N_0$、**[形状参数](@entry_id:270600)** $\mu$ 和**斜率参数** $\lambda$。一个方案的“矩数”决定了它能独立确定多少个这样的参数。

#### 单矩（1M）方案

单矩方案是计算上最经济的宏观方案。它们通常只为每个[水凝物](@entry_id:1126277)类别（如云水、雨水）预报一个矩——**质量[混合比](@entry_id:1127970)** $q_x$。如前所述，$q_x$ 与三阶矩 $M_3$ 成正比。

一个关键问题随之而来：我们只有一个已知的预报量（$q_x$），却需要确定伽马分布的三个参数（$N_0, \mu, \lambda$），这是一个欠定问题。为了解决这个问题，1M方案必须引入**闭合假设（closure assumption）** 。

典型的闭合方法是固定其中两个参数。例如，经典的Marshall-Palmer雨滴谱分布假设 $\mu=0$ 且 $N_0$ 为一个常数。这样一来，唯一的未知数就是斜[率参数](@entry_id:265473) $\lambda$。$\lambda$ 可以通过预报的 $q_x$ 和已知的矩关系式来**诊断（diagnose）**得出：

$$
\rho q_x = \frac{\pi\rho_w}{6} M_3 = \frac{\pi\rho_w}{6} \int_0^\infty D^3 (N_0 e^{-\lambda D}) dD = \frac{\pi\rho_w}{6} N_0 \frac{\Gamma(4)}{\lambda^4}
$$

其中 $\rho$ 是空气密度。由于方程中除 $\lambda$ 外的所有量都是已知或预报的，因此可以唯一地解出 $\lambda$。一旦 $\lambda$ 确定，整个PSD就被完全确定，所有其他矩（如数浓度 $N_t=M_0$ 和雷达[反射率](@entry_id:172768) $Z=M_6$）都可以作为 $q_x$ 的诊断函数计算出来。

这种方法的严重局限性在于，它在质量、数量和[反射率](@entry_id:172768)之间建立了僵硬的、往往不符合物理实际的联系。例如，在只预报 $M_3$ 的1M方案中，若无额外的闭合假设，是无法唯一确定 $M_6$（即雷达[反射率](@entry_id:172768) $Z$）的 。因为具有相同总质量的粒子群（相同的 $M_3$），可以由少数大粒子或大量小粒子组成，而它们的雷达[反射率](@entry_id:172768)（$M_6$）会截然不同。

#### 双矩（2M）方案

为了克服1M方案的局限性，[双矩方案](@entry_id:1123945)被开发出来。这类方案为每个[水凝物](@entry_id:1126277)类别预报两个矩，通常是**质量混合比** $q_x$ (与 $M_3$ 相关) 和**总数浓度** $N_x$ (即 $M_0$) 。

通过提供两个独立的预报量，2M方案增加了模型的**自由度**。对于一个具有三个参数的广义伽马分布，如果我们仍然做一个闭合假设——例如，固定[形状参数](@entry_id:270600) $\mu$ 为一个常数——那么我们现在有两个方程（来自 $q_x$ 和 $N_x$ 的定义）和两个未知数（$N_0$ 和 $\lambda$）：

$$
N_x = \int_0^\infty N_0 D^\mu e^{-\lambda D} dD = N_0 \frac{\Gamma(\mu+1)}{\lambda^{\mu+1}}
$$

$$
\rho q_x = \frac{\pi\rho_w}{6} \int_0^\infty D^3 (N_0 D^\mu e^{-\lambda D}) dD = \frac{\pi\rho_w}{6} N_0 \frac{\Gamma(\mu+4)}{\lambda^{\mu+4}}
$$

这个方程组可以唯一地解出 $N_0$ 和 $\lambda$。例如，通过取 $q_x$ 和 $N_x$ 的比值，可以消去 $N_0$ 并解出 $\lambda$，然后再[回代](@entry_id:146909)求得 $N_0$。

2M方案最重要的物理改进是，它允许**平均粒子尺寸**独立于总质量演变。平均[粒子质量](@entry_id:156313)可以由 $\bar{m} = \rho q_x / N_x$ 定义，这与平均尺寸密切相关。由于 $q_x$ 和 $N_x$ 都是独立预报的，它们的比值可以自由变化，这使得模型能够更真实地模拟粒子群的增长和蒸发过程，例如，在相同的含水量下区分“大陆性”云（粒子多而小）和“海洋性”云（粒子少而大）。这种改进对于准确模拟降水起始和[气溶胶-云相互作用](@entry_id:1120855)至关重要 。

#### 过程[参数化](@entry_id:265163)示例：暖云自转换

宏观方案选择（1M vs 2M）对微物理过程的[参数化](@entry_id:265163)有着深远影响。以**自转换（autoconversion）**过程为例，该过程描述了云滴通过碰撞合并增长为雨滴的起始阶段 。

- **Kessler类型[参数化](@entry_id:265163)（常用于1M方案）**：这是一个经典的1M方案[参数化](@entry_id:265163)，其自转换率仅依赖于云水混合比 $q_c$ 是否超过某个临界阈值 $q_{c, \text{crit}}$。其形式通常为 $P_{AUTO} = k(q_c - q_{c, \text{crit}})$。这种方案完全忽略了数浓度 $N_d$ 的作用。因此，在固定的 $q_c$ 下，无论云滴是多而小还是少而大，其降水起始过程都是一样的，这与物理现实不符。

- **Berry-Reinhardt或Khairoutdinov-Kogan类型[参数化](@entry_id:265163)（常用于2M方案）**：这些更现代的[参数化](@entry_id:265163)方案明确地包含了对数浓度 $N_d$ 的依赖。物理上，对于固定的液水含量 $q_c$，更高的数浓度 $N_d$ 意味着更小的平均粒子半径 $r_v$（因为 $q_c \propto N_d r_v^3$）。较小的[粒子碰撞](@entry_id:160531)效率低，因此会抑制降水的形成。这些[参数化](@entry_id:265163)方案，如Khairoutdinov-Kogan的形式 $P_{AUTO} \propto q_c^a N_d^b$（其中 $b$ 是一个负指数，约为-1.79），能够捕捉到这种效应。这使得2M方案能够模拟气溶胶增加导致云滴数浓度增加，从而抑制降水的关键[气候反馈机制](@entry_id:1122449)。

自转换过程只是一个例子。总的来说，从1M到2M的提升，通过增加一个自由度，显著提高了微物理过程[参数化](@entry_id:265163)的物理保真度，特别是在涉及粒子尺寸演变和[气溶胶-云相互作用](@entry_id:1120855)方面 。

### 分档（谱）微物理方案

分档方案采取了一种与宏观方案完全不同的策略。它不假设PSD的函数形式，而是将粒子直径（或质量）轴划分为一系列离散的**尺寸箱（size bins）**。然后，模型为每个尺寸箱 $i$ 预报其所包含的粒子数浓度 $N_i$（有时也预报质量浓度 $M_i$） 。

PSD因此被表示为一个[直方图](@entry_id:178776)，其形状可以自由演变，由模型中显式计算的凝结增长、碰撞合并等物理过程驱动。这种方法避免了宏观方案中固有的闭合假设，从而提供了最高水平的物理保真度。

在分档方案中，粒子由于凝结/蒸发而生长或缩小，会导致粒子在尺寸箱之间“流动”。考虑仅有凝结增长的情况，其增长率在直径空间中为 $G(D) = dD/dt$。描述PSD演变的[连续性方程](@entry_id:195013)为：

$$
\frac{\partial n(D)}{\partial t} + \frac{\partial}{\partial D} [G(D) n(D)] = 0
$$

对第 $i$ 个箱 $[D_i^-, D_i^+]$ 积分，可得该箱内数浓度 $N_i$ 的变化率，这取决于[粒子流](@entry_id:753205)入和流出该箱边界的通量 ：

$$
\frac{\partial N_i}{\partial t} = G(D_i^-)n(D_i^-) - G(D_i^+)n(D_i^+) + \dots
$$

同样，箱内质量浓度的变化不仅包括边界的质量通量，还包括箱内粒子因自身长大而产生的“内部[质量生成](@entry_id:161427)项”。

#### 随机碰撞方程（SCE）

分档方案的核心优势之一是能够更直接地求解（或近似求解）描述碰撞-合并过程的**随机碰撞方程（Stochastic Collection Equation, SCE）** 。这个方程是描述粒子群因两两碰撞而演变的控制方程，其一般形式为：

$$
\frac{\partial n(D, t)}{\partial t} = \text{增益项} - \text{损失项}
$$

- **损失项**：描述直径为 $D$ 的粒子因与任何其他直径为 $D'$ 的[粒子碰撞](@entry_id:160531)而从该尺寸类别中被移除的速率。它正比于 $n(D,t)$ 与所有其他粒子的[碰撞积分](@entry_id:1122655)。

- **增益项**：描述由两个较小的粒子（$D'$ 和 $D''$）碰撞合并形成一个直径为 $D$ 的粒子的速率。由于体积是守恒的（$D^3 = D'^3 + D''^3$），而不是直径，因此增益项的数学形式较为复杂，通常涉及一个[雅可比行列式](@entry_id:137120)因子和一个狄拉克 $\delta$ 函数来强制[体积守恒](@entry_id:276587)。

完整的SCE（包括增益项和损失项）在直径空间可以写为：
$$
\frac{\partial n(D,t)}{\partial t} = \frac{3 D^{2}}{2} \int_{0}^{\infty}\! \int_{0}^{\infty} K(D',D'') n(D',t) n(D'',t) \delta\!(D^{3}-D'^{3}-D''^{3}) dD' dD'' - n(D,t) \int_{0}^{\infty} K(D,D') n(D',t) dD'
$$
其中 $K(D, D')$ 是**[碰撞核](@entry_id:1122656)函数**，它描述了直径为 $D$ 和 $D'$ 的粒子对的[碰撞频率](@entry_id:138992)。该核函数通常包括由重力沉降差异引起的**重力碰撞**[部分和](@entry_id:162077)由小尺度[湍流](@entry_id:151300)剪切引起的**[湍流](@entry_id:151300)碰撞**部分 。宏观方案中的自转换和碰并等[参数化](@entry_id:265163)，本质上是对SCE积分效应的高度简化的近似，而分档方案则通过在离散的箱之间计算质量和数量的转移来更直接地模拟这一过程。

### 计算与物理影响

选择不同的微物理方案不仅影响物理真实性，还直接关系到计算成本以及与模型其他部分的耦合。

#### 计算成本

三种方案的计算成本差异巨大 ：

- **宏观方案 (1M, 2M)**：每个[水凝物](@entry_id:1126277)类别只有少量（1或2个）预报变量。微物理过程（如自转换）的计算被简化为解析或查表公式，其计算成本与分档方案的箱数 $B$ 无关，是 $\mathcal{O}(1)$ 的。[双矩方案](@entry_id:1123945)比单矩方案成本略高，因为需要多求解一个[预报方程](@entry_id:1130221)。

- **分档方案**：预报变量的数量非常多（每个[水凝物](@entry_id:1126277)类别、每个箱都有1-2个变量），通常有几十个箱。计算成本随箱数 $B$ 的增加而显著增长。例如，凝结增长过程的计算量与箱数成正比，即 $\mathcal{O}(B)$。而碰撞-合并过程需要考虑所有箱对之间的相互作用，其朴素计算复杂度与箱数的平方成正比，即 $\mathcal{O}(B^2)$。因此，分档方案比宏观方案昂贵几个数量级。

#### 与热力和动力学的耦合

微物理过程通过相变释放或吸收潜热，从而强烈地影响大气的热力结构和动力学过程。

- **潜热加热**：水汽凝结、液水冻结和水汽凝华都会释放潜热，而相反的过程则吸收潜热。这个加热/冷却效应是驱动对流和大规模环流的关键能量来源。在温变方程中，由微物理引起的温度倾向项可以表示为 ：
  $$
  \left(\frac{\partial T}{\partial t}\right)_{\mathrm{mp}} = \frac{L_v S_c + L_f S_f + L_s S_d}{c_p}
  $$
  其中 $L_v, L_f, L_s$ 分别是蒸发、融化和[升华潜热](@entry_id:187184)，$S_c, S_f, S_d$ 是净凝结、净冻结和净凝华率。这个[热力学定律](@entry_id:202285)的形式对所有方案都是通用的；不同方案的区别在于它们如何计算这些相变率。潜热释放会加热空气，增加**[虚温](@entry_id:1133832)** $T_v$（$T_v \approx T(1 + 0.61q_v - q_l - q_i)$），从而增加[浮力](@entry_id:154088)，影响垂直运动和大气稳定度。

- **与过饱和度的耦合**：上升气流因[绝热膨胀](@entry_id:144584)而冷却，产生**[过饱和](@entry_id:200794)度** $S$。这个[过饱和](@entry_id:200794)度是驱动云滴凝结增长的“燃料”。云滴的凝结增长反过来又会消耗水汽，从而降低过饱和度。这个[负反馈回路](@entry_id:267222)的[响应时间](@entry_id:271485)，即**[过饱和](@entry_id:200794)度弛豫时间** $\tau$，取决于云滴群的特性 。[弛豫时间](@entry_id:191572) $\tau$ 反比于粒子群的总半径积分 $\int r n(r) dr$。对于给定的总液水含量 $q_c$ 和总数浓度 $n$，一个多分散的谱（如分档方案能解析的）比一个单分散的谱（宏观方案的简化假设）具有更长的弛豫时间。这意味着更真实的[谱分布](@entry_id:158779)会维持一个相对较高的过饱和度，这可能对后续的微物理过程产生重要影响。

#### 基本守恒定律

一个物理上自洽的微物理方案必须遵守基本的守恒定律 。

- **总水物质质量守恒**：在没有外部源汇（如平流或沉降）的情况下，仅考虑微物理相变和[类别转换](@entry_id:198322)时，总水物质（水汽+云水+雨水+...）的质量必须守恒。这意味着所有水物质类别倾向之和必须为零：$\sum S_{q_k} = 0$。

- **湿焓守恒**：为了保证能量守恒，微物理过程引起的温度变化必须与潜热变化精确平衡。在暖云中，这意味着湿焓 $h_m = c_p T + L_v q_v$ 在没有外部加热时应守恒，即 $c_p \frac{dT}{dt} + L_v \frac{dq_v}{dt} = 0$。不满足这个条件会导致虚假的能量源或汇，引起模式温度的长期漂移。

- **[水凝物](@entry_id:1126277)数浓度**：与质量和能量不同，**[水凝物](@entry_id:1126277)总数通常不守恒**。成核过程会产生新的粒子（增加数量），而碰撞-合并过程会使粒子数减少。滴/晶的破碎则会增加粒子数。因此，一个先进的微物理方案（如2M或分档方案）的目标不是去“守恒”粒子数，而是根据物理过程准确地计算出粒子数的**非守恒变化率**。这是理解2M和分档方案相对于1M方案的关键优势之一。

总之，从单矩、双矩到分档方案，我们看到一个在物理真实性和计算成本之间进行权衡的谱系。方案的选择取决于具体的应用场景，无论是追求长期气候模拟的效率，还是高分辨率天气预报中对降水过程的精细刻画。