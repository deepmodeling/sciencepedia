{
    "hands_on_practices": [
        {
            "introduction": "数据同化的核心任务是将模型预测（背景场）与新的观测资料进行最优融合。这个练习将引导您从第一性原理出发，推导数据同化更新中的关键组成部分——卡尔曼增益 $K$。通过完成这个推导并求解一个具体的数值算例 ，您将深入理解背景场误差协方差 $B$ 和观测误差协方差 $R$ 的相对大小如何决定分析增量，并最终确定分析结果的不确定性。",
            "id": "4015086",
            "problem": "考虑一个典型的数值天气预报(NWP)和气候模式分析中的线性高斯数据同化设定，其中一个二维状态向量 $\\mathbf{x} \\in \\mathbb{R}^{2}$ 表示两个子域上某个预报变量的空间平均异常。先验（背景）状态建模为 $\\mathbf{x} \\sim \\mathcal{N}(\\mathbf{x}_{b}, \\mathbf{B})$，其中 $\\mathbf{B}$ 是背景误差协方差。单个标量观测 $y$ 测量了两个子域异常的粗尺度总和，其观测算子为 $\\mathbf{H} \\in \\mathbb{R}^{1 \\times 2}$，观测误差为 $\\varepsilon \\sim \\mathcal{N}(0, R)$，因此有 $y = \\mathbf{H}\\mathbf{x} + \\varepsilon$。假设所有误差都是无量纲的。\n\n从线性高斯模型和贝叶斯定理出发，并且仅使用最小均方误差线性估计的定义，推导出最小化均方分析误差的最优线性分析更新表达式 $\\mathbf{x}_{a} = \\mathbf{x}_{b} + \\mathbf{K}\\left(y - \\mathbf{H}\\mathbf{x}_{b}\\right)$，其中 $\\mathbf{K}$ 是卡尔曼增益。然后，推导沿观测方向的分析误差方差，其定义为标量 $s_{a} = \\mathbf{H}\\mathbf{A}\\mathbf{H}^{T}$，其中 $\\mathbf{A}$ 是分析误差协方差。\n\n最后，对于以下具体的、物理上一致的情形\n$$\n\\mathbf{B} = \\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix}, \\quad \\mathbf{H} = \\begin{pmatrix} 1  1 \\end{pmatrix}, \\quad R = 0.5,\n$$\n计算卡尔曼增益向量 $\\mathbf{K} \\in \\mathbb{R}^{2}$ 和沿观测方向的分析方差 $s_{a} \\in \\mathbb{R}$。将最终数值精确地表示为无舍入的有理数。将最终答案报告为一个行矩阵，其中包含 $\\mathbf{K}$ 的两个分量，后跟 $s_{a}$。",
            "solution": "首先根据指定标准对问题进行验证。\n\n### 问题验证\n**步骤1：提取已知条件**\n- 状态向量：$\\mathbf{x} \\in \\mathbb{R}^{2}$。\n- 先验（背景）状态模型：$\\mathbf{x} \\sim \\mathcal{N}(\\mathbf{x}_{b}, \\mathbf{B})$，其中 $\\mathbf{B}$ 是背景误差协方差。\n- 观测模型：$y = \\mathbf{H}\\mathbf{x} + \\varepsilon$，其中 $y$ 是一个标量观测。\n- 观测算子：$\\mathbf{H} \\in \\mathbb{R}^{1 \\times 2}$。\n- 观测误差模型：$\\varepsilon \\sim \\mathcal{N}(0, R)$。\n- 分析更新形式：$\\mathbf{x}_{a} = \\mathbf{x}_{b} + \\mathbf{K}\\left(y - \\mathbf{H}\\mathbf{x}_{b}\\right)$，其中 $\\mathbf{K}$ 是卡尔曼增益。\n- 目标：找到最小化均方分析误差的最优线性估计 $\\mathbf{x}_{a}$。\n- 沿观测方向的分析误差方差定义：$s_{a} = \\mathbf{H}\\mathbf{A}\\mathbf{H}^{T}$，其中 $\\mathbf{A}$ 是分析误差协方差。\n- 具体情形的数值：\n$$\n\\mathbf{B} = \\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix}, \\quad \\mathbf{H} = \\begin{pmatrix} 1  1 \\end{pmatrix}, \\quad R = 0.5\n$$\n- 任务：推导最优卡尔曼增益 $\\mathbf{K}$ 和分析方差 $s_a$ 的表达式。然后计算它们在具体情形下的数值。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题是线性高斯数据同化中的一个标准练习，特别是寻找最佳线性无偏估计(BLUE)。概念（$\\mathbf{B}$、$\\mathbf{R}$、$\\mathbf{H}$、$\\mathbf{K}$）和更新方程是卡尔曼滤波和变分数据同化方法的基础，这些方法用于数值天气预报和其他地球物理科学。该问题在科学上是合理的。\n- **适定性**：问题是适定的。目标函数（均方误差）已定义，并且给定的矩阵和标量允许唯一解。背景误差协方差矩阵 $\\mathbf{B}$ 是对称正定的（特征值为 $2$ 和 $1$），观测误差方差 $R$ 是正的。这些条件保证了所需的矩阵逆存在且定义良好。\n- **客观性**：问题使用精确的数学语言陈述，没有歧义或主观性。\n- **完整性和一致性**：问题提供了所有必要的定义、数据和约束。所有矩阵和向量的维度都是一致的：$\\mathbf{H}$ ($1 \\times 2$)、$\\mathbf{x}$ ($2 \\times 1$)、$\\mathbf{B}$ ($2 \\times 2$)、$\\mathbf{K}$ ($2 \\times 1$)、$y$ (标量)、$R$ (标量)。没有矛盾。\n\n**步骤3：结论与行动**\n问题被判定为**有效**。将提供完整的解答。\n\n### 推导与求解\n\n#### 第1部分：最优卡尔曼增益 ($\\mathbf{K}$) 的推导\n\n目标是找到使均方分析误差最小化的卡尔曼增益矩阵 $\\mathbf{K}$。分析误差定义为 $\\mathbf{e}_{a} = \\mathbf{x}_{a} - \\mathbf{x}$，其中 $\\mathbf{x}$ 是真实状态向量。\n\n代入分析状态 $\\mathbf{x}_{a}$ 的表达式：\n$$\n\\mathbf{e}_{a} = \\left(\\mathbf{x}_{b} + \\mathbf{K}(y - \\mathbf{H}\\mathbf{x}_{b})\\right) - \\mathbf{x}\n$$\n现在，代入观测模型 $y = \\mathbf{H}\\mathbf{x} + \\varepsilon$：\n$$\n\\mathbf{e}_{a} = \\mathbf{x}_{b} + \\mathbf{K}(\\mathbf{H}\\mathbf{x} + \\varepsilon - \\mathbf{H}\\mathbf{x}_{b}) - \\mathbf{x}\n$$\n通过定义背景误差 $\\mathbf{e}_{b} = \\mathbf{x}_{b} - \\mathbf{x}$ 来重新整理各项：\n$$\n\\mathbf{e}_{a} = (\\mathbf{x}_{b} - \\mathbf{x}) - \\mathbf{K}(\\mathbf{H}\\mathbf{x}_{b} - \\mathbf{H}\\mathbf{x} - \\varepsilon) = \\mathbf{e}_{b} - \\mathbf{K}(\\mathbf{H}(\\mathbf{x}_{b} - \\mathbf{x}) - \\varepsilon) = \\mathbf{e}_{b} - \\mathbf{K}(\\mathbf{H}\\mathbf{e}_{b} - \\varepsilon)\n$$\n这给出了以背景误差和观测误差表示的分析误差：\n$$\n\\mathbf{e}_{a} = (\\mathbf{I} - \\mathbf{K}\\mathbf{H})\\mathbf{e}_{b} + \\mathbf{K}\\varepsilon\n$$\n分析误差协方差矩阵 $\\mathbf{A}$ 是分析误差与其自身外积的期望值：$\\mathbf{A} = E[\\mathbf{e}_{a}\\mathbf{e}_{a}^T]$。\n$$\n\\mathbf{A} = E\\left[ ((\\mathbf{I} - \\mathbf{K}\\mathbf{H})\\mathbf{e}_{b} + \\mathbf{K}\\varepsilon) ((\\mathbf{I} - \\mathbf{K}\\mathbf{H})\\mathbf{e}_{b} + \\mathbf{K}\\varepsilon)^T \\right]\n$$\n展开此式并取期望，我们使用背景误差和观测误差不相关 ($E[\\mathbf{e}_{b}\\varepsilon^T] = \\mathbf{0}$)、$E[\\mathbf{e}_{b}\\mathbf{e}_{b}^T] = \\mathbf{B}$ 以及 $E[\\varepsilon\\varepsilon^T] = E[\\varepsilon^2] = R$ 这些事实。\n$$\n\\mathbf{A} = (\\mathbf{I} - \\mathbf{K}\\mathbf{H}) E[\\mathbf{e}_{b}\\mathbf{e}_{b}^T] (\\mathbf{I} - \\mathbf{K}\\mathbf{H})^T + \\mathbf{K} E[\\varepsilon\\varepsilon^T] \\mathbf{K}^T\n$$\n$$\n\\mathbf{A} = (\\mathbf{I} - \\mathbf{K}\\mathbf{H}) \\mathbf{B} (\\mathbf{I} - \\mathbf{H}^T\\mathbf{K}^T) + \\mathbf{K}R\\mathbf{K}^T\n$$\n进一步展开，并使用 $\\mathbf{B} = \\mathbf{B}^T$：\n$$\n\\mathbf{A} = \\mathbf{B} - \\mathbf{K}\\mathbf{H}\\mathbf{B} - \\mathbf{B}\\mathbf{H}^T\\mathbf{K}^T + \\mathbf{K}\\mathbf{H}\\mathbf{B}\\mathbf{H}^T\\mathbf{K}^T + \\mathbf{K}R\\mathbf{K}^T\n$$\n$$\n\\mathbf{A} = \\mathbf{B} - \\mathbf{K}\\mathbf{H}\\mathbf{B} - \\mathbf{B}\\mathbf{H}^T\\mathbf{K}^T + \\mathbf{K}(\\mathbf{H}\\mathbf{B}\\mathbf{H}^T + R)\\mathbf{K}^T\n$$\n均方误差是 $\\mathbf{A}$ 的迹，$J(\\mathbf{K}) = \\text{Tr}(\\mathbf{A})$。为求最小值，我们将 $J(\\mathbf{K})$ 对 $\\mathbf{K}$ 求导并令结果为零。使用标准矩阵微积分恒等式：\n$$\n\\frac{\\partial J}{\\partial \\mathbf{K}} = \\frac{\\partial}{\\partial \\mathbf{K}} \\text{Tr}(\\mathbf{A}) = -2\\mathbf{B}\\mathbf{H}^T + 2\\mathbf{K}(\\mathbf{H}\\mathbf{B}\\mathbf{H}^T + R) = 0\n$$\n$$\n-2\\mathbf{B}\\mathbf{H}^T + 2\\mathbf{K}(\\mathbf{H}\\mathbf{B}\\mathbf{H}^T + R) = \\mathbf{0}\n$$\n求解 $\\mathbf{K}$：\n$$\n\\mathbf{K}(\\mathbf{H}\\mathbf{B}\\mathbf{H}^T + R) = \\mathbf{B}\\mathbf{H}^T\n$$\n项 $(\\mathbf{H}\\mathbf{B}\\mathbf{H}^T + R)$ 是一个标量（新息协方差），由于 $\\mathbf{B}$ 是正定的且 $R > 0$，因此它是可逆的。所以，最优卡尔曼增益为：\n$$\n\\mathbf{K} = \\mathbf{B}\\mathbf{H}^T(\\mathbf{H}\\mathbf{B}\\mathbf{H}^T + R)^{-1}\n$$\n\n#### 第2部分：分析方差 ($s_a$) 的推导\n\n我们需要计算 $s_{a} = \\mathbf{H}\\mathbf{A}\\mathbf{H}^T$。我们首先将最优 $\\mathbf{K}$ 代回到 $\\mathbf{A}$ 的表达式中，以找到 $\\mathbf{A}$ 的简化形式。一个方便的形式是 $\\mathbf{A} = (\\mathbf{I} - \\mathbf{K}\\mathbf{H})\\mathbf{B}$。\n$$\n\\mathbf{A} = \\mathbf{B} - \\mathbf{K}\\mathbf{H}\\mathbf{B}\n$$\n现在我们计算 $s_a$：\n$$\ns_a = \\mathbf{H}\\mathbf{A}\\mathbf{H}^T = \\mathbf{H}(\\mathbf{B} - \\mathbf{K}\\mathbf{H}\\mathbf{B})\\mathbf{H}^T = \\mathbf{H}\\mathbf{B}\\mathbf{H}^T - \\mathbf{H}\\mathbf{K}\\mathbf{H}\\mathbf{B}\\mathbf{H}^T\n$$\n让我们计算项 $\\mathbf{H}\\mathbf{K}$。根据 $\\mathbf{K}$ 的表达式：\n$$\n\\mathbf{H}\\mathbf{K} = \\mathbf{H} \\left( \\mathbf{B}\\mathbf{H}^T(\\mathbf{H}\\mathbf{B}\\mathbf{H}^T + R)^{-1} \\right) = (\\mathbf{H}\\mathbf{B}\\mathbf{H}^T)(\\mathbf{H}\\mathbf{B}\\mathbf{H}^T + R)^{-1}\n$$\n将此代回到 $s_a$ 的表达式中：\n$$\ns_a = \\mathbf{H}\\mathbf{B}\\mathbf{H}^T - (\\mathbf{H}\\mathbf{B}\\mathbf{H}^T)(\\mathbf{H}\\mathbf{B}\\mathbf{H}^T + R)^{-1} (\\mathbf{H}\\mathbf{B}\\mathbf{H}^T)\n$$\n令 $S_b = \\mathbf{H}\\mathbf{B}\\mathbf{H}^T$ 为观测空间中的背景方差。那么 $S = S_b + R$ 是新息协方差。表达式简化为：\n$$\ns_a = S_b - S_b (S_b + R)^{-1} S_b = S_b \\left(1 - \\frac{S_b}{S_b+R}\\right) = S_b \\left(\\frac{S_b+R-S_b}{S_b+R}\\right) = \\frac{S_b R}{S_b+R}\n$$\n因此，沿观测方向的分析方差为：\n$$\ns_a = \\frac{(\\mathbf{H}\\mathbf{B}\\mathbf{H}^T) R}{\\mathbf{H}\\mathbf{B}\\mathbf{H}^T + R}\n$$\n\n#### 第3部分：数值计算\n\n给定具体数值：\n$$\n\\mathbf{B} = \\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix}, \\quad \\mathbf{H} = \\begin{pmatrix} 1  1 \\end{pmatrix}, \\quad R = 0.5 = \\frac{1}{2}\n$$\n首先，计算 $\\mathbf{K}$ 所需的分量。\n$\\mathbf{H}$ 的转置是 $\\mathbf{H}^T = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n项 $\\mathbf{B}\\mathbf{H}^T$ 为：\n$$\n\\mathbf{B}\\mathbf{H}^T = \\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 2 \\cdot 1 + 0 \\cdot 1 \\\\ 0 \\cdot 1 + 1 \\cdot 1 \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix}\n$$\n标量项 $\\mathbf{H}\\mathbf{B}\\mathbf{H}^T$ 为：\n$$\n\\mathbf{H}\\mathbf{B}\\mathbf{H}^T = \\mathbf{H}(\\mathbf{B}\\mathbf{H}^T) = \\begin{pmatrix} 1  1 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} = 1 \\cdot 2 + 1 \\cdot 1 = 3\n$$\n新息协方差为 $\\mathbf{H}\\mathbf{B}\\mathbf{H}^T + R$：\n$$\n3 + \\frac{1}{2} = \\frac{7}{2}\n$$\n其逆为 $(\\frac{7}{2})^{-1} = \\frac{2}{7}$。\n现在，计算卡尔曼增益 $\\mathbf{K}$：\n$$\n\\mathbf{K} = (\\mathbf{B}\\mathbf{H}^T)(\\mathbf{H}\\mathbf{B}\\mathbf{H}^T + R)^{-1} = \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix} \\left(\\frac{2}{7}\\right) = \\begin{pmatrix} 4/7 \\\\ 2/7 \\end{pmatrix}\n$$\n接下来，使用推导出的公式计算分析方差 $s_a$：\n$$\ns_a = \\frac{(\\mathbf{H}\\mathbf{B}\\mathbf{H}^T) R}{\\mathbf{H}\\mathbf{B}\\mathbf{H}^T + R} = \\frac{3 \\cdot \\frac{1}{2}}{3 + \\frac{1}{2}} = \\frac{\\frac{3}{2}}{\\frac{7}{2}} = \\frac{3}{7}\n$$\n要求的输出是一个行矩阵，其中包含 $\\mathbf{K}$ 的两个分量，后跟 $s_a$。\n$\\mathbf{K}$ 的分量是 $K_1 = 4/7$ 和 $K_2 = 2/7$。\n$s_a$ 的值是 $3/7$。\n最终结果是行矩阵 $(4/7, 2/7, 3/7)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{4}{7}  \\frac{2}{7}  \\frac{3}{7}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在生成分析场之后，我们如何评估其表现是否符合预期？为此，我们需要有效的诊断工具。本练习  介绍了两个关键的诊断量：信号自由度（DFS），它量化了观测对分析的影响程度；以及卡方（$\\chi^2$）统计量，它用于检验分析残差的统计一致性。通过推导和计算这些量，您将学会如何利用 $B$ 和 $R$ 的理论属性来构建强大的实用工具，以监控和调整数据同化系统的性能。",
            "id": "4015037",
            "problem": "考虑一个一维、线性、高斯的数据同化设置，这是数值天气预报中的典型情况。设真实状态表示为 $x$，背景（先验）为 $x_b = x + \\xi$，其背景误差 $\\xi \\sim \\mathcal{N}(0, B)$，观测为 $y = H x + \\eta$，其观测误差 $\\eta \\sim \\mathcal{N}(0, R)$。假设 $\\xi$ 和 $\\eta$ 是独立的、无偏的、且服从高斯分布。分析（后验）$x_a$ 定义为二次代价函数的最小化子\n$$\nJ(x) = \\frac{1}{2} (x - x_b)^T B^{-1} (x - x_b) + \\frac{1}{2} (y - H x)^T R^{-1} (y - H x),\n$$\n其中 $B$、$R$ 和 $H$ 为给定值，且所有量均为标量。\n\n仅使用上述定义和线性高斯假设，推导最优分析 $x_a$、卡尔曼增益 $K$ 以及分析误差方差 $A$。然后，利用观测对分析的影响，定义信号自由度（DFS），并用 $B$、$R$ 和 $H$ 表示。接下来，将分析时刻的观测空间残差的卡方统计量定义为\n$$\n\\chi^2 \\equiv \\mathbb{E}\\big[(y - H x_a)^T R^{-1} (y - H x_a)\\big],\n$$\n其中期望是关于 $\\xi$ 和 $\\eta$ 的联合分布计算的，并将其用 $B$、$R$ 和 $H$ 表示。\n\n最后，对于 $B = 4$、$R = 1$ 和 $H = 1$ 的具体情况，计算 DFS 和 $\\chi^2$ 的值，并检验这些量与观测数量 $p$ 之间的一致性关系是否成立。在此标量设置中，取观测数量为 $p = 1$。按顺序将 DFS 和 $\\chi^2$ 的最终数值以行矩阵的形式报告。这些量是无量纲的；不需要单位。请给出精确的最终答案，不要四舍五入。",
            "solution": "该问题陈述是数据同化领域一个标准的、适定的问题，具体涉及一维变分分析（3D-Var）的推导和性质。所有术语都定义清晰，具有科学依据，且问题是自洽的、数学上一致的。因此，该问题被认为是有效的，并将提供解答。\n\n分析状态 $x_a$ 是使代价函数 $J(x)$ 最小化的 $x$ 的值。对于给定的标量情况，代价函数为：\n$$\nJ(x) = \\frac{1}{2} (x - x_b)^2 B^{-1} + \\frac{1}{2} (y - H x)^2 R^{-1}\n$$\n为了找到最小值，我们计算 $J(x)$ 对 $x$ 的导数，并令其为零：\n$$\n\\frac{dJ}{dx} = B^{-1}(x - x_b) + R^{-1}(y - Hx)(-H) = 0\n$$\n设 $x_a$ 是满足此方程的 $x$ 的值：\n$$\nB^{-1}(x_a - x_b) - H R^{-1}(y - Hx_a) = 0\n$$\n$$\nB^{-1}x_a - B^{-1}x_b - H R^{-1}y + H^2 R^{-1}x_a = 0\n$$\n合并含有 $x_a$ 的项：\n$$\nx_a(B^{-1} + H^2 R^{-1}) = x_b B^{-1} + y H R^{-1}\n$$\n求解 $x_a$：\n$$\nx_a = (B^{-1} + H^2 R^{-1})^{-1} (x_b B^{-1} + y H R^{-1})\n$$\n这个表达式可以重排成标准更新形式 $x_a = x_b + K(y - Hx_b)$，其中 $K$ 是卡尔曼增益。\n$$\nx_a = \\left(\\frac{1}{B} + \\frac{H^2}{R}\\right)^{-1} \\left(\\frac{x_b}{B} + \\frac{yH}{R}\\right) = \\left(\\frac{R + BH^2}{BR}\\right)^{-1} \\left(\\frac{Rx_b + BHy}{BR}\\right) = \\frac{BR}{R+BH^2} \\frac{Rx_b + BHy}{BR} = \\frac{Rx_b + BHy}{R+BH^2}\n$$\n为了求出 $K$，我们将 $x_a$ 重写为：\n$$\nx_a = \\frac{R}{R+BH^2}x_b + \\frac{BH}{R+BH^2}y\n$$\n$$\nx_a = \\frac{R+BH^2 - BH^2}{R+BH^2}x_b + \\frac{BH}{R+BH^2}y = \\left(1 - \\frac{BH^2}{R+BH^2}\\right)x_b + \\frac{BH}{R+BH^2}y\n$$\n$$\nx_a = x_b - \\frac{BH^2}{R+BH^2}x_b + \\frac{BH}{R+BH^2}y = x_b + \\frac{BH}{R+BH^2}(y - Hx_b)\n$$\n将其与 $x_a = x_b + K(y - Hx_b)$ 比较，我们确定卡尔曼增益 $K$为：\n$$\nK = \\frac{BH}{R+BH^2}\n$$\n分析误差为 $\\epsilon_a = x_a - x$。我们代入 $x_b = x + \\xi$ 和 $y = Hx + \\eta$ 的表达式：\n$$\nx_a - x = (x_b + K(y - Hx_b)) - x = (x+\\xi) + K(Hx+\\eta - H(x+\\xi)) - x = \\xi + K(\\eta - H\\xi)\n$$\n$$\nx_a - x = (1 - KH)\\xi + K\\eta\n$$\n分析误差方差 $A$ 是分析误差平方的期望值，$A = \\mathbb{E}[(x_a - x)^2]$。由于 $\\xi$ 和 $\\eta$ 是独立的且均值为零，它们的互相关为零。\n$$\nA = \\mathbb{E}[((1-KH)\\xi + K\\eta)^2] = (1-KH)^2\\mathbb{E}[\\xi^2] + K^2\\mathbb{E}[\\eta^2] = (1-KH)^2 B + K^2 R\n$$\n我们计算 $(1 - KH)$ 这一项：\n$$\n1-KH = 1 - \\frac{BH}{R+BH^2}H = 1 - \\frac{BH^2}{R+BH^2} = \\frac{R+BH^2-BH^2}{R+BH^2} = \\frac{R}{R+BH^2}\n$$\n将此代入 $A$ 的表达式中：\n$$\nA = \\left(\\frac{R}{R+BH^2}\\right)^2 B + \\left(\\frac{BH}{R+BH^2}\\right)^2 R = \\frac{R^2B + B^2H^2R}{(R+BH^2)^2} = \\frac{RB(R+BH^2)}{(R+BH^2)^2} = \\frac{RB}{R+BH^2}\n$$\n或者，$A = (1-KH)B = \\frac{R}{R+BH^2}B$。这是一个关于分析误差方差的著名恒等式。\n\n信号自由度（DFS）衡量观测对分析的影响。它定义为观测空间中的分析（$Hx_a$）对观测（$y$）的矩阵导数的迹。\n$$\nDFS = \\text{tr}\\left(\\frac{\\partial (Hx_a)}{\\partial y}\\right)\n$$\n从 $x_a = (1-KH)x_b + Ky$ 可得 $\\frac{\\partial x_a}{\\partial y} = K$。\n因此，$\\frac{\\partial (Hx_a)}{\\partial y} = HK$。在标量情况下，迹就是其值本身。\n$$\nDFS = HK = H \\left(\\frac{BH}{R+BH^2}\\right) = \\frac{BH^2}{R+BH^2}\n$$\n接下来，我们计算分析时刻的观测空间残差的卡方统计量，定义为 $\\chi^2 \\equiv \\mathbb{E}\\big[(y - H x_a)^T R^{-1} (y - H x_a)\\big]$。其标量形式为：\n$$\n\\chi^2 = R^{-1} \\mathbb{E}[(y - Hx_a)^2]\n$$\n项 $y-Hx_a$ 是分析残差。我们可以用新息（innovation）$d = y - Hx_b$ 来表示它。\n$$\ny - Hx_a = y - H(x_b + K(y-Hx_b)) = (y - Hx_b) - HK(y - Hx_b) = (1-HK)(y-Hx_b)\n$$\n现在，用基本误差项表示新息：\n$$\ny - Hx_b = (Hx + \\eta) - H(x + \\xi) = \\eta - H\\xi\n$$\n新息的期望方差是 $\\mathbb{E}[(\\eta - H\\xi)^2] = \\mathbb{E}[\\eta^2] - 2H\\mathbb{E}[\\eta\\xi] + H^2\\mathbb{E}[\\xi^2] = R + H^2B$。\n分析残差的期望方差是：\n$$\n\\mathbb{E}[(y - Hx_a)^2] = \\mathbb{E}[((1-HK)(\\eta - H\\xi))^2] = (1-HK)^2 \\mathbb{E}[(\\eta - H\\xi)^2] = (1-HK)^2(R+H^2B)\n$$\n代入 $1-KH = \\frac{R}{R+BH^2}$：\n$$\n\\mathbb{E}[(y - Hx_a)^2] = \\left(\\frac{R}{R+BH^2}\\right)^2(R+BH^2) = \\frac{R^2}{R+BH^2}\n$$\n最后，我们计算 $\\chi^2$：\n$$\n\\chi^2 = R^{-1} \\left(\\frac{R^2}{R+BH^2}\\right) = \\frac{R}{R+BH^2}\n$$\n一致性关系涉及 DFS 和 $\\chi^2$ 的和。\n$$\nDFS + \\chi^2 = \\frac{BH^2}{R+BH^2} + \\frac{R}{R+BH^2} = \\frac{R+BH^2}{R+BH^2} = 1\n$$\n问题陈述观测数量为 $p=1$。因此，对于此标量情况，一致性关系 $DFS + \\chi^2 = p$ 成立。\n\n最后，我们针对给定值 $B=4$、$R=1$ 和 $H=1$ 计算 DFS 和 $\\chi^2$。\n$$\nDFS = \\frac{BH^2}{R+BH^2} = \\frac{4 \\cdot 1^2}{1 + 4 \\cdot 1^2} = \\frac{4}{5}\n$$\n$$\n\\chi^2 = \\frac{R}{R+BH^2} = \\frac{1}{1 + 4 \\cdot 1^2} = \\frac{1}{5}\n$$\n最终答案要求按顺序将 DFS 和 $\\chi^2$ 的数值以行矩阵的形式报告。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{4}{5}  \\frac{1}{5} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "数据同化系统的质量取决于我们对其误差统计特性的假设。如果这些假设是错误的，会发生什么？本练习  探讨了一个关键问题：当观测误差实际上存在相关性，而我们却错误地假设它们不相关时，会对分析结果产生何种影响。通过量化分析方差的计算偏差，您将对信息量、信息冗余以及产生“过度自信”分析的风险建立起深刻的直觉——这种分析结果的置信度被高估，其实际精度远低于理论估计。",
            "id": "4015027",
            "problem": "在一个与数值天气预报（NWP）和气候再分析相关的一维同化设置中，考虑一个在给定有效时间的标量大气状态变量 $x$。$x$ 的背景（先验）是均值为 $x_b$、方差为 $B>0$ 的高斯分布，即 $x \\sim \\mathcal{N}(x_b, B)$。在时间 $t_1$ 和 $t_2$ 有两个对同一有效时间状态 $x$ 的观测，模型如下：\n$$\ny_1 = x + \\varepsilon_1, \\qquad y_2 = x + \\varepsilon_2,\n$$\n其中 $(\\varepsilon_1, \\varepsilon_2)$ 是一个零均值的二元高斯观测误差向量，其方差为 $\\operatorname{Var}(\\varepsilon_1)=\\operatorname{Var}(\\varepsilon_2)=R>0$，相关系数为 $\\rho \\in (-1,1)$，因此真实的观测误差协方差矩阵是\n$$\n\\mathbf{R}_{\\text{true}} = R \\begin{pmatrix} 1  \\rho \\\\ \\rho  1 \\end{pmatrix}.\n$$\n然而，一位分析员错误地假设观测误差是时间白噪声（即在时间上不相关），因此使用了错误指定的协方差\n$$\n\\mathbf{R}_{\\text{assumed}} = R \\mathbf{I}_2.\n$$\n\n使用线性高斯模型的贝叶斯推断的基本原理，解决以下问题。\n\n1) 从信息内容和有效独立信息量的角度解释，为什么当 $\\rho>0$ 时使用 $\\mathbf{R}_{\\text{assumed}}$ 会导致过分自信的分析，即在独立性假设下计算的后验方差小于正确考虑真实相关性时获得的后验方差。\n\n2) 令 $a \\equiv B/R$ 表示背景方差与观测方差之比。推导该比率的闭式解析表达式\n$$\nU(a,\\rho) \\equiv \\frac{\\text{在 } \\mathbf{R}_{\\text{assumed}} \\text{ 下计算的后验方差}}{\\text{在 } \\mathbf{R}_{\\text{true}} \\text{ 下计算的后验方差}},\n$$\n仅用 $a$ 和 $\\rho$ 表示，并尽可能简化。\n\n将 $U(a,\\rho)$ 的简化解析表达式作为你的最终答案。不需要进行数值评估，也不需要四舍五入。最终答案是无量纲的，报告时无需单位。",
            "solution": "该问题是有效的，因为它在科学上基于贝叶斯统计估计理论，问题设置良好，信息充分且一致，陈述客观。我们将进行完整的推导。\n\n这个问题的核心在于线性高斯设置中后验（或分析）方差的贝叶斯公式。对于一个先验（背景）分布为 $\\mathcal{N}(x_b, B)$ 的标量状态变量 $x$，以及一个通过线性观测算子 $\\mathbf{H}$ 与状态相关的观测向量 $\\mathbf{y}$，其高斯误差为 $\\boldsymbol{\\varepsilon} \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{R})$，后验方差（我们记为 $V_a$）由精度（方差的倒数）的更新公式给出：\n$$\nV_a^{-1} = B^{-1} + \\mathbf{H}^T \\mathbf{R}^{-1} \\mathbf{H}\n$$\n这里，$B^{-1}$ 是背景精度，而项 $\\mathbf{H}^T \\mathbf{R}^{-1} \\mathbf{H}$ 代表由观测贡献的信息（精度）。在我们的具体问题中，我们有两个观测值，$y_1 = x + \\varepsilon_1$ 和 $y_2 = x + \\varepsilon_2$。这意味着观测向量是 $\\mathbf{y} = \\begin{pmatrix} y_1 \\\\ y_2 \\end{pmatrix}$，而将标量状态 $x$ 映射到观测空间的观测算子是 $\\mathbf{H} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。因此，其转置是 $\\mathbf{H}^T = \\begin{pmatrix} 1  1 \\end{pmatrix}$。\n\n我们将根据观测误差协方差矩阵 $\\mathbf{R}$ 的两种不同假设来计算后验方差：错误指定的 $\\mathbf{R}_{\\text{assumed}}$ 和正确的 $\\mathbf{R}_{\\text{true}}$。\n\n我们首先在观测误差不相关的错误假设下计算后验方差 $V_{a, \\text{assumed}}$。假设的协方差矩阵是 $\\mathbf{R}_{\\text{assumed}} = R \\mathbf{I}_2 = \\begin{pmatrix} R  0 \\\\ 0  R \\end{pmatrix}$。其逆矩阵是：\n$$\n\\mathbf{R}_{\\text{assumed}}^{-1} = \\frac{1}{R} \\mathbf{I}_2 = \\begin{pmatrix} 1/R  0 \\\\ 0  1/R \\end{pmatrix}\n$$\n来自观测的信息是：\n$$\n\\mathbf{H}^T \\mathbf{R}_{\\text{assumed}}^{-1} \\mathbf{H} = \\begin{pmatrix} 1  1 \\end{pmatrix} \\begin{pmatrix} 1/R  0 \\\\ 0  1/R \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1/R  1/R \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\frac{1}{R} + \\frac{1}{R} = \\frac{2}{R}\n$$\n那么后验精度是 $ (V_{a, \\text{assumed}})^{-1} = B^{-1} + \\frac{2}{R} $。\n\n接下来，我们计算使用真实观测误差协方差矩阵时的后验方差 $V_{a, \\text{true}}$。真实的协方差矩阵是 $\\mathbf{R}_{\\text{true}} = R \\begin{pmatrix} 1  \\rho \\\\ \\rho  1 \\end{pmatrix}$。其逆矩阵计算如下：\n$$\n\\mathbf{R}_{\\text{true}}^{-1} = \\frac{1}{\\det(\\mathbf{R}_{\\text{true}})} \\begin{pmatrix} R  -R\\rho \\\\ -R\\rho  R \\end{pmatrix} = \\frac{1}{R^2(1-\\rho^2)} \\begin{pmatrix} R  -R\\rho \\\\ -R\\rho  R \\end{pmatrix} = \\frac{1}{R(1-\\rho^2)} \\begin{pmatrix} 1  -\\rho \\\\ -\\rho  1 \\end{pmatrix}\n$$\n来自观测的真实信息是：\n$$\n\\mathbf{H}^T \\mathbf{R}_{\\text{true}}^{-1} \\mathbf{H} = \\begin{pmatrix} 1  1 \\end{pmatrix} \\left( \\frac{1}{R(1-\\rho^2)} \\begin{pmatrix} 1  -\\rho \\\\ -\\rho  1 \\end{pmatrix} \\right) \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\n$$\n= \\frac{1}{R(1-\\rho^2)} \\begin{pmatrix} 1-\\rho  1-\\rho \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\frac{1}{R(1-\\rho^2)} (1-\\rho + 1-\\rho) = \\frac{2(1-\\rho)}{R(1-\\rho^2)}\n$$\n由于 $1-\\rho^2 = (1-\\rho)(1+\\rho)$，这可以简化为：\n$$\n\\mathbf{H}^T \\mathbf{R}_{\\text{true}}^{-1} \\mathbf{H} = \\frac{2(1-\\rho)}{R(1-\\rho)(1+\\rho)} = \\frac{2}{R(1+\\rho)}\n$$\n真实的后验精度是 $ (V_{a, \\text{true}})^{-1} = B^{-1} + \\frac{2}{R(1+\\rho)} $。\n\n1) 对 $\\rho > 0$ 时过分自信的解释：\n\n过分自信意味着计算出的后验方差小于真实的后验方差，即 $V_{a, \\text{assumed}}  V_{a, \\text{true}}$。这等价于证明假设的后验精度大于真实的后验精度，即 $(V_{a, \\text{assumed}})^{-1} > (V_{a, \\text{true}})^{-1}$。\n\n在独立性假设下，来自观测的信息内容是 $2/R$。真实的信息内容是 $2/(R(1+\\rho))$。\n当相关性为正（$\\rho > 0$）时，我们有 $1+\\rho > 1$，这意味着 $R(1+\\rho) > R$。取倒数并乘以 $2$ 会反转不等号：\n$$\n\\frac{2}{R(1+\\rho)}  \\frac{2}{R}\n$$\n这个不等式表明，分析员由于错误地假设误差是独立的，从而高估了观测所提供的信息量。两个观测值（$y_1, y_2$）并非独立；由于正相关性，它们携带了冗余信息。分析员实际上“重复计算”了两者共有的信息。项 $1/(1+\\rho)  1$ 充当了对来自第二个观测的信息的折扣因子，从而正确地解释了这种冗余。有效独立观测的数量是 $2/(1+\\rho)$，对于 $\\rho > 0$ 来说，这个值小于 $2$。\n\n通过高估来自观测的信息内容，总的后验精度也被高估了：\n$$\n(V_{a, \\text{assumed}})^{-1} = B^{-1} + \\frac{2}{R} > B^{-1} + \\frac{2}{R(1+\\rho)} = (V_{a, \\text{true}})^{-1}\n$$\n由于后验方差是后验精度的倒数，这种对精度的过高估计导致了对方差的过低估计：$V_{a, \\text{assumed}}  V_{a, \\text{true}}$。这就是“过分自信”的数学基础：分析模型认为其估计比实际情况更确定（具有更小的误差方差）。\n\n2) 比率 $U(a, \\rho)$ 的推导：\n\n该比率定义为 $U(a,\\rho) = V_{a, \\text{assumed}} / V_{a, \\text{true}}$。在代数上，将其表示为相应逆方差（精度）的比率会更简单：\n$$\nU(a,\\rho) = \\frac{V_{a, \\text{assumed}}}{V_{a, \\text{true}}} = \\frac{(V_{a, \\text{true}})^{-1}}{(V_{a, \\text{assumed}})^{-1}}\n$$\n代入前面推导出的表达式：\n$$\nU(a,\\rho) = \\frac{B^{-1} + \\frac{2}{R(1+\\rho)}}{B^{-1} + \\frac{2}{R}}\n$$\n现在，我们引入定义的比率 $a = B/R$，这意味着 $B^{-1} = 1/B = 1/(aR)$。\n$$\nU(a,\\rho) = \\frac{\\frac{1}{aR} + \\frac{2}{R(1+\\rho)}}{\\frac{1}{aR} + \\frac{2}{R}}\n$$\n我们可以从分子和分母中提出因子 $1/R$，然后它们会相消：\n$$\nU(a,\\rho) = \\frac{\\frac{1}{a} + \\frac{2}{1+\\rho}}{\\frac{1}{a} + 2}\n$$\n为了简化这个复合分数，我们为主分数的分子和分母中的项找到一个公分母。\n分子：$\\frac{1}{a} + \\frac{2}{1+\\rho} = \\frac{1+\\rho+2a}{a(1+\\rho)}$\n分母：$\\frac{1}{a} + 2 = \\frac{1+2a}{a}$\n因此，该比率变为：\n$$\nU(a,\\rho) = \\frac{\\frac{1+\\rho+2a}{a(1+\\rho)}}{\\frac{1+2a}{a}} = \\frac{1+\\rho+2a}{a(1+\\rho)} \\cdot \\frac{a}{1+2a}\n$$\n因子 $a$ 消去，得到简化后的表达式：\n$$\nU(a,\\rho) = \\frac{1+2a+\\rho}{(1+2a)(1+\\rho)}\n$$\n展开分母得到所求的最终形式：\n$$\nU(a,\\rho) = \\frac{1+2a+\\rho}{1+2a+\\rho+2a\\rho}\n$$\n这个表达式已尽可能简化，并且仅用 $a$ 和 $\\rho$ 表示。\n作为检验，对于 $\\rho > 0$ 和 $a > 0$，分母大于分子，因此 $U(a,\\rho)  1$，这证实了第1部分中建立的过分自信（$V_{a, \\text{assumed}}  V_{a, \\text{true}}$）。",
            "answer": "$$\\boxed{\\frac{1 + 2a + \\rho}{1 + 2a + \\rho + 2a\\rho}}$$"
        }
    ]
}