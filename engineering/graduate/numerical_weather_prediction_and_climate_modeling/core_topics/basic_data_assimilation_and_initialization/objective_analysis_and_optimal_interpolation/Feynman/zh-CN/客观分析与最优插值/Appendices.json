{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握最优插值（OI），我们必须从其数学基础入手。本练习将引导您从第一性原理出发，推导最优增益矩阵，并证明该方法的一个核心特性——分析误差方差的降低。这是构建整个理论体系的基石。",
            "id": "4070587",
            "problem": "考虑在最优插值 (OI) 中使用的线性、无偏数据同化设置，即在高斯、独立误差条件下的最佳线性无偏估计 (BLUE)。设真实状态为 $x \\in \\mathbb{R}^{n}$，背景场 (先验) 为 $x_{b} = x + e_{b}$，其背景场误差 $e_{b}$ 满足 $\\mathbb{E}[e_{b}] = 0$ 和 $\\operatorname{Cov}(e_{b}) = B \\in \\mathbb{R}^{n \\times n}$。观测为 $y = H x + \\epsilon$，其线性观测算子为 $H \\in \\mathbb{R}^{m \\times n}$，观测误差 $\\epsilon$ 满足 $\\mathbb{E}[\\epsilon] = 0$ 和 $\\operatorname{Cov}(\\epsilon) = R \\in \\mathbb{R}^{m \\times m}$，且 $\\operatorname{Cov}(e_{b}, \\epsilon) = 0$。OI 分析由线性估计量 $x_{a} = x_{b} + K \\left(y - H x_{b}\\right)$ 定义，其中 $K \\in \\mathbb{R}^{n \\times m}$ 是一个增益，通过在无偏性约束下最小化分析误差方差来确定。\n\n仅从这些原则出发，完成以下任务：\n\n- 推导分析误差协方差矩阵 $A = \\operatorname{Cov}(x - x_{a})$，用 $K$、$H$、$B$ 和 $R$ 表示，并确定在最小化 $\\operatorname{tr}(A)$ 意义下使总分析方差最小化的唯一 $K$。\n- 使用你推导出的最优 $K$，将 $A$ 表示为 $B$ 与一个依赖于 $H$、$B$ 和 $R$ 的半正定矩阵之差，从而证明 $A$ 的每个对角线元素都小于或等于 $B$ 的相应对角线元素；也就是说，$A$ 的对角线元素相对于 $B$ 实现了分析方差的减小。\n- 对于标量情况，即 $x \\in \\mathbb{R}$, $H \\in \\mathbb{R}$, $B \\in \\mathbb{R}$, $R \\in \\mathbb{R}$ 且 $H \\neq 0$, $B > 0$, $R > 0$ 的情况，计算方差减小因子 $\\gamma = A / B$，并以 $H$, $B$, $R$ 的闭式表达式给出。\n\n以 $\\gamma$ 的单个解析表达式形式提供最终答案。无需进行数值舍入。",
            "solution": "所述问题是数据同化领域的一个标准推导，具体涉及最优插值 (OI) 或最佳线性无偏估计 (BLUE)。给定条件定义清晰，科学上一致，目标是适定的数学任务。所有给出的术语和假设在数值天气预报和气候模拟的文献中都是标准的。因此，该问题是有效的。\n\n我们首先定义分析误差 $e_a$，即分析状态 $x_a$ 与真实状态 $x$ 之间的差：\n$$e_a = x_a - x$$\n分析状态 $x_a$ 由线性估计量给出：\n$$x_a = x_b + K(y - Hx_b)$$\n其中 $K$ 是增益矩阵，$x_b$ 是背景场状态，$y$ 是观测向量，$H$ 是观测算子。我们还已知背景场和观测与真实状态 $x$ 及其各自误差 $e_b$ 和 $\\epsilon$ 的关系：\n$$x_b = x + e_b$$\n$$y = Hx + \\epsilon$$\n误差是无偏的，即 $\\mathbb{E}[e_b] = 0$ 和 $\\mathbb{E}[\\epsilon] = 0$，并且是不相关的，$\\operatorname{Cov}(e_b, \\epsilon) = \\mathbb{E}[e_b \\epsilon^T] = 0$。\n\n首先，我们用背景场误差 $e_b$ 和观测误差 $\\epsilon$ 来表示分析误差 $e_a$：\n$$e_a = (x_b + K(y - Hx_b)) - x$$\n代入 $x_b$ 和 $y$ 的表达式：\n$$e_a = (x + e_b) + K((Hx + \\epsilon) - H(x + e_b)) - x$$\n$$e_a = e_b + K(Hx + \\epsilon - Hx - He_b)$$\n$$e_a = e_b + K(\\epsilon - He_b)$$\n$$e_a = (I - KH)e_b + K\\epsilon$$\n其中 $I$ 是大小为 $n \\times n$ 的单位矩阵。\n\n分析误差协方差矩阵 $A$ 定义为 $A = \\operatorname{Cov}(e_a) = \\mathbb{E}[e_a e_a^T]$。使用 $e_a$ 的表达式，我们得到：\n$$A = \\mathbb{E}[((I - KH)e_b + K\\epsilon)((I - KH)e_b + K\\epsilon)^T]$$\n$$A = \\mathbb{E}[((I - KH)e_b + K\\epsilon)(e_b^T(I - KH)^T + \\epsilon^T K^T)]$$\n展开此表达式得到四项：\n$$A = \\mathbb{E}[(I - KH)e_b e_b^T (I - KH)^T] + \\mathbb{E}[(I - KH)e_b \\epsilon^T K^T] + \\mathbb{E}[K\\epsilon e_b^T (I - KH)^T] + \\mathbb{E}[K\\epsilon \\epsilon^T K^T]$$\n利用期望的线性性质和给定的协方差信息 ($\\operatorname{Cov}(e_b) = \\mathbb{E}[e_b e_b^T] = B$，$\\operatorname{Cov}(\\epsilon) = \\mathbb{E}[\\epsilon \\epsilon^T] = R$，以及 $\\mathbb{E}[e_b \\epsilon^T] = 0$) ，交叉项消失：\n$$\\mathbb{E}[(I - KH)e_b \\epsilon^T K^T] = (I - KH)\\mathbb{E}[e_b \\epsilon^T]K^T = 0$$\n$$\\mathbb{E}[K\\epsilon e_b^T (I - KH)^T] = K\\mathbb{E}[\\epsilon e_b^T](I - KH)^T = 0$$\n$A$ 的表达式简化为：\n$$A(K) = (I - KH) \\mathbb{E}[e_b e_b^T] (I - KH)^T + K \\mathbb{E}[\\epsilon \\epsilon^T] K^T$$\n$$A(K) = (I - KH)B(I - KH)^T + KRK^T$$\n这就是用 $K$、$H$、$B$ 和 $R$ 表示的分析误差协方差矩阵。\n\n为了找到最小化总分析方差的最优增益 $K$，我们最小化 $A$ 的迹，记为 $J(K) = \\operatorname{tr}(A(K))$。首先，我们展开 $A(K)$ 的表达式：\n$$A(K) = (B - KHB)(I - H^T K^T) + KRK^T$$\n$$A(K) = B - KHB - BH^T K^T + KHBH^T K^T + KRK^T$$\n$$A(K) = B - KHB - BH^T K^T + K(HBH^T + R)K^T$$\n成本函数为：\n$$J(K) = \\operatorname{tr}(B) - \\operatorname{tr}(KHB) - \\operatorname{tr}(BH^T K^T) + \\operatorname{tr}(K(HBH^T + R)K^T)$$\n利用迹的循环性质，$\\operatorname{tr}(BH^T K^T) = \\operatorname{tr}(K^T BH^T) = \\operatorname{tr}((KHB)^T) = \\operatorname{tr}(KHB)$。因此：\n$$J(K) = \\operatorname{tr}(B) - 2\\operatorname{tr}(KHB) + \\operatorname{tr}(K(HBH^T + R)K^T)$$\n为求最小值，我们计算 $J(K)$ 对 $K$ 的梯度并令其为零。使用标准的矩阵微积分恒等式 ($\\nabla_X \\operatorname{tr}(AXB) = A^T B^T$ 以及对于对称矩阵 $A$ 有 $\\nabla_X \\operatorname{tr}(XAX^T) = 2AX$)，我们得到：\n$$\\nabla_K J(K) = -2 (HB)^T + 2K(HBH^T + R)$$\n由于 $B$ 是一个协方差矩阵，它是对称的 ($B=B^T$)。同样，$HBH^T+R$ 也是对称的。\n$$\\nabla_K J(K) = -2BH^T + 2K(HBH^T + R)$$\n为达到最优，将梯度设为零：\n$$-2BH^T + 2K(HBH^T + R) = 0$$\n$$K(HBH^T + R) = BH^T$$\n因此，最优增益矩阵 $K$ 是：\n$$K = BH^T (HBH^T + R)^{-1}$$\n\n接下来，我们表示这个最优 $K$ 对应的分析误差协方差 $A$。可以证明，对于最优 $K$，$A$ 的表达式可以简化。让我们从 $A = B - KHB - BH^T K^T + K(HBH^T + R)K^T$ 开始。代入 $K(HBH^T + R) = BH^T$：\n$$A = B - KHB - BH^T K^T + (BH^T)K^T$$\n$$A = B - KHB$$\n现在，代入最优 $K$ 的表达式：\n$$A = B - (BH^T (HBH^T + R)^{-1}) H B$$\n设矩阵 $M = BH^T (HBH^T + R)^{-1} H B$。那么 $A = B - M$。为证明 $M$ 是半正定的，我们考虑对于任意向量 $z \\in \\mathbb{R}^n$ 的 $z^T M z$：\n$$z^T M z = z^T B H^T (HBH^T + R)^{-1} H B z$$\n由于 $B$ 是对称的，我们可以将其写为 $(HBz)^T (HBH^T + R)^{-1} (HBz)$。设 $w = HBz \\in \\mathbb{R}^m$。该表达式变为 $w^T (HBH^T + R)^{-1} w$。矩阵 $B$ 是半正定的。矩阵 $HBH^T$ 也是半正定的，因为对于任何向量 $u \\in \\mathbb{R}^m$，有 $u^T(HBH^T)u = (H^Tu)^T B (H^Tu) \\ge 0$。观测误差协方差 $R$ 假定是正定的 (因为它必须是可逆的)。一个半正定矩阵和一个正定矩阵的和是正定的。因此，$HBH^T + R$ 是正定的，其逆矩阵也是正定的。所以，对于任何 $w \\neq 0$，有 $w^T (HBH^T + R)^{-1} w > 0$，而对于 $w=0$，其值为 $0$。这意味着对于所有 $z$，都有 $z^T M z \\ge 0$，所以 $M$ 是半正定的。\n\n$A$ 和 $B$ 的对角线元素 $A_{ii}$ 和 $B_{ii}$ 分别表示状态向量第 $i$ 个分量的分析方差和背景场方差。我们有 $A = B - M$，所以按分量来看，$A_{ii} = B_{ii} - M_{ii}$。半正定矩阵的对角线元素是非负的，所以 $M_{ii} \\ge 0$。这意味着：\n$$A_{ii} \\le B_{ii}$$\n这证明了每个状态变量的分析方差小于或等于背景场方差，这正是所期望的方差减小。\n\n最后，我们考虑标量情况，其中 $x, H, B, R$ 均为标量，且 $H \\neq 0$, $B > 0$, $R > 0$。矩阵方程变为标量方程。最优增益 $K$ 为：\n$$K = B H (H B H + R)^{-1} = \\frac{BH}{H^2 B + R}$$\n分析误差方差 $A$ 由 $A = (1 - KH)B$ 给出：\n$$A = \\left(1 - \\left(\\frac{BH}{H^2 B + R}\\right) H\\right) B$$\n$$A = \\left(1 - \\frac{H^2 B}{H^2 B + R}\\right) B$$\n$$A = \\left(\\frac{H^2 B + R - H^2 B}{H^2 B + R}\\right) B$$\n$$A = \\frac{R}{H^2 B + R} B = \\frac{BR}{H^2 B + R}$$\n方差减小因子 $\\gamma$ 定义为比率 $A / B$：\n$$\\gamma = \\frac{A}{B} = \\frac{1}{B} \\left(\\frac{BR}{H^2 B + R}\\right)$$\n$$\\gamma = \\frac{R}{H^2 B + R}$$\n这就是标量情况下方差减小因子的闭式表达式。",
            "answer": "$$\\boxed{\\frac{R}{H^{2} B + R}}$$"
        },
        {
            "introduction": "在理想的理论基础之上，本练习探讨了一个关键的现实挑战：分析的准确性在很大程度上依赖于我们对背景和观测误差统计特性的设定。通过一个具体的数值案例，本题将量化展示当误差方差被错误估计时，分析结果的质量会如何下降，从而将理论与实践的敏感性问题联系起来。",
            "id": "4070701",
            "problem": "考虑在数值天气预报和气候模拟背景下的标量最优插值（OI），其中有一个单一状态变量 $x$，一个背景场（第一次猜测）$x_b$，以及一个测量同一状态分量的单一观测 $y$。假设线性观测模型为 $y = x + \\varepsilon_o$，背景模型为 $x_b = x + \\varepsilon_b$。背景误差 $\\varepsilon_b$ 和观测误差 $\\varepsilon_o$ 是独立的、零均值的、服从高斯分布的，其真实方差分别为 $\\operatorname{Var}(\\varepsilon_b) = B_{\\text{true}}$ 和 $\\operatorname{Var}(\\varepsilon_o) = R_{\\text{true}}$。分析场通过 $x_a = x_b + K\\,(y - x_b)$ 形成，其中 $K$ 是一个标量增益，由分析员选择，以使用假定的误差方差 $B_{\\text{assumed}}$ 和 $R_{\\text{assumed}}$ 来最小化期望分析误差平方。\n\n从这些假设以及无偏性和方差的定义出发，推导分析场 $x_a$ 的偏差和方差，将其表示为 $K$、$B_{\\text{true}}$ 和 $R_{\\text{true}}$ 的函数。然后，求出分析员根据假定方差 $B_{\\text{assumed}}$ 和 $R_{\\text{assumed}}$ 会选择的增益 $K$，并用它来计算在真实误差统计下的实际分析误差方差。同时，推导如果使用真实误差统计来选择增益时所得到的最优分析误差方差。\n\n为了说明由于错误设定导致的优化性下降，考虑一个案例，其中真实误差方差为 $B_{\\text{true}} = 4$ 和 $R_{\\text{true}} = 1$，但分析员高估了背景误差并低估了观测误差，使用了 $B_{\\text{assumed}} = 9$ 和 $R_{\\text{assumed}} = 0.25$。计算实际分析误差方差（使用从 $B_{\\text{assumed}}$ 和 $R_{\\text{assumed}}$ 计算出的错误设定增益）与最优分析误差方差（使用从 $B_{\\text{true}}$ 和 $R_{\\text{true}}$ 计算出的增益）之比。将最终比率表示为一个无量纲数，并将答案四舍五入到四位有效数字。",
            "solution": "我们首先形式化分析误差及其统计特性。状态变量用 $x$ 表示，背景估计用 $x_b$ 表示，观测用 $y$ 表示。背景模型和观测模型给出如下：\n$$x_b = x + \\varepsilon_b$$\n$$y = x + \\varepsilon_o$$\n其中 $\\varepsilon_b$ 和 $\\varepsilon_o$ 分别是背景误差和观测误差。这些误差被假定为独立的、零均值的高斯随机变量。它们的真实方差为 $\\operatorname{Var}(\\varepsilon_b) = E[\\varepsilon_b^2] = B_{\\text{true}}$ 和 $\\operatorname{Var}(\\varepsilon_o) = E[\\varepsilon_o^2] = R_{\\text{true}}$。\n\n分析场 $x_a$ 是由背景场和观测新息（$y-x_b$）的线性组合形成的：\n$$x_a = x_b + K(y - x_b)$$\n其中 $K$ 是一个标量增益。我们可以将其重写为：\n$$x_a = (1-K)x_b + Ky$$\n\n分析误差 $\\varepsilon_a$ 定义为分析场与真实状态之间的差值：\n$$\\varepsilon_a = x_a - x$$\n代入 $x_a$、$x_b$ 和 $y$ 的表达式：\n$$\\varepsilon_a = ((1-K)x_b + Ky) - x$$\n$$\\varepsilon_a = (1-K)(x + \\varepsilon_b) + K(x + \\varepsilon_o) - x$$\n$$\\varepsilon_a = (1-K)x + (1-K)\\varepsilon_b + Kx + K\\varepsilon_o - x$$\n$$\\varepsilon_a = (1-K+K-1)x + (1-K)\\varepsilon_b + K\\varepsilon_o$$\n$$\\varepsilon_a = (1-K)\\varepsilon_b + K\\varepsilon_o$$\n\n分析的偏差是分析误差的期望值。利用期望算子的线性和误差的零均值特性（$E[\\varepsilon_b]=0$，$E[\\varepsilon_o]=0$）：\n$$E[\\varepsilon_a] = E[(1-K)\\varepsilon_b + K\\varepsilon_o] = (1-K)E[\\varepsilon_b] + KE[\\varepsilon_o] = (1-K)(0) + K(0) = 0$$\n对于标量增益 $K$ 的任何选择，分析都是无偏的。\n\n分析误差的方差，记为 $A$，由 $A = \\operatorname{Var}(\\varepsilon_a) = E[\\varepsilon_a^2] - (E[\\varepsilon_a])^2$ 给出。由于偏差为零，这简化为 $A = E[\\varepsilon_a^2]$。该方差是所选增益 $K$ 的函数：\n$$A(K) = E[((1-K)\\varepsilon_b + K\\varepsilon_o)^2]$$\n$$A(K) = E[(1-K)^2\\varepsilon_b^2 + 2K(1-K)\\varepsilon_b\\varepsilon_o + K^2\\varepsilon_o^2]$$\n利用期望的线性和 $\\varepsilon_b$与$\\varepsilon_o$ 的独立性（这意味着 $E[\\varepsilon_b\\varepsilon_o] = E[\\varepsilon_b]E[\\varepsilon_o] = 0$）：\n$$A(K) = (1-K)^2 E[\\varepsilon_b^2] + 2K(1-K)E[\\varepsilon_b\\varepsilon_o] + K^2 E[\\varepsilon_o^2]$$\n$$A(K) = (1-K)^2 B_{\\text{true}} + K^2 R_{\\text{true}}$$\n这个方程给出了在真实误差统计 $B_{\\text{true}}$ 和 $R_{\\text{true}}$ 下，对于给定增益 $K$ 的实际分析误差方差。\n\n然而，分析员并不知道真实方差。他们通过最小化*假定*的分析误差方差来选择增益 $K$，该方差是他们假定方差 $B_{\\text{assumed}}$ 和 $R_{\\text{assumed}}$ 的函数。设此目标函数为 $J(K)$：\n$$J(K) = (1-K)^2 B_{\\text{assumed}} + K^2 R_{\\text{assumed}}$$\n为了找到最小化 $J(K)$ 的增益，我们对 $K$ 求导并令其为零：\n$$\\frac{dJ}{dK} = -2(1-K)B_{\\text{assumed}} + 2K R_{\\text{assumed}} = 0$$\n$$-2B_{\\text{assumed}} + 2KB_{\\text{assumed}} + 2KR_{\\text{assumed}} = 0$$\n$$2K(B_{\\text{assumed}} + R_{\\text{assumed}}) = 2B_{\\text{assumed}}$$\n由于错误设定的方差，分析员选择的增益我们记为 $K_{\\text{subopt}}$，其值为：\n$$K_{\\text{subopt}} = \\frac{B_{\\text{assumed}}}{B_{\\text{assumed}} + R_{\\text{assumed}}}$$\n\n使用这个次优增益所产生的实际分析误差方差，可通过将 $K_{\\text{subopt}}$ 代入 $A(K)$ 的方程求得：\n$$A_{\\text{actual}} = (1 - K_{\\text{subopt}})^2 B_{\\text{true}} + (K_{\\text{subopt}})^2 R_{\\text{true}}$$\n$$A_{\\text{actual}} = \\left(1 - \\frac{B_{\\text{assumed}}}{B_{\\text{assumed}} + R_{\\text{assumed}}}\\right)^2 B_{\\text{true}} + \\left(\\frac{B_{\\text{assumed}}}{B_{\\text{assumed}} + R_{\\text{assumed}}}\\right)^2 R_{\\text{true}}$$\n$$A_{\\text{actual}} = \\left(\\frac{R_{\\text{assumed}}}{B_{\\text{assumed}} + R_{\\text{assumed}}}\\right)^2 B_{\\text{true}} + \\left(\\frac{B_{\\text{assumed}}}{B_{\\text{assumed}} + R_{\\text{assumed}}}\\right)^2 R_{\\text{true}}$$\n\n最优分析误差方差 $A_{\\text{opt}}$ 是在增益使用真实方差计算时达到的。最优增益 $K_{\\text{opt}}$ 为：\n$$K_{\\text{opt}} = \\frac{B_{\\text{true}}}{B_{\\text{true}} + R_{\\text{true}}}$$\n得到的最小方差为：\n$$A_{\\text{opt}} = (1-K_{\\text{opt}})^2 B_{\\text{true}} + (K_{\\text{opt}})^2 R_{\\text{true}}$$\n$$A_{\\text{opt}} = \\left(\\frac{R_{\\text{true}}}{B_{\\text{true}} + R_{\\text{true}}}\\right)^2 B_{\\text{true}} + \\left(\\frac{B_{\\text{true}}}{B_{\\text{true}} + R_{\\text{true}}}\\right)^2 R_{\\text{true}}$$\n$$A_{\\text{opt}} = \\frac{R_{\\text{true}}^2 B_{\\text{true}} + B_{\\text{true}}^2 R_{\\text{true}}}{(B_{\\text{true}} + R_{\\text{true}})^2} = \\frac{B_{\\text{true}} R_{\\text{true}} (R_{\\text{true}} + B_{\\text{true}})}{(B_{\\text{true}} + R_{\\text{true}})^2} = \\frac{B_{\\text{true}} R_{\\text{true}}}{B_{\\text{true}} + R_{\\text{true}}}$$\n\n现在我们应用给定的具体数值：$B_{\\text{true}} = 4$，$R_{\\text{true}} = 1$，$B_{\\text{assumed}} = 9$ 和 $R_{\\text{assumed}} = 0.25$。\n\n首先，我们计算分析员选择的次优增益：\n$$K_{\\text{subopt}} = \\frac{B_{\\text{assumed}}}{B_{\\text{assumed}} + R_{\\text{assumed}}} = \\frac{9}{9 + 0.25} = \\frac{9}{9.25} = \\frac{36}{37}$$\n\n接下来，我们使用此增益计算实际分析误差方差 $A_{\\text{actual}}$：\n$$A_{\\text{actual}} = (1 - K_{\\text{subopt}})^2 B_{\\text{true}} + (K_{\\text{subopt}})^2 R_{\\text{true}}$$\n$$A_{\\text{actual}} = \\left(1 - \\frac{36}{37}\\right)^2 (4) + \\left(\\frac{36}{37}\\right)^2 (1) = \\left(\\frac{1}{37}\\right)^2 (4) + \\left(\\frac{36}{37}\\right)^2 (1)$$\n$$A_{\\text{actual}} = \\frac{4}{1369} + \\frac{1296}{1369} = \\frac{1300}{1369}$$\n\n然后，我们计算最优分析误差方差 $A_{\\text{opt}}$，这是在完全了解误差统计的情况下可以达到的：\n$$A_{\\text{opt}} = \\frac{B_{\\text{true}} R_{\\text{true}}}{B_{\\text{true}} + R_{\\text{true}}} = \\frac{4 \\times 1}{4 + 1} = \\frac{4}{5}$$\n\n最后，我们计算实际方差与最优方差之比：\n$$\\text{Ratio} = \\frac{A_{\\text{actual}}}{A_{\\text{opt}}} = \\frac{\\frac{1300}{1369}}{\\frac{4}{5}} = \\frac{1300}{1369} \\times \\frac{5}{4} = \\frac{325 \\times 5}{1369} = \\frac{1625}{1369}$$\n将此分数转换为小数得到：\n$$\\text{Ratio} \\approx 1.1869978...$$\n四舍五入到四位有效数字，比值为 $1.187$。这个大于 $1$ 的值量化了因误差方差的错误设定而导致的分析质量下降。",
            "answer": "$$\\boxed{1.187}$$"
        },
        {
            "introduction": "本练习将我们从简单的标量问题带入一个更真实的地球物理场景，其中涉及多变量和物理约束。通过构建一个包含地转平衡关系的背景误差协方差矩阵，本题旨在展示最优插值如何智能地将单个观测的影响不仅在空间上传播，还能在不同物理场之间传递，这突显了背景误差协方差矩阵 $B$ 在生成动力协调的分析场中的强大作用。",
            "id": "4070656",
            "problem": "考虑一个用于数值天气预报和气候模拟中客观分析的双变量、双位置背景误差协方差构造，其中气压和流函数之间存在地转耦合。设两个格点（一个目标格点 $G_0$ 和一个观测位置 $G_1$）上的模式状态为四分量向量 $\\mathbf{x} = \\big(p(G_0),\\, \\psi(G_0),\\, p(G_1),\\, \\psi(G_1)\\big)^{\\mathsf{T}}$，其中 $p$ 是气压，$\\psi$ 是流函数。假设以下基于物理的关系和统计结构作为出发点：\n\n- 地转平衡通过 $\\phi = f\\,\\psi$ 将位势 $\\phi$ 和流函数 $\\psi$ 联系起来，其中 $f$ 是科里奥利参数。气压为 $p = \\rho\\,\\phi$，因此 $p = \\gamma\\,\\psi$，其中 $\\gamma \\equiv \\rho f$。\n- 背景误差是无偏的、二阶平稳的，并且在空间上是均匀和各向同性的。流函数的背景误差协方差为 $\\operatorname{Cov}(\\psi(\\mathbf{r}_i), \\psi(\\mathbf{r}_j)) = \\sigma_{\\psi}^{2} C(r_{ij})$，其中 $C(r) = \\exp(-r/L)$，$r_{ij}$ 是格点 $i$ 和 $j$ 之间的距离，$L$ 是相关长度。涉及气压的交叉协方差和自协方差可以从 $p = \\gamma\\,\\psi$ 的线性关系中推导出来。\n\n使用这些基本假设，将 $\\mathbf{x}$ 的 $4 \\times 4$ 背景误差协方差矩阵 $\\mathbf{B}$ 构造为分块矩阵。然后，考虑在 $G_1$ 处的一个单个标量气压观测，其观测算子为 $\\mathbf{H} = \\big(0,\\, 0,\\, 1,\\, 0\\big)$，观测误差为无偏，方差为 $R = \\sigma_{o}^{2}$。假设背景误差和观测误差不相关。\n\n给定以下物理上合理的参数值：\n- $\\rho = 1.2\\,\\text{kg m}^{-3}$，$f = 1.0 \\times 10^{-4}\\,\\text{s}^{-1}$，因此 $\\gamma = \\rho f$，\n- $\\sigma_{\\psi} = 3.0 \\times 10^{6}\\,\\text{m}^{2}\\,\\text{s}^{-1}$，\n- $L = 3.0 \\times 10^{5}\\,\\text{m}$，$G_0$ 和 $G_1$ 之间的距离为 $r = 1.5 \\times 10^{5}\\,\\text{m}$，\n- 观测误差标准差 $\\sigma_{o} = 1.0 \\times 10^{2}\\,\\text{Pa}$，\n- 在 $G_1$ 处观测到的单个气压 $y = 1.013 \\times 10^{5}\\,\\text{Pa}$，\n- 在 $G_1$ 处的背景气压为 $p_{b}(G_1) = 1.010 \\times 10^{5}\\,\\text{Pa}$，\n\n从第一性原理推导在 $G_0$ 处气压的最优插值 (OI) 增量，即由这单个观测引起的分析场与背景场之差的增量 $\\delta p(G_0)$。用帕斯卡表示 $\\delta p(G_0)$ 的最终数值答案，并将答案四舍五入到四位有效数字。",
            "solution": "目标是利用最优插值 (OI) 的原理，计算格点 $G_0$ 处的气压分析增量，记为 $\\delta p(G_0)$。\n\n首先，我们构造 $4 \\times 4$ 背景误差协方差矩阵 $\\mathbf{B} = \\operatorname{E}[(\\mathbf{x}-\\mathbf{x}_b)(\\mathbf{x}-\\mathbf{x}_b)^{\\mathsf{T}}]$，其中 $\\mathbf{x}_b$ 是背景状态。状态向量的分量是 $x_1=p(G_0)$，$x_2=\\psi(G_0)$，$x_3=p(G_1)$ 和 $x_4=\\psi(G_1)$。$\\mathbf{B}$ 的元素是 $B_{ij} = \\operatorname{Cov}(x_i, x_j)$。\n\n使用线性关系 $p = \\gamma \\psi$，我们可以用流函数协方差表示所有的协方差：\n- $\\operatorname{Cov}(p_i, p_j) = \\operatorname{Cov}(\\gamma\\psi_i, \\gamma\\psi_j) = \\gamma^2 \\operatorname{Cov}(\\psi_i, \\psi_j) = \\gamma^2 \\sigma_{\\psi}^{2} C(r_{ij})$\n- $\\operatorname{Cov}(p_i, \\psi_j) = \\operatorname{Cov}(\\gamma\\psi_i, \\psi_j) = \\gamma \\operatorname{Cov}(\\psi_i, \\psi_j) = \\gamma \\sigma_{\\psi}^{2} C(r_{ij})$\n- $\\operatorname{Cov}(\\psi_i, \\psi_j) = \\sigma_{\\psi}^{2} C(r_{ij})$\n\n此处，下标 $i,j \\in \\{0, 1\\}$ 指的是格点 $G_0$ 和 $G_1$。距离为 $r_{00}=0$，$r_{11}=0$ 和 $r_{01}=r_{10}=r$。在这些距离上的相关函数给出 $C(0)=\\exp(0)=1$ 和 $C(r)=\\exp(-r/L)$。\n\n我们为单个点定义一个 $2 \\times 2$ 的协方差块：\n$$\n\\mathbf{C}_{\\text{point}} = \\begin{pmatrix} \\operatorname{Cov}(p,p) & \\operatorname{Cov}(p,\\psi) \\\\ \\operatorname{Cov}(\\psi,p) & \\operatorname{Cov}(\\psi,\\psi) \\end{pmatrix} = \\begin{pmatrix} \\gamma^2 \\sigma_{\\psi}^2 & \\gamma \\sigma_{\\psi}^2 \\\\ \\gamma \\sigma_{\\psi}^2 & \\sigma_{\\psi}^2 \\end{pmatrix} = \\sigma_{\\psi}^2 \\begin{pmatrix} \\gamma^2 & \\gamma \\\\ \\gamma & 1 \\end{pmatrix}\n$$\n完整的 $4 \\times 4$ 矩阵 $\\mathbf{B}$ 是一个分块矩阵：\n$$\n\\mathbf{B} = \\begin{pmatrix} \\mathbf{B}_{00} & \\mathbf{B}_{01} \\\\ \\mathbf{B}_{10} & \\mathbf{B}_{11} \\end{pmatrix}\n$$\n其中 $\\mathbf{B}_{ij}$ 是点 $G_i$ 和 $G_j$ 之间的协方差块。\n- $\\mathbf{B}_{00} = \\mathbf{C}_{\\text{point}} \\cdot C(r_{00}) = \\sigma_{\\psi}^2 \\begin{pmatrix} \\gamma^2 & \\gamma \\\\ \\gamma & 1 \\end{pmatrix}$\n- $\\mathbf{B}_{11} = \\mathbf{C}_{\\text{point}} \\cdot C(r_{11}) = \\sigma_{\\psi}^2 \\begin{pmatrix} \\gamma^2 & \\gamma \\\\ \\gamma & 1 \\end{pmatrix}$\n- $\\mathbf{B}_{01} = \\mathbf{B}_{10}^{\\mathsf{T}} = \\mathbf{C}_{\\text{point}} \\cdot C(r_{01}) = \\sigma_{\\psi}^2 \\exp(-r/L) \\begin{pmatrix} \\gamma^2 & \\gamma \\\\ \\gamma & 1 \\end{pmatrix}$\n\n因此，完整的背景误差协方差矩阵是：\n$$\n\\mathbf{B} = \\sigma_{\\psi}^2 \\begin{pmatrix}\n\\gamma^2 & \\gamma & \\gamma^2 \\exp(-r/L) & \\gamma \\exp(-r/L) \\\\\n\\gamma & 1 & \\gamma \\exp(-r/L) & \\exp(-r/L) \\\\\n\\gamma^2 \\exp(-r/L) & \\gamma \\exp(-r/L) & \\gamma^2 & \\gamma \\\\\n\\gamma \\exp(-r/L) & \\exp(-r/L) & \\gamma & 1\n\\end{pmatrix}\n$$\n\n分析增量 $\\delta \\mathbf{x} = \\mathbf{x}_a - \\mathbf{x}_b$ 由 OI 方程给出：\n$$\n\\delta \\mathbf{x} = \\mathbf{K} (y - \\mathbf{H}\\mathbf{x}_b)\n$$\n其中 $\\mathbf{K}$ 是分析增益矩阵。项 $d = y - \\mathbf{H}\\mathbf{x}_b$ 是新息或离差。给定 $G_1$ 处的背景气压 $p_b(G_1)$，我们有 $\\mathbf{H}\\mathbf{x}_b = p_b(G_1)$。\n增益矩阵定义为：\n$$\n\\mathbf{K} = \\mathbf{B}\\mathbf{H}^{\\mathsf{T}}(\\mathbf{H}\\mathbf{B}\\mathbf{H}^{\\mathsf{T}} + R)^{-1}\n$$\n我们计算涉及 $\\mathbf{H} = \\begin{pmatrix} 0 & 0 & 1 & 0 \\end{pmatrix}$ 的项：\n- $\\mathbf{H}^{\\mathsf{T}} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 0 \\end{pmatrix}$\n- $\\mathbf{B}\\mathbf{H}^{\\mathsf{T}}$ 是 $\\mathbf{B}$ 的第三列：\n  $$\n  \\mathbf{B}\\mathbf{H}^{\\mathsf{T}} = \\sigma_{\\psi}^2 \\begin{pmatrix} \\gamma^2 \\exp(-r/L) \\\\ \\gamma \\exp(-r/L) \\\\ \\gamma^2 \\\\ \\gamma \\end{pmatrix}\n  $$\n- $\\mathbf{H}\\mathbf{B}\\mathbf{H}^{\\mathsf{T}}$ 是一个标量，即列向量 $\\mathbf{B}\\mathbf{H}^{\\mathsf{T}}$ 的第三个元素：\n  $$\n  \\mathbf{H}\\mathbf{B}\\mathbf{H}^{\\mathsf{T}} = \\sigma_{\\psi}^2 \\gamma^2\n  $$\n  这就是气压的背景误差方差，$\\sigma_p^2 = \\operatorname{Var}(p_b(G_1))$。\n- 分母项是一个标量：$\\mathbf{H}\\mathbf{B}\\mathbf{H}^{\\mathsf{T}} + R = \\sigma_{\\psi}^2 \\gamma^2 + \\sigma_o^2$。\n\n增益矩阵 $\\mathbf{K}$ 是一个 $4 \\times 1$ 的列向量：\n$$\n\\mathbf{K} = \\frac{1}{\\sigma_{\\psi}^2 \\gamma^2 + \\sigma_o^2} \\mathbf{B}\\mathbf{H}^{\\mathsf{T}} = \\frac{\\sigma_{\\psi}^2}{\\sigma_{\\psi}^2 \\gamma^2 + \\sigma_o^2} \\begin{pmatrix} \\gamma^2 \\exp(-r/L) \\\\ \\gamma \\exp(-r/L) \\\\ \\gamma^2 \\\\ \\gamma \\end{pmatrix}\n$$\n\n分析增量向量 $\\delta \\mathbf{x}$ 是：\n$$\n\\delta \\mathbf{x} = \\begin{pmatrix} \\delta p(G_0) \\\\ \\delta \\psi(G_0) \\\\ \\delta p(G_1) \\\\ \\delta \\psi(G_1) \\end{pmatrix} = \\frac{\\sigma_{\\psi}^2 (y - p_b(G_1))}{\\sigma_{\\psi}^2 \\gamma^2 + \\sigma_o^2} \\begin{pmatrix} \\gamma^2 \\exp(-r/L) \\\\ \\gamma \\exp(-r/L) \\\\ \\gamma^2 \\\\ \\gamma \\end{pmatrix}\n$$\n\n我们感兴趣的是第一个分量，$\\delta p(G_0)$：\n$$\n\\delta p(G_0) = \\frac{\\sigma_{\\psi}^2 \\gamma^2 \\exp(-r/L)}{\\sigma_{\\psi}^2 \\gamma^2 + \\sigma_o^2} (y - p_b(G_1))\n$$\n这可以解释为分析变量和观测变量之间的背景误差协方差，与观测位置处的总误差方差（背景加观测）之比，再乘以新息。\n\n现在我们代入给定的数值。\n- $\\gamma = \\rho f = (1.2\\,\\text{kg m}^{-3})(1.0 \\times 10^{-4}\\,\\text{s}^{-1}) = 1.2 \\times 10^{-4}\\,\\text{kg m}^{-3}\\text{s}^{-1}$。\n- $\\sigma_{\\psi} = 3.0 \\times 10^{6}\\,\\text{m}^{2}\\,\\text{s}^{-1}$。\n- $r = 1.5 \\times 10^{5}\\,\\text{m}$ 且 $L = 3.0 \\times 10^{5}\\,\\text{m}$，所以 $r/L = 0.5$。\n- $\\exp(-r/L) = \\exp(-0.5)$。\n- $\\sigma_o = 1.0 \\times 10^2\\,\\text{Pa}$，所以 $R = \\sigma_o^2 = (1.0 \\times 10^2)^2\\,\\text{Pa}^2 = 1.0 \\times 10^4\\,\\text{Pa}^2$。\n- 新息：$d = y - p_b(G_1) = (1.013 \\times 10^5 - 1.010 \\times 10^5)\\,\\text{Pa} = 300\\,\\text{Pa}$。\n\n计算 $\\delta p(G_0)$ 表达式中的各项：\n- $G_1$ 处的背景气压方差：$\\sigma_p^2 = \\sigma_{\\psi}^2 \\gamma^2 = (3.0 \\times 10^6)^2 (1.2 \\times 10^{-4})^2 = (9.0 \\times 10^{12}) (1.44 \\times 10^{-8}) = 12.96 \\times 10^4\\,\\text{Pa}^2$。\n- 观测位置处的总误差方差：$\\sigma_p^2 + R = (12.96 \\times 10^4 + 1.0 \\times 10^4)\\,\\text{Pa}^2 = 13.96 \\times 10^4\\,\\text{Pa}^2$。\n\n现在，计算 $\\delta p(G_0)$：\n$$\n\\delta p(G_0) = \\frac{12.96 \\times 10^4 \\exp(-0.5)}{13.96 \\times 10^4} \\times 300\\,\\text{Pa}\n$$\n$$\n\\delta p(G_0) = \\frac{12.96}{13.96} \\times \\exp(-0.5) \\times 300\\,\\text{Pa}\n$$\n使用数值 $\\exp(-0.5) \\approx 0.60653066$ 和 $12.96 / 13.96 \\approx 0.92836676$：\n$$\n\\delta p(G_0) \\approx (0.92836676) \\times (0.60653066) \\times 300\\,\\text{Pa}\n$$\n$$\n\\delta p(G_0) \\approx 0.56309606 \\times 300\\,\\text{Pa} \\approx 168.928819\\,\\text{Pa}\n$$\n将结果四舍五入到四位有效数字，我们得到：\n$$\n\\delta p(G_0) \\approx 168.9\\,\\text{Pa}\n$$\n这个正增量意味着 $G_0$ 处的分析向上修正了气压，这是受到了 $G_1$ 处高于背景场的观测值的影响。修正的幅度被两点之间的距离（通过相关函数）以及背景场与观测值的相对确定性所减弱。",
            "answer": "$$\n\\boxed{168.9}\n$$"
        }
    ]
}