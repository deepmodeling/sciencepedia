{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握地形跟随坐标，第一步是理解坐标面本身的几何形状。这个练习提供了一个具体的视角，展示了混合地形跟随坐标如何从紧贴地表的地形平滑过渡到高空平坦的等压面。通过在一个理想化的等温大气中推导恒定 $\\eta$ 坐标面的几何高度，我们可以清晰地揭示这些坐标系的基本设计思想，这对于理解它们为何能有效处理复杂地形至关重要。",
            "id": "4060938",
            "problem": "考虑一个用于数值天气预报（NWP）和气候模型的干燥、静力、二维大气。假设大气在 $y$ 方向上水平均一，温度为常数 $T$ 的等温大气，并受静力平衡和理想气体定律支配。令 $x$ 表示水平坐标，$z$ 表示几何高度。地形高度由 $h(x)$ 指定，在 $z=h(x)$ 处的局地地表气压 $p_{s}(x)$ 通过等温静力关系与海平面参考气压 $p_{0}$ 相关联。模型的上边界由一个不依赖于 $x$ 的恒定气压 $p_{t}$ 指定。\n\n定义一个混合地形跟随的对数气压坐标\n$$\n\\eta(x,z) \\equiv \\frac{\\ln\\!\\big(p(x,z)/p_{t}\\big)}{\\ln\\!\\big(p_{s}(x)/p_{t}\\big)}\\,,\n$$\n使得下边界在 $z=h(x)$ 处为 $\\eta=1$，上边界在 $p=p_{t}$ 处为 $\\eta=0$。该区域在 $x$ 方向上是周期的，基本周期为 $L$，地形规定为\n$$\nh(x) = A \\cos\\!\\left(\\frac{2\\pi}{L}x\\right),\n$$\n振幅 $A>0$。常数包括温度 $T$、重力加速度 $g$ 以及干空气的比气体常数 $R$。\n\n仅从静力平衡方程 $dp/dz = -\\rho g$ 和理想气体定律 $p = \\rho R T$ 出发，结合上面 $\\eta(x,z)$ 的坐标定义，推导出一个常数-$\\eta$ 表面的几何高度 $z(\\eta,x)$，并求出该表面的水平斜率 $\\partial z/\\partial x$。在变换后的坐标中，施加物理上一致的边界条件：下边界在 $\\eta=1$ 处是地形跟随的，上边界在 $\\eta=0$ 处是等压面。\n\n然后，对于参数值 $T=280\\,\\mathrm{K}$，$g=9.81\\,\\mathrm{m\\,s^{-2}}$，$R=287\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$，$A=500\\,\\mathrm{m}$，$L=50\\,\\mathrm{km}$，$p_{0}=1.0\\times 10^{5}\\,\\mathrm{Pa}$ 和 $p_{t}=2.0\\times 10^{4}\\,\\mathrm{Pa}$，计算在 $\\eta=0.5$ 和 $x=L/4$ 处，常数-$\\eta$ 表面与水平面所成的夹角 $\\theta$（以弧度为单位）。夹角 $\\theta$ 定义为 $\\theta=\\arctan\\!\\big(\\partial z/\\partial x\\big)$。将 $\\theta$ 的最终数值答案四舍五入到四位有效数字。以弧度表示该角度。",
            "solution": "用户要求在一个指定的混合坐标系中，推导常数-$\\eta$ 表面的几何高度 $z(\\eta,x)$ 及其水平斜率 $\\partial z/\\partial x$，然后对给定点的斜率角度进行数值计算。分析从给定的基本方程开始。\n\n首先，我们建立等温大气中气压 $p$ 与几何高度 $z$ 之间的关系。静力平衡由下式给出\n$$\n\\frac{dp}{dz} = -\\rho g\n$$\n其中 $\\rho$ 是空气密度，$g$ 是重力加速度。干空气的理想气体定律是\n$$\np = \\rho R T\n$$\n其中 $R$ 是比气体常数，$T$ 是恒定温度。我们可以将密度表示为 $\\rho = p/(RT)$ 并将其代入静力平衡方程：\n$$\n\\frac{dp}{dz} = -\\frac{p g}{R T}\n$$\n这是一个可分离的一阶常微分方程。我们可以重新整理并积分：\n$$\n\\int \\frac{dp}{p} = -\\int \\frac{g}{RT} dz\n$$\n让我们定义大气标高 $H \\equiv RT/g$，由于 $R$、$T$ 和 $g$ 都是常数，因此 $H$ 也是常数。方程变为 $d(\\ln p) = -dz/H$。在参考层 $(z_1, p_1)$ 和另一层 $(z_2, p_2)$ 之间积分得到：\n$$\n\\ln(p_2) - \\ln(p_1) = -\\frac{1}{H}(z_2 - z_1)\n$$\n或等价地，\n$$\np_2 = p_1 \\exp\\left(-\\frac{z_2 - z_1}{H}\\right)\n$$\n这是等温大气的气压公式。\n\n接下来，我们求地表气压 $p_s(x)$ 的表达式。题目说明，地形高度 $z=h(x)$ 处的 $p_s(x)$ 与海平面 $z=0$ 处的气压 $p_0$ 相关。使用气压公式，设 $(z_1, p_1) = (0, p_0)$ 和 $(z_2, p_2) = (h(x), p_s(x))$，我们得到：\n$$\np_s(x) = p_0 \\exp\\left(-\\frac{h(x)}{H}\\right) = p_0 \\exp\\left(-\\frac{g h(x)}{RT}\\right)\n$$\n\n现在，我们推导常数-$\\eta$ 表面的几何高度 $z(\\eta, x)$ 的表达式。$\\eta$ 坐标的定义是：\n$$\n\\eta = \\frac{\\ln(p(x,z)/p_t)}{\\ln(p_s(x)/p_t)}\n$$\n其中 $p(x,z)$ 是坐标 $(x,z)$ 处的气压，$p_t$ 是恒定的顶部气压。我们可以求解常数 $\\eta$ 表面上的 $p(x,z)$：\n$$\n\\eta \\ln\\left(\\frac{p_s(x)}{p_t}\\right) = \\ln\\left(\\frac{p(x,z)}{p_t}\\right)\n$$\n对两边取指数得到：\n$$\n\\left(\\frac{p_s(x)}{p_t}\\right)^\\eta = \\frac{p(x,z)}{p_t} \\implies p(x,z) = p_t \\left(\\frac{p_s(x)}{p_t}\\right)^\\eta\n$$\n我们也可以使用气压公式将高度 $z$ 处的气压 $p(x,z)$ 与高度 $h(x)$ 处的地表气压 $p_s(x)$ 联系起来：\n$$\np(x,z) = p_s(x) \\exp\\left(-\\frac{z - h(x)}{H}\\right)\n$$\n求解 $z$：\n$$\n\\ln\\left(\\frac{p(x,z)}{p_s(x)}\\right) = -\\frac{z - h(x)}{H} \\implies z = h(x) - H \\ln\\left(\\frac{p(x,z)}{p_s(x)}\\right)\n$$\n将以 $\\eta$ 表示的 $p(x,z)$ 表达式代入此方程，得到 $z(\\eta,x)$：\n$$\nz(\\eta,x) = h(x) - H \\ln\\left(\\frac{p_t (p_s(x)/p_t)^\\eta}{p_s(x)}\\right)\n$$\n使用对数性质：\n$$\nz(\\eta,x) = h(x) - H \\ln\\left(\\left(\\frac{p_s(x)}{p_t}\\right)^{\\eta-1}\\right) = h(x) - (\\eta-1) H \\ln\\left(\\frac{p_s(x)}{p_t}\\right)\n$$\n$$\nz(\\eta,x) = h(x) + (1-\\eta) H \\ln\\left(\\frac{p_s(x)}{p_t}\\right)\n$$\n代入 $H=RT/g$ 和 $p_s(x)$ 的表达式：\n$$\nz(\\eta,x) = h(x) + (1-\\eta) \\frac{RT}{g} \\ln\\left(\\frac{p_0 \\exp(-g h(x) / (RT))}{p_t}\\right)\n$$\n$$\nz(\\eta,x) = h(x) + (1-\\eta) \\frac{RT}{g} \\left[ \\ln\\left(\\frac{p_0}{p_t}\\right) - \\frac{g h(x)}{RT} \\right]\n$$\n$$\nz(\\eta,x) = h(x) + (1-\\eta) \\frac{RT}{g} \\ln\\left(\\frac{p_0}{p_t}\\right) - (1-\\eta) h(x)\n$$\n$$\nz(\\eta,x) = \\eta h(x) + (1-\\eta) \\frac{RT}{g} \\ln\\left(\\frac{p_0}{p_t}\\right)\n$$\n这就是常数-$\\eta$ 表面的几何高度 $z$ 的最终表达式。\n\n接下来，我们推导该表面的水平斜率，即在 $\\eta$ 为常数时的 $\\frac{\\partial z}{\\partial x}$。我们将推导出的 $z(\\eta, x)$ 表达式对 $x$ 求导：\n$$\n\\frac{\\partial z}{\\partial x}\\bigg|_{\\eta} = \\frac{\\partial}{\\partial x} \\left[ \\eta h(x) + (1-\\eta) \\frac{RT}{g} \\ln\\left(\\frac{p_0}{p_t}\\right) \\right]\n$$\n由于 $\\eta$、$R$、$T$、$g$、$p_0$ 和 $p_t$ 相对于 $x$ 都是常数，因此第二项的导数为零。\n$$\n\\frac{\\partial z}{\\partial x}\\bigg|_{\\eta} = \\eta \\frac{d h(x)}{dx}\n$$\n这个结果非常简单。它表明常数-$\\eta$ 表面的斜率就是地形斜率 $dh/dx$ 乘以 $\\eta$ 的值。\n\n现在，我们根据给定的参数计算这个斜率。地形由下式给出：\n$$\nh(x) = A \\cos\\left(\\frac{2\\pi}{L}x\\right)\n$$\n地形斜率为：\n$$\n\\frac{dh}{dx} = -A \\frac{2\\pi}{L} \\sin\\left(\\frac{2\\pi}{L}x\\right)\n$$\n所以，$\\eta$-表面的斜率为：\n$$\n\\frac{\\partial z}{\\partial x}\\bigg|_{\\eta} = -\\eta A \\frac{2\\pi}{L} \\sin\\left(\\frac{2\\pi}{L}x\\right)\n$$\n我们们需要在 $\\eta = 0.5$ 和 $x = L/4$ 处计算该值：\n$$\n\\frac{\\partial z}{\\partial x}\\bigg|_{\\substack{\\eta=0.5 \\\\ x=L/4}} = -0.5 \\cdot A \\frac{2\\pi}{L} \\sin\\left(\\frac{2\\pi}{L}\\frac{L}{4}\\right)\n$$\n$$\n\\frac{\\partial z}{\\partial x}\\bigg|_{\\substack{\\eta=0.5 \\\\ x=L/4}} = - A \\frac{\\pi}{L} \\sin\\left(\\frac{\\pi}{2}\\right) = -A \\frac{\\pi}{L} (1) = -\\frac{\\pi A}{L}\n$$\n题目给出的值为 $A = 500\\,\\mathrm{m}$ 和 $L = 50\\,\\mathrm{km} = 50 \\times 10^3\\,\\mathrm{m}$。注意，由于在等温大气中 $z(\\eta,x)$ 的结构简化，最终计算不需要常数 $T, g, R, p_0, p_t$。\n$$\n\\frac{\\partial z}{\\partial x} = -\\frac{\\pi (500)}{50000} = -\\frac{500\\pi}{50000} = -\\frac{\\pi}{100}\n$$\n该表面与水平面所成的夹角 $\\theta$ 定义为 $\\theta = \\arctan(\\partial z/\\partial x)$。\n$$\n\\theta = \\arctan\\left(-\\frac{\\pi}{100}\\right)\n$$\n使用计算器以弧度为单位计算此表达式：\n$$\n\\theta \\approx \\arctan(-0.0314159265...) \\approx -0.031405762...\n$$\n四舍五入到四位有效数字，我们得到：\n$$\n\\theta \\approx -0.03141\\,\\mathrm{radians}\n$$",
            "answer": "$$\n\\boxed{-0.03141}\n$$"
        },
        {
            "introduction": "在理解了坐标系的静态几何结构之后，下一步是描述其中的运动。垂直运动是大气科学中的一个关键诊断量，但其具体度量取决于所选择的垂直坐标。本练习深入探讨了在几何坐标 ($w$)、气压坐标 ($\\omega$) 和地形跟随坐标 ($\\dot{\\eta}$) 中垂直速度之间的数学关系，这对于正确解释数值模型输出和理解不同坐标系下的动力学过程是一项至关重要的技能。",
            "id": "4060945",
            "problem": "在一个符合数值天气预报和气候模拟中使用的原始方程的静力、干大气中，考虑三种垂直运动的度量：几何高度垂直速度 $w \\equiv D z / D t$、气压垂直速度 $\\omega \\equiv D p / D t$，以及两种常用垂直坐标的物质时间导数：对数气压坐标 $\\pi \\equiv \\ln\\!\\left(p_{0}/p\\right)$（其中 $p_{0}$ 为常数参考气压）以及一个由气压映射 $p(x,y,\\eta,t) = A(\\eta) + B(\\eta)\\,p_{s}(x,y,t)$ 定义的广义混合地形追随坐标 $\\eta$，其中 $A(\\eta)$ 和 $B(\\eta)$ 是给定的连续可微函数，$p_{s}(x,y,t)$ 是地面气压。设水平速度为 $(u,v)$，重力加速度为 $g$，干空气的比气体常数为 $R_{d}$。假设静力学关系 $\\partial p/\\partial z = - \\rho g$ 成立，且干空气遵循理想气体定律 $p = \\rho R_{d} T$。\n\n1) 在不假设水平均匀性的情况下，使用物质导数的第一性原理以及给定的气压映射，推导 $D\\eta/Dt$ 关于 $\\omega$、$A'(\\eta)$、$B'(\\eta)$、$B(\\eta)$、$p_{s}$ 以及物质导数 $D p_{s}/D t \\equiv \\partial_{t} p_{s} + u\\,\\partial_{x} p_{s} + v\\,\\partial_{y} p_{s}$ 的精确表达式。将最终结果表示为 $D\\eta/Dt$ 的单个闭式解析表达式。\n\n2) 仅使用 $\\pi$ 的定义和链式法则，推导 $D\\pi/Dt$ 仅用 $\\omega$ 和 $p$ 表示的闭式解析表达式。\n\n3) 现在，将问题具体化到目标位置的局部水平均匀且稳态的环境，其特征为 $\\partial_{t} p_{s} = 0$ 和 $\\nabla_{h} p_{s} = \\mathbf{0}$，并假设在气块邻域内各场仅依赖于高度。在这些附加假设下，使用静力平衡和理想气体定律消去 $\\rho$，并获得 $w$ 关于 $\\omega$、$p$、$T$、$g$ 和 $R_{d}$ 的闭式解析表达式。\n\n将您的最终答案表示为单个行向量，按顺序包含 $D\\eta/Dt$、$D\\pi/Dt$ 和 $w$ 的表达式。无需进行数值计算；仅给出简化的符号表达式。在最终的方框答案中不要包含单位。",
            "solution": "该问题被验证为具有科学依据、提法恰当、客观且完整。所有假设和定义在大气动力学和数值模拟的框架内都是标准的。这些任务要求直接（尽管需要仔细）地应用基本原理，例如物质导数的链式法则和基本物理定律的组合。我们将按要求解答所有三个部分。\n\n标量场 $\\phi(x,y,\\eta,t)$ 的物质导数（其中 $(x,y,\\eta)$ 是坐标系，$t$ 是时间）由链式法则给出：\n$$\n\\frac{D\\phi}{Dt} = \\frac{\\partial \\phi}{\\partial t} + \\frac{\\partial \\phi}{\\partial x}\\frac{Dx}{Dt} + \\frac{\\partial \\phi}{\\partial y}\\frac{Dy}{Dt} + \\frac{\\partial \\phi}{\\partial \\eta}\\frac{D\\eta}{Dt}\n$$\n在此背景下，$\\frac{Dx}{Dt} = u$ 和 $\\frac{Dy}{Dt} = v$，其中 $(u,v)$ 是水平速度场。在 $\\eta$ 坐标系中的“垂直”速度是 $\\frac{D\\eta}{Dt}$。因此，应用于 $(x,y,\\eta,t)$ 函数的物质导数算符为：\n$$\n\\frac{D}{Dt} = \\frac{\\partial}{\\partial t} + u\\frac{\\partial}{\\partial x} + v\\frac{\\partial}{\\partial y} + \\frac{D\\eta}{Dt}\\frac{\\partial}{\\partial \\eta}\n$$\n\n1) 推导 $\\frac{D\\eta}{Dt}$ 的表达式。\n\n在广义混合地形追随坐标系 $\\eta$ 中，我们已知气压 $p$ 的定义：\n$$\np(x,y,\\eta,t) = A(\\eta) + B(\\eta)\\,p_{s}(x,y,t)\n$$\n我们通过对此表达式应用物质导数算符来计算气压的物质导数 $\\omega \\equiv \\frac{Dp}{Dt}$。\n$$\n\\omega = \\frac{D}{Dt} \\left[ A(\\eta) + B(\\eta)\\,p_{s}(x,y,t) \\right]\n$$\n对第二项使用乘法法则，我们得到：\n$$\n\\omega = \\frac{D(A(\\eta))}{Dt} + p_s \\frac{D(B(\\eta))}{Dt} + B(\\eta) \\frac{Dp_s}{Dt}\n$$\n对于只依赖于 $\\eta$ 的项 $A(\\eta)$ 和 $B(\\eta)$，我们应用链式法则：\n$$\n\\frac{D(A(\\eta))}{Dt} = \\frac{dA}{d\\eta} \\frac{D\\eta}{Dt} = A'(\\eta) \\frac{D\\eta}{Dt}\n$$\n$$\n\\frac{D(B(\\eta))}{Dt} = \\frac{dB}{d\\eta} \\frac{D\\eta}{Dt} = B'(\\eta) \\frac{D\\eta}{Dt}\n$$\n这里，$A'(\\eta)$ 和 $B'(\\eta)$ 表示 $A$ 和 $B$ 关于 $\\eta$ 的常导数。将这些代回 $\\omega$ 的表达式中：\n$$\n\\omega = A'(\\eta) \\frac{D\\eta}{Dt} + p_s \\left( B'(\\eta) \\frac{D\\eta}{Dt} \\right) + B(\\eta) \\frac{Dp_s}{Dt}\n$$\n我们可以提出因子 $\\frac{D\\eta}{Dt}$：\n$$\n\\omega = \\left( A'(\\eta) + B'(\\eta) p_s \\right) \\frac{D\\eta}{Dt} + B(\\eta) \\frac{Dp_s}{Dt}\n$$\n现在，我们求解 $\\frac{D\\eta}{Dt}$。问题陈述提供了地面气压物质导数的显式形式，即 $\\frac{D p_s}{D t} \\equiv \\partial_{t} p_{s} + u\\,\\partial_{x} p_{s} + v\\,\\partial_{y} p_{s}$。\n$$\n\\left( A'(\\eta) + B'(\\eta) p_s \\right) \\frac{D\\eta}{Dt} = \\omega - B(\\eta) \\frac{Dp_s}{Dt}\n$$\n假设坐标变换是非奇异的，即 $\\frac{\\partial p}{\\partial \\eta} = A'(\\eta) + B'(\\eta) p_s \\neq 0$，我们可以通过除法分离出 $\\frac{D\\eta}{Dt}$：\n$$\n\\frac{D\\eta}{Dt} = \\frac{\\omega - B(\\eta) \\frac{Dp_s}{Dt}}{A'(\\eta) + B'(\\eta) p_s}\n$$\n这就是所要求的表达式。\n\n2) 推导 $\\frac{D\\pi}{Dt}$ 的表达式。\n\n对数气压坐标 $\\pi$ 定义为：\n$$\n\\pi \\equiv \\ln\\left(\\frac{p_{0}}{p}\\right) = \\ln(p_0) - \\ln(p)\n$$\n其中 $p_0$ 是一个常数参考气压。我们通过应用算符 $\\frac{D}{Dt}$ 来计算 $\\pi$ 的物质导数：\n$$\n\\frac{D\\pi}{Dt} = \\frac{D}{Dt} \\left[ \\ln(p_0) - \\ln(p) \\right]\n$$\n因为 $p_0$ 是一个常数，其物质导数为零。\n$$\n\\frac{D\\pi}{Dt} = -\\frac{D}{Dt} \\left[ \\ln(p) \\right]\n$$\n对气压的函数使用物质导数的链式法则，我们有：\n$$\n\\frac{D(\\ln(p))}{Dt} = \\frac{d(\\ln(p))}{dp} \\frac{Dp}{Dt}\n$$\n$\\ln(p)$ 关于 $p$ 的导数是 $\\frac{1}{p}$。气压的物质导数由 $\\omega \\equiv \\frac{Dp}{Dt}$ 给出。\n$$\n\\frac{D(\\ln(p))}{Dt} = \\frac{1}{p} \\omega\n$$\n将此代回 $\\frac{D\\pi}{Dt}$ 的表达式中：\n$$\n\\frac{D\\pi}{Dt} = - \\frac{\\omega}{p}\n$$\n这就是所要求的用 $\\omega$ 和 $p$ 表示的闭式表达式。\n\n3) 推导 $w$ 的表达式。\n\n在指定的局部水平均匀且稳态的环境条件下，其中各场（如气压 $p$）仅依赖于几何高度 $z$，我们有 $\\frac{\\partial}{\\partial x} = 0$，$\\frac{\\partial}{\\partial y} = 0$，以及 $\\frac{\\partial}{\\partial t} = 0$。\n气压垂直速度 $\\omega$ 的定义是：\n$$\n\\omega = \\frac{Dp}{Dt}\n$$\n在笛卡尔坐标系 $(x,y,z)$ 中，物质导数 $\\frac{D}{Dt}$ 是：\n$$\n\\frac{D}{Dt} = \\frac{\\partial}{\\partial t} + u\\frac{\\partial}{\\partial x} + v\\frac{\\partial}{\\partial y} + w\\frac{\\partial}{\\partial z}\n$$\n将其应用于气压场 $p(z)$：\n$$\n\\omega = \\frac{\\partial p}{\\partial t} + u\\frac{\\partial p}{\\partial x} + v\\frac{\\partial p}{\\partial y} + w\\frac{\\partial p}{\\partial z}\n$$\n由于均匀性和稳态假设，前三项为零：$\\frac{\\partial p}{\\partial t} = 0$，$\\frac{\\partial p}{\\partial x} = 0$，$\\frac{\\partial p}{\\partial y} = 0$。$\\omega$ 的表达式简化为：\n$$\n\\omega = w \\frac{\\partial p}{\\partial z}\n$$\n现在，我们使用给定的物理定律来用热力学变量表示 $\\frac{\\partial p}{\\partial z}$。静力学关系是：\n$$\n\\frac{\\partial p}{\\partial z} = -\\rho g\n$$\n其中 $\\rho$ 是空气密度，$g$ 是重力加速度。干空气的理想气体定律是：\n$$\np = \\rho R_d T\n$$\n其中 $R_d$ 是干空气的比气体常数，$T$ 是温度。我们从理想气体定律中解出密度 $\\rho$：\n$$\n\\rho = \\frac{p}{R_d T}\n$$\n将这个 $\\rho$ 的表达式代入静力学关系中：\n$$\n\\frac{\\partial p}{\\partial z} = - \\left(\\frac{p}{R_d T}\\right) g = -\\frac{pg}{R_d T}\n$$\n最后，我们将 $\\frac{\\partial p}{\\partial z}$ 的这个结果代回 $\\omega$ 的简化方程中：\n$$\n\\omega = w \\left( -\\frac{pg}{R_d T} \\right)\n$$\n求解几何垂直速度 $w \\equiv \\frac{Dz}{Dt}$：\n$$\nw = -\\frac{\\omega R_d T}{pg}\n$$\n这就是所要求的用 $\\omega$、$p$、$T$、$g$ 和 $R_d$ 表示的 $w$ 的表达式。\n\n现将三个推导出的表达式汇总作为最终答案。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\omega - B(\\eta) \\frac{D p_s}{D t}}{A'(\\eta) + B'(\\eta) p_s}  -\\frac{\\omega}{p}  -\\frac{\\omega R_d T}{p g}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "从连续的物理理论到离散的数值实现，是数值天气预报和气候建模的核心环节。数值模型在网格上对连续方程进行近似，而本练习则演示了静力平衡这一基本原理如何在采用交错网格（Charney-Phillips 网格）的离散模型中得以精确维持。理解这种离散化方案是构建稳定和准确大气模拟的基石，它将抽象的坐标变换概念与模型计算的实际操作联系了起来。",
            "id": "4060936",
            "problem": "考虑一个数值天气预报和气候模拟系统中的单一垂直气柱，该系统使用地形追随混合eta坐标。混合eta坐标通过映射 $p(\\eta) = A(\\eta) + B(\\eta)\\,p_{s}$ 定义了每个半层的气压，其中 $p_{s}$ 是气柱底部的地表气压，$A(\\eta)$ 和 $B(\\eta)$ 是垂直坐标 $\\eta$ 的指定函数。假设该气柱采用 Charney–Phillips 垂直交错网格：位势 $\\Phi$ 定义在半层上，温度 $T$ 定义在整层上，使得每个温度值代表其边界半层气压之间的气层。流体是干燥的，并遵循理想气体定律 $p = \\rho R T$，其中 $\\rho$ 是密度，$R$ 是干空气的比气体常数。\n\n仅从静力平衡和理想气体定律出发，推导出一个离散层关系，该关系在温度 $T$ 存储于整层时，能确保气柱中的静力平衡是精确的。使用这个离散关系，计算在一个格点处，模式顶半层和地表半层之间的总位势厚度，该格点的地表气压为 $p_{s} = 9.5 \\times 10^{4}\\,\\text{Pa}$。该气柱有三层，其半层混合坐标系数和整层温度由以下给出：\n- 半层：$(A_{0}, B_{0}) = (1.0 \\times 10^{4}\\,\\text{Pa},\\,0)$，$(A_{1}, B_{1}) = (5.0 \\times 10^{3}\\,\\text{Pa},\\,0.3)$，$(A_{2}, B_{2}) = (2.0 \\times 10^{3}\\,\\text{Pa},\\,0.6)$，$(A_{3}, B_{3}) = (0\\,\\text{Pa},\\,1.0)$。\n- 整层温度：$T_{1} = 230\\,\\text{K}$（在半层0和1之间），$T_{2} = 240\\,\\text{K}$（在半层1和2之间），$T_{3} = 280\\,\\text{K}$（在半层2和3之间）。\n\n取干空气的比气体常数为 $R = 287\\,\\text{J}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}$。计算位势差 $\\Phi_{0} - \\Phi_{3}$，其中 $\\Phi_{0}$ 是模式顶半层的位势，$\\Phi_{3}$ 是地表半层的位势，假设每层的温度在其层内是恒定的，并等于其整层值。将最终答案以 $\\text{m}^{2}\\,\\text{s}^{-2}$ 为单位表示，并四舍五入到四位有效数字。",
            "solution": "目标是获得一个当温度存储在整层上（Charney–Phillips 交错网格）时与静力平衡一致的离散层关系。我们从基本关系式开始。\n\n静力平衡表示气压梯度和重力之间的垂直方向力平衡。其连续形式为\n$$\n\\frac{\\partial p}{\\partial z} = -\\rho g,\n$$\n其中 $p$ 是气压，$z$ 是几何高度，$\\rho$ 是密度，$g$ 是重力加速度。位势 $\\Phi$ 由下式定义\n$$\n\\frac{\\partial \\Phi}{\\partial z} = g.\n$$\n为了消去 $z$，我们根据静力平衡将微分 $dp$ 用 $dz$ 表示：\n$$\ndp = -\\rho g\\,dz \\quad \\Rightarrow \\quad dz = -\\frac{dp}{\\rho g}.\n$$\n代入位势微分的定义，\n$$\nd\\Phi = g\\,dz = g\\left(-\\frac{dp}{\\rho g}\\right) = -\\frac{1}{\\rho}\\,dp = -\\alpha\\,dp,\n$$\n其中 $\\alpha = \\frac{1}{\\rho}$ 是比容。使用理想气体定律 $p = \\rho R T$，我们得到 $\\alpha = \\frac{R T}{p}$，因此\n$$\nd\\Phi = -\\frac{R T}{p}\\,dp = -R T\\,d(\\ln p).\n$$\n这是对数气压形式下的连续静力关系。它表明，跨越一个有限气压区间的位势变化取决于层内温度和对数气压变化。\n\n在 Charney–Phillips 交错网格上，温度 $T$ 存储在整层，并被认为是其两个边界半层之间的层平均温度。对于一个由气压为 $p_{k-1/2}$ 的上半层和气压为 $p_{k+1/2}$ 的下半层所界定的单层，假设层平均温度 $T_{k}$ 在层内恒定，将上述微分式从上半层积分到下半层可得\n$$\n\\Phi_{k+1/2} - \\Phi_{k-1/2} \\;=\\; -\\int_{p_{k-1/2}}^{p_{k+1/2}} R T_{k}\\,\\frac{dp}{p} \\;=\\; -R T_{k}\\,\\left[\\ln p\\right]_{p_{k-1/2}}^{p_{k+1/2}} \\;=\\; -R T_{k}\\,\\ln\\!\\left(\\frac{p_{k+1/2}}{p_{k-1/2}}\\right).\n$$\n重新整理以表示位势厚度（上层减去下层）可得\n$$\n\\Phi_{k-1/2} - \\Phi_{k+1/2} \\;=\\; R T_{k}\\,\\ln\\!\\left(\\frac{p_{k+1/2}}{p_{k-1/2}}\\right).\n$$\n当 $T_{k}$ 是与由 $p_{k-1/2}$ 和 $p_{k+1/2}$ 界定的气层同位的层平均温度时，此离散层关系精确满足静力平衡。从模式顶半层到地表半层对各层求和，得到总位势厚度：\n$$\n\\Phi_{0} - \\Phi_{3} \\;=\\; \\sum_{k=1}^{3} R T_{k}\\,\\ln\\!\\left(\\frac{p_{k}}{p_{k-1}}\\right),\n$$\n其中 $p_{0}, p_{1}, p_{2}, p_{3}$ 分别是半层0, 1, 2, 3处的气压。\n\n我们现在根据混合eta映射 $p(\\eta) = A(\\eta) + B(\\eta)\\,p_{s}$ 和给定的系数以及地表气压 $p_{s} = 9.5 \\times 10^{4}\\,\\text{Pa}$ 计算半层气压：\n- 模式顶半层：$p_{0} = A_{0} + B_{0}\\,p_{s} = 1.0 \\times 10^{4} + 0 \\cdot (9.5 \\times 10^{4}) = 1.0 \\times 10^{4}\\,\\text{Pa}$。\n- 下一个半层：$p_{1} = A_{1} + B_{1}\\,p_{s} = 5.0 \\times 10^{3} + 0.3 \\cdot (9.5 \\times 10^{4}) = 5.0 \\times 10^{3} + 2.85 \\times 10^{4} = 3.35 \\times 10^{4}\\,\\text{Pa}$。\n- 再下一个半层：$p_{2} = A_{2} + B_{2}\\,p_{s} = 2.0 \\times 10^{3} + 0.6 \\cdot (9.5 \\times 10^{4}) = 2.0 \\times 10^{3} + 5.7 \\times 10^{4} = 5.9 \\times 10^{4}\\,\\text{Pa}$。\n- 地表半层：$p_{3} = A_{3} + B_{3}\\,p_{s} = 0 + 1.0 \\cdot (9.5 \\times 10^{4}) = 9.5 \\times 10^{4}\\,\\text{Pa}$。\n\n我们为每一层构造对数气压比：\n$$\n\\ln\\!\\left(\\frac{p_{1}}{p_{0}}\\right) = \\ln\\!\\left(\\frac{3.35 \\times 10^{4}}{1.0 \\times 10^{4}}\\right) = \\ln(3.35) \\approx 1.20906,\n$$\n$$\n\\ln\\!\\left(\\frac{p_{2}}{p_{1}}\\right) = \\ln\\!\\left(\\frac{5.9 \\times 10^{4}}{3.35 \\times 10^{4}}\\right) = \\ln\\!\\left(\\frac{59}{33.5}\\right) \\approx 0.56593,\n$$\n$$\n\\ln\\!\\left(\\frac{p_{3}}{p_{2}}\\right) = \\ln\\!\\left(\\frac{9.5 \\times 10^{4}}{5.9 \\times 10^{4}}\\right) = \\ln\\!\\left(\\frac{95}{59}\\right) \\approx 0.47630.\n$$\n\n使用 $R = 287\\,\\text{J}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}$ 和给定的温度，各层对位势厚度的贡献为\n$$\n\\Delta\\Phi_{1} = R T_{1}\\,\\ln\\!\\left(\\frac{p_{1}}{p_{0}}\\right) \\approx 287 \\times 230 \\times 1.20906 \\approx 7.9810 \\times 10^{4},\n$$\n$$\n\\Delta\\Phi_{2} = R T_{2}\\,\\ln\\!\\left(\\frac{p_{2}}{p_{1}}\\right) \\approx 287 \\times 240 \\times 0.56593 \\approx 3.8981 \\times 10^{4},\n$$\n$$\n\\Delta\\Phi_{3} = R T_{3}\\,\\ln\\!\\left(\\frac{p_{3}}{p_{2}}\\right) \\approx 287 \\times 280 \\times 0.47630 \\approx 3.8276 \\times 10^{4}.\n$$\n求和，\n$$\n\\Phi_{0} - \\Phi_{3} \\approx 7.9810 \\times 10^{4} + 3.8981 \\times 10^{4} + 3.8276 \\times 10^{4} \\approx 1.57067 \\times 10^{5}.\n$$\n四舍五入到四位有效数字并以 $\\text{m}^{2}\\,\\text{s}^{-2}$ 单位表示，结果为\n$$\n\\Phi_{0} - \\Phi_{3} \\approx 1.571 \\times 10^{5}.\n$$\n\n这种离散构造，在温度 $T$ 与整层同位的情况下，即使在 $p_{k\\pm 1/2}$ 通过 $A(\\eta)$ 和 $B(\\eta)$ 依赖于 $p_{s}$ 的地形追随混合坐标映射中，也能在层内温度 $T$ 恒定的假设下保证精确满足静力平衡。",
            "answer": "$$\\boxed{1.571 \\times 10^{5}}$$"
        }
    ]
}