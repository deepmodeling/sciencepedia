## 引言
在现代科学研究中，数值模型已成为预测天气、模拟气候变化以及探索其他星球大气奥秘不可或缺的工具。这些模型的准确性与可靠性，从根本上取决于其如何将描述流体运动的连续物理定律，转化为能够在计算机上稳定求解的离散[代数方程](@entry_id:272665)。这一转化的核心挑战在于，如何在离散化的过程中，既保持高精度，又严格遵守质量、动量和能量等基本物理量的守恒定律。完[全可压缩公式](@entry_id:1125370)与[守恒离散化](@entry_id:747709)正是为应对这一挑战而发展的理论与技术体系。

本文旨在为读者构建一个关于完全可压缩模型动力学核心的完整知识框架。我们将从最基本的物理原理出发，逐步深入到高级数值技术的设计细节及其在多学科领域的广泛应用。
- 在**“原理与机制”**一章中，我们将推导完全可压缩的[欧拉方程组](@entry_id:143098)，阐明[守恒形式](@entry_id:1122899)的优越性，并探讨[有限体积法](@entry_id:141374)如何自然地保证[离散守恒](@entry_id:1123819)性。我们还将深入分析保证数值解物理真实性（可实现性）与避免虚假能量产生（一致性）的关键设计原则。
- 在**“应用与跨学科联系”**一章中，我们将展示这些原理如何在真实大气模型中得到应用，例如如何处理水汽相变、耦合物理过程以及应对球体几何与复杂地形带来的挑战。此外，我们还将探索这些技术在航空航天、行星科学乃至岩土工程等领域的应用，彰显其普适性。
- 最后，**“动手实践”**部分提供了一系列精心设计的问题，旨在通过具体的计算练习，帮助读者巩固对[热力学](@entry_id:172368)关系、守恒通量计算以及高级数值格式的理解。

通过学习本文，读者将不仅掌握构建现代流体数值模型的核心理论，更能深刻理解其背后的物理思想与数学精髓，为进一步的研究与应用打下坚实的基础。

## 原理与机制

本章旨在深入阐述完[全可压缩公式](@entry_id:1125370)的物理与数学原理，并探讨其在[数值离散化](@entry_id:752782)过程中为保证精度和稳定性所需遵循的关键机制。我们将从基本的流体动力学守恒定律出发，逐步构建起一套完整的理论框架，用以理解现代大气与气候模型的核心动力学算法。

### 完全[可压缩流体](@entry_id:164617)[动力学方程组](@entry_id:202106)

对大气等可压缩流体的[数值模拟](@entry_id:146043)，其基础是一组描述质量、动量和能量如何随时间演化和在空间中输运的[偏微分](@entry_id:194612)方程。将这些方程写成[守恒形式](@entry_id:1122899)，是构建能够精确维持基本物理量守恒的数值格式的第一步。

#### [守恒形式](@entry_id:1122899)与守恒变量

一个物理过程如果可以用守恒定律来描述，那么其控制方程通常可以写作如下的**[守恒形式](@entry_id:1122899)（Conservative Form）**：
$$
\frac{\partial \mathbf{U}}{\partial t} + \nabla \cdot \mathbf{F}(\mathbf{U}) = \mathbf{S}
$$
在此方程中，$\mathbf{U}$ 是**[守恒变量](@entry_id:747720)（Conservative Variables）**的向量，代表单位体积内的物理量密度（例如质量密度、[动量密度](@entry_id:271360)等）。$\mathbf{F}(\mathbf{U})$ 是**通量张量（Flux Tensor）**，描述了这些[守恒量](@entry_id:161475)如何通过平流等机制在空间中输运。$\mathbf{S}$ 是**源项（Source Term）**向量，代表[守恒量](@entry_id:161475)的产生或耗散，例如重力或摩擦力的作用。这种形式的优雅之处在于它直接表达了物理量的局域平衡：一个微小控制体积内[守恒量](@entry_id:161475)的变化率，等于通过该体积边界的净通量与体积内源项的总和。

#### [欧拉方程组](@entry_id:143098)

对于一个无粘、绝热的理想流体，其运动由**[欧拉方程组](@entry_id:143098)（Euler Equations）**描述。在数值天气预报和气候模拟中，我们通常考虑一个包含了质量、动量和能量守恒的完整系统。

守恒变量向量 $\mathbf{U}$ 通常被定义为：
$$
\mathbf{U} = \begin{pmatrix} \rho \\ \rho\mathbf{u} \\ E \end{pmatrix}
$$
其中，$\rho$ 是流体**质量密度**，$\mathbf{u}$ 是**速度向量**，因此 $\rho\mathbf{u}$ 是**[动量密度](@entry_id:271360)**。$E$ 是单位体积流体的**总能量密度**，它由内部能量密度 $\rho e$ 和动能密度 $\frac{1}{2}\rho\|\mathbf{u}\|^2$ 组成，即 $E = \rho e + \frac{1}{2}\rho\|\mathbf{u}\|^2$。

与这些守恒变量相对应，在没有外部力源项的情况下，通量张量 $\mathbf{F}$ 的各个分量如下 ：

1.  **质量通量（Mass Flux）**：单位时间内通过单位面积的质量，由质量密度的平流造成。它是一个向量：
    $$
    \mathbf{f}_{\rho} = \rho\mathbf{u}
    $$

2.  **[动量通量](@entry_id:199796)（Momentum Flux）**：动量的输运由两部分组成：随流体运动的动量平流（$\rho\mathbf{u}\otimes\mathbf{u}$）和作用在[流体界面](@entry_id:197635)上的压力（$p\mathbf{I}$，其中 $\mathbf{I}$ 是单位张量）。它是一个[二阶张量](@entry_id:199780)：
    $$
    \mathbf{F}_{mom} = \rho\mathbf{u}\otimes\mathbf{u} + p\mathbf{I}
    $$
    这里的 $\otimes$ 表示[外积](@entry_id:147029)。压力项前的正号反映了压力作为一种内部作用力，从高压区推向低压区，从而产生[动量通量](@entry_id:199796)。

3.  **能量通量（Energy Flux）**：总能量的输运同样包含两部分：总能量随流体运动的平流（$E\mathbf{u}$）和压力在[流体界面](@entry_id:197635)上做功的功率（$p\mathbf{u}$）。它是一个向量：
    $$
    \mathbf{f}_{E} = (E+p)\mathbf{u}
    $$
    其中，$E+p$ 这一项被称为总焓密度。

因此，无源项的[欧拉方程组](@entry_id:143098)的完整[守恒形式](@entry_id:1122899)为：
$$
\frac{\partial}{\partial t} \begin{pmatrix} \rho \\ \rho\mathbf{u} \\ E \end{pmatrix} + \nabla \cdot \begin{pmatrix} \rho\mathbf{u} \\ \rho\mathbf{u}\otimes\mathbf{u} + p\mathbf{I} \\ (E+p)\mathbf{u} \end{pmatrix} = \mathbf{0}
$$

值得注意的是，在[数值模拟](@entry_id:146043)中，我们直接求解的是守恒变量 $(\rho, \rho\mathbf{u}, E)$ 的演化。然而，在物理上我们更直观理解的是**[原始变量](@entry_id:753733)（Primitive Variables）**，如密度 $\rho$、速度 $\mathbf{u}$、压力 $p$ 和温度 $T$。从守恒变量恢复[原始变量](@entry_id:753733)是模型计算中必不可少的一步，例如，速度可以通过 $\mathbf{u} = (\rho\mathbf{u})/\rho$ 计算得出 。

#### [热力学](@entry_id:172368)封闭

上述[欧拉方程组](@entry_id:143098)包含的变量比方程多：我们有 $\rho$, $\mathbf{u}$, $E$ 和 $p$ 四个未知量（或在三维情况下有5个标量未知数），但只有质量、动量和能量三个方程（或5个标量方程）。为了使方程组封闭，我们必须引入一个额外的关系式，将压力 $p$ 与[守恒变量](@entry_id:747720)联系起来。这个关系式被称为**[状态方程](@entry_id:274378)（Equation of State）**。

对于干燥大气，通常可以近似为**量热完全理想气体（Calorically Perfect Ideal Gas）**，其热力学性质由几个基本关系确定 ：
- [理想气体状态方程](@entry_id:137803)：$p = \rho R T$，其中 $R$ 是比气体常数。
- 比内能：$e = c_v T$，其中 $c_v$ 是定容比热。
- 比焓：$h = c_p T$，其中 $c_p$ 是定压比热。

对于[理想气体](@entry_id:200096)，这些常数满足**迈耶关系（Mayer's Relation）**：$c_p - c_v = R$。

我们的目标是将压力 $p$ 表示为守恒变量 $(\rho, \rho\mathbf{u}, E)$ 的函数。首先，我们可以从总能量密度 $E$ 中分离出内能密度 $\rho e$：
$$
\rho e = E - \frac{1}{2}\rho\|\mathbf{u}\|^2
$$
将[动量密度](@entry_id:271360) $\rho\mathbf{u}$ 和密度 $\rho$ 代入，可以计算出 $\rho e$。

接下来，我们将压力与内能联系起来。由 $e = c_v T$ 和 $T = p/(\rho R)$，可得：
$$
e = c_v \frac{p}{\rho R} \implies p = \frac{R}{c_v}\rho e
$$
利用迈耶关系 $R = c_p - c_v$ 和比热比 $\gamma = c_p/c_v$，我们得到：
$$
p = \left(\frac{c_p - c_v}{c_v}\right)\rho e = (\gamma - 1)\rho e
$$
最后，将 $\rho e$ 的表达式代入，我们便得到了最终的**[热力学](@entry_id:172368)封闭关系**：
$$
p = (\gamma-1)\left(E - \frac{1}{2}\rho\|\mathbf{u}\|^2\right)
$$
这个方程使得压力 $p$ 可以完全由[守恒变量](@entry_id:747720) $(\rho, \rho\mathbf{u}, E)$ 确定，从而使整个方程组得以封闭。

### 离散化基本原则：[有限体积法](@entry_id:141374)

将连续的守恒律方程转化为可以在计算机上求解的代数方程，这一过程称为**离散化**。**[有限体积法](@entry_id:141374)（Finite-Volume Method, FVM）**是一种特别适合求解守恒律方程的数值方法，因为它天然地尊重了物理量的守恒特性。

#### [离散守恒](@entry_id:1123819)性

[有限体积法](@entry_id:141374)的核心思想是将计算区域划分为一系列不重叠的控制体积（或单元），然后对每个控制体积内的守恒律方程进行积分。对于任意一个控制体积 $V_i$，[守恒律的积分形式](@entry_id:174909)为：
$$
\frac{d}{dt} \int_{V_i} \mathbf{U} \,dV + \oint_{\partial V_i} \mathbf{F} \cdot \mathbf{n} \,dS = \int_{V_i} \mathbf{S} \,dV
$$
其中 $\partial V_i$ 是体积 $V_i$ 的边界，$\mathbf{n}$ 是边界上的外法向[单位向量](@entry_id:165907)。

该方程表明，控制体积内[守恒量](@entry_id:161475) $\int \mathbf{U} \,dV$ 的变化率等于通过其边界的净通量。在数值格式中，我们求解的是单元平均值 $\bar{\mathbf{U}}_i = \frac{1}{|V_i|} \int_{V_i} \mathbf{U} \,dV$。其半离散形式（只[离散空间](@entry_id:155685)，保留时间连续）为：
$$
\frac{d\bar{\mathbf{U}}_i}{dt} = - \frac{1}{|V_i|} \sum_{j} \mathcal{F}_{ij} S_{ij} + \bar{\mathbf{S}}_i
$$
其中，$\mathcal{F}_{ij}$ 是通过单元 $i$ 和相邻单元 $j$ 共享的交界面上的**数值通量**， $S_{ij}$ 是该交界面的面积。

一个**守恒的数值格式**的关键特性在于，跨越两个相邻单元（$i$ 和 $j$）之间界面的通量是单值的，即从单元 $i$ 流向 $j$ 的通量等于从 $j$ 流向 $i$ 的通量的[相反数](@entry_id:151709)。当我们对整个计算区域的所有单元求和时，所有内部界面上的通量都会成对地、精确地抵消（形成一个“伸缩求和”）。如果边界是封闭的或周期的，那么边界通量之和也为零。其结果是，在没有源项的情况下，整个区域内[守恒量](@entry_id:161475)的总量 $\sum_i \bar{\mathbf{U}}_i |V_i|$ 在离散意义上是守恒的，其变化仅由[浮点运算](@entry_id:749454)的舍入误差引起 。

这种宝贵的**[离散守恒](@entry_id:1123819)性**是直接对[守恒形式](@entry_id:1122899)的方程进行有限体积离散化的自然结果。如果选择对非守恒的[原始变量](@entry_id:753733)（如 $\mathbf{u}$ 或 $p$）方程进行离散，通常无法保证这种通量的精确抵消，从而无法保证动量或能量的[离散守恒](@entry_id:1123819)。

#### [可实现性约束](@entry_id:1130703)

一个成功的数值模型不仅要守恒，还必须保证其解在物理上是**可实现的（Realizable）**。这意味着模型的输出必须时刻满足基本的物理约束 。

对于可压缩大气模型，最重要的**[可实现性约束](@entry_id:1130703)**包括：
1.  **正密度（Positive Density）**：$\rho > 0$。质量密度不可能是负值。
2.  **正压力（Positive Pressure）**：$p > 0$。在经典物理中，宏观压力是[分子运动](@entry_id:140498)的结果，必须为正。
3.  **有界示踪物（Bounded Tracers）**：对于水分或其他物质的[质量分数](@entry_id:161575) $q_i$，其值必须在 $[0, 1]$ 区间内。

这些约束不仅是物理上的要求，对于模型的数学有效性和数值稳定性也至关重要。
- **[双曲性](@entry_id:262766)（Hyperbolicity）**：[欧拉方程组](@entry_id:143098)是一个[双曲型偏微分方程](@entry_id:1126291)系统，这意味着信息以有限的速度（特征[波速](@entry_id:186208)）传播。这些[波速](@entry_id:186208)，特别是声波速 $c$，是通过通量雅可比矩阵的特征值给出的。对于[理想气体](@entry_id:200096)，声速的平方满足 $c^2 = \gamma p / \rho$。如果 $\rho$ 或 $p$ 变为负值， $c^2$ 将为负，导致声速 $c$ 成为虚数。这将破坏系统的双曲性，使其在时间上变为椭圆型，导致数值解的瞬时崩溃。
- **[状态方程](@entry_id:274378)的有效性**：如果一个水分质量分数 $q_i$ 变得小于0或大于1，那么混合气体的平均[热力学性质](@entry_id:146047)（如比热容）可能会变得毫无物理意义，进而导致从内能反算温度的过程失败。

一个常见的误解是，只要数值格式是守恒的，[可实现性](@entry_id:193701)就能被自动满足。事实并非如此。标准的高阶线性格式（例如，二阶及以上精度的格式）在处理陡峭梯度（如锋面或冲击波）时会不可避免地产生非物理的振荡（[吉布斯现象](@entry_id:138701)），这些振荡很容易使一个正定物理量（如密度）的数值解在某些网格点上变为负值。因此，现代高分辨率格式必须采用[非线性](@entry_id:637147)的**[通量限制器](@entry_id:171259)（Flux Limiters）**或其他类似技术来抑制这些振荡，从而在保持[高阶精度](@entry_id:750325)的同时强制满足[可实现性约束](@entry_id:1130703)。

### 数值格式的设计与一致性

保证[离散守恒](@entry_id:1123819)性只是设计一个可靠数值格式的起点。为了避免产生非物理的人为效应（如虚假加热或冷却），离散算子的定义必须遵循严格的**一致性（Consistency）**原则。

#### 动能与内能的转换：[数值加热](@entry_id:1128967)问题

在连续的[欧拉方程](@entry_id:177914)中，总能量是守恒的，但动能和内能之间可以相互转换。这种转换由压力做功来协调。动能的变化率源于压力梯度项 $\mathbf{u} \cdot \nabla p$，而内能的变化率源于[压力-体积功](@entry_id:139224)项 $p \nabla \cdot \mathbf{u}$。这两个项通过以下恒等式联系在一起，并共同构成总能量通量中的压力功部分 $\nabla \cdot (p \mathbf{u})$ ：
$$
\nabla \cdot (p \mathbf{u}) = \mathbf{u} \cdot \nabla p + p \nabla \cdot \mathbf{u}
$$
在离散格式中，这个“[乘法法则](@entry_id:144424)”恒等式并不会自动成立。动量方程中的压力梯度项和能量方程中的压力功项如果采用不一致的离散方式，就会打破这种精确的平衡。例如，如果用于计算动量通量的界面压力 $p_f$ 与用于计算[能量通量](@entry_id:266056)的界面速度 $\mathbf{u}_f$ 的定义方式不协调，就会导致动能向内能的转换出现一个非零的残差。即使在物理上能量应该守恒的[均匀流](@entry_id:272775)场中，这种不一致性也会导致人为的[动能耗散](@entry_id:751026)和内能增加，即**虚假[数值加热](@entry_id:1128967)（Spurious Numerical Heating）**。

为了避免这种现象，数值格式的设计必须确保离散的压力梯度、散度和通量项之间满足一个离散的[乘法法则](@entry_id:144424)模拟。这通常要求在动量和能量通量的计算中使用在代数上相容的界面速度和压力值。

#### 热力学一致性

虚假加热问题的一个更深层次的根源在于**[热力学一致性](@entry_id:138886)**。[能量通量](@entry_id:266056) $(E+p)\mathbf{u}$ 可以写作总焓通量 $(\rho H)\mathbf{u}$，其中 $H = h + \frac{1}{2}\|\mathbf{u}\|^2$ 是比[总焓](@entry_id:197863)。在离散层面，[能量通量](@entry_id:266056)的计算依赖于界面上的焓值 $\hat{h}$，而[动量通量](@entry_id:199796)的计算则依赖于界面上的压力值 $\hat{p}$。

为了保证动能和内能转换的正确性，离散的界面值必须满足[热力学恒等式](@entry_id:142524) $h = e + p/\rho$ 的一个离散模拟 ：
$$
\hat{h} = \hat{e} + \hat{p}/\hat{\rho}
$$
假设在模型的不同部分（例如，动力核心和物理参数化）中，用于计算压力、内能和焓的[热力学](@entry_id:172368)常数（$R, c_v, c_p$）存在微小差异。例如，[动量通量](@entry_id:199796)使用 $R_{mom}$ 计算压力，而能量通量使用 $c_{p,E}$ 和 $c_{v,E}$ 计算焓和内能。那么，为了满足上述[一致性条件](@entry_id:637057)，必须有：
$$
c_{p,E} \hat{T} = c_{v,E} \hat{T} + \frac{\hat{\rho} R_{mom} \hat{T}}{\hat{\rho}} \implies c_{p,E} - c_{v,E} = R_{mom}
$$
如果这组常数不满足迈耶关系，一个虚假的能量源或汇就会在每个时间步中被引入模型，导致总能量的[长期漂移](@entry_id:172399)。因此，一个设计良好的数值模型必须在所有组件中全局地、严格地使用一组满足 $c_p - c_v = R$ 的[热力学](@entry_id:172368)常数。

#### 大气模型中的源项与守恒性

实际的大气模型必须考虑重力和[地球自转](@entry_id:166596)（科里奥利力）等外力。这些力在[动量方程](@entry_id:197225)中作为源项出现 ：
$$
\frac{\partial (\rho \mathbf{u})}{\partial t} + \nabla \cdot (\rho \mathbf{u} \otimes \mathbf{u} + p \mathbf{I}) = -\rho \nabla \Phi - 2\rho \boldsymbol{\Omega} \times \mathbf{u}
$$
其中 $\Phi$ 是重力势（通常 $\Phi = gz$），$\boldsymbol{\Omega}$ 是地球自转[角速度](@entry_id:192539)向量。

这些源项的引入对能量守恒提出了新的要求。
- **科里奥利力（Coriolis Force）**：由于科里奥利力 $-2\rho \boldsymbol{\Omega} \times \mathbf{u}$ 始终与速度 $\mathbf{u}$ 垂直，它对流体不做功（$\mathbf{u} \cdot (-2\rho \boldsymbol{\Omega} \times \mathbf{u}) = 0$）。因此，在离散格式中，代表科里奥利力的算子 $\mathcal{C}$ 必须是**斜对称的（skew-symmetric）**，以确保它在离散意义上也不做功，从而不产生虚假的能量。

- **重力（Gravity）**：重力做功会引起动能和势能的转换。为了在模型中精确地描述这一过程，总能量必须包含重力势能。新的守恒总能量密度应定义为 $E_t = \rho(e + \frac{1}{2}\|\mathbf{u}\|^2 + \Phi)$。通过代数推导可以证明，对于这个新的总能量 $E_t$，其守恒方程不含源项：
  $$
  \frac{\partial E_t}{\partial t} + \nabla \cdot \left[ (E_t + p) \mathbf{u} \right] = 0
  $$
  在离散化时，为了确保重力所做的功在动能和势能之间正确转换，必须采用一致的输运方案。一个标准的做法是，用于输运质量 $\rho$ 的离散质量通量，也必须被用于输运重力势能 $\rho\Phi$。这种一致性保证了能量转换项在离散加和中能够精确抵消。

#### 位温与Exner函数：一种更优雅的表述

在绝热无粘的流动中，除了质量、动量和能量外，熵也是守恒的。在大气科学中，我们通常使用**位温（Potential Temperature）** $\theta$ 作为熵的等价变量。位温和**Exner函数** $\Pi$ 的定义如下 ：
$$
\theta \equiv T \left(\frac{p_0}{p}\right)^{R/c_p}, \qquad \Pi \equiv \left(\frac{p}{p_0}\right)^{R/c_p}
$$
其中 $p_0$ 是一个参考压力。可以证明，比熵 $s$ 与位温之间存在简单关系 $s = c_p \ln \theta + \text{const}$。因此，在绝热过程中，位温是一个[守恒量](@entry_id:161475)：$D\theta/Dt = 0$。

在数值模型中，使用 $\theta$ 和 $\Pi$ 作为[热力学变量](@entry_id:160587)有诸多优点。其中一个关键优点是它们简化了压力[梯度力](@entry_id:166847)的表达。可以推导出以下恒等式：
$$
\frac{1}{\rho}\nabla p = c_p \theta \nabla \Pi
$$
这个形式在设计能量守恒的[非静力模型](@entry_id:1128852)中特别有用，因为它将压力[梯度力](@entry_id:166847)分解为一个[热力学变量](@entry_id:160587) $\theta$ 和一个动力学变量 $\Pi$ 的梯度，有助于构造能够精确保持动能和内能转换平衡的离散格式。此外，当考虑非绝热加热 $Q$（单位质量的加热率）时，位温的[演化方程](@entry_id:268137)形式简洁：
$$
\frac{D\theta}{Dt} = \frac{Q}{c_p \Pi}
$$
这表明，相同的加热率在低压（高空，$\Pi$ 较小）处对位温的改变更有效。

### 离散格式的高级论题：[平衡态](@entry_id:270364)与复杂地形

除了基本的守恒性和一致性，高级的大气模型还必须能够精确地模拟地球大气中的特定物理[平衡态](@entry_id:270364)，尤其是在存在复杂地形的情况下。

#### [静力平衡](@entry_id:163498)与守善格式

在行星尺度上，大气在垂直方向上很大程度上处于**[静力平衡](@entry_id:163498)（Hydrostatic Equilibrium）**状态，即[垂直压力梯度](@entry_id:1133794)力与重力精确平衡：
$$
\frac{\partial p}{\partial z} = -\rho g
$$
在这种状态下，大气是静止的（$\mathbf{u}=\mathbf{0}$）。然而，一个标准的有限体积格式在离散一个静止的、满足[静力平衡](@entry_id:163498)的大气时，其离散的压力梯度项和重力源项通常不会精确地为零。它们的残差，尽管很小，但会产生虚假的垂直加速度，破坏静止状态。

为了解决这个问题，需要设计**守善格式（Well-Balanced Scheme）**。一个守善格式被特殊设计，以保证当输入一个满足离散[静力平衡](@entry_id:163498)的态时，离散的压力[梯度力](@entry_id:166847)和重力源项能够代数上精确抵消，从而使计算出的加速度为机器零。这种特性对于准确模拟在近乎平衡的背景态上叠加的微小扰动（如重力波）至关重要。

#### 地形追随坐标系中的压力[梯度力](@entry_id:166847)误差

为了更好地解析地表附近的边界层流动，绝大多数全球和区域大气模型都采用了**地形追随坐标系（Terrain-Following Coordinates）**。在这种坐标系中，垂直坐标面不再是水平的，而是随地形起伏。

这带来了一个严重的数值挑战。在[笛卡尔坐标系](@entry_id:169789)中，[静力平衡](@entry_id:163498)下水平压力梯度为零。但在地形追随坐标系 $(x,s)$ 中，水平压力梯度 $\left. \frac{\partial p}{\partial x} \right|_z$ 经过坐标变换后，会分解为两个项 ：
$$
\left. \frac{\partial p}{\partial x} \right|_z = \left. \frac{\partial p}{\partial x} \right|_s - \frac{\partial p}{\partial z} \frac{\partial z}{\partial x}
$$
在[静力平衡](@entry_id:163498)下（$\frac{\partial p}{\partial z} = -\rho g$），这个表达式变为：
$$
\left. \frac{\partial p}{\partial x} \right|_z = \left. \frac{\partial p}{\partial x} \right|_s + \rho g \frac{\partial z}{\partial x}
$$
在陡峭地形区域，坐标面倾斜，$\frac{\partial z}{\partial x}$ 很大。因此，右侧的两个项——沿坐标面的压力梯度和由坐标面倾斜引起的静力分量——都会变得非常大，但它们的符号相反，其和在连续情况下精确为零。

然而，在离散计算中，如果对这两个大项使用不一致的离散方法，它们的差将不再为零，而是产生一个与地形坡度相关的巨大误差，即**压力[梯度力](@entry_id:166847)计算误差**。这个误差会产生强烈的虚假水平风，完全破坏模拟的真实性。

解决这一问题的现代方法是采用与处理[静力平衡](@entry_id:163498)类似的守善思想：设计一种“链式法则相容”的离散分裂方法，确保在离散层面，这两个大项的计算方式在代数上是相互一致的，从而使它们能够精确抵消，即使在最陡峭的地形上也能维持静止大气的平衡。