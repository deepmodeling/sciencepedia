{
    "hands_on_practices": [
        {
            "introduction": "尽管标准的半拉格朗日方法因其允许采用较大的时间步长而备受青睐，但在使用简单的线性插值时，它存在一个根本性的缺陷：它本身并不保证质量守恒。本练习将通过一个具体的数值算例来揭示这一问题。通过手动计算单个时间步内标量的总质量变化，您将能清晰地理解质量为何以及如何未能守恒 。",
            "id": "4062339",
            "problem": "考虑一个用于数值天气预报 (NWP) 的一维周期性区域，该区域被一个均匀网格离散化，网格间距为 $\\Delta x = 1$（无量纲），网格点索引为 $i=0,1,2,3$。一个被动标量 $q(x,t)$ 满足平流方程 $\\partial q / \\partial t + u(x,t) \\, \\partial q / \\partial x = 0$。在半拉格朗日 (SL) 方法中，假定 $q$ 沿轨迹线为常数，并且在时间 $t^{n+1}$ 时每个网格点 $x_i$ 的更新值是通过对出发点 $x_i - u(x_i,t^n)\\,\\Delta t$ 处的值进行采样得到的，该值由时间 $t^n$ 时最近的两个上游网格点的值通过线性插值近似得出。应用周期性边界条件，因此索引运算按模 $4$ 进行。\n\n在时间 $t^n$ 时，网格点上的标量场由 $q_i^n$ 给出：\n$$\nq_0^n = 3,\\quad q_1^n = 1,\\quad q_2^n = 0,\\quad q_3^n = 2.\n$$\n使用时间步长 $\\Delta t = 1$（无量纲）。速度场在该步长内是定常的，并在到达网格点上指定为\n$$\nu(x_0,t^n) = 0.2,\\quad u(x_1,t^n) = 0.6,\\quad u(x_2,t^n) = 0.8,\\quad u(x_3,t^n) = 0.4.\n$$\n假设每个出发点 $x_i - u(x_i,t^n)\\,\\Delta t$ 都位于区间 $[x_{i-1},x_i]$ 内，因此使用 $q_{i-1}^n$ 和 $q_i^n$ 之间的线性插值。令 $\\alpha_i = u(x_i,t^n)\\,\\Delta t / \\Delta x$ 表示网格点 $i$ 处的局部库朗数。\n\n将时间 $t^n$ 和 $t^{n+1}$ 的离散的、区域积分的标量含量定义为\n$$\nM^n = \\sum_{i=0}^{3} q_i^n \\,\\Delta x,\\qquad M^{n+1} = \\sum_{i=0}^{3} q_i^{n+1} \\,\\Delta x,\n$$\n其中 $\\Delta x = 1$（无量纲）。使用所述的半拉格朗日线性插值更新方法，计算一个时间步长内离散含量的净变化，\n$$\n\\Delta M = M^{n+1} - M^n,\n$$\n并将您的最终答案表示为一个纯数（无量纲）。无需四舍五入；请提供精确值。",
            "solution": "该问题要求使用带有线性插值的半拉格朗日 (SL) 平流格式，计算一个离散标量在一个时间步长内的变化。\n\n首先，我们建立数值格式。半拉格朗日方法通过沿时间向后追溯轨迹至时间 $t^n$ 时的出发点 $x_{d,i}$，并取该点处的标量场值，来更新时间 $t^{n+1}$ 时网格点 $x_i$ 的值。新时间的值为 $q_i^{n+1} = q^n(x_{d,i})$。出发点由 $x_{d,i} = x_i - u(x_i, t^n) \\Delta t$ 给出。\n\n问题指明 $q^n(x_{d,i})$ 的值由最近的两个上游网格点的值通过线性插值近似得到。问题陈述出发点 $x_i - u(x_i,t^n)\\,\\Delta t$ 位于区间 $[x_{i-1},x_i]$ 内。出发点相对于网格的位置由局部库朗数 $\\alpha_i = u(x_i,t^n)\\,\\Delta t / \\Delta x$ 确定。\n出发点可以写作 $x_{d,i} = x_i - \\alpha_i \\Delta x$。该点位于 $x_i$ 上游 $\\alpha_i$ 的分数距离处，在单元 $[x_{i-1}, x_i]$ 内。\n\n使用周围网格点的值 $q_{i-1}^n$ 和 $q_i^n$ 对 $x_{d,i}$ 处的值进行线性插值，公式如下：\n$$q_i^{n+1} = w_{i} q_i^n + w_{i-1} q_{i-1}^n$$\n其中权重 $w_i$ 和 $w_{i-1}$ 取决于 $x_{d,i}$ 的位置。每个网格点的权重与出发点到*另一个*网格点的距离成正比。\n从 $x_{d,i}$ 到 $x_i$ 的距离是 $\\alpha_i \\Delta x$。\n从 $x_{d,i}$ 到 $x_{i-1}$ 的距离是 $(x_i - \\alpha_i \\Delta x) - x_{i-1} = (x_i - x_{i-1}) - \\alpha_i \\Delta x = \\Delta x - \\alpha_i \\Delta x = (1-\\alpha_i) \\Delta x$。\n用区间长度 $\\Delta x$ 进行归一化，权重为：\n$w_i = \\frac{(1-\\alpha_i) \\Delta x}{\\Delta x} = 1 - \\alpha_i$\n$w_{i-1} = \\frac{\\alpha_i \\Delta x}{\\Delta x} = \\alpha_i$\n因此，带有线性插值的半拉格朗日格式的更新公式为：\n$$q_i^{n+1} = (1 - \\alpha_i) q_i^n + \\alpha_i q_{i-1}^n$$\n该公式适用于每个网格点 $i \\in \\{0, 1, 2, 3\\}$，由于周期性边界条件，索引运算按模 4 进行（即，$q_{-1}^n = q_3^n$）。\n\n给定的数据是：\n网格间距：$\\Delta x = 1$。\n时间步长：$\\Delta t = 1$。\n初始标量值：$q_0^n = 3$, $q_1^n = 1$, $q_2^n = 0$, $q_3^n = 2$。\n速度值：$u(x_0,t^n) = 0.2$, $u(x_1,t^n) = 0.6$, $u(x_2,t^n) = 0.8$, $u(x_3,t^n) = 0.4$。为简洁起见，我们将其表示为 $u_0, u_1, u_2, u_3$。\n\n首先，我们计算局部库朗数 $\\alpha_i = u_i \\Delta t / \\Delta x$：\n$\\alpha_0 = 0.2 \\times 1 / 1 = 0.2$\n$\\alpha_1 = 0.6 \\times 1 / 1 = 0.6$\n$\\alpha_2 = 0.8 \\times 1 / 1 = 0.8$\n$\\alpha_3 = 0.4 \\times 1 / 1 = 0.4$\n与问题陈述一致，所有的 $\\alpha_i$ 都在区间 $[0,1]$ 内。\n\n现在，我们为每个 $i \\in \\{0, 1, 2, 3\\}$ 计算 $q_i^{n+1}$：\n对于 $i=0$：$q_0^{n+1} = (1 - \\alpha_0) q_0^n + \\alpha_0 q_{-1}^n = (1 - 0.2) q_0^n + 0.2 q_3^n = 0.8(3) + 0.2(2) = 2.4 + 0.4 = 2.8$。\n对于 $i=1$：$q_1^{n+1} = (1 - \\alpha_1) q_1^n + \\alpha_1 q_0^n = (1 - 0.6) q_1^n + 0.6 q_0^n = 0.4(1) + 0.6(3) = 0.4 + 1.8 = 2.2$。\n对于 $i=2$：$q_2^{n+1} = (1 - \\alpha_2) q_2^n + \\alpha_2 q_1^n = (1 - 0.8) q_2^n + 0.8 q_1^n = 0.2(0) + 0.8(1) = 0.0 + 0.8 = 0.8$。\n对于 $i=3$：$q_3^{n+1} = (1 - \\alpha_3) q_3^n + \\alpha_3 q_2^n = (1 - 0.4) q_3^n + 0.4 q_2^n = 0.6(2) + 0.4(0) = 1.2 + 0.0 = 1.2$。\n\n时间 $t^{n+1}$ 时的标量场为：$q_0^{n+1} = 2.8$, $q_1^{n+1} = 2.2$, $q_2^{n+1} = 0.8$, $q_3^{n+1} = 1.2$。\n\n接下来，我们计算时间 $t^n$ 和 $t^{n+1}$ 时的离散标量总含量。总含量定义为 $M = \\sum_{i=0}^{3} q_i \\Delta x$。由于 $\\Delta x=1$，这只是 $q_i$ 值的总和。\n\n在时间 $t^n$ 时：\n$$M^n = \\sum_{i=0}^{3} q_i^n = q_0^n + q_1^n + q_2^n + q_3^n = 3 + 1 + 0 + 2 = 6$$\n\n在时间 $t^{n+1}$ 时：\n$$M^{n+1} = \\sum_{i=0}^{3} q_i^{n+1} = q_0^{n+1} + q_1^{n+1} + q_2^{n+1} + q_3^{n+1} = 2.8 + 2.2 + 0.8 + 1.2 = 7.0$$\n\n最后，一个时间步长内离散含量的净变化为：\n$$\\Delta M = M^{n+1} - M^n = 7.0 - 6.0 = 1.0$$\n\n非零的变化 $\\Delta M$ 表明带有线性插值的半拉格朗日格式不是严格守恒的。这种非守恒性源于信息在网格上收集和分布的不对称性。根据构造，到达一个网格点的值的插值权重之和为1，但从一个网格点出发到其邻近点的值的权重之和不一定为1。\n\n总含量的变化也可以通过符号推导得出：\n$$M^{n+1} = \\sum_{i} q_i^{n+1} = \\sum_{i} [(1-\\alpha_i)q_i^n + \\alpha_i q_{i-1}^n] = \\sum_i q_i^n - \\sum_i \\alpha_i q_i^n + \\sum_i \\alpha_i q_{i-1}^n$$\n$$\\Delta M = M^{n+1} - M^n = \\sum_i \\alpha_i q_{i-1}^n - \\sum_i \\alpha_i q_i^n = \\sum_i \\alpha_i (q_{i-1}^n - q_i^n)$$\n使用给定值通过此公式验证结果：\n$\\Delta M = \\alpha_0(q_3^n - q_0^n) + \\alpha_1(q_0^n - q_1^n) + \\alpha_2(q_1^n - q_2^n) + \\alpha_3(q_2^n - q_3^n)$\n$\\Delta M = 0.2(2-3) + 0.6(3-1) + 0.8(1-0) + 0.4(0-2)$\n$\\Delta M = 0.2(-1) + 0.6(2) + 0.8(1) + 0.4(-2) = -0.2 + 1.2 + 0.8 - 0.8 = 1.0$。\n符号推导证实了数值结果。最终答案是一个纯粹的无量纲数。",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "明确了非守恒问题之后，我们现在引入一种解决方案：从有限体积的角度重新构建半拉格朗日方法。该方法不再是插值点值，而是将质量从出发网格“重映射”到到达网格。本练习将引导您推导并应用一个一维的守恒重映射方案，通过追踪出发与到达网格之间的重叠区域，阐明如何确保质量的精确守恒 。",
            "id": "4062354",
            "problem": "考虑一个被动标量质量密度 $\\rho(x,t)$ 在周期性域 $[0,L)$ 上被恒定速度场 $u$ 进行一维纯平流。该域被离散为 $N$ 个宽度为 $\\Delta x$ 的均匀单元，其中单元 $i$ 占据 $[x_{i-\\frac{1}{2}},x_{i+\\frac{1}{2}})$，在时间 $t^n$ 的单元积分质量为 $m_i^n = \\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} \\rho(x,t^n)\\,dx$。其控制定律是物质控制体质量守恒的积分形式：在纯平流作用下，一个物质区间内包含的质量不随时间变化。\n\n在一个时间步 $\\Delta t$ 内，一个通量形式的守恒半拉格朗日更新将时间 $t^{n+1}$ 的欧拉到达单元 $i$ 映射到其在时间 $t^n$ 的出发区间。假设在每个单元上对 $\\rho(\\cdot,t^n)$ 进行分段常数重构，其值等于单元平均值 $\\rho_j^n = m_j^n/\\Delta x$。\n\n- 域和网格：$L = 5$ km, $N = 5$, $\\Delta x = 1$ km，周期性边界条件。\n- 速度和时间步长：$u = 0.365$ km s$^{-1}$, $\\Delta t = 2$ s。\n- 时间 $t^n$ 的初始单元积分质量（单位：千克）：$m_1^n = 1200$, $m_2^n = 2100$, $m_3^n = 1500$, $m_4^n = 300$, $m_5^n = 900$。\n\n任务：\n1. 从物质区间的质量守恒积分形式和恒定 $u$ 下出发区间的定义出发，推导用分段常数 $\\rho_j^n$ 以及单元 $i$ 的出发区间与贡献单元之间的一维重叠长度来更新 $m_i^{n+1}$ 的守恒重映射表达式。将讨论限制在 $0  s  \\Delta x$ 的情况，其中 $s = u\\,\\Delta t$ 是一个时间步内的平流位移大小，并明确指出对于给定的到达单元 $i$ 出现的两个重叠长度。\n2. 对于到达单元 $i=3$，计算两个重叠长度的数值，然后使用上述分段常数重构计算 $m_3^{n+1}$。\n\n将 $m_3^{n+1}$ 的最终数值答案以千克（kg）为单位表示，并四舍五入到四位有效数字。",
            "solution": "**任务 1：推导守恒重映射表达式**\n\n基本原理是物质控制体中的质量守恒。在半拉格朗日框架中，我们考虑到达时间 $t^{n+1}$ 的一个固定的欧拉网格单元，并将其体积追溯到它在时间 $t^n$ 的出发位置。\n\n根据定义，在时间 $t^{n+1}$，到达单元 $i$（表示为 $C_i = [x_{i-\\frac{1}{2}}, x_{i+\\frac{1}{2}})$）中的质量为：\n$$ m_i^{n+1} = \\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} \\rho(x, t^{n+1})\\,dx $$\n根据物质区间的质量守恒积分定律，这个质量等于在时间 $t^n$ 其对应的出发区间 $D_i$ 中所包含的质量。对于恒定速度 $u$，在 $t^{n+1}$ 的一个点 $x$ 源自于在 $t^n$ 的点 $x_d = x - u\\Delta t$。因此，对应于到达单元 $C_i$ 的出发区间 $D_i$ 是：\n$$ D_i = [x_{i-\\frac{1}{2}} - u\\Delta t, x_{i+\\frac{1}{2}} - u\\Delta t) $$\n令 $s = u\\Delta t$ 为时间步长 $\\Delta t$ 内的平流位移。出发区间为 $D_i = [x_{i-\\frac{1}{2}} - s, x_{i+\\frac{1}{2}} - s)$。质量更新则为：\n$$ m_i^{n+1} = \\int_{D_i} \\rho(x, t^n)\\,dx = \\int_{x_{i-\\frac{1}{2}} - s}^{x_{i+\\frac{1}{2}} - s} \\rho(x, t^n)\\,dx $$\n问题指定在时间 $t^n$ 的密度场进行分段常数重构，即对于任何单元 $j$，当 $x \\in C_j$ 时，$\\rho(x, t^n) = \\rho_j^n = m_j^n/\\Delta x$。\n\n我们给定了约束条件 $0  s  \\Delta x$。这意味着出发区间 $D_i$ 与时间 $t^n$ 网格中的恰好两个贡献单元重叠。$D_i$ 的左端点 $x_{i-\\frac{1}{2}} - s$ 位于单元 $C_{i-1} = [x_{i-\\frac{3}{2}}, x_{i-\\frac{1}{2}})$ 内。$D_i$ 的右端点 $x_{i+\\frac{1}{2}} - s$ 位于单元 $C_i = [x_{i-\\frac{1}{2}}, x_{i+\\frac{1}{2}})$ 内。（索引是周期性处理的，但为了推导，我们可以假设它们是有效的。）\n\n$m_i^{n+1}$ 的积分可以分解到两个贡献单元上：\n$$ m_i^{n+1} = \\int_{D_i \\cap C_{i-1}} \\rho(x, t^n)\\,dx + \\int_{D_i \\cap C_i} \\rho(x, t^n)\\,dx $$\n交集区间是：\n1.  $D_i \\cap C_{i-1} = [x_{i-\\frac{1}{2}} - s, x_{i-\\frac{1}{2}})$。这个交集的长度是第一个重叠长度：$L_{upwind} = x_{i-\\frac{1}{2}} - (x_{i-\\frac{1}{2}} - s) = s$。\n2.  $D_i \\cap C_i = [x_{i-\\frac{1}{2}}, x_{i+\\frac{1}{2}} - s)$。这个交集的长度是第二个重叠长度：$L_{local} = (x_{i+\\frac{1}{2}} - s) - x_{i-\\frac{1}{2}} = \\Delta x - s$。\n\n因此，两个重叠长度明确为 $s$ 和 $\\Delta x - s$。\n\n由于 $\\rho(x,t^n)$ 在每个单元上是常数，我们可以计算积分：\n$$ m_i^{n+1} = \\rho_{i-1}^n \\cdot (\\text{length of } D_i \\cap C_{i-1}) + \\rho_i^n \\cdot (\\text{length of } D_i \\cap C_i) $$\n代入重叠长度和密度表达式，得到守恒重映射表达式：\n$$ m_i^{n+1} = \\rho_{i-1}^n \\cdot s + \\rho_i^n \\cdot (\\Delta x - s) $$\n这个表达式根据贡献单元中的密度和重叠长度来更新质量 $m_i^{n+1}$。这完成了任务 1。\n\n**任务 2：计算到达单元 i=3 的情况**\n\n我们需要计算 $m_3^{n+1}$。到达单元是 $i=3$。贡献单元是 $C_{i-1} = C_2$ 和 $C_i = C_3$。更新公式为：\n$$ m_3^{n+1} = \\rho_2^n \\cdot s + \\rho_3^n \\cdot (\\Delta x - s) $$\n\n首先，我们计算参数的数值：\n- 平流位移：$s = u \\cdot \\Delta t = (0.365\\,\\text{km s}^{-1})(2\\,\\text{s}) = 0.73\\,\\text{km}$。\n- 单元宽度：$\\Delta x = 1\\,\\text{km}$。\n\n接下来，我们计算单元 $i=3$ 的两个重叠长度的数值：\n- 与贡献单元 $C_2$ 的重叠长度：$s = 0.73\\,\\text{km}$。\n- 与贡献单元 $C_3$ 的重叠长度：$\\Delta x - s = 1\\,\\text{km} - 0.73\\,\\text{km} = 0.27\\,\\text{km}$。\n\n现在，我们根据给定的初始质量计算所需的密度：\n- $m_2^n = 2100\\,\\text{kg}$\n- $m_3^n = 1500\\,\\text{kg}$\n密度为：\n- $\\rho_2^n = \\frac{m_2^n}{\\Delta x} = \\frac{2100\\,\\text{kg}}{1\\,\\text{km}} = 2100\\,\\text{kg km}^{-1}$。\n- $\\rho_3^n = \\frac{m_3^n}{\\Delta x} = \\frac{1500\\,\\text{kg}}{1\\,\\text{km}} = 1500\\,\\text{kg km}^{-1}$。\n\n最后，我们将这些值代入重映射公式以求得 $m_3^{n+1}$：\n$$ m_3^{n+1} = (2100\\,\\text{kg km}^{-1}) \\cdot (0.73\\,\\text{km}) + (1500\\,\\text{kg km}^{-1}) \\cdot (0.27\\,\\text{km}) $$\n$$ m_3^{n+1} = (2100 \\times 0.73)\\,\\text{kg} + (1500 \\times 0.27)\\,\\text{kg} $$\n$$ m_3^{n+1} = 1533\\,\\text{kg} + 405\\,\\text{kg} $$\n$$ m_3^{n+1} = 1938\\,\\text{kg} $$\n问题要求答案保留四位有效数字。计算出的值 $1938$ 是一个整数，恰好有四位有效数字。因此，无需四舍五入。\n$m_3^{n+1}$ 的最终数值答案是 $1938$ kg。",
            "answer": "$$\n\\boxed{1938}\n$$"
        },
        {
            "introduction": "在复杂的气候模式中，实现真正的守恒远不止于平流单个标量；它要求在多个物理场之间维持正确的相互关系，例如空气密度 $\\rho$ 和示踪物混合比 $q$。这个高级练习揭示了一个微妙但至关重要的陷阱：即使各个场量分别使用了守恒的方案进行输送，但如果输送过程不是*协调一致的*（即，没有使用相同的映射关系），那么具有物理意义的乘积（如示踪物质量）也可能不守恒。本练习中的反例清晰地证明了，对所有被平流的量采用统一、协调的流场映射是何等必要 。",
            "id": "4062313",
            "problem": "考虑一个用于数值天气预报和气候模拟的一维周期性区域，该区域由两个相等的控制体积（单元）组成，它们具有相同的体积 $V$ 和均匀的横截面积。设干空气密度用 $\\rho$ 表示，被动示踪剂混合比用 $q$ 表示。示踪剂质量定义为 $\\rho q$ 在整个区域上的积分。在没有源和汇的情况下，并假设由无辐散速度场引起的纯平流输送，其控制守恒定律是密度的连续性方程，\n$$\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{u}) = 0,$$\n和示踪剂连续性方程，\n$$\\frac{\\partial (\\rho q)}{\\partial t} + \\nabla \\cdot (\\rho q \\,\\mathbf{u}) = 0,$$\n这意味着在精确平流和周期性边界条件下，区域积分的示踪剂质量不随时间变化。\n\n现在考虑在这个双单元周期性区域上进行一个半拉格朗日（SL）时间步，其具有与分数单元位移相对应的均匀向右位移。在理想的一致重映中，所有源自相同流映射的标量场都将使用由位移的运动学决定的相同权重进行插值。然而，在本练习中，我们刻意引入一个不一致的重映：我们使用一组权重重映密度 $\\rho$，并使用另一组不同的权重重映混合比 $q$。\n\n设置如下。两个单元的索引为 $i=1,2$，每个单元的体积为 $V=1 \\,\\text{m}^{3}$，并具有周期性边界条件。在时间 $t^{n}$，单元平均场为\n$$\\rho_{1}^{n} = 1 \\,\\text{kg m}^{-3}, \\quad q_{1}^{n} = 1,$$\n$$\\rho_{2}^{n} = 2 \\,\\text{kg m}^{-3}, \\quad q_{2}^{n} = 0.$$\n一个均匀向右的位移将每个到达单元的出发点带到其上游邻居单元中。对于半拉格朗日重映，定义线性两点权重如下：\n- 对于密度，使用上游权重 $\\alpha_{\\rho} = \\frac{1}{4}$ 和下游权重 $1 - \\alpha_{\\rho} = \\frac{3}{4}$。\n- 对于混合比，使用上游权重 $\\alpha_{q} = \\frac{3}{4}$ 和下游权重 $1 - \\alpha_{q} = \\frac{1}{4}$。\n\n那么，在时间 $t^{n+1}$ 的到达单元平均场由不一致的SL重映定义：\n$$\\rho_{1}^{n+1} = \\alpha_{\\rho} \\rho_{2}^{n} + (1 - \\alpha_{\\rho}) \\rho_{1}^{n}, \\quad \\rho_{2}^{n+1} = \\alpha_{\\rho} \\rho_{1}^{n} + (1 - \\alpha_{\\rho}) \\rho_{2}^{n},$$\n$$q_{1}^{n+1} = \\alpha_{q} q_{2}^{n} + (1 - \\alpha_{q}) q_{1}^{n}, \\quad q_{2}^{n+1} = \\alpha_{q} q_{1}^{n} + (1 - \\alpha_{q}) q_{2}^{n}.$$\n\n仅使用示踪剂质量是 $\\rho q$ 在区域上的积分这一定义，计算在这一次不一致的重映步骤之后总示踪剂质量的伪变化，其定义为\n$$\\Delta M = \\left[ \\sum_{i=1}^{2} \\rho_{i}^{n+1} q_{i}^{n+1} V \\right] - \\left[ \\sum_{i=1}^{2} \\rho_{i}^{n} q_{i}^{n} V \\right].$$\n以千克（kg）为单位表示示踪剂质量的最终变化。精确算术之外无需舍入。",
            "solution": "基本依据是在周期性区域内，对于无辐散速度场下的纯平流过程，质量和示踪剂质量是守恒的。对于精确平流，区域积分的示踪剂质量，\n$$M(t) = \\int_{\\Omega} \\rho(\\mathbf{x}, t)\\, q(\\mathbf{x}, t) \\, \\mathrm{d}V,$$\n不随时间变化。在半拉格朗日（SL）方法中，到达点的值是通过重映（插值）出发点的值得到的。如果 $\\rho$ 和 $q$ 之间的重映不一致，用于计算质量的重构乘积 $\\rho q$ 可能与正确重映的乘积场不同，从而在区域积分的示踪剂质量中产生伪变化。\n\n我们接下来计算重映前后的示踪剂质量。该区域由两个体积为 $V=1 \\,\\text{m}^{3}$ 的单元组成。在时间 $t^{n}$，\n$$\\rho_{1}^{n} = 1, \\quad q_{1}^{n} = 1; \\qquad \\rho_{2}^{n} = 2, \\quad q_{2}^{n} = 0.$$\n初始总示踪剂质量为\n$$M^{n} = \\sum_{i=1}^{2} \\rho_{i}^{n} q_{i}^{n} V = \\left( \\rho_{1}^{n} q_{1}^{n} + \\rho_{2}^{n} q_{2}^{n} \\right) V = (1 \\cdot 1 + 2 \\cdot 0) \\cdot 1 = 1.$$\n\n应用不一致的SL重映，其中 $\\alpha_{\\rho} = \\frac{1}{4}$ 和 $\\alpha_{q} = \\frac{3}{4}$。使用所提供的线性两点插值公式：\n- 对于密度，\n\n$$\n\\begin{aligned}\n\\rho_{1}^{n+1} = \\alpha_{\\rho} \\rho_{2}^{n} + (1 - \\alpha_{\\rho}) \\rho_{1}^{n} = \\frac{1}{4} \\cdot 2 + \\frac{3}{4} \\cdot 1 = \\frac{1}{2} + \\frac{3}{4} = \\frac{5}{4}, \\\\\n\\rho_{2}^{n+1} = \\alpha_{\\rho} \\rho_{1}^{n} + (1 - \\alpha_{\\rho}) \\rho_{2}^{n} = \\frac{1}{4} \\cdot 1 + \\frac{3}{4} \\cdot 2 = \\frac{1}{4} + \\frac{3}{2} = \\frac{7}{4}.\n\\end{aligned}\n$$\n\n- 对于混合比，\n\n$$\n\\begin{aligned}\nq_{1}^{n+1} = \\alpha_{q} q_{2}^{n} + (1 - \\alpha_{q}) q_{1}^{n} = \\frac{3}{4} \\cdot 0 + \\frac{1}{4} \\cdot 1 = \\frac{1}{4}, \\\\\nq_{2}^{n+1} = \\alpha_{q} q_{1}^{n} + (1 - \\alpha_{q}) q_{2}^{n} = \\frac{3}{4} \\cdot 1 + \\frac{1}{4} \\cdot 0 = \\frac{3}{4}.\n\\end{aligned}\n$$\n\n\n使用每个单元中重构的乘积 $\\rho q$ 计算时间 $t^{n+1}$ 的总示踪剂质量：\n\n$$\n\\begin{aligned}\nM^{n+1} = \\sum_{i=1}^{2} \\rho_{i}^{n+1} q_{i}^{n+1} V \\\\\n= \\left( \\rho_{1}^{n+1} q_{1}^{n+1} + \\rho_{2}^{n+1} q_{2}^{n+1} \\right) \\cdot 1 \\\\\n= \\left( \\frac{5}{4} \\cdot \\frac{1}{4} \\right) + \\left( \\frac{7}{4} \\cdot \\frac{3}{4} \\right) \\\\\n= \\frac{5}{16} + \\frac{21}{16} = \\frac{26}{16} = \\frac{13}{8}.\n\\end{aligned}\n$$\n\n\n总示踪剂质量的伪变化为\n\n$$\n\\Delta M = M^{n+1} - M^{n} = \\frac{13}{8} - 1 = \\frac{13}{8} - \\frac{8}{8} = \\frac{5}{8}.\n$$\n\n\n因此，由于 $\\rho$ 和 $q$ 的不一致重映（对由同一流映射控制的场使用不同的插值权重），在单个半拉格朗日步之后，区域积分的示踪剂质量伪增加了 $\\frac{5}{8}$ 千克，尽管控制守恒定律要求在周期性区域内的精确平流下质量无变化。\n\n这个明确的反例表明，即使在具有线性插值的最小双单元周期性网格上，密度和混合比的不一致重映也会在示踪剂质量中产生非物理的变化。",
            "answer": "$$\\boxed{\\frac{5}{8}}$$"
        }
    ]
}