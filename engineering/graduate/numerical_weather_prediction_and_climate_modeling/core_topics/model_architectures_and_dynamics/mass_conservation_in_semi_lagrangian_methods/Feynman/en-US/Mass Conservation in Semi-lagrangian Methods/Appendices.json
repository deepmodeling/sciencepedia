{
    "hands_on_practices": [
        {
            "introduction": "Semi-Lagrangian (SL) methods are popular in numerical modeling for their ability to use large time steps, but the simplest implementations can suffer from a critical flaw. This practice provides a direct, hands-on demonstration of why and how standard SL schemes with linear interpolation fail to be inherently conservative. By working through a simple, discrete example, you will calculate a spurious mass change and gain a foundational understanding of the core problem that more advanced conservative methods are designed to solve.",
            "id": "4062339",
            "problem": "Consider a one-dimensional periodic domain used in Numerical Weather Prediction (NWP), discretized by a uniform grid with spacing $\\Delta x = 1$ (nondimensional) and grid points indexed by $i=0,1,2,3$. A passive scalar $q(x,t)$ satisfies the advection equation $\\partial q / \\partial t + u(x,t) \\, \\partial q / \\partial x = 0$. In the Semi-Lagrangian (SL) method, $q$ is assumed constant along trajectories, and the update at each grid point $x_i$ at time $t^{n+1}$ samples the value at the departure point $x_i - u(x_i,t^n)\\,\\Delta t$, approximated by linear interpolation from the two nearest upstream grid points at time $t^n$. Periodic boundary conditions apply, so index arithmetic is modulo $4$.\n\nAt time $t^n$, the scalar field is given at the grid points by $q_i^n$:\n$$\nq_0^n = 3,\\quad q_1^n = 1,\\quad q_2^n = 0,\\quad q_3^n = 2.\n$$\nUse a time step $\\Delta t = 1$ (nondimensional). The velocity field is stationary over the step and specified at the arrival grid points as\n$$\nu(x_0,t^n) = 0.2,\\quad u(x_1,t^n) = 0.6,\\quad u(x_2,t^n) = 0.8,\\quad u(x_3,t^n) = 0.4.\n$$\nAssume each departure point $x_i - u(x_i,t^n)\\,\\Delta t$ lies in the interval $[x_{i-1},x_i]$ so that linear interpolation between $q_{i-1}^n$ and $q_i^n$ is used. Let $\\alpha_i = u(x_i,t^n)\\,\\Delta t / \\Delta x$ denote the local Courant number at grid point $i$.\n\nDefine the discrete, domain-integrated scalar content at time $t^n$ and $t^{n+1}$ by\n$$\nM^n = \\sum_{i=0}^{3} q_i^n \\,\\Delta x,\\qquad M^{n+1} = \\sum_{i=0}^{3} q_i^{n+1} \\,\\Delta x,\n$$\nwith $\\Delta x = 1$ (nondimensional). Using the described Semi-Lagrangian linear interpolation update, compute the net change in the discrete content over one time step,\n$$\n\\Delta M = M^{n+1} - M^n,\n$$\nand express your final answer as a pure number (dimensionless). No rounding is required; provide the exact value.",
            "solution": "The problem requires the computation of the change in a discrete scalar quantity over one time step using a semi-Lagrangian (SL) advection scheme with linear interpolation.\n\nFirst, we establish the numerical scheme. The semi-Lagrangian method updates the value at a grid point $x_i$ at time $t^{n+1}$ by tracing the trajectory backward in time to a departure point $x_{d,i}$ at time $t^n$ and taking the value of the scalar field at that point. The value at the new time is $q_i^{n+1} = q^n(x_{d,i})$. The departure point is given by $x_{d,i} = x_i - u(x_i, t^n) \\Delta t$.\n\nThe problem specifies that the value $q^n(x_{d,i})$ is approximated by linear interpolation between the two nearest upstream grid points. The problem states that the departure point, $x_i - u(x_i,t^n)\\,\\Delta t$, lies in the interval $[x_{i-1},x_i]$. The position of the departure point relative to the grid is determined by the local Courant number, $\\alpha_i = u(x_i,t^n)\\,\\Delta t / \\Delta x$.\nThe departure point can be written as $x_{d,i} = x_i - \\alpha_i \\Delta x$. This point is located a fractional distance $\\alpha_i$ upstream from $x_i$, within the cell $[x_{i-1}, x_i]$.\n\nLinear interpolation for a value at $x_{d,i}$ using the surrounding grid-point values $q_{i-1}^n$ and $q_i^n$ is given by:\n$$q_i^{n+1} = w_{i} q_i^n + w_{i-1} q_{i-1}^n$$\nwhere the weights $w_i$ and $w_{i-1}$ depend on the position of $x_{d,i}$. The weight for each grid point is proportional to the distance from the departure point to the *other* grid point.\nThe distance from $x_{d,i}$ to $x_i$ is $\\alpha_i \\Delta x$.\nThe distance from $x_{d,i}$ to $x_{i-1}$ is $(x_i - \\alpha_i \\Delta x) - x_{i-1} = (x_i - x_{i-1}) - \\alpha_i \\Delta x = \\Delta x - \\alpha_i \\Delta x = (1-\\alpha_i) \\Delta x$.\nNormalizing by the interval length $\\Delta x$, the weights are:\n$w_i = \\frac{(1-\\alpha_i) \\Delta x}{\\Delta x} = 1 - \\alpha_i$\n$w_{i-1} = \\frac{\\alpha_i \\Delta x}{\\Delta x} = \\alpha_i$\nThus, the update formula for the semi-Lagrangian scheme with linear interpolation is:\n$$q_i^{n+1} = (1 - \\alpha_i) q_i^n + \\alpha_i q_{i-1}^n$$\nThis formula applies for each grid point $i \\in \\{0, 1, 2, 3\\}$, with index arithmetic performed modulo $4$ due to the periodic boundary conditions (i.e., $q_{-1}^n = q_3^n$).\n\nThe given data are:\nGrid spacing: $\\Delta x = 1$.\nTime step: $\\Delta t = 1$.\nInitial scalar values: $q_0^n = 3$, $q_1^n = 1$, $q_2^n = 0$, $q_3^n = 2$.\nVelocity values: $u(x_0,t^n) = 0.2$, $u(x_1,t^n) = 0.6$, $u(x_2,t^n) = 0.8$, $u(x_3,t^n) = 0.4$. For brevity, we denote these as $u_0, u_1, u_2, u_3$.\n\nFirst, we compute the local Courant numbers $\\alpha_i = u_i \\Delta t / \\Delta x$:\n$\\alpha_0 = 0.2 \\times 1 / 1 = 0.2$\n$\\alpha_1 = 0.6 \\times 1 / 1 = 0.6$\n$\\alpha_2 = 0.8 \\times 1 / 1 = 0.8$\n$\\alpha_3 = 0.4 \\times 1 / 1 = 0.4$\nAs consistent with the problem statement, all $\\alpha_i$ are in the interval $[0,1]$.\n\nNow, we compute $q_i^{n+1}$ for each $i \\in \\{0, 1, 2, 3\\}$:\nFor $i=0$: $q_0^{n+1} = (1 - \\alpha_0) q_0^n + \\alpha_0 q_{-1}^n = (1 - 0.2) q_0^n + 0.2 q_3^n = 0.8(3) + 0.2(2) = 2.4 + 0.4 = 2.8$.\nFor $i=1$: $q_1^{n+1} = (1 - \\alpha_1) q_1^n + \\alpha_1 q_0^n = (1 - 0.6) q_1^n + 0.6 q_0^n = 0.4(1) + 0.6(3) = 0.4 + 1.8 = 2.2$.\nFor $i=2$: $q_2^{n+1} = (1 - \\alpha_2) q_2^n + \\alpha_2 q_1^n = (1 - 0.8) q_2^n + 0.8 q_1^n = 0.2(0) + 0.8(1) = 0.0 + 0.8 = 0.8$.\nFor $i=3$: $q_3^{n+1} = (1 - \\alpha_3) q_3^n + \\alpha_3 q_2^n = (1 - 0.4) q_3^n + 0.4 q_2^n = 0.6(2) + 0.4(0) = 1.2 + 0.0 = 1.2$.\n\nThe scalar field at time $t^{n+1}$ is: $q_0^{n+1} = 2.8$, $q_1^{n+1} = 2.2$, $q_2^{n+1} = 0.8$, $q_3^{n+1} = 1.2$.\n\nNext, we compute the total discrete scalar content at times $t^n$ and $t^{n+1}$. The total content is defined as $M = \\sum_{i=0}^{3} q_i \\Delta x$. Since $\\Delta x=1$, this is simply the sum of the $q_i$ values.\n\nAt time $t^n$:\n$$M^n = \\sum_{i=0}^{3} q_i^n = q_0^n + q_1^n + q_2^n + q_3^n = 3 + 1 + 0 + 2 = 6$$\n\nAt time $t^{n+1}$:\n$$M^{n+1} = \\sum_{i=0}^{3} q_i^{n+1} = q_0^{n+1} + q_1^{n+1} + q_2^{n+1} + q_3^{n+1} = 2.8 + 2.2 + 0.8 + 1.2 = 7.0$$\n\nFinally, the net change in the discrete content over one time step is:\n$$\\Delta M = M^{n+1} - M^n = 7.0 - 6.0 = 1.0$$\n\nThe non-zero change $\\Delta M$ demonstrates that the semi-Lagrangian scheme with linear interpolation is not strictly conservative. The non-conservation arises from the asymmetry in how information is gathered and distributed across the grid. The sum of interpolation weights for values arriving at a grid point is one by construction, but the sum of weights for a value departing from a grid point to its neighbors is not necessarily one.\n\nThe change in total content can also be derived symbolically:\n$$M^{n+1} = \\sum_{i} q_i^{n+1} = \\sum_{i} [(1-\\alpha_i)q_i^n + \\alpha_i q_{i-1}^n] = \\sum_i q_i^n - \\sum_i \\alpha_i q_i^n + \\sum_i \\alpha_i q_{i-1}^n$$\n$$\\Delta M = M^{n+1} - M^n = \\sum_i \\alpha_i q_{i-1}^n - \\sum_i \\alpha_i q_i^n = \\sum_i \\alpha_i (q_{i-1}^n - q_i^n)$$\nUsing the given values to verify the result with this formula:\n$\\Delta M = \\alpha_0(q_3^n - q_0^n) + \\alpha_1(q_0^n - q_1^n) + \\alpha_2(q_1^n - q_2^n) + \\alpha_3(q_2^n - q_3^n)$\n$\\Delta M = 0.2(2-3) + 0.6(3-1) + 0.8(1-0) + 0.4(0-2)$\n$\\Delta M = 0.2(-1) + 0.6(2) + 0.8(1) + 0.4(-2) = -0.2 + 1.2 + 0.8 - 0.8 = 1.0$.\nThe symbolic derivation confirms the numerical result. The final answer is a pure, dimensionless number.",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "Having established that standard point-wise interpolation is non-conservative , we now turn to the solution: reformulating the advection problem in a finite-volume context. This exercise introduces the fundamental mechanism of conservative semi-Lagrangian remapping, where the focus shifts from interpolating point values to calculating the transfer of cell-integrated mass. You will derive the update rule based on the geometric overlap between departure and arrival grid cells, a cornerstone concept for building mass-preserving transport schemes.",
            "id": "4062354",
            "problem": "Consider one-dimensional pure advection of a passive scalar mass density $\\rho(x,t)$ by a constant velocity field $u$ on a periodic domain $[0,L)$ discretized into $N$ uniform cells of width $\\Delta x$, with cell $i$ occupying $[x_{i-\\frac{1}{2}},x_{i+\\frac{1}{2}})$ and cell-integrated mass $m_i^n = \\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} \\rho(x,t^n)\\,dx$ at time $t^n$. The governing law is the integral statement of mass conservation for material control volumes: the mass contained in a material interval is invariant in time under pure advection.\n\nA flux-form conservative semi-Lagrangian update over one time step $\\Delta t$ maps the Eulerian arrival cell $i$ at time $t^{n+1}$ to its departure interval at time $t^n$. Assume a piecewise constant reconstruction of $\\rho(\\cdot,t^n)$ on each cell, equal to the cell-average $\\rho_j^n = m_j^n/\\Delta x$.\n\n- Domain and grid: $L = 5$ km, $N = 5$, $\\Delta x = 1$ km, periodic boundary conditions.\n- Velocity and time step: $u = 0.365 \\text{ km s}^{-1}$, $\\Delta t = 2$ s.\n- Initial cell-integrated masses (in kilograms) at $t^n$: $m_1^n = 1200$, $m_2^n = 2100$, $m_3^n = 1500$, $m_4^n = 300$, $m_5^n = 900$.\n\nTasks:\n1. Starting from the integral form of mass conservation for a material interval and the definition of the departure interval for constant $u$, derive the conservative remapping expression that updates $m_i^{n+1}$ in terms of piecewise constant $\\rho_j^n$ and the one-dimensional overlap lengths between the cell-$i$ departure interval and the donor cells. Restrict attention to the case $0  s  \\Delta x$, where $s = u\\,\\Delta t$ is the advective displacement magnitude over one time step, and identify explicitly the two overlap lengths that appear for a given arrival cell $i$.\n2. For arrival cell $i=3$, compute the numerical values of the two overlap lengths and then compute $m_3^{n+1}$ using the piecewise constant reconstruction described above.\n\nExpress your final numerical answer for $m_3^{n+1}$ in kilograms (kg) and round your answer to four significant figures.",
            "solution": "**Task 1: Derivation of the Conservative Remapping Expression**\n\nThe fundamental principle is the conservation of mass in a material control volume. In a semi-Lagrangian framework, we consider a fixed Eulerian grid cell at the arrival time $t^{n+1}$ and trace its volume back to its departure location at time $t^n$.\n\nThe mass in an arrival cell $i$, denoted $C_i = [x_{i-\\frac{1}{2}}, x_{i+\\frac{1}{2}})$, at time $t^{n+1}$ is given by definition:\n$$ m_i^{n+1} = \\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} \\rho(x, t^{n+1})\\,dx $$\nAccording to the integral law of mass conservation for a material interval, this mass is equal to the mass contained within the corresponding departure interval, $D_i$, at time $t^n$. For a constant velocity $u$, a point $x$ at $t^{n+1}$ originated from $x_d = x - u\\Delta t$ at time $t^n$. Thus, the departure interval $D_i$ corresponding to the arrival cell $C_i$ is:\n$$ D_i = [x_{i-\\frac{1}{2}} - u\\Delta t, x_{i+\\frac{1}{2}} - u\\Delta t) $$\nLet $s = u\\Delta t$ be the advective displacement over the time step $\\Delta t$. The departure interval is $D_i = [x_{i-\\frac{1}{2}} - s, x_{i+\\frac{1}{2}} - s)$. The mass update is then:\n$$ m_i^{n+1} = \\int_{D_i} \\rho(x, t^n)\\,dx = \\int_{x_{i-\\frac{1}{2}} - s}^{x_{i+\\frac{1}{2}} - s} \\rho(x, t^n)\\,dx $$\nThe problem specifies a piecewise constant reconstruction of the density field at time $t^n$, where for any cell $j$, $\\rho(x, t^n) = \\rho_j^n = m_j^n/\\Delta x$ for all $x \\in C_j$.\n\nWe are given the constraint $0  s  \\Delta x$. This implies that the departure interval $D_i$ overlaps with exactly two donor cells from the grid at time $t^n$. The left endpoint of $D_i$, $x_{i-\\frac{1}{2}} - s$, is located within cell $C_{i-1} = [x_{i-\\frac{3}{2}}, x_{i-\\frac{1}{2}})$. The right endpoint of $D_i$, $x_{i+\\frac{1}{2}} - s$, is located within cell $C_i = [x_{i-\\frac{1}{2}}, x_{i+\\frac{1}{2}})$. (Indices are handled periodically.)\n\nThe integral for $m_i^{n+1}$ can be split over the two donor cells:\n$$ m_i^{n+1} = \\int_{D_i \\cap C_{i-1}} \\rho(x, t^n)\\,dx + \\int_{D_i \\cap C_i} \\rho(x, t^n)\\,dx $$\nThe intervals of intersection are:\n1.  $D_i \\cap C_{i-1} = [x_{i-\\frac{1}{2}} - s, x_{i-\\frac{1}{2}})$. The length of this intersection is the first overlap length: $L_{upwind} = x_{i-\\frac{1}{2}} - (x_{i-\\frac{1}{2}} - s) = s$.\n2.  $D_i \\cap C_i = [x_{i-\\frac{1}{2}}, x_{i+\\frac{1}{2}} - s)$. The length of this intersection is the second overlap length: $L_{local} = (x_{i+\\frac{1}{2}} - s) - x_{i-\\frac{1}{2}} = \\Delta x - s$.\n\nThe two overlap lengths are therefore explicitly $s$ and $\\Delta x - s$.\n\nSince $\\rho(x,t^n)$ is constant on each cell, we can evaluate the integrals:\n$$ m_i^{n+1} = \\rho_{i-1}^n \\cdot (\\text{length of } D_i \\cap C_{i-1}) + \\rho_i^n \\cdot (\\text{length of } D_i \\cap C_i) $$\nSubstituting the overlap lengths and density expressions yields the conservative remapping expression:\n$$ m_i^{n+1} = \\rho_{i-1}^n \\cdot s + \\rho_i^n \\cdot (\\Delta x - s) $$\nThis expression updates the mass $m_i^{n+1}$ based on the densities in the donor cells and the overlap lengths. This completes Task 1.\n\n**Task 2: Calculation for Arrival Cell i=3**\n\nWe need to compute $m_3^{n+1}$. The arrival cell is $i=3$. The donor cells are $C_{i-1} = C_2$ and $C_i = C_3$. The update formula is:\n$$ m_3^{n+1} = \\rho_2^n \\cdot s + \\rho_3^n \\cdot (\\Delta x - s) $$\n\nFirst, we calculate the numerical values of the parameters:\n- Advective displacement: $s = u \\cdot \\Delta t = (0.365 \\text{ km s}^{-1})(2\\text{ s}) = 0.73\\text{ km}$.\n- Cell width: $\\Delta x = 1\\,\\text{km}$.\n\nNext, we compute the numerical values of the two overlap lengths for cell $i=3$:\n- Overlap length with donor cell $C_2$: $s = 0.73\\,\\text{km}$.\n- Overlap length with donor cell $C_3$: $\\Delta x - s = 1\\,\\text{km} - 0.73\\,\\text{km} = 0.27\\,\\text{km}$.\n\nNow, we compute the required densities from the given initial masses:\n- $m_2^n = 2100\\,\\text{kg}$\n- $m_3^n = 1500\\,\\text{kg}$\nThe densities are:\n- $\\rho_2^n = \\frac{m_2^n}{\\Delta x} = \\frac{2100\\,\\text{kg}}{1\\,\\text{km}} = 2100 \\text{ kg km}^{-1}$.\n- $\\rho_3^n = \\frac{m_3^n}{\\Delta x} = \\frac{1500\\,\\text{kg}}{1\\,\\text{km}} = 1500 \\text{ kg km}^{-1}$.\n\nFinally, we substitute these values into the remapping formula to find $m_3^{n+1}$:\n$$ m_3^{n+1} = (2100 \\text{ kg km}^{-1}) \\cdot (0.73\\text{ km}) + (1500 \\text{ kg km}^{-1}) \\cdot (0.27\\text{ km}) $$\n$$ m_3^{n+1} = (2100 \\times 0.73)\\,\\text{kg} + (1500 \\times 0.27)\\,\\text{kg} $$\n$$ m_3^{n+1} = 1533\\,\\text{kg} + 405\\,\\text{kg} $$\n$$ m_3^{n+1} = 1938\\,\\text{kg} $$\nThe problem requires the answer to be rounded to four significant figures. The calculated value, $1938$, is an integer with exactly four significant figures. Thus, no rounding is necessary.\nThe final numerical answer for $m_3^{n+1}$ is $1938$ kg.",
            "answer": "$$\n\\boxed{1938}\n$$"
        },
        {
            "introduction": "In realistic atmospheric models, we must transport multiple fields, such as air density $\\rho$ and a tracer mixing ratio $q$. While we have learned how to conserve a single field , this practice reveals a more subtle but critical requirement: consistency. To conserve a derived quantity like the tracer mass $\\rho q$, the transport of both $\\rho$ and $q$ must be based on the same underlying mapping. By deliberately constructing a counterexample with inconsistent remapping, you will observe the non-physical creation of tracer mass, highlighting why a unified and consistent approach is essential for maintaining the integrity of a numerical model.",
            "id": "4062313",
            "problem": "Consider a one-dimensional periodic domain used in numerical weather prediction and climate modeling, consisting of two equal control volumes (cells) with identical volume $V$ and uniform cross-sectional area. Let the dry-air density be denoted by $\\rho$ and a passive tracer mixing ratio by $q$. The tracer mass is defined as the integral of $\\rho q$ over the domain. In the absence of sources and sinks, and assuming purely advective transport by a divergence-free velocity field, the governing conservation laws are the continuity equation for density,\n$$\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{u}) = 0,$$\nand the tracer continuity equation,\n$$\\frac{\\partial (\\rho q)}{\\partial t} + \\nabla \\cdot (\\rho q \\,\\mathbf{u}) = 0,$$\nwhich imply that the domain-integrated tracer mass is invariant in time under exact advection and periodic boundary conditions.\n\nNow consider a single semi-Lagrangian (SL) time step on this two-cell periodic domain with a uniform rightward displacement corresponding to a fractional cell shift. In an ideal consistent remapping, all scalar fields derived from the same flow map would be interpolated using the same weights determined by the kinematics of the displacement. In this exercise, however, we deliberately introduce an inconsistent remapping: we remap the density $\\rho$ using one set of weights and the mixing ratio $q$ using a different set of weights.\n\nThe setup is as follows. The two cells are indexed $i=1,2$, each of volume $V=1 \\,\\text{m}^{3}$, with periodic boundary conditions. At time $t^{n}$, the cell-mean fields are\n$$\\rho_{1}^{n} = 1 \\,\\text{kg m}^{-3}, \\quad q_{1}^{n} = 1,$$\n$$\\rho_{2}^{n} = 2 \\,\\text{kg m}^{-3}, \\quad q_{2}^{n} = 0.$$\nA uniform rightward displacement carries the departure point for each arrival cell into the upwind neighbor. For the semi-Lagrangian remapping, define linear two-point weights as follows:\n- For the density, use an upwind weight $\\alpha_{\\rho} = \\frac{1}{4}$ and downwind weight $1 - \\alpha_{\\rho} = \\frac{3}{4}$.\n- For the mixing ratio, use an upwind weight $\\alpha_{q} = \\frac{3}{4}$ and downwind weight $1 - \\alpha_{q} = \\frac{1}{4}$.\n\nThe arrival cell-mean fields at time $t^{n+1}$ are then defined by the inconsistent SL remap:\n$$\\rho_{1}^{n+1} = \\alpha_{\\rho} \\rho_{2}^{n} + (1 - \\alpha_{\\rho}) \\rho_{1}^{n}, \\quad \\rho_{2}^{n+1} = \\alpha_{\\rho} \\rho_{1}^{n} + (1 - \\alpha_{\\rho}) \\rho_{2}^{n},$$\n$$q_{1}^{n+1} = \\alpha_{q} q_{2}^{n} + (1 - \\alpha_{q}) q_{1}^{n}, \\quad q_{2}^{n+1} = \\alpha_{q} q_{1}^{n} + (1 - \\alpha_{q}) q_{2}^{n}.$$\n\nUsing only the fundamental definition that tracer mass is the domain integral of $\\rho q$, compute the spurious change in total tracer mass after this single inconsistent remapping step, defined as\n$$\\Delta M = \\left[ \\sum_{i=1}^{2} \\rho_{i}^{n+1} q_{i}^{n+1} V \\right] - \\left[ \\sum_{i=1}^{2} \\rho_{i}^{n} q_{i}^{n} V \\right].$$\nExpress the final change in tracer mass in kilograms (kg). No rounding is required beyond exact arithmetic.",
            "solution": "The fundamental base is the conservation of mass and tracer mass under pure advection with a divergence-free velocity in a periodic domain. For exact advection, the domain-integrated tracer mass,\n$$M(t) = \\int_{\\Omega} \\rho(\\mathbf{x}, t)\\, q(\\mathbf{x}, t) \\, \\mathrm{d}V,$$\nis invariant in time. In a semi-Lagrangian (SL) method, values at arrival points are obtained by remapping (interpolating) values from departure points. If the remapping is inconsistent between $\\rho$ and $q$, the reconstructed product $\\rho q$ used to compute mass can differ from the correctly remapped product field, producing a spurious change in domain-integrated tracer mass.\n\nWe proceed to compute the tracer mass before and after the remap. The domain consists of two cells of volume $V=1 \\,\\text{m}^{3}$. At time $t^{n}$,\n$$\\rho_{1}^{n} = 1, \\quad q_{1}^{n} = 1; \\qquad \\rho_{2}^{n} = 2, \\quad q_{2}^{n} = 0.$$\nThe initial total tracer mass is\n$$M^{n} = \\sum_{i=1}^{2} \\rho_{i}^{n} q_{i}^{n} V = \\left( \\rho_{1}^{n} q_{1}^{n} + \\rho_{2}^{n} q_{2}^{n} \\right) V = (1 \\cdot 1 + 2 \\cdot 0) \\cdot 1 = 1.$$\n\nApply the inconsistent SL remap with $\\alpha_{\\rho} = \\frac{1}{4}$ and $\\alpha_{q} = \\frac{3}{4}$. Using the provided linear two-point interpolation formulas:\n- For density,\n\n$$\n\\begin{aligned}\n\\rho_{1}^{n+1} = \\alpha_{\\rho} \\rho_{2}^{n} + (1 - \\alpha_{\\rho}) \\rho_{1}^{n} = \\frac{1}{4} \\cdot 2 + \\frac{3}{4} \\cdot 1 = \\frac{1}{2} + \\frac{3}{4} = \\frac{5}{4}, \\\\\n\\rho_{2}^{n+1} = \\alpha_{\\rho} \\rho_{1}^{n} + (1 - \\alpha_{\\rho}) \\rho_{2}^{n} = \\frac{1}{4} \\cdot 1 + \\frac{3}{4} \\cdot 2 = \\frac{1}{4} + \\frac{3}{2} = \\frac{7}{4}.\n\\end{aligned}\n$$\n\n- For mixing ratio,\n\n$$\n\\begin{aligned}\nq_{1}^{n+1} = \\alpha_{q} q_{2}^{n} + (1 - \\alpha_{q}) q_{1}^{n} = \\frac{3}{4} \\cdot 0 + \\frac{1}{4} \\cdot 1 = \\frac{1}{4}, \\\\\nq_{2}^{n+1} = \\alpha_{q} q_{1}^{n} + (1 - \\alpha_{q}) q_{2}^{n} = \\frac{3}{4} \\cdot 1 + \\frac{1}{4} \\cdot 0 = \\frac{3}{4}.\n\\end{aligned}\n$$\n\n\nCompute the total tracer mass at time $t^{n+1}$ using the reconstructed product $\\rho q$ in each cell:\n\n$$\n\\begin{aligned}\nM^{n+1} = \\sum_{i=1}^{2} \\rho_{i}^{n+1} q_{i}^{n+1} V \\\\\n= \\left( \\rho_{1}^{n+1} q_{1}^{n+1} + \\rho_{2}^{n+1} q_{2}^{n+1} \\right) \\cdot 1 \\\\\n= \\left( \\frac{5}{4} \\cdot \\frac{1}{4} \\right) + \\left( \\frac{7}{4} \\cdot \\frac{3}{4} \\right) \\\\\n= \\frac{5}{16} + \\frac{21}{16} = \\frac{26}{16} = \\frac{13}{8}.\n\\end{aligned}\n$$\n\n\nThe spurious change in total tracer mass is\n\n$$\n\\Delta M = M^{n+1} - M^{n} = \\frac{13}{8} - 1 = \\frac{13}{8} - \\frac{8}{8} = \\frac{5}{8}.\n$$\n\n\nThus, due to the inconsistent remapping of $\\rho$ and $q$ (using different interpolation weights for fields governed by the same flow map), the domain-integrated tracer mass suffers a spurious increase by $\\frac{5}{8}$ kilograms after a single semi-Lagrangian step, despite the governing conservation laws requiring no change under exact advection in a periodic domain.\n\nThis explicit counterexample demonstrates that inconsistent remapping of density and mixing ratio can create nonphysical changes in tracer mass, even on a minimal two-cell periodic grid with linear interpolation.",
            "answer": "$$\\boxed{\\frac{5}{8}}$$"
        }
    ]
}