{
    "hands_on_practices": [
        {
            "introduction": "Before implementing a numerical scheme, we must understand its inherent behavior. Von Neumann analysis provides a mathematical microscope to inspect how a scheme handles different wave components of a solution, revealing its accuracy and stability. This practice will have you analyze the classic Lax-Wendroff scheme to derive its amplification factor and phase speed, giving you direct insight into the concepts of numerical dissipation and dispersion .",
            "id": "4009661",
            "problem": "Consider one-dimensional linear advection of a passive tracer governed by the conservation law $\\,\\partial \\phi / \\partial t + u \\, \\partial \\phi / \\partial x = 0\\,$ with constant velocity $\\,u>0\\,$ on a uniform grid with spacing $\\,\\Delta x\\,$ and time step $\\,\\Delta t\\,$. Let the Courant-Friedrichs-Lewy (CFL) Courant number be defined as $\\,C = u \\Delta t / \\Delta x\\,$. The Lax–Wendroff finite-difference scheme for this equation is\n$$\n\\phi_{j}^{n+1} = \\phi_{j}^{n} - \\frac{C}{2} \\left( \\phi_{j+1}^{n} - \\phi_{j-1}^{n} \\right) + \\frac{C^{2}}{2} \\left( \\phi_{j+1}^{n} - 2 \\phi_{j}^{n} + \\phi_{j-1}^{n} \\right).\n$$\nUsing von Neumann analysis with a Fourier mode $\\,\\phi_{j}^{n} = \\hat{\\phi}^{n} \\exp\\!\\left( i k j \\Delta x \\right)\\,$, perform the following:\n\n1. Derive the amplification factor $\\,G(k)\\,$ such that $\\,\\hat{\\phi}^{n+1} = G(k) \\, \\hat{\\phi}^{n}\\,$, and compute its magnitude $\\,|G(k)|\\,$ as a function of the nondimensional wavenumber $\\,\\theta = k \\Delta x\\,$ and the Courant number $\\,C\\,$.\n\n2. Express the numerical phase speed $\\,c_{\\text{num}}(k)\\,$ in terms of $\\,G(k)\\,$ via the relation $\\,G(k) = \\exp\\!\\big( - i \\, \\omega_{\\text{num}}(k) \\, \\Delta t \\big)\\,$ with $\\,c_{\\text{num}}(k) = \\omega_{\\text{num}}(k)/k\\,$, and write $\\,c_{\\text{num}}(k)\\,$ explicitly in terms of $\\,\\theta\\,$ and $\\,C\\,$. Identify and discuss how amplitude and phase errors depend on $\\,C\\,$.\n\nFinally, in the long-wave limit $\\,\\theta \\ll 1\\,$, expand the relative phase speed as\n$$\n\\frac{c_{\\text{num}}(k)}{u} = 1 + \\alpha(C) \\, \\theta^{2} + \\mathcal{O}\\!\\left( \\theta^{4} \\right).\n$$\nDetermine the closed-form analytic expression for the coefficient $\\,\\alpha(C)\\,$. Provide only $\\,\\alpha(C)\\,$ as your final answer. No numerical rounding is required. The final answer must be an exact expression with no units.",
            "solution": "We start from the linear advection equation $\\,\\partial \\phi / \\partial t + u \\, \\partial \\phi / \\partial x = 0\\,$ and the Lax–Wendroff discretization\n$$\n\\phi_{j}^{n+1} = \\phi_{j}^{n} - \\frac{C}{2} \\left( \\phi_{j+1}^{n} - \\phi_{j-1}^{n} \\right) + \\frac{C^{2}}{2} \\left( \\phi_{j+1}^{n} - 2 \\phi_{j}^{n} + \\phi_{j-1}^{n} \\right),\n$$\nwhere $\\,C = u \\Delta t / \\Delta x\\,$ is the Courant number. For von Neumann analysis, insert the Fourier mode $\\,\\phi_{j}^{n} = \\hat{\\phi}^{n} \\exp\\!\\left( i k j \\Delta x \\right)\\,$ with $\\,\\theta = k \\Delta x\\,$. Then\n$$\n\\phi_{j \\pm 1}^{n} = \\hat{\\phi}^{n} \\exp\\!\\left( i k (j \\pm 1) \\Delta x \\right) = \\hat{\\phi}^{n} \\exp\\!\\left( i k j \\Delta x \\right) \\exp\\!\\left( \\pm i \\theta \\right).\n$$\nSubstituting into the scheme and dividing both sides by $\\,\\hat{\\phi}^{n} \\exp\\!\\left( i k j \\Delta x \\right)\\,$ yields the amplification factor $\\,G(\\theta)\\,$:\n$$\nG(\\theta) = 1 - \\frac{C}{2} \\left( e^{i \\theta} - e^{- i \\theta} \\right) + \\frac{C^{2}}{2} \\left( e^{i \\theta} - 2 + e^{- i \\theta} \\right).\n$$\nUsing $\\,e^{i \\theta} - e^{- i \\theta} = 2 i \\sin \\theta\\,$ and $\\,e^{i \\theta} + e^{- i \\theta} = 2 \\cos \\theta\\,$,\n$$\nG(\\theta) = 1 - i C \\sin \\theta + C^{2} \\left( \\cos \\theta - 1 \\right).\n$$\nTherefore, the real and imaginary parts are\n$$\n\\Re\\{G\\} = 1 + C^{2} \\left( \\cos \\theta - 1 \\right), \\quad \\Im\\{G\\} = - C \\sin \\theta.\n$$\n\nTo compute $\\,|G(\\theta)|\\,$, note\n$$\n|G|^{2} = \\left[ 1 + C^{2} \\left( \\cos \\theta - 1 \\right) \\right]^{2} + \\left[ C \\sin \\theta \\right]^{2}.\n$$\nA convenient form uses half-angle identities $\\,\\cos \\theta - 1 = - 2 \\sin^{2}\\!\\left( \\theta/2 \\right)\\,$ and $\\,\\sin \\theta = 2 \\sin\\!\\left( \\theta/2 \\right) \\cos\\!\\left( \\theta/2 \\right)\\,$. Let $\\,s = \\sin\\!\\left( \\theta/2 \\right)\\,$ and $\\,c = \\cos\\!\\left( \\theta/2 \\right)\\,$; then\n$$\n\\Re\\{G\\} = 1 - 2 C^{2} s^{2}, \\quad \\Im\\{G\\} = - 2 C s c,\n$$\nand\n$$\n|G|^{2} = \\left( 1 - 2 C^{2} s^{2} \\right)^{2} + \\left( 2 C s c \\right)^{2} = 1 - 4 C^{2} \\left( 1 - C^{2} \\right) s^{4}.\n$$\nThus\n$$\n|G(\\theta)| = \\sqrt{ 1 - 4 C^{2} \\left( 1 - C^{2} \\right) \\sin^{4}\\!\\left( \\frac{\\theta}{2} \\right) }.\n$$\nFor $\\,0 < C < 1\\,$, we have $\\,|G(\\theta)| \\le 1\\,$ with equality only as $\\,\\theta \\to 0\\,$ and at $\\,C = 1\\,$, showing dissipation that increases with $\\,C (1 - C)\\,$ and with wavenumber.\n\nNext, to obtain the numerical phase speed, write $\\,G(\\theta) = \\exp\\!\\left( - i \\, \\omega_{\\text{num}}(k) \\, \\Delta t \\right)\\,$ so that $\\,\\omega_{\\text{num}}(k) \\Delta t = - \\arg G(\\theta)\\,$. Using the argument of a complex number, we have\n$$\n\\arg G(\\theta) = \\arctan2\\!\\left( \\Im\\{G\\}, \\Re\\{G\\} \\right) = - \\arctan\\!\\left( \\frac{ C \\sin \\theta }{ 1 + C^{2} \\left( \\cos \\theta - 1 \\right) } \\right),\n$$\nfor small enough $\\,\\theta\\,$ such that $\\,\\Re\\{G\\} > 0\\,$, with the multivalued behavior handled by continuity for general $\\,\\theta\\,$. Then\n$$\n\\omega_{\\text{num}}(k) \\Delta t = \\arctan\\!\\left( \\frac{ C \\sin \\theta }{ 1 + C^{2} \\left( \\cos \\theta - 1 \\right) } \\right),\n$$\nand hence\n$$\nc_{\\text{num}}(k) = \\frac{\\omega_{\\text{num}}(k)}{k} = \\frac{1}{k \\, \\Delta t} \\, \\arctan\\!\\left( \\frac{ C \\sin \\theta }{ 1 + C^{2} \\left( \\cos \\theta - 1 \\right) } \\right), \\quad \\theta = k \\Delta x.\n$$\nThis expression shows an explicit dependence on the Courant number $\\,C\\,$: as $\\,C \\to 1\\,$, the scheme becomes an exact shift and $\\,c_{\\text{num}}(k) \\to u\\,$ for all $\\,k\\,$ since $\\,G(\\theta) \\to \\exp(- i \\theta)\\,$. For $\\,0 < C < 1\\,$, the phase speed deviates from $\\,u\\,$ and the amplitude is damped, with both errors increasing as $\\,| \\theta |$ grows.\n\nTo identify the leading-order phase error and its Courant dependence, perform a small-$\\theta$ expansion. Using $\\,\\sin \\theta = \\theta - \\theta^{3}/6 + \\mathcal{O}(\\theta^{5})\\,$ and $\\,\\cos \\theta = 1 - \\theta^{2}/2 + \\mathcal{O}(\\theta^{4})\\,$, the ratio inside the arctangent is\n$$\nR(\\theta) = \\frac{ C \\sin \\theta }{ 1 + C^{2} \\left( \\cos \\theta - 1 \\right) } = \\frac{ C \\left( \\theta - \\theta^{3}/6 + \\mathcal{O}(\\theta^{5}) \\right) }{ 1 - C^{2} \\theta^{2}/2 + \\mathcal{O}(\\theta^{4}) }.\n$$\nExpanding $\\,1 / \\left( 1 - C^{2} \\theta^{2}/2 \\right) = 1 + C^{2} \\theta^{2}/2 + \\mathcal{O}(\\theta^{4})\\,$ yields\n$$\nR(\\theta) = C \\theta \\left( 1 - \\frac{\\theta^{2}}{6} \\right) \\left( 1 + \\frac{C^{2} \\theta^{2}}{2} \\right) + \\mathcal{O}(\\theta^{5}) = C \\theta \\left[ 1 + \\theta^{2} \\left( \\frac{C^{2}}{2} - \\frac{1}{6} \\right) \\right] + \\mathcal{O}(\\theta^{5}).\n$$\nUsing $\\,\\arctan z = z - z^{3}/3 + \\mathcal{O}(z^{5})\\,$ with $\\,z = R(\\theta)\\,$ and retaining terms through $\\,\\mathcal{O}(\\theta^{3})\\,$,\n$$\n\\omega_{\\text{num}}(k) \\Delta t = \\arctan R(\\theta) = C \\theta \\left[ 1 + \\theta^{2} \\left( \\frac{C^{2}}{2} - \\frac{1}{6} \\right) \\right] - \\frac{(C \\theta)^{3}}{3} + \\mathcal{O}(\\theta^{5}).\n$$\nCollecting the $\\,\\theta^{3}\\,$ terms,\n$$\n\\omega_{\\text{num}}(k) \\Delta t = C \\theta \\left[ 1 - \\frac{(1 - C^{2})}{6} \\theta^{2} \\right] + \\mathcal{O}(\\theta^{5}).\n$$\nTherefore\n$$\nc_{\\text{num}}(k) = \\frac{ \\omega_{\\text{num}}(k) }{ k } = \\frac{1}{k \\Delta t} \\, C \\theta \\left[ 1 - \\frac{(1 - C^{2})}{6} \\theta^{2} \\right] + \\mathcal{O}(\\theta^{4})\n= \\frac{C \\Delta x}{\\Delta t} \\left[ 1 - \\frac{(1 - C^{2})}{6} \\theta^{2} \\right] + \\mathcal{O}(\\theta^{4}).\n$$\nSince $\\,C \\Delta x / \\Delta t = u\\,$ and $\\,\\theta = k \\Delta x\\,$, we obtain the long-wave expansion\n$$\n\\frac{c_{\\text{num}}(k)}{u} = 1 - \\frac{(1 - C^{2})}{6} \\, \\theta^{2} + \\mathcal{O}(\\theta^{4}).\n$$\nHence, in the notation $\\,c_{\\text{num}}(k)/u = 1 + \\alpha(C) \\, \\theta^{2} + \\mathcal{O}(\\theta^{4})\\,$, the coefficient is\n$$\n\\alpha(C) = - \\frac{ 1 - C^{2} }{ 6 }.\n$$\nThis expression satisfies expected limits: $\\,\\alpha(1) = 0\\,$ because for $\\,C=1\\,$ the scheme reproduces exact translation on the grid, and for $\\,0<C<1\\,$ the phase speed is reduced relative to $\\,u\\,$ at small wavenumber since $\\,\\alpha(C) < 0\\,$.\n\nRegarding amplitude error, expanding $\\,|G|^{2} = 1 - 4 C^{2} (1 - C^{2}) \\sin^{4}(\\theta/2)\\,$ for small $\\,\\theta\\,$ gives $\\,|G|^{2} = 1 - C^{2} (1 - C^{2}) \\theta^{4} / 4 + \\mathcal{O}(\\theta^{6})\\,$, showing that the leading-order dissipation is fourth order in $\\,\\theta\\,$ and scales with $\\,C^{2}(1 - C^{2})\\,$, vanishing at $\\,C=0\\,$ and $\\,C=1\\,$ and maximizing near $\\,C=1/2\\,$.",
            "answer": "$$\\boxed{-\\frac{1 - C^{2}}{6}}$$"
        },
        {
            "introduction": "Stability is a non-negotiable property of any numerical simulation, and the Courant-Friedrichs-Lewy (CFL) condition dictates the \"speed limit\" for explicit time-stepping. This practice explores the crucial extension of this condition to multiple dimensions, where simple 1D intuition can be misleading. You will derive the correct stability constraint for a 2D unsplit scheme from first principles and apply it to determine the maximum allowable time step in a realistic atmospheric flow scenario .",
            "id": "4009717",
            "problem": "Consider a two-dimensional linear advection of a passive tracer on a uniform, anisotropic rectangular grid with spacings $\\Delta x$ and $\\Delta y$, and constant velocities $u$ and $v$. The tracer concentration $q(x,y,t)$ satisfies the conservation law $\\partial_t q + \\partial_x(u q) + \\partial_y(v q) = 0$. Assume an Eulerian, conservative, first-order upwind finite-volume scheme that updates cell averages $q_{i,j}^{n}$ to $q_{i,j}^{n+1}$ using fluxes across cell faces determined by the upwind state.\n\nStarting from the discrete flux balance and the requirement that the numerical scheme remain monotone (no new extrema are created) and preserve non-negativity for arbitrary non-negative initial data, derive the necessary constraint on the Courant-Friedrichs-Lewy (CFL) numbers that ensures stability and monotonicity of the unsplit two-dimensional scheme for diagonal advection (both $u$ and $v$ nonzero). Use this derivation to obtain the maximum allowable time step $\\Delta t_{\\max}$ for given $\\Delta x$, $\\Delta y$, $u$, and $v$, and compare it conceptually to the coordinate-wise bounds suggested by one-dimensional considerations in each direction.\n\nThen, for a scientifically realistic anisotropic grid and wind:\n- $\\Delta x = 30\\,\\text{km}$,\n- $\\Delta y = 10\\,\\text{km}$,\n- $u = 50\\,\\text{m}\\,\\text{s}^{-1}$,\n- $v = 30\\,\\text{m}\\,\\text{s}^{-1}$,\n\ncompute the largest time step $\\Delta t_{\\max}$ consistent with the unsplit two-dimensional monotonicity and stability constraint derived above. Express your final numerical answer in seconds. Round your answer to $4$ significant figures.",
            "solution": "### Derivation of the Stability and Monotonicity Constraint\n\nWe begin with the governing conservation law for a constant velocity field $(u,v)$:\n$$\n\\partial_t q + u \\partial_x q + v \\partial_y q = 0\n$$\nTo discretize this equation using a finite-volume method, we integrate it over a control volume (a grid cell) $\\Omega_{i,j} = [x_{i-1/2}, x_{i+1/2}] \\times [y_{j-1/2}, y_{j+1/2}]$ and over a time interval $[t^n, t^{n+1}]$. The cell has dimensions $\\Delta x$ and $\\Delta y$. The cell-averaged concentration is defined as:\n$$\nq_{i,j}^n = \\frac{1}{\\Delta x \\Delta y} \\int_{y_{j-1/2}}^{y_{j+1/2}} \\int_{x_{i-1/2}}^{x_{i+1/2}} q(x,y,t^n) \\, dx \\, dy\n$$\nIntegrating the PDE over space and time yields:\n$$\n\\int_{t^n}^{t^{n+1}} \\int_{\\Omega_{i,j}} (\\partial_t q + \\partial_x(uq) + \\partial_y(vq)) \\, dx \\, dy \\, dt = 0\n$$\nUsing the divergence theorem in space and the fundamental theorem of calculus in time, and discretizing the time integral with a simple forward Euler method, we get the exact update formula for the cell averages:\n$$\n\\Delta x \\Delta y (q_{i,j}^{n+1} - q_{i,j}^n) + \\Delta t \\left[ (F^x_{i+1/2,j} - F^x_{i-1/2,j})\\Delta y + (F^y_{i,j+1/2} - F^y_{i,j-1/2})\\Delta x \\right] = 0\n$$\nwhere $F^x$ and $F^y$ are the numerical fluxes across the cell faces, approximating the time-averaged exact fluxes. Rearranging for $q_{i,j}^{n+1}$:\n$$\nq_{i,j}^{n+1} = q_{i,j}^n - \\frac{\\Delta t}{\\Delta x} (F^x_{i+1/2,j} - F^x_{i-1/2,j}) - \\frac{\\Delta t}{\\Delta y} (F^y_{i,j+1/2} - F^y_{i,j-1/2})\n$$\nThe first-order upwind scheme defines the flux at a cell interface based on the value in the \"upwind\" cell. For simplicity, let's first assume $u > 0$ and $v > 0$. The wind comes from the left and from below.\n- The flux at the right face ($i+1/2$) is determined by the cell to its left ($i,j$): $F^x_{i+1/2,j} = u q_{i,j}^n$.\n- The flux at the left face ($i-1/2$) is determined by the cell to its left ($i-1,j$): $F^x_{i-1/2,j} = u q_{i-1,j}^n$.\n- The flux at the top face ($j+1/2$) is determined by the cell below it ($i,j$): $F^y_{i,j+1/2} = v q_{i,j}^n$.\n- The flux at the bottom face ($j-1/2$) is determined by the cell below it ($i,j-1$): $F^y_{i,j-1/2} = v q_{i,j-1}^n$.\n\nSubstituting these fluxes into the update equation:\n$$\nq_{i,j}^{n+1} = q_{i,j}^n - \\frac{\\Delta t}{\\Delta x} (u q_{i,j}^n - u q_{i-1,j}^n) - \\frac{\\Delta t}{\\Delta y} (v q_{i,j}^n - v q_{i,j-1}^n)\n$$\nTo analyze for monotonicity, we rearrange the equation to express $q_{i,j}^{n+1}$ as a linear combination of its neighbors at time $t^n$:\n$$\nq_{i,j}^{n+1} = \\left(1 - \\frac{u \\Delta t}{\\Delta x} - \\frac{v \\Delta t}{\\Delta y}\\right) q_{i,j}^n + \\left(\\frac{u \\Delta t}{\\Delta x}\\right) q_{i-1,j}^n + \\left(\\frac{v \\Delta t}{\\Delta y}\\right) q_{i,j-1}^n\n$$\nLet's define the non-dimensional Courant-Friedrichs-Lewy (CFL) numbers for each direction:\n$$\nc_x = \\frac{u \\Delta t}{\\Delta x} \\quad \\text{and} \\quad c_y = \\frac{v \\Delta t}{\\Delta y}\n$$\nThe update scheme becomes:\n$$\nq_{i,j}^{n+1} = (1 - c_x - c_y) q_{i,j}^n + c_x q_{i-1,j}^n + c_y q_{i,j-1}^n\n$$\nA numerical scheme is monotone if $q_{i,j}^{n+1}$ is a convex combination of the values at time $t^n$. This requires all coefficients to be non-negative.\n1.  $c_x \\ge 0$: Since $u > 0$, $\\Delta t > 0$, and $\\Delta x > 0$, this is satisfied.\n2.  $c_y \\ge 0$: Since $v > 0$, $\\Delta t > 0$, and $\\Delta y > 0$, this is satisfied.\n3.  $1 - c_x - c_y \\ge 0$: This is the crucial non-trivial constraint. It implies $c_x + c_y \\le 1$.\n\nIf we consider arbitrary signs for $u$ and $v$, the upwind state is chosen from the direction the flow originates. The CFL numbers are properly defined with absolute values: $c_x = \\frac{|u| \\Delta t}{\\Delta x}$ and $c_y = \\frac{|v| \\Delta t}{\\Delta y}$. The same derivation leads to the same coefficient $(1 - c_x - c_y)$ for $q_{i,j}^n$, while the other terms would involve neighbors like $q_{i+1,j}^n$ or $q_{i,j+1}^n$ depending on the flow direction. In all cases, for the scheme to be monotone, all coefficients must be non-negative. The coefficients of the neighboring cells will be $c_x$ and $c_y$, which are non-negative by definition. The controlling constraint is always that the coefficient of $q_{i,j}^n$ remains non-negative.\n\nThus, the general monotonicity and stability constraint for the unsplit 2D first-order upwind scheme is:\n$$\n\\frac{|u| \\Delta t}{\\Delta x} + \\frac{|v| \\Delta t}{\\Delta y} \\le 1\n$$\nThis condition ensures that no new extrema are created and that an initially non-negative field remains non-negative.\n\nFrom this constraint, we can find the maximum allowable time step, $\\Delta t_{\\max}$, by taking the equality:\n$$\n\\Delta t_{\\max} \\left( \\frac{|u|}{\\Delta x} + \\frac{|v|}{\\Delta y} \\right) = 1\n$$\n$$\n\\Delta t_{\\max} = \\frac{1}{\\frac{|u|}{\\Delta x} + \\frac{|v|}{\\Delta y}}\n$$\n\n### Conceptual Comparison\nFor one-dimensional advection, the CFL stability condition for the first-order upwind scheme is $c = \\frac{|U| \\Delta t}{\\Delta L} \\le 1$, where $U$ is the velocity and $\\Delta L$ is the grid spacing. This implies an upper limit on the time step: $\\Delta t \\le \\frac{\\Delta L}{|U|}$.\n\nApplying this logic to our two-dimensional problem coordinate-wise suggests two independent constraints:\n1.  In the $x$-direction: $\\Delta t \\le \\frac{\\Delta x}{|u|}$\n2.  In the $y$-direction: $\\Delta t \\le \\frac{\\Delta y}{|v|}$\n\nA naive approach, often taken for time-split schemes, would be to satisfy both by taking the minimum of the two limits: $\\Delta t_{\\text{naive}} = \\min\\left(\\frac{\\Delta x}{|u|}, \\frac{\\Delta y}{|v|}\\right)$.\n\nLet's compare this with the derived limit for the unsplit scheme. Let $T_x = \\frac{\\Delta x}{|u|}$ and $T_y = \\frac{\\Delta y}{|v|}$.\nThe derived limit is $\\Delta t_{\\max} = \\frac{1}{1/T_x + 1/T_y} = \\frac{T_x T_y}{T_x + T_y}$.\nThe naive limit is $\\min(T_x, T_y)$.\n\nWithout loss of generality, assume $T_x \\le T_y$. Then $\\min(T_x, T_y) = T_x$.\nWe compare $\\frac{T_x T_y}{T_x + T_y}$ with $T_x$.\nSince $T_x, T_y > 0$, we have $T_y < T_x + T_y$.\nDividing by $T_x + T_y$ gives $\\frac{T_y}{T_x + T_y} < 1$.\nMultiplying by the positive quantity $T_x$ gives $\\frac{T_x T_y}{T_x + T_y} < T_x$.\n\nThis shows that $\\Delta t_{\\max} < \\min(T_x, T_y)$ whenever both $T_x$ and $T_y$ are finite (i.e., both $u$ and $v$ are non-zero). Therefore, the stability constraint for the unsplit two-dimensional scheme is strictly more restrictive than taking the minimum of the one-dimensional constraints. This is physically because the advection occurs diagonally across the grid cells, and the total displacement relative to the cell size must be considered. The denominator of the expression for $\\Delta t_{\\max}$ sums the advection rates $\\frac{|u|}{\\Delta x}$ and $\\frac{|v|}{\\Delta y}$, reflecting this combined effect.\n\n### Numerical Calculation\n\nWe are given the following values:\n- $\\Delta x = 30\\,\\text{km} = 30 \\times 10^3\\,\\text{m}$\n- $\\Delta y = 10\\,\\text{km} = 10 \\times 10^3\\,\\text{m}$\n- $u = 50\\,\\text{m}\\,\\text{s}^{-1}$\n- $v = 30\\,\\text{m}\\,\\text{s}^{-1}$\n\nSince $u$ and $v$ are positive, $|u| = u$ and $|v| = v$. We use the formula for $\\Delta t_{\\max}$:\n$$\n\\Delta t_{\\max} = \\frac{1}{\\frac{u}{\\Delta x} + \\frac{v}{\\Delta y}}\n$$\nFirst, calculate the terms in the denominator:\n$$\n\\frac{u}{\\Delta x} = \\frac{50\\,\\text{m}\\,\\text{s}^{-1}}{30 \\times 10^3\\,\\text{m}} = \\frac{5}{3 \\times 10^3}\\,\\text{s}^{-1} = \\frac{5}{3000}\\,\\text{s}^{-1}\n$$\n$$\n\\frac{v}{\\Delta y} = \\frac{30\\,\\text{m}\\,\\text{s}^{-1}}{10 \\times 10^3\\,\\text{m}} = \\frac{3}{10^3}\\,\\text{s}^{-1} = \\frac{3}{1000}\\,\\text{s}^{-1}\n$$\nNow, sum these terms:\n$$\n\\frac{u}{\\Delta x} + \\frac{v}{\\Delta y} = \\frac{5}{3000} + \\frac{3}{1000} = \\frac{5}{3000} + \\frac{9}{3000} = \\frac{14}{3000}\\,\\text{s}^{-1}\n$$\nFinally, compute $\\Delta t_{\\max}$ by taking the reciprocal:\n$$\n\\Delta t_{\\max} = \\frac{1}{\\frac{14}{3000}\\,\\text{s}^{-1}} = \\frac{3000}{14}\\,\\text{s} = \\frac{1500}{7}\\,\\text{s}\n$$\nNow we compute the numerical value:\n$$\n\\Delta t_{\\max} \\approx 214.285714... \\,\\text{s}\n$$\nThe problem requires the answer to be rounded to $4$ significant figures. The first four significant figures are $2$, $1$, $4$, $2$. The fifth significant digit is $8$, which is greater than or equal to $5$, so we round up the fourth digit.\n$$\n\\Delta t_{\\max} \\approx 214.3\\,\\text{s}\n$$\nFor context, the individual 1D limits would be:\n$T_x = \\frac{30000\\,\\text{m}}{50\\,\\text{m/s}} = 600\\,\\text{s}$\n$T_y = \\frac{10000\\,\\text{m}}{30\\,\\text{m/s}} = \\frac{1000}{3} \\approx 333.3\\,\\text{s}$\nThe naive limit would be $\\min(600, 333.3) = 333.3\\,\\text{s}$. As derived, our correct limit of $214.3\\,\\text{s}$ is significantly more restrictive.",
            "answer": "$$\\boxed{214.3}$$"
        },
        {
            "introduction": "Simple schemes are often too diffusive, while high-order schemes can create unrealistic oscillations. This practice delves into the engine room of modern, high-resolution advection schemes that are designed to capture sharp features accurately. You will perform a step-by-step update for a single grid cell using a finite-volume method with piecewise-linear reconstruction and a Total Variation Diminishing (TVD) limiter, demystifying how these sophisticated methods achieve both high accuracy and physical realism .",
            "id": "4009665",
            "problem": "Consider the conservative advection of a passive tracer in two spatial dimensions governed by the local conservation law for the cell-mean tracer $\\bar{q}$,\n$$\\frac{\\partial \\bar{q}}{\\partial t} + \\nabla \\cdot \\left(\\boldsymbol{u}\\, \\bar{q}\\right) = 0,$$\nwhere $\\boldsymbol{u} = (u,v)$ is the velocity field. Using the finite-volume perspective on a uniform Cartesian mesh with spacings $\\Delta x$ and $\\Delta y$, the update of a cell-average over one explicit time step $\\Delta t$ is obtained by integrating the conservation law over the cell and applying the divergence theorem to write the time evolution in terms of the net fluxes through the four cell faces.\n\nYou will construct the numerical fluxes with the Godunov method using upwinding and a piecewise-linear reconstruction of the tracer inside each cell with a Total Variation Diminishing (TVD) minmod limiter. The minmod limiter for a component-wise slope is defined as\n$$\\operatorname{minmod}(a,b) = \\begin{cases}\n\\operatorname{sign}(a)\\,\\min\\left(|a|,|b|\\right) & \\text{if } a\\,b > 0 \\\\\n0 & \\text{otherwise}\n\\end{cases}$$\n\nOn a $3\\times 3$ patch of cells indexed by $(i,j) \\in \\{0,1,2\\}\\times\\{0,1,2\\}$, consider the center cell $(i,j)=(1,1)$ with nondimensional mesh spacings $\\Delta x = 1$ and $\\Delta y = 1$, time step $\\Delta t = 0.5$, and the following nondimensional tracer cell-mean values:\n$$\\bar{q}_{0,1} = 0.9,\\quad \\bar{q}_{1,1} = 1.1,\\quad \\bar{q}_{2,1} = 1.3,$$\n$$\\bar{q}_{1,0} = 1.2,\\quad \\bar{q}_{1,2} = 1.0.$$\nAssume the face-normal nondimensional velocities at the four faces surrounding $(1,1)$ are\n$$u_{1+\\frac{1}{2},1} = 0.6,\\quad u_{1-\\frac{1}{2},1} = -0.2,\\quad v_{1,1+\\frac{1}{2}} = 0.3,\\quad v_{1,1-\\frac{1}{2}} = -0.5.$$\nUse the following procedure:\n- Compute the limited slopes $s_x$ and $s_y$ in the $x$- and $y$-directions for the center cell $(1,1)$ using one-cell differences and the minmod limiter:\n$$s_x(1,1) = \\operatorname{minmod}\\left(\\frac{\\bar{q}_{1,1}-\\bar{q}_{0,1}}{\\Delta x},\\frac{\\bar{q}_{2,1}-\\bar{q}_{1,1}}{\\Delta x}\\right),\\qquad\ns_y(1,1) = \\operatorname{minmod}\\left(\\frac{\\bar{q}_{1,1}-\\bar{q}_{1,0}}{\\Delta y},\\frac{\\bar{q}_{1,2}-\\bar{q}_{1,1}}{\\Delta y}\\right).$$\n- Reconstruct the center cell’s interface values at its four faces by linear extrapolation along the face-normal direction:\n$$\\bar{q}_{1+\\frac{1}{2},1}^{(\\text{from }(1,1))} = \\bar{q}_{1,1} + \\frac{1}{2}\\Delta x\\, s_x(1,1),\\qquad\n\\bar{q}_{1-\\frac{1}{2},1}^{(\\text{from }(1,1))} = \\bar{q}_{1,1} - \\frac{1}{2}\\Delta x\\, s_x(1,1),$$\n$$\\bar{q}_{1,1+\\frac{1}{2}}^{(\\text{from }(1,1))} = \\bar{q}_{1,1} + \\frac{1}{2}\\Delta y\\, s_y(1,1),\\qquad\n\\bar{q}_{1,1-\\frac{1}{2}}^{(\\text{from }(1,1))} = \\bar{q}_{1,1} - \\frac{1}{2}\\Delta y\\, s_y(1,1).$$\n- Apply Godunov upwinding to select, at each face, the upwind interface value based on the sign of the face-normal velocity. Since the given face-normal velocities imply upwind selection from the center cell at all four faces, use the reconstructed values above.\n- Form the advective fluxes through each face as the product of the face-normal velocity and the corresponding upwind interface value, and perform the finite-volume update of the center cell over one time step:\n$$\\bar{q}_{1,1}^{n+1} = \\bar{q}_{1,1}^{n} - \\frac{\\Delta t}{\\Delta x}\\left(F_{1+\\frac{1}{2},1} - F_{1-\\frac{1}{2},1}\\right) - \\frac{\\Delta t}{\\Delta y}\\left(G_{1,1+\\frac{1}{2}} - G_{1,1-\\frac{1}{2}}\\right),$$\nwhere $F$ and $G$ are the $x$- and $y$-direction fluxes, respectively.\n\nCompute the updated center-cell tracer $\\bar{q}_{1,1}^{n+1}$ strictly following this procedure. Express your final answer as a nondimensional tracer mixing ratio and round your answer to four significant figures.",
            "solution": "The finite-volume update for the cell-average tracer $\\bar{q}_{1,1}$ from time step $n$ to $n+1$ is given by:\n$$\n\\bar{q}_{1,1}^{n+1} = \\bar{q}_{1,1}^{n} - \\frac{\\Delta t}{\\Delta x}\\left(F_{1+\\frac{1}{2},1} - F_{1-\\frac{1}{2},1}\\right) - \\frac{\\Delta t}{\\Delta y}\\left(G_{1,1+\\frac{1}{2}} - G_{1,1-\\frac{1}{2}}\\right)\n$$\nwhere $F$ and $G$ are the numerical fluxes in the $x$- and $y$-directions, respectively. The initial tracer value in the center cell is $\\bar{q}_{1,1}^{n} = 1.1$. The mesh spacings are $\\Delta x = 1$ and $\\Delta y = 1$, and the time step is $\\Delta t = 0.5$.\n\nThe procedure involves four main steps:\n\n**1. Compute the limited slopes**\nThe slopes for the central cell $(1,1)$ are computed using one-cell differences and the minmod limiter.\nThe minmod function is defined as:\n$$\n\\operatorname{minmod}(a,b) = \\begin{cases}\n\\operatorname{sign}(a)\\,\\min\\left(|a|,|b|\\right) & \\text{if } a\\,b > 0 \\\\\n0 & \\text{otherwise}\n\\end{cases}\n$$\n\nFor the $x$-direction slope, $s_x(1,1)$, we calculate the two arguments:\n$$\na_x = \\frac{\\bar{q}_{1,1}-\\bar{q}_{0,1}}{\\Delta x} = \\frac{1.1 - 0.9}{1} = 0.2\n$$\n$$\nb_x = \\frac{\\bar{q}_{2,1}-\\bar{q}_{1,1}}{\\Delta x} = \\frac{1.3 - 1.1}{1} = 0.2\n$$\nSince $a_x b_x = (0.2)(0.2) = 0.04 > 0$, the slope is:\n$$\ns_x(1,1) = \\operatorname{minmod}(0.2, 0.2) = \\operatorname{sign}(0.2) \\min(|0.2|, |0.2|) = 1 \\cdot 0.2 = 0.2\n$$\n\nFor the $y$-direction slope, $s_y(1,1)$, the two arguments are:\n$$\na_y = \\frac{\\bar{q}_{1,1}-\\bar{q}_{1,0}}{\\Delta y} = \\frac{1.1 - 1.2}{1} = -0.1\n$$\n$$\nb_y = \\frac{\\bar{q}_{1,2}-\\bar{q}_{1,1}}{\\Delta y} = \\frac{1.0 - 1.1}{1} = -0.1\n$$\nSince $a_y b_y = (-0.1)(-0.1) = 0.01 > 0$, the slope is:\n$$\ns_y(1,1) = \\operatorname{minmod}(-0.1, -0.1) = \\operatorname{sign}(-0.1) \\min(|-0.1|, |-0.1|) = -1 \\cdot 0.1 = -0.1\n$$\n\n**2. Reconstruct the interface values**\nUsing the calculated slopes, we reconstruct the tracer values at the four faces of cell $(1,1)$ by linear extrapolation from the cell center.\n\nValue at the east face ($i=1+1/2$):\n$$\n\\bar{q}_{1+\\frac{1}{2},1}^{(\\text{from }(1,1))} = \\bar{q}_{1,1} + \\frac{1}{2}\\Delta x\\, s_x(1,1) = 1.1 + \\frac{1}{2}(1)(0.2) = 1.1 + 0.1 = 1.2\n$$\nValue at the west face ($i=1-1/2$):\n$$\n\\bar{q}_{1-\\frac{1}{2},1}^{(\\text{from }(1,1))} = \\bar{q}_{1,1} - \\frac{1}{2}\\Delta x\\, s_x(1,1) = 1.1 - \\frac{1}{2}(1)(0.2) = 1.1 - 0.1 = 1.0\n$$\nValue at the north face ($j=1+1/2$):\n$$\n\\bar{q}_{1,1+\\frac{1}{2}}^{(\\text{from }(1,1))} = \\bar{q}_{1,1} + \\frac{1}{2}\\Delta y\\, s_y(1,1) = 1.1 + \\frac{1}{2}(1)(-0.1) = 1.1 - 0.05 = 1.05\n$$\nValue at the south face ($j=1-1/2$):\n$$\n\\bar{q}_{1,1-\\frac{1}{2}}^{(\\text{from }(1,1))} = \\bar{q}_{1,1} - \\frac{1}{2}(1)(-0.1) = 1.1 + 0.05 = 1.15\n$$\n\n**3. Form the advective fluxes**\nThe fluxes are formed using Godunov's upwind method. The problem states that the flow is directed outwards from the central cell at all four faces, so the upwind values are the reconstructed values from within cell $(1,1)$.\n\nEast face flux, $F_{1+\\frac{1}{2},1}$: The velocity is $u_{1+\\frac{1}{2},1} = 0.6 > 0$, so the flow is from cell $(1,1)$.\n$$\nF_{1+\\frac{1}{2},1} = u_{1+\\frac{1}{2},1} \\cdot \\bar{q}_{1+\\frac{1}{2},1}^{(\\text{from }(1,1))} = 0.6 \\times 1.2 = 0.72\n$$\nWest face flux, $F_{1-\\frac{1}{2},1}$: The velocity is $u_{1-\\frac{1}{2},1} = -0.2  0$, so the flow is from cell $(1,1)$.\n$$\nF_{1-\\frac{1}{2},1} = u_{1-\\frac{1}{2},1} \\cdot \\bar{q}_{1-\\frac{1}{2},1}^{(\\text{from }(1,1))} = -0.2 \\times 1.0 = -0.20\n$$\nNorth face flux, $G_{1,1+\\frac{1}{2}}$: The velocity is $v_{1,1+\\frac{1}{2}} = 0.3 > 0$, so the flow is from cell $(1,1)$.\n$$\nG_{1,1+\\frac{1}{2}} = v_{1,1+\\frac{1}{2}} \\cdot \\bar{q}_{1,1+\\frac{1}{2}}^{(\\text{from }(1,1))} = 0.3 \\times 1.05 = 0.315\n$$\nSouth face flux, $G_{1,1-\\frac{1}{2}}$: The velocity is $v_{1,1-\\frac{1}{2}} = -0.5  0$, so the flow is from cell $(1,1)$.\n$$\nG_{1,1-\\frac{1}{2}} = v_{1,1-\\frac{1}{2}} \\cdot \\bar{q}_{1,1-\\frac{1}{2}}^{(\\text{from }(1,1))} = -0.5 \\times 1.15 = -0.575\n$$\n\n**4. Update the center-cell tracer value**\nWe substitute the fluxes into the finite-volume update equation:\n$$\n\\bar{q}_{1,1}^{n+1} = 1.1 - \\frac{0.5}{1}\\left(0.72 - (-0.20)\\right) - \\frac{0.5}{1}\\left(0.315 - (-0.575)\\right)\n$$\n$$\n\\bar{q}_{1,1}^{n+1} = 1.1 - 0.5\\left(0.72 + 0.20\\right) - 0.5\\left(0.315 + 0.575\\right)\n$$\n$$\n\\bar{q}_{1,1}^{n+1} = 1.1 - 0.5\\left(0.92\\right) - 0.5\\left(0.89\\right)\n$$\n$$\n\\bar{q}_{1,1}^{n+1} = 1.1 - 0.46 - 0.445\n$$\n$$\n\\bar{q}_{1,1}^{n+1} = 1.1 - 0.905\n$$\n$$\n\\bar{q}_{1,1}^{n+1} = 0.195\n$$\nThe problem requires the answer to be rounded to four significant figures. The calculated value $0.195$ becomes $0.1950$.",
            "answer": "$$\\boxed{0.1950}$$"
        }
    ]
}