{
    "hands_on_practices": [
        {
            "introduction": "The hyperdiffusion operator is a powerful tool, but its effectiveness depends on choosing the right coefficient, $\\nu_p$. This exercise bridges the gap between the abstract mathematical operator and its physical impact. By performing dimensional analysis and linking the coefficient to a target e-folding decay time, you will learn how to calibrate hyperdiffusion to selectively damp numerical noise at a specific length scale, a fundamental task in configuring weather and climate models. ",
            "id": "4069911",
            "problem": "In a spectral numerical weather prediction and climate modeling context, hyperdiffusion is used to selectively damp small-scale variance while minimally affecting large scales. Consider a prognostic scalar field $q(\\mathbf{x}, t)$ on a periodic domain that is augmented with an isotropic $2p$-order hyperdiffusion of the form\n$$\n\\frac{\\partial q}{\\partial t} \\;=\\; - \\nu_{p} \\left(-\\nabla^{2}\\right)^{p} q,\n$$\nwhere $p \\in \\mathbb{N}$ is the hyperdiffusion order and $\\nu_{p}$ is a positive coefficient. Assume the field $q$ has arbitrary but consistent physical units.\n\n1) Using only dimensional analysis based on the equation above and the fundamental dimensions of time $T$ and length $L$, determine the dimension $[\\nu_{p}]$ of the hyperdiffusion coefficient.\n\n2) Suppose the modeling goal is to set the coefficient so that Fourier modes at a prescribed cut-off wavenumber $k_{c}$ have an e-folding decay time $\\tau(k_{c})$. Work in one spatial dimension with a uniform periodic grid of spacing $\\Delta x$ and define the Nyquist wavenumber as $k_{N} = \\pi / \\Delta x$. Take $p = 4$, $\\Delta x = 10\\,\\mathrm{km}$, and choose the target cut-off wavenumber as $k_{c} = \\alpha\\, k_{N}$ with $\\alpha = 0.6$. The target e-folding time is $\\tau(k_{c}) = 3\\,\\mathrm{h}$. Using Fourier-mode analysis of the linear operator and the definition of e-folding time, derive a formula for $\\nu_{p}$ as a function of $\\tau(k_{c})$ and $k_{c}$ and then compute the numerical value of $\\nu_{p}$ for these parameters.\n\nExpress your final numerical value of $\\nu_{p}$ in $\\mathrm{m}^{8}\\,\\mathrm{s}^{-1}$ and round your answer to three significant figures.",
            "solution": "The problem is subjected to validation before a solution is attempted.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- The governing equation is $\\frac{\\partial q}{\\partial t} = - \\nu_{p} \\left(-\\nabla^{2}\\right)^{p} q$.\n- $p \\in \\mathbb{N}$ is the hyperdiffusion order.\n- $\\nu_{p}$ is a positive coefficient.\n- $q(\\mathbf{x}, t)$ is a prognostic scalar field on a periodic domain.\n- Fundamental dimensions for analysis are time $T$ and length $L$.\n- Part 1 Goal: Determine the dimension $[\\nu_{p}]$.\n- Part 2 Parameters:\n  - Spatial dimension is $1$.\n  - Grid spacing $\\Delta x = 10\\,\\mathrm{km}$.\n  - Nyquist wavenumber $k_{N} = \\pi / \\Delta x$.\n  - Hyperdiffusion order $p = 4$.\n  - Target cut-off wavenumber $k_{c} = \\alpha\\, k_{N}$ with $\\alpha = 0.6$.\n  - Target e-folding time at the cut-off wavenumber is $\\tau(k_{c}) = 3\\,\\mathrm{h}$.\n- Part 2 Goal: Derive a formula for $\\nu_{p}$ and compute its numerical value in $\\mathrm{m}^{8}\\,\\mathrm{s}^{-1}$, rounded to three significant figures.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is based on the standard mathematical formulation of hyperdiffusion, a widely used numerical dissipation scheme in spectral models for weather and climate. The use of Fourier analysis to determine the damping characteristics of such an operator is a fundamental and correct technique.\n- **Well-Posed:** The problem is well-posed. Both parts ask specific questions for which all necessary information is provided. The goals are clear, and a unique, meaningful solution can be derived.\n- **Objective:** The problem is stated in precise, objective language, free of ambiguity or subjective claims.\n\n**Step 3: Verdict and Action**\nThe problem is valid. It is scientifically sound, self-contained, and well-posed. A solution will be provided.\n\n### Solution\n\n**Part 1: Dimensional Analysis of $\\nu_p$**\n\nThe governing equation for hyperdiffusion is given as:\n$$\n\\frac{\\partial q}{\\partial t} = - \\nu_{p} \\left(-\\nabla^{2}\\right)^{p} q\n$$\nTo perform dimensional analysis, we examine the dimensions of each term in the equation. Let $[X]$ denote the dimension of a quantity $X$. The fundamental dimensions are length $L$ and time $T$. The dimension of the scalar field $q$ is denoted as $[q]$.\n\nThe dimension of the left-hand side is the time rate of change of $q$:\n$$\n\\left[\\frac{\\partial q}{\\partial t}\\right] = \\frac{[q]}{[t]} = [q]T^{-1}\n$$\nFor the right-hand side, we first determine the dimension of the Laplacian operator, $\\nabla^2 = \\sum_{i} \\frac{\\partial^2}{\\partial x_i^2}$. Since each term involves a second derivative with respect to a spatial coordinate, its dimension is $L^{-2}$:\n$$\n[\\nabla^2] = L^{-2}\n$$\nThe operator $\\left(-\\nabla^{2}\\right)^{p}$ therefore has the dimension:\n$$\n\\left[\\left(-\\nabla^{2}\\right)^{p}\\right] = (L^{-2})^{p} = L^{-2p}\n$$\nThe dimension of the entire right-hand side is the product of the dimensions of $\\nu_p$, the operator, and $q$:\n$$\n\\left[- \\nu_{p} \\left(-\\nabla^{2}\\right)^{p} q\\right] = [\\nu_{p}] \\left[\\left(-\\nabla^{2}\\right)^{p}\\right] [q] = [\\nu_{p}] L^{-2p} [q]\n$$\nFor the equation to be dimensionally consistent, the dimensions of the left and right sides must be equal:\n$$\n[q]T^{-1} = [\\nu_{p}] L^{-2p} [q]\n$$\nThe dimension of the field, $[q]$, cancels from both sides, which is why its specific physical units are not required. This leaves:\n$$\nT^{-1} = [\\nu_{p}] L^{-2p}\n$$\nSolving for the dimension of the hyperdiffusion coefficient, $[\\nu_{p}]$, we obtain:\n$$\n[\\nu_{p}] = L^{2p} T^{-1}\n$$\n\n**Part 2: Derivation and Calculation of $\\nu_4$**\n\nWe are asked to analyze the one-dimensional version of the equation:\n$$\n\\frac{\\partial q}{\\partial t} = - \\nu_{p} \\left(-\\frac{\\partial^2}{\\partial x^2}\\right)^{p} q\n$$\nTo understand how this operator affects different spatial scales, we perform a Fourier analysis. A solution $q(x,t)$ can be represented as a superposition of Fourier modes of the form $q_k(x,t) = \\hat{q}(k,t) e^{ikx}$, where $k$ is the wavenumber and $\\hat{q}(k,t)$ is the complex amplitude of the mode.\n\nSubstituting a single mode into the equation, we observe how the spatial derivative operator acts on the exponential term:\n$$\n\\frac{\\partial^2}{\\partial x^2} \\left(e^{ikx}\\right) = (ik)^2 e^{ikx} = -k^2 e^{ikx}\n$$\nTherefore, the operator $\\left(-\\frac{\\partial^2}{\\partial x^2}\\right)$ acting on $e^{ikx}$ is equivalent to multiplication by $k^2$. Applying the $p$-th power of this operator yields:\n$$\n\\left(-\\frac{\\partial^2}{\\partial x^2}\\right)^{p} \\left(e^{ikx}\\right) = (k^2)^p e^{ikx} = k^{2p} e^{ikx}\n$$\nSubstituting the single mode $q_k(x,t)$ into the governing PDE gives:\n$$\n\\frac{\\partial}{\\partial t} \\left(\\hat{q}(k,t) e^{ikx}\\right) = - \\nu_{p} \\hat{q}(k,t) \\left(-\\frac{\\partial^2}{\\partial x^2}\\right)^{p} e^{ikx}\n$$\n$$\n\\frac{d\\hat{q}(k,t)}{dt} e^{ikx} = - \\nu_{p} \\hat{q}(k,t) \\left(k^{2p} e^{ikx}\\right)\n$$\nThis simplifies to an ordinary differential equation for the amplitude of each Fourier mode:\n$$\n\\frac{d\\hat{q}}{dt} = -(\\nu_p k^{2p}) \\hat{q}\n$$\nThe solution to this first-order linear ODE is an exponential decay:\n$$\n\\hat{q}(k,t) = \\hat{q}(k,0) \\exp\\left(-\\nu_p k^{2p} t\\right)\n$$\nThe e-folding decay time, $\\tau(k)$, is the time required for the amplitude to decrease by a factor of $e$. This occurs when the argument of the exponential equals $-1$:\n$$\n\\nu_p k^{2p} \\tau(k) = 1\n$$\nSolving for the hyperdiffusion coefficient $\\nu_p$, we get the desired formula:\n$$\n\\nu_p = \\frac{1}{\\tau(k) k^{2p}}\n$$\nWe are given the following parameters for the calculation:\n- Hyperdiffusion order: $p=4$.\n- Grid spacing: $\\Delta x = 10\\,\\mathrm{km} = 10 \\times 10^3\\,\\mathrm{m} = 10^4\\,\\mathrm{m}$.\n- Target e-folding time: $\\tau(k_c) = 3\\,\\mathrm{h} = 3 \\times 3600\\,\\mathrm{s} = 10800\\,\\mathrm{s}$.\n- The target wavenumber $k_c$ is specified relative to the Nyquist wavenumber $k_N$: $k_c = \\alpha k_N$ with $\\alpha = 0.6$.\n\nFirst, we calculate the Nyquist wavenumber $k_N$:\n$$\nk_N = \\frac{\\pi}{\\Delta x} = \\frac{\\pi}{10^4}\\,\\mathrm{m}^{-1}\n$$\nNext, we determine the target wavenumber $k_c$:\n$$\nk_c = 0.6 \\, k_N = \\frac{0.6 \\pi}{10^4}\\,\\mathrm{m}^{-1}\n$$\nNow, we substitute $p=4$ and the expressions for $\\tau(k_c)$ and $k_c$ into the derived formula for $\\nu_p$:\n$$\n\\nu_4 = \\frac{1}{\\tau(k_c) k_c^{8}} = \\frac{1}{(10800\\,\\mathrm{s}) \\left( \\frac{0.6 \\pi}{10^4\\,\\mathrm{m}} \\right)^8}\n$$\nWe compute the numerical value:\n$$\n\\nu_4 = \\frac{(10^4)^8}{10800 \\cdot (0.6)^8 \\cdot \\pi^8} \\,\\mathrm{m}^8 \\mathrm{s}^{-1} = \\frac{10^{32}}{10800 \\cdot (0.6)^8 \\cdot \\pi^8} \\,\\mathrm{m}^8 \\mathrm{s}^{-1}\n$$\nCalculating the denominator:\n$$\n10800 \\cdot (0.6)^8 \\cdot \\pi^8 \\approx 10800 \\cdot (0.016796) \\cdot (9488.5) \\approx 1.7211 \\times 10^6\n$$\nSo, we have:\n$$\n\\nu_4 \\approx \\frac{10^{32}}{1.7211 \\times 10^6} \\approx 5.81023 \\times 10^{25} \\, \\mathrm{m}^8 \\mathrm{s}^{-1}\n$$\nRounding the result to three significant figures, as requested:\n$$\n\\nu_4 \\approx 5.81 \\times 10^{25}\\,\\mathrm{m}^8\\,\\mathrm{s}^{-1}\n$$\nThis value gives the required damping rate at the specified small scale. Note that for $p=4$, the dimension of $\\nu_4$ is $L^{2 \\times 4} T^{-1} = L^8 T^{-1}$, consistent with the units $\\mathrm{m}^8\\,\\mathrm{s}^{-1}$.",
            "answer": "$$\\boxed{5.81 \\times 10^{25}}$$"
        },
        {
            "introduction": "Moving from the continuous world to a discrete grid, we must ensure our numerical filter behaves as intended. The primary advantage of high-order hyperdiffusion is its scale selectivity: the ability to aggressively damp short, unphysical waves while leaving dynamically important long waves untouched. This practice will have you derive the amplification factor of a standard fourth-order filter, providing a direct, quantitative measure of how the filter's damping effect varies with wavenumber. ",
            "id": "4069912",
            "problem": "Consider a one-dimensional, uniformly spaced periodic grid with points $x_i = i\\,\\Delta x$, where $i \\in \\{0,1,\\dots,N-1\\}$ and $N$ is even. Let $u_i$ denote a discrete scalar prognostic variable defined on this grid. A single explicit application of a fourth-order hyperdiffusive numerical filter is defined by\n$$\nu_i^{(f)} \\;=\\; u_i \\;-\\; \\mu\\,\\Big(u_{i-2} \\;-\\; 4\\,u_{i-1} \\;+\\; 6\\,u_i \\;-\\; 4\\,u_{i+1} \\;+\\; u_{i+2}\\Big),\n$$\nwith constant coefficient $0 < \\mu \\le \\frac{1}{16}$ chosen so that the attenuation is nonnegative for all resolvable wavenumbers. Assume periodic boundary conditions so that indices wrap modulo $N$. This filter is intended to represent scale-selective hyperdiffusion used in numerical weather prediction and climate modeling to control grid-scale noise while minimally affecting dynamically important long waves.\n\nStarting from the definitions of linear time-invariant (LTI) discrete operators and the fact that complex Fourier modes $u_i = \\hat{u}\\,\\exp\\big(i\\,k\\,x_i\\big)$ are eigenfunctions of any LTI operator on a uniform grid, derive the real amplification factor $G(k)$ such that $u_i^{(f)} = G(k)\\,u_i$ for a pure Fourier mode of wavenumber $k$. Express your derivation in terms of the nondimensional wavenumber $\\xi \\equiv k\\,\\Delta x$ (angles in radians). Then, for the specific parameter choice $\\mu = \\frac{1}{32}$, compute the numerical values of $G(k)$ at the nondimensional wavenumbers $k\\,\\Delta x \\in \\left\\{\\frac{\\pi}{4},\\,\\frac{\\pi}{2},\\,\\frac{3\\pi}{4}\\right\\}$ and round your answers to four significant figures. Finally, interpret how the attenuation varies with $\\xi$ and explain what this implies for the filterâ€™s scale selectivity compared to a second-order (Laplacian) diffusion.",
            "solution": "The user wants me to analyze a fourth-order hyperdiffusive numerical filter.\n\n**Problem Validation**\n\nThe problem provides a well-defined fourth-order hyperdiffusive filter common in numerical modeling. It asks for the derivation of its amplification factor, calculation of its value for specific parameters, and an interpretation of its scale-selective properties. All definitions, constants, and conditions are explicitly stated. The problem is scientifically grounded in the field of numerical analysis for partial differential equations, is well-posed, objective, and contains sufficient information for a unique solution. Therefore, the problem is deemed valid.\n\n**Part 1: Derivation of the Amplification Factor $G(k)$**\n\nThe fourth-order hyperdiffusive filter is applied to a discrete variable $u_i$ as:\n$$\nu_i^{(f)} = u_i - \\mu \\left( u_{i-2} - 4u_{i-1} + 6u_i - 4u_{i+1} + u_{i+2} \\right)\n$$\nWe are asked to find the amplification factor $G(k)$ which satisfies $u_i^{(f)} = G(k) u_i$ for a pure Fourier mode $u_i = \\hat{u} \\exp(i k x_i)$. The grid points are defined as $x_i = i \\Delta x$.\n\nSubstituting the Fourier mode into the definition of $u_i^{(f)}$:\n$$\nG(k) u_i = u_i - \\mu \\left( u_{i-2} - 4u_{i-1} + 6u_i - 4u_{i+1} + u_{i+2} \\right)\n$$\nDividing by $u_i$ (which is non-zero for a non-trivial mode), we get an expression for $G(k)$:\n$$\nG(k) = 1 - \\mu \\left( \\frac{u_{i-2}}{u_i} - 4\\frac{u_{i-1}}{u_i} + 6 - 4\\frac{u_{i+1}}{u_i} + \\frac{u_{i+2}}{u_i} \\right)\n$$\nFor a Fourier mode, the ratio of the variable at two grid points separated by $m$ grid cells is:\n$$\n\\frac{u_{i+m}}{u_i} = \\frac{\\hat{u} \\exp(ikx_{i+m})}{\\hat{u} \\exp(ikx_{i})} = \\frac{\\exp(ik(i+m)\\Delta x)}{\\exp(ik i \\Delta x)} = \\exp(ikm\\Delta x)\n$$\nLet the nondimensional wavenumber be $\\xi \\equiv k \\Delta x$. The ratio becomes $\\exp(im\\xi)$. Substituting this into the equation for $G(k)$:\n$$\nG(k) = 1 - \\mu \\left( \\exp(-2i\\xi) - 4\\exp(-i\\xi) + 6 - 4\\exp(i\\xi) + \\exp(2i\\xi) \\right)\n$$\nWe can group the complex exponential terms using Euler's formula, $\\cos(\\theta) = \\frac{\\exp(i\\theta) + \\exp(-i\\theta)}{2}$:\n$$\nG(k) = 1 - \\mu \\left[ (\\exp(2i\\xi) + \\exp(-2i\\xi)) - 4(\\exp(i\\xi) + \\exp(-i\\xi)) + 6 \\right]\n$$\n$$\nG(k) = 1 - \\mu \\left[ 2\\cos(2\\xi) - 8\\cos(\\xi) + 6 \\right]\n$$\n$$\nG(k) = 1 - 2\\mu \\left[ \\cos(2\\xi) - 4\\cos(\\xi) + 3 \\right]\n$$\nTo simplify this further, we use the double-angle identity $\\cos(2\\xi) = 2\\cos^2(\\xi) - 1$:\n$$\nG(k) = 1 - 2\\mu \\left[ (2\\cos^2(\\xi) - 1) - 4\\cos(\\xi) + 3 \\right]\n$$\n$$\nG(k) = 1 - 2\\mu \\left[ 2\\cos^2(\\xi) - 4\\cos(\\xi) + 2 \\right]\n$$\n$$\nG(k) = 1 - 4\\mu \\left[ \\cos^2(\\xi) - 2\\cos(\\xi) + 1 \\right]\n$$\nRecognizing the term in the brackets as a perfect square, $(1 - \\cos(\\xi))^2$:\n$$\nG(k) = 1 - 4\\mu (1 - \\cos(\\xi))^2\n$$\nFinally, using the half-angle identity $1 - \\cos(\\xi) = 2\\sin^2(\\xi/2)$:\n$$\nG(k) = 1 - 4\\mu \\left( 2\\sin^2\\left(\\frac{\\xi}{2}\\right) \\right)^2\n$$\n$$\nG(k) = 1 - 16\\mu \\sin^4\\left(\\frac{\\xi}{2}\\right)\n$$\nThis is the real amplification factor expressed in terms of the nondimensional wavenumber $\\xi = k \\Delta x$. As a function of $\\xi$, we can denote it $G(\\xi)$.\n\n**Part 2: Calculation of Numerical Values**\n\nWe are given $\\mu = \\frac{1}{32}$ and are asked to compute $G(k)$ for $\\xi = k\\Delta x \\in \\left\\{\\frac{\\pi}{4}, \\frac{\\pi}{2}, \\frac{3\\pi}{4}\\right\\}$.\nSubstituting $\\mu = \\frac{1}{32}$ into the general formula for $G(\\xi)$:\n$$\nG(\\xi) = 1 - 16\\left(\\frac{1}{32}\\right) \\sin^4\\left(\\frac{\\xi}{2}\\right) = 1 - \\frac{1}{2} \\sin^4\\left(\\frac{\\xi}{2}\\right)\n$$\n\nFor $\\xi = \\frac{\\pi}{4}$:\n$$\nG\\left(\\frac{\\pi}{4}\\right) = 1 - \\frac{1}{2} \\sin^4\\left(\\frac{\\pi}{8}\\right)\n$$\nWe use the identity $\\sin^2(\\theta) = \\frac{1 - \\cos(2\\theta)}{2}$. So, $\\sin^2(\\frac{\\pi}{8}) = \\frac{1 - \\cos(\\frac{\\pi}{4})}{2} = \\frac{1 - \\frac{\\sqrt{2}}{2}}{2} = \\frac{2 - \\sqrt{2}}{4}$.\nThen, $\\sin^4(\\frac{\\pi}{8}) = \\left(\\frac{2 - \\sqrt{2}}{4}\\right)^2 = \\frac{4 - 4\\sqrt{2} + 2}{16} = \\frac{6 - 4\\sqrt{2}}{16} = \\frac{3 - 2\\sqrt{2}}{8}$.\n$$\nG\\left(\\frac{\\pi}{4}\\right) = 1 - \\frac{1}{2}\\left(\\frac{3 - 2\\sqrt{2}}{8}\\right) = 1 - \\frac{3 - 2\\sqrt{2}}{16} = \\frac{16 - 3 + 2\\sqrt{2}}{16} = \\frac{13 + 2\\sqrt{2}}{16}\n$$\nNumerically, $G(\\frac{\\pi}{4}) \\approx \\frac{13 + 2(1.41421356)}{16} = \\frac{15.82842712}{16} \\approx 0.9892767$. Rounded to four significant figures, this is $0.9893$.\n\nFor $\\xi = \\frac{\\pi}{2}$:\n$$\nG\\left(\\frac{\\pi}{2}\\right) = 1 - \\frac{1}{2} \\sin^4\\left(\\frac{\\pi}{4}\\right)\n$$\nSince $\\sin(\\frac{\\pi}{4}) = \\frac{\\sqrt{2}}{2}$, we have $\\sin^4(\\frac{\\pi}{4}) = \\left(\\frac{\\sqrt{2}}{2}\\right)^4 = \\frac{4}{16} = \\frac{1}{4}$.\n$$\nG\\left(\\frac{\\pi}{2}\\right) = 1 - \\frac{1}{2}\\left(\\frac{1}{4}\\right) = 1 - \\frac{1}{8} = \\frac{7}{8} = 0.875\n$$\nTo four significant figures, this is $0.8750$.\n\nFor $\\xi = \\frac{3\\pi}{4}$:\n$$\nG\\left(\\frac{3\\pi}{4}\\right) = 1 - \\frac{1}{2} \\sin^4\\left(\\frac{3\\pi}{8}\\right)\n$$\nWe use $\\sin^2(\\frac{3\\pi}{8}) = \\frac{1 - \\cos(\\frac{3\\pi}{4})}{2} = \\frac{1 - (-\\frac{\\sqrt{2}}{2})}{2} = \\frac{1 + \\frac{\\sqrt{2}}{2}}{2} = \\frac{2 + \\sqrt{2}}{4}$.\nThen, $\\sin^4(\\frac{3\\pi}{8}) = \\left(\\frac{2 + \\sqrt{2}}{4}\\right)^2 = \\frac{4 + 4\\sqrt{2} + 2}{16} = \\frac{6 + 4\\sqrt{2}}{16} = \\frac{3 + 2\\sqrt{2}}{8}$.\n$$\nG\\left(\\frac{3\\pi}{4}\\right) = 1 - \\frac{1}{2}\\left(\\frac{3 + 2\\sqrt{2}}{8}\\right) = 1 - \\frac{3 + 2\\sqrt{2}}{16} = \\frac{16 - 3 - 2\\sqrt{2}}{16} = \\frac{13 - 2\\sqrt{2}}{16}\n$$\nNumerically, $G(\\frac{3\\pi}{4}) \\approx \\frac{13 - 2(1.41421356)}{16} = \\frac{10.17157288}{16} \\approx 0.6357233$. Rounded to four significant figures, this is $0.6357$.\n\n**Part 3: Interpretation and Comparison**\n\nThe attenuation of the filter is given by $A(\\xi) = 1 - G(\\xi) = 16\\mu \\sin^4(\\xi/2)$. The nondimensional wavenumber $\\xi = k \\Delta x$ ranges from $0$ for infinitely long waves to $\\pi$ for the shortest resolvable wave of wavelength $2\\Delta x$ (the Nyquist wavelength).\n\nAs $\\xi$ increases from $0$ to $\\pi$, $\\sin(\\xi/2)$ increases monotonically from $0$ to $1$. Consequently, the attenuation $A(\\xi)$ also increases monotonically. This means the filter damps short waves (large $\\xi$) more strongly than long waves (small $\\xi$). For $\\xi \\to 0$, $G(\\xi) \\to 1$ and the attenuation $A(\\xi) \\to 0$, so very long waves are nearly unaffected. For the shortest waves at $\\xi = \\pi$, the attenuation is maximized. This property is known as scale selectivity. The numerical results confirm this: $G(\\frac{\\pi}{4}) > G(\\frac{\\pi}{2}) > G(\\frac{3\\pi}{4})$, meaning the damping increases with wavenumber.\n\nTo compare with a second-order (Laplacian) diffusion filter, we consider a filter of the form $u_i^{(f)} = u_i + \\mu_2(u_{i-1} - 2u_i + u_{i+1})$. Its amplification factor, let's call it $G_2(\\xi)$, can be derived similarly:\n$$\nG_2(\\xi) = 1 + \\mu_2(\\exp(-i\\xi) - 2 + \\exp(i\\xi)) = 1 + \\mu_2(2\\cos(\\xi) - 2) = 1 - 2\\mu_2(1-\\cos(\\xi))\n$$\nUsing the half-angle identity, this becomes:\n$$\nG_2(\\xi) = 1 - 4\\mu_2 \\sin^2\\left(\\frac{\\xi}{2}\\right)\n$$\nThe crucial difference lies in the behavior for small $\\xi$ (long waves). For small $\\theta$, $\\sin(\\theta) \\approx \\theta$.\nThe attenuation of the second-order filter is $A_2(\\xi) = 4\\mu_2 \\sin^2(\\xi/2) \\approx 4\\mu_2 (\\xi/2)^2 = \\mu_2 \\xi^2$.\nThe attenuation of the fourth-order filter is $A_4(\\xi) = 16\\mu \\sin^4(\\xi/2) \\approx 16\\mu (\\xi/2)^4 = \\mu \\xi^4$.\n\nThe attenuation of the fourth-order hyperdiffusion filter is proportional to $\\xi^4$ for long waves, whereas for the second-order Laplacian filter it is proportional to $\\xi^2$. Since $\\xi^4 \\ll \\xi^2$ for small $\\xi$, the hyperdiffusion filter is far more effective at preserving the dynamically important long waves while still removing short-wavelength numerical noise. This superior scale selectivity is why higher-order diffusion is preferred in applications like numerical weather prediction and climate modeling, where preserving the large-scale dynamics is paramount.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.9893 & 0.8750 & 0.6357 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Numerical filters and sponge layers do not operate in isolation; they are part of a larger system that includes dynamics like advection. Adding these dissipative terms alters the stability properties of the overall numerical scheme, which directly impacts the maximum permissible time step $\\Delta t$. This comprehensive exercise guides you through a von Neumann stability analysis of a full advection-hyperdiffusion-sponge system, a critical skill for assessing the robustness and computational limits of a numerical model. ",
            "id": "4069876",
            "problem": "Consider the one-dimensional linear constant-coefficient partial differential equation (PDE) for a conserved scalar field $u(x,t)$,\n$$\n\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} \\;=\\; -\\,\\nu_{4}\\,\\frac{\\partial^{4} u}{\\partial x^{4}} \\;-\\; \\mu\\,u,\n$$\nwhich models linear advection at speed $c$, fourth-order hyperdiffusion with coefficient $\\nu_{4} \\ge 0$, and a uniform Rayleigh sponge (linear damping) with coefficient $\\mu \\ge 0$. Consider a uniform grid with spacing $\\Delta x$ and explicit forward-Euler time stepping with time step $\\Delta t$. Discretize the spatial derivatives as follows:\n- Approximate the first derivative by the second-order centered finite difference,\n$$\n\\left.\\frac{\\partial u}{\\partial x}\\right|_{j}^{n} \\approx \\frac{u_{j+1}^{n} - u_{j-1}^{n}}{2\\,\\Delta x}.\n$$\n- Approximate the fourth derivative by the standard five-point stencil,\n$$\n\\left.\\frac{\\partial^{4} u}{\\partial x^{4}}\\right|_{j}^{n} \\approx \\frac{u_{j-2}^{n} - 4 u_{j-1}^{n} + 6 u_{j}^{n} - 4 u_{j+1}^{n} + u_{j+2}^{n}}{\\Delta x^{4}}.\n$$\nThis yields the explicit scheme\n$$\nu_{j}^{n+1} \\;=\\; u_{j}^{n} \\;-\\; \\frac{c\\,\\Delta t}{2\\,\\Delta x}\\,\\bigl(u_{j+1}^{n} - u_{j-1}^{n}\\bigr) \\;-\\; \\frac{\\nu_{4}\\,\\Delta t}{\\Delta x^{4}}\\,\\bigl(u_{j-2}^{n} - 4 u_{j-1}^{n} + 6 u_{j}^{n} - 4 u_{j+1}^{n} + u_{j+2}^{n}\\bigr) \\;-\\; \\mu\\,\\Delta t\\,u_{j}^{n}.\n$$\nDefine the nondimensional Courant number $C = c\\,\\Delta t / \\Delta x$, the nondimensional hyperdiffusion number $H = \\nu_{4}\\,\\Delta t / \\Delta x^{4}$, and the nondimensional sponge strength $R = \\mu\\,\\Delta t$. Perform a von Neumann (Fourier) stability analysis for this scheme on a periodic grid by substituting $u_{j}^{n} = \\widehat{u}^{n}\\,\\exp(i\\,j\\,\\theta)$ with wavenumber phase $\\theta \\in [0,\\pi]$, and derive the amplification factor $G(\\theta)$ and the stability condition $|G(\\theta)| \\le 1$ for all $\\theta \\in [0,\\pi]$. Using this condition, determine the exact stability region in terms of the nondimensional parameters $(C,H,R)$ by obtaining a closed-form expression for the maximum admissible Courant number $C_{\\max}(H,R)$ as a function of $H$ and $R$. Assume the endpoint constraints required by the real-axis modes are satisfied, namely $0 \\le R \\le 2$ and $R + 16\\,H \\le 2$. Express your final answer as a single analytic expression for $C_{\\max}(H,R)$ involving only elementary functions and, if needed, a minimization over the Fourier phase. No numerical evaluation is required, and no rounding is needed. The final answer must be given as a symbolic expression with no units.",
            "solution": "The user wants to find the stability condition for a given finite difference scheme.\n\n### Step 1: Problem Validation\n\n**1. Extract Givens:**\n- **PDE:** $\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = -\\nu_{4}\\frac{\\partial^{4} u}{\\partial x^{4}} - \\mu u$\n- **Spatial Grid Spacing:** $\\Delta x$\n- **Time Step:** $\\Delta t$ (Forward-Euler)\n- **First Derivative Discretization:** $\\left.\\frac{\\partial u}{\\partial x}\\right|_{j}^{n} \\approx \\frac{u_{j+1}^{n} - u_{j-1}^{n}}{2\\Delta x}$\n- **Fourth Derivative Discretization:** $\\left.\\frac{\\partial^{4} u}{\\partial x^{4}}\\right|_{j}^{n} \\approx \\frac{u_{j-2}^{n} - 4 u_{j-1}^{n} + 6 u_{j}^{n} - 4 u_{j+1}^{n} + u_{j+2}^{n}}{\\Delta x^{4}}$\n- **Full Discrete Scheme:** $u_{j}^{n+1} = u_{j}^{n} - \\frac{c\\Delta t}{2\\Delta x}(u_{j+1}^{n} - u_{j-1}^{n}) - \\frac{\\nu_{4}\\Delta t}{\\Delta x^{4}}(u_{j-2}^{n} - 4 u_{j-1}^{n} + 6 u_{j}^{n} - 4 u_{j+1}^{n} + u_{j+2}^{n}) - \\mu\\Delta t u_{j}^{n}$\n- **Nondimensional Parameters:**\n    - Courant number: $C = \\frac{c\\Delta t}{\\Delta x}$\n    - Hyperdiffusion number: $H = \\frac{\\nu_{4}\\Delta t}{\\Delta x^{4}}$\n    - Sponge strength: $R = \\mu\\Delta t$\n- **von Neumann Analysis Ansatz:** $u_{j}^{n} = \\widehat{u}^{n}\\,\\exp(i j \\theta)$, with wavenumber phase $\\theta \\in [0, \\pi]$.\n- **Task:** Derive the amplification factor $G(\\theta)$ and find a closed-form expression for the maximum admissible Courant number $C_{\\max}(H,R)$.\n- **Constraints:** $0 \\le R \\le 2$ and $R + 16H \\le 2$.\n\n**2. Validate Using Extracted Givens:**\nThe problem is a standard stability analysis of a finite difference scheme for a linear partial differential equation. This is a common topic in numerical analysis, computational fluid dynamics, and numerical weather prediction.\n- **Scientifically Grounded:** The PDE models well-understood physical processes (advection, diffusion, damping). The numerical methods (forward Euler, centered differences) are standard. The von Neumann analysis is the appropriate tool for stability analysis on a periodic domain. The problem is scientifically and mathematically sound.\n- **Well-Posed:** The problem asks for the stability boundary, which is a well-defined concept. The provided information is sufficient to derive the amplification factor and the stability condition. The phrasing \"if needed, a minimization over the Fourier phase\" clarifies how to handle the resulting optimization problem, ensuring a well-defined answer can be formulated.\n- **Objective:** The language is precise and mathematical. All terms are defined. There are no subjective elements.\n- **Completeness and Consistency:** The problem is self-contained. The given constraints on $R$ and $H$ are consistent with the stability requirements at the boundaries of the Fourier domain ($\\theta=0$ and $\\theta=\\pi$), as will be shown in the solution.\n\n**3. Verdict and Action:**\nThe problem is valid. I will proceed with deriving the solution.\n\n### Step 2: Derivation of the Solution\n\nFirst, we rewrite the finite difference scheme using the nondimensional parameters $C$, $H$, and $R$:\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\frac{C}{2}(u_{j+1}^{n} - u_{j-1}^{n}) - H(u_{j-2}^{n} - 4 u_{j-1}^{n} + 6 u_{j}^{n} - 4 u_{j+1}^{n} + u_{j+2}^{n}) - R u_{j}^{n}\n$$\nTo perform the von Neumann stability analysis, we substitute the Fourier mode ansatz $u_{j}^{n} = G(\\theta)^n \\widehat{u}_0 \\exp(i j \\theta)$ into the scheme. The amplification factor is $G(\\theta) = u_j^{n+1}/u_j^n$ for a single mode.\nSubstituting the ansatz and dividing by $G(\\theta)^n \\widehat{u}_0 \\exp(i j \\theta)$, we obtain an expression for $G(\\theta)$:\n$$\nG(\\theta) = 1 - \\frac{C}{2}(\\exp(i\\theta) - \\exp(-i\\theta)) - H(\\exp(-2i\\theta) - 4\\exp(-i\\theta) + 6 - 4\\exp(i\\theta) + \\exp(2i\\theta)) - R\n$$\nUsing Euler's identities, $\\exp(i\\phi) - \\exp(-i\\phi) = 2i\\sin(\\phi)$ and $\\exp(i\\phi) + \\exp(-i\\phi) = 2\\cos(\\phi)$, we can simplify the terms.\nThe advection term becomes:\n$$\n-\\frac{C}{2}(2i\\sin(\\theta)) = -iC\\sin(\\theta)\n$$\nThe hyperdiffusion term can be written as:\n$$\n-H[ (2\\cos(2\\theta)) - 4(2\\cos(\\theta)) + 6 ] = -2H[\\cos(2\\theta) - 4\\cos(\\theta) + 3]\n$$\nThis can be further simplified. A more direct approach is to recognize the stencil coefficients $(1, -4, 6, -4, 1)$ as the result of applying a centered second-difference operator twice. The Fourier symbol of the five-point stencil for the fourth derivative is $(2\\cos(\\theta)-2)^2 = 4(\\cos(\\theta)-1)^2$.\nUsing the half-angle identity $\\cos(\\theta) = 1 - 2\\sin^2(\\theta/2)$, we get:\n$$\n4(\\cos(\\theta)-1)^2 = 4(-2\\sin^2(\\theta/2))^2 = 16\\sin^4(\\theta/2)\n$$\nSo, the amplification factor $G(\\theta)$ is:\n$$\nG(\\theta) = 1 - R - 16H\\sin^4(\\theta/2) - iC\\sin(\\theta)\n$$\nFor the scheme to be stable, the magnitude of the amplification factor must not exceed unity for any wavenumber, i.e., $|G(\\theta)| \\le 1$ for all $\\theta \\in [0, \\pi]$.\n$$\n|G(\\theta)|^2 = \\left(1 - R - 16H\\sin^4(\\theta/2)\\right)^2 + (-C\\sin(\\theta))^2 \\le 1\n$$\nLet's analyze this inequality.\n$$\nC^2\\sin^2(\\theta) \\le 1 - \\left(1 - R - 16H\\sin^4(\\theta/2)\\right)^2\n$$\nThe right-hand side is of the form $1-(1-a)^2 = 2a-a^2=a(2-a)$, with $a = R + 16H\\sin^4(\\theta/2)$.\n$$\nC^2\\sin^2(\\theta) \\le \\left(R + 16H\\sin^4(\\theta/2)\\right) \\left(2 - R - 16H\\sin^4(\\theta/2)\\right)\n$$\nFor this inequality to hold for all $\\theta \\in [0, \\pi]$, the Courant number $C$ must be bounded. We can solve for $C^2$:\n$$\nC^2 \\le \\frac{\\left(R + 16H\\sin^4(\\theta/2)\\right) \\left(2 - R - 16H\\sin^4(\\theta/2)\\right)}{\\sin^2(\\theta)}\n$$\nThis must hold for all $\\theta \\in (0, \\pi)$. The cases $\\theta=0$ and $\\theta=\\pi$ must be checked separately as the denominator is zero.\n- At $\\theta = 0$: $\\sin(0)=0$ and $\\sin(0/2)=0$. $G(0) = 1 - R$. The condition $|G(0)| \\le 1$ implies $|1-R| \\le 1$. Since $R=\\mu\\Delta t \\ge 0$, this yields $-1 \\le 1-R \\le 1$, which simplifies to $0 \\le R \\le 2$. This matches the given constraint.\n- At $\\theta = \\pi$: $\\sin(\\pi)=0$ and $\\sin(\\pi/2)=1$. $G(\\pi) = 1 - R - 16H$. The condition $|G(\\pi)| \\le 1$ implies $|1-R-16H| \\le 1$. Since $R \\ge 0$ and $H \\ge 0$, $1-R-16H \\le 1$ is always true. The other side, $-1 \\le 1-R-16H$, gives $R+16H \\le 2$. This also matches the given constraint.\n\nThe maximum admissible Courant number $C_{\\max}$ is the largest value of $C$ for which the inequality holds for all $\\theta \\in (0, \\pi)$. This means $C^2$ must be less than or equal to the minimum value of the right-hand side.\n$$\nC_{\\max}^2 = \\min_{\\theta \\in (0, \\pi)} \\left[ \\frac{\\left(R + 16H\\sin^4(\\theta/2)\\right) \\left(2 - R - 16H\\sin^4(\\theta/2)\\right)}{\\sin^2(\\theta)} \\right]\n$$\nThe problem asks for a closed-form expression for $C_{\\max}(H,R)$, explicitly allowing for the final expression to contain a minimization over the Fourier phase. Finding an analytical solution to this minimization problem in terms of elementary functions of $H$ and $R$ would require solving a high-degree polynomial equation and is generally intractable. Therefore, the expression including the minimization operator is the required final form.\n\nThe final answer for $C_{\\max}(H,R)$ is the square root of the expression above.\n$$\nC_{\\max}(H,R) = \\sqrt{\\min_{\\theta \\in (0, \\pi)} \\left[ \\frac{\\left(R + 16H\\sin^4(\\frac{\\theta}{2})\\right) \\left(2 - R - 16H\\sin^4(\\frac{\\theta}{2})\\right)}{\\sin^2(\\theta)} \\right]}\n$$\nThis expression is the most detailed closed-form representation of the stability boundary under the problem's constraints.",
            "answer": "$$\n\\boxed{\\sqrt{\\min_{\\theta \\in (0, \\pi)} \\left[ \\frac{\\left(R + 16H\\sin^4(\\frac{\\theta}{2})\\right) \\left(2 - R - 16H\\sin^4(\\frac{\\theta}{2})\\right)}{\\sin^2(\\theta)} \\right]}}\n$$"
        }
    ]
}