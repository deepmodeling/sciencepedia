{
    "hands_on_practices": [
        {
            "introduction": "Understanding the theory of numerical filters is the first step; the next is learning to design them for specific purposes. This practice guides you through the process of constructing a linear filter from first principles, enforcing critical properties like mass conservation and specific damping characteristics . By translating physical and numerical goals into algebraic constraints on the filter's coefficients, you will gain insight into how these tools are engineered.",
            "id": "4069869",
            "problem": "Consider a one-dimensional periodic domain with $N$ even grid points indexed by $i \\in \\{0,1,\\dots,N-1\\}$ and grid spacing $\\Delta x$. Let $q_i$ be a scalar field whose discrete domain mean is $M = \\frac{1}{N} \\sum_{i=0}^{N-1} q_i$. A linear, stationary, symmetric numerical filter is applied to $q_i$ to produce a filtered field $\\tilde{q}_i$ via the $5$-point stencil\n$$\n\\tilde{q}_i \\;=\\; w_0\\, q_i \\;+\\; w_1 \\left(q_{i-1} + q_{i+1}\\right) \\;+\\; w_2 \\left(q_{i-2} + q_{i+2}\\right),\n$$\nwith periodic indexing. This filter is intended to preserve mass (i.e., the discrete domain mean) while damping high wavenumbers that degrade numerical weather prediction and climate model fidelity.\n\nStarting from the definition of the Discrete Fourier Transform (DFT) and the convolution theorem for linear, shift-invariant operators on a periodic grid, derive the condition on the filter coefficients $\\{w_0,w_1,w_2\\}$ that guarantees exact conservation of the discrete mean for any input field $q_i$. Using the DFT representation, the filter’s spectral response (Fourier symbol) can be written as a function $H(\\theta)$ of the nondimensional wavenumber $\\theta \\in [0,\\pi]$. Impose high-wavenumber damping by requiring the following spectral constraints:\n- exact mean preservation at zero wavenumber: $H(0) = 1$,\n- complete removal of the Nyquist mode: $H(\\pi) = 0$,\n- moderate damping of the half-Nyquist mode: $H\\!\\left(\\frac{\\pi}{2}\\right) = \\frac{1}{2}$.\n\nUnder these three constraints, determine the unique coefficients $w_0$, $w_1$, and $w_2$ that satisfy the mean-preserving condition and the specified high-wavenumber damping. Express your final answer as a row vector of the three coefficients in exact fractional form. No rounding is required.",
            "solution": "The problem as stated is valid. It is scientifically grounded in the principles of numerical analysis and Fourier theory as applied to computational fluid dynamics. The problem is well-posed, providing three independent constraints for three unknown filter coefficients, ensuring a unique solution can be determined. The definitions and objectives are stated with mathematical precision and are free of ambiguity or contradiction.\n\nWe will proceed with the solution in three parts. First, we will derive the general condition on the filter weights for the preservation of the discrete domain mean. Second, we will derive the filter's spectral response function. Third, we will apply the specified spectral constraints to form a system of linear equations and solve for the unique filter coefficients.\n\nThe filtered field $\\tilde{q}_i$ is given by the linear, stationary, symmetric $5$-point stencil:\n$$\n\\tilde{q}_i = w_0 q_i + w_1 (q_{i-1} + q_{i+1}) + w_2 (q_{i-2} + q_{i+2})\n$$\nwhere the indices are periodic on a grid of $N$ points, $i \\in \\{0, 1, \\dots, N-1\\}$.\n\nThe first step is to establish the condition for exact conservation of the discrete domain mean, $M = \\frac{1}{N} \\sum_{i=0}^{N-1} q_i$. The mean of the filtered field, $\\tilde{M}$, is $\\tilde{M} = \\frac{1}{N} \\sum_{i=0}^{N-1} \\tilde{q}_i$. For the mean to be conserved, we must have $\\tilde{M} = M$, which implies $\\sum_{i=0}^{N-1} \\tilde{q}_i = \\sum_{i=0}^{N-1} q_i$.\nSubstituting the definition of $\\tilde{q}_i$ into the sum:\n$$\n\\sum_{i=0}^{N-1} \\tilde{q}_i = \\sum_{i=0}^{N-1} \\left[ w_0 q_i + w_1 (q_{i-1} + q_{i+1}) + w_2 (q_{i-2} + q_{i+2}) \\right]\n$$\nBy linearity of summation, we can distribute the sum:\n$$\n\\sum_{i=0}^{N-1} \\tilde{q}_i = w_0 \\sum_{i=0}^{N-1} q_i + w_1 \\sum_{i=0}^{N-1} q_{i-1} + w_1 \\sum_{i=0}^{N-1} q_{i+1} + w_2 \\sum_{i=0}^{N-1} q_{i-2} + w_2 \\sum_{i=0}^{N-1} q_{i+2}\n$$\nDue to the periodic nature of the domain, a sum over a shifted index is identical to the sum over the original index. For any integer shift $k$, $\\sum_{i=0}^{N-1} q_{i-k} = \\sum_{i=0}^{N-1} q_{i+k} = \\sum_{i=0}^{N-1} q_i$.\nTherefore, the equation simplifies to:\n$$\n\\sum_{i=0}^{N-1} \\tilde{q}_i = (w_0 + w_1 + w_1 + w_2 + w_2) \\sum_{i=0}^{N-1} q_i = (w_0 + 2w_1 + 2w_2) \\sum_{i=0}^{N-1} q_i\n$$\nFor this equality to hold for any arbitrary field $q_i$, the coefficients must satisfy the condition:\n$$\nw_0 + 2w_1 + 2w_2 = 1\n$$\nThis is the general condition for the conservation of the discrete mean.\n\nNext, we derive the spectral response (or Fourier symbol) $H(\\theta)$ of the filter. Since the filter is a linear, shift-invariant operator, its action on a single Fourier mode $q_i = \\exp(\\mathrm{j} k_{\\mathrm{phys}} x_i)$ is to multiply it by a complex constant, the spectral response. Here, $x_i = i \\Delta x$, $k_{\\mathrm{phys}}$ is the physical wavenumber, and $\\mathrm{j}$ is the imaginary unit. In the context of a discrete periodic domain of $N$ points, we can write the a Fourier mode as $q_i = \\exp(\\mathrm{j} \\frac{2\\pi m i}{N})$ for some integer mode number $m$. The non-dimensional wavenumber is given as $\\theta = \\frac{2\\pi m}{N}$, so the mode is $q_i = \\exp(\\mathrm{j} i \\theta)$.\nApplying the filter to this mode:\n$$\n\\tilde{q}_i = w_0 \\exp(\\mathrm{j} i \\theta) + w_1 (\\exp(\\mathrm{j} (i-1) \\theta) + \\exp(\\mathrm{j} (i+1) \\theta)) + w_2 (\\exp(\\mathrm{j} (i-2) \\theta) + \\exp(\\mathrm{j} (i+2) \\theta))\n$$\nFactoring out the term $\\exp(\\mathrm{j} i \\theta)$:\n$$\n\\tilde{q}_i = \\exp(\\mathrm{j} i \\theta) \\left[ w_0 + w_1 (\\exp(-\\mathrm{j} \\theta) + \\exp(\\mathrm{j} \\theta)) + w_2 (\\exp(-2\\mathrm{j} \\theta) + \\exp(2\\mathrm{j} \\theta)) \\right]\n$$\nUsing Euler's formula, $\\cos(\\alpha) = \\frac{\\exp(\\mathrm{j}\\alpha) + \\exp(-\\mathrm{j}\\alpha)}{2}$, the expression in the brackets simplifies. The filtered mode is $\\tilde{q}_i = H(\\theta) q_i$, where the spectral response $H(\\theta)$ is:\n$$\nH(\\theta) = w_0 + 2w_1 \\cos(\\theta) + 2w_2 \\cos(2\\theta)\n$$\nThis function describes how the filter amplifies or damps a Fourier mode with non-dimensional wavenumber $\\theta$.\n\nWe now impose the three spectral constraints given in the problem statement to determine the coefficients $w_0$, $w_1$, and $w_2$.\n\n1.  **Exact mean preservation at zero wavenumber:** $H(0) = 1$. The zero wavenumber corresponds to $\\theta = 0$.\n    $$\n    H(0) = w_0 + 2w_1 \\cos(0) + 2w_2 \\cos(0) = w_0 + 2w_1 + 2w_2\n    $$\n    Thus, $w_0 + 2w_1 + 2w_2 = 1$. This is identical to the mean-preserving condition derived earlier, providing a consistency check.\n\n2.  **Complete removal of the Nyquist mode:** $H(\\pi) = 0$. The Nyquist frequency corresponds to the highest resolvable wavenumber, $\\theta = \\pi$.\n    $$\n    H(\\pi) = w_0 + 2w_1 \\cos(\\pi) + 2w_2 \\cos(2\\pi) = w_0 - 2w_1 + 2w_2\n    $$\n    Thus, $w_0 - 2w_1 + 2w_2 = 0$.\n\n3.  **Moderate damping of the half-Nyquist mode:** $H(\\frac{\\pi}{2}) = \\frac{1}{2}$. This mode is at $\\theta = \\frac{\\pi}{2}$.\n    $$\n    H\\left(\\frac{\\pi}{2}\\right) = w_0 + 2w_1 \\cos\\left(\\frac{\\pi}{2}\\right) + 2w_2 \\cos\\left(2 \\cdot \\frac{\\pi}{2}\\right) = w_0 + 2w_1(0) + 2w_2(-1) = w_0 - 2w_2\n    $$\n    Thus, $w_0 - 2w_2 = \\frac{1}{2}$.\n\nWe have obtained a system of three linear equations for the three unknowns $w_0, w_1, w_2$:\n\\begin{align*}\n(1) \\quad & w_0 + 2w_1 + 2w_2 = 1 \\\\\n(2) \\quad & w_0 - 2w_1 + 2w_2 = 0 \\\\\n(3) \\quad & w_0 \\qquad - 2w_2 = \\frac{1}{2}\n\\end{align*}\nWe can solve this system. Subtracting equation (2) from equation (1):\n$$\n(w_0 + 2w_1 + 2w_2) - (w_0 - 2w_1 + 2w_2) = 1 - 0 \\implies 4w_1 = 1 \\implies w_1 = \\frac{1}{4}\n$$\nAdding equation (1) and equation (2):\n$$\n(w_0 + 2w_1 + 2w_2) + (w_0 - 2w_1 + 2w_2) = 1 + 0 \\implies 2w_0 + 4w_2 = 1\n$$\nWe now have a smaller system of two equations for $w_0$ and $w_2$:\n\\begin{align*}\n(A) \\quad & 2w_0 + 4w_2 = 1 \\\\\n(B) \\quad & w_0 - 2w_2 = \\frac{1}{2}\n\\end{align*}\nMultiply equation (B) by $2$:\n$$\n2(w_0 - 2w_2) = 2\\left(\\frac{1}{2}\\right) \\implies 2w_0 - 4w_2 = 1\n$$\nNow add this to equation (A):\n$$\n(2w_0 + 4w_2) + (2w_0 - 4w_2) = 1 + 1 \\implies 4w_0 = 2 \\implies w_0 = \\frac{1}{2}\n$$\nFinally, substitute the value of $w_0$ into equation (3) to find $w_2$:\n$$\n\\frac{1}{2} - 2w_2 = \\frac{1}{2} \\implies -2w_2 = 0 \\implies w_2 = 0\n$$\nThe unique filter coefficients that satisfy all the given constraints are $w_0 = \\frac{1}{2}$, $w_1 = \\frac{1}{4}$, and $w_2 = 0$. The fact that $w_2 = 0$ indicates that a $3$-point stencil is sufficient to meet these particular spectral requirements. The resulting stencil is $\\tilde{q}_i = \\frac{1}{2}q_i + \\frac{1}{4}(q_{i-1} + q_{i+1})$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{2} & \\frac{1}{4} & 0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Higher-order operators like hyperdiffusion are favored in climate and weather models for their excellent scale selectivity. In this exercise, you will quantify this property by deriving and evaluating the amplification factor of a fourth-order hyperdiffusion filter . This analysis will provide a concrete understanding of how such filters effectively remove small-scale numerical noise while preserving the large-scale waves that represent important dynamics.",
            "id": "4069912",
            "problem": "Consider a one-dimensional, uniformly spaced periodic grid with points $x_i = i\\,\\Delta x$, where $i \\in \\{0,1,\\dots,N-1\\}$ and $N$ is even. Let $u_i$ denote a discrete scalar prognostic variable defined on this grid. A single explicit application of a fourth-order hyperdiffusive numerical filter is defined by\n$$\nu_i^{(f)} \\;=\\; u_i \\;-\\; \\mu\\,\\Big(u_{i-2} \\;-\\; 4\\,u_{i-1} \\;+\\; 6\\,u_i \\;-\\; 4\\,u_{i+1} \\;+\\; u_{i+2}\\Big),\n$$\nwith constant coefficient $0 < \\mu \\le \\frac{1}{16}$ chosen so that the attenuation is nonnegative for all resolvable wavenumbers. Assume periodic boundary conditions so that indices wrap modulo $N$. This filter is intended to represent scale-selective hyperdiffusion used in numerical weather prediction and climate modeling to control grid-scale noise while minimally affecting dynamically important long waves.\n\nStarting from the definitions of linear time-invariant (LTI) discrete operators and the fact that complex Fourier modes $u_i = \\hat{u}\\,\\exp\\big(i\\,k\\,x_i\\big)$ are eigenfunctions of any LTI operator on a uniform grid, derive the real amplification factor $G(k)$ such that $u_i^{(f)} = G(k)\\,u_i$ for a pure Fourier mode of wavenumber $k$. Express your derivation in terms of the nondimensional wavenumber $\\xi \\equiv k\\,\\Delta x$ (angles in radians). Then, for the specific parameter choice $\\mu = \\frac{1}{32}$, compute the numerical values of $G(k)$ at the nondimensional wavenumbers $k\\,\\Delta x \\in \\left\\{\\frac{\\pi}{4},\\,\\frac{\\pi}{2},\\,\\frac{3\\pi}{4}\\right\\}$ and round your answers to four significant figures. Finally, interpret how the attenuation varies with $\\xi$ and explain what this implies for the filter’s scale selectivity compared to a second-order (Laplacian) diffusion.",
            "solution": "The problem asks for the analysis of a fourth-order hyperdiffusive numerical filter. We will proceed in three parts: first, deriving the amplification factor; second, calculating its value for specific parameters; and third, interpreting its properties.\n\n**Part 1: Derivation of the Amplification Factor $G(k)$**\n\nThe fourth-order hyperdiffusive filter is applied to a discrete variable $u_i$ as:\n$$\nu_i^{(f)} = u_i - \\mu \\left( u_{i-2} - 4u_{i-1} + 6u_i - 4u_{i+1} + u_{i+2} \\right)\n$$\nWe seek the amplification factor $G(k)$ which satisfies $u_i^{(f)} = G(k) u_i$ for a pure Fourier mode $u_i = \\hat{u} \\exp(i k x_i)$, where $x_i = i \\Delta x$.\n\nSubstituting the Fourier mode into the filter equation and dividing by $u_i$:\n$$\nG(k) = 1 - \\mu \\left( \\frac{u_{i-2}}{u_i} - 4\\frac{u_{i-1}}{u_i} + 6 - 4\\frac{u_{i+1}}{u_i} + \\frac{u_{i+2}}{u_i} \\right)\n$$\nFor a Fourier mode, the ratio of the variable at two grid points separated by $m$ grid cells is $\\frac{u_{i+m}}{u_i} = \\exp(ikm\\Delta x)$. Let the nondimensional wavenumber be $\\xi \\equiv k \\Delta x$. Substituting this into the equation for $G(k)$:\n$$\nG(k) = 1 - \\mu \\left( \\exp(-2i\\xi) - 4\\exp(-i\\xi) + 6 - 4\\exp(i\\xi) + \\exp(2i\\xi) \\right)\n$$\nGrouping terms using Euler's formula, $\\cos(\\theta) = \\frac{\\exp(i\\theta) + \\exp(-i\\theta)}{2}$:\n$$\nG(k) = 1 - \\mu \\left[ (\\exp(2i\\xi) + \\exp(-2i\\xi)) - 4(\\exp(i\\xi) + \\exp(-i\\xi)) + 6 \\right]\n$$\n$$\nG(k) = 1 - \\mu \\left[ 2\\cos(2\\xi) - 8\\cos(\\xi) + 6 \\right] = 1 - 2\\mu \\left[ \\cos(2\\xi) - 4\\cos(\\xi) + 3 \\right]\n$$\nUsing the double-angle identity $\\cos(2\\xi) = 2\\cos^2(\\xi) - 1$:\n$$\nG(k) = 1 - 2\\mu \\left[ (2\\cos^2(\\xi) - 1) - 4\\cos(\\xi) + 3 \\right] = 1 - 4\\mu \\left[ \\cos^2(\\xi) - 2\\cos(\\xi) + 1 \\right]\n$$\nThe term in brackets is the perfect square $(1 - \\cos(\\xi))^2$. Using the half-angle identity $1 - \\cos(\\xi) = 2\\sin^2(\\xi/2)$:\n$$\nG(k) = 1 - 4\\mu (1 - \\cos(\\xi))^2 = 1 - 4\\mu \\left( 2\\sin^2\\left(\\frac{\\xi}{2}\\right) \\right)^2\n$$\n$$\nG(k) = 1 - 16\\mu \\sin^4\\left(\\frac{\\xi}{2}\\right)\n$$\nThis is the real amplification factor, which we can denote as $G(\\xi)$.\n\n**Part 2: Calculation of Numerical Values**\n\nFor $\\mu = \\frac{1}{32}$, the amplification factor is $G(\\xi) = 1 - \\frac{1}{2} \\sin^4(\\frac{\\xi}{2})$.\n\nFor $\\xi = \\frac{\\pi}{4}$:\n$$\nG\\left(\\frac{\\pi}{4}\\right) = 1 - \\frac{1}{2} \\sin^4\\left(\\frac{\\pi}{8}\\right)\n$$\nUsing $\\sin^2(\\theta) = \\frac{1 - \\cos(2\\theta)}{2}$, we have $\\sin^2(\\frac{\\pi}{8}) = \\frac{1 - \\cos(\\pi/4)}{2} = \\frac{1 - \\sqrt{2}/2}{2} = \\frac{2 - \\sqrt{2}}{4}$.\nThen $\\sin^4(\\frac{\\pi}{8}) = \\left(\\frac{2 - \\sqrt{2}}{4}\\right)^2 = \\frac{6 - 4\\sqrt{2}}{16} = \\frac{3 - 2\\sqrt{2}}{8}$.\n$$\nG\\left(\\frac{\\pi}{4}\\right) = 1 - \\frac{1}{2}\\left(\\frac{3 - 2\\sqrt{2}}{8}\\right) = \\frac{13 + 2\\sqrt{2}}{16} \\approx 0.9892767 \\approx 0.9893\n$$\n\nFor $\\xi = \\frac{\\pi}{2}$:\n$$\nG\\left(\\frac{\\pi}{2}\\right) = 1 - \\frac{1}{2} \\sin^4\\left(\\frac{\\pi}{4}\\right) = 1 - \\frac{1}{2}\\left(\\frac{\\sqrt{2}}{2}\\right)^4 = 1 - \\frac{1}{2}\\left(\\frac{1}{4}\\right) = \\frac{7}{8} = 0.8750\n$$\n\nFor $\\xi = \\frac{3\\pi}{4}$:\n$$\nG\\left(\\frac{3\\pi}{4}\\right) = 1 - \\frac{1}{2} \\sin^4\\left(\\frac{3\\pi}{8}\\right)\n$$\nUsing $\\sin^2(\\frac{3\\pi}{8}) = \\frac{1 - \\cos(3\\pi/4)}{2} = \\frac{1 - (-\\sqrt{2}/2)}{2} = \\frac{2 + \\sqrt{2}}{4}$.\nThen $\\sin^4(\\frac{3\\pi}{8}) = \\left(\\frac{2 + \\sqrt{2}}{4}\\right)^2 = \\frac{6 + 4\\sqrt{2}}{16} = \\frac{3 + 2\\sqrt{2}}{8}$.\n$$\nG\\left(\\frac{3\\pi}{4}\\right) = 1 - \\frac{1}{2}\\left(\\frac{3 + 2\\sqrt{2}}{8}\\right) = \\frac{13 - 2\\sqrt{2}}{16} \\approx 0.6357233 \\approx 0.6357\n$$\n\n**Part 3: Interpretation and Comparison**\n\nThe attenuation of the filter is $A(\\xi) = 1 - G(\\xi) = 16\\mu \\sin^4(\\xi/2)$. As the nondimensional wavenumber $\\xi$ increases from $0$ (long waves) to $\\pi$ (short waves), the attenuation increases monotonically from $0$ to $16\\mu$. The numerical results confirm this: the filter has minimal effect at $\\xi = \\pi/4$ ($G \\approx 0.9893$, ~1% damping), moderate effect at $\\xi = \\pi/2$ ($G = 0.875$, 12.5% damping), and strong effect at $\\xi = 3\\pi/4$ ($G \\approx 0.6357$, ~36.4% damping). This property is known as scale selectivity.\n\nA comparable second-order (Laplacian) diffusion filter has an amplification factor of $G_2(\\xi) = 1 - 4\\mu_2 \\sin^2(\\xi/2)$. For small $\\xi$ (long waves), its attenuation is $A_2(\\xi) \\approx \\mu_2 \\xi^2$. In contrast, the attenuation of the fourth-order hyperdiffusion filter is $A_4(\\xi) \\approx \\mu \\xi^4$. Because $\\xi^4$ goes to zero much faster than $\\xi^2$ as $\\xi \\to 0$, the fourth-order filter is far more effective at preserving long waves while still strongly damping short waves. This superior scale selectivity is why hyperdiffusion is preferred in models where preserving large-scale dynamics is critical.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.9893 & 0.8750 & 0.6357 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "A numerical scheme is only useful if it is stable. This final practice addresses the crucial task of analyzing the stability of a complete discretization that includes advection, hyperdiffusion, and a sponge layer . By performing a von Neumann stability analysis, you will determine the constraints on the model's time step, revealing the complex interplay between the Courant number and the parameters governing diffusion and damping.",
            "id": "4069876",
            "problem": "Consider the one-dimensional linear constant-coefficient partial differential equation (PDE) for a conserved scalar field $u(x,t)$,\n$$\n\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} \\;=\\; -\\,\\nu_{4}\\,\\frac{\\partial^{4} u}{\\partial x^{4}} \\;-\\; \\mu\\,u,\n$$\nwhich models linear advection at speed $c$, fourth-order hyperdiffusion with coefficient $\\nu_{4} \\ge 0$, and a uniform Rayleigh sponge (linear damping) with coefficient $\\mu \\ge 0$. Consider a uniform grid with spacing $\\Delta x$ and explicit forward-Euler time stepping with time step $\\Delta t$. Discretize the spatial derivatives as follows:\n- Approximate the first derivative by the second-order centered finite difference,\n$$\n\\left.\\frac{\\partial u}{\\partial x}\\right|_{j}^{n} \\approx \\frac{u_{j+1}^{n} - u_{j-1}^{n}}{2\\,\\Delta x}.\n$$\n- Approximate the fourth derivative by the standard five-point stencil,\n$$\n\\left.\\frac{\\partial^{4} u}{\\partial x^{4}}\\right|_{j}^{n} \\approx \\frac{u_{j-2}^{n} - 4 u_{j-1}^{n} + 6 u_{j}^{n} - 4 u_{j+1}^{n} + u_{j+2}^{n}}{\\Delta x^{4}}.\n$$\nThis yields the explicit scheme\n$$\nu_{j}^{n+1} \\;=\\; u_{j}^{n} \\;-\\; \\frac{c\\,\\Delta t}{2\\,\\Delta x}\\,\\bigl(u_{j+1}^{n} - u_{j-1}^{n}\\bigr) \\;-\\; \\frac{\\nu_{4}\\,\\Delta t}{\\Delta x^{4}}\\,\\bigl(u_{j-2}^{n} - 4 u_{j-1}^{n} + 6 u_{j}^{n} - 4 u_{j+1}^{n} + u_{j+2}^{n}\\bigr) \\;-\\; \\mu\\,\\Delta t\\,u_{j}^{n}.\n$$\nDefine the nondimensional Courant number $C = c\\,\\Delta t / \\Delta x$, the nondimensional hyperdiffusion number $H = \\nu_{4}\\,\\Delta t / \\Delta x^{4}$, and the nondimensional sponge strength $R = \\mu\\,\\Delta t$. Perform a von Neumann (Fourier) stability analysis for this scheme on a periodic grid by substituting $u_{j}^{n} = \\widehat{u}^{n}\\,\\exp(i\\,j\\,\\theta)$ with wavenumber phase $\\theta \\in [0,\\pi]$, and derive the amplification factor $G(\\theta)$ and the stability condition $|G(\\theta)| \\le 1$ for all $\\theta \\in [0,\\pi]$. Using this condition, determine the exact stability region in terms of the nondimensional parameters $(C,H,R)$ by obtaining a closed-form expression for the maximum admissible Courant number $C_{\\max}(H,R)$ as a function of $H$ and $R$. Assume the endpoint constraints required by the real-axis modes are satisfied, namely $0 \\le R \\le 2$ and $R + 16\\,H \\le 2$. Express your final answer as a single analytic expression for $C_{\\max}(H,R)$ involving only elementary functions and, if needed, a minimization over the Fourier phase. No numerical evaluation is required, and no rounding is needed. The final answer must be given as a symbolic expression with no units.",
            "solution": "To perform the von Neumann stability analysis, we begin by rewriting the given explicit scheme in terms of the nondimensional parameters: the Courant number $C = c\\Delta t/\\Delta x$, the hyperdiffusion number $H = \\nu_{4}\\Delta t/\\Delta x^{4}$, and the sponge strength $R = \\mu\\Delta t$.\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\frac{C}{2}(u_{j+1}^{n} - u_{j-1}^{n}) - H(u_{j-2}^{n} - 4 u_{j-1}^{n} + 6 u_{j}^{n} - 4 u_{j+1}^{n} + u_{j+2}^{n}) - R u_{j}^{n}\n$$\nWe substitute the Fourier mode ansatz, $u_{j}^{n} = \\widehat{u}^{n} \\exp(ij\\theta) = G(\\theta)^n \\widehat{u}^{0} \\exp(ij\\theta)$, into the scheme. Here, $G(\\theta)$ is the complex amplification factor for the nondimensional wavenumber $\\theta = k\\Delta x$. Dividing by $u_j^n$, we obtain an expression for $G(\\theta)$:\n$$\nG(\\theta) = \\frac{u_{j}^{n+1}}{u_{j}^{n}} = 1 - \\frac{C}{2}(\\exp(i\\theta) - \\exp(-i\\theta)) - H(\\exp(-2i\\theta) - 4\\exp(-i\\theta) + 6 - 4\\exp(i\\theta) + \\exp(2i\\theta)) - R\n$$\nUsing Euler's identities, $\\exp(i\\phi) - \\exp(-i\\phi) = 2i\\sin(\\phi)$ and $\\exp(i\\phi) + \\exp(-i\\phi) = 2\\cos(\\phi)$, we simplify the terms. The advection term becomes:\n$$\n-\\frac{C}{2}(2i\\sin(\\theta)) = -iC\\sin(\\theta)\n$$\nThe hyperdiffusion term corresponds to the discrete fourth derivative operator. Its Fourier symbol can be simplified:\n$$\n-H[ (\\exp(2i\\theta) + \\exp(-2i\\theta)) - 4(\\exp(i\\theta) + \\exp(-i\\theta)) + 6 ] = -H[ 2\\cos(2\\theta) - 8\\cos(\\theta) + 6 ]\n$$\nUsing the identities $\\cos(2\\theta) = 2\\cos^2(\\theta) - 1$ and $1-\\cos(\\theta) = 2\\sin^2(\\theta/2)$, the term in the brackets becomes:\n$$\n2(2\\cos^2(\\theta)-1) - 8\\cos(\\theta) + 6 = 4\\cos^2(\\theta) - 8\\cos(\\theta) + 4 = 4(\\cos(\\theta)-1)^2 = 4(-2\\sin^2(\\theta/2))^2 = 16\\sin^4(\\theta/2)\n$$\nSubstituting these simplified terms back into the expression for $G(\\theta)$, we get:\n$$\nG(\\theta) = 1 - R - 16H\\sin^4(\\theta/2) - iC\\sin(\\theta)\n$$\nFor the scheme to be numerically stable, the magnitude of the amplification factor must not exceed unity for any wavenumber, i.e., $|G(\\theta)| \\le 1$ for all $\\theta \\in [0, \\pi]$.\n$$\n|G(\\theta)|^2 = \\left(\\mathrm{Re}[G(\\theta)]\\right)^2 + \\left(\\mathrm{Im}[G(\\theta)]\\right)^2 \\le 1\n$$\n$$\n|G(\\theta)|^2 = \\left(1 - R - 16H\\sin^4(\\theta/2)\\right)^2 + (-C\\sin(\\theta))^2 \\le 1\n$$\nTo find the stability boundary for the Courant number $C$, we rearrange the inequality:\n$$\nC^2\\sin^2(\\theta) \\le 1 - \\left(1 - R - 16H\\sin^4(\\theta/2)\\right)^2\n$$\nThe right-hand side is of the form $1-(1-a)^2 = 2a-a^2=a(2-a)$, where $a = R + 16H\\sin^4(\\theta/2)$. The stability condition is therefore:\n$$\nC^2\\sin^2(\\theta) \\le \\left(R + 16H\\sin^4(\\theta/2)\\right) \\left(2 - R - 16H\\sin^4(\\theta/2)\\right)\n$$\nThe given constraints $0 \\le R \\le 2$ and $R + 16H \\le 2$ ensure that the right-hand side is non-negative for all $\\theta$. For the inequality to hold for all wavenumbers, the Courant number $C$ must be bounded by the most restrictive case, which corresponds to the minimum value of the right-hand side expression divided by $\\sin^2(\\theta)$. Thus, the square of the maximum admissible Courant number is:\n$$\nC_{\\max}^2 = \\min_{\\theta \\in (0, \\pi)} \\left[ \\frac{\\left(R + 16H\\sin^4(\\theta/2)\\right) \\left(2 - R - 16H\\sin^4(\\theta/2)\\right)}{\\sin^2(\\theta)} \\right]\n$$\nTaking the square root gives the final expression for the stability limit on the Courant number.",
            "answer": "$$\n\\boxed{\\sqrt{\\min_{\\theta \\in (0, \\pi)} \\left[ \\frac{\\left(R + 16H\\sin^4(\\frac{\\theta}{2})\\right) \\left(2 - R - 16H\\sin^4(\\frac{\\theta}{2})\\right)}{\\sin^2(\\theta)} \\right]}}\n$$"
        }
    ]
}