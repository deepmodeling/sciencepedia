{
    "hands_on_practices": [
        {
            "introduction": "在使用任何数值滤波器之前，理解它如何影响不同空间尺度至关重要。一个滤波器的“尺度选择性”决定了它是否适用于特定模型，因为我们希望在不损害具有物理意义的较大尺度的前提下，抑制数值噪音。第一个练习将引导您完成对数值滤波器响应的基本分析。通过推导和评估四阶超扩散算子的放大因子，您将具体理解这类滤波器如何实现尺度选择性，即优先衰减短波，同时保留长波。",
            "id": "4069912",
            "problem": "考虑一个一维均匀间隔的周期性网格，其上的点为 $x_i = i\\,\\Delta x$，其中 $i \\in \\{0,1,\\dots,N-1\\}$ 且 $N$ 为偶数。设 $u_i$ 是定义在该网格上的一个离散标量预报变量。一次四阶超扩散数值滤波器的显式应用定义为\n$$\nu_i^{(f)} \\;=\\; u_i \\;-\\; \\mu\\,\\Big(u_{i-2} \\;-\\; 4\\,u_{i-1} \\;+\\; 6\\,u_i \\;-\\; 4\\,u_{i+1} \\;+\\; u_{i+2}\\Big),\n$$\n其中常数系数 $0  \\mu \\le \\frac{1}{16}$ 的选择是为了确保对所有可分辨的波数，衰减都是非负的。假设为周期性边界条件，因此指数以 N 为模进行循环。该滤波器旨在表示数值天气预报和气候模拟中使用的尺度选择性超扩散，用于控制网格尺度的噪音，同时对动力学上重要的长波影响最小。\n\n从线性时不变 (LTI) 离散算子的定义以及复傅里叶模态 $u_i = \\hat{u}\\,\\exp\\big(\\mathrm{i}\\,k\\,x_i\\big)$ 是均匀网格上任何 LTI 算子的特征函数这一事实出发，推导出实数放大因子 $G(k)$，使得对于一个波数为 $k$ 的纯傅里叶模态，有 $u_i^{(f)} = G(k)\\,u_i$。用无量纲波数 $\\xi \\equiv k\\,\\Delta x$（以弧度为单位的角度）来表示你的推导。然后，对于特定的参数选择 $\\mu = \\frac{1}{32}$，计算 $G(k)$ 在无量纲波数 $k\\,\\Delta x \\in \\left\\{\\frac{\\pi}{4},\\,\\frac{\\pi}{2},\\,\\frac{3\\pi}{4}\\right\\}$ 处的值，并将答案四舍五入到四位有效数字。最后，解释衰减如何随 $\\xi$ 变化，并说明这对于该滤波器与二阶（拉普拉斯）扩散相比的尺度选择性意味着什么。",
            "solution": "用户要求我分析一个四阶超扩散数值滤波器。\n\n**问题验证**\n\n题目提供了一个在数值模拟中常见的、定义明确的四阶超扩散滤波器。它要求推导其放大因子，计算其在特定参数下的值，并解释其尺度选择性特性。所有的定义、常数和条件都已明确说明。该问题在偏微分方程的数值分析领域具有科学依据，是适定的、客观的，并包含足够的信息以获得唯一解。因此，该问题被认为是有效的。\n\n**第一部分：放大因子 $G(k)$ 的推导**\n\n四阶超扩散滤波器应用于离散变量 $u_i$ 的形式如下：\n$$\nu_i^{(f)} = u_i - \\mu \\left( u_{i-2} - 4u_{i-1} + 6u_i - 4u_{i+1} + u_{i+2} \\right)\n$$\n我们需要找到放大因子 $G(k)$，它对于纯傅里叶模态 $u_i = \\hat{u} \\exp(\\mathrm{i} k x_i)$ 满足 $u_i^{(f)} = G(k) u_i$。网格点定义为 $x_i = i \\Delta x$。\n\n将傅里叶模态代入 $u_i^{(f)}$ 的定义中：\n$$\nG(k) u_i = u_i - \\mu \\left( u_{i-2} - 4u_{i-1} + 6u_i - 4u_{i+1} + u_{i+2} \\right)\n$$\n两边同除以 $u_i$（对于非平凡模态，该值非零），我们得到 $G(k)$ 的表达式：\n$$\nG(k) = 1 - \\mu \\left( \\frac{u_{i-2}}{u_i} - 4\\frac{u_{i-1}}{u_i} + 6 - 4\\frac{u_{i+1}}{u_i} + \\frac{u_{i+2}}{u_i} \\right)\n$$\n对于一个傅里叶模态，变量在相隔 $m$ 个网格单元的两个点上的比值为：\n$$\n\\frac{u_{i+m}}{u_i} = \\frac{\\hat{u} \\exp(\\mathrm{i}k x_{i+m})}{\\hat{u} \\exp(\\mathrm{i}k x_i)} = \\frac{\\exp(\\mathrm{i}k(i+m)\\Delta x)}{\\exp(\\mathrm{i}k i \\Delta x)} = \\exp(\\mathrm{i}km\\Delta x)\n$$\n设无量纲波数为 $\\xi \\equiv k \\Delta x$。该比值变为 $\\exp(\\mathrm{i}m\\xi)$。将其代入 $G(k)$ 的方程中：\n$$\nG(k) = 1 - \\mu \\left( \\exp(-2\\mathrm{i}\\xi) - 4\\exp(-\\mathrm{i}\\xi) + 6 - 4\\exp(\\mathrm{i}\\xi) + \\exp(2\\mathrm{i}\\xi) \\right)\n$$\n我们可以使用欧拉公式 $\\cos(\\theta) = \\frac{\\exp(\\mathrm{i}\\theta) + \\exp(-\\mathrm{i}\\theta)}{2}$ 对复指数项进行分组：\n$$\nG(k) = 1 - \\mu \\left[ (\\exp(2\\mathrm{i}\\xi) + \\exp(-2\\mathrm{i}\\xi)) - 4(\\exp(\\mathrm{i}\\xi) + \\exp(-\\mathrm{i}\\xi)) + 6 \\right]\n$$\n$$\nG(k) = 1 - \\mu \\left[ 2\\cos(2\\xi) - 8\\cos(\\xi) + 6 \\right]\n$$\n$$\nG(k) = 1 - 2\\mu \\left[ \\cos(2\\xi) - 4\\cos(\\xi) + 3 \\right]\n$$\n为了进一步简化，我们使用二倍角恒等式 $\\cos(2\\xi) = 2\\cos^2(\\xi) - 1$：\n$$\nG(k) = 1 - 2\\mu \\left[ (2\\cos^2(\\xi) - 1) - 4\\cos(\\xi) + 3 \\right]\n$$\n$$\nG(k) = 1 - 2\\mu \\left[ 2\\cos^2(\\xi) - 4\\cos(\\xi) + 2 \\right]\n$$\n$$\nG(k) = 1 - 4\\mu \\left[ \\cos^2(\\xi) - 2\\cos(\\xi) + 1 \\right]\n$$\n识别出括号中的项是一个完全平方 $(1 - \\cos(\\xi))^2$：\n$$\nG(k) = 1 - 4\\mu (1 - \\cos(\\xi))^2\n$$\n最后，使用半角恒等式 $1 - \\cos(\\xi) = 2\\sin^2(\\xi/2)$：\n$$\nG(k) = 1 - 4\\mu \\left( 2\\sin^2\\left(\\frac{\\xi}{2}\\right) \\right)^2\n$$\n$$\nG(k) = 1 - 16\\mu \\sin^4\\left(\\frac{\\xi}{2}\\right)\n$$\n这就是用无量纲波数 $\\xi = k \\Delta x$ 表示的实数放大因子。作为 $\\xi$ 的函数，我们可以将其表示为 $G(\\xi)$。\n\n**第二部分：数值计算**\n\n给定 $\\mu = \\frac{1}{32}$，要求我们计算 $G(k)$ 在 $\\xi = k\\Delta x \\in \\left\\{\\frac{\\pi}{4}, \\frac{\\pi}{2}, \\frac{3\\pi}{4}\\right\\}$ 处的值。\n将 $\\mu = \\frac{1}{32}$ 代入 $G(\\xi)$ 的通用公式：\n$$\nG(\\xi) = 1 - 16\\left(\\frac{1}{32}\\right) \\sin^4\\left(\\frac{\\xi}{2}\\right) = 1 - \\frac{1}{2} \\sin^4\\left(\\frac{\\xi}{2}\\right)\n$$\n\n对于 $\\xi = \\frac{\\pi}{4}$：\n$$\nG\\left(\\frac{\\pi}{4}\\right) = 1 - \\frac{1}{2} \\sin^4\\left(\\frac{\\pi}{8}\\right)\n$$\n我们使用恒等式 $\\sin^2(\\theta) = \\frac{1 - \\cos(2\\theta)}{2}$。所以, $\\sin^2(\\frac{\\pi}{8}) = \\frac{1 - \\cos(\\frac{\\pi}{4})}{2} = \\frac{1 - \\frac{\\sqrt{2}}{2}}{2} = \\frac{2 - \\sqrt{2}}{4}$。\n那么, $\\sin^4(\\frac{\\pi}{8}) = \\left(\\frac{2 - \\sqrt{2}}{4}\\right)^2 = \\frac{4 - 4\\sqrt{2} + 2}{16} = \\frac{6 - 4\\sqrt{2}}{16} = \\frac{3 - 2\\sqrt{2}}{8}$。\n$$\nG\\left(\\frac{\\pi}{4}\\right) = 1 - \\frac{1}{2}\\left(\\frac{3 - 2\\sqrt{2}}{8}\\right) = 1 - \\frac{3 - 2\\sqrt{2}}{16} = \\frac{16 - 3 + 2\\sqrt{2}}{16} = \\frac{13 + 2\\sqrt{2}}{16}\n$$\n数值上，$G(\\frac{\\pi}{4}) \\approx \\frac{13 + 2(1.41421356)}{16} = \\frac{15.82842712}{16} \\approx 0.9892767$。四舍五入到四位有效数字，结果是 $0.9893$。\n\n对于 $\\xi = \\frac{\\pi}{2}$：\n$$\nG\\left(\\frac{\\pi}{2}\\right) = 1 - \\frac{1}{2} \\sin^4\\left(\\frac{\\pi}{4}\\right)\n$$\n因为 $\\sin(\\frac{\\pi}{4}) = \\frac{\\sqrt{2}}{2}$，我们有 $\\sin^4(\\frac{\\pi}{4}) = \\left(\\frac{\\sqrt{2}}{2}\\right)^4 = \\frac{4}{16} = \\frac{1}{4}$。\n$$\nG\\left(\\frac{\\pi}{2}\\right) = 1 - \\frac{1}{2}\\left(\\frac{1}{4}\\right) = 1 - \\frac{1}{8} = \\frac{7}{8} = 0.875\n$$\n保留四位有效数字，结果是 $0.8750$。\n\n对于 $\\xi = \\frac{3\\pi}{4}$：\n$$\nG\\left(\\frac{3\\pi}{4}\\right) = 1 - \\frac{1}{2} \\sin^4\\left(\\frac{3\\pi}{8}\\right)\n$$\n我们使用 $\\sin^2(\\frac{3\\pi}{8}) = \\frac{1 - \\cos(\\frac{3\\pi}{4})}{2} = \\frac{1 - (-\\frac{\\sqrt{2}}{2})}{2} = \\frac{1 + \\frac{\\sqrt{2}}{2}}{2} = \\frac{2 + \\sqrt{2}}{4}$。\n那么, $\\sin^4(\\frac{3\\pi}{8}) = \\left(\\frac{2 + \\sqrt{2}}{4}\\right)^2 = \\frac{4 + 4\\sqrt{2} + 2}{16} = \\frac{6 + 4\\sqrt{2}}{16} = \\frac{3 + 2\\sqrt{2}}{8}$。\n$$\nG\\left(\\frac{3\\pi}{4}\\right) = 1 - \\frac{1}{2}\\left(\\frac{3 + 2\\sqrt{2}}{8}\\right) = 1 - \\frac{3 + 2\\sqrt{2}}{16} = \\frac{16 - 3 - 2\\sqrt{2}}{16} = \\frac{13 - 2\\sqrt{2}}{16}\n$$\n数值上，$G(\\frac{3\\pi}{4}) \\approx \\frac{13 - 2(1.41421356)}{16} = \\frac{10.17157288}{16} \\approx 0.6357233$。四舍五入到四位有效数字，结果是 $0.6357$。\n\n**第三部分：解释与比较**\n\n滤波器的衰减由 $A(\\xi) = 1 - G(\\xi) = 16\\mu \\sin^4(\\xi/2)$ 给出。无量纲波数 $\\xi = k \\Delta x$ 的范围从0（对于无限长波）到 $\\pi$（对于波长为 $2\\Delta x$ 的最短可分辨波，即奈奎斯特波长）。\n\n当 $\\xi$ 从 0 增加到 $\\pi$ 时，$\\sin(\\xi/2)$ 从 0 单调增加到 1。因此，衰减 $A(\\xi)$ 也单调增加。这意味着滤波器对短波（大 $\\xi$）的阻尼强于对长波（小 $\\xi$）的阻尼。对于 $\\xi \\to 0$，$G(\\xi) \\to 1$ 且衰减 $A(\\xi) \\to 0$，因此非常长的波几乎不受影响。对于 $\\xi = \\pi$ 的最短波，衰减达到最大。这个属性被称为尺度选择性。数值结果证实了这一点：$G(\\frac{\\pi}{4})  G(\\frac{\\pi}{2})  G(\\frac{3\\pi}{4})$，意味着阻尼随波数的增加而增加。\n\n为了与二阶（拉普拉斯）扩散滤波器进行比较，我们考虑一个形式为 $u_i^{(f)} = u_i + \\mu_2(u_{i-1} - 2u_i + u_{i+1})$ 的滤波器。它的放大因子，我们称之为 $G_2(\\xi)$，可以用类似的方法推导出来：\n$$\nG_2(\\xi) = 1 + \\mu_2(\\exp(-\\mathrm{i}\\xi) - 2 + \\exp(\\mathrm{i}\\xi)) = 1 + \\mu_2(2\\cos(\\xi) - 2) = 1 - 2\\mu_2(1-\\cos(\\xi))\n$$\n使用半角恒等式，这变为：\n$$\nG_2(\\xi) = 1 - 4\\mu_2 \\sin^2\\left(\\frac{\\xi}{2}\\right)\n$$\n关键的区别在于对小 $\\xi$（长波）的行为。对于小 $\\theta$，$\\sin(\\theta) \\approx \\theta$。\n二阶滤波器的衰减是 $A_2(\\xi) = 4\\mu_2 \\sin^2(\\xi/2) \\approx 4\\mu_2 (\\xi/2)^2 = \\mu_2 \\xi^2$。\n四阶滤波器的衰减是 $A_4(\\xi) = 16\\mu \\sin^4(\\xi/2) \\approx 16\\mu (\\xi/2)^4 = \\mu \\xi^4$。\n\n对于长波，四阶超扩散滤波器的衰减与 $\\xi^4$ 成正比，而二阶拉普拉斯滤波器的衰减与 $\\xi^2$ 成正比。由于当 $\\xi$ 很小时 $\\xi^4 \\ll \\xi^2$，超扩散滤波器在保留动力学上重要的长波，同时仍然去除短波长数值噪音方面要有效得多。这种卓越的尺度选择性是为什么在数值天气预报和气候模拟等应用中首选高阶扩散的原因，因为在这些应用中，保留大尺度动力学至关重要。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.9893  0.8750  0.6357 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "虽然存在许多标准滤波器，但数值模型开发者有时需要设计定制化的滤波器以满足特定需求，例如保持物理不变量或针对特定的问题波数。这需要将期望的光谱特性转化为一组模板系数。这个练习将从分析转向设计，挑战您根据一组光谱约束从头开始构建一个数值滤波器。您将确定滤波器的系数，以确保质量守恒并在关键波数上实现特定的衰减水平，从而阐明滤波器结构与其功能之间的直接关系。",
            "id": "4069869",
            "problem": "考虑一个一维周期性区域，其上有$N$个网格点（$N$为偶数），索引为 $i \\in \\{0,1,\\dots,N-1\\}$，网格间距为 $\\Delta x$。设 $q_i$ 是一个标量场，其离散域平均值为 $M = \\frac{1}{N} \\sum_{i=0}^{N-1} q_i$。一个线性、定常、对称的数值滤波器通过5点格式应用于 $q_i$，以生成一个滤波后的场 $\\tilde{q}_i$：\n$$\n\\tilde{q}_i \\;=\\; w_0\\, q_i \\;+\\; w_1 \\left(q_{i-1} + q_{i+1}\\right) \\;+\\; w_2 \\left(q_{i-2} + q_{i+2}\\right),\n$$\n其中索引是周期性的。该滤波器旨在保持质量（即离散域平均值），同时衰减那些会降低数值天气预报和气候模型保真度的高波数。\n\n从离散傅里叶变换（DFT）的定义以及周期性网格上线性移不变算子的卷积定理出发，推导滤波器系数 $\\{w_0,w_1,w_2\\}$ 需满足的条件，以保证对于任何输入场 $q_i$，离散平均值都能精确守恒。使用DFT表示，滤波器的谱响应（傅里叶符号）可以写成无量纲波数 $\\theta \\in [0,\\pi]$ 的函数 $H(\\theta)$。通过要求以下谱约束条件来施加高波数衰减：\n- 在零波数处精确保持平均值：$H(0) = 1$，\n- 完全消除奈奎斯特模态：$H(\\pi) = 0$，\n- 适度衰减半奈奎斯特模态：$H\\!\\left(\\frac{\\pi}{2}\\right) = \\frac{1}{2}$。\n\n在这三个约束条件下，确定满足平均值守恒条件和指定高波数衰减要求的唯一系数 $w_0$、$w_1$ 和 $w_2$。将最终答案表示为由这三个系数组成的行向量，并使用精确的分数形式。无需四舍五入。",
            "solution": "所述问题是有效的。它在科学上基于应用于计算流体动力学的数值分析和傅里叶理论的原理。该问题是适定的，为三个未知的滤波器系数提供了三个独立的约束条件，确保可以确定唯一的解。定义和目标都以数学精度陈述，没有歧义或矛盾。\n\n我们将分三部分进行求解。首先，我们将推导为保持离散域平均值，滤波器权重所需满足的一般条件。其次，我们将推导滤波器的谱响应函数。第三，我们将应用指定的谱约束来建立一个线性方程组，并求解唯一的滤波器系数。\n\n滤波后的场 $\\tilde{q}_i$ 由线性、定常、对称的5点格式给出：\n$$\n\\tilde{q}_i = w_0 q_i + w_1 (q_{i-1} + q_{i+1}) + w_2 (q_{i-2} + q_{i+2})\n$$\n其中索引在包含 $N$ 个点的网格上是周期性的，$i \\in \\{0, 1, \\dots, N-1\\}$。\n\n第一步是建立离散域平均值 $M = \\frac{1}{N} \\sum_{i=0}^{N-1} q_i$ 精确守恒的条件。滤波后场的平均值 $\\tilde{M}$ 为 $\\tilde{M} = \\frac{1}{N} \\sum_{i=0}^{N-1} \\tilde{q}_i$。为了使平均值守恒，我们必须有 $\\tilde{M} = M$，这意味着 $\\sum_{i=0}^{N-1} \\tilde{q}_i = \\sum_{i=0}^{N-1} q_i$。\n将 $\\tilde{q}_i$ 的定义代入求和式中：\n$$\n\\sum_{i=0}^{N-1} \\tilde{q}_i = \\sum_{i=0}^{N-1} \\left[ w_0 q_i + w_1 (q_{i-1} + q_{i+1}) + w_2 (q_{i-2} + q_{i+2}) \\right]\n$$\n根据求和的线性性质，我们可以分配求和：\n$$\n\\sum_{i=0}^{N-1} \\tilde{q}_i = w_0 \\sum_{i=0}^{N-1} q_i + w_1 \\sum_{i=0}^{N-1} q_{i-1} + w_1 \\sum_{i=0}^{N-1} q_{i+1} + w_2 \\sum_{i=0}^{N-1} q_{i-2} + w_2 \\sum_{i=0}^{N-1} q_{i+2}\n$$\n由于区域的周期性，对移位后索引的求和与对原始索引的求和是相同的。对于任何整数位移 $k$，$\\sum_{i=0}^{N-1} q_{i-k} = \\sum_{i=0}^{N-1} q_{i+k} = \\sum_{i=0}^{N-1} q_i$。\n因此，该方程简化为：\n$$\n\\sum_{i=0}^{N-1} \\tilde{q}_i = (w_0 + w_1 + w_1 + w_2 + w_2) \\sum_{i=0}^{N-1} q_i = (w_0 + 2w_1 + 2w_2) \\sum_{i=0}^{N-1} q_i\n$$\n为了使此等式对任意场 $q_i$ 都成立，系数必须满足以下条件：\n$$\nw_0 + 2w_1 + 2w_2 = 1\n$$\n这就是离散平均值守恒的一般条件。\n\n接下来，我们推导滤波器的谱响应（或傅里叶符号）$H(\\theta)$。由于该滤波器是一个线性移不变算子，它对单个傅里叶模态 $q_i = \\exp(\\mathrm{i} k_{\\mathrm{phys}} x_i)$ 的作用是将其乘以一个复常数，即谱响应。这里，$x_i = i \\Delta x$，$k_{\\mathrm{phys}}$ 是物理波数，而 $\\mathrm{i}$ 是虚数单位。在一个包含 $N$ 个点的离散周期域中，我们可以将一个傅里叶模态写成 $q_i = \\exp(\\mathrm{i} \\frac{2\\pi m i}{N})$，其中 $m$ 是某个整数模态数。无量纲波数为 $\\theta = \\frac{2\\pi m}{N}$，因此该模态为 $q_i = \\exp(\\mathrm{i} i \\theta)$。\n将滤波器应用于此模态：\n$$\n\\tilde{q}_i = w_0 \\exp(\\mathrm{i} i \\theta) + w_1 (\\exp(\\mathrm{i} (i-1) \\theta) + \\exp(\\mathrm{i} (i+1) \\theta)) + w_2 (\\exp(\\mathrm{i} (i-2) \\theta) + \\exp(\\mathrm{i} (i+2) \\theta))\n$$\n提出公因子 $\\exp(\\mathrm{i} i \\theta)$：\n$$\n\\tilde{q}_i = \\exp(\\mathrm{i} i \\theta) \\left[ w_0 + w_1 (\\exp(-\\mathrm{i} \\theta) + \\exp(\\mathrm{i} \\theta)) + w_2 (\\exp(-2\\mathrm{i} \\theta) + \\exp(2\\mathrm{i} \\theta)) \\right]\n$$\n使用欧拉公式 $\\cos(\\alpha) = \\frac{\\exp(\\mathrm{i}\\alpha) + \\exp(-\\mathrm{i}\\alpha)}{2}$，方括号中的表达式得以简化。滤波后的模态为 $\\tilde{q}_i = H(\\theta) q_i$，其中谱响应 $H(\\theta)$ 为：\n$$\nH(\\theta) = w_0 + 2w_1 \\cos(\\theta) + 2w_2 \\cos(2\\theta)\n$$\n这个函数描述了滤波器如何放大或衰减具有无量纲波数 $\\theta$ 的傅里叶模态。\n\n现在，我们施加问题陈述中给出的三个谱约束，以确定系数 $w_0$、$w_1$ 和 $w_2$。\n\n1.  **在零波数处精确保持平均值：** $H(0) = 1$。零波数对应于 $\\theta = 0$。\n    $$\n    H(0) = w_0 + 2w_1 \\cos(0) + 2w_2 \\cos(0) = w_0 + 2w_1 + 2w_2\n    $$\n    因此，$w_0 + 2w_1 + 2w_2 = 1$。这与我们之前推导的平均值守恒条件完全相同，提供了一致性检验。\n\n2.  **完全消除奈奎斯特模态：** $H(\\pi) = 0$。奈奎斯特频率对应于最高可分辨波数，即 $\\theta = \\pi$。\n    $$\n    H(\\pi) = w_0 + 2w_1 \\cos(\\pi) + 2w_2 \\cos(2\\pi) = w_0 - 2w_1 + 2w_2\n    $$\n    因此，$w_0 - 2w_1 + 2w_2 = 0$。\n\n3.  **适度衰减半奈奎斯特模态：** $H(\\frac{\\pi}{2}) = \\frac{1}{2}$。该模态位于 $\\theta = \\frac{\\pi}{2}$。\n    $$\n    H\\left(\\frac{\\pi}{2}\\right) = w_0 + 2w_1 \\cos\\left(\\frac{\\pi}{2}\\right) + 2w_2 \\cos\\left(2 \\cdot \\frac{\\pi}{2}\\right) = w_0 + 2w_1(0) + 2w_2(-1) = w_0 - 2w_2\n    $$\n    因此，$w_0 - 2w_2 = \\frac{1}{2}$。\n\n我们得到了一个关于三个未知数 $w_0, w_1, w_2$ 的三元线性方程组：\n\\begin{align*}\n(1) \\quad  w_0 + 2w_1 + 2w_2 = 1 \\\\\n(2) \\quad  w_0 - 2w_1 + 2w_2 = 0 \\\\\n(3) \\quad  w_0 \\qquad - 2w_2 = \\frac{1}{2}\n\\end{align*}\n我们可以解这个方程组。将方程(1)减去方程(2)：\n$$\n(w_0 + 2w_1 + 2w_2) - (w_0 - 2w_1 + 2w_2) = 1 - 0 \\implies 4w_1 = 1 \\implies w_1 = \\frac{1}{4}\n$$\n将方程(1)和方程(2)相加：\n$$\n(w_0 + 2w_1 + 2w_2) + (w_0 - 2w_1 + 2w_2) = 1 + 0 \\implies 2w_0 + 4w_2 = 1\n$$\n我们现在有一个关于 $w_0$ 和 $w_2$ 的更小的二元方程组：\n\\begin{align*}\n(A) \\quad  2w_0 + 4w_2 = 1 \\\\\n(B) \\quad  w_0 - 2w_2 = \\frac{1}{2}\n\\end{align*}\n将方程(B)乘以2：\n$$\n2(w_0 - 2w_2) = 2\\left(\\frac{1}{2}\\right) \\implies 2w_0 - 4w_2 = 1\n$$\n现在将此结果与方程(A)相加：\n$$\n(2w_0 + 4w_2) + (2w_0 - 4w_2) = 1 + 1 \\implies 4w_0 = 2 \\implies w_0 = \\frac{1}{2}\n$$\n最后，将 $w_0$ 的值代入方程(3)以求出 $w_2$：\n$$\n\\frac{1}{2} - 2w_2 = \\frac{1}{2} \\implies -2w_2 = 0 \\implies w_2 = 0\n$$\n满足所有给定约束的唯一滤波器系数是 $w_0 = \\frac{1}{2}$、$w_1 = \\frac{1}{4}$ 和 $w_2 = 0$。$w_2 = 0$ 这个事实表明，一个3点格式足以满足这些特定的谱要求。最终得到的格式是 $\\tilde{q}_i = \\frac{1}{2}q_i + \\frac{1}{4}(q_{i-1} + q_{i+1})$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{2}  \\frac{1}{4}  0 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在一个真实的数值模型中，滤波器并非孤立运行。它们是包含平流等物理过程的更大时间步进格式的一部分。这些组成部分之间的相互作用决定了模拟的整体稳定性和准确性。最后一个练习将数值滤波整合到一个动态环境中，通过考察一个完整的平流-超扩散系统的稳定性。通过进行冯·诺依曼稳定性分析，您将确定由平流、超扩散和阻尼相互作用所施加的时间步长约束，这是建立和运行稳定数值模拟的一项关键技能。",
            "id": "4069876",
            "problem": "考虑一个守恒标量场 $u(x,t)$ 的一维线性常系数偏微分方程（PDE），\n$$\n\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} \\;=\\; -\\,\\nu_{4}\\,\\frac{\\partial^{4} u}{\\partial x^{4}} \\;-\\; \\mu\\,u,\n$$\n该方程模拟了速度为 $c$ 的线性平流、系数为 $\\nu_{4} \\ge 0$ 的四阶超扩散，以及系数为 $\\mu \\ge 0$ 的均匀瑞利海绵（线性阻尼）。考虑一个间距为 $\\Delta x$ 的均匀网格，并采用时间步长为 $\\Delta t$ 的显式前向欧拉时间步进法。空间导数按如下方式离散化：\n- 用二阶中心有限差分近似一阶导数，\n$$\n\\left.\\frac{\\partial u}{\\partial x}\\right|_{j}^{n} \\approx \\frac{u_{j+1}^{n} - u_{j-1}^{n}}{2\\,\\Delta x}.\n$$\n- 用标准的五点格式近似四阶导数，\n$$\n\\left.\\frac{\\partial^{4} u}{\\partial x^{4}}\\right|_{j}^{n} \\approx \\frac{u_{j-2}^{n} - 4 u_{j-1}^{n} + 6 u_{j}^{n} - 4 u_{j+1}^{n} + u_{j+2}^{n}}{\\Delta x^{4}}.\n$$\n由此得到显式格式\n$$\nu_{j}^{n+1} \\;=\\; u_{j}^{n} \\;-\\; \\frac{c\\,\\Delta t}{2\\,\\Delta x}\\,\\bigl(u_{j+1}^{n} - u_{j-1}^{n}\\bigr) \\;-\\; \\frac{\\nu_{4}\\,\\Delta t}{\\Delta x^{4}}\\,\\bigl(u_{j-2}^{n} - 4 u_{j-1}^{n} + 6 u_{j}^{n} - 4 u_{j+1}^{n} + u_{j+2}^{n}\\bigr) \\;-\\; \\mu\\,\\Delta t\\,u_{j}^{n}.\n$$\n定义无量纲的库朗数 $C = c\\,\\Delta t / \\Delta x$、无量纲的超扩散数 $H = \\nu_{4}\\,\\Delta t / \\Delta x^{4}$，以及无量纲的海绵层强度 $R = \\mu\\,\\Delta t$。通过代入 $u_{j}^{n} = \\widehat{u}^{n}\\,\\exp(\\mathrm{i}\\,j\\,\\theta)$（其中波数相位 $\\theta \\in [0,\\pi]$），对该格式在周期性网格上进行 von Neumann (Fourier) 稳定性分析，并推导放大因子 $G(\\theta)$ 和对所有 $\\theta \\in [0,\\pi]$ 都成立的稳定性条件 $|G(\\theta)| \\le 1$。利用此条件，通过获得最大允许库朗数 $C_{\\max}(H,R)$ 作为 $H$ 和 $R$ 的函数的封闭形式表达式，来确定以无量纲参数 $(C,H,R)$ 表示的精确稳定区域。假设实轴模式所需的端点约束已满足，即 $0 \\le R \\le 2$ 和 $R + 16\\,H \\le 2$。将您的最终答案表示为 $C_{\\max}(H,R)$ 的单个解析表达式，其中只包含初等函数，并且如果需要，可以包含对傅里葉相位的最小化。不需要进行数值计算，也无需四舍五入。最终答案必须以无单位的符号表达式给出。",
            "solution": "用户希望找到给定有限差分格式的稳定性条件。\n\n### 步骤 1：问题验证\n\n**1. 提取已知条件：**\n- **偏微分方程（PDE）：** $\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = -\\nu_{4}\\frac{\\partial^{4} u}{\\partial x^{4}} - \\mu u$\n- **空间网格间距：** $\\Delta x$\n- **时间步长：** $\\Delta t$ (前向欧拉)\n- **一阶导数离散化：** $\\left.\\frac{\\partial u}{\\partial x}\\right|_{j}^{n} \\approx \\frac{u_{j+1}^{n} - u_{j-1}^{n}}{2\\Delta x}$\n- **四阶导数离散化：** $\\left.\\frac{\\partial^{4} u}{\\partial x^{4}}\\right|_{j}^{n} \\approx \\frac{u_{j-2}^{n} - 4 u_{j-1}^{n} + 6 u_{j}^{n} - 4 u_{j+1}^{n} + u_{j+2}^{n}}{\\Delta x^{4}}$\n- **完整离散格式：** $u_{j}^{n+1} = u_{j}^{n} - \\frac{c\\Delta t}{2\\Delta x}(u_{j+1}^{n} - u_{j-1}^{n}) - \\frac{\\nu_{4}\\Delta t}{\\Delta x^{4}}(u_{j-2}^{n} - 4 u_{j-1}^{n} + 6 u_{j}^{n} - 4 u_{j+1}^{n} + u_{j+2}^{n}) - \\mu\\Delta t u_{j}^{n}$\n- **无量纲参数：**\n    - 库朗数：$C = \\frac{c\\Delta t}{\\Delta x}$\n    - 超扩散数：$H = \\frac{\\nu_{4}\\Delta t}{\\Delta x^{4}}$\n    - 海绵层强度：$R = \\mu\\Delta t$\n- **von Neumann 分析试探解 (Ansatz)：** $u_{j}^{n} = \\widehat{u}^{n}\\,\\exp(\\mathrm{i} j \\theta)$，波数相位为 $\\theta \\in [0, \\pi]$。\n- **任务：** 推导放大因子 $G(\\theta)$ 并找到最大允许库朗数 $C_{\\max}(H,R)$ 的封闭形式表达式。\n- **约束条件：** $0 \\le R \\le 2$ 和 $R + 16H \\le 2$。\n\n**2. 使用提取的已知条件进行验证：**\n此问题是针对一个线性偏微分方程的有限差分格式的标准稳定性分析。这是数值分析、计算流体力学和数值天气预报中的一个常见课题。\n- **科学依据：** 该偏微分方程模拟了众所周知的物理过程（平流、扩散、阻尼）。所用的数值方法（前向欧拉、中心差分）是标准方法。von Neumann 分析是适用于周期性域上稳定性分析的恰当工具。该问题在科学上和数学上都是合理的。\n- **适定性：** 问题要求找到稳定性边界，这是一个明確定义的-概念。所提供的信息足以推导出放大因子和稳定性条件。“如果需要，可以包含对傅里葉相位的最小化”这一措辭阐明了如何处理由此产生的优化问题，确保可以形成一个明確定义的答案。\n- **客观性：** 语言精确且数学化。所有术语都有定义。没有主观因素。\n- **完整性和一致性：** 问题是自洽的。如解题过程所示，给定的关于 $R$ 和 $H$ 的约束与傅里葉域边界（$\\theta=0$ 和 $\\theta=\\pi$）处的稳定性要求一致。\n\n**3. 判断与行动：**\n问题有效。我将继续推导解答。\n\n### 步骤 2：推导解答\n\n首先，我们使用无量纲参数 $C$、$H$ 和 $R$ 重写有限差分格式：\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\frac{C}{2}(u_{j+1}^{n} - u_{j-1}^{n}) - H(u_{j-2}^{n} - 4 u_{j-1}^{n} + 6 u_{j}^{n} - 4 u_{j+1}^{n} + u_{j+2}^{n}) - R u_{j}^{n}\n$$\n为进行 von Neumann 稳定性分析，我们将傅里葉模式的试探解 $u_{j}^{n} = G(\\theta)^n \\widehat{u}_0 \\exp(\\mathrm{i} j \\theta)$ 代入格式中。对于单个模式，放大因子为 $G(\\theta) = u_j^{n+1}/u_j^n$。\n代入试探解并除以 $G(\\theta)^n \\widehat{u}_0 \\exp(\\mathrm{i} j \\theta)$，我们得到 $G(\\theta)$ 的表达式：\n$$\nG(\\theta) = 1 - \\frac{C}{2}(\\exp(\\mathrm{i}\\theta) - \\exp(-\\mathrm{i}\\theta)) - H(\\exp(-2\\mathrm{i}\\theta) - 4\\exp(-\\mathrm{i}\\theta) + 6 - 4\\exp(\\mathrm{i}\\theta) + \\exp(2\\mathrm{i}\\theta)) - R\n$$\n使用欧拉恒等式 $\\exp(\\mathrm{i}\\phi) - \\exp(-\\mathrm{i}\\phi) = 2\\mathrm{i}\\sin(\\phi)$ 和 $\\exp(\\mathrm{i}\\phi) + \\exp(-\\mathrm{i}\\phi) = 2\\cos(\\phi)$，我们可以简化这些项。\n平流项变为：\n$$\n-\\frac{C}{2}(2\\mathrm{i}\\sin(\\theta)) = -\\mathrm{i}C\\sin(\\theta)\n$$\n超扩散项可以写为：\n$$\n-H[ (2\\cos(2\\theta)) - 4(2\\cos(\\theta)) + 6 ] = -2H[\\cos(2\\theta) - 4\\cos(\\theta) + 3]\n$$\n这可以进一步简化。一个更直接的方法是认识到格式系数 $(1, -4, 6, -4, 1)$ 是中心二阶差分算子应用两次的结果。四阶导数的五点格式的傅里葉符号是 $(2\\cos(\\theta)-2)^2 = 4(\\cos(\\theta)-1)^2$。\n使用半角恒等式 $\\cos(\\theta) = 1 - 2\\sin^2(\\theta/2)$，我们得到：\n$$\n4(\\cos(\\theta)-1)^2 = 4(-2\\sin^2(\\theta/2))^2 = 16\\sin^4(\\theta/2)\n$$\n因此，放大因子 $G(\\theta)$ 是：\n$$\nG(\\theta) = 1 - R - 16H\\sin^4(\\theta/2) - \\mathrm{i}C\\sin(\\theta)\n$$\n为了使格式稳定，放大因子的模对于任何波数都不能超过 1，即对所有 $\\theta \\in [0, \\pi]$ 都有 $|G(\\theta)| \\le 1$。\n$$\n|G(\\theta)|^2 = \\left(1 - R - 16H\\sin^4(\\theta/2)\\right)^2 + (-C\\sin(\\theta))^2 \\le 1\n$$\n我们来分析这个不等式。\n$$\nC^2\\sin^2(\\theta) \\le 1 - \\left(1 - R - 16H\\sin^4(\\theta/2)\\right)^2\n$$\n右边是 $1-(1-a)^2 = 2a-a^2=a(2-a)$ 的形式，其中 $a = R + 16H\\sin^4(\\theta/2)$。\n$$\nC^2\\sin^2(\\theta) \\le \\left(R + 16H\\sin^4(\\theta/2)\\right) \\left(2 - R - 16H\\sin^4(\\theta/2)\\right)\n$$\n为了使这个不等式对所有 $\\theta \\in [0, \\pi]$ 都成立，库朗数 $C$ 必须是有界的。我们可以解出 $C^2$：\n$$\nC^2 \\le \\frac{\\left(R + 16H\\sin^4(\\theta/2)\\right) \\left(2 - R - 16H\\sin^4(\\theta/2)\\right)}{\\sin^2(\\theta)}\n$$\n这对所有 $\\theta \\in (0, \\pi)$ 都必须成立。由于分母为零，$\\theta=0$ 和 $\\theta=\\pi$ 的情况必须单独检查。\n- 在 $\\theta = 0$ 时：$\\sin(0)=0$ 且 $\\sin(0/2)=0$。$G(0) = 1 - R$。条件 $|G(0)| \\le 1$ 意味着 $|1-R| \\le 1$。由于 $R=\\mu\\Delta t \\ge 0$，这得出 $-1 \\le 1-R \\le 1$，简化为 $0 \\le R \\le 2$。这与给定的约束条件相符。\n- 在 $\\theta = \\pi$ 时：$\\sin(\\pi)=0$ 且 $\\sin(\\pi/2)=1$。$G(\\pi) = 1 - R - 16H$。条件 $|G(\\pi)| \\le 1$ 意味着 $|1-R-16H| \\le 1$。由于 $R \\ge 0$ 且 $H \\ge 0$，$1-R-16H \\le 1$ 总是成立的。另一边，$-1 \\le 1-R-16H$ 给出 $R+16H \\le 2$。这也与给定的约束条件相符。\n\n最大允许库朗数 $C_{\\max}$ 是使得不等式对所有 $\\theta \\in (0, \\pi)$ 都成立的 $C$ 的最大值。这意味着 $C^2$ 必须小于或等于右侧表达式的最小值。\n$$\nC_{\\max}^2 = \\min_{\\theta \\in (0, \\pi)} \\left[ \\frac{\\left(R + 16H\\sin^4(\\theta/2)\\right) \\left(2 - R - 16H\\sin^4(\\theta/2)\\right)}{\\sin^2(\\theta)} \\right]\n$$\n问题要求 $C_{\\max}(H,R)$ 的一个封闭形式表达式，并明确允许最终表达式包含对傅里葉相位的最小化。用 $H$ 和 $R$ 的初等函数来求解这个最小化问题的解析解将需要求解一个高次多项式方程，这通常是难以处理的。因此，包含最小化算子的表达式就是所要求的最终形式。\n\n$C_{\\max}(H,R)$ 的最终答案是上述表达式的平方根。\n$$\nC_{\\max}(H,R) = \\sqrt{\\min_{\\theta \\in (0, \\pi)} \\left[ \\frac{\\left(R + 16H\\sin^4(\\frac{\\theta}{2})\\right) \\left(2 - R - 16H\\sin^4(\\frac{\\theta}{2})\\right)}{\\sin^2(\\theta)} \\right]}\n$$\n在问题的约束条件下，此表达式是稳定性边界的最详细的封闭形式表示。",
            "answer": "$$\n\\boxed{\\sqrt{\\min_{\\theta \\in (0, \\pi)} \\left[ \\frac{\\left(R + 16H\\sin^4(\\frac{\\theta}{2})\\right) \\left(2 - R - 16H\\sin^4(\\frac{\\theta}{2})\\right)}{\\sin^2(\\theta)} \\right]}}\n$$"
        }
    ]
}