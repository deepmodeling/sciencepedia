{
    "hands_on_practices": [
        {
            "introduction": "在构建数值模型时，变量在网格上的布局是一个基础且关键的设计决策。本练习将引导您通过对比非交错（Arakawa A-网格）和交错（Arakawa C-网格）两种布局，深入探究这一决策的深远影响。通过从第一性原理出发，您将分析为何交错网格对于抑制地球物理流体动力学模拟中常见的虚假计算模态（例如“棋盘”模态）至关重要 。",
            "id": "4052177",
            "problem": "考虑一维线性化浅水方程，这是数值天气预报和气候模拟中分析波传播和数值稳定性的基础模型，\n$$\n\\frac{\\partial u}{\\partial t} \\;=\\; -\\,g\\,\\frac{\\partial \\eta}{\\partial x}\n\\quad\\text{和}\\quad\n\\frac{\\partial \\eta}{\\partial t} \\;=\\; -\\,H\\,\\frac{\\partial u}{\\partial x},\n$$\n其中 $u$ 是水平速度，$\\eta$ 是自由表面高度（或压力的替代变量），$g$ 是重力加速度，$H$ 是平均流体深度。令 $c \\equiv \\sqrt{gH}$ 表示在平面波解下从这些方程导出的浅水重力波的连续介质相速度。\n\n定义一个间距为 $\\Delta x$ 的均匀网格，并考虑两种水平网格交错选择：\n- Arakawa A-网格，$u$ 和 $\\eta$ 配置在同一位置 $x_i = i\\,\\Delta x$。\n- Arakawa C-网格，$\\eta$ 定义在 $x_i = i\\,\\Delta x$ 处，$u$ 定义在交错位置 $x_{i+\\frac{1}{2}} = \\left(i+\\tfrac{1}{2}\\right)\\Delta x$ 处。\n\n在每个网格上，使用与网格交错方式一致的二阶有限差分来近似空间导数：\n- 在 A-网格上，在 $x_i$ 处用中心差分 $[\\eta_{i+1} - \\eta_{i-1}]/(2\\Delta x)$ 和 $[u_{i+1} - u_{i-1}]/(2\\Delta x)$ 来近似 $\\partial \\eta/\\partial x$ 和 $\\partial u/\\partial x$。\n- 在 C-网格上，在 $x_{i+\\frac{1}{2}}$ 处用与交错一致的差分 $[\\eta_{i+1} - \\eta_i]/\\Delta x$ 来近似 $\\partial \\eta/\\partial x$，并在 $x_i$ 处用 $[u_{i+\\frac{1}{2}} - u_{i-\\frac{1}{2}}]/\\Delta x$ 来近似 $\\partial u/\\partial x$。\n\n假设时间上连续的解具有平面波形式，\n$$\n\\eta_i(t) \\;=\\; \\hat{\\eta}\\,\\exp\\!\\bigl(i\\,k\\,x_i - i\\,\\omega\\,t\\bigr),\n\\qquad\nu_i(t) \\;=\\; \\hat{u}\\,\\exp\\!\\bigl(i\\,k\\,x_i - i\\,\\omega\\,t\\bigr)\n\\quad\\text{(A-网格)},\n$$\n和\n$$\n\\eta_i(t) \\;=\\; \\hat{\\eta}\\,\\exp\\!\\bigl(i\\,k\\,x_i - i\\,\\omega\\,t\\bigr),\n\\qquad\nu_{i+\\frac{1}{2}}(t) \\;=\\; \\hat{u}\\,\\exp\\!\\bigl(i\\,k\\,x_{i+\\frac{1}{2}} - i\\,\\omega\\,t\\bigr)\n\\quad\\text{(C-网格)}.\n$$\n\n仅从这些控制方程、网格定义和有限差分算子出发，推导每个网格上的半离散色散关系，并分析在以 $k\\,\\Delta x = \\pi$ 为特征的最短可分辨水平波长（奈奎斯特模式）下的行为。从第一性原理出发，解释网格交错如何影响 $u$ 和 $\\eta$ 之间的耦合，以及虚假计算模式和棋盘格现象的出现。\n\n最后，计算在奈奎斯特波数下，Arakawa C-网格上的无量纲相速度比，\n$$\n\\frac{\\omega}{c\\,|k|},\n$$\n结果表示为以 $\\pi$ 表示的精确解析表达式。无需四舍五入，最终答案不应包含任何物理单位。最终答案必须是单个实值表达式。",
            "solution": "在尝试求解之前，对问题进行验证。\n\n### 步骤 1：提取已知条件\n问题陈述中逐字给出的已知条件如下：\n- **控制方程**：\n$$\n\\frac{\\partial u}{\\partial t} \\;=\\; -\\,g\\,\\frac{\\partial \\eta}{\\partial x}\n\\quad\\text{和}\\quad\n\\frac{\\partial \\eta}{\\partial t} \\;=\\; -\\,H\\,\\frac{\\partial u}{\\partial x}\n$$\n- **变量和常量定义**：\n  - $u$：水平速度\n  - $\\eta$：自由表面高度\n  - $g$：重力加速度\n  - $H$：平均流体深度\n  - $c \\equiv \\sqrt{gH}$：连续介质相速度\n- **网格定义**：\n  - 网格间距：$\\Delta x$\n  - Arakawa A-网格：$u$ 和 $\\eta$ 配置在同一位置 $x_i = i\\,\\Delta x$。\n  - Arakawa C-网格：$\\eta$ 位于 $x_i = i\\,\\Delta x$ 处，$u$ 位于 $x_{i+\\frac{1}{2}} = \\left(i+\\tfrac{1}{2}\\right)\\Delta x$ 处。\n- **有限差分算子**：\n  - A-网格在 $x_i$ 处：$\\frac{\\partial \\eta}{\\partial x} \\approx \\frac{\\eta_{i+1} - \\eta_{i-1}}{2\\Delta x}$ 和 $\\frac{\\partial u}{\\partial x} \\approx \\frac{u_{i+1} - u_{i-1}}{2\\Delta x}$。\n  - C-网格：在 $x_{i+\\frac{1}{2}}$ 处 $\\frac{\\partial \\eta}{\\partial x} \\approx \\frac{\\eta_{i+1} - \\eta_i}{\\Delta x}$，在 $x_i$ 处 $\\frac{\\partial u}{\\partial x} \\approx \\frac{u_{i+\\frac{1}{2}} - u_{i-\\frac{1}{2}}}{\\Delta x}$。\n- **平面波解形式**：\n  - A-网格：$\\eta_i(t) = \\hat{\\eta}\\,\\exp(i\\,k\\,x_i - i\\,\\omega\\,t)$ 和 $u_i(t) = \\hat{u}\\,\\exp(i\\,k\\,x_i - i\\,\\omega\\,t)$。\n  - C-网格：$\\eta_i(t) = \\hat{\\eta}\\,\\exp(i\\,k\\,x_i - i\\,\\omega\\,t)$ 和 $u_{i+\\frac{1}{2}}(t) = \\hat{u}\\,\\exp(i\\,k\\,x_{i+\\frac{1}{2}} - i\\,\\omega\\,t)$。\n- **分析条件**：\n  - 奈奎斯特模式：$k\\,\\Delta x = \\pi$。\n- **要求计算**：\n  - 计算在奈奎斯特波数下 Arakawa C-网格上的无量纲相速度比 $\\frac{\\omega}{c\\,|k|}$，结果表示为以 $\\pi$ 表示的精确解析表达式。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据指定标准对问题进行评估。\n- **科学依据**：该问题基于线性化浅水方程，这是地球物理流体动力学的基石。Arakawa 网格和有限差分法是数值模拟中的标准技术。使用冯·诺依曼分析（平面波解）推导色散关系是一种基本且有效的方法。该问题牢固地建立在已有的科学和数学原理之上。\n- **适定性**：该问题提供了推导所需结果的所有必要方程、边界条件（通过无限域中的平面波隐式给出）和定义。目标明确，可以导出一个唯一且有意义的解。\n- **客观性**：问题以精确、无歧义的技术语言陈述，不含主观或基于观点的内容。\n\n该问题未表现出任何列出的使其无效的缺陷。它在科学上是合理的、可形式化的、完整的、可行的、适定的且非平凡的。\n\n### 步骤 3：结论与行动\n该问题是**有效的**。将提供完整解答。\n\n我们首先为每种网格配置推导半离散色散关系。\n\n**Arakawa A-网格分析**\nA-网格上的半离散化方程为：\n$$\n\\frac{d u_i}{dt} = -g \\frac{\\eta_{i+1} - \\eta_{i-1}}{2\\Delta x}\n$$\n$$\n\\frac{d \\eta_i}{dt} = -H \\frac{u_{i+1} - u_{i-1}}{2\\Delta x}\n$$\n我们代入平面波解 $u_i(t) = \\hat{u}\\,\\exp(i\\,k\\,x_i - i\\,\\omega\\,t)$ 和 $\\eta_i(t) = \\hat{\\eta}\\,\\exp(i\\,k\\,x_i - i\\,\\omega\\,t)$。时间导数变为乘以 $-i\\,\\omega$。对于空间差分，我们使用关系式 $\\eta_{i\\pm1} = \\hat{\\eta}\\,\\exp(i\\,k\\,(x_i \\pm \\Delta x) - i\\,\\omega\\,t) = \\eta_i \\exp(\\pm i\\,k\\,\\Delta x)$，对 $u$ 也类似。\n将这些代入方程得到：\n$$\n-i\\,\\omega\\,\\hat{u} = -g\\,\\hat{\\eta} \\frac{\\exp(i\\,k\\,\\Delta x) - \\exp(-i\\,k\\,\\Delta x)}{2\\Delta x}\n$$\n$$\n-i\\,\\omega\\,\\hat{\\eta} = -H\\,\\hat{u} \\frac{\\exp(i\\,k\\,\\Delta x) - \\exp(-i\\,k\\,\\Delta x)}{2\\Delta x}\n$$\n使用恒等式 $\\sin(\\theta) = \\frac{\\exp(i\\theta) - \\exp(-i\\theta)}{2i}$，该系统变为：\n$$\n-i\\,\\omega\\,\\hat{u} = -g\\,\\hat{\\eta} \\frac{2i\\,\\sin(k\\,\\Delta x)}{2\\Delta x} \\implies \\omega\\,\\hat{u} = g \\frac{\\sin(k\\,\\Delta x)}{\\Delta x} \\hat{\\eta}\n$$\n$$\n-i\\,\\omega\\,\\hat{\\eta} = -H\\,\\hat{u} \\frac{2i\\,\\sin(k\\,\\Delta x)}{2\\Delta x} \\implies \\omega\\,\\hat{\\eta} = H \\frac{\\sin(k\\,\\Delta x)}{\\Delta x} \\hat{u}\n$$\n这是一个关于振幅 $(\\hat{u}, \\hat{\\eta})$ 的线性系统。为了得到非平凡解，我们可以将一个方程代入另一个。将第一个方程中的 $\\hat{u}$ 代入第二个方程得到：\n$$\n\\omega\\,\\hat{\\eta} = H \\frac{\\sin(k\\,\\Delta x)}{\\Delta x} \\left( \\frac{g}{\\omega} \\frac{\\sin(k\\,\\Delta x)}{\\Delta x} \\hat{\\eta} \\right)\n$$\n假设 $\\hat{\\eta} \\neq 0$ 且 $\\omega \\neq 0$，我们得到 A-网格的色散关系：\n$$\n\\omega^2 = g\\,H \\left( \\frac{\\sin(k\\,\\Delta x)}{\\Delta x} \\right)^2\n$$\n回顾 $c^2 = gH$，离散频率为 $\\omega = \\pm c \\frac{|\\sin(k\\,\\Delta x)|}{\\Delta x}$。\n在奈奎斯特模式下，$k\\,\\Delta x = \\pi$。此时，$\\sin(k\\,\\Delta x) = \\sin(\\pi) = 0$。这意味着 $\\omega = 0$。A-网格上最短的可分辨波是静止的。数值群速度 $c_g = d\\omega/dk = \\pm c \\cos(k\\Delta x)$ 变为 $c_g = \\pm c \\cos(\\pi) = \\mp c$。一个频率为零但群速度非零的波是非物理的。这表明存在一个虚假计算模式。\n原因是，波长为 $k\\Delta x = \\pi$ 的波在网格点 $x_i$ 处的值与 $(-1)^i$ 成正比。将中心差分算子 $\\frac{f_{i+1} - f_{i-1}}{2\\Delta x}$ 应用于这种“棋盘格”模式会得到 $\\frac{(-1)^{i+1}-(-1)^{i-1}}{2\\Delta x} = \\frac{(-1)^i(-1) - (-1)^i(-1)}{2\\Delta x} = 0$。\n该算子对 $2\\Delta x$ 波是“盲目”的。因此，作用在速度场上的压强梯度力为零，作用在高度场上的速度散度也为零。$u$ 和 $\\eta$ 场完全解耦，这使得静止的、网格尺度的噪音（棋盘格模式）可以作为解存在。\n\n**Arakawa C-网格分析**\nC-网格上的半离散化方程为：\n$$\n\\frac{d u_{i+\\frac{1}{2}}}{dt} = -g \\frac{\\eta_{i+1} - \\eta_i}{\\Delta x}\n$$\n$$\n\\frac{d \\eta_i}{dt} = -H \\frac{u_{i+\\frac{1}{2}} - u_{i-\\frac{1}{2}}}{\\Delta x}\n$$\n我们代入相应的平面波解：$\\eta_i(t) = \\hat{\\eta}\\,\\exp(i\\,k\\,x_i - i\\,\\omega\\,t)$ 和 $u_{i+\\frac{1}{2}}(t) = \\hat{u}\\,\\exp(i\\,k\\,x_{i+\\frac{1}{2}} - i\\,\\omega\\,t)$。\n第一个方程变为：\n$$\n-i\\,\\omega\\,\\hat{u}\\,\\exp(i\\,k\\,x_{i+\\frac{1}{2}}) = -g \\frac{\\hat{\\eta}\\,\\exp(i\\,k\\,x_{i+1}) - \\hat{\\eta}\\,\\exp(i\\,k\\,x_{i})}{\\Delta x}\n$$\n在右侧提出因子 $\\exp(i\\,k\\,x_i)$ 并在左侧提出因子 $\\exp(i\\,k\\,x_{i+\\frac{1}{2}}) = \\exp(i\\,k\\,x_i)\\exp(i\\,k\\,\\Delta x/2)$：\n$$\n-i\\,\\omega\\,\\hat{u}\\,\\exp(i\\,k\\,\\Delta x/2) = -g \\frac{\\hat{\\eta}\\,(\\exp(i\\,k\\,\\Delta x) - 1)}{\\Delta x}\n$$\n第二个方程变为：\n$$\n-i\\,\\omega\\,\\hat{\\eta}\\,\\exp(i\\,k\\,x_i) = -H \\frac{\\hat{u}\\,\\exp(i\\,k\\,x_{i+\\frac{1}{2}}) - \\hat{u}\\,\\exp(i\\,k\\,x_{i-\\frac{1}{2}})}{\\Delta x}\n$$\n提出 $\\exp(i\\,k\\,x_i)$ 项：\n$$\n-i\\,\\omega\\,\\hat{\\eta} = -H \\frac{\\hat{u}\\,(\\exp(i\\,k\\,\\Delta x/2) - \\exp(-i\\,k\\,\\Delta x/2))}{\\Delta x}\n$$\n我们使用恒等式 $\\exp(i\\theta) - 1 = \\exp(i\\theta/2)(\\exp(i\\theta/2) - \\exp(-i\\theta/2)) = \\exp(i\\theta/2) \\cdot 2i\\sin(\\theta/2)$ 和 $\\exp(i\\theta/2) - \\exp(-i\\theta/2) = 2i\\sin(\\theta/2)$。\n关于振幅 $(\\hat{u}, \\hat{\\eta})$ 的方程组简化为：\n$$\n-i\\,\\omega\\,\\hat{u}\\,\\exp(i\\,k\\,\\Delta x/2) = -g \\frac{\\hat{\\eta}\\,\\exp(i\\,k\\,\\Delta x/2) \\cdot 2i\\sin(k\\,\\Delta x/2)}{\\Delta x} \\implies \\omega\\,\\hat{u} = g \\frac{2\\sin(k\\,\\Delta x/2)}{\\Delta x} \\hat{\\eta}\n$$\n$$\n-i\\,\\omega\\,\\hat{\\eta} = -H \\frac{\\hat{u} \\cdot 2i\\sin(k\\,\\Delta x/2)}{\\Delta x} \\implies \\omega\\,\\hat{\\eta} = H \\frac{2\\sin(k\\,\\Delta x/2)}{\\Delta x} \\hat{u}\n$$\n像之前一样组合这些方程：\n$$\n\\omega\\,\\hat{\\eta} = H \\frac{2\\sin(k\\,\\Delta x/2)}{\\Delta x} \\left( \\frac{g}{\\omega} \\frac{2\\sin(k\\,\\Delta x/2)}{\\Delta x} \\hat{\\eta} \\right)\n$$\n这给出了 C-网格的色散关系：\n$$\n\\omega^2 = g\\,H \\left( \\frac{2\\sin(k\\,\\Delta x/2)}{\\Delta x} \\right)^2\n$$\n离散频率为 $\\omega = \\pm c \\frac{|2\\sin(k\\,\\Delta x/2)|}{\\Delta x}$。\n在奈奎斯特模式下，$k\\,\\Delta x = \\pi$，所以 $k\\,\\Delta x/2 = \\pi/2$。频率变为 $\\omega = \\pm c \\frac{2|\\sin(\\pi/2)|}{\\Delta x} = \\pm \\frac{2c}{\\Delta x}$。这是网格支持的最大频率。数值群速度为 $c_g = d\\omega/dk = \\pm c \\cos(k\\Delta x/2)$。当 $k\\Delta x=\\pi$ 时，$c_g = \\pm c \\cos(\\pi/2) = 0$。C-网格正确地将最短波表示为一个具有最大频率的静止波包（驻波），这在物理上是正确的。\n交错排列确保了 $\\eta$ 中的棋盘格模式（例如，$\\eta_i \\sim (-1)^i$）会导致一个最大可能的压强梯度 $(\\eta_{i+1} - \\eta_i)/\\Delta x \\sim ((-1)^{i+1} - (-1)^i)/\\Delta x = -2(-1)^i/\\Delta x \\neq 0$。这在所有波数上都保持了质量场和动量场之间的强耦合，从而抑制了在 A-网格上出现的虚假计算模式。\n\n**最终计算**\n我们被要求计算在奈奎斯特波数下，C-网格上的无量纲相速度比 $\\frac{\\omega}{c\\,|k|}$。\n数值相速度为 $c_p = \\frac{\\omega}{|k|}$。该比率为 $\\frac{c_p}{c} = \\frac{\\omega}{c\\,|k|}$。\n从 C-网格的色散关系中，取 $\\omega$ 的正根：\n$$\n\\omega = c \\frac{2\\sin(k\\,\\Delta x/2)}{\\Delta x} \\quad (\\text{对于 } 0 \\le k\\Delta x \\le \\pi)\n$$\n所以该比率为：\n$$\n\\frac{\\omega}{c\\,|k|} = \\frac{1}{|k|} \\frac{2\\sin(k\\,\\Delta x/2)}{\\Delta x} = \\frac{2\\sin(k\\,\\Delta x/2)}{|k|\\Delta x}\n$$\n在奈奎斯特波数处，给定 $k\\,\\Delta x = \\pi$。假设 $k>0$，这意味着 $|k|\\Delta x = \\pi$。\n将此代入比率的表达式中，得到：\n$$\n\\frac{\\omega}{c\\,|k|} = \\frac{2\\sin(\\pi/2)}{\\pi} = \\frac{2(1)}{\\pi} = \\frac{2}{\\pi}\n$$\n这就是所要求的精确解析表达式。",
            "answer": "$$\n\\boxed{\\frac{2}{\\pi}}\n$$"
        },
        {
            "introduction": "在确定了C-网格在空间离散化方面的优势后，我们进而考虑包含时间积分的完整数值格式。本练习将常用的蛙跳格式（leapfrog scheme）应用于交错网格上的浅水波方程系统。您的任务是推导全离散的色散关系，并借此分析空间网格分辨率 $ \\Delta x $ 和时间步长 $ \\Delta t $ 如何共同影响数值波动的传播特性，特别是数值相速度与真实物理相速度的差异 。",
            "id": "4052172",
            "problem": "考虑在 $f$ 平面上（$f=0$）的线性化一维浅水方程，其平均深度 $H$ 为常数，重力加速度为 $g$：\n$$\n\\frac{\\partial u}{\\partial t} \\;=\\; -\\,g\\,\\frac{\\partial \\eta}{\\partial x}, \n\\qquad\n\\frac{\\partial \\eta}{\\partial t} \\;=\\; -\\,H\\,\\frac{\\partial u}{\\partial x},\n$$\n其中 $u(x,t)$ 是水平速度，$\\eta(x,t)$ 是自由面位移。水平网格为 Arakawa C-网格，其中 $\\eta$ 定义在网格中心 $x_{j} = j\\,\\Delta x$，$u$ 定义在网格面 $x_{j+1/2} = \\left(j+\\frac{1}{2}\\right)\\Delta x$，其中 $j$ 为整数。在空间上使用与此交错网格一致的二阶中心有限差分近似，在时间上使用时间步长为 $\\Delta t$ 的蛙跳格式。\n\n从第一性原理出发，推导该 C-网格上平面波解的离散色散关系，该关系连接了离散角频率 $\\omega$ 和离散波数 $k$。然后，对于一个波长为 $\\lambda = 100\\,\\mathrm{km}$ 的重力波，在均匀网格上（$\\Delta x = 10\\,\\mathrm{km}$），取 $H = 1000\\,\\mathrm{m}$ 和 $g = 9.81\\,\\mathrm{m}\\,\\mathrm{s}^{-2}$，蛙跳时间步长 $\\Delta t = 50\\,\\mathrm{s}$：\n\n1. 使用推导出的色散关系确定离散角频率 $\\omega$。\n2. 计算东传模态的数值相速度 $c_{\\mathrm{num}} = \\omega/k$。\n\n将最终相速度以 $\\mathrm{m}\\,\\mathrm{s}^{-1}$ 表示，并将您的答案四舍五入到四位有效数字。所有角度均使用弧度。",
            "solution": "首先根据指定标准验证问题。\n\n### 步骤 1：提取已知条件\n- **控制方程**：线性化一维浅水方程：\n$$ \\frac{\\partial u}{\\partial t} = -g\\frac{\\partial \\eta}{\\partial x}, \\qquad \\frac{\\partial \\eta}{\\partial t} = -H\\frac{\\partial u}{\\partial x} $$\n- **变量**：$u(x,t)$ 是水平速度，$\\eta(x,t)$ 是自由面位移。\n- **常数**：$f=0$（$f$-平面），平均深度 $H$ 为常数，重力加速度 $g$ 为常数。\n- **网格结构**：Arakawa C-网格。$\\eta$ 在网格中心 $x_j = j\\,\\Delta x$。$u$ 在网格面 $x_{j+1/2} = (j+\\frac{1}{2})\\Delta x$。\n- **数值格式**：空间上为二阶中心有限差分，时间上为蛙跳格式，时间步长为 $\\Delta t$。\n- **数值**：\n  - 波长 $\\lambda = 100\\,\\mathrm{km} = 1 \\times 10^5\\,\\mathrm{m}$。\n  - 网格间距 $\\Delta x = 10\\,\\mathrm{km} = 1 \\times 10^4\\,\\mathrm{m}$。\n  - 平均深度 $H = 1000\\,\\mathrm{m}$。\n  - 重力加速度 $g = 9.81\\,\\mathrm{m}\\,\\mathrm{s}^{-2}$。\n  - 时间步长 $\\Delta t = 50\\,\\mathrm{s}$。\n- **任务**：\n  1. 推导平面波解的离散色散关系。\n  2. 对给定参数确定离散角频率 $\\omega$。\n  3. 计算数值相速度 $c_{\\mathrm{num}} = \\omega/k$。\n  4. 将最终相速度四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学基础**：该问题使用浅水方程，这是地球物理流体动力学中的一个基本模型。数值方法（Arakawa C-网格，蛙跳格式）是大气和海洋模型的标准技术。物理常数是符合实际的。该问题在科学上是合理的。\n- **适定性**：问题定义清晰，包含了推导色散关系和计算所需数值量的所有必要信息。存在唯一且有意义的解。\n- **客观性**：问题以精确、正式的语言陈述，没有任何主观或模糊的元素。\n\n### 步骤 3：结论与行动\n问题是有效的。将提供详细的解答。\n\n控制方程为：\n$$\n\\frac{\\partial u}{\\partial t} = -g\\frac{\\partial \\eta}{\\partial x} \\quad (1)\n$$\n$$\n\\frac{\\partial \\eta}{\\partial t} = -H\\frac{\\partial u}{\\partial x} \\quad (2)\n$$\n令离散变量为 $u_{j+1/2}^n = u(x_{j+1/2}, n\\Delta t)$ 和 $\\eta_j^n = \\eta(x_j, n\\Delta t)$。在 Arakawa C-网格上，时间上使用蛙跳格式，空间上使用中心差分，离散方程为：\n$$\n\\frac{u_{j+1/2}^{n+1} - u_{j+1/2}^{n-1}}{2\\Delta t} = -g \\frac{\\eta_{j+1}^n - \\eta_j^n}{\\Delta x} \\quad (3)\n$$\n$$\n\\frac{\\eta_j^{n+1} - \\eta_j^{n-1}}{2\\Delta t} = -H \\frac{u_{j+1/2}^n - u_{j-1/2}^n}{\\Delta x} \\quad (4)\n$$\n我们寻求以下形式的平面波解：\n$$\nu_{j+1/2}^n = \\hat{u} \\, \\exp\\left[i\\left(k x_{j+1/2} - \\omega t_n\\right)\\right] = \\hat{u} \\, \\exp\\left[i\\left(k(j+1/2)\\Delta x - \\omega n\\Delta t\\right)\\right]\n$$\n$$\n\\eta_j^n = \\hat{\\eta} \\, \\exp\\left[i\\left(k x_j - \\omega t_n\\right)\\right] = \\hat{\\eta} \\, \\exp\\left[i\\left(k j\\Delta x - \\omega n\\Delta t\\right)\\right]\n$$\n其中 $\\hat{u}$ 和 $\\hat{\\eta}$ 是常数复振幅，$k$ 是波数，$\\omega$ 是角频率。\n\n将这些形式代入方程 $(3)$：\n$$\n\\frac{\\hat{u} e^{i(k(j+1/2)\\Delta x - \\omega n\\Delta t)}(e^{-i\\omega\\Delta t} - e^{i\\omega\\Delta t})}{2\\Delta t} = -g \\frac{\\hat{\\eta} e^{i(kj\\Delta x - \\omega n\\Delta t)}(e^{ik\\Delta x} - 1)}{\\Delta x}\n$$\n使用恒等式 $e^{-i\\theta} - e^{i\\theta} = -2i\\sin(\\theta)$ 和 $e^{ik\\Delta x} - 1 = e^{ik\\Delta x/2}(e^{ik\\Delta x/2} - e^{-ik\\Delta x/2}) = e^{ik\\Delta x/2}(2i\\sin(k\\Delta x/2))$，并通过约去两边的公因子 $e^{i(k(j+1/2)\\Delta x - \\omega n\\Delta t)}$ 进行简化：\n$$\n\\frac{\\hat{u}(-2i\\sin(\\omega\\Delta t))}{2\\Delta t} = -g \\frac{\\hat{\\eta}(2i\\sin(k\\Delta x/2))}{\\Delta x}\n$$\n$$\n\\hat{u} \\frac{\\sin(\\omega\\Delta t)}{\\Delta t} = g\\hat{\\eta} \\frac{2\\sin(k\\Delta x/2)}{\\Delta x} \\quad (5)\n$$\n接下来，将平面波解代入方程 $(4)$：\n$$\n\\frac{\\hat{\\eta} e^{i(kj\\Delta x - \\omega n\\Delta t)}(-2i\\sin(\\omega\\Delta t))}{2\\Delta t} = -H \\frac{\\hat{u} e^{i(kj\\Delta x - \\omega n\\Delta t)}(e^{ik\\Delta x/2} - e^{-ik\\Delta x/2})}{\\Delta x}\n$$\n$$\n\\frac{\\hat{\\eta}(-2i\\sin(\\omega\\Delta t))}{2\\Delta t} = -H \\frac{\\hat{u}(2i\\sin(k\\Delta x/2))}{\\Delta x}\n$$\n$$\n\\hat{\\eta} \\frac{\\sin(\\omega\\Delta t)}{\\Delta t} = H\\hat{u} \\frac{2\\sin(k\\Delta x/2)}{\\Delta x} \\quad (6)\n$$\n方程 $(5)$ 和 $(6)$ 构成了关于 $(\\hat{u}, \\hat{\\eta})$ 的齐次线性系统。为得到非平凡解，系数矩阵的行列式必须为零：\n$$\n\\begin{vmatrix}\n\\frac{\\sin(\\omega\\Delta t)}{\\Delta t}  -g\\frac{2\\sin(k\\Delta x/2)}{\\Delta x} \\\\\n-H\\frac{2\\sin(k\\Delta x/2)}{\\Delta x}  \\frac{\\sin(\\omega\\Delta t)}{\\Delta t}\n\\end{vmatrix} = 0\n$$\n$$\n\\left(\\frac{\\sin(\\omega\\Delta t)}{\\Delta t}\\right)^2 - gH\\left(\\frac{2\\sin(k\\Delta x/2)}{\\Delta x}\\right)^2 = 0\n$$\n取平方根得到离散色散关系：\n$$\n\\frac{\\sin(\\omega\\Delta t)}{\\Delta t} = \\pm\\sqrt{gH} \\frac{2\\sin(k\\Delta x/2)}{\\Delta x}\n$$\n对于东传波（正相速度），我们取正根。令 $c_{gw} = \\sqrt{gH}$ 为物理重力波相速度。\n$$\n\\sin(\\omega\\Delta t) = \\frac{2 c_{gw} \\Delta t}{\\Delta x} \\sin\\left(\\frac{k\\Delta x}{2}\\right)\n$$\n这就是所求的色散关系。\n\n现在，我们使用给定的数值来求解 $\\omega$ 和 $c_{\\mathrm{num}}$。\n波数 $k$ 由 $k = 2\\pi/\\lambda$ 给出。\n$$\nk = \\frac{2\\pi}{1 \\times 10^5 \\, \\mathrm{m}} = \\frac{\\pi}{50000} \\, \\mathrm{rad}\\,\\mathrm{m}^{-1}\n$$\n物理相速度为：\n$$\nc_{gw} = \\sqrt{gH} = \\sqrt{9.81\\,\\mathrm{m}\\,\\mathrm{s}^{-2} \\times 1000\\,\\mathrm{m}} = \\sqrt{9810}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\n右侧正弦函数的参数为：\n$$\n\\frac{k\\Delta x}{2} = \\frac{(\\pi/50000\\,\\mathrm{m}^{-1})(1 \\times 10^4\\,\\mathrm{m})}{2} = \\frac{\\pi}{10}\\,\\mathrm{rad}\n$$\n我们现在可以求解 $\\omega$：\n$$\n\\sin(\\omega\\Delta t) = \\frac{2\\sqrt{9810} \\times 50}{10000} \\sin\\left(\\frac{\\pi}{10}\\right) = \\frac{\\sqrt{9810}}{100} \\sin\\left(\\frac{\\pi}{10}\\right)\n$$\n代入数值：\n$$\n\\sin(50\\omega) \\approx \\frac{99.0454}{100} \\times 0.309017 \\approx 0.306069\n$$\n该值小于 1，因此对于这些参数，数值格式是稳定的。\n$$\n50\\omega = \\arcsin\\left(\\frac{\\sqrt{9810}}{100} \\sin\\left(\\frac{\\pi}{10}\\right)\\right) \\approx \\arcsin(0.306069) \\approx 0.31102\\,\\mathrm{rad}\n$$\n离散角频率为：\n$$\n\\omega \\approx \\frac{0.31102}{50} \\approx 0.0062204\\,\\mathrm{rad}\\,\\mathrm{s}^{-1}\n$$\n数值相速度为 $c_{\\mathrm{num}} = \\omega/k$。\n$$\nc_{\\mathrm{num}} = \\frac{\\omega}{k} = \\frac{1}{k} \\left(\\frac{1}{\\Delta t} \\arcsin\\left(\\frac{2\\sqrt{gH}\\Delta t}{\\Delta x} \\sin\\left(\\frac{k\\Delta x}{2}\\right)\\right)\\right)\n$$\n以符号形式代入数值：\n$$\nc_{\\mathrm{num}} = \\frac{1}{(\\pi/50000)} \\left(\\frac{1}{50} \\arcsin\\left(\\frac{2\\sqrt{9810} \\times 50}{10000} \\sin\\left(\\frac{\\pi}{10}\\right)\\right)\\right)\n$$\n$$\nc_{\\mathrm{num}} = \\frac{50000}{\\pi \\times 50} \\arcsin\\left(\\frac{\\sqrt{9810}}{100} \\sin\\left(\\frac{\\pi}{10}\\right)\\right)\n$$\n$$\nc_{\\mathrm{num}} = \\frac{1000}{\\pi} \\arcsin\\left(\\frac{\\sqrt{9810}}{100} \\sin\\left(\\frac{\\pi}{10}\\right)\\right)\n$$\n现在，我们计算最终的数值：\n$$\nc_{\\mathrm{num}} \\approx \\frac{1000}{\\pi} \\times 0.3110203 \\approx 99.00654\\,\\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\n四舍五入到四位有效数字，我们得到 $99.01\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$。\n物理相速度为 $c_{gw} = \\sqrt{9810} \\approx 99.045\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$。数值相速度略低，这是该中心有限差分格式的预期行为（相位滞后）。",
            "answer": "$$\\boxed{99.01}$$"
        },
        {
            "introduction": "尽管蛙跳格式具有二阶时间精度，但它会引入一个非物理的“计算模态”，可能随时间增长而污染数值解。本练习旨在解决这个实际问题，引入一种广泛用于平滑该模态的 Robert-Asselin (RA) 时间滤波器。通过推导物理模态的放大因子，您将精确分析该滤波器如何在选择性地衰减有害计算模态的同时，对物理上有意义的解产生可控的影响 。",
            "id": "4052167",
            "problem": "考虑一个 $f$ 平面上的，具有恒定平均深度 $H$ 和重力加速度 $g$ 的一维线性化浅水方程：\n$$\n\\eta_{t} + H u_{x} = 0, \\qquad u_{t} + g \\eta_{x} = 0,\n$$\n其中 $\\eta(x,t)$ 是自由表面位移，$u(x,t)$ 是水平速度。该系统支持相速度为 $c = \\sqrt{g H}$ 的重力波。使用 Arakawa C-网格交错布局对水平导数进行离散化：将 $u$ 放置在单元格面 $x_{i+\\frac{1}{2}}$ 处，将 $\\eta$ 放置在单元中心 $x_{i}$ 处，并在交错网格上使用中心差分来近似 $\\partial_{x}$。使用时间步长为 $\\Delta t$ 的中心跳蛙格式对所得的半离散系统进行时间步进，并在每次跳蛙更新后，对当前时间层 $n$ 的每个预报变量应用系数为 $\\epsilon$ 的 Robert–Asselin (RA) 时间滤波器：\n$$\nx^{n} \\leftarrow x^{n} + \\epsilon\\left(x^{n-1} - 2 x^{n} + x^{n+1}\\right),\n$$\n其中 $x$ 表示 $u$ 或 $\\eta$。\n\n假设存在与 $\\exp(i k x)$ 成正比的单个空间傅里叶谐波。从上述连续方程和离散化出发，推导在跳蛙格式加 RA 滤波器组合作用下物理重力波模态的单步放大因子，并说明其大小如何依赖于无量纲参数\n$$\n\\mu \\equiv c \\, \\Delta t \\, \\hat{k}, \\qquad \\text{其中} \\quad \\hat{k} \\equiv \\frac{\\sin\\!\\left(\\frac{k \\Delta x}{2}\\right)}{\\frac{\\Delta x}{2}},\n$$\n其中 $\\Delta x$ 是均匀的网格间距。然后，对于以下科学上真实的配置，计算物理模态放大因子的大小：\n- $c = 50 \\,\\mathrm{m}\\,\\mathrm{s}^{-1}$，\n- $\\Delta x = 100 \\,\\mathrm{km}$，\n- $\\Delta t = 300 \\,\\mathrm{s}$，\n- $\\epsilon = 0.05$，\n- C-网格上最高可分辨波数，$k = \\pi / \\Delta x$。\n\n将最终数值答案表示为一个纯数（无量纲），并四舍五入到四位有效数字。",
            "solution": "用户希望在浅水方程的数值模拟中，找到特定模态的放大因子的大小。\n\n### 步骤 0：问题验证\n问题陈述经过了严格的验证过程。\n\n#### 步骤 0.1：提取已知条件\n-   **方程**：\n    1.  质量连续性：$\\eta_{t} + H u_{x} = 0$\n    2.  动量：$u_{t} + g \\eta_{x} = 0$\n-   **常数和定义**：\n    -   $H$：恒定平均深度\n    -   $g$：重力加速度\n    -   $c = \\sqrt{g H}$：重力波相速度\n    -   $\\Delta x$：均匀网格间距\n    -   $\\Delta t$：时间步长\n    -   $\\epsilon$：Robert–Asselin (RA) 滤波器系数\n-   **离散化和滤波**：\n    -   网格：Arakawa C-网格，$u$ 位于单元格面 $x_{i+1/2}$，$\\eta$ 位于单元中心 $x_i$。\n    -   空间导数：在交错网格上使用中心差分。\n    -   时间积分：中心跳蛙格式。\n    -   滤波器：每个跳蛙步之后，对中间时间层 $n$ 的变量 $x$（$u$ 或 $\\eta$）应用 RA 滤波器：$x^{n} \\leftarrow x^{n} + \\epsilon\\left(x^{n-1} - 2 x^{n} + x^{n+1}\\right)$。\n-   **分析参数**：\n    -   傅里叶模态：解与 $\\exp(i k x)$ 成正比。\n    -   无量纲参数：$\\mu \\equiv c \\, \\Delta t \\, \\hat{k}$\n    -   有效波数：$\\hat{k} \\equiv \\frac{\\sin(k \\Delta x/2)}{\\Delta x/2}$\n-   **用于计算的数值**：\n    -   $c = 50 \\,\\mathrm{m}\\,\\mathrm{s}^{-1}$\n    -   $\\Delta x = 100 \\,\\mathrm{km}$\n    -   $\\Delta t = 300 \\,\\mathrm{s}$\n    -   $\\epsilon = 0.05$\n    -   $k = \\pi / \\Delta x$\n\n#### 步骤 0.2：使用提取的已知条件进行验证\n该问题具有科学依据，使用了地球物理流体动力学中的标准方程和数值方法。该问题是适定的，为得到唯一解提供了所有必要信息。语言客观而精确。对于海洋或大气重力波，这些数值是物理上真实的。C-网格上最高可分辨波数的定义是标准的。没有发现矛盾或歧义。\n\n#### 步骤 0.3：结论和行动\n问题是**有效的**。将提供完整解答。\n\n### 步骤 1：空间离散化与傅里叶分析\n我们首先在 Arakawa C-网格上对连续方程进行离散化。速度 $u$ 位于半整数网格点 $x_{i+1/2} = (i+1/2)\\Delta x$ 上，表面高度 $\\eta$ 位于整数网格点 $x_i = i\\Delta x$ 上。空间离散化后的方程为：\n$$\n\\frac{d \\eta_i}{dt} + H \\frac{u_{i+1/2} - u_{i-1/2}}{\\Delta x} = 0\n$$\n$$\n\\frac{d u_{i+1/2}}{dt} + g \\frac{\\eta_{i+1} - \\eta_i}{\\Delta x} = 0\n$$\n我们假设解是以下形式的单个傅里叶谐波：\n$$\n\\eta_j(t) = \\tilde{\\eta}(t) \\exp(i k x_j) = \\tilde{\\eta}(t) \\exp(i k j \\Delta x)\n$$\n$$\nu_{j+1/2}(t) = \\tilde{u}(t) \\exp(i k x_{j+1/2}) = \\tilde{u}(t) \\exp(i k (j+1/2) \\Delta x)\n$$\n将这些代入离散方程，并在各自位置除以公共的指数因子，我们得到关于振幅 $\\tilde{\\eta}$ 和 $\\tilde{u}$ 的常微分方程组：\n对于第一个方程：\n$$\n\\frac{d\\tilde{\\eta}}{dt} + H \\tilde{u} \\frac{\\exp(ik\\Delta x/2) - \\exp(-ik\\Delta x/2)}{\\Delta x} = 0 \\implies \\frac{d\\tilde{\\eta}}{dt} + H \\tilde{u} \\frac{2i\\sin(k\\Delta x/2)}{\\Delta x} = 0\n$$\n使用定义 $\\hat{k} = \\sin(k\\Delta x/2)/(\\Delta x/2)$，上式简化为：\n$$\n\\frac{d\\tilde{\\eta}}{dt} + i H \\hat{k} \\tilde{u} = 0\n$$\n类似地，对于第二个方程：\n$$\n\\frac{d\\tilde{u}}{dt} + g \\tilde{\\eta} \\frac{\\exp(ik\\Delta x/2) - \\exp(-ik\\Delta x/2)}{\\Delta x} = 0 \\implies \\frac{d\\tilde{u}}{dt} + i g \\hat{k} \\tilde{\\eta} = 0\n$$\n这个半离散系统可以写成矩阵形式：\n$$\n\\frac{d}{dt} \\begin{pmatrix} \\tilde{\\eta} \\\\ \\tilde{u} \\end{pmatrix}_t = \\begin{pmatrix} 0  -iH\\hat{k} \\\\ -ig\\hat{k}  0 \\end{pmatrix} \\begin{pmatrix} \\tilde{\\eta} \\\\ \\tilde{u} \\end{pmatrix}_t\n$$\n通过寻找其本征模来解耦该系统，我们发现矩阵的特征值为 $\\sigma_{\\pm} = \\pm \\sqrt{(-iH\\hat{k})(-ig\\hat{k})} = \\pm \\sqrt{-gH\\hat{k}^2} = \\mp i\\hat{k}\\sqrt{gH} = \\mp i c \\hat{k}$。这些是半离散系统的频率 $\\omega_{sd}$。对于振幅为 $y(t)$ 的单个本征模，其控制方程为 $\\frac{dy}{dt} = \\sigma y$，其中 $\\sigma$ 是其中一个特征值。\n\n### 步骤 2：使用跳蛙格式和 RA 滤波器的完全离散化\n我们现在在时间上进行离散化。对于 $\\frac{dy}{dt} = \\sigma y$ 的跳蛙格式是 $\\frac{y^{n+1}-y^{n-1}}{2\\Delta t} = \\sigma y^n$。根据题目要求，在计算出 $y^{n+1}$ 之后，中心时间层的值 $y^n$ 被 RA 滤波器更新：$y^n \\to y^n + \\epsilon(y^{n-1} - 2y^n + y^{n+1})$。\n让我们用 $y_n$ 和 $y_{n-1}$ 表示在第 $n$ 步进行滤波器更新之前的状态。操作顺序如下：\n1.  使用跳蛙规则计算一个尝试性的 $y_{n+1}^*$：$y_{n+1}^* = y_{n-1} + 2\\Delta t \\sigma y_n$。\n2.  使用滤波器更新 $y_n$：$y_n^f = y_n + \\epsilon(y_{n-1} - 2y_n + y_{n+1}^*)$。\n下一个时间步进周期的状态是 $(y_n^f, y_{n+1}^*)$。\n我们寻求一个放大因子 $\\lambda$，使得状态向量 $(y_n, y_{n-1})^T$ 被映射到 $(\\lambda y_n, \\lambda y_{n-1})^T = (y_{n+1}^*, y_n^f)^T$。\n将 $y_{n+1}^*$ 代入滤波器方程：\n$y_n^f = y_n + \\epsilon(y_{n-1} - 2y_n + y_{n-1} + 2\\Delta t \\sigma y_n) = (1 - 2\\epsilon + 2\\epsilon\\Delta t\\sigma)y_n + 2\\epsilon y_{n-1}$。\n状态向量的演化由以下矩阵方程给出：\n$$\n\\begin{pmatrix} y_{n+1}^* \\\\ y_n^f \\end{pmatrix} = \\begin{pmatrix} 2\\Delta t \\sigma  1 \\\\ 1 - 2\\epsilon + 2\\epsilon\\Delta t\\sigma  2\\epsilon \\end{pmatrix} \\begin{pmatrix} y_n \\\\ y_{n-1} \\end{pmatrix}\n$$\n这个放大矩阵的特征值 $\\lambda$ 就是单步放大因子。令 $\\mu' = \\sigma \\Delta t = \\mp i c \\hat{k} \\Delta t = \\mp i \\mu$。特征方程是：\n$$\n\\det \\begin{pmatrix} 2\\mu' - \\lambda  1 \\\\ 1 - 2\\epsilon + 2\\epsilon\\mu'  2\\epsilon - \\lambda \\end{pmatrix} = 0\n$$\n$$\n(2\\mu' - \\lambda)(2\\epsilon - \\lambda) - (1 - 2\\epsilon + 2\\epsilon\\mu') = 0\n$$\n$$\n\\lambda^2 - (2\\epsilon + 2\\mu')\\lambda + (4\\epsilon\\mu' - (1 - 2\\epsilon + 2\\epsilon\\mu')) = 0\n$$\n$$\n\\lambda^2 - (2\\epsilon + 2\\mu')\\lambda + (2\\epsilon\\mu' + 2\\epsilon - 1) = 0\n$$\n解这个关于 $\\lambda$ 的二次方程：\n$$\n\\lambda = \\frac{2\\epsilon + 2\\mu' \\pm \\sqrt{(2\\epsilon + 2\\mu')^2 - 4(2\\epsilon\\mu' + 2\\epsilon - 1)}}{2} = \\epsilon + \\mu' \\pm \\sqrt{(\\epsilon+\\mu')^2 - (2\\epsilon\\mu' + 2\\epsilon - 1)}\n$$\n$$\n\\lambda = \\epsilon + \\mu' \\pm \\sqrt{\\epsilon^2 + 2\\epsilon\\mu' + (\\mu')^2 - 2\\epsilon\\mu' - 2\\epsilon + 1} = \\epsilon + \\mu' \\pm \\sqrt{(\\mu')^2 + (1-\\epsilon)^2}\n$$\n代入 $\\mu' = \\mp i\\mu$：\n$$\n\\lambda = \\epsilon \\mp i\\mu \\pm \\sqrt{-\\mu^2 + (1-\\epsilon)^2}\n$$\n物理模态是指当 $\\mu \\to 0$ 和 $\\epsilon \\to 0$ 时，其放大因子趋近于 1 的那个模态。当 $\\mu=0$ 时，根为 $\\lambda = \\epsilon \\pm (1-\\epsilon)$，这得到 $\\lambda_1=1$ 和 $\\lambda_2=2\\epsilon-1$。物理模态对应于 $\\lambda_1=1$。因此我们在平方根前取“+”号（假设 $\\epsilon  1$）。\n$$\n\\lambda_{\\text{phys}} = \\epsilon \\mp i\\mu + \\sqrt{(1-\\epsilon)^2 - \\mu^2}\n$$\n这就是物理重力波模态的放大因子。\n\n### 步骤 3：推导放大因子的大小\n大小 $|\\lambda_{\\text{phys}}|$ 通过计算 $\\sqrt{\\text{Re}(\\lambda_{\\text{phys}})^2 + \\text{Im}(\\lambda_{\\text{phys}})^2}$ 得到。为了使数值格式稳定，平方根内的参数必须是非负的：$(1-\\epsilon)^2 - \\mu^2 \\ge 0$，这意味着 CFL 条件为 $\\mu \\le 1-\\epsilon$。\n$\\lambda_{\\text{phys}}$ 的实部和虚部分别是：\n$$\n\\text{Re}(\\lambda_{\\text{phys}}) = \\epsilon + \\sqrt{(1-\\epsilon)^2 - \\mu^2}\n$$\n$$\n\\text{Im}(\\lambda_{\\text{phys}}) = \\mp\\mu\n$$\n大小的平方是：\n$$\n|\\lambda_{\\text{phys}}|^2 = \\left(\\epsilon + \\sqrt{(1-\\epsilon)^2 - \\mu^2}\\right)^2 + (\\mp\\mu)^2\n$$\n$$\n|\\lambda_{\\text{phys}}|^2 = \\epsilon^2 + 2\\epsilon\\sqrt{(1-\\epsilon)^2 - \\mu^2} + \\left((1-\\epsilon)^2 - \\mu^2\\right) + \\mu^2\n$$\n$$\n|\\lambda_{\\text{phys}}|^2 = \\epsilon^2 + (1-\\epsilon)^2 + 2\\epsilon\\sqrt{(1-\\epsilon)^2 - \\mu^2}\n$$\n$$\n|\\lambda_{\\text{phys}}|^2 = \\epsilon^2 + 1 - 2\\epsilon + \\epsilon^2 + 2\\epsilon\\sqrt{(1-\\epsilon)^2 - \\mu^2} = 1 - 2\\epsilon + 2\\epsilon^2 + 2\\epsilon\\sqrt{(1-\\epsilon)^2 - \\mu^2}\n$$\n因此，放大因子的大小是：\n$$\n|\\lambda_{\\text{phys}}| = \\sqrt{1 - 2\\epsilon + 2\\epsilon^2 + 2\\epsilon\\sqrt{(1-\\epsilon)^2 - \\mu^2}}\n$$\n这个表达式清晰地显示了对 $\\mu$ 和 $\\epsilon$ 的依赖关系。\n\n### 步骤 4：数值计算\n我们现在代入给定的数值。\n1.  计算 $\\hat{k}$：\n    波数是 $k = \\pi/\\Delta x$。在 $\\hat{k}$ 中，正弦函数的参数是 $k\\Delta x/2 = (\\pi/\\Delta x)\\Delta x/2 = \\pi/2$。\n    $\\hat{k} = \\frac{\\sin(\\pi/2)}{\\Delta x/2} = \\frac{1}{\\Delta x/2} = \\frac{2}{\\Delta x} = \\frac{2}{100 \\times 10^3 \\, \\mathrm{m}} = 2 \\times 10^{-5} \\, \\mathrm{m}^{-1}$。\n2.  计算 $\\mu$：\n    $\\mu = c \\Delta t \\hat{k} = (50 \\, \\mathrm{m}\\,\\mathrm{s}^{-1}) \\times (300 \\, \\mathrm{s}) \\times (2 \\times 10^{-5} \\, \\mathrm{m}^{-1}) = 30000 \\times 10^{-5} = 0.3$。\n3.  检查 CFL 条件：$\\mu = 0.3$ 且 $1-\\epsilon = 1-0.05=0.95$。由于 $0.3 \\le 0.95$，该格式是稳定的。\n4.  计算 $|\\lambda_{\\text{phys}}|^2$：\n    $|\\lambda_{\\text{phys}}|^2 = 1 - 2(0.05) + 2(0.05)^2 + 2(0.05)\\sqrt{(1-0.05)^2 - (0.3)^2}$\n    $|\\lambda_{\\text{phys}}|^2 = 1 - 0.1 + 2(0.0025) + 0.1\\sqrt{(0.95)^2 - (0.3)^2}$\n    $|\\lambda_{\\text{phys}}|^2 = 0.9 + 0.005 + 0.1\\sqrt{0.9025 - 0.09}$\n    $|\\lambda_{\\text{phys}}|^2 = 0.905 + 0.1\\sqrt{0.8125}$\n    $|\\lambda_{\\text{phys}}|^2 = 0.905 + 0.1 \\times 0.9013878...$\n    $|\\lambda_{\\text{phys}}|^2 = 0.905 + 0.09013878... = 0.99513878...$\n5.  计算 $|\\lambda_{\\text{phys}}|$：\n    $|\\lambda_{\\text{phys}}| = \\sqrt{0.99513878...} = 0.99756643...$\n四舍五入到四位有效数字，物理模态放大因子的大小为 $0.9976$。",
            "answer": "$$\\boxed{0.9976}$$"
        }
    ]
}