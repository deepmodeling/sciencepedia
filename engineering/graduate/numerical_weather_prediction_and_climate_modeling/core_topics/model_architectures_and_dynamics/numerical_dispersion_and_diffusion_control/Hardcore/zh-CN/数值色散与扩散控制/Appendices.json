{
    "hands_on_practices": [
        {
            "introduction": "一阶迎风格式是求解平流方程的一种简单而稳健的方法，但其简洁性是有代价的：它会引入非物理的数值耗散。本练习  将指导你使用“修正方程”这一强大的分析技术，来揭示并量化这种隐藏的数值效应。通过推导，你将发现该离散格式的解在连续介质的视角下，其行为等价于一个附加了额外扩散项的物理方程，从而理解数值格式如何改变其所模拟的物理过程。",
            "id": "4069602",
            "problem": "考虑常系数线性平流方程，它是数值天气预报和气候模拟中示踪物输运的一个标准构建模块，\n$$\nu_{t} + c \\, u_{x} = 0,\n$$\n其波速 $c0$ 为常数。在间距为 $\\Delta x$ 的均匀空间网格和时间步长为 $\\Delta t$ 的情况下，用 $u_{i}^{n} \\approx u(x_{i}, t_{n})$ 来近似 $u(x,t)$，并使用显式一阶迎风法（时间上向前欧拉，空间上对 $c0$ 迎风）在时间上推进：\n$$\nu_{i}^{n+1} = u_{i}^{n} - C \\left(u_{i}^{n} - u_{i-1}^{n}\\right),\n$$\n其中 Courant–Friedrichs–Lewy (CFL) 数为 $C = \\dfrac{c \\, \\Delta t}{\\Delta x}$。假设 $u$ 足够光滑，且 $C$ 位于稳定范围 $0  C \\leq 1$ 内，这在大气动力核心的业务平流计算中是典型情况。\n\n使用关于 $(x_{i}, t_{n})$ 的泰勒级数展开，并利用控制偏微分方程将时间导数替换为空间导数，推导修正方程。该修正方程的左侧与连续平流算子相匹配，右侧则捕捉了截至并包括 $\\mathcal{O}(\\Delta x^{2})$ 阶项的主截断效应。将修正方程写成典范形式\n$$\nu_{t} + c \\, u_{x} = \\nu_{\\text{eff}} \\, u_{xx} + \\text{higher-order terms},\n$$\n并确定有效扩散系数 $\\nu_{\\text{eff}}$ 作为 $c$、$\\Delta x$ 和 $C$ 的函数。\n\n最终答案仅需提供 $\\nu_{\\text{eff}}$ 的闭式解析表达式。无需四舍五入，最终答案中也不应包含单位。",
            "solution": "目标是推导修正方程，这是一个连续偏微分方程，其解在指定阶数上近似于离散格式的数值解。我们从常系数线性平流方程\n$$\nu_{t} + c \\, u_{x} = 0, \\quad c0,\n$$\n和针对 $c0$ 的一阶迎风格式\n$$\n\\frac{u_{i}^{n+1} - u_{i}^{n}}{\\Delta t} + c \\, \\frac{u_{i}^{n} - u_{i-1}^{n}}{\\Delta x} = 0,\n$$\n开始，该格式在代数上等价于给定的更新公式。\n\n我们将 $u_{i}^{n}$ 解释为在 $(x_{i}, t_{n})$ 处采样的精确解，并将离散算子在 $(x_{i}, t_{n})$ 点进行泰勒级数展开。对于向前时间差分，\n$$\n\\frac{u_{i}^{n+1} - u_{i}^{n}}{\\Delta t} = u_{t} + \\frac{\\Delta t}{2} \\, u_{tt} + \\frac{\\Delta t^{2}}{6} \\, u_{ttt} + \\mathcal{O}(\\Delta t^{3}).\n$$\n对于向后空间差分，\n$$\n\\frac{u_{i}^{n} - u_{i-1}^{n}}{\\Delta x} = u_{x} - \\frac{\\Delta x}{2} \\, u_{xx} + \\frac{\\Delta x^{2}}{6} \\, u_{xxx} + \\mathcal{O}(\\Delta x^{3}).\n$$\n将这些展开式代入离散格式，得到\n$$\n\\left[u_{t} + \\frac{\\Delta t}{2} \\, u_{tt} + \\frac{\\Delta t^{2}}{6} \\, u_{ttt} + \\mathcal{O}(\\Delta t^{3})\\right]\n+ c \\left[u_{x} - \\frac{\\Delta x}{2} \\, u_{xx} + \\frac{\\Delta x^{2}}{6} \\, u_{xxx} + \\mathcal{O}(\\Delta x^{3})\\right] = 0.\n$$\n为了用空间导数表示时间导数，我们对控制方程反复进行关于时间的求导，并利用偏导数的交换性。由 $u_{t} + c \\, u_{x} = 0$ 可推得\n$$\nu_{t} = - c \\, u_{x}, \\quad\nu_{tt} = (u_{t})_{t} = - c \\, (u_{x})_{t} = - c \\, (u_{t})_{x} = - c \\, (- c \\, u_{x})_{x} = c^{2} \\, u_{xx},\n$$\n类似地，\n$$\nu_{ttt} = (u_{tt})_{t} = \\left(c^{2} \\, u_{xx}\\right)_{t} = c^{2} \\, (u_{xx})_{t} = c^{2} \\, (u_{t})_{xx} = c^{2} \\, (- c \\, u_{x})_{xx} = - c^{3} \\, u_{xxx}.\n$$\n将这些代入展开后的格式，得到\n$$\nu_{t} + c \\, u_{x}\n+ \\left(\\frac{\\Delta t}{2} c^{2} - \\frac{c \\, \\Delta x}{2}\\right) u_{xx}\n+ \\left(- \\frac{\\Delta t^{2}}{6} c^{3} + \\frac{c \\, \\Delta x^{2}}{6}\\right) u_{xxx}\n+ \\text{higher-order terms} = 0.\n$$\n引入 Courant–Friedrichs–Lewy (CFL) 数 $C = \\dfrac{c \\, \\Delta t}{\\Delta x}$，并注意 $\\Delta t = \\dfrac{C \\, \\Delta x}{c}$ 及 $\\Delta t^{2} = \\dfrac{C^{2} \\, \\Delta x^{2}}{c^{2}}$。于是系数可简化为\n$$\n\\frac{\\Delta t}{2} c^{2} - \\frac{c \\, \\Delta x}{2}\n= \\frac{c}{2} \\left(c \\, \\Delta t - \\Delta x\\right)\n= \\frac{c}{2} \\left(\\Delta x \\, C - \\Delta x\\right)\n= \\frac{c \\, \\Delta x}{2} (C - 1),\n$$\n和\n$$\n- \\frac{\\Delta t^{2}}{6} c^{3} + \\frac{c \\, \\Delta x^{2}}{6}\n= - \\frac{c}{6} \\left(\\frac{C^{2} \\, \\Delta x^{2}}{c^{2}}\\right) c^{2} + \\frac{c \\, \\Delta x^{2}}{6}\n= \\frac{c \\, \\Delta x^{2}}{6} (1 - C^{2}).\n$$\n因此，当 $C$ 被视为 $\\mathcal{O}(1)$ 阶时，精确到 $\\mathcal{O}(\\Delta x^{2})$ 阶项的修正方程为\n$$\nu_{t} + c \\, u_{x}\n+ \\frac{c \\, \\Delta x}{2} (C - 1) \\, u_{xx}\n+ \\frac{c \\, \\Delta x^{2}}{6} (1 - C^{2}) \\, u_{xxx}\n= 0,\n$$\n我们可以将其等价地写为\n$$\nu_{t} + c \\, u_{x}\n= \\frac{c \\, \\Delta x}{2} (1 - C) \\, u_{xx}\n+ \\frac{c \\, \\Delta x^{2}}{6} (C^{2} - 1) \\, u_{xxx}\n+ \\text{higher-order terms}.\n$$\n与典范形式 $u_{t} + c \\, u_{x} = \\nu_{\\text{eff}} \\, u_{xx} + \\text{higher-order terms}$ 比较，我们确定有效扩散系数为\n$$\n\\nu_{\\text{eff}} = \\frac{c \\, \\Delta x}{2} (1 - C).\n$$\n对于 $0  C \\leq 1$，该系数是非负的，这反映了一阶迎风格式的保单调性和扩散特性，这一特性被广泛用于控制大气和海洋模型中示踪物平流的伪振荡。",
            "answer": "$$\\boxed{\\frac{c\\,\\Delta x}{2}\\,(1-C)}$$"
        },
        {
            "introduction": "在理解了单个格式的隐含误差之后，我们现在来比较两种经典的平流格式：一阶迎风格式和二阶Lax-Wendroff格式。本练习  运用傅里叶分析方法，深入剖析两种截然不同的数值误差：耗散误差（影响波的振幅）和色散误差（影响波的相速度）。通过对比这两种格式的误差特性，你将学会如何在精度、耗散和色散之间进行权衡，这是为大气和气候模型中的特定物理问题选择合适数值方案的关键技能。",
            "id": "4069593",
            "problem": "考虑与数值天气预报相关的一维被动示踪剂平流，该过程由线性平流方程 $u_{t} + c\\,u_{x} = 0$ 控制，其中波速 $c  0$ 为常数。设数值网格的均匀间距为 $\\Delta x$，时间步长为 $\\Delta t$，并定义 Courant-Friedrichs-Lewy (CFL) 数 $\\mu = c\\,\\Delta t / \\Delta x$。考虑以下两种显式有限差分时间推进格式：\n\n1. 一阶迎风格式：$u^{n+1}_{j} = u^{n}_{j} - \\mu \\left(u^{n}_{j} - u^{n}_{j-1}\\right)$。\n2. Lax-Wendroff 格式：$u^{n+1}_{j} = u^{n}_{j} - \\frac{\\mu}{2}\\left(u^{n}_{j+1} - u^{n}_{j-1}\\right) + \\frac{\\mu^{2}}{2}\\left(u^{n}_{j+1} - 2 u^{n}_{j} + u^{n}_{j-1}\\right)$。\n\n通过代入离散 Fourier 模 $u^{n}_{j} = \\hat{u}^{\\,n}\\,\\exp\\!\\left(i j \\xi\\right)$ 来进行 Fourier 或 von Neumann 分析，其中 $\\xi = k\\,\\Delta x$ 是无量纲波数，单位为弧度。令 $G(\\xi)$ 表示放大因子，使得 $\\hat{u}^{\\,n+1} = G(\\xi)\\,\\hat{u}^{\\,n}$。对每种格式，求出 $G(\\xi)$，然后对于小的 $\\xi$，利用关系式 $G(\\xi) = \\exp\\!\\left(- i\\,\\omega(\\xi)\\,\\Delta t\\right)$（因此 $\\omega(\\xi)\\,\\Delta t = i\\,\\ln G(\\xi)$），将 $G(\\xi)$ 按 $\\xi$ 的幂次进行 Taylor 展开，展开到足以分离色散和耗散贡献的阶数。\n\n将格式的主阶色散误差系数定义为 $\\omega(\\xi)\\,\\Delta t$ 实部中 $\\xi^{3}$ 项的系数。使用此定义，计算迎风格式的主阶色散误差系数与 Lax-Wendroff 格式的主阶色散误差系数之比 $R(\\mu)$，并将其表示为 $\\mu$ 的闭式函数。无需四舍五入。将最终答案表示为解析表达式；在最终的方框表达式中不要包含单位。角度以弧度为单位。",
            "solution": "用户希望求出用于求解一维线性平流方程 $u_{t} + c\\,u_{x} = 0$ 的两种有限差分格式的主阶色散误差系数之比。这些系数将通过 von Neumann 稳定性分析来确定。\n\n分析始于将单个 Fourier 模 $u^{n}_{j} = \\hat{u}^{\\,n}\\,\\exp(i j \\xi)$ 代入有限差分格式。此处，$j$ 是空间索引，$n$ 是时间索引，$\\xi = k\\,\\Delta x$ 是无量纲波数，$\\hat{u}^{\\,n}$ 是在时间步 $n$ 模的振幅。放大因子 $G(\\xi)$ 由关系式 $\\hat{u}^{\\,n+1} = G(\\xi)\\,\\hat{u}^{\\,n}$ 定义。\n\n数值频率 $\\omega(\\xi)$ 与放大因子通过 $G(\\xi) = \\exp(- i\\,\\omega(\\xi)\\,\\Delta t)$ 相关。这意味着 $\\omega(\\xi)\\,\\Delta t = i\\,\\ln G(\\xi)$。平流方程的精确解具有色散关系 $\\omega_{exact} = ck$，这得出 $\\omega_{exact}\\,\\Delta t = ck\\,\\Delta t = (\\frac{\\xi}{\\Delta x}) c \\Delta t = \\mu\\xi$，其中 $\\mu = c\\Delta t/\\Delta x$ 是 Courant 数。\n\n色散误差是在减去精确部分 $\\mu\\xi$ 后，数值频率实部 $\\text{Re}(\\omega(\\xi)\\,\\Delta t)$ 中的主阶误差项。根据问题中的定义，主阶色散误差系数是 $\\text{Re}(\\omega(\\xi)\\,\\Delta t)$ 的 Taylor 展开式中 $\\xi^{3}$ 项的系数。\n\n**1. 一阶迎风格式**\n\n该格式由下式给出：\n$$u^{n+1}_{j} = u^{n}_{j} - \\mu \\left(u^{n}_{j} - u^{n}_{j-1}\\right)$$\n代入 Fourier 模 $u^{n}_{j} = \\hat{u}^{\\,n}\\,\\exp(i j \\xi)$：\n$$\\hat{u}^{\\,n+1} \\exp(i j \\xi) = \\hat{u}^{\\,n} \\exp(i j \\xi) - \\mu \\left(\\hat{u}^{\\,n} \\exp(i j \\xi) - \\hat{u}^{\\,n} \\exp(i (j-1) \\xi)\\right)$$\n两边同除以 $\\hat{u}^{\\,n}\\,\\exp(i j \\xi)$ 得到放大因子 $G_{up}(\\xi)$：\n$$G_{up}(\\xi) = 1 - \\mu \\left(1 - \\exp(-i\\xi)\\right) = 1 - \\mu + \\mu \\exp(-i\\xi)$$\n我们利用 $\\exp(-i\\xi) = 1 - i\\xi - \\frac{\\xi^2}{2} + i\\frac{\\xi^3}{6} + O(\\xi^4)$ 的 Taylor 级数，对小的 $\\xi$ 展开 $G_{up}(\\xi)$：\n$$G_{up}(\\xi) = 1 - \\mu + \\mu \\left(1 - i\\xi - \\frac{\\xi^2}{2} + i\\frac{\\xi^3}{6} + \\dots \\right)$$\n$$G_{up}(\\xi) = 1 - i\\mu\\xi - \\frac{\\mu}{2}\\xi^2 + i\\frac{\\mu}{6}\\xi^3 + O(\\xi^4)$$\n现在我们利用 Taylor 级数 $\\ln(1+z) = z - \\frac{z^2}{2} + \\frac{z^3}{3} - \\dots$ 计算 $\\ln G_{up}(\\xi)$，其中 $z = G_{up}(\\xi) - 1$：\n$$z = -i\\mu\\xi - \\frac{\\mu}{2}\\xi^2 + i\\frac{\\mu}{6}\\xi^3 + O(\\xi^4)$$\n$$z^2 = (-i\\mu\\xi)^2 + 2(-i\\mu\\xi)\\left(-\\frac{\\mu}{2}\\xi^2\\right) + \\dots = -\\mu^2\\xi^2 + i\\mu^2\\xi^3 + O(\\xi^4)$$\n$$z^3 = (-i\\mu\\xi)^3 + \\dots = i\\mu^3\\xi^3 + O(\\xi^4)$$\n将这些代入 $\\ln(1+z)$ 的级数中：\n$$\\ln G_{up}(\\xi) = \\left(-i\\mu\\xi - \\frac{\\mu}{2}\\xi^2 + i\\frac{\\mu}{6}\\xi^3\\right) - \\frac{1}{2}\\left(-\\mu^2\\xi^2 + i\\mu^2\\xi^3\\right) + \\frac{1}{3}\\left(i\\mu^3\\xi^3\\right) + O(\\xi^4)$$\n$$\\ln G_{up}(\\xi) = -i\\mu\\xi + \\left(-\\frac{\\mu}{2} + \\frac{\\mu^2}{2}\\right)\\xi^2 + i\\left(\\frac{\\mu}{6} - \\frac{\\mu^2}{2} + \\frac{\\mu^3}{3}\\right)\\xi^3 + O(\\xi^4)$$\n于是，$\\omega_{up}(\\xi)\\,\\Delta t = i\\,\\ln G_{up}(\\xi)$：\n$$\\omega_{up}(\\xi)\\,\\Delta t = \\mu\\xi + i\\left(-\\frac{\\mu}{2} + \\frac{\\mu^2}{2}\\right)\\xi^2 - \\left(\\frac{\\mu}{6} - \\frac{\\mu^2}{2} + \\frac{\\mu^3}{3}\\right)\\xi^3 + O(\\xi^4)$$\n其实部为：\n$$\\text{Re}(\\omega_{up}(\\xi)\\,\\Delta t) = \\mu\\xi - \\left(\\frac{\\mu - 3\\mu^2 + 2\\mu^3}{6}\\right)\\xi^3 + O(\\xi^5)$$\n主阶色散误差系数 $C_{up}$ 是 $\\xi^3$ 的系数：\n$$C_{up} = -\\frac{\\mu - 3\\mu^2 + 2\\mu^3}{6} = -\\frac{\\mu(1 - 3\\mu + 2\\mu^2)}{6} = -\\frac{\\mu(1-\\mu)(1-2\\mu)}{6}$$\n\n**2. Lax-Wendroff 格式**\n\n该格式由下式给出：\n$$u^{n+1}_{j} = u^{n}_{j} - \\frac{\\mu}{2}\\left(u^{n}_{j+1} - u^{n}_{j-1}\\right) + \\frac{\\mu^{2}}{2}\\left(u^{n}_{j+1} - 2 u^{n}_{j} + u^{n}_{j-1}\\right)$$\n代入 Fourier 模得到放大因子 $G_{LW}(\\xi)$：\n$$G_{LW}(\\xi) = 1 - \\frac{\\mu}{2}\\left(\\exp(i\\xi) - \\exp(-i\\xi)\\right) + \\frac{\\mu^{2}}{2}\\left(\\exp(i\\xi) - 2 + \\exp(-i\\xi)\\right)$$\n使用恒等式 $\\exp(i\\xi) - \\exp(-i\\xi) = 2i\\sin\\xi$ 和 $\\exp(i\\xi) + \\exp(-i\\xi) = 2\\cos\\xi$，上式可简化为：\n$$G_{LW}(\\xi) = 1 - i\\mu\\sin\\xi + \\mu^2(\\cos\\xi - 1)$$\n我们利用 $\\sin\\xi = \\xi - \\frac{\\xi^3}{6} + O(\\xi^5)$ 和 $\\cos\\xi-1 = -\\frac{\\xi^2}{2} + \\frac{\\xi^4}{24} + O(\\xi^6)$ 对小的 $\\xi$ 进行展开：\n$$G_{LW}(\\xi) = 1 - i\\mu\\left(\\xi - \\frac{\\xi^3}{6} + \\dots\\right) + \\mu^2\\left(-\\frac{\\xi^2}{2} + \\dots\\right)$$\n$$G_{LW}(\\xi) = 1 - i\\mu\\xi - \\frac{\\mu^2}{2}\\xi^2 + i\\frac{\\mu}{6}\\xi^3 + O(\\xi^4)$$\n和之前一样，我们计算 $\\ln G_{LW}(\\xi)$，其中 $z = G_{LW}(\\xi) - 1$：\n$$z = -i\\mu\\xi - \\frac{\\mu^2}{2}\\xi^2 + i\\frac{\\mu}{6}\\xi^3 + O(\\xi^4)$$\n$$z^2 = (-\\mu^2)\\xi^2 + i\\mu^3\\xi^3 + O(\\xi^4)$$\n$$z^3 = i\\mu^3\\xi^3 + O(\\xi^4)$$\n$$\\ln G_{LW}(\\xi) = \\left(-i\\mu\\xi - \\frac{\\mu^2}{2}\\xi^2 + i\\frac{\\mu}{6}\\xi^3\\right) - \\frac{1}{2}\\left(-\\mu^2\\xi^2 + i\\mu^3\\xi^3\\right) + \\frac{1}{3}\\left(i\\mu^3\\xi^3\\right) + O(\\xi^4)$$\n$$\\ln G_{LW}(\\xi) = -i\\mu\\xi + \\left(-\\frac{\\mu^2}{2} + \\frac{\\mu^2}{2}\\right)\\xi^2 + i\\left(\\frac{\\mu}{6} - \\frac{\\mu^3}{2} + \\frac{\\mu^3}{3}\\right)\\xi^3 + O(\\xi^4)$$\n$$\\ln G_{LW}(\\xi) = -i\\mu\\xi + i\\left(\\frac{\\mu - 3\\mu^3 + 2\\mu^3}{6}\\right)\\xi^3 + O(\\xi^4) = -i\\mu\\xi + i\\frac{\\mu(1-\\mu^2)}{6}\\xi^3 + O(\\xi^4)$$\n于是，$\\omega_{LW}(\\xi)\\,\\Delta t = i\\,\\ln G_{LW}(\\xi)$：\n$$\\omega_{LW}(\\xi)\\,\\Delta t = \\mu\\xi - \\frac{\\mu(1-\\mu^2)}{6}\\xi^3 + O(\\xi^4)$$\n其实部为：\n$$\\text{Re}(\\omega_{LW}(\\xi)\\,\\Delta t) = \\mu\\xi - \\frac{\\mu(1-\\mu^2)}{6}\\xi^3 + O(\\xi^5)$$\n主阶色散误差系数 $C_{LW}$ 是 $\\xi^3$ 的系数：\n$$C_{LW} = -\\frac{\\mu(1-\\mu^2)}{6} = -\\frac{\\mu(1-\\mu)(1+\\mu)}{6}$$\n\n**3. 系数之比**\n\n比值 $R(\\mu)$ 由 $C_{up} / C_{LW}$ 给出：\n$$R(\\mu) = \\frac{C_{up}}{C_{LW}} = \\frac{-\\frac{\\mu(1-\\mu)(1-2\\mu)}{6}}{-\\frac{\\mu(1-\\mu)(1+\\mu)}{6}}$$\n对于 $\\mu \\in (0, 1)$，我们可以消去公因子 $\\mu$、$(1-\\mu)$ 和分母 $6$：\n$$R(\\mu) = \\frac{1-2\\mu}{1+\\mu}$$\n这就是所求的关于 $\\mu$ 的闭式函数。",
            "answer": "$$\\boxed{\\frac{1-2\\mu}{1+\\mu}}$$"
        },
        {
            "introduction": "在数值模型中，分析固有误差固然重要，但有时我们也需要主动、显式地引入耗散来控制数值不稳定或清除计算过程中产生的噪音，尤其是在网格尺度上。本练习  将带你从误差分析转向方案设计，任务是设计一个满足特定性能指标的Shapiro滤波器。你将学习如何确定滤波器的参数，以便高效地消除网格尺度的数值噪音，同时最大限度地保留大尺度物理波动的完整性，这正是业务化天气预报模型中一个常见且重要的挑战。",
            "id": "4069633",
            "problem": "考虑一个用于数值天气预报 (NWP) 和气候模拟的一维、均匀间隔、周期性网格，其网格间距为 $\\Delta x$。一个预报标量场 $q_i$ 定义在网格点 $x_i = i \\Delta x$ 上。该场受到 $2 \\Delta x$ 网格尺度（奈奎斯特波数 $k_{\\mathrm{N}} = \\pi/\\Delta x$）的振荡污染，必须在不显著影响动力学上相关的较长波的情况下抑制这些振荡。\n\n你的任务是设计一个 Shapiro 滤波器应用的最小序列，以减少网格尺度噪声，同时在较低波数处保持高保真度。偶数阶 $p$ 的 Shapiro 滤波器由归一化的、中心化的、偶数阶有限差分算子构造，使得当它单次应用于纯傅里叶分量 $q_i = \\Re\\{\\hat{q}(k) \\exp(\\mathrm{i} k x_i)\\}$ 时，其振幅传递函数为\n$$\nH_p(k) = 1 - \\sin^{p}\\!\\left(\\frac{k \\Delta x}{2}\\right),\n$$\n其中，归一化的选择是为了使在奈奎斯特波数 $k_{\\mathrm{N}} = \\pi/\\Delta x$ 处有 $\\sin^{p}(k \\Delta x/2) = 1$。这种设计保证了在单次应用中完全去除 $2 \\Delta x$ 振荡，同时选择性地使短波比长波衰减得更多。\n\n根据这个滤波器定义，确定最小的偶数整数 $p$，使得单次应用（即一次滤波）能同时满足以下两个设计目标：\n- 网格尺度抑制：在 $k = \\pi/\\Delta x$ 处的传递函数产生零振幅，即 $H_p(\\pi/\\Delta x) = 0$。\n- 保真度保持：在 $k = \\pi/(3 \\Delta x)$ 处的传递函数保持至少 $99\\%$ 的振幅，即 $H_p\\!\\left(\\frac{\\pi}{3\\Delta x}\\right) \\geq 0.99$。\n\n报告满足这些约束的最小偶数整数 $p$。最终答案必须是一个没有单位的整数，无需舍入说明。",
            "solution": "问题要求找到 Shapiro 滤波器的最小偶数阶 $p$，使其应用满足两个特定的设计标准。阶数为 $p$ 的 Shapiro 滤波器的振幅传递函数如下：\n$$\nH_p(k) = 1 - \\sin^{p}\\!\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n其中 $k$ 是波数，$\\Delta x$ 是网格间距。整数 $p$ 被指定为偶数。\n\n两个设计约束是：\n1.  网格尺度抑制：在奈奎斯特波数 $k = k_{\\mathrm{N}} = \\pi/\\Delta x$ 处，$H_p(k) = 0$。\n2.  保真度保持：在波数 $k = \\pi/(3 \\Delta x)$ 处，$H_p(k) \\geq 0.99$。\n\n首先，我们验证网格尺度抑制约束。我们将 $k = \\pi/\\Delta x$ 代入传递函数：\n$$\nH_p\\!\\left(\\frac{\\pi}{\\Delta x}\\right) = 1 - \\sin^{p}\\!\\left(\\frac{(\\pi/\\Delta x) \\Delta x}{2}\\right) = 1 - \\sin^{p}\\!\\left(\\frac{\\pi}{2}\\right)\n$$\n由于 $\\sin(\\pi/2) = 1$，该表达式变为：\n$$\nH_p\\!\\left(\\frac{\\pi}{\\Delta x}\\right) = 1 - 1^p = 1 - 1 = 0\n$$\n这个条件对于任何正整数 $p$ 都成立，因此对于任何偶数整数 $p$ 也都成立。这证实了该滤波器根据其定义就能完全去除 $2 \\Delta x$ 噪声，并且此约束对 $p$ 的值没有施加任何进一步的限制。\n\n接下来，我们分析保真度保持约束。对于 $k = \\pi/(3 \\Delta x)$，我们必须有 $H_p(k) \\geq 0.99$。我们将此波数代入传递函数不等式中：\n$$\nH_p\\!\\left(\\frac{\\pi}{3\\Delta x}\\right) = 1 - \\sin^{p}\\!\\left(\\frac{(\\pi/(3\\Delta x)) \\Delta x}{2}\\right) \\geq 0.99\n$$\n化简正弦函数的自变量：\n$$\n\\frac{(\\pi/(3\\Delta x)) \\Delta x}{2} = \\frac{\\pi}{6}\n$$\n不等式变为：\n$$\n1 - \\sin^{p}\\!\\left(\\frac{\\pi}{6}\\right) \\geq 0.99\n$$\n$\\sin(\\pi/6)$ 的值恰好是 $1/2$。将其代入不等式得到：\n$$\n1 - \\left(\\frac{1}{2}\\right)^p \\geq 0.99\n$$\n我们现在求解 $p$。重新整理不等式：\n$$\n1 - 0.99 \\geq \\left(\\frac{1}{2}\\right)^p\n$$\n$$\n0.01 \\geq \\left(\\frac{1}{2}\\right)^p\n$$\n$$\n\\frac{1}{100} \\geq \\frac{1}{2^p}\n$$\n由于两边都为正数，我们可以对两边取倒数，这会反转不等号的方向：\n$$\n100 \\leq 2^p\n$$\n为了找到满足此条件的最小整数 $p$，我们可以对两边取以 2 为底的对数：\n$$\n\\log_{2}(100) \\leq \\log_{2}(2^p)\n$$\n$$\n\\log_{2}(100) \\leq p\n$$\n我们可以使用换底公式 $\\log_b(x) = \\ln(x)/\\ln(b)$ 来计算 $\\log_{2}(100)$：\n$$\np \\geq \\frac{\\ln(100)}{\\ln(2)} = \\frac{\\ln(10^2)}{\\ln(2)} = \\frac{2 \\ln(10)}{\\ln(2)}\n$$\n使用近似值 $\\ln(10) \\approx 2.302585$ 和 $\\ln(2) \\approx 0.693147$，我们得到：\n$$\np \\geq \\frac{2 \\times 2.302585}{0.693147} \\approx \\frac{4.60517}{0.693147} \\approx 6.643856\n$$\n所以，$p$ 必须是一个大于或等于 $6.643856...$ 的整数。题目说明 $p$ 必须是一个偶数。满足 $p \\geq 6.643856...$ 的整数序列从 $7, 8, 9, 10, \\dots$ 开始。这个序列中的第一个偶数是 $8$。\n\n为了验证，我们测试一下这个阈值附近的偶数：\n- 如果 $p = 6$，那么 $2^6 = 64$。由于 $64  100$，这个 $p$ 值是不够的。\n- 如果 $p = 8$，那么 $2^8 = 256$。由于 $256 \\geq 100$，这个 $p$ 值是足够的。\n\n因此，满足两个设计约束的最小偶数整数 $p$ 是 $8$。",
            "answer": "$$\\boxed{8}$$"
        }
    ]
}