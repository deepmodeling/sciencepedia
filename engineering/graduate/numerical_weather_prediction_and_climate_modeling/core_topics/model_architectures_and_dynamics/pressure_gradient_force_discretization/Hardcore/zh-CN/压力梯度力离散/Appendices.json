{
    "hands_on_practices": [
        {
            "introduction": "第一个实践是连接连续物理定律与其离散数值对应物的基本练习。通过一个简单的解析压力场，您将推导出精确的压力梯度力，然后将其与标准的有限差分近似进行比较。这个过程将使您能够解析地量化离散化误差，从而具体理解截断误差这一所有数值模拟的基础概念。",
            "id": "4078188",
            "problem": "在数值天气预报 (NWP) 的背景下，考虑一个连续分层、无粘性的干燥大气。解析压力场由 $p(x,y,z)=p_0 \\exp(-\\alpha x - \\beta y - \\gamma z)$ 给出，其中 $p_0>0$ 和 $\\alpha>0$, $\\beta>0$, $\\gamma>0$ 是常数。质量密度是关于高度的光滑、严格为正的函数，$\\rho(z)>0$。假设唯一的内应力是各向同性压力，由应力张量 $-p \\mathbf{I}$ 表示。\n\n从应用于流体质元的牛顿第二定律和无粘流体的柯西动量方程出发，推导该大气的单位质量气压梯度加速度矢量场。使用您的结果，计算分量大小 $|a_{p,x}|$, $|a_{p,y}|$ 和 $|a_{p,z}|$，并确定它们的比值。然后，在均匀笛卡尔网格上，使用网格间距 $\\Delta x>0$，为网格点 $(x,y,z)$ 处压力的x方向导数构建一个二阶中心有限差分近似，并通过在中心层 $z$ 处计算 $1/\\rho$ 来形成离散气压梯度加速度 $a_{p,x}^{(d)}(x,y,z)$。\n\n推导 $a_{p,x}^{(d)}(x,y,z)$ 中截断误差的主阶项及其大小。最后，报告 $a_{p,x}^{(d)}(x,y,z)$ 中截断误差主阶项的大小与连续x分量 $a_{p,x}(x,y,z)$ 大小的比值 $E_x$。将最终比值 $E_x$ 表示为关于 $\\alpha$ 和 $\\Delta x$ 的单个闭式解析表达式。气压梯度加速度的单位是 $\\mathrm{m\\,s^{-2}}$，但报告的比值 $E_x$ 必须表示为无量纲量。不需要数值近似。",
            "solution": "该问题要求进行与指定大气模型中气压梯度加速度相关的几项推导。验证过程确认了该问题陈述具有科学依据、是适定的，并且包含了获得完整解答所需的所有信息。\n\n首先，我们推导单位质量气压梯度加速度矢量场 $\\mathbf{a}_p$。根据流体动力学原理，特别是无粘流体的柯西动量方程，由压力引起的单位体积力由负的气压梯度 $-\\nabla p$ 给出。单位质量力，即加速度，通过除以质量密度 $\\rho$ 得到。因此，气压梯度加速度为：\n$$\n\\mathbf{a}_p(x,y,z) = -\\frac{1}{\\rho(z)} \\nabla p(x,y,z)\n$$\n压力场由 $p(x,y,z) = p_0 \\exp(-\\alpha x - \\beta y - \\gamma z)$ 给出。我们计算 $p$ 的梯度，即其偏导数的矢量：\n$$\n\\nabla p = \\frac{\\partial p}{\\partial x}\\mathbf{i} + \\frac{\\partial p}{\\partial y}\\mathbf{j} + \\frac{\\partial p}{\\partial z}\\mathbf{k}\n$$\n偏导数分别为：\n$$\n\\frac{\\partial p}{\\partial x} = \\frac{\\partial}{\\partial x} \\left[p_0 \\exp(-\\alpha x - \\beta y - \\gamma z)\\right] = p_0 (-\\alpha) \\exp(-\\alpha x - \\beta y - \\gamma z) = -\\alpha p(x,y,z)\n$$\n$$\n\\frac{\\partial p}{\\partial y} = \\frac{\\partial}{\\partial y} \\left[p_0 \\exp(-\\alpha x - \\beta y - \\gamma z)\\right] = p_0 (-\\beta) \\exp(-\\alpha x - \\beta y - \\gamma z) = -\\beta p(x,y,z)\n$$\n$$\n\\frac{\\partial p}{\\partial z} = \\frac{\\partial}{\\partial z} \\left[p_0 \\exp(-\\alpha x - \\beta y - \\gamma z)\\right] = p_0 (-\\gamma) \\exp(-\\alpha x - \\beta y - \\gamma z) = -\\gamma p(x,y,z)\n$$\n因此，压力场的梯度可以紧凑地写为：\n$$\n\\nabla p(x,y,z) = -(\\alpha\\mathbf{i} + \\beta\\mathbf{j} + \\gamma\\mathbf{k}) p(x,y,z)\n$$\n将此代入 $\\mathbf{a}_p$ 的表达式中：\n$$\n\\mathbf{a}_p(x,y,z) = -\\frac{1}{\\rho(z)} \\left[-(\\alpha\\mathbf{i} + \\beta\\mathbf{j} + \\gamma\\mathbf{k}) p(x,y,z)\\right] = \\frac{p(x,y,z)}{\\rho(z)}(\\alpha\\mathbf{i} + \\beta\\mathbf{j} + \\gamma\\mathbf{k})\n$$\n加速度矢量的分量为：\n$$\na_{p,x}(x,y,z) = \\frac{\\alpha p(x,y,z)}{\\rho(z)}\n$$\n$$\na_{p,y}(x,y,z) = \\frac{\\beta p(x,y,z)}{\\rho(z)}\n$$\n$$\na_{p,z}(x,y,z) = \\frac{\\gamma p(x,y,z)}{\\rho(z)}\n$$\n鉴于 $p_0>0$, $\\alpha>0$, $\\beta>0$, $\\gamma>0$ 和 $\\rho(z)>0$，压力 $p(x,y,z)$ 总是正的。因此，各分量的大小为：\n$$\n|a_{p,x}| = \\frac{\\alpha p}{\\rho}, \\quad |a_{p,y}| = \\frac{\\beta p}{\\rho}, \\quad |a_{p,z}| = \\frac{\\gamma p}{\\rho}\n$$\n这些大小的比值为：\n$$\n|a_{p,x}| : |a_{p,y}| : |a_{p,z}| = \\frac{\\alpha p}{\\rho} : \\frac{\\beta p}{\\rho} : \\frac{\\gamma p}{\\rho} = \\alpha : \\beta : \\gamma\n$$\n接下来，我们为压力的x方向导数 $\\frac{\\partial p}{\\partial x}$ 构建二阶中心有限差分近似。对于网格间距为 $\\Delta x$ 的点 $(x,y,z)$，该近似的公式为：\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)^{(d)} = \\frac{p(x+\\Delta x, y, z) - p(x-\\Delta x, y, z)}{2\\Delta x}\n$$\n我们在移位点上计算压力函数的值：\n$$\np(x+\\Delta x, y, z) = p_0 \\exp(-\\alpha(x+\\Delta x) - \\beta y - \\gamma z) = p(x,y,z) \\exp(-\\alpha \\Delta x)\n$$\n$$\np(x-\\Delta x, y, z) = p_0 \\exp(-\\alpha(x-\\Delta x) - \\beta y - \\gamma z) = p(x,y,z) \\exp(\\alpha \\Delta x)\n$$\n将这些代入有限差分公式：\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)^{(d)} = \\frac{p(x,y,z) \\exp(-\\alpha \\Delta x) - p(x,y,z) \\exp(\\alpha \\Delta x)}{2\\Delta x} = p(x,y,z) \\frac{\\exp(-\\alpha \\Delta x) - \\exp(\\alpha \\Delta x)}{2\\Delta x}\n$$\n使用双曲正弦函数的定义 $\\sinh(u) = (\\exp(u) - \\exp(-u))/2$，我们可以简化此表达式：\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)^{(d)} = - p(x,y,z) \\frac{\\exp(\\alpha \\Delta x) - \\exp(-\\alpha \\Delta x)}{2\\Delta x} = - p(x,y,z) \\frac{\\sinh(\\alpha \\Delta x)}{\\Delta x}\n$$\nx方向的离散气压梯度加速度 $a_{p,x}^{(d)}$ 是通过使用此离散导数形成的：\n$$\na_{p,x}^{(d)}(x,y,z) = -\\frac{1}{\\rho(z)} \\left(\\frac{\\partial p}{\\partial x}\\right)^{(d)} = -\\frac{1}{\\rho(z)} \\left(-p(x,y,z) \\frac{\\sinh(\\alpha \\Delta x)}{\\Delta x}\\right) = \\frac{p(x,y,z)}{\\rho(z)} \\frac{\\sinh(\\alpha \\Delta x)}{\\Delta x}\n$$\n现在，我们求主阶截断误差。截断误差是离散近似与精确连续量之间的差值，即 $T_{a,x} = a_{p,x}^{(d)} - a_{p,x}$。我们可以通过将 $a_{p,x}^{(d)}$ 针对小的 $\\Delta x$ 展开为泰勒级数来找到它。$\\sinh(u)$ 在 $u=0$ 附近的泰勒级数为 $\\sinh(u) = u + \\frac{u^3}{3!} + \\frac{u^5}{5!} + \\dots$。\n令 $u = \\alpha \\Delta x$。那么：\n$$\n\\frac{\\sinh(\\alpha \\Delta x)}{\\Delta x} = \\frac{1}{\\Delta x} \\left(\\alpha \\Delta x + \\frac{(\\alpha \\Delta x)^3}{6} + O(\\Delta x^5)\\right) = \\alpha + \\frac{\\alpha^3 \\Delta x^2}{6} + O(\\Delta x^4)\n$$\n将此展开式代回 $a_{p,x}^{(d)}$ 的表达式中：\n$$\na_{p,x}^{(d)} = \\frac{p}{\\rho} \\left(\\alpha + \\frac{\\alpha^3 \\Delta x^2}{6} + O(\\Delta x^4)\\right) = \\frac{\\alpha p}{\\rho} + \\frac{\\alpha^3 p \\Delta x^2}{6\\rho} + O(\\Delta x^4)\n$$\n第一项 $\\frac{\\alpha p}{\\rho}$ 正是连续加速度分量 $a_{p,x}$。剩余项代表截断误差。截断误差的主阶项是这些项中的第一项：\n$$\nT_{a,x, \\text{leading}} = \\frac{\\alpha^3 p(x,y,z) \\Delta x^2}{6\\rho(z)}\n$$\n由于所有参数和函数都为正，该误差的大小就是该项本身：\n$$\n|T_{a,x, \\text{leading}}| = \\frac{\\alpha^3 p \\Delta x^2}{6\\rho}\n$$\n最后，我们计算主阶截断误差的大小与加速度连续x分量的大小的比值 $E_x$。\n$$\n|a_{p,x}| = \\left|\\frac{\\alpha p}{\\rho}\\right| = \\frac{\\alpha p}{\\rho}\n$$\n$$\nE_x = \\frac{|T_{a,x, \\text{leading}}|}{|a_{p,x}|} = \\frac{\\frac{\\alpha^3 p \\Delta x^2}{6\\rho}}{\\frac{\\alpha p}{\\rho}}\n$$\n项 $p(x,y,z)$ 和 $\\rho(z)$ 被消去：\n$$\nE_x = \\frac{\\alpha^3 \\Delta x^2}{6\\alpha} = \\frac{\\alpha^2 \\Delta x^2}{6}\n$$\n这个表达式是无量纲的，因为 $\\alpha$ 的单位是长度的倒数，而 $\\Delta x$ 的单位是长度。结果是按要求给出的关于 $\\alpha$ 和 $\\Delta x$ 的闭式解析表达式。",
            "answer": "$$\n\\boxed{\\frac{\\alpha^{2} \\Delta x^{2}}{6}}\n$$"
        },
        {
            "introduction": "真实世界的模型必须处理复杂的地形，通常通过使用地形追随坐标系来实现。本实践探讨了由此选择产生的一个经典且关键的挑战：在倾斜地面上计算压力梯度力时会产生人为的力。您将结合解析推导和数值实现，展示看似直接的离散化如何在静止大气中错误地产生加速度，这是模型动力学精心设计中的重要一课。",
            "id": "4078195",
            "problem": "考虑一个二维的干静力平衡大气，它位于一个由地形表面 $z_s(x)$ 表示的缓坡山脉上，其坡度为常数，由 $\\mathrm{d}z_s/\\mathrm{d}x = \\epsilon$ 给出。假设温度 $T_0$ 水平均匀，重力加速度 $g$ 为常数。静力平衡由基本定律 $\\frac{\\partial p}{\\partial z} = -\\rho g$ 和理想气体定律 $p = \\rho R T_0$ 定义，其中 $p$ 是气压，$\\rho$ 是密度，$R$ 是干空气的比气体常数，$T_0$ 是恒定温度。定义标高 $H = \\frac{R T_0}{g}$。设大气层顶高度为 $H_{\\mathrm{top}}$，并引入地形追随坐标 $\\sigma \\in [0,1]$，通过 $z(x,\\sigma) = z_s(x) + \\sigma H_{\\mathrm{top}}$ 映射到物理高度。精确的静力气压廓线为 $p(x,\\sigma) = p_0 \\exp\\!\\left(-\\frac{z(x,\\sigma)}{H}\\right)$，其中 $p_0$ 是参考海平面气压。\n\n在地形追随层上，水平气压梯度力 (PGF) 的一种非协调离散化方法计算固定 $\\sigma_j$ 处的水平加速度为\n$$\na_x(x_i,\\sigma_j) = -\\frac{1}{\\rho(x_i,\\sigma_j)} \\frac{p(x_{i+1},\\sigma_j) - p(x_{i-1},\\sigma_j)}{2\\Delta x},\n$$\n其中 $\\Delta x$ 是水平网格间距，且 $\\rho(x_i,\\sigma_j) = \\frac{p(x_i,\\sigma_j)}{R T_0}$。\n\n您的任务是：\n1. 从给定的基本关系出发，推导由这种在倾斜地形上的非协调离散化产生的虚假水平加速度 $a_x$ 的主阶表达式。在适当的情况下使用泰勒展开，表达 $a_x$ 对坡度 $\\epsilon$ 和网格间距 $\\Delta x$ 的依赖关系。解释为什么主阶项与 $\\sigma_j$ 无关，并给出次阶项随 $\\epsilon$ 和 $\\Delta x$ 的标度关系。\n2. 实现一个程序，使用指定的离散化方法，对定义域中心（水平网格中点处的 $x$）和中层 $\\sigma = 0.5$ 处进行 $a_x$ 的数值计算。使用精确的静力气压场 $p(x,\\sigma) = p_0 \\exp\\!\\left(-\\frac{z_s(x) + \\sigma H_{\\mathrm{top}}}{H}\\right)$，其中 $z_s(x) = \\epsilon x$，以及 $\\rho(x,\\sigma) = \\frac{p(x,\\sigma)}{R T_0}$。\n\n使用以下物理和数值参数：\n- $g = 9.81$ 单位 $\\mathrm{m/s^2}$，\n- $R = 287$ 单位 $\\mathrm{J/(kg\\cdot K)}$，\n- $T_0 = 300$ 单位 $\\mathrm{K}$，\n- $p_0 = 100000$ 单位 $\\mathrm{Pa}$，\n- $H_{\\mathrm{top}} = 9000$ 单位 $\\mathrm{m}$，\n- 定义域长度 $L = 10000$ 单位 $\\mathrm{m}$。\n\n将水平网格定义为 $x_i = i \\Delta x$，其中 $i = 0,1,\\dots,N_x-1$，且 $N_x = \\left\\lfloor \\frac{L}{\\Delta x} \\right\\rfloor + 1$。在中点索引 $i_{\\mathrm{mid}} = \\left\\lfloor \\frac{N_x}{2} \\right\\rfloor$ 处计算中心有限差分近似值。\n\n对以下每个测试用例（$(\\epsilon,\\Delta x)$ 对）计算 $a_x$（单位：$\\mathrm{m/s^2}$）：\n- 测试 1 (正常情况): $(\\epsilon,\\Delta x) = (0.01, 1000)$，\n- 测试 2 (网格加密): $(\\epsilon,\\Delta x) = (0.01, 250)$，\n- 测试 3 (小坡度): $(\\epsilon,\\Delta x) = (0.001, 1000)$，\n- 测试 4 (小坡度范围内较大的坡度): $(\\epsilon,\\Delta x) = (0.1, 1000)$，\n- 测试 5 (边界情况): $(\\epsilon,\\Delta x) = (0.0, 1000)$。\n\n将每个得到的 $a_x$ 以 $\\mathrm{m/s^2}$ 为单位表示，并四舍五入到六位小数。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，\"[$a_1$,$a_2$,$a_3$,$a_4$,$a_5$]\"），其中每个 $a_k$ 对应于上面列出的顺序的测试用例。",
            "solution": "该问题是有效的。它提出了一个大气模拟数值方法中的标准、适定问题，为解析推导和数值实现提供了所有必需的物理和数值参数。其基本原理在科学上是合理的，目标是清晰且可形式化的。\n\n任务是分析在地形追随坐标系中，一种常见但有缺陷的气压梯度力 (PGF) 有限差分近似所产生的虚假水平加速度。在给定的静止静力平衡大气位于倾斜地形上的情景中，真实的水平加速度为零，因为在等几何高度 $z$ 的表面上不存在水平气压梯度。任何计算出的非零加速度 $a_x$ 都是数值伪影。\n\n首先，我们推导这个虚假加速度 $a_x$ 的解析表达式。所提供的数值格式为：\n$$\na_x(x_i,\\sigma_j) = -\\frac{1}{\\rho(x_i,\\sigma_j)} \\frac{p(x_{i+1},\\sigma_j) - p(x_{i-1},\\sigma_j)}{2\\Delta x}\n$$\n使用理想气体定律 $p = \\rho R T_0$，我们可以将密度表示为 $\\rho = p / (R T_0)$。将其代入 $a_x$ 的表达式中，得到：\n$$\na_x(x_i,\\sigma_j) = -\\frac{R T_0}{p(x_i,\\sigma_j)} \\frac{p(x_{i+1},\\sigma_j) - p(x_{i-1},\\sigma_j)}{2\\Delta x}\n$$\n该有限差分项是恒定 $\\sigma$ 层上气压关于 $x$ 的偏导数的二阶近似：\n$$\n\\frac{p(x_{i+1},\\sigma_j) - p(x_{i-1},\\sigma_j)}{2\\Delta x} \\approx \\left(\\frac{\\partial p}{\\partial x}\\right)_{\\sigma}\n$$\n然而，物理上的 PGF 是由等几何高度 $z$ 表面上的气压梯度定义的，而不是等 $\\sigma$ 表面。真实的水平 PGF 加速度为 $-\\frac{1}{\\rho} (\\frac{\\partial p}{\\partial x})_z$。对于给定的静止状态，$(\\frac{\\partial p}{\\partial x})_z = 0$。误差的产生是因为有限差分是沿着倾斜的 $\\sigma$ 表面计算的。我们可以使用链式法则将沿 $\\sigma$ 的导数与 $(x,z)$ 坐标系中的导数联系起来：\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)_{\\sigma} = \\left(\\frac{\\partial p}{\\partial x}\\right)_{z} + \\left(\\frac{\\partial p}{\\partial z}\\right)_{x} \\left(\\frac{\\partial z}{\\partial x}\\right)_{\\sigma}\n$$\n根据问题陈述，我们有以下关系：\n1.  大气处于静止状态，因此等高面上的水平气压梯度为零：$\\left(\\frac{\\partial p}{\\partial x}\\right)_{z} = 0$。\n2.  静力平衡：$\\frac{\\partial p}{\\partial z} = -\\rho g$。\n3.  坐标变换 $z(x,\\sigma) = z_s(x) + \\sigma H_{\\mathrm{top}}$，其中 $z_s(x)=\\epsilon x$，给出了 $\\sigma$ 表面的坡度：$\\left(\\frac{\\partial z}{\\partial x}\\right)_{\\sigma} = \\frac{\\mathrm{d}z_s}{\\mathrm{d}x} = \\epsilon$。\n\n将这些代入链式法则表达式中，得到：\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)_{\\sigma} = 0 + (-\\rho g)(\\epsilon) = -\\rho g \\epsilon\n$$\n因此，离散化的加速度 $a_x$ 近似为：\n$$\na_x \\approx -\\frac{1}{\\rho} \\left( -\\rho g \\epsilon \\right) = g\\epsilon\n$$\n这表明主阶虚假加速度就是 $g\\epsilon$。\n\n为了按要求进行更严格的推导并找出次阶项，我们使用泰勒展开。精确气压由 $p(x,\\sigma) = p_0 \\exp\\left(-\\frac{z(x,\\sigma)}{H}\\right)$ 给出。当 $z(x,\\sigma) = \\epsilon x + \\sigma H_{\\mathrm{top}}$ 时，这变为：\n$$\np(x,\\sigma) = p_0 \\exp\\left(-\\frac{\\epsilon x + \\sigma H_{\\mathrm{top}}}{H}\\right) = p_0 \\exp\\left(-\\frac{\\sigma H_{\\mathrm{top}}}{H}\\right) \\exp\\left(-\\frac{\\epsilon x}{H}\\right)\n$$\n让我们在固定的 $\\sigma_j$ 层上，计算点 $x_{i+1} = x_i + \\Delta x$ 和 $x_{i-1} = x_i - \\Delta x$ 处的气压：\n$$\np(x_i \\pm \\Delta x, \\sigma_j) = p(x_i, \\sigma_j) \\exp\\left(\\mp \\frac{\\epsilon \\Delta x}{H}\\right)\n$$\n现在，我们对指数项 $\\exp(u)$ 进行展开，其中 $u = \\mp \\frac{\\epsilon \\Delta x}{H}$ 是一个小量（假设坡度 $\\epsilon$ 很小）：\n$$\n\\exp(u) = 1 + u + \\frac{u^2}{2!} + \\frac{u^3}{3!} + \\dots\n$$\n这给出：\n$$\np(x_{i+1}, \\sigma_j) = p(x_i, \\sigma_j) \\left( 1 - \\frac{\\epsilon \\Delta x}{H} + \\frac{1}{2}\\left(\\frac{\\epsilon \\Delta x}{H}\\right)^2 - \\frac{1}{6}\\left(\\frac{\\epsilon \\Delta x}{H}\\right)^3 + \\mathcal{O}\\left((\\Delta x)^4\\right) \\right)\n$$\n$$\np(x_{i-1}, \\sigma_j) = p(x_i, \\sigma_j) \\left( 1 + \\frac{\\epsilon \\Delta x}{H} + \\frac{1}{2}\\left(\\frac{\\epsilon \\Delta x}{H}\\right)^2 + \\frac{1}{6}\\left(\\frac{\\epsilon \\Delta x}{H}\\right)^3 + \\mathcal{O}\\left((\\Delta x)^4\\right) \\right)\n$$\n气压差为：\n$$\np(x_{i+1}, \\sigma_j) - p(x_{i-1}, \\sigma_j) = p(x_i, \\sigma_j) \\left( -2\\frac{\\epsilon \\Delta x}{H} - \\frac{1}{3}\\left(\\frac{\\epsilon \\Delta x}{H}\\right)^3 + \\dots \\right)\n$$\n将此代回 $a_x(x_i, \\sigma_j)$ 的公式中：\n$$\na_x = -\\frac{R T_0}{p(x_i, \\sigma_j)} \\frac{p(x_i, \\sigma_j) \\left( -2\\frac{\\epsilon \\Delta x}{H} - \\frac{1}{3}\\left(\\frac{\\epsilon \\Delta x}{H}\\right)^3 + \\dots \\right)}{2\\Delta x}\n$$\n$p(x_i, \\sigma_j)$ 项被消去。\n$$\na_x = \\frac{R T_0}{2\\Delta x} \\left( 2\\frac{\\epsilon \\Delta x}{H} + \\frac{1}{3}\\left(\\frac{\\epsilon \\Delta x}{H}\\right)^3 + \\dots \\right) = \\frac{R T_0 \\epsilon}{H} \\left( 1 + \\frac{1}{6}\\left(\\frac{\\epsilon \\Delta x}{H}\\right)^2 + \\dots \\right)\n$$\n回顾标高 $H = \\frac{R T_0}{g}$ 的定义，我们得到虚假加速度的最终表达式：\n$$\na_x = g\\epsilon \\left( 1 + \\frac{1}{6}\\left(\\frac{\\epsilon \\Delta x}{H}\\right)^2 + \\dots \\right)\n$$\n虚假加速度的主阶表达式为 $a_x \\approx g\\epsilon$。该项与网格间距 $\\Delta x$ 无关。\n\n主阶项 $g\\epsilon$ 与 $\\sigma_j$（以及 $x_i$）无关，因为局部气压 $p(x_i, \\sigma_j)$ 同时作为分子（气压差）和分母（密度 $\\rho(x_i, \\sigma_j) = p(x_i, \\sigma_j) / (R T_0)$）中的乘法因子出现。该因子完全抵消，留下的表达式仅依赖于基本常数（$g$）和地形坡度（$\\epsilon$）。\n\n展开式中的次阶项是 $g\\epsilon \\cdot \\frac{1}{6}\\left(\\frac{\\epsilon \\Delta x}{H}\\right)^2 = \\frac{g}{6H^2}\\epsilon^3 \\Delta x^2$。这是针对此特定气压场的有限差分格式的主截断误差项。该次阶项的标度关系为 $\\mathcal{O}(\\epsilon^3 \\Delta x^2)$。它同时依赖于坡度 $\\epsilon$ 和网格间距 $\\Delta x$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the spurious horizontal acceleration for a set of test cases\n    using a non-consistent discretization of the Pressure Gradient Force on\n    a terrain-following coordinate system.\n    \"\"\"\n    # Physical and numerical parameters\n    g = 9.81  # m/s^2\n    R = 287.0  # J/(kg.K)\n    T0 = 300.0  # K\n    p0 = 100000.0  # Pa\n    H_top = 9000.0  # m\n    L = 10000.0  # m\n    \n    # Vertical coordinate for evaluation\n    sigma = 0.5\n    \n    # Derived physical constant: scale height\n    H = (R * T0) / g\n\n    # Test cases: (epsilon, delta_x)\n    test_cases = [\n        (0.01, 1000.0),   # Test 1 (happy path)\n        (0.01, 250.0),    # Test 2 (refined grid)\n        (0.001, 1000.0),  # Test 3 (small slope)\n        (0.1, 1000.0),    # Test 4 (larger slope)\n        (0.0, 1000.0)     # Test 5 (boundary case, zero slope)\n    ]\n\n    results = []\n    \n    # Helper functions for clarity\n    def get_z(x, sigma_val, epsilon, h_top_val):\n        \"\"\"Calculates physical height z.\"\"\"\n        z_s = epsilon * x\n        return z_s + sigma_val * h_top_val\n\n    def get_p(x, sigma_val, epsilon, h_top_val, p0_val, h_val):\n        \"\"\"Calculates hydrostatic pressure p.\"\"\"\n        z = get_z(x, sigma_val, epsilon, h_top_val)\n        return p0_val * np.exp(-z / h_val)\n\n    for epsilon, delta_x in test_cases:\n        # Set up the horizontal grid\n        # Nx: Number of grid points\n        # i_mid: Index for the central grid point\n        Nx = int(L / delta_x) + 1\n        i_mid = Nx // 2\n        \n        # Coordinates of the central point and its neighbors\n        x_mid = i_mid * delta_x\n        x_prev = (i_mid - 1) * delta_x\n        x_next = (i_mid + 1) * delta_x\n        \n        # Calculate pressure at the three required grid points on the constant sigma level\n        p_mid = get_p(x_mid, sigma, epsilon, H_top, p0, H)\n        p_prev = get_p(x_prev, sigma, epsilon, H_top, p0, H)\n        p_next = get_p(x_next, sigma, epsilon, H_top, p0, H)\n        \n        # Calculate density at the central point using the Ideal Gas Law\n        rho_mid = p_mid / (R * T0)\n        \n        # Calculate the spurious horizontal acceleration using the finite-difference formula\n        # a_x = -(1/rho) * (p(i+1) - p(i-1)) / (2*dx)\n        if rho_mid == 0:\n            # Avoid division by zero, though unlikely with these parameters\n            a_x = 0.0\n        else:\n            a_x = - (1.0 / rho_mid) * (p_next - p_prev) / (2.0 * delta_x)\n            \n        # Round the result to six decimal places and append to the list\n        results.append(round(a_x, 6))\n\n    # Format the final output as a comma-separated list in brackets\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "数值模型的准确性不仅取决于所选的公式，还取决于网格上变量的基本布局。本练习对比了两种常见的设计：同位网格和交错的Arakawa C-网格。通过模拟跨越急剧跳跃的压力梯度，您将数值研究为何地球物理流体动力学中通常首选交错网格，以防止可能污染同位网格解的虚假网格尺度噪声。",
            "id": "4078241",
            "problem": "考虑一个干大气的一维水平动量方程，在没有科里奥利力和粘性的情况下，该方程由 $ \\frac{\\partial u}{\\partial t} = -\\frac{1}{\\rho} \\frac{\\partial p}{\\partial x} $ 给出，其中 $ u $ 是速度（单位 $ \\mathrm{m/s} $），$ \\rho $ 是密度（单位 $ \\mathrm{kg/m^3} $），$ p $ 是气压（单位 $ \\mathrm{Pa} $）。气压梯度力（PGF）是加速度场 $ -\\frac{1}{\\rho} \\frac{\\partial p}{\\partial x} $，单位为 $ \\mathrm{m/s^2} $。在数值天气预报中，根据计算网格上变量的排布方式，有多种离散化 PGF 的方法。两种常见的排布方式是：\n\n- 同位网格，其中气压和速度都存储在网格中心。\n- 交错的 Arakawa C-网格，其中气压存储在网格中心，速度存储在网格面。\n\n您将比较在一个简单的气压场（该场在某个网格面上恰好有一个跳跃）下，使用同位网格与交错 C-网格计算 PGF 时产生的数值误差。请使用以下框架：\n\n- 计算域是周期性的、一维的，长度为 $ L $，被划分为 $ N $ 个大小为 $ \\Delta x = L/N $ 的均匀网格。\n- 气压 $ p_i $ 定义在网格中心，索引为 $ i = 0, 1, \\dots, N-1 $。\n- 气压场是分段常数，在网格面 $ i_0 + \\tfrac{1}{2} $ 处有一个不连续点。具体来说，对于 $ i \\le i_0 $，设置 $ p_i = p_{\\mathrm{L}} $；对于 $ i > i_0 $，设置 $ p_i = p_{\\mathrm{R}} $。该域使用周期性索引。\n- 密度 $ \\rho $ 是恒定的。\n\n定义以下离散 PGF 场：\n\n1. 一个基于网格面的参考 PGF 场，基于与交错 C-网格布局一致的控制体积法。将其解释为以网格面为中心的速度的物理上一致的加速度：网格面 $ i+\\tfrac{1}{2} $ 处的面 PGF 是通过相邻网格中心的气压差除以 $ \\Delta x $，再乘以 $ -\\frac{1}{\\rho} $ 得到的。\n\n2. 一个在同位网格上通过中心有限差分近似计算的网格中心 PGF。由于在有限体积法中，动量通量是在网格面上计算的，因此通过从相邻中心到网格面的二阶精确线性插值，从同位网格的中心 PGF 构建一个面 PGF。\n\n使用两种度量标准来量化每种方案相对于参考面 PGF 的误差：\n- 均方根误差 (RMSE)，定义为 $ \\sqrt{\\frac{1}{N} \\sum_{i=0}^{N-1} \\left(a^{\\mathrm{approx}}_{i+\\frac{1}{2}} - a^{\\mathrm{ref}}_{i+\\frac{1}{2}}\\right)^2 } $，单位为 $ \\mathrm{m/s^2} $。\n- 最大绝对误差，定义为 $ \\max_{i} \\left| a^{\\mathrm{approx}}_{i+\\frac{1}{2}} - a^{\\mathrm{ref}}_{i+\\frac{1}{2}} \\right| $，单位为 $ \\mathrm{m/s^2} $。\n\n实现一个程序，对于下面的每个测试用例，该程序将构建气压场，并计算：\n- 参考面 PGF，\n- 交错 C-网格 PGF（其计算与参考 PGF 相同），\n- 同位网格中心 PGF 及其插值得到的面 PGF，\n然后评估同位网格方案和交错网格方案相对于参考面 PGF 的 RMSE 和最大绝对误差。\n\n使用以下测试套件（所有量均采用国际单位制）：\n\n- 测试用例 1（正常路径）：$ N = 10 $，$ L = 1000\\,\\mathrm{m} $，$ \\rho = 1.2\\,\\mathrm{kg/m^3} $，$ p_{\\mathrm{L}} = 100000\\,\\mathrm{Pa} $，$ p_{\\mathrm{R}} = 100010\\,\\mathrm{Pa} $，$ i_0 = 4 $。\n- 测试用例 2（零跳跃边缘情况）：$ N = 10 $，$ L = 1000\\,\\mathrm{m} $，$ \\rho = 1.2\\,\\mathrm{kg/m^3} $，$ p_{\\mathrm{L}} = 100000\\,\\mathrm{Pa} $，$ p_{\\mathrm{R}} = 100000\\,\\mathrm{Pa} $，$ i_0 = 4 $。\n- 测试用例 3（最小网格）：$ N = 2 $，$ L = 2\\,\\mathrm{m} $，$ \\rho = 1.0\\,\\mathrm{kg/m^3} $，$ p_{\\mathrm{L}} = 100000\\,\\mathrm{Pa} $，$ p_{\\mathrm{R}} = 100200\\,\\mathrm{Pa} $，$ i_0 = 0 $。\n- 测试用例 4（更大的跳跃和网格）：$ N = 50 $，$ L = 5000\\,\\mathrm{m} $，$ \\rho = 1.0\\,\\mathrm{kg/m^3} $，$ p_{\\mathrm{L}} = 101000\\,\\mathrm{Pa} $，$ p_{\\mathrm{R}} = 100900\\,\\mathrm{Pa} $，$ i_0 = 24 $。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例贡献一个包含四个浮点数 $ [\\mathrm{RMSE}_{\\mathrm{collocated}}, \\mathrm{RMSE}_{\\mathrm{staggered}}, \\mathrm{MaxErr}_{\\mathrm{collocated}}, \\mathrm{MaxErr}_{\\mathrm{staggered}}] $ 的子列表，所有数值的单位均为 $ \\mathrm{m/s^2} $。例如，输出格式为 $ [[x_1,x_2,x_3,x_4],[y_1,y_2,y_3,y_4],\\dots] $，不含空格。",
            "solution": "## 问题验证\n\n### 步骤 1：提取已知条件\n\n**控制方程：**\n$ \\frac{\\partial u}{\\partial t} = -\\frac{1}{\\rho} \\frac{\\partial p}{\\partial x} $\n其中 $u$ 是速度，$\\rho$ 是密度，$p$ 是气压。\n\n**气压梯度力 (PGF)：**\n$ \\mathrm{PGF} = -\\frac{1}{\\rho} \\frac{\\partial p}{\\partial x} $\n\n**计算域：**\n- 一维、周期性，长度为 $L$。\n- 划分为 $N$ 个大小为 $\\Delta x = L/N$ 的均匀网格。\n- 气压 $p_i$ 定义在网格中心，索引为 $i = 0, 1, \\dots, N-1$。\n\n**气压场：**\n- 在网格面 $i_0 + \\tfrac{1}{2}$ 处存在单个不连续点的分段常数。\n- 对于 $i \\le i_0$，$p_i = p_{\\mathrm{L}}$。\n- 对于 $i > i_0$，$p_i = p_{\\mathrm{R}}$。\n- 域使用周期性索引。\n\n**密度：**\n- $\\rho$ 是恒定的。\n\n**离散 PGF 定义：**\n1.  **参考面 PGF ($a^{\\mathrm{ref}}$)：** 定义在网格面 $i+\\tfrac{1}{2}$。\n    $ a^{\\mathrm{ref}}_{i+\\frac{1}{2}} = -\\frac{1}{\\rho} \\frac{p_{i+1} - p_i}{\\Delta x} $\n2.  **交错 C-网格面 PGF ($a^{\\mathrm{stag}}$)：** 其计算与参考 PGF 相同。\n    $ a^{\\mathrm{stag}}_{i+\\frac{1}{2}} = a^{\\mathrm{ref}}_{i+\\frac{1}{2}} $\n3.  **同位网格面 PGF ($a^{\\mathrm{colloc}}$)：**\n    - 首先，在网格中心 $i$ 处使用中心有限差分计算中心 PGF：\n      $ a^{\\mathrm{center}}_i = -\\frac{1}{\\rho} \\frac{p_{i+1} - p_{i-1}}{2\\Delta x} $\n    - 其次，使用线性插值将中心 PGF 插值到网格面 $i+\\tfrac{1}{2}$：\n      $ a^{\\mathrm{approx}}_{i+\\frac{1}{2}} = \\frac{a^{\\mathrm{center}}_i + a^{\\mathrm{center}}_{i+1}}{2} $\n\n**误差度量：**\n- 均方根误差 (RMSE)：$ \\sqrt{\\frac{1}{N} \\sum_{i=0}^{N-1} \\left(a^{\\mathrm{approx}}_{i+\\frac{1}{2}} - a^{\\mathrm{ref}}_{i+\\frac{1}{2}}\\right)^2 } $\n- 最大绝对误差：$ \\max_{i} \\left| a^{\\mathrm{approx}}_{i+\\frac{1}{2}} - a^{\\mathrm{ref}}_{i+\\frac{1}{2}} \\right| $\n\n**测试用例（所有量均采用国际单位制）：**\n- **用例 1：** $ N = 10 $，$ L = 1000 $，$ \\rho = 1.2 $，$ p_{\\mathrm{L}} = 100000 $，$ p_{\\mathrm{R}} = 100010 $，$ i_0 = 4 $。\n- **用例 2：** $ N = 10 $，$ L = 1000 $，$ \\rho = 1.2 $，$ p_{\\mathrm{L}} = 100000 $，$ p_{\\mathrm{R}} = 100000 $，$ i_0 = 4 $。\n- **用例 3：** $ N = 2 $，$ L = 2 $，$ \\rho = 1.0 $，$ p_{\\mathrm{L}} = 100000 $，$ p_{\\mathrm{R}} = 100200 $，$ i_0 = 0 $。\n- **用例 4：** $ N = 50 $，$ L = 5000 $，$ \\rho = 1.0 $，$ p_{\\mathrm{L}} = 101000 $，$ p_{\\mathrm{R}} = 100900 $，$ i_0 = 24 $。\n\n**输出格式：**\n一个列表的列表，例如，$ [[x_1,x_2,x_3,x_4],[y_1,y_2,y_3,y_4],\\dots] $，其中每个子列表是 $ [\\mathrm{RMSE}_{\\mathrm{collocated}}, \\mathrm{RMSE}_{\\mathrm{staggered}}, \\mathrm{MaxErr}_{\\mathrm{collocated}}, \\mathrm{MaxErr}_{\\mathrm{staggered}}] $。\n\n### 步骤 2：使用提取的已知条件进行验证\n\n- **科学依据：** 该问题牢固地植根于计算流体动力学领域，特别是地球物理流体动力学的数值方法。一维动量方程是一个标准的简化。同位网格和交错网格（特别是 Arakawa C-网格）的概念是设计天气和气候数值模型的基础。PGF 离散化误差，特别是对于非光滑场，是一个经典且重要的话题。问题设置在物理上和数学上都是合理的。\n- **适定性：** 问题已完全指定。每个用例都给出了所有必要的参数（$L, N, \\rho, p_{\\mathrm{L}}, p_{\\mathrm{R}}, i_0$）。两种方案的离散化公式都已明确定义。误差度量是标准且无歧义的。该问题要求进行直接的数值计算，其解是唯一的。\n- **客观性：** 问题陈述使用物理学和数值分析中常见的精确技术语言表达。没有主观、模糊或基于观点的陈述。\n\n该问题不存在任何无效性缺陷。这是一个标准的、适定的数值实验，旨在比较两种常见有限差分方案的性质。\n\n### 步骤 3：结论与行动\n问题有效。将提供完整解答。\n\n## 解题思路\n\n目标是量化两种不同空间离散化方案对一维周期域中气压梯度力（PGF）项 $-\\frac{1}{\\rho} \\frac{\\partial p}{\\partial x}$ 的数值误差。这两种方案分别对应同位网格和交错的 Arakawa C-网格。我们给定一个具有单个不连续点的分段常数气压场。\n\n设域的长度为 $L$，离散为 $N$ 个宽度为 $\\Delta x = L/N$ 的网格。网格中心索引为 $i = 0, \\dots, N-1$。气压 $p_i$ 定义在网格中心。气压场由 $p_i = p_{\\mathrm{L}}$（对于 $i \\leq i_0$）和 $p_i = p_{\\mathrm{R}}$（对于 $i > i_0$）给出，并采用周期性索引。分隔网格的面索引为 $i+\\frac{1}{2}$。密度 $\\rho$ 是常数。\n\n### 1. 参考 PGF 和交错 C-网格 PGF\n\n问题在网格面上定义了一个参考 PGF $a^{\\mathrm{ref}}_{i+\\frac{1}{2}}$，该定义基于有限体积法，与速度位于交错网格上的情况一致。这是在网格面 $i+\\frac{1}{2}$ 处计算的气压的中心差分，使用了两个相邻网格中心 $i$ 和 $i+1$ 的气压值。\n$$\na^{\\mathrm{ref}}_{i+\\frac{1}{2}} = -\\frac{1}{\\rho} \\frac{p_{i+1} - p_i}{\\Delta x}\n$$\n域的周期性意味着索引是对 $N$ 取模。例如，对于域右边界处的面 $(N-1)+\\frac{1}{2}$，气压差为 $p_{(N-1)+1} - p_{N-1} = p_0 - p_{N-1}$。\n\n问题陈述指出，交错 C-网格 PGF $a^{\\mathrm{stag}}$ 的计算方式与参考 PGF 完全相同。\n$$\na^{\\mathrm{stag}}_{i+\\frac{1}{2}} = a^{\\mathrm{ref}}_{i+\\frac{1}{2}}\n$$\n这是问题设计的关键方面。交错 C-网格将速度置于网格面，将气压置于中心，使得上述公式成为计算速度分量加速度的自然方式。通过以这种方式定义参考解，问题隐含地将交错方案确立为针对此特定变量排布和物理解释的“正确”或理想的方案。因此，根据定义，交错方案的误差恒为零。\n$$\n\\mathrm{RMSE}_{\\mathrm{staggered}} = \\sqrt{\\frac{1}{N} \\sum_{i=0}^{N-1} \\left(a^{\\mathrm{stag}}_{i+\\frac{1}{2}} - a^{\\mathrm{ref}}_{i+\\frac{1}{2}}\\right)^2} = 0\n$$\n$$\n\\mathrm{MaxErr}_{\\mathrm{staggered}} = \\max_{i} \\left| a^{\\mathrm{stag}}_{i+\\frac{1}{2}} - a^{\\mathrm{ref}}_{i+\\frac{1}{2}} \\right| = 0\n$$\n\n### 2. 同位网格 PGF\n\n在同位网格上，所有变量，包括气压 $p$ 和速度 $u$，都定义在同一位置，即网格中心 $i$。PGF 也首先在网格中心计算。\n\n**步骤 A：网格中心的 PGF**\n在网格中心 $i$ 处，气压梯度 $\\frac{\\partial p}{\\partial x}$ 的一个二阶精确的中心有限差分近似使用了相邻中心 $i-1$ 和 $i+1$ 的气压值。\n$$\na^{\\mathrm{center}}_i = -\\frac{1}{\\rho} \\left( \\frac{p_{i+1} - p_{i-1}}{2\\Delta x} \\right)\n$$\n同样，对于 $i=0$（其中 $i-1$ 对应 $N-1$）和 $i=N-1$（其中 $i+1$ 对应 $0$），必须使用周期性索引。\n\n**步骤 B：插值到网格面**\n为了与基于网格面的参考 PGF 进行比较，必须在网格面上计算这个网格中心的 PGF。问题指定了一个二阶精确的线性插值。网格面 $i+\\frac{1}{2}$ 处的 PGF 是相邻中心 $i$ 和 $i+1$ 处 PGF 的算术平均值。\n$$\na^{\\mathrm{colloc}}_{i+\\frac{1}{2}} = \\frac{a^{\\mathrm{center}}_i + a^{\\mathrm{center}}_{i+1}}{2}\n$$\n这种先微分后平均的过程是同位网格上的一种常用方法。然而，众所周知，这种方法具有较差的特性，特别是对于场中的高波数特征。所提供的气压跳跃函数富含此类特征。$a^{\\mathrm{center}}_i$ 的中心差分算子完全无法识别波长为 $2\\Delta x$ 的任何气压场分量，因为对于这种模式，$p_{i+1}-p_{i-1}$ 将为零。这会导致伪振荡，计算过程将证明这一点。\n\n### 3. 同位网格方案的误差计算\n\n同位网格方案的误差是通过将其面 PGF $a^{\\mathrm{colloc}}_{i+\\frac{1}{2}}$ 与参考 PGF $a^{\\mathrm{ref}}_{i+\\frac{1}{2}}$ 进行比较来计算的。\n每个面上的误差为 $E_{i+\\frac{1}{2}} = a^{\\mathrm{colloc}}_{i+\\frac{1}{2}} - a^{\\mathrm{ref}}_{i+\\frac{1}{2}}$。\n\n所需的误差度量则为：\n$$\n\\mathrm{RMSE}_{\\mathrm{collocated}} = \\sqrt{\\frac{1}{N} \\sum_{i=0}^{N-1} \\left( E_{i+\\frac{1}{2}} \\right)^2}\n$$\n$$\n\\mathrm{MaxErr}_{\\mathrm{collocated}} = \\max_{i=0, \\dots, N-1} \\left| E_{i+\\frac{1}{2}} \\right|\n$$\n\n### 4. 实现算法\n对于每个测试用例，执行以下步骤：\n1.  初始化参数：$N, L, \\rho, p_{\\mathrm{L}}, p_{\\mathrm{R}}, i_0$。\n2.  计算网格间距 $\\Delta x = L/N$。\n3.  构建大小为 $N$ 的以网格为中心的气压数组 $p$，其中对于 $i \\leq i_0$，$p_i=p_{\\mathrm{L}}$；对于 $i > i_0$，$p_i=p_{\\mathrm{R}}$。\n4.  计算大小为 $N$ 的参考面 PGF 数组 $a^{\\mathrm{ref}}$。这涉及计算所有 $i$ 的 $p_{i+1} - p_i$，可以使用气压数组的滚动版本高效完成以获得 $p_{i+1}$。\n5.  将交错方案的误差 $\\mathrm{RMSE}_{\\mathrm{staggered}}$ 和 $\\mathrm{MaxErr}_{\\mathrm{staggered}}$ 设置为 $0$。\n6.  计算大小为 $N$ 的同位网格中心 PGF 数组 $a^{\\mathrm{center}}$。这需要计算所有 $i$ 的 $p_{i+1} - p_{i-1}$，可以使用气压数组的两个滚动版本完成。\n7.  通过对 $a^{\\mathrm{center}}$ 的相邻元素求平均，计算大小为 $N$ 的同位网格面 PGF 数组 $a^{\\mathrm{colloc}}$。\n8.  计算误差数组 $E = a^{\\mathrm{colloc}} - a^{\\mathrm{ref}}$。\n9.  从误差数组 $E$ 计算 $\\mathrm{RMSE}_{\\mathrm{collocated}}$ 和 $\\mathrm{MaxErr}_{\\mathrm{collocated}}$。\n10. 存储当前测试用例的四个误差度量。\n11. 处理完所有测试用例后，将收集到的结果格式化为指定的字符串格式。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes PGF errors for collocated and staggered grids for given test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, L, rho, p_L, p_R, i_0)\n        (10, 1000.0, 1.2, 100000.0, 100010.0, 4),\n        (10, 1000.0, 1.2, 100000.0, 100000.0, 4),\n        (2, 2.0, 1.0, 100000.0, 100200.0, 0),\n        (50, 5000.0, 1.0, 101000.0, 100900.0, 24),\n    ]\n\n    all_results = []\n    for case in test_cases:\n        N, L, rho, p_L, p_R, i_0 = case\n        \n        # 1. Setup Grid and Pressure Field\n        dx = L / N\n        indices = np.arange(N)\n        p = np.where(indices = i_0, p_L, p_R)\n\n        # 2. Compute Reference and Staggered C-Grid PGF (at faces i+1/2)\n        # The staggered grid PGF is defined to be the same as the reference.\n        # p_ip1 corresponds to p_{i+1} for each index i.\n        p_ip1 = np.roll(p, -1)\n        a_ref = -1.0 / rho * (p_ip1 - p) / dx\n        a_stag = a_ref\n        \n        # Errors for the staggered scheme are zero by definition.\n        rmse_stag = 0.0\n        max_err_stag = 0.0\n\n        # 3. Compute Collocated Grid PGF\n        # Step A: Compute PGF at cell centers (i)\n        # p_im1 corresponds to p_{i-1} for each index i.\n        p_im1 = np.roll(p, 1)\n        a_center = -1.0 / rho * (p_ip1 - p_im1) / (2.0 * dx)\n\n        # Step B: Interpolate to faces (i+1/2)\n        # a_center_ip1 corresponds to a_center_{i+1} for each index i.\n        a_center_ip1 = np.roll(a_center, -1)\n        a_colloc = (a_center + a_center_ip1) / 2.0\n\n        # 4. Calculate Errors for the Collocated Scheme\n        error = a_colloc - a_ref\n        \n        # RMSE\n        # np.mean(error**2) is (1/N) * sum(error_i^2)\n        rmse_colloc = np.sqrt(np.mean(error**2))\n        \n        # Max Absolute Error\n        max_err_colloc = np.max(np.abs(error))\n\n        # Store results for this case\n        case_results = [\n            rmse_colloc,\n            rmse_stag,\n            max_err_colloc,\n            max_err_stag\n        ]\n        all_results.append(case_results)\n\n    # Format the final output string\n    # e.g., [[x1,x2,x3,x4],[y1,y2,y3,y4]]\n    result_str = \",\".join([\n        f\"[{','.join(map(str, res))}]\" for res in all_results\n    ])\n    \n    # Final print statement in the exact required format.\n    print(f\"[{result_str}]\")\n\nsolve()\n```"
        }
    ]
}