{
    "hands_on_practices": [
        {
            "introduction": "The first step in numerical modeling is translating continuous differential equations into a discrete form that a computer can solve. This process inevitably introduces an error, known as truncation error. This exercise  provides a foundational practice in this translation, asking you to discretize the pressure gradient force using a finite-difference scheme and then analytically derive the leading-order truncation error, a crucial skill for understanding and evaluating numerical methods.",
            "id": "4078188",
            "problem": "Consider a continuously stratified, inviscid, dry atmosphere in the context of Numerical Weather Prediction (NWP). The analytic pressure field is given by $p(x,y,z)=p_0 \\exp(-\\alpha x - \\beta y - \\gamma z)$, where $p_0>0$ and $\\alpha>0$, $\\beta>0$, $\\gamma>0$ are constants. The mass density is a smooth, strictly positive function of height, $\\rho(z)>0$. Assume that the only internal stress is the isotropic pressure, represented by the stress tensor $-p \\mathbf{I}$.\n\nStarting from Newton's second law applied to a fluid parcel and the Cauchy momentum equation for an inviscid fluid, derive the mass-specific pressure-gradient acceleration vector field for this atmosphere. Using your result, compute the componentwise magnitudes $|a_{p,x}|$, $|a_{p,y}|$, and $|a_{p,z}|$ and determine their ratio. Then, on a uniform Cartesian grid, construct a second-order centered finite-difference approximation for the $x$-derivative of pressure at a grid point $(x,y,z)$ using grid spacing $\\Delta x>0$, and form the discrete pressure-gradient acceleration $a_{p,x}^{(d)}(x,y,z)$ by evaluating $1/\\rho$ at the central level $z$.\n\nDerive the leading-order truncation error term in $a_{p,x}^{(d)}(x,y,z)$ and its magnitude. Finally, report the ratio $E_x$ of the leading-order truncation error magnitude in $a_{p,x}^{(d)}(x,y,z)$ to the magnitude of the continuous $x$-component $a_{p,x}(x,y,z)$. Express the final ratio $E_x$ as a single closed-form analytic expression in terms of $\\alpha$ and $\\Delta x$. The pressure-gradient acceleration has units of $\\mathrm{m\\,s^{-2}}$, but the reported ratio $E_x$ must be expressed as a dimensionless quantity. No numerical approximation is required.",
            "solution": "The problem asks for several derivations related to the pressure-gradient acceleration in a specified atmospheric model. The validation process confirms that the problem statement is scientifically grounded, well-posed, and contains all necessary information for a complete solution.\n\nFirst, we derive the mass-specific pressure-gradient acceleration vector field, $\\mathbf{a}_p$. According to the principles of fluid dynamics, specifically the Cauchy momentum equation for an inviscid fluid, the force per unit volume due to pressure is given by the negative of the pressure gradient, $-\\nabla p$. The force per unit mass, which is the acceleration, is obtained by dividing by the mass density $\\rho$. Therefore, the pressure-gradient acceleration is:\n$$\n\\mathbf{a}_p(x,y,z) = -\\frac{1}{\\rho(z)} \\nabla p(x,y,z)\n$$\nThe pressure field is given as $p(x,y,z) = p_0 \\exp(-\\alpha x - \\beta y - \\gamma z)$. We compute the gradient of $p$, which is the vector of its partial derivatives:\n$$\n\\nabla p = \\frac{\\partial p}{\\partial x}\\mathbf{i} + \\frac{\\partial p}{\\partial y}\\mathbf{j} + \\frac{\\partial p}{\\partial z}\\mathbf{k}\n$$\nThe partial derivatives are:\n$$\n\\frac{\\partial p}{\\partial x} = \\frac{\\partial}{\\partial x} \\left[p_0 \\exp(-\\alpha x - \\beta y - \\gamma z)\\right] = p_0 (-\\alpha) \\exp(-\\alpha x - \\beta y - \\gamma z) = -\\alpha p(x,y,z)\n$$\n$$\n\\frac{\\partial p}{\\partial y} = \\frac{\\partial}{\\partial y} \\left[p_0 \\exp(-\\alpha x - \\beta y - \\gamma z)\\right] = p_0 (-\\beta) \\exp(-\\alpha x - \\beta y - \\gamma z) = -\\beta p(x,y,z)\n$$\n$$\n\\frac{\\partial p}{\\partial z} = \\frac{\\partial}{\\partial z} \\left[p_0 \\exp(-\\alpha x - \\beta y - \\gamma z)\\right] = p_0 (-\\gamma) \\exp(-\\alpha x - \\beta y - \\gamma z) = -\\gamma p(x,y,z)\n$$\nThus, the gradient of the pressure field can be written compactly as:\n$$\n\\nabla p(x,y,z) = -(\\alpha\\mathbf{i} + \\beta\\mathbf{j} + \\gamma\\mathbf{k}) p(x,y,z)\n$$\nSubstituting this into the expression for $\\mathbf{a}_p$:\n$$\n\\mathbf{a}_p(x,y,z) = -\\frac{1}{\\rho(z)} \\left[-(\\alpha\\mathbf{i} + \\beta\\mathbf{j} + \\gamma\\mathbf{k}) p(x,y,z)\\right] = \\frac{p(x,y,z)}{\\rho(z)}(\\alpha\\mathbf{i} + \\beta\\mathbf{j} + \\gamma\\mathbf{k})\n$$\nThe components of the acceleration vector are:\n$$\na_{p,x}(x,y,z) = \\frac{\\alpha p(x,y,z)}{\\rho(z)}\n$$\n$$\na_{p,y}(x,y,z) = \\frac{\\beta p(x,y,z)}{\\rho(z)}\n$$\n$$\na_{p,z}(x,y,z) = \\frac{\\gamma p(x,y,z)}{\\rho(z)}\n$$\nGiven that $p_0>0$, $\\alpha>0$, $\\beta>0$, $\\gamma>0$, and $\\rho(z)>0$, the pressure $p(x,y,z)$ is always positive. Therefore, the componentwise magnitudes are:\n$$\n|a_{p,x}| = \\frac{\\alpha p}{\\rho}, \\quad |a_{p,y}| = \\frac{\\beta p}{\\rho}, \\quad |a_{p,z}| = \\frac{\\gamma p}{\\rho}\n$$\nThe ratio of these magnitudes is:\n$$\n|a_{p,x}| : |a_{p,y}| : |a_{p,z}| = \\frac{\\alpha p}{\\rho} : \\frac{\\beta p}{\\rho} : \\frac{\\gamma p}{\\rho} = \\alpha : \\beta : \\gamma\n$$\nNext, we construct the second-order centered finite-difference approximation for the $x$-derivative of pressure, $\\frac{\\partial p}{\\partial x}$. The formula for this approximation at a point $(x,y,z)$ with grid spacing $\\Delta x$ is:\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)^{(d)} = \\frac{p(x+\\Delta x, y, z) - p(x-\\Delta x, y, z)}{2\\Delta x}\n$$\nWe evaluate the pressure function at the shifted points:\n$$\np(x+\\Delta x, y, z) = p_0 \\exp(-\\alpha(x+\\Delta x) - \\beta y - \\gamma z) = p(x,y,z) \\exp(-\\alpha \\Delta x)\n$$\n$$\np(x-\\Delta x, y, z) = p_0 \\exp(-\\alpha(x-\\Delta x) - \\beta y - \\gamma z) = p(x,y,z) \\exp(\\alpha \\Delta x)\n$$\nSubstituting these into the finite-difference formula:\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)^{(d)} = \\frac{p(x,y,z) \\exp(-\\alpha \\Delta x) - p(x,y,z) \\exp(\\alpha \\Delta x)}{2\\Delta x} = p(x,y,z) \\frac{\\exp(-\\alpha \\Delta x) - \\exp(\\alpha \\Delta x)}{2\\Delta x}\n$$\nUsing the definition of the hyperbolic sine function, $\\sinh(u) = (\\exp(u) - \\exp(-u))/2$, we can simplify this expression:\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)^{(d)} = - p(x,y,z) \\frac{\\exp(\\alpha \\Delta x) - \\exp(-\\alpha \\Delta x)}{2\\Delta x} = - p(x,y,z) \\frac{\\sinh(\\alpha \\Delta x)}{\\Delta x}\n$$\nThe discrete pressure-gradient acceleration in the $x$-direction, $a_{p,x}^{(d)}$, is formed by using this discrete derivative:\n$$\na_{p,x}^{(d)}(x,y,z) = -\\frac{1}{\\rho(z)} \\left(\\frac{\\partial p}{\\partial x}\\right)^{(d)} = -\\frac{1}{\\rho(z)} \\left(-p(x,y,z) \\frac{\\sinh(\\alpha \\Delta x)}{\\Delta x}\\right) = \\frac{p(x,y,z)}{\\rho(z)} \\frac{\\sinh(\\alpha \\Delta x)}{\\Delta x}\n$$\nNow, we find the leading-order truncation error. The truncation error is the difference between the discrete approximation and the exact continuous quantity, $T_{a,x} = a_{p,x}^{(d)} - a_{p,x}$. We can find this by expanding $a_{p,x}^{(d)}$ in a Taylor series for small $\\Delta x$. The Taylor series for $\\sinh(u)$ around $u=0$ is $\\sinh(u) = u + \\frac{u^3}{3!} + \\frac{u^5}{5!} + \\dots$.\nLet $u = \\alpha \\Delta x$. Then:\n$$\n\\frac{\\sinh(\\alpha \\Delta x)}{\\Delta x} = \\frac{1}{\\Delta x} \\left(\\alpha \\Delta x + \\frac{(\\alpha \\Delta x)^3}{6} + O(\\Delta x^5)\\right) = \\alpha + \\frac{\\alpha^3 \\Delta x^2}{6} + O(\\Delta x^4)\n$$\nSubstituting this expansion back into the expression for $a_{p,x}^{(d)}$:\n$$\na_{p,x}^{(d)} = \\frac{p}{\\rho} \\left(\\alpha + \\frac{\\alpha^3 \\Delta x^2}{6} + O(\\Delta x^4)\\right) = \\frac{\\alpha p}{\\rho} + \\frac{\\alpha^3 p \\Delta x^2}{6\\rho} + O(\\Delta x^4)\n$$\nThe first term, $\\frac{\\alpha p}{\\rho}$, is exactly the continuous acceleration component $a_{p,x}$. The remaining terms represent the truncation error. The leading-order truncation error term is the first of these terms:\n$$\nT_{a,x, \\text{leading}} = \\frac{\\alpha^3 p(x,y,z) \\Delta x^2}{6\\rho(z)}\n$$\nSince all parameters and functions are positive, the magnitude of this error is the term itself:\n$$\n|T_{a,x, \\text{leading}}| = \\frac{\\alpha^3 p \\Delta x^2}{6\\rho}\n$$\nFinally, we compute the ratio $E_x$ of the magnitude of the leading-order truncation error to the magnitude of the continuous $x$-component of the acceleration.\n$$\n|a_{p,x}| = \\left|\\frac{\\alpha p}{\\rho}\\right| = \\frac{\\alpha p}{\\rho}\n$$\n$$\nE_x = \\frac{|T_{a,x, \\text{leading}}|}{|a_{p,x}|} = \\frac{\\frac{\\alpha^3 p \\Delta x^2}{6\\rho}}{\\frac{\\alpha p}{\\rho}}\n$$\nThe terms $p(x,y,z)$ and $\\rho(z)$ cancel out:\n$$\nE_x = \\frac{\\alpha^3 \\Delta x^2}{6\\alpha} = \\frac{\\alpha^2 \\Delta x^2}{6}\n$$\nThis expression is dimensionless, as $\\alpha$ has units of inverse length and $\\Delta x$ has units of length. The result is a closed-form analytic expression in terms of $\\alpha$ and $\\Delta x$ as required.",
            "answer": "$$\n\\boxed{\\frac{\\alpha^{2} \\Delta x^{2}}{6}}\n$$"
        },
        {
            "introduction": "While simple finite-difference schemes work well on uniform Cartesian grids, real-world applications like weather forecasting must account for topography. Terrain-following coordinates are a common solution, but they introduce significant numerical challenges, as a seemingly reasonable discretization can fail in this common physical scenario. This practice  guides you through deriving and numerically computing the famous pressure gradient force error over sloping terrain, illustrating how inconsistent discretization can generate non-physical, or \"spurious,\" forces in an atmosphere that should be perfectly at rest.",
            "id": "4078195",
            "problem": "Consider a two-dimensional, dry, hydrostatic atmosphere over a gently sloping mountain represented by a terrain surface $z_s(x)$, where the slope is constant and given by $\\mathrm{d}z_s/\\mathrm{d}x = \\epsilon$. Assume a horizontally uniform temperature $T_0$ and a constant gravitational acceleration $g$. The hydrostatic balance is defined by the fundamental law $\\frac{\\partial p}{\\partial z} = -\\rho g$, and the Ideal Gas Law $p = \\rho R T_0$, where $p$ is pressure, $\\rho$ is density, $R$ is the specific gas constant for dry air, and $T_0$ is the constant temperature. Define the scale height $H = \\frac{R T_0}{g}$. Let the top-of-atmosphere height be $H_{\\mathrm{top}}$, and introduce the terrain-following coordinate $\\sigma \\in [0,1]$ mapped to physical height via $z(x,\\sigma) = z_s(x) + \\sigma H_{\\mathrm{top}}$. The exact hydrostatic pressure profile is $p(x,\\sigma) = p_0 \\exp\\!\\left(-\\frac{z(x,\\sigma)}{H}\\right)$ with a reference sea-level pressure $p_0$.\n\nA non-consistent discretization of the horizontal Pressure Gradient Force (PGF) on terrain-following levels computes the horizontal acceleration at a fixed $\\sigma_j$ as\n$$\na_x(x_i,\\sigma_j) = -\\frac{1}{\\rho(x_i,\\sigma_j)} \\frac{p(x_{i+1},\\sigma_j) - p(x_{i-1},\\sigma_j)}{2\\Delta x},\n$$\nwhere $\\Delta x$ is the horizontal grid spacing, and $\\rho(x_i,\\sigma_j) = \\frac{p(x_i,\\sigma_j)}{R T_0}$.\n\nYour tasks are:\n1. Starting from the stated fundamental relations, derive the leading-order expression for the spurious horizontal acceleration $a_x$ produced by this non-consistent discretization over the sloping terrain. Express the dependence of $a_x$ on the slope $\\epsilon$ and the grid spacing $\\Delta x$, using a Taylor expansion where appropriate. Explain why the leading-order term is independent of $\\sigma_j$ and provide the scaling of the next-order term with $\\epsilon$ and $\\Delta x$.\n2. Implement a program that evaluates $a_x$ numerically for the center of the domain ($x$ at the midpoint of the horizontal grid) and the mid-level $\\sigma = 0.5$, using the specified discretization. Use the exact hydrostatic pressure field $p(x,\\sigma) = p_0 \\exp\\!\\left(-\\frac{z_s(x) + \\sigma H_{\\mathrm{top}}}{H}\\right)$ with $z_s(x) = \\epsilon x$ and $\\rho(x,\\sigma) = \\frac{p(x,\\sigma)}{R T_0}$.\n\nUse the following physical and numerical parameters:\n- $g = 9.81$ in $\\mathrm{m/s^2}$,\n- $R = 287$ in $\\mathrm{J/(kg\\cdot K)}$,\n- $T_0 = 300$ in $\\mathrm{K}$,\n- $p_0 = 100000$ in $\\mathrm{Pa}$,\n- $H_{\\mathrm{top}} = 9000$ in $\\mathrm{m}$,\n- Domain length $L = 10000$ in $\\mathrm{m}$.\n\nDefine the horizontal grid as $x_i = i \\Delta x$ for $i = 0,1,\\dots,N_x-1$ with $N_x = \\left\\lfloor \\frac{L}{\\Delta x} \\right\\rfloor + 1$. Evaluate the central finite-difference approximation at the midpoint index $i_{\\mathrm{mid}} = \\left\\lfloor \\frac{N_x}{2} \\right\\rfloor$.\n\nCompute $a_x$ in $\\mathrm{m/s^2}$ for each of the following test cases (pairs $(\\epsilon,\\Delta x)$):\n- Test 1 (happy path): $(\\epsilon,\\Delta x) = (0.01, 1000)$,\n- Test 2 (refined grid): $(\\epsilon,\\Delta x) = (0.01, 250)$,\n- Test 3 (small slope): $(\\epsilon,\\Delta x) = (0.001, 1000)$,\n- Test 4 (larger slope within small-slope regime): $(\\epsilon,\\Delta x) = (0.1, 1000)$,\n- Test 5 (boundary case): $(\\epsilon,\\Delta x) = (0.0, 1000)$.\n\nExpress each resulting $a_x$ in $\\mathrm{m/s^2}$, rounded to six decimal places.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[$a_1$,$a_2$,$a_3$,$a_4$,$a_5$]\"), where each $a_k$ corresponds to the test case in the order listed above.",
            "solution": "The problem is valid. It presents a standard, well-posed problem in numerical methods for atmospheric modeling, providing all necessary physical and numerical parameters for both analytical derivation and numerical implementation. The underlying principles are scientifically sound, and the objectives are clear and formalizable.\n\nThe task is to analyze the spurious horizontal acceleration generated by a common, but flawed, finite-difference approximation of the Pressure Gradient Force (PGF) in a terrain-following coordinate system. In the given scenario of a hydrostatic atmosphere at rest over sloping terrain, the true horizontal acceleration is zero, as there are no horizontal pressure gradients on surfaces of constant geometric height $z$. Any calculated non-zero acceleration $a_x$ is a numerical artifact.\n\nFirst, we derive an analytical expression for this spurious acceleration, $a_x$. The provided numerical scheme is:\n$$\na_x(x_i,\\sigma_j) = -\\frac{1}{\\rho(x_i,\\sigma_j)} \\frac{p(x_{i+1},\\sigma_j) - p(x_{i-1},\\sigma_j)}{2\\Delta x}\n$$\nUsing the Ideal Gas Law, $p = \\rho R T_0$, we can express the density as $\\rho = p / (R T_0)$. Substituting this into the expression for $a_x$ yields:\n$$\na_x(x_i,\\sigma_j) = -\\frac{R T_0}{p(x_i,\\sigma_j)} \\frac{p(x_{i+1},\\sigma_j) - p(x_{i-1},\\sigma_j)}{2\\Delta x}\n$$\nThe finite-difference term is a second-order approximation for the partial derivative of pressure with respect to $x$ at a constant $\\sigma$ level:\n$$\n\\frac{p(x_{i+1},\\sigma_j) - p(x_{i-1},\\sigma_j)}{2\\Delta x} \\approx \\left(\\frac{\\partial p}{\\partial x}\\right)_{\\sigma}\n$$\nThe physical PGF, however, is defined by the pressure gradient on a surface of constant geometric height $z$, not constant $\\sigma$. The true horizontal PGF acceleration is $-\\frac{1}{\\rho} (\\frac{\\partial p}{\\partial x})_z$. For the given state of rest, $(\\frac{\\partial p}{\\partial x})_z = 0$. The error arises because the finite difference is taken along a sloping $\\sigma$-surface. We can relate the derivative along $\\sigma$ to the derivatives in the $(x,z)$ coordinate system using the chain rule:\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)_{\\sigma} = \\left(\\frac{\\partial p}{\\partial x}\\right)_{z} + \\left(\\frac{\\partial p}{\\partial z}\\right)_{x} \\left(\\frac{\\partial z}{\\partial x}\\right)_{\\sigma}\n$$\nFrom the problem statement, we have the following relations:\n1.  Atmosphere at rest, so horizontal pressure gradient on a constant height surface is zero: $\\left(\\frac{\\partial p}{\\partial x}\\right)_{z} = 0$.\n2.  Hydrostatic balance: $\\frac{\\partial p}{\\partial z} = -\\rho g$.\n3.  The coordinate transformation $z(x,\\sigma) = z_s(x) + \\sigma H_{\\mathrm{top}}$ with $z_s(x)=\\epsilon x$ gives the slope of the $\\sigma$-surface: $\\left(\\frac{\\partial z}{\\partial x}\\right)_{\\sigma} = \\frac{\\mathrm{d}z_s}{\\mathrm{d}x} = \\epsilon$.\n\nSubstituting these into the chain rule expression gives:\n$$\n\\left(\\frac{\\partial p}{\\partial x}\\right)_{\\sigma} = 0 + (-\\rho g)(\\epsilon) = -\\rho g \\epsilon\n$$\nTherefore, the discretized acceleration $a_x$ approximates:\n$$\na_x \\approx -\\frac{1}{\\rho} \\left( -\\rho g \\epsilon \\right) = g\\epsilon\n$$\nThis reveals that the leading-order spurious acceleration is simply $g\\epsilon$.\n\nTo perform a more rigorous derivation as requested and find the next-order term, we use a Taylor expansion. The exact pressure is given by $p(x,\\sigma) = p_0 \\exp\\left(-\\frac{z(x,\\sigma)}{H}\\right)$. With $z(x,\\sigma) = \\epsilon x + \\sigma H_{\\mathrm{top}}$, this becomes:\n$$\np(x,\\sigma) = p_0 \\exp\\left(-\\frac{\\epsilon x + \\sigma H_{\\mathrm{top}}}{H}\\right) = p_0 \\exp\\left(-\\frac{\\sigma H_{\\mathrm{top}}}{H}\\right) \\exp\\left(-\\frac{\\epsilon x}{H}\\right)\n$$\nLet's evaluate the pressure at points $x_{i+1} = x_i + \\Delta x$ and $x_{i-1} = x_i - \\Delta x$ at a fixed level $\\sigma_j$:\n$$\np(x_i \\pm \\Delta x, \\sigma_j) = p(x_i, \\sigma_j) \\exp\\left(\\mp \\frac{\\epsilon \\Delta x}{H}\\right)\n$$\nWe now expand the exponential term $\\exp(u)$ for small $u = \\mp \\frac{\\epsilon \\Delta x}{H}$, assuming the slope $\\epsilon$ is small:\n$$\n\\exp(u) = 1 + u + \\frac{u^2}{2!} + \\frac{u^3}{3!} + \\dots\n$$\nThis gives:\n$$\np(x_{i+1}, \\sigma_j) = p(x_i, \\sigma_j) \\left( 1 - \\frac{\\epsilon \\Delta x}{H} + \\frac{1}{2}\\left(\\frac{\\epsilon \\Delta x}{H}\\right)^2 - \\frac{1}{6}\\left(\\frac{\\epsilon \\Delta x}{H}\\right)^3 + \\mathcal{O}\\left((\\Delta x)^4\\right) \\right)\n$$\n$$\np(x_{i-1}, \\sigma_j) = p(x_i, \\sigma_j) \\left( 1 + \\frac{\\epsilon \\Delta x}{H} + \\frac{1}{2}\\left(\\frac{\\epsilon \\Delta x}{H}\\right)^2 + \\frac{1}{6}\\left(\\frac{\\epsilon \\Delta x}{H}\\right)^3 + \\mathcal{O}\\left((\\Delta x)^4\\right) \\right)\n$$\nThe pressure difference is:\n$$\np(x_{i+1}, \\sigma_j) - p(x_{i-1}, \\sigma_j) = p(x_i, \\sigma_j) \\left( -2\\frac{\\epsilon \\Delta x}{H} - \\frac{1}{3}\\left(\\frac{\\epsilon \\Delta x}{H}\\right)^3 + \\dots \\right)\n$$\nSubstituting this back into the formula for $a_x(x_i, \\sigma_j)$:\n$$\na_x = -\\frac{R T_0}{p(x_i, \\sigma_j)} \\frac{p(x_i, \\sigma_j) \\left( -2\\frac{\\epsilon \\Delta x}{H} - \\frac{1}{3}\\left(\\frac{\\epsilon \\Delta x}{H}\\right)^3 + \\dots \\right)}{2\\Delta x}\n$$\nThe term $p(x_i, \\sigma_j)$ cancels out.\n$$\na_x = \\frac{R T_0}{2\\Delta x} \\left( 2\\frac{\\epsilon \\Delta x}{H} + \\frac{1}{3}\\left(\\frac{\\epsilon \\Delta x}{H}\\right)^3 + \\dots \\right) = \\frac{R T_0 \\epsilon}{H} \\left( 1 + \\frac{1}{6}\\left(\\frac{\\epsilon \\Delta x}{H}\\right)^2 + \\dots \\right)\n$$\nRecalling the definition of the scale height, $H = \\frac{R T_0}{g}$, we find the final expression for the spurious acceleration:\n$$\na_x = g\\epsilon \\left( 1 + \\frac{1}{6}\\left(\\frac{\\epsilon \\Delta x}{H}\\right)^2 + \\dots \\right)\n$$\nThe leading-order expression for the spurious acceleration is $a_x \\approx g\\epsilon$. This term is independent of the grid spacing $\\Delta x$.\n\nThe leading-order term $g\\epsilon$ is independent of $\\sigma_j$ (and also of $x_i$) because the local pressure $p(x_i, \\sigma_j)$ appears as a multiplicative factor in both the numerator (the pressure difference) and the denominator (the density $\\rho(x_i, \\sigma_j) = p(x_i, \\sigma_j) / (R T_0)$). This factor cancels out completely, leaving an expression that depends only on fundamental constants ($g$) and the terrain slope ($\\epsilon$).\n\nThe next-order term in the expansion is $g\\epsilon \\cdot \\frac{1}{6}\\left(\\frac{\\epsilon \\Delta x}{H}\\right)^2 = \\frac{g}{6H^2}\\epsilon^3 \\Delta x^2$. This is the leading truncation error term of the finite difference scheme for this specific pressure field. The scaling of this next-order term is $\\mathcal{O}(\\epsilon^3 \\Delta x^2)$. It depends on both the slope $\\epsilon$ and the grid spacing $\\Delta x$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the spurious horizontal acceleration for a set of test cases\n    using a non-consistent discretization of the Pressure Gradient Force on\n    a terrain-following coordinate system.\n    \"\"\"\n    # Physical and numerical parameters\n    g = 9.81  # m/s^2\n    R = 287.0  # J/(kg.K)\n    T0 = 300.0  # K\n    p0 = 100000.0  # Pa\n    H_top = 9000.0  # m\n    L = 10000.0  # m\n    \n    # Vertical coordinate for evaluation\n    sigma = 0.5\n    \n    # Derived physical constant: scale height\n    H = (R * T0) / g\n\n    # Test cases: (epsilon, delta_x)\n    test_cases = [\n        (0.01, 1000.0),   # Test 1 (happy path)\n        (0.01, 250.0),    # Test 2 (refined grid)\n        (0.001, 1000.0),  # Test 3 (small slope)\n        (0.1, 1000.0),    # Test 4 (larger slope)\n        (0.0, 1000.0)     # Test 5 (boundary case, zero slope)\n    ]\n\n    results = []\n    \n    # Helper functions for clarity\n    def get_z(x, sigma_val, epsilon, h_top_val):\n        \"\"\"Calculates physical height z.\"\"\"\n        z_s = epsilon * x\n        return z_s + sigma_val * h_top_val\n\n    def get_p(x, sigma_val, epsilon, h_top_val, p0_val, h_val):\n        \"\"\"Calculates hydrostatic pressure p.\"\"\"\n        z = get_z(x, sigma_val, epsilon, h_top_val)\n        return p0_val * np.exp(-z / h_val)\n\n    for epsilon, delta_x in test_cases:\n        # Set up the horizontal grid\n        # Nx: Number of grid points\n        # i_mid: Index for the central grid point\n        Nx = int(L / delta_x) + 1\n        i_mid = Nx // 2\n        \n        # Coordinates of the central point and its neighbors\n        x_mid = i_mid * delta_x\n        x_prev = (i_mid - 1) * delta_x\n        x_next = (i_mid + 1) * delta_x\n        \n        # Calculate pressure at the three required grid points on the constant sigma level\n        p_mid = get_p(x_mid, sigma, epsilon, H_top, p0, H)\n        p_prev = get_p(x_prev, sigma, epsilon, H_top, p0, H)\n        p_next = get_p(x_next, sigma, epsilon, H_top, p0, H)\n        \n        # Calculate density at the central point using the Ideal Gas Law\n        rho_mid = p_mid / (R * T0)\n        \n        # Calculate the spurious horizontal acceleration using the finite-difference formula\n        # a_x = -(1/rho) * (p(i+1) - p(i-1)) / (2*dx)\n        if rho_mid == 0:\n            # Avoid division by zero, though unlikely with these parameters\n            a_x = 0.0\n        else:\n            a_x = - (1.0 / rho_mid) * (p_next - p_prev) / (2.0 * delta_x)\n            \n        # Round the result to six decimal places and append to the list\n        results.append(round(a_x, 6))\n\n    # Format the final output as a comma-separated list in brackets\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "The accuracy of a numerical simulation depends not only on the chosen finite-difference formulas but also on the arrangement of variables on the computational grid. Different grid arrangements, such as collocated and staggered grids, have vastly different properties for representing waves and sharp gradients. This exercise  provides a direct comparison, demonstrating how a staggered Arakawa C-grid can accurately represent a sharp pressure jump while a collocated grid generates significant spurious oscillations, highlighting a key design choice in fluid dynamics models.",
            "id": "4078241",
            "problem": "Consider the one-dimensional horizontal momentum equation for a dry atmosphere in the absence of Coriolis and viscosity, given by $ \\frac{\\partial u}{\\partial t} = -\\frac{1}{\\rho} \\frac{\\partial p}{\\partial x} $, where $ u $ is velocity in $ \\mathrm{m/s} $, $ \\rho $ is density in $ \\mathrm{kg/m^3} $, and $ p $ is pressure in $ \\mathrm{Pa} $. The Pressure Gradient Force (PGF) is the acceleration field $ -\\frac{1}{\\rho} \\frac{\\partial p}{\\partial x} $ in $ \\mathrm{m/s^2} $. In numerical weather prediction, there are multiple ways to discretize the PGF depending on the arrangement of variables on the computational grid. Two common arrangements are:\n\n- A collocated grid, where both pressure and velocity are stored at cell centers.\n- A staggered Arakawa C-grid, where pressure is stored at cell centers and velocity is stored at cell faces.\n\nYou will compare the numerical error incurred when computing the PGF in a collocated grid versus a staggered C-grid for a simple pressure field that has a single jump located exactly at a cell face. Use the following framework:\n\n- The computational domain is periodic, one-dimensional, and of length $ L $, partitioned into $ N $ uniform cells of size $ \\Delta x = L/N $.\n- Pressure $ p_i $ is defined at cell centers indexed by $ i = 0, 1, \\dots, N-1 $.\n- The pressure field is piecewise constant with a single discontinuity at face $ i_0 + \\tfrac{1}{2} $. Specifically, set $ p_i = p_{\\mathrm{L}} $ for $ i \\le i_0 $ and $ p_i = p_{\\mathrm{R}} $ for $ i > i_0 $. The domain uses periodic indexing.\n- Density $ \\rho $ is constant.\n\nDefine the following discrete PGF fields:\n\n1. A reference face-based PGF field based on a control-volume argument consistent with the staggered C-grid placement. Interpret it as the physically consistent acceleration of a face-centered velocity: the face PGF at face $ i+\\tfrac{1}{2} $ is obtained from the pressure difference between neighboring cell centers divided by $ \\Delta x $, scaled by $ -\\frac{1}{\\rho} $.\n\n2. A collocated-grid PGF computed at cell centers via a centered finite difference approximation of the pressure gradient. Since momentum fluxes are evaluated at faces in a finite-volume sense, construct a face PGF from the collocated center PGF by a second-order accurate linear interpolation from adjacent centers to the face.\n\nQuantify the error of each scheme against the reference face PGF using two metrics:\n- The root-mean-square error (RMSE) over faces, defined as $ \\sqrt{\\frac{1}{N} \\sum_{i=0}^{N-1} \\left(a^{\\mathrm{approx}}_{i+\\frac{1}{2}} - a^{\\mathrm{ref}}_{i+\\frac{1}{2}}\\right)^2 } $, expressed in $ \\mathrm{m/s^2} $.\n- The maximum absolute error over faces, defined as $ \\max_{i} \\left| a^{\\mathrm{approx}}_{i+\\frac{1}{2}} - a^{\\mathrm{ref}}_{i+\\frac{1}{2}} \\right| $, expressed in $ \\mathrm{m/s^2} $.\n\nImplement a program that, for each test case below, constructs the pressure field, computes:\n- the reference face PGF,\n- the staggered C-grid PGF (which is the same computation as the reference),\n- the collocated-grid center PGF and its interpolated face PGF,\nand then evaluates the RMSE and maximum absolute error for both the collocated and staggered schemes relative to the reference face PGF.\n\nUse the following test suite (all quantities in SI units):\n\n- Test case 1 (happy path): $ N = 10 $, $ L = 1000\\,\\mathrm{m} $, $ \\rho = 1.2\\,\\mathrm{kg/m^3} $, $ p_{\\mathrm{L}} = 100000\\,\\mathrm{Pa} $, $ p_{\\mathrm{R}} = 100010\\,\\mathrm{Pa} $, $ i_0 = 4 $.\n- Test case 2 (zero-jump edge case): $ N = 10 $, $ L = 1000\\,\\mathrm{m} $, $ \\rho = 1.2\\,\\mathrm{kg/m^3} $, $ p_{\\mathrm{L}} = 100000\\,\\mathrm{Pa} $, $ p_{\\mathrm{R}} = 100000\\,\\mathrm{Pa} $, $ i_0 = 4 $.\n- Test case 3 (minimal grid): $ N = 2 $, $ L = 2\\,\\mathrm{m} $, $ \\rho = 1.0\\,\\mathrm{kg/m^3} $, $ p_{\\mathrm{L}} = 100000\\,\\mathrm{Pa} $, $ p_{\\mathrm{R}} = 100200\\,\\mathrm{Pa} $, $ i_0 = 0 $.\n- Test case 4 (larger jump and grid): $ N = 50 $, $ L = 5000\\,\\mathrm{m} $, $ \\rho = 1.0\\,\\mathrm{kg/m^3} $, $ p_{\\mathrm{L}} = 101000\\,\\mathrm{Pa} $, $ p_{\\mathrm{R}} = 100900\\,\\mathrm{Pa} $, $ i_0 = 24 $.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a sub-list of four floats $ [\\mathrm{RMSE}_{\\mathrm{collocated}}, \\mathrm{RMSE}_{\\mathrm{staggered}}, \\mathrm{MaxErr}_{\\mathrm{collocated}}, \\mathrm{MaxErr}_{\\mathrm{staggered}}] $, all expressed in $ \\mathrm{m/s^2} $. For example, the output format is $ [[x_1,x_2,x_3,x_4],[y_1,y_2,y_3,y_4],\\dots] $ with no spaces.",
            "solution": "## Problem Validation\n\n### Step 1: Extract Givens\n\n**Governing Equation:**\n$ \\frac{\\partial u}{\\partial t} = -\\frac{1}{\\rho} \\frac{\\partial p}{\\partial x} $\nwhere $u$ is velocity, $\\rho$ is density, and $p$ is pressure.\n\n**Pressure Gradient Force (PGF):**\n$ \\mathrm{PGF} = -\\frac{1}{\\rho} \\frac{\\partial p}{\\partial x} $\n\n**Computational Domain:**\n- One-dimensional, periodic, length $L$.\n- Partitioned into $N$ uniform cells of size $\\Delta x = L/N$.\n- Pressure $p_i$ is defined at cell centers, indexed by $i = 0, 1, \\dots, N-1$.\n\n**Pressure Field:**\n- Piecewise constant with a single discontinuity at face $i_0 + \\tfrac{1}{2}$.\n- $p_i = p_{\\mathrm{L}}$ for $i \\le i_0$.\n- $p_i = p_{\\mathrm{R}}$ for $i > i_0$.\n- Domain uses periodic indexing.\n\n**Density:**\n- $\\rho$ is constant.\n\n**Discrete PGF Definitions:**\n1.  **Reference Face PGF ($a^{\\mathrm{ref}}$):** Defined at face $i+\\tfrac{1}{2}$.\n    $ a^{\\mathrm{ref}}_{i+\\frac{1}{2}} = -\\frac{1}{\\rho} \\frac{p_{i+1} - p_i}{\\Delta x} $\n2.  **Staggered C-Grid Face PGF ($a^{\\mathrm{stag}}$):** The computation is identical to the reference PGF.\n    $ a^{\\mathrm{stag}}_{i+\\frac{1}{2}} = a^{\\mathrm{ref}}_{i+\\frac{1}{2}} $\n3.  **Collocated Grid Face PGF ($a^{\\mathrm{colloc}}$):**\n    - First, a center PGF is computed at cell center $i$ using a centered finite difference:\n      $ a^{\\mathrm{center}}_i = -\\frac{1}{\\rho} \\frac{p_{i+1} - p_{i-1}}{2\\Delta x} $\n    - Second, the center PGF is interpolated to the face $i+\\tfrac{1}{2}$ using linear interpolation:\n      $ a^{\\mathrm{approx}}_{i+\\frac{1}{2}} = \\frac{a^{\\mathrm{center}}_i + a^{\\mathrm{center}}_{i+1}}{2} $\n\n**Error Metrics:**\n- Root-Mean-Square Error (RMSE): $ \\sqrt{\\frac{1}{N} \\sum_{i=0}^{N-1} \\left(a^{\\mathrm{approx}}_{i+\\frac{1}{2}} - a^{\\mathrm{ref}}_{i+\\frac{1}{2}}\\right)^2 } $\n- Maximum Absolute Error: $ \\max_{i} \\left| a^{\\mathrm{approx}}_{i+\\frac{1}{2}} - a^{\\mathrm{ref}}_{i+\\frac{1}{2}} \\right| $\n\n**Test Cases (all in SI units):**\n- **Case 1:** $ N = 10 $, $ L = 1000 $, $ \\rho = 1.2 $, $ p_{\\mathrm{L}} = 100000 $, $ p_{\\mathrm{R}} = 100010 $, $ i_0 = 4 $.\n- **Case 2:** $ N = 10 $, $ L = 1000 $, $ \\rho = 1.2 $, $ p_{\\mathrm{L}} = 100000 $, $ p_{\\mathrm{R}} = 100000 $, $ i_0 = 4 $.\n- **Case 3:** $ N = 2 $, $ L = 2 $, $ \\rho = 1.0 $, $ p_{\\mathrm{L}} = 100000 $, $ p_{\\mathrm{R}} = 100200 $, $ i_0 = 0 $.\n- **Case 4:** $ N = 50 $, $ L = 5000 $, $ \\rho = 1.0 $, $ p_{\\mathrm{L}} = 101000 $, $ p_{\\mathrm{R}} = 100900 $, $ i_0 = 24 $.\n\n**Output Format:**\nA list of lists, e.g., $ [[x_1,x_2,x_3,x_4],[y_1,y_2,y_3,y_4],\\dots] $, where each sub-list is $ [\\mathrm{RMSE}_{\\mathrm{collocated}}, \\mathrm{RMSE}_{\\mathrm{staggered}}, \\mathrm{MaxErr}_{\\mathrm{collocated}}, \\mathrm{MaxErr}_{\\mathrm{staggered}}] $.\n\n### Step 2: Validate Using Extracted Givens\n\n- **Scientifically Grounded:** The problem is firmly rooted in the field of computational fluid dynamics, specifically numerical methods for geophysical fluid dynamics. The one-dimensional momentum equation is a standard simplification. The concepts of collocated and staggered grids (specifically the Arakawa C-grid) are fundamental to the design of numerical models for weather and climate. The PGF discretization error, especially for non-smooth fields, is a classic and important topic. The problem setup is physically and mathematically sound.\n- **Well-Posed:** The problem is fully specified. All necessary parameters ($L, N, \\rho, p_{\\mathrm{L}}, p_{\\mathrm{R}}, i_0$) are given for each case. The discretization formulas for both schemes are explicitly defined. The error metrics are standard and unambiguous. The problem asks for a direct numerical calculation which has a unique solution.\n- **Objective:** The problem statement is expressed in precise, technical language common to physics and numerical analysis. There are no subjective, ambiguous, or opinion-based statements.\n\nThe problem does not exhibit any of the invalidity flaws. It is a standard, well-posed numerical experiment designed to compare the properties of two common finite difference schemes.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full solution will be provided.\n\n## Solution\n\nThe objective is to quantify the numerical error of two different spatial discretization schemes for the Pressure Gradient Force (PGF) term, $-\\frac{1}{\\rho} \\frac{\\partial p}{\\partial x}$, in a one-dimensional periodic domain. The schemes correspond to a collocated grid and a staggered Arakawa C-grid. We are given a piecewise-constant pressure field with a single discontinuity.\n\nLet the domain be of length $L$, discretized into $N$ cells of width $\\Delta x = L/N$. The cell centers are indexed by $i = 0, \\dots, N-1$. The pressure $p_i$ is defined at cell centers. The pressure field is given by $p_i = p_{\\mathrm{L}}$ for $i \\le i_0$ and $p_i = p_{\\mathrm{R}}$ for $i > i_0$, with periodic indexing. The faces separating the cells are indexed by $i+\\frac{1}{2}$. The density, $\\rho$, is constant.\n\n### 1. Reference and Staggered C-Grid PGF\n\nThe problem defines a reference PGF at the faces, $a^{\\mathrm{ref}}_{i+\\frac{1}{2}}$, based on a finite volume approach consistent with a staggered grid where velocity would be located. This is a centered difference of pressure evaluated at the face $i+\\frac{1}{2}$, which uses the pressure values from the two adjacent cell centers, $i$ and $i+1$.\n$$\na^{\\mathrm{ref}}_{i+\\frac{1}{2}} = -\\frac{1}{\\rho} \\frac{p_{i+1} - p_i}{\\Delta x}\n$$\nThe periodic nature of the domain implies that indices are taken modulo $N$. For instance, for the face at the right boundary of the domain, $(N-1)+\\frac{1}{2}$, the pressure difference is $p_{(N-1)+1} - p_{N-1} = p_0 - p_{N-1}$.\n\nThe problem states that the staggered C-grid PGF, $a^{\\mathrm{stag}}$, is computed identically to the reference PGF.\n$$\na^{\\mathrm{stag}}_{i+\\frac{1}{2}} = a^{\\mathrm{ref}}_{i+\\frac{1}{2}}\n$$\nThis is a key aspect of the problem design. The staggered C-grid places velocities at faces and pressures at centers, making the above formula the natural way to compute the acceleration on the velocity component. By defining the reference solution in this manner, the problem implicitly establishes the staggered scheme as the \"correct\" or ideal one for this particular variable arrangement and physical interpretation. Consequently, the error for the staggered scheme is, by definition, identically zero.\n$$\n\\mathrm{RMSE}_{\\mathrm{staggered}} = \\sqrt{\\frac{1}{N} \\sum_{i=0}^{N-1} \\left(a^{\\mathrm{stag}}_{i+\\frac{1}{2}} - a^{\\mathrm{ref}}_{i+\\frac{1}{2}}\\right)^2} = 0\n$$\n$$\n\\mathrm{MaxErr}_{\\mathrm{staggered}} = \\max_{i} \\left| a^{\\mathrm{stag}}_{i+\\frac{1}{2}} - a^{\\mathrm{ref}}_{i+\\frac{1}{2}} \\right| = 0\n$$\n\n### 2. Collocated Grid PGF\n\nOn a collocated grid, all variables, including pressure $p$ and velocity $u$, are defined at the same location, the cell center $i$. The PGF is also first computed at the cell center.\n\n**Step A: PGF at Cell Centers**\nA second-order accurate centered finite difference approximation for the pressure gradient $\\frac{\\partial p}{\\partial x}$ at cell center $i$ uses the pressure values at the neighboring centers, $i-1$ and $i+1$.\n$$\na^{\\mathrm{center}}_i = -\\frac{1}{\\rho} \\left( \\frac{p_{i+1} - p_{i-1}}{2\\Delta x} \\right)\n$$\nAgain, periodic indexing must be used for $i=0$ (where $i-1$ corresponds to $N-1$) and $i=N-1$ (where $i+1$ corresponds to $0$).\n\n**Step B: Interpolation to Cell Faces**\nTo compare with the face-based reference PGF, this cell-center PGF must be evaluated at the faces. The problem specifies a second-order accurate linear interpolation. The PGF at face $i+\\frac{1}{2}$ is the arithmetic mean of the PGFs at the adjacent centers, $i$ and $i+1$.\n$$\na^{\\mathrm{colloc}}_{i+\\frac{1}{2}} = \\frac{a^{\\mathrm{center}}_i + a^{\\mathrm{center}}_{i+1}}{2}\n$$\nThis process of differentiation followed by averaging is a common approach on collocated grids. However, it is known to have poor properties, especially for high-wavenumber features in the field. The provided pressure jump function is rich in such features. The centered difference operator for $a^{\\mathrm{center}}_i$ is completely blind to any component of the pressure field with a wavelength of $2\\Delta x$, as $p_{i+1}-p_{i-1}$ would be zero for such a mode. This leads to spurious oscillations, as the calculation will demonstrate.\n\n### 3. Error Calculation for the Collocated Scheme\n\nThe error of the collocated scheme is calculated by comparing its face PGF, $a^{\\mathrm{colloc}}_{i+\\frac{1}{2}}$, to the reference PGF, $a^{\\mathrm{ref}}_{i+\\frac{1}{2}}$.\nThe error at each face is $E_{i+\\frac{1}{2}} = a^{\\mathrm{colloc}}_{i+\\frac{1}{2}} - a^{\\mathrm{ref}}_{i+\\frac{1}{2}}$.\n\nThe required error metrics are then:\n$$\n\\mathrm{RMSE}_{\\mathrm{collocated}} = \\sqrt{\\frac{1}{N} \\sum_{i=0}^{N-1} \\left( E_{i+\\frac{1}{2}} \\right)^2}\n$$\n$$\n\\mathrm{MaxErr}_{\\mathrm{collocated}} = \\max_{i=0, \\dots, N-1} \\left| E_{i+\\frac{1}{2}} \\right|\n$$\n\n### 4. Implementation Algorithm\nFor each test case, the following steps are executed:\n1.  Initialize parameters: $N, L, \\rho, p_{\\mathrm{L}}, p_{\\mathrm{R}}, i_0$.\n2.  Calculate grid spacing $\\Delta x = L/N$.\n3.  Construct the cell-centered pressure array $p$ of size $N$, where $p_i=p_{\\mathrm{L}}$ for $i \\leq i_0$ and $p_i=p_{\\mathrm{R}}$ for $i > i_0$.\n4.  Calculate the reference face PGF array $a^{\\mathrm{ref}}$ of size $N$. This involves computing $p_{i+1} - p_i$ for all $i$, which can be done efficiently using a rolled version of the pressure array for $p_{i+1}$.\n5.  Set the staggered scheme errors, $\\mathrm{RMSE}_{\\mathrm{staggered}}$ and $\\mathrm{MaxErr}_{\\mathrm{staggered}}$, to $0$.\n6.  Calculate the collocated cell-center PGF array $a^{\\mathrm{center}}$ of size $N$. This requires computing $p_{i+1} - p_{i-1}$ for all $i$, which can be done using two rolled versions of the pressure array.\n7.  Calculate the collocated face PGF array $a^{\\mathrm{colloc}}$ of size $N$ by averaging adjacent elements of $a^{\\mathrm{center}}$.\n8.  Compute the error array $E = a^{\\mathrm{colloc}} - a^{\\mathrm{ref}}$.\n9.  Calculate $\\mathrm{RMSE}_{\\mathrm{collocated}}$ and $\\mathrm{MaxErr}_{\\mathrm{collocated}}$ from the error array $E$.\n10. Store the four resulting error metrics for the current test case.\n11. After processing all test cases, format the collected results into the specified string format.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes PGF errors for collocated and staggered grids for given test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, L, rho, p_L, p_R, i_0)\n        (10, 1000.0, 1.2, 100000.0, 100010.0, 4),\n        (10, 1000.0, 1.2, 100000.0, 100000.0, 4),\n        (2, 2.0, 1.0, 100000.0, 100200.0, 0),\n        (50, 5000.0, 1.0, 101000.0, 100900.0, 24),\n    ]\n\n    all_results = []\n    for case in test_cases:\n        N, L, rho, p_L, p_R, i_0 = case\n        \n        # 1. Setup Grid and Pressure Field\n        dx = L / N\n        indices = np.arange(N)\n        p = np.where(indices = i_0, p_L, p_R)\n\n        # 2. Compute Reference and Staggered C-Grid PGF (at faces i+1/2)\n        # The staggered grid PGF is defined to be the same as the reference.\n        # p_ip1 corresponds to p_{i+1} for each index i.\n        p_ip1 = np.roll(p, -1)\n        a_ref = -1.0 / rho * (p_ip1 - p) / dx\n        a_stag = a_ref\n        \n        # Errors for the staggered scheme are zero by definition.\n        rmse_stag = 0.0\n        max_err_stag = 0.0\n\n        # 3. Compute Collocated Grid PGF\n        # Step A: Compute PGF at cell centers (i)\n        # p_im1 corresponds to p_{i-1} for each index i.\n        p_im1 = np.roll(p, 1)\n        a_center = -1.0 / rho * (p_ip1 - p_im1) / (2.0 * dx)\n\n        # Step B: Interpolate to faces (i+1/2)\n        # a_center_ip1 corresponds to a_center_{i+1} for each index i.\n        a_center_ip1 = np.roll(a_center, -1)\n        a_colloc = (a_center + a_center_ip1) / 2.0\n\n        # 4. Calculate Errors for the Collocated Scheme\n        error = a_colloc - a_ref\n        \n        # RMSE\n        # np.mean(error**2) is (1/N) * sum(error_i^2)\n        rmse_colloc = np.sqrt(np.mean(error**2))\n        \n        # Max Absolute Error\n        max_err_colloc = np.max(np.abs(error))\n\n        # Store results for this case\n        case_results = [\n            rmse_colloc,\n            rmse_stag,\n            max_err_colloc,\n            max_err_stag\n        ]\n        all_results.append(case_results)\n\n    # Format the final output string\n    # e.g., [[x1,x2,x3,x4],[y1,y2,y3,y4]]\n    result_str = \",\".join([\n        f\"[{','.join(map(str, res))}]\" for res in all_results\n    ])\n    \n    # Final print statement in the exact required format.\n    print(f\"[{result_str}]\")\n\nsolve()\n```"
        }
    ]
}