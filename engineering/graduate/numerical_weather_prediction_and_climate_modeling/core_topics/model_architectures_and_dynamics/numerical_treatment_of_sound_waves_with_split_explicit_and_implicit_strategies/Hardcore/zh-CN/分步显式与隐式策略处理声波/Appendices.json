{
    "hands_on_practices": [
        {
            "introduction": "本章的第一个练习将指导你完成一次经典的冯·诺伊曼稳定性分析。通过推导Crank-Nicolson格式的离散色散关系，你将亲身体验数值方法如何改变波的相速度，并理解为什么这种分析是评估格式性能的基石。这个练习的核心在于量化数值相速度误差，这是理解和预测模型行为的关键一步。",
            "id": "4070181",
            "problem": "考虑在背景密度为常数 $\\,\\rho_{0}\\,$、声速为 $\\,c\\,$ 的可压缩流体中，围绕静止状态线性化的一维小振幅声波。以原始变量速度 $\\,u(x,t)\\,$ 和压力扰动 $\\,p(x,t)\\,$ 表示的连续线性化方程为\n$$\n\\partial_{t} u + \\frac{1}{\\rho_{0}} \\partial_{x} p \\;=\\; 0, \n\\qquad\n\\partial_{t} p + \\rho_{0} c^{2} \\partial_{x} u \\;=\\; 0,\n$$\n这些方程支持相速度为 $\\,c\\,$ 的右行和左行声波。在用于处理快速声波模态的数值天气预报中，一种典型的显式-隐式分裂策略是，假设上述声学子系统使用 Crank-Nicolson (CN) 方法进行时间推进，而空间则在间距为 $\\,\\Delta x\\,$ 的均匀网格上通过二阶中心差分进行离散化。具体来说，令 $\\,x_{j} = j \\Delta x\\,$, $\\,t^{n} = n \\Delta t\\,$，并将网格函数表示为 $\\,u_{j}^{n}\\,$ 和 $\\,p_{j}^{n}\\,$。定义中心差分算子\n$$\nD_{0} \\phi_{j} \\;=\\; \\frac{\\phi_{j+1} - \\phi_{j-1}}{2 \\Delta x}.\n$$\n声学子系统的 Crank-Nicolson 半隐式时间步进格式为\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} + \\frac{1}{2 \\rho_{0}} \\left( D_{0} p_{j}^{n+1} + D_{0} p_{j}^{n} \\right) \\;=\\; 0,\n\\qquad\n\\frac{p_{j}^{n+1} - p_{j}^{n}}{\\Delta t} + \\frac{\\rho_{0} c^{2}}{2} \\left( D_{0} u_{j}^{n+1} + D_{0} u_{j}^{n} \\right) \\;=\\; 0.\n$$\n假设离散平面波解的形式为\n$$\nu_{j}^{n} \\;=\\; U \\,\\lambda^{n} \\exp\\left( i j \\kappa \\right), \n\\qquad\np_{j}^{n} \\;=\\; P \\,\\lambda^{n} \\exp\\left( i j \\kappa \\right),\n$$\n其中 $\\,\\kappa = k \\Delta x\\,$ 是无量纲波数，$\\,\\lambda = \\exp(-i \\Omega)\\,$ 是单步放大因子，其无量纲频率为 $\\,\\Omega = \\omega \\Delta t\\,$，且 $\\,i = \\sqrt{-1}\\,$。定义声学 Courant 数 $\\,\\alpha = \\frac{c \\Delta t}{\\Delta x}\\,$。\n\n基于此 Crank-Nicolson 和二阶中心差分格式，从第一性原理推导与右行声学分支相关的离散色散关系 $\\,\\Omega(\\kappa,\\alpha)\\,$。然后，利用此结果，定性分析对于固定的 $\\,\\alpha\\,$，数值相速度误差 $\\,c_{\\text{num}}/c - 1\\,$ 如何随无量纲波数 $\\,\\kappa\\,$ 变化。\n\n作为最终答案，请提供与右行分支对应的 $\\,\\Omega(\\kappa,\\alpha)\\,$ 的单个封闭形式解析表达式。无需进行数值计算，并且由于 $\\,\\Omega\\,$ 和 $\\,\\kappa\\,$ 是无量纲的，最终表达式无需报告单位。",
            "solution": "用户提供了一个问题，要求针对应用于线性化声波方程的特定数值格式，推导并分析其离散色散关系。\n\n### 步骤 1：问题验证\n\n首先，提取并列出问题陈述中的已知条件。\n\n*   **连续线性化方程：**\n    $$\n    \\partial_{t} u + \\frac{1}{\\rho_{0}} \\partial_{x} p = 0\n    $$\n    $$\n    \\partial_{t} p + \\rho_{0} c^{2} \\partial_{x} u = 0\n    $$\n*   **常数：** 背景密度 $\\rho_{0}$，声速 $c$。\n*   **离散网格与函数：** $x_{j} = j \\Delta x$, $t^{n} = n \\Delta t$, $u_{j}^{n}$, $p_{j}^{n}$。\n*   **差分算子：** $D_{0} \\phi_{j} = \\frac{\\phi_{j+1} - \\phi_{j-1}}{2 \\Delta x}$。\n*   **Crank–Nicolson 半隐式格式：**\n    $$\n    \\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} + \\frac{1}{2 \\rho_{0}} \\left( D_{0} p_{j}^{n+1} + D_{0} p_{j}^{n} \\right) = 0\n    $$\n    $$\n    \\frac{p_{j}^{n+1} - p_{j}^{n}}{\\Delta t} + \\frac{\\rho_{0} c^{2}}{2} \\left( D_{0} u_{j}^{n+1} + D_{0} u_{j}^{n} \\right) = 0\n    $$\n*   **平面波 ansatz：** $u_{j}^{n} = U \\lambda^{n} \\exp(i j \\kappa)$ 和 $p_{j}^{n} = P \\lambda^{n} \\exp(i j \\kappa)$。\n*   **定义：** 无量纲波数 $\\kappa = k \\Delta x$，放大因子 $\\lambda = \\exp(-i \\Omega)$，无量纲频率 $\\Omega = \\omega \\Delta t$，以及声学 Courant 数 $\\alpha = \\frac{c \\Delta t}{\\Delta x}$。\n*   **要求任务：** 推导右行分支的色散关系 $\\Omega(\\kappa, \\alpha)$，并定性分析数值相速度误差。\n\n对问题进行验证：\n1.  **科学依据：**该问题基于声学的基本方程和一个标准的、广泛使用的数值方法（Crank-Nicolson 结合中心差分）。所用的分析技术（von Neumann 分析）是数值偏微分方程分析的基石。该问题在科学上是合理的。\n2.  **适定性：**该问题是适定的。它要求推导一个特定数值格式的色散关系，这可以通过标准程序唯一确定。\n3.  **客观性：**语言正式、精确且客观。所有术语都有明确定义。\n4.  **完整性与一致性：**该问题是自洽的，提供了所有必要的信息，没有矛盾之处。\n\n该问题通过了所有验证标准，被认为是**有效的**。可以开始求解过程。\n\n### 步骤 2：离散色散关系的推导\n\n推导过程首先将平面波 ansatz 代入离散方程。首先，我们计算中心差分算子 $D_{0}$ 作用于 ansatz 的空间部分 $\\exp(i j \\kappa)$ 的结果。\n$$\nD_{0} \\exp(i j \\kappa) = \\frac{\\exp(i (j+1) \\kappa) - \\exp(i (j-1) \\kappa)}{2 \\Delta x}\n$$\n提出因子 $\\exp(i j \\kappa)$：\n$$\nD_{0} \\exp(i j \\kappa) = \\frac{\\exp(i j \\kappa) (\\exp(i \\kappa) - \\exp(-i \\kappa))}{2 \\Delta x}\n$$\n使用欧拉公式 $\\exp(i \\theta) - \\exp(-i \\theta) = 2i \\sin(\\theta)$，我们得到：\n$$\nD_{0} \\exp(i j \\kappa) = \\frac{\\exp(i j \\kappa) (2i \\sin(\\kappa))}{2 \\Delta x} = \\frac{i \\sin(\\kappa)}{\\Delta x} \\exp(i j \\kappa)\n$$\n现在，将完整的 ansatz $u_{j}^{n} = U \\lambda^{n} \\exp(i j \\kappa)$ 和 $p_{j}^{n} = P \\lambda^{n} \\exp(i j \\kappa)$ 代入两个离散方程。\n\n对于动量方程：\n$$\n\\frac{U \\lambda^{n+1} - U \\lambda^{n}}{\\Delta t} \\exp(i j \\kappa) + \\frac{1}{2 \\rho_{0}} \\left( P \\lambda^{n+1} D_{0} \\exp(i j \\kappa) + P \\lambda^{n} D_{0} \\exp(i j \\kappa) \\right) = 0\n$$\n除以公因子 $\\lambda^{n} \\exp(i j \\kappa)$ 并代入 $D_{0}$ 的表达式：\n$$\n\\frac{U (\\lambda - 1)}{\\Delta t} + \\frac{1}{2 \\rho_{0}} P (\\lambda + 1) \\left( \\frac{i \\sin(\\kappa)}{\\Delta x} \\right) = 0\n$$\n乘以 $\\Delta t$ 并整理，得到第一个代数方程：\n$$\n(\\lambda - 1) U + \\left( \\frac{i \\Delta t \\sin(\\kappa)}{2 \\rho_{0} \\Delta x} \\right) (\\lambda + 1) P = 0\n$$\n\n对于压力方程：\n$$\n\\frac{P \\lambda^{n+1} - P \\lambda^{n}}{\\Delta t} \\exp(i j \\kappa) + \\frac{\\rho_{0} c^{2}}{2} \\left( U \\lambda^{n+1} D_{0} \\exp(i j \\kappa) + U \\lambda^{n} D_{0} \\exp(i j \\kappa) \\right) = 0\n$$\n再次除以 $\\lambda^{n} \\exp(i j \\kappa)$ 并代入 $D_{0}$ 的表达式：\n$$\n\\frac{P (\\lambda - 1)}{\\Delta t} + \\frac{\\rho_{0} c^{2}}{2} U (\\lambda + 1) \\left( \\frac{i \\sin(\\kappa)}{\\Delta x} \\right) = 0\n$$\n乘以 $\\Delta t$ 并整理，得到第二个代数方程：\n$$\n\\left( \\frac{i \\rho_{0} c^{2} \\Delta t \\sin(\\kappa)}{2 \\Delta x} \\right) (\\lambda + 1) U + (\\lambda - 1) P = 0\n$$\n\n现在我们得到了关于振幅 $U$ 和 $P$ 的 $2 \\times 2$ 齐次线性系统：\n$$\n\\begin{pmatrix}\n\\lambda - 1  \\frac{i \\Delta t \\sin(\\kappa)}{2 \\rho_{0} \\Delta x} (\\lambda + 1) \\\\\n\\frac{i \\rho_{0} c^{2} \\Delta t \\sin(\\kappa)}{2 \\Delta x} (\\lambda + 1)  \\lambda - 1\n\\end{pmatrix}\n\\begin{pmatrix}\nU \\\\\nP\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\\n0\n\\end{pmatrix}\n$$\n为了得到非平凡解 $(U, P)$，系数矩阵的行列式必须为零。\n$$\n(\\lambda - 1)^{2} - \\left( \\frac{i \\rho_{0} c^{2} \\Delta t \\sin(\\kappa)}{2 \\Delta x} \\right) \\left( \\frac{i \\Delta t \\sin(\\kappa)}{2 \\rho_{0} \\Delta x} \\right) (\\lambda + 1)^{2} = 0\n$$\n简化表达式：\n$$\n(\\lambda - 1)^{2} - i^{2} \\left( \\frac{c^{2} \\Delta t^{2} \\sin^{2}(\\kappa)}{4 \\Delta x^{2}} \\right) (\\lambda + 1)^{2} = 0\n$$\n使用 $i^{2} = -1$ 和 Courant 数的定义 $\\alpha = \\frac{c \\Delta t}{\\Delta x}$：\n$$\n(\\lambda - 1)^{2} + \\alpha^{2} \\frac{\\sin^{2}(\\kappa)}{4} (\\lambda + 1)^{2} = 0\n$$\n整理并对两边取平方根：\n$$\n\\lambda - 1 = \\pm \\sqrt{-\\alpha^{2} \\frac{\\sin^{2}(\\kappa)}{4}} (\\lambda + 1) = \\pm i \\frac{\\alpha \\sin(\\kappa)}{2} (\\lambda + 1)\n$$\n现在我们可以解出放大因子 $\\lambda$：\n$$\n\\lambda \\left( 1 \\mp i \\frac{\\alpha \\sin(\\kappa)}{2} \\right) = 1 \\pm i \\frac{\\alpha \\sin(\\kappa)}{2}\n$$\n$$\n\\lambda = \\frac{1 \\pm i \\frac{\\alpha \\sin(\\kappa)}{2}}{1 \\mp i \\frac{\\alpha \\sin(\\kappa)}{2}}\n$$\n这给出了 $\\lambda$ 的两个解，分别对应左行波和右行波。令 $X = \\frac{\\alpha \\sin(\\kappa)}{2}$。解为 $\\lambda = \\frac{1 \\pm iX}{1 \\mp iX}$。$\\lambda$ 的模为 $|\\lambda| = \\frac{|1 \\pm iX|}{|1 \\mp iX|} = \\frac{\\sqrt{1+X^2}}{\\sqrt{1+X^2}} = 1$。该格式是无条件稳定且无耗散的。\n\n为了求出无量纲频率 $\\Omega$，我们使用定义 $\\lambda = \\exp(-i \\Omega)$。我们可以将复数 $1 \\pm iX$ 写成极坐标形式。例如，$1+iX = \\sqrt{1+X^2} \\exp(i \\arctan(X))$。\n对于取上符号的 $\\lambda$ 解为：\n$$\n\\exp(-i \\Omega) = \\frac{1 + iX}{1 - iX} = \\frac{\\sqrt{1+X^2} \\exp(i \\arctan(X))}{\\sqrt{1+X^2} \\exp(-i \\arctan(X))} = \\exp(2i \\arctan(X))\n$$\n比较指数，我们有 $-i \\Omega = 2i \\arctan(X)$，这得出 $\\Omega = -2 \\arctan(X)$。\n取下符号的解得出 $\\Omega = 2 \\arctan(X)$。\n因此，离散色散关系的两个分支是：\n$$\n\\Omega(\\kappa, \\alpha) = \\pm 2 \\arctan\\left( \\frac{\\alpha \\sin(\\kappa)}{2} \\right)\n$$\n连续色散关系为 $\\omega = \\pm k c$。在无量纲形式下，这变为 $\\Omega = \\omega \\Delta t = \\pm (k \\Delta x) \\frac{c \\Delta t}{\\Delta x} = \\pm \\kappa \\alpha$。右行分支通常与正号相关联，即 $\\omega = +kc$，这意味着当 $\\kappa, \\alpha > 0$ 时 $\\Omega = +\\kappa \\alpha > 0$。为了与此惯例匹配，我们为离散色散关系选择正根。\n因此，右行分支的离散色散关系为：\n$$\n\\Omega(\\kappa, \\alpha) = 2 \\arctan\\left( \\frac{\\alpha \\sin(\\kappa)}{2} \\right)\n$$\n\n### 步骤 3：相速度误差的定性分析\n数值相速度 $c_{\\text{num}}$ 由关系式 $\\omega = k c_{\\text{num}}$ 定义。使用无量纲变量，这变为 $\\frac{\\Omega}{\\Delta t} = \\frac{\\kappa}{\\Delta x} c_{\\text{num}}$，从而得到 $c_{\\text{num}} = c \\frac{\\Omega}{\\alpha \\kappa}$。相速度误差由 $\\frac{c_{\\text{num}}}{c} - 1$ 给出。\n$$\n\\frac{c_{\\text{num}}}{c} - 1 = \\frac{2 \\arctan\\left( \\frac{\\alpha \\sin(\\kappa)}{2} \\right)}{\\alpha \\kappa} - 1\n$$\n为了分析此误差，我们考虑其在不同无量纲波数 $\\kappa$（其中 $0 \\le \\kappa \\le \\pi$）下的行为。\n1.  **长波极限 ($\\kappa \\to 0$)：**\n    对于小自变量 $y$，$\\sin(y) \\approx y$ 且 $\\arctan(y) \\approx y$。\n    当 $\\kappa \\to 0$ 时，我们有 $\\sin(\\kappa) \\approx \\kappa$。\n    反正切函数的自变量变为 $\\frac{\\alpha \\sin(\\kappa)}{2} \\approx \\frac{\\alpha \\kappa}{2}$。\n    然后，$\\Omega \\approx 2 \\arctan\\left(\\frac{\\alpha \\kappa}{2}\\right) \\approx 2 \\left(\\frac{\\alpha \\kappa}{2}\\right) = \\alpha \\kappa$。\n    所以，$\\frac{c_{\\text{num}}}{c} = \\frac{\\Omega}{\\alpha \\kappa} \\approx \\frac{\\alpha \\kappa}{\\alpha \\kappa} = 1$。误差趋近于 $0$。\n    这表明对于非常长的波，该数值格式是高度准确的。更详细的泰勒展开显示，主导误差项为 $\\frac{c_{\\text{num}}}{c} - 1 \\approx -(\\frac{1}{6} + \\frac{\\alpha^2}{12})\\kappa^2$。这表明误差为负，并且是 $\\kappa$ 的二阶项。\n\n2.  **对于 $\\kappa \\in (0, \\pi)$ 的一般行为：**\n    对于任意 $y > 0$，不等式 $\\arctan(y)  y$ 成立。\n    令 $y = \\frac{\\alpha \\sin(\\kappa)}{2}$。对于 $\\kappa \\in (0, \\pi)$ 和 $\\alpha > 0$，我们有 $y > 0$。\n    因此，$\\Omega = 2 \\arctan(y)  2y = \\alpha \\sin(\\kappa)$。\n    同样，对于 $\\kappa \\in (0, \\pi)$，$\\sin(\\kappa)  \\kappa$。\n    结合这些，$\\Omega  \\alpha \\sin(\\kappa)  \\alpha \\kappa$。\n    这意味着 $\\frac{\\Omega}{\\alpha \\kappa}  1$，因此 $\\frac{c_{\\text{num}}}{c}  1$。\n    数值相速度总是小于真实相速度（$c_{\\text{num}}  c$）。这被称为相位滞后误差。数值波传播得太慢。随着 $\\kappa$ 从 $0$ 开始增加，$\\arctan(y)$ 和 $y$ 之间以及 $\\sin(\\kappa)$ 和 $\\kappa$ 之间的差异会增大。因此，随着无量纲波数的增加，相速度误差变得更负。\n\n3.  **短波极限 ($\\kappa \\to \\pi$)：**\n    网格可分辨的最短波的波长为 $2 \\Delta x$，对应于 $\\kappa = k \\Delta x = (\\frac{\\pi}{\\Delta x}) \\Delta x = \\pi$。\n    在 $\\kappa = \\pi$ 处，我们有 $\\sin(\\pi) = 0$。\n    $$\n    \\Omega(\\pi, \\alpha) = 2 \\arctan\\left( \\frac{\\alpha \\sin(\\pi)}{2} \\right) = 2 \\arctan(0) = 0\n    $$\n    相应的数值相速度为 $c_{\\text{num}} = c \\frac{\\Omega(\\pi, \\alpha)}{\\alpha \\pi} = 0$。\n    这意味着 $2 \\Delta x$ 波是静止的。该格式存在一个虚假的静止模态，相速度误差达到其最大值，即 $\\frac{c_{\\text{num}}}{c} - 1 = -1$。\n\n总之，对于固定的 Courant 数 $\\alpha$，数值相速度误差对于无限长的波（$\\kappa=0$）为零，随着波数 $\\kappa$ 的增加（波长减小）而变得越来越负（滞后），并在最短可分辨波（$\\kappa=\\pi$）处达到最大误差 $-1$，此时数值波变为静止。",
            "answer": "$$\\boxed{2 \\arctan\\left( \\frac{\\alpha \\sin(\\kappa)}{2} \\right)}$$"
        },
        {
            "introduction": "在设计大气模型时，变量在网格上的布局是一个至关重要的选择。本练习对比了用于声波模拟的Arakawa A-网格（并置网格）和C-网格（交错网格）。通过这个实践，你将发现为什么交错网格通常更受青睐，因为它能有效避免在并置网格上可能出现的虚假、非物理的计算模态。",
            "id": "4070235",
            "problem": "考虑均匀介质中的一维线性声学，其由关于恒定背景状态的速度和压力小振幅扰动的线性化可压缩 Euler 方程描述：\n$$\n\\frac{\\partial u}{\\partial t} \\;=\\; -\\frac{1}{\\rho_0}\\,\\frac{\\partial p}{\\partial x}, \\qquad\n\\frac{\\partial p}{\\partial t} \\;=\\; -\\rho_0\\,c^2\\,\\frac{\\partial u}{\\partial x},\n$$\n其中 $u$ 是速度扰动，$p$ 是压力扰动，$\\rho_0$ 是恒定的背景密度，$c$ 是声速。计算域以均匀的网格间距 $\\Delta x$ 和时间步长 $\\Delta t$ 进行离散化。\n\n考虑两种网格布置：\n- Arakawa A-网格（同位网格）：$u$ 和 $p$ 都存储在整数网格点 $x_j = j\\,\\Delta x$ 上。\n- Arakawa C-网格（交错网格）：$p$ 存储在 $x_j = j\\,\\Delta x$ 上，而 $u$ 存储在 $x_{j+1/2} = (j+\\tfrac{1}{2})\\,\\Delta x$ 上。\n\n对空间导数使用二阶中心有限差分，对声学子系统使用分裂显式的前向-后向时间离散化：\n- 在 C-网格上，使用旧时间层的压力梯度显式更新 $u$，并使用新时间层的速度梯度更新 $p$。\n- 在 A-网格上，类似地，使用旧时间层的压力梯度显式更新 $u$，并使用新时间层的速度梯度隐式更新 $p$，两者均在同位位置使用中心差分。\n\n令无量纲波数为 $\\kappa = k\\,\\Delta x$，并定义声学 Courant-Friedrichs-Lewy (CFL) 数为 $\\nu = c\\,\\Delta t / \\Delta x$。假设平面波解的形式在 A-网格上为 $u^n \\sim \\exp\\big(i (j\\,\\kappa - \\omega\\,n\\,\\Delta t)\\big)$ 和 $p^n \\sim \\exp\\big(i (j\\,\\kappa - \\omega\\,n\\,\\Delta t)\\big)$，在 C-网格上为 $u^n \\sim \\exp\\big(i ((j+\\tfrac{1}{2})\\,\\kappa - \\omega\\,n\\,\\Delta t)\\big)$，$p^n \\sim \\exp\\big(i (j\\,\\kappa - \\omega\\,n\\,\\Delta t)\\big)$。\n\n任务：\n1. 从控制方程和指定的离散化方法出发，推导在分裂显式前向-后向格式下，Arakawa A-网格和 Arakawa C-网格上的离散色散关系 $\\omega(\\kappa)$。您的推导必须是自洽的，并且直接从离散更新方程中获得，不得援引已知的目标公式。\n2. 根据您的 A-网格色散关系，指出在哪些波数下会发生压力-速度解耦（伪计算模式），并解释这种现象是如何由离散算子引起的。\n3. 使用您的色散关系，为两种网格构建无量纲的数值相速度比 $c_{\\text{num}}/c = \\omega/(c\\,k)$。在 $\\kappa = \\pi/2$ 和 $\\nu = 0.6$ 时，计算这些比率之间的差异，\n$$\n\\Delta \\;=\\; \\left(\\frac{c_{\\text{num}}}{c}\\right)_{\\text{C-grid}} \\;-\\; \\left(\\frac{c_{\\text{num}}}{c}\\right)_{\\text{A-grid}}.\n$$\n将 $\\Delta$ 的最终数值四舍五入到四位有效数字。将最终答案表示为一个无量纲数（无单位）。\n\n此外，简要评论在 A-网格上对声学子系统采用完全隐式的后向欧拉处理方法将如何改变色散关系的特性，以及这种方法是消除了还是保留了已识别出的解耦现象。",
            "solution": "用户提供的问题被评估为有效。它在科学上基于线性声学和计算流体力学的原理，问题陈述清晰，为获得唯一解提供了足够的信息，并且表述客观。这些任务具有实质性，需要严谨的数学推导和分析，完全属于应用数学和物理学的范畴。\n\n### 第 1 部分：离散色散关系的推导\n\n分析过程如下：首先离散化控制方程，然后代入平面波拟设，以找到数值频率 $\\omega$ 和波数 $k$ 之间的关系。定义放大因子为 $\\lambda = \\exp(-i\\,\\omega\\,\\Delta t)$。\n\n**Arakawa C-网格（交错网格）**\n\n在 C-网格上，$p$ 位于整数点 $j$，$u$ 位于半整数点 $j+1/2$。采用分裂显式前向-后向时间积分格式，并结合二阶中心差分：\n1.  速度 $u$ 使用时间层 $n$ 的压力梯度进行显式更新（前向 Euler 步）：\n    $$\n    \\frac{u_{j+1/2}^{n+1} - u_{j+1/2}^{n}}{\\Delta t} = -\\frac{1}{\\rho_0} \\left( \\frac{p_{j+1}^n - p_j^n}{\\Delta x} \\right)\n    $$\n2.  压力 $p$ 使用新时间层 $n+1$ 的速度散度进行隐式更新（后向 Euler 步）：\n    $$\n    \\frac{p_j^{n+1} - p_j^n}{\\Delta t} = -\\rho_0\\,c^2 \\left( \\frac{u_{j+1/2}^{n+1} - u_{j-1/2}^{n+1}}{\\Delta x} \\right)\n    $$\n\n代入平面波解 $p_j^n = P_0\\,\\exp(i(j\\kappa - \\omega n\\Delta t))$ 和 $u_{j+1/2}^n = U_0\\,\\exp(i((j+1/2)\\kappa - \\omega n\\Delta t))$，其中 $\\kappa=k\\Delta x$。使用关系式 $f^{n+1} = \\lambda f^n$，我们得到：\n对于 $u$ 方程：\n$$\n(\\lambda-1) U_0 \\exp(i(j+1/2)\\kappa) = -\\frac{\\Delta t}{\\rho_0 \\Delta x} P_0 \\left( \\exp(i(j+1)\\kappa) - \\exp(ij\\kappa) \\right)\n$$\n$$\n(\\lambda-1) U_0 \\exp(i\\kappa/2) = -\\frac{\\Delta t}{\\rho_0 \\Delta x} P_0 (\\exp(i\\kappa) - 1) = -\\frac{\\Delta t}{\\rho_0 \\Delta x} P_0 \\exp(i\\kappa/2) (\\exp(i\\kappa/2) - \\exp(-i\\kappa/2))\n$$\n$$\n(\\lambda-1) U_0 = -\\frac{2i\\Delta t}{\\rho_0 \\Delta x} \\sin\\left(\\frac{\\kappa}{2}\\right) P_0\n$$\n对于 $p$ 方程：\n$$\n(\\lambda-1) P_0 \\exp(ij\\kappa) = -\\rho_0 c^2 \\frac{\\Delta t}{\\Delta x} \\lambda U_0 \\left( \\exp(i(j+1/2)\\kappa) - \\exp(i(j-1/2)\\kappa) \\right)\n$$\n$$\n(\\lambda-1) P_0 = -\\rho_0 c^2 \\frac{\\lambda \\Delta t}{\\Delta x} U_0 (\\exp(i\\kappa/2) - \\exp(-i\\kappa/2)) = -\\rho_0 c^2 \\frac{\\lambda \\Delta t}{\\Delta x} U_0 \\left( 2i\\sin\\left(\\frac{\\kappa}{2}\\right) \\right)\n$$\n$$\n(\\lambda-1) P_0 = -2i\\rho_0 c^2 \\frac{\\lambda \\Delta t}{\\Delta x} \\sin\\left(\\frac{\\kappa}{2}\\right) U_0\n$$\n将得到的关于 $U_0$ 和 $P_0$ 的两个代数方程相乘，得到：\n$$\n(\\lambda-1)^2 U_0 P_0 = \\left(-\\frac{2i\\Delta t}{\\rho_0 \\Delta x} \\sin\\left(\\frac{\\kappa}{2}\\right)\\right) \\left(-2i\\rho_0 c^2 \\frac{\\lambda \\Delta t}{\\Delta x} \\sin\\left(\\frac{\\kappa}{2}\\right)\\right) U_0 P_0\n$$\n$$\n(\\lambda-1)^2 = -4 \\frac{c^2 \\Delta t^2}{\\Delta x^2} \\sin^2\\left(\\frac{\\kappa}{2}\\right) \\lambda\n$$\n使用 CFL 数 $\\nu = c\\Delta t/\\Delta x$，我们得到关于 $\\lambda$ 的特征方程：\n$$\n\\lambda^2 - 2\\lambda + 1 = -4\\nu^2 \\sin^2\\left(\\frac{\\kappa}{2}\\right) \\lambda \\quad \\implies \\quad \\lambda^2 - \\left(2 - 4\\nu^2 \\sin^2\\left(\\frac{\\kappa}{2}\\right)\\right)\\lambda + 1 = 0\n$$\n这是一个二次方程，如果判别式非正，其根位于单位圆上，这意味着 $4\\nu^2 \\sin^2(\\kappa/2) \\le 4$，或 $|\\nu \\sin(\\kappa/2)| \\le 1$。\n$\\lambda = \\exp(-i\\omega_C \\Delta t)$ 的解的实部为 $\\cos(\\omega_C \\Delta t) = 1 - 2\\nu^2\\sin^2(\\kappa/2)$。使用恒等式 $\\cos(\\theta) = 1 - 2\\sin^2(\\theta/2)$，我们发现：\n$$\n\\sin^2\\left(\\frac{\\omega_C \\Delta t}{2}\\right) = \\nu^2\\sin^2\\left(\\frac{\\kappa}{2}\\right) \\quad \\implies \\quad \\sin\\left(\\frac{\\omega_C \\Delta t}{2}\\right) = \\pm \\nu\\sin\\left(\\frac{\\kappa}{2}\\right)\n$$\n取频率的主值，得到 C-网格的色散关系：\n$$\n\\omega_C(\\kappa) = \\frac{2}{\\Delta t} \\arcsin\\left(\\nu \\sin\\left(\\frac{\\kappa}{2}\\right)\\right)\n$$\n\n**Arakawa A-网格（同位网格）**\n\n在 A-网格上，$u$ 和 $p$ 都位于整数点 $j$。离散格式为：\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = -\\frac{1}{\\rho_0} \\left( \\frac{p_{j+1}^n - p_{j-1}^n}{2\\Delta x} \\right)\n$$\n$$\n\\frac{p_j^{n+1} - p_j^n}{\\Delta t} = -\\rho_0\\,c^2 \\left( \\frac{u_{j+1}^{n+1} - u_{j-1}^{n+1}}{2\\Delta x} \\right)\n$$\n代入平面波解 $f_j^n = F_0\\,\\exp(i(j\\kappa - \\omega n\\Delta t))$：\n对于 $u$ 方程：\n$$\n(\\lambda-1) U_0 = -\\frac{\\Delta t}{2\\rho_0 \\Delta x} P_0 (\\exp(i\\kappa) - \\exp(-i\\kappa)) = -i\\frac{\\Delta t}{\\rho_0 \\Delta x}\\sin(\\kappa) P_0\n$$\n对于 $p$ 方程：\n$$\n(\\lambda-1) P_0 = -\\rho_0 c^2 \\frac{\\lambda \\Delta t}{2\\Delta x} U_0 (\\exp(i\\kappa) - \\exp(-i\\kappa)) = -i\\rho_0 c^2 \\frac{\\lambda \\Delta t}{\\Delta x}\\sin(\\kappa) U_0\n$$\n将这两个方程相乘：\n$$\n(\\lambda-1)^2 = (-i)^2 \\left(\\frac{\\Delta t}{\\rho_0 \\Delta x}\\sin(\\kappa)\\right) \\left(\\rho_0 c^2 \\frac{\\lambda \\Delta t}{\\Delta x}\\sin(\\kappa)\\right) = -\\frac{c^2 \\Delta t^2}{\\Delta x^2} \\sin^2(\\kappa) \\lambda\n$$\n使用 $\\nu = c\\Delta t/\\Delta x$，特征方程为：\n$$\n\\lambda^2 - 2\\lambda + 1 = -\\nu^2 \\sin^2(\\kappa) \\lambda \\quad \\implies \\quad \\lambda^2 - (2 - \\nu^2 \\sin^2(\\kappa))\\lambda + 1 = 0\n$$\n$\\lambda = \\exp(-i\\omega_A \\Delta t)$ 的实部为 $\\cos(\\omega_A \\Delta t) = 1 - \\frac{1}{2}\\nu^2\\sin^2(\\kappa)$。使用 $\\cos(\\theta) = 1 - 2\\sin^2(\\theta/2)$：\n$$\n\\sin^2\\left(\\frac{\\omega_A \\Delta t}{2}\\right) = \\frac{1}{4}\\nu^2\\sin^2(\\kappa) \\quad \\implies \\quad \\sin\\left(\\frac{\\omega_A \\Delta t}{2}\\right) = \\pm \\frac{\\nu}{2}\\sin(\\kappa)\n$$\n这给出了 A-网格的色散关系：\n$$\n\\omega_A(\\kappa) = \\frac{2}{\\Delta t} \\arcsin\\left(\\frac{\\nu}{2} \\sin(\\kappa)\\right)\n$$\n\n### 第 2 部分：A-网格的压力-速度解耦\n\nA-网格离散化对压力梯度和速度散度均使用形式为 $\\delta_{2x} f_j = (f_{j+1} - f_{j-1})/(2\\Delta x)$ 的中心差分算子。该算子作用于波 $\\exp(ij\\kappa)$ 的傅里叶表示为：\n$$\n\\frac{\\exp(i(j+1)\\kappa) - \\exp(i(j-1)\\kappa)}{2\\Delta x} = \\frac{\\exp(ij\\kappa)(\\exp(i\\kappa) - \\exp(-i\\kappa))}{2\\Delta x} = \\frac{i\\sin(\\kappa)}{\\Delta x}\\exp(ij\\kappa)\n$$\n该算子对于非零波数存在零空间。具体来说，对于网格上可分辨的最短波长 $\\lambda_{grid}=2\\Delta x$，无量纲波数为 $\\kappa = k\\Delta x = (\\pi/\\Delta x)\\Delta x = \\pi$。在此波数下，$\\sin(\\kappa) = \\sin(\\pi) = 0$。\n这意味着一个 $2\\Delta x$“棋盘”波形（例如，$p_j = P_0(-1)^j$）的离散梯度为零。因此：\n- 一个静止的棋盘状压力场（$p_j^n = P_0(-1)^j$）在动量方程中不产生力，因此速度场不受力作用且发生解耦。\n- 一个静止的棋盘状速度场（$u_j^n = U_0(-1)^j$）的散度为零，因此压力场不受力作用且发生解耦。\n\n这种解耦现象允许虚假的、静止的（$ \\omega=0 $）计算模式存在，这些是离散化产生的伪影。A-网格的色散关系证实了这一点：在 $\\kappa=\\pi$ 时，$\\sin(\\pi)=0$，这导致 $\\omega_A(\\pi) = (2/\\Delta t)\\arcsin(0) = 0$。C-网格的交错布置避免了这个问题，因为它的差分算子在 $\\kappa \\in (0, \\pi]$ 范围内永不为零。\n\n### 第 3 部分：数值相速度比较\n\n数值相速度为 $c_{\\text{num}} = \\omega/k$。其与真实相速度 $c$ 的比值为：\n$$\n\\frac{c_{\\text{num}}}{c} = \\frac{\\omega/k}{c} = \\frac{\\omega}{ck} = \\frac{\\omega}{c(\\kappa/\\Delta x)} = \\frac{\\omega \\Delta t}{\\nu \\kappa}\n$$\n对于 C-网格：\n$$\n\\left(\\frac{c_{\\text{num}}}{c}\\right)_{\\text{C-grid}} = \\frac{1}{\\nu \\kappa} \\left( \\frac{2}{\\Delta t} \\arcsin\\left(\\nu \\sin\\left(\\frac{\\kappa}{2}\\right)\\right) \\right) \\Delta t = \\frac{2}{\\nu \\kappa} \\arcsin\\left(\\nu \\sin\\left(\\frac{\\kappa}{2}\\right)\\right)\n$$\n对于 A-网格：\n$$\n\\left(\\frac{c_{\\text{num}}}{c}\\right)_{\\text{A-grid}} = \\frac{1}{\\nu \\kappa} \\left( \\frac{2}{\\Delta t} \\arcsin\\left(\\frac{\\nu}{2} \\sin(\\kappa)\\right) \\right) \\Delta t = \\frac{2}{\\nu \\kappa} \\arcsin\\left(\\frac{\\nu}{2} \\sin(\\kappa)\\right)\n$$\n我们在 $\\kappa = \\pi/2$ 和 $\\nu=0.6$ 时计算差值 $\\Delta$：\n$$\n\\left(\\frac{c_{\\text{num}}}{c}\\right)_{\\text{C-grid}} = \\frac{2}{0.6 \\cdot (\\pi/2)} \\arcsin\\left(0.6 \\sin\\left(\\frac{\\pi}{4}\\right)\\right) = \\frac{4}{0.6\\pi} \\arcsin\\left(0.6 \\cdot \\frac{\\sqrt{2}}{2}\\right) = \\frac{20}{3\\pi} \\arcsin(0.3\\sqrt{2})\n$$\n$$\n\\left(\\frac{c_{\\text{num}}}{c}\\right)_{\\text{A-grid}} = \\frac{2}{0.6 \\cdot (\\pi/2)} \\arcsin\\left(\\frac{0.6}{2} \\sin\\left(\\frac{\\pi}{2}\\right)\\right) = \\frac{4}{0.6\\pi} \\arcsin\\left(0.3 \\cdot 1\\right) = \\frac{20}{3\\pi} \\arcsin(0.3)\n$$\n数值计算如下：\n$$\n\\left(\\frac{c_{\\text{num}}}{c}\\right)_{\\text{C-grid}} \\approx \\frac{20}{3\\pi} \\arcsin( 0.424264 ) \\approx 2.122066 \\times 0.438131 \\approx 0.929742\n$$\n$$\n\\left(\\frac{c_{\\text{num}}}{c}\\right)_{\\text{A-grid}} \\approx \\frac{20}{3\\pi} \\arcsin( 0.3 ) \\approx 2.122066 \\times 0.304693 \\approx 0.646573\n$$\n差值为：\n$$\n\\Delta = \\left(\\frac{c_{\\text{num}}}{c}\\right)_{\\text{C-grid}} - \\left(\\frac{c_{\\text{num}}}{c}\\right)_{\\text{A-grid}} \\approx 0.929742 - 0.646573 = 0.283169\n$$\n四舍五入到四位有效数字，$\\Delta \\approx 0.2832$。\n\n### 关于完全隐式后向欧拉格式的评论\n\n在 A-网格上的完全隐式格式会在时间层 $n+1$ 评估所有右侧项：\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = -\\frac{1}{\\rho_0} \\delta_{2x} p_j^{n+1}, \\qquad \\frac{p_j^{n+1} - p_j^n}{\\Delta t} = -\\rho_0\\,c^2 \\delta_{2x} u_j^{n+1}\n$$\n代入平面波拟设可得：\n$$\n(\\lambda-1) U_0 = -i\\frac{\\lambda \\Delta t}{\\rho_0 \\Delta x}\\sin(\\kappa) P_0, \\qquad (\\lambda-1) P_0 = -i\\rho_0 c^2 \\frac{\\lambda \\Delta t}{\\Delta x}\\sin(\\kappa) U_0\n$$\n将方程相乘得到 $(\\lambda-1)^2 = -\\nu^2 \\lambda^2 \\sin^2(\\kappa)$。这给出 $1 - 1/\\lambda = \\pm i\\nu\\sin(\\kappa)$，因此 $\\lambda = 1/(1 \\mp i\\nu\\sin(\\kappa))$。其模长为 $|\\lambda| = 1/\\sqrt{1+\\nu^2\\sin^2(\\kappa)} \\le 1$，对所有实数 $\\nu$ 和 $\\kappa$ 均成立。色散关系被改变了：该格式变为无条件稳定的，但对于所有 $\\kappa \\neq n\\pi$ 也具有数值耗散性。\n\n然而，这种格式**并不能**消除解耦。解耦是空间算子 $\\delta_{2x}$ 在 $\\kappa = \\pi$ 处具有零空间的结果。由于在 $\\kappa=\\pi$ 时 $\\sin(\\kappa)=0$，特征方程变为 $(\\lambda-1)^2=0$，因此 $\\lambda=1$ 且 $\\omega=0$。静止的计算模式依然存在，因为它的存在从根本上与 A-网格的空间离散化有关，而与时间积分方法无关。",
            "answer": "$$\n\\boxed{0.2832}\n$$"
        },
        {
            "introduction": "在实际应用中，数值格式的设计往往是在稳定性与准确性之间寻求妥协。这个问题深入探讨了半隐式偏心格式，这是一种常用于抑制高频噪声的技术。你将分析偏心参数如何控制数值阻尼，并利用这一理解去寻找一个最优参数值，以便在保证稳定性的同时，最大程度地维持良好解析波的准确性。",
            "id": "4070202",
            "problem": "用于数值天气预报 (NWP) 的非静力大气动力核心采用分裂-显式外时间步长来推进慢速的平流和重力波项，并使用半隐式 (SI) 偏心方案来稳定快速的声波模态。考虑围绕一个密度为常数 $\\rho_{0}$、声速为 $c$ 的静止基态，速度 $u(x,t)$ 和压力 $p'(x,t)$ 的小扰动所满足的一维线性化可压缩方程：\n$$\n\\frac{\\partial u}{\\partial t} + \\frac{1}{\\rho_{0}} \\frac{\\partial p'}{\\partial x} = 0, \\quad \\frac{\\partial p'}{\\partial t} + \\rho_{0} c^{2} \\frac{\\partial u}{\\partial x} = 0.\n$$\n对于单一水平傅里叶模态 $\\exp(i k x)$，这些方程支持角频率为 $\\omega = c k$ 的声波振荡。在 SI 偏心更新中，声波趋势项通过广义梯形（或 $\\theta$-）方法在外部时间步长 $\\Delta t$ 上进行时间离散化，偏心参数为 $\\alpha \\in (0,1]$。当投影到复振幅为 $y(t)$ 且满足 $\\frac{d y}{d t} = i \\omega y$ 的单个声波正规模态上时，SI 更新从 $t^{n}$ 到 $t^{n+1}$ 的过程如下：\n$$\n\\frac{y^{n+1} - y^{n}}{\\Delta t} = i \\omega \\big[ \\alpha \\, y^{n+1} + (1 - \\alpha) \\, y^{n} \\big],\n$$\n相关的无量纲声波库朗数为 $z = \\omega \\Delta t$。该 SI 格式产生一个放大因子 $G(\\alpha,z)$，使得 $y^{n+1} = G(\\alpha,z) \\, y^{n}$，其模 $|G(\\alpha,z)|$ 控制了该模态的数值阻尼。\n\n您的任务是：\n1. 从给定的线性化方程和 SI 偏心更新出发，推导放大因子 $G(\\alpha,z)$ 及其模 $|G(\\alpha,z)|$ 的精确表达式。\n2. 使用您的结果，分析与分裂-显式NWP相关的两个渐近区域：\n   - 高频声波区域，$z \\to \\infty$，其中每个外时间步长的阻尼由偏心主导，并定义 $D(\\alpha) = \\lim_{z \\to \\infty} |G(\\alpha,z)|$。\n   - 低频解析区域，$z$ 很小，获得 $|G(\\alpha,z)|$ 关于小 $z$ 的主阶展开式，直到 $\\mathcal{O}(z^{2})$，并由此通过 $|G(\\alpha,z)| \\approx 1 - \\delta(\\alpha,z)$ 定义低频振幅缺陷 $\\delta(\\alpha,z)$。\n3. 为了以科学上有意义的方式平衡稳定性和准确性，为解析模态选择一个外声波库朗数 $z_{\\mathrm{res}} = 0.3$，以及每个外时间步长的高频目标阻尼比 $R_{T} = 0.4$。通过使用 $D(\\alpha)$ 的精确高频极限和 $|G(\\alpha,z_{\\mathrm{res}})|$ 关于小 $z$ 的主阶展开，确定使加权二次目标函数\n$$\nJ(\\alpha) = w \\left[ D(\\alpha) - R_{T} \\right]^{2} + (1 - w) \\left[ |G(\\alpha,z_{\\mathrm{res}})| - 1 \\right]^{2},\n$$\n最小的偏心参数 $\\alpha$，其中权重 $w = 0.7$。将您的最终答案 $\\alpha$ 表示为一个实数，并四舍五入到四位有效数字。不需要单位。",
            "solution": "问题陈述已经过严格验证，被确定为科学上合理、适定且客观。它提出了一个波动方程离散格式数值分析中的标准任务，与数值天气预报领域相关。所有必要的数据和条件均已提供，不存在矛盾或模糊之处。因此，我们可以进行完整解答。\n\n解答按照问题陈述的要求分为三个部分。\n\n首先，我们推导放大因子 $G(\\alpha,z)$ 及其模 $|G(\\alpha,z)|$ 的表达式。我们从问题中给出的、针对复振幅为 $y(t)$ 的单个声波模态的半隐式 (SI) 偏心更新法则开始：\n$$\n\\frac{y^{n+1} - y^{n}}{\\Delta t} = i \\omega \\big[ \\alpha \\, y^{n+1} + (1 - \\alpha) \\, y^{n} \\big]\n$$\n此处，$y^n$ 是在时间 $t^n$ 的振幅，$y^{n+1}$ 是在时间 $t^{n+1} = t^n + \\Delta t$ 的振幅，$\\omega$ 是模态的角频率，$\\Delta t$ 是时间步长，$\\alpha \\in (0,1]$ 是偏心参数。\n\n我们引入无量纲声波库朗数 $z = \\omega \\Delta t$。将其代入更新方程得到：\n$$\ny^{n+1} - y^{n} = i z \\big[ \\alpha \\, y^{n+1} + (1 - \\alpha) \\, y^{n} \\big]\n$$\n为了找到放大因子 $G(\\alpha,z) = y^{n+1} / y^{n}$，我们重新整理方程，将包含 $y^{n+1}$ 和 $y^{n}$ 的项归类：\n$$\ny^{n+1} (1 - i z \\alpha) = y^{n} (1 + i z (1 - \\alpha))\n$$\n解出比值 $y^{n+1}/y^{n}$，得到放大因子的表达式：\n$$\nG(\\alpha,z) = \\frac{1 + i z (1 - \\alpha)}{1 - i z \\alpha}\n$$\n这个复数的模 $|G(\\alpha,z)|$ 通过计算分子和分母的模之比得到。对于形式为 $a+ib$ 的复数，其模为 $\\sqrt{a^2 + b^2}$。\n$$\n|G(\\alpha,z)| = \\frac{|1 + i z (1-\\alpha)|}{|1 - i z \\alpha|} = \\frac{\\sqrt{1^2 + (z(1-\\alpha))^2}}{\\sqrt{1^2 + (-z\\alpha)^2}}\n$$\n这可以简化为放大因子模的精确表达式：\n$$\n|G(\\alpha,z)| = \\sqrt{\\frac{1 + z^2 (1-\\alpha)^2}{1 + z^2 \\alpha^2}}\n$$\n这就完成了第一个任务。\n\n其次，我们分析两个渐近区域。\n对于高频声波区域，我们考虑 $z \\to \\infty$ 的极限。这对应于未解析的快速声波。在此极限下的阻尼定义为 $D(\\alpha) = \\lim_{z \\to \\infty} |G(\\alpha,z)|$。\n$$\nD(\\alpha) = \\lim_{z \\to \\infty} \\sqrt{\\frac{1 + z^2 (1-\\alpha)^2}{1 + z^2 \\alpha^2}} = \\lim_{z \\to \\infty} \\sqrt{\\frac{1/z^2 + (1-\\alpha)^2}{1/z^2 + \\alpha^2}}\n$$\n当 $z \\to \\infty$ 时，$1/z^2$ 项趋于 $0$。剩下：\n$$\nD(\\alpha) = \\sqrt{\\frac{(1-\\alpha)^2}{\\alpha^2}} = \\frac{|1-\\alpha|}{|\\alpha|}\n$$\n考虑到约束条件 $\\alpha \\in (0,1]$， $1-\\alpha$ 和 $\\alpha$ 都是非负的，因此可以去掉绝对值符号，得到：\n$$\nD(\\alpha) = \\frac{1-\\alpha}{\\alpha}\n$$\n对于低频解析区域，我们考虑小的 $z$ 值，并找到 $|G(\\alpha,z)|$ 到 $\\mathcal{O}(z^2)$ 阶的主阶展开。我们使用对于小 $x$ 的二项式近似 $(1+x)^k \\approx 1 + kx$。\n$$\n|G(\\alpha,z)| = \\left(1 + z^2 (1-\\alpha)^2\\right)^{1/2} \\left(1 + z^2 \\alpha^2\\right)^{-1/2}\n$$\n将每一项展开到 $z^2$ 的一阶：\n$$\n\\left(1 + z^2 (1-\\alpha)^2\\right)^{1/2} \\approx 1 + \\frac{1}{2} z^2 (1-\\alpha)^2\n$$\n$$\n\\left(1 + z^2 \\alpha^2\\right)^{-1/2} \\approx 1 - \\frac{1}{2} z^2 \\alpha^2\n$$\n将这两个展开式相乘，并保留到 $\\mathcal{O}(z^2)$ 的项：\n$$\n|G(\\alpha,z)| \\approx \\left(1 + \\frac{1}{2} z^2 (1-\\alpha)^2\\right) \\left(1 - \\frac{1}{2} z^2 \\alpha^2\\right) \\approx 1 - \\frac{1}{2} z^2 \\alpha^2 + \\frac{1}{2} z^2 (1-\\alpha)^2\n$$\n$$\n|G(\\alpha,z)| \\approx 1 + \\frac{1}{2} z^2 \\left( (1-\\alpha)^2 - \\alpha^2 \\right)\n$$\n简化括号中的项：$(1-\\alpha)^2 - \\alpha^2 = (1 - 2\\alpha + \\alpha^2) - \\alpha^2 = 1 - 2\\alpha$。\n因此，小 $z$ 的展开式为：\n$$\n|G(\\alpha,z)| \\approx 1 + \\frac{1}{2} z^2 (1 - 2\\alpha) = 1 - \\frac{1}{2} z^2 (2\\alpha - 1)\n$$\n根据定义， $|G(\\alpha,z)| \\approx 1 - \\delta(\\alpha,z)$，所以低频振幅缺陷为 $\\delta(\\alpha,z) = \\frac{1}{2} z^2 (2\\alpha - 1)$。这就完成了第二个任务。\n\n第三，我们通过最小化目标函数 $J(\\alpha)$ 来确定最优偏心参数 $\\alpha$。\n目标函数由下式给出：\n$$\nJ(\\alpha) = w \\left[ D(\\alpha) - R_{T} \\right]^{2} + (1 - w) \\left[ |G(\\alpha,z_{\\mathrm{res}})| - 1 \\right]^{2}\n$$\n我们代入推导出的表达式和给定的数值：$w=0.7$，$R_T=0.4$，$z_{\\mathrm{res}}=0.3$。\n对于第一项，我们使用 $D(\\alpha) = \\frac{1-\\alpha}{\\alpha}$。对于第二项，我们使用主阶展开 $|G(\\alpha,z_{\\mathrm{res}})| - 1 \\approx \\frac{1}{2} z_{\\mathrm{res}}^2 (1-2\\alpha)$。\n$$\nJ(\\alpha) = 0.7 \\left( \\frac{1-\\alpha}{\\alpha} - 0.4 \\right)^{2} + (1-0.7) \\left( \\frac{1}{2} (0.3)^2 (1-2\\alpha) \\right)^{2}\n$$\n简化平方内的项：\n$$\n\\frac{1-\\alpha}{\\alpha} - 0.4 = \\frac{1 - 1.4\\alpha}{\\alpha}\n$$\n$$\n\\frac{1}{2} (0.3)^2 (1-2\\alpha) = \\frac{1}{2} (0.09) (1-2\\alpha) = 0.045 (1-2\\alpha)\n$$\n目标函数变为：\n$$\nJ(\\alpha) = 0.7 \\left( \\frac{1 - 1.4\\alpha}{\\alpha} \\right)^{2} + 0.3 \\left( 0.045 (1-2\\alpha) \\right)^{2}\n$$\n$$\nJ(\\alpha) = 0.7 \\frac{(1 - 1.4\\alpha)^2}{\\alpha^2} + 0.3 (0.002025) (1-2\\alpha)^2 = 0.7 \\frac{(1-1.4\\alpha)^2}{\\alpha^2} + 0.0006075 (1-2\\alpha)^2\n$$\n为了最小化 $J(\\alpha)$，我们将其关于 $\\alpha$ 的导数设为零：$\\frac{dJ}{d\\alpha} = 0$。\n使用链式法则和商法则对第一项求导：\n$$\n\\frac{d}{d\\alpha} \\left[ 0.7 \\left( \\frac{1 - 1.4\\alpha}{\\alpha} \\right)^{2} \\right] = 1.4 \\left( \\frac{1 - 1.4\\alpha}{\\alpha} \\right) \\left( \\frac{-1.4\\alpha - (1-1.4\\alpha)}{\\alpha^2} \\right) = 1.4 \\left( \\frac{1 - 1.4\\alpha}{\\alpha} \\right) \\left( -\\frac{1}{\\alpha^2} \\right) = \\frac{-1.4(1-1.4\\alpha)}{\\alpha^3}\n$$\n对第二项求导：\n$$\n\\frac{d}{d\\alpha} \\left[ 0.0006075 (1-2\\alpha)^2 \\right] = 0.0006075 \\cdot 2(1-2\\alpha)(-2) = -0.00243(1-2\\alpha)\n$$\n将导数之和设为零：\n$$\n\\frac{-1.4(1-1.4\\alpha)}{\\alpha^3} - 0.00243(1-2\\alpha) = 0\n$$\n$$\n-1.4(1-1.4\\alpha) = 0.00243 \\alpha^3 (1-2\\alpha)\n$$\n$$\n-1.4 + 1.96\\alpha = 0.00243\\alpha^3 - 0.00486\\alpha^4\n$$\n这给出了关于 $\\alpha$ 的四次方程：\n$$\n0.00486\\alpha^4 - 0.00243\\alpha^3 + 1.96\\alpha - 1.4 = 0\n$$\n该方程没有简单的解析解，必须进行数值求解。一个有效的方法是注意到 $\\alpha^4$ 和 $\\alpha^3$ 项的系数非常小。这表明解接近于线性部分 $1.96\\alpha - 1.4 = 0$ 的根，即 $\\alpha_0 = 1.4 / 1.96 = 1/1.4 = 5/7 \\approx 0.714286$。\n我们可以使用一次 Newton-Raphson 方法迭代 $\\alpha_{n+1} = \\alpha_n - f(\\alpha_n)/f'(\\alpha_n)$ 来改进这个初始猜测，其中 $f(\\alpha)$ 是四次多项式。\n设 $\\alpha_0 = 5/7$。\n$f(\\alpha_0) = 0.00486(5/7)^4 - 0.00243(5/7)^3 + 1.96(5/7) - 1.4 \\approx 0.000378$\n$f'(\\alpha) = 0.01944\\alpha^3 - 0.00729\\alpha^2 + 1.96$\n$f'(\\alpha_0) = 0.01944(5/7)^3 - 0.00729(5/7)^2 + 1.96 \\approx 1.9633$\n改进后的估计值为：\n$$\n\\alpha_1 = \\frac{5}{7} - \\frac{0.000378}{1.9633} \\approx 0.714286 - 0.0001925 = 0.7140935\n$$\n将此结果四舍五入到四位有效数字，得到 $\\alpha = 0.7141$。",
            "answer": "$$\n\\boxed{0.7141}\n$$"
        }
    ]
}