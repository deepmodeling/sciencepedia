{
    "hands_on_practices": [
        {
            "introduction": "本章将通过一系列动手实践，帮助您掌握核心的建模技能，将理论应用于复杂的海洋环流模型（OGCMs）。我们首先来解决显式时间积分方案中最基本的约束：Courant-Friedrichs-Lewy（CFL）条件。这项练习将通过计算模型保持稳定所允许的最大时间步长，把数值稳定性的抽象概念植根于一个具体的、关键的计算之中。",
            "id": "4072641",
            "problem": "考虑在海洋环流模式 (OGCM) 中控制外（正压）重力波动力学的垂向积分线性化浅水方程。对于均匀深度上的小振幅运动，外重力波以非频散方式传播，其相速度仅由重力加速度和海洋深度决定。在用于这些波的显式时间步长格式中，数值稳定性要求 Courant–Friedrichs–Lewy (CFL) 数受一个固定常数的限制，该常数取决于离散化的选择；对于所考虑的格式，取该界限为 $0.5$。使用均匀深度 $H=4000\\ \\mathrm{m}$、重力加速度 $g=9.81\\ \\mathrm{m\\,s^{-2}}$ 和水平网格间距 $\\Delta x=20\\ \\mathrm{km}$，确定满足 CFL 稳定性要求的最大稳定显式时间步长 $\\Delta t$。最终答案以秒为单位，并将数值结果四舍五入到四位有效数字。",
            "solution": "该问题要求计算在海洋环流模式 (OGCM) 中模拟外重力波的最大稳定显式时间步长 $\\Delta t$。解决方案涉及应用 Courant–Friedrichs–Lewy (CFL) 稳定性条件。\n\n首先，我们确定系统中最快波的传播速度，即外（正压）重力波。对于均匀深度为 $H$ 的浅水系统，这些波的相速度 $c$ 由下式给出：\n$$c = \\sqrt{gH}$$\n其中 $g$ 是重力加速度。\n\n接下来，我们建立显式时间步长格式的 CFL 稳定性条件。CFL 数 $\\mathcal{C}$ 定义为波在一个时间步长内传播的距离与网格间距的比值：\n$$\\mathcal{C} = \\frac{c \\Delta t}{\\Delta x}$$\n其中 $\\Delta t$ 是时间步长，$\\Delta x$ 是水平网格间距。为了使数值格式稳定，CFL 数必须小于或等于一个特定的常数，该常数取决于数值离散化的细节。问题指出这个上限是 $0.5$。因此，稳定性判据为：\n$$\\frac{c \\Delta t}{\\Delta x} \\le 0.5$$\n为了找到最大稳定时间步长，我们将其表示为 $\\Delta t_{\\text{max}}$，我们将 CFL 数设置为其允许的最大值：\n$$\\frac{c \\Delta t_{\\text{max}}}{\\Delta x} = 0.5$$\n求解 $\\Delta t_{\\text{max}}$ 可得：\n$$\\Delta t_{\\text{max}} = \\frac{0.5 \\Delta x}{c}$$\n将波速表达式 $c = \\sqrt{gH}$ 代入此方程，我们得到以给定的物理和数值参数表示的最大时间步长公式：\n$$\\Delta t_{\\text{max}} = \\frac{0.5 \\Delta x}{\\sqrt{gH}}$$\n问题提供了以下数值：\n- 均匀深度 $H = 4000\\ \\mathrm{m}$\n- 重力加速度 $g = 9.81\\ \\mathrm{m\\,s^{-2}}$\n- 水平网格间距 $\\Delta x = 20\\ \\mathrm{km}$\n\n为了进行计算，所有量都必须使用一致的国际单位制（SI）单位。我们将网格间距 $\\Delta x$ 从千米转换为米：\n$$\\Delta x = 20\\ \\mathrm{km} = 20 \\times 10^{3}\\ \\mathrm{m} = 20000\\ \\mathrm{m}$$\n现在，我们将给定的数值代入 $\\Delta t_{\\text{max}}$ 的方程中：\n$$\\Delta t_{\\text{max}} = \\frac{0.5 \\times 20000}{\\sqrt{9.81 \\times 4000}}$$\n结果的单位将是秒。让我们来计算这个表达式。首先，分母（波速）：\n$$\\sqrt{9.81 \\times 4000} = \\sqrt{39240} \\approx 198.09089$$\n分子是 $0.5 \\times 20000 = 10000$。\n因此，最大时间步长为：\n$$\\Delta t_{\\text{max}} = \\frac{10000}{198.09089} \\approx 50.48188\\ \\mathrm{s}$$\n问题要求最终答案四舍五入到四位有效数字。将 $50.48188$ 四舍五入到四位有效数字得到 $50.48$。",
            "answer": "$$\n\\boxed{50.48}\n$$"
        },
        {
            "introduction": "在解决了决定模型计算可行性的短期数值稳定性问题之后，我们现在将目光转向控制海洋气候的长期物理过程。本练习将运用尺度分析来估算深海对外界变化作出调整所需的长达数千年的时间尺度。理解这一概念对于正确进行海洋模型的“启动（spin-up）”和解读古气候模拟结果至关重要。",
            "id": "4072665",
            "problem": "在一个海洋环流模式 (OGCM) 中，考虑一个强加的大尺度表面浮力异常后深海的调整过程。假设深海层结的调整受到小尺度跨等密度面混合的限制，并且垂直平流和旋转不决定主要的调整速率。使用一维垂直扩散来模拟深度为 $H$ 的水柱中浮力 $b(z,t)$ 的垂直演变，其中跨等密度面扩散系数 $K_d$ 为常数：\n- 控制方程是示踪剂的垂直扩散方程，\n$$\n\\frac{\\partial b}{\\partial t} = K_d \\frac{\\partial^2 b}{\\partial z^2}, \\quad 0  z  H,\n$$\n其边界条件在物理上是恰当的，并且除了由 $H$ 和 $K_d$ 所蕴含的时间尺度外，不引入其他额外的时间尺度。\n- 根据该方程的第一性原理，确定在整个深度 $H$ 上深海调整的特征启动时间尺度 $T$（用 $H$ 和 $K_d$ 表示），相差一个一阶常数。\n\n然后，对于 $H = 4000\\ \\mathrm{m}$ 和 $K_d = 10^{-5}\\ \\mathrm{m^2\\,s^{-1}}$，计算这个时间尺度。使用 $1\\ \\mathrm{yr} = 365\\ \\mathrm{days}$ 和 $1\\ \\mathrm{day} = 86400\\ \\mathrm{s}$，将最终的时间尺度以年为单位表示。将你的答案四舍五入到三位有效数字。简要地给出物理诠释，说明这个时间尺度对于全球海洋模型中深海环流的启动意味着什么。",
            "solution": "受跨等密度面混合限制的深海调整可以用一维垂直扩散方程来理想化：\n$$\n\\frac{\\partial b}{\\partial t} = K_d \\frac{\\partial^2 b}{\\partial z^2}\n$$\n该方程定义在 $0  z  H$ 的域上。我们的目标是使用量纲分析从这个方程中确定特征时间尺度 $T$。\n\n我们将方程中的各项用它们的特征尺度来表示。令 $T$ 为时间尺度，$H$ 为垂直长度尺度（海洋深度），$[b]$ 为浮力的特征尺度。\n\n- 时间导数项 $\\frac{\\partial b}{\\partial t}$ 的尺度为 $\\frac{[b]}{T}$。\n- 扩散项 $K_d \\frac{\\partial^2 b}{\\partial z^2}$ 的尺度为 $K_d \\frac{[b]}{H^2}$。\n\n为了使方程成立，这两项的量级必须相当。因此，我们得到以下关系：\n$$\n\\frac{[b]}{T} \\sim K_d \\frac{[b]}{H^2}\n$$\n消去 $[b]$，我们可以解出时间尺度 $T$：\n$$\nT \\sim \\frac{H^2}{K_d}\n$$\n这个关系表明，扩散过程的调整时间尺度与长度尺度的平方成正比，与扩散系数成反比。这是扩散过程的一个普遍特征。\n\n现在，我们代入给定的数值：\n- 深度 $H = 4000\\ \\mathrm{m}$\n- 跨等密度面扩散系数 $K_d = 10^{-5}\\ \\mathrm{m^2\\,s^{-1}}$\n\n计算时间尺度 $T$（单位为秒）：\n$$\nT = \\frac{(4000\\ \\mathrm{m})^2}{10^{-5}\\ \\mathrm{m^2\\,s^{-1}}} = \\frac{1.6 \\times 10^7\\ \\mathrm{m^2}}{10^{-5}\\ \\mathrm{m^2\\,s^{-1}}} = 1.6 \\times 10^{12}\\ \\mathrm{s}\n$$\n最后，我们将时间尺度从秒转换为年：\n$$\nT_{\\text{years}} = \\frac{1.6 \\times 10^{12}\\ \\mathrm{s}}{365\\ \\mathrm{days/yr} \\times 86400\\ \\mathrm{s/day}} = \\frac{1.6 \\times 10^{12}\\ \\mathrm{s}}{31,536,000\\ \\mathrm{s/yr}} \\approx 50735.6\\ \\mathrm{yr}\n$$\n四舍五入到三位有效数字，我们得到 $5.07 \\times 10^4$ 年。\n\n这个漫长的时间尺度意味着，海洋深层（大部分海洋体积）对表面强迫变化的响应非常缓慢。在启动一个全球海洋模型以达到平衡态时，需要进行数千年甚至数万年的积分，以确保深海的温度、盐度和环流结构与表面强迫和内部混合过程完全协调。这也解释了为什么古气候记录中的深海信号会滞后于大气变化数千年。",
            "answer": "$$\\boxed{5.07\\times 10^{4}}$$"
        },
        {
            "introduction": "完整的海洋环流模型（OGCMs）极其复杂，难以清晰地分离因果关系。这项练习将展示概念模型的强大作用，通过运用一阶物理平衡关系来探究经向翻转环流（MOC）对关键参数（如跨等密度面混合）的敏感性。通过构建这个简化模型，您将对控制模拟海洋大尺度结构的基本动力学过程建立起深刻的直觉。",
            "id": "4072627",
            "problem": "你需要为一个概念性海洋环流模型设计并实现一个独立的敏感性实验，以分离出背景跨等密度面扩散率的作用。目标是量化改变背景跨等密度面扩散率如何影响翻转环流的垂直结构和深层层结，同时保持风生强迫固定。\n\n从适用于大尺度海洋旋转层化流的第一性原理出发，使用以下基础：\n\n- 质量守恒以及风生上升流与内部跨等密度面混合之间的稳态经向翻转平衡。\n- 密度跃层中示踪剂的稳态一维平流-扩散平衡。\n- 在布辛涅斯克近似和静力近似下，适用于纬向重入通道中风生输运的埃克曼理论。\n\n对于一个为全球翻转环流供水的单半球、纬向重入的南大洋通道，假设给定以下物理常数和参数：\n\n- 背景跨等密度面扩散率，$K_d$（将在测试套件中变化），单位为 $\\mathrm{m^2\\,s^{-1}}$。\n- 海水参考密度，$\\rho_0 = 1027\\ \\mathrm{kg\\,m^{-3}}$。\n- 重力加速度，$g = 9.81\\ \\mathrm{m\\,s^{-2}}$。\n- 热膨胀系数，$\\alpha = 2.0\\times 10^{-4}\\ \\mathrm{K^{-1}}$。\n- 代表南大洋的科里奥利参数，$f = -1.0\\times 10^{-4}\\ \\mathrm{s^{-1}}$。\n- 重入通道的纬向宽度，$W = 2.0\\times 10^{7}\\ \\mathrm{m}$。\n- 纬向风应力大小，$\\tau = 0.20\\ \\mathrm{N\\,m^{-2}}$。\n- 参与跨等密度面混合的有效深层面积，$A = 3.0\\times 10^{14}\\ \\mathrm{m^{2}}$。\n- 表层与深层的温差，$\\Delta T = 15\\ \\mathrm{K}$。\n\n实验要求你：\n\n1.  运用地球物理流体动力学，根据埃克曼理论和几何形状估算风生体积输运 $Q_{\\mathrm{wind}}$。用 $\\mathrm{m^3\\,s^{-1}}$ 表示 $Q_{\\mathrm{wind}}$。\n2.  使用稳态质量平衡，令风生上升流与内部跨等密度面上升流相等，以推断密度跃层厚度 $D$（单位为米）和翻转强度 $\\Psi$（单位为斯维尔德鲁普，其中 $1\\ \\mathrm{Sv} = 10^{6}\\ \\mathrm{m^3\\,s^{-1}}$）。\n3.  利用密度跃层中温度的稳态平流-扩散标度关系，通过浮力频率的平方 $N^{2}$（单位为 $\\mathrm{s^{-2}}$）来估算深层层结。\n\n你的程序必须将此推理应用于以下 $K_d$ 值的测试套件，单位均为 $\\mathrm{m^2\\,s^{-1}}$：\n\n- 理想情况：$K_d = 3.0\\times 10^{-5}$。\n- 下限：$K_d = 1.0\\times 10^{-5}$。\n- 上限：$K_d = 1.0\\times 10^{-4}$。\n\n对于每个测试用例，计算并返回一个包含三个浮点数的三元组：\n\n- 密度跃层厚度 $D$（单位为米）。\n- 翻转强度 $\\Psi$（单位为斯维尔德鲁普）。\n- 深层层结 $N^2$（单位为 $\\mathrm{s^{-2}}$）。\n\n物理单位必须严格遵守上述规定。你的程序应生成单行输出，其中包含一个由方括号括起来的、逗号分隔的三元组列表。例如： \"[[D1,Psi1,N21],[D2,Psi2,N22],[D3,Psi3,N23]]\"，其中 $D$ 的单位是米，$\\Psi$ 的单位是斯维尔德鲁普，$N^2$ 的单位是 $\\mathrm{s^{-2}}$。不应打印任何其他文本。\n\n科学真实性要求：仅使用指定的常数，并假设在稳态条件下，单个翻转环流由风生上升流和背景跨等密度面混合的平衡维持。除上述基本原理外，不要引入额外的闭合关系。你的实现必须在数值上保持一致并感知单位。",
            "solution": "该问题要求为一个概念性海洋环流模型设计一个敏感性实验。目标是量化变化的背景跨等密度面扩散率 $K_d$ 对密度跃层厚度、翻转强度和深层层结的影响。分析将基于地球物理流体动力学的第一性原理，特别是稳态经向翻转平衡、示踪剂的平流-扩散平衡以及埃克曼理论。\n\n该模型基于一种平衡：全球经向翻转环流的强度由纬向重入南大洋通道上的风强迫设定，而海洋内部结构通过跨等密度面混合来适应这种强迫。\n\n推导按规定分三步进行。\n\n**1. 估算风生体积输运和翻转强度 ($\\Psi$)**\n\n该模型中翻转强度的基础是南大洋中的风生埃克曼输运。根据埃克曼理论，在旋转坐标系中，作用于海洋表面的纬向风应力 $\\tau_x$ 会驱动一个在表层埃克曼层内积分的经向输运。单位纬向距离的经向体积输运 $M_y$ 由下式给出：\n\n$$M_y = \\frac{\\tau_x}{\\rho_0 f}$$\n\n其中 $\\rho_0$ 是海水的参考密度，$f$ 是科里奥利参数。\n\n对于指定的单半球、纬向重入的南大洋通道，我们考虑西风，因此纬向应力 $\\tau_x$ 为正，且等于给定的风应力大小 $\\tau$。在南半球，科里奥利参数 $f$ 为负。这导致一个向北的埃克曼输运（在气象学惯例中 $M_y > 0$，但我们关心的是*离开*南大洋表层盒的输运，这是向北的，因此在海洋学背景下为正值）。这些被向北驱动离开通道的表层水，必须由下方更深层水的上升流来补充。\n\n总体积输运 $Q_{\\mathrm{wind}}$ 是通过将 $M_y$ 乘以通道的纬向宽度 $W$ 得到的。翻转环流的强度 $\\Psi$ 由这个总风生上升流的大小决定：\n\n$$\\Psi = |Q_{\\mathrm{wind}}| = \\left| \\frac{\\tau W}{\\rho_0 f} \\right| = \\frac{\\tau W}{\\rho_0 |f|}$$\n\n在这个概念框架中，翻转强度 $\\Psi$ 完全由外部参数（风应力和几何形状）决定，并且独立于海洋内部的扩散率 $K_d$。我们可以使用给定的常数来计算其值：\n\n- $\\tau = 0.20\\ \\mathrm{N\\,m^{-2}}$\n- $W = 2.0\\times 10^{7}\\ \\mathrm{m}$\n- $\\rho_0 = 1027\\ \\mathrm{kg\\,m^{-3}}$\n- $|f| = |-1.0\\times 10^{-4}\\ \\mathrm{s^{-1}}| = 1.0\\times 10^{-4}\\ \\mathrm{s^{-1}}$\n\n$$\\Psi = \\frac{(0.20\\ \\mathrm{kg\\,m^{-1}\\,s^{-2}}) \\times (2.0\\times 10^{7}\\ \\mathrm{m})}{(1027\\ \\mathrm{kg\\,m^{-3}}) \\times (1.0\\times 10^{-4}\\ \\mathrm{s^{-1}})} \\approx 3.895 \\times 10^7\\ \\mathrm{m^3\\,s^{-1}}$$\n\n换算成斯维尔德鲁普（$1\\ \\mathrm{Sv} = 10^6\\ \\mathrm{m^3\\,s^{-1}}$），翻转强度为：\n\n$$\\Psi \\approx 38.95\\ \\mathrm{Sv}$$\n\n**2. 估算密度跃层厚度 ($D$)**\n\n问题假设一个稳态质量平衡，其中翻转输运 $\\Psi$ 与海洋内部的跨等密度面混合相平衡。由混合引起的总向上输运 $Q_{mix}$ 可以表示为有效跨等密度面上升流速度 $w_{mix}$ 与发生混合的深层面积 $A$ 的乘积。\n\n$$Q_{mix} = w_{mix} A$$\n\n上升流速度 $w_{mix}$ 可以从密度跃层中示踪剂（如温度或密度）的一维稳态平流-扩散平衡中标度得出：\n\n$$w_{mix} \\frac{\\partial \\phi}{\\partial z} = K_d \\frac{\\partial^2 \\phi}{\\partial z^2}$$\n\n其中 $\\phi$ 是示踪剂浓度，$z$ 是垂直坐标。在一个厚度为 $D$、特征示踪剂差异为 $\\Delta \\phi$ 的密度跃层上对导数进行标度，我们有 $\\frac{\\partial \\phi}{\\partial z} \\sim \\frac{\\Delta \\phi}{D}$ 和 $\\frac{\\partial^2 \\phi}{\\partial z^2} \\sim \\frac{\\Delta \\phi}{D^2}$。该平衡得到一个垂直速度的标度关系：\n\n$$w_{mix} \\sim \\frac{K_d}{D}$$\n\n因此，总跨等密度面输运为 $\\Psi = Q_{mix} \\approx \\frac{K_d A}{D}$。由于 $\\Psi$ 已由风强迫确定，我们可以解出密度跃层厚度 $D$，它必须调整以满足这个平衡：\n\n$$D = \\frac{K_d A}{\\Psi}$$\n\n这个方程表明，密度跃层厚度与背景跨等密度面扩散率 $K_d$ 成正比。\n\n**3. 估算深层层结 ($N^2$)**\n\n深层层结由浮力频率的平方 $N^2$ 来量化，其定义为：\n\n$$N^2 = -\\frac{g}{\\rho_0} \\frac{\\partial \\rho}{\\partial z}$$\n\n其中 $g$ 是重力加速度。假设一个由温度主导的线性状态方程，$\\rho \\approx \\rho_0(1 - \\alpha (T - T_{ref}))$，其中 $\\alpha$ 是热膨胀系数，密度梯度可以与温度梯度关联起来：$\\frac{\\partial \\rho}{\\partial z} = -\\rho_0 \\alpha \\frac{\\partial T}{\\partial z}$。将此代入 $N^2$ 的定义中得到：\n\n$$N^2 = g \\alpha \\frac{\\partial T}{\\partial z}$$\n\n跨越厚度为 $D$、表层与深层温差为 $\\Delta T$ 的密度跃层的垂直温度梯度 $\\frac{\\partial T}{\\partial z}$ 可以标度为：\n\n$$\\frac{\\partial T}{\\partial z} \\sim \\frac{\\Delta T}{D}$$\n\n因此，层结可以估算为：\n\n$$N^2 = \\frac{g \\alpha \\Delta T}{D}$$\n\n通过代入上一步得到的 $D$ 的表达式，我们可以看到层结对扩散率 $K_d$ 的直接依赖关系：\n\n$$N^2 = \\frac{g \\alpha \\Delta T \\Psi}{K_d A}$$\n\n这个结果在物理上是直观的：更强的跨等密度面混合（更大的 $K_d$）导致更厚的密度跃层（更大的 $D$），从而导致更弱的垂直层结（更小的 $N^2$）。\n\n这些推导出的公式被应用于 $K_d$ 测试套件中的每个值。",
            "answer": "[[231.07185050210086,38.94839337877312,0.00012736411516631885],[77.02395016736695,38.94839337877312,0.00038209234549895655],[770.2395016736696,38.94839337877312,3.820923454989565e-05]]"
        }
    ]
}