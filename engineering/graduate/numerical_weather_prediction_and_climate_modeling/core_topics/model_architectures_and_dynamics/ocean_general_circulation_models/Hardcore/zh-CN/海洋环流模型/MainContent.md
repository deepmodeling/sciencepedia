## 引言
[海洋环流](@entry_id:195237)模式（Ocean General Circulation Models, OGCMs）是现代[海洋学](@entry_id:149256)和气候科学的基石，它们是我们在计算机中重建全球海洋复杂运动的强大工具。然而，理解这些模式的内部运作机制——从其底层的物理定律到复杂的数值实现，再到其广泛的科学应用——对于研究人员和学生来说都是一项重大挑战。本文旨在系统性地解析OGCMs，填补理论知识与实际应用之间的鸿沟。在接下来的内容中，我们将展开一次全面的探索。第一章“原理与机制”将深入剖析控制模式行为的核心物理方程、[动力学平衡](@entry_id:187220)和关键数值方法。第二章“应用与跨学科联系”将展示这些模式如何被用于解决从[海洋动力学](@entry_id:1129055)到全球气候变化等一系列关键科学问题。最后，在“动手实践”部分，您将有机会通过具体的计算练习来巩固所学知识。让我们首先从构建这些宏伟数字海洋的基石——基本原理与机制开始。

## 原理与机制

本章旨在阐述[海洋环流](@entry_id:195237)模式（Ocean General Circulation Models, OGCMs）背后的核心物理原理与关键机制。我们将从控制方程组出发，探讨大尺度[海洋动力学](@entry_id:1129055)的基本平衡，分析海洋热力学过程的复杂性，并深入研究那些无法被模式网格直接解析的[次网格尺度过程](@entry_id:1132602)的[参数化](@entry_id:265163)方法。最后，我们将审视那些对模式性能至关重要的基本数值选择。

### 控制方程：[原始方程](@entry_id:1130162)组

几乎所有的[海洋环流](@entry_id:195237)模式都建立在一套被称为**[原始方程](@entry_id:1130162)组**（primitive equations）的近似方程之上。这组方程本身是从描述流体运动的完整**[纳维-斯托克斯方程](@entry_id:142275)**（[Navier-Stokes](@entry_id:276387) equations）在[旋转坐标系](@entry_id:170324)下，针对大尺度[海洋环流](@entry_id:195237)的特定物理条件简化而来的。其中两个最核心的简化是**布辛涅斯克近似**（Boussinesq approximation）和**[静力平衡近似](@entry_id:1126281)**（hydrostatic approximation）。

为了理解这些近似的物理基础，我们首先需要进行[尺度分析](@entry_id:1131264)。考虑一个典型的海洋盆地，其水平尺度 $L$（如 $1000 \ \mathrm{km}$）远大于其垂直尺度 $H$（如 $4 \ \mathrm{km}$）。这导致一个非常小的**长宽比**（aspect ratio），即 $\delta = H/L \ll 1$。同样，大尺度海洋流速 $U$（如 $0.1 \ \mathrm{m\,s^{-1}}$）远小于重力波的波速，这体现在一个很小的**弗劳德数**（Froude number）中，$Fr = U / \sqrt{gH} \ll 1$。

**布辛涅斯克近似**适用于密度变化很小的情况，即[海水密度](@entry_id:1129054) $\rho$ 可以表示为参考密度 $\rho_0$（一个常数）与一个小的扰动 $\rho'$ 的和，$\rho = \rho_0 + \rho'$，且 $|\rho'| / \rho_0 \ll 1$。该近似包含两个关键部分 ：

1.  **对惯性项的简化**：在[动量方程](@entry_id:197225)的惯性项（或加速度项）$\rho \frac{D \mathbf{u}}{D t}$ 中，密度的微小变化对动量的影响被忽略，因此 $\rho$ 被其参考值 $\rho_0$ 替代。这样做是因为密度变化 $\rho'$ 相对于 $\rho_0$ 是一个微小量。

2.  **对[浮力](@entry_id:154088)项的保留**：与惯性项不同，在重力项 $\rho \mathbf{g}$ 中，密度扰动 $\rho'$ 必须被保留。这是因为重力与密度的微小差异相互作用，产生了驱动海洋层结中大部分运动的**[浮力](@entry_id:154088)**（buoyancy force），其大小为 $\rho' \mathbf{g}$。这是驱动海洋垂直环流和对流的关键力量。

3.  **对[连续性方程](@entry_id:195013)的简化**：对于[马赫数](@entry_id:274014) $M = U/c \ll 1$（$c$ 为声速）的低速流动，海洋可以被视为不可压缩的。这意味着流体微团在运动时保持体积不变。完整的[质量守恒](@entry_id:204015)方程 $\frac{\partial \rho}{\partial t} + \nabla \cdot (\rho \mathbf{u}) = 0$ 因此被简化为体积守恒方程，即速度场的散度为零：$\nabla \cdot \mathbf{u} = 0$。这个简化有效地滤掉了在[海洋环流](@entry_id:195237)中[传播速度](@entry_id:189384)极快且通常不重要的**声波**，从而允许在[数值模拟](@entry_id:146043)中使用更长的时间步长。

**静力平衡近似**则简化了[垂直动量方程](@entry_id:1133792)。完整的[垂直动量方程](@entry_id:1133792)描述了垂直方向上的压力[梯度力](@entry_id:166847)、重力和垂直加速度之间的平衡。通过尺度分析可以证明，对于[长宽比](@entry_id:177707) $\delta \ll 1$ 和弗劳德数 $Fr \ll 1$ 的大尺度流动，垂直加速度项 $\rho \frac{Dw}{Dt}$ 的量级远小于压力梯度项和重力项 。因此，[垂直动量方程](@entry_id:1133792)被简化为一个简单的诊断关系，即[静力平衡](@entry_id:163498)：
$$
\frac{\partial p}{\partial z} = -\rho g
$$
这个方程表明，任意深度的压力都可以通过对其上方水体的重量进行积分来确定。[静力平衡近似](@entry_id:1126281)极大地简化了控制方程组，因为它将垂直速度 $w$ 从一个需要预报的动力学变量，转变为一个可以通过不可压缩[连续性方程](@entry_id:195013) $\frac{\partial w}{\partial z} = -(\frac{\partial u}{\partial x} + \frac{\partial v}{\partial y})$ 诊断出的变量。

结合这些近似，我们得到了用于OGCMs的**原始方程组**，包括水平[动量方程](@entry_id:197225)、[静力平衡](@entry_id:163498)方程、[连续性方程](@entry_id:195013)以及温度和盐度的平流-扩散方程。

### 基本平衡与动力学

从原始方程组中，我们可以推导出描述大尺度[海洋环流](@entry_id:195237)的几个关键[动力学平衡](@entry_id:187220)。

#### 地转平衡与[热成风关系](@entry_id:192206)

在远离边界层的大洋内部，如果流动是缓慢且稳定的，水平[动量方程](@entry_id:197225)中的主要平衡发生在**科里奥利力**（Coriolis force）和**水平压力[梯度力](@entry_id:166847)**（horizontal pressure gradient force）之间。这种平衡被称为**地转平衡**（geostrophic balance）。其数学表达式为：
$$
-f v_g = -\frac{1}{\rho_0} \frac{\partial p}{\partial x}
$$
$$
f u_g = -\frac{1}{\rho_0} \frac{\partial p}{\partial y}
$$
其中 $(u_g, v_g)$ 是地转速度分量，$f$ 是科里奥利参数。地转流动沿着等压线方向，其速度与压力梯度成正比。

地转平衡和[静力平衡](@entry_id:163498)是耦合在一起的。通过将这两个平衡关系相结合，我们可以推导出**[热成风关系](@entry_id:192206)**（thermal wind relation） 。该关系描述了地转流的垂直切变如何与水平密度梯度相关联。其矢量形式为：
$$
\frac{\partial \mathbf{u}_g}{\partial z} = \frac{g}{f \rho_0} \mathbf{k} \times \nabla_h \rho
$$
这里，$\mathbf{u}_g$ 是地转[速度矢量](@entry_id:269648)，$\mathbf{k}$ 是垂直单位矢量，$\nabla_h \rho$ 是水平密度梯度。这个关系至关重要，它意味着只要我们知道海洋某一个深度的速度（例如，通过测量或假设深海静止）和整个水体的密度分布（可以通过温度和盐度测量得到），我们就可以推断出所有深度的地转环流。例如，一个大小为 $10^{-3} \ \mathrm{kg\,m^{-4}}$ 的典型中纬度海洋水平密度梯度，在科里奥利参数 $f = 10^{-4} \ \mathrm{s^{-1}}$ 的情况下，可以维持大约 $9.57 \times 10^{-2} \ \mathrm{s^{-1}}$ 的垂直[速度切变](@entry_id:267235)，这表明海洋内部密度结构的微小倾斜与强大的[速度切变](@entry_id:267235)之间存在着紧密的联系 。

#### [涡度平衡](@entry_id:1133913)与[风生环流](@entry_id:1134086)

另一个核心的[动力学平衡](@entry_id:187220)是**[涡度平衡](@entry_id:1133913)**。通过对水平[动量方程](@entry_id:197225)求旋度，我们可以得到涡度方程，它描述了流体柱相对涡度与[行星涡度](@entry_id:265327)之和（即**[势涡](@entry_id:1129997)**）的变化。对于大尺度、定常、线性的海洋[内部流动](@entry_id:155636)，[涡度平衡](@entry_id:1133913)简化为著名的**[斯维尔德鲁普平衡](@entry_id:199174)**（Sverdrup balance）。

该平衡表明，行星涡度随纬度变化的效应（由 $\beta = \partial f / \partial y$ 项表示，称为**$\beta$效应**）必须由[风应力旋度](@entry_id:1134098)的垂[直积](@entry_id:143046)分或流体柱的拉伸来平衡。在忽略海底地形和深层流动的情况下，垂向积分的涡度方程给出了经向输送 $V = \int_{-H}^{0} v \, dz$ 与海面[风应力旋度](@entry_id:1134098)之间的直接关系：
$$
\beta V = \frac{\mathrm{curl}_z(\boldsymbol{\tau}^s)}{\rho_0}
$$
其中 $\boldsymbol{\tau}^s$ 是作用在海面的风应力。这个简单的关系惊人地准确地预测了各大洋副热带环流区由风驱动的经向输送。例如，在一个典型的中纬度区域，$\beta$ 约为 $2 \times 10^{-11} \ \mathrm{m^{-1}\,s^{-1}}$，如果[风应力旋度](@entry_id:1134098)为 $-10^{-7} \ \mathrm{N\,m^{-3}}$（对应于信风和西风带之间的区域），那么斯维尔德鲁普输送将是一个朝向赤道的流动，其积分输送量约为 $-4.878 \ \mathrm{m^2\,s^{-1}}$ 。

### [状态方程](@entry_id:274378)与热力学过程

海洋的动力学过程通过**状态方程**（equation of state）$\rho(S, T, p)$ 与热力学过程紧密相连。这个方程描述了海水密度如何依赖于盐度 $S$、温度 $T$ 和压力 $p$。在绝大多数情况下，温度升高和盐度降低会使[海水密度](@entry_id:1129054)减小，而压力增大会使其密度增加。

[海水状态方程](@entry_id:1124595)的一个关键特征是其**[非线性](@entry_id:637147)**。一个线性的状态方程可能写作 $\rho = \rho_0(1 - \alpha \delta T + \beta \delta S)$，其中 $\alpha$ 是热膨胀系数，$\beta$ 是盐收缩系数。然而，真实的[状态方程](@entry_id:274378)包含高阶项，这导致了两种重要的物理现象：**盐跃**（cabbeling）和**热压效应**（thermobaricity）。

- **盐跃**：这是指当两个具有相同密度但不同温度和盐度的水团混合时，混合后的水团密度会增加的现象。这是因为密度的等值线（等密面）在 $T-S$ 图上是弯曲的。这种密度增加会导致混合水团下沉，这是形成某些深层水团的重要机制。

- **[热压](@entry_id:159509)效应**：这是指[热膨胀系数](@entry_id:150685) $\alpha$ 本身是压力的函数。在深海高压下，$\alpha$ 会减小，意味着温度对密度的影响减弱。这个效应对于深海对流和垂直混合过程的稳定性至关重要。

这些[非线性](@entry_id:637147)效应意味着，即使在没有显式混合热量或盐分的情况下，仅通过水团的重新排列就可能改变局地[浮力](@entry_id:154088)，从而影响[海洋环流](@entry_id:195237)。

#### 示踪剂收支与守恒

在OGCMs中，温度和盐度被当作**示踪剂**（tracers）处理，它们的演化遵循平流-扩散方程。模式的一个核心任务是确保这些示踪剂以及由它们衍生的其他物理量（如总盐量）在长[时间积分](@entry_id:267413)中是守恒的。然而，数值方案的选择有时会引入非物理的源或汇。

一个典型的例子是在处理海面**淡水通量**（freshwater flux，$F_{\mathrm{fw}} = P + R - E$，即降水+径流-蒸发）时采用的**虚拟盐通量**（virtual salt flux）方法 。由于许多OGCMs为了计算简便而保持总体积不变，它们无法通过直接增减水量来模拟淡水通量。取而代之的是，模式在海面添加或移除盐分来模拟淡水输入（稀释）或输出（浓缩）对盐度的影响。例如，降水会稀释表层海水，在模式中这通过从表层移除盐分来实现。

这种方法的副作用是，如果全球范围内的总淡水通量不为零（即 $\iint F_{\mathrm{fw}} \, dA \neq 0$），那么模式中的总盐量将不会守恒，会产生一个虚假的源或汇。这个虚假的全球盐质量变化率可以通过对海面虚拟盐通量的[面积分](@entry_id:275394)来诊断：
$$
\frac{dM_S}{dt} = -\rho_0 \iint_{A_s} S_{\mathrm{surf}} F_{\mathrm{fw}} \, dA
$$
其中 $S_{\mathrm{surf}}$ 是模式的表层盐度。对模式开发者和使用者而言，监测这种漂移对于评估模式的长期保真度至关重要。

### [次网格尺度过程](@entry_id:1132602)的[参数化](@entry_id:265163)

OGCMs的[计算网格](@entry_id:168560)通常是水平几十到几百公里，垂直几十到几百米。许多对[海洋环流](@entry_id:195237)至关重要的物理过程，如**[中尺度涡](@entry_id:1127814)**（mesoscale eddies，直径约10-100公里）、[湍流混合](@entry_id:202591)和对流，其尺度远小于模式的网格尺寸。这些**[次网格尺度过程](@entry_id:1132602)**（sub-grid scale processes）无法被模式直接解析，但它们对大尺度环流有重要影响。因此，必须通过**[参数化](@entry_id:265163)**（parameterization）的方式来表示它们的集体效应。

[参数化](@entry_id:265163)的基本思想是将流场通过一个滤波器分解为**已解析尺度**（resolved scale）和**次网格尺度**（sub-grid scale）两部分 。当这个滤波操作应用于[非线性](@entry_id:637147)的动量方程时，会产生一个表示[次网格尺度](@entry_id:1132591)运动与已解析尺度运动相互作用的附加项，即**次网格[应力张量](@entry_id:148973)**。[参数化](@entry_id:265163)的核心挑战（即**闭合问题**）就是将这个未知的次网格应力项表示为已知的已解析尺度变量的函数。

这种方法通常依赖于**[尺度分离假设](@entry_id:1131494)**（scale separation assumption），即假设次网格尺度的运动在时间和空间上都远小于已解析尺度。如果成立，次网格式涡旋的响应会非常快，以至于它们的统计效应可以被认为仅依赖于局地的已解析尺度流场，从而允许使用简单的局地闭合方案（如[涡粘性模型](@entry_id:1124145)）。尽管海洋能量谱通常是连续的，缺乏明显的尺度间隙，这使得[尺度分离假设](@entry_id:1131494)并不严格成立，但[参数化](@entry_id:265163)仍然是模拟气候尺度[海洋环流](@entry_id:195237)的唯一可行途径。

#### 中尺度涡的关键[参数化](@entry_id:265163)方案

[中尺度涡](@entry_id:1127814)是海洋中的“天气系统”，它们携带大量的动能，并是输运热量、盐分和生物化学物质的主要机制。在非涡分辨的OGCMs中，它们的效应必须被[参数化](@entry_id:265163)。两个最著名且被广泛应用的[参数化](@entry_id:265163)方案是Redi等密度面扩散和Gent-McWilliams（GM）厚度扩散 。

- **Redi等密度面扩散**（Isoneutral Diffusion）：物理上，涡旋主要沿着密度相等的表面（**等密度面**）来搅拌和混合示踪剂，因为跨越等密度面需要克服[浮力](@entry_id:154088)做功，[能量效率](@entry_id:272127)很低。Redi方案通过引入一个高度各向异性的扩散张量 $\mathbf{K}_R$ 来模拟这一点，该张量在沿着等密度面方向上具有很大的扩散系数，而在垂直于等密度面的方向上扩散系数几乎为零。这在数学上是一个**对称的、耗散的**算子，它会减少示踪剂梯度的方差，模拟了涡旋的搅拌效应。

- **Gent-McWilliams（GM）厚度扩散**（Thickness Diffusion）：除了搅拌，涡旋还会系统性地输运[浮力](@entry_id:154088)，从而“拉平”倾斜的等密度面，释放有效位能。[GM方案](@entry_id:1125691)通过引入一个被称为**[涡致速度](@entry_id:1124135)**或**团块速度**（bolus velocity）$\mathbf{U}^*$ 的附加平流项来表示这种效应。这个速度场是无辐散的（$\nabla \cdot \mathbf{U}^* = 0$），并且其构造方式使其能够将示踪剂（如密度）从厚层输运到薄层，从而使等密度面趋于平缓。在数学上，这对应于一个**反对称的、非耗散的**算子，它重新布置示踪剂场而不改变其方差。

在实践中，Redi和[GM方案](@entry_id:1125691)通常结合使用。[GM方案](@entry_id:1125691)负责模拟涡旋对等密度面的绝热“拉平”效应，而Redi方案则模拟沿着这些被拉平的等密度面的混合效应。这两个方案虽然只直接作用于示踪剂方程，但通过改变密度场，它们会间接改变压[力场](@entry_id:147325)，并通过压力[梯度力](@entry_id:166847)深刻地影响已解析的[海洋环流](@entry_id:195237)。

### 基础数值选择

除了[物理参数化](@entry_id:1129649)之外，一些基础的数值设计选择也从根本上决定了OGCM的行为和性能。

#### [垂直坐标系](@entry_id:1133787)

如何设计模型的[垂直坐标系](@entry_id:1133787)是OGCMs最根本的区别之一 。主要有三种选择：

1.  **$z$-坐标**（Geopotential Coordinate）：坐标面是固定的水平面。这种坐标系的优点是水平压力[梯度力](@entry_id:166847)的计算非常简单直接。其主要缺点是，复杂的海底地形必须被表示为阶梯状的“楼梯”，这无法[精确模拟](@entry_id:749142)近底边界层流动，并且当等密度面倾斜时，沿水平坐标面的平流会产生虚假的跨[等密度面混合](@entry_id:1126771)（**虚假钻石混合**）。

2.  **$\sigma$-坐标**（Terrain-Following Coordinate）：坐标面会跟随海底地形和海面起伏。其最大优点是能够平滑地表示任意复杂的海底地形，非常适合研究近岸和陆架过程。然而，它的致命弱点是在有陡峭地形的区域会产生巨大的**压力[梯度力](@entry_id:166847)误差** 。这是因为水平压力[梯度力](@entry_id:166847)在$\sigma$坐标下被计算为两个大项的微小差值。任何微小的离散误差都会被放大，产生足以驱动强大虚假流动的误差。例如，对于一个坡度为 $s=0.01$ 的斜坡，一个数值方案引入的 apparent 水平密度梯度 $\partial\rho/\partial x = 0.1 \ \mathrm{kg\,m^{-4}}$，即使在 $1 \ \mathrm{m}$ 厚的单层中，也可能产生高达 $9.57 \times 10^{-4} \ \mathrm{m\,s^{-2}}$ 的虚假加速度，这足以污染真实的动力学信号。

3.  **等密度面坐标**（Isopycnal Coordinate）：坐标面是等密度面本身。由于水流主要沿着等密度面运动，这种坐标系天然地将平流过程与混合过程分开，极大地减少了虚假钻石混合。这是其模拟长时间气候变化时的巨大优势。其缺点在于处理表层混合层（那里密度几乎均一，坐标面会消失或变得垂直）和近海底边界层（等密度面会与海底相交）时非常复杂。

#### [水平网格交错](@entry_id:1126167)

另一个基础选择是变量在水平网格上的排布方式，即**[网格交错](@entry_id:1125805)**（grid staggering）。Arakawa提出了几种经典的交错方案，其中A、B、C三种最为人所知 。

- **A-网格**：所有变量（速度分量 $u, v$ 和标量如压力 $p$）都定义在网格中心。这种方式虽然简单，但存在致命缺陷。它无法“感知”网格尺度的棋盘状压[力场](@entry_id:147325)，导致压[力场](@entry_id:147325)和速度场之间出现[数值解耦](@entry_id:752780)和噪声积累。

- **B-网格**：标量在网格中心，速度分量在网格角点。这种网格在模拟[地转适应](@entry_id:191286)过程中的[惯性重力波](@entry_id:1126476)时表现不佳。

- **C-网格**：标量在网格中心，而速度分量 $u$ 和 $v$ 分别定义在东西和南北的网格面上。这种交错方式在计算压力梯度（从中心指向面）和散度（从面指向中心）时都使用了最紧凑的差分格式。它能很好地耦合质量场和动量场，准确地模拟[地转适应](@entry_id:191286)过程，并且不会出现A-网格的棋盘状噪声问题。由于这些优良特性，**C-网格**成为了绝大多数现代OGCMs的标准选择。