{
    "hands_on_practices": [
        {
            "introduction": "A core challenge in designing any explicit Ocean General Circulation Model (OGCM) is ensuring numerical stability. The model's time step, $\\Delta t$, is not arbitrary; it is strictly limited by the fastest-propagating signals in the discretized system. This practice  asks you to calculate this critical upper bound, dictated by the Courant-Friedrichs-Lewy (CFL) condition, for the fastest waves in the deep ocean: external gravity waves.",
            "id": "4072641",
            "problem": "Consider the vertically integrated, linearized shallow-water equations that govern the external (barotropic) gravity wave dynamics in an Ocean General Circulation Model (OGCM). For small-amplitude motions over uniform depth, the external gravity waves propagate nondispersively with a phase speed determined solely by the gravitational acceleration and the ocean depth. In an explicit time-stepping scheme for these waves, numerical stability requires that the Courant–Friedrichs–Lewy (CFL) number be bounded by a fixed constant that depends on the choice of discretization; take this bound to be $0.5$ for the scheme under consideration. Using a uniform depth $H=4000\\ \\mathrm{m}$, gravitational acceleration $g=9.81\\ \\mathrm{m\\,s^{-2}}$, and horizontal grid spacing $\\Delta x=20\\ \\mathrm{km}$, determine the maximum stable explicit time step $\\Delta t$ that satisfies the CFL stability requirement. Express your final answer in seconds, and round your numerical result to four significant figures.",
            "solution": "The problem concerns the numerical stability of an explicit time-stepping scheme for simulating external (barotropic) gravity waves in an Ocean General Circulation Model (OGCM). The propagation of these waves is governed by the shallow-water equations. For small-amplitude motions in an ocean of uniform depth $H$, the phase speed $c$ of these waves is given by the well-known formula:\n$$c = \\sqrt{gH}$$\nwhere $g$ is the acceleration due to gravity.\n\nThe stability of the explicit numerical scheme is constrained by the Courant–Friedrichs–Lewy (CFL) condition. This condition relates the wave speed $c$, the time step $\\Delta t$, and the horizontal grid spacing $\\Delta x$. The CFL number, which we can denote as $\\mathcal{C}$, is defined as:\n$$\\mathcal{C} = \\frac{c \\Delta t}{\\Delta x}$$\nFor the scheme to be stable, the CFL number must not exceed a certain bound. The problem specifies this bound to be $0.5$. Therefore, the stability requirement is:\n$$\\frac{c \\Delta t}{\\Delta x} \\le 0.5$$\nTo find the maximum stable time step, denoted as $\\Delta t_{\\text{max}}$, we set the CFL number to its maximum allowed value:\n$$\\frac{c \\Delta t_{\\text{max}}}{\\Delta x} = 0.5$$\nSolving for $\\Delta t_{\\text{max}}$ yields:\n$$\\Delta t_{\\text{max}} = \\frac{0.5 \\Delta x}{c}$$\nSubstituting the expression for the phase speed $c$, we get the full expression for $\\Delta t_{\\text{max}}$ in terms of the given parameters:\n$$\\Delta t_{\\text{max}} = \\frac{0.5 \\Delta x}{\\sqrt{gH}}$$\nThe problem provides the following values:\n- Uniform depth $H = 4000\\ \\mathrm{m}$\n- Gravitational acceleration $g = 9.81\\ \\mathrm{m\\,s^{-2}}$\n- Horizontal grid spacing $\\Delta x = 20\\ \\mathrm{km}$\n\nBefore substituting the values, we must ensure all units are consistent within the SI system. We convert the grid spacing $\\Delta x$ from kilometers to meters:\n$$\\Delta x = 20\\ \\mathrm{km} = 20 \\times 10^{3}\\ \\mathrm{m} = 20000\\ \\mathrm{m}$$\nNow, we substitute the numerical values into the expression for $\\Delta t_{\\text{max}}$:\n$$\\Delta t_{\\text{max}} = \\frac{0.5 \\times 20000}{\\sqrt{9.81 \\times 4000}}\\ \\mathrm{s}$$\nFirst, we compute the term in the denominator, which is the wave speed $c$:\n$$c = \\sqrt{9.81 \\times 4000} = \\sqrt{39240} \\approx 198.09089\\ \\mathrm{m\\,s^{-1}}$$\nNow, we compute $\\Delta t_{\\text{max}}$:\n$$\\Delta t_{\\text{max}} = \\frac{10000}{198.09089} \\approx 50.48188\\ \\mathrm{s}$$\nThe problem requires the final answer to be expressed in seconds and rounded to four significant figures. Rounding the calculated value of $\\Delta t_{\\text{max}}$ to four significant figures gives:\n$$\\Delta t_{\\text{max}} \\approx 50.48\\ \\mathrm{s}$$",
            "answer": "$$\n\\boxed{50.48}\n$$"
        },
        {
            "introduction": "While maintaining stability is essential, a stable model is not necessarily an accurate one, especially when simulating the transport of properties like heat and salt. The choice of numerical scheme for advection and diffusion has profound implications for the physical realism of the solution. This exercise  delves into these nuances, using the dimensionless Courant and cell Peclet numbers to diagnose both the temporal stability and the susceptibility of a common scheme to generating unphysical spatial oscillations.",
            "id": "4072636",
            "problem": "Consider a one-dimensional zonal tracer equation representative of a horizontal slice within an Ocean General Circulation Model (OGCM) used in numerical weather prediction and climate modeling, governed by the linear advection–diffusion equation\n$$\n\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = \\kappa \\frac{\\partial^{2} c}{\\partial x^{2}},\n$$\nwhere $c$ is tracer concentration, $u$ is a constant zonal velocity, and $\\kappa$ is the constant eddy diffusivity. A model uses a uniform grid spacing $\\Delta x$ and a time step $\\Delta t$. Define the Courant number $C$ and the cell Peclet number $Pe$ in terms of $u$, $\\Delta t$, $\\Delta x$, and $\\kappa$. Starting from the governing equation and its discretization principles, perform a stability assessment for a centered-in-space advection scheme advanced with a two-time-level explicit method that is second-order in time (leapfrog), using a von Neumann analysis for the advection operator. Your assessment must identify the condition for stability and interpret the role of $Pe$ for monotonicity and potential dispersive oscillations in the presence of advection dominance.\n\nGiven the physically plausible parameters $u = 0.2\\ \\mathrm{m\\,s^{-1}}$, $\\Delta x = 10\\ \\mathrm{km}$, $\\Delta t = 600\\ \\mathrm{s}$, and $\\kappa = 50\\ \\mathrm{m^{2}\\,s^{-1}}$, compute the numerical values of the Courant number $C$ and the cell Peclet number $Pe$ from their definitions. Then, assess the stability of the centered advection under the leapfrog time discretization for these parameter values based on your derived criterion and discuss whether the flow regime indicated by $Pe$ is likely to produce non-monotone behavior without additional dissipation or upwinding.\n\nReport the final numerical values of $C$ and $Pe$ as dimensionless numbers rounded to four significant figures, and present them together as a row matrix. No units should accompany the final reported values.",
            "solution": "The problem requires a multi-part analysis: definitions of dimensionless numbers, a stability analysis of the numerical scheme, an interpretation of a parameter's role in solution quality, and a numerical calculation based on given parameters.\n\nFirst, we define the dimensionless numbers from their physical and numerical context. The Courant number, $C$, also known as the Courant-Friedrichs-Lewy (CFL) number, compares the physical speed of advection, $u$, to the numerical speed of information propagation across the grid, $\\frac{\\Delta x}{\\Delta t}$. It is defined as:\n$$\nC = \\frac{u \\Delta t}{\\Delta x}\n$$\nThe cell Peclet number, $Pe$, compares the rate of advective transport to the rate of diffusive transport across a grid cell of size $\\Delta x$. It is defined as:\n$$\nPe = \\frac{|u| \\Delta x}{\\kappa}\n$$\nGiven that $u$ is a positive constant, we can write $Pe = \\frac{u \\Delta x}{\\kappa}$.\n\nNext, we perform the von Neumann stability analysis for the advection operator, as requested. The governing equation for pure advection is:\n$$\n\\frac{\\partial c}{\\partial t} + u \\frac{\\partial c}{\\partial x} = 0\n$$\nThe problem specifies a centered-in-space difference for the advection term and a leapfrog scheme for the time advancement. Let $c_j^n$ represent the tracer concentration $c$ at grid point $j$ and time level $n$. The discretization is:\n$$\n\\frac{c_j^{n+1} - c_j^{n-1}}{2 \\Delta t} + u \\frac{c_{j+1}^n - c_{j-1}^n}{2 \\Delta x} = 0\n$$\nWe can rearrange this equation to solve for the future time step $c_j^{n+1}$:\n$$\nc_j^{n+1} = c_j^{n-1} - \\frac{u \\Delta t}{\\Delta x} (c_{j+1}^n - c_{j-1}^n)\n$$\nSubstituting the definition of the Courant number, $C$, gives:\n$$\nc_j^{n+1} = c_j^{n-1} - C (c_{j+1}^n - c_{j-1}^n)\n$$\nFor the von Neumann analysis, we assume a solution of the form of a single Fourier mode:\n$$\nc_j^n = \\hat{c}(k)^n e^{i k j \\Delta x}\n$$\nwhere $i = \\sqrt{-1}$ and $k$ is the wavenumber. Substituting this into the discretized equation:\n$$\n\\hat{c}^{n+1} e^{i k j \\Delta x} = \\hat{c}^{n-1} e^{i k j \\Delta x} - C \\left( \\hat{c}^n e^{i k (j+1) \\Delta x} - \\hat{c}^n e^{i k (j-1) \\Delta x} \\right)\n$$\nDividing by $e^{i k j \\Delta x}$ yields:\n$$\n\\hat{c}^{n+1} = \\hat{c}^{n-1} - C \\hat{c}^n \\left( e^{i k \\Delta x} - e^{-i k \\Delta x} \\right)\n$$\nUsing Euler's identity, $e^{i\\theta} - e^{-i\\theta} = 2i\\sin(\\theta)$, this simplifies to:\n$$\n\\hat{c}^{n+1} = \\hat{c}^{n-1} - 2i C \\sin(k \\Delta x) \\hat{c}^n\n$$\nLet the amplification factor be $G = \\frac{\\hat{c}^{n+1}}{\\hat{c}^n} = \\frac{\\hat{c}^n}{\\hat{c}^{n-1}}$. Substituting $G$ into the equation gives a quadratic equation for $G$:\n$$\nG^2 \\hat{c}^{n-1} = \\hat{c}^{n-1} - (2i C \\sin(k \\Delta x)) G \\hat{c}^{n-1}\n$$\n$$\nG^2 + (2i C \\sin(k \\Delta x)) G - 1 = 0\n$$\nThe solutions for $G$ are given by the quadratic formula:\n$$\nG = \\frac{-2i C \\sin(k \\Delta x) \\pm \\sqrt{(2i C \\sin(k \\Delta x))^2 - 4(1)(-1)}}{2}\n$$\n$$\nG = -i C \\sin(k \\Delta x) \\pm \\sqrt{1 - (C \\sin(k \\Delta x))^2}\n$$\nFor the scheme to be stable, the magnitude of the amplification factor must satisfy $|G| \\le 1$ for all possible wavenumbers $k$.\nIf the term under the square root is non-negative, i.e., $1 - (C \\sin(k \\Delta x))^2 \\ge 0$, then $G$ is of the form $G = -iA \\pm \\sqrt{1-A^2}$ where $A = C \\sin(k \\Delta x)$ is real. The magnitude is $|G|^2 = A^2 + (1-A^2) = 1$. This corresponds to a neutrally stable scheme. The condition for this case is $|C \\sin(k \\Delta x)| \\le 1$. Since the maximum value of $|\\sin(k \\Delta x)|$ is $1$, this requires $|C| \\le 1$.\nIf the term under the square root is negative, i.e., $1 - (C \\sin(k \\Delta x))^2 < 0$, which occurs if $|C| > 1$ for some $k$, the solution for $G$ becomes:\n$$\nG = -i C \\sin(k \\Delta x) \\pm i \\sqrt{(C \\sin(k \\Delta x))^2 - 1}\n$$\nOne of the roots will have a magnitude greater than $1$. For instance, let $\\beta = C \\sin(k \\Delta x)$ with $|\\beta| > 1$. One solution is $G = i(-\\beta - \\sqrt{\\beta^2-1})$. Its magnitude is $|G| = |\\beta| + \\sqrt{\\beta^2-1} > 1$. This corresponds to an unstable mode that grows exponentially.\nTherefore, the stability condition for the leapfrog scheme with centered-in-space differencing for advection is the CFL condition:\n$$\n|C| = \\frac{|u| \\Delta t}{\\Delta x} \\le 1\n$$\n\nThe cell Peclet number, $Pe$, does not arise in the stability analysis of the temporal scheme for pure advection. Instead, its role is to characterize the behavior of the spatial discretization when both advection and diffusion are present. For a steady-state problem, $u \\frac{\\partial c}{\\partial x} = \\kappa \\frac{\\partial^2 c}{\\partial x^2}$, a centered difference discretization yields:\n$$\nu \\frac{c_{j+1} - c_{j-1}}{2 \\Delta x} = \\kappa \\frac{c_{j+1} - 2c_j + c_{j-1}}{(\\Delta x)^2}\n$$\nMultiplying by $\\frac{(\\Delta x)^2}{\\kappa}$ and rearranging gives:\n$$\n\\frac{u \\Delta x}{\\kappa} \\frac{c_{j+1} - c_{j-1}}{2} = c_{j+1} - 2c_j + c_{j-1}\n$$\n$$\n0 = c_{j+1} \\left(1 - \\frac{Pe}{2}\\right) - 2c_j + c_{j-1} \\left(1 + \\frac{Pe}{2}\\right)\n$$\nThis forms a second-order linear homogeneous recurrence relation. For the numerical solution to be physically meaningful and not exhibit spurious, non-monotone oscillations (wiggles), it is desirable that the solution satisfies a discrete maximum principle. This requires the coefficients of the recurrence relation that determine $c_j$ from its neighbors to have the same sign. The coefficients of $c_{j+1}$ and $c_{j-1}$ must be non-negative.\n$1 - \\frac{Pe}{2} \\ge 0 \\implies Pe \\le 2$. Assuming $u>0$, $Pe$ is positive.\n$1 + \\frac{Pe}{2} \\ge 0 \\implies Pe \\ge -2$.\nThus, the condition to prevent spurious spatial oscillations is $|Pe| \\le 2$. When $|Pe| > 2$, the flow is strongly advection-dominated relative to diffusion at the grid scale. The centered difference scheme, which symmetrically samples information from upstream and downstream, is known to produce unphysical oscillations in this regime. This indicates that without some form of numerical dissipation or an upwind-biased scheme, dispersive oscillations are likely.\n\nNow, we compute the numerical values of $C$ and $Pe$ using the provided parameters:\n$u = 0.2\\ \\mathrm{m\\,s^{-1}}$\n$\\Delta x = 10\\ \\mathrm{km} = 10 \\times 10^3\\ \\mathrm{m} = 10000\\ \\mathrm{m}$\n$\\Delta t = 600\\ \\mathrm{s}$\n$\\kappa = 50\\ \\mathrm{m^{2}\\,s^{-1}}$\n\nThe Courant number is:\n$$\nC = \\frac{u \\Delta t}{\\Delta x} = \\frac{(0.2\\ \\mathrm{m\\,s^{-1}}) (600\\ \\mathrm{s})}{10000\\ \\mathrm{m}} = \\frac{120}{10000} = 0.012\n$$\nThe cell Peclet number is:\n$$\nPe = \\frac{u \\Delta x}{\\kappa} = \\frac{(0.2\\ \\mathrm{m\\,s^{-1}}) (10000\\ \\mathrm{m})}{50\\ \\mathrm{m^{2}\\,s^{-1}}} = \\frac{2000}{50} = 40\n$$\nRounding to four significant figures as requested, we have $C = 0.01200$ and $Pe = 40.00$.\n\nFinally, we assess the scheme for these parameters.\nThe stability criterion is $|C| \\le 1$. Our calculated value is $C = 0.012$. Since $0.012 \\le 1$, the time-stepping scheme is stable.\nThe criterion for avoiding non-monotone behavior is $|Pe| \\le 2$. Our calculated value is $Pe = 40$. Since $40 > 2$, the condition is strongly violated. This indicates that the physical regime is highly advection-dominated at the resolved grid scale. The use of a centered-in-space scheme for advection is therefore very likely to produce significant, non-physical dispersive oscillations in the numerical solution, particularly near regions with sharp gradients in the tracer field. The scheme is formally stable but will produce a poor-quality, oscillatory solution.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 0.01200 & 40.00 \\end{pmatrix} } $$"
        },
        {
            "introduction": "Having explored the short timescales governing numerical integration, we now turn to the vastly longer timescales that characterize the physical adjustment of the deep ocean. The equilibration of abyssal properties in response to surface forcing is an exceptionally slow process, primarily limited by weak vertical (diapycnal) mixing. This practice  uses a fundamental scaling argument based on the vertical diffusion equation to estimate this 'spin-up' timescale, providing crucial insight into the multi-millennial challenge of simulating the ocean's full climate equilibrium.",
            "id": "4072665",
            "problem": "In an Ocean General Circulation Model (OGCM), consider the abyssal ocean adjustment following an imposed large-scale surface buoyancy anomaly. Assume that the abyssal stratification adjustment is limited by small-scale diapycnal mixing and that vertical advection and rotation do not set the primary adjustment rate. Model the vertical evolution of buoyancy $b(z,t)$ by one-dimensional vertical diffusion with a constant diapycnal diffusivity $K_d$ over a water column of depth $H$:\n- The governing equation is the vertical diffusion equation for a tracer,\n$$\n\\frac{\\partial b}{\\partial t} = K_d \\frac{\\partial^2 b}{\\partial z^2}, \\quad 0 < z < H,\n$$\nwith physically appropriate boundary conditions that do not introduce additional timescales beyond those implied by $H$ and $K_d$.\n- Using first principles from this equation, determine the characteristic spin-up timescale $T$ for abyssal adjustment over the full depth $H$ in terms of $H$ and $K_d$, up to an order-one constant.\n\nThen evaluate this timescale for $H = 4000\\ \\mathrm{m}$ and $K_d = 10^{-5}\\ \\mathrm{m^2\\,s^{-1}}$. Express the final timescale in years using $1\\ \\mathrm{yr} = 365\\ \\mathrm{days}$ and $1\\ \\mathrm{day} = 86400\\ \\mathrm{s}$. Round your answer to three significant figures. Provide a brief physical interpretation of what this timescale implies for abyssal circulation spin-up in global ocean models.",
            "solution": "The abyssal adjustment limited by diapycnal mixing can be idealized by the one-dimensional vertical diffusion equation,\n$$\n\\frac{\\partial b}{\\partial t} = K_d \\frac{\\partial^2 b}{\\partial z^2},\n$$\nposed on $0<z<H$ with standard boundary conditions (for example, specified $b$ or flux at the surface and no-flux at the bottom). We seek an order-of-magnitude estimate for the characteristic time $T$ over which anomalies penetrate the full depth $H$.\n\nTwo complementary derivations lead to the same scaling:\n\n1. Dimensional analysis. The diffusion equation equates a tendency with a second spatial derivative weighted by $K_d$. Balancing a characteristic tendency magnitude $b/T$ with a diffusive term $K_d b/H^2$ yields\n$$\n\\frac{b}{T} \\sim K_d \\frac{b}{H^2} \\quad \\Rightarrow \\quad T \\sim \\frac{H^2}{K_d}.\n$$\nThis is the standard diffusive penetration timescale over distance $H$.\n\n2. Eigenmode viewpoint. Expand $b(z,t)$ in vertical eigenfunctions satisfying the boundary conditions. The slowest decaying mode has an e-folding timescale\n$$\nT_1 \\sim \\frac{1}{K_d \\lambda_1},\n$$\nwhere $\\lambda_1$ is the smallest nonzero eigenvalue of the vertical Laplacian on $[0,H]$ under the chosen boundary conditions. For typical combinations (e.g., Dirichlet-Neumann or Neumann-Neumann excluding the barotropic mode), one has $\\lambda_1 \\sim \\left(\\frac{\\pi}{H}\\right)^2$, so\n$$\nT_1 \\sim \\frac{H^2}{\\pi^2 K_d}.\n$$\nUp to an order-one constant (here $1/\\pi^2$), this agrees with $T \\sim H^2/K_d$. For an order-of-magnitude spin-up estimate, it is standard to take\n$$\nT \\sim \\frac{H^2}{K_d}.\n$$\n\nWe now evaluate this for the given parameters. Compute the timescale in seconds:\n$$\nH = 4000\\ \\mathrm{m} \\quad \\Rightarrow \\quad H^2 = (4000)^2\\ \\mathrm{m^2} = 1.6\\times 10^{7}\\ \\mathrm{m^2},\n$$\n$$\nK_d = 10^{-5}\\ \\mathrm{m^2\\,s^{-1}},\n$$\n$$\nT \\sim \\frac{H^2}{K_d} = \\frac{1.6\\times 10^{7}\\ \\mathrm{m^2}}{10^{-5}\\ \\mathrm{m^2\\,s^{-1}}} = 1.6\\times 10^{12}\\ \\mathrm{s}.\n$$\n\nConvert seconds to years using $1\\ \\mathrm{yr} = 365\\times 86400\\ \\mathrm{s} = 3.1536\\times 10^{7}\\ \\mathrm{s}$:\n$$\nT_{\\mathrm{yr}} = \\frac{1.6\\times 10^{12}\\ \\mathrm{s}}{3.1536\\times 10^{7}\\ \\mathrm{s\\,yr^{-1}}} = \\left(\\frac{1.6}{3.1536}\\right)\\times 10^{5}\\ \\mathrm{yr} \\approx 5.07\\times 10^{4}\\ \\mathrm{yr}.\n$$\nRounding to three significant figures gives $5.07\\times 10^{4}\\ \\mathrm{yr}$.\n\nInterpretation: A diapycnal mixing-limited abyssal spin-up timescale of approximately $5\\times 10^{4}$ years indicates that, with a small uniform diapycnal diffusivity $K_d = 10^{-5}\\ \\mathrm{m^2\\,s^{-1}}$, diffusive communication of surface-forced buoyancy anomalies to the ocean bottom is extremely slow. In comprehensive ocean general circulation models, this implies that the abyssal stratification and overturning will not equilibrate on centennial or even millennial integration lengths unless additional processes (such as stronger localized mixing over rough topography, boundary layer processes, or mean advection) accelerate the adjustment, or unless numerical acceleration techniques or artificially enhanced diffusivities are employed during spin-up. The estimate is an order-of-magnitude benchmark; including the precise lowest-mode factor would reduce it by a factor of $\\pi^2$, but it remains on the order of tens of thousands of years.",
            "answer": "$$\\boxed{5.07\\times 10^{4}}$$"
        }
    ]
}