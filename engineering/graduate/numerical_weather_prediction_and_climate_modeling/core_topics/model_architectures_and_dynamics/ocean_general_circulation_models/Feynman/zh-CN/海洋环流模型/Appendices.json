{
    "hands_on_practices": [
        {
            "introduction": "在运行海洋环流模型时，时间步长 $\\Delta t$ 的选择是首要的关键决策之一。这个选择并非随意的，而是受到数值稳定性的严格制约。本练习将介绍 Courant-Friedrichs-Lewy (CFL) 条件，它将时间步长、网格间距与模型中最快波动的传播速度——正压重力波——联系起来。掌握这项计算是任何数值模拟研究者必备的基础技能 。",
            "id": "4072641",
            "problem": "考虑一个海洋环流模式（OGCM）中，控制外部（正压）重力波动力学的垂向积分线性化浅水方程。对于均匀深度上的小振幅运动，外部重力波以无色散方式传播，其相速度仅由重力加速度和海洋深度决定。在针对这些波的显式时间步进格式中，数值稳定性要求 Courant–Friedrichs–Lewy (CFL) 数必须小于一个取决于离散化选择的固定常数；对于所考虑的格式，假设此上界为 $0.5$。使用均匀深度 $H=4000\\ \\mathrm{m}$、重力加速度 $g=9.81\\ \\mathrm{m\\,s^{-2}}$ 和水平网格间距 $\\Delta x=20\\ \\mathrm{km}$，确定满足 CFL 稳定性要求的最大稳定显式时间步长 $\\Delta t$。最终答案以秒为单位表示，并将数值结果四舍五入至四位有效数字。",
            "solution": "该问题要求计算在海洋环流模式（OGCM）中模拟外部重力波的最大稳定显式时间步长 $\\Delta t$。求解过程涉及应用 Courant–Friedrichs–Lewy (CFL) 稳定性条件。\n\n首先，我们确定系统中最快波的传播速度，即外部（正压）重力波。对于一个均匀深度为 $H$ 的浅水系统，这些波的相速度 $c$ 由以下公式给出：\n$$c = \\sqrt{gH}$$\n其中 $g$ 是重力加速度。\n\n接下来，我们建立显式时间步进格式的 CFL 稳定性条件。CFL 数 $\\mathcal{C}$ 定义为波在一个时间步内传播的距离与网格间距之比：\n$$\\mathcal{C} = \\frac{c \\Delta t}{\\Delta x}$$\n其中 $\\Delta t$ 是时间步长，$\\Delta x$ 是水平网格间距。为使数值格式稳定，CFL 数必须小于或等于一个特定的常数，该常数取决于数值离散化的具体细节。问题中指出该上界为 $0.5$。因此，稳定性判据为：\n$$\\frac{c \\Delta t}{\\Delta x} \\le 0.5$$\n为了找到最大稳定时间步长（我们记为 $\\Delta t_{\\text{max}}$），我们将 CFL 数设为其允许的最大值：\n$$\\frac{c \\Delta t_{\\text{max}}}{\\Delta x} = 0.5$$\n求解 $\\Delta t_{\\text{max}}$ 可得：\n$$\\Delta t_{\\text{max}} = \\frac{0.5 \\Delta x}{c}$$\n将波速表达式 $c = \\sqrt{gH}$ 代入此方程，我们得到用给定的物理和数值参数表示的最大时间步长公式：\n$$\\Delta t_{\\text{max}} = \\frac{0.5 \\Delta x}{\\sqrt{gH}}$$\n问题提供了以下数值：\n- 均匀深度 $H = 4000\\ \\mathrm{m}$\n- 重力加速度 $g = 9.81\\ \\mathrm{m\\,s^{-2}}$\n- 水平网格间距 $\\Delta x = 20\\ \\mathrm{km}$\n\n为进行计算，所有量的单位必须统一为国际单位制（SI）。我们将网格间距 $\\Delta x$ 从千米转换为米：\n$$\\Delta x = 20\\ \\mathrm{km} = 20 \\times 10^{3}\\ \\mathrm{m} = 20000\\ \\mathrm{m}$$\n现在，我们将给定的数值代入 $\\Delta t_{\\text{max}}$ 的方程中：\n$$\\Delta t_{\\text{max}} = \\frac{0.5 \\times 20000}{\\sqrt{9.81 \\times 4000}}$$\n结果的单位将是秒。我们来计算这个表达式。首先是分母（波速）：\n$$\\sqrt{9.81 \\times 4000} = \\sqrt{39240} \\approx 198.09089\\ \\mathrm{m\\,s^{-1}}$$\n分子是 $0.5 \\times 20000 = 10000$。\n因此，最大时间步长为：\n$$\\Delta t_{\\text{max}} = \\frac{10000}{198.09089} \\approx 50.48188\\ \\mathrm{s}$$\n问题要求最终答案四舍五入到四位有效数字。将 $50.48188$ 四舍五入到四位有效数字得到 $50.48$。",
            "answer": "$$\n\\boxed{50.48}\n$$"
        },
        {
            "introduction": "在确定了数值稳定性所需的极短时间步长之后，理解海洋物理过程运行在截然不同且更为漫长的时间尺度上至关重要。本练习将探讨深海的“启动” (spin-up) 时间尺度，该尺度由垂直混合等缓慢过程所控制。这项计算凸显了气候模拟中的一个主要挑战：要将模型运行足够长的时间以模拟深海的完全平衡，需要巨大的计算成本 。",
            "id": "4072665",
            "problem": "在一个海洋环流通用模型（OGCM）中，考虑在一个施加的大尺度表面浮力异常之后，深海的调整过程。假设深海层结调整受到小尺度跨等密度面混合的限制，并且垂直平流和旋转不决定主要的调整速率。使用一个深度为 $H$ 的水柱上具有恒定跨等密度面扩散系数 $K_d$ 的一维垂直扩散模型来模拟浮力 $b(z,t)$ 的垂直演变：\n- 控制方程是示踪物的垂直扩散方程，\n$$\n\\frac{\\partial b}{\\partial t} = K_d \\frac{\\partial^2 b}{\\partial z^2}, \\quad 0  z  H,\n$$\n其边界条件在物理上是合适的，并且除了由 $H$ 和 $K_d$ 蕴含的时间尺度外，不引入额外的时间尺度。\n- 根据该方程的第一性原理，确定在整个深度 $H$ 上深海调整的特征启动时间尺度 $T$，用 $H$ 和 $K_d$ 表示，其结果可相差一个量级为1的常数。\n\n然后，对于 $H = 4000\\ \\mathrm{m}$ 和 $K_d = 10^{-5}\\ \\mathrm{m^2\\,s^{-1}}$，计算该时间尺度。使用 $1\\ \\mathrm{yr} = 365\\ \\mathrm{days}$ 和 $1\\ \\mathrm{day} = 86400\\ \\mathrm{s}$，将最终的时间尺度以年为单位表示。将你的答案四舍五入到三位有效数字。简要地物理解释这个时间尺度对于全球海洋模型中深海环流启动的意义。",
            "solution": "该问题要求推导并计算由垂直扩散控制的深海调整的特征时间尺度。\n\n**1. 时间尺度的推导**\n控制方程为一维扩散方程：\n$$ \\frac{\\partial b}{\\partial t} = K_d \\frac{\\partial^2 b}{\\partial z^2} $$\n我们可以通过量纲分析来确定特征时间尺度 $T$。令 $[X]$ 表示物理量 $X$ 的量纲。\n- 方程左边的量纲为 $[\\text{浮力}]/[\\text{时间}]$，即 $\\frac{[b]}{T}$。\n- 方程右边的量纲为 $[\\text{扩散系数}] \\times [\\text{浮力}] / [\\text{长度}]^2$，即 $\\frac{[K_d] [b]}{H^2}$，其中 $H$ 是特征垂直长度尺度（海洋深度）。\n为了使方程成立，两边的量纲必须匹配，因此我们得到以下标度关系：\n$$ \\frac{1}{T} \\sim \\frac{K_d}{H^2} $$\n由此，特征时间尺度 $T$ 为：\n$$ T \\sim \\frac{H^2}{K_d} $$\n这个时间尺度物理上代表了扩散信号穿透整个深度 $H$ 所需的时间。\n\n**2. 数值计算**\n根据问题给出的数值：\n- 深度 $H = 4000\\ \\mathrm{m}$\n- 跨等密度面扩散系数 $K_d = 10^{-5}\\ \\mathrm{m^2\\,s^{-1}}$\n\n将这些值代入时间尺度公式：\n$$ T = \\frac{(4000\\ \\mathrm{m})^2}{10^{-5}\\ \\mathrm{m^2\\,s^{-1}}} = \\frac{1.6 \\times 10^7\\ \\mathrm{m^2}}{10^{-5}\\ \\mathrm{m^2\\,s^{-1}}} = 1.6 \\times 10^{12}\\ \\mathrm{s} $$\n\n**3. 单位换算**\n问题要求将结果以年为单位表示。使用换算关系 $1\\ \\mathrm{yr} = 365\\ \\mathrm{days}$ 和 $1\\ \\mathrm{day} = 86400\\ \\mathrm{s}$：\n$$ T_{\\text{年}} = \\frac{1.6 \\times 10^{12}\\ \\mathrm{s}}{365 \\times 86400\\ \\mathrm{s/yr}} = \\frac{1.6 \\times 10^{12}}{31536000}\\ \\mathrm{yr} \\approx 50735.6\\ \\mathrm{yr} $$\n\n**4. 结果与物理解释**\n将结果四舍五入到三位有效数字，得到 $5.07 \\times 10^4$ 年。\n\n这个巨大的时间尺度意味着深海对表面强迫（例如由气候变化引起的强迫）的调整过程极其缓慢。为了达到完全的平衡态，一个OGCM需要积分数万个模式年，这对大多数气候预测研究来说计算成本过高。这凸显了海洋的“长时记忆”特性以及模拟其完全平衡响应所面临的挑战。",
            "answer": "$$\\boxed{5.07\\times 10^{4}}$$"
        },
        {
            "introduction": "海洋环流模型 (OGCM) 建立在基本的物理原理之上。本练习使用一个概念模型来演示这些原理如何决定模拟海洋的大尺度结构。通过将风应力强迫和跨等密度面混合与经向翻转环流的强度和结构联系起来，本练习有助于深入理解一个关键的模型参数——跨等密度面扩散系数——是如何控制模拟中的温跃层深度和深海层结的 。",
            "id": "4072627",
            "problem": "要求您设计并实现一个自洽的敏感性实验，用于一个概念性的海洋大循环模型，该实验旨在分离背景跨等密度面扩散率的作用。目标是量化改变背景跨等密度面扩散率如何影响翻转环流的垂直结构和深层层化，同时保持风生强迫固定。\n\n从适用于海洋中大尺度、旋转、层化流的第一性原理出发，使用以下基础：\n\n- 质量守恒以及风生上升流与内部跨等密度面混合之间的稳态经向翻转平衡。\n- 密度跃层中示踪剂的一维稳态平流-扩散平衡。\n- 在布辛涅斯克近似和静力近似下，纬向重入通道中风生输运的埃克曼理论。\n\n对于一个为全球翻转环流供水的单半球、纬向重入的南大洋通道，假设给定以下物理常数和参数：\n\n- 背景跨等密度面扩散率，$K_d$（将在测试套件中变化），单位为 $\\mathrm{m^2\\,s^{-1}}$。\n- 海水参考密度，$\\rho_0 = 1027\\ \\mathrm{kg\\,m^{-3}}$。\n- 重力加速度，$g = 9.81\\ \\mathrm{m\\,s^{-2}}$。\n- 热膨胀系数，$\\alpha = 2.0\\times 10^{-4}\\ \\mathrm{K^{-1}}$。\n- 代表南大洋的科里奥利参数，$f = -1.0\\times 10^{-4}\\ \\mathrm{s^{-1}}$。\n- 重入通道的纬向宽度，$W = 2.0\\times 10^{7}\\ \\mathrm{m}$。\n- 纬向风应力大小，$\\tau = 0.20\\ \\mathrm{N\\,m^{-2}}$。\n- 参与跨等密度面混合的有效深海面积，$A = 3.0\\times 10^{14}\\ \\mathrm{m^{2}}$。\n- 表层-深层温差，$\\Delta T = 15\\ \\mathrm{K}$。\n\n实验要求您：\n\n1.  运用地球物理流体动力学，根据埃克曼理论和几何形状估算风生体积输运 $Q_{\\mathrm{wind}}$。以 $\\mathrm{m^3\\,s^{-1}}$ 为单位表示 $Q_{\\mathrm{wind}}$。\n2.  使用一个稳态质量平衡，将风生上升流与内部跨等密度面上升流等同起来，以推断密度跃层厚度 $D$（单位为米）和翻转强度 $\\Psi$（单位为斯维尔德鲁普，其中 $1\\ \\mathrm{Sv} = 10^{6}\\ \\mathrm{m^3\\,s^{-1}}$）。\n3.  使用密度跃层中温度的稳态平流-扩散标度关系，通过浮力频率平方 $N^{2}$（单位为 $\\mathrm{s^{-2}}$）估算深层层化。\n\n您的程序必须将此推理应用于以下 $K_d$ 值的测试套件，单位均为 $\\mathrm{m^2\\,s^{-1}}$：\n\n- 理想情况：$K_d = 3.0\\times 10^{-5}$。\n- 下限：$K_d = 1.0\\times 10^{-5}$。\n- 上限：$K_d = 1.0\\times 10^{-4}$。\n\n对于每个测试用例，计算并返回一个包含三个浮点数的三元组：\n\n- 密度跃层厚度 $D$，单位为米。\n- 翻转强度 $\\Psi$，单位为斯维尔德鲁普。\n- 深层层化 $N^2$，单位为 $\\mathrm{s^{-2}}$。\n\n您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的三元组列表。例如：“[[D1,Psi1,N21],[D2,Psi2,N22],[D3,Psi3,N23]]”，其中 $D$ 的单位是米，$\\Psi$ 的单位是斯维尔德鲁普，$N^2$ 的单位是 $\\mathrm{s^{-2}}$。不应打印任何其他文本。\n\n科学真实性要求：仅使用指定的常数，并假设在稳态条件下，一个单一的翻转环流由风生上升流和背景跨等密度面混合的平衡维持。除上述基本原理外，不要引入额外的闭合关系。您的实现必须在数值上一致且对单位敏感。",
            "solution": "该问题要求为一个概念性的海洋大循环模型设计一个敏感性实验。目标是量化变化的背景跨等密度面扩散率 $K_d$ 对密度跃层厚度、翻转强度和深层层化的影响。该分析将基于地球物理流体动力学的第一性原理，特别是稳态经向翻转平衡、示踪剂的平流-扩散平衡以及埃克曼理论。\n\n该模型基于一种平衡：全球经向翻转环流的强度由纬向重入的南大洋通道上的风强迫设定，而海洋内部结构通过跨等密度面混合来适应这种强迫。\n\n推导按规定的三个步骤进行。\n\n**1. 估算风生体积输运和翻转强度 ($\\Psi$)**\n\n该模型中翻转强度的基础是南大洋的风生埃克曼输运。根据埃克曼理论，在旋转坐标系中施加于海洋表面的纬向风应力 $\\tau_x$ 会驱动一个在表层埃克曼层内积分的经向输运。单位纬向距离的经向体积输运 $M_y$ 由下式给出：\n\n$$M_y = \\frac{\\tau_x}{\\rho_0 f}$$\n\n其中 $\\rho_0$ 是海水的参考密度，$f$ 是科里奥利参数。\n\n对于指定的单半球、纬向重入的南大洋通道，我们考虑西风，因此纬向应力 $\\tau_x$ 为正，且等于给定的大小 $\\tau$。在南半球，科里奥利参数 $f$ 为负。这导致了向北的埃克曼输运。这些被驱动向北离开通道的表层水必须由下方深层水的上升流来补充。\n\n总体积输运 $Q_{\\mathrm{wind}}$ 通过将 $M_y$ 乘以通道的纬向宽度 $W$ 得到。翻转环流的强度 $\\Psi$ 由这个总风生上升流的大小决定：\n\n$$\\Psi = |Q_{\\mathrm{wind}}| = \\left| \\frac{\\tau W}{\\rho_0 f} \\right| = \\frac{\\tau W}{\\rho_0 |f|}$$\n\n在这个概念框架中，翻转强度 $\\Psi$ 完全由外部参数（风应力和几何形状）决定，并且与海洋内部的扩散率 $K_d$ 无关。我们可以使用提供的常数计算其值：\n\n- $\\tau = 0.20\\ \\mathrm{N\\,m^{-2}}$\n- $W = 2.0\\times 10^{7}\\ \\mathrm{m}$\n- $\\rho_0 = 1027\\ \\mathrm{kg\\,m^{-3}}$\n- $|f| = |-1.0\\times 10^{-4}\\ \\mathrm{s^{-1}}| = 1.0\\times 10^{-4}\\ \\mathrm{s^{-1}}$\n\n$$\\Psi = \\frac{(0.20\\ \\mathrm{kg\\,m^{-1}\\,s^{-2}}) \\times (2.0\\times 10^{7}\\ \\mathrm{m})}{(1027\\ \\mathrm{kg\\,m^{-3}}) \\times (1.0\\times 10^{-4}\\ \\mathrm{s^{-1}})} \\approx 3.895 \\times 10^7\\ \\mathrm{m^3\\,s^{-1}}$$\n\n转换为斯维尔德鲁普（$1\\ \\mathrm{Sv} = 10^6\\ \\mathrm{m^3\\,s^{-1}}$），翻转强度为：\n\n$$\\Psi \\approx 38.95\\ \\mathrm{Sv}$$\n\n**2. 估算密度跃层厚度 ($D$)**\n\n问题假设存在一个稳态质量平衡，其中翻转输运 $\\Psi$ 与海洋内部的跨等密度面混合相平衡。由混合引起的总向上输运 $Q_{mix}$ 可以表示为一个有效的跨等密度面上升流速度 $w_{mix}$ 与该混合作用的深海面积 $A$ 的乘积。\n\n$$Q_{mix} = w_{mix} A$$\n\n上升流速度 $w_{mix}$ 可以从密度跃层中示踪剂（如温度或密度）的一维稳态平流-扩散平衡中标度出来：\n\n$$w_{mix} \\frac{\\partial \\phi}{\\partial z} = K_d \\frac{\\partial^2 \\phi}{\\partial z^2}$$\n\n其中 $\\phi$ 是示踪剂浓度，$z$ 是垂直坐标。在一个厚度为 $D$、特征示踪剂差异为 $\\Delta \\phi$ 的密度跃层上对导数进行标度，我们有 $\\frac{\\partial \\phi}{\\partial z} \\sim \\frac{\\Delta \\phi}{D}$ 和 $\\frac{\\partial^2 \\phi}{\\partial z^2} \\sim \\frac{\\Delta \\phi}{D^2}$。该平衡给出了垂直速度的标度关系：\n\n$$w_{mix} \\sim \\frac{K_d}{D}$$\n\n因此，总的跨等密度面输运为 $\\Psi = Q_{mix} \\approx \\frac{K_d A}{D}$。由于 $\\Psi$ 已经由风强迫确定，我们可以解出密度跃层厚度 $D$，它必须调整以满足这个平衡：\n\n$$D = \\frac{K_d A}{\\Psi}$$\n\n该方程表明，密度跃层厚度与背景跨等密度面扩散率 $K_d$ 成正比。\n\n**3. 估算深层层化 ($N^2$)**\n\n深层层化由浮力频率的平方 $N^2$ 来量化，其定义为：\n\n$$N^2 = -\\frac{g}{\\rho_0} \\frac{\\partial \\rho}{\\partial z}$$\n\n其中 $g$ 是重力加速度。假设一个由温度主导的线性状态方程 $\\rho \\approx \\rho_0(1 - \\alpha (T - T_{ref}))$，其中 $\\alpha$ 是热膨胀系数，密度梯度可以与温度梯度关联起来：$\\frac{\\partial \\rho}{\\partial z} = -\\rho_0 \\alpha \\frac{\\partial T}{\\partial z}$。将此代入 $N^2$ 的定义中得到：\n\n$$N^2 = g \\alpha \\frac{\\partial T}{\\partial z}$$\n\n跨越厚度为 $D$ 且表层-深层温差为 $\\Delta T$ 的密度跃层的垂直温度梯度 $\\frac{\\partial T}{\\partial z}$ 可以标度为：\n\n$$\\frac{\\partial T}{\\partial z} \\sim \\frac{\\Delta T}{D}$$\n\n因此，层化可以估算为：\n\n$$N^2 = \\frac{g \\alpha \\Delta T}{D}$$\n\n通过代入上一步得到的 $D$ 的表达式，我们可以看到层化对扩散率 $K_d$ 的直接依赖关系：\n\n$$N^2 = \\frac{g \\alpha \\Delta T \\Psi}{K_d A}$$\n\n这个结果在物理上是直观的：更强的跨等密度面混合（更大的 $K_d$）导致更厚的密度跃层（更大的 $D$），从而导致更弱的垂直层化（更小的 $N^2$）。\n\n这些推导出的公式将针对 $K_d$ 测试套件中的每个值进行实现。",
            "answer": "[[231.07, 38.95, 1.274e-4], [77.02, 38.95, 3.821e-4], [770.24, 38.95, 3.821e-5]]"
        }
    ]
}