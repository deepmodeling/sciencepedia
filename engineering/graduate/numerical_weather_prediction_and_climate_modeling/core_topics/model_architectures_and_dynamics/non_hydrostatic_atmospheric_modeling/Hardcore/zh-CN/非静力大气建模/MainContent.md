## 引言
非静力大气模型是现代高分辨率天气预报和地球系统科学的基石。对于那些以剧烈垂直运动为特征的大气现象，如雷暴、地形诱发的强风和热带[气旋](@entry_id:262310)的核心区域，传统的[静力平衡](@entry_id:163498)模型已无能为力。本文旨在填补从[静力平衡](@entry_id:163498)到完全非静力动力学之间的知识鸿沟，系统性地揭示[非静力模型](@entry_id:1128852)背后的物理原理、数学框架及其在众多科学问题中的应用。读者将通过本文的学习，深入理解控制非静力流动的核心机制，探索其在气象学及其他学科中的广泛应用，并接触到验证和应用这些模型的实践方法。

文章将分为三个主要部分。我们首先在“原理与机制”一章中，详细剖析非静力控制方程组、[静力平衡](@entry_id:163498)的失效条件以及关键的物理驱动力。接着，在“应用与跨学科联系”一章中，我们将展示这些模型如何用于模拟从对流风暴到[海洋环流](@entry_id:195237)等真实世界现象。最后，在“动手实践”部分，我们将通过一系列精心设计的问题，将理论知识转化为解决实际问题的能力。

## 原理与机制

本章旨在深入探讨非静力大气模型的物理原理与核心机制。在前一章介绍其基本概念和应用领域的基础上，我们将系统地阐述控制非静力过程的数学方程，剖析[静力平衡近似](@entry_id:1126281)的适用边界及其失效的物理条件，并详细介绍驱动非静力运动的关键物理机制。此外，我们还将讨论在数值求解这些方程组时所采用的各种近似方法和先进算法，为读者构建一个从理论基础到实践应用的完整知识框架。

### 非静力控制方程组

非静力大气模型的核心是一套描述流体运动和热力学过程的[偏微分方程组](@entry_id:172573)。这套方程组源于质量守恒、[动量守恒](@entry_id:149964)（牛顿第二定律）和能量守恒（热力学第一定律）三大基本物理定律。

对于一个可压缩、旋转的湿润大气，在[笛卡尔坐标系](@entry_id:169789)下，其完整的非静力控制方程组可以表达为以下守恒形式（或称通量形式），这对于构建保持质量、动量和能量守恒的数值格式至关重要 。

1.  **[质量守恒](@entry_id:204015)方程（[连续性方程](@entry_id:195013)）**：该方程表明，控制体内密度的[局部变化率](@entry_id:264961)等于通过其边界的质量通量的散度。
    $$
    \frac{\partial \rho}{\partial t} + \nabla \cdot (\rho \boldsymbol{v}) = 0
    $$
    其中 $\rho$ 是大气密度，$\boldsymbol{v} = (u, v, w)$ 是三维[速度矢量](@entry_id:269648)。

2.  **动量守恒方程**：该方程描述了作用在流体微元上的所有力如何改变其动量。在随地球旋转的参考系中，方程包含[惯性力](@entry_id:169104)、压力[梯度力](@entry_id:166847)、重力、科里奥利力以及由分子黏性和次网格尺度湍流混合引起的黏性应力。
    $$
    \frac{\partial (\rho \boldsymbol{v})}{\partial t} + \nabla \cdot (\rho \boldsymbol{v} \otimes \boldsymbol{v} + p \boldsymbol{I} - \boldsymbol{\tau}) = - 2 \rho (\boldsymbol{\Omega} \times \boldsymbol{v}) - \rho \nabla \Phi
    $$
    此处，$\rho \boldsymbol{v}$ 是[动量密度](@entry_id:271360)，$\rho \boldsymbol{v} \otimes \boldsymbol{v}$ 是动量的平流输运张量，$p$ 是压力，$\boldsymbol{I}$ 是单位张量，$\boldsymbol{\tau}$ 是黏性[应力张量](@entry_id:148973)，$\boldsymbol{\Omega}$ 是[地球自转](@entry_id:166596)角速度矢量，$\Phi$ 是重力势（通常简化为 $\Phi = gz$，其中 $g$ 是重力加速度）。与用于全球尺度模型、忽略了垂直方向惯性项的原始静力方程组不同，此处的动量方程是一个包含所有三个分量 $(u, v, w)$ 的[预报方程](@entry_id:1130221)，特别是它直接预报了垂直速度 $w$ 的变化 。

3.  **[热力学](@entry_id:172368)[能量守恒方程](@entry_id:748978)**：该方程描述了系统内能的变化。在气象学中，通常使用位温 $\theta$ 作为预报变量，因为它在干[绝热过程](@entry_id:138150)中是守恒的。包含非绝热加热（如潜热释放、辐射）和[热扩散](@entry_id:148740)时，其守恒形式为：
    $$
    \frac{\partial (\rho \theta)}{\partial t} + \nabla \cdot (\rho \theta \boldsymbol{v}) = \rho \frac{\dot{q}}{c_p \pi} + \nabla \cdot (K_\theta \nabla \theta)
    $$
    这里，$\dot{q}$ 是单位质量的非绝热加热率，$c_p$ 是干空气定压比热，$K_\theta$ 是[热扩散](@entry_id:148740)系数。位温 $\theta$、[绝对温度](@entry_id:144687) $T$ 和压力 $p$ 通过艾克纳函数 $\pi = (p/p_0)^{R/c_p}$ 联系在一起，即 $T = \theta \pi$。其中 $p_0$ 是参考气压，$R$ 是气体常数。

4.  **水汽守恒方程**：对于湿润大气，还需要追踪水汽[比湿](@entry_id:1132076) $q_v$ 的演变。水汽被视为一个被流体输运的示踪物，其守恒方程为：
    $$
    \frac{\partial (\rho q_v)}{\partial t} + \nabla \cdot (\rho q_v \boldsymbol{v}) = \nabla \cdot (\rho K_q \nabla q_v) + S_{q_v}
    $$
    其中 $K_q$ 是水汽的扩散系数，$S_{q_v}$ 代表[相变过程](@entry_id:147919)（如蒸发、凝结）产生的源汇项 。

这套完整的方程组能够描述大气中包括声波在内的所有尺度的运动。

### 静力平衡近似及其失效

在天气和气候科学的许多领域，特别是大尺度动力学中，一个核心的简化是**静力平衡近似（hydrostatic approximation）**。

#### [静力平衡](@entry_id:163498)的定义

[静力平衡](@entry_id:163498)假设垂直方向的压力[梯度力](@entry_id:166847)与重力精确平衡。这意味着在[垂直动量方程](@entry_id:1133792)中，垂直加速度项（$Dw/Dt$）被忽略不计。[垂直动量方程](@entry_id:1133792)
$$
\rho \frac{Dw}{Dt} = -\frac{\partial p}{\partial z} - \rho g + (\text{黏性力})_z
$$
被简化为一个诊断关系 ：
$$
\frac{\partial p}{\partial z} = -\rho g
$$
这个近似极大地简化了控制方程组，因为它将垂直速度 $w$ 从一个预报变量变成了一个可以通过其他场的散度诊断出的变量，并且有效滤除了[垂直传播](@entry_id:204688)的声波。因此，几乎所有的大尺度全球天气预报和气候模型都基于[静力平衡](@entry_id:163498)假设。

#### [静力平衡](@entry_id:163498)的失效判据

然而，当大气的垂直运动非常剧烈时，垂直加速度变得不可忽略，静力平衡近似便会失效。此时，必须使用完整的非静力方程组。那么，如何定量地判断何时需要考虑非静力效应呢？这需要通过尺度分析来完成。

垂直加速度的主要贡献来自于[物质导数](@entry_id:262900) $Dw/Dt = \partial w/\partial t + \boldsymbol{v} \cdot \nabla w$。考虑一个典型的强对流过程，如深厚积云，其特征垂直速度为 $W \sim 10 \, \text{m s}^{-1}$，垂直尺度为 $H \sim 10 \, \text{km}$。垂直平流项 $w \partial w / \partial z$ 的量级可以估计为 $W^2/H$。
$$
\left| w \frac{\partial w}{\partial z} \right| \sim \frac{W^2}{H} = \frac{(10 \, \text{m s}^{-1})^2}{10^4 \, \text{m}} = 10^{-2} \, \text{m s}^{-2}
$$
这个垂直加速度虽然远小于重力加速度 $g \approx 9.8 \, \text{m s}^{-2}$，但这并非判断[静力平衡](@entry_id:163498)是否有效的正确比较方式。在[静力平衡](@entry_id:163498)中，重力 $g$ 几乎完全被背景场的压力梯度所平衡。驱动垂直运动的是各种扰动力（如[浮力](@entry_id:154088)）的净效果。在对流云团中，典型的[浮力](@entry_id:154088)加速度量级在 $10^{-2}$ 到 $10^{-1} \, \text{m s}^{-2}$ 之间。可以看到，垂直加速度 $W^2/H$ 与驱动运动的[浮力](@entry_id:154088)加速度大小相当。因此，在这种情况下，垂直加速度是[动力学平衡](@entry_id:187220)中的一个[主导项](@entry_id:167418)，忽略它将导致对垂直运动的严重误判。这表明，对于深对流等现象，[非静力模型](@entry_id:1128852)是必需的 。

我们可以将这一判据推广到更一般的形式。通过尺度分析，可以导出垂直加速度与[浮力](@entry_id:154088)的量级之比。考虑一个特征水平速度为 $U$、水平尺度为 $L$、垂直尺度为 $H$、[浮力](@entry_id:154088)尺度为 $B$ 的流动。由[连续性方程](@entry_id:195013)可得，特征垂直速度 $W \sim U(H/L)$。因此，垂直加速度的量级为 $W^2/H \sim U^2 H/L^2$。该加速度与[浮力](@entry_id:154088) $B$ 的比值为：
$$
\text{Ratio} \sim \frac{U^2 H}{B L^2}
$$
若定义一个基于[浮力](@entry_id:154088)的[弗劳德数](@entry_id:271895)（Froude number）$Fr = U/\sqrt{BH}$，这个比值可以表示为流动的几何**[长宽比](@entry_id:177707)（aspect ratio）** $H/L$ 和[弗劳德数](@entry_id:271895)的函数 ：
$$
\text{Ratio} \sim Fr^2 \left(\frac{H}{L}\right)^2
$$
当这个比值远小于1时，静力平衡近似成立；当其接近或大于1时，非静力效应显著。对于大尺度天气系统，$H/L \ll 1$，因此静力近似通常有效。而对于中尺度或小尺度系统（如雷暴、地形波），$H/L$ 可能接近1，此时非静力效应变得至关重要。

另一个重要的判据出现在稳定[分层流体](@entry_id:181098)绕过障碍物（如山脉）的情景中。此时，大气的恢复力由其层结稳定性决定，其[特征频率](@entry_id:911376)为**[布伦特-维萨拉频率](@entry_id:1121902)（Brunt–Väisälä frequency）** $N$。当流动的[特征速度](@entry_id:165394) $U$ 足够大，使得流体粒子没有足够时间对障碍物做出准静力调整时，非静力效应就会显现。这个[临界条件](@entry_id:201918)可以通过比较平流时间尺度 $H/U$ 和[浮力](@entry_id:154088)振荡周期 $1/N$ 来得到。当 $H/U \sim 1/N$ 时，非静力效应开始主导。这导出了一个[临界流](@entry_id:275258)速 $U_{\text{crit}} = NH$。当 $U \ge U_{\text{crit}}$ 时，流动被认为是高度非静力的。例如，对于典型的大气参数 $N \sim 0.01 \, \text{s}^{-1}$ 和 $H \sim 10 \, \text{km}$，[临界速度](@entry_id:161155)为 $U_{\text{crit}} = 100 \, \text{m s}^{-1}$。这说明，对于典型的天气流速（如 $10 \, \text{m s}^{-1}$），绕山气流通常是准静力的，但对于高速急流或更陡峭的地形，非静力效应可能变得重要 。

### 非静力流动的关键物理机制

在非静力流动中，垂直加速度由两个主要的力驱动：**[浮力](@entry_id:154088)（buoyancy）** 和 **扰动压力[梯度力](@entry_id:166847)（perturbation pressure gradient force）**。

#### [浮力](@entry_id:154088)：垂直运动的局地驱动力

[浮力](@entry_id:154088)是流体微元因其与周围环境存在密度差异而受到的净垂直力。根据[阿基米德原理](@entry_id:138402)，当一个流体微元的密度小于其环境密度时，它会受到向上的[浮力](@entry_id:154088)，反之则受到向下的力。在非静力[垂直动量方程](@entry_id:1133792)中，这一项表现为 $b = -g (\rho'/\rho_0)$，其中 $\rho'$ 是[密度扰动](@entry_id:159546)，$\rho_0$ 是背景密度。

在湿润大气中，密度不仅受温度影响，还受水汽含量的影响（水汽比干空气轻）。为了同时考虑温度和湿度的影响，我们引入**[虚位温](@entry_id:1133825)（virtual potential temperature）** $\theta_v$。[虚位温](@entry_id:1133825)是一个修正后的位温，它代表了具有相同密度和压力的干空气所应有的位温。一个空气微元的 $\theta_v$ 越高，其密度就越低。因此，[浮力](@entry_id:154088)可以精确地表示为[虚位温](@entry_id:1133825)扰动 $\theta_v'$ 的函数 ：
$$
b \approx g \frac{\theta_v'}{\theta_{v0}}
$$
这个关系揭示了驱动对流的直接物理机制：
- **潜热释放**：当水蒸气凝结成云滴时，会释放大量潜热，显著增加空气微元的温度和位温，从而增加 $\theta_v$ 并产生强大的向上[浮力](@entry_id:154088)。
- **水汽效应**：即使在凝结发生前，富含水汽的空气微元本身就比同温度的干空气密度小，这也会贡献一部分正[浮力](@entry_id:154088)。
- **凝结物拖曳**：云中形成的雨滴、冰晶等水成物会增加空气微元的总重量，产生一个向下的负[浮力](@entry_id:154088)，从而抑制上升运动。

因此，[浮力](@entry_id:154088)是驱动[热对流](@entry_id:144912)（如雷暴、热泡）等非静力现象的**局地（local）** 核心驱动力。

#### 扰动压力：垂直运动的非局地调节器

如果垂直运动完全由[浮力](@entry_id:154088)决定，那么上升运动将无限加速，且仅限于[浮力](@entry_id:154088)为正的区域。然而，实际情况并非如此。另一个关键角色是**扰动压力** $p'$。

在[非静力模型](@entry_id:1128852)中，总压力 $p$ 被分解为一个只随高度变化的[静力平衡](@entry_id:163498)背景场 $\bar{p}(z)$ 和一个三维时变扰动场 $p'$，即 $p = \bar{p}(z) + p'$。背景压力梯度与背景重力平衡。因此，驱动流体加速的是扰动压力梯度和[浮力](@entry_id:154088)。[垂直动量方程](@entry_id:1133792)可以近似写为 ：
$$
\frac{Dw}{Dt} \approx b - \frac{1}{\rho_0} \frac{\partial p'}{\partial z}
$$
这表明，扰动压力[梯度力](@entry_id:166847)直接对抗或增强[浮力](@entry_id:154088)的作用。扰动压力 $p'$ 的作用并非局部的，而是**非局地（non-local）** 的。它的存在是为了确保整个流场的运动满足[质量守恒](@entry_id:204015)（即[连续性方程](@entry_id:195013)）。当一个区域出现强烈的上升运动时，为了维持质量连续，必然会在其周围产生补偿性的下沉运动。这种运动的协调是通过压[力场](@entry_id:147325)实现的：上升气流顶部会产生高压扰动，底部产生低压扰动，这种压力分布会驱动周围空气下沉，并能以重力波的形式将能量向外传播 。

从数学上讲，$p'$ 是一个**诊断变量**，它不是通过时间积分直接预报的，而是在每个时间步通过求解一个椭圆型[偏微分](@entry_id:194612)方程（如泊松方程）得到的。这个方程的形式大致为 $\nabla^2 p' = F(\boldsymbol{v}, b)$，其中右端项 $F$ 依赖于速度场和[浮力](@entry_id:154088)场。求解这个方程确保了最终的速度场满足连续性方程的约束 。因此，扰动压力起到了一个全局协调者的作用，将局部的[浮力](@entry_id:154088)强迫转化为一个协调的、满足[质量守恒](@entry_id:204015)的流场结构。

### [非静力模型](@entry_id:1128852)的近似方程组

求解完整的可压缩非静力方程组在计算上是昂贵的，主要是因为它包含了高速传播的声波。声波的传播速度（音速，约 $340 \, \text{m s}^{-1}$）远大于天气系统的移动速度。根据数值稳定性的CFL条件，显式时间积分格式的时间步长必须小于网格尺寸除以最[快波](@entry_id:1124857)速。因此，声波的存在会迫使数值模型使用非常小的时间步长，从而极大地增加了计算成本。

为了提高[计算效率](@entry_id:270255)，发展了两种主要的近似方法来“过滤”掉声波：**Boussinesq近似**和**滞弹性（anelastic）近似**。这两种方法都适用于[低马赫数](@entry_id:1127478)（$Ma = U/c_s \ll 1$）的流动，但对大气层结的处理有所不同 。

#### Boussinesq近似

[Boussinesq近似](@entry_id:147239)是最严格的简化，它适用于垂直尺度远小于密度标高（约10公里）的“浅层”大气现象（如边界层对流）。其核心假设是：
1.  **密度恒定**：在除[浮力](@entry_id:154088)项外的所有项中，密度 $\rho$ 都被视为一个常数参考值 $\rho_0$。
2.  **[密度扰动](@entry_id:159546)**：密度的变化 $\rho'$ 只在与重力 $g$ 相乘的[浮力](@entry_id:154088)项中被保留。
3.  **[不可压缩流](@entry_id:140301)**：基于以上假设，[质量守恒](@entry_id:204015)方程被简化为[无散度](@entry_id:190991)条件：
    $$
    \nabla \cdot \boldsymbol{u} = 0
    $$
这个近似有效地滤除了声波，但因为它假设背景密度恒定，所以无法准确描述大垂直范围内的密度变化。

#### 滞弹性（Anelastic）近似

滞弹性近似是[Boussinesq近似](@entry_id:147239)的一个推广，它适用于垂直尺度与密度[标高](@entry_id:263754)相当的“深层”大气现象（如[深对流](@entry_id:1123472)、地形波）。它同样滤除了声波，但更准确地处理了背景大气的垂直分层。其核心假设是：
1.  **背景密度变化**：承认背景密度 $\rho_0(z)$ 是随高度变化的，并处于[静力平衡](@entry_id:163498)状态。
2.  **小[密度扰动](@entry_id:159546)**：相对于随高度变化的背景密度，局地[密度扰动](@entry_id:159546) $\rho'$ 仍然很小。
3.  **滞弹性连续性方程**：在这些假设下，[连续性方程](@entry_id:195013)被简化为一个诊断约束：
    $$
    \nabla \cdot (\rho_0(z) \boldsymbol{u}) = 0
    $$
这个方程允许由于空气在垂直方向移动时因背景密度变化而产生的辐散或辐合，这比Boussinesq近似的[无散度](@entry_id:190991)条件更为真实。滞弹性模型在保留了对深层大气层结的准确描述的同时，成功地过滤了声波，因此在许多中尺度气象模型中得到了广泛应用。

### 数值实现中的挑战与策略

无论是求解近似的滞弹性方程组，还是完整的可压缩方程组，都面临着独特的数值挑战。

#### 椭圆压力方程的求解

如前所述，在Boussinesq和滞弹性等声波过滤模型中，扰动压力 $p'$ (或一个与之相关的[压力势](@entry_id:154481) $\phi$) 是通过求解一个椭圆型泊松方程来诊断的。这个方程通常具有以下形式 ：
$$
\nabla \cdot (\alpha(z) \nabla \phi) = F
$$
其中 $\alpha(z)$ 是一个与背景密度相关的系数（对于滞弹性模型是 $\rho_0(z)$），$F$ 是源项，由当前时刻的速度场和[浮力](@entry_id:154088)场决定。在每个模拟时间步，都必须高效、准确地求解这个大规模的稀疏[线性方程组](@entry_id:148943)。

- **算子性质**：该[椭圆算子](@entry_id:181616)是**对称正定**的（在除去常数解的子空间上），这使得**预条件共轭梯度法（Preconditioned Conjugate Gradient, PCG）**成为一个理想的[迭代求解器](@entry_id:136910)。

- **各向异性挑战**：在典型的大气模型中，水平网格距（$\Delta x, \Delta y$）远大于垂直网格距（$\Delta z$），即 $\Delta z \ll \Delta x$。这种**网格各向异性**导致离散后的线性系统矩阵具有非常大的条件数，使得简单的迭代方法（如[Jacobi法](@entry_id:147508)或无预条件的CG法）收敛极其缓慢。

- **高效求解策略**：为了克服这一问题，必须采用强大的预条件技术。**[多重网格方法](@entry_id:146386)（Multigrid methods）**，无论是[几何多重网格](@entry_id:749854)（Geometric Multigrid）还是[代数多重网格](@entry_id:140593)（Algebraic Multigrid, AMG），都被证明是解决此类问题的最优或接近最优的策略。它们通过在不同粗细的网格层次上传递信息，能够有效地消除所有频率的误差，其收敛速度几乎与网格大小和各向异性无关。特别是，采用**垂直方向线松弛（vertical line relaxation）**的[几何多重网格](@entry_id:749854)或AMG作为PCG的[预条件子](@entry_id:753679)，可以稳健地处理变系数和强各向异性，从而实现高效求解 。

#### 可压缩模型的时间积分

对于保留声波的完全可压缩模型，其挑战则来自于方程组的“刚性”（stiffness）——方程中同时存在速度相差悬殊的波（慢速的平流和快速的声波）。

如前文计算所示，对于一个典型的[非静力模型](@entry_id:1128852)网格（如 $\Delta x = 10 \, \text{km}, \Delta z = 100 \, \text{m}$），由垂直声波传播所决定的CFL[时间步长限制](@entry_id:756010)（约0.29秒）远比平流限制（500秒）或水平声波限制（28.8秒）严格得多 。如果对所有项都使用标准的显式时间积分，计算效率将极低。因此，必须采用特殊的积分方案来放宽这一限制。

- **分裂显式（Split-Explicit）方案**：这种方法将方程的右端项分为“快”（声波和重力波项）和“慢”（平流、科里奥利力等）两部分。慢项用一个大的时间步长 $\Delta t$ 进行积分，而快项则在这个大步长内用多个小的显式子步长 $\Delta \tau$ 进行积分。这样避免了求解复杂的[隐式方程](@entry_id:177636)，同时又提高了整体计算效率。

- **水平显式垂直隐式（HEVI）方案**：该方案专门针对垂直[声波导](@entry_id:1120716)致的最严苛CFL限制。它对水平方向的传播项采用显式处理，而对垂直方向的传播项采用隐式处理。由于隐式格式[无条件稳定](@entry_id:146281)，这便消除了来自垂直网格的CFL限制。时间步长主要由水平方向的[CFL条件](@entry_id:178032)决定。在每个时间步，该方法仅需求解一系列[相互独立](@entry_id:273670)的、沿垂直方向的[三对角方程组](@entry_id:163398)，计算成本相对较低。

- **半隐式（Semi-Implicit）方案**：该方案对引起快速波（声波和重力波）的线性项在所有方向上都采用隐式处理，而对[非线性](@entry_id:637147)的平流项则采用显式处理。这通常需要在一个时间步内求解一个全局的椭圆型方程（如Helmholtz方程）。通过将快速波变为隐式处理，该方法成功地移除了声波的CFL限制，允许时间步长由慢速的平流过程决定。

- **隐式-显式（IMEX）方案**：这是一类更通用的方法，旨在将刚性项（如声波项）和非刚性项（如平流项）分开处理。在一个统一的[高阶时间积分](@entry_id:750308)框架（如IMEX-Runge-Kutta）中，对刚性项应用稳定的隐式或半隐式方法，对非刚性项应用高效的显式方法。这使得模型既能以大步长稳[定积分](@entry_id:147612)，又能精确处理各种物理过程，是现代[非静力模型](@entry_id:1128852)中一种流行且强大的技术 。