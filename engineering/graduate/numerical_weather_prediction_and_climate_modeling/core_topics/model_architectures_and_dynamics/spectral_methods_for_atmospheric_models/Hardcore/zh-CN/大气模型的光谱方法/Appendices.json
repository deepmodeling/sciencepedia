{
    "hands_on_practices": [
        {
            "introduction": "要掌握谱方法，我们首先从最简单的情形入手：一个在整个球面上均匀分布的常量场。这个练习将揭示球谐函数基函数中最低阶（$Y_{00}$）的独特物理意义。通过推导其谱系数，您将亲手验证它如何代表场的全局平均值，这直接关系到大气模型中如质量或能量等基本守恒定律的精确维持。",
            "id": "4091678",
            "problem": "考虑一个在数值天气预报 (NWP) 中的全局示踪场，该场在球面上空间恒定。设地球由一个半径为 $R$ 的球面表示，其球坐标为 $(\\theta,\\phi)$，其中 $\\theta \\in [0,\\pi]$ 是余纬，$\\phi \\in [0,2\\pi)$ 是经度。该示踪场是无量纲的，由 $f(\\theta,\\phi) = c$ 给出，其中 $c$ 是一个常数。球谐函数 $Y_{\\ell m}(\\theta,\\phi)$ 在单位球面 $S^{2}$ 上构成一个关于内积 $\\int_{S^{2}} Y_{\\ell m}(\\theta,\\phi) Y_{\\ell' m'}^{*}(\\theta,\\phi) \\,\\mathrm{d}\\Omega = \\delta_{\\ell \\ell'} \\delta_{m m'}$ 的完备正交基，其中 $\\mathrm{d}\\Omega = \\sin\\theta \\,\\mathrm{d}\\theta \\,\\mathrm{d}\\phi$，星号表示复共轭。$f$ 在该基上的谱投影由系数定义：\n$$\na_{\\ell m} = \\int_{S^{2}} f(\\theta,\\phi) \\, Y_{\\ell m}^{*}(\\theta,\\phi) \\,\\mathrm{d}\\Omega.\n$$\n从这些基本定义和性质出发，完成以下任务：\n1. 根据正交性以及 $Y_{00}$ 在球面上为常数这一事实，推导 $Y_{00}(\\theta,\\phi)$ 的值。\n2. 使用正交性证明，对于常数场 $f(\\theta,\\phi)=c$，除了 $a_{00}$ 可能不为零外，所有谱系数 $a_{\\ell m}$ 均为零。\n3. 以 $c$ 和普适常数的形式，显式计算 $a_{00}$ 的闭式表达式。\n4. 使用面积元 $\\mathrm{d}A = R^{2} \\mathrm{d}\\Omega$，证明直接从 $f$ 计算的总示踪质量 $M$ 等于从其谱表示计算的质量，从而证明对于此常数场，在谱截断下质量是守恒的。\n\n提交你关于 $a_{00}$ 的闭式表达式作为最终答案。示踪剂是无量纲的；用无量纲单位表示 $a_{00}$。无需四舍五入。",
            "solution": "所述问题具有科学依据、是良定的，并包含了严谨推导所需的所有信息。这是谱方法应用于地球物理流体动力学的一个基本问题。我们将按顺序解决所要求的四个部分来进行解答。\n\n这个问题的基础是将球面上的标量场 $f(\\theta, \\phi)$ 表示为球谐函数 $Y_{\\ell m}(\\theta, \\phi)$ 的展开式：\n$$\nf(\\theta, \\phi) = \\sum_{\\ell=0}^{\\infty} \\sum_{m=-\\ell}^{\\ell} a_{\\ell m} Y_{\\ell m}(\\theta, \\phi)\n$$\n其中系数 $a_{\\ell m}$ 通过将 $f$ 投影到基函数上得到：\n$$\na_{\\ell m} = \\int_{S^{2}} f(\\theta,\\phi) \\, Y_{\\ell m}^{*}(\\theta,\\phi) \\,\\mathrm{d}\\Omega\n$$\n球谐函数构成一个正交基，满足：\n$$\n\\int_{S^{2}} Y_{\\ell m}(\\theta,\\phi) Y_{\\ell' m'}^{*}(\\theta,\\phi) \\,\\mathrm{d}\\Omega = \\delta_{\\ell \\ell'} \\delta_{m m'}\n$$\n其中 $\\mathrm{d}\\Omega = \\sin\\theta \\,\\mathrm{d}\\theta \\,\\mathrm{d}\\phi$ 是立体角微元。\n\n**1. $Y_{00}(\\theta,\\phi)$ 的推导**\n\n给定 $Y_{00}(\\theta, \\phi)$ 是一个常数。我们将其记为 $K$，即 $Y_{00}(\\theta, \\phi) = K$。根据物理学中的惯例，$K$ 是一个实正常数，因此 $Y_{00}^{*} = Y_{00} = K$。我们使用 $\\ell = \\ell' = 0$ 和 $m = m' = 0$ 情况下的正交归一条件：\n$$\n\\int_{S^{2}} Y_{00}(\\theta,\\phi) Y_{00}^{*}(\\theta,\\phi) \\,\\mathrm{d}\\Omega = \\delta_{00} \\delta_{00} = 1\n$$\n代入 $Y_{00} = K$，我们有：\n$$\n\\int_{S^{2}} K \\cdot K \\,\\mathrm{d}\\Omega = 1 \\implies K^{2} \\int_{S^{2}} \\,\\mathrm{d}\\Omega = 1\n$$\n积分 $\\int_{S^{2}} \\,\\mathrm{d}\\Omega$ 表示球面的总立体角。我们在球坐标中显式计算该积分：\n$$\n\\int_{S^{2}} \\,\\mathrm{d}\\Omega = \\int_{0}^{2\\pi} \\int_{0}^{\\pi} \\sin\\theta \\,\\mathrm{d}\\theta \\,\\mathrm{d}\\phi\n$$\n对 $\\theta$ 的积分得出：\n$$\n\\int_{0}^{\\pi} \\sin\\theta \\,\\mathrm{d}\\theta = [-\\cos\\theta]_{0}^{\\pi} = -(\\cos\\pi - \\cos 0) = -(-1 - 1) = 2\n$$\n将此结果代回对 $\\phi$ 的积分中：\n$$\n\\int_{0}^{2\\pi} 2 \\,\\mathrm{d}\\phi = 2[\\phi]_{0}^{2\\pi} = 2(2\\pi - 0) = 4\\pi\n$$\n因此，球面的总立体角是 $4\\pi$。现在我们可以解出 $K$：\n$$\nK^{2} (4\\pi) = 1 \\implies K^{2} = \\frac{1}{4\\pi} \\implies K = \\frac{1}{\\sqrt{4\\pi}}\n$$\n我们按惯例取正根。因此，常数球谐函数 $Y_{00}$ 是：\n$$\nY_{00}(\\theta,\\phi) = \\frac{1}{\\sqrt{4\\pi}}\n$$\n\n**2. 证明当 $(\\ell, m) \\neq (0, 0)$ 时，$a_{\\ell m}$ 为零**\n\n示踪场为常数 $f(\\theta, \\phi) = c$。我们可以用基函数 $Y_{00}$ 来表示这个常数场。从第1部分的结果可知，$1 = \\sqrt{4\\pi} Y_{00}(\\theta, \\phi)$。因此，我们可以将场 $f$ 写为：\n$$\nf(\\theta, \\phi) = c = c \\cdot 1 = c \\sqrt{4\\pi} Y_{00}(\\theta, \\phi)\n$$\n现在，我们使用其定义来计算谱系数 $a_{\\ell m}$：\n$$\na_{\\ell m} = \\int_{S^{2}} f(\\theta,\\phi) \\, Y_{\\ell m}^{*}(\\theta,\\phi) \\,\\mathrm{d}\\Omega\n$$\n代入 $f(\\theta, \\phi)$ 的表达式：\n$$\na_{\\ell m} = \\int_{S^{2}} \\left( c \\sqrt{4\\pi} Y_{00}(\\theta, \\phi) \\right) Y_{\\ell m}^{*}(\\theta, \\phi) \\,\\mathrm{d}\\Omega\n$$\n项 $c \\sqrt{4\\pi}$ 是一个常数，可以提到积分外面：\n$$\na_{\\ell m} = c \\sqrt{4\\pi} \\int_{S^{2}} Y_{00}(\\theta, \\phi) Y_{\\ell m}^{*}(\\theta, \\phi) \\,\\mathrm{d}\\Omega\n$$\n该积分正是 $Y_{00}$ 和 $Y_{\\ell m}$ 的内积。根据正交归一关系，该积分的计算结果为 $\\delta_{0\\ell}\\delta_{0m}$：\n$$\na_{\\ell m} = c \\sqrt{4\\pi} \\, \\delta_{0\\ell} \\delta_{0m}\n$$\n克罗内克δ函数 $\\delta_{ij}$ 在 $i=j$ 时等于1，否则为0。对于任何满足 $\\ell \\neq 0$ 或 $m \\neq 0$ 的数对 $(\\ell, m)$，至少有一个克罗内克δ函数为零。因此，对于所有 $(\\ell, m) \\neq (0, 0)$，$a_{\\ell m} = 0$。这证明了对于一个常数场，只有系数 $a_{00}$ 可以不为零。\n\n**3. $a_{00}$ 的计算**\n\n我们可以通过在第2部分推导出的 $a_{\\ell m}$ 通用表达式中设置 $\\ell=0$ 和 $m=0$ 来求得 $a_{00}$：\n$$\na_{00} = c \\sqrt{4\\pi} \\, \\delta_{00} \\delta_{00} = c \\sqrt{4\\pi} \\cdot 1 \\cdot 1 = c \\sqrt{4\\pi}\n$$\n或者，我们可以直接从其定义计算 $a_{00}$：\n$$\na_{00} = \\int_{S^{2}} f(\\theta,\\phi) Y_{00}^{*}(\\theta,\\phi) \\,\\mathrm{d}\\Omega\n$$\n当 $f(\\theta,\\phi) = c$ 且 $Y_{00}^{*} = Y_{00} = \\frac{1}{\\sqrt{4\\pi}}$ 时：\n$$\na_{00} = \\int_{S^{2}} c \\left( \\frac{1}{\\sqrt{4\\pi}} \\right) \\,\\mathrm{d}\\Omega = \\frac{c}{\\sqrt{4\\pi}} \\int_{S^{2}} \\,\\mathrm{d}\\Omega\n$$\n正如在第1部分中确立的，积分 $\\int_{S^{2}} \\,\\mathrm{d}\\Omega = 4\\pi$。代入此值：\n$$\na_{00} = \\frac{c}{\\sqrt{4\\pi}} (4\\pi) = c\\sqrt{4\\pi}\n$$\n两种方法得出了相同的结果。\n\n**4. 质量守恒的证明**\n\n“质量”一词指的是无量纲示踪剂的总量，通过将该场在球的表面积上积分得到。表面积元为 $\\mathrm{d}A = R^{2} \\mathrm{d}\\Omega$。\n\n首先，我们直接从场 $f(\\theta, \\phi) = c$ 计算总质量 $M_{\\text{direct}}$：\n$$\nM_{\\text{direct}} = \\int_{\\text{surface}} f(\\theta, \\phi) \\,\\mathrm{d}A = \\int_{S^{2}} c \\, (R^{2} \\,\\mathrm{d}\\Omega)\n$$\n由于 $c$ 和 $R^{2}$ 是常数，我们可以将它们提出来：\n$$\nM_{\\text{direct}} = c R^{2} \\int_{S^{2}} \\,\\mathrm{d}\\Omega = c R^{2} (4\\pi) = 4\\pi R^{2} c\n$$\n这是预期的结果：球的表面积 $4\\pi R^{2}$ 乘以恒定的示踪剂密度 $c$。\n\n接下来，我们从场的谱表示计算质量 $M_{\\text{spec}}$。对于常数场，由于所有其他系数都为零，谱级数在第一项后即截断。该谱表示是精确的：\n$$\nf(\\theta, \\phi) = a_{00} Y_{00}(\\theta, \\phi) \n$$\n让我们验证这个表示是正确的：$f(\\theta, \\phi) = (c \\sqrt{4\\pi}) \\left( \\frac{1}{\\sqrt{4\\pi}} \\right) = c$。它确实是正确的。现在，我们从此表示计算质量：\n$$\nM_{\\text{spec}} = \\int_{\\text{surface}} \\left( a_{00} Y_{00}(\\theta, \\phi) \\right) \\,\\mathrm{d}A = \\int_{S^{2}} a_{00} Y_{00}(\\theta, \\phi) \\, (R^{2} \\,\\mathrm{d}\\Omega)\n$$\n提出常数 $a_{00}$ 和 $R^2$：\n$$\nM_{\\text{spec}} = a_{00} R^{2} \\int_{S^{2}} Y_{00}(\\theta, \\phi) \\,\\mathrm{d}\\Omega\n$$\n代入 $Y_{00}(\\theta, \\phi) = \\frac{1}{\\sqrt{4\\pi}}$：\n$$\nM_{\\text{spec}} = a_{00} R^{2} \\int_{S^{2}} \\frac{1}{\\sqrt{4\\pi}} \\,\\mathrm{d}\\Omega = \\frac{a_{00} R^{2}}{\\sqrt{4\\pi}} \\int_{S^{2}} \\,\\mathrm{d}\\Omega\n$$\n积分再次为 $4\\pi$：\n$$\nM_{\\text{spec}} = \\frac{a_{00} R^{2}}{\\sqrt{4\\pi}} (4\\pi) = a_{00} R^{2} \\sqrt{4\\pi}\n$$\n最后，代入第3部分得到的 $a_{00} = c\\sqrt{4\\pi}$ 的值：\n$$\nM_{\\text{spec}} = (c\\sqrt{4\\pi}) R^{2} \\sqrt{4\\pi} = c R^{2} (4\\pi) = 4\\pi R^{2} c\n$$\n我们发现 $M_{\\text{direct}} = M_{\\text{spec}}$。这证明了在使用谱表示时，总示踪质量是守恒的。对于一个常数场，即使谱模型在最低可能阶数截断（仅保留 $\\ell=0$ 模态），该结论也成立，因为关于该场的所有信息都包含在 $a_{00}$ 系数中。",
            "answer": "$$\\boxed{c\\sqrt{4\\pi}}$$"
        },
        {
            "introduction": "在掌握了如何用谱系数表示一个场之后，数值建模中的一个关键问题随之而来：谱截断与物理空间中的网格分辨率之间有何关系？本练习将引导您推导这一基本联系。通过应用奈奎斯特-香农采样定理，您将确定一个给定的谱截断总波数 $L$ 需要多精细的计算网格来避免信号混叠，这是将数字信号处理理论应用于大气科学的核心实践。",
            "id": "4091694",
            "problem": "考虑一个全球谱大气模型，该模型在球体上使用球谐函数，并采用三角截断 $T_{L}$，这意味着保留总波数 $0 \\leq \\ell \\leq L$ 和方位波数 $|m| \\leq \\ell$。该模型采用高斯格点，其纬向节点是勒让德多项式的零点，其经线在每个纬度上都是准均匀间隔的。仅使用以下事实：球谐函数的经向相关性为 $\\exp(i m \\lambda)$，赤道处的大圆距离跨越的总弧长为 $2 \\pi R$（其中 $R$ 是地球半径），以及奈奎斯特-香农采样定理 (NSST) 要求每个波长至少有两个样本才能解析一个正弦波，完成以下任务：\n\n- 从赤道处的周期性经向相关性出发，推导为无混叠地采样所有保留的方位波数（直到 $m=L$）所需的最少等距经线条数 $N_{\\lambda}$。\n\n- 根据此采样要求，推导出高斯格点上赤道处的近似经向弧长格点间距 $\\Delta s$，作为 $L$ 和 $R$ 的函数。\n\n- 使用相同的NSST推理，用 $L$ 和 $R$ 表示赤道处最小可分辨的纬向尺度（即最小可分辨的纬向波长）$\\lambda_{\\min}$。\n\n最后，对于地球半径 $R = 6.371 \\times 10^{6}\\ \\mathrm{m}$ 和截断 $L = 1063$，计算 $\\Delta s$ 和 $\\lambda_{\\min}$ 的值。将 $\\Delta s$ 和 $\\lambda_{\\min}$ 以 $\\mathrm{km}$ 为单位表示，并将您的数值答案四舍五入到四位有效数字。",
            "solution": "该问题要求基于指定的截断和信号处理的基本原理，推导球体上谱大气模型的关键网格尺度参数。该过程包括验证问题陈述，然后进行逐步推导。\n\n### 问题验证\n\n首先，我将验证问题陈述。\n\n**第1步：提取已知条件**\n- 模型类型：球体上的全球谱大气模型。\n- 基函数：球谐函数。\n- 截断方案：三角截断 $T_L$。\n- 保留的波数：总波数 $0 \\leq \\ell \\leq L$，方位波数 $|m| \\leq \\ell$。\n- 格点：高斯格点。\n- 球谐函数的经向相关性：$\\exp(i m \\lambda)$。\n- 赤道周长：$2 \\pi R$，其中 $R$ 是地球半径。\n- 采样原理：奈奎斯特-香农采样定理 (NSST)，要求每个波长至少有两个样本。\n- 用于计算的具体值：$R = 6.371 \\times 10^6 \\ \\mathrm{m}$，$L = 1063$。\n- 要求输出：\n  1. 采样至 $m=L$ 所需的最少经线条数 $N_{\\lambda}$。\n  2. 作为 $L$ 和 $R$ 函数的近似赤道格点间距 $\\Delta s$。\n  3. 用 $L$ 和 $R$ 表示的赤道处最小可分辨纬向波长 $\\lambda_{\\min}$。\n  4. $\\Delta s$ 和 $\\lambda_{\\min}$ 的数值（单位为 $\\mathrm{km}$），四舍五入到四位有效数字。\n\n**第2步：使用提取的已知条件进行验证**\n- **科学上成立**：该问题在根本上是合理的。它基于数值天气预报中使用的谱方法的核心原理，包括球谐函数、三角截断、高斯格点和奈奎斯特-香农采样定理。这些都是该领域的标准概念。\n- **提问得当**：问题陈述清晰，并提供了推导所需量所必需的所有信息。这些问题导向一个唯一且有意义的解。\n- **客观**：语言精确、定量，且没有主观或模糊的术语。\n- **一致性与可行性**：给定的地球半径 $R$ 和截断 $L=1063$ 对于现代高分辨率全球模型是现实的。没有内部矛盾或科学上难以置信的假设。\n\n**第3步：结论与行动**\n该问题是有效的，因为它在科学上成立、提问得当且客观。我现在将进行求解。\n\n### 推导与求解\n\n按照问题陈述的要求，推导分为三个部分，然后进行数值计算。\n\n**1. 最少经度点数 ($N_{\\lambda}$)**\n\n球谐函数分量的经向结构由复指数 $\\exp(i m \\lambda)$ 给出，其中 $m$ 是方位（或纬向）波数，$\\lambda$ 是经度（以弧度为单位），从 $0$ 变化到 $2\\pi$。这表示沿纬度圈的正弦波。整数 $m$ 表示能够容纳在 $2\\pi$ 弧度周长内的完整波长的数量。\n\n对于三角截断 $T_L$，模型中保留的最大方位波数为 $|m|_{max} = L$。必须表示的最高频率（或最短波长）分量对应于 $m=L$。该分量在经向有 $L$ 个完整的周期。\n\n这个最高频率分量的波长，以经度弧度为单位测量，是：\n$$\n\\lambda_{\\text{angular}} = \\frac{2\\pi}{L}\n$$\n\n奈奎斯特-香农采样定理 (NSST) 指出，为了无混叠地表示一个波，必须使用至少是该波频率两倍的采样频率。在空间上，这意味着采样间隔（格点之间的距离）必须不大于波长的一半。\n设 $N_{\\lambda}$ 是沿赤道等距分布的经度点数。这些点之间的角间距是：\n$$\n\\Delta \\lambda = \\frac{2\\pi}{N_{\\lambda}}\n$$\n\n应用NSST条件：\n$$\n\\Delta \\lambda \\leq \\frac{1}{2} \\lambda_{\\text{angular}}\n$$\n代入 $\\Delta \\lambda$ 和 $\\lambda_{\\text{angular}}$ 的表达式：\n$$\n\\frac{2\\pi}{N_{\\lambda}} \\leq \\frac{1}{2} \\left( \\frac{2\\pi}{L} \\right) = \\frac{\\pi}{L}\n$$\n求解 $N_{\\lambda}$：\n$$\n\\frac{2}{N_{\\lambda}} \\leq \\frac{1}{L} \\implies N_{\\lambda} \\geq 2L\n$$\n因此，为无混叠地采样所有保留的波数（直到 $m=L$）所需的最少等距经度点数是 $N_{\\lambda} = 2L$。\n\n**2. 赤道格点间距 ($\\Delta s$)**\n\n沿赤道的物理格点间距 $\\Delta s$ 是赤道总周长除以经向格点数 $N_{\\lambda}$。周长为 $C = 2\\pi R$。\n使用最少点数 $N_{\\lambda} = 2L$：\n$$\n\\Delta s = \\frac{C}{N_{\\lambda}} = \\frac{2\\pi R}{2L}\n$$\n这简化为赤道处的近似经向弧长格点间距：\n$$\n\\Delta s = \\frac{\\pi R}{L}\n$$\n\n**3. 最小可分辨纬向波长 ($\\lambda_{\\min}$)**\n\n格点上最小可分辨的波长，通常称为奈奎斯特波长，由NSST定义。它是格点间距 $\\Delta s$ 的两倍。这样一个长度的波每个周期恰好被采样两次（例如，在其波峰和波谷处），这代表了可分辨的极限。任何更短的波长都会发生混叠并被误解为更长的波长。\n因此，赤道处最小可分辨的纬向尺度 $\\lambda_{\\min}$ 是：\n$$\n\\lambda_{\\min} = 2 \\Delta s\n$$\n代入 $\\Delta s$ 的表达式：\n$$\n\\lambda_{\\min} = 2 \\left( \\frac{\\pi R}{L} \\right) = \\frac{2\\pi R}{L}\n$$\n这个结果在物理上是直观的：最小可分辨尺度对应于谱截断所保留的最高波数 $m=L$ 的物理波长。\n\n**4. 数值计算**\n\n给定 $R = 6.371 \\times 10^6 \\ \\mathrm{m}$ 和 $L = 1063$。\n\n首先，我们计算赤道格点间距 $\\Delta s$：\n$$\n\\Delta s = \\frac{\\pi R}{L} = \\frac{\\pi (6.371 \\times 10^6 \\ \\mathrm{m})}{1063} \\approx 18829.257 \\ \\mathrm{m}\n$$\n为换算成千米，我们除以1000：\n$$\n\\Delta s \\approx 18.829257 \\ \\mathrm{km}\n$$\n四舍五入到四位有效数字，我们得到：\n$$\n\\Delta s \\approx 18.83 \\ \\mathrm{km}\n$$\n\n接下来，我们计算最小可分辨波长 $\\lambda_{\\min}$：\n$$\n\\lambda_{\\min} = 2 \\Delta s = 2 \\times \\left( \\frac{\\pi R}{L} \\right) = \\frac{2\\pi R}{L}\n$$\n使用先前计算的 $\\Delta s$ 值：\n$$\n\\lambda_{\\min} \\approx 2 \\times 18.829257 \\ \\mathrm{km} \\approx 37.658514 \\ \\mathrm{km}\n$$\n四舍五入到四位有效数字，我们得到：\n$$\n\\lambda_{\\min} \\approx 37.66 \\ \\mathrm{km}\n$$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 18.83  37.66 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在前两个练习的基础上，我们将从静态场的表示转向动态模拟。本练习设定了大气建模中的一项核心任务：求解一个示踪物的平流-扩散方程。它展示了谱方法如何将一个复杂的偏微分方程（PDE）转化为一组针对每个谱模态的、易于求解的独立常微分方程（ODE）。通过将数值解与精确的解析解进行比较，本练习还引入了验证数值方案准确性的标准方法，这是开发可靠模型的关键一步。",
            "id": "4091581",
            "problem": "您需要为一个双周期方形域上的二维示踪物平流-超扩散方程设计并实现一个谱方法实验。目标是通过将数值谱方法时间积分与解析谱解进行比较，计算不同超扩散阶数下的误差范数。该实验必须是完全自包含的，并在一个具有周期性边界条件的方形域上以无量纲单位运行。\n\n从一个周期域上均匀、无散速度场中的无源标量示踪物守恒开始。其控制方程为\n$$\n\\frac{\\partial q}{\\partial t} + u \\frac{\\partial q}{\\partial x} + v \\frac{\\partial q}{\\partial y} = - \\nu \\left( - \\nabla^2 \\right)^p q,\n$$\n其中 $q(x,y,t)$ 是示踪物浓度，$u$ 和 $v$ 是恒定速度，$\\nu$ 是超扩散系数，$p$ 是一个正整数超扩散阶数。空间域是边长为 $L=2\\pi$ 的方形区域 $[0,L)\\times[0,L)$，并且所有场在两个方向上都是 $L$-周期的。\n\n使用谱方法中以下经过充分检验的数学事实和定义：\n- 快速傅里叶变换 (FFT) 将一个 $N\\times N$ 网格上的离散周期场 $q(x,y)$ 映射到其离散傅里叶系数 $\\hat{q}(k_x,k_y)$，其中角波数由 $k_x = 2\\pi f_x$ 和 $k_y = 2\\pi f_y$ 给出，$f_x$ 和 $f_y$ 是由离散傅里叶变换的网格间距计算出的 FFT 频率。\n- 对于离散傅里叶表示，谱空间中的空间微分是精确的：$\\widehat{\\partial_x q} = i k_x \\hat{q}$ 和 $\\widehat{\\partial_y q} = i k_y \\hat{q}$，拉普拉斯算子为 $\\widehat{\\nabla^2 q} = -\\left(k_x^2 + k_y^2\\right)\\hat{q}$。\n- 对于常系数和线性算子，每个离散傅里叶模态都作为一个常微分方程随时间独立演化。\n\n基于这些基础，推导出每个傅里叶模态的精确离散谱-时间演化，然后实现一个数值时间积分器。具体来说：\n1. 将初始示踪物场表示为以 $(x_0,y_0)$ 为中心的高斯斑：\n$$\nq(x,y,0) = \\exp\\left( - \\frac{(x-x_0)^2 + (y-y_0)^2}{2\\sigma^2} \\right),\n$$\n其周期性由域决定。使用 $x_0 = \\pi/2$, $y_0 = \\pi$, 和 $\\sigma = 0.30$。\n2. 在谱空间中，证明每个模态满足\n$$\n\\frac{d \\hat{q}}{dt} = \\left( - i \\left( u k_x + v k_y \\right) - \\nu \\left( k_x^2 + k_y^2 \\right)^p \\right) \\hat{q},\n$$\n因此，在时间 $t$ 的精确离散解为\n$$\n\\hat{q}(t) = \\hat{q}(0) \\exp\\left( - i \\left( u k_x + v k_y \\right) t - \\nu \\left( k_x^2 + k_y^2 \\right)^p t \\right).\n$$\n3. 使用经典的四阶龙格－库塔 (RK4) 方法，对谱常微分方程进行数值时间积分，步长为 $\\Delta t$，共 $N_t$ 步，使得 $t = N_t \\Delta t$。计算数值近似解 $\\hat{q}_{\\text{num}}(t)$ 并通过其逆 FFT 获得 $q_{\\text{num}}(x,y,t)$。\n4. 通过将精确谱演化应用于初始谱并进行逆变换，计算解析基准解 $q_{\\text{exact}}(x,y,t)$。\n5. 在网格上计算 $q_{\\text{num}}(x,y,t)$ 和 $q_{\\text{exact}}(x,y,t)$ 之间的误差范数：\n   - $L^2$ 误差为\n   $$\n   E_{2} = \\sqrt{ \\frac{1}{N^2} \\sum_{i=0}^{N-1} \\sum_{j=0}^{N-1} \\left( q_{\\text{num}}(x_i,y_j,t) - q_{\\text{exact}}(x_i,y_j,t) \\right)^2 }.\n   $$\n   - $L^{\\infty}$ 误差为\n   $$\n   E_{\\infty} = \\max_{0 \\le i,j  N} \\left| q_{\\text{num}}(x_i,y_j,t) - q_{\\text{exact}}(x_i,y_j,t) \\right|.\n   $$\n\n数值实现要求：\n- 使用 $N \\times N$ 网格，其中 $N$ 根据每个测试用例给出，域长度 $L = 2\\pi$，网格间距 $\\Delta x = L/N$ 和 $\\Delta y = L/N$。\n- 使用基于 FFT 的谱微分，角波数为 $k_x = 2\\pi \\, \\text{fftfreq}(N, d=\\Delta x)$ 和 $k_y = 2\\pi \\, \\text{fftfreq}(N, d=\\Delta y)$。\n- 在谱空间中使用 RK4 方法对每个傅里叶模态的线性常微分方程进行时间步进。\n- 速度分量和超扩散参数根据每个测试用例指定。\n- 所有量都是无量纲的；不需要物理单位。\n\n测试套件：\n对于每个测试用例，使用 $x_0 = \\pi/2$, $y_0 = \\pi$，总积分时间 $T = 0.50$，时间步长 $\\Delta t = 0.005$，因此步数为 $N_t = 100$。速度分量为 $u = 1.0$ 和 $v = 0.5$。测试用例通过改变网格大小和超扩散参数来探测不同的区域：\n- 用例 1：$N = 64$, $p = 1$, $\\nu = 0.010$。\n- 用例 2：$N = 64$, $p = 2$, $\\nu = 0.00050$。\n- 用例 3：$N = 64$, $p = 4$, $\\nu = 1.0 \\times 10^{-12}$。\n- 用例 4：$N = 64$, $p = 1$, $\\nu = 0.0$ (纯平流)。\n\n答案规范：\n- 对于每个测试用例，计算并返回一个列表 $[E_{2}, E_{\\infty}]$，其中两个条目都是浮点数。\n- 您的程序应产生单行输出，其中包含用方括号括起来的结果，结果为逗号分隔的列表，每个测试用例的结果也用方括号括起来，并严格按照测试套件的顺序排列。例如：\n$$\n\\text{[}[E_{2}^{(1)},E_{\\infty}^{(1)}],[E_{2}^{(2)},E_{\\infty}^{(2)}],[E_{2}^{(3)},E_{\\infty}^{(3)}],[E_{2}^{(4)},E_{\\infty}^{(4)}]\\text{]}.\n$$",
            "solution": "该问题被验证为科学上合理、适定且内部一致。它提出了一个使用谱方法求解线性偏微分方程数值解的标准验证测试。我们将着手提供一个完整的解法。\n\n问题的核心在于求解双周期域 $[0, L) \\times [0, L)$（其中 $L=2\\pi$）上无源标量示踪物 $q(x,y,t)$ 的平流-超扩散方程。其控制方程为：\n$$\n\\frac{\\partial q}{\\partial t} + u \\frac{\\partial q}{\\partial x} + v \\frac{\\partial q}{\\partial y} = - \\nu \\left( - \\nabla^2 \\right)^p q\n$$\n在这里，$u$ 和 $v$ 是恒定的速度分量，$\\nu$ 是超扩散系数，$p$ 是超扩散的整数阶数。由于周期性边界条件和常系数线性算子，谱方法是解决此问题的理想选择。\n\n**1. 变换到谱空间**\n\n我们将场 $q(x,y,t)$ 在一个离散的 $N \\times N$ 网格上表示。它的谱表示 $\\hat{q}(k_x, k_y, t)$ 是通过二维离散傅里叶变换 (DFT) 获得的，该变换使用快速傅里叶变换 (FFT) 算法实现。傅里叶变换的关键特性是它将微分算子转化为代数乘法。偏导数 $\\partial/\\partial x$ 和 $\\partial/\\partial y$ 分别变换为乘以 $i k_x$ 和 $i k_y$，其中 $k_x$ 和 $k_y$ 是与网格对应的角波数。\n\n将傅里叶变换逐项应用于控制偏微分方程，我们得到：\n$$\n\\frac{d \\hat{q}}{dt} + u (i k_x \\hat{q}) + v (i k_y \\hat{q}) = - \\nu \\left( - (-(k_x^2 + k_y^2)) \\right)^p \\hat{q}\n$$\n拉普拉斯算子 $\\nabla^2 = \\partial^2/\\partial x^2 + \\partial^2/\\partial y^2$ 变换为乘以 $-(k_x^2 + k_y^2)$。因此，超扩散算子 $(-\\nabla^2)^p$ 变为乘以 $(k_x^2 + k_y^2)^p$。\n\n重新整理方程，得到每个傅里叶模态 $\\hat{q}(k_x, k_y, t)$ 的独立常微分方程组 (ODEs)：\n$$\n\\frac{d \\hat{q}}{dt} = \\left( -i(u k_x + v k_y) - \\nu(k_x^2 + k_y^2)^p \\right) \\hat{q}\n$$\n这是一个形如 $d\\hat{q}/dt = \\mathcal{L}\\hat{q}$ 的线性常微分方程，其中 $\\mathcal{L}$ 是一个复数值标量（谱算子），它依赖于波数 $(k_x, k_y)$ 和物理参数 $(u, v, \\nu, p)$。\n\n**2. 离散化与初始条件**\n\n空间域 $[0, 2\\pi) \\times [0, 2\\pi)$ 在一个 $N \\times N$ 网格上进行离散化，其中 $N=64$。网格间距为 $\\Delta x = \\Delta y = L/N = 2\\pi/N$。物理坐标为 $x_j = j \\Delta x$ 和 $y_l = l \\Delta y$，其中 $j, l \\in \\{0, 1, \\dots, N-1\\}$。离散波数计算为 $k = 2\\pi f$，其中 $f$ 是 `numpy.fft.fftfreq(N, d=2\\pi/N)` 返回的频率。这会产生整数波数 $k_x, k_y \\in \\{0, 1, \\dots, N/2-1, -N/2, \\dots, -1\\}$。我们构造 $k_x$ 和 $k_y$ 的二维数组，以对应傅里叶系数的二维数组。\n\n初始条件是一个高斯斑：\n$$\nq(x,y,0) = \\exp\\left( - \\frac{(x-x_0)^2 + (y-y_0)^2}{2\\sigma^2} \\right)\n$$\n其中 $x_0 = \\pi/2$，$y_0 = \\pi$，$\\sigma = 0.30$。此函数在二维物理网格上求值以获得初始状态 $q_0$。其谱表示 $\\hat{q}_0 = \\text{FFT2D}(q_0)$ 作为常微分方程组的初始条件。\n\n**3. 数值时间积分 (RK4)**\n\n数值解是通过使用经典的四阶龙格-库塔 (RK4) 方法将谱常微分方程向前积分得到的。对于给定时间 $t_n$ 的状态 $\\hat{q}_n$，在 $t_n + \\Delta t$ 时的状态 $\\hat{q}_{n+1}$ 计算如下，其中 $f(\\hat{q}) = \\mathcal{L}\\hat{q}$：\n\\begin{align*}\n    K_1 = \\mathcal{L} \\, \\hat{q}_n \\\\\n    K_2 = \\mathcal{L} \\, (\\hat{q}_n + \\frac{\\Delta t}{2} K_1) \\\\\n    K_3 = \\mathcal{L} \\, (\\hat{q}_n + \\frac{\\Delta t}{2} K_2) \\\\\n    K_4 = \\mathcal{L} \\, (\\hat{q}_n + \\Delta t K_3) \\\\\n    \\hat{q}_{n+1} = \\hat{q}_n + \\frac{\\Delta t}{6} (K_1 + 2K_2 + 2K_3 + K_4)\n\\end{align*}\n这个过程以 $\\Delta t=0.005$ 的时间步长重复 $N_t = 100$ 次，以达到最终时间 $T=0.5$。结果是在时间 $T$ 的谱的数值近似，记为 $\\hat{q}_{\\text{num}}(T)$。通过应用二维逆 FFT 并取实部，可以恢复物理空间解 $q_{\\text{num}}(x,y,T)$。\n\n**4. 解析解**\n\n由于每个模态的常微分方程是线性的且系数 $\\mathcal{L}$ 为常数，其精确解由下式给出：\n$$\n\\hat{q}(T) = \\hat{q}(0) \\exp(\\mathcal{L} T)\n$$\n这个解析解 $\\hat{q}_{\\text{exact}}(T)$ 通过将初始谱 $\\hat{q}_0$ 乘以指数因子一步计算得出。相应的物理场 $q_{\\text{exact}}(x,y,T)$ 通过二维逆 FFT 获得。该解作为“基准真相”，用于与 RK4 数值解进行比较。\n\n**5. 误差计算**\n\n数值模拟的准确性通过计算物理网格上数值解 $q_{\\text{num}}$ 和精确解 $q_{\\text{exact}}$ 之间的误差来量化。使用两种标准的误差范数：\n- $L^2$ 误差，它度量均方根差：\n$$\nE_{2} = \\sqrt{ \\frac{1}{N^2} \\sum_{i,j} \\left( q_{\\text{num}}(x_i,y_j,T) - q_{\\text{exact}}(x_i,y_j,T) \\right)^2 }\n$$\n- $L^{\\infty}$ 误差，它度量任意网格点上的最大绝对差：\n$$\nE_{\\infty} = \\max_{i,j} \\left| q_{\\text{num}}(x_i,y_j,T) - q_{\\text{exact}}(x_i,y_j,T) \\right|\n$$\n对问题陈述中指定的四个测试用例中的每一个都执行这些步骤。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 2D advection-hyperdiffusion equation using a spectral method\n    and computes error norms against an analytical solution.\n    \"\"\"\n\n    def run_simulation(N, p, nu, u, v, L, x0, y0, sigma, T, dt):\n        \"\"\"\n        Runs a single simulation case.\n        \"\"\"\n        # 1. Setup Grid and Wavenumbers\n        dx = L / N\n        dy = L / N\n        x = np.arange(0, N) * dx\n        y = np.arange(0, N) * dy\n        xx, yy = np.meshgrid(x, y)\n\n        kx_vec = 2 * np.pi * np.fft.fftfreq(N, d=dx)\n        ky_vec = 2 * np.pi * np.fft.fftfreq(N, d=dy)\n        kx, ky = np.meshgrid(kx_vec, ky_vec)\n\n        # 2. Initial Condition\n        q0 = np.exp(-(((xx - x0)**2 + (yy - y0)**2) / (2 * sigma**2)))\n        q0_hat = np.fft.fft2(q0)\n\n        # 3. Define Spectral Operator and RHS for ODE\n        advection_op = -1j * (u * kx + v * ky)\n        k_sq = kx**2 + ky**2\n        \n        # Avoid issues with k=0 for p=0, though p is a positive integer here.\n        # Zero-wavenumber mode should not be diffused.\n        k_sq[0, 0] = 0\n        diffusion_op = -nu * (k_sq)**p\n        \n        spectral_op = advection_op + diffusion_op\n\n        def rhs(q_hat):\n            return spectral_op * q_hat\n\n        # 4. Time Integration (RK4) for Numerical Solution\n        q_num_hat = q0_hat.copy()\n        Nt = int(round(T / dt))\n        for _ in range(Nt):\n            k1 = rhs(q_num_hat)\n            k2 = rhs(q_num_hat + 0.5 * dt * k1)\n            k3 = rhs(q_num_hat + 0.5 * dt * k2)\n            k4 = rhs(q_num_hat + dt * k3)\n            q_num_hat += (dt / 6.0) * (k1 + 2 * k2 + 2 * k3 + k4)\n        \n        q_num = np.real(np.fft.ifft2(q_num_hat))\n\n        # 5. Compute Analytical Solution\n        q_exact_hat = q0_hat * np.exp(spectral_op * T)\n        q_exact = np.real(np.fft.ifft2(q_exact_hat))\n\n        # 6. Compute Error Norms\n        diff = q_num - q_exact\n        e2 = np.sqrt(np.mean(diff**2))\n        e_inf = np.max(np.abs(diff))\n\n        return [e2, e_inf]\n\n    # Shared parameters for all test cases\n    L = 2.0 * np.pi\n    x0 = np.pi / 2.0\n    y0 = np.pi\n    sigma = 0.30\n    T = 0.50\n    dt = 0.005\n    u = 1.0\n    v = 0.5\n\n    # Test suite from the problem statement\n    test_cases = [\n        {'N': 64, 'p': 1, 'nu': 0.010},       # Case 1\n        {'N': 64, 'p': 2, 'nu': 0.00050},     # Case 2\n        {'N': 64, 'p': 4, 'nu': 1.0e-12},     # Case 3\n        {'N': 64, 'p': 1, 'nu': 0.0},         # Case 4 (p is irrelevant when nu=0)\n    ]\n\n    results = []\n    for case in test_cases:\n        e2, e_inf = run_simulation(\n            N=case['N'], p=case['p'], nu=case['nu'],\n            u=u, v=v, L=L, x0=x0, y0=y0, sigma=sigma, T=T, dt=dt\n        )\n        results.append(f\"[{e2},{e_inf}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}