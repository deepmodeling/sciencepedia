{
    "hands_on_practices": [
        {
            "introduction": "要真正理解一个数值网格，我们必须首先掌握其基本的几何特性。这个练习将引导您将立方球体网格的抽象数学映射与一个可触摸的物理量——网格点之间的距离——联系起来。通过从诱导度量中推导弧长，您将亲身体会到网格间距在单个面板上是如何变化的，这是影响数值稳定性和精度的关键特征。",
            "id": "4029356",
            "problem": "在一个采用等角立方球面网格的全球大气模型中，考虑从 $+x$ 面上的面板坐标 $\\xi$ 和 $\\eta$（单位为弧度）到半径为 $a$ 的球面的映射，该映射由以下光滑嵌入给出：\n$$\n\\boldsymbol{r}(\\xi,\\eta) \\;=\\; a \\,\\frac{\\big(1,\\;\\tan \\xi,\\;\\tan \\eta\\big)}{\\sqrt{\\,1 + \\tan^{2}\\xi + \\tan^{2}\\eta\\,}}, \\qquad (\\xi,\\eta)\\in\\big(-\\tfrac{\\pi}{4},\\tfrac{\\pi}{4}\\big)\\times\\big(-\\tfrac{\\pi}{4},\\tfrac{\\pi}{4}\\big).\n$$\n使用由此映射在球面上诱导的度量，推导沿 $\\eta$ 为常数的线上、由一个小的坐标增量 $\\Delta \\xi$ 分隔的两个相邻网格点之间的弧长的闭式解析表达式。假设 $\\Delta \\xi$ 足够小，以至于基于沿 $\\xi$ 方向度量系数的领先阶近似成立。将您的最终结果明确地用 $a$、$\\xi$、$\\eta$ 和 $\\Delta \\xi$ 表示。您的答案必须是单个解析表达式，并且您不需要提供单位。",
            "solution": "用户希望找到立方球面网格上两个相邻网格点之间弧长的闭式解析表达式。所提供的映射是从 $+x$ 面上的面板坐标 $(\\xi, \\eta)$ 到半径为 $a$ 的球面。\n\n### 步骤1：问题验证\n\n**1.1. 提取的已知条件：**\n- **几何形状：** 半径为 $a$ 的球面。\n- **网格：** 等角立方球面网格。\n- **坐标：** 面板坐标 $(\\xi,\\eta) \\in (-\\frac{\\pi}{4}, \\frac{\\pi}{4}) \\times (-\\frac{\\pi}{4}, \\frac{\\pi}{4})$。\n- **映射函数：** 位置向量 $\\boldsymbol{r}(\\xi,\\eta)$ 由下式给出 $$\n\\boldsymbol{r}(\\xi,\\eta) \\;=\\; a \\,\\frac{\\big(1,\\;\\tan \\xi,\\;\\tan \\eta\\big)}{\\sqrt{\\,1 + \\tan^{2}\\xi + \\tan^{2}\\eta\\,}}.\n$$\n- **任务：** 求沿 $\\eta$ 为常数的线上、由一个小的坐标增量 $\\Delta \\xi$ 分隔的两个相邻网格点之间的弧长。\n- **近似：** 使用基于度量系数的领先阶近似。\n- **最终表达式：** 必须用 $a$、$\\xi$、$\\eta$ 和 $\\Delta \\xi$ 表示。\n\n**1.2. 验证：**\n- **科学基础：** 该问题牢固地植根于微分几何及其在地球物理模型数值网格生成中的应用。立方球面网格和映射中使用的球心投影是计算科学和大气建模中的标准、成熟的概念。该问题在科学和事实上都是合理的。\n- **适定性：** 该问题提供了特定的映射函数和明确的目标。从诱导度量派生出的弧长概念是定义明确的。预期存在唯一的解析解。\n- **客观性：** 该问题使用精确、客观的数学语言陈述，没有任何主观或模糊的术语。\n- **完整性和一致性：** 提供了所有必要的信息（映射函数、坐标域、所求量）。没有矛盾之处。\n\n**1.3. 结论：**\n该问题是有效的。它是应用微分几何中一个适定且标准的练习题。\n\n### 步骤2：解题推导\n\n参数化曲面上的弧长元 $ds$ 由第一基本形式的平方根给出，$ds^2 = \\boldsymbol{dr} \\cdot \\boldsymbol{dr}$。对于由坐标 $(\\xi, \\eta)$ 参数化的曲面，位置向量的微分为 $\\boldsymbol{dr} = \\frac{\\partial \\boldsymbol{r}}{\\partial \\xi} d\\xi + \\frac{\\partial \\boldsymbol{r}}{\\partial \\eta} d\\eta$。\n于是弧长的平方为：\n$$\nds^2 = \\left(\\frac{\\partial \\boldsymbol{r}}{\\partial \\xi} \\cdot \\frac{\\partial \\boldsymbol{r}}{\\partial \\xi}\\right) d\\xi^2 + 2\\left(\\frac{\\partial \\boldsymbol{r}}{\\partial \\xi} \\cdot \\frac{\\partial \\boldsymbol{r}}{\\partial \\eta}\\right) d\\xi d\\eta + \\left(\\frac{\\partial \\boldsymbol{r}}{\\partial \\eta} \\cdot \\frac{\\partial \\boldsymbol{r}}{\\partial \\eta}\\right) d\\eta^2.\n$$\n这可以写成度量张量分量 $g_{ij}$ 的形式：\n$$\nds^2 = g_{\\xi\\xi} d\\xi^2 + 2g_{\\xi\\eta} d\\xi d\\eta + g_{\\eta\\eta} d\\eta^2.\n$$\n问题要求的是沿 $\\eta$ 为常数的线上的弧长，这意味着 $d\\eta = 0$。表达式简化为：\n$$\nds^2 = g_{\\xi\\xi} d\\xi^2 \\implies ds = \\sqrt{g_{\\xi\\xi}} |d\\xi|.\n$$\n我们的主要任务是计算度量系数 $g_{\\xi\\xi} = \\frac{\\partial \\boldsymbol{r}}{\\partial \\xi} \\cdot \\frac{\\partial \\boldsymbol{r}}{\\partial \\xi}$。\n\n我们将位置向量记为 $\\boldsymbol{r}(\\xi, \\eta) = a \\frac{\\boldsymbol{v}}{D}$，其中 $\\boldsymbol{v} = (1, \\tan\\xi, \\tan\\eta)$ 且 $D = \\sqrt{1 + \\tan^2\\xi + \\tan^2\\eta}$。\n我们首先使用向量商法则计算切向量 $\\boldsymbol{t}_\\xi = \\frac{\\partial \\boldsymbol{r}}{\\partial \\xi}$：\n$$\n\\frac{\\partial \\boldsymbol{r}}{\\partial \\xi} = a \\frac{D \\frac{\\partial \\boldsymbol{v}}{\\partial \\xi} - \\boldsymbol{v} \\frac{\\partial D}{\\partial \\xi}}{D^2}.\n$$\n分量的偏导数是：\n$$\n\\frac{\\partial \\boldsymbol{v}}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} (1, \\tan\\xi, \\tan\\eta) = (0, \\sec^2\\xi, 0).\n$$\n为了求 $\\frac{\\partial D}{\\partial \\xi}$，我们首先对 $D^2$ 进行微分：\n$$\nD^2 = 1 + \\tan^2\\xi + \\tan^2\\eta.\n$$\n$$\n\\frac{\\partial (D^2)}{\\partial \\xi} = 2D \\frac{\\partial D}{\\partial \\xi} = 2\\tan\\xi \\sec^2\\xi.\n$$\n$$\n\\frac{\\partial D}{\\partial \\xi} = \\frac{\\tan\\xi \\sec^2\\xi}{D}.\n$$\n将这些代入 $\\boldsymbol{t}_\\xi$ 的表达式中：\n$$\n\\boldsymbol{t}_\\xi = \\frac{a}{D^2} \\left[ D(0, \\sec^2\\xi, 0) - (1, \\tan\\xi, \\tan\\eta) \\frac{\\tan\\xi \\sec^2\\xi}{D} \\right].\n$$\n为了简化，分子和分母同乘以 $D$：\n$$\n\\boldsymbol{t}_\\xi = \\frac{a}{D^3} \\left[ D^2(0, \\sec^2\\xi, 0) - (1, \\tan\\xi, \\tan\\eta) \\tan\\xi \\sec^2\\xi \\right].\n$$\n$$\n\\boldsymbol{t}_\\xi = \\frac{a \\sec^2\\xi}{D^3} \\left[ (0, D^2, 0) - (\\tan\\xi, \\tan^2\\xi, \\tan\\xi \\tan\\eta) \\right].\n$$\n$$\n\\boldsymbol{t}_\\xi = \\frac{a \\sec^2\\xi}{D^3} (-\\tan\\xi, D^2 - \\tan^2\\xi, -\\tan\\xi \\tan\\eta).\n$$\n将 $D^2 = 1 + \\tan^2\\xi + \\tan^2\\eta$ 代入第二个分量中：\n$$\nD^2 - \\tan^2\\xi = (1 + \\tan^2\\xi + \\tan^2\\eta) - \\tan^2\\xi = 1 + \\tan^2\\eta = \\sec^2\\eta.\n$$\n所以切向量是：\n$$\n\\boldsymbol{t}_\\xi = \\frac{a \\sec^2\\xi}{D^3} (-\\tan\\xi, \\sec^2\\eta, -\\tan\\xi \\tan\\eta).\n$$\n现在，我们通过计算 $\\boldsymbol{t}_\\xi$ 与自身的点积来计算 $g_{\\xi\\xi}$：\n$$\ng_{\\xi\\xi} = \\boldsymbol{t}_\\xi \\cdot \\boldsymbol{t}_\\xi = \\left(\\frac{a \\sec^2\\xi}{D^3}\\right)^2 \\left( (-\\tan\\xi)^2 + (\\sec^2\\eta)^2 + (-\\tan\\xi \\tan\\eta)^2 \\right).\n$$\n$$\ng_{\\xi\\xi} = \\frac{a^2 \\sec^4\\xi}{D^6} \\left( \\tan^2\\xi + \\sec^4\\eta + \\tan^2\\xi \\tan^2\\eta \\right).\n$$\n让我们简化括号中的项。使用 $1+\\tan^2\\eta = \\sec^2\\eta$：\n$$\n\\tan^2\\xi + \\sec^4\\eta + \\tan^2\\xi \\tan^2\\eta = \\tan^2\\xi (1 + \\tan^2\\eta) + \\sec^4\\eta = \\tan^2\\xi \\sec^2\\eta + \\sec^4\\eta.\n$$\n提出公因子 $\\sec^2\\eta$：\n$$\n= \\sec^2\\eta (\\tan^2\\xi + \\sec^2\\eta) = \\sec^2\\eta (\\tan^2\\xi + 1 + \\tan^2\\eta).\n$$\n项 $\\tan^2\\xi + 1 + \\tan^2\\eta$ 等于 $D^2$。所以括号中的表达式简化为 $\\sec^2\\eta \\, D^2$。\n将此代回 $g_{\\xi\\xi}$ 的表达式中：\n$$\ng_{\\xi\\xi} = \\frac{a^2 \\sec^4\\xi}{D^6} (\\sec^2\\eta \\, D^2) = \\frac{a^2 \\sec^4\\xi \\sec^2\\eta}{D^4}.\n$$\n现在我们求 $g_{\\xi\\xi}$ 的平方根：\n$$\n\\sqrt{g_{\\xi\\xi}} = \\sqrt{\\frac{a^2 \\sec^4\\xi \\sec^2\\eta}{D^4}} = \\frac{|a| |\\sec^2\\xi| |\\sec\\eta|}{D^2}.\n$$\n给定 $a > 0$ 且坐标范围为 $(\\xi,\\eta) \\in (-\\frac{\\pi}{4}, \\frac{\\pi}{4}) \\times (-\\frac{\\pi}{4}, \\frac{\\pi}{4})$，我们有 $\\sec\\xi > 0$ 和 $\\sec\\eta > 0$。我们可以去掉绝对值符号。\n$$\n\\sqrt{g_{\\xi\\xi}} = \\frac{a \\sec^2\\xi \\sec\\eta}{D^2} = \\frac{a \\sec^2\\xi \\sec\\eta}{1 + \\tan^2\\xi + \\tan^2\\eta}.\n$$\n对于沿 $\\eta$ 为常数的线上的一个小的有限增量 $\\Delta \\xi$，其弧长 $\\Delta s$ 由领先阶近似给出：\n$$\n\\Delta s \\approx \\sqrt{g_{\\xi\\xi}} \\Delta\\xi.\n$$\n代入推导出的 $\\sqrt{g_{\\xi\\xi}}$ 表达式，得到最终结果。为了清晰起见，我们可以使用恒等式 $1+\\tan^2\\xi=\\sec^2\\xi$ 来简化分母：\n$$\n\\Delta s \\approx \\frac{a \\sec^2\\xi \\sec\\eta}{\\sec^2\\xi + \\tan^2\\eta} \\Delta\\xi.\n$$\n这就是所要求的弧长的闭式解析表达式。",
            "answer": "$$\n\\boxed{\\frac{a \\sec^{2}\\xi \\sec\\eta}{\\sec^{2}\\xi + \\tan^{2}\\eta} \\Delta\\xi}\n$$"
        },
        {
            "introduction": "一旦我们能够测量距离，下一步就是正确地表述涉及矢量导数的物理定律。在一个曲面上，我们熟悉的偏导数是不够的。这个练习将指导您计算克里斯托费尔符号（Christoffel symbols），这些数学对象用于修正网格曲率带来的影响，从而能够恰当地定义协变导数，并在物理模型中准确地表示矢量微积分运算。",
            "id": "4029380",
            "problem": "考虑一个用球面坐标参数化的球面区域，这常用于数值天气预报 (NWP) 和气候模拟。局部角坐标 $(\\alpha,\\beta)$（以弧度为单位）通过以下嵌入方式参数化了半径为 $a$ 的球面：\n$$\n\\mathbf{R}(\\alpha,\\beta) \\;=\\; a \\, \\big( \\cos\\alpha \\,\\cos\\beta,\\; \\sin\\alpha \\,\\cos\\beta,\\; \\sin\\beta \\big),\n$$\n在该面上，$\\alpha \\in \\left(-\\frac{\\pi}{4},\\frac{\\pi}{4}\\right)$ 且 $\\beta \\in \\left(-\\frac{\\pi}{4},\\frac{\\pi}{4}\\right)$。请使用曲面微分几何的第一性原理以及黎曼流形上协变导数的定义来解决以下问题：\n\n- 从由嵌入诱导的曲面度规的基本定义出发，推导该面上局部坐标 $(\\alpha,\\beta)$下的度规系数 $g_{ij}$ 和逆度规 $g^{ij}$。\n- 使用以 $g_{ij}$ 表示的克里斯托费尔符号 $\\Gamma^{k}_{ij}$ 的定义，求出该面上的非零克里斯托费尔符号，并证明它们确实是 $(\\alpha,\\beta)$ 的非零函数。\n- 使用球面上逆变矢量场 $v^{i}$ 的协变导数定义，写出在这些坐标下 $\\nabla_{\\alpha} v^{\\alpha}$ 的表达式，并明确展示克里斯托费尔符号在立方球面网格上离散化协变导数中的作用。\n\n最后，提供该面上克里斯托费尔符号 $\\Gamma^{\\alpha}_{\\alpha\\beta}$ 关于 $\\beta$ 的精确闭式表达式。你的最终答案必须是单一的解析表达式。不需要数值近似或四舍五入，且最终表达式中不应包含任何单位。",
            "solution": "该问题是有效的，因为它在微分几何方面有科学依据，是适定的、客观的，并包含了获得唯一解所需的所有必要信息。所要求的步骤是在流形上分析曲线坐标系的标准程序，这是在诸如立方球面等球形域上进行数值模拟的一个基本方面。\n\n设曲面上的局部坐标表示为 $(u^1, u^2) = (\\alpha, \\beta)$。描述半径为 $a$ 的球面的位置矢量 $\\mathbf{R}$ 由下式给出：\n$$\n\\mathbf{R}(\\alpha,\\beta) \\;=\\; a \\begin{pmatrix} \\cos\\alpha \\cos\\beta \\\\ \\sin\\alpha \\cos\\beta \\\\ \\sin\\beta \\end{pmatrix}\n$$\n\n第一步是推导度规张量 $g_{ij}$ 及其逆 $g^{ij}$。度规张量的分量由切向基矢的内积定义，$g_{ij} = \\mathbf{e}_i \\cdot \\mathbf{e}_j$，其中 $\\mathbf{e}_i = \\frac{\\partial \\mathbf{R}}{\\partial u^i}$。\n\n首先，我们计算切向基矢：\n$$\n\\mathbf{e}_{\\alpha} = \\frac{\\partial \\mathbf{R}}{\\partial \\alpha} = a \\begin{pmatrix} -\\sin\\alpha \\cos\\beta \\\\ \\cos\\alpha \\cos\\beta \\\\ 0 \\end{pmatrix}\n$$\n$$\n\\mathbf{e}_{\\beta} = \\frac{\\partial \\mathbf{R}}{\\partial \\beta} = a \\begin{pmatrix} -\\cos\\alpha \\sin\\beta \\\\ -\\sin\\alpha \\sin\\beta \\\\ \\cos\\beta \\end{pmatrix}\n$$\n现在，我们通过计算点积来计算度规张量 $g_{ij}$ 的分量：\n$$\ng_{\\alpha\\alpha} = \\mathbf{e}_{\\alpha} \\cdot \\mathbf{e}_{\\alpha} = a^2 \\left( (-\\sin\\alpha \\cos\\beta)^2 + (\\cos\\alpha \\cos\\beta)^2 + 0^2 \\right) = a^2 \\cos^2\\beta (\\sin^2\\alpha + \\cos^2\\alpha) = a^2 \\cos^2\\beta\n$$\n$$\ng_{\\beta\\beta} = \\mathbf{e}_{\\beta} \\cdot \\mathbf{e}_{\\beta} = a^2 \\left( (-\\cos\\alpha \\sin\\beta)^2 + (-\\sin\\alpha \\sin\\beta)^2 + (\\cos\\beta)^2 \\right) = a^2 \\left( \\sin^2\\beta (\\cos^2\\alpha + \\sin^2\\alpha) + \\cos^2\\beta \\right) = a^2 (\\sin^2\\beta + \\cos^2\\beta) = a^2\n$$\n$$\ng_{\\alpha\\beta} = \\mathbf{e}_{\\alpha} \\cdot \\mathbf{e}_{\\beta} = a^2 \\left( (-\\sin\\alpha\\cos\\beta)(-\\cos\\alpha\\sin\\beta) + (\\cos\\alpha\\cos\\beta)(-\\sin\\alpha\\sin\\beta) + 0 \\right) = a^2(\\sin\\alpha\\cos\\alpha\\sin\\beta\\cos\\beta - \\sin\\alpha\\cos\\alpha\\sin\\beta\\cos\\beta) = 0\n$$\n由于 $g_{\\alpha\\beta} = g_{\\beta\\alpha}$，度规张量是对角的：\n$$\ng_{ij} = \\begin{pmatrix} g_{\\alpha\\alpha}  g_{\\alpha\\beta} \\\\ g_{\\beta\\alpha}  g_{\\beta\\beta} \\end{pmatrix} = \\begin{pmatrix} a^2 \\cos^2\\beta  0 \\\\ 0  a^2 \\end{pmatrix}\n$$\n逆度规张量 $g^{ij}$ 是 $g_{ij}$ 的矩阵的逆。对于对角矩阵，其逆矩阵通过取每个对角元素的倒数得到：\n$$\ng^{ij} = \\begin{pmatrix} \\frac{1}{g_{\\alpha\\alpha}}  0 \\\\ 0  \\frac{1}{g_{\\beta\\beta}} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{a^2 \\cos^2\\beta}  0 \\\\ 0  \\frac{1}{a^2} \\end{pmatrix}\n$$\n因此，$g^{\\alpha\\alpha} = \\frac{1}{a^2 \\cos^2\\beta}$，$g^{\\beta\\beta} = \\frac{1}{a^2}$，且 $g^{\\alpha\\beta} = g^{\\beta\\alpha} = 0$。\n\n接下来，我们使用以下公式计算第二类克里斯托费尔符号 $\\Gamma^k_{ij}$：\n$$\n\\Gamma^k_{ij} = \\frac{1}{2} g^{kl} \\left( \\frac{\\partial g_{li}}{\\partial u^j} + \\frac{\\partial g_{lj}}{\\partial u^i} - \\frac{\\partial g_{ij}}{\\partial u^l} \\right)\n$$\n这里隐含了对指标 $l \\in \\{\\alpha, \\beta\\}$ 的求和。首先，我们需要度规分量相对于坐标 $\\alpha$ 和 $\\beta$ 的偏导数：\n$$\n\\frac{\\partial g_{\\alpha\\alpha}}{\\partial \\alpha} = 0, \\quad \\frac{\\partial g_{\\beta\\beta}}{\\partial \\alpha} = 0, \\quad \\frac{\\partial g_{\\alpha\\beta}}{\\partial \\alpha} = 0\n$$\n$$\n\\frac{\\partial g_{\\alpha\\alpha}}{\\partial \\beta} = \\frac{\\partial}{\\partial \\beta}(a^2 \\cos^2\\beta) = a^2 (2\\cos\\beta)(-\\sin\\beta) = -2a^2 \\sin\\beta \\cos\\beta\n$$\n$$\n\\frac{\\partial g_{\\beta\\beta}}{\\partial \\beta} = \\frac{\\partial}{\\partial \\beta}(a^2) = 0, \\quad \\frac{\\partial g_{\\alpha\\beta}}{\\partial \\beta} = 0\n$$\n唯一的非零偏导数是 $\\frac{\\partial g_{\\alpha\\alpha}}{\\partial \\beta}$。这极大地简化了计算。\n\n让我们计算非零的克里斯托费尔符号：\n- $\\Gamma^k_{\\alpha\\alpha} = \\frac{1}{2} g^{kl} \\left( \\frac{\\partial g_{l\\alpha}}{\\partial \\alpha} + \\frac{\\partial g_{l\\alpha}}{\\partial \\alpha} - \\frac{\\partial g_{\\alpha\\alpha}}{\\partial u^l} \\right) = -\\frac{1}{2} g^{kl} \\frac{\\partial g_{\\alpha\\alpha}}{\\partial u^l}$。\n  当 $k=\\alpha$ 时: $\\Gamma^{\\alpha}_{\\alpha\\alpha} = -\\frac{1}{2} \\left( g^{\\alpha\\alpha} \\frac{\\partial g_{\\alpha\\alpha}}{\\partial \\alpha} + g^{\\alpha\\beta} \\frac{\\partial g_{\\alpha\\alpha}}{\\partial \\beta} \\right) = -\\frac{1}{2}\\left(g^{\\alpha\\alpha}(0) + 0 \\right) = 0$。\n  当 $k=\\beta$ 时: $\\Gamma^{\\beta}_{\\alpha\\alpha} = -\\frac{1}{2} \\left( g^{\\beta\\alpha} \\frac{\\partial g_{\\alpha\\alpha}}{\\partial \\alpha} + g^{\\beta\\beta} \\frac{\\partial g_{\\alpha\\alpha}}{\\partial \\beta} \\right) = -\\frac{1}{2}\\left( 0 + \\frac{1}{a^2} (-2a^2 \\sin\\beta \\cos\\beta) \\right) = \\sin\\beta \\cos\\beta$。\n\n- $\\Gamma^k_{\\beta\\beta} = \\frac{1}{2} g^{kl} \\left( \\frac{\\partial g_{l\\beta}}{\\partial \\beta} + \\frac{\\partial g_{l\\beta}}{\\partial \\beta} - \\frac{\\partial g_{\\beta\\beta}}{\\partial u^l} \\right) = \\frac{1}{2} g^{kl} \\left( 2\\frac{\\partial g_{l\\beta}}{\\partial \\beta} - \\frac{\\partial g_{\\beta\\beta}}{\\partial u^l} \\right)$。\n  由于 $g_{l\\beta}$ 仅在 $l=\\beta$ 时非零，且对于所有 $l$，$\\frac{\\partial g_{\\beta\\beta}}{\\partial u^l}=0$，因此所有项都为零。所以对于 $k = \\alpha, \\beta$，$\\Gamma^k_{\\beta\\beta} = 0$。\n\n- $\\Gamma^k_{\\alpha\\beta} = \\frac{1}{2} g^{kl} \\left( \\frac{\\partial g_{l\\alpha}}{\\partial \\beta} + \\frac{\\partial g_{l\\beta}}{\\partial \\alpha} - \\frac{\\partial g_{\\alpha\\beta}}{\\partial u^l} \\right)$。由于 $g_{\\alpha\\beta}=0$ 且对于所有 $l$，$\\frac{\\partial g_{l\\beta}}{\\partial \\alpha}=0$，这可以简化为 $\\Gamma^k_{\\alpha\\beta} = \\frac{1}{2} g^{kl} \\frac{\\partial g_{l\\alpha}}{\\partial \\beta}$。\n  当 $k=\\alpha$ 时: $\\Gamma^{\\alpha}_{\\alpha\\beta} = \\frac{1}{2} \\left( g^{\\alpha\\alpha} \\frac{\\partial g_{\\alpha\\alpha}}{\\partial \\beta} + g^{\\alpha\\beta} \\frac{\\partial g_{\\beta\\alpha}}{\\partial \\beta} \\right) = \\frac{1}{2} g^{\\alpha\\alpha} \\frac{\\partial g_{\\alpha\\alpha}}{\\partial \\beta} = \\frac{1}{2} \\left( \\frac{1}{a^2 \\cos^2\\beta} \\right) (-2a^2 \\sin\\beta \\cos\\beta) = -\\frac{\\sin\\beta \\cos\\beta}{\\cos^2\\beta} = -\\tan\\beta$。\n  当 $k=\\beta$ 时: $\\Gamma^{\\beta}_{\\alpha\\beta} = \\frac{1}{2} \\left( g^{\\beta\\alpha} \\frac{\\partial g_{\\alpha\\alpha}}{\\partial \\beta} + g^{\\beta\\beta} \\frac{\\partial g_{\\beta\\alpha}}{\\partial \\beta} \\right) = \\frac{1}{2} (0 + 0) = 0$。\n\n根据对称性，$\\Gamma^k_{ji} = \\Gamma^k_{ij}$，所以 $\\Gamma^{\\alpha}_{\\beta\\alpha} = \\Gamma^{\\alpha}_{\\alpha\\beta} = -\\tan\\beta$。\n非零的克里斯托费尔符号是：\n$$\n\\Gamma^{\\beta}_{\\alpha\\alpha} = \\sin\\beta \\cos\\beta\n$$\n$$\n\\Gamma^{\\alpha}_{\\alpha\\beta} = \\Gamma^{\\alpha}_{\\beta\\alpha} = -\\tan\\beta\n$$\n这些是 $\\beta$ 的函数，对于任意 $\\beta \\in \\left(-\\frac{\\pi}{4},\\frac{\\pi}{4}\\right)$（$\\beta=0$ 除外），它们都非零。这证明了它们确实是该面片上的非零函数。\n\n现在，我们写出逆变矢量场 $v^i$ 的协变导数 $\\nabla_j v^i$ 的表达式。通用公式为：\n$$\n\\nabla_j v^i = \\frac{\\partial v^i}{\\partial u^j} + \\Gamma^i_{jk} v^k\n$$\n题目要求的是 $\\nabla_{\\alpha} v^{\\alpha}$。在这种情况下，$j=\\alpha$ 且 $i=\\alpha$。表达式变为：\n$$\n\\nabla_{\\alpha} v^{\\alpha} = \\frac{\\partial v^{\\alpha}}{\\partial \\alpha} + \\Gamma^{\\alpha}_{\\alpha k} v^k\n$$\n展开对指标 $k \\in \\{\\alpha, \\beta\\}$ 的求和：\n$$\n\\nabla_{\\alpha} v^{\\alpha} = \\frac{\\partial v^{\\alpha}}{\\partial \\alpha} + \\Gamma^{\\alpha}_{\\alpha\\alpha} v^{\\alpha} + \\Gamma^{\\alpha}_{\\alpha\\beta} v^{\\beta}\n$$\n代入我们推导出的克里斯托费尔符号：\n$$\n\\nabla_{\\alpha} v^{\\alpha} = \\frac{\\partial v^{\\alpha}}{\\partial \\alpha} + (0) v^{\\alpha} + (-\\tan\\beta) v^{\\beta} = \\frac{\\partial v^{\\alpha}}{\\partial \\alpha} - v^{\\beta} \\tan\\beta\n$$\n这个表达式明确地显示了克里斯托费尔符号的作用。项 $-v^{\\beta}\\tan\\beta$ 是对偏导数 $\\frac{\\partial v^{\\alpha}}{\\partial \\alpha}$ 的修正，它解释了流形的曲率以及局部坐标系投影的非正交性质。在数值离散化中，这个“虚拟力”项对于在曲面上精确表示粒子或流体运动至关重要。\n\n最后，问题要求克里斯托费尔符号 $\\Gamma^{\\alpha}_{\\alpha\\beta}$ 的精确闭式表达式。如上所述，其表达式为：\n$$\n\\Gamma^{\\alpha}_{\\alpha\\beta} = -\\tan\\beta\n$$",
            "answer": "$$\n\\boxed{-\\tan\\beta}\n$$"
        },
        {
            "introduction": "从连续数学到离散数值算法的跨越是计算建模中的一个核心挑战。本练习解决了一个在立方球体网格上使用有限体积法时遇到的关键实际问题：如何确保在三个面板交汇的角落处物理量守恒。通过推导一个加权的通量分配方案，您将学习如何设计一个既能保证二阶精度又守恒的数值方法，这两者都是任何可靠的长期气候或天气模拟所必需的基本属性。",
            "id": "4029407",
            "problem": "考虑一个用于数值天气预报（NWP）和气候模拟的球面上标量示踪物通量的有限体积离散化，该离散化在立方球网格上实现。在一个映射到球面上的立方体角点处，三个面板在一个公共点相交。将交于此角点的三条面板边缘段用索引 $i \\in \\{1,2,3\\}$ 表示，每条边上都有指向外部的单位切线方向，并且根据每个面板的边界方向定义了指向外部的单位法线。设这些边缘段的物理测地线长度为 $\\ell_{i}$，由局部曲线度量和网格间距计算得出，具体为 $\\ell_{i} = a\\,h_{\\text{edge},i}\\,\\Delta\\lambda_{i}$，其中 $a$ 是地球的平均球面半径，$h_{\\text{edge},i}$ 是与相应球心投影（立方球）面板坐标相关的线元度量系数，$\\Delta\\lambda_{i}$ 是沿该边参数的相应计算网格间距。\n\n假设每个面板单元的边界通量积分是沿其边缘使用复合梯形法则进行二阶精度近似的。对于交于角点的边缘段，此法则引入了与角点通量密度值 $q_{C}$（在角点处计算的标量通量密度）成正比的端点贡献。由于该角点由三个面板共享，对面板局部的边缘积分进行简单求和会导致对角点贡献的三重计数。为了在保持二阶精度和全局守恒的同时防止双重或三重计数，通过引入无量纲权重 $w_{i}$ 来定义面板局部的角点分配，这些权重将唯一的角点贡献划分给三个相交的边缘。权重必须满足以下约束条件：\n- 权重必须构成一个单位分解：$\\sum_{i=1}^{3} w_{i} = 1$。\n- 对于三个相邻单元的并集，其组合的边界积分对于在角点附近局部线性的任何标量通量密度都必须是二阶精确的（即，对于沿每条边从角点测量的弧长 $s$ 形式为 $q(s) = q_{C} + \\beta\\,s$ 的函数是精确的）。\n- 该划分必须是守恒的，并且对于由曲线度量所隐含的边缩放是对称的（也就是说，它不能依赖于任意的面板标记，并且必须随着边长 $\\ell_{i}$ 的变化而平滑变化）。\n\n从曲面散度定理和复合梯形法则的定义出发，推导一个在角点处二阶精确的边到单元的通量匹配方法，该方法通过使用一致的权重划分角点贡献来避免双重计数。用仅包含相交边长 $\\ell_{i}$ 的闭合形式表达式来表示权重 $w_{i}$。\n\n你的最终答案必须是使用 LaTeX pmatrix 环境编写的权重的单个 $1\\times 3$ 行矩阵形式的闭合形式解析表达式。不需要进行数值四舍五入。不要在最终的方框答案中包含单位。",
            "solution": "用户希望通过以下步骤解决问题：\n1.  验证问题陈述。\n2.  如果有效，提供一个有理有据的解决方案。\n3.  按照严格的规则（XML标签、LaTeX、无Markdown标题）格式化整个输出。\n\n### 第1步：提取已知条件\n-   **系统**：立方球网格上标量示踪物通量的有限体积离散化。\n-   **几何**：一个三个面板相交的角点，有三条交于该点的面板边缘段，索引为 $i \\in \\{1, 2, 3\\}$。\n-   **边长**：物理测地线长度 $\\ell_i$。\n-   **数值方法**：边界通量积分使用复合梯形法则进行近似，该方法被描述为二阶精确。\n-   **角点通量**：角点处的标量通量密度表示为 $q_C$。\n-   **目标**：推导用于划分角点通量贡献的无量纲权重 $w_i$。\n-   **对权重 $w_i$ 的约束**：\n    1.  单位分解：$\\sum_{i=1}^{3} w_{i} = 1$。\n    2.  二阶精度：组合的数值格式对于沿每条边局部线性的任何标量通量密度 $q(s)$ 都必须是精确的，即 $q(s) = q_C + \\beta s$，其中 $s$ 是从角点开始的弧长。\n    3.  对称性与守恒性：权重应依赖于边长 $\\ell_i$ 对称，且与任意标记无关。\n\n### 第2步：使用提取的已知条件进行验证\n-   **科学依据**：该问题在天气和气候数值模拟领域有坚实的科学基础，特别是涉及网格离散化（立方球）和数值方法（有限体积、梯形法则）。网格角点处的通量计算挑战是该领域的标准课题。\n-   **适定性**：该问题是适定的。它要求基于一组明确的数学约束，求解一组特定的函数（权重 $w_i$）。这些约束似乎足以确定一个唯一的解。\n-   **客观性**：问题以精确、客观和技术性的语言陈述，没有歧义或主观论断。\n\n### 第3步：结论与行动\n该问题是有效的。它描述了在复杂网格上设计高阶、守恒数值格式中的一个标准问题。我现在将进行推导。\n\n### 权重的推导\n\n该问题要求推导权重 $w_i$，以划分角点通量密度 $q_C$ 对相邻单元边界通量积分的贡献。该方法必须是守恒和二阶精确的，这被定义为对局部线性通量分布是精确的。\n\n我们考虑一个长度为 $\\ell_i$ 的边缘段 $i$，它从角点 $C$（弧长 $s=0$）开始，到相邻的网格点 $N_i$（弧长 $s=\\ell_i$）结束。沿此边的通量积分为 $I_i = \\int_0^{\\ell_i} q(s) ds$。\n\n问题陈述指出，简单地应用梯形法则会导致计数问题。为了解决这个问题，我们要构建一个划分“唯一角点贡献”的方法。我们对此的解释如下：首先，我们基于基准的梯形法则定义一个总的角点通量贡献 $Q_C$。其次，我们使用权重 $w_i$ 将这个总贡献划分给三个相交的边缘。\n\n角点 $C$ 对边 $i$ 上通量的梯形法则近似的贡献是 $\\frac{1}{2}\\ell_i q_C$。要划分的“唯一角点贡献” $Q_C$ 可以定义为所有三个相交边缘上这些贡献的总和：\n$$\nQ_C = \\sum_{j=1}^{3} \\frac{1}{2}\\ell_j q_C = \\frac{1}{2} (\\ell_1 + \\ell_2 + \\ell_3) q_C\n$$\n新方法将此总贡献的一部分 $w_i Q_C$ 分配给边 $i$ 的通量积分。来自另一个端点 $N_i$ 的贡献保持与标准梯形法则中相同，即 $\\frac{1}{2}\\ell_i q_{N_i}$，其中 $q_{N_i} = q(\\ell_i)$。\n\n因此，边 $i$ 的修正数值通量积分，记为 $\\tilde{I}_i$，由下式给出：\n$$\n\\tilde{I}_i = w_i Q_C + \\frac{\\ell_i}{2} q_{N_i}\n$$\n代入 $Q_C$ 的表达式，我们得到：\n$$\n\\tilde{I}_i = w_i \\left( \\frac{1}{2} \\sum_{j=1}^{3} \\ell_j \\right) q_C + \\frac{\\ell_i}{2} q_{N_i}\n$$\n现在，我们强制执行二阶精度约束，这要求此法则对于任何局部线性的通量密度都是精确的。设边 $i$ 上的通量密度为 $q(s) = q_C + \\beta_i s$，其中 $\\beta_i$ 是某个常数。\n\n精确积分 $I_i$ 是：\n$$\nI_i = \\int_0^{\\ell_i} (q_C + \\beta_i s) ds = q_C \\ell_i + \\frac{1}{2} \\beta_i \\ell_i^2\n$$\n端点 $N_i$ 处的通量密度值为 $q_{N_i} = q(\\ell_i) = q_C + \\beta_i \\ell_i$。将其代入我们的数值通量 $\\tilde{I}_i$ 的表达式中：\n$$\n\\tilde{I}_i = w_i \\left( \\frac{1}{2} \\sum_{j=1}^{3} \\ell_j \\right) q_C + \\frac{\\ell_i}{2} (q_C + \\beta_i \\ell_i) = \\left[ w_i \\frac{1}{2}\\left(\\sum_{j=1}^{3} \\ell_j\\right) + \\frac{\\ell_i}{2} \\right] q_C + \\frac{1}{2} \\beta_i \\ell_i^2\n$$\n为了使数值方法对于这个线性函数是精确的，我们必须有 $\\tilde{I}_i = I_i$。比较 $\\tilde{I}_i$ 和 $I_i$ 的表达式，包含 $\\beta_i$ 的项已经匹配。该等式必须对任何 $q_C$ 的值都成立，因此 $q_C$ 的系数必须相等：\n$$\nw_i \\frac{1}{2}\\left(\\sum_{j=1}^{3} \\ell_j\\right) + \\frac{\\ell_i}{2} = \\ell_i\n$$\n我们解此方程得到权重 $w_i$：\n$$\nw_i \\frac{1}{2}\\left(\\sum_{j=1}^{3} \\ell_j\\right) = \\ell_i - \\frac{\\ell_i}{2} = \\frac{\\ell_i}{2}\n$$\n$$\nw_i \\left(\\sum_{j=1}^{3} \\ell_j\\right) = \\ell_i\n$$\n这给出了权重的闭合形式表达式：\n$$\nw_i = \\frac{\\ell_i}{\\ell_1 + \\ell_2 + \\ell_3}\n$$\n我们检查其他约束。\n1.  **单位分解**：权重的总和是 $\\sum_{i=1}^{3} w_i = \\sum_{i=1}^{3} \\frac{\\ell_i}{\\ell_1 + \\ell_2 + \\ell_3} = \\frac{\\ell_1 + \\ell_2 + \\ell_3}{\\ell_1 + \\ell_2 + \\ell_3} = 1$。此约束得到满足。\n2.  **对称性与守恒性**：$w_i$ 的公式对称地依赖于其他边的长度（通过分母中的和），并平滑地依赖于所有的 $\\ell_i$。它完全按照要求以物理边长表示。\n\n这些权重代表了每条边的长度相对于三条相交边总长度的比例。该公式提供了一种系统的方法来证明通量计算的合理性，解决了问题中提到的“计数”模糊性，确保了最终的格式是守恒和二阶精确的。一个有趣的结果是，将这些权重代回所提出的 $\\tilde{I}_i$ 公式，会恢复边 $i$ 上通量的标准梯形法则表达式：$\\tilde{I}_i = \\frac{\\ell_i}{2} q_C + \\frac{\\ell_i}{2} q_{N_i}$。该推导表明，在所提出的加权划分格式族中，这个标准法则是满足二阶精度要求的唯一方法。\n\n最终答案是表示为行矩阵的权重集 $\\{w_1, w_2, w_3\\}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\ell_1}{\\ell_1 + \\ell_2 + \\ell_3} & \\frac{\\ell_2}{\\ell_1 + \\ell_2 + \\ell_3} & \\frac{\\ell_3}{\\ell_1 + \\ell_2 + \\ell_3}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}