{
    "hands_on_practices": [
        {
            "introduction": "A crucial first step in analyzing any numerical grid is to understand its geometric properties, such as the physical distance between grid points. This exercise provides direct practice in using the tools of differential geometry to quantify the non-uniform grid spacing on a cubed-sphere panel. By calculating the arc length from the induced metric, you will gain a concrete understanding of how the grid scale factor varies as a function of position on the panel .",
            "id": "4029356",
            "problem": "In a global atmospheric model employing an equiangular cubed-sphere grid, consider the mapping from panel coordinates $\\xi$ and $\\eta$ (in radians) on the $+x$ face to the sphere of radius $a$ given by the smooth embedding\n$$\n\\boldsymbol{r}(\\xi,\\eta) \\;=\\; a \\,\\frac{\\big(1,\\;\\tan \\xi,\\;\\tan \\eta\\big)}{\\sqrt{\\,1 + \\tan^{2}\\xi + \\tan^{2}\\eta\\,}}, \\qquad (\\xi,\\eta)\\in\\big(-\\tfrac{\\pi}{4},\\tfrac{\\pi}{4}\\big)\\times\\big(-\\tfrac{\\pi}{4},\\tfrac{\\pi}{4}\\big).\n$$\nUsing the induced metric on the sphere from this mapping, derive a closed-form analytical expression for the arc length between two adjacent grid points along a line of constant $\\eta$ that are separated by a small coordinate increment $\\Delta \\xi$. Assume $\\Delta \\xi$ is sufficiently small that the leading-order approximation based on the metric coefficient along $\\xi$ applies. Express your final result explicitly in terms of $a$, $\\xi$, $\\eta$, and $\\Delta \\xi$. Your answer must be a single analytical expression and you do not need to provide units.",
            "solution": "The user wants to find a closed-form analytical expression for the arc length between two adjacent grid points on a cubed-sphere grid. The provided mapping is from panel coordinates $(\\xi, \\eta)$ on the $+x$ face to a sphere of radius $a$.\n\n### Step 1: Problem Validation\n\n**1.1. Extracted Givens:**\n- **Geometry:** Sphere of radius $a$.\n- **Grid:** Equiangular cubed-sphere grid.\n- **Coordinates:** Panel coordinates $(\\xi,\\eta) \\in (-\\frac{\\pi}{4}, \\frac{\\pi}{4}) \\times (-\\frac{\\pi}{4}, \\frac{\\pi}{4})$.\n- **Mapping Function:** The position vector $\\boldsymbol{r}(\\xi,\\eta)$ is given by $$\n\\boldsymbol{r}(\\xi,\\eta) \\;=\\; a \\,\\frac{\\big(1,\\;\\tan \\xi,\\;\\tan \\eta\\big)}{\\sqrt{\\,1 + \\tan^{2}\\xi + \\tan^{2}\\eta\\,}}.\n$$\n- **Task:** Find the arc length between two adjacent grid points along a line of constant $\\eta$, separated by a small coordinate increment $\\Delta \\xi$.\n- **Approximation:** Use the leading-order approximation based on the metric coefficient.\n- **Final Expression:** Must be in terms of $a$, $\\xi$, $\\eta$, and $\\Delta \\xi$.\n\n**1.2. Validation:**\n- **Scientific Grounding:** The problem is firmly rooted in differential geometry and its application to numerical grid generation for geophysical models. The cubed-sphere grid and the gnomonic projection used in the mapping are standard, well-established concepts in computational science and atmospheric modeling. The problem is scientifically and factually sound.\n- **Well-Posedness:** The problem provides a specific mapping function and a clear objective. The concept of arc length derived from an induced metric is well-defined. A unique analytical solution is expected to exist.\n- **Objectivity:** The problem is stated using precise, objective mathematical language, free from any subjective or ambiguous terminology.\n- **Completeness and Consistency:** All necessary information (mapping function, coordinate domain, desired quantity) is provided. There are no contradictions.\n\n**1.3. Verdict:**\nThe problem is valid. It is a well-posed and standard exercise in applied differential geometry.\n\n### Step 2: Derivation of the Solution\n\nThe arc length element $ds$ on a parameterized surface is given by the square root of the first fundamental form, $ds^2 = \\boldsymbol{dr} \\cdot \\boldsymbol{dr}$. For a surface parameterized by coordinates $(\\xi, \\eta)$, the differential position vector is $\\boldsymbol{dr} = \\frac{\\partial \\boldsymbol{r}}{\\partial \\xi} d\\xi + \\frac{\\partial \\boldsymbol{r}}{\\partial \\eta} d\\eta$.\nThe squared arc length is then:\n$$\nds^2 = \\left(\\frac{\\partial \\boldsymbol{r}}{\\partial \\xi} \\cdot \\frac{\\partial \\boldsymbol{r}}{\\partial \\xi}\\right) d\\xi^2 + 2\\left(\\frac{\\partial \\boldsymbol{r}}{\\partial \\xi} \\cdot \\frac{\\partial \\boldsymbol{r}}{\\partial \\eta}\\right) d\\xi d\\eta + \\left(\\frac{\\partial \\boldsymbol{r}}{\\partial \\eta} \\cdot \\frac{\\partial \\boldsymbol{r}}{\\partial \\eta}\\right) d\\eta^2.\n$$\nThis can be written in terms of the metric tensor components $g_{ij}$:\n$$\nds^2 = g_{\\xi\\xi} d\\xi^2 + 2g_{\\xi\\eta} d\\xi d\\eta + g_{\\eta\\eta} d\\eta^2.\n$$\nThe problem asks for the arc length along a line of constant $\\eta$, which means $d\\eta = 0$. The expression simplifies to:\n$$\nds^2 = g_{\\xi\\xi} d\\xi^2 \\implies ds = \\sqrt{g_{\\xi\\xi}} |d\\xi|.\n$$\nOur main task is to compute the metric coefficient $g_{\\xi\\xi} = \\frac{\\partial \\boldsymbol{r}}{\\partial \\xi} \\cdot \\frac{\\partial \\boldsymbol{r}}{\\partial \\xi}$.\n\nLet's denote the position vector as $\\boldsymbol{r}(\\xi, \\eta) = a \\frac{\\boldsymbol{v}}{D}$, where $\\boldsymbol{v} = (1, \\tan\\xi, \\tan\\eta)$ and $D = \\sqrt{1 + \\tan^2\\xi + \\tan^2\\eta}$.\nWe first compute the tangent vector $\\boldsymbol{t}_\\xi = \\frac{\\partial \\boldsymbol{r}}{\\partial \\xi}$ using the vector quotient rule:\n$$\n\\frac{\\partial \\boldsymbol{r}}{\\partial \\xi} = a \\frac{D \\frac{\\partial \\boldsymbol{v}}{\\partial \\xi} - \\boldsymbol{v} \\frac{\\partial D}{\\partial \\xi}}{D^2}.\n$$\nThe partial derivatives of the components are:\n$$\n\\frac{\\partial \\boldsymbol{v}}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} (1, \\tan\\xi, \\tan\\eta) = (0, \\sec^2\\xi, 0).\n$$\nTo find $\\frac{\\partial D}{\\partial \\xi}$, we first differentiate $D^2$:\n$$\nD^2 = 1 + \\tan^2\\xi + \\tan^2\\eta.\n$$\n$$\n\\frac{\\partial (D^2)}{\\partial \\xi} = 2D \\frac{\\partial D}{\\partial \\xi} = 2\\tan\\xi \\sec^2\\xi.\n$$\n$$\n\\frac{\\partial D}{\\partial \\xi} = \\frac{\\tan\\xi \\sec^2\\xi}{D}.\n$$\nSubstituting these into the expression for $\\boldsymbol{t}_\\xi$:\n$$\n\\boldsymbol{t}_\\xi = \\frac{a}{D^2} \\left[ D(0, \\sec^2\\xi, 0) - (1, \\tan\\xi, \\tan\\eta) \\frac{\\tan\\xi \\sec^2\\xi}{D} \\right].\n$$\nTo simplify, multiply the numerator and denominator by $D$:\n$$\n\\boldsymbol{t}_\\xi = \\frac{a}{D^3} \\left[ D^2(0, \\sec^2\\xi, 0) - (1, \\tan\\xi, \\tan\\eta) \\tan\\xi \\sec^2\\xi \\right].\n$$\n$$\n\\boldsymbol{t}_\\xi = \\frac{a \\sec^2\\xi}{D^3} \\left[ (0, D^2, 0) - (\\tan\\xi, \\tan^2\\xi, \\tan\\xi \\tan\\eta) \\right].\n$$\n$$\n\\boldsymbol{t}_\\xi = \\frac{a \\sec^2\\xi}{D^3} (-\\tan\\xi, D^2 - \\tan^2\\xi, -\\tan\\xi \\tan\\eta).\n$$\nSubstitute $D^2 = 1 + \\tan^2\\xi + \\tan^2\\eta$ into the second component:\n$$\nD^2 - \\tan^2\\xi = (1 + \\tan^2\\xi + \\tan^2\\eta) - \\tan^2\\xi = 1 + \\tan^2\\eta = \\sec^2\\eta.\n$$\nSo the tangent vector is:\n$$\n\\boldsymbol{t}_\\xi = \\frac{a \\sec^2\\xi}{D^3} (-\\tan\\xi, \\sec^2\\eta, -\\tan\\xi \\tan\\eta).\n$$\nNow, we compute $g_{\\xi\\xi}$ by taking the dot product of $\\boldsymbol{t}_\\xi$ with itself:\n$$\ng_{\\xi\\xi} = \\boldsymbol{t}_\\xi \\cdot \\boldsymbol{t}_\\xi = \\left(\\frac{a \\sec^2\\xi}{D^3}\\right)^2 \\left( (-\\tan\\xi)^2 + (\\sec^2\\eta)^2 + (-\\tan\\xi \\tan\\eta)^2 \\right).\n$$\n$$\ng_{\\xi\\xi} = \\frac{a^2 \\sec^4\\xi}{D^6} \\left( \\tan^2\\xi + \\sec^4\\eta + \\tan^2\\xi \\tan^2\\eta \\right).\n$$\nLet's simplify the term in parentheses. Using $1+\\tan^2\\eta = \\sec^2\\eta$:\n$$\n\\tan^2\\xi + \\sec^4\\eta + \\tan^2\\xi \\tan^2\\eta = \\tan^2\\xi (1 + \\tan^2\\eta) + \\sec^4\\eta = \\tan^2\\xi \\sec^2\\eta + \\sec^4\\eta.\n$$\nFactor out $\\sec^2\\eta$:\n$$\n= \\sec^2\\eta (\\tan^2\\xi + \\sec^2\\eta) = \\sec^2\\eta (\\tan^2\\xi + 1 + \\tan^2\\eta).\n$$\nThe term $\\tan^2\\xi + 1 + \\tan^2\\eta$ is equal to $D^2$. So the expression in parentheses simplifies to $\\sec^2\\eta \\, D^2$.\nSubstituting this back into the expression for $g_{\\xi\\xi}$:\n$$\ng_{\\xi\\xi} = \\frac{a^2 \\sec^4\\xi}{D^6} (\\sec^2\\eta \\, D^2) = \\frac{a^2 \\sec^4\\xi \\sec^2\\eta}{D^4}.\n$$\nNow we find the square root of $g_{\\xi\\xi}$:\n$$\n\\sqrt{g_{\\xi\\xi}} = \\sqrt{\\frac{a^2 \\sec^4\\xi \\sec^2\\eta}{D^4}} = \\frac{|a| |\\sec^2\\xi| |\\sec\\eta|}{D^2}.\n$$\nGiven $a > 0$ and the coordinate range $(\\xi,\\eta) \\in (-\\frac{\\pi}{4}, \\frac{\\pi}{4}) \\times (-\\frac{\\pi}{4}, \\frac{\\pi}{4})$, we have $\\sec\\xi > 0$ and $\\sec\\eta > 0$. We can drop the absolute value signs.\n$$\n\\sqrt{g_{\\xi\\xi}} = \\frac{a \\sec^2\\xi \\sec\\eta}{D^2} = \\frac{a \\sec^2\\xi \\sec\\eta}{1 + \\tan^2\\xi + \\tan^2\\eta}.\n$$\nThe arc length $\\Delta s$ for a small, finite increment $\\Delta \\xi$ along a line of constant $\\eta$ is given by the leading-order approximation:\n$$\n\\Delta s \\approx \\sqrt{g_{\\xi\\xi}} \\Delta\\xi.\n$$\nSubstituting the derived expression for $\\sqrt{g_{\\xi\\xi}}$ gives the final result. For clarity, we can use the identity $1+\\tan^2\\xi=\\sec^2\\xi$ to simplify the denominator:\n$$\n\\Delta s \\approx \\frac{a \\sec^2\\xi \\sec\\eta}{\\sec^2\\xi + \\tan^2\\eta} \\Delta\\xi.\n$$\nThis is the required closed-form analytical expression for the arc length.",
            "answer": "$$\n\\boxed{\\frac{a \\sec^{2}\\xi \\sec\\eta}{\\sec^{2}\\xi + \\tan^{2}\\eta} \\Delta\\xi}\n$$"
        },
        {
            "introduction": "Once the grid's geometry is understood, the next step is to correctly formulate the governing physical equations, which often involve vector calculus operators like the gradient and divergence. Since the cubed-sphere grid uses non-orthogonal curvilinear coordinates, standard partial derivatives are insufficient. This practice guides you through the calculation of Christoffel symbols, which are essential for defining the covariant derivative and reveal the \"metric terms\" or \"fictitious forces\" that arise from the grid's curvature .",
            "id": "4029380",
            "problem": "As a standard reference for comparison with more advanced grids, consider a patch of a regular latitude-longitude grid. The local angular coordinates $(\\alpha,\\beta)$, corresponding to longitude and latitude respectively, parametrize the spherical surface of radius $a$ by the embedding\n$$\n\\mathbf{R}(\\alpha,\\beta) \\;=\\; a \\, \\big( \\cos\\alpha \\,\\cos\\beta,\\; \\sin\\alpha \\,\\cos\\beta,\\; \\sin\\beta \\big),\n$$\nwith $\\alpha \\in \\left(-\\frac{\\pi}{4},\\frac{\\pi}{4}\\right)$ and $\\beta \\in \\left(-\\frac{\\pi}{4},\\frac{\\pi}{4}\\right)$. Use first principles from differential geometry of surfaces and the definition of covariant derivatives on Riemannian manifolds to address the following:\n\n- Starting from the fundamental definition of the surface metric induced by the embedding, derive the metric coefficients $g_{ij}$ in the local coordinates $(\\alpha,\\beta)$ and the inverse metric $g^{ij}$ for this patch.\n- Using the definition of the Christoffel symbols $\\Gamma^{k}_{ij}$ in terms of $g_{ij}$, obtain the nonzero Christoffel symbols for this patch and demonstrate that they are indeed nonzero functions of $(\\alpha,\\beta)$.\n- Using the definition of the covariant derivative of a contravariant vector field $v^{i}$ on the sphere, write the expression for $\\nabla_{\\alpha} v^{\\alpha}$ in these coordinates, explicitly showing the role of the Christoffel symbols in discretizing covariant derivatives on a curvilinear grid.\n\nFinally, provide the exact closed-form expression, in terms of $\\beta$, for the Christoffel symbol $\\Gamma^{\\alpha}_{\\alpha\\beta}$ for this patch. Your final answer must be a single analytic expression. No numerical approximation or rounding is required, and no units should be included in the final expression.",
            "solution": "The problem is valid as it is scientifically grounded in differential geometry, well-posed, objective, and contains all necessary information for a unique solution. The procedures requested are standard in the analysis of curvilinear coordinate systems on manifolds, which is a fundamental aspect of numerical modeling on spherical domains like the cubed-sphere.\n\nLet the local coordinates on the surface be denoted by $(u^1, u^2) = (\\alpha, \\beta)$. The position vector $\\mathbf{R}$ describing the surface of the sphere of radius $a$ is given by\n$$\n\\mathbf{R}(\\alpha,\\beta) \\;=\\; a \\begin{pmatrix} \\cos\\alpha \\cos\\beta \\\\ \\sin\\alpha \\cos\\beta \\\\ \\sin\\beta \\end{pmatrix}\n$$\n\nThe first step is to derive the metric tensor $g_{ij}$ and its inverse $g^{ij}$. The components of the metric tensor are defined by the inner product of the tangent basis vectors, $g_{ij} = \\mathbf{e}_i \\cdot \\mathbf{e}_j$, where $\\mathbf{e}_i = \\frac{\\partial \\mathbf{R}}{\\partial u^i}$.\n\nFirst, we compute the tangent basis vectors:\n$$\n\\mathbf{e}_{\\alpha} = \\frac{\\partial \\mathbf{R}}{\\partial \\alpha} = a \\begin{pmatrix} -\\sin\\alpha \\cos\\beta \\\\ \\cos\\alpha \\cos\\beta \\\\ 0 \\end{pmatrix}\n$$\n$$\n\\mathbf{e}_{\\beta} = \\frac{\\partial \\mathbf{R}}{\\partial \\beta} = a \\begin{pmatrix} -\\cos\\alpha \\sin\\beta \\\\ -\\sin\\alpha \\sin\\beta \\\\ \\cos\\beta \\end{pmatrix}\n$$\nNow, we compute the components of the metric tensor $g_{ij}$ by taking the dot products:\n$$\ng_{\\alpha\\alpha} = \\mathbf{e}_{\\alpha} \\cdot \\mathbf{e}_{\\alpha} = a^2 \\left( (-\\sin\\alpha \\cos\\beta)^2 + (\\cos\\alpha \\cos\\beta)^2 + 0^2 \\right) = a^2 \\cos^2\\beta (\\sin^2\\alpha + \\cos^2\\alpha) = a^2 \\cos^2\\beta\n$$\n$$\ng_{\\beta\\beta} = \\mathbf{e}_{\\beta} \\cdot \\mathbf{e}_{\\beta} = a^2 \\left( (-\\cos\\alpha \\sin\\beta)^2 + (-\\sin\\alpha \\sin\\beta)^2 + (\\cos\\beta)^2 \\right) = a^2 \\left( \\sin^2\\beta (\\cos^2\\alpha + \\sin^2\\alpha) + \\cos^2\\beta \\right) = a^2 (\\sin^2\\beta + \\cos^2\\beta) = a^2\n$$\n$$\ng_{\\alpha\\beta} = \\mathbf{e}_{\\alpha} \\cdot \\mathbf{e}_{\\beta} = a^2 \\left( (-\\sin\\alpha\\cos\\beta)(-\\cos\\alpha\\sin\\beta) + (\\cos\\alpha\\cos\\beta)(-\\sin\\alpha\\sin\\beta) + 0 \\right) = a^2(\\sin\\alpha\\cos\\alpha\\sin\\beta\\cos\\beta - \\sin\\alpha\\cos\\alpha\\sin\\beta\\cos\\beta) = 0\n$$\nSince $g_{\\alpha\\beta} = g_{\\beta\\alpha}$, the metric tensor is diagonal:\n$$\ng_{ij} = \\begin{pmatrix} g_{\\alpha\\alpha} & g_{\\alpha\\beta} \\\\ g_{\\beta\\alpha} & g_{\\beta\\beta} \\end{pmatrix} = \\begin{pmatrix} a^2 \\cos^2\\beta & 0 \\\\ 0 & a^2 \\end{pmatrix}\n$$\nThe inverse metric tensor $g^{ij}$ is the matrix inverse of $g_{ij}$. For a diagonal matrix, the inverse is found by taking the reciprocal of each diagonal element:\n$$\ng^{ij} = \\begin{pmatrix} \\frac{1}{g_{\\alpha\\alpha}} & 0 \\\\ 0 & \\frac{1}{g_{\\beta\\beta}} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{a^2 \\cos^2\\beta} & 0 \\\\ 0 & \\frac{1}{a^2} \\end{pmatrix}\n$$\nThus, $g^{\\alpha\\alpha} = \\frac{1}{a^2 \\cos^2\\beta}$, $g^{\\beta\\beta} = \\frac{1}{a^2}$, and $g^{\\alpha\\beta} = g^{\\beta\\alpha} = 0$.\n\nNext, we calculate the Christoffel symbols of the second kind, $\\Gamma^k_{ij}$, using the formula:\n$$\n\\Gamma^k_{ij} = \\frac{1}{2} g^{kl} \\left( \\frac{\\partial g_{li}}{\\partial u^j} + \\frac{\\partial g_{lj}}{\\partial u^i} - \\frac{\\partial g_{ij}}{\\partial u^l} \\right)\n$$\nwhere a sum over the index $l \\in \\{\\alpha, \\beta\\}$ is implied. First, we need the partial derivatives of the metric components with respect to the coordinates $\\alpha$ and $\\beta$:\n$$\n\\frac{\\partial g_{\\alpha\\alpha}}{\\partial \\alpha} = 0, \\quad \\frac{\\partial g_{\\beta\\beta}}{\\partial \\alpha} = 0, \\quad \\frac{\\partial g_{\\alpha\\beta}}{\\partial \\alpha} = 0\n$$\n$$\n\\frac{\\partial g_{\\alpha\\alpha}}{\\partial \\beta} = \\frac{\\partial}{\\partial \\beta}(a^2 \\cos^2\\beta) = a^2 (2\\cos\\beta)(-\\sin\\beta) = -2a^2 \\sin\\beta \\cos\\beta\n$$\n$$\n\\frac{\\partial g_{\\beta\\beta}}{\\partial \\beta} = \\frac{\\partial}{\\partial \\beta}(a^2) = 0, \\quad \\frac{\\partial g_{\\alpha\\beta}}{\\partial \\beta} = 0\n$$\nThe only non-zero partial derivative is $\\frac{\\partial g_{\\alpha\\alpha}}{\\partial \\beta}$. This greatly simplifies the calculations.\n\nLet's compute the non-zero Christoffel symbols:\n- $\\Gamma^k_{\\alpha\\alpha} = \\frac{1}{2} g^{kl} \\left( \\frac{\\partial g_{l\\alpha}}{\\partial \\alpha} + \\frac{\\partial g_{l\\alpha}}{\\partial \\alpha} - \\frac{\\partial g_{\\alpha\\alpha}}{\\partial u^l} \\right) = -\\frac{1}{2} g^{kl} \\frac{\\partial g_{\\alpha\\alpha}}{\\partial u^l}$.\n  For $k=\\alpha$: $\\Gamma^{\\alpha}_{\\alpha\\alpha} = -\\frac{1}{2} \\left( g^{\\alpha\\alpha} \\frac{\\partial g_{\\alpha\\alpha}}{\\partial \\alpha} + g^{\\alpha\\beta} \\frac{\\partial g_{\\alpha\\alpha}}{\\partial \\beta} \\right) = -\\frac{1}{2}\\left(g^{\\alpha\\alpha}(0) + 0 \\right) = 0$.\n  For $k=\\beta$: $\\Gamma^{\\beta}_{\\alpha\\alpha} = -\\frac{1}{2} \\left( g^{\\beta\\alpha} \\frac{\\partial g_{\\alpha\\alpha}}{\\partial \\alpha} + g^{\\beta\\beta} \\frac{\\partial g_{\\alpha\\alpha}}{\\partial \\beta} \\right) = -\\frac{1}{2}\\left( 0 + \\frac{1}{a^2} (-2a^2 \\sin\\beta \\cos\\beta) \\right) = \\sin\\beta \\cos\\beta$.\n\n- $\\Gamma^k_{\\beta\\beta} = \\frac{1}{2} g^{kl} \\left( \\frac{\\partial g_{l\\beta}}{\\partial \\beta} + \\frac{\\partial g_{l\\beta}}{\\partial \\beta} - \\frac{\\partial g_{\\beta\\beta}}{\\partial u^l} \\right) = \\frac{1}{2} g^{kl} \\left( 2\\frac{\\partial g_{l\\beta}}{\\partial \\beta} - \\frac{\\partial g_{\\beta\\beta}}{\\partial u^l} \\right)$.\n  Since $g_{l\\beta}$ is non-zero only for $l=\\beta$, and $\\frac{\\partial g_{\\beta\\beta}}{\\partial u^l}=0$ for all $l$, all terms are zero. So $\\Gamma^k_{\\beta\\beta} = 0$ for $k = \\alpha, \\beta$.\n\n- $\\Gamma^k_{\\alpha\\beta} = \\frac{1}{2} g^{kl} \\left( \\frac{\\partial g_{l\\alpha}}{\\partial \\beta} + \\frac{\\partial g_{l\\beta}}{\\partial \\alpha} - \\frac{\\partial g_{\\alpha\\beta}}{\\partial u^l} \\right)$. Since $g_{\\alpha\\beta}=0$ and $\\frac{\\partial g_{l\\beta}}{\\partial \\alpha}=0$ for all $l$, this simplifies to $\\Gamma^k_{\\alpha\\beta} = \\frac{1}{2} g^{kl} \\frac{\\partial g_{l\\alpha}}{\\partial \\beta}$.\n  For $k=\\alpha$: $\\Gamma^{\\alpha}_{\\alpha\\beta} = \\frac{1}{2} \\left( g^{\\alpha\\alpha} \\frac{\\partial g_{\\alpha\\alpha}}{\\partial \\beta} + g^{\\alpha\\beta} \\frac{\\partial g_{\\beta\\alpha}}{\\partial \\beta} \\right) = \\frac{1}{2} g^{\\alpha\\alpha} \\frac{\\partial g_{\\alpha\\alpha}}{\\partial \\beta} = \\frac{1}{2} \\left( \\frac{1}{a^2 \\cos^2\\beta} \\right) (-2a^2 \\sin\\beta \\cos\\beta) = -\\frac{\\sin\\beta \\cos\\beta}{\\cos^2\\beta} = -\\tan\\beta$.\n  For $k=\\beta$: $\\Gamma^{\\beta}_{\\alpha\\beta} = \\frac{1}{2} \\left( g^{\\beta\\alpha} \\frac{\\partial g_{\\alpha\\alpha}}{\\partial \\beta} + g^{\\beta\\beta} \\frac{\\partial g_{\\beta\\alpha}}{\\partial \\beta} \\right) = \\frac{1}{2} (0 + 0) = 0$.\n\nBy symmetry, $\\Gamma^k_{ji} = \\Gamma^k_{ij}$, so $\\Gamma^{\\alpha}_{\\beta\\alpha} = \\Gamma^{\\alpha}_{\\alpha\\beta} = -\\tan\\beta$.\nThe non-zero Christoffel symbols are:\n$$\n\\Gamma^{\\beta}_{\\alpha\\alpha} = \\sin\\beta \\cos\\beta\n$$\n$$\n\\Gamma^{\\alpha}_{\\alpha\\beta} = \\Gamma^{\\alpha}_{\\beta\\alpha} = -\\tan\\beta\n$$\nThese are functions of $\\beta$ and are non-zero for any $\\beta \\in \\left(-\\frac{\\pi}{4},\\frac{\\pi}{4}\\right)$ except $\\beta=0$. This demonstrates that they are indeed non-zero functions on the patch.\n\nNow, we write the expression for the covariant derivative of a contravariant vector field $v^i$, $\\nabla_j v^i$. The general formula is:\n$$\n\\nabla_j v^i = \\frac{\\partial v^i}{\\partial u^j} + \\Gamma^i_{jk} v^k\n$$\nWe are asked for $\\nabla_{\\alpha} v^{\\alpha}$. In this case, $j=\\alpha$ and $i=\\alpha$. The expression becomes:\n$$\n\\nabla_{\\alpha} v^{\\alpha} = \\frac{\\partial v^{\\alpha}}{\\partial \\alpha} + \\Gamma^{\\alpha}_{\\alpha k} v^k\n$$\nExpanding the sum over the index $k \\in \\{\\alpha, \\beta\\}$:\n$$\n\\nabla_{\\alpha} v^{\\alpha} = \\frac{\\partial v^{\\alpha}}{\\partial \\alpha} + \\Gamma^{\\alpha}_{\\alpha\\alpha} v^{\\alpha} + \\Gamma^{\\alpha}_{\\alpha\\beta} v^{\\beta}\n$$\nSubstituting the Christoffel symbols we derived:\n$$\n\\nabla_{\\alpha} v^{\\alpha} = \\frac{\\partial v^{\\alpha}}{\\partial \\alpha} + (0) v^{\\alpha} + (-\\tan\\beta) v^{\\beta} = \\frac{\\partial v^{\\alpha}}{\\partial \\alpha} - v^{\\beta} \\tan\\beta\n$$\nThis expression explicitly shows the role of the Christoffel symbols. The term $-v^{\\beta}\\tan\\beta$ is the correction to the partial derivative $\\frac{\\partial v^{\\alpha}}{\\partial \\alpha}$ that accounts for the curvature of the manifold and the non-orthonormal nature of the local coordinate system projection. In numerical discretizations, this \"fictitious force\" term is crucial for accurately representing particle or fluid motion on the curved surface.\n\nFinally, the problem asks for the exact closed-form expression for the Christoffel symbol $\\Gamma^{\\alpha}_{\\alpha\\beta}$. As derived above, this is:\n$$\n\\Gamma^{\\alpha}_{\\alpha\\beta} = -\\tan\\beta\n$$",
            "answer": "$$\n\\boxed{-\\tan\\beta}\n$$"
        },
        {
            "introduction": "Shifting our focus to the Yin-Yang grid, we encounter a different set of numerical challenges, most notably the need to exchange information across the overlapping grid regions. The accuracy of the overall solution depends critically on the accuracy of the interpolation scheme used at these overset boundaries. This problem provides a hands-on analysis of this process, using Taylor series to derive the leading-order truncation error in vorticity that arises from a standard interpolation method, a fundamental skill in the verification of overset grid models .",
            "id": "4029428",
            "problem": "In a local analysis of an overset Yin–Yang grid coupling for a barotropic layer on the sphere, consider a single finite-volume control area adjacent to the overlap boundary within one grid patch. Introduce local orthonormal coordinates $(s,y)$ defined on the tangent plane to the sphere at the overlap, where $s$ is arc length along the overlap boundary (tangential direction) and $y$ is the signed distance normal to the boundary pointing into the donor patch. The control area has area $A$ and one of its boundary segments coincides with a portion of the overlap boundary of length $L$.\n\nThe area-mean vertical component of vorticity $\\bar{\\zeta}$ in this finite volume is diagnosed from the circulation integral using the classical Stokes theorem of vector calculus (a fundamental law relating curl and circulation): the area integral of vorticity equals the line integral of tangential velocity around the boundary. In the overset coupling, the tangential velocity along the overlap boundary segment is provided by donor-grid interpolation in the normal direction. Assume:\n- The only source of circulation error is the interpolation on the overlap segment; all other boundary segments are represented exactly for the purposes of this estimate.\n- The donor interpolation for the tangential component uses a centered, second-order, one-dimensional stencil in the normal direction at offset $y=\\pm h$ to approximate the boundary value at $y=0$.\n- The exact tangential velocity field in a neighborhood of the boundary is smooth and given by\n$$\nu_{t}(s,y) \\;=\\; U_{0}\\,\\sin(\\kappa\\, s)\\,\\exp(\\alpha\\, y),\n$$\nfor constants $U_{0}>0$, $\\kappa>0$, and $\\alpha \\in \\mathbb{R}$.\n\nStarting from the circulation–vorticity relationship, the Taylor expansion of $u_{t}(s,y)$ in $y$ about $y=0$, and the definition of the centered second-order interpolation described above, derive the leading-order truncation error in the diagnosed area-mean vorticity caused solely by the overset interpolation on the overlap boundary segment. Express the final answer as a single closed-form analytic expression in terms of $U_{0}$, $\\kappa$, $\\alpha$, $h$, $L$, and $A$. Express the final vorticity error in $\\mathrm{s}^{-1}$ (International System of Units). Do not include units in your final expression.",
            "solution": "The problem is first subject to rigorous validation.\n\n**Step 1: Extract Givens**\n- Local orthonormal coordinates are $(s, y)$, where $s$ is arc length along an overlap boundary and $y$ is the normal distance.\n- A finite-volume control area has area $A$.\n- A segment of the control area's boundary lies on the overlap boundary and has length $L$.\n- The area-mean vertical component of vorticity, $\\bar{\\zeta}$, is diagnosed from circulation $\\Gamma$ via Stokes' theorem: $\\bar{\\zeta} = \\frac{\\Gamma}{A}$.\n- The only source of error is from interpolation on the overlap boundary segment.\n- The interpolation for tangential velocity $u_t$ at the boundary ($y=0$) is a centered, second-order, one-dimensional stencil using values at $y=\\pm h$.\n- The exact tangential velocity field is given by $u_{t}(s,y) = U_{0}\\sin(\\kappa s)\\exp(\\alpha y)$.\n- The constants are $U_{0}>0$, $\\kappa>0$, $\\alpha \\in \\mathbb{R}$, $h$, $L$, and $A$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is based on fundamental principles of fluid dynamics (vorticity, circulation), vector calculus (Stokes' theorem), and numerical analysis (finite-volume methods, truncation error analysis). These concepts are standard in the field of numerical weather prediction and climate modeling. The setup is a canonical model for analyzing interpolation errors in overset grids.\n- **Well-Posed:** The problem provides a clear objective (derive the leading-order error), sufficient data and definitions (analytical velocity field, specified interpolation scheme), and a clear path to a unique solution.\n- **Objective:** The problem is stated using precise mathematical and physical terminology, free from ambiguity or subjective content.\n\nThe problem is found to be valid as it is scientifically sound, well-posed, and objective. There are no contradictions, missing information, or violations of physical principles. We may proceed to the solution.\n\n**Derivation of the Vorticity Error**\n\nThe area-mean vertical component of vorticity $\\bar{\\zeta}$ over a finite volume of area $A$ is defined by the circulation $\\Gamma$ around its boundary $\\partial A$ according to Stokes' theorem:\n$$\n\\bar{\\zeta} = \\frac{1}{A} \\oint_{\\partial A} \\vec{u} \\cdot d\\vec{l} = \\frac{\\Gamma}{A}\n$$\nThe error in the diagnosed area-mean vorticity, $\\Delta\\bar{\\zeta}$, stems from the error in the calculated circulation, $\\Delta\\Gamma$. The problem states that this error arises exclusively from the numerical approximation of the tangential velocity, $u_t$, along the boundary segment of length $L$. Thus, we can write:\n$$\n\\Delta\\bar{\\zeta} = \\frac{\\Delta\\Gamma}{A}\n$$\nThe circulation error $\\Delta\\Gamma$ is the difference between the circulation calculated using the interpolated velocity, $\\Gamma_{\\text{approx}}$, and the exact circulation, $\\Gamma_{\\text{exact}}$, along this segment. Let the segment extend from $s=0$ to $s=L$ without loss of generality.\n$$\n\\Delta\\Gamma = \\Gamma_{\\text{approx}} - \\Gamma_{\\text{exact}} = \\int_0^L u_{t, \\text{interp}}(s, 0) \\, ds - \\int_0^L u_t(s, 0) \\, ds = \\int_0^L \\left[ u_{t, \\text{interp}}(s, 0) - u_t(s, 0) \\right] \\, ds\n$$\nThe term inside the integral is the local truncation error of the velocity interpolation.\n\nThe interpolation scheme is a centered, one-dimensional stencil using values at offsets $y = \\pm h$ to approximate the value at $y=0$. This corresponds to a simple average:\n$$\nu_{t, \\text{interp}}(s, 0) = \\frac{u_t(s, h) + u_t(s, -h)}{2}\n$$\nTo determine the leading-order error of this interpolation, we expand the exact velocity field $u_t(s, y)$ in a Taylor series in the variable $y$ around $y=0$:\n$$\nu_t(s, y) = u_t(s, 0) + y \\frac{\\partial u_t}{\\partial y}\\bigg|_{y=0} + \\frac{y^2}{2!} \\frac{\\partial^2 u_t}{\\partial y^2}\\bigg|_{y=0} + \\frac{y^3}{3!} \\frac{\\partial^3 u_t}{\\partial y^3}\\bigg|_{y=0} + O(y^4)\n$$\nEvaluating the expansions at $y=h$ and $y=-h$:\n$$\nu_t(s, h) = u_t(s, 0) + h \\frac{\\partial u_t}{\\partial y}\\bigg|_{0} + \\frac{h^2}{2} \\frac{\\partial^2 u_t}{\\partial y^2}\\bigg|_{0} + \\frac{h^3}{6} \\frac{\\partial^3 u_t}{\\partial y^3}\\bigg|_{0} + O(h^4)\n$$\n$$\nu_t(s, -h) = u_t(s, 0) - h \\frac{\\partial u_t}{\\partial y}\\bigg|_{0} + \\frac{h^2}{2} \\frac{\\partial^2 u_t}{\\partial y^2}\\bigg|_{0} - \\frac{h^3}{6} \\frac{\\partial^3 u_t}{\\partial y^3}\\bigg|_{0} + O(h^4)\n$$\nSubstituting these into the interpolation formula:\n$$\nu_{t, \\text{interp}}(s, 0) = \\frac{1}{2} \\left[ \\left( u_t(s, 0) + h \\frac{\\partial u_t}{\\partial y}\\bigg|_{0} + \\dots \\right) + \\left( u_t(s, 0) - h \\frac{\\partial u_t}{\\partial y}\\bigg|_{0} + \\dots \\right) \\right]\n$$\n$$\nu_{t, \\text{interp}}(s, 0) = \\frac{1}{2} \\left[ 2 u_t(s, 0) + h^2 \\frac{\\partial^2 u_t}{\\partial y^2}\\bigg|_{0} + O(h^4) \\right] = u_t(s, 0) + \\frac{h^2}{2} \\frac{\\partial^2 u_t}{\\partial y^2}\\bigg|_{y=0} + O(h^4)\n$$\nThe leading-order local truncation error of the velocity interpolation is therefore:\n$$\nu_{t, \\text{interp}}(s, 0) - u_t(s, 0) \\approx \\frac{h^2}{2} \\frac{\\partial^2 u_t}{\\partial y^2}\\bigg|_{y=0}\n$$\nNow, we compute the second partial derivative of the given velocity field, $u_t(s,y) = U_{0}\\sin(\\kappa s)\\exp(\\alpha y)$, with respect to $y$:\n$$\n\\frac{\\partial u_t}{\\partial y} = \\frac{\\partial}{\\partial y} \\left[ U_{0}\\sin(\\kappa s)\\exp(\\alpha y) \\right] = \\alpha U_{0}\\sin(\\kappa s)\\exp(\\alpha y)\n$$\n$$\n\\frac{\\partial^2 u_t}{\\partial y^2} = \\frac{\\partial}{\\partial y} \\left[ \\alpha U_{0}\\sin(\\kappa s)\\exp(\\alpha y) \\right] = \\alpha^2 U_{0}\\sin(\\kappa s)\\exp(\\alpha y)\n$$\nEvaluating this at $y=0$:\n$$\n\\frac{\\partial^2 u_t}{\\partial y^2}\\bigg|_{y=0} = \\alpha^2 U_{0}\\sin(\\kappa s)\\exp(0) = \\alpha^2 U_{0}\\sin(\\kappa s)\n$$\nThe leading-order velocity error is $\\epsilon_u(s) \\approx \\frac{\\alpha^2 h^2 U_{0}}{2} \\sin(\\kappa s)$.\n\nWe now integrate this velocity error along the segment of length $L$ to find the circulation error $\\Delta\\Gamma$:\n$$\n\\Delta\\Gamma \\approx \\int_0^L \\frac{\\alpha^2 h^2 U_{0}}{2} \\sin(\\kappa s) \\, ds = \\frac{\\alpha^2 h^2 U_{0}}{2} \\int_0^L \\sin(\\kappa s) \\, ds\n$$\nThe integral evaluates to:\n$$\n\\int_0^L \\sin(\\kappa s) \\, ds = \\left[ -\\frac{1}{\\kappa} \\cos(\\kappa s) \\right]_0^L = -\\frac{1}{\\kappa} (\\cos(\\kappa L) - \\cos(0)) = \\frac{1}{\\kappa} (1 - \\cos(\\kappa L))\n$$\nSubstituting this result back into the expression for $\\Delta\\Gamma$:\n$$\n\\Delta\\Gamma \\approx \\frac{\\alpha^2 h^2 U_{0}}{2} \\left( \\frac{1 - \\cos(\\kappa L)}{\\kappa} \\right) = \\frac{\\alpha^2 h^2 U_{0}}{2\\kappa} (1 - \\cos(\\kappa L))\n$$\nFinally, the leading-order truncation error in the diagnosed area-mean vorticity, $\\Delta\\bar{\\zeta}$, is obtained by dividing the circulation error by the control area $A$:\n$$\n\\Delta\\bar{\\zeta} = \\frac{\\Delta\\Gamma}{A} \\approx \\frac{1}{A} \\left( \\frac{\\alpha^2 h^2 U_{0}}{2\\kappa} (1 - \\cos(\\kappa L)) \\right)\n$$\nThis gives the final expression for the error in the diagnosed vorticity.",
            "answer": "$$\n\\boxed{\\frac{\\alpha^{2} h^{2} U_{0}}{2 A \\kappa} \\left(1 - \\cos(\\kappa L)\\right)}\n$$"
        }
    ]
}