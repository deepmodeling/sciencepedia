{
    "hands_on_practices": [
        {
            "introduction": "The efficiency of split-explicit methods stems from their ability to use different time steps for different physical processes. This practice provides a concrete application of this principle, focusing on how to determine the largest possible stable time step for the 'slow' atmospheric modes, like advection and large-scale gravity waves. By working through the Courant–Friedrichs–Lewy (CFL) constraints for each mode, you will develop a practical understanding of how to balance computational cost with numerical stability in a modern atmospheric model .",
            "id": "4087035",
            "problem": "Consider a split-explicit, Horizontally Explicit–Vertically Implicit (HEVI) dynamical core for a compressible atmosphere on a one-dimensional uniform horizontal grid. The fast acoustic modes are advanced using $M$ inner substeps of size $\\Delta t_{f}$ per outer slow-mode step of size $\\Delta t_{o}$, so that $\\Delta t_{o} = M \\Delta t_{f}$ with $M$ a positive integer. The fast acoustic modes have sound speed $c_{s}$, and the slow horizontal modes are constrained by both advective motion with maximum wind speed $U_{\\max}$ and the external barotropic gravity-wave mode of a single-layer equivalent-depth atmosphere of depth $H$ under gravitational acceleration $g$. The horizontal grid spacing is $\\Delta x$.\n\nYou are given:\n- $\\Delta x = 10{,}000 \\ \\mathrm{m}$,\n- $U_{\\max} = 45 \\ \\mathrm{m} \\ \\mathrm{s}^{-1}$,\n- $H = 10{,}000 \\ \\mathrm{m}$,\n- $g = 9.81 \\ \\mathrm{m} \\ \\mathrm{s}^{-2}$,\n- $c_{s} = 330 \\ \\mathrm{m} \\ \\mathrm{s}^{-1}$,\n- $\\Delta t_{f} = 0.4 \\ \\mathrm{s}$.\n\nAssume that linear stability analysis of the chosen horizontal explicit scheme yields the following Courant–Friedrichs–Lewy (CFL) limits:\n- For fast acoustic substeps: $C_{\\text{fast}}^{\\max} = 1.0$,\n- For slow advective mode: $C_{\\text{adv}}^{\\max} = 0.9$,\n- For slow external gravity-wave mode: $C_{\\text{gw}}^{\\max} = 0.45$.\n\nDetermine the largest permitted outer time step $\\Delta t_{o}$ that is an integer multiple of $\\Delta t_{f}$ while satisfying all fast- and slow-mode CFL constraints. Express your final answer in seconds and round your answer to four significant figures.",
            "solution": "The problem requires the determination of the largest permissible outer time step, $\\Delta t_{o}$, for a split-explicit numerical scheme used in an atmospheric model. This determination is subject to a set of Courant–Friedrichs–Lewy (CFL) stability conditions for different physical modes, as well as the architectural constraint that $\\Delta t_{o}$ must be an integer multiple of a specified fast-mode time step, $\\Delta t_{f}$.\n\nFirst, we analyze the constraints imposed by the different modes on the time step. The model is split-explicit, meaning fast and slow modes are treated with different time steps, $\\Delta t_{f}$ and $\\Delta t_{o}$, respectively. The given parameters are:\n- Horizontal grid spacing: $\\Delta x = 10,000 \\ \\mathrm{m}$\n- Maximum advective wind speed: $U_{\\max} = 45 \\ \\mathrm{m} \\ \\mathrm{s}^{-1}$\n- Equivalent depth for external gravity wave: $H = 10,000 \\ \\mathrm{m}$\n- Gravitational acceleration: $g = 9.81 \\ \\mathrm{m} \\ \\mathrm{s}^{-2}$\n- Sound speed: $c_{s} = 330 \\ \\mathrm{m} \\ \\mathrm{s}^{-1}$\n- Fast-mode time step: $\\Delta t_{f} = 0.4 \\ \\mathrm{s}$\n- Maximum CFL numbers: $C_{\\text{fast}}^{\\max} = 1.0$, $C_{\\text{adv}}^{\\max} = 0.9$, $C_{\\text{gw}}^{\\max} = 0.45$.\n\nThe relationship between the outer and inner time steps is given by $\\Delta t_{o} = M \\Delta t_{f}$, where $M$ is a positive integer.\n\nWe will evaluate the stability constraint for each mode.\n\n1.  Fast Acoustic Mode Constraint:\n    The CFL condition for the fast acoustic modes, which are advanced with the short time step $\\Delta t_{f}$, is given by $C_{\\text{fast}} = \\frac{c_{s} \\Delta t_{f}}{\\Delta x} \\le C_{\\text{fast}}^{\\max}$. We can verify if the given $\\Delta t_{f}$ satisfies this condition:\n    $$C_{\\text{fast}} = \\frac{(330 \\ \\mathrm{m} \\ \\mathrm{s}^{-1}) \\times (0.4 \\ \\mathrm{s})}{10,000 \\ \\mathrm{m}} = \\frac{132}{10,000} = 0.0132$$\n    Since $0.0132 \\le 1.0$, the given fast time step $\\Delta t_{f} = 0.4 \\ \\mathrm{s}$ is stable, and the problem setup is consistent. This condition does not directly constrain $\\Delta t_o$, but validates the parameters.\n\n2.  Slow Advective Mode Constraint:\n    The CFL condition for the slow advective modes, which are advanced with the outer time step $\\Delta t_{o}$, is $C_{\\text{adv}} = \\frac{U_{\\max} \\Delta t_{o}}{\\Delta x} \\le C_{\\text{adv}}^{\\max}$. This provides an upper bound on $\\Delta t_{o}$:\n    $$\\Delta t_{o} \\le \\frac{C_{\\text{adv}}^{\\max} \\Delta x}{U_{\\max}}$$\n    Substituting the given values:\n    $$\\Delta t_{o} \\le \\frac{0.9 \\times 10,000 \\ \\mathrm{m}}{45 \\ \\mathrm{m} \\ \\mathrm{s}^{-1}} = \\frac{9,000}{45} \\ \\mathrm{s} = 200 \\ \\mathrm{s}$$\n    Let this maximum be denoted $\\Delta t_{o, \\text{adv}}^{\\max} = 200 \\ \\mathrm{s}$.\n\n3.  Slow External Gravity-Wave Mode Constraint:\n    The CFL condition for the slow external gravity-wave mode also depends on $\\Delta t_{o}$. The phase speed of the external gravity wave, $c_{g}$, is given by $c_{g} = \\sqrt{gH}$.\n    $$c_{g} = \\sqrt{(9.81 \\ \\mathrm{m} \\ \\mathrm{s}^{-2}) \\times (10,000 \\ \\mathrm{m})} = \\sqrt{98,100} \\ \\mathrm{m} \\ \\mathrm{s}^{-1} \\approx 313.209 \\ \\mathrm{m} \\ \\mathrm{s}^{-1}$$\n    The CFL condition is $C_{\\text{gw}} = \\frac{c_{g} \\Delta t_{o}}{\\Delta x} \\le C_{\\text{gw}}^{\\max}$. This gives another upper bound on $\\Delta t_{o}$:\n    $$\\Delta t_{o} \\le \\frac{C_{\\text{gw}}^{\\max} \\Delta x}{c_{g}} = \\frac{C_{\\text{gw}}^{\\max} \\Delta x}{\\sqrt{gH}}$$\n    Substituting the values:\n    $$\\Delta t_{o} \\le \\frac{0.45 \\times 10,000 \\ \\mathrm{m}}{\\sqrt{98,100} \\ \\mathrm{m} \\ \\mathrm{s}^{-1}} = \\frac{4,500}{\\sqrt{98,100}} \\ \\mathrm{s} \\approx 14.36726 \\ \\mathrm{s}$$\n    Let this maximum be denoted $\\Delta t_{o, \\text{gw}}^{\\max} \\approx 14.36726 \\ \\mathrm{s}$.\n\nTo ensure stability, the outer time step $\\Delta t_{o}$ must satisfy all constraints simultaneously. Therefore, $\\Delta t_{o}$ must be less than or equal to the minimum of the maximum allowable time steps for the slow modes:\n$$\\Delta t_{o} \\le \\min(\\Delta t_{o, \\text{adv}}^{\\max}, \\Delta t_{o, \\text{gw}}^{\\max})$$\n$$\\Delta t_{o} \\le \\min(200 \\ \\mathrm{s}, 14.36726 \\ \\mathrm{s})$$\n$$\\Delta t_{o} \\le 14.36726 \\ \\mathrm{s}$$\nThe external gravity-wave mode is the limiting factor for the outer time step.\n\nFinally, we apply the constraint that $\\Delta t_{o}$ must be an integer multiple of $\\Delta t_{f}$. That is, $\\Delta t_{o} = M \\Delta t_{f}$, where $M$ is a positive integer and $\\Delta t_{f} = 0.4 \\ \\mathrm{s}$.\n$$M \\times \\Delta t_{f} \\le 14.36726 \\ \\mathrm{s}$$\n$$M \\times 0.4 \\ \\mathrm{s} \\le 14.36726 \\ \\mathrm{s}$$\n$$M \\le \\frac{14.36726}{0.4} \\approx 35.91815$$\nSince $M$ must be an integer, the largest possible value for $M$ is $35$.\n\nThe largest permitted outer time step $\\Delta t_{o}$ is therefore:\n$$\\Delta t_{o} = 35 \\times \\Delta t_{f} = 35 \\times 0.4 \\ \\mathrm{s} = 14 \\ \\mathrm{s}$$\nThe question requires the answer to be rounded to four significant figures. The exact answer is $14$, which can be expressed as $14.00$.",
            "answer": "$$\\boxed{14.00}$$"
        },
        {
            "introduction": "While split-explicit schemes resolve fast waves with small time steps, semi-implicit methods handle them by treating them implicitly, allowing for much larger time steps. This exercise delves into a key technique used in semi-implicit schemes: off-centering to introduce numerical damping and control high-frequency oscillations. Using von Neumann stability analysis, you will derive the amplification factor for a simple wave system and see precisely how the choice of the off-centering parameter $\\alpha$ determines whether the scheme damps, preserves, or amplifies wave energy .",
            "id": "4087006",
            "problem": "Consider the linearized fast-wave subsystem of the compressible Euler equations about a spatially uniform reference state with constant density $\\bar{\\rho}$, pressure $\\bar{p}$, and sound speed $c$, where $c^{2} = \\left(\\partial p / \\partial \\rho\\right)_{s}$, and background velocity is zero. Retain only the acoustic terms so that the perturbation velocity $u(x,t)$ and pressure perturbation $p'(x,t)$ satisfy\n$$\n\\partial_{t} u + \\frac{1}{\\bar{\\rho}}\\,\\partial_{x} p' = 0, \n\\qquad\n\\partial_{t} p' + \\bar{\\rho} c^{2}\\,\\partial_{x} u = 0.\n$$\nThis fast-wave subsystem represents the component advanced on the inner step in split-explicit schemes for numerical weather prediction and in Horizontally Explicit Vertically Implicit (HEVI) methods when focusing on vertically propagating fast modes.\n\nDiscretize in time using an off-centered semi-implicit scheme about the reference state with off-centering parameter $\\alpha \\in [0,1]$ and uniform time step $\\Delta t$, and discretize $\\partial_{x}$ by a centered second-order difference on a uniform grid of spacing $\\Delta x$. Denote the centered-difference operator by $D_{x}$. The time-discrete scheme for advancing from time level $n$ to $n+1$ is\n$$\nu^{n+1} = u^{n} - \\Delta t\\left[(1-\\alpha)\\frac{1}{\\bar{\\rho}} D_{x} p'^{\\,n} + \\alpha \\frac{1}{\\bar{\\rho}} D_{x} p'^{\\,n+1}\\right],\n$$\n$$\np'^{\\,n+1} = p'^{\\,n} - \\Delta t\\left[(1-\\alpha)\\bar{\\rho} c^{2} D_{x} u^{n} + \\alpha \\bar{\\rho} c^{2} D_{x} u^{n+1}\\right].\n$$\n\nPerform a von Neumann analysis by inserting Fourier modes $u_{j}^{n} = U\\,G^{n}\\,\\exp(i j \\kappa)$ and $p'^{\\,n}_{j} = P\\,G^{n}\\,\\exp(i j \\kappa)$, where $j$ indexes grid points, $\\kappa = k \\Delta x$ is the nondimensional wavenumber, and $G$ is the one-step amplification factor. The Fourier symbol of $D_{x}$ is $i \\tilde{k}$ with $\\tilde{k} = \\sin(\\kappa)/\\Delta x$. Define the Courant number $\\lambda = c \\Delta t / \\Delta x$.\n\nUsing only these definitions and the governing equations above, derive the closed-form expression for the magnitude of the one-step amplification factor $|G|$ in terms of $\\alpha$, $\\lambda$, and $\\kappa$. Your final answer must be a single closed-form analytic expression. No rounding is required. Explain briefly, based on your expression, how off-centering about the reference state (i.e., choosing $\\alpha > 1/2$) introduces numerical damping for the fast waves.",
            "solution": "The problem statement is validated as scientifically sound, well-posed, and objective. It presents a standard von Neumann stability analysis of a semi-implicit numerical scheme for a linearized hyperbolic system, which is a fundamental task in the analysis of numerical methods for fluid dynamics and atmospheric modeling. All necessary equations, definitions, and parameters are provided, and there are no contradictions or ambiguities.\n\nThe discretized system of equations for advancing from time level $n$ to $n+1$ is given by:\n$$\nu^{n+1} = u^{n} - \\Delta t\\left[(1-\\alpha)\\frac{1}{\\bar{\\rho}} D_{x} p'^{\\,n} + \\alpha \\frac{1}{\\bar{\\rho}} D_{x} p'^{\\,n+1}\\right]\n$$\n$$\np'^{\\,n+1} = p'^{\\,n} - \\Delta t\\left[(1-\\alpha)\\bar{\\rho} c^{2} D_{x} u^{n} + \\alpha \\bar{\\rho} c^{2} D_{x} u^{n+1}\\right]\n$$\nTo perform the von Neumann analysis, we substitute the Fourier trial solutions $u_{j}^{n} = U\\,G^{n}\\,\\exp(i j \\kappa)$ and $p'^{\\,n}_{j} = P\\,G^{n}\\,\\exp(i j \\kappa)$ into the discrete equations. The action of the centered difference operator $D_x$ on a Fourier mode $\\exp(i j \\kappa)$ is multiplication by its Fourier symbol, which is given as $i \\tilde{k}$, where $\\tilde{k} = \\frac{\\sin(\\kappa)}{\\Delta x}$. The advancement in time from level $n$ to $n+1$ corresponds to multiplication by the amplification factor $G$.\n\nSubstituting the trial solutions into the first equation yields:\n$$\nG U G^{n} e^{i j \\kappa} = U G^{n} e^{i j \\kappa} - \\frac{\\Delta t}{\\bar{\\rho}} \\left[ (1-\\alpha) (i \\tilde{k}) P G^{n} e^{i j \\kappa} + \\alpha (i \\tilde{k}) P G^{n+1} e^{i j \\kappa} \\right]\n$$\nDividing by $G^{n} e^{i j \\kappa}$ and noting that $G^{n+1}=G \\cdot G^n$, we obtain an algebraic equation for the amplitudes $U$ and $P$:\n$$\nG U = U - \\frac{i \\tilde{k} \\Delta t}{\\bar{\\rho}} \\left[ (1-\\alpha) P + \\alpha G P \\right]\n$$\nRearranging gives:\n$$\n(G-1)U + \\frac{i \\tilde{k} \\Delta t}{\\bar{\\rho}} \\left[ (1-\\alpha) + \\alpha G \\right] P = 0\n$$\n\nSimilarly, substituting the trial solutions into the second equation yields:\n$$\nG P G^{n} e^{i j \\kappa} = P G^{n} e^{i j \\kappa} - \\bar{\\rho} c^{2} \\Delta t \\left[ (1-\\alpha) (i \\tilde{k}) U G^{n} e^{i j \\kappa} + \\alpha (i \\tilde{k}) U G^{n+1} e^{i j \\kappa} \\right]\n$$\nDividing by $G^{n} e^{i j \\kappa}$ gives:\n$$\nG P = P - i \\tilde{k} \\bar{\\rho} c^{2} \\Delta t \\left[ (1-\\alpha) U + \\alpha G U \\right]\n$$\nRearranging gives:\n$$\ni \\tilde{k} \\bar{\\rho} c^{2} \\Delta t \\left[ (1-\\alpha) + \\alpha G \\right] U + (G-1)P = 0\n$$\n\nThese two equations form a homogeneous linear system for the amplitudes $U$ and $P$:\n$$\n\\begin{pmatrix}\nG-1 & \\frac{i \\tilde{k} \\Delta t}{\\bar{\\rho}} \\left[ (1-\\alpha) + \\alpha G \\right] \\\\\ni \\tilde{k} \\bar{\\rho} c^{2} \\Delta t \\left[ (1-\\alpha) + \\alpha G \\right] & G-1\n\\end{pmatrix}\n\\begin{pmatrix}\nU \\\\\nP\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\\n0\n\\end{pmatrix}\n$$\nFor a non-trivial solution $(U, P) \\neq (0, 0)$ to exist, the determinant of the coefficient matrix must be zero:\n$$\n(G-1)^2 - \\left( \\frac{i \\tilde{k} \\Delta t}{\\bar{\\rho}} \\left[ (1-\\alpha) + \\alpha G \\right] \\right) \\left( i \\tilde{k} \\bar{\\rho} c^{2} \\Delta t \\left[ (1-\\alpha) + \\alpha G \\right] \\right) = 0\n$$\n$$\n(G-1)^2 - i^2 (\\tilde{k} c \\Delta t)^2 \\left[ (1-\\alpha) + \\alpha G \\right]^2 = 0\n$$\nSince $i^2 = -1$, this simplifies to:\n$$\n(G-1)^2 + (\\tilde{k} c \\Delta t)^2 \\left[ (1-\\alpha) + \\alpha G \\right]^2 = 0\n$$\nLet's define the non-dimensional parameter $\\sigma = \\tilde{k} c \\Delta t$. Using the given definitions $\\tilde{k} = \\frac{\\sin(\\kappa)}{\\Delta x}$ and the Courant number $\\lambda = \\frac{c \\Delta t}{\\Delta x}$, we have $\\sigma = \\frac{\\sin(\\kappa)}{\\Delta x} c \\Delta t = \\left(\\frac{c \\Delta t}{\\Delta x}\\right) \\sin(\\kappa) = \\lambda \\sin(\\kappa)$. The equation becomes:\n$$\n(G-1)^2 + \\sigma^2 \\left( 1 - \\alpha + \\alpha G \\right)^2 = 0\n$$\nThis can be solved for $G$:\n$$\n(G-1)^2 = - \\sigma^2 \\left( 1 - \\alpha + \\alpha G \\right)^2\n$$\n$$\nG-1 = \\pm i \\sigma (1 - \\alpha + \\alpha G)\n$$\n$$\nG - 1 = \\pm i \\sigma (1-\\alpha) \\pm i \\sigma \\alpha G\n$$\n$$\nG(1 \\mp i \\sigma \\alpha) = 1 \\pm i \\sigma (1-\\alpha)\n$$\n$$\nG = \\frac{1 \\pm i \\sigma (1-\\alpha)}{1 \\mp i \\sigma \\alpha}\n$$\nThe two solutions for $G$ are complex conjugates of each other. To find the magnitude $|G|$, we can analyze one of the solutions, as they both have the same magnitude. Let's take the upper signs:\n$$\nG = \\frac{1 + i \\sigma (1-\\alpha)}{1 - i \\sigma \\alpha}\n$$\nThe magnitude of $G$ is the ratio of the magnitudes of the numerator and the denominator:\n$$\n|G| = \\frac{|1 + i \\sigma (1-\\alpha)|}{|1 - i \\sigma \\alpha|} = \\frac{\\sqrt{1^2 + (\\sigma (1-\\alpha))^2}}{\\sqrt{1^2 + (-\\sigma \\alpha)^2}} = \\frac{\\sqrt{1 + \\sigma^2 (1-\\alpha)^2}}{\\sqrt{1 + \\sigma^2 \\alpha^2}}\n$$\nSubstituting $\\sigma = \\lambda \\sin(\\kappa)$ back into the expression, we obtain the final closed-form expression for the magnitude of the one-step amplification factor:\n$$\n|G| = \\sqrt{\\frac{1 + (\\lambda \\sin(\\kappa))^2 (1-\\alpha)^2}{1 + (\\lambda \\sin(\\kappa))^2 \\alpha^2}}\n$$\nTo explain how off-centering with $\\alpha > 1/2$ introduces numerical damping, we examine the condition for which $|G| < 1$. Numerical damping occurs when the amplitude of a wave mode decreases with each time step.\n$$\n|G| < 1 \\implies |G|^2 < 1\n$$\n$$\n\\frac{1 + (\\lambda \\sin(\\kappa))^2 (1-\\alpha)^2}{1 + (\\lambda \\sin(\\kappa))^2 \\alpha^2} < 1\n$$\nFor any non-trivial wave mode ($\\sin(\\kappa) \\neq 0$), the denominator is positive. We can multiply both sides by the denominator:\n$$\n1 + (\\lambda \\sin(\\kappa))^2 (1-\\alpha)^2 < 1 + (\\lambda \\sin(\\kappa))^2 \\alpha^2\n$$\n$$\n(\\lambda \\sin(\\kappa))^2 (1-\\alpha)^2 < (\\lambda \\sin(\\kappa))^2 \\alpha^2\n$$\nDividing by the positive term $(\\lambda \\sin(\\kappa))^2$ gives:\n$$\n(1-\\alpha)^2 < \\alpha^2\n$$\nSince the problem states $\\alpha \\in [0, 1]$, both $1-\\alpha$ and $\\alpha$ are non-negative. We can take the square root of both sides:\n$$\n1-\\alpha < \\alpha\n$$\n$$\n1 < 2\\alpha \\implies \\alpha > \\frac{1}{2}\n$$\nThus, the magnitude of the amplification factor $|G|$ is less than $1$ if and only if $\\alpha > 1/2$. This demonstrates that choosing an off-centering parameter $\\alpha > 1/2$ introduces numerical damping, causing the amplitude of fast-wave modes to decay over time. This damping is a direct consequence of giving more weight to the implicit part of the time step (the $n+1$ terms), which is a common technique to control high-frequency numerical oscillations and ensure stability in numerical models. Conversely, for $\\alpha < 1/2$, the scheme is amplifying ($|G| > 1$) and unstable. For $\\alpha = 1/2$ (the Crank-Nicolson method), $|G|=1$, and the scheme is neutrally stable, preserving the energy of each mode.",
            "answer": "$$\\boxed{\\sqrt{\\frac{1 + (\\lambda \\sin(\\kappa))^{2} (1-\\alpha)^{2}}{1 + (\\lambda \\sin(\\kappa))^{2} \\alpha^{2}}}}$$"
        },
        {
            "introduction": "This practice moves from analysis to application, guiding you through the construction of a complete split-explicit numerical model for the 1D Euler equations from first principles. You will implement the flux splitting that separates slow advection from fast acoustics and build a conservative finite-volume scheme using this decomposition. By developing and testing the model for conservation, accuracy, and stability, you will gain a practical, code-level understanding of how these advanced time-integration strategies are realized in a computational setting .",
            "id": "4086980",
            "problem": "Design and implement a split-explicit finite-volume algorithm for the one-dimensional compressible Euler equations in nondimensional form, suitable for numerical weather prediction and climate modeling. The split-explicit approach must treat fast acoustic propagation through inner explicit substeps for pressure and velocities, while handling slow advective transport through outer explicit steps for advective fluxes. The scheme must be conservative in the sense of discrete flux differences on each control volume.\n\nStart from the one-dimensional compressible Euler equations in conservative form for the state vector $U = [\\rho, \\rho u, E]^{\\top}$, where $\\rho$ is the density, $u$ is the velocity, and $E$ is the total energy:\n$$\n\\frac{\\partial U}{\\partial t} + \\frac{\\partial F(U)}{\\partial x} = 0,\n$$\nwith flux\n$$\nF(U) = \\begin{bmatrix}\n\\rho u \\\\\n\\rho u^2 + p \\\\\nu (E + p)\n\\end{bmatrix},\n$$\nand with the equation of state $p = (\\gamma - 1)\\left(E - \\frac{1}{2}\\rho u^2\\right)$ for a perfect gas, where $\\gamma$ is the ratio of specific heats. All variables are nondimensional (unitless).\n\nThe split-explicit design must decompose the flux into an advective component and an acoustic component,\n$$\nF(U) = F_{\\mathrm{adv}}(U) + F_{\\mathrm{ac}}(U),\n$$\nwhere\n$$\nF_{\\mathrm{adv}}(U) = \\begin{bmatrix}\n\\rho u \\\\\n\\rho u^2 \\\\\nu E\n\\end{bmatrix}, \\quad\nF_{\\mathrm{ac}}(U) = \\begin{bmatrix}\n0 \\\\\np \\\\\nu p\n\\end{bmatrix}.\n$$\nThe outer step advances $U$ with $F_{\\mathrm{adv}}$ over a large time step $\\Delta t_{\\mathrm{adv}}$ constrained by the advective Courant–Friedrichs–Lewy (CFL) condition based on $|u|$, while the inner steps advance $U$ with $F_{\\mathrm{ac}}$ over $M$ small substeps of size $\\delta t = \\Delta t_{\\mathrm{adv}} / M$ constrained by the acoustic CFL based on the sound speed $c = \\sqrt{\\gamma p/\\rho}$. The time-splitting must cover the same outer-step duration so that the combined update is consistent:\n$$\nU^{n+1} = \\Phi_{\\mathrm{ac}}^{M}\\left(\\Phi_{\\mathrm{adv}}^{1}\\left(U^n; \\Delta t_{\\mathrm{adv}}\\right); \\delta t\\right),\n$$\nwhere $\\Phi_{\\mathrm{adv}}^{1}$ is one conservative finite-volume update using $F_{\\mathrm{adv}}$ over $\\Delta t_{\\mathrm{adv}}$, and $\\Phi_{\\mathrm{ac}}^{M}$ is $M$ conservative finite-volume updates using $F_{\\mathrm{ac}}$ over $\\delta t$ each. Use periodic boundary conditions.\n\nDiscretize space with a uniform grid of $N$ cells over the interval $x \\in [0,1]$ with spacing $\\Delta x = 1/N$. Each flux update must be performed in conservative flux-difference form using a first-order Local Lax–Friedrichs (Rusanov) numerical flux at cell interfaces. For the advective flux, use a maximum signal speed based on $|u|$. For the acoustic flux, use a maximum signal speed based on the sound speed $c$. The inner steps update momentum and energy using the acoustic flux; the mass update is carried only by the outer advective flux, which is consistent with the structure of the continuity equation and ensures conservation in the split update.\n\nImplement the algorithm in Python following these specifications:\n- Domain: periodic, $x \\in [0,1]$, $N$ cells.\n- Gas constant ratio: $\\gamma = 1.4$.\n- Base state: $\\rho_0 = 1$, $p_0 = 1$.\n- Sound speed: $c_0 = \\sqrt{\\gamma p_0/\\rho_0}$.\n- Initial perturbations: small sinusoidal pressure perturbation of amplitude $\\varepsilon$ superposed on the base state, and optionally a uniform mean flow $u_0$.\n\nYou must construct a test suite comprising three cases that collectively assess conservation, accuracy, and stability/positivity. All variables and parameters are nondimensional.\n\nCase A (conservation under fast modes):\n- Grid size $N = 200$.\n- Initial state: $\\rho(x,0) = \\rho_0$, $u(x,0) = 0$, $p(x,0) = p_0 \\left(1 + \\varepsilon \\sin(2\\pi x)\\right)$, with $\\varepsilon = 10^{-4}$.\n- CFL numbers: $\\mathrm{CFL}_{\\mathrm{adv}} = 0.9$, $\\mathrm{CFL}_{\\mathrm{ac}} = 0.3$.\n- Final time $T = 0.02$ reached by repeated outer steps; each outer step is split into inner acoustic substeps.\n- Outputs: compute absolute conservation errors between initial and final totals for mass $\\sum_i \\rho_i \\Delta x$, momentum $\\sum_i (\\rho u)_i \\Delta x$, and energy $\\sum_i E_i \\Delta x$. Report three floats: the absolute mass error, the absolute momentum error, and the absolute energy error.\n\nCase B (accuracy versus unsplit reference):\n- Grid size $N = 200$.\n- Initial state: $\\rho(x,0) = \\rho_0$, $u(x,0) = u_0$, $p(x,0) = p_0 \\left(1 + \\varepsilon \\sin(2\\pi x)\\right)$, with $\\varepsilon = 10^{-4}$ and $u_0 = 0.5$.\n- Split-explicit CFL numbers: $\\mathrm{CFL}_{\\mathrm{adv}} = 0.9$, $\\mathrm{CFL}_{\\mathrm{ac}} = 0.3$.\n- Reference unsplit scheme: first-order Rusanov for the full flux $F(U)$ with a single small time step determined by $\\mathrm{CFL}_{\\mathrm{ref}} = 0.3$ using the maximum of $|u|+c$.\n- Final time $T = 0.02$ reached by both schemes.\n- Outputs: compute the discrete $\\ell^2$ differences between the split-explicit and the reference unsplit solutions for density and velocity: $\\left(\\sum_i (\\rho^{\\mathrm{split}}_i - \\rho^{\\mathrm{ref}}_i)^2 \\Delta x\\right)^{1/2}$ and $\\left(\\sum_i (u^{\\mathrm{split}}_i - u^{\\mathrm{ref}}_i)^2 \\Delta x\\right)^{1/2}$. Report two floats: the density error and the velocity error.\n\nCase C (stability and positivity under large outer time step):\n- Grid size $N = 200$.\n- Initial state: $\\rho(x,0) = \\rho_0$, $u(x,0) = 0.2$, $p(x,0) = p_0$.\n- Split-explicit CFL numbers: $\\mathrm{CFL}_{\\mathrm{adv}} = 0.95$, $\\mathrm{CFL}_{\\mathrm{ac}} = 0.3$.\n- Final time $T = 0.02$.\n- Output: test positivity of density and pressure at the final time. Report a boolean that is true if $\\rho_i > 0$ and $p_i > 0$ for all cells, and false otherwise.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,...]\"). For the three cases above, aggregate the outputs in the order: Case A three floats, Case B two floats, Case C one boolean. All computations are nondimensional and unitless; no physical units are required in the reported outputs. Angles do not appear; percentages are not used. Ensure scientific realism by using the conservative flux-difference form and stable CFL choices, and design the algorithm from the provided fundamental base without shortcut formulas. The algorithm must be self-contained and must not require any user input.",
            "solution": "We begin from the one-dimensional compressible Euler equations written in conservative form,\n$$\n\\frac{\\partial U}{\\partial t} + \\frac{\\partial F(U)}{\\partial x} = 0,\n$$\nwhere the conservative variables are $U = [\\rho, \\rho u, E]^{\\top}$ and the flux is\n$$\nF(U) = \\begin{bmatrix}\n\\rho u \\\\\n\\rho u^2 + p \\\\\nu (E + p)\n\\end{bmatrix}.\n$$\nThe equation of state is $p = (\\gamma - 1)\\left(E - \\frac{1}{2}\\rho u^2\\right)$, with $\\gamma$ the ratio of specific heats. These equations express conservation of mass, momentum, and energy for a compressible perfect gas. The domain is periodic and discretized uniformly with $N$ cells, spacing $\\Delta x = 1/N$, and cell-centered states $U_i$.\n\nPrinciple-based design for split-explicit:\n- Fast acoustic propagation arises from compressibility and pressure gradients; these are associated with rapid waves traveling at speed $c = \\sqrt{\\gamma p/\\rho}$.\n- Slow advective transport arises from material advection with speed $u$.\n- A split-explicit method separates the updates for these processes to allow a larger outer time step constrained by advective speeds and smaller inner substeps constrained by acoustic speeds, reducing computational cost while maintaining stability.\n\nFlux splitting:\nWe decompose the flux into advective and acoustic components,\n$$\nF(U) = F_{\\mathrm{adv}}(U) + F_{\\mathrm{ac}}(U),\n$$\nwith\n$$\nF_{\\mathrm{adv}}(U) = \\begin{bmatrix}\n\\rho u \\\\\n\\rho u^2 \\\\\nu E\n\\end{bmatrix}, \\quad\nF_{\\mathrm{ac}}(U) = \\begin{bmatrix}\n0 \\\\\np \\\\\nu p\n\\end{bmatrix}.\n$$\nThis separation isolates the pressure-related contributions $(p, up)$ from the convective transport contributions $(\\rho u, \\rho u^2, u E)$. Note that in the continuity equation, the flux is $\\rho u$, which is entirely within $F_{\\mathrm{adv}}$. Consequently, the inner acoustic update does not alter mass directly; conservation is ensured by performing all updates in flux-difference form and by summing the conservative contributions across the entire step.\n\nFinite-volume discretization:\nFor a uniform grid with periodic boundaries, the conservative update for a component $U$ over one time step $\\Delta t$ is\n$$\nU_i^{n+1} = U_i^n - \\frac{\\Delta t}{\\Delta x}\\left(\\hat{F}_{i+\\frac{1}{2}} - \\hat{F}_{i-\\frac{1}{2}}\\right),\n$$\nwhere $\\hat{F}_{i+\\frac{1}{2}}$ is the numerical flux at the interface between cells $i$ and $i+1$. We use the Local Lax–Friedrichs (Rusanov) flux which incorporates a stabilizing dissipation proportional to the maximum characteristic speed at the interface. For two states $U_L$ and $U_R$ at the interface,\n$$\n\\hat{F}(U_L, U_R; s) = \\frac{1}{2}\\left(F(U_L) + F(U_R)\\right) - \\frac{1}{2} s (U_R - U_L),\n$$\nwhere $s$ is the maximum signal speed at the interface. For the full Euler flux, a typical choice is $s = \\max\\left(|u_L| + c_L, |u_R| + c_R\\right)$. For the advective flux, the relevant speed is $|u|$, so we set $s_{\\mathrm{adv}} = \\max\\left(|u_L|, |u_R|\\right)$. For the acoustic flux, the relevant speed is $c$, so we set $s_{\\mathrm{ac}} = \\max\\left(c_L, c_R\\right)$. Since $F_{\\mathrm{ac}}$ has zero mass component, we apply the acoustic Rusanov flux only to the momentum and energy components, ensuring that mass is not artificially diffused by acoustic inner steps.\n\nTime splitting:\nLet the outer time step satisfy the advective CFL condition,\n$$\n\\Delta t_{\\mathrm{adv}} = \\mathrm{CFL}_{\\mathrm{adv}} \\frac{\\Delta x}{\\max_i |u_i| + \\epsilon},\n$$\nwith a small regularization $\\epsilon$ to avoid division by zero. Let the acoustic substep size satisfy\n$$\n\\delta t_{\\mathrm{ac}}^{\\star} = \\mathrm{CFL}_{\\mathrm{ac}} \\frac{\\Delta x}{\\max_i c_i},\n$$\nand choose the number of substeps\n$$\nM = \\left\\lceil \\frac{\\Delta t_{\\mathrm{adv}}}{\\delta t_{\\mathrm{ac}}^{\\star}} \\right\\rceil, \\quad \\delta t = \\frac{\\Delta t_{\\mathrm{adv}}}{M}.\n$$\nThus, $M$ substeps of size $\\delta t$ cover the outer-step duration $\\Delta t_{\\mathrm{adv}}$.\n\nAlgorithm per outer step:\n1. Advective update:\n$$\nU^{\\star}_i = U^n_i - \\frac{\\Delta t_{\\mathrm{adv}}}{\\Delta x}\\left(\\hat{F}_{\\mathrm{adv},\\,i+\\frac{1}{2}} - \\hat{F}_{\\mathrm{adv},\\,i-\\frac{1}{2}}\\right),\n$$\nwhere $\\hat{F}_{\\mathrm{adv}}$ is the Rusanov flux using $F_{\\mathrm{adv}}$ and $s_{\\mathrm{adv}}$.\n2. Acoustic inner substeps, for $m = 1, \\dots, M$:\n$$\nU^{\\star}_i \\leftarrow U^{\\star}_i - \\frac{\\delta t}{\\Delta x}\\left(\\hat{F}_{\\mathrm{ac},\\,i+\\frac{1}{2}} - \\hat{F}_{\\mathrm{ac},\\,i-\\frac{1}{2}}\\right),\n$$\nwhere $\\hat{F}_{\\mathrm{ac}}$ uses $F_{\\mathrm{ac}}$ and $s_{\\mathrm{ac}}$, applied only to momentum and energy components; the mass component of $U^{\\star}_i$ is unchanged in these inner steps.\n3. Set $U^{n+1}_i \\leftarrow U^{\\star}_i$.\n\nConservation:\nEach update is performed as a flux difference. With periodic boundaries, the telescoping sum of flux differences across the domain vanishes for both advective and acoustic steps. Therefore, the domain-integrated conservative quantities are preserved by each sub-update up to floating-point round-off. The split-explicit combination is conservative by construction because it composes conservative updates.\n\nStability:\n- The advective CFL condition controls the outer step based on $|u|$.\n- The acoustic CFL condition controls the inner substeps based on $c$.\nUsing Rusanov fluxes with appropriate signal speeds ensures monotonicity and suppresses spurious oscillations. Positivity can be maintained for sufficiently small CFL numbers and smooth data.\n\nAccuracy versus unsplit reference:\nWe compare the split-explicit solution to an unsplit first-order Rusanov scheme using the full Euler flux with a small time step limited by $\\max(|u|+c)$. The differences in $\\ell^2$ norm for density and velocity quantify the accuracy degradation incurred by splitting.\n\nImplementation details:\n- Initialize the base state $\\rho_0 = 1$, $p_0 = 1$, with perturbations of amplitude $\\varepsilon$ in pressure and optional uniform mean velocity $u_0$.\n- Compute $E = \\frac{p}{\\gamma - 1} + \\frac{1}{2}\\rho u^2$.\n- Use periodic indexing for interface fluxes.\n- Accumulate time until $T$ is reached by iterating outer steps; in each outer step, recompute $M$ based on current $c$.\n\nOutputs and test suite:\nWe construct three cases:\n- Case A: Conservation under fast modes, reports three floats: absolute errors in mass, momentum, and energy.\n- Case B: Accuracy versus unsplit reference with nonzero mean flow, reports two floats: $\\ell^2$ errors for density and velocity.\n- Case C: Stability and positivity with large outer step, reports one boolean: true if all densities and pressures remain positive at final time.\n\nFinal output must be a single line with a comma-separated list enclosed in square brackets, in the order: Case A (three floats), Case B (two floats), Case C (one boolean). All computations are nondimensional and unitless; angles and percentages are not involved.\n\nThis design embodies the split-explicit philosophy used in atmospheric models and connects with Semi-Implicit and Horizontally Explicit Vertically Implicit (HEVI) ideas by isolating fast acoustic physics in inner steps, though here we treat the acoustic part explicitly rather than implicitly. The conservative flux-difference approach ensures scientific realism and respects the fundamental conservation laws derived from the Euler equations.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Constants (nondimensional)\nGAMMA = 1.4\n\ndef primitive(U):\n    \"\"\"Convert conservative variables U=[rho, mom, E] to primitive [rho, u, p].\"\"\"\n    rho = U[0]\n    mom = U[1]\n    E = U[2]\n    u = mom / rho\n    kinetic = 0.5 * rho * u * u\n    p = (GAMMA - 1.0) * (E - kinetic)\n    return rho, u, p\n\ndef sound_speed(rho, p):\n    \"\"\"Compute sound speed c = sqrt(gamma * p / rho).\"\"\"\n    return np.sqrt(GAMMA * np.maximum(p, 0.0) / np.maximum(rho, 1e-15))\n\ndef flux_full(U):\n    \"\"\"Full Euler flux F(U).\"\"\"\n    rho, u, p = primitive(U)\n    F = np.zeros_like(U)\n    F[0] = rho * u\n    F[1] = rho * u * u + p\n    F[2] = u * (E(U) + p)\n    return F\n\ndef E(U):\n    \"\"\"Return energy E from conservative state U.\"\"\"\n    return U[2]\n\ndef flux_adv(U):\n    \"\"\"Advective flux F_adv(U) = [rho u, rho u^2, u E].\"\"\"\n    rho, u, p = primitive(U)\n    F = np.zeros_like(U)\n    F[0] = rho * u\n    F[1] = rho * u * u\n    F[2] = u * E(U)\n    return F\n\ndef flux_acoustic(U):\n    \"\"\"Acoustic flux F_ac(U) = [0, p, u p].\"\"\"\n    rho, u, p = primitive(U)\n    F = np.zeros_like(U)\n    F[0] = 0.0\n    F[1] = p\n    F[2] = u * p\n    return F\n\ndef rusanov_flux_adv(UL, UR):\n    \"\"\"Rusanov flux for advective part with speed based on |u|.\"\"\"\n    # Flux average\n    FaL = flux_adv(UL)\n    FaR = flux_adv(UR)\n    rhoL, uL, pL = primitive(UL)\n    rhoR, uR, pR = primitive(UR)\n    s = max(abs(uL), abs(uR))\n    return 0.5 * (FaL + FaR) - 0.5 * s * (UR - UL)\n\ndef rusanov_flux_acoustic(UL, UR):\n    \"\"\"Rusanov flux for acoustic part with speed based on c.\n    Apply diffusion only to momentum and energy components; mass component is zero.\"\"\"\n    FaL = flux_acoustic(UL)\n    FaR = flux_acoustic(UR)\n    rhoL, uL, pL = primitive(UL)\n    rhoR, uR, pR = primitive(UR)\n    cL = np.sqrt(GAMMA * max(pL, 0.0) / max(rhoL, 1e-15))\n    cR = np.sqrt(GAMMA * max(pR, 0.0) / max(rhoR, 1e-15))\n    s = max(cL, cR)\n    flux = 0.5 * (FaL + FaR)\n    # Add Rusanov dissipation only to momentum and energy components\n    diff = 0.5 * s * (UR - UL)\n    flux[1] -= diff[1]\n    flux[2] -= diff[2]\n    # flux[0] remains zero for acoustic part\n    return flux\n\ndef compute_dt_adv(U, dx, cfl_adv):\n    \"\"\"Compute advective outer time step based on max |u|.\"\"\"\n    rho = U[:, 0]\n    mom = U[:, 1]\n    u = mom / rho\n    umax = np.max(np.abs(u))\n    # Regularization to avoid dt -> inf when umax == 0\n    return cfl_adv * dx / max(umax, 1e-12)\n\ndef compute_dt_acoustic(U, dx, cfl_ac):\n    \"\"\"Compute acoustic dt based on max sound speed.\"\"\"\n    rho = U[:, 0]\n    mom = U[:, 1]\n    E_ = U[:, 2]\n    u = mom / rho\n    kinetic = 0.5 * rho * u * u\n    p = (GAMMA - 1.0) * (E_ - kinetic)\n    c = np.sqrt(GAMMA * np.maximum(p, 0.0) / np.maximum(rho, 1e-15))\n    cmax = np.max(c)\n    return cfl_ac * dx / max(cmax, 1e-12)\n\ndef advective_update(U, dx, dt):\n    \"\"\"One conservative advective update using Rusanov flux for F_adv.\"\"\"\n    N = U.shape[0]\n    # Periodic extension for interfaces\n    UL = U\n    UR = np.roll(U, -1, axis=0)\n    F = np.zeros_like(U)\n    # Compute interface fluxes\n    F_interfaces = np.array([rusanov_flux_adv(UL[i], UR[i]) for i in range(N)])\n    # Flux divergence\n    F_right = F_interfaces\n    F_left = np.roll(F_interfaces, 1, axis=0)\n    dU = -(dt / dx) * (F_right - F_left)\n    return U + dU\n\ndef acoustic_update(U, dx, dt):\n    \"\"\"One conservative acoustic update using Rusanov flux for F_ac.\n    Only momentum and energy are updated; mass is not modified.\"\"\"\n    N = U.shape[0]\n    UL = U\n    UR = np.roll(U, -1, axis=0)\n    F_interfaces = np.array([rusanov_flux_acoustic(UL[i], UR[i]) for i in range(N)])\n    F_right = F_interfaces\n    F_left = np.roll(F_interfaces, 1, axis=0)\n    dU = -(dt / dx) * (F_right - F_left)\n    # Ensure mass component is unchanged (since acoustic flux mass component is zero)\n    dU[:, 0] = 0.0\n    return U + dU\n\ndef full_rusanov_update(U, dx, dt):\n    \"\"\"One unsplit full Euler update using Rusanov flux with s = |u| + c.\"\"\"\n    N = U.shape[0]\n    UL = U\n    UR = np.roll(U, -1, axis=0)\n    F_interfaces = np.zeros_like(U)\n    for i in range(N):\n        rhoL, uL, pL = primitive(UL[i])\n        rhoR, uR, pR = primitive(UR[i])\n        cL = np.sqrt(GAMMA * max(pL, 0.0) / max(rhoL, 1e-15))\n        cR = np.sqrt(GAMMA * max(pR, 0.0) / max(rhoR, 1e-15))\n        s = max(abs(uL) + cL, abs(uR) + cR)\n        FL = flux_full(UL[i])\n        FR = flux_full(UR[i])\n        F_interfaces[i] = 0.5 * (FL + FR) - 0.5 * s * (UR[i] - UL[i])\n    F_right = F_interfaces\n    F_left = np.roll(F_interfaces, 1, axis=0)\n    dU = -(dt / dx) * (F_right - F_left)\n    return U + dU\n\ndef initialize_state(N, eps, u0, perturb_pressure=True):\n    \"\"\"Initialize U on x in [0,1] with base rho0=1, p0=1 and sinusoidal pressure perturbation.\"\"\"\n    x = (np.arange(N) + 0.5) / N\n    rho0 = 1.0\n    p0 = 1.0\n    if perturb_pressure:\n        p = p0 * (1.0 + eps * np.sin(2.0 * np.pi * x))\n    else:\n        p = p0 * np.ones_like(x)\n    rho = rho0 * np.ones_like(x)\n    u = u0 * np.ones_like(x)\n    E = p / (GAMMA - 1.0) + 0.5 * rho * u * u\n    U = np.stack([rho, rho * u, E], axis=1)\n    return U\n\ndef totals(U, dx):\n    \"\"\"Compute domain-integrated totals for mass, momentum, energy.\"\"\"\n    mass = np.sum(U[:, 0]) * dx\n    mom = np.sum(U[:, 1]) * dx\n    energy = np.sum(U[:, 2]) * dx\n    return mass, mom, energy\n\ndef split_explicit_integrate(U0, Nsteps_outer, dx, cfl_adv, cfl_ac):\n    \"\"\"Integrate using split-explicit scheme for Nsteps_outer outer steps.\"\"\"\n    U = U0.copy()\n    for _ in range(Nsteps_outer):\n        # Advective step\n        dt_adv = compute_dt_adv(U, dx, cfl_adv)\n        U = advective_update(U, dx, dt_adv)\n        # Acoustic inner steps\n        dt_ac_star = compute_dt_acoustic(U, dx, cfl_ac)\n        M = int(np.ceil(dt_adv / max(dt_ac_star, 1e-15)))\n        dt_sub = dt_adv / max(M, 1)\n        for _m in range(M):\n            U = acoustic_update(U, dx, dt_sub)\n    return U\n\ndef integrate_to_time_split(U0, T, dx, cfl_adv, cfl_ac):\n    \"\"\"Integrate split-explicit scheme until time T by repeated outer steps.\"\"\"\n    U = U0.copy()\n    t = 0.0\n    # Use at least one outer step; loop until reaching or exceeding T\n    while t < T - 1e-14:\n        dt_adv = compute_dt_adv(U, dx, cfl_adv)\n        # Cap to not overshoot T significantly\n        if t + dt_adv > T:\n            dt_adv = T - t\n        # Perform advective update\n        U = advective_update(U, dx, dt_adv)\n        # Acoustic inner steps over dt_adv\n        dt_ac_star = compute_dt_acoustic(U, dx, cfl_ac)\n        M = int(np.ceil(dt_adv / max(dt_ac_star, 1e-15)))\n        dt_sub = dt_adv / max(M, 1)\n        for _ in range(M):\n            U = acoustic_update(U, dx, dt_sub)\n        t += dt_adv\n    return U\n\ndef integrate_to_time_unsplit(U0, T, dx, cfl_ref):\n    \"\"\"Integrate full Rusanov scheme until time T.\"\"\"\n    U = U0.copy()\n    t = 0.0\n    while t < T - 1e-14:\n        # dt based on max(|u| + c)\n        rho = U[:, 0]\n        u = U[:, 1] / rho\n        p = (GAMMA - 1.0) * (U[:, 2] - 0.5 * rho * u * u)\n        c = np.sqrt(GAMMA * np.maximum(p, 0.0) / np.maximum(rho, 1e-15))\n        smax = np.max(np.abs(u) + c)\n        dt = cfl_ref * dx / max(smax, 1e-12)\n        if t + dt > T:\n            dt = T - t\n        U = full_rusanov_update(U, dx, dt)\n        t += dt\n    return U\n\ndef case_A():\n    \"\"\"Case A: conservation under fast modes.\"\"\"\n    N = 200\n    dx = 1.0 / N\n    eps = 1e-4\n    u0 = 0.0\n    cfl_adv = 0.9\n    cfl_ac = 0.3\n    T = 0.02\n    U0 = initialize_state(N, eps, u0, perturb_pressure=True)\n    mass0, mom0, energy0 = totals(U0, dx)\n    Uf = integrate_to_time_split(U0, T, dx, cfl_adv, cfl_ac)\n    massf, momf, energyf = totals(Uf, dx)\n    err_mass = abs(massf - mass0)\n    err_mom = abs(momf - mom0)\n    err_energy = abs(energyf - energy0)\n    return err_mass, err_mom, err_energy\n\ndef case_B():\n    \"\"\"Case B: accuracy versus unsplit reference with nonzero mean flow.\"\"\"\n    N = 200\n    dx = 1.0 / N\n    eps = 1e-4\n    u0 = 0.5\n    cfl_adv = 0.9\n    cfl_ac = 0.3\n    cfl_ref = 0.3\n    T = 0.02\n    U0 = initialize_state(N, eps, u0, perturb_pressure=True)\n    U_split = integrate_to_time_split(U0, T, dx, cfl_adv, cfl_ac)\n    U_ref = integrate_to_time_unsplit(U0, T, dx, cfl_ref)\n    # Compute L2 errors for rho and u\n    rho_split = U_split[:, 0]\n    u_split = U_split[:, 1] / rho_split\n    rho_ref = U_ref[:, 0]\n    u_ref = U_ref[:, 1] / rho_ref\n    err_rho = np.sqrt(np.sum((rho_split - rho_ref) ** 2) * dx)\n    err_u = np.sqrt(np.sum((u_split - u_ref) ** 2) * dx)\n    return err_rho, err_u\n\ndef case_C():\n    \"\"\"Case C: stability and positivity under large outer time step.\"\"\"\n    N = 200\n    dx = 1.0 / N\n    eps = 0.0\n    u0 = 0.2\n    cfl_adv = 0.95\n    cfl_ac = 0.3\n    T = 0.02\n    U0 = initialize_state(N, eps, u0, perturb_pressure=False)\n    Uf = integrate_to_time_split(U0, T, dx, cfl_adv, cfl_ac)\n    rho = Uf[:, 0]\n    u = Uf[:, 1] / rho\n    p = (GAMMA - 1.0) * (Uf[:, 2] - 0.5 * rho * u * u)\n    positivity = bool(np.all(rho > 0.0) and np.all(p > 0.0))\n    return positivity\n\ndef solve():\n    # Define the test cases from the problem statement.\n    results = []\n    # Case A: three floats\n    err_mass, err_mom, err_energy = case_A()\n    results.extend([err_mass, err_mom, err_energy])\n    # Case B: two floats\n    err_rho, err_u = case_B()\n    results.extend([err_rho, err_u])\n    # Case C: one boolean\n    pos_ok = case_C()\n    # Convert boolean to 'True'/'False' string in final print via str()\n    results.append(pos_ok)\n    # Final print statement in the exact required format.\n    # Ensure consistent formatting: floats and booleans printed as str()\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}