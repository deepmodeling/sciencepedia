{
    "hands_on_practices": [
        {
            "introduction": "ENSO的核心动力学过程，特别是延迟振子理论，在很大程度上依赖于赤道太平洋中海洋信号的传播。这些信号主要以赤道开尔文波和罗斯贝波的形式存在，它们分别在温跃层的深度上传播异常。通过推导这些波的相速度并计算它们穿越太平洋所需的时间，我们可以对ENSO循环的关键时间尺度有一个定量的理解。这个练习将引导你完成这个经典计算，为理解ENSO的可预测性奠定基础。",
            "id": "4035494",
            "problem": "在数值天气预报 (NWP) 和气候模拟的背景下，考虑与厄尔尼诺-南方涛动 (ENSO) 相关的赤道海洋动力学。该动力学由赤道 beta 平面上的线性化单层浅水系统表示，其中第一斜压模的折合重力为 $g'$，等效深度为 $H$。从线性化浅水动量和连续性方程以及赤道变形半径的定义出发，推导赤道开尔文模态的长波相速和第一经向模态赤道罗斯贝波的长波相速。然后，在沿赤道相速均匀且忽略背景流的假设下，计算赤道开尔文波速，以及开尔文波和第一罗斯贝波穿越长度为 $L=15{,}000\\ \\mathrm{km}$ 的太平洋海盆的穿越时间。\n\n使用 $g'=0.03\\ \\mathrm{m\\,s^{-2}}$ 和 $H=200\\ \\mathrm{m}$。取海盆长度为 $L=1.5\\times 10^{7}\\ \\mathrm{m}$。速度值以 $\\mathrm{m\\,s^{-1}}$ 表示。时间值以天表示。最终答案请报告第一罗斯贝波穿越时间与开尔文波穿越海盆时间的无量纲比值。将最终答案四舍五入至四位有效数字。",
            "solution": "用户要求我解决一个关于赤道海洋动力学的问题。\n问题是推导赤道开尔文波和第一模态罗斯贝波的相速，计算它们穿越太平洋的传播时间，并求出这些时间的比值。\n\n**第 1 步：问题验证**\n\n**1.1：提取已知条件**\n- 系统：赤道 beta 平面上的线性化单层浅水系统。\n- 折合重力：$g' = 0.03\\ \\mathrm{m\\,s^{-2}}$。\n- 第一斜压模的等效深度：$H = 200\\ \\mathrm{m}$。\n- 太平洋海盆长度：$L = 15{,}000\\ \\mathrm{km}$，也表述为 $L = 1.5 \\times 10^7\\ \\mathrm{m}$。\n- 假设：相速均匀，忽略背景流。\n- 要求推导：赤道开尔文模态的长波相速和第一经向模态赤道罗斯贝波的长波相速。\n- 要求计算：赤道开尔文波速，开尔文波和第一罗斯贝波穿越海盆的传播时间。\n- 最终答案：第一罗斯贝波穿越时间与开尔文波穿越时间的无量纲比值，四舍五入至四位有效数字。\n\n**1.2：使用提取的已知条件进行验证**\n- **科学基础**：该问题基于赤道 beta 平面上成熟的浅水模型，这是热带海洋学和气候动力学的基石，尤其用于解释厄尔尼诺-南方涛动 (ENSO) 的海洋分量。给定的物理参数（$g'$, $H$）对于热带太平洋的第一斜压模是符合实际的。该问题在科学上是合理的。\n- **适定性**：该问题是适定的。它要求从基本方程推导标准波动性质，并随后使用所提供的数据进行计算。给出的信息足以得出一个唯一解。\n- **客观性**：语言精确、定量，且无主观或偏颇的陈述。\n- **完整性与一致性**：该问题是自洽的。给出的两个海盆长度值，$L = 15{,}000\\ \\mathrm{km}$ 和 $L = 1.5 \\times 10^7\\ \\mathrm{m}$，是一致的（$15{,}000 \\times 10^3 = 1.5 \\times 10^7$）。虽然 beta 参数 $\\beta$ 没有明确给出，但它是一个由地球自转和半径导出的行星动力学基本常数，并且“赤道 beta 平面”框架已暗示了它的存在。如下文所示，最终的比值计算不需要它的值。\n- **现实性**：所作的假设（例如，忽略背景流、线性化）是理论模型中为分离出感兴趣的动力学而使用的标准简化。在当前背景下，这些假设并未使问题脱离现实。\n\n**1.3：结论与行动**\n该问题是**有效的**，因为它科学上合理、适定，并包含足够的信息以获得唯一解。我将继续进行详细求解。\n\n---\n\n**第 2 步：求解**\n\n赤道俘获波的动力学由赤道 beta 平面（$f = \\beta y$）上的线性化浅水方程描述，其中 $\\beta = \\frac{df}{dy}|_{y=0}$ 是赤道处科里奥利参数的恒定经向梯度。纬向速度 $u$、经向速度 $v$ 和温跃层深度异常 $h$ 的控制方程为：\n\n$$ \\frac{\\partial u}{\\partial t} - \\beta y v = -g' \\frac{\\partial h}{\\partial x} \\quad (1) $$\n$$ \\frac{\\partial v}{\\partial t} + \\beta y u = -g' \\frac{\\partial h}{\\partial y} \\quad (2) $$\n$$ \\frac{\\partial h}{\\partial t} + H \\left( \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} \\right) = 0 \\quad (3) $$\n\n这里，$g'$ 是折合重力，$H$ 是上层海洋的等效深度。\n\n**推导赤道开尔文波相速**\n\n赤道开尔文波是一个以经向速度为零（$v=0$）为特征的特解。在此条件下，控制方程简化为：\n\n$$ \\frac{\\partial u}{\\partial t} = -g' \\frac{\\partial h}{\\partial x} \\quad (4) $$\n$$ \\beta y u = -g' \\frac{\\partial h}{\\partial y} \\quad (5) $$\n$$ \\frac{\\partial h}{\\partial t} + H \\frac{\\partial u}{\\partial x} = 0 \\quad (6) $$\n\n我们寻求形式为 $f(x-ct, y)$ 的纬向传播的类波解。对于此类解，偏导数通过 $\\frac{\\partial}{\\partial t} = -c \\frac{\\partial}{\\partial x}$ 关联。将此应用于方程 (4) 和 (6)：\n\n由 (4)：$-c \\frac{\\partial u}{\\partial x} = -g' \\frac{\\partial h}{\\partial x} \\implies c u = g' h$（假设积分常数为零）。\n由 (6)：$-c \\frac{\\partial h}{\\partial x} + H \\frac{\\partial u}{\\partial x} = 0 \\implies ch = H u$（假设积分常数为零）。\n\n对于非平凡解（$u, h \\neq 0$），我们可以将 $u = (g'/c)h$ 代入第二个关系式：$c h = H (g'/c)h$。\n这简化为 $c^2 = g'H$。\n因此，开尔文波的相速 $c_K$ 是：\n$$ c_K = \\sqrt{g'H} $$\n这些波向东传播（$c_K > 0$）。方程 (5) 决定了它们的经向结构。代入 $u=(c_K/H)h$：$\\beta y (c_K/H)h = -g' \\partial h/\\partial y$。使用 $c_K^2 = g'H$，这简化为 $\\partial h/\\partial y = -(\\beta/c_K) y h$，积分后得到一个高斯分布 $h(y) \\propto \\exp(-\\beta y^2 / (2c_K))$，证实了该波被俘获在赤道。开尔文波是非频散的，所以该相速适用于所有波长。\n\n**推导赤道罗斯贝波相速**\n\n对于 $v \\neq 0$ 的一般情况，我们寻求形式为 $f(y) e^{i(kx - \\omega t)}$ 的解，其中 $k$ 是纬向波数，$\\omega$ 是角频率。通过系统地从方程 (1)-(3) 中消去 $u$ 和 $h$，可以推导出关于经向速度结构 $\\hat{v}(y)$ 的单一方程：\n$$ \\frac{d^2 \\hat{v}}{dy^2} + \\left( \\frac{\\omega^2}{c_K^2} - k^2 - \\frac{k\\beta}{\\omega} - \\frac{\\beta^2 y^2}{c_K^2} \\right) \\hat{v} = 0 $$\n这里已使用 $c_K^2 = g'H$。这是韦伯方程，也是量子谐振子的控制方程。对于物理上现实的解，当 $y \\to \\pm \\infty$ 时，速度振幅必须是有界的。这个量化条件要求 $\\hat{v}$ 的系数（不包括 $y^2$ 项）必须是一个比例因子的奇数倍。具体来说，它产生频散关系：\n$$ \\frac{\\omega^2}{c_K^2} - k^2 - \\frac{k\\beta}{\\omega} = \\frac{\\beta}{c_K}(2n+1), \\quad n=0, 1, 2, ... $$\n整数 $n$ 是经向模数。赤道罗斯贝波对应于 $n \\ge 1$ 的模态。\n\n问题要求的是长波相速，这对应于小波数极限，$k \\to 0$。在此极限下，罗斯贝波的频率 $\\omega$ 也变得很小。我们可以将频散关系重排成一个关于 $\\omega$ 的三次方程：\n$$ \\omega^3 - (c_K^2 k^2 + (2n+1)\\beta c_K) \\omega - \\beta c_K^2 k = 0 $$\n对于小 $k$，$\\omega^3$ 项是 $k^3$ 阶，而其他项是 $k$ 阶。忽略 $\\omega^3$ 项，得到低频（罗斯贝波）近似：\n$$ -((2n+1)\\beta c_K) \\omega - \\beta c_K^2 k \\approx 0 $$\n$$ \\omega \\approx -\\frac{\\beta c_K^2 k}{(2n+1)\\beta c_K} = -\\frac{c_K k}{2n+1} $$\n因此，长波极限下的相速 $c = \\omega/k$ 为：\n$$ c_R(n) = -\\frac{c_K}{2n+1} $$\n第一经向模态罗斯贝波对应于 $n=1$。其相速 $c_{R1}$ 是：\n$$ c_{R1} = -\\frac{c_K}{2(1)+1} = -\\frac{c_K}{3} $$\n负号表示向西传播。\n\n**计算穿越时间及其比值**\n\n问题要求的是穿越时间的比值。我们首先定义开尔文波（$T_K$）和第一罗斯贝波（$T_{R1}$）穿越长度为 $L$ 的海盆的穿越时间。\n开尔文波以速度 $c_K$ 向东传播。其穿越时间为：\n$$ T_K = \\frac{L}{c_K} $$\n第一罗斯贝波以速度 $|c_{R1}| = c_K/3$ 向西传播。其穿越时间为：\n$$ T_{R1} = \\frac{L}{|c_{R1}|} = \\frac{L}{c_K/3} = 3 \\frac{L}{c_K} $$\n第一罗斯贝波穿越时间与开尔文波穿越时间的无量纲比值为：\n$$ \\frac{T_{R1}}{T_K} = \\frac{3 L/c_K}{L/c_K} = 3 $$\n这个结果是一个常数，与 $g'$、$H$ 和 $L$ 的具体值无关。\n\n为完整起见，我们可以使用给定值计算各自的速度和穿越时间：\n$g' = 0.03\\ \\mathrm{m\\,s^{-2}}$，$H = 200\\ \\mathrm{m}$，以及 $L = 1.5 \\times 10^7\\ \\mathrm{m}$。\n\n开尔文波速：\n$$ c_K = \\sqrt{g'H} = \\sqrt{(0.03)(200)} = \\sqrt{6} \\approx 2.449\\ \\mathrm{m\\,s^{-1}} $$\n\n开尔文波穿越时间：\n$$ T_K = \\frac{1.5 \\times 10^7\\ \\mathrm{m}}{\\sqrt{6}\\ \\mathrm{m\\,s^{-1}}} \\approx 6.124 \\times 10^6\\ \\mathrm{s} \\times \\frac{1\\ \\mathrm{day}}{86400\\ \\mathrm{s}} \\approx 70.88\\ \\mathrm{days} $$\n\n第一罗斯贝波速（大小）：\n$$ |c_{R1}| = \\frac{c_K}{3} = \\frac{\\sqrt{6}}{3} \\approx 0.8165\\ \\mathrm{m\\,s^{-1}} $$\n\n第一罗斯贝波穿越时间：\n$$ T_{R1} = \\frac{L}{|c_{R1}|} = 3 T_K \\approx 3 \\times 70.88\\ \\mathrm{days} \\approx 212.6\\ \\mathrm{days} $$\n\n要求的最终答案是这些穿越时间的比值。根据解析推导，该比值恰好为 3。问题要求将此结果报告为四位有效数字。",
            "answer": "$$\\boxed{3.000}$$"
        },
        {
            "introduction": "虽然海洋波动为ENSO的振荡设定了时间尺度，但异常的增长则是由海洋和大气之间的正反馈驱动的，其中最核心的是比耶克尼斯（Bjerknes）反馈。这个练习探讨了这一关键反馈的敏感性，特别是气候模型中常见的“平均态偏差”如何影响ENSO的增长率和稳定性。通过分析一个简化的耦合模型，你将亲身体会到准确模拟海洋平均温度梯度对于正确预测ENSO行为的重要性。",
            "id": "4035523",
            "problem": "考虑一个气候模式中表示的耦合大气-海洋系统中的厄尔尼诺-南方涛动 (ENSO)。Bjerknes 反馈回路将赤道太平洋的海表温度 (SST) 异常与信风和海洋上升流及洋流的变化联系起来，而这些变化又反过来反馈到 SST 上。在赤道中东太平洋冷舌区，对平均态进行线性化后，混合层温度收支可以写作\n$$\n\\frac{\\partial T'}{\\partial t} \\approx -\\,u'\\,T_x^{m}\\;-\\;w'\\,T_z^{m}\\;-\\;r\\,T',\n$$\n其中 $T'$ 是 SST 异常，$u'$ 和 $w'$ 是异常的纬向和垂直速度，$T_x^{m}$ 是平均纬向 SST 梯度，$T_z^{m}$ 是混合层底部的平均垂直 SST 梯度，$r$ 是一个线性阻尼率，概括了海表热通量阻尼和混合层过程。大气对 $T'$ 的响应改变了信风，从而驱动 $u'$ 和 $w'$；为本题之目的，用线性闭合 $u' = c_u\\,T'$ 和 $w' = c_w\\,T'$ 来表示该耦合响应，其中 $c_u$ 和 $c_w$ 是由赤道太平洋的大尺度 Walker 环流和海洋动力学决定的常数耦合系数。在观测到的平均态中，冷舌向东变冷，因此 $T_x^{m} < 0$，而在近表层海洋向上变暖，因此 $T_z^{m} > 0$。在厄尔尼诺条件下，$T' > 0$ 削弱了东风信风，导致 $u' > 0$（向东的异常）和 $w' < 0$（上升流减弱），这与 $c_u > 0$ 和 $c_w < 0$ 一致。\n\n从混合层收支和这些线性闭合出发，推导 $T'$ 的线性增长率 $\\sigma$ 的表达式，并用它来评估 $T_x^{m}$ 的平均态偏差如何改变 Bjerknes 反馈回路。然后，使用以下科学上合理的参数，计算基准和有偏差的耦合模式平均态的增长率和 e-折时间：\n- $c_u = 0.3\\ \\mathrm{m}\\ \\mathrm{s}^{-1}\\ \\mathrm{K}^{-1}$,\n- $c_w = -2.0\\times 10^{-6}\\ \\mathrm{m}\\ \\mathrm{s}^{-1}\\ \\mathrm{K}^{-1}$,\n- $T_x^{m}(\\text{baseline}) = -5.0\\times 10^{-7}\\ \\mathrm{K}\\ \\mathrm{m}^{-1}$,\n- $T_z^{m} = 1.5\\times 10^{-2}\\ \\mathrm{K}\\ \\mathrm{m}^{-1}$,\n- $r = 1.2\\times 10^{-7}\\ \\mathrm{s}^{-1}$。\n假设有偏差的模式其冷舌平均纬向 SST 梯度减弱了 $40\\%$，即 $T_x^{m}(\\text{biased}) = 0.6\\,T_x^{m}(\\text{baseline})$。\n\n选择所有关于此平均态偏差对 Bjerknes 反馈回路和线性增长率影响的正确陈述：\nA. Bjerknes 反馈的平流分量与 $|T_x^{m}|$ 呈线性关系；在上述参数下，将 $|T_x^{m}|$ 减弱 $40\\%$ 会使总增长率从 $6.0\\times 10^{-8}\\ \\mathrm{s}^{-1}$ 降至约 $0$，使系统呈中性稳定，并将 e-折时间推至无穷大。\nB. 减弱冷舌的平均纬向 SST 梯度会使总增长率增加到 $9.0\\times 10^{-8}\\ \\mathrm{s}^{-1}$，因为减弱的平均平流会减小阻尼。\nC. 由于上升流的贡献占主导，增长率不受 $|T_x^{m}|$ 减弱 $40\\%$ 的影响；它仍然是 $6.0\\times 10^{-8}\\ \\mathrm{s}^{-1}$。\nD. 如果平均纬向 SST 梯度的符号反转（即 $T_x^{m} > 0$），平流项将成为对 $T'$ 的负反馈，将 Bjerknes 回路转变为净阻尼并抑制 ENSO 的增长。\nE. 在有偏差的平均态下，$T'$ 的 e-折时间约为 $193$ 天，与基准情况相同。\n\n通过选择正确的选项来回答。",
            "solution": "用户提供了一个关于厄尔尼诺-南方涛动 (ENSO) 简化模型的问题，并要求基于推导出的增长率来评估几个陈述。\n\n### 第 1 步：提取已知条件\n\n问题提供了以下信息：\n- 混合层温度收支方程：$\\frac{\\partial T'}{\\partial t} \\approx -\\,u'\\,T_x^{m}\\;-\\;w'\\,T_z^{m}\\;-\\;r\\,T'$\n- $T'$：海表温度 (SST) 异常\n- $u'$, $w'$：异常的纬向和垂直速度\n- $T_x^{m}$：平均纬向 SST 梯度\n- $T_z^{m}$：平均垂直 SST 梯度\n- $r$：线性阻尼率\n- 异常速度的线性闭合：$u' = c_u\\,T'$ 和 $w' = c_w\\,T'$\n- $c_u, c_w$：常数耦合系数\n- 赤道中东太平洋冷舌的平均态条件：$T_x^{m} < 0$ 和 $T_z^{m} > 0$\n- 推断的耦合系数符号：$c_u > 0$ 和 $c_w < 0$\n- 用于计算的参数值：\n    - $c_u = 0.3\\ \\mathrm{m}\\ \\mathrm{s}^{-1}\\ \\mathrm{K}^{-1}$\n    - $c_w = -2.0\\times 10^{-6}\\ \\mathrm{m}\\ \\mathrm{s}^{-1}\\ \\mathrm{K}^{-1}$\n    - $T_x^{m}(\\text{baseline}) = -5.0\\times 10^{-7}\\ \\mathrm{K}\\ \\mathrm{m}^{-1}$\n    - $T_z^{m} = 1.5\\times 10^{-2}\\ \\mathrm{K}\\ \\mathrm{m}^{-1}$\n    - $r = 1.2\\times 10^{-7}\\ \\mathrm{s}^{-1}$\n- 有偏差的模式状态的条件：$T_x^{m}(\\text{biased}) = 0.6\\,T_x^{m}(\\text{baseline})$\n\n### 第 2 步：使用提取的已知条件进行验证\n\n- **科学依据**：该问题提出了一个简化的、线性化的 Bjerknes 反馈模型，这是 ENSO 理论的基石。这种“快物理”或“充电-放电”振子风格的模型是理论气候动力学中理解 ENSO 基本机制的标准工具。所提供的参数明确说明是科学上合理的，其符号与对赤道太平洋气候系统的观测一致。该模型是一个有效但简化的真实世界物理系统表示。\n- **适定性**：该问题被表述为一个一阶线性常微分方程。所有必要的参数和初始条件（隐含地，一个非零的初始异常 $T'(0)$）都已提供，以找到唯一的增长率并评估系统的稳定性。\n- **客观性**：该问题使用精确、定量和无偏见的语言陈述。没有主观或基于意见的元素。\n\n该问题在科学上是合理的、适定的和客观的。因此适合求解。\n\n### 第 3 步：推导与计算\n\n首先，我们推导线性增长率 $\\sigma$ 的表达式。我们从给定的混合层温度收支方程开始：\n$$ \\frac{\\partial T'}{\\partial t} = -u' T_x^m - w' T_z^m - r T' $$\n将线性闭合 $u' = c_u T'$ 和 $w' = c_w T'$ 代入方程：\n$$ \\frac{\\partial T'}{\\partial t} = -(c_u T') T_x^m - (c_w T') T_z^m - r T' $$\n提出 SST 异常 $T'$：\n$$ \\frac{\\partial T'}{\\partial t} = (-c_u T_x^m - c_w T_z^m - r) T' $$\n这个方程的形式是 $\\frac{dT'}{dt} = \\sigma T'$，其解为 $T'(t) = T'(0)e^{\\sigma t}$。因此，线性增长率 $\\sigma$ 是：\n$$ \\sigma = -c_u T_x^m - c_w T_z^m - r $$\n这个 $\\sigma$ 的表达式由三项组成：\n1.  纬向平流反馈：$-c_u T_x^m$。由于 $c_u > 0$ 和 $T_x^m < 0$，该项为正，代表一个促进异常增长的正反馈。\n2.  温跃层反馈（与上升流相关）：$-c_w T_z^m$。由于 $c_w < 0$ 和 $T_z^m > 0$，该项也为正，代表另一个正反馈。\n3.  阻尼项：$-r$。由于 $r > 0$，该项为负，代表一个抑制异常的负反馈。\n\n这两个正反馈项共同构成了该模型中的 Bjerknes 反馈。一个正的总增长率（$\\sigma > 0$）表示一个不稳定的系统，其中异常会指数增长。\n\n**基准情况计算**\n\n我们使用基准参数计算增长率 $\\sigma_{base}$：\n$$ \\sigma_{base} = -c_u T_x^m(\\text{baseline}) - c_w T_z^m - r $$\n$$ \\sigma_{base} = -(0.3\\ \\mathrm{m}\\ \\mathrm{s}^{-1}\\ \\mathrm{K}^{-1})(-5.0 \\times 10^{-7}\\ \\mathrm{K}\\ \\mathrm{m}^{-1}) - (-2.0 \\times 10^{-6}\\ \\mathrm{m}\\ \\mathrm{s}^{-1}\\ \\mathrm{K}^{-1})(1.5 \\times 10^{-2}\\ \\mathrm{K}\\ \\mathrm{m}^{-1}) - (1.2 \\times 10^{-7}\\ \\mathrm{s}^{-1}) $$\n$$ \\sigma_{base} = (1.5 \\times 10^{-7}\\ \\mathrm{s}^{-1}) + (3.0 \\times 10^{-8}\\ \\mathrm{s}^{-1}) - (1.2 \\times 10^{-7}\\ \\mathrm{s}^{-1}) $$\n为方便相加，我们将所有项写成相同的 10 的幂次：\n$$ \\sigma_{base} = (1.5 \\times 10^{-7}\\ \\mathrm{s}^{-1}) + (0.3 \\times 10^{-7}\\ \\mathrm{s}^{-1}) - (1.2 \\times 10^{-7}\\ \\mathrm{s}^{-1}) $$\n$$ \\sigma_{base} = (1.5 + 0.3 - 1.2) \\times 10^{-7}\\ \\mathrm{s}^{-1} = 0.6 \\times 10^{-7}\\ \\mathrm{s}^{-1} = 6.0 \\times 10^{-8}\\ \\mathrm{s}^{-1} $$\n系统是不稳定的，具有正增长率。e-折时间为 $\\tau = 1/\\sigma$。\n$$ \\tau_{base} = \\frac{1}{6.0 \\times 10^{-8}\\ \\mathrm{s}^{-1}} \\approx 1.667 \\times 10^7\\ \\mathrm{s} $$\n转换为天（$1 \\text{ 天} = 86400\\ \\mathrm{s}$）：\n$$ \\tau_{base} \\approx \\frac{1.667 \\times 10^7}{86400} \\approx 192.9\\ \\text{天} \\approx 193\\ \\text{天} $$\n\n**有偏差情况计算**\n\n有偏差的模式其平均纬向 SST 梯度减弱了 $40\\%$，意味着其大小减小到基准值的 $60\\%$。\n$$ T_x^m(\\text{biased}) = 0.6 \\times T_x^m(\\text{baseline}) = 0.6 \\times (-5.0 \\times 10^{-7}\\ \\mathrm{K}\\ \\mathrm{m}^{-1}) = -3.0 \\times 10^{-7}\\ \\mathrm{K}\\ \\mathrm{m}^{-1} $$\n现在我们计算有偏差的增长率 $\\sigma_{biased}$。只有第一项发生变化。\n$$ \\sigma_{biased} = -c_u T_x^m(\\text{biased}) - c_w T_z^m - r $$\n$$ \\sigma_{biased} = -(0.3\\ \\mathrm{m}\\ \\mathrm{s}^{-1}\\ \\mathrm{K}^{-1})(-3.0 \\times 10^{-7}\\ \\mathrm{K}\\ \\mathrm{m}^{-1}) + (3.0 \\times 10^{-8}\\ \\mathrm{s}^{-1}) - (1.2 \\times 10^{-7}\\ \\mathrm{s}^{-1}) $$\n$$ \\sigma_{biased} = (0.9 \\times 10^{-7}\\ \\mathrm{s}^{-1}) + (0.3 \\times 10^{-7}\\ \\mathrm{s}^{-1}) - (1.2 \\times 10^{-7}\\ \\mathrm{s}^{-1}) $$\n$$ \\sigma_{biased} = (0.9 + 0.3 - 1.2) \\times 10^{-7}\\ \\mathrm{s}^{-1} = 0\\ \\mathrm{s}^{-1} $$\n增长率为零意味着系统是中性稳定的。e-折时间为 $\\tau_{biased} = 1/0 \\rightarrow \\infty$。\n\n### 第 4 步：逐项分析\n\n**A. Bjerknes 反馈的平流分量与 $|T_x^{m}|$ 呈线性关系；在上述参数下，将 $|T_x^{m}|$ 减弱 $40\\%$ 会使总增长率从 $6.0\\times 10^{-8}\\ \\mathrm{s}^{-1}$ 降至约 $0$，使系统呈中性稳定，并将 e-折时间推至无穷大。**\n- 纬向平流反馈对增长率的贡献是 $-c_u T_x^m$。由于在冷舌区 $c_u > 0$ 且 $T_x^m < 0$，该项可以写成 $c_u |T_x^m|$，它与 $|T_x^m|$ 呈线性关系。这部分是正确的。“平流分量”一词被合理地解释为这个纬向平流项。\n- 我们的计算表明，基准增长率是 $\\sigma_{base} = 6.0 \\times 10^{-8}\\ \\mathrm{s}^{-1}$。这与陈述相符。\n- 我们的计算表明，将 $|T_x^m|$ 减弱 $40\\%$（即减至其基准值的 $60\\%$）导致有偏差的增长率为 $\\sigma_{biased} = 0 \\ \\mathrm{s}^{-1}$。这与陈述相符。\n- 增长率为 $0$ 对应于一个中性稳定的系统，其中异常既不增长也不衰减。这与陈述相符。\n- 中性稳定系统的 e-折时间是无限的。这与陈述相符。\n- 该陈述的所有部分都得到了我们的推导和计算的支持。\n**结论：正确。**\n\n**B. 减弱冷舌的平均纬向 SST 梯度会使总增长率增加到 $9.0\\times 10^{-8}\\ \\mathrm{s}^{-1}$，因为减弱的平均平流会减小阻尼。**\n- 我们的计算表明，减弱平均纬向 SST 梯度（减小 $|T_x^m|$）会*降低*增长率，从 $6.0 \\times 10^{-8}\\ \\mathrm{s}^{-1}$ 降到 $0$，而不是增加。\n- 值 $9.0\\times 10^{-8}\\ \\mathrm{s}^{-1}$ 对应于有偏差情况下的纬向平流反馈项（$0.9 \\times 10^{-7}\\ \\mathrm{s}^{-1}$），而不是总增长率。\n- “减弱的平均平流会减小阻尼”的推理在物理上是不正确的。阻尼项 $-r$ 与平流项无关。减弱纬向 SST 梯度是减弱了一个*正*反馈，使系统变得更稳定。\n**结论：错误。**\n\n**C. 由于上升流的贡献占主导，增长率不受 $|T_x^{m}|$ 减弱 $40\\%$ 的影响；它仍然是 $6.0\\times 10^{-8}\\ \\mathrm{s}^{-1}$。**\n- 我们的计算表明，增长率从 $6.0 \\times 10^{-8}\\ \\mathrm{s}^{-1}$ 变为 $0$。声称它不变是错误的。\n- “因为上升流的贡献占主导”的推理也是错误的。在基准情况下，纬向平流反馈是 $1.5 \\times 10^{-7}\\ \\mathrm{s}^{-1}$，而上升流反馈是 $0.3 \\times 10^{-7}\\ \\mathrm{s}^{-1}$。纬向平流的贡献更大。\n**结论：错误。**\n\n**D. 如果平均纬向 SST 梯度的符号反转（即 $T_x^{m} > 0$），平流项将成为对 $T'$ 的负反馈，将 Bjerknes 回路转变为净阻尼并抑制 ENSO 的增长。**\n- 让我们分析这个假设情景。纬向平流反馈对 $\\sigma$ 的贡献是 $-c_u T_x^m$。\n- 给定 $c_u > 0$，如果 $T_x^m > 0$，那么 $-c_u T_x^m$ 项变为负值。对增长率的负贡献代表一种恢复力，即负反馈。陈述的第一部分是正确的。\n- Bjerknes 反馈的总贡献是 $\\sigma_{BJ} = -c_u T_x^m - c_w T_z^m$。我们已经确定上升流项 $-c_w T_z^m$ 是正的（$3.0 \\times 10^{-8}\\ \\mathrm{s}^{-1}$）。如果我们假设一个符号反转但大小与基准情况相同的梯度，$T_x^m = +5.0 \\times 10^{-7}\\ \\mathrm{K}\\ \\mathrm{m}^{-1}$，则纬向平流项变为 $-(0.3)(5.0 \\times 10^{-7}) = -1.5 \\times 10^{-7}\\ \\mathrm{s}^{-1}$。\n- Bjerknes 反馈的净贡献将是 $\\sigma_{BJ} = (-1.5 \\times 10^{-7} + 0.3 \\times 10^{-7})\\ \\mathrm{s}^{-1} = -1.2 \\times 10^{-7}\\ \\mathrm{s}^{-1}$。这是负值，所以整个 Bjerknes 回路变成了一个阻尼机制。陈述的第二部分是正确的。\n- 总增长率将是 $\\sigma = \\sigma_{BJ} - r = -1.2 \\times 10^{-7}\\ \\mathrm{s}^{-1} - 1.2 \\times 10^{-7}\\ \\mathrm{s}^{-1} = -2.4 \\times 10^{-7}\\ \\mathrm{s}^{-1}$。负增长率意味着任何初始异常 $T'$ 都会指数衰减，从而抑制 ENSO 的增长。陈述的第三部分是正确的。\n**结论：正确。**\n\n**E. 在有偏差的平均态下，$T'$ 的 e-折时间约为 $193$ 天，与基准情况相同。**\n- 我们的计算表明，基准情况的 e-折时间是 $\\tau_{base} \\approx 193$ 天。\n- 我们对有偏差平均态的计算得出的增长率为 $\\sigma_{biased} = 0$，这对应于一个无限的 e-折时间，$\\tau_{biased} \\rightarrow \\infty$。\n- 因此，有偏差状态下的 e-折时间与基准情况不同。\n**结论：错误。**",
            "answer": "$$\\boxed{AD}$$"
        },
        {
            "introduction": "为了在复杂的地球系统中梳理出特定的物理机制，气候科学家经常使用中间复杂度的耦合模型来进行数值实验。这个实践将让你扮演气候建模科学家的角色，设计并执行一个数值实验来分离和量化不同反馈过程的贡献。通过在一个简化的ENSO模型中“开启”和“关闭”云短波辐射反馈，你将能够精确地分离出比耶克尼斯反馈的作用，并评估其对ENSO主模态增长率和结构的影响。",
            "id": "4035478",
            "problem": "要求您形式化并执行一个数值实验，以在一个最小化的 El Niño–Southern Oscillation (ENSO) 中间耦合模型中分离出 Bjerknes 反馈。Bjerknes 反馈是连接赤道东太平洋海表温度 (SST)、赤道纬向风应力和温跃层深度异常的耦合正反馈回路：一个正的 SST 异常会引发西风应力异常，这会加深东部的温跃层，进而进一步加热 SST。大气短波云反馈通过调节进入海洋的净短波辐射（作为 SST 异常的函数）为 SST 增加了一个额外的局部辐射反馈。为了分离 Bjerknes 反馈，我们将抑制大气短波云反馈，并量化由此引起的增长率和模态结构的变化。\n\n从以下原则和定义开始：\n\n- 令状态向量为 $\\mathbf{x} = [T, h, \\tau]^{\\top}$，其中 $T$ 是赤道东太平洋海表温度异常（单位：开尔文），$h$ 是赤道东部温跃层深度异常（单位：米），$\\tau$ 是纬向风应力异常的无量纲代理。时间单位是月。\n- 线性化的混合层热收支、海洋调整和大气动量响应表示为一个线性时不变系统：\n$$\n\\frac{d}{dt}\n\\begin{bmatrix}\nT\\\\\nh\\\\\n\\tau\n\\end{bmatrix}\n=\n\\underbrace{\n\\begin{bmatrix}\n-(\\lambda_T - \\gamma_{\\mathrm{sw}})  \\alpha_h  \\alpha_{\\tau} \\\\\n0  -\\lambda_h  \\beta_{\\tau} \\\\\n\\beta_T  0  -\\lambda_{\\tau}\n\\end{bmatrix}\n}_{\\mathbf{A}}\n\\begin{bmatrix}\nT\\\\\nh\\\\\n\\tau\n\\end{bmatrix}.\n$$\n这里，$\\lambda_T$ 是 SST 的线性热阻尼率（单位：月$^{-1}$），$\\gamma_{\\mathrm{sw}}$ 是修改 SST 净辐射趋势的线性大气短波云反馈系数（单位：月$^{-1}$），$\\alpha_h$ 量化了 SST 趋势对温跃层深度异常的敏感性（单位：开尔文/米/月），$\\alpha_{\\tau}$ 量化了风应力对 SST 趋势的直接贡献（单位：开尔文/无量纲应力/月），$\\lambda_h$ 是温跃层深度异常的阻尼率（单位：月$^{-1}$），$\\beta_{\\tau}$ 是温跃层深度趋势对风应力的敏感性（单位：米/无量纲应力/月），$\\beta_T$ 是从 SST 到风应力趋势的大气耦合（单位：无量纲应力/开尔文/月），而 $\\lambda_{\\tau}$ 是风应力异常的大气阻尼率（单位：月$^{-1}$）。Bjerknes 反馈是 $T \\rightarrow \\tau \\rightarrow h \\rightarrow T$ 循环，由非对角耦合项 $\\beta_T$、$\\beta_{\\tau}$ 和 $\\alpha_h$ 捕捉。大气短波云反馈由 $\\gamma_{\\mathrm{sw}}$ 参数化，并局部作用于 $T$。\n- 主导耦合模态的增长率是 $\\mathbf{A}$ 的具有最大实部的特征值的实部。将此特征值表示为 $\\lambda_{\\max} = \\sigma + i \\omega$，其中 $\\sigma = \\Re(\\lambda_{\\max})$ 且 $\\omega = \\Im(\\lambda_{\\max})$。如果 $|\\omega| \\neq 0$，则振荡周期（以月为单位）为 $2\\pi/|\\omega|$。模态结构由相应的特征向量 $\\mathbf{v} = [v_T, v_h, v_{\\tau}]^{\\top}$ 给出。通过 $v_T$ 进行归一化，并报告复数比率 $v_h/v_T$ 和 $v_{\\tau}/v_T$ 的振幅和相位（辐角），单位为弧度。相位必须在区间 $[-\\pi, \\pi]$ 内。\n- 所有角度量必须以弧度为单位。所有增长率必须以 月$^{-1}$ 表示。所有周期必须以月表示。\n- 对于每个测试用例，您的程序应输出一个包含六个数字的列表：$[\\sigma, P, |v_h/v_T|, \\arg(v_h/v_T), |v_{\\tau}/v_T|, \\arg(v_{\\tau}/v_T)]$。\n\n通过比较大气短波云反馈激活与抑制时的主导模态，设计数值实验以分离 Bjerknes 反馈。使用以下参数测试套件，该套件探索了一个基线、抑制实验以及几个用于覆盖的边缘案例。所有参数均采用上述指定的单位：\n\n- 案例 1（基线，大气短波云反馈激活）：\n  - $\\lambda_T = 0.25$, $\\lambda_h = 0.10$, $\\lambda_{\\tau} = 0.50$, $\\alpha_h = 0.06$, $\\alpha_{\\tau} = 0.02$, $\\beta_{\\tau} = 0.50$, $\\beta_T = 0.80$, $\\gamma_{\\mathrm{sw}} = 0.06$。\n- 案例 2（抑制短波云反馈以分离 Bjerknes 反馈）：\n  - $\\lambda_T = 0.25$, $\\lambda_h = 0.10$, $\\lambda_{\\tau} = 0.50$, $\\alpha_h = 0.06$, $\\alpha_{\\tau} = 0.02$, $\\beta_{\\tau} = 0.50$, $\\beta_T = 0.80$, $\\gamma_{\\mathrm{sw}} = 0.00$。\n- 案例 3（通过移除 SST 到风的耦合来禁用 Bjerknes 回路，并抑制短波云反馈）：\n  - $\\lambda_T = 0.25$, $\\lambda_h = 0.10$, $\\lambda_{\\tau} = 0.50$, $\\alpha_h = 0.06$, $\\alpha_{\\tau} = 0.02$, $\\beta_{\\tau} = 0.50$, $\\beta_T = 0.00$, $\\gamma_{\\mathrm{sw}} = 0.00$。\n- 案例 4（强局部热阻尼，抑制短波云反馈）：\n  - $\\lambda_T = 0.80$, $\\lambda_h = 0.10$, $\\lambda_{\\tau} = 0.50$, $\\alpha_h = 0.06$, $\\alpha_{\\tau} = 0.02$, $\\beta_{\\tau} = 0.50$, $\\beta_T = 0.80$, $\\gamma_{\\mathrm{sw}} = 0.00$。\n- 案例 5（中等强度的大气短波云反馈）：\n  - $\\lambda_T = 0.25$, $\\lambda_h = 0.10$, $\\lambda_{\\tau} = 0.50$, $\\alpha_h = 0.06$, $\\alpha_{\\tau} = 0.02$, $\\beta_{\\tau} = 0.50$, $\\beta_T = 0.80$, $\\gamma_{\\mathrm{sw}} = 0.03$。\n\n算法要求：\n\n- 对于每个案例，完全按照规定构建矩阵 $\\mathbf{A}$。\n- 计算 $\\mathbf{A}$ 的所有特征值和右特征向量。\n- 选择具有最大实部的特征值 $\\lambda_{\\max}$。如果在数值公差范围内有多个特征值具有相同的实部，则选择虚部绝对值最大的那个。\n- 通过其温度分量 $v_T$ 对相应的特征向量 $\\mathbf{v}$ 进行归一化；如果 $|v_T| < 10^{-12}$，您必须改为通过具有最大幅值的分量进行归一化，并且仍然使用一个小的复数扰动来形成所要求的比率 $v_h/v_T$ 和 $v_{\\tau}/v_T$，以避免除以零。在这种备用情况下，在形成比率之前将扰动设置为 $v_T \\leftarrow v_T + i \\cdot 10^{-12}$。\n- 将每个案例的六个所求量报告为浮点数。\n\n最终输出格式：\n\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个条目本身是按案例 1 到 5 顺序排列的测试用例列表。例如，打印的行应如下所示：“[[case1_values],[case2_values],...,[case5_values]]”。数字可以用标准十进制表示法打印。所有输出必须遵循指定的单位：增长率单位为 月$^{-1}$，周期单位为月，角度单位为弧度。\n\n目标是在此中间耦合框架内分离 Bjerknes 反馈时，量化抑制大气短波云反馈如何改变主导模态的增长率和模态结构。",
            "solution": "该问题要求对 El Niño–Southern Oscillation (ENSO) 的一个简化线性化模型进行数值分析。该模型描述了赤道太平洋地区海表温度（$T$）、温跃层深度（$h$）和纬向风应力（$\\tau$）异常的耦合动力学。任务的核心是在不同的物理参数设置下，研究系统主导变率模态（称为主导耦合模態）的稳定性和结构。这涉及到对系统动力学矩阵 $\\mathbf{A}$ 进行特征值分解，以将 Bjerknes 反馈机制与大气短波云反馈分离开来。\n\n该系统由一个线性时不变常微分方程控制：\n$$\n\\frac{d\\mathbf{x}}{dt} = \\mathbf{A} \\mathbf{x}\n$$\n其中状态向量为 $\\mathbf{x} = [T, h, \\tau]^{\\top}$。动力学矩阵 $\\mathbf{A}$ 由下式给出：\n$$\n\\mathbf{A} =\n\\begin{bmatrix}\n-(\\lambda_T - \\gamma_{\\mathrm{sw}})  \\alpha_h  \\alpha_{\\tau} \\\\\n0  -\\lambda_h  \\beta_{\\tau} \\\\\n\\beta_T  0  -\\lambda_{\\tau}\n\\end{bmatrix}\n$$\n该矩阵中的参数代表物理过程：$\\lambda_T$、$\\lambda_h$ 和 $\\lambda_{\\tau}$ 分别是 $T$、$h$ 和 $\\tau$ 的阻尼率。参数 $\\gamma_{\\mathrm{sw}}$ 代表云对 SST 的局部正反馈。非对角元素 $\\alpha_h$、$\\alpha_{\\tau}$、$\\beta_{\\tau}$ 和 $\\beta_T$ 代表状态变量之间的耦合。具体来说，敏感度 $\\beta_T$（SST 强迫风应力）、$\\beta_{\\tau}$（风应力强迫温跃层深度）和 $\\alpha_h$（温跃层深度强迫 SST）的乘积构成了被称为 Bjerknes 反馈的核心正反馈回路。\n\n该线性系统的解形式为 $\\mathbf{x}(t) = \\mathbf{v}e^{\\lambda t}$，其中 $\\lambda$ 是 $\\mathbf{A}$ 的一个特征值，$\\mathbf{v}$ 是对应的特征向量。将此形式代入微分方程，得到标准特征值问题 $\\mathbf{A}\\mathbf{v} = \\lambda\\mathbf{v}$。\n\n每个模态的时间演化由其特征值 $\\lambda = \\sigma + i\\omega$ 决定。\n- 实部 $\\sigma = \\Re(\\lambda)$ 是模态的增长率。正增长率（$\\sigma > 0$）表示一个不稳定的增长模态，这是 ENSO 的特征。负增长率（$\\sigma < 0$）表示一个稳定的衰减模态。单位是 月$^{-1}$。\n- 虚部 $\\omega = \\Im(\\lambda)$ 是振荡的角频率。对于 $\\omega \\neq 0$，振荡周期由 $P = 2\\pi/|\\omega|$ 给出。单位是月。\n\n问题要求识别“主导模态”，即最不稳定或最不稳定的模态。这对应于具有最大实部的特征值，记为 $\\lambda_{\\max}$。随着时间的推移，该模态将主导系统的行为。\n\n模态的结构由其对应的特征向量 $\\mathbf{v} = [v_T, v_h, v_{\\tau}]^{\\top}$ 描述。特征向量的分量通常是复数，编码了物理变量 $T$、$h$ 和 $\\tau$ 之间的相对振幅和相位关系。为了独立于模态的总体振幅（这是任意的）来分析这些关系，我们对特征向量进行归一化。问题指定通过 SST 分量 $v_T$ 进行归一化。得到的复数比率 $r_h = v_h/v_T$ 和 $r_{\\tau} = v_{\\tau}/v_T$ 是关键的诊断量：\n- 例如，大小 $|r_h| = |v_h/v_T|$ 给出了相对于单位 SST 异常的温跃层深度异常的振幅。\n- 例如，辐角（相位）$\\arg(r_h) = \\arg(v_h/v_T)$ 给出了相对于 SST 异常的温跃层异常的相位，单位为弧度。正相位表示 $h$ 在振荡中领先于 $T$，而负相位表示 $h$ 落后于 $T$。\n\n每个测试用例的数值程序如下：\n1.  使用指定的参数值构建矩阵 $\\mathbf{A}$。\n2.  计算 $\\mathbf{A}$ 的特征值和右特征向量。\n3.  将具有最大实部的特征值确定为主导特征值 $\\lambda_{\\max}$。如果实部出现并列，则选择虚部绝对值最大的特征值。\n4.  提取相应的特征向量 $\\mathbf{v}$。\n5.  计算增长率 $\\sigma = \\Re(\\lambda_{\\max})$ 和周期 $P$。如果虚部的绝对值低于一个小阈值，即 $|\\omega| < \\varepsilon = 10^{-8}$，则周期设为 $0$。\n6.  计算复数比率 $r_h = v_h/v_T$ 和 $r_{\\tau} = v_{\\tau}/v_T$。如果 SST 分量的大小 $|v_T|$ 非常小（小于 $10^{-12}$），则需要特殊处理。在这种边缘情况下，为防止除以零或数值不稳定，在分母上添加一个小的虚数扰动：例如，比率变为 $v_h / (v_T + i \\cdot 10^{-12})$。\n7.  从复数比率中提取振幅（$|r_h|$、$|r_{\\tau}|$）和相位（$\\arg(r_h)$、$\\arg(r_{\\tau})$），确保相位在区间 $[-\\pi, \\pi]$ 内。\n8.  为每个案例收集六个结果值：$[\\sigma, P, |v_h/v_T|, \\arg(v_h/v_T), |v_{\\tau}/v_T|, \\arg(v_{\\tau}/v_T)]$。\n\n此过程应用于五个不同的案例。案例 1（$\\gamma_{\\mathrm{sw}} > 0$）和案例 2（$\\gamma_{\\mathrm{sw}} = 0$）之间的比较专门量化了大气短波云反馈对主导 ENSO 模态的影响。案例 3 中，Bjerknes 反馈被禁用（$\\beta_T = 0$），作为对照，以证明该反馈在产生不稳定性中的关键作用。其他案例则进一步探索了参数空间。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the ENSO simplified model problem by analyzing the leading eigenmode\n    of the system matrix for several test cases.\n    \"\"\"\n\n    test_cases = [\n        # Case 1: baseline with atmospheric shortwave cloud feedback active\n        {'lambda_T': 0.25, 'lambda_h': 0.10, 'lambda_tau': 0.50, 'alpha_h': 0.06,\n         'alpha_tau': 0.02, 'beta_tau': 0.50, 'beta_T': 0.80, 'gamma_sw': 0.06},\n        # Case 2: shortwave cloud feedback suppressed\n        {'lambda_T': 0.25, 'lambda_h': 0.10, 'lambda_tau': 0.50, 'alpha_h': 0.06,\n         'alpha_tau': 0.02, 'beta_tau': 0.50, 'beta_T': 0.80, 'gamma_sw': 0.00},\n        # Case 3: Bjerknes loop disabled, shortwave cloud feedback suppressed\n        {'lambda_T': 0.25, 'lambda_h': 0.10, 'lambda_tau': 0.50, 'alpha_h': 0.06,\n         'alpha_tau': 0.02, 'beta_tau': 0.50, 'beta_T': 0.00, 'gamma_sw': 0.00},\n        # Case 4: strong local thermal damping, shortwave cloud feedback suppressed\n        {'lambda_T': 0.80, 'lambda_h': 0.10, 'lambda_tau': 0.50, 'alpha_h': 0.06,\n         'alpha_tau': 0.02, 'beta_tau': 0.50, 'beta_T': 0.80, 'gamma_sw': 0.00},\n        # Case 5: moderate atmospheric shortwave cloud feedback\n        {'lambda_T': 0.25, 'lambda_h': 0.10, 'lambda_tau': 0.50, 'alpha_h': 0.06,\n         'alpha_tau': 0.02, 'beta_tau': 0.50, 'beta_T': 0.80, 'gamma_sw': 0.03},\n    ]\n\n    all_results = []\n    \n    for params in test_cases:\n        # Unpack parameters\n        lt, lh, ltau = params['lambda_T'], params['lambda_h'], params['lambda_tau']\n        ah, atau = params['alpha_h'], params['alpha_tau']\n        btau, bT = params['beta_tau'], params['beta_T']\n        gsw = params['gamma_sw']\n\n        # Construct the matrix A\n        A = np.array([\n            [-(lt - gsw), ah, atau],\n            [0, -lh, btau],\n            [bT, 0, -ltau]\n        ], dtype=float)\n\n        # Compute eigenvalues and right eigenvectors\n        eigenvalues, eigenvectors = np.linalg.eig(A)\n\n        # Find the index of the leading mode\n        # Sort by real part (desc), then by abs(imag part) (desc) for tie-breaking\n        sorted_indices = np.lexsort((-np.abs(np.imag(eigenvalues)), \n                                     -np.real(eigenvalues)))\n        lead_idx = sorted_indices[0]\n        \n        lambda_max = eigenvalues[lead_idx]\n        v_lead = eigenvectors[:, lead_idx]\n        \n        # Calculate growth rate and period\n        sigma = np.real(lambda_max)\n        omega = np.imag(lambda_max)\n        \n        period_threshold = 1e-8\n        period = 2 * np.pi / np.abs(omega) if np.abs(omega) > period_threshold else 0.0\n\n        # Extract eigenvector components\n        v_T, v_h, v_tau = v_lead[0], v_lead[1], v_lead[2]\n\n        # Handle normalization and calculate ratios\n        # Normalization is implicitly handled by ratios being scale-invariant.\n        # The key is to avoid division by zero.\n        v_T_denominator = v_T\n        if np.abs(v_T_denominator) < 1e-12:\n            # Per problem spec, apply perturbation in fallback case\n            v_T_denominator += 1j * 1e-12\n        \n        r_h = v_h / v_T_denominator\n        r_tau = v_tau / v_T_denominator\n\n        # Calculate amplitudes and phases for the ratios\n        amp_h = np.abs(r_h)\n        phase_h = np.angle(r_h)\n        amp_tau = np.abs(r_tau)\n        phase_tau = np.angle(r_tau)\n\n        # Store the six required quantities\n        case_results = [sigma, period, amp_h, phase_h, amp_tau, phase_tau]\n        all_results.append(case_results)\n\n    # Format the final output string exactly as required\n    output_str = \"[\" + \",\".join([f\"[{','.join(map(str, r))}]\" for r in all_results]) + \"]\"\n    print(output_str)\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}