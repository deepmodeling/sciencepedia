{
    "hands_on_practices": [
        {
            "introduction": "这项实践旨在阐明海岸上升流的核心物理机制。通过构建一个理想化的控制体模型，我们将从质量守恒定律出发，推导沿岸风应力 $\\boldsymbol{\\tau}$ 所驱动的离岸埃克曼输送如何导致垂向速度 $w$ 的产生。此练习不仅量化了上升流的强度，还揭示了其强度如何随纬度（即科里奥利参数 $f$）变化，这是理解全球上升流系统地理分布的关键。",
            "id": "4024714",
            "problem": "在北半球，一条笔直的东部边界海岸线受到稳定、空间均匀、沿岸向赤道的风应力作用，引发了海岸上升流。考虑一个角速度为 $\\Omega$ 的旋转地球上的海洋表层，该层由静水、Boussinesq 原始方程控制，并作如下假设：\n- 稳态且沿岸方向水平均匀的强迫，\n- 纬度 $\\phi$ 处的科里奥利参数为 $f(\\phi)=2\\Omega \\sin\\phi$，\n- 一个恒定的参考密度 $\\rho$，\n- 一个摩擦表面埃克曼层，其垂直积分的动量平衡主要由科里奥利力和湍流应力散度决定，\n- 三维速度场满足不可压缩性和连续性。\n\n将宽度为 $L$ 的跨岸海岸带视为一个控制体积，其中风生、深度积分的离岸埃克曼输运必须通过质量守恒与海岸处的平均垂直速度 $w$ 相平衡。从旋转坐标系下的动量方程和连续性方程出发，推导上升流速度 $w$ 关于所施加的风应力大小 $\\tau$、密度 $\\rho$、科里奥利参数 $f(\\phi)$ 以及跨岸尺度 $L$ 的主阶表达式。然后，使用你推导的表达式和给定的科里奥利参数 $f(\\phi)=2\\Omega \\sin\\phi$，在以下固定参数下计算 $\\phi=15^\\circ$、$\\phi=30^\\circ$ 和 $\\phi=45^\\circ$ 时的 $w$：\n- $\\tau = 0.12$ 牛顿每平方米，\n- $\\rho = 1025$ 千克每立方米，\n- $L = 1.00 \\times 10^{5}$ 米，\n- $\\Omega = 7.2921159 \\times 10^{-5}$ 弧度每秒。\n\n将 $w$ 解释为正值表示向上运动（上升流）。将 $w$ 的三个值均以米每秒为单位表示，并将最终数值答案四舍五入至四位有效数字。",
            "solution": "#### 1. 上升流速度 $w$ 的推导\n\n首先，我们建立一个坐标系并推导风生埃克曼输运。我们定义一个右手笛卡尔坐标系，其中 $y$ 轴与海岸线对齐（向北为正），$x$ 轴指向东方（离岸）。东部边界海岸线位于 $x=0$ 处，海洋区域在 $x < 0$ 的范围内。$z$ 轴从平均海平面 $z=0$ 处垂直向上。\n\n在北半球，科里奥利参数 $f > 0$。风应力是“沿岸向赤道的”，在我们的坐标系中对应于负 $y$ 方向。因此，表面风应力矢量为 $\\vec{\\tau} = (0, -\\tau, 0)$，其分量为 $\\tau_x = 0$ 和 $\\tau_y = -\\tau$（其中 $\\tau$ 是风应力大小）。\n\n在表面埃克曼层中，简化的稳态单位质量动量方程为：\n$$ -f v = \\frac{1}{\\rho} \\frac{\\partial \\tau_{zx}}{\\partial z} $$\n$$ f u = \\frac{1}{\\rho} \\frac{\\partial \\tau_{zy}}{\\partial z} $$\n其中 $(u, v)$ 是水平速度分量，$\\rho$ 是恒定的参考密度。\n\n我们将这些方程沿埃克曼层的深度进行垂直积分，从其底部 $z=-D_E$（此处应力为零）到海面 $z=0$（此处应力等于风应力）。纬向（跨岸）和经向（沿岸）单位长度的埃克曼体积输运分别为 $U_{Ek} = \\int_{-D_E}^{0} u \\, dz$ 和 $V_{Ek} = \\int_{-D_E}^{0} v \\, dz$。积分后得到：\n$$ -f V_{Ek} = \\frac{\\tau_x}{\\rho} \\implies V_{Ek} = -\\frac{\\tau_x}{\\rho f} $$\n$$ f U_{Ek} = \\frac{\\tau_y}{\\rho} \\implies U_{Ek} = \\frac{\\tau_y}{\\rho f} $$\n\n对于本问题，$\\tau_x = 0$ 和 $\\tau_y = -\\tau$。因此埃克曼输运为：\n$$ V_{Ek} = 0 $$\n$$ U_{Ek} = -\\frac{\\tau}{\\rho f} $$\n结果 $U_{Ek} < 0$ 表示输运方向为负 $x$ 方向（向西）。对于东部边界，这是一种离岸输运，将表层水从海岸移开。\n\n接下来，我们将质量守恒（连续性）原理应用于一个宽度为 $L$ 的控制体积。不可压缩流体的连续性方程是 $\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} + \\frac{\\partial w}{\\partial z} = 0$。根据沿岸均匀性的假设，$\\frac{\\partial v}{\\partial y} = 0$。对控制体积进行积分并应用边界条件（海岸处水平速度为零，海面处垂直速度为零），可以得到埃克曼层底部的总向上体积通量必须平衡总的离岸体积输运。\n\n总离岸体积输运为 $|U_{Ek}| \\times (\\text{沿岸长度})$。总向上体积通量为 $w \\times L \\times (\\text{沿岸长度})$。因此，质量平衡要求 $w L = |U_{Ek}| = \\frac{\\tau}{\\rho f}$。\n解出平均上升流速度 $w$：\n$$ w = \\frac{\\tau}{\\rho f L} $$\n代入科里奥利参数的表达式 $f = 2\\Omega\\sin\\phi$：\n$$ w(\\phi) = \\frac{\\tau}{\\rho (2\\Omega \\sin\\phi) L} $$\n此表达式为正值，与上升流的约定一致。\n\n#### 2. 数值计算\n\n给定以下值：\n$\\tau = 0.12$ N/m$^2$\n$\\rho = 1025$ kg/m$^3$\n$L = 1.00 \\times 10^5$ m\n$\\Omega = 7.2921159 \\times 10^{-5}$ rad/s\n\n我们计算三个不同纬度下的 $w$：$\\phi = 15^\\circ$、$\\phi = 30^\\circ$ 和 $\\phi = 45^\\circ$。\n首先计算常数部分：\n$$ C = \\frac{\\tau}{2 \\rho \\Omega L} = \\frac{0.12}{2 \\times 1025 \\times (7.2921159 \\times 10^{-5}) \\times (1.00 \\times 10^5)} $$\n$$ C \\approx \\frac{0.12}{14948.8376} \\approx 8.027359 \\times 10^{-6} \\, \\text{m/s} $$\n然后计算每个纬度下的 $w$：\n$$ w(\\phi) = \\frac{C}{\\sin\\phi} $$\n- 对于 $\\phi = 15^\\circ$：\n$$ w(15^\\circ) = \\frac{8.027359 \\times 10^{-6}}{\\sin(15^\\circ)} \\approx \\frac{8.027359 \\times 10^{-6}}{0.258819} \\approx 3.10149 \\times 10^{-5} \\, \\text{m/s} $$\n四舍五入到四位有效数字，$w(15^\\circ) = 3.101 \\times 10^{-5}$ m/s。\n\n- 对于 $\\phi = 30^\\circ$：\n$$ w(30^\\circ) = \\frac{8.027359 \\times 10^{-6}}{\\sin(30^\\circ)} = \\frac{8.027359 \\times 10^{-6}}{0.5} = 1.60547 \\times 10^{-5} \\, \\text{m/s} $$\n四舍五入到四位有效数字，$w(30^\\circ) = 1.605 \\times 10^{-5}$ m/s。\n\n- 对于 $\\phi = 45^\\circ$：\n$$ w(45^\\circ) = \\frac{8.027359 \\times 10^{-6}}{\\sin(45^\\circ)} \\approx \\frac{8.027359 \\times 10^{-6}}{0.707107} \\approx 1.13524 \\times 10^{-5} \\, \\text{m/s} $$\n四舍五入到四位有效数字，$w(45^\\circ) = 1.135 \\times 10^{-5}$ m/s。\n\n这些结果表明，在风应力恒定的情况下，上升流速度在科里奥利参数较弱的低纬度地区更强，这与推导出的公式 $w \\propto 1/f$ 一致。其量级约为每天1-3米，是海岸上升流系统的典型值。",
            "answer": "$$\\boxed{\\begin{pmatrix} 3.101 \\times 10^{-5} & 1.605 \\times 10^{-5} & 1.135 \\times 10^{-5} \\end{pmatrix}}$$"
        },
        {
            "introduction": "为了深入理解风生环流，我们必须掌握埃克曼输送的本质，这是前一练习的基础。本实践将引导你从定常流体动量方程出发，通过对整个埃克曼层进行垂向积分，严格推导出总输送量 $\\boldsymbol{M}_{E}$ 与表面风应力 $\\boldsymbol{\\tau}$ 之间的关系。通过计算南半球的特定情况，你将亲身体验科里奥利参数 $f$ 的符号如何决定输送方向，这是区分南北半球风生环流的关键。",
            "id": "4024758",
            "problem": "在纬度 $\\phi=-30^{\\circ}$ 处，一个理想化的、水平均匀的开放大洋水柱受到空间均匀的表面风应力的驱动。假设存在一个经典的定常埃克曼层，在埃克曼动量平衡中水平压力梯度可忽略不计，且湍流应力在埃克曼层底部消失。海水密度为 $\\rho=1025\\,\\mathrm{kg\\,m^{-3}}$，科里奥利参数为 $f=-7.27\\times 10^{-5}\\,\\mathrm{s^{-1}}$。施加一个均匀的、纯纬向的、向东的表面风应力 $\\boldsymbol{\\tau}=\\tau_{0}\\,\\hat{\\boldsymbol{i}}$，其中 $\\tau_{0}=0.15\\,\\mathrm{N\\,m^{-2}}$。\n\n从将作用在垂直积分埃克曼速度上的科里奥利力与湍流应力的垂直散度联系起来的定常、垂直积分的动量平衡方程出发，推导出用 $\\boldsymbol{\\tau}$、$\\rho$ 和 $f$ 表示的垂直积分埃克曼输送矢量 $\\boldsymbol{M}_{E}=\\int_{-\\infty}^{0}\\rho\\boldsymbol{u}_{E}\\,\\mathrm{d}z$，过程中不得引用任何现成的埃克曼输送公式。请仔细说明在垂直积分中使用的边界条件。（注：$\\boldsymbol{M}_{E}$ 为质量输运）。\n\n然后，对于给定的 $\\boldsymbol{\\tau}$ 和 $\\phi=-30^{\\circ}$，计算埃克曼质量输运的带符号经向分量 $M_{E,y}$（取向北为正）。最终答案以 $\\mathrm{kg\\,m^{-1}\\,s^{-1}}$ 为单位表示，并四舍五入到四位有效数字。",
            "solution": "#### 1. 埃克曼输运矢量的推导\n\n我们的目标是从埃克曼层的基本动量平衡方程出发，推导垂直积分的埃克曼质量输送矢量 $\\boldsymbol{M}_{E}$。假设条件为：定常状态、水平均匀性以及可忽略的水平压力梯度。\n\n在旋转坐标系中，埃克曼层的动量方程由科里奥利力与湍流应力垂直散度之间的平衡给出。在一个标准笛卡尔坐标系中（$\\hat{\\boldsymbol{i}}$ 指向东，$\\hat{\\boldsymbol{j}}$ 指向北，$\\hat{\\boldsymbol{k}}$ 垂直向上），动量平衡的矢量形式为：\n$$\nf \\hat{\\boldsymbol{k}} \\times \\boldsymbol{u}_{E} = \\frac{1}{\\rho} \\frac{\\partial \\boldsymbol{\\tau}}{\\partial z}\n$$\n其中 $\\boldsymbol{u}_{E}(z)$ 是水平埃克曼速度矢量，$f$ 是科里奥利参数，$\\rho$ 是海水密度（假定为常数），$\\boldsymbol{\\tau}(z)$ 是湍流应力矢量。\n\n埃克曼质量输运矢量 $\\boldsymbol{M}_{E}$ 定义为 $\\rho \\boldsymbol{u}_{E}$ 在埃克曼层深度上的垂直积分。我们将动量方程乘以 $\\rho$ 并从深层（$z \\to -\\infty$，湍流应力为零）积分到海面（$z=0$）：\n$$\n\\int_{-\\infty}^{0} \\left( \\rho f \\hat{\\boldsymbol{k}} \\times \\boldsymbol{u}_{E} \\right) \\mathrm{d}z = \\int_{-\\infty}^{0} \\frac{\\partial \\boldsymbol{\\tau}}{\\partial z} \\mathrm{d}z\n$$\n假设 $f$ 和 $\\rho$ 在埃克曼层内随深度为常数，可以将它们移到左侧积分符号之外：\n$$\nf \\hat{\\boldsymbol{k}} \\times \\left( \\int_{-\\infty}^{0} \\rho \\boldsymbol{u}_{E} \\, \\mathrm{d}z \\right) = \\int_{-\\infty}^{0} \\frac{\\partial \\boldsymbol{\\tau}}{\\partial z} \\, \\mathrm{d}z\n$$\n根据定义，$\\boldsymbol{M}_{E} = \\int_{-\\infty}^{0} \\rho \\boldsymbol{u}_{E} \\, \\mathrm{d}z$。右侧的积分可以使用微积分基本定理进行计算：\n$$\nf \\hat{\\boldsymbol{k}} \\times \\boldsymbol{M}_{E} = \\left[ \\boldsymbol{\\tau}(z) \\right]_{-\\infty}^{0} = \\boldsymbol{\\tau}(0) - \\boldsymbol{\\tau}(-\\infty)\n$$\n我们应用边界条件：\n1.  在海面（$z=0$），湍流应力等于表面风应力，即 $\\boldsymbol{\\tau}(0) = \\boldsymbol{\\tau}_{\\text{wind}}$。\n2.  在埃克曼层底部（$z \\to -\\infty$），湍流应力消失，即 $\\boldsymbol{\\tau}(-\\infty) = \\mathbf{0}$。\n\n代入边界条件，得到：\n$$\nf \\hat{\\boldsymbol{k}} \\times \\boldsymbol{M}_{E} = \\boldsymbol{\\tau}_{\\text{wind}}\n$$\n为了求解 $\\boldsymbol{M}_{E}$，我们用单位矢量 $\\hat{\\boldsymbol{k}}$ 从左侧与该方程作叉积，并使用矢量三重积恒等式 $\\boldsymbol{a} \\times (\\boldsymbol{b} \\times \\boldsymbol{c}) = \\boldsymbol{b}(\\boldsymbol{a} \\cdot \\boldsymbol{c}) - \\boldsymbol{c}(\\boldsymbol{a} \\cdot \\boldsymbol{b})$：\n$$\nf \\left( \\hat{\\boldsymbol{k}} \\times (\\hat{\\boldsymbol{k}} \\times \\boldsymbol{M}_{E}) \\right) = \\hat{\\boldsymbol{k}} \\times \\boldsymbol{\\tau}_{\\text{wind}}\n$$\n$$\nf \\left( \\hat{\\boldsymbol{k}}(\\hat{\\boldsymbol{k}} \\cdot \\boldsymbol{M}_{E}) - \\boldsymbol{M}_{E}(\\hat{\\boldsymbol{k}} \\cdot \\hat{\\boldsymbol{k}}) \\right) = \\hat{\\boldsymbol{k}} \\times \\boldsymbol{\\tau}_{\\text{wind}}\n$$\n由于 $\\boldsymbol{M}_{E}$ 是水平矢量，$\\hat{\\boldsymbol{k}} \\cdot \\boldsymbol{M}_{E} = 0$。同时 $\\hat{\\boldsymbol{k}} \\cdot \\hat{\\boldsymbol{k}} = 1$。代入这些结果：\n$$\n-f \\boldsymbol{M}_{E} = \\hat{\\boldsymbol{k}} \\times \\boldsymbol{\\tau}_{\\text{wind}}\n$$\n分离出 $\\boldsymbol{M}_{E}$ 得到埃克曼质量输送矢量的表达式：\n$$\n\\boldsymbol{M}_{E} = -\\frac{1}{f} (\\hat{\\boldsymbol{k}} \\times \\boldsymbol{\\tau}_{\\text{wind}}) = \\frac{1}{f} (\\boldsymbol{\\tau}_{\\text{wind}} \\times \\hat{\\boldsymbol{k}})\n$$\n推导完成。\n\n#### 2. 经向分量 $M_{E,y}$ 的计算\n\n接下来计算埃克曼质量输运的经向（向北）分量 $M_{E,y}$。首先计算叉积 $\\boldsymbol{\\tau}_{\\text{wind}} \\times \\hat{\\boldsymbol{k}}$。给定风应力 $\\boldsymbol{\\tau}_{\\text{wind}} = \\tau_{x} \\hat{\\boldsymbol{i}} + \\tau_{y} \\hat{\\boldsymbol{j}}$：\n$$\n\\boldsymbol{\\tau}_{\\text{wind}} \\times \\hat{\\boldsymbol{k}} = (\\tau_{x} \\hat{\\boldsymbol{i}} + \\tau_{y} \\hat{\\boldsymbol{j}}) \\times \\hat{\\boldsymbol{k}} = \\tau_{x} (\\hat{\\boldsymbol{i}} \\times \\hat{\\boldsymbol{k}}) + \\tau_{y} (\\hat{\\boldsymbol{j}} \\times \\hat{\\boldsymbol{k}}) = \\tau_{x} (-\\hat{\\boldsymbol{j}}) + \\tau_{y} (\\hat{\\boldsymbol{i}}) = \\tau_{y} \\hat{\\boldsymbol{i}} - \\tau_{x} \\hat{\\boldsymbol{j}}\n$$\n代入 $\\boldsymbol{M}_{E}$ 的表达式中：\n$$\n\\boldsymbol{M}_{E} = M_{E,x} \\hat{\\boldsymbol{i}} + M_{E,y} \\hat{\\boldsymbol{j}} = \\frac{1}{f} (\\tau_{y} \\hat{\\boldsymbol{i}} - \\tau_{x} \\hat{\\boldsymbol{j}})\n$$\n通过比较分量，我们发现经向分量是：\n$$\nM_{E,y} = -\\frac{\\tau_{x}}{f}\n$$\n题目提供了以下数值：\n-   一个纯纬向的、向东的表面风应力：$\\boldsymbol{\\tau}_{\\text{wind}} = \\tau_{0}\\,\\hat{\\boldsymbol{i}}$，这意味着纬向分量为 $\\tau_x = \\tau_0 = 0.15\\,\\mathrm{N\\,m^{-2}}$，经向分量为 $\\tau_y = 0$。\n-   纬度 $\\phi=-30^{\\circ}$ 处的科里奥利参数：$f = -7.27 \\times 10^{-5}\\,\\mathrm{s}^{-1}$。\n\n我们将这些数值代入 $M_{E,y}$ 的表达式中：\n$$\nM_{E,y} = -\\frac{0.15\\,\\mathrm{N\\,m^{-2}}}{-7.27 \\times 10^{-5}\\,\\mathrm{s}^{-1}}\n$$\n两个负号相消，得到一个正的（向北的）输送：\n$$\nM_{E,y} = \\frac{0.15}{7.27 \\times 10^{-5}} \\,\\mathrm{kg\\,m^{-1}\\,s^{-1}} \\approx 2063.2737 \\,\\mathrm{kg\\,m^{-1}\\,s^{-1}}\n$$\n按要求将结果四舍五入到四位有效数字：\n$$\nM_{E,y} \\approx 2063\\,\\mathrm{kg\\,m^{-1}\\,s^{-1}}\n$$\n正号表示经向质量输送是向北的。这与南半球（$f<0$）净水输送方向在风向左侧的预期相符。对于东风，这对应于向北的输送。",
            "answer": "$$\\boxed{2063}$$"
        },
        {
            "introduction": "物理定律在数值天气预报和气候模型中是通过离散化的方程组来体现的。本实践将理论付诸于计算，要求你为一个理想化的海洋盆地构建并测试一个数值模型。你将使用有限差分法来计算由空间变化的​​风应力旋度（$\\nabla \\times \\boldsymbol{\\tau}$）引起的埃克曼抽吸/抽压（$w_E$），并通过与已知的解析解进行比较，系统地评估数值解的收敛性和精度。",
            "id": "4024713",
            "problem": "考虑一个沿 $y$ 轴排列的理想化平直海岸线，海洋占据 $x \\ge 0$ 的半空间。假设一个具有恒定科里奥利参数 $f$、恒定海水密度 $\\rho$ 的 $f$ 平面，以及一个产生海岸上升流和开阔海洋下降流的给定风应力场。研究区域在横跨海岸方向 $x \\in [0, L]$ 上是一维的，海岸线位于 $x = 0$。\n\n基本原理：在一个 $f$ 平面上，稳态、垂直积分的动量平衡中，埃克曼层底部的垂直速度（埃克曼抽吸/抽压）由下式给出\n$$\nw_E(x) \\;=\\; \\frac{1}{\\rho f}\\left(\\frac{\\partial \\tau_y}{\\partial x} - \\frac{\\partial \\tau_x}{\\partial y}\\right),\n$$\n其中 $\\tau_x$ 和 $\\tau_y$ 分别是风应力的 $x$ 和 $y$ 分量，$\\rho$ 是海水密度。正值的 $w_E$ 表示上升流。\n\n规定沿岸风应力为\n$$\n\\tau_y(x) \\;=\\; \\tau_0 \\left(1 - e^{-x/L_r}\\right),\n$$\n其中 $\\tau_0 > 0$ 为常数振幅，$L_r > 0$ 为海岸斜坡长度尺度。规定一个恒定的大尺度纬向风应力的经向梯度，\n$$\n\\frac{\\partial \\tau_x}{\\partial y} \\;=\\; C,\n$$\n其中 $C > 0$ 代表一个导致开阔海洋下降流的背景趋势。由这些规定所蕴含的精确埃克曼垂直速度为\n$$\nw_{\\text{exact}}(x) \\;=\\; \\frac{1}{\\rho f}\\left(\\frac{\\tau_0}{L_r}e^{-x/L_r} - C\\right).\n$$\n速度为零点的位置 $x_0$（即 $w_{\\text{exact}}(x_0) = 0$）为\n$$\nx_0 \\;=\\; -L_r \\,\\ln\\!\\left(\\frac{C L_r}{\\tau_0}\\right),\n$$\n条件是 $0 < \\frac{C L_r}{\\tau_0} < 1$。\n\n数值任务：使用均匀间隔的网格点 $x_i = i\\,\\Delta x$（$i = 0, 1, \\dots, N$）对区间 $[0, L]$ 进行离散化，其中 $N = L/\\Delta x$ 是一个整数，$\\Delta x$ 是网格间距。使用二阶精度的有限差分格式近似 $\\frac{\\partial \\tau_y}{\\partial x}$：\n- 在海岸线处（$i = 0$），使用单边前向差分公式\n$$\n\\left.\\frac{\\partial \\tau_y}{\\partial x}\\right|_{x_0} \\approx \\frac{-3\\,\\tau_y(x_0) + 4\\,\\tau_y(x_1) - \\tau_y(x_2)}{2\\,\\Delta x}.\n$$\n- 在内部点处（$i = 1, 2, \\dots, N-1$），使用中心差分公式\n$$\n\\left.\\frac{\\partial \\tau_y}{\\partial x}\\right|_{x_i} \\approx \\frac{\\tau_y(x_{i+1}) - \\tau_y(x_{i-1})}{2\\,\\Delta x}.\n$$\n- 在离岸边界处（$i = N$），使用单边后向差分公式\n$$\n\\left.\\frac{\\partial \\tau_y}{\\partial x}\\right|_{x_N} \\approx \\frac{3\\,\\tau_y(x_N) - 4\\,\\tau_y(x_{N-1}) + \\tau_y(x_{N-2})}{2\\,\\Delta x}.\n$$\n\n计算离散的埃克曼垂直速度\n$$\nw_{\\text{num}}(x_i) \\;=\\; \\frac{1}{\\rho f}\\left(\\left.\\frac{\\partial \\tau_y}{\\partial x}\\right|_{x_i} - C\\right).\n$$\n\n评估指标：\n1. 海岸上升流收敛性：比较 $w_{\\text{num}}(0)$ 与 $w_{\\text{exact}}(0)$，并报告绝对相对误差\n$$\nE_w(\\Delta x) \\;=\\; \\left|\\frac{w_{\\text{num}}(0) - w_{\\text{exact}}(0)}{w_{\\text{exact}}(0)}\\right|,\n$$\n该误差是无量纲的（一个小数）。\n2. 零点位置收敛性：通过找到第一个满足 $w_{\\text{num}}(x_i) > 0$ 和 $w_{\\text{num}}(x_{i+1}) < 0$ 的索引 $i$，并进行线性插值来估计数值零点位置 $x_{0,\\text{num}}$：\n$$\nx_{0,\\text{num}} \\;=\\; x_i + \\Delta x \\,\\frac{w_{\\text{num}}(x_i)}{w_{\\text{num}}(x_i) - w_{\\text{num}}(x_{i+1})}.\n$$\n报告绝对误差\n$$\nE_x(\\Delta x) \\;=\\; \\left|x_{0,\\text{num}} - x_0\\right|,\n$$\n以米为单位表示。\n\n常数和测试套件：\n- $\\rho = 1025\\,\\mathrm{kg/m^3}$，\n- $f = 1.0\\times 10^{-4}\\,\\mathrm{s^{-1}}$，\n- $\\tau_0 = 0.2\\,\\mathrm{N/m^2}$，\n- $L_r = 50\\,\\mathrm{km}$，\n- $C = 2.0\\times 10^{-7}\\,\\mathrm{N/m^3}$，\n- $L = 400\\,\\mathrm{km}$，\n- 网格间距 $\\Delta x \\in \\{20\\,\\mathrm{km}, 10\\,\\mathrm{km}, 5\\,\\mathrm{km}, 2\\,\\mathrm{km}\\}$。\n\n单位：\n- 如果中间计算需要，垂直速度以 $\\mathrm{m/s}$ 报告，但海岸上升流误差 $E_w(\\Delta x)$ 必须是无量纲的（小数）。\n- 零点位置绝对误差 $E_x(\\Delta x)$ 以米报告。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含八个用逗号分隔的浮点数，并用方括号括起来，按网格分辨率递增的顺序排列为\n$$\n[E_w(20\\,\\mathrm{km}),\\,E_x(20\\,\\mathrm{km}),\\,E_w(10\\,\\mathrm{km}),\\,E_x(10\\,\\mathrm{km}),\\,E_w(5\\,\\mathrm{km}),\\,E_x(5\\,\\mathrm{km}),\\,E_w(2\\,\\mathrm{km}),\\,E_x(2\\,\\mathrm{km})].\n$$\n确保区域离散化使用指定的有限差分公式。答案必须是自包含的，并且能够根据给定的常数运行，无需任何用户输入。",
            "solution": "该问题是物理海洋学领域一个适定的数值分析任务。它要求评估一个用于海岸上升流和开阔海洋下降流简化模型的有限差分近似的准确性。该问题在科学上是合理的，在数学上是一致的，并且所有必要的参数和过程都已明确定义。\n\n解决方法包括为四个系列的网格分辨率实施指定的数值方案，并为每个分辨率计算两个不同的误差指标。过程如下：\n\n**1. 物理常数和参数的定义**\n所有物理量都转换为并始终使用国际单位制（S.I. units）。\n- 海水密度: $\\rho = 1025\\,\\mathrm{kg/m^3}$\n- 科里奥利参数: $f = 1.0 \\times 10^{-4}\\,\\mathrm{s^{-1}}$\n- 风应力振幅: $\\tau_0 = 0.2\\,\\mathrm{N/m^2}$\n- 海岸斜坡长度尺度: $L_r = 50\\,\\mathrm{km} = 5 \\times 10^4\\,\\mathrm{m}$\n- 背景风应力旋度贡献: $C = 2.0 \\times 10^{-7}\\,\\mathrm{N/m^3}$\n- 区域长度: $L = 400\\,\\mathrm{km} = 4 \\times 10^5\\,\\mathrm{m}$\n- 测试套件的网格间距: $\\Delta x \\in \\{20000, 10000, 5000, 2000\\}\\,\\mathrm{m}$\n\n**2. 精确解析解的计算**\n海岸上升流速度和零点位置的解析解与数值离散化无关，因此只需计算一次。\nEkman 层底部的精确垂直速度由函数 $w_{\\text{exact}}(x) = \\frac{1}{\\rho f}\\left(\\frac{\\tau_0}{L_r}e^{-x/L_r} - C\\right)$ 给出。\n在海岸线处，即 $x=0$ 时，精确的上升流速度为：\n$$\nw_{\\text{exact}}(0) = \\frac{1}{\\rho f}\\left(\\frac{\\tau_0}{L_r} - C\\right)\n$$\n上升流转变为下降流的精确零点位置 $x_0$（即 $w_{\\text{exact}}(x_0) = 0$）由以下方程导出：\n$$\n\\frac{\\tau_0}{L_r}e^{-x_0/L_r} - C = 0 \\implies x_0 = -L_r \\ln\\left(\\frac{C L_r}{\\tau_0}\\right)\n$$\n一个物理上有意义的（实数且为正）$x_0$ 的条件是 $0 < \\frac{C L_r}{\\tau_0} < 1$。代入给定值，我们发现 $\\frac{(2.0 \\times 10^{-7}\\,\\mathrm{N/m^3}) (5 \\times 10^4\\,\\mathrm{m})}{0.2\\,\\mathrm{N/m^2}} = 0.05$，该值满足条件。\n\n**3. 迭代数值模拟和误差分析**\n对四个指定的网格间距 $\\Delta x$ 执行一个循环。对于每个 $\\Delta x$：\n\n**a. 网格生成**\n在区域 $[0, L]$ 上构建一个一维计算网格，由坐标数组 $x_i$ 表示。网格点定义为 $x_i = i\\,\\Delta x$，其中 $i = 0, 1, \\dots, N$，而 $N = L/\\Delta x$ 是网格单元的整数数量。\n\n**b. 风应力场的离散化**\n在每个离散网格点 $x_i$ 上评估连续的沿岸风应力函数 $\\tau_y(x) = \\tau_0 \\left(1 - e^{-x/L_r}\\right)$，以获得应力值向量 $\\tau_y(x_i)$。\n\n**c. 应力梯度的有限差分近似**\n使用规定的二阶精度有限差分模板，在每个网格点 $x_i$ 上对应力场的空间导数 $\\frac{\\partial \\tau_y}{\\partial x}$ 进行数值近似：\n- 在海岸边界处（$i=0$），应用三点单边前向差分公式。\n- 在区域内部（$i=1, 2, \\dots, N-1$），使用两点中心差分公式。\n- 在离岸边界处（$i=N$），应用三点单边后向差分公式。\n\n**d. 数值垂直速度的计算**\n利用导数的数值近似，计算所有 $i = 0, \\dots, N$ 处的离散埃克曼垂直速度场 $w_{\\text{num}}(x_i)$：\n$$\nw_{\\text{num}}(x_i) = \\frac{1}{\\rho f}\\left(\\left.\\frac{\\partial \\tau_y}{\\partial x}\\right|_{x_i} - C\\right)\n$$\n\n**4. 评估指标的计算**\n对于每个网格分辨率，计算两个指定的误差指标。\n\n**a. 海岸上升流相对误差，$E_w(\\Delta x)$**\n该指标量化了海岸处数值速度的准确性。它是数值 $w_{\\text{num}}(0)$ 和解析值 $w_{\\text{exact}}(0)$ 之间的绝对相对误差。\n$$\nE_w(\\Delta x) = \\left|\\frac{w_{\\text{num}}(0) - w_{\\text{exact}}(0)}{w_{\\text{exact}}(0)}\\right|\n$$\n\n**b. 零点位置绝对误差，$E_x(\\Delta x)$**\n该指标量化了上升流-下降流转换位置的准确性。首先，找到网格索引 $i$ 使得 $w_{\\text{num}}(x_i) > 0$ 且 $w_{\\text{num}}(x_{i+1}) < 0$。然后通过在点 $(x_i, w_{\\text{num}}(x_i))$ 和 $(x_{i+1}, w_{\\text{num}}(x_{i+1}))$ 之间进行线性插值来估计数值零点位置 $x_{0,\\text{num}}$。\n$$\nx_{0,\\text{num}} = x_i + \\Delta x \\,\\frac{w_{\\text{num}}(x_i)}{w_{\\text{num}}(x_i) - w_{\\text{num}}(x_{i+1})}\n$$\n绝对误差是此数值估计与精确位置 $x_0$ 之间差值的绝对值。\n$$\nE_x(\\Delta x) = |x_{0,\\text{num}} - x_0|\n$$\n\n**5. 最终输出生成**\n将为四个 $\\Delta x$ 值中的每一个计算出的八个误差指标（$E_w$ 和 $E_x$）汇总到一个列表中。然后将此列表格式化为指定的单行逗号分隔浮点数字符串并打印。该实现使用 `numpy` 库进行高效的向量和数组计算。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes numerical errors for a 1D coastal upwelling model.\n\n    This function solves the problem as stated, calculating the absolute relative error\n    of the coastal upwelling velocity and the absolute error of the zero-crossing location\n    for four different grid resolutions.\n    \"\"\"\n    # Define physical constants and parameters in S.I. units.\n    RHO = 1025.0         # Seawater density (kg/m^3)\n    F_CORIOLIS = 1.0e-4  # Coriolis parameter (s^-1)\n    TAU0 = 0.2           # Wind stress amplitude (N/m^2)\n    LR = 50000.0         # Coastal ramp length scale (m)\n    C_GRAD = 2.0e-7      # Background stress gradient (N/m^3)\n    L_DOMAIN = 400000.0  # Domain length (m)\n\n    # Test suite of grid spacings in kilometers.\n    dx_values_km = [20.0, 10.0, 5.0, 2.0]\n\n    # --- Step 1: Calculate exact analytical solutions ---\n    # These are constant for all test cases.\n    \n    # Exact vertical velocity at the coast (x=0)\n    w_exact_0 = (TAU0 / LR - C_GRAD) / (RHO * F_CORIOLIS)\n    \n    # Exact zero-crossing location x0 where w_exact(x0) = 0\n    x0_exact = -LR * np.log(C_GRAD * LR / TAU0)\n\n    results = []\n\n    # --- Step 2: Loop over each grid resolution ---\n    for dx_km in dx_values_km:\n        dx_m = dx_km * 1000.0\n        n_cells = int(L_DOMAIN / dx_m)\n        n_points = n_cells + 1\n\n        # a. Generate the computational grid\n        x_grid = np.linspace(0.0, L_DOMAIN, n_points)\n\n        # b. Evaluate the wind stress tau_y on the grid\n        tau_y_grid = TAU0 * (1.0 - np.exp(-x_grid / LR))\n\n        # c. Approximate the derivative d(tau_y)/dx using finite differences\n        dtau_y_dx = np.zeros(n_points)\n\n        if n_points < 3:\n            raise ValueError(\"Grid resolution is too coarse for the 3-point stencils.\")\n\n        # At the coastline (i=0), use the forward difference formula\n        dtau_y_dx[0] = (-3.0 * tau_y_grid[0] + 4.0 * tau_y_grid[1] - tau_y_grid[2]) / (2.0 * dx_m)\n\n        # At the offshore boundary (i=N), use the backward difference formula\n        dtau_y_dx[n_cells] = (3.0 * tau_y_grid[n_cells] - 4.0 * tau_y_grid[n_cells - 1] + tau_y_grid[n_cells - 2]) / (2.0 * dx_m)\n\n        # At interior points (i=1,...,N-1), use the central difference formula\n        dtau_y_dx[1:n_cells] = (tau_y_grid[2:n_points] - tau_y_grid[0:n_cells - 1]) / (2.0 * dx_m)\n\n        # d. Compute the numerical vertical velocity w_num\n        w_num_grid = (dtau_y_dx - C_GRAD) / (RHO * F_CORIOLIS)\n\n        # --- Step 3: Calculate the evaluation metrics ---\n\n        # Metric 1: Coastal upwelling convergence, E_w(dx)\n        w_num_0 = w_num_grid[0]\n        e_w = np.abs((w_num_0 - w_exact_0) / w_exact_0)\n\n        # Metric 2: Zero-crossing convergence, E_x(dx)\n        # Find the first index 'i' where w_num > 0 and w_num[i+1] < 0\n        try:\n            # np.where returns a tuple of arrays; we need the first element of the first array.\n            i_cross = np.where((w_num_grid[:-1] > 0) & (w_num_grid[1:] < 0))[0][0]\n        except IndexError:\n            raise ValueError(f\"Zero-crossing not found for dx = {dx_km} km. \"\n                             \"The numerical velocity does not change sign.\")\n\n        # Perform linear interpolation to find the numerical zero crossing x0_num\n        x_i = x_grid[i_cross]\n        w_i = w_num_grid[i_cross]\n        w_i_plus_1 = w_num_grid[i_cross + 1]\n        \n        x0_num = x_i + dx_m * w_i / (w_i - w_i_plus_1)\n\n        e_x = np.abs(x0_num - x0_exact)\n\n        results.extend([e_w, e_x])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}