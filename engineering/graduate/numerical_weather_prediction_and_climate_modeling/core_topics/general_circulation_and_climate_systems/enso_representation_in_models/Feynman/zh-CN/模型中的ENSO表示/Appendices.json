{
    "hands_on_practices": [
        {
            "introduction": "将复杂的厄尔尼诺-南方涛动（ENSO）现象简化为低阶数学模型，是理解其核心动力学机制的关键一步。本练习将ENSO理想化为一个由海表温度（$T$）和温跃层深度（$h$）异常构成的线性耦合振子系统。通过应用线性系统理论，你可以亲自推导出该系统的固有振荡周期和阻尼率，从而深刻理解ENSO类周期行为的数学基础。",
            "id": "4035502",
            "problem": "厄尔尼诺-南方涛动 (ENSO) 在简化复杂性气候模型中通常被理想化为一个耦合振子，耦合对象是 Niño-3 海表温度异常 $T(t)$ 和赤道太平洋温跃层深度异常 $h(t)$。在一个与异常热量收支和质量连续性一致的线性化表述中，$(T,h)$ 的预报系统为\n$$\\frac{dT}{dt}=a\\,h-b\\,T,\\qquad \\frac{dh}{dt}=-c\\,T-d\\,h,$$\n其中 $a$ 代表海表温度趋势对温跃层异常的敏感性，$b$ 代表净热阻尼，$c$ 代表温跃层趋势对温度异常（通过风应力反馈和波动调整）的敏感性，$d$ 代表净温跃层阻尼。所有系数均为常数。假设数值为 $a=0.6\\ \\mathrm{K\\,m^{-1}\\,month^{-1}}$，$b=0.2\\ \\mathrm{month^{-1}}$，$c=0.1\\ \\mathrm{m\\,K^{-1}\\,month^{-1}}$ 和 $d=0.05\\ \\mathrm{month^{-1}}$。\n\n从应用于常系数常微分方程的线性系统理论的第一性原理出发，推导简正模解，并用它们求出该系统的振荡周期和线性阻尼率。根据特征值的虚部定义振荡周期 $P$ 为 $P=2\\pi/\\omega$，其中 $\\omega$ 是虚部的模，单位为弧度/月；定义阻尼率 $r$ 为正值 $r=-\\Re(\\lambda)$，其中 $\\lambda$ 是系统的一个特征值。将振荡周期和阻尼率四舍五入至四位有效数字。振荡周期以月为单位，阻尼率以 $\\mathrm{month^{-1}}$ 为单位表示。",
            "solution": "### 步骤1：提取已知条件\n问题提供了一个关于厄尔尼诺-南方涛动 (ENSO) 异常（海表温度 $T(t)$ 和温跃层深度 $h(t)$）的两个耦合线性常微分方程组：\n$$\n\\frac{dT}{dt} = a\\,h - b\\,T\n$$\n$$\n\\frac{dh}{dt} = -c\\,T - d\\,h\n$$\n给出的常数系数如下：\n- $a = 0.6\\ \\mathrm{K\\,m^{-1}\\,month^{-1}}$\n- $b = 0.2\\ \\mathrm{month^{-1}}$\n- $c = 0.1\\ \\mathrm{m\\,K^{-1}\\,month^{-1}}$\n- $d = 0.05\\ \\mathrm{month^{-1}}$\n\n问题将振荡周期 $P$ 定义为 $P = 2\\pi/\\omega$，其中 $\\omega$ 是系统特征值虚部的模。\n问题将线性阻尼率 $r$ 定义为 $r = -\\Re(\\lambda)$，其中 $\\lambda$ 是一个特征值。\n最终数值需四舍五入至四位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n1.  **科学依据：** 该模型是一个成熟的简化复杂性模型，用于气候动力学中研究ENSO。它代表了热带太平洋海气相互作用 Underlying physics 的线性化。该表述在科学上是合理的。\n2.  **适定性：** 问题描述了一个线性、常系数、齐次常微分方程组。对于任何给定的初始条件，都存在唯一解。该问题是适定的。\n3.  **客观性：** 问题陈述精确、定量，并且没有主观或模糊的语言。\n4.  **完整性和一致性：** 所有必要的参数（$a, b, c, d$）都以一致的单位给出。例如，在第一个方程中，项 $a\\,h$ 的单位是 $( \\mathrm{K\\,m^{-1}\\,month^{-1}} ) \\times \\mathrm{m} = \\mathrm{K\\,month^{-1}}$，项 $b\\,T$ 的单位是 $(\\mathrm{month^{-1}}) \\times \\mathrm{K} = \\mathrm{K\\,month^{-1}}$。两者都与 $dT/dt$ 的单位匹配。类似的检查证实了第二个方程的一致性。设置是完整且一致的。\n\n### 步骤3：结论与行动\n问题是有效的。它是在气候模拟中应用线性系统理论的一个标准特征值问题。可以进行推导。\n\n### 解题推导\n该微分方程组可以表示为矩阵形式。设状态向量为 $\\mathbf{x}(t) = \\begin{pmatrix} T(t) \\\\ h(t) \\end{pmatrix}$。则该系统可写为：\n$$\n\\frac{d\\mathbf{x}}{dt} = \\mathbf{A}\\mathbf{x}\n$$\n其中矩阵 $\\mathbf{A}$ 为：\n$$\n\\mathbf{A} = \\begin{pmatrix} -b & a \\\\ -c & -d \\end{pmatrix}\n$$\n简正模解的形式为 $\\mathbf{x}(t) = \\mathbf{v}e^{\\lambda t}$，其中 $\\lambda$ 是 $\\mathbf{A}$ 的一个特征值，$\\mathbf{v}$ 是对应的特征向量。将此形式代入方程，得到特征值问题 $\\mathbf{A}\\mathbf{v} = \\lambda\\mathbf{v}$。\n\n特征值 $\\lambda$ 是特征方程 $\\det(\\mathbf{A} - \\lambda\\mathbf{I}) = 0$ 的根，其中 $\\mathbf{I}$ 是单位矩阵。\n$$\n\\det \\begin{pmatrix} -b-\\lambda & a \\\\ -c & -d-\\lambda \\end{pmatrix} = 0\n$$\n展开行列式得到：\n$$\n(-b-\\lambda)(-d-\\lambda) - (a)(-c) = 0\n$$\n$$\n(\\lambda+b)(\\lambda+d) + ac = 0\n$$\n$$\n\\lambda^2 + (b+d)\\lambda + (bd+ac) = 0\n$$\n这是一个关于特征值 $\\lambda$ 的二次方程。其根由二次方程求根公式给出：\n$$\n\\lambda = \\frac{-(b+d) \\pm \\sqrt{(b+d)^2 - 4(bd+ac)}}{2}\n$$\n解的性质（振荡的或纯阻尼的）取决于判别式 $\\Delta = (b+d)^2 - 4(bd+ac)$ 的符号。让我们代入给定的数值：\n- $b+d = 0.2 + 0.05 = 0.25\\ \\mathrm{month^{-1}}$\n- $bd = (0.2)(0.05) = 0.01\\ \\mathrm{month^{-2}}$\n- $ac = (0.6)(0.1) = 0.06\\ \\mathrm{month^{-2}}$\n\n判别式为：\n$$\n\\Delta = (0.25)^2 - 4(0.01 + 0.06) = 0.0625 - 4(0.07) = 0.0625 - 0.28 = -0.2175\n$$\n由于 $\\Delta  0$，特征值是一对共轭复数，表明存在阻尼振荡行为。特征值可以写成 $\\lambda = \\Re(\\lambda) \\pm i\\Im(\\lambda)$。\n\n特征值的实部是：\n$$\n\\Re(\\lambda) = -\\frac{b+d}{2}\n$$\n虚部是：\n$$\n\\Im(\\lambda) = \\pm \\frac{\\sqrt{-\\Delta}}{2} = \\pm \\frac{\\sqrt{4(bd+ac) - (b+d)^2}}{2}\n$$\n根据问题的定义，阻尼率 $r$ 是：\n$$\nr = -\\Re(\\lambda) = -\\left(-\\frac{b+d}{2}\\right) = \\frac{b+d}{2}\n$$\n代入数值：\n$$\nr = \\frac{0.25}{2} = 0.125\\ \\mathrm{month^{-1}}\n$$\n四舍五入到四位有效数字，我们得到 $r = 0.1250\\ \\mathrm{month^{-1}}$。\n\n振荡角频率 $\\omega$ 定义为特征值虚部的模：\n$$\n\\omega = |\\Im(\\lambda)| = \\frac{\\sqrt{4(bd+ac) - (b+d)^2}}{2} = \\frac{\\sqrt{-\\Delta}}{2}\n$$\n代入判别式的数值：\n$$\n\\omega = \\frac{\\sqrt{0.2175}}{2} \\approx \\frac{0.46636895}{2} \\approx 0.23318448\\ \\mathrm{rad\\,month^{-1}}\n$$\n振荡周期 $P$ 定义为 $P = 2\\pi/\\omega$：\n$$\nP = \\frac{2\\pi}{\\omega} = \\frac{2\\pi}{\\frac{\\sqrt{0.2175}}{2}} = \\frac{4\\pi}{\\sqrt{0.2175}}\n$$\n计算数值：\n$$\nP \\approx \\frac{4\\pi}{0.46636895} \\approx 26.94584\\ \\mathrm{months}\n$$\n四舍五入到四位有效数字，周期为 $P = 26.95\\ \\mathrm{months}$。\n\n振荡周期约为 $26.95$ 个月，阻尼率为 $0.1250\\ \\mathrm{month^{-1}}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 26.95  0.1250 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "在掌握了ENSO的基本理论和物理机制后，下一步是构建能够自主产生类ENSO变率的数值模型。本练习要求你设计并实现一个混合耦合模型，该模型包含一个简化的动力学海洋模块和一个统计大气模块，这代表了气候建模中的一种重要方法。通过亲手编写代码来模拟海气相互作用并分析其输出，你将学习如何评估模型的性能，即判断其能否再现ENSO的关键统计特征，这是气候模型开发与检验的核心环节。",
            "id": "4038384",
            "problem": "设计并实现一个用于表示厄尔尼诺-南方涛动（ENSO）的混合模型，该模型将一个统计大气耦合到一个动力海洋。统计部分是一个由海表温度异常驱动的自回归大气风应力异常模型，海洋部分是一个用于描述海表温度和温跃层深度异常的线性动力系统。目标是评估该混合模型是否能再现关键的观测ENSO统计特征。\n\n从以下基本原理和核心定义出发：\n\n- 海洋混合层热收支可理想化为海表温度异常 $T$ 的一个线性趋势，由局地阻尼、次表层温跃层异常 $h$ 和表层风应力异常 $\\tau$ 驱动：\n$$\n\\frac{dT}{dt} = -a\\,T + b\\,h + c\\,\\tau + \\eta_T,\n$$\n其中 $a$、$b$ 和 $c$ 是正常数，$\\eta_T$ 是一个代表未解析过程的微小随机过程噪声。\n\n- 温跃层深度异常 $h$ 的充放电框架假定其与 $T$ 存在带阻尼的线性耦合：\n$$\n\\frac{dh}{dt} = -d\\,T - e\\,h,\n$$\n其中 $d0$ 且 $e0$。\n\n- 统计大气表现为风应力异常 $\\tau$ 的一阶自回归过程，该过程包含记忆项、对上个月 $T$ 的线性反馈以及天气噪声 $\\epsilon$：\n$$\n\\tau_t = \\rho\\,\\tau_{t-1} + \\alpha\\,T_{t-1} + \\sigma_\\tau\\,\\epsilon_t,\n$$\n其中 $|\\rho|1$，$\\alpha$ 是耦合系数，$\\sigma_\\tau$ 是噪声振幅，$\\epsilon_t$ 是独立的标准正态变量。\n\n- 使用前向欧拉法对海洋方程进行离散化，固定时间步长为 $\\Delta t = 1$ 个月：\n$$\nT_{t+1} = T_t + \\Delta t\\left(-a\\,T_t + b\\,h_t + c\\,\\tau_t\\right) + \\sigma_T \\,\\xi_t,\\quad\nh_{t+1} = h_t + \\Delta t\\left(-d\\,T_t - e\\,h_t\\right),\n$$\n其中 $\\xi_t$ 是独立的标准正态变量，$\\sigma_T$ 是过程噪声振幅。所有参数 $a$、$b$、$c$、$d$、$e$ 的单位为 month$^{-1}$ 或与离散化一致；$T$ 的单位是开尔文（$\\mathrm{K}$），$h$ 的单位是米（$\\mathrm{m}$），$\\tau$ 的单位是牛顿/平方米（$\\mathrm{N\\,m^{-2}}$）。\n\n实现任务：\n\n1. 实现上述耦合系统，取 $\\Delta t = 1$ 个月。使用固定长度积分 $N_{\\text{total}} = 6000$ 个月，并舍弃前 $N_{\\text{spin}} = 1000$ 个月作为预积分（spin-up）。为保证可复现性，使用固定的随机种子。\n\n2. 通过使用参数向量模拟系统，定义一个“真实”或“观测”目标\n$$\n\\theta^{\\mathrm{obs}} = (a,e,b,d,\\rho,\\alpha,c,\\sigma_\\tau,\\sigma_T) = (0.08,\\,0.08,\\,0.4,\\,0.05,\\,0.7,\\,0.04,\\,0.1,\\,0.5,\\,0.05).\n$$\n从 $T$ 时间序列的最后 $N_{\\text{analysis}} = 5000$ 个月（去除均值后）计算：\n- 方差 $V_{\\mathrm{obs}}$，单位为 $\\mathrm{K^2}$。\n- 主导谱周期 $P_{\\mathrm{obs}}$，单位为月，定义为 $24$ 至 $96$ 个月频带内对应最大傅里叶功率的周期。如果没有离散频率落入该频带内，则选择离该频带最近的单个非零傅里叶频率，并使用其周期。\n- 滞后-1自相关 $R_{\\mathrm{obs}}$（无量纲），使用分析时段内 $T_{t}$ 和 $T_{t-1}$ 之间的皮尔逊相关系数计算。\n\n3. 对于每个测试案例的参数向量 $\\theta$，模拟混合模型并计算相应的统计量 $V_{\\theta}$、$P_{\\theta}$ 和 $R_{\\theta}$，单位和定义与观测目标中的相同。对于每个测试案例，计算以下三个标量误差：\n- 相对方差误差 $E_V = \\left|V_{\\theta}-V_{\\mathrm{obs}}\\right|/V_{\\mathrm{obs}}$（无量纲，以小数形式表示）。\n- 相对主导周期误差 $E_P = \\left|P_{\\theta}-P_{\\mathrm{obs}}\\right|/P_{\\mathrm{obs}}$（无量纲，以小数形式表示）。\n- 绝对滞后-1自相关误差 $E_R = \\left|R_{\\theta}-R_{\\mathrm{obs}}\\right|$（无量纲）。\n\n4. 如果一个测试案例满足 $E_V \\le 0.3$、$E_P \\le 0.25$ 和 $E_R \\le 0.1$，则被视为“成功”。否则，视为“失败”。\n\n物理和数值单位：\n- $V_{\\mathrm{obs}}$ 和 $V_{\\theta}$ 隐式地以 $\\mathrm{K^2}$ 为单位报告；无需打印这些值，内部仅使用布尔型的通过/失败判断。\n- $P_{\\mathrm{obs}}$ 和 $P_{\\theta}$ 隐式地以月为单位报告；无需打印这些值，内部仅使用布尔型的通过/失败判断。\n- $R_{\\mathrm{obs}}$ 和 $R_{\\theta}$ 作为无量纲量报告；无需打印这些值，内部仅使用布尔型的通过/失败判断。\n\n测试套件：\n使用以下四个参数向量进行评估，每个向量的顺序为 $(a,e,b,d,\\rho,\\alpha,c,\\sigma_\\tau,\\sigma_T)$，其单位与离散化一致。所有数值均按上述定义进行解释。\n\n- 案例 1（近观测值）：$(0.08,\\,0.08,\\,0.4,\\,0.05,\\,0.7,\\,0.038,\\,0.09,\\,0.55,\\,0.05)$。\n- 案例 2（弱耦合）：$(0.08,\\,0.08,\\,0.4,\\,0.05,\\,0.7,\\,0.0,\\,0.05,\\,0.4,\\,0.05)$。\n- 案例 3（强阻尼）：$(0.2,\\,0.2,\\,0.4,\\,0.05,\\,0.7,\\,0.04,\\,0.1,\\,0.5,\\,0.05)$。\n- 案例 4（强大气记忆和强迫）：$(0.08,\\,0.08,\\,0.4,\\,0.05,\\,0.9,\\,0.06,\\,0.12,\\,0.8,\\,0.05)$。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个条目都是一个布尔值，表示上述相应测试案例的成功或失败。例如，四个案例的输出应类似于 $[True,False,True,False]$。不应打印任何额外文本。",
            "solution": "该问题被评估为有效。它在气候建模领域提出了一个定义明确、具有科学依据的任务，所有必要的参数和方法都得到了清晰的定义。\n\n目标是实现一个用于厄尔尼诺-南方涛动（ENSO）的混合耦合模型，分析其输出，并根据一组预定义标准评估其性能。该模型将一个简化的动力海洋与一个统计大气耦合起来。\n\n首先，我们对完整的离散时间系统进行形式化。模型在任意时间步 $t$ 的状态由向量 $(T_t, h_t, \\tau_t)$ 描述，分别代表海表温度异常、温跃层深度异常和风应力异常。给定时间 $t$ 的状态，时间 $t+1$ 的状态使用以下耦合随机差分方程组计算，其中时间步长 $\\Delta t$ 定为 1 个月。\n\n海表温度异常 $T_{t+1}$ 基于其前一时间步的值 $T_t$ 进行更新。更新包括一个阻尼项 $-a\\,T_t$、一个与温跃层深度异常的耦合项 $b\\,h_t$、一个来自大气风应力异常的强迫项 $c\\,\\tau_t$ 以及一个代表未解析海洋过程的随机噪声项 $\\sigma_T\\,\\xi_t$。当 $\\Delta t = 1$ 时，方程为：\n$$\nT_{t+1} = T_t + (1)\\left(-a\\,T_t + b\\,h_t + c\\,\\tau_t\\right) + \\sigma_T \\,\\xi_t = (1-a)T_t + b\\,h_t + c\\,\\tau_t + \\sigma_T\\,\\xi_t\n$$\n此处，$\\xi_t$ 是从标准正态分布 $\\mathcal{N}(0,1)$ 中抽取的独立随机变量。\n\n温跃层深度异常 $h_{t+1}$ 遵循充放电框架。其演变取决于来自海表温度异常的强迫 $-d\\,T_t$ 及其自身的阻尼 $-e\\,h_t$。当 $\\Delta t = 1$ 时，离散更新方程为：\n$$\nh_{t+1} = h_t + (1)\\left(-d\\,T_t - e\\,h_t\\right) = (1-e)h_t - d\\,T_t\n$$\n根据问题陈述，该方程是确定性的，不包含随机强迫项。\n\n大气风应力异常 $\\tau_{t+1}$ 被建模为一阶自回归过程。它具有对其先前状态的记忆 $\\rho\\,\\tau_t$，受同一时间步的海表温度异常 $\\alpha\\,T_t$ 的强迫，并包含一个大气天气噪声项 $\\sigma_\\tau\\,\\epsilon_{t+1}$。该方程为：\n$$\n\\tau_{t+1} = \\rho\\,\\tau_t + \\alpha\\,T_t + \\sigma_\\tau\\,\\epsilon_{t+1}\n$$\n此处，$\\epsilon_{t+1}$ 是另一个从 $\\mathcal{N}(0,1)$ 中抽取的独立随机变量，与 $\\xi_t$ 不同。条件 $|\\rho|  1$ 确保了在没有耦合的情况下大气过程的平稳性。\n\n实现过程首先定义一个主函数，该函数针对给定的参数向量 $\\theta = (a,e,b,d,\\rho,\\alpha,c,\\sigma_\\tau,\\sigma_T)$ 执行模拟和后续分析。该函数将执行以下步骤：\n\n1.  **初始化**：设置总模拟长度 $N_{\\text{total}} = 6000$ 个月和预积分期 $N_{\\text{spin}} = 1000$ 个月。为 $T$、$h$ 和 $\\tau$ 的时间序列初始化长度为 $N_{\\text{total}}$ 的数组，初始条件为 $T_0=0$、$h_0=0$ 和 $\\tau_0=0$。使用固定的随机种子以确保随机噪声序列 $\\xi_t$ 和 $\\epsilon_t$ 的可复现性。\n\n2.  **时间积分**：一个循环从 $t=0$ 运行到 $t=N_{\\text{total}}-2$。在每次迭代中，使用上面定义的离散方程从时间 $t$ 的值计算 $T_{t+1}$、$h_{t+1}$ 和 $\\tau_{t+1}$ 的值。在每个步骤中为 $\\xi_t$ 和 $\\epsilon_{t+1}$ 生成两个独立的标准正态随机数。\n\n3.  **统计分析**：积分完成后，提取 $T$ 时间序列的最后 $N_{\\text{analysis}} = N_{\\text{total}} - N_{\\text{spin}} = 5000$ 个月用于分析。\n    - 计算该分析时段的均值并将其减去，以生成零均值异常序列。\n    - 从该去均值序列计算方差 $V$。\n    - 滞后-1自相关 $R$ 作为该序列与其自身偏移一个月后的版本之间的皮尔逊相关系数来计算。\n    - 主导谱周期 $P$ 通过傅里叶分析确定。对去均值的序列应用实数快速傅里叶变换（FFT）以获得功率谱。计算相应的频率 $f$。我们在 24 至 96 个月的周期带（等效于 $[1/96, 1/24]$ 周/月的频带）内搜索与最大功率相关的频率。如果该频带不包含分析得出的离散傅里叶频率，则应用一个备用规则：选择最接近该频带的非零频率。然后主导周期为 $P = 1/f_{\\text{peak}}$。\n\n4.  **评估**：首先使用“观测”参数向量 $\\theta^{\\mathrm{obs}}$ 运行上述过程，以建立目标统计量 $V_{\\mathrm{obs}}$、$P_{\\mathrm{obs}}$ 和 $R_{\\mathrm{obs}}$。随后，对每个测试案例的参数向量 $\\theta$ 重复该过程，以找到 $V_{\\theta}$、$P_{\\theta}$ 和 $R_{\\theta}$。然后计算三个误差度量：\n    - 相对方差误差：$E_V = |V_{\\theta}-V_{\\mathrm{obs}}|/V_{\\mathrm{obs}}$\n    - 相对主导周期误差：$E_P = |P_{\\theta}-P_{\\mathrm{obs}}|/P_{\\mathrm{obs}}$\n    - 绝对自相关误差：$E_R = |R_{\\theta}-R_{\\mathrm{obs}}|$\n    当且仅当 $E_V \\le 0.3$、$E_P \\le 0.25$ 和 $E_R \\le 0.1$ 时，一个测试案例是成功的。最终输出是一个布尔值列表，指示每个测试案例的成功或失败。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the hybrid ENSO model simulation and evaluation.\n    \"\"\"\n    \n    # --------------------------\n    # CONFIGURATION\n    # --------------------------\n    N_TOTAL = 6000  # Total integration months\n    N_SPIN = 1000   # Spin-up months to discard\n    DT = 1.0        # Time step in months\n    RANDOM_SEED = 42 # Fixed seed for reproducibility\n    \n    # \"Observational\" target parameter vector\n    # Order: (a, e, b, d, rho, alpha, c, sigma_tau, sigma_T)\n    theta_obs = (0.08, 0.08, 0.4, 0.05, 0.7, 0.04, 0.1, 0.5, 0.05)\n    \n    # Test cases parameter vectors\n    test_cases = [\n        (0.08, 0.08, 0.4, 0.05, 0.7, 0.038, 0.09, 0.55, 0.05),  # Case 1\n        (0.08, 0.08, 0.4, 0.05, 0.7, 0.0, 0.05, 0.4, 0.05),      # Case 2\n        (0.2, 0.2, 0.4, 0.05, 0.7, 0.04, 0.1, 0.5, 0.05),        # Case 3\n        (0.08, 0.08, 0.4, 0.05, 0.9, 0.06, 0.12, 0.8, 0.05),     # Case 4\n    ]\n\n    def run_model_and_get_stats(params, seed, n_total, n_spin, dt):\n        \"\"\"\n        Runs the coupled model for a given set of parameters and computes statistics.\n        \n        Args:\n            params (tuple): Parameter vector in the order (a,e,b,d,rho,alpha,c,sigma_tau,sigma_T).\n            seed (int): Random seed.\n            n_total (int): Total number of simulation months.\n            n_spin (int): Number of spin-up months.\n            dt (float): Time step.\n            \n        Returns:\n            tuple: (Variance, Dominant Period, Lag-1 Autocorrelation).\n        \"\"\"\n        # Unpack parameters carefully according to the specified order\n        a, e, b, d, rho, alpha, c, sigma_tau, sigma_T = params\n\n        # Initialize random number generator\n        rng = np.random.default_rng(seed)\n\n        # Initialize state variable arrays\n        T = np.zeros(n_total)\n        h = np.zeros(n_total)\n        tau = np.zeros(n_total)\n\n        # Time-stepping loop\n        for t in range(n_total - 1):\n            # Generate stochastic forcing terms\n            xi = rng.standard_normal()\n            epsilon = rng.standard_normal()\n            \n            # Update T (Sea Surface Temperature Anomaly)\n            T[t+1] = T[t] + dt * (-a * T[t] + b * h[t] + c * tau[t]) + sigma_T * xi\n            \n            # Update h (Thermocline Depth Anomaly)\n            h[t+1] = h[t] + dt * (-d * T[t] - e * h[t])\n            \n            # Update tau (Wind-stress Anomaly)\n            tau[t+1] = rho * tau[t] + alpha * T[t] + sigma_tau * epsilon\n\n        # --- STATISTICAL ANALYSIS ---\n        \n        # Extract analysis part after spin-up and demean\n        T_analysis = T[n_spin:]\n        T_analysis -= np.mean(T_analysis)\n        n_analysis = len(T_analysis)\n        \n        # 1. Variance\n        variance = np.var(T_analysis)\n        \n        # 2. Lag-1 Autocorrelation\n        lag1_autocorr = np.corrcoef(T_analysis[:-1], T_analysis[1:])[0, 1]\n        \n        # 3. Dominant Period\n        # Compute FFT and power spectrum\n        yf = np.fft.rfft(T_analysis)\n        xf = np.fft.rfftfreq(n_analysis, d=dt)\n        power = np.abs(yf)**2\n        \n        # Define frequency band\n        min_period, max_period = 24.0, 96.0\n        min_freq, max_freq = 1.0 / max_period, 1.0 / min_period\n        \n        # Find frequencies within the band\n        band_indices = np.where((xf = min_freq)  (xf = max_freq))[0]\n        \n        if len(band_indices)  0:\n            # Find frequency with max power within the band\n            peak_power_index_in_band = np.argmax(power[band_indices])\n            peak_index = band_indices[peak_power_index_in_band]\n            peak_freq = xf[peak_index]\n        else:\n            # Fallback: find the single closest non-zero Fourier frequency to the band\n            nonzero_freq_indices = np.where(xf  0)[0]\n            if len(nonzero_freq_indices) == 0:\n                # This case is highly unlikely for this problem but handled for robustness\n                dominant_period = np.nan\n                return variance, dominant_period, lag1_autocorr\n\n            nonzero_freqs = xf[nonzero_freq_indices]\n            \n            # Calculate distance of each frequency to the band [min_freq, max_freq]\n            # Distance is 0 if inside, positive otherwise\n            distances = np.maximum(min_freq - nonzero_freqs, nonzero_freqs - max_freq)\n            closest_freq_local_idx = np.argmin(distances)\n            peak_index = nonzero_freq_indices[closest_freq_local_idx]\n            peak_freq = xf[peak_index]\n\n        dominant_period = 1.0 / peak_freq if peak_freq  0 else np.inf\n        \n        return variance, dominant_period, lag1_autocorr\n\n    # --- MAIN EXECUTION ---\n    \n    # Calculate \"observational\" statistics\n    V_obs, P_obs, R_obs = run_model_and_get_stats(\n        theta_obs, RANDOM_SEED, N_TOTAL, N_SPIN, DT\n    )\n\n    results = []\n    for theta_case in test_cases:\n        # Calculate statistics for the test case\n        V_theta, P_theta, R_theta = run_model_and_get_stats(\n            theta_case, RANDOM_SEED, N_TOTAL, N_SPIN, DT\n        )\n        \n        # Compute errors\n        E_V = abs(V_theta - V_obs) / V_obs\n        E_P = abs(P_theta - P_obs) / P_obs\n        E_R = abs(R_theta - R_obs)\n        \n        # Check success criteria\n        is_success = (E_V = 0.3) and (E_P = 0.25) and (E_R = 0.1)\n        results.append(is_success)\n\n    # Format and print the final output\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}