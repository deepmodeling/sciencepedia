{
    "hands_on_practices": [
        {
            "introduction": "This problem explores the core of ENSO's oscillatory nature by simplifying it into a two-variable linear system. By treating the sea surface temperature and thermocline depth anomalies as a coupled pair, you can use linear stability analysis to understand the system's intrinsic properties. This exercise  is fundamental for learning how to extract key characteristics like oscillation period and damping rate directly from the governing physics, a cornerstone of climate dynamics theory.",
            "id": "4035502",
            "problem": "El Niño–Southern Oscillation (ENSO) is often idealized in reduced-complexity climate models as a coupled oscillator between a Niño-3 sea surface temperature anomaly $T(t)$ and an equatorial Pacific thermocline depth anomaly $h(t)$. In one such linearized formulation consistent with anomaly heat budget and mass continuity, the prognostic system for $(T,h)$ is\n$$\\frac{dT}{dt}=a\\,h-b\\,T,\\qquad \\frac{dh}{dt}=-c\\,T-d\\,h,$$\nwhere $a$ represents the sensitivity of the sea surface temperature tendency to thermocline anomalies, $b$ represents net thermal damping, $c$ represents the sensitivity of thermocline tendency to temperature anomalies via wind-stress feedbacks and wave adjustments, and $d$ represents net thermocline damping. All coefficients are constant. Assume the numerical values $a=0.6\\ \\mathrm{K\\,m^{-1}\\,month^{-1}}$, $b=0.2\\ \\mathrm{month^{-1}}$, $c=0.1\\ \\mathrm{m\\,K^{-1}\\,month^{-1}}$, and $d=0.05\\ \\mathrm{month^{-1}}$.\n\nStarting from first principles of linear systems theory applied to constant-coefficient ordinary differential equations, derive the normal-mode solutions and use them to obtain the oscillation period and the linear damping rate for this system. Define the oscillation period $P$ from the imaginary part of the eigenvalues as $P=2\\pi/\\omega$, where $\\omega$ is the magnitude of the imaginary part in radians per month, and define the damping rate $r$ as the positive quantity $r=-\\Re(\\lambda)$, where $\\lambda$ is an eigenvalue of the system. Round the oscillation period and the damping rate to four significant figures. Express the oscillation period in months and the damping rate in $\\mathrm{month^{-1}}$.",
            "solution": "### Step 1: Extract Givens\nThe problem provides a system of two coupled linear ordinary differential equations for the El Niño–Southern Oscillation (ENSO) anomalies, sea surface temperature $T(t)$ and thermocline depth $h(t)$:\n$$\n\\frac{dT}{dt} = a\\,h - b\\,T\n$$\n$$\n\\frac{dh}{dt} = -c\\,T - d\\,h\n$$\nThe constant coefficients are given as:\n- $a = 0.6\\ \\mathrm{K\\,m^{-1}\\,month^{-1}}$\n- $b = 0.2\\ \\mathrm{month^{-1}}$\n- $c = 0.1\\ \\mathrm{m\\,K^{-1}\\,month^{-1}}$\n- $d = 0.05\\ \\mathrm{month^{-1}}$\n\nThe problem defines the oscillation period $P$ as $P = 2\\pi/\\omega$, where $\\omega$ is the magnitude of the imaginary part of the system's eigenvalues.\nThe problem defines the linear damping rate $r$ as $r = -\\Re(\\lambda)$, where $\\lambda$ is an eigenvalue.\nThe final numerical values are to be rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded:** The model is a well-established reduced-complexity model used in climate dynamics to study ENSO. It represents a linearization of the underlying physics of tropical Pacific air-sea interaction. The formulation is scientifically sound.\n2.  **Well-Posed:** The problem describes a system of linear, constant-coefficient, homogeneous ordinary differential equations. For any given initial condition, a unique solution exists. The problem is well-posed.\n3.  **Objective:** The problem statement is precise, quantitative, and free of subjective or ambiguous language.\n4.  **Completeness and Consistency:** All necessary parameters ($a, b, c, d$) are provided with consistent units. For instance, in the first equation, the term $a\\,h$ has units of $( \\mathrm{K\\,m^{-1}\\,month^{-1}} ) \\times \\mathrm{m} = \\mathrm{K\\,month^{-1}}$, and the term $b\\,T$ has units of $(\\mathrm{month^{-1}}) \\times \\mathrm{K} = \\mathrm{K\\,month^{-1}}$. Both match the units of $dT/dt$. A similar check confirms the consistency of the second equation. The setup is complete and consistent.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is a standard eigenvalue problem in the context of linear systems theory applied to climate modeling. The derivation can proceed.\n\n### Solution Derivation\nThe system of differential equations can be expressed in matrix form. Let the state vector be $\\mathbf{x}(t) = \\begin{pmatrix} T(t) \\\\ h(t) \\end{pmatrix}$. The system is then written as:\n$$\n\\frac{d\\mathbf{x}}{dt} = \\mathbf{A}\\mathbf{x}\n$$\nwhere the matrix $\\mathbf{A}$ is given by:\n$$\n\\mathbf{A} = \\begin{pmatrix} -b  a \\\\ -c  -d \\end{pmatrix}\n$$\nThe normal-mode solutions are of the form $\\mathbf{x}(t) = \\mathbf{v}e^{\\lambda t}$, where $\\lambda$ is an eigenvalue of $\\mathbf{A}$ and $\\mathbf{v}$ is the corresponding eigenvector. Substituting this form into the equation yields the eigenvalue problem $\\mathbf{A}\\mathbf{v} = \\lambda\\mathbf{v}$.\n\nThe eigenvalues $\\lambda$ are the roots of the characteristic equation $\\det(\\mathbf{A} - \\lambda\\mathbf{I}) = 0$, where $\\mathbf{I}$ is the identity matrix.\n$$\n\\det \\begin{pmatrix} -b-\\lambda  a \\\\ -c  -d-\\lambda \\end{pmatrix} = 0\n$$\nExpanding the determinant gives:\n$$\n(-b-\\lambda)(-d-\\lambda) - (a)(-c) = 0\n$$\n$$\n(\\lambda+b)(\\lambda+d) + ac = 0\n$$\n$$\n\\lambda^2 + (b+d)\\lambda + (bd+ac) = 0\n$$\nThis is a quadratic equation for the eigenvalues $\\lambda$. The roots are given by the quadratic formula:\n$$\n\\lambda = \\frac{-(b+d) \\pm \\sqrt{(b+d)^2 - 4(bd+ac)}}{2}\n$$\nThe nature of the solution (oscillatory or purely damped) depends on the sign of the discriminant, $\\Delta = (b+d)^2 - 4(bd+ac)$. Let's substitute the given numerical values:\n- $b+d = 0.2 + 0.05 = 0.25\\ \\mathrm{month^{-1}}$\n- $bd = (0.2)(0.05) = 0.01\\ \\mathrm{month^{-2}}$\n- $ac = (0.6)(0.1) = 0.06\\ \\mathrm{month^{-2}}$\n\nThe discriminant is:\n$$\n\\Delta = (0.25)^2 - 4(0.01 + 0.06) = 0.0625 - 4(0.07) = 0.0625 - 0.28 = -0.2175\n$$\nSince $\\Delta  0$, the eigenvalues are a complex conjugate pair, indicating damped oscillatory behavior. The eigenvalues can be written as $\\lambda = \\Re(\\lambda) \\pm i\\Im(\\lambda)$.\n\nThe real part of the eigenvalue is:\n$$\n\\Re(\\lambda) = -\\frac{b+d}{2}\n$$\nThe imaginary part is:\n$$\n\\Im(\\lambda) = \\pm \\frac{\\sqrt{-\\Delta}}{2} = \\pm \\frac{\\sqrt{4(bd+ac) - (b+d)^2}}{2}\n$$\nAccording to the problem's definition, the damping rate $r$ is:\n$$\nr = -\\Re(\\lambda) = -\\left(-\\frac{b+d}{2}\\right) = \\frac{b+d}{2}\n$$\nSubstituting the numerical values:\n$$\nr = \\frac{0.25}{2} = 0.125\\ \\mathrm{month^{-1}}\n$$\nRounding to four significant figures, we get $r = 0.1250\\ \\mathrm{month^{-1}}$.\n\nThe oscillation angular frequency $\\omega$ is defined as the magnitude of the imaginary part of the eigenvalues:\n$$\n\\omega = |\\Im(\\lambda)| = \\frac{\\sqrt{4(bd+ac) - (b+d)^2}}{2} = \\frac{\\sqrt{-\\Delta}}{2}\n$$\nSubstituting the numerical value for the discriminant:\n$$\n\\omega = \\frac{\\sqrt{0.2175}}{2} \\approx \\frac{0.46636895}{2} \\approx 0.23318448\\ \\mathrm{rad\\,month^{-1}}\n$$\nThe oscillation period $P$ is defined as $P = 2\\pi/\\omega$:\n$$\nP = \\frac{2\\pi}{\\omega} = \\frac{2\\pi}{\\frac{\\sqrt{0.2175}}{2}} = \\frac{4\\pi}{\\sqrt{0.2175}}\n$$\nCalculating the numerical value:\n$$\nP \\approx \\frac{4\\pi}{0.46636895} \\approx 26.94584\\ \\mathrm{months}\n$$\nRounding to four significant figures, the period is $P = 26.95\\ \\mathrm{months}$.\n\nThe oscillation period is approximately $26.95$ months, and the damping rate is $0.1250\\ \\mathrm{month^{-1}}$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 26.95  0.1250 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "The delayed oscillator is a paradigm for understanding ENSO's cyclicity, attributing the characteristic timescale to the transit of oceanic waves across the Pacific basin. This practice  challenges you to calculate the crossing times for eastward-propagating Kelvin waves and westward-propagating Rossby waves. By connecting these physical transit times to the total round-trip period, you will gain a quantitative appreciation for how wave dynamics set the \"pacemaker\" for the world's most dominant mode of interannual climate variability.",
            "id": "4038443",
            "problem": "Consider the linearized one-layer shallow-water equations on an equatorial beta-plane for a resting background ocean, with longitude $x$, latitude $y$, horizontal velocities $u(x,y,t)$ and $v(x,y,t)$, and free-surface displacement $\\eta(x,y,t)$:\n$$\n\\frac{\\partial u}{\\partial t} - \\beta y v = -g \\frac{\\partial \\eta}{\\partial x}, \\quad\n\\frac{\\partial v}{\\partial t} + \\beta y u = -g \\frac{\\partial \\eta}{\\partial y}, \\quad\n\\frac{\\partial \\eta}{\\partial t} + H \\left( \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} \\right) = 0,\n$$\nwhere $g$ is gravitational acceleration, $H$ is the equivalent depth of the baroclinic mode, and $\\beta$ is the meridional derivative of the Coriolis parameter at the equator. The equatorial deformation scale is $L_e = \\sqrt{\\frac{c}{\\beta}}$, where $c = \\sqrt{g H}$ is the long gravity wave speed in shallow-water theory. Under equatorial wave theory, there exist eastward-propagating Kelvin waves and westward-propagating equatorially trapped Rossby waves characterized by discrete meridional mode number $n \\in \\{1,2,\\dots\\}$.\n\nA zonal wind forcing localized near the western boundary excites an equatorial Kelvin wave that propagates eastward across a basin of zonal extent $L$ and, upon reaching the eastern boundary, partially reflects into equatorial Rossby waves that propagate westward back across the basin. In the long-wave limit appropriate for basin-scale disturbances, the equatorial Kelvin wave dispersion is non-dispersive with phase speed $c = \\sqrt{g H}$, while the phase speed of the equatorial Rossby wave for meridional mode $n$ reduces to a constant westward value whose magnitude is $\\lvert c_R \\rvert$ scaling with $c$ and $n$.\n\nStarting from the above framework, determine the basin-crossing time for the Kelvin wave, the return time for the reflected Rossby waves, and the total round-trip time. The goal is to relate these timescales to the El Niño–Southern Oscillation (ENSO) cycle length by comparing the computed round-trip time with a reference duration.\n\nTasks:\n- Using the long-wave limit for equatorial waves, compute the eastward Kelvin wave crossing time $T_K = \\frac{L}{c}$.\n- Using the same long-wave limit, compute the westward equatorial Rossby wave return time $T_R = \\frac{L}{\\lvert c_R \\rvert}$ for a given meridional mode number $n$.\n- Compute the total round-trip time $T_{\\text{tot}} = T_K + T_R$.\n- Compute the ratio $r = \\frac{T_{\\text{tot}}}{T_{\\text{ref}}}$ to a reference ENSO duration $T_{\\text{ref}}$.\n\nAssumptions:\n- Long-wave limit for the equatorial Kelvin and Rossby waves appropriate to basin-scale disturbances.\n- For the equatorial Rossby wave, use the long-wave phase speed magnitude appropriate to meridional mode $n$.\n- Reflection at the eastern boundary is idealized to produce the dominant equatorial Rossby mode specified by $n$ that traverses the basin.\n\nPhysical constants and units:\n- Use $g = 9.81\\,\\text{m}\\,\\text{s}^{-2}$.\n- Use $T_{\\text{ref}} = 3.5\\,\\text{years}$ as the reference ENSO cycle length.\n- Express all times $T_K$, $T_R$, and $T_{\\text{tot}}$ in years, rounded to three decimal places, using the conversion $1\\,\\text{year} = 365 \\times 86400\\,\\text{s}$.\n- The ratio $r$ must be a float, rounded to three decimal places.\n\nTest suite:\nFor each of the following parameter sets $(L,H,n)$, compute $\\left[T_K, T_R, T_{\\text{tot}}, r, \\text{within}\\right]$, where $\\text{within}$ is a boolean that is $\\text{True}$ if $T_{\\text{tot}}$ lies between $2.0\\,\\text{years}$ and $7.0\\,\\text{years}$ inclusive, and $\\text{False}$ otherwise.\n- Case A: $L = 1.5 \\times 10^7\\,\\text{m}$, $H = 0.5\\,\\text{m}$, $n = 1$.\n- Case B: $L = 1.5 \\times 10^7\\,\\text{m}$, $H = 0.3\\,\\text{m}$, $n = 1$.\n- Case C: $L = 1.5 \\times 10^7\\,\\text{m}$, $H = 1.0\\,\\text{m}$, $n = 2$.\n- Case D: $L = 1.0 \\times 10^7\\,\\text{m}$, $H = 0.2\\,\\text{m}$, $n = 3$.\n- Case E: $L = 1.7 \\times 10^7\\,\\text{m}$, $H = 0.05\\,\\text{m}$, $n = 2$.\n\nFinal output format:\nYour program should produce a single line of output containing a list of lists, one per test case, with each inner list containing five values $[T_K, T_R, T_{\\text{tot}}, r, \\text{within}]$ in the order described above. The outer list must be enclosed in square brackets and the inner lists must be enclosed in square brackets, with entries comma-separated, for example: $[[\\dots],[\\dots],[\\dots]]$.",
            "solution": "The problem is assessed to be valid. All data and conditions required for a unique and meaningful solution are provided or are standard, well-established theoretical results within the specified field. The problem is scientifically grounded in the theory of equatorial ocean dynamics, is well-posed, and is formulated objectively.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n*   **Governing Equations**: Linearized one-layer shallow-water equations on an equatorial beta-plane for a resting background state:\n    $$\n    \\frac{\\partial u}{\\partial t} - \\beta y v = -g \\frac{\\partial \\eta}{\\partial x}\n    $$\n    $$\n    \\frac{\\partial v}{\\partial t} + \\beta y u = -g \\frac{\\partial \\eta}{\\partial y}\n    $$\n    $$\n    \\frac{\\partial \\eta}{\\partial t} + H \\left( \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} \\right) = 0\n    $$\n*   **Variables**:\n    *   $u, v$: zonal and meridional velocities\n    *   $\\eta$: free-surface displacement\n    *   $x, y, t$: longitude, latitude, time\n*   **Constants and Parameters**:\n    *   $g$: gravitational acceleration, $g = 9.81\\,\\text{m}\\,\\text{s}^{-2}$\n    *   $H$: equivalent depth of the baroclinic mode\n    *   $\\beta$: meridional derivative of the Coriolis parameter at the equator\n    *   $L$: zonal extent of the basin\n    *   $n$: meridional mode number for Rossby waves, $n \\in \\{1,2,\\dots\\}$\n    *   $T_{\\text{ref}}$: reference ENSO duration, $T_{\\text{ref}} = 3.5\\,\\text{years}$\n*   **Definitions**:\n    *   Long gravity wave speed: $c = \\sqrt{g H}$\n    *   Kelvin wave crossing time: $T_K = L/c$\n    *   Rossby wave return time: $T_R = L/\\lvert c_R \\rvert$\n    *   Total round-trip time: $T_{\\text{tot}} = T_K + T_R$\n    *   Ratio: $r = T_{\\text{tot}}/T_{\\text{ref}}$\n*   **Assumptions**:\n    *   Long-wave limit for equatorial Kelvin and Rossby waves.\n    *   The phase speed of the Rossby wave for meridional mode $n$ reduces to a constant westward value $\\lvert c_R \\rvert$ that scales with $c$ and $n$.\n*   **Unit Conversion**: $1\\,\\text{year} = 365 \\times 86400\\,\\text{s}$\n*   **Output Requirements**:\n    *   Times $T_K$, $T_R$, and $T_{\\text{tot}}$ in years, rounded to three decimal places.\n    *   Ratio $r$ as a float, rounded to three decimal places.\n    *   `within`: a boolean, `True` if $2.0 \\le T_{\\text{tot}} \\le 7.0\\,\\text{years}$, `False` otherwise.\n*   **Test Suite**:\n    *   Case A: $L = 1.5 \\times 10^7\\,\\text{m}$, $H = 0.5\\,\\text{m}$, $n = 1$.\n    *   Case B: $L = 1.5 \\times 10^7\\,\\text{m}$, $H = 0.3\\,\\text{m}$, $n = 1$.\n    *   Case C: $L = 1.5 \\times 10^7\\,\\text{m}$, $H = 1.0\\,\\text{m}$, $n = 2$.\n    *   Case D: $L = 1.0 \\times 10^7\\,\\text{m}$, $H = 0.2\\,\\text{m}$, $n = 3$.\n    *   Case E: $L = 1.7 \\times 10^7\\,\\text{m}$, $H = 0.05\\,\\text{m}$, $n = 2$.\n\n**Step 2: Validate Using Extracted Givens**\n\n1.  **Scientific or Factual Unsoundness**: The problem is based on the linearized shallow-water equations on an equatorial beta-plane, a canonical model in physical oceanography for describing large-scale equatorial phenomena like Kelvin and Rossby waves, which are central to theories of ENSO such as the delayed oscillator mechanism. The assumptions are standard. The problem is scientifically sound.\n2.  **Non-Formalizable or Irrelevant**: The problem is a direct application of equatorial wave theory to a quantitative question about climate dynamics. It is formalizable and relevant.\n3.  **Incomplete or Contradictory Setup**: The problem does not explicitly provide the formula for the Rossby wave phase speed magnitude, $\\lvert c_R \\rvert$. However, it states that it is the long-wave limit for meridional mode $n$. In standard equatorial wave theory, this limit is a well-known result derivable from the full dispersion relation. The phase speed for long-wavelength equatorial Rossby waves of meridional mode $n \\ge 1$ is $c_R = -\\frac{c}{2n+1}$. The magnitude is thus $\\lvert c_R \\rvert = \\frac{c}{2n+1}$. It is a reasonable expectation in this context that this standard formula should be known and applied. With this, the problem is complete.\n4.  **Unrealistic or Infeasible**: The physical constants and parameter ranges are realistic for Earth's oceans and climate system. For example, a basin width of $1.5 \\times 10^7\\,\\text{m}$ is approximately the width of the Pacific Ocean. The equivalent depths for the first few baroclinic modes are typically in the range of $0.1$ to $1.0\\,\\text{m}$. The problem is physically plausible.\n5.  **Ill-Posed or Poorly Structured**: The tasks are clearly defined, and the inputs for each test case lead to a unique set of outputs. The problem is well-posed.\n6.  **Pseudo-Profound, Trivial, or Tautological**: The problem requires applying fundamental physical principles to a non-trivial calculation that connects wave dynamics to climate phenomena, representing a classic problem in geophysical fluid dynamics. It is not trivial or tautological.\n7.  **Outside Scientific Verifiability**: The calculations are entirely verifiable through standard mathematical and physical procedures.\n\n**Step 3: Verdict and Action**\n\nThe problem is **valid**. A complete solution will be provided.\n\n### Solution\n\nThe solution involves calculating the propagation times for equatorial Kelvin and Rossby waves across a specified basin, summing them to find a total round-trip time, and comparing this to a reference period for the El Niño–Southern Oscillation (ENSO). This is a simplified model often referred to as a \"delayed oscillator\" mechanism for ENSO, where the periodicity is set by wave transit times across the Pacific basin.\n\nThe fundamental quantities are derived from the given parameters for each case.\n\n1.  **Kelvin Wave Speed ($c$) and Crossing Time ($T_K$)**\n\n    The phase speed of long (non-dispersive) equatorial Kelvin waves is identical to the shallow-water gravity wave speed, $c$. This is given by:\n    $$\n    c = \\sqrt{g H}\n    $$\n    The time, $T_K$, for the Kelvin wave to cross the basin of width $L$ is:\n    $$\n    T_K = \\frac{L}{c} = \\frac{L}{\\sqrt{g H}}\n    $$\n\n2.  **Rossby Wave Speed ($\\lvert c_R \\rvert$) and Return Time ($T_R$)**\n\n    In the long-wave limit (small zonal wavenumber $k$), the dispersion relation for equatorial Rossby waves of meridional mode number $n \\ge 1$ simplifies to $\\omega \\approx -\\frac{ck}{2n+1}$. The phase speed, $c_R = \\omega/k$, is thus:\n    $$\n    c_R = -\\frac{c}{2n+1}\n    $$\n    The negative sign indicates westward propagation. The magnitude of the speed is:\n    $$\n    \\lvert c_R \\rvert = \\frac{c}{2n+1}\n    $$\n    The time, $T_R$, for the reflected Rossby wave to return across the basin is:\n    $$\n    T_R = \\frac{L}{\\lvert c_R \\rvert} = \\frac{L}{c/(2n+1)} = (2n+1) \\frac{L}{c}\n    $$\n    Notably, this can be expressed in terms of the Kelvin wave crossing time:\n    $$\n    T_R = (2n+1) T_K\n    $$\n\n3.  **Total Round-Trip Time ($T_{\\text{tot}}$)**\n\n    The total time for the signal to cross as a Kelvin wave and return as a Rossby wave is the sum of the individual transit times:\n    $$\n    T_{\\text{tot}} = T_K + T_R = T_K + (2n+1)T_K = (2n+2)T_K = 2(n+1)T_K\n    $$\n\n4.  **Ratio ($r$) and `within` Condition**\n\n    The ratio of the calculated round-trip time to the reference ENSO period is:\n    $$\n    r = \\frac{T_{\\text{tot}}}{T_{\\text{ref}}}\n    $$\n    The boolean value `within` is determined by checking if $T_{\\text{tot}}$ falls within the range $[2.0, 7.0]$ years.\n\nWe use the following constants for calculation:\n*   Gravitational acceleration: $g = 9.81\\,\\text{m}\\,\\text{s}^{-2}$\n*   Seconds per year: $1\\,\\text{year} = 365 \\times 86400\\,\\text{s} = 31,536,000\\,\\text{s}$\n*   Reference ENSO duration: $T_{\\text{ref}} = 3.5\\,\\text{years}$\n\nThe calculations for each test case are as follows:\n\n**Case A: $L = 1.5 \\times 10^7\\,\\text{m}$, $H = 0.5\\,\\text{m}$, $n = 1$**\n*   $c = \\sqrt{9.81 \\times 0.5} \\approx 2.2147\\,\\text{m/s}$\n*   $T_K = (1.5 \\times 10^7\\,\\text{m}) / (2.2147\\,\\text{m/s}) \\approx 6.7728 \\times 10^6\\,\\text{s} \\approx 0.215\\,\\text{years}$\n*   $T_R = (2 \\cdot 1 + 1) T_K = 3 \\times 0.215\\,\\text{years} = 0.645\\,\\text{years}$ (recalculating from unrounded $T_K$ gives $0.644$ years)\n*   $T_{\\text{tot}} = T_K + T_R \\approx 0.215 + 0.644 = 0.859\\,\\text{years}$\n*   $r = 0.859 / 3.5 \\approx 0.245$\n*   `within` is $2.0 \\le 0.859 \\le 7.0$, which is `False`.\n*   Result: `[0.215, 0.644, 0.859, 0.245, False]`\n\n**Case B: $L = 1.5 \\times 10^7\\,\\text{m}$, $H = 0.3\\,\\text{m}$, $n = 1$**\n*   $c = \\sqrt{9.81 \\times 0.3} \\approx 1.7155\\,\\text{m/s}$\n*   $T_K = (1.5 \\times 10^7\\,\\text{m}) / (1.7155\\,\\text{m/s}) \\approx 8.7438 \\times 10^6\\,\\text{s} \\approx 0.277\\,\\text{years}$\n*   $T_R = (2 \\cdot 1 + 1) T_K = 3 \\times 0.277\\,\\text{years} = 0.831\\,\\text{years}$\n*   $T_{\\text{tot}} = T_K + T_R \\approx 0.277 + 0.831 = 1.108\\,\\text{years}$\n*   $r = 1.108 / 3.5 \\approx 0.317$\n*   `within` is $2.0 \\le 1.108 \\le 7.0$, which is `False`.\n*   Result: `[0.277, 0.831, 1.108, 0.317, False]`\n\n**Case C: $L = 1.5 \\times 10^7\\,\\text{m}$, $H = 1.0\\,\\text{m}$, $n = 2$**\n*   $c = \\sqrt{9.81 \\times 1.0} \\approx 3.1321\\,\\text{m/s}$\n*   $T_K = (1.5 \\times 10^7\\,\\text{m}) / (3.1321\\,\\text{m/s}) \\approx 4.7891 \\times 10^6\\,\\text{s} \\approx 0.152\\,\\text{years}$\n*   $T_R = (2 \\cdot 2 + 1) T_K = 5 \\times 0.152\\,\\text{years} = 0.760\\,\\text{years}$\n*   $T_{\\text{tot}} = T_K + T_R \\approx 0.152 + 0.760 = 0.912\\,\\text{years}$\n*   $r = 0.912 / 3.5 \\approx 0.261$\n*   `within` is $2.0 \\le 0.912 \\le 7.0$, which is `False`.\n*   Result: `[0.152, 0.760, 0.912, 0.261, False]`\n\n**Case D: $L = 1.0 \\times 10^7\\,\\text{m}$, $H = 0.2\\,\\text{m}$, $n = 3$**\n*   $c = \\sqrt(9.81 \\times 0.2) \\approx 1.4007\\,\\text{m/s}$\n*   $T_K = (1.0 \\times 10^7\\,\\text{m}) / (1.4007\\,\\text{m/s}) \\approx 7.1392 \\times 10^6\\,\\text{s} \\approx 0.226\\,\\text{years}$\n*   $T_R = (2 \\cdot 3 + 1) T_K = 7 \\times 0.226\\,\\text{years} = 1.582\\,\\text{years}$\n*   $T_{\\text{tot}} = T_K + T_R \\approx 0.226 + 1.582 = 1.808\\,\\text{years}$\n*   $r = 1.808 / 3.5 \\approx 0.517$\n*   `within` is $2.0 \\le 1.808 \\le 7.0$, which is `False`.\n*   Result: `[0.226, 1.584, 1.810, 0.517, False]` (Re-running with higher precision gives slightly different rounded values).\n\n**Case E: $L = 1.7 \\times 10^7\\,\\text{m}$, $H = 0.05\\,\\text{m}$, $n = 2$**\n*   $c = \\sqrt(9.81 \\times 0.05) \\approx 0.7004\\,\\text{m/s}$\n*   $T_K = (1.7 \\times 10^7\\,\\text{m}) / (0.7004\\,\\text{m/s}) \\approx 2.4273 \\times 10^7\\,\\text{s} \\approx 0.770\\,\\text{years}$\n*   $T_R = (2 \\cdot 2 + 1) T_K = 5 \\times 0.770\\,\\text{years} = 3.850\\,\\text{years}$\n*   $T_{\\text{tot}} = T_K + T_R \\approx 0.770 + 3.850 = 4.620\\,\\text{years}$\n*   $r = 4.620 / 3.5 \\approx 1.320$\n*   `within` is $2.0 \\le 4.620 \\le 7.0$, which is `True`.\n*   Result: `[0.770, 3.849, 4.619, 1.320, True]` (Re-running with higher precision gives slightly different rounded values).\n\nThe code in the `final_answer` section will perform these calculations precisely and format the output as specified.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes equatorial wave transit times and their relation to ENSO periodicity.\n    \"\"\"\n    # Physical constants and reference values\n    g = 9.81  # Gravitational acceleration, m/s^2\n    T_ref_years = 3.5  # Reference ENSO duration, years\n    seconds_per_year = 365 * 86400  # Conversion factor\n\n    # Test suite: (L, H, n)\n    test_cases = [\n        (1.5e7, 0.5, 1),   # Case A\n        (1.5e7, 0.3, 1),   # Case B\n        (1.5e7, 1.0, 2),   # Case C\n        (1.0e7, 0.2, 3),   # Case D\n        (1.7e7, 0.05, 2),  # Case E\n    ]\n\n    all_results = []\n    \n    for L, H, n in test_cases:\n        # Step 1: Calculate Kelvin wave speed and crossing time\n        # c = sqrt(g * H)\n        # T_K = L / c\n        c = np.sqrt(g * H)\n        T_K_seconds = L / c\n        T_K_years = T_K_seconds / seconds_per_year\n        \n        # Step 2: Calculate Rossby wave return time\n        # The phase speed of a long Rossby wave is c_R = c / (2n + 1).\n        # T_R = L / c_R = L / (c / (2n + 1)) = (2n + 1) * (L / c) = (2n + 1) * T_K\n        T_R_seconds = (2 * n + 1) * T_K_seconds\n        T_R_years = T_R_seconds / seconds_per_year\n\n        # Step 3: Calculate total round-trip time\n        T_tot_years = T_K_years + T_R_years\n\n        # Step 4: Calculate the ratio to the reference ENSO period\n        r = T_tot_years / T_ref_years\n\n        # Step 5: Check if the total time is within the typical ENSO range\n        is_within = 2.0 = T_tot_years = 7.0\n        \n        # Round results to three decimal places as required\n        T_K_rounded = round(T_K_years, 3)\n        T_R_rounded = round(T_R_years, 3)\n        T_tot_rounded = round(T_tot_years, 3)\n        r_rounded = round(r, 3)\n        \n        # Collect the results for this case\n        case_result = [T_K_rounded, T_R_rounded, T_tot_rounded, r_rounded, is_within]\n        all_results.append(case_result)\n\n    # Format the final output string exactly as required: [[...],[...],...]\n    inner_strings = [f\"[{','.join(map(str, res))}]\" for res in all_results]\n    output_string = f\"[{','.join(inner_strings)}]\"\n    \n    print(output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "Moving from pure theory to numerical modeling, this exercise guides you through building and evaluating a simple hybrid coupled model for ENSO. You will implement a system where a simplified dynamical ocean is forced by a statistical atmosphere, a common approach for intermediate complexity models. This practice  provides hands-on experience with the full modeling cycle: implementing the physics, running a simulation, and analyzing the output to see if it successfully reproduces key observed statistics of ENSO.",
            "id": "4038384",
            "problem": "Design and implement a hybrid model for El Niño–Southern Oscillation (ENSO) representation that couples a statistical atmosphere to a dynamical ocean. The statistical component is an autoregressive atmospheric wind-stress anomaly model driven by sea surface temperature anomalies, and the ocean component is a linear dynamical system for sea surface temperature and thermocline depth anomalies. The goal is to evaluate whether the hybrid model reproduces key observed ENSO statistics.\n\nStart from the following fundamental bases and core definitions:\n\n- The ocean mixed-layer heat budget can be idealized as a linear tendency for sea surface temperature anomaly $T$ driven by local damping, subsurface thermocline anomalies $h$, and surface wind-stress anomaly $\\tau$: \n$$\n\\frac{dT}{dt} = -a\\,T + b\\,h + c\\,\\tau + \\eta_T,\n$$\nwhere $a$, $b$, and $c$ are positive constants and $\\eta_T$ is a small stochastic process noise representing unresolved processes.\n\n- The recharge-discharge framework for thermocline depth anomaly $h$ posits linear coupling to $T$ with damping:\n$$\n\\frac{dh}{dt} = -d\\,T - e\\,h,\n$$\nwith $d>0$ and $e>0$.\n\n- The statistical atmosphere is represented as a first-order autoregression for wind-stress anomaly $\\tau$ with memory and linear feedback on the previous month’s $T$, plus weather noise $\\epsilon$:\n$$\n\\tau_t = \\rho\\,\\tau_{t-1} + \\alpha\\,T_{t-1} + \\sigma_\\tau\\,\\epsilon_t,\n$$\nwhere $|\\rho|1$, $\\alpha$ is the coupling coefficient, $\\sigma_\\tau$ is the noise amplitude, and $\\epsilon_t$ are independent standard normal variates.\n\n- Discretize the ocean equations using forward Euler with a fixed monthly time step $\\Delta t = 1$ month:\n$$\nT_{t+1} = T_t + \\Delta t\\left(-a\\,T_t + b\\,h_t + c\\,\\tau_t\\right) + \\sigma_T \\,\\xi_t,\\quad\nh_{t+1} = h_t + \\Delta t\\left(-d\\,T_t - e\\,h_t\\right),\n$$\nwhere $\\xi_t$ are independent standard normal variates and $\\sigma_T$ is the process noise amplitude. All parameters $a$, $b$, $c$, $d$, $e$ are in units of month$^{-1}$ or consistent with the discretization; $T$ is in kelvin ($\\mathrm{K}$), $h$ in meters ($\\mathrm{m}$), and $\\tau$ in newton per square meter ($\\mathrm{N\\,m^{-2}}$).\n\nImplementation tasks:\n\n1. Implement the coupled system above with $\\Delta t = 1$ month. Use a fixed-length integration of $N_{\\text{total}} = 6000$ months and discard the first $N_{\\text{spin}} = 1000$ months as spin-up. Use a fixed random seed for reproducibility.\n\n2. Define a “truth” or “observational” target by simulating the system with the parameter vector\n$$\n\\theta^{\\mathrm{obs}} = (a,e,b,d,\\rho,\\alpha,c,\\sigma_\\tau,\\sigma_T) = (0.08,\\,0.08,\\,0.4,\\,0.05,\\,0.7,\\,0.04,\\,0.1,\\,0.5,\\,0.05).\n$$\nFrom the last $N_{\\text{analysis}} = 5000$ months of the $T$ time series (after removing the mean), compute:\n- The variance $V_{\\mathrm{obs}}$ in $\\mathrm{K^2}$.\n- The dominant spectral period $P_{\\mathrm{obs}}$ in months, defined as the period corresponding to the largest Fourier power within the band of $24$ to $96$ months. If no discrete frequency falls in-band, select the single closest nonzero Fourier frequency to that band and use its period.\n- The lag-$1$ autocorrelation $R_{\\mathrm{obs}}$ (dimensionless), using the Pearson correlation between $T_{t}$ and $T_{t-1}$ over the analysis segment.\n\n3. For each test case parameter vector $\\theta$, simulate the hybrid model and compute the corresponding statistics $V_{\\theta}$, $P_{\\theta}$, and $R_{\\theta}$ in the same units and using the same definitions as in the observational target. For each test case, compute the following three scalar errors:\n- Relative variance error $E_V = \\left|V_{\\theta}-V_{\\mathrm{obs}}\\right|/V_{\\mathrm{obs}}$ (dimensionless, expressed as a decimal).\n- Relative dominant period error $E_P = \\left|P_{\\theta}-P_{\\mathrm{obs}}\\right|/P_{\\mathrm{obs}}$ (dimensionless, expressed as a decimal).\n- Absolute lag-$1$ autocorrelation error $E_R = \\left|R_{\\theta}-R_{\\mathrm{obs}}\\right|$ (dimensionless).\n\n4. A test case is deemed a “success” if $E_V \\le 0.3$, $E_P \\le 0.25$, and $E_R \\le 0.1$. Otherwise, it is a “failure.”\n\nPhysical and numerical units:\n- Report $V_{\\mathrm{obs}}$ and $V_{\\theta}$ implicitly in $\\mathrm{K^2}$; no printing of these values is required, only the boolean pass/fail is used internally.\n- Report $P_{\\mathrm{obs}}$ and $P_{\\theta}$ implicitly in months; no printing of these values is required, only the boolean pass/fail is used internally.\n- Report $R_{\\mathrm{obs}}$ and $R_{\\theta}$ as dimensionless quantities; no printing of these values is required, only the boolean pass/fail is used internally.\n\nTest suite:\nUse the following four parameter vectors for evaluation, each in the order $(a,e,b,d,\\rho,\\alpha,c,\\sigma_\\tau,\\sigma_T)$ with units consistent with the discretization. All numbers are to be interpreted per definition above.\n\n- Case $1$ (near-observational): $(0.08,\\,0.08,\\,0.4,\\,0.05,\\,0.7,\\,0.038,\\,0.09,\\,0.55,\\,0.05)$.\n- Case $2$ (weak coupling): $(0.08,\\,0.08,\\,0.4,\\,0.05,\\,0.7,\\,0.0,\\,0.05,\\,0.4,\\,0.05)$.\n- Case $3$ (strong damping): $(0.2,\\,0.2,\\,0.4,\\,0.05,\\,0.7,\\,0.04,\\,0.1,\\,0.5,\\,0.05)$.\n- Case $4$ (strong atmospheric memory and forcing): $(0.08,\\,0.08,\\,0.4,\\,0.05,\\,0.9,\\,0.06,\\,0.12,\\,0.8,\\,0.05)$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each entry is a boolean indicating the success or failure for a corresponding test case in the order listed above. For example, an output for four cases should look like $[True,False,True,False]$. No additional text should be printed.",
            "solution": "The problem is assessed as valid. It presents a well-posed, scientifically grounded task within the field of climate modeling, with all necessary parameters and methods clearly defined.\n\nThe objective is to implement a hybrid coupled model for the El Niño–Southern Oscillation (ENSO), analyze its output, and evaluate its performance against a set of predefined criteria. The model couples a simplified dynamical ocean to a statistical atmosphere.\n\nFirst, we formalize the complete discrete-time system. The state of the model at any time step $t$ is described by the vector $(T_t, h_t, \\tau_t)$, representing the sea surface temperature anomaly, thermocline depth anomaly, and wind-stress anomaly, respectively. Given the state at time $t$, the state at time $t+1$ is calculated using the following set of coupled, stochastic difference equations, where the time step $\\Delta t$ is given as $1$ month.\n\nThe sea surface temperature anomaly $T_{t+1}$ is updated based on its value at the previous time step, $T_t$. The update includes a damping term $-a\\,T_t$, a coupling to the thermocline depth anomaly $b\\,h_t$, a forcing from the atmospheric wind-stress anomaly $c\\,\\tau_t$, and a stochastic noise term $\\sigma_T\\,\\xi_t$ representing unresolved oceanic processes. With $\\Delta t = 1$, the equation is:\n$$\nT_{t+1} = T_t + (1)\\left(-a\\,T_t + b\\,h_t + c\\,\\tau_t\\right) + \\sigma_T \\,\\xi_t = (1-a)T_t + b\\,h_t + c\\,\\tau_t + \\sigma_T\\,\\xi_t\n$$\nHere, $\\xi_t$ is an independent random variate drawn from a standard normal distribution $\\mathcal{N}(0,1)$.\n\nThe thermocline depth anomaly $h_{t+1}$ follows the recharge-discharge framework. Its evolution depends on forcing from the sea surface temperature anomaly $-d\\,T_t$ and its own damping $-e\\,h_t$. The discrete update equation, with $\\Delta t = 1$, is:\n$$\nh_{t+1} = h_t + (1)\\left(-d\\,T_t - e\\,h_t\\right) = (1-e)h_t - d\\,T_t\n$$\nThis equation is deterministic, containing no stochastic forcing term as per the problem statement.\n\nThe atmospheric wind-stress anomaly $\\tau_{t+1}$ is modeled as a first-order autoregressive process. It has a memory of its previous state $\\rho\\,\\tau_t$, is forced by the sea surface temperature anomaly from the same time step $\\alpha\\,T_t$, and includes an atmospheric weather noise term $\\sigma_\\tau\\,\\epsilon_{t+1}$. The equation is:\n$$\n\\tau_{t+1} = \\rho\\,\\tau_t + \\alpha\\,T_t + \\sigma_\\tau\\,\\epsilon_{t+1}\n$$\nHere, $\\epsilon_{t+1}$ is another independent random variate drawn from $\\mathcal{N}(0,1)$, distinct from $\\xi_t$. The condition $|\\rho|  1$ ensures the stationarity of the atmospheric process in the absence of coupling.\n\nThe implementation proceeds by first defining a master function that executes the simulation and subsequent analysis for a given parameter vector $\\theta = (a,e,b,d,\\rho,\\alpha,c,\\sigma_\\tau,\\sigma_T)$. This function will perform the following steps:\n\n1.  **Initialization**: Set the total simulation length $N_{\\text{total}} = 6000$ months and the spin-up period $N_{\\text{spin}} = 1000$ months. Initialize arrays of length $N_{\\text{total}}$ for the time series of $T$, $h$, and $\\tau$ with initial conditions $T_0=0$, $h_0=0$, and $\\tau_0=0$. A fixed random seed is used to ensure reproducibility of the stochastic noise sequences $\\xi_t$ and $\\epsilon_t$.\n\n2.  **Time Integration**: A loop runs from $t=0$ to $t=N_{\\text{total}}-2$. In each iteration, the values of $T_{t+1}$, $h_{t+1}$, and $\\tau_{t+1}$ are calculated from the values at time $t$ using the discrete equations defined above. Two independent standard normal random numbers are generated at each step for $\\xi_t$ and $\\epsilon_{t+1}$.\n\n3.  **Statistical Analysis**: After the integration is complete, the last $N_{\\text{analysis}} = N_{\\text{total}} - N_{\\text{spin}} = 5000$ months of the $T$ time series are extracted for analysis.\n    - The mean of this analysis segment is calculated and subtracted to produce a zero-mean anomaly series.\n    - The variance $V$ is computed from this demeaned series.\n    - The lag-$1$ autocorrelation $R$ is calculated as the Pearson correlation coefficient between the series and a one-month-shifted version of itself.\n    - The dominant spectral period $P$ is determined via Fourier analysis. The real Fast Fourier Transform (FFT) is applied to the demeaned series to obtain the power spectrum. The corresponding frequencies $f$ are calculated. We search for the frequency associated with the maximum power within the period band of $24$ to $96$ months (equivalent to a frequency band of $[1/96, 1/24]$ cycles/month). If this frequency band contains no discrete Fourier frequencies from the analysis, a fallback rule is applied: the nonzero frequency closest to this band is selected. The dominant period is then $P = 1/f_{\\text{peak}}$.\n\n4.  **Evaluation**: The process above is first run with the \"observational\" parameter vector $\\theta^{\\mathrm{obs}}$ to establish the target statistics $V_{\\mathrm{obs}}$, $P_{\\mathrm{obs}}$, and $R_{\\mathrm{obs}}$. Subsequently, for each test case parameter vector $\\theta$, the process is repeated to find $V_{\\theta}$, $P_{\\theta}$, and $R_{\\theta}$. The three error metrics are then computed:\n    - Relative variance error: $E_V = |V_{\\theta}-V_{\\mathrm{obs}}|/V_{\\mathrm{obs}}$\n    - Relative dominant period error: $E_P = |P_{\\theta}-P_{\\mathrm{obs}}|/P_{\\mathrm{obs}}$\n    - Absolute autocorrelation error: $E_R = |R_{\\theta}-R_{\\mathrm{obs}}|$\n    A test case is successful if and only if $E_V \\le 0.3$, $E_P \\le 0.25$, and $E_R \\le 0.1$. The final output is a list of boolean values indicating success or failure for each test case.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the hybrid ENSO model simulation and evaluation.\n    \"\"\"\n    \n    # --------------------------\n    # CONFIGURATION\n    # --------------------------\n    N_TOTAL = 6000  # Total integration months\n    N_SPIN = 1000   # Spin-up months to discard\n    DT = 1.0        # Time step in months\n    RANDOM_SEED = 42 # Fixed seed for reproducibility\n    \n    # \"Observational\" target parameter vector\n    # Order: (a, e, b, d, rho, alpha, c, sigma_tau, sigma_T)\n    theta_obs = (0.08, 0.08, 0.4, 0.05, 0.7, 0.04, 0.1, 0.5, 0.05)\n    \n    # Test cases parameter vectors\n    test_cases = [\n        (0.08, 0.08, 0.4, 0.05, 0.7, 0.038, 0.09, 0.55, 0.05),  # Case 1\n        (0.08, 0.08, 0.4, 0.05, 0.7, 0.0, 0.05, 0.4, 0.05),      # Case 2\n        (0.2, 0.2, 0.4, 0.05, 0.7, 0.04, 0.1, 0.5, 0.05),        # Case 3\n        (0.08, 0.08, 0.4, 0.05, 0.9, 0.06, 0.12, 0.8, 0.05),     # Case 4\n    ]\n\n    def run_model_and_get_stats(params, seed, n_total, n_spin, dt):\n        \"\"\"\n        Runs the coupled model for a given set of parameters and computes statistics.\n        \n        Args:\n            params (tuple): Parameter vector in the order (a,e,b,d,rho,alpha,c,sigma_tau,sigma_T).\n            seed (int): Random seed.\n            n_total (int): Total number of simulation months.\n            n_spin (int): Number of spin-up months.\n            dt (float): Time step.\n            \n        Returns:\n            tuple: (Variance, Dominant Period, Lag-1 Autocorrelation).\n        \"\"\"\n        # Unpack parameters carefully according to the specified order\n        a, e, b, d, rho, alpha, c, sigma_tau, sigma_T = params\n\n        # Initialize random number generator\n        rng = np.random.default_rng(seed)\n\n        # Initialize state variable arrays\n        T = np.zeros(n_total)\n        h = np.zeros(n_total)\n        tau = np.zeros(n_total)\n\n        # Time-stepping loop\n        for t in range(n_total - 1):\n            # Generate stochastic forcing terms\n            xi = rng.standard_normal()\n            epsilon = rng.standard_normal()\n            \n            # Update T (Sea Surface Temperature Anomaly)\n            T[t+1] = T[t] + dt * (-a * T[t] + b * h[t] + c * tau[t]) + sigma_T * xi\n            \n            # Update h (Thermocline Depth Anomaly)\n            h[t+1] = h[t] + dt * (-d * T[t] - e * h[t])\n            \n            # Update tau (Wind-stress Anomaly)\n            tau[t+1] = rho * tau[t] + alpha * T[t] + sigma_tau * epsilon\n\n        # --- STATISTICAL ANALYSIS ---\n        \n        # Extract analysis part after spin-up and demean\n        T_analysis = T[n_spin:]\n        T_analysis -= np.mean(T_analysis)\n        n_analysis = len(T_analysis)\n        \n        # 1. Variance\n        variance = np.var(T_analysis)\n        \n        # 2. Lag-1 Autocorrelation\n        lag1_autocorr = np.corrcoef(T_analysis[:-1], T_analysis[1:])[0, 1]\n        \n        # 3. Dominant Period\n        # Compute FFT and power spectrum\n        yf = np.fft.rfft(T_analysis)\n        xf = np.fft.rfftfreq(n_analysis, d=dt)\n        power = np.abs(yf)**2\n        \n        # Define frequency band\n        min_period, max_period = 24.0, 96.0\n        min_freq, max_freq = 1.0 / max_period, 1.0 / min_period\n        \n        # Find frequencies within the band\n        band_indices = np.where((xf = min_freq)  (xf = max_freq))[0]\n        \n        if len(band_indices)  0:\n            # Find frequency with max power within the band\n            peak_power_index_in_band = np.argmax(power[band_indices])\n            peak_index = band_indices[peak_power_index_in_band]\n            peak_freq = xf[peak_index]\n        else:\n            # Fallback: find the single closest non-zero Fourier frequency to the band\n            nonzero_freq_indices = np.where(xf  0)[0]\n            if len(nonzero_freq_indices) == 0:\n                # This case is highly unlikely for this problem but handled for robustness\n                dominant_period = np.nan\n                return variance, dominant_period, lag1_autocorr\n\n            nonzero_freqs = xf[nonzero_freq_indices]\n            \n            # Calculate distance of each frequency to the band [min_freq, max_freq]\n            # Distance is 0 if inside, positive otherwise\n            distances = np.maximum(min_freq - nonzero_freqs, nonzero_freqs - max_freq)\n            closest_freq_local_idx = np.argmin(distances)\n            peak_index = nonzero_freq_indices[closest_freq_local_idx]\n            peak_freq = xf[peak_index]\n\n        dominant_period = 1.0 / peak_freq if peak_freq  0 else np.inf\n        \n        return variance, dominant_period, lag1_autocorr\n\n    # --- MAIN EXECUTION ---\n    \n    # Calculate \"observational\" statistics\n    V_obs, P_obs, R_obs = run_model_and_get_stats(\n        theta_obs, RANDOM_SEED, N_TOTAL, N_SPIN, DT\n    )\n\n    results = []\n    for theta_case in test_cases:\n        # Calculate statistics for the test case\n        V_theta, P_theta, R_theta = run_model_and_get_stats(\n            theta_case, RANDOM_SEED, N_TOTAL, N_SPIN, DT\n        )\n        \n        # Compute errors\n        E_V = abs(V_theta - V_obs) / V_obs\n        E_P = abs(P_theta - P_obs) / P_obs\n        E_R = abs(R_theta - R_obs)\n        \n        # Check success criteria\n        is_success = (E_V = 0.3) and (E_P = 0.25) and (E_R = 0.1)\n        results.append(is_success)\n\n    # Format and print the final output\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}