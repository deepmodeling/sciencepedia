{
    "hands_on_practices": [
        {
            "introduction": "大气环流的根本驱动力是赤道与两极之间的温差。热成风关系为我们提供了关键的动力学联系，将这种温度梯度与风的垂直结构联系起来。这项练习将让你直接应用热成风方程，将给定的经向温度梯度转化为急流核心处的具体风速，从而巩固你对差异加热如何催生中纬度西风急流的理解。",
            "id": "4050690",
            "problem": "在一个代表了三圈经向环流（哈德莱环流、费雷尔环流和极地环流）的纬向平均、静力平衡和地转平衡的大气中，纬向平均风的垂直切变通过气压坐标系中的热成风关系与经向温度梯度相关联，\n$$\nf\\,\\frac{\\partial \\overline{u}}{\\partial \\ln p} = R\\,\\frac{\\partial \\overline{T}}{\\partial y},\n$$\n其中 $f$ 是科里奥利参数，$\\overline{u}$ 是纬向平均地转风，$p$ 是气压，$R$ 是干空气比气体常数，$\\overline{T}$ 是纬向平均温度，$y$ 是经向坐标。考虑一个与费雷尔环流相关的中纬度急流，其中对流层的平均经向温度梯度在 $p=900\\ \\mathrm{hPa}$ 和 $p=200\\ \\mathrm{hPa}$ 之间随高度近似恒定。假设条件为稳定、绝热、无粘性，并忽略曲率和非地转项。\n\n给定 $f=5\\times 10^{-5}\\ \\mathrm{s^{-1}}$，$R=287\\ \\mathrm{J\\ kg^{-1}\\ K^{-1}}$，对流层平均经向温度梯度 $\\partial \\overline{T}/\\partial y = -1.5\\times 10^{-6}\\ \\mathrm{K\\ m^{-1}}$ 在该层内不随 $p$ 变化，以及对流层低层的参考值 $\\overline{u}=0$ 在 $p=900\\ \\mathrm{hPa}$，计算在 $p=200\\ \\mathrm{hPa}$ 处的纬向平均急流核心风速 $\\overline{u}$。\n\n以 $\\mathrm{m\\ s^{-1}}$ 为单位表示你的最终答案，并将结果四舍五入到四位有效数字。",
            "solution": "该问题提供了气压坐标系中的热成风关系，并要求在给定一组大气参数的情况下，计算特定气压层上的纬向平均风速。\n\n首先，对问题陈述进行验证。\n\n**步骤1：提取给定条件**\n-   控制方程，即热成风关系为：\n    $$\n    f\\,\\frac{\\partial \\overline{u}}{\\partial \\ln p} = R\\,\\frac{\\partial \\overline{T}}{\\partial y}\n    $$\n-   $f$: 科里奥利参数，给定为 $5 \\times 10^{-5}\\ \\mathrm{s^{-1}}$。\n-   $\\overline{u}$: 纬向平均地转风。\n-   $p$: 气压。\n-   $R$: 干空气比气体常数，给定为 $287\\ \\mathrm{J\\ kg^{-1}\\ K^{-1}}$。\n-   $\\overline{T}$: 纬向平均温度。\n-   $y$: 经向坐标。\n-   $\\frac{\\partial \\overline{T}}{\\partial y}$: 经向温度梯度，在该气压层上为常数 $-1.5 \\times 10^{-6}\\ \\mathrm{K\\ m^{-1}}$。\n-   下边界条件：在气压 $p_0 = 900\\ \\mathrm{hPa}$ 处，$\\overline{u} = 0$。\n-   上气压层：$p_1 = 200\\ \\mathrm{hPa}$。\n-   目标：计算在 $p_1 = 200\\ \\mathrm{hPa}$ 处的 $\\overline{u}$。\n\n**步骤2：使用提取的给定条件进行验证**\n-   **科学依据：**该问题基于热成风平衡，这是地球物理流体动力学的基石之一。所提供的方程是该关系的标准形式。所有给定的数值，包括 $f$、$R$ 和 $\\frac{\\partial \\overline{T}}{\\partial y}$，对于地球大气来说在物理上是现实的。气压层也是标准的。假设经向温度梯度随高度恒定是此类问题的常见简化。\n-   **适定性：**该问题为函数 $\\overline{u}$ 提供了一个关于变量 $\\ln p$ 的一阶常微分方程。在特定气压 $p_0$ 处给出了 $\\overline{u}$ 的一个边界条件。该问题是适定的，并有唯一解。\n-   **目标明确：**问题陈述使用了精确、定量和无偏见的语言。\n-   该问题没有说明中列出的任何缺陷。它在科学上是合理的，结构上是形式化的，内容是完整的，并且是可行的。\n\n**步骤3：结论与行动**\n-   该问题是**有效的**。将提供解答。\n\n**求解过程**\n\n起点是热成风关系：\n$$\nf\\,\\frac{\\partial \\overline{u}}{\\partial \\ln p} = R\\,\\frac{\\partial \\overline{T}}{\\partial y}\n$$\n我们想求出在两个气压层 $p_0$ 和 $p_1$ 之间纬向风 $\\overline{u}$ 的变化。我们可以重新整理方程以求解 $\\overline{u}$ 的微分：\n$$\nd\\overline{u} = \\frac{R}{f} \\left( \\frac{\\partial \\overline{T}}{\\partial y} \\right) d(\\ln p)\n$$\n问题陈述指出，经向温度梯度 $\\frac{\\partial \\overline{T}}{\\partial y}$ 在所关注的层内随高度恒定，因此也相对于气压是恒定的。参数 $R$ 和 $f$ 也是常数。因此，整个项 $\\frac{R}{f} \\left( \\frac{\\partial \\overline{T}}{\\partial y} \\right)$ 是一个常数。\n\n我们可以将该方程从低气压层 $p_0 = 900\\ \\mathrm{hPa}$ 积分到高气压层 $p_1 = 200\\ \\mathrm{hPa}$。设 $\\overline{u}_0 = \\overline{u}(p_0)$ 和 $\\overline{u}_1 = \\overline{u}(p_1)$。\n$$\n\\int_{\\overline{u}_0}^{\\overline{u}_1} d\\overline{u} = \\int_{\\ln p_0}^{\\ln p_1} \\frac{R}{f} \\left( \\frac{\\partial \\overline{T}}{\\partial y} \\right) d(\\ln p)\n$$\n由于被积函数右侧的项是常数，我们可以将其从积分中提出：\n$$\n\\overline{u}_1 - \\overline{u}_0 = \\frac{R}{f} \\left( \\frac{\\partial \\overline{T}}{\\partial y} \\right) \\int_{\\ln p_0}^{\\ln p_1} d(\\ln p)\n$$\n计算该积分得到：\n$$\n\\overline{u}_1 - \\overline{u}_0 = \\frac{R}{f} \\left( \\frac{\\partial \\overline{T}}{\\partial y} \\right) [\\ln p]_{\\ln p_0}^{\\ln p_1} = \\frac{R}{f} \\left( \\frac{\\partial \\overline{T}}{\\partial y} \\right) (\\ln p_1 - \\ln p_0)\n$$\n使用对数性质 $\\ln p_1 - \\ln p_0 = \\ln\\left(\\frac{p_1}{p_0}\\right)$，方程变为：\n$$\n\\overline{u}_1 - \\overline{u}_0 = \\frac{R}{f} \\left( \\frac{\\partial \\overline{T}}{\\partial y} \\right) \\ln\\left(\\frac{p_1}{p_0}\\right)\n$$\n我们给定的数值如下：\n-   $p_1 = 200\\ \\mathrm{hPa}$\n-   $p_0 = 900\\ \\mathrm{hPa}$\n-   $\\overline{u}_0 = \\overline{u}(900\\ \\mathrm{hPa}) = 0\\ \\mathrm{m\\ s^{-1}}$\n-   $f = 5 \\times 10^{-5}\\ \\mathrm{s^{-1}}$\n-   $R = 287\\ \\mathrm{J\\ kg^{-1}\\ K^{-1}}$\n-   $\\frac{\\partial \\overline{T}}{\\partial y} = -1.5 \\times 10^{-6}\\ \\mathrm{K\\ m^{-1}}$\n\n我们要求解 $\\overline{u}_1 = \\overline{u}(200\\ \\mathrm{hPa})$。将给定值代入方程：\n$$\n\\overline{u}_1 - 0 = \\frac{287}{5 \\times 10^{-5}} \\left( -1.5 \\times 10^{-6} \\right) \\ln\\left(\\frac{200}{900}\\right)\n$$\n对数项中的气压单位相互抵消。我们来分析其他项的单位以验证量纲。$R/f$ 的单位是 $(\\mathrm{J\\ kg^{-1}\\ K^{-1}}) / (\\mathrm{s^{-1}}) = (\\mathrm{m^2\\ s^{-2}\\ K^{-1}}) / (\\mathrm{s^{-1}}) = \\mathrm{m^2\\ s^{-1}\\ K^{-1}}$。将其乘以 $\\partial \\overline{T}/\\partial y$ 的单位 $\\mathrm{K\\ m^{-1}}$，我们得到 $(\\mathrm{m^2\\ s^{-1}\\ K^{-1}}) \\times (\\mathrm{K\\ m^{-1}}) = \\mathrm{m\\ s^{-1}}$，这是速度的单位。因此计算是量纲一致的。\n\n现在，我们进行数值计算：\n$$\n\\overline{u}_1 = \\frac{287 \\times (-1.5 \\times 10^{-6})}{5 \\times 10^{-5}} \\ln\\left(\\frac{2}{9}\\right)\n$$\n$$\n\\overline{u}_1 = \\frac{-430.5 \\times 10^{-6}}{5 \\times 10^{-5}} \\ln\\left(\\frac{2}{9}\\right)\n$$\n$$\n\\overline{u}_1 = -86.1 \\times 10^{-1} \\ln\\left(\\frac{2}{9}\\right) = -8.61 \\ln\\left(\\frac{2}{9}\\right)\n$$\n$\\frac{2}{9}$ 的自然对数近似为：\n$$\n\\ln\\left(\\frac{2}{9}\\right) \\approx -1.50407739\n$$\n将此值代回：\n$$\n\\overline{u}_1 \\approx -8.61 \\times (-1.50407739) \\approx 12.95010638 \\ \\mathrm{m\\ s^{-1}}\n$$\n正号表示西风（在正 $x$ 方向），这对于北半球的中纬度急流是预期的，因为在北半球温度向极地递减（$\\partial \\overline{T}/\\partial y  0$）且 $f0$。西风随高度增加（即随气压减小）而增强。\n\n问题要求答案四舍五入到四位有效数字。\n$$\n\\overline{u}_1 \\approx 12.95\\ \\mathrm{m\\ s^{-1}}\n$$",
            "answer": "$$\n\\boxed{12.95}\n$$"
        },
        {
            "introduction": "经典的三圈环流模型是一个简化的图像，它无法完全解释费雷尔环流圈的存在，因为该环流的运行方向与简单的热力正环流相反。其关键在于瞬变涡旋（即天气系统）的影响。这项练习将引入一个强大的诊断工具——Eliassen-Palm（EP）通量，用以量化涡旋与平均流之间的相互作用。通过计算涡旋统计量得出的EP通量散度，你将能诊断出涡旋对平均纬向风的作用力，并推断出剩余平均环流的方向，从而深入理解涡旋是如何维持费雷尔环流的。",
            "id": "4050667",
            "problem": "在北半球纬度 $\\phi=40^\\circ$ 和气压 $p=300\\ \\mathrm{hPa}$ 处，再分析资料提供了纬向平均涡动协方差 $\\overline{u'v'}=-25\\ \\mathrm{m^2\\ s^{-2}}$ 和 $\\overline{v'\\theta'}=0.8\\ \\mathrm{K\\ m\\ s^{-1}}$。使用准地转转换欧拉平均 (TEM) 框架和单位质量的 Eliassen–Palm (EP) 通量，计算该位置的局地 EP 通量散度（平均纬向风的涡动加速度），并推断剩余平均经向速度 $v^*$ 的符号。\n\n使用以下科学上标准的关系和参数：\n- 在球面气压坐标系中，单位质量的 EP 通量分量为\n  $$\n  F_{\\phi}^{(m)}=-\\overline{u'v'},\\qquad \n  F_{p}^{(m)}=\\frac{f}{\\partial\\overline{\\theta}/\\partial p}\\,\\overline{v'\\theta'},\n  $$\n  其中 $f=2\\Omega\\sin\\phi$ 是科里奥利参数。\n- 单位质量 EP 通量的几何散度为\n  $$\n  \\mathcal{D}=\\frac{1}{a\\cos\\phi}\\frac{\\partial}{\\partial\\phi}\\!\\big(\\cos\\phi\\,F_{\\phi}^{(m)}\\big)+\\frac{\\partial F_{p}^{(m)}}{\\partial p}.\n  $$\n- 假设在 $p=300\\ \\mathrm{hPa}$ 附近采用薄层近似，并在 $\\phi=40^\\circ$ 附近采用窄纬度带近似，使得 $\\overline{u'v'}$ 和 $\\overline{v'\\theta'}$ 在 $\\phi$ 和 $p$ 上是局地均匀的，因此对 $\\mathcal{D}$ 的唯一非零贡献来自于球面几何（$\\cos\\phi$ 因子）。\n- 背景参数：行星半径 $a=6.371\\times 10^{6}\\ \\mathrm{m}$，行星自转速率 $\\Omega=7.292\\times 10^{-5}\\ \\mathrm{s^{-1}}$，以及在 $300\\ \\mathrm{hPa}$ 处的平均静力稳定度斜率 $\\partial\\overline{\\theta}/\\partial p=-7.5\\times 10^{-4}\\ \\mathrm{K\\ Pa^{-1}}$。\n\n计算 $\\phi=40^\\circ$ 处的 EP 通量散度 $\\mathcal{D}$ 的数值，将其表示为单位是 $\\mathrm{m\\ s^{-2}}$ 的加速度，并将答案四舍五入至三位有效数字。角度以度为单位。然后，使用稳定、无粘性的领先阶 TEM 纬向平均动量平衡方程 $f\\,v^*=\\mathcal{D}$，推断该位置 $v^*$ 的符号。按要求，最终答案只提供 $\\mathcal{D}$ 的数值；在解题过程中讨论 $v^*$ 的符号。",
            "solution": "本题要求计算在特定纬度和气压下单位质量的 Eliassen–Palm (EP) 通量散度 $\\mathcal{D}$，并随后推断剩余平均经向速度 $v^*$ 的符号。\n\n首先，我们重述给定的物理量和控制方程。\n纬度: $\\phi=40^\\circ$\n纬向平均涡动动量通量: $\\overline{u'v'} = -25\\ \\mathrm{m^2\\ s^{-2}}$\n纬向平均涡动热量通量: $\\overline{v'\\theta'} = 0.8\\ \\mathrm{K\\ m\\ s^{-1}}$\n行星半径: $a=6.371\\times 10^{6}\\ \\mathrm{m}$\n行星自转速率: $\\Omega=7.292\\times 10^{-5}\\ \\mathrm{s^{-1}}$\n平均静力稳定度斜率: $\\frac{\\partial\\overline{\\theta}}{\\partial p}=-7.5\\times 10^{-4}\\ \\mathrm{K\\ Pa^{-1}}$\n\n单位质量的 EP 通量 $F^{(m)}$ 的分量定义如下：\n$$\nF_{\\phi}^{(m)} = -\\overline{u'v'}\n$$\n$$\nF_{p}^{(m)} = \\frac{f}{\\partial\\overline{\\theta}/\\partial p}\\,\\overline{v'\\theta'}\n$$\n其中 $f = 2\\Omega\\sin\\phi$ 是科里奥利参数。\n\n单位质量 EP 通量的散度由下式给出：\n$$\n\\mathcal{D}=\\frac{1}{a\\cos\\phi}\\frac{\\partial}{\\partial\\phi}\\!\\big(\\cos\\phi\\,F_{\\phi}^{(m)}\\big)+\\frac{\\partial F_{p}^{(m)}}{\\partial p}\n$$\n\n题目中说明要假设涡动协方差 $\\overline{u'v'}$ 和 $\\overline{v'\\theta'}$ 在纬度 $\\phi$ 和气压 $p$ 上是局地均匀的。这是一个关键的简化。它意味着在计算散度时，除了乘以几何因子的情况外，EP 通量分量 $F_{\\phi}^{(m)}$ 和 $F_{p}^{(m)}$ 可以被视为关于它们各自空间坐标的常数。\n\n具体来说，对 $p$ 的均匀性假设意味着散度方程中的垂直导数项为零：\n$$\n\\frac{\\partial F_{p}^{(m)}}{\\partial p} \\approx 0\n$$\n对 $\\phi$ 的均匀性假设意味着 $F_{\\phi}^{(m)}$ 本身不是 $\\phi$ 的函数，因此 $\\frac{\\partial F_{\\phi}^{(m)}}{\\partial \\phi} \\approx 0$。\n因此，散度表达式简化为仅由球面几何引起的贡献。对第一项应用乘法法则：\n$$\n\\frac{\\partial}{\\partial\\phi}\\!\\big(\\cos\\phi\\,F_{\\phi}^{(m)}\\big) = \\left(\\frac{\\partial}{\\partial\\phi}\\cos\\phi\\right)F_{\\phi}^{(m)} + \\cos\\phi\\left(\\frac{\\partial F_{\\phi}^{(m)}}{\\partial\\phi}\\right)\n$$\n根据均匀性假设，第二项 $\\cos\\phi\\left(\\frac{\\partial F_{\\phi}^{(m)}}{\\partial\\phi}\\right) \\approx 0$。\n散度 $\\mathcal{D}$ 的表达式简化为：\n$$\n\\mathcal{D} \\approx \\frac{1}{a\\cos\\phi}\\left(\\frac{\\partial}{\\partial\\phi}\\cos\\phi\\right)F_{\\phi}^{(m)} = \\frac{1}{a\\cos\\phi}(-\\sin\\phi)F_{\\phi}^{(m)} = -\\frac{F_{\\phi}^{(m)}}{a}\\tan\\phi\n$$\n\n现在，我们可以计算 $\\mathcal{D}$ 的数值。\n首先，我们计算 EP 通量的纬向分量 $F_{\\phi}^{(m)}$：\n$$\nF_{\\phi}^{(m)} = -\\overline{u'v'} = -(-25\\ \\mathrm{m^2\\ s^{-2}}) = 25\\ \\mathrm{m^2\\ s^{-2}}\n$$\n接下来，我们将 $F_{\\phi}^{(m)}$、$a$ 和 $\\phi$ 的值代入 $\\mathcal{D}$ 的简化表达式。如果手动计算，三角函数参数中的纬度 $\\phi$ 必须以弧度为单位，但标准计算器可以正确处理度。\n$$\n\\mathcal{D} = -\\frac{25\\ \\mathrm{m^2\\ s^{-2}}}{6.371\\times 10^{6}\\ \\mathrm{m}} \\tan(40^\\circ)\n$$\n使用值 $\\tan(40^\\circ) \\approx 0.83910$：\n$$\n\\mathcal{D} \\approx -\\frac{25}{6.371\\times 10^{6}} \\times 0.83910\\ \\mathrm{m\\ s^{-2}}\n$$\n$$\n\\mathcal{D} \\approx -(3.92395 \\times 10^{-6}) \\times 0.83910\\ \\mathrm{m\\ s^{-2}}\n$$\n$$\n\\mathcal{D} \\approx -3.2925 \\times 10^{-6}\\ \\mathrm{m\\ s^{-2}}\n$$\n按要求四舍五入到三位有效数字，我们得到：\n$$\n\\mathcal{D} \\approx -3.29 \\times 10^{-6}\\ \\mathrm{m\\ s^{-2}}\n$$\n$\\mathcal{D}$ 的这个负值表示 EP 通量辐合，它在此位置对平均流起到纬向拖曳的作用。\n\n最后，我们使用稳定、无粘性的领先阶 TEM 纬向平均动量平衡方程来推断剩余平均经向速度 $v^*$ 的符号：\n$$\nf\\,v^* = \\mathcal{D}\n$$\n我们需要确定 $\\phi=40^\\circ$ 处的科里奥利参数 $f$ 的符号。由于该位置在北半球，$\\phi  0$，这意味着 $\\sin\\phi  0$。由于 $\\Omega$ 也是正的，所以 $f = 2\\Omega\\sin\\phi$ 是正的。\n重新整理方程以求解 $v^*$：\n$$\nv^* = \\frac{\\mathcal{D}}{f}\n$$\n我们已经发现 $\\mathcal{D}$ 是负的，并且我们确定了 $f$ 是正的。因此，$v^*$ 的符号由一个负数与一个正数的比值决定：\n$$\n\\mathrm{sign}(v^*) = \\frac{\\mathrm{sign}(\\mathcal{D})}{\\mathrm{sign}(f)} = \\frac{(-)}{(+)} = (-)\n$$\n$v^*$ 的负值表示一个向赤道的剩余平均经向速度。这种高层的向赤道气流是费雷尔环流圈剩余平均环流的一个典型特征，它是由涡动动量通量的辐合驱动的。",
            "answer": "$$\\boxed{-3.29 \\times 10^{-6}}$$"
        },
        {
            "introduction": "在探索了各个独立的动力学关系之后，我们现在可以将这些概念综合起来，构建一个预测模型。哈德莱环流的强度受到一个基本竞争的制约：一方是非绝热加热所需的能量输送，另一方是动量守恒施加的约束。在这项综合性练习中，你将从第一性原理出发，建立一个哈德莱环流的集总标度模型。通过推导和比较能量限制下的质量输送与动量限制下的质量输送，你不仅能预测环流的强度，还能诊断出系统是处于角动量守恒（AMC）状态还是涡旋主导状态，从而亲身体验气候系统理论建模的精髓。",
            "id": "4050682",
            "problem": "考虑一个用于描述旋转球体上大尺度环流的轴对称、纬向平均、稳态的原始方程框架。其目标是为哈德莱环流的质量输送构建一个计算上易于处理的整体标度律，并诊断角动量守恒 (AMC) 环流与涡旋侵蚀的机制。推导和算法必须从以下基本基础出发：\n\n- 旋转球体上的原始方程，其中转动速率为 $\\Omega$，半径为 $a$，重力加速度为 $g$，气压为 $p$。\n- 在纬向平均、稳态、轴对称的假设下，整层积分的连续性方程和动量平衡。\n- 作用于纬向风 $u$ 的线性拖曳参数化，拖曳系数为 $r$。\n- 单位面积的非绝热加热率 $Q$，以及由定压比热 $c_p$ 和代表热带到副热带梯度的给定经向温度差 $\\Delta T$ 所控制的干静力能量输送。\n\n您必须：\n1. 使用能量平衡方程（该方程将热带冠内的积分非绝热加热与哈德莱环流携带的经向干静力能量通量相等同），推导跨越一个固定副热带边缘纬度 $\\varphi_c$ 的半球哈德莱环流质量输送 $\\Psi$ (单位为 $\\text{kg s}^{-1}$) 的整体标度律。\n2. 推导一个整体动量约束，该约束限制了在线性拖曳与科里奥利加速度平衡，且上层支纬向风不能超过从赤道到 $\\varphi_c$ 的绝对角动量守恒所蕴含的纬向风时，$\\Psi$ 的可达到值。\n3. 结合以上两点，得出一个关于 $\\Psi$ 的预测性标度律，即能量驱动输送和动量限制输送中的较小者。用此来诊断环流是处于角动量守恒 (AMC) 机制还是涡旋侵蚀限制机制。首次出现时，对 AMC 进行如下定义：角动量守恒 (AMC) 机制指的是维持能量驱动翻转环流所需的纬向风不超过绝对角动量守恒所蕴含的纬向风的情况；否则，适用涡旋侵蚀机制。\n\n使用的假设和常数：\n- 地球半径 $a = 6.371 \\times 10^{6}\\ \\text{m}$。\n- 地球转动速率 $\\Omega = 7.2921159 \\times 10^{-5}\\ \\text{s}^{-1}$。\n- 重力加速度 $g = 9.80665\\ \\text{m s}^{-2}$。\n- 地表气压 $p_s = 1.0 \\times 10^{5}\\ \\text{Pa}$。\n- 单位面积的柱质量 $m_c = p_s/g$ (单位为 $\\text{kg m}^{-2}$)。\n- 定压比热 $c_p = 1004\\ \\text{J kg}^{-1}\\ \\text{K}^{-1}$。\n- 副热带边缘纬度 $\\varphi_c = 30^\\circ$ (计算时使用弧度)。\n- 经向温度差 $\\Delta T = 15\\ \\text{K}$。\n- 边缘处的科里奥利参数 $f = 2 \\Omega \\sin \\varphi_c$。\n- 边缘处的周长 $C = 2 \\pi a \\cos \\varphi_c$。\n- 一个半球内从赤道到 $\\varphi_c$ 的热带冠面积 $A_{\\text{trop}} = 2 \\pi a^{2} \\sin \\varphi_c$。\n- 由从赤道开始的绝对角动量守恒所蕴含的、在 $\\varphi_c$ 处的 AMC 上层支纬向风 $u_{\\text{AMC}}(\\varphi_c)$，其从绝对角动量的定义 $M = a \\cos \\varphi \\left(u + \\Omega a \\cos \\varphi\\right)$ 和 $M(\\varphi=0) = \\Omega a^{2}$ 推导而来。\n\n要求的推导和计算步骤：\n- 从稳态能量平衡出发，推导能量驱动输送 $\\Psi_{E}$ 的整体表达式，用 $Q$、$A_{\\text{trop}}$、$c_p$ 和 $\\Delta T$ 表示。\n- 从轴对称条件下的纬向动量平衡（包含线性拖曳和科里奥利项）出发，推导经向速度 $v$ 和纬向风 $u$ 之间的关系，从而得出受约束 $u \\le u_{\\text{AMC}}(\\varphi_c)$ 的动量限制最大输送 $\\Psi_{M}$。\n- 将预测的质量输送定义为 $\\Psi = \\min\\left(\\Psi_{E}, \\Psi_{M}\\right)$。\n- 将 AMC 与涡旋侵蚀机制的分类定义为一个布尔值：如果 $\\Psi_{E} \\le \\Psi_{M}$，则为 AMC，否则为涡旋侵蚀。\n\n单位和输出要求：\n- 所有输入参数 $r$ 的单位必须是 $\\text{s}^{-1}$，$Q$ 的单位必须是 $\\text{W m}^{-2}$。\n- 在所有计算中，角度必须以弧度处理，使用给定的 $\\varphi_c = 30^\\circ$ 转换后的弧度值。\n- 程序必须为每个测试案例输出质量输送 $\\Psi$（浮点数，单位为 $\\text{kg s}^{-1}$）和机制分类（整数，$1$ 代表 AMC，$0$ 代表涡旋侵蚀）。\n- 最终输出必须是单行，包含一个由方括号括起来的扁平逗号分隔列表。对于每个测试案例，按顺序输出两个值：首先是质量输送 $\\Psi$（单位为 $\\text{kg s}^{-1}$），然后是 AMC 标志。\n\n测试套件：\n对以下 $(r, Q)$ 对进行参数扫描：\n- $(1.0 \\times 10^{-5}\\ \\text{s}^{-1}, 50.0\\ \\text{W m}^{-2})$，\n- $(1.0 \\times 10^{-6}\\ \\text{s}^{-1}, 150.0\\ \\text{W m}^{-2})$，\n- $(1.0 \\times 10^{-8}\\ \\text{s}^{-1}, 300.0\\ \\text{W m}^{-2})$，\n- $(2.0 \\times 10^{-6}\\ \\text{s}^{-1}, 150.0\\ \\text{W m}^{-2})$，\n- $(1.95 \\times 10^{-6}\\ \\text{s}^{-1}, 150.0\\ \\text{W m}^{-2})$。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔结果列表。对所有浮点数输出使用科学计数法（例如，$1.234567 \\times 10^{12}$ 应表示为 1.234567e+12）。该列表必须按测试案例排序，每个测试案例贡献恰好两个条目：预测的质量输送 $\\Psi$（单位为 $\\text{kg s}^{-1}$），后跟 AMC 标志（$1$ 或 $0$）。",
            "solution": "问题陈述经过了严格审查，并被确定为有效。它在简化大气模型的既定框架内具有科学依据，是适定的、客观的，并为获得唯一解提供了一套完整且一致的定义、假设和常数。该问题要求推导和应用一个关于哈德莱环流的整体标度模型，这是地球物理流体动力学中的一个标准课题。\n\n解答过程首先推导哈德莱环流质量输送 $\\Psi$ 的两个理论极限：一个基于能量收支（$\\Psi_E$），另一个基于动量动力学（$\\Psi_M$）。预测的输送是这两者中的较小者，而起控制作用的极限决定了环流的机制。\n\n**第 1 部分：能量限制的质量输送 $\\Psi_E$ 的推导**\n\n第一个约束来自全球能量平衡。在稳态下，热带区域内的净非绝热加热必须由大气环流的能量输出相平衡。问题指定该输出是由哈德莱环流以干静力能量通量的形式携带的。\n\n- 在一个半球的热带冠区域 $A_{\\text{trop}}$ 上积分的总非绝热加热率 $\\dot{E}_{in}$ 由下式给出：\n$$\n\\dot{E}_{in} = Q \\cdot A_{\\text{trop}}\n$$\n其中 $Q$ 是单位面积的加热率。从赤道到纬度 $\\varphi_c$ 的冠区面积为 $A_{\\text{trop}} = 2 \\pi a^{2} \\sin \\varphi_c$。\n\n- 由哈德莱环流携带的经向干静力能量通量 $\\dot{E}_{out}$ 被建模为质量输送流函数 $\\Psi$、定压比热容 $c_p$ 以及环流上下层支之间给定的经向温差 $\\Delta T$ 的乘积。\n$$\n\\dot{E}_{out} = \\Psi \\cdot c_p \\cdot \\Delta T\n$$\n\n- 在稳态下，能量平衡要求 $\\dot{E}_{in} = \\dot{E}_{out}$。这为能量驱动的质量输送提供了一个标度律，我们将其表示为 $\\Psi_E$：\n$$\nQ \\cdot A_{\\text{trop}} = \\Psi_E \\cdot c_p \\cdot \\Delta T\n$$\n\n- 求解 $\\Psi_E$ 得到我们的第一个标度律：\n$$\n\\Psi_E = \\frac{Q \\cdot A_{\\text{trop}}}{c_p \\Delta T} = \\frac{2 \\pi a^{2} Q \\sin \\varphi_c}{c_p \\Delta T}\n$$\n\n该表达式代表在给定温差下平衡非绝热加热所需的质量输送。\n\n**第 2 部分：动量限制的质量输送 $\\Psi_M$ 的推导**\n\n第二个约束来自控制流动的力的平衡以及角动量守恒原理。\n\n**2a. 纬向动量约束**\n\n在轴对称、稳态框架中，大气边界层中的纬向动量平衡得以简化，其中地表摩擦占主导地位。作用于经向流的科里奥利力与作用于纬向流的摩擦拖曳相平衡。使用指定的线性拖曳参数化，此平衡关系为：\n$$\nf \\bar{v} = r \\bar{u}\n$$\n其中 $\\bar{v}$ 和 $\\bar{u}$ 是整体（垂直平均）的经向和纬向速度，$f = 2 \\Omega \\sin \\varphi_c$ 是环流边缘的科里奥利参数，$r$ 是拖曳系数。\n\n跨越纬度圈 $\\varphi_c$ 的总半球质量输送 $\\Psi$ 是垂直积分的经向质量通量与地球在该纬度的周长 $C = 2 \\pi a \\cos \\varphi_c$ 的乘积。垂直积分的质量通量由 $\\bar{v} \\cdot m_c$ 给出，其中 $m_c = p_s/g$ 是单位面积的柱质量。\n$$\n\\Psi = (m_c \\bar{v}) \\cdot C = m_c \\bar{v} \\cdot (2 \\pi a \\cos \\varphi_c)\n$$\n\n我们可以使用动量平衡将 $\\bar{v}$ 表示为 $\\bar{u}$ 的函数（$\\bar{v} = (r/f) \\bar{u}$），并将其代入 $\\Psi$ 的表达式中：\n$$\n\\Psi = m_c \\left(\\frac{r}{f} \\bar{u}\\right) (2 \\pi a \\cos \\varphi_c) = \\frac{2 \\pi a r m_c \\cos \\varphi_c}{f} \\bar{u}\n$$\n\n该方程表明，对于给定的拖曳 $r$，更大的质量输送 $\\Psi$ 需要更大的纬向风 $\\bar{u}$。\n\n**2b. 角动量守恒极限**\n\n纬向风 $\\bar{u}$ 能变得多大存在一个物理上限。这个极限由绝对角动量守恒设定。一个气块的单位质量绝对角动量 $M$ 由下式给出：\n$$\nM = (u + \\Omega a \\cos \\varphi) a \\cos \\varphi\n$$\n其中 $u$ 是相对于地表的纬向风，$\\Omega a \\cos \\varphi$ 是地球固体在纬度 $\\varphi$ 处的速度。\n\n考虑一个气块从赤道（$\\varphi=0$）静止（$u=0$）出发，向极地方向移动到副热带边缘 $\\varphi_c$。如果其绝对角动量守恒，则 $M(\\varphi_c) = M(\\varphi=0)$。\n- 在赤道：$M(\\varphi=0) = (0 + \\Omega a \\cos 0) a \\cos 0 = \\Omega a^2$。\n- 在副热带边缘 $\\varphi_c$，纬向风将达到可能的最大值，我们将其表示为 $u_{\\text{AMC}}$：\n$$\nM(\\varphi_c) = (u_{\\text{AMC}} + \\Omega a \\cos \\varphi_c) a \\cos \\varphi_c\n$$\n令 $M$ 的两个表达式相等：\n$$\n(u_{\\text{AMC}} + \\Omega a \\cos \\varphi_c) a \\cos \\varphi_c = \\Omega a^2\n$$\n求解 $u_{\\text{AMC}}$：\n$$\nu_{\\text{AMC}} = \\Omega a \\left( \\frac{1}{\\cos \\varphi_c} - \\cos \\varphi_c \\right) = \\Omega a \\frac{1 - \\cos^2 \\varphi_c}{\\cos \\varphi_c} = \\Omega a \\frac{\\sin^2 \\varphi_c}{\\cos \\varphi_c}\n$$\n这就是一个完美守恒其角动量的哈德莱环流上层支中的纬向风。\n\n**2c. 动量限制的输送 $\\Psi_M$**\n\n动量限制的质量输送 $\\Psi_M$ 是动量平衡可以维持的最大可能输送 $\\Psi$，这发生在纬向风 $\\bar{u}$ 达到其上限 $u_{\\text{AMC}}$ 时。将 $\\bar{u} = u_{\\text{AMC}}$ 代入我们从 2a 节得到的 $\\Psi$ 的表达式中：\n$$\n\\Psi_M = \\frac{2 \\pi a r m_c \\cos \\varphi_c}{f} u_{\\text{AMC}}\n$$\n现在，代入 $f = 2 \\Omega \\sin \\varphi_c$ 和 $u_{\\text{AMC}} = \\Omega a \\frac{\\sin^2 \\varphi_c}{\\cos \\varphi_c}$ 的表达式：\n$$\n\\Psi_M = \\frac{2 \\pi a r m_c \\cos \\varphi_c}{2 \\Omega \\sin \\varphi_c} \\left( \\Omega a \\frac{\\sin^2 \\varphi_c}{\\cos \\varphi_c} \\right)\n$$\n简化该表达式揭示了一个非常简洁的结果：\n$$\n\\Psi_M = (\\pi a r m_c \\cot \\varphi_c) \\left( a \\frac{\\sin^2 \\varphi_c}{\\cos \\varphi_c} \\right) = \\pi a^2 r m_c \\sin \\varphi_c\n$$\n这是我们的第二个标度律，代表了动量收支所允许的最大质量输送。\n\n**第 3 部分：预测性标度律和机制诊断**\n\n哈德莱环流的实际稳态质量输送 $\\Psi$ 必须同时满足能量和动量约束。因此，实现的输送将是两个动力学上可能的值中的较小者：\n$$\n\\Psi = \\min(\\Psi_E, \\Psi_M)\n$$\n\n这导致了两种不同的环流机制：\n- **角动量守恒 (AMC) 机制**：当能量需求的输送不超过动量限制的输送时，即 $\\Psi_E \\le \\Psi_M$，就会出现这种机制。在这种情况下，环流强度由能量收支决定，$\\Psi = \\Psi_E$。支持该环流所需的纬向风低于 $u_{\\text{AMC}}$ 极限。问题将此定义为 AMC 机制，我们编码为 $1$。\n\n- **涡旋侵蚀限制机制**：当能量收支需求的输送大于动量收支所能允许的输送时，即 $\\Psi_E  \\Psi_M$，就会出现这种机制。在这个简单模型中，环流被动量极限所限制，因此 $\\Psi = \\Psi_M$。在更复杂的三维大气中，这就是涡旋变得重要、通过输送动量来减速纬向急流并允许经向环流加强到超出轴对称极限的机制。问题定义了一个非 AMC 机制，对应于涡旋侵蚀，我们编码为 $0$。\n\n**第 4 部分：计算算法**\n\n对于每个测试案例 $(r, Q)$，算法如下：\n1.  定义物理和几何常数：$a = 6.371 \\times 10^{6}\\ \\text{m}$，$\\Omega = 7.2921159 \\times 10^{-5}\\ \\text{s}^{-1}$，$g = 9.80665\\ \\text{m s}^{-2}$，$p_s = 1.0 \\times 10^{5}\\ \\text{Pa}$，$c_p = 1004\\ \\text{J kg}^{-1}\\ \\text{K}^{-1}$，$\\varphi_c = 30^\\circ$，$\\Delta T = 15\\ \\text{K}$。\n2.  计算派生常数：$m_c = p_s/g$ 并将 $\\varphi_c$ 转换为弧度。\n3.  计算能量限制的输送 $\\Psi_E$：\n    $$ \\Psi_E = \\frac{2 \\pi a^{2} Q \\sin \\varphi_c}{c_p \\Delta T} $$\n4.  计算动量限制的输送 $\\Psi_M$：\n    $$ \\Psi_M = \\pi a^2 r m_c \\sin \\varphi_c $$\n5.  确定预测的质量输送 $\\Psi$：\n    $$ \\Psi = \\min(\\Psi_E, \\Psi_M) $$\n6.  对机制进行分类：如果 $\\Psi_E \\le \\Psi_M$，则将标志设置为 $1$ (AMC)，否则设置为 $0$ (涡旋侵蚀)。\n7.  输出 $\\Psi$ 和机制标志。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Hadley cell mass transport and regime classification\n    based on a bulk scaling model.\n    \"\"\"\n\n    # Physical and geometric constants\n    a = 6.371e6  # Earth radius in meters\n    Omega = 7.2921159e-5  # Earth rotation rate in rad/s\n    g = 9.80665  # Gravitational acceleration in m/s^2\n    p_s = 1.0e5  # Surface pressure in Pa\n    c_p = 1004.0  # Specific heat at constant pressure in J/kg/K\n    phi_c_deg = 30.0  # Subtropical edge latitude in degrees\n    Delta_T = 15.0  # Meridional temperature contrast in K\n\n    # Derived constants\n    m_c = p_s / g  # Column mass per unit area in kg/m^2\n    phi_c_rad = np.deg2rad(phi_c_deg)  # Latitude in radians\n    \n    # Pre-calculate common factors\n    sin_phi_c = np.sin(phi_c_rad)\n    \n    # Factor for Psi_E (depends on Q)\n    # Psi_E = (2 * pi * a^2 * Q * sin(phi_c)) / (c_p * Delta_T)\n    psi_e_factor = (2 * np.pi * a**2 * sin_phi_c) / (c_p * Delta_T)\n    \n    # Factor for Psi_M (depends on r)\n    # Psi_M = pi * a^2 * r * m_c * sin(phi_c)\n    psi_m_factor = np.pi * a**2 * m_c * sin_phi_c\n\n    # Test suite: (r in s^-1, Q in W/m^-2)\n    test_cases = [\n        (1.0e-5, 50.0),\n        (1.0e-6, 150.0),\n        (1.0e-8, 300.0),\n        (2.0e-6, 150.0),\n        (1.95e-6, 150.0),\n    ]\n\n    results = []\n    for r, Q in test_cases:\n        # 1. Calculate the energy-limited mass transport, Psi_E\n        Psi_E = psi_e_factor * Q\n\n        # 2. Calculate the momentum-limited mass transport, Psi_M\n        Psi_M = psi_m_factor * r\n\n        # 3. Determine the predicted mass transport, Psi\n        Psi = min(Psi_E, Psi_M)\n\n        # 4. Classify the circulation regime\n        # 1 for Angular Momentum Conserving (AMC), 0 for eddy-erosion\n        amc_flag = 1 if Psi_E = Psi_M else 0\n        \n        results.append(f\"{Psi:.6e}\")\n        results.append(str(amc_flag))\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}