## 引言
在数值海洋和气候模拟领域，如何精确地在三维空间中描述海洋的运动和状态是核心挑战之一。[垂直坐标系](@entry_id:1133787)的选择，作为模型物理框架的基石，不仅决定了控制方程的数学形式，更深刻地影响着模型对关键物理过程（如水团混合、环流和[海气相互作用](@entry_id:1120897)）的模拟能力。不同的坐标系代表了对海洋物理不同层面的抽象与简化，因此理解它们各自的原理与适用性，对于模型开发者和使用者都至关重要。

然而，不存在一个普适的“完美”坐标系。从最直观的几何高度（Z坐标）到遵循物理守恒定律的等密度面坐标，再到高度简化的[平板模型](@entry_id:181436)，每种方法在带来特定优势的同时，也引入了独特的数值挑战和物理局限。这为研究者带来了一个关键问题：如何根据具体的科学目标——是关注短期海气耦合，还是长期气候变化中的深海过程——来选择最合适的模型架构？

本文旨在系统性地解答这一问题。我们将通过三个章节，带领读者深入探索[海洋坐标系](@entry_id:1129053)的世界。第一章“原理与机制”将从[原始方程](@entry_id:1130162)出发，剖析Z坐标、等密度面坐标及[平板模型](@entry_id:181436)的基本构造、物理假设和内在的数值难题，如[伪混合](@entry_id:1132230)和压力梯度误差。第二章“应用与交叉学科联系”将通过一系列实际案例，展示这些模型在模拟大尺度环流、中尺度涡、气候变化响应以及与其他学科（如数据同化）结合时的具体应用与表现。最后，在“动手实践”部分，读者将通过具体计算练习，亲身体验坐标系选择对[模型稳定性](@entry_id:636221)和计算效率的实际影响。通过这一结构化的学习路径，本文力求为读者构建一个关于[海洋坐标系](@entry_id:1129053)选择的清晰决策框架。

## 原理与机制

本章旨在深入探讨[海洋环流](@entry_id:195237)模型中采用的不同[垂直坐标系](@entry_id:1133787)的物理原理与核心机制。继前一章对海洋模型的总体介绍之后，我们将系统性地剖析三种具有代表性的坐标系框架：基于几何高度的 $z$ 坐标模型、遵循物理守恒律的等密度面坐标模型，以及用于简化热力学过程的[平板海洋模型](@entry_id:1131738)。我们将从基本控制方程出发，逐一阐明每种坐标系的构建方式、它们所固有的优势与局限，以及这些选择如何深刻影响模型对关键海洋过程的模拟能力。

### 理论基础：地势坐标系下的[原始方程](@entry_id:1130162)组

现代大尺度[海洋环流](@entry_id:195237)模型（Ocean General Circulation Models, OGCMs）的理论基石，是在旋转参考系下描述[分层流体](@entry_id:181098)运动的一组[非线性偏微分方程](@entry_id:169481)，通常被称为**原始方程组（primitive equations）**。在最常用和最直观的**地势坐标系（geopotential coordinate system）**，或称 **$z$ 坐标系**中，垂直坐标 $z$ 代表几何高度，通常取海平面为 $z=0$，向上为正。

在此框架下，通过引入两个关键的物理近似——**静力平衡近似（hydrostatic approximation）**和**布辛涅斯克近似（Boussinesq approximation）**——我们可以得到适用于大尺度[海洋环流](@entry_id:195237)的简化方程组。[静力平衡近似](@entry_id:1126281)假定，对于水平尺度远大于垂直尺度的流动，垂直方向的加速度可以忽略不计，[垂直动量方程](@entry_id:1133792)简化为重力与[垂直压力梯度](@entry_id:1133794)力的平衡。布辛涅斯克近似则认为，密度的变化 $\rho'$ 相对于一个常数参考密度 $\rho_0$ 而言是小量（即 $\rho = \rho_0 + \rho'$），这些密度变化在动力学上仅在与[重力加速度](@entry_id:173411) $g$ 相乘的[浮力](@entry_id:154088)项中才显得重要，而在其他惯性项中则可被忽略。

基于这些近似，一个包含自由表面的旋转、分层海洋的完整 $z$ 坐标[原始方程](@entry_id:1130162)组由以下几个部分构成：

1.  **水平[动量方程](@entry_id:197225)（Horizontal Momentum Equations）**：描述水平速度 $\boldsymbol{u}=(u,v)$ 的时间演化，受压力[梯度力](@entry_id:166847)、科里奥利力、平流、以及摩擦和扩散等外力作用。
    $$
    \frac{\partial \boldsymbol{u}}{\partial t} + \boldsymbol{u}\cdot \nabla_h \boldsymbol{u} + w\,\frac{\partial \boldsymbol{u}}{\partial z} + f\,\hat{\boldsymbol{k}}\times \boldsymbol{u} \;=\; -\frac{1}{\rho_0}\,\nabla_h p \;+\; \mathcal{D}_{\boldsymbol{u}} \;+\; \boldsymbol{F}_{\boldsymbol{u}}
    $$
    其中，$f$ 是[科里奥利参数](@entry_id:1123077)，$\hat{\boldsymbol{k}}$ 是垂直[单位向量](@entry_id:165907)，$\nabla_h$ 是水平梯度算子，$p$ 是压力，$w$ 是垂直速度。$\mathcal{D}_{\boldsymbol{u}}$ 和 $\boldsymbol{F}_{\boldsymbol{u}}$ 分别代表[参数化](@entry_id:265163)的[次网格尺度](@entry_id:1132591)扩散和外部强迫（如风应力）。

2.  **[静力平衡](@entry_id:163498)方程（Hydrostatic Balance Equation）**：这是简化后的[垂直动量方程](@entry_id:1133792)，它将压力与密度场直接联系起来。
    $$
    \frac{\partial p}{\partial z} \;=\; -\rho\,g
    $$
    注意，这里的密度 $\rho$ 是完整的原位密度，包含了微小的变化 $\rho'$。正是通过这个方程，密度的空间变化（即分层）得以产生斜压压力梯度，从而驱动海洋内部的环流。

3.  **[连续性方程](@entry_id:195013)（Continuity Equation）**：在布辛涅斯克近似下，流体被视为不可压缩的，质量守恒简化为体积守恒。
    $$
    \nabla_h \cdot \boldsymbol{u} \;+\; \frac{\partial w}{\partial z} \;=\; 0
    $$

4.  **示踪物守恒方程（Tracer Conservation Equations）**：描述位温 $\Theta$ 和盐度 $S$ 等被动或主动示踪物的平流-扩散过程。
    $$
    \frac{\partial \Theta}{\partial t} + \boldsymbol{u}\cdot \nabla_h \Theta + w\,\frac{\partial \Theta}{\partial z} \;=\; \mathcal{D}_{\Theta} \;+\; Q_{\Theta}
    $$
    盐度 $S$ 也遵循类似形式的方程。$\mathcal{D}$ 和 $Q$ 分别代表扩散和源汇项（如[海气通量](@entry_id:1120895)）。

5.  **[状态方程](@entry_id:274378)（Equation of State）**：一个代数关系式，将密度与温度、盐度和压力联系起来：$\rho = \rho(\Theta, S, p)$。

6.  **自由表面方程（Free-Surface Equation）**：通过对连续性方程进行全水深积分，得到海面高度 $\eta(x,y,t)$ 的演化方程，表征了水柱总质量的守恒。
    $$
    \frac{\partial \eta}{\partial t} + \nabla_h \cdot \left(\int_{-H}^{\eta} \boldsymbol{u}\,dz\right) \;=\; 0
    $$
    其中 $z=-H(x,y)$ 是海底深度。

在这套方程组中，我们必须区分**预报变量（prognostic variables）**和**诊断变量（diagnostic variables）**。预报变量是通过对时间积分其[演化方程](@entry_id:268137)来求解的，它们决定了模型的未来状态。在本系统中，水平速度 $(\boldsymbol{u})$、位温 $(\Theta)$、盐度 $(S)$ 和海面高度 $(\eta)$ 都是预报变量。相反，诊断变量是在每个时间步由其他变量通过代数关系或[约束方程](@entry_id:138140)直接计算得出的，它们不具有独立的“记忆”。在这里，垂直速度 $(w)$（通过积分[连续性方程](@entry_id:195013)得到）、压力 $(p)$（通[过积分](@entry_id:753033)[静力平衡](@entry_id:163498)方程得到）和密度 $(\rho)$（通过状态方程得到）均为诊断变量。

### 分层海洋中的混合挑战：跨等密度面混合的能量代价

在深入探讨替代坐标系之前，我们必须理解促使这些新坐标系发展的核心物理动机：海洋内部混合过程的极端各向异性。在稳定的层状海洋中，密度随深度增加，我们可以定义两个关键方向：**等密度面方向（isopycnal direction）**，即沿着密度不变的曲面；以及**跨等密度面方向（diapycnal direction）**，即垂直于这些曲面的方向。

要理解这两个方向上混合的差异，关键在于能量分析。在一个稳定分层的流体中（其特征是浮力频率 $N^2 = -(g/\rho_0)(\partial \rho/\partial z) > 0$），流体系统的背景势能处于一个相对较低的状态。要将一个密度较大的流体微团向上移动，或将一个密度较小的微团向下移动，就必须克服[浮力](@entry_id:154088)恢复力做功。这个过程会抬高系统的[质心](@entry_id:138352)，从而增加整个系统的背景势能。单位质量的流体微团在跨等密度面方向上被垂直移动距离 $\xi$ 所需的功，其量级为 $\frac{1}{2}N^2\xi^2$。

因此，跨等密度面混合是一个能量上“昂贵”的过程，需要持续的能量输入（例如，通过内波破碎、剪切不稳定等过程）来维持。相比之下，沿着等密度面混合则是一个能量上“廉价”的过程，因为它只是交换具有相同密度的水团，几乎不改变系统的背景势能。

这一物理现实导致海洋内部的[湍流混合](@entry_id:202591)具有强烈的**各向异性（anisotropy）**：沿着等密度面的扩散系数 $K_{\parallel}$ 要远大于跨越等密度面的扩散系数 $K_{\perp}$，通常相差数个数量级（$K_{\parallel} \gg K_{\perp}$）。任何一个旨在真实模拟海洋的数值模型，都必须尊重这一基本的物理约束。

### 海洋动力学的表征：一个模型的层级体系

基于对物理过程的不同侧重和简化程度，海洋模型形成了一个从简单到复杂的层级体系。坐标系的选择是这一体系中的核心要素。

#### 最简情形：[平板海洋模型](@entry_id:1131738)

在气候系统模拟中，有时我们主要关心的是海洋[上层](@entry_id:198114)对大气提供[热力学](@entry_id:172368)惯性，而非其复杂的动力学过程。在这种情况下，**[平板海洋模型](@entry_id:1131738)（slab ocean model）**提供了一个极度简化的表示。

该模型将整个海洋上层视为一个垂直均匀、深度固定（$h_m$）的[混合层](@entry_id:926526)。它没有内部的垂直分层，也没有水平流动的显式表示。其核心是一个[热量收支方程](@entry_id:172553)，描述了混合层平均温度 $T(t)$ 的时间演化：
$$
C_m \,\frac{\partial T}{\partial t} \;=\; Q_{net} \;-\; \lambda \left(T - T_a\right) \;-\; \rho_w c_p w_e \left(T - T_b\right)
$$
这个方程的各项物理意义明确：
*   **热容量（Heat Capacity）**：$C_m = \rho_w c_p h_m$ 是单位面积混合层的热容量，其中 $\rho_w$ 和 $c_p$ 分别是水的密度和比热。它决定了海洋对表面热通量响应的“惯性”。
*   **净表面热通量（Net Surface Heat Flux）**：$Q_{net}$ 代表所有非[参数化](@entry_id:265163)的表面热通量，主要是净短波和长波辐射。通常约定向下（加热海洋）为正。
*   **线性化[湍流](@entry_id:151300)交换（Linearized Turbulent Exchange）**：$-\lambda (T - T_a)$ 项是对[感热和潜热通量](@entry_id:1131472)的线性化[参数化](@entry_id:265163)，表示海洋与大气（温度为 $T_a$）之间的热量交换。当海洋比大气暖时，该项为负，海洋向大气释放热量。
*   **卷夹通量（Entrainment Flux）**：$-\rho_w c_p w_e (T - T_b)$ 项代表了[混合层](@entry_id:926526)底部通过卷夹过程与下层水体（温度为 $T_b$）的热量交换。当混合层加[深时](@entry_id:175139)（卷夹速度 $w_e > 0$），如果下层水体更冷（$T > T_b$），卷夹将导致[混合层](@entry_id:926526)冷却。

平板模型的巨大优势在于其计算成本极低，但其局限性也同样显著。由于它不包含[动量方程](@entry_id:197225)和内部的垂直结构，它无法模拟任何由[海洋动力学](@entry_id:1129055)驱动的过程，例如：由风应力驱动的**埃克曼输运（Ekman transport）**、由洋流引起的热量平流、以及斜压不稳定等中尺度过程。更重要的是，它无法描述海洋内部对表面强迫的响应，如风生**埃克曼抽吸（Ekman pumping/suction）**导致的分层海洋内部等密度面的抬升或下沉。这种响应是[斜压性](@entry_id:1121342)的，涉及内部的密度结构调整和地转剪切流，而[平板模型](@entry_id:181436)本质上是一个零维或一维的[热力学](@entry_id:172368)模型，完全缺失这些物理机制。

#### 地势坐标框架：$z$ 坐标模型的优势与挑战

$z$ 坐标模型作为最直观的框架，能够完整地求解[原始方程](@entry_id:1130162)组，从而模拟广泛的海洋动力学过程，包括[内重力波](@entry_id:185206)、斜压不稳定、埃克曼输运以及通过[非线性](@entry_id:637147)[状态方程](@entry_id:274378)实现的热盐效应，例如海洋混合效应（cabbeling）。

然而，$z$ 坐标模型面临一个源于其坐标系与物理过程不匹配的根本性挑战：**[伪跨等密度面混合](@entry_id:1132228)（spurious diapycnal mixing）**。想象一个理想情景：在 $z$ 坐标网格上，等密度面是倾斜的，且流体完全沿着这些倾斜的等密度面运动。在连续介质中，由于流体没有穿越等密度面，因此不存在物理上的跨等密度面混合。

但在数值模型中，平流过程通常通过在 $x$ 和 $z$ 方向上分离计算通量来实现。许多[数值平流](@entry_id:1128962)格式（尤其是低阶格式）会引入一种称为**[数值扩散](@entry_id:136300)（numerical diffusion）**的[截断误差](@entry_id:140949)，其作用类似于一个与网格轴对齐的物理扩散算子。当倾斜的等密度面与水平的网格面不一致时，这个沿坐标轴作用的数值扩散，在经过[坐标旋转](@entry_id:164444)后，会不可避免地产生一个投射到跨等密度面方向上的分量。这就好像在数值计算中人为地、错误地将示踪物（如热量和盐）“混合”到了不同的密度层中。

这个虚假的混合通量，其大小与等密度面的坡度、流速以及网格分辨率成正比。对于需要长时间积分的气候模型而言，这种累积的[伪混合](@entry_id:1132230)会严重侵蚀水团的特性，导致深层海洋不切实际地变暖和变淡，从而使模拟结果偏离真实情况。

应对这一挑战的策略包括：发展更高阶、多维度的平流方案以减小[数值扩散](@entry_id:136300)；或者更直接地，在模型中显式地旋转[扩散张量](@entry_id:748421)，使其[主轴](@entry_id:172691)与等密度面方向对齐，即所谓的**等密度面中性扩散（isoneutral diffusion）**。这种方法强制扩散主要沿着等密度面发生，而只保留一个较小的、物理上合理的跨等密度面分量，从而极大地缓解了伪[混合问题](@entry_id:634383)。

#### 物理对齐方法：等密度面坐标模型

为了从根本上解决 $z$ 坐标模型中坐标系与流动路径不匹配的问题，物理学家们发展了**等密度面坐标（isopycnal coordinate）**模型。其核心思想是使用密度本身（或一个与密度相关的变量，如位势密度 $\sigma$）作为垂直坐标。这样，对于[绝热流](@entry_id:262576)动，流体[质点](@entry_id:186768)天然地在其坐标面内运动。

从 $z$ 坐标系到等密度面坐标系的转换，引入了全新的预报变量和方程形式：
*   **层厚度（Layer Thickness）**：在等密度面坐标系中，几何高度 $z$ 变成了一个依赖于 $(x,y,\sigma,t)$ 的诊断变量。取而代之的核心预报变量是**层厚度** $h$，定义为 $h = -\partial z / \partial \sigma$。它代表了单[位密度](@entry_id:1129991)间隔内的几何厚度，其演化由质量守恒决定。
*   **厚度方程（Thickness Equation）**：原先的连续性方程被转换为一个关于层厚度 $h$ 的[预报方程](@entry_id:1130221)：
    $$
    \partial_t h + \nabla_\sigma \cdot (h\boldsymbol{u}) = -\partial_{\sigma} F_{\mathrm{dia}}
    $$
    这里，$\nabla_\sigma$ 是在常数 $\sigma$ 面上的水平散度。方程左边描述了水平平流导致的层厚度变化，右边的 $F_{\mathrm{dia}}$ 代表了跨等密度面的质量通量（即真实的物理混合），它必须被[参数化](@entry_id:265163)。在理想的绝热内部，该项为零。
*   **厚度加权示踪物（Thickness-Weighted Tracers）**：示踪物方程也相应地转换为对厚度加权的示踪物总量 $\Theta = hC$（其中 $C$ 是示踪物浓度）的[预报方程](@entry_id:1130221)。
*   **压力[梯度力](@entry_id:166847)与蒙哥马利势（Pressure Gradient Force and Montgomery Potential）**：等密度面坐标系的一个显著优点在于压力[梯度力](@entry_id:166847)的简化。在 $z$ 坐标系中复杂的水平压力[梯度力](@entry_id:166847)，在等密度面坐标系中可以表示为一个[标量势](@entry_id:276177)——**蒙哥马利势（Montgomery Potential）** $M$ 的梯度。$M$ 通常定义为 $M = p + g\rho z$（或类似形式）。这样，水平动量方程中的压力梯度项就变成了简洁的 $-\nabla_\sigma M$。

等密度面模型的优势是显而易见的：它通过将坐标系与[绝热流](@entry_id:262576)动的主要路径对齐，从根本上消除了平流过程产生的[伪跨等密度面混合](@entry_id:1132228)，因此能够极好地维持水团特性。然而，它也带来了新的挑战，例如处理等密度面与海面或海底相交（即**露头（outcropping）**）的复杂情况，以及必须将所有跨等密度面的物理混合过程[参数化](@entry_id:265163)为层间的质量交换。

### 倾[斜坐标系](@entry_id:164861)中的数值挑战：压力梯度误差

无论是等密度面坐标模型，还是在近岸和陆架海洋学中广泛使用的**[地形跟随坐标](@entry_id:1132950)（terrain-following coordinate）**模型（如 $\sigma$ 坐标），它们都面临一个共同的、棘手的数值问题——**压力梯度误差（pressure gradient error）**。

这个问题的根源在于，在倾斜的坐标面上计算水平压力梯度。以[地形跟随坐标](@entry_id:1132950)为例，在 $s$ 坐标面上的水平压力梯度 $\nabla_h p|_s$ 可以通过链式法则分解为：
$$
\nabla_h p\vert_s = \nabla_h p\vert_z - \rho g\,\nabla_h z\vert_s
$$
在静止但有分层、且底部地形陡峭的海洋中，物理上的水平压力梯度 $\nabla_h p|_z$ 应为零。然而，由于坐标面是倾斜的，几何高度的梯度项 $\nabla_h z|_s$ 不为零。这意味着，模型计算的 $\nabla_h p|_s$ 是两个大小相近、符号相反的大数之差。在解析上，这个相消是完美的。但在离散的数值计算中，压力 $p$ 是通过对密度场进行垂[直积](@entry_id:143046)分（求和）得到的，而 $\nabla_h z|_s$ 则是通过水平差分计算的。由于不同的数值算子（垂[直积](@entry_id:143046)分与水平差分）和[非线性](@entry_id:637147)的状态方程，这种相消变得不完美，从而产生一个虚假的残余压力梯度。这个误差力可以驱动不真实的流动，特别是在陡峭地形区域。

类似的问题也存在于等密度面模型中。尽管蒙哥马利势简化了压力梯度的表达，但其计算本身涉及到对[非线性](@entry_id:637147)的[状态方程](@entry_id:274378)（即比容 $\alpha = 1/\rho$ 对压力的依赖性）的积分。当等密度面层坡度很大时，沿层的压力变化也很大，这使得对积分 $\int \alpha dp$ 的任何[数值近似](@entry_id:161970)（如使用层平均值）都会引入显著的[截断误差](@entry_id:140949)，最终表现为虚假的压力梯度。

值得注意的是，纯粹的 $z$ 坐标模型由于其坐标面与地势面平行（即 $\nabla_h z|_z = \boldsymbol{0}$），因此不存在这种由大数相消引起的压力梯度误差机制。尽管它在处理地形时有“阶梯状”表示等其他问题，但避开了这一特定的数值陷阱。

### 综合与实践：[混合坐标模型](@entry_id:1126229)

为了结合不同坐标系的优点并规避它们的缺点，现代气候模型的发展趋势是采用**[混合垂直坐标](@entry_id:1126250)（hybrid vertical coordinate）**。这种设计的核心思想是“因地制宜”，在海洋的不同区域使用最适合其物理特性的坐标系。

一个典型的[混合坐标模型](@entry_id:1126229)设计如下：
*   **海洋[上层](@entry_id:198114)**：在靠近海面的区域，特别是[混合层](@entry_id:926526)内部，使用 $z$ 坐标或[地形跟随坐标](@entry_id:1132950)。这是因为海洋[上层](@entry_id:198114)受到强烈的[海气相互作用](@entry_id:1120897)和非[绝热过程](@entry_id:138150)（如加热、冷却、风搅动）的主导。$z$ 坐标可以方便地施加海表[通量边界条件](@entry_id:749481)，并能更好地解析边界层的变化，同时避免了等密度面在上层频繁露头或变得极薄所带来的数值困难。
*   **海洋深层**：在[温跃层](@entry_id:195256)以下、几乎绝热的海洋内部，模型平滑地过渡到等密度面坐标。如前所述，深海的流动和混合过程主要沿着等密度面发生。使用等密度面坐标可以最大限度地减少[伪跨等密度面混合](@entry_id:1132228)，这对于在数百年到数千年的气候模拟中准确维持深层水团的温盐特性至关重要。此外，在深海，这种设计还能有效避免[地形跟随坐标](@entry_id:1132950)在陡峭海山和海脊附近产生的巨大压力梯度误差。

综上所述，[混合坐标模型](@entry_id:1126229)是一种精巧的折衷方案，它体现了对海洋物理过程和数值计算挑战的深刻理解。它通过在不同区域采用最适宜的数学框架，力求在[计算效率](@entry_id:270255)和物理保真度之间达到最佳平衡，代表了当前海洋和气候模拟领域的前沿技术方向。