{
    "hands_on_practices": [
        {
            "introduction": "本练习关注于设计等密度面坐标海洋模型中的一项基本任务：定义垂直分层。通过根据温度和盐度数据计算位密度，你将确定一个层界面的最佳密度值，以防止其在冬季“露头”或与海面相交。这项实践对于理解等密度面模型如何表示水团，以及确保模拟的数值稳定性和物理真实性至关重要。",
            "id": "4072211",
            "problem": "一个从副热带到副极地纬度的经向断面由无量纲坐标 $y \\in [0,1]$ 索引，其中 $y=0$ 表示副热带端， $y=1$ 表示副极地端。该断面上冬季的表面状况可由以下原位温度和盐度场很好地近似：\n- $T_{s}(y) = 24 - 20\\,y$（单位：摄氏度），\n- $S_{s}(y) = 36 - 2\\,y$（单位：实用盐度单位）。\n\n假设海水的线性化状态方程为：\n$$\n\\rho(S,T,p) = \\rho_{0}\\left[1 - \\alpha\\,(T - T_{0}) + \\beta\\,(S - S_{0}) + \\kappa\\,(p - p_{0})\\right],\n$$\n其中 $\\rho_{0} = 1000 \\text{ kg m}^{-3}$， $T_{0} = 0$ 摄氏度， $S_{0} = 35$，$p_{0} = 0$ 分巴，$\\alpha = 2.0\\times 10^{-4} \\text{ K}^{-1}$，$\\beta = 8.0\\times 10^{-4}$，以及 $\\kappa = 4.5\\times 10^{-6} \\text{ 分巴}^{-1}$。假设运动是绝热的，其恒定的绝热温度梯度定义为\n$$\n\\frac{dT}{dp}\\bigg|_{\\mathrm{adiabatic}} = \\Gamma,\n$$\n其中 $\\Gamma = 1.2 \\times 10^{-4} \\text{ K 分巴}^{-1}$，因此参考于压力水平 $p_{\\mathrm{ref}}$ 的位温可通过沿压力对绝热梯度积分得到。取参考压力为 $p_{\\mathrm{ref}} = 2000$ 分巴。\n\n将参考于 $p_{\\mathrm{ref}}$ 的位密度定义为 $\\rho_{\\theta}(S,\\theta,p_{\\mathrm{ref}})$，其中 $\\theta$ 是在 $p_{\\mathrm{ref}}$ 处的位温，并将相应的参考于 $p_{\\mathrm{ref}}$ 的sigma-密度定义为\n$$\n\\sigma_{2}(y) \\equiv \\rho_{\\theta}\\big(S_{s}(y), \\theta(y;p_{\\mathrm{ref}}), p_{\\mathrm{ref}}\\big) - 1000.\n$$\n\n一个等密面坐标海洋模型将使用一个单一的内部等密面层，其上边界为混合层，下边界为一个密度值为 $\\sigma_{b}$ 的密度面。为消除该内部层下边界在整个断面上冬季露头的现象，边界值必须满足 $\\sigma_{b} \\ge \\max_{y\\in[0,1]} \\sigma_{2}(y)$，而满足此条件的最小选择是 $\\sigma_{b}^{\\star} = \\max_{y\\in[0,1]} \\sigma_{2}(y)$。\n\n从给定的线性状态方程和绝热梯度定义出发，推导 $\\sigma_{2}(y)$ 并确定最小边界值 $\\sigma_{b}^{\\star}$。提供 $\\sigma_{b}^{\\star}$ 的最终结果，以 sigma-单位 (kg m$^{-3}$) 表示，并四舍五入到四位有效数字。",
            "solution": "用户提供了一个物理海洋学问题，要求沿一个经向断面推导并最大化位密异常函数 $\\sigma_2(y)$。该问题是自洽的，在一个简化的线性海洋模型框架内具有科学依据，并且是适定的。所有必需的常数和函数形式都已提供。因此，该问题被认为是有效的，可以构建解答。\n\n目标是确定最小边界值 $\\sigma_{b}^{\\star}$，它被定义为表面位密异常 $\\sigma_{2}(y)$ 在定义域 $y \\in [0,1]$ 上的最大值。\n$$\n\\sigma_{b}^{\\star} = \\max_{y\\in[0,1]} \\sigma_{2}(y)\n$$\n\n解答过程分为四步：\n1.  推导位温 $\\theta$ 作为经向坐标 $y$ 的函数。\n2.  推导位密异常 $\\sigma_{2}$ 作为 $y$ 的函数。\n3.  确定 $\\sigma_{2}(y)$ 达到最大值时 $y$ 的值。\n4.  计算该最大值的数值。\n\n第一步：位温\n参考于压力 $p_{\\mathrm{ref}}$ 的位温 $\\theta$ 是指一个水块从其初始压力 $p$ 和原位温度 $T$ 被绝热地移动到参考压力 $p_{\\mathrm{ref}}$ 时所具有的温度。问题提供了一个恒定的绝热温度梯度 $\\Gamma$。\n$$\n\\frac{dT}{dp}\\bigg|_{\\mathrm{adiabatic}} = \\Gamma\n$$\n对于一个压力为 $p_s \\approx 0$、原位温度为 $T_s(y)$ 的表面水块，其在参考压力 $p_{\\mathrm{ref}}$ 处的位温 $\\theta(y; p_{\\mathrm{ref}})$ 可以通过对此关系式积分得到：\n$$\n\\int_{T_s(y)}^{\\theta(y; p_{\\mathrm{ref}})} dT' = \\int_{0}^{p_{\\mathrm{ref}}} \\Gamma \\, dp'\n$$\n$$\n\\theta(y; p_{\\mathrm{ref}}) - T_s(y) = \\Gamma p_{\\mathrm{ref}}\n$$\n$$\n\\theta(y; p_{\\mathrm{ref}}) = T_s(y) + \\Gamma p_{\\mathrm{ref}}\n$$\n代入给定的表面温度表达式 $T_s(y) = 24 - 20y$：\n$$\n\\theta(y; p_{\\mathrm{ref}}) = (24 - 20y) + \\Gamma p_{\\mathrm{ref}}\n$$\n\n第二步：位密异常 $\\sigma_2(y)$\n参考于 $p_{\\mathrm{ref}} = 2000$ dbar 的位密异常，记为 $\\sigma_2(y)$，定义为：\n$$\n\\sigma_{2}(y) = \\rho_{\\theta}\\big(S_{s}(y), \\theta(y; p_{\\mathrm{ref}}), p_{\\mathrm{ref}}\\big) - 1000\n$$\n其中 $\\rho_{\\theta}$ 是位密。我们使用给定的线性化状态方程，在压力 $p=p_{\\mathrm{ref}}$、盐度 $S=S_s(y)$ 和温度 $T = \\theta(y; p_{\\mathrm{ref}})$ 下进行计算。\n$$\n\\rho(S,T,p) = \\rho_{0}\\left[1 - \\alpha(T - T_{0}) + \\beta(S - S_{0}) + \\kappa(p - p_{0})\\right]\n$$\n参考值为 $\\rho_0 = 1000$ kg m$^{-3}$，$T_0 = 0$ ${}^\\circ$C，$S_0 = 35$，以及 $p_0 = 0$ dbar。\n因此，位密为：\n$$\n\\rho_{\\theta}(y) = \\rho_{0}\\left[1 - \\alpha(\\theta(y; p_{\\mathrm{ref}}) - T_{0}) + \\beta(S_{s}(y) - S_{0}) + \\kappa(p_{\\mathrm{ref}} - p_{0})\\right]\n$$\n将此代入 $\\sigma_2(y)$ 的定义并使用 $\\rho_0 = 1000$：\n$$\n\\sigma_{2}(y) = \\rho_{0}\\left[1 - \\alpha(\\theta(y; p_{\\mathrm{ref}}) - T_{0}) + \\beta(S_{s}(y) - S_{0}) + \\kappa(p_{\\mathrm{ref}} - p_{0})\\right] - \\rho_{0}\n$$\n$$\n\\sigma_{2}(y) = \\rho_{0}\\left[-\\alpha(\\theta(y; p_{\\mathrm{ref}}) - T_{0}) + \\beta(S_{s}(y) - S_{0}) + \\kappa(p_{\\mathrm{ref}} - p_{0})\\right]\n$$\n现在，我们代入 $\\theta(y; p_{\\mathrm{ref}})$、$S_s(y)$ 的表达式以及参考常数：\n$$\n\\theta(y; p_{\\mathrm{ref}}) = (24 - 20y) + \\Gamma p_{\\mathrm{ref}}\n$$\n$$\nS_s(y) = 36 - 2y\n$$\n$$\n\\sigma_{2}(y) = \\rho_{0}\\left[-\\alpha\\left((24 - 20y) + \\Gamma p_{\\mathrm{ref}} - 0\\right) + \\beta\\left((36 - 2y) - 35\\right) + \\kappa(p_{\\mathrm{ref}} - 0)\\right]\n$$\n$$\n\\sigma_{2}(y) = \\rho_{0}\\left[-\\alpha(24 - 20y) - \\alpha\\Gamma p_{\\mathrm{ref}} + \\beta(1 - 2y) + \\kappa p_{\\mathrm{ref}}\\right]\n$$\n为了确定 $\\sigma_2(y)$ 的行为，我们按 $y$ 的幂次对各项进行分组：\n$$\n\\sigma_{2}(y) = \\rho_{0}\\left[(-24\\alpha - \\alpha\\Gamma p_{\\mathrm{ref}} + \\beta + \\kappa p_{\\mathrm{ref}}) + (20\\alpha - 2\\beta)y \\right]\n$$\n这表明 $\\sigma_2(y)$ 是 $y$ 的一个线性函数。\n\n第三步：$\\sigma_2(y)$ 的最大化\n一个在闭区间 $[0,1]$ 上的线性函数在其端点之一处达到其最大值。如果斜率为正，最大值出现在 $y=1$ 处；如果斜率为负，则出现在 $y=0$ 处。$\\sigma_2(y)$ 相对于 $y$ 的斜率与 $(20\\alpha - 2\\beta)$ 成正比。让我们使用所提供的常数来评估这一项的符号：\n$\\alpha = 2.0 \\times 10^{-4}$ K$^{-1}$\n$\\beta = 8.0 \\times 10^{-4}$\n斜率项为：\n$$\n20\\alpha - 2\\beta = 20(2.0 \\times 10^{-4}) - 2(8.0 \\times 10^{-4}) = 40 \\times 10^{-4} - 16 \\times 10^{-4} = 24 \\times 10^{-4}\n$$\n由于 $24 \\times 10^{-4} > 0$，$\\sigma_2(y)$ 的斜率为正。因此，该函数在 $y \\in [0,1]$ 上单调递增，其最大值出现在 $y=1$ 处。\n$$\n\\sigma_{b}^{\\star} = \\max_{y\\in[0,1]} \\sigma_{2}(y) = \\sigma_{2}(1)\n$$\n\n第四步：数值计算\n我们现在计算 $\\sigma_2(1)$ 的值。首先，我们求出 $y=1$ 时的表面性质和位温：\n$$\nT_s(1) = 24 - 20(1) = 4 \\, {}^{\\circ}\\mathrm{C}\n$$\n$$\nS_s(1) = 36 - 2(1) = 34 \\, \\text{psu}\n$$\n在 $y=1$ 处参考于 $p_{\\mathrm{ref}} = 2000$ dbar 的位温是：\n$$\n\\theta(1; p_{\\mathrm{ref}}) = T_s(1) + \\Gamma p_{\\mathrm{ref}} = 4 + (1.2 \\times 10^{-4})(2000) = 4 + 0.24 = 4.24 \\, {}^{\\circ}\\mathrm{C}\n$$\n现在，我们将这些值代入在 $y=1$ 处计算的 $\\sigma_2(y)$ 表达式中：\n$$\n\\sigma_{b}^{\\star} = \\sigma_{2}(1) = \\rho_{0}\\left[-\\alpha(\\theta(1; p_{\\mathrm{ref}}) - T_{0}) + \\beta(S_{s}(1) - S_{0}) + \\kappa(p_{\\mathrm{ref}} - p_{0})\\right]\n$$\n使用给定的常数： $\\rho_0 = 1000$, $\\alpha = 2.0\\times 10^{-4}$, $\\beta = 8.0\\times 10^{-4}$, $\\kappa = 4.5\\times 10^{-6}$, $T_0 = 0$, $S_0 = 35$, $p_0 = 0$, $p_{\\text{ref}} = 2000$。\n$$\n\\sigma_{b}^{\\star} = 1000\\left[-(2.0 \\times 10^{-4})(4.24 - 0) + (8.0 \\times 10^{-4})(34 - 35) + (4.5 \\times 10^{-6})(2000 - 0)\\right]\n$$\n$$\n\\sigma_{b}^{\\star} = 1000\\left[-(2.0 \\times 10^{-4})(4.24) + (8.0 \\times 10^{-4})(-1) + (4.5 \\times 10^{-6})(2000)\\right]\n$$\n$$\n\\sigma_{b}^{\\star} = 1000\\left[-8.48 \\times 10^{-4} - 8.0 \\times 10^{-4} + 90 \\times 10^{-4}\\right]\n$$\n$$\n\\sigma_{b}^{\\star} = 1000\\left[(-8.48 - 8.0 + 90) \\times 10^{-4}\\right]\n$$\n$$\n\\sigma_{b}^{\\star} = 1000\\left[73.52 \\times 10^{-4}\\right]\n$$\n$$\n\\sigma_{b}^{\\star} = 7.352\n$$\n结果有四位有效数字，符合要求。为防止等密面层冬季露头所需的最小边界值为 $7.352$ kg m$^{-3}$。",
            "answer": "$$\n\\boxed{7.352}\n$$"
        },
        {
            "introduction": "海洋模拟的一个主要挑战是精确表示压力梯度力，尤其是在复杂地形上。本练习展示了一个在地形跟随（sigma）坐标系中出现的典型数值问题，即“压力梯度误差”。通过分析一个具有倾斜海底地形的静止海洋，你将量化由离散压力计算产生的伪（非物理）加速度，这凸显了开发如等密度面模型等替代坐标系的一个关键动机。",
            "id": "4072287",
            "problem": "考虑一个稳定分层的静止海洋，其状态由静力平衡和 Boussinesq 动量方程描述。自由表面位于 $z = 0$，海底位于 $z = -H(x)$，其中 $H(x)$ 因倾斜的海底地形而随水平位置 $x$ 缓慢变化。密度场为双层结构，且仅取决于位势高度 $z$：当 $-h_{1} \\le z \\le 0$ 时，$\\rho(z) = \\rho_{1}$；当 $-H(x) \\le z  -h_{1}$ 时，$\\rho(z) = \\rho_{2}$，其中 $\\rho_{2}  \\rho_{1}$ 为常数，且在 $z = -h_{1}$ 处有一个平坦的界面。假设自由表面是平坦的，海洋处于动力学静止状态，因此在恒定位势高度上的真实水平压力梯度为零。\n\n现在采用地形跟随垂直坐标 $\\sigma = z / H(x)$，其中 $\\sigma = 0$ 对应表面，$\\sigma = -1$ 对应海底。在数值离散化中，固定 $\\sigma$-层上的水平压力梯度通常通过对相邻列上相同 $\\sigma$ 处计算的静力积分压力进行有限差分来近似。当 $\\rho$ 仅依赖于 $z$ 但积分下限通过 $H(x)$ 依赖于 $x$ 时，这种方法会引入一个虚假的水平压力梯度。\n\n从静力关系 $\\partial p / \\partial z = - \\rho g$（其中 $g$ 是重力加速度）出发，推导在固定 $\\sigma = \\sigma_{0}$ 处计算的精确虚假水平压力梯度 $\\partial p / \\partial x$，并用 $g$、$\\sigma_{0}$、$\\partial H / \\partial x$ 以及积分下限处的密度来表示。然后，利用该层上的 Boussinesq 形式动量方程 $\\partial u / \\partial t = - (1 / \\rho_{0}) \\, \\partial p / \\partial x$，估算由该虚假压力梯度项产生的瞬时水平加速度大小。\n\n使用以下科学上一致的参数值：$g = 9.81 \\ \\mathrm{m} \\ \\mathrm{s}^{-2}$，$\\rho_{1} = 1025 \\ \\mathrm{kg} \\ \\mathrm{m}^{-3}$，$\\rho_{2} = 1027 \\ \\mathrm{kg} \\ \\mathrm{m}^{-3}$，$\\rho_{0} = 1025 \\ \\mathrm{kg} \\ \\mathrm{m}^{-3}$，$h_{1} = 100 \\ \\mathrm{m}$，$H(x) = H_{0} + s x$，其中 $H_{0} = 4000 \\ \\mathrm{m}$ 且 $s = \\partial H / \\partial x = 1.0 \\times 10^{-4}$ (无量纲斜率)，以及 $\\sigma_{0} = -0.5$。验证对于这些参数，$\\sigma_{0}$ 层位于下层之内，并在您的表达式中使用适当的密度。将最终加速度大小以 $\\mathrm{m} \\ \\mathrm{s}^{-2}$ 为单位表示，并将您的答案四舍五入到三位有效数字。",
            "solution": "用户希望解决一个关于简化海洋模型中地形跟随坐标系内虚假压力梯度的问题。\n\n### 步骤1：提取已知条件\n- **海洋模型**：稳定分层，静止，静力平衡，Boussinesq 动量方程。\n- **几何结构**：自由表面位于 $z = 0$，海底位于 $z = -H(x)$。\n- **地形**：$H(x)$ 随 $x$ 缓慢变化。\n- **密度场**：双层结构，仅依赖于 $z$。\n  - 当 $-h_{1} \\le z \\le 0$ 时，$\\rho(z) = \\rho_{1}$。\n  - 当 $-H(x) \\le z  -h_{1}$ 时，$\\rho(z) = \\rho_{2}$。\n- **常数与条件**：$\\rho_{2}  \\rho_{1}$，界面在 $z = -h_{1}$ 处是平坦的。自由表面是平坦的。\n- **动力学状态**：海洋处于静止状态，意味着在恒定位势高度 $z$ 上的真实水平压力梯度为零：$\\left. \\frac{\\partial p}{\\partial x} \\right|_{z} = 0$。\n- **坐标系**：地形跟随坐标 $\\sigma = z / H(x)$，其中 $z=0$ 时 $\\sigma = 0$，$z=-H(x)$ 时 $\\sigma = -1$。\n- **静力关系**：$\\frac{\\partial p}{\\partial z} = - \\rho g$。\n- **动量方程**：Boussinesq 形式，$\\frac{\\partial u}{\\partial t} = - \\frac{1}{\\rho_{0}} \\frac{\\partial p}{\\partial x}$。\n- **任务1**：推导在固定 $\\sigma = \\sigma_{0}$ 处的精确虚假水平压力梯度 $\\left. \\frac{\\partial p}{\\partial x} \\right|_{\\sigma_0}$。\n- **任务2**：根据此虚假梯度估算瞬时水平加速度大小 $|\\frac{\\partial u}{\\partial t}|$。\n- **参数值**：\n  - $g = 9.81 \\ \\mathrm{m} \\ \\mathrm{s}^{-2}$\n  - $\\rho_{1} = 1025 \\ \\mathrm{kg} \\ \\mathrm{m}^{-3}$\n  - $\\rho_{2} = 1027 \\ \\mathrm{kg} \\ \\mathrm{m}^{-3}$\n  - $\\rho_{0} = 1025 \\ \\mathrm{kg} \\ \\mathrm{m}^{-3}$\n  - $h_{1} = 100 \\ \\mathrm{m}$\n  - $H(x) = H_{0} + s x$，其中 $H_{0} = 4000 \\ \\mathrm{m}$ 且 $s = \\frac{\\partial H}{\\partial x} = 1.0 \\times 10^{-4}$\n  - $\\sigma_{0} = -0.5$\n- **验证要求**：检查 $\\sigma_0$ 层是否位于下层。\n- **最终答案格式**：加速度大小以 $\\mathrm{m} \\ \\mathrm{s}^{-2}$ 为单位，四舍五入到三位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学基础**：该问题在地球物理流体动力学中有坚实的基础。sigma 坐标系中的压力梯度误差是数值海洋和大气建模中的一个典型且重要的问题。控制方程和物理设置都是标准的。\n- **适定性**：问题陈述清晰，提供了推导所需量和计算数值答案所需的所有信息。求解路径是唯一的。\n- **客观性**：问题以客观、科学的术语陈述。\n- **缺陷清单**：该问题没有违反任何指定的无效性标准。它在科学上是合理的、可形式化的、完整的、现实的且适定的。参数对于海洋环境是物理上一致的。\n\n### 步骤3：结论与行动\n该问题有效。将提供完整解答。\n\n### 求解推导\n\n该问题要求我们找出在静止海洋中，地形跟随坐标面上出现的虚假水平压力梯度。在一个具有平坦自由表面的静止、静力平衡的海洋中，真实的压力场 $p$ 仅是位势高度 $z$ 的函数，即 $p = p(z)$。如题目所给，恒定 $z$ 面上的水平压力梯度为零：$\\left. \\frac{\\partial p}{\\partial x} \\right|_{z} = 0$。\n\n首先，我们通过对静力关系 $\\frac{\\partial p}{\\partial z} = -\\rho(z)g$ 进行积分来确定压力 $p(z)$。我们从自由表面 $z=0$（在此我们假设表压为零，$p(0)=0$）向下积分至深度 $z$。\n$$p(z) = \\int_{z}^{0} \\rho(z') g \\, dz'$$\n考虑到双层密度结构，我们必须对深度 $z$ 分两种情况讨论。\n\n情况1：上层 ($-h_{1} \\le z \\le 0$)\n$$p(z) = \\int_{z}^{0} \\rho_{1} g \\, dz' = \\rho_{1} g [z']_{z}^{0} = -\\rho_{1} g z$$\n情况2：下层 ($z  -h_{1}$)\n积分必须在界面 $z' = -h_{1}$ 处分开：\n$$p(z) = \\int_{-h_{1}}^{0} \\rho_{1} g \\, dz' + \\int_{z}^{-h_{1}} \\rho_{2} g \\, dz'$$\n$$p(z) = \\rho_{1} g [z']_{-h_{1}}^{0} + \\rho_{2} g [z']_{z}^{-h_{1}}$$\n$$p(z) = \\rho_{1} g (0 - (-h_{1})) + \\rho_{2} g (-h_{1} - z)$$\n$$p(z) = g \\rho_{1} h_{1} - g \\rho_{2} h_{1} - g \\rho_{2} z = g(\\rho_{1} - \\rho_{2})h_{1} - g \\rho_{2} z$$\n该表达式给出了下层内任意深度 $z$ 处的压力。\n\n接下来，我们引入地形跟随坐标 $\\sigma = z/H(x)$。一个恒定的 $\\sigma = \\sigma_{0}$ 表面对应于一个随水平位置 $x$ 变化的位势高度 $z_0(x) = \\sigma_{0} H(x)$。这个 $\\sigma$ 表面上的压力，我们记为 $P(x, \\sigma_{0})$，由高度 $z_0(x)$ 处的静力压力给出：\n$$P(x, \\sigma_{0}) = p(z_0(x)) = p(\\sigma_{0} H(x))$$\n虚假的水平压力梯度是该压力场在恒定 $\\sigma$ 表面上的梯度，$\\left. \\frac{\\partial P}{\\partial x} \\right|_{\\sigma_{0}}$。我们可以使用链式法则来计算它：\n$$\\left. \\frac{\\partial P}{\\partial x} \\right|_{\\sigma_{0}} = \\frac{dp}{dz} \\frac{\\partial z_{0}}{\\partial x}$$\n根据静力平衡，$\\frac{dp}{dz} = -\\rho(z)g$。$z_0(x)$ 的导数是 $\\frac{\\partial z_{0}}{\\partial x} = \\frac{\\partial}{\\partial x}(\\sigma_{0} H(x)) = \\sigma_{0} \\frac{dH}{dx}$。\n将这些代入链式法则表达式，得到虚假压力梯度的一般公式：\n$$\\left. \\frac{\\partial p}{\\partial x} \\right|_{\\sigma_{0}} = -g \\rho(z_0) \\sigma_{0} \\frac{dH}{dx}$$\n这里，$\\rho(z_0)$ 是 $z_0 = \\sigma_{0}H(x)$ 高度处的密度。\n\n在进行计算之前，我们必须按要求验证 $\\sigma_{0} = -0.5$ 层位于下层。下层存在于 $z  -h_{1}$。我们必须检查是否 $z_0(x)  -h_{1}$。\n$$z_0(x) = \\sigma_{0} H(x) = -0.5 H(x)$$\n条件变为 $-0.5 H(x)  -h_{1}$，可简化为 $H(x)  2 h_{1}$。\n使用给定参数，$h_{1} = 100 \\ \\mathrm{m}$，因此 $2 h_{1} = 200 \\ \\mathrm{m}$。总深度为 $H(x) = H_{0} + sx = 4000 \\ \\mathrm{m} + (1.0 \\times 10^{-4})x$。由于最小深度为 $H_0 = 4000 \\ \\mathrm{m}$（在 $x=0$ 处），并且随 $x$ 增加，我们有 $H(x) \\ge 4000 \\ \\mathrm{m}$。\n条件 $4000 \\ \\mathrm{m}  200 \\ \\mathrm{m}$ 显然成立。因此，$\\sigma_{0} = -0.5$ 层确实在下层中。\n\n该高度处的密度为 $\\rho(z_0) = \\rho_{2}$。问题还提到了“积分下限处的密度”，即海底 $z=-H(x)$ 处的密度。由于海底是下层的底部，该密度也是 $\\rho_2$。因此，虚假压力梯度的表达式为：\n$$\\left. \\frac{\\partial p}{\\partial x} \\right|_{\\sigma_{0}} = -g \\rho_{2} \\sigma_{0} \\frac{dH}{dx}$$\n瞬时水平加速度 $\\frac{\\partial u}{\\partial t}$ 由 Boussinesq 动量方程给出：\n$$\\frac{\\partial u}{\\partial t} = -\\frac{1}{\\rho_{0}} \\left. \\frac{\\partial p}{\\partial x} \\right|_{\\sigma_{0}}$$\n代入虚假压力梯度的表达式：\n$$\\frac{\\partial u}{\\partial t} = -\\frac{1}{\\rho_{0}} \\left( -g \\rho_{2} \\sigma_{0} \\frac{dH}{dx} \\right) = \\frac{g \\rho_{2} \\sigma_{0}}{\\rho_{0}} \\frac{dH}{dx}$$\n该加速度的大小为：\n$$\\left| \\frac{\\partial u}{\\partial t} \\right| = \\left| \\frac{g \\rho_{2} \\sigma_{0}}{\\rho_{0}} \\frac{dH}{dx} \\right| = \\frac{g \\rho_{2} |\\sigma_{0}|}{\\rho_{0}} \\frac{dH}{dx}$$\n我们使用绝对值 $|\\sigma_0|$ 并根据 $s  0$ 假设 $\\frac{dH}{dx}  0$。\n\n现在我们代入所给的数值：\n- $g = 9.81 \\ \\mathrm{m} \\ \\mathrm{s}^{-2}$\n- $\\rho_{2} = 1027 \\ \\mathrm{kg} \\ \\mathrm{m}^{-3}$\n- $\\rho_{0} = 1025 \\ \\mathrm{kg} \\ \\mathrm{m}^{-3}$\n- $\\sigma_{0} = -0.5$，所以 $|\\sigma_{0}| = 0.5$\n- $\\frac{dH}{dx} = s = 1.0 \\times 10^{-4}$\n\n$$\\left| \\frac{\\partial u}{\\partial t} \\right| = \\frac{(9.81 \\ \\mathrm{m} \\ \\mathrm{s}^{-2}) (1027 \\ \\mathrm{kg} \\ \\mathrm{m}^{-3}) (0.5)}{1025 \\ \\mathrm{kg} \\ \\mathrm{m}^{-3}} (1.0 \\times 10^{-4})$$\n$$\\left| \\frac{\\partial u}{\\partial t} \\right| = \\frac{9.81 \\times 1027 \\times 0.5}{1025} \\times 10^{-4} \\ \\mathrm{m} \\ \\mathrm{s}^{-2}$$\n$$\\left| \\frac{\\partial u}{\\partial t} \\right| = \\frac{5037.435}{1025} \\times 10^{-4} \\ \\mathrm{m} \\ \\mathrm{s}^{-2}$$\n$$\\left| \\frac{\\partial u}{\\partial t} \\right| = 4.9145707... \\times 10^{-4} \\ \\mathrm{m} \\ \\mathrm{s}^{-2}$$\n将结果四舍五入到三位有效数字，我们得到：\n$$\\left| \\frac{\\partial u}{\\partial t} \\right| \\approx 4.91 \\times 10^{-4} \\ \\mathrm{m} \\ \\mathrm{s}^{-2}$$",
            "answer": "$$\\boxed{4.91 \\times 10^{-4}}$$"
        },
        {
            "introduction": "垂直坐标系的选择不仅影响模型的准确性，还影响其计算效率。本实践探讨了Courant-Friedrichs-Lewy (CFL) 稳定性条件，该条件限制了显式数值方案的最大时间步长。你将推导此条件并将其应用于z坐标、等密度面和板层模型，揭示不同的垂直过程如何对模型的时间步长施加截然不同的约束，并阐明模型设计中涉及的权衡。",
            "id": "4072300",
            "problem": "考虑一个用于数值天气预报和气候模拟的海洋环流模式，该模式采用显式格式来推进垂直平流作用下的示踪剂浓度。设示踪剂满足通用垂直坐标 $s$ 中的一维线性平流方程 $\\partial q / \\partial t + c_{s} \\, \\partial q / \\partial s = 0$，其中 $c_{s}$ 是 $s$ 坐标中的逆变平流速度。假设在间距为 $\\Delta s$ 的均匀网格上采用标准的显式时间更新和有限体积空间离散化。通过要求数值依赖域包含偏微分方程的依赖域，推导显式平流在时间步长上关于 $c_{s}$ 和 $\\Delta s$ 的必要稳定性限制。然后将此限制具体应用于三种海洋垂直坐标系：\n\n- $z$坐标模式，其中 $s=z$，逆变速度为垂直速度 $w$，网格间距为 $\\Delta z$。\n- 等密度面坐标模式，其中 $s=\\sigma$ 表示位势密度，逆变速度为位势密度的物质变化率 $r = D\\sigma / Dt$，网格间距为 $\\Delta \\sigma$。\n- 板式混合层模式，其中混合层厚度 $H$ 是一个单一的预报层，其下边界是一个受卷夹速度 $w_{e}$ 影响的界面；将跨界面的显式质量交换视为平流位移，并要求界面锋面在每个步长内移动不超过一个层厚。\n\n使用您推导出的限制，为以下科学上合理的参数计算同时满足所有三个坐标系稳定性约束的最大允许显式时间步长 $\\Delta t_{\\text{max}}$：\n- $z$坐标：$\\Delta z = 5~\\text{m}$ 和 $|w_{\\text{max}}| = 1.5 \\times 10^{-3}~\\text{m}~\\text{s}^{-1}$，\n- 等密度面坐标：$\\Delta \\sigma = 0.10~\\text{kg}~\\text{m}^{-3}$ 和 $|r_{\\text{max}}| = 5.0 \\times 10^{-6}~\\text{kg}~\\text{m}^{-3}~\\text{s}^{-1}$，\n- 板式模式：$H = 50~\\text{m}$ 和 $|w_{e,\\text{max}}| = 1.0 \\times 10^{-4}~\\text{m}~\\text{s}^{-1}$。\n\n以秒为单位表示您的最终答案，并四舍五入到四位有效数字。简要讨论您的结果对这三种坐标选择中时间步进的影响，包括垂直过程的显式与隐式处理的作用，以及对分裂或子循环时间步进的后果。",
            "solution": "该问题要求推导显式平流格式的数值稳定性判据，并将其应用于海洋模拟中使用的三种不同垂直坐标系。\n\n首先，我们推导通用的稳定性限制。控制方程是通用垂直坐标 $s$ 中示踪剂浓度 $q$ 的一维线性平流方程：\n$$ \\frac{\\partial q}{\\partial t} + c_{s} \\frac{\\partial q}{\\partial s} = 0 $$\n其中 $c_s$ 是 $s$ 坐标中的常数平流速度。该偏微分方程（PDE）的解是 $q$ 沿特征线保持不变，特征线由常微分方程 $\\frac{ds}{dt} = c_s$ 定义。时空中某点 $(s_j, t^{n+1})$ 的解值由前一时间层上某点 $(s_p, t^n)$ 的值确定，其中 $s_p$ 是通过将特征线在时间上回溯 $\\Delta t$ 找到的。具体来说，$s_p = s_j - c_s \\Delta t$。点 $(s_p, t^n)$ 构成了点 $(s_j, t^{n+1})$ 处偏微分方程解的依赖域。\n\n对于在均匀间距为 $\\Delta s$、时间步长为 $\\Delta t$ 的网格上的数值解，显式格式使用前一时间步 $t^n$ 处相邻网格点的值来计算网格点 $s_j$ 的新值 $q_j^{n+1}$。例如，如果 $c_s  0$，一阶迎风格式使用 $q_j^n$ 和 $q_{j-1}^n$；如果 $c_s  0$，则使用 $q_j^n$ 和 $q_{j+1}^n$。$t^n$ 时刻影响 $(s_j, t^{n+1})$ 处解的网格点集合是数值依赖域。对于简单的一阶迎风格式，当 $c_s  0$ 时，该区域为区间 $[s_{j-1}, s_j]$；当 $c_s  0$ 时，为区间 $[s_j, s_{j+1}]$。\n\n数值稳定性的 Courant-Friedrichs-Lewy (CFL) 条件要求偏微分方程的依赖域必须位于数值格式的依赖域之内。这确保了数值格式能够获取正确计算解所需的所有物理信息。\n\n情况1：$c_s  0$。数值依赖域为 $[s_{j-1}, s_j]$。我们要求特征线的起始点 $s_p = s_j - c_s \\Delta t$ 在此区间内：\n$$ s_{j-1} \\le s_j - c_s \\Delta t \\le s_j $$\n右侧的不等式 $s_j - c_s \\Delta t \\le s_j$ 可简化为 $-c_s \\Delta t \\le 0$，对于 $c_s  0$ 和 $\\Delta t  0$ 恒成立。左侧的不等式给出：\n$$ s_j - \\Delta s \\le s_j - c_s \\Delta t $$\n$$ - \\Delta s \\le -c_s \\Delta t $$\n$$ c_s \\Delta t \\le \\Delta s $$\n\n情况2：$c_s  0$。数值依赖域为 $[s_j, s_{j+1}]$。我们要求 $s_p = s_j - c_s \\Delta t$ 在此区间内：\n$$ s_j \\le s_j - c_s \\Delta t \\le s_{j+1} $$\n左侧的不等式 $s_j \\le s_j - c_s \\Delta t$ 可简化为 $0 \\le -c_s \\Delta t$，对于 $c_s  0$ 和 $\\Delta t  0$ 恒成立。右侧的不等式给出：\n$$ s_j - c_s \\Delta t \\le s_j + \\Delta s $$\n$$ -c_s \\Delta t \\le \\Delta s $$\n\n综合两种情况，我们可以使用 $c_s$ 的绝对值写出一个统一的条件：\n$$ |c_s| \\Delta t \\le \\Delta s $$\n这就得出了对时间步长 $\\Delta t$ 的必要稳定性限制：\n$$ \\Delta t \\le \\frac{\\Delta s}{|c_s|} $$\n无量纲量 $C = \\frac{|c_s| \\Delta t}{\\Delta s}$ 被称为库朗数，稳定性条件是 $C \\le 1$。\n\n接下来，我们将这个通用限制具体应用于给定的三种海洋垂直坐标系。\n\n1.  **$z$坐标模式：** 在该系统中，垂直坐标为深度 $s=z$，网格间距为 $\\Delta s = \\Delta z$，逆变速度为垂直速度 $c_s = w$。稳定性判据是：\n    $$ \\Delta t_z \\le \\frac{\\Delta z}{|w|} $$\n\n2.  **等密度面坐标模式：** 在此，垂直坐标为位势密度 $s=\\sigma$，网格间距为 $\\Delta s = \\Delta \\sigma$，逆变速度为位势密度的物质变化率 $c_s = r = D\\sigma/Dt$。这一项代表导致水块穿过等密度面（isopycnals）的非绝热过程。稳定性判据是：\n    $$ \\Delta t_\\sigma \\le \\frac{\\Delta \\sigma}{|r|} $$\n\n3.  **板式混合层模式：** 这种情况是物理描述的。我们将由于卷夹引起的跨界面显式质量交换视为平流位移。卷夹速度为 $w_e$。在时间步长 $\\Delta t$ 内，界面移动的距离为 $|w_e| \\Delta t$。问题要求该位移不超过一个层厚 $H$。这是一个CFL条件的直接物理陈述，其中“网格单元”是整个厚度为 $H$ 的混合层。\n    $$ |w_e| \\Delta t \\le H $$\n    因此，稳定性判据是：\n    $$ \\Delta t_H \\le \\frac{H}{|w_e|} $$\n\n现在，我们使用所提供的参数计算每个约束下的最大允许时间步长。每种情况下的最大时间步长受限于预期的最大速度。\n\n对于 $z$ 坐标模式：\n$\\Delta z = 5 \\text{ m}$ 和 $|w_{\\text{max}}| = 1.5 \\times 10^{-3} \\text{ m s}^{-1}$。\n$$ \\Delta t_{z, \\text{max}} = \\frac{\\Delta z}{|w_{\\text{max}}|} = \\frac{5}{1.5 \\times 10^{-3}} \\text{ s} = \\frac{10}{3} \\times 10^3 \\text{ s} \\approx 3333.33 \\text{ s} $$\n\n对于等密度面坐标模式：\n$\\Delta \\sigma = 0.10 \\text{ kg m}^{-3}$ 和 $|r_{\\text{max}}| = 5.0 \\times 10^{-6} \\text{ kg m}^{-3} \\text{ s}^{-1}$。\n$$ \\Delta t_{\\sigma, \\text{max}} = \\frac{\\Delta \\sigma}{|r_{\\text{max}}|} = \\frac{0.10}{5.0 \\times 10^{-6}} \\text{ s} = 0.02 \\times 10^6 \\text{ s} = 20000 \\text{ s} $$\n\n对于板式混合层模式：\n$H = 50 \\text{ m}$ 和 $|w_{e,\\text{max}}| = 1.0 \\times 10^{-4} \\text{ m s}^{-1}$。\n$$ \\Delta t_{H, \\text{max}} = \\frac{H}{|w_{e,\\text{max}}|} = \\frac{50}{1.0 \\times 10^{-4}} \\text{ s} = 50 \\times 10^4 \\text{ s} = 500000 \\text{ s} $$\n\n显式时间步进格式必须对所有过程同时保持稳定。因此，总的最大允许时间步长 $\\Delta t_{\\text{max}}$ 是各个最大值中的最小值：\n$$ \\Delta t_{\\text{max}} = \\min(\\Delta t_{z, \\text{max}}, \\Delta t_{\\sigma, \\text{max}}, \\Delta t_{H, \\text{max}}) $$\n$$ \\Delta t_{\\text{max}} = \\min(3333.33..., 20000, 500000) \\text{ s} = 3333.33... \\text{ s} $$\n四舍五入到四位有效数字，最终答案是 $3333 \\text{ s}$。\n\n最后，我们讨论这一结果的影响。计算表明，对于给定的合理参数，$z$坐标模式中的垂直平流是限制性最强的过程，将显式时间步长限制在约 $55.5$ 分钟。等密度面坐标允许垂直（跨等密度面）过程有明显更大的时间步长，而板式模式的限制性是迄今为止最弱的。这突显了海洋模式设计中的一个关键权衡：$z$坐标在几何上很简单，但可能因垂直平流而导致严重的时间步长限制，尤其是在高垂直分辨率下。\n\n为了克服这一限制，模式开发者采用了几种策略。一种是隐式处理垂直平流和扩散项。隐式格式对任何大小的时间步长都是数值稳定的（对于这个线性问题），从而消除了CFL约束，但代价是在每个时间步为每个水柱求解一个（三对角）线性方程组。另一种策略是时间分裂或子循环，其中“快”过程（如$z$坐标模式中的垂直平流）用较小的时间步长进行积分，而“慢”过程（如水平平流或热力学）则用大得多的时间步长推进。结果清楚地表明，为何$z$坐标模式中的垂直过程是隐式处理或子循环的主要候选者，这使得整个模式能够以由其他更慢现象决定的、计算效率更高的较大时间步长运行。",
            "answer": "$$\n\\boxed{3333}\n$$"
        }
    ]
}