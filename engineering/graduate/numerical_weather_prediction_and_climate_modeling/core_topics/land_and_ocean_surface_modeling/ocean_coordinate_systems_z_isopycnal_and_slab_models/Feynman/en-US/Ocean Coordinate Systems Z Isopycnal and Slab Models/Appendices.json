{
    "hands_on_practices": [
        {
            "introduction": "Isopycnal-coordinate models are built on the principle of using surfaces of constant potential density as vertical coordinate surfaces. A critical first step in designing such a model is selecting the set of isopycnal layers that will represent the ocean's stratification. This practice explores how to make this choice strategically, using hydrographic data to prevent model layers from intersecting the sea surface, a phenomenon known as outcropping, which can cause numerical difficulties. By working through this example , you will connect the fundamental concepts of potential temperature and potential density to the practical design of an ocean model.",
            "id": "4072211",
            "problem": "A meridional transect from subtropics to subpolar latitudes is indexed by a nondimensional coordinate $y \\in [0,1]$, where $y=0$ denotes the subtropical end and $y=1$ denotes the subpolar end. Winter surface conditions along the transect are well approximated by the following in situ temperature and salinity fields:\n- $T_{s}(y) = 24 - 20\\,y$ in degrees Celsius,\n- $S_{s}(y) = 36 - 2\\,y$ in practical salinity units.\n\nAssume the linearized equation of state for seawater,\n$$\n\\rho(S,T,p) = \\rho_{0}\\left[1 - \\alpha\\,(T - T_{0}) + \\beta\\,(S - S_{0}) + \\kappa\\,(p - p_{0})\\right],\n$$\nwith $\\rho_{0} = 1000$ kg m$^{-3}$, $T_{0} = 0^\\circ\\text{C}$, $S_{0} = 35$, $p_{0} = 0$ decibar, $\\alpha = 2.0\\times 10^{-4}$ K$^{-1}$, $\\beta = 8.0\\times 10^{-4}$, and $\\kappa = 4.5\\times 10^{-6}$ decibar$^{-1}$. Assume adiabatic motion with a constant adiabatic temperature gradient defined by\n$$\n\\frac{dT}{dp}\\bigg|_{\\mathrm{adiabatic}} = \\Gamma,\n$$\nwith $\\Gamma = 1.2 \\times 10^{-4}$ K decibar$^{-1}$, so that potential temperature referenced to a pressure level $p_{\\mathrm{ref}}$ is given by integrating the adiabatic gradient along pressure. Take the reference pressure to be $p_{\\mathrm{ref}} = 2000$ decibar.\n\nDefine the potential density referenced to $p_{\\mathrm{ref}}$ as $\\rho_{\\theta}(S,\\theta,p_{\\mathrm{ref}})$, where $\\theta$ is the potential temperature at $p_{\\mathrm{ref}}$, and the corresponding sigma-density referenced to $p_{\\mathrm{ref}}$ as\n$$\n\\sigma_{2}(y) \\equiv \\rho_{\\theta}\\big(S_{s}(y), \\theta(y;p_{\\mathrm{ref}}), p_{\\mathrm{ref}}\\big) - 1000.\n$$\n\nAn isopycnal-coordinate ocean model will employ a single interior isopycnal layer bounded above by the mixed layer and below by a density surface of value $\\sigma_{b}$. To eliminate winter outcropping of this interior-layer lower boundary everywhere along the transect, the boundary value must satisfy $\\sigma_{b} \\ge \\max_{y\\in[0,1]} \\sigma_{2}(y)$, and the minimal such choice is $\\sigma_{b}^{\\star} = \\max_{y\\in[0,1]} \\sigma_{2}(y)$.\n\nStarting from the given linear equation of state and adiabatic gradient definition, derive $\\sigma_{2}(y)$ and determine the minimal boundary value $\\sigma_{b}^{\\star}$. Provide your final result for $\\sigma_{b}^{\\star}$ in sigma-units (kg m$^{-3}$), rounded to four significant figures.",
            "solution": "The objective is to determine the minimal boundary value $\\sigma_{b}^{\\star}$, which is defined as the maximum value of the surface potential density anomaly $\\sigma_{2}(y)$ over the domain $y \\in [0,1]$.\n$$\n\\sigma_{b}^{\\star} = \\max_{y\\in[0,1]} \\sigma_{2}(y)\n$$\n\nThe solution proceeds in four steps:\n1.  Derive the potential temperature $\\theta$ as a function of the meridional coordinate $y$.\n2.  Derive the potential density anomaly $\\sigma_{2}$ as a function of $y$.\n3.  Determine the value of $y$ at which $\\sigma_{2}(y)$ is maximal.\n4.  Calculate the numerical value of this maximum.\n\nStep 1: Potential Temperature\nPotential temperature, $\\theta$, referenced to a pressure $p_{\\mathrm{ref}}$, is the temperature a water parcel would have if moved adiabatically from its initial pressure $p$ and in situ temperature $T$ to the reference pressure $p_{\\mathrm{ref}}$. The problem provides a constant adiabatic temperature gradient, $\\Gamma$.\n$$\n\\frac{dT}{dp}\\bigg|_{\\mathrm{adiabatic}} = \\Gamma\n$$\nFor a surface parcel at pressure $p_s \\approx 0$ with in situ temperature $T_s(y)$, its potential temperature $\\theta(y; p_{\\mathrm{ref}})$ at reference pressure $p_{\\mathrm{ref}}$ is found by integrating this relation:\n$$\n\\int_{T_s(y)}^{\\theta(y; p_{\\mathrm{ref}})} dT' = \\int_{0}^{p_{\\mathrm{ref}}} \\Gamma \\, dp'\n$$\n$$\n\\theta(y; p_{\\mathrm{ref}}) - T_s(y) = \\Gamma p_{\\mathrm{ref}}\n$$\n$$\n\\theta(y; p_{\\mathrm{ref}}) = T_s(y) + \\Gamma p_{\\mathrm{ref}}\n$$\nSubstituting the given expression for surface temperature, $T_s(y) = 24 - 20y$:\n$$\n\\theta(y; p_{\\mathrm{ref}}) = (24 - 20y) + \\Gamma p_{\\mathrm{ref}}\n$$\n\nStep 2: Potential Density Anomaly $\\sigma_2(y)$\nThe potential density anomaly referenced to $p_{\\mathrm{ref}} = 2000$ dbar, denoted $\\sigma_2(y)$, is defined as:\n$$\n\\sigma_{2}(y) = \\rho_{\\theta}\\big(S_{s}(y), \\theta(y; p_{\\mathrm{ref}}), p_{\\mathrm{ref}}\\big) - 1000\n$$\nwhere $\\rho_{\\theta}$ is the potential density. We use the given linearized equation of state, evaluated at pressure $p=p_{\\mathrm{ref}}$, salinity $S=S_s(y)$, and temperature $T = \\theta(y; p_{\\mathrm{ref}})$.\n$$\n\\rho(S,T,p) = \\rho_{0}\\left[1 - \\alpha(T - T_{0}) + \\beta(S - S_{0}) + \\kappa(p - p_{0})\\right]\n$$\nThe reference values are $\\rho_0 = 1000$ kg m$^{-3}$, $T_0 = 0^\\circ\\text{C}$, $S_0 = 35$, and $p_0 = 0$ dbar.\nThus, the potential density is:\n$$\n\\rho_{\\theta}(y) = \\rho_{0}\\left[1 - \\alpha(\\theta(y; p_{\\mathrm{ref}}) - T_{0}) + \\beta(S_{s}(y) - S_{0}) + \\kappa(p_{\\mathrm{ref}} - p_{0})\\right]\n$$\nSubstituting this into the definition of $\\sigma_2(y)$ and using $\\rho_0 = 1000$:\n$$\n\\sigma_{2}(y) = \\rho_{0}\\left[1 - \\alpha(\\theta(y; p_{\\mathrm{ref}}) - T_{0}) + \\beta(S_{s}(y) - S_{0}) + \\kappa(p_{\\mathrm{ref}} - p_{0})\\right] - \\rho_{0}\n$$\n$$\n\\sigma_{2}(y) = \\rho_{0}\\left[-\\alpha(\\theta(y; p_{\\mathrm{ref}}) - T_{0}) + \\beta(S_{s}(y) - S_{0}) + \\kappa(p_{\\mathrm{ref}} - p_{0})\\right]\n$$\nNow, we substitute the expressions for $\\theta(y; p_{\\mathrm{ref}})$, $S_s(y)$, and the reference constants:\n$$\n\\theta(y; p_{\\mathrm{ref}}) = (24 - 20y) + \\Gamma p_{\\mathrm{ref}}\n$$\n$$\nS_s(y) = 36 - 2y\n$$\n$$\n\\sigma_{2}(y) = \\rho_{0}\\left[-\\alpha\\left((24 - 20y) + \\Gamma p_{\\mathrm{ref}} - 0\\right) + \\beta\\left((36 - 2y) - 35\\right) + \\kappa(p_{\\mathrm{ref}} - 0)\\right]\n$$\n$$\n\\sigma_{2}(y) = \\rho_{0}\\left[-\\alpha(24 - 20y) - \\alpha\\Gamma p_{\\mathrm{ref}} + \\beta(1 - 2y) + \\kappa p_{\\mathrm{ref}}\\right]\n$$\nTo determine the behavior of $\\sigma_2(y)$, we group terms by powers of $y$:\n$$\n\\sigma_{2}(y) = \\rho_{0}\\left[(-24\\alpha - \\alpha\\Gamma p_{\\mathrm{ref}} + \\beta + \\kappa p_{\\mathrm{ref}}) + (20\\alpha - 2\\beta)y \\right]\n$$\nThis demonstrates that $\\sigma_2(y)$ is a linear function of $y$.\n\nStep 3: Maximization of $\\sigma_2(y)$\nA linear function on a closed interval $[0,1]$ attains its maximum at one of the endpoints. The maximum occurs at $y=1$ if the slope is positive, and at $y=0$ if the slope is negative. The slope of $\\sigma_2(y)$ with respect to $y$ is proportional to $(20\\alpha - 2\\beta)$. Let's evaluate the sign of this term using the provided constants:\n$\\alpha = 2.0 \\times 10^{-4}$ K$^{-1}$\n$\\beta = 8.0 \\times 10^{-4}$\nThe slope term is:\n$$\n20\\alpha - 2\\beta = 20(2.0 \\times 10^{-4}) - 2(8.0 \\times 10^{-4}) = 40 \\times 10^{-4} - 16 \\times 10^{-4} = 24 \\times 10^{-4}\n$$\nSince $24 \\times 10^{-4} > 0$, the slope of $\\sigma_2(y)$ is positive. Therefore, the function is monotonically increasing on $y \\in [0,1]$, and its maximum value occurs at $y=1$.\n$$\n\\sigma_{b}^{\\star} = \\max_{y\\in[0,1]} \\sigma_{2}(y) = \\sigma_{2}(1)\n$$\n\nStep 4: Numerical Calculation\nWe now calculate the value of $\\sigma_2(1)$. First, we find the surface properties and potential temperature at $y=1$:\n$$\nT_s(1) = 24 - 20(1) = 4^\\circ\\text{C}\n$$\n$$\nS_s(1) = 36 - 2(1) = 34 \\, \\text{psu}\n$$\nThe potential temperature at $y=1$ referenced to $p_{\\mathrm{ref}} = 2000$ dbar is:\n$$\n\\theta(1; p_{\\mathrm{ref}}) = T_s(1) + \\Gamma p_{\\mathrm{ref}} = 4 + (1.2 \\times 10^{-4})(2000) = 4 + 0.24 = 4.24^\\circ\\text{C}\n$$\nNow, we substitute these values into the expression for $\\sigma_2(y)$ evaluated at $y=1$:\n$$\n\\sigma_{b}^{\\star} = \\sigma_{2}(1) = \\rho_{0}\\left[-\\alpha(\\theta(1; p_{\\mathrm{ref}}) - T_{0}) + \\beta(S_{s}(1) - S_{0}) + \\kappa(p_{\\mathrm{ref}} - p_{0})\\right]\n$$\nUsing the given constants: $\\rho_0 = 1000$, $\\alpha = 2.0\\times 10^{-4}$, $\\beta = 8.0\\times 10^{-4}$, $\\kappa = 4.5\\times 10^{-6}$, $T_0 = 0$, $S_0 = 35$, $p_0 = 0$, $p_{\\text{ref}} = 2000$.\n$$\n\\sigma_{b}^{\\star} = 1000\\left[-(2.0 \\times 10^{-4})(4.24 - 0) + (8.0 \\times 10^{-4})(34 - 35) + (4.5 \\times 10^{-6})(2000 - 0)\\right]\n$$\n$$\n\\sigma_{b}^{\\star} = 1000\\left[-(2.0 \\times 10^{-4})(4.24) + (8.0 \\times 10^{-4})(-1) + (4.5 \\times 10^{-6})(2000)\\right]\n$$\n$$\n\\sigma_{b}^{\\star} = 1000\\left[-8.48 \\times 10^{-4} - 8.0 \\times 10^{-4} + 90 \\times 10^{-4}\\right]\n$$\n$$\n\\sigma_{b}^{\\star} = 1000\\left[(-8.48 - 8.0 + 90) \\times 10^{-4}\\right]\n$$\n$$\n\\sigma_{b}^{\\star} = 1000\\left[73.52 \\times 10^{-4}\\right]\n$$\n$$\n\\sigma_{b}^{\\star} = 7.352\n$$\nThe result has four significant figures, as requested. The minimal boundary value to prevent winter outcropping of the isopycnal layer is $7.352$ kg m$^{-3}$.",
            "answer": "$$\n\\boxed{7.352}\n$$"
        },
        {
            "introduction": "Terrain-following coordinates, or $\\sigma$-coordinates, are widely used in ocean models because they smoothly map a variable ocean bottom to a flat coordinate surface. However, this convenience comes at a cost: when isopycnals are not aligned with coordinate surfaces, significant errors in the calculation of the horizontal pressure gradient force can arise, generating fictitious currents. This hands-on problem  walks you through the classic case of a resting, stratified ocean over a gentle slope to derive the magnitude of this spurious acceleration from first principles, revealing a key challenge that motivates the development of alternative coordinate systems.",
            "id": "4072287",
            "problem": "Consider a stably stratified resting ocean described by the hydrostatic balance and the Boussinesq momentum equation. The free surface is at $z = 0$ and the bottom is at $z = -H(x)$, where $H(x)$ varies slowly with horizontal position $x$ due to sloping topography. The density field is two-layer and depends only on geopotential height $z$: $\\rho(z) = \\rho_{1}$ for $-h_{1} \\le z \\le 0$ and $\\rho(z) = \\rho_{2}$ for $-H(x) \\le z  -h_{1}$, with constant $\\rho_{2}  \\rho_{1}$ and a flat interface at $z = -h_{1}$. Assume the free surface is flat and the ocean is dynamically at rest so that the true horizontal pressure gradient at constant geopotential height is zero.\n\nNow adopt a terrain-following vertical coordinate $\\sigma = z / H(x)$, with $\\sigma = 0$ at the surface and $\\sigma = -1$ at the bottom. In a numerical discretization, the horizontal pressure gradient at a fixed $\\sigma$-level is often approximated by finite differences of hydrostatically integrated pressure evaluated at the same $\\sigma$ across adjacent columns. This introduces a spurious horizontal pressure gradient whenever $\\rho$ depends only on $z$ but the lower integration limit depends on $x$ through $H(x)$.\n\nStarting from the hydrostatic relation $\\partial p / \\partial z = - \\rho g$, where $g$ is gravitational acceleration, derive the exact spurious horizontal pressure gradient $\\partial p / \\partial x$ evaluated at a fixed $\\sigma = \\sigma_{0}$, expressed in terms of $g$, $\\sigma_{0}$, $\\partial H / \\partial x$, and the density at the lower integration limit. Then, using the Boussinesq form of the momentum equation $\\partial u / \\partial t = - (1 / \\rho_{0}) \\, \\partial p / \\partial x$ at that level, estimate the instantaneous horizontal acceleration magnitude generated by this spurious pressure-gradient term.\n\nUse the following scientifically consistent parameter values: $g = 9.81 \\, \\mathrm{m\\,s}^{-2}$, $\\rho_{1} = 1025 \\, \\mathrm{kg\\,m}^{-3}$, $\\rho_{2} = 1027 \\, \\mathrm{kg\\,m}^{-3}$, $\\rho_{0} = 1025 \\, \\mathrm{kg\\,m}^{-3}$, $h_{1} = 100 \\, \\mathrm{m}$, $H(x) = H_{0} + s x$ with $H_{0} = 4000 \\, \\mathrm{m}$ and $s = \\partial H / \\partial x = 1.0 \\times 10^{-4}$ (dimensionless slope), and $\\sigma_{0} = -0.5$. Verify that the $\\sigma_{0}$ level lies within the lower layer for these parameters, and use the appropriate density in your expression. Express the final acceleration magnitude in $\\mathrm{m\\,s}^{-2}$ and round your answer to three significant figures.",
            "solution": "The problem requires us to find the spurious horizontal pressure gradient that arises on a terrain-following coordinate surface in a resting ocean. In a resting, hydrostatically balanced ocean with a flat free surface, the true pressure field $p$ is only a function of the geopotential height $z$, i.e., $p = p(z)$. The horizontal pressure gradient on a surface of constant $z$ is zero, as given: $\\left. \\frac{\\partial p}{\\partial x} \\right|_{z} = 0$.\n\nFirst, we determine the pressure $p(z)$ by integrating the hydrostatic relation $\\frac{\\partial p}{\\partial z} = -\\rho(z)g$. We integrate from the free surface at $z=0$, where we assume the gauge pressure is zero ($p(0)=0$), down to a depth $z$.\n$$p(z) = \\int_{z}^{0} \\rho(z') g \\, dz'$$\nGiven the two-layer density structure, we must consider two cases for the depth $z$.\n\nCase 1: Upper layer ($-h_{1} \\le z \\le 0$)\n$$p(z) = \\int_{z}^{0} \\rho_{1} g \\, dz' = \\rho_{1} g [z']_{z}^{0} = -\\rho_{1} g z$$\nCase 2: Lower layer ($z  -h_{1}$)\nThe integration must be split at the interface $z' = -h_{1}$:\n$$p(z) = \\int_{-h_{1}}^{0} \\rho_{1} g \\, dz' + \\int_{z}^{-h_{1}} \\rho_{2} g \\, dz'$$\n$$p(z) = \\rho_{1} g [z']_{-h_{1}}^{0} + \\rho_{2} g [z']_{z}^{-h_{1}}$$\n$$p(z) = \\rho_{1} g (0 - (-h_{1})) + \\rho_{2} g (-h_{1} - z)$$\n$$p(z) = g \\rho_{1} h_{1} - g \\rho_{2} h_{1} - g \\rho_{2} z = g(\\rho_{1} - \\rho_{2})h_{1} - g \\rho_{2} z$$\nThis expression gives the pressure at any depth $z$ within the lower layer.\n\nNext, we introduce the terrain-following coordinate $\\sigma = z/H(x)$. A surface of constant $\\sigma = \\sigma_{0}$ corresponds to a geopotential height $z_0(x) = \\sigma_{0} H(x)$, which varies with horizontal position $x$. The pressure on this $\\sigma$-surface, which we denote as $P(x, \\sigma_{0})$, is given by the hydrostatic pressure at height $z_0(x)$:\n$$P(x, \\sigma_{0}) = p(z_0(x)) = p(\\sigma_{0} H(x))$$\nThe spurious horizontal pressure gradient is the gradient of this pressure field on the constant $\\sigma$-surface, $\\left. \\frac{\\partial P}{\\partial x} \\right|_{\\sigma_{0}}$. We can compute this using the chain rule:\n$$\\left. \\frac{\\partial P}{\\partial x} \\right|_{\\sigma_{0}} = \\frac{dp}{dz} \\frac{\\partial z_{0}}{\\partial x}$$\nFrom the hydrostatic balance, $\\frac{dp}{dz} = -\\rho(z)g$. The derivative of $z_0(x)$ is $\\frac{\\partial z_{0}}{\\partial x} = \\frac{\\partial}{\\partial x}(\\sigma_{0} H(x)) = \\sigma_{0} \\frac{dH}{dx}$.\nSubstituting these into the chain rule expression yields the general formula for the spurious pressure gradient:\n$$\\left. \\frac{\\partial p}{\\partial x} \\right|_{\\sigma_{0}} = -g \\rho(z_0) \\sigma_{0} \\frac{dH}{dx}$$\nHere, $\\rho(z_0)$ is the density at the level $z_0 = \\sigma_{0}H(x)$.\n\nBefore proceeding with the calculation, we must verify that the level $\\sigma_{0} = -0.5$ is in the lower layer, as required. The lower layer exists for $z  -h_{1}$. We must check if $z_0(x)  -h_{1}$.\n$$z_0(x) = \\sigma_{0} H(x) = -0.5 H(x)$$\nThe condition becomes $-0.5 H(x)  -h_{1}$, which simplifies to $H(x)  2 h_{1}$.\nUsing the given parameters, $h_{1} = 100 \\, \\mathrm{m}$, so $2 h_{1} = 200 \\, \\mathrm{m}$. The total depth is $H(x) = H_{0} + sx = 4000 \\, \\mathrm{m} + (1.0 \\times 10^{-4})x$. Since the minimum depth is $H_0 = 4000 \\, \\mathrm{m}$ (at $x=0$), and it increases with $x$, we have $H(x) \\ge 4000 \\, \\mathrm{m}$.\nThe condition $4000 \\, \\mathrm{m} > 200 \\, \\mathrm{m}$ is clearly satisfied. Therefore, the level $\\sigma_{0} = -0.5$ is indeed in the lower layer.\n\nThe density at this level is $\\rho(z_0) = \\rho_{2}$. The problem also refers to the \"density at the lower integration limit\", which is the density at the sea floor $z=-H(x)$. Since the sea floor is the bottom of the lower layer, this density is also $\\rho_2$. Thus, the expression for the spurious pressure gradient is:\n$$\\left. \\frac{\\partial p}{\\partial x} \\right|_{\\sigma_{0}} = -g \\rho_{2} \\sigma_{0} \\frac{dH}{dx}$$\nThe instantaneous horizontal acceleration $\\frac{\\partial u}{\\partial t}$ is given by the Boussinesq momentum equation:\n$$\\frac{\\partial u}{\\partial t} = -\\frac{1}{\\rho_{0}} \\left. \\frac{\\partial p}{\\partial x} \\right|_{\\sigma_{0}}$$\nSubstituting the expression for the spurious pressure gradient:\n$$\\frac{\\partial u}{\\partial t} = -\\frac{1}{\\rho_{0}} \\left( -g \\rho_{2} \\sigma_{0} \\frac{dH}{dx} \\right) = \\frac{g \\rho_{2} \\sigma_{0}}{\\rho_{0}} \\frac{dH}{dx}$$\nThe magnitude of this acceleration is:\n$$\\left| \\frac{\\partial u}{\\partial t} \\right| = \\left| \\frac{g \\rho_{2} \\sigma_{0}}{\\rho_{0}} \\frac{dH}{dx} \\right| = \\frac{g \\rho_{2} |\\sigma_{0}|}{\\rho_{0}} \\frac{dH}{dx}$$\nWe use the absolute value $|\\sigma_0|$ and assume $\\frac{dH}{dx} > 0$ as given by $s > 0$.\n\nNow we substitute the provided numerical values:\n- $g = 9.81 \\, \\mathrm{m\\,s}^{-2}$\n- $\\rho_{2} = 1027 \\, \\mathrm{kg\\,m}^{-3}$\n- $\\rho_{0} = 1025 \\, \\mathrm{kg\\,m}^{-3}$\n- $\\sigma_{0} = -0.5$, so $|\\sigma_{0}| = 0.5$\n- $\\frac{dH}{dx} = s = 1.0 \\times 10^{-4}$\n\n$$\\left| \\frac{\\partial u}{\\partial t} \\right| = \\frac{(9.81 \\, \\mathrm{m\\,s}^{-2}) (1027 \\, \\mathrm{kg\\,m}^{-3}) (0.5)}{1025 \\, \\mathrm{kg\\,m}^{-3}} (1.0 \\times 10^{-4})$$\n$$\\left| \\frac{\\partial u}{\\partial t} \\right| = \\frac{9.81 \\times 1027 \\times 0.5}{1025} \\times 10^{-4} \\, \\mathrm{m\\,s}^{-2}$$\n$$\\left| \\frac{\\partial u}{\\partial t} \\right| = \\frac{5037.435}{1025} \\times 10^{-4} \\, \\mathrm{m\\,s}^{-2}$$\n$$\\left| \\frac{\\partial u}{\\partial t} \\right| = 4.9145707... \\times 10^{-4} \\, \\mathrm{m\\,s}^{-2}$$\nRounding the result to three significant figures, we get:\n$$\\left| \\frac{\\partial u}{\\partial t} \\right| \\approx 4.91 \\times 10^{-4} \\, \\mathrm{m\\,s}^{-2}$$",
            "answer": "$$\\boxed{4.91 \\times 10^{-4}}$"
        },
        {
            "introduction": "Beyond representing physical processes accurately, a crucial aspect of a numerical model's design is its computational efficiency. The choice of vertical coordinate system directly impacts the maximum time step a model can take while remaining numerically stable, governed by the Courant-Friedrichs-Lewy (CFL) condition. This exercise  provides a practical comparison of the stability constraints for $z$-coordinate, isopycnal, and slab models, demonstrating how different physical velocities in each framework lead to vastly different computational demands.",
            "id": "4072300",
            "problem": "Consider an ocean general circulation model used in numerical weather prediction and climate modeling that advances tracer concentration with an explicit scheme for vertical advection. Let the tracer satisfy a one-dimensional linear advection equation in a generic vertical coordinate $s$ of the form $\\partial q / \\partial t + c_{s} \\, \\partial q / \\partial s = 0$, where $c_{s}$ is the contravariant advective speed in the $s$-coordinate. Assume a standard explicit time update and a finite-volume spatial discretization on a uniform grid in $s$ with spacing $\\Delta s$. Derive, by requiring the numerical domain of dependence to contain the partial differential equation domain of dependence, the necessary stability restriction on the time step for explicit advection in terms of $c_{s}$ and $\\Delta s$. Then specialize this restriction to three ocean vertical coordinate systems:\n\n- A $z$-coordinate model, where $s=z$ and the contravariant speed is the vertical velocity $w$ with grid spacing $\\Delta z$.\n- An isopycnal-coordinate model, where $s=\\sigma$ denotes potential density, the contravariant speed is the material rate of change of potential density $r = D\\sigma / Dt$, and the grid spacing is $\\Delta \\sigma$.\n- A slab mixed-layer model, where the mixed-layer thickness $H$ is a single prognostic layer bounded below by an interface subject to entrainment velocity $w_{e}$; treat the explicit mass exchange across the interface as an advective displacement and require the interfacial front not to cross more than one layer thickness per step.\n\nUsing your derived restrictions, compute the maximum allowable explicit time step $\\Delta t_{\\text{max}}$ that simultaneously satisfies all three coordinate-system stability constraints for the following scientifically plausible parameters:\n- $z$-coordinate: $\\Delta z = 5 \\, \\mathrm{m}$ and $|w_{\\text{max}}| = 1.5 \\times 10^{-3} \\, \\mathrm{m\\,s}^{-1}$,\n- isopycnal coordinate: $\\Delta \\sigma = 0.10 \\, \\mathrm{kg\\,m}^{-3}$ and $|r_{\\text{max}}| = 5.0 \\times 10^{-6} \\, \\mathrm{kg\\,m}^{-3}\\,\\mathrm{s}^{-1}$,\n- slab model: $H = 50 \\, \\mathrm{m}$ and $|w_{e,\\text{max}}| = 1.0 \\times 10^{-4} \\, \\mathrm{m\\,s}^{-1}$.\n\nExpress your final answer in seconds and round to four significant figures. Briefly discuss the implications of your result for time stepping in these three coordinate choices, including the role of explicit versus implicit treatment of vertical processes and the consequences for split or subcycled time stepping.",
            "solution": "The problem requires the derivation of a numerical stability criterion for an explicit advection scheme and its application to three different vertical coordinate systems used in ocean modeling.\n\nFirst, we derive the general stability restriction. The governing equation is the one-dimensional linear advection equation for a tracer concentration $q$ in a generic vertical coordinate $s$:\n$$ \\frac{\\partial q}{\\partial t} + c_{s} \\frac{\\partial q}{\\partial s} = 0 $$\nwhere $c_s$ is the constant advective speed in the $s$-coordinate. The solution to this partial differential equation (PDE) is that $q$ remains constant along characteristic lines, which are defined by the ordinary differential equation $\\frac{ds}{dt} = c_s$. The value of the solution at a point $(s_j, t^{n+1})$ in spacetime is determined by the value at a point $(s_p, t^n)$ on the previous time level, where $s_p$ is found by tracing the characteristic back in time by $\\Delta t$. Specifically, $s_p = s_j - c_s \\Delta t$. The point $(s_p, t^n)$ constitutes the domain of dependence for the PDE solution at $(s_j, t^{n+1})$.\n\nFor a numerical solution on a grid with uniform spacing $\\Delta s$ and time step $\\Delta t$, an explicit scheme calculates the new value $q_j^{n+1}$ at grid point $s_j$ using values from the previous time step $t^n$ at neighboring grid points. For example, a first-order upwind scheme uses $q_j^n$ and $q_{j-1}^n$ if $c_s  0$, or $q_j^n$ and $q_{j+1}^n$ if $c_s  0$. The set of grid points at $t^n$ that influences the solution at $(s_j, t^{n+1})$ is the numerical domain of dependence. For a simple upwind scheme, this domain is the interval $[s_{j-1}, s_j]$ for $c_s  0$ and $[s_j, s_{j+1}]$ for $c_s  0$.\n\nThe Courant-Friedrichs-Lewy (CFL) condition for numerical stability requires that the PDE's domain of dependence must lie within the numerical scheme's domain of dependence. This ensures that the numerical scheme has access to all the physical information required to correctly compute the solution.\n\nCase 1: $c_s  0$. The numerical domain of dependence is $[s_{j-1}, s_j]$. We require the characteristic origin point $s_p = s_j - c_s \\Delta t$ to be within this interval:\n$$ s_{j-1} \\le s_j - c_s \\Delta t \\le s_j $$\nThe right-hand inequality, $s_j - c_s \\Delta t \\le s_j$, simplifies to $-c_s \\Delta t \\le 0$, which is always true for $c_s  0$ and $\\Delta t  0$. The left-hand inequality gives:\n$$ s_j - \\Delta s \\le s_j - c_s \\Delta t $$\n$$ - \\Delta s \\le -c_s \\Delta t $$\n$$ c_s \\Delta t \\le \\Delta s $$\n\nCase 2: $c_s  0$. The numerical domain of dependence is $[s_j, s_{j+1}]$. We require $s_p = s_j - c_s \\Delta t$ to be within this interval:\n$$ s_j \\le s_j - c_s \\Delta t \\le s_{j+1} $$\nThe left-hand inequality, $s_j \\le s_j - c_s \\Delta t$, simplifies to $0 \\le -c_s \\Delta t$, which is always true for $c_s  0$ and $\\Delta t  0$. The right-hand inequality gives:\n$$ s_j - c_s \\Delta t \\le s_j + \\Delta s $$\n$$ -c_s \\Delta t \\le \\Delta s $$\n\nCombining both cases, we can use the absolute value of $c_s$ to write a single condition:\n$$ |c_s| \\Delta t \\le \\Delta s $$\nThis yields the necessary stability restriction on the time step $\\Delta t$:\n$$ \\Delta t \\le \\frac{\\Delta s}{|c_s|} $$\nThe dimensionless quantity $C = \\frac{|c_s| \\Delta t}{\\Delta s}$ is known as the Courant number, and the stability condition is $C \\le 1$.\n\nNext, we specialize this general restriction to the three given ocean vertical coordinate systems.\n\n1.  **$z$-coordinate model:** In this system, the vertical coordinate is depth, $s=z$, the grid spacing is $\\Delta s = \\Delta z$, and the contravariant speed is the vertical velocity, $c_s = w$. The stability criterion is:\n    $$ \\Delta t_z \\le \\frac{\\Delta z}{|w|} $$\n\n2.  **Isopycnal-coordinate model:** Here, the vertical coordinate is potential density, $s=\\sigma$, the grid spacing is $\\Delta s = \\Delta \\sigma$, and the contravariant speed is the material rate of change of potential density, $c_s = r = D\\sigma/Dt$. This term represents diabatic processes that cause water parcels to cross surfaces of constant density (isopycnals). The stability criterion is:\n    $$ \\Delta t_\\sigma \\le \\frac{\\Delta \\sigma}{|r|} $$\n\n3.  **Slab mixed-layer model:** This case is described physically. We treat the explicit mass exchange across the interface due to entrainment as an advective displacement. The entrainment velocity is $w_e$. In a time step $\\Delta t$, the interface moves a distance of $|w_e| \\Delta t$. The problem requires that this displacement does not exceed one layer thickness, $H$. This is a direct physical statement of the CFL condition where the \"grid cell\" is the entire mixed layer of thickness $H$.\n    $$ |w_e| \\Delta t \\le H $$\n    The stability criterion is therefore:\n    $$ \\Delta t_H \\le \\frac{H}{|w_e|} $$\n\nNow, we compute the maximum allowable time step for each constraint using the provided parameters. The maximum time step for each case is limited by the maximum expected velocity.\n\nFor the $z$-coordinate model:\n$\\Delta z = 5 \\text{ m}$ and $|w_{\\text{max}}| = 1.5 \\times 10^{-3} \\text{ m s}^{-1}$.\n$$ \\Delta t_{z, \\text{max}} = \\frac{\\Delta z}{|w_{\\text{max}}|} = \\frac{5}{1.5 \\times 10^{-3}} \\text{ s} = \\frac{10}{3} \\times 10^3 \\text{ s} \\approx 3333.33 \\text{ s} $$\n\nFor the isopycnal-coordinate model:\n$\\Delta \\sigma = 0.10 \\text{ kg m}^{-3}$ and $|r_{\\text{max}}| = 5.0 \\times 10^{-6} \\text{ kg m}^{-3} \\text{ s}^{-1}$.\n$$ \\Delta t_{\\sigma, \\text{max}} = \\frac{\\Delta \\sigma}{|r_{\\text{max}}|} = \\frac{0.10}{5.0 \\times 10^{-6}} \\text{ s} = 0.02 \\times 10^6 \\text{ s} = 20000 \\text{ s} $$\n\nFor the slab mixed-layer model:\n$H = 50 \\text{ m}$ and $|w_{e,\\text{max}}| = 1.0 \\times 10^{-4} \\text{ m s}^{-1}$.\n$$ \\Delta t_{H, \\text{max}} = \\frac{H}{|w_{e,\\text{max}}|} = \\frac{50}{1.0 \\times 10^{-4}} \\text{ s} = 50 \\times 10^4 \\text{ s} = 500000 \\text{ s} $$\n\nAn explicit time-stepping scheme must be stable for all processes simultaneously. Therefore, the overall maximum allowable time step, $\\Delta t_{\\text{max}}$, is the minimum of the individual maximums:\n$$ \\Delta t_{\\text{max}} = \\min(\\Delta t_{z, \\text{max}}, \\Delta t_{\\sigma, \\text{max}}, \\Delta t_{H, \\text{max}}) $$\n$$ \\Delta t_{\\text{max}} = \\min(3333.33..., 20000, 500000) \\text{ s} = 3333.33... \\text{ s} $$\nRounding to four significant figures, the final answer is $3333 \\text{ s}$.\n\nFinally, we discuss the implications of this result. The calculation reveals that for the given plausible parameters, vertical advection in the $z$-coordinate model is the most restrictive process, limiting the explicit time step to about $55.5$ minutes. The isopycnal coordinate allows a significantly larger time step for vertical (diapycnal) processes, and the slab model is by far the least restrictive. This highlights a key trade-off in ocean model design: $z$-coordinates are geometrically simple but can lead to severe time step limitations from vertical advection, especially with high vertical resolution.\n\nTo overcome this limitation, modelers employ several strategies. One is to treat the vertical advection and diffusion terms implicitly. An implicit scheme is numerically stable for any time step size (for this linear problem), removing the CFL constraint at the cost of solving a (tridiagonal) system of linear equations for each water column at every time step. Another strategy is time splitting or subcycling, where the \"fast\" processes (like vertical advection in a $z$-coordinate model) are integrated with a smaller time step, while the \"slower\" processes (like horizontal advection or thermodynamics) are advanced with a much larger time step. The result clearly shows why vertical processes in $z$-coordinate models are prime candidates for either implicit treatment or subcycling, enabling the overall model to run with a more computationally efficient larger time step dictated by other, slower phenomena.",
            "answer": "$$\n\\boxed{3333}\n$$"
        }
    ]
}