{
    "hands_on_practices": [
        {
            "introduction": "海洋模型必须处理多种尺度的物理过程，其中传播速度最快的外部（正压）重力波对显式时间步长构成了最严格的限制。本练习将通过推导这些波的稳定性判据，揭示为何 Bryan-Cox-Semtner (BCS) 模型架构采用“模态分裂” (mode-splitting) 技术，对正压模态进行隐式处理，这是该模型设计的核心思想之一。",
            "id": "4019553",
            "problem": "考虑 Bryan–Cox–Semtner (BCS) 海洋模式架构中的线性化一维正压子系统，其深度 $H$、重力加速度 $g$ 为常数，网格为 Arakawa C-网格，网格间距 $\\Delta x$ 均匀。预报变量为交错位于网格单元侧面的顺-通道流速 $u(x,t)$ 和交错位于网格单元中心的自由面位移 $\\eta(x,t)$。忽略行星旋转、底摩擦和任何强迫，并假设采用周期性边界条件。其连续控制方程为线性浅水方程\n$$\n\\frac{\\partial u}{\\partial t} = - g \\frac{\\partial \\eta}{\\partial x}, \\qquad \\frac{\\partial \\eta}{\\partial t} = - H \\frac{\\partial u}{\\partial x}.\n$$\n在许多 BCS 实现中，正压模态采用 C-网格上的前后差分时间格式和中心空间差分进行显式积分：\n$$\nu^{n+\\frac{1}{2}}_{j+\\frac{1}{2}} = u^{n-\\frac{1}{2}}_{j+\\frac{1}{2}} - g \\,\\Delta t \\,\\frac{\\eta^{n}_{j+1} - \\eta^{n}_{j}}{\\Delta x},\n$$\n$$\n\\eta^{n+1}_{j} = \\eta^{n}_{j} - H \\,\\Delta t \\,\\frac{u^{n+\\frac{1}{2}}_{j+\\frac{1}{2}} - u^{n+\\frac{1}{2}}_{j-\\frac{1}{2}}}{\\Delta x},\n$$\n其中 $j$ 是网格单元的索引， $n$ 是 $\\eta$ 的整数时间层的索引， $n \\pm \\tfrac{1}{2}$ 是 $u$ 的半整数时间层的索引。使用 von Neumann 简正模分析方法，并代入试探解 $u^{n+\\frac{1}{2}}_{j+\\frac{1}{2}} = \\hat{u}^{n+\\frac{1}{2}} \\exp\\!\\big(i k (j+\\tfrac{1}{2}) \\Delta x\\big)$ 和 $\\eta^{n}_{j} = \\hat{\\eta}^{n} \\exp\\!\\big(i k j \\Delta x\\big)$，确定显式正压时间步长 $\\Delta t_{\\max}$ 的闭式稳定性极限，该极限是 $H$、$\\Delta x$ 和 $g$ 的函数。以秒为单位表示最终的时间步长极限。不要对最终表达式进行近似。\n\n最后，根据你推导出的条件，简要解释 Bryan–Cox–Semtener (BCS) 海洋模式中对正压模态的隐式或椭圆型处理方法如何在不改变物理波速的情况下规避这种显式稳定性约束。\n\n你的最终答案必须是单个解析表达式。无需进行四舍五入。",
            "solution": "出发点是线性浅水系统，\n$$\n\\frac{\\partial u}{\\partial t} = - g \\frac{\\partial \\eta}{\\partial x}, \\qquad \\frac{\\partial \\eta}{\\partial t} = - H \\frac{\\partial u}{\\partial x},\n$$\n该系统支持相速度为 $c = \\sqrt{g H}$ 的非频散正压重力波。在 Arakawa C-网格上，我们使用前后差分时间步进格式和中心空间差分进行离散化：\n$$\nu^{n+\\frac{1}{2}}_{j+\\frac{1}{2}} = u^{n-\\frac{1}{2}}_{j+\\frac{1}{2}} - g \\,\\Delta t \\,\\frac{\\eta^{n}_{j+1} - \\eta^{n}_{j}}{\\Delta x},\n$$\n$$\n\\eta^{n+1}_{j} = \\eta^{n}_{j} - H \\,\\Delta t \\,\\frac{u^{n+\\frac{1}{2}}_{j+\\frac{1}{2}} - u^{n+\\frac{1}{2}}_{j-\\frac{1}{2}}}{\\Delta x}.\n$$\n我们通过代入简正模进行 von Neumann (傅里叶) 稳定性分析：\n$$\n\\eta^{n}_{j} = A^{n} \\exp\\!\\big(i k j \\Delta x\\big), \\qquad u^{n+\\frac{1}{2}}_{j+\\frac{1}{2}} = B^{n+\\frac{1}{2}} \\exp\\!\\big(i k (j+\\tfrac{1}{2}) \\Delta x\\big).\n$$\n定义 $\\kappa \\equiv \\frac{k \\Delta x}{2}$ 和 $s \\equiv \\sin(\\kappa)$。离散的交错梯度和散度算子作用于这些模态上，得到共同因子\n$$\n\\frac{\\eta^{n}_{j+1} - \\eta^{n}_{j}}{\\Delta x} = \\frac{2 i s}{\\Delta x}\\,A^{n} \\exp\\!\\big(i k (j+\\tfrac{1}{2}) \\Delta x\\big),\n$$\n$$\n\\frac{u^{n+\\frac{1}{2}}_{j+\\frac{1}{2}} - u^{n+\\frac{1}{2}}_{j-\\frac{1}{2}}}{\\Delta x} = \\frac{2 i s}{\\Delta x}\\,B^{n+\\frac{1}{2}} \\exp\\!\\big(i k j \\Delta x\\big).\n$$\n因此，模态振幅的递推关系变为\n$$\nB^{n+\\frac{1}{2}} = B^{n-\\frac{1}{2}} - g \\,\\Delta t \\,\\alpha \\,A^{n}, \\qquad \\alpha \\equiv \\frac{2 i s}{\\Delta x},\n$$\n$$\nA^{n+1} = A^{n} - H \\,\\Delta t \\,\\alpha \\,B^{n+\\frac{1}{2}}.\n$$\n为了消去 $B$，我们使用在连续时间 $n$ 和 $n+1$ 处的连续性方程更新。根据时间 $n$ 处的连续性方程，\n$$\nA^{n} = A^{n-1} - H \\,\\Delta t \\,\\alpha \\,B^{n-\\frac{1}{2}}.\n$$\n将两个连续性方程相减，得到\n$$\nA^{n+1} - A^{n} = \\left(A^{n} - A^{n-1}\\right) - H \\,\\Delta t \\,\\alpha \\left( B^{n+\\frac{1}{2}} - B^{n-\\frac{1}{2}} \\right).\n$$\n使用动量方程更新，\n$$\nB^{n+\\frac{1}{2}} - B^{n-\\frac{1}{2}} = - g \\,\\Delta t \\,\\alpha \\,A^{n},\n$$\n我们得到关于 $A^{n}$ 的二阶标量递推关系：\n$$\nA^{n+1} - 2 A^{n} + A^{n-1} = g H \\,(\\Delta t)^{2} \\,\\alpha^{2} \\,A^{n}.\n$$\n由于 $\\alpha = \\frac{2 i s}{\\Delta x}$，我们有 $\\alpha^{2} = - \\frac{4 s^{2}}{\\Delta x^{2}}$。引入外重力波速 $c \\equiv \\sqrt{g H}$ 和 Courant 数\n$$\nC \\equiv \\frac{c \\,\\Delta t}{\\Delta x},\n$$\n递推关系变为\n$$\nA^{n+1} - 2 A^{n} + A^{n-1} = - 4 C^{2} s^{2} \\,A^{n}.\n$$\n寻求形式为 $A^{n} = A^{0} \\,\\zeta^{n}$ 的解。代入后得到\n$$\n\\zeta + \\zeta^{-1} - 2 = - 4 C^{2} s^{2}.\n$$\n令 $\\zeta = \\exp(i \\theta)$，对应于中性振荡；那么\n$$\n\\zeta + \\zeta^{-1} = 2 \\cos\\theta \\quad \\Rightarrow \\quad 2 \\cos\\theta = 2 - 4 C^{2} s^{2},\n$$\n所以\n$$\n\\cos\\theta = 1 - 2 C^{2} s^{2}.\n$$\n为了满足 von Neumann 意义下的稳定性，我们要求对于所有可解的波数，$\\theta$ 都必须是实数，这就要求\n$$\n-1 \\le 1 - 2 C^{2} s^{2} \\le 1.\n$$\n上界是自动满足的；下界给出\n$$\n1 - 2 C^{2} s^{2} \\ge -1 \\quad \\Rightarrow \\quad 2 C^{2} s^{2} \\le 2 \\quad \\Rightarrow \\quad C^{2} s^{2} \\le 1.\n$$\n因为对于所有的 $\\kappa$ 都有 $s^{2} = \\sin^{2}(\\kappa) \\le 1$，所以最严格的条件发生在最短的可解尺度上，此时 $\\sin^{2}(\\kappa) \\to 1$。因此，\n$$\nC \\le 1 \\quad \\Rightarrow \\quad \\Delta t \\le \\frac{\\Delta x}{c} = \\frac{\\Delta x}{\\sqrt{g H}}.\n$$\n因此，在此 C-网格前后差分格式下，正压时间步长的显式稳定性极限是\n$$\n\\Delta t_{\\max} = \\frac{\\Delta x}{\\sqrt{g H}}.\n$$\n该表达式就是所要求的用 $H$、$\\Delta x$ 和 $g$ 表示的闭式形式。由于要求的单位是秒，当 $\\Delta x$ 的单位是米，$g$ 的单位是米/秒²，$H$ 的单位是米时，该表达式的结果单位就是秒。\n\n与 Bryan–Cox–Semtner (BCS) 海洋模式中隐式或椭圆型处理方法的关系：BCS 架构通常在每个斜压步长通过求解关于自由面或正压流函数的椭圆型（亥姆霍兹型）方程来隐式地推进正压模态，这消除了上面推导出的显式 Courant–Friedrichs–Lewy 约束 $\\Delta t \\le \\Delta x/\\sqrt{g H}$；物理重力波速 $c = \\sqrt{g H}$ 得以保留，但数值稳定性与 $c$ 解耦，因为隐式求解强制了波的动力学过程，而无需显式时间步长来解析最快的外部模态。",
            "answer": "$$\\boxed{\\frac{\\Delta x}{\\sqrt{g H}}}$$"
        },
        {
            "introduction": "对正压模态进行隐式处理，虽然绕过了严格的时间步长限制，但代价是在每个时间步都必须求解一个大型的线性方程组（通常是关于表面压力的椭圆型方程）。本练习将探讨求解该方程组的迭代方法（如雅可比法）的收敛效率，这对于理解模型计算成本和性能至关重要。",
            "id": "4019541",
            "problem": "在 Bryan–Cox–Semtner (BCS) 海洋模型架构中，垂直积分的正压模产生一个诊断性表面压力方程，其水平算子可以很好地近似为标量（压力）点上的离散$5$点拉普拉斯算子。考虑一个双周期水平域，在两个方向上具有相等的网格间距 $h$，以及一个大小为 $N_x \\times N_y$ 的均匀标量网格。设 $A$ 表示作用于标量场 $p_{i,j}$ 的离散拉普拉斯算子，定义为\n$$\nA p_{i,j} \\equiv \\frac{1}{h^{2}}\\left(4 p_{i,j} - p_{i+1,j} - p_{i-1,j} - p_{i,j+1} - p_{i,j-1}\\right),\n$$\n其中 $i$ 和 $j$ 的索引是周期性的。考虑将标准雅可比方法应用于线性系统 $A p = f$，其对角分裂为 $A = D - (L + U)$，雅可比迭代为 $p^{(m+1)} = D^{-1}(L+U)p^{(m)} + D^{-1} f$。假设表面压力被约束为空间平均值为零，以消除与常数模态相关的零空间。\n\n从离散算子定义和周期性出发，使用傅里叶模态分析来确定雅可比迭代矩阵的谱半径，并因此确定其渐近每次迭代收敛率。对于大小为 $N_x = 90$ 和 $N_y = 60$ 的网格，计算所有允许的非零波数下雅可比迭代特征值幅值的最大值，即谱半径。将最终答案四舍五入到 $4$ 位有效数字。将最终答案表示为无量纲数。",
            "solution": "线性系统为 $A p = f$。对于雅可比方法，矩阵 $A$ 被分裂为其对角部分 $D$ 和其非对角部分 $-(L+U)$。迭代由 $p^{(m+1)} = J p^{(m)} + c$ 给出，其中雅可比迭代矩阵为 $J = D^{-1}(L+U)$，$c = D^{-1}f$。\n\n根据离散拉普拉斯算子 $A$ 的定义，\n$$\n(A p)_{i,j} = \\frac{4}{h^2} p_{i,j} - \\frac{1}{h^2} (p_{i+1,j} + p_{i-1,j} + p_{i,j+1} + p_{i,j-1})\n$$\n对角部分为 $(D p)_{i,j} = \\frac{4}{h^2} p_{i,j}$，因此 $D = \\frac{4}{h^2} I$，其逆为 $D^{-1} = \\frac{h^2}{4} I$。\n非对角部分 $(L+U)$ 为\n$$\n((L+U)p)_{i,j} = \\frac{1}{h^2} (p_{i+1,j} + p_{i-1,j} + p_{i,j+1} + p_{i,j-1})\n$$\n因此，雅可比迭代矩阵 $J = D^{-1}(L+U)$ 的作用如下：\n$$\n(J p)_{i,j} = \\frac{1}{4} (p_{i+1,j} + p_{i-1,j} + p_{i,j+1} + p_{i,j-1})\n$$\n我们使用傅里叶分析来找到 $J$ 的特征值。在双周期网格上，$J$ 的特征函数是离散傅里叶模态：\n$$\np^{(n_x, n_y)}_{i,j} = \\exp\\left(2\\pi\\mathrm{i} \\left(\\frac{n_x i}{N_x} + \\frac{n_y j}{N_y}\\right)\\right)\n$$\n其中 $(n_x, n_y)$ 是整数波数。将 $J$ 应用于此模态，我们得到对应的特征值 $\\lambda_J(n_x, n_y)$：\n$$\n\\lambda_J(n_x, n_y) = \\frac{1}{4} \\left( e^{\\frac{2\\pi\\mathrm{i} n_x}{N_x}} + e^{-\\frac{2\\pi\\mathrm{i} n_x}{N_x}} + e^{\\frac{2\\pi\\mathrm{i} n_y}{N_y}} + e^{-\\frac{2\\pi\\mathrm{i} n_y}{N_y}} \\right)\n$$\n使用欧拉公式，上式简化为：\n$$\n\\lambda_J(n_x, n_y) = \\frac{1}{2} \\left( \\cos\\left(\\frac{2\\pi n_x}{N_x}\\right) + \\cos\\left(\\frac{2\\pi n_y}{N_y}\\right) \\right)\n$$\n雅可比迭代的谱半径 $\\rho(J)$ 是所有允许模态的特征值绝对值的最大值。问题指出，通过强制零空间平均值，排除了常数模态 $(n_x, n_y) = (0,0)$，该模态的特征值为 $\\lambda_J(0,0) = 1$。为了收敛，我们还必须排除导致 $|\\lambda_J|=1$ 的其他模态。在给定的偶数网格上，棋盘格模态 $(n_x, n_y) = (N_x/2, N_y/2)$ 的特征值为 $\\lambda_J(N_x/2, N_y/2) = -1$。\n\n因此，谱半径由最接近 1 或 -1 的特征值决定，这些特征值来自最慢收敛的非退化模态。这些通常是波长最长的模态，例如 $(1,0)$ 和 $(0,1)$。\n$$\n|\\lambda_J(1,0)| = \\left| \\frac{1}{2}\\left( \\cos\\left(\\frac{2\\pi}{N_x}\\right) + 1 \\right) \\right| = \\cos^2\\left(\\frac{\\pi}{N_x}\\right)\n$$\n$$\n|\\lambda_J(0,1)| = \\left| \\frac{1}{2}\\left( 1 + \\cos\\left(\\frac{2\\pi}{N_y}\\right) \\right) \\right| = \\cos^2\\left(\\frac{\\pi}{N_y}\\right)\n$$\n谱半径是这些值中的最大值：\n$$\n\\rho(J) = \\max\\left\\{ \\cos^2\\left(\\frac{\\pi}{N_x}\\right), \\cos^2\\left(\\frac{\\pi}{N_y}\\right) \\right\\}\n$$\n因为 $N_x=90 > N_y=60$，且 $\\cos^2(\\theta)$ 在 $[0, \\pi/2]$ 上是递减函数，所以 $\\pi/N_x  \\pi/N_y$，这意味着 $\\cos^2(\\pi/N_x) > \\cos^2(\\pi/N_y)$。因此：\n$$\n\\rho(J) = \\cos^2\\left(\\frac{\\pi}{N_x}\\right) = \\cos^2\\left(\\frac{\\pi}{90}\\right)\n$$\n进行数值计算：\n$$\n\\rho(J) = \\cos^2\\left(\\frac{\\pi}{90}\\right) \\approx (0.9993908)^2 \\approx 0.998782\n$$\n四舍五入到4位有效数字，我们得到 $0.9988$。",
            "answer": "$$\\boxed{0.9988}$$"
        },
        {
            "introduction": "在处理完快速的正压模态后，模型的另一个关键任务是精确模拟热量、盐度等示踪剂的输运过程。本练习将分析和比较不同的平流格式，通过推导其修正方程，揭示一阶迎风格式中固有的“数值扩散”问题，这对于需要长期积分的气候模拟来说是一个必须仔细考量的核心问题。",
            "id": "4019544",
            "problem": "在布莱恩-考克斯-塞姆特纳（Bryan–Cox–Semtner, BCS）海洋模型架构中，示踪剂平流在Arakawa C-网格上以通量形式表示，示踪剂浓度 $C$ 定义在网格中心，法向速度 $u$ 定义在网格面上。考虑一个具有恒定正速度 $u0$ 和均匀网格间距 $\\Delta x$ 的一维周期性区域，并设半离散示踪剂趋势项写作\n$$\n\\frac{d C_i}{d t} \\;=\\; -\\frac{F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}}{\\Delta x},\n$$\n其中 $F_{i+\\frac{1}{2}}$ 是网格 $i$ 右侧面上的平流通量。两种常见的离散通量选择是：\n- 一阶迎风通量：$F_{i+\\frac{1}{2}} = u\\,C_i$（对于 $u0$）。\n- 中心通量：$F_{i+\\frac{1}{2}} = u\\,\\frac{C_{i+1} + C_i}{2}$。\n\n从一维连续示踪剂平流方程 $$\\frac{\\partial C}{\\partial t} + u\\,\\frac{\\partial C}{\\partial x} = 0,$$ 和上述半离散通量形式出发，完成以下任务：\n\n1. 使用关于 $x_i$ 的泰勒展开，推导出一阶迎风通量对应的主阶修正方程。确定乘以 $\\frac{\\partial^2 C}{\\partial x^2}$ 的系数，并将其解释为 BCS C-网格上一阶迎风平流所隐含的数值扩散系数 $\\kappa_{\\mathrm{num}}$。\n2. 推导修正方程的空间方差收支，其定义为在一个周期性区域上 $\\int C^2/2\\,dx$ 的演化。量化 $\\kappa_{\\mathrm{num}}$ 对示踪剂方差的耗散影响，并展示单个傅里叶模态 $C(x,0) = A_0 \\cos(kx)$ 的方差衰减。\n3. 对于一个粗分辨率气候配置，其参数为 $u = 0.15\\,\\mathrm{m\\,s^{-1}}$，$\\Delta x = 80\\,\\mathrm{km}$，示踪剂模态波长 $L_{\\mathrm{mode}} = 320\\,\\mathrm{km}$，积分时间 $T = 10\\,\\mathrm{days}$，计算在时间 $T$ 后，一阶迎风平流相对于中心平流所剩余的示踪剂方差的分数。将最终答案表示为小数，并四舍五入到四位有效数字。\n\n注意：使用物理上一致的关系 $k = \\frac{2\\pi}{L_{\\mathrm{mode}}}$ 以及天到秒的换算定义。假设周期性边界条件，并忽略任何物理扩散或源/汇项。",
            "solution": "### 第一部分：一阶迎风方案的修正方程与数值扩散\n\n连续一维示踪剂平流方程为：\n$$\n\\frac{\\partial C}{\\partial t} + u\\,\\frac{\\partial C}{\\partial x} = 0\n$$\n在间距为 $\\Delta x$ 的网格上的半离散形式为：\n$$\n\\frac{d C_i}{d t} = -\\frac{F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}}{\\Delta x}\n$$\n其中 $C_i(t)$ 表示在时间 $t$ 网格 $i$ 中的示踪剂浓度。对于具有恒定正速度 $u0$ 的一阶迎风方案，通量定义为 $F_{i+\\frac{1}{2}} = u\\,C_i$ 和 $F_{i-\\frac{1}{2}} = u\\,C_{i-1}$。将这些代入半离散方程得到：\n$$\n\\frac{d C_i}{d t} = -\\frac{u\\,C_i - u\\,C_{i-1}}{\\Delta x} = -u\\,\\frac{C_i - C_{i-1}}{\\Delta x}\n$$\n为了推导修正方程，我们将离散项解释为在网格 $i$ 的位置 $x_i$ 处连续导数的近似。左侧的 $\\frac{d C_i}{dt}$ 变为在 $x_i$ 处求值的偏时间导数 $\\frac{\\partial C}{\\partial t}$。对于右侧，我们对 $C_{i-1} = C(x_i - \\Delta x)$ 在 $x_i$ 周围进行泰勒级数展开：\n$$\nC_{i-1} = C(x_i - \\Delta x) = C(x_i) - \\Delta x \\left.\\frac{\\partial C}{\\partial x}\\right|_{x_i} + \\frac{(\\Delta x)^2}{2} \\left.\\frac{\\partial^2 C}{\\partial x^2}\\right|_{x_i} - \\frac{(\\Delta x)^3}{6} \\left.\\frac{\\partial^3 C}{\\partial x^3}\\right|_{x_i} + \\mathcal{O}((\\Delta x)^4)\n$$\n将此展开式代入半离散方程的右侧：\n$$\n-u\\,\\frac{C_i - C_{i-1}}{\\Delta x} = -u\\,\\frac{1}{\\Delta x} \\left( C_i - \\left[ C_i - \\Delta x \\frac{\\partial C}{\\partial x} + \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 C}{\\partial x^2} - \\dots \\right] \\right)\n$$\n$$\n= -u\\,\\frac{1}{\\Delta x} \\left( \\Delta x \\frac{\\partial C}{\\partial x} - \\frac{(\\Delta x)^2}{2} \\frac{\\partial^2 C}{\\partial x^2} + \\dots \\right)\n$$\n$$\n= -u\\,\\frac{\\partial C}{\\partial x} + \\frac{u\\,\\Delta x}{2} \\frac{\\partial^2 C}{\\partial x^2} - \\mathcal{O}((\\Delta x)^2)\n$$\n将时间导数与此表达式相等，我们得到离散格式实际求解的修正偏微分方程：\n$$\n\\frac{\\partial C}{\\partial t} = -u\\,\\frac{\\partial C}{\\partial x} + \\frac{u\\,\\Delta x}{2} \\frac{\\partial^2 C}{\\partial x^2}\n$$\n重新整理以匹配典型平流-扩散方程的形式：\n$$\n\\frac{\\partial C}{\\partial t} + u\\,\\frac{\\partial C}{\\partial x} = \\frac{u\\,\\Delta x}{2} \\frac{\\partial^2 C}{\\partial x^2}\n$$\n右侧的项是该格式的主阶截断误差。它具有扩散项 $\\kappa \\frac{\\partial^2 C}{\\partial x^2}$ 的形式。通过比较，数值扩散系数 $\\kappa_{\\mathrm{num}}$ 就是该项的系数。\n$$\n\\kappa_{\\mathrm{num}} = \\frac{u\\,\\Delta x}{2}\n$$\n这种人为扩散是一阶迎风方案所固有的，并导致其耗散特性。\n\n### 第二部分：空间方差收支与傅里叶模态衰减\n\n在一个长度为 $L$ 的周期性区域上，示踪剂场的空间方差定义为 $V(t) = \\frac{1}{2} \\int_0^L C^2(x,t) \\,dx$。总方差的变化率为：\n$$\n\\frac{dV}{dt} = \\frac{d}{dt} \\left( \\frac{1}{2} \\int_0^L C^2 \\,dx \\right) = \\int_0^L C \\frac{\\partial C}{\\partial t} \\,dx\n$$\n我们代入第一部分中推导出的 $\\frac{\\partial C}{\\partial t}$ 的修正方程：\n$$\n\\frac{dV}{dt} = \\int_0^L C \\left( -u\\,\\frac{\\partial C}{\\partial x} + \\kappa_{\\mathrm{num}} \\frac{\\partial^2 C}{\\partial x^2} \\right) \\,dx\n$$\n我们分别分析每一项的积分。平流项为：\n$$\n\\int_0^L -u\\,C\\,\\frac{\\partial C}{\\partial x} \\,dx = -u \\int_0^L \\frac{1}{2} \\frac{\\partial (C^2)}{\\partial x} \\,dx = -\\frac{u}{2} \\left[ C^2 \\right]_0^L = 0\n$$\n由于周期性边界条件 $C(0,t) = C(L,t)$，该项为零。平流项是方差守恒的。\n扩散项使用分部积分法进行分析，$\\int_a^b u \\, dv = [uv]_a^b - \\int_a^b v \\, du$。设 $u=C$ 且 $dv = \\frac{\\partial^2 C}{\\partial x^2} dx$。\n$$\n\\int_0^L \\kappa_{\\mathrm{num}} \\, C \\frac{\\partial^2 C}{\\partial x^2} \\,dx = \\kappa_{\\mathrm{num}} \\left[ C \\frac{\\partial C}{\\partial x} \\right]_0^L - \\kappa_{\\mathrm{num}} \\int_0^L \\left( \\frac{\\partial C}{\\partial x} \\right)^2 \\,dx\n$$\n边界项 $\\left[ C \\frac{\\partial C}{\\partial x} \\right]_0^L$ 也因周期性边界条件而为零。剩余的项量化了耗散：\n$$\n\\frac{dV}{dt} = -\\kappa_{\\mathrm{num}} \\int_0^L \\left( \\frac{\\partial C}{\\partial x} \\right)^2 \\,dx\n$$\n由于 $\\kappa_{\\mathrm{num}}  0$ 且 $\\left( \\frac{\\partial C}{\\partial x} \\right)^2 \\geq 0$，因此 $\\frac{dV}{dt} \\leq 0$。由迎风方案引入的数值扩散会单调耗散示踪剂方差。\n\n现在考虑单个傅里叶模态 $C(x,t)$。我们可以用复数表示法将其表示为 $C(x,t) = \\text{Re}\\{A(t) e^{ikx}\\}$，其中 $k$ 是波数。将其代入修正方程：\n$$\n\\frac{\\partial}{\\partial t} (A(t) e^{ikx}) + u \\frac{\\partial}{\\partial x} (A(t) e^{ikx}) = \\kappa_{\\mathrm{num}} \\frac{\\partial^2}{\\partial x^2} (A(t) e^{ikx})\n$$\n$$\n\\frac{dA}{dt} e^{ikx} + u A(t) (ik) e^{ikx} = \\kappa_{\\mathrm{num}} A(t) (ik)^2 e^{ikx}\n$$\n两边同除以 $e^{ikx}$，得到关于振幅 $A(t)$ 的常微分方程：\n$$\n\\frac{dA}{dt} + ikuA = -k^2 \\kappa_{\\mathrm{num}} A \\quad \\implies \\quad \\frac{dA}{dt} = -(k^2 \\kappa_{\\mathrm{num}} + iku) A\n$$\n解为 $A(t) = A(0) e^{-(k^2 \\kappa_{\\mathrm{num}} + iku)t} = A(0) e^{-k^2 \\kappa_{\\mathrm{num}} t} e^{-ikut}$。物理上的解为 $C(x,t) = \\text{Re}\\{A(t)e^{ikx}\\}$。如果我们从 $C(x,0) = A_0 \\cos(kx)$ 开始，其中 $A_0$ 是实数，则 $A(0) = A_0$ 且解为：\n$$\nC(x,t) = A_0 e^{-k^2 \\kappa_{\\mathrm{num}} t} \\cos(k(x - ut))\n$$\n模态的振幅以 $|A_0| e^{-k^2 \\kappa_{\\mathrm{num}} t}$ 的形式指数衰减。由于方差 $V$ 与振幅的平方成正比，其衰减由下式给出：\n$$\nV(t) = V(0) e^{-2 k^2 \\kappa_{\\mathrm{num}} t}\n$$\n\n### 第三部分：方差分数的数值计算\n\n我们需要计算在时间 $T$ 后，迎风方案相对于中心方案的剩余方差分数。首先，我们分析中心方案，其中 $F_{i+\\frac{1}{2}} = u\\,\\frac{C_{i+1} + C_i}{2}$。离散方程变为：\n$$\n\\frac{dC_i}{dt} = -u \\frac{C_{i+1} - C_{i-1}}{2\\Delta x}\n$$\n对 $C_{i+1}$ 和 $C_{i-1}$ 使用泰勒展开表明，这是对 $-u \\frac{\\partial C}{\\partial x}$ 的一个二阶精确近似。主误差项是色散性的，而不是耗散性的：\n$$\n\\frac{\\partial C}{\\partial t} + u \\frac{\\partial C}{\\partial x} = -\\frac{u (\\Delta x)^2}{6} \\frac{\\partial^3 C}{\\partial x^3} + \\mathcal{O}((\\Delta x)^4)\n$$\n由于没有 $\\frac{\\partial^2 C}{\\partial x^2}$ 项，中心方案在此近似阶数下是非耗散的。因此，对于解析解，它保持方差守恒：$V_{\\mathrm{centered}}(T) = V_{\\mathrm{centered}}(0)$。\n所求的分数为 $f = \\frac{V_{\\mathrm{upwind}}(T)}{V_{\\mathrm{centered}}(T)}$。假设两者都从相同的初始方差 $V(0)$ 开始，这可简化为：\n$$\nf = \\frac{V_{\\mathrm{upwind}}(T)}{V(0)} = e^{-2 k^2 \\kappa_{\\mathrm{num}} T}\n$$\n我们已知以下参数：\n- 速度 $u = 0.15\\,\\mathrm{m\\,s^{-1}}$\n- 网格间距 $\\Delta x = 80\\,\\mathrm{km} = 8 \\times 10^4\\,\\mathrm{m}$\n- 波长 $L_{\\mathrm{mode}} = 320\\,\\mathrm{km} = 3.2 \\times 10^5\\,\\mathrm{m}$\n- 时间 $T = 10\\,\\mathrm{days} = 10 \\times 24 \\times 3600\\,\\mathrm{s} = 8.64 \\times 10^5\\,\\mathrm{s}$\n\n我们计算指数中的各项：\n1.  数值扩散系数 $\\kappa_{\\mathrm{num}}$：\n    $$\n    \\kappa_{\\mathrm{num}} = \\frac{u\\,\\Delta x}{2} = \\frac{(0.15\\,\\mathrm{m\\,s^{-1}})(8 \\times 10^4\\,\\mathrm{m})}{2} = 6 \\times 10^3\\,\\mathrm{m^2\\,s^{-1}}\n    $$\n2.  波数 $k$：\n    $$\n    k = \\frac{2\\pi}{L_{\\mathrm{mode}}} = \\frac{2\\pi}{3.2 \\times 10^5\\,\\mathrm{m}}\n    $$\n现在，我们计算无量纲指数 $-2 k^2 \\kappa_{\\mathrm{num}} T$：\n$$\n\\text{指数} = -2 \\left( \\frac{2\\pi}{3.2 \\times 10^5} \\right)^2 (6 \\times 10^3) (8.64 \\times 10^5)\n$$\n$$\n= -2 \\left( \\frac{4\\pi^2}{10.24 \\times 10^{10}} \\right) (6 \\times 10^3) (8.64 \\times 10^5)\n$$\n$$\n= -\\frac{8 \\pi^2 \\times (5.184 \\times 10^9)}{10.24 \\times 10^{10}} = -\\frac{41.472 \\pi^2}{102.4}\n$$\n$$\n= -0.405 \\pi^2\n$$\n剩余方差的分数为：\n$$\nf = e^{-0.405 \\pi^2}\n$$\n使用 $\\pi^2 \\approx 9.8696044$：\n$$\nf \\approx e^{-0.405 \\times 9.8696044} = e^{-3.99718978} \\approx 0.0183674\n$$\n四舍五入到四位有效数字，结果为 $0.01837$。",
            "answer": "$$\\boxed{0.01837}$$"
        }
    ]
}