{
    "hands_on_practices": [
        {
            "introduction": "数值模型的网格单元内部往往包含着森林、草地等多种地表覆盖类型，每种类型都具有独特的粗糙度。本练习将指导你如何将这些离散的粗糙度值聚合成一个单一的“有效”空气动力学粗糙度长度 $\\bar{z}_0$，从而在宏观尺度上代表整个网格单元的综合效应 。这项实践根植于“混合高度”这一关键概念，并应用面积加权平均法，是所有大尺度模型中处理地表非均匀性的基础技能。",
            "id": "4010042",
            "problem": "考虑一个在数值天气预报和气候模拟中使用的单个网格单元内的水平非均匀地表。该网格单元由三块地块组成：森林，面积分数为 $a_{\\mathrm{f}}=0.5$，空气动力学粗糙度长度为 $z_{0,\\mathrm{f}}=1.0\\ \\mathrm{m}$；草地，面积分数为 $a_{\\mathrm{g}}=0.3$，空气动力学粗糙度长度为 $z_{0,\\mathrm{g}}=0.05\\ \\mathrm{m}$；以及裸土，面积分数为 $a_{\\mathrm{s}}=0.2$，空气动力学粗糙度长度为 $z_{0,\\mathrm{s}}=0.01\\ \\mathrm{m}$。假设大气边界层为中性稳定度，并且对于高于混合高度 $z_b$ 的高度 $z$，气流是水平均匀的，因此可以用一个单一的摩擦速度 $u_*$ 来表征该层，且平均风廓线遵循与莫宁-奥布霍夫相似性理论（MOST）一致的对数律。\n\n从中性对数风廓线、空气动力学粗糙度长度的定义以及混合高度的概念出发，从第一性原理推导出区域聚合的有效空气动力学粗糙度长度 $\\bar{z}_0$。当对各地块廓线进行面积平均时，该有效粗糙度长度能在 $z>z_b$ 时产生单一的对数平均风廓线。然后，计算给定网格单元组成的 $\\bar{z}_0$ 的数值。\n\n将最终数值答案四舍五入至四位有效数字。以米为单位表示最终的粗糙度长度，但不要在方框答案中包含单位。",
            "solution": "该问题陈述经评估是有效的。它在科学上基于边界层气象学的原理，特别是针对中性条件的莫宁-奥布霍夫相似性理论（MOST）。该问题是适定的，为三种指定的土地覆盖类型提供了所有必要的数据（面积分数和粗糙度长度）。关于中性稳定度以及存在一个混合高度（在此高度之上单一对数廓线成立）的假设，在模拟背景下是标准的和适当的，用以推导有效参数。该问题是客观的，不包含任何事实上的不一致或矛盾之处。面积分数的总和为 $a_{\\mathrm{f}} + a_{\\mathrm{g}} + a_{\\mathrm{s}} = 0.5 + 0.3 + 0.2 = 1.0$，这是自洽的。\n\n我们按照要求，从第一性原理开始推导有效空气动力学粗糙度长度 $\\bar{z}_0$。\n\n基本出发点是中性大气边界层的对数风廓线，它描述了在具有空气动力学粗糙度长度 $z_0$ 和摩擦速度 $u_*$ 的均匀表面上，高度 $z$ 处的平均风速 $u(z)$：\n$$\nu(z) = \\frac{u_*}{\\kappa} \\ln\\left(\\frac{z}{z_0}\\right)\n$$\n其中 $\\kappa$ 是冯·卡门常数。\n\n问题描述了一个由 $N$ 个不同地块组成的非均匀表面，每个地块都有其自己的面积分数 $a_i$ 和空气动力学粗糙度长度 $z_{0,i}$。对于大于混合高度 $z_b$ 的高度 $z$，气流被认为是水平均匀的。整个网格单元的有效风廓线 $\\bar{u}(z)$ 由一个有效粗糙度长度 $\\bar{z}_0$ 和一个有效摩擦速度 $\\bar{u}_*$ 定义：\n$$\n\\bar{u}(z) = \\frac{\\bar{u}_*}{\\kappa} \\ln\\left(\\frac{z}{\\bar{z}_0}\\right)\n$$\n高度 $z$ 处的面积平均风速是每个地块上风速的加权平均值：\n$$\n\\bar{u}(z) = \\sum_{i=1}^{N} a_i u_i(z)\n$$\n问题指出，“一个单一的摩擦速度 $u_*$ 表征了该层”（对于 $z>z_b$）。我们采纳的解释是，这意味着一个单一的摩擦速度可以用来描述每个地块上的风廓线以及有效廓线。这是推导此类参数化时常见的简化方法。因此，我们假设每个地块 $i$ 的 $u_i(z)$ 可以用这个单一的 $u_*$ 来表示，并且 $\\bar{u}_* = u_*$。在此假设下，地块 $i$ 上的风廓线为：\n$$\nu_i(z) = \\frac{u_*}{\\kappa} \\ln\\left(\\frac{z}{z_{0,i}}\\right)\n$$\n将此代入面积平均方程，得到：\n$$\n\\bar{u}(z) = \\sum_{i=1}^{N} a_i \\left[ \\frac{u_*}{\\kappa} \\ln\\left(\\frac{z}{z_{0,i}}\\right) \\right]\n$$\n我们可以将常数项 $\\frac{u_*}{\\kappa}$ 提取出来：\n$$\n\\bar{u}(z) = \\frac{u_*}{\\kappa} \\sum_{i=1}^{N} a_i \\ln\\left(\\frac{z}{z_{0,i}}\\right)\n$$\n使用对数性质 $\\ln(A/B) = \\ln(A) - \\ln(B)$，我们展开求和项内的表达式：\n$$\n\\bar{u}(z) = \\frac{u_*}{\\kappa} \\sum_{i=1}^{N} a_i (\\ln(z) - \\ln(z_{0,i}))\n$$\n分配求和符号：\n$$\n\\bar{u}(z) = \\frac{u_*}{\\kappa} \\left( \\sum_{i=1}^{N} a_i \\ln(z) - \\sum_{i=1}^{N} a_i \\ln(z_{0,i}) \\right)\n$$\n由于 $\\ln(z)$ 相对于求和指数 $i$ 是常数，我们可以将其提取出来：\n$$\n\\bar{u}(z) = \\frac{u_*}{\\kappa} \\left( \\ln(z) \\sum_{i=1}^{N} a_i - \\sum_{i=1}^{N} a_i \\ln(z_{0,i}) \\right)\n$$\n根据定义，所有面积分数的总和为1：$\\sum_{i=1}^{N} a_i = 1$。表达式简化为：\n$$\n\\bar{u}(z) = \\frac{u_*}{\\kappa} \\left( \\ln(z) - \\sum_{i=1}^{N} a_i \\ln(z_{0,i}) \\right)\n$$\n现在，我们将这个推导出的面积平均风廓线形式与有效风廓线的定义 $\\bar{u}(z) = \\frac{u_*}{\\kappa} \\ln(\\frac{z}{\\bar{z}_0})$ 等同起来，后者也可以写成 $\\bar{u}(z) = \\frac{u_*}{\\kappa} (\\ln(z) - \\ln(\\bar{z}_0))$：\n$$\n\\frac{u_*}{\\kappa} \\left( \\ln(z) - \\ln(\\bar{z}_0) \\right) = \\frac{u_*}{\\kappa} \\left( \\ln(z) - \\sum_{i=1}^{N} a_i \\ln(z_{0,i}) \\right)\n$$\n通过比较括号内的各项，我们找到了有效粗糙度长度的关系：\n$$\n\\ln(\\bar{z}_0) = \\sum_{i=1}^{N} a_i \\ln(z_{0,i})\n$$\n这是在所述假设下从第一性原理推导出的通用公式。\n\n现在，我们计算给定网格单元的数值，该网格单元有三个地块：森林（f）、草地（g）和土壤（s）。公式变为：\n$$\n\\ln(\\bar{z}_0) = a_{\\mathrm{f}} \\ln(z_{0,\\mathrm{f}}) + a_{\\mathrm{g}} \\ln(z_{0,\\mathrm{g}}) + a_{\\mathrm{s}} \\ln(z_{0,\\mathrm{s}})\n$$\n我们代入给定的值：\n$a_{\\mathrm{f}}=0.5$, $z_{0,\\mathrm{f}}=1.0\\ \\mathrm{m}$\n$a_{\\mathrm{g}}=0.3$, $z_{0,\\mathrm{g}}=0.05\\ \\mathrm{m}$\n$a_{\\mathrm{s}}=0.2$, $z_{0,\\mathrm{s}}=0.01\\ \\mathrm{m}$\n\n$$\n\\ln(\\bar{z}_0) = 0.5 \\ln(1.0) + 0.3 \\ln(0.05) + 0.2 \\ln(0.01)\n$$\n我们计算各项的值：\n$\\ln(1.0) = 0$\n$\\ln(0.05) \\approx -2.99573227355$\n$\\ln(0.01) \\approx -4.60517018599$\n\n将这些值代入方程中：\n$$\n\\ln(\\bar{z}_0) \\approx (0.5)(0) + (0.3)(-2.99573227) + (0.2)(-4.60517019)\n$$\n$$\n\\ln(\\bar{z}_0) \\approx 0 - 0.89871968 - 0.92103404\n$$\n$$\n\\ln(\\bar{z}_0) \\approx -1.81975372\n$$\n为了求得 $\\bar{z}_0$，我们对等式两边取指数：\n$$\n\\bar{z}_0 = \\exp(-1.81975372)\n$$\n$$\n\\bar{z}_0 \\approx 0.16207036\\ \\mathrm{m}\n$$\n将最终数值答案四舍五入到四位有效数字，我们得到 $0.1621$。",
            "answer": "$$\\boxed{0.1621}$$"
        },
        {
            "introduction": "空气动力学粗糙度不仅影响动量交换，同样也控制着热量和水汽的输送，但控制后两者的标量粗糙度长度（$z_{0t}$ 和 $z_{0q}$）通常与动量粗糙度长度（$z_0$）并不相等。本练习通过一个实际的案例分析，让你量化在一个数值模型中混淆这几类粗糙度长度会产生的误差有多大 。通过计算和比较不同假设下的感热与潜热通量，你将深刻体会到正确区分动量和标量输送对模拟地表能量平衡的决定性影响。",
            "id": "4010062",
            "problem": "考虑在开阔大洋上一次大风期间一个中性、充分混合的海洋大气近地层。在测量高度 $z=10$ m 处，10米风速为 $U(z)=25$ m s$^{-1}$，海表（表层）位温为 $\\Theta_{s}=288$ K，在 $z$ 高度处的空气位温为 $\\Theta(z)=286$ K。海表比湿为 $q_{s}=0.011$ kg kg$^{-1}$，在 $z$ 高度处的空气比湿为 $q(z)=0.007$ kg kg$^{-1}$。空气密度为 $\\rho=1.22$ kg m$^{-3}$，空气定压比热为 $c_{p}=1004$ J kg$^{-1}$ K$^{-1}$，蒸发潜热为 $L_{v}=2.5\\times 10^{6}$ J kg$^{-1}$。von Kármán 常数为 $k=0.4$。假设为中性层结（无稳定性修正）和一个常应力层。\n\n从 Monin-Obukhov 相似性理论 (MOS) 下的对数平均廓线和通量-梯度关系所隐含的基本中性近地层框架出发，即平均风速 $U(z)$、位温差 $\\Theta(z)-\\Theta_{s}$ 和比湿差 $q(z)-q_{s}$ 通过它们各自的粗糙度长度 $z_{0}$、$z_{0t}$ 和 $z_{0q}$ 的对数依赖关系，与摩擦速度 $u_{*}$ 以及标量尺度 $\\Theta_{*}$、$q_{*}$ 相关联。同时，使用近地层中湍流通量的标准定义，其中动量通量为 $\\tau=\\rho\\,u_{*}^{2}$，感热通量为 $H=-\\rho\\,c_{p}\\,u_{*}\\,\\Theta_{*}$，潜热通量为 $E=-\\rho\\,L_{v}\\,u_{*}\\,q_{*}$。其符号约定为：当表面比空气更暖、更湿时，向上的通量为正。\n\n对于这次大风事件，取正确的海洋粗糙度长度为 $z_{0}=3.0\\times 10^{-3}$ m、$z_{0t}=1.0\\times 10^{-4}$ m 和 $z_{0q}=1.5\\times 10^{-4}$ m。然而，假设一个数值天气预报模式错误地设定了 $z_{0t}=z_{0q}=z_{0}$。\n\n根据 MOS 中性关系和通量-梯度框架，推导出动量、热量和水汽的中性总体输送系数，将其表示为 $z$、$z_{0}$、$z_{0t}$、$z_{0q}$ 和 $k$ 的函数，并由此将在高度 $z$ 处的 $H$ 和 $E$ 表示为 $U(z)$、$\\Theta(z)-\\Theta_{s}$ 和 $q(z)-q_{s}$ 的函数。使用给定数据，计算比率\n$$\nR=\\frac{H_{\\mathrm{err}}+E_{\\mathrm{err}}}{H_{\\mathrm{true}}+E_{\\mathrm{true}}},\n$$\n其中下标“$\\mathrm{err}$”表示使用错误的 $z_{0t}=z_{0q}=z_{0}$ 假设计算的通量，而“$\\mathrm{true}$”表示使用正确的 $z_{0t}$ 和 $z_{0q}$ 值计算的通量。将 $R$ 的最终答案四舍五入至四位有效数字。将 $R$ 报告为一个无单位的纯数。",
            "solution": "### 步骤 1：提取已知条件\n问题为中性海洋大气近地层提供了以下数据和定义：\n- 测量高度：$z=10$ m\n- $z$ 处的风速：$U(z)=25$ m s$^{-1}$\n- 海表位温：$\\Theta_{s}=288$ K\n- $z$ 处的空气位温：$\\Theta(z)=286$ K\n- 海表比湿：$q_{s}=0.011$ kg kg$^{-1}$\n- $z$ 处的空气比湿：$q(z)=0.007$ kg kg$^{-1}$\n- 空气密度：$\\rho=1.22$ kg m$^{-3}$\n- 空气定压比热：$c_{p}=1004$ J kg$^{-1}$ K$^{-1}$\n- 蒸发潜热：$L_{v}=2.5\\times 10^{6}$ J kg$^{-1}$\n- von Kármán 常数：$k=0.4$\n- 正确的粗糙度长度：$z_{0}=3.0\\times 10^{-3}$ m, $z_{0t}=1.0\\times 10^{-4}$ m, $z_{0q}=1.5\\times 10^{-4}$ m\n- 错误的粗糙度长度假设：$z_{0t}=z_{0q}=z_{0}$\n- 来自 Monin-Obukhov 相似性理论 (MOST) 的中性、常应力层的基本关系：\n  - 风速的对数廓线：$U(z) = \\frac{u_*}{k} \\ln \\left( \\frac{z}{z_0} \\right)$\n  - 位温的对数廓线：$\\Theta(z)-\\Theta_{s} = \\frac{\\Theta_*}{k} \\ln \\left( \\frac{z}{z_{0t}} \\right)$\n  - 比湿的对数廓线：$q(z)-q_{s} = \\frac{q_*}{k} \\ln \\left( \\frac{z}{z_{0q}} \\right)$\n  - 动量通量（地表应力）：$\\tau=\\rho\\,u_{*}^{2}$\n  - 感热通量：$H=-\\rho\\,c_{p}\\,u_{*}\\,\\Theta_{*}$\n  - 潜热通量：$E=-\\rho\\,L_{v}\\,u_{*}\\,q_{*}$\n  - 符号约定：对于更暖、更湿的表面，向上通量为正。\n- 任务是计算比率 $R=\\frac{H_{\\mathrm{err}}+E_{\\mathrm{err}}}{H_{\\mathrm{true}}+E_{\\mathrm{true}}}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题科学上基于成熟的 Monin-Obukhov 相似性理论，这是微气象学和边界层物理学的基石，广泛应用于数值天气预报和气候模型中。所有提供的物理常数和参数对于指定条件（大洋上的大风）都是符合实际的。该问题是适定的，提供了得出唯一数值答案所需的所有信息。语言客观而精确。核心任务涉及对物理模型参数化变化的敏感性分析，这是一种标准的科学研究。该问题不违反任何无效性标准。\n\n### 步骤 3：结论与行动\n该问题有效。将提供完整解答。\n\n### 解答推导\n该问题要求从提供的基本关系推导出整体输送系数以及通量 $H$ 和 $E$。\n\n首先，我们使用对数风廓线将摩擦速度 $u_{*}$ 表示为平均风速 $U(z)$ 的函数：\n$$u_{*} = \\frac{k U(z)}{\\ln\\left(\\frac{z}{z_{0}}\\right)}$$\n\n接下来，我们推导动量 ($C_D$)、热量 ($C_H$) 和水汽 ($C_E$) 的整体输送系数。通量的整体空气动力学公式为：\n$$\\tau = \\rho C_D U(z)^2$$\n$$H = \\rho c_p C_H U(z) (\\Theta_s - \\Theta(z))$$\n$$E = \\rho L_v C_E U(z) (q_s - q(z))$$\n\n将我们关于 $u_{*}$ 的表达式代入动量通量的定义 $\\tau=\\rho u_{*}^2$ 中，我们可以求出 $C_D$：\n$$\\tau = \\rho \\left( \\frac{k U(z)}{\\ln\\left(\\frac{z}{z_{0}}\\right)} \\right)^2 = \\rho \\left( \\frac{k}{\\ln\\left(\\frac{z}{z_{0}}\\right)} \\right)^2 U(z)^2$$\n将此与 $\\tau = \\rho C_D U(z)^2$ 比较，我们确定拖曳系数为：\n$$C_D = \\left( \\frac{k}{\\ln\\left(\\frac{z}{z_{0}}\\right)} \\right)^2$$\n\n现在，我们推导感热通量 $H$ 的表达式。从对数温度廓线中，我们分离出温度尺度 $\\Theta_{*}$：\n$$\\Theta_{*} = \\frac{k(\\Theta(z)-\\Theta_s)}{\\ln\\left(\\frac{z}{z_{0t}}\\right)}$$\n将 $u_{*}$ 和 $\\Theta_{*}$ 的表达式代入感热通量的定义 $H = -\\rho c_p u_{*} \\Theta_{*}$：\n$$H = -\\rho c_p \\left(\\frac{k U(z)}{\\ln\\left(\\frac{z}{z_{0}}\\right)}\\right) \\left(\\frac{k(\\Theta(z)-\\Theta_s)}{\\ln\\left(\\frac{z}{z_{0t}}\\right)}\\right)$$\n$$H = \\rho c_p \\left( \\frac{k^2}{\\ln\\left(\\frac{z}{z_{0}}\\right) \\ln\\left(\\frac{z}{z_{0t}}\\right)} \\right) U(z) (\\Theta_s - \\Theta(z))$$\n将此与 $H$ 的整体公式进行比较，我们确定热量输送系数（斯坦顿数）$C_H$：\n$$C_H = \\frac{k^2}{\\ln\\left(\\frac{z}{z_{0}}\\right) \\ln\\left(\\frac{z}{z_{0t}}\\right)}$$\n\n类似地，对于潜热通量 $E$，我们首先从其对数廓线中分离出湿度尺度 $q_{*}$：\n$$q_{*} = \\frac{k(q(z)-q_s)}{\\ln\\left(\\frac{z}{z_{0q}}\\right)}$$\n将 $u_{*}$ 和 $q_{*}$ 代入定义式 $E = -\\rho L_v u_{*} q_{*}$：\n$$E = -\\rho L_v \\left(\\frac{k U(z)}{\\ln\\left(\\frac{z}{z_{0}}\\right)}\\right) \\left(\\frac{k(q(z)-q_s)}{\\ln\\left(\\frac{z}{z_{0q}}\\right)}\\right)$$\n$$E = \\rho L_v \\left( \\frac{k^2}{\\ln\\left(\\frac{z}{z_{0}}\\right) \\ln\\left(\\frac{z}{z_{0q}}\\right)} \\right) U(z) (q_s - q(z))$$\n将此与 $E$ 的整体公式进行比较，我们确定水汽输送系数（道尔顿数）$C_E$：\n$$C_E = \\frac{k^2}{\\ln\\left(\\frac{z}{z_{0}}\\right) \\ln\\left(\\frac{z}{z_{0q}}\\right)}$$\n\n总湍流地表能量通量是感热通量和潜热通量之和，$F = H+E$。令 $\\Delta\\Theta = \\Theta_s - \\Theta(z)$ 且 $\\Delta q = q_s - q(z)$。\n$$F = H+E = \\rho U(z) (c_p C_H \\Delta\\Theta + L_v C_E \\Delta q)$$\n代入我们关于 $C_H$ 和 $C_E$ 的表达式：\n$$F = \\rho U(z) \\left( c_p \\frac{k^2}{\\ln\\left(\\frac{z}{z_{0}}\\right) \\ln\\left(\\frac{z}{z_{0t}}\\right)} \\Delta\\Theta + L_v \\frac{k^2}{\\ln\\left(\\frac{z}{z_{0}}\\right) \\ln\\left(\\frac{z}{z_{0q}}\\right)} \\Delta q \\right)$$\n$$F = \\frac{\\rho U(z) k^2}{\\ln\\left(\\frac{z}{z_{0}}\\right)} \\left( \\frac{c_p \\Delta\\Theta}{\\ln\\left(\\frac{z}{z_{0t}}\\right)} + \\frac{L_v \\Delta q}{\\ln\\left(\\frac{z}{z_{0q}}\\right)} \\right)$$\n\n我们需要计算比率 $R=\\frac{F_{\\mathrm{err}}}{F_{\\mathrm{true}}}$，其中 $F = H+E$。\n\n对于“真实”情况，我们使用正确的粗糙度长度 $z_{0}$、$z_{0t}$ 和 $z_{0q}$：\n$$F_{\\mathrm{true}} = \\frac{\\rho U(z) k^2}{\\ln\\left(\\frac{z}{z_{0}}\\right)} \\left( \\frac{c_p \\Delta\\Theta}{\\ln\\left(\\frac{z}{z_{0t}}\\right)} + \\frac{L_v \\Delta q}{\\ln\\left(\\frac{z}{z_{0q}}\\right)} \\right)$$\n\n对于“错误”情况，模式假设 $z_{0t}=z_{0q}=z_{0}$：\n$$F_{\\mathrm{err}} = \\frac{\\rho U(z) k^2}{\\ln\\left(\\frac{z}{z_{0}}\\right)} \\left( \\frac{c_p \\Delta\\Theta}{\\ln\\left(\\frac{z}{z_{0}}\\right)} + \\frac{L_v \\Delta q}{\\ln\\left(\\frac{z}{z_{0}}\\right)} \\right)$$\n$$F_{\\mathrm{err}} = \\frac{\\rho U(z) k^2}{\\left(\\ln\\left(\\frac{z}{z_{0}}\\right)\\right)^2} (c_p \\Delta\\Theta + L_v \\Delta q)$$\n\n现在我们计算比率 $R$：\n$$R = \\frac{F_{\\mathrm{err}}}{F_{\\mathrm{true}}} = \\frac{\\frac{\\rho U(z) k^2}{\\left(\\ln\\left(\\frac{z}{z_{0}}\\right)\\right)^2} (c_p \\Delta\\Theta + L_v \\Delta q)}{\\frac{\\rho U(z) k^2}{\\ln\\left(\\frac{z}{z_{0}}\\right)} \\left( \\frac{c_p \\Delta\\Theta}{\\ln\\left(\\frac{z}{z_{0t}}\\right)} + \\frac{L_v \\Delta q}{\\ln\\left(\\frac{z}{z_{0q}}\\right)} \\right)}$$\n项 $\\frac{\\rho U(z) k^2}{\\ln(z/z_0)}$ 从分子和分母中约去：\n$$R = \\frac{\\frac{1}{\\ln\\left(\\frac{z}{z_{0}}\\right)} (c_p \\Delta\\Theta + L_v \\Delta q)}{\\frac{c_p \\Delta\\Theta}{\\ln\\left(\\frac{z}{z_{0t}}\\right)} + \\frac{L_v \\Delta q}{\\ln\\left(\\frac{z}{z_{0q}}\\right)}}$$\n\n现在，我们代入所提供的数值：\n- $\\Delta\\Theta = \\Theta_s - \\Theta(z) = 288\\,\\mathrm{K} - 286\\,\\mathrm{K} = 2\\,\\mathrm{K}$\n- $\\Delta q = q_s - q(z) = 0.011 - 0.007 = 0.004\\,\\mathrm{kg}\\,\\mathrm{kg}^{-1}$\n- $c_{p} = 1004$ J kg$^{-1}$ K$^{-1}$\n- $L_{v}=2.5\\times 10^{6}$ J kg$^{-1}$\n- 高度 $z=10$ m\n- 粗糙度长度：$z_{0}=3.0\\times 10^{-3}$ m; $z_{0t}=1.0\\times 10^{-4}$ m; $z_{0q}=1.5\\times 10^{-4}$ m\n\n首先，计算包含物理常数和梯度的项：\n- $c_p \\Delta\\Theta = 1004 \\times 2 = 2008$ J kg$^{-1}$\n- $L_v \\Delta q = (2.5\\times 10^{6}) \\times 0.004 = 10000$ J kg$^{-1}$\n- $c_p \\Delta\\Theta + L_v \\Delta q = 2008 + 10000 = 12008$ J kg$^{-1}$\n\n接下来，计算对数：\n- $\\ln\\left(\\frac{z}{z_{0}}\\right) = \\ln\\left(\\frac{10}{3.0\\times 10^{-3}}\\right) = \\ln\\left(\\frac{10000}{3}\\right) \\approx 8.11172$\n- $\\ln\\left(\\frac{z}{z_{0t}}\\right) = \\ln\\left(\\frac{10}{1.0\\times 10^{-4}}\\right) = \\ln(100000) \\approx 11.51293$\n- $\\ln\\left(\\frac{z}{z_{0q}}\\right) = \\ln\\left(\\frac{10}{1.5\\times 10^{-4}}\\right) = \\ln\\left(\\frac{100000}{1.5}\\right) \\approx 11.10738$\n\n现在，计算 $R$ 表达式的分子和分母：\n- 分子：$\\frac{1}{\\ln\\left(\\frac{z}{z_{0}}\\right)} (c_p \\Delta\\Theta + L_v \\Delta q) = \\frac{12008}{8.11172} \\approx 1480.32$\n- 分母：$\\frac{c_p \\Delta\\Theta}{\\ln\\left(\\frac{z}{z_{0t}}\\right)} + \\frac{L_v \\Delta q}{\\ln\\left(\\frac{z}{z_{0q}}\\right)} = \\frac{2008}{11.51293} + \\frac{10000}{11.10738} \\approx 174.410 + 900.299 = 1074.709$\n\n最后，我们计算比率 $R$：\n$$R = \\frac{1480.32}{1074.709} \\approx 1.37745$$\n将结果四舍五入到四位有效数字，得到 $R=1.377$。\n这个结果表明，数值模式中的错误简化导致总湍流地表能量通量被高估了大约 $37.7\\%$。这在物理上是一致的，因为错误的假设对标量输送使用了更大的粗糙度长度（$z_0$），与使用更小的正确值（$z_{0t}, z_{0q}$）相比，这提高了计算出的输送效率。",
            "answer": "$$\\boxed{1.377}$$"
        },
        {
            "introduction": "与陆地表面粗糙度相对固定的特性不同，海洋的粗糙度是动态的，它由风驱动的海浪产生，并反过来影响风本身，形成一个紧密耦合的非线性系统。这项综合性实践将引导你为这个复杂的海气相互作用过程编写一个迭代求解器 。你将运用查诺克关系式 (Charnock relation)，将物理方程转化为数值算法，这不仅是一次编码练习，更是对现代气象和气候模型如何处理海气界面动力学的核心机制的深入探索。",
            "id": "4010093",
            "problem": "给定一个高度 $z = 10\\,\\mathrm{m}$，在此高度上测量了两种地表类型（海洋和陆地）的平均风速 $U_{10}$。任务是计算在不同条件下的摩擦速度 $u_\\*$（单位为 $\\mathrm{m\\,s^{-1}}$）和空气动力学粗糙度长度 $z_0$（单位为 $\\mathrm{m}$）。计算必须从经典的 Monin-Obukhov 相似理论（MOST）的地表层动量框架出发，将平均风廓线处理为带有稳定度修正的对数形式。在海洋上，通过 Charnock 关系引入流体动力学耦合。在陆地上，将粗糙度视为给定的常数。您必须构建一个迭代（非线性）数值方法，该方法能自洽地求解 $u_\\*$ 和 $z_0$ 的耦合系统，并突出 Charnock 耦合引入的非线性。所有数值结果必须以指定单位表示：$u_\\*$ 的单位为 $\\mathrm{m\\,s^{-1}}$，$z_0$ 的单位为 $\\mathrm{m}$，每个结果都需四舍五入到六位小数。\n\n使用的基本原理和事实：\n- 地表层中带有稳定度修正的对数风廓线由 Monin-Obukhov 相似理论（MOST）定义为\n$$\nU(z) = \\frac{u_\\*}{\\kappa}\\left[\\ln\\!\\left(\\frac{z}{z_0}\\right) - \\psi_m\\!\\left(\\frac{z}{L}\\right)\\right],\n$$\n其中 $U(z)$ 是高度 $z$ 处的平均风速，$u_\\*$ 是摩擦速度，$\\kappa$ 是 von Kármán 常数，$z_0$ 是空气动力学粗糙度长度，$\\psi_m$ 是无量纲稳定度修正函数。在本问题中，将在 $z = 10\\,\\mathrm{m}$ 处评估的稳定度修正值作为给定输入值提供，记为 $\\psi_{10}$，因此不需要显式计算 Obukhov 长度 $L$。\n- 在海洋上，粗糙度通过 Charnock 关系依赖于应力（因此也依赖于 $u_\\*$）。一个广泛使用的组合粘性-重力公式为\n$$\nz_0(u_\\*) = \\alpha\\frac{u_\\*^2}{g} + B\\frac{\\nu}{u_\\*},\n$$\n其中 $\\alpha$ 是 Charnock 参数（无量纲），$g$ 是重力加速度，$B$ 是无量纲光滑表面系数，$\\nu$ 是空气的运动粘度。这种耦合引入了非线性，因为 $z_0$ 依赖于 $u_\\*$，而 $u_\\*$ 又通过对数风关系依赖于 $z_0$。使用 $g = 9.81\\,\\mathrm{m\\,s^{-2}}$，$\\kappa = 0.4$，$B = 0.11$ 以及 $\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m^2\\,s^{-1}}$。\n- 在陆地上，将空气动力学粗糙度视为给定的且与 $u_\\*$ 无关：\n$$\nz_0 = z_{0,\\mathrm{land}},\n$$\n其中 $z_{0,\\mathrm{land}}$ 为给定值。\n\n您的程序必须实现一个稳健的非线性求解器，用于根据上述关系求解 $u_\\*$ 和 $z_0$。您可以使用任何适用于非线性方程的迭代数值技术，前提是它能强制执行物理约束 $u_\\* > 0$ 和 $z_0 > 0$，并收敛到一个满足在 $z = 10\\,\\mathrm{m}$ 处对数关系的一致解对，以应对给定的稳定度修正。您必须通过在海洋粗糙度中包含粘性项 $B\\,\\nu/u_\\*$ 来确保弱风条件下的数值稳定性，如上所述。\n\n每个测试用例的输入参数：\n- $U_{10}$（单位：$\\mathrm{m\\,s^{-1}}$），\n- $\\alpha$（无量纲），\n- $\\psi_{10}$（无量纲），\n- 地表类型，“ocean”（海洋）或“land”（陆地），\n- 如果地表类型为“land”，则提供一个给定的 $z_{0,\\mathrm{land}}$（单位：$\\mathrm{m}$）。\n\n实现要求：\n- 所有测试用例均使用 $z = 10\\,\\mathrm{m}$。\n- 在整个迭代过程中强制执行 $u_\\* > 0$ 和 $z_0 > 0$。\n- 对 $u_\\*$ 使用 $10^{-6}\\,\\mathrm{m\\,s^{-1}}$ 的收敛容差，每个案例最多迭代 $100$ 次。\n- 对于海洋案例，使用上述组合的 Charnock-粘性形式处理 $z_0$。\n- 对于陆地案例，使用给定的常数 $z_{0,\\mathrm{land}}$，仅求解 $u_\\*$。\n\n测试套件：\n为以下七个测试用例提供计算，每个用例都指定为一组参数元组，顺序为 $(U_{10}, \\alpha, \\psi_{10}, \\text{surface}, z_{0,\\mathrm{land}})$，其中 $z_{0,\\mathrm{land}}$ 对海洋案例被忽略：\n1. $(10.0, 0.018, 0.0, \\text{“ocean”}, 0.0)$: 海洋，中性条件，中等风速。\n2. $(8.0, 0.018, 0.7, \\text{“ocean”}, 0.0)$: 海洋，稳定分层，减小的切变。\n3. $(12.0, 0.018, -1.5, \\text{“ocean”}, 0.0)$: 海洋，强不稳定，增强的切变。\n4. $(0.5, 0.018, 0.2, \\text{“ocean”}, 0.0)$: 海洋，弱风，粘性粗糙度机制。\n5. $(7.0, 0.0, 0.0, \\text{“land”}, 0.1)$: 陆地，中性，粗糙草地，其中 $z_{0,\\mathrm{land}} = 0.1\\,\\mathrm{m}$。\n6. $(10.0, 0.0, 1.2, \\text{“land”}, 0.01)$: 陆地，稳定，短植被，其中 $z_{0,\\mathrm{land}} = 0.01\\,\\mathrm{m}$。\n7. $(30.0, 0.018, 0.0, \\text{“ocean”}, 0.0)$: 海洋，中性，大风。\n\n最终输出格式：\n您的程序应生成单行输出，包含一个由逗号分隔的七个元素的列表，每个元素本身都是一个用方括号括起来的、由逗号分隔的数对。每个数对是对应测试用例的 $[u_\\*, z_0]$，四舍五入到六位小数，顺序与上面列出的一致。例如，一个有效的输出格式是\n$$\n[ [u_{\\*,1}, z_{0,1}], [u_{\\*,2}, z_{0,2}], \\ldots, [u_{\\*,7}, z_{0,7}] ].\n$$",
            "solution": "经评估，用户提供的问题是有效的。分析过程如下。\n\n### 步骤 1：提取给定条件\n- **控制方程**：\n    1.  平均风廓线：$U(z) = \\frac{u_\\*}{\\kappa}\\left[\\ln\\!\\left(\\frac{z}{z_0}\\right) - \\psi_m\\!\\left(\\frac{z}{L}\\right)\\right]$\n    2.  $z=10\\,\\mathrm{m}$ 处的稳定度修正：$\\psi_{10}$（作为输入给定）。\n    3.  海洋粗糙度长度：$z_0(u_\\*) = \\alpha\\frac{u_\\*^2}{g} + B\\frac{\\nu}{u_\\*}$\n    4.  陆地粗糙度长度：$z_0 = z_{0,\\mathrm{land}}$（给定的）。\n- **常数**：\n    - 重力加速度：$g = 9.81\\,\\mathrm{m\\,s^{-2}}$\n    - von Kármán 常数：$\\kappa = 0.4$\n    - 光滑表面系数：$B = 0.11$\n    - 空气运动粘度：$\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m^2\\,s^{-1}}$\n- **测量高度**：$z = 10\\,\\mathrm{m}$\n- **每个案例的输入参数**：\n    - $U_{10}$（单位：$\\mathrm{m\\,s^{-1}}$）\n    - $\\alpha$（Charnock 参数，无量纲）\n    - $\\psi_{10}$（无量纲）\n    - 地表类型（“ocean”或“land”）\n    - $z_{0,\\mathrm{land}}$（单位：$\\mathrm{m}$）（用于陆地案例）\n- **数值要求**：\n    - 非线性案例的迭代方法。\n    - 物理约束：$u_\\* > 0$, $z_0 > 0$。\n    - $u_\\*$ 的收敛容差：$10^{-6}\\,\\mathrm{m\\,s^{-1}}$\n    - 最大迭代次数：$100$。\n- **测试套件**：提供了七个具有特定输入参数集的测试用例。\n\n### 步骤 2：使用提取的给定条件进行验证\n- **科学依据**：该问题基于 Monin-Obukhov 相似理论（MOST）、对数风廓线以及海洋粗糙度的 Charnock 关系。这些是大气边界层气象学中的基础且被广泛接受的原理，并且是数值天气预报和气候模型中的标准组成部分。该表述在科学上是合理的。\n- **适定性**：对于“陆地”案例，$z_0$ 是固定的，问题简化为对 $u_\\*$ 的直接代数求解，其解是唯一确定的。对于“海洋”案例，问题是一个包含两个未知数（$u_\\*$ 和 $z_0$）的两个方程的耦合系统。该系统可以简化为关于 $u_\\*$ 的单个非线性超越方程。对于给定的参数范围，此类方程通常允许一个唯一的、稳定的且具有物理意义的解。包含粘性粗糙度项确保了即使在极低风速下问题仍然是良态的。\n- **客观性**：问题以精确、定量的术语陈述。所有常数、方程和输入都被明确定义。没有主观或基于观点的陈述。\n- **其他缺陷**：问题是完整的，提供了所有必要信息。它没有矛盾、不切实际或微不足道之处。数值求解非线性海洋案例的任务是一个具有计算意义的问题，代表了真实世界的应用。\n\n### 步骤 3：结论与行动\n问题是有效的。将开发并呈现一个解决方案。\n\n### 求解推导与算法设计\n\n任务是找到摩擦速度 $u_\\*$ 和空气动力学粗糙度长度 $z_0$，使它们在给定高度 $z = 10\\,\\mathrm{m}$ 的风速 $U_{10}$ 下，同时满足对数风廓线和特定地表的粗糙度参数化。\n\n在 $z=10\\,\\mathrm{m}$ 处评估的核心方程是：\n$$\nU_{10} = \\frac{u_\\*}{\\kappa}\\left[\\ln\\!\\left(\\frac{10}{z_0}\\right) - \\psi_{10}\\right]\n$$\n\n求解方法取决于地表类型。\n\n**1. 陆地表面**\n\n对于陆地表面，粗糙度长度 $z_0$ 是一个给定的常数 $z_{0,\\mathrm{land}}$。系统变成一个只有一个未知数 $u_\\*$ 的单一方程。\n$$\nU_{10} = \\frac{u_\\*}{\\kappa}\\left[\\ln\\!\\left(\\frac{10}{z_{0,\\mathrm{land}}}\\right) - \\psi_{10}\\right]\n$$\n这个方程可以重新整理以直接求解 $u_\\*$：\n$$\nu_\\* = \\frac{\\kappa U_{10}}{\\ln\\!\\left(\\frac{10}{z_{0,\\mathrm{land}}}\\right) - \\psi_{10}}\n$$\n这是一个直接的代数计算。$z_0$ 的值就是输入的 $z_{0,\\mathrm{land}}$。\n\n**2. 海洋表面**\n\n对于海洋表面，$z_0$ 不是常数，而是通过组合的 Charnock-粘性关系依赖于摩擦速度 $u_\\*$ 本身：\n$$\nz_0(u_\\*) = \\alpha\\frac{u_\\*^2}{g} + B\\frac{\\nu}{u_\\*}\n$$\n这在 $u_\\*$ 和 $z_0$ 之间引入了非线性耦合。必须同时求解这两个方程组：\n1. $u_\\* = \\frac{\\kappa U_{10}}{\\ln(10/z_0) - \\psi_{10}}$\n2. $z_0 = \\alpha\\frac{u_\\*^2}{g} + B\\frac{\\nu}{u_\\*}$\n\n解决这个系统的一个稳健方法是定点迭代（也称为逐次代换法）。这个迭代过程如下：\n\n*   **步骤 0：初始化。**对摩擦速度进行初始猜测，$u_{*,0} > 0$。一个合理的起始点可以从典型的拖曳系数推导出来，例如，$u_{*,0} = 0.035 \\times U_{10}$。\n\n*   **步骤 1：迭代。**对于每次迭代 $k=0, 1, 2, \\dots$：\n    a.  使用当前摩擦速度的估计值 $u_{*,k}$ 和海洋粗糙度公式，计算粗糙度长度的估计值 $z_{0,k}$：\n        $$\n        z_{0,k} = \\alpha\\frac{u_{*,k}^2}{g} + B\\frac{\\nu}{u_{*,k}}\n        $$\n    b.  使用这个 $z_{0,k}$ 从对数风廓线中计算摩擦速度的更新估计值 $u_{*,k+1}$：\n        $$\n        u_{*,k+1} = \\frac{\\kappa U_{10}}{\\ln(10/z_{0,k}) - \\psi_{10}}\n        $$\n\n*   **步骤 2：收敛性检查。**每次迭代后，通过将 $u_\\*$ 的变化与指定的容差 $\\epsilon = 10^{-6}\\,\\mathrm{m\\,s^{-1}}$ 进行比较，检查解是否收敛：\n    $$\n    |u_{*,k+1} - u_{*,k}|  \\epsilon\n    $$\n    如果满足此条件，则终止迭代，且 $u_* = u_{*,k+1}$ 为收敛解。\n\n*   **步骤 3：终止。**如果未达到收敛，则设置 $u_{*,k} \\leftarrow u_{*,k+1}$ 并返回步骤 1。为防止不收敛时出现无限循环，强制执行最大迭代次数（$100$ 次）。\n\n*   **步骤 4：$z_0$ 的最终值。**一旦找到收敛的 $u_\\*$ 值，就最后一次使用海洋粗糙度公式计算出最终一致的 $z_0$ 值。\n\n只要初始猜测为正，这个迭代方案就遵守物理约束（$u_\\*  0, z_0  0$），因为在典型的大气条件下，更新步骤中的所有项都是正的。包含粘性项 $B\\nu/u_\\*$ 至关重要，因为它能防止 $z_0$ 在弱风条件下趋近于零，从而保持对数的参数有定义并确保数值稳定性。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve for friction velocity and roughness length\n    for a series of test cases based on Monin-Obukhov Similarity Theory.\n    \"\"\"\n\n    # Define physical and numerical constants from the problem statement\n    KAPPA = 0.4  # von Kármán constant\n    G = 9.81  # Gravitational acceleration (m/s^2)\n    B_COEFF = 0.11  # Smooth-surface coefficient\n    NU_AIR = 1.5e-5  # Kinematic viscosity of air (m^2/s)\n    Z_REF = 10.0  # Reference height (m)\n    \n    # Numerical solver parameters\n    TOLERANCE_U_STAR = 1e-6\n    MAX_ITERATIONS = 100\n\n    def calculate_solution(U10, alpha, psi10, surface_type, z0_land):\n        \"\"\"\n        Calculates u_star and z_0 for a single case.\n        \"\"\"\n        if surface_type == \"land\":\n            # Direct algebraic solution for land surface\n            z0 = z0_land\n            if z0 = 0:\n                raise ValueError(\"z0_land must be positive.\")\n            \n            denominator = np.log(Z_REF / z0) - psi10\n            if denominator == 0:\n                # This case implies very high stability or very large roughness,\n                # leading to an unphysical profile.\n                raise ValueError(\"Unphysical conditions for land case.\")\n            \n            u_star = (KAPPA * U10) / denominator\n            return u_star, z0\n\n        elif surface_type == \"ocean\":\n            # Iterative solution for ocean surface (coupled system)\n            \n            # Initial guess for u_star. A common approximation is ~3.5% of wind speed.\n            u_star = 0.035 * U10 \n            if u_star = 0:\n                # Handle zero wind speed case, though not in test suite.\n                # If U10 is 0, u_star must be 0. z0 becomes infinite.\n                # Here we assume U10 > 0 based on test cases.\n                u_star = TOLERANCE_U_STAR\n\n            for _ in range(MAX_ITERATIONS):\n                u_star_old = u_star\n                \n                # Step 1a: Calculate z0 from current u_star\n                # Charnock-viscous formulation\n                z0 = alpha * (u_star**2 / G) + B_COEFF * (NU_AIR / u_star)\n                \n                if z0 = 0 or Z_REF / z0 == 1.0:\n                    raise StopIteration(\"Iteration produced unphysical z0.\")\n                \n                # Step 1b: Update u_star using the new z0 in the log-wind profile\n                denominator = np.log(Z_REF / z0) - psi10\n                if denominator == 0:\n                    # This could happen in extremely stable conditions\n                    raise StopIteration(\"Unphysical stability/roughness condition.\")\n\n                u_star = (KAPPA * U10) / denominator\n\n                # Step 2: Check for convergence\n                if abs(u_star - u_star_old)  TOLERANCE_U_STAR:\n                    # Converged, calculate final z0 with converged u_star\n                    final_z0 = alpha * (u_star**2 / G) + B_COEFF * (NU_AIR / u_star)\n                    return u_star, final_z0\n            \n            # If loop finishes, it failed to converge\n            raise StopIteration(f\"Failed to converge for U10={U10}, alpha={alpha}, psi10={psi10}\")\n        else:\n            raise ValueError(f\"Unknown surface type: {surface_type}\")\n\n    # Test cases as provided in the problem description\n    test_cases = [\n        (10.0, 0.018, 0.0, \"ocean\", 0.0),\n        (8.0, 0.018, 0.7, \"ocean\", 0.0),\n        (12.0, 0.018, -1.5, \"ocean\", 0.0),\n        (0.5, 0.018, 0.2, \"ocean\", 0.0),\n        (7.0, 0.0, 0.0, \"land\", 0.1),\n        (10.0, 0.0, 1.2, \"land\", 0.01),\n        (30.0, 0.018, 0.0, \"ocean\", 0.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        u_star_val, z0_val = calculate_solution(*case)\n        # Format each result pair as a string \"[u_star,z0]\"\n        results.append(f\"[{u_star_val:.6f},{z0_val:.6f}]\")\n\n    # Final print statement in the exact required format\n    # Example: [[u_*,1,z_0,1],[u_*,2,z_0,2],...] with no spaces\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}