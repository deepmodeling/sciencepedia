{
    "hands_on_practices": [
        {
            "introduction": "This first practice serves as a fundamental check on the conservation of energy at the Earth's surface. By applying the surface energy balance equation, you will calculate the ground heat flux—the energy responsible for warming or cooling the soil. This exercise will enhance your understanding of how net radiation is partitioned and the physical meaning of soil heat storage within the diurnal cycle, a core diagnostic skill in land-surface modeling. ",
            "id": "4090110",
            "problem": "A single land surface grid cell in a Numerical Weather Prediction (NWP) land-surface scheme is observed over a $30$-minute averaging period near local midday under clear-sky conditions, with no snow and negligible biomass heat storage. The micrometeorological sign convention is used in which net radiation $R_n$ is defined positive downward, sensible heat flux $H$ and latent heat flux $LE$ are defined positive upward, and the ground (soil) conductive heat flux $G$ is defined positive downward at the soil surface. Over this averaging period, measurements yield $R_n=500\\ \\mathrm{W\\,m^{-2}}$, $H=150\\ \\mathrm{W\\,m^{-2}}$, and $LE=280\\ \\mathrm{W\\,m^{-2}}$. Assume that short-term heat storage in the surface skin and canopy air space is negligible over this period.\n\nUsing only conservation of energy for a representative surface control volume and basic definitions of turbulent and conductive fluxes, compute the ground heat flux $G$. Express your final result in $\\mathrm{W\\,m^{-2}}$. Provide the exact value; no rounding is required. Then, based on first principles of heat conduction and diurnal surface forcing, discuss the physical meaning of positive versus negative $G$ during the diurnal cycle and relate the sign of $G$ to the vertical soil temperature gradient and thermal inertia. Your discussion should not rely on empirical memorization but rather on fundamental balance arguments and Fourier’s law.",
            "solution": "The problem is first assessed for validity.\n\n**Step 1: Extract Givens**\n- Land surface grid cell in a Numerical Weather Prediction (NWP) land-surface scheme.\n- Averaging period: a $30$-minute period near local midday.\n- Conditions: Clear-sky, no snow, negligible biomass heat storage.\n- Micrometeorological sign convention:\n    - Net radiation $R_n$: positive downward.\n    - Sensible heat flux $H$: positive upward.\n    - Latent heat flux $LE$: positive upward.\n    - Ground (soil) conductive heat flux $G$: positive downward at the soil surface.\n- Measured data:\n    - $R_n = 500\\ \\mathrm{W\\,m^{-2}}$\n    - $H = 150\\ \\mathrm{W\\,m^{-2}}$\n    - $LE = 280\\ \\mathrm{W\\,m^{-2}}$\n- Assumption: Short-term heat storage in the surface skin and canopy air space is negligible.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, as it is based on the fundamental principle of conservation of energy applied to the Earth's surface, a core concept in micrometeorology and climate science. The numerical values provided for the fluxes are physically realistic for midday, clear-sky conditions over land. The problem is well-posed; it provides all necessary information to determine the single unknown variable, $G$, using the surface energy balance equation. The sign convention is explicitly and clearly defined, preventing ambiguity. The problem is objective and free of any speculative or non-scientific claims. All criteria for a valid problem are met.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A solution will be provided.\n\nThe first part of the problem requires the computation of the ground heat flux, $G$. This is governed by the principle of conservation of energy for a control volume at the land-atmosphere interface. Assuming negligible heat storage in the surface skin and canopy air, the surface energy balance equation states that the net radiative energy input must be balanced by the sum of the turbulent fluxes of sensible and latent heat to the atmosphere and the conductive heat flux into the ground.\n\nThe surface energy balance equation is:\n$$R_n = H + LE + G$$\nHere, each term represents a flux density in units of $\\mathrm{W\\,m^{-2}}$. The problem explicitly defines the sign convention: $R_n$ is positive downward (an energy gain for the surface), while $H$ and $LE$ are positive upward (energy losses from the surface). The ground heat flux $G$ is defined as positive downward (an energy loss from the surface into the soil). The equation as written is consistent with this sign convention, where the source term ($R_n$) equals the sum of the sink terms ($H$, $LE$, and $G$).\n\nTo compute the ground heat flux $G$, we rearrange the energy balance equation:\n$$G = R_n - H - LE$$\n\nSubstituting the given numerical values:\n$$R_n = 500\\ \\mathrm{W\\,m^{-2}}$$\n$$H = 150\\ \\mathrm{W\\,m^{-2}}$$\n$$LE = 280\\ \\mathrm{W\\,m^{-2}}$$\n\nWe calculate $G$:\n$$G = 500 - 150 - 280$$\n$$G = 500 - 430$$\n$$G = 70\\ \\mathrm{W\\,m^{-2}}$$\nThe resulting ground heat flux is $70\\ \\mathrm{W\\,m^{-2}}$.\n\nThe second part of the problem asks for a discussion of the physical meaning of the sign of $G$ based on first principles. The conductive heat flux in a medium is described by Fourier's law of heat conduction. Let us define a vertical coordinate $z$ that is zero at the surface and positive downward into the soil. In this coordinate system, Fourier's law for the vertical heat flux $G$ is:\n$$G = -k_s \\frac{\\partial T_s}{\\partial z}$$\nwhere $k_s$ is the soil thermal conductivity (a positive definite property, $k_s > 0$) and $\\frac{\\partial T_s}{\\partial z}$ is the vertical gradient of soil temperature, $T_s$.\n\nThe sign of $G$ is thus determined by the sign of the vertical temperature gradient, $-\\frac{\\partial T_s}{\\partial z}$.\n- **Positive Ground Heat Flux ($G > 0$):** Our calculation yielded $G = 70\\ \\mathrm{W\\,m^{-2}}$, which is positive. According to Fourier's law, a positive $G$ requires that $-k_s \\frac{\\partial T_s}{\\partial z} > 0$. Since $k_s > 0$, this implies $\\frac{\\partial T_s}{\\partial z}  0$. A negative temperature gradient in our coordinate system ($z$ positive downward) means that soil temperature decreases with increasing depth. This physical situation occurs during the day, particularly around local midday as specified in the problem, when solar radiation heats the surface to a temperature higher than the soil layers below it. The positive sign of $G$ signifies a downward flux of heat, transferring energy from the warm surface into the cooler subsurface soil, representing energy storage in the ground.\n\n- **Negative Ground Heat Flux ($G  0$):** Conversely, a negative value for $G$ would imply an upward flux of heat from the soil to the surface. This occurs when the surface is cooler than the soil beneath it. According to Fourier's law, for $G  0$, we must have $\\frac{\\partial T_s}{\\partial z} > 0$ (since $-k_s$ is negative). A positive temperature gradient (with $z$ positive downward) means that temperature increases with depth. This typically happens at night, when the surface cools by emitting longwave radiation more rapidly than the insulated soil below. The negative $G$ represents the release of heat that was stored in the soil during the day.\n\n- **Relation to Thermal Inertia:** The magnitude of $G$ is related to the soil's thermal inertia, $I$, which is a measure of its resistance to temperature change. As defined in the main text, thermal inertia is $I = \\sqrt{C k_s}$, where $C$ is the total volumetric heat capacity (which depends on water content) and $k_s$ is the soil thermal conductivity.\n    - A soil with **high thermal inertia** (e.g., wet, dense soil) can absorb and release large amounts of heat with only a small change in surface temperature. Such a soil will exhibit a large amplitude in its diurnal cycle of $G$—a large positive $G$ during the day and a large-magnitude negative $G$ at night. This efficient heat transfer into and out of the ground dampens the diurnal range of the surface temperature.\n    - A soil with **low thermal inertia** (e.g., dry, loose sand) has poor thermal conductivity and/or low heat capacity. It cannot efficiently conduct heat away from the surface. Consequently, for a given radiative forcing, the surface temperature will rise sharply during the day, but the ground heat flux $G$ will be relatively small. At night, there is less stored heat to be released, so the magnitude of the negative $G$ is also small, and the surface cools dramatically. This leads to a large diurnal range in surface temperature.\n\nIn summary, the calculated positive value of $G$ is physically consistent with midday conditions, indicating heat flow into the soil driven by a surface that is warmer than the subsurface. The magnitude of this flux, in relation to the net radiation, is modulated by the soil's thermal inertia.",
            "answer": "$$\n\\boxed{70}\n$$"
        },
        {
            "introduction": "Having examined the energy budget, we now turn to the water budget by modeling infiltration, a critical process that governs soil moisture and runoff generation. This practice challenges you to derive the expression for the time to ponding within the classic Green–Ampt framework, a foundational conceptual model in hydrology. Completing this exercise will clarify how soil properties and rainfall intensity interact to partition water at the surface, a key component of any land surface scheme. ",
            "id": "4090084",
            "problem": "In land surface schemes used within Numerical Weather Prediction (NWP) and climate modeling, infiltration and runoff partitioning depends on the timing of surface ponding relative to rainfall onset. Consider a homogeneous, deep soil column subject to a constant rainfall rate $P$ beginning at time $t=0$ and modeled using the Green–Ampt infiltration framework. Assume the following standard Green–Ampt conditions: a sharp wetting front, uniform initial volumetric water content, an immediately saturated layer above the wetting front after rainfall begins, negligible surface storage prior to ponding, and a constant capillary suction head at the wetting front. Let the saturated hydraulic conductivity be $K_{s}$, the effective capillary suction head across the wetting front be $\\Delta \\psi$, and the water content jump across the wetting front be $\\Delta \\theta$. \n\nStarting from the Darcy–Buckingham law and mass conservation, derive an analytic expression for the time to ponding $t_{p}$ under constant rainfall $P$ in terms of $K_{s}$, $\\Delta \\psi$, $\\Delta \\theta$, and $P$. Then, given $K_{s} = 1.0 \\times 10^{-5} \\ \\mathrm{m} \\ \\mathrm{s}^{-1}$, $\\Delta \\psi = 0.25 \\ \\mathrm{m}$, $\\Delta \\theta = 0.20$, and $P = 5.0 \\times 10^{-5} \\ \\mathrm{m} \\ \\mathrm{s}^{-1}$, compute $t_{p}$ and express the final time in minutes. Round your answer to $4$ significant figures.",
            "solution": "The goal is to determine the time to ponding $t_{p}$ when rainfall at a constant rate $P$ first exceeds the infiltration capacity at the soil surface, within the Green–Ampt framework. We begin from first principles applicable to infiltration in soils.\n\nUnder the Green–Ampt assumptions, infiltration proceeds with a sharp wetting front located at depth $z_{f}(t)$, above which the soil is saturated at volumetric water content $\\theta_{s}$ and below which the soil remains at its initial volumetric water content $\\theta_{i}$. The water content jump across the front is $\\Delta \\theta = \\theta_{s} - \\theta_{i}$. The cumulative infiltration $F(t)$ from $t=0$ to time $t$ satisfies\n$$\nF(t) = \\Delta \\theta \\, z_{f}(t),\n$$\nbecause the sharp front increases water content by $\\Delta \\theta$ over depth $z_{f}$.\n\nThe Darcy–Buckingham law for vertical flow states that the flux $q$ is\n$$\nq = - K(\\theta) \\, \\frac{\\partial H}{\\partial z},\n$$\nwhere $H = \\psi + z$ is the hydraulic head, $\\psi$ is the pressure head, and $z$ is the gravitational head (taken positive downward). In the Green–Ampt approximation, the flow through the saturated layer above the wetting front can be taken at hydraulic conductivity $K_{s}$, and the hydraulic head drop from the soil surface (reference head) to the wetting front consists of a gravitational head drop of $z_{f}$ plus a capillary suction head at the front of $\\Delta \\psi$. Hence, over the distance $z_{f}$, the hydraulic gradient is\n$$\n\\frac{\\Delta H}{z_{f}} = \\frac{z_{f} + \\Delta \\psi}{z_{f}} = 1 + \\frac{\\Delta \\psi}{z_{f}}.\n$$\nTherefore, the infiltration capacity (maximum possible infiltration flux at the surface supported by the subsurface) is\n$$\nf_{c} = K_{s} \\left( 1 + \\frac{\\Delta \\psi}{z_{f}} \\right).\n$$\nUsing the relation $z_{f} = F / \\Delta \\theta$, we obtain the widely used Green–Ampt infiltration capacity as a function of cumulative infiltration:\n$$\nf_{c}(F) = K_{s} \\left( 1 + \\frac{\\Delta \\psi \\, \\Delta \\theta}{F} \\right).\n$$\n\nBefore ponding, the actual infiltration rate equals the rainfall rate, so\n$$\nf(t) = P \\quad \\text{and} \\quad F(t) = \\int_{0}^{t} f(\\tau) \\, d\\tau = P t.\n$$\nPonding occurs at the first time $t_{p}$ when the rainfall rate $P$ equals the infiltration capacity $f_{c}(F)$ evaluated at the corresponding cumulative infiltration $F_{p} = F(t_{p})$. Thus,\n$$\nP = K_{s} \\left( 1 + \\frac{\\Delta \\psi \\, \\Delta \\theta}{F_{p}} \\right).\n$$\nSolving for $F_{p}$,\n$$\n\\frac{\\Delta \\psi \\, \\Delta \\theta}{F_{p}} = \\frac{P}{K_{s}} - 1 \\quad \\Rightarrow \\quad F_{p} = \\frac{\\Delta \\psi \\, \\Delta \\theta}{\\frac{P}{K_{s}} - 1} = \\frac{\\Delta \\psi \\, \\Delta \\theta \\, K_{s}}{P - K_{s}}.\n$$\nSince $F_{p} = P t_{p}$ during the pre-ponding period,\n$$\nt_{p} = \\frac{F_{p}}{P} = \\frac{\\Delta \\psi \\, \\Delta \\theta \\, K_{s}}{P \\, (P - K_{s})}.\n$$\nThis expression is physically meaningful only if $P > K_{s}$, otherwise the infiltration capacity never falls below the rainfall rate and ponding does not occur.\n\nNow evaluate $t_{p}$ for the given parameters:\n- $K_{s} = 1.0 \\times 10^{-5} \\ \\mathrm{m} \\ \\mathrm{s}^{-1}$,\n- $\\Delta \\psi = 0.25 \\ \\mathrm{m}$,\n- $\\Delta \\theta = 0.20$,\n- $P = 5.0 \\times 10^{-5} \\ \\mathrm{m} \\ \\mathrm{s}^{-1}$.\n\nCompute the numerator:\n$$\n\\Delta \\psi \\, \\Delta \\theta \\, K_{s} = (0.25) \\times (0.20) \\times \\left(1.0 \\times 10^{-5}\\right) = 5.0 \\times 10^{-7}.\n$$\nCompute the denominator:\n$$\nP \\, (P - K_{s}) = \\left(5.0 \\times 10^{-5}\\right) \\times \\left(5.0 \\times 10^{-5} - 1.0 \\times 10^{-5}\\right) = \\left(5.0 \\times 10^{-5}\\right) \\times \\left(4.0 \\times 10^{-5}\\right) = 2.0 \\times 10^{-9}.\n$$\nThus,\n$$\nt_{p} = \\frac{5.0 \\times 10^{-7}}{2.0 \\times 10^{-9}} = 2.5 \\times 10^{2} \\ \\mathrm{s} = 250 \\ \\mathrm{s}.\n$$\nConvert seconds to minutes:\n$$\nt_{p,\\ \\mathrm{min}} = \\frac{250}{60} = 4.166\\overline{6} \\ \\mathrm{min}.\n$$\nRounded to $4$ significant figures and expressed in minutes,\n$$\nt_{p,\\ \\mathrm{min}} = 4.167.\n$$",
            "answer": "$$\\boxed{4.167}$$"
        },
        {
            "introduction": "This final practice synthesizes process-level understanding into a practical modeling context, focusing on a core activity for any numerical modeler: sensitivity analysis. Through a hands-on coding simulation of a storm event, you will quantify how a change in soil porosity—a key hydrologic parameter—propagates to alter predictions of infiltration and runoff. This exercise illuminates the mechanisms controlling land-surface hydrology and highlights the importance of parameter uncertainty in weather and climate prediction. ",
            "id": "4090098",
            "problem": "You are provided with a physically based framework for simulating one-dimensional vertical infiltration and surface runoff during storm events, consistent with Numerical Weather Prediction (NWP) and climate modeling land surface schemes. The exercise centers on soil thermal and hydrologic parameterizations focusing on the sensitivity of infiltration capacity and runoff generation to changes in a key soil parameter. The goal is to perform a sensitivity analysis showing how a $10\\%$ increase in a single soil parameter affects infiltration rates and runoff generation, and to interpret the physical mechanism.\n\nUse the following fundamental base and modeling assumptions:\n- The Darcy–Buckingham law describes vertical water flux in unsaturated media as $q = -K(h)\\,\\frac{dH}{dz}$, where $q$ is the specific discharge, $K(h)$ is the hydraulic conductivity as a function of pressure head $h$, $H$ is the hydraulic head, and $z$ is the vertical coordinate positive upward.\n- Water mass conservation implies that any rainfall intensity exceeding the infiltration capacity produces surface runoff instantaneously (no depression storage).\n- The Green–Ampt sharp wetting front conceptualization is admissible for event-scale infiltration modeling, assuming a distinct wetting front separates saturated and unsaturated zones, leading to a time-evolving infiltration capacity controlled by cumulative infiltration, a representative capillary suction at the front, and soil moisture deficit between saturated and initial states.\n- Soil porosity $n$ equals the saturated volumetric water content, so $\\theta_s = n$.\n- The saturated hydraulic conductivity $K_s$ is a function of porosity $n$ via a Kozeny–Carman type closure of the form $K_s = K_0 \\,\\frac{n^3}{(1-n)^2}$, where $K_0$ is a positive calibration constant that encapsulates grain size and pore geometry effects for a given soil class.\n\nStarting from the above base, derive a physically consistent infiltration capacity for the Green–Ampt framework and implement a discrete-time storm event simulation that:\n1. Advances cumulative infiltration $F(t)$ and enforces that the actual infiltration rate at each time step equals the lesser of the rainfall intensity and the infiltration capacity.\n2. Diagnoses instantaneous runoff as the excess rainfall intensity over the actual infiltration rate.\n3. Treats the sensitivity with respect to porosity $n$ by evaluating two scenarios per test case: a baseline porosity $n$ and an increased porosity $n' = 1.1\\,n$; in both scenarios, set $\\theta_s = n$ (or $\\theta_s = n'$ in the increased case), use the same initial volumetric water content $\\theta_i$, and compute $K_s$ from $K_s = K_0 \\,\\frac{n^3}{(1-n)^2}$ (or with $n'$ accordingly).\n\nYour program must:\n- Use a fixed time step $\\Delta t$ in seconds to process provided hyetographs (rainfall intensity time series).\n- Compute, for each test case and each porosity scenario, the cumulative infiltration depth and cumulative runoff depth over the event, both expressed in millimeters.\n- Compute the event-mean infiltration rate in $\\mathrm{mm/h}$ for each scenario, defined as the total infiltration depth divided by the event duration in hours.\n- Report the sensitivity for each test case as the triple $[\\Delta I, \\Delta R, \\Delta \\bar{f}]$, where $\\Delta I$ is the change in cumulative infiltration depth in millimeters (increased $n$ minus baseline), $\\Delta R$ is the change in cumulative runoff depth in millimeters (increased $n$ minus baseline), and $\\Delta \\bar{f}$ is the change in the event-mean infiltration rate in $\\mathrm{mm/h}$ (increased $n$ minus baseline). All three values must be rounded to three decimal places.\n\nPhysical units to use:\n- Rainfall intensity input is given in $\\mathrm{mm/h}$; convert internally as needed, and express cumulative infiltration and runoff in millimeters, and mean infiltration rate in $\\mathrm{mm/h}$.\n- No angles are involved in this problem.\n\nTest suite:\nFor each test case, you are given the tuple $(n,\\ \\theta_i,\\ \\psi_f,\\ K_0,\\ \\Delta t,\\ \\text{hyetograph})$, where $n$ is porosity, $\\theta_i$ is initial volumetric water content, $\\psi_f$ is the capillary suction at the wetting front (meters), $K_0$ is the Kozeny–Carman calibration constant (meters per second), $\\Delta t$ is the time step (seconds), and the hyetograph is a list of rainfall intensities (each in $\\mathrm{mm/h}$) over the event.\n\nUse the following four test cases:\n- Test case 1 (moderate loam, two-hour multi-peak storm):\n  - $n = 0.45$, $\\theta_i = 0.20$, $\\psi_f = 0.25\\ \\mathrm{m}$, $K_0 = 3.3\\times 10^{-5}\\ \\mathrm{m/s}$, $\\Delta t = 300\\ \\mathrm{s}$.\n  - Hyetograph (each entry is $\\mathrm{mm/h}$): $[0, 5, 10, 20, 40, 30, 20, 10, 5, 0, 0, 15, 25, 35, 25, 15, 10, 5, 0, 0, 0, 0, 0, 0]$.\n- Test case 2 (clayey soil, low-intensity steady storm):\n  - $n = 0.52$, $\\theta_i = 0.40$, $\\psi_f = 0.35\\ \\mathrm{m}$, $K_0 = 5\\times 10^{-6}\\ \\mathrm{m/s}$, $\\Delta t = 300\\ \\mathrm{s}$.\n  - Hyetograph: $[2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2]$.\n- Test case 3 (sandy soil, short intense burst):\n  - $n = 0.40$, $\\theta_i = 0.05$, $\\psi_f = 0.10\\ \\mathrm{m}$, $K_0 = 8\\times 10^{-5}\\ \\mathrm{m/s}$, $\\Delta t = 300\\ \\mathrm{s}$.\n  - Hyetograph: $[0, 0, 60, 80, 60, 0]$.\n- Test case 4 (near-saturated initial state, moderate-short storm):\n  - $n = 0.47$, $\\theta_i = 0.44$, $\\psi_f = 0.30\\ \\mathrm{m}$, $K_0 = 2.5\\times 10^{-5}\\ \\mathrm{m/s}$, $\\Delta t = 300\\ \\mathrm{s}$.\n  - Hyetograph: $[20, 40, 50, 40, 20]$.\n\nAlgorithmic requirements:\n- Initialize cumulative infiltration $F(0) = 0$ and update $F(t)$ explicitly using the actual infiltration rate at each step.\n- At each time step, compute the infiltration capacity from the derived Green–Ampt expression and then set the actual infiltration rate equal to the minimum of rainfall intensity and infiltration capacity.\n- Ensure numerical robustness at early times by avoiding division by zero when $F(t)$ is small.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list of per-test-case triples, enclosed in square brackets. Each triple must be of the form $[\\Delta I,\\Delta R,\\Delta \\bar{f}]$, with values rounded to three decimal places. For example, a valid output format is $[[0.123,-0.456,0.789],[...],[...],[...]]$ (do not include explanatory text).",
            "solution": "The problem is assessed to be **valid**. It is scientifically grounded in established principles of soil physics (Darcy–Buckingham law, Green–Ampt model, Kozeny–Carman relation), is well-posed with all necessary information provided for a unique numerical solution, and is stated objectively. The task is to perform a sensitivity analysis of an event-based infiltration and runoff model, which is a standard procedure in hydrology and climate modeling.\n\nWe will first derive the governing equation for infiltration capacity under the Green–Ampt assumptions and then outline the numerical algorithm for simulating the storm event and computing the required sensitivity metrics.\n\n### Derivation of the Green–Ampt Infiltration Capacity Equation\n\nThe Green–Ampt model idealizes the infiltration process by assuming a sharp wetting front of depth $L(t)$ that moves downward into the soil. Above the front, the soil is assumed to be saturated with volumetric water content $\\theta_s$, and below the front, it remains at the initial water content $\\theta_i$.\n\n1.  **Darcy's Law**: The vertical water flux $q$ is described by Darcy's law. For the saturated layer above the wetting front, the hydraulic conductivity is constant and equal to the saturated hydraulic conductivity, $K_s$. The flux, equal to the infiltration rate $f(t)$, is given by:\n    $$f(t) = -K_s \\frac{d H}{d z}$$\n    where $H$ is the hydraulic head ($H = z + h$, with $z$ as the vertical coordinate positive upward and $h$ as the pressure head) and the derivative is the hydraulic gradient across the wetted zone.\n\n2.  **Hydraulic Gradient**: We apply the law between the soil surface ($z=0$) and the wetting front ($z=-L(t)$).\n    -   At the surface, assuming ponded conditions, the water depth is negligible, so the pressure head is $h_0 = 0$. The hydraulic head is $H_0 = z_0 + h_0 = 0 + 0 = 0$.\n    -   At the wetting front, the pressure head is determined by capillary forces, represented by the negative of the suction head at the front, $h_f = -\\psi_f$. The hydraulic head is $H_f = z_f + h_f = -L - \\psi_f$.\n\n    The hydraulic gradient $\\frac{\\Delta H}{\\Delta z}$ across the wetted zone of thickness $L$ is approximated as:\n    $$\\frac{\\Delta H}{\\Delta z} = \\frac{H_0 - H_f}{z_0 - z_f} = \\frac{0 - (-L - \\psi_f)}{0 - (-L)} = \\frac{L + \\psi_f}{L} = 1 + \\frac{\\psi_f}{L}$$\n\n3.  **Infiltration Rate**: Substituting the gradient into Darcy's law, we obtain the infiltration rate as a function of the wetting front depth $L$:\n    $$f(t) = K_s \\left(1 + \\frac{\\psi_f}{L(t)}\\right)$$\n\n4.  **Mass Conservation**: The cumulative infiltration depth, $F(t)$, is the total volume of water that has entered the soil per unit surface area. This volume fills the soil pores from $\\theta_i$ to $\\theta_s$ down to the depth $L(t)$. The water balance is:\n    $$F(t) = L(t) \\cdot (\\theta_s - \\theta_i)$$\n    Letting $\\Delta\\theta = \\theta_s - \\theta_i$ be the initial soil moisture deficit, we can express the wetting front depth as $L(t) = F(t) / \\Delta\\theta$.\n\n5.  **Infiltration Capacity Equation**: Substituting the expression for $L(t)$ into the equation for $f(t)$, we arrive at the Green–Ampt infiltration capacity equation, which defines the maximum possible infiltration rate, $f_c(t)$, as a function of cumulative infiltration $F(t)$:\n    $$f_c(t) = K_s \\left(1 + \\frac{\\psi_f \\Delta\\theta}{F(t)}\\right)$$\n\n### Numerical Simulation Algorithm\n\nThe problem requires a discrete-time simulation. We will use an explicit time-stepping scheme. Let the index $k$ denote the $k$-th time step.\n\n1.  **Initialization**:\n    -   The simulation starts at time $t=0$ with cumulative infiltration $F_0 = 0$ and cumulative runoff $R_0 = 0$.\n    -   The time step is a fixed value $\\Delta t$.\n    -   The hyetograph provides a sequence of rainfall intensities, $r_k$, for each time step.\n\n2.  **Parameter Calculation**: For each scenario (baseline and increased porosity):\n    -   The porosity is $n_{scen}$ (either the base $n$ or the perturbed $n' = 1.1n$).\n    -   Saturated water content is $\\theta_s = n_{scen}$.\n    -   The initial soil moisture deficit is $\\Delta\\theta = \\theta_s - \\theta_i$.\n    -   The saturated hydraulic conductivity $K_s$ is calculated using the Kozeny–Carman relation:\n        $$K_s = K_0 \\frac{n_{scen}^3}{(1-n_{scen})^2}$$\n\n3.  **Time-Stepping Loop**: For each step $k$ from $1$ to $N_{steps}$:\n    -   Let $F_{k-1}$ be the cumulative infiltration from the previous step.\n    -   Calculate the infiltration capacity at the beginning of the step:\n        $$f_{c,k} = K_s \\left(1 + \\frac{\\psi_f \\Delta\\theta}{F_{k-1}}\\right)$$\n        For numerical stability when $F_{k-1}$ is zero or very small, we replace $F_{k-1}$ with $\\max(F_{k-1}, \\epsilon)$, where $\\epsilon$ is a small positive value (e.g., $10^{-9}$ m). This prevents division by zero and reflects the physically very high initial infiltration capacity.\n    -   The actual infiltration rate, $f_{a,k}$, is the lesser of the supply (rainfall rate $r_k$) and the capacity ($f_{c,k}$):\n        $$f_{a,k} = \\min(r_k, f_{c,k})$$\n    -   The amount of water infiltrated during the step is $\\Delta F_k = f_{a,k} \\Delta t$.\n    -   Update the cumulative infiltration: $F_k = F_{k-1} + \\Delta F_k$.\n    -   The runoff rate is the excess rainfall: $q_{R,k} = r_k - f_{a,k}$.\n    -   The amount of runoff generated during the step is $\\Delta R_k = q_{R,k} \\Delta t$.\n    -   Update the cumulative runoff: $R_k = R_{k-1} + \\Delta R_k$.\n\n4.  **Unit Conversion**: All physical parameters ($K_0, \\psi_f, \\Delta t$) and internal calculations ($F, R, f_c, f_a, K_s, r$) must be in a consistent set of units, specifically meters and seconds. The input rainfall intensities are in $\\mathrm{mm/h}$ and must be converted to $\\mathrm{m/s}$ using the factor $1 \\ \\mathrm{mm/h} = \\frac{10^{-3} \\ \\mathrm{m}}{3600 \\ \\mathrm{s}}$. Final cumulative depths are converted from meters to millimeters, and the mean infiltration rate is calculated in $\\mathrm{mm/h}$.\n\n### Sensitivity Analysis\n\nThe simulation is performed for two scenarios for each test case: a baseline scenario with porosity $n$ and an increased porosity scenario with $n' = 1.1n$.\n\n-   Let $(I_{base}, R_{base}, \\bar{f}_{base})$ be the cumulative infiltration (mm), cumulative runoff (mm), and event-mean infiltration rate (mm/h) for the baseline scenario.\n-   Let $(I_{inc}, R_{inc}, \\bar{f}_{inc})$ be the same metrics for the increased porosity scenario.\n\nThe sensitivity metrics are the differences between the two scenarios:\n-   Change in cumulative infiltration: $\\Delta I = I_{inc} - I_{base}$\n-   Change in cumulative runoff: $\\Delta R = R_{inc} - R_{base}$\n-   Change in event-mean infiltration rate: $\\Delta \\bar{f} = \\bar{f}_{inc} - \\bar{f}_{base}$\n\nAn increase in porosity $n$ increases both the available pore space for water storage ($\\Delta\\theta = n - \\theta_i$) and the saturated hydraulic conductivity ($K_s$). Both effects enhance the soil's infiltration capacity. Therefore, we expect $\\Delta I \\ge 0$, $\\Delta R \\le 0$, and $\\Delta \\bar{f} \\ge 0$. The equality holds if the rainfall rate is always below the infiltration capacity in both scenarios, leading to no change in partitioning between infiltration and runoff.",
            "answer": "```python\nimport numpy as np\n\ndef run_simulation(n, theta_i, psi_f, k0, dt, hyetograph):\n    \"\"\"\n    Runs an event-based infiltration simulation using the Green-Ampt model.\n\n    Args:\n        n (float): Porosity (dimensionless).\n        theta_i (float): Initial volumetric water content (dimensionless).\n        psi_f (float): Capillary suction at the wetting front (m).\n        k0 (float): Kozeny–Carman calibration constant (m/s).\n        dt (int): Time step (s).\n        hyetograph (list): List of rainfall intensities (mm/h).\n\n    Returns:\n        tuple: A tuple containing:\n            - Cumulative infiltration (mm).\n            - Cumulative runoff (mm).\n            - Event-mean infiltration rate (mm/h).\n    \"\"\"\n    # Physical validity checks\n    if n >= 1.0:\n        # A 10% increase might push n >= 1, so handle this gracefully.\n        # For the given test cases, this is not an issue.\n        raise ValueError(f\"Porosity n={n} must be less than 1.\")\n    if theta_i >= n:\n        raise ValueError(f\"Initial water content theta_i={theta_i} must be less than porosity n={n}.\")\n\n    # Unit conversion constants\n    MMH_TO_MS = 1e-3 / 3600.0\n    M_TO_MM = 1000.0\n\n    # Soil hydrologic parameters\n    theta_s = n\n    delta_theta = theta_s - theta_i\n    if (1 - n) == 0:\n        # Avoid division by zero for the theoretical case of n=1\n        ks = float('inf')\n    else:\n        ks = k0 * (n**3) / ((1 - n)**2)\n\n    # Convert hyetograph from mm/h to m/s\n    rain_ms = np.array(hyetograph, dtype=float) * MMH_TO_MS\n\n    # Simulation state variables\n    F_m = 0.0  # Cumulative infiltration in meters\n    R_m = 0.0  # Cumulative runoff in meters\n    \n    # Numerical stability parameter for F=0 case\n    epsilon_F = 1e-9  # meters\n\n    # Time-stepping simulation\n    for r_ms in rain_ms:\n        # Calculate infiltration capacity (m/s) using F from the start of the timestep\n        fc_ms = ks * (1 + (psi_f * delta_theta) / max(F_m, epsilon_F))\n        \n        # Determine actual infiltration rate (m/s)\n        fa_ms = min(r_ms, fc_ms)\n        \n        # Calculate incremental infiltration and runoff depths (m) for the timestep\n        infil_step_m = fa_ms * dt\n        runoff_step_m = (r_ms - fa_ms) * dt\n        \n        # Update cumulative totals\n        F_m += infil_step_m\n        R_m += runoff_step_m\n        \n    # Calculate final summary metrics\n    event_duration_s = len(hyetograph) * dt\n    event_duration_h = event_duration_s / 3600.0\n    \n    F_mm = F_m * M_TO_MM\n    R_mm = R_m * M_TO_MM\n    \n    # Calculate event-mean infiltration rate (mm/h)\n    if event_duration_h > 0:\n        f_mean_mmh = F_mm / event_duration_h\n    else:\n        f_mean_mmh = 0.0\n        \n    return F_mm, R_mm, f_mean_mmh\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    test_cases = [\n        # Test case 1\n        (0.45, 0.20, 0.25, 3.3e-5, 300, [0, 5, 10, 20, 40, 30, 20, 10, 5, 0, 0, 15, 25, 35, 25, 15, 10, 5, 0, 0, 0, 0, 0, 0]),\n        # Test case 2\n        (0.52, 0.40, 0.35, 5.0e-6, 300, [2]*24),\n        # Test case 3\n        (0.40, 0.05, 0.10, 8.0e-5, 300, [0, 0, 60, 80, 60, 0]),\n        # Test case 4\n        (0.47, 0.44, 0.30, 2.5e-5, 300, [20, 40, 50, 40, 20]),\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        n, theta_i, psi_f, k0, dt, hyetograph = case\n\n        # Run baseline scenario\n        I_base, R_base, f_bar_base = run_simulation(n, theta_i, psi_f, k0, dt, hyetograph)\n        \n        # Run increased porosity scenario\n        n_prime = 1.1 * n\n        I_inc, R_inc, f_bar_inc = run_simulation(n_prime, theta_i, psi_f, k0, dt, hyetograph)\n\n        # Calculate sensitivity metrics\n        delta_I = I_inc - I_base\n        delta_R = R_inc - R_base\n        delta_f_bar = f_bar_inc - f_bar_base\n\n        # Append rounded results\n        all_results.append([round(delta_I, 3), round(delta_R, 3), round(delta_f_bar, 3)])\n        \n    # Format the final output string as a list of lists with no spaces\n    print(str(all_results).replace(\" \", \"\"))\n\nsolve()\n\n```"
        }
    ]
}