{
    "hands_on_practices": [
        {
            "introduction": "地表能量平衡是控制陆地-大气相互作用的基本方程。本练习要求您应用能量守恒定律来确定地表热通量$G$，这是分配可用能量的关键组成部分。通过分析一个真实的正午情景，您将锻炼一项核心诊断技能，并加深对土壤在日循环中如何储存和释放能量的物理理解。",
            "id": "4090110",
            "problem": "在数值天气预报（NWP）的陆面方案中，一个单一的陆面网格单元在当地正午附近的晴空条件下被观测，平均时段为 $30$ 分钟，无积雪且生物质热储量可忽略不计。使用微气象学符号约定，其中净辐射 $R_n$ 定义为向下为正，感热通量 $H$ 和潜热通量 $LE$ 定义为向上为正，地表（土壤）传导热通量 $G$ 定义为在地表处向下为正。在此平均时段内，测量得出 $R_n=500\\ \\mathrm{W\\,m^{-2}}$，$H=150\\ \\mathrm{W\\,m^{-2}}$，以及 $LE=280\\ \\mathrm{W\\,m^{-2}}$。假设在此期间，地表薄层和冠层空气空间中的短期热储量可忽略不计。\n\n仅使用代表性地表控制体的能量守恒定律以及湍流通量和传导通量的基本定义，计算地热通量 $G$。以 $\\mathrm{W\\,m^{-2}}$ 为单位表示您的最终结果。提供精确值，无需四舍五入。然后，基于热传导的第一性原理和地表日强迫，讨论在日循环中 $G$ 为正与为负的物理意义，并将 $G$ 的符号与土壤垂直温度梯度和热惯性联系起来。您的讨论不应依赖经验记忆，而应基于基本的平衡论证和傅里叶定律。",
            "solution": "首先评估问题的有效性。\n\n**步骤1：提取已知条件**\n- 数值天气预报（NWP）陆面方案中的陆面网格单元。\n- 平均时段：当地正午附近的 $30$ 分钟。\n- 条件：晴空，无积雪，生物质热储量可忽略不计。\n- 微气象学符号约定：\n    - 净辐射 $R_n$：向下为正。\n    - 感热通量 $H$：向上为正。\n    - 潜热通量 $LE$：向上为正。\n    - 地表（土壤）传导热通量 $G$：在地表处向下为正。\n- 测量数据：\n    - $R_n = 500\\ \\mathrm{W\\,m^{-2}}$\n    - $H = 150\\ \\mathrm{W\\,m^{-2}}$\n    - $LE = 280\\ \\mathrm{W\\,m^{-2}}$\n- 假设：地表薄层和冠层空气空间中的短期热储量可忽略不计。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据，因为它基于应用于地球表面的能量守恒基本原理，这是微气象学和气候科学的核心概念。为通量提供的数值对于陆地上正午、晴空条件是物理上现实的。该问题是适定的；它提供了使用地表能量平衡方程确定唯一未知变量 $G$ 所需的所有必要信息。符号约定明确清晰，避免了歧义。该问题是客观的，没有任何推测性或非科学性的主张。满足了有效问题的所有标准。\n\n**步骤3：结论与行动**\n问题有效。将提供解答。\n\n问题的第一部分要求计算地热通量 $G$。这由陆-气界面处控制体的能量守恒原理决定。假设地表薄层和冠层空气中的热储量可忽略不计，地表能量平衡方程指出，净辐射能量输入必须与向大气的感热和潜热的湍流通量之和以及传入地下的传导热通量相平衡。\n\n地表能量平衡方程为：\n$$R_n = H + LE + G$$\n在这里，每一项都代表一个通量密度，单位为 $\\mathrm{W\\,m^{-2}}$。问题明确定义了符号约定：$R_n$ 向下为正（地表的能量增益），而 $H$ 和 $LE$ 向上为正（地表的能量损失）。地热通量 $G$ 被定义为向下为正（从地表进入土壤的能量损失）。所写的方程与此符号约定一致，其中源项（$R_n$）等于汇项（$H$、$LE$ 和 $G$）之和。\n\n为了计算地热通量 $G$，我们重新排列能量平衡方程：\n$$G = R_n - H - LE$$\n\n代入给定的数值：\n$$R_n = 500\\ \\mathrm{W\\,m^{-2}}$$\n$$H = 150\\ \\mathrm{W\\,m^{-2}}$$\n$$LE = 280\\ \\mathrm{W\\,m^{-2}}$$\n\n我们计算 $G$：\n$$G = 500 - 150 - 280$$\n$$G = 500 - 430$$\n$$G = 70\\ \\mathrm{W\\,m^{-2}}$$\n计算得到的地热通量为 $70\\ \\mathrm{W\\,m^{-2}}$。\n\n问题的第二部分要求基于第一性原理讨论 $G$ 符号的物理意义。介质中的传导热通量由傅里叶热传导定律描述。我们定义一个垂直坐标 $z$，其在地表处为零，并向土壤深处为正。在此坐标系中，垂直热通量 $G$ 的傅里叶定律为：\n$$G = -k_s \\frac{\\partial T_s}{\\partial z}$$\n其中 $k_s$ 是土壤热导率（一个正定属性，$k_s > 0$），而 $\\frac{\\partial T_s}{\\partial z}$ 是土壤温度 $T_s$ 的垂直梯度。\n\n$G$ 的符号因此由垂直温度梯度 $-\\frac{\\partial T_s}{\\partial z}$ 的符号决定。\n- **正地热通量 ($G > 0$)：** 我们的计算得出 $G = 70\\ \\mathrm{W\\,m^{-2}}$，为正值。根据傅里叶定律，正的 $G$ 要求 $-k_s \\frac{\\partial T_s}{\\partial z} > 0$。由于 $k_s > 0$，这意味着 $\\frac{\\partial T_s}{\\partial z} < 0$。在我们的坐标系（$z$ 向下为正）中，负的温度梯度意味着土壤温度随深度增加而降低。这种情况发生在白天，特别是像问题中指出的当地正午前后，此时太阳辐射将地表加热到比其下方土壤层更高的温度。$G$ 的正号表示向下的热通量，将能量从温暖的地表转移到较冷的次表层土壤中，代表了能量在地下储存。\n\n- **负地热通量 ($G < 0$)：** 相反，一个负的 $G$ 值将意味着热量从土壤向地表的向上传输。这种情况发生在当表层比其下方的土壤更冷时。根据傅里叶定律，对于 $G < 0$，我们必须有 $\\frac{\\partial T_s}{\\partial z} > 0$（因为 $-k_s$ 是负的）。一个正的温度梯度（$z$ 向下为正）意味着温度随深度增加而增加。这通常发生在夜间，当地表通过发射长波辐射比下方的隔热土壤更快地冷却时。负的 $G$ 代表了白天储存在土壤中的热量的释放。\n\n- **与热惯性的关系：** $G$ 的大小与土壤的热惯性 $I$ 有关，热惯性是衡量其抵抗温度变化能力的指标。热惯性定义为 $I = \\sqrt{k_s C}$，其中 $k_s$ 是土壤热导率，$C$ 是土壤的体积热容。\n    - 具有**高热惯性**的土壤（例如，湿润、密实的土壤）可以在地表温度变化很小的情况下吸收和释放大量热量。这种土壤在其 $G$ 的日循环中会表现出大的振幅——白天有大的正 $G$ 值，夜晚有大数值的负 $G$ 值。这种进出地下的高效热传递会减弱地表温度的日变化范围。\n    - 具有**低热惯性**的土壤（例如，干燥、松散的沙子）导热性差和/或热容量低。它不能有效地将热量从地表传导走。因此，在给定的辐射强迫下，地表温度在白天会急剧上升，但地热通量 $G$ 会相对较小。在夜间，可释放的储存热量较少，因此负 $G$ 的数值也较小，地表会急剧冷却。这导致地表温度的日变化范围很大。\n\n总而言之，计算出的 $G$ 的正值与正午条件在物理上是一致的，表明热流进入土壤是由比次表层更暖的地表驱动的。该通量相对于净辐射的大小，受到土壤热惯性的调节。",
            "answer": "$$\n\\boxed{70}\n$$"
        },
        {
            "introduction": "降雨如何在入渗和径流之间进行分配，是水文学和气候模拟中的一个关键问题。本练习将引导您使用经典的 Green-Ampt 模型推导积水时间，该模型将复杂的入渗物理过程简化为一个易于处理的框架。通过这个练习，您将增强把达西定律等基本法则转化为关键地表过程预测方程的能力。",
            "id": "4090084",
            "problem": "在数值天气预报（NWP）和气候模型中使用的陆面方案中，入渗和径流的划分取决于地表积水相对于降雨开始的时间。考虑一个均质、深厚的土壤柱，从时间 $t=0$ 开始受到恒定降雨率 $P$ 的作用，并使用 Green–Ampt 入渗框架进行建模。假设满足以下标准的 Green–Ampt 条件：一个清晰的湿润锋，均匀的初始体积含水量，降雨开始后湿润锋上方立即饱和的土层，积水前可忽略的地表蓄水量，以及在湿润锋处恒定的毛细管吸力水头。设饱和导水率为 $K_{s}$，湿润锋上的有效毛细管吸力水头为 $\\Delta \\psi$，湿润锋上的含水量跃变为 $\\Delta \\theta$。\n\n从 Darcy–Buckingham 定律和质量守恒出发，推导在恒定降雨 $P$ 下，积水时间 $t_{p}$ 关于 $K_{s}$、$\\Delta \\psi$、$\\Delta \\theta$ 和 $P$ 的解析表达式。然后，给定 $K_{s} = 1.0 \\times 10^{-5} \\ \\mathrm{m} \\ \\mathrm{s}^{-1}$，$\\Delta \\psi = 0.25 \\ \\mathrm{m}$，$\\Delta \\theta = 0.20$ 和 $P = 5.0 \\times 10^{-5} \\ \\mathrm{m} \\ \\mathrm{s}^{-1}$，计算 $t_{p}$ 并将最终时间以分钟表示。将答案四舍五入到 $4$ 位有效数字。",
            "solution": "目标是在 Green–Ampt 框架内，确定当恒定速率 $P$ 的降雨首次超过土壤表面的入渗能力时，地表开始积水的时间 $t_{p}$。我们从适用于土壤入渗的基本原理开始。\n\n在 Green–Ampt 假设下，入渗过程伴随着一个位于深度 $z_{f}(t)$ 的清晰湿润锋，锋面以上土壤饱和，体积含水量为 $\\theta_{s}$，锋面以下土壤保持其初始体积含水量 $\\theta_{i}$。湿润锋上的含水量跃变为 $\\Delta \\theta = \\theta_{s} - \\theta_{i}$。从 $t=0$ 到时间 $t$ 的累积入渗量 $F(t)$ 满足\n$$\nF(t) = \\Delta \\theta \\, z_{f}(t),\n$$\n因为清晰的锋面使深度 $z_{f}$ 内的含水量增加了 $\\Delta \\theta$。\n\n用于垂直流动的 Darcy–Buckingham 定律指出，通量 $q$ 为\n$$\nq = - K(\\theta) \\, \\frac{\\partial H}{\\partial z},\n$$\n其中 $H = \\psi + z$ 是水力水头，$\\psi$ 是压力水头，而 $z$ 是重力水头（向下为正）。在 Green–Ampt 近似中，通过湿润锋上方饱和层的水流可以采用导水率 $K_{s}$，从土壤表面（参考水头）到湿润锋的水力水头降包括 $z_{f}$ 的重力水头降和锋面处 $\\Delta \\psi$ 的毛细管吸力水头。因此，在距离 $z_{f}$ 上，水力梯度为\n$$\n\\frac{\\Delta H}{z_{f}} = \\frac{z_{f} + \\Delta \\psi}{z_{f}} = 1 + \\frac{\\Delta \\psi}{z_{f}}.\n$$\n因此，入渗能力（由地下支撑的表面最大可能入渗通量）为\n$$\nf_{c} = K_{s} \\left( 1 + \\frac{\\Delta \\psi}{z_{f}} \\right).\n$$\n使用关系式 $z_{f} = F / \\Delta \\theta$，我们得到了广泛使用的、作为累积入渗量函数的 Green–Ampt 入渗能力：\n$$\nf_{c}(F) = K_{s} \\left( 1 + \\frac{\\Delta \\psi \\, \\Delta \\theta}{F} \\right).\n$$\n\n在积水之前，实际入渗速率等于降雨速率，因此\n$$\nf(t) = P \\quad \\text{and} \\quad F(t) = \\int_{0}^{t} f(\\tau) \\, d\\tau = P t.\n$$\n当降雨速率 $P$ 等于在相应累积入渗量 $F_{p} = F(t_{p})$ 下计算的入渗能力 $f_{c}(F)$ 时，首次发生积水，该时间为 $t_{p}$。因此，\n$$\nP = K_{s} \\left( 1 + \\frac{\\Delta \\psi \\, \\Delta \\theta}{F_{p}} \\right).\n$$\n求解 $F_{p}$，\n$$\n\\frac{\\Delta \\psi \\, \\Delta \\theta}{F_{p}} = \\frac{P}{K_{s}} - 1 \\quad \\Rightarrow \\quad F_{p} = \\frac{\\Delta \\psi \\, \\Delta \\theta}{\\frac{P}{K_{s}} - 1} = \\frac{\\Delta \\psi \\, \\Delta \\theta \\, K_{s}}{P - K_{s}}.\n$$\n由于在积水前阶段 $F_{p} = P t_{p}$，\n$$\nt_{p} = \\frac{F_{p}}{P} = \\frac{\\Delta \\psi \\, \\Delta \\theta \\, K_{s}}{P \\, (P - K_{s})}.\n$$\n该表达式仅在 $P > K_{s}$ 时具有物理意义，否则入渗能力永远不会低于降雨速率，也就不会发生积水。\n\n现在根据给定参数计算 $t_{p}$：\n- $K_{s} = 1.0 \\times 10^{-5} \\ \\mathrm{m} \\ \\mathrm{s}^{-1}$，\n- $\\Delta \\psi = 0.25 \\ \\mathrm{m}$，\n- $\\Delta \\theta = 0.20$，\n- $P = 5.0 \\times 10^{-5} \\ \\mathrm{m} \\ \\mathrm{s}^{-1}$。\n\n计算分子：\n$$\n\\Delta \\psi \\, \\Delta \\theta \\, K_{s} = (0.25) \\times (0.20) \\times \\left(1.0 \\times 10^{-5}\\right) = 5.0 \\times 10^{-7}.\n$$\n计算分母：\n$$\nP \\, (P - K_{s}) = \\left(5.0 \\times 10^{-5}\\right) \\times \\left(5.0 \\times 10^{-5} - 1.0 \\times 10^{-5}\\right) = \\left(5.0 \\times 10^{-5}\\right) \\times \\left(4.0 \\times 10^{-5}\\right) = 2.0 \\times 10^{-9}.\n$$\n因此，\n$$\nt_{p} = \\frac{5.0 \\times 10^{-7}}{2.0 \\times 10^{-9}} = 2.5 \\times 10^{2} \\ \\mathrm{s} = 250 \\ \\mathrm{s}.\n$$\n将秒转换为分钟：\n$$\nt_{p,\\ \\mathrm{min}} = \\frac{250}{60} = 4.166\\overline{6} \\ \\mathrm{min}.\n$$\n四舍五入到 $4$ 位有效数字并以分钟表示，\n$$\nt_{p,\\ \\mathrm{min}} = 4.167.\n$$",
            "answer": "$$\\boxed{4.167}$$"
        },
        {
            "introduction": "现代陆面过程建模本质上是计算性的。本练习将 Green-Ampt 入渗理论付诸实践，通过数值模拟和敏感性分析来进行探索。通过编写程序来探究土壤孔隙度的变化如何影响入渗和径流，您将获得关于参数不确定性如何影响模型预测的实践经验，而这是数值天气预报和气候科学中的一个核心主题。",
            "id": "4090098",
            "problem": "您将使用一个基于物理的框架，用于模拟风暴事件期间的一维垂直入渗和地表径流，该框架与数值天气预报（NWP）和气候模型的陆面方案相一致。本练习围绕土壤热力和水文参数化展开，重点关注入渗能力和径流生成对某一关键土壤参数变化的敏感性。目标是进行一项敏感性分析，展示单一土壤参数增加 $10\\%$ 如何影响入渗率和径流生成，并解释其物理机制。\n\n使用以下基本和建模假设：\n- Darcy–Buckingham 定律描述了非饱和介质中的垂直水通量，其表达式为 $q = -K(h)\\,\\frac{dH}{dz}$，其中 $q$ 是比流量， $K(h)$ 是作为压力水头 $h$ 函数的水力传导度， $H$ 是水力总水头， $z$ 是向上为正的垂直坐标。\n- 水质量守恒意味着任何超过入渗能力的降雨强度都会瞬时产生地表径流（无洼地蓄水）。\n- Green–Ampt 尖锐湿润锋概念化模型适用于事件尺度的入渗模拟，该模型假设一个清晰的湿润锋将饱和区与非饱和区分开，从而导致一个随时间演变的入渗能力，该能力由累积入渗量、锋面处的代表性毛细吸力以及饱和与初始状态之间的土壤水分亏缺共同控制。\n- 土壤孔隙度 $n$ 等于饱和体积含水量，因此 $\\theta_s = n$。\n- 饱和水力传导度 $K_s$ 是孔隙度 $n$ 的函数，通过 Kozeny–Carman 类型的闭合关系式 $K_s = K_0 \\,\\frac{n^3}{(1-n)^2}$ 给出，其中 $K_0$ 是一个正的校准常数，它概括了给定土壤类别下的颗粒大小和孔隙几何效应。\n\n基于以上基础，为 Green–Ampt 框架推导一个物理上一致的入渗能力，并实现一个离散时间的风暴事件模拟，该模拟需要：\n1. 推进累积入渗量 $F(t)$，并确保每个时间步的实际入渗率等于降雨强度和入渗能力中的较小者。\n2. 将瞬时径流诊断为超过实际入渗率的过量降雨强度。\n3. 通过评估每个测试用例的两种情景来处理对孔隙度 $n$ 的敏感性：一个基准孔隙度 $n$ 和一个增加后的孔隙度 $n' = 1.1\\,n$；在两种情景中，都设置 $\\theta_s = n$（在增加孔隙度的情景中为 $\\theta_s = n'$），使用相同的初始体积含水量 $\\theta_i$，并根据 $K_s = K_0 \\,\\frac{n^3}{(1-n)^2}$ 计算 $K_s$（或相应地使用 $n'$）。\n\n您的程序必须：\n- 使用固定的时间步长 $\\Delta t$（秒）来处理所提供的降雨过程线（降雨强度时间序列）。\n- 为每个测试用例和每种孔隙度情景，计算事件期间的累积入渗深度和累积径流深度，两者均以毫米表示。\n- 为每种情景计算事件平均入渗率（单位 $\\mathrm{mm/h}$），定义为总入渗深度除以事件持续时间（小时）。\n- 将每个测试用例的敏感性报告为三元组 $[\\Delta I, \\Delta R, \\Delta \\bar{f}]$，其中 $\\Delta I$ 是累积入渗深度的变化量（毫米，增加 $n$ 的情景减去基准情景），$\\Delta R$ 是累积径流深度的变化量（毫米，增加 $n$ 的情景减去基准情景），$\\Delta \\bar{f}$ 是事件平均入渗率的变化量（$\\mathrm{mm/h}$，增加 $n$ 的情景减去基准情景）。所有三个值都必须四舍五入到三位小数。\n\n使用的物理单位：\n- 输入的降雨强度以 $\\mathrm{mm/h}$ 为单位；在内部根据需要进行转换，并用毫米表示累积入渗和径流，用 $\\mathrm{mm/h}$ 表示平均入渗率。\n- 此问题不涉及角度。\n\n测试套件：\n对于每个测试用例，您将获得一个元组 $(n,\\ \\theta_i,\\ \\psi_f,\\ K_0,\\ \\Delta t,\\ \\text{hyetograph})$，其中 $n$ 是孔隙度，$\\theta_i$ 是初始体积含水量，$\\psi_f$ 是湿润锋处的毛细吸力（米），$K_0$ 是 Kozeny–Carman 校准常数（米/秒），$\\Delta t$ 是时间步长（秒），hyetograph 是事件期间的降雨强度列表（每个单位为 $\\mathrm{mm/h}$）。\n\n使用以下四个测试用例：\n- 测试用例 1（中等壤土，两小时多峰风暴）：\n  - $n = 0.45$, $\\theta_i = 0.20$, $\\psi_f = 0.25\\ \\mathrm{m}$, $K_0 = 3.3\\times 10^{-5}\\ \\mathrm{m/s}$, $\\Delta t = 300\\ \\mathrm{s}$。\n  - 降雨过程线（每个条目单位为 $\\mathrm{mm/h}$）： $[0, 5, 10, 20, 40, 30, 20, 10, 5, 0, 0, 15, 25, 35, 25, 15, 10, 5, 0, 0, 0, 0, 0, 0]$。\n- 测试用例 2（粘性土壤，低强度稳定风暴）：\n  - $n = 0.52$, $\\theta_i = 0.40$, $\\psi_f = 0.35\\ \\mathrm{m}$, $K_0 = 5\\times 10^{-6}\\ \\mathrm{m/s}$, $\\Delta t = 300\\ \\mathrm{s}$。\n  - 降雨过程线： $[2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2]$。\n- 测试用例 3（沙质土壤，短暂强降雨）：\n  - $n = 0.40$, $\\theta_i = 0.05$, $\\psi_f = 0.10\\ \\mathrm{m}$, $K_0 = 8\\times 10^{-5}\\ \\mathrm{m/s}$, $\\Delta t = 300\\ \\mathrm{s}$。\n  - 降雨过程线： $[0, 0, 60, 80, 60, 0]$。\n- 测试用例 4（接近饱和的初始状态，中等时长的短风暴）：\n  - $n = 0.47$, $\\theta_i = 0.44$, $\\psi_f = 0.30\\ \\mathrm{m}$, $K_0 = 2.5\\times 10^{-5}\\ \\mathrm{m/s}$, $\\Delta t = 300\\ \\mathrm{s}$。\n  - 降雨过程线： $[20, 40, 50, 40, 20]$。\n\n算法要求：\n- 初始化累积入渗量 $F(0) = 0$，并在每一步使用实际入渗率显式更新 $F(t)$。\n- 在每个时间步，根据推导出的 Green–Ampt 表达式计算入渗能力，然后将实际入渗率设置为降雨强度和入渗能力中的最小值。\n- 在早期通过避免当 $F(t)$ 很小时的除零操作来确保数值稳健性。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个逗号分隔的各测试用例三元组列表，并用方括号括起来。每个三元组的形式必须为 $[\\Delta I,\\Delta R,\\Delta \\bar{f}]$，其值四舍五入到三位小数。例如，一个有效的输出格式是 $[[0.123,-0.456,0.789],[...],[...],[...]]$（不包含任何解释性文本）。",
            "solution": "该问题被评估为**有效**。它在科学上基于土壤物理学的既定原理（Darcy–Buckingham 定律、Green–Ampt 模型、Kozeny–Carman 关系式），问题陈述清晰，为获得唯一的数值解提供了所有必要信息，并且表述客观。任务是为一个基于事件的入渗和径流模型执行敏感性分析，这是水文学和气候建模中的标准程序。\n\n我们将首先在 Green–Ampt 假设下推导渗入能力的控制方程，然后概述用于模拟风暴事件和计算所需敏感性指标的数值算法。\n\n### Green–Ampt 入渗能力方程的推导\n\nGreen–Ampt 模型通过假设一个深度为 $L(t)$ 的尖锐湿润锋向下移动到土壤中来理想化入渗过程。在锋面以上，土壤被假定为饱和状态，其体积含水量为 $\\theta_s$；在锋面以下，土壤保持其初始含水量 $\\theta_i$。\n\n1.  **Darcy 定律**：垂直水通量 $q$ 由 Darcy 定律描述。对于湿润锋上方的饱和层，水力传导度是恒定的，等于饱和水力传导度 $K_s$。等于入渗率 $f(t)$ 的通量由下式给出：\n    $$f(t) = -K_s \\frac{d H}{d z}$$\n    其中 $H$ 是水力总水头（$H = z + h$，其中 $z$ 是向上为正的垂直坐标， $h$ 是压力水头），导数是贯穿湿润区的水力梯度。\n\n2.  **水力梯度**：我们在土壤表面（$z=0$）和湿润锋（$z=-L(t)$）之间应用该定律。\n    -   在地表，假设有积水条件，水深可忽略不计，因此压力水头为 $h_0 = 0$。水力总水头为 $H_0 = z_0 + h_0 = 0 + 0 = 0$。\n    -   在湿润锋处，压力水头由毛细作用力决定，表示为锋面处吸力水头的负值，即 $h_f = -\\psi_f$。水力总水头为 $H_f = z_f + h_f = -L - \\psi_f$。\n\n    贯穿厚度为 $L$ 的湿润区的水力梯度 $\\frac{\\Delta H}{\\Delta z}$ 近似为：\n    $$\\frac{\\Delta H}{\\Delta z} = \\frac{H_0 - H_f}{z_0 - z_f} = \\frac{0 - (-L - \\psi_f)}{0 - (-L)} = \\frac{L + \\psi_f}{L} = 1 + \\frac{\\psi_f}{L}$$\n\n3.  **入渗率**：将梯度代入 Darcy 定律，我们得到作为湿润锋深度 $L$ 函数的入渗率：\n    $$f(t) = K_s \\left(1 + \\frac{\\psi_f}{L(t)}\\right)$$\n\n4.  **质量守恒**：累积入渗深度 $F(t)$ 是单位地表面积进入土壤的总水量。这个水量填充了从 $\\theta_i$ 到 $\\theta_s$ 直至深度 $L(t)$ 的土壤孔隙。水量平衡关系为：\n    $$F(t) = L(t) \\cdot (\\theta_s - \\theta_i)$$\n    令 $\\Delta\\theta = \\theta_s - \\theta_i$ 为初始土壤水分亏缺，我们可以将湿润锋深度表示为 $L(t) = F(t) / \\Delta\\theta$。\n\n5.  **入渗能力方程**：将 $L(t)$ 的表达式代入 $f(t)$ 的方程中，我们得到 Green–Ampt 入渗能力方程，它将最大可能入渗率 $f_c(t)$ 定义为累积入渗量 $F(t)$ 的函数：\n    $$f_c(t) = K_s \\left(1 + \\frac{\\psi_f \\Delta\\theta}{F(t)}\\right)$$\n\n### 数值模拟算法\n\n问题要求进行离散时间模拟。我们将使用显式时间步进方案。设索引 $k$ 表示第 $k$ 个时间步。\n\n1.  **初始化**：\n    -   模拟在时间 $t=0$ 开始，初始累积入渗量 $F_0 = 0$，初始累积径流量 $R_0 = 0$。\n    -   时间步长为固定值 $\\Delta t$。\n    -   降雨过程线为每个时间步提供一系列降雨强度 $r_k$。\n\n2.  **参数计算**：对于每种情景（基准情景和孔隙度增加的情景）：\n    -   孔隙度为 $n_{scen}$（基准孔隙度 $n$ 或扰动后的孔隙度 $n' = 1.1n$）。\n    -   饱和含水量为 $\\theta_s = n_{scen}$。\n    -   初始土壤水分亏缺为 $\\Delta\\theta = \\theta_s - \\theta_i$。\n    -   饱和水力传导度 $K_s$ 使用 Kozeny–Carman 关系式计算：\n        $$K_s = K_0 \\frac{n_{scen}^3}{(1-n_{scen})^2}$$\n\n3.  **时间步进循环**：对于从 $1$ 到 $N_{steps}$ 的每一步 $k$：\n    -   设 $F_{k-1}$ 为上一步的累积入渗量。\n    -   计算该时间步开始时的入渗能力：\n        $$f_{c,k} = K_s \\left(1 + \\frac{\\psi_f \\Delta\\theta}{F_{k-1}}\\right)$$\n        为了在 $F_{k-1}$ 为零或非常小时保持数值稳定性，我们将 $F_{k-1}$ 替换为 $\\max(F_{k-1}, \\epsilon)$，其中 $\\epsilon$ 是一个很小的正值（例如 $10^{-9}$ 米）。这可以防止除以零，并反映物理上非常高的初始入渗能力。\n    -   实际入渗率 $f_{a,k}$ 是供应量（降雨率 $r_k$）和能力（$f_{c,k}$）中的较小者：\n        $$f_{a,k} = \\min(r_k, f_{c,k})$$\n    -   该时间步内入渗的水量为 $\\Delta F_k = f_{a,k} \\Delta t$。\n    -   更新累积入渗量：$F_k = F_{k-1} + \\Delta F_k$。\n    -   径流率为超渗雨量：$q_{R,k} = r_k - f_{a,k}$。\n    -   该时间步内产生的径流量为 $\\Delta R_k = q_{R,k} \\Delta t$。\n    -   更新累积径流量：$R_k = R_{k-1} + \\Delta R_k$。\n\n4.  **单位转换**：所有物理参数（$K_0, \\psi_f, \\Delta t$）和内部计算（$F, R, f_c, f_a, K_s, r$）必须使用一套一致的单位，特别是米和秒。输入的降雨强度单位为 $\\mathrm{mm/h}$，必须使用换算因子 $1 \\ \\mathrm{mm/h} = \\frac{10^{-3} \\ \\mathrm{m}}{3600 \\ \\mathrm{s}}$ 将其转换为 $\\mathrm{m/s}$。最终的累积深度从米转换为毫米，平均入渗率以 $\\mathrm{mm/h}$ 计算。\n\n### 敏感性分析\n\n对于每个测试用例，模拟都在两种情景下进行：一个孔隙度为 $n$ 的基准情景和一个孔隙度为 $n' = 1.1n$ 的增加情景。\n\n-   设 $(I_{base}, R_{base}, \\bar{f}_{base})$ 分别为基准情景下的累积入渗量（mm）、累积径流量（mm）和事件平均入渗率（mm/h）。\n-   设 $(I_{inc}, R_{inc}, \\bar{f}_{inc})$ 为孔隙度增加情景下的相同指标。\n\n敏感性指标是两种情景之间的差异：\n-   累积入渗量的变化：$\\Delta I = I_{inc} - I_{base}$\n-   累积径流量的变化：$\\Delta R = R_{inc} - R_{base}$\n-   事件平均入渗率的变化：$\\Delta \\bar{f} = \\bar{f}_{inc} - \\bar{f}_{base}$\n\n孔隙度 $n$ 的增加会同时增大可用于蓄水的孔隙空间（$\\Delta\\theta = n - \\theta_i$）和饱和水力传导度（$K_s$）。这两种效应都增强了土壤的入渗能力。因此，我们预期 $\\Delta I \\ge 0$，$\\Delta R \\le 0$ 以及 $\\Delta \\bar{f} \\ge 0$。如果两种情景下的降雨率始终低于入渗能力，则等号成立，此时入渗和径流之间的分配没有变化。",
            "answer": "```python\nimport numpy as np\n\ndef run_simulation(n, theta_i, psi_f, k0, dt, hyetograph):\n    \"\"\"\n    Runs an event-based infiltration simulation using the Green-Ampt model.\n\n    Args:\n        n (float): Porosity (dimensionless).\n        theta_i (float): Initial volumetric water content (dimensionless).\n        psi_f (float): Capillary suction at the wetting front (m).\n        k0 (float): Kozeny–Carman calibration constant (m/s).\n        dt (int): Time step (s).\n        hyetograph (list): List of rainfall intensities (mm/h).\n\n    Returns:\n        tuple: A tuple containing:\n            - Cumulative infiltration (mm).\n            - Cumulative runoff (mm).\n            - Event-mean infiltration rate (mm/h).\n    \"\"\"\n    # Physical validity checks\n    if n >= 1.0:\n        # A 10% increase might push n >= 1, so handle this gracefully.\n        # For the given test cases, this is not an issue.\n        raise ValueError(f\"Porosity n={n} must be less than 1.\")\n    if theta_i >= n:\n        raise ValueError(f\"Initial water content theta_i={theta_i} must be less than porosity n={n}.\")\n\n    # Unit conversion constants\n    MMH_TO_MS = 1e-3 / 3600.0\n    M_TO_MM = 1000.0\n\n    # Soil hydrologic parameters\n    theta_s = n\n    delta_theta = theta_s - theta_i\n    if (1 - n) == 0:\n        # Avoid division by zero for the theoretical case of n=1\n        ks = float('inf')\n    else:\n        ks = k0 * (n**3) / ((1 - n)**2)\n\n    # Convert hyetograph from mm/h to m/s\n    rain_ms = np.array(hyetograph, dtype=float) * MMH_TO_MS\n\n    # Simulation state variables\n    F_m = 0.0  # Cumulative infiltration in meters\n    R_m = 0.0  # Cumulative runoff in meters\n    \n    # Numerical stability parameter for F=0 case\n    epsilon_F = 1e-9  # meters\n\n    # Time-stepping simulation\n    for r_ms in rain_ms:\n        # Calculate infiltration capacity (m/s) using F from the start of the timestep\n        fc_ms = ks * (1 + (psi_f * delta_theta) / max(F_m, epsilon_F))\n        \n        # Determine actual infiltration rate (m/s)\n        fa_ms = min(r_ms, fc_ms)\n        \n        # Calculate incremental infiltration and runoff depths (m) for the timestep\n        infil_step_m = fa_ms * dt\n        runoff_step_m = (r_ms - fa_ms) * dt\n        \n        # Update cumulative totals\n        F_m += infil_step_m\n        R_m += runoff_step_m\n        \n    # Calculate final summary metrics\n    event_duration_s = len(hyetograph) * dt\n    event_duration_h = event_duration_s / 3600.0\n    \n    F_mm = F_m * M_TO_MM\n    R_mm = R_m * M_TO_MM\n    \n    # Calculate event-mean infiltration rate (mm/h)\n    if event_duration_h > 0:\n        f_mean_mmh = F_mm / event_duration_h\n    else:\n        f_mean_mmh = 0.0\n        \n    return F_mm, R_mm, f_mean_mmh\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    test_cases = [\n        # Test case 1\n        (0.45, 0.20, 0.25, 3.3e-5, 300, [0, 5, 10, 20, 40, 30, 20, 10, 5, 0, 0, 15, 25, 35, 25, 15, 10, 5, 0, 0, 0, 0, 0, 0]),\n        # Test case 2\n        (0.52, 0.40, 0.35, 5.0e-6, 300, [2]*24),\n        # Test case 3\n        (0.40, 0.05, 0.10, 8.0e-5, 300, [0, 0, 60, 80, 60, 0]),\n        # Test case 4\n        (0.47, 0.44, 0.30, 2.5e-5, 300, [20, 40, 50, 40, 20]),\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        n, theta_i, psi_f, k0, dt, hyetograph = case\n\n        # Run baseline scenario\n        I_base, R_base, f_bar_base = run_simulation(n, theta_i, psi_f, k0, dt, hyetograph)\n        \n        # Run increased porosity scenario\n        n_prime = 1.1 * n\n        I_inc, R_inc, f_bar_inc = run_simulation(n_prime, theta_i, psi_f, k0, dt, hyetograph)\n\n        # Calculate sensitivity metrics\n        delta_I = I_inc - I_base\n        delta_R = R_inc - R_base\n        delta_f_bar = f_bar_inc - f_bar_base\n\n        # Append rounded results\n        all_results.append([round(delta_I, 3), round(delta_R, 3), round(delta_f_bar, 3)])\n        \n    # Format the final output string as a list of lists with no spaces\n    print(str(all_results).replace(\" \", \"\"))\n\nsolve()\n\n```"
        }
    ]
}