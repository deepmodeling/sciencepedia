{
    "hands_on_practices": [
        {
            "introduction": "为了完全掌握地表能量平衡，我们必须首先精通其各个组成部分。在植被覆盖的陆地表面，潜热通量（$LE$）通常是最复杂也最重要的分量，因为它直接关联到水分循环。本练习将引导你推导彭曼-蒙特斯（Penman-Monteith）方程，这是一个结合了能量平衡和空气动力学传质原理的基石性工具。通过这项实践，你将量化植被如何通过气孔阻力（$r_s$）主动调控蒸散，从而深入理解物理过程与生物调节之间的深刻联系。",
            "id": "4097617",
            "problem": "考虑一个水平均质的植被地表，其在稳定的白昼条件下被表示为一个单一、充分混合的“大叶”冠层。地表能量收支由地表能量平衡原理决定，$$R = H + LE,$$ 其中 $R$ 是可用能量，由 $R = R_n - G$ 给出，$H$ 是感热通量，$LE$ 是与蒸发和蒸腾相关的潜热通量。感热通量由整体空气动力学传输公式描述，$$H = \\rho c_p g_a \\left( T_s - T_a \\right),$$ 其中 $\\rho$ 是空气密度，$c_p$ 是空气的定压比热容，$g_a$ 是空气动力学导度，$T_s$ 是有效冠层表面温度，$T_a$ 是冠层上方的气温。潜热通量与通过水汽导度 $g_v$ 的水汽质量传输以及近地表水汽压差有关，饱和水汽压在 $T_a$ 附近的线性化可得 $$e_s(T_s) \\approx e_s(T_a) + \\Delta (T_s - T_a),$$ 其中 $e_s$ 是饱和水汽压，$\\Delta$ 是饱和水汽压曲线在当前气温下的斜率。干湿表常数定义为 $$\\gamma = \\frac{c_p P}{\\varepsilon \\lambda},$$ 其中 $P$ 是大气压，$\\varepsilon$ 是水汽与干空气的分子量之比，$\\lambda$ 是汽化潜热。饱和水汽压差 (VPD) 定义为 $$\\mathrm{VPD} = e_s(T_a) - e_a,$$ 其中 $e_a$ 是环境水汽压。\n\n仅使用上述原理和定义（不使用任何预先给出的目标公式），推导潜热通量 $LE$ 关于 $\\Delta$、$\\gamma$、$R$、$\\mathrm{VPD}$、$r_a$ 和 $r_s$ 的表达式，其中 $g_a = 1/r_a$ 且 $g_v = 1/(r_a + r_s)$，然后使用以下代表温带草原冠层午间条件的物理一致参数集对 $LE$ 进行数值计算：\n- 净辐射 $R_n = 550\\ \\mathrm{W\\ m^{-2}}$，\n- 地热通量 $G = 50\\ \\mathrm{W\\ m^{-2}}$，\n- 饱和水汽压曲线斜率 $\\Delta = 200\\ \\mathrm{Pa\\ K^{-1}}$，\n- 干湿表常数 $\\gamma = 65\\ \\mathrm{Pa\\ K^{-1}}$，\n- 饱和水汽压差 $\\mathrm{VPD} = 2000\\ \\mathrm{Pa}$，\n- 空气动力学阻力 $r_a = 20\\ \\mathrm{s\\ m^{-1}}$，\n- 地表（气孔）阻力 $r_s = 100\\ \\mathrm{s\\ m^{-1}}$，\n- 空气密度 $\\rho = 1.2\\ \\mathrm{kg\\ m^{-3}}$，\n- 空气定压比热 $c_p = 1004\\ \\mathrm{J\\ kg^{-1}\\ K^{-1}}$。\n\n通过对推导出的 $LE$ 关于 $r_s$ 进行解析微分，然后构建 $LE$ 对 $r_s$ 的弹性，进行关于 $r_s$ 的敏感性分析，$$S_{r_s} = \\frac{\\partial \\ln LE}{\\partial \\ln r_s} = \\frac{r_s}{LE}\\,\\frac{\\partial LE}{\\partial r_s}.$$ 使用上述参数值计算 $S_{r_s}$，以量化 $r_s$ 对蒸腾作用的直接生理控制。将弹性作为你的最终答案报告。将最终答案四舍五入到四位有效数字。最终报告的量是无量纲的；最终答案不需要单位。如果你提供任何中间数值，例如 $LE$，请以 $\\mathrm{W\\ m^{-2}}$ 为单位表示。",
            "solution": "首先验证问题，发现其具有科学依据、提法恰当且客观。这是一个关于潜热通量 Penman-Monteith 方程推导和应用的微气象学标准问题。所有必要的原理和数据都已提供，足以进行完整的推导和数值计算。\n\n推导从控制地表能量和质量传输的基本方程开始。地表能量平衡由下式给出：\n$$R = H + LE \\quad (1)$$\n其中 $R$ 是可用能量，$H$ 是感热通量，$LE$ 是潜热通量。可用能量为 $R = R_n - G$，其中 $R_n$ 是净辐射，$G$ 是地热通量。\n\n感热通量 $H$ 由整体空气动力学公式定义：\n$$H = \\rho c_p g_a (T_s - T_a) \\quad (2)$$\n此处，$\\rho$ 是空气密度，$c_p$ 是空气比热，$g_a = 1/r_a$ 是空气动力学导度（$r_a$ 是空气动力学阻力），$T_s$ 是地表温度，$T_a$ 是气温。\n\n潜热通量 $LE$ 代表水汽通量 $E$ 的能量当量。通量 $E$ 与地表和空气之间的水汽压差成正比，也与水汽导度 $g_v = 1/(r_a+r_s)$ 成正比，其中 $r_s$ 是地表阻力。潜热通量由下式给出：\n$$LE = L \\cdot E = L \\frac{\\rho \\varepsilon}{P} g_v (e_s(T_s) - e_a)$$\n使用干湿表常数的定义 $\\gamma = \\frac{c_p P}{\\varepsilon \\lambda}$（根据题目符号，我们用 $\\lambda$ 表示汽化潜热 $L$），我们可以重排得到 $\\frac{\\varepsilon \\lambda}{P} = \\frac{c_p}{\\gamma}$。将此代入 $LE$ 的表达式，得到相应的潜热通量整体公式：\n$$LE = \\frac{\\rho c_p}{\\gamma} g_v (e_s(T_s) - e_a) \\quad (3)$$\n其中 $e_s(T_s)$ 是表面温度 $T_s$ 下的饱和水汽压，$e_a$ 是环境水汽压。\n\n使用方程 $(1)$、$(2)$ 和 $(3)$ 的主要困难在于未知表面温度 $T_s$ 的存在。为消去 $T_s$，我们使用题目中提供的，在已知气温 $T_a$ 附近对饱和水汽压曲线的线性化：\n$$e_s(T_s) \\approx e_s(T_a) + \\Delta (T_s - T_a) \\quad (4)$$\n其中 $\\Delta$ 是饱和水汽压曲线在 $T_a$ 下的斜率。\n\n首先，我们从感热通量方程 $(2)$ 中解出温差 $(T_s - T_a)$：\n$$T_s - T_a = \\frac{H}{\\rho c_p g_a}$$\n将此代入线性化的水汽压方程 $(4)$：\n$$e_s(T_s) \\approx e_s(T_a) + \\Delta \\frac{H}{\\rho c_p g_a}$$\n现在，将这个 $e_s(T_s)$ 的表达式代入潜热通量方程 $(3)$：\n$$LE = \\frac{\\rho c_p g_v}{\\gamma} \\left( e_s(T_a) + \\frac{\\Delta H}{\\rho c_p g_a} - e_a \\right)$$\n注意到饱和水汽压差为 $\\mathrm{VPD} = e_s(T_a) - e_a$，我们可以简化为：\n$$LE = \\frac{\\rho c_p g_v}{\\gamma} \\left( \\mathrm{VPD} + \\frac{\\Delta H}{\\rho c_p g_a} \\right)$$\n$$LE = \\frac{\\rho c_p g_v}{\\gamma} \\mathrm{VPD} + \\frac{\\Delta}{\\gamma} \\frac{g_v}{g_a} H \\quad (5)$$\n现在我们有两个方程 $(1)$ 和 $(5)$，以及两个未知数 $H$ 和 $LE$。我们可以解这个方程组。从 $(1)$ 式可知 $H = R - LE$。将其代入 $(5)$ 式：\n$$LE = \\frac{\\rho c_p g_v}{\\gamma} \\mathrm{VPD} + \\frac{\\Delta}{\\gamma} \\frac{g_v}{g_a} (R - LE)$$\n现在我们来解出 $LE$。首先，将最后一项展开：\n$$LE = \\frac{\\rho c_p g_v}{\\gamma} \\mathrm{VPD} + \\frac{\\Delta}{\\gamma} \\frac{g_v}{g_a} R - \\frac{\\Delta}{\\gamma} \\frac{g_v}{g_a} LE$$\n将所有含 $LE$ 的项移到左边：\n$$LE \\left( 1 + \\frac{\\Delta}{\\gamma} \\frac{g_v}{g_a} \\right) = \\frac{\\Delta}{\\gamma} \\frac{g_v}{g_a} R + \\frac{\\rho c_p g_v}{\\gamma} \\mathrm{VPD}$$\n为了分离出 $LE$，我们在等式两边同乘以 $\\frac{\\gamma g_a}{g_v}$：\n$$LE \\left( \\frac{\\gamma g_a}{g_v} + \\Delta \\right) = \\Delta R + \\rho c_p g_a \\mathrm{VPD}$$\n这就得到了潜热通量的最终推导表达式，通常称为 Penman-Monteith 方程：\n$$LE = \\frac{\\Delta R + \\rho c_p g_a \\mathrm{VPD}}{\\Delta + \\gamma \\frac{g_a}{g_v}}$$\n用阻力替换导度，$g_a=1/r_a$ 和 $g_v=1/(r_a+r_s)$，我们得到 $g_a/g_v = (r_a+r_s)/r_a$。表达式变为：\n$$LE = \\frac{\\Delta R + \\frac{\\rho c_p}{r_a} \\mathrm{VPD}}{\\Delta + \\gamma \\left( \\frac{r_a+r_s}{r_a} \\right)} \\quad (6)$$\n\n接下来，我们使用给定的参数对 $LE$ 进行数值计算。\n首先，计算可用能量 $R$：\n$R = R_n - G = 550\\ \\mathrm{W\\ m^{-2}} - 50\\ \\mathrm{W\\ m^{-2}} = 500\\ \\mathrm{W\\ m^{-2}}$。\n参数如下：\n$\\Delta = 200\\ \\mathrm{Pa\\ K^{-1}}$\n$\\gamma = 65\\ \\mathrm{Pa\\ K^{-1}}$\n$\\mathrm{VPD} = 2000\\ \\mathrm{Pa}$\n$r_a = 20\\ \\mathrm{s\\ m^{-1}}$\n$r_s = 100\\ \\mathrm{s\\ m^{-1}}$\n$\\rho = 1.2\\ \\mathrm{kg\\ m^{-3}}$\n$c_p = 1004\\ \\mathrm{J\\ kg^{-1}\\ K^{-1}}$\n\n方程 $(6)$ 的分子：\n$\\Delta R + \\frac{\\rho c_p}{r_a} \\mathrm{VPD} = (200)(500) + \\frac{(1.2)(1004)}{20} (2000)$\n$= 100000 + (60.24)(2000) = 100000 + 120480 = 220480\\ \\mathrm{W\\ Pa\\ m^{-2}\\ K^{-1}}$\n\n方程 $(6)$ 的分母：\n$\\Delta + \\gamma \\left( \\frac{r_a+r_s}{r_a} \\right) = 200 + 65 \\left( \\frac{20+100}{20} \\right) = 200 + 65 \\left( \\frac{120}{20} \\right)$\n$= 200 + 65(6) = 200 + 390 = 590\\ \\mathrm{Pa\\ K^{-1}}$\n\n现在，计算 $LE$：\n$$LE = \\frac{220480}{590} \\approx 373.69\\ \\mathrm{W\\ m^{-2}}$$\n\n最后，我们通过计算 $LE$ 对 $r_s$ 的弹性来进行敏感性分析：\n$$S_{r_s} = \\frac{\\partial \\ln LE}{\\partial \\ln r_s} = \\frac{r_s}{LE} \\frac{\\partial LE}{\\partial r_s}$$\n为简化微分，我们将方程 $(6)$ 重写，以明确显示其对 $r_s$ 的依赖关系：\n$$LE(r_s) = \\frac{\\Delta R + \\frac{\\rho c_p}{r_a} \\mathrm{VPD}}{\\Delta + \\gamma \\left(1 + \\frac{r_s}{r_a}\\right)} = \\frac{N}{D_1 + D_2 r_s}$$\n其中 $N = \\Delta R + \\frac{\\rho c_p}{r_a} \\mathrm{VPD}$，$D_1 = \\Delta + \\gamma$ 和 $D_2 = \\gamma/r_a$ 都与 $r_s$ 无关。\n对数导数更容易计算：\n$\\ln(LE) = \\ln(N) - \\ln(D_1 + D_2 r_s)$\n对 $r_s$ 求导：\n$$\\frac{\\partial \\ln(LE)}{\\partial r_s} = 0 - \\frac{1}{D_1 + D_2 r_s} \\cdot \\frac{\\partial}{\\partial r_s}(D_1 + D_2 r_s) = - \\frac{D_2}{D_1 + D_2 r_s}$$\n那么弹性就是：\n$$S_{r_s} = r_s \\frac{\\partial \\ln(LE)}{\\partial r_s} = -\\frac{D_2 r_s}{D_1 + D_2 r_s}$$\n将 $D_1$ 和 $D_2$ 的原始表达式代回：\n$$S_{r_s} = -\\frac{(\\gamma/r_a) r_s}{(\\Delta + \\gamma) + (\\gamma/r_a) r_s} = -\\frac{\\frac{\\gamma r_s}{r_a}}{\\Delta + \\gamma \\left(1 + \\frac{r_s}{r_a}\\right)} = \\frac{-\\frac{\\gamma r_s}{r_a}}{\\Delta + \\gamma \\left(\\frac{r_a+r_s}{r_a}\\right)}$$\n这就是弹性的解析表达式。\n现在，我们用给定的数值计算 $S_{r_s}$。\n分子：\n$-\\frac{\\gamma r_s}{r_a} = -\\frac{(65)(100)}{20} = -\\frac{6500}{20} = -325\\ \\mathrm{Pa\\ K^{-1}}$\n分母与 $LE$ 的分母相同：$590\\ \\mathrm{Pa\\ K^{-1}}$。\n$$S_{r_s} = \\frac{-325}{590} \\approx -0.55084745...$$\n四舍五入到四位有效数字，弹性为 $-0.5508$。这个无量纲量表明，地表阻力 $r_s$ 增加 $1\\%$ 会导致潜热通量减少约 $0.55\\%$，这量化了气孔对蒸腾作用的控制。",
            "answer": "$$\\boxed{-0.5508}$$"
        },
        {
            "introduction": "在掌握了能量平衡的各个通量分量之后，下一步是将它们整合到一个完整的地表能量平衡模型中。这个实践的核心任务是求解地表“皮肤”温度（$T_s$），这是一个关键的状态变量，它将净辐射、感热、潜热和地表热通量紧密地耦合在一起，并使整个系统达到平衡。你将通过实现一个数值求根算法（牛顿法），来模拟现代陆地表面模型的核心计算过程，从而在不同地表和气象条件下求解$T_s$。",
            "id": "4097707",
            "problem": "您的任务是为多个预设情景实现一个物理上一致的午间地表能量平衡计算，并使用牛顿迭代法求解未知的地表皮温。该计算必须基于基本物理定律以及数值天气预报和气候模拟中广泛使用的参数化方案。\n\n从地表控制体的能量守恒定律出发，该定律指出净辐射等于感热通量、潜热通量和传导性地面热通量之和：\n$$\nR_n = H + LE + G.\n$$\n目标是在给定气象输入和地表参数的情况下，找到满足此平衡的地表皮温 $T_s$。\n\n请使用以下物理基础和参数化方案，除这些基本原理外，不使用任何捷径：\n\n- 净辐射 $R_n$ 是净短波辐射和净长波辐射的总和：\n$$\nR_n(T_s) = (1 - \\alpha) S_{\\downarrow} + L_{\\downarrow} - \\epsilon \\sigma T_s^4,\n$$\n其中 $\\alpha$ 是地表反照率，$S_{\\downarrow}$ 是向下短波辐照度，$L_{\\downarrow}$ 是向下长波辐照度，$\\epsilon$ 是地表发射率，$\\sigma$ 是 Stefan–Boltzmann 常数。\n\n- 通过整体输送和中性 Monin–Obukhov 相似性参数化的感热通量 $H$：\n$$\nH(T_s) = \\rho c_p \\frac{T_s - T_a}{r_{ah}},\n$$\n其中 $\\rho$ 是空气密度，$c_p$ 是空气定压比热，$T_a$ 是气温，$r_{ah}$ 是中性稳定度下的热量空气动力学阻抗。\n\n- 使用带有空气动力学阻抗和地表阻抗的整体公式计算的潜热通量 $LE$：\n$$\nLE(T_s) = \\rho L_v \\frac{q_{sat}(T_s) - q_a}{r_{ah} + r_s},\n$$\n其中 $L_v$ 是蒸发潜热，$q_{sat}(T_s)$ 是地表温度下的饱和比湿，$q_a$ 是空气比湿（由相对湿度诊断得出），$r_s$ 是地表（气孔）阻抗。\n\n- 通过傅里叶热传导穿过上层薄土壤层来近似的地面热通量 $G$：\n$$\nG(T_s) = \\frac{k_g}{d_g} (T_s - T_d),\n$$\n其中 $k_g$ 是土壤导热系数，$d_g$ 是上层土壤的厚度，$T_d$ 是该层底部的温度。\n\n从基本定义推导所有必要的中间量：\n\n- 根据理想气体定律计算空气密度：\n$$\n\\rho = \\frac{p}{R_d T_a},\n$$\n其中 $p$ 是气压，$R_d$ 是干空气的比气体常数。\n\n- 使用对数风廓线计算中性条件下的空气动力学阻抗：\n$$\nr_{ah} = \\frac{\\ln\\left(\\frac{z_{ref} - d}{z_{0m}}\\right) \\cdot \\ln\\left(\\frac{z_{ref} - d}{z_{0h}}\\right)}{\\kappa^2 U},\n$$\n其中 $z_{ref}$ 是测量参考高度，$d$ 是零平面位移高度，$z_{0m}$ 和 $z_{0h}$ 分别是动量和热量的粗糙度长度，$\\kappa$ 是 von Kármán 常数，$U$ 是风速。\n\n- 使用应用于摄氏温度的 Tetens 关系计算水的饱和水汽压 $e_{sat}(T)$：\n$$\ne_{sat}(T) = a \\exp\\left(\\frac{b \\, T_C}{c + T_C}\\right),\n$$\n其中 $T_C = T - 273.15$，$a = 611.2 \\,\\text{Pa}$，$b = 17.62$，$c = 243.12 \\,\\text{°C}$。\n\n- 从水汽压计算比湿：\n$$\nq = \\frac{\\epsilon_{mw} \\, e}{p - (1 - \\epsilon_{mw}) e},\n$$\n其中 $\\epsilon_{mw} = 0.622$ 是水与干空气的摩尔质量之比，$e$ 是水汽压。通过 $e_a = \\mathrm{RH} \\cdot e_{sat}(T_a)$ 并将 $e_a$ 代入比湿公式来计算空气比湿 $q_a$。通过将 $e_{sat}(T_s)$ 代入同一公式来计算饱和比湿 $q_{sat}(T_s)$。\n\n您必须找到能解出下式的 $T_s$：\n$$\nF(T_s) \\equiv R_n(T_s) - H(T_s) - LE(T_s) - G(T_s) = 0.\n$$\n为 $T_s$ 实现一个牛顿法，初始猜测为 $T_s^{(0)} = T_a$，最大迭代次数为 $N_{max} = 50$，停止标准要求通量残差绝对值 $\\left|F(T_s)\\right| < \\tau_F$ 和温度增量绝对值 $\\left|\\Delta T_s\\right| < \\tau_T$ 同时满足，其中 $\\tau_F = 10^{-2}$ 单位为 $\\text{W}\\,\\text{m}^{-2}$，$\\tau_T = 10^{-6}$ 单位为 $\\text{K}$。如果原始牛顿步长过大，可以对其进行阻尼，但必须保持在物理上合理的范围内。\n\n使用的常数：\n- Stefan–Boltzmann 常数 $\\sigma = 5.670374419 \\times 10^{-8}$ 单位为 $\\text{W}\\,\\text{m}^{-2}\\,\\text{K}^{-4}$，\n- 定压比热 $c_p = 1004$ 单位为 $\\text{J}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}$，\n- 蒸发潜热 $L_v = 2.5 \\times 10^{6}$ 单位为 $\\text{J}\\,\\text{kg}^{-1}$，\n- 干空气气体常数 $R_d = 287$ 单位为 $\\text{J}\\,\\text{kg}^{-1}\\,\\text{K}^{-1}$，\n- von Kármán 常数 $\\kappa = 0.4$，\n- 摩尔质量比 $\\epsilon_{mw} = 0.622$。\n\n单位和输出要求：\n- 所有通量 $R_n$、$H$、$LE$ 和 $G$ 必须以 $\\text{W}\\,\\text{m}^{-2}$ 为单位报告。\n- 地表皮温 $T_s$ 必须以 $\\text{K}$ 为单位报告。\n- 报告的每个数值都四舍五入到三位小数。\n- 不使用角度，因此不需要角度单位。\n- 相对湿度 $\\mathrm{RH}$ 必须视为无单位的小数。\n\n测试套件：\n使用以下预设案例。每个案例定义了 $(p, S_{\\downarrow}, L_{\\downarrow}, \\alpha, \\epsilon, T_a, \\mathrm{RH}, U, z_{ref}, d, z_{0m}, z_{0h}, r_s, T_d, k_g, d_g)$：\n\n- 案例 A（植被农田，午间，中等风，中纬度）：$\\left(101325, 800, 400, 0.20, 0.97, 300, 0.50, 3.0, 10.0, 0.536, 0.080, 0.008, 100, 298, 1.0, 0.10\\right)$。\n- 案例 B（裸露干土，强日照，低湿度）：$\\left(101325, 1000, 350, 0.30, 0.95, 310, 0.20, 5.0, 2.0, 0.0, 0.010, 0.001, 500, 305, 0.8, 0.05\\right)$。\n- 案例 C（积雪表面，高反照率，寒冷，高海拔）：$\\left(80000, 500, 250, 0.85, 0.99, 270, 0.90, 4.0, 2.0, 0.0, 0.001, 0.001, 0, 268, 0.5, 0.20\\right)$。\n- 案例 D（湿润热带冠层，高粗糙度，极低风速）：$\\left(101325, 900, 450, 0.12, 0.98, 302, 0.80, 0.1, 30.0, 13.400, 2.000, 0.200, 50, 300, 1.5, 0.10\\right)$。\n\n最终输出格式：\n您的程序应生成单行输出，包含一个类 JSON 的嵌套列表，其中每个元素按 A、B、C、D 的顺序对应一个测试案例，每个案例的元素是列表 $[R_n, H, LE, G, T_s]$，所有值均四舍五入到三位小数，如下所示：\n$$\n[[R_n^A, H^A, LE^A, G^A, T_s^A],[R_n^B, H^B, LE^B, G^B, T_s^B],[R_n^C, H^C, LE^C, G^C, T_s^C],[R_n^D, H^D, LE^D, G^D, T_s^D]].\n$$\n请精确打印这一行，不含任何额外文本。",
            "solution": "该问题已经过验证，并被确定为是合理的。它在科学上基于地-气相互作用的原理，问题设定良好，目标明确，数据充分，并使用大气科学和数值天气预报中的标准参数化方案进行客观表述。所有提供的参数和常数都符合物理现实且前后一致。因此，将提供一个解决方案。\n\n问题的核心是找到满足地表能量平衡方程的地表皮温 $T_s$：\n$$\nF(T_s) = R_n(T_s) - H(T_s) - LE(T_s) - G(T_s) = 0\n$$\n这是一个单变量 $T_s$ 的求根问题。我们被要求使用牛顿法，这是一种迭代格式，其更新规则定义为：\n$$\nT_s^{(k+1)} = T_s^{(k)} - \\frac{F(T_s^{(k)})}{F'(T_s^{(k)})}\n$$\n其中 $T_s^{(k)}$ 是第 k 次迭代时根的估计值，$F'(T_s)$ 是函数 $F(T_s)$ 对 $T_s$ 的一阶导数。\n\n解题过程包括以下步骤：\n1. 对于每个测试案例，计算所有不依赖于 $T_s$ 的量。\n2. 实现牛顿法迭代循环以求解 $T_s$。这需要对函数 $F(T_s)$ 及其导数 $F'(T_s)$ 进行解析推导。\n3. 一旦找到收敛的 $T_s$ 值，用它来计算能量平衡各分量（$R_n$、$H$、$LE$ 和 $G$）的最终值。\n\n让我们来定义函数 $F(T_s)$ 及其导数 $F'(T_s)$。函数 $F(T_s)$ 由给定的参数化方案构成：\n$$\nF(T_s) = \\left( (1 - \\alpha) S_{\\downarrow} + L_{\\downarrow} - \\epsilon \\sigma T_s^4 \\right) - \\left( \\rho c_p \\frac{T_s - T_a}{r_{ah}} \\right) - \\left( \\rho L_v \\frac{q_{sat}(T_s) - q_a}{r_{ah} + r_s} \\right) - \\left( \\frac{k_g}{d_g} (T_s - T_d) \\right) = 0\n$$\n\n为了求导数 $F'(T_s) = \\frac{dF}{dT_s}$，我们对每一项关于 $T_s$ 求导：\n\n1.  **净辐射导数**：短波分量和向下长波辐射相对于 $T_s$ 是常数。只有向外长波辐射依赖于 $T_s$。\n    $$\n    \\frac{d R_n}{d T_s} = \\frac{d}{d T_s} \\left( (1 - \\alpha) S_{\\downarrow} + L_{\\downarrow} - \\epsilon \\sigma T_s^4 \\right) = -4 \\epsilon \\sigma T_s^3\n    $$\n\n2.  **感热通量导数**：\n    $$\n    \\frac{d H}{d T_s} = \\frac{d}{d T_s} \\left( \\rho c_p \\frac{T_s - T_a}{r_{ah}} \\right) = \\frac{\\rho c_p}{r_{ah}}\n    $$\n\n3.  **地面热通量导数**：\n    $$\n    \\frac{d G}{d T_s} = \\frac{d}{d T_s} \\left( \\frac{k_g}{d_g} (T_s - T_d) \\right) = \\frac{k_g}{d_g}\n    $$\n\n4.  **潜热通量导数**：这是最复杂的一项，因为 $q_{sat}$ 是 $T_s$ 的非线性函数。\n    $$\n    \\frac{d (LE)}{d T_s} = \\frac{d}{d T_s} \\left( \\rho L_v \\frac{q_{sat}(T_s) - q_a}{r_{ah} + r_s} \\right) = \\frac{\\rho L_v}{r_{ah} + r_s} \\frac{d q_{sat}}{d T_s}\n    $$\n    我们必须使用链式法则求 $\\frac{d q_{sat}}{d T_s}$：$\\frac{d q_{sat}}{d T_s} = \\frac{\\partial q_{sat}}{\\partial e_{sat}} \\frac{d e_{sat}}{d T_s}$。\n\n    首先，我们从 Tetens 公式 $e_{sat}(T) = a \\exp\\left(\\frac{b T_C}{c + T_C}\\right)$ 求 $\\frac{d e_{sat}}{d T_s}$，其中 $T_C = T_s - 273.15$。\n    $$\n    \\frac{d e_{sat}}{d T_s} = a \\exp\\left(\\frac{b(T_s - 273.15)}{c + (T_s - 273.15)}\\right) \\cdot \\frac{d}{d T_s}\\left(\\frac{b(T_s - 273.15)}{c + (T_s - 273.15)}\\right)\n    $$\n    对指数项的导数应用商法则：\n    $$\n    \\frac{d e_{sat}}{d T_s} = e_{sat}(T_s) \\cdot \\frac{b c}{(c + (T_s - 273.15))^2}\n    $$\n\n    接下来，我们从比湿定义 $q = \\frac{\\epsilon_{mw} e}{p - (1-\\epsilon_{mw})e}$ 求 $\\frac{\\partial q_{sat}}{\\partial e_{sat}}$。\n    使用商法则：\n    $$\n    \\frac{\\partial q}{\\partial e} = \\frac{\\epsilon_{mw}(p - (1-\\epsilon_{mw})e) - \\epsilon_{mw}e(-(1-\\epsilon_{mw}))}{(p - (1-\\epsilon_{mw})e)^2} = \\frac{\\epsilon_{mw} p}{(p - (1-\\epsilon_{mw})e)^2}\n    $$\n    代入 $e = e_{sat}(T_s)$，我们得到 $\\frac{\\partial q_{sat}}{\\partial e_{sat}}$。\n\n    结合这些，潜热通量的导数是：\n    $$\n    \\frac{d (LE)}{d T_s} = \\frac{\\rho L_v}{r_{ah} + r_s} \\left( \\frac{\\epsilon_{mw} p}{(p - (1-\\epsilon_{mw})e_{sat}(T_s))^2} \\right) \\left( e_{sat}(T_s) \\frac{b c}{(c + (T_s - 273.15))^2} \\right)\n    $$\n\n最后，总导数 $F'(T_s) = \\frac{d R_n}{d T_s} - \\frac{d H}{d T_s} - \\frac{d (LE)}{d T_s} - \\frac{d G}{d T_s}$ 是：\n$$\nF'(T_s) = -4 \\epsilon \\sigma T_s^3 - \\frac{\\rho c_p}{r_{ah}} - \\frac{k_g}{d_g} - \\frac{d (LE)}{d T_s}\n$$\n$F'(T_s)$ 中的所有项都是负的（因为 $\\frac{d(LE)}{dT_s} > 0$），这确保了 $F(T_s)$ 是一个严格单调递减的函数。这保证了根的唯一性和牛顿法的稳定性。\n\n对于每个测试案例，算法按以下步骤进行：\n1. 定义所有物理常数和特定案例的常数。给定的相对湿度 $\\mathrm{RH}$ 用作小数（例如，对于 $50\\%$ 使用 $0.50$）。\n2. 计算常数参数：空气密度 $\\rho$ 和空气动力学阻抗 $r_{ah}$。根据给定的 $T_a$ 和 $\\mathrm{RH}$ 计算空气比湿 $q_a$。\n3. 用 $T_s^{(0)} = T_a$ 初始化迭代。\n4. 循环最多 $N_{max}=50$ 次：\n   a. 使用当前的 $T_s^{(k)}$ 计算 $F(T_s)$ 和 $F'(T_s)$ 的所有项。\n   b. 计算更新步长 $\\Delta T_s = -F(T_s^{(k)}) / F'(T_s^{(k)})$。\n   c. 为了提高稳定性，如果步长过大，则对其进行阻尼：$\\Delta T_s \\leftarrow \\text{sign}(\\Delta T_s) \\cdot \\min(|\\Delta T_s|, 5.0\\,\\text{K})$。\n   d. 更新温度：$T_s^{(k+1)} = T_s^{(k)} + \\Delta T_s$。\n   e. 检查收敛性：如果 $|F(T_s^{(k+1)})| < \\tau_F = 10^{-2}\\,\\text{W}\\,\\text{m}^{-2}$ 且 $|\\Delta T_s| < \\tau_T = 10^{-6}\\,\\text{K}$，则终止循环。\n5. 循环终止后，使用最终的 $T_s$ 重新计算通量 $R_n$、$H$、$LE$ 和 $G$ 的最终值。\n6. 存储列表 $[R_n, H, LE, G, T_s]$，数值四舍五入到三位小数。\n7. 对所有测试案例重复此过程，并将结果格式化为所需的单行输出。\n\n```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the surface energy balance for a set of test cases using a Newton method.\n    \"\"\"\n    # Physical Constants\n    SIGMA = 5.670374419e-8  # Stefan–Boltzmann constant (W m^-2 K^-4)\n    CP = 1004.0             # Specific heat of air at constant pressure (J kg^-1 K^-1)\n    LV = 2.5e6              # Latent heat of vaporization (J kg^-1)\n    RD = 287.0              # Specific gas constant for dry air (J kg^-1 K^-1)\n    KAPPA = 0.4             # von Kármán constant (-)\n    EPS_MW = 0.622          # Ratio of molar masses of water to dry air (-)\n    \n    # Tetens formula constants\n    A_TETENS = 611.2        # Pa\n    B_TETENS = 17.62        # -\n    C_TETENS = 243.12       # °C\n\n    # Newton method parameters\n    N_MAX = 50\n    TAU_F = 1e-2            # Flux residual tolerance (W m^-2)\n    TAU_T = 1e-6            # Temperature increment tolerance (K)\n    MAX_DT_STEP = 5.0       # Damping for Newton step (K)\n\n    # Test cases: (p, S_down, L_down, alpha, epsilon, Ta, RH, U, z_ref, d, z0m, z0h, rs, Td, kg, dg)\n    test_cases = [\n        (101325, 800, 400, 0.20, 0.97, 300, 0.50, 3.0, 10.0, 0.536, 0.080, 0.008, 100, 298, 1.0, 0.10),\n        (101325, 1000, 350, 0.30, 0.95, 310, 0.20, 5.0, 2.0, 0.0, 0.010, 0.001, 500, 305, 0.8, 0.05),\n        (80000, 500, 250, 0.85, 0.99, 270, 0.90, 4.0, 2.0, 0.0, 0.001, 0.001, 0, 268, 0.5, 0.20),\n        (101325, 900, 450, 0.12, 0.98, 302, 0.80, 0.1, 30.0, 13.400, 2.000, 0.200, 50, 300, 1.5, 0.10),\n    ]\n\n    # --- Helper functions ---\n    def e_sat_func(T_k):\n        \"\"\"Saturation vapor pressure (Pa) from temperature (K) via Tetens.\"\"\"\n        T_c = T_k - 273.15\n        return A_TETENS * np.exp((B_TETENS * T_c) / (C_TETENS + T_c))\n\n    def q_func(e, p):\n        \"\"\"Specific humidity (kg/kg) from vapor pressure (Pa) and air pressure (Pa).\"\"\"\n        return (EPS_MW * e) / (p - (1.0 - EPS_MW) * e)\n\n    def calculate_surface_balance(params):\n        \"\"\"Computes surface energy balance for a single case.\"\"\"\n        p, S_down, L_down, alpha, epsilon, Ta, RH, U, z_ref, d, z0m, z0h, rs, Td, kg, dg = params\n\n        # A. Pre-calculate Ts-independent quantities\n        rho = p / (RD * Ta)\n        if U > 0:\n            rah = (np.log((z_ref - d) / z0m) * np.log((z_ref - d) / z0h)) / (KAPPA**2 * U)\n        else: # Handle zero wind case\n            rah = np.inf\n\n        e_sat_a = e_sat_func(Ta)\n        e_a = RH * e_sat_a\n        qa = q_func(e_a, p)\n        \n        R_net_sw = (1.0 - alpha) * S_down\n\n        # B. Newton Method Iteration\n        Ts = Ta  # Initial guess\n\n        for _ in range(N_MAX):\n            # Calculate F(Ts)\n            R_net_lw = L_down - epsilon * SIGMA * Ts**4\n            Rn = R_net_sw + R_net_lw\n            \n            H = rho * CP * (Ts - Ta) / rah if rah != np.inf else 0.0\n            \n            G = (kg / dg) * (Ts - Td)\n            \n            e_sat_s = e_sat_func(Ts)\n            q_sat_s = q_func(e_sat_s, p)\n            LE = rho * LV * (q_sat_s - qa) / (rah + rs) if (rah + rs) > 0 and rah != np.inf else 0.0\n            \n            F_Ts = Rn - H - LE - G\n\n            # Calculate F'(Ts)\n            # Derivative of R_net_lw\n            dRn_dTs = -4.0 * epsilon * SIGMA * Ts**3\n            \n            # Derivative of H\n            dH_dTs = rho * CP / rah if rah != np.inf else 0.0\n            \n            # Derivative of G\n            dG_dTs = kg / dg\n            \n            # Derivative of LE\n            Tc_s = Ts - 273.15\n            de_sat_s_dTs = e_sat_s * (B_TETENS * C_TETENS) / (C_TETENS + Tc_s)**2\n            dq_sat_s_des = (EPS_MW * p) / (p - (1.0 - EPS_MW) * e_sat_s)**2\n            dq_sat_s_dTs = dq_sat_s_des * de_sat_s_dTs\n            dLE_dTs = (rho * LV / (rah + rs)) * dq_sat_s_dTs if (rah + rs) > 0 and rah != np.inf else 0.0\n            \n            F_prime_Ts = dRn_dTs - dH_dTs - dLE_dTs - dG_dTs\n            \n            # Update step with damping\n            if F_prime_Ts == 0:\n                delta_Ts = 0.0\n            else:\n                delta_Ts = -F_Ts / F_prime_Ts\n            delta_Ts = np.sign(delta_Ts) * min(abs(delta_Ts), MAX_DT_STEP)\n            \n            Ts += delta_Ts\n            \n            if abs(F_Ts)  TAU_F and abs(delta_Ts)  TAU_T:\n                break\n        \n        # C. Post-calculation of final fluxes with converged Ts\n        R_net_lw_final = L_down - epsilon * SIGMA * Ts**4\n        Rn_final = R_net_sw + R_net_lw_final\n        H_final = rho * CP * (Ts - Ta) / rah if rah != np.inf else 0.0\n        G_final = (kg / dg) * (Ts - Td)\n        e_sat_s_final = e_sat_func(Ts)\n        q_sat_s_final = q_func(e_sat_s_final, p)\n        LE_final = rho * LV * (q_sat_s_final - qa) / (rah + rs) if (rah + rs) > 0 and rah != np.inf else 0.0\n        \n        return [Rn_final, H_final, LE_final, G_final, Ts]\n\n    # --- Main execution loop ---\n    all_results = []\n    for case in test_cases:\n        result = calculate_surface_balance(case)\n        all_results.append(result)\n\n    # --- Format and print output ---\n    results_str = []\n    for res in all_results:\n        # Use a list comprehension to format each number and join with commas\n        res_str = f\"[{','.join([f'{v:.3f}' for v in res])}]\"\n        results_str.append(res_str)\n    \n    final_output = f\"[{','.join(results_str)}]\"\n    print(final_output)\n\nsolve()\n```",
            "answer": "[[499.789,144.388,325.405,29.996,300.996],[620.589,451.979,88.756,79.854,324.971],[64.331,1.066,61.944,1.321,270.330],[719.988,14.611,685.377,20.000,303.333]]"
        },
        {
            "introduction": "理论模型必须用真实世界的观测数据进行检验，但观测本身也充满复杂性。本练习旨在解决通量塔观测中常见的“能量平衡不闭合”问题，即测量的能量输入与输出不相等。通过分析一组假设的过渡期（清晨和傍晚）数据，你将量化在数据处理中忽略能量存储项（$S$）这一常见简化操作，是如何导致湍流通量估算出现系统性偏差的。这项实践对于理解模型与数据比较中所面临的挑战至关重要。",
            "id": "4097710",
            "problem": "一个位于温带、均质、多叶冠层上方的通量塔被用来诊断早晨和傍晚转换期间地表感热通量 $H$ 和潜热通量 $LE$ 的湍流通量。从地表的局地能量守恒出发，该守恒定律将净辐射分配为湍流、传导和存储分量。具体而言，使用以下基本论述：地表的净辐射 $R_n$ 与向上的湍流感热通量 $H$、向上的湍流潜热通量 $LE$、进入土壤的传导性地表热通量 $G$ 以及一个净存储项 $S$ 的总和相平衡。该存储项 $S$ 汇集了冠层热存储、测量高度以下的气柱存储、生物化学存储和光合作用能量存储，从而地表可用能量的余项由 $S$ 来解释。\n\n在该站点的涡度相关数据后处理中，质量控制过程中应用了一种常见的做法：忽略存储项 $S$，并将可用能量视为 $R_n - G$。然后，通过保持瞬时测量的鲍恩比 $B(t)$ 来进行 $H$ 和 $LE$ 的分配。鲍恩比定义为 $B(t) = H(t)/LE(t)$，并假定其通过高频涡度相关测量已知，且对于湍流通量比是无偏的。然而，在转换期间，$S(t)$ 是不可忽略的，当忽略 $S$ 时，这会给推断出的 $H$ 和 $LE$ 带来偏差。\n\n为您提供了八个时间点的30分钟数值：一个早晨转换期（当地时间 $06{:}00$–$07{:}30$）和一个傍晚转换期（当地时间 $18{:}00$–$19{:}30$）。对于每个时间点 $t_i$，给定了净辐射 $R_n(t_i)$、地表热通量 $G(t_i)$、总存储量 $S(t_i)$ 和测量的鲍恩比 $B(t_i)$：\n- $t_1 = 06{:}00$: $R_n = 50\\ \\mathrm{W\\,m^{-2}}$, $G = 5\\ \\mathrm{W\\,m^{-2}}$, $S = 25\\ \\mathrm{W\\,m^{-2}}$, $B = 0.30$.\n- $t_2 = 06{:}30$: $R_n = 150\\ \\mathrm{W\\,m^{-2}}$, $G = 20\\ \\mathrm{W\\,m^{-2}}$, $S = 60\\ \\mathrm{W\\,m^{-2}}$, $B = 0.40$.\n- $t_3 = 07{:}00$: $R_n = 280\\ \\mathrm{W\\,m^{-2}}$, $G = 40\\ \\mathrm{W\\,m^{-2}}$, $S = 75\\ \\mathrm{W\\,m^{-2}}$, $B = 0.55$.\n- $t_4 = 07{:}30$: $R_n = 380\\ \\mathrm{W\\,m^{-2}}$, $G = 60\\ \\mathrm{W\\,m^{-2}}$, $S = 65\\ \\mathrm{W\\,m^{-2}}$, $B = 0.60$.\n- $t_5 = 18{:}00$: $R_n = 150\\ \\mathrm{W\\,m^{-2}}$, $G = 10\\ \\mathrm{W\\,m^{-2}}$, $S = -35\\ \\mathrm{W\\,m^{-2}}$, $B = 0.70$.\n- $t_6 = 18{:}30$: $R_n = 80\\ \\mathrm{W\\,m^{-2}}$, $G = 5\\ \\mathrm{W\\,m^{-2}}$, $S = -30\\ \\mathrm{W\\,m^{-2}}$, $B = 0.55$.\n- $t_7 = 19{:}00$: $R_n = 30\\ \\mathrm{W\\,m^{-2}}$, $G = 2\\ \\mathrm{W\\,m^{-2}}$, $S = -18\\ \\mathrm{W\\,m^{-2}}$, $B = 0.45$.\n- $t_8 = 19{:}30$: $R_n = 10\\ \\mathrm{W\\,m^{-2}}$, $G = 1\\ \\mathrm{W\\,m^{-2}}$, $S = -8\\ \\mathrm{W\\,m^{-2}}$, $B = 0.40$.\n\n将每个时间点 $t_i$ 因忽略存储项而导致的推断通量偏差定义为后处理估计值与真实湍流通量之间的差值。其中，后处理估计值是通过在保持测量到的 $B(t_i)$ 的同时对 $R_n - G$ 进行分配得到的，而真实湍流通量则是在地表能量平衡中正确包含存储项 $S(t_i)$ 时所获得的值。计算 $H$ 和 $LE$ 在早晨窗口期（$t_1$–$t_4$）和傍晚窗口期（$t_5$–$t_8$）的算术平均偏差。\n\n以行矩阵的形式报告您的最终结果，其中包含按以下顺序排列的四个条目：早晨 $H$ 偏差、早晨 $LE$ 偏差、傍晚 $H$ 偏差、傍晚 $LE$ 偏差。每个条目以 $\\mathrm{W\\,m^{-2}}$ 为单位表示，并四舍五入到三位有效数字。",
            "solution": "该问题要求计算在早晨和傍晚转换期间，因在地表能量平衡中忽略能量存储项（$S$）这一常见做法而引起的感热通量（$H$）和潜热通量（$LE$）的平均偏差。\n\n基本原理是地表的局地能量守恒，由以下方程给出：\n$$R_n(t) = H(t) + LE(t) + G(t) + S(t)$$\n其中 $R_n$ 是净辐射，$H$ 是感热通量，$LE$ 是潜热通量，$G$ 是地表热通量，$S$ 是净能量存储率。所有通量的单位均为 $\\mathrm{W\\,m^{-2}}$。\n\n我们将满足完整能量平衡方程的通量定义为真实通量，记作 $H_{true}$ 和 $LE_{true}$。因此，总湍流通量为：\n$$H_{true}(t) + LE_{true}(t) = R_n(t) - G(t) - S(t)$$\n该总通量的分配由测量的鲍恩比 $B(t)$ 决定，其定义为：\n$$B(t) = \\frac{H_{true}(t)}{LE_{true}(t)}$$\n根据该定义，我们有 $H_{true}(t) = B(t) \\cdot LE_{true}(t)$。将此代入湍流通量总和方程，得到：\n$$B(t) \\cdot LE_{true}(t) + LE_{true}(t) = R_n(t) - G(t) - S(t)$$\n$$(1 + B(t)) LE_{true}(t) = R_n(t) - G(t) - S(t)$$\n求解 $LE_{true}(t)$ 并随后求解 $H_{true}(t)$，我们得到真实通量的表达式：\n$$LE_{true}(t) = \\frac{R_n(t) - G(t) - S(t)}{1 + B(t)}$$\n$$H_{true}(t) = B(t) \\cdot LE_{true}(t) = \\frac{B(t) \\left( R_n(t) - G(t) - S(t) \\right)}{1 + B(t)}$$\n\n接下来，我们定义推断通量，记作 $H_{inf}$ 和 $LE_{inf}$，它们是在存储项为零（即 $S(t)=0$）的错误假设下计算的。在这种后处理方法中，假定可用能量为 $R_n(t) - G(t)$，并保持鲍恩比 $B(t)$ 不变。\n推断通量的能量平衡为：\n$$H_{inf}(t) + LE_{inf}(t) = R_n(t) - G(t)$$\n使用相同的鲍恩比 $H_{inf}(t) = B(t) \\cdot LE_{inf}(t)$，我们可以求解推断通量：\n$$(1 + B(t)) LE_{inf}(t) = R_n(t) - G(t)$$\n$$LE_{inf}(t) = \\frac{R_n(t) - G(t)}{1 + B(t)}$$\n$$H_{inf}(t) = B(t) \\cdot LE_{inf}(t) = \\frac{B(t) \\left( R_n(t) - G(t) \\right)}{1 + B(t)}$$\n\n每个通量的偏差定义为推断通量减去真实通量。设 $\\Delta H(t)$ 为感热通量的偏差，$\\Delta LE(t)$ 为潜热通量的偏差。\n$$\\Delta H(t) = H_{inf}(t) - H_{true}(t)$$\n$$\\Delta LE(t) = LE_{inf}(t) - LE_{true}(t)$$\n代入推导出的表达式：\n$$\\Delta H(t) = \\frac{B(t) ( R_n(t) - G(t) )}{1 + B(t)} - \\frac{B(t) ( R_n(t) - G(t) - S(t) )}{1 + B(t)} = \\frac{B(t)}{1 + B(t)} [ (R_n(t) - G(t)) - (R_n(t) - G(t) - S(t)) ]$$\n$$\\Delta H(t) = \\frac{B(t) S(t)}{1 + B(t)}$$\n同样，对于潜热通量偏差：\n$$\\Delta LE(t) = \\frac{R_n(t) - G(t)}{1 + B(t)} - \\frac{R_n(t) - G(t) - S(t)}{1 + B(t)} = \\frac{1}{1 + B(t)} [ (R_n(t) - G(t)) - (R_n(t) - G(t) - S(t)) ]$$\n$$\\Delta LE(t) = \\frac{S(t)}{1 + B(t)}$$\n这些简洁的结果表明，湍流通量的偏差就是被忽略的存储项 $S(t)$，按照鲍恩比 $B(t)$ 进行分配。\n\n现在我们计算每个给定时间点 $t_i$ 的偏差：\n\n**早晨转换期（$t_1$ 至 $t_4$）**\n对于 $t_1 = 06{:}00$，$S_1 = 25\\ \\mathrm{W\\,m^{-2}}$ 且 $B_1 = 0.30$：\n$\\Delta H_1 = \\frac{0.30 \\cdot 25}{1 + 0.30} = \\frac{7.5}{1.30} \\approx 5.769\\ \\mathrm{W\\,m^{-2}}$\n$\\Delta LE_1 = \\frac{25}{1 + 0.30} = \\frac{25}{1.30} \\approx 19.231\\ \\mathrm{W\\,m^{-2}}$\n\n对于 $t_2 = 06{:}30$，$S_2 = 60\\ \\mathrm{W\\,m^{-2}}$ 且 $B_2 = 0.40$：\n$\\Delta H_2 = \\frac{0.40 \\cdot 60}{1 + 0.40} = \\frac{24}{1.40} \\approx 17.143\\ \\mathrm{W\\,m^{-2}}$\n$\\Delta LE_2 = \\frac{60}{1 + 0.40} = \\frac{60}{1.40} \\approx 42.857\\ \\mathrm{W\\,m^{-2}}$\n\n对于 $t_3 = 07{:}00$，$S_3 = 75\\ \\mathrm{W\\,m^{-2}}$ 且 $B_3 = 0.55$：\n$\\Delta H_3 = \\frac{0.55 \\cdot 75}{1 + 0.55} = \\frac{41.25}{1.55} \\approx 26.613\\ \\mathrm{W\\,m^{-2}}$\n$\\Delta LE_3 = \\frac{75}{1 + 0.55} = \\frac{75}{1.55} \\approx 48.387\\ \\mathrm{W\\,m^{-2}}$\n\n对于 $t_4 = 07{:}30$，$S_4 = 65\\ \\mathrm{W\\,m^{-2}}$ 且 $B_4 = 0.60$：\n$\\Delta H_4 = \\frac{0.60 \\cdot 65}{1 + 0.60} = \\frac{39}{1.60} = 24.375\\ \\mathrm{W\\,m^{-2}}$\n$\\Delta LE_4 = \\frac{65}{1 + 0.60} = \\frac{65}{1.60} = 40.625\\ \\mathrm{W\\,m^{-2}}$\n\n早晨窗口期的算术平均偏差为：\n$\\overline{\\Delta H}_{morning} = \\frac{1}{4} \\sum_{i=1}^{4} \\Delta H_i = \\frac{1}{4} (5.769 + 17.143 + 26.613 + 24.375) = \\frac{73.900}{4} = 18.475\\ \\mathrm{W\\,m^{-2}}$\n$\\overline{\\Delta LE}_{morning} = \\frac{1}{4} \\sum_{i=1}^{4} \\Delta LE_i = \\frac{1}{4} (19.231 + 42.857 + 48.387 + 40.625) = \\frac{151.100}{4} = 37.775\\ \\mathrm{W\\,m^{-2}}$\n\n**傍晚转换期（$t_5$ 至 $t_8$）**\n对于 $t_5 = 18{:}00$，$S_5 = -35\\ \\mathrm{W\\,m^{-2}}$ 且 $B_5 = 0.70$：\n$\\Delta H_5 = \\frac{0.70 \\cdot (-35)}{1 + 0.70} = \\frac{-24.5}{1.70} \\approx -14.412\\ \\mathrm{W\\,m^{-2}}$\n$\\Delta LE_5 = \\frac{-35}{1 + 0.70} = \\frac{-35}{1.70} \\approx -20.588\\ \\mathrm{W\\,m^{-2}}$\n\n对于 $t_6 = 18{:}30$，$S_6 = -30\\ \\mathrm{W\\,m^{-2}}$ 且 $B_6 = 0.55$：\n$\\Delta H_6 = \\frac{0.55 \\cdot (-30)}{1 + 0.55} = \\frac{-16.5}{1.55} \\approx -10.645\\ \\mathrm{W\\,m^{-2}}$\n$\\Delta LE_6 = \\frac{-30}{1 + 0.55} = \\frac{-30}{1.55} \\approx -19.355\\ \\mathrm{W\\,m^{-2}}$\n\n对于 $t_7 = 19{:}00$，$S_7 = -18\\ \\mathrm{W\\,m^{-2}}$ 且 $B_7 = 0.45$：\n$\\Delta H_7 = \\frac{0.45 \\cdot (-18)}{1 + 0.45} = \\frac{-8.1}{1.45} \\approx -5.586\\ \\mathrm{W\\,m^{-2}}$\n$\\Delta LE_7 = \\frac{-18}{1 + 0.45} = \\frac{-18}{1.45} \\approx -12.414\\ \\mathrm{W\\,m^{-2}}$\n\n对于 $t_8 = 19{:}30$，$S_8 = -8\\ \\mathrm{W\\,m^{-2}}$ 且 $B_8 = 0.40$：\n$\\Delta H_8 = \\frac{0.40 \\cdot (-8)}{1 + 0.40} = \\frac{-3.2}{1.40} \\approx -2.286\\ \\mathrm{W\\,m^{-2}}$\n$\\Delta LE_8 = \\frac{-8}{1 + 0.40} = \\frac{-8}{1.40} \\approx -5.714\\ \\mathrm{W\\,m^{-2}}$\n\n傍晚窗口期的算术平均偏差为：\n$\\overline{\\Delta H}_{evening} = \\frac{1}{4} \\sum_{i=5}^{8} \\Delta H_i = \\frac{1}{4} (-14.412 - 10.645 - 5.586 - 2.286) = \\frac{-32.929}{4} = -8.23225\\ \\mathrm{W\\,m^{-2}}$\n$\\overline{\\Delta LE}_{evening} = \\frac{1}{4} \\sum_{i=5}^{8} \\Delta LE_i = \\frac{1}{4} (-20.588 - 19.355 - 12.414 - 5.714) = \\frac{-58.071}{4} = -14.51775\\ \\mathrm{W\\,m^{-2}}$\n\n最后，我们按照要求将这些平均偏差四舍五入到三位有效数字。\n早晨 $H$ 偏差：$\\overline{\\Delta H}_{morning} = 18.475 \\approx 18.5\\ \\mathrm{W\\,m^{-2}}$\n早晨 $LE$ 偏差：$\\overline{\\Delta LE}_{morning} = 37.775 \\approx 37.8\\ \\mathrm{W\\,m^{-2}}$\n傍晚 $H$ 偏差：$\\overline{\\Delta H}_{evening} = -8.23225 \\approx -8.23\\ \\mathrm{W\\,m^{-2}}$\n傍晚 $LE$ 偏差：$\\overline{\\Delta LE}_{evening} = -14.51775 \\approx -14.5\\ \\mathrm{W\\,m^{-2}}$\n\n这些结果量化了当忽略存储项 $S$ 时，早晨湍流通量的高估（正偏差）和傍晚湍流通量的低估（负偏差），这是一个物理上一致的结果。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix} 18.5  37.8  -8.23  -14.5 \\end{pmatrix}\n}\n$$"
        }
    ]
}