## 引言
海洋中的混合过程，尽管发生在微小到中等的时空尺度上，却对全球气候系统有着决定性的影响。它们调控着热量、盐分和碳等关键物质在海洋中的分布，从而塑造着大规模的[海洋环流](@entry_id:195237)和海洋对气候变化的响应。然而，由于计算资源的限制，全球气候模型的分辨率远不足以直接模拟这些至关重要的混合过程，尤其是[中尺度涡](@entry_id:1127814)旋的效应。这就引出了海洋建模中的一个核心挑战——“闭合问题”：如何用可解的、大尺度的海洋状态来表示这些未被解析的[次网格尺度过程](@entry_id:1132602)的集体效应。

本文旨在系统性地解决这一知识鸿沟，深入剖析两种在现代海洋与气候模型中被广泛采用的、用以应对闭合问题的基石性[参数化](@entry_id:265163)方案：Gent–McWilliams（GM）方案和K剖面（KPP）方案。通过学习本文，读者将能够：

- 在“原理与机制”一章中，从雷诺平均的根本问题出发，辨析绝热与跨[等密度面混合](@entry_id:1126771)的物理本质，并逐步构建[GM方案](@entry_id:1125691)（用于[参数化](@entry_id:265163)中尺度涡旋的绝[热输运](@entry_id:198424)）与[KPP方案](@entry_id:1126967)（用于[参数化](@entry_id:265163)边界层的垂向混合）的理论框架与数值挑战。
- 在“应用与跨学科联系”一章中，探索这些理论如何转化为具体的[数值算法](@entry_id:752770)，它们如何与其他物理过程模块协同工作，以及它们如何深刻影响海洋热量吸收、环流结构和气候变化预测等实际科学问题。
- 通过“动手实践”部分，将理论知识应用于具体问题，深化对[参数化](@entry_id:265163)方案[适用范围](@entry_id:636189)、数值实现和物理意义的理解。

现在，让我们从第一章“原理与机制”开始，深入探讨这些[参数化](@entry_id:265163)方案背后的基本物理问题与精妙的理论构造。

## 原理与机制

本章旨在深入阐述[海洋环流](@entry_id:195237)模型中用于表示次网格尺度混合过程的核心原理与关键机制。继引言部分对背景的铺垫之后，我们将系统性地剖析两种在现代气候与天气预报模型中占据核心地位的[参数化](@entry_id:265163)方案：Gent–McWilliams（GM）方案与K剖面（KPP）方案。我们将从基本物理问题出发，辨析不同混合过程的本质，并逐步构建起这些复杂[参数化](@entry_id:265163)方案的理论框架与数值实现细节。

### [参数化](@entry_id:265163)问题：分辨尺度与雷诺平均

[海洋环流](@entry_id:195237)模型（Ocean General Circulation Models, OCGMs）通过数值求解流体[动力学方程组](@entry_id:202106)来模拟海洋状态的演变。然而，海洋中的物理过程横跨极其宽广的时空尺度，从数千公里的 basin-scale 环流到毫米级的微观[湍流](@entry_id:151300)。受计算资源的限制，典型的全球气候模型通常采用约 $1^\circ$ 的水平分辨率。这一分辨率足以解析大规模的洋流系统，但远不足以直接模拟对全球热量和[物质输运](@entry_id:1132066)至关重要的[中尺度涡](@entry_id:1127814)旋（mesoscale eddies）。

为了定量理解这一限制，我们可以进行一次简单的[尺度分析](@entry_id:1131264)。在中纬度地区（例如 $\phi = 45^\circ$），$1^\circ$ 的经向格距 $\Delta y$ 约为 $111\,\mathrm{km}$，纬向格距 $\Delta x$ 约为 $111 \times \cos(45^\circ) \approx 78.5\,\mathrm{km}$。而驱动[中尺度涡](@entry_id:1127814)旋的斜压不[稳定过程](@entry_id:269810)，其[特征空间](@entry_id:638014)尺度由第一斜压罗斯贝变形半径 $L_R$ 决定，在中纬度通常为 $20$–$50\,\mathrm{km}$。根据数值离散的基本原理（类似于[奈奎斯特采样定理](@entry_id:268107)），要准确地解析一个空间尺度为 $L_R$ 的现象，模型格距 $\Delta x$ 必须远小于 $L_R$（通常要求 $\Delta x  L_R / 4$）。显然，在 $1^\circ$ 的模型中，$\Delta x \gtrsim L_R$，这意味着[中尺度涡](@entry_id:1127814)旋及其相关的动力过程是“未被解析”的（unresolved）。这些涡旋如果出现在模型中，将是数值畸变和[混叠](@entry_id:146322)（aliasing）的结果，其物理效应会被严重扭曲 。

这个“分辨不足”的问题引出了海洋模型中的核心挑战之一：**闭合问题（closure problem）**。通过对控制方程进行雷诺平均（Reynolds averaging），我们将变量（如速度 $\boldsymbol{u}$ 和示踪剂浓度 $C$）分解为网格可分辨的平均部分（$\overline{\boldsymbol{u}}, \overline{C}$）和次网格的脉动部分（$\boldsymbol{u}', C'$）。对于一个不可压缩流体中的守恒示踪剂，其平均收支方程可写作：
$$
\frac{\partial \overline{C}}{\partial t} + \overline{\boldsymbol{u}} \cdot \nabla \overline{C} = -\nabla \cdot (\overline{\boldsymbol{u}' C'}) + \overline{S}
$$
其中，左侧的 $\overline{\boldsymbol{u}} \cdot \nabla \overline{C}$ 代表由可解的平均流引起的 **可解平流（resolved advection）**。右侧的 $\overline{\boldsymbol{u}' C'}$ 是脉动速度与脉动浓度之间的协方差，称为 **涡动通量（eddy flux）**。它的散度 $-\nabla \cdot (\overline{\boldsymbol{u}' C'})$ 代表了所有未被解析的次网格过程（包括中尺度涡旋、小尺度[湍流](@entry_id:151300)等）对平均示踪剂浓度的净效应。由于 $\boldsymbol{u}'$ 和 $C'$ 是未知的，这个涡动通量项必须用可解的平均场量来表示，这个过程就称为 **[参数化](@entry_id:265163)（parameterization）** 。一个成功的[参数化](@entry_id:265163)方案必须能够准确地模拟这些未解过程的关键物理效应。

### 海洋混合的基本分类：绝热与跨等密度面过程

要构建有效的[参数化](@entry_id:265163)方案，首先必须对海洋中的混合过程进行物理分类。最根本的分类标准是混合过程是否改变水团的密度。由此，我们将次网格[输运过程](@entry_id:177992)分为两大类：**绝热（adiabatic）过程** 和 **跨等密度面（diapycnal）过程**。

在稳定层化的海洋中，水团倾向于在等位密面（surfaces of constant potential density），或更精确地说，在中性面（neutral surfaces）上运动。
- **绝热过程** 发生在沿着这些中性面的方向上。它们搅拌和重新分布水体，但理想情况下不改变水团的位密，因此不直接改变海洋的层结结构或进行水团改造（water mass transformation）。[中尺度涡](@entry_id:1127814)旋的水平搅拌是典型的准[绝热过程](@entry_id:138150)。
- **跨等密度面过程** 则垂直于中性面，通过混合不同密度的水体来直接改变水团的位密。这类过程是真正意义上的“混合”，它们会侵蚀[温跃层](@entry_id:195256)，改变海洋的总体层结，并驱动水团改造。海洋内部由[内波](@entry_id:261048)破碎等引起的小尺度[湍流](@entry_id:151300)，以及海洋表层受风和[浮力通量](@entry_id:261821)驱动的强烈垂直混合，都属于跨等密度面过程。

这两种过程的区分至关重要，因为它们在海洋能量和示踪剂收支中扮演着截然不同的角色。从数学上看，次网格示踪剂通量 $\boldsymbol{J}_c$ 可以分解为与中性面相切的 **等中性面（isoneutral）分量** 和与中性面垂直的 **跨中性面（dianeutral）分量**。若 $\hat{\boldsymbol{m}}$ 为中性面的[单位法向量](@entry_id:178851)，则跨中性面通量为 $\boldsymbol{J}_c \cdot \hat{\boldsymbol{m}}$。一个纯绝热的过程，其通量与中性面完全平行，因此其跨中性面分量为零。反之，任何能导致水团改造的过程，必然具有非零的跨中性面通量 。

#### 大尺度环流的约束

全球的[经向翻转环流](@entry_id:1127799)（Meridional Overturning Circulation, MOC）将寒冷、致密的深层水输向低纬度，这些水体必须通过某种方式变暖、变轻并上涌到海洋[上层](@entry_id:198114)，以闭合环流。这个上涌过程本质上是一个大规模的跨等密度面输运。利用一个简化的垂向一维[平流-扩散](@entry_id:151021)平衡模型，我们可以估算维持观测到的[翻转环流](@entry_id:1129255)所需的平均跨等密度面扩散系数 $\kappa_v$。该平衡可表示为 $w \frac{\partial T}{\partial z} \approx \frac{\partial}{\partial z}(\kappa_v \frac{\partial T}{\partial z})$，其中 $w$ 是上涌速度，$T$ 是位温。对其进行[尺度分析](@entry_id:1131264)，可得翻转流量 $U \sim w A \sim \frac{\kappa_v A}{H}$，其中 $A$ 是海洋面积，$H$ 是温跃层厚度。

利用观测值 $U \approx 10\,\mathrm{Sv}$ ($1\,\mathrm{Sv} = 10^6\,\mathrm{m^3/s}$)、$A \approx 3.5 \times 10^{14}\,\mathrm{m}^2$ 和 $H \approx 1000\,\mathrm{m}$，我们可以反算出所需的平均 $\kappa_v$：
$$
\kappa_v \sim \frac{U H}{A} \approx \frac{(10 \times 10^6\,\mathrm{m^3/s}) \times (10^3\,\mathrm{m})}{3.5 \times 10^{14}\,\mathrm{m}^2} \approx 2.86 \times 10^{-5}\,\mathrm{m^2/s}
$$
这个计算表明，要维持全球[翻转环流](@entry_id:1129255)，海洋内部所需的平均跨等密度面扩散系数必须非常小，约为 $10^{-5}\,\mathrm{m^2/s}$ 的量级。如果 $\kappa_v$ 过大，将导致与观测不符的过强的[翻转环流](@entry_id:1129255)和过于弥散的[温跃层](@entry_id:195256)。此外，海洋内部的混合能量主要来源于内潮汐在粗糙地形上的耗散以及风生内波的破碎，这些能量源在空间上是高度不均匀的。因此，海洋内部的跨等密度面混合不仅必须整体上很弱，而且必须是 **空间异质的**，在海底山脉、洋中脊等“热点”区域较强，而在广阔的深海平原“混合沙漠”中则极弱。这一结论为[参数化](@entry_id:265163)方案的设计提供了至关重要的物理约束 。

### 绝热涡旋效应的[参数化](@entry_id:265163)：Gent–McWilliams方案

如前所述，粗分辨率模型无法解析[中尺度涡](@entry_id:1127814)旋。这些涡旋的主要动力学效应是准绝热的，它们通过搅拌作用来释放由大尺度环流建立起来的有效位能（Available Potential Energy, APE），从而使等密度面趋于平缓。Gent–McWilliams（GM）方案正是为了模拟这一关键的绝热过程而设计的。

#### 物理动机：[斜压不稳定性](@entry_id:200061)与有效位能

大尺度风生和[热盐环流](@entry_id:182297)会使得海洋内部的等密度面发生倾斜，储存了大量的有效位能。在满足特定条件时（例如，位涡梯度变号），这种状态会变得不稳定，从而激发 **[斜压不稳定性](@entry_id:200061)（baroclinic instability）**，催生出中尺度涡旋。这些涡旋通过输运[浮力](@entry_id:154088)来压平倾斜的等密度面，将有效位能转化为涡动能，最终通过一系列过程耗散掉。

在无法解析涡旋的粗分辨率模型中，大尺度流会持续地使等密度面变陡，若不加以抑制，将导致不切实际的陡峭锋面和过量的有效位能。[GM方案](@entry_id:1125691)的核心思想就是引入一个[参数化](@entry_id:265163)的输运项，以模拟涡旋对等密度面的压平效应，从而代表一个平均有效位能向次网格涡动能的汇 。

#### 理论框架：厚度扩散与巨涡速度

[GM方案](@entry_id:1125691)可以通过两种等价的视角来理解。

第一种是 **等密度面厚度扩散（isopycnal thickness diffusion）**。想象将海洋看作是由一系列等密度面界定的水层叠加而成。中尺度涡旋在每个水层内部进行搅拌，其净效应是平滑该水层的厚度梯度。这可以被模拟为一个关于水层厚度 $h$ 的[扩散过程](@entry_id:268015)：
$$
\frac{\partial h}{\partial t} + \nabla_h \cdot (\overline{\boldsymbol{u}}_h h) = \nabla_h \cdot (\kappa_{GM} \nabla_h h)
$$
其中 $\kappa_{GM} > 0$ 是一个正的涡旋扩散系数。这个方程表明，水层厚度会从厚处向薄处“扩散”，从而减小厚度梯度 $|\nabla_h h|$，这等价于压平了等密度面坡度 $|\boldsymbol{s}|$。

第二种视角是在欧拉坐标（如z坐标）下引入一个虚构的 **巨涡速度（bolus velocity）** $\boldsymbol{v}^*$。厚度[扩散方程](@entry_id:170713)在数学上等价于在[示踪剂输运](@entry_id:1133278)方程中，将平流速度由原来的平均速度 $\overline{\boldsymbol{u}}$ 替换为 **剩余[平均速度](@entry_id:267649)（residual-mean velocity）** $\overline{\boldsymbol{u}}_{res} = \overline{\boldsymbol{u}} + \boldsymbol{v}^*$。这个巨涡速度被构造为沿着等密度面且无辐散（$\nabla \cdot \boldsymbol{v}^* = 0$），其大小正比于等密度面坡度 $\boldsymbol{s}$ 和涡旋扩散系数 $\kappa_{GM}$ 。由 $\boldsymbol{v}^*$ 引起的附加平流项 $\boldsymbol{v}^* \cdot \nabla \overline{C}$ 在数学上表现为一个反对称的通量，因此它只重新排布示踪剂，而不像普通扩散那样耗散示踪剂的方差。这与GM过程的绝热、非耗散特性是一致的。

#### 深入探讨：对称与[反对称张量](@entry_id:199349)分解

为了更深刻地理解[GM方案](@entry_id:1125691)的性质，我们可以从次网格涡动通量的张量结构入手。一般的通量-梯度关系可以写成 $\boldsymbol{F}_{sub} = -\mathbf{K} \nabla C$，其中 $\mathbf{K}$ 是一个二阶扩散张量。任何张量都可以分解为一个对称部分 $\mathbf{K}^{sym}$ 和一个反对称（或称斜对称）部分 $\mathbf{K}^{skew}$。

示踪剂方差的变化率与 $-\nabla C \cdot \boldsymbol{F}_{sub} = \nabla C \cdot (\mathbf{K} \nabla C)$ 成正比。可以证明，只有对称部分 $\mathbf{K}^{sym}$ 对示踪剂方差的耗散有贡献（当 $\mathbf{K}^{sym}$ 是[正定张量](@entry_id:204409)时，方差总是减小的），而反对称部分 $\mathbf{K}^{skew}$ 的贡献恒为零。
$$
\nabla C \cdot (\mathbf{K}^{skew} \nabla C) = 0
$$
因此，耗散性的、不可逆的“真混合”过程必须由[对称张量](@entry_id:148092)来描述，而可逆的、非耗散的纯平流过程则可以由[反对称张量](@entry_id:199349)来描述。

在这个框架下，中尺度涡旋的总效应被分解为两个部分 ：
1.  **Redi 扩散**：由一个[对称张量](@entry_id:148092) $\mathbf{K}^{\mathrm{redi}}$ 描述，它代表了涡旋沿等中性面的 **扩散搅拌** 效应。这是一个耗散过程。
2.  **Gent–McWilliams 输运**：由一个[反对称张量](@entry_id:199349) $\mathbf{K}^{s}$ 描述，它代表了涡旋的 **绝热平流** 效应（即巨涡输运）。这是一个非耗散过程。

因此，[GM方案](@entry_id:1125691)的本质是[参数化](@entry_id:265163)了涡动通量中的反对称、非耗散部分，它完美地对应了涡旋压平等密度面的绝热物理过程。

#### 扩散系数的[标度律](@entry_id:266186)

[GM方案](@entry_id:1125691)的强度由涡旋扩散系数 $\kappa_{GM}$ 决定。这个系数并非一个[普适常数](@entry_id:165600)，而是依赖于局地的海洋状态。根据[混合长度理论](@entry_id:752030)，扩散系数可以标度为[特征速度](@entry_id:165394)与特征长度的乘积，$\kappa_{GM} \sim U_{eddy} L_{eddy}$。更进一步，涡旋速度 $U_{eddy}$ 可认为由不稳定增长过程决定，即 $U_{eddy} \sim \sigma L_{eddy}$，其中 $\sigma$ 是[斜压不稳定性](@entry_id:200061)的最大增长率。因此，$\kappa_{GM} \sim \sigma L_{eddy}^2$。

在经典的Eady模型中，增长率 $\sigma$ 正比于平均流的垂向切变 $|\partial U / \partial z|$。而涡旋的特征长度 $L_{eddy}$ 通常取为第一斜压[罗斯贝变形半径](@entry_id:1131109) $L_d \sim NH/f$。综合这些关系，可以推导出一个依赖于背景层结 $N$ 和垂向切变 $\partial U / \partial z$ 的[标度律](@entry_id:266186) ：
$$
\kappa_{GM} \sim C\,\frac{N^2 H^2}{f^2}\left|\frac{\partial U}{\partial z}\right|
$$
其中 $C$ 是一个无量纲常数。这个标度关系揭示了GM[参数化](@entry_id:265163)与驱动涡旋的物理过程之间的深刻联系：在层结更强或垂向切变更强的区域，斜压不稳定性更活跃，因此[参数化](@entry_id:265163)的涡旋混合也应该更强。

### 跨等密度面边界层过程的[参数化](@entry_id:265163)：K剖面方案

与[GM方案](@entry_id:1125691)关注海洋内部的[绝热过程](@entry_id:138150)不同，K剖面[参数化](@entry_id:265163)（K-Profile Parameterization, KPP）方案专注于模拟[海洋边界层](@entry_id:1129048)内由风、浪和表面热量/淡水通量驱动的强烈的 **跨[等密度面混合](@entry_id:1126771)** 过程。这些边界层——主要是海洋[上层](@entry_id:198114)的混合层（mixed layer）和底部的边界层——是海洋与大气、冰、海底进行交换的最活跃区域，也是水团形成和改造的关键场所。因此，KPP和GM是互补的，一个负责边界层的垂向“真混合”，另一个负责内部的绝热涡旋输运，两者在现代海洋模型中缺一不可 。

#### [KPP方案](@entry_id:1126967)的核心机制

[KPP方案](@entry_id:1126967)是一个复杂而精巧的垂向混合模型，其核心机制包括 ：

1.  **边界层深度诊断**：KPP首先需要确定边界层的深度 $h$。它通过计算一个 **[整体理查森数](@entry_id:1121930)（bulk Richardson number）** $Ri_b$ 来实现。$Ri_b$ 比较了跨越水层的[浮力](@entry_id:154088)层结的稳定作用与[速度切变](@entry_id:267235)的非稳定作用。边界层深度 $h$ 被定义为 $Ri_b$ 首次达到一个临界值（通常约为 $0.3$）的深度。这个深度是动态变化的，反映了边界层对外部强迫的响应。

2.  **“K剖面”的构建**：方案的名字来源于其核心——一个依赖于深度的垂向[涡动扩散系数](@entry_id:196515)（eddy diffusivity）$K_\phi(z)$ 的剖面。这个剖面被[参数化](@entry_id:265163)为[特征长度尺度](@entry_id:266383)（与边界层深度 $h$ 成正比）、特征速度尺度（由[摩擦速度](@entry_id:267882) $u_*$ 和对流速度 $w_*$ 共同决定）以及一个无量纲的 **形状函数（shape function）** 的乘积。这个形状函数描述了混合强度在边界层内的垂向分布，它在海洋表面和边界层底部为零，并在边界层内部达到一个峰值，其具体形状还依赖于边界层的稳定性（如用 $h/L$ 表示，其中 $L$ 是[莫宁-奥布霍夫长度](@entry_id:1128125)）。

3.  **非局地输运（Nonlocal Transport）**：[KPP方案](@entry_id:1126967)的一个关键创新是承认了边界层内的[湍流](@entry_id:151300)输运并不仅是局地的、顺梯度的。特别是在不稳定的对流条件下（如海表冷却），大的、相干的湍涡（如羽流）可以直接将表层水体输运至边界层底部，这个过程可能与局地梯度无关，甚至是逆梯度的。为模拟此效应，KPP在标准的顺梯度扩散项 $-K_\phi(z) \frac{\partial \overline{\phi}}{\partial z}$ 之外，增加了一个 **非局地输运项** $\mathcal{G}_\phi(z)$。这个项只在不稳定条件下对温盐等标量起作用，其强度与表面[浮力通量](@entry_id:261821)和对流速度尺度 $w_*$ 相关。

4.  **与内部的匹配**：在边界层底部 $z=h$ 处，[KPP方案](@entry_id:1126967)计算的扩散系数和通量必须与海洋内部的混合方案平滑地衔接，以保证整个水柱中物理量及其通量的连续性。

综上，[KPP方案](@entry_id:1126967)通过一个复杂的、物理基础坚实的框架，模拟了边界层内从稳定到对流等各种状态下的垂向混合过程。

### 数值实现中的挑战与精进

将上述物理原理转化为可靠的数值算法并非易事。在实际的海洋模型中，尤其是在广泛使用的z坐标（大地水准面坐标）模型中，会遇到一系列由数值离散本身带来的问题。

#### [伪跨等密度面混合](@entry_id:1132228)问题

一个核心问题是 **[伪跨等密度面混合](@entry_id:1132228)（spurious diapycnal mixing）**。这是指由于数值计算的原因，在模型中产生了并非由真实物理过程（如内波破碎）引起的、人为的跨[等密度面混合](@entry_id:1126771)。这种[伪混合](@entry_id:1132230)会污染模型的物理保真度，侵蚀[温跃层](@entry_id:195256)，并可能严重干扰对长期气候变化的模拟。其主要来源包括 ：

1.  **错位的扩散算子**：在z坐标模型中，为了[参数化](@entry_id:265163)水平混合，最简单的做法是施加一个沿z坐标面（水平面）的拉普拉斯扩散。然而，海洋中的等密度面是倾斜的。当一个水平扩散作用在倾斜的等密度面上时，它自然会产生一个垂直于等密度面的通量分量。这个分量就是[伪跨等密度面混合](@entry_id:1132228)。其强度正比于水平扩散系数 $\kappa_H$ 和等密度面坡度的平方。

2.  **[数值平流](@entry_id:1128962)格式**：为了保证[数值稳定性](@entry_id:175146)，[平流格式](@entry_id:1120842)（如[通量限制格式](@entry_id:1125138)）通常会引入一定的隐式数值扩散。这种数值扩散也是沿坐标轴方向的，因此同样存在与等密度面错位的问题，从而产生[伪混合](@entry_id:1132230)。

3.  **阶梯状地形**：z坐标模型用阶梯状的网格来近似连续变化的海底地形。当沿坡流动发生时，水体被迫在水平和垂直的网格单元之间交替移动，这种“之”字形的运动会产生强烈的[伪混合](@entry_id:1132230)，尤其是在底层边界附近。

#### 解决方案：旋转[扩散张量](@entry_id:748421)与改进的几何表示

针对伪[混合问题](@entry_id:634383)，研究者们发展了一系列精进的数值技术。

- **旋转[扩散张量](@entry_id:748421)（Redi方案）**：为了解决错位扩散问题，Redi (1982) 提出，扩散张量 $\mathbf{K}$ 不应是沿坐标轴的对角阵，而应被旋转以使其主轴与局地的中性面方向对齐。这个 **等中性面扩散（isoneutral diffusion）** 方案的扩散张量可以表示为 $\mathbf{K} = K_I (\mathbf{I} - \hat{\boldsymbol{n}}\hat{\boldsymbol{n}}^{\mathsf{T}})$，其中 $K_I$ 是等中性面扩散系数，$\mathbf{I}$ 是单位张量，$\hat{\boldsymbol{n}}$ 是中性面的[单位法向量](@entry_id:178851) 。通过将扩散作用精确地限制在沿中性面方向，该方案极大地减少了由显式扩散引起的[伪混合](@entry_id:1132230) 。

- **[GM方案](@entry_id:1125691)的贡献**：[GM方案](@entry_id:1125691)通过压平陡峭的等密度面，减小了坡度 $|\boldsymbol{s}|$。由于[伪混合](@entry_id:1132230)的强度与坡度平方成正比，[GM方案](@entry_id:1125691)在模拟其主要物理效应的同时，也间接地起到了抑制[伪混合](@entry_id:1132230)的积极作用 。

- **改进的地形表示**：为了减轻阶梯地形带来的问题，模型发展了如 **部分单元格（partial cells）** 或“剃光单元格（shaved cells）”等技术。这些方法允许底层网格单元的高度不完整，从而更平滑地拟合真实地形，减少了因阶梯引起的[伪混合](@entry_id:1132230) 。

#### 一个根本性难题：中性面的不[可积性](@entry_id:142415)

在构建等中性面扩散方案时，我们遇到了一个更深层次的物理难题：严格意义上的全球 **中性面是不可积的（non-integrable）**。这意味着我们无法定义一个像位密那样的全局标量函数 $\gamma(x,y,z)$，使其[等值面](@entry_id:196027)在任何地方都与局地中性方向相切。

这个难题源于[海水状态方程](@entry_id:1124595)的[非线性](@entry_id:637147)和压力依赖性。具体来说，热膨胀系数 $\alpha$ 和盐收缩系数 $\beta$ 会随压力变化，这种效应称为 **[热压](@entry_id:159509)效应（thermobaricity）**。由于热压效应和[状态方程](@entry_id:274378)关于温盐的[非线性](@entry_id:637147)（与 **[温盐混合](@entry_id:157610)效应（cabbeling）** 相关），定义了局地中性方向的“中性矢量” $\mathbf{N} = \alpha \nabla \Theta - \beta \nabla S$ 通常具有非零的旋度（$\nabla \times \mathbf{N} \neq 0$）。根据[弗罗贝尼乌斯可积性定理](@entry_id:161479)，一个矢量场的正交平面场可积的必要条件是该矢量场与其旋度正交，即 $\mathbf{N} \cdot (\nabla \times \mathbf{N}) = 0$。在海洋中，这个被称为 **中性螺旋度（neutral helicity）** 的量通常不为零，从而证明了中性面不可积 。

这一物理事实带来了严峻的数值挑战。既然全局中性面不存在，任何“等中性面”混合方案都只能是基于 **局地中性切面** 的近似。在z坐标模型中，这意味着必须在每个网格点上根据局地的温盐梯度计算出中性面的局地坡度（$s_x = -N_x/N_z, s_y = -N_y/N_z$），并用此坡度构建旋转扩散张量。在层结很弱或水团均匀的区域，$N_z$ 趋近于零，会导致计算出的坡度无限大，从而引发数值不稳定和极端的[伪混合](@entry_id:1132230)。因此，在实际应用中，必须对计算出的坡度进行 **限制（slope limiting）** 或平滑处理，这本身就引入了与理想中性方向的偏离。这凸显了在数值模型中[精确模拟](@entry_id:749142)海洋混合过程的复杂性与固有近似性。