{
    "hands_on_practices": [
        {
            "introduction": "在陆面过程中，模型需要用一个参数，即冠层电导（$g_c$），来代表整个植被冠层对水汽交换的影响。这个练习将演示一种常见且强大的技术：双叶模型。通过将冠层划分为受光和遮阴部分，并整合它们各自的贡献，我们可以从单个叶片的行为扩展到整个植物群落的宏观属性。这项实践对于理解模型如何以计算高效的方式表示冠层非均质性至关重要。",
            "id": "4109258",
            "problem": "一个数值天气预报和气候模拟系统的陆面部分代表了一个水平均一、叶片随机朝向的植被冠层。叶面积指数（LAI）定义为单位地表面积上的单侧叶面积，用 $LAI$ 表示。关于直射光束穿过混浊介质衰减的比尔-朗伯定律指出，穿过累积叶面积 $l$ 的光束强度分数是 $\\exp(-k\\,l)$，其中 $k$ 是一个无量纲的消光系数，取决于叶倾角分布和太阳几何。在一个大叶冠层参数化方案中，单位地表面积的冠层水汽气孔导度（记为 $g_c$）定义为叶片气孔导度 $g_s$ 在叶面积上按叶面积密度加权的积分。假设以下物理上合理的简化：(i) 冠层是水平均一的，(ii) 叶片可以分为向阳和背阴两类，其向阳概率随深度变化，并由直射光的比尔-朗伯衰减定律决定，以及 (iii) 单位叶面积的叶片气孔导度在每一类中是均匀的，向阳叶片为 $g_{s,\\mathrm{sun}}$，背阴叶片为 $g_{s,\\mathrm{shade}}$。\n\n从这些基本原理出发，推导向阳和背阴叶面积指数作为 $LAI$ 和 $k$ 的函数，然后利用 $g_c$ 的定义，得到冠层导度关于 $g_{s,\\mathrm{sun}}$、$g_{s,\\mathrm{shade}}$、$LAI$ 和 $k$ 的闭合表达式。对于 $g_{s,\\mathrm{sun}}=0.2\\,\\mathrm{mol\\,m^{-2}\\,s^{-1}}$、$g_{s,\\mathrm{shade}}=0.05\\,\\mathrm{mol\\,m^{-2}\\,s^{-1}}$、$LAI=4$ 和 $k=0.5$ 这些数值，对该表达式进行数值计算。最后，推断由 $r_c=1/g_c$ 定义的冠层阻力 $r_c$。将 $g_c$ 的单位表示为 $\\mathrm{mol\\,m^{-2}\\,s^{-1}}$，将 $r_c$ 的单位表示为 $\\mathrm{m^2\\,s\\,mol^{-1}}$。将你的数值结果四舍五入到四位有效数字。",
            "solution": "该问题在科学上是有效的、适定的和客观的。它是气象学和气候科学领域陆面模拟中的一个标准推导，基于已建立的物理原理（如比尔-朗伯定律）和广泛使用的简化（如双叶（向阳/背阴）模型）。所有必要信息均已提供。\n\n推导过程主要分三步：首先，我们推导冠层向阳和背阴部分的总叶面积指数；其次，我们利用这些结果推导总冠层导度的闭合表达式；第三，我们对给定的数值计算该表达式和相应的冠层阻力。\n\n设 $l$ 代表累积叶面积指数，从冠层顶部（$l=0$）向下积分到某一深度。整个冠层的总叶面积指数用 $LAI$ 表示，因此 $l$ 的范围是从 $0$ 到 $LAI$。在深度 $l$ 处一个无穷薄层中的微分叶面积是 $dl$。\n\n根据问题陈述，冠层被划分为向阳和背阴叶片。在累积深度 $l$ 处的叶片为向阳的概率，等同于直射太阳光束穿透到该深度的比例。这由比尔-朗伯定律给出，是 $l$ 的一个函数：\n$$P_{\\mathrm{sun}}(l) = \\exp(-k\\,l)$$\n其中 $k$ 是无量纲的消光系数。因此，在深度 $l$ 处的叶片为背阴的概率是：\n$$P_{\\mathrm{shade}}(l) = 1 - P_{\\mathrm{sun}}(l) = 1 - \\exp(-k\\,l)$$\n\n总向阳叶面积指数 $LAI_{\\mathrm{sun}}$ 是通过在整个冠层深度上对叶面积的向阳部分进行积分得到的：\n$$LAI_{\\mathrm{sun}} = \\int_{0}^{LAI} P_{\\mathrm{sun}}(l) \\, dl = \\int_{0}^{LAI} \\exp(-k\\,l) \\, dl$$\n计算这个积分：\n$$LAI_{\\mathrm{sun}} = \\left[ -\\frac{1}{k} \\exp(-k\\,l) \\right]_{0}^{LAI} = -\\frac{1}{k} (\\exp(-k\\,LAI) - \\exp(0)) = \\frac{1 - \\exp(-k\\,LAI)}{k}$$\n\n总背阴叶面积指数 $LAI_{\\mathrm{shade}}$ 是总叶面积指数减去向阳部分：\n$$LAI_{\\mathrm{shade}} = LAI - LAI_{\\mathrm{sun}} = LAI - \\frac{1 - \\exp(-k\\,LAI)}{k}$$\n这也可以通过将 $P_{\\mathrm{shade}}(l)$ 从 $0$ 积分到 $LAI$ 来得到。\n\n接下来，我们推导冠层气孔导度 $g_c$ 的表达式。它被定义为叶片气孔导度 $g_s$ 在冠层总叶面积上的积分：\n$$g_c = \\int_{0}^{LAI} g_s(l) \\, dl$$\n在深度 $l$ 处的平均叶片气孔导度 $g_s(l)$ 是该深度向阳和背阴叶片导度的加权平均，权重是它们各自的概率：\n$$g_s(l) = g_{s,\\mathrm{sun}} P_{\\mathrm{sun}}(l) + g_{s,\\mathrm{shade}} P_{\\mathrm{shade}}(l)$$\n代入 $P_{\\mathrm{sun}}(l)$ 和 $P_{\\mathrm{shade}}(l)$ 的表达式：\n$$g_s(l) = g_{s,\\mathrm{sun}} \\exp(-k\\,l) + g_{s,\\mathrm{shade}} (1 - \\exp(-k\\,l))$$\n现在我们把这个代入 $g_c$ 的积分中：\n$$g_c = \\int_{0}^{LAI} [g_{s,\\mathrm{sun}} \\exp(-k\\,l) + g_{s,\\mathrm{shade}} (1 - \\exp(-k\\,l))] \\, dl$$\n我们可以把这个积分分成几个部分：\n$$g_c = g_{s,\\mathrm{sun}} \\int_{0}^{LAI} \\exp(-k\\,l) \\, dl + g_{s,\\mathrm{shade}} \\int_{0}^{LAI} (1 - \\exp(-k\\,l)) \\, dl$$\n认识到这些积分分别正好对应于 $LAI_{\\mathrm{sun}}$ 和 $LAI_{\\mathrm{shade}}$，我们得到了一个简单且物理直观的结果：\n$$g_c = g_{s,\\mathrm{sun}} LAI_{\\mathrm{sun}} + g_{s,\\mathrm{shade}} LAI_{\\mathrm{shade}}$$\n代入推导出的 $LAI_{\\mathrm{sun}}$ 和 $LAI_{\\mathrm{shade}}$ 表达式，得到 $g_c$ 关于基本参数的最终闭合表达式：\n$$g_c = g_{s,\\mathrm{sun}} \\left(\\frac{1 - \\exp(-k\\,LAI)}{k}\\right) + g_{s,\\mathrm{shade}} \\left(LAI - \\frac{1 - \\exp(-k\\,LAI)}{k}\\right)$$\n为了计算方便，可以重新整理为：\n$$g_c = g_{s,\\mathrm{shade}} LAI + (g_{s,\\mathrm{sun}} - g_{s,\\mathrm{shade}}) \\left(\\frac{1 - \\exp(-k\\,LAI)}{k}\\right)$$\n\n现在，我们用给定的数值对该表达式进行数值计算：$g_{s,\\mathrm{sun}}=0.2\\,\\mathrm{mol\\,m^{-2}\\,s^{-1}}$，$g_{s,\\mathrm{shade}}=0.05\\,\\mathrm{mol\\,m^{-2}\\,s^{-1}}$，$LAI=4$ 和 $k=0.5$。\n首先，计算乘积 $k\\,LAI$：\n$$k\\,LAI = 0.5 \\times 4 = 2$$\n将这些值代入整理后的 $g_c$ 表达式中：\n$$g_c = (0.05) \\times 4 + (0.2 - 0.05) \\left(\\frac{1 - \\exp(-2)}{0.5}\\right)$$\n$$g_c = 0.2 + (0.15) \\left(\\frac{1 - \\exp(-2)}{0.5}\\right)$$\n$$g_c = 0.2 + 0.3 \\times (1 - \\exp(-2))$$\n使用 $\\exp(-2) \\approx 0.13533528$：\n$$g_c \\approx 0.2 + 0.3 \\times (1 - 0.13533528)$$\n$$g_c \\approx 0.2 + 0.3 \\times (0.86466472)$$\n$$g_c \\approx 0.2 + 0.259399416$$\n$$g_c \\approx 0.459399416\\,\\mathrm{mol\\,m^{-2}\\,s^{-1}}$$\n四舍五入到四位有效数字，我们得到 $g_c = 0.4594\\,\\mathrm{mol\\,m^{-2}\\,s^{-1}}$。\n\n最后，我们推断冠层阻力 $r_c$，它被定义为冠层导度的倒数：\n$$r_c = \\frac{1}{g_c}$$\n$$r_c \\approx \\frac{1}{0.459399416} \\approx 2.176754\\,\\mathrm{m^2\\,s\\,mol^{-1}}$$\n四舍五入到四位有效数字，我们得到 $r_c = 2.177\\,\\mathrm{m^2\\,s\\,mol^{-1}}$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.4594  2.177 \\end{pmatrix}}$$"
        },
        {
            "introduction": "一旦我们得到了冠层阻力（$r_c$）的数值，其最关键的应用便是在地表能量平衡的计算中。这个练习将引导您推导著名的 Penman-Monteith 方程，该方程结合了有效能量和阻力项来预测蒸散。掌握这一推导和应用对于研究陆地-大气相互作用的学者至关重要，因为它构成了模型将能量分配为潜热通量和感热通量的理论基础。",
            "id": "4109220",
            "problem": "一个水平均质的植被冠层在正午时段处于稳态，冠层上方的空气在垂直方向上充分混合。在这些条件下，地表能量平衡将有效能量等同于湍流热通量。冠层源与大气之间的热量和水汽的湍流交换由一个电阻网络表示，其中空气动力学阻力 $r_a$ 控制通过冠层空气空间的输送，冠层（表面）阻力 $r_c$ 控制从叶片内部到冠层空气的水汽流动的气孔调节。假设热量和水汽的空气动力学阻力相等。大气蒸发需求由饱和水汽压差（VPD）量化，定义为空气温度下的饱和水汽压 $e_s$ 与实际空气水汽压 $e_a$ 之间的差值 $e_s - e_a$。饱和水汽压曲线随温度变化的斜率为 $\\Delta$，干湿表常数为 $\\gamma$。单位体积空气的热容量为 $\\rho c_p$，其中 $\\rho$ 是空气密度，$c_p$ 是定压比热。\n\n从地表能量平衡、基于菲克定律（Fick’s law）建立的感热和潜热湍流通量物理表达式，以及饱和水汽压在空气温度附近的线性化出发，推导一个用基本量 $R_n - G$、$\\Delta$、$\\gamma$、$\\rho c_p$、$\\mathrm{VPD}$、$r_a$ 和 $r_c$ 表示的冠层潜热通量 $\\lambda E$ 的表达式。然后，使用以下参数计算 $\\lambda E$ 的值：$R_n - G = 200\\,\\mathrm{W\\,m^{-2}}$，$\\Delta = 0.15\\,\\mathrm{kPa\\,K^{-1}}$，$\\gamma = 0.066\\,\\mathrm{kPa\\,K^{-1}}$，$\\rho c_p = 1200\\,\\mathrm{J\\,m^{-3}\\,K^{-1}}$，$\\mathrm{VPD} = 1\\,\\mathrm{kPa}$，$r_a = 40\\,\\mathrm{s\\,m^{-1}}$，以及 $r_c = 100\\,\\mathrm{s\\,m^{-1}}$。在整个计算过程中使用物理上一致的单位，并进行任何必要的单位转换。以 $\\mathrm{W\\,m^{-2}}$ 为单位表示 $\\lambda E$ 的最终答案，并将答案四舍五入到四位有效数字。简要解释计算出的 $\\lambda E$ 如何与地表能量平衡所隐含的感热通量 $H$ 一起分配有效能量。",
            "solution": "本题要求推导植被冠层潜热通量（$\\lambda E$）的 Penman-Monteith 方程，然后进行数值计算并对结果进行解释。推导从地表能量平衡和使用电阻类比的湍流通量输送原理开始。\n\n稳态系统的地表能量平衡由以下方程给出：\n$$R_n - G = H + \\lambda E$$\n其中 $R_n$ 是净辐射，$G$ 是地表热通量，$H$ 是感热通量，$\\lambda E$ 是潜热通量。项 $R_n - G$ 代表地表的总有效能量。\n\n湍流通量 $H$ 和 $\\lambda E$ 使用基于电阻网络的通量-梯度关系进行建模。对于冠层的“大叶”模型，热量和水汽的源头是一个温度为 $T_s$ 的假设表面。\n\n感热通量 $H$ 表示从温度为 $T_s$ 的冠层表面到温度为 $T_a$ 的参考高度空气的热量传递。该传递由空气动力学阻力 $r_a$ 控制：\n$$H = \\rho c_p \\frac{T_s - T_a}{r_a}$$\n这里，$\\rho c_p$ 是空气的容积热容量。\n\n潜热通量 $\\lambda E$ 代表用于蒸散的能量。这涉及水汽从叶片内部的饱和空间（温度为 $T_s$，饱和水汽压为 $e^*(T_s)$）移动到参考高度的大气中（水汽压为 $e_a$）。该传递过程遇到两个串联的阻力：冠层阻力 $r_c$（代表气孔控制）和空气动力学阻力 $r_a$。$\\lambda E$ 的表达式可以用饱和水汽压梯度和干湿表常数 $\\gamma$ 来表示：\n$$\\lambda E = \\frac{\\rho c_p}{\\gamma} \\frac{e^*(T_s) - e_a}{r_a + r_c}$$\n\n推导过程通过从这些方程中消除未测量的表面温度 $T_s$ 来进行。\n首先，我们重新整理 $H$ 的方程来求解温差 $T_s - T_a$：\n$$T_s - T_a = \\frac{H r_a}{\\rho c_p}$$\n\n接下来，我们在空气温度 $T_a$ 附近对饱和水汽压函数 $e^*(T)$ 进行线性化。在 $T_a$ 处的饱和水汽压曲线斜率由 $\\Delta = \\frac{de^*}{dT}|_{T_a}$ 给出。其一阶泰勒展开为：\n$$e^*(T_s) \\approx e^*(T_a) + \\Delta (T_s - T_a)$$\n\n将 $T_s - T_a$ 的表达式代入这个线性化表达式中：\n$$e^*(T_s) \\approx e^*(T_a) + \\Delta \\frac{H r_a}{\\rho c_p}$$\n\n现在，将 $e^*(T_s)$ 的这个表达式代入 $\\lambda E$ 的方程中：\n$$\\lambda E = \\frac{\\rho c_p}{\\gamma(r_a + r_c)} \\left[ \\left( e^*(T_a) + \\Delta \\frac{H r_a}{\\rho c_p} \\right) - e_a \\right]$$\n\n我们可以组合水汽压项。差值 $e^*(T_a) - e_a$ 是空气的饱和水汽压差，记为 $\\mathrm{VPD}$：\n$$\\lambda E = \\frac{\\rho c_p}{\\gamma(r_a + r_c)} \\left[ \\mathrm{VPD} + \\frac{\\Delta H r_a}{\\rho c_p} \\right]$$\n\n为了得到一个仅用 $\\lambda E$ 和已知大气量表示的方程，我们从地表能量平衡方程 $H = R_n - G - \\lambda E$ 中代入 $H$：\n$$\\lambda E = \\frac{\\rho c_p \\mathrm{VPD}}{\\gamma(r_a + r_c)} + \\frac{\\Delta r_a}{\\gamma(r_a + r_c)}(R_n - G - \\lambda E)$$\n\n我们现在解这个关于 $\\lambda E$ 的方程。首先，将右侧的第二项展开：\n$$\\lambda E = \\frac{\\rho c_p \\mathrm{VPD}}{\\gamma(r_a + r_c)} + \\frac{\\Delta r_a (R_n - G)}{\\gamma(r_a + r_c)} - \\frac{\\Delta r_a \\lambda E}{\\gamma(r_a + r_c)}$$\n\n将所有包含 $\\lambda E$ 的项移到方程左侧：\n$$\\lambda E + \\frac{\\Delta r_a \\lambda E}{\\gamma(r_a + r_c)} = \\frac{\\Delta r_a (R_n - G) + \\rho c_p \\mathrm{VPD}}{\\gamma(r_a + r_c)}$$\n\n在方程左侧提取公因式 $\\lambda E$：\n$$\\lambda E \\left( 1 + \\frac{\\Delta r_a}{\\gamma(r_a + r_c)} \\right) = \\frac{\\Delta r_a (R_n - G) + \\rho c_p \\mathrm{VPD}}{\\gamma(r_a + r_c)}$$\n\n合并左侧括号内的项：\n$$\\lambda E \\left( \\frac{\\gamma(r_a + r_c) + \\Delta r_a}{\\gamma(r_a + r_c)} \\right) = \\frac{\\Delta r_a (R_n - G) + \\rho c_p \\mathrm{VPD}}{\\gamma(r_a + r_c)}$$\n\n最后，通过消去两边共同的因子 $\\frac{1}{\\gamma(r_a + r_c)}$，我们得到 $\\lambda E$：\n$$\\lambda E = \\frac{\\Delta r_a (R_n - G) + \\rho c_p \\mathrm{VPD}}{\\Delta r_a + \\gamma(r_a + r_c)}$$\n为了得到 Penman-Monteith 方程更常规的形式，我们可以将分子和分母同除以 $\\Delta + \\gamma(1 + \\frac{r_c}{r_a})$ 或其他项。为了便于计算，通常通过将推导形式的分子和分母同除以 $r_a$ 来表示：\n$$\\lambda E = \\frac{\\Delta (R_n - G) + \\frac{\\rho c_p \\mathrm{VPD}}{r_a}}{\\Delta + \\gamma \\left(1 + \\frac{r_c}{r_a}\\right)}$$\n这就是所要求的表达式。\n\n现在，我们使用给定的参数计算 $\\lambda E$：\n$R_n - G = 200\\,\\mathrm{W\\,m^{-2}}$\n$\\Delta = 0.15\\,\\mathrm{kPa\\,K^{-1}}$\n$\\gamma = 0.066\\,\\mathrm{kPa\\,K^{-1}}$\n$\\rho c_p = 1200\\,\\mathrm{J\\,m^{-3}\\,K^{-1}}$\n$\\mathrm{VPD} = 1\\,\\mathrm{kPa}$\n$r_a = 40\\,\\mathrm{s\\,m^{-1}}$\n$r_c = 100\\,\\mathrm{s\\,m^{-1}}$\n\n首先，计算阻力比：\n$$\\frac{r_c}{r_a} = \\frac{100\\,\\mathrm{s\\,m^{-1}}}{40\\,\\mathrm{s\\,m^{-1}}} = 2.5$$\n\n接下来，计算方程的分母：\n$$Denominator = \\Delta + \\gamma \\left(1 + \\frac{r_c}{r_a}\\right) = 0.15\\,\\mathrm{kPa\\,K^{-1}} + (0.066\\,\\mathrm{kPa\\,K^{-1}})(1 + 2.5)$$\n$$Denominator = 0.15 + (0.066)(3.5) = 0.15 + 0.231 = 0.381\\,\\mathrm{kPa\\,K^{-1}}$$\n\n接下来，计算分子。这两个项分别是：\n$$Term\\,1 = \\Delta(R_n - G) = (0.15\\,\\mathrm{kPa\\,K^{-1}})(200\\,\\mathrm{W\\,m^{-2}}) = 30\\,\\mathrm{kPa\\,K^{-1}\\,W\\,m^{-2}}$$\n$$Term\\,2 = \\rho c_p \\frac{\\mathrm{VPD}}{r_a} = (1200\\,\\mathrm{J\\,m^{-3}\\,K^{-1}}) \\frac{1\\,\\mathrm{kPa}}{40\\,\\mathrm{s\\,m^{-1}}}$$\n回顾 $1\\,\\mathrm{J} = 1\\,\\mathrm{W\\,s}$，我们可以将 $\\rho c_p$ 的单位写为 $1200\\,\\mathrm{W\\,s\\,m^{-3}\\,K^{-1}}$。\n$$Term\\,2 = (1200\\,\\mathrm{W\\,s\\,m^{-3}\\,K^{-1}}) \\frac{1\\,\\mathrm{kPa}}{40\\,\\mathrm{s\\,m^{-1}}} = 30\\,\\mathrm{W\\,m^{-2}\\,K^{-1}\\,kPa}$$\n分子是这两项的和：\n$$Numerator = 30\\,\\mathrm{kPa\\,K^{-1}\\,W\\,m^{-2}} + 30\\,\\mathrm{kPa\\,W\\,m^{-2}\\,K^{-1}} = 60\\,\\mathrm{kPa\\,K^{-1}\\,W\\,m^{-2}}$$\n\n最后，通过将分子除以分母来计算 $\\lambda E$：\n$$\\lambda E = \\frac{60\\,\\mathrm{kPa\\,K^{-1}\\,W\\,m^{-2}}}{0.381\\,\\mathrm{kPa\\,K^{-1}}} \\approx 157.4803\\,\\mathrm{W\\,m^{-2}}$$\n四舍五入到四位有效数字，潜热通量为 $157.5\\,\\mathrm{W\\,m^{-2}}$。\n\n为了进行解释，我们从能量平衡方程中计算感热通量 $H$：\n$$H = (R_n - G) - \\lambda E = 200\\,\\mathrm{W\\,m^{-2}} - 157.5\\,\\mathrm{W\\,m^{-2}} = 42.5\\,\\mathrm{W\\,m^{-2}}$$\n在 $200\\,\\mathrm{W\\,m^{-2}}$ 的有效能量中，约有 $157.5\\,\\mathrm{W\\,m^{-2}}$ 被蒸散（潜热通量）消耗，而剩余的 $42.5\\,\\mathrm{W\\,m^{-2}}$ 用于加热空气（感热通量）。这对应于大约 $78.8\\%$ 的有效能量分配给潜热，$21.2\\%$ 分配给感热。潜热通量超过感热通量是水分充足、蒸腾旺盛的植被表面在正午太阳辐射下的典型特征。波文比（Bowen ratio） $B = H / \\lambda E = 42.5 / 157.5 \\approx 0.27$，显著小于1，这证实了在这种情况下，蒸发是耗散地表有效能量的主导机制。",
            "answer": "$$\\boxed{157.5}$$"
        },
        {
            "introduction": "这项高级练习旨在连接理论模型与实际应用，强调了诸如冠层阻力等模型参数本身存在不确定性。本题引入了数据同化这一现代数值天气预报中的核心技术。通过利用遥感观测数据，例如太阳诱导叶绿素荧光（SIF），我们可以系统地校正和改进模型对冠层阻力的估计，从而获得更准确的预报。这项练习在一个简化但真实的场景中，提供了卡尔曼滤波原理的实践经验。",
            "id": "4109225",
            "problem": "您将执行一个贝叶斯数据同化任务，使用与单步卡尔曼滤波器（KF）一致的线性高斯推断来更新冠层气孔阻力。目标是基于 Jarvis 型模型提供的先验信息和太阳诱导荧光（SIF）的观测值，计算冠层气孔阻力的后验均值。必须通过在多个测试案例中改变观测误差方差，来评估后验估计对假设的观测误差协方差的敏感性。\n\n使用的基本假设和建模框架如下：\n- 冠层气孔阻力，记为 $r_c$（单位：$\\mathrm{s\\,m^{-1}}$），被建模为一个标量状态，服从高斯先验分布 $r_c \\sim \\mathcal{N}(x_b, P_b)$，其中 $x_b$ 是先验均值，$P_b$ 是先验方差。先验 $x_b$ 由一个 Jarvis 型阻力公式提供，该公式使用独立的环境输入进行评估（不属于本问题的一部分），而 $P_b$ 概括了 $r_c$ 的先验不确定性。\n- 观测值是太阳诱导荧光（SIF），记为 $y$（单位：$\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,nm^{-1}}$），我们通过对辐射-荧光响应进行线性化，将其在先验工作点附近近似为 $r_c$ 的一个线性函数：\n  $$ y = H\\,r_c + c + v, $$\n  其中 $H$ 的单位是 $\\mathrm{(W\\,m^{-2}\\,sr^{-1}\\,nm^{-1})/(s\\,m^{-1})}$，$c$ 的单位是 $\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,nm^{-1}}$，而 $v \\sim \\mathcal{N}(0, R)$ 是方差为 $R$（单位：$\\mathrm{(W\\,m^{-2}\\,sr^{-1}\\,nm^{-1})^2}$）的高斯观测噪声。在正午条件下，$H$ 为负值，因为增加 $r_c$ 会减少光合作用活动，从而降低 SIF。\n- 您必须在标量线性高斯设定下进行研究，推导 $r_c$ 的闭式后验均值，并讨论其对 $R$ 选择的敏感性。\n\n任务：\n1. 仅从 $r_c$ 的高斯先验和线性高斯观测模型的定义出发，推导 $r_c$ 的闭式后验均值 $x_a$（单位：$\\mathrm{s\\,m^{-1}}$），使其成为 $x_b$、$P_b$、$H$、$c$、$y$ 和 $R$ 的函数。不要假设任何给定的专门同化公式；从标准的线性高斯条件恒等式开始。\n2. 实现一个程序，为每个提供的测试案例计算 $x_a$，并返回每个案例的后验均值 $r_c$，以 $\\mathrm{s\\,m^{-1}}$ 为单位表示，并四舍五入到六位小数。\n3. 在您的解决方案中定性讨论，在所有其他参数固定的情况下，后验均值如何依赖于观测误差方差 $R$。\n\n测试套件（所有量必须按指定单位处理；除特别说明外，每个测试案例都使用相同的先验和观测算子）：\n- 先验均值和方差：$x_b = 150\\,\\mathrm{s\\,m^{-1}}$，$P_b = 2500\\,\\mathrm{(s\\,m^{-1})^2}$。\n- 观测算子参数：$H = -0.004\\,\\mathrm{(W\\,m^{-2}\\,sr^{-1}\\,nm^{-1})/(s\\,m^{-1})}$，$c = 2.0\\,\\mathrm{W\\,m^{-2}\\,sr^{-1}\\,nm^{-1}}$。\n- 以下五个测试案例指定了 $(y, R)$:\n  1. $(y, R) = (1.2, 0.01)$,\n  2. $(y, R) = (1.2, 0.1)$,\n  3. $(y, R) = (1.2, 1.0)$,\n  4. $(y, R) = (1.2, 100.0)$,\n  5. $(y, R) = (1.4, 0.5)$。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含五个测试案例的 $r_c$ 后验均值，按顺序排列，形式为用方括号括起来的逗号分隔列表，每个值四舍五入到六位小数，单位为 $\\mathrm{s\\,m^{-1}}$。例如：“[150.000000,151.000000,152.000000,153.000000,154.000000]”。",
            "solution": "该问题是有效的。它提出了一个适定的、有科学依据的数据同化任务，该任务基于线性高斯推断，这是地球物理与环境科学中的一种标准和基本方法。所有必需的数据和参数都已提供，问题没有矛盾或歧义。\n\n### 1. 后验均值的推导\n\n我们给定一个标量状态变量，即冠层气孔阻力 $r_c$，其服从高斯先验分布：\n$$ p(r_c) = \\mathcal{N}(r_c; x_b, P_b) = \\frac{1}{\\sqrt{2\\pi P_b}} \\exp\\left(-\\frac{1}{2} \\frac{(r_c - x_b)^2}{P_b}\\right) $$\n其中 $x_b$ 是先验均值，$P_b$ 是先验方差。\n\n我们还给定一个太阳诱导荧光（SIF）$y$ 的线性观测模型：\n$$ y = H r_c + c + v $$\n其中 $v$ 是一个高斯噪声项，$v \\sim \\mathcal{N}(0, R)$。这定义了在给定状态 $r_c$ 时观测到 $y$ 的似然：\n$$ p(y | r_c) = \\mathcal{N}(y; H r_c + c, R) = \\frac{1}{\\sqrt{2\\pi R}} \\exp\\left(-\\frac{1}{2} \\frac{(y - (H r_c + c))^2}{R}\\right) $$\n\n根据贝叶斯定理，给定观测值 $y$ 时 $r_c$ 的后验概率分布，记为 $p(r_c | y)$，与似然和先验的乘积成正比：\n$$ p(r_c | y) \\propto p(y | r_c) p(r_c) $$\n将似然和先验的高斯形式代入，我们得到：\n$$ p(r_c | y) \\propto \\exp\\left(-\\frac{1}{2} \\frac{(y - H r_c - c)^2}{R}\\right) \\exp\\left(-\\frac{1}{2} \\frac{(r_c - x_b)^2}{P_b}\\right) $$\n$$ p(r_c | y) \\propto \\exp\\left( -\\frac{1}{2} \\left[ \\frac{(y - c - H r_c)^2}{R} + \\frac{(r_c - x_b)^2}{P_b} \\right] \\right) $$\n由于两个高斯分布的乘积（或其指数为二次型）仍为一个高斯分布，因此后验 $p(r_c | y)$ 是高斯分布。后验均值，记为 $x_a$，是使该后验概率密度最大化的 $r_c$ 值。这等价于最小化指数的参数，即成本函数 $J(r_c)$：\n$$ J(r_c) = \\frac{(y - c - H r_c)^2}{R} + \\frac{(r_c - x_b)^2}{P_b} $$\n为了找到最小值，我们对 $J(r_c)$ 关于 $r_c$ 求导，并令其为零：\n$$ \\frac{dJ}{dr_c} = \\frac{d}{dr_c} \\left( \\frac{(y - c - H r_c)^2}{R} + \\frac{(r_c - x_b)^2}{P_b} \\right) = 0 $$\n$$ \\frac{2(y - c - H r_c)(-H)}{R} + \\frac{2(r_c - x_b)}{P_b} = 0 $$\n除以 2 并重新整理各项：\n$$ \\frac{-H(y - c) + H^2 r_c}{R} + \\frac{r_c - x_b}{P_b} = 0 $$\n为了求解 $r_c$（这将是我们的后验均值 $x_a$），我们将含有 $r_c$ 的项组合在一起：\n$$ r_c \\left( \\frac{H^2}{R} + \\frac{1}{P_b} \\right) = \\frac{H(y - c)}{R} + \\frac{x_b}{P_b} $$\n$$ r_c \\left( \\frac{H^2 P_b + R}{R P_b} \\right) = \\frac{H P_b (y - c) + R x_b}{R P_b} $$\n两边同乘以 $R P_b$ 得：\n$$ r_c (H^2 P_b + R) = R x_b + P_b H (y - c) $$\n最后，求解 $r_c$ 得到后验均值 $x_a$：\n$$ x_a = \\frac{R x_b + P_b H (y - c)}{R + P_b H^2} $$\n该表达式为冠层气孔阻力的后验均值提供了闭式解。\n\n### 2. 对观测误差方差 $R$ 的敏感性\n\n推导出的后验均值 $x_a$ 公式可以重写，以便更好地理解其对观测误差方差 $R$ 的依赖性：\n$$ x_a = \\left( \\frac{R}{R + P_b H^2} \\right) x_b + \\left( \\frac{P_b H^2}{R + P_b H^2} \\right) \\left( \\frac{y-c}{H} \\right) $$\n这种形式揭示了后验均值 $x_a$ 是以下两个量的加权平均：\n1.  先验均值，$x_b$。\n2.  观测所隐含的状态，$(y-c)/H$，即在模型完美的情况下能完全解释观测值 $y$ 的 $r_c$ 值。\n\n权重取决于先验和观测的相对不确定性。项 $P_b H^2$ 代表映射到观测空间中的先验不确定性。\n\n我们可以分析 $x_a$ 在两种极限情况下的行为：\n\n- **情况 1：$R \\to 0$（对观测值有高置信度）**\n  当观测误差方差 $R$ 趋近于零时，观测值被认为是高度准确的。\n  先验均值的权重，$\\frac{R}{R + P_b H^2}$，趋近于 $0$。\n  观测所隐含状态的权重，$\\frac{P_b H^2}{R + P_b H^2}$，趋近于 $1$。\n  因此，后验均值 $x_a$ 收敛于观测所隐含的状态：\n  $$ \\lim_{R \\to 0} x_a = \\frac{y-c}{H} $$\n  这意味着当观测被完全信任时，后验估计完全由观测决定。\n\n- **情况 2：$R \\to \\infty$（对观测值有低置信度）**\n  当观测误差方差 $R$ 变得非常大时，观测值被认为是高度不确定且无信息的。\n  先验均值的权重，$\\frac{R}{R + P_b H^2} = \\frac{1}{1 + P_b H^2/R}$，趋近于 $1$。\n  观测所隐含状态的权重，$\\frac{P_b H^2}{R + P_b H^2} = \\frac{P_b H^2/R}{1 + P_b H^2/R}$，趋近于 $0$。\n  因此，后验均值 $x_a$ 收敛于先验均值：\n  $$ \\lim_{R \\to \\infty} x_a = x_b $$\n  这表明如果观测完全不可信，则不执行更新，后验估计与先验保持一致。\n\n总之，观测误差方差 $R$ 控制着观测值 $y$ 对 $r_c$ 最终估计值的影响程度。较小的 $R$ 会将后验估计从先验均值 $x_b$ 拉向观测所隐含的值。较大的 $R$ 则会减弱观测的影响，使后验估计更接近先验。这一点在测试案例 1 到 4 中得到了清晰的展示，在这些案例中，对于固定的观测值 $y$，增加 $R$ 会导致 $x_a$ 从一个接近观测所隐含状态的值移动到先验均值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the posterior mean of canopy stomatal resistance using a \n    linear Gaussian inference framework for a series of test cases.\n    \"\"\"\n    \n    # Define problem constants from the problem statement.\n    # Prior mean of canopy stomatal resistance (s/m)\n    x_b = 150.0\n    # Prior variance of canopy stomatal resistance ((s/m)^2)\n    P_b = 2500.0\n    # Sensitivity of SIF to stomatal resistance ((W/m^2/sr/nm)/(s/m))\n    H = -0.004\n    # Intercept term in the linear observation model (W/m^2/sr/nm)\n    c = 2.0\n\n    # Test cases provided in the problem statement.\n    # Each tuple contains (y, R) where:\n    # y is the SIF observation (W/m^2/sr/nm)\n    # R is the observation error variance ((W/m^2/sr/nm)^2)\n    test_cases = [\n        (1.2, 0.01),\n        (1.2, 0.1),\n        (1.2, 1.0),\n        (1.2, 100.0),\n        (1.4, 0.5),\n    ]\n\n    results = []\n    for case in test_cases:\n        y, R = case\n        \n        # Derived formula for the posterior mean (analysis state) x_a:\n        # x_a = (R * x_b + P_b * H * (y - c)) / (R + P_b * H^2)\n        \n        numerator = R * x_b + P_b * H * (y - c)\n        denominator = R + P_b * H**2\n        \n        x_a = numerator / denominator\n        \n        results.append(x_a)\n\n    # Format the results as a comma-separated list of strings, with each value\n    # rounded to six decimal places, enclosed in square brackets.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    output_string = f\"[{','.join(formatted_results)}]\"\n    \n    print(output_string)\n\nsolve()\n```"
        }
    ]
}