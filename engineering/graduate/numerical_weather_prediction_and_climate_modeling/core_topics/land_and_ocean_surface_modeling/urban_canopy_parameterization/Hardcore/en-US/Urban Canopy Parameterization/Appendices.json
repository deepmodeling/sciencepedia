{
    "hands_on_practices": [
        {
            "introduction": "Urban Canopy Models (UCMs) simplify the intricate geometry of a city into a set of bulk morphological parameters. This practice addresses the foundational task of translating raw geospatial data—such as building footprints and heights—into the essential parameters required by a model, namely the plan area fraction ($\\lambda_p$), frontal area index ($\\lambda_f$), and mean building height ($H$). You will develop an algorithm that not only computes these parameters from their geometric definitions but also incorporates robust procedures for handling the incomplete or missing data often encountered in real-world datasets .",
            "id": "4107937",
            "problem": "You are tasked with deriving, implementing, and testing an algorithm to compute the plan area fraction $\\lambda_p$, the frontal area index $\\lambda_f$ (for a specified wind direction), and the plan-area-weighted mean building height $H$ for an Urban Canopy Parameterization (UCP) grid cell. The algorithm must start from fundamental geometric and physical definitions and must specify robust procedures to handle incomplete building attribute data and mixed land-use within a grid cell. All angles must be expressed in radians. All length-like quantities must be expressed in meters, and all areas must be expressed in square meters. The final results for each test case must be floats. The program must output a single line containing the computed quantities for the provided test suite, formatted exactly as a list of lists with each inner list holding $[\\lambda_p,\\lambda_f,H]$ for a test case. Each float must be rounded to six decimal places.\n\nFundamental base definitions:\n- The plan area fraction $\\lambda_p$ is defined as the ratio of the total building plan area to the total grid-cell land area: $$\\lambda_p = \\frac{\\sum_{i=1}^{N} A_i}{A_{\\text{cell}}},$$ where $A_i$ is the building footprint area and $A_{\\text{cell}}$ is the total land area of the grid cell. Units: $\\lambda_p$ is dimensionless.\n- The frontal area index $\\lambda_f$ for wind direction $\\phi$ is defined as the ratio of the sum of building frontal areas perpendicular to the wind vector to the total grid-cell land area: $$\\lambda_f(\\phi) = \\frac{\\sum_{i=1}^{N} F_i(\\phi)}{A_{\\text{cell}}},$$ where $F_i(\\phi)$ is the frontal area of building $i$ projected onto the plane normal to the wind vector. Units: $\\lambda_f$ is dimensionless.\n- The plan-area-weighted mean building height is defined as $$H = \\frac{\\sum_{i=1}^{N} h_i A_i}{\\sum_{i=1}^{N} A_i},$$ where $h_i$ is the building height. Units: $H$ in meters. If $\\sum_{i} A_i = 0$, define $H = 0$.\n\nGeometric foundations used in the algorithm:\n- Each building footprint is approximated by a rectangle characterized by width $w_i$, length $l_i$, and an orientation angle $\\alpha_i$ measured clockwise from the $x$-axis. The grid-cell wind direction angle is $\\phi$ measured clockwise from the $x$-axis. All angles are in radians.\n- For a rectangular footprint, the building frontal width projected perpendicular to the wind direction is computed as $$b_i(\\phi) = \\left|w_i \\cos(\\alpha_i - \\phi)\\right| + \\left|l_i \\sin(\\alpha_i - \\phi)\\right|.$$ The frontal area is then $$F_i(\\phi) = h_i\\, b_i(\\phi).$$\n- If the building orientation $\\alpha_i$ is unavailable, use the Cauchy projection result for the average projected width of a convex shape over all directions. For a rectangle, the angle-averaged projected width is $$\\overline{b_i} = \\frac{2\\,(w_i + l_i)}{\\pi},$$ which is independent of $\\phi$ and provides a conservative estimate when $\\alpha_i$ is unknown.\n\nImputation rules for incomplete data and mixed land-use:\n- Land-use classes $c_i$ may be one of residential, commercial, or industrial, denoted by the set $\\{{\\text{residential}}, {\\text{commercial}}, {\\text{industrial}}\\}$. The algorithm must handle mixed land-use in a grid cell by applying class-specific defaults when attributes are missing and by aggregating all buildings across classes in the definitions for $\\lambda_p$, $\\lambda_f$, and $H$.\n- Missing building height $h_i$:\n  1. Compute the within-grid-cell, within-class median of available heights for class $c_i$. If at least one height in class $c_i$ is known in the current grid cell, use this median as the imputed $h_i$.\n  2. If no heights in class $c_i$ are known in the current grid cell, use the class-typical height $h^{\\text{typ}}_{c}$:\n     - Residential: $h^{\\text{typ}}_{\\text{residential}} = 9$ meters.\n     - Commercial: $h^{\\text{typ}}_{\\text{commercial}} = 18$ meters.\n     - Industrial: $h^{\\text{typ}}_{\\text{industrial}} = 12$ meters.\n- Missing footprint side lengths $w_i$ and $l_i$ but known footprint area $A_i$:\n  1. Reconstruct $w_i$ and $l_i$ using a class-specific typical aspect ratio $r_c = \\frac{w}{l}$:\n     - Residential: $r_{\\text{residential}} = 0.5$.\n     - Commercial: $r_{\\text{commercial}} = 1.0$.\n     - Industrial: $r_{\\text{industrial}} = 0.25$.\n  2. Using $A_i = w_i\\, l_i$ and $r_c = \\frac{w_i}{l_i}$, derive $$w_i = \\sqrt{A_i\\, r_c}, \\quad l_i = \\sqrt{\\frac{A_i}{r_c}}.$$\n- Missing orientation $\\alpha_i$:\n  - Use the angle-averaged projected width $\\overline{b_i} = \\frac{2\\,(w_i + l_i)}{\\pi}$ and set $F_i(\\phi) = h_i\\, \\overline{b_i}$.\n- When any attribute is missing, apply the above imputation rules in the following order: reconstruct $w_i$ and $l_i$ if needed, impute $h_i$, then compute $b_i(\\phi)$ using either the known $\\alpha_i$ or the angle-averaged $\\overline{b_i}$. If a building footprint area $A_i$ is missing or nonpositive, the building should be excluded from all sums.\n\nNumerical and physical units:\n- Input and output heights $h_i$ and $H$ must be in meters.\n- Input widths $w_i$ and lengths $l_i$ must be in meters.\n- Footprint areas $A_i$ and grid-cell area $A_{\\text{cell}}$ must be in square meters.\n- Angles $\\alpha_i$ and $\\phi$ must be in radians.\n- The plan area fraction $\\lambda_p$ and the frontal area index $\\lambda_f$ are dimensionless.\n\nTest suite (five grid cells):\nFor each grid cell $j$, you are given $A_{\\text{cell}}$, $\\phi$, and a list of buildings with attributes $(A_i, w_i, l_i, \\alpha_i, h_i, c_i)$; missing values are indicated and must be imputed as above.\n\n- Test case $1$ (general case with complete data):\n  - $A_{\\text{cell}} = 250000$.\n  - $\\phi = \\frac{\\pi}{6}$.\n  - Buildings:\n    1. $(A_1 = 1200,\\; w_1 = 30,\\; l_1 = 40,\\; \\alpha_1 = \\frac{\\pi}{4},\\; h_1 = 20,\\; c_1 = \\text{commercial})$.\n    2. $(A_2 = 800,\\; w_2 = 20,\\; l_2 = 40,\\; \\alpha_2 = \\frac{\\pi}{3},\\; h_2 = 12,\\; c_2 = \\text{residential})$.\n- Test case $2$ (missing height imputed by within-class median):\n  - $A_{\\text{cell}} = 250000$.\n  - $\\phi = \\frac{\\pi}{3}$.\n  - Buildings:\n    1. $(A_1 = 600,\\; w_1 = 15,\\; l_1 = 40,\\; \\alpha_1 = \\frac{\\pi}{8},\\; h_1 = \\text{missing},\\; c_1 = \\text{residential})$.\n    2. $(A_2 = 500,\\; w_2 = 10,\\; l_2 = 50,\\; \\alpha_2 = \\frac{\\pi}{5},\\; h_2 = 10,\\; c_2 = \\text{residential})$.\n    3. $(A_3 = 900,\\; w_3 = 30,\\; l_3 = 30,\\; \\alpha_3 = \\frac{\\pi}{6},\\; h_3 = 18,\\; c_3 = \\text{commercial})$.\n- Test case $3$ (missing orientations and missing height imputed by class-typical):\n  - $A_{\\text{cell}} = 250000$.\n  - $\\phi = \\frac{\\pi}{2}$.\n  - Buildings:\n    1. $(A_1 = 2000,\\; w_1 = 25,\\; l_1 = 80,\\; \\alpha_1 = \\text{missing},\\; h_1 = 15,\\; c_1 = \\text{industrial})$.\n    2. $(A_2 = 600,\\; w_2 = 12,\\; l_2 = 50,\\; \\alpha_2 = \\text{missing},\\; h_2 = \\text{missing},\\; c_2 = \\text{residential})$.\n- Test case $4$ (missing widths and lengths reconstructed from area and class aspect ratio, mixed orientation availability, missing height imputed by class-typical):\n  - $A_{\\text{cell}} = 250000$.\n  - $\\phi = 0$.\n  - Buildings:\n    1. $(A_1 = 1000,\\; w_1 = \\text{missing},\\; l_1 = \\text{missing},\\; \\alpha_1 = \\frac{\\pi}{4},\\; h_1 = 20,\\; c_1 = \\text{commercial})$.\n    2. $(A_2 = 1500,\\; w_2 = \\text{missing},\\; l_2 = \\text{missing},\\; \\alpha_2 = \\text{missing},\\; h_2 = \\text{missing},\\; c_2 = \\text{industrial})$.\n- Test case $5$ (edge case: no buildings in the grid cell):\n  - $A_{\\text{cell}} = 250000$.\n  - $\\phi = \\frac{\\pi}{2}$.\n  - Buildings: none.\n\nOutput specification:\n- Your program should produce a single line of output containing the results as a list of lists, each inner list being $[\\lambda_p,\\lambda_f,H]$ for the corresponding test case, with each float rounded to six decimal places. For example: $$[[x_{11},x_{12},x_{13}],[x_{21},x_{22},x_{23}],\\dots],$$ where $x_{j1}=\\lambda_p$, $x_{j2}=\\lambda_f$, and $x_{j3}=H$ for test case $j$.",
            "solution": "We begin from the Urban Canopy Parameterization (UCP) fundamental definitions of plan area fraction, frontal area index, and mean building height. The plan area fraction $\\lambda_p$ is defined as the ratio $\\lambda_p = \\frac{\\sum_{i=1}^{N} A_i}{A_{\\text{cell}}}$, which aggregates all footprint areas $A_i$ within the grid cell and normalizes by the grid-cell area $A_{\\text{cell}}$. It is dimensionless and measures areal building coverage.\n\nThe frontal area index $\\lambda_f(\\phi)$ measures the total building frontal area projected perpendicular to the wind direction $\\phi$, normalized by the grid-cell area. For a building represented as a rectangle with width $w_i$, length $l_i$, orientation $\\alpha_i$, and height $h_i$, the projected width perpendicular to wind is derived from the geometric projection of the rectangle onto a line normal to the wind vector. If the rectangle edges are aligned with $\\alpha_i$, and $\\phi$ is the wind direction, the projection width can be written as $b_i(\\phi) = \\left|w_i \\cos(\\alpha_i - \\phi)\\right| + \\left|l_i \\sin(\\alpha_i - \\phi)\\right|$. This follows from decomposing the projection of the rectangle's extents onto the axis perpendicular to the wind: the contribution along the rectangle's width is modulated by $\\cos(\\alpha_i - \\phi)$, while the contribution along the rectangle's length is modulated by $\\sin(\\alpha_i - \\phi)$, and absolute values ensure non-negativity because widths are geometric measures. The building frontal area is then $F_i(\\phi) = h_i\\, b_i(\\phi)$, yielding $\\lambda_f(\\phi) = \\frac{\\sum_i F_i(\\phi)}{A_{\\text{cell}}}$, which is dimensionless.\n\nWhen the orientation $\\alpha_i$ is missing, we cannot compute $b_i(\\phi)$ directly. A robust replacement uses the Cauchy projection theorem for convex shapes, which states that the average length of the orthogonal projection of a convex curve onto a line, averaged over all angles, equals the perimeter divided by $\\pi$. For a rectangle of width $w_i$ and length $l_i$, perimeter is $2(w_i + l_i)$, hence the angle-averaged projected width is $\\overline{b_i} = \\frac{2(w_i + l_i)}{\\pi}$. This estimate is independent of $\\phi$ and provides a conservative, physically consistent proxy when $\\alpha_i$ is unknown. We then take $F_i(\\phi) = h_i\\, \\overline{b_i}$.\n\nThe mean building height $H$ is computed in a plan-area-weighted fashion: $H = \\frac{\\sum_i h_i A_i}{\\sum_i A_i}$. This weighting is common in urban parameterizations to reflect the contribution of larger buildings to urban canopy properties. If there are no buildings (i.e., $\\sum_i A_i = 0$), we define $H = 0$ to avoid division by zero and to represent the absence of a canopy.\n\nHandling incomplete data proceeds via the following imputation logic:\n- Missing heights $h_i$ are imputed by first attempting a within-class median computed from known heights in the current grid cell. Medians are robust and avoid outlier bias. If the class has no known heights in the grid cell, we use class-typical heights informed by typical urban morphology: residential $h^{\\text{typ}}_{\\text{residential}} = 9$ meters (approximately three stories), commercial $h^{\\text{typ}}_{\\text{commercial}} = 18$ meters (mid-rise offices), and industrial $h^{\\text{typ}}_{\\text{industrial}} = 12$ meters (warehouse-type structures). These values are plausible and consistent with urban climatology settings.\n- Missing widths and lengths but known footprint area $A_i$ are reconstructed using $r_c = \\frac{w}{l}$ for the class. With $A_i = w_i l_i$ and $r_c = \\frac{w_i}{l_i}$, we solve for $w_i = \\sqrt{A_i r_c}$ and $l_i = \\sqrt{\\frac{A_i}{r_c}}$. Typical aspect ratios reflect footprint elongation by class: residential $r_{\\text{residential}} = 0.5$ (elongated row-house or apartment blocks), commercial $r_{\\text{commercial}} = 1.0$ (roughly square footprints), and industrial $r_{\\text{industrial}} = 0.25$ (elongated sheds).\n- Missing orientations $\\alpha_i$ invoke the angle-averaged projected width $\\overline{b_i} = \\frac{2(w_i + l_i)}{\\pi}$, which is grounded in the Cauchy projection theorem.\n\nAlgorithmic steps for one grid cell:\n1. Validate $A_{\\text{cell}} > 0$.\n2. Filter out any building with missing or nonpositive $A_i$. Compute $\\sum_i A_i$ for included buildings.\n3. Compute $\\lambda_p = \\frac{\\sum_i A_i}{A_{\\text{cell}}}$.\n4. For each building:\n   a. If $w_i$ and $l_i$ are both missing, reconstruct them using the class aspect ratio $r_c$ and building area $A_i$ via $w_i = \\sqrt{A_i r_c}$ and $l_i = \\sqrt{\\frac{A_i}{r_c}}$.\n   b. If $h_i$ is missing, impute using the within-class median over known $h_i$ in the current grid cell; if none exist, use $h^{\\text{typ}}_{c_i}$.\n   c. Compute the projected width: if $\\alpha_i$ is known, $b_i(\\phi) = \\left|w_i \\cos(\\alpha_i - \\phi)\\right| + \\left|l_i \\sin(\\alpha_i - \\phi)\\right|$; otherwise, use $\\overline{b_i} = \\frac{2(w_i + l_i)}{\\pi}$.\n   d. Compute $F_i(\\phi) = h_i\\, b_i(\\phi)$.\n5. Compute $\\lambda_f(\\phi) = \\frac{\\sum_i F_i(\\phi)}{A_{\\text{cell}}}$.\n6. Compute $H = \\frac{\\sum_i h_i A_i}{\\sum_i A_i}$ if $\\sum_i A_i > 0$; else set $H = 0$.\n7. Round $\\lambda_p$, $\\lambda_f$, and $H$ to six decimal places for output.\n\nThe test suite includes five cases designed to exercise the algorithm:\n- A complete-data case to verify the baseline computations.\n- A case with missing heights imputed by within-class median.\n- A case with missing orientations relying on the angle-averaged projection and a missing height imputed by class-typical value.\n- A case with missing widths and lengths reconstructed from footprint area and class aspect ratios, along with mixed missing orientation and height.\n- An edge case with no buildings to validate handling of zero sums and baseline outputs.\n\nThe program will implement these steps for each test case and produce a single line containing a list of lists, each inner list holding $[\\lambda_p,\\lambda_f,H]$ in that order, rounded to six decimal places, ensuring strict adherence to the specified format and units.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef reconstruct_dimensions(area, aspect_ratio):\n    \"\"\"\n    Reconstruct width and length from area and class-specific aspect ratio r = w / l.\n    Returns (w, l).\n    \"\"\"\n    w = np.sqrt(area * aspect_ratio)\n    l = np.sqrt(area / aspect_ratio)\n    return w, l\n\ndef mean_projected_width(w, l):\n    \"\"\"\n    Angle-averaged projected width (Cauchy projection): perimeter/pi for rectangles.\n    For a rectangle, perimeter = 2*(w + l), so mean width = 2*(w + l)/pi.\n    \"\"\"\n    return 2.0 * (w + l) / np.pi\n\ndef projected_width(w, l, alpha, phi):\n    \"\"\"\n    Projected width perpendicular to wind direction for a rectangle with orientation alpha.\n    b = |w * cos(alpha - phi)| + |l * sin(alpha - phi)|.\n    \"\"\"\n    d = alpha - phi\n    return abs(w * np.cos(d)) + abs(l * np.sin(d))\n\ndef impute_height(h, cls, class_heights_in_cell, typical_heights):\n    \"\"\"\n    Impute missing height:\n    - If h is not None, return h.\n    - Else, if there are known heights in this class in the grid, return their median.\n    - Else, return the class-typical height.\n    \"\"\"\n    if h is not None:\n        return h\n    known = class_heights_in_cell.get(cls, [])\n    if len(known) > 0:\n        return float(np.median(known))\n    return typical_heights[cls]\n\ndef compute_metrics_for_cell(cell):\n    \"\"\"\n    Compute lambda_p, lambda_f, H for a single grid cell.\n    cell: dict with keys:\n        - 'A_cell': float (grid cell area, m^2)\n        - 'phi': float (wind direction, radians)\n        - 'buildings': list of building dicts with keys:\n            'A', 'w', 'l', 'alpha', 'h', 'cls'\n    Returns (lambda_p, lambda_f, H).\n    \"\"\"\n    A_cell = cell['A_cell']\n    phi = cell['phi']\n    buildings = cell['buildings']\n\n    # Class-specific typical heights (m) and aspect ratios r = w/l\n    typical_heights = {\n        'residential': 9.0,\n        'commercial': 18.0,\n        'industrial': 12.0,\n    }\n    class_aspect_ratio = {\n        'residential': 0.5,\n        'commercial': 1.0,\n        'industrial': 0.25,\n    }\n\n    # Filter buildings with valid area\n    valid_buildings = []\n    for b in buildings:\n        A_i = b['A']\n        if A_i is None or A_i <= 0.0:\n            continue\n        valid_buildings.append(b)\n\n    # Pre-collect known heights by class for within-cell median imputation\n    class_heights_in_cell = {'residential': [], 'commercial': [], 'industrial': []}\n    for b in valid_buildings:\n        if b['h'] is not None:\n            class_heights_in_cell[b['cls']].append(b['h'])\n\n    # Sum of plan areas\n    sum_Ai = sum(b['A'] for b in valid_buildings)\n    lambda_p = (sum_Ai / A_cell) if A_cell > 0.0 else 0.0\n\n    # Compute frontal areas and weighted height sum\n    sum_F = 0.0\n    sum_hA = 0.0\n\n    for b in valid_buildings:\n        A_i = b['A']\n        w_i = b['w']\n        l_i = b['l']\n        alpha_i = b['alpha']\n        h_i = b['h']\n        cls = b['cls']\n\n        # Reconstruct dimensions if missing\n        if (w_i is None or l_i is None) and A_i is not None:\n            r_c = class_aspect_ratio[cls]\n            w_i, l_i = reconstruct_dimensions(A_i, r_c)\n\n        # Impute height if missing\n        h_i = impute_height(h_i, cls, class_heights_in_cell, typical_heights)\n\n        # Compute projected width\n        if alpha_i is None:\n            b_width = mean_projected_width(w_i, l_i)\n        else:\n            b_width = projected_width(w_i, l_i, alpha_i, phi)\n\n        F_i = h_i * b_width\n        sum_F += F_i\n        sum_hA += h_i * A_i\n\n    lambda_f = (sum_F / A_cell) if A_cell > 0.0 else 0.0\n    H = (sum_hA / sum_Ai) if sum_Ai > 0.0 else 0.0\n\n    return lambda_p, lambda_f, H\n\ndef format_triplet(triplet):\n    return \"[\" + \",\".join(f\"{x:.6f}\" for x in triplet) + \"]\"\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1\n        {\n            'A_cell': 250000.0,\n            'phi': np.pi / 6.0,\n            'buildings': [\n                {'A': 1200.0, 'w': 30.0, 'l': 40.0, 'alpha': np.pi / 4.0, 'h': 20.0, 'cls': 'commercial'},\n                {'A': 800.0,  'w': 20.0, 'l': 40.0, 'alpha': np.pi / 3.0, 'h': 12.0, 'cls': 'residential'},\n            ],\n        },\n        # Test case 2\n        {\n            'A_cell': 250000.0,\n            'phi': np.pi / 3.0,\n            'buildings': [\n                {'A': 600.0, 'w': 15.0, 'l': 40.0, 'alpha': np.pi / 8.0, 'h': None, 'cls': 'residential'},\n                {'A': 500.0, 'w': 10.0, 'l': 50.0, 'alpha': np.pi / 5.0, 'h': 10.0, 'cls': 'residential'},\n                {'A': 900.0, 'w': 30.0, 'l': 30.0, 'alpha': np.pi / 6.0, 'h': 18.0, 'cls': 'commercial'},\n            ],\n        },\n        # Test case 3\n        {\n            'A_cell': 250000.0,\n            'phi': np.pi / 2.0,\n            'buildings': [\n                {'A': 2000.0, 'w': 25.0, 'l': 80.0, 'alpha': None, 'h': 15.0, 'cls': 'industrial'},\n                {'A': 600.0,  'w': 12.0, 'l': 50.0, 'alpha': None, 'h': None, 'cls': 'residential'},\n            ],\n        },\n        # Test case 4\n        {\n            'A_cell': 250000.0,\n            'phi': 0.0,\n            'buildings': [\n                {'A': 1000.0, 'w': None, 'l': None, 'alpha': np.pi / 4.0, 'h': 20.0, 'cls': 'commercial'},\n                {'A': 1500.0, 'w': None, 'l': None, 'alpha': None, 'h': None, 'cls': 'industrial'},\n            ],\n        },\n        # Test case 5\n        {\n            'A_cell': 250000.0,\n            'phi': np.pi / 2.0,\n            'buildings': [\n                # No buildings\n            ],\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        lp, lf, H = compute_metrics_for_cell(case)\n        results.append([lp, lf, H])\n\n    # Final print statement in the exact required format.\n    formatted = \"[\" + \",\".join(format_triplet(r) for r in results) + \"]\"\n    print(formatted)\n\nsolve()\n```"
        },
        {
            "introduction": "Once the urban form is described, we must understand the thermal behavior of its constituent materials. The storage heat flux ($G$) is a critical component of the urban surface energy balance, representing the capacity of materials like asphalt and concrete to absorb solar radiation during the day and release it at night. This exercise delves into the physics of heat transfer within a solid substrate, guiding you to derive and apply the concepts of thermal diffusivity ($\\alpha$) and diurnal skin depth ($\\delta$) to assess how effectively a simplified single-layer model can represent this crucial thermal inertia .",
            "id": "4107888",
            "problem": "An Urban Canopy Parameterization (UCP) within a Numerical Weather Prediction (NWP) model represents subgrid urban surfaces (roads, roofs, and walls) and their energy exchanges. Consider a road surface composed of asphalt characterized by thermal conductivity $k=0.75\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$ and volumetric heat capacity $C=1.8\\times 10^{6}\\,\\mathrm{J\\,m^{-3}\\,K^{-1}}$. The diurnal cycle of surface temperature is approximated as a sinusoidal forcing with angular frequency $\\omega=7.3\\times 10^{-5}\\,\\mathrm{s^{-1}}$. Starting from the one-dimensional heat diffusion equation for a semi-infinite half-space and fundamental energy conservation, derive the thermal diffusivity $\\alpha$ and the diurnal skin depth $\\delta$ for the asphalt substrate under this periodic forcing. Then, compute numerical values of $\\alpha$ and $\\delta$. Finally, assess whether a single-layer substrate scheme frequently used in UCP, which represents storage heat capacity as a uniform slab of thickness $L_{s}=0.10\\,\\mathrm{m}$, can capture the magnitude of the diurnal storage heat flux. Base your assessment on physically derived relationships between $L_{s}$ and $\\delta$ and provide a quantitative argument.\n\nExpress $\\alpha$ in $\\mathrm{m^{2}\\,s^{-1}}$ and $\\delta$ in $\\mathrm{m}$. Round your numerical values to three significant figures. The final answer must contain only the numerical values of $\\alpha$ and $\\delta$ in that order.",
            "solution": "The problem requires the derivation and calculation of thermal diffusivity $\\alpha$ and diurnal skin depth $\\delta$ for an asphalt substrate, followed by an assessment of a single-layer numerical scheme.\n\nFirst, we address the thermal diffusivity, $\\alpha$. Thermal diffusivity is a material property that measures the rate of transfer of heat from the hot end to the cold end of a material. It is defined as the ratio of the thermal conductivity $k$ to the volumetric heat capacity $C$. The volumetric heat capacity is the product of density $\\rho$ and specific heat capacity $c_p$, so $C = \\rho c_p$. The definition is:\n$$ \\alpha = \\frac{k}{C} $$\nGiven the values for asphalt: thermal conductivity $k=0.75\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$ and volumetric heat capacity $C=1.8\\times 10^{6}\\,\\mathrm{J\\,m^{-3}\\,K^{-1}}$.\nWe can compute the numerical value of $\\alpha$:\n$$ \\alpha = \\frac{0.75\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}}{1.8\\times 10^{6}\\,\\mathrm{J\\,m^{-3}\\,K^{-1}}} \\approx 4.1667 \\times 10^{-7}\\,\\mathrm{m^{2}\\,s^{-1}} $$\nRounding to three significant figures, we get $\\alpha = 4.17 \\times 10^{-7}\\,\\mathrm{m^{2}\\,s^{-1}}$.\n\nNext, we derive the diurnal skin depth, $\\delta$. This requires solving the one-dimensional heat diffusion equation for a semi-infinite solid with a periodic boundary condition at the surface. Let $z$ be the depth coordinate, positive downwards, with the surface at $z=0$. The heat equation is:\n$$ \\frac{\\partial T(z, t)}{\\partial t} = \\alpha \\frac{\\partial^2 T(z, t)}{\\partial z^2} $$\nThe surface temperature is forced by a sinusoidal function with angular frequency $\\omega$. Let the temperature be expressed as $T(z, t) = \\bar{T} + \\theta(z,t)$, where $\\bar{T}$ is the mean temperature and $\\theta(z,t)$ is the temperature perturbation. The boundary condition at the surface is $\\theta(0, t) = \\Delta T \\cos(\\omega t)$, where $\\Delta T$ is the amplitude of the temperature oscillation. We seek a periodic solution that decays with depth. Using complex notation, we can write the boundary condition as $\\theta(0, t) = \\Re\\{\\Delta T \\exp(i\\omega t)\\}$.\nWe look for a solution of the form $\\theta(z, t) = \\Re\\{\\hat{\\theta}(z) \\exp(i\\omega t)\\}$. Substituting this into the heat equation gives an ordinary differential equation for the complex amplitude $\\hat{\\theta}(z)$:\n$$ i\\omega \\hat{\\theta}(z) = \\alpha \\frac{d^2 \\hat{\\theta}(z)}{dz^2} \\implies \\frac{d^2 \\hat{\\theta}}{dz^2} - \\frac{i\\omega}{\\alpha} \\hat{\\theta} = 0 $$\nThe general solution is $\\hat{\\theta}(z) = A\\exp(\\lambda z) + B\\exp(-\\lambda z)$, where $\\lambda^2 = \\frac{i\\omega}{\\alpha}$.\nWe can solve for $\\lambda$:\n$$ \\lambda = \\sqrt{\\frac{i\\omega}{\\alpha}} = \\sqrt{\\frac{\\omega}{\\alpha}}\\sqrt{i} = \\sqrt{\\frac{\\omega}{\\alpha}} \\left(\\frac{1+i}{\\sqrt{2}}\\right) = (1+i)\\sqrt{\\frac{\\omega}{2\\alpha}} $$\nThe physical domain is a semi-infinite half-space, so the temperature perturbation must remain bounded as $z \\rightarrow \\infty$. The term $\\exp(\\lambda z)$ grows exponentially with $z$, so its coefficient $A$ must be $0$. The solution is therefore $\\hat{\\theta}(z) = B\\exp(-\\lambda z)$.\nApplying the surface boundary condition $\\hat{\\theta}(0) = \\Delta T$, we find $B = \\Delta T$. The solution for the complex amplitude is:\n$$ \\hat{\\theta}(z) = \\Delta T \\exp\\left(-(1+i)\\sqrt{\\frac{\\omega}{2\\alpha}} z\\right) = \\Delta T \\exp\\left(-\\sqrt{\\frac{\\omega}{2\\alpha}} z\\right) \\exp\\left(-i\\sqrt{\\frac{\\omega}{2\\alpha}} z\\right) $$\nThe real temperature perturbation is:\n$$ \\theta(z,t) = \\Re\\{\\hat{\\theta}(z)\\exp(i\\omega t)\\} = \\Delta T \\exp\\left(-\\sqrt{\\frac{\\omega}{2\\alpha}} z\\right) \\cos\\left(\\omega t - \\sqrt{\\frac{\\omega}{2\\alpha}}z\\right) $$\nThe amplitude of the temperature wave, $\\Delta T \\exp\\left(-\\sqrt{\\frac{\\omega}{2\\alpha}} z\\right)$, decays exponentially with depth. The diurnal skin depth, $\\delta$, is defined as the depth at which the amplitude of the temperature oscillation decays to $1/e$ of its surface value. This occurs when the argument of the exponential decay term is equal to $-1$:\n$$ -\\sqrt{\\frac{\\omega}{2\\alpha}} \\delta = -1 \\implies \\delta = \\sqrt{\\frac{2\\alpha}{\\omega}} $$\nNow we compute the numerical value of $\\delta$ using the given angular frequency $\\omega=7.3\\times 10^{-5}\\,\\mathrm{s^{-1}}$ and our calculated value of $\\alpha$.\n$$ \\delta = \\sqrt{\\frac{2 \\times (4.1667 \\times 10^{-7}\\,\\mathrm{m^{2}\\,s^{-1}})}{7.3\\times 10^{-5}\\,\\mathrm{s^{-1}}}} = \\sqrt{\\frac{8.3334 \\times 10^{-7}}{7.3\\times 10^{-5}}}\\,\\mathrm{m} \\approx \\sqrt{1.1416 \\times 10^{-2}}\\,\\mathrm{m} \\approx 0.1068\\,\\mathrm{m} $$\nRounding to three significant figures gives $\\delta = 0.107\\,\\mathrm{m}$.\n\nFinally, we must assess whether a single-layer substrate scheme with thickness $L_{s}=0.10\\,\\mathrm{m}$ can capture the magnitude of the diurnal storage heat flux. The skin depth $\\delta$ represents the characteristic depth of the material layer that actively participates in the heat exchange over a diurnal cycle. For a model to accurately represent the thermal inertia and the resulting storage heat flux ($G$), its effective depth should be comparable to the physical penetration depth of the thermal wave.\nThe storage heat flux is determined by the thermal mass that is \"thermally activated\" by the surface forcing. If the model's layer thickness $L_s$ is much smaller than $\\delta$ ($L_s \\ll \\delta$), the model will underestimate the thermal mass, leading to lower thermal inertia, an exaggerated surface temperature range, and an incorrect magnitude and phase of the storage heat flux. Conversely, if $L_s \\gg \\delta$, the model will overestimate the thermal mass by including material that does not experience significant temperature change, leading to excessive damping of the surface temperature wave.\nTherefore, for optimal performance in capturing the diurnal cycle, the slab thickness $L_s$ should be on the order of the skin depth $\\delta$.\nLet's perform the quantitative comparison:\n- Calculated diurnal skin depth: $\\delta \\approx 0.107\\,\\mathrm{m}$.\n- Model single-layer thickness: $L_{s} = 0.10\\,\\mathrm{m}$.\nThe ratio of the model thickness to the physical skin depth is:\n$$ \\frac{L_s}{\\delta} = \\frac{0.10\\,\\mathrm{m}}{0.107\\,\\mathrm{m}} \\approx 0.935 $$\nSince $L_s$ is approximately $93.5\\%$ of $\\delta$, the model slab thickness is very close to the characteristic depth of diurnal heat penetration. This indicates that the single-layer scheme is well-parameterized for this specific frequency and material. It can be expected to provide a good approximation of the available thermal mass and thus capture the magnitude of the diurnal storage heat flux with reasonable accuracy.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n4.17 \\times 10^{-7} & 0.107\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "The geometry of a city not only determines how it absorbs and stores energy but also how efficiently it can dissipate heat and pollutants. The street canyon, a key feature of the urban landscape, often traps air, leading to elevated temperatures and pollutant concentrations. This practice focuses on quantifying the ventilation process, where you will derive a bulk parameterization for the exchange velocity ($U_e$) that connects a canyon's aspect ratio ($H/W$) to the rate of turbulent air exchange with the atmosphere above, providing a crucial link between urban form and its dynamic meteorological function .",
            "id": "4107945",
            "problem": "An urban street canyon of width $W$ and building height $H$ is ventilated by turbulent exchange across the roof-level shear layer driven by a free-stream wind speed above roof level $U_{\\mathrm{top}}$. In the skimming-flow regime, the canyon interior is largely decoupled from the overlying flow, and the roof-level shear layer entrains canyon air at a rate that can be represented by a bulk exchange velocity $U_e$ normal to the roof-level interface. Starting from conservation of mass applied to a two-compartment canyon–atmosphere system and the concept of turbulent shear-layer entrainment, derive a bulk parameterization for $U_e$ in terms of $U_{\\mathrm{top}}$, $H$, $W$, and a dimensionless entrainment coefficient $E_0$ characteristic of turbulent mixing layers. Assume that the scalar exchange is controlled by the shear layer over a single street of unit length, that the interface area per unit street length equals $W$, that the canyon volume per unit street length equals $H W$, and that the mean velocity difference across the shear layer satisfies $\\Delta U \\approx U_{\\mathrm{top}}$ in skimming flow. For deep canyons, justify a geometry dependence of the entrainment coefficient that scales as $E \\sim E_0 \\, (W/H)$, where $E_0$ is a constant of order $10^{-1}$ reflecting the canonical turbulent mixing-layer entrainment rate.\n\nUsing the derived parameterization with $E_0 = 0.08$, compute the numerical value of the bulk exchange velocity for $U_{\\mathrm{top}} = 6\\,\\mathrm{m\\,s^{-1}}$ and aspect ratio $H/W = 2.5$. Then, for a representative street width $W = 20\\,\\mathrm{m}$, estimate the exchange timescale $\\tau = H/U_e$ for heat and moisture ventilation. Express $U_e$ in $\\mathrm{m\\,s^{-1}}$ and $\\tau$ in $\\mathrm{s}$. Round both numerical answers to three significant figures.",
            "solution": "We begin by considering the conservation of mass for a passive scalar with mean concentration $C_c$ within the street canyon. The total mass of the scalar per unit length of the street is $M = C_c V$, where $V = HW$ is the canyon volume per unit length. The rate of change of this mass is determined by the net flux across the roof-level interface of area $A = W$ per unit length.\n$$\n\\frac{d(C_c V)}{dt} = -F_{\\mathrm{net}}\n$$\nAssuming $V$ is constant, this becomes:\n$$\nV \\frac{dC_c}{dt} = -F_{\\mathrm{net}}\n$$\nThe net flux, $F_{\\mathrm{net}}$, is due to the turbulent exchange of air between the canyon and the atmosphere above. This exchange can be parameterized by a volumetric flow rate, $Q$, exchanging canyon air (concentration $C_c$) with atmospheric air (concentration $C_a$).\n$$\nF_{\\mathrm{net}} = Q(C_c - C_a)\n$$\nThe volumetric flow rate $Q$ is defined in terms of a bulk exchange velocity, $U_e$, and the interface area $A$:\n$$\nQ = U_e A\n$$\nThe physical mechanism driving this exchange is the entrainment of canyon air into the turbulent shear layer at the roof level. The volumetric entrainment rate, $Q_{\\mathrm{entrain}}$, is known from fluid dynamics principles to be proportional to the velocity difference across the shear layer, $\\Delta U$, and the area of the layer, $A$. The constant of proportionality is the dimensionless entrainment coefficient, $E$.\n$$\nQ_{\\mathrm{entrain}} = E \\, \\Delta U \\, A\n$$\nBy identifying the parameterized exchange rate $Q$ with the physical entrainment rate $Q_{\\mathrm{entrain}}$, we have:\n$$\nU_e A = E \\, \\Delta U \\, A\n$$\nThis simplifies to a direct relationship for the bulk exchange velocity:\n$$\nU_e = E \\, \\Delta U\n$$\nThe problem specifies that for the skimming-flow regime, the velocity difference across the layer can be approximated by the free-stream wind speed above the canyon, $\\Delta U \\approx U_{\\mathrm{top}}$.\n$$\nU_e = E \\, U_{\\mathrm{top}}\n$$\nNext, we incorporate the geometry dependence for deep canyons. The problem states that the effective entrainment coefficient $E$ for the entire canyon scales with the canonical mixing-layer coefficient $E_0$ and the canyon aspect ratio. The justification for the given scaling, $E \\sim E_0 (W/H)$, is that while the fundamental entrainment process (characterized by $E_0$) occurs at the roof-level shear layer, its ability to ventilate the *entire* canyon volume $V=HW$ is diminished in deep, narrow canyons. The efficiency of the exchange is thus inversely proportional to the aspect ratio $H/W$.\nSubstituting this geometric scaling, $E = E_0 \\left(\\frac{W}{H}\\right)$, into our expression for $U_e$ yields the final derived parameterization:\n$$\nU_e = E_0 \\left(\\frac{W}{H}\\right) U_{\\mathrm{top}}\n$$\n**Numerical Calculation**\nWe are asked to compute the numerical value of $U_e$ and the exchange timescale $\\tau$.\n\nFirst, we calculate $U_e$. The given parameters are:\n-   $E_0 = 0.08$\n-   $U_{\\mathrm{top}} = 6\\,\\mathrm{m\\,s^{-1}}$\n-   Aspect ratio $H/W = 2.5$. This implies the inverse ratio is $W/H = \\frac{1}{2.5} = 0.4$.\n\nSubstituting these values into the derived parameterization:\n$$\nU_e = (0.08) \\times (0.4) \\times (6\\,\\mathrm{m\\,s^{-1}})\n$$\n$$\nU_e = 0.032 \\times 6\\,\\mathrm{m\\,s^{-1}} = 0.192\\,\\mathrm{m\\,s^{-1}}\n$$\nRounding to three significant figures, the value is $0.192\\,\\mathrm{m\\,s^{-1}}$.\n\nNext, we calculate the exchange timescale $\\tau = H/U_e$. For this calculation, we are given a representative street width $W = 20\\,\\mathrm{m}$. Using the aspect ratio $H/W = 2.5$, we find the building height:\n$$\nH = 2.5 \\times W = 2.5 \\times 20\\,\\mathrm{m} = 50\\,\\mathrm{m}\n$$\nNow, we can compute $\\tau$ using the calculated value of $U_e$:\n$$\n\\tau = \\frac{H}{U_e} = \\frac{50\\,\\mathrm{m}}{0.192\\,\\mathrm{m\\,s^{-1}}} \\approx 260.4166\\ldots\\,\\mathrm{s}\n$$\nRounding this result to three significant figures gives:\n$$\n\\tau \\approx 260\\,\\mathrm{s}\n$$\nThe final numerical answers are $U_e = 0.192\\,\\mathrm{m\\,s^{-1}}$ and $\\tau = 260\\,\\mathrm{s}$.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0.192 & 260 \\end{pmatrix}}\n$$"
        }
    ]
}