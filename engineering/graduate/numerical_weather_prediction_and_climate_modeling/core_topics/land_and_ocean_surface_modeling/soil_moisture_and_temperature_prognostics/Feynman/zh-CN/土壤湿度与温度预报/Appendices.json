{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握土壤水分和温度的预报，最有效的方法莫过于从基本原理出发，亲手构建一个数值模型。本练习旨在引导您完成这一过程，将水分和能量的守恒定律转化为一个可运行的、基于有限体积法和隐式时间步长的代码 ()。通过完成这个实践，您不仅能加深对控制方程的理解，还能掌握将理论物理离散化为计算方案的核心技能，这是任何气候和天气建模者必备的基础。",
            "id": "4090020",
            "problem": "在数值天气预报 (NWP) 和气候模拟的框架内，考虑一个一维垂直土壤柱，用于土壤体积含水量和温度的预报模拟。垂直坐标用 $z$ 表示，从地表向下增加，其定义域为 $z \\in [0,H]$。将该土壤柱离散为 $N$ 个厚度为 $\\Delta z = H/N$ 的等间距有限体积单元，单元中心的未知量由 $i \\in \\{1,\\dots,N\\}$ 索引，位于深度 $z_i = (i - 1/2)\\Delta z$ 处。时间以均匀时间步长 $\\Delta t$ 和整数步 $n \\in \\{0,1,2,\\dots\\}$ 进行离散。\n\n预报变量为土壤体积含水量 $\\,\\theta(z,t)$（无量纲，$\\mathrm{m^3/m^3}$）和土壤温度 $\\,T(z,t)$（开尔文，$\\mathrm{K}$）。建模的基本依据包括：\n- 水的质量守恒：对于一个控制体积，$\\,\\theta$ 的变化率等于水通量的散度。\n- 能量守恒：对于一个控制体积，内能的变化率等于热通量的散度。\n- 水的 Fick 扩散定律：扩散水通量为 $\\,F_\\theta = -D\\,\\partial \\theta/\\partial z$，其中 $\\,D$ 是有效扩散率（假设为常数且空间均匀）。\n- Fourier 热传导定律：传导热通量为 $\\,F_T = -k\\,\\partial T/\\partial z$，其中 $\\,k$ 是热导率。\n\n假设在地表 $z=0$ 和底部 $z=H$ 处有以下边界条件：\n- 水通量边界条件：在地表，施加一个指定的入渗（向下为正）或蒸发（向上为负）通量 $\\,q_{\\text{in}}$（单位 $\\mathrm{m\\,s^{-1}}$），即 $\\,F_\\theta(0,t) = q_{\\text{in}}$；在底部，无水通量，即 $\\,F_\\theta(H,t) = 0$。\n- 热通量边界条件：在地表，传导边界条件中施加一个指定的向下净热通量 $\\,Q_{\\text{surf}}$（单位 $\\mathrm{W\\,m^{-2}}$），即 $\\,F_T(0,t) = Q_{\\text{surf}}$；在底部，绝热，即 $\\,F_T(H,t) = 0$。\n\n设体积热容 $\\,c_v$（单位 $\\mathrm{J\\,m^{-3}\\,K^{-1}}$）为常数。为在热传导中包含湿度依赖性而不引入非线性，定义每个时间步内的土壤热导率在空间上是均匀的，并且依赖于新时间步的柱平均含水量，即\n$$\nk^{n+1} = k_{\\text{dry}} + c_k\\,\\bar{\\theta}^{\\,n+1}, \\quad \\text{其中} \\quad \\bar{\\theta}^{\\,n+1} = \\frac{1}{N}\\sum_{i=1}^N \\theta_i^{\\,n+1}.\n$$\n\n从上述守恒声明和本构关系出发，推导出一个具有单元中心未知量和面中心扩散通量的有限体积空间离散格式。使用后向（隐式）欧拉时间步进法。单元 $i$ 中的离散含水量更新必须遵循通用的有限体积平衡方程\n$$\n\\theta_i^{\\,n+1} - \\theta_i^{\\,n} = \\frac{\\Delta t}{\\Delta z}\\left(F_{\\theta,\\,i-\\frac{1}{2}}^{\\,n+1} - F_{\\theta,\\,i+\\frac{1}{2}}^{\\,n+1}\\right),\n$$\n其中内部扩散通量使用中心差分，边界通量使用指定值。离散温度更新必须遵循\n$$\nc_v\\left(T_i^{\\,n+1} - T_i^{\\,n}\\right) = \\frac{\\Delta t}{\\Delta z}\\left(F_{T,\\,i-\\frac{1}{2}}^{\\,n+1} - F_{T,\\,i+\\frac{1}{2}}^{\\,n+1}\\right),\n$$\n其中内部热通量使用中心差分，边界通量使用指定值，并且 $\\,k^{n+1}$ 是根据时间 $n+1$ 时更新的含水量场计算得出的。\n\n在每个时间步实施算子分裂法：首先隐式更新 $\\,\\theta^{\\,n+1}$，然后根据更新后的 $\\,\\bar{\\theta}^{\\,n+1}$ 计算 $\\,k^{\\,n+1}$，最后在该步中使用 $\\,k^{\\,n+1}$ 隐式更新 $\\,T^{\\,n+1}$。\n\n初始化：对所有单元 $i$，设置 $\\,\\theta_i^{\\,0} = \\theta_0$ 和 $\\,T_i^{\\,0} = T_0$。除非另有说明，所有参数在时间上是常数，在空间上是均匀的。使用以下测试套件，其中指定了 $\\,H$、$\\,N$、$\\,\\Delta t$、时间步数 $\\,M$、$\\,D$、$\\,q_{\\text{in}}$、$\\,c_v$、$\\,k_{\\text{dry}}$、$\\,c_k$、$\\,Q_{\\text{surf}}$、$\\,\\theta_0$ 和 $\\,T_0$。所有量均采用国际单位制 (SI)，其中 $\\,\\theta$ 以 $\\mathrm{m^3/m^3}$ 表示，$\\,T$ 以 $\\mathrm{K}$ 表示。\n\n测试套件参数：\n- 案例 $\\,A$ (一般情景): $\\,H = 1.0\\,\\mathrm{m}$, $\\,N = 10$, $\\,\\Delta t = 3600\\,\\mathrm{s}$, $\\,M = 24$, $\\,D = 1.0\\times 10^{-6}\\,\\mathrm{m^2\\,s^{-1}}$, $\\,q_{\\text{in}} = 1.0\\times 10^{-7}\\,\\mathrm{m\\,s^{-1}}$, $\\,c_v = 2.5\\times 10^{6}\\,\\mathrm{J\\,m^{-3}\\,K^{-1}}$, $\\,k_{\\text{dry}} = 0.30\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$, $\\,c_k = 2.0\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$, $\\,Q_{\\text{surf}} = 50.0\\,\\mathrm{W\\,m^{-2}}$, $\\,\\theta_0 = 0.25\\,\\mathrm{m^3/m^3}$, $\\,T_0 = 285.0\\,\\mathrm{K}$。\n- 案例 $\\,B$ (蒸发和冷却情景): $\\,H = 1.0\\,\\mathrm{m}$, $\\,N = 8$, $\\,\\Delta t = 3600\\,\\mathrm{s}$, $\\,M = 48$, $\\,D = 1.0\\times 10^{-6}\\,\\mathrm{m^2\\,s^{-1}}$, $\\,q_{\\text{in}} = -5.0\\times 10^{-8}\\,\\mathrm{m\\,s^{-1}}$, $\\,c_v = 2.5\\times 10^{6}\\,\\mathrm{J\\,m^{-3}\\,K^{-1}}$, $\\,k_{\\text{dry}} = 0.30\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$, $\\,c_k = 2.0\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$, $\\,Q_{\\text{surf}} = -20.0\\,\\mathrm{W\\,m^{-2}}$, $\\,\\theta_0 = 0.22\\,\\mathrm{m^3/m^3}$, $\\,T_0 = 290.0\\,\\mathrm{K}$。\n- 案例 $\\,C$ (零通量一致性检验): $\\,H = 1.0\\,\\mathrm{m}$, $\\,N = 20$, $\\,\\Delta t = 7200\\,\\mathrm{s}$, $\\,M = 12$, $\\,D = 5.0\\times 10^{-7}\\,\\mathrm{m^2\\,s^{-1}}$, $\\,q_{\\text{in}} = 0.0\\,\\mathrm{m\\,s^{-1}}$, $\\,c_v = 2.5\\times 10^{6}\\,\\mathrm{J\\,m^{-3}\\,K^{-1}}$, $\\,k_{\\text{dry}} = 0.30\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$, $\\,c_k = 2.0\\,\\mathrm{W\\,m^{-1}\\,K^{-1}}$, $\\,Q_{\\text{surf}} = 0.0\\,\\mathrm{W\\,m^{-2}}$, $\\,\\theta_0 = 0.25\\,\\mathrm{m^3/m^3}$, $\\,T_0 = 285.0\\,\\mathrm{K}$。\n\n对于每个案例，在演化 $\\,M$ 步后，报告以下输出：\n- 柱平均土壤含水量 $\\,\\bar{\\theta}^{\\,M}$（单位 $\\mathrm{m^3/m^3}$），作为浮点数，四舍五入保留六位小数。\n- 顶层土壤温度 $\\,T_1^{\\,M}$（单位 $\\mathrm{K}$），作为浮点数，四舍五入保留六位小数。\n\n您的程序应生成单行输出，其中包含一个方括号括起来的逗号分隔列表形式的结果，每个案例的结果本身是一个包含两个浮点数的列表，顺序为 $[\\bar{\\theta}^{\\,M}, T_1^{\\,M}]$，分别对应案例 $A$、$B$ 和 $C$。例如，输出格式必须与 $[[x_A,y_A],[x_B,y_B],[x_C,y_C]]$ 完全一致，不含空格，每个浮点数四舍五入保留六位小数。确保所有内部计算都遵循国际单位制 (SI)，并且报告的输出中 $\\,\\bar{\\theta}^{\\,M}$ 的单位为 $\\mathrm{m^3/m^3}$，$\\,T_1^{\\,M}$ 的单位为 $\\mathrm{K}$。",
            "solution": "问题被评估为有效。它在科学上基于热质传递原理，在数学上是适定的，并以客观、正式的语言进行描述。唯一数值解所需的所有必要参数和条件均已提供。我们着手进行数值方案的推导和实现。\n\n该问题要求采用算子分裂法，在每个时间步顺序更新土壤体积含水量 $\\theta$ 和土壤温度 $T$。两个更新过程都涉及使用有限体积法和隐式（后向欧拉）时间步进格式求解一维扩散型方程。\n\n### 第1部分：含水量方程的离散化\n\n结合质量守恒和 Fick 定律的水分输运控制偏微分方程为：\n$$\n\\frac{\\partial \\theta}{\\partial t} = -\\frac{\\partial F_\\theta}{\\partial z} = \\frac{\\partial}{\\partial z}\\left(D \\frac{\\partial \\theta}{\\partial z}\\right)\n$$\n由于扩散率 $D$ 是常数，方程简化为标准扩散方程：\n$$\n\\frac{\\partial \\theta}{\\partial t} = D \\frac{\\partial^2 \\theta}{\\partial z^2}\n$$\n问题指定了单元 $i$ 的有限体积离散格式：\n$$\n\\frac{\\theta_i^{\\,n+1} - \\theta_i^{\\,n}}{\\Delta t} = \\frac{1}{\\Delta z}\\left(F_{\\theta,\\,i-\\frac{1}{2}}^{\\,n+1} - F_{\\theta,\\,i+\\frac{1}{2}}^{\\,n+1}\\right)\n$$\n由于采用隐式格式，通量在新的时间步 $n+1$ 进行计算。内部通量使用相邻单元中心之间的中心差分进行近似：\n$$\nF_{\\theta,\\,i+\\frac{1}{2}}^{\\,n+1} = -D \\frac{\\theta_{i+1}^{n+1} - \\theta_i^{n+1}}{\\Delta z}\n$$\n将此代入内部单元（$i \\in \\{2, \\dots, N-1\\}$）的有限体积方程，得到：\n$$\n\\theta_i^{\\,n+1} - \\theta_i^{\\,n} = \\frac{\\Delta t}{\\Delta z}\\left( \\left(-D \\frac{\\theta_i^{n+1} - \\theta_{i-1}^{n+1}}{\\Delta z}\\right) - \\left(-D \\frac{\\theta_{i+1}^{n+1} - \\theta_i^{n+1}}{\\Delta z}\\right) \\right)\n$$\n$$\n\\theta_i^{\\,n+1} - \\theta_i^{\\,n} = \\frac{D \\Delta t}{(\\Delta z)^2} \\left( \\theta_{i-1}^{n+1} - 2\\theta_i^{n+1} + \\theta_{i+1}^{n+1} \\right)\n$$\n我们定义无量纲的含水量扩散数为 $\\alpha_\\theta = \\frac{D \\Delta t}{(\\Delta z)^2}$。整理各项，将时间 $n+1$ 的所有未知量置于等式左侧，得到内部单元的方程：\n$$\n-\\alpha_\\theta \\theta_{i-1}^{n+1} + (1 + 2\\alpha_\\theta)\\theta_i^{n+1} - \\alpha_\\theta \\theta_{i+1}^{n+1} = \\theta_i^n\n$$\n对于边界单元，我们引入指定的通量：\n对于顶部单元（$i=1$）：在面 $i-\\frac{1}{2}=1/2$ 处的通量为指定的地表通量，$F_{\\theta,\\,1/2}^{\\,n+1} = q_{\\text{in}}$。\n$$\n\\theta_1^{\\,n+1} - \\theta_1^{\\,n} = \\frac{\\Delta t}{\\Delta z}\\left( q_{\\text{in}} - \\left(-D \\frac{\\theta_2^{n+1} - \\theta_1^{n+1}}{\\Delta z}\\right) \\right)\n$$\n整理后得到：\n$$\n\\theta_1^{\\,n+1} - \\alpha_\\theta(\\theta_2^{n+1} - \\theta_1^{n+1}) = \\theta_1^n + \\frac{q_{\\text{in}} \\Delta t}{\\Delta z}\n$$\n$$\n(1 + \\alpha_\\theta)\\theta_1^{n+1} - \\alpha_\\theta \\theta_2^{n+1} = \\theta_1^n + \\frac{q_{\\text{in}} \\Delta t}{\\Delta z}\n$$\n对于底部单元（$i=N$）：在面 $i+\\frac{1}{2}=N+1/2$ 处的通量指定为零，$F_{\\theta,\\,N+1/2}^{\\,n+1} = 0$。\n$$\n\\theta_N^{\\,n+1} - \\theta_N^{\\,n} = \\frac{\\Delta t}{\\Delta z}\\left( \\left(-D \\frac{\\theta_N^{n+1} - \\theta_{N-1}^{n+1}}{\\Delta z}\\right) - 0 \\right)\n$$\n整理后得到：\n$$\n\\theta_N^{\\,n+1} + \\alpha_\\theta(\\theta_N^{n+1} - \\theta_{N-1}^{n+1}) = \\theta_N^n\n$$\n$$\n-\\alpha_\\theta \\theta_{N-1}^{n+1} + (1 + \\alpha_\\theta)\\theta_N^{n+1} = \\theta_N^n\n$$\n这 $N$ 个线性方程构成一个三对角系统 $A_\\theta \\boldsymbol{\\theta}^{n+1} = \\mathbf{b}_\\theta$，该系统可以被高效求解，从而得到更新后的含水量廓线 $\\boldsymbol{\\theta}^{n+1} = [\\theta_1^{n+1}, \\dots, \\theta_N^{n+1}]^T$。\n\n### 第2部分：土壤热导率的更新\n\n按照算子分裂法的步骤，一旦 $\\boldsymbol{\\theta}^{n+1}$ 计算得出，就可以计算当前时间步的土壤热导率 $k^{n+1}$。它依赖于新时间步的柱平均含水量：\n$$\n\\bar{\\theta}^{\\,n+1} = \\frac{1}{N}\\sum_{i=1}^N \\theta_i^{\\,n+1}\n$$\n$$\nk^{n+1} = k_{\\text{dry}} + c_k\\,\\bar{\\theta}^{\\,n+1}\n$$\n这个 $k^{n+1}$ 的值在随后的温度更新中被视为一个常数标量。\n\n### 第3部分：温度方程的离散化\n\n结合能量守恒、Fourier 定律以及恒定的体积热容 $c_v$，热传递的控制方程为：\n$$\nc_v \\frac{\\partial T}{\\partial t} = -\\frac{\\partial F_T}{\\partial z} = \\frac{\\partial}{\\partial z}\\left( k \\frac{\\partial T}{\\partial z} \\right)\n$$\n使用刚计算出的 $k^{n+1}$（在此步中空间上为常数），我们得到：\n$$\n\\frac{\\partial T}{\\partial t} = \\frac{k^{n+1}}{c_v} \\frac{\\partial^2 T}{\\partial z^2}\n$$\n其有限体积离散化过程与含水量的离散化过程类似：\n$$\nc_v(T_i^{\\,n+1} - T_i^{\\,n}) = \\frac{\\Delta t}{\\Delta z}\\left(F_{T,\\,i-\\frac{1}{2}}^{\\,n+1} - F_{T,\\,i+\\frac{1}{2}}^{\\,n+1}\\right)\n$$\n其结构与水分方程相同，其中热扩散率为 $\\kappa^{n+1} = k^{n+1}/c_v$。我们定义一个热扩散数 $\\alpha_T^{n+1} = \\frac{k^{n+1} \\Delta t}{c_v (\\Delta z)^2}$。离散方程如下：\n对于内部单元（$i \\in \\{2, \\dots, N-1\\}$）：\n$$\n-\\alpha_T^{n+1} T_{i-1}^{n+1} + (1 + 2\\alpha_T^{n+1})T_i^{n+1} - \\alpha_T^{n+1} T_{i+1}^{n+1} = T_i^n\n$$\n对于顶部单元（$i=1$），地表热通量为 $F_{T,\\,1/2}^{\\,n+1} = Q_{\\text{surf}}$：\n$$\n(1 + \\alpha_T^{n+1})T_1^{n+1} - \\alpha_T^{n+1} T_2^{n+1} = T_1^n + \\frac{Q_{\\text{surf}} \\Delta t}{c_v \\Delta z}\n$$\n对于底部单元（$i=N$），底部热通量为零：\n$$\n-\\alpha_T^{n+1} T_{N-1}^{n+1} + (1 + \\alpha_T^{n+1})T_N^{n+1} = T_N^n\n$$\n这同样构成一个三对角系统 $A_T \\mathbf{T}^{n+1} = \\mathbf{b}_T$，求解该系统可得到更新后的温度廓线 $\\mathbf{T}^{n+1} = [T_1^{n+1}, \\dots, T_N^{n+1}]^T$。\n\n### 算法总结\n对从 $n=0$ 到 $M-1$ 的每个时间步：\n1.  **含水量更新**:\n    a. 使用上一步的 $\\boldsymbol{\\theta}^n$ 值，构造三对角矩阵 $A_\\theta$ 和右侧向量 $\\mathbf{b}_\\theta$。\n    b. 求解线性系统 $A_\\theta \\boldsymbol{\\theta}^{n+1} = \\mathbf{b}_\\theta$ 以获得 $\\boldsymbol{\\theta}^{n+1}$。\n2.  **热导率更新**:\n    a. 根据 $\\boldsymbol{\\theta}^{n+1}$ 计算平均含水量 $\\bar{\\theta}^{n+1}$。\n    b. 计算热导率 $k^{n+1} = k_{\\text{dry}} + c_k \\bar{\\theta}^{n+1}$。\n3.  **温度更新**:\n    a. 使用 $\\mathbf{T}^n$ 的值和新计算出的 $k^{n+1}$，构造三对角矩阵 $A_T$ 和右侧向量 $\\mathbf{b}_T$。\n    b. 求解线性系统 $A_T \\mathbf{T}^{n+1} = \\mathbf{b}_T$ 以获得 $\\mathbf{T}^{n+1}$。\n4.  为下一次迭代设置 $\\boldsymbol{\\theta}^n \\leftarrow \\boldsymbol{\\theta}^{n+1}$ 和 $\\mathbf{T}^n \\leftarrow \\mathbf{T}^{n+1}$。\n\n该过程重复 $M$ 个时间步。最终要求的输出是 $\\bar{\\theta}^M$ 和 $T_1^M$。实现将使用 `scipy.linalg.solve_banded` 来高效求解三对角系统。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef solve():\n    \"\"\"\n    Solves the soil moisture and temperature prognostics problem for three test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A\n        {'H': 1.0, 'N': 10, 'dt': 3600.0, 'M': 24, 'D': 1.0e-6, 'q_in': 1.0e-7,\n         'c_v': 2.5e6, 'k_dry': 0.30, 'c_k': 2.0, 'Q_surf': 50.0, 'theta0': 0.25, 'T0': 285.0},\n        # Case B\n        {'H': 1.0, 'N': 8, 'dt': 3600.0, 'M': 48, 'D': 1.0e-6, 'q_in': -5.0e-8,\n         'c_v': 2.5e6, 'k_dry': 0.30, 'c_k': 2.0, 'Q_surf': -20.0, 'theta0': 0.22, 'T0': 290.0},\n        # Case C\n        {'H': 1.0, 'N': 20, 'dt': 7200.0, 'M': 12, 'D': 5.0e-7, 'q_in': 0.0,\n         'c_v': 2.5e6, 'k_dry': 0.30, 'c_k': 2.0, 'Q_surf': 0.0, 'theta0': 0.25, 'T0': 285.0},\n    ]\n\n    final_results = []\n\n    for params in test_cases:\n        # Unpack parameters\n        H = params['H']\n        N = params['N']\n        dt = params['dt']\n        M = params['M']\n        D = params['D']\n        q_in = params['q_in']\n        c_v = params['c_v']\n        k_dry = params['k_dry']\n        c_k = params['c_k']\n        Q_surf = params['Q_surf']\n        theta0 = params['theta0']\n        T0 = params['T0']\n\n        # Discretization parameters\n        dz = H / N\n\n        # Initialize state vectors\n        theta = np.full(N, theta0)\n        T = np.full(N, T0)\n\n        # Pre-calculate alpha for water content (constant in time)\n        alpha_theta = D * dt / (dz**2)\n\n        # --- Time-stepping loop ---\n        for _ in range(M):\n            # === 1. Update water content theta ===\n            # Setup tridiagonal system for theta: A_theta * theta_new = b_theta\n            \n            A_theta_banded = np.zeros((3, N))\n            # Main diagonal\n            A_theta_banded[1, :] = 1.0 + 2.0 * alpha_theta\n            A_theta_banded[1, 0] = 1.0 + alpha_theta\n            A_theta_banded[1, -1] = 1.0 + alpha_theta\n            # Upper diagonal\n            A_theta_banded[0, 1:] = -alpha_theta\n            # Lower diagonal\n            A_theta_banded[2, :-1] = -alpha_theta\n\n            # RHS vector b_theta\n            b_theta = np.copy(theta)\n            b_theta[0] += q_in * dt / dz\n\n            # Solve for new theta\n            theta = solve_banded((1, 1), A_theta_banded, b_theta)\n\n            # === 2. Update thermal conductivity k ===\n            theta_mean = np.mean(theta)\n            k_new = k_dry + c_k * theta_mean\n\n            # === 3. Update temperature T ===\n            # Calculate alpha for temperature (changes with k_new)\n            alpha_T = k_new * dt / (c_v * dz**2)\n\n            # Setup tridiagonal system for T: A_T * T_new = b_T\n            A_T_banded = np.zeros((3, N))\n            # Main diagonal\n            A_T_banded[1, :] = 1.0 + 2.0 * alpha_T\n            A_T_banded[1, 0] = 1.0 + alpha_T\n            A_T_banded[1, -1] = 1.0 + alpha_T\n            # Upper diagonal\n            A_T_banded[0, 1:] = -alpha_T\n            # Lower diagonal\n            A_T_banded[2, :-1] = -alpha_T\n\n            # RHS vector b_T\n            b_T = np.copy(T)\n            b_T[0] += Q_surf * dt / (c_v * dz)\n\n            # Solve for new T\n            T = solve_banded((1, 1), A_T_banded, b_T)\n\n        # Store final results for the case\n        final_theta_mean = np.mean(theta)\n        final_T1 = T[0]\n        final_results.append([round(final_theta_mean, 6), round(final_T1, 6)])\n\n    # Format the final output string exactly as required\n    output_str = f\"[[{','.join([f'[{r[0]:.6f},{r[1]:.6f}]' for r in final_results])}]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "一个稳健的土壤模型必须能准确地处理关键的物理过程，尤其是在高纬度地区至关重要的土壤冻融。本练习 () 聚焦于能量守恒原理在一个具体情景中的应用：计算土壤冻结过程中的相变。通过这个集中的计算，您将量化冷却和冻结所需的能量收支，深刻理解潜热在土壤热力学中所扮演的关键角色。",
            "id": "4090036",
            "problem": "在一个数值天气预报和气候模拟系统的陆面分量中，一个厚度为 $H$ 的垂直均质土壤层被表示为一个用于描述温度和相态的单一、混合均匀的控制体。该土层初始温度为 $T_0$，体积液态水含量为 $\\theta_w$，冰含量可忽略不计。在时间 $t=0$ 时，地表受到一个恒定的、强加的净热通量 $F$（向下为正），且该土层的下边界是绝热的。假设在所关心的时间间隔内，该土层保持混合均匀，且过冷现象可忽略不计，因此平衡冻结温度为 $T_f$。\n\n利用该控制体的能量守恒和熔解潜热的定义，在以下物理上合理的参数值下，确定在时间间隔 $\\Delta t$ 内冻结的初始液态水的比例：\n- 土层厚度 $H = 0.10$ 米\n- 初始温度 $T_0 = 0.5$ $\\mathrm{^\\circ C}$，冻结温度 $T_f = 0.0$ $\\mathrm{^\\circ C}$\n- 体积液态水含量 $\\theta_w = 0.30$\n- 干土容重 $\\rho_s = 1600$ $\\mathrm{kg\\,m^{-3}}$，干土比热 $c_s = 800$ $\\mathrm{J\\,kg^{-1}\\,K^{-1}}$\n- 水密度 $\\rho_w = 1000$ $\\mathrm{kg\\,m^{-3}}$，液态水比热 $c_w = 4186$ $\\mathrm{J\\,kg^{-1}\\,K^{-1}}$\n- 水的熔解潜热 $L_f = 3.34 \\times 10^{5}$ $\\mathrm{J\\,kg^{-1}}$\n- 强加的净地表热通量 $F = -50$ $\\mathrm{W\\,m^{-2}}$（负值表示向上，从土层中移除能量），作用时间为 $\\Delta t = 3$ 小时\n\n假设在 $T_f$ 的潜热平台期间，显热容量不随相态变化，并忽略任何低于 $T_f$ 的未冻水保留。陈述您所做的任何额外假设。将最终结果表示为冻结的初始液态水的小数比例（无量纲）。将您的答案四舍五入到四位有效数字。",
            "solution": "问题要求确定在给定的时间间隔内，在地表恒定向上热通量的作用下，土壤层中初始液态水冻结的比例。解决方案将基于应用于土壤层的能量守恒原理，该土壤层被视为单一、混合均匀的控制体。\n\n能量平衡涉及一个两阶段过程。首先，必须从土壤层（包括土壤基质和液态水）中移除显热，使其从初始温度 $T_0$ 冷却到冻结温度 $T_f$。其次，一旦土层达到冰点，任何进一步的能量移除都将导致液态水发生相变成为冰，并释放熔解潜热。\n\n让我们以单位面积为基础来定义系统。控制体是一个厚度为 $H$、单位面积为（$1\\,\\mathrm{m^2}$）的土柱。\n\n首先，我们计算在时间间隔 $\\Delta t$ 内，从单位面积的土壤层中移除的总能量 $Q_{total}$。地表热通量 $F$ 是单位面积的能量传输速率。$F$ 的负值表示向上的通量，意味着能量正在从系统中移除。\n$$\nQ_{total} = |F| \\Delta t\n$$\n给定的值为 $F = -50\\,\\mathrm{W\\,m^{-2}}$（所以 $|F| = 50\\,\\mathrm{J\\,s^{-1}\\,m^{-2}}$）以及 $\\Delta t = 3\\,\\mathrm{hours}$。我们必须将时间间隔转换为秒：\n$$\n\\Delta t = 3\\,\\mathrm{h} \\times \\frac{3600\\,\\mathrm{s}}{1\\,\\mathrm{h}} = 10800\\,\\mathrm{s}\n$$\n因此，移除的总能量为：\n$$\nQ_{total} = (50\\,\\mathrm{J\\,s^{-1}\\,m^{-2}}) \\times (10800\\,\\mathrm{s}) = 540000\\,\\mathrm{J\\,m^{-2}} = 5.4 \\times 10^5\\,\\mathrm{J\\,m^{-2}}\n$$\n\n接下来，我们计算将整个土层从 $T_0$ 冷却到 $T_f$ 所需的能量。这是显热变化量 $Q_{sensible}$。为此，我们首先需要整体土壤的体积热容量 $C_{vol}$。问题提供了干土容重 $\\rho_s$（单位总体积的土壤固体质量）和体积液态水含量 $\\theta_w$（单位总体积的水的体积）。体积热容量是单位体积内各组分容量的总和：\n$$\nC_{vol} = \\rho_s c_s + \\theta_w \\rho_w c_w\n$$\n使用所提供的值：\n$\\rho_s = 1600\\,\\mathrm{kg\\,m^{-3}}$，$c_s = 800\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$\n$\\theta_w = 0.30$，$\\rho_w = 1000\\,\\mathrm{kg\\,m^{-3}}$，$c_w = 4186\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$\n$$\nC_{vol} = (1600\\,\\mathrm{kg\\,m^{-3}} \\times 800\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}) + (0.30 \\times 1000\\,\\mathrm{kg\\,m^{-3}} \\times 4186\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}})\n$$\n$$\nC_{vol} = 1280000\\,\\mathrm{J\\,m^{-3}\\,K^{-1}} + 1255800\\,\\mathrm{J\\,m^{-3}\\,K^{-1}} = 2535800\\,\\mathrm{J\\,m^{-3}\\,K^{-1}}\n$$\n将厚度为 $H = 0.10\\,\\mathrm{m}$ 的土层从 $T_0 = 0.5\\,\\mathrm{^\\circ C}$ 冷却到 $T_f = 0.0\\,\\mathrm{^\\circ C}$，每单位面积必须移除的总显热为：\n$$\nQ_{sensible} = C_{vol} H (T_0 - T_f)\n$$\n温差为 $(T_0 - T_f) = 0.5\\,\\mathrm{^\\circ C} - 0.0\\,\\mathrm{^\\circ C} = 0.5\\,\\mathrm{K}$。\n$$\nQ_{sensible} = (2535800\\,\\mathrm{J\\,m^{-3}\\,K^{-1}}) \\times (0.10\\,\\mathrm{m}) \\times (0.5\\,\\mathrm{K}) = 126790\\,\\mathrm{J\\,m^{-2}}\n$$\n\n剩余用于引起冻结的能量 $Q_{latent}$ 是移除的总能量减去移除的显热：\n$$\nQ_{latent} = Q_{total} - Q_{sensible}\n$$\n$$\nQ_{latent} = 540000\\,\\mathrm{J\\,m^{-2}} - 126790\\,\\mathrm{J\\,m^{-2}} = 413210\\,\\mathrm{J\\,m^{-2}}\n$$\n由于 $Q_{latent} > 0$，在土层达到 $T_f$ 后，有足够的能量被移除以引发冻结。\n\n这种潜热的移除导致质量为 $m_{ice}$ 的冰形成。其关系由熔解潜热 $L_f$ 给出：\n$$\nQ_{latent} = m_{ice} L_f\n$$\n求解每单位面积形成的冰的质量：\n$$\nm_{ice} = \\frac{Q_{latent}}{L_f} = \\frac{413210\\,\\mathrm{J\\,m^{-2}}}{3.34 \\times 10^5\\,\\mathrm{J\\,kg^{-1}}} \\approx 1.237156\\,\\mathrm{kg\\,m^{-2}}\n$$\n\n为了求出冻结的水的比例，我们必须将这个质量与土层中单位面积的初始液态水质量 $m_{w,initial}$ 进行比较。单位面积的初始水量为 $\\theta_w H$。\n$$\nm_{w,initial} = \\theta_w H \\rho_w = (0.30) \\times (0.10\\,\\mathrm{m}) \\times (1000\\,\\mathrm{kg\\,m^{-3}}) = 30\\,\\mathrm{kg\\,m^{-2}}\n$$\n\n最后，冻结的初始液态水的比例 $f_{ice}$ 是形成的冰的质量与初始水的质量之比：\n$$\nf_{ice} = \\frac{m_{ice}}{m_{w,initial}}\n$$\n$$\nf_{ice} = \\frac{1.237156\\,\\mathrm{kg\\,m^{-2}}}{30\\,\\mathrm{kg\\,m^{-2}}} \\approx 0.0412385\n$$\n问题要求将结果四舍五入到四位有效数字。\n$$\nf_{ice} \\approx 0.04124\n$$\n\n这些步骤可以用一个符号表达式来概括：\n$$\nf_{ice} = \\frac{|F| \\Delta t - (\\rho_s c_s + \\theta_w \\rho_w c_w) H (T_0 - T_f)}{L_f \\theta_w H \\rho_w}\n$$\n代入所有数值可以验证结果。需要注意的是，我们假设材料属性（$\\rho_s, c_s, \\rho_w, c_w, L_f$）是恒定的，这是此类问题的标准假设。问题陈述中“假设在潜热平台期间，显热容量不随相态变化”的指令证明了在整个冷却到 $T_f$ 的过程中使用相同的 $C_{vol}$ 是合理的。",
            "answer": "$$\\boxed{0.04124}$$"
        },
        {
            "introduction": "在数值天气预报和气候建模中，我们总是在物理真实性与计算效率之间寻求平衡，这催生了各种参数化方案。本练习 () 要求您对一种广泛应用的简化方案——“强迫-恢复法”——进行严格的评估。通过将其预测的地表温度响应与更精确的多层热传导模型进行定量比较，您将学会如何分析参数化方案的性能、理解其基本假设以及识别其在特定物理条件下的局限性。",
            "id": "4090090",
            "problem": "一个裸露、均质的土壤柱用深度坐标 $z \\ge 0$ 进行一维表示。该土壤具有恒定的热导率 $k$、质量密度 $\\rho$ 和比热容 $c$，因此其体积热容为 $\\rho c$，热扩散率为 $\\alpha = k/(\\rho c)$。$z=0$ 处的上边界受到大气施加的强烈昼夜循环的表面热通量作用，理想化为一个纯正弦诺伊曼边界条件 $q_s(t) = q_{\\mathrm{amp}} \\cos(\\omega t)$，其角频率 $\\omega$ 对应于24小时周期。下边界足够深，因此对于日循环，该土壤可被视为半无限的。考虑在数值天气预报（NWP）和气候模型中使用的两种土壤热参数化方案：\n\n1) 多层传导方案，在连续介质极限下，它由一维热扩散方程 $\\partial T / \\partial t = \\alpha \\, \\partial^2 T / \\partial z^2$ 控制，在 $z=0$ 处具有给定的通量边界条件，且土壤中没有热源。\n\n2) 简化的强迫-恢复方案，包含两个预报温度：一个与厚度为 $z_s$ 的薄表层（面积热容 $C_s = \\rho c \\, z_s$）相关的地表（表层）温度 $T_s(t)$，以及一个与厚度为 $z_g$ 的下层（面积热容 $C_g = \\rho c \\, z_g$）相关的地下主体温度 $T_g(t)$。两层之间的传导交换被参数化为跨越一个有效耦合长度 $L$ 的通量 $F = k \\, (T_s - T_g)/L$。强迫-恢复常微分方程为\n$$\n\\frac{d T_s}{dt} = \\frac{q_s(t)}{C_s} - \\frac{F}{C_s}, \n\\qquad\n\\frac{d T_g}{dt} = \\frac{F}{C_g}.\n$$\n\n假设以下参数值代表强日强迫下的矿物土壤：$k = 1.5 \\ \\mathrm{W \\ m^{-1} \\ K^{-1}}$，$\\rho c = 1.5 \\times 10^{6} \\ \\mathrm{J \\ m^{-3} \\ K^{-1}}$，因此 $\\alpha = 1.0 \\times 10^{-6} \\ \\mathrm{m^2 \\ s^{-1}}$，$q_{\\mathrm{amp}} = 200 \\ \\mathrm{W \\ m^{-2}}$，$\\omega = 2\\pi / 86400 \\ \\mathrm{s^{-1}}$，$z_s = 0.05 \\ \\mathrm{m}$，$z_g = 0.50 \\ \\mathrm{m}$。将有效耦合长度 $L$ 设置为等于扩散理论预测的日热力学表层深度，$L = \\delta = \\sqrt{ 2 \\alpha / \\omega }$。\n\n从上述控制定律出发，确定在稳态周期性强迫下，两种方案的地表温度响应 $T_s(t)$ 的振幅和相位（相对于 $q_s$ 的滞后）。比较两者，并确定在此情况下强迫-恢复方案的准确性。然后，基于热传导和能量守恒的第一性原理，讨论在哪些物理上现实的条件下，简化的强迫-恢复方法对于强烈的昼夜循环会失效。\n\n选择唯一一个正确描述定量比较和失效条件的最佳选项。\n\nA. 在此情况下，相对于多层传导方案，强迫-恢复方法低估了地表温度振幅约 $10\\%$ 到 $20\\%$，并低估了相位滞后约 $5^\\circ$ 到 $10^\\circ$；在土壤湿度变化下它仍然准确，因为耦合会自动适应，并且只有当热力学表层深度 $\\delta$ 小于表层厚度 $z_s$ 时才会失效。\n\nB. 如果有效耦合长度 $L$ 被设置为等于日热力学表层深度 $\\delta$，强迫-恢复方法对于任何土壤属性都能精确地再现多层传导解的振幅和相位；它仅在非常弱的日强迫下才会失效。\n\nC. 对于具有大热容的潮湿土壤，强迫-恢复方法在此情况下低估了振幅超过 $50\\%$，并引入超过 $90^\\circ$ 的相位误差；失效仅发生在周期长于季节时间尺度的情况下。\n\nD. 对于给定的参数，相对于多层传导解，强迫-恢复方法高估了地表温度振幅约 $15\\%$，并产生一个量值上小了约 $7^\\circ$ 的相位滞后；当底部边界条件位于与 $\\delta$ 相当的有限深度时，当瞬时入渗或排水在日时间尺度上平流输送热量并改变 $\\alpha$ 时，或者当强烈的垂直非均质性或冻融过程使得 $k$ 和 $\\rho c$ 在循环期间高度依赖于深度和温度时，它可能会失效。",
            "solution": "问题陈述经评估具有科学依据、问题设定良好、客观且完整。提供了两种标准土壤热模型所需的所有参数和控制方程。所给数值在物理上是现实的，提出的问题可以通过对给定信息的直接推导来回答。该问题是有效的。\n\n解答将分三部分推导：\n1.  求解多层传导（扩散）方案中的地表温度响应。\n2.  求解强迫-恢复方案中的地表温度响应。\n3.  比较定量结果并分析强迫-恢复方法的物理局限性，以评估给出的选项。\n\n**1. 多层传导方案（扩散方程）**\n\n一维热传导的控制偏微分方程（PDE）为：\n$$ \\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial z^2} $$\n地表（$z=0$）边界条件是给定的热通量：\n$$ -k \\frac{\\partial T}{\\partial z}\\bigg|_{z=0} = q_s(t) = q_{\\mathrm{amp}} \\cos(\\omega t) $$\n区域是半无限的，所以温度扰动必须在 $z \\to \\infty$ 时消失。\n\n我们寻求一个稳态周期解。使用复数表示法，令强迫为 $q_s(t) = \\text{Re}\\{q_{\\mathrm{amp}} e^{i\\omega t}\\}$，温度响应（忽略时间平均值）为 $T(z, t) = \\text{Re}\\{\\tilde{T}(z) e^{i\\omega t}\\}$。代入PDE得到复振幅 $\\tilde{T}(z)$ 的常微分方程（ODE）：\n$$ i\\omega \\tilde{T} = \\alpha \\frac{d^2 \\tilde{T}}{dz^2} \\implies \\frac{d^2 \\tilde{T}}{dz^2} - \\frac{i\\omega}{\\alpha} \\tilde{T} = 0 $$\n解的形式为 $\\tilde{T}(z) = A e^{\\lambda z} + B e^{-\\lambda z}$，其中 $\\lambda = \\pm\\sqrt{i\\omega/\\alpha}$。使用 $\\sqrt{i} = (1+i)/\\sqrt{2}$，我们得到：\n$$ \\lambda = \\pm \\sqrt{\\frac{\\omega}{2\\alpha}}(1+i) = \\pm \\frac{1+i}{\\delta} $$\n其中 $\\delta = \\sqrt{2\\alpha/\\omega}$ 是日循环的热力学表层深度。为确保解在 $z \\to \\infty$ 时保持有界，我们必须选择衰减的指数项，所以 $\\tilde{T}(z) = \\tilde{T}_s e^{-(1+i)z/\\delta}$，其中 $\\tilde{T}_s = \\tilde{T}(0)$ 是地表温度的复振幅。\n\n以复数形式应用通量边界条件：\n$$ -k \\frac{d\\tilde{T}}{dz}\\bigg|_{z=0} = q_{\\mathrm{amp}} $$\n$$ -k \\left[ \\tilde{T}_s \\left(-\\frac{1+i}{\\delta}\\right) e^{-(1+i)z/\\delta} \\right]_{z=0} = q_{\\mathrm{amp}} $$\n$$ k \\tilde{T}_s \\frac{1+i}{\\delta} = q_{\\mathrm{amp}} \\implies \\tilde{T}_s = \\frac{q_{\\mathrm{amp}} \\delta}{k(1+i)} $$\n为了求得振幅和相位，我们处理该复数表达式：\n$$ \\tilde{T}_s = \\frac{q_{\\mathrm{amp}} \\delta}{k} \\frac{1-i}{1^2+1^2} = \\frac{q_{\\mathrm{amp}} \\delta}{2k} (1-i) $$\n地表温度振荡的振幅 $A_{s,diff}$ 是 $\\tilde{T}_s$ 的模：\n$$ A_{s,diff} = |\\tilde{T}_s| = \\left| \\frac{q_{\\mathrm{amp}} \\delta}{2k} (1-i) \\right| = \\frac{q_{\\mathrm{amp}} \\delta}{2k} \\sqrt{1^2+(-1)^2} = \\frac{q_{\\mathrm{amp}} \\delta}{\\sqrt{2}k} $$\n$\\tilde{T}_s$ 的相位是 $\\arg(1-i) = -\\pi/4$ 弧度，即 $-45^\\circ$。因此，温度响应 $T_s(t) = A_{s,diff} \\cos(\\omega t - \\pi/4)$ 相对于热通量强迫 $q_s(t)=q_{\\mathrm{amp}}\\cos(\\omega t)$ 滞后一个相位 $\\phi_{lag,diff} = 45^\\circ$。\n\n数值计算：\n$\\omega = 2\\pi / 86400 \\ \\mathrm{s^{-1}} \\approx 7.272 \\times 10^{-5} \\ \\mathrm{rad \\ s^{-1}}$\n$\\delta = \\sqrt{2\\alpha/\\omega} = \\sqrt{2 \\times (1.0 \\times 10^{-6} \\ \\mathrm{m^2 \\ s^{-1}}) / (7.272 \\times 10^{-5} \\ \\mathrm{s^{-1}})} \\approx 0.1658 \\ \\mathrm{m}$\n$A_{s,diff} = \\frac{(200 \\ \\mathrm{W \\ m^{-2}}) \\times (0.1658 \\ \\mathrm{m})}{\\sqrt{2} \\times (1.5 \\ \\mathrm{W \\ m^{-1} \\ K^{-1}})} \\approx \\frac{33.16}{2.121} \\approx 15.63 \\ \\mathrm{K}$\n\n**2. 强迫-恢复方案**\n\n控制常微分方程的复数形式为：\n$$ i\\omega \\tilde{T}_s = \\frac{q_{\\mathrm{amp}}}{C_s} - \\frac{k}{L C_s}(\\tilde{T}_s - \\tilde{T}_g) $$\n$$ i\\omega \\tilde{T}_g = \\frac{k}{L C_g}(\\tilde{T}_s - \\tilde{T}_g) $$\n从第二个方程，我们求解 $\\tilde{T}_g$：\n$$ \\tilde{T}_g \\left( i\\omega + \\frac{k}{L C_g} \\right) = \\frac{k}{L C_g} \\tilde{T}_s \\implies \\tilde{T}_g = \\frac{1}{1 + i\\omega L C_g / k} \\tilde{T}_s $$\n将此代入第一个方程求解 $\\tilde{T}_s$：\n$$ i\\omega \\tilde{T}_s = \\frac{q_{\\mathrm{amp}}}{C_s} - \\frac{k}{L C_s} \\tilde{T}_s \\left( 1 - \\frac{1}{1 + i\\omega L C_g / k} \\right) $$\n$$ \\tilde{T}_s \\left( i\\omega C_s + \\frac{k}{L} \\frac{i\\omega L C_g / k}{1 + i\\omega L C_g / k} \\right) = q_{\\mathrm{amp}} $$\n地表温度的复振幅为 $\\tilde{T}_{s,FR} = q_{\\mathrm{amp}} / Y_{FR}$，其中 $Y_{FR}$ 是强迫-恢复系统的有效热导纳：\n$$ Y_{FR} = i\\omega C_s + \\frac{i\\omega C_g}{1 + i\\omega L C_g / k} $$\n分离 $Y_{FR}$ 的实部和虚部：\n$$ Y_{FR} = i\\omega C_s + \\frac{i\\omega C_g (1 - i\\omega L C_g / k)}{1 + (\\omega L C_g / k)^2} = \\frac{\\omega^2 L C_g^2/k}{1 + (\\omega L C_g / k)^2} + i\\omega \\left( C_s + \\frac{C_g}{1 + (\\omega L C_g / k)^2} \\right) $$\n\n数值计算：\n$C_s = \\rho c \\, z_s = (1.5 \\times 10^6 \\ \\mathrm{J \\ m^{-3} \\ K^{-1}}) \\times (0.05 \\ \\mathrm{m}) = 7.5 \\times 10^4 \\ \\mathrm{J \\ m^{-2} \\ K^{-1}}$\n$C_g = \\rho c \\, z_g = (1.5 \\times 10^6 \\ \\mathrm{J \\ m^{-3} \\ K^{-1}}) \\times (0.50 \\ \\mathrm{m}) = 7.5 \\times 10^5 \\ \\mathrm{J \\ m^{-2} \\ K^{-1}}$\n$L = \\delta \\approx 0.1658 \\ \\mathrm{m}$\n让我们计算无量纲群 $\\gamma = \\omega L C_g / k$：\n$$ \\gamma = \\frac{(7.272 \\times 10^{-5} \\ \\mathrm{s^{-1}}) \\times (0.1658 \\ \\mathrm{m}) \\times (7.5 \\times 10^5 \\ \\mathrm{J \\ m^{-2} \\ K^{-1}})}{1.5 \\ \\mathrm{W \\ m^{-1} \\ K^{-1}}} \\approx 6.033 $$\n现在计算 $Y_{FR}$ 的实部和虚部：\n$$ \\text{Re}(Y_{FR}) = \\frac{\\omega C_g \\gamma}{1+\\gamma^2} = \\frac{(7.272\\times 10^{-5})(7.5\\times 10^5)(6.033)}{1+6.033^2} \\approx \\frac{329.0}{37.4} \\approx 8.796 \\ \\mathrm{W \\ m^{-2} \\ K^{-1}} $$\n$$ \\text{Im}(Y_{FR}) = \\omega C_s + \\frac{\\omega C_g}{1+\\gamma^2} = (7.272\\times 10^{-5})(7.5\\times 10^4) + \\frac{(7.272\\times 10^{-5})(7.5\\times 10^5)}{1+6.033^2} \\approx 5.454 + 1.458 \\approx 6.912 \\ \\mathrm{W \\ m^{-2} \\ K^{-1}} $$\n所以，$Y_{FR} \\approx 8.796 + 6.912i$。\n振幅 $A_{s,FR} = |\\tilde{T}_{s,FR}|$ 为：\n$$ A_{s,FR} = \\frac{q_{\\mathrm{amp}}}{|Y_{FR}|} = \\frac{200}{\\sqrt{8.796^2 + 6.912^2}} = \\frac{200}{\\sqrt{77.37 + 47.78}} = \\frac{200}{\\sqrt{125.15}} \\approx \\frac{200}{11.187} \\approx 17.88 \\ \\mathrm{K} $$\n相位滞后由 $Y_{FR}$ 的辐角给出：\n$$ \\phi_{lag,FR} = \\arg(Y_{FR}) = \\arctan\\left(\\frac{\\text{Im}(Y_{FR})}{\\text{Re}(Y_{FR})}\\right) = \\arctan\\left(\\frac{6.912}{8.796}\\right) \\approx \\arctan(0.7858) \\approx 38.16^\\circ $$\n\n**3. 比较与分析**\n\n| 方案 | 振幅 ($K$) | 相位滞后 (度) |\n|---|---|---|\n| 多层（扩散） | $15.63$ | $45.0^\\circ$ |\n| 强迫-恢复 | $17.88$ | $38.16^\\circ$ |\n\n- **振幅比较**：强迫-恢复方法高估了振幅。相对误差为 $(17.88 - 15.63) / 15.63 \\approx 0.144$，即高估了约 $14.4\\%$。这大约是 $15\\%$。\n- **相位滞后比较**：强迫-恢复方法产生了更小的相位滞后。差异为 $45^\\circ - 38.16^\\circ = 6.84^\\circ$。相位滞后小了约 $7^\\circ$。\n\n强迫-恢复模型是热扩散连续介质物理学的一个显著简化。在其双层、常系数、仅传導的框架下，其准确性在几种物理上现实的条件下会失效，而这些条件是该模型无法捕捉的：\n1.  **非均质性和非线性**：真实的土壤属性（$k$, $\\rho c$）不是恒定的。它们随深度（由于质地和压实度变化）和温度而剧烈变化，尤其是在**冻融循环**期间，此时水的大量熔化潜热会显著改变表观热容。具有恒定参数的强迫-恢复模型无法表示此类效应。\n2.  **底部边界效应**：该模型的“深层”（$T_g$）是对半无限介质的粗略表示。如果实际土壤柱具有与热力学表层深度 $\\delta$ 相当的有限深度（例如，基岩），那么来自该边界的热波反射将改变地表温度响应，而这种方式是强迫-恢复参数化无法捕捉的。\n3.  **平流和瞬态过程**：该模型假设热传递仅通过传导。然而，雨水的**瞬时入渗**或土壤水分的排水会垂直平流输送热量，这可能是一个主要的短期过程。此外，这些水分变化在与日循环相当的时间尺度上急剧改变土壤热属性（$k$ 和 $\\rho c$ 都随水分增加而增加，从而改变 $\\alpha$），这违反了常数参数的假设。\n\n**选项评估：**\n\n*   **A**：错误。它声称该方法*低估*了振幅，这与我们的发现相反。它还做出了一个物理上不正确的声明，即该模型能适应土壤湿度变化，并给出了一个过于严格的失效条件。\n*   **B**：错误。它错误地声称该方法“精确地再现”了扩散解。我们的计算显示在振幅和相位上都有显著差异。该方法的准确性是依赖于参数的。\n*   **C**：错误。它声稱该方法*低估*了振幅超过 $50\\%$，且相位误差超过 $90^\\circ$。这两点都与我们的计算相反。\n*   **D**：正确。定量比较与我们的结果相符：振幅被高估“约 15%”（我们计算出为 $14.4\\%$），相位滞后“在量值上小了约 7°”（我们计算出为 $6.84^\\circ$）。所列出的失效条件（有限深度、瞬态水分/平流、以及非均质性/冻融）在物理上都是有效的，并代表了简化的强迫-恢復方法的关键局限性。",
            "answer": "$$\\boxed{D}$$"
        }
    ]
}