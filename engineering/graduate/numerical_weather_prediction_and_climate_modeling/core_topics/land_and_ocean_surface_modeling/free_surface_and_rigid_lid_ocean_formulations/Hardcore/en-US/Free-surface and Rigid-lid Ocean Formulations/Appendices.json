{
    "hands_on_practices": [
        {
            "introduction": "Understanding the trade-offs between free-surface and rigid-lid models begins with the fundamental numerical constraint imposed by external gravity waves. This exercise will guide you through the derivation of the phase speed $c = \\sqrt{gH}$ for these waves from the linearized shallow-water equations. By calculating this speed and the associated Courant-Friedrichs-Lewy (CFL) time-step limit, you will gain a concrete appreciation for why explicit free-surface models are computationally prohibitive for long climate simulations and why the rigid-lid approximation became a cornerstone of early ocean modeling. ",
            "id": "4072669",
            "problem": "Consider an Ocean General Circulation Model (OGCM) free-surface barotropic mode represented, in the long-wave, hydrostatic, and Boussinesq limit, by the one-layer linearized shallow-water equations on a Cartesian plane with constant mean depth $H$:\n$$\n\\frac{\\partial u}{\\partial t} = -g\\,\\frac{\\partial \\eta}{\\partial x},\\quad \\frac{\\partial \\eta}{\\partial t} + H\\,\\frac{\\partial u}{\\partial x} = 0,\n$$\nwhere $u$ is the depth-averaged horizontal velocity in the $x$ direction, $\\eta$ is the free-surface displacement, and $g$ is gravitational acceleration. Starting from these equations and first principles (conservation of momentum and mass), derive the dispersion relation for small-amplitude plane waves and obtain the external gravity-wave phase speed in terms of $g$ and $H$. Then, for a global ocean with representative mean depth $H = 4000\\ \\mathrm{m}$ and gravitational acceleration $g = 9.81\\ \\mathrm{m\\ s^{-2}}$, evaluate the external gravity-wave phase speed. Using your derived speed, reason about the explicit time-step constraint implied by the Courant-Friedrichs-Lewy (CFL) condition for a one-dimensional barotropic free-surface solver with uniform grid spacing $\\Delta x = 25\\ \\mathrm{km}$, and compare qualitatively how this constraint changes if the model employs a rigid-lid approximation that removes the external mode.\n\nYour final numerical answer should be the external gravity-wave phase speed evaluated at $H = 4000\\ \\mathrm{m}$. Express the final speed in $\\mathrm{m\\ s^{-1}}$ and round to four significant figures.",
            "solution": "The problem statement is evaluated for validity.\n\n**Step 1: Extract Givens**\n- Governing equations: $\\frac{\\partial u}{\\partial t} = -g\\,\\frac{\\partial \\eta}{\\partial x}$ and $\\frac{\\partial \\eta}{\\partial t} + H\\,\\frac{\\partial u}{\\partial x} = 0$.\n- Variables: $u$ (depth-averaged horizontal velocity), $\\eta$ (free-surface displacement), $x$ (horizontal coordinate), $t$ (time).\n- Constants: $g$ (gravitational acceleration), $H$ (constant mean depth).\n- Model context: One-layer linearized shallow-water equations for an Ocean General Circulation Model (OGCM) free-surface barotropic mode.\n- Approximations: Long-wave, hydrostatic, Boussinesq.\n- Specific values for analysis: $H = 4000\\ \\mathrm{m}$, $g = 9.81\\ \\mathrm{m\\ s^{-2}}$, grid spacing $\\Delta x = 25\\ \\mathrm{km}$.\n- Task components:\n    1. Derive the dispersion relation and the external gravity-wave phase speed, $c$, in terms of $g$ and $H$.\n    2. Evaluate $c$ for the given values of $g$ and $H$.\n    3. Discuss the time-step constraint from the Courant-Friedrichs-Lewy (CFL) condition.\n    4. Compare this constraint qualitatively with that of a rigid-lid model.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem is based on the linearized shallow-water equations, which are fundamental in geophysical fluid dynamics and represent the standard model for barotropic surface gravity waves. The values for $g$, $H$, and $\\Delta x$ are realistic for global ocean modeling. This is a classic textbook problem.\n- **Well-Posed:** The problem is clearly stated and contains all necessary information to derive the dispersion relation, calculate the phase speed, and analyze the CFL condition. A unique and meaningful solution exists.\n- **Objective:** The language is precise and free of bias or subjective claims.\n\n**Step 3: Verdict and Action**\nThe problem is valid. It is scientifically sound, self-contained, and well-posed. The solution process may proceed.\n\nThe solution begins with the derivation of the dispersion relation for the given system of equations. The system is:\n$$\n\\frac{\\partial u}{\\partial t} = -g\\,\\frac{\\partial \\eta}{\\partial x} \\quad (1)\n$$\n$$\n\\frac{\\partial \\eta}{\\partial t} + H\\,\\frac{\\partial u}{\\partial x} = 0 \\quad (2)\n$$\nWe seek plane-wave solutions of the form:\n$$\nu(x, t) = U_0 \\exp[i(kx - \\omega t)]\n$$\n$$\n\\eta(x, t) = \\eta_0 \\exp[i(kx - \\omega t)]\n$$\nwhere $k$ is the wavenumber, $\\omega$ is the angular frequency, $U_0$ is the complex amplitude of the velocity, and $\\eta_0$ is the complex amplitude of the surface displacement.\n\nSubstituting these forms into equations $(1)$ and $(2)$ involves taking partial derivatives:\n$\\frac{\\partial}{\\partial t} \\rightarrow -i\\omega$\n$\\frac{\\partial}{\\partial x} \\rightarrow ik$\n\nApplying these to equation $(1)$:\n$$\n-i\\omega (U_0 \\exp[i(kx - \\omega t)]) = -g (ik) (\\eta_0 \\exp[i(kx - \\omega t)])\n$$\nDividing by the exponential term and $-i$, we obtain a linear algebraic equation relating the amplitudes:\n$$\n\\omega U_0 = gk \\eta_0 \\quad (3)\n$$\n\nApplying the same to equation $(2)$:\n$$\n-i\\omega (\\eta_0 \\exp[i(kx - \\omega t)]) + H (ik) (U_0 \\exp[i(kx - \\omega t)]) = 0\n$$\nDividing by the exponential term and $i$:\n$$\n-\\omega \\eta_0 + Hk U_0 = 0 \\quad (4)\n$$\n\nWe now have a system of two homogeneous linear equations for $U_0$ and $\\eta_0$:\n$$\n\\omega U_0 - gk \\eta_0 = 0\n$$\n$$\nHk U_0 - \\omega \\eta_0 = 0\n$$\nFor a non-trivial solution (where $U_0$ and $\\eta_0$ are not both zero), the determinant of the coefficient matrix must be zero.\n$$\n\\det \\begin{pmatrix} \\omega & -gk \\\\ Hk & -\\omega \\end{pmatrix} = (\\omega)(-\\omega) - (-gk)(Hk) = 0\n$$\n$$\n-\\omega^2 + gHk^2 = 0\n$$\nThis leads to the dispersion relation for these waves:\n$$\n\\omega^2 = gHk^2\n$$\nThe phase speed, $c$, is defined as the ratio of angular frequency to wavenumber, $c = \\omega/k$. From the dispersion relation, we can solve for this ratio:\n$$\n\\frac{\\omega^2}{k^2} = gH \\implies \\left(\\frac{\\omega}{k}\\right)^2 = gH\n$$\nTaking the square root gives the phase speed:\n$$\nc = \\pm \\sqrt{gH}\n$$\nThe phase speed is a magnitude, so we take the positive root. This is the phase speed for external (barotropic) gravity waves:\n$$\nc = \\sqrt{gH}\n$$\nThe waves are non-dispersive, as the phase speed $c$ does not depend on the wavenumber $k$.\n\nNext, we evaluate this speed for the given parameters: $H = 4000\\ \\mathrm{m}$ and $g = 9.81\\ \\mathrm{m\\ s^{-2}}$.\n$$\nc = \\sqrt{(9.81\\ \\mathrm{m\\ s^{-2}}) (4000\\ \\mathrm{m})} = \\sqrt{39240\\ \\mathrm{m^2\\ s^{-2}}}\n$$\n$$\nc \\approx 198.090888\\ \\mathrm{m\\ s^{-1}}\n$$\nRounding to four significant figures as requested, the phase speed is $198.1\\ \\mathrm{m\\ s^{-1}}$.\n\nFinally, we consider the implications for the numerical time-step constraint. The Courant-Friedrichs-Lewy (CFL) condition for an explicit numerical scheme for wave propagation dictates that the numerical domain of dependence must contain the physical domain of dependence. For a one-dimensional advection/wave equation, this is expressed as:\n$$\nC_{cfl} = \\frac{c_{max} \\Delta t}{\\Delta x} \\le 1\n$$\nwhere $c_{max}$ is the maximum wave speed in the system, $\\Delta t$ is the time step, and $\\Delta x$ is the grid spacing. This imposes an upper limit on the time step for numerical stability:\n$$\n\\Delta t \\le \\frac{\\Delta x}{c_{max}}\n$$\nIn the free-surface model, the fastest waves are the external gravity waves we have just analyzed. Therefore, $c_{max} = c = \\sqrt{gH} \\approx 198.1\\ \\mathrm{m\\ s^{-1}}$. With a grid spacing of $\\Delta x = 25\\ \\mathrm{km} = 25000\\ \\mathrm{m}$, the maximum allowable time step is:\n$$\n\\Delta t \\le \\frac{25000\\ \\mathrm{m}}{198.1\\ \\mathrm{m\\ s^{-1}}} \\approx 126.2\\ \\mathrm{s}\n$$\nThis time step of approximately $2$ minutes is very short for climate simulations, which must run for centuries or millennia, making such models computationally expensive.\n\nIn contrast, a model that employs a rigid-lid approximation enforces $\\eta = \\text{constant}$ or, more typically for dynamics, $\\frac{\\partial \\eta}{\\partial t} = 0$. Looking at equation $(2)$, this implies that $\\frac{\\partial u}{\\partial x} = 0$, meaning the flow is horizontally non-divergent. This approximation effectively filters out the fast external gravity waves, as their existence is tied to the free-surface displacement $\\eta$.\nWith the external gravity waves removed, the maximum wave speed $c_{max}$ in the model is then determined by other, much slower, wave phenomena. These typically include internal gravity waves (associated with density stratification, with speeds on the order of $1-3\\ \\mathrm{m\\ s^{-1}}$) and planetary Rossby waves (even slower). If the fastest remaining waves have a speed of, for example, $c_{internal} \\approx 3\\ \\mathrm{m\\ s^{-1}}$, the CFL condition becomes:\n$$\n\\Delta t \\le \\frac{25000\\ \\mathrm{m}}{3\\ \\mathrm{m\\ s^{-1}}} \\approx 8333\\ \\mathrm{s}\n$$\nThis corresponds to a time step of about $2.3$ hours, which is much larger (a factor of roughly $66$) than the time step allowed in the free-surface model. Consequently, the rigid-lid approximation allows for vastly more efficient long-term integration of ocean models, at the cost of excluding phenomena like tides and tsunamis that depend on free-surface dynamics.",
            "answer": "$$\n\\boxed{198.1}\n$$"
        },
        {
            "introduction": "The choice between model formulations impacts more than just wave dynamics; it fundamentally alters how models conserve mass and heat, with direct consequences for simulating key climate indicators like sea level. This practice contrasts a Boussinesq model, which conserves volume, with a more complete mass-conserving formulation to isolate the physical processes each one can represent. By deriving the \"bias\" between them, you will uncover how certain approximations can exclude important phenomena such as the thermosteric component of sea level change, a crucial insight for climate studies. ",
            "id": "4046019",
            "problem": "Consider an idealized, horizontally homogeneous ocean column of unit horizontal area with bottom at $z=-H$ and free surface at $z=\\eta(t)$. There is no lateral flow and no bottom motion, and the column is forced only by a spatially uniform surface heat flux and a spatially uniform freshwater volume flux. The initial state is at rest with uniform temperature $T_{0}$ and uniform salinity $S_{0}$. Over a time interval $\\Delta t$, a constant surface heat flux $Q$ (positive downward, into the ocean) and a constant freshwater volume flux per unit area $w$ are imposed at the free surface. The mixed-layer thickness $h_{m}$ is constant, and vertical mixing is sufficiently strong that the mixed-layer temperature remains vertically uniform during the forcing interval. Salinity is assumed to remain constant (no haline contraction or expansion).\n\nTwo formulations are to be contrasted:\n\n- A free-surface model under the Boussinesq approximation (incompressible volume budget).\n- A free-surface model without the Boussinesq approximation (compressible mass budget with linearized equation of state).\n\nStarting from the three-dimensional mass continuity equation, the kinematic free-surface boundary condition, the column-integrated heat budget, and a linearized equation of state relating specific volume to temperature, derive expressions for the sea level change $\\Delta \\eta$ over the interval $\\Delta t$ for each formulation under the stated assumptions. Using your derived expressions, compute the bias, defined as the difference between the compressible free-surface sea level change and the Boussinesq free-surface sea level change over $\\Delta t$.\n\nUse the following parameter values: $\\rho_{0}=1028\\,\\mathrm{kg\\,m^{-3}}$ (reference density), $c_{p}=3990\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$ (specific heat capacity at constant pressure), $\\alpha=2.0\\times 10^{-4}\\,\\mathrm{K^{-1}}$ (thermal expansion coefficient), $h_{m}=50\\,\\mathrm{m}$, $Q=100\\,\\mathrm{W\\,m^{-2}}$, $\\Delta t=20\\,\\mathrm{days}$, and $w=1.0\\times 10^{-3}\\,\\mathrm{m\\,day^{-1}}$. Round your final bias value to four significant figures. Express your final answer in meters.",
            "solution": "The problem requires the derivation of sea level change, $\\Delta \\eta$, over a time interval $\\Delta t$ for two different ocean model formulations, followed by a calculation of the bias between them. The bias is defined as the difference between the sea level change in a compressible (non-Boussinesq) model and a Boussinesq model.\n\nFirst, we analyze the physical processes. The sea level change is composed of two parts:\n$1$. The eustatic component, due to the addition of mass (freshwater) to the ocean column.\n$2$. The steric component, due to the change in density of the existing water, primarily through thermal expansion (haline effects are explicitly excluded).\n\nLet's derive the expression for $\\Delta \\eta$ for each formulation.\n\n**Formulation 1: Free-Surface Model with Boussinesq Approximation**\n\nThe Boussinesq approximation is characterized by treating the fluid as incompressible for the purposes of mass conservation, while retaining density variations in the buoyancy term of the momentum equations (which are not needed for this problem). The continuity equation under the Boussinesq approximation is:\n$$\n\\nabla \\cdot \\mathbf{u} = 0\n$$\nFor a horizontally homogeneous column, the velocity vector is $\\mathbf{u} = (0, 0, w_v)$, where $w_v$ is the vertical velocity. The continuity equation simplifies to:\n$$\n\\frac{\\partial w_v}{\\partial z} = 0\n$$\nThis implies that $w_v(z)$ is constant throughout the water column. Given the no-motion condition at the bottom ($z=-H$), we have $w_v(-H) = 0$. Therefore, $w_v(z) = 0$ for the entire column.\n\nThe kinematic boundary condition at the free surface $z=\\eta(t)$ relates the rate of change of the surface height to the vertical fluid velocity at the surface and any external volume fluxes. In this case, there is a freshwater volume flux per unit area, $w$. The condition is:\n$$\n\\frac{d\\eta}{dt} = w_v(z=\\eta) + w\n$$\nSubstituting $w_v(\\eta) = 0$, we get:\n$$\n\\frac{d\\eta}{dt} = w\n$$\nThis equation states that in the Boussinesq formulation, the sea level changes only due to the external addition or removal of water volume. The model, by virtue of its \"incompressible volume budget\", does not account for the expansion or contraction of the water column due to temperature changes.\n\nTo find the total sea level change over the interval $\\Delta t$, we integrate this equation. Since $w$ is constant:\n$$\n\\Delta \\eta_{\\text{Bous}} = \\int_{0}^{\\Delta t} w \\, dt = w \\Delta t\n$$\n\n**Formulation 2: Free-Surface Model without Boussinesq Approximation (Compressible Mass Budget)**\n\nThis formulation uses the full mass continuity equation, which accounts for changes in density:\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{u}) = 0\n$$\nFor our one-dimensional column, this becomes:\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\frac{\\partial (\\rho w_v)}{\\partial z} = 0\n$$\nTo find the vertical velocity $w_v(z)$, we integrate this equation with respect to $z$ from the bottom at $z=-H$ up to an arbitrary height $z$:\n$$\n\\int_{-H}^{z} \\frac{\\partial \\rho}{\\partial t} \\, dz' + \\int_{-H}^{z} \\frac{\\partial (\\rho w_v)}{\\partial z'} \\, dz' = 0\n$$\n$$\n\\int_{-H}^{z} \\frac{\\partial \\rho}{\\partial t} \\, dz' + [\\rho w_v]_{-H}^{z} = 0\n$$\nUsing the bottom boundary condition $w_v(-H)=0$, we get:\n$$\n\\int_{-H}^{z} \\frac{\\partial \\rho}{\\partial t} \\, dz' + \\rho(z) w_v(z) = 0\n$$\nSolving for $w_v(z)$ yields:\n$$\nw_v(z) = -\\frac{1}{\\rho(z)} \\int_{-H}^{z} \\frac{\\partial \\rho}{\\partial t} \\, dz'\n$$\nThe vertical velocity at any level is determined by the integrated rate of density change in the column below it. Now we apply the same kinematic free-surface condition as before:\n$$\n\\frac{d\\eta}{dt} = w_v(z=\\eta) + w\n$$\nSubstituting the expression for $w_v(\\eta)$:\n$$\n\\frac{d\\eta}{dt} = -\\frac{1}{\\rho(\\eta)} \\int_{-H}^{\\eta} \\frac{\\partial \\rho}{\\partial t} \\, dz + w\n$$\nTo evaluate the integral, we need to find $\\frac{\\partial \\rho}{\\partial t}$. The problem provides a linearized equation of state relating density $\\rho$ to temperature $T$:\n$$\n\\rho(T) = \\rho_{0} (1 - \\alpha(T - T_{0}))\n$$\nwhere $\\alpha$ is the thermal expansion coefficient. Differentiating with respect to time $t$:\n$$\n\\frac{\\partial \\rho}{\\partial t} = -\\rho_{0} \\alpha \\frac{\\partial T}{\\partial t}\n$$\nThe rate of temperature change, $\\frac{\\partial T}{\\partial t}$, is determined by the heat budget. The surface heat flux $Q$ is absorbed by the mixed layer of constant thickness $h_m$. The heat added over an infinitesimal time $dt$ to a unit area column is $Q dt$. This heat increases the temperature of the mass of the mixed layer, which is $m_{m} \\approx \\rho_{0} h_{m}$. The heat change is $dQ_{heat} = m_{m} c_p dT = \\rho_{0} h_{m} c_p dT$. Thus, the rate of heating is:\n$$\nQ = \\rho_{0} h_{m} c_{p} \\frac{dT}{dt}\n$$\nSince the mixed-layer temperature is vertically uniform, $\\frac{\\partial T}{\\partial t} = \\frac{dT}{dt}$. Solving for the rate of temperature change:\n$$\n\\frac{\\partial T}{\\partial t} = \\frac{Q}{\\rho_{0} h_{m} c_{p}}\n$$\nNow substitute this into the expression for $\\frac{\\partial \\rho}{\\partial t}$:\n$$\n\\frac{\\partial \\rho}{\\partial t} = -\\rho_{0} \\alpha \\left( \\frac{Q}{\\rho_{0} h_{m} c_{p}} \\right) = -\\frac{\\alpha Q}{h_{m} c_{p}}\n$$\nThis rate of density change is constant within the mixed layer (from $z=\\eta-h_m$ to $z=\\eta$) and is zero below it, as no heat penetrates below the mixed layer.\nWe can now evaluate the integral in the expression for $\\frac{d\\eta}{dt}$:\n$$\n\\int_{-H}^{\\eta} \\frac{\\partial \\rho}{\\partial t} \\, dz = \\int_{\\eta - h_m}^{\\eta} \\left( -\\frac{\\alpha Q}{h_{m} c_{p}} \\right) dz = -\\frac{\\alpha Q}{h_{m} c_{p}} \\cdot [z]_{\\eta - h_m}^{\\eta} = -\\frac{\\alpha Q}{h_{m} c_{p}} (h_m) = -\\frac{\\alpha Q}{c_{p}}\n$$\nSubstituting this result back into the equation for $\\frac{d\\eta}{dt}$:\n$$\n\\frac{d\\eta}{dt} = -\\frac{1}{\\rho(\\eta)} \\left( -\\frac{\\alpha Q}{c_{p}} \\right) + w = \\frac{\\alpha Q}{\\rho(\\eta) c_{p}} + w\n$$\nUsing the approximation $\\rho(\\eta) \\approx \\rho_{0}$ for the denominator, which is consistent with the level of approximation used throughout:\n$$\n\\frac{d\\eta}{dt} = \\frac{\\alpha Q}{\\rho_{0} c_{p}} + w\n$$\nThe total sea level change for the compressible model, $\\Delta \\eta_{\\text{Comp}}$, is found by integrating over the interval $\\Delta t$. Since all terms on the right-hand side are constant:\n$$\n\\Delta \\eta_{\\text{Comp}} = \\int_{0}^{\\Delta t} \\left( \\frac{\\alpha Q}{\\rho_{0} c_{p}} + w \\right) dt = \\left( \\frac{\\alpha Q}{\\rho_{0} c_{p}} + w \\right) \\Delta t\n$$\nThis expression correctly includes both the thermosteric sea level rise ($\\frac{\\alpha Q \\Delta t}{\\rho_0 c_p}$) and the eustatic sea level rise ($w \\Delta t$).\n\n**Bias Calculation**\n\nThe bias is defined as the difference between the compressible and Boussinesq sea level changes:\n$$\n\\text{Bias} = \\Delta \\eta_{\\text{Comp}} - \\Delta \\eta_{\\text{Bous}}\n$$\n$$\n\\text{Bias} = \\left( \\frac{\\alpha Q}{\\rho_{0} c_{p}} + w \\right) \\Delta t - w \\Delta t\n$$\n$$\n\\text{Bias} = \\frac{\\alpha Q \\Delta t}{\\rho_{0} c_{p}}\n$$\nThe bias is precisely the thermosteric component of sea level rise, which the Boussinesq model's volume budget neglects.\n\n**Numerical Evaluation**\n\nWe are given the following parameter values:\n- $\\alpha = 2.0 \\times 10^{-4}\\,\\mathrm{K^{-1}}$\n- $Q = 100\\,\\mathrm{W\\,m^{-2}} = 100\\,\\mathrm{J\\,s^{-1}\\,m^{-2}}$\n- $\\rho_{0} = 1028\\,\\mathrm{kg\\,m^{-3}}$\n- $c_{p} = 3990\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$\n- $\\Delta t = 20\\,\\mathrm{days}$\n\nFirst, we must ensure all units are in the SI system. The time interval $\\Delta t$ must be converted from days to seconds:\n$$\n\\Delta t = 20\\,\\mathrm{days} \\times 24\\,\\mathrm{hours/day} \\times 3600\\,\\mathrm{s/hour} = 1,728,000\\,\\mathrm{s}\n$$\nNow, substitute the values into the bias formula:\n$$\n\\text{Bias} = \\frac{(2.0 \\times 10^{-4}\\,\\mathrm{K^{-1}}) \\times (100\\,\\mathrm{J\\,s^{-1}\\,m^{-2}}) \\times (1,728,000\\,\\mathrm{s})}{(1028\\,\\mathrm{kg\\,m^{-3}}) \\times (3990\\,\\mathrm{J\\,kg^{-1}\\,K^{-1}})}\n$$\nLet's compute the numerator and denominator separately.\nNumerator:\n$$\n2.0 \\times 10^{-4} \\times 100 \\times 1,728,000 = 0.02 \\times 1,728,000 = 34,560\\,\\mathrm{J\\,m^{-2}}\n$$\nDenominator:\n$$\n1028 \\times 3990 = 4,101,720\\,\\mathrm{J\\,m^{-3}\\,K^{-1}}\n$$\nNow, the bias is:\n$$\n\\text{Bias} = \\frac{34,560}{4,101,720}\\,\\mathrm{m} \\approx 0.00842571\\,\\mathrm{m}\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\n\\text{Bias} \\approx 0.008426\\,\\mathrm{m}\n$$\nThe unit consistency check is:\n$\\frac{[\\mathrm{K^{-1}}] [\\mathrm{J\\,s^{-1}\\,m^{-2}}] [\\mathrm{s}]}{[\\mathrm{kg\\,m^{-3}}] [\\mathrm{J\\,kg^{-1}\\,K^{-1}}]} = \\frac{[\\mathrm{J\\,m^{-2}}]}{[\\mathrm{J\\,m^{-3}}]} = \\mathrm{m}$. The units are correct.\nThe values for $h_m$ and $w$ were necessary for the derivation but do not appear in the final expression for the bias.",
            "answer": "$$\\boxed{0.008426}$$"
        },
        {
            "introduction": "Both rigid-lid and modern semi-implicit free-surface models circumvent the CFL limit by solving a global elliptic equation at each time step, shifting the computational bottleneck from the time step to the linear solver. This advanced exercise takes you into the heart of these solvers by analyzing the spectral properties of the underlying discrete operators. By deriving the condition number of the Helmholtz operator associated with a semi-implicit scheme, you will understand how grid resolution and model parameters directly influence the convergence rate and efficiency of the iterative methods used to find the global solution. ",
            "id": "4046026",
            "problem": "Consider the linearized barotropic external mode of a hydrostatic ocean on a doubly periodic square domain discretized by a uniform grid with $N \\times N$ points, where $N$ is an even integer and the grid spacing is $h$. In the rigid-lid formulation, the barotropic pressure constraint is solved by an elliptic operator that, on this grid, is represented by the second-order centered finite-difference negative Laplacian $S$ acting on a scalar field $u_{i,j}$ as\n$$\nS u_{i,j} \\equiv \\frac{1}{h^{2}}\\left(4 u_{i,j} - u_{i+1,j} - u_{i-1,j} - u_{i,j+1} - u_{i,j-1}\\right),\n$$\nwith periodic indexing in both directions. The semi-implicit free-surface formulation for the external mode leads to a Helmholtz-type linear system for the surface elevation with operator $H \\equiv I + \\alpha S$, where $I$ is the identity and $\\alpha > 0$ is a dimensionless parameter arising from the chosen time discretization of fast external gravity waves.\n\nTo analyze the numerical linear algebra properties relevant for iterative solvers, focus on the zero-mean subspace (exclude the constant Fourier mode). Starting from the definition of $S$ above and the assumption of periodic boundary conditions, derive the discrete Fourier eigenpairs of $S$ and use them to obtain an explicit, closed-form expression for the spectral condition number of $H$ restricted to the zero-mean subspace,\n$$\n\\kappa(H) \\equiv \\frac{\\lambda_{\\max}(H)}{\\lambda_{\\min}(H)},\n$$\nwhere $\\lambda_{\\max}(H)$ and $\\lambda_{\\min}(H)$ denote, respectively, the largest and smallest eigenvalues of $H$ over the zero-mean subspace.\n\nExpress your final answer as a single analytic expression in terms of $N$, $h$, and $\\alpha$. No numerical evaluation is required, and no units should be included in the final expression since $\\kappa(H)$ is dimensionless.",
            "solution": "The barotropic external mode in a hydrostatic ocean supports fast external gravity waves. In a rigid-lid formulation, these waves are filtered by enforcing a non-divergent barotropic flow via an elliptic constraint, which on a uniform grid with periodic boundaries becomes a discrete Poisson problem. In semi-implicit free-surface formulations, fast waves are stabilized by treating part of the external mode implicitly, leading to a Helmholtz-type operator. The spectral properties of these operators govern the convergence behavior of iterative methods such as Conjugate Gradient (CG), and the condition number $\\kappa(H)$ on the relevant subspace is a central metric.\n\nWe begin from the definition of the positive semi-definite discrete operator $S$ under periodic indexing,\n$$\nS u_{i,j} = \\frac{1}{h^{2}}\\left(4 u_{i,j} - u_{i+1,j} - u_{i-1,j} - u_{i,j+1} - u_{i,j-1}\\right).\n$$\nOn a doubly periodic $N \\times N$ grid, the discrete Fourier modes\n$$\n\\phi_{k,l}(i,j) = \\exp\\left(\\mathrm{i}\\,\\frac{2\\pi}{N}\\left(k\\,i + l\\,j\\right)\\right),\n$$\nwith integer wavenumbers $k,l \\in \\{0,1,\\dots,N-1\\}$, form an orthogonal eigenbasis for any constant-coefficient stencil operator such as $S$. To obtain the eigenvalues, apply $S$ to $\\phi_{k,l}$ and use periodicity. Noting that\n$$\n\\phi_{k,l}(i\\pm 1,j) = \\phi_{k,l}(i,j)\\,\\exp\\left(\\pm \\mathrm{i}\\,\\frac{2\\pi k}{N}\\right), \\quad\n\\phi_{k,l}(i,j\\pm 1) = \\phi_{k,l}(i,j)\\,\\exp\\left(\\pm \\mathrm{i}\\,\\frac{2\\pi l}{N}\\right),\n$$\nwe compute\n\\begin{align*}\nS \\phi_{k,l}(i,j)\n&= \\frac{1}{h^{2}}\\left(4 - \\exp\\left(\\mathrm{i}\\,\\frac{2\\pi k}{N}\\right) - \\exp\\left(-\\mathrm{i}\\,\\frac{2\\pi k}{N}\\right) - \\exp\\left(\\mathrm{i}\\,\\frac{2\\pi l}{N}\\right) - \\exp\\left(-\\mathrm{i}\\,\\frac{2\\pi l}{N}\\right)\\right)\\phi_{k,l}(i,j) \\\\\n&= \\frac{1}{h^{2}}\\left(4 - 2\\cos\\left(\\frac{2\\pi k}{N}\\right) - 2\\cos\\left(\\frac{2\\pi l}{N}\\right)\\right)\\phi_{k,l}(i,j).\n\\end{align*}\nUsing the trigonometric identity $1 - \\cos(\\theta) = 2\\sin^{2}\\left(\\frac{\\theta}{2}\\right)$, we rewrite the eigenvalue as\n\\begin{align*}\n\\lambda_{k,l}(S)\n&= \\frac{2}{h^{2}}\\left(2 - \\cos\\left(\\frac{2\\pi k}{N}\\right) - \\cos\\left(\\frac{2\\pi l}{N}\\right)\\right) \\\\\n&= \\frac{4}{h^{2}}\\left(\\sin^{2}\\left(\\frac{\\pi k}{N}\\right) + \\sin^{2}\\left(\\frac{\\pi l}{N}\\right)\\right).\n\\end{align*}\nThus, the eigenpairs of $S$ are $\\left(\\phi_{k,l},\\,\\lambda_{k,l}(S)\\right)$ with\n$$\n\\lambda_{k,l}(S) = \\frac{4}{h^{2}}\\left(\\sin^{2}\\left(\\frac{\\pi k}{N}\\right) + \\sin^{2}\\left(\\frac{\\pi l}{N}\\right)\\right).\n$$\nThe constant mode $(k,l)=(0,0)$ yields $\\lambda_{0,0}(S) = 0$, reflecting the nullspace associated with the periodic Laplacian. Since iterative solvers for the rigid-lid or free-surface external mode act on the zero-mean subspace, we exclude this mode from consideration.\n\nThe Helmholtz operator is $H \\equiv I + \\alpha S$ with $\\alpha > 0$. Because $I$ acts as multiplication by $1$ on any mode, the eigenvalues of $H$ on mode $(k,l)$ are\n$$\n\\mu_{k,l}(H) = 1 + \\alpha \\lambda_{k,l}(S) = 1 + \\alpha\\,\\frac{4}{h^{2}}\\left(\\sin^{2}\\left(\\frac{\\pi k}{N}\\right) + \\sin^{2}\\left(\\frac{\\pi l}{N}\\right)\\right).\n$$\nTo obtain the spectral condition number on the zero-mean subspace, we need the largest and smallest positive eigenvalues over all $(k,l)\\neq(0,0)$.\n\nFor the smallest positive eigenvalue, we minimize $\\sin^{2}\\left(\\frac{\\pi k}{N}\\right) + \\sin^{2}\\left(\\frac{\\pi l}{N}\\right)$ over $(k,l)\\neq(0,0)$. The minimum is attained at the fundamental modes $(k,l)=(1,0)$ or $(k,l)=(0,1)$, giving\n$$\n\\lambda_{\\min}(S) = \\frac{4}{h^{2}}\\sin^{2}\\left(\\frac{\\pi}{N}\\right),\n\\quad\n\\mu_{\\min}(H) = 1 + \\alpha\\,\\frac{4}{h^{2}}\\sin^{2}\\left(\\frac{\\pi}{N}\\right).\n$$\nFor the largest eigenvalue, we maximize $\\sin^{2}\\left(\\frac{\\pi k}{N}\\right) + \\sin^{2}\\left(\\frac{\\pi l}{N}\\right)$. With $N$ even, the maximum is attained at $(k,l)=\\left(\\frac{N}{2},\\frac{N}{2}\\right)$ because $\\sin^{2}\\left(\\frac{\\pi N/2}{N}\\right) = \\sin^{2}\\left(\\frac{\\pi}{2}\\right) = 1$. Thus,\n$$\n\\lambda_{\\max}(S) = \\frac{4}{h^{2}}\\left(1 + 1\\right) = \\frac{8}{h^{2}},\n\\quad\n\\mu_{\\max}(H) = 1 + \\alpha\\,\\frac{8}{h^{2}}.\n$$\nTherefore, the spectral condition number of $H$ on the zero-mean subspace is\n$$\n\\kappa(H) = \\frac{\\mu_{\\max}(H)}{\\mu_{\\min}(H)} = \\frac{1 + \\alpha\\,\\frac{8}{h^{2}}}{\\,1 + \\alpha\\,\\frac{4}{h^{2}}\\sin^{2}\\left(\\frac{\\pi}{N}\\right)\\,}.\n$$\nThis is a closed-form analytic expression in terms of $N$, $h$, and $\\alpha$. It shows that the Helmholtz shift $I$ regularizes the spectrum by lifting the smallest eigenvalues, improving the conditioning relative to the pure elliptic operator on the zero-mean subspace, a fact central to the design of efficient external mode solvers in free-surface formulations.",
            "answer": "$$\\boxed{\\frac{1+\\alpha\\,\\frac{8}{h^{2}}}{1+\\alpha\\,\\frac{4}{h^{2}}\\sin^{2}\\!\\left(\\frac{\\pi}{N}\\right)}}$$"
        }
    ]
}