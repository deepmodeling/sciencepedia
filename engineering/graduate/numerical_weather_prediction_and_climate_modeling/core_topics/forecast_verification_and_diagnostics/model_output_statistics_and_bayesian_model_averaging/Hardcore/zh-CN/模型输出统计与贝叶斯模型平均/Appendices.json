{
    "hands_on_practices": [
        {
            "introduction": "评估连续变量（如温度）的概率预报质量是模式输出统计的核心任务。连续概率排位分数（CRPS）是一个关键的评估工具，它能够同时衡量预报的锐度（sharpness）和可靠性（reliability）。通过这个实践练习 ，你将推导高斯分布下的CRPS表达式，并用它来量化统计后处理如何通过修正偏差和调整离散度来提升预报技巧。",
            "id": "4065230",
            "problem": "一个来自数值天气预报（NWP）系统的特定地点的 $2\\,\\mathrm{m}$ 气温预报，通过与一个观测值进行对比验证。原始集合预报被近似为一个高斯预测分布，其均值为 $\\mu_{\\mathrm{r}} = 289\\,\\mathrm{K}$，标准差为 $\\sigma_{\\mathrm{r}} = 2\\,\\mathrm{K}$。通过模式输出统计（MOS）方法获得并符合贝叶斯模型平均（BMA）原则的校准后预测分布，表示为一个高斯分布，其均值为 $\\mu_{\\mathrm{c}} = 291\\,\\mathrm{K}$，标准差为 $\\sigma_{\\mathrm{c}} = 2.5\\,\\mathrm{K}$。用于验证的观测值为 $y = 291\\,\\mathrm{K}$。\n\n从连续分级概率评分（CRPS）作为预测累积分布函数和观测值的泛函的正式定义出发，推导出一个正态预测分布的CRPS的闭式表达式。该表达式应使用标准化误差 $z = (y - \\mu)/\\sigma$、标准正态概率密度函数和标准正态累积分布函数来表示。然后，使用此表达式计算原始集合预报（$\\mu_{\\mathrm{r}}, \\sigma_{\\mathrm{r}}$）和校准后的MOS/BMA分布（$\\mu_{\\mathrm{c}}, \\sigma_{\\mathrm{c}}$）在观测值 $y$ 处的CRPS。\n\n将校准带来的改进定义为 $\\Delta = \\mathrm{CRPS}_{\\mathrm{raw}} - \\mathrm{CRPS}_{\\mathrm{calibrated}}$。计算 $\\Delta$ 并以 $\\mathrm{K}$ 为单位表示最终数值答案。将最终答案四舍五入至四位有效数字。此外，利用推导出的表达式和科学支持的推理，定性解释集合预报的校准（偏差校正和离散度调整）如何相对于原始集合预报影响CRPS。",
            "solution": "首先验证问题以确保其科学上合理、提法得当且内容完整。\n\n### 步骤 1：提取已知条件\n- 验证观测值：$y = 291\\,\\mathrm{K}$\n- 原始集合预报预测分布：一个高斯分布，均值为 $\\mu_{\\mathrm{r}} = 289\\,\\mathrm{K}$，标准差为 $\\sigma_{\\mathrm{r}} = 2\\,\\mathrm{K}$。\n- 校准后的MOS/BMA预测分布：一个高斯分布，其均值为 $\\mu_{\\mathrm{c}} = 291\\,\\mathrm{K}$，标准差为 $\\sigma_{\\mathrm{c}} = 2.5\\,\\mathrm{K}$。\n- 改进的定义：$\\Delta = \\mathrm{CRPS}_{\\mathrm{raw}} - \\mathrm{CRPS}_{\\mathrm{calibrated}}$。\n- 任务 1：对于正态预测分布 $N(\\mu, \\sigma^2)$ 和观测值 $y$，推导连续分级概率评分（CRPS）的闭式表达式，用标准化误差 $z = (y - \\mu)/\\sigma$、标准正态概率密度函数 $\\phi(z)$ 和标准正态累积分布函数 $\\Phi(z)$ 表示。\n- 任务 2：计算 $\\mathrm{CRPS}_{\\mathrm{raw}}$ 和 $\\mathrm{CRPS}_{\\mathrm{calibrated}}$。\n- 任务 3：计算 $\\Delta$，保留四位有效数字。\n- 任务 4：定性解释校准如何影响CRPS。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在数值天气预报和预报验证领域有坚实的基础。连续分级概率评分（CRPS）、模式输出统计（MOS）和贝叶斯模型平均（BMA）都是标准且成熟的概念。物理量及其数值（以开尔文为单位的气温、标准差）是符合实际的。问题是自洽的，提供了所有必要的数据和定义。任务陈述清晰，并能导出一个唯一且有意义的解。不存在科学或逻辑上的矛盾、歧义或不切实际的假设。\n\n### 步骤 3：结论和行动\n该问题被判定为**有效**。现在开始求解过程。\n\n### 正态分布CRPS的推导\n对于预测累积分布函数（CDF）$F(x)$和单个标量观测值 $y$，CRPS可以使用一种计算上更方便的替代形式来定义：\n$$\n\\mathrm{CRPS}(F, y) = E_F[|X - y|] - \\frac{1}{2} E_F[|X - X'|]\n$$\n其中 $X$ 和 $X'$ 是从具有CDF $F$ 的预测分布中抽取的独立随机变量。\n\n在本问题中，预测分布是高斯分布，$X \\sim N(\\mu, \\sigma^2)$。\n\n首先，我们计算第二项 $\\frac{1}{2} E_F[|X - X'|]$。\n令 $Z = X - X'$。由于 $X$ 和 $X'$ 是独立同分布于 $N(\\mu, \\sigma^2)$，它们的差 $Z$ 服从一个正态分布，其均值为 $E[Z] = E[X] - E[X'] = \\mu - \\mu = 0$，方差为 $\\mathrm{Var}(Z) = \\mathrm{Var}(X) + \\mathrm{Var}(X') = \\sigma^2 + \\sigma^2 = 2\\sigma^2$。因此，$Z \\sim N(0, 2\\sigma^2)$。$Z$ 的标准差是 $\\sigma_Z = \\sqrt{2}\\sigma$。\n一个均值为零的正态变量 $Z$ 的绝对值的期望是其平均绝对偏差，由 $\\sigma_Z \\sqrt{2/\\pi}$ 给出。\n$$\nE[|X - X'|] = E[|Z|] = (\\sqrt{2}\\sigma) \\sqrt{\\frac{2}{\\pi}} = \\frac{2\\sigma}{\\sqrt{\\pi}}\n$$\n因此，第二项为：\n$$\n\\frac{1}{2} E[|X - X'|] = \\frac{1}{2} \\left( \\frac{2\\sigma}{\\sqrt{\\pi}} \\right) = \\frac{\\sigma}{\\sqrt{\\pi}}\n$$\n\n接下来，我们计算第一项 $E_F[|X - y|]$。\n令 $W = X - y$。随机变量 $W$ 服从一个正态分布，其均值为 $E[W] = E[X] - y = \\mu - y$，方差为 $\\mathrm{Var}(W) = \\mathrm{Var}(X) = \\sigma^2$。因此，$W \\sim N(\\mu - y, \\sigma^2)$。\n我们需要计算 $E[|W|]$。令 $\\mu_W = \\mu - y$。\n$$\nE[|W|] = \\int_{-\\infty}^{\\infty} |w| \\frac{1}{\\sqrt{2\\pi}\\sigma} \\exp\\left(-\\frac{(w - \\mu_W)^2}{2\\sigma^2}\\right) dw\n$$\n让我们进行变量替换到标准正态空间：$u = (w - \\mu_W)/\\sigma$，因此 $w = \\sigma u + \\mu_W$ 且 $dw = \\sigma du$。标准正态PDF为 $\\phi(u) = \\frac{1}{\\sqrt{2\\pi}}\\exp(-u^2/2)$。\n$$\nE[|W|] = \\int_{-\\infty}^{\\infty} |\\sigma u + \\mu_W| \\phi(u) du = \\sigma \\int_{-\\infty}^{\\infty} |u + \\mu_W/\\sigma| \\phi(u) du\n$$\n我们识别出标准化误差 $z = (y - \\mu)/\\sigma$，所以 $\\mu_W/\\sigma = (\\mu-y)/\\sigma = -z$。\n$$\nE[|X - y|] = \\sigma \\int_{-\\infty}^{\\infty} |u - z| \\phi(u) du\n$$\n我们在 $u=z$ 处拆分积分：\n$$\nE[|X - y|] = \\sigma \\left[ \\int_{-\\infty}^{z} (z-u)\\phi(u)du + \\int_{z}^{\\infty} (u-z)\\phi(u)du \\right]\n$$\n$$\n= \\sigma \\left[ z\\int_{-\\infty}^{z}\\phi(u)du - \\int_{-\\infty}^{z}u\\phi(u)du + \\int_{z}^{\\infty}u\\phi(u)du - z\\int_{z}^{\\infty}\\phi(u)du \\right]\n$$\n我们使用标准正态分布的性质：\n- $\\int_{-\\infty}^{z}\\phi(u)du = \\Phi(z)$\n- $\\int_{z}^{\\infty}\\phi(u)du = 1 - \\Phi(z)$\n- $\\int u\\phi(u)du = -\\phi(u)$ （因为 $d\\phi(u)/du = -u\\phi(u)$），所以 $\\int_{-\\infty}^{z}u\\phi(u)du = [-\\phi(u)]_{-\\infty}^{z} = -\\phi(z)$，且 $\\int_{z}^{\\infty}u\\phi(u)du = [-\\phi(u)]_{z}^{\\infty} = \\phi(z)$。\n\n代入这些结果：\n$$\nE[|X - y|] = \\sigma \\left[ z\\Phi(z) - (-\\phi(z)) + (\\phi(z)) - z(1 - \\Phi(z)) \\right]\n$$\n$$\n= \\sigma \\left[ z\\Phi(z) + \\phi(z) + \\phi(z) - z + z\\Phi(z) \\right]\n$$\n$$\n= \\sigma \\left[ 2z\\Phi(z) - z + 2\\phi(z) \\right] = \\sigma \\left[ z(2\\Phi(z) - 1) + 2\\phi(z) \\right]\n$$\n结合两项，我们得到正态分布CRPS的最终表达式：\n$$\n\\mathrm{CRPS}(N(\\mu, \\sigma^2), y) = \\sigma \\left[ z(2\\Phi(z) - 1) + 2\\phi(z) \\right] - \\frac{\\sigma}{\\sqrt{\\pi}}\n$$\n$$\n\\mathrm{CRPS} = \\sigma \\left( z(2\\Phi(z) - 1) + 2\\phi(z) - \\frac{1}{\\sqrt{\\pi}} \\right)\n$$\n这就是所需的闭式表达式。\n\n### 计算原始和校准后集合的CRPS\n我们将使用以下常数的数值：\n- $\\Phi(0) = 0.5$\n- $\\phi(0) = 1/\\sqrt{2\\pi} \\approx 0.398942$\n- 对于 $z=1$：$\\Phi(1) \\approx 0.841345$，$\\phi(1) = \\exp(-0.5)/\\sqrt{2\\pi} \\approx 0.241971$\n- $1/\\sqrt{\\pi} \\approx 0.564190$\n\n**1. 原始集合的CRPS ($\\mathrm{CRPS}_{\\mathrm{raw}}$)**\n- 已知：$\\mu_{\\mathrm{r}} = 289\\,\\mathrm{K}$，$\\sigma_{\\mathrm{r}} = 2\\,\\mathrm{K}$，$y = 291\\,\\mathrm{K}$。\n- 标准化误差：$z_{\\mathrm{r}} = (291 - 289)/2 = 1$。\n- $\\mathrm{CRPS}_{\\mathrm{raw}} = \\sigma_{\\mathrm{r}} \\left( z_{\\mathrm{r}}(2\\Phi(z_{\\mathrm{r}}) - 1) + 2\\phi(z_{\\mathrm{r}}) - \\frac{1}{\\sqrt{\\pi}} \\right)$\n- $\\mathrm{CRPS}_{\\mathrm{raw}} = 2 \\left( 1(2\\Phi(1) - 1) + 2\\phi(1) - \\frac{1}{\\sqrt{\\pi}} \\right)$\n- $\\mathrm{CRPS}_{\\mathrm{raw}} \\approx 2 \\left( 1(2 \\times 0.841345 - 1) + 2 \\times 0.241971 - 0.564190 \\right)$\n- $\\mathrm{CRPS}_{\\mathrm{raw}} \\approx 2 \\left( (1.68269 - 1) + 0.483942 - 0.564190 \\right)$\n- $\\mathrm{CRPS}_{\\mathrm{raw}} \\approx 2 \\left( 0.68269 + 0.483942 - 0.564190 \\right) = 2(0.602442) \\approx 1.20488\\,\\mathrm{K}$。\n\n**2. 校准后集合的CRPS ($\\mathrm{CRPS}_{\\mathrm{calibrated}}$)**\n- 已知：$\\mu_{\\mathrm{c}} = 291\\,\\mathrm{K}$，$\\sigma_{\\mathrm{c}} = 2.5\\,\\mathrm{K}$，$y = 291\\,\\mathrm{K}$。\n- 标准化误差：$z_{\\mathrm{c}} = (291 - 291)/2.5 = 0$。\n- $\\mathrm{CRPS}_{\\mathrm{calibrated}} = \\sigma_{\\mathrm{c}} \\left( z_{\\mathrm{c}}(2\\Phi(z_{\\mathrm{c}}) - 1) + 2\\phi(z_{\\mathrm{c}}) - \\frac{1}{\\sqrt{\\pi}} \\right)$\n- 当 $z_c = 0$ 时，第一项为 $0$。\n- $\\mathrm{CRPS}_{\\mathrm{calibrated}} = 2.5 \\left( 2\\phi(0) - \\frac{1}{\\sqrt{\\pi}} \\right)$\n- $\\mathrm{CRPS}_{\\mathrm{calibrated}} \\approx 2.5 \\left( 2 \\times 0.398942 - 0.564190 \\right)$\n- $\\mathrm{CRPS}_{\\mathrm{calibrated}} \\approx 2.5 \\left( 0.797884 - 0.564190 \\right) = 2.5(0.233694) \\approx 0.584235\\,\\mathrm{K}$。\n\n### 改进（$\\Delta$）的计算\n改进是由于校准导致的CRPS减少量。\n$$\n\\Delta = \\mathrm{CRPS}_{\\mathrm{raw}} - \\mathrm{CRPS}_{\\mathrm{calibrated}}\n$$\n$$\n\\Delta \\approx 1.20488\\,\\mathrm{K} - 0.584235\\,\\mathrm{K} \\approx 0.620645\\,\\mathrm{K}\n$$\n四舍五入到四位有效数字，我们得到 $\\Delta \\approx 0.6206\\,\\mathrm{K}$。\n\n### 定性解释\n推导出的公式 $\\mathrm{CRPS} = \\sigma ( z(2\\Phi(z) - 1) + 2\\phi(z) - 1/\\sqrt{\\pi} )$ 揭示了校准的两个主要组成部分——偏差校正和离散度调整——如何影响评分。CRPS是一种既评估概率预报的锐度（集中度）又评估其可靠性（统计一致性）的正常评分规则。较低的CRPS表示更好的预报。\n\n1.  **偏差校正（影响 $z$）：** 偏差校正调整预报分布的均值 $\\mu$，使其在平均意义上更接近观测结果 $y$。这直接减小了标准化误差的绝对值 $|z| = |y-\\mu|/\\sigma$。括号中的项 $g(z) = z(2\\Phi(z) - 1) + 2\\phi(z) - 1/\\sqrt{\\pi}$ 是一个关于 $z$ 的非负函数，在 $z=0$ 时（即预报均值等于观测值时）达到全局最小值。因此，在 $\\sigma$ 保持不变的情况下，通过使 $\\mu$ 更接近 $y$（从而使 $z$ 更接近 $0$）来减小偏差，总会减小 $g(z)$ 的值，从而导致更低（更好）的CRPS。在本问题中，对于这个特定实例，校准在偏差校正方面是完美的，将 $\\mu$ 从 $289\\,\\mathrm{K}$ 移动到 $291\\,\\mathrm{K}$，恰好与观测值一致。这使得 $z$ 从 $1$ 变为 $0$，显著降低了 $g(z)$ 的值，从而极大地改进了评分。\n\n2.  **离散度调整（影响 $\\sigma$）：** 离散度调整修改预报分布的标准差 $\\sigma$。原始集合预报通常是离散度不足的（过于自信），意味着它们的离散度太小，无法准确表示真实的预报不确定性。校准，特别是使用像BMA这样的方法，通常会将离散度增加到一个更可靠的值。改变 $\\sigma$ 对CRPS的影响是双重的：\n    - 表达式前面有一个直接的线性缩放因子 $\\sigma$。增加 $\\sigma$ 会直接增加CRPS，惩罚那些不够锐利的预报。\n    - $z$ 的值也依赖于 $\\sigma$。\n    在我们的特定案例中，离散度从 $\\sigma_{\\mathrm{r}} = 2\\,\\mathrm{K}$ 增加到 $\\sigma_{\\mathrm{c}} = 2.5\\,\\mathrm{K}$。对于校准后的情况，$z=0$，因此 $\\mathrm{CRPS}_{\\mathrm{calibrated}} \\propto \\sigma_{\\mathrm{c}}$。离散度从 $2\\,\\mathrm{K}$ 增加到 $2.5\\,\\mathrm{K}$ 的作用是使评分变差。然而，这个惩罚远小于消除偏差（将 $z$ 从 $1$ 减小到 $0$）带来的巨大增益。净效应是显著的改进（$\\Delta  0$）。这说明了CRPS所评估的基本权衡：校准后的预报锐度较低（$\\sigma$ 更大），但更可靠（无偏差），而在本案例中，可靠性带来的增益远远超过了锐度上的损失。对于确定性预报（$\\sigma \\to 0$），CRPS收敛于绝对误差 $|y-\\mu|$。校准确保了概率预报在出错时因过于自信而受到惩罚。\n\n总之，校准通过纠正原始集合预报的显著偏差，提高了整体预报质量，即使这需要增加预报的离散度。CRPS指标正确地将此识别为净改进。",
            "answer": "$$\\boxed{0.6206}$$"
        },
        {
            "introduction": "对于降水等二元事件的概率预报，布里尔分数（Brier Score）及其分解是标准的评估方法。它将预报技巧分解为可靠性、分辨率和不确定性三个部分，从而提供比单一分数更深刻的诊断信息。本练习  将在一个理想的校准情景下，引导你计算这些分量，帮助你理解预报技巧的来源以及完美校准的含义。",
            "id": "4065258",
            "problem": "考虑一个二元事件指示符 $Y \\in \\{0,1\\}$，它与一个由校准的逻辑斯蒂模型输出统计（MOS）系统生成的预报相关联。其中，模型输出统计（MOS）是指对数值天气预报输出进行统计后处理以生成校准概率的方法。设 $X$ 是一个概括了相关数值天气预报场的标量预测因子，预报概率为 $p(X) = \\sigma(\\alpha + \\beta X)$，其中 $\\sigma(z) = \\frac{1}{1 + \\exp(-z)}$。在此背景下，校准意味着对于所有 $X$，都有 $\\mathbb{P}(Y=1 \\mid X) = p(X)$。Brier分数定义为预报概率与事件观测值之间的均方误差。\n\n现给定以下科学上合理且自洽的设定。预测因子 $X$ 取两个值，$x_{1} = -1$ 和 $x_{2} = 1$，其概率分别为 $w_{1} = 0.7$ 和 $w_{2} = 0.3$。逻辑斯蒂MOS参数为 $\\alpha = 0$ 和 $\\beta = \\ln(3)$。因此，预报概率为 $p_{1} = p(x_{1})$ 和 $p_{2} = p(x_{2})$，并且校准意味着条件事件概率等于这些预报概率。\n\n从基本定义（Brier分数的期望平方误差和条件恒等式，如全期望定律和全方差定律）出发，推导此二元事件的Brier分数，并将其分解为三个经典分量：可靠性、分辨率和不确定性。对于给定的校准的逻辑斯蒂MOS预报，明确地计算每个分量的值，并最终确定Brier分数的值。\n\n将最终的Brier分数表示为一个四舍五入到四位有效数字的纯数。无需单位。",
            "solution": "该问题要求计算给定校准的逻辑斯蒂模型输出统计（MOS）系统的Brier分数，并将其分解为可靠性、分辨率和不确定性。\n\n首先，我们根据预报概率 $p = p(X)$ 和二元事件结果 $Y$ 建立Brier分数（BS）及其分量的定义。Brier分数是预报概率与观测值之间差的平方的期望值：\n$$BS = \\mathbb{E}[(p(X) - Y)^2]$$\n\nBrier分数可以分解为三个分量：可靠性（REL）、分辨率（RES）和不确定性（UNC），遵循以下关系：\n$$BS = REL - RES + UNC$$\n\n这些分量的定义如下：\n1.  **可靠性（REL）**：衡量预报概率与该预报概率下事件的平均观测频率之间的一致性。它是预报概率与给定预报下事件的条件概率之差的平方的期望值。\n    $$REL = \\mathbb{E}[ (p(X) - \\mathbb{P}(Y=1 \\mid p(X)))^2 ]$$\n2.  **分辨率（RES）**：衡量预报区分不同事件频率的能力。它是条件事件概率与总体气候概率 $\\bar{y} = \\mathbb{P}(Y=1)$ 之差的平方的期望值。\n    $$RES = \\mathbb{E}[ (\\mathbb{P}(Y=1 \\mid p(X)) - \\bar{y})^2 ]$$\n3.  **不确定性（UNC）**：代表事件的内在不确定性，仅取决于气候概率。\n    $$UNC = \\bar{y}(1 - \\bar{y})$$\n\n我们已知以下信息：\n- 预测因子 $X$ 可以取值为 $x_1 = -1$（概率 $w_1 = \\mathbb{P}(X=x_1) = 0.7$）和 $x_2 = 1$（概率 $w_2 = \\mathbb{P}(X=x_2) = 0.3$）。\n- 预报概率由逻辑斯蒂函数给出 $p(X) = \\sigma(\\alpha + \\beta X)$，其中 $\\sigma(z) = \\frac{1}{1 + \\exp(-z)}$。\n- 参数为 $\\alpha = 0$ 和 $\\beta = \\ln(3)$。\n- 预报是校准的，意味着 $\\mathbb{P}(Y=1 \\mid X) = p(X)$。\n\n我们的第一步是计算预报概率 $p_1 = p(x_1)$ 和 $p_2 = p(x_2)$。\n对于 $x_1 = -1$：\n$$p_1 = p(x_1) = \\sigma(0 + \\ln(3) \\times (-1)) = \\sigma(-\\ln(3)) = \\frac{1}{1 + \\exp(-(-\\ln(3)))} = \\frac{1}{1 + \\exp(\\ln(3))} = \\frac{1}{1+3} = \\frac{1}{4}$$\n对于 $x_2 = 1$：\n$$p_2 = p(x_2) = \\sigma(0 + \\ln(3) \\times 1) = \\sigma(\\ln(3)) = \\frac{1}{1 + \\exp(-\\ln(3))} = \\frac{1}{1 + \\frac{1}{3}} = \\frac{1}{\\frac{4}{3}} = \\frac{3}{4}$$\n\n接下来，我们计算气候概率 $\\bar{y} = \\mathbb{P}(Y=1)$。使用全概率定律：\n$$\\bar{y} = \\mathbb{E}[Y] = \\mathbb{E}[\\mathbb{P}(Y=1 \\mid X)]$$\n由于预报是校准的，$\\mathbb{P}(Y=1 \\mid X=x_k) = p_k$。\n$$\\bar{y} = \\mathbb{P}(Y=1 \\mid X=x_1)\\mathbb{P}(X=x_1) + \\mathbb{P}(Y=1 \\mid X=x_2)\\mathbb{P}(X=x_2)$$\n$$\\bar{y} = p_1 w_1 + p_2 w_2 = \\left(\\frac{1}{4}\\right)(0.7) + \\left(\\frac{3}{4}\\right)(0.3) = 0.25 \\times 0.7 + 0.75 \\times 0.3$$\n$$\\bar{y} = 0.175 + 0.225 = 0.4$$\n\n现在我们可以计算Brier分数的每个分量。\n\n**1. 可靠性（REL）**\n题目说明预报是校准的。这意味着对于任何预报概率值 $p_k$，事件发生的条件概率都等于该概率，即 $\\mathbb{P}(Y=1 \\mid p(X)=p_k) = p_k$。由于在这种情况下 $p(X)$ 是 $X$ 的一一对应函数，条件 $\\mathbb{P}(Y=1 \\mid X) = p(X)$ 意味着 $\\mathbb{P}(Y=1 \\mid p(X)) = p(X)$。\n将此代入可靠性的定义中：\n$$REL = \\mathbb{E}[ (p(X) - p(X))^2 ] = \\mathbb{E}[0] = 0$$\n因此，对于任何完全校准的预报，其可靠性分量均为零。\n\n**2. 不确定性（UNC）**\n不确定性仅取决于气候概率 $\\bar{y}$。\n$$UNC = \\bar{y}(1 - \\bar{y}) = 0.4(1 - 0.4) = 0.4 \\times 0.6 = 0.24$$\n\n**3. 分辨率（RES）**\n分辨率计算为条件概率与气候平均值之间平方差的加权平均。期望是基于 $X$ 的分布计算的。\n$$RES = \\mathbb{E}[ (\\mathbb{P}(Y=1 \\mid X) - \\bar{y})^2 ] = \\mathbb{E}[ (p(X) - \\bar{y})^2 ]$$\n$$RES = w_1(p_1 - \\bar{y})^2 + w_2(p_2 - \\bar{y})^2$$\n$$RES = 0.7 \\left(\\frac{1}{4} - 0.4\\right)^2 + 0.3 \\left(\\frac{3}{4} - 0.4\\right)^2$$\n$$RES = 0.7 (0.25 - 0.4)^2 + 0.3 (0.75 - 0.4)^2$$\n$$RES = 0.7 (-0.15)^2 + 0.3 (0.35)^2$$\n$$RES = 0.7 (0.0225) + 0.3 (0.1225) = 0.01575 + 0.03675 = 0.0525$$\n\n最后，我们使用分解式计算Brier分数。\n$$BS = REL - RES + UNC = 0 - 0.0525 + 0.24 = 0.1875$$\n\n作为验证，我们可以从Brier分数的基本定义直接计算它。对于一个校准的预报，Brier分数可简化如下：\n$$BS = \\mathbb{E}[(p(X) - Y)^2] = \\mathbb{E}[\\mathbb{E}[(p(X) - Y)^2 \\mid X]]$$\n内层期望是参数为 $p(X)$ 的伯努利试验的方差，即 $p(X)(1 - p(X))$。\n$$BS = \\mathbb{E}[p(X)(1 - p(X))]$$\n这个值是根据 $X$ 的不同取值计算的加权平均：\n$$BS = w_1 p_1(1-p_1) + w_2 p_2(1-p_2)$$\n$$BS = 0.7 \\left(\\frac{1}{4}\\right)\\left(1 - \\frac{1}{4}\\right) + 0.3 \\left(\\frac{3}{4}\\right)\\left(1 - \\frac{3}{4}\\right)$$\n$$BS = 0.7 (0.25)(0.75) + 0.3 (0.75)(0.25)$$\n$$BS = 0.7(0.1875) + 0.3(0.1875) = (0.7 + 0.3)(0.1875) = 1 \\times 0.1875 = 0.1875$$\n这证实了从分解中得到的结果。\n\n这三个分量是：\n- 可靠性：$REL = 0$\n- 分辨率：$RES = 0.0525$\n- 不确定性：$UNC = 0.24$\n\nBrier分数是 $0.1875$。题目要求将最终的Brier分数四舍五入到四位有效数字。数值 $0.1875$ 已经恰好是四位有效数字，因此无需四舍五入。",
            "answer": "$$\\boxed{0.1875}$$"
        },
        {
            "introduction": "概率预报的一个重要应用是提供预测区间，但我们如何验证一个号称“$90\\%$置信”的区间是否名副其实？这涉及到“覆盖率”的概念，即观测值落入预测区间的实际频率。本练习  将引导你推导当预报方差存在系统性偏差时，名义预测区间的实际覆盖率，这对于理解和诊断MOS或BMA系统中的不确定性量化是否可靠至关重要。",
            "id": "4065264",
            "problem": "在数值天气预报中，使用模式输出统计 (MOS) 的后处理旨在校正原始模式输出中的系统性误差，并为给定地点和预报时效的某个天气量（例如，近地面温度）生成预测分布。MOS 中一种常见且经过充分检验的方法是，假设在给定预测因子（例如，集合平均和离散度）的条件下，验证观测值 $Y$ 服从高斯分布，其均值通过线性回归进行校正，方差根据过去的误差进行估计。假设给定预测因子时，$Y$ 的 MOS 预测分布是均值为 $\\mu_{\\text{MOS}}$、方差为 $\\sigma_{\\text{MOS}}^{2}$ 的高斯分布，并且预测区间是通过对该预测累积分布函数求逆来构建的。水平为 $1-\\alpha$ 的预期名义双侧预测区间使用围绕 MOS 均值的对称分位数。然而，在实践中，即使预测均值是无偏的，由于抽样变异性、模态转换或不完美的离散度-技巧关系，方差估计相对于真实的验证分布也可能存在偏差校准问题。\n\n假设存在以下科学上真实且自洽的设定：\n- MOS 预测分布为 $Y \\mid \\text{predictors} \\sim \\mathcal{N}\\!\\left(\\mu_{\\text{MOS}},\\,\\sigma_{\\text{MOS}}^{2}\\right)$。\n- 实际验证分布的均值是无偏的，但有一个乘性方差偏差校准因子 $\\lambda0$：$Y \\mid \\text{predictors} \\sim \\mathcal{N}\\!\\left(\\mu_{\\text{MOS}},\\,\\lambda\\,\\sigma_{\\text{MOS}}^{2}\\right)$。\n- 令 $\\Phi$ 表示标准正态分布的累积分布函数，令 $\\Phi^{-1}$ 表示其分位数函数。令 $z_{p}=\\Phi^{-1}(p)$，其中 $p\\in(0,1)$。\n\n任务：\n1. 从预测区间的定义（即预测累积分布函数的原像）出发，构建由 MOS 预测分布所隐含的、$Y$ 的名义双侧 $(1-\\alpha)$ 预测区间。\n2. 使用频率学派的覆盖概率定义和高斯分布的性质，推导在方差因子为 $\\lambda$ 的真实验证分布下，此名义 $(1-\\alpha)$ 预测区间的实际覆盖概率。\n\n将你的最终答案表示为关于 $\\alpha$ 和 $\\lambda$ 的实际覆盖概率的单一闭式解析表达式。无需进行数值计算。如果在推导中引入任何其他函数，请在推导过程中明确定义。最终答案必须是单一表达式，且不得包含单位或不等式。",
            "solution": "问题陈述已经过验证，被认为是科学上合理、适定且无矛盾的。任务是当基础高斯过程的方差存在偏差校准问题时，推导名义预测区间的实际覆盖概率。\n\n推导过程按要求分为两部分。\n\n**第 1 部分：名义预测区间的构建**\n\n名义预测区间是基于假设的模式输出统计 (MOS) 预测分布构建的。该分布是给定预测因子条件下，验证观测值 $Y$ 的正态分布：\n$$ Y \\mid \\text{predictors} \\sim \\mathcal{N}\\!\\left(\\mu_{\\text{MOS}},\\,\\sigma_{\\text{MOS}}^{2}\\right) $$\n名义覆盖水平为 $1-\\alpha$ 的双侧预测区间由该分布的分位数定义。具体而言，对称区间是使用 $\\frac{\\alpha}{2}$ 和 $1-\\frac{\\alpha}{2}$ 分位数构建的。\n\n令 $F_{\\text{MOS}}$ 为此名义分布的累积分布函数 (CDF)。区间 $[L, U]$ 的构建满足 $F_{\\text{MOS}}(L) = \\frac{\\alpha}{2}$ 和 $F_{\\text{MOS}}(U) = 1 - \\frac{\\alpha}{2}$。为了找到这些分位数，我们根据名义分布对随机变量 $Y$ 进行标准化。令 $Z$ 为一个标准正态随机变量，$Z \\sim \\mathcal{N}(0, 1)$。\n$$ Z = \\frac{Y - \\mu_{\\text{MOS}}}{\\sigma_{\\text{MOS}}} $$\n标准正态分布的分位数表示为 $z_{p} = \\Phi^{-1}(p)$，其中 $\\Phi$ 是标准正态分布的 CDF。$Z$ 的期望分位数是 $z_{\\alpha/2}$ 和 $z_{1-\\alpha/2}$。\n名义区间的构建是为了满足：\n$$ P(z_{\\alpha/2} \\le Z \\le z_{1-\\alpha/2}) = 1 - \\alpha $$\n代入 $Z$ 的表达式：\n$$ P\\left(z_{\\alpha/2} \\le \\frac{Y - \\mu_{\\text{MOS}}}{\\sigma_{\\text{MOS}}} \\le z_{1-\\alpha/2}\\right) = 1 - \\alpha $$\n我们可以通过整理不等式来求解 $Y$：\n$$ \\mu_{\\text{MOS}} + \\sigma_{\\text{MOS}}z_{\\alpha/2} \\le Y \\le \\mu_{\\text{MOS}} + \\sigma_{\\text{MOS}}z_{1-\\alpha/2} $$\n因此，名义 $(1-\\alpha)$ 预测区间，记为 $I_{\\text{nom}}$，是：\n$$ I_{\\text{nom}} = [\\mu_{\\text{MOS}} + \\sigma_{\\text{MOS}}z_{\\alpha/2}, \\mu_{\\text{MOS}} + \\sigma_{\\text{MOS}}z_{1-\\alpha/2}] $$\n由于标准正态分布的对称性，我们有 $z_{\\alpha/2} = -z_{1-\\alpha/2}$。该区间可以更紧凑地表示为：\n$$ I_{\\text{nom}} = [\\mu_{\\text{MOS}} - \\sigma_{\\text{MOS}}z_{1-\\alpha/2}, \\mu_{\\text{MOS}} + \\sigma_{\\text{MOS}}z_{1-\\alpha/2}] $$\n\n**第 2 部分：实际覆盖概率的推导**\n\n实际覆盖概率是从*真实*验证分布中随机抽取的值落在*名义*预测区间 $I_{\\text{nom}}$ 内的概率。\n真实分布给出如下：\n$$ Y \\mid \\text{predictors} \\sim \\mathcal{N}\\!\\left(\\mu_{\\text{MOS}},\\,\\lambda\\,\\sigma_{\\text{MOS}}^{2}\\right) $$\n其中 $\\lambda  0$ 是乘性方差偏差校准因子。其主要特征是均值仍为 $\\mu_{\\text{MOS}}$（无偏），但真实方差是 $\\lambda\\sigma_{\\text{MOS}}^2$，因此真实标准差是 $\\sqrt{\\lambda}\\sigma_{\\text{MOS}}$。\n\n我们需要计算概率 $P(Y \\in I_{\\text{nom}})$，其中 $Y$ 服从此真实分布。\n$$ P_{\\text{actual}} = P(\\mu_{\\text{MOS}} - \\sigma_{\\text{MOS}}z_{1-\\alpha/2} \\le Y \\le \\mu_{\\text{MOS}} + \\sigma_{\\text{MOS}}z_{1-\\alpha/2}) $$\n为了评估此概率，我们必须使用其真实均值和真实标准差对 $Y$ 进行标准化。令 $Z'$ 为一个标准正态随机变量，定义为：\n$$ Z' = \\frac{Y - \\mu_{\\text{MOS}}}{\\sqrt{\\lambda}\\sigma_{\\text{MOS}}} \\sim \\mathcal{N}(0, 1) $$\n现在，我们将关于 $Y$ 的不等式转换为关于 $Z'$ 的不等式。\n\n首先，从不等式的各部分减去均值 $\\mu_{\\text{MOS}}$：\n$$ -\\sigma_{\\text{MOS}}z_{1-\\alpha/2} \\le Y - \\mu_{\\text{MOS}} \\le \\sigma_{\\text{MOS}}z_{1-\\alpha/2} $$\n接下来，将各部分除以真实标准差 $\\sqrt{\\lambda}\\sigma_{\\text{MOS}}$（因为 $\\lambda  0$ 且 $\\sigma_{\\text{MOS}}  0$，不等式方向保持不变）：\n$$ \\frac{-\\sigma_{\\text{MOS}}z_{1-\\alpha/2}}{\\sqrt{\\lambda}\\sigma_{\\text{MOS}}} \\le \\frac{Y - \\mu_{\\text{MOS}}}{\\sqrt{\\lambda}\\sigma_{\\text{MOS}}} \\le \\frac{\\sigma_{\\text{MOS}}z_{1-\\alpha/2}}{\\sqrt{\\lambda}\\sigma_{\\text{MOS}}} $$\n简化左侧和右侧的表达式得到：\n$$ -\\frac{z_{1-\\alpha/2}}{\\sqrt{\\lambda}} \\le Z' \\le \\frac{z_{1-\\alpha/2}}{\\sqrt{\\lambda}} $$\n实际覆盖概率是标准正态变量 $Z'$ 落在这个新区间内的概率：\n$$ P_{\\text{actual}} = P\\left(-\\frac{z_{1-\\alpha/2}}{\\sqrt{\\lambda}} \\le Z' \\le \\frac{z_{1-\\alpha/2}}{\\sqrt{\\lambda}}\\right) $$\n这个概率可以用标准正态 CDF $\\Phi(x)$ 表示：\n$$ P_{\\text{actual}} = \\Phi\\left(\\frac{z_{1-\\alpha/2}}{\\sqrt{\\lambda}}\\right) - \\Phi\\left(-\\frac{z_{1-\\alpha/2}}{\\sqrt{\\lambda}}\\right) $$\n利用标准正态 CDF 的对称性 $\\Phi(-x) = 1 - \\Phi(x)$，我们可以简化此表达式：\n$$ P_{\\text{actual}} = \\Phi\\left(\\frac{z_{1-\\alpha/2}}{\\sqrt{\\lambda}}\\right) - \\left[1 - \\Phi\\left(\\frac{z_{1-\\alpha/2}}{\\sqrt{\\lambda}}\\right)\\right] $$\n$$ P_{\\text{actual}} = 2\\Phi\\left(\\frac{z_{1-\\alpha/2}}{\\sqrt{\\lambda}}\\right) - 1 $$\n最后，我们代入定义 $z_{1-\\alpha/2} = \\Phi^{-1}\\left(1 - \\frac{\\alpha}{2}\\right)$，得到以 $\\alpha$ 和 $\\lambda$ 表示的实际覆盖概率的最终表达式：\n$$ P_{\\text{actual}} = 2\\Phi\\left(\\frac{\\Phi^{-1}\\left(1 - \\frac{\\alpha}{2}\\right)}{\\sqrt{\\lambda}}\\right) - 1 $$\n这就是所要求的闭式解析表达式。",
            "answer": "$$\n\\boxed{2\\Phi\\left(\\frac{\\Phi^{-1}\\left(1-\\frac{\\alpha}{2}\\right)}{\\sqrt{\\lambda}}\\right) - 1}\n$$"
        }
    ]
}