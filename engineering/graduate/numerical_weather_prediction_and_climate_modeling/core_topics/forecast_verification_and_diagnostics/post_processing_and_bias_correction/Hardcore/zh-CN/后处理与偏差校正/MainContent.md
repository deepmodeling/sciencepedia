## 引言
数值天气预报（NWP）和气候模型是理解和预[测地球](@entry_id:201133)系统的强大工具，但其输出不可避免地包含系统性偏差和随机误差。为了将这些原始输出转化为对决策者和公众有用的准确预报，后处理与偏差校正技术应运而生，成为连接理论模型与实际应用的关键桥梁。本文旨在解决原始模型预报与用户所需的高精度、高可靠性信息之间的差距，系统性地探讨如何识别、量化并修正这些[模型误差](@entry_id:175815)。读者将通过本文学习到三个核心方面的内容。首先，在“原理与机制”一章中，我们将深入剖析模型误差的来源，并介绍[模型输出统计](@entry_id:1128043)（MOS）、[分位数映射](@entry_id:1130373)（QM）等基础校正方法的统计原理。接着，“应用与跨学科联系”一章将展示这些技术在处理集合预报、极端事件及复杂变量时的具体应用，并探讨其与机器学习、[人工智能公平性](@entry_id:898141)等领域的联系。最后，“动手实践”部分提供了将理论付诸实践的练习机会。通过这三个章节的层层递进，本文将为读者构建一个关于后处理与偏差校正的完整知识框架。

## 原理与机制

数值天气预报（NWP）和气候模型的输出本质上是对复杂物理系统的近似。因此，原始模型输出不可避免地会包含误差。后处理和偏差校正是一套统计方法，旨在通过系统地分析和修正这些误差来提高预报的准确性和可靠性。本章将深入探讨[模型误差](@entry_id:175815)的根本来源、偏差校正的核心原理以及评估校正后预报质量的关键指标和工具。

### [模型误差](@entry_id:175815)与偏差的本质

为了有效校正误差，我们首先必须理解其构成和来源。任何预报误差都可以被分解为一个系统性部分和一个随机部分，这为我们提供了分析和建模的理论基础。

#### 预报误差的分解

考虑一个在时间点 $t$ 对某个标量大气变量（如2米气温）的预报。令 $f_t$ 为模型预报值，$y_t$ 为对应的观测值。预报误差 $e_t$ 定义为观测与预报之差：

$e_t = y_t - f_t$

在足够长的预报和观测样本上，我们可以计算该误差的[期望值](@entry_id:150961)（或时间平均值），这被定义为**系统性偏差**（systematic bias），记作 $b$：

$b = \mathbb{E}[e_t]$

系统性偏差代表了模型预报中可预测的、持续存在的偏离。从总误差中减去系统性偏差后，剩下的部分是**随机误差**（random error），记作 $\epsilon_t$：

$\epsilon_t = e_t - b = y_t - f_t - \mathbb{E}[y_t - f_t]$

根据定义，[随机误差](@entry_id:144890)的[期望值](@entry_id:150961)为零，即 $\mathbb{E}[\epsilon_t] = 0$。后处理的主要目标之一就是对系统性偏差 $b$ 进行估计和校正，同时对[随机误差](@entry_id:144890) $\epsilon_t$ 的统计特性（如其方差）进行建模，从而提供更准确和可靠的确定性或概率性预报 。

#### 系统性偏差的来源

系统性偏差并非凭空产生，而是源于模型构建和预报过程中的各种近似和简化。主要来源包括：

**1. [离散化误差](@entry_id:147889) (Discretization Errors)**：大气运动由一组[非线性偏微分方程](@entry_id:169481)描述。数值模型通过在离散的网格上求解这些方程的近似形式来进行预报。这个过程引入了**[截断误差](@entry_id:140949)**（truncation error）。例如，在模拟大气平流时，一些数值格式（如一阶迎风格式）会引入一个与网格大小 $\Delta x$ 成正比的系统性耗散项。这个[数值耗散](@entry_id:168584)项在数学上类似于一个物理[扩散过程](@entry_id:268015)，它会系统性地削[弱梯度](@entry_id:756667)。在存在持续强梯度的天气现象中，如夜间形成的[稳定边界层](@entry_id:1132265)[逆温](@entry_id:140086)，这种[数值耗散](@entry_id:168584)会系统性地使模拟的[逆温](@entry_id:140086)层偏弱，可能导致预报的夜间最低温度出现系统性偏冷或偏暖的偏差 。

**2. [参数化](@entry_id:265163)误差 (Parameterization Errors)**：许多重要的物理过程，如云的形成、降水、辐射和[湍流](@entry_id:151300)，其尺度小于模型的网格分辨率，因此无法被直接解析。这些过程必须通过所谓的**[参数化](@entry_id:265163)方案**来近似表达。[参数化](@entry_id:265163)方案是基于我们对这些过程的物理理解建立的简化数学关系。这些关系可能存在形式上或参数上的错误。

*   **结构性偏差 (Structural Bias)**：当[参数化](@entry_id:265163)方案的函数形式本身就是错误或不完整时，就会产生结构性偏差。例如，一个简单的能量平衡模型（EBM）可能使用线性的形式 $\mathrm{OLR}_{m}(T) = A_{m} + B_{m} T$ 来近似地球的对外长波辐射（OLR），而真实过程更接近[非线性](@entry_id:637147)的 Stefan-Boltzmann 定律 $\mathrm{OLR}_{t}(T) = \epsilon \sigma T^{4}$。即使[线性模型](@entry_id:178302)在一个特定的参考温度 $T_{*}$ 被精确校准，当气候发生变化（例如，温度的方差 $\sigma_{T}^{2}$ 改变）时，由于[非线性](@entry_id:637147)效应（$\overline{T^{4}} \neq (\overline{T})^{4}$），线性模型也会产生系统性的能量收支误差，从而导致预报的平均温度出现偏差 。
*   **参数性偏差 (Parametric Bias)**：当[参数化](@entry_id:265163)方案的函数形式是合理的，但其中的可调参数值不准确时，会产生参数性偏差。在上述线性化的OLR模型中，如果参数 $A_m$ 或 $B_m$ 的取值与真实气候系统的有效线性响应参数不符，就会导致预报的[平衡态](@entry_id:270364)温度出现一个固定的偏移 。
*   [参数化](@entry_id:265163)方案中的**阈值行为**也是偏差的一个常见来源。例如，一个对流方案可能只在对流有效位能（CAPE）超过某个阈值时才触发。如果真实大气中，在低于该阈值的条件下也存在弱对流，模型就会系统性地漏掉这些事件，导致降水频率或强度的偏差 。

**3. 代表性误差 (Representativeness Errors)**：代表性误差源于观测和模型在尺度和性质上的不匹配。气象观测通常是点测量（如气象站测量的单点温度），而模型预报值是整个网格单元（例如，面积为 $10 \times 10 \ \mathrm{km}^2$）的平均状态。

令 $X(\mathbf{x})$ 为真实大气状态场，模型预报的是网格 $D$ 内的平均值 $H_m(X) = \frac{1}{|D|}\int_{D} X(\mathbf{x})\,\mathrm{d}\mathbf{x}$。而一个位于 $\mathbf{x}_o$ 的站点的观测值 $y$ 对应的是点值 $H_p(X) = X(\mathbf{x}_o)$ 加上仪器噪声 $\epsilon_i$。即使模型完美地预报了网格平均值，它也与点观测值不同。这两者之差，$\epsilon_r = H_p(X) - H_m(X)$，就是[代表性误差](@entry_id:754253)。在数据同化和后处理中，这个误差通常被视为观测误差的一部分，其完整的观测方程为：

$y = H_m(X) + \epsilon_r + \epsilon_i$

[代表性误差](@entry_id:754253) $\epsilon_r$ 的方差 $\sigma_r^2$ 必须与仪器噪声方差 $\sigma_i^2$ 一同被包含在总的观测误差协方差中。当观测算子 $H$ 本身是[非线性](@entry_id:637147)时（例如，模拟卫星辐射亮温），问题会更复杂。由于 Jensen 不等式，网格平均状态的函数值不等于函数值的网格平均值，即 $\mathbb{E}_{\text{space}}[H(X)] \neq H(\mathbb{E}_{\text{space}}[X])$，这也会引入系统性的代表性偏差  。

### 后处理的基本方法

后处理旨在修正上述来源导致的误差。它与数据同化有着本质的区别。**数据同化 (Data Assimilation, DA)** 在模型积分**之前**进行，通过融合最新的观测来优化模型的初始状态，从而影响整个预报轨迹。而**后处理 (Post-processing)** 则在模型积分**完成之后**进行，它将模型的原始输出作为一个输入，通过一个统计模型来生成一个经过校正的、更优的预报，而不改变原始的模型积分过程 。

#### [模型输出统计](@entry_id:1128043) (Model Output Statistics, MOS)

MOS 是最经典和最广泛应用的后处理方法之一。其核心思想是建立一个从模型预报量 $f$ 到观测值 $y$ 的监督学习映射。最简单的形式是线性 MOS，其模型为：

$\hat{y}_t = a + b f_t$

其中 $\hat{y}_t$ 是校正后的预报，系数 $a$ 和 $b$ 通过在历史数据集上最小化[均方误差](@entry_id:175403)来估计。根据[普通最小二乘法](@entry_id:137121)（OLS）原理，在平稳样本下，最优的系数收敛于：

$b^* = \frac{\operatorname{Cov}(y, f)}{\operatorname{Var}(f)}, \quad a^* = \mathbb{E}[y] - b^* \mathbb{E}[f]$

这个线性模型的目标是拟合 $y$ 对 $f$ 的[条件期望](@entry_id:159140) $\mathbb{E}[y \mid f]$。一个简单的**平均偏差校正**（mean bias correction），即从预报中减去历史平均误差 $\mathbb{E}[f] - \mathbb{E}[y]$，等价于一个斜率 $b=1$ 的线性 MOS。然而，这种简单的校正通常是次优的，因为它无法修正**条件偏差**，即偏差随预报值 $f$ 本身而变化的情况（例如，模型在预报极端高温时偏冷，但在预报极端低温时偏暖）。而一个完整的线性 MOS 通[过拟合](@entry_id:139093)斜率 $b$ 能够部分地修正这种条件偏差 。

### 分布校正方法

简单的线性 MOS 主要校正预报的均值和方差。然而，[模型误差](@entry_id:175815)可能体现在整个预报分布的更[高阶矩](@entry_id:266936)（如[偏度](@entry_id:178163)和峰度）上。分布校正方法旨在使校正后预报的整个概率分布与观测的分布相匹配。

#### [分位数映射](@entry_id:1130373) (Quantile Mapping, QM)

[分位数映射](@entry_id:1130373)是一种强大且流行的[非线性](@entry_id:637147)偏差校正技术。其核心思想是，假设模型预报的某个分位数应该对应于观测数据的相同分位数。设 $F_m$ 为模型原始预报在一个校准期内的[累积分布函数](@entry_id:143135)（CDF），$F_o$ 为同期观测值的 CDF。对于一个给定的模型预报值 $x$，其校正后的值 $y^*$ 通过以下变换得到：

$y^* = F_o^{-1}(F_m(x))$

这里 $F_o^{-1}$ 是观测 CDF 的逆函数（即[分位数函数](@entry_id:271351)）。这个过程分为两步：首先，通过 $p = F_m(x)$ 找到预报值 $x$ 在其自身分布中所处的分位数（或“等级”）；然后，通过 $y^* = F_o^{-1}(p)$ 找到在观测分布中处于相同[分位数](@entry_id:178417) $p$ 的值。通过这种方式，校正后预报的整个分布被强制调整为与观测的分布一致 。这一机制的理论基础是**[概率积分变换](@entry_id:262799) (Probability Integral Transform, PIT)** 和**[逆变换采样](@entry_id:139050)**。如果一个[随机变量](@entry_id:195330) $X$ 的 CDF 是 $F_m$，那么 $U = F_m(X)$ 服从 $[0,1]$ 上的均匀分布。因此，$Y^* = F_o^{-1}(U)$ 将会服从 CDF 为 $F_o$ 的分布 。

QM的一个重要特性是它是一个**保序**（或单调）变换。这意味着如果 $x_i  x_j$，则它们的校正值也满足 $y_i^* \le y_j^*$。因此，QM 能保留基于排序的统计量（如[斯皮尔曼等级相关](@entry_id:755150)系数），但会改变依赖于数值大小的统计量（如皮尔逊相关系数和自相关性）。然而，当处理具有离散成分的变量（如降水量，在零点有概率集中）时，需要特别处理，否则可能导致不理想的结果，例如将模型预报的微量降水错误地映射为零  。

#### [贝叶斯模型平均](@entry_id:168960) (Bayesian Model Averaging, BMA)

对于集合预报，我们不仅关心单个预报值的校正，更关心如何将 $K$ 个集合成员的预报融合成一个单一的、经过校准的[概率预报](@entry_id:183505)。BMA 为此提供了一个强大的框架。BMA 将最终的预测[概率密度函数](@entry_id:140610)（PDF）$p(y)$ 视为一个有限[混合分布](@entry_id:276506)：

$p(y) = \sum_{k=1}^{K} w_k \, \mathcal{N}(y \mid a + b f_k, \sigma_k^2)$

在这个模型中，每个集合成员 $f_k$ 都被视为一个独立的“模型”。其预测被一个正态分布 $\mathcal{N}$ 所代表，该分布的均值是经过线性校正后的 $a + b f_k$，方差为 $\sigma_k^2$。最终的 BMA 预报是这些正态分布的加权平均，权重 $w_k$ 非负且总和为1 。

根据全期望和[全方差定律](@entry_id:184705)，这个[混合分布](@entry_id:276506)的预测均值和方差分别为：

$\mathbb{E}[Y] = \sum_{k=1}^K w_k (a + b f_k)$

$\mathrm{Var}(Y) = \sum_{k=1}^K w_k \sigma_k^2 + \sum_{k=1}^K w_k (a + b f_k)^2 - \left(\sum_{k=1}^K w_k (a + b f_k)\right)^2$

BMA 模型的参数具有清晰的物理解释：权重 $w_k$ 反映了第 $k$ 个成员在历史上的相对预报技巧，而成员专属的方差 $\sigma_k^2$ 则允许模型捕捉到不同成员预报的不确定性或离散度技巧的差异。例如，即使两个成员的校正后均值相同，方差较大的成员对极端事件（即分布的尾部）的概率贡献也更大 。

在构建 BMA 模型时，**[可交换性](@entry_id:909050) (exchangeability)** 的概念至关重要。如果集合成员被认为是可交换的，意味着在先验知识中，我们无法区分它们。这种对称性可以通过在模型中“捆绑”参数（例如，对所有成员使用共同的 $\sigma^2$），或在贝叶斯框架下为参数（如权重 $w_k$）赋予对称的先验分布来体现 。

### 校正后预报的检验

如何判断一个经过后处理的[概率预报](@entry_id:183505)是“好”的？一个好的概率预报需要具备多个属性，其中最核心的是**校准度**和**锐度**。

#### 校准度、锐度与恰当评分规则

*   **锐度 (Sharpness)** 是指预报分布自身的集中程度，它是一个只与预报 $F$ 有关而与观测 $Y$ 无关的属性。一个锐度高的预报分布很窄（方差小），表示预报非常确定。例如，预测明天温度在 $[20.1^\circ\mathrm{C}, 20.2^\circ\mathrm{C}]$ 之间，这是一个非常锐的预报 。

*   **校准度 (Calibration)** 或称**可靠性 (Reliability)**，指的是预报概率与观测频率的[统计一致性](@entry_id:162814)。一个完美校准的预报意味着，当预报某事件发生的概率为 $p$ 时，该事件在这些场合下实际发生的频率也确实是 $p$。对于一个连续的[预测分布](@entry_id:165741) $F$，校准意味着观测值 $Y$ 可以被视为从 $F$ 中随机抽取的一个样本 。

锐度和校准度有时会相互矛盾。一个只预报气候平均值的预报可能校准得很好，但毫无锐度。一个极端锐利的预报（如确定性预报）如果错误，其校准度会非常差。预报的目标是在**保证校准的前提下，最大化锐度**。

**恰当评分规则 (Proper Scoring Rules)**，如连续分级概率评分（CRPS）和对数评分，是评估[概率预报](@entry_id:183505)的数学工具。它们的设计初衷就是为了同时奖励校准度和锐度。一个“严格恰当”的评分规则能够确保，当且仅当预报者发出其真实的信念分布时，其期望得分才能达到最优。因此，使用这类评分规则来训练和评估后处理模型，可以自然地引导模型朝着“在校准前提下最大化锐度”的目标优化 。

#### 检验诊断工具

为了诊断预报存在何种类型的偏差，研究者开发了一系列图形化工具。

*   **[概率积分变换](@entry_id:262799)（PIT）[直方图](@entry_id:178776)**：对于一个连续的概率预报 $F$ 和其对应的观测 $Y$，PIT 值被定义为 $U = F(Y)$。一个核心的统计学结果是：如果预报是完美校准的，那么 PIT 值 $U$ 的集合应该服从 $[0,1]$ 上的均匀分布。因此，我们可以绘制大量预报-观测对的 PIT 值[直方图](@entry_id:178776)。如果[直方图](@entry_id:178776)接近平坦，说明预报的校准度很好。如果呈现U形，说明预报**过于自信**（[欠离散](@entry_id:183174)，under-dispersed），即实际观测值过于频繁地落在预报分布的尾部。如果呈现拱形，说明预报**过于保守**（[过离散](@entry_id:263748)，over-dispersed），即实际观测值过于集中在预报分布的中心。值得注意的是，整体的 PIT 均匀性是校准的必要条件，但非充分条件。一个在某些情况下[欠离散](@entry_id:183174)、在另一些情况下过离散的预报系统，其总体的 PIT [直方图](@entry_id:178776)可能碰巧是平坦的 。

*   **等级[直方图](@entry_id:178776) (Rank Histogram)**：这是为[集合预报](@entry_id:1124525)设计的诊断工具，也称作 Talagrand 图。对于每个预报案例，我们将 $N$ 个集合成员和1个真实观测值放在一起排序。观测值在总共 $N+1$ 个值中的排序位置（即等级）被记录下来。对于一个可靠的（即校准的）[集合预报系统](@entry_id:1124526)，观测值应该与任何一个集合成员无异，因此它等可能地落在 $N+1$ 个等级中的任何一个。在大量案例上绘制等级的[直方图](@entry_id:178776)，其理论形状应该是一个平坦的直方图，每个等级的期望频次为 $E = M / (N+1)$，其中 $M$ 是总案例数。与 PIT 直方图类似，U形等级[直方图](@entry_id:178776)表示集合**[离散度](@entry_id:168823)不足**（spread is too small），拱形表示**离散度过大**（spread is too large），而倾斜的形状则表示系统性的中心偏差 。例如，在一个 $N=9$ 成员、$M=450$ 案例的试验中，期望的各等级频次为 $450/(9+1) = 45$。如果观测到的极端等级（等级1和10）的频次远高于45，而中间等级的频次低于45，这便是集合离散度不足的典型信号 。

*   **Brier 分数分解**：对于二元事件（例如，是否超过降水阈值），Brier 分数 ($BS$) 是衡量[概率预报](@entry_id:183505)[均方误差](@entry_id:175403)的标准。Murphy 分解将其拆分为三个有物理解释的项：$BS = REL - RES + UNC$。
    *   **可靠性项 (REL)**: $REL = \sum_{k=1}^K w_k (f_k - o_k)^2$。它衡量预报的校准度。$f_k$ 是某个预报概率区间的平均预报值，$o_k$ 是该区间内事件的实际发生频率。完美的可靠性意味着 $f_k = o_k$，此时 $REL=0$。$REL$ 越小越好。
    *   **分辨率项 (RES)**: $RES = \sum_{k=1}^K w_k (o_k - \bar{o})^2$。它衡量预报的辨识能力。$\bar{o}$ 是事件的气候平均频率。$RES$ 度量了预报能否将样本成功划分为具有不同结果频率的子集。$RES$ 越大越好。
    *   **不确定性项 (UNC)**: $UNC = \bar{o}(1-\bar{o})$。它只与事件本身的气候频率有关，代表了预报问题固有的不确定性。
    这个分解清晰地揭示了预报质量的两个可提升方面：提高可靠性（降低 $REL$）和提高分辨率（增加 $RES$）。

通过综合运用这些原理、方法和诊断工具，我们可以系统地改进数值模型的预报，使其不仅更接近观测的平均状态，而且能更诚实地反映预报的不确定性。