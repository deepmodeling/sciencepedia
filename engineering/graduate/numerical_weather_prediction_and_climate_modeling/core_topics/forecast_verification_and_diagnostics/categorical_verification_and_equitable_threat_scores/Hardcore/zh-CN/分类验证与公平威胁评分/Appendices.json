{
    "hands_on_practices": [
        {
            "introduction": "要理解为何需要公平评分（equitable score），我们首先必须掌握“随机命中”（hits by random chance）的概念。这个练习  通过一个思想实验，分析了两种极端的“简并”预报策略——即始终预报“是”或始终预报“否”。通过计算这些简单策略下的预期随机命中数 $H_r$，您将揭示 $H_r$ 如何依赖于预报自身的统计特征，从而为理解为何必须在评估中剔除这些随机命中奠定基础。",
            "id": "4021501",
            "problem": "在数值天气预报和气候模拟的分类预报检验背景下，考虑一个二元事件（例如，日降水量超过给定阈值）。假设有一个包含 $N$ 个独立预报-观测对的样本，样本中观测事件的基础率 $p_o \\in (0,1)$。使用标准的 $2 \\times 2$ 列联表表示法，其中包含命中 $H$、漏报 $M$、空报 $F$ 和正确否定 $C$，使得 $N = H + M + F + C$，并且观测到的事件总数为 $H + M = N p_o$，分析两种退化预报策略：\n- 恒定“是”预报，即对每个个例都预报事件发生。\n- 恒定“否”预报，即对每个个例都预报事件不发生。\n\n任务：\n- 对于这两种策略中的每一种，用 $N$ 和 $p_o$ 计算 $(H,M,F,C)$。\n- 从公平分类评分中使用的独立性假设出发，通过将 $H_r$ 表示为边际事件概率、预报“是”概率和样本量 $N$ 的乘积，推导每种策略的期望随机命中数 $H_r$（用 $N$ 和 $p_o$ 表示）。\n- 令 $\\Delta H_r$ 表示恒定“是”策略和恒定“否”策略的期望随机命中数之差，即 $\\Delta H_r = H_r^{\\text{yes}} - H_r^{\\text{no}}$。提供一个用 $N$ 和 $p_o$ 表示的 $\\Delta H_r$ 的闭式表达式。\n\n你的最终答案应该是关于 $\\Delta H_r$ 的单一简化解析表达式。无需四舍五入，也无需单位。",
            "solution": "该问题陈述被认为是有效的，因为它科学上基于分类预报检验的原则，提法明确，目标清晰，并且没有歧义或矛盾。\n\n该问题要求在二元事件的 $2 \\times 2$ 列联表框架内分析两种退化预报策略。总样本量为 $N$。列联表的元素是命中 ($H$)、漏报 ($M$)、空报 ($F$) 和正确否定 ($C$)。总样本量为 $N = H + M + F + C$。观测事件的基础率给定为 $p_o$。这意味着样本中观测到的事件总数为 $H+M = Np_o$，观测到的非事件总数为 $F+C = N - Np_o = N(1-p_o)$。\n\n首先，我们确定每种退化策略的 $(H, M, F, C)$ 值。\n\n**策略1：恒定“是”预报**\n在此策略中，对 $N$ 个个例中的每一个都预报事件发生。这意味着“事件未发生”的预报数量为零，即 $M=0$ 和 $C=0$。\n观测到的事件总数为 $Np_o$。由于对这些个例的预报总是“是”，它们都被记录为命中。\n$$H = Np_o$$\n观测到的非事件总数为 $N(1-p_o)$。由于对这些个例的预报总是“是”，它们都被记录为空报。\n$$F = N(1-p_o)$$\n因此，对于恒定“是”预报，列联表的计数为：\n$$(H, M, F, C) = (Np_o, 0, N(1-p_o), 0)$$\n我们可以验证总数：$H+M = Np_o$， $F+C = N(1-p_o)$，以及 $H+M+F+C = Np_o + 0 + N(1-p_o) + 0 = N$。\n\n**策略2：恒定“否”预报**\n在此策略中，对 $N$ 个个例中的任何一个都不预报事件发生。这意味着“事件发生”的预报数量为零，即 $H=0$ 和 $F=0$。\n观测到的事件总数为 $Np_o$。由于对这些个例的预报总是“否”，它们都被记录为漏报。\n$$M = Np_o$$\n观测到的非事件总数为 $N(1-p_o)$。由于对这些个例的预报总是“否”，它们都被记录为正确否定。\n$$C = N(1-p_o)$$\n因此，对于恒定“否”预报，列联表的计数为：\n$$(H, M, F, C) = (0, Np_o, 0, N(1-p_o))$$\n我们可以验证总数：$H+M=Np_o$， $F+C=N(1-p_o)$，以及 $H+M+F+C=0+Np_o+0+N(1-p_o)=N$。\n\n接下来，我们推导每种策略的期望随机命中数 $H_r$。问题指明 $H_r$ 基于独立性假设，其中期望命中数是样本量、观测事件概率和预报事件概率的乘积。\n观测事件概率是基础率 $p_o = \\frac{H+M}{N}$。\n预报事件概率，我们称之为 $p_f$，是“是”预报的边际频率，$p_f = \\frac{H+F}{N}$。\n对于一个相对于观测是随机的预报，其期望命中数由下式给出：\n$$H_r = N \\cdot p_o \\cdot p_f = N \\left(\\frac{H+M}{N}\\right) \\left(\\frac{H+F}{N}\\right) = \\frac{(H+M)(H+F)}{N}$$\n由于 $H+M = Np_o$，这可以写成：\n$$H_r = p_o (H+F)$$\n\n我们现在将此公式应用于每种策略。\n\n对于恒定“是”策略，“是”预报的总数是 $H+F = Np_o + N(1-p_o) = N$。\n此策略的期望随机命中数 $H_r^{\\text{yes}}$ 是：\n$$H_r^{\\text{yes}} = p_o (H+F) = p_o \\cdot N = Np_o$$\n\n对于恒定“否”策略，“是”预报的总数是 $H+F = 0+0 = 0$。\n此策略的期望随机命中数 $H_r^{\\text{no}}$ 是：\n$$H_r^{\\text{no}} = p_o (H+F) = p_o \\cdot 0 = 0$$\n\n最后，我们计算差值 $\\Delta H_r = H_r^{\\text{yes}} - H_r^{\\text{no}}$。\n$$\\Delta H_r = H_r^{\\text{yes}} - H_r^{\\text{no}} = Np_o - 0 = Np_o$$\n恒定“是”预报与恒定“否”预报之间期望随机命中数的差值等于样本中观测到的事件总数。这是构建公平评分（如 Peirce 技巧评分或 Heidke 技巧评分）时使用的一个关键见解，这些评分使用 $H_r$ 作为参考来衡量高于随机机会的技巧。",
            "answer": "$$\\boxed{Np_o}$$"
        },
        {
            "introduction": "理解了为何要校正随机影响之后，我们自然会问：如何构建并应用一个公平的评分工具？这个练习  将重点转向公平威胁评分（Equitable Threat Score, ETS）的构建与计算。练习还引入了另一个关键概念——频率偏差（frequency bias），它衡量了事件的预报频率与观测频率的匹配程度，帮助我们从第一性原理推导出 ETS 公式，并将其应用于一个频率无偏的实际场景中，从而巩固您的计算技能。",
            "id": "4021502",
            "problem": "考虑在数值天气预报和气候模型中，对超过阈值的降水进行的二元事件检验，其结果由一个列联表总结，包含以下计数：命中 $H$、漏报 $M$、空报 $F$ 和正确否定 $C$。设预报-观测对的总数为 $N$，因此 $N = H + M + F + C$。观测事件次数是观测到事件的总数 $H + M$，预报事件次数是预报了事件的总数 $H + F$。频率偏差是预报事件次数与观测事件次数的比率。公平威胁评分（ETS）的构建思想是：在预报和观测相互独立的假设下，会有一定期望数量的命中纯粹由偶然发生，这些随机命中应从分子（以衡量有技巧的命中）和分母（以在不同基础率下保持公平的惩罚）中剔除。\n\n仅从这些核心定义和原则出发：\n- 推导使频率偏差等于1时，$(H, M, F, C)$ 需满足的充分必要条件。\n- 以独立性假设作为偶然吻合的基础概率模型，推导公平威胁评分（ETS）的表达式，然后在预报事件次数等于观测事件次数的条件下将其简化。\n\n最后，将您的结果应用于以下科学上现实的情景：有 $N = 2500$ 次每日预报；观测事件基础率为 $0.1$，因此观测到事件的次数为 $H + M = 250$；预报事件次数与观测事件次数相匹配，且命中在观测事件中所占的比例为 $0.6$，因此 $H = 0.6(H + M)$。为该情景数值计算ETS。将您的答案四舍五入到四位有效数字。将最终结果表示为无单位的纯数。",
            "solution": "该问题被评估为具有科学依据、提法明确、客观且自洽。所有必要信息均已提供，问题具体且可形式化。在数值天气预报的背景下，该情景是现实的。因此，该问题有效，并将提供解答。\n\n按题目要求，分析分三部分进行：\n1.  推导单位频率偏差的条件。\n2.  推导和简化公平威胁评分（ETS）。\n3.  对给定情景进行ETS的数值计算。\n\n设列联表的四个要素定义如下：\n- $H$：命中（预报事件，观测到事件）\n- $M$：漏报（未预报事件，观测到事件）\n- $F$：空报（预报事件，未观测到事件）\n- $C$：正确否定（未预报事件，未观测到事件）\n\n预报-观测对的总数为 $N = H + M + F + C$。\n\n### 第1部分：单位频率偏差的条件\n\n频率偏差，通常表示为 $B$，定义为预报事件次数与观测事件次数的比率。\n事件被预报的次数是命中和空报的总和，$H + F$。\n事件被观测到的次数是命中和漏报的总和，$H + M$。\n\n因此，频率偏差由下式给出：\n$$\nB = \\frac{H + F}{H + M}\n$$\n问题要求推导频率偏差等于1时的充分必要条件。设 $B = 1$：\n$$\n\\frac{H + F}{H + M} = 1\n$$\n假设观测到事件的次数不为零（即 $H + M \\neq 0$，这是偏差有良好定义和意义的实际需要），我们可以在等式两边同乘以 $H + M$：\n$$\nH + F = H + M\n$$\n两边减去 $H$ 得：\n$$\nF = M\n$$\n这就是充分必要条件。频率偏差为 $1$ 意味着空报的次数与漏报的次数完全相等。这种情况在频率意义上也被称为“无偏”，意味着模型预报事件的频率与观测到的频率相同。\n\n### 第2部分：公平威胁评分（ETS）的推导和简化\n\n公平威胁评分（ETS）旨在改进威胁评分（TS），也称为临界成功指数（CSI），其定义为 $TS = \\frac{H}{H+M+F}$。ETS考虑了在预报和观测统计独立的假设下，纯粹由随机机会导致的预期命中数。\n\n这种偶然吻合的基础概率模型建立在预报事件和观测事件相互独立的基础上。\n预报事件的概率是 $P(fcst) = \\frac{H + F}{N}$。\n观测事件的概率是 $P(obs) = \\frac{H + M}{N}$。\n\n在独立性假设下，联合发生（一次命中）的概率是各自概率的乘积：\n$$\nP(hit_{random}) = P(fcst) \\times P(obs) = \\left(\\frac{H + F}{N}\\right) \\left(\\frac{H + M}{N}\\right)\n$$\n在总共 $N$ 次试验中，由随机机会导致的预期命中数 $H_{random}$ 为：\n$$\nH_{random} = N \\times P(hit_{random}) = N \\times \\frac{(H + F)(H + M)}{N^2} = \\frac{(H + F)(H + M)}{N}\n$$\nETS的构建方法是从实际命中数中减去这些随机命中数，以得到“有技巧”的命中数。为了保持评分的公平性，这个随机部分也从分母中减去。TS的分母 $H+M+F$ 代表事件被预报或被观测（或两者皆有）的总次数。\n$$\nETS = \\frac{\\text{实际命中} - \\text{随机命中}}{\\text{事件总数} - \\text{随机命中}} = \\frac{H - H_{random}}{H + M + F - H_{random}}\n$$\n代入 $H_{random}$ 的表达式，ETS 的通用公式为：\n$$\nETS = \\frac{H - \\frac{(H + F)(H + M)}{N}}{H + M + F - \\frac{(H + F)(H + M)}{N}}\n$$\n现在，我们在第1部分推导出的条件下简化此表达式，即预报事件次数等于观测事件次数。这个条件是 $H+F = H+M$。\n让我们用 $K$ 表示这个共同的次数，使得 $K = H+F = H+M$。如前所示，这蕴含了 $F=M$。\n\n在此条件下，随机命中的表达式简化为：\n$$\nH_{random} = \\frac{K \\cdot K}{N} = \\frac{(H + M)^2}{N} \\quad \\text{或等价地} \\quad H_{random} = \\frac{(H + F)^2}{N}\n$$\nETS的分母 $H+M+F$ 可以使用 $F=M$ 重写为：\n$$\nH + M + F = H + M + M = H + 2M\n$$\n或者，$H+M+F = (H+M) + F = K+F$。\n\n将这些代入ETS公式：\n$$\nETS = \\frac{H - \\frac{(H+M)^2}{N}}{H + M + F - \\frac{(H+M)^2}{N}}\n$$\n这就是在单位频率偏差条件下ETS的简化表达式。\n\n### 第3部分：数值计算\n\n我们得到以下情景：\n- 总预报次数：$N = 2500$\n- 观测事件基础率：$0.1$。观测到事件的次数为 $H + M = 0.1 \\times N = 0.1 \\times 2500 = 250$。\n- 预报事件次数与观测事件次数相匹配。这意味着 $H+F = H+M = 250$，这是单位偏差的条件 ($F=M$)。\n- 命中在观测事件中所占的比例为 $0.6$。这得出 $H = 0.6 \\times (H+M)$。\n\n我们现在可以计算 $H, M, F,$ 和 $C$ 的值。\n1.  计算命中 ($H$)：\n    $$\n    H = 0.6 \\times (H+M) = 0.6 \\times 250 = 150\n    $$\n2.  计算漏报 ($M$)：\n    $$\n    M = (H+M) - H = 250 - 150 = 100\n    $$\n3.  计算空报 ($F$)：\n    因为频率偏差为1，所以 $F=M$。\n    $$\n    F = 100\n    $$\n    作为检验：$H+F = 150+100=250$，与 $H+M$ 相符。\n4.  计算正确否定 ($C$)：\n    $$\n    C = N - (H+M+F) = 2500 - (150 + 100 + 100) = 2500 - 350 = 2150\n    $$\n现在，我们计算ETS。首先，计算随机命中数 $H_{random}$：\n$$\nH_{random} = \\frac{(H + F)(H + M)}{N} = \\frac{250 \\times 250}{2500} = \\frac{62500}{2500} = 25\n$$\n最后，使用通用公式计算ETS：\n$$\nETS = \\frac{H - H_{random}}{H + M + F - H_{random}} = \\frac{150 - 25}{150 + 100 + 100 - 25}\n$$\n$$\nETS = \\frac{125}{350 - 25} = \\frac{125}{325}\n$$\n为了简化分数，我们可以将分子和分母同除以它们的最大公约数，即 $25$：\n$$\nETS = \\frac{125 \\div 25}{325 \\div 25} = \\frac{5}{13}\n$$\n题目要求一个四舍五入到四位有效数字的数值答案。\n$$\nETS = \\frac{5}{13} \\approx 0.38461538...\n$$\n四舍五入到四位有效数字，我们得到 $0.3846$。",
            "answer": "$$\\boxed{0.3846}$$"
        },
        {
            "introduction": "掌握了 ETS 的计算方法后，我们需要进一步探究它为何在某些情况下优于更简单的度量标准。本练习  将 ETS 与其前身——临界成功指数（Critical Success Index, CSI）进行对比，通过一种强大的数学工具（渐近分析），来揭示当预报包含大量虚警（false alarms）时，ETS 如何更有效地惩罚这种“过度预报”的行为。这一特性对于评估罕见事件的预报质量至关重要，也是 ETS“公平性”的深刻体现。",
            "id": "4021638",
            "problem": "考虑在$N$个时空样本中，对数值天气预报中的稀有事件预报进行分类检验。设 $2 \\times 2$ 列联表的计数为：命中 $H$、漏报 $M$、空报 $F$ 和正确否定 $C$，其中 $H > 0$, $M \\geq 0$, $F \\geq 0$, $C \\geq 0$。观测到的事件总数为 $S_{o} = H + M$，预报的事件总数为 $S_{f} = H + F$，样本大小为 $N = H + M + F + C$。临界成功指数 (CSI) 定义为事件的交并比，即 $\\text{CSI} = H/(H + M + F)$。一个公平评分是指，对于在给定观测事件频率和预报事件频率下、统计上与随机预报无法区分的预报，其评分为零。\n\n假设在具有相同边缘总数的随机（独立）预报下，期望命中数等于观测事件频率与预报事件频率的乘积，即期望的随机命中数 $H_{r}$ 满足 $H_{r} = (S_{o}/N)(S_{f}/N)N = S_{o} S_{f}/N$。从公平性要求以及将 $\\text{CSI}$ 定义为事件集合上的交并比度量出发，通过从分子和分母中同时减去 $H_{r}$ 来构造一个 $\\text{CSI}$ 的公平修正版本，使得得到的评分对于完美预报为 $1$，对于具有相同边缘总数的随机预报为 $0$。这个构造就是公平威胁评分 (ETS)。\n\n现在考虑一系列情景，其中 $H$ 和 $M$ 保持不变，$C$ 是一个固定的非负常数，且 $F \\to \\infty$，因此 $N = H + M + F + C \\to \\infty$。令 $\\text{ETS}(F)$ 和 $\\text{CSI}(F)$ 表示在这些约束下作为 $F$ 的函数的公平威胁评分和临界成功指数。\n\n请以闭合形式确定当 $F \\to \\infty$ 时比率 $\\text{ETS}(F)/\\text{CSI}(F)$ 的极限，并纯粹用 $H$ 和 $M$ 表示。你的最终答案必须以单一解析表达式的形式给出，不带单位，也无需进行数值计算或四舍五入。",
            "solution": "该问题陈述是一个有效、良态的数学问题，其基础是预报检验统计学的原理。所有术语都得到了明确定义，且前提在科学上和数学上都是合理的。因此，我们可以开始求解。\n\n该问题要求我们确定在特定渐近情景下，公平威胁评分 ($\\text{ETS}$) 与临界成功指数 ($\\text{CSI}$) 之比的极限。我们首先将相关量定义为空报数 $F$ 的函数。观测到的事件总数 $S_o$ 是常数，因为 $H$ 和 $M$ 是固定的：\n$$S_o = H + M$$\n预报的事件总数 $S_f$ 取决于 $F$：\n$$S_f(F) = H + F$$\n总样本大小 $N$ 也取决于 $F$：\n$$N(F) = H + M + F + C$$\n作为 $F$ 的函数的临界成功指数 $\\text{CSI}$ 由下式给出：\n$$\\text{CSI}(F) = \\frac{H}{H + M + F}$$\n对于具有相同边缘总数的随机预报，期望命中数 $H_r$ 为：\n$$H_r(F) = \\frac{S_o S_f(F)}{N(F)} = \\frac{(H+M)(H+F)}{H+M+F+C}$$\n公平威胁评分 $\\text{ETS}$ 是通过从 $\\text{CSI}$ 公式中的分子（命中数 $H$）和分母（并集中的事件总数 $H+M+F$）中都减去随机预报的贡献 $H_r$ 来构造的。因此，作为 $F$ 的函数的 $\\text{ETS}$ 为：\n$$\\text{ETS}(F) = \\frac{H - H_r(F)}{H + M + F - H_r(F)}$$\n我们需要求解当 $F \\to \\infty$ 时比率 $R(F) = \\frac{\\text{ETS}(F)}{\\text{CSI}(F)}$ 的极限。让我们写出这个比率的公式：\n$$R(F) = \\frac{\\frac{H - H_r(F)}{H + M + F - H_r(F)}}{\\frac{H}{H + M + F}} = \\frac{H+M+F}{H} \\cdot \\frac{H-H_r(F)}{H+M+F-H_r(F)}$$\n当 $F \\to \\infty$ 时，此表达式是 $\\infty \\cdot 0$ 类型的不定式，因为 $H+M+F \\to \\infty$ 且第二项趋于 $0$。因此，在求极限之前，我们必须进行更详细的代数简化。\n\n让我们将包含 $H_r(F)$ 的项表示为关于 $F$ 的有理函数。\n首先，看第二个分数的分子 $H-H_r(F)$：\n$$H - H_r(F) = H - \\frac{(H+M)(H+F)}{H+M+F+C} = \\frac{H(H+M+F+C) - (H+M)(H+F)}{H+M+F+C}$$\n展开此表达式的分子：\n$$H(H+M+F+C) - (H+M)(H+F) = (H^2 + HM + HF + HC) - (H^2 + HF + MH + MF)$$\n$$= H^2 + HM + HF + HC - H^2 - HF - MH - MF = HC - MF$$\n所以，我们有：\n$$H - H_r(F) = \\frac{HC - MF}{H+M+F+C}$$\n接下来，看第二个分数的分母 $H+M+F-H_r(F)$：\n$$H+M+F-H_r(F) = (H+M+F) - \\frac{(H+M)(H+F)}{H+M+F+C}$$\n$$= \\frac{(H+M+F)(H+M+F+C) - (H+M)(H+F)}{H+M+F+C}$$\n此表达式的分子是关于 $F$ 的二次多项式。令 $A = H+M$。该项变为：\n$$(A+F)(A+F+C) - A(H+F) = (A+F)^2 + C(A+F) - A(H+F)$$\n$$= A^2+2AF+F^2+AC+CF - AH-AF = F^2 + (A+C)F + (A^2+AC-AH)$$\n$$= F^2 + (H+M+C)F + (H+M)^2 + C(H+M) - H(H+M)$$\n$$= F^2 + (H+M+C)F + (H+M)(H+M+C-H) = F^2 + (H+M+C)F + (H+M)(M+C)$$\n所以，我们有：\n$$H+M+F-H_r(F) = \\frac{F^2+(H+M+C)F+(H+M)(M+C)}{H+M+F+C}$$\n现在我们将这些表达式代回比率 $R(F)$：\n$$R(F) = \\frac{H+M+F}{H} \\cdot \\frac{\\frac{HC - MF}{H+M+F+C}}{\\frac{F^2+(H+M+C)F+(H+M)(M+C)}{H+M+F+C}}$$\n公分母 $\\frac{1}{H+M+F+C}$ 消去，剩下：\n$$R(F) = \\frac{H+M+F}{H} \\cdot \\frac{HC - MF}{F^2+(H+M+C)F+(H+M)(M+C)}$$\n$$R(F) = \\frac{(H+M+F)(HC - MF)}{H[F^2+(H+M+C)F+(H+M)(M+C)]}$$\n这是一个关于 $F$ 的有理函数。为了求 $F \\to \\infty$ 时的极限，我们找出分子和分母中 $F$ 的最高次幂。\n分子是关于 $F$ 的多项式：\n$$\\text{Numerator}(F) = (F+H+M)(-MF+HC) = -MF^2 + (HC-M(H+M))F + HC(H+M)$$\n分子中 $F$ 的最高次幂项是 $-MF^2$。\n分母也是关于 $F$ 的多项式：\n$$\\text{Denominator}(F) = H[F^2+(H+M+C)F+(H+M)(M+C)] = HF^2 + H(H+M+C)F + H(H+M)(M+C)$$\n分母中 $F$ 的最高次幂项是 $HF^2$。\n\n当变量趋于无穷大时，有理函数的极限是其最高次幂项的系数之比，前提是分子和分母的次数相等。在这里，两者的次数都是 $2$。\n$$\\lim_{F \\to \\infty} R(F) = \\lim_{F \\to \\infty} \\frac{-MF^2 + \\dots}{HF^2 + \\dots} = \\frac{-M}{H}$$\n常数 $H$、$M$ 和 $C$ 是固定的，并且给定 $H0$，所以这个极限是良定义的。结果正如题目所要求，只取决于 $H$ 和 $M$。",
            "answer": "$$\\boxed{\\frac{-M}{H}}$$"
        }
    ]
}