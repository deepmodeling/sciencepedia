{
    "hands_on_practices": [
        {
            "introduction": "克努森数 $Kn$ 是区分气体输运机制的基石。本练习将宏观、可控的过程参数，如压力 $p$ 和温度 $T$，与微观的分子平均自由程 $\\lambda$ 联系起来，这对于计算 $Kn$ 至关重要。通过从第一性原理推导这种关系，您将具体理解反应器条件的变化如何使气体流动从连续流区过渡到稀薄流区 。",
            "id": "4137227",
            "problem": "在一个用于物理气相沉积的低压半导体反应器中，一种稀薄的单原子气体可以很好地用基于硬球模型的气体动力学理论来描述。考虑一种固定的气体种类，其有效分子直径是恒定的，且不依赖于热力学状态。该反应器在等温条件下运行，且气体遵循理想气体定律。平均自由程定义为在稀薄气体中、双体碰撞条件下，一个分子在两次碰撞之间行进的平均距离。克努森数 (Kn) 定义为平均自由程与特征长度之比，其中特征长度是晶圆上正在处理的特征结构的通道宽度。\n\n任务1（标度关系）：从理想气体定律和硬球模型动力学理论中的碰撞截面表达式出发，且不假设任何经验性的标度关系，推导对于一个固定的气体种类，其平均自由程 $\\lambda$ 如何随气体压力 $p$ 和温度 $T$ 变化。\n\n任务2（工艺条件下的量化）：对于一个特征长度为 $L=1\\ \\text{mm}$ 的通道，在 $T=300\\ \\text{K}$ 的条件下运行，反应室压力从 $100\\ \\text{mTorr}$ 增加到 $1\\ \\text{Torr}$。使用您在任务1中推导出的标度关系和定义 $\\mathrm{Kn}=\\lambda/L$，计算乘法因子\n$$F \\equiv \\frac{\\mathrm{Kn}\\ \\text{at}\\ 1\\ \\text{Torr}}{\\mathrm{Kn}\\ \\text{at}\\ 100\\ \\text{mTorr}}.$$\n将您的最终答案表示为一个无量纲数。无需四舍五入，报告精确值。",
            "solution": "该问题已经过验证，被认为是科学上合理的、定义明确的且客观的。它基于气体动力学理论和理想气体定律的既定原则，设置清晰且一致。该问题要求进行一个标准的推导，然后进行直接计算，这两者都是研究与半导体制造相关的低压气体系统中的输运现象的核心内容。\n\n解决方案按照题目要求分为两部分。\n\n**任务1：平均自由程（$\\lambda$）的标度关系推导**\n\n对于由硬球分子组成的稀薄气体，其平均自由程 $\\lambda$ 由气体动力学理论给出：\n$$ \\lambda = \\frac{1}{\\sqrt{2} \\pi d^2 n} $$\n其中 $d$ 是有效分子直径，$n$ 是气体分子的数密度（单位体积内的分子数）。\n\n题目指出该气体遵循理想气体定律，其表达式为：\n$$ pV = N_m k_B T $$\n这里，$p$ 是气体压力，$V$ 是体积，$N_m$ 是体积 $V$ 内的总分子数，$k_B$ 是玻尔兹曼常数，$T$ 是绝对温度。\n\n数密度 $n$ 定义为单位体积内的分子数：\n$$ n = \\frac{N_m}{V} $$\n\n通过重新整理理想气体定律，我们可以用压力和温度来表示数密度 $n$：\n$$ \\frac{N_m}{V} = \\frac{p}{k_B T} \\implies n = \\frac{p}{k_B T} $$\n\n现在，我们将 $n$ 的这个表达式代入平均自由程 $\\lambda$ 的方程中：\n$$ \\lambda = \\frac{1}{\\sqrt{2} \\pi d^2 \\left(\\frac{p}{k_B T}\\right)} $$\n化简此表达式可得：\n$$ \\lambda = \\frac{k_B T}{\\sqrt{2} \\pi d^2 p} $$\n\n对于一个固定的气体种类，分子直径 $d$ 是一个常数。玻尔兹曼常数 $k_B$ 和 $\\pi$ 也是常数。因此，我们可以将 $\\lambda$、$T$ 和 $p$ 之间的关系表示为一种正比关系：\n$$ \\lambda \\propto \\frac{T}{p} $$\n这个结果表明，平均自由程与绝对温度成正比，与压力成反比。\n\n**任务2：乘法因子（$F$）的计算**\n\n克努森数 $\\mathrm{Kn}$ 定义为平均自由程 $\\lambda$ 与特征长度 $L$ 的比值：\n$$ \\mathrm{Kn} = \\frac{\\lambda}{L} $$\n使用任务1中推导出的标度关系，我们可以写出克努森数的标度关系：\n$$ \\mathrm{Kn} \\propto \\frac{T}{pL} $$\n\n我们被要求计算因子 $F$，即压力为 $p_2 = 1\\ \\text{Torr}$ 时的克努森数与压力为 $p_1 = 100\\ \\text{mTorr}$ 时的克努森数之比。让这些克努森数分别为 $\\mathrm{Kn}_2$ 和 $\\mathrm{Kn}_1$。\n$$ F \\equiv \\frac{\\mathrm{Kn}_2}{\\mathrm{Kn}_1} $$\n\n题目指明该过程是等温的，所以温度 $T$ 是恒定的（$T_1 = T_2 = T$）。特征长度 $L$ 也是恒定的。使用这个正比关系，我们可以将该比率写为：\n$$ F = \\frac{\\frac{C T_2}{p_2 L}}{\\frac{C T_1}{p_1 L}} $$\n其中 $C$ 是比例常数，$C = \\frac{k_B}{\\sqrt{2} \\pi d^2}$。\n因为 $T_1 = T_2$ 且 $L$ 是常数，所以 $C$、$T$ 和 $L$ 项会消掉，只留下一个简单的压力比：\n$$ F = \\frac{p_1}{p_2} $$\n\n给定的压力值为：\n- $p_1 = 100\\ \\text{mTorr}$\n- $p_2 = 1\\ \\text{Torr}$\n\n为了计算该比率，压力必须使用相同的单位。我们使用转换因子 $1\\ \\text{Torr} = 1000\\ \\text{mTorr}$。\n$$ p_2 = 1\\ \\text{Torr} = 1000\\ \\text{mTorr} $$\n\n现在，我们可以将数值代入 $F$ 的表达式中：\n$$ F = \\frac{100\\ \\text{mTorr}}{1000\\ \\text{mTorr}} = \\frac{100}{1000} = \\frac{1}{10} $$\n因此，乘法因子为 $0.1$。温度（$T=300\\ \\text{K}$）和特征长度（$L=1\\ \\text{mm}$）的值与物理场景一致，但在计算这个特定的无量纲比率时并不需要。",
            "answer": "$$\n\\boxed{0.1}\n$$"
        },
        {
            "introduction": "当克努森数进入滑移流区时，流体在边界处无滑移的连续介质假设不再成立。本练习将演示如何使用一阶滑移边界条件来修正经典的纳维-斯托克斯方程，以准确地模拟微通道中的流动。通过这个实践，您将推导出泊肃叶流的修正系数，这是微流体学中的一个基本结论，并理解表面相互作用（通过动量协调系数 $\\sigma$）如何直接影响流率 。",
            "id": "4137273",
            "problem": "一种稀薄的等温理想气体在半导体工艺设备中稳态地流过一个长矩形微通道。该通道的高度为 $h=1.0\\times 10^{-6}\\ \\text{m}$，长度为 $L=1.0\\times 10^{-2}\\ \\text{m}$，宽度为 $W$，且 $W\\gg h$，这使得流动可以被建模为在两个平行板之间的流动。在长度 $L$ 上施加了 $\\Delta p=1.00\\times 10^{2}\\ \\text{Pa}$ 的压降。该气体的平均自由程为 $\\lambda=2.0\\times 10^{-7}\\ \\text{m}$，切向动量适应系数 (TMAC) 为 $\\sigma=0.90$。假设流动为低马赫数、不可压缩、稳态、完全发展的层流，且动力粘度恒定。使用平行板间完全发展流动的轴向动量平衡和滑移长度为 $b=\\left(\\frac{2-\\sigma}{\\sigma}\\right)\\lambda$ 的一阶 Maxwell 速度滑移边界条件，确定由一阶滑移引起的体积流量相对于经典无滑移泊肃叶 (Poiseuille) 结果的无量纲乘法修正因子，即 $Q_{\\text{slip}}/Q_{0}$ 的值。将您的答案表示为一个无量纲数，四舍五入到四位有效数字。最终答案中不要包含单位。",
            "solution": "该问题经评估为有效。它在科学上基于流体力学原理，特别是稀薄气体动力学和微流控学。该问题是适定的，提供了所有必要的信息和条件，可以得出一个唯一且有意义的解。所给出的参数（通道高度、平均自由程、TMAC）对于半导体制造背景下的微尺度气体流动问题是物理上现实的。未检测到内部矛盾、歧义或事实不符。因此，我们可以进行形式求解。\n\n问题要求计算带有一阶速度滑移的体积流量 $Q_{\\text{slip}}$ 与经典的无滑移泊肃叶 (Poiseuille) 流率 $Q_{0}$ 的比值。该流动被建模为在两个相距为 $h$ 的无限大平行板之间的稳态、不可压缩、完全发展的层流。\n\n让我们建立一个坐标系，其中 $x$ 轴与流动方向对齐，$y$ 轴垂直于平板，通道中心线位于 $y=0$ 处。壁面位于 $y = \\pm \\frac{h}{2}$。对于完全发展的流动，轴向速度 $u$ 仅是 $y$ 的函数，即 $u=u(y)$。$x$ 方向的动量平衡将 Navier-Stokes 方程简化为：\n$$ \\frac{d^2 u}{dy^2} = \\frac{1}{\\mu} \\frac{dp}{dx} $$\n其中 $\\mu$ 是气体的动力粘度，$\\frac{dp}{dx}$ 是沿通道的恒定压力梯度。给定长度 $L$ 上的压降 $\\Delta p$，压力梯度为 $\\frac{dp}{dx} = -\\frac{\\Delta p}{L}$。因此，控制方程变为：\n$$ \\frac{d^2 u}{dy^2} = -\\frac{\\Delta p}{\\mu L} $$\n\n首先，我们求解经典的无滑移情况以求得 $Q_0$。边界条件为 $u_0(y=\\pm \\frac{h}{2}) = 0$。将控制方程对 $y$ 积分两次得到：\n$$ \\frac{du_0}{dy} = -\\frac{\\Delta p}{\\mu L} y + C_1 $$\n$$ u_0(y) = -\\frac{\\Delta p}{2\\mu L} y^2 + C_1 y + C_2 $$\n由于流动剖面关于中心线对称，速度剖面必须是 $y$ 的偶函数，这意味着 $C_1 = 0$。在上壁面应用无滑移条件 $u_0(\\frac{h}{2}) = 0$：\n$$ 0 = -\\frac{\\Delta p}{2\\mu L} \\left(\\frac{h}{2}\\right)^2 + C_2 \\implies C_2 = \\frac{\\Delta p h^2}{8\\mu L} $$\n因此，无滑移速度剖面为：\n$$ u_0(y) = \\frac{\\Delta p}{2\\mu L} \\left( \\frac{h^2}{4} - y^2 \\right) $$\n单位宽度的体积流量 $Q'_0$ 通过将此速度剖面从一个壁面到另一个壁面积分得到：\n$$ Q'_0 = \\int_{-h/2}^{h/2} u_0(y) \\,dy = \\frac{\\Delta p}{2\\mu L} \\int_{-h/2}^{h/2} \\left( \\frac{h^2}{4} - y^2 \\right) \\,dy $$\n$$ Q'_0 = \\frac{\\Delta p}{2\\mu L} \\left[ \\frac{h^2}{4}y - \\frac{y^3}{3} \\right]_{-h/2}^{h/2} = \\frac{\\Delta p}{2\\mu L} \\left( 2 \\left( \\frac{h^3}{8} - \\frac{h^3}{24} \\right) \\right) = \\frac{\\Delta p h^3}{12\\mu L} $$\n\n接下来，我们求解滑移流情况以求得 $Q_{\\text{slip}}$。控制方程和通解形式保持不变。但是，边界条件现在是一阶 Maxwell 速度滑移条件。在壁面（$y=\\pm \\frac{h}{2}$），气体具有有限的滑移速度 $u_s$。在上壁面（$y=\\frac{h}{2}$），条件是：\n$$ u_s = u_{\\text{slip}}\\left(\\frac{h}{2}\\right) = -b \\left. \\frac{du_{\\text{slip}}}{dy} \\right|_{y=h/2} $$\n其中 $b$ 是滑移长度，由 $b = \\left(\\frac{2-\\sigma}{\\sigma}\\right)\\lambda$ 给出。\n从通解 $u_{\\text{slip}}(y) = -\\frac{\\Delta p}{2\\mu L} y^2 + C_2$（根据对称性 $C_1=0$），我们求得导数：\n$$ \\frac{du_{\\text{slip}}}{dy} = -\\frac{\\Delta p}{\\mu L} y \\implies \\left. \\frac{du_{\\text{slip}}}{dy} \\right|_{y=h/2} = -\\frac{\\Delta p h}{2\\mu L} $$\n将此代入滑移条件，得到壁面处的滑移速度：\n$$ u_s = -b \\left( -\\frac{\\Delta p h}{2\\mu L} \\right) = \\frac{b \\Delta p h}{2\\mu L} $$\n壁面处速度也由通解给出：\n$$ u_{\\text{slip}}\\left(\\frac{h}{2}\\right) = -\\frac{\\Delta p}{2\\mu L} \\left(\\frac{h}{2}\\right)^2 + C_2 = -\\frac{\\Delta p h^2}{8\\mu L} + C_2 $$\n将 $u_{\\text{slip}}(\\frac{h}{2})$ 的两个表达式相等，可以解出 $C_2$：\n$$ \\frac{b \\Delta p h}{2\\mu L} = -\\frac{\\Delta p h^2}{8\\mu L} + C_2 \\implies C_2 = \\frac{\\Delta p}{2\\mu L} \\left( bh + \\frac{h^2}{4} \\right) $$\n滑移速度剖面为：\n$$ u_{\\text{slip}}(y) = -\\frac{\\Delta p}{2\\mu L} y^2 + \\frac{\\Delta p}{2\\mu L} \\left( bh + \\frac{h^2}{4} \\right) = \\frac{\\Delta p}{2\\mu L} \\left( \\frac{h^2}{4} - y^2 + bh \\right) $$\n带有滑移的单位宽度体积流量 $Q'_{\\text{slip}}$ 为：\n$$ Q'_{\\text{slip}} = \\int_{-h/2}^{h/2} u_{\\text{slip}}(y) \\,dy = \\int_{-h/2}^{h/2} \\left[ \\frac{\\Delta p}{2\\mu L} \\left( \\frac{h^2}{4} - y^2 \\right) + \\frac{\\Delta p b h}{2\\mu L} \\right] \\,dy $$\n$$ Q'_{\\text{slip}} = \\underbrace{\\int_{-h/2}^{h/2} u_0(y) \\,dy}_{Q'_0} + \\int_{-h/2}^{h/2} \\frac{\\Delta p b h}{2\\mu L} \\,dy $$\n$$ Q'_{\\text{slip}} = Q'_0 + \\frac{\\Delta p b h}{2\\mu L} [y]_{-h/2}^{h/2} = Q'_0 + \\frac{\\Delta p b h^2}{2\\mu L} $$\n修正因子是比率 $Q_{\\text{slip}}/Q_0$。由于通道宽度 $W$ 对于 $Q_{\\text{slip}}=W Q'_{\\text{slip}}$ 和 $Q_0=W Q'_0$ 都是一个常数因子，因此该比率简化为 $Q'_{\\text{slip}}/Q'_0$。\n$$ \\frac{Q_{\\text{slip}}}{Q_0} = \\frac{Q'_0 + \\frac{\\Delta p b h^2}{2\\mu L}}{Q'_0} = 1 + \\frac{\\frac{\\Delta p b h^2}{2\\mu L}}{Q'_0} $$\n代入 $Q'_0 = \\frac{\\Delta p h^3}{12\\mu L}$ 的表达式：\n$$ \\frac{Q_{\\text{slip}}}{Q_0} = 1 + \\frac{\\frac{\\Delta p b h^2}{2\\mu L}}{\\frac{\\Delta p h^3}{12\\mu L}} = 1 + \\frac{b h^2}{2} \\cdot \\frac{12}{h^3} = 1 + \\frac{6b}{h} $$\n现在，我们代入给定的滑移长度表达式 $b = \\left(\\frac{2-\\sigma}{\\sigma}\\right)\\lambda$：\n$$ \\frac{Q_{\\text{slip}}}{Q_0} = 1 + \\frac{6}{h} \\left(\\frac{2-\\sigma}{\\sigma}\\right)\\lambda = 1 + 6 \\left(\\frac{2-\\sigma}{\\sigma}\\right) \\frac{\\lambda}{h} $$\n无量纲群 $\\frac{\\lambda}{h}$ 是努森数 (Knudsen number)，记为 $Kn$。给定值为：\n$h = 1.0 \\times 10^{-6}\\ \\text{m}$\n$\\lambda = 2.0 \\times 10^{-7}\\ \\text{m}$\n$\\sigma = 0.90$\n\n首先，计算努森数：\n$$ Kn = \\frac{\\lambda}{h} = \\frac{2.0 \\times 10^{-7}\\ \\text{m}}{1.0 \\times 10^{-6}\\ \\text{m}} = 0.20 $$\n该值证实流动处于滑移流区（$0.001  Kn  0.3$），从而验证了一阶滑移模型使用的正确性。\n现在，我们计算修正因子：\n$$ \\frac{Q_{\\text{slip}}}{Q_0} = 1 + 6 \\left(\\frac{2 - 0.90}{0.90}\\right) (0.20) $$\n$$ \\frac{Q_{\\text{slip}}}{Q_0} = 1 + 6 \\left(\\frac{1.10}{0.90}\\right) (0.20) $$\n$$ \\frac{Q_{\\text{slip}}}{Q_0} = 1 + 1.2 \\left(\\frac{1.1}{0.9}\\right) = 1 + \\frac{1.32}{0.9} $$\n$$ \\frac{Q_{\\text{slip}}}{Q_0} = 1 + 1.4666... $$\n$$ \\frac{Q_{\\text{slip}}}{Q_0} = 2.4666... $$\n将结果四舍五入到四位有效数字得到 $2.467$。",
            "answer": "$$\\boxed{2.467}$$"
        },
        {
            "introduction": "分析模型，如滑移流修正模型，虽然功能强大，但必须通过更基本的方法或实验进行验证。本练习将理论与计算相结合，要求您将之前探讨过的滑移流分析模型与来自直接模拟蒙特卡洛（DSMC）方法的模拟数据进行比较，后者是模拟稀薄气体流动的“金标准”。这个练习不仅能锻炼您应用分析公式的能力，还能让您掌握进行统计分析（如计算置信区间）来定量评估模型准确性的技能，这在科学与工程研究中至关重要 。",
            "id": "4137229",
            "problem": "考虑稳态、压力驱动的等温气体流经一个长为 $L$、宽为 $W$、高为 $h$ 的长矩形微通道，其中 $W \\gg h$，因此流动可被建模为在间距为 $h$ 的两个平行板之间的平面泊肃叶流。该气体为牛顿流体，动力粘度为 $\\mu$，遵循理想气体定律 $\\rho = p/(R T)$，温度 $T$ 恒定，平均压力为 $\\bar{p}$。流动由长度 $L$ 上的压降 $\\Delta p = p_{\\text{in}} - p_{\\text{out}}$ 驱动，产生一个恒定的轴向压力梯度 $\\partial p/\\partial x = -\\Delta p/L$。\n\n努森数 $Kn$ 定义为 $Kn = \\lambda/h$，其中 $\\lambda$ 是分子平均自由程。在滑移流区（$Kn$ 很小但有限），壁面处适用麦克斯韦滑移边界条件。切向动量适应系数 (TMAC) $\\sigma$ 量化了壁面与气体间的相互作用，壁面处的滑移速度由麦克斯韦边界条件给出\n$$\nu_{\\text{slip}} = \\frac{2 - \\sigma}{\\sigma} \\, \\lambda \\left.\\frac{\\partial u}{\\partial y}\\right|_{\\text{wall}}.\n$$\n直接模拟蒙特卡洛 (DSMC) 是一种基于粒子的方法，可以为相同配置提供质量流率的统计样本。\n\n任务：\n1. 从牛顿流体的稳态、完全发展的平面动量平衡方程出发，并使用理想气体定律表示密度，推导在无滑移条件下，由压降 $\\Delta p$ 驱动流经高度为 $h$、宽度为 $W$、长度为 $L$ 的狭缝的体积流率。然后，结合使用TMAC $\\sigma$ 的麦克斯韦滑移边界条件，推导滑移修正后的质量流率 $\\,\\dot{m}_{\\text{slip}}$ 的表达式，用无滑移体积流率、密度、$Kn$ 和 $\\sigma$ 表示。\n2. 在一个程序中实现这个推导出的表达式，用以计算下面提供的测试用例的 $\\,\\dot{m}_{\\text{slip}}$。\n3. 对于每个测试用例，计算DSMC样本的平均质量流率 $\\,\\bar{m}$、对于 $n$ 个样本的具有 $n-1$ 自由度的无偏样本标准差 $\\,s$、标准误差 $\\,s/\\sqrt{n}$，以及使用学生t分布计算的均值的95%双侧置信区间，\n$$\n\\left[\\, \\bar{m} - t_{0.975,\\,n-1} \\frac{s}{\\sqrt{n}}\\,,\\; \\bar{m} + t_{0.975,\\,n-1} \\frac{s}{\\sqrt{n}} \\,\\right].\n$$\n4. 对于每个测试用例，计算滑移流预测值与DSMC样本均值之间的相对误差，\n$$\n\\varepsilon = \\frac{\\left| \\dot{m}_{\\text{slip}} - \\bar{m} \\right|}{\\bar{m}}.\n$$\n5. 对于每个测试用例，判断 $\\,\\dot{m}_{\\text{slip}}$ 是否落在置信区间内。\n\n所有情况的科学假设：\n- $W \\gg h$，因此端壁和侧壁效应可以忽略不计，平面泊肃叶流模型有效。\n- $\\Delta p$ 相对于 $\\bar{p}$ 足够小，因此可将密度视为常数，等于 $\\bar{\\rho} = \\bar{p}/(R T)$。\n- 在给定条件下，$\\mu$ 是常数且与剪切速率无关。\n- 滑移流区适用，且 $Kn = 0.1$。\n\n使用以下测试套件，所有量均采用国际单位制（SI）。气体为氮气，比气体常数为 $R = 296.8 \\,\\mathrm{J/(kg\\cdot K)}$。报告与质量流率相关的量时，单位为 $\\mathrm{kg/s}$。不涉及角度。所有小数均表示为普通浮点数（不使用百分号）。\n\n所有情况共享的几何与热物理参数：\n- $W = 100 \\times 10^{-6} \\,\\mathrm{m}$，\n- $h = 2 \\times 10^{-6} \\,\\mathrm{m}$，\n- $L = 1 \\times 10^{-2} \\,\\mathrm{m}$，\n- $p_{\\text{in}} = 101325 + 500 \\,\\mathrm{Pa}$，\n- $p_{\\text{out}} = 101325 - 500 \\,\\mathrm{Pa}$，\n- $\\bar{p} = (p_{\\text{in}} + p_{\\text{out}})/2 \\,\\mathrm{Pa}$，\n- $T = 300 \\,\\mathrm{K}$，\n- $\\mu = 1.8 \\times 10^{-5} \\,\\mathrm{Pa\\cdot s}$，\n- $R = 296.8 \\,\\mathrm{J/(kg\\cdot K)}$，\n- $Kn = 0.1$。\n\n测试用例：\n- 情况A（理想情况，$\\sigma$ 接近1）：\n  - $\\sigma = 0.9$，\n  - DSMC样本 $\\{ m_i \\}$: $\\{ 7.26, 7.30, 7.33, 7.27, 7.31, 7.28, 7.34, 7.29, 7.32, 7.30, 7.27, 7.35, 7.29, 7.31, 7.28, 7.33 \\} \\times 10^{-13} \\,\\mathrm{kg/s}$。\n- 情况B（边界条件，漫反射）：\n  - $\\sigma = 1.0$，\n  - DSMC样本 $\\{ m_i \\}$: $\\{ 6.55, 6.62, 6.59, 6.60, 6.58, 6.61, 6.60, 6.57, 6.63, 6.59 \\} \\times 10^{-13} \\,\\mathrm{kg/s}$。\n- 情况C（更低的TMAC，更强的滑移，小样本量n）：\n  - $\\sigma = 0.6$，\n  - DSMC样本 $\\{ m_i \\}$: $\\{ 9.90, 10.20, 10.05, 10.15, 9.95, 9.85 \\} \\times 10^{-13} \\,\\mathrm{kg/s}$。\n\n程序要求：\n- 对每个测试用例，计算：\n  - 使用你推导的表达式计算的滑移流预测质量流率 $\\,\\dot{m}_{\\text{slip}}$。\n  - DSMC样本均值 $\\,\\bar{m}$、均值的95%置信区间端点 $[m_{\\text{lo}}, m_{\\text{hi}}]$，以及十进制表示的相对误差 $\\,\\varepsilon$。\n  - 一个布尔值，指示 $\\,\\dot{m}_{\\text{slip}} \\in [m_{\\text{lo}}, m_{\\text{hi}}]$ 是否成立。\n- 你的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表。列表中的每个元素对应一个测试用例，其本身也是一个包含四个元素的列表，顺序为 $[\\varepsilon, m_{\\text{lo}}, m_{\\text{hi}}, \\text{inside}]$。例如，输出格式必须类似于 $\\left[ [\\cdots], [\\cdots], [\\cdots] \\right]$，其中 $m_{\\text{lo}}$ 和 $m_{\\text{hi}}$ 的所有数值单位为 $\\mathrm{kg/s}$，$\\varepsilon$ 为十进制小数。",
            "solution": "问题陈述经评估有效。其科学基础植根于稀薄气体流体动力学原理，数学上是适定的，内容自洽，且无矛盾或歧义之处。所有必要的参数和数据都已提供，足以执行所需的推导和分析。\n\n### 第一部分：滑移修正质量流率的推导\n\n**1. 控制方程与无滑移解**\n\n我们从牛顿流体的稳态、完全发展、压力驱动的平面流动的动量方程开始。设流动方向为 $x$ 方向，发生在位于 $y = \\pm h/2$ 的两平行板之间。对于这种配置，$x$ 方向的动量方程简化为：\n$$\n\\frac{d p}{d x} = \\mu \\frac{d^2 u}{d y^2}\n$$\n其中 $u$ 是轴向速度，$p$ 是压力，$\\mu$ 是动力粘度。问题指定了恒定的压力梯度 $\\frac{dp}{dx} = -\\frac{\\Delta p}{L}$，其中 $\\Delta p = p_{\\text{in}} - p_{\\text{out}}$ 是通道长度 $L$ 上的压降。\n方程变为：\n$$\n\\frac{d^2 u}{d y^2} = -\\frac{\\Delta p}{\\mu L}\n$$\n对 $y$ 积分两次，得到速度剖面的通解：\n$$\nu(y) = -\\frac{\\Delta p}{2\\mu L} y^2 + C_1 y + C_2\n$$\n流动关于中心线（$y=0$）对称，因此中心线处的速度梯度必须为零：$\\left.\\frac{du}{dy}\\right|_{y=0} = 0$。这意味着 $C_1 = 0$。\n在无滑移条件下，壁面处速度为零：$u(y=\\pm h/2) = 0$。应用此条件求 $C_2$：\n$$\n0 = -\\frac{\\Delta p}{2\\mu L} \\left(\\frac{h}{2}\\right)^2 + C_2 \\implies C_2 = \\frac{\\Delta p h^2}{8\\mu L}\n$$\n由此得到的无滑移速度剖面，即平面泊肃叶流的特征，是：\n$$\nu_{\\text{ns}}(y) = \\frac{\\Delta p}{2\\mu L} \\left( \\frac{h^2}{4} - y^2 \\right)\n$$\n宽度为 $W$ 的通道的体积流率通过在横截面积 $A = W \\times h$ 上对该速度剖面进行积分得到：\n$$\nQ_{\\text{ns}} = \\int_A u_{\\text{ns}} dA = W \\int_{-h/2}^{h/2} \\frac{\\Delta p}{2\\mu L} \\left( \\frac{h^2}{4} - y^2 \\right) dy\n$$\n$$\nQ_{\\text{ns}} = \\frac{W \\Delta p}{2\\mu L} \\left[ \\frac{h^2}{4}y - \\frac{y^3}{3} \\right]_{-h/2}^{h/2} = \\frac{W \\Delta p}{2\\mu L} \\left(\\frac{h^3}{4} - \\frac{h^3}{12}\\right) = \\frac{W \\Delta p}{2\\mu L} \\left(\\frac{2h^3}{12}\\right)\n$$\n$$\nQ_{\\text{ns}} = \\frac{W h^3 \\Delta p}{12 \\mu L}\n$$\n这就是无滑移体积流率，完成了任务1的第一部分。\n\n**2. 滑移流修正**\n\n在滑移流区，气体在壁面处具有有限速度，该速度由麦克斯韦滑移边界条件给出。滑移速度 $u_{\\text{slip}}$ 与壁面处速度梯度成正比：\n$$\nu_{\\text{slip}} = u(y=\\pm h/2) = \\frac{2-\\sigma}{\\sigma} \\lambda \\left| \\frac{du}{dy} \\right|_{y=\\pm h/2}\n$$\n其中 $\\sigma$ 是切向动量适应系数 (TMAC)，$\\lambda$ 是平均自由程。绝对值确保滑移速度方向与流动方向一致。\n从通解 $u(y) = C_2 - \\frac{\\Delta p}{2\\mu L} y^2$ 可知，速度梯度为 $\\frac{du}{dy} = -\\frac{\\Delta p}{\\mu L}y$。在壁面 $y=\\pm h/2$ 处，梯度为：\n$$\n\\left| \\frac{du}{dy} \\right|_{y=\\pm h/2} = \\left| \\mp \\frac{\\Delta p h}{2\\mu L} \\right| = \\frac{\\Delta p h}{2\\mu L}\n$$\n将此代入滑移条件：\n$$\nu(y=\\pm h/2) = \\frac{2-\\sigma}{\\sigma} \\lambda \\frac{\\Delta p h}{2\\mu L}\n$$\n我们用它来求出滑移情况下的积分常数 $C_2$：\n$$\nu(h/2) = C_2 - \\frac{\\Delta p}{2\\mu L} \\left(\\frac{h}{2}\\right)^2 = \\frac{2-\\sigma}{\\sigma} \\lambda \\frac{\\Delta p h}{2\\mu L}\n$$\n$$\nC_2 = \\frac{\\Delta p h^2}{8\\mu L} + \\frac{2-\\sigma}{\\sigma} \\lambda \\frac{\\Delta p h}{2\\mu L}\n$$\n滑移修正后的速度剖面 $u_{\\text{s}}(y)$ 为：\n$$\nu_{\\text{s}}(y) = \\frac{\\Delta p h^2}{8\\mu L} + \\frac{2-\\sigma}{\\sigma} \\lambda \\frac{\\Delta p h}{2mu L} - \\frac{\\Delta p}{2\\mu L} y^2\n$$\n$$\nu_{\\text{s}}(y) = \\underbrace{\\frac{\\Delta p}{2\\mu L} \\left(\\frac{h^2}{4} - y^2\\right)}_{u_{\\text{ns}}(y)} + \\underbrace{\\frac{2-\\sigma}{\\sigma} \\lambda \\frac{\\Delta p h}{2\\mu L}}_{\\text{slip velocity component}}\n$$\n滑移修正后的体积流率 $Q_{\\text{slip}}$ 通过对 $u_{\\text{s}}(y)$ 积分得到：\n$$\nQ_{\\text{slip}} = W \\int_{-h/2}^{h/2} u_{\\text{s}}(y) dy = \\underbrace{W \\int_{-h/2}^{h/2} u_{\\text{ns}}(y) dy}_{Q_{\\text{ns}}} + W \\int_{-h/2}^{h/2} \\left( \\frac{2-\\sigma}{\\sigma} \\lambda \\frac{\\Delta p h}{2\\mu L} \\right) dy\n$$\n第二项是对一个常数在高度 $h$ 上积分：\n$$\nQ_{\\text{slip}} = Q_{\\text{ns}} + W h \\left( \\frac{2-\\sigma}{\\sigma} \\lambda \\frac{\\Delta p h}{2\\mu L} \\right) = Q_{\\text{ns}} + \\frac{W h^2 \\Delta p}{2\\mu L} \\frac{2-\\sigma}{\\sigma} \\lambda\n$$\n提出公因子 $Q_{\\text{ns}} = \\frac{W h^3 \\Delta p}{12 \\mu L}$：\n$$\nQ_{\\text{slip}} = Q_{\\text{ns}} \\left( 1 + \\frac{\\frac{W h^2 \\Delta p}{2\\mu L} \\frac{2-\\sigma}{\\sigma} \\lambda}{\\frac{W h^3 \\Delta p}{12 \\mu L}} \\right) = Q_{\\text{ns}} \\left( 1 + \\frac{12}{2h} \\frac{2-\\sigma}{\\sigma} \\lambda \\right)\n$$\n使用努森数定义 $Kn = \\lambda/h$：\n$$\nQ_{\\text{slip}} = Q_{\\text{ns}} \\left( 1 + 6 \\frac{2-\\sigma}{\\sigma} Kn \\right)\n$$\n质量流率为 $\\dot{m} = \\bar{\\rho} Q$，其中 $\\bar{\\rho} = \\bar{p}/(RT)$ 是平均密度。因此，滑移修正后的质量流率为：\n$$\n\\dot{m}_{\\text{slip}} = \\bar{\\rho} Q_{\\text{ns}} \\left( 1 + 6 \\frac{2-\\sigma}{\\sigma} Kn \\right) = \\frac{\\bar{\\rho} W h^3 \\Delta p}{12 \\mu L} \\left( 1 + 6 \\frac{2-\\sigma}{\\sigma} Kn \\right)\n$$\n该表达式按要求将滑移修正后的质量流率与无滑移体积流率、平均密度、努森数和TMAC关联起来。\n\n### 第二部分：统计分析方法\n\n对于每个测试用例，直接模拟蒙特卡洛（DSMC）数据包含一组 $n$ 个质量流率样本 $\\{ m_i \\}$。需要计算以下量：\n1.  **DSMC样本平均质量流率 ($\\bar{m}$)**：样本的平均值。\n    $$ \\bar{m} = \\frac{1}{n} \\sum_{i=1}^{n} m_i $$\n2.  **无偏样本标准差 ($s$)**：衡量样本离散程度的指标。\n    $$ s = \\sqrt{\\frac{1}{n-1} \\sum_{i=1}^{n} (m_i - \\bar{m})^2} $$\n3.  **均值的95%置信区间**：此区间提供了一个范围，真实平均质量流率有95%的置信度落于此范围内。由于样本量小，使用学生t分布进行计算。\n    $$ \\left[ m_{\\text{lo}}, m_{\\text{hi}} \\right] = \\left[ \\bar{m} - t_{0.975, n-1} \\frac{s}{\\sqrt{n}}, \\bar{m} + t_{0.975, n-1} \\frac{s}{\\sqrt{n}} \\right] $$\n    其中 $t_{0.975, n-1}$ 是自由度为 $n-1$ 的t分布在95%置信水平下的临界值。\n4.  **相对误差 ($\\varepsilon$)**：滑移流模型预测值 ($\\dot{m}_{\\text{slip}}$) 与DSMC样本均值 ($\\bar{m}$) 之间的相对差异。\n    $$ \\varepsilon = \\frac{\\left| \\dot{m}_{\\text{slip}} - \\bar{m} \\right|}{\\bar{m}} $$\n5.  **置信区间检验**：一个布尔判断，确定预测值 $\\dot{m}_{\\text{slip}}$ 是否落在计算出的95%置信区间内，即是否 $m_{\\text{lo}} \\leq \\dot{m}_{\\text{slip}} \\leq m_{\\text{hi}}$。\n\n将为每个测试用例以编程方式实现这些计算。",
            "answer": "```python\nimport numpy as np\nfrom scipy.stats import t\n\ndef solve():\n    \"\"\"\n    Solves for slip-corrected mass flow, analyzes DSMC data, and compares the two.\n    \"\"\"\n    \n    # Shared geometry and thermophysical parameters (SI units)\n    W = 100e-6  # m, width\n    h = 2e-6    # m, height\n    L = 1e-2    # m, length\n    p_in = 101325 + 500  # Pa, inlet pressure\n    p_out = 101325 - 500 # Pa, outlet pressure\n    T = 300     # K, temperature\n    mu = 1.8e-5 # Pa.s, dynamic viscosity\n    R = 296.8   # J/(kg.K), specific gas constant for nitrogen\n    Kn = 0.1    # Knudsen number\n\n    # Derived shared parameters\n    delta_p = p_in - p_out  # Pa, pressure drop\n    p_bar = (p_in + p_out) / 2 # Pa, mean pressure\n    rho_bar = p_bar / (R * T) # kg/m^3, mean density\n\n    # Calculate no-slip volumetric flow rate\n    Q_ns = (W * h**3 * delta_p) / (12 * mu * L)\n    # Calculate no-slip mass flow rate\n    m_dot_ns = rho_bar * Q_ns\n\n    # Test cases\n    test_cases = [\n        {\n            \"sigma\": 0.9,\n            \"dsmc_samples_raw\": [7.26, 7.30, 7.33, 7.27, 7.31, 7.28, 7.34, 7.29, 7.32, 7.30, 7.27, 7.35, 7.29, 7.31, 7.28, 7.33]\n        },\n        {\n            \"sigma\": 1.0,\n            \"dsmc_samples_raw\": [6.55, 6.62, 6.59, 6.60, 6.58, 6.61, 6.60, 6.57, 6.63, 6.59]\n        },\n        {\n            \"sigma\": 0.6,\n            \"dsmc_samples_raw\": [9.90, 10.20, 10.05, 10.15, 9.95, 9.85]\n        }\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        sigma = case[\"sigma\"]\n        # Convert raw DSMC samples to kg/s\n        dsmc_samples = np.array(case[\"dsmc_samples_raw\"]) * 1e-13\n\n        # 1. Compute slip-flow predicted mass flow rate\n        slip_factor = 1 + 6 * ((2 - sigma) / sigma) * Kn\n        m_dot_slip = m_dot_ns * slip_factor\n\n        # 2. Compute DSMC sample statistics\n        n = len(dsmc_samples)\n        m_bar = np.mean(dsmc_samples)\n        s = np.std(dsmc_samples, ddof=1)  # Unbiased sample std dev\n\n        # 3. Compute 95% confidence interval\n        df = n - 1\n        # t.ppf(q, df) gives the t-value for which P(T = t_val) = q\n        # For a two-sided 95% CI, we need the cutoff for the upper 2.5% tail, so q = 0.975\n        t_critical = t.ppf(0.975, df)\n        std_error_mean = s / np.sqrt(n)\n        ci_half_width = t_critical * std_error_mean\n        m_lo = m_bar - ci_half_width\n        m_hi = m_bar + ci_half_width\n\n        # 4. Compute relative error\n        epsilon = np.abs(m_dot_slip - m_bar) / m_bar\n\n        # 5. Determine if slip-flow prediction is inside the CI\n        is_inside = m_lo = m_dot_slip = m_hi\n\n        all_results.append([epsilon, m_lo, m_hi, is_inside])\n\n    # Print the final result in the specified list-of-lists format\n    print(all_results)\n    \nsolve()\n```"
        }
    ]
}