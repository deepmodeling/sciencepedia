{
    "hands_on_practices": [
        {
            "introduction": "Understanding fluid flow in the gas delivery systems of a Chemical Vapor Deposition (CVD) reactor is essential for ensuring uniform processing. This practice revisits the fundamentals by starting with the Navier-Stokes equations to model flow in a simplified manifold channel. By deriving the wall shear stress for plane Poiseuille flow, you will develop a quantitative link between operating conditions and the risk of particle resuspension, a critical issue in contamination control .",
            "id": "4126757",
            "problem": "A rectangular manifold channel feeds a showerhead in a Chemical Vapor Deposition (CVD) reactor. The channel has width much larger than height, so the flow may be idealized as plane Poiseuille flow between two parallel plates. Consider a steady, incompressible, Newtonian gas with dynamic viscosity $\\mu$ flowing in the $x$-direction through the channel of height $H$ (distance between the two plates), with no-slip boundary conditions at the walls $y=0$ and $y=H$. The flow is fully developed, laminar, and driven by a constant streamwise pressure gradient $\\partial p/\\partial x$. Let $u(y)$ denote the axial velocity field and $U$ denote its cross-sectional mean defined by $U = \\frac{1}{H}\\int_{0}^{H} u(y) \\, dy$.\n\nStarting from the steady incompressible Navier–Stokes equations in the absence of body forces for this geometry and the no-slip boundary conditions, derive an expression for the wall shear stress $\\tau_{w}$ at $y=0$ in terms of $\\mu$, $U$, and $H$. Then, evaluate $\\tau_{w}$ for the following operating conditions that are representative of a high-throughput showerhead manifold:\n- Dynamic viscosity: $\\mu = 3.6 \\times 10^{-5} \\ \\mathrm{Pa \\cdot s}$.\n- Channel height: $H = 1.2 \\times 10^{-3} \\ \\mathrm{m}$.\n- Cross-sectional mean velocity: $U = 1.10 \\ \\mathrm{m/s}$.\n\nFinally, quantify the particle resuspension risk by forming the dimensionless ratio $R = \\tau_{w}/\\tau_{c}$, where $\\tau_{c}$ is the critical shear stress required to dislodge weakly adhered contaminant particles on the wall. Assume $\\tau_{c} = 0.150 \\ \\mathrm{Pa}$ for the wall material and particle type of interest. Round your numerical results to three significant figures. Express $\\tau_{w}$ in $\\mathrm{Pa}$. Report only the dimensionless ratio $R$ as your final answer.",
            "solution": "The user-provided problem is validated as scientifically grounded, well-posed, objective, and complete. All conditions and data are consistent and physically realistic for the specified context of fluid dynamics in semiconductor processing. The laminar flow assumption is reasonable for the given parameters. Therefore, a full solution will be derived.\n\nThe starting point is the steady, incompressible Navier–Stokes equations for a Newtonian fluid in the absence of body forces. For a flow aligned with the $x$-axis between two parallel plates, the velocity vector is $\\mathbf{v} = (u, v, w)$. The problem specifies a number of simplifying conditions:\n1.  **Steady flow**: All time derivatives are zero, $\\frac{\\partial}{\\partial t} = 0$.\n2.  **Plane flow**: The channel width is much larger than its height, so we assume no flow and no variation in the $z$-direction (spanwise). This means $w=0$ and $\\frac{\\partial}{\\partial z}=0$ for all quantities.\n3.  **Fully developed flow**: The velocity profile is unchanging in the streamwise ($x$) direction. This implies $\\frac{\\partial u}{\\partial x} = 0$.\n4.  **No-slip boundary conditions**: $u=v=w=0$ at the stationary walls. Here, the walls are at $y=0$ and $y=H$.\n\nThe continuity equation is $\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} + \\frac{\\partial w}{\\partial z} = 0$.\nApplying the simplifications for fully developed flow ($\\frac{\\partial u}{\\partial x} = 0$) and plane flow ($\\frac{\\partial w}{\\partial z} = 0$), the continuity equation reduces to $\\frac{\\partial v}{\\partial y} = 0$. This means $v$ is a function of $x$ only, $v(x)$. The no-slip/no-penetration condition at the walls requires $v=0$ at $y=0$ and $y=H$. For this to be true for all $x$, we must have $v=0$ everywhere in the flow.\n\nWith $v=0$ and $w=0$, the velocity field simplifies to $\\mathbf{v} = (u(y), 0, 0)$. The velocity component $u$ can only be a function of $y$ due to the fully developed and plane flow assumptions.\n\nThe Navier-Stokes momentum equations simplify as follows:\n-   $y$-momentum: $0 = -\\frac{\\partial p}{\\partial y} + \\mu(\\dots) = 0$. This gives $\\frac{\\partial p}{\\partial y}=0$, indicating that pressure $p$ is not a function of $y$.\n-   $z$-momentum: $0 = -\\frac{\\partial p}{\\partial z} + \\mu(\\dots) = 0$. This gives $\\frac{\\partial p}{\\partial z}=0$, indicating that pressure $p$ is not a function of $z$.\nTherefore, pressure is a function of $x$ only, $p=p(x)$.\n\n-   $x$-momentum: The convective acceleration term $\\rho(\\mathbf{v} \\cdot \\nabla)u$ is zero because $v=w=0$ and $\\frac{\\partial u}{\\partial x}=0$. The equation becomes:\n    $$0 = -\\frac{\\partial p}{\\partial x} + \\mu \\left( \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} + \\frac{\\partial^2 u}{\\partial z^2} \\right)$$\n    Applying the simplifications $\\frac{\\partial u}{\\partial x}=0$ (and thus $\\frac{\\partial^2 u}{\\partial x^2}=0$) and $\\frac{\\partial u}{\\partial z}=0$ (and thus $\\frac{\\partial^2 u}{\\partial z^2}=0$), and noting that $p=p(x)$ and $u=u(y)$, we can write the equation using ordinary derivatives:\n    $$\\frac{d^2 u}{dy^2} = \\frac{1}{\\mu} \\frac{dp}{dx}$$\n    The problem states the pressure gradient $\\frac{dp}{dx}$ is a constant. Integrating this equation twice with respect to $y$ yields:\n    $$\\frac{du}{dy} = \\left(\\frac{1}{\\mu}\\frac{dp}{dx}\\right)y + C_1$$\n    $$u(y) = \\left(\\frac{1}{2\\mu}\\frac{dp}{dx}\\right)y^2 + C_1 y + C_2$$\n    The constants of integration, $C_1$ and $C_2$, are determined from the no-slip boundary conditions:\n    1.  At $y=0$, $u(0)=0$: $0 = 0 + 0 + C_2 \\implies C_2=0$.\n    2.  At $y=H$, $u(H)=0$: $0 = \\left(\\frac{1}{2\\mu}\\frac{dp}{dx}\\right)H^2 + C_1 H \\implies C_1 = -\\left(\\frac{H}{2\\mu}\\frac{dp}{dx}\\right)$.\n\n    Substituting the constants back gives the parabolic velocity profile for plane Poiseuille flow:\n    $$u(y) = \\left(\\frac{1}{2\\mu}\\frac{dp}{dx}\\right)y^2 - \\left(\\frac{H}{2\\mu}\\frac{dp}{dx}\\right)y = \\frac{1}{2\\mu}\\frac{dp}{dx}(y^2 - Hy)$$\n\n    Next, we relate the pressure gradient to the cross-sectional mean velocity $U$. By definition:\n    $$U = \\frac{1}{H} \\int_{0}^{H} u(y) \\, dy$$\n    $$U = \\frac{1}{H} \\int_{0}^{H} \\frac{1}{2\\mu}\\frac{dp}{dx}(y^2 - Hy) \\, dy = \\frac{1}{2\\mu H}\\frac{dp}{dx} \\left[ \\frac{y^3}{3} - \\frac{Hy^2}{2} \\right]_{0}^{H}$$\n    $$U = \\frac{1}{2\\mu H}\\frac{dp}{dx} \\left( \\frac{H^3}{3} - \\frac{H^3}{2} \\right) = \\frac{1}{2\\mu H}\\frac{dp}{dx} \\left( -\\frac{H^3}{6} \\right) = -\\frac{H^2}{12\\mu}\\frac{dp}{dx}$$\n    We can now express the pressure gradient in terms of $U$:\n    $$\\frac{dp}{dx} = -\\frac{12 \\mu U}{H^2}$$\n\n    The shear stress for a Newtonian fluid is given by $\\tau_{yx} = \\mu \\frac{du}{dy}$. The wall shear stress, $\\tau_w$, is the magnitude of the stress at the wall. We evaluate this at the bottom wall, $y=0$.\n    $$\\frac{du}{dy} = \\frac{d}{dy} \\left[ \\frac{1}{2\\mu}\\frac{dp}{dx}(y^2 - Hy) \\right] = \\frac{1}{2\\mu}\\frac{dp}{dx}(2y - H)$$\n    At the wall $y=0$:\n    $$\\left.\\frac{du}{dy}\\right|_{y=0} = \\frac{1}{2\\mu}\\frac{dp}{dx}(-H) = -\\frac{H}{2\\mu}\\frac{dp}{dx}$$\n    The shear stress at the wall $y=0$ is:\n    $$\\tau_{w} = \\left| \\mu \\left.\\frac{du}{dy}\\right|_{y=0} \\right| = \\left| \\mu \\left( -\\frac{H}{2\\mu}\\frac{dp}{dx} \\right) \\right| = \\left| -\\frac{H}{2}\\frac{dp}{dx} \\right|$$\n    Since flow is in the positive $x$-direction ($U>0$), the pressure must decrease in this direction, so $\\frac{dp}{dx}  0$. Therefore, $-\\frac{H}{2}\\frac{dp}{dx}$ is a positive quantity, and we can remove the absolute value signs.\n    $$\\tau_{w} = -\\frac{H}{2}\\frac{dp}{dx}$$\n    Finally, we substitute the expression for the pressure gradient in terms of $U$:\n    $$\\tau_{w} = -\\frac{H}{2} \\left( -\\frac{12 \\mu U}{H^2} \\right) = \\frac{6 \\mu U}{H}$$\n    This is the derived expression for the wall shear stress.\n\n    Now, we evaluate $\\tau_w$ using the given numerical values:\n    - $\\mu = 3.6 \\times 10^{-5} \\ \\mathrm{Pa \\cdot s}$\n    - $H = 1.2 \\times 10^{-3} \\ \\mathrm{m}$\n    - $U = 1.10 \\ \\mathrm{m/s}$\n    $$\\tau_w = \\frac{6 \\times (3.6 \\times 10^{-5} \\ \\mathrm{Pa \\cdot s}) \\times (1.10 \\ \\mathrm{m/s})}{1.2 \\times 10^{-3} \\ \\mathrm{m}}$$\n    $$\\tau_w = \\frac{6 \\times 3.6 \\times 1.10}{1.2} \\times 10^{-2} \\ \\mathrm{Pa} = \\frac{23.76}{1.2} \\times 10^{-2} \\ \\mathrm{Pa} = 19.8 \\times 10^{-2} \\ \\mathrm{Pa} = 0.198 \\ \\mathrm{Pa}$$\n    The problem specifies rounding to three significant figures, which this result already satisfies.\n\n    The final step is to calculate the dimensionless ratio $R$ for particle resuspension risk:\n    $$R = \\frac{\\tau_{w}}{\\tau_{c}}$$\n    Given the critical shear stress $\\tau_{c} = 0.150 \\ \\mathrm{Pa}$:\n    $$R = \\frac{0.198 \\ \\mathrm{Pa}}{0.150 \\ \\mathrm{Pa}} = 1.32$$\n    This result is also given to three significant figures as requested.",
            "answer": "$$\\boxed{1.32}$$"
        },
        {
            "introduction": "The classical no-slip boundary condition is an idealization that falters in the microscale channels common in modern semiconductor equipment. This practice explores the slip-flow regime, where the gas mean free path is a non-negligible fraction of the channel height. Starting from the Navier-Stokes equations, you will incorporate the first-order Maxwell slip boundary condition to model rarefaction effects and compute the pressure drop in a microchannel, a key skill for designing microfluidic systems .",
            "id": "4126763",
            "problem": "In a Chemical Vapor Deposition (CVD) manifold for semiconductor wafer processing, a purge of nitrogen gas flows through a single long rectangular microchannel under steady, laminar, isothermal conditions. The channel has width $w$, height $h$, and length $L$, with $h \\ll w$ so that the flow may be modeled as occurring between two parallel plates separated by $h$ and extending across width $w$. The gas is ideal, with specific gas constant $R_{g}$, and the flow Mach number is negligible. The dynamic viscosity is $\\mu$, and rarefaction effects are in the slip-flow regime with non-negligible Knudsen number, $\\mathrm{Kn} = \\lambda / h$, where $\\lambda$ is the mean free path. The tangential momentum accommodation coefficient (TMAC) is $\\sigma$, and the first-order Maxwell slip boundary condition applies at both walls, resulting in a slip length $b = \\frac{2 - \\sigma}{\\sigma} \\lambda$. Assume the pressure drop is small compared to the mean pressure so that the density can be approximated as constant at the mean thermodynamic state.\n\nStarting only from the steady-state, fully developed, one-dimensional Navier–Stokes momentum balance in the streamwise direction for a Newtonian fluid and the first-order slip boundary condition, derive an expression that relates the pressure drop $\\Delta p$ to the volumetric flow rate $Q$ for the described parallel-plate approximation with slip, and then compute the numerical value of $\\Delta p$ required to sustain a given mass flow rate $\\dot{m}$.\n\nUse the following data, all at the mean state:\n- Channel height $h = 2.0 \\times 10^{-6} \\,\\mathrm{m}$, width $w = 5.0 \\times 10^{-4} \\,\\mathrm{m}$, length $L = 5.0 \\times 10^{-2} \\,\\mathrm{m}$.\n- Nitrogen dynamic viscosity $\\mu = 1.80 \\times 10^{-5} \\,\\mathrm{Pa\\cdot s}$.\n- Tangential momentum accommodation coefficient (TMAC) $\\sigma = 0.90$.\n- Knudsen number $\\mathrm{Kn} = 0.050$.\n- Mean free path $\\lambda = \\mathrm{Kn}\\,h$.\n- Slip length $b = \\frac{2 - \\sigma}{\\sigma} \\lambda$.\n- Mean pressure $p_{m} = 5.00 \\times 10^{4} \\,\\mathrm{Pa}$ and temperature $T = 300\\,\\mathrm{K}$.\n- Nitrogen specific gas constant $R_{g} = 296.8 \\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$.\n- Mass flow rate $\\dot{m} = 3.00 \\times 10^{-13} \\,\\mathrm{kg\\,s^{-1}}$.\n\nModel the channel as parallel plates as justified above. Treat the density as $\\rho = p_{m}/(R_{g} T)$ and relate the volumetric flow rate by $Q = \\dot{m}/\\rho$. Express your final numerical answer for the pressure drop $\\Delta p$ in $\\mathrm{Pa}$ and round to three significant figures.",
            "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n**Step 1: Extracted Givens**\n- Channel geometry: width $w = 5.0 \\times 10^{-4} \\,\\mathrm{m}$, height $h = 2.0 \\times 10^{-6} \\,\\mathrm{m}$, length $L = 5.0 \\times 10^{-2} \\,\\mathrm{m}$.\n- Fluid properties (Nitrogen): dynamic viscosity $\\mu = 1.80 \\times 10^{-5} \\,\\mathrm{Pa\\cdot s}$, specific gas constant $R_{g} = 296.8 \\,\\mathrm{J\\,kg^{-1}\\,K^{-1}}$.\n- Flow conditions: tangential momentum accommodation coefficient $\\sigma = 0.90$, Knudsen number $\\mathrm{Kn} = 0.050$.\n- Thermodynamic state: mean pressure $p_{m} = 5.00 \\times 10^{4} \\,\\mathrm{Pa}$, temperature $T = 300\\,\\mathrm{K}$.\n- Mass flow rate: $\\dot{m} = 3.00 \\times 10^{-13} \\,\\mathrm{kg\\,s^{-1}}$.\n- Definitions: mean free path $\\lambda = \\mathrm{Kn}\\,h$, slip length $b = \\frac{2 - \\sigma}{\\sigma} \\lambda$, constant density $\\rho = p_{m}/(R_{g} T)$, volumetric flow rate $Q = \\dot{m}/\\rho$.\n- Assumptions: steady, laminar, isothermal, fully developed flow; approximation as flow between parallel plates ($h \\ll w$); negligible Mach number; small pressure drop compared to mean pressure.\n- Starting point: steady-state, fully developed, 1D Navier-Stokes momentum balance and first-order slip boundary condition.\n\n**Step 2: Validation**\nThe problem describes a standard case of internal microscale gas flow, a topic of central importance in fluid dynamics for semiconductor processing. The governing physics (Navier-Stokes equation), the slip-flow regime correction (Knudsen number, slip length), and the ideal gas model are all well-established scientific principles. The condition $h \\ll w$ ($2.0 \\times 10^{-6} \\ll 5.0 \\times 10^{-4}$) justifies the parallel-plate approximation. The specified Knudsen number $\\mathrm{Kn}=0.050$ correctly places the flow in the slip regime ($0.01  \\mathrm{Kn}  0.1$), for which the first-order slip boundary condition is appropriate. All provided data are physically realistic and dimensionally consistent. The problem statement is self-contained, providing all necessary information for a unique solution without contradictions. Thus, the problem is deemed valid.\n\n**Step 3: Solution Derivation**\nWe begin by deriving the relationship between the pressure drop $\\Delta p$ and the volumetric flow rate $Q$. We establish a coordinate system with the $x$-axis along the flow direction (length $L$) and the $y$-axis across the channel height, centered such that the walls are at $y = \\pm h/2$.\n\nThe flow is steady, fully developed, and one-dimensional, so the velocity vector is $\\vec{v} = (u(y), 0, 0)$. Under these conditions, the $x$-momentum component of the Navier-Stokes equations for a Newtonian fluid simplifies to:\n$$ \\frac{d^2 u}{dy^2} = \\frac{1}{\\mu} \\frac{dp}{dx} $$\nFor fully developed flow, the pressure gradient $\\frac{dp}{dx}$ is constant. Over the length $L$ of the channel, we can write $\\frac{dp}{dx} = -\\frac{\\Delta p}{L}$, where $\\Delta p = p_{in} - p_{out} > 0$. The governing equation becomes:\n$$ \\frac{d^2 u}{dy^2} = -\\frac{\\Delta p}{\\mu L} $$\nIntegrating this equation twice with respect to $y$ yields the general solution for the velocity profile:\n$$ \\frac{du}{dy} = -\\frac{\\Delta p}{\\mu L} y + C_1 $$\n$$ u(y) = -\\frac{\\Delta p}{2\\mu L} y^2 + C_1 y + C_2 $$\nThe integration constants $C_1$ and $C_2$ are determined by the boundary conditions. Due to the symmetry of the parallel-plate geometry, the velocity profile must be symmetric about the centerline $y=0$, i.e., $u(y) = u(-y)$. This requires $C_1=0$.\n\nThe first-order Maxwell slip boundary condition is applied at the walls. At the top wall ($y=h/2$), the outward normal into the fluid points in the $-y$ direction. The slip condition is:\n$$ u(y=h/2) = -b \\left. \\frac{du}{dy} \\right|_{y=h/2} $$\nwhere $b$ is the slip length. Substituting the expressions for $u(y)$ and $du/dy$:\n$$ -\\frac{\\Delta p}{2\\mu L} \\left(\\frac{h}{2}\\right)^2 + C_2 = -b \\left( -\\frac{\\Delta p}{\\mu L} \\frac{h}{2} \\right) $$\n$$ -\\frac{\\Delta p h^2}{8\\mu L} + C_2 = \\frac{b \\Delta p h}{2\\mu L} $$\nSolving for $C_2$:\n$$ C_2 = \\frac{\\Delta p}{2\\mu L} \\frac{h^2}{4} + \\frac{\\Delta p}{\\mu L} \\frac{bh}{2} = \\frac{\\Delta p}{\\mu L} \\left( \\frac{h^2}{8} + \\frac{bh}{2} \\right) $$\nSubstituting $C_1=0$ and this expression for $C_2$ back into the velocity profile equation:\n$$ u(y) = -\\frac{\\Delta p}{2\\mu L} y^2 + \\frac{\\Delta p}{\\mu L} \\left( \\frac{h^2}{8} + \\frac{bh}{2} \\right) = \\frac{\\Delta p}{2\\mu L} \\left( \\frac{h^2}{4} - y^2 + bh \\right) $$\nThis expression describes the parabolic velocity profile with slip.\n\nThe volumetric flow rate $Q$ is obtained by integrating the velocity profile over the cross-sectional area $A = w \\times h$:\n$$ Q = \\int_A u(y) dA = \\int_{-h/2}^{h/2} u(y) w \\, dy $$\n$$ Q = w \\frac{\\Delta p}{2\\mu L} \\int_{-h/2}^{h/2} \\left[ \\left(\\frac{h^2}{4} + bh\\right) - y^2 \\right] dy $$\n$$ Q = w \\frac{\\Delta p}{2\\mu L} \\left[ \\left(\\frac{h^2}{4} + bh\\right)y - \\frac{y^3}{3} \\right]_{-h/2}^{h/2} $$\nEvaluating the definite integral:\n$$ Q = w \\frac{\\Delta p}{2\\mu L} \\cdot 2 \\left[ \\left(\\frac{h^2}{4} + bh\\right)\\frac{h}{2} - \\frac{1}{3}\\left(\\frac{h}{2}\\right)^3 \\right] $$\n$$ Q = \\frac{w \\Delta p}{\\mu L} \\left( \\frac{h^3}{8} + \\frac{bh^2}{2} - \\frac{h^3}{24} \\right) = \\frac{w \\Delta p}{\\mu L} \\left( \\frac{2h^3}{24} + \\frac{bh^2}{2} \\right) $$\n$$ Q = \\frac{w \\Delta p}{\\mu L} \\left( \\frac{h^3}{12} + \\frac{bh^2}{2} \\right) $$\nFactoring out the no-slip Poiseuille flow term gives the desired relation:\n$$ Q = \\frac{w h^3 \\Delta p}{12 \\mu L} \\left( 1 + \\frac{6b}{h} \\right) $$\nThis is the expression relating the pressure drop $\\Delta p$ to the volumetric flow rate $Q$. The term $(1+6b/h)$ is the slip correction factor.\n\nTo compute the numerical value of $\\Delta p$, we first rearrange the equation:\n$$ \\Delta p = \\frac{12 \\mu L Q}{w h^3 \\left( 1 + \\frac{6b}{h} \\right)} $$\nWe now calculate the intermediate values using the provided data.\nThe mean free path $\\lambda$:\n$$ \\lambda = \\mathrm{Kn} \\cdot h = (0.050) \\cdot (2.0 \\times 10^{-6} \\,\\mathrm{m}) = 1.0 \\times 10^{-7} \\,\\mathrm{m} $$\nThe slip length $b$:\n$$ b = \\frac{2 - \\sigma}{\\sigma} \\lambda = \\frac{2 - 0.90}{0.90} (1.0 \\times 10^{-7} \\,\\mathrm{m}) = \\frac{1.1}{0.9} \\times 10^{-7} \\,\\mathrm{m} \\approx 1.222 \\times 10^{-7} \\,\\mathrm{m} $$\nThe slip correction term becomes:\n$$ 1 + \\frac{6b}{h} = 1 + \\frac{6}{2.0 \\times 10^{-6}} \\left( \\frac{1.1}{0.9} \\times 10^{-7} \\right) = 1 + 3 \\times 10^6 \\left( \\frac{1.1}{0.9} \\times 10^{-7} \\right) = 1 + \\frac{3.3}{0.9} \\times 10^{-1} = 1 + \\frac{11}{3} \\times 10^{-1} = 1 + \\frac{11}{30} = \\frac{41}{30} $$\nThe density of nitrogen gas $\\rho$ at the mean state:\n$$ \\rho = \\frac{p_{m}}{R_{g} T} = \\frac{5.00 \\times 10^{4} \\,\\mathrm{Pa}}{(296.8 \\,\\mathrm{J\\,kg^{-1}\\,K^{-1}})(300\\,\\mathrm{K})} = \\frac{50000}{89040} \\,\\mathrm{kg\\,m^{-3}} \\approx 0.5615 \\,\\mathrm{kg\\,m^{-3}} $$\nThe volumetric flow rate $Q$:\n$$ Q = \\frac{\\dot{m}}{\\rho} = \\frac{3.00 \\times 10^{-13} \\,\\mathrm{kg\\,s^{-1}}}{50000 / 89040 \\,\\mathrm{kg\\,m^{-3}}} = \\frac{(3.00 \\times 10^{-13})(89040)}{50000} \\,\\mathrm{m^3\\,s^{-1}} = 5.3424 \\times 10^{-13} \\,\\mathrm{m^3\\,s^{-1}} $$\nNow, we substitute all values into the expression for $\\Delta p$:\n$$ \\Delta p = \\frac{12 (1.80 \\times 10^{-5} \\,\\mathrm{Pa\\cdot s})(5.0 \\times 10^{-2} \\,\\mathrm{m})(5.3424 \\times 10^{-13} \\,\\mathrm{m^3\\,s^{-1}})}{(5.0 \\times 10^{-4} \\,\\mathrm{m})(2.0 \\times 10^{-6} \\,\\mathrm{m})^3 \\left(\\frac{41}{30}\\right)} $$\n$$ \\Delta p = \\frac{12 \\cdot (1.80 \\times 10^{-5}) \\cdot (5.0 \\times 10^{-2}) \\cdot (5.3424 \\times 10^{-13})}{(5.0 \\times 10^{-4}) \\cdot (8.0 \\times 10^{-18}) \\cdot (41/30)} \\,\\mathrm{Pa} $$\n$$ \\Delta p = \\frac{5.769792 \\times 10^{-18}}{5.4666... \\times 10^{-21}} \\,\\mathrm{Pa} $$\n$$ \\Delta p \\approx 1055.46 \\,\\mathrm{Pa} $$\nRounding to three significant figures, the required pressure drop is $1060\\,\\mathrm{Pa}$ or $1.06 \\times 10^3\\,\\mathrm{Pa}$.\nA post-calculation check of the small pressure drop assumption: $\\Delta p/p_m = 1060 / 50000 \\approx 0.0212$, which is about $2.1\\%$. This is small, so the assumption of constant density is self-consistent.",
            "answer": "$$\n\\boxed{1.06 \\times 10^3}\n$$"
        },
        {
            "introduction": "While analytical models provide invaluable insight, most practical process modeling relies on computational fluid dynamics (CFD). This hands-on coding exercise guides you through the fundamentals of building a robust numerical simulation using the Finite Volume Method (FVM). You will discretize a species transport equation, implement a reactive surface boundary condition typical of CVD, and verify that your scheme rigorously upholds the principle of mass conservation, a critical requirement for any predictive model .",
            "id": "4126778",
            "problem": "Consider gas-phase mass transport of a single reacting precursor species in a one-dimensional domain representing the stagnant boundary layer above a semiconductor wafer during Chemical Vapor Deposition (CVD). Let $x \\in [0,L]$ denote the vertical coordinate with $x=0$ at the wafer surface and $x=L$ at the top of the computational domain. The species concentration is $c(x,t)$ with units of $\\mathrm{mol/m^3}$. The gas-phase transport obeys species conservation in the absence of convection, $\\frac{\\partial c}{\\partial t} = D\\,\\frac{\\partial^2 c}{\\partial x^2}$, where $D$ has units of $\\mathrm{m^2/s}$. At the wafer surface, the boundary condition is a Neumann flux condition that represents a surface reaction: $-D\\,\\frac{\\partial c}{\\partial n} = R_s$, where the outward normal from the gas into the wafer is along $-x$, so $\\partial c/\\partial n = -\\partial c/\\partial x$ at $x=0$. Assume linear surface kinetics $R_s = k_s\\,c_w$ with $k_s$ in $\\mathrm{m/s}$ and $c_w$ the interfacial gas concentration at the wafer. At the top boundary $x=L$, impose zero-flux: $\\frac{\\partial c}{\\partial x}\\big|_{x=L} = 0$.\n\nStarting from the species conservation law (local balance over a control volume), discretize the domain into $N$ finite volumes using the Finite Volume Method (FVM), with uniform spacing $\\Delta x = L/N$, cell-centered unknowns $c_i(t)$ for $i=0,1,\\dots,N-1$, and backward Euler time integration over a single time step of size $\\Delta t$. Use area $A=1\\,\\mathrm{m^2}$ so that each cell volume is $V=\\Delta x\\,\\mathrm{m^3}$. Implement the wafer boundary flux condition in a way that is consistent with the Neumann condition and ensures discrete conservation at the interface. Then advance the solution from a uniform initial condition $c(x,0)=c_0$ by one time step, and simultaneously update a surface inventory $m_s$ (with units of $\\mathrm{mol}$) at the wafer according to the flux into the wafer integrated over the time step. The initial surface inventory should be $m_s(0)=0$.\n\nYour program must:\n- Derive and implement the discrete equations from first principles (integral conservation over each finite volume, constitutive diffusive flux, and boundary conditions), ensuring that the wafer boundary condition is incorporated so that the gas-phase loss equals the surface inventory gain over the time step.\n- For each provided test case, compute the updated concentration field $c_i(\\Delta t)$, compute the wafer flux over the time step, update $m_s(\\Delta t)$, and verify the discrete conservation statement: $M_{\\mathrm{gas}}(\\Delta t) + m_s(\\Delta t) \\approx M_{\\mathrm{gas}}(0) + m_s(0)$, where $M_{\\mathrm{gas}}(t) = \\sum_{i=0}^{N-1} c_i(t)\\,\\Delta x$. Report a boolean for each case that is $true$ if the absolute conservation error is less than a tolerance $\\varepsilon$, and $false$ otherwise.\n\nPhysical units and numerical requirements:\n- Report and compute all quantities using International System of Units (SI): $L$ in $\\mathrm{m}$, $D$ in $\\mathrm{m^2/s}$, $k_s$ in $\\mathrm{m/s}$, $\\Delta t$ in $\\mathrm{s}$, $c$ in $\\mathrm{mol/m^3}$, and $m_s$ in $\\mathrm{mol}$.\n- Use the angle unit of radians if any angular quantity appears, although none are present here.\n- The boolean check must use an absolute tolerance $\\varepsilon = 10^{-12}$ in units of $\\mathrm{mol}$ for the mass balance residual.\n\nTest suite:\n- Case $1$ (general case): $N=50$, $L=2\\times 10^{-2}\\,\\mathrm{m}$, $D=10^{-4}\\,\\mathrm{m^2/s}$, $k_s=10^{-3}\\,\\mathrm{m/s}$, $\\Delta t=10^{-1}\\,\\mathrm{s}$, $c_0=1\\,\\mathrm{mol/m^3}$.\n- Case $2$ (zero surface reaction as a boundary condition check): $N=20$, $L=10^{-2}\\,\\mathrm{m}$, $D=5\\times 10^{-5}\\,\\mathrm{m^2/s}$, $k_s=0\\,\\mathrm{m/s}$, $\\Delta t=5\\times 10^{-2}\\,\\mathrm{s}$, $c_0=2\\,\\mathrm{mol/m^3}$.\n- Case $3$ (strong surface reaction to test stiffness at the boundary): $N=100$, $L=5\\times 10^{-2}\\,\\mathrm{m}$, $D=10^{-3}\\,\\mathrm{m^2/s}$, $k_s=20\\,\\mathrm{m/s}$, $\\Delta t=10^{-2}\\,\\mathrm{s}$, $c_0=5\\times 10^{-1}\\,\\mathrm{mol/m^3}$.\n- Case $4$ (single-cell domain, very low diffusivity): $N=1$, $L=10^{-3}\\,\\mathrm{m}$, $D=10^{-8}\\,\\mathrm{m^2/s}$, $k_s=1\\,\\mathrm{m/s}$, $\\Delta t=10\\,\\mathrm{s}$, $c_0=3\\,\\mathrm{mol/m^3}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the boolean results for the test suite as a comma-separated list enclosed in square brackets, for example, $$[true,false,true,true].$$ Use lowercase boolean literals exactly as shown.",
            "solution": "The problem requires the numerical solution of a one-dimensional transient diffusion equation with a reactive boundary condition, using the Finite Volume Method (FVM). A key requirement is to verify the discrete conservation of the total species amount over a single time step. The solution proceeds by first deriving the discretized equations from the integral form of the conservation law and then implementing these equations to solve for the concentration field and perform the conservation check.\n\n### 1. Governing Equation and Finite Volume Formulation\n\nThe species transport is governed by the one-dimensional diffusion equation:\n$$\n\\frac{\\partial c}{\\partial t} = D\\,\\frac{\\partial^2 c}{\\partial x^2}\n$$\nwhere $c(x,t)$ is the species concentration, $D$ is the diffusion coefficient, $x$ is the spatial coordinate, and $t$ is time.\n\nThe Finite Volume Method is based on the integral form of the conservation law over a control volume (or cell). For a generic cell $i$ of volume $V_i$ and surface area $\\partial V_i$, the conservation of species $c$ in the absence of internal sources or sinks is stated as:\n$$\n\\frac{d}{dt} \\int_{V_i} c \\,dV = -\\oint_{\\partial V_i} \\vec{J} \\cdot d\\vec{A}\n$$\nwhere $\\vec{J}$ is the diffusive flux, given by Fick's first law, $\\vec{J} = -D \\nabla c$.\n\nWe discretize the one-dimensional domain $x \\in [0, L]$ into $N$ uniform cells, each of width $\\Delta x = L/N$. The cell $i$ (for $i=0, 1, \\dots, N-1$) is centered at node $x_i$ and its boundaries (faces) are at $x_{i-1/2}$ and $x_{i+1/2}$. We assume a unit cross-sectional area $A=1\\,\\mathrm{m^2}$, so the volume of each cell is $V_i = \\Delta x \\cdot A = \\Delta x$. The concentration $c_i(t)$ represents the cell-averaged concentration.\n\nFor a one-dimensional cell $i$, the integral conservation law simplifies to:\n$$\n\\Delta x \\frac{dc_i}{dt} = J_{i-1/2} - J_{i+1/2}\n$$\nwhere $J_{i \\pm 1/2}$ is the diffusive flux per unit area at the cell faces $x_{i \\pm 1/2}$.\n\nWe use the backward Euler method for time integration. This is an implicit scheme, evaluating all spatial derivatives and fluxes at the future time level, $t^{n+1} = t^n + \\Delta t$. The time derivative is approximated as:\n$$\n\\frac{dc_i}{dt} \\approx \\frac{c_i^{n+1} - c_i^n}{\\Delta t}\n$$\nThe fluxes at the cell faces are approximated using a central difference scheme based on the adjacent cell-centered concentrations at time $t^{n+1}$:\n$$\nJ_{i+1/2}^{n+1} = -D \\frac{\\partial c}{\\partial x} \\bigg|_{x_{i+1/2}}^{n+1} \\approx -D \\frac{c_{i+1}^{n+1} - c_i^{n+1}}{\\Delta x}\n$$\nCombining these approximations yields the general discretized time-stepping equation:\n$$\n\\Delta x \\frac{c_i^{n+1} - c_i^n}{\\Delta t} = \\left(-D \\frac{c_i^{n+1} - c_{i-1}^{n+1}}{\\Delta x}\\right) - \\left(-D \\frac{c_{i+1}^{n+1} - c_i^{n+1}}{\\Delta x}\\right)\n$$\n\n### 2. Discretization of Interior and Boundary Cells\n\n**Interior Cells ($i = 1, \\dots, N-2$):**\nFor an interior cell, the above general equation holds directly. Rearranging it to group terms at the new time level $n+1$ on the left-hand side gives:\n$$\nc_i^{n+1} - \\frac{D \\Delta t}{(\\Delta x)^2} (c_{i+1}^{n+1} - 2c_i^{n+1} + c_{i-1}^{n+1}) = c_i^n\n$$\nDefining the diffusion number $\\alpha = \\frac{D \\Delta t}{(\\Delta x)^2}$, the equation becomes:\n$$\n-\\alpha c_{i-1}^{n+1} + (1 + 2\\alpha) c_i^{n+1} - \\alpha c_{i+1}^{n+1} = c_i^n\n$$\nThis linear algebraic equation relates the unknown concentration $c_i^{n+1}$ to its neighbors.\n\n**Boundary Cell at $x=L$ ($i = N-1$):**\nThis cell extends from $x_{N-3/2}$ to $x_{N-1/2}=L$. The balance equation is:\n$$\n\\Delta x \\frac{c_{N-1}^{n+1} - c_{N-1}^n}{\\Delta t} = J_{N-3/2}^{n+1} - J_{N-1/2}^{n+1}\n$$\nThe flux at the left face $x_{N-3/2}$ is $J_{N-3/2}^{n+1} \\approx -D \\frac{c_{N-1}^{n+1} - c_{N-2}^{n+1}}{\\Delta x}$. The flux at the right face $x_{N-1/2}=L$ is given by the boundary condition $\\frac{\\partial c}{\\partial x}|_{x=L} = 0$, which implies $J_{N-1/2}^{n+1} = 0$. Substituting these into the balance equation and rearranging yields:\n$$\n-\\alpha c_{N-2}^{n+1} + (1 + \\alpha) c_{N-1}^{n+1} = c_{N-1}^n\n$$\n\n**Boundary Cell at $x=0$ ($i = 0$):**\nThis cell extends from $x_{-1/2}=0$ to $x_{1/2}$. The balance equation is:\n$$\n\\Delta x \\frac{c_0^{n+1} - c_0^n}{\\Delta t} = J_{-1/2}^{n+1} - J_{1/2}^{n+1}\n$$\nThe flux at the right face is $J_{1/2}^{n+1} \\approx -D \\frac{c_1^{n+1} - c_0^{n+1}}{\\Delta x}$. The flux at the left face $x=0$ is determined by the surface reaction boundary condition: $-D \\frac{\\partial c}{\\partial n} = R_s$. With the outward normal $\\vec{n}$ pointing in the $-x$ direction, $\\frac{\\partial c}{\\partial n} = -\\frac{\\partial c}{\\partial x}$, so the condition becomes $D \\frac{\\partial c}{\\partial x}|_{x=0} = R_s$. The flux into the cell is $J_{-1/2} = -D \\frac{\\partial c}{\\partial x}|_{x=0} = -R_s$.\nThe reaction rate is $R_s = k_s c_w$, where $c_w=c(0,t)$ is the concentration at the wafer surface. For a backward Euler scheme, we evaluate this at $t^{n+1}$: $J_{-1/2}^{n+1} = -k_s c_w^{n+1}$. A common and consistent FVM practice is to approximate the face concentration $c_w$ with the adjacent cell-center concentration, $c_w^{n+1} \\approx c_0^{n+1}$.\nSubstituting the fluxes gives:\n$$\n\\Delta x \\frac{c_0^{n+1} - c_0^n}{\\Delta t} = -k_s c_0^{n+1} - \\left(-D \\frac{c_1^{n+1} - c_0^{n+1}}{\\Delta x}\\right)\n$$\nRearranging terms, we get:\n$$\n\\left(1 + \\frac{k_s \\Delta t}{\\Delta x} + \\frac{D \\Delta t}{(\\Delta x)^2}\\right) c_0^{n+1} - \\frac{D \\Delta t}{(\\Delta x)^2} c_1^{n+1} = c_0^n\n$$\nDefining $\\beta = \\frac{k_s \\Delta t}{\\Delta x}$, the equation becomes:\n$$\n(1 + \\alpha + \\beta) c_0^{n+1} - \\alpha c_1^{n+1} = c_0^n\n$$\n\n### 3. Linear System and Conservation Check\n\nThe set of $N$ linear algebraic equations for $c_i^{n+1}$ ($i=0, \\dots, N-1$) forms a tridiagonal system $\\mathbf{A} \\mathbf{c}^{n+1} = \\mathbf{c}^n$, which can be solved efficiently. For the special case $N=1$, there is a single cell spanning the domain. The balance equation simplifies to $c_0^{n+1} = \\frac{L}{L + k_s \\Delta t} c_0^n$.\n\nThe problem requires a verification of discrete mass conservation. The total amount of species in the system is the sum of the amount in the gas phase, $M_{\\mathrm{gas}}(t) = \\sum_{i=0}^{N-1} c_i(t) \\Delta x$, and the amount deposited on the surface, $m_s(t)$.\nInitially, at $t=0$:\n$$ M_{\\mathrm{gas}}(0) = \\sum_i c_0 \\Delta x = N c_0 (L/N) = c_0 L \\quad \\text{and} \\quad m_s(0) = 0 $$\nThe total initial amount is $M_{\\mathrm{tot}}(0) = c_0 L$.\n\nAfter one time step $\\Delta t$, the gas-phase amount is $M_{\\mathrm{gas}}(\\Delta t) = \\sum_{i=0}^{N-1} c_i^{n+1} \\Delta x$. The amount deposited on the surface increases by the total flux into the surface over the time step. The rate of deposition is $R_s = k_s c_w$. Integrating over $\\Delta t$ with the same backward Euler approximation gives the change in surface inventory:\n$$ \\Delta m_s = (k_s c_w^{n+1}) \\Delta t $$\nTo ensure consistency with the FVM derivation, we must use the same approximation for $c_w^{n+1} \\approx c_0^{n+1}$.\nThus, the updated surface inventory is $m_s(\\Delta t) = m_s(0) + \\Delta m_s = k_s c_0^{n+1} \\Delta t$.\n\nThe total final amount is $M_{\\mathrm{tot}}(\\Delta t) = M_{\\mathrm{gas}}(\\Delta t) + m_s(\\Delta t)$. Conservation requires $M_{\\mathrm{tot}}(\\Delta t) \\approx M_{\\mathrm{tot}}(0)$.\nWe can prove that our FVM scheme is perfectly conservative. Summing all $N$ discrete balance equations:\n$$\n\\sum_{i=0}^{N-1} \\left( \\Delta x \\frac{c_i^{n+1} - c_i^n}{\\Delta t} \\right) = \\sum_{i=0}^{N-1} (J_{i-1/2}^{n+1} - J_{i+1/2}^{n+1})\n$$\nThe left side is $\\frac{M_{\\mathrm{gas}}^{n+1} - M_{\\mathrm{gas}}^n}{\\Delta t}$. The right side is a telescoping sum that simplifies to $J_{-1/2}^{n+1} - J_{N-1/2}^{n+1}$. Using our boundary flux approximations, this is $-k_s c_0^{n+1} - 0$.\n$$\n\\frac{M_{\\mathrm{gas}}^{n+1} - M_{\\mathrm{gas}}^n}{\\Delta t} = -k_s c_0^{n+1}\n$$\n$$\nM_{\\mathrm{gas}}^{n+1} - M_{\\mathrm{gas}}^n = -k_s c_0^{n+1} \\Delta t = -m_s^{n+1}\n$$\n$$\nM_{\\mathrm{gas}}^{n+1} + m_s^{n+1} = M_{\\mathrm{gas}}^n\n$$\nSince $m_s^n = m_s(0) = 0$, we have $M_{\\mathrm{gas}}^{n+1} + m_s^{n+1} = M_{\\mathrm{gas}}^n + m_s^n$. This proves that the total amount is conserved by the numerical scheme. The check in the code, therefore, should pass up to floating-point precision.",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef solve():\n    \"\"\"\n    Solves the 1D transient diffusion-reaction problem for multiple test cases\n    and verifies discrete mass conservation.\n    \"\"\"\n    \n    # Test suite as defined in the problem statement.\n    # Each tuple is (N, L, D, ks, dt, c0).\n    test_cases = [\n        (50, 2e-2, 1e-4, 1e-3, 1e-1, 1.0),\n        (20, 1e-2, 5e-5, 0.0, 5e-2, 2.0),\n        (100, 5e-2, 1e-3, 20.0, 1e-2, 0.5),\n        (1, 1e-3, 1e-8, 1.0, 10.0, 3.0),\n    ]\n\n    def run_single_case(params):\n        \"\"\"\n        Runs the simulation for a single test case and returns a boolean\n        indicating if mass conservation is satisfied.\n        \"\"\"\n        N, L, D, ks, dt, c0 = params\n        dx = L / N\n        epsilon = 1e-12\n\n        # Initial state\n        c_initial_field = np.full(N, c0)\n        # Total initial mass in the gas phase: M_gas(0) = sum(c_i(0) * dx) = N * c0 * (L/N) = c0 * L\n        M_gas_initial = c0 * L\n        ms_initial = 0.0\n        total_initial = M_gas_initial + ms_initial\n\n        # --- Solve for the concentration field at t = dt ---\n        \n        # The N=1 case is a single algebraic equation, not a system.\n        if N == 1:\n            # Derived from the balance: dx*(c_1-c_0)/dt = -ks*c_1\n            # (dx/dt)*c_1 - (dx/dt)*c_0 = -ks*c_1\n            # (dx/dt + ks)*c_1 = (dx/dt)*c_0\n            # (dx + ks*dt)*c_1 = dx*c_0\n            # Since dx=L for N=1: c_1 = (L / (L + ks*dt)) * c_0\n            c_final_0 = (L / (L + ks * dt)) * c0\n            c_final_field = np.array([c_final_0])\n        else:\n            # For N>1, set up and solve the tridiagonal system A*c_final = c_initial\n            alpha = D * dt / (dx**2)\n            beta = ks * dt / dx\n\n            # Matrix A is represented in banded format for scipy.linalg.solve_banded\n            # ab[0, :] = super-diagonal (u=1)\n            # ab[1, :] = main-diagonal\n            # ab[2, :] = sub-diagonal (l=1)\n            ab = np.zeros((3, N))\n\n            # Fill main diagonal\n            ab[1, :] = 1.0 + 2.0 * alpha\n            # Modify first and last elements for boundary conditions\n            ab[1, 0] = 1.0 + alpha + beta      # BC at x=0 (wafer)\n            ab[1, N - 1] = 1.0 + alpha         # BC at x=L (zero-flux)\n\n            # Fill off-diagonals\n            ab[0, 1:] = -alpha                  # Super-diagonal\n            ab[2, :-1] = -alpha                 # Sub-diagonal\n            \n            # The right-hand side vector is the initial concentration field\n            b = c_initial_field\n\n            # Solve the linear system\n            c_final_field = solve_banded((1, 1), ab, b)\n\n        # --- Conservation Check ---\n        \n        # Total final mass in the gas phase\n        M_gas_final = np.sum(c_final_field) * dx\n        \n        # Surface inventory update.\n        # The approximation c_w = c_0(dt) is used, consistent with the FVM derivation.\n        ms_final = ks * c_final_field[0] * dt\n\n        total_final = M_gas_final + ms_final\n        \n        # Calculate absolute conservation error\n        error = abs(total_final - total_initial)\n\n        return error  epsilon\n\n    # Run all test cases\n    results = [run_single_case(case) for case in test_cases]\n    \n    # Print the final result in the specified format\n    print(f\"[{','.join(map(str, results))}]\".lower())\n\nsolve()\n```"
        }
    ]
}