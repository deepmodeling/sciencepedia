{
    "hands_on_practices": [
        {
            "introduction": "Understanding the detailed fluid dynamics within process hardware is a cornerstone of reactor design and optimization. This first practice takes you back to first principles, applying the Navier-Stokes equations to a simplified yet highly relevant geometry: a manifold channel feeding a Chemical Vapor Deposition (CVD) showerhead. By deriving the velocity profile for plane Poiseuille flow, you will calculate the wall shear stress, $\\tau_w$, a critical parameter that directly influences the risk of particle contamination from surfaces, a major concern for wafer yield . This exercise hones your ability to translate fundamental equations into practical engineering insights.",
            "id": "4126757",
            "problem": "A rectangular manifold channel feeds a showerhead in a Chemical Vapor Deposition (CVD) reactor. The channel has width much larger than height, so the flow may be idealized as plane Poiseuille flow between two parallel plates. Consider a steady, incompressible, Newtonian gas with dynamic viscosity $\\mu$ flowing in the $x$-direction through the channel of height $H$ (distance between the two plates), with no-slip boundary conditions at the walls $y=0$ and $y=H$. The flow is fully developed, laminar, and driven by a constant streamwise pressure gradient $\\partial p/\\partial x$. Let $u(y)$ denote the axial velocity field and $U$ denote its cross-sectional mean defined by $U = \\frac{1}{H}\\int_{0}^{H} u(y) \\, dy$.\n\nStarting from the steady incompressible Navier–Stokes equations in the absence of body forces for this geometry and the no-slip boundary conditions, derive an expression for the wall shear stress $\\tau_{w}$ at $y=0$ in terms of $\\mu$, $U$, and $H$. Then, evaluate $\\tau_{w}$ for the following operating conditions that are representative of a high-throughput showerhead manifold:\n- Dynamic viscosity: $\\mu = 3.6 \\times 10^{-5} \\ \\mathrm{Pa \\cdot s}$.\n- Channel height: $H = 1.2 \\times 10^{-3} \\ \\mathrm{m}$.\n- Cross-sectional mean velocity: $U = 1.10 \\ \\mathrm{m/s}$.\n\nFinally, quantify the particle resuspension risk by forming the dimensionless ratio $R = \\tau_{w}/\\tau_{c}$, where $\\tau_{c}$ is the critical shear stress required to dislodge weakly adhered contaminant particles on the wall. Assume $\\tau_{c} = 0.150 \\ \\mathrm{Pa}$ for the wall material and particle type of interest. Round your numerical results to three significant figures. Express $\\tau_{w}$ in $\\mathrm{Pa}$. Report only the dimensionless ratio $R$ as your final answer.",
            "solution": "The user-provided problem is validated as scientifically grounded, well-posed, objective, and complete. All conditions and data are consistent and physically realistic for the specified context of fluid dynamics in semiconductor processing. The laminar flow assumption is reasonable for the given parameters. Therefore, a full solution will be derived.\n\nThe starting point is the steady, incompressible Navier–Stokes equations for a Newtonian fluid in the absence of body forces. For a flow aligned with the $x$-axis between two parallel plates, the velocity vector is $\\mathbf{v} = (u, v, w)$. The problem specifies a number of simplifying conditions:\n1.  **Steady flow**: All time derivatives are zero, $\\frac{\\partial}{\\partial t} = 0$.\n2.  **Plane flow**: The channel width is much larger than its height, so we assume no flow and no variation in the $z$-direction (spanwise). This means $w=0$ and $\\frac{\\partial}{\\partial z}=0$ for all quantities.\n3.  **Fully developed flow**: The velocity profile is unchanging in the streamwise ($x$) direction. This implies $\\frac{\\partial u}{\\partial x} = 0$.\n4.  **No-slip boundary conditions**: $u=v=w=0$ at the stationary walls. Here, the walls are at $y=0$ and $y=H$.\n\nThe continuity equation is $\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} + \\frac{\\partial w}{\\partial z} = 0$.\nApplying the simplifications for fully developed flow ($\\frac{\\partial u}{\\partial x} = 0$) and plane flow ($\\frac{\\partial w}{\\partial z} = 0$), the continuity equation reduces to $\\frac{\\partial v}{\\partial y} = 0$. This means $v$ is a function of $x$ only, $v(x)$. The no-slip/no-penetration condition at the walls requires $v=0$ at $y=0$ and $y=H$. For this to be true for all $x$, we must have $v=0$ everywhere in the flow.\n\nWith $v=0$ and $w=0$, the velocity field simplifies to $\\mathbf{v} = (u(y), 0, 0)$. The velocity component $u$ can only be a function of $y$ due to the fully developed and plane flow assumptions.\n\nThe Navier-Stokes momentum equations simplify as follows:\n-   $y$-momentum: $0 = -\\frac{\\partial p}{\\partial y} + \\mu(\\dots) = 0$. This gives $\\frac{\\partial p}{\\partial y}=0$, indicating that pressure $p$ is not a function of $y$.\n-   $z$-momentum: $0 = -\\frac{\\partial p}{\\partial z} + \\mu(\\dots) = 0$. This gives $\\frac{\\partial p}{\\partial z}=0$, indicating that pressure $p$ is not a function of $z$.\nTherefore, pressure is a function of $x$ only, $p=p(x)$.\n\n-   $x$-momentum: The convective acceleration term $\\rho(\\mathbf{v} \\cdot \\nabla)u$ is zero because $v=w=0$ and $\\frac{\\partial u}{\\partial x}=0$. The equation becomes:\n    $$0 = -\\frac{\\partial p}{\\partial x} + \\mu \\left( \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} + \\frac{\\partial^2 u}{\\partial z^2} \\right)$$\n    Applying the simplifications $\\frac{\\partial u}{\\partial x}=0$ (and thus $\\frac{\\partial^2 u}{\\partial x^2}=0$) and $\\frac{\\partial u}{\\partial z}=0$ (and thus $\\frac{\\partial^2 u}{\\partial z^2}=0$), and noting that $p=p(x)$ and $u=u(y)$, we can write the equation using ordinary derivatives:\n    $$\\frac{d^2 u}{dy^2} = \\frac{1}{\\mu} \\frac{dp}{dx}$$\n    The problem states the pressure gradient $\\frac{dp}{dx}$ is a constant. Integrating this equation twice with respect to $y$ yields:\n    $$\\frac{du}{dy} = \\left(\\frac{1}{\\mu}\\frac{dp}{dx}\\right)y + C_1$$\n    $$u(y) = \\left(\\frac{1}{2\\mu}\\frac{dp}{dx}\\right)y^2 + C_1 y + C_2$$\n    The constants of integration, $C_1$ and $C_2$, are determined from the no-slip boundary conditions:\n    1.  At $y=0$, $u(0)=0$: $0 = 0 + 0 + C_2 \\implies C_2=0$.\n    2.  At $y=H$, $u(H)=0$: $0 = \\left(\\frac{1}{2\\mu}\\frac{dp}{dx}\\right)H^2 + C_1 H \\implies C_1 = -\\left(\\frac{H}{2\\mu}\\frac{dp}{dx}\\right)$.\n\n    Substituting the constants back gives the parabolic velocity profile for plane Poiseuille flow:\n    $$u(y) = \\left(\\frac{1}{2\\mu}\\frac{dp}{dx}\\right)y^2 - \\left(\\frac{H}{2\\mu}\\frac{dp}{dx}\\right)y = \\frac{1}{2\\mu}\\frac{dp}{dx}(y^2 - Hy)$$\n\n    Next, we relate the pressure gradient to the cross-sectional mean velocity $U$. By definition:\n    $$U = \\frac{1}{H} \\int_{0}^{H} u(y) \\, dy$$\n    $$U = \\frac{1}{H} \\int_{0}^{H} \\frac{1}{2\\mu}\\frac{dp}{dx}(y^2 - Hy) \\, dy = \\frac{1}{2\\mu H}\\frac{dp}{dx} \\left[ \\frac{y^3}{3} - \\frac{Hy^2}{2} \\right]_{0}^{H}$$\n    $$U = \\frac{1}{2\\mu H}\\frac{dp}{dx} \\left( \\frac{H^3}{3} - \\frac{H^3}{2} \\right) = \\frac{1}{2\\mu H}\\frac{dp}{dx} \\left( -\\frac{H^3}{6} \\right) = -\\frac{H^2}{12\\mu}\\frac{dp}{dx}$$\n    We can now express the pressure gradient in terms of $U$:\n    $$\\frac{dp}{dx} = -\\frac{12 \\mu U}{H^2}$$\n\n    The shear stress for a Newtonian fluid is given by $\\tau_{yx} = \\mu \\frac{du}{dy}$. The wall shear stress, $\\tau_w$, is the magnitude of the stress at the wall. We evaluate this at the bottom wall, $y=0$.\n    $$\\frac{du}{dy} = \\frac{d}{dy} \\left[ \\frac{1}{2\\mu}\\frac{dp}{dx}(y^2 - Hy) \\right] = \\frac{1}{2\\mu}\\frac{dp}{dx}(2y - H)$$\n    At the wall $y=0$:\n    $$\\left.\\frac{du}{dy}\\right|_{y=0} = \\frac{1}{2\\mu}\\frac{dp}{dx}(-H) = -\\frac{H}{2\\mu}\\frac{dp}{dx}$$\n    The shear stress at the wall $y=0$ is:\n    $$\\tau_{w} = \\left| \\mu \\left.\\frac{du}{dy}\\right|_{y=0} \\right| = \\left| \\mu \\left( -\\frac{H}{2\\mu}\\frac{dp}{dx} \\right) \\right| = \\left| -\\frac{H}{2}\\frac{dp}{dx} \\right|$$\n    Since flow is in the positive $x$-direction ($U0$), the pressure must decrease in this direction, so $\\frac{dp}{dx}  0$. Therefore, $-\\frac{H}{2}\\frac{dp}{dx}$ is a positive quantity, and we can remove the absolute value signs.\n    $$\\tau_{w} = -\\frac{H}{2}\\frac{dp}{dx}$$\n    Finally, we substitute the expression for the pressure gradient in terms of $U$:\n    $$\\tau_{w} = -\\frac{H}{2} \\left( -\\frac{12 \\mu U}{H^2} \\right) = \\frac{6 \\mu U}{H}$$\n    This is the derived expression for the wall shear stress.\n\n    Now, we evaluate $\\tau_w$ using the given numerical values:\n    - $\\mu = 3.6 \\times 10^{-5} \\ \\mathrm{Pa \\cdot s}$\n    - $H = 1.2 \\times 10^{-3} \\ \\mathrm{m}$\n    - $U = 1.10 \\ \\mathrm{m/s}$\n    $$\\tau_w = \\frac{6 \\times (3.6 \\times 10^{-5} \\ \\mathrm{Pa \\cdot s}) \\times (1.10 \\ \\mathrm{m/s})}{1.2 \\times 10^{-3} \\ \\mathrm{m}}$$\n    $$\\tau_w = \\frac{6 \\times 3.6 \\times 1.10}{1.2} \\times 10^{-2} \\ \\mathrm{Pa} = \\frac{23.76}{1.2} \\times 10^{-2} \\ \\mathrm{Pa} = 19.8 \\times 10^{-2} \\ \\mathrm{Pa} = 0.198 \\ \\mathrm{Pa}$$\n    The problem specifies rounding to three significant figures, which this result already satisfies.\n\n    The final step is to calculate the dimensionless ratio $R$ for particle resuspension risk:\n    $$R = \\frac{\\tau_{w}}{\\tau_{c}}$$\n    Given the critical shear stress $\\tau_{c} = 0.150 \\ \\mathrm{Pa}$:\n    $$R = \\frac{0.198 \\ \\mathrm{Pa}}{0.150 \\ \\mathrm{Pa}} = 1.32$$\n    This result is also given to three significant figures as requested.",
            "answer": "$$\\boxed{1.32}$$"
        },
        {
            "introduction": "While detailed flow analysis is crucial, engineers often need to model the behavior of an entire process chamber at a system level. This practice shifts perspective from local velocity profiles to the macroscopic dynamics of a vacuum system, a ubiquitous component in semiconductor manufacturing. You will model the pump-down of a process chamber by deriving an ordinary differential equation for the chamber pressure, $P(t)$, treating key components like the transfer line and pump as elements with constant conductance $C$ and pumping speed $S$ . This exercise develops skills in lumped-parameter modeling, which is essential for predicting and controlling critical process parameters like chamber pressure and residence time.",
            "id": "4126744",
            "problem": "A single-wafer vacuum process module used in plasma etching is modeled as a well-mixed isothermal gas volume of size $V$ connected to a turbomolecular pump via a straight transfer line. The gas temperature is constant and equal to $T$. The chamber pressure is spatially uniform and denoted $P(t)$, with initial condition $P(0)=P_{0}$. The pump inlet pressure is $P_{p}(t)$. The transfer line operates in molecular flow throughout the pump-down and can be modeled as a linear hydraulic element with constant conductance $C$ such that the molecular-flow throughput is proportional to the pressure drop:\n$$\nQ(t)=C\\big(P(t)-P_{p}(t)\\big),\n$$\nwhere $Q(t)$ has units of throughput (for example, pascal cubic meters per second). The turbomolecular pump, when referenced at its inlet, is modeled as a linear sink characterized by a constant pumping speed $S$, so that the same throughput satisfies\n$$\nQ(t)=S\\,P_{p}(t).\n$$\nThe chamber experiences a constant internal gas load (for example, due to outgassing and small leaks) represented as a constant throughput source $G$ into the chamber. Assume that gas inertia is negligible, the ideal gas law applies, and the chamber is perfectly mixed so that conservation of mass reduces to a scalar ordinary differential equation in $P(t)$.\n\nStarting only from the conservation of mass, the ideal gas law, and the constitutive linear relations stated above for the transfer line and pump, derive an explicit closed-form analytic expression for the chamber pressure $P(t)$ for $t\\ge 0$. Express your final answer in terms of $V$, $S$, $C$, $G$, $P_{0}$, and $t$. No numerical evaluation is required. Provide the expression for $P(t)$ as a single simplified formula. Do not include units in your final expression.",
            "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- **System:** A well-mixed isothermal gas volume $V$.\n- **State variables:** Chamber pressure $P(t)$, pump inlet pressure $P_p(t)$.\n- **Initial condition:** $P(0) = P_{0}$.\n- **Constants:** Chamber volume $V$, gas temperature $T$, transfer line conductance $C$, pump speed $S$, internal gas load $G$.\n- **Constitutive relations:**\n    1. Transfer line throughput: $Q(t) = C(P(t) - P_p(t))$.\n    2. Pump throughput: $Q(t) = S P_p(t)$.\n- **Gas load:** Constant throughput source $G$.\n- **Assumptions:** Ideal gas law applies, gas inertia is negligible, chamber is perfectly mixed.\n- **Objective:** Derive an explicit closed-form analytic expression for $P(t)$ for $t \\ge 0$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding:** The problem is firmly grounded in the principles of vacuum physics and fluid dynamics. The concepts of throughput, conductance, and pumping speed, as well as their linear models, are standard in the analysis of vacuum systems in the molecular flow regime. The formulation based on conservation of mass is a fundamental first-principles approach. The problem is scientifically sound.\n- **Well-Posedness:** The problem provides a set of algebraic and differential relations along with a necessary initial condition, $P(0)=P_0$. This setup leads to a first-order linear ordinary differential equation with constant coefficients, which is known to have a unique and stable solution. The problem is well-posed.\n- **Objectivity:** The problem is described using precise, unambiguous technical language. There are no subjective or opinion-based elements.\n\n**Step 3: Verdict and Action**\nThe problem is valid as it is scientifically grounded, well-posed, objective, and internally consistent. A solution will be derived.\n\nThe derivation begins with the principle of conservation of mass for the gas within the chamber volume $V$. For an isothermal system where the ideal gas law holds, the number of molecules $N$ in the volume $V$ at pressure $P(t)$ and constant temperature $T$ is given by $P(t)V = N(t) k_B T$, where $k_B$ is the Boltzmann constant. Differentiating with respect to time $t$ gives:\n$$\nV \\frac{dP(t)}{dt} = k_B T \\frac{dN(t)}{dt}\n$$\nThe rate of change of the number of molecules in the volume, $\\frac{dN(t)}{dt}$, is the difference between the rate of molecules entering and the rate of molecules leaving.\nThroughput (with units of pressure $\\times$ volume / time) is directly proportional to the molecular flow rate. Specifically, a throughput $X$ corresponds to a molecular flow rate of $\\frac{X}{k_B T}$.\nThe total throughput into the chamber is from the gas load $G$. The total throughput out of the chamber is $Q(t)$. Therefore, the net rate of change of molecules is:\n$$\n\\frac{dN(t)}{dt} = \\frac{G}{k_B T} - \\frac{Q(t)}{k_B T}\n$$\nSubstituting this into the differentiated ideal gas law equation yields:\n$$\nV \\frac{dP(t)}{dt} = k_B T \\left( \\frac{G}{k_B T} - \\frac{Q(t)}{k_B T} \\right)\n$$\nThe term $k_B T$ cancels, resulting in the fundamental pump-down equation in terms of throughput:\n$$\nV \\frac{dP(t)}{dt} = G - Q(t)\n$$\nNext, we must express the net pumped throughput $Q(t)$ in terms of the chamber pressure $P(t)$ and the given constants $S$ and $C$. We have a system of two linear equations for $Q(t)$ and $P_p(t)$:\n1. $Q(t) = C(P(t) - P_p(t))$\n2. $Q(t) = S P_p(t)$\n\nFrom equation (2), we can express the pump inlet pressure as $P_p(t) = \\frac{Q(t)}{S}$. Substituting this into equation (1):\n$$\nQ(t) = C \\left( P(t) - \\frac{Q(t)}{S} \\right)\n$$\n$$\nQ(t) = C P(t) - \\frac{C}{S} Q(t)\n$$\nWe solve for $Q(t)$:\n$$\nQ(t) \\left( 1 + \\frac{C}{S} \\right) = C P(t)\n$$\n$$\nQ(t) \\left( \\frac{S+C}{S} \\right) = C P(t)\n$$\n$$\nQ(t) = \\frac{SC}{S+C} P(t)\n$$\nThe term $S_{eff} = \\frac{SC}{S+C}$ is the effective pumping speed of the pump and transfer line combination. It represents the equivalent pumping speed as seen from the chamber.\n\nNow, we substitute this expression for $Q(t)$ back into the pump-down differential equation:\n$$\nV \\frac{dP(t)}{dt} = G - \\left( \\frac{SC}{S+C} \\right) P(t)\n$$\nThis is a first-order linear ordinary differential equation with constant coefficients. We can rearrange it into the standard form $\\frac{dy}{dx} + f(x)y = g(x)$:\n$$\n\\frac{dP(t)}{dt} + \\left( \\frac{SC}{V(S+C)} \\right) P(t) = \\frac{G}{V}\n$$\nThe general solution to an ODE of the form $\\frac{dy}{dt} + ay = b$ is $y(t) = \\frac{b}{a} + K \\exp(-at)$, where $K$ is a constant of integration.\nIn our case, $a = \\frac{SC}{V(S+C)}$ and $b = \\frac{G}{V}$.\nThe steady-state pressure, $P_{ss}$, is achieved as $t \\to \\infty$, where $\\frac{dP}{dt} = 0$. This corresponds to the particular solution, which is $\\frac{b}{a}$:\n$$\nP_{ss} = \\frac{b}{a} = \\frac{G/V}{SC/(V(S+C))} = \\frac{G V(S+C)}{VSC} = G \\frac{S+C}{SC} = G \\left( \\frac{1}{S} + \\frac{1}{C} \\right)\n$$\nThe general solution is therefore:\n$$\nP(t) = P_{ss} + K \\exp\\left( - \\frac{SC}{V(S+C)} t \\right)\n$$\nwhere $K$ is determined by the initial condition $P(0) = P_0$. At $t=0$:\n$$\nP(0) = P_0 = P_{ss} + K \\exp(0) = P_{ss} + K\n$$\nThus, the constant of integration is $K = P_0 - P_{ss}$.\nSubstituting $K$ and $P_{ss}$ back into the general solution gives the final explicit expression for the chamber pressure $P(t)$:\n$$\nP(t) = P_{ss} + (P_0 - P_{ss}) \\exp\\left( - \\frac{SC}{V(S+C)} t \\right)\n$$\n$$\nP(t) = G \\left( \\frac{1}{S} + \\frac{1}{C} \\right) + \\left[ P_0 - G \\left( \\frac{1}{S} + \\frac{1}{C} \\right) \\right] \\exp\\left( - \\frac{SC}{V(S+C)} t \\right)\n$$\nThis is the complete, closed-form analytic solution for the chamber pressure as a function of time.",
            "answer": "$$\n\\boxed{G\\left(\\frac{1}{S} + \\frac{1}{C}\\right) + \\left(P_0 - G\\left(\\frac{1}{S} + \\frac{1}{C}\\right)\\right)\\exp\\left(-\\frac{SC}{V(S+C)}t\\right)}\n$$"
        },
        {
            "introduction": "Analytical models provide invaluable insight, but the complexity of real-world semiconductor processes ultimately requires computational fluid dynamics (CFD) for predictive modeling. This final practice serves as a hands-on introduction to the core principles of numerical simulation, specifically the Finite Volume Method (FVM). You are tasked with discretizing a diffusion-reaction equation and, most importantly, implementing a reactive flux boundary condition at a wafer surface in a way that strictly enforces the conservation of species . Mastering the discrete implementation of physical laws is fundamental to building robust and accurate CFD models for CVD, etching, and other transport-driven processes.",
            "id": "4126778",
            "problem": "Consider gas-phase mass transport of a single reacting precursor species in a one-dimensional domain representing the stagnant boundary layer above a semiconductor wafer during Chemical Vapor Deposition (CVD). Let $x \\in [0,L]$ denote the vertical coordinate with $x=0$ at the wafer surface and $x=L$ at the top of the computational domain. The species concentration is $c(x,t)$ with units of $\\mathrm{mol/m^3}$. The gas-phase transport obeys species conservation in the absence of convection: $$\\frac{\\partial c}{\\partial t} = D\\,\\frac{\\partial^2 c}{\\partial x^2},$$ where $D$ has units of $\\mathrm{m^2/s}$. At the wafer surface, the boundary condition is a Neumann flux condition that represents a surface reaction: $$-D\\,\\frac{\\partial c}{\\partial n} = R_s,$$ where the outward normal from the gas into the wafer is along $-x$, so $\\partial c/\\partial n = -\\partial c/\\partial x$ at $x=0$. Assume linear surface kinetics $R_s = k_s\\,c_w$ with $k_s$ in $\\mathrm{m/s}$ and $c_w$ the interfacial gas concentration at the wafer. At the top boundary $x=L$, impose zero-flux: $$\\frac{\\partial c}{\\partial x}\\bigg|_{x=L} = 0.$$\n\nStarting from the species conservation law (local balance over a control volume), discretize the domain into $N$ finite volumes using the Finite Volume Method (FVM), with uniform spacing $\\Delta x = L/N$, cell-centered unknowns $c_i(t)$ for $i=0,1,\\dots,N-1$, and backward Euler time integration over a single time step of size $\\Delta t$. Use area $A=1\\,\\mathrm{m^2}$ so that each cell volume is $V=\\Delta x\\,\\mathrm{m^3}$. Implement the wafer boundary flux condition in a way that is consistent with the Neumann condition and ensures discrete conservation at the interface. Then advance the solution from a uniform initial condition $c(x,0)=c_0$ by one time step, and simultaneously update a surface inventory $m_s$ (with units of $\\mathrm{mol}$) at the wafer according to the flux into the wafer integrated over the time step. The initial surface inventory should be $m_s(0)=0$.\n\nYour program must:\n- Derive and implement the discrete equations from first principles (integral conservation over each finite volume, constitutive diffusive flux, and boundary conditions), ensuring that the wafer boundary condition is incorporated so that the gas-phase loss equals the surface inventory gain over the time step.\n- For each provided test case, compute the updated concentration field $c_i(\\Delta t)$, compute the wafer flux over the time step, update $m_s(\\Delta t)$, and verify the discrete conservation statement: $$M_{\\mathrm{gas}}(\\Delta t) + m_s(\\Delta t) \\approx M_{\\mathrm{gas}}(0) + m_s(0),$$ where $$M_{\\mathrm{gas}}(t) = \\sum_{i=0}^{N-1} c_i(t)\\,\\Delta x.$$ Report a boolean for each case that is $true$ if the absolute conservation error is less than a tolerance $\\varepsilon$, and $false$ otherwise.\n\nPhysical units and numerical requirements:\n- Report and compute all quantities using International System of Units (SI): $L$ in $\\mathrm{m}$, $D$ in $\\mathrm{m^2/s}$, $k_s$ in $\\mathrm{m/s}$, $\\Delta t$ in $\\mathrm{s}$, $c$ in $\\mathrm{mol/m^3}$, and $m_s$ in $\\mathrm{mol}$.\n- Use the angle unit of radians if any angular quantity appears, although none are present here.\n- The boolean check must use an absolute tolerance $\\varepsilon = 10^{-12}$ in units of $\\mathrm{mol}$ for the mass balance residual.\n\nTest suite:\n- Case $1$ (general case): $N=50$, $L=2\\times 10^{-2}\\,\\mathrm{m}$, $D=10^{-4}\\,\\mathrm{m^2/s}$, $k_s=10^{-3}\\,\\mathrm{m/s}$, $\\Delta t=10^{-1}\\,\\mathrm{s}$, $c_0=1\\,\\mathrm{mol/m^3}$.\n- Case $2$ (zero surface reaction as a boundary condition check): $N=20$, $L=10^{-2}\\,\\mathrm{m}$, $D=5\\times 10^{-5}\\,\\mathrm{m^2/s}$, $k_s=0\\,\\mathrm{m/s}$, $\\Delta t=5\\times 10^{-2}\\,\\mathrm{s}$, $c_0=2\\,\\mathrm{mol/m^3}$.\n- Case $3$ (strong surface reaction to test stiffness at the boundary): $N=100$, $L=5\\times 10^{-2}\\,\\mathrm{m}$, $D=10^{-3}\\,\\mathrm{m^2/s}$, $k_s=20\\,\\mathrm{m/s}$, $\\Delta t=10^{-2}\\,\\mathrm{s}$, $c_0=5\\times 10^{-1}\\,\\mathrm{mol/m^3}$.\n- Case $4$ (single-cell domain, very low diffusivity): $N=1$, $L=10^{-3}\\,\\mathrm{m}$, $D=10^{-8}\\,\\mathrm{m^2/s}$, $k_s=1\\,\\mathrm{m/s}$, $\\Delta t=10\\,\\mathrm{s}$, $c_0=3\\,\\mathrm{mol/m^3}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the boolean results for the test suite as a comma-separated list enclosed in square brackets, for example, $$[true,false,true,true].$$ Use lowercase boolean literals exactly as shown.",
            "solution": "The problem requires the numerical solution of a one-dimensional transient diffusion equation with a reactive boundary condition, using the Finite Volume Method (FVM). A key requirement is to verify the discrete conservation of the total species amount over a single time step. The solution proceeds by first deriving the discretized equations from the integral form of the conservation law and then implementing these equations to solve for the concentration field and perform the conservation check.\n\n### 1. Governing Equation and Finite Volume Formulation\n\nThe species transport is governed by the one-dimensional diffusion equation:\n$$\n\\frac{\\partial c}{\\partial t} = D\\,\\frac{\\partial^2 c}{\\partial x^2}\n$$\nwhere $c(x,t)$ is the species concentration, $D$ is the diffusion coefficient, $x$ is the spatial coordinate, and $t$ is time.\n\nThe Finite Volume Method is based on the integral form of the conservation law over a control volume (or cell). For a generic cell $i$ of volume $V_i$ and surface area $\\partial V_i$, the conservation of species $c$ in the absence of internal sources or sinks is stated as:\n$$\n\\frac{d}{dt} \\int_{V_i} c \\,dV = -\\oint_{\\partial V_i} \\vec{J} \\cdot d\\vec{A}\n$$\nwhere $\\vec{J}$ is the diffusive flux, given by Fick's first law, $\\vec{J} = -D \\nabla c$.\n\nWe discretize the one-dimensional domain $x \\in [0, L]$ into $N$ uniform cells, each of width $\\Delta x = L/N$. The cell $i$ (for $i=0, 1, \\dots, N-1$) is centered at node $x_i$ and its boundaries (faces) are at $x_{i-1/2}$ and $x_{i+1/2}$. We assume a unit cross-sectional area $A=1\\,\\mathrm{m^2}$, so the volume of each cell is $V_i = \\Delta x \\cdot A = \\Delta x$. The concentration $c_i(t)$ represents the cell-averaged concentration.\n\nFor a one-dimensional cell $i$, the integral conservation law simplifies to:\n$$\n\\Delta x \\frac{dc_i}{dt} = J_{i-1/2} - J_{i+1/2}\n$$\nwhere $J_{i \\pm 1/2}$ is the diffusive flux per unit area at the cell faces $x_{i \\pm 1/2}$.\n\nWe use the backward Euler method for time integration. This is an implicit scheme, evaluating all spatial derivatives and fluxes at the future time level, $t^{n+1} = t^n + \\Delta t$. The time derivative is approximated as:\n$$\n\\frac{dc_i}{dt} \\approx \\frac{c_i^{n+1} - c_i^n}{\\Delta t}\n$$\nThe fluxes at the cell faces are approximated using a central difference scheme based on the adjacent cell-centered concentrations at time $t^{n+1}$:\n$$\nJ_{i+1/2}^{n+1} = -D \\frac{\\partial c}{\\partial x} \\bigg|_{x_{i+1/2}}^{n+1} \\approx -D \\frac{c_{i+1}^{n+1} - c_i^{n+1}}{\\Delta x}\n$$\nCombining these approximations yields the general discretized time-stepping equation:\n$$\n\\Delta x \\frac{c_i^{n+1} - c_i^n}{\\Delta t} = \\left(-D \\frac{c_i^{n+1} - c_{i-1}^{n+1}}{\\Delta x}\\right) - \\left(-D \\frac{c_{i+1}^{n+1} - c_i^{n+1}}{\\Delta x}\\right)\n$$\n\n### 2. Discretization of Interior and Boundary Cells\n\n**Interior Cells ($i = 1, \\dots, N-2$):**\nFor an interior cell, the above general equation holds directly. Rearranging it to group terms at the new time level $n+1$ on the left-hand side gives:\n$$\nc_i^{n+1} - \\frac{D \\Delta t}{(\\Delta x)^2} (c_{i+1}^{n+1} - 2c_i^{n+1} + c_{i-1}^{n+1}) = c_i^n\n$$\nDefining the diffusion number $\\alpha = \\frac{D \\Delta t}{(\\Delta x)^2}$, the equation becomes:\n$$\n-\\alpha c_{i-1}^{n+1} + (1 + 2\\alpha) c_i^{n+1} - \\alpha c_{i+1}^{n+1} = c_i^n\n$$\nThis linear algebraic equation relates the unknown concentration $c_i^{n+1}$ to its neighbors.\n\n**Boundary Cell at $x=L$ ($i = N-1$):**\nThis cell extends from $x_{N-3/2}$ to $x_{N-1/2}=L$. The balance equation is:\n$$\n\\Delta x \\frac{c_{N-1}^{n+1} - c_{N-1}^n}{\\Delta t} = J_{N-3/2}^{n+1} - J_{N-1/2}^{n+1}\n$$\nThe flux at the left face $x_{N-3/2}$ is $J_{N-3/2}^{n+1} \\approx -D \\frac{c_{N-1}^{n+1} - c_{N-2}^{n+1}}{\\Delta x}$. The flux at the right face $x_{N-1/2}=L$ is given by the boundary condition $\\frac{\\partial c}{\\partial x}|_{x=L} = 0$, which implies $J_{N-1/2}^{n+1} = 0$. Substituting these into the balance equation and rearranging yields:\n$$\n-\\alpha c_{N-2}^{n+1} + (1 + \\alpha) c_{N-1}^{n+1} = c_{N-1}^n\n$$\n\n**Boundary Cell at $x=0$ ($i = 0$):**\nThis cell extends from $x_{-1/2}=0$ to $x_{1/2}$. The balance equation is:\n$$\n\\Delta x \\frac{c_{0}^{n+1} - c_{0}^n}{\\Delta t} = J_{-1/2}^{n+1} - J_{1/2}^{n+1}\n$$\nThe flux at the right face is $J_{1/2}^{n+1} \\approx -D \\frac{c_1^{n+1} - c_0^{n+1}}{\\Delta x}$. The flux at the left face $x=0$ is determined by the surface reaction boundary condition: $-D \\frac{\\partial c}{\\partial n} = R_s$. With the outward normal $\\vec{n}$ pointing in the $-x$ direction, $\\frac{\\partial c}{\\partial n} = -\\frac{\\partial c}{\\partial x}$, so the condition becomes $D \\frac{\\partial c}{\\partial x}|_{x=0} = R_s$. The flux into the cell is $J_{-1/2} = -D \\frac{\\partial c}{\\partial x}|_{x=0} = -R_s$.\nThe reaction rate is $R_s = k_s c_w$, where $c_w=c(0,t)$ is the concentration at the wafer surface. For a backward Euler scheme, we evaluate this at $t^{n+1}$: $J_{-1/2}^{n+1} = -k_s c_w^{n+1}$. A common and consistent FVM practice is to approximate the face concentration $c_w$ with the adjacent cell-center concentration, $c_w^{n+1} \\approx c_0^{n+1}$.\nSubstituting the fluxes gives:\n$$\n\\Delta x \\frac{c_0^{n+1} - c_0^n}{\\Delta t} = -k_s c_0^{n+1} - \\left(-D \\frac{c_1^{n+1} - c_0^{n+1}}{\\Delta x}\\right)\n$$\nRearranging terms, we get:\n$$\n\\left(1 + \\frac{k_s \\Delta t}{\\Delta x} + \\frac{D \\Delta t}{(\\Delta x)^2}\\right) c_0^{n+1} - \\frac{D \\Delta t}{(\\Delta x)^2} c_1^{n+1} = c_0^n\n$$\nDefining $\\beta = \\frac{k_s \\Delta t}{\\Delta x}$, the equation becomes:\n$$\n(1 + \\alpha + \\beta) c_0^{n+1} - \\alpha c_1^{n+1} = c_0^n\n$$\n\n### 3. Linear System and Conservation Check\n\nThe set of $N$ linear algebraic equations for $c_i^{n+1}$ ($i=0, \\dots, N-1$) forms a tridiagonal system $\\mathbf{A} \\mathbf{c}^{n+1} = \\mathbf{c}^n$, which can be solved efficiently. For the special case $N=1$, there is a single cell spanning the domain. The balance equation simplifies to $c_0^{n+1} = \\frac{L}{L + k_s \\Delta t} c_0^n$.\n\nThe problem requires a verification of discrete mass conservation. The total amount of species in the system is the sum of the amount in the gas phase, $M_{\\mathrm{gas}}(t) = \\sum_{i=0}^{N-1} c_i(t) \\Delta x$, and the amount deposited on the surface, $m_s(t)$.\nInitially, at $t=0$:\n$$ M_{\\mathrm{gas}}(0) = \\sum_i c_0 \\Delta x = N c_0 (L/N) = c_0 L \\quad \\text{and} \\quad m_s(0) = 0 $$\nThe total initial amount is $M_{\\mathrm{tot}}(0) = c_0 L$.\n\nAfter one time step $\\Delta t$, the gas-phase amount is $M_{\\mathrm{gas}}(\\Delta t) = \\sum_{i=0}^{N-1} c_i^{n+1} \\Delta x$. The amount deposited on the surface increases by the total flux into the surface over the time step. The rate of deposition is $R_s = k_s c_w$. Integrating over $\\Delta t$ with the same backward Euler approximation gives the change in surface inventory:\n$$ \\Delta m_s = (k_s c_w^{n+1}) \\Delta t $$\nTo ensure consistency with the FVM derivation, we must use the same approximation for $c_w^{n+1} \\approx c_0^{n+1}$.\nThus, the updated surface inventory is $m_s(\\Delta t) = m_s(0) + \\Delta m_s = k_s c_0^{n+1} \\Delta t$.\n\nThe total final amount is $M_{\\mathrm{tot}}(\\Delta t) = M_{\\mathrm{gas}}(\\Delta t) + m_s(\\Delta t)$. Conservation requires $M_{\\mathrm{tot}}(\\Delta t) \\approx M_{\\mathrm{tot}}(0)$.\nWe can prove that our FVM scheme is perfectly conservative. Summing all $N$ discrete balance equations:\n$$\n\\sum_{i=0}^{N-1} \\left( \\Delta x \\frac{c_i^{n+1} - c_i^n}{\\Delta t} \\right) = \\sum_{i=0}^{N-1} (J_{i-1/2}^{n+1} - J_{i+1/2}^{n+1})\n$$\nThe left side is $\\frac{M_{\\mathrm{gas}}^{n+1} - M_{\\mathrm{gas}}^n}{\\Delta t}$. The right side is a telescoping sum that simplifies to $J_{-1/2}^{n+1} - J_{N-1/2}^{n+1}$. Using our boundary flux approximations, this is $-k_s c_0^{n+1} - 0$.\n$$\n\\frac{M_{\\mathrm{gas}}^{n+1} - M_{\\mathrm{gas}}^n}{\\Delta t} = -k_s c_0^{n+1}\n$$\n$$\nM_{\\mathrm{gas}}^{n+1} - M_{\\mathrm{gas}}^n = -k_s c_0^{n+1} \\Delta t = -m_s^{n+1}\n$$\n$$\nM_{\\mathrm{gas}}^{n+1} + m_s^{n+1} = M_{\\mathrm{gas}}^n\n$$\nSince $m_s^n = m_s(0) = 0$, we have $M_{\\mathrm{gas}}^{n+1} + m_s^{n+1} = M_{\\mathrm{gas}}^n + m_s^n$. This proves that the total amount is conserved by the numerical scheme. The check in the code, therefore, should pass up to floating-point precision.",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef solve():\n    \"\"\"\n    Solves the 1D transient diffusion-reaction problem for multiple test cases\n    and verifies discrete mass conservation.\n    \"\"\"\n    \n    # Test suite as defined in the problem statement.\n    # Each tuple is (N, L, D, ks, dt, c0).\n    test_cases = [\n        (50, 2e-2, 1e-4, 1e-3, 1e-1, 1.0),\n        (20, 1e-2, 5e-5, 0.0, 5e-2, 2.0),\n        (100, 5e-2, 1e-3, 20.0, 1e-2, 0.5),\n        (1, 1e-3, 1e-8, 1.0, 10.0, 3.0),\n    ]\n\n    def run_single_case(params):\n        \"\"\"\n        Runs the simulation for a single test case and returns a boolean\n        indicating if mass conservation is satisfied.\n        \"\"\"\n        N, L, D, ks, dt, c0 = params\n        dx = L / N\n        epsilon = 1e-12\n\n        # Initial state\n        c_initial_field = np.full(N, c0)\n        # Total initial mass in the gas phase: M_gas(0) = sum(c_i(0) * dx) = N * c0 * (L/N) = c0 * L\n        M_gas_initial = c0 * L\n        ms_initial = 0.0\n        total_initial = M_gas_initial + ms_initial\n\n        # --- Solve for the concentration field at t = dt ---\n        \n        # The N=1 case is a single algebraic equation, not a system.\n        if N == 1:\n            # Derived from the balance: dx*(c_1-c_0)/dt = -ks*c_1\n            # (dx/dt)*c_1 - (dx/dt)*c_0 = -ks*c_1\n            # (dx + ks*dt)*c_1 = dx*c_0\n            # Since dx=L for N=1: c_1 = (L / (L + ks*dt)) * c_0\n            c_final_0 = (L / (L + ks * dt)) * c0\n            c_final_field = np.array([c_final_0])\n        else:\n            # For N>1, set up and solve the tridiagonal system A*c_final = c_initial\n            alpha = D * dt / (dx**2)\n            beta = ks * dt / dx\n\n            # Matrix A is represented in banded format for scipy.linalg.solve_banded\n            # ab[0, :] = super-diagonal (u=1)\n            # ab[1, :] = main-diagonal\n            # ab[2, :] = sub-diagonal (l=1)\n            ab = np.zeros((3, N))\n\n            # Fill main diagonal\n            ab[1, :] = 1.0 + 2.0 * alpha\n            # Modify first and last elements for boundary conditions\n            ab[1, 0] = 1.0 + alpha + beta      # BC at x=0 (wafer)\n            ab[1, N - 1] = 1.0 + alpha         # BC at x=L (zero-flux)\n\n            # Fill off-diagonals\n            ab[0, 1:] = -alpha                  # Super-diagonal\n            ab[2, :-1] = -alpha                 # Sub-diagonal\n            \n            # The right-hand side vector is the initial concentration field\n            b = c_initial_field\n\n            # Solve the linear system\n            c_final_field = solve_banded((1, 1), ab, b)\n\n        # --- Conservation Check ---\n        \n        # Total final mass in the gas phase\n        M_gas_final = np.sum(c_final_field) * dx\n        \n        # Surface inventory update.\n        # The approximation c_w = c_0(dt) is used, consistent with the FVM derivation.\n        ms_final = ks * c_final_field[0] * dt\n\n        total_final = M_gas_final + ms_final\n        \n        # Calculate absolute conservation error\n        error = abs(total_final - total_initial)\n\n        return error  epsilon\n\n    # Run all test cases\n    results = [run_single_case(case) for case in test_cases]\n    \n    # Print the final result in the specified format\n    print(f\"[{','.join(map(str, results))}]\".lower())\n\nsolve()\n```"
        }
    ]
}