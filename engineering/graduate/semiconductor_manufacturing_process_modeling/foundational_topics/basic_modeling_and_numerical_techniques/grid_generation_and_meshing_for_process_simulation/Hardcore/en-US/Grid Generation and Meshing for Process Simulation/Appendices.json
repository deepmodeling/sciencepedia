{
    "hands_on_practices": [
        {
            "introduction": "In Finite Element Method (FEM) simulations, the quality of the mesh is paramount for achieving accurate and stable results. For geometries with curved boundaries, such as those found in modern semiconductor devices, higher-order isoparametric elements are essential for accurate representation. This exercise provides foundational practice in assessing the validity of such an element by calculating the Jacobian determinant of the mapping from a simple reference shape to the complex physical element, a critical step in verifying that the element is not distorted or inverted .",
            "id": "4129456",
            "problem": "A second-order isoparametric triangular element is used to resolve a curved diffusion front in a semiconductor process simulation mesh for the Finite Element Method (FEM). The reference element coordinates are denoted by $r$ and $s$ on the standard unit triangle with vertices at $(r,s)=(1,0)$, $(0,1)$, and $(0,0)$, and the quadratic Lagrange shape functions for the triangle are defined on the barycentric coordinates $L_1=r$, $L_2=s$, $L_3=1-r-s$ as\n$$\nN_1=L_1(2L_1-1),\\quad N_2=L_2(2L_2-1),\\quad N_3=L_3(2L_3-1),\\quad N_4=4L_1L_2,\\quad N_5=4L_2L_3,\\quad N_6=4L_3L_1.\n$$\nThe physical coordinates $(x,y)$ are mapped isoparametrically by\n$$\nx(r,s)=\\sum_{i=1}^{6}N_i(r,s)\\,x_i,\\qquad y(r,s)=\\sum_{i=1}^{6}N_i(r,s)\\,y_i,\n$$\nwith the following node locations in physical space, listed in the conventional order corresponding to $N_1$ through $N_6$:\n$$\n(x_1,y_1)=(0,0),\\quad (x_2,y_2)=(4,0),\\quad (x_3,y_3)=(0,3),\\quad (x_4,y_4)=(2,0.2),\\quad (x_5,y_5)=(1.8,1.7),\\quad (x_6,y_6)=(0.1,1.6).\n$$\nThese coordinates define a curved boundary predominantly along the edge between nodes $2$ and $3$, typical of rounded features introduced by lithography and etch processes. For numerical integration over the element, consider the three-point Gaussian quadrature rule on the reference triangle with the integration points\n$$\n(r,s)\\in\\left\\{\\left(\\frac{1}{6},\\frac{1}{6}\\right),\\left(\\frac{2}{3},\\frac{1}{6}\\right),\\left(\\frac{1}{6},\\frac{2}{3}\\right)\\right\\}.\n$$\nStarting from first principles of isoparametric mapping and the definition of the Jacobian of a transformation, compute the Jacobian determinant\n$$\nJ(r,s)=\\det\\left(\\frac{\\partial(x,y)}{\\partial(r,s)}\\right)=\\frac{\\partial x}{\\partial r}\\frac{\\partial y}{\\partial s}-\\frac{\\partial x}{\\partial s}\\frac{\\partial y}{\\partial r}\n$$\nat each of the given integration points, and verify the positivity constraint required to avoid inverted or degenerate elements in stable FEM assembly. Report the minimum value of $J$ among the listed integration points. Round your final answer to five significant figures. No physical units are required.",
            "solution": "The isoparametric mapping for a quadratic triangular element is constructed from the quadratic Lagrange basis functions on barycentric coordinates, which ensures geometric conformity of curved boundaries through mid-edge node placement. The Jacobian determinant $J(r,s)$ measures the local area scaling of the mapping and must remain strictly positive on the integration domain to preserve orientation and avoid numerical instability in the Finite Element Method (FEM) assembly.\n\nWe begin by writing the mapping in terms of the shape functions:\n$$\nx(r,s)=\\sum_{i=1}^{6}N_i(r,s)\\,x_i,\\qquad y(r,s)=\\sum_{i=1}^{6}N_i(r,s)\\,y_i,\n$$\nand compute the Jacobian matrix entries\n$$\nx_r(r,s)=\\sum_{i=1}^{6}\\frac{\\partial N_i}{\\partial r}(r,s)\\,x_i,\\quad x_s(r,s)=\\sum_{i=1}^{6}\\frac{\\partial N_i}{\\partial s}(r,s)\\,x_i,\n$$\n$$\ny_r(r,s)=\\sum_{i=1}^{6}\\frac{\\partial N_i}{\\partial r}(r,s)\\,y_i,\\quad y_s(r,s)=\\sum_{i=1}^{6}\\frac{\\partial N_i}{\\partial s}(r,s)\\,y_i.\n$$\nWith $L_1=r$, $L_2=s$, and $L_3=1-r-s$, the quadratic shape functions are\n$$\nN_1=r(2r-1),\\quad N_2=s(2s-1),\\quad N_3=L_3(2L_3-1),\\quad N_4=4rs,\\quad N_5=4sL_3,\\quad N_6=4L_3r.\n$$\nTheir partial derivatives follow from direct differentiation and the identities $\\frac{\\partial L_3}{\\partial r}=-1$ and $\\frac{\\partial L_3}{\\partial s}=-1$:\n$$\n\\frac{\\partial N_1}{\\partial r}=4r-1,\\quad \\frac{\\partial N_1}{\\partial s}=0,\\qquad \\frac{\\partial N_2}{\\partial r}=0,\\quad \\frac{\\partial N_2}{\\partial s}=4s-1,\n$$\n$$\n\\frac{\\partial N_3}{\\partial r}=(4L_3-1)\\frac{\\partial L_3}{\\partial r}=-4L_3+1,\\quad \\frac{\\partial N_3}{\\partial s}=-4L_3+1,\n$$\n$$\n\\frac{\\partial N_4}{\\partial r}=4s,\\quad \\frac{\\partial N_4}{\\partial s}=4r,\n$$\n$$\n\\frac{\\partial N_5}{\\partial r}=4s\\,\\frac{\\partial L_3}{\\partial r}=-4s,\\quad \\frac{\\partial N_5}{\\partial s}=4\\left(L_3+s\\,\\frac{\\partial L_3}{\\partial s}\\right)=4(1-r-2s),\n$$\n$$\n\\frac{\\partial N_6}{\\partial r}=4\\left(L_3+r\\,\\frac{\\partial L_3}{\\partial r}\\right)=4(1-2r-s),\\quad \\frac{\\partial N_6}{\\partial s}=4r\\,\\frac{\\partial L_3}{\\partial s}=-4r.\n$$\nWe evaluate these expressions at each of the three Gaussian quadrature points.\n\nPoint $1$: $(r,s)=\\left(\\frac{1}{6},\\frac{1}{6}\\right)$ gives $L_3=\\frac{2}{3}$. The derivatives are\n$$\n\\frac{\\partial N_1}{\\partial r}=-\\frac{1}{3},\\quad \\frac{\\partial N_1}{\\partial s}=0,\\quad \\frac{\\partial N_2}{\\partial r}=0,\\quad \\frac{\\partial N_2}{\\partial s}=-\\frac{1}{3},\n$$\n$$\n\\frac{\\partial N_3}{\\partial r}=-\\frac{5}{3},\\quad \\frac{\\partial N_3}{\\partial s}=-\\frac{5}{3},\\quad \\frac{\\partial N_4}{\\partial r}=\\frac{2}{3},\\quad \\frac{\\partial N_4}{\\partial s}=\\frac{2}{3},\n$$\n$$\n\\frac{\\partial N_5}{\\partial r}=-\\frac{2}{3},\\quad \\frac{\\partial N_5}{\\partial s}=2,\\quad \\frac{\\partial N_6}{\\partial r}=2,\\quad \\frac{\\partial N_6}{\\partial s}=-\\frac{2}{3}.\n$$\nUsing the node coordinates\n$$\n(x_1,y_1)=(0,0),\\ (x_2,y_2)=(4,0),\\ (x_3,y_3)=(0,3),\\ (x_4,y_4)=(2,0.2),\\ (x_5,y_5)=(1.8,1.7),\\ (x_6,y_6)=(0.1,1.6),\n$$\nwe find\n$$\nx_r=\\left(-\\frac{1}{3}\\right)\\cdot 0+0\\cdot 4+\\left(-\\frac{5}{3}\\right)\\cdot 0+\\left(\\frac{2}{3}\\right)\\cdot 2+\\left(-\\frac{2}{3}\\right)\\cdot 1.8+2\\cdot 0.1=\\frac{1}{3},\n$$\n$$\nx_s=0\\cdot 0+\\left(-\\frac{1}{3}\\right)\\cdot 4+\\left(-\\frac{5}{3}\\right)\\cdot 0+\\left(\\frac{2}{3}\\right)\\cdot 2+2\\cdot 1.8+\\left(-\\frac{2}{3}\\right)\\cdot 0.1=\\frac{53}{15},\n$$\n$$\ny_r=\\left(-\\frac{1}{3}\\right)\\cdot 0+0\\cdot 0+\\left(-\\frac{5}{3}\\right)\\cdot 3+\\left(\\frac{2}{3}\\right)\\cdot 0.2+\\left(-\\frac{2}{3}\\right)\\cdot 1.7+2\\cdot 1.6=-\\frac{14}{5},\n$$\n$$\ny_s=0\\cdot 0+\\left(-\\frac{1}{3}\\right)\\cdot 0+\\left(-\\frac{5}{3}\\right)\\cdot 3+\\left(\\frac{2}{3}\\right)\\cdot 0.2+2\\cdot 1.7+\\left(-\\frac{2}{3}\\right)\\cdot 1.6=-\\frac{38}{15}.\n$$\nThus,\n$$\nJ_1=x_r\\,y_s-x_s\\,y_r=\\left(\\frac{1}{3}\\right)\\left(-\\frac{38}{15}\\right)-\\left(\\frac{53}{15}\\right)\\left(-\\frac{14}{5}\\right)=-\\frac{38}{45}+\\frac{742}{75}=\\frac{2036}{225}\\approx 9.0488889.\n$$\n\nPoint $2$: $(r,s)=\\left(\\frac{2}{3},\\frac{1}{6}\\right)$ gives $L_3=\\frac{1}{6}$. The derivatives are\n$$\n\\frac{\\partial N_1}{\\partial r}=\\frac{5}{3},\\quad \\frac{\\partial N_1}{\\partial s}=0,\\quad \\frac{\\partial N_2}{\\partial r}=0,\\quad \\frac{\\partial N_2}{\\partial s}=-\\frac{1}{3},\n$$\n$$\n\\frac{\\partial N_3}{\\partial r}=\\frac{1}{3},\\quad \\frac{\\partial N_3}{\\partial s}=\\frac{1}{3},\\quad \\frac{\\partial N_4}{\\partial r}=\\frac{2}{3},\\quad \\frac{\\partial N_4}{\\partial s}=\\frac{8}{3},\n$$\n$$\n\\frac{\\partial N_5}{\\partial r}=-\\frac{2}{3},\\quad \\frac{\\partial N_5}{\\partial s}=0,\\quad \\frac{\\partial N_6}{\\partial r}=-2,\\quad \\frac{\\partial N_6}{\\partial s}=-\\frac{8}{3}.\n$$\nCompute\n$$\nx_r=\\left(\\frac{5}{3}\\right)\\cdot 0+0\\cdot 4+\\left(\\frac{1}{3}\\right)\\cdot 0+\\left(\\frac{2}{3}\\right)\\cdot 2+\\left(-\\frac{2}{3}\\right)\\cdot 1.8+(-2)\\cdot 0.1=-\\frac{1}{15},\n$$\n$$\nx_s=0\\cdot 0+\\left(-\\frac{1}{3}\\right)\\cdot 4+\\left(\\frac{1}{3}\\right)\\cdot 0+\\left(\\frac{8}{3}\\right)\\cdot 2+0\\cdot 1.8+\\left(-\\frac{8}{3}\\right)\\cdot 0.1=\\frac{56}{15},\n$$\n$$\ny_r=\\left(\\frac{5}{3}\\right)\\cdot 0+0\\cdot 0+\\left(\\frac{1}{3}\\right)\\cdot 3+\\left(\\frac{2}{3}\\right)\\cdot 0.2+\\left(-\\frac{2}{3}\\right)\\cdot 1.7+(-2)\\cdot 1.6=-\\frac{16}{5},\n$$\n$$\ny_s=0\\cdot 0+\\left(-\\frac{1}{3}\\right)\\cdot 0+\\left(\\frac{1}{3}\\right)\\cdot 3+\\left(\\frac{8}{3}\\right)\\cdot 0.2+0\\cdot 1.7+\\left(-\\frac{8}{3}\\right)\\cdot 1.6=-\\frac{41}{15}.\n$$\nTherefore,\n$$\nJ_2=x_r\\,y_s-x_s\\,y_r=\\left(-\\frac{1}{15}\\right)\\left(-\\frac{41}{15}\\right)-\\left(\\frac{56}{15}\\right)\\left(-\\frac{16}{5}\\right)=\\frac{41}{225}+\\frac{896}{75}=\\frac{2729}{225}\\approx 12.1288889.\n$$\n\nPoint $3$: $(r,s)=\\left(\\frac{1}{6},\\frac{2}{3}\\right)$ gives $L_3=\\frac{1}{6}$. The derivatives are\n$$\n\\frac{\\partial N_1}{\\partial r}=-\\frac{1}{3},\\quad \\frac{\\partial N_1}{\\partial s}=0,\\quad \\frac{\\partial N_2}{\\partial r}=0,\\quad \\frac{\\partial N_2}{\\partial s}=\\frac{5}{3},\n$$\n$$\n\\frac{\\partial N_3}{\\partial r}=\\frac{1}{3},\\quad \\frac{\\partial N_3}{\\partial s}=\\frac{1}{3},\\quad \\frac{\\partial N_4}{\\partial r}=\\frac{8}{3},\\quad \\frac{\\partial N_4}{\\partial s}=\\frac{2}{3},\n$$\n$$\n\\frac{\\partial N_5}{\\partial r}=-\\frac{8}{3},\\quad \\frac{\\partial N_5}{\\partial s}=-2,\\quad \\frac{\\partial N_6}{\\partial r}=0,\\quad \\frac{\\partial N_6}{\\partial s}=-\\frac{2}{3}.\n$$\nCompute\n$$\nx_r=\\left(-\\frac{1}{3}\\right)\\cdot 0+0\\cdot 4+\\left(\\frac{1}{3}\\right)\\cdot 0+\\left(\\frac{8}{3}\\right)\\cdot 2+\\left(-\\frac{8}{3}\\right)\\cdot 1.8+0\\cdot 0.1=\\frac{8}{15},\n$$\n$$\nx_s=0\\cdot 0+\\left(\\frac{5}{3}\\right)\\cdot 4+\\left(\\frac{1}{3}\\right)\\cdot 0+\\left(\\frac{2}{3}\\right)\\cdot 2+(-2)\\cdot 1.8+\\left(-\\frac{2}{3}\\right)\\cdot 0.1=\\frac{13}{3},\n$$\n$$\ny_r=\\left(-\\frac{1}{3}\\right)\\cdot 0+0\\cdot 0+\\left(\\frac{1}{3}\\right)\\cdot 3+\\left(\\frac{8}{3}\\right)\\cdot 0.2+\\left(-\\frac{8}{3}\\right)\\cdot 1.7+0\\cdot 1.6=-3,\n$$\n$$\ny_s=0\\cdot 0+\\left(\\frac{5}{3}\\right)\\cdot 0+\\left(\\frac{1}{3}\\right)\\cdot 3+\\left(\\frac{2}{3}\\right)\\cdot 0.2+(-2)\\cdot 1.7+\\left(-\\frac{2}{3}\\right)\\cdot 1.6=-\\frac{10}{3}.\n$$\nHence,\n$$\nJ_3=x_r\\,y_s-x_s\\,y_r=\\left(\\frac{8}{15}\\right)\\left(-\\frac{10}{3}\\right)-\\left(\\frac{13}{3}\\right)(-3)=-\\frac{16}{9}+13=\\frac{101}{9}\\approx 11.2222222.\n$$\n\nAll three Jacobian determinants are strictly positive:\n$$\nJ_1=\\frac{2036}{225}\\approx 9.0488889,\\quad J_2=\\frac{2729}{225}\\approx 12.1288889,\\quad J_3=\\frac{101}{9}\\approx 11.2222222,\n$$\nwhich satisfies the positivity constraint needed to avoid inverted or degenerate elements in stable FEM assembly. The minimum of these values is\n$$\n\\min\\{J_1,J_2,J_3\\}=\\frac{2036}{225}\\approx 9.0488889.\n$$\nRounded to five significant figures, the minimum Jacobian determinant is $9.0489$.",
            "answer": "$$\\boxed{9.0489}$$"
        },
        {
            "introduction": "The transition from two-dimensional models to three-dimensional simulations introduces new challenges in mesh quality, most notably the formation of \"sliver\" tetrahedra. These poorly shaped elements can compromise numerical stability and lead to inaccurate results. This practice moves from analyzing mesh quality to actively improving it by demonstrating how a local vertex relocation strategy can repair a sliver tetrahedron, thereby maximizing its minimum dihedral angle and restoring mesh integrity .",
            "id": "4129475",
            "problem": "In three-dimensional process simulation for semiconductor manufacturing, tetrahedral mesh quality has a direct impact on numerical conditioning and accuracy of transport and reaction models. A common pathology is the presence of sliver tetrahedra, characterized by dihedral angles near $0^{\\circ}$ or $180^{\\circ}$. Consider a representative local mesh patch near a planar boundary (the wafer surface), modeled as the plane $z=0$. Three boundary vertices form an equilateral triangle of side length $a0$ in the plane $z=0$, with coordinates\n$$\n\\mathbf{p}_{0}=(0,0,0),\\quad \\mathbf{p}_{1}=(a,0,0),\\quad \\mathbf{p}_{2}=\\left(\\frac{a}{2},\\frac{\\sqrt{3}\\,a}{2},0\\right).\n$$\nAn interior vertex $\\mathbf{p}_{3}$ lies above the centroid of the base triangle by a small height $h_{0}0$, creating a sliver tetrahedron $(\\mathbf{p}_{0},\\mathbf{p}_{1},\\mathbf{p}_{2},\\mathbf{p}_{3})$. Its centroid is\n$$\n\\mathbf{c}=\\left(\\frac{a}{2},\\frac{\\sqrt{3}\\,a}{6},0\\right),\n$$\nand the interior vertex is initially\n$$\n\\mathbf{p}_{3}^{(0)}=\\left(\\frac{a}{2},\\frac{\\sqrt{3}\\,a}{6},h_{0}\\right),\n$$\nwith $h_{0}\\ll a$. Because the boundary vertices lie on $z=0$, any local transformation must preserve boundary conformity, meaning it must not move any boundary vertex off the boundary plane. Two admissible local transformations are:\n- Constrained vertex relocation (smoothing) of the interior vertex $\\mathbf{p}_{3}$ along the line orthogonal to the boundary plane passing through $\\mathbf{c}$, i.e., $\\mathbf{p}_{3}=\\mathbf{c}+h\\,\\hat{\\mathbf{k}}$, where $\\hat{\\mathbf{k}}=(0,0,1)$ and $h0$.\n- Topology-preserving flips inside the interior (e.g., $2$–$3$ flips), which require additional interior tetrahedra; however, in this single-tetrahedron patch only vertex relocation is applicable without introducing new vertices.\n\nUsing only fundamental geometric definitions (Euclidean dot and cross products) and the definition of the dihedral angle between two planes as the angle between their normal vectors, do the following:\n1. Derive the dihedral angle $\\theta(h)$, as a function of $h$ and $a$, between the base face $(\\mathbf{p}_{0},\\mathbf{p}_{1},\\mathbf{p}_{2})$ and a lateral face sharing the base edge $(\\mathbf{p}_{0},\\mathbf{p}_{1})$, i.e., the face $(\\mathbf{p}_{0},\\mathbf{p}_{1},\\mathbf{p}_{3})$.\n2. Impose the vertex-relocation transformation $\\mathbf{p}_{3}=\\mathbf{c}+h\\,\\hat{\\mathbf{k}}$ and determine the value $h^{\\star}0$ that equalizes all edge lengths of the tetrahedron. Justify why this choice maximizes the minimum dihedral angle by symmetry and shape regularity under the given constraints.\n3. Evaluate the improved dihedral angle $\\theta(h^{\\star})$ from part 1 at this optimal height. Express your final answer in degrees, and round your result to four significant figures.\n\nAngle unit requirement: express the final angle in degrees. If you need to approximate, round your answer to four significant figures. No boundary vertices may move off the plane $z=0$ at any point in your proposed transformation.",
            "solution": "The solution is structured in three parts as requested by the problem statement.\n\nPart 1: Derivation of the dihedral angle $\\theta(h)$\n\nThe dihedral angle between two faces of a polyhedron is defined as the angle between the normal vectors to the planes containing those faces. We are asked to find the dihedral angle $\\theta(h)$ between the base face $F_{base} = (\\mathbf{p}_{0},\\mathbf{p}_{1},\\mathbf{p}_{2})$ and the lateral face $F_{lat} = (\\mathbf{p}_{0},\\mathbf{p}_{1},\\mathbf{p}_{3})$.\n\nThe vertices are given by:\n$\\mathbf{p}_{0}=(0,0,0)$\n$\\mathbf{p}_{1}=(a,0,0)$\n$\\mathbf{p}_{2}=\\left(\\frac{a}{2},\\frac{\\sqrt{3}\\,a}{2},0\\right)$\n$\\mathbf{p}_{3}=\\left(\\frac{a}{2},\\frac{\\sqrt{3}\\,a}{6},h\\right)$\n\nThe base face lies in the plane $z=0$. A normal vector to this plane is $\\mathbf{n}_{base} = \\hat{\\mathbf{k}} = (0,0,1)$. The magnitude is $|\\mathbf{n}_{base}|=1$.\n\nTo find the normal vector to the lateral face $F_{lat}$, we compute the cross product of two edge vectors lying on that face, for instance, $\\mathbf{v}_{10} = \\mathbf{p}_{1} - \\mathbf{p}_{0}$ and $\\mathbf{v}_{30} = \\mathbf{p}_{3} - \\mathbf{p}_{0}$.\n$\\mathbf{v}_{10} = (a,0,0) - (0,0,0) = (a,0,0)$\n$\\mathbf{v}_{30} = \\left(\\frac{a}{2},\\frac{\\sqrt{3}\\,a}{6},h\\right) - (0,0,0) = \\left(\\frac{a}{2},\\frac{\\sqrt{3}\\,a}{6},h\\right)$\n\nThe normal vector $\\mathbf{n}_{lat}$ is:\n$$\n\\mathbf{n}_{lat} = \\mathbf{v}_{10} \\times \\mathbf{v}_{30} =\n\\begin{vmatrix}\n\\hat{\\mathbf{i}}  \\hat{\\mathbf{j}}  \\hat{\\mathbf{k}} \\\\\na  0  0 \\\\\n\\frac{a}{2}  \\frac{\\sqrt{3}\\,a}{6}  h\n\\end{vmatrix}\n= \\hat{\\mathbf{i}}\\left(0 \\cdot h - 0 \\cdot \\frac{\\sqrt{3}\\,a}{6}\\right) - \\hat{\\mathbf{j}}\\left(a \\cdot h - 0 \\cdot \\frac{a}{2}\\right) + \\hat{\\mathbf{k}}\\left(a \\cdot \\frac{\\sqrt{3}\\,a}{6} - 0 \\cdot \\frac{a}{2}\\right)\n$$\n$$\n\\mathbf{n}_{lat} = \\left(0, -ah, \\frac{\\sqrt{3}\\,a^2}{6}\\right)\n$$\nThe magnitude of $\\mathbf{n}_{lat}$ is:\n$$\n|\\mathbf{n}_{lat}| = \\sqrt{0^2 + (-ah)^2 + \\left(\\frac{\\sqrt{3}\\,a^2}{6}\\right)^2} = \\sqrt{a^2h^2 + \\frac{3a^4}{36}} = \\sqrt{a^2h^2 + \\frac{a^4}{12}} = a\\sqrt{h^2 + \\frac{a^2}{12}}\n$$\nThe dihedral angle $\\theta(h)$ is the angle between $\\mathbf{n}_{base}$ and $\\mathbf{n}_{lat}$. The cosine of this angle is given by the dot product formula:\n$$\n\\cos(\\theta(h)) = \\frac{\\mathbf{n}_{base} \\cdot \\mathbf{n}_{lat}}{|\\mathbf{n}_{base}| |\\mathbf{n}_{lat}|}\n$$\nThe dot product is:\n$$\n\\mathbf{n}_{base} \\cdot \\mathbf{n}_{lat} = (0,0,1) \\cdot \\left(0, -ah, \\frac{\\sqrt{3}\\,a^2}{6}\\right) = \\frac{\\sqrt{3}\\,a^2}{6}\n$$\nSubstituting the dot product and magnitudes:\n$$\n\\cos(\\theta(h)) = \\frac{\\frac{\\sqrt{3}\\,a^2}{6}}{1 \\cdot a\\sqrt{h^2 + \\frac{a^2}{12}}} = \\frac{\\sqrt{3}\\,a}{6\\sqrt{h^2 + \\frac{a^2}{12}}} = \\frac{\\sqrt{3}\\,a}{6\\sqrt{\\frac{12h^2+a^2}{12}}} = \\frac{\\sqrt{3}\\,a \\cdot \\sqrt{12}}{6\\sqrt{12h^2+a^2}} = \\frac{\\sqrt{3}\\,a \\cdot 2\\sqrt{3}}{6\\sqrt{12h^2+a^2}} = \\frac{a}{\\sqrt{12h^2+a^2}}\n$$\nThus, the dihedral angle as a function of $h$ and $a$ is:\n$$\n\\theta(h) = \\arccos\\left(\\frac{a}{\\sqrt{a^2 + 12h^2}}\\right)\n$$\n\nPart 2: Determination of the optimal height $h^{\\star}$\n\nFor the tetrahedron to have all edge lengths equal, it must be a regular tetrahedron. The base is an equilateral triangle with side length $a$. Therefore, the three lateral edges $(\\mathbf{p}_{0},\\mathbf{p}_{3})$, $(\\mathbf{p}_{1},\\mathbf{p}_{3})$, and $(\\mathbf{p}_{2},\\mathbf{p}_{3})$ must also have length $a$.\nLet's compute the squared length of one of these edges, for example $|\\mathbf{p}_{3} - \\mathbf{p}_{0}|^2$:\n$$\n|\\mathbf{p}_{3} - \\mathbf{p}_{0}|^2 = \\left\\|\\left(\\frac{a}{2},\\frac{\\sqrt{3}\\,a}{6},h\\right)\\right\\|^2 = \\left(\\frac{a}{2}\\right)^2 + \\left(\\frac{\\sqrt{3}\\,a}{6}\\right)^2 + h^2 = \\frac{a^2}{4} + \\frac{3a^2}{36} + h^2 = \\frac{a^2}{4} + \\frac{a^2}{12} + h^2\n$$\n$$\n|\\mathbf{p}_{3} - \\mathbf{p}_{0}|^2 = \\frac{3a^2+a^2}{12} + h^2 = \\frac{4a^2}{12} + h^2 = \\frac{a^2}{3} + h^2\n$$\nSetting this squared length equal to $a^2$:\n$$\n\\frac{a^2}{3} + h^2 = a^2 \\implies h^2 = a^2 - \\frac{a^2}{3} = \\frac{2a^2}{3}\n$$\nSince $h0$, the optimal height $h^{\\star}$ is:\n$$\nh^{\\star} = \\sqrt{\\frac{2a^2}{3}} = a\\sqrt{\\frac{2}{3}} = \\frac{\\sqrt{6}}{3}a\n$$\nThis choice of $h^{\\star}$ corresponds to a regular tetrahedron. This configuration maximizes the minimum dihedral angle for the given constraints. The justification is as follows: The prescribed vertex transformation preserves the $C_{3v}$ symmetry of the tetrahedron. Due to this symmetry, for any given $h$, the three dihedral angles between the base and the lateral faces are equal ($\\theta_{base}(h)$), and the three dihedral angles between adjacent lateral faces are also equal ($\\theta_{apex}(h)$). The quality of the tetrahedron is determined by the smaller of these two angle values. The function $\\theta_{base}(h)$ is monotonically increasing with $h$ (from $0^{\\circ}$ as $h \\to 0$ to $90^{\\circ}$ as $h \\to \\infty$), while the function $\\theta_{apex}(h)$ can be shown to be monotonically decreasing (from $180^{\\circ}$ as $h \\to 0$ to $120^{\\circ}$ as $h \\to \\infty$). The minimum of these two functions is maximized when they are equal, i.e., $\\theta_{base}(h) = \\theta_{apex}(h)$. This condition of all dihedral angles being equal is, by definition, met in a regular tetrahedron. Thus, the height $h^{\\star}$ which forms a regular tetrahedron maximizes the minimum dihedral angle.\n\nPart 3: Evaluation of the improved dihedral angle $\\theta(h^{\\star})$\n\nWe substitute $h^{\\star}$ into the expression for $\\theta(h)$. Specifically, we use $(h^{\\star})^2 = \\frac{2a^2}{3}$:\n$$\n\\cos(\\theta(h^{\\star})) = \\frac{a}{\\sqrt{a^2 + 12(h^{\\star})^2}} = \\frac{a}{\\sqrt{a^2 + 12\\left(\\frac{2a^2}{3}\\right)}} = \\frac{a}{\\sqrt{a^2 + 8a^2}} = \\frac{a}{\\sqrt{9a^2}}\n$$\nSince $a0$, this simplifies to:\n$$\n\\cos(\\theta(h^{\\star})) = \\frac{a}{3a} = \\frac{1}{3}\n$$\nThe value of the optimal dihedral angle is therefore:\n$$\n\\theta(h^{\\star}) = \\arccos\\left(\\frac{1}{3}\\right)\n$$\nTo express this in degrees and round to four significant figures:\n$$\n\\theta(h^{\\star}) \\approx 70.528779...^{\\circ}\n$$\nRounding this value to four significant figures gives $70.53^{\\circ}$.",
            "answer": "$$\\boxed{70.53}$$"
        },
        {
            "introduction": "Process simulations, such as those modeling etching and deposition, are inherently dynamic, with moving boundaries that can deform and degrade the mesh over time. To maintain simulation fidelity, adaptive meshing techniques are employed, which require intelligent criteria for when to remesh or alter the mesh topology. This final practice explores the logic behind these dynamic triggers, showing how to use evolving mesh quality metrics and geometric criteria to decide when to remesh the domain or handle topological events like pinch-off .",
            "id": "4129485",
            "problem": "A two-dimensional etch simulation of a silicon feature is performed using a level-set representation of the evolving interface, $\\phi(x,t)=0$, on an unstructured triangular mesh under an Arbitrary Lagrangian–Eulerian (ALE) scheme. The interface advances with normal velocity $v_{n}(s,t)$ and the mesh nodes undergo tangential motion to reduce grid skew. As the feature evolves, elements deform and a narrow “neck” region may form. Robust process modeling requires triggering remeshing based on mesh quality metrics and performing topology changes to handle pinch-off or severe necking before the interface evolution becomes numerically unstable.\n\nConsider the following definitions and well-tested facts:\n- Let $J_{s}^{(K)} \\in (0,1]$ be the scaled Jacobian of element $K$, $\\theta_{\\min}^{(K)} \\in (0,\\pi/3]$ its minimum interior angle, and $A^{(K)}$ its aspect ratio. Define the element quality\n$$\nq^{(K)} = \\min\\left\\{ J_{s}^{(K)}, \\sin\\!\\big(\\theta_{\\min}^{(K)}\\big), \\frac{1}{A^{(K)}} \\right\\},\n$$\nand the global minimum quality $q_{\\min}(t) = \\min_{K} q^{(K)}(t)$. For the aspect ratio, we have $A^{(K)} \\ge 1$.\n- For piecewise-linear geometric approximation of a smooth curve, the curvature error in element $K$ satisfies the bound\n$$\nE_{\\kappa}^{(K)} \\le \\frac{C_{\\kappa}}{q^{(K)}} h_{K} \\left\\| \\nabla_{s} \\kappa \\right\\|,\n$$\nwhere $C_{\\kappa}  0$ is a shape-regularity constant, $h_{K}$ is a characteristic edge length of $K$, $\\kappa$ is the curvature of the interface, and $\\nabla_{s}$ denotes the surface (curve) gradient along arclength. Assume the global bound $E_{\\kappa}^{\\max}(t) \\le \\frac{C_{\\kappa}}{q_{\\min}(t)} h_{\\max}(t) \\left\\| \\nabla_{s} \\kappa \\right\\|_{\\max}(t)$, where $h_{\\max}(t)$ is the maximum edge length and $\\left\\| \\nabla_{s} \\kappa \\right\\|_{\\max}(t)$ is the maximum curvature gradient magnitude on the interface.\n\nTo maintain accuracy, remeshing is required whenever $E_{\\kappa}^{\\max}(t) > \\epsilon_{\\kappa}$ for a prescribed tolerance $\\epsilon_{\\kappa} > 0$. Suppose in this simulation the mesh deformation is such that\n$$\nq_{\\min}(t) = q_{0} - \\gamma t,\n$$\nwith constants $q_{0} \\in (0,1)$ and $\\gamma  0$, while $h_{\\max}(t)$ and $\\left\\| \\nabla_{s} \\kappa \\right\\|_{\\max}(t)$ are approximately constant over the time window of interest. Define the remeshing trigger functional $R(t)$ as $R(t) = q_{\\min}(t) - q_{\\mathrm{thr}}$, where $q_{\\mathrm{thr}}$ is the threshold quality implied by the curvature error tolerance.\n\nFor topology changes, consider a local neck region of initial width $w_{0}$ subjected to lateral etching with constant velocity $v_{\\ell}  0$ from both sidewalls, so that the neck width evolves as\n$$\nw(t) = w_{0} - 2 v_{\\ell} t.\n$$\nA robust topology change (neck break) is performed when $w(t) \\le \\eta\\, h_{\\mathrm{neck}}$, where $h_{\\mathrm{neck}}$ is the local mesh size near the neck and $\\eta \\in [1,2]$ is a user-defined resolution factor chosen to avoid under-resolution of the geometry.\n\nGiven the following parameter values:\n- $C_{\\kappa} = 0.5$,\n- $h_{\\max} = 3 \\times 10^{-9}$ meters,\n- $\\left\\| \\nabla_{s} \\kappa \\right\\|_{\\max} = 2 \\times 10^{16}$ meters$^{-2}$,\n- $\\epsilon_{\\kappa} = 1 \\times 10^{8}$ meters$^{-1}$,\n- $q_{0} = 0.9$,\n- $\\gamma = 2.0 \\times 10^{-2}$ seconds$^{-1}$,\n- $w_{0} = 20 \\times 10^{-9}$ meters,\n- $h_{\\mathrm{neck}} = 2.5 \\times 10^{-9}$ meters,\n- $v_{\\ell} = 0.25 \\times 10^{-9}$ meters per second,\n- $\\eta = 1.5$,\n\nperform the following:\n1. Starting from the curvature error bound and the definition of $q_{\\min}(t)$, derive an explicit expression for the threshold quality $q_{\\mathrm{thr}}$ that guarantees $E_{\\kappa}^{\\max}(t) \\le \\epsilon_{\\kappa}$. Then write $R(t)$ and solve for the remeshing time $t_{\\mathrm{remesh}}$ at which $R(t) = 0$.\n2. Starting from the neck-width evolution and the topology change condition $w(t) \\le \\eta\\, h_{\\mathrm{neck}}$, derive the criterion for the topology-change time $t_{\\mathrm{topo}}$ and evaluate it.\n\nExpress both final times, $t_{\\mathrm{remesh}}$ and $t_{\\mathrm{topo}}$, in seconds. Round your answers to four significant figures.",
            "solution": "The problem presents two independent tasks: first, to determine the time at which adaptive remeshing is triggered due to mesh quality degradation, and second, to determine the time at which a topology change is performed to handle a pinching neck in the geometry. We will address each task sequentially.\n\nPart 1: Calculation of the Remeshing Time, $t_{\\mathrm{remesh}}$\n\nThe first step is to derive the threshold quality, $q_{\\mathrm{thr}}$, from the given curvature error criterion. Remeshing is required when the maximum curvature error, $E_{\\kappa}^{\\max}(t)$, exceeds a specified tolerance, $\\epsilon_{\\kappa}$. The condition is $E_{\\kappa}^{\\max}(t)  \\epsilon_{\\kappa}$.\nThe problem provides the global bound for this error:\n$$\nE_{\\kappa}^{\\max}(t) \\le \\frac{C_{\\kappa}}{q_{\\min}(t)} h_{\\max}(t) \\left\\| \\nabla_{s} \\kappa \\right\\|_{\\max}(t)\n$$\nTo ensure the error tolerance is met, we must enforce $E_{\\kappa}^{\\max}(t) \\le \\epsilon_{\\kappa}$. Combining this with the bound, we require:\n$$\n\\frac{C_{\\kappa}}{q_{\\min}(t)} h_{\\max} \\left\\| \\nabla_{s} \\kappa \\right\\|_{\\max} \\le \\epsilon_{\\kappa}\n$$\nHere, we have used the fact that $h_{\\max}(t)$ and $\\left\\| \\nabla_{s} \\kappa \\right\\|_{\\max}(t)$ are assumed to be constant, so we denote them as $h_{\\max}$ and $\\left\\| \\nabla_{s} \\kappa \\right\\|_{\\max}$.\nTo maintain mesh validity and accuracy, the global minimum quality $q_{\\min}(t)$ must remain above a certain threshold. We can find this threshold, $q_{\\mathrm{thr}}$, by solving the inequality for $q_{\\min}(t)$. Since $q_{\\min}(t)$ is in the denominator and is a positive quantity, we can rearrange the inequality as:\n$$\nq_{\\min}(t) \\ge \\frac{C_{\\kappa} h_{\\max} \\left\\| \\nabla_{s} \\kappa \\right\\|_{\\max}}{\\epsilon_{\\kappa}}\n$$\nThe threshold quality, $q_{\\mathrm{thr}}$, is the minimum value of $q_{\\min}(t)$ that satisfies this condition. Thus, we define $q_{\\mathrm{thr}}$ as the value that makes the inequality an equality:\n$$\nq_{\\mathrm{thr}} = \\frac{C_{\\kappa} h_{\\max} \\left\\| \\nabla_{s} \\kappa \\right\\|_{\\max}}{\\epsilon_{\\kappa}}\n$$\nWe substitute the given parameter values to find the numerical value of $q_{\\mathrm{thr}}$:\n- $C_{\\kappa} = 0.5$\n- $h_{\\max} = 3 \\times 10^{-9} \\text{ m}$\n- $\\left\\| \\nabla_{s} \\kappa \\right\\|_{\\max} = 2 \\times 10^{16} \\text{ m}^{-2}$\n- $\\epsilon_{\\kappa} = 1 \\times 10^{8} \\text{ m}^{-1}$\n\n$$\nq_{\\mathrm{thr}} = \\frac{(0.5) \\cdot (3 \\times 10^{-9}) \\cdot (2 \\times 10^{16})}{1 \\times 10^{8}} = \\frac{3 \\times 10^{7}}{1 \\times 10^{8}} = 0.3\n$$\nThe problem states that remeshing is triggered when $R(t) = 0$, where the functional $R(t)$ is defined as $R(t) = q_{\\min}(t) - q_{\\mathrm{thr}}$. The time for remeshing, $t_{\\mathrm{remesh}}$, is found by solving $q_{\\min}(t_{\\mathrm{remesh}}) = q_{\\mathrm{thr}}$.\nThe evolution of the minimum quality is given by:\n$$\nq_{\\min}(t) = q_{0} - \\gamma t\n$$\nSetting this equal to $q_{\\mathrm{thr}}$ at $t = t_{\\mathrm{remesh}}$:\n$$\nq_{0} - \\gamma t_{\\mathrm{remesh}} = q_{\\mathrm{thr}}\n$$\nSolving for $t_{\\mathrm{remesh}}$:\n$$\n\\gamma t_{\\mathrm{remesh}} = q_{0} - q_{\\mathrm{thr}}\n$$\n$$\nt_{\\mathrm{remesh}} = \\frac{q_{0} - q_{\\mathrm{thr}}}{\\gamma}\n$$\nNow we substitute the remaining numerical values:\n- $q_{0} = 0.9$\n- $\\gamma = 2.0 \\times 10^{-2} \\text{ s}^{-1}$\n- $q_{\\mathrm{thr}} = 0.3$\n\n$$\nt_{\\mathrm{remesh}} = \\frac{0.9 - 0.3}{2.0 \\times 10^{-2}} = \\frac{0.6}{0.02} = 30 \\text{ s}\n$$\n\nPart 2: Calculation of the Topology Change Time, $t_{\\mathrm{topo}}$\n\nThe second task is to find the time $t_{\\mathrm{topo}}$ at which a topology change is triggered. This occurs when the width of a narrowing neck, $w(t)$, becomes smaller than or equal to a critical value determined by the local mesh size $h_{\\mathrm{neck}}$ and a resolution factor $\\eta$. The condition is:\n$$\nw(t) \\le \\eta h_{\\mathrm{neck}}\n$$\nThe time $t_{\\mathrm{topo}}$ is the instant this condition is first met, which corresponds to the equality:\n$$\nw(t_{\\mathrm{topo}}) = \\eta h_{\\mathrm{neck}}\n$$\nThe evolution of the neck width is given by the linear function:\n$$\nw(t) = w_{0} - 2 v_{\\ell} t\n$$\nSubstituting this expression into the trigger condition:\n$$\nw_{0} - 2 v_{\\ell} t_{\\mathrm{topo}} = \\eta h_{\\mathrm{neck}}\n$$\nWe rearrange this equation to solve for $t_{\\mathrm{topo}}$:\n$$\n2 v_{\\ell} t_{\\mathrm{topo}} = w_{0} - \\eta h_{\\mathrm{neck}}\n$$\n$$\nt_{\\mathrm{topo}} = \\frac{w_{0} - \\eta h_{\\mathrm{neck}}}{2 v_{\\ell}}\n$$\nWe are given the following parameter values:\n- $w_{0} = 20 \\times 10^{-9} \\text{ m}$\n- $h_{\\mathrm{neck}} = 2.5 \\times 10^{-9} \\text{ m}$\n- $v_{\\ell} = 0.25 \\times 10^{-9} \\text{ m/s}$\n- $\\eta = 1.5$\n\nFirst, we compute the terms in the numerator and denominator:\nThe critical width is $\\eta h_{\\mathrm{neck}} = (1.5) \\cdot (2.5 \\times 10^{-9}) = 3.75 \\times 10^{-9} \\text{ m}$.\nThe total lateral etch rate is $2 v_{\\ell} = 2 \\cdot (0.25 \\times 10^{-9}) = 0.5 \\times 10^{-9} \\text{ m/s}$.\n\nNow, we substitute these into the expression for $t_{\\mathrm{topo}}$:\n$$\nt_{\\mathrm{topo}} = \\frac{(20 \\times 10^{-9}) - (3.75 \\times 10^{-9})}{0.5 \\times 10^{-9}} = \\frac{16.25 \\times 10^{-9}}{0.5 \\times 10^{-9}} = \\frac{16.25}{0.5} = 32.5 \\text{ s}\n$$\n\nThe problem asks for the answers to be rounded to four significant figures.\n$t_{\\mathrm{remesh}} = 30 \\text{ s}$ becomes $30.00 \\text{ s}$.\n$t_{\\mathrm{topo}} = 32.5 \\text{ s}$ becomes $32.50 \\text{ s}$.\n\nThe required times are $t_{\\mathrm{remesh}} = 30.00$ s and $t_{\\mathrm{topo}} = 32.50$ s.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n30.00  32.50\n\\end{pmatrix}\n}\n$$"
        }
    ]
}