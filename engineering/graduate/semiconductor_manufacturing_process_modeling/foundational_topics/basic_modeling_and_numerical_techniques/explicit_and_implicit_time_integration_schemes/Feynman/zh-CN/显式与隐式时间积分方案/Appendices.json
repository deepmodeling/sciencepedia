{
    "hands_on_practices": [
        {
            "introduction": "我们的实践探索始于分析一种经典的显式方法——前向时间中心空间（FTCS）格式的稳定性。虽然显式方法在概念上很直观且易于实现，但它们的实际应用受到严格的稳定性条件制约。本练习  将引导您通过冯·诺依曼稳定性分析，为一维热传导方程的稳定模拟，定量地确定其允许的最大时间步长，从而揭示计算效率与数值稳定性之间的一个根本性权衡。",
            "id": "2483538",
            "problem": "一个均匀、各向同性、具有恒定热扩散系数的一维固体，其瞬态热传导由能量守恒和 Fourier 定律推导出的瞬态热方程所控制，即 $\\frac{\\partial T}{\\partial t}=\\alpha\\,\\frac{\\partial^{2}T}{\\partial x^{2}}$，其中 $T$ 是温度，$t$ 是时间，$x$ 是沿杆的空间坐标，$\\alpha$ 是热扩散系数。考虑一个间距为 $\\Delta x$ 的均匀网格，并应用前向时间中心空间（FTCS）显式时间积分格式，该格式使用前向 Euler 步长在时间上推进 $T$，并用二阶中心差分近似空间二阶导数。使用 von Neumann（Fourier）稳定性分析，确定最大时间步长 $\\Delta t_{\\max}$，使得该格式对于所有空间 Fourier 模式都达到临界稳定。\n\n使用数据 $\\alpha=1.4\\times 10^{-5}\\,\\mathrm{m^{2}/s}$ 和 $\\Delta x=0.5\\,\\mathrm{mm}$，计算此一维FTCS离散化对应的 $\\Delta t_{\\max}$。将答案四舍五入到四位有效数字，并以秒为单位表示时间。",
            "solution": "问题陈述具有科学依据、提法恰当，并包含了获得唯一解所需的所有信息。因此，该问题被认为是有效的。我们开始求解。\n\n一维瞬态热传导的控制方程如下：\n$$\n\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}\n$$\n其中，$T(x, t)$ 是温度，$x$ 是空间坐标，$t$ 是时间，$\\alpha$ 是热扩散系数。我们要分析此方程的前向时间中心空间（FTCS）离散格式的稳定性。\n\n我们定义一个空间步长为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格。在网格节点 $i$ 和时间层 $n$ 处的温度表示为 $T_i^n \\equiv T(i\\Delta x, n\\Delta t)$。\n\nFTCS格式对偏导数的近似如下：\n时间导数使用一阶前向差分近似：\n$$\n\\frac{\\partial T}{\\partial t} \\bigg|_{i,n} \\approx \\frac{T_i^{n+1} - T_i^n}{\\Delta t}\n$$\n空间二阶导数使用二阶中心差分近似：\n$$\n\\frac{\\partial^2 T}{\\partial x^2} \\bigg|_{i,n} \\approx \\frac{T_{i+1}^n - 2T_i^n + T_{i-1}^n}{(\\Delta x)^2}\n$$\n将这些近似代入控制方程，得到FTCS格式的离散形式：\n$$\n\\frac{T_i^{n+1} - T_i^n}{\\Delta t} = \\alpha \\left( \\frac{T_{i+1}^n - 2T_i^n + T_{i-1}^n}{(\\Delta x)^2} \\right)\n$$\n我们可以重新整理这个方程，以显式求解下一时间步的温度 $T_i^{n+1}$：\n$$\nT_i^{n+1} = T_i^n + \\frac{\\alpha \\Delta t}{(\\Delta x)^2} (T_{i+1}^n - 2T_i^n + T_{i-1}^n)\n$$\n我们定义无量纲 Fourier 数 $Fo$（也称为扩散数）为：\n$$\nFo = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}\n$$\n离散方程简化为：\n$$\nT_i^{n+1} = T_i^n + Fo (T_{i+1}^n - 2T_i^n + T_{i-1}^n) = Fo \\, T_{i+1}^n + (1 - 2Fo)T_i^n + Fo \\, T_{i-1}^n\n$$\n为了确定此数值格式的稳定性，我们进行 von Neumann 稳定性分析。我们考虑解的单个 Fourier 模式的行为。设时间层 $n$ 的温度分布由一个 Fourier 分量表示：\n$$\nT_i^n = \\hat{T}^n(k) e^{I k x_i}\n$$\n其中 $k$ 是波数，$x_i = i\\Delta x$ 是节点 $i$ 的空间位置，$I = \\sqrt{-1}$ 是虚数单位。此模式在时间 $n$ 的振幅是 $\\hat{T}^n(k)$。经过一个时间步长后，该模式将被一个因子 $G(k)$（放大因子）放大：\n$$\nT_i^{n+1} = \\hat{T}^{n+1}(k) e^{I k x_i} = G(k) \\hat{T}^n(k) e^{I k x_i}\n$$\n为使数值格式稳定，对于任何波数 $k$，放大因子的模都不能超过1。稳定性条件是：\n$$\n|G(k)| \\le 1\n$$\n我们将 Fourier 模式的表示代入离散方程中：\n$$\nG(k) \\hat{T}^n(k) e^{I k (i\\Delta x)} = Fo \\, \\hat{T}^n(k) e^{I k ((i+1)\\Delta x)} + (1 - 2Fo) \\hat{T}^n(k) e^{I k (i\\Delta x)} + Fo \\, \\hat{T}^n(k) e^{I k ((i-1)\\Delta x)}\n$$\n两边同除以 $\\hat{T}^n(k) e^{I k (i\\Delta x)}$，得到放大因子 $G(k)$ 的表达式：\n$$\nG(k) = Fo \\, e^{I k \\Delta x} + (1 - 2Fo) + Fo \\, e^{-I k \\Delta x}\n$$\n使用 Euler 恒等式 $e^{I\\theta} + e^{-I\\theta} = 2\\cos(\\theta)$，我们可以简化此表达式：\n$$\nG(k) = 1 - 2Fo + Fo (e^{I k \\Delta x} + e^{-I k \\Delta x}) = 1 - 2Fo + 2Fo \\cos(k \\Delta x)\n$$\n$$\nG(k) = 1 - 2Fo(1 - \\cos(k \\Delta x))\n$$\n使用三角半角恒等式 $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$，我们得到：\n$$\nG(k) = 1 - 4Fo \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n现在我们应用稳定性条件 $|G(k)| \\le 1$。由于 $Fo > 0$，项 $4Fo \\sin^2(k\\Delta x/2)$ 是非负的。因此，$G(k)$ 总是小于或等于 $1$。稳定性因此由下界决定：\n$$\nG(k) \\ge -1\n$$\n$$\n1 - 4Fo \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\ge -1\n$$\n$$\n2 \\ge 4Fo \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n$$\n\\frac{1}{2} \\ge Fo \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n这个不等式必须对所有可能的波数 $k$ 都成立。最严格的条件发生在项 $\\sin^2(k\\Delta x/2)$ 达到其最大值时。$\\sin^2(\\theta)$ 的最大值为 $1$。这对应于网格上可表示的最高频率（振荡最快）的模式，此时 $k \\Delta x = \\pi$。\n因此，稳定性条件变为：\n$$\nFo \\le \\frac{1}{2}\n$$\n在此条件的极限下，即 $Fo = 1/2$ 时，达到临界稳定。最大允许时间步长 $\\Delta t_{\\max}$ 对应于此极限：\n$$\n\\frac{\\alpha \\Delta t_{\\max}}{(\\Delta x)^2} = \\frac{1}{2}\n$$\n求解 $\\Delta t_{\\max}$：\n$$\n\\Delta t_{\\max} = \\frac{(\\Delta x)^2}{2\\alpha}\n$$\n我们已知以下数据：\n$\\alpha = 1.4 \\times 10^{-5} \\, \\mathrm{m^2/s}$\n$\\Delta x = 0.5 \\, \\mathrm{mm} = 0.5 \\times 10^{-3} \\, \\mathrm{m}$\n\n将这些值代入 $\\Delta t_{\\max}$ 的表达式中：\n$$\n(\\Delta x)^2 = (0.5 \\times 10^{-3} \\, \\mathrm{m})^2 = 0.25 \\times 10^{-6} \\, \\mathrm{m^2}\n$$\n$$\n\\Delta t_{\\max} = \\frac{0.25 \\times 10^{-6} \\, \\mathrm{m^2}}{2 \\times (1.4 \\times 10^{-5} \\, \\mathrm{m^2/s})} = \\frac{0.25 \\times 10^{-6}}{2.8 \\times 10^{-5}} \\, \\mathrm{s}\n$$\n$$\n\\Delta t_{\\max} = \\frac{0.25}{2.8} \\times 10^{-1} \\, \\mathrm{s} \\approx 0.0892857 \\times 10^{-1} \\, \\mathrm{s} = 0.00892857 \\, \\mathrm{s}\n$$\n问题要求将答案四舍五入至四位有效数字。\n$$\n\\Delta t_{\\max} \\approx 0.008929 \\, \\mathrm{s}\n$$",
            "answer": "$$\n\\boxed{0.008929}\n$$"
        },
        {
            "introduction": "在了解了显式格式的局限性之后，我们转向其强大的对应方法：隐式方法。例如，后向欧拉格式是无条件稳定的，允许使用远大于显式格式的时间步长，这对于模拟缓慢的物理过程至关重要。这种优势的代价是在每个时间步求解一个方程组。在这个实践问题中 ，您将推导线性扩散问题所对应的方程组结构，构建代表所有网格点上耦合方程的三对角矩阵。",
            "id": "2483544",
            "problem": "一长度为 $L$ 的均匀、各向同性的一维固体平板，其热导率 $k$、密度 $\\rho$ 和比热容 $c_p$ 均为常数，正在经历无内部热源的瞬态热传导。令 $T(x,t)$ 表示温度，并定义热扩散系数 $\\alpha = \\dfrac{k}{\\rho c_p}$。其控制能量平衡方程和傅里叶定律可导出一维瞬态热方程\n$$\n\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}.\n$$\n将空间域 $[0,L]$ 用均匀网格 $x_i = i\\,\\Delta x$（其中 $i=0,1,\\dots,N-1$，$\\Delta x = L/(N-1)$）进行离散化，并将时间离散化为 $t^n = n\\,\\Delta t$（其中 $n=0,1,2,\\dots$）。施加狄利克雷边界条件 $T(0,t) = T_L(t)$ 和 $T(L,t) = T_R(t)$，并假设在所有时间 $t$ 上均已知。对于内部节点 $i=1,2,\\dots,N-2$，使用在时间层 $t^{n+1}$ 上进行计算的全隐式时间上向后、空间上中心的有限差分近似来处理控制方程。\n\n任务：\n- 从能量守恒陈述和傅里叶定律出发，推导由所述时间和空间离散化产生的内部节点的离散有限差分方程。引入无量纲参数 $r = \\dfrac{\\alpha\\,\\Delta t}{\\Delta x^2}$，并将离散方程简化为一种三点格式，其左侧包含 $T_{i-1}^{n+1}$、$T_{i}^{n+1}$ 和 $T_{i+1}^{n+1}$，右侧包含 $T_i^{n}$。\n- 将 $i=1,2,\\dots,N-2$ 的所得方程组装成一个针对内部未知量 $\\mathbf{T}^{n+1}_{\\text{int}} = \\big(T_1^{n+1},\\dots,T_{N-2}^{n+1}\\big)^{\\top}$ 的三对角线性系统 $\\mathbf{A}\\,\\mathbf{T}^{n+1}_{\\text{int}} = \\mathbf{b}$，明确指出 $\\mathbf{A}$ 的次对角线、对角线和超对角线元素以及 $\\mathbf{b}$ 的结构，包括时间 $t^{n+1}$ 的狄利克雷边界值是如何进入第一个和最后一个方程的。\n- 作为最终答案，报告三对角矩阵 $\\mathbf{A}$ 中内部节点的次对角线、对角线和超对角线系数所组成的三元组，按此顺序以 $r$ 表示。以单行矩阵的形式提供此三元组。无需进行数值计算，也无需四舍五入。最终答案中不要包含物理单位。",
            "solution": "所述问题是适定的、科学上合理的，并包含唯一解所需的所有信息。我们直接进行推导。\n\n无内部热源的一维瞬态热传导的控制方程如下：\n$$\n\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}\n$$\n其中 $T(x,t)$ 是温度，$t$ 是时间，$x$ 是空间坐标，$\\alpha$ 是热扩散系数。\n\n根据要求，我们使用全隐式有限差分格式。这意味着空间导数在未来的时间层 $t^{n+1}$ 进行计算，而时间导数使用向后差分进行近似。令 $T_i^n$ 表示节点 $x_i$ 在时间 $t^n$ 的温度。\n\n在 $(x_i, t^{n+1})$ 处的时间导数 $\\frac{\\partial T}{\\partial t}$ 通过一阶向后差分近似为：\n$$\n\\frac{\\partial T}{\\partial t} \\bigg|_{i}^{n+1} \\approx \\frac{T_i^{n+1} - T_i^n}{\\Delta t}\n$$\n\n在 $(x_i, t^{n+1})$ 处的空间导数 $\\frac{\\partial^2 T}{\\partial x^2}$ 通过二阶中心差分近似为：\n$$\n\\frac{\\partial^2 T}{\\partial x^2} \\bigg|_{i}^{n+1} \\approx \\frac{T_{i-1}^{n+1} - 2T_i^{n+1} + T_{i+1}^{n+1}}{(\\Delta x)^2}\n$$\n\n将这些近似值代入控制偏微分方程，我们得到内部节点 $i$ 的有限差分方程：\n$$\n\\frac{T_i^{n+1} - T_i^n}{\\Delta t} = \\alpha \\left( \\frac{T_{i-1}^{n+1} - 2T_i^{n+1} + T_{i+1}^{n+1}}{(\\Delta x)^2} \\right)\n$$\n该方程对 $i = 1, 2, \\dots, N-2$ 成立。\n\n为得到所要求的形式，我们首先将两边同乘以 $\\Delta t$：\n$$\nT_i^{n+1} - T_i^n = \\frac{\\alpha \\Delta t}{(\\Delta x)^2} \\left( T_{i-1}^{n+1} - 2T_i^{n+1} + T_{i+1}^{n+1} \\right)\n$$\n现在我们引入无量纲参数，即网格的傅里叶数 $r = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$。方程变为：\n$$\nT_i^{n+1} - T_i^n = r \\left( T_{i-1}^{n+1} - 2T_i^{n+1} + T_{i+1}^{n+1} \\right)\n$$\n任务要求将此方程整理成新时间层 $n+1$ 的所有项在左侧 (LHS)，当前时间层 $n$ 的项在右侧 (RHS)。\n$$\nT_i^{n+1} - r T_{i-1}^{n+1} + 2r T_i^{n+1} - r T_{i+1}^{n+1} = T_i^n\n$$\n收集时间层 $n+1$ 处未知温度的系数，我们得到三点格式：\n$$\n-r T_{i-1}^{n+1} + (1 + 2r) T_i^{n+1} - r T_{i+1}^{n+1} = T_i^n\n$$\n这就完成了第一个任务。\n\n对于第二个任务，我们为内部未知温度 $\\mathbf{T}^{n+1}_{\\text{int}} = (T_1^{n+1}, T_2^{n+1}, \\dots, T_{N-2}^{n+1})^{\\top}$ 组建线性方程组。共有 $N-2$ 个这样的方程，每个内部节点（从 $i=1$ 到 $i=N-2$）对应一个。\n\n对第一个内部节点 $i=1$：\n$$\n-r T_{0}^{n+1} + (1 + 2r) T_1^{n+1} - r T_2^{n+1} = T_1^n\n$$\n此处，$T_0^{n+1}$ 由 $x=0$ 处的狄利克雷边界条件确定，因此 $T_0^{n+1} = T_L(t^{n+1})$。由于这是一个已知值，我们将其移到右侧：\n$$\n(1 + 2r) T_1^{n+1} - r T_2^{n+1} = T_1^n + r T_L(t^{n+1})\n$$\n\n对于一般的内部节点 $i$，其中 $1  i  N-2$：\n$$\n-r T_{i-1}^{n+1} + (1 + 2r) T_i^{n+1} - r T_{i+1}^{n+1} = T_i^n\n$$\n\n对于最后一个内部节点 $i=N-2$：\n$$\n-r T_{N-3}^{n+1} + (1 + 2r) T_{N-2}^{n+1} - r T_{N-1}^{n+1} = T_{N-2}^n\n$$\n此处，$T_{N-1}^{n+1}$ 由 $x=L$ 处的狄利克雷边界条件确定，因此 $T_{N-1}^{n+1} = T_R(t^{n+1})$。我们将此已知值移到右侧：\n$$\n-r T_{N-3}^{n+1} + (1 + 2r) T_{N-2}^{n+1} = T_{N-2}^n + r T_R(t^{n+1})\n$$\n\n将这 $N-2$ 个方程组装成矩阵形式 $\\mathbf{A} \\mathbf{T}^{n+1}_{\\text{int}} = \\mathbf{b}$：\n- 矩阵 $\\mathbf{A}$ 是一个 $(N-2) \\times (N-2)$ 的三对角矩阵。\n- 向量 $\\mathbf{b}$ 是一个 $(N-2) \\times 1$ 的列向量。\n\n矩阵 $\\mathbf{A}$ 具有以下结构：\n$$\n\\mathbf{A} =\n\\begin{pmatrix}\n1+2r   -r   0   \\cdots   0 \\\\\n-r   1+2r   -r   \\cdots   0 \\\\\n0   -r   1+2r   \\ddots   \\vdots \\\\\n\\vdots   \\ddots   \\ddots   \\ddots   -r \\\\\n0   \\cdots   0   -r   1+2r\n\\end{pmatrix}\n$$\n矩阵 $\\mathbf{A}$ 的任何内部行的元素均源自通用格式：\n- 次对角线元素 ($T_{i-1}^{n+1}$ 的系数)：$-r$\n- 对角线元素 ($T_i^{n+1}$ 的系数)：$1+2r$\n- 超对角线元素 ($T_{i+1}^{n+1}$ 的系数)：$-r$\n\n向量 $\\mathbf{b}$ 的构造如下：\n$$\n\\mathbf{b} =\n\\begin{pmatrix}\nT_1^n + r T_L(t^{n+1}) \\\\\nT_2^n \\\\\n\\vdots \\\\\nT_{N-3}^n \\\\\nT_{N-2}^n + r T_R(t^{n+1})\n\\end{pmatrix}\n$$\n时间 $t^{n+1}$ 的边界条件贡献给右侧向量 $\\mathbf{b}$ 的第一个和最后一个元素。\n\n最后的任务是报告矩阵 $\\mathbf{A}$ 中内部节点的次对角线、对角线和超对角线系数的三元组。这些系数对于矩阵的所有内部行都是恒定的。根据我们的分析，它们是：\n- 次对角线：$-r$\n- 对角线：$1+2r$\n- 超对角线：$-r$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -r  1+2r  -r \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "现实世界中的半导体工艺模型通常是高度非线性的，例如，材料特性（如扩散系数）会依赖于掺杂浓度。将隐式方法应用于此类问题会产生一个非线性代数方程组，通常需要通过牛顿法等迭代方法求解。最后一个练习  将带您进入现代数值求解器的核心，要求您为一个非线性扩散问题推导雅可比矩阵。理解如何构建雅可比矩阵是一项关键技能，因为它是高效使用牛顿-拉夫逊方法求解这些复杂耦合系统的基础。",
            "id": "4125348",
            "problem": "在半导体制造过程中的掺杂剂扩散热预算建模中，一个常用的连续介质描述是非线性扩散方程\n$$\n\\frac{\\partial c}{\\partial t}=\\nabla\\cdot\\big(D(c)\\nabla c\\big),\n$$\n其中 $c$ 是无量纲化的掺杂剂浓度，$D(c)$ 是无量纲化的扩散系数。考虑一个一维域，使用有限体积法在单元宽度为 $h$（无量纲）的均匀网格上进行离散化，单元平均未知量 $\\{c_i\\}$ 位于单元中心。时间积分采用后向欧拉法，从时间层 $n$ 到 $n+1$，时间步长为 $\\Delta t$（无量纲）。在面 $i+\\frac{1}{2}$ 处的面心通量通过梯度的中心差分和扩散系数的算术平均来近似：\n$$\n\\left.\\frac{\\partial c}{\\partial x}\\right|_{i+\\frac{1}{2}} \\approx \\frac{c_{i+1}^{n+1}-c_i^{n+1}}{h},\\qquad D_{i+\\frac{1}{2}}^{n+1} \\approx \\frac{D(c_{i+1}^{n+1})+D(c_i^{n+1})}{2}.\n$$\n假设 $D(c)=1+\\beta c$，其中 $\\beta$ 为一个已知的无量纲参数。对于一个内部控制体积 $i$，离散后向欧拉有限体积残差为\n$$\nR_i(c^{n+1}) \\equiv h\\,\\frac{c_i^{n+1}-c_i^n}{\\Delta t}-\\frac{1}{h}\\left[D_{i+\\frac{1}{2}}^{n+1}\\left(c_{i+1}^{n+1}-c_i^{n+1}\\right)-D_{i-\\frac{1}{2}}^{n+1}\\left(c_i^{n+1}-c_{i-1}^{n+1}\\right)\\right].\n$$\n将时间层 $n+1$ 的雅可比矩阵 $J$ 定义为 $J_{ij}=\\frac{\\partial R_i}{\\partial c_j^{n+1}}$。从质量守恒、散度定理和给定的离散化方法出发，推导三对角雅可比矩阵元 $J_{i,i-1}$、$J_{i,i}$ 和 $J_{i,i+1}$ 的显式解析公式，并清楚地分离出由 $D(c)$ 的微分和由离散梯度的微分所产生的贡献。然后，作为你最终报告的结果，仅用 $h$、$\\Delta t$、$\\beta$ 以及未知数 $c_{i-1}^{n+1}$、$c_i^{n+1}$、$c_{i+1}^{n+1}$ 给出对角元 $J_{i,i}$ 的闭式表达式。将最终答案表示为单个解析表达式。不包括单位。无需进行数值舍入。",
            "solution": "首先对问题进行验证，以确保其具有科学依据、适定且客观。\n\n### 步骤1：提取已知条件\n-   **控制方程**：非线性扩散方程为 $\\frac{\\partial c}{\\partial t}=\\nabla\\cdot\\big(D(c)\\nabla c\\big)$。\n-   **离散化**：使用有限体积法在一维域上进行离散化，网格为均匀网格，单元宽度为 $h$。\n-   **时间积分**：后向欧拉法，时间步长为 $\\Delta t$。\n-   **未知数**：时间层 $n+1$ 处的单元平均浓度，记为 $\\{c_i^{n+1}\\}$。\n-   **通量近似**：在面 $i+\\frac{1}{2}$ 处，梯度和扩散系数近似为：\n    $$\n    \\left.\\frac{\\partial c}{\\partial x}\\right|_{i+\\frac{1}{2}} \\approx \\frac{c_{i+1}^{n+1}-c_i^{n+1}}{h}\n    $$\n    $$\n    D_{i+\\frac{1}{2}}^{n+1} \\approx \\frac{D(c_{i+1}^{n+1})+D(c_i^{n+1})}{2}\n    $$\n-   **扩散系数模型**：无量纲化的扩散系数由 $D(c)=1+\\beta c$ 给出。\n-   **残差定义**：对于内部控制体积 $i$，离散残差为：\n    $$\n    R_i(c^{n+1}) \\equiv h\\,\\frac{c_i^{n+1}-c_i^n}{\\Delta t}-\\frac{1}{h}\\left[D_{i+\\frac{1}{2}}^{n+1}\\left(c_{i+1}^{n+1}-c_i^{n+1}\\right)-D_{i-\\frac{1}{2}}^{n+1}\\left(c_i^{n+1}-c_{i-1}^{n+1}\\right)\\right]\n    $$\n-   **雅可比矩阵定义**：雅可比矩阵元定义为 $J_{ij}=\\frac{\\partial R_i}{\\partial c_j^{n+1}}$。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题是偏微分方程数值方法中的一个标准练习，具体涉及推导一个非线性系统的雅可比矩阵，该系统由隐式时间积分格式（后向欧拉法）应用于非线性扩散方程的有限体积离散化而产生。这是计算物理和工程领域的一项常见任务，尤其是在半导体工艺模拟（TCAD）中。给定的方程和定义是标准的、数学上一致的，并且没有物理或逻辑上的缺陷。问题是适定的、自洽的，并要求一个具体的、可推导的解析结果。\n\n### 步骤3：结论与行动\n问题是**有效的**。将推导解答。\n\n### 雅可比矩阵元的推导\n任务是计算当 $j \\in \\{i-1, i, i+1\\}$ 时的偏导数 $J_{ij}=\\frac{\\partial R_i}{\\partial c_j^{n+1}}$。为简化推导过程中的符号，我们将 $c_k^{n+1}$ 记为 $c_k$。项 $c_i^n$ 相对于微分变量是一个常数。\n\n内部单元 $i$ 的残差 $R_i$ 仅依赖于 $c_{i-1}$、$c_i$ 和 $c_{i+1}$。因此，雅可比矩阵 $J$ 是三对角的。残差中的相关项是单元面上的数值通量 $F_{i \\pm \\frac{1}{2}}$，其中 $F_{i+\\frac{1}{2}} = D_{i+\\frac{1}{2}}(c_{i+1}-c_i)$。残差可以写为：\n$$\nR_i = h\\,\\frac{c_i-c_i^n}{\\Delta t} - \\frac{1}{h} \\left( F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}} \\right)\n$$\n扩散系数的具体形式为 $D(c) = 1 + \\beta c$。面扩散系数为：\n$$\nD_{i+\\frac{1}{2}} = \\frac{D(c_{i+1})+D(c_i)}{2} = \\frac{(1+\\beta c_{i+1})+(1+\\beta c_i)}{2} = 1 + \\frac{\\beta}{2}(c_{i+1}+c_i)\n$$\n$$\nD_{i-\\frac{1}{2}} = \\frac{D(c_i)+D(c_{i-1})}{2} = \\frac{(1+\\beta c_i)+(1+\\beta c_{i-1})}{2} = 1 + \\frac{\\beta}{2}(c_i+c_{i-1})\n$$\n\n现在我们可以通过应用微分的乘法法则来计算雅可比矩阵元。\n\n**非对角元 $J_{i,i-1}$：**\n$J_{i,i-1} = \\frac{\\partial R_i}{\\partial c_{i-1}} = \\frac{\\partial}{\\partial c_{i-1}} \\left( \\frac{1}{h} F_{i-\\frac{1}{2}} \\right) = \\frac{1}{h} \\frac{\\partial}{\\partial c_{i-1}} \\left[ D_{i-\\frac{1}{2}} (c_i - c_{i-1}) \\right]$\n使用乘法法则：\n$$\nJ_{i,i-1} = \\frac{1}{h} \\left[ \\frac{\\partial D_{i-\\frac{1}{2}}}{\\partial c_{i-1}} (c_i - c_{i-1}) + D_{i-\\frac{1}{2}} \\frac{\\partial (c_i - c_{i-1})}{\\partial c_{i-1}} \\right]\n$$\n方括号内的第一项是微分扩散系数 $D$ 的贡献，第二项是微分离散梯度 $\\nabla c$ 的贡献。\n所需的导数为 $\\frac{\\partial D_{i-\\frac{1}{2}}}{\\partial c_{i-1}} = \\frac{\\beta}{2}$ 和 $\\frac{\\partial (c_i - c_{i-1})}{\\partial c_{i-1}} = -1$。\n代入这些可得：\n$$\nJ_{i,i-1} = \\frac{1}{h} \\left[ \\frac{\\beta}{2}(c_i-c_{i-1}) + D_{i-\\frac{1}{2}}(-1) \\right] = \\frac{1}{h} \\left[ \\frac{\\beta}{2}(c_i-c_{i-1}) - \\left(1 + \\frac{\\beta}{2}(c_i+c_{i-1})\\right) \\right]\n$$\n$$\nJ_{i,i-1} = \\frac{1}{h} \\left[ \\frac{\\beta}{2}c_i - \\frac{\\beta}{2}c_{i-1} - 1 - \\frac{\\beta}{2}c_i - \\frac{\\beta}{2}c_{i-1} \\right] = \\frac{1}{h} \\left[ -1 - \\beta c_{i-1} \\right] = -\\frac{1}{h}(1+\\beta c_{i-1})\n$$\n注意到 $D(c_{i-1}) = 1+\\beta c_{i-1}$，我们有 $J_{i,i-1} = -\\frac{D(c_{i-1})}{h}$。\n\n**非对角元 $J_{i,i+1}$：**\n$J_{i,i+1} = \\frac{\\partial R_i}{\\partial c_{i+1}} = \\frac{\\partial}{\\partial c_{i+1}} \\left( -\\frac{1}{h} F_{i+\\frac{1}{2}} \\right) = -\\frac{1}{h} \\frac{\\partial}{\\partial c_{i+1}} \\left[ D_{i+\\frac{1}{2}} (c_{i+1} - c_i) \\right]$\n使用乘法法则：\n$$\nJ_{i,i+1} = -\\frac{1}{h} \\left[ \\frac{\\partial D_{i+\\frac{1}{2}}}{\\partial c_{i+1}} (c_{i+1} - c_i) + D_{i+\\frac{1}{2}} \\frac{\\partial (c_{i+1} - c_i)}{\\partial c_{i+1}} \\right]\n$$\n所需的导数为 $\\frac{\\partial D_{i+\\frac{1}{2}}}{\\partial c_{i+1}} = \\frac{\\beta}{2}$ 和 $\\frac{\\partial (c_{i+1} - c_i)}{\\partial c_{i+1}} = 1$。\n代入这些可得：\n$$\nJ_{i,i+1} = -\\frac{1}{h} \\left[ \\frac{\\beta}{2}(c_{i+1}-c_i) + D_{i+\\frac{1}{2}}(1) \\right] = -\\frac{1}{h} \\left[ \\frac{\\beta}{2}(c_{i+1}-c_i) + \\left(1 + \\frac{\\beta}{2}(c_{i+1}+c_i)\\right) \\right]\n$$\n$$\nJ_{i,i+1} = -\\frac{1}{h} \\left[ \\frac{\\beta}{2}c_{i+1} - \\frac{\\beta}{2}c_i + 1 + \\frac{\\beta}{2}c_{i+1} + \\frac{\\beta}{2}c_i \\right] = -\\frac{1}{h} \\left[ 1 + \\beta c_{i+1} \\right] = -\\frac{1}{h}(1+\\beta c_{i+1})\n$$\n注意到 $D(c_{i+1}) = 1+\\beta c_{i+1}$，我们有 $J_{i,i+1} = -\\frac{D(c_{i+1})}{h}$。\n\n**对角元 $J_{i,i}$：**\n这一项有来自时间导数和两个相邻通量的贡献。\n$$\nJ_{i,i} = \\frac{\\partial R_i}{\\partial c_i} = \\frac{\\partial}{\\partial c_i} \\left( h\\,\\frac{c_i-c_i^n}{\\Delta t} \\right) - \\frac{1}{h}\\frac{\\partial F_{i+\\frac{1}{2}}}{\\partial c_i} + \\frac{1}{h}\\frac{\\partial F_{i-\\frac{1}{2}}}{\\partial c_i}\n$$\n第一项就是 $\\frac{h}{\\Delta t}$。对于通量项，我们再次使用乘法法则。\n$$\n\\frac{\\partial F_{i+\\frac{1}{2}}}{\\partial c_i} = \\frac{\\partial D_{i+\\frac{1}{2}}}{\\partial c_i}(c_{i+1}-c_i) + D_{i+\\frac{1}{2}}\\frac{\\partial(c_{i+1}-c_i)}{\\partial c_i} = \\frac{\\beta}{2}(c_{i+1}-c_i) + D_{i+\\frac{1}{2}}(-1) = -1 - \\beta c_i\n$$\n$$\n\\frac{\\partial F_{i-\\frac{1}{2}}}{\\partial c_i} = \\frac{\\partial D_{i-\\frac{1}{2}}}{\\partial c_i}(c_i-c_{i-1}) + D_{i-\\frac{1}{2}}\\frac{\\partial(c_i-c_{i-1})}{\\partial c_i} = \\frac{\\beta}{2}(c_i-c_{i-1}) + D_{i-\\frac{1}{2}}(1) = 1 + \\beta c_i\n$$\n结合这些结果：\n$$\nJ_{i,i} = \\frac{h}{\\Delta t} - \\frac{1}{h}(-1-\\beta c_i) + \\frac{1}{h}(1+\\beta c_i) = \\frac{h}{\\Delta t} + \\frac{1}{h}(1+\\beta c_i) + \\frac{1}{h}(1+\\beta c_i)\n$$\n$$\nJ_{i,i} = \\frac{h}{\\Delta t} + \\frac{2}{h}(1+\\beta c_i)\n$$\n为按要求显式分离贡献：\n来自微分梯度项（包括时间导数）的贡献是：\n$$\nJ_{i,i}^{(\\nabla c)} = \\frac{h}{\\Delta t} - \\frac{1}{h}\\left( D_{i+\\frac{1}{2}}(-1) \\right) + \\frac{1}{h}\\left( D_{i-\\frac{1}{2}}(1) \\right) = \\frac{h}{\\Delta t} + \\frac{1}{h}\\left(D_{i+\\frac{1}{2}} + D_{i-\\frac{1}{2}}\\right)\n$$\n来自微分扩散系数 $D(c)$ 的贡献是：\n$$\nJ_{i,i}^{(D)} = -\\frac{1}{h}\\left( \\frac{\\partial D_{i+\\frac{1}{2}}}{\\partial c_i}(c_{i+1}-c_i) \\right) + \\frac{1}{h}\\left( \\frac{\\partial D_{i-\\frac{1}{2}}}{\\partial c_i}(c_i-c_{i-1}) \\right)\n$$\n$$\nJ_{i,i}^{(D)} = -\\frac{1}{h}\\left( \\frac{\\beta}{2}(c_{i+1}-c_i) \\right) + \\frac{1}{h}\\left( \\frac{\\beta}{2}(c_i-c_{i-1}) \\right) = \\frac{\\beta}{2h}(-c_{i+1}+2c_i-c_{i-1})\n$$\n将贡献求和：\n$$\nJ_{i,i} = J_{i,i}^{(\\nabla c)} + J_{i,i}^{(D)} = \\frac{h}{\\Delta t} + \\frac{1}{h}\\left(D_{i+\\frac{1}{2}} + D_{i-\\frac{1}{2}}\\right) + \\frac{\\beta}{2h}(-c_{i+1}+2c_i-c_{i-1})\n$$\n代入 $D_{i \\pm \\frac{1}{2}}$ 的表达式：\n$$\nJ_{i,i} = \\frac{h}{\\Delta t} + \\frac{1}{h}\\left(1 + \\frac{\\beta}{2}(c_{i+1}+c_i) + 1 + \\frac{\\beta}{2}(c_i+c_{i-1})\\right) + \\frac{\\beta}{2h}(-c_{i+1}+2c_i-c_{i-1})\n$$\n$$\nJ_{i,i} = \\frac{h}{\\Delta t} + \\frac{2}{h} + \\frac{\\beta}{2h}(c_{i+1}+2c_i+c_{i-1}) + \\frac{\\beta}{2h}(-c_{i+1}+2c_i-c_{i-1})\n$$\n$$\nJ_{i,i} = \\frac{h}{\\Delta t} + \\frac{2}{h} + \\frac{\\beta}{2h}(c_{i+1}+2c_i+c_{i-1}-c_{i+1}+2c_i-c_{i-1}) = \\frac{h}{\\Delta t} + \\frac{2}{h} + \\frac{\\beta}{2h}(4c_i)\n$$\n$$\nJ_{i,i} = \\frac{h}{\\Delta t} + \\frac{2}{h}(1+\\beta c_i)\n$$\n这证实了直接计算的结果。恢复时间层 $n+1$ 的上标，最终表达式为：\n$$\nJ_{i,i} = \\frac{h}{\\Delta t} + \\frac{2}{h}(1+\\beta c_i^{n+1})\n$$\n此表达式仅依赖于 $h$、$\\Delta t$、$\\beta$ 和未知数 $c_i^{n+1}$，符合要求。",
            "answer": "$$\n\\boxed{\\frac{h}{\\Delta t} + \\frac{2}{h}\\left(1+\\beta c_i^{n+1}\\right)}\n$$"
        }
    ]
}