{
    "hands_on_practices": [
        {
            "introduction": "在半导体制造中，我们经常使用基于物理和化学原理的确定性模型，例如用常微分方程来描述刻蚀速率。然而，实际测量总是伴随着随机噪声。这个练习将引导你应用非线性最小二乘法，从含有噪声的数据中估计一个确定性模型的关键参数，并推导出该估计值的不确定性（方差），这对于量化模型参数的置信度至关重要。",
            "id": "4119772",
            "problem": "在半导体制造工艺的湿法蚀刻步骤中，一种反应性蚀刻剂物质的浓度由常微分方程 (ODE) $\\dot{c}(t) = -k\\,c(t)$ 进行确定性描述，其中 $k$ 是（未知的）反应速率常数，$c(t)$ 是时刻 $t$ 的蚀刻剂浓度。在给定精确已知的初始浓度 $c(0) = c_0$ 的情况下，该确定性模型的解为 $c(t) = c_0 \\exp(-k t)$。\n\n您在已知时间点 $\\{t_i\\}_{i=1}^{N}$ 收集了 $N$ 个浓度的标量测量值，建模为 $y_i = c(t_i) + \\varepsilon_i$，其中测量噪声 $\\varepsilon_i$ 是随机的、独立同分布的，服从 $\\varepsilon_i \\sim \\mathcal{N}(0,\\sigma^2)$，且 $\\sigma^2$ 已知。将该常微分方程视为确定性过程模型，测量噪声视为唯一的随机性来源。\n\n任务：\n- 基于最小化数据 $\\{y_i\\}$ 与模型 $c_0 \\exp(-k t_i)$ 之间的残差平方和，构建用于求解 $k$ 的确定性非线性最小二乘 (NLS) 估计器 $\\hat{k}$。\n- 在所述噪声模型下，使用关于真实值 $k$ 的一阶局域线性化论证，推导出 $\\hat{k}$ 的渐近方差的闭式解析表达式，该表达式是 $k$、$c_0$、$\\{t_i\\}$ 和 $\\sigma^2$ 的函数。\n\n请提供推导出的 $\\hat{k}$ 的渐近方差的解析表达式作为最终答案，该表达式应使用 $k$、$c_0$、$\\{t_i\\}$ 和 $\\sigma^2$ 表示。最终答案必须是单个闭式表达式。请勿在最终答案框中包含单位。请勿进行四舍五入或近似计算。",
            "solution": "首先对问题进行验证，以确保其具有科学依据、是适定且客观的。\n\n**步骤1：提取已知条件**\n-   确定性过程模型是常微分方程 (ODE)：$\\dot{c}(t) = -k\\,c(t)$。\n-   $k$ 是未知的反应速率常数。\n-   $c(t)$ 是时刻 $t$ 的蚀刻剂浓度。\n-   初始浓度是精确已知的：$c(0) = c_0$。\n-   该常微分方程的解为 $c(t) = c_0 \\exp(-k t)$。\n-   在已知时间点 $\\{t_i\\}_{i=1}^{N}$ 收集了 $N$ 个标量测量值 $\\{y_i\\}_{i=1}^{N}$。\n-   测量模型是 $y_i = c(t_i) + \\varepsilon_i$。\n-   测量噪声项 $\\varepsilon_i$ 是独立同分布 (i.i.d.) 的随机变量，服从均值为 $0$、已知方差为 $\\sigma^2$ 的正态分布，即 $\\varepsilon_i \\sim \\mathcal{N}(0,\\sigma^2)$。\n\n**步骤2：使用提取的已知条件进行验证**\n-   **科学依据：** 该问题描述了一级反应动力学，这是化学和化学工程（包括湿法蚀刻等工艺）中一个基础且广泛使用的模型。使用加性高斯噪声模型进行测量是统计信号处理和参数估计中的一个标准假设。该问题在科学上是合理的。\n-   **适定性：** 问题提供了构建估计器并推导其渐近性质所需的所有信息（模型函数、噪声的统计特性以及已知参数）。任务具体，可推导出唯一的解析表达式。该问题是适定的。\n-   **客观性：** 问题采用精确的数学和技术语言陈述，没有歧义或主观内容。\n\n**步骤3：结论与行动**\n该问题在科学上合理、内容自洽且适定，因此是有效的。将进行求解推导。\n\n**第一部分：非线性最小二乘 (NLS) 估计器的构建**\n在时刻 $t_i$ 的浓度的确定性模型是未知参数 $k$ 的函数，我们将其表示为 $f(t_i; k) = c_0 \\exp(-k t_i)$。\n非线性最小二乘 (NLS) 方法旨在找到使观测测量值 $y_i$ 与模型预测值 $f(t_i; k)$ 之间的平方差（残差）之和最小化的 $k$ 值。残差平方和 $S(k)$ 由下式给出：\n$$S(k) = \\sum_{i=1}^{N} [y_i - f(t_i; k)]^2 = \\sum_{i=1}^{N} [y_i - c_0 \\exp(-k t_i)]^2$$\n$k$ 的 NLS 估计器（记作 $\\hat{k}$）是使该函数最小化的 $k$ 值：\n$$\\hat{k} = \\arg\\min_k S(k) = \\arg\\min_k \\sum_{i=1}^{N} [y_i - c_0 \\exp(-k t_i)]^2$$\n此公式完成了第一个任务。在实践中，为了求得 $\\hat{k}$，需要求解一阶必要条件 $\\frac{dS(k)}{dk} = 0$，这将得到一个关于 $k$ 的非线性方程。\n\n**第二部分：$\\hat{k}$ 的渐近方差推导**\n我们通过对模型在参数的真实未知值（记作 $k_{true}$）附近进行一阶局域线性化来推导 $\\hat{k}$ 的渐近方差。测量模型为 $y_i = f(t_i; k_{true}) + \\varepsilon_i$。\n\n估计器 $\\hat{k}$ 满足一阶条件 $\\frac{dS(k)}{dk}\\bigg|_{k=\\hat{k}} = 0$。\n$$\\frac{dS(k)}{dk} = \\sum_{i=1}^{N} 2[y_i - f(t_i; k)] \\left(-\\frac{\\partial f(t_i; k)}{\\partial k}\\right) = 0$$\n令 $J_i(k) = \\frac{\\partial f(t_i; k)}{\\partial k}$ 为模型函数对第 $i$ 个数据点关于 $k$ 的偏导数。\n$$J_i(k) = \\frac{\\partial}{\\partial k} [c_0 \\exp(-k t_i)] = -c_0 t_i \\exp(-k t_i)$$\n$\\hat{k}$ 需满足的条件变为：\n$$\\sum_{i=1}^{N} [y_i - f(t_i; \\hat{k})] J_i(\\hat{k}) = 0$$\n对于一个基于大量数据点或小噪声的估计器，$\\hat{k}$ 预计会接近 $k_{true}$。因此，我们可以在 $k_{true}$ 附近对模型函数 $f(t_i; \\hat{k})$ 和雅可比项 $J_i(\\hat{k})$ 进行线性化。$f(t_i; \\hat{k})$ 在 $k_{true}$ 附近的一阶泰勒展开为：\n$$f(t_i; \\hat{k}) \\approx f(t_i; k_{true}) + J_i(k_{true}) (\\hat{k} - k_{true})$$\n我们还将一阶条件中的雅可比项近似为 $J_i(\\hat{k}) \\approx J_i(k_{true})$。将这些近似和测量模型 $y_i = f(t_i; k_{true}) + \\varepsilon_i$ 代入关于 $\\hat{k}$ 的条件中：\n$$\\sum_{i=1}^{N} \\left[ (f(t_i; k_{true}) + \\varepsilon_i) - \\left( f(t_i; k_{true}) + J_i(k_{true}) (\\hat{k} - k_{true}) \\right) \\right] J_i(k_{true}) \\approx 0$$\n化简方括号内的项：\n$$\\sum_{i=1}^{N} \\left[ \\varepsilon_i - J_i(k_{true}) (\\hat{k} - k_{true}) \\right] J_i(k_{true}) \\approx 0$$\n展开求和项并重新整理，以求解估计误差 $\\hat{k} - k_{true}$：\n$$\\sum_{i=1}^{N} \\varepsilon_i J_i(k_{true}) \\approx \\sum_{i=1}^{N} J_i(k_{true})^2 (\\hat{k} - k_{true})$$\n$$(\\hat{k} - k_{true}) \\sum_{i=1}^{N} J_i(k_{true})^2 \\approx \\sum_{i=1}^{N} \\varepsilon_i J_i(k_{true})$$\n这就得到了估计误差的近似表达式：\n$$\\hat{k} - k_{true} \\approx \\frac{\\sum_{i=1}^{N} \\varepsilon_i J_i(k_{true})}{\\sum_{i=1}^{N} J_i(k_{true})^2}$$\n$\\hat{k}$ 的渐近方差是该表达式的方差。由于 $k_{true}$ 是一个常数，所以 $\\text{Var}(\\hat{k}) = \\text{Var}(\\hat{k} - k_{true})$。分母 $\\sum_{i=1}^{N} J_i(k_{true})^2$ 相对于随机噪声变量 $\\varepsilon_i$ 是一个常数。\n$$\\text{Var}(\\hat{k}) \\approx \\text{Var}\\left( \\frac{\\sum_{i=1}^{N} \\varepsilon_i J_i(k_{true})}{\\sum_{i=1}^{N} J_i(k_{true})^2} \\right) = \\frac{1}{\\left(\\sum_{i=1}^{N} J_i(k_{true})^2\\right)^2} \\text{Var}\\left(\\sum_{i=1}^{N} \\varepsilon_i J_i(k_{true})\\right)$$\n由于噪声项 $\\varepsilon_i$ 是独立的，和的方差等于各项方差之和：\n$$\\text{Var}\\left(\\sum_{i=1}^{N} \\varepsilon_i J_i(k_{true})\\right) = \\sum_{i=1}^{N} \\text{Var}(\\varepsilon_i J_i(k_{true}))$$\n使用性质 $\\text{Var}(aX) = a^2\\text{Var}(X)$，其中 $J_i(k_{true})$ 是每一项的常数因子：\n$$\\sum_{i=1}^{N} \\text{Var}(\\varepsilon_i J_i(k_{true})) = \\sum_{i=1}^{N} J_i(k_{true})^2 \\text{Var}(\\varepsilon_i)$$\n根据已知条件，对所有 $i$ 都有 $\\text{Var}(\\varepsilon_i) = \\sigma^2$。\n$$\\sum_{i=1}^{N} J_i(k_{true})^2 \\sigma^2 = \\sigma^2 \\sum_{i=1}^{N} J_i(k_{true})^2$$\n将此结果代回 $\\text{Var}(\\hat{k})$ 的表达式中：\n$$\\text{Var}(\\hat{k}) \\approx \\frac{\\sigma^2 \\sum_{i=1}^{N} J_i(k_{true})^2}{\\left(\\sum_{i=1}^{N} J_i(k_{true})^2\\right)^2} = \\frac{\\sigma^2}{\\sum_{i=1}^{N} J_i(k_{true})^2}$$\n最后，我们代入 $J_i(k) = -c_0 t_i \\exp(-k t_i)$ 的表达式，并按照最终表达式的要求，将真值 $k_{true}$ 简单地表示为 $k$。\n$$J_i(k)^2 = (-c_0 t_i \\exp(-k t_i))^2 = c_0^2 t_i^2 \\exp(-2 k t_i)$$\n因此，估计器 $\\hat{k}$ 的渐近方差为：\n$$\\text{Var}(\\hat{k}) \\approx \\frac{\\sigma^2}{\\sum_{i=1}^{N} c_0^2 t_i^2 \\exp(-2 k t_i)}$$\n这就是所要求的、作为 $k$、$c_0$、$\\{t_i\\}$ 和 $\\sigma^2$ 函数的渐近方差的闭式解析表达式。",
            "answer": "$$\\boxed{\\frac{\\sigma^2}{\\sum_{i=1}^{N} c_0^2 t_i^2 \\exp(-2 k t_i)}}$$"
        },
        {
            "introduction": "评估工艺成品率时，对缺陷严重性的建模方式会显著影响风险评估的结果。本练习通过一个光刻缺陷的例子，让你直接比较两种建模策略：一种是简化的确定性模型，假设每个缺陷的影响是固定的；另一种是更真实的随机模型，假设缺陷的影响本身是一个随机变量。通过计算两种模型下超出容差范围的概率，你将亲身体会到，增加模型的随机性描述如何深化我们对工艺风险的理解。",
            "id": "4119747",
            "problem": "在半导体生产线中，一个关键光刻层对每个晶圆上一个面积为 $A$ 的芯片级区域内的颗粒缺陷敏感。设缺陷密度为 $d$ (缺陷数/平方厘米)，并假设每个芯片区域内出现的缺陷数量 $N$ 可建模为一个均值为 $\\lambda = dA$ 的泊松随机变量。考虑两种对缺陷严重性进行建模的方法：\n\n- 确定性严重性模型：每个缺陷恰好产生 $1$ 个影响单位，因此累积影响为 $I_{\\mathrm{det}} = N$。\n- 随机性严重性模型：每个缺陷产生一个随机的影响大小 $X_i$，这些影响大小在缺陷之间是独立同分布的，其中 $X_i$ 服从速率为 $\\beta$ (单位为影响单位的倒数) 的指数分布。累积影响为 $S = \\sum_{i=1}^{N} X_i$，其中当 $N=0$ 时，该和为 $0$。\n\n假设 $d = 0.6$ 缺陷/平方厘米，$A = 2$ 平方厘米，因此 $\\lambda = dA = 1.2$。累积影响的容忍阈值为 $T = 2.5$ 影响单位，指数分布的速率为 $\\beta = 2$ 影响单位的倒数。\n\n仅从 $N$ 的泊松分布、$X_i$ 的指数分布以及全概率公式的定义出发，计算以下量值：\n\n1. 在确定性严重性模型下，累积影响超过容忍阈值的概率，即 $\\mathbb{P}(I_{\\mathrm{det}} > T)$。\n2. 在随机性严重性模型下，累积影响超过容忍阈值的概率，即 $\\mathbb{P}(S > T)$。\n\n以小数形式报告这两个概率。将您的答案四舍五入到四位有效数字。",
            "solution": "问题要求在两种不同的建模假设（确定性模型和随机性模型）下，计算累积影响分数超过容忍阈值的概率。给定以下参数：\n- 缺陷密度, $d = 0.6 \\, \\text{缺陷/cm}^2$。\n- 芯片级区域面积, $A = 2 \\, \\text{cm}^2$。\n- 缺陷数量 $N$ 服从均值为 $\\lambda = dA = (0.6)(2) = 1.2$ 的泊松分布。其概率质量函数 (PMF) 为 $\\mathbb{P}(N=k) = \\frac{\\lambda^k e^{-\\lambda}}{k!} = \\frac{(1.2)^k e^{-1.2}}{k!}$，其中 $k \\in \\{0, 1, 2, ...\\}$。\n- 累积影响的容忍阈值为 $T = 2.5$ 影响单位。\n- 在随机模型中，单个缺陷的影响大小 $X_i$ 服从速率为 $\\beta = 2$ （影响单位的倒数）的指数分布。其概率密度函数 (PDF) 为 $f_X(x) = \\beta e^{-\\beta x} = 2e^{-2x}$，其中 $x \\ge 0$。\n\n我们将分别处理问题的每个部分。\n\n**1. 确定性严重性模型**\n\n在此模型中，累积影响 $I_{\\mathrm{det}}$ 等于缺陷数量 $N$。\n$$I_{\\mathrm{det}} = N$$\n我们希望计算该影响超过容忍阈值 $T$ 的概率。\n$$\\mathbb{P}(I_{\\mathrm{det}} > T) = \\mathbb{P}(N > 2.5)$$\n由于缺陷数量 $N$ 必须是整数，条件 $N > 2.5$ 等价于 $N \\ge 3$。我们可以通过计算其补集 $\\mathbb{P}(N  3)$ 来计算这个概率。\n$$\\mathbb{P}(N \\ge 3) = 1 - \\mathbb{P}(N  3) = 1 - \\left[ \\mathbb{P}(N=0) + \\mathbb{P}(N=1) + \\mathbb{P}(N=2) \\right]$$\n使用 $\\lambda = 1.2$ 的泊松分布的概率质量函数 (PMF)：\n$$\\mathbb{P}(N=0) = \\frac{(1.2)^0 e^{-1.2}}{0!} = e^{-1.2}$$\n$$\\mathbb{P}(N=1) = \\frac{(1.2)^1 e^{-1.2}}{1!} = 1.2 e^{-1.2}$$\n$$\\mathbb{P}(N=2) = \\frac{(1.2)^2 e^{-1.2}}{2!} = \\frac{1.44}{2} e^{-1.2} = 0.72 e^{-1.2}$$\n将这些概率相加：\n$$\\mathbb{P}(N  3) = e^{-1.2} + 1.2 e^{-1.2} + 0.72 e^{-1.2} = (1 + 1.2 + 0.72)e^{-1.2} = 2.92 e^{-1.2}$$\n现在，我们计算最终的概率：\n$$\\mathbb{P}(I_{\\mathrm{det}} > T) = 1 - 2.92 e^{-1.2}$$\n使用值 $e^{-1.2} \\approx 0.3011942$，我们得到：\n$$\\mathbb{P}(I_{\\mathrm{det}} > T) \\approx 1 - 2.92 \\times 0.3011942 = 1 - 0.8794869 = 0.1205131$$\n四舍五入到四位有效数字，概率为 $0.1205$。\n\n**2. 随机性严重性模型**\n\n在此模型中，累积影响 $S$ 是每个缺陷产生的随机影响之和。\n$$S = \\sum_{i=1}^{N} X_i$$\n这里，$N \\sim \\text{Poisson}(\\lambda=1.2)$ 且 $X_i \\sim \\text{Exponential}(\\beta=2)$ 是独立同分布的 (i.i.d.)。如果 $N=0$，则和定义为 $0$。这是一个复合泊松随机变量。\n\n为了计算 $\\mathbb{P}(S > T)$，我们使用全概率公式，以缺陷数量 $N$ 为条件。\n$$\\mathbb{P}(S > T) = \\sum_{n=0}^{\\infty} \\mathbb{P}(S > T | N=n) \\mathbb{P}(N=n)$$\n我们来分析条件概率项 $\\mathbb{P}(S > T | N=n)$。\n- 如果 $n=0$，则没有缺陷，所以 $S=0$。概率 $\\mathbb{P}(S > T | N=0) = \\mathbb{P}(0 > 2.5)$ 为 $0$。\n- 如果 $n \\ge 1$，$S$ 是 $n$ 个独立同分布的指数随机变量之和，$S_n = \\sum_{i=1}^{n} X_i$。$n$ 个速率为 $\\beta$ 的独立同分布的指数随机变量之和服从形状参数为 $n$、速率参数为 $\\beta$ 的伽马分布。因此，$S_n \\sim \\text{Gamma}(n, \\beta)$。\n\n因此，求和从 $n=1$ 开始：\n$$\\mathbb{P}(S > T) = \\sum_{n=1}^{\\infty} \\mathbb{P}(\\text{Gamma}(n, \\beta) > T) \\mathbb{P}(N=n)$$\n形状参数 $n$ 为整数的伽马分布的生存函数可以表示为与泊松累积分布函数 (CDF) 相关的有限和：\n$$\\mathbb{P}(\\text{Gamma}(n, \\beta) > T) = \\sum_{j=0}^{n-1} \\frac{(\\beta T)^j e^{-\\beta T}}{j!}$$\n在我们的例子中，$\\beta = 2$ 且 $T = 2.5$，所以 $\\beta T = 5$。泊松分量的概率为 $\\mathbb{P}(N=n) = \\frac{\\lambda^n e^{-\\lambda}}{n!}$，其中 $\\lambda=1.2$。\n\n将这些表达式代入求和中：\n$$\\mathbb{P}(S > T) = \\sum_{n=1}^{\\infty} \\left( \\sum_{j=0}^{n-1} \\frac{5^j e^{-5}}{j!} \\right) \\left( \\frac{(1.2)^n e^{-1.2}}{n!} \\right)$$\n这个无穷级数没有简单的封闭形式表达式，必须进行数值计算。我们计算级数的各项并将它们相加，直到后续项的贡献变得可以忽略不计。\n级数的第 $n$ 项 $a_n$ 为：\n$$a_n = \\mathbb{P}(N=n) \\times \\mathbb{P}(\\text{Gamma}(n, 2) > 2.5)$$\n和为 $\\mathbb{P}(S > T) = \\sum_{n=1}^{\\infty} a_n$。\n计算前几项：\n对于 $n=1$: $a_1 = \\mathbb{P}(N=1) \\times \\mathbb{P}(\\text{Exp}(2)>2.5) = (1.2 e^{-1.2})(e^{-5}) \\approx 0.00243540$\n对于 $n=2$: $a_2 = \\mathbb{P}(N=2) \\times \\mathbb{P}(\\text{Gamma}(2,2)>2.5) = (\\frac{1.2^2}{2}e^{-1.2})(e^{-5}(1+5)) \\approx 0.00876798$\n对于 $n=3$: $a_3 = \\mathbb{P}(N=3) \\times \\mathbb{P}(\\text{Gamma}(3,2)>2.5) = (\\frac{1.2^3}{6}e^{-1.2})(e^{-5}(1+5+\\frac{5^2}{2})) \\approx 0.01081146$\n对于 $n=4$: $a_4 = \\mathbb{P}(N=4) \\times \\mathbb{P}(\\text{Gamma}(4,2)>2.5) \\approx 0.00689688$\n对于 $n=5$: $a_5 = \\mathbb{P}(N=5) \\times \\mathbb{P}(\\text{Gamma}(5,2)>2.5) \\approx 0.00274936$\n继续这个过程并将各项相加，得到：\n$$\\mathbb{P}(S > T) \\approx 0.03262552$$\n四舍五入到四位有效数字，概率为 $0.03263$。\n\n随机模型考虑了缺陷严重性的可变性，与确定性模型（$12.05\\%$）相比，它预测的超过容忍阈值的概率（$3.26\\%$）要低得多。这凸显了为风险评估选择合适模型的重要性。",
            "answer": "$$\\boxed{\\begin{pmatrix} 0.1205  0.03263 \\end{pmatrix}}$$"
        },
        {
            "introduction": "实时过程监控是实现先进过程控制的关键，而状态估计器是其核心。本练习将让你对比两种经典的状态估计算法：一种是基于确定性系统理论设计的龙伯格观测器（Luenberger observer），其目标是稳定误差动态；另一种是明确考虑了过程和测量噪声的随机最优估计器——卡尔曼滤波器（Kalman filter）。通过推导并比较它们在稳态下的估计误差方差，你将定量地理解，为何在存在随机干扰时，基于随机模型的设计能够获得更优的性能。",
            "id": "4119816",
            "problem": "对单晶片等离子体刻蚀步骤进行实时监控，以估计瞬时刻蚀速率。设真实刻蚀速率在离散时间下建模为一个缓慢变化的标量状态，采样周期为 $T_{s}$，服从随机游走模型\n$$\nx_{k+1} = x_{k} + w_{k}, \\quad y_{k} = x_{k} + v_{k},\n$$\n其中，$x_{k}$ 是在采样点 $k$ 时的刻蚀速率，$y_{k}$ 是一次原位计量测量值，$w_{k} \\sim \\mathcal{N}(0,Q)$ 是零均值独立过程噪声，用于为未建模的扰动和漂移建模，而 $v_{k} \\sim \\mathcal{N}(0,R)$ 是零均值独立测量噪声。假设 $\\{w_{k}\\}$ 和 $\\{v_{k}\\}$ 相互独立，在时间上独立，且与初始条件 $x_{0}$ 独立。采样周期为 $T_{s} = 1\\,\\mathrm{min}$，方差分别为 $Q = (0.5\\,\\mathrm{nm/min})^{2}$ 和 $R = (2.0\\,\\mathrm{nm/min})^{2}$。\n\n为 $x_{k}$ 设计了两种估计器：\n- 一个确定性 Luenberger 观测器 (LO)，它不显式地对噪声建模，其更新方式为\n$$\n\\hat{x}_{k+1} = \\hat{x}_{k} + L\\left(y_{k} - \\hat{x}_{k}\\right),\n$$\n其中观测器增益 $L$ 的选择是为了配置无噪声误差动态的极点，以匹配一个期望的离散时间极点 $p_{d} = \\exp\\!\\left(-T_{s}/\\tau_{d}\\right)$，设计时间常数为 $\\tau_{d} = 2\\,\\mathrm{min}$。\n- 一个在给定 $(Q,R)$ 条件下设计的随机 Kalman 滤波器 (KF)。\n\n使用线性状态估计和协方差传播的基本原理，推导在真实含噪动态下 LO 的稳态估计误差方差，以及 KF 的稳态误差方差。然后，计算这些稳态方差的比值，\n$$\n\\rho \\equiv \\frac{P_{\\mathrm{LO}}}{P_{\\mathrm{KF}}},\n$$\n作为一个无量纲数。将您计算的 $\\rho$ 的最终答案四舍五入至四位有效数字。",
            "solution": "我们从离散时间状态空间模型开始\n$$\nx_{k+1} = x_{k} + w_{k}, \\quad y_{k} = x_{k} + v_{k},\n$$\n其中 $w_{k}\\sim \\mathcal{N}(0,Q)$，$v_{k}\\sim \\mathcal{N}(0,R)$，相互独立且在时间上独立。采样周期为 $T_{s} = 1\\,\\mathrm{min}$，过程噪声方差为 $Q = (0.5\\,\\mathrm{nm/min})^{2} = 0.25\\,(\\mathrm{nm/min})^{2}$，测量噪声方差为 $R = (2.0\\,\\mathrm{nm/min})^{2} = 4.0\\,(\\mathrm{nm/min})^{2}$。\n\n确定性 Luenberger 观测器 (LO)。其更新方式为\n$$\n\\hat{x}_{k+1} = \\hat{x}_{k} + L\\left(y_{k} - \\hat{x}_{k}\\right).\n$$\n定义估计误差 $e_{k} \\equiv x_{k} - \\hat{x}_{k}$。根据真实动态和观测器可得\n$$\ne_{k+1} = x_{k+1} - \\hat{x}_{k+1} = (x_{k} + w_{k}) - \\left[\\hat{x}_{k} + L\\left(y_{k} - \\hat{x}_{k}\\right)\\right]\n= (1 - L)(x_{k} - \\hat{x}_{k}) + w_{k} - L v_{k} = (1 - L)e_{k} + w_{k} - L v_{k}.\n$$\n假设 $\\{e_{k}\\}$、$\\{w_{k}\\}$ 和 $\\{v_{k}\\}$ 在稳态下是联合宽平稳的，并且 $w_{k}$ 和 $v_{k}$ 与 $e_{k}$ 独立，则误差方差 $P_{k} \\equiv \\mathbb{E}[e_{k}^{2}]$ 服从\n$$\nP_{k+1} = (1 - L)^{2} P_{k} + \\mathbb{E}[w_{k}^{2}] + L^{2} \\mathbb{E}[v_{k}^{2}] = (1 - L)^{2} P_{k} + Q + L^{2} R.\n$$\n在稳态下，$P_{k+1} = P_{k} = P_{\\mathrm{LO}}$，可得\n$$\nP_{\\mathrm{LO}} = (1 - L)^{2} P_{\\mathrm{LO}} + Q + L^{2} R\n\\quad \\Longrightarrow \\quad\nP_{\\mathrm{LO}} = \\frac{Q + L^{2} R}{1 - (1 - L)^{2}},\n$$\n要求 $|1 - L|  1$ 以使分母为正，这在 $0  L  2$ 时成立。\n\n增益 $L$ 是确定性地选择的，以配置无噪声误差动态的极点。在没有噪声的情况下，$e_{k+1} = (1 - L)e_{k}$。设计要求的目标极点为\n$$\np_{d} = \\exp\\!\\left(-\\frac{T_{s}}{\\tau_{d}}\\right),\n$$\n因此\n$$\n1 - L = p_{d} \\quad \\Longrightarrow \\quad L = 1 - \\exp\\!\\left(-\\frac{T_{s}}{\\tau_{d}}\\right).\n$$\n当 $T_{s} = 1$ 且 $\\tau_{d} = 2$ 时，我们有\n$$\nL = 1 - \\exp\\!\\left(-\\frac{1}{2}\\right), \\quad (1 - L)^{2} = \\exp(-1), \\quad L^{2} = \\left(1 - \\exp\\!\\left(-\\frac{1}{2}\\right)\\right)^{2}.\n$$\n因此，\n$$\nP_{\\mathrm{LO}} = \\frac{Q + L^{2} R}{1 - (1 - L)^{2}} = \\frac{Q + R\\left(1 - 2\\exp\\!\\left(-\\frac{1}{2}\\right) + \\exp(-1)\\right)}{1 - \\exp(-1)}.\n$$\n代入 $Q = 0.25$ 和 $R = 4.0$，\n$$\nP_{\\mathrm{LO}} = \\frac{0.25 + 4\\left(1 - 2\\exp\\!\\left(-\\frac{1}{2}\\right) + \\exp(-1)\\right)}{1 - \\exp(-1)}.\n$$\n为了进行数值计算，使用 $\\exp(-1/2) \\approx 0.6065306597126334$ 和 $\\exp(-1) \\approx 0.36787944117144233$：\n$$\nP_{\\mathrm{LO}} \\approx \\frac{0.25 + 4\\left(1 - 2(0.6065306597126334) + 0.36787944117144233\\right)}{1 - 0.36787944117144233}\n= \\frac{0.25 + 4(0.15481812174617553)}{0.6321205588285577}\n= \\frac{0.8692724869847022}{0.6321205588285577} \\approx 1.375168827.\n$$\n\n随机 Kalman 滤波器 (KF)。对于状态转移矩阵 $F = 1$ 和测量矩阵 $H = 1$ 的标量系统，稳态先验协方差满足 $P^{-} = P + Q$，稳态 Kalman 增益为\n$$\nK = \\frac{P^{-}}{P^{-} + R} = \\frac{P + Q}{P + Q + R},\n$$\n并且稳态后验协方差为\n$$\nP = (1 - K) P^{-} = \\left(1 - \\frac{P + Q}{P + Q + R}\\right) (P + Q) = \\frac{R}{P + Q + R} (P + Q).\n$$\n这就得到了代数 Riccati 方程\n$$\nP(P + Q + R) = R(P + Q) \\quad \\Longrightarrow \\quad P^{2} + Q P - Q R = 0.\n$$\n求解该关于 $P \\ge 0$ 的二次方程，可得\n$$\nP_{\\mathrm{KF}} = \\frac{-Q + \\sqrt{Q^{2} + 4 Q R}}{2}.\n$$\n代入 $Q = 0.25$ 和 $R = 4.0$，\n$$\nP_{\\mathrm{KF}} = \\frac{-0.25 + \\sqrt{0.25^{2} + 4(0.25)(4.0)}}{2}\n= \\frac{-0.25 + \\sqrt{0.0625 + 4}}{2}\n= \\frac{-0.25 + \\sqrt{\\frac{65}{16}}}{2}\n= \\frac{1}{8}\\left(\\sqrt{65} - 1\\right).\n$$\n在数值上，$\\sqrt{65} \\approx 8.062257495$ 可得\n$$\nP_{\\mathrm{KF}} \\approx \\frac{1}{8}(8.062257495 - 1) \\approx 0.882782187.\n$$\n\n最后，所求的比值为\n$$\n\\rho \\equiv \\frac{P_{\\mathrm{LO}}}{P_{\\mathrm{KF}}} \\approx \\frac{1.375168827}{0.882782187} \\approx 1.557767\\ldots\n$$\n四舍五入到四位有效数字，\n$$\n\\rho \\approx 1.558.\n$$\n因此，在指定的 $Q$ 和 $R$ 以及所选的确定性极点下，确定性 Luenberger 观测器的稳态误差方差大约是最优随机 Kalman 滤波器方差的 $1.558$ 倍。",
            "answer": "$$\\boxed{1.558}$$"
        }
    ]
}