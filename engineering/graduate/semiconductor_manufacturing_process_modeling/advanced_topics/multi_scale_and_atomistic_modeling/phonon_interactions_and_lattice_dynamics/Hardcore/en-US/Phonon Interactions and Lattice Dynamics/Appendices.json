{
    "hands_on_practices": [
        {
            "introduction": "To model the complex lattice dynamics of real semiconductors, we begin with the simplest case that captures essential physics: the one-dimensional diatomic chain. This foundational exercise allows you to derive the phonon dispersion relation from Newton's laws, revealing the origin of distinct acoustic and optical vibrational modes . Understanding this distinction is the first step toward analyzing the thermal and electronic properties of materials like GaAs or SiC.",
            "id": "4150877",
            "problem": "An epitaxial one-dimensional diatomic chain is used to model the longitudinal lattice vibrations in a polar semiconductor heterostructure relevant to semiconductor manufacturing process modeling. The primitive cell contains two atoms per cell with masses $m_{1}$ and $m_{2}$ located at positions $n a$ and $n a + a/2$ for integer $n$, where $a$ is the lattice constant. Adjacent atoms are coupled by identical harmonic nearest-neighbor bonds with force constant $K$ under the harmonic approximation, and only nearest-neighbor interactions are present. Small oscillations about equilibrium are assumed.\n\nStarting from Newton’s second law and Hooke’s law, and imposing lattice periodicity through Bloch’s theorem for plane-wave solutions, derive the dispersion relation for this diatomic chain. From your dispersion relation, determine the optical branch angular frequency at the center of the first Brillouin zone (the $\\Gamma$ point, $k=0$), and express it explicitly in terms of $m_{1}$, $m_{2}$, and $K$. Then analyze the dependence of this optical branch angular frequency on the mass ratio $m_{1}/m_{2}$ and interpret the limit in which one sublattice is very heavy compared to the other. Concretely, extract the limiting form of the optical branch angular frequency at $\\Gamma$ when $m_{2} \\gg m_{1}$.\n\nExpress your final result as angular frequency in radians per second. No numerical evaluation is required. Your final answer should be the pair consisting of the general closed-form optical angular frequency at $\\Gamma$ and the limiting expression for $m_{2} \\gg m_{1}$, written side-by-side as a row matrix. Do not use pre-tabulated lattice dynamics formulas; begin from Newton’s laws and the harmonic forces and apply Bloch’s theorem to obtain the result.",
            "solution": "### Derivation\nLet $u_{n,1}$ be the longitudinal displacement of the atom of mass $m_1$ from its equilibrium position $na$. Let $u_{n,2}$ be the longitudinal displacement of the atom of mass $m_2$ from its equilibrium position $na + a/2$.\n\nAccording to Hooke's law, the force between two adjacent atoms is proportional to the change in their separation from the equilibrium distance of $a/2$. The atom of mass $m_1$ in the $n$-th cell is at an instantaneous position $na + u_{n,1}$. Its nearest neighbors are the atom of mass $m_2$ in the same cell at $na + a/2 + u_{n,2}$ and the atom of mass $m_2$ in the $(n-1)$-th cell at $(n-1)a + a/2 + u_{n-1,2}$. By Newton's second law, $m_1 \\ddot{u}_{n,1} = F_{n,1}$:\n$$m_1 \\frac{d^2 u_{n,1}}{dt^2} = K(u_{n,2} + u_{n-1,2} - 2u_{n,1})$$\n\nThe atom of mass $m_2$ in the $n$-th cell is at $na + a/2 + u_{n,2}$. Its nearest neighbors are the atom of mass $m_1$ in the same cell at $na + u_{n,1}$ and the atom of mass $m_1$ in the $(n+1)$-th cell at $(n+1)a + u_{n+1,1}$. The force on atom $(n,2)$ is:\n$$F_{n,2} = K(u_{n+1,1} - u_{n,2}) + K(u_{n,1} - u_{n,2})$$\nBy Newton's second law, $m_2 \\ddot{u}_{n,2} = F_{n,2}$:\n$$m_2 \\frac{d^2 u_{n,2}}{dt^2} = K(u_{n+1,1} + u_{n,1} - 2u_{n,2})$$\n\nWe seek plane-wave solutions of the form dictated by Bloch's theorem, where the displacements are periodic in the lattice. Let the solutions be:\n$$u_{n,1} = A_1 \\exp[i(kna - \\omega t)]$$\n$$u_{n,2} = A_2 \\exp[i(kna - \\omega t)]$$\nwhere $k$ is the wavevector, $\\omega$ is the angular frequency, and $A_1$, $A_2$ are the amplitudes for the two atoms in a cell. The displacements in adjacent cells are related by a phase factor:\n$$u_{n+1,1} = u_{n,1} \\exp(ika)$$\n$$u_{n-1,2} = u_{n,2} \\exp(-ika)$$\nThe second time derivatives are $\\ddot{u}_{n,1} = -\\omega^2 u_{n,1}$ and $\\ddot{u}_{n,2} = -\\omega^2 u_{n,2}$.\nSubstituting these into the equations of motion:\n$$-m_1 \\omega^2 u_{n,1} = K(u_{n,2} + u_{n,2}\\exp(-ika) - 2u_{n,1})$$\n$$-m_2 \\omega^2 u_{n,2} = K(u_{n,1}\\exp(ika) + u_{n,1} - 2u_{n,2})$$\nDividing by the common factor $\\exp[i(kna - \\omega t)]$ and rearranging gives a system of linear equations for the amplitudes $A_1$ and $A_2$:\n$$(2K - m_1 \\omega^2)A_1 - K(1 + \\exp(-ika))A_2 = 0$$\n$$-K(1 + \\exp(ika))A_1 + (2K - m_2 \\omega^2)A_2 = 0$$\nFor non-trivial solutions, the determinant of the coefficient matrix must be zero:\n$$\n\\begin{vmatrix}\n2K - m_1 \\omega^2  -K(1 + e^{-ika}) \\\\\n-K(1 + e^{ika})  2K - m_2 \\omega^2\n\\end{vmatrix} = 0\n$$\nExpanding the determinant:\n$$(2K - m_1 \\omega^2)(2K - m_2 \\omega^2) - K^2(1 + e^{-ika})(1 + e^{ika}) = 0$$\nThe second term simplifies: $(1 + e^{-ika})(1 + e^{ika}) = 1 + e^{ika} + e^{-ika} + 1 = 2 + 2\\cos(ka)$.\nThe equation becomes:\n$$4K^2 - 2K\\omega^2(m_1 + m_2) + m_1 m_2 \\omega^4 - K^2(2 + 2\\cos(ka)) = 0$$\n$$m_1 m_2 \\omega^4 - 2K(m_1 + m_2)\\omega^2 + 2K^2(1 - \\cos(ka)) = 0$$\nUsing the trigonometric identity $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$, we obtain the secular equation:\n$$m_1 m_2 (\\omega^2)^2 - 2K(m_1 + m_2)(\\omega^2) + 4K^2 \\sin^2\\left(\\frac{ka}{2}\\right) = 0$$\nThis is a quadratic equation for $\\omega^2$. Solving it yields the dispersion relation $\\omega(k)$:\n$$\\omega^2(k) = \\frac{2K(m_1+m_2) \\pm \\sqrt{4K^2(m_1+m_2)^2 - 16K^2 m_1 m_2 \\sin^2(ka/2)}}{2m_1 m_2}$$\n$$\\omega^2(k) = K\\left(\\frac{1}{m_1} + \\frac{1}{m_2}\\right) \\pm K\\sqrt{\\left(\\frac{1}{m_1} + \\frac{1}{m_2}\\right)^2 - \\frac{4\\sin^2(ka/2)}{m_1 m_2}}$$\nThe two solutions for $\\omega^2$ (from the $\\pm$ sign) define the two branches of the dispersion relation. The upper branch (plus sign) is the optical branch, and the lower branch (minus sign) is the acoustical branch.\n\nNow, we determine the optical branch angular frequency at the center of the first Brillouin zone, which is the $\\Gamma$ point where $k=0$.\nAt $k=0$, $\\sin(ka/2) = \\sin(0) = 0$. The expression for $\\omega^2$ simplifies:\n$$\\omega^2(k=0) = K\\left(\\frac{1}{m_1} + \\frac{1}{m_2}\\right) \\pm K\\sqrt{\\left(\\frac{1}{m_1} + \\frac{1}{m_2}\\right)^2}$$\n$$\\omega^2(k=0) = K\\left(\\frac{1}{m_1} + \\frac{1}{m_2}\\right) \\pm K\\left(\\frac{1}{m_1} + \\frac{1}{m_2}\\right)$$\nThe optical branch corresponds to the '+' sign:\n$$\\omega^2_{OP}(k=0) = 2K\\left(\\frac{1}{m_1} + \\frac{1}{m_2}\\right)$$\nThe angular frequency is the square root of this value:\n$$\\omega_{OP}(k=0) = \\sqrt{2K\\left(\\frac{1}{m_1} + \\frac{1}{m_2}\\right)}$$\nThis is the first part of the answer. For this mode, the two atoms in the primitive cell oscillate against each other, keeping the center of mass stationary.\n\nFinally, we analyze the limit where one mass is much heavier, $m_2 \\gg m_1$. In this limit, the term $1/m_2$ becomes negligible compared to $1/m_1$.\n$$\\lim_{m_2 \\gg m_1} \\omega_{OP}(k=0) = \\lim_{m_2 \\rightarrow \\infty} \\sqrt{2K\\left(\\frac{1}{m_1} + \\frac{1}{m_2}\\right)}$$\nAs $m_2 \\to \\infty$, $1/m_2 \\to 0$. The expression becomes:\n$$\\omega_{OP}(k=0) \\approx \\sqrt{2K\\left(\\frac{1}{m_1}\\right)} = \\sqrt{\\frac{2K}{m_1}}$$\nThis is the limiting form of the angular frequency.\nThe physical interpretation of this limit is that the very heavy atoms of mass $m_2$ are essentially immobile. The light atoms of mass $m_1$ oscillate, each being coupled to two stationary neighbors by springs of constant $K$. The two springs act in parallel, resulting in an effective spring constant of $2K$. The motion reduces to that of a simple harmonic oscillator of mass $m_1$ and spring constant $2K$, whose angular frequency is indeed $\\sqrt{2K/m_1}$.\n\nThe two required expressions are the general optical angular frequency at $\\Gamma$ and its limiting form for $m_2 \\gg m_1$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\sqrt{2K\\left(\\frac{1}{m_1} + \\frac{1}{m_2}\\right)}  \\sqrt{\\frac{2K}{m_1}}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "While understanding individual phonon modes is crucial, calculating macroscopic properties like heat capacity requires knowing the distribution of these modes across all frequencies. This practice introduces the Debye model, a powerful approximation used to derive the phonon density of states, $g(\\omega)$, for a three-dimensional crystal . By working through this derivation, you will develop a key tool for translating the microscopic vibrational spectrum into macroscopic thermodynamic quantities essential for thermal process modeling.",
            "id": "4150898",
            "problem": "In semiconductor manufacturing process modeling, transient thermal budgets in steps such as rapid thermal annealing depend sensitively on the phonon density of states (DOS), because it governs heat capacity and phonon-mediated energy transport. Consider a large, monatomic, three-dimensional ($3$D), isotropic crystal representing a semiconductor wafer region with periodic boundary conditions. Assume the acoustic phonon branches are Debye-like: each acoustic polarization has a linear dispersion relation $\\omega = v k$ up to an angular frequency cutoff $\\omega_{D}$, where $\\omega$ is the angular frequency, $k$ is the wavevector magnitude, and $v$ is an isotropic sound speed taken to be equal for all three acoustic polarizations. The crystal has $N$ unit cells (and hence $N$ atoms), so there are $3N$ acoustic modes in total. Define the phonon density of states per unit angular frequency $g(\\omega)$ as the number of normal modes between $\\omega$ and $\\omega + d\\omega$ divided by $d\\omega$, summed over all acoustic polarizations.\n\nStarting only from the quantization of wavevectors due to periodic boundary conditions and the definition of $g(\\omega)$ as a mode-counting derivative, derive $g(\\omega)$ in three dimensions and impose the normalization that the total number of acoustic modes equals $3N$ for the monatomic crystal. Eliminate any intermediate parameters such as the volume and sound speed in favor of $N$ and $\\omega_{D}$.\n\nProvide your final answer as a single closed-form analytic expression for $g(\\omega)$, valid for all $\\omega$, in terms of $N$ and $\\omega_{D}$ only. If a piecewise form is appropriate, use it. Treat $g(\\omega)$ as a count per unit angular frequency; do not include units in your final expression. No rounding is required.",
            "solution": "The problem requires the derivation of the phonon density of states, $g(\\omega)$, for a three-dimensional ($3$D) monatomic crystal under the Debye approximation. The final expression must be in terms of the number of atoms, $N$, and the Debye cutoff frequency, $\\omega_D$.\n\nThe derivation begins with the quantization of the wavevector, $\\vec{k}$, due to the imposition of periodic boundary conditions on a crystal of volume $V = L^3$, where $L$ is the side length. For a wave function of the form $\\exp(i\\vec{k} \\cdot \\vec{r})$, periodic boundary conditions require that the components of the wavevector are quantized as:\n$$\nk_x = \\frac{2\\pi n_x}{L}, \\quad k_y = \\frac{2\\pi n_y}{L}, \\quad k_z = \\frac{2\\pi n_z}{L}\n$$\nwhere $n_x, n_y, n_z$ are integers. These allowed wavevectors form a cubic lattice in reciprocal space (k-space). The volume in k-space occupied by a single mode is the volume of the primitive cell of this reciprocal lattice:\n$$\n\\Delta V_k = \\left(\\frac{2\\pi}{L}\\right)^3 = \\frac{8\\pi^3}{V}\n$$\nTo find the number of modes, we can treat the discrete k-space as a continuum for a large crystal. The number of modes with a wavevector magnitude less than or equal to $k$ is found by calculating the volume of a sphere of radius $k$ in k-space and dividing by the volume per mode, $\\Delta V_k$. The model assumes an isotropic crystal, so surfaces of constant energy (and frequency) are spheres in k-space.\n\nThe volume of a sphere of radius $k$ is $V_k = \\frac{4}{3}\\pi k^3$. The number of modes for a single polarization within this sphere is:\n$$\nN_{1p}(k) = \\frac{V_k}{\\Delta V_k} = \\frac{\\frac{4}{3}\\pi k^3}{8\\pi^3/V} = \\frac{V k^3}{6\\pi^2}\n$$\nThe problem states there are three acoustic polarizations (two transverse and one longitudinal), and the sound speed $v$ is assumed to be the same for all. Thus, the total number of modes, $N(k)$, is three times the number for a single polarization:\n$$\nN(k) = 3 \\times N_{1p}(k) = 3 \\left( \\frac{V k^3}{6\\pi^2} \\right) = \\frac{V k^3}{2\\pi^2}\n$$\nThe problem specifies a linear, Debye-like dispersion relation, $\\omega = v k$. We use this to express the wavevector magnitude $k$ in terms of angular frequency $\\omega$ as $k = \\omega/v$. Substituting this into the expression for $N(k)$ gives the total number of modes with frequency less than or equal to $\\omega$:\n$$\nN(\\omega) = \\frac{V}{2\\pi^2} \\left( \\frac{\\omega}{v} \\right)^3 = \\frac{V}{2\\pi^2 v^3} \\omega^3\n$$\nThe phonon density of states, $g(\\omega)$, is defined as the number of modes per unit frequency interval, which is the derivative of $N(\\omega)$ with respect to $\\omega$:\n$$\ng(\\omega) = \\frac{dN(\\omega)}{d\\omega} = \\frac{d}{d\\omega} \\left( \\frac{V}{2\\pi^2 v^3} \\omega^3 \\right) = \\frac{3V}{2\\pi^2 v^3} \\omega^2\n$$\nThis expression is valid for $0 \\le \\omega \\le \\omega_D$. For $\\omega > \\omega_D$, the model posits that there are no further modes, so $g(\\omega) = 0$.\n\nThe final step is to eliminate the dependence on the volume $V$ and sound speed $v$ by applying the normalization condition. A monatomic crystal with $N$ atoms has $3N$ vibrational degrees of freedom, which in this model correspond to the $3N$ total acoustic modes. The total number of modes is obtained by integrating the density of states up to the cutoff frequency $\\omega_D$:\n$$\n\\int_0^{\\omega_D} g(\\omega) d\\omega = 3N\n$$\nSubstituting our expression for $g(\\omega)$ into the integral:\n$$\n\\int_0^{\\omega_D} \\left( \\frac{3V}{2\\pi^2 v^3} \\omega^2 \\right) d\\omega = \\frac{3V}{2\\pi^2 v^3} \\left[ \\frac{\\omega^3}{3} \\right]_0^{\\omega_D} = \\frac{V \\omega_D^3}{2\\pi^2 v^3}\n$$\nEquating this result to $3N$:\n$$\n\\frac{V \\omega_D^3}{2\\pi^2 v^3} = 3N\n$$\nWe can rearrange this equation to solve for the prefactor in our expression for $g(\\omega)$. The prefactor is $C = \\frac{3V}{2\\pi^2 v^3}$. From the normalization condition, we find:\n$$\n\\frac{V}{2\\pi^2 v^3} = \\frac{3N}{\\omega_D^3}\n$$\nSubstituting this back into the definition of the prefactor $C$:\n$$\nC = 3 \\left( \\frac{V}{2\\pi^2 v^3} \\right) = 3 \\left( \\frac{3N}{\\omega_D^3} \\right) = \\frac{9N}{\\omega_D^3}\n$$\nNow, we can write the final expression for the density of states $g(\\omega)$ in terms of only $N$ and $\\omega_D$:\n$$\ng(\\omega) = \\frac{9N}{\\omega_D^3} \\omega^2\n$$\nThis formula is valid for $0 \\le \\omega \\le \\omega_D$. For frequencies above the Debye cutoff, $g(\\omega)=0$. The complete expression is therefore a piecewise function.",
            "answer": "$$\n\\boxed{\n\\begin{cases}\n\\frac{9N}{\\omega_D^3}\\omega^2  0 \\le \\omega \\le \\omega_D \\\\\n0  \\omega > \\omega_D\n\\end{cases}\n}\n$$"
        },
        {
            "introduction": "The reliability of semiconductor devices is critically dependent on managing thermal expansion, which induces mechanical stress during fabrication and operation. This hands-on problem bridges the gap between fundamental lattice dynamics and practical engineering by using the quasi-harmonic approximation to predict the thermal expansion coefficient . You will compute the Grüneisen parameter, which quantifies lattice anharmonicity, and see firsthand how microscopic changes in phonon frequencies with crystal volume dictate a macroscopic material property.",
            "id": "4150860",
            "problem": "A crystalline semiconductor such as silicon can be modeled at the level of lattice dynamics by considering vibrational normal modes (phonons) whose angular frequencies depend on the crystal volume. In the quasi-harmonic approximation, the sensitivity of a phonon mode to volume determines its contribution to thermal expansion through the mode Grüneisen parameter. Starting from fundamental definitions and laws, implement a program that computes the mode Grüneisen parameters, a heat-capacity-weighted average Grüneisen parameter at a specified temperature, and a model prediction of the linear thermal expansion coefficient to compare with experimental values.\n\nFundamental base:\n- The mode Grüneisen parameter is defined as $ \\gamma_{\\lambda} \\equiv - \\dfrac{V}{\\omega_{\\lambda}} \\left( \\dfrac{\\partial \\omega_{\\lambda}}{\\partial V} \\right) $, where $ \\lambda $ indexes a phonon mode, $ V $ is the crystal volume, and $ \\omega_{\\lambda} $ is the angular frequency of mode $ \\lambda $.\n- The Bose-Einstein mode heat capacity is $ C_{\\lambda}(T) = k_{\\mathrm{B}} \\left( \\dfrac{\\hbar \\omega_{\\lambda}}{k_{\\mathrm{B}} T} \\right)^{2} \\dfrac{e^{x_{\\lambda}}}{\\left( e^{x_{\\lambda}} - 1 \\right)^{2}} $, with $ x_{\\lambda} = \\dfrac{\\hbar \\omega_{\\lambda}}{k_{\\mathrm{B}} T} $, Boltzmann constant $ k_{\\mathrm{B}} $, and reduced Planck constant $ \\hbar $.\n- The heat-capacity-weighted average Grüneisen parameter is $ \\bar{\\gamma}(T) = \\dfrac{\\sum_{\\lambda} w_{\\lambda} \\, C_{\\lambda}(T) \\, \\gamma_{\\lambda}}{\\sum_{\\lambda} w_{\\lambda} \\, C_{\\lambda}(T)} $, where $ w_{\\lambda} $ is a nonnegative degeneracy weight for mode $ \\lambda $.\n- The volumetric thermal expansion coefficient is $ \\alpha_{\\mathrm{v}}(T) = \\dfrac{\\bar{\\gamma}(T) \\, C_{v}(T)}{K_{T} \\, V} $, where $ C_{v}(T) = \\sum_{\\lambda} w_{\\lambda} \\, C_{\\lambda}(T) $ is the total vibrational heat capacity and $ K_{T} $ is the isothermal bulk modulus. The linear thermal expansion coefficient is $ \\alpha_{\\ell}(T) = \\alpha_{\\mathrm{v}}(T)/3 $ for isotropic cubic crystals.\n\nYou are given, for silicon, a set of representative phonon mode frequencies tabulated at three volumes $ V_{-} = V_{0} (1 - \\delta) $, $ V_{0} $, and $ V_{+} = V_{0} (1 + \\delta) $, with $ \\delta $ small. Frequencies are provided in terahertz and must be converted to angular frequency in radians per second via $ \\omega = 2 \\pi f $, with $ f $ in hertz. The primitive cell volume for diamond-cubic silicon is $ V_{0} = a_{0}^{3}/4 $, with lattice constant $ a_{0} $.\n\nYour program must:\n- Compute $ \\gamma_{\\lambda} $ for each mode using a central difference approximation for $ \\dfrac{\\partial \\omega_{\\lambda}}{\\partial V} $ based on the given $ \\omega_{\\lambda}(V_{-}) $, $ \\omega_{\\lambda}(V_{0}) $, and $ \\omega_{\\lambda}(V_{+}) $, evaluated at $ V = V_{0} $.\n- Compute $ \\bar{\\gamma}(T) $ at the specified temperature using the Bose-Einstein mode heat capacities and the given weights $ w_{\\lambda} $.\n- Compute $ \\alpha_{\\ell}(T) $ in $ \\mathrm{K}^{-1} $ using $ \\alpha_{\\ell}(T) = \\alpha_{\\mathrm{v}}(T)/3 $.\n- Compare $ \\alpha_{\\ell}(T) $ to a provided experimental linear thermal expansion coefficient $ \\alpha_{\\ell, \\mathrm{exp}} $ using a fractional tolerance $ \\tau $, reporting whether $ \\left| \\alpha_{\\ell}(T) - \\alpha_{\\ell, \\mathrm{exp}} \\right| / \\alpha_{\\ell, \\mathrm{exp}} \\le \\tau $.\n\nPhysical constants to use:\n- Boltzmann constant $ k_{\\mathrm{B}} = 1.380\\,649 \\times 10^{-23} \\,\\mathrm{J/K} $.\n- Reduced Planck constant $ \\hbar = 1.054\\,571\\,817 \\times 10^{-34} \\,\\mathrm{J \\cdot s} $.\n- Pi $ \\pi = 3.141\\,592\\,653\\,589\\,793 $.\n\nUnits:\n- Lattice constant $ a_{0} $ must be provided in meters.\n- Bulk modulus $ K_{T} $ must be provided in pascals.\n- Temperature $ T $ must be provided in kelvin.\n- Frequencies are provided in terahertz and must be internally converted to radians per second.\n- The final $ \\alpha_{\\ell}(T) $ must be reported in $ \\mathrm{K}^{-1} $.\n\nTest suite:\n- Test case $ 1 $ (happy path, room temperature, typical bulk modulus):\n  - $ a_{0} = 5.431 \\times 10^{-10} \\,\\mathrm{m} $, $ K_{T} = 9.90 \\times 10^{10} \\,\\mathrm{Pa} $, $ T = 300 \\,\\mathrm{K} $, $ \\delta = 0.01 $, weights $ w_{\\lambda} = 1 $ for all modes.\n  - Experimental linear thermal expansion coefficient: $ \\alpha_{\\ell, \\mathrm{exp}} = 2.60 \\times 10^{-6} \\,\\mathrm{K}^{-1} $.\n  - Fractional tolerance: $ \\tau = 0.20 $.\n  - Six representative modes with $ \\left( f_{-}, f_{0}, f_{+} \\right) $ in terahertz:\n    - Mode $ 1 $: $ \\left( 3.0105, 3.0000, 2.9895 \\right) $.\n    - Mode $ 2 $: $ \\left( 6.0240, 6.0000, 5.9760 \\right) $.\n    - Mode $ 3 $: $ \\left( 9.0405, 9.0000, 8.9595 \\right) $.\n    - Mode $ 4 $: $ \\left( 12.0780, 12.0000, 11.9220 \\right) $.\n    - Mode $ 5 $: $ \\left( 15.7170, 15.6000, 15.4830 \\right) $.\n    - Mode $ 6 $: $ \\left( 18.1530, 18.0000, 17.8470 \\right) $.\n- Test case $ 2 $ (sensitivity to stiffness, larger bulk modulus):\n  - $ a_{0} = 5.431 \\times 10^{-10} \\,\\mathrm{m} $, $ K_{T} = 1.20 \\times 10^{11} \\,\\mathrm{Pa} $, $ T = 300 \\,\\mathrm{K} $, $ \\delta = 0.01 $, weights $ w_{\\lambda} = 1 $ for all modes.\n  - Experimental linear thermal expansion coefficient: $ \\alpha_{\\ell, \\mathrm{exp}} = 2.60 \\times 10^{-6} \\,\\mathrm{K}^{-1} $.\n  - Fractional tolerance: $ \\tau = 0.20 $.\n  - Same six representative modes and terahertz triplets as in test case $ 1 $.\n- Test case $ 3 $ (edge case, near-volume-insensitive spectrum at low temperature):\n  - $ a_{0} = 5.431 \\times 10^{-10} \\,\\mathrm{m} $, $ K_{T} = 9.90 \\times 10^{10} \\,\\mathrm{Pa} $, $ T = 50 \\,\\mathrm{K} $, $ \\delta = 0.01 $, weights $ w_{\\lambda} = 1 $ for all modes.\n  - Experimental linear thermal expansion coefficient: $ \\alpha_{\\ell, \\mathrm{exp}} = 2.00 \\times 10^{-7} \\,\\mathrm{K}^{-1} $.\n  - Fractional tolerance: $ \\tau = 0.20 $.\n  - Six representative modes with weak volume dependence and terahertz triplets:\n    - Mode $ 1 $: $ \\left( 3.0006, 3.0000, 2.9994 \\right) $.\n    - Mode $ 2 $: $ \\left( 6.0012, 6.0000, 5.9988 \\right) $.\n    - Mode $ 3 $: $ \\left( 9.0018, 9.0000, 8.9982 \\right) $.\n    - Mode $ 4 $: $ \\left( 12.0024, 12.0000, 11.9976 \\right) $.\n    - Mode $ 5 $: $ \\left( 15.6031, 15.6000, 15.5969 \\right) $.\n    - Mode $ 6 $: $ \\left( 18.0024, 18.0000, 17.9976 \\right) $.\n\nAlgorithmic requirements:\n- Use a central difference $ \\left( \\dfrac{\\partial \\omega_{\\lambda}}{\\partial V} \\right) \\approx \\dfrac{\\omega_{\\lambda}(V_{+}) - \\omega_{\\lambda}(V_{-})}{V_{+} - V_{-}} $.\n- Compute $ \\gamma_{\\lambda} $ for each mode, then $ \\bar{\\gamma}(T) $ and $ \\alpha_{\\ell}(T) $ for each test case.\n- The program should produce a single line of output containing the results for all test cases as a comma-separated list enclosed in square brackets, where each test case result is itself a list $ [\\bar{\\gamma}, \\alpha_{\\ell}, \\text{within\\_tolerance}] $. The $ \\bar{\\gamma} $ is dimensionless, $ \\alpha_{\\ell} $ must be in $ \\mathrm{K}^{-1} $, and $ \\text{within\\_tolerance} $ must be a boolean indicating whether the model prediction agrees with the provided experimental value within the specified fractional tolerance.",
            "solution": "The core objective is to compute the linear thermal expansion coefficient, $\\alpha_{\\ell}(T)$, of silicon at a given temperature $T$ and compare it to an experimental value. This is achieved by modeling the crystal's vibrational energy, which is quantized into normal modes known as phonons.\n\n### Principle 1: Mode Grüneisen Parameter\nThe Grüneisen parameter, $\\gamma$, is a dimensionless quantity that measures the response of a system's vibrational frequencies to a change in its volume. For a specific phonon mode indexed by $\\lambda$, with angular frequency $\\omega_{\\lambda}$, the mode Grüneisen parameter $\\gamma_{\\lambda}$ is defined as:\n$$ \\gamma_{\\lambda} \\equiv - \\frac{V}{\\omega_{\\lambda}} \\left( \\frac{\\partial \\omega_{\\lambda}}{\\partial V} \\right) $$\nHere, $V$ is the crystal volume. A positive $\\gamma_{\\lambda}$ indicates that the mode frequency decreases as the crystal expands, which is typical for most phonon modes. The derivative $\\left( \\frac{\\partial \\omega_{\\lambda}}{\\partial V} \\right)$ is evaluated at the equilibrium volume $V = V_0$. The problem supplies phonon frequencies $f_{\\lambda}$ at three distinct volumes: $V_{-} = V_{0} (1 - \\delta)$, $V_{0}$, and $V_{+} = V_{0} (1 + \\delta)$, where $\\delta$ is a small fractional change. The derivative is approximated using a second-order central difference formula:\n$$ \\left( \\frac{\\partial \\omega_{\\lambda}}{\\partial V} \\right)_{V=V_0} \\approx \\frac{\\omega_{\\lambda}(V_{+}) - \\omega_{\\lambda}(V_{-})}{V_{+} - V_{-}} = \\frac{\\omega_{\\lambda}(V_{+}) - \\omega_{\\lambda}(V_{-})}{2 V_0 \\delta} $$\nSubstituting this into the definition of $\\gamma_{\\lambda}$ and evaluating at $V_0$ and $\\omega_{0, \\lambda} = \\omega_{\\lambda}(V_0)$:\n$$ \\gamma_{\\lambda} = - \\frac{V_0}{\\omega_{0, \\lambda}} \\left( \\frac{\\omega_{+, \\lambda} - \\omega_{-, \\lambda}}{2 V_0 \\delta} \\right) = - \\frac{1}{2\\delta} \\frac{\\omega_{+, \\lambda} - \\omega_{-, \\lambda}}{\\omega_{0, \\lambda}} $$\nSince angular frequency $\\omega$ is related to frequency $f$ by $\\omega = 2\\pi f$, this simplifies to a form convenient for calculation:\n$$ \\gamma_{\\lambda} = - \\frac{1}{2\\delta} \\frac{f_{+, \\lambda} - f_{-, \\lambda}}{f_{0, \\lambda}} $$\nThis simplified expression avoids intermediate calculations involving large or small numbers and is used in the implementation.\n\n### Principle 2: Phonon Contribution to Heat Capacity\nThe vibrational energy of a solid is the sum of energies of its phonon modes. As phonons are bosons, their statistical mechanics are described by the Bose-Einstein distribution. The contribution of a single phonon mode $\\lambda$ to the total isochoric (constant volume) heat capacity $C_v$ is given by:\n$$ C_{\\lambda}(T) = k_{\\mathrm{B}} \\left( \\frac{\\hbar \\omega_{0, \\lambda}}{k_{\\mathrm{B}} T} \\right)^{2} \\frac{e^{\\hbar \\omega_{0, \\lambda}/(k_{\\mathrm{B}} T)}}{\\left( e^{\\hbar \\omega_{0, \\lambda}/(k_{\\mathrm{B}} T)} - 1 \\right)^{2}} $$\nwhere $k_{\\mathrm{B}}$ is the Boltzmann constant and $\\hbar$ is the reduced Planck constant. The frequencies $\\omega_{0, \\lambda}$ are those at the equilibrium volume $V_0$. The total vibrational heat capacity for a representative set of modes is the weighted sum over all modes:\n$$ C_{v}(T) = \\sum_{\\lambda} w_{\\lambda} \\, C_{\\lambda}(T) $$\nwhere $w_{\\lambda}$ is the degeneracy or weight of mode $\\lambda$. For this problem, all weights are given as $w_{\\lambda} = 1$.\n\n### Principle 3: Macroscopic Thermal Expansion\nThe macroscopic thermal expansion of the material is related to the weighted average of the microscopic mode Grüneisen parameters. The heat-capacity-weighted average Grüneisen parameter, $\\bar{\\gamma}(T)$, is defined as:\n$$ \\bar{\\gamma}(T) = \\frac{\\sum_{\\lambda} w_{\\lambda} \\, C_{\\lambda}(T) \\, \\gamma_{\\lambda}}{\\sum_{\\lambda} w_{\\lambda} \\, C_{\\lambda}(T)} $$\nThis average parameter connects the microscopic volume-dependence of frequencies to the macroscopic thermal expansion via a fundamental thermodynamic relation. The volumetric thermal expansion coefficient, $\\alpha_{\\mathrm{v}}(T)$, is given by:\n$$ \\alpha_{\\mathrm{v}}(T) = \\frac{\\bar{\\gamma}(T) \\, C_{v}(T)}{K_{T} \\, V_0} $$\nwhere $K_T$ is the isothermal bulk modulus and $V_0$ is the equilibrium volume of the primitive cell. By substituting the definitions of $\\bar{\\gamma}(T)$ and $C_v(T)$, this expression simplifies to:\n$$ \\alpha_{\\mathrm{v}}(T) = \\frac{1}{K_T V_0} \\left( \\frac{\\sum_{\\lambda} w_{\\lambda} C_{\\lambda}(T) \\gamma_{\\lambda}}{\\sum_{\\lambda} w_{\\lambda} C_{\\lambda}(T)} \\right) \\left( \\sum_{\\lambda} w_{\\lambda} C_{\\lambda}(T) \\right) = \\frac{1}{K_T V_0} \\sum_{\\lambda} w_{\\lambda} C_{\\lambda}(T) \\gamma_{\\lambda} $$\nThis formulation is computationally more direct and avoids a potential division by nearly zero if the total heat capacity is very small. For an isotropic material like silicon (which has a cubic crystal structure), the linear thermal expansion coefficient $\\alpha_{\\ell}(T)$ is one-third of the volumetric coefficient:\n$$ \\alpha_{\\ell}(T) = \\frac{\\alpha_{\\mathrm{v}}(T)}{3} = \\frac{1}{3 K_T V_0} \\sum_{\\lambda} w_{\\lambda} C_{\\lambda}(T) \\gamma_{\\lambda} $$\n\n### Computational Strategy\nThe solution is implemented by executing the following steps for each test case provided:\n1.  **Constants and Inputs**: Define the physical constants $k_{\\mathrm{B}}$, $\\hbar$, and $\\pi$. Parse the material parameters for the test case: lattice constant $a_0$, bulk modulus $K_T$, temperature $T$, volume strain $\\delta$, mode weights $w_{\\lambda}$, and phonon frequencies $\\{f_{-}, f_0, f_{+}\\}_{\\lambda}$.\n2.  **Volume Calculation**: Compute the equilibrium primitive cell volume $V_0 = a_0^3 / 4$. All other physical quantities are calculated with respect to this reference volume.\n3.  **Mode-by-Mode Analysis**: Iterate through the set of $N$ representative phonon modes. For each mode $\\lambda$:\n    a. Calculate the mode Grüneisen parameter $\\gamma_{\\lambda}$ using the simplified formula involving only frequencies and $\\delta$.\n    b. Convert the equilibrium frequency $f_{0, \\lambda}$ (in terahertz) to angular frequency $\\omega_{0, \\lambda}$ (in radians/second) via $\\omega_{0, \\lambda} = 2 \\pi f_{0, \\lambda} \\times 10^{12}$.\n    c. Compute the dimensionless energy term $x_{\\lambda} = \\hbar \\omega_{0, \\lambda} / (k_B T)$.\n    d. Calculate the mode heat capacity $C_{\\lambda}(T)$ using the Bose-Einstein formula. To avoid potential numerical overflow with $e^{x_{\\lambda}}$, a check for large $x_{\\lambda}$ is prudent, though not strictly necessary for the given test cases.\n4.  **Aggregate Properties**: Sum the mode-specific contributions to find the necessary macroscopic quantities.\n    a. Compute the numerator for the average Grüneisen parameter: $\\Sigma_{\\gamma C} = \\sum_{\\lambda} w_{\\lambda} C_{\\lambda}(T) \\gamma_{\\lambda}$.\n    b. Compute the total heat capacity, which is the denominator: $C_v(T) = \\sum_{\\lambda} w_{\\lambda} C_{\\lambda}(T)$.\n5.  **Final Calculations**:\n    a. Compute the average Grüneisen parameter: $\\bar{\\gamma}(T) = \\Sigma_{\\gamma C} / C_v(T)$.\n    b. Compute the linear thermal expansion coefficient: $\\alpha_{\\ell}(T) = \\Sigma_{\\gamma C} / (3 K_T V_0)$.\n6.  **Comparison and Output**: Compare the calculated $\\alpha_{\\ell}(T)$ with the given experimental value $\\alpha_{\\ell, \\mathrm{exp}}$ using the specified fractional tolerance $\\tau$. The result is `True` if $|\\alpha_{\\ell}(T) - \\alpha_{\\ell, \\mathrm{exp}}| / |\\alpha_{\\ell, \\mathrm{exp}}| \\le \\tau$. The final results for each test case, consisting of $[\\bar{\\gamma}, \\alpha_{\\ell}, \\text{within\\_tolerance}]$, are aggregated and formatted into a single string as required.\nThis procedure systematically applies the principles of lattice dynamics to produce the desired physical quantities.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Computes mode Grüneisen parameters, average Grüneisen parameter, and linear\n    thermal expansion coefficient for silicon based on the quasi-harmonic approximation.\n    \"\"\"\n    # Physical constants in SI units\n    KB = 1.380649e-23  # Boltzmann constant in J/K\n    HBAR = 1.054571817e-34  # Reduced Planck constant in J·s\n    PI = 3.141592653589793  # Pi\n\n    # Test cases defined in the problem statement\n    test_cases = [\n        {\n            \"id\": 1,\n            \"params\": {\n                \"a0\": 5.431e-10,  # Lattice constant in m\n                \"KT\": 9.90e10,    # Isothermal bulk modulus in Pa\n                \"T\": 300.0,      # Temperature in K\n                \"delta\": 0.01,\n                \"weights\": [1.0] * 6,\n                \"alpha_exp\": 2.60e-6, # K^-1\n                \"tolerance\": 0.20,\n            },\n            \"modes_THz\": [\n                (3.0105, 3.0000, 2.9895), (6.0240, 6.0000, 5.9760),\n                (9.0405, 9.0000, 8.9595), (12.0780, 12.0000, 11.9220),\n                (15.7170, 15.6000, 15.4830), (18.1530, 18.0000, 17.8470),\n            ]\n        },\n        {\n            \"id\": 2,\n            \"params\": {\n                \"a0\": 5.431e-10,\n                \"KT\": 1.20e11,\n                \"T\": 300.0,\n                \"delta\": 0.01,\n                \"weights\": [1.0] * 6,\n                \"alpha_exp\": 2.60e-6,\n                \"tolerance\": 0.20,\n            },\n            \"modes_THz\": [\n                (3.0105, 3.0000, 2.9895), (6.0240, 6.0000, 5.9760),\n                (9.0405, 9.0000, 8.9595), (12.0780, 12.0000, 11.9220),\n                (15.7170, 15.6000, 15.4830), (18.1530, 18.0000, 17.8470),\n            ]\n        },\n        {\n            \"id\": 3,\n            \"params\": {\n                \"a0\": 5.431e-10,\n                \"KT\": 9.90e10,\n                \"T\": 50.0,\n                \"delta\": 0.01,\n                \"weights\": [1.0] * 6,\n                \"alpha_exp\": 2.00e-7,\n                \"tolerance\": 0.20,\n            },\n            \"modes_THz\": [\n                (3.0006, 3.0000, 2.9994), (6.0012, 6.0000, 5.9988),\n                (9.0018, 9.0000, 8.9982), (12.0024, 12.0000, 11.9976),\n                (15.6031, 15.6000, 15.5969), (18.0024, 18.0000, 17.9976),\n            ]\n        }\n    ]\n\n    final_results = []\n    \n    for case in test_cases:\n        p = case[\"params\"]\n        a0, KT, T, delta = p[\"a0\"], p[\"KT\"], p[\"T\"], p[\"delta\"]\n        alpha_exp, tolerance = p[\"alpha_exp\"], p[\"tolerance\"]\n        \n        # Equilibrium primitive cell volume\n        V0 = a0**3 / 4.0\n        \n        modes_thz = np.array(case[\"modes_THz\"])\n        f_minus, f0, f_plus = modes_thz[:, 0], modes_thz[:, 1], modes_thz[:, 2]\n        weights = np.array(p[\"weights\"])\n\n        # Calculate mode Grüneisen parameters\n        # gamma_lambda = - (1 / (2 * delta)) * (f_plus - f_minus) / f0\n        gammas = - (1.0 / (2.0 * delta)) * (f_plus - f_minus) / f0\n\n        # Convert f0 from THz to angular frequency in rad/s\n        omega0 = 2.0 * PI * f0 * 1.0e12\n\n        # Calculate mode heat capacities\n        # x_lambda = hbar * omega / (kB * T)\n        x = HBAR * omega0 / (KB * T)\n        \n        # Avoid division by zero if exp(x) - 1 is zero (for x=0)\n        # and numerical instability for very small x\n        C_lambda = np.zeros_like(x)\n        nonzero_mask = x > 1e-9  # Threshold to avoid instability\n\n        # For x > 0\n        x_nz = x[nonzero_mask]\n        exp_x = np.exp(x_nz)\n        C_lambda[nonzero_mask] = KB * x_nz**2 * exp_x / (exp_x - 1.0)**2\n        \n        # For x -> 0 (classical limit, C_lambda -> kB)\n        C_lambda[~nonzero_mask] = KB\n\n        # Calculate sums for macroscopic properties\n        weighted_C_lambda = weights * C_lambda\n        sum_w_C = np.sum(weighted_C_lambda)\n        sum_w_C_gamma = np.sum(weighted_C_lambda * gammas)\n        \n        # Calculate heat-capacity-weighted average Grüneisen parameter\n        # Handle case where total heat capacity is zero\n        if sum_w_C > 1e-30:\n            gamma_bar = sum_w_C_gamma / sum_w_C\n        else:\n            gamma_bar = 0.0\n\n        # Calculate linear thermal expansion coefficient\n        # alpha_l = (1 / (3 * KT * V0)) * sum(w * C_lambda * gamma)\n        alpha_l = sum_w_C_gamma / (3.0 * KT * V0)\n\n        # Compare with experimental value\n        # within_tolerance = |alpha_l - alpha_exp| / alpha_exp = tolerance\n        if abs(alpha_exp)  1e-15: # Avoid division by zero\n            within_tolerance = abs(alpha_l) = tolerance\n        else:\n            fractional_diff = abs(alpha_l - alpha_exp) / abs(alpha_exp)\n            within_tolerance = fractional_diff = tolerance\n\n        # Python's str(True) is 'True', not 'true'\n        # The output format requires a list, whose string representation is as needed.\n        final_results.append([gamma_bar, alpha_l, bool(within_tolerance)])\n\n    # Format the final output string as specified\n    # The str() of a list is \"[item1, item2, ...]\"\n    # The ','.join will put commas between these list strings.\n    # The outer f-string adds the final brackets.\n    # e.g., \"[[a,b,c],[d,e,f]]\"\n    output_str = f\"[{','.join(map(str, final_results))}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}