{
    "hands_on_practices": [
        {
            "introduction": "表面的演化速率通常取决于其局部几何特性，尤其是曲率。无论是弦方法还是单元法，都使用离散数据点或网格来描述表面，因此，如何从这些离散信息中准确地估算几何量是一项核心技能。本练习将引导您实践一种常用技术——通过局部二次函数拟合来计算曲率，并深入探讨这种方法在截断误差与噪声放大之间固有的权衡。",
            "id": "4170884",
            "problem": "在半导体刻蚀过程中一个演化表面的二维截面中，基于弦方法的离散化方法通过一系列有序点（“弦点”）来表示界面，这些点根据局部几何速度移动。在一个配套的基于单元格（Cell-Based）的方法中，场量存储在欧拉网格上，并通过采样来恢复弦的局部几何描述符。在某一特定时刻，考虑一个位于 $x=0$ 的弦点周围的局部邻域，在该邻域内，界面可以在一个小窗口中表示为图 $y(x)$。通过基于单元格的方法收集的三个相邻样本提供了以下数据，单位为纳米 (nm)：$(-10, 5.2)$、$(0, 5.0)$、$(10, 5.4)$。\n\n使用局部二次拟合 $y(x) = a x^{2} + b x + c$ 对这三个相邻点进行拟合，从平面曲线曲率的几何定义出发，计算弦点 $x=0$ 处的曲率 $\\kappa$。假设当界面局部向上凸时，曲率为正。将最终曲率以 $\\mathrm{nm}^{-1}$ 为单位表示，并将答案四舍五入到四位有效数字。\n\n然后，在均匀间距 $h$ 和足够光滑的 $y(x)$ 条件下，讨论该二次拟合曲率估计器的精度阶数，并分析在弦方法框架中其对点间距和测量噪声的敏感性。你的讨论必须从基本的几何定义和泰勒展开开始，并且必须明确地将估计器随 $h$ 的标度变化以及局部拟合的条件数与在曲率驱动的表面演化模型（例如在基于单元格和弦方法耦合中使用的方法）中预期的误差行为联系起来。",
            "solution": "该问题具有科学依据，提法恰当，客观，并包含了获得唯一解所需的所有信息。这是一个应用于计算物理的数值分析中的标准问题，因此是有效的。\n\n第一步是利用提供的三个数据点 $P_1(-10, 5.2)$、$P_2(0, 5.0)$ 和 $P_3(10, 5.4)$ 来确定局部二次拟合 $y(x) = a x^{2} + b x + c$ 的系数。坐标以纳米为单位，因此 $x$ 和 $y(x)$ 的单位是 $\\mathrm{nm}$。系数 $a$、$b$ 和 $c$ 的单位将分别为 $\\mathrm{nm}^{-1}$、无量纲和 $\\mathrm{nm}$。\n\n我们将每个点代入二次方程：\n1. 对于 $P_1(-10, 5.2)$：$y(-10) = a(-10)^{2} + b(-10) + c = 5.2$，简化为 $100a - 10b + c = 5.2$。\n2. 对于 $P_2(0, 5.0)$：$y(0) = a(0)^{2} + b(0) + c = 5.0$，得到 $c = 5.0$。\n3. 对于 $P_3(10, 5.4)$：$y(10) = a(10)^{2} + b(10) + c = 5.4$，简化为 $100a + 10b + c = 5.4$。\n\n将 $c = 5.0$ 代入 $P_1$ 和 $P_3$ 的方程中：\n1. $100a - 10b + 5.0 = 5.2 \\implies 100a - 10b = 0.2$\n2. $100a + 10b + 5.0 = 5.4 \\implies 100a + 10b = 0.4$\n\n这是一个关于 $a$ 和 $b$ 的二元线性方程组。将两个方程相加得到：\n$(100a - 10b) + (100a + 10b) = 0.2 + 0.4$\n$200a = 0.6$\n$a = \\frac{0.6}{200} = 0.003$\n\n从第二个方程中减去第一个方程得到：\n$(100a + 10b) - (100a - 10b) = 0.4 - 0.2$\n$20b = 0.2$\n$b = \\frac{0.2}{20} = 0.01$\n\n因此，界面的局部二次近似为：\n$y(x) = 0.003x^{2} + 0.01x + 5.0$\n\n对于以图 $y(x)$ 形式给出的平面曲线，其曲率 $\\kappa$ 的几何定义为：\n$$\\kappa(x) = \\frac{y''(x)}{\\left(1 + [y'(x)]^2\\right)^{3/2}}$$\n问题规定正曲率对应于向上凸的表面，这与该公式中 $y''(x)$ 为正时的符号约定相符。\n\n我们计算 $y(x)$ 的一阶和二阶导数：\n$y'(x) = \\frac{d}{dx}(0.003x^{2} + 0.01x + 5.0) = 0.006x + 0.01$\n$y''(x) = \\frac{d}{dx}(0.006x + 0.01) = 0.006$\n\n我们需要在弦点 $x=0$ 处计算曲率。首先，我们计算在 $x=0$ 处的导数值：\n$y'(0) = 0.006(0) + 0.01 = 0.01$\n$y''(0) = 0.006$\n\n现在，我们将这些值代入曲率公式：\n$\\kappa(0) = \\frac{y''(0)}{\\left(1 + [y'(0)]^2\\right)^{3/2}} = \\frac{0.006}{\\left(1 + (0.01)^2\\right)^{3/2}}$\n$\\kappa(0) = \\frac{0.006}{(1 + 0.0001)^{3/2}} = \\frac{0.006}{(1.0001)^{3/2}}$\n\n计算数值：\n$\\kappa(0) \\approx \\frac{0.006}{1.00015000375} \\approx 0.005999100049...$\n$x$ 和 $y$ 的单位是 $\\mathrm{nm}$，所以 $y'$ 是无量纲的，$y''$ 的单位是 $\\mathrm{nm}^{-1}$。因此，$\\kappa$ 的单位是 $\\mathrm{nm}^{-1}$。\n将结果四舍五入到四位有效数字，得到 $0.005999 \\, \\mathrm{nm}^{-1}$。\n\n接下来，我们讨论该方法的精度和敏感性。\n让我们考虑一个一般情况，从一个足够光滑的函数 $y(x)$ 在 $x_0-h$、$x_0$ 和 $x_0+h$ 处采样三个点。不失一般性，我们设 $x_0=0$。这些点是 $(-h, y_{-1})$、$(0, y_0)$ 和 $(h, y_1)$。通过这些点的二次拟合 $y_{fit}(x) = ax^2+bx+c$ 得到的系数为：\n$c = y_0$\n$b = \\frac{y_1 - y_{-1}}{2h}$\n$a = \\frac{y_1 - 2y_0 + y_{-1}}{2h^2}$\n\n在 $x=0$ 处的导数估计为：\n$y'_{est}(0) = b = \\frac{y_1 - y_{-1}}{2h}$\n$y''_{est}(0) = 2a = \\frac{y_1 - 2y_0 + y_{-1}}{h^2}$\n这些是一阶和二阶导数的标准二阶中心差分公式。\n\n为了分析精度阶数，我们使用 $y(x)$ 在 $x=0$ 附近的泰勒展开：\n$y(h) = y_1 = y(0) + y'(0)h + \\frac{1}{2}y''(0)h^2 + \\frac{1}{6}y'''(0)h^3 + \\frac{1}{24}y''''(0)h^4 + O(h^5)$\n$y(-h) = y_{-1} = y(0) - y'(0)h + \\frac{1}{2}y''(0)h^2 - \\frac{1}{6}y'''(0)h^3 + \\frac{1}{24}y''''(0)h^4 - O(h^5)$\n\n对于一阶导数估计器：\n$y'_{est}(0) = \\frac{1}{2h} [ (y(0) + y'(0)h + \\dots) - (y(0) - y'(0)h + \\dots) ] = \\frac{1}{2h} [2y'(0)h + \\frac{1}{3}y'''(0)h^3 + O(h^5)] = y'(0) + \\frac{1}{6}y'''(0)h^2 + O(h^4)$\n截断误差为 $y'_{est}(0) - y'(0) = O(h^2)$，因此该估计器是二阶精度的。\n\n对于二阶导数估计器：\n$y''_{est}(0) = \\frac{1}{h^2} [ (y(0) + \\dots) - 2y(0) + (y(0) - \\dots) ] = \\frac{1}{h^2} [ y''(0)h^2 + \\frac{1}{12}y''''(0)h^4 + O(h^6) ] = y''(0) + \\frac{1}{12}y''''(0)h^2 + O(h^4)$\n截断误差为 $y''_{est}(0) - y''(0) = O(h^2)$，因此这个估计器也是二阶精度的。\n\n由于两个导数估计器都是二阶精度的，只要 $y(x)$ 足够光滑（至少 $C^4$），得到的曲率估计器 $\\kappa_{est}$ 也将是二阶精度的，即 $\\kappa_{est} = \\kappa + O(h^2)$。\n\n现在，我们分析对测量噪声的敏感性。设测量的 y 值为 $\\tilde{y}_i = y_i + \\epsilon_i$，其中 $\\epsilon_i$ 是均值为 $0$、方差为 $\\sigma^2$ 的独立随机误差。由于此噪声导致的估计二阶导数误差为：\n$E_{y''} = \\frac{(\\tilde{y}_1 - 2\\tilde{y}_0 + \\tilde{y}_{-1})}{h^2} - y''_{est,true} = \\frac{\\epsilon_1 - 2\\epsilon_0 + \\epsilon_{-1}}{h^2}$\n该误差的方差为：\n$\\mathrm{Var}(E_{y''}) = \\frac{1}{h^4} \\mathrm{Var}(\\epsilon_1 - 2\\epsilon_0 + \\epsilon_{-1}) = \\frac{1}{h^4} (\\mathrm{Var}(\\epsilon_1) + 4\\mathrm{Var}(\\epsilon_0) + \\mathrm{Var}(\\epsilon_{-1})) = \\frac{\\sigma^2 + 4\\sigma^2 + \\sigma^2}{h^4} = \\frac{6\\sigma^2}{h^4}$\n因此，$y''$ 误差的标准差与 $\\sigma/h^2$ 成比例。类似地，$y'$ 误差的标准差与 $\\sigma/h$ 成比例。\n\n此分析揭示了在选择弦点间距 $h$ 时的一个关键权衡。\n1.  **截断误差**：为了最小化 $O(h^2)$ 的截断误差，必须选择一个小的 $h$。这对于精确解析表面的精细几何特征是必要的。\n2.  **噪声放大**：为了最小化测量噪声（例如，来自基于单元格网格的采样）的影响，必须选择一个大的 $h$。曲率的计算依赖于二阶导数，因此对噪声极其敏感，误差放大与 $1/h^2$ 成正比。\n\n这种权衡是数值微分的基础。当 $h$ 很小时，局部二次拟合的条件数很差，因为这些点变得几乎共线，使得二次项（`a`）的确定对 y 值的微小扰动高度敏感。这正是 $1/h^2$ 标度关系所反映的。\n\n在曲率驱动的表面演化模型的背景下，例如在耦合的弦方法/单元格法中使用的模型，这种敏感性具有深远的影响。弦点的法向速度通常与局部曲率成正比，$v_n \\propto \\kappa$。如果 $h$ 很小，弦点位置的任何微小噪声都将被极大地放大，导致计算出的曲率出现大的振荡误差。这些含噪的曲率值继而导致大的、含噪的速度，从而引起弦点不规则且不稳定的运动。这会破坏模拟界面的光滑性，并可能导致模拟失败。这是一种数值不稳定性。为了缓解这个问题，从业者通常采用正则化技术，例如使用更宽的模板（例如，5点拟合）、对弦点坐标或计算出的曲率值应用数字滤波器，或者使用更复杂的、通过变分推导出的、对噪声更鲁棒的曲率估计器。",
            "answer": "$$\\boxed{0.005999}$$"
        },
        {
            "introduction": "掌握了如何计算几何量后，下一步是将其应用于物理模型中。在半导体制造中，例如沉积和蚀刻等工艺，表面的局部朝向（由其法向量 $\\mathbf{n}$ 表示）主导了它与外部粒子通量 $\\mathbf{s}$ 的相互作用。本练习将此基本原理应用于一个物理气相沉积 (PVD) 场景，旨在推导出一个量化沉积层厚度不均匀性（即各向异性）的度量，从而将抽象的几何计算与具体的工艺结果联系起来。",
            "id": "4170893",
            "problem": "采用弦方法（带基于边缘的单位法向量的多边形小平面表示）和单元法（带从有向距离函数的梯度中提取法向量的基于网格的隐式曲面），对半导体晶圆中沟槽结构的二维横截面进行物理气相沉积（PVD）建模。考虑一个沟槽，其宽度相对于源准直锥较大，因此局部视线沉积占主导地位，且两侧壁均无遮挡。晶圆相对于源轴倾斜一个角度 $\\theta$，使得在沟槽横截面坐标系中表示的准直通量方向为 $\\mathbf{s} = (\\sin\\theta,\\cos\\theta)$。该沟槽具有对称的锥形侧壁，每个侧壁从垂直方向向内倾斜一个角度 $\\zeta$，因此右侧壁的单位法向量为 $\\mathbf{n}_{R} = (\\sin\\zeta,\\cos\\zeta)$，左侧壁的单位法向量为 $\\mathbf{n}_{L} = (-\\sin\\zeta,\\cos\\zeta)$，底部小平面的单位法向量为 $\\mathbf{n}_{B} = (0,1)$。粘附概率为1，且源产生一个恒定的定向粒子数通量密度 $F$。假设小平面上某一点的弹道沉积速率与通量在该小平面的局部单位法向量上的非负投影成正比，即 $R(\\mathbf{n}) \\propto \\max\\!\\big(0,\\,\\mathbf{s}\\cdot\\mathbf{n}\\big)$，这是基本的准直视线沉积定律。\n\n在这些条件下，并且使用弦方法或单元法在这些平面小平面上提供相同的局部单位法向量，每个小平面在沉积时间间隔 $\\tau$ 内的时间积分厚度与 $\\max\\!\\big(0,\\,\\mathbf{s}\\cdot\\mathbf{n}\\big)\\,\\tau$ 成正比。定义各向异性度量\n$$A(\\theta,\\zeta) \\equiv \\frac{T_{R} - T_{L}}{T_{B}},$$\n其中 $T_{R}$、$T_{L}$ 和 $T_{B}$ 分别是经过时间 $\\tau$ 后，在右侧壁、左侧壁和底部小平面上沉积的法向厚度。从基本弹道投影定律和给定的几何结构出发，推导 $A(\\theta,\\zeta)$ 的闭式解析表达式。该表达式在满足 $0  \\theta  \\frac{\\pi}{2}$ 和 $0  \\zeta  \\frac{\\pi}{2} - \\theta$ 的角度范围内有效，以确保所有三个小平面都被照亮而无遮挡，且 $\\mathbf{s}\\cdot\\mathbf{n}_{R} > 0$，$\\mathbf{s}\\cdot\\mathbf{n}_{L} > 0$ 及 $\\mathbf{s}\\cdot\\mathbf{n}_{B} > 0$。\n\n最终答案请用一个关于 $\\theta$ 和 $\\zeta$ 的单个闭式解析表达式表示，角度使用弧度。最终答案中不要包含单位。",
            "solution": "用户要求推导与沟槽中的物理气相沉积（PVD）过程相关的各向异性度量 $A(\\theta, \\zeta)$ 的闭式解析表达式。\n\n问题陈述已经过验证，被认为是有效的。它基于弹道输运和表面沉积的原理，具有科学依据；问题提法恰当，有足够的信息得到唯一解，并以客观、正式的语言表述。所提供的法向量，尽管伴随着对壁角可能含糊的文字描述，但在数学上是明确且一致的，从而为计算目的明确地定义了几何结构，没有歧义。\n\n求解过程如下。\n\n各向异性度量定义为：\n$$A(\\theta, \\zeta) \\equiv \\frac{T_{R} - T_{L}}{T_{B}}$$\n其中 $T_{R}$、$T_{L}$ 和 $T_{B}$ 分别代表在右侧壁、左侧壁和底部小平面上垂直生长的法向时间积分厚度。\n\n所提供的弹道沉积基本定律指出，来自方向为 $\\mathbf{s}$ 的准直通量在单位法向量为 $\\mathbf{n}$ 的表面上的沉积速率，与通量向量在法向量上的非负投影成正比。因此，在时间间隔 $\\tau$ 内的时间积分厚度 $T$ 与此投影成正比。我们可以用一个比例常数 $k$ 来写出这个关系：\n$$T(\\mathbf{n}) = k \\cdot \\max(0, \\mathbf{s} \\cdot \\mathbf{n})$$\n问题指定了角度约束 $0  \\theta  \\frac{\\pi}{2}$ 和 $0  \\zeta  \\frac{\\pi}{2} - \\theta$，这确保了点积 $\\mathbf{s}\\cdot\\mathbf{n}_R$、$\\mathbf{s}\\cdot\\mathbf{n}_L$ 和 $\\mathbf{s}\\cdot\\mathbf{n}_B$ 均为正值。因此，可以移除 $\\max(0, \\dots)$ 算子，每个小平面上的厚度与通量方向向量和小平面单位法向量的点积成正比。\n\n给定的向量是：\n通量方向：$\\mathbf{s} = (\\sin\\theta, \\cos\\theta)$\n右侧壁法向量：$\\mathbf{n}_{R} = (\\sin\\zeta, \\cos\\zeta)$\n左侧壁法向量：$\\mathbf{n}_{L} = (-\\sin\\zeta, \\cos\\zeta)$\n底部小平面法向量：$\\mathbf{n}_{B} = (0, 1)$\n\n现在我们计算每个小平面的点积。\n\n1.  右侧壁上的厚度 $T_R$：\n    $T_R = k \\, (\\mathbf{s} \\cdot \\mathbf{n}_R) = k \\, ((\\sin\\theta, \\cos\\theta) \\cdot (\\sin\\zeta, \\cos\\zeta))$\n    $T_R = k \\, (\\sin\\theta \\sin\\zeta + \\cos\\theta \\cos\\zeta)$\n    使用差角余弦的三角恒等式 $\\cos(A - B) = \\cos A \\cos B + \\sin A \\sin B$，我们令 $A=\\theta$ 和 $B=\\zeta$：\n    $T_R = k \\cos(\\theta - \\zeta)$\n\n2.  左侧壁上的厚度 $T_L$：\n    $T_L = k \\, (\\mathbf{s} \\cdot \\mathbf{n}_L) = k \\, ((\\sin\\theta, \\cos\\theta) \\cdot (-\\sin\\zeta, \\cos\\zeta))$\n    $T_L = k \\, (-\\sin\\theta \\sin\\zeta + \\cos\\theta \\cos\\zeta)$\n    使用和角余弦的三角恒等式 $\\cos(A + B) = \\cos A \\cos B - \\sin A \\sin B$，我们令 $A=\\theta$ 和 $B=\\zeta$：\n    $T_L = k \\cos(\\theta + \\zeta)$\n\n3.  底部小平面上的厚度 $T_B$：\n    $T_B = k \\, (\\mathbf{s} \\cdot \\mathbf{n}_B) = k \\, ((\\sin\\theta, \\cos\\theta) \\cdot (0, 1))$\n    $T_B = k \\, (\\sin\\theta \\cdot 0 + \\cos\\theta \\cdot 1)$\n    $T_B = k \\cos\\theta$\n\n现在，我们将 $T_R$、$T_L$ 和 $T_B$ 的这些表达式代入各向异性度量 $A(\\theta, \\zeta)$ 的定义中：\n$$A(\\theta, \\zeta) = \\frac{T_{R} - T_{L}}{T_{B}} = \\frac{k \\cos(\\theta - \\zeta) - k \\cos(\\theta + \\zeta)}{k \\cos\\theta}$$\n比例常数 $k$ 从分子和分母中消去：\n$$A(\\theta, \\zeta) = \\frac{\\cos(\\theta - \\zeta) - \\cos(\\theta + \\zeta)}{\\cos\\theta}$$\n\n为了简化分子，我们使用和差化积三角恒等式 $\\cos(X) - \\cos(Y) = -2 \\sin\\left(\\frac{X+Y}{2}\\right) \\sin\\left(\\frac{X-Y}{2}\\right)$。令 $X = \\theta - \\zeta$ 和 $Y = \\theta + \\zeta$。\n那么 $\\frac{X+Y}{2} = \\frac{(\\theta - \\zeta) + (\\theta + \\zeta)}{2} = \\frac{2\\theta}{2} = \\theta$，且 $\\frac{X-Y}{2} = \\frac{(\\theta - \\zeta) - (\\theta + \\zeta)}{2} = \\frac{-2\\zeta}{2} = -\\zeta$。\n分子变为：\n$\\cos(\\theta - \\zeta) - \\cos(\\theta + \\zeta) = -2 \\sin(\\theta) \\sin(-\\zeta)$\n由于 $\\sin(-\\zeta) = -\\sin(\\zeta)$，这可以简化为：\n$-2 \\sin(\\theta) (-\\sin(\\zeta)) = 2 \\sin\\theta \\sin\\zeta$\n\n将这个简化的分子代回 $A(\\theta, \\zeta)$ 的表达式中：\n$$A(\\theta, \\zeta) = \\frac{2 \\sin\\theta \\sin\\zeta}{\\cos\\theta}$$\n注意到 $\\frac{\\sin\\theta}{\\cos\\theta} = \\tan\\theta$，最终表达式为：\n$$A(\\theta, \\zeta) = 2 \\tan\\theta \\sin\\zeta$$\n这就是在给定条件和约束下，各向异性度量的闭式解析表达式。",
            "answer": "$$\\boxed{2 \\tan\\theta \\sin\\zeta}$$"
        },
        {
            "introduction": "在真实的工艺模拟中，一个至关重要的实现细节是处理演化中的表面与固定结构（如光刻胶掩模版）之间的相互作用。位于这些刚性边界上的点并非自由运动，而是受到特定物理约束的限制。本练习将引导您从第一性原理出发，为几种关键的边界条件（如“粘滞”和“滑移”）推导其运动学方程，并将其应用于代码实现中，这是构建一个稳健而精确的模拟器的基本功。",
            "id": "4170931",
            "problem": "考虑一个工艺模型中半导体特征的二维横截面，其中演化的材料表面由一组离散的点连接成段（一种“串”表示法）来表示，而其底层物理也可以在基于单元（有限体积）的框架中进行解释。在没有约束的情况下，每个表面点根据运动学定律 $$\\dot{\\mathbf{x}} = V_n \\,\\mathbf{n}_s,$$ 演化，其中 $\\mathbf{x}$ 是位置，$V_n$ 是局部法向速度（例如，由蚀刻或沉积引起），$\\mathbf{n}_s$ 是该点处表面的单位法向量。对于附着在刚性掩模边缘的点，其运动必须满足边界约束。两种具有物理意义的情况是：\n\n- 无运动（完全粘附）：该点保持固定，满足 $$\\dot{\\mathbf{x}} = \\mathbf{0}.$$\n- 沿刚性掩模边缘受约束的滑移：该点只允许沿着掩模边缘切线 $\\mathbf{t}_m$（单位向量）移动，并且不能穿过掩模，此条件由掩模边缘法线 $\\mathbf{m}_n$（单位向量）来表征，强制执行 $$\\mathbf{m}_n \\cdot \\dot{\\mathbf{x}} = 0.$$ 滑移速度可以是在无约束速度在掩模切线上的投影，也可以是沿 $\\mathbf{t}_m$ 的指定滑移速率 $u_t$。\n\n在掩模角点处，两条刚性掩模边缘在此相交，其法线分别为 $\\mathbf{m}_{n,1}$ 和 $\\mathbf{m}_{n,2}$，切线分别为 $\\mathbf{t}_{m,1}$ 和 $\\mathbf{t}_{m,2}$，容许的运动子空间是两个切线方向的交集。在二维空间中，该交集通常是平凡的（零向量），因此得到 $$\\dot{\\mathbf{x}} = \\mathbf{0}.$$\n\n从基本运动学定律 $$\\dot{\\mathbf{x}} = V_n \\,\\mathbf{n}_s,$$ 以及刚性边界的完整约束公式 $$\\mathbf{m}_n \\cdot \\dot{\\mathbf{x}} = 0,$$ 出发，根据约束运动的第一性原理，推导在以下情况下计算边界串点的受约束速度 $\\dot{\\mathbf{x}}$ 的公式：\n1. 完全粘附于刚性掩模。\n2. 沿掩模边缘受约束的滑移，其速度由无约束速度在 $\\mathbf{t}_m$ 上的投影给出。\n3. 沿掩模边缘受约束的滑移，其滑移速率为沿 $\\mathbf{t}_m$ 的指定值 $u_t$。\n4. 两条刚性边缘相交的掩模角点。\n\n然后，在一个程序中实现这些约束，对于每个测试用例，使用给定的时间步长 $\\Delta t$ 计算更新后的位置 $$\\mathbf{x}_{\\text{new}} = \\mathbf{x} + \\dot{\\mathbf{x}}\\,\\Delta t$$，并验证约束在数值容差范围内是否得到满足。将所有向量视为二维向量，并假设所有输入均使用国际单位制（SI 单位）。您必须：\n- 位置以米表示，速度以米/秒表示，时间以秒表示。\n- 仅通过提供的向量隐式使用角度；不要显式计算或要求角度。\n- 将任何旨在作为单位向量的输入向量进行归一化。\n- 使用 $10^{-12}$ 的数值容差进行约束验证。\n\n您的程序必须解决以下测试用例集：\n- 用例 A（粘附）：$\\mathbf{x} = [5.0\\times 10^{-7},\\,2.0\\times 10^{-7}]$，$V_n = 4.0\\times 10^{-8}$，$\\mathbf{n}_s = [0,\\,1]$，$\\mathbf{t}_m = [1,\\,0]$，$\\mathbf{m}_n = [0,\\,1]$，类型 = \"stick\"，$\\Delta t = 0.1$。\n- 用例 B（投影滑移）：$\\mathbf{x} = [0.0,\\,0.0]$，$V_n = 1.0\\times 10^{-7}$，$\\mathbf{n}_s = [1/\\sqrt{2},\\,1/\\sqrt{2}]$，$\\mathbf{t}_m = [\\sqrt{3}/2,\\,1/2]$，$\\mathbf{m}_n = [-1/2,\\,\\sqrt{3}/2]$，类型 = \"slip_projected\"，$\\Delta t = 0.2$。\n- 用例 C（指定滑移）：$\\mathbf{x} = [1.0\\times 10^{-6},\\,0.0]$，$V_n = 2.0\\times 10^{-8}$，$\\mathbf{n}_s = [1,\\,0]$，$\\mathbf{t}_m = [0,\\,1]$，$\\mathbf{m}_n = [1,\\,0]$，类型 = \"slip_specified\"，$u_t = 1.2\\times 10^{-7}$，$\\Delta t = 0.05$。\n- 用例 D（角点，无运动）：$\\mathbf{x} = [1.0\\times 10^{-7},\\,1.0\\times 10^{-7}]$，$V_n = 2.0\\times 10^{-7}$，$\\mathbf{n}_s = [1/\\sqrt{2},\\,-1/\\sqrt{2}]$，$\\mathbf{t}_{m,1} = [1,\\,0]$，$\\mathbf{m}_{n,1} = [0,\\,1]$，$\\mathbf{t}_{m,2} = [0,\\,1]$，$\\mathbf{m}_{n,2} = [1,\\,0]$，类型 = \"corner\"，$\\Delta t = 0.05$。\n- 用例 E（使用非单位切线进行投影，需要归一化）：$\\mathbf{x} = [-2.0\\times 10^{-6},\\,3.0\\times 10^{-6}]$，$V_n = 2.0\\times 10^{-7}$，$\\mathbf{n}_s = [1,\\,0]$，$\\mathbf{t}_m = [2,\\,0]$ (注意：非单位长度)，$\\mathbf{m}_n = [0,\\,1]$，类型 = \"slip_projected\"，$\\Delta t = 0.05$。\n\n对于每个用例，计算：\n- 更新后的位置 $\\mathbf{x}_{\\text{new}}$，以米为单位，形式为列表 $[x_{\\text{new}}, y_{\\text{new}}]$。\n- 一个布尔值，指示强制约束是否在 $10^{-12}$ 的容差范围内得到满足。\n\n您的程序应生成单行输出，包含所有五个用例的结果，形式为逗号分隔的列表并用方括号括起，其中每个元素是 $[x_{\\text{new}}, y_{\\text{new}}, \\text{constraint\\_ok}]$ 形式的列表。例如：“[[x1,y1,True],[x2,y2,False],...]”。",
            "solution": "该问题要求推导刚性掩模边界处表面点的受约束速度公式，然后进行数值实现。所有情况的出发点是无约束的表面点速度，由运动学定律给出：\n$$\n\\dot{\\mathbf{x}}_u = V_n \\mathbf{n}_s\n$$\n其中 $\\dot{\\mathbf{x}}_u$ 是无约束速度向量，$V_n$ 是局部法向速度，$\\mathbf{n}_s$ 是点 $\\mathbf{x}$ 处表面的单位法向量。所有向量都视为二维向量，即 $\\mathbf{v} = [v_x, v_y]$。当一个点位于刚性掩模边界上时，其运动会受到约束。该约束表示为对速度的完整约束：\n$$\n\\mathbf{m}_n \\cdot \\dot{\\mathbf{x}}_c = 0\n$$\n其中 $\\dot{\\mathbf{x}}_c$ 是受约束的速度，$\\mathbf{m}_n$ 是掩模的单位法向量，指向远离容许运动区域的方向。此条件确保该点不会“穿过”掩模。从几何上讲，这意味着受约束的速度 $\\dot{\\mathbf{x}}_c$ 必须与掩模边缘平行，其方向由单位切向量 $\\mathbf{t}_m$ 给出。在二维中，$\\mathbf{t}_m$ 和 $\\mathbf{m}_n$ 是正交的，因此 $\\mathbf{t}_m \\cdot \\mathbf{m}_n = 0$。\n\n我们现在将为四个指定情况中的每一种推导受约束速度 $\\dot{\\mathbf{x}}_c$ 的表达式。\n\n**情况 1：完全粘附于刚性掩模**\n\n这是最简单的情况。问题陈述将此条件定义为“无运动”。这对应于速度上的狄利克雷边界条件。因此，受约束的速度是零向量：\n$$\n\\dot{\\mathbf{x}}_c = \\mathbf{0}\n$$\n约束 $\\mathbf{m}_n \\cdot \\dot{\\mathbf{x}}_c = 0$ 被平凡满足，因为 $\\mathbf{m}_n \\cdot \\mathbf{0} = 0$。物理上的解释是，该点完全粘附在掩模上，无论无约束表面演化速度 $V_n$ 如何，都不能移动。经过一个时间步长 $\\Delta t$ 后的新位置就是原始位置：$\\mathbf{x}_{\\text{new}} = \\mathbf{x} + \\mathbf{0} \\cdot \\Delta t = \\mathbf{x}$。\n\n**情况 2：沿掩模边缘受约束的滑移（投影速度）**\n\n在这种情况下，该点可以沿掩模边缘自由滑动。速度被约束为与掩模切线 $\\mathbf{t}_m$ 平行。问题指定速度的大小和方向由无约束速度 $\\dot{\\mathbf{x}}_u$ 在切线方向 $\\mathbf{t}_m$ 上的投影确定。\n\n向量 $\\mathbf{v}$ 在单位向量 $\\mathbf{u}$ 上的投影由公式 $(\\mathbf{v} \\cdot \\mathbf{u})\\mathbf{u}$ 给出。将此应用于我们的问题，受约束的速度 $\\dot{\\mathbf{x}}_c$ 是 $\\dot{\\mathbf{x}}_u$ 在 $\\mathbf{t}_m$ 上的投影：\n$$\n\\dot{\\mathbf{x}}_c = (\\dot{\\mathbf{x}}_u \\cdot \\mathbf{t}_m) \\mathbf{t}_m\n$$\n代入 $\\dot{\\mathbf{x}}_u = V_n \\mathbf{n}_s$，我们得到：\n$$\n\\dot{\\mathbf{x}}_c = ( (V_n \\mathbf{n}_s) \\cdot \\mathbf{t}_m ) \\mathbf{t}_m = V_n (\\mathbf{n}_s \\cdot \\mathbf{t}_m) \\mathbf{t}_m\n$$\n根据构造，该速度向量是 $\\mathbf{t}_m$ 的标量倍数。不穿过掩模的约束得到满足，因为 $\\mathbf{t}_m$ 与 $\\mathbf{m}_n$ 正交：\n$$\n\\mathbf{m}_n \\cdot \\dot{\\mathbf{x}}_c = \\mathbf{m}_n \\cdot (V_n (\\mathbf{n}_s \\cdot \\mathbf{t}_m) \\mathbf{t}_m) = V_n (\\mathbf{n}_s \\cdot \\mathbf{t}_m) (\\mathbf{m}_n \\cdot \\mathbf{t}_m) = V_n (\\mathbf{n}_s \\cdot \\mathbf{t}_m) (0) = 0\n$$\n\n**情况 3：沿掩模边缘受约束的滑移（指定滑移速率）**\n\n与前一种情况类似，运动被约束在掩模切线 $\\mathbf{t}_m$ 的方向上。但是，其大小不是由投影确定，而是由一个指定的滑移速率 $u_t$ 给出。沿切线的滑移方向（+$\\mathbf{t}_m$ 或 -$\\mathbf{t}_m$）由无约束速度沿切线的分量决定。如果无约束速度沿 $\\mathbf{t}_m$ 有正分量，则该点沿 $\\mathbf{t}_m$ 方向滑移；如果分量为负，则沿与 $\\mathbf{t}_m$ 相反的方向滑移。\n\n$\\dot{\\mathbf{x}}_u$ 沿 $\\mathbf{t}_m$ 的带符号分量由点积 $\\dot{\\mathbf{x}}_u \\cdot \\mathbf{t}_m$ 给出。因此，滑移方向为 $\\text{sign}(\\dot{\\mathbf{x}}_u \\cdot \\mathbf{t}_m) \\mathbf{t}_m$，其中 $\\text{sign}$ 函数返回 $+1$、$-1$ 或 $0$。速度是速率 $u_t$ 乘以该方向向量：\n$$\n\\dot{\\mathbf{x}}_c = u_t \\cdot \\text{sign}(\\dot{\\mathbf{x}}_u \\cdot \\mathbf{t}_m) \\mathbf{t}_m\n$$\n代入 $\\dot{\\mathbf{x}}_u = V_n \\mathbf{n}_s$：\n$$\n\\dot{\\mathbf{x}}_c = u_t \\cdot \\text{sign}((V_n \\mathbf{n}_s) \\cdot \\mathbf{t}_m) \\mathbf{t}_m\n$$\n如果无约束速度的切向分量为零，即 $(\\dot{\\mathbf{x}}_u \\cdot \\mathbf{t}_m) = 0$，则 $\\text{sign}(0)=0$，滑移速度为零。约束 $\\mathbf{m}_n \\cdot \\dot{\\mathbf{x}}_c = 0$ 的满足逻辑与情况 2 相同，因为 $\\dot{\\mathbf{x}}_c$ 平行于 $\\mathbf{t}_m$。\n\n**情况 4：掩模角点**\n\n在角点处，该点同时位于两条不同的掩模边缘上。这些边缘具有不同的单位法向量 $\\mathbf{m}_{n,1}$ 和 $\\mathbf{m}_{n,2}$，以及不同的单位切向量 $\\mathbf{t}_{m,1}$ 和 $\\mathbf{t}_{m,2}$。为使该点保持在两条边缘上，其速度 $\\dot{\\mathbf{x}}_c$ 必须同时满足两个约束条件：\n$$\n\\mathbf{m}_{n,1} \\cdot \\dot{\\mathbf{x}}_c = 0 \\quad \\text{和} \\quad \\mathbf{m}_{n,2} \\cdot \\dot{\\mathbf{x}}_c = 0\n$$\n第一个条件意味着 $\\dot{\\mathbf{x}}_c$ 必须与 $\\mathbf{t}_{m,1}$ 平行（因为在此上下文中 $\\mathbf{t}_{m,1}$ 是 $\\mathbf{m}_{n,1}$ 的零空间）。第二个条件意味着 $\\dot{\\mathbf{x}}_c$ 也必须与 $\\mathbf{t}_{m,2}$ 平行。\n因此，必须存在标量 $k_1$ 和 $k_2$ 使得：\n$$\n\\dot{\\mathbf{x}}_c = k_1 \\mathbf{t}_{m,1} \\quad \\text{和} \\quad \\dot{\\mathbf{x}}_c = k_2 \\mathbf{t}_{m,2}\n$$\n这要求 $k_1 \\mathbf{t}_{m,1} = k_2 \\mathbf{t}_{m,2}$。在二维空间中，如果向量 $\\mathbf{t}_{m,1}$ 和 $\\mathbf{t}_{m,2}$ 是线性无关的（即不平行，这对于任何真正的角点都成立），则此方程的唯一解是平凡解：$k_1 = 0$ 和 $k_2 = 0$。\n因此，唯一可能的受约束速度是零向量：\n$$\n\\dot{\\mathbf{x}}_c = \\mathbf{0}\n$$\n这实际上是由角点的几何形状施加的“粘附”条件。两个边界约束都被平凡满足。",
            "answer": "```python\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Solves for the updated position and constraint satisfaction for several test cases\n    of a surface point evolution under different boundary conditions.\n    \"\"\"\n\n    # Numerical tolerance for constraint verification\n    TOL = 1e-12\n\n    # Test suite definition\n    test_cases = [\n        {\n            'name': 'Case A (sticking)',\n            'type': 'stick',\n            'x': np.array([5.0e-7, 2.0e-7]),\n            'Vn': 4.0e-8,\n            'ns': np.array([0.0, 1.0]),\n            'tm': np.array([1.0, 0.0]),\n            'mn': np.array([0.0, 1.0]),\n            'dt': 0.1\n        },\n        {\n            'name': 'Case B (slip via projection)',\n            'type': 'slip_projected',\n            'x': np.array([0.0, 0.0]),\n            'Vn': 1.0e-7,\n            'ns': np.array([1/math.sqrt(2), 1/math.sqrt(2)]),\n            'tm': np.array([math.sqrt(3)/2, 1/2]),\n            'mn': np.array([-1/2, math.sqrt(3)/2]),\n            'dt': 0.2\n        },\n        {\n            'name': 'Case C (specified slip)',\n            'type': 'slip_specified',\n            'x': np.array([1.0e-6, 0.0]),\n            'Vn': 2.0e-8,\n            'ns': np.array([1.0, 0.0]),\n            'tm': np.array([0.0, 1.0]),\n            'mn': np.array([1.0, 0.0]),\n            'ut': 1.2e-7,\n            'dt': 0.05\n        },\n        {\n            'name': 'Case D (corner, no motion)',\n            'type': 'corner',\n            'x': np.array([1.0e-7, 1.0e-7]),\n            'Vn': 2.0e-7,\n            'ns': np.array([1/math.sqrt(2), -1/math.sqrt(2)]),\n            't_m1': np.array([1.0, 0.0]),\n            'm_n1': np.array([0.0, 1.0]),\n            't_m2': np.array([0.0, 1.0]),\n            'm_n2': np.array([1.0, 0.0]),\n            'dt': 0.05\n        },\n        {\n            'name': 'Case E (projection with non-unit tangent)',\n            'type': 'slip_projected',\n            'x': np.array([-2.0e-6, 3.0e-6]),\n            'Vn': 2.0e-7,\n            'ns': np.array([1.0, 0.0]),\n            'tm': np.array([2.0, 0.0]), # Not unit length\n            'mn': np.array([0.0, 1.0]),\n            'dt': 0.05\n        }\n    ]\n\n    results = []\n\n    def normalize(v):\n        \"\"\"Normalizes a 2D numpy vector, handling the zero vector case.\"\"\"\n        norm = np.linalg.norm(v)\n        if norm == 0:\n            return v\n        return v / norm\n\n    for case in test_cases:\n        v_c = np.array([0.0, 0.0])\n        constraint_ok = False\n\n        # --- Calculate Constrained Velocity ---\n\n        if case['type'] == 'stick':\n            # Velocity is zero for a sticking point.\n            v_c = np.array([0.0, 0.0])\n            # Constraint verification based on velocity magnitude.\n            constraint_ok = np.linalg.norm(v_c) = TOL\n        \n        elif case['type'] == 'corner':\n            # Velocity is zero for a corner point.\n            v_c = np.array([0.0, 0.0])\n            m_n1 = normalize(case['m_n1'])\n            m_n2 = normalize(case['m_n2'])\n            # Verify both holonomic constraints.\n            check1 = abs(np.dot(m_n1, v_c)) = TOL\n            check2 = abs(np.dot(m_n2, v_c)) = TOL\n            constraint_ok = check1 and check2\n\n        elif case['type'] == 'slip_projected':\n            ns = normalize(case['ns'])\n            tm = normalize(case['tm'])\n            mn = normalize(case['mn'])\n            Vn = case['Vn']\n            \n            v_u = Vn * ns\n            v_c = np.dot(v_u, tm) * tm\n            \n            # Verify the holonomic constraint.\n            constraint_ok = abs(np.dot(mn, v_c)) = TOL\n\n        elif case['type'] == 'slip_specified':\n            ns = normalize(case['ns'])\n            tm = normalize(case['tm'])\n            mn = normalize(case['mn'])\n            Vn = case['Vn']\n            ut = case['ut']\n            \n            v_u = Vn * ns\n            tangential_comp = np.dot(v_u, tm)\n            \n            v_c = ut * np.sign(tangential_comp) * tm\n            \n            # Verify the holonomic constraint.\n            constraint_ok = abs(np.dot(mn, v_c)) = TOL\n\n        # --- Update Position and Store Result ---\n        \n        x = case['x']\n        dt = case['dt']\n        x_new = x + v_c * dt\n        \n        results.append([x_new[0], x_new[1], constraint_ok])\n\n    # Format the output string to match the required format precisely,\n    # without spaces inside the inner lists.\n    formatted_results = [str(r).replace(\" \", \"\") for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}