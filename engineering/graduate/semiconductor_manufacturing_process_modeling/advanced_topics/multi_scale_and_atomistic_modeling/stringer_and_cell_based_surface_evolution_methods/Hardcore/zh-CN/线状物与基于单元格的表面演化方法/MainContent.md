## 引言
在[半导体制造](@entry_id:187383)迈向纳米尺度的征程中，精确预测和控制[薄膜沉积](@entry_id:1133096)与材料蚀刻过程中的三维形貌演变，已成为技术发展的关键。无论是构建复杂的晶体管结构还是挖掘高深宽比的沟槽，其核心挑战都在于如何对动态变化的[材料界面](@entry_id:751731)进行可靠的追踪和模拟。这一需求催生了功能强大的工艺仿真工具，而这些工具的基石便是一套成熟的表面演化数值方法。

本文旨在系统性地剖析两种主流的表面演化技术：基于串（Stringer）的拉格朗日方法和基于单元（Cell-based）的欧拉方法。尽管这两种方法在实现上截然不同，但它们共同面临着在保真度、鲁棒性和[计算效率](@entry_id:270255)之间取得平衡的难题。本文将填补理论与实践之间的鸿沟，为读者提供一个关于这两种方法从底层原理到高层应用的全面视角。

在接下来的内容中，我们将通过三个章节逐步深入：
-   在 **“原理与机制”** 一章中，我们将从一个统一的运动学框架出发，揭示这两种方法如何作为同一物理定律的不同数值体现。我们将深入探讨它们各自的数据结构、[演化算法](@entry_id:637616)、核心优势（如尖锐特征的保持）以及固有的挑战（如[拓扑变化](@entry_id:136654)的处理和[数值扩散](@entry_id:136300)）。
-   在 **“应用与跨学科连接”** 一章中，我们将展示这些方法如何应用于解决先进半导体工艺中的具体工程问题，例如预测“串”的形成和优化多步蚀刻流程。此外，我们还将拓宽视野，探讨这些数值思想与[计算流体力学](@entry_id:747620)、结构[拓扑优化](@entry_id:147162)和计算生物学等领域的深刻联系。
-   最后，在 **“动手实践”** 部分，我们设计了一系列编程练习，帮助读者将理论知识转化为实践技能，亲手解决曲率计算、边界条件处理和拓扑[事件检测](@entry_id:162810)等关键问题。

通过本次学习，读者将不仅掌握表面演化方法的核心技术，更能理解其在广阔科学与工程领域中的普适价值。

## 原理与机制

在[半导体制造](@entry_id:187383)工艺的特征尺度仿真中，无论是通过蚀刻去除材料还是通过沉积添加材料，其核心都是对演化中的材料界面的几何形状进行精确追踪。本章将深入探讨用于描述这种演变的两类主流数值方法的核心原理与机制：基于串（stringer）的[拉格朗日方法](@entry_id:142825)和基于单元（cell-based）的欧拉方法。我们将从一个统一的运动学框架出发，揭示这两种方法如何作为同一基本物理定律的不同[数值近似](@entry_id:161970)，并详细剖析它们各自的优势、固有的局限性以及在实际应用中为确保鲁棒性和准确性所需采用的关键技术。

### 统一运动学框架：几何[偏微分](@entry_id:194612)方程

无论采用何种[数值表示](@entry_id:138287)，材料界面的演化都遵循一个基本的运动学原理：界面上任意一点的运动仅由其在该点的**法向速度**（normal velocity）$V_n$ 决定。这个法向速度由具体的[物理化学](@entry_id:145220)过程决定，例如入射粒子通量、[表面反应动力学](@entry_id:155104)以及视线遮蔽效应。我们可以用一个隐式函数 $\phi(\mathbf{x}, t)$ 来描述整个空间，其中界面 $\Gamma(t)$ 被定义为该函数的**零[等值面](@entry_id:196027)**（zero level set），即 $\Gamma(t) = \{ \mathbf{x} | \phi(\mathbf{x}, t) = 0 \}$。

对于一个始终停留在界面上的点 $\mathbf{x}(t)$，我们有 $\phi(\mathbf{x}(t), t) = 0$。根据多元微积分的[链式法则](@entry_id:190743)，对时间求导可得：
$$ \frac{d}{dt} \phi(\mathbf{x}(t), t) = \frac{\partial \phi}{\partial t} + \nabla \phi \cdot \frac{d\mathbf{x}}{dt} = 0 $$
其中 $\frac{d\mathbf{x}}{dt}$ 是该点的速度。由于界面的[几何演化](@entry_id:636861)完全由法向速度 $V_n$ 驱动，我们可以将点的速度设为 $\frac{d\mathbf{x}}{dt} = V_n \mathbf{n}$，这里的 $\mathbf{n}$ 是界面的[单位法向量](@entry_id:178851)。对于[隐式曲面](@entry_id:1126421)，[法向量](@entry_id:264185)可以由 $\phi$ 的梯度得到：$\mathbf{n} = \nabla \phi / |\nabla \phi|$。将这些关系代入[链式法则](@entry_id:190743)的表达式中，我们得到：
$$ \frac{\partial \phi}{\partial t} + \nabla \phi \cdot \left( V_n \frac{\nabla \phi}{|\nabla \phi|} \right) = 0 $$
整理后，便得到了描述[界面演化](@entry_id:750730)的核心几何[偏微分](@entry_id:194612)方程，即**[水平集方程](@entry_id:142449)**（Level Set Equation）：
$$ \frac{\partial \phi}{\partial t} + V_n |\nabla \phi| = 0 $$
这个方程属于**[哈密顿-雅可比方程](@entry_id:145701)**（Hamilton-Jacobi equation）的一种。它提供了一个描述[界面运动](@entry_id:1126592)的欧拉视角。从根本上说，所有用于表面演化的数值方法，无论是基于串还是基于单元，都可以被视为求解这一基本运动学定律的不同数值方案 。

### [拉格朗日方法](@entry_id:142825)：串追踪法

拉格朗日方法，在二维情况下常被称为**串追踪法**（string method or stringer method），采用一种显式、随体移动的方式来描述界面。

#### 表示与演化

在这种方法中，二维界面被离散化为一系列有序的**节点**（nodes）或**顶点**（vertices）$\{\mathbf{x}_i(t)\}_{i=1}^N$，这些节点通过**边**（edges）或**段**（segments）连接起来，形成一条[分段线性](@entry_id:201467)折线（polyline），作为真实界面的近似。在三维情况下，则是由三角形面片构成的表面网格 。

界面的演化通过更新每个节点的位置来实现。每个节点 $\mathbf{x}_i$ 的运动都遵循一个常微分方程（ODE），这是对前述运动学定律的拉格朗日诠释：
$$ \frac{d\mathbf{x}_i}{dt} = V_n(\mathbf{x}_i, t)\,\mathbf{n}_i $$
其中 $\mathbf{n}_i$ 是在节点 $\mathbf{x}_i$ 处的[单位法向量](@entry_id:178851)的估计值。通过数值积分（如[显式欧拉法](@entry_id:1124769)），节点位置在每个时间步进 $\Delta t$ 内得到更新：$\mathbf{x}_i^{n+1} = \mathbf{x}_i^n + V_n(\mathbf{x}_i^n, t_n)\,\mathbf{n}_i^n \Delta t$。

#### 优势：高保真度的尖锐特征

串方法的一个主要优势在于其能够以高保真度表示和维持**尖锐特征**（sharp features），如角点和晶面。在[晶体生长](@entry_id:136770)或各向异性蚀刻等工艺中，材料的生长或去除速率 $R$ 强烈依赖于表面朝向 $\mathbf{n}$。当 $R(\mathbf{n})$ 存在[尖点](@entry_id:636792)（cusps）时，宏观上就会形成稳定的晶面和尖锐的棱角。串方法通过直接移动节点来演化界面，其表示方式本身不引入额外的平滑或曲率项。因此，它能够自然地维持由分段常数法向量构成的尖锐角点，其精度仅受节点间距 $\Delta s$ 的限制。这与将在后面讨论的基于单元的方法形成鲜明对比，后者往往会因数值效应而使角点变得圆滑 。

#### 挑战：[拓扑变化](@entry_id:136654)与网格管理

串方法的“阿喀琉斯之踵”在于处理**拓扑变化**（topological changes）。由于节点的连接关系是显式存储的（例如，通过[邻接表](@entry_id:266874)），当两个分离的界面部分相互靠近并需要**合并**（merging），或者一个界面因“[颈缩](@entry_id:183657)”而需要**断开**（pinching-off）时，标准的节点更新算法无法自动完成这些操作。

为了实现[拓扑变化](@entry_id:136654)，算法必须包含复杂的**计算几何**（computational geometry）逻辑。这通常包括：
1.  **邻近检测**：持续监控非相邻线段之间的最小距离 $d_{\min}$。
2.  **拓扑操作**：当 $d_{\min}$ 小于某个阈值时，执行显式的“网格手术”（mesh surgery），如删除、合并节点和边，以改变多段线的连接结构 。

除了[拓扑变化](@entry_id:136654)的复杂性，串方法还面临着维持网格质量的挑战。在剧烈的[速度梯度](@entry_id:261686)下，节点可能会聚集在某些区域，而在另一些区域则变得稀疏，甚至可能发生线段**翻转**（inversion）或多段线**自相交**（tangling）等数值灾难 。为了防止这种情况，必须采用鲁棒的网格管理策略。

一个关键策略是**[自适应时间步长](@entry_id:1120783)**（adaptive time-stepping）。为防止节点在一个时间步[内移](@entry_id:265618)动得“太远”而导致几何错误，时间步长 $\Delta t$ 必须受到严格限制。典型的约束条件包括：
- **点位移约束**：每个点的位移不能超过其局部空间尺寸的某个比例。局部空间尺寸 $\ell_i$ 通常定义为相邻线段长度的平均值。该约束可表示为：$\|\mathbf{v}_i\|_2 \Delta t \le \gamma \ell_i$，其中 $\gamma \in (0, 1)$ 是一个安全因子。
- **线段长度变化约束**：每条线段的长度变化率也应受到限制。线段 $i$（连接点 $i$ 和 $i+1$）的长度变化率可写作 $\frac{dL_i}{dt} = (\mathbf{v}_{i+1} - \mathbf{v}_i) \cdot \hat{\mathbf{d}}_i$，其中 $\hat{\mathbf{d}}_i$ 是线段的[单位向量](@entry_id:165907)。为防止线段过度压缩或拉伸，约束为：$|(\mathbf{v}_{i+1} - \mathbf{v}_i) \cdot \hat{\mathbf{d}}_i| \Delta t \le \delta L_i$，其中 $\delta \in (0, 1)$ 是另一个安全因子。
- **[碰撞检测](@entry_id:177855)约束**：为确保能够可靠地检测到即将发生的碰撞（[拓扑变化](@entry_id:136654)），时间步长必须确保没有任何两个非相邻部分能在一个步长时间内相互穿越。这引出了另一个约束：$V_{\max} \Delta t  \eta \, d_{\min}$，其中 $V_{\max}$ 是最大法向速度，$d_{\min}$ 是非相邻部分间的最小距离，$\eta \in (0, 1)$ 是安全因子 。

最终的[自适应时间步长](@entry_id:1120783) $\Delta t_{\text{adapt}}$ 需要取所有这些约束下允许的最大时间步长中的最小值，以确保整个演化过程的几何鲁棒性 。

### 欧拉方法：基于单元的捕获法

与[拉格朗日方法](@entry_id:142825)不同，欧拉方法，通常称为**基于单元的方法**（cell-based method）或**界面捕获法**（interface capturing method），是在一个固定的空间网格上进行计算，界面本身则被“捕获”为某个标量场的特定等值面。

#### 表示与演化

在这种范式中，计算域被划分为一个固定的网格（通常是笛卡尔网格）。界面不是由移动的点来追踪，而是被隐式地定义。最流行的方法是**水平集方法**（Level Set Method, LSM），它使用一个[标量场](@entry_id:151443) $\phi(\mathbf{x}, t)$，称为**水平集函数**，该函数在空间中每一点的值表示该点到最近界面的**有符号距离**（signed distance）。按照约定，$\phi  0$ 在材料内部，$\phi > 0$ 在材料外部，而界面本身就是 $\phi=0$ 的零[等值面](@entry_id:196027) 。

界面的演化被转化为在整个固定网格上求解[水平集方程](@entry_id:142449) $\frac{\partial \phi}{\partial t} + V_n |\nabla \phi| = 0$ 的问题。这个方程的求解通常采用为[双曲守恒律](@entry_id:147752)发展的**[有限差分](@entry_id:167874)**（finite difference）或**有限体积**（finite volume）方法。

从网格上的 $\phi$ 场中提取界面信息是这种方法的基础。例如，要找到界面与某条网格边的交点，可以通过在该边两端点的值 $\phi_0$ 和 $\phi_1$ 之间进行线性插值。交点参数 $t^\star \in [0, 1]$ 满足 $(1-t^\star)\phi_0 + t^\star\phi_1 = 0$，从而得到 $t^\star = \phi_0 / (\phi_0 - \phi_1)$。界面的[法向量](@entry_id:264185)则直接通过计算 $\phi$ 的梯度得到：$\mathbf{n} = \nabla\phi / |\nabla\phi|$。

让我们通过一个具体的计算示例来阐明这些基本操作。假设在一个二维仿真中，[水平集](@entry_id:751248)函数为 $\phi(x,y) = x^{2} + y^{2} - R^{2}$，其中 $R^2 = 51/25$。我们希望找到界面穿过连接点 $\mathbf{p}_{0} = (1, 1/5)$ 和 $\mathbf{p}_{1} = (2, 1/5)$ 的网格边的位置及该点的法向量。
首先，计算 $\phi$ 在两个端点的值：
$$ \phi_0 = \phi(1, 1/5) = 1^2 + (1/5)^2 - 51/25 = 1 + 1/25 - 51/25 = -1 $$
$$ \phi_1 = \phi(2, 1/5) = 2^2 + (1/5)^2 - 51/25 = 4 + 1/25 - 51/25 = 2 $$
由于两端点值的符号相反，界面必然穿过该边。使用[线性插值](@entry_id:137092)，我们求得交点参数 $t^\star = \frac{\phi_0}{\phi_0 - \phi_1} = \frac{-1}{-1 - 2} = \frac{1}{3}$。
交点坐标 $\mathbf{x}^\star$ 为：
$$ \mathbf{x}^\star = \mathbf{p}_0 + t^\star(\mathbf{p}_1 - \mathbf{p}_0) = (1, 1/5) + \frac{1}{3}(1, 0) = (\frac{4}{3}, \frac{1}{5}) $$
接下来，计算[法向量](@entry_id:264185)。$\phi$ 的梯度为 $\nabla\phi = (2x, 2y)$。在交点 $\mathbf{x}^\star$ 处，梯度为 $\nabla\phi(\mathbf{x}^\star) = (8/3, 2/5)$。该向量的模为 $||\nabla\phi(\mathbf{x}^\star)|| = \sqrt{(8/3)^2 + (2/5)^2} = \frac{2\sqrt{409}}{15}$。
因此，[单位法向量](@entry_id:178851) $\mathbf{n}$ 为：
$$ \mathbf{n} = \frac{\nabla\phi(\mathbf{x}^\star)}{||\nabla\phi(\mathbf{x}^\star)||} = \frac{(8/3, 2/5)}{2\sqrt{409}/15} = \left( \frac{20}{\sqrt{409}}, \frac{3}{\sqrt{409}} \right) $$
这个例子展示了基于单元的方法如何从离散的场数据中重建出连续的界面几何信息。

#### 优势：自动处理拓扑变化

基于单元的方法最显著的优势是能够**自动、鲁棒地处理拓扑变化**。因为演化的是一个在整个域上单值连续的函数 $\phi$，所以它的零等值面的拓扑结构可以自然地发生改变，无需任何特殊的几何逻辑。当两个界面部分合并时，它们之间的正值 $\phi$ 区域会逐渐缩小并最终变为负值，使得原本分离的两个零等值面连成一体。反之，当一个界面[颈缩](@entry_id:183657)时，$\phi$ 场自然演化的结果就会使零[等值面](@entry_id:196027)断开。这种能力的优雅和简洁是该方法广受欢迎的主要原因  。

#### 挑战：数值扩散与分辨率限制

尽管拓扑处理能力强大，但基于单元的方法也有其固有的缺点，主要源于其离散化的本质。

**1. [数值扩散](@entry_id:136300)与角点圆滑**

为了在固定网格上稳定地求解[水平集方程](@entry_id:142449)（一个[双曲型方程](@entry_id:145657)），必须采用能够适当耗散能量的数值格式，如**迎风格式**（upwind schemes）。然而，这些格式在带来稳定性的同时，也引入了**[数值扩散](@entry_id:136300)**（numerical diffusion）或称**数值黏性**（numerical viscosity）。

我们可以通过推导**[修正方程](@entry_id:173454)**（modified equation）来精确理解这一效应。对于一维线性平流方程 $u_t + a u_x = 0$ ($a0$)，采用一阶迎风格式更新单元平均值 $u_i^n$：
$$ u_i^{n+1} = u_i^n - C(u_i^n - u_{i-1}^n) $$
其中 $C = a \Delta t / \Delta x$ 是库朗数（CFL number）。通过对各项进行泰勒展开，可以证明该离散格式实际求解的[偏微分](@entry_id:194612)方程，在保留主导误差项后，近似为：
$$ u_t + a u_x = \frac{a \Delta x}{2}(1 - C) u_{xx} $$
右侧的 $u_{xx}$ 项是一个扩散项，其系数 $\nu_{\text{num}} = \frac{a \Delta x}{2}(1-C)$ 被称为数值黏性系数。这个不希望出现的扩散项会导致解中的尖锐梯度（如角点或阶跃）随着时间的推移而被“抹平”或“模糊化”。效应的大小与网格间距 $\Delta x$ 成正比，这意味着网格越粗，角点圆滑越严重 。这也解释了为何在需要精确保持晶面和角点的各向异性蚀刻仿真中，基于单元的方法表现不如串方法 。

**2. 分辨率限制与伪影**

所有基于网格的方法都受到**分辨率**（resolution）的根本限制，这个分辨率由网格间距 $h$（在笛卡尔网格中为 $\Delta x, \Delta y$ 等）决定。根据**奈奎斯特-香农采样定理**（Nyquist-Shannon sampling theorem），为了无失真地表示一个最[小波](@entry_id:636492)长为 $\lambda_{\min}$ 的几何特征，采样间隔 $h$ 必须满足 $h \le \lambda_{\min}/2$。换言之，最小的可分辨特征尺寸约为 $2h$ 。

这个限制在模拟细微结构，如**“串”（stringer）的形成**时尤为关键。在沟槽填充或蚀刻过程中，由于遮蔽效应，在 sidewall 底部可能残留细长的材料，这些残留物被称为“串”。当这些串的宽度 $w$ 或两个相对界面之间的间隙 $g(t)$ 变得与网格尺寸 $h$相当或更小时（$w \lesssim h$），数值方法就会产生伪影。数值扩散可能导致这种细颈结构过早地、非物理地消失或合并（即**伪 pinch-off**）。算法无法区分一个真实的、宽度小于 $h$ 的物理间隙和一个因[数值误差](@entry_id:635587)而闭合的“数值桥梁”。此外，在这些高曲率区域，用于维持 $\phi$ 为[符号距离函数](@entry_id:754834)的**重初始化**（reinitialization）步骤也可能引入微小的位置误差，从而人为地促使薄壁结构合并。

### 先进方法与[混合策略](@entry_id:145261)

为了克服各自的缺点并发挥其优点，研究者们发展了许多先进的数值技术和[混合方法](@entry_id:163463)。

对于基于单元的方法，为了减轻[数值扩散](@entry_id:136300)，可以使用**高阶精度格式**。例如，**MUSCL**（Monotone Upstream-centered Schemes for Conservation Laws）格式通过在每个单元内重构线性或更高阶的解分布，从而在光滑区域达到二阶或更高精度。为了在尖锐梯度附近避免产生非物理的振荡，这些格式通常与**[斜率限制器](@entry_id:638003)**（slope limiters）结合使用。更先进的**WENO**（Weighted Essentially Non-Oscillatory）格式则通过对多个不同阶数的重构模板进行[非线性](@entry_id:637147)加权，能够在光滑区域实现非常高的精度，同时在间断附近平滑地过渡到鲁棒的低阶格式。这些方法能显著改善角点的锐度，但代价是[算法复杂度](@entry_id:137716)和计算量的增加 。

另一种强大的策略是**[混合方法](@entry_id:163463)**（hybrid methods），它试图将拉格朗日方法的精度和欧拉方法的拓扑灵活性结合起来。例如，**粒子水平集方法**（Particle Level Set Method）在欧拉网格的背景上，额外布置了拉格朗日粒子来追踪界面附近的区域，特别是那些分辨率不足的薄壁或细丝。这些粒子的精确位置信息被用来修正水平集函数 $\phi$，从而有效抵抗数值扩散造成的质量损失和伪[拓扑变化](@entry_id:136654) 。通过在宏观演化中使用基于单元的方法，而在需要高精度的局部区域利用串或粒子的亚网格（sub-grid）信息，混合方法为模拟复杂的[半导体制造](@entry_id:187383)工艺提供了兼具鲁棒性和准确性的强大工具。