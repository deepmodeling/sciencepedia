{
    "hands_on_practices": [
        {
            "introduction": "多尺度建模的第一步，也是最关键的一步，是判断何时必须超越单一的连续介质理论。当系统的特征尺寸与微观载流子（如声子或电子）的平均自由程相当时，局部平衡的假设便不再成立，传统的连续介质定律（如傅里叶定律）也会失效。这个练习  旨在通过计算克努森数 $K_n$，训练学习者识别这种非平衡输运状态的能力，并在此基础上，从多种先进的建模策略中选择最合适的混合耦合方法，这是一位合格的建模与仿真工程师必须具备的核心判断力。",
            "id": "4144018",
            "problem": "考虑一条在半导体制造工艺步骤中经历焦耳热的、宽度为 $L=20\\,\\mathrm{nm}$ 的光刻图案化硅线，其温度为 $T=300\\,\\mathrm{K}$。主要的热载流子是声子，在晶体硅中，其室温平均自由程为 $\\ell=100\\,\\mathrm{nm}$。经典的傅里叶热传导定律假设局部热力学平衡，从而得出本构关系 $\\mathbf{q}=-\\kappa \\nabla T$，其中 $\\mathbf{q}$ 是热通量，$\\kappa$ 是热导率。动力学理论将克努森数定义为 $K_n=\\ell/L$，该数表示非局域弹道输运与局域扩散输运的相对重要性。介观尺度下的声子输运由玻尔兹曼输运方程 (BTE) 描述，该方程可以在各种近似（例如，弛豫时间近似）下求解；而原子尺度的描述（例如，分子动力学 (MD)）则直接解析非谐相互作用。\n\n仅使用这些基本依据，判断傅里叶定律在当前几何结构中是否适用，并选择一个合适的多尺度耦合策略来考虑在高克努森数下出现的弹道效应。选择能够最准确地评估该状态并概述科学上合理且计算上可行的跨尺度耦合方法的选项。\n\nA. 计算 $K_n=\\ell/L=100\\,\\mathrm{nm}/20\\,\\mathrm{nm}=5$，得出结论：傅里叶定律无效，因为局部平衡不满足。然后采用一种混合耦合方法，在厚度为几个 $\\ell$ 量级的近特征区域内求解声子玻尔兹曼输运方程 (BTE)，而在远场求解傅里叶方程。施加界面条件以强制法向热通量连续，并通过界面热阻 $R_{\\mathrm{K}}$ 允许温度跳变，同时通过边界数据的迭代交换（来自连续介质温度的入射声子分布，来自BTE的出射通量）进行耦合。\n\nB. 计算 $K_n=\\ell/L=100\\,\\mathrm{nm}/20\\,\\mathrm{nm}=0.2$，得出结论：傅里叶定律有效。然后使用一个单域傅里叶求解器，采用体材料的 $\\kappa$ 和标准的狄利克雷/诺伊曼边界条件，不进行任何弹道修正。\n\nC. 计算 $K_n=5$，得出结论：傅里叶定律无效。但是在所有区域保留傅里叶定律，方法是将 $\\kappa$ 替换为一个由抑制函数 $S(K_n)$ 得到的尺寸依赖的有效热导率 $k_{\\mathrm{eff}}(L)$，并且没有显式的微观-宏观界面或非局域耦合。\n\nD. 认识到非傅里叶行为，并采用 Maxwell–Cattaneo–Vernotte (MCV) 双曲型热方程，其弛豫时间等于 $T=300\\,\\mathrm{K}$ 时的主要声子散射时间。该方程通过温度和热通量的连续性与一个傅里叶区域耦合，从而在不调用声子玻尔兹曼输运方程 (BTE) 的情况下捕捉弹道效应。\n\nE. 计算 $K_n=5$，得出结论：傅里叶定律无效。然后采用一个从声子玻尔兹曼输运方程 (BTE) 推导出的弹道-扩散方程 (BDE) 框架，在近特征区域求解无碰撞动力学描述，在远场求解扩散方程。耦合通过通量连续性以及一个为扩散区设计的、基于抑制函数的闭合关系来实现，该闭合关系在一个重叠的握手区域内根据动力学解进行校准。\n\n选择所有正确选项。",
            "solution": "首先将对问题陈述的科学合理性、完整性和清晰性进行验证。\n\n### 步骤 1：提取已知信息\n问题提供了以下信息：\n-   一条特征宽度为 $L=20\\,\\mathrm{nm}$ 的硅线。\n-   系统温度为 $T=300\\,\\mathrm{K}$。\n-   主要热载流子是声子，在晶体硅中其室温平均自由程为 $\\ell=100\\,\\mathrm{nm}$。\n-   经典傅里叶热传导定律为 $\\mathbf{q}=-\\kappa \\nabla T$，其中 $\\mathbf{q}$ 是热通量，$\\kappa$ 是热导率。\n-   克努森数定义为 $K_n=\\ell/L$。\n-   介观尺度的热输运由玻尔兹曼输运方程 (BTE) 描述，原子尺度由分子动力学 (MD) 描述。\n\n任务是评估傅里叶定律对该几何结构的有效性，并选择一个合适的多尺度耦合策略来考虑弹道输运效应。\n\n### 步骤 2：使用提取的已知信息进行验证\n1.  **科学依据**：该问题基于非平衡、纳米尺度热输运这一成熟领域。当系统尺寸 $L$ 与热载流子平均自由程 $\\ell$ 相当或更小时，傅里叶定律失效，这是该领域的基石之一。使用克努森数 $K_n$ 作为主要指标，并提及 BTE 和 MD 作为更基本的描述，这些都是标准且正确的。给定的 $L$ 和 $\\ell$ 的值对于现代半导体器件和材料是物理上现实的。\n2.  **适定性**：问题是适定的。它提供了足够的信息来计算克努森数，从而确定输运状态。基于此状态，它要求从给定的一组选项中选择一个合适的建模策略。可以得出一个明确的结论。\n3.  **客观性**：语言精确、专业，没有主观或模棱两可的陈述。\n\n问题陈述没有违反任何无效标准。它是科学上合理的、适定的和客观的。\n\n### 步骤 3：结论和行动\n问题有效。将推导解答。\n\n### 推导与选项分析\n第一步是通过计算克努森数 $K_n$ 来确定热输运状态。克努森数提供了对稀薄程度的度量，它比较了粒子的平均自由程与系统的特征长度尺度。\n\n已知：\n-   声子平均自由程，$\\ell = 100\\,\\mathrm{nm}$。\n-   特征长度（线宽），$L = 20\\,\\mathrm{nm}$。\n\n克努森数计算如下：\n$$\nK_n = \\frac{\\ell}{L} = \\frac{100\\,\\mathrm{nm}}{20\\,\\mathrm{nm}} = 5\n$$\n\n输运状态通常分类如下：\n-   $K_n \\lesssim 0.1$：扩散区。碰撞频繁。局部热力学平衡成立，傅里叶定律有效。\n-   $0.1 \\lesssim K_n \\lesssim 10$：准弹道（或过渡）区。扩散和弹道输运效应均显著。局部平衡不被维持，傅里叶定律无效。\n-   $K_n \\gtrsim 10$：弹道区。声子在特征长度上传播时几乎不发生或很少发生散射事件。\n\n当 $K_n = 5$ 时，系统深入准弹道区。这意味着相当一部分声子将无散射地穿过 $20\\,\\mathrm{nm}$ 的线宽。因此，作为傅里叶定律 $\\mathbf{q}=-\\kappa \\nabla T$ 基础的局部热力学平衡假设被违反了。给定点的热通量不仅取决于局部温度梯度，还取决于大小与 $\\ell$ 相当的周围区域内的温度分布。因此，任何基于标准傅里叶定律和恒定体材料 $\\kappa$ 值的模型都预计会失效。需要更复杂的模型来考虑非局域和非平衡效应，例如从声子 BTE 推导出的模型。\n\n现在，我们基于这一理解来评估每个选项。\n\n**A. 计算 $K_n=\\ell/L=100\\,\\mathrm{nm}/20\\,\\mathrm{nm}=5$，得出结论：傅里叶定律无效，因为局部平衡不满足。然后采用一种混合耦合方法，在厚度为几个 $\\ell$ 量级的近特征区域内求解声子玻尔兹曼输运方程 (BTE)，而在远场求解傅里叶方程。施加界面条件以强制法向热通量连续，并通过界面热阻 $R_{\\mathrm{K}}$ 允许温度跳变，同时通过边界数据的迭代交换（来自连续介质温度的入射声子分布，来自BTE的出射通量）进行耦合。**\n\n该选项正确计算出 $K_n = 5$ 并正确地得出傅里叶定律无效的结论。所提出的解决方案是一种混合的区域分解法。它建议在非平衡效应占主导的关键区域（硅线及其紧邻区域，一个几个 $\\ell$ 大小的区域）使用计算成本高但物理上准确的 BTE。在远场（例如，硅衬底深处），那里的长度尺度更大，输运更具扩散性，则使用计算成本更低的傅里叶方程。所描述的界面条件——热通量连续性（能量守恒）和温度跳变（界面处非平衡声子分布的结果，通常通过 Kapitza 热阻建模）——对于耦合动力学 (BTE) 域和连续介质 (Fourier) 域是物理上正确的。边界信息的迭代交换是实现自洽解的标准数值程序。整个策略是解决多尺度热输运问题的最先进、科学上合理且计算上可行的方法。\n\n结论：**正确**\n\n**B. 计算 $K_n=\\ell/L=100\\,\\mathrm{nm}/20\\,\\mathrm{nm}=0.2$，得出结论：傅里叶定律有效。然后使用一个单域傅里叶求解器，采用体材料的 $\\kappa$ 和标准的狄利克雷/诺伊曼边界条件，不进行任何弹道修正。**\n\n该选项包含一个计算错误：$100/20 = 5$，而不是 $0.2$。这个计算似乎被反转为 $L/\\ell$。基于这个不正确的值，它得出了傅里叶定律有效的错误结论（即使 $K_n=0.2$ 也表明需要谨慎），并提出了一个不合适的建模策略。正确的 $K_n=5$ 明确地排除了使用简单傅里叶求解器的可能性。\n\n结论：**不正确**\n\n**C. 计算 $K_n=5$，得出结论：傅里叶定律无效。但是在所有区域保留傅里叶定律，方法是将 $\\kappa$ 替换为一个由抑制函数 $S(K_n)$ 得到的尺寸依赖的有效热导率 $k_{\\mathrm{eff}}(L)$，并且没有显式的微观-宏观界面或非局域耦合。**\n\n该选项正确计算出 $K_n=5$ 并正确地得出傅里叶定律无效的结论。所提出的策略是使用一个带有有效热导率 $\\kappa_{\\mathrm{eff}}$ 的修正傅里叶方程。这是一种已知的工程近似方法。例如，在一维薄膜输运中，一个简单的模型给出 $\\kappa_{\\mathrm{eff}} = \\kappa_{\\mathrm{bulk}} S(K_n)$，其中 $S(K_n) = (1+K_n)^{-1}$。虽然计算上非常简单，但这种方法有一个主要的物理缺陷：它仍然是一个局域模型。它无法捕捉弹道输运的真实非局域性质，即某一点的通量取决于周围有限体积内的温度。在复杂的二维或三维几何结构中，例如从一条线向外扩散热量，这种方法无法捕捉定向的弹道效应和热能的详细空间分布。问题要求一种“考虑弹道效应”的策略，而这种方法只考虑了它们对总热阻的净影响，而不是底层的非局愈输运物理。与选项 A 和 E 的显式动力学-连续介质耦合相比，这是一种精度较低且物理上不太完备的方法。它不是问题所要求的“耦合策略”。\n\n结论：**不正确**\n\n**D. 认识到非傅里叶行为，并采用 Maxwell–Cattaneo–Vernotte (MCV) 双曲型热方程，其弛豫时间等于 $T=300\\,\\mathrm{K}$ 时的主要声子散射时间。该方程通过温度和热通量的连续性与一个傅里叶区域耦合，从而在不调用声子玻尔兹曼输运方程 (BTE) 的情况下捕捉弹道效应。**\n\n该选项正确地认识到傅里叶定律无效。然而，它建议使用 MCV 方程。MCV 方程 $\\mathbf{q} + \\tau \\frac{\\partial \\mathbf{q}}{\\partial t} = -\\kappa \\nabla T$ 在热通量响应中引入了时间延迟 $\\tau$，使热方程变为双曲型，并预测了有限的热传播速度。虽然它是对傅里叶定律的修正，但在纳米尺度热输运领域，它被广泛认为不足以解决像本问题这样由边界散射和空间非局域性主导的问题。MCV 方程主要处理时间效应，不能正确地模拟作为准弹道输运核心特征的空间非局域性。对于稳态或准稳态问题，它常常产生非物理的结果。它没有像基于 BTE 的方法那样以物理上正确的方式“捕捉弹道效应”。\n\n结论：**不正确**\n\n**E. 计算 $K_n=5$，得出结论：傅里叶定律无效。然后采用一个从声子玻尔兹曼输运方程 (BTE) 推导出的弹道-扩散方程 (BDE) 框架，在近特征区域求解无碰撞动力学描述，在远场求解扩散方程。耦合通过通量连续性以及一个为扩散区设计的、基于抑制函数的闭合关系来实现，该闭合关系在一个重叠的握手区域内根据动力学解进行校准。**\n\n该选项正确计算出 $K_n=5$ 并正确地得出傅里叶定律无效的结论。它建议使用弹道-扩散方程 (BDE) 框架。BDE 是从 BTE 推导出的一个严谨的近似，它将声子分布分解为一个弹道分量（无散射传播）和一个扩散分量（经历散射）。弹道部分用动力学方法处理，扩散部分用类扩散方程处理。该框架专门为准弹道区 ($0.1 \\lesssim K_n \\lesssim 10$) 设计，并且已知其既准确又比求解完整 BTE 的计算效率更高。该描述虽然略微混合了布居数分解（BDE 的核心）和区域分解的语言，但准确地指向了一种科学上合理且先进的方法。提及“基于抑制函数的闭合关系……根据动力学解进行校准”暗示了 BDE 模型中弹道和扩散模式之间的复杂耦合。这代表了一种有效且强大的多尺度策略。\n\n结论：**正确**",
            "answer": "$$\\boxed{AE}$$"
        },
        {
            "introduction": "在确定需要多尺度方法后，我们来实践一种核心的尺度链接技术：均匀化。该方法旨在从离散的原子结构中推导出等效的连续介质本构关系。此练习  聚焦于一个经过重构的硅表面，要求学习者应用带有内部弛豫的柯西-玻恩假说，通过最小化原子模型的总能量，推导出描述表面力学行为的有效弹性常数。这个过程完美地诠释了能量等效原理——即微观原子体系的能量响应如何被“粗粒化”为一个宏观连续介质的属性，从而揭示了从原子到连续介质尺度跨越的数学和物理机制。",
            "id": "4144033",
            "problem": "一块硅 $(001)$ 表面经历了一次 $(2 \\times 1)$ 重构，其特征是二聚体沿着 $x$ 方向排列。考虑一个通过均匀化一个原子超胞得到的二维 (2D) 表面连续介质，该超胞每个 $(2 \\times 1)$ 表面单位包含一个二聚体。该超胞的尺寸在 $x$ 方向上为 $a_s$，在 $y$ 方向上为 $2a_s$，因此超胞面积为 $A = a_s \\cdot 2a_s$。在参考（未应变）重构状态下，二聚体的键长为 $l_0$。宏观面内表面变形是一个沿 $x$ 方向施加的小单轴应变 $\\varepsilon_{xx}$，所有其他分量均可忽略不计。\n\n对该超胞使用以下原子模型：\n- 二聚体被建模为一个与 $x$ 方向对齐的谐振子弹簧，其拉伸刚度为 $k_d$。\n- 两个二聚体原子中的每一个都通过一个刚度为 $k_s$ 的谐振子弹簧（与 $x$ 方向对齐）束缚在下方的衬底上，该弹簧惩罚每个原子的位移偏离宏观施加的位移场。\n\n在表面上采用 Cauchy–Born 假设：在宏观小应变 $\\varepsilon_{xx}$ 的作用下，二聚体端点的参考 $x$ 间距 $l_0$ 在粗尺度上被仿射映射为 $l_0 (1 + \\varepsilon_{xx})$。然而，允许这两个原子相对于仿射场沿 $x$ 方向发生额外的内部位移 $v_1$ 和 $v_2$，从而产生衬底束缚能。超胞的总原子能量是二聚体弹簧能和两个衬底弹簧能之和。均匀化表面自由能密度是通过将相对于内部位移最小化的原子能量除以超胞面积 $A$，并展开到 $\\varepsilon_{xx}$ 的二阶来获得的。二聚体方向上的有效表面弹性常数 $C^{s,\\mathrm{eff}}_{xxxx}$ 由二次型 $\\gamma(\\varepsilon_{xx}) = \\tfrac{1}{2} C^{s,\\mathrm{eff}}_{xxxx} \\varepsilon_{xx}^{2} + o(\\varepsilon_{xx}^{2})$ 定义。\n\n从基本能量等效性和 Cauchy–Born 假设出发，通过对内部位移进行最小化并进行均匀化，推导出 $C^{s,\\mathrm{eff}}_{xxxx}$ 的闭式解。然后，使用参数\n$a_{s} = 3.84~\\text{\\AA}$、$l_{0} = 2.35~\\text{\\AA}$、$k_{d} = 100~\\text{N}/\\text{m}$ 和 $k_{s} = 200~\\text{N}/\\text{m}$，\n计算 $C^{s,\\mathrm{eff}}_{xxxx}$ 的数值。\n\n以 N/m 为单位表示最终答案，并将答案四舍五入到三位有效数字。",
            "solution": "该问题经评估是有效的。它在科学上基于连续介质力学和原子建模的原理，特别是使用带有内部弛豫的 Cauchy-Born 法则进行多尺度均匀化。该问题是适定的、客观的，并提供了一套自洽的定义、参数和约束，足以推导出一个唯一且有意义的解。尽管指定的“$(2 \\times 1)$ 重构”与给定的超胞尺寸（按惯例对应于 $(1 \\times 2)$ 重构）之间存在轻微的记法不一致，但问题提供了必须使用的明确且无歧义的几何定义（$x$ 方向为 $a_s$， $y$ 方向为 $2a_s$）和面积（$A = 2a_s^2$）。这使得问题如所述是内部一致且可解的，覆盖了常规命名的歧义。\n\n有效表面弹性常数 $C^{s,\\mathrm{eff}}_{xxxx}$ 的推导过程如下。\n\n首先，我们为超胞建立原子模型的几何和运动学关系。设形成二聚体的两个原子的参考位置沿 $x$ 轴为 $x_1^0$ 和 $x_2^0$。我们可以定义它们相对于二聚体中心的位置，使得 $x_1^0 = -l_0/2$ 和 $x_2^0 = l_0/2$，其中 $l_0$ 是初始键长。\n\n在宏观单轴应变 $\\varepsilon_{xx}$ 的作用下，Cauchy-Born 假设将这些参考位置映射到仿射变形后的位置 $x_{i, \\text{affine}} = x_i^0(1+\\varepsilon_{xx})$。问题引入了每个原子相对于此仿射场沿 $x$ 方向的额外内部位移，记为 $v_1$ 和 $v_2$。因此，两个原子的最终位置是：\n$$x_1 = x_1^0(1+\\varepsilon_{xx}) + v_1 = -\\frac{l_0}{2}(1+\\varepsilon_{xx}) + v_1$$\n$$x_2 = x_2^0(1+\\varepsilon_{xx}) + v_2 = \\frac{l_0}{2}(1+\\varepsilon_{xx}) + v_2$$\n\n接下来，我们构建超胞的总势能 $U_{cell}$。该能量由二聚体拉伸能 $U_d$ 和来自两个衬底束缚的能量 $U_s$ 组成。\n\n二聚体拉伸能 $U_d$ 被建模为刚度为 $k_d$ 的谐振子弹簧。能量取决于键长的变化量 $\\Delta l$。新的键长为 $l = x_2 - x_1$。\n$$l = \\left(\\frac{l_0}{2}(1+\\varepsilon_{xx}) + v_2\\right) - \\left(-\\frac{l_0}{2}(1+\\varepsilon_{xx}) + v_1\\right) = l_0(1+\\varepsilon_{xx}) + v_2 - v_1$$\n长度变化量为 $\\Delta l = l - l_0 = l_0\\varepsilon_{xx} + v_2 - v_1$。能量为：\n$$U_d = \\frac{1}{2}k_d(\\Delta l)^2 = \\frac{1}{2}k_d(l_0\\varepsilon_{xx} + v_2 - v_1)^2$$\n\n衬底束缚能 $U_s$ 惩罚每个原子对其仿射位置的偏离。这些偏离即为内部位移 $v_1$ 和 $v_2$。每个原子由一个刚度为 $k_s$ 的弹簧束缚。\n$$U_s = \\frac{1}{2}k_s v_1^2 + \\frac{1}{2}k_s v_2^2 = \\frac{1}{2}k_s(v_1^2 + v_2^2)$$\n\n超胞的总原子能量是 $U_d$ 和 $U_s$ 的和，即 $U_{cell} = U_d + U_s$：\n$$U_{cell}(v_1, v_2) = \\frac{1}{2}k_d(l_0\\varepsilon_{xx} + v_2 - v_1)^2 + \\frac{1}{2}k_s(v_1^2 + v_2^2)$$\n\n为了找到弛豫态，必须使该能量相对于内部位移 $v_1$ 和 $v_2$ 最小化。我们将 $U_{cell}$ 对 $v_1$ 和 $v_2$ 的偏导数设为零。\n$$\\frac{\\partial U_{cell}}{\\partial v_1} = k_d(l_0\\varepsilon_{xx} + v_2 - v_1)(-1) + k_s v_1 = 0 \\implies (k_d+k_s)v_1 - k_d v_2 = k_d l_0 \\varepsilon_{xx}$$\n$$\\frac{\\partial U_{cell}}{\\partial v_2} = k_d(l_0\\varepsilon_{xx} + v_2 - v_1)(1) + k_s v_2 = 0 \\implies -k_d v_1 + (k_d+k_s)v_2 = -k_d l_0 \\varepsilon_{xx}$$\n从方程的对称性，我们可以推断出 $v_2 = -v_1$。将此代入第一个方程：\n$$(k_d+k_s)v_1 - k_d(-v_1) = k_d l_0 \\varepsilon_{xx} \\implies (2k_d+k_s)v_1 = k_d l_0 \\varepsilon_{xx}$$\n求解平衡位移 $v_1^*$ 和 $v_2^*$：\n$$v_1^* = \\frac{k_d l_0 \\varepsilon_{xx}}{2k_d+k_s}$$\n$$v_2^* = -v_1^* = -\\frac{k_d l_0 \\varepsilon_{xx}}{2k_d+k_s}$$\n\n我们现在将这些平衡位移代回总能量表达式中，以获得最小化后的能量 $U_{cell}^{min}$。\n关键项是：\n$$v_2^* - v_1^* = -2v_1^* = -2\\frac{k_d l_0 \\varepsilon_{xx}}{2k_d+k_s}$$\n$$v_1^{*2} + v_2^{*2} = 2v_1^{*2} = 2\\left(\\frac{k_d l_0 \\varepsilon_{xx}}{2k_d+k_s}\\right)^2$$\n代入 $U_{cell}$：\n$$U_{cell}^{min} = \\frac{1}{2}k_d\\left(l_0\\varepsilon_{xx} - 2\\frac{k_d l_0 \\varepsilon_{xx}}{2k_d+k_s}\\right)^2 + \\frac{1}{2}k_s\\left(2\\left(\\frac{k_d l_0 \\varepsilon_{xx}}{2k_d+k_s}\\right)^2\\right)$$\n$$U_{cell}^{min} = \\frac{1}{2}k_d(l_0\\varepsilon_{xx})^2\\left(1 - \\frac{2k_d}{2k_d+k_s}\\right)^2 + k_s\\left(\\frac{k_d l_0 \\varepsilon_{xx}}{2k_d+k_s}\\right)^2$$\n$$U_{cell}^{min} = \\frac{1}{2}k_d(l_0\\varepsilon_{xx})^2\\left(\\frac{k_s}{2k_d+k_s}\\right)^2 + k_s\\frac{k_d^2(l_0\\varepsilon_{xx})^2}{(2k_d+k_s)^2}$$\n$$U_{cell}^{min} = \\frac{k_d(l_0\\varepsilon_{xx})^2}{(2k_d+k_s)^2}\\left(\\frac{1}{2}k_s^2 + k_s k_d\\right) = \\frac{k_d(l_0\\varepsilon_{xx})^2}{(2k_d+k_s)^2}\\frac{k_s}{2}(k_s + 2k_d)$$\n$$U_{cell}^{min} = \\frac{1}{2}(l_0\\varepsilon_{xx})^2 \\frac{k_d k_s}{2k_d+k_s} = \\frac{1}{2} l_0^2 \\frac{k_d k_s}{2k_d+k_s}\\varepsilon_{xx}^2$$\n\n均匀化表面自由能密度 $\\gamma(\\varepsilon_{xx})$ 是最小化的胞能量除以超胞面积 $A = 2a_s^2$。\n$$\\gamma(\\varepsilon_{xx}) = \\frac{U_{cell}^{min}}{A} = \\frac{1}{2a_s^2} \\left(\\frac{1}{2} l_0^2 \\frac{k_d k_s}{2k_d+k_s}\\varepsilon_{xx}^2\\right) = \\frac{l_0^2 k_d k_s}{4a_s^2(2k_d+k_s)}\\varepsilon_{xx}^2$$\n\n问题通过关系式 $\\gamma(\\varepsilon_{xx}) = \\frac{1}{2} C^{s,\\mathrm{eff}}_{xxxx} \\varepsilon_{xx}^2$ 定义了有效表面弹性常数 $C^{s,\\mathrm{eff}}_{xxxx}$。通过比较 $\\gamma(\\varepsilon_{xx})$ 的两个表达式，我们确定该常数：\n$$\\frac{1}{2} C^{s,\\mathrm{eff}}_{xxxx} = \\frac{l_0^2 k_d k_s}{4a_s^2(2k_d+k_s)}$$\n$$C^{s,\\mathrm{eff}}_{xxxx} = \\frac{l_0^2 k_d k_s}{2a_s^2(2k_d+k_s)}$$\n\n最后，我们使用所提供的参数计算其数值：\n$a_s = 3.84 \\times 10^{-10}~\\text{m}$\n$l_0 = 2.35 \\times 10^{-10}~\\text{m}$\n$k_d = 100~\\text{N}/\\text{m}$\n$k_s = 200~\\text{N}/\\text{m}$\n\n$$C^{s,\\mathrm{eff}}_{xxxx} = \\frac{(2.35 \\times 10^{-10})^2 (100) (200)}{2(3.84 \\times 10^{-10})^2 (2(100)+200)}$$\n$$C^{s,\\mathrm{eff}}_{xxxx} = \\frac{5.5225 \\times 10^{-20} \\cdot 20000}{2(14.7456 \\times 10^{-20}) (400)}$$\n$$C^{s,\\mathrm{eff}}_{xxxx} = \\frac{1.1045 \\times 10^{-15}}{2(14.7456 \\times 10^{-20}) (400)} = \\frac{1.1045 \\times 10^{-15}}{11796.48 \\times 10^{-20}} = \\frac{1.1045 \\times 10^{-15}}{1.179648 \\times 10^{-16}}$$\n$$C^{s,\\mathrm{eff}}_{xxxx} \\approx 9.36295~\\text{N}/\\text{m}$$\n四舍五入到三位有效数字，结果为 $9.36~\\text{N}/\\text{m}$。",
            "answer": "$$\\boxed{9.36}$$"
        },
        {
            "introduction": "除了静态力学属性，输运系数的计算是多尺度建模中的另一项重要任务。原子模拟本质上是在有限尺寸的周期性体系中进行的，这会引入与真实无限大材料不同的“有限尺寸效应”。这个练习  模拟了一个在计算材料科学中极为常见的研究流程：首先，基于分子动力学（MD）轨迹和爱因斯坦关系式来估算材料的扩散系数；然后，应用基于连续介质弹性理论的修正公式，来消除由于周期性边界条件引入的系统性误差。通过这个实践，学习者可以掌握如何从原子模拟数据中提取宏观输运性质，并严谨地处理模拟本身带来的伪影，以获得具有物理意义的体材料参数。",
            "id": "4143999",
            "problem": "在半导体制造过程建模中，一项硅自扩散计算需要将原子尺度的分子动力学 (MD) 估算值与连续介质尺度的参数联系起来。考虑在温度 $T = 1200\\,\\mathrm{K}$ 和边长为 $L$ 的立方周期性模拟单元中，对晶体硅进行的平衡态MD计算。自扩散系数 $D$ 通过一个标记的硅原子的爱因斯坦关系式定义：\n$$\nD \\;=\\; \\lim_{t\\to\\infty} \\frac{1}{6t} \\left\\langle \\left\\lvert \\mathbf{r}(t) - \\mathbf{r}(0) \\right\\rvert^2 \\right\\rangle \\right.,\n$$\n其中 $\\left\\langle \\cdot \\right\\rangle$ 表示系综平均，$\\mathbf{r}(t)$ 是在时间 $t$ 时标记原子的未折叠位置（追踪跨越边界的情况）。\n\n在晶体固体中，自扩散是空位介导的，并遵循阿伦尼乌斯形式：\n$$\nD_\\infty(T) \\;\\propto\\; \\exp\\!\\left(-\\frac{E_f + E_m}{k_\\mathrm{B} T}\\right),\n$$\n其中 $E_f$ 是缺陷形成能，$E_m$ 是缺陷迁移能，$k_\\mathrm{B}$ 是玻尔兹曼常数，$D_\\infty(T)$ 表示无限大系统极限下的扩散系数。在一个有限周期性单元中，周期性镜像之间的弹性相互作用会通过一个依赖于尺寸的项 $\\Delta E_f(L) \\approx A/L^3$ 来修正形成能（对于足够大的 $L$），其中 $A$ 是一个包含弹性偶极子和基体弹性模量的、与材料相关的正常数。这产生了一个有限尺寸扩散系数：\n$$\nD_L(T) \\;\\approx\\; D_\\infty(T)\\,\\exp\\!\\left(-\\frac{\\Delta E_f(L)}{k_\\mathrm{B} T}\\right) \\;=\\; D_\\infty(T)\\,\\exp\\!\\left(-\\frac{A}{k_\\mathrm{B} T\\,L^3}\\right).\n$$\n\n您的任务是实现一个程序，该程序：\n1. 为 $M$ 个独立的标记硅原子生成合成的平衡态MD轨迹，这些轨迹进行扩散随机行走，并与在 $T = 1200\\,\\mathrm{K}$ 下指定的有限尺寸扩散系数 $D_L$ 一致。使用时间步长 $\\Delta t$、总模拟时间 $t_\\mathrm{tot}$ 和边长为 $L$ 的立方周期性边界条件；使用未折叠位置来计算位移。每个维度的增量应为均值为零、方差为 $2 D_L \\Delta t$ 的高斯分布，这与朗之万方程的连续介质极限一致。\n2. 在等间隔时间 $t_i = i\\,\\Delta t$（其中 $i=1,2,\\ldots,N$，$N = t_\\mathrm{tot}/\\Delta t$）计算均方位移 (MSD)：\n$$\n\\mathrm{MSD}(t_i) \\;=\\; \\frac{1}{M}\\sum_{m=1}^M \\left\\lvert \\mathbf{r}_m(t_i) - \\mathbf{r}_m(0) \\right\\rvert^2\n$$\n3. 通过对长时间扩散区域（通过丢弃时间样本的最初 $f_\\mathrm{cut}$ 部分来排除初始弹道输运区域）的 $\\mathrm{MSD}(t)$ 与 $t$ 进行最小二乘线性拟合来估计 $D_L$。如果拟合线为 $\\mathrm{MSD}(t) \\approx a\\,t + b$，则报告 $D_L^\\mathrm{est} = a/6$。\n4. 应用弹性连续介质有限尺寸修正，通过反演上述关系式来估计 $D_\\infty$：\n$$\nD_\\infty^\\mathrm{est} \\;=\\; D_L^\\mathrm{est}\\,\\exp\\!\\left(\\frac{A}{k_\\mathrm{B} T\\,L^3}\\right).\n$$\n\n使用以下常数和单位：\n- 玻尔兹曼常数 $k_\\mathrm{B} = 1.380649\\times 10^{-23}\\,\\mathrm{J/K}$，\n- 所有扩散系数以 $\\mathrm{m}^2/\\mathrm{s}$ 表示，\n- 在输入参数规范中，长度 $L$ 以 nm 表示，但在内部生成轨迹时转换为 m；如所述，在弹性修正中使用以 $\\text{nm}^3$ 为单位的 $L^3$，\n- 参数 $A$ 以 $\\mathrm{eV}\\cdot\\mathrm{nm}^3$ 提供；使用 $1\\,\\mathrm{eV} = 1.602176634\\times 10^{-19}\\,\\mathrm{J}$ 将其转换为 $\\mathrm{J}\\cdot\\mathrm{nm}^3$。\n\n为确保科学真实性和可测试性，假设在 $T = 1200\\,\\mathrm{K}$ 时，底层的无限大系统扩散系数为 $D_\\infty^\\mathrm{true} = 1.0\\times 10^{-18}\\,\\mathrm{m}^2/\\mathrm{s}$。对于给定的测试用例，令 $D_L^\\mathrm{true} = D_\\infty^\\mathrm{true}\\,\\exp\\!\\left(-\\frac{A}{k_\\mathrm{B} T\\,L^3}\\right)$ 为用于生成合成轨迹的真实有限尺寸扩散系数。\n\n实现程序以运行以下测试套件（每个测试用例是一个参数元组 $(L, A, M, \\Delta t, t_\\mathrm{tot}, f_\\mathrm{cut})$）：\n- 测试用例 1: $(L = 5.0\\,\\mathrm{nm},\\, A = 0.6\\,\\mathrm{eV}\\cdot\\mathrm{nm}^3,\\, M = 800,\\, \\Delta t = 5.0\\times 10^{-7}\\,\\mathrm{s},\\, t_\\mathrm{tot} = 0.003\\,\\mathrm{s},\\, f_\\mathrm{cut} = 0.2)$，\n- 测试用例 2: $(L = 10.0\\,\\mathrm{nm},\\, A = 0.6\\,\\mathrm{eV}\\cdot\\mathrm{nm}^3,\\, M = 800,\\, \\Delta t = 5.0\\times 10^{-7}\\,\\mathrm{s},\\, t_\\mathrm{tot} = 0.003\\,\\mathrm{s},\\, f_\\mathrm{cut} = 0.2)$，\n- 测试用例 3: $(L = 10.0\\,\\mathrm{nm},\\, A = 0.0\\,\\mathrm{eV}\\cdot\\mathrm{nm}^3,\\, M = 800,\\, \\Delta t = 5.0\\times 10^{-7}\\,\\mathrm{s},\\, t_\\mathrm{tot} = 0.003\\,\\mathrm{s},\\, f_\\mathrm{cut} = 0.2)$。\n\n您的程序应：\n- 对于每个测试用例，如上所述使用 $D_L^\\mathrm{true}$ 生成合成轨迹，\n- 通过对长时间窗口（由 $f_\\mathrm{cut}$ 定义）内的 $\\mathrm{MSD}(t)$ 与 $t$ 进行线性回归来估计 $D_L^\\mathrm{est}$，\n- 使用弹性连续介质有限尺寸修正计算修正后的估计值 $D_\\infty^\\mathrm{est}$，\n- 输出一行，包含一个用方括号括起来的逗号分隔列表，其中包含按上述测试用例顺序列出的三个修正后估计值（单位为 $\\mathrm{m}^2/\\mathrm{s}$）。例如，输出格式必须严格为 $[\\text{result1},\\text{result2},\\text{result3}]$ 的形式，其中每个结果都是一个浮点数。\n\n所有扩散系数以 $\\mathrm{m}^2/\\mathrm{s}$ 为单位，以普通十进制浮点数（非科学记数法字符串）作答，在打印的输出行中不带单位，也无附加文本。",
            "solution": "该问题提出了一个在半导体工艺多尺度建模领域中有效且定义明确的计算任务。它在科学上基于统计力学和连续介质弹性理论的原理，并且所有必需的参数和程序都得到了明确的规定。目标是编写一个程序，该程序模拟有限尺寸系统中的扩散过程，分析产生的合成数据以估计输运系数，然后应用基于连续介质理论的修正将此估计外推到无限大系统极限。此过程反映了计算材料科学中修正原子尺度模拟中有限尺寸效应的常见工作流程。\n\n解决方案通过为每个测试用例实现指定的四个步骤来进行。\n\n1.  **合成数据生成参数 $D_L^\\mathrm{true}$ 的计算**\n    该问题的基础是有限周期性单元尺寸为 $L$ 的扩散系数 $D_L(T)$ 与其无限大系统对应物 $D_\\infty(T)$ 之间的关系：\n    $$\n    D_L(T) \\approx D_\\infty(T)\\,\\exp\\!\\left(-\\frac{A}{k_\\mathrm{B} T\\,L^3}\\right)\n    $$\n    这里，$T = 1200\\,\\mathrm{K}$ 是温度，$k_\\mathrm{B}$ 是玻尔兹曼常数，$A$ 是与弹性相互作用相关的参数。问题提供了“真实”的无限大系统值 $D_\\infty^\\mathrm{true} = 1.0\\times 10^{-18}\\,\\mathrm{m}^2/\\mathrm{s}$，我们用它来定义用于我们合成轨迹生成的扩散系数 $D_L^\\mathrm{true}$。指数项的参数 $\\frac{A}{k_\\mathrm{B} T\\,L^3}$ 必须是无量纲的。给定输入的单位（$A$ 以 $\\mathrm{eV}\\cdot\\mathrm{nm}^3$ 为单位，$L$ 以 $\\mathrm{nm}$ 为单位，$k_\\mathrm{B}$ 以 $\\mathrm{J/K}$ 为单位，$T$ 以 $\\mathrm{K}$ 为单位），我们首先使用转换因子 $1\\,\\mathrm{eV} = 1.602176634\\times 10^{-19}\\,\\mathrm{J}$ 将 $A$ 转换为 $\\mathrm{J}\\cdot\\mathrm{nm}^3$ 单位。然后参数变为：\n    $$\n    \\frac{A\\;[\\mathrm{eV}\\cdot\\mathrm{nm}^3] \\times (1.602176634\\times 10^{-19}\\;\\mathrm{J/eV})}{k_\\mathrm{B}\\;[\\mathrm{J/K}] \\times T\\;[\\mathrm{K}] \\times (L\\;[\\mathrm{nm}])^3}\n    $$\n    单位正确抵消，得到一个无量纲的量。然后计算 $D_L^\\mathrm{true}$ 并用于下一步。\n\n2.  **合成轨迹生成**\n    扩散粒子的运动被建模为三维随机行走。每个粒子的轨迹（共 $M$ 个）在 $N = t_\\mathrm{tot}/\\Delta t$ 个时间步长上进行模拟。对于每个维度（$x, y, z$）和每个时间步长 $\\Delta t$，位移从均值为 $0$、方差为 $2 D_L^\\mathrm{true} \\Delta t$ 的高斯（正态）分布中抽取。因此，每个位移分量的标准差为 $\\sigma = \\sqrt{2 D_L^\\mathrm{true} \\Delta t}$。在时间 $t_i = i\\,\\Delta t$ 时，粒子相对于其原点的总“未折叠”位移是截至该步骤的各个随机位移的累积和。\n\n3.  **均方位移 (MSD) 分析和 $D_L^\\mathrm{est}$ 的估计**\n    从生成的轨迹中，我们计算作为时间函数的均方位移 (MSD)。时间 $t_i$ 时的 MSD 是通过对 $M$ 个粒子的系综平均平方位移大小得到的：\n    $$\n    \\mathrm{MSD}(t_i) \\;=\\; \\frac{1}{M}\\sum_{m=1}^M \\left\\lvert \\mathbf{r}_m(t_i) - \\mathbf{r}_m(0) \\right\\rvert^2\n    $$\n    根据三维扩散的爱因斯坦关系式，在扩散区域中，MSD 与时间成线性比例关系：\n    $$\n    \\mathrm{MSD}(t) = 6 D t\n    $$\n    我们通过对计算出的 MSD 数据进行线性最小二乘拟合 $\\mathrm{MSD}(t) = a\\,t + b$ 来估计有限尺寸扩散系数 $D_L^\\mathrm{est}$。问题规定，拟合应排除时间样本的初始部分 $f_\\mathrm{cut}$，以模仿对真实模拟数据的分析，其中可能存在非扩散的弹道输运区域。拟合线的斜率 $a$ 给出扩散系数的估计值：\n    $$\n    D_L^\\mathrm{est} = \\frac{a}{6}\n    $$\n\n4.  **有限尺寸修正和 $D_\\infty^\\mathrm{est}$ 的估计**\n    最后一步是通过反演有限尺寸修正公式来恢复无限大系统扩散系数的估计值 $D_\\infty^\\mathrm{est}$。使用上一步估计的 $D_L^\\mathrm{est}$，我们有：\n    $$\n    D_\\infty^\\mathrm{est} = D_L^\\mathrm{est}\\,\\exp\\!\\left(\\frac{A}{k_\\mathrm{B} T\\,L^3}\\right)\n    $$\n    指数项是步骤1中应用的修正因子的倒数。因为合成数据是从 $D_L^\\mathrm{true}$ 生成的，并且分析涉及统计采样和拟合，所以 $D_\\infty^\\mathrm{est}$ 将是原始 $D_\\infty^\\mathrm{true}$ 的一个估计值，但不会完全相同。这个估计的质量验证了整个分析流程的有效性。对提供的三个测试用例中的每一个都执行此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import linregress\n\ndef solve():\n    \"\"\"\n    Solves the problem of estimating the infinite-system self-diffusion coefficient\n    of silicon by generating and analyzing synthetic molecular dynamics trajectories.\n    \"\"\"\n    # Define physical and conversion constants as specified\n    K_B = 1.380649e-23  # Boltzmann constant in J/K\n    EV_TO_J = 1.602176634e-19  # Conversion factor from eV to Joules\n    \n    # Define problem-specific parameters\n    T_K = 1200.0  # Temperature in Kelvin\n    D_INF_TRUE = 1.0e-18  # True infinite-system diffusion coefficient in m^2/s\n\n    # Each test case is a tuple: (L_nm, A_eV_nm3, M, dt_s, t_tot_s, f_cut)\n    test_cases = [\n        (5.0, 0.6, 800, 5.0e-7, 0.003, 0.2),   # Test case 1\n        (10.0, 0.6, 800, 5.0e-7, 0.003, 0.2),  # Test case 2\n        (10.0, 0.0, 800, 5.0e-7, 0.003, 0.2),  # Test case 3\n    ]\n\n    results = []\n    \n    # Set a random seed for reproducible results\n    np.random.seed(42)\n\n    for case in test_cases:\n        L_nm, A_eV_nm3, M, dt_s, t_tot_s, f_cut = case\n\n        # 1. Calculate the 'true' finite-size diffusion coefficient D_L_true\n        # This will be used to generate the synthetic trajectory data.\n        A_J_nm3 = A_eV_nm3 * EV_TO_J\n        exponent_arg = A_J_nm3 / (K_B * T_K * L_nm**3)\n        D_L_true = D_INF_TRUE * np.exp(-exponent_arg)\n\n        # 2. Generate synthetic trajectories for M particles\n        num_steps = int(t_tot_s / dt_s)\n        # Standard deviation for a one-dimensional displacement over one time step\n        sigma_step = np.sqrt(2 * D_L_true * dt_s)\n        \n        # Generate random displacements for M particles, N steps, 3 dimensions\n        displacements = np.random.normal(loc=0.0, scale=sigma_step, size=(M, num_steps, 3))\n        \n        # Cumulatively sum displacements to get unwrapped trajectories relative to r(0)\n        # The resulting shape is (M, num_steps, 3) where trajectories[m, i, :]\n        # is the displacement of particle m at time t_{i+1}.\n        trajectories = np.cumsum(displacements, axis=1)\n\n        # 3. Compute the Mean Squared Displacement (MSD)\n        # Sum the squares of x, y, z displacements for each particle at each time step\n        sq_disp = np.sum(trajectories**2, axis=2)\n        # Average the squared displacements over all M particles to get MSD vs. time\n        msd = np.mean(sq_disp, axis=0)\n        \n        # Create a corresponding time array for the MSD data\n        t_array = np.arange(1, num_steps + 1) * dt_s\n\n        # 4. Estimate D_L from a linear fit of the MSD data\n        # Exclude the initial fraction f_cut of data points from the fit\n        cutoff_index = int(f_cut * num_steps)\n        t_fit = t_array[cutoff_index:]\n        msd_fit = msd[cutoff_index:]\n        \n        # Perform linear regression: MSD(t) = slope * t + intercept\n        slope, intercept, _, _, _ = linregress(t_fit, msd_fit)\n        \n        # Estimate the finite-size diffusion coefficient from the slope (MSD = 6*D*t)\n        D_L_est = slope / 6.0\n\n        # 5. Apply the finite-size correction to estimate the infinite-system D\n        # This inverts the formula used in step 1\n        D_inf_est = D_L_est * np.exp(exponent_arg)\n        \n        results.append(D_inf_est)\n\n    # Final print statement in the exact required format.\n    # The format specifier ensures plain decimal float output, not scientific notation.\n    formatted_results = [f\"{r:.22f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```"
        }
    ]
}