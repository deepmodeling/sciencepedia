{
    "hands_on_practices": [
        {
            "introduction": "在多尺度模拟中，我们常将原子尺度的计算区域嵌入到连续介质模型中。本练习旨在探讨一个核心问题：如何处理原子区域的边界以真实地模拟其作为无限大材料一部分的行为。通过一个一维原子链的简化模型，我们将推导并比较周期性边界条件（PBC）和开放边界条件下测得的弹性模量，从而量化由于边界效应引入的有限尺寸误差。这个基础练习将阐明为何周期性边界条件是连接原子计算和连续介质力学的基石。",
            "id": "4144074",
            "problem": "考虑一个均匀晶体材料的原子-连续介质（A-C）耦合模型，该材料正在经历空间均匀的小应变变形。原子子区域深嵌在连续介质区域内部，该区域可以很好地近似为无限大。为了消除原子边界处的人为表面假象，并模拟处于无限介质中的情况，原子子区域通常采用周期性边界条件（PBC）进行模拟。在本问题中，您将通过推导均匀应变下的测量弹性响应，并量化在不使用PBC时由区域尺寸引起的有限尺寸效应，来证明在原子子区域中使用周期性边界条件（PBC）的合理性。\n\n从连续杆的一维离散原子表示开始，该表示由 $N$ 个原子组成，在参考构型中等间距 $a$ 排列，具有刚度为 $k$（单位：$\\mathrm{N/m}$）的最近邻谐波相互作用。设宏观连续介质对原子区域施加均匀的小应变 $\\epsilon$。原子能量是每个经历伸长量 $a\\,\\epsilon$ 的键的二次成对弹簧能量之和。原子区域的总参考长度为 $L = N a$（单位：$\\mathrm{m}$）。假设为线性响应并忽略非谐效应。\n\n根据线弹性和谐波相互作用的基本原理，推导由以下关系式定义的一维测量模量 $E_{1\\mathrm{D}}$（单位：$\\mathrm{N}$）\n$$\nE_{1\\mathrm{D}} = \\frac{1}{L}\\,\\frac{\\partial E_\\mathrm{total}}{\\partial \\epsilon}\\,\\frac{1}{\\epsilon},\n$$\n其中 $E_\\mathrm{total}$ 是在施加的均匀应变 $\\epsilon$ 下的总原子能量。证明：\n- 在周期性边界条件（PBC）下，键的数量等于 $N$，并且测量的模量 $E_{1\\mathrm{D}}^\\mathrm{PBC}$ 与 $N$ 无关。\n- 在开放边界（例如，非周期性，端点之外没有邻居）下，键的数量等于 $N-1$，导致测量的模量 $E_{1\\mathrm{D}}^\\mathrm{open}(N)$ 中出现有限尺寸修正。\n\n使用这些结果，通过无量纲偏差来量化区域尺寸对测量性质的影响\n$$\nb(N) = \\frac{E_{1\\mathrm{D}}^\\mathrm{open}(N) - E_{1\\mathrm{D}}^\\mathrm{PBC}}{E_{1\\mathrm{D}}^\\mathrm{PBC}}.\n$$\n\n您必须实现一个完整、可运行的程序，该程序针对下面的测试套件计算每种情况下的 $b(N)$。最终输出必须是单行文本，包含一个用方括号括起来的、以逗号分隔的偏差列表。输出必须是无量纲的小数（无百分号），且不应打印任何其他文本。\n\n测试套件（每个元组按指定单位列出 $(N, a, k)$；$a$ 的单位为 $\\mathrm{m}$，$k$ 的单位为 $\\mathrm{N/m}$）：\n- 情况1：$(N, a, k) = (1000, 5.0\\times 10^{-10}, 50)$。\n- 情况2：$(N, a, k) = (10, 2.5\\times 10^{-10}, 75)$。\n- 情况3：$(N, a, k) = (2, 1.0\\times 10^{-9}, 100)$。\n- 情况4：$(N, a, k) = (50, 3.0\\times 10^{-10}, 60)$。\n\n您的程序应生成单行输出，其中包含情况1到4的偏差，按顺序排列，作为一个用方括号括起来的逗号分隔列表（例如，$[b_1,b_2,b_3,b_4]$）。由于所要求的输出是无量纲的，因此输出中不需要物理单位。",
            "solution": "该问题是有效的。它在科学上基于固态物理和线弹性的原理，并对原子间作用力使用了标准的谐波近似。该问题是适定的，所有必要的参数和定义都已提供，可以推导出唯一且有意义的解。它是客观的，并且与多尺度模拟中有限尺寸效应的研究直接相关。我们将继续进行推导。\n\n目标是推导在一维离散原子链在两种不同边界条件下（周期性边界条件（PBC）和开放边界）的一维测量弹性模量 $E_{1\\mathrm{D}}$。然后，我们将使用这些结果计算无量纲偏差 $b(N)$，它量化了由于使用开放边界而非PBC所引入的有限尺寸误差。\n\n一个刚度为 $k$ 的谐波键（弹簧）从其平衡长度位移 $\\Delta x$ 时的基本能量由 $U_{\\mathrm{bond}} = \\frac{1}{2}k(\\Delta x)^2$ 给出。问题陈述该系统受到均匀的小应变 $\\epsilon$。在一个初始间距为 $a$ 的原子链中，每个键的伸长量为 $\\Delta x = a \\epsilon$。因此，储存在每个单独键中的能量为：\n$$\nU_{\\mathrm{bond}} = \\frac{1}{2}k(a\\epsilon)^2 = \\frac{1}{2}ka^2\\epsilon^2\n$$\n原子区域的总势能 $E_{\\mathrm{total}}$ 是所有键的能量之和。\n\n一维测量模量 $E_{1\\mathrm{D}}$ 由以下关系式定义：\n$$\nE_{1\\mathrm{D}} = \\frac{1}{L}\\,\\frac{\\partial E_\\mathrm{total}}{\\partial \\epsilon}\\,\\frac{1}{\\epsilon}\n$$\n其中 $L = Na$ 是该区域的总参考长度。\n\n我们分别分析这两种情况。\n\n**情况1：周期性边界条件（PBC）**\n在PBC下，$N$ 个原子组成的一维链被视为一个闭合环，其中原子 $N$ 与原子 $1$ 成键。因此，每个原子都恰好有两个邻居，系统中的总键数等于原子数 $N$。\n\n总能量 $E_{\\mathrm{total}}^{\\mathrm{PBC}}$ 是每个键的能量乘以键的数量：\n$$\nE_{\\mathrm{total}}^{\\mathrm{PBC}} = N \\cdot U_{\\mathrm{bond}} = N \\left(\\frac{1}{2}ka^2\\epsilon^2\\right) = \\frac{1}{2}Nka^2\\epsilon^2\n$$\n接下来，我们计算总能量对应变 $\\epsilon$ 的导数：\n$$\n\\frac{\\partial E_{\\mathrm{total}}^{\\mathrm{PBC}}}{\\partial \\epsilon} = \\frac{\\partial}{\\partial \\epsilon} \\left(\\frac{1}{2}Nka^2\\epsilon^2\\right) = Nka^2\\epsilon\n$$\n现在，我们将此结果代入测量的模量 $E_{1\\mathrm{D}}^{\\mathrm{PBC}}$ 的定义中。总参考长度为 $L = Na$：\n$$\nE_{1\\mathrm{D}}^{\\mathrm{PBC}} = \\frac{1}{Na} \\left(Nka^2\\epsilon\\right) \\frac{1}{\\epsilon}\n$$\n简化表达式，我们得到：\n$$\nE_{1\\mathrm{D}}^{\\mathrm{PBC}} = \\frac{Nka^2\\epsilon}{Na\\epsilon} = ka\n$$\n在PBC下测量的模量 $E_{1\\mathrm{D}}^{\\mathrm{PBC}} = ka$ 与原子数 $N$ 无关。这个结果代表了无限材料的本征模量，这也是在体材料模拟中使用PBC的目标。单位是正确的：$[k] \\cdot [a] = (\\mathrm{N/m}) \\cdot \\mathrm{m} = \\mathrm{N}$，这正是 $E_{1\\mathrm{D}}$ 的指定单位。\n\n**情况2：开放边界**\n在开放边界下，链两端的原子（原子 $1$ 和原子 $N$）是“自由”的，每个原子只有一个邻居。其余的 $N-2$ 个内部原子各有两​​个邻居。这个线性链中的总键数为 $N-1$。\n\n总能量 $E_{\\mathrm{total}}^{\\mathrm{open}}$ 为：\n$$\nE_{\\mathrm{total}}^{\\mathrm{open}}(N) = (N-1) \\cdot U_{\\mathrm{bond}} = (N-1) \\left(\\frac{1}{2}ka^2\\epsilon^2\\right) = \\frac{1}{2}(N-1)ka^2\\epsilon^2\n$$\n我们计算关于 $\\epsilon$ 的导数：\n$$\n\\frac{\\partial E_{\\mathrm{total}}^{\\mathrm{open}}(N)}{\\partial \\epsilon} = \\frac{\\partial}{\\partial \\epsilon} \\left(\\frac{1}{2}(N-1)ka^2\\epsilon^2\\right) = (N-1)ka^2\\epsilon\n$$\n我们将此代入模量 $E_{1\\mathrm{D}}^{\\mathrm{open}}(N)$ 的定义中。区域的参考长度仍然是 $L=Na$，因为模量是根据所代表的原子区域的总尺寸进行归一化的。\n$$\nE_{1\\mathrm{D}}^{\\mathrm{open}}(N) = \\frac{1}{Na} \\left((N-1)ka^2\\epsilon\\right) \\frac{1}{\\epsilon}\n$$\n简化后得到：\n$$\nE_{1\\mathrm{D}}^{\\mathrm{open}}(N) = \\frac{(N-1)ka^2\\epsilon}{Na\\epsilon} = \\frac{N-1}{N} ka = \\left(1 - \\frac{1}{N}\\right)ka\n$$\n这个结果表明，在开放边界情况下测得的模量 $E_{1\\mathrm{D}}^{\\mathrm{open}}(N)$ 取决于系统尺寸 $N$。这种与本征值 $ka$ 的偏差是一种有限尺寸效应，源于相对于体材料而言，边界处“缺失”的键。当 $N \\to \\infty$ 时，$E_{1\\mathrm{D}}^{\\mathrm{open}}(N) \\to ka$，如预期那样收敛到体材料的值。\n\n**偏差的量化**\n无量纲偏差 $b(N)$ 定义为用开放边界测量的模量与用PBC测量的模量之间的相对差异：\n$$\nb(N) = \\frac{E_{1\\mathrm{D}}^{\\mathrm{open}}(N) - E_{1\\mathrm{D}}^{\\mathrm{PBC}}}{E_{1\\mathrm{D}}^{\\mathrm{PBC}}}\n$$\n代入我们推导的表达式：\n$$\nb(N) = \\frac{\\left(1 - \\frac{1}{N}\\right)ka - ka}{ka}\n$$\n项 $ka$ 是一个公因子，可以消去，这表明偏差与材料参数 $a$ 和 $k$ 无关。它仅取决于原子数 $N$。\n$$\nb(N) = \\frac{ka\\left(\\left(1 - \\frac{1}{N}\\right) - 1\\right)}{ka} = \\left(1 - \\frac{1}{N}\\right) - 1 = -\\frac{1}{N}\n$$\n偏差就是 $b(N) = -1/N$。负号表示具有开放边界的有限链比PBC情况所代表的体材料显得更软（具有更低的测量模量）。这是因为在相同的原子数和区域长度定义下，少了一个键。\n\n对于给定的测试用例，我们使用此公式计算 $b(N)$。\n- 情况1：$N=1000$。$b(1000) = -1/1000 = -0.001$。\n- 情况2：$N=10$。$b(10) = -1/10 = -0.1$。\n- 情况3：$N=2$。$b(2) = -1/2 = -0.5$。\n- 情况4：$N=50$。$b(50) = -1/50 = -0.02$。\n提供的参数 $a$ 和 $k$ 对于偏差的最终计算不是必需的，但它们对于定义一个物理上完整的问题至关重要，从该问题可以推导出一般性结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the dimensionless bias b(N) for a 1D atomistic chain,\n    representing the finite-size error in the measured elastic modulus\n    when using open boundaries instead of periodic boundary conditions.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (N, a, k), where:\n    # N is the number of atoms (dimensionless)\n    # a is the interatomic spacing (m)\n    # k is the spring stiffness (N/m)\n    test_cases = [\n        (1000, 5.0e-10, 50),  # Case 1\n        (10, 2.5e-10, 75),    # Case 2\n        (2, 1.0e-9, 100),   # Case 3\n        (50, 3.0e-10, 60),    # Case 4\n    ]\n\n    results = []\n    for case in test_cases:\n        N, a, k = case\n        \n        # From the derivation, the measured modulus under Periodic Boundary\n        # Conditions (PBC) is E_pbc = k * a.\n        # This represents the true bulk modulus.\n\n        # The measured modulus under open boundaries (free ends) is\n        # E_open = ((N - 1) / N) * k * a.\n        # This shows a finite-size dependency.\n        \n        # The dimensionless bias b(N) is defined as:\n        # b(N) = (E_open(N) - E_pbc) / E_pbc\n        # Substituting the expressions:\n        # b(N) = ( ((N - 1) / N) * k * a - k * a ) / (k * a)\n        # The 'k * a' term cancels out, leaving:\n        # b(N) = ((N - 1) / N) - 1\n        # b(N) = (N - 1 - N) / N\n        # b(N) = -1 / N\n        #\n        # Therefore, the bias depends only on N, the number of atoms.\n        \n        bias = -1.0 / N\n        results.append(bias)\n\n    # Final print statement in the exact required format.\n    # The output is a comma-separated list of dimensionless decimal fractions.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "分子动力学（MD）模拟是研究原子尺度输运性质的强大工具，但模拟体系的有限尺寸会引入系统误差。本练习将指导你完成一个从原子模拟数据中提取宏观材料参数的典型工作流程。你将通过分析合成的MD轨迹数据来计算硅的自扩散系数，并应用基于连续介质弹性理论的有限尺寸修正，以从有限尺寸模拟结果中推断出无限大体系的真实扩散系数。这项实践将加深你对连接原子尺度涨落和宏观输运系数，以及如何校正模拟尺寸效应的理解。",
            "id": "4143999",
            "problem": "半导体制造过程建模中的硅自扩散计算需要将原子级分子动力学 (MD) 的估算结果与连续介质尺度的参数联系起来。考虑在温度 $T = 1200\\,\\mathrm{K}$ 下，对晶体硅进行平衡态 MD 模拟，使用边长为 $L$ 的立方周期性模拟单元。对于一个标记的硅原子，其自扩散系数 $D$ 通过爱因斯坦关系式定义，\n$$\nD \\;=\\; \\lim_{t\\to\\infty} \\frac{1}{6t} \\left\\langle \\left\\lvert \\mathbf{r}(t) - \\mathbf{r}(0) \\right\\rvert^2 \\right\\rangle \\right.,\n$$\n其中 $\\left\\langle \\cdot \\right\\rangle$ 表示系综平均，$\\mathbf{r}(t)$ 是在时间 $t$ 时标记原子的展开位置（追踪跨越边界的移动）。\n\n在晶体固体中，自扩散是空位介导的，并遵循 Arrhenius 形式，\n$$\nD_\\infty(T) \\;\\propto\\; \\exp\\!\\left(-\\frac{E_f + E_m}{k_\\mathrm{B} T}\\right),\n$$\n其中 $E_f$ 是缺陷形成能，$E_m$ 是缺陷迁移能，$k_\\mathrm{B}$ 是玻尔兹曼常数，$D_\\infty(T)$ 表示无限大系统极限下的扩散系数。在有限周期性单元中，周期性镜像之间的弹性相互作用会通过一个尺寸依赖项 $\\Delta E_f(L) \\approx A/L^3$ (对于足够大的 $L$) 来修正形成能，其中 $A$ 是一个特定于材料的正常数，它包含了弹性偶极子和基体弹性模量的信息。这得到了一个有限尺寸扩散系数\n$$\nD_L(T) \\;\\approx\\; D_\\infty(T)\\,\\exp\\!\\left(-\\frac{\\Delta E_f(L)}{k_\\mathrm{B} T}\\right) \\;=\\; D_\\infty(T)\\,\\exp\\!\\left(-\\frac{A}{k_\\mathrm{B} T\\,L^3}\\right).\n$$\n\n您的任务是实现一个程序，该程序：\n1. 在 $T = 1200\\,\\mathrm{K}$ 的温度下，为 $M$ 个独立的标记硅原子生成合成的平衡态 MD 轨迹。这些原子进行扩散随机游走，其行为与预设的有限尺寸扩散系数 $D_L$ 一致。使用时间步长 $\\Delta t$、总模拟时间 $t_\\mathrm{tot}$ 和边长为 $L$ 的立方周期性边界条件；使用展开位置来计算位移。每个维度的增量应服从均值为零、方差为 $2 D_L \\Delta t$ 的高斯分布，这与 Langevin 方程的连续介质极限一致。\n2. 在均匀间隔的时间点 $t_i = i\\,\\Delta t$（其中 $i=1,2,\\ldots,N$，$N = t_\\mathrm{tot}/\\Delta t$）计算均方位移 (Mean Squared Displacement, MSD)\n$$\n\\mathrm{MSD}(t_i) \\;=\\; \\frac{1}{M}\\sum_{m=1}^M \\left\\lvert \\mathbf{r}_m(t_i) - \\mathbf{r}_m(0) \\right\\rvert^2\n$$\n3. 通过对长时间扩散区域内的 $\\mathrm{MSD}(t)$ 与 $t$ 的关系进行最小二乘线性拟合来估算 $D_L$（通过舍弃前 $f_\\mathrm{cut}$ 比例的时间样本来排除初始的弹道式输运区域）。如果拟合直线为 $\\mathrm{MSD}(t) \\approx a\\,t + b$，则报告 $D_L^\\mathrm{est} = a/6$。\n4. 应用弹性连续介质有限尺寸校正，通过反转上述关系式来估算 $D_\\infty$：\n$$\nD_\\infty^\\mathrm{est} \\;=\\; D_L^\\mathrm{est}\\,\\exp\\!\\left(\\frac{A}{k_\\mathrm{B} T\\,L^3}\\right).\n$$\n\n使用以下常数和单位：\n- 玻尔兹曼常数 $k_\\mathrm{B} = 1.380649\\times 10^{-23}\\,\\mathrm{J/K}$，\n- 所有扩散系数均以 $\\mathrm{m}^2/\\mathrm{s}$ 为单位表示，\n- 在输入参数说明中，长度 $L$ 以 $\\mathrm{nm}$ 表示，但在内部为生成轨迹需转换为 $\\mathrm{m}$；如前所述，在弹性校正中使用以 $\\mathrm{nm}^3$ 为单位的 $L^3$，\n- 参数 $A$ 以 $\\mathrm{eV}\\cdot\\mathrm{nm}^3$ 为单位提供；使用 $1\\,\\mathrm{eV} = 1.602176634\\times 10^{-19}\\,\\mathrm{J}$ 将其转换为 $\\mathrm{J}\\cdot\\mathrm{nm}^3$。\n\n为确保科学真实性和可测试性，假设在 $T = 1200\\,\\mathrm{K}$ 时，基础的无限大系统扩散系数为 $D_\\infty^\\mathrm{true} = 1.0\\times 10^{-18}\\,\\mathrm{m}^2/\\mathrm{s}$。对于给定的测试用例，令 $D_L^\\mathrm{true} = D_\\infty^\\mathrm{true}\\,\\exp\\!\\left(-\\frac{A}{k_\\mathrm{B} T\\,L^3}\\right)$ 为用于生成合成轨迹的真实有限尺寸扩散系数。\n\n实现程序以运行以下测试套件（每个测试用例是一个参数元组 $(L, A, M, \\Delta t, t_\\mathrm{tot}, f_\\mathrm{cut})$）：\n- 测试用例 1： $(L = 5.0\\,\\mathrm{nm},\\, A = 0.6\\,\\mathrm{eV}\\cdot\\mathrm{nm}^3,\\, M = 800,\\, \\Delta t = 5.0\\times 10^{-7}\\,\\mathrm{s},\\, t_\\mathrm{tot} = 0.003\\,\\mathrm{s},\\, f_\\mathrm{cut} = 0.2)$,\n- 测试用例 2： $(L = 10.0\\,\\mathrm{nm},\\, A = 0.6\\,\\mathrm{eV}\\cdot\\mathrm{nm}^3,\\, M = 800,\\, \\Delta t = 5.0\\times 10^{-7}\\,\\mathrm{s},\\, t_\\mathrm{tot} = 0.003\\,\\mathrm{s},\\, f_\\mathrm{cut} = 0.2)$,\n- 测试用例 3： $(L = 10.0\\,\\mathrm{nm},\\, A = 0.0\\,\\mathrm{eV}\\cdot\\mathrm{nm}^3,\\, M = 800,\\, \\Delta t = 5.0\\times 10^{-7}\\,\\mathrm{s},\\, t_\\mathrm{tot} = 0.003\\,\\mathrm{s},\\, f_\\mathrm{cut} = 0.2)$。\n\n您的程序应：\n- 对于每个测试用例，按所述使用 $D_L^\\mathrm{true}$ 生成合成轨迹，\n- 通过对由 $f_\\mathrm{cut}$ 定义的长时间窗口内 $\\mathrm{MSD}(t)$ 关于 $t$ 的线性回归来估算 $D_L^\\mathrm{est}$，\n- 使用弹性连续介质有限尺寸校正计算校正后的估算值 $D_\\infty^\\mathrm{est}$，\n- 输出单行内容，其中包含一个由方括号括起来的逗号分隔列表，内含三个以 $\\mathrm{m}^2/\\mathrm{s}$ 为单位的校正后估算值，按上面列出的测试用例排序。例如，输出格式必须严格符合 $[\\text{result1},\\text{result2},\\text{result3}]$ 的形式，其中每个结果都是一个浮点数。\n\n所有扩散系数均以 $\\mathrm{m}^2/\\mathrm{s}$ 为单位作答，表示为普通十进制浮点数（而非科学记数法字符串），在打印的输出行中不包含单位，也无任何附加文本。",
            "solution": "该问题提出了一个在半导体过程多尺度建模领域中有效且适定的计算任务。它在科学上基于统计力学和连续介质弹性力学的原理，并且所有必需的参数和程序都得到了明确无误的指定。其目标是编写一个程序，模拟有限尺寸系统中的扩散过程，分析生成的合成数据以估算输运系数，然后应用基于连续介质理论的校正将该估算值外推至无限大系统极限。此过程反映了计算材料科学中用于校正原子模拟中有限尺寸效应的常见工作流程。\n\n解决方案通过为每个测试用例实现四个指定的步骤来展开。\n\n1.  **合成数据生成参数 $D_L^\\mathrm{true}$ 的计算**\n    此问题的基础是尺寸为 $L$ 的有限周期性单元中的扩散系数 $D_L(T)$ 与其无限大系统对应物 $D_\\infty(T)$ 之间的关系：\n    $$\n    D_L(T) \\approx D_\\infty(T)\\,\\exp\\!\\left(-\\frac{A}{k_\\mathrm{B} T\\,L^3}\\right)\n    $$\n    此处，$T = 1200\\,\\mathrm{K}$ 是温度，$k_\\mathrm{B}$ 是玻尔兹曼常数，$A$ 是一个与弹性相互作用相关的参数。问题提供了“真实”的无限大系统值，$D_\\infty^\\mathrm{true} = 1.0\\times 10^{-18}\\,\\mathrm{m}^2/\\mathrm{s}$，我们用它来定义用于我们合成轨迹生成的扩散系数 $D_L^\\mathrm{true}$。指数项的参数 $\\frac{A}{k_\\mathrm{B} T\\,L^3}$ 必须是无量纲的。给定输入的单位（$A$ 的单位是 $\\mathrm{eV}\\cdot\\mathrm{nm}^3$，$L$ 的单位是 $\\mathrm{nm}$，$k_\\mathrm{B}$ 的单位是 $\\mathrm{J/K}$，$T$ 的单位是 $\\mathrm{K}$），我们首先使用转换因子 $1\\,\\mathrm{eV} = 1.602176634\\times 10^{-19}\\,\\mathrm{J}$ 将 $A$ 转换为 $\\mathrm{J}\\cdot\\mathrm{nm}^3$ 单位。该参数于是变为：\n    $$\n    \\frac{A\\;[\\mathrm{eV}\\cdot\\mathrm{nm}^3] \\times (1.602176634\\times 10^{-19}\\;\\mathrm{J/eV})}{k_\\mathrm{B}\\;[\\mathrm{J/K}] \\times T\\;[\\mathrm{K}] \\times (L\\;[\\mathrm{nm}])^3}\n    $$\n    单位正确地相消，得到一个无量纲量。然后计算出 $D_L^\\mathrm{true}$ 并用于下一步。\n\n2.  **合成轨迹生成**\n    扩散粒子的运动被建模为三维随机游走。对 $M$ 个粒子中的每一个，其轨迹都通过 $N = t_\\mathrm{tot}/\\Delta t$ 个时间步进行模拟。对于每个维度（$x, y, z$）和每个时间步 $\\Delta t$，位移从均值为 $0$、方差为 $2 D_L^\\mathrm{true} \\Delta t$ 的高斯（正态）分布中抽取。因此，每个位移分量的标准差为 $\\sigma = \\sqrt{2 D_L^\\mathrm{true} \\Delta t}$。在时间 $t_i = i\\,\\Delta t$ 时，一个粒子相对于其原点的总“展开”位移是截至该步的各个随机位移的累积和。\n\n3.  **均方位移 (MSD) 分析与 $D_L^\\mathrm{est}$ 的估算**\n    根据生成的轨迹，我们计算作为时间函数的均方位移 (MSD)。在时间 $t_i$ 的 MSD 是通过对 $M$ 个粒子的系综中位移大小的平方进行平均得到的：\n    $$\n    \\mathrm{MSD}(t_i) \\;=\\; \\frac{1}{M}\\sum_{m=1}^M \\left\\lvert \\mathbf{r}_m(t_i) - \\mathbf{r}_m(0) \\right\\rvert^2\n    $$\n    根据三维扩散的爱因斯坦关系式，在扩散区域中，MSD 与时间成线性正比：\n    $$\n    \\mathrm{MSD}(t) = 6 D t\n    $$\n    我们通过对计算出的 MSD 数据进行线性最小二乘拟合 $\\mathrm{MSD}(t) = a\\,t + b$ 来估算有限尺寸扩散系数 $D_L^\\mathrm{est}$。问题指明，拟合应排除初始 $f_\\mathrm{cut}$ 比例的时间样本，以模仿对真实模拟数据的分析，因为真实数据中可能存在非扩散的弹道式输运区域。拟合直线的斜率 $a$ 给出了扩散系数的估算值：\n    $$\n    D_L^\\mathrm{est} = \\frac{a}{6}\n    $$\n\n4.  **有限尺寸校正与 $D_\\infty^\\mathrm{est}$ 的估算**\n    最后一步是通过反转有限尺寸校正公式来恢复无限大系统扩散系数的估算值 $D_\\infty^\\mathrm{est}$。使用上一步估算的 $D_L^\\mathrm{est}$，我们有：\n    $$\n    D_\\infty^\\mathrm{est} = D_L^\\mathrm{est}\\,\\exp\\!\\left(\\frac{A}{k_\\mathrm{B} T\\,L^3}\\right)\n    $$\n    指数项是步骤 1 中应用的校正因子的倒数。由于合成数据是由 $D_L^\\mathrm{true}$ 生成的，并且分析涉及统计抽样和拟合，因此 $D_\\infty^\\mathrm{est}$ 将是原始 $D_\\infty^\\mathrm{true}$ 的一个估算值，但不完全相同。该估算值的质量验证了整个分析流程的有效性。对三个提供的测试用例中的每一个都执行此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import linregress\n\ndef solve():\n    \"\"\"\n    Solves the problem of estimating the infinite-system self-diffusion coefficient\n    of silicon by generating and analyzing synthetic molecular dynamics trajectories.\n    \"\"\"\n    # Define physical and conversion constants as specified\n    K_B = 1.380649e-23  # Boltzmann constant in J/K\n    EV_TO_J = 1.602176634e-19  # Conversion factor from eV to Joules\n    \n    # Define problem-specific parameters\n    T_K = 1200.0  # Temperature in Kelvin\n    D_INF_TRUE = 1.0e-18  # True infinite-system diffusion coefficient in m^2/s\n\n    # Each test case is a tuple: (L_nm, A_eV_nm3, M, dt_s, t_tot_s, f_cut)\n    test_cases = [\n        (5.0, 0.6, 800, 5.0e-7, 0.003, 0.2),   # Test case 1\n        (10.0, 0.6, 800, 5.0e-7, 0.003, 0.2),  # Test case 2\n        (10.0, 0.0, 800, 5.0e-7, 0.003, 0.2),  # Test case 3\n    ]\n\n    results = []\n    \n    # Set a random seed for reproducible results\n    np.random.seed(42)\n\n    for case in test_cases:\n        L_nm, A_eV_nm3, M, dt_s, t_tot_s, f_cut = case\n\n        # 1. Calculate the 'true' finite-size diffusion coefficient D_L_true\n        # This will be used to generate the synthetic trajectory data.\n        A_J_nm3 = A_eV_nm3 * EV_TO_J\n        exponent_arg = A_J_nm3 / (K_B * T_K * L_nm**3)\n        D_L_true = D_INF_TRUE * np.exp(-exponent_arg)\n\n        # 2. Generate synthetic trajectories for M particles\n        num_steps = int(t_tot_s / dt_s)\n        # Standard deviation for a one-dimensional displacement over one time step\n        sigma_step = np.sqrt(2 * D_L_true * dt_s)\n        \n        # Generate random displacements for M particles, N steps, 3 dimensions\n        displacements = np.random.normal(loc=0.0, scale=sigma_step, size=(M, num_steps, 3))\n        \n        # Cumulatively sum displacements to get unwrapped trajectories relative to r(0)\n        # The resulting shape is (M, num_steps, 3) where trajectories[m, i, :]\n        # is the displacement of particle m at time t_{i+1}.\n        trajectories = np.cumsum(displacements, axis=1)\n\n        # 3. Compute the Mean Squared Displacement (MSD)\n        # Sum the squares of x, y, z displacements for each particle at each time step\n        sq_disp = np.sum(trajectories**2, axis=2)\n        # Average the squared displacements over all M particles to get MSD vs. time\n        msd = np.mean(sq_disp, axis=0)\n        \n        # Create a corresponding time array for the MSD data\n        t_array = np.arange(1, num_steps + 1) * dt_s\n\n        # 4. Estimate D_L from a linear fit of the MSD data\n        # Exclude the initial fraction f_cut of data points from the fit\n        cutoff_index = int(f_cut * num_steps)\n        t_fit = t_array[cutoff_index:]\n        msd_fit = msd[cutoff_index:]\n        \n        # Perform linear regression: MSD(t) = slope * t + intercept\n        slope, intercept, _, _, _ = linregress(t_fit, msd_fit)\n        \n        # Estimate the finite-size diffusion coefficient from the slope (MSD = 6*D*t)\n        D_L_est = slope / 6.0\n\n        # 5. Apply the finite-size correction to estimate the infinite-system D\n        # This inverts the formula used in step 1\n        D_inf_est = D_L_est * np.exp(exponent_arg)\n        \n        results.append(D_inf_est)\n\n    # Final print statement in the exact required format.\n    # The format specifier ensures plain decimal float output, not scientific notation.\n    formatted_results = [f\"{r:.22f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "当材料的微观结构（如表面重构）对宏观性能有显著影响时，我们需要更精细的均匀化方法来建立准确的连续介质模型。本练习将引导你处理一个更高级的多尺度问题：为一个具有二聚体结构重构的硅表面推导其等效的连续介质表面弹性常数。你将应用带有“内部弛豫”的柯西-玻恩法则（Cauchy-Born rule），通过最小化原子在宏观应变场下的总能量，来计算有效的表面刚度。这个练习展示了如何将复杂的原子尺度相互作用和弛豫效应系统地“粗粒化”，从而获得一个能够捕捉微观结构特征的宏观本构关系。",
            "id": "4144033",
            "problem": "一个硅 $(001)$ 表面经历 $(2 \\times 1)$ 重构，其特征是二聚体沿 $x$ 方向排列。考虑一个二维 (2D) 表面连续介质，该介质通过均匀化一个原子超胞得到，每个 $(2 \\times 1)$ 表面单位包含一个二聚体。超胞的尺寸在 $x$ 方向上为 $a_{s}$，在 $y$ 方向上为 $2 a_{s}$，因此超胞面积为 $A = a_{s} \\cdot 2 a_{s}$。在参考（未应变）重构状态下，二聚体键长为 $l_{0}$。宏观面内表面变形是沿 $x$ 方向施加的微小单轴应变 $\\varepsilon_{xx}$，所有其他分量均可忽略不计。\n\n对超胞使用以下原子模型：\n- 二聚体被建模为一个与 $x$ 方向对齐的谐振子弹簧，其拉伸刚度为 $k_{d}$。\n- 两个二聚体原子中的每一个都通过一个刚度为 $k_{s}$ 的谐振子弹簧（与 $x$ 方向对齐）束缚在下层衬底上，该弹簧惩罚每个原子的位移偏离宏观施加位移场的情况。\n\n在表面采用柯西-玻恩 (Cauchy–Born) 假设：在宏观小应变 $\\varepsilon_{xx}$ 下，二聚体端点的参考 $x$ 方向间距 $l_{0}$ 在粗尺度上被仿射映射为 $l_{0} (1 + \\varepsilon_{xx})$。然而，允许这两个原子相对于仿射场沿 $x$ 方向经历额外的内部位移 $v_{1}$ 和 $v_{2}$，从而产生衬底束缚能。超胞的总原子能量是二聚体弹簧能量和两个衬底弹簧能量之和。均匀化的表面自由能密度是通过将原子能量相对于内部位移最小化，然后除以超胞面积 $A$，并展开到 $\\varepsilon_{xx}$ 的二次项得到的。二聚体方向上的有效表面弹性常数 $C^{s,\\mathrm{eff}}_{xxxx}$ 由二次型 $\\gamma(\\varepsilon_{xx}) = \\tfrac{1}{2} C^{s,\\mathrm{eff}}_{xxxx} \\varepsilon_{xx}^{2} + o(\\varepsilon_{xx}^{2})$ 定义。\n\n从基本能量等效性和柯西-玻恩假设出发，通过对内部位移进行最小化并执行均匀化，推导出 $C^{s,\\mathrm{eff}}_{xxxx}$ 的闭合形式解。然后，使用参数\n$a_{s} = 3.84$ Å、$l_{0} = 2.35$ Å、$k_{d} = 100$ N/m 和 $k_{s} = 200$ N/m，\n计算 $C^{s,\\mathrm{eff}}_{xxxx}$ 的数值。\n\n以 $\\text{N}/\\text{m}$ 为单位表示最终答案，并将答案四舍五入到三位有效数字。",
            "solution": "该问题被评估为有效。它在科学上基于连续介质力学和原子建模的原理，特别是使用带有内部弛豫的柯西-玻恩法则进行多尺度均匀化。该问题是适定的、客观的，并提供了一套独立的定义、参数和约束，足以推导出唯一且有意义的解。尽管指定的“$(2 \\times 1)$重构”与给定的超胞尺寸（按照惯例对应于 $(1 \\times 2)$ 重构）之间存在微小的符号不一致，但问题提供了必须使用的明确无误的几何定义（$x$ 方向为 $a_s$， $y$ 方向为 $2a_s$）和面积（$A = 2a_s^2$）。这使得该问题如所述那样内部一致且可解，覆盖了常规命名的模糊性。\n\n有效表面弹性常数 $C^{s,\\mathrm{eff}}_{xxxx}$ 的推导过程如下。\n\n首先，我们建立超胞原子模型的几何学和运动学。设形成二聚体的两个原子的参考位置沿 $x$ 轴为 $x_1^0$ 和 $x_2^0$。我们可以定义它们相对于二聚体中心的位置，使得 $x_1^0 = -l_0/2$ 和 $x_2^0 = l_0/2$，其中 $l_0$ 是初始键长。\n\n在宏观单轴应变 $\\varepsilon_{xx}$ 下，柯西-玻恩假设将这些参考位置映射到仿射变形位置 $x_{i, \\text{affine}} = x_i^0(1+\\varepsilon_{xx})$。问题引入了每个原子相对于此仿射场沿 $x$ 方向的额外内部位移，记为 $v_1$ 和 $v_2$。因此，两个原子的最终位置是：\n$$x_1 = x_1^0(1+\\varepsilon_{xx}) + v_1 = -\\frac{l_0}{2}(1+\\varepsilon_{xx}) + v_1$$\n$$x_2 = x_2^0(1+\\varepsilon_{xx}) + v_2 = \\frac{l_0}{2}(1+\\varepsilon_{xx}) + v_2$$\n\n接下来，我们构建超胞的总势能 $U_{cell}$。该能量由二聚体拉伸能 $U_d$ 和两个衬底束缚能 $U_s$ 组成。\n\n二聚体拉伸能 $U_d$ 被建模为刚度为 $k_d$ 的谐振子弹簧。能量取决于键长的变化量 $\\Delta l$。新的键长为 $l = x_2 - x_1$。\n$$l = \\left(\\frac{l_0}{2}(1+\\varepsilon_{xx}) + v_2\\right) - \\left(-\\frac{l_0}{2}(1+\\varepsilon_{xx}) + v_1\\right) = l_0(1+\\varepsilon_{xx}) + v_2 - v_1$$\n长度的变化量为 $\\Delta l = l - l_0 = l_0\\varepsilon_{xx} + v_2 - v_1$。能量为：\n$$U_d = \\frac{1}{2}k_d(\\Delta l)^2 = \\frac{1}{2}k_d(l_0\\varepsilon_{xx} + v_2 - v_1)^2$$\n\n衬底束缚能 $U_s$ 惩罚每个原子偏离其仿射位置的情况。这些偏离是内部位移 $v_1$ 和 $v_2$。每个原子由刚度为 $k_s$ 的弹簧束缚。\n$$U_s = \\frac{1}{2}k_s v_1^2 + \\frac{1}{2}k_s v_2^2 = \\frac{1}{2}k_s(v_1^2 + v_2^2)$$\n\n超胞的总原子能量是 $U_{cell} = U_d + U_s$ 的总和：\n$$U_{cell}(v_1, v_2) = \\frac{1}{2}k_d(l_0\\varepsilon_{xx} + v_2 - v_1)^2 + \\frac{1}{2}k_s(v_1^2 + v_2^2)$$\n\n为了找到弛豫状态，必须使该能量相对于内部位移 $v_1$ 和 $v_2$ 最小化。我们将 $U_{cell}$ 对 $v_1$ 和 $v_2$ 的偏导数设为零。\n$$\\frac{\\partial U_{cell}}{\\partial v_1} = k_d(l_0\\varepsilon_{xx} + v_2 - v_1)(-1) + k_s v_1 = 0 \\implies (k_d+k_s)v_1 - k_d v_2 = k_d l_0 \\varepsilon_{xx}$$\n$$\\frac{\\partial U_{cell}}{\\partial v_2} = k_d(l_0\\varepsilon_{xx} + v_2 - v_1)(1) + k_s v_2 = 0 \\implies -k_d v_1 + (k_d+k_s)v_2 = -k_d l_0 \\varepsilon_{xx}$$\n从方程的对称性，我们可以推断出 $v_2 = -v_1$。将此代入第一个方程：\n$$(k_d+k_s)v_1 - k_d(-v_1) = k_d l_0 \\varepsilon_{xx} \\implies (2k_d+k_s)v_1 = k_d l_0 \\varepsilon_{xx}$$\n求解平衡位移 $v_1^*$ 和 $v_2^*$：\n$$v_1^* = \\frac{k_d l_0 \\varepsilon_{xx}}{2k_d+k_s}$$\n$$v_2^* = -v_1^* = -\\frac{k_d l_0 \\varepsilon_{xx}}{2k_d+k_s}$$\n\n现在我们将这些平衡位移代回到总能量表达式中，以获得最小化能量 $U_{cell}^{min}$。\n关键项是：\n$$v_2^* - v_1^* = -2v_1^* = -2\\frac{k_d l_0 \\varepsilon_{xx}}{2k_d+k_s}$$\n$$v_1^{*2} + v_2^{*2} = 2v_1^{*2} = 2\\left(\\frac{k_d l_0 \\varepsilon_{xx}}{2k_d+k_s}\\right)^2$$\n代入 $U_{cell}$：\n$$U_{cell}^{min} = \\frac{1}{2}k_d\\left(l_0\\varepsilon_{xx} - 2\\frac{k_d l_0 \\varepsilon_{xx}}{2k_d+k_s}\\right)^2 + \\frac{1}{2}k_s\\left(2\\left(\\frac{k_d l_0 \\varepsilon_{xx}}{2k_d+k_s}\\right)^2\\right)$$\n$$U_{cell}^{min} = \\frac{1}{2}k_d(l_0\\varepsilon_{xx})^2\\left(1 - \\frac{2k_d}{2k_d+k_s}\\right)^2 + k_s\\frac{k_d^2(l_0\\varepsilon_{xx})^2}{(2k_d+k_s)^2}$$\n$$U_{cell}^{min} = \\frac{1}{2}k_d(l_0\\varepsilon_{xx})^2\\left(\\frac{k_s}{2k_d+k_s}\\right)^2 + k_s\\frac{k_d^2(l_0\\varepsilon_{xx})^2}{(2k_d+k_s)^2}$$\n$$U_{cell}^{min} = \\frac{k_d(l_0\\varepsilon_{xx})^2}{(2k_d+k_s)^2}\\left(\\frac{1}{2}k_s^2 + k_s k_d\\right) = \\frac{k_d(l_0\\varepsilon_{xx})^2}{(2k_d+k_s)^2}\\frac{k_s}{2}(k_s + 2k_d)$$\n$$U_{cell}^{min} = \\frac{1}{2}(l_0\\varepsilon_{xx})^2 \\frac{k_d k_s}{2k_d+k_s} = \\frac{1}{2} l_0^2 \\frac{k_d k_s}{2k_d+k_s}\\varepsilon_{xx}^2$$\n\n均匀化的表面自由能密度 $\\gamma(\\varepsilon_{xx})$ 是最小化的胞能量除以超胞面积 $A = 2a_s^2$。\n$$\\gamma(\\varepsilon_{xx}) = \\frac{U_{cell}^{min}}{A} = \\frac{1}{2a_s^2} \\left(\\frac{1}{2} l_0^2 \\frac{k_d k_s}{2k_d+k_s}\\varepsilon_{xx}^2\\right) = \\frac{l_0^2 k_d k_s}{4a_s^2(2k_d+k_s)}\\varepsilon_{xx}^2$$\n\n问题通过关系式 $\\gamma(\\varepsilon_{xx}) = \\frac{1}{2} C^{s,\\mathrm{eff}}_{xxxx} \\varepsilon_{xx}^2$ 定义了有效表面弹性常数 $C^{s,\\mathrm{eff}}_{xxxx}$。通过比较 $\\gamma(\\varepsilon_{xx})$ 的两个表达式，我们确定该常数：\n$$\\frac{1}{2} C^{s,\\mathrm{eff}}_{xxxx} = \\frac{l_0^2 k_d k_s}{4a_s^2(2k_d+k_s)}$$\n$$C^{s,\\mathrm{eff}}_{xxxx} = \\frac{l_0^2 k_d k_s}{2a_s^2(2k_d+k_s)}$$\n\n最后，我们使用提供的参数计算数值：\n$a_s = 3.84 \\times 10^{-10}~\\text{m}$\n$l_0 = 2.35 \\times 10^{-10}~\\text{m}$\n$k_d = 100~\\text{N}/\\text{m}$\n$k_s = 200~\\text{N}/\\text{m}$\n\n$$C^{s,\\mathrm{eff}}_{xxxx} = \\frac{(2.35 \\times 10^{-10})^2 (100) (200)}{2(3.84 \\times 10^{-10})^2 (2(100)+200)}$$\n$$C^{s,\\mathrm{eff}}_{xxxx} = \\frac{5.5225 \\times 10^{-20} \\cdot 20000}{2(14.7456 \\times 10^{-20}) (400)}$$\n$$C^{s,\\mathrm{eff}}_{xxxx} = \\frac{1.1045 \\times 10^{-15}}{2(14.7456 \\times 10^{-20}) (400)} = \\frac{1.1045 \\times 10^{-15}}{11796.48 \\times 10^{-20}} = \\frac{1.1045 \\times 10^{-15}}{1.179648 \\times 10^{-16}}$$\n$$C^{s,\\mathrm{eff}}_{xxxx} \\approx 9.36295~\\text{N}/\\text{m}$$\n四舍五入到三位有效数字，结果为 $9.36~\\text{N}/\\text{m}$。",
            "answer": "$$\\boxed{9.36}$$"
        }
    ]
}