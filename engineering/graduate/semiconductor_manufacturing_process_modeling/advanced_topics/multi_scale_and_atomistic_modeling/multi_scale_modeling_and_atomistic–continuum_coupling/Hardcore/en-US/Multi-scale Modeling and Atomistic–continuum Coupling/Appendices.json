{
    "hands_on_practices": [
        {
            "introduction": "In many atomistic-continuum coupling schemes, a small, computationally-tractable atomistic region is used to capture complex physics that continuum models miss. A fundamental question is how to treat the boundaries of this region so it accurately represents a piece of a much larger, effectively infinite, bulk material. This exercise  explores this issue by comparing the calculated elastic modulus of a simple 1D atomic chain under periodic and open boundary conditions. Through a direct derivation, you will quantify the finite-size error introduced by artificial surfaces, providing a clear justification for the widespread use of periodic boundary conditions in simulating bulk properties.",
            "id": "4144074",
            "problem": "Consider an atomistic–continuum (A–C) coupled model of a homogeneous crystalline material undergoing a spatially uniform small-strain deformation. The atomistic subdomain is embedded deep inside the continuum region, which is well-approximated as infinite. To eliminate artificial surface artifacts at the atomistic boundary and to mimic being inside an infinite medium, the atomistic subdomain is often simulated with Periodic Boundary Conditions (PBC). In this problem, you will justify the use of Periodic Boundary Conditions (PBC) in the atomistic subdomain by deriving the measured elastic response under uniform strain and quantifying the finite-size effect due to domain size when PBC is not used.\n\nStart from a one-dimensional discrete atomistic representation of the continuum bar, consisting of $N$ atoms equally spaced by $a$ in the reference configuration, with nearest-neighbor harmonic interactions of stiffness $k$ (units: $\\mathrm{N/m}$). Let the macroscopic continuum impose a uniform small strain $\\epsilon$ on the atomistic region. The atomistic energy is the sum of quadratic pairwise spring energies for each bond that experiences an elongation of $a\\,\\epsilon$. The total reference length of the atomistic domain is $L = N a$ (units: $\\mathrm{m}$). Assume linear response and neglect anharmonic effects.\n\nFrom fundamental principles of linear elasticity and harmonic interactions, derive the one-dimensional measured modulus $E_{1\\mathrm{D}}$ (units: $\\mathrm{N}$) defined by the relation\n$$\nE_{1\\mathrm{D}} = \\frac{1}{L}\\,\\frac{\\partial E_\\mathrm{total}}{\\partial \\epsilon}\\,\\frac{1}{\\epsilon},\n$$\nwhere $E_\\mathrm{total}$ is the total atomistic energy under the imposed uniform strain $\\epsilon$. Show that:\n- Under Periodic Boundary Conditions (PBC), the number of bonds is equal to $N$, and the measured modulus $E_{1\\mathrm{D}}^\\mathrm{PBC}$ is independent of $N$.\n- Under open boundaries (e.g., non-periodic with no neighbor beyond the endpoints), the number of bonds is equal to $N-1$, leading to a finite-size correction in the measured modulus $E_{1\\mathrm{D}}^\\mathrm{open}(N)$.\n\nUsing these results, quantify the effect of domain size on the measured property by the dimensionless bias\n$$\nb(N) = \\frac{E_{1\\mathrm{D}}^\\mathrm{open}(N) - E_{1\\mathrm{D}}^\\mathrm{PBC}}{E_{1\\mathrm{D}}^\\mathrm{PBC}}.\n$$\n\nYou must implement a complete, runnable program that, for the test suite below, computes $b(N)$ for each case. The final output must be a single line containing a comma-separated list of the biases, enclosed in square brackets. The output must be dimensionless decimal fractions (no percentage sign), and no other text should be printed.\n\nTest Suite (each tuple lists $(N, a, k)$ in the specified units; $a$ in $\\mathrm{m}$, $k$ in $\\mathrm{N/m}$):\n- Case $1$: $(N, a, k) = (1000, 5.0\\times 10^{-10}, 50)$.\n- Case $2$: $(N, a, k) = (10, 2.5\\times 10^{-10}, 75)$.\n- Case $3$: $(N, a, k) = (2, 1.0\\times 10^{-9}, 100)$.\n- Case $4$: $(N, a, k) = (50, 3.0\\times 10^{-10}, 60)$.\n\nYour program should produce a single line of output containing the biases for Cases $1$ through $4$ in order, as a comma-separated list enclosed in square brackets (for example, $[b_1,b_2,b_3,b_4]$). Since the requested outputs are dimensionless, no physical units are required in the output.",
            "solution": "The problem is valid. It is scientifically grounded in the principles of solid-state physics and linear elasticity, using a standard harmonic approximation for interatomic forces. The problem is well-posed, with all necessary parameters and definitions provided to derive a unique and meaningful solution. It is objective and directly relevant to the study of finite-size effects in multi-scale simulations. We will proceed with the derivation.\n\nThe objective is to derive the one-dimensional measured elastic modulus, $E_{1\\mathrm{D}}$, for a discrete chain of atoms under two different boundary conditions: Periodic Boundary Conditions (PBC) and open boundaries. We will then use these results to calculate the dimensionless bias $b(N)$, which quantifies the finite-size error introduced by using open boundaries instead of PBC.\n\nThe fundamental energy of a single harmonic bond (a spring) with stiffness $k$ displaced by an amount $\\Delta x$ from its equilibrium length is given by $U_{\\mathrm{bond}} = \\frac{1}{2}k(\\Delta x)^2$. The problem states that the system is subjected to a uniform small strain $\\epsilon$. In a chain of atoms with initial spacing $a$, the elongation of each bond is $\\Delta x = a \\epsilon$. Therefore, the energy stored in each individual bond is:\n$$\nU_{\\mathrm{bond}} = \\frac{1}{2}k(a\\epsilon)^2 = \\frac{1}{2}ka^2\\epsilon^2\n$$\nThe total potential energy of the atomistic domain, $E_{\\mathrm{total}}$, is the sum of the energies of all bonds.\n\nThe one-dimensional measured modulus $E_{1\\mathrm{D}}$ is defined by the relation:\n$$\nE_{1\\mathrm{D}} = \\frac{1}{L}\\,\\frac{\\partial E_\\mathrm{total}}{\\partial \\epsilon}\\,\\frac{1}{\\epsilon}\n$$\nwhere $L = Na$ is the total reference length of the domain.\n\nWe analyze the two cases separately.\n\n**Case 1: Periodic Boundary Conditions (PBC)**\nUnder PBC, the one-dimensional chain of $N$ atoms is treated as a closed ring, where atom $N$ is bonded to atom $1$. Consequently, every atom has exactly two neighbors, and the total number of bonds in the system is equal to the number of atoms, $N$.\n\nThe total energy $E_{\\mathrm{total}}^{\\mathrm{PBC}}$ is the energy per bond multiplied by the number of bonds:\n$$\nE_{\\mathrm{total}}^{\\mathrm{PBC}} = N \\cdot U_{\\mathrm{bond}} = N \\left(\\frac{1}{2}ka^2\\epsilon^2\\right) = \\frac{1}{2}Nka^2\\epsilon^2\n$$\nNext, we compute the derivative of the total energy with respect to strain $\\epsilon$:\n$$\n\\frac{\\partial E_{\\mathrm{total}}^{\\mathrm{PBC}}}{\\partial \\epsilon} = \\frac{\\partial}{\\partial \\epsilon} \\left(\\frac{1}{2}Nka^2\\epsilon^2\\right) = Nka^2\\epsilon\n$$\nNow, we substitute this result into the definition for the measured modulus $E_{1\\mathrm{D}}^{\\mathrm{PBC}}$. The total reference length is $L = Na$:\n$$\nE_{1\\mathrm{D}}^{\\mathrm{PBC}} = \\frac{1}{Na} \\left(Nka^2\\epsilon\\right) \\frac{1}{\\epsilon}\n$$\nSimplifying the expression, we find:\n$$\nE_{1\\mathrm{D}}^{\\mathrm{PBC}} = \\frac{Nka^2\\epsilon}{Na\\epsilon} = ka\n$$\nThe measured modulus under PBC, $E_{1\\mathrm{D}}^{\\mathrm{PBC}} = ka$, is independent of the number of atoms $N$. This result represents the intrinsic modulus of the infinite material, which is the goal of using PBC in simulations of bulk materials. The units are correct: $[k] \\cdot [a] = (\\mathrm{N/m}) \\cdot \\mathrm{m} = \\mathrm{N}$, which are the specified units for $E_{1\\mathrm{D}}$.\n\n**Case 2: Open Boundaries**\nUnder open boundaries, the atoms at the ends of the chain (atom $1$ and atom $N$) are \"free\" and have only one neighbor each. The remaining $N-2$ interior atoms each have two neighbors. The total number of bonds in this linear chain is $N-1$.\n\nThe total energy $E_{\\mathrm{total}}^{\\mathrm{open}}$ is:\n$$\nE_{\\mathrm{total}}^{\\mathrm{open}}(N) = (N-1) \\cdot U_{\\mathrm{bond}} = (N-1) \\left(\\frac{1}{2}ka^2\\epsilon^2\\right) = \\frac{1}{2}(N-1)ka^2\\epsilon^2\n$$\nWe compute the derivative with respect to $\\epsilon$:\n$$\n\\frac{\\partial E_{\\mathrm{total}}^{\\mathrm{open}}(N)}{\\partial \\epsilon} = \\frac{\\partial}{\\partial \\epsilon} \\left(\\frac{1}{2}(N-1)ka^2\\epsilon^2\\right) = (N-1)ka^2\\epsilon\n$$\nWe substitute this into the definition for the modulus $E_{1\\mathrm{D}}^{\\mathrm{open}}(N)$. The reference length of the domain is still $L=Na$, as the modulus is normalized by the total size of the atomistic region being represented.\n$$\nE_{1\\mathrm{D}}^{\\mathrm{open}}(N) = \\frac{1}{Na} \\left((N-1)ka^2\\epsilon\\right) \\frac{1}{\\epsilon}\n$$\nSimplifying yields:\n$$\nE_{1\\mathrm{D}}^{\\mathrm{open}}(N) = \\frac{(N-1)ka^2\\epsilon}{Na\\epsilon} = \\frac{N-1}{N} ka = \\left(1 - \\frac{1}{N}\\right)ka\n$$\nThis result shows that the measured modulus for the open-boundary case, $E_{1\\mathrm{D}}^{\\mathrm{open}}(N)$, depends on the system size $N$. This deviation from the intrinsic value $ka$ is a finite-size effect, arising from the \"missing\" bond at the boundary relative to the bulk. As $N \\to \\infty$, $E_{1\\mathrm{D}}^{\\mathrm{open}}(N) \\to ka$, converging to the bulk value as expected.\n\n**Quantification of the Bias**\nThe dimensionless bias $b(N)$ is defined as the relative difference between the modulus measured with open boundaries and the modulus measured with PBC:\n$$\nb(N) = \\frac{E_{1\\mathrm{D}}^{\\mathrm{open}}(N) - E_{1\\mathrm{D}}^{\\mathrm{PBC}}}{E_{1\\mathrm{D}}^{\\mathrm{PBC}}}\n$$\nSubstituting the expressions we derived:\n$$\nb(N) = \\frac{\\left(1 - \\frac{1}{N}\\right)ka - ka}{ka}\n$$\nThe term $ka$ is a common factor and cancels out, revealing that the bias is independent of the material parameters $a$ and $k$. It depends only on the number of atoms $N$.\n$$\nb(N) = \\frac{ka\\left(\\left(1 - \\frac{1}{N}\\right) - 1\\right)}{ka} = \\left(1 - \\frac{1}{N}\\right) - 1 = -\\frac{1}{N}\n$$\nThe bias is simply $b(N) = -1/N$. The negative sign indicates that the finite chain with open boundaries appears softer (has a lower measured modulus) than the bulk material represented by the PBC case. This is because there is one fewer bond for the same number of atoms and domain length definition.\n\nFor the given test cases, we calculate $b(N)$ using this formula.\n- Case $1$: $N=1000$. $b(1000) = -1/1000 = -0.001$.\n- Case $2$: $N=10$. $b(10) = -1/10 = -0.1$.\n- Case $3$: $N=2$. $b(2) = -1/2 = -0.5$.\n- Case $4$: $N=50$. $b(50) = -1/50 = -0.02$.\nThe provided parameters $a$ and $k$ are not required for the final calculation of the bias, but they are essential for defining a physically complete problem from which the general result is derived.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the dimensionless bias b(N) for a 1D atomistic chain,\n    representing the finite-size error in the measured elastic modulus\n    when using open boundaries instead of periodic boundary conditions.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (N, a, k), where:\n    # N is the number of atoms (dimensionless)\n    # a is the interatomic spacing (m)\n    # k is the spring stiffness (N/m)\n    test_cases = [\n        (1000, 5.0e-10, 50),  # Case 1\n        (10, 2.5e-10, 75),    # Case 2\n        (2, 1.0e-9, 100),   # Case 3\n        (50, 3.0e-10, 60),    # Case 4\n    ]\n\n    results = []\n    for case in test_cases:\n        N, a, k = case\n        \n        # From the derivation, the measured modulus under Periodic Boundary\n        # Conditions (PBC) is E_pbc = k * a.\n        # This represents the true bulk modulus.\n\n        # The measured modulus under open boundaries (free ends) is\n        # E_open = ((N - 1) / N) * k * a.\n        # This shows a finite-size dependency.\n        \n        # The dimensionless bias b(N) is defined as:\n        # b(N) = (E_open(N) - E_pbc) / E_pbc\n        # Substituting the expressions:\n        # b(N) = ( ((N - 1) / N) * k * a - k * a ) / (k * a)\n        # The 'k * a' term cancels out, leaving:\n        # b(N) = ((N - 1) / N) - 1\n        # b(N) = (N - 1 - N) / N\n        # b(N) = -1 / N\n        #\n        # Therefore, the bias depends only on N, the number of atoms.\n        \n        bias = -1.0 / N\n        results.append(bias)\n\n    # Final print statement in the exact required format.\n    # The output is a comma-separated list of dimensionless decimal fractions.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Beyond static properties, multi-scale modeling is crucial for determining transport coefficients for continuum-level process simulations. This practice  guides you through a typical workflow: extracting a macroscopic diffusion coefficient from microscopic particle trajectories. You will generate synthetic data mimicking a Molecular Dynamics simulation, use the Einstein relation to compute a finite-size diffusion coefficient $D_L$, and then apply a correction based on continuum elasticity theory to extrapolate to the infinite-system limit $D_\\infty$. This exercise beautifully illustrates the \"handshake\" between scales, where a continuum model is used to refine a parameter obtained from an atomistic one.",
            "id": "4143999",
            "problem": "A silicon self-diffusion calculation in semiconductor manufacturing process modeling requires connecting atomistic Molecular Dynamics (MD) estimates to continuum-scale parameters. Consider equilibrium MD for crystalline silicon at temperature $T = 1200\\,\\mathrm{K}$ and a cubic periodic simulation cell of edge length $L$. The self-diffusion coefficient $D$ is defined via the Einstein relation for a tagged silicon atom, \n$$\nD \\;=\\; \\lim_{t\\to\\infty} \\frac{1}{6t} \\left\\langle \\left\\lvert \\mathbf{r}(t) - \\mathbf{r}(0) \\right\\rvert^2 \\right\\rangle \\right.,\n$$\nwhere $\\left\\langle \\cdot \\right\\rangle$ denotes an ensemble average, and $\\mathbf{r}(t)$ is the unwrapped position (tracking boundary crossings) of the tagged atom at time $t$.\n\nIn crystalline solids, self-diffusion is vacancy-mediated and follows an Arrhenius form, \n$$\nD_\\infty(T) \\;\\propto\\; \\exp\\!\\left(-\\frac{E_f + E_m}{k_\\mathrm{B} T}\\right),\n$$\nwhere $E_f$ is the defect formation energy, $E_m$ is the defect migration energy, $k_\\mathrm{B}$ is the Boltzmann constant, and $D_\\infty(T)$ denotes the diffusion coefficient in the infinite-system limit. In a finite periodic cell, elastic interactions between periodic images modify the formation energy by a size-dependent term $\\Delta E_f(L) \\approx A/L^3$ for sufficiently large $L$, where $A$ is a material-specific positive constant encapsulating the elastic dipole and host elastic moduli. This yields a finite-size diffusion coefficient\n$$\nD_L(T) \\;\\approx\\; D_\\infty(T)\\,\\exp\\!\\left(-\\frac{\\Delta E_f(L)}{k_\\mathrm{B} T}\\right) \\;=\\; D_\\infty(T)\\,\\exp\\!\\left(-\\frac{A}{k_\\mathrm{B} T\\,L^3}\\right).\n$$\n\nYour task is to implement a program that:\n1. Generates synthetic equilibrium MD trajectories for $M$ independent tagged silicon atoms undergoing a diffusive random walk consistent with a prescribed finite-size diffusion coefficient $D_L$ at $T = 1200\\,\\mathrm{K}$. Use a time step $\\Delta t$, total simulation time $t_\\mathrm{tot}$, and cubic periodic boundary conditions of edge length $L$; use unwrapped positions to compute displacements. The per-dimension increment should be a Gaussian with zero mean and variance $2 D_L \\Delta t$, consistent with the continuum limit of the Langevin equation.\n2. Computes the mean squared displacement (Mean Squared Displacement (MSD)) \n$$\n\\mathrm{MSD}(t_i) \\;=\\; \\frac{1}{M}\\sum_{m=1}^M \\left\\lvert \\mathbf{r}_m(t_i) - \\mathbf{r}_m(0) \\right\\rvert^2\n$$\nat evenly spaced times $t_i = i\\,\\Delta t$ for $i=1,2,\\ldots,N$ with $N = t_\\mathrm{tot}/\\Delta t$.\n3. Estimates $D_L$ by performing a least-squares linear fit of $\\mathrm{MSD}(t)$ versus $t$ over the long-time diffusive regime (exclude the initial ballistic regime by discarding the first fraction $f_\\mathrm{cut}$ of the time samples). If the fitted line is $\\mathrm{MSD}(t) \\approx a\\,t + b$, then report $D_L^\\mathrm{est} = a/6$.\n4. Applies the elastic-continuum finite-size correction to estimate $D_\\infty$ via inversion of the above relation:\n$$\nD_\\infty^\\mathrm{est} \\;=\\; D_L^\\mathrm{est}\\,\\exp\\!\\left(\\frac{A}{k_\\mathrm{B} T\\,L^3}\\right).\n$$\n\nUse the following constants and units:\n- Boltzmann constant $k_\\mathrm{B} = 1.380649\\times 10^{-23}\\,\\mathrm{J/K}$,\n- Express all diffusion coefficients in $\\mathrm{m}^2/\\mathrm{s}$,\n- Express lengths $L$ in $\\mathrm{nm}$ in the input parameter specification but convert to $\\mathrm{m}$ internally for trajectory generation; use $L^3$ in $\\mathrm{nm}^3$ for the elastic correction as stated,\n- The parameter $A$ is provided in $\\mathrm{eV}\\cdot\\mathrm{nm}^3$; convert to $\\mathrm{J}\\cdot\\mathrm{nm}^3$ using $1\\,\\mathrm{eV} = 1.602176634\\times 10^{-19}\\,\\mathrm{J}$.\n\nTo ensure scientific realism and testability, assume that the underlying infinite-system diffusion coefficient at $T = 1200\\,\\mathrm{K}$ is $D_\\infty^\\mathrm{true} = 1.0\\times 10^{-18}\\,\\mathrm{m}^2/\\mathrm{s}$. For a given test case, let $D_L^\\mathrm{true} = D_\\infty^\\mathrm{true}\\,\\exp\\!\\left(-\\frac{A}{k_\\mathrm{B} T\\,L^3}\\right)$ be the true finite-size diffusion coefficient used to generate synthetic trajectories.\n\nImplement the program to run the following test suite (each test case is a tuple of parameters $(L, A, M, \\Delta t, t_\\mathrm{tot}, f_\\mathrm{cut})$):\n- Test case $1$: $(L = 5.0\\,\\mathrm{nm},\\, A = 0.6\\,\\mathrm{eV}\\cdot\\mathrm{nm}^3,\\, M = 800,\\, \\Delta t = 5.0\\times 10^{-7}\\,\\mathrm{s},\\, t_\\mathrm{tot} = 0.003\\,\\mathrm{s},\\, f_\\mathrm{cut} = 0.2)$,\n- Test case $2$: $(L = 10.0\\,\\mathrm{nm},\\, A = 0.6\\,\\mathrm{eV}\\cdot\\mathrm{nm}^3,\\, M = 800,\\, \\Delta t = 5.0\\times 10^{-7}\\,\\mathrm{s},\\, t_\\mathrm{tot} = 0.003\\,\\mathrm{s},\\, f_\\mathrm{cut} = 0.2)$,\n- Test case $3$: $(L = 10.0\\,\\mathrm{nm},\\, A = 0.0\\,\\mathrm{eV}\\cdot\\mathrm{nm}^3,\\, M = 800,\\, \\Delta t = 5.0\\times 10^{-7}\\,\\mathrm{s},\\, t_\\mathrm{tot} = 0.003\\,\\mathrm{s},\\, f_\\mathrm{cut} = 0.2)$.\n\nYour program should:\n- For each test case, generate synthetic trajectories using $D_L^\\mathrm{true}$ as described,\n- Estimate $D_L^\\mathrm{est}$ by linear regression of $\\mathrm{MSD}(t)$ on $t$ over the long-time window defined by $f_\\mathrm{cut}$,\n- Compute the corrected estimate $D_\\infty^\\mathrm{est}$ using the elastic-continuum finite-size correction,\n- Output a single line containing a comma-separated list enclosed in square brackets with the three corrected estimates in $\\mathrm{m}^2/\\mathrm{s}$, ordered by the test cases listed above. For example, the output format must be exactly of the form $[\\text{result1},\\text{result2},\\text{result3}]$, where each result is a floating-point number.\n\nAnswer all diffusion coefficients in $\\mathrm{m}^2/\\mathrm{s}$ as plain decimal floats (not scientific notation strings), with no units in the printed output line and no additional text.",
            "solution": "The problem presents a valid and well-posed computational task in the field of multi-scale modeling for semiconductor processes. It is scientifically grounded in the principles of statistical mechanics and continuum elasticity, and all required parameters and procedures are specified unambiguously. The objective is to write a program that simulates a diffusive process in a finite-sized system, analyzes the resulting synthetic data to estimate a transport coefficient, and then applies a continuum-theory-based correction to extrapolate this estimate to the infinite-system limit. This procedure mirrors a common workflow in computational materials science for correcting finite-size effects in atomistic simulations.\n\nThe solution proceeds by implementing the four specified steps for each test case.\n\n1.  **Calculation of the Synthetic Data Generation Parameter $D_L^\\mathrm{true}$**\n    The foundation of this problem is the relationship between the diffusion coefficient in a finite periodic cell of size $L$, denoted $D_L(T)$, and its infinite-system counterpart, $D_\\infty(T)$:\n    $$\n    D_L(T) \\approx D_\\infty(T)\\,\\exp\\!\\left(-\\frac{A}{k_\\mathrm{B} T\\,L^3}\\right)\n    $$\n    Here, $T = 1200\\,\\mathrm{K}$ is the temperature, $k_\\mathrm{B}$ is the Boltzmann constant, and $A$ is a parameter related to elastic interactions. The problem provides the \"true\" infinite-system value, $D_\\infty^\\mathrm{true} = 1.0\\times 10^{-18}\\,\\mathrm{m}^2/\\mathrm{s}$, which we use to define the diffusion coefficient for our synthetic trajectory generation, $D_L^\\mathrm{true}$. The exponential term's argument, $\\frac{A}{k_\\mathrm{B} T\\,L^3}$, must be dimensionless. Given the units of the inputs ($A$ in $\\mathrm{eV}\\cdot\\mathrm{nm}^3$, $L$ in $\\mathrm{nm}$, $k_\\mathrm{B}$ in $\\mathrm{J/K}$, and $T$ in $\\mathrm{K}$), we first convert $A$ to units of $\\mathrm{J}\\cdot\\mathrm{nm}^3$ using the conversion factor $1\\,\\mathrm{eV} = 1.602176634\\times 10^{-19}\\,\\mathrm{J}$. The argument then becomes:\n    $$\n    \\frac{A\\;[\\mathrm{eV}\\cdot\\mathrm{nm}^3] \\times (1.602176634\\times 10^{-19}\\;\\mathrm{J/eV})}{k_\\mathrm{B}\\;[\\mathrm{J/K}] \\times T\\;[\\mathrm{K}] \\times (L\\;[\\mathrm{nm}])^3}\n    $$\n    The units correctly cancel, yielding a dimensionless quantity. $D_L^\\mathrm{true}$ is then calculated and used in the next step.\n\n2.  **Synthetic Trajectory Generation**\n    The motion of a diffusing particle is modeled as a 3D random walk. The trajectory of each of the $M$ particles is simulated over $N = t_\\mathrm{tot}/\\Delta t$ time steps. For each dimension ($x, y, z$) and each time step $\\Delta t$, the displacement is drawn from a Gaussian (normal) distribution with a mean of $0$ and a variance of $2 D_L^\\mathrm{true} \\Delta t$. The standard deviation for each displacement component is therefore $\\sigma = \\sqrt{2 D_L^\\mathrm{true} \\Delta t}$. The total \"unwrapped\" displacement of a particle from its origin at time $t_i = i\\,\\Delta t$ is the cumulative sum of the individual random displacements up to that step.\n\n3.  **Mean Squared Displacement (MSD) Analysis and Estimation of $D_L^\\mathrm{est}$**\n    From the generated trajectories, we calculate the Mean Squared Displacement (MSD) as a function of time. The MSD at time $t_i$ is given by averaging the squared displacement magnitudes over the ensemble of $M$ particles:\n    $$\n    \\mathrm{MSD}(t_i) \\;=\\; \\frac{1}{M}\\sum_{m=1}^M \\left\\lvert \\mathbf{r}_m(t_i) - \\mathbf{r}_m(0) \\right\\rvert^2\n    $$\n    According to the Einstein relation for 3D diffusion, the MSD is linearly proportional to time in the diffusive regime:\n    $$\n    \\mathrm{MSD}(t) = 6 D t\n    $$\n    We estimate the finite-size diffusion coefficient, $D_L^\\mathrm{est}$, by performing a linear least-squares fit to the computed MSD data, $\\mathrm{MSD}(t) = a\\,t + b$. The problem specifies that the fit should exclude the initial fraction $f_\\mathrm{cut}$ of time samples to mimic the analysis of real simulation data where a non-diffusive ballistic regime may exist. The slope $a$ of the fitted line gives the estimate for the diffusion coefficient:\n    $$\n    D_L^\\mathrm{est} = \\frac{a}{6}\n    $$\n\n4.  **Finite-Size Correction and Estimation of $D_\\infty^\\mathrm{est}$**\n    The final step is to recover an estimate for the infinite-system diffusion coefficient, $D_\\infty^\\mathrm{est}$, by inverting the finite-size correction formula. Using the estimated $D_L^\\mathrm{est}$ from the previous step, we have:\n    $$\n    D_\\infty^\\mathrm{est} = D_L^\\mathrm{est}\\,\\exp\\!\\left(\\frac{A}{k_\\mathrm{B} T\\,L^3}\\right)\n    $$\n    The exponential term is the inverse of the correction factor applied in step 1. Because the synthetic data was generated from $D_L^\\mathrm{true}$ and the analysis involves statistical sampling and fitting, $D_\\infty^\\mathrm{est}$ will be an estimate of, but not exactly identical to, the original $D_\\infty^\\mathrm{true}$. The quality of this estimate validates the entire analysis pipeline. This procedure is executed for each of the three provided test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import linregress\n\ndef solve():\n    \"\"\"\n    Solves the problem of estimating the infinite-system self-diffusion coefficient\n    of silicon by generating and analyzing synthetic molecular dynamics trajectories.\n    \"\"\"\n    # Define physical and conversion constants as specified\n    K_B = 1.380649e-23  # Boltzmann constant in J/K\n    EV_TO_J = 1.602176634e-19  # Conversion factor from eV to Joules\n    \n    # Define problem-specific parameters\n    T_K = 1200.0  # Temperature in Kelvin\n    D_INF_TRUE = 1.0e-18  # True infinite-system diffusion coefficient in m^2/s\n\n    # Each test case is a tuple: (L_nm, A_eV_nm3, M, dt_s, t_tot_s, f_cut)\n    test_cases = [\n        (5.0, 0.6, 800, 5.0e-7, 0.003, 0.2),   # Test case 1\n        (10.0, 0.6, 800, 5.0e-7, 0.003, 0.2),  # Test case 2\n        (10.0, 0.0, 800, 5.0e-7, 0.003, 0.2),  # Test case 3\n    ]\n\n    results = []\n    \n    # Set a random seed for reproducible results\n    np.random.seed(42)\n\n    for case in test_cases:\n        L_nm, A_eV_nm3, M, dt_s, t_tot_s, f_cut = case\n\n        # 1. Calculate the 'true' finite-size diffusion coefficient D_L_true\n        # This will be used to generate the synthetic trajectory data.\n        A_J_nm3 = A_eV_nm3 * EV_TO_J\n        exponent_arg = A_J_nm3 / (K_B * T_K * L_nm**3)\n        D_L_true = D_INF_TRUE * np.exp(-exponent_arg)\n\n        # 2. Generate synthetic trajectories for M particles\n        num_steps = int(t_tot_s / dt_s)\n        # Standard deviation for a one-dimensional displacement over one time step\n        sigma_step = np.sqrt(2 * D_L_true * dt_s)\n        \n        # Generate random displacements for M particles, N steps, 3 dimensions\n        displacements = np.random.normal(loc=0.0, scale=sigma_step, size=(M, num_steps, 3))\n        \n        # Cumulatively sum displacements to get unwrapped trajectories relative to r(0)\n        # The resulting shape is (M, num_steps, 3) where trajectories[m, i, :]\n        # is the displacement of particle m at time t_{i+1}.\n        trajectories = np.cumsum(displacements, axis=1)\n\n        # 3. Compute the Mean Squared Displacement (MSD)\n        # Sum the squares of x, y, z displacements for each particle at each time step\n        sq_disp = np.sum(trajectories**2, axis=2)\n        # Average the squared displacements over all M particles to get MSD vs. time\n        msd = np.mean(sq_disp, axis=0)\n        \n        # Create a corresponding time array for the MSD data\n        t_array = np.arange(1, num_steps + 1) * dt_s\n\n        # 4. Estimate D_L from a linear fit of the MSD data\n        # Exclude the initial fraction f_cut of data points from the fit\n        cutoff_index = int(f_cut * num_steps)\n        t_fit = t_array[cutoff_index:]\n        msd_fit = msd[cutoff_index:]\n        \n        # Perform linear regression: MSD(t) = slope * t + intercept\n        slope, intercept, _, _, _ = linregress(t_fit, msd_fit)\n        \n        # Estimate the finite-size diffusion coefficient from the slope (MSD = 6*D*t)\n        D_L_est = slope / 6.0\n\n        # 5. Apply the finite-size correction to estimate the infinite-system D\n        # This inverts the formula used in step 1\n        D_inf_est = D_L_est * np.exp(exponent_arg)\n        \n        results.append(D_inf_est)\n\n    # Final print statement in the exact required format.\n    # The format specifier ensures plain decimal float output, not scientific notation.\n    formatted_results = [f\"{r:.22f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "Another powerful bridge between the atomistic and continuum worlds is provided by the fluctuation-dissipation theorem, which connects microscopic equilibrium fluctuations to macroscopic transport coefficients. The Green-Kubo relations are the mathematical embodiment of this principle. In this exercise , you will apply this framework to calculate the shear viscosity of a dilute gas, a critical input parameter for continuum fluid dynamics simulations based on the Navier-Stokes equations. By modeling the time-correlation of microscopic stress fluctuations, you will gain hands-on experience with one of the most elegant and fundamental techniques in statistical mechanics for multi-scale modeling.",
            "id": "4144007",
            "problem": "You are tasked with implementing a principled multi-scale computation of the shear viscosity of dilute process gases used in Plasma-Enhanced Chemical Vapor Deposition (PECVD) using the atomistic Green–Kubo relation and then reporting the results in a format suitable for coupling to continuum Navier–Stokes simulations. The shear viscosity $ \\eta $ is given by the Green–Kubo formula\n$$\n\\eta \\;=\\; \\frac{V}{k_B T} \\int_0^\\infty \\left\\langle \\sigma_{xy}(0)\\,\\sigma_{xy}(t) \\right\\rangle \\, dt,\n$$\nwhere $ \\left\\langle \\sigma_{xy}(0)\\,\\sigma_{xy}(t) \\right\\rangle $ is the equilibrium autocorrelation function of the off-diagonal microscopic stress tensor component $ \\sigma_{xy} $, $ V $ is the system volume, $ T $ is the absolute temperature, and $ k_B $ is the Boltzmann constant. In the dilute-gas limit appropriate to PECVD process conditions, model the autocorrelation as\n$$\n\\left\\langle \\sigma_{xy}(0)\\,\\sigma_{xy}(t) \\right\\rangle \\;=\\; G_0 \\,\\exp\\!\\left( -\\frac{t}{\\tau} \\right),\n$$\nwith amplitude $ G_0 $ set by ideal-gas stress fluctuations and relaxation time $ \\tau $ set by kinetic-theory transport. For an ideal gas of $ N $ molecules of mass $ m $ in volume $ V $ at temperature $ T $, with Maxwell–Boltzmann statistics and negligible intermolecular potential contributions to off-diagonal stress at $ t = 0 $, use\n$$\nG_0 \\;=\\; \\frac{N\\,(k_B T)^2}{V^2},\n$$\nand determine $ \\tau $ from the mean free path $ \\lambda $ and a representative thermal speed $ \\bar{v} $ via\n$$\n\\tau \\;=\\; \\frac{\\lambda}{\\bar{v}}, \\qquad \\lambda \\;=\\; \\frac{1}{\\sqrt{2}\\,\\pi\\,d^2\\,n}, \\qquad \\bar{v} \\;=\\; \\sqrt{\\frac{8\\,k_B T}{\\pi m}},\n$$\nwhere $ d $ is an effective molecular collision diameter and $ n = N/V $ is the number density. The number density $ n $ is related to pressure $ p $ by the ideal gas law $ p = n k_B T $. The microscopic stress component is $ \\sigma_{xy} = \\frac{1}{V} \\sum_{i=1}^N m\\,v_{ix}\\,v_{iy} $ for particles with velocity components $ v_{ix}, v_{iy} $.\n\nYour program must:\n- Implement a numerical approximation of the time integral using the trapezoidal rule on the interval $ t \\in [0, t_{\\max}] $ with $ t_{\\max} = \\beta\\,\\tau $ for a specified dimensionless factor $ \\beta $ and a uniform time step $ \\Delta t $ chosen as $ \\Delta t = \\tau / 5000 $. This choice ensures scientific realism with negligible truncation error given the exponential decay.\n- Use $ k_B = 1.380649\\times 10^{-23} \\,\\mathrm{J/K} $ and Avogadro’s constant $ N_A = 6.02214076\\times 10^{23}\\,\\mathrm{mol^{-1}} $.\n- Convert molar mass $ M $ (in $\\mathrm{kg/mol}$) to molecular mass $ m $ via $ m = M / N_A $.\n- Compute $ n = p/(k_B T) $, $ N = n V $, $ G_0 = N (k_B T)^2 / V^2 $, $ \\bar{v} = \\sqrt{8 k_B T / (\\pi m)} $, $ \\lambda = 1 / (\\sqrt{2}\\, \\pi d^2 n) $, $ \\tau = \\lambda / \\bar{v} $, then evaluate the trapezoidal approximation to $ \\int_0^{t_{\\max}} G_0 \\exp(-t/\\tau)\\, dt $, and finally compute $ \\eta $ from the Green–Kubo formula.\n- Express the final viscosity in Pascal-second ($\\mathrm{Pa\\cdot s}$), rounded to six significant figures.\n\nTest Suite:\nImplement the computation for the following parameter sets, representative of PECVD process gases and conditions. Each test case is a tuple $ (M, d, T, p, V, \\beta) $:\n1. Silane ($\\mathrm{SiH_4}$): $ M = 3.2117\\times 10^{-2}\\,\\mathrm{kg/mol} $, $ d = 4.35\\times 10^{-10}\\,\\mathrm{m} $, $ T = 6.00\\times 10^{2}\\,\\mathrm{K} $, $ p = 5.00\\times 10^{1}\\,\\mathrm{Pa} $, $ V = 1.00\\times 10^{-21}\\,\\mathrm{m^3} $, $ \\beta = 1.20\\times 10^{1} $.\n2. Hydrogen ($\\mathrm{H_2}$): $ M = 2.016\\times 10^{-3}\\,\\mathrm{kg/mol} $, $ d = 2.89\\times 10^{-10}\\,\\mathrm{m} $, $ T = 4.50\\times 10^{2}\\,\\mathrm{K} $, $ p = 1.00\\times 10^{2}\\,\\mathrm{Pa} $, $ V = 1.00\\times 10^{-21}\\,\\mathrm{m^3} $, $ \\beta = 1.00\\times 10^{1} $.\n3. Ammonia ($\\mathrm{NH_3}$): $ M = 1.7031\\times 10^{-2}\\,\\mathrm{kg/mol} $, $ d = 3.60\\times 10^{-10}\\,\\mathrm{m} $, $ T = 5.00\\times 10^{2}\\,\\mathrm{K} $, $ p = 8.00\\times 10^{1}\\,\\mathrm{Pa} $, $ V = 2.00\\times 10^{-21}\\,\\mathrm{m^3} $, $ \\beta = 1.00\\times 10^{1} $.\n4. Nitrogen ($\\mathrm{N_2}$): $ M = 2.8014\\times 10^{-2}\\,\\mathrm{kg/mol} $, $ d = 3.70\\times 10^{-10}\\,\\mathrm{m} $, $ T = 3.00\\times 10^{2}\\,\\mathrm{K} $, $ p = 1.00\\times 10^{2}\\,\\mathrm{Pa} $, $ V = 5.00\\times 10^{-22}\\,\\mathrm{m^3} $, $ \\beta = 1.50\\times 10^{1} $.\n5. Nitrogen ($\\mathrm{N_2}$, low pressure edge case): $ M = 2.8014\\times 10^{-2}\\,\\mathrm{kg/mol} $, $ d = 3.70\\times 10^{-10}\\,\\mathrm{m} $, $ T = 3.00\\times 10^{2}\\,\\mathrm{K} $, $ p = 1.00\\times 10^{1}\\,\\mathrm{Pa} $, $ V = 5.00\\times 10^{-21}\\,\\mathrm{m^3} $, $ \\beta = 1.50\\times 10^{1} $.\n\nFinal Output Format:\nYour program should produce a single line of output containing the computed viscosities for the five test cases, as a comma-separated list enclosed in square brackets, each value rounded to six significant figures, in units of $\\mathrm{Pa\\cdot s}$ (for example, $ [0.000123456,0.000234567,0.000345678,0.000456789,0.000567890] $).",
            "solution": "The problem statement has been rigorously validated and is determined to be valid. It is scientifically grounded, well-posed, and internally consistent. The problem is based on the Green–Kubo relations, a fundamental pillar of non-equilibrium statistical mechanics, and applies them to a physically realistic scenario of dilute gas viscosity in semiconductor manufacturing. The model, while a simplification of a full many-body system, uses standard and correct formulations from ideal gas theory and kinetic theory for hard-sphere collisions, specifically for the stress autocorrelation amplitude $G_0$ and the relaxation time $\\tau$.\n\nAn analytical check confirms that the final expression for viscosity $\\eta$ is independent of the system volume $V$ and particle number $N$, as is physically required for an intensive property like viscosity in the dilute limit. The inclusion of $V$ in the calculation steps, while rendering the intermediate quantities $N$ and $G_0$ dependent on it, is a consistent feature of the prescribed algorithm, and $V$ correctly cancels from the final result. The problem is therefore not contradictory. The requirement to use a numerical trapezoidal rule for an analytically tractable integral is a pedagogical constraint that will be strictly followed.\n\nThe solution proceeds by implementing the prescribed algorithm. The core principle is to relate a macroscopic transport coefficient, shear viscosity $\\eta$, to the time integral of a microscopic fluctuation, the stress-tensor autocorrelation function $\\langle \\sigma_{xy}(0)\\,\\sigma_{xy}(t) \\rangle$.\n\nThe shear viscosity $\\eta$ is given by the Green–Kubo formula:\n$$\n\\eta = \\frac{V}{k_B T} \\int_0^\\infty \\left\\langle \\sigma_{xy}(0)\\,\\sigma_{xy}(t) \\right\\rangle \\, dt\n$$\nThe problem provides a relaxation-time model for the stress autocorrelation function (SACF) in a dilute gas:\n$$\n\\left\\langle \\sigma_{xy}(0)\\,\\sigma_{xy}(t) \\right\\rangle = G_0 \\exp\\left( -\\frac{t}{\\tau} \\right)\n$$\nThe amplitude $G_0$ is the mean-square fluctuation of the off-diagonal stress at time $t=0$, which for an ideal gas of $N$ particles in a volume $V$ is:\n$$\nG_0 = \\left\\langle \\sigma_{xy}(0)^2 \\right\\rangle = \\frac{N (k_B T)^2}{V^2}\n$$\nThe relaxation time $\\tau$ is modeled using elementary kinetic theory for hard spheres:\n$$\n\\tau = \\frac{\\lambda}{\\bar{v}}\n$$\nwhere $\\lambda$ is the mean free path and $\\bar{v}$ is the mean thermal speed. These are given by standard formulas:\n$$\n\\lambda = \\frac{1}{\\sqrt{2}\\,\\pi\\,d^2\\,n} \\quad \\text{and} \\quad \\bar{v} = \\sqrt{\\frac{8\\,k_B T}{\\pi m}}\n$$\nThe number density $n=N/V$ is determined from the ideal gas law, $p = n k_B T$.\n\nThe computational procedure for each test case $(M, d, T, p, V, \\beta)$ is as follows:\n\n1.  Define the physical constants $k_B = 1.380649\\times 10^{-23} \\,\\mathrm{J/K}$ and $N_A = 6.02214076\\times 10^{23}\\,\\mathrm{mol^{-1}}$.\n\n2.  Convert the molar mass $M$ (in $\\mathrm{kg/mol}$) to the mass of a single molecule $m$ (in $\\mathrm{kg}$): $m = M/N_A$.\n\n3.  Calculate the number density $n$ from the ideal gas law: $n = p/(k_B T)$.\n\n4.  Calculate the mean thermal speed $\\bar{v}$ using the Maxwell-Boltzmann result: $\\bar{v} = \\sqrt{8 k_B T / (\\pi m)}$.\n\n5.  Calculate the mean free path $\\lambda$ for a hard-sphere gas: $\\lambda = 1 / (\\sqrt{2} \\pi d^2 n)$.\n\n6.  Calculate the stress relaxation time $\\tau$: $\\tau = \\lambda / \\bar{v}$.\n\n7.  Following the problem's prescription, calculate the total number of particles $N$ in the conceptual volume $V$ as $N = nV$. Then, compute the SACF amplitude $G_0$:\n    $$\n    G_0 = \\frac{N (k_B T)^2}{V^2} = \\frac{(nV) (k_B T)^2}{V^2} = \\frac{n (k_B T)^2}{V}\n    $$\n\n8.  The integral in the Green-Kubo formula is truncated at $t_{\\max} = \\beta \\tau$. The problem requires a numerical evaluation of this integral using the trapezoidal rule. The time discretisation is $\\Delta t = \\tau / 5000$. The number of steps for the integration is $K = t_{\\max} / \\Delta t = (\\beta\\tau) / (\\tau/5000) = 5000\\beta$.\n\n9.  We generate an array of $K+1$ time points $t_j = j \\Delta t$ for $j=0, 1, \\dots, K$.\n\n10. We evaluate the integrand $C(t_j) = G_0 \\exp(-t_j/\\tau)$ at each time point.\n\n11. We compute the integral $I$ using the trapezoidal rule:\n    $$\n    I = \\int_0^{t_{\\max}} G_0 \\exp(-t/\\tau) dt \\approx \\Delta t \\left( \\frac{C(t_0) + C(t_K)}{2} + \\sum_{j=1}^{K-1} C(t_j) \\right)\n    $$\n\n12. Finally, we compute the viscosity $\\eta$ by substituting the calculated integral $I$ back into the Green-Kubo formula:\n    $$\n    \\eta = \\frac{V}{k_B T} I\n    $$\n\n13. The final value of $\\eta$ is rounded to six significant figures for reporting. Analytically, the final result for $\\eta$ is independent of $p$, $n$, and $V$, which is the correct physical behavior for a dilute gas. This serves as a robust consistency check on the model, and the test cases for Nitrogen (cases $4$ and $5$) are designed to verify this, as they should yield the same viscosity despite differing in pressure and volume.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes shear viscosity of dilute gases using a multi-scale model based on\n    the Green-Kubo relations, as specified in the problem statement.\n    \"\"\"\n\n    # Define physical constants\n    KB = 1.380649e-23  # Boltzmann constant in J/K\n    NA = 6.02214076e23  # Avogadro's constant in mol^-1\n\n    # Test suite: (M, d, T, p, V, beta)\n    # M: molar mass (kg/mol)\n    # d: collision diameter (m)\n    # T: temperature (K)\n    # p: pressure (Pa)\n    # V: volume (m^3)\n    # beta: dimensionless integration limit factor\n    test_cases = [\n        # 1. Silane (SiH4)\n        (3.2117e-2, 4.35e-10, 6.00e2, 5.00e1, 1.00e-21, 1.20e1),\n        # 2. Hydrogen (H2)\n        (2.016e-3, 2.89e-10, 4.50e2, 1.00e2, 1.00e-21, 1.00e1),\n        # 3. Ammonia (NH3)\n        (1.7031e-2, 3.60e-10, 5.00e2, 8.00e1, 2.00e-21, 1.00e1),\n        # 4. Nitrogen (N2)\n        (2.8014e-2, 3.70e-10, 3.00e2, 1.00e2, 5.00e-22, 1.50e1),\n        # 5. Nitrogen (N2, low pressure)\n        (2.8014e-2, 3.70e-10, 3.00e2, 1.00e1, 5.00e-21, 1.50e1),\n    ]\n\n    results = []\n\n    for M, d, T, p, V, beta in test_cases:\n        # Step 1: Calculate molecular and gas properties\n        m = M / NA  # Molecular mass in kg\n        n = p / (KB * T)  # Number density in m^-3\n        v_bar = np.sqrt(8 * KB * T / (np.pi * m))  # Mean thermal speed in m/s\n        lambda_mfp = 1 / (np.sqrt(2) * np.pi * d**2 * n)  # Mean free path in m\n        tau = lambda_mfp / v_bar  # Relaxation time in s\n\n        # Step 2: Calculate autocorrelation amplitude G_0\n        # The problem prescribes calculating N first, then G0.\n        # This is equivalent to G0 = n * (KB * T)**2 / V.\n        N = n * V\n        G0 = N * (KB * T)**2 / V**2\n\n        # Step 3: Numerical integration using the trapezoidal rule\n        t_max = beta * tau\n        # Number of intervals is 5000 * beta\n        num_intervals = int(5000 * beta)\n        # Number of points is num_intervals + 1\n        num_points = num_intervals + 1\n        \n        # Create time points for integration\n        t_points = np.linspace(0, t_max, num_points)\n\n        # Evaluate the integrand at each time point\n        integrand = G0 * np.exp(-t_points / tau)\n\n        # Perform the trapezoidal integration\n        integral_I = np.trapz(integrand, t_points)\n\n        # Step 4: Calculate shear viscosity\n        eta = (V / (KB * T)) * integral_I\n        results.append(eta)\n\n    # Final print statement in the exact required format\n    # The \"{:.6g}\" format specifier rounds to 6 significant figures.\n    print(f\"[{','.join(f'{r:.6g}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}