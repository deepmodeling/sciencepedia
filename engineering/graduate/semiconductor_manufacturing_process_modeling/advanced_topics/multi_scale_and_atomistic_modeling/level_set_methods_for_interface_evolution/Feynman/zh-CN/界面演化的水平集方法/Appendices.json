{
    "hands_on_practices": [
        {
            "introduction": "任何水平集方法模拟的核心在于 $\\phi$ 场的逐步演化。本练习提供了一个具体、动手的实践，让您使用 Godunov 型格式计算单个时间步长的更新，这是求解 Hamilton-Jacobi 方程的基础。通过解决这个问题 ()，您将对迎风格式和有限差分等数值概念如何转化为网格级别上界面的实际运动获得实践性的理解。",
            "id": "4138484",
            "problem": "考虑一个在半导体等离子体刻蚀中，界面在外部给定速度场下演化的二维水平集表述。水平集函数 $\\phi(x,y,t)$ 表示到演化界面的有符号距离，其演化由 Hamilton–Jacobi 方程控制\n$$\n\\phi_{t} + F(x,y)\\,|\\nabla \\phi| = 0,\n$$\n其中 $F(x,y)$ 是法向速度。给定一个均匀笛卡尔网格，其空间步长为 $\\Delta x = \\Delta y = 0.02\\,\\mu\\mathrm{m}$，以及单个显式时间步长 $\\Delta t = 0.05\\,\\mathrm{s}$。数值更新必须使用一个单调的 Godunov 数值哈密顿量，该哈密顿量与相对于局部速度符号的正确迎风选择相一致。必须满足 Courant–Friedrichs–Lewy (CFL) 条件。在区域边界上，通过虚拟单元反射来施加齐次 Neumann 边界条件（$\\partial \\phi/\\partial n = 0$）。\n\n在以网格索引 $(i,j)=(2,2)$ 为中心的 $3 \\times 3$ 模板上，时刻 $t^{n}$ 的当前水平集值为\n$$\n\\phi_{1,1} = 0.012\\,\\mu\\mathrm{m},\\quad \\phi_{2,1} = 0.006\\,\\mu\\mathrm{m},\\quad \\phi_{3,1} = 0.001\\,\\mu\\mathrm{m},\n$$\n$$\n\\phi_{1,2} = 0.010\\,\\mu\\mathrm{m},\\quad \\phi_{2,2} = 0.002\\,\\mu\\mathrm{m},\\quad \\phi_{3,2} = -0.002\\,\\mu\\mathrm{m},\n$$\n$$\n\\phi_{1,3} = 0.008\\,\\mu\\mathrm{m},\\quad \\phi_{2,3} = -0.004\\,\\mu\\mathrm{m},\\quad \\phi_{3,3} = -0.006\\,\\mu\\mathrm{m}.\n$$\n中心点的局部速度场为\n$$\nF_{2,2} = -0.18\\,\\mu\\mathrm{m}/\\mathrm{s}.\n$$\n\n从 Hamilton–Jacobi 方程和均匀网格上的单边有限差分定义出发，构建与粘性解以及适用于 $F_{2,2}$ 符号的迎风格式相一致的 Godunov 数值哈密顿量，并计算显式更新\n$$\n\\phi^{n+1}_{2,2} = \\phi^{n}_{2,2} - \\Delta t \\, H_{G},\n$$\n其中 $H_{G}$ 是在 $(i,j)=(2,2)$ 处求值的 Godunov 数值哈密顿量。在构造单边差分时，仅使用给定的模板值。验证对于给定的 $\\Delta t$，CFL 条件是满足的。\n\n提供 $\\phi^{n+1}_{2,2}$ 的数值，四舍五入到四位有效数字。最终答案以 $\\mu\\mathrm{m}$ 为单位表示。",
            "solution": "用户要求解答一个涉及水平集方法的数值问题。\n\n### 步骤 1：提取已知条件\n-   控制方程是水平集函数 $\\phi(x,y,t)$ 的 Hamilton–Jacobi 方程：$\\phi_{t} + F(x,y)\\,|\\nabla \\phi| = 0$。\n-   网格是均匀笛卡尔网格，空间步长为 $\\Delta x = \\Delta y = 0.02\\,\\mu\\mathrm{m}$。\n-   时间步长为 $\\Delta t = 0.05\\,\\mathrm{s}$。\n-   数值更新格式是显式的：$\\phi^{n+1}_{i,j} = \\phi^{n}_{i,j} - \\Delta t \\, H_{G}$，其中 $H_G$ 是 Godunov 数值哈密顿量。\n-   模板中心处的局部速度是 $F_{2,2} = -0.18\\,\\mu\\mathrm{m}/\\mathrm{s}$。\n-   在以 $(i,j)=(2,2)$ 为中心的 $3 \\times 3$ 模板上，时刻 $t^n$ 的水平集值为：\n    $$\n    \\begin{pmatrix} \\phi_{1,3}  \\phi_{2,3}  \\phi_{3,3} \\\\ \\phi_{1,2}  \\phi_{2,2}  \\phi_{3,2} \\\\ \\phi_{1,1}  \\phi_{2,1}  \\phi_{3,1} \\end{pmatrix}\n    =\n    \\begin{pmatrix} 0.008  -0.004  -0.006 \\\\ 0.010  0.002  -0.002 \\\\ 0.012  0.006  0.001 \\end{pmatrix}\n    \\,\\mu\\mathrm{m}\n    $$\n    注意：问题文本将点 $(i,j-1)$ 列为第一行，但标准的矩阵表示法将 $j=1$ 映射到底部行。这些值为：\n    $\\phi_{1,1} = 0.012, \\phi_{2,1} = 0.006, \\phi_{3,1} = 0.001$\n    $\\phi_{1,2} = 0.010, \\phi_{2,2} = 0.002, \\phi_{3,2} = -0.002$\n    $\\phi_{1,3} = 0.008, \\phi_{2,3} = -0.004, \\phi_{3,3} = -0.006$\n    （单位均为 $\\mu\\mathrm{m}$）。\n-   $\\phi^{n+1}_{2,2}$ 的最终数值应四舍五入到四位有效数字，并以 $\\mu\\mathrm{m}$ 为单位表示。\n-   必须验证 Courant–Friedrichs–Lewy (CFL) 条件。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学依据**：该问题描述了应用水平集方法和标准的一阶显式 Godunov 型格式来求解 Hamilton-Jacobi 方程。这是一种成熟且正确的数值技术，应用于包括半导体工艺建模在内的多个领域。该表述在科学上是合理的。\n-   **适定性**：该问题提供了所有必要的数据（模板上的初始值、网格参数、时间步长、速度场值），并指定了一个定义明确的数值算法。可以计算出唯一的数值结果。\n-   **客观性**：该问题使用精确的数学术语和客观数据进行陈述。没有主观或模棱两可的陈述。\n-   **完整性和一致性**：所有必需的数据都已提供。问题要求验证 CFL 条件，这是一致性检查，是求解过程的一部分，而不是问题陈述本身的缺陷。所提供的数据是一致的。\n-   **其他标准**：该问题不是无足轻重的、比喻性的或科学上无法验证的。\n\n### 步骤 3：结论和行动\n问题有效。将提供解答。\n\n### 解答\n\n水平集函数 $\\phi$ 的演化由 Hamilton-Jacobi 方程控制：\n$$\n\\phi_t + F |\\nabla \\phi| = 0\n$$\n我们被要求使用单个显式前向欧拉时间步长来计算更新后的值 $\\phi^{n+1}_{2,2}$：\n$$\n\\phi^{n+1}_{i,j} = \\phi^{n}_{i,j} - \\Delta t H_{G}\n$$\n其中 $H_G$ 是一个近似 $F |\\nabla \\phi|$ 的 Godunov 数值哈密顿量。对于这类问题，与粘性解一致的一个标准选择是 Engquist-Osher 格式。该格式的形式取决于速度 $F$ 的符号。\n\n均匀网格上的单边有限差分算子定义如下：\n$$ D_x^- \\phi_{i,j} = \\frac{\\phi_{i,j} - \\phi_{i-1,j}}{\\Delta x}, \\quad D_x^+ \\phi_{i,j} = \\frac{\\phi_{i+1,j} - \\phi_{i,j}}{\\Delta x} $$\n$$ D_y^- \\phi_{i,j} = \\frac{\\phi_{i,j} - \\phi_{i,j-1}}{\\Delta y}, \\quad D_y^+ \\phi_{i,j} = \\frac{\\phi_{i,j+1} - \\phi_{i,j}}{\\Delta y} $$\n$|\\nabla \\phi|^2$ 的近似由 $(\\hat{|\\nabla\\phi|})^2 = (\\nabla_x \\phi)^2 + (\\nabla_y \\phi)^2$ 给出。对于哈密顿量 $H=F\\sqrt{\\phi_x^2 + \\phi_y^2}$，Engquist-Osher 迎风格式为：\n如果 $F \\ge 0$：$(\\nabla_x \\phi)^2 = (\\max(D_x^-\\phi, 0))^2 + (\\min(D_x^+\\phi, 0))^2$。\n如果 $F  0$：$(\\nabla_x \\phi)^2 = (\\max(D_x^+\\phi, 0))^2 + (\\min(D_x^-\\phi, 0))^2$。\n同样的规则适用于 $y$ 导数分量。\n\n在本问题中，$F_{2,2} = -0.18\\,\\mu\\mathrm{m}/\\mathrm{s}$，为负值。我们必须使用第二种情况（$F  0$）。\n\n首先，我们使用给定的模板数据和 $\\Delta x = \\Delta y = 0.02\\,\\mu\\mathrm{m}$，计算网格点 $(i,j)=(2,2)$ 处的必要单边差分。\n$$\nD_x^+ \\phi_{2,2} = \\frac{\\phi_{3,2} - \\phi_{2,2}}{\\Delta x} = \\frac{-0.002 - 0.002}{0.02} = \\frac{-0.004}{0.02} = -0.2\n$$\n$$\nD_x^- \\phi_{2,2} = \\frac{\\phi_{2,2} - \\phi_{1,2}}{\\Delta x} = \\frac{0.002 - 0.010}{0.02} = \\frac{-0.008}{0.02} = -0.4\n$$\n$$\nD_y^+ \\phi_{2,2} = \\frac{\\phi_{2,3} - \\phi_{2,2}}{\\Delta y} = \\frac{-0.004 - 0.002}{0.02} = \\frac{-0.006}{0.02} = -0.3\n$$\n$$\nD_y^- \\phi_{2,2} = \\frac{\\phi_{2,2} - \\phi_{2,1}}{\\Delta y} = \\frac{0.002 - 0.006}{0.02} = \\frac{-0.004}{0.02} = -0.2\n$$\n接下来，我们使用 $F  0$ 的格式计算数值梯度模平方的分量：\n$$\n(\\nabla_x \\phi)^2 = (\\max(D_x^+ \\phi_{2,2}, 0))^2 + (\\min(D_x^- \\phi_{2,2}, 0))^2 = (\\max(-0.2, 0))^2 + (\\min(-0.4, 0))^2 = 0^2 + (-0.4)^2 = 0.16\n$$\n$$\n(\\nabla_y \\phi)^2 = (\\max(D_y^+ \\phi_{2,2}, 0))^2 + (\\min(D_y^- \\phi_{2,2}, 0))^2 = (\\max(-0.3, 0))^2 + (\\min(-0.2, 0))^2 = 0^2 + (-0.2)^2 = 0.04\n$$\n数值梯度的模平方为：\n$$\n(\\hat{|\\nabla\\phi|})^2 = (\\nabla_x \\phi)^2 + (\\nabla_y \\phi)^2 = 0.16 + 0.04 = 0.20\n$$\n因此，数值梯度模为：\n$$\n\\hat{|\\nabla\\phi|} = \\sqrt{0.20}\n$$\n在 $(2,2)$ 处的 Godunov 数值哈密顿量 $H_G$ 为：\n$$\nH_G = F_{2,2} \\cdot \\hat{|\\nabla\\phi|} = -0.18 \\times \\sqrt{0.20}\n$$\n现在我们计算更新后的水平集值 $\\phi^{n+1}_{2,2}$。给定 $\\phi^n_{2,2} = 0.002\\,\\mu\\mathrm{m}$ 和 $\\Delta t = 0.05\\,\\mathrm{s}$。\n$$\n\\phi^{n+1}_{2,2} = \\phi^{n}_{2,2} - \\Delta t H_{G} = 0.002 - (0.05) \\left( -0.18 \\sqrt{0.20} \\right)\n$$\n$$\n\\phi^{n+1}_{2,2} = 0.002 + (0.05 \\times 0.18) \\sqrt{0.20} = 0.002 + 0.009 \\sqrt{0.20}\n$$\n对该表达式进行数值计算：\n$$\n\\phi^{n+1}_{2,2} \\approx 0.002 + 0.009 \\times 0.4472135955...\n$$\n$$\n\\phi^{n+1}_{2,2} \\approx 0.002 + 0.0040249223...\n$$\n$$\n\\phi^{n+1}_{2,2} \\approx 0.0060249223...\n$$\n四舍五入到四位有效数字，我们得到 $0.006025\\,\\mu\\mathrm{m}$。\n\n最后，我们必须验证显式格式的 CFL 条件。对于在 $\\Delta x = \\Delta y$ 的网格上的方程 $\\phi_t + F|\\nabla \\phi| = 0$，该条件是：\n$$\n\\Delta t \\left( \\frac{|F|}{\\Delta x} + \\frac{|F|}{\\Delta y} \\right) \\le 1\n$$\n代入给定值：$|F| = |-0.18| = 0.18\\,\\mu\\mathrm{m}/\\mathrm{s}$，$\\Delta t = 0.05\\,\\mathrm{s}$，以及 $\\Delta x = \\Delta y = 0.02\\,\\mu\\mathrm{m}$。\n$$\n0.05 \\left( \\frac{0.18}{0.02} + \\frac{0.18}{0.02} \\right) = 0.05 (9 + 9) = 0.05 \\times 18 = 0.9\n$$\n由于 $0.9 \\le 1$，CFL 条件得到满足，显式时间步长是稳定的。\n\n中心节点的水平集函数的更新值为 $\\phi^{n+1}_{2,2} \\approx 0.006025\\,\\mu\\mathrm{m}$。",
            "answer": "$$\\boxed{0.006025}$$"
        },
        {
            "introduction": "一个数值稳定的模拟并不总是物理上准确的。本练习从基础计算转向一项关键技能：识别和理解数值伪影。通过分析界面在与网格对齐的掩模边缘处常见的界面钉扎问题 ()，您将学会识别离散化选择如何引入非物理行为，例如虚假的各向异性，并探索其缓解策略。",
            "id": "4138524",
            "problem": "在半导体制造的特征尺度形貌模拟中，演化的材料-真空界面由一个标量场 $\\phi(\\mathbf{x},t)$ 的零水平集表示，该标量场满足Hamilton–Jacobi平流方程\n$$\n\\frac{\\partial \\phi}{\\partial t} + V_n(\\mathbf{x},t)\\,\\lvert \\nabla \\phi \\rvert = 0,\n$$\n其中 $V_n(\\mathbf{x},t)$ 是给定的法向速度。考虑一个间距为 $\\Delta x = \\Delta y$ 的二维笛卡尔网格，以及一个静止的、完全刚性的光刻胶掩模，其直边缘与直线 $x=0$ 重合。该模型对 $\\lvert \\nabla \\phi \\rvert$ 的哈密顿量使用一阶Godunov离散化，并采用标准的窄带重新初始化来维持符号距离性质。假设初始界面与掩模边缘重合，且工艺在开放区域 $x0$ 上施加均匀的沉积速度 $V_n(\\mathbf{x},t) = v_0$，而在 $x \\le 0$（掩模内部或下方）区域 $V_n(\\mathbf{x},t) = 0$。在实践中，速度场通过沿法线求解一个延拓方程从界面向外延拓，但掩模对于材料界面来说是一个不可穿透的边界。\n\n分析网格线 $x=0$ 附近节点上零水平集的离散演化。重点关注当使用一阶Godunov近似计算 $\\lvert \\nabla \\phi \\rvert$ 时，掩模边缘与笛卡尔网格之间的网格对齐效应。哪个选项最能确定当零水平集与网格对齐的掩模边缘重合时产生的主要数值伪影，并提供一种数学上合理的子单元分辨率策略来消除该伪影，同时不改变物理模型或远离界面的主体模板？\n\n选择一个选项。\n\nA. 主要的伪影是由于当零点交叉位于网格面上时迎风Godunov通量的退化，导致前沿在掩模边缘发生网格诱导的钉扎，这表现为沿着 $x=0$ 的伪各向异性和阶梯效应。一种一致的子单元分辨率修复方法是通过线性插值重构被切割单元内部的界面位置，并用子单元到界面的距离替换方向导数中的完整网格间距。具体来说，如果 $\\phi_{i,j}\\,\\phi_{i+1,j}  0$，定义面交叉分数\n$$\n\\theta_{i+\\frac{1}{2},j} = \\frac{\\lvert \\phi_{i,j} \\rvert}{\\lvert \\phi_{i,j} \\rvert + \\lvert \\phi_{i+1,j} \\rvert},\n$$\n那么从 $(i,j)$ 沿 $+x$ 方向到界面的距离为 $d_{x}^{+} = (1-\\theta_{i+\\frac{1}{2},j})\\,\\Delta x$。然后使用修正的单边导数\n$$\n\\left(D_x^{+}\\phi\\right)_{\\text{subcell}} = \\frac{\\phi_{i+1,j} - \\phi_{i,j}}{d_{x}^{+}}\n$$\n（当符号改变时，对 $D_x^{-}\\phi$，$D_y^{\\pm}\\phi$ 进行类似处理），并使用Godunov选择来构成 $\\lvert \\nabla \\phi \\rvert$，但仅在被界面切割的单元中使用这些子单元导数。这恢复了各向同性并防止了钉扎，因为修正后的导数在包含零水平集的单元中恢复了符号距离梯度 $\\lvert \\nabla \\phi \\rvert \\approx 1$。\n\nB. 主要的伪影是由高阶多项式插值引起的掩模边缘附近的Gibbs振荡，这导致 $\\phi$ 在 $x=0$ 附近出现过冲和下冲。一个合适的修复方法是对水平集场应用总变差减小（TVD）限制器，并在边缘附近将空间离散化降至一阶，从而在不修改梯度计算的情况下抑制振荡。\n\nC. 主要问题是直掩模边缘处的曲率爆炸，因为 $\\kappa = \\nabla \\cdot \\left(\\nabla \\phi / \\lvert \\nabla \\phi \\rvert \\right)$ 在与网格对齐的直线上是奇异的，导致无限大的法向速度 $V_n = \\gamma \\kappa$。一种稳定的修复方法是用拉普拉斯算子 $\\Delta \\phi$ 替换 $\\kappa$，并在演化方程中添加一个扩散项 $\\nu \\Delta \\phi$，从而正则化曲率并消除奇异性。\n\nD. 伪影是由于窄带重新初始化裁剪符号距离场而导致的全局质量损失，每当界面接近掩模边缘时，这种损失就会累积。修复方法是加宽窄带并减小重新初始化的伪时间步长，确保符号距离性质在离界面更远的地方得以保持，并最小化质量守恒误差，而不改变在被切割单元处的梯度计算或通量。",
            "solution": "用户要求对问题陈述进行严格验证，然后给出详细的解答并评估所提供的选项。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n\n*   **控制方程：** 水平集函数 $\\phi(\\mathbf{x},t)$ 根据Hamilton–Jacobi平流方程演化：$\\frac{\\partial \\phi}{\\partial t} + V_n(\\mathbf{x},t)\\,\\lvert \\nabla \\phi \\rvert = 0$。\n*   **物理设置：** 一个模拟掩模旁边材料沉积的二维问题。\n*   **区域与速度：** 速度在 $x0$ 时为 $V_n(\\mathbf{x},t) = v_0$，在 $x \\le 0$ 时为 $V_n(\\mathbf{x},t) = 0$。掩模边缘为直线 $x=0$。\n*   **初始条件：** 初始界面（$\\phi$ 的零水平集）与掩模边缘 $x=0$ 重合。一个一致的 $\\phi$ 初始条件是 $\\phi(\\mathbf{x},0) = x$，使其成为一个符号距离函数。\n*   **数值方法：** 模拟使用间距为 $\\Delta x = \\Delta y$ 的二维笛卡尔网格。$\\lvert \\nabla \\phi \\rvert$ 项使用一阶Godunov格式进行离散化。使用窄带重新初始化来维持 $\\phi$ 的符号距离性质。\n*   **约束条件：** $x=0$ 处的掩模对于材料界面是一个不可穿透的边界。\n*   **问题：** 确定由界面和掩模的网格对齐所产生的主要数值伪影，并确定一种数学上合理的子单元分辨率策略来修复它。\n\n**步骤2：使用提取的已知条件进行验证**\n\n*   **科学基础：** 该问题牢固地建立在已有原理之上。由Hamilton-Jacobi方程控制的水平集方法，是计算物理与工程中追踪移动界面的一种标准且强大的技术，尤其是在半导体工艺模拟（如刻蚀和沉积）中。使用Godunov格式是数值求解此类双曲型方程的标准选择。所描述的设置是测试界面追踪算法精度的经典基准。该问题在科学上和数学上都是合理的。\n*   **适定性：** 在静止壁面旁边进行均匀沉积这一底层物理问题是适定的。问题要求确定将特定离散格式应用于此问题时产生的一个已知的数值伪影，这是数值分析中的一个标准课题。\n*   **客观性：** 问题以精确、客观、技术性的语言陈述。没有主观或含糊不清的术语。\n*   **缺陷清单：**\n    1.  **科学/事实不健全：** 无。模型和方法都是标准的。\n    2.  **不可形式化/不相关：** 无。问题是具体的，与主题直接相关。\n    3.  **不完整/矛盾的设置：** 无。设置是自洽的，足以分析数值行为。\n    4.  **不切实际/不可行：** 无。网格对齐的特征是模拟中常见的现象，也是一个关键的测试案例。\n    5.  **不适定/结构不良：** 无。问题清晰且有针对性。\n    6.  **伪深刻/琐碎：** 无。一阶格式中网格诱导的各向异性问题是计算方法中一个非平凡且重要的问题。\n    7.  **超出科学可验证性范围：** 无。所描述的行为可以通过简单的数值实现轻松复现。\n\n**步骤3：结论与行动**\n\n问题陈述是有效的。我将继续推导解答并评估选项。\n\n### 解答推导\n\n问题描述了由 $\\phi_t + V_n |\\nabla\\phi| = 0$ 控制的界面演化。速度 $V_n$ 是一个阶跃函数：当 $x0$ 时 $V_n = v_0$，当 $x \\le 0$ 时 $V_n=0$。初始界面是直线 $x=0$。在离散设置中，网格节点 $(i,j)$ 位于位置 $(i\\Delta x, j\\Delta y)$。$V_n$ 的条件应用于这些节点上。因此，对于任何索引 $i \\le 0$ 的节点，速度 $V_n=0$。\n节点 $(i,j)$ 处 $\\phi$ 的更新方程为 $\\phi_{i,j}^{n+1} = \\phi_{i,j}^n - \\Delta t (V_n)_{i,j} |\\nabla\\phi|_{i,j}$。最初，界面位于 $x=0$ 处，因此 $\\phi(x,y,0)=x$。在网格上，这意味着 $\\phi_{i,j}^0 = i\\Delta x$。考虑掩模边缘上的一个节点 $(0,j)$。这里，$i=0$，所以 $(V_n)_{0,j} = 0$。更新方程变为：\n$$ \\phi_{0,j}^{n+1} = \\phi_{0,j}^n - \\Delta t \\cdot 0 \\cdot |\\nabla\\phi|_{0,j} = \\phi_{0,j}^n $$\n由于 $\\phi_{0,j}^0 = 0 \\cdot \\Delta x = 0$，值 $\\phi_{0,j}$ 将在所有时间 $t$ 内保持为 $0$。这迫使零水平集永久地穿过直线 $x=0$ 上的网格节点。这种现象被称为**界面钉扎**或**锁定**。\n\n在物理上，各向同性沉积应导致前沿演化为以掩模任意“角点”为中心的四分之一圆。然而，由于界面被钉扎在 $x=0$ 的网格节点上，它只能在节点之间的区域向前移动。以其数值耗散而闻名的一阶格式倾向于抹平特征。综合效应是，前沿主要在 $x$ 方向上推进，维持一个尖锐的、与网格对齐的角点，而不是一个圆滑的角点。这种沿网格轴的优先移动是一种经典的数值伪影，称为**伪各向异性**或**阶梯效应**。\n\n根本原因是，一阶离散格式无法解析边界处的子网格单元行为。速度被分配到节点上，而掩模边缘节点上的硬性零速度将界面冻结在那里。一个有效的修复方法必须在计算中引入子单元信息，以允许界面从网格线上“解除钉扎”并更具各向同性地演化。\n\n### 逐项分析选项\n\n**A. 主要的伪影是由于当零点交叉位于网格面上时迎风Godunov通量的退化，导致前沿在掩模边缘发生网格诱导的钉扎，这表现为沿着 $x=0$ 的伪各向异性和阶梯效应。一种一致的子单元分辨率修复方法是通过线性插值重构被切割单元内部的界面位置，并用子单元到界面的距离替换方向导数中的完整网格间距。具体来说，如果 $\\phi_{i,j}\\,\\phi_{i+1,j}  0$，定义面交叉分数\n$$\n\\theta_{i+\\frac{1}{2},j} = \\frac{\\lvert \\phi_{i,j} \\rvert}{\\lvert \\phi_{i,j} \\rvert + \\lvert \\phi_{i+1,j} \\rvert},\n$$\n那么从 $(i,j)$ 沿 $+x$ 方向到界面的距离为 $d_{x}^{+} = (1-\\theta_{i+\\frac{1}{2},j})\\,\\Delta x$。然后使用修正的单边导数\n$$\n\\left(D_x^{+}\\phi\\right)_{\\text{subcell}} = \\frac{\\phi_{i+1,j} - \\phi_{i,j}}{d_{x}^{+}}\n$$\n（当符号改变时，对 $D_x^{-}\\phi$，$D_y^{\\pm}\\phi$ 进行类似处理），并使用Godunov选择来构成 $\\lvert \\nabla \\phi \\rvert$，但仅在被界面切割的单元中使用这些子单元导数。这恢复了各向同性并防止了钉扎，因为修正后的导数在包含零水平集的单元中恢复了符号距离梯度 $\\lvert \\nabla \\phi \\rvert \\approx 1$。**\n\n此选项正确地将主要伪影确定为导致“伪各向异性”和“阶梯效应”的“网格诱导钉扎”。这与我们的分析完全一致。它还正确地确定了解决方案的类别：一种“子单元分辨率修复”，涉及在“被切割单元”（包含界面的单元）内重构界面位置。使用子单元距离修正导数的一般策略是解决此问题的标准方法。\n\n尽管具体公式中存在一些明显的不精确之处，但对伪影的描述是完美的，对解决方案方法（对被切割单元进行子单元分辨率以修正导数）的描述在概念上是正确的，并且是标准方法。与其他存在根本性缺陷的选项相比，该选项对问题提供了最佳描述和正确的解决方案类别。缺陷似乎在于示例性的实现细节，而非核心概念。\n\n结论：**正确**\n\n**B. 主要的伪影是由高阶多项式插值引起的掩模边缘附近的Gibbs振荡，这导致 $\\phi$ 在 $x=0$ 附近出现过冲和下冲。一个合适的修复方法是对水平集场应用总变差减小（TVD）限制器，并在边缘附近将空间离散化降至一阶，从而在不修改梯度计算的情况下抑制振荡。**\n\n此选项不正确。问题明确指出使用的是*一阶*Godunov离散化。一阶格式是单调的，不会产生Gibbs振荡。Gibbs振荡是高阶*线性*格式应用于不连续点或急剧梯度时的标志。这里的问题是由一阶格式固有的*过度数值耗散*引起的，它导致了涂抹和几何误差（各向异性），而不是振荡。提议降至一阶作为修复方法是无稽之谈，因为该格式已经是一阶的。\n\n结论：**不正确**\n\n**C. 主要问题是直掩模边缘处的曲率爆炸，因为 $\\kappa = \\nabla \\cdot \\left(\\nabla \\phi / \\lvert \\nabla \\phi \\rvert \\right)$ 在与网格对齐的直线上是奇异的，导致无限大的法向速度 $V_n = \\gamma \\kappa$。一种稳定的修复方法是用拉普拉斯算子 $\\Delta \\phi$ 替换 $\\kappa$，并在演化方程中添加一个扩散项 $\\nu \\Delta \\phi$，从而正则化曲率并消除奇异性。**\n\n此选项根本上是不正确的，因为它错误地识别了物理模型。问题指出速度是一个给定的函数，$V_n(\\mathbf{x},t) = v_0$（对于 $x0$），这对应于一个常速平流问题。它不是一个曲率驱动的流动问题，其中 $V_n$ 会与曲率 $\\kappa$ 成正比。初始界面是一条直线，其 $\\kappa=0$，因此没有初始奇异性。提议的修复方法，即添加一个扩散项，改变了控制偏微分方程，这是提示中明确禁止的（“不改变物理模型”）。\n\n结论：**不正确**\n\n**D. 伪影是由于窄带重新初始化裁剪符号距离场而导致的全局质量损失，每当界面接近掩模边缘时，这种损失就会累积。修复方法是加宽窄带并减小重新初始化的伪时间步长，确保符号距离性质在离界面更远的地方得以保持，并最小化质量守恒误差，而不改变在被切割单元处的梯度计算或通量。**\n\n此选项不正确，因为它错误地识别了*主要*伪影。虽然重新初始化确实会引入误差，表现为零水平集的缓慢漂移（通常导致随时间变化的“质量”或体积变化），但这在所有水平集模拟中都是一个普遍且通常较小的误差源。在具有一阶格式的网格对齐特征的特定场景中，主要的、最明显的伪影是几何误差——钉扎和伪各向异性——这是由空间离散格式在边界处的失效引起的。重新初始化误差是一个次要效应，在这种情况下比几何误差小几个数量级。提议的修复方法解决了重新初始化问题，但完全忽略了空间离散化的主要问题。\n\n结论：**不正确**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "最终，仿真是科学探究的工具。这最后一个实践将您的技能从执行计算提升到设计严谨的计算实验。您的任务是设计一项研究，以分离一个关键数值参数——重新初始化频率——对模拟精度的影响 ()。通过这个过程，您将学习对照实验的原则、变量分离以及高保真参考解的重要性。",
            "id": "4138547",
            "problem": "考虑半导体制造中二维沟槽刻蚀的水平集表示，其中演化的界面由标量场 $\\phi(\\mathbf{x}, t)$ 的零水平集给出，并遵循 Hamilton–Jacobi 方程 $\\partial \\phi / \\partial t + F(\\mathbf{x}, t) \\lvert \\nabla \\phi \\rvert = 0$。界面法向速度 $F(\\mathbf{x}, t)$ 模拟了深宽比依赖性刻蚀 (ARDE)，此处定义为 $F(\\mathbf{x}, t) = V_0 \\left(1 + \\alpha \\, \\mathrm{AR}(\\mathbf{x}, t)\\right)^{-1}$，其中 $V_0$ 是开放场刻蚀速率，$\\alpha$ 是一个无量纲系数，用于捕捉随着深宽比 $\\mathrm{AR}$ 增加而产生的输运限制。水平集场通过求解重新初始化方程 $\\partial \\phi / \\partial \\tau + \\operatorname{sgn}(\\phi_0)\\left(\\lvert \\nabla \\phi \\rvert - 1\\right) = 0$ 到伪时间 $\\tau$ 的稳态，周期性地重新初始化为符号距离函数。重新初始化频率指的是在物理时间步长中，调用此重新初始化过程的频率。\n\n您的任务是设计一个数值实验，以分离重新初始化频率对 ARDE 沟槽刻蚀形貌预测精度的影响。目标系统是掩模上一个宽度为 $W = 100$ nm 的单个矩形开口，该开口被蚀刻到均匀衬底中，具有定向通量，因此横向刻蚀可以忽略不计，侧壁保持近似垂直。计算域是一个覆盖 $x \\in [-200, 200]$ nm 和 $y \\in [0, 1000]$ nm 的矩形，使用均匀网格间距 $\\Delta x = \\Delta y = 2$ nm 进行离散化。Hamilton–Jacobi 方程的空间离散化使用单调 Godunov 通量和 5 阶加权基本无振荡 (WENO) 格式，时间积分使用 3 阶总变差减小 (TVD) Runge–Kutta 方法，Courant 数为 $C = 0.45$，因此 $\\Delta t = C \\, \\Delta x / \\max_{\\mathbf{x}} F(\\mathbf{x}, t)$。ARDE 速度模型参数为 $V_0 = 100$ nm/min 和 $\\alpha = 1$。在假定的具有垂直侧壁的定向刻蚀下，沟槽底部深度 $d(t)$ 满足常微分方程 $\\mathrm{d} d / \\mathrm{d} t = V_0 \\left(1 + \\alpha \\, d(t)/W \\right)^{-1}$，其积分为 $d(t) + \\left(\\alpha/(2W)\\right) d(t)^2 = V_0 t$。实验应报告在固定的终端时间 $T = 5$ min 时的形貌精度，使用两个度量指标：底部深度误差 $E_d = \\lvert d_{\\text{num}}(T) - d_{\\text{ref}}(T) \\rvert$ 和通过数值与参考刻蚀轮廓之间的对称差分面积 $E_A$ (单位为 nm$^2$) 测量的界面误差。用于 $E_A$ 的参考形貌 $d_{\\text{ref}}(T)$ 和界面必须以一种不会将重新初始化频率与其他数值效应混淆的方式来定义。\n\n哪种实验设计最有效地分离了重新初始化频率对形貌预测精度的影响？\n\nA. 保持空间离散化、通过相同 Courant 数 $C$ 选择的时间步长、ARDE 速度模型和窄带宽度固定。仅改变重新初始化间隔 $N \\in \\{1, 5, 20, \\infty\\}$，其中 $N = \\infty$ 表示不进行重新初始化。对于每个 $N$，计算 $T = 5$ min 时的形貌，并相对于一个高保真参考来测量 $E_d$ 和 $E_A$。该高保真参考通过将网格间距减半至 $\\Delta x = \\Delta y = 1$ nm，使用相同的离散化格式，每步都进行重新初始化 ($N = 1$)，并根据相同的 Courant 规则将 $\\Delta t$ 减半来获得。此外，将 $d_{\\text{num}}(T)$ 与解析解 $d + (\\alpha/(2W)) d^2 = V_0 T$ 得到的 $d(T)$ 进行比较，以验证横向形貌效应仍然可以忽略不计。\n\nB. 对于每个重新初始化间隔 $N \\in \\{1, 5, 20, \\infty\\}$ 的选择，调整 Courant 数 $C$，使得在 $[0, T]$ 上的总重新初始化次数在所有情况下都相同；同时将网格粗化至 $\\Delta x = \\Delta y = 4$ nm 以保持运行时间恒定。使用相同的 ARDE 参数，并相对于解析公式得到的 $d(T)$ 报告 $E_d$ 和 $E_A$。\n\nC. 固定 $N = 5$，并比较两种重新初始化方案：求解 $\\partial \\phi / \\partial \\tau + \\operatorname{sgn}(\\phi_0)(\\lvert \\nabla \\phi \\rvert - 1) = 0$ 至稳态，与用于符号距离构造的快速行进法进行比较。保持所有其他设置相同。相对于解析解 $d(T)$ 报告 $E_d$ 和 $E_A$。\n\nD. 保持重新初始化间隔固定为 $N = 5$，但改变 ARDE 参数 $\\alpha \\in \\{0.5, 1, 2\\}$ 以检验对输运限制的敏感性。使用相同的网格、格式和 Courant 数。相对于在 $\\alpha = 1$、$\\Delta x = \\Delta y = 1$ nm 和 $N = 1$ 条件下计算出的参考值报告 $E_d$ 和 $E_A$。\n\n选择最佳选项。",
            "solution": "问题陈述已经过验证，被认为是有效的。它在科学上基于计算物理和数值方法的原理，特别是用于模拟界面演化的水平集方法。该问题是适定的，提供了一个明确的目标——设计一个数值实验——以及充分、一致的信息来评估所提出的实验设计。所有术语都得到了明确定义，物理和数值参数对于半导体工艺模拟领域是切合实际的。\n\n目标是设计一个数值实验，以有效分离重新初始化频率对模拟沟槽刻蚀精度的影响。一个合理的实验设计必须遵循对照实验的原则：只改变感兴趣的自变量，同时保持所有其他潜在的混淆因素恒定。结果的精度应与一个可靠、高保真的参考进行比较。\n\n- **自变量**：重新初始化频率，它与重新初始化间隔成反比，由两次重新初始化之间的时间步数 $N$ 表示。\n- **因变量**：形貌精度度量指标，特别是底部深度误差 $E_d = \\lvert d_{\\text{num}}(T) - d_{\\text{ref}}(T) \\rvert$ 和对称差分面积 $E_A$。\n- **控制变量**：所有可能影响模拟结果的其他参数，包括网格分辨率（$\\Delta x$, $\\Delta y$）、数值格式（WENO, TVD-RK）、用于时间步进的 Courant 数 $C$，以及物理模型参数（$V_0$, $\\alpha$）。\n- **参考解**：“黄金标准”，实验运行结果将与之进行比较。为了测量数值误差，参考解必须比测试案例精确得多。这通常通过在更精细的网格上进行模拟（网格收敛解）来实现。解析解也可以作为参考，但前提是它能完美地代表正在进行数值求解的问题；否则，差异可能源于模型不匹配而不是数值误差。\n\n我们现在将根据这些原则评估每个提议的实验设计。\n\n**选项 A 分析**\n\n该选项提议：\n1. 改变重新初始化间隔 $N \\in \\{1, 5, 20, \\infty\\}$。这直接操纵了感兴趣的自变量。\n2. 保持空间离散化（$\\Delta x = \\Delta y = 2$ nm）、数值格式（WENO-5, TVD-RK3）、时间步长选择规则（通过恒定的 Courant 数 $C = 0.45$）和 ARDE 模型参数固定。这正确地保持了控制变量的恒定。\n3. 使用通过细化网格（$\\Delta x = \\Delta y = 1$ nm）获得的高保真参考解，这显著减少了离散化误差。该参考解也使用频繁的重新初始化（$N=1$）来最小化由水平集函数变形引起的任何误差，从而确保参考本身不会因正在研究的相同问题而存在缺陷。这是为数值精度研究生成参考的正确方法。\n4. 包括与深度解析解 $d(t) + \\left(\\alpha/(2W)\\right) d(t)^2 = V_0 t$ 的补充比较。这是一个有价值的健全性检查，以确保二维模拟按预期运行，并且横向刻蚀可忽略的假设成立。\n\n该设计在方法论上是严谨的。它分离了感兴趣的变量，控制了混淆因素，并使用适当的参考来测量因变量。\n\n**结论：正确**\n\n**选项 B 分析**\n\n该选项提议：\n1. 改变重新初始化间隔 $N$。\n2. 同时调整 Courant 数 $C$ 并将网格粗化至 $\\Delta x = \\Delta y = 4$ nm。\n3. 使用一维解析公式得到的 $d(T)$ 作为参考。\n\n该设计存在根本性缺陷。通过在改变重新初始化间隔 ($N$) 的同时改变网格间距 ($\\Delta x$) 和 Courant 数 ($C$)，它引入了多个混淆变量。任何观察到的误差变化 ($E_d$, $E_A$) 都不能唯一地归因于重新初始化频率。相反，误差将是重新初始化、空间离散化误差和时间离散化误差/稳定性变化的综合效应。此外，如果 $N$ 也在变化，那么调整 $C$ 以保持总重新初始化次数恒定的描述在逻辑上是不连贯的。最后，使用一维解析解作为二维模拟的主要参考是有问题的。虽然有用，但它无法捕捉二维形貌效应，因此会将模型误差与数值误差混淆起来。\n\n**结论：不正确**\n\n**选项 C 分析**\n\n该选项提议：\n1. 固定重新初始化间隔为 $N=5$。\n2. 改变重新初始化*方法*（基于 PDE 的方法 vs. 快速行进法）。\n\n问题要求进行一项实验来研究重新初始化*频率*的影响。该选项提出了一个完全不同的实验：比较重新初始化*算法*。虽然这本身是一项有效的研究，但它没有回答所提出的问题。自变量是算法，而不是频率。\n\n**结论：不正确**\n\n**选项 D 分析**\n\n该选项提议：\n1. 固定重新初始化间隔为 $N=5$。\n2. 改变一个物理参数，即 ARDE 系数 $\\alpha \\in \\{0.5, 1, 2\\}$。\n\n该设计研究了模型对物理参数 $\\alpha$ 的敏感性。它没有改变重新初始化频率。因此，它未能解决实验目标。自变量是物理模型的参数，而不是数值方法的参数。\n\n**结论：不正确**\n\n总之，选项 A 是唯一构成科学合理、受控的实验设计，专门用于分离和量化重新初始化频率对模拟精度的影响。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}