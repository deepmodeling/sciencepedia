{
    "hands_on_practices": [
        {
            "introduction": "在有限元方法（FEM）中，核心步骤是为网格中的每个单元构建一个局部刚度矩阵。这个练习将带你实践这一基本过程，它要求你为扩散问题推导并计算一个刚度矩阵项 。虽然该问题引入了可在任意多边形上定义形函数的广义重心坐标（Wachspress坐标），但通过将其应用于一个简单的正方形单元，你可以看到这些高级概念如何与我们熟悉的双线性基函数联系起来，从而加深对基本原理的理解。",
            "id": "4171217",
            "problem": "考虑半导体晶圆区域二维横截面中的稳态掺杂剂扩散，该过程在一个有界域上由偏微分方程 $-\\nabla \\cdot (\\kappa \\nabla u) = f$ 建模，其中 $\\kappa$ 为常数扩散系数。在有限元法 (FEM, Finite Element Method) 中，对于具有节点形函数 $\\{N_{i}\\}$ 的凸多边形单元 $\\Omega$，其局部刚度矩阵的元素定义为 $K_{ij} = \\int_{\\Omega} \\kappa \\, \\nabla N_{i} \\cdot \\nabla N_{j} \\,\\mathrm{d}\\Omega$。广义重心坐标（例如 Wachspress 坐标）通过为多边形的顶点关联一个非负、具有线性精度的单位分解 $\\{N_{i}\\}$ 来定义任意凸多边形上的形函数，这些形函数由边线函数和归一化权重构造而成。\n\n在凸多边形单元 $\\Omega = [0,1] \\times [0,1]$ 的特定情况下定义 Wachspress 坐标，该单元代表晶圆非结构化离散中的一个凸多面体单元。使用四条边 $x=0$, $x=1$, $y=0$ 和 $y=1$ 的线方程，为四个顶点 $(0,0)$, $(1,0)$, $(1,1)$ 和 $(0,1)$ 构造 Wachspress 权重和归一化的形函数 $N_{i}(x,y)$。从扩散算子的变分形式和刚度矩阵的有限元定义出发，推导出对应于 $(0,0)$ 和 $(1,0)$ 处节点相互作用的刚度矩阵元素 $K_{12}$ 的显式积分。\n\n假设 $\\kappa$ 被无量纲化为 $\\kappa = 1$，并且 $f$ 不影响刚度计算。请给出通过积分 $K_{12} = \\int_{0}^{1}\\int_{0}^{1} \\nabla N_{1}(x,y) \\cdot \\nabla N_{2}(x,y) \\,\\mathrm{d}x\\,\\mathrm{d}y$ 求得的标量 $K_{12}$ 的精确值。将最终答案表示为一个无量纲数。无需四舍五入。",
            "solution": "### 解题推导\n\n我们的任务是计算单位正方形单元 $\\Omega = [0,1] \\times [0,1]$ 的刚度矩阵元素 $K_{12}$。控制方程为 $-\\nabla \\cdot (\\kappa \\nabla u) = f$，刚度元素定义为 $K_{ij} = \\int_{\\Omega} \\kappa \\, \\nabla N_{i} \\cdot \\nabla N_{j} \\,\\mathrm{d}\\Omega$。给定扩散系数 $\\kappa=1$。形函数 $\\{N_i\\}$ 被指定为 Wachspress 坐标。节点是正方形的四个顶点，我们将其标记为 $v_1=(0,0)$, $v_2=(1,0)$, $v_3=(1,1)$ 和 $v_4=(0,1)$。元素 $K_{12}$ 表示与节点 $v_1$ 和 $v_2$ 相关联的形函数之间的相互作用。\n\n首先，我们必须为单位正方形构造 Wachspress 形函数 $N_i(x,y)$。对于一般的凸多边形，Wachspress 坐标是有理函数。然而，对于平行四边形，因此也对于正方形，它们可以简化为众所周知的双线性基函数。这可以通过涉及边线方程乘积的构造过程来证明。\n\n令位置向量为 $\\mathbf{x} = (x,y)$。正方形 $\\Omega = [0,1] \\times [0,1]$ 的四条边定义了四条线：\n$L_1(x,y) = y = 0$ (底边)\n$L_2(x,y) = 1-x = 0$ (右边)\n$L_3(x,y) = 1-y = 0$ (顶边)\n$L_4(x,y) = x = 0$ (左边)\n我们选择的线函数在多边形内部为正。\n\n与顶点 $v_i$ 相关联的未归一化 Wachspress 基函数 $\\beta_i(\\mathbf{x})$ 是由不包含 $v_i$ 的各条边的线函数相乘构造的。\n对于顶点 $v_1 = (0,0)$，不相邻的边是右边和顶边。对应的未归一化函数为：\n$\\beta_1(x,y) = L_2(x,y) L_3(x,y) = (1-x)(1-y)$。\n\n对于顶点 $v_2 = (1,0)$，不相邻的边是左边和顶边：\n$\\beta_2(x,y) = L_4(x,y) L_3(x,y) = x(1-y)$。\n\n对于顶点 $v_3 = (1,1)$，不相邻的边是左边和底边：\n$\\beta_3(x,y) = L_4(x,y) L_1(x,y) = xy$。\n\n对于顶点 $v_4 = (0,1)$，不相邻的边是右边和底边：\n$\\beta_4(x,y) = L_2(x,y) L_1(x,y) = (1-x)y$。\n\n归一化的形函数 $N_i(\\mathbf{x})$ 是通过除以未归一化函数的总和 $W(\\mathbf{x}) = \\sum_{j=1}^{4} \\beta_j(\\mathbf{x})$ 得到的。\n$W(x,y) = (1-x)(1-y) + x(1-y) + xy + (1-x)y$\n$W(x,y) = (1-y)(1-x+x) + y(x+1-x) = (1-y)(1) + y(1) = 1$。\n由于归一化因子为 $1$，归一化的形函数与未归一化的形函数相同：\n$N_1(x,y) = (1-x)(1-y)$\n$N_2(x,y) = x(1-y)$\n$N_3(x,y) = xy$\n$N_4(x,y) = (1-x)y$\n\n这些是矩形单元的标准双线性形函数。我们需要计算刚度元素 $K_{12}$，这需要 $N_1$ 和 $N_2$ 的梯度。\n$N_1(x,y) = 1 - x - y + xy$\n梯度为 $\\nabla N_1(x,y) = \\left( \\frac{\\partial N_1}{\\partial x}, \\frac{\\partial N_1}{\\partial y} \\right) = (-1+y, -1+x)$。\n\n$N_2(x,y) = x - xy$\n梯度为 $\\nabla N_2(x,y) = \\left( \\frac{\\partial N_2}{\\partial x}, \\frac{\\partial N_2}{\\partial y} \\right) = (1-y, -x)$。\n\n现在我们计算梯度的点积：\n$\\nabla N_1 \\cdot \\nabla N_2 = (-1+y)(1-y) + (-1+x)(-x)$\n$= -(1-y)^2 - x(-1+x)$\n$= -(1 - 2y + y^2) + x - x^2$\n$= -1 + 2y - y^2 + x - x^2$。\n\n刚度矩阵元素 $K_{12}$ 是该点积在单位正方形 $\\Omega = [0,1] \\times [0,1]$ 上的积分，其中 $\\kappa=1$：\n$K_{12} = \\int_{\\Omega} (\\nabla N_1 \\cdot \\nabla N_2) \\,\\mathrm{d}\\Omega = \\int_{0}^{1} \\int_{0}^{1} (-1 + 2y - y^2 + x - x^2) \\,\\mathrm{d}x\\,\\mathrm{d}y$。\n\n我们进行积分，首先对 $x$ 积分：\n$\\int_{0}^{1} (-1 + 2y - y^2 + x - x^2) \\,\\mathrm{d}x = \\left[ -x + 2yx - y^2x + \\frac{x^2}{2} - \\frac{x^3}{3} \\right]_0^1$\n$= \\left( -1 + 2y(1) - y^2(1) + \\frac{1^2}{2} - \\frac{1^3}{3} \\right) - (0)$\n$= -1 + 2y - y^2 + \\frac{1}{2} - \\frac{1}{3}$\n$= 2y - y^2 - \\left( 1 - \\frac{1}{2} + \\frac{1}{3} \\right)$\n$= 2y - y^2 - \\left( \\frac{6-3+2}{6} \\right)$\n$= 2y - y^2 - \\frac{5}{6}$。\n\n接下来，我们将此结果对 $y$ 积分：\n$K_{12} = \\int_{0}^{1} \\left( 2y - y^2 - \\frac{5}{6} \\right) \\,\\mathrm{d}y$\n$= \\left[ y^2 - \\frac{y^3}{3} - \\frac{5}{6}y \\right]_0^1$\n$= \\left( 1^2 - \\frac{1^3}{3} - \\frac{5}{6}(1) \\right) - (0)$\n$= 1 - \\frac{1}{3} - \\frac{5}{6}$\n$= \\frac{6}{6} - \\frac{2}{6} - \\frac{5}{6}$\n$= \\frac{6-2-5}{6} = \\frac{-1}{6}$。\n\n因此，刚度矩阵元素 $K_{12}$ 的精确值为 $-\\frac{1}{6}$。",
            "answer": "$$\\boxed{-\\frac{1}{6}}$$"
        },
        {
            "introduction": "有限体积法（FVM）是另一种强大的空间离散化技术，其核心在于近似计算控制体界面上的通量。这个练习  让你深入探究“传输率”这一关键概念，它量化了相邻单元之间的物理交换。通过在一个非Delaunay三角剖分上比较两种不同的对偶网格构建方案（正交的Voronoi对偶与非正交的菱形格式），你将亲身体会到离散化几何选择对数值结果的直接影响。",
            "id": "4171269",
            "problem": "在模拟硅片热退火过程中的掺杂剂扩散时，在一个掩模角附近的非结构化三角网格上，使用了一种顶点中心的有限体积法（FVM）进行离散化。考虑共享顶点 $p$ 和 $q$ 之间边的两个相邻三角形单元，其坐标分别为 $p=(0,0)$ 和 $q=(1,0)$。这两个三角形的第三个顶点分别为 $r_{L}=(0.9,0.3)$ 和 $r_{R}=(0.1,-0.25)$。这种构型是故意设置为非德劳内（non-Delaunay）的。假设扩散系数 $D$ 为恒定的各向同性值，且浓度场 $C(x,y)$ 是局部线性的。\n\n从菲克定律 $\\vec{J}=-D \\nabla C$ 出发，并利用跨界面的两点通量可以写成 $F_{pq}=-T\\,(C_{q}-C_{p})$ 的形式（其中 $T$ 是几何传导率）这一思想，推导并计算在以下两种构建分离 $p$ 和 $q$ 周围控制体的控制体界面的方法中，传导率的数值：\n\n1. 基于正交Voronoi的对偶网格：将控制体面定义为连接两个相邻三角形 $(p,q,r_{L})$ 和 $(p,q,r_{R})$ 外心的直线段。利用该线段与边 $pq$ 正交，以及与 $pq$ 法向对齐的两点通量相关的有效界面长度是此外心到外心线段的长度。使用 $|pq|$ 作为 $p$ 和 $q$ 之间的距离。\n\n2. 采用基于形心的中线对偶网格的菱形格式：将控制体界面定义为连接每个相邻三角形的形心到 $pq$ 中点的两条线段的并集。为获得与 $pq$ 法向对齐的等效两点传导率，将形心到形心的连接向量投影到 $pq$ 的单位法向量上，并取该投影的模长作为有效界面长度。同样，使用 $|pq|$ 作为 $p$ 和 $q$ 之间的距离。\n\n设扩散系数 $D=1$，因此传导率简化为纯粹的几何量。计算相对误差\n$$\nE \\;=\\; \\frac{T_{\\text{diamond}}-T_{\\text{orth}}}{T_{\\text{orth}}}.\n$$\n将最终答案表示为一个精确分数（不进行四舍五入）。答案是无量纲的，不包含任何单位。",
            "solution": "### 解题推导\n\n两个节点 $p$ 和 $q$ 之间传导率的一般形式由 $T = D \\frac{w}{L}$ 给出，其中 $D$ 是扩散系数，$w$ 是节点间控制体界面的有效长度，$L$ 是节点间的距离。\n\n在本题中，给定 $D=1$。节点 $p=(0,0)$ 和 $q=(1,0)$ 之间的距离是 $L = |pq| = \\sqrt{(1-0)^2 + (0-0)^2} = 1$。\n因此，传导率在数值上简化为等于有效界面长度：$T=w$。我们现在将为两种方案分别计算此长度。\n\n**1. 基于正交Voronoi的对偶网格传导率 ($T_{\\text{orth}}$)**\n\n该方案将有效界面长度 $w_{orth}$ 定义为两个相邻三角形 $\\triangle_L = (p,q,r_L)$ 和 $\\triangle_R = (p,q,r_R)$ 外心之间的距离。设外心分别为 $O_L$ 和 $O_R$。\n\n三角形的外心是到其三个顶点等距的点。设一个一般的外心点为 $(x_c, y_c)$。\n对于顶点为 $p(0,0)$、$q(1,0)$ 和 $r_L(0.9, 0.3)$ 的三角形 $\\triangle_L$：\n线段 $pq$ 的垂直平分线是直线 $x=0.5$。外心必须位于这条线上，所以 $x_{c,L} = 0.5$。\n外心到 $p$ 的距离必须等于到 $r_L$ 的距离：\n$$|O_L p|^2 = |O_L r_L|^2$$\n$$(x_{c,L}-0)^2 + (y_{c,L}-0)^2 = (x_{c,L}-0.9)^2 + (y_{c,L}-0.3)^2$$\n代入 $x_{c,L} = 0.5$：\n$$(0.5)^2 + y_{c,L}^2 = (0.5-0.9)^2 + (y_{c,L}-0.3)^2$$\n$$0.25 + y_{c,L}^2 = (-0.4)^2 + y_{c,L}^2 - 0.6 y_{c,L} + (0.3)^2$$\n$$0.25 = 0.16 - 0.6 y_{c,L} + 0.09$$\n$$0.25 = 0.25 - 0.6 y_{c,L}$$\n$$0.6 y_{c,L} = 0 \\implies y_{c,L} = 0$$\n所以，$\\triangle_L$ 的外心是 $O_L = (0.5, 0)$。\n\n对于顶点为 $p(0,0)$、$q(1,0)$ 和 $r_R(0.1, -0.25)$ 的三角形 $\\triangle_R$：\n外心也必须位于 $pq$ 的垂直平分线上，所以 $x_{c,R} = 0.5$。\n外心到 $p$ 的距离必须等于到 $r_R$ 的距离：\n$$|O_R p|^2 = |O_R r_R|^2$$\n$$(x_{c,R}-0)^2 + (y_{c,R}-0)^2 = (x_{c,R}-0.1)^2 + (y_{c,R}-(-0.25))^2$$\n代入 $x_{c,R} = 0.5$：\n$$(0.5)^2 + y_{c,R}^2 = (0.5-0.1)^2 + (y_{c,R}+0.25)^2$$\n$$0.25 + y_{c,R}^2 = (0.4)^2 + y_{c,R}^2 + 0.5 y_{c,R} + (0.25)^2$$\n$$0.25 = 0.16 + 0.5 y_{c,R} + 0.0625$$\n$$0.25 = 0.2225 + 0.5 y_{c,R}$$\n$$0.0275 = 0.5 y_{c,R} \\implies y_{c,R} = 0.055$$\n所以，$\\triangle_R$ 的外心是 $O_R = (0.5, 0.055)$。\n\n有效界面长度 $w_{orth}$ 是 $O_L$ 和 $O_R$ 之间的距离：\n$$w_{orth} = |O_L O_R| = \\sqrt{(0.5-0.5)^2 + (0.055-0)^2} = \\sqrt{0^2 + (0.055)^2} = 0.055$$\n以分数形式表示，$0.055 = \\frac{55}{1000} = \\frac{11}{200}$。\n因此，传导率为 $T_{orth} = w_{orth} = \\frac{11}{200}$。\n\n**2. 菱形格式传导率 ($T_{\\text{diamond}}$)**\n\n该方案将有效界面长度 $w_{diamond}$ 定义为形心到形心向量在边 $pq$ 的单位法向量上投影的模长。\n顶点为 $(x_1, y_1)$、$(x_2, y_2)$ 和 $(x_3, y_3)$ 的三角形的形心是 $(\\frac{x_1+x_2+x_3}{3}, \\frac{y_1+y_2+y_3}{3})$。\n\n对于顶点为 $p(0,0)$、$q(1,0)$ 和 $r_L(0.9, 0.3)$ 的三角形 $\\triangle_L$：\n形心是 $G_L = \\left(\\frac{0+1+0.9}{3}, \\frac{0+0+0.3}{3}\\right) = \\left(\\frac{1.9}{3}, \\frac{0.3}{3}\\right) = \\left(\\frac{19}{30}, \\frac{1}{10}\\right)$。\n\n对于顶点为 $p(0,0)$、$q(1,0)$ 和 $r_R(0.1, -0.25)$ 的三角形 $\\triangle_R$：\n形心是 $G_R = \\left(\\frac{0+1+0.1}{3}, \\frac{0+0-0.25}{3}\\right) = \\left(\\frac{1.1}{3}, \\frac{-0.25}{3}\\right) = \\left(\\frac{11}{30}, -\\frac{1}{12}\\right)$。\n\n形心到形心的向量是 $\\vec{G_L G_R} = G_R - G_L$：\n$$\\vec{G_L G_R} = \\left(\\frac{11}{30} - \\frac{19}{30}, -\\frac{1}{12} - \\frac{1}{10}\\right) = \\left(-\\frac{8}{30}, -\\frac{5}{60} - \\frac{6}{60}\\right) = \\left(-\\frac{4}{15}, -\\frac{11}{60}\\right)$$\n边向量是 $\\vec{pq} = (1,0)$。$\\vec{pq}$ 的一个单位法向量是 $\\vec{n}=(0,1)$。\n有效界面长度 $w_{diamond}$ 是 $\\vec{G_L G_R}$ 和 $\\vec{n}$ 点积的模长：\n$$w_{diamond} = |\\vec{G_L G_R} \\cdot \\vec{n}| = \\left|\\left(-\\frac{4}{15}, -\\frac{11}{60}\\right) \\cdot (0,1)\\right| = \\left|(-\\frac{4}{15})(0) + (-\\frac{11}{60})(1)\\right|$$\n$$w_{diamond} = \\left|-\\frac{11}{60}\\right| = \\frac{11}{60}$$\n因此，传导率是 $T_{diamond} = w_{diamond} = \\frac{11}{60}$。\n\n**3. 相对误差计算**\n\n相对误差 $E$ 定义为：\n$$E = \\frac{T_{\\text{diamond}}-T_{\\text{orth}}}{T_{\\text{orth}}}$$\n代入计算出的值：\n$$E = \\frac{\\frac{11}{60}-\\frac{11}{200}}{\\frac{11}{200}}$$\n我们可以通过将分子和分母同时除以 $11$ 来简化：\n$$E = \\frac{\\frac{1}{60}-\\frac{1}{200}}{\\frac{1}{200}}$$\n这等价于：\n$$E = \\frac{T_{diamond}}{T_{orth}} - 1 = \\frac{11/60}{11/200} - 1 = \\frac{200}{60} - 1 = \\frac{20}{6} - 1 = \\frac{10}{3} - 1$$\n$$E = \\frac{10}{3} - \\frac{3}{3} = \\frac{7}{3}$$\n两种传导率计算之间的相对误差是 $\\frac{7}{3}$。",
            "answer": "$$\\boxed{\\frac{7}{3}}$$"
        }
    ]
}