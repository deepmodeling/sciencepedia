{
    "hands_on_practices": [
        {
            "introduction": "The foundation of the Finite Element Method (FEM) lies in the assembly of a global system from local contributions, known as element stiffness matrices. This exercise  provides hands-on practice in this crucial step by exploring the calculation of a stiffness matrix entry for a polygonal element. By applying the general theory of Wachspress coordinates to the simple case of a square, you will see how these advanced concepts connect to the more familiar bilinear basis functions and gain fundamental skills in deriving the discrete form of a PDE operator.",
            "id": "4171217",
            "problem": "Consider steady dopant diffusion in a two-dimensional cross-section of a semiconductor wafer region, modeled by the partial differential equation $-\\nabla \\cdot (\\kappa \\nabla u) = f$ on a bounded domain, where $\\kappa$ is the constant diffusivity. In the Finite Element Method (FEM), the local stiffness matrix over a convex polygonal cell $\\Omega$ with nodal shape functions $\\{N_{i}\\}$ is defined by entries $K_{ij} = \\int_{\\Omega} \\kappa \\, \\nabla N_{i} \\cdot \\nabla N_{j} \\,\\mathrm{d}\\Omega$. Generalized barycentric coordinates, such as Wachspress coordinates, define shape functions on arbitrary convex polygons by assigning a nonnegative, linear precision partition of unity $\\{N_{i}\\}$ associated with the polygon’s vertices, constructed from edge line functions and normalized weights.\n\nDefine Wachspress coordinates in the specific case of the convex polygonal cell $\\Omega = [0,1] \\times [0,1]$, representing a single convex polyhedral element in an unstructured discretization of the wafer. Use the line equations of the four edges $x=0$, $x=1$, $y=0$, and $y=1$ to construct the Wachspress weights and the normalized shape functions $N_{i}(x,y)$ for the four vertices $(0,0)$, $(1,0)$, $(1,1)$, and $(0,1)$. Starting from the variational form of the diffusion operator and the FEM definition of the stiffness matrix, derive the explicit integrals for the stiffness entry $K_{12}$ corresponding to the interaction of the nodes at $(0,0)$ and $(1,0)$.\n\nAssume $\\kappa$ is nondimensionalized to $\\kappa = 1$ and that $f$ does not affect the stiffness computation. Provide the exact value of the scalar $K_{12}$ obtained from the integral $K_{12} = \\int_{0}^{1}\\int_{0}^{1} \\nabla N_{1}(x,y) \\cdot \\nabla N_{2}(x,y) \\,\\mathrm{d}x\\,\\mathrm{d}y$. Express your final answer as a dimensionless number. No rounding is required.",
            "solution": "The problem asks for the stiffness matrix entry $K_{12}$ for a unit square element $\\Omega = [0,1] \\times [0,1]$ using Wachspress coordinates as shape functions, with diffusivity $\\kappa=1$. The stiffness entry is defined as $K_{ij} = \\int_{\\Omega} \\kappa \\, \\nabla N_{i} \\cdot \\nabla N_{j} \\,\\mathrm{d}\\Omega$. The nodes are the vertices $v_1=(0,0)$, $v_2=(1,0)$, $v_3=(1,1)$, and $v_4=(0,1)$.\n\nFirst, we construct the Wachspress shape functions $N_i(x,y)$. For a parallelogram like a square, Wachspress coordinates simplify to the standard bilinear basis functions. We can show this explicitly. The unnormalized basis function $\\beta_i$ for a vertex $v_i$ is the product of the line equations of the edges that do not contain $v_i$. Let's define the line functions to be positive inside the square: $L_1=y$, $L_2=1-x$, $L_3=1-y$, $L_4=x$.\n\n- For $v_1=(0,0)$, the non-adjacent edges are defined by $L_2$ and $L_3$. So, $\\beta_1(x,y) = L_2 L_3 = (1-x)(1-y)$.\n- For $v_2=(1,0)$, the non-adjacent edges are defined by $L_4$ and $L_3$. So, $\\beta_2(x,y) = L_4 L_3 = x(1-y)$.\n- For $v_3=(1,1)$, the non-adjacent edges are defined by $L_4$ and $L_1$. So, $\\beta_3(x,y) = L_4 L_1 = xy$.\n- For $v_4=(0,1)$, the non-adjacent edges are defined by $L_2$ and $L_1$. So, $\\beta_4(x,y) = L_2 L_1 = (1-x)y$.\n\nThe sum of these unnormalized functions is $W(x,y) = \\sum \\beta_j(x,y) = (1-x)(1-y) + x(1-y) + xy + (1-x)y = 1$. The normalized shape functions are $N_i = \\beta_i / W$, so they are identical to the unnormalized ones:\n$N_1(x,y) = (1-x)(1-y)$\n$N_2(x,y) = x(1-y)$\n$N_3(x,y) = xy$\n$N_4(x,y) = (1-x)y$\n\nNext, we compute the gradients of $N_1$ and $N_2$ to find $K_{12}$:\nThe gradient of $N_1(x,y) = 1 - x - y + xy$ is:\n$\\nabla N_1(x,y) = \\left( \\frac{\\partial N_1}{\\partial x}, \\frac{\\partial N_1}{\\partial y} \\right) = (-1+y, -1+x)$.\n\nThe gradient of $N_2(x,y) = x - xy$ is:\n$\\nabla N_2(x,y) = \\left( \\frac{\\partial N_2}{\\partial x}, \\frac{\\partial N_2}{\\partial y} \\right) = (1-y, -x)$.\n\nNow, we compute the dot product of the gradients:\n$\\nabla N_1 \\cdot \\nabla N_2 = (-1+y)(1-y) + (-1+x)(-x)$\n$= -(1-y)^2 - x(-1+x)$\n$= -(1 - 2y + y^2) + x - x^2$\n$= -1 + 2y - y^2 + x - x^2$.\n\nThe stiffness matrix entry $K_{12}$ is the integral of this dot product over the unit square, with $\\kappa=1$:\n$K_{12} = \\int_{0}^{1} \\int_{0}^{1} (-1 + 2y - y^2 + x - x^2) \\,\\mathrm{d}x\\,\\mathrm{d}y$.\n\nWe integrate with respect to $x$ first:\n$\\int_{0}^{1} (-1 + 2y - y^2 + x - x^2) \\,\\mathrm{d}x = \\left[ -x + 2yx - y^2x + \\frac{x^2}{2} - \\frac{x^3}{3} \\right]_0^1$\n$= (-1 + 2y - y^2 + \\frac{1}{2} - \\frac{1}{3}) - 0$\n$= 2y - y^2 - \\frac{5}{6}$.\n\nFinally, we integrate this result with respect to $y$:\n$K_{12} = \\int_{0}^{1} \\left( 2y - y^2 - \\frac{5}{6} \\right) \\,\\mathrm{d}y$\n$= \\left[ y^2 - \\frac{y^3}{3} - \\frac{5}{6}y \\right]_0^1$\n$= 1^2 - \\frac{1^3}{3} - \\frac{5}{6}(1)$\n$= 1 - \\frac{1}{3} - \\frac{5}{6}$\n$= \\frac{6 - 2 - 5}{6} = -\\frac{1}{6}$.\n\nThus, the value of the stiffness matrix entry $K_{12}$ is $-1/6$.",
            "answer": "$$\\boxed{-\\frac{1}{6}}$$"
        },
        {
            "introduction": "In contrast to FEM's element-based view, the Finite Volume Method (FVM) is built around the principle of conserving quantities by balancing fluxes across control volume boundaries. This exercise  focuses on the critical FVM concept of transmissibility, which quantifies the conductive link between adjacent control volumes. You will investigate how the geometric construction of the dual mesh—the network of control volume faces—directly impacts the numerical scheme's properties, particularly on challenging non-Delaunay triangulations where different methods can yield significantly different results.",
            "id": "4171269",
            "problem": "In modeling dopant diffusion during thermal annealing of a silicon wafer, a vertex-centered Finite Volume Method (FVM) discretization is used on an unstructured triangular mesh near a mask corner. Consider two adjacent triangular elements sharing the edge between vertices $p$ and $q$, with coordinates $p=(0,0)$ and $q=(1,0)$. The third vertices of the two triangles are $r_{L}=(0.9,0.3)$ and $r_{R}=(0.1,-0.25)$, respectively. This configuration is intentionally non-Delaunay. Assume constant, isotropic diffusivity $D$ and a locally linear concentration field $C(x,y)$.\n\nStarting from Fick’s law $J=-D \\nabla C$, and using the idea that a two-point flux across an interface can be written in the form $F_{pq}=-T\\,(C_{q}-C_{p})$ where $T$ is a geometric transmissibility, derive and compute the numerical values of the transmissibility in the following two constructions of the control-volume interface separating the control volumes around $p$ and $q$:\n\n1. Orthogonal Voronoi-based dual: Define the control-volume face as the straight segment connecting the circumcenters of the two adjacent triangles $(p,q,r_{L})$ and $(p,q,r_{R})$. Use the fact that this segment is orthogonal to the edge $pq$ and that the effective interfacial length relevant to a two-point flux aligned with the normal to $pq$ is the length of this circumcenter-to-circumcenter segment. Use $|pq|$ as the distance between $p$ and $q$.\n\n2. Diamond scheme with centroid-based median dual: Define the control-volume interface as the union of the two segments that connect the centroid of each adjacent triangle to the midpoint of $pq$. To obtain an equivalent two-point transmissibility aligned with the normal to $pq$, project the centroid-to-centroid connector onto the unit normal of $pq$ and take the magnitude of this projection as the effective interfacial length. Again, use $|pq|$ as the distance between $p$ and $q$.\n\nLet the diffusivity be $D=1$ so that the transmissibilities reduce to purely geometric quantities. Compute the relative error\n$$\nE \\;=\\; \\frac{T_{\\text{diamond}}-T_{\\text{orth}}}{T_{\\text{orth}}}.\n$$\nExpress the final answer as an exact fraction (no rounding). The answer is dimensionless; do not include any units.",
            "solution": "The transmissibility between two nodes $p$ and $q$ has the general form $T = D \\frac{w}{L}$, where $D$ is the diffusivity, $w$ is the effective length of the control volume interface, and $L$ is the distance between the nodes.\nGiven $D=1$ and nodes $p=(0,0)$ and $q=(1,0)$, the distance $L = |pq| = 1$. The transmissibility is thus numerically equal to the effective interfacial length, $T=w$.\n\n**1. Orthogonal Voronoi-based Transmissibility ($T_{\\text{orth}}$)**\nThis scheme uses the distance between the circumcenters of the two adjacent triangles as the effective length $w_{orth}$.\nLet the triangles be $\\triangle_L = (p,q,r_L)$ with $r_L=(0.9, 0.3)$ and $\\triangle_R = (p,q,r_R)$ with $r_R=(0.1, -0.25)$. Let their circumcenters be $O_L$ and $O_R$.\n\nFor any triangle with vertices on the x-axis at $(0,0)$ and $(1,0)$, the circumcenter must lie on the perpendicular bisector of the segment $pq$, which is the line $x=0.5$.\nFor $\\triangle_L$, let the circumcenter be $O_L=(0.5, y_{c,L})$. The distance to vertex $p$ must equal the distance to vertex $r_L$:\n$|O_L p|^2 = |O_L r_L|^2 \\implies (0.5)^2 + y_{c,L}^2 = (0.5-0.9)^2 + (y_{c,L}-0.3)^2$\n$0.25 + y_{c,L}^2 = (-0.4)^2 + y_{c,L}^2 - 0.6 y_{c,L} + 0.09$\n$0.25 = 0.16 - 0.6 y_{c,L} + 0.09 \\implies 0.6 y_{c,L} = 0 \\implies y_{c,L} = 0$.\nSo, $O_L = (0.5, 0)$.\n\nFor $\\triangle_R$, let the circumcenter be $O_R=(0.5, y_{c,R})$. The distance to vertex $p$ must equal the distance to vertex $r_R$:\n$|O_R p|^2 = |O_R r_R|^2 \\implies (0.5)^2 + y_{c,R}^2 = (0.5-0.1)^2 + (y_{c,R}-(-0.25))^2$\n$0.25 + y_{c,R}^2 = (0.4)^2 + y_{c,R}^2 + 0.5 y_{c,R} + (0.25)^2$\n$0.25 = 0.16 + 0.5 y_{c,R} + 0.0625 \\implies 0.0275 = 0.5 y_{c,R} \\implies y_{c,R} = 0.055$.\nSo, $O_R = (0.5, 0.055)$.\n\nThe effective length $w_{orth}$ is the distance between $O_L$ and $O_R$:\n$w_{orth} = |O_L O_R| = \\sqrt{(0.5-0.5)^2 + (0.055-0)^2} = 0.055 = \\frac{55}{1000} = \\frac{11}{200}$.\nThus, $T_{orth} = \\frac{11}{200}$.\n\n**2. Diamond Scheme Transmissibility ($T_{\\text{diamond}}$)**\nThis scheme uses the magnitude of the projection of the centroid-to-centroid vector onto the normal of edge $pq$ as the effective length $w_{diamond}$.\nThe centroid of a triangle is the average of its vertices' coordinates.\nCentroid of $\\triangle_L$: $G_L = \\left(\\frac{0+1+0.9}{3}, \\frac{0+0+0.3}{3}\\right) = \\left(\\frac{1.9}{3}, \\frac{0.3}{3}\\right) = \\left(\\frac{19}{30}, \\frac{1}{10}\\right)$.\nCentroid of $\\triangle_R$: $G_R = \\left(\\frac{0+1+0.1}{3}, \\frac{0+0-0.25}{3}\\right) = \\left(\\frac{1.1}{3}, \\frac{-0.25}{3}\\right) = \\left(\\frac{11}{30}, -\\frac{1}{12}\\right)$.\n\nThe centroid-to-centroid vector is $\\vec{v} = G_R - G_L$:\n$\\vec{v} = \\left(\\frac{11}{30} - \\frac{19}{30}, -\\frac{1}{12} - \\frac{1}{10}\\right) = \\left(-\\frac{8}{30}, -\\frac{5+6}{60}\\right) = \\left(-\\frac{4}{15}, -\\frac{11}{60}\\right)$.\nThe edge vector is $\\vec{pq} = (1,0)$, and a unit normal vector is $\\vec{n}=(0,1)$.\nThe effective length $w_{diamond}$ is the magnitude of the dot product:\n$w_{diamond} = |\\vec{v} \\cdot \\vec{n}| = \\left|\\left(-\\frac{4}{15}, -\\frac{11}{60}\\right) \\cdot (0,1)\\right| = \\left|-\\frac{11}{60}\\right| = \\frac{11}{60}$.\nThus, $T_{diamond} = \\frac{11}{60}$.\n\n**3. Relative Error Calculation**\nThe relative error is $E = \\frac{T_{\\text{diamond}}-T_{\\text{orth}}}{T_{\\text{orth}}}$.\n$E = \\frac{11/60 - 11/200}{11/200} = \\frac{1/60 - 1/200}{1/200} = \\frac{1/60}{1/200} - 1 = \\frac{200}{60} - 1$.\n$E = \\frac{20}{6} - 1 = \\frac{10}{3} - 1 = \\frac{10}{3} - \\frac{3}{3} = \\frac{7}{3}$.",
            "answer": "$$\\boxed{\\frac{7}{3}}$$"
        },
        {
            "introduction": "A robust numerical scheme must not only approximate the governing equations but also respect fundamental physical principles. This practice  delves into the Discrete Maximum Principle (DMP), a property ensuring that solutions do not exhibit non-physical oscillations, such as a dopant concentration dropping below zero. You will analyze how poor-quality elements in an unstructured mesh can violate the conditions for the DMP and evaluate a common \"matrix repair\" technique, exposing the essential trade-off between enforcing numerical stability and maintaining formal mathematical consistency.",
            "id": "4171247",
            "problem": "A dopant diffusion step in semiconductor manufacturing is modeled by the steady conservation law derived from Fick’s laws: $-\\nabla \\cdot (D(\\mathbf{x}) \\nabla c(\\mathbf{x})) = q(\\mathbf{x})$ in a bounded Lipschitz domain $\\Omega \\subset \\mathbb{R}^{3}$ with appropriate boundary conditions, where $D(\\mathbf{x}) > 0$ is the diffusivity and $c(\\mathbf{x})$ is the dopant concentration. Consider a standard linear nodal discretization (such as linear finite elements or a vertex-centered finite volume method) on an unstructured tetrahedral mesh with a small number of sliver tetrahedra. The discrete system can be written as $A \\mathbf{c} = \\mathbf{b}$, where $A = (a_{ij})$ is the stiffness (or discrete operator) matrix, $\\mathbf{c}$ collects nodal concentrations, and $\\mathbf{b}$ collects source and boundary contributions.\n\nIn the presence of sliver tetrahedra, some off-diagonal entries $a_{ij}$ for $i \\neq j$ may become positive due to obtuse dihedral angles, violating the Discrete Maximum Principle (DMP), which requires an M-matrix structure. For this context, an M-matrix is a real matrix with $a_{ii} > 0$, $a_{ij} \\le 0$ for $i \\neq j$, and row sums that are nonnegative (with zero row sum for pure diffusion operators without reaction), ensuring that the discrete operator is monotone and the DMP holds.\n\nTo restore the DMP near sliver-affected nodes, consider the following local stencil modification applied only at nodes incident to sliver tetrahedra:\n- For each such node $i$ and each neighbor $j \\neq i$, set $\\tilde{a}_{ij} := \\min\\{a_{ij}, 0\\}$.\n- Adjust the diagonal to preserve the original row sum: $\\tilde{a}_{ii} := a_{ii} + \\sum_{j \\neq i} \\left(a_{ij} - \\tilde{a}_{ij}\\right)$.\n- Leave all unaffected rows unchanged, and keep the right-hand side $\\mathbf{b}$ unchanged.\n\nAssume $D(\\mathbf{x})$ is bounded and uniformly positive, $q(\\mathbf{x})$ is bounded, the mesh is shape-regular except for a small number of slivers, and the original discretization is consistent of order at least $2$ away from slivers. Analyze the effect of the above modification on monotonicity, local conservation, and consistency. Which of the following statements are true?\n\nA. The modified matrix $\\tilde{A}$ is an M-matrix locally at the repaired rows, and therefore the DMP is restored for the steady diffusion operator in those rows, provided boundary conditions and sources satisfy standard monotonicity assumptions (e.g., nonnegative source and Dirichlet data).\n\nB. The diagonal compensation $\\tilde{a}_{ii} := a_{ii} + \\sum_{j \\neq i} (a_{ij} - \\tilde{a}_{ij})$ preserves the diffusion operator’s local conservation property (zero row sum for the operator part), so constants remain in the kernel of the homogeneous operator.\n\nC. The clipping-and-compensation modification preserves second-order consistency at the repaired rows; hence the global scheme remains second order everywhere.\n\nD. If the set of repaired rows is localized and its measure shrinks as the mesh is refined (e.g., the repaired region has measure $\\mathcal{O}(h)$ as $h \\to 0$), then the added diffusion terms produce a local truncation error of $\\mathcal{O}(h)$ at repaired rows, and the global consistency order remains at least first order.\n\nE. The proposed modification is equivalent to adding an anti-diffusive flux along edges with $a_{ij} > 0$, which sharpens gradients and may generate new overshoots, thereby weakening the DMP.",
            "solution": "Let's analyze the properties of the proposed matrix modification and evaluate each statement. The modification for a repaired row $i$ is:\n- Off-diagonals: $\\tilde{a}_{ij} = \\min\\{a_{ij}, 0\\}$ for $j \\neq i$.\n- Diagonal: $\\tilde{a}_{ii} = a_{ii} + \\sum_{j \\neq i} (a_{ij} - \\tilde{a}_{ij})$.\n\nFirst, let's examine the effect on the row sum. The new row sum for row $i$ is:\n$\\sum_j \\tilde{a}_{ij} = \\tilde{a}_{ii} + \\sum_{j \\neq i} \\tilde{a}_{ij} = \\left( a_{ii} + \\sum_{j \\neq i} (a_{ij} - \\tilde{a}_{ij}) \\right) + \\sum_{j \\neq i} \\tilde{a}_{ij} = a_{ii} + \\sum_{j \\neq i} a_{ij} = \\sum_j a_{ij}$.\nThe row sum is preserved by the modification.\n\nNow we can evaluate the statements:\n\n**A.** The modified matrix $\\tilde{A}$ satisfies the M-matrix conditions at repaired rows:\n1.  **Off-diagonals:** By definition, $\\tilde{a}_{ij} = \\min\\{a_{ij}, 0\\} \\le 0$ for $i \\neq j$. This condition is met.\n2.  **Diagonals:** The original diagonal entry $a_{ii}$ is positive. The term $(a_{ij} - \\tilde{a}_{ij})$ is equal to $a_{ij}$ if $a_{ij} > 0$ and is zero otherwise. Thus, the sum added to the diagonal is non-negative, making $\\tilde{a}_{ii} > a_{ii} > 0$. This condition is met.\n3.  **Row Sums:** The row sum is preserved from the original matrix, which is assumed to be non-negative. This condition is met.\nSince the repaired rows of $\\tilde{A}$ satisfy the M-matrix properties, the Discrete Maximum Principle (DMP) is restored for those rows. Thus, statement **A is true**.\n\n**B.** The local conservation property for a pure diffusion operator corresponds to the matrix having zero row sums for interior nodes. As shown above, the modification explicitly preserves the row sum of the original matrix $A$. If $\\sum_j a_{ij} = 0$, then $\\sum_j \\tilde{a}_{ij} = 0$. This ensures that a constant vector remains in the kernel of the homogeneous operator, which is the discrete expression of local conservation. Thus, statement **B is true**.\n\n**C.** The modification introduces a change to the discrete operator at row $i$ equivalent to $\\sum_{j \\neq i} (a_{ij} - \\tilde{a}_{ij})(c_i - c_j)$. This is an artificial diffusion term that is only active where the original scheme had positive off-diagonals. This term is not part of the Taylor series expansion of the original PDE. Adding a non-zero term to the operator that does not vanish sufficiently fast with mesh refinement degrades the order of consistency. The scheme no longer approximates the original PDE to second order at the repaired nodes. Thus, statement **C is false**.\n\n**D.** The artificial diffusion term added by the modification changes the equation being solved at the repaired nodes. This change is of a lower order than the truncation error of the original second-order scheme. It is a known result for such repair schemes that they reduce the local consistency to first order, meaning the local truncation error becomes $\\mathcal{O}(h)$. If this lower-order consistency occurs only in a localized region that shrinks with mesh refinement, the global error of the scheme is typically limited by this lowest order. Therefore, the global consistency order becomes first order. The statement that it \"remains at least first order\" is a correct conclusion. Thus, statement **D is true**.\n\n**E.** The added term is of the form $\\sum k_{ij}(c_i - c_j)$ where the coefficients $k_{ij} = (a_{ij} - \\tilde{a}_{ij})$ are non-negative. This represents a diffusive flux, which acts to smooth the solution and suppress oscillations. An anti-diffusive flux would have the opposite sign and would sharpen gradients, potentially creating new oscillations. The purpose and effect of the modification is to add numerical dissipation to restore the DMP, not weaken it. Thus, statement **E is false**.\n\nBased on the analysis, statements A, B, and D are correct.",
            "answer": "$$\\boxed{ABD}$$"
        }
    ]
}