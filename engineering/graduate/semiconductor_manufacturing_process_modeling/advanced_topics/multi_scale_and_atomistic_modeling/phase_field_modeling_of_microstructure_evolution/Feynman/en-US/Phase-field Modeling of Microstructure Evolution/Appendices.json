{
    "hands_on_practices": [
        {
            "introduction": "The foundation of phase-field modeling lies in understanding the structure and energy of the interface between phases. The profile of a stationary interface represents a delicate balance between the bulk free energy, which drives the system toward pure, uniform phases, and the gradient energy, which penalizes sharp spatial variations. This exercise will guide you through the application of the calculus of variations to the Ginzburg-Landau free energy functional, allowing you to derive fundamental physical properties of the interface, such as its characteristic width and energy (or tension), from first principles .",
            "id": "2508064",
            "problem": "Consider a phase-field model for a non-conserved order parameter $\\eta(x,t)$ in one spatial dimension with Ginzburg–Landau free energy functional\n$$\nF[\\eta] \\,=\\, \\int_{-\\infty}^{+\\infty} \\left[ \\frac{\\kappa}{2} \\left(\\frac{d\\eta}{dx}\\right)^{2} \\,+\\, f_{0}(\\eta) \\right] \\, dx,\n$$\nwhere $\\kappa \\,\\, 0$ is a gradient-energy coefficient and $f_{0}(\\eta) \\,=\\, \\frac{A}{4} \\left(\\eta^{2} - 1\\right)^{2}$ is a symmetric double-well bulk free-energy density with $A \\,\\, 0$. The dynamics follow the Allen–Cahn (AC) equation $\\partial \\eta/\\partial t \\,=\\, -L \\, \\delta F/\\delta \\eta$ with positive mobility $L$, but we restrict attention to stationary profiles $\\eta(x)$ that minimize $F$ subject to the boundary conditions $\\eta(x) \\to -1$ as $x \\to -\\infty$ and $\\eta(x) \\to +1$ as $x \\to +\\infty$.\n\nUsing only variational calculus applied to $F[\\eta]$, and imposing the given boundary conditions, carry out the following:\n- Derive the governing ordinary differential equation for a stationary interface profile $\\eta(x)$ and integrate it once to obtain a first integral involving $\\eta'(x)$ and $f_{0}(\\eta)$.\n- From this first integral, determine the monotone stationary profile that connects the two wells and identify the characteristic interfacial width $\\lambda$ in terms of $\\kappa$ and $A$.\n- Using the stationary profile and the first integral, compute the interfacial free energy per unit area (line tension in one dimension),\n$$\n\\gamma \\,=\\, \\int_{-\\infty}^{+\\infty} \\left[ \\frac{\\kappa}{2} \\left(\\frac{d\\eta}{dx}\\right)^{2} + f_{0}(\\eta) \\right] \\, dx,\n$$\nexpressed purely in terms of $A$ and $\\kappa$.\n\nAnswer specification:\n- Express your final answer as a single closed-form symbolic expression for $\\gamma$ in terms of $A$ and $\\kappa$.\n- Do not provide any numerical approximations.",
            "solution": "The problem as stated is a standard exercise in the calculus of variations, specifically within the context of Ginzburg-Landau theory for interfaces. All premises are scientifically sound, and the problem is mathematically well-posed. We proceed with the solution.\n\nThe problem requires finding a stationary profile $\\eta(x)$ that minimizes the free energy functional\n$$\nF[\\eta] = \\int_{-\\infty}^{+\\infty} L(\\eta, \\eta') \\, dx,\n$$\nwhere the Lagrangian is $L(\\eta, \\eta') = \\frac{\\kappa}{2} (\\eta')^{2} + f_{0}(\\eta)$, with $\\eta' \\equiv \\frac{d\\eta}{dx}$ and $f_{0}(\\eta) = \\frac{A}{4} (\\eta^{2} - 1)^{2}$. The parameters $\\kappa$ and $A$ are positive constants. The boundary conditions are $\\eta(x) \\to -1$ as $x \\to -\\infty$ and $\\eta(x) \\to +1$ as $x \\to +\\infty$.\n\nA stationary profile must satisfy the Euler-Lagrange equation:\n$$\n\\frac{\\partial L}{\\partial \\eta} - \\frac{d}{dx} \\left( \\frac{\\partial L}{\\partial \\eta'} \\right) = 0.\n$$\nThe partial derivatives of the Lagrangian are:\n$$\n\\frac{\\partial L}{\\partial \\eta} = \\frac{df_{0}}{d\\eta} = \\frac{A}{4} \\cdot 2(\\eta^2 - 1) \\cdot (2\\eta) = A\\eta(\\eta^2 - 1).\n$$\n$$\n\\frac{\\partial L}{\\partial \\eta'} = \\kappa \\eta'.\n$$\nSubstituting these into the Euler-Lagrange equation yields the governing ordinary differential equation for the stationary profile:\n$$\nA\\eta(\\eta^2 - 1) - \\kappa \\frac{d^2\\eta}{dx^2} = 0 \\quad \\implies \\quad \\kappa \\frac{d^2\\eta}{dx^2} = \\frac{df_{0}}{d\\eta}.\n$$\nThis is the required governing ODE. To find its first integral, we observe that the Lagrangian $L(\\eta, \\eta')$ does not explicitly depend on the independent variable $x$. Therefore, the Beltrami identity holds, which states that the quantity $H = \\eta' \\frac{\\partial L}{\\partial \\eta'} - L$ is a constant.\n$$\nH = \\eta'(\\kappa \\eta') - \\left[ \\frac{\\kappa}{2} (\\eta')^{2} + f_{0}(\\eta) \\right] = \\frac{\\kappa}{2} (\\eta')^{2} - f_{0}(\\eta) = \\text{const}.\n$$\nTo evaluate the constant, we apply the boundary conditions. As $x \\to \\pm\\infty$, the profile approaches one of the bulk equilibrium states, $\\eta \\to \\pm 1$. In these regions, the profile must be uniform, so $\\eta' \\to 0$. The bulk free energy density at these states is $f_{0}(\\pm 1) = \\frac{A}{4}((\\pm 1)^2 - 1)^2 = 0$.\nSubstituting these values into the expression for $H$, we find that the constant is $0$:\n$$\n\\frac{\\kappa}{2} (0)^{2} - 0 = 0.\n$$\nThus, the first integral of the motion for the energy-minimizing profile is\n$$\n\\frac{\\kappa}{2} \\left(\\frac{d\\eta}{dx}\\right)^{2} = f_{0}(\\eta).\n$$\nFrom this first integral, we can find the explicit form of the profile. We seek a monotone increasing solution ($\\frac{d\\eta}{dx}  0$) connecting $\\eta = -1$ to $\\eta = +1$.\n$$\n\\frac{d\\eta}{dx} = \\sqrt{\\frac{2f_{0}(\\eta)}{\\kappa}} = \\sqrt{\\frac{2}{\\kappa} \\frac{A}{4}(\\eta^2-1)^2} = \\sqrt{\\frac{A}{2\\kappa}} |\\eta^2-1|.\n$$\nSince $\\eta(x)$ varies between $-1$ and $+1$, the term $\\eta^2 - 1$ is non-positive, so $|\\eta^2 - 1| = 1 - \\eta^2$. The differential equation becomes:\n$$\n\\frac{d\\eta}{dx} = \\sqrt{\\frac{A}{2\\kappa}} (1 - \\eta^2).\n$$\nThis equation is separable. We integrate it subject to the condition that the interface is centered at $x=0$, i.e., $\\eta(0)=0$.\n$$\n\\int_{0}^{\\eta} \\frac{d\\tilde{\\eta}}{1 - \\tilde{\\eta}^2} = \\int_{0}^{x} \\sqrt{\\frac{A}{2\\kappa}} d\\tilde{x}\n$$\n$$\n[\\operatorname{arctanh}(\\tilde{\\eta})]_{0}^{\\eta} = \\left[\\sqrt{\\frac{A}{2\\kappa}}\\tilde{x}\\right]_{0}^{x}\n$$\n$$\n\\operatorname{arctanh}(\\eta) = \\sqrt{\\frac{A}{2\\kappa}} x.\n$$\nThe stationary profile is therefore given by:\n$$\n\\eta(x) = \\tanh\\left(\\sqrt{\\frac{A}{2\\kappa}} x\\right).\n$$\nThis profile correctly satisfies the boundary conditions $\\eta \\to \\pm 1$ as $x \\to \\pm \\infty$. The characteristic interfacial width, $\\lambda$, is typically defined from the scaling of the argument, $\\eta(x) = \\tanh(x/\\lambda)$. By comparison, we identify the width as:\n$$\n\\lambda = \\sqrt{\\frac{2\\kappa}{A}}.\n$$\nThe final step is to compute the interfacial free energy, $\\gamma$, defined as the value of the functional $F[\\eta]$ for this stationary profile:\n$$\n\\gamma = \\int_{-\\infty}^{+\\infty} \\left[ \\frac{\\kappa}{2} \\left(\\frac{d\\eta}{dx}\\right)^{2} + f_{0}(\\eta) \\right] dx.\n$$\nUsing the first integral, $\\frac{\\kappa}{2}(\\eta')^2 = f_{0}(\\eta)$, we can simplify the integrand:\n$$\n\\gamma = \\int_{-\\infty}^{+\\infty} 2 f_{0}(\\eta) \\, dx \\quad \\text{or} \\quad \\gamma = \\int_{-\\infty}^{+\\infty} \\kappa \\left(\\frac{d\\eta}{dx}\\right)^{2} dx.\n$$\nA more direct method for calculation is to use the first integral to write $\\frac{d\\eta}{dx}$ in terms of $\\eta$ and change the integration variable from $x$ to $\\eta$.\n$$\n\\gamma = \\int_{-\\infty}^{+\\infty} \\kappa \\left(\\frac{d\\eta}{dx}\\right) \\frac{d\\eta}{dx} dx = \\int_{\\eta(-\\infty)}^{\\eta(+\\infty)} \\kappa \\left(\\frac{d\\eta}{dx}\\right) d\\eta.\n$$\nSubstituting $\\frac{d\\eta}{dx} = \\sqrt{\\frac{2f_0(\\eta)}{\\kappa}}$:\n$$\n\\gamma = \\int_{-1}^{+1} \\kappa \\sqrt{\\frac{2f_{0}(\\eta)}{\\kappa}} d\\eta = \\int_{-1}^{+1} \\sqrt{2\\kappa f_{0}(\\eta)} \\,d\\eta.\n$$\nNow, we substitute the expression for $f_0(\\eta)$:\n$$\n\\gamma = \\int_{-1}^{+1} \\sqrt{2\\kappa \\cdot \\frac{A}{4}(\\eta^2-1)^2} \\, d\\eta = \\sqrt{\\frac{A\\kappa}{2}} \\int_{-1}^{+1} |\\eta^2-1| \\, d\\eta.\n$$\nAgain, since $\\eta \\in [-1, 1]$, we have $|\\eta^2 - 1| = 1 - \\eta^2$.\n$$\n\\gamma = \\sqrt{\\frac{A\\kappa}{2}} \\int_{-1}^{+1} (1-\\eta^2) \\, d\\eta.\n$$\nThe integral is elementary:\n$$\n\\int_{-1}^{+1} (1-\\eta^2) \\, d\\eta = \\left[\\eta - \\frac{\\eta^3}{3}\\right]_{-1}^{+1} = \\left(1 - \\frac{1}{3}\\right) - \\left(-1 - \\frac{-1}{3}\\right) = \\frac{2}{3} - \\left(-\\frac{2}{3}\\right) = \\frac{4}{3}.\n$$\nSubstituting this result back into the expression for $\\gamma$:\n$$\n\\gamma = \\sqrt{\\frac{A\\kappa}{2}} \\cdot \\frac{4}{3} = \\frac{4}{3\\sqrt{2}}\\sqrt{A\\kappa} = \\frac{2\\sqrt{2}}{3}\\sqrt{A\\kappa}.\n$$\nThis is the final expression for the interfacial energy in terms of the given parameters $A$ and $\\kappa$.",
            "answer": "$$\n\\boxed{\\frac{2\\sqrt{2}}{3}\\sqrt{A\\kappa}}\n$$"
        },
        {
            "introduction": "The evolution of a microstructure is governed by specific dynamic laws, which can be broadly classified as either conserved or non-conserved. This distinction is not arbitrary; it reflects the underlying physics of the process, such as atomic diffusion versus a structural reordering. This practice challenges you to use the divergence theorem to prove why the mathematical form of the Cahn-Hilliard equation inherently conserves the total amount of a species, whereas the Allen-Cahn equation does not . Mastering this distinction is crucial for selecting the correct model for phenomena ranging from spinodal decomposition to grain growth.",
            "id": "4149872",
            "problem": "Consider a thin Silicon-Germanium alloy film patch used in semiconductor wafer processing, occupying a bounded domain $\\Omega \\subset \\mathbb{R}^3$ with either periodic boundary conditions or zero normal flux boundary conditions on $\\partial \\Omega$. Let $c(\\mathbf{x},t)$ denote the local atomic fraction of Germanium and let $\\phi(\\mathbf{x},t)$ denote a non-conserved structural order parameter for a secondary phase. The initial composition $c(\\mathbf{x},0)$ has spatial average $\\bar{c}$ over $\\Omega$. The thermodynamic driving forces are derived from a free energy functional $F$ which, for each field, has a standard Ginzburg–Landau form with a local bulk energy density and a gradient penalty: for composition,\n$$\nF[c] \\;=\\; \\int_{\\Omega} \\left(f_0(c) \\;+\\; \\frac{\\kappa}{2}\\,|\\nabla c|^2\\right)\\, dV,\n$$\nand for the order parameter,\n$$\nF[\\phi] \\;=\\; \\int_{\\Omega} \\left(g_0(\\phi) \\;+\\; \\frac{\\beta}{2}\\,|\\nabla \\phi|^2\\right)\\, dV,\n$$\nwhere $\\kappa0$ and $\\beta0$ are constants and $f_0$ and $g_0$ are smooth double-well type bulk energy densities appropriate to the alloy and phase under consideration. The chemical potentials are the variational derivatives $\\mu_c = \\delta F / \\delta c$ and $\\mu_{\\phi} = \\delta F / \\delta \\phi$.\n\nAssume the following fundamental evolution laws:\n- Conservation of species for $c(\\mathbf{x},t)$, given by the continuity equation\n$$\n\\frac{\\partial c}{\\partial t} \\;+\\; \\nabla \\cdot \\mathbf{J}_c \\;=\\; 0,\n$$\nwith constitutive diffusive flux\n$$\n\\mathbf{J}_c \\;=\\; -\\,M(c)\\,\\nabla \\mu_c,\n$$\nwhere $M(c)$ is a smooth, nonnegative mobility.\n- Non-conserved relaxational dynamics for $\\phi(\\mathbf{x},t)$, given by\n$$\n\\frac{\\partial \\phi}{\\partial t} \\;=\\; -\\,L(\\phi)\\,\\mu_{\\phi},\n$$\nwhere $L(\\phi)$ is a smooth, nonnegative kinetic coefficient.\n\nUsing only these laws, the definition of variational derivative, and the divergence theorem, derive the exact expressions for the rates of change of the domain integrals $\\int_{\\Omega} c(\\mathbf{x},t)\\, dV$ and $\\int_{\\Omega} \\phi(\\mathbf{x},t)\\, dV$ under the stated boundary conditions, and explain the mathematical reason for any difference between them. Express your final answer as a single symbolic row matrix containing the two rates as entries. No numerical evaluation is required, and no rounding is needed.",
            "solution": "The problem requires the derivation of the rate of change for the total amount of a conserved species $c(\\mathbf{x}, t)$ and a non-conserved order parameter $\\phi(\\mathbf{x}, t)$ within a domain $\\Omega$. The analysis will rely on the provided evolution equations and the divergence theorem under the specified boundary conditions.\n\nFirst, we analyze the rate of change of the total amount of Germanium, represented by the integral of the concentration field $c(\\mathbf{x}, t)$ over the domain $\\Omega$. The quantity of interest is $\\frac{d}{dt} \\int_{\\Omega} c(\\mathbf{x}, t) \\, dV$. Since the domain $\\Omega$ is fixed in time, we can apply the Leibniz integral rule to move the time derivative inside the integral:\n$$\n\\frac{d}{dt} \\int_{\\Omega} c(\\mathbf{x}, t) \\, dV = \\int_{\\Omega} \\frac{\\partial c(\\mathbf{x}, t)}{\\partial t} \\, dV\n$$\nThe problem provides the evolution law for $c$ as a continuity equation:\n$$\n\\frac{\\partial c}{\\partial t} = -\\nabla \\cdot \\mathbf{J}_c\n$$\nwhere $\\mathbf{J}_c$ is the diffusive flux. Substituting this into our integral gives:\n$$\n\\frac{d}{dt} \\int_{\\Omega} c \\, dV = \\int_{\\Omega} (-\\nabla \\cdot \\mathbf{J}_c) \\, dV = -\\int_{\\Omega} (\\nabla \\cdot \\mathbf{J}_c) \\, dV\n$$\nWe now apply the divergence theorem (also known as Gauss's theorem), which states that for a continuously differentiable vector field $\\mathbf{F}$ on a domain $\\Omega$ with boundary $\\partial\\Omega$, $\\int_{\\Omega} (\\nabla \\cdot \\mathbf{F}) \\, dV = \\oint_{\\partial\\Omega} \\mathbf{F} \\cdot \\mathbf{n} \\, dS$, where $\\mathbf{n}$ is the outward-pointing unit normal vector to the boundary surface. Applying this theorem to the flux vector $\\mathbf{J}_c$, we get:\n$$\n\\frac{d}{dt} \\int_{\\Omega} c \\, dV = -\\oint_{\\partial\\Omega} \\mathbf{J}_c \\cdot \\mathbf{n} \\, dS\n$$\nThe problem specifies two possible types of boundary conditions: periodic boundary conditions or zero normal flux boundary conditions.\n1.  **Zero normal flux:** This condition is defined as $\\mathbf{J}_c \\cdot \\mathbf{n} = 0$ for all points on the boundary $\\partial\\Omega$. In this case, the integrand of the surface integral is identically zero, and thus the integral evaluates to zero.\n2.  **Periodic boundary conditions:** In this case, the domain $\\Omega$ is treated as a representative volume element that repeats in space, meaning it has no physical boundary. Mathematically, any flux leaving one face of the domain re-enters through the opposite face. The integral over the entire boundary $\\partial\\Omega$ thus evaluates to zero as the contributions from opposite faces cancel each other out.\n\nFor both specified boundary conditions, the surface integral is zero:\n$$\n\\oint_{\\partial\\Omega} \\mathbf{J}_c \\cdot \\mathbf{n} \\, dS = 0\n$$\nTherefore, the rate of change of the total amount of species $c$ is zero:\n$$\n\\frac{d}{dt} \\int_{\\Omega} c(\\mathbf{x}, t) \\, dV = 0\n$$\n\nNext, we analyze the rate of change of the total amount of the order parameter $\\phi(\\mathbf{x}, t)$. The quantity is $\\frac{d}{dt} \\int_{\\Omega} \\phi(\\mathbf{x}, t) \\, dV$. Again, using the Leibniz integral rule:\n$$\n\\frac{d}{dt} \\int_{\\Omega} \\phi(\\mathbf{x}, t) \\, dV = \\int_{\\Omega} \\frac{\\partial \\phi(\\mathbf{x}, t)}{\\partial t} \\, dV\n$$\nThe problem provides the evolution law for $\\phi$ as non-conserved relaxational dynamics:\n$$\n\\frac{\\partial \\phi}{\\partial t} = -L(\\phi)\\mu_{\\phi}\n$$\nwhere $L(\\phi)$ is a nonnegative kinetic coefficient and $\\mu_{\\phi}$ is the chemical potential for the order parameter. Substituting this into the integral gives:\n$$\n\\frac{d}{dt} \\int_{\\Omega} \\phi \\, dV = \\int_{\\Omega} \\left( -L(\\phi)\\mu_{\\phi} \\right) \\, dV = -\\int_{\\Omega} L(\\phi)\\mu_{\\phi} \\, dV\n$$\nThis is the final expression for the rate of change of the total amount of $\\phi$. Unlike the case for $c$, this expression does not generally evaluate to zero. There is no mathematical theorem or physical principle within the provided framework that would force this integral to be zero. The chemical potential $\\mu_{\\phi} = \\frac{\\delta F}{\\delta \\phi}$ represents the thermodynamic driving force for changes in $\\phi$. The system will evolve to reduce the total free energy, which typically involves local changes in $\\phi$ whose integral over the domain is non-zero. For example, the growth of a stable phase ($\\phi=1$) at the expense of an unstable one ($\\phi=0$) would lead to an increase in $\\int_{\\Omega} \\phi \\, dV$.\n\nThe fundamental difference between the two results stems directly from the mathematical form of their respective evolution equations.\n- The evolution of $c$ is governed by a **conservation law**, $\\frac{\\partial c}{\\partial t} + \\nabla \\cdot \\mathbf{J}_c = 0$. The time derivative of the field is equal to the negative divergence of a flux vector. This structure is the mathematical statement of local conservation. Integrating over the volume allows the use of the divergence theorem to relate the change of the total quantity within the volume to the flux across its boundary. With zero-flux or periodic boundary conditions, this boundary flux is zero, leading to the conservation of the total quantity $\\int_{\\Omega} c \\, dV$.\n- The evolution of $\\phi$ is governed by a **non-conserved relaxational law**, $\\frac{\\partial \\phi}{\\partial t} = -L(\\phi)\\mu_{\\phi}$. The right-hand side is a local source/sink term determined by the local thermodynamic driving force, not the divergence of a flux vector. Integrating this equation over the volume does not naturally lead to a surface integral via the divergence theorem. Consequently, there is no constraint that conserves the total quantity $\\int_{\\Omega} \\phi \\, dV$.\n\nIn summary, the total amount of species $c$ is conserved, so its rate of change is $0$. The total amount of the order parameter $\\phi$ is not conserved, and its rate of change is given by the volume integral of its local source/sink term, $-\\int_{\\Omega} L(\\phi)\\mu_{\\phi} \\, dV$.\n\nThe final answer consists of the two derived rates presented as a row matrix.",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 0  -\\int_{\\Omega} L(\\phi)\\mu_{\\phi}\\,dV \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "While analytical solutions offer profound insights into simplified scenarios, the true power of phase-field modeling is realized through numerical simulation. This hands-on coding exercise bridges the gap between theory and application by tasking you with implementing a Fourier pseudo-spectral solver for the Cahn-Hilliard equation, a workhorse model for conserved dynamics. You will not only develop a stable semi-implicit scheme but also verify a fundamental physical law: the monotonic decrease of the system's total free energy, confirming that your simulation correctly captures the dissipative nature of the evolution process .",
            "id": "2847487",
            "problem": "Consider the Cahn–Hilliard equation for a conserved phase field $c(x,t)$ on a one–dimensional periodic domain of length $L$,\n$$\n\\frac{\\partial c}{\\partial t} = M \\nabla^2 \\mu,\\quad \\mu = \\frac{\\delta \\mathcal{F}}{\\delta c},\n$$\nwhere the free-energy functional is\n$$\n\\mathcal{F}[c] = \\int_0^L \\left( F(c) + \\frac{\\kappa}{2} \\left|\\nabla c\\right|^2 \\right)\\, dx,\\quad F(c) = \\frac{1}{4}\\left(c^2-1\\right)^2,\n$$\nwith mobility $Mgt;0$ and gradient-energy coefficient $\\kappagt;0$. Assume periodic boundary conditions and nondimensional variables so that no physical units are required anywhere in the computation or the output.\n\nYour task is to start from these definitions and first principles, and, by invoking the variational derivative and the definition of the chemical potential, derive a first-order accurate in time, Fourier pseudo-spectral semi-implicit discretization in which the contribution to the chemical potential arising from the gradient-energy term is handled implicitly while the nonlinear bulk derivative $F'(c)$ is handled explicitly. Discretize space using a uniform grid with $N$ points on a periodic interval of length $L$, and use the Fast Fourier Transform to represent spatial derivatives spectrally. Evolve the phase field $c$ forward in time for a specified number of time steps $\\Delta t$ and compute the discrete free energy at each time step using the trapezoidal rule on the grid:\n$$\n\\mathcal{F}_h[c] = \\sum_{j=0}^{N-1} \\left[ \\frac{1}{4}\\left(c_j^2-1\\right)^2 + \\frac{\\kappa}{2} \\left(\\partial_x c\\big|_j\\right)^2 \\right] \\Delta x,\n$$\nwhere $\\Delta x = L/N$, $c_j = c(x_j)$, $x_j = j\\,\\Delta x$, and $\\partial_x c$ is to be computed spectrally by multiplying the Fourier coefficients of $c$ by $\\mathrm{i}k$ with the standard wave numbers $k$ corresponding to the chosen $L$ and $N$. You must verify, for each test case, whether the discrete free energy sequence $\\{\\mathcal{F}_h^n\\}_{n=0}^{N_t}$, where $N_t$ is the number of time steps, is monotonically non-increasing, that is, whether $\\mathcal{F}_h^{n+1} \\le \\mathcal{F}_h^{n}$ for all $n$. Because of floating-point roundoff, you may allow a small non-negative tolerance determined algorithmically, but you must explain and justify your choice in your solution.\n\nImplement your derivation as an executable program that constructs the spectral operators, advances the semi-implicit scheme, computes the discrete free energy at every step, and returns a boolean indicating whether the free energy decreased monotonically over the entire run for each specified parameter set.\n\nUse the following test suite of parameter sets. For every case, let the domain length be $L=2\\pi$, and use nondimensional parameters. The initial condition in the “noise” cases is a spatially uncorrelated Gaussian perturbation with zero mean and specified amplitude, made reproducible by the indicated pseudorandom seed. The initial condition in the “uniform” case is spatially constant. For each case, report whether the free energy is monotonically non-increasing over the steps taken.\n\n- Case $1$ (happy path): $N=128$, $M=1$, $\\kappa=10^{-2}$, $\\Delta t = 2\\times 10^{-5}$, number of steps $N_t=2000$, initial condition type “noise” with amplitude $10^{-2}$ and seed $1$.\n- Case $2$ (moderately small time step): $N=128$, $M=1$, $\\kappa=10^{-2}$, $\\Delta t = 10^{-4}$, number of steps $N_t=400$, initial condition type “noise” with amplitude $10^{-2}$ and seed $2$.\n- Case $3$ (boundary condition at a bulk minimum): $N=64$, $M=1$, $\\kappa=10^{-2}$, $\\Delta t = 5\\times 10^{-4}$, number of steps $N_t=200$, initial condition type “uniform” with value $+1$.\n- Case $4$ (larger time step, potential to violate monotonic decay): $N=128$, $M=1$, $\\kappa=10^{-2}$, $\\Delta t = 2\\times 10^{-3}$, number of steps $N_t=100$, initial condition type “noise” with amplitude $10^{-2}$ and seed $3$.\n\nAll variables and parameters are nondimensional; no physical units are required for any quantity. Your program must produce, in a single line, a list of four booleans corresponding to the four cases above, in the order stated. The final output format must be exactly one line containing the results as a comma-separated list enclosed in square brackets, for example, “[True,False,True,True]”.\n\nYour implementation must be self-contained, use a Fourier pseudo-spectral representation for spatial derivatives, and follow the semi-implicit time discretization you derive from the stated principles, without relying on any external data. Do not include any extraneous output. The only acceptable output is the final single-line list of booleans as specified.",
            "solution": "The problem is valid as it is scientifically grounded, well-posed, and objective. It presents a standard numerical task in computational materials physics with all necessary information provided. We proceed with the derivation and solution.\n\nThe Cahn-Hilliard equation describes the evolution of a conserved phase field $c(x,t)$ and is given by\n$$\n\\frac{\\partial c}{\\partial t} = M \\nabla^2 \\mu,\n$$\nwhere $M$ is the mobility and $\\mu$ is the chemical potential. The chemical potential is defined as the variational derivative of the Ginzburg-Landau free-energy functional $\\mathcal{F}[c]$ with respect to the phase field $c$:\n$$\n\\mu = \\frac{\\delta \\mathcal{F}}{\\delta c}.\n$$\nThe free-energy functional is given as\n$$\n\\mathcal{F}[c] = \\int_0^L \\left( F(c) + \\frac{\\kappa}{2} |\\nabla c|^2 \\right) dx,\n$$\nwith a double-well bulk energy density $F(c) = \\frac{1}{4}(c^2-1)^2$ and a gradient-energy coefficient $\\kappa  0$.\n\nFirst, we derive the explicit form of the chemical potential $\\mu$. The integrand of the functional is $I(c, \\nabla c) = F(c) + \\frac{\\kappa}{2} |\\nabla c|^2$. The variational derivative is found using the Euler-Lagrange equation:\n$$\n\\mu = \\frac{\\delta \\mathcal{F}}{\\delta c} = \\frac{\\partial I}{\\partial c} - \\nabla \\cdot \\frac{\\partial I}{\\partial (\\nabla c)}.\n$$\nThe required partial derivatives are:\n$$\n\\frac{\\partial I}{\\partial c} = \\frac{dF}{dc} = \\frac{d}{dc}\\left[\\frac{1}{4}(c^2-1)^2\\right] = \\frac{1}{4} \\cdot 2(c^2-1) \\cdot 2c = c^3 - c.\n$$\n$$\n\\frac{\\partial I}{\\partial (\\nabla c)} = \\kappa \\nabla c.\n$$\nSubstituting these into the expression for $\\mu$ yields:\n$$\n\\mu = (c^3 - c) - \\kappa \\nabla^2 c.\n$$\nInserting this into the Cahn-Hilliard equation gives the full fourth-order nonlinear partial differential equation:\n$$\n\\frac{\\partial c}{\\partial t} = M \\nabla^2 (c^3 - c - \\kappa \\nabla^2 c) = M \\left( \\nabla^2(c^3 - c) - \\kappa \\nabla^4 c \\right).\n$$\n\nFor the numerical solution, we employ a Fourier pseudo-spectral method for spatial discretization and a semi-implicit first-order scheme for time integration. The spatial domain $[0, L]$ is discretized into $N$ grid points $x_j = j \\Delta x$ with grid spacing $\\Delta x = L/N$. The phase field $c(x,t)$ is represented by its values $c_j(t)$ on this grid. In the Fourier spectral method, spatial derivatives are computed in Fourier space. A function $f(x)$ is transformed to its Fourier coefficients $\\hat{f}(k)$, where $k$ are the wavenumbers. The $n$-th derivative in Fourier space corresponds to multiplication by $(ik)^n$. Thus, $\\nabla^2$ becomes multiplication by $-k^2$ and $\\nabla^4$ becomes multiplication by $k^4$.\n\nThe problem requires a semi-implicit time-stepping scheme where the nonlinear bulk term's contribution, which comes from $F'(c) = c^3-c$, is treated explicitly, and the stiff gradient energy term, $-\\kappa\\nabla^2 c$, is treated implicitly. Using a first-order forward Euler for the explicit part and backward Euler for the implicit part, the time-discretized equation for a time step $\\Delta t$ from step $n$ to $n+1$ is:\n$$\n\\frac{c^{n+1} - c^n}{\\Delta t} = M \\nabla^2 \\left[ ( (c^n)^3 - c^n ) - \\kappa \\nabla^2 c^{n+1} \\right].\n$$\nThis equation is algebraic in Fourier space, which makes it easy to solve for $\\hat{c}^{n+1}$. Let $\\hat{c}^n(k)$ be the discrete Fourier transform of $c^n(x_j)$. Transforming the equation, we get:\n$$\n\\frac{\\hat{c}^{n+1} - \\hat{c}^n}{\\Delta t} = M (-k^2) \\left[ \\widehat{((c^n)^3 - c^n)} + \\kappa k^2 \\hat{c}^{n+1} \\right].\n$$\nThe term $\\widehat{((c^n)^3 - c^n)}$ is computed pseudo-spectrally: the expression $(c^n)^3 - c^n$ is evaluated in real space at each grid point, and the result is then transformed to Fourier space.\nWe rearrange the equation to solve for $\\hat{c}^{n+1}(k)$:\n$$\n\\hat{c}^{n+1} - \\hat{c}^n = -M k^2 \\Delta t \\, \\widehat{((c^n)^3 - c^n)} - M \\kappa k^4 \\Delta t \\, \\hat{c}^{n+1}\n$$\n$$\n\\hat{c}^{n+1}(1 + M \\kappa k^4 \\Delta t) = \\hat{c}^n - M k^2 \\Delta t \\, \\widehat{((c^n)^3 - c^n)}\n$$\nThis yields the update rule for the Fourier coefficients at each time step:\n$$\n\\hat{c}^{n+1}(k) = \\frac{\\hat{c}^n(k) - M k^2 \\Delta t \\, \\widehat{((c^n)^3 - c^n)}(k)}{1 + M \\kappa k^4 \\Delta t}.\n$$\nAt each time step, we start with $c^n$, compute its Fourier transform $\\hat{c}^n$, compute the nonlinear term and its transform, apply the update rule to find $\\hat{c}^{n+1}$, and then perform an inverse Fourier transform to obtain $c^{n+1}$.\n\nThe discrete free energy $\\mathcal{F}_h$ is calculated at each step using the trapezoidal rule on the grid:\n$$\n\\mathcal{F}_h[c] = \\sum_{j=0}^{N-1} \\left[ \\frac{1}{4}(c_j^2-1)^2 + \\frac{\\kappa}{2} (\\partial_x c|_j)^2 \\right] \\Delta x.\n$$\nThe spatial derivative $\\partial_x c$ is computed spectrally by taking the Fourier transform of $c$, multiplying the coefficients $\\hat{c}(k)$ by $ik$, and then taking the inverse Fourier transform.\n\nWe must verify if the energy sequence $\\{\\mathcal{F}_h^n\\}$ is monotonically non-increasing. Numerical computation with finite-precision arithmetic introduces roundoff errors. A check for strict inequality $\\mathcal{F}_h^{n+1} \\le \\mathcal{F}_h^{n}$ is therefore inappropriate. An energy increase is considered significant only if it exceeds a tolerance. A robust tolerance must account for both the absolute magnitude of potential roundoff errors in near-zero energies and the relative error when energy is large. We define the tolerance $\\epsilon_{tol}$ as a sum of an absolute component $\\tau_{abs}$ and a relative component $\\tau_{rel} \\cdot |\\mathcal{F}_h^n|$. The condition for a non-monotonic step is then $\\mathcal{F}_h^{n+1} - \\mathcal{F}_h^n  \\tau_{abs} + \\tau_{rel} |\\mathcal{F}_h^n|$. For the double-precision floating-point numbers used, we choose conservative values $\\tau_{abs} = 10^{-12}$ and $\\tau_{rel} = 10^{-10}$. An energy sequence is deemed non-monotonic if this condition is met for any time step $n$.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function to run all test cases and print the final result.\n    \"\"\"\n    test_cases = [\n        # Case 1 (happy path): N=128, M=1, kappa=10^-2, dt=2x10^-5, Nt=2000, \n        # IC noise amp=10^-2, seed=1.\n        {'N': 128, 'M': 1.0, 'kappa': 1e-2, 'dt': 2e-5, 'Nt': 2000, \n         'ic_type': 'noise', 'ic_params': (1e-2, 1)},\n        # Case 2 (moderately small time step): N=128, M=1, kappa=10^-2, dt=10^-4, Nt=400,\n        # IC noise amp=10^-2, seed=2.\n        {'N': 128, 'M': 1.0, 'kappa': 1e-2, 'dt': 1e-4, 'Nt': 400, \n         'ic_type': 'noise', 'ic_params': (1e-2, 2)},\n        # Case 3 (boundary condition at a bulk minimum): N=64, M=1, kappa=10^-2, dt=5x10-4, Nt=200,\n        # IC uniform value=+1.\n        {'N': 64, 'M': 1.0, 'kappa': 1e-2, 'dt': 5e-4, 'Nt': 200,\n         'ic_type': 'uniform', 'ic_params': (1.0,)},\n        # Case 4 (larger time step, potential to violate monotonic decay): N=128, M=1, kappa=10^-2, dt=2x10-3, Nt=100,\n        # IC noise amp=10^-2, seed=3.\n        {'N': 128, 'M': 1.0, 'kappa': 1e-2, 'dt': 2e-3, 'Nt': 100,\n         'ic_type': 'noise', 'ic_params': (1e-2, 3)},\n    ]\n\n    results = []\n    for case in test_cases:\n        result = run_simulation(**case)\n        results.append(result)\n\n    # Format the final output string as specified\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef run_simulation(N, M, kappa, dt, Nt, ic_type, ic_params):\n    \"\"\"\n    Runs a single Cahn-Hilliard simulation for a given set of parameters.\n    Returns a boolean indicating if the free energy was monotonically non-increasing.\n    \"\"\"\n    L = 2.0 * np.pi\n    dx = L / N\n    k = 2.0 * np.pi * np.fft.fftfreq(N, d=dx)\n\n    # Set up initial condition\n    if ic_type == \"noise\":\n        amplitude, seed = ic_params\n        np.random.seed(seed)\n        c = amplitude * np.random.randn(N)\n    elif ic_type == \"uniform\":\n        value = ic_params[0]\n        c = np.full(N, value, dtype=float)\n\n    # Pre-calculate the denominator for the semi-implicit scheme, as it is constant.\n    den = 1.0 + M * kappa * k**4 * dt\n\n    energies = []\n    \n    # Calculate and store initial energy\n    energies.append(calculate_energy(c, k, kappa, dx))\n\n    # Perform time-stepping\n    for _ in range(Nt):\n        # Evaluate nonlinear term F'(c) = c^3 - c in real space\n        F_prime = c**3 - c\n        F_prime_hat = np.fft.fft(F_prime)\n        \n        c_hat = np.fft.fft(c)\n        \n        # Calculate numerator of the update rule\n        num = c_hat - M * dt * k**2 * F_prime_hat\n        \n        # Update concentration field in Fourier space\n        c_hat_new = num / den\n        \n        # Transform back to real space for the next step\n        # Taking np.real is necessary to discard numerical noise in the imaginary part\n        c = np.real(np.fft.ifft(c_hat_new))\n        \n        # Calculate and store energy of the new state\n        energies.append(calculate_energy(c, k, kappa, dx))\n\n    # Check for monotonic decrease in the stored energy sequence\n    is_monotonic = True\n    for i in range(len(energies) - 1):\n        # A tolerance is necessary for floating-point comparisons.\n        # It combines an absolute component for near-zero energies and\n        # a relative component for larger energies.\n        abs_tol = 1e-12\n        rel_tol = 1e-10\n        tolerance = abs_tol + rel_tol * abs(energies[i])\n        \n        if energies[i+1] > energies[i] + tolerance:\n            is_monotonic = False\n            break\n            \n    return is_monotonic\n\ndef calculate_energy(c, k, kappa, dx):\n    \"\"\"\n    Computes the discrete free energy of the system using the trapezoidal rule.\n    \"\"\"\n    # Bulk energy contribution: F(c) = (1/4)(c^2-1)^2\n    bulk_energy_density = 0.25 * (c**2 - 1)**2\n    \n    # Gradient energy contribution: (kappa/2) |grad c|^2\n    # The derivative is computed spectrally for high accuracy.\n    c_hat = np.fft.fft(c)\n    grad_c_hat = 1j * k * c_hat\n    grad_c = np.real(np.fft.ifft(grad_c_hat))\n    gradient_energy_density = 0.5 * kappa * grad_c**2\n    \n    # Total free energy is the integral over the domain, approximated by a sum.\n    # For a periodic function on a uniform grid, this sum is the trapezoidal rule.\n    total_energy = np.sum(bulk_energy_density + gradient_energy_density) * dx\n    return total_energy\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}