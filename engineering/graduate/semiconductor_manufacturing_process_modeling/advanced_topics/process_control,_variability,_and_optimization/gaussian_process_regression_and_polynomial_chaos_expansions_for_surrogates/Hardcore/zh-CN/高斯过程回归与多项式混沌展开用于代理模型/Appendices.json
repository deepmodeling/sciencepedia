{
    "hands_on_practices": [
        {
            "introduction": "构建多项式混沌展开 (PCE) 代理模型的第一步是一个关键决策：确定模型的复杂度。这个复杂度直接关系到多项式基函数的数量，而基函数的数量又取决于不确定性输入变量的维度 ($d$) 和所选的最大多项式阶数 ($p$)。本练习将引导您从第一性原理出发，推导标准全阶展开中基函数数量的计算公式。掌握这种组合计数是为实际工程问题设计和实现高效 PCE 模型的基本功。",
            "id": "4128836",
            "problem": "我们构建了一个用于光刻胶中线边缘粗糙度的计算光刻代理模型，该模型是 $d$ 个统计上独立的标准化工艺输入的函数：曝光剂量、离焦、掩模偏置、数值孔径、光刻胶厚度和曝光后烘烤时间，因此 $d=6$。正在考虑两种代理建模方法：高斯过程回归 (GPR) 和多项式混沌展开 (PCE)。对于 PCE，我们选择了一个与边缘输入分布一致的标准正交基，并施加了阶数为 $p$ 的总阶截断，这意味着所有总阶小于或等于 $p$ 的多元多项式基函数都被保留。\n\n从组合计数的第一性原理出发，仅从 $d$ 个变量的多元单项式的定义 $x^{\\boldsymbol{\\alpha}}=\\prod_{i=1}^{d}x_{i}^{\\alpha_{i}}$（其中多重指标 $\\boldsymbol{\\alpha}\\in\\mathbb{N}_{0}^{d}$，总阶为 $\\lvert\\boldsymbol{\\alpha}\\rvert=\\sum_{i=1}^{d}\\alpha_{i}$）开始，推导出一个闭式表达式，用于计算总阶至多为 $p$ 的 $d$ 个变量的多元单项式的不同数量。然后，对于具有 $d=6$ 个输入和总阶截断阶数 $p=3$ 的光刻模型，计算这个数量。\n\n你的最终答案必须是一个整数。不需要四舍五入，也不需要单位。最终答案仅以一个数字表示。",
            "solution": "问题陈述经过严格验证，被认为是有效的。它在科学上基于代理建模和组合数学领域，问题提出得当，提供了所有必要信息，并且表述客观。没有发现任何缺陷。我们可以继续进行解答。\n\n问题要求完成两个任务。首先，推导一个闭式表达式，用于计算总阶至多为 $p$ 的 $d$ 个变量的多元单项式的不同数量。其次，在半导体制造过程建模的一个具体应用中，当输入变量数为 $d=6$、总阶截断阶数为 $p=3$ 时，计算这个数量。\n\n在总阶截断阶数为 $p$ 的多项式混沌展开 (PCE) 中，基函数的数量等于形式为 $x^{\\boldsymbol{\\alpha}} = \\prod_{i=1}^{d}x_{i}^{\\alpha_{i}}$ 的不同多元单项式的数量，其中总阶 $\\lvert\\boldsymbol{\\alpha}\\rvert = \\sum_{i=1}^{d}\\alpha_{i}$ 小于或等于 $p$。多重指标 $\\boldsymbol{\\alpha}$ 是一个非负整数向量，$\\boldsymbol{\\alpha} = (\\alpha_1, \\alpha_2, \\dots, \\alpha_d) \\in \\mathbb{N}_{0}^{d}$。\n\n我们的目标是找到所有这些有效多重指标集合的基数，我们用 $N$ 表示。这是以下不等式的整数解的数量：\n$$ \\sum_{i=1}^{d} \\alpha_i \\leq p, \\quad \\text{其中 } \\alpha_i \\in \\mathbb{N}_0 \\text{ 对于 } i=1, 2, \\dots, d $$\n这是一个组合枚举问题。为了从第一性原理解决它，我们可以通过引入一个非负整数松弛变量（我们称之为 $\\alpha_{d+1}$）将不等式转化为等式。原始不等式等价于以下方程：\n$$ \\alpha_1 + \\alpha_2 + \\dots + \\alpha_d + \\alpha_{d+1} = p $$\n其中对于所有 $i \\in \\{1, 2, \\dots, d+1\\}$，$\\alpha_i \\geq 0$。松弛变量 $\\alpha_{d+1}$ 代表差值 $p - \\sum_{i=1}^{d} \\alpha_i$，根据原始不等式，该值必须为非负。$d$ 个变量的不等式解集与 $d+1$ 个变量的等式解集之间存在一一对应关系。\n\n我们现在需要计算这个方程的非负整数解的数量。这是一个经典的组合问题，可以使用“隔板法”来解决。想象我们有 $p$ 个不可区分的物品（“星星”，代表总和的单位），我们想将它们放入 $d+1$ 个可区分的箱子中（代表变量 $\\alpha_1, \\dots, \\alpha_{d+1}$）。要将星星分成 $d+1$ 个箱子，我们需要 $d$ 个分隔符（“隔板”）。\n\n考虑一个由 $p$ 个星星和 $d$ 个隔板排成一行的序列。例如，如果 $p=3$ 且 $d=2$（意味着有 $d+1=3$ 个箱子），一个可能的排列是 `*|**|`。这对应于解 $\\alpha_1=1$, $\\alpha_2=2$, $\\alpha_3=0$。第一个隔板前的星星数是 $\\alpha_1$，第一个和第二个隔板之间的星星数是 $\\alpha_2$，以此类推。最后一个隔板后的星星数是 $\\alpha_{d+1}$。\n\n这个排列中的总位置数是星星数和隔板数的总和，即 $p+d$。不同解的总数等于我们可以排列这 $p$ 个星星和 $d$ 个隔板的方式数。这等同于从 $p+d$ 个可用位置中为 $d$ 个隔板选择位置。剩余的位置将由星星填充。\n\n实现这一目标的方法数由二项式系数“p+d 中选 d”给出：\n$$ N = \\binom{p+d}{d} $$\n根据二项式系数的对称性，$\\binom{n}{k} = \\binom{n}{n-k}$，这也等于：\n$$ N = \\binom{p+d}{p} $$\n这就是总阶至多为 $p$ 的 $d$ 个变量的多元单项式不同数量的闭式表达式。\n\n现在，我们必须为问题中给出的具体情况计算这个表达式的值：一个具有 $d=6$ 个输入和总阶截断阶数 $p=3$ 的光刻模型。\n将这些值代入我们推导出的公式中：\n$$ N = \\binom{p+d}{d} = \\binom{3+6}{6} = \\binom{9}{6} $$\n我们可以计算这个二项式系数。使用对称形式通常更简单：\n$$ \\binom{9}{6} = \\binom{9}{9-6} = \\binom{9}{3} $$\n现在我们使用阶乘的定义展开二项式系数：\n$$ \\binom{9}{3} = \\frac{9!}{3!(9-3)!} = \\frac{9!}{3!6!} $$\n$$ \\binom{9}{3} = \\frac{9 \\times 8 \\times 7 \\times 6!}{ (3 \\times 2 \\times 1) \\times 6!} $$\n消去 $6!$ 项：\n$$ \\binom{9}{3} = \\frac{9 \\times 8 \\times 7}{3 \\times 2 \\times 1} = \\frac{504}{6} $$\n进行除法运算：\n$$ \\binom{9}{3} = 3 \\times 4 \\times 7 = 12 \\times 7 = 84 $$\n因此，对于一个具有 $d=6$ 个输入和总阶截断阶数 $p=3$ 的 PCE 模型，有 84 个基函数。",
            "answer": "$$\\boxed{84}$$"
        },
        {
            "introduction": "转向高斯过程 (GP) 回归，我们找到了一个从数据构建代理模型的强大工具。然而，标准的 GP 模型通常假设所有观测值具有恒定的噪声方差（同方差性），但在真实的计量学应用中，这一假设常常不成立。在薄膜厚度测量等应用中，测量不确定性本身就可能随厚度而变化。本练习将探讨忽略这种与输入相关的噪声（即异方差性）所带来的后果。您将为异方差 GP 推导出正确的后验预测方程，这是一项至关重要的技能，有助于构建能够准确反映真实实验数据特性的可靠代理模型。",
            "id": "4128838",
            "problem": "在先进半导体制造中，光谱椭偏仪和反射测量法通常用于薄膜厚度的计量。由于在较高光程下灵敏度降低和模型形式不确定性的增加，这些测量系统通常表现出随薄膜厚度增加而增大的方差。考虑将从可控沉积设置到测量的薄膜厚度的潜在映射建模为高斯过程 (GP)，并假设所报告的计量误差方差是输入相关的。设潜在函数为 $f(x)$，其中 $x$ 表示以纳米为单位的沉积结果（薄膜厚度），测量模型为 $y_{i} = f(x_{i}) + \\epsilon_{i}$，其中 $\\epsilon_{i} \\sim \\mathcal{N}(0, g(x_{i}))$ 对所有 $i$ 独立，而 $g(x)$ 是由计量系统提供的与输入相关的噪声方差。$f$ 上的 GP 先验是零均值的，其核函数为平方指数核，\n$$\nk(x, x') = \\sigma_{f}^{2} \\exp\\!\\left(-\\frac{(x - x')^{2}}{2 \\ell^{2}}\\right).\n$$\n给定在 $x_{1} = 50$ 纳米和 $x_{2} = 150$ 纳米处的两个测量值，你需要在 $x_{\\star} = 100$ 纳米处进行预测。超参数为 $\\sigma_{f} = 20$ 和 $\\ell = 60$ 纳米。计量方差模型为\n$$\ng(x) = \\sigma_{0}^{2} + \\beta x^{2},\n$$\n其中 $\\sigma_{0} = 5$ 纳米，$\\beta = 1.0 \\times 10^{-3}$。\n\n任务：\n1. 使用多元正态分布的基本性质和高斯过程 (GP) 的定义，解释为什么当测量方差依赖于 $x$ 时，同方差噪声假设（所有输入的方差恒定）对于薄膜厚度计量是不合适的，并说明这种假设如何错误地加权了不同厚度下数据点的似然贡献。\n2. 从联合高斯结构和条件化法则出发，明确地推导具有输入相关噪声方差 $g(x)$ 的异方差 GP 的后验预测均值和方差，不要使用现成的公式。\n3. 将你的通用结果应用于给定的两点数据集和超参数，写出在 $x_{\\star} = 100$ 纳米处的后验预测方差的精确解析表达式。最终方差以 $\\mathrm{nm}^{2}$ 为单位，并以包含指数函数和给定数值超参数的闭式符号表达式给出。不要进行近似或四舍五入；提供精确的表达式。\n\n注意：高斯过程 (GP) 和多项式混沌展开 (PCE) 都是代理建模方法；PCE 通常假设输入分布已知，且观测值无噪声（或通过显式建模的噪声通道），而由计量驱动的、与输入相关的噪声在使用 GP 代理模型时，则必须进行异方差似然处理。你的推导必须从多元正态法则和 GP 定义开始，而不是从现成的 GP 回归公式开始。你的最终答案必须是如上所述的、在 $x_{\\star}$ 处的预测方差的单个闭式解析表达式。",
            "solution": "该问题是适定的，具有科学依据，并包含了获得唯一解所需的所有信息。该场景是先进统计建模在半导体制造计量中的一个现实应用。所有参数和模型都得到了明确定义。\n\n解决方案按照问题陈述的要求分为三个部分。\n\n### 第 1 部分：同方差噪声假设的不充分性\n\n高斯过程 (GP) 将潜在函数 $f(x)$ 建模为从一个函数分布中的一次抽样。观测模型将测量数据 $y_i$ 与输入 $x_i$ 处的潜在函数值 $f(x_i)$ 联系起来。在本问题中，模型为 $y_i = f(x_i) + \\epsilon_i$，其中噪声项 $\\epsilon_i$ 的分布为 $\\epsilon_i \\sim \\mathcal{N}(0, g(x_i))$。其关键特征是噪声方差 $g(x_i)$ 依赖于输入 $x_i$。这被称为异方差性。\n\n给定相应的潜在函数值 $\\mathbf{f} = \\{f(x_1), \\dots, f(x_N)\\}$，一组观测值 $\\mathbf{y} = \\{y_1, \\dots, y_N\\}$ 的似然由各个概率密度的乘积给出，这是因为噪声项 $\\epsilon_i$ 是独立的：\n$$\np(\\mathbf{y}|\\mathbf{f}) = \\prod_{i=1}^{N} p(y_i|f(x_i)) = \\prod_{i=1}^{N} \\frac{1}{\\sqrt{2\\pi g(x_i)}} \\exp\\left(-\\frac{(y_i - f(x_i))^2}{2 g(x_i)}\\right)\n$$\n对数似然函数在模型拟合过程中通常被最大化（或构成后验概率的一部分），其表达式为：\n$$\n\\ln p(\\mathbf{y}|\\mathbf{f}) = \\sum_{i=1}^{N} \\left( -\\frac{1}{2} \\ln(2\\pi) - \\frac{1}{2}\\ln(g(x_i)) - \\frac{(y_i - f(x_i))^2}{2 g(x_i)} \\right)\n$$\n忽略常数，对数似然中依赖于拟合的部分是 $\\sum_{i=1}^{N} \\left( -\\frac{1}{2}\\ln(g(x_i)) - \\frac{(y_i - f(x_i))^2}{2 g(x_i)} \\right)$。项 $(y_i - f(x_i))^2$ 表示第 $i$ 个数据点的残差平方。它对对数似然的贡献由 $1/(2g(x_i))$ 加权。\n\n同方差噪声假设假定所有输入的噪声方差都是恒定的，即对所有 $i$ 都有 $g(x_i) = \\sigma_n^2$。在这个不正确的假设下，对数似然项变为：\n$$\n\\sum_{i=1}^{N} \\left( -\\frac{1}{2}\\ln(\\sigma_n^2) - \\frac{(y_i - f(x_i))^2}{2 \\sigma_n^2} \\right) \\propto -\\frac{1}{2\\sigma_n^2} \\sum_{i=1}^{N} (y_i - f(x_i))^2\n$$\n在这种同方差情况下，每个残差平方 $(y_i - f(x_i))^2$ 的权重都相等。\n\n当 $g(x)$ 不是常数时，问题就出现了。在给定的半导体计量背景下，方差随薄膜厚度 $x$ 的增加而增加。这意味着在较大厚度 $x_{\\text{high}}$ 处的测量将具有较大的方差 $g(x_{\\text{high}})$，而在较小厚度 $x_{\\text{low}}$ 处的测量将具有较小的方差 $g(x_{\\text{low}})$。\n- 对于在 $x_{\\text{low}}$ 处的精确测量，$g(x_{\\text{low}})$ 很小，因此其似然权重 $1/g(x_{\\text{low}})$ 很大。GP 模型因此会因偏离该数据点而受到重罚，迫使后验分布更接近 $y_{\\text{low}}$。\n- 对于在 $x_{\\text{high}}$ 处的含噪测量，$g(x_{\\text{high}})$ 很大，因此其权重 $1/g(x_{\\text{high}})$ 很小。模型因偏离 $y_{\\text{high}}$ 而受到的惩罚较小，从而正确地承认了其较低的确定性。\n\n同方差假设（可能使用平均方差）会为精确测量和含噪测量分配相同的权重。这错误地加权了它们的贡献：它低估了信息量大的低噪声数据（将其视为比实际噪声更大），并高估了信息量小的高噪声数据（将其视为比实际更精确）。这导致了一个次优且有偏的代理模型，该模型会被高厚度点的噪声“分散注意力”，而无法正确地锚定在低厚度点的高质量数据上。\n\n### 第 2 部分：后验预测分布的推导\n\n我们从 GP 的基本定义开始。在训练点上的潜在函数值集合 $\\mathbf{f} = [f(x_1), f(x_2)]^T$ 和在测试点上的潜在函数值 $f_{\\star} = f(x_{\\star})$ 具有一个联合高斯先验分布。由于 GP 是零均值的，该分布为：\n$$\n\\begin{pmatrix} \\mathbf{f} \\\\ f_{\\star} \\end{pmatrix} \\sim \\mathcal{N}\\left(\n\\mathbf{0},\n\\begin{pmatrix}\nK(\\mathbf{x}, \\mathbf{x}) & K(\\mathbf{x}, x_{\\star}) \\\\\nK(x_{\\star}, \\mathbf{x}) & K(x_{\\star}, x_{\\star})\n\\end{pmatrix}\n\\right)\n$$\n其中 $\\mathbf{x} = [x_1, x_2]^T$。我们使用简写 $K = K(\\mathbf{x}, \\mathbf{x})$，$\\mathbf{k}_{\\star} = K(\\mathbf{x}, x_{\\star})$ 和 $k_{\\star\\star} = K(x_{\\star}, x_{\\star})$。\n\n观测值为 $\\mathbf{y} = \\mathbf{f} + \\mathbf{\\epsilon}$，噪声 $\\mathbf{\\epsilon} \\sim \\mathcal{N}(\\mathbf{0}, \\Sigma_n)$。对于异方差噪声，$\\Sigma_n$ 是一个由输入相关方差组成的对角矩阵：$\\Sigma_n = \\mathrm{diag}(g(x_1), g(x_2))$。\n\n我们需要给定观测值 $\\mathbf{y}$ 的 $f_{\\star}$ 的后验分布，即 $p(f_{\\star}|\\mathbf{y})$。为了求得该分布，我们首先建立可观测量 $\\mathbf{y}$ 和待预测量 $f_{\\star}$ 的联合分布。由于 $\\mathbf{y}$ 和 $f_{\\star}$ 是联合高斯变量的线性组合，它们本身也是联合高斯的。\n$$\n\\begin{pmatrix} \\mathbf{y} \\\\ f_{\\star} \\end{pmatrix} \\sim \\mathcal{N}\\left(\n\\begin{pmatrix} \\mathbb{E}[\\mathbf{y}] \\\\ \\mathbb{E}[f_{\\star}] \\end{pmatrix},\n\\begin{pmatrix}\n\\mathrm{Cov}(\\mathbf{y}, \\mathbf{y}) & \\mathrm{Cov}(\\mathbf{y}, f_{\\star}) \\\\\n\\mathrm{Cov}(f_{\\star}, \\mathbf{y}) & \\mathrm{Cov}(f_{\\star}, f_{\\star})\n\\end{pmatrix}\n\\right)\n$$\n由于零均值 GP 先验和零均值噪声，期望为零。协方差项为：\n- $\\mathrm{Cov}(\\mathbf{y}, \\mathbf{y}) = \\mathrm{Cov}(\\mathbf{f} + \\mathbf{\\epsilon}, \\mathbf{f} + \\mathbf{\\epsilon}) = \\mathrm{Cov}(\\mathbf{f}, \\mathbf{f}) + \\mathrm{Cov}(\\mathbf{\\epsilon}, \\mathbf{\\epsilon}) = K + \\Sigma_n$，因为 $\\mathbf{f}$ 和 $\\mathbf{\\epsilon}$ 是独立的。\n- $\\mathrm{Cov}(\\mathbf{y}, f_{\\star}) = \\mathrm{Cov}(\\mathbf{f} + \\mathbf{\\epsilon}, f_{\\star}) = \\mathrm{Cov}(\\mathbf{f}, f_{\\star}) = \\mathbf{k}_{\\star}$。\n- $\\mathrm{Cov}(f_{\\star}, f_{\\star}) = k_{\\star\\star}$。\n\n因此，联合分布为：\n$$\n\\begin{pmatrix} \\mathbf{y} \\\\ f_{\\star} \\end{pmatrix} \\sim \\mathcal{N}\\left(\n\\mathbf{0},\n\\begin{pmatrix}\nK + \\Sigma_n & \\mathbf{k}_{\\star} \\\\\n\\mathbf{k}_{\\star}^T & k_{\\star\\star}\n\\end{pmatrix}\n\\right)\n$$\n使用多元正态分布条件化的标准公式，如果 $\\begin{pmatrix} \\mathbf{z}_1 \\\\ \\mathbf{z}_2 \\end{pmatrix} \\sim \\mathcal{N}\\left( \\begin{pmatrix} \\mathbf{\\mu}_1 \\\\ \\mathbf{\\mu}_2 \\end{pmatrix}, \\begin{pmatrix} \\Sigma_{11} & \\Sigma_{12} \\\\ \\Sigma_{21} & \\Sigma_{22} \\end{pmatrix} \\right)$，那么条件分布 $p(\\mathbf{z}_2|\\mathbf{z}_1)$ 是高斯分布，其均值为 $\\bar{\\mathbf{\\mu}}_2 = \\mathbf{\\mu}_2 + \\Sigma_{21} \\Sigma_{11}^{-1} (\\mathbf{z}_1 - \\mathbf{\\mu}_1)$，协方差为 $\\bar{\\Sigma}_{22} = \\Sigma_{22} - \\Sigma_{21} \\Sigma_{11}^{-1} \\Sigma_{12}$。\n\n将此应用于我们的情况，其中 $\\mathbf{z}_1 = \\mathbf{y}$ 和 $\\mathbf{z}_2 = f_{\\star}$（并且均值为零），我们得到后验预测分布 $p(f_{\\star}|\\mathbf{y}) = \\mathcal{N}(\\bar{f}_{\\star}, \\mathbb{V}[f_{\\star}])$，其中：\n- 后验预测均值：$\\bar{f}_{\\star} = \\mathbf{k}_{\\star}^T (K + \\Sigma_n)^{-1} \\mathbf{y}$\n- 后验预测方差：$\\mathbb{V}[f_{\\star}] = k_{\\star\\star} - \\mathbf{k}_{\\star}^T (K + \\Sigma_n)^{-1} \\mathbf{k}_{\\star}$\n\n这些是具有异方差噪声的 GP 的通用公式。\n\n### 第 3 部分：后验预测方差的解析表达式\n\n我们现在将方差公式特化到给定的数据上。方差的单位将是 $\\mathrm{nm}^2$。\n**给定数据：**\n- 训练点：$x_1 = 50$, $x_2 = 150$\n- 测试点：$x_{\\star} = 100$\n- 超参数：$\\sigma_f = 20$, $\\ell = 60$\n- 噪声参数：$\\sigma_0 = 5$, $\\beta = 1.0 \\times 10^{-3}$\n\n**1. 计算核矩阵 $K$：**\n核函数为 $k(x, x') = 20^2 \\exp\\left(-\\frac{(x - x')^2}{2 \\cdot 60^2}\\right) = 400 \\exp\\left(-\\frac{(x - x')^2}{7200}\\right)$。\n$K_{11} = k(50, 50) = 400$。\n$K_{22} = k(150, 150) = 400$。\n$K_{12} = K_{21} = k(50, 150) = 400 \\exp\\left(-\\frac{(50-150)^2}{7200}\\right) = 400 \\exp\\left(-\\frac{10000}{7200}\\right) = 400 \\exp\\left(-\\frac{25}{18}\\right)$。\n$$ K = \\begin{pmatrix} 400 & 400 \\exp(-\\frac{25}{18}) \\\\ 400 \\exp(-\\frac{25}{18}) & 400 \\end{pmatrix} $$\n\n**2. 计算噪声协方差矩阵 $\\Sigma_n$：**\n噪声方差为 $g(x) = 5^2 + (1.0 \\times 10^{-3}) x^2 = 25 + 0.001 x^2$。\n$g(x_1) = g(50) = 25 + 0.001(50^2) = 25 + 2.5 = 27.5$。\n$g(x_2) = g(150) = 25 + 0.001(150^2) = 25 + 22.5 = 47.5$。\n$$ \\Sigma_n = \\begin{pmatrix} 27.5 & 0 \\\\ 0 & 47.5 \\end{pmatrix} $$\n\n**3. 计算核向量 $\\mathbf{k}_{\\star}$ 和标量 $k_{\\star\\star}$：**\n$k(x_1, x_{\\star}) = k(50, 100) = 400 \\exp\\left(-\\frac{(50-100)^2}{7200}\\right) = 400 \\exp\\left(-\\frac{2500}{7200}\\right) = 400 \\exp\\left(-\\frac{25}{72}\\right)$。\n$k(x_2, x_{\\star}) = k(150, 100) = 400 \\exp\\left(-\\frac{(150-100)^2}{7200}\\right) = 400 \\exp\\left(-\\frac{2500}{7200}\\right) = 400 \\exp\\left(-\\frac{25}{72}\\right)$。\n$$ \\mathbf{k}_{\\star} = \\begin{pmatrix} 400 \\exp(-\\frac{25}{72}) \\\\ 400 \\exp(-\\frac{25}{72}) \\end{pmatrix} $$\n$k_{\\star\\star} = k(100, 100) = 400$。\n\n**4. 组合并计算方差：**\n我们需要计算 $\\mathbb{V}[f_{\\star}] = k_{\\star\\star} - \\mathbf{k}_{\\star}^T (K + \\Sigma_n)^{-1} \\mathbf{k}_{\\star}$。\n首先，求 $M = K + \\Sigma_n$：\n$$ M = \\begin{pmatrix} 400+27.5 & 400 \\exp(-\\frac{25}{18}) \\\\ 400 \\exp(-\\frac{25}{18}) & 400+47.5 \\end{pmatrix} = \\begin{pmatrix} 427.5 & 400 \\exp(-\\frac{25}{18}) \\\\ 400 \\exp(-\\frac{25}{18}) & 447.5 \\end{pmatrix} $$\n我们来对这个 $2 \\times 2$ 矩阵 $M = \\begin{pmatrix} a & c \\\\ c & b \\end{pmatrix}$ 求逆：$M^{-1} = \\frac{1}{ab-c^2} \\begin{pmatrix} b & -c \\\\ -c & a \\end{pmatrix}$。\n二次型 $\\mathbf{k}_{\\star}^T M^{-1} \\mathbf{k}_{\\star}$，其中 $\\mathbf{k}_{\\star} = [k_s, k_s]^T$，为：\n$$ \\mathbf{k}_{\\star}^T M^{-1} \\mathbf{k}_{\\star} = \\frac{1}{ab-c^2} \\begin{pmatrix} k_s & k_s \\end{pmatrix} \\begin{pmatrix} b & -c \\\\ -c & a \\end{pmatrix} \\begin{pmatrix} k_s \\\\ k_s \\end{pmatrix} = \\frac{k_s^2(a+b-2c)}{ab-c^2} $$\n代入数值：\n- $a = 427.5$\n- $b = 447.5$\n- $c = 400 \\exp(-\\frac{25}{18})$\n- $k_s = 400 \\exp(-\\frac{25}{72})$\n二次项为：\n$$ \\frac{(400 \\exp(-\\frac{25}{72}))^2 (427.5 + 447.5 - 2 \\cdot 400 \\exp(-\\frac{25}{18}))}{(427.5)(447.5) - (400 \\exp(-\\frac{25}{18}))^2} $$\n简化数值部分：\n- $(400 \\exp(-\\frac{25}{72}))^2 = 160000 \\exp(-\\frac{50}{72}) = 160000 \\exp(-\\frac{25}{36})$\n- $427.5 + 447.5 = 875$\n- $(427.5)(447.5) = 191306.25$\n- $(400 \\exp(-\\frac{25}{18}))^2 = 160000 \\exp(-\\frac{50}{18}) = 160000 \\exp(-\\frac{25}{9})$\n二次项变为：\n$$ \\frac{160000 \\exp(-\\frac{25}{36}) (875 - 800 \\exp(-\\frac{25}{18}))}{191306.25 - 160000 \\exp(-\\frac{25}{9})} $$\n最后，后验预测方差为 $\\mathbb{V}[f_{\\star}] = k_{\\star\\star} - (\\text{二次项})$。\n$$ \\mathbb{V}[f_{\\star}] = 400 - \\frac{160000 \\exp(-\\frac{25}{36}) (875 - 800 \\exp(-\\frac{25}{18}))}{191306.25 - 160000 \\exp(-\\frac{25}{9})} $$\n这就是以后验预测方差的精确解析表达式，单位为 $\\mathrm{nm}^2$。",
            "answer": "$$\n\\boxed{400 - \\frac{160000 \\exp(-\\frac{25}{36}) \\left(875 - 800 \\exp(-\\frac{25}{18})\\right)}{191306.25 - 160000 \\exp(-\\frac{25}{9})}}\n$$"
        },
        {
            "introduction": "多项式混沌展开主要有两种使用方式：非侵入式方法，即像对待“黑箱”一样对模拟进行采样；以及侵入式方法，即将不确定性直接嵌入到控制方程中。侵入式方法虽然实现起来更为复杂，但在准确性和提供物理洞察方面可能具有显著优势。本练习通过将伽辽金投影 (Galerkin projection) 应用于一个随机偏微分方程——半导体工艺中常见的掺杂扩散方程——来深入探讨侵入式方法。通过推导 PCE 系数所遵循的确定性耦合方程组，您将亲身体验不确定性量化领域中最强大的技术之一，从而架起从抽象随机模型到具体计算求解器之间的桥梁。",
            "id": "4128810",
            "problem": "考虑半导体晶圆热处理过程中的掺杂剂扩散，其由掺杂剂浓度 $C(\\mathbf{x}, t, \\xi)$ 的偏微分方程建模，\n$$\n\\partial_{t} C(\\mathbf{x}, t, \\xi) \\;=\\; D(\\xi)\\,\\nabla^{2} C(\\mathbf{x}, t, \\xi),\n$$\n其中 $\\mathbf{x} \\in \\Omega \\subset \\mathbb{R}^{d}$ 表示晶圆中的空间位置，$t \\geq 0$ 是时间，$\\xi$ 是一个标量不确定过程参数（例如，不确定的活化能或与过程温度相关的参数），其具有已知的概率密度函数 $\\rho(\\xi)$，支撑集为可测集 $\\mathcal{S} \\subseteq \\mathbb{R}$。假设 $\\Omega$ 是一个有界域，其边界足够正则，以至于标准扩散算子在物理上适当的边界条件下是良定义的。\n\n通过将掺杂剂浓度 $C(\\mathbf{x}, t, \\xi)$ 和扩散系数 $D(\\xi)$ 在与权重 $\\rho(\\xi)$ 相关的正交多项式基 $\\{\\Psi_{k}(\\xi)\\}_{k=0}^{\\infty}$ 中展开，构建此随机偏微分方程的侵入式多项式混沌展开（PCE）离散化，其中正交性由内积定义\n$$\n\\langle f, g \\rangle \\;\\equiv\\; \\int_{\\mathcal{S}} f(\\xi)\\,g(\\xi)\\,\\rho(\\xi)\\,d\\xi, \\quad \\langle \\Psi_{i}, \\Psi_{j} \\rangle \\;=\\; \\delta_{ij}.\n$$\n具体来说，假设 $C(\\mathbf{x}, t, \\xi)$ 在总阶 $P$ 处截断，$D(\\xi)$ 在总阶 $Q$ 处截断，\n$$\nC(\\mathbf{x}, t, \\xi) \\;=\\; \\sum_{k=0}^{P} c_{k}(\\mathbf{x}, t)\\,\\Psi_{k}(\\xi), \n\\qquad \nD(\\xi) \\;=\\; \\sum_{n=0}^{Q} d_{n}\\,\\Psi_{n}(\\xi),\n$$\n其中系数函数 $c_{k}(\\mathbf{x}, t)$ 是关于 $\\mathbf{x}$ 和 $t$ 的确定性函数，标量 $d_{n}$ 是不确定扩散系数的确定性展开系数。\n\n从上述扩散方程出发，使用关于 $\\rho(\\xi)$ 的内积，对每个基元 $\\Psi_{j}(\\xi)$ 进行加权残差投影，并导出控制系数场 $\\{c_{k}(\\mathbf{x}, t)\\}_{k=0}^{P}$ 的耦合确定性系统。用扩散系数展开系数 $\\{d_{n}\\}_{n=0}^{Q}$ 和正交基的三重积 $\\langle \\Psi_{j}\\Psi_{n}\\Psi_{k} \\rangle$ 来表示该耦合。\n\n您的最终答案应该是系数系统中乘以 $\\nabla^{2}\\mathbf{c}(\\mathbf{x}, t)$ 的耦合矩阵元素的单一闭式解析表达式。无需四舍五入。最终答案中不要包含任何单位。",
            "solution": "用户希望在一个随机扩散方程的侵入式多项式混沌展开（PCE）公式中，推导出耦合矩阵的元素。\n\n### 步骤 1：问题验证\n\n**1.1. 提取已知条件**\n\n*   **控制方程：** 掺杂剂浓度 $C(\\mathbf{x}, t, \\xi)$ 的随机偏微分方程 (SPDE) 由 $\\partial_{t} C(\\mathbf{x}, t, \\xi) \\;=\\; D(\\xi)\\,\\nabla^{2} C(\\mathbf{x}, t, \\xi)$ 给出。\n*   **变量与参数：** $\\mathbf{x} \\in \\Omega \\subset \\mathbb{R}^{d}$ 是空间位置，$t \\geq 0$ 是时间，$\\xi$ 是一个标量不确定参数，其概率密度函数为 $\\rho(\\xi)$，支撑集为 $\\mathcal{S} \\subseteq \\mathbb{R}$。\n*   **正交基：** 一个正交多项式基 $\\{\\Psi_{k}(\\xi)\\}_{k=0}^{\\infty}$ 是关于权重函数 $\\rho(\\xi)$ 定义的。\n*   **内积：** 内积定义为 $\\langle f, g \\rangle \\;\\equiv\\; \\int_{\\mathcal{S}} f(\\xi)\\,g(\\xi)\\,\\rho(\\xi)\\,d\\xi$。\n*   **正交性条件：** 基函数满足 $\\langle \\Psi_{i}, \\Psi_{j} \\rangle \\;=\\; \\delta_{ij}$，其中 $\\delta_{ij}$ 是克罗内克δ函数。\n*   **多项式混沌展开：** 浓度 $C(\\mathbf{x}, t, \\xi)$ 和扩散系数 $D(\\xi)$ 在此基上展开，分别截斷至有限阶 $P$ 和 $Q$：\n    $$\n    C(\\mathbf{x}, t, \\xi) \\;=\\; \\sum_{k=0}^{P} c_{k}(\\mathbf{x}, t)\\,\\Psi_{k}(\\xi)\n    $$\n    $$\n    D(\\xi) \\;=\\; \\sum_{n=0}^{Q} d_{n}\\,\\Psi_{n}(\\xi)\n    $$\n*   **系数：** 系数 $c_{k}(\\mathbf{x}, t)$ 是关于空间和时间的确定性函数，而系数 $d_{n}$ 是确定性常数。\n*   **目标：** 通过将 SPDE 对每个基函数 $\\Psi_{j}(\\xi)$ 进行伽辽金投影（加权残差），导出系数 $\\{c_{k}(\\mathbf{x}, t)\\}_{k=0}^{P}$ 的耦合确定性系统。目标是找到由此过程产生的耦合矩阵元素的表达式。\n\n**1.2. 使用提取的已知条件进行验证**\n\n*   **科学依据：** 该问题基于 Fick 第二扩散定律，这是材料科学和物理学中的一个基本原理。使用多项式混沌展开来处理扩散系数中的不确定性是“不确定性量化”（UQ）和计算工程领域的标准、成熟技术。该设置在科学上和数学上都是合理的。\n*   **适定性：** 问题提供了清晰的控制方程、随机量的展开式，以及一个明确的数学步骤（伽辽金投影）可循。目标是推導一个特定的解析表达式，这是一个明确定义的任务。基于所提供的框架，存在唯一解。\n*   **客观性：** 问题陈述精确、正式，没有任何主观或模糊的语言。\n\n所有有效问题的标准都已满足。没有科学缺陷、不一致或模糊之处。\n\n**1.3. 结论与行动**\n\n问题是 **有效的**。现在开始求解过程。\n\n### 步骤 2：求解推导\n\n推导始于将给定的 PCEs for $C(\\mathbf{x}, t, \\xi)$ 和 $D(\\xi)$ 代入控制 SPDE。\n\nSPDE 为：\n$$\n\\partial_{t} C(\\mathbf{x}, t, \\xi) \\;=\\; D(\\xi)\\,\\nabla^{2} C(\\mathbf{x}, t, \\xi)\n$$\n代入展开式得到：\n$$\n\\partial_{t} \\left( \\sum_{k=0}^{P} c_{k}(\\mathbf{x}, t)\\,\\Psi_{k}(\\xi) \\right) \\;=\\; \\left( \\sum_{n=0}^{Q} d_{n}\\,\\Psi_{n}(\\xi) \\right) \\nabla^{2} \\left( \\sum_{k=0}^{P} c_{k}(\\mathbf{x}, t)\\,\\Psi_{k}(\\xi) \\right)\n$$\n微分算子 $\\partial_{t}$ 和 $\\nabla^{2}$ 作用于确定性系数 $c_{k}(\\mathbf{x}, t)$，而不是基函数 $\\Psi_{k}(\\xi)$。应用算子后，我们得到：\n$$\n\\sum_{k=0}^{P} \\left( \\partial_{t} c_{k}(\\mathbf{x}, t) \\right) \\Psi_{k}(\\xi) \\;=\\; \\left( \\sum_{n=0}^{Q} d_{n}\\,\\Psi_{n}(\\xi) \\right) \\left( \\sum_{k=0}^{P} \\left( \\nabla^{2} c_{k}(\\mathbf{x}, t) \\right) \\Psi_{k}(\\xi) \\right)\n$$\n我们展开右侧的乘积：\n$$\n\\sum_{k=0}^{P} \\left( \\partial_{t} c_{k}(\\mathbf{x}, t) \\right) \\Psi_{k}(\\xi) \\;=\\; \\sum_{n=0}^{Q} \\sum_{k=0}^{P} d_{n} \\left(\\nabla^{2} c_{k}(\\mathbf{x}, t)\\right) \\Psi_{n}(\\xi)\\Psi_{k}(\\xi)\n$$\n下一步是进行伽辽金投影。这涉及到将整个方程与每个 $j \\in \\{0, 1, \\dots, P\\}$ 的基函数 $\\Psi_{j}(\\xi)$ 做内积。此过程使近似的残差与近似空间正交。\n$$\n\\left\\langle \\sum_{k=0}^{P} \\left( \\partial_{t} c_{k}(\\mathbf{x}, t) \\right) \\Psi_{k}(\\xi), \\Psi_{j}(\\xi) \\right\\rangle \\;=\\; \\left\\langle \\sum_{n=0}^{Q} \\sum_{k=0}^{P} d_{n} \\left( \\nabla^{2} c_{k}(\\mathbf{x}, t) \\right) \\Psi_{n}(\\xi)\\Psi_{k}(\\xi), \\Psi_{j}(\\xi) \\right\\rangle\n$$\n由于内积的线性性质，我们可以将求和项和确定性系数移到括号外。\n\n对于左侧 (LHS)：\n$$\n\\text{LHS} \\;=\\; \\sum_{k=0}^{P} \\left( \\partial_{t} c_{k}(\\mathbf{x}, t) \\right) \\langle \\Psi_{k}(\\xi), \\Psi_{j}(\\xi) \\rangle\n$$\n利用正交性 $\\langle \\Psi_{k}, \\Psi_{j} \\rangle = \\delta_{kj}$，对 $k$ 的求和坍缩，只留下 $k=j$ 的项：\n$$\n\\text{LHS} \\;=\\; \\partial_{t} c_{j}(\\mathbf{x}, t)\n$$\n对于右侧 (RHS)：\n$$\n\\text{RHS} \\;=\\; \\sum_{n=0}^{Q} \\sum_{k=0}^{P} d_{n} \\left( \\nabla^{2} c_{k}(\\mathbf{x}, t) \\right) \\langle \\Psi_{n}(\\xi)\\Psi_{k}(\\xi), \\Psi_{j}(\\xi) \\rangle\n$$\n内积项 $\\langle \\Psi_{j}(\\xi)\\Psi_{n}(\\xi)\\Psi_{k}(\\xi), 1 \\rangle$ 可以使用问题陈述中提供的符号写为 $\\langle \\Psi_{j}\\Psi_{n}\\Psi_{k} \\rangle$。这些项通常被称为“三重积”或“相互作用”系数。RHS 变为：\n$$\n\\text{RHS} \\;=\\; \\sum_{k=0}^{P} \\left( \\sum_{n=0}^{Q} d_{n} \\langle \\Psi_{j}\\Psi_{n}\\Psi_{k} \\rangle \\right) \\nabla^{2} c_{k}(\\mathbf{x}, t)\n$$\n令 LHS 和 RHS 相等，得到系数 $c_{j}(\\mathbf{x}, t)$ 的耦合确定性 PDE 系统，其中 $j = 0, 1, \\dots, P$：\n$$\n\\partial_{t} c_{j}(\\mathbf{x}, t) \\;=\\; \\sum_{k=0}^{P} \\left( \\sum_{n=0}^{Q} d_{n} \\langle \\Psi_{j}\\Psi_{n}\\Psi_{k} \\rangle \\right) \\nabla^{2} c_{k}(\\mathbf{x}, t)\n$$\n这个系统可以写成矩阵-向量形式。设 $\\mathbf{c}(\\mathbf{x}, t)$ 为系数的列向量 $[c_0(\\mathbf{x}, t), c_1(\\mathbf{x}, t), \\dots, c_P(\\mathbf{x}, t)]^T$。该系统是：\n$$\n\\partial_{t} \\mathbf{c}(\\mathbf{x}, t) \\;=\\; \\mathbf{M} \\nabla^{2} \\mathbf{c}(\\mathbf{x}, t)\n$$\n这里，$\\nabla^{2}\\mathbf{c}(\\mathbf{x},t)$ 被理解为将拉普拉斯算子逐元素应用于向量 $\\mathbf{c}(\\mathbf{x},t)$。矩阵 $\\mathbf{M}$ 是耦合矩阵，一个 $(P+1) \\times (P+1)$ 的矩阵，其元素为常数。问题要求的是该矩阵的元素。通过将矩阵方程第 $j$ 行的一般形式 $\\partial_{t} c_{j} = \\sum_{k=0}^{P} M_{jk} \\nabla^{2} c_{k}$ 与我们推导的方程进行比较，我们可以确定矩阵 $\\mathbf{M}$ 的元素 $M_{jk}$（第 $j$ 行第 $k$ 列的元素）。\n\n元素 $M_{jk}$ 是在 $\\partial_{t} c_{j}(\\mathbf{x}, t)$ 的方程中乘以 $\\nabla^{2} c_{k}(\\mathbf{x}, t)$ 的系数。根据我们的推导，这个系数是：\n$$\nM_{jk} = \\sum_{n=0}^{Q} d_{n} \\langle \\Psi_{j}\\Psi_{n}\\Psi_{k} \\rangle\n$$\n这就是耦合矩阵元素的最终表达式。索引 $j$ 和 $k$ 的范围是从 $0$到 $P$。",
            "answer": "$$\n\\boxed{\\sum_{n=0}^{Q} d_{n} \\langle \\Psi_{j}\\Psi_{n}\\Psi_{k} \\rangle}\n$$"
        }
    ]
}