{
    "hands_on_practices": [
        {
            "introduction": "在半导体制造中，一个常见的任务是根据已知的工艺输入参数（如焦距和剂量）的波动来预测关键输出（如关键尺寸CD）的变异性。这项练习将演示如何使用线性化这一核心技术来近似计算输出方差。这不仅是构建误差预算的基本工具，也为理解工艺敏感性提供了量化基础。",
            "id": "4157337",
            "problem": "在用于半导体制造的光刻技术中，线的关键尺寸（CD）取决于曝光焦距 $F$（单位为离焦量的 $\\mathrm{nm}$）和曝光剂量 $D$（单位为 $\\mathrm{mJ}\\cdot \\mathrm{cm}^{-2}$）。考虑一个单一空间频率的线-空间图形，其CD可以在标称工作点 $(F_0,D_0)$ 附近通过一个可微函数 $C(F,D)$ 来建模，该函数编码了空中像斜率和光刻胶阈值效应。假设标称工作点为 $(F_0,D_0) = (0, 20)$，且CD函数为\n$$\nC(F,D) = C_{\\mathrm{target}} + A \\arctan(\\alpha F) - B \\ln\\!\\left(\\frac{D}{D_0}\\right) + C F \\left(\\frac{D}{D_0} - 1\\right),\n$$\n其中 $C_{\\mathrm{target}} = 28$, $A = 5$, $\\alpha = 0.015$, $B = 12$, 且 $C = 0.03$。在 $C(F,D)$ 中，除了使用 $\\mathrm{mJ}\\cdot \\mathrm{cm}^{-2}$ 为单位的 $D$ 外，所有量的单位均为 $\\mathrm{nm}$；函数 $C(F,D)$ 输出的CD单位为 $\\mathrm{nm}$。最后的交互项捕捉了焦距 $F$ 与归一化剂量偏差 $\\frac{D}{D_0} - 1$ 之间的一阶耦合。\n\n从可微标量场的一阶泰勒展开以及方差和协方差的定义出发，执行以下操作：\n\n1. 在点 $(F_0, D_0)$ 处，推导从偏差 $\\Delta F = F - F_0$ 和 $\\Delta D = D - D_0$ 到CD偏差 $\\Delta \\mathrm{CD} = C(F,D) - C(F_0,D_0)$ 的线性化映射。将结果表示为一个在 $(F_0,D_0)$ 处求值的、具有数值系数的显式仿射函数。\n\n2. 假设 $(\\Delta F, \\Delta D)$ 的联合变异性是零均值的，并由协方差矩阵\n$$\n\\Sigma = \\begin{pmatrix}\n36   -0.9 \\\\\n-0.9  0.25\n\\end{pmatrix},\n$$\n表征，其中第一行和第一列对应 $\\Delta F$（单位为 $\\mathrm{nm}$），第二行和第二列对应 $\\Delta D$（单位为 $\\mathrm{mJ}\\cdot \\mathrm{cm}^{-2}$）。在该线性化映射下，计算CD的方差 $\\mathrm{Var}(\\mathrm{CD})$，单位为 $\\mathrm{nm}^2$。\n\n将 $\\mathrm{Var}(\\mathrm{CD})$ 的最终数值四舍五入到四位有效数字，并以 $\\mathrm{nm}^2$ 表示。",
            "solution": "问题陈述已经过验证，被认为是科学上合理的、适定的和客观的。关于常数 $C$ 的单位，表述上存在轻微的歧义，但对所给的 $C(F,D)$ 方程进行量纲分析可以唯一地确定，为使方程一致，$C$ 必须是一个无量纲量。澄清了这一点后，该问题是可解的。\n\n该问题需要两步分析：首先，推导关键尺寸（CD）偏差的线性化模型；其次，使用该模型根据给定的工艺变异性计算CD的方差。\n\n**第1部分：线性化映射的推导**\n\nCD偏差 $\\Delta \\mathrm{CD} = C(F,D) - C(F_0,D_0)$ 与焦距偏差 $\\Delta F = F - F_0$ 和剂量偏差 $\\Delta D = D - D_0$ 之间的关系，可以通过函数 $C(F,D)$ 在标称工作点 $(F_0,D_0)$ 附近的一阶泰勒展开来近似。\n对于一个可微标量场 $C(F,D)$，该展开式由下式给出：\n$$\n\\Delta \\mathrm{CD} \\approx \\left. \\frac{\\partial C}{\\partial F} \\right|_{(F_0,D_0)} (F - F_0) + \\left. \\frac{\\partial C}{\\partial D} \\right|_{(F_0,D_0)} (D - D_0)\n$$\n这可以更紧凑地写为：\n$$\n\\Delta \\mathrm{CD} \\approx S_F \\Delta F + S_D \\Delta D\n$$\n其中 $S_F$ 和 $S_D$ 分别是CD对焦距和剂量的灵敏度，在标称点处求值。\n\nCD函数由下式给出：\n$$\nC(F,D) = C_{\\mathrm{target}} + A \\arctan(\\alpha F) - B \\ln\\!\\left(\\frac{D}{D_0}\\right) + C F \\left(\\frac{D}{D_0} - 1\\right)\n$$\n首先，我们计算关于焦距 $F$ 的偏导数：\n$$\n\\frac{\\partial C}{\\partial F} = \\frac{\\partial}{\\partial F} \\left[ C_{\\mathrm{target}} + A \\arctan(\\alpha F) - B \\ln\\!\\left(\\frac{D}{D_0}\\right) + C F \\left(\\frac{D}{D_0} - 1\\right) \\right] = A \\frac{\\alpha}{1 + (\\alpha F)^2} + C \\left(\\frac{D}{D_0} - 1\\right)\n$$\n接着，我们计算关于剂量 $D$ 的偏导数：\n$$\n\\frac{\\partial C}{\\partial D} = \\frac{\\partial}{\\partial D} \\left[ C_{\\mathrm{target}} + A \\arctan(\\alpha F) - B \\ln\\!\\left(\\frac{D}{D_0}\\right) + C F \\left(\\frac{D}{D_0} - 1\\right) \\right] = -B \\frac{1}{D/D_0} \\cdot \\frac{1}{D_0} + C F \\frac{1}{D_0} = -\\frac{B}{D} + \\frac{C F}{D_0}\n$$\n现在，我们在标称工作点 $(F_0, D_0) = (0, 20)$ 处计算这些灵敏度。\n$$\nS_F = \\left. \\frac{\\partial C}{\\partial F} \\right|_{(0,20)} = A \\frac{\\alpha}{1 + (\\alpha \\cdot 0)^2} + C \\left(\\frac{20}{20} - 1\\right) = A\\alpha + C(0) = A\\alpha\n$$\n$$\nS_D = \\left. \\frac{\\partial C}{\\partial D} \\right|_{(0,20)} = -\\frac{B}{20} + \\frac{C \\cdot 0}{20} = -\\frac{B}{D_0}\n$$\n代入给定的参数数值：$A = 5$, $\\alpha = 0.015$, $B = 12$, 且 $D_0 = 20$。\n$$\nS_F = 5 \\cdot 0.015 = 0.075\n$$\n$S_F$ 的单位是 $(\\mathrm{nm}) \\cdot (\\mathrm{nm}^{-1})$，是无量纲的。这是自洽的，因为 $S_F = \\Delta \\mathrm{CD}/\\Delta F$，并且两者的单位都是 $\\mathrm{nm}$。\n$$\nS_D = -\\frac{12}{20} = -0.6\n$$\n$S_D$ 的单位是 $\\mathrm{nm} / (\\mathrm{mJ}\\cdot \\mathrm{cm}^{-2})$。\n\n因此，从偏差 $(\\Delta F, \\Delta D)$ 到CD偏差 $\\Delta \\mathrm{CD}$ 的线性化映射为：\n$$\n\\Delta \\mathrm{CD} \\approx 0.075 \\Delta F - 0.6 \\Delta D\n$$\n\n**第2部分：CD方差的计算**\n\n两个相关随机变量的线性组合 $Y = aX_1 + bX_2$ 的方差由以下公式给出：\n$$\n\\mathrm{Var}(Y) = a^2 \\mathrm{Var}(X_1) + b^2 \\mathrm{Var}(X_2) + 2ab \\mathrm{Cov}(X_1, X_2)\n$$\n在我们的例子中，CD偏差 $\\Delta \\mathrm{CD}$ 是随机变量 $\\Delta F$ 和 $\\Delta D$ 的线性函数的近似。因此，我们有：\n$Y = \\Delta \\mathrm{CD}$， $X_1 = \\Delta F$， $X_2 = \\Delta D$，$a = S_F = 0.075$，以及 $b = S_D = -0.6$。\n\n方差和协方差由协方差矩阵 $\\Sigma$ 给出：\n$$\n\\Sigma = \\begin{pmatrix} \\mathrm{Var}(\\Delta F)   \\mathrm{Cov}(\\Delta F, \\Delta D) \\\\ \\mathrm{Cov}(\\Delta D, \\Delta F)  \\mathrm{Var}(\\Delta D) \\end{pmatrix} = \\begin{pmatrix} 36   -0.9 \\\\ -0.9  0.25 \\end{pmatrix}\n$$\n从该矩阵中，我们提取所需的统计矩：\n$\\mathrm{Var}(\\Delta F) = \\sigma_F^2 = 36$ $\\mathrm{nm}^2$\n$\\mathrm{Var}(\\Delta D) = \\sigma_D^2 = 0.25$ $(\\mathrm{mJ}\\cdot \\mathrm{cm}^{-2})^2$\n$\\mathrm{Cov}(\\Delta F, \\Delta D) = -0.9$ $\\mathrm{nm} \\cdot \\mathrm{mJ}\\cdot \\mathrm{cm}^{-2}$\n\n现在我们可以计算CD的方差 $\\mathrm{Var}(\\mathrm{CD})$，它约等于线性化偏差的方差 $\\mathrm{Var}(\\Delta \\mathrm{CD})$。\n$$\n\\mathrm{Var}(\\mathrm{CD}) \\approx \\mathrm{Var}(\\Delta \\mathrm{CD}) = S_F^2 \\mathrm{Var}(\\Delta F) + S_D^2 \\mathrm{Var}(\\Delta D) + 2 S_F S_D \\mathrm{Cov}(\\Delta F, \\Delta D)\n$$\n代入数值：\n$$\n\\mathrm{Var}(\\mathrm{CD}) \\approx (0.075)^2 (36) + (-0.6)^2 (0.25) + 2(0.075)(-0.6)(-0.9)\n$$\n让我们分别计算每一项：\n第一项：\n$$\n(0.075)^2 \\cdot 36 = 0.005625 \\cdot 36 = 0.2025 \\,\\,\\mathrm{nm^2}\n$$\n第二项：\n$$\n(-0.6)^2 \\cdot 0.25 = 0.36 \\cdot 0.25 = 0.09 \\,\\,\\mathrm{nm^2}\n$$\n第三项（协方差项）：\n$$\n2(0.075)(-0.6)(-0.9) = 2(0.075)(0.54) = 0.15 \\cdot 0.54 = 0.081 \\,\\,\\mathrm{nm^2}\n$$\n将各项相加得到总方差：\n$$\n\\mathrm{Var}(\\mathrm{CD}) \\approx 0.2025 + 0.09 + 0.081 = 0.3735 \\,\\,\\mathrm{nm^2}\n$$\n问题要求将结果四舍五入到四位有效数字。计算出的值 $0.3735$ 已经有四位有效数字。\n因此，CD的方差为 $0.3735$ $\\mathrm{nm}^2$。",
            "answer": "$$\n\\boxed{0.3735}\n$$"
        },
        {
            "introduction": "在复杂的多层级制造流程中，确定哪个环节（例如，反应腔、晶圆、芯片）是总变异性的主要来源，是一个关键挑战。本练习将介绍方差分析（ANOVA），它是一个强大的统计框架，用于系统性地分解方差分量，并对不同变异源的显著性进行正式检验。通过这种方法，工程师可以确定工艺改进工作的重点，从而最有效地提高良率。",
            "id": "4157299",
            "problem": "一个大批量半导体制造厂中的光刻模块拥有 $a$ 个相同的工艺腔室。在一次预定批次的生产中，每个腔室处理 $b$ 片名义上相同的晶圆，并且每片晶圆上都记录了 $n$ 个芯片级的关键尺寸 (CD) 测量值。制造工程团队希望在方差分析 (ANOVA) 框架下，确定腔室间的变异相对于晶圆间的变异是否在统计上显著。假设一个平衡嵌套随机效应模型 $y_{jk\\ell} = \\mu + C_{j} + W_{k(j)} + \\varepsilon_{jk\\ell}$，其中 $y_{jk\\ell}$ 是在腔室 $j$ 中处理的晶圆 $k$ 上芯片 $\\ell$ 的CD值，$C_{j}$ 是腔室的随机效应，$W_{k(j)}$ 是嵌套在腔室 $j$ 中的晶圆随机效应，而 $\\varepsilon_{jk\\ell}$ 是晶圆内残差。假设 $C_{j}$、$W_{k(j)}$ 和 $\\varepsilon_{jk\\ell}$ 相互独立，各自均值为零，并服从正态分布。\n\n在一个有 $a=4$ 个腔室、$b=5$ 片晶圆/腔室、以及 $n=12$ 个芯片/晶圆的平衡实验中，从测量数据中计算出以下汇总统计量（CD的单位是纳米，但检验统计量是无量纲的）：\n\n- 总平均值为 $\\bar{y}_{\\cdot\\cdot\\cdot} = 32.50$。\n- 腔室平均值分别为 $\\bar{y}_{1\\cdot\\cdot} = 32.40$，$\\bar{y}_{2\\cdot\\cdot} = 32.65$，$\\bar{y}_{3\\cdot\\cdot} = 32.45$，以及 $\\bar{y}_{4\\cdot\\cdot} = 32.50$。\n- 对于每个腔室 $j \\in \\{1,2,3,4\\}$，晶圆平均值与其对应腔室平均值的离差平方和 $\\sum_{k=1}^{b}\\left(\\bar{y}_{jk\\cdot} - \\bar{y}_{j\\cdot\\cdot}\\right)^{2}$ 分别为：$j=1$ 时为 $0.06$，$j=2$ 时为 $0.05$，$j=3$ 时为 $0.07$，$j=4$ 时为 $0.06$。\n- 基于芯片级变异的晶圆内平方和 $\\sum_{j=1}^{a}\\sum_{k=1}^{b}\\sum_{\\ell=1}^{n}\\left(y_{jk\\ell} - \\bar{y}_{jk\\cdot}\\right)^{2}$ 等于 $8.80$。\n\n使用平衡嵌套随机效应框架和上述模型的标准ANOVA分解，建立用于检验腔室方差分量是否为零的原假设和备择假设。然后，构建一个合适的 $F$ 统计量，用于比较腔室间变异与晶圆间变异，并根据所提供的汇总统计量计算其数值。\n\n将最终报告的 $F$ 统计量四舍五入至四位有效数字。以无量纲数的形式表示最终答案。",
            "solution": "该问题陈述已经过验证，被认为是合理的。这是一个适定的统计问题，基于方差分析（ANOVA）的标准原理，并应用于嵌套随机效应模型，这是一种有科学依据的方法，用于分析分层制造过程中变异的来源。所有必要的数据都已提供，问题没有矛盾或含糊之处。\n\n该问题要求我们检验半导体制造过程中腔室间变异的显著性。这在由下式给出的平衡嵌套随机效应模型框架中进行：\n$$\ny_{jk\\ell} = \\mu + C_{j} + W_{k(j)} + \\varepsilon_{jk\\ell}\n$$\n其中 $y_{jk\\ell}$ 是来自腔室 $j$ 的晶圆 $k$ 上芯片 $\\ell$ 的测量值。$C_{j}$、$W_{k(j)}$ 和 $\\varepsilon_{jk\\ell}$ 是独立的随机效应。\n- $C_j \\sim N(0, \\sigma_C^2)$ 代表腔室 $j$ 的随机效应。\n- $W_{k(j)} \\sim N(0, \\sigma_W^2)$ 代表嵌套在腔室 $j$ 内的晶圆 $k$ 的随机效应。\n- $\\varepsilon_{jk\\ell} \\sim N(0, \\sigma^2)$ 代表腔室 $j$ 中晶圆 $k$ 上芯片 $\\ell$ 的随机误差。\n\n每个因子的水平数如下：\n- 腔室数量, $a = 4$。\n- 每个腔室的晶圆数量, $b = 5$。\n- 每片晶圆的芯片数量, $n = 12$。\n\n目标是确定腔室方差分量 $\\sigma_C^2$ 是否在统计上显著。这转化为检验以下原假设和备择假设：\n- 原假设, $H_0: \\sigma_C^2 = 0$。该假设表明工艺腔室之间没有变异。\n- 备择假设, $H_1: \\sigma_C^2  0$。该假设表明腔室之间存在显著变异。由于方差不能为负，这是一个单侧检验。\n\n为检验这些假设，我们使用方差分析 F 检验。这需要将总平方和分解为与模型中每个变异来源相对应的分量。主要的变异来源是腔室（C）、腔室内晶圆（W(C)）和误差（晶圆内，E）。\n\n首先，我们计算与每个变异来源相关的自由度 (df)：\n- 腔室: $df_C = a - 1 = 4 - 1 = 3$。\n- 腔室内晶圆: $df_{W(C)} = a(b-1) = 4(5-1) = 4(4) = 16$。\n- 误差: $df_E = ab(n-1) = 4 \\times 5 \\times (12-1) = 20 \\times 11 = 220$。\n\n接下来，我们使用所提供的统计量计算每个来源的平方和 (SS)。\n\n腔室平方和 ($SSC$) 衡量腔室平均值 ($\\bar{y}_{j\\cdot\\cdot}$) 与总平均值 ($\\bar{y}_{\\cdot\\cdot\\cdot}$) 之间的变异。\n$$\nSSC = bn \\sum_{j=1}^{a} (\\bar{y}_{j\\cdot\\cdot} - \\bar{y}_{\\cdot\\cdot\\cdot})^2\n$$\n已知条件为 $b=5$，$n=12$，$\\bar{y}_{\\cdot\\cdot\\cdot} = 32.50$，以及腔室平均值 $\\bar{y}_{1\\cdot\\cdot} = 32.40$，$\\bar{y}_{2\\cdot\\cdot} = 32.65$，$\\bar{y}_{3\\cdot\\cdot} = 32.45$，和 $\\bar{y}_{4\\cdot\\cdot} = 32.50$。\n离差平方和为：\n$$\n\\sum_{j=1}^{4} (\\bar{y}_{j\\cdot\\cdot} - \\bar{y}_{\\cdot\\cdot\\cdot})^2 = (32.40 - 32.50)^2 + (32.65 - 32.50)^2 + (32.45 - 32.50)^2 + (32.50 - 32.50)^2\n$$\n$$\n= (-0.10)^2 + (0.15)^2 + (-0.05)^2 + (0)^2 = 0.0100 + 0.0225 + 0.0025 + 0 = 0.0350\n$$\n因此，$SSC$ 为：\n$$\nSSC = (5)(12) \\times 0.0350 = 60 \\times 0.0350 = 2.10\n$$\n\n腔室内晶圆平方和 ($SSW$) 衡量晶圆平均值 ($\\bar{y}_{jk\\cdot}$) 围绕其各自腔室平均值 ($\\bar{y}_{j\\cdot\\cdot}$) 的变异。\n$$\nSSW = n \\sum_{j=1}^{a} \\sum_{k=1}^{b} (\\bar{y}_{jk\\cdot} - \\bar{y}_{j\\cdot\\cdot})^2\n$$\n问题给出了每个腔室的离差平方和 $\\sum_{k=1}^{b}(\\bar{y}_{jk\\cdot} - \\bar{y}_{j\\cdot\\cdot})^{2}$。我们将这些值在所有腔室上求和：\n$$\n\\sum_{j=1}^{4} \\left[ \\sum_{k=1}^{5} (\\bar{y}_{jk\\cdot} - \\bar{y}_{j\\cdot\\cdot})^2 \\right] = 0.06 + 0.05 + 0.07 + 0.06 = 0.24\n$$\n因此，$SSW$ 为：\n$$\nSSW = 12 \\times 0.24 = 2.88\n$$\n误差平方和 ($SSE$) 代表晶圆内（芯片间）的变异，直接给出为 $SSE = 8.80$。\n\n有了 SS 和 df 的值，我们可以计算均方 (MS)，即平均平方和。\n- 腔室均方: $MSC = \\frac{SSC}{df_C} = \\frac{2.10}{3} = 0.70$。\n- 腔室内晶圆均方: $MSW = \\frac{SSW}{df_{W(C)}} = \\frac{2.88}{16} = 0.18$。\n- 误差均方: $MSE = \\frac{SSE}{df_E} = \\frac{8.80}{220} = 0.04$。\n\n为了构建检验 $H_0: \\sigma_C^2 = 0$ 的正确 F 统计量，我们必须检查该模型的期望均方 (EMS)。对于平衡嵌套随机效应模型，期望均方为：\n- $E(MSE) = \\sigma^2$\n- $E(MSW) = \\sigma^2 + n\\sigma_W^2$\n- $E(MSC) = \\sigma^2 + n\\sigma_W^2 + bn\\sigma_C^2$\n\nF 统计量是两个均方的比值，在原假设下，这两个均方的期望值是相同的。我们希望检验 $H_0: \\sigma_C^2 = 0$。如果 $H_0$ 为真，那么 $E(MSC) = \\sigma^2 + n\\sigma_W^2 + bn(0) = \\sigma^2 + n\\sigma_W^2$。这与 $E(MSW)$ 相同。因此，合适的 F 统计量是 $MSC$ 与 $MSW$ 的比值。这直接回应了问题中比较腔室间变异 ($MSC$) 与晶圆间变异 ($MSW$) 的要求。\n$$\nF = \\frac{MSC}{MSW}\n$$\n在 $H_0$ 下，该统计量服从自由度为 $df_C=3$ 和 $df_{W(C)}=16$ 的 F 分布。\n\n代入计算出的数值：\n$$\nF = \\frac{0.70}{0.18} = \\frac{70}{18} = \\frac{35}{9} \\approx 3.8888...\n$$\n\n问题要求将最终值四舍五入到四位有效数字。\n$$\nF \\approx 3.889\n$$\n然后，将此值与在选定的显著性水平下 $F_{3,16}$ 分布的临界值进行比较，以决定是否拒绝原假设。计算出的 F 统计量本身就是所要求的值。",
            "answer": "$$\n\\boxed{3.889}\n$$"
        },
        {
            "introduction": "在实际生产中，不同工艺输出之间的变异往往是相互关联的，形成复杂的协变结构。本练习将展示如何运用协方差矩阵的特征分解——即主成分分析（PCA）的核心——来揭示这些复杂关系。通过将相关的变异分解为几个主导的、具有物理意义的“变异模式”，我们可以获得对工艺行为更深层次的洞察。",
            "id": "4157327",
            "problem": "一个单晶圆计量实验测量了三种版图类别下的刻蚀后关键尺寸偏移：密集线 ($D$)、半密集线 ($S$) 和孤立线 ($I$)。对于每个晶圆，测量向量被建模为 $x = [\\Delta \\mathrm{CD}_{D}, \\Delta \\mathrm{CD}_{S}, \\Delta \\mathrm{CD}_{I}]^{\\top}$。假设以下物理驱动、统计独立的变异源对 $x$ 有加性贡献：\n\n- 一个全局反应腔漂移模式，它会使所有类别发生相似的偏移，由单位特征向量 $u = \\frac{1}{\\sqrt{3}}[1, 1, 1]^{\\top}$ 表示，其源方差为 $\\sigma_{c}^{2}$。\n- 一个微负载图形密度模式，它会使密集线和半密集线向相反方向偏移，而孤立线大致不变，由单位特征向量 $v = \\frac{1}{\\sqrt{2}}[1, -1, 0]^{\\top}$ 表示，其源方差为 $\\sigma_{p}^{2}$。\n- 独立的类别特定噪声（工具测量和局部随机效应），它以各向同性的方式贡献，被建模为白噪声，每个版图类别的方差为 $\\sigma_{i}^{2}$。\n\n在源独立和线性叠加的假设下，$x$ 的协方差为\n$$\n\\Sigma = \\sigma_{c}^{2} \\, u u^{\\top} + \\sigma_{p}^{2} \\, v v^{\\top} + \\sigma_{i}^{2} \\, I_{3},\n$$\n其中 $I_{3}$ 是 $3 \\times 3$ 的单位矩阵。假设对于一个给定的稳定工艺，源方差已被估计为 $\\sigma_{c}^{2} = 4.0$, $\\sigma_{p}^{2} = 1.0$, 和 $\\sigma_{i}^{2} = 0.25$（单位均为关键尺寸的平方）。\n\n从独立源的协方差定义和对称半正定矩阵的谱定理出发，通过确定其特征值和标准正交特征向量，推导 $\\Sigma$ 的特征分解。解释每个特征向量如何对应于工艺中的一个物理变异模式，并论证其关联性。然后，使用你的分解，计算由主导主成分（与最大特征值相关联的那个）解释的总方差的比例，以小数形式表示。仅在从第一性原理推导出特征分解后，才使用主成分分析（PCA; Principal Component Analysis）的线性代数概念。将最终的小数四舍五入到 $4$ 位有效数字。以不带百分号的形式表示最终比例。",
            "solution": "该问题要求对给定的协方差矩阵 $\\Sigma$ 进行特征分解，并计算主导主成分所占总方差的比例。协方差矩阵被定义为由物理驱动的源向量导出的秩一矩阵和一个各向同性噪声项的线性组合。\n\n给定的测量向量为 $x = [\\Delta \\mathrm{CD}_{D}, \\Delta \\mathrm{CD}_{S}, \\Delta \\mathrm{CD}_{I}]^{\\top}$。$x$ 的协方差矩阵由以下模型给出：\n$$\n\\Sigma = \\sigma_{c}^{2} \\, u u^{\\top} + \\sigma_{p}^{2} \\, v v^{\\top} + \\sigma_{i}^{2} \\, I_{3}\n$$\n其中 $I_3$ 是 $3 \\times 3$ 的单位矩阵。给定的源方差为 $\\sigma_{c}^{2} = 4.0$，$\\sigma_{p}^{2} = 1.0$，和 $\\sigma_{i}^{2} = 0.25$。特征向量为：\n$$\nu = \\frac{1}{\\sqrt{3}}\\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}, \\quad v = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ -1 \\\\ 0 \\end{pmatrix}\n$$\n\n第一步是推导 $\\Sigma$ 的特征分解。矩阵 $\\Sigma$ 的一个特征向量 $q$ 及其对应的特征值 $\\lambda$ 满足方程 $\\Sigma q = \\lambda q$。矩阵 $\\Sigma$ 是对称的，因为 $(u u^{\\top})^{\\top} = u u^{\\top}$，$(v v^{\\top})^{\\top} = v v^{\\top}$，且 $I_3^{\\top} = I_3$。因此，它必定有三个实特征值和一组三个相互正交的特征向量。\n\n通过检查 $\\Sigma$ 的结构可以获得一个关键的洞见。它是由矩阵 $u u^{\\top}$ 和 $v v^{\\top}$ 构成的。我们来研究向量 $u$ 和 $v$ 的性质。它们是单位向量：\n$u^{\\top}u = \\frac{1}{3}(1^2 + 1^2 + 1^2) = 1$。\n$v^{\\top}v = \\frac{1}{2}(1^2 + (-1)^2 + 0^2) = 1$。\n\n我们来检查它们是否正交：\n$$\nu^{\\top}v = \\frac{1}{\\sqrt{3}}\\begin{pmatrix} 1   1  1 \\end{pmatrix} \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ -1 \\\\ 0 \\end{pmatrix} = \\frac{1}{\\sqrt{6}}(1 \\cdot 1 + 1 \\cdot (-1) + 1 \\cdot 0) = 0\n$$\n由于 $u$ 和 $v$ 是正交的，这表明它们可能是 $\\Sigma$ 的特征向量。我们来检验这个假设。\n\n考虑 $\\Sigma$ 对向量 $u$ 的作用：\n$$\n\\Sigma u = (\\sigma_{c}^{2} u u^{\\top} + \\sigma_{p}^{2} v v^{\\top} + \\sigma_{i}^{2} I_{3}) u\n$$\n使用矩阵乘法的分配律：\n$$\n\\Sigma u = \\sigma_{c}^{2} u (u^{\\top}u) + \\sigma_{p}^{2} v (v^{\\top}u) + \\sigma_{i}^{2} (I_{3} u)\n$$\n由于 $u^{\\top}u=1$ 且 $v^{\\top}u = (u^{\\top}v)^{\\top}=0$：\n$$\n\\Sigma u = \\sigma_{c}^{2} u (1) + \\sigma_{p}^{2} v (0) + \\sigma_{i}^{2} u = (\\sigma_{c}^{2} + \\sigma_{i}^{2})u\n$$\n这是 $\\Sigma u = \\lambda_1 u$ 的形式。因此，$q_1 = u$ 是 $\\Sigma$ 的一个特征向量，其对应的特征值为 $\\lambda_1 = \\sigma_{c}^{2} + \\sigma_{i}^{2}$。\n\n接下来，考虑 $\\Sigma$ 对向量 $v$ 的作用：\n$$\n\\Sigma v = (\\sigma_{c}^{2} u u^{\\top} + \\sigma_{p}^{2} v v^{\\top} + \\sigma_{i}^{2} I_{3}) v\n$$\n$$\n\\Sigma v = \\sigma_{c}^{2} u (u^{\\top}v) + \\sigma_{p}^{2} v (v^{\\top}v) + \\sigma_{i}^{2} (I_{3} v)\n$$\n由于 $u^{\\top}v=0$ 且 $v^{\\top}v=1$：\n$$\n\\Sigma v = \\sigma_{c}^{2} u (0) + \\sigma_{p}^{2} v (1) + \\sigma_{i}^{2} v = (\\sigma_{p}^{2} + \\sigma_{i}^{2})v\n$$\n这是 $\\Sigma v = \\lambda_2 v$ 的形式。因此，$q_2 = v$ 是 $\\Sigma$ 的一个特征向量，其对应的特征值为 $\\lambda_2 = \\sigma_{p}^{2} + \\sigma_{i}^{2}$。\n\n由于 $\\Sigma$ 是一个 $3 \\times 3$ 的对称矩阵，它有第三个特征向量 $q_3$，该向量必须与 $q_1=u$ 和 $q_2=v$ 都正交。我们可以找到一个与 $u$ 和 $v$ 的分量正交的向量 $w'$，这些分量分别与 $(1,1,1)$ 和 $(1,-1,0)$ 成比例。设 $w' = (w_x, w_y, w_z)$。\n$w' \\cdot (1,1,1) = w_x + w_y + w_z = 0$\n$w' \\cdot (1,-1,0) = w_x - w_y = 0 \\implies w_x = w_y$。\n将第二个方程代入第一个方程，得到 $w_x + w_x + w_z = 0 \\implies w_z = -2w_x$。\n选择 $w_x=1$，我们得到向量 $w' = (1,1,-2)$。为了得到单位特征向量 $q_3$，我们将 $w'$ 标准化：\n$$\nq_3 = \\frac{w'}{||w'||} = \\frac{1}{\\sqrt{1^2+1^2+(-2)^2}}\\begin{pmatrix} 1 \\\\ 1 \\\\ -2 \\end{pmatrix} = \\frac{1}{\\sqrt{6}}\\begin{pmatrix} 1 \\\\ 1 \\\\ -2 \\end{pmatrix}\n$$\n现在，考虑 $\\Sigma$ 对 $q_3$ 的作用：\n$$\n\\Sigma q_3 = (\\sigma_{c}^{2} u u^{\\top} + \\sigma_{p}^{2} v v^{\\top} + \\sigma_{i}^{2} I_{3}) q_3\n$$\n$$\n\\Sigma q_3 = \\sigma_{c}^{2} u (u^{\\top}q_3) + \\sigma_{p}^{2} v (v^{\\top}q_3) + \\sigma_{i}^{2} (I_{3} q_3)\n$$\n根据构造，$q_3$ 与 $u$ 和 $v$ 正交，所以 $u^{\\top}q_3 = 0$ 且 $v^{\\top}q_3 = 0$。\n$$\n\\Sigma q_3 = \\sigma_{c}^{2} u (0) + \\sigma_{p}^{2} v (0) + \\sigma_{i}^{2} q_3 = \\sigma_{i}^{2}q_3\n$$\n因此，$q_3$ 是 $\\Sigma$ 的一个特征向量，其对应的特征值为 $\\lambda_3 = \\sigma_{i}^{2}$。\n\n特征分解得到了以下的标准正交特征向量和特征值：\n- $q_1 = u = \\frac{1}{\\sqrt{3}}[1, 1, 1]^{\\top}$，特征值为 $\\lambda_1 = \\sigma_{c}^{2} + \\sigma_{i}^{2}$。该特征向量代表全局反应腔漂移模式，其中所有CD偏移沿相同方向一起移动。特征值代表沿此方向的总方差，由反应腔源方差和各向同性噪声方差组成。\n- $q_2 = v = \\frac{1}{\\sqrt{2}}[1, -1, 0]^{\\top}$，特征值为 $\\lambda_2 = \\sigma_{p}^{2} + \\sigma_{i}^{2}$。该特征向量代表微负载图形密度模式，其中密集线和半密集线的CD偏移向相反方向移动，而孤立线CD不受影响。沿此方向的方差是微负载源方差和各向同性噪声方差之和。\n- $q_3 = \\frac{1}{\\sqrt{6}}[1, 1, -2]^{\\top}$，特征值为 $\\lambda_3 = \\sigma_{i}^{2}$。该特征向量代表在考虑了两个主要物理模式后的一种残余变异模式。它捕捉了密集/半密集CD的平均值与孤立线CD之间的对比。沿此方向的方差完全由各向同性的类别特定噪声引起。这是对该特征分解的主成分分析（PCA）解释。\n\n现在，我们使用给定的方差计算特征值的数值：$\\sigma_{c}^{2} = 4.0$，$\\sigma_{p}^{2} = 1.0$，和 $\\sigma_{i}^{2} = 0.25$。\n$$\n\\lambda_1 = 4.0 + 0.25 = 4.25\n$$\n$$\n\\lambda_2 = 1.0 + 0.25 = 1.25\n$$\n$$\n\\lambda_3 = 0.25\n$$\n主成分是特征向量 $q_1, q_2, q_3$。主导主成分是与最大特征值相关联的那个。在这里，最大的特征值是 $\\lambda_1 = 4.25$。\n\n该过程的总方差 $V_{total}$ 是协方差矩阵的迹 $\\text{Tr}(\\Sigma)$。迹也等于所有特征值之和。\n$$\nV_{total} = \\lambda_1 + \\lambda_2 + \\lambda_3 = 4.25 + 1.25 + 0.25 = 5.75\n$$\n由主导主成分（与 $\\lambda_1$ 相关联）解释的总方差比例是其特征值与总方差的比值：\n$$\n\\text{Fraction} = \\frac{\\lambda_1}{V_{total}} = \\frac{4.25}{5.75}\n$$\n为了计算小数值，我们可以简化这个分数：\n$$\n\\frac{4.25}{5.75} = \\frac{425}{575} = \\frac{17 \\times 25}{23 \\times 25} = \\frac{17}{23}\n$$\n进行除法运算：\n$$\n\\frac{17}{23} \\approx 0.73913043...\n$$\n四舍五入到 $4$ 位有效数字，我们得到 $0.7391$。",
            "answer": "$$\n\\boxed{0.7391}\n$$"
        }
    ]
}