{
    "hands_on_practices": [
        {
            "introduction": "溅射产额并不会随着离子能量的增加而无限增长。本练习将通过一个简化的、但物理意义明确的核阻止本领模型，来揭示能量传递效率与离子穿透深度之间的权衡关系。通过运用微积分，您将求解出能够使溅射产额最大化的“最佳”能量点，这是工艺优化中的一个关键参数 。",
            "id": "4166767",
            "problem": "一个氩离子（表示为 $\\mathrm{Ar}^{+}$）在半导体制造过程中的反应离子溅射步骤中，垂直入射到晶体硅靶上。假设采用 Sigmund 理论的线性级联框架，其中在离子能量为 $E$ 和入射角为 $\\theta$ 时的溅射产额 $Y(E,\\theta)$ 与核阻止本领对表面结合能的比值成正比，即 $Y(E,\\theta) \\propto S_{n}(E)/U_{s}$。考虑垂直入射情况 $\\theta=0$（角度以度为单位测量）。对于能量窗口 $E \\in [100,5000]$ $\\mathrm{eV}$ 内特定的 $\\mathrm{Ar}^{+}$ on silicon 对，假设核阻止本领可以用一个经验校准的 Padé 型替代模型表示\n$$\nS_{n}(E) = \\frac{S_{0}\\,E}{1+\\beta E^{2}},\n$$\n其中 $S_{0} = 1.50 \\times 10^{-3}\\ \\mathrm{\\AA}^{-1}$ 且 $\\beta = 1.00 \\times 10^{-6}\\ \\mathrm{eV}^{-2}$。取硅的表面结合能为 $U_{s} = 4.70\\ \\mathrm{eV}$。\n\n从 $Y(E,0) \\propto S_{n}(E)/U_{s}$ 这一陈述出发，运用第一性原理推导，通过求解\n$$\n\\frac{\\partial}{\\partial E}\\left[\\frac{S_{n}(E)}{U_{s}}\\right] = 0,\n$$\n来得出使 $Y(E,0)$ 最大化的能量 $E^{*}$ 所满足的条件，然后得到 $E^{*}$ 的一个闭式表达式，并根据给定的常数计算其数值。最后，从增加的碰撞能量转移与更高能量下近表面能量沉积效率降低之间的竞争关系角度，对 $E^{*}$ 进行物理诠释。将你的数值答案四舍五入到 $4$ 位有效数字，并以 $\\mathrm{eV}$ 为单位表示能量。",
            "solution": "首先对问题进行验证，以确保其科学上成立、提法恰当且客观。\n\n### 步骤 1：提取已知条件\n- 离子：氩，$\\mathrm{Ar}^{+}$\n- 靶材：晶体硅\n- 入射：垂直入射，$\\theta=0$\n- 溅射产额正比关系：$Y(E,\\theta) \\propto S_{n}(E)/U_{s}$\n- $\\mathrm{Ar}^{+}$ on Si 的核阻止本领模型：$S_{n}(E) = \\frac{S_{0}\\,E}{1+\\beta E^{2}}$\n- 模型有效性的能量窗口：$E \\in [100, 5000]\\ \\mathrm{eV}$\n- 常数 $S_{0}$：$1.50 \\times 10^{-3}\\ \\mathrm{\\AA}^{-1}$\n- 常数 $\\beta$：$1.00 \\times 10^{-6}\\ \\mathrm{eV}^{-2}$\n- 硅的表面结合能：$U_{s} = 4.70\\ \\mathrm{eV}$\n- 任务：通过求解 $\\frac{\\partial}{\\partial E}\\left[\\frac{S_{n}(E)}{U_{s}}\\right] = 0$ 来找到使 $Y(E,0)$ 最大化的能量 $E^{*}$。提供 $E^{*}$ 的闭式表达式、其四舍五入到 $4$ 位有效数字的数值，并给出物理诠释。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学上成立**：该问题基于离子-固体相互作用的物理学，特别是溅射，这是半导体制造中的一个关键过程。它采用了 Sigmund 线性级联理论的简化形式，$Y \\propto S_n / U_s$，这是分析的标准出发点。核阻止本领 $S_n(E)$ 的 Padé 型近似式捕捉了该量在指定能量范围内的特征行为（初始上升，随后在更高能量下减少）。物理常数（$U_s$, $\\beta$, $S_0$）的数值对于所描述的系统具有现实的量级。该问题在科学上是合理的。\n- **提法恰当**：该问题提法恰当。它指定了一个需要最大化的可微函数，并提供了所有必要的常数。寻找最大值的方法（将导数设为零）已明确说明。预期存在一个唯一且有意义的解。\n- **客观性**：该问题以精确、客观和定量的语言陈述，没有歧义或主观论断。\n\n### 步骤 3：结论与行动\n该问题被判定为**有效**。它自成体系、科学上合理且提法恰当。现在开始求解过程。\n\n### 解答\n目标是找到使垂直入射时溅射产额 $Y(E,0)$ 最大化的离子能量 $E^{*}$。问题陈述了溅射产额与核阻止本领 $S_n(E)$ 对表面结合能 $U_s$ 的比值成正比：\n$$\nY(E,0) \\propto \\frac{S_n(E)}{U_s}\n$$\n假设比例常数与能量 $E$ 无关。由于 $U_s$ 是一个正常数，最大化 $Y(E,0)$ 等价于最大化函数 $S_n(E)$。问题指导我们求解函数 $F(E) = \\frac{S_n(E)}{U_s}$ 的极值。\n代入给定的 $S_n(E)$ 表达式：\n$$\nF(E) = \\frac{1}{U_s} \\left( \\frac{S_{0}\\,E}{1+\\beta E^{2}} \\right)\n$$\n为了找到使该函数最大化的能量 $E^{*}$，我们必须求其关于 $E$ 的导数并将其设为零。\n$$\n\\frac{dF}{dE} = 0\n$$\n常数 $S_0$ 和 $U_s$ 可以在求导过程中被提出来：\n$$\n\\frac{dF}{dE} = \\frac{S_0}{U_s} \\frac{d}{dE} \\left( \\frac{E}{1+\\beta E^{2}} \\right)\n$$\n我们应用商的求导法则，该法则指出，对于 $f(x) = u(x)/v(x)$，有 $f'(x) = [u'(x)v(x) - u(x)v'(x)] / [v(x)]^2$。\n令 $u(E) = E$ 和 $v(E) = 1+\\beta E^2$。它们的导数分别为 $u'(E) = 1$ 和 $v'(E) = 2\\beta E$。\n应用该法则：\n$$\n\\frac{d}{dE} \\left( \\frac{E}{1+\\beta E^{2}} \\right) = \\frac{(1)(1+\\beta E^2) - (E)(2\\beta E)}{(1+\\beta E^2)^2} = \\frac{1+\\beta E^2 - 2\\beta E^2}{(1+\\beta E^2)^2} = \\frac{1 - \\beta E^2}{(1+\\beta E^2)^2}\n$$\n因此，完整的导数是：\n$$\n\\frac{dF}{dE} = \\frac{S_0}{U_s} \\frac{1 - \\beta E^2}{(1+\\beta E^2)^2}\n$$\n将此导数设为零以求极值 $E^*$：\n$$\n\\frac{S_0}{U_s} \\frac{1 - \\beta (E^{*})^2}{(1+\\beta (E^{*})^2)^2} = 0\n$$\n由于 $S_0/U_s$ 是一个非零常数，且对于实数 $E$ 分母始终为正，该条件简化为分子为零：\n$$\n1 - \\beta (E^{*})^2 = 0\n$$\n这个方程就是推导出的使产额最大化的能量 $E^*$ 所满足的条件。求解 $E^{*}$ 得：\n$$\n\\beta (E^{*})^2 = 1 \\implies (E^{*})^2 = \\frac{1}{\\beta}\n$$\n由于能量必须是正值，我们取主平方根。$E^{*}$ 的闭式表达式为：\n$$\nE^{*} = \\frac{1}{\\sqrt{\\beta}}\n$$\n为确认这是一个最大值，我们可以检验一阶导数的符号。对于 $E  E^*$，$E^2  1/\\beta$，因此 $1-\\beta E^2 > 0$，且 $\\frac{dF}{dE} > 0$（函数递增）。对于 $E > E^*$，$E^2 > 1/\\beta$，因此 $1-\\beta E^2  0$，且 $\\frac{dF}{dE}  0$（函数递减）。这证实了 $E^*$ 对应于 $E>0$ 时的局部和全局最大值。\n\n现在，我们使用给定值 $\\beta = 1.00 \\times 10^{-6}\\ \\mathrm{eV}^{-2}$ 来计算 $E^*$ 的数值。\n$$\nE^{*} = \\frac{1}{\\sqrt{1.00 \\times 10^{-6}\\ \\mathrm{eV}^{-2}}} = \\frac{1}{1.00 \\times 10^{-3}\\ \\mathrm{eV}^{-1}} = 1000\\ \\mathrm{eV}\n$$\n该值位于模型有效性的规定能量窗口 $[100, 5000]\\ \\mathrm{eV}$ 之内。\n问题要求答案四舍五入到 $4$ 位有效数字。\n$$\nE^{*} = 1.000 \\times 10^3\\ \\mathrm{eV}\n$$\n\n最后，我们对 $E^{*}$ 给出物理诠释。溅射产额是两种依赖于能量的现象之间竞争的结果：\n1.  **能量转移效率**：在低能量下，增加注入离子的能量 $E$ 会导致在碰撞级联中向靶原子转移更多的动量和能量。这增加了表面原子获得足够能量以克服表面结合能 $U_s$ 的可能性。对于低 $E$（其中 $\\beta E^2 \\ll 1$），阻止本领近似为 $S_n(E) \\approx S_0 E$，因此产额最初随能量增加而增加。\n2.  **能量沉积深度**：随着注入离子能量 $E$ 进一步增加，离子在沉积大部分能量之前会穿透到靶材更深处。碰撞级联在离子射程末端附近达到最大，该位置向块体材料内部移动得更深。溅射是一种表面现象；远离表面沉积的能量对原子的喷出没有贡献。模型中的 $1/(1+\\beta E^2)$ 项解释了这种效应，导致有效近表面能量沉积在高能量时减少。对于高 $E$（其中 $\\beta E^2 \\gg 1$），$S_n(E) \\approx S_0 / (\\beta E)$，产额随能量增加而减少。\n\n最佳能量 $E^{*}$ 代表了这种权衡中的“最佳点”。在 $E = E^{*}$ 时，离子能量足够大，可以产生剧烈的碰撞级联，但又不会过高，以至于级联中心位于表面下太深的位置。这个特定的能量使得在近表面区域沉积的能量最大化，从而在该模型下，对于给定的离子-靶材组合，产生可能的最大溅射产额。",
            "answer": "$$\n\\boxed{1.000 \\times 10^3}\n$$"
        },
        {
            "introduction": "与能量类似，入射角也存在一个实现最大溅射的最佳值。本练习将对两种相互竞争的效应进行建模：倾斜入射时离子在近表面区域的路径长度增加（增强溅射），以及离子反射概率的增加（减弱溅射）。您将推导并求解出最佳入射角，从而深入理解溅射工艺在塑造半导体器件形貌中的作用 。",
            "id": "4166762",
            "problem": "在半导体加工过程中的晶体靶离子溅射中，考虑一束能量为 $E$ 的单能离子束，以相对于表面法线的入射角 $\\theta$ 入射到一个平坦的半无限靶上。溅射产额 $Y(E,\\theta)$ 与原子可以从中逸出的近表面层内沉积的能量成正比。使用基于以下基本要素的建模方法：\n\n1. 线性级联能量沉积（Sigmund 的模型）：沿离子径迹的沉积能量密度随轨迹距离近似呈指数衰减，衰减长度为 $a(E)$，并且溅射产额与沿表面法线测量的厚度为 $\\Delta$ 的逸出层内沉积的能量成正比。\n\n2. 斜入射的几何关系：对于固定的近表面法向厚度 $\\Delta \\ll a(E)$，离子在该层内穿过的路径长度与 $\\Delta/\\mu$ 成比例，其中 $\\mu \\equiv \\cos\\theta$。\n\n3. 克服表面束缚势垒的法向能量控制透射：当法向动能 $E_{\\perp} = E \\mu^{2}$ 减小时，离子有效贡献于近表面能量沉积而不被背向散射的概率会受到抑制。将此抑制建模为与 $\\exp\\!\\big(-U/E_{\\perp}\\big)$ 成正比，其中 $U$ 是一个有效表面束缚能。\n\n从这些要素出发，在 $\\Delta \\ll a(E)$ 的条件下仅保留对 $\\mu$ 的主导依赖关系，推导出一个乘法角度因子 $F(E,\\theta)$，使得 $Y(E,\\theta) \\propto F(E,\\theta)$。该因子仅用 $\\mu$、$E$ 和 $U$ 表示，与一个和 $\\theta$ 无关的总因子相乘。然后，对于固定的 $E$ 且 $E > 2U$，通过求解条件 $\\partial Y/\\partial \\theta = 0$ 并验证该极值为最大值，来确定使 $Y(E,\\theta)$ 最大化的入射角 $\\theta^{\\star}$。将你的最终答案表示为一个关于 $E$ 和 $U$ 的 $\\theta^{\\star}$（以弧度为单位）的闭式解析表达式。除 $E$、$U$ 和角度 $\\theta$ 外，不要引入任何额外的拟合参数。",
            "solution": "问题陈述已经过验证，被认为是具有科学依据、提法恰当且客观的。它提出了一个简化但物理上一致的离子溅射模型，提供了推导唯一解所需的所有必要定义和约束。该模型基于离子-固体相互作用中的既有概念，例如 Sigmund 的线性级联理论和表面势垒效应。因此，该问题是有效的，我们可以进行求解。\n\n溅射产额 $Y(E, \\theta)$ 据陈述与以下因子的乘积成正比：离子对溅射有贡献的概率，以及它在近表面逸出层中沉积的能量。\n\n1.  **逸出层中的沉积能量**\n\n    根据线性级联模型（要素1），沿离子轨迹距离 $s$ 处，单位路径长度上沉积的能量 $\\frac{dE_{dep}}{ds}$ 呈指数衰减：\n    $$ \\frac{dE_{dep}}{ds} = C_0 \\exp\\left(-\\frac{s}{a(E)}\\right) $$\n    其中 $C_0$ 是一个比例常数，$a(E)$ 是能量相关的衰减长度。\n\n    溅射产额与在厚度为 $\\Delta$（沿表面法线测量）的表面层内沉积的总能量成正比。对于以相对于表面法线的角度 $\\theta$ 入射的离子，其在该层内穿过的路径长度 $L$ 由斜入射的几何关系（要素2）给出：\n    $$ L = \\frac{\\Delta}{\\cos\\theta} = \\frac{\\Delta}{\\mu} $$\n    其中 $\\mu \\equiv \\cos\\theta$。\n\n    在该层中沉积的总能量 $E_{dep, \\Delta}$ 通过对能量沉积率从 $s=0$（表面）到 $s=L$ 积分得到：\n    $$ E_{dep, \\Delta} = \\int_{0}^{L} C_0 \\exp\\left(-\\frac{s}{a(E)}\\right) ds = \\int_{0}^{\\Delta/\\mu} C_0 \\exp\\left(-\\frac{s}{a(E)}\\right) ds $$\n    计算该积分可得：\n    $$ E_{dep, \\Delta} = C_0 \\left[-a(E) \\exp\\left(-\\frac{s}{a(E)}\\right)\\right]_{0}^{\\Delta/\\mu} = C_0 a(E) \\left(1 - \\exp\\left(-\\frac{\\Delta}{\\mu a(E)}\\right)\\right) $$\n    问题指定了 $\\Delta \\ll a(E)$ 的条件。这意味着指数的宗量 $\\frac{\\Delta}{\\mu a(E)}$ 很小（对于不接近0的 $\\mu$）。因此，我们可以对小的 $x$ 使用一阶泰勒展开 $\\exp(-x) \\approx 1-x$：\n    $$ E_{dep, \\Delta} \\approx C_0 a(E) \\left(1 - \\left(1 - \\frac{\\Delta}{\\mu a(E)}\\right)\\right) = C_0 a(E) \\left(\\frac{\\Delta}{\\mu a(E)}\\right) = \\frac{C_0 \\Delta}{\\mu} $$\n    因此，在主导阶上，逸出层中沉积的能量与 $\\mu = \\cos\\theta$ 成反比。\n\n2.  **表面透射概率**\n\n    根据要素3，离子对溅射有贡献的概率被一个与 $\\exp(-U/E_{\\perp})$ 成正比的因子所抑制，其中 $U$ 是有效表面束缚能，$E_{\\perp}$ 是法向动能，在问题中定义为 $E_{\\perp} = E \\mu^2$。我们将此概率称为 $P_{trans}$。\n    $$ P_{trans} \\propto \\exp\\left(-\\frac{U}{E_{\\perp}}\\right) = \\exp\\left(-\\frac{U}{E\\mu^2}\\right) $$\n\n3.  **总溅射产额与角度因子**\n\n    总溅射产额 $Y(E, \\theta)$ 与透射概率和在该层中沉积的能量的乘积成正比。\n    $$ Y(E, \\theta) \\propto P_{trans} \\cdot E_{dep, \\Delta} $$\n    代入推导出的比例关系：\n    $$ Y(E, \\theta) \\propto \\exp\\left(-\\frac{U}{E\\mu^2}\\right) \\cdot \\frac{1}{\\mu} $$\n    问题要求一个乘法角度因子 $F(E, \\theta)$，使得 $Y(E, \\theta) \\propto F(E, \\theta)$，其中比例因子与 $\\theta$ 无关。因此，这个因子是：\n    $$ F(E, \\theta) = \\frac{1}{\\mu} \\exp\\left(-\\frac{U}{E\\mu^2}\\right) $$\n\n4.  **溅射产额的最大化**\n\n    为了找到使产额 $Y(E, \\theta)$ 最大化的角度 $\\theta^{\\star}$，我们需要找到 $F(E, \\theta)$ 的最大值。使用变量 $\\mu = \\cos\\theta$ 更为方便。令 $f(\\mu) = \\mu^{-1} \\exp\\left(-\\frac{U}{E\\mu^2}\\right)$。我们寻求在物理范围 $\\mu \\in (0, 1]$ 内使 $f(\\mu)$ 最大化的 $\\mu$ 值。我们通过将 $f(\\mu)$ 对 $\\mu$ 的导数设为零来找到极值。\n    $$ \\frac{df}{d\\mu} = \\frac{d}{d\\mu} \\left[\\mu^{-1} \\exp\\left(-\\frac{U}{E}\\mu^{-2}\\right)\\right] $$\n    使用乘法法则和链式法则：\n    $$ \\frac{df}{d\\mu} = (-\\mu^{-2}) \\exp\\left(-\\frac{U}{E}\\mu^{-2}\\right) + \\mu^{-1} \\left[ \\exp\\left(-\\frac{U}{E}\\mu^{-2}\\right) \\cdot \\left(-\\frac{U}{E}\\right) \\cdot (-2\\mu^{-3}) \\right] $$\n    $$ \\frac{df}{d\\mu} = \\exp\\left(-\\frac{U}{E}\\mu^{-2}\\right) \\left[ -\\mu^{-2} + \\frac{2U}{E}\\mu^{-4} \\right] $$\n    为求极值，我们令 $\\frac{df}{d\\mu} = 0$。由于指数项总是正的，我们必须有：\n    $$ -\\mu^{-2} + \\frac{2U}{E}\\mu^{-4} = 0 $$\n    假设 $\\mu \\neq 0$，我们可以将方程两边乘以 $\\mu^4$：\n    $$ -\\mu^2 + \\frac{2U}{E} = 0 $$\n    这给出了极值点 $\\mu^{\\star}$ 的值：\n    $$ (\\mu^{\\star})^2 = \\frac{2U}{E} \\implies \\mu^{\\star} = \\sqrt{\\frac{2U}{E}} $$\n    问题陈述 $E > 2U$，这确保了 $\\frac{2U}{E}  1$，因此 $\\mu^{\\star}  1$。这保证了对于 $\\theta^{\\star} \\in (0, \\pi/2)$ 存在一个物理上有意义的解。\n\n    为了验证这个极值是最大值，我们分析导数 $\\frac{df}{d\\mu}$ 的符号。其符号由方括号中的项 $g(\\mu) = -\\mu^{-2} + \\frac{2U}{E}\\mu^{-4} = \\mu^{-4}(-\\mu^2 + \\frac{2U}{E})$ 决定。\n    -   对于 $\\mu  \\mu^{\\star}$，我们有 $\\mu^2  (\\mu^{\\star})^2 = \\frac{2U}{E}$。因此，$-\\mu^2 + \\frac{2U}{E} > 0$，并且 $\\frac{df}{d\\mu} > 0$。函数是递增的。\n    -   对于 $\\mu > \\mu^{\\star}$，我们有 $\\mu^2 > (\\mu^{\\star})^2 = \\frac{2U}{E}$。因此，$-\\mu^2 + \\frac{2U}{E}  0$，并且 $\\frac{df}{d\\mu}  0$。函数是递减的。\n    由于导数在 $\\mu^{\\star}$ 处符号由正变负，该点对应一个局部最大值。\n\n    最后，我们找到与 $\\mu^{\\star}$ 对应的角度 $\\theta^{\\star}$：\n    $$ \\cos(\\theta^{\\star}) = \\mu^{\\star} = \\sqrt{\\frac{2U}{E}} $$\n    $$ \\theta^{\\star} = \\arccos\\left(\\sqrt{\\frac{2U}{E}}\\right) $$\n    结果以弧度表示，这是反余弦函数的标准输出单位。",
            "answer": "$$ \\boxed{\\arccos\\left(\\sqrt{\\frac{2U}{E}}\\right)} $$"
        },
        {
            "introduction": "最后一个练习将能量和角度的依赖关系整合到一个用于工艺模拟的综合模型中。本练习引入了一个关键的现实挑战：量化预测溅射速率中的不确定性。您将通过编程实现一个框架，用于传播来自模型物理参数和过程统计特性的不确定性，从而对制造结果进行稳健的评估，这个练习将物理理论与工程实践联系起来 。",
            "id": "4166736",
            "problem": "半导体制造中的一个溅射模型预测了每个入射离子平均喷出的原子数，这被称为溅射产额，记为 $Y(E,\\theta)$，其中 $E$ 是离子动能，$\\theta$ 是从表面法线测量的入射角。蒙特卡洛（MC）模拟通过模拟 $N$ 次独立的离子撞击并计算喷出的总原子数来估计 $Y(E,\\theta)$。MC估计值受到两个来源的不确定性影响：有限采样和模型输入参数的不确定性。您的任务是推导、实施和评估一个基于第一性原理和经过充分检验的事实的不确定性量化与传播框架。\n\n请使用以下基本依据：\n\n- 溅射产额的定义：$Y(E,\\theta)$ 是每个入射离子平均喷出的原子数的期望值。\n- 独立事件计数的有限样本不确定性：根据泊松计数模型，如果在 $N$ 次撞击中喷出的总原子数是一个均值为 $N\\,Y(E,\\theta)$ 的泊松随机变量，那么估计量 $\\hat{Y}=S/N$ 的方差约为 $Y(E,\\theta)/N$。\n- 能量标度和角度调制：溅射需要克服一个有效阈值能量 $E_{\\mathrm{th}}$，平均产额随相对于表面结合能 $U_0$ 的可用能量而变化，其角度依赖性由与 $\\cos(\\theta)$ 相关的几何因子和表面反射效应控制。这些是 Sigmund 溅射理论的标准推论。\n\n基于这些原理，推导一个物理上一致的 $Y(E,\\theta)$ 闭式模型，该模型使用以下参数 $U_0$、$E_{\\mathrm{th}}$、$k$、$f$ 和 $\\alpha$：\n\n- $U_0$（表面结合能，单位：电子伏特），\n- $E_{\\mathrm{th}}$（阈值能量，单位：电子伏特），\n- $k$（无量纲比例因子），\n- $f$（无量纲角度指数），\n- $\\alpha$（无量纲角度衰减系数）。\n\n假设 $U_0$、$E_{\\mathrm{th}}$、$k$、$f$ 和 $\\alpha$ 是服从正态分布的独立随机变量。特别地，使用以下参数均值和标准差：\n\n- $U_0$ 的均值为 $4.7$ 电子伏特，标准差为 $0.3$ 电子伏特，\n- $E_{\\mathrm{th}}$ 的均值为 $25$ 电子伏特，标准差为 $2$ 电子伏特，\n- $k$ 的均值为 $0.08$，标准差为 $0.01$，\n- $f$ 的均值为 $1.6$，标准差为 $0.1$，\n- $\\alpha$ 的均值为 $0.35$，标准差为 $0.05$。\n\n角度必须以弧度为单位。能量必须以电子伏特为单位。对于工艺预测，厚度去除速率 $r$（单位：米/秒）由入射离子通量 $\\Phi$（单位：$1/\\mathrm{m}^2/\\mathrm{s}$）乘以溅射产额，再除以原子数密度 $n_a$（单位：$1/\\mathrm{m}^3$）给出，即 $r=\\Phi\\,Y(E,\\theta)/n_a$。在时间 $t$（单位：秒）内，去除的厚度 $h$ 为 $h=r\\,t$。厚度以纳米表示。您必须量化由于有限采样和输入参数不确定性共同导致的 $Y(E,\\theta)$ 的不确定性，并通过一阶不确定性传播将其传播到厚度 $h$。将 $U_0$、$E_{\\mathrm{th}}$、$k$、$f$ 和 $\\alpha$ 的不确定性视为独立的，并忽略 $E$、$\\theta$、$\\Phi$、$n_a$ 和 $t$ 中的任何不确定性。\n\n您的程序需要完成的步骤：\n\n1.  根据所述基本依据，推导一个 $Y(E,\\theta)$ 的闭式表达式，并确定其关于 $U_0$、$E_{\\mathrm{th}}$、$k$、$f$ 和 $\\alpha$ 的偏导数。\n2.  使用一阶（线性）不确定性传播，将参数不确定性导致的 $Y(E,\\theta)$ 的方差计算为偏导数平方乘以相应参数方差的总和。将此与有限采样方差 $Y(E,\\theta)/N$ 相结合，得到 $Y(E,\\theta)$ 的总方差。\n3.  通过将 $Y(E,\\theta)$ 的总方差传播到 $h=\\Phi\\,Y(E,\\theta)\\,t/n_a$，计算平均去除厚度 $h$（单位：纳米）及其标准差。\n\n您的程序必须实现上述步骤，并为每个测试用例计算以下输出：\n\n- 平均溅射产额 $Y(E,\\theta)$，\n- $Y(E,\\theta)$ 的标准差，\n- 平均去除厚度 $h$（单位：纳米），\n- $h$ 的标准差（单位：纳米）。\n\n角度必须以弧度指定；厚度必须以纳米报告；所有输出必须是浮点数。\n\n测试套件：\n\n为以下测试用例提供结果，每个用例指定为一个元组 $(E,\\theta,N,\\Phi,n_a,t)$：\n\n- 用例 1：$(300,\\,0.3,\\,100000,\\,2\\times 10^{19},\\,5\\times 10^{28},\\,60)$，\n- 用例 2：$(35,\\,0.0,\\,1000000,\\,5\\times 10^{19},\\,6\\times 10^{28},\\,30)$，\n- 用例 3：$(500,\\,1.4,\\,50000,\\,1\\times 10^{19},\\,5\\times 10^{28},\\,120)$，\n- 用例 4：$(300,\\,0.6,\\,100,\\,1\\times 10^{19},\\,5\\times 10^{28},\\,10)$，\n- 用例 5：$(26,\\,0.2,\\,200000,\\,2.5\\times 10^{19},\\,5\\times 10^{28},\\,45)$。\n\n最终输出格式：\n\n您的程序应生成单行输出，包含一个逗号分隔的列表的列表，每个内部列表对应一个测试用例，其中每个内部列表按 $[Y\\_\\mathrm{mean},Y\\_\\mathrm{std},h\\_\\mathrm{mean}\\_\\mathrm{nm},h\\_\\mathrm{std}\\_\\mathrm{nm}]$ 的顺序列出。例如，总体格式必须类似于 $[[a,b,c,d],[e,f,g,h],\\dots]$。",
            "solution": "该问题要求为半导体制造中使用的溅射产额模型开发并实施一个不确定性量化框架。解决方案将分三个阶段进行：首先，根据所提供的原理，推导一个物理上一致的溅射产额 $Y(E,\\theta)$ 模型；其次，使用一阶不确定性传播，推导该产额的总不确定性，同时考虑参数不确定性和有限采样效应；第三，将此总不确定性传播到预测的材料去除厚度 $h$。\n\n**1. 溅射产额模型构建**\n\n问题为溅射产额 $Y(E,\\theta)$ 模型提供了指导原则，其中 $E$ 是离子能量，$\\theta$ 是从表面法线测量的入射角。这些原则是：\n*   必须克服一个阈值能量 $E_{\\mathrm{th}}$。\n*   产额与相对于表面结合能 $U_0$ 的可用能量成比例。\n*   角度依赖性由几何因素决定。\n\n一个广泛使用的半经验模型，它融合了这些物理概念并使用了指定的参数（$k, U_0, E_{\\mathrm{th}}, f, \\alpha$），是 Yamamura 模型的一个变体。我们将正式采用此模型。产额 $Y$ 表示为一个能量依赖项和一个角度依赖项的乘积。\n\n能量依赖性被建模为与可用于溅射的动能 $E - E_{\\mathrm{th}}$ 成正比，与表面结合能 $U_0$ 成反比，并带有一个比例常数 $k$。这仅适用于能量高于阈值的情况，即 $E > E_{\\mathrm{th}}$。\n\n角度依赖性捕捉了两种竞争效应：在适度倾斜的角度下，离子在近表面区域的路径长度增加，从而提高了导致溅射的碰撞级联的概率。这通常用一个 $(\\cos\\theta)^{-f}$ 项来建模。在非常大的角度下，入射离子从表面反射的概率增加，降低了溅射效率。这种衰减通过一个指数项 $\\exp\\left(-\\alpha\\left(\\sec\\theta - 1\\right)\\right)$ 来建模。\n\n结合这些元素，溅射产额的闭式表达式为：\n$$ Y(E, \\theta; P) = \\begin{cases} \\frac{k}{U_0} (E - E_{\\mathrm{th}}) (\\cos\\theta)^{-f} \\exp\\left(-\\alpha\\left(\\frac{1}{\\cos\\theta} - 1\\right)\\right)  \\text{if } E  E_{\\mathrm{th}} \\\\ 0  \\text{if } E \\le E_{\\mathrm{th}} \\end{cases} $$\n这里，$P$ 代表模型参数集合 $\\{U_0, E_{\\mathrm{th}}, k, f, \\alpha\\}$。\n\n根据一阶近似，平均溅射产额，记为 $\\bar{Y}$，通过在该函数中使用参数的平均值进行评估来估计：\n$$ \\bar{Y} = Y(E, \\theta; \\bar{P}) = \\frac{\\mu_k}{\\mu_{U_0}} (E - \\mu_{E_{\\mathrm{th}}}) (\\cos\\theta)^{-\\mu_f} \\exp\\left(-\\mu_\\alpha\\left(\\frac{1}{\\cos\\theta} - 1\\right)\\right) $$\n此计算针对每个测试用例进行，使用提供的参数平均值：$\\mu_{U_0}=4.7$，$\\mu_{E_{\\mathrm{th}}}=25$，$\\mu_k=0.08$，$\\mu_f=1.6$ 和 $\\mu_\\alpha=0.35$。所有测试用例的 $E > \\mu_{E_{\\mathrm{th}}}$，因此产额非零。\n\n**2. 溅射产额的不确定性量化**\n\n溅射产额的总不确定性来自两个独立的来源：模型参数 $P$ 的不确定性（认知不确定性）和有限数量离子撞击 $N$ 的溅射过程固有的统计随机性（偶然不确定性）。总方差是这两个来源的方差之和：\n$$ \\sigma_Y^2 = \\sigma_{Y, \\mathrm{param}}^2 + \\sigma_{Y, \\mathrm{sample}}^2 $$\n\n**2.1. 参数不确定性**\n\n问题指定使用一阶不确定性传播来计算 $\\sigma_{Y, \\mathrm{param}}^2$。对于独立随机变量 $P_i$ 的函数 $Y(P)$，其方差近似为：\n$$ \\sigma_{Y, \\mathrm{param}}^2 \\approx \\sum_i \\left( \\frac{\\partial Y}{\\partial P_i} \\right)^2 \\sigma_{P_i}^2 $$\n其中偏导数在参数的平均值 $\\bar{P}$ 处进行评估。我们必须计算 $Y$ 对 $P$ 中每个参数的偏导数。为方便起见，我们注意到大多数导数可以用 $\\bar{Y}$ 来表示：\n\n*   $\\frac{\\partial Y}{\\partial U_0} = -\\frac{k}{U_0^2}(E - E_{\\mathrm{th}})[\\dots] = -\\frac{Y}{U_0} \\implies \\left.\\frac{\\partial Y}{\\partial U_0}\\right|_{\\bar{P}} = -\\frac{\\bar{Y}}{\\mu_{U_0}}$\n*   $\\frac{\\partial Y}{\\partial E_{\\mathrm{th}}} = -\\frac{k}{U_0}[\\dots] = -\\frac{Y}{E - E_{\\mathrm{th}}} \\implies \\left.\\frac{\\partial Y}{\\partial E_{\\mathrm{th}}}\\right|_{\\bar{P}} = -\\frac{\\bar{Y}}{E - \\mu_{E_{\\mathrm{th}}}}$\n*   $\\frac{\\partial Y}{\\partial k} = \\frac{1}{U_0}(E - E_{\\mathrm{th}})[\\dots] = \\frac{Y}{k} \\implies \\left.\\frac{\\partial Y}{\\partial k}\\right|_{\\bar{P}} = \\frac{\\bar{Y}}{\\mu_k}$\n*   $\\frac{\\partial Y}{\\partial f} = Y \\cdot \\frac{\\partial}{\\partial f}\\left( (\\cos\\theta)^{-f} \\right) = Y \\cdot \\frac{\\partial}{\\partial f}\\left( e^{-f \\ln(\\cos\\theta)} \\right) = -Y \\ln(\\cos\\theta) \\implies \\left.\\frac{\\partial Y}{\\partial f}\\right|_{\\bar{P}} = -\\bar{Y} \\ln(\\cos\\theta)$\n*   $\\frac{\\partial Y}{\\partial \\alpha} = Y \\cdot \\frac{\\partial}{\\partial \\alpha}\\left( e^{-\\alpha(\\sec\\theta - 1)} \\right) = -Y(\\sec\\theta - 1) = Y(1 - \\sec\\theta) \\implies \\left.\\frac{\\partial Y}{\\partial \\alpha}\\right|_{\\bar{P}} = \\bar{Y}\\left(1 - \\frac{1}{\\cos\\theta}\\right)$\n\n将这些代入方差公式：\n$$ \\sigma_{Y, \\mathrm{param}}^2 = \\left(-\\frac{\\bar{Y}}{\\mu_{U_0}}\\right)^2 \\sigma_{U_0}^2 + \\left(-\\frac{\\bar{Y}}{E - \\mu_{E_{\\mathrm{th}}}}\\right)^2 \\sigma_{E_{\\mathrm{th}}}^2 + \\left(\\frac{\\bar{Y}}{\\mu_k}\\right)^2 \\sigma_k^2 + \\left(-\\bar{Y} \\ln(\\cos\\theta)\\right)^2 \\sigma_f^2 + \\left(\\bar{Y}\\left(1 - \\frac{1}{\\cos\\theta}\\right)\\right)^2 \\sigma_\\alpha^2 $$\n$$ \\sigma_{Y, \\mathrm{param}}^2 = \\bar{Y}^2 \\left[ \\left(\\frac{\\sigma_{U_0}}{\\mu_{U_0}}\\right)^2 + \\left(\\frac{\\sigma_{E_{\\mathrm{th}}}}{E - \\mu_{E_{\\mathrm{th}}}}\\right)^2 + \\left(\\frac{\\sigma_k}{\\mu_k}\\right)^2 + (\\ln(\\cos\\theta))^2 \\sigma_f^2 + \\left(1 - \\frac{1}{\\cos\\theta}\\right)^2 \\sigma_\\alpha^2 \\right] $$\n\n**2.2. 有限样本不确定性**\n\n问题指出，对于 $N$ 次离子撞击，溅射出的总原子数遵循均值为 $N\\bar{Y}$ 的泊松分布。因此，估计量 $\\hat{Y} = S/N$ 的方差为：\n$$ \\sigma_{Y, \\mathrm{sample}}^2 = \\frac{\\bar{Y}}{N} $$\n\n**2.3. 总产额不确定性**\n\n总方差 $\\sigma_Y^2$ 是这两个分量的和。产额的标准差则为 $\\sigma_Y = \\sqrt{\\sigma_{Y, \\mathrm{param}}^2 + \\sigma_{Y, \\mathrm{sample}}^2}$。\n\n**3. 向去除厚度的不确定性传播**\n\n去除的厚度 $h$ 由 $h = r \\cdot t$ 给出，其中去除速率为 $r = \\Phi Y(E,\\theta) / n_a$。因此，\n$$ h = \\left(\\frac{\\Phi t}{n_a}\\right) Y(E,\\theta) $$\n变量 $\\Phi$、$t$ 和 $n_a$ 被视为没有不确定性的常数。设 $C_h = \\frac{\\Phi t}{n_a}$ 为工艺常数。$C_h$ 的单位是 $\\mathrm{m}^3$。\n\n平均厚度 $\\bar{h}$ 简单地为：\n$$ \\bar{h} = C_h \\bar{Y} $$\n为了以纳米表示，我们乘以 $10^9$：\n$$ \\bar{h}_{\\mathrm{nm}} = 10^9 C_h \\bar{Y} $$\n\n厚度的方差 $\\sigma_h^2$ 通过传播 $Y$ 的方差得到：\n$$ \\sigma_h^2 = \\left(\\frac{\\partial h}{\\partial Y}\\right)^2 \\sigma_Y^2 = C_h^2 \\sigma_Y^2 $$\n因此，厚度的标准差 $\\sigma_h$ 为：\n$$ \\sigma_h = C_h \\sigma_Y $$\n以纳米为单位，这变为：\n$$ \\sigma_{h, \\mathrm{nm}} = 10^9 C_h \\sigma_Y $$\n\n实现将遵循这些推导出的公式。对于每个测试用例，我们将计算 $\\bar{Y}$、$\\sigma_Y^2$、$\\sigma_Y$、$\\bar{h}_{\\mathrm{nm}}$ 和 $\\sigma_{h, \\mathrm{nm}}$，并报告所需的四个值。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the sputtering yield uncertainty quantification problem.\n\n    The solution implements a framework to calculate the mean and standard deviation\n    of sputtering yield and removed material thickness, considering uncertainties\n    from both model parameters and finite sampling statistics.\n    \"\"\"\n    \n    # Define model parameters with their means and standard deviations.\n    # U0: surface binding energy (eV)\n    # Eth: threshold energy (eV)\n    # k: dimensionless scaling factor\n    # f: dimensionless angular exponent\n    # alpha: dimensionless angular attenuation coefficient\n    params = {\n        'U0':    {'mean': 4.7,  'std': 0.3},\n        'Eth':   {'mean': 25.0, 'std': 2.0},\n        'k':     {'mean': 0.08, 'std': 0.01},\n        'f':     {'mean': 1.6,  'std': 0.1},\n        'alpha': {'mean': 0.35, 'std': 0.05}\n    }\n    \n    # Test cases: (E, theta, N, Phi, n_a, t)\n    # E: ion energy (eV)\n    # theta: incidence angle (radians)\n    # N: number of simulated ion impacts\n    # Phi: ion flux (1/m^2/s)\n    # n_a: atomic number density (1/m^3)\n    # t: time (s)\n    test_cases = [\n        (300.0, 0.3, 100000.0, 2e19, 5e28, 60.0),\n        (35.0, 0.0, 1000000.0, 5e19, 6e28, 30.0),\n        (500.0, 1.4, 50000.0, 1e19, 5e28, 120.0),\n        (300.0, 0.6, 100.0, 1e19, 5e28, 10.0),\n        (26.0, 0.2, 200000.0, 2.5e19, 5e28, 45.0),\n    ]\n\n    results = []\n    \n    # Extract mean parameter values for convenience\n    mu_U0 = params['U0']['mean']\n    mu_Eth = params['Eth']['mean']\n    mu_k = params['k']['mean']\n    mu_f = params['f']['mean']\n    mu_alpha = params['alpha']['mean']\n\n    # Extract parameter standard deviations\n    sigma_U0 = params['U0']['std']\n    sigma_Eth = params['Eth']['std']\n    sigma_k = params['k']['std']\n    sigma_f = params['f']['std']\n    sigma_alpha = params['alpha']['std']\n\n    for case in test_cases:\n        E, theta, N, Phi, n_a, t = case\n\n        # 1. Calculate Mean Sputtering Yield (Y_mean)\n        Y_mean = 0.0\n        if E > mu_Eth:\n            cos_theta = np.cos(theta)\n            # Physical model is valid for theta  pi/2, so cos_theta > 0\n            if cos_theta > 0:\n                sec_theta = 1.0 / cos_theta\n                angular_term = (cos_theta**(-mu_f)) * np.exp(-mu_alpha * (sec_theta - 1.0))\n                energy_term = (mu_k / mu_U0) * (E - mu_Eth)\n                Y_mean = energy_term * angular_term\n\n        # If Y_mean is zero, all other derived quantities are also zero.\n        if Y_mean == 0.0:\n            results.append([0.0, 0.0, 0.0, 0.0])\n            continue\n            \n        # 2. Calculate Variance of Y (sigma_Y_sq)\n        \n        # 2a. Variance from parameter uncertainty\n        cos_theta = np.cos(theta)\n        \n        # Term for U0\n        var_U0_term = (sigma_U0 / mu_U0)**2\n        # Term for Eth\n        var_Eth_term = (sigma_Eth / (E - mu_Eth))**2\n        # Term for k\n        var_k_term = (sigma_k / mu_k)**2\n        \n        # Terms for f and alpha. Handle theta=0 case.\n        if theta == 0.0:\n            var_f_term = 0.0\n            var_alpha_term = 0.0\n        else:\n            ln_cos_theta = np.log(cos_theta)\n            sec_theta = 1.0 / cos_theta\n            var_f_term = (ln_cos_theta**2) * (sigma_f**2)\n            var_alpha_term = ((1.0 - sec_theta)**2) * (sigma_alpha**2)\n            \n        # Sum of relative variances from parameters\n        param_var_sum = var_U0_term + var_Eth_term + var_k_term + var_f_term + var_alpha_term\n        sigma_Y_param_sq = (Y_mean**2) * param_var_sum\n\n        # 2b. Variance from finite sampling\n        sigma_Y_sample_sq = Y_mean / N\n        \n        # 2c. Total variance\n        sigma_Y_sq = sigma_Y_param_sq + sigma_Y_sample_sq\n        Y_std = np.sqrt(sigma_Y_sq)\n\n        # 3. Propagate to Removed Thickness (h)\n        \n        # Constant factor for thickness calculation\n        C_h = (Phi * t) / n_a  # in meters\n        \n        # Mean thickness in nanometers\n        h_mean_nm = C_h * Y_mean * 1e9\n        \n        # Standard deviation of thickness in nanometers\n        h_std_nm = C_h * Y_std * 1e9\n        \n        results.append([Y_mean, Y_std, h_mean_nm, h_std_nm])\n\n    # Final print statement must be in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}