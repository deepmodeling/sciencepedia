{
    "hands_on_practices": [
        {
            "introduction": "A core challenge in multiscale modeling is deciding which physical laws govern each scale. This first practice establishes the fundamental criterion for making this choice in gas-phase transport. You will calculate the Knudsen number, $Kn$, a dimensionless parameter that compares the molecular mean free path to the characteristic size of a geometric feature, to determine when the continuum fluid model breaks down and a more fundamental kinetic description is required . Mastering this concept is the first step toward building physically-sound coupled models, as it dictates the very nature of the boundary conditions that must be transferred from the reactor to the feature scale.",
            "id": "4160567",
            "problem": "A low-pressure etch reactor operated with monatomic argon near a patterned wafer provides reactor-scale state estimates at the mouth of a representative trench feature: static pressure $p=400\\,\\mathrm{Pa}$ and gas temperature $T=550\\,\\mathrm{K}$. The trench has a rectangular cross-section with width $W=200\\,\\mu\\mathrm{m}$ and depth much larger than $W$, so the characteristic feature length may be taken as $L_f=W$. Assume argon can be modeled as a hard-sphere gas with effective molecular diameter $d=3.70\\,\\AA$. Boltzmann’s constant is $k_B=1.380649\\times 10^{-23}\\,\\mathrm{J/K}$. \n\nStarting from fundamental kinetic theory definitions for a dilute hard-sphere gas and the ideal-gas relation, derive an expression for the molecular mean free path $\\lambda$ in terms of $p$, $T$, $d$, and universal constants. Then, using the reactor-scale state as the boundary data to the feature-scale model, compute the Knudsen number for the feature gas, $Kn_f=\\lambda/L_f$. \n\nFinally, using first principles of kinetic theory and continuum model breakdown, justify why, when $Kn_f0.1$, the proper reactor-to-feature boundary condition transfer at the feature mouth must be formulated in terms of kinetic (distribution-function-based) boundary conditions rather than a continuum Neumann condition on species flux. Your justification must be rooted in the governing transport description and the physical meaning of $Kn_f$ as a scale-separation parameter; do not rely on empirical rules of thumb.\n\nReport only the numerical value of $Kn_f$ as your final answer. Round your value of $Kn_f$ to three significant figures. Express your answer as a dimensionless number.",
            "solution": "The problem statement has been critically reviewed and is determined to be valid. It is scientifically grounded in the principles of kinetic theory and rarefied gas dynamics, is well-posed with sufficient and consistent data, and is formulated using objective, precise language. All conditions for a valid problem are met.\n\nThe first task is to derive an expression for the molecular mean free path, $\\lambda$, for a dilute hard-sphere gas. The mean free path is defined as the average distance a molecule travels between successive collisions. For a gas composed of identical hard spheres, this is given by the fundamental relation:\n$$\n\\lambda = \\frac{1}{\\sqrt{2} n \\sigma}\n$$\nwhere $n$ is the molecular number density and $\\sigma$ is the collision cross-section. For a hard-sphere molecule with an effective diameter $d$, the collision cross-section is the area of a circle with radius $d$, representing the effective area one molecule presents to another for a collision to occur.\n$$\n\\sigma = \\pi d^2\n$$\nSubstituting this into the expression for $\\lambda$ yields:\n$$\n\\lambda = \\frac{1}{\\sqrt{2} n \\pi d^2}\n$$\nThe problem requires this expression in terms of pressure $p$ and temperature $T$. The relationship between these macroscopic quantities and the microscopic number density $n$ is given by the ideal-gas law in its statistical mechanics form:\n$$\np = n k_B T\n$$\nwhere $k_B$ is Boltzmann's constant. We can solve this relation for the number density $n$:\n$$\nn = \\frac{p}{k_B T}\n$$\nSubstituting this expression for $n$ into the equation for $\\lambda$ gives the desired relationship:\n$$\n\\lambda = \\frac{1}{\\sqrt{2} \\left(\\frac{p}{k_B T}\\right) \\pi d^2} = \\frac{k_B T}{\\sqrt{2} \\pi d^2 p}\n$$\n\nThe second task is to compute the Knudsen number for the gas within the feature, $Kn_f$. The Knudsen number is a dimensionless parameter defined as the ratio of the mean free path $\\lambda$ to a characteristic length scale of the system, $L_f$.\n$$\nKn_f = \\frac{\\lambda}{L_f}\n$$\nThe problem specifies the characteristic feature length as the trench width, $L_f = W$. Substituting the derived expression for $\\lambda$:\n$$\nKn_f = \\frac{k_B T}{\\sqrt{2} \\pi d^2 p W}\n$$\nWe are given the following values:\nStatic pressure, $p = 400\\,\\mathrm{Pa}$\nGas temperature, $T = 550\\,\\mathrm{K}$\nMolecular diameter, $d = 3.70\\,\\AA = 3.70 \\times 10^{-10}\\,\\mathrm{m}$\nTrench width, $W = 200\\,\\mu\\mathrm{m} = 2.00 \\times 10^{-4}\\,\\mathrm{m}$\nBoltzmann's constant, $k_B = 1.380649 \\times 10^{-23}\\,\\mathrm{J/K}$\n\nSubstituting these values into the expression for $Kn_f$:\n$$\nKn_f = \\frac{(1.380649 \\times 10^{-23}\\,\\mathrm{J/K}) (550\\,\\mathrm{K})}{\\sqrt{2} \\pi (3.70 \\times 10^{-10}\\,\\mathrm{m})^2 (400\\,\\mathrm{Pa}) (2.00 \\times 10^{-4}\\,\\mathrm{m})}\n$$\n$$\nKn_f = \\frac{7.5935695 \\times 10^{-21}}{\\sqrt{2} \\pi (1.369 \\times 10^{-19}) (400) (2.00 \\times 10^{-4})}\n$$\n$$\nKn_f = \\frac{7.5935695 \\times 10^{-21}}{4.872618 \\times 10^{-20}} \\approx 0.15584\n$$\nRounding to three significant figures, the Knudsen number is $Kn_f \\approx 0.156$.\n\nThe final task is to justify, from first principles, why for a Knudsen number $Kn_f  0.1$, kinetic boundary conditions are necessary at the feature mouth instead of continuum-based conditions like a Neumann condition on species flux.\n\nThe Knudsen number, $Kn_f = \\lambda / L_f$, represents the fundamental ratio of the microscopic length scale of molecular transport ($\\lambda$) to the macroscopic length scale of the domain ($L_f$). The validity of different physical models for gas transport is determined by the magnitude of this number.\n\nContinuum models, such as the Navier-Stokes equations for fluid dynamics or Fick's law for mass diffusion, are derived from the more fundamental Boltzmann equation under the assumption that $Kn \\ll 1$. This assumption implies a clear separation of scales: $\\lambda \\ll L_f$. Physically, this means that a gas molecule undergoes many collisions with other molecules over a distance that is small compared to the characteristic length over which macroscopic properties (like pressure, temperature, or concentration) vary. This frequent-collision environment establishes a state of local thermodynamic equilibrium (LTE), where the molecular velocity distribution function within any small volume can be approximated as a Maxwell-Boltzmann distribution, fully described by local macroscopic variables. Constitutive relations like Fick's law ($\\mathbf{J} = -D \\nabla c$) are direct consequences of this LTE assumption, relating a macroscopic flux ($\\mathbf{J}$) to a local gradient ($\\nabla c$). A Neumann boundary condition, which prescribes the value of the normal component of this flux at a boundary, is therefore inherently a continuum concept.\n\nIn this problem, the calculated Knudsen number is $Kn_f \\approx 0.156$. Since $Kn_f  0.1$, the flow is in the transitional regime, where the mean free path $\\lambda$ is no longer negligible compared to the feature size $L_f$. Crucially, the assumption of scale separation and local thermodynamic equilibrium breaks down. A molecule entering the feature may travel a significant fraction of the feature width $W$ before colliding with another molecule. The gas state at any point inside the feature is strongly influenced by the non-local conditions at the boundaries.\n\nTherefore, the justification proceeds as follows:\n1.  **Breakdown of Local Equilibrium:** For $Kn_f \\approx 0.156$, the concept of a macroscopic fluid element in LTE is invalid. The state of the gas cannot be described solely by local macroscopic variables.\n2.  **Failure of Constitutive Relations:** As LTE breaks down, the continuum constitutive relations that are based upon it also fail. Fick's law, which posits that mass flux is a function of the local concentration gradient, is no longer a valid physical description. The flux at a point becomes a complex function of the gas state over a region of size comparable to $\\lambda$.\n3.  **Invalidity of Continuum Boundary Conditions:** A continuum Neumann condition specifies a macroscopic flux, a quantity whose a priori definition via Fick's law is now physically incorrect. Applying such a condition is inconsistent with the underlying physics of the transitional flow regime.\n4.  **Necessity of a Kinetic Description:** The proper physical description of the gas in this regime is the molecular velocity distribution function, $f(\\mathbf{x}, \\mathbf{v}, t)$, governed by the Boltzmann equation (or a suitable numerical analogue like the Direct Simulation Monte Carlo method). This function describes the full state of the gas, not just its macroscopic moments.\n5.  **Requirement for Kinetic Boundary Conditions:** Because the governing physical description is the distribution function $f$, the boundary conditions must also be specified at this level. At the interface between the reactor and the feature (the feature mouth), the boundary condition must prescribe the distribution function for all molecules that are entering the feature domain. For example, one might specify that molecules entering the feature from the reactor side have a Maxwellian distribution corresponding to the reactor-scale pressure $p$ and temperature $T$. This kinetic boundary condition provides the complete information about the incoming molecular velocities, which is essential to correctly model their subsequent flight and collisions within the feature. A single scalar value for flux (Neumann condition) is a gross oversimplification that discards this essential kinetic information.\n\nIn conclusion, when $Kn_f  0.1$, the fundamental physics of gas transport transitions from a local, collision-dominated process to a non-local, boundary-influenced one. This transition invalidates the continuum model and its associated boundary condition types, mandating the use of a kinetic model with boundary conditions specified at the level of the molecular velocity distribution function.",
            "answer": "$$\\boxed{0.156}$$"
        },
        {
            "introduction": "Having established the need for kinetic models in high-Knudsen-number regimes, we now explore how to model the transport itself. This exercise tackles a classic problem: calculating the flux of neutral species onto the sidewalls of a deep trench from a diffuse source, which is characteristic of many deposition processes. By assuming collisionless, ballistic transport, you will use integral methods based on geometric \"view factors\" to derive an analytical expression for the sidewall flux . This practice provides a crucial physical intuition for how feature geometry directly shapes the local processing environment by shadowing or exposing surfaces to the incoming reactor-scale flux.",
            "id": "4160683",
            "problem": "Consider a high-aspect-ratio rectangular trench etched into a semiconductor wafer, modeled as a three-dimensional slit of width $w$ (in meters), depth $d$ (in meters), and effectively infinite length in the $y$-direction. The trench is open at the top plane $z=0$ and has vertical sidewalls located at $x=\\pm w/2$. The reactor-scale environment above the wafer is assumed to be a diffuse, isotropic molecular source obeying Lambert’s cosine law: the angular radiance $L_{\\mathrm{ext}}$ (molecules per square meter per second per steradian) is uniform in direction. The downward molecular flux crossing a flat wafer at the reactor scale is denoted $J_{0}$ (molecules per square meter per second), and is related to the external radiance by the well-tested radiative transfer identity $J_{0}=\\pi L_{\\mathrm{ext}}$. Assume collisionless transport (ballistic trajectories) inside the trench, no re-emission or scattering from internal surfaces, and that the only occluding geometry is the finite top opening of width $w$.\n\nFrom first principles, use the invariance of radiance along straight rays and the cosine projection law to derive an analytic expression for the average sidewall flux $\\overline{J_{s}}$ on one vertical wall (averaged uniformly over $z\\in[0,d]$) normalized by the reactor-scale downward flux $J_{0}$, expressed as a closed-form function of the aspect ratio $AR=d/w$. Specifically, start from the geometric configuration integral for irradiance on a differential receiver area $dA_{j}$ from a differential source area $dA_{i}$ under uniform external radiance $L_{\\mathrm{ext}}$, given by the fundamental exchange relation\n$$\ndJ_{j} = L_{\\mathrm{ext}} \\frac{\\cos\\theta_{i}\\,\\cos\\theta_{j}}{r^{2}}\\,dA_{i},\n$$\nwhere $r$ is the line-of-sight distance between $dA_{i}$ and $dA_{j}$, $\\theta_{i}$ is the angle between the ray and the source normal, and $\\theta_{j}$ is the angle between the ray and the receiver normal. Use this to integrate over the top opening and the trench length to obtain $\\overline{J_{s}}/J_{0}$ as a function of $AR$.\n\nThen, for the specified aspect ratio $AR=d/w=4$ and a Monte Carlo (MC) simulation estimate of the normalized average sidewall flux $(\\overline{J_{s}}/J_{0})_{\\mathrm{MC}}=0.1088$, compute the relative error\n$$\n\\varepsilon = \\frac{\\left|\\left(\\overline{J_{s}}/J_{0}\\right)_{\\mathrm{analytic}} - \\left(\\overline{J_{s}}/J_{0}\\right)_{\\mathrm{MC}}\\right|}{\\left(\\overline{J_{s}}/J_{0}\\right)_{\\mathrm{MC}}}.\n$$\nRound your final value of $\\varepsilon$ to four significant figures. Express the final answer as a decimal number with no units.",
            "solution": "The problem is scientifically sound and well-posed, grounded in the principles of radiative transfer and kinetic theory commonly used in semiconductor process modeling. The derivation proceeds as follows.\n\nWe aim to find the average flux, $\\overline{J_s}$, on a trench sidewall. By symmetry, we consider the wall at $x=w/2$. We establish a coordinate system where the trench is aligned with the $y$-axis, its width is along the $x$-axis (from $-w/2$ to $w/2$), and its depth is along the $z$-axis (from $0$ to $d$).\n\nThe flux $dJ_j$ at a differential receiver area $dA_j$ on the sidewall from a differential source area $dA_i$ at the opening is given by the fundamental exchange relation:\n$$dJ_j = L_{\\mathrm{ext}} \\frac{\\cos\\theta_{i}\\,\\cos\\theta_{j}}{r^{2}}\\,dA_{i}$$\nHere, $r$ is the distance between the source and receiver, and $\\theta_i$ and $\\theta_j$ are the angles between the connecting ray and the respective surface normals. By expressing these quantities in our coordinate system and integrating over the entire infinite strip opening ($x_i \\in [-w/2, w/2], y_i \\in [-\\infty, \\infty]$), we can find the local flux $J_s(z)$ at a depth $z$ on the sidewall.\n\nThe integration is a standard procedure in view factor calculation. First, we integrate over the infinite length of the trench ($y_i$), which simplifies the expression. Then, we integrate across the trench width ($x_i$). This two-step integration yields the local flux at depth $z$:\n$$J_s(z) = \\frac{\\pi L_{\\mathrm{ext}}}{2} \\left( 1 - \\frac{z}{\\sqrt{w^2 + z^2}} \\right)$$\nUsing the provided identity $J_0 = \\pi L_{\\mathrm{ext}}$, the expression becomes:\n$$J_s(z) = \\frac{J_0}{2} \\left( 1 - \\frac{z}{\\sqrt{w^2 + z^2}} \\right)$$\n\nTo find the average flux $\\overline{J_s}$ over the total sidewall depth $d$, we integrate $J_s(z)$ from $z=0$ to $z=d$ and divide by $d$:\n$$\\overline{J_s} = \\frac{1}{d} \\int_{0}^{d} J_s(z) dz = \\frac{J_0}{2d} \\left[ \\int_{0}^{d} dz - \\int_{0}^{d} \\frac{z}{\\sqrt{w^2 + z^2}} dz \\right]$$\nEvaluating the integrals gives:\n$$\\overline{J_s} = \\frac{J_0}{2d} \\left[ d - (\\sqrt{w^2 + d^2} - w) \\right]$$\nThe problem asks for the normalized average flux, $\\overline{J_s}/J_0$, as a function of the aspect ratio $AR = d/w$. Rearranging the expression and substituting $AR$ leads to the final analytical formula:\n$$\\left(\\frac{\\overline{J_{s}}}{J_{0}}\\right)_{\\mathrm{analytic}} = \\frac{1}{2} \\left[ 1 + \\frac{1}{AR} - \\sqrt{1 + \\left(\\frac{1}{AR}\\right)^2} \\right]$$\n\nNow, we use this formula for the specific case where $AR=4$.\n$$\\left(\\frac{\\overline{J_{s}}}{J_{0}}\\right)_{\\mathrm{analytic}} = \\frac{1}{2} \\left[ 1 + \\frac{1}{4} - \\sqrt{1 + \\left(\\frac{1}{4}\\right)^2} \\right] = \\frac{1}{2} \\left[ \\frac{5}{4} - \\frac{\\sqrt{17}}{4} \\right] = \\frac{5 - \\sqrt{17}}{8} \\approx 0.1096118$$\n\nFinally, we compute the relative error $\\varepsilon$ between our analytical result and the given Monte Carlo estimate, $(\\overline{J_{s}}/J_{0})_{\\mathrm{MC}}=0.1088$:\n$$\\varepsilon = \\frac{\\left|\\left(\\overline{J_{s}}/J_{0}\\right)_{\\mathrm{analytic}} - \\left(\\overline{J_{s}}/J_{0}\\right)_{\\mathrm{MC}}\\right|}{\\left(\\overline{J_{s}}/J_{0}\\right)_{\\mathrm{MC}}} = \\frac{|0.1096118 - 0.1088|}{0.1088} = \\frac{0.0008118}{0.1088} \\approx 0.007461397$$\nRounding to four significant figures, the relative error is $0.007461$.",
            "answer": "$$\n\\boxed{0.007461}\n$$"
        },
        {
            "introduction": "The final step in coupling reactor and feature scales is the numerical implementation, which must be both accurate and physically consistent. In practice, the computational meshes for the reactor and feature domains are non-matching, creating a challenge for transferring information while respecting conservation laws. This practice introduces the mortar method, a powerful domain decomposition technique that guarantees the conservation of flux across a non-conforming interface . By deriving a conservative projection operator from a weak form of the continuity equation, you will learn how to build a numerically robust and physically rigorous link between different simulation scales.",
            "id": "4160562",
            "problem": "A low-pressure chemical vapor deposition reactor is modeled at the reactor scale with the Finite Volume Method (FVM) and at the feature scale with a deterministic ray-tracing solver. The reactor and the feature subdomains are coupled across the common interface $\\Gamma$ by transferring a normal particle flux as a boundary condition to the feature solver. The reactor-side computes a face-averaged normal flux field $J_{r}(\\boldsymbol{x})$ on $\\Gamma$ that is piecewise constant per reactor face. The feature-side requires a piecewise constant boundary flux $J_{f}(\\boldsymbol{x})$ per feature element on $\\Gamma$ to drive transport within features. Assume isothermal, steady-state conditions and negligible surface reactions on $\\Gamma$. The goal is to formulate a domain decomposition coupling that enforces conservation of the transferred flux across $\\Gamma$ using a mortar method and to derive a conservative projection of reactor-side fluxes onto the feature-side flux space.\n\nStarting from first principles of conservation, enforce the weak continuity of normal flux across $\\Gamma$ between $J_{r}$ and $J_{f}$ using a suitable choice of test functions defined on the feature-side partition of $\\Gamma$. Show that this yields a discrete linear map from reactor-face flux unknowns to feature-element flux unknowns that conserves the total flux as an exact identity. Specialize your derivation to the case where both $J_{r}$ and $J_{f}$ are represented as piecewise constants on their respective partitions of $\\Gamma$.\n\nThen, consider the specific coupling geometry and data:\n- The interface $\\Gamma$ is a one-dimensional segment of normalized length $L=1$ (dimensionless units) with coordinate $s \\in [0,1]$.\n- The reactor-side partition of $\\Gamma$ consists of three faces: $\\Gamma_{r,1}=[0,0.4]$, $\\Gamma_{r,2}=[0.4,0.85]$, and $\\Gamma_{r,3}=[0.85,1]$. The reactor-side flux is piecewise constant with values $J_{r}(s)=q_{i}$ on $\\Gamma_{r,i}$, with $q_{1}=2$, $q_{2}=5$, and $q_{3}=3$ (dimensionless normalized flux).\n- The feature-side partition of $\\Gamma$ consists of two elements: $\\Gamma_{f,1}=[0,0.5]$ and $\\Gamma_{f,2}=[0.5,1]$. The feature-side flux is piecewise constant with unknown values $J_{f}(s)=g_{j}$ on $\\Gamma_{f,j}$ (dimensionless normalized flux).\n\nUsing your mortar-based conservative projection derived above, compute the two feature-side flux values $g_{1}$ and $g_{2}$ in exact form. Provide your final answer as a single row vector containing $g_{1}$ and $g_{2}$, expressed in exact fractional form without units. No rounding is required; give exact values.",
            "solution": "The problem statement is a well-posed and scientifically grounded exercise in multiscale numerical methods, specifically concerning the coupling of solutions on non-conforming computational grids, a common challenge in semiconductor process modeling. It is self-contained, consistent, and free of any factual or logical flaws. Therefore, the problem is deemed valid and a full solution will be provided.\n\nThe fundamental principle for coupling the reactor-scale flux, $J_{r}(\\boldsymbol{x})$, and the feature-scale flux, $J_{f}(\\boldsymbol{x})$, across the interface $\\Gamma$ is the conservation of the transferred species. Since the function spaces for $J_{r}$ and $J_{f}$ are defined on different partitions of $\\Gamma$ (a non-conforming mesh interface), pointwise equality cannot be enforced. Instead, we enforce continuity in a weak, or integral, sense. This is the basis of the mortar method.\n\nWe require that the integral of the net flux across the interface, weighted by a suitable set of test functions $\\psi(\\boldsymbol{x})$, is zero. The problem specifies that the test functions are to be defined on the feature-side partition of $\\Gamma$. Let $V_{f}$ be the space of piecewise constant functions on the feature-side grid $\\{\\Gamma_{f,j}\\}$. We choose our test space to be $V_{f}$. The weak continuity condition is then stated as:\n$$ \\int_{\\Gamma} (J_{r}(\\boldsymbol{x}) - J_{f}(\\boldsymbol{x})) \\psi(\\boldsymbol{x}) \\, d\\Gamma = 0, \\quad \\forall \\psi \\in V_{f} $$\nIt is sufficient to enforce this condition for a basis of $V_{f}$. A natural basis for this space is the set of characteristic functions $\\{\\psi_{j}\\}$, where $\\psi_{j}(\\boldsymbol{x}) = 1$ if $\\boldsymbol{x} \\in \\Gamma_{f,j}$ and $\\psi_{j}(\\boldsymbol{x}) = 0$ otherwise. Substituting each basis function $\\psi_{j}$ into the weak form gives a necessary condition for each feature element $\\Gamma_{f,j}$:\n$$ \\int_{\\Gamma} (J_{r}(\\boldsymbol{x}) - J_{f}(\\boldsymbol{x})) \\psi_{j}(\\boldsymbol{x}) \\, d\\Gamma = 0 $$\n$$ \\int_{\\Gamma_{f,j}} (J_{r}(\\boldsymbol{x}) - J_{f}(\\boldsymbol{x})) \\, d\\Gamma = 0 $$\nThis rearranges to the core conservation statement for the sub-domain $\\Gamma_{f,j}$:\n$$ \\int_{\\Gamma_{f,j}} J_{f}(\\boldsymbol{x}) \\, d\\Gamma = \\int_{\\Gamma_{f,j}} J_{r}(\\boldsymbol{x}) \\, d\\Gamma $$\nThis equation enforces that the total flux projected onto a feature element $\\Gamma_{f,j}$ is identical to the total flux incoming from the reactor side over that same geometric region.\n\nThe fluxes $J_{r}$ and $J_{f}$ are given as piecewise constant functions on their respective partitions. We can write them as linear combinations of their basis functions:\n$$ J_{r}(\\boldsymbol{x}) = \\sum_{i} q_{i} \\chi_{i}(\\boldsymbol{x}) \\quad \\text{and} \\quad J_{f}(\\boldsymbol{x}) = \\sum_{j} g_{j} \\psi_{j}(\\boldsymbol{x}) $$\nwhere $q_{i}$ and $g_{j}$ are the constant flux values, and $\\chi_{i}$ and $\\psi_{j}$ are the characteristic functions for the reactor faces $\\Gamma_{r,i}$ and feature elements $\\Gamma_{f,j}$, respectively.\n\nLet's substitute these representations into the conservation equation. For the left-hand side (LHS):\n$$ \\text{LHS} = \\int_{\\Gamma_{f,j}} J_{f}(\\boldsymbol{x}) \\, d\\Gamma = \\int_{\\Gamma_{f,j}} \\left(\\sum_{k} g_{k} \\psi_{k}(\\boldsymbol{x})\\right) \\, d\\Gamma $$\nDue to the orthogonality of the basis functions over the integral, only the term where $k=j$ is non-zero:\n$$ \\text{LHS} = g_{j} \\int_{\\Gamma_{f,j}} \\psi_{j}(\\boldsymbol{x}) \\, d\\Gamma = g_{j} \\cdot \\text{Area}(\\Gamma_{f,j}) $$\nFor the right-hand side (RHS):\n$$ \\text{RHS} = \\int_{\\Gamma_{f,j}} J_{r}(\\boldsymbol{x}) \\, d\\Gamma = \\int_{\\Gamma_{f,j}} \\left(\\sum_{i} q_{i} \\chi_{i}(\\boldsymbol{x})\\right) \\, d\\Gamma = \\sum_{i} q_{i} \\int_{\\Gamma_{f,j}} \\chi_{i}(\\boldsymbol{x}) \\, d\\Gamma $$\nThe integral $\\int_{\\Gamma_{f,j}} \\chi_{i}(\\boldsymbol{x}) \\, d\\Gamma$ is the measure of the intersection of the two domains, $\\text{Area}(\\Gamma_{f,j} \\cap \\Gamma_{r,i})$.\nEquating the LHS and RHS gives:\n$$ g_{j} \\cdot \\text{Area}(\\Gamma_{f,j}) = \\sum_{i} q_{i} \\cdot \\text{Area}(\\Gamma_{f,j} \\cap \\Gamma_{r,i}) $$\nSolving for the unknown feature-side flux value $g_{j}$ yields the conservative projection formula:\n$$ g_{j} = \\frac{\\sum_{i} q_{i} \\cdot \\text{Area}(\\Gamma_{f,j} \\cap \\Gamma_{r,i})}{\\text{Area}(\\Gamma_{f,j})} $$\nThis is a discrete linear map from the vector of reactor fluxes $\\boldsymbol{q} = (q_i)$ to the vector of feature fluxes $\\boldsymbol{g} = (g_j)$.\n\nTo show that this projection conserves total flux as an exact identity, we compare the total flux from the reactor side, $F_r$, with the total flux on the feature side, $F_f$.\n$$ F_{r} = \\int_{\\Gamma} J_{r} \\, d\\Gamma = \\sum_{i} q_{i} \\cdot \\text{Area}(\\Gamma_{r,i}) $$\n$$ F_{f} = \\int_{\\Gamma} J_{f} \\, d\\Gamma = \\sum_{j} g_{j} \\cdot \\text{Area}(\\Gamma_{f,j}) $$\nSubstituting our expression for $g_{j} \\cdot \\text{Area}(\\Gamma_{f,j})$ into the equation for $F_f$:\n$$ F_{f} = \\sum_{j} \\left( \\sum_{i} q_{i} \\cdot \\text{Area}(\\Gamma_{f,j} \\cap \\Gamma_{r,i}) \\right) $$\nBy changing the order of summation:\n$$ F_{f} = \\sum_{i} q_{i} \\left( \\sum_{j} \\text{Area}(\\Gamma_{f,j} \\cap \\Gamma_{r,i}) \\right) $$\nThe term in the parenthesis is the sum of the areas of the intersections of a single reactor face $\\Gamma_{r,i}$ with all the feature elements $\\{\\Gamma_{f,j}\\}$. Since $\\{\\Gamma_{f,j}\\}$ form a partition of the entire interface $\\Gamma$, this sum is simply the area of the reactor face $\\Gamma_{r,i}$ itself: $\\sum_{j} \\text{Area}(\\Gamma_{f,j} \\cap \\Gamma_{r,i}) = \\text{Area}(\\Gamma_{r,i})$.\nThus, we have:\n$$ F_{f} = \\sum_{i} q_{i} \\cdot \\text{Area}(\\Gamma_{r,i}) = F_{r} $$\nThis confirms that the projection is globally conservative as an exact identity.\n\nNow, we apply this formal derivation to the specific problem. The interface $\\Gamma$ is a $1$D segment, so 'Area' becomes 'Length', denoted $L(\\cdot)$.\nThe givens are:\n- Reactor-side partition: $\\Gamma_{r,1}=[0,0.4]$, $\\Gamma_{r,2}=[0.4,0.85]$, $\\Gamma_{r,3}=[0.85,1]$.\n- Reactor-side fluxes: $q_{1}=2$ on $\\Gamma_{r,1}$, $q_{2}=5$ on $\\Gamma_{r,2}$, $q_{3}=3$ on $\\Gamma_{r,3}$.\n- Feature-side partition: $\\Gamma_{f,1}=[0,0.5]$, $\\Gamma_{f,2}=[0.5,1]$.\n- Feature-side fluxes: $g_{1}$ on $\\Gamma_{f,1}$, $g_{2}$ on $\\Gamma_{f,2}$.\n\nThe lengths of the feature elements are:\n$L(\\Gamma_{f,1}) = 0.5 - 0 = 0.5$\n$L(\\Gamma_{f,2}) = 1.0 - 0.5 = 0.5$\n\nWe calculate $g_{1}$ for the element $\\Gamma_{f,1} = [0, 0.5]$ using the derived formula:\n$$ g_{1} = \\frac{q_{1}L(\\Gamma_{f,1} \\cap \\Gamma_{r,1}) + q_{2}L(\\Gamma_{f,1} \\cap \\Gamma_{r,2}) + q_{3}L(\\Gamma_{f,1} \\cap \\Gamma_{r,3})}{L(\\Gamma_{f,1})} $$\nThe intersection lengths are:\n- $L(\\Gamma_{f,1} \\cap \\Gamma_{r,1}) = L([0, 0.5] \\cap [0, 0.4]) = L([0, 0.4]) = 0.4$\n- $L(\\Gamma_{f,1} \\cap \\Gamma_{r,2}) = L([0, 0.5] \\cap [0.4, 0.85]) = L([0.4, 0.5]) = 0.1$\n- $L(\\Gamma_{f,1} \\cap \\Gamma_{r,3}) = L([0, 0.5] \\cap [0.85, 1]) = L(\\emptyset) = 0$\nSubstituting these values:\n$$ g_{1} = \\frac{(2)(0.4) + (5)(0.1) + (3)(0)}{0.5} = \\frac{0.8 + 0.5}{0.5} = \\frac{1.3}{0.5} = \\frac{13}{5} $$\n\nNext, we calculate $g_{2}$ for the element $\\Gamma_{f,2} = [0.5, 1]$:\n$$ g_{2} = \\frac{q_{1}L(\\Gamma_{f,2} \\cap \\Gamma_{r,1}) + q_{2}L(\\Gamma_{f,2} \\cap \\Gamma_{r,2}) + q_{3}L(\\Gamma_{f,2} \\cap \\Gamma_{r,3})}{L(\\Gamma_{f,2})} $$\nThe intersection lengths are:\n- $L(\\Gamma_{f,2} \\cap \\Gamma_{r,1}) = L([0.5, 1] \\cap [0, 0.4]) = L(\\emptyset) = 0$\n- $L(\\Gamma_{f,2} \\cap \\Gamma_{r,2}) = L([0.5, 1] \\cap [0.4, 0.85]) = L([0.5, 0.85]) = 0.35$\n- $L(\\Gamma_{f,2} \\cap \\Gamma_{r,3}) = L([0.5, 1] \\cap [0.85, 1]) = L([0.85, 1]) = 0.15$\nSubstituting these values:\n$$ g_{2} = \\frac{(2)(0) + (5)(0.35) + (3)(0.15)}{0.5} = \\frac{0 + 1.75 + 0.45}{0.5} = \\frac{2.2}{0.5} = \\frac{22}{5} $$\n\nThe computed feature-side flux values are $g_{1} = \\frac{13}{5}$ and $g_{2} = \\frac{22}{5}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{13}{5}  \\frac{22}{5}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}