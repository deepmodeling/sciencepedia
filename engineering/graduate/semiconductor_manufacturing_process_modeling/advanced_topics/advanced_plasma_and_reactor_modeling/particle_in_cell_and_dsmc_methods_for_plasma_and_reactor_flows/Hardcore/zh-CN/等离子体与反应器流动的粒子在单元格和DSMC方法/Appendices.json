{
    "hands_on_practices": [
        {
            "introduction": "任何粒子模拟的第一步都是定义计算网格和时间步长。这些参数并非随意选取，必须根据系统的物理尺度仔细确定，以保证模拟的有效性。本练习将指导你计算稀薄气体的平均自由程和平均碰撞时间，这些是为直接模拟蒙特卡洛（DSMC）方法选择空间网格尺寸和时间步长的直接依据。",
            "id": "4149170",
            "problem": "一个用于半导体制造的低压氩气反应器在压力 $p=10$ mTorr 和温度 $T=300$ K 下运行。将氩气视为单原子硬球气体，其动力学直径为 $d=3.66 \\times 10^{-10}$ m，原子质量为 $m=39.948$ 统一原子质量单位，其中 $1$ 统一原子质量单位 $=1.66053906660 \\times 10^{-27}$ kg。使用理想气体定律将数密度与压力和温度关联起来，使用硬球碰撞截面定义，并使用麦克斯韦-玻尔兹曼气体的标准动力学理论，来推导平均自由程和平均碰撞时间。然后，基于公认的用于精确模拟的直接模拟蒙特卡洛 (DSMC) 约束条件，为此反应器中的 DSMC 选择一个可行的空间单元尺寸和时间步长。\n\n从以下基础出发：\n- 理想气体定律 $p=n k_B T$，用于将数密度 $n$ 与 $p$ 和 $T$ 关联。\n- 氩原子的硬球碰撞截面 $\\sigma=\\pi d^2$。\n- 气体中平均自由程的动力学理论定义 $\\ell=\\frac{1}{\\sqrt{2}\\,n\\,\\sigma}$。\n- 氩原子的麦克斯韦-玻尔兹曼平均速率 $\\bar{v}=\\sqrt{\\frac{8 k_B T}{\\pi m}}$。\n\n利用这些，推导平均自由程 $\\ell$ 和平均碰撞时间 $\\tau_c=\\frac{\\ell}{\\bar{v}}$ 的表达式。为满足 DSMC 的可行性，将空间单元尺寸和时间步长分别定义为 $\\Delta x=\\frac{\\ell}{3}$ 和 $\\Delta t=\\frac{\\tau_c}{5}$。\n\n附加数据：取玻尔兹曼常数 $k_B=1.380649 \\times 10^{-23}$ J/K，并使用 $1$ Torr $=133.322$ Pa 将给定压力转换为国际单位制 (SI) 单位。\n\n计算并报告四个量：$\\ell$、$\\tau_c$、$\\Delta x$ 和 $\\Delta t$。所有最终量均以国际单位制 (m 和 s) 表示，并将最终数值四舍五入至三位有效数字。",
            "solution": "该问题具有科学依据，提法明确，并提供了计算所需量所需的所有必要信息。所用的物理模型和约束条件是稀薄气体动力学和计算建模领域的标准。因此，该问题是有效的，可以构建一个分步解答。\n\n任务是计算四个量：平均自由程 $\\ell$、平均碰撞时间 $\\tau_c$、一个可行的直接模拟蒙特卡洛 (DSMC) 空间单元尺寸 $\\Delta x$ 以及一个可行的 DSMC 时间步长 $\\Delta t$。推导将按照问题陈述中概述的逻辑顺序进行。\n\n首先，为保证计算的一致性，所有给定数量必须以国际单位制 (SI) 表示。\n给定压力为 $p = 10$ mTorr。使用转换因子 $1$ Torr $= 133.322$ Pa，我们得到：\n$$p = 10 \\times 10^{-3} \\text{ Torr} \\times \\frac{133.322 \\text{ Pa}}{1 \\text{ Torr}} = 1.33322 \\text{ Pa}$$\n氩的原子质量给定为 $m_{u} = 39.948$ 统一原子质量单位 (u)。使用转换因子 $1 \\text{ u} = 1.66053906660 \\times 10^{-27}$ kg，单个氩原子的质量（单位：千克）为：\n$$m = 39.948 \\text{ u} \\times \\frac{1.66053906660 \\times 10^{-27} \\text{ kg}}{1 \\text{ u}} \\approx 6.63352 \\times 10^{-26} \\text{ kg}$$\n其他以国际单位制表示的给定数量为：温度 $T = 300$ K，氩的动力学直径 $d = 3.66 \\times 10^{-10}$ m，以及玻尔兹曼常数 $k_B = 1.380649 \\times 10^{-23}$ J/K。\n\n在所有变量都采用国际单位制后，我们可以进行计算。\n\n1.  **数密度 ($n$)**: 气体的数密度 $n$ 可以通过重新整理理想气体定律 $p = n k_B T$ 得到：\n    $$n = \\frac{p}{k_B T}$$\n    代入数值：\n    $$n = \\frac{1.33322 \\text{ Pa}}{(1.380649 \\times 10^{-23} \\text{ J/K}) \\times (300 \\text{ K})} = \\frac{1.33322}{4.141947 \\times 10^{-21}} \\text{ m}^{-3} \\approx 3.21908 \\times 10^{20} \\text{ m}^{-3}$$\n\n2.  **碰撞截面 ($\\sigma$)**: 对于硬球气体，碰撞截面 $\\sigma$ 基于动力学直径 $d$ 定义：\n    $$\\sigma = \\pi d^2$$\n    代入 $d$ 的值：\n    $$\\sigma = \\pi (3.66 \\times 10^{-10} \\text{ m})^2 = \\pi (1.33956 \\times 10^{-19} \\text{ m}^2) \\approx 4.20836 \\times 10^{-19} \\text{ m}^2$$\n\n3.  **平均自由程 ($\\ell$)**: 平均自由程 $\\ell$ 是原子在两次碰撞之间行进的平均距离。它由以下公式给出：\n    $$\\ell = \\frac{1}{\\sqrt{2}\\,n\\,\\sigma}$$\n    代入计算出的 $n$ 和 $\\sigma$ 的值：\n    $$\\ell = \\frac{1}{\\sqrt{2} \\times (3.21908 \\times 10^{20} \\text{ m}^{-3}) \\times (4.20836 \\times 10^{-19} \\text{ m}^2)}$$\n    $$\\ell \\approx \\frac{1}{191.605 \\text{ m}^{-1}} \\approx 0.0052190 \\text{ m}$$\n    四舍五入到三位有效数字，$\\ell = 5.22 \\times 10^{-3}$ m。\n\n4.  **平均速率 ($\\bar{v}$)**: 服从麦克斯韦-玻尔兹曼分布的气体中原子的平均速率由以下公式给出：\n    $$\\bar{v} = \\sqrt{\\frac{8 k_B T}{\\pi m}}$$\n    代入 $k_B$、$T$ 和 $m$ 的值：\n    $$\\bar{v} = \\sqrt{\\frac{8 \\times (1.380649 \\times 10^{-23} \\text{ J/K}) \\times (300 \\text{ K})}{\\pi \\times (6.63352 \\times 10^{-26} \\text{ kg})}}$$\n    $$\\bar{v} = \\sqrt{\\frac{3.3135576 \\times 10^{-20}}{2.08399 \\times 10^{-25}}} \\text{ m/s} \\approx \\sqrt{159000.8} \\text{ m/s} \\approx 398.749 \\text{ m/s}$$\n    四舍五入到三位有效数字，$\\bar{v} = 399$ m/s。\n\n5.  **平均碰撞时间 ($\\tau_c$)**: 两次碰撞之间的平均时间 $\\tau_c$ 是平均自由程与平均速率的比值：\n    $$\\tau_c = \\frac{\\ell}{\\bar{v}}$$\n    为获得更高精度，使用未四舍五入的值：\n    $$\\tau_c = \\frac{0.0052190 \\text{ m}}{398.749 \\text{ m/s}} \\approx 1.3088 \\times 10^{-5} \\text{ s}$$\n    四舍五入到三位有效数字，$\\tau_c = 1.31 \\times 10^{-5}$ s。\n\n6.  **DSMC 参数 ($\\Delta x$ 和 $\\Delta t$)**: 问题为选择 DSMC 单元尺寸 $\\Delta x$ 和时间步长 $\\Delta t$ 提供了具体约束条件。\n    空间单元尺寸 $\\Delta x$ 定义为：\n    $$\\Delta x = \\frac{\\ell}{3}$$\n    使用未四舍五入的 $\\ell$ 值：\n    $$\\Delta x = \\frac{0.0052190 \\text{ m}}{3} \\approx 0.00173967 \\text{ m}$$\n    四舍五入到三位有效数字，$\\Delta x = 1.74 \\times 10^{-3}$ m。\n\n    时间步长 $\\Delta t$ 定义为：\n    $$\\Delta t = \\frac{\\tau_c}{5}$$\n    使用未四舍五入的 $\\tau_c$ 值：\n    $$\\Delta t = \\frac{1.3088 \\times 10^{-5} \\text{ s}}{5} = 2.6176 \\times 10^{-6} \\text{ s}$$\n    四舍五入到三位有效数字，$\\Delta t = 2.62 \\times 10^{-6}$ s。\n\n所要求的四个量，四舍五入到三位有效数字，是：\n$\\ell = 5.22 \\times 10^{-3}$ m\n$\\tau_c = 1.31 \\times 10^{-5}$ s\n$\\Delta x = 1.74 \\times 10^{-3}$ m\n$\\Delta t = 2.62 \\times 10^{-6}$ s",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n5.22 \\times 10^{-3}  1.31 \\times 10^{-5}  1.74 \\times 10^{-3}  2.62 \\times 10^{-6}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "粒子方法的强大之处在于它们能够从第一性原理出发模拟动力学过程。一个关键例子是计算等离子体中的反应速率，这取决于能量依赖的碰撞截面和粒子能量分布。本练习涉及等离子体建模中的一项核心任务：通过对电子能量分布函数（EEDF）进行数值积分来计算电子碰撞解离速率，从而将微观数据与宏观反应动力学联系起来。",
            "id": "4149137",
            "problem": "您正在一个与半导体制造相关的等离子体反应器中模拟电子-中性粒子碰撞。考虑一个四氟化碳 (CF$_4$) 等离子体，其中电子碰撞解离会产生活性自由基。在粒子模拟 (Particle-In-Cell, PIC) 结合直接模拟蒙特卡洛 (Direct Simulation Monte Carlo, DSMC) 方法中，电子-中性粒子碰撞速率是根据动力学理论的第一性原理计算得出的。\n\n从以下基本依据出发：\n- 速度的定义为 $v = \\mathrm{d}x/\\mathrm{d}t$，牛顿动能为 $E_{\\mathrm{J}} = \\tfrac{1}{2} m v^2$，其中 $E_{\\mathrm{J}}$ 是以焦耳为单位的能量，$m$ 是质量。\n- 在能量空间中对概率密度函数 $f(E)$ 的统计期望，该函数经归一化处理，满足 $\\int f(E)\\,\\mathrm{d}E = 1$。\n- 对于温度为 $T$ 的稀薄 CF$_4$ 中性气体，其中性粒子数密度为 $n_{\\mathrm{CF4}} = P/(k_{\\mathrm{B}} T)$，其中 $P$ 是压强，$k_{\\mathrm{B}}$ 是玻尔兹曼常数。\n- 对于与重得多的中性粒子碰撞的电子，其相对速度可以近似为电子速度 $v(E)$。该速度由能量 $E_{\\mathrm{J}}$ 导出；其中能量 $E$ 以电子伏特为单位测量，通过 $E_{\\mathrm{J}} = e E_{\\mathrm{eV}}$ 转换为焦耳，其中 $e$ 是元电荷。\n\n您的任务是：\n1. 基于上述依据，推导出一个算法，用于使用列表形式的截面数据 $\\sigma(E)$ 和测得的能量分布 $f(E)$ 计算 CF$_4$ 的电子碰撞解离速率系数。仅使用定义和守恒论证，不假设任何快捷公式。\n2. 实现该算法，以计算活性自由基的体积产率，其定义为单位体积、单位时间内产生的活性自由基数量，假设每次解离事件的化学计量产额为一个活性自由基。所有最终速率以 $\\mathrm{m^{-3}\\,s^{-1}}$ 为单位表示。\n3. 使用提供的离散能量网格、截面数据表和测得的能量分布，为一组涵盖一般条件和边界条件的测试套件计算结果。\n\n常数 (使用国际单位制):\n- 元电荷 $e = 1.602176634\\times 10^{-19}\\,\\mathrm{C}$，\n- 电子质量 $m_e = 9.1093837015\\times 10^{-31}\\,\\mathrm{kg}$，\n- 玻尔兹曼常数 $k_{\\mathrm{B}} = 1.380649\\times 10^{-23}\\,\\mathrm{J/K}$。\n\n用于制表的通用能量网格 (单位：电子伏特):\n- $E_{\\mathrm{grid}} = [0, 2, 4, 6, 8, 10, 12, 15, 20, 30, 40, 50]\\,\\mathrm{eV}$。\n\n在上述网格上，作为能量 $E$ 函数的 CF$_4$ 解离截面数据表 (假设阈值在 $8\\,\\mathrm{eV}$ 附近，为确保科学真实性选择了合理的数量级):\n- $\\sigma(E)$ (单位 $\\mathrm{m^2}$) 为 $[0, 0, 0, 0, 1\\times 10^{-21}, 5\\times 10^{-21}, 1\\times 10^{-20}, 1.5\\times 10^{-20}, 1.7\\times 10^{-20}, 1.4\\times 10^{-20}, 1\\times 10^{-20}, 7\\times 10^{-21}]$，与 $E_{\\mathrm{grid}}$ 对齐。\n\n测得的能量分布 $f_{\\mathrm{raw}}(E)$ (在 $E_{\\mathrm{grid}}$ 上的非归一化样本；您的程序必须通过在电子伏特单位下对 $E$ 进行积分 $\\int f(E)\\,\\mathrm{d}E = 1$ 来对每个分布进行归一化):\n- 情况 A (一般情况，近似麦克斯韦分布的尾部): 对于每个 $E_i \\in E_{\\mathrm{grid}}$，$f_{\\mathrm{raw,A}}(E_i) = E_i \\exp(-E_i/4)$。\n- 情况 B (在 $20\\,\\mathrm{eV}$ 附近的准单能分布): $f_{\\mathrm{raw,B}}(E_i) = \\exp\\left(-\\frac{(E_i - 20)^2}{2\\times 2^2}\\right)$。\n- 情况 C (阈值以下的低能主导分布): $f_{\\mathrm{raw,C}}(E_i) = \\exp\\left(-\\frac{(E_i - 4)^2}{2\\times 1.5^2}\\right)$。\n- 情况 D (电子密度为零的边界条件；重用情况 A 的分布): $f_{\\mathrm{raw,D}}(E_i) = f_{\\mathrm{raw,A}}(E_i)$。\n\n每种情况的操作条件：\n- 情况 A: $P = 5.33288\\,\\mathrm{Pa}$ (约 $40\\,\\mathrm{mTorr}$)，$T = 300\\,\\mathrm{K}$，$n_e = 1.0\\times 10^{16}\\,\\mathrm{m^{-3}}$，化学计量产额 $s = 1$ 个自由基/事件。\n- 情况 B: $P = 1.33322\\,\\mathrm{Pa}$ (约 $10\\,\\mathrm{mTorr}$)，$T = 300\\,\\mathrm{K}$，$n_e = 5.0\\times 10^{15}\\,\\mathrm{m^{-3}}$，$s = 1$。\n- 情况 C: $P = 13.3322\\,\\mathrm{Pa}$ (约 $100\\,\\mathrm{mTorr}$)，$T = 300\\,\\mathrm{K}$，$n_e = 1.0\\times 10^{16}\\,\\mathrm{m^{-3}}$，$s = 1$。\n- 情况 D: $P = 5.33288\\,\\mathrm{Pa}$，$T = 300\\,\\mathrm{K}$，$n_e = 0\\,\\mathrm{m^{-3}}$，$s = 1$。\n\n数值计算要求：\n- 在 $E_{\\mathrm{grid}}$ 上对每个测得的 $f_{\\mathrm{raw}}(E)$进行归一化，使其满足 $\\int f(E)\\,\\mathrm{d}E = 1$，需在电子伏特单位下对 $E$ 使用一致的求积法则。\n- 使用 $E_{\\mathrm{J}} = e E_{\\mathrm{eV}}$ 将能量 $E$ 从电子伏特转换为焦耳，然后计算电子速度 $v(E) = \\sqrt{2 E_{\\mathrm{J}}/m_e}$，单位为 $\\mathrm{m/s}$。\n- 将电子-中性粒子的相对速度视为 $v(E)$。\n- 通过对归一化的 $f(E)$ 进行适当平均并在能量上积分，计算解离速率系数，单位为 $\\mathrm{m^3/s}$。\n- 使用理想气体关系式得到的中性粒子密度和电子密度，计算活性自由基的体积产率 $R$，单位为 $\\mathrm{m^{-3}\\,s^{-1}}$。\n\n您的程序应生成单行输出，其中包含四种情况下的速率，格式为方括号内以逗号分隔的列表 (例如, $[r_A,r_B,r_C,r_D]$)，其中每个 $r$ 是一个浮点数，单位为 $\\mathrm{m^{-3}\\,s^{-1}}$。",
            "solution": "该问题要求推导并实现一个算法，用于计算四氟化碳 ($\\mathrm{CF_4}$) 电子碰撞解离产生活性自由基的体积产率。这一过程是半导体制造中等离子体刻蚀的核心。推导应从动力学理论的第一性原理开始，并使用所提供的数据进行数值实现。\n\n### 1. 速率系数和体积产率的推导\n\n基本过程是电子 ($e^-$) 与中性 $\\mathrm{CF_4}$ 分子之间的碰撞，导致解离：\n$$ e^- + \\mathrm{CF_4} \\rightarrow \\text{radicals} + e^- $$\n\n**步骤 1.1：单电子碰撞频率**\n\n考虑一个动能为 $E$、速度为 $v$ 的单个电子，穿过数密度为 $n_{\\mathrm{CF4}}$ 的稀薄、静止的 $\\mathrm{CF_4}$ 分子气体。电子为中性粒子提供了一个靶标，反之亦然。发生解离碰撞的有效面积是能量依赖的截面 $\\sigma(E)$。在时间间隔 $\\mathrm{d}t$ 内，电子行进距离 $\\mathrm{d}l = v\\,\\mathrm{d}t$，并扫过一个圆柱形体积 $\\mathrm{d}V = \\sigma(E) \\cdot \\mathrm{d}l = \\sigma(E) v(E) \\mathrm{d}t$。\n\n该无穷小体积内的中性分子数量为 $\\mathrm{d}N_{coll} = n_{\\mathrm{CF4}} \\mathrm{d}V = n_{\\mathrm{CF4}} \\sigma(E) v(E) \\mathrm{d}t$。因此，该单个电子引发解离事件的速率，也称为此反应的碰撞频率，为：\n$$ \\nu(E) = \\frac{\\mathrm{d}N_{coll}}{\\mathrm{d}t} = n_{\\mathrm{CF4}} \\sigma(E) v(E) $$\n\n电子的速度 $v(E)$ 从其动能导出。问题中给出的能量 $E$ 单位为电子伏特 ($\\mathrm{eV}$)。为了在标准物理方程中使用，必须将其转换为国际单位制中的焦耳 ($E_{\\mathrm{J}}$)。给定元电荷 $e$，转换关系为 $E_{\\mathrm{J}} = e E$。根据牛顿动能公式 $E_{\\mathrm{J}} = \\frac{1}{2} m_e v^2$，其中 $m_e$ 是电子质量，我们可以解出速度：\n$$ v(E) = \\sqrt{\\frac{2 E_{\\mathrm{J}}}{m_e}} = \\sqrt{\\frac{2eE}{m_e}} $$\n问题指出，我们可以用电子速度来近似电子-中性粒子对的相对速度，这是一个有效的近似，因为电子质量 $m_e$ 比 $\\mathrm{CF_4}$ 分子的质量小数千倍，使得电子的速度远大于中性气体的热速度。\n\n**步骤 1.2：对电子能量分布进行平均**\n\n在等离子体中，电子并非都具有相同的能量。它们的能量由一个概率分布描述，即电子能量分布函数 (Electron Energy Distribution Function, EEDF)，记为 $f(E)$。该函数经过归一化，满足 $\\int_0^\\infty f(E) \\mathrm{d}E = 1$，并且 $f(E)\\mathrm{d}E$ 代表能量在 $E$ 和 $E+\\mathrm{d}E$ 之间的电子所占的比例。\n\n为了求得总的解离速率，我们必须将单个电子的碰撞速率在整个电子群体上进行平均。由能量在 $E$ 和 $E+\\mathrm{d}E$ 之间的电子引发的、单位体积单位时间内的总解离事件数，是单电子碰撞频率 $\\nu(E)$ 与该能量范围内的电子数密度 $n_e f(E) \\mathrm{d}E$ 的乘积。\n来自该分布片段的速率为：\n$$ \\mathrm{d}R = \\nu(E) \\cdot (n_e f(E) \\mathrm{d}E) = (n_{\\mathrm{CF4}} \\sigma(E) v(E)) \\cdot (n_e f(E) \\mathrm{d}E) $$\n通过将此表达式对所有可能的电子能量进行积分，可以得到解离碰撞的总体积速率 $R_{coll}$：\n$$ R_{coll} = \\int_0^\\infty n_e n_{\\mathrm{CF4}} \\sigma(E) v(E) f(E) \\mathrm{d}E $$\n我们可以重新组合这些项：\n$$ R_{coll} = n_e n_{\\mathrm{CF4}} \\left( \\int_0^\\infty \\sigma(E) v(E) f(E) \\mathrm{d}E \\right) $$\n括号中的项被定义为电子碰撞解离**速率系数** $k$：\n$$ k \\equiv \\langle \\sigma v \\rangle = \\int_0^\\infty \\sigma(E) v(E) f(E) \\mathrm{d}E $$\n速率系数 $k$ 的单位是 $\\mathrm{m^3/s}$，表示在解离反应中，平均每个电子每秒扫过的“有效体积”。它包含了碰撞过程的微观物理（$\\sigma$）和等离子体的能量状态（$f(E)$）。\n\n**步骤 1.3：活性自由基体积产率**\n\n活性自由基的体积产率 $R$ 是解离碰撞速率 $R_{coll}$ 乘以化学计量产额 $s$，即每次解离事件产生的活性自由基数量。\n$$ R = s \\cdot R_{coll} = s \\cdot k \\cdot n_e \\cdot n_{\\mathrm{CF4}} $$\n对于给定的压强 $P$ 和温度 $T$，中性气体密度 $n_{\\mathrm{CF4}}$ 由理想气体定律给出：\n$$ n_{\\mathrm{CF4}} = \\frac{P}{k_{\\mathrm{B}} T} $$\n其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数。\n代入所有部分，活性自由基体积产率的最终表达式为：\n$$ R = s \\cdot n_e \\cdot \\left(\\frac{P}{k_{\\mathrm{B}} T}\\right) \\cdot \\int_0^\\infty \\sigma(E) v(E) f(E) \\mathrm{d}E $$\n至此，完成了从第一性原理出发的推导。\n\n### 2. 数值实现算法\n\n问题在离散的、非均匀的能量网格 $E_{\\mathrm{grid}} = \\{E_i\\}_{i=0}^{N-1}$ 上提供了所有数据。速率系数的积分必须进行数值计算。梯形法则是进行此积分的合适选择。\n\n**算法步骤：**\n1.  **输入数据**：加载常数（$e, m_e, k_{\\mathrm{B}}$）、能量网格 $E_{\\mathrm{grid}}$、截面数组 $\\sigma_i = \\sigma(E_i)$，以及每种情况的参数（$P, T, n_e, s$ 和 $f_{\\mathrm{raw}}$ 的规则）。\n\n2.  对于每种情况：\n    a.  **电子速度数组**：对于 $E_{\\mathrm{grid}}$ 中的每个能量 $E_i$（单位 $\\mathrm{eV}$），计算相应的电子速度 $v_i$。\n        $$ v_i = \\sqrt{\\frac{2eE_i}{m_e}} $$\n        这会创建一个速度数组 $v = \\{v_i\\}$。\n\n    b.  **原始 EEDF**：使用为该情况指定的函数，在每个网格点 $E_i$ 生成原始的、非归一化的 EEDF 值数组 $f_{\\mathrm{raw},i}$。\n\n    c.  **EEDF 归一化**：通过在能量网格上（单位 $\\mathrm{eV}$）对 $f_{\\mathrm{raw}}(E)$ 进行数值积分，计算归一化常数 $I$。\n        $$ I = \\int_0^\\infty f_{\\mathrm{raw}}(E) \\mathrm{d}E \\approx \\sum_{i=0}^{N-2} \\frac{f_{\\mathrm{raw},i} + f_{\\mathrm{raw}, i+1}}{2} (E_{i+1} - E_i) $$\n        如果 $I = 0$（例如，如果所有 $f_{\\mathrm{raw},i}$ 均为零），则归一化分布也为零。否则，计算归一化 EEDF 数组 $f_i$：\n        $$ f_i = \\frac{f_{\\mathrm{raw},i}}{I} $$\n        请注意，$f_i$ 的单位是 $\\mathrm{eV}^{-1}$。\n\n    d.  **速率系数计算**：通过在能量网格上（单位 $\\mathrm{eV}$）对乘积 $\\sigma(E)v(E)f(E)$ 进行数值积分，计算速率系数 $k$。\n        $$ k = \\int_0^\\infty \\sigma(E) v(E) f(E) \\mathrm{d}E \\approx \\sum_{i=0}^{N-2} \\frac{\\sigma_i v_i f_i + \\sigma_{i+1} v_{i+1} f_{i+1}}{2} (E_{i+1} - E_i) $$\n\n    e.  **中性粒子密度**：根据给定的压强 $P$（单位 $\\mathrm{Pa}$）和温度 $T$（单位 $\\mathrm{K}$），计算中性气体密度 $n_{\\mathrm{CF4}}$，单位 $\\mathrm{m^{-3}}$。\n        $$ n_{\\mathrm{CF4}} = \\frac{P}{k_{\\mathrm{B}} T} $$\n\n    f.  **体积产率**：使用该情况下的电子密度 $n_e$ 和化学计量产额 $s$，计算最终速率 $R$，单位 $\\mathrm{m^{-3}\\,s^{-1}}$。\n        $$ R = s \\cdot k \\cdot n_e \\cdot n_{\\mathrm{CF4}} $$\n        对于情况 D，其中 $n_e = 0$，速率 $R$ 将精确为 $0$。\n\n该算法系统地遵循所推导的物理原理，为每个测试用例计算所需的量。",
            "answer": "[2.016335359733475e+19,1.407982025740467e+20,3.619179929117621e+18,0.0]"
        },
        {
            "introduction": "在单元内粒子（PIC）方法中，信息在离散的粒子和计算网格之间传递。用于此传递的方案，如“单元云”（CIC）方法，具有影响模拟准确性的内在数值特性。这项解析练习将通过分析 CIC 形函数，揭示其固有的平滑效应以及它如何滤除高频（网格尺度）噪声，为深入理解 PIC 算法的数值行为提供关键视角。",
            "id": "4149188",
            "problem": "在用于半导体制造的电容耦合等离子体反应器的一维粒子网格(PIC)模拟中，离子和电子使用云中云(CIC)电荷分配方案沉积到均匀网格上。考虑一个间距为 $\\Delta x$ 的均匀网格，并仅关注电荷沉积步骤，忽略由场求解器或插值回粒子引起的任何额外滤波。\n\n设一维CIC形函数用 $S(x)$ 表示，它是一阶基本B样条。它被定义为支撑集在 $[-\\Delta x,\\Delta x]$ 上且积分为1的三角函数，\n$$\nS(x) = \n\\begin{cases}\n\\dfrac{1}{\\Delta x}\\left(1 - \\dfrac{|x|}{\\Delta x}\\right),  |x| \\le \\Delta x \\\\[6pt]\n0,  \\text{其他情况}.\n\\end{cases}\n$$\n沉积的电荷密度是点粒子密度与 $S(x)$ 的卷积。假设CIC的有效平滑效果可以通过 $S(x)$ 的标准差 $\\sigma_{\\text{eff}}$ 来量化，该标准差由二阶中心矩定义\n$$\n\\sigma_{\\text{eff}}^{2} = \\int_{-\\infty}^{\\infty} x^{2} S(x)\\, dx.\n$$\n将波数为 $k$ 时沉积电荷密度振幅谱的衰减因子 $A(k)$ 定义为 $S(x)$ 的傅里叶变换的绝对值，并在 $k=0$ 处归一化为1，\n$$\nA(k) = \\left|\\int_{-\\infty}^{\\infty} S(x)\\, \\exp(-\\mathrm{i} k x)\\, dx\\right|.\n$$\n将“网格尺度”噪声视为均匀网格的奈奎斯特波数 $k_{N} = \\pi / \\Delta x$。\n\n从第一性原理出发，用 $\\Delta x$ 推导 $\\sigma_{\\text{eff}}$，并计算奈奎斯特波数处的衰减因子 $A(k_{N})$。以单行矩阵的形式报告您的最终结果，即无量纲数对 $[\\sigma_{\\text{eff}}/\\Delta x,\\; A(k_{N})]$。在您最终报告的数对中不要包含单位。无需进行数值取整；请提供精确的解析表达式。",
            "solution": "该问题要求推导与一维粒子网格(PIC)模拟中云中云(CIC)电荷分配方案相关的两个量。第一个量是有效平滑标准差 $\\sigma_{\\text{eff}}$，由网格间距 $\\Delta x$ 归一化。第二个量是衰减因子 $A(k)$，在奈奎斯特波数 $k_N$ 处求值。\n\nCIC形函数由下式给出：\n$$\nS(x) =\n\\begin{cases}\n\\dfrac{1}{\\Delta x}\\left(1 - \\dfrac{|x|}{\\Delta x}\\right),   |x| \\le \\Delta x \\\\\n0,  \\text{其他情况}\n\\end{cases}\n$$\n这个函数是一个三角函数或“帐篷”函数，关于 $x=0$ 对称，底宽为 $2\\Delta x$，高为 $\\frac{1}{\\Delta x}$。\n\n首先，我们计算有效平滑 $\\sigma_{\\text{eff}}$。这由 $S(x)$ 的二阶中心矩定义。由于 $S(x)$ 是一个偶函数，其均值 $\\mu = \\int_{-\\infty}^{\\infty} x S(x) dx$ 为零。因此，二阶中心矩与二阶原点矩相同：\n$$\n\\sigma_{\\text{eff}}^{2} = \\int_{-\\infty}^{\\infty} (x-\\mu)^2 S(x)\\, dx = \\int_{-\\infty}^{\\infty} x^{2} S(x)\\, dx\n$$\n代入 $S(x)$ 的表达式：\n$$\n\\sigma_{\\text{eff}}^{2} = \\int_{-\\Delta x}^{\\Delta x} x^{2} \\left[\\dfrac{1}{\\Delta x}\\left(1 - \\dfrac{|x|}{\\Delta x}\\right)\\right]\\, dx\n$$\n被积函数是 $x$ 的偶函数。我们可以通过考虑区间 $[0, \\Delta x]$ 并乘以2来简化积分：\n$$\n\\sigma_{\\text{eff}}^{2} = \\dfrac{2}{\\Delta x} \\int_{0}^{\\Delta x} \\left(x^{2} - \\dfrac{x^{3}}{\\Delta x}\\right)\\, dx\n$$\n进行多项式积分：\n$$\n\\sigma_{\\text{eff}}^{2} = \\dfrac{2}{\\Delta x} \\left[ \\dfrac{x^{3}}{3} - \\dfrac{x^{4}}{4\\Delta x} \\right]_{0}^{\\Delta x}\n$$\n在积分上下限处求值：\n$$\n\\sigma_{\\text{eff}}^{2} = \\dfrac{2}{\\Delta x} \\left( \\left(\\dfrac{(\\Delta x)^{3}}{3} - \\dfrac{(\\Delta x)^{4}}{4\\Delta x}\\right) - (0) \\right)\n$$\n$$\n\\sigma_{\\text{eff}}^{2} = \\dfrac{2}{\\Delta x} \\left( \\dfrac{(\\Delta x)^{3}}{3} - \\dfrac{(\\Delta x)^{3}}{4} \\right) = \\dfrac{2}{\\Delta x} \\left( \\dfrac{4(\\Delta x)^{3} - 3(\\Delta x)^{3}}{12} \\right)\n$$\n$$\n\\sigma_{\\text{eff}}^{2} = \\dfrac{2}{\\Delta x} \\left( \\dfrac{(\\Delta x)^{3}}{12} \\right) = \\dfrac{(\\Delta x)^{2}}{6}\n$$\n取平方根求 $\\sigma_{\\text{eff}}$：\n$$\n\\sigma_{\\text{eff}} = \\sqrt{\\dfrac{(\\Delta x)^{2}}{6}} = \\dfrac{\\Delta x}{\\sqrt{6}}\n$$\n第一个要求的量是无量纲比 $\\sigma_{\\text{eff}}/\\Delta x$：\n$$\n\\dfrac{\\sigma_{\\text{eff}}}{\\Delta x} = \\dfrac{1}{\\sqrt{6}}\n$$\n\n接下来，我们计算奈奎斯特波数 $k_N$ 处的衰减因子 $A(k)$。衰减因子是 $S(x)$ 傅里叶变换的模，我们记为 $\\hat{S}(k)$。\n$$\n\\hat{S}(k) = \\int_{-\\infty}^{\\infty} S(x)\\, \\exp(-\\mathrm{i} k x)\\, dx\n$$\n代入 $S(x)$ 的表达式：\n$$\n\\hat{S}(k) = \\int_{-\\Delta x}^{\\Delta x} \\dfrac{1}{\\Delta x}\\left(1 - \\dfrac{|x|}{\\Delta x}\\right) \\exp(-\\mathrm{i} k x)\\, dx\n$$\n由于 $S(x)$ 是一个实偶函数，其傅里叶变换也是实偶函数。我们可以用 $\\cos(kx)$ 替换 $\\exp(-\\mathrm{i} k x)$：\n$$\n\\hat{S}(k) = \\int_{-\\Delta x}^{\\Delta x} \\dfrac{1}{\\Delta x}\\left(1 - \\dfrac{|x|}{\\Delta x}\\right) \\cos(kx)\\, dx\n$$\n被积函数是偶函数，所以我们可以再次简化积分域：\n$$\n\\hat{S}(k) = \\dfrac{2}{\\Delta x} \\int_{0}^{\\Delta x} \\left(1 - \\dfrac{x}{\\Delta x}\\right) \\cos(kx)\\, dx\n$$\n我们使用分部积分法 $\\int u \\, dv = uv - \\int v \\, du$，设 $u = 1 - \\frac{x}{\\Delta x}$ 和 $dv = \\cos(kx)dx$。这给出 $du = -\\frac{1}{\\Delta x}dx$ 和 $v = \\frac{\\sin(kx)}{k}$。\n$$\n\\int \\left(1 - \\dfrac{x}{\\Delta x}\\right) \\cos(kx)\\, dx = \\left(1 - \\dfrac{x}{\\Delta x}\\right)\\dfrac{\\sin(kx)}{k} - \\int \\dfrac{\\sin(kx)}{k} \\left(-\\dfrac{1}{\\Delta x}\\right) dx\n$$\n$$\n= \\left(1 - \\dfrac{x}{\\Delta x}\\right)\\dfrac{\\sin(kx)}{k} + \\dfrac{1}{k\\Delta x} \\int \\sin(kx)\\, dx\n$$\n$$\n= \\left(1 - \\dfrac{x}{\\Delta x}\\right)\\dfrac{\\sin(kx)}{k} - \\dfrac{\\cos(kx)}{k^2\\Delta x}\n$$\n从 $0$ 到 $\\Delta x$ 对此求值：\n$$\n\\int_{0}^{\\Delta x} \\dots dx = \\left[ \\left(1 - \\dfrac{\\Delta x}{\\Delta x}\\right)\\dfrac{\\sin(k\\Delta x)}{k} - \\dfrac{\\cos(k\\Delta x)}{k^2\\Delta x} \\right] - \\left[ \\left(1 - 0\\right)\\dfrac{\\sin(0)}{k} - \\dfrac{\\cos(0)}{k^2\\Delta x} \\right]\n$$\n$$\n= \\left[ 0 - \\dfrac{\\cos(k\\Delta x)}{k^2\\Delta x} \\right] - \\left[ 0 - \\dfrac{1}{k^2\\Delta x} \\right] = \\dfrac{1 - \\cos(k\\Delta x)}{k^2\\Delta x}\n$$\n将此结果代回 $\\hat{S}(k)$ 的表达式中：\n$$\n\\hat{S}(k) = \\dfrac{2}{\\Delta x} \\left(\\dfrac{1 - \\cos(k\\Delta x)}{k^2\\Delta x}\\right) = \\dfrac{2(1 - \\cos(k\\Delta x))}{(k\\Delta x)^2}\n$$\n使用半角公式 $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$，其中 $\\theta = k\\Delta x$：\n$$\n\\hat{S}(k) = \\dfrac{2(2\\sin^2(k\\Delta x/2))}{(k\\Delta x)^2} = \\dfrac{4\\sin^2(k\\Delta x/2)}{(k\\Delta x)^2} = \\left(\\dfrac{\\sin(k\\Delta x/2)}{k\\Delta x/2}\\right)^2\n$$\n这是sinc函数 $\\text{sinc}(y) = \\sin(y)/y$ 的平方。所以，$\\hat{S}(k) = \\text{sinc}^2(k\\Delta x/2)$。\n衰减因子是 $A(k) = |\\hat{S}(k)| = \\hat{S}(k)$，因为该表达式总是非负的。\n我们需要在奈奎斯特波数 $k_N = \\pi/\\Delta x$ 处计算该值。\n$$\nA(k_N) = A(\\pi/\\Delta x) = \\left(\\dfrac{\\sin((\\pi/\\Delta x)\\Delta x/2)}{(\\pi/\\Delta x)\\Delta x/2}\\right)^2 = \\left(\\dfrac{\\sin(\\pi/2)}{\\pi/2}\\right)^2\n$$\n因为 $\\sin(\\pi/2) = 1$：\n$$\nA(k_N) = \\left(\\dfrac{1}{\\pi/2}\\right)^2 = \\left(\\dfrac{2}{\\pi}\\right)^2 = \\dfrac{4}{\\pi^2}\n$$\n\n最终结果是数对 $[\\sigma_{\\text{eff}}/\\Delta x, A(k_N)]$。我们已经求得 $\\sigma_{\\text{eff}}/\\Delta x = 1/\\sqrt{6}$ 和 $A(k_N) = 4/\\pi^2$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{\\sqrt{6}}  \\frac{4}{\\pi^2}\n\\end{pmatrix}\n}\n$$"
        }
    ]
}