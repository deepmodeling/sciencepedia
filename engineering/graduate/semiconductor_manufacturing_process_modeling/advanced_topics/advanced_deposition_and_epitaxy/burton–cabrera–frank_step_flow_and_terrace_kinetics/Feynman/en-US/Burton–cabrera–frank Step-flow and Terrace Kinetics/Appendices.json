{
    "hands_on_practices": [
        {
            "introduction": "The ideal Burton-Cabrera-Frank (BCF) model often simplifies step edges as perfect sinks for adatoms. In reality, attachment is a thermally activated process governed by the energy landscape at the step. This exercise explores the crucial Ehrlich-Schwoebel effect, which introduces an additional energy barrier for adatoms attaching from an upper terrace. By applying principles from Transition State Theory, you will quantify this kinetic asymmetry, a key factor that can lead to surface roughening and instabilities during growth .",
            "id": "4111618",
            "problem": "In the Burton–Cabrera–Frank (BCF) framework for step-flow growth, the net incorporation of adatoms at a step edge is described by kinetic coefficients $k^{+}$ and $k^{-}$ for attachment from the lower terrace and the upper terrace, respectively. Consider homoepitaxial growth on a semiconductor surface during molecular beam epitaxy, where adatom attachment is controlled by thermally activated crossing of step-edge barriers. Begin from the following fundamental bases:\n\n- The BCF description of terrace kinetics: adatom attachment to a step is governed by a kinetic coefficient that reflects the rate of crossing an energetic barrier at the step edge.\n- Transition State Theory (TST): the rate of a thermally activated process with activation energy $E$ at absolute temperature $T$ is proportional to an attempt frequency $\\nu$ times the Boltzmann factor, giving a rate proportional to $\\exp(-E/(k_{B}T))$, where $k_{B}$ is the Boltzmann constant.\n- The Ehrlich–Schwoebel (ES) effect: adatom attachment to a descending step encounters an additional barrier $E_{ES}$ relative to attachment to an ascending step, so that the effective activation energy for descending attachment is increased by $E_{ES}$.\n\nAssume both $k^{+}$ and $k^{-}$ share the same prefactor $k_{0}$ (a geometric and vibrational factor with dimensions of velocity) and that the baseline adatom step-attachment activation energy (in the absence of the ES effect) is $E_{a}$. Under these assumptions, derive from first principles the asymmetry ratio $k^{+}/k^{-}$ as a function of $E_{ES}$, $E_{a}$, $T$, and $k_{0}$. Then, evaluate this ratio for $E_{ES}=0.15\\,\\mathrm{eV}$, $E_{a}=0.6\\,\\mathrm{eV}$, $T=700\\,\\mathrm{K}$, and $k_{0}=10^{7}\\,\\mathrm{cm/s}$. Use the Boltzmann constant $k_{B}=8.617333262145\\times 10^{-5}\\,\\mathrm{eV/K}$. Express your final answer as a dimensionless number and round your answer to three significant figures.",
            "solution": "The problem requires the derivation of the asymmetry ratio of kinetic attachment coefficients, $k^{+}/k^{-}$, at a step edge during epitaxial growth, based on the principles of Transition State Theory (TST) applied to the Burton–Cabrera–Frank (BCF) model, incorporating the Ehrlich–Schwoebel (ES) effect. Following the derivation, the ratio must be evaluated for a specific set of physical parameters.\n\nAccording to Transition State Theory, the rate of a thermally activated process is proportional to an attempt frequency and a Boltzmann factor, which depends on the activation energy and temperature. A kinetic coefficient, $k$, for such a process can be expressed in the general form:\n$$k = k_{0} \\exp\\left(-\\frac{E_{\\text{act}}}{k_{B}T}\\right)$$\nwhere $k_{0}$ is a pre-exponential factor that includes geometric factors and vibrational attempt frequencies, $E_{\\text{act}}$ is the activation energy for the process, $k_{B}$ is the Boltzmann constant, and $T$ is the absolute temperature.\n\nThe problem defines two distinct kinetic coefficients: $k^{+}$ for adatom attachment from the lower terrace and $k^{-}$ for attachment from the upper terrace.\n\nFor attachment from the lower terrace (ascent), the adatom must overcome the baseline step-attachment activation energy, given as $E_{a}$. Therefore, the activation energy for this process is $E_{\\text{act}}^{+} = E_{a}$. Using the general form from TST and the given common prefactor $k_{0}$, the kinetic coefficient $k^{+}$ is:\n$$k^{+} = k_{0} \\exp\\left(-\\frac{E_{a}}{k_{B}T}\\right)$$\n\nFor attachment from the upper terrace (descent), the Ehrlich–Schwoebel effect introduces an additional energy barrier, $E_{ES}$. This additional barrier is added to the baseline activation energy. Thus, the total activation energy for an adatom attaching from the upper terrace is $E_{\\text{act}}^{-} = E_{a} + E_{ES}$. The corresponding kinetic coefficient, $k^{-}$, is:\n$$k^{-} = k_{0} \\exp\\left(-\\frac{E_{a} + E_{ES}}{k_{B}T}\\right)$$\n\nThe primary task is to derive the asymmetry ratio $k^{+}/k^{-}$. This is accomplished by dividing the expression for $k^{+}$ by the expression for $k^{-}$.\n$$\\frac{k^{+}}{k^{-}} = \\frac{k_{0} \\exp\\left(-\\frac{E_{a}}{k_{B}T}\\right)}{k_{0} \\exp\\left(-\\frac{E_{a} + E_{ES}}{k_{B}T}\\right)}$$\nThe prefactor $k_{0}$ is common to both processes and cancels out from the ratio:\n$$\\frac{k^{+}}{k^{-}} = \\frac{\\exp\\left(-\\frac{E_{a}}{k_{B}T}\\right)}{\\exp\\left(-\\frac{E_{a} + E_{ES}}{k_{B}T}\\right)}$$\nUsing the property of exponents $\\exp(a+b) = \\exp(a)\\exp(b)$, the denominator can be rewritten:\n$$\\frac{k^{+}}{k^{-}} = \\frac{\\exp\\left(-\\frac{E_{a}}{k_{B}T}\\right)}{\\exp\\left(-\\frac{E_{a}}{k_{B}T}\\right) \\exp\\left(-\\frac{E_{ES}}{k_{B}T}\\right)}$$\nThe term $\\exp\\left(-\\frac{E_{a}}{k_{B}T}\\right)$ appears in both the numerator and the denominator, and thus cancels out. This demonstrates that the asymmetry ratio is independent of the baseline activation energy $E_{a}$. The expression simplifies to:\n$$\\frac{k^{+}}{k^{-}} = \\frac{1}{\\exp\\left(-\\frac{E_{ES}}{k_{B}T}\\right)}$$\nUsing the identity $1/\\exp(-x) = \\exp(x)$, the final derived expression for the asymmetry ratio is:\n$$\\frac{k^{+}}{k^{-}} = \\exp\\left(\\frac{E_{ES}}{k_{B}T}\\right)$$\nThis result shows that the asymmetry ratio is a function of the Ehrlich-Schwoebel barrier $E_{ES}$ and the temperature $T$, but is independent of the baseline activation energy $E_{a}$ and the prefactor $k_{0}$, even though the problem initially listed them as potential variables.\n\nNext, we must evaluate this ratio using the provided numerical values:\n- Ehrlich–Schwoebel barrier, $E_{ES} = 0.15\\,\\mathrm{eV}$\n- Temperature, $T = 700\\,\\mathrm{K}$\n- Boltzmann constant, $k_{B} = 8.617333262145 \\times 10^{-5}\\,\\mathrm{eV/K}$\n\nFirst, we calculate the dimensionless argument of the exponential function, $\\frac{E_{ES}}{k_{B}T}$:\n$$\\frac{E_{ES}}{k_{B}T} = \\frac{0.15\\,\\mathrm{eV}}{\\left(8.617333262145 \\times 10^{-5}\\,\\mathrm{eV/K}\\right) \\times (700\\,\\mathrm{K})}$$\nThe product in the denominator is:\n$$k_{B}T = (8.617333262145 \\times 10^{-5}) \\times 700\\,\\mathrm{eV} \\approx 0.06032133\\,\\mathrm{eV}$$\nNow, we compute the value of the exponent:\n$$\\frac{E_{ES}}{k_{B}T} = \\frac{0.15}{0.06032133} \\approx 2.48668$$\nFinally, we calculate the ratio by taking the exponential of this value:\n$$\\frac{k^{+}}{k^{-}} = \\exp(2.48668) \\approx 12.02058$$\nThe problem requires the answer to be rounded to three significant figures. The first three significant figures are $1$, $2$, and $0$. The fourth digit is $2$, which is less than $5$, so we do not round up.\n\nThus, the evaluated asymmetry ratio is $12.0$.",
            "answer": "$$\\boxed{12.0}$$"
        },
        {
            "introduction": "Epitaxial growth is a complex sequence of events, from deposition to diffusion and finally to incorporation at a step edge. To understand and control this process, we must identify the rate-limiting step, or the \"bottleneck,\" which dictates the overall growth speed and morphology. This practice guides you in deriving and evaluating a dimensionless group that compares the characteristic speed of adatom diffusion across a terrace to the speed of kinetic attachment at the step edge, allowing for a clear classification of the growth regime .",
            "id": "4111667",
            "problem": "Consider step-flow growth on a vicinal semiconductor surface modeled by the Burton–Cabrera–Frank (BCF) framework. Adatoms land on terraces and diffuse with diffusivity $D$, possibly desorb with mean lifetime $\\tau$, and attach at steps with a kinetic coefficient $k$. The mean terrace width is $\\ell$. In the BCF description, the steady adatom transport on a terrace arises from diffusion across the terrace and reaction (attachment) at the step, with a boundary condition that linearly relates the net step flux to the local departure from the step-edge equilibrium concentration. Assume a quasi-steady state on the terrace and regular step trains.\n\nStarting from the adatom mass balance and Fick’s law, and using the linear kinetic boundary condition at the step, derive a dimensionless group that classifies whether transport is limited by terrace diffusion or by step attachment. Use the given values $D=10^{-6}\\,\\mathrm{cm^2/s}$, $\\tau=1\\,\\mathrm{s}$, $k=100\\,\\mathrm{cm/s}$, and $\\ell=50\\,\\mathrm{nm}$ to evaluate this dimensionless group, and use it to decide whether the process is diffusion-limited or attachment-limited under these conditions. Round your reported value of the dimensionless group to three significant figures and express it in standard scientific notation. Report only the value of the dimensionless group without any units; explain the regime classification in your derivation.",
            "solution": "The problem asks for a dimensionless group to classify the growth regime by comparing the rate of terrace diffusion to the rate of step attachment. We can derive this by comparing the characteristic timescales or velocities of the two processes.\n\n1.  **Characteristic Velocity of Diffusion ($v_{diff}$)**: Diffusion is the process by which an adatom travels across the terrace. The characteristic time, $\\tau_{diff}$, for an adatom to diffuse a distance equal to the terrace width, $\\ell$, is given by the random walk scaling relation: $\\tau_{diff} \\approx \\ell^2 / D$. The effective velocity of this transport process can be defined as the distance divided by this time:\n    $$v_{diff} = \\frac{\\ell}{\\tau_{diff}} = \\frac{\\ell}{\\ell^2 / D} = \\frac{D}{\\ell}$$\n\n2.  **Characteristic Velocity of Attachment ($v_{attach}$)**: The kinetic coefficient, $k$, quantifies the rate at which adatoms at a step edge are incorporated into the crystal. It has units of velocity and can be directly interpreted as the characteristic velocity of the attachment process:\n    $$v_{attach} = k$$\n\n3.  **Dimensionless Group and Classification**: To determine which process is rate-limiting, we take the ratio of their characteristic velocities. Let's define the dimensionless group $\\Lambda$ as:\n    $$\\Lambda = \\frac{v_{attach}}{v_{diff}} = \\frac{k}{D/\\ell} = \\frac{k\\ell}{D}$$\n    This number, a form of the Damköhler number, compares the rate of reaction (attachment) to the rate of transport (diffusion).\n    -   If $\\Lambda \\ll 1$, attachment is much slower than diffusion. The process is **attachment-limited**. Adatoms quickly cross the terrace, but \"queue up\" at the step, resulting in a nearly uniform adatom concentration.\n    -   If $\\Lambda \\gg 1$, attachment is much faster than diffusion. The process is **diffusion-limited**. Adatoms are incorporated as soon as they arrive at the step, so the bottleneck is the time it takes to diffuse across the terrace. This creates a significant concentration gradient.\n\n4.  **Numerical Evaluation**: We are given:\n    -   $k = 100\\,\\mathrm{cm/s}$\n    -   $\\ell = 50\\,\\mathrm{nm} = 50 \\times 10^{-7}\\,\\mathrm{cm} = 5 \\times 10^{-6}\\,\\mathrm{cm}$\n    -   $D = 10^{-6}\\,\\mathrm{cm^2/s}$\n    The adatom lifetime $\\tau=1\\,\\mathrm{s}$ is not needed for this comparison but can be used to confirm that desorption is not the dominant process. The diffusion length is $\\lambda_D = \\sqrt{D\\tau} = \\sqrt{10^{-6} \\cdot 1} = 10^{-3}\\,\\mathrm{cm} = 10\\,\\mu\\mathrm{m}$. Since $\\ell=50\\,\\mathrm{nm} \\ll \\lambda_D=10\\,\\mu\\mathrm{m}$, neglecting desorption for this comparison is justified.\n\n    Now, we calculate $\\Lambda$:\n    $$\\Lambda = \\frac{(100\\,\\mathrm{cm/s}) \\times (5 \\times 10^{-6}\\,\\mathrm{cm})}{10^{-6}\\,\\mathrm{cm^2/s}} = \\frac{500 \\times 10^{-6}\\,\\mathrm{cm^2/s}}{10^{-6}\\,\\mathrm{cm^2/s}} = 500$$\n    The value is dimensionless, as expected.\n\n5.  **Conclusion**: The calculated value is $\\Lambda = 500$. Since $\\Lambda \\gg 1$, the growth is strongly **diffusion-limited**. The reportable value rounded to three significant figures and in scientific notation is $5.00 \\times 10^2$.",
            "answer": "$$\n\\boxed{5.00 \\times 10^2}\n$$"
        },
        {
            "introduction": "Moving from conceptual understanding to predictive modeling is a vital step in process engineering. While analytical models provide immense insight, numerical solvers are essential for handling the complexities of real-world growth conditions. In this comprehensive exercise, you will synthesize the concepts of terrace diffusion, desorption, and kinetic boundary conditions to build a finite-difference solver from first principles. This practice will equip you with the skills to translate the BCF theoretical framework into a powerful computational tool for simulating adatom concentration profiles on semiconductor surfaces .",
            "id": "4111625",
            "problem": "You are tasked with building a numerical solver grounded in the Burton–Cabrera–Frank (BCF) step-flow model for terrace kinetics in semiconductor manufacturing. Starting from the steady-state adatom balance on a terrace, the continuum description enforces adatom diffusion with deposition and desorption, coupled to kinetic exchange at steps. The governing law for the adatom concentration $c(x)$ on a single terrace of width $L$ is a one-dimensional steady diffusion-reaction equation, with Robin (mixed) boundary conditions at the left and right steps representing linear kinetic exchange. Your task is to derive a finite-difference scheme from first principles and implement it to compute the concentration profile $c(x)$ across many terraces. To achieve universal applicability and remove physical units, you must work in a dimensionless formulation.\n\nUse the following context-appropriate fundamental base:\n- The terrace diffusion equation under steady-state deposition $F$ and desorption lifetime $\\tau$ is given by $D \\,\\dfrac{d^2 c}{dx^2} - \\dfrac{c}{\\tau} + F = 0$, where $D$ is the adatom diffusivity.\n- The Robin boundary condition at the left step ($x=0$) is $-D \\,\\dfrac{dc}{dx}\\big|_{x=0} = k_+ \\left(c(0) - c_{\\mathrm{eq}}\\right)$ and at the right step ($x=L$) is $D \\,\\dfrac{dc}{dx}\\big|_{x=L} = k_- \\left(c(L) - c_{\\mathrm{eq}}\\right)$, where $k_+$ and $k_-$ are kinetic coefficients and $c_{\\mathrm{eq}}$ is the local equilibrium concentration at the step.\n- Non-dimensionalize the system using the diffusion length $\\ell = \\sqrt{D \\tau}$, the scaled position $s = x/\\ell$, and the scaled concentration $\\varphi(s) = c(x) / (F \\tau)$. Define the dimensionless terrace width $\\Lambda = L/\\ell$, the dimensionless equilibrium $\\varphi_{\\mathrm{eq}} = c_{\\mathrm{eq}}/(F \\tau)$, and the dimensionless kinetic coefficients $\\kappa_+ = k_+ \\sqrt{\\tau/D}$ and $\\kappa_- = k_- \\sqrt{\\tau/D}$. In these variables, the steady-state equation becomes $\\dfrac{d^2 \\varphi}{ds^2} - \\varphi + 1 = 0$ on $s \\in [0,\\Lambda]$, with boundary conditions $-\\dfrac{d\\varphi}{ds}\\big|_{s=0} = \\kappa_+ \\left(\\varphi(0) - \\varphi_{\\mathrm{eq}}\\right)$ and $\\dfrac{d\\varphi}{ds}\\big|_{s=\\Lambda} = \\kappa_- \\left(\\varphi(\\Lambda) - \\varphi_{\\mathrm{eq}}\\right)$.\n\nYour program must:\n- Formulate a second-order accurate finite-difference scheme on a uniform grid for the dimensionless boundary value problem $\\dfrac{d^2 \\varphi}{ds^2} - \\varphi + 1 = 0$ on $[0,\\Lambda]$, with Robin boundary conditions at $s=0$ and $s=\\Lambda$.\n- Solve the resulting linear system for $\\varphi(s)$ on each terrace independently.\n- For each terrace, compute and return:\n  1. The terrace-averaged dimensionless concentration $\\overline{\\varphi} = \\dfrac{1}{N+1} \\sum_{j=0}^{N} \\varphi_j$, where $N$ is the number of subintervals (so there are $N+1$ grid points).\n  2. The dimensionless step fluxes at $s=0$ and $s=\\Lambda$, defined by $J^{\\mathrm{hat}}_{\\mathrm{left}} = -\\dfrac{d\\varphi}{ds}\\big|_{s=0}$ and $J^{\\mathrm{hat}}_{\\mathrm{right}} = \\dfrac{d\\varphi}{ds}\\big|_{s=\\Lambda}$. By the boundary conditions, these can be computed as $J^{\\mathrm{hat}}_{\\mathrm{left}} = \\kappa_+ \\left(\\varphi(0) - \\varphi_{\\mathrm{eq}}\\right)$ and $J^{\\mathrm{hat}}_{\\mathrm{right}} = \\kappa_- \\left(\\varphi(\\Lambda) - \\varphi_{\\mathrm{eq}}\\right)$.\n\nYour finite-difference scheme must be constructed without using any pre-derived shortcut formulas for the final discrete system. Use a uniform grid $s_j = j h$ for $j = 0,1,\\ldots,N$ with spacing $h = \\Lambda/N$. Discretize the interior using a second-order central difference for the second derivative and a second-order one-sided difference for the boundary derivatives when enforcing the Robin boundary conditions.\n\nImplement the solver for many terraces and validate it using the following test suite. Each test case provides arrays defining multiple terraces. For each terrace, use the specified number of subintervals $N$ (giving $N+1$ grid points). All outputs are dimensionless, so no physical units are required.\n\nTest Suite:\n- Test Case $1$ (general symmetric kinetics):\n  - $\\Lambda$ values: $[0.5, 1.0, 2.0, 3.0]$\n  - $\\kappa_+$ values: $[1.0, 1.0, 1.0, 1.0]$\n  - $\\kappa_-$ values: $[1.0, 1.0, 1.0, 1.0]$\n  - $\\varphi_{\\mathrm{eq}} = 0.0$\n  - $N$ values: $[50, 50, 50, 50]$\n- Test Case $2$ (asymmetric kinetics and narrow terraces):\n  - $\\Lambda$ values: $[0.1, 0.3, 0.5]$\n  - $\\kappa_+$ values: $[0.01, 0.01, 0.01]$\n  - $\\kappa_-$ values: $[100.0, 100.0, 100.0]$\n  - $\\varphi_{\\mathrm{eq}} = 0.0$\n  - $N$ values: $[20, 30, 40]$\n- Test Case $3$ (nonzero equilibrium and strong kinetics):\n  - $\\Lambda$ values: $[1.0, 2.0, 1.5]$\n  - $\\kappa_+$ values: $[10.0, 10.0, 10.0]$\n  - $\\kappa_-$ values: $[10.0, 10.0, 10.0]$\n  - $\\varphi_{\\mathrm{eq}} = 0.2$\n  - $N$ values: $[60, 80, 70]$\n\nOutput Specification:\n- For each test case, produce a list whose entries correspond to terraces, in the same order as provided. Each terrace’s entry must be a list of three floats: $[\\overline{\\varphi}, J^{\\mathrm{hat}}_{\\mathrm{left}}, J^{\\mathrm{hat}}_{\\mathrm{right}}]$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with no spaces. The global structure is a list of the three test case results, for example: $[[0.1,0.2,0.3],[0.4,0.5,0.6],[0.7,0.8,0.9]]$ but following the nested format where each inner item is itself a list of three floats per terrace.\n\nYour implementation must be entirely self-contained and must not require any input from the user. All computations and outputs are dimensionless, so no physical units are used or required. Angles are not involved.",
            "solution": "The problem requires the numerical solution of a one-dimensional, steady-state, dimensionless boundary value problem (BVP) that models adatom concentration on a semiconductor terrace, based on the Burton–Cabrera–Frank (BCF) theory.\n\nThe governing dimensionless equation for the scaled adatom concentration $\\varphi(s)$ on a terrace of scaled width $\\Lambda$ is:\n$$\n\\dfrac{d^2 \\varphi}{ds^2} - \\varphi + 1 = 0 \\quad \\text{for } s \\in [0, \\Lambda]\n$$\nThis is subject to Robin (mixed) boundary conditions at the terrace edges, $s=0$ and $s=\\Lambda$:\n$$\n-\\dfrac{d\\varphi}{ds}\\bigg|_{s=0} = \\kappa_+ \\left(\\varphi(0) - \\varphi_{\\mathrm{eq}}\\right)\n$$\n$$\n\\dfrac{d\\varphi}{ds}\\bigg|_{s=\\Lambda} = \\kappa_- \\left(\\varphi(\\Lambda) - \\varphi_{\\mathrm{eq}}\\right)\n$$\nwhere $\\kappa_+$ and $\\kappa_-$ are dimensionless kinetic coefficients and $\\varphi_{\\mathrm{eq}}$ is the dimensionless equilibrium concentration.\n\nWe will solve this BVP using a second-order accurate finite-difference method.\n\n**1. Discretization**\n\nFirst, we discretize the spatial domain $s \\in [0, \\Lambda]$ into a uniform grid. The domain is divided into $N$ subintervals of equal width $h$, yielding $N+1$ grid points $s_j = j h$ for $j = 0, 1, \\ldots, N$. The grid spacing is $h = \\Lambda/N$. We denote the numerical approximation of $\\varphi(s_j)$ as $\\varphi_j$.\n\n**2. Finite-Difference Approximation for Interior Points**\n\nFor any interior grid point $s_j$ where $j \\in \\{1, 2, \\ldots, N-1\\}$, we approximate the second derivative $\\dfrac{d^2\\varphi}{ds^2}$ using a second-order central difference formula:\n$$\n\\dfrac{d^2\\varphi}{ds^2}\\bigg|_{s_j} \\approx \\dfrac{\\varphi_{j-1} - 2\\varphi_j + \\varphi_{j+1}}{h^2}\n$$\nSubstituting this into the governing differential equation gives a discrete equation for each interior point:\n$$\n\\dfrac{\\varphi_{j-1} - 2\\varphi_j + \\varphi_{j+1}}{h^2} - \\varphi_j + 1 = 0\n$$\nMultiplying by $h^2$ and rearranging terms to group the unknown variables $\\varphi_j$ yields a linear algebraic equation:\n$$\n\\varphi_{j-1} - (2 + h^2)\\varphi_j + \\varphi_{j+1} = -h^2 \\quad \\text{for } j = 1, 2, \\ldots, N-1\n$$\nThis provides $N-1$ equations for the $N+1$ unknown concentrations $\\{\\varphi_0, \\varphi_1, \\ldots, \\varphi_N\\}$. Two additional equations are required, which we derive from the boundary conditions.\n\n**3. Finite-Difference Approximation for Boundary Conditions**\n\nThe problem specifies the use of second-order one-sided finite-difference formulas for the first derivative at the boundaries.\n\nAt the left boundary, $s=s_0=0$:\nThe derivative $\\dfrac{d\\varphi}{ds}\\big|_{s_0}$ is approximated using a second-order forward difference formula, which requires three points:\n$$\n\\dfrac{d\\varphi}{ds}\\bigg|_{s_0} \\approx \\dfrac{-3\\varphi_0 + 4\\varphi_1 - \\varphi_2}{2h}\n$$\nSubstituting this into the left boundary condition $-\\dfrac{d\\varphi}{ds}\\big|_{s_0} = \\kappa_+ (\\varphi_0 - \\varphi_{\\mathrm{eq}})$:\n$$\n-\\left(\\dfrac{-3\\varphi_0 + 4\\varphi_1 - \\varphi_2}{2h}\\right) = \\kappa_+ (\\varphi_0 - \\varphi_{\\mathrm{eq}})\n$$\n$$\n3\\varphi_0 - 4\\varphi_1 + \\varphi_2 = 2h\\kappa_+ (\\varphi_0 - \\varphi_{\\mathrm{eq}})\n$$\nRearranging to group the unknowns gives the first equation of our linear system:\n$$\n(3 - 2h\\kappa_+)\\varphi_0 - 4\\varphi_1 + \\varphi_2 = -2h\\kappa_+\\varphi_{\\mathrm{eq}}\n$$\n\nAt the right boundary, $s=s_N=\\Lambda$:\nThe derivative $\\dfrac{d\\varphi}{ds}\\big|_{s_N}$ is approximated using a second-order backward difference formula:\n$$\n\\dfrac{d\\varphi}{ds}\\bigg|_{s_N} \\approx \\dfrac{3\\varphi_N - 4\\varphi_{N-1} + \\varphi_{N-2}}{2h}\n$$\nSubstituting this into the right boundary condition $\\dfrac{d\\varphi}{ds}\\big|_{s_N} = \\kappa_- (\\varphi_N - \\varphi_{\\mathrm{eq}})$:\n$$\n\\dfrac{3\\varphi_N - 4\\varphi_{N-1} + \\varphi_{N-2}}{2h} = \\kappa_- (\\varphi_N - \\varphi_{\\mathrm{eq}})\n$$\n$$\n\\varphi_{N-2} - 4\\varphi_{N-1} + 3\\varphi_N = 2h\\kappa_- (\\varphi_N - \\varphi_{\\mathrm{eq}})\n$$\nRearranging gives the final equation of our linear system:\n$$\n\\varphi_{N-2} - 4\\varphi_{N-1} + (3 - 2h\\kappa_-)\\varphi_N = -2h\\kappa_-\\varphi_{\\mathrm{eq}}\n$$\n\n**4. The Linear System of Equations**\n\nBy combining the equations for the interior points and the two boundary points, we form a system of $N+1$ linear equations for the $N+1$ unknowns $\\vec{\\varphi} = [\\varphi_0, \\varphi_1, \\ldots, \\varphi_N]^T$. This system can be written in matrix form as $A\\vec{\\varphi} = \\vec{b}$.\n\nThe matrix $A$ is an $(N+1) \\times (N+1)$ matrix with the following non-zero entries:\n- For row $j=0$:\n$A_{0,0} = 3 - 2h\\kappa_+$, $A_{0,1} = -4$, $A_{0,2} = 1$\n- For rows $j = 1, \\ldots, N-1$:\n$A_{j,j-1} = 1$, $A_{j,j} = -(2+h^2)$, $A_{j,j+1} = 1$\n- For row $j=N$:\n$A_{N,N-2} = 1$, $A_{N,N-1} = -4$, $A_{N,N} = 3 - 2h\\kappa_-$\n\nThe vector $\\vec{b}$ is an $(N+1) \\times 1$ column vector with the following entries:\n- For row $j=0$: $b_0 = -2h\\kappa_+\\varphi_{\\mathrm{eq}}$\n- For rows $j = 1, \\ldots, N-1$: $b_j = -h^2$\n- For row $j=N$: $b_N = -2h\\kappa_-\\varphi_{\\mathrm{eq}}$\n\nThis linear system can be solved using standard numerical linear algebra methods to find the vector of concentrations $\\vec{\\varphi}$.\n\n**5. Calculation of Output Quantities**\n\nOnce the solution vector $\\vec{\\varphi}$ is obtained, we can compute the required output metrics for each terrace:\n1.  The terrace-averaged dimensionless concentration $\\overline{\\varphi}$, calculated using a discrete average over the grid points:\n    $$\n    \\overline{\\varphi} = \\dfrac{1}{N+1} \\sum_{j=0}^{N} \\varphi_j\n    $$\n2.  The dimensionless step fluxes, which can be computed directly from the boundary conditions and the now-known boundary concentrations $\\varphi_0$ and $\\varphi_N$:\n    $$\n    J^{\\mathrm{hat}}_{\\mathrm{left}} = \\kappa_+ (\\varphi_0 - \\varphi_{\\mathrm{eq}})\n    $$\n    $$\n    J^{\\mathrm{hat}}_{\\mathrm{right}} = \\kappa_- (\\varphi_N - \\varphi_{\\mathrm{eq}})\n    $$\n\nThe implemented numerical solver will execute this procedure for each set of terrace parameters provided in the test suite.",
            "answer": "```python\nimport numpy as np\n\ndef solve_terrace(Lambda, kappa_p, kappa_m, phi_eq, N):\n    \"\"\"\n    Solves the BCF dimensionless BVP for a single terrace using a finite-difference scheme.\n    \n    Args:\n        Lambda (float): Dimensionless terrace width.\n        kappa_p (float): Dimensionless kinetic coefficient at s=0.\n        kappa_m (float): Dimensionless kinetic coefficient at s=Lambda.\n        phi_eq (float): Dimensionless equilibrium concentration.\n        N (int): Number of subintervals for the grid.\n\n    Returns:\n        list: A list of three floats: [average_concentration, left_flux, right_flux].\n    \"\"\"\n    # N is the number of subintervals, so there are N+1 grid points.\n    num_points = N + 1\n    h = Lambda / N\n    h2 = h * h\n\n    # Initialize the matrix A and vector b for the linear system A*phi = b\n    A = np.zeros((num_points, num_points))\n    b = np.zeros(num_points)\n\n    # --- Populate the matrix A and vector b ---\n\n    # Equation for the first row (j=0), from the left boundary condition\n    # (3 - 2*h*kappa_p)*phi_0 - 4*phi_1 + phi_2 = -2*h*kappa_p*phi_eq\n    A[0, 0] = 3.0 - 2.0 * h * kappa_p\n    A[0, 1] = -4.0\n    if num_points > 2:\n        A[0, 2] = 1.0\n    b[0] = -2.0 * h * kappa_p * phi_eq\n\n    # Equations for interior rows (j=1 to N-1) from the governing DE\n    # phi_{j-1} - (2 + h^2)*phi_j + phi_{j+1} = -h^2\n    for j in range(1, N):\n        A[j, j - 1] = 1.0\n        A[j, j] = -(2.0 + h2)\n        A[j, j + 1] = 1.0\n        b[j] = -h2\n\n    # Equation for the last row (j=N), from the right boundary condition\n    # phi_{N-2} - 4*phi_{N-1} + (3 - 2*h*kappa_m)*phi_N = -2*h*kappa_m*phi_eq\n    if num_points > 2:\n        A[N, N - 2] = 1.0\n    # The smallest N in test cases is 20, so N-1 and N-2 indices are always valid.\n    A[N, N - 1] = -4.0\n    A[N, N] = 3.0 - 2.0 * h * kappa_m\n    b[N] = -2.0 * h * kappa_m * phi_eq\n    \n    # Solve the linear system for phi\n    try:\n        phi_vec = np.linalg.solve(A, b)\n    except np.linalg.LinAlgError:\n        # This should not happen for a well-posed problem.\n        # Return NaNs as a signal of failure.\n        return [np.nan, np.nan, np.nan]\n\n    # --- Calculate output quantities ---\n    \n    # 1. Terrace-averaged dimensionless concentration\n    avg_phi = np.mean(phi_vec)\n    \n    # 2. Dimensionless step fluxes\n    J_left = kappa_p * (phi_vec[0] - phi_eq)\n    J_right = kappa_m * (phi_vec[-1] - phi_eq)\n    \n    return [avg_phi, J_left, J_right]\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the final results.\n    \"\"\"\n    test_cases = [\n        # Test Case 1: general symmetric kinetics\n        {\n            \"Lambda_vals\": [0.5, 1.0, 2.0, 3.0],\n            \"kappa_p_vals\": [1.0, 1.0, 1.0, 1.0],\n            \"kappa_m_vals\": [1.0, 1.0, 1.0, 1.0],\n            \"phi_eq\": 0.0,\n            \"N_vals\": [50, 50, 50, 50],\n        },\n        # Test Case 2: asymmetric kinetics and narrow terraces\n        {\n            \"Lambda_vals\": [0.1, 0.3, 0.5],\n            \"kappa_p_vals\": [0.01, 0.01, 0.01],\n            \"kappa_m_vals\": [100.0, 100.0, 100.0],\n            \"phi_eq\": 0.0,\n            \"N_vals\": [20, 30, 40],\n        },\n        # Test Case 3: nonzero equilibrium and strong kinetics\n        {\n            \"Lambda_vals\": [1.0, 2.0, 1.5],\n            \"kappa_p_vals\": [10.0, 10.0, 10.0],\n            \"kappa_m_vals\": [10.0, 10.0, 10.0],\n            \"phi_eq\": 0.2,\n            \"N_vals\": [60, 80, 70],\n        }\n    ]\n\n    all_results = []\n    for case_data in test_cases:\n        case_results = []\n        num_terraces = len(case_data[\"Lambda_vals\"])\n        for i in range(num_terraces):\n            Lambda = case_data[\"Lambda_vals\"][i]\n            kappa_p = case_data[\"kappa_p_vals\"][i]\n            kappa_m = case_data[\"kappa_m_vals\"][i]\n            phi_eq = case_data[\"phi_eq\"]\n            N = case_data[\"N_vals\"][i]\n            \n            terrace_result = solve_terrace(Lambda, kappa_p, kappa_m, phi_eq, N)\n            case_results.append(terrace_result)\n        all_results.append(case_results)\n\n    # Format the final output string according to the specification (list of lists, no spaces)\n    output_str = str(all_results).replace(\" \", \"\")\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}