{
    "hands_on_practices": [
        {
            "introduction": "Understanding the concept of Equivalent Oxide Thickness ($t_{\\mathrm{EOT}}$) is the first step in modeling high-κ gate dielectrics. This exercise  grounds this critical industry metric in the fundamental electrostatics of a capacitor. By deriving the relationship between the physical thickness of a high-κ film and its corresponding $t_{\\mathrm{EOT}}$, you will gain direct insight into how materials with high permittivity enable continued transistor scaling.",
            "id": "4130669",
            "problem": "A hafnium dioxide (HfO$_2$) high-permittivity (high-κ) gate dielectric is integrated as a planar film on silicon, and its capacitance is to be modeled from first principles of electrostatics. The gate stack is idealized as a single uniform dielectric layer with relative permittivity $\\kappa$ and no additional series interfacial layers or depletion effects. The Equivalent Oxide Thickness (EOT) is defined as the thickness $t_{\\mathrm{EOT}}$ of silicon dioxide (SiO$_2$) that would produce the same gate capacitance as the actual high-$\\kappa$ layer, when both are treated as parallel-plate capacitors of equal area. Take the relative permittivity of SiO$_2$ to be $\\kappa_{\\mathrm{SiO}_2} = 3.9$, and the target equivalent oxide thickness to be $t_{\\mathrm{EOT}} = 0.8\\,\\mathrm{nm}$. \n\nStarting from the parallel-plate capacitor relation and the definition of Equivalent Oxide Thickness, derive an expression that relates the physical thickness $t_{\\mathrm{phys}}$ of the HfO$_2$ layer to $t_{\\mathrm{EOT}}$, $\\kappa$, and $\\kappa_{\\mathrm{SiO}_2}$. Use this to compute the required $t_{\\mathrm{phys}}$ for HfO$_2$ with $\\kappa = 20$. Then, quantify the sensitivity of $t_{\\mathrm{phys}}$ to uncertainty in $\\kappa$ by deriving the dimensionless first-order relative sensitivity\n$$\nS_{\\mathrm{rel}} = \\frac{\\kappa}{t_{\\mathrm{phys}}}\\,\\frac{d t_{\\mathrm{phys}}}{d \\kappa}\n$$\nevaluated at $\\kappa = 20$.\n\nReport your final answer as a two-entry row matrix containing, in order: the required physical thickness $t_{\\mathrm{phys}}$ in nanometers, rounded to three significant figures, and the dimensionless sensitivity $S_{\\mathrm{rel}}$ as an exact value. Do not include units in the row matrix.",
            "solution": "The capacitance $C$ of a parallel-plate capacitor is given by the formula:\n$$\nC = \\frac{\\epsilon A}{t}\n$$\nwhere $\\epsilon$ is the permittivity of the dielectric material, $A$ is the area of the plates, and $t$ is the thickness of the dielectric layer. The permittivity is related to the relative permittivity (or dielectric constant) $\\kappa$ by $\\epsilon = \\kappa \\epsilon_0$, where $\\epsilon_0$ is the vacuum permittivity.\n\nFor the high-$\\kappa$ gate dielectric ($\\text{HfO}_2$), the capacitance per unit area is:\n$$\n\\frac{C_{\\mathrm{high-}\\kappa}}{A} = \\frac{\\kappa \\epsilon_0}{t_{\\mathrm{phys}}}\n$$\nHere, $\\kappa$ is the relative permittivity of $\\text{HfO}_2$ and $t_{\\mathrm{phys}}$ is its physical thickness.\n\nThe problem defines the Equivalent Oxide Thickness, $t_{\\mathrm{EOT}}$, as the thickness of a silicon dioxide ($\\text{SiO}_2$) layer that would yield the same capacitance per unit area. The capacitance per unit area of this equivalent $\\text{SiO}_2$ layer is:\n$$\n\\frac{C_{\\mathrm{EOT}}}{A} = \\frac{\\kappa_{\\mathrm{SiO}_2} \\epsilon_0}{t_{\\mathrm{EOT}}}\n$$\nwhere $\\kappa_{\\mathrm{SiO}_2}$ is the relative permittivity of $\\text{SiO}_2$.\n\nBy the definition of EOT, these two capacitances per unit area are equal:\n$$\n\\frac{C_{\\mathrm{high-}\\kappa}}{A} = \\frac{C_{\\mathrm{EOT}}}{A}\n$$\nSubstituting the expressions for the capacitances:\n$$\n\\frac{\\kappa \\epsilon_0}{t_{\\mathrm{phys}}} = \\frac{\\kappa_{\\mathrm{SiO}_2} \\epsilon_0}{t_{\\mathrm{EOT}}}\n$$\nThe vacuum permittivity $\\epsilon_0$ cancels out, leaving the core relationship:\n$$\n\\frac{\\kappa}{t_{\\mathrm{phys}}} = \\frac{\\kappa_{\\mathrm{SiO}_2}}{t_{\\mathrm{EOT}}}\n$$\nTo find the expression for $t_{\\mathrm{phys}}$, we rearrange this equation:\n$$\nt_{\\mathrm{phys}} = t_{\\mathrm{EOT}} \\left( \\frac{\\kappa}{\\kappa_{\\mathrm{SiO}_2}} \\right)\n$$\nThis is the first required derived expression. It shows that the physical thickness of the high-$\\kappa$ material is scaled by the ratio of the dielectric constants, relative to the target EOT.\n\nNext, we calculate the required physical thickness $t_{\\mathrm{phys}}$ using the provided numerical values: $t_{\\mathrm{EOT}} = 0.8\\,\\mathrm{nm}$, $\\kappa = 20$, and $\\kappa_{\\mathrm{SiO}_2} = 3.9$.\n$$\nt_{\\mathrm{phys}} = (0.8\\,\\mathrm{nm}) \\left( \\frac{20}{3.9} \\right) = \\frac{16}{3.9}\\,\\mathrm{nm} \\approx 4.10256\\,\\mathrm{nm}\n$$\nRounding to three significant figures, we get:\n$$\nt_{\\mathrm{phys}} \\approx 4.10\\,\\mathrm{nm}\n$$\n\nFinally, we must quantify the sensitivity of $t_{\\mathrm{phys}}$ to variations in $\\kappa$. The dimensionless relative sensitivity $S_{\\mathrm{rel}}$ is defined as:\n$$\nS_{\\mathrm{rel}} = \\frac{\\kappa}{t_{\\mathrm{phys}}}\\,\\frac{d t_{\\mathrm{phys}}}{d \\kappa}\n$$\nTo evaluate this, we first find the derivative of $t_{\\mathrm{phys}}$ with respect to $\\kappa$. Our derived expression for $t_{\\mathrm{phys}}$ is a linear function of $\\kappa$:\n$$\nt_{\\mathrm{phys}}(\\kappa) = \\left( \\frac{t_{\\mathrm{EOT}}}{\\kappa_{\\mathrm{SiO}_2}} \\right) \\kappa\n$$\nSince $t_{\\mathrm{EOT}}$ and $\\kappa_{\\mathrm{SiO}_2}$ are constants, the derivative is:\n$$\n\\frac{d t_{\\mathrm{phys}}}{d \\kappa} = \\frac{t_{\\mathrm{EOT}}}{\\kappa_{\\mathrm{SiO}_2}}\n$$\nNow, we substitute this derivative back into the formula for $S_{\\mathrm{rel}}$:\n$$\nS_{\\mathrm{rel}} = \\frac{\\kappa}{t_{\\mathrm{phys}}} \\left( \\frac{t_{\\mathrm{EOT}}}{\\kappa_{\\mathrm{SiO}_2}} \\right)\n$$\nTo simplify this expression, we can substitute our earlier expression for $t_{\\mathrm{phys}}$:\n$$\nS_{\\mathrm{rel}} = \\frac{\\kappa}{t_{\\mathrm{EOT}} \\left( \\frac{\\kappa}{\\kappa_{\\mathrm{SiO}_2}} \\right)} \\left( \\frac{t_{\\mathrm{EOT}}}{\\kappa_{\\mathrm{SiO}_2}} \\right) = \\left( \\frac{\\kappa}{1} \\cdot \\frac{\\kappa_{\\mathrm{SiO}_2}}{t_{\\mathrm{EOT}} \\cdot \\kappa} \\right) \\left( \\frac{t_{\\mathrm{EOT}}}{\\kappa_{\\mathrm{SiO}_2}} \\right)\n$$\nAll terms cancel out, leaving:\n$$\nS_{\\mathrm{rel}} = 1\n$$\nThe relative sensitivity $S_{\\mathrm{rel}}$ is exactly $1$. This result is independent of the value of $\\kappa$ and means that a small fractional change in the dielectric constant $\\kappa$ leads to an equal fractional change in the required physical thickness $t_{\\mathrm{phys}}$, which is expected from their direct proportionality.\n\nThe final answer is a two-entry row matrix containing the calculated physical thickness ($4.10\\,\\mathrm{nm}$) and the sensitivity ($1$).",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 4.10  1 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "Beyond the ideal properties of a material, its integration into a manufacturing process presents significant challenges, with film uniformity being paramount. This practice  moves from static device physics to the dynamic world of Chemical Vapor Deposition (CVD) reactor modeling. You will apply principles of fluid dynamics and mass transport to build a computational model that predicts thickness non-uniformity across a wafer, providing a tangible link between process conditions and final device quality.",
            "id": "4130576",
            "problem": "Consider a horizontal flow reactor used to deposit a high-dielectric-constant (high-κ) gate dielectric such as hafnium dioxide on a circular wafer. Model the wafer as a flat plate of length $L$ aligned with a uniform gas flow of speed $u$ along the $x$-direction. The gas contains a reactive precursor at bulk molar concentration $C_{\\infty}$, with kinematic viscosity $\\nu$ and molecular diffusion coefficient $D$ for the precursor in the carrier gas. Assume steady, two-dimensional, laminar external flow over the plate and that the surface reaction is fast enough to keep the surface concentration effectively zero, so deposition is limited by mass transfer through the developing boundary layer.\n\nUse the following fundamental bases:\n- Fick's First Law of Diffusion: the molar flux normal to the surface is $J = -D \\,\\partial C / \\partial y$ at the wall.\n- The Reynolds number (Re) and the Schmidt number (Sc) are defined as $Re_x = u x / \\nu$ and $Sc = \\nu / D$, respectively, for position $x$ along the plate.\n- Relate the local mass transfer coefficient $k_m(x)$ to the Sherwood number (Sh) by $Sh_x = k_m(x) \\, x / D$. Use an appropriate, widely accepted correlation for laminar external flow over a flat plate with constant surface concentration to obtain $k_m(x)$ from $Re_x$ and $Sc$.\n\nThe thickness growth is obtained by converting molar flux to a thickness rate using the deposited solid’s molar mass $M_s$ and mass density $\\rho$:\n- The mass flux is $J(x) \\, M_s$ in $\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$.\n- The thickness rate is $\\dot{h}(x) = \\dfrac{J(x) \\, M_s}{\\rho}$ in $\\mathrm{m}\\,\\mathrm{s}^{-1}$.\n- For a deposition time $t$, the thickness at position $x$ is $h(x) = \\dot{h}(x) \\, t$.\n\nTo avoid the mathematical singularity at the leading edge $x=0$ that arises in idealized boundary-layer correlations, regularize the model by introducing a small positive entrance length offset $x_0$. Evaluate the local mass transfer coefficient using an effective distance $x_{\\mathrm{eff}} = \\max(x, x_0)$.\n\nTask:\n1. Derive, from the stated bases, an explicit expression for the local mass transfer coefficient $k_m(x)$ as a function of $u$, $D$, $\\nu$, and $x$ under laminar, developing boundary layer conditions.\n2. Using $k_m(x)$, compute the local molar flux $J(x)$, convert it to a thickness $h(x)$ over time $t$, and discretize the wafer along the flow direction into $N$ equally spaced sample points at mid-intervals $x_i = L \\left(i + \\tfrac{1}{2}\\right)/N$ for $i=0,1,\\dots,N-1$. Use $x_{\\mathrm{eff},i} = \\max(x_i, x_0)$ in $k_m$.\n3. Compute the arithmetic mean thickness $h_{\\mathrm{mean}}$ across the $N$ samples, the minimum thickness $h_{\\min}$, and the maximum thickness $h_{\\max}$. Define the nonuniformity metric as the decimal $U = \\dfrac{h_{\\max} - h_{\\min}}{h_{\\mathrm{mean}}}$.\n4. Express the mean thickness in nanometers and the nonuniformity as a dimensionless decimal. Round each reported value to six decimal places.\n\nTest suite:\nFor each of the following parameter sets, compute $h_{\\mathrm{mean}}$ in nanometers and $U$.\n\n- Case A (general happy path):\n    - $L = 0.300 \\,\\mathrm{m}$,\n    - $u = 1.000 \\,\\mathrm{m}\\,\\mathrm{s}^{-1}$,\n    - $\\nu = 1.60 \\times 10^{-5} \\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$,\n    - $D = 6.00 \\times 10^{-5} \\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$,\n    - $C_{\\infty} = 0.0020 \\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$,\n    - $t = 90 \\,\\mathrm{s}$,\n    - $M_s = 0.2105 \\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}$,\n    - $\\rho = 9680 \\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$,\n    - $x_0 = 0.002 \\,\\mathrm{m}$,\n    - $N = 200$.\n\n- Case B (preconditioned entrance, high diffusivity):\n    - $L = 0.300 \\,\\mathrm{m}$,\n    - $u = 0.700 \\,\\mathrm{m}\\,\\mathrm{s}^{-1}$,\n    - $\\nu = 1.50 \\times 10^{-5} \\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$,\n    - $D = 2.00 \\times 10^{-4} \\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$,\n    - $C_{\\infty} = 0.0015 \\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$,\n    - $t = 120 \\,\\mathrm{s}$,\n    - $M_s = 0.2105 \\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}$,\n    - $\\rho = 9680 \\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$,\n    - $x_0 = 0.020 \\,\\mathrm{m}$,\n    - $N = 200$.\n\n- Case C (edge case with very low flow and low diffusivity):\n    - $L = 0.200 \\,\\mathrm{m}$,\n    - $u = 0.050 \\,\\mathrm{m}\\,\\mathrm{s}^{-1}$,\n    - $\\nu = 1.50 \\times 10^{-5} \\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$,\n    - $D = 1.00 \\times 10^{-5} \\,\\mathrm{m}^2\\,\\mathrm{s}^{-1}$,\n    - $C_{\\infty} = 0.0030 \\,\\mathrm{mol}\\,\\mathrm{m}^{-3}$,\n    - $t = 60 \\,\\mathrm{s}$,\n    - $M_s = 0.2105 \\,\\mathrm{kg}\\,\\mathrm{mol}^{-1}$,\n    - $\\rho = 9680 \\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$,\n    - $x_0 = 0.001 \\,\\mathrm{m}$,\n    - $N = 200$.\n\nFinal output format:\nYour program should produce a single line of output containing the results for the three cases, as a comma-separated list of lists with each inner list holding the mean thickness in nanometers and the nonuniformity decimal, both rounded to six decimal places. For example:\n[[h_mean_caseA,U_caseA],[h_mean_caseB,U_caseB],[h_mean_caseC,U_caseC]]",
            "solution": "We model a high-dielectric-constant (high-κ) gate dielectric deposition under laminar external flow over a flat plate. The local molar flux is governed by Fick’s First Law of Diffusion, $J = -D \\, \\partial C / \\partial y$, and under a convective boundary layer the gradient at the wall is commonly expressed through a mass transfer coefficient $k_m(x)$ via $J(x) = k_m(x) \\left(C_{\\infty} - C_s\\right)$. With fast surface reaction, the surface concentration satisfies $C_s \\approx 0$, so $J(x) \\approx k_m(x) C_{\\infty}$.\n\nTo obtain $k_m(x)$ for laminar flow over a flat plate, we use the widely accepted laminar correlation for the local Sherwood number (Sh) under constant wall concentration in forced convection, which mirrors the form of the local Nusselt number in heat transfer. The correlation is\n$$\nSh_x = a \\, Re_x^{1/2} \\, Sc^{1/3},\n$$\nwhere $a = 0.332$ is the constant for the local value, $Re_x = \\dfrac{u x}{\\nu}$ is the Reynolds number (Re) based on distance $x$, and $Sc = \\dfrac{\\nu}{D}$ is the Schmidt number (Sc). This correlation is a well-tested empirical result derived from boundary layer theory (e.g., the Blasius solution and its analogs) and validated for laminar, external flow when $Re_x$ is below the laminar-turbulent transition threshold and the surface concentration is uniform.\n\nThe mass transfer coefficient relates to the Sherwood number via\n$$\nSh_x = \\frac{k_m(x) \\, x}{D}.\n$$\nSolving for $k_m(x)$ and substituting the correlation yields\n$$\nk_m(x) = \\frac{Sh_x \\, D}{x} = \\frac{a \\, D}{x} \\left( \\frac{u x}{\\nu} \\right)^{1/2} \\left( \\frac{\\nu}{D} \\right)^{1/3}.\n$$\nThis simplifies to\n$$\nk_m(x) = a \\, u^{1/2} \\, D^{2/3} \\, \\nu^{-1/6} \\, x^{-1/2}.\n$$\nThe form $k_m(x) \\propto x^{-1/2}$ reflects the thinning of the concentration boundary layer with increasing distance while considering the developing laminar boundary layer. The correlation is singular at $x \\to 0$, which is a mathematical artifact of the idealized boundary layer start at an infinitesimally thin leading edge. In real reactors, upstream flow conditioning, entrance effects, and finite plate thickness remove this singularity. To regularize the model, we introduce a finite entrance offset $x_0  0$, and evaluate an effective local distance\n$$\nx_{\\mathrm{eff}} = \\max(x, x_0).\n$$\nThus, the working expression is\n$$\nk_m(x) = a \\, u^{1/2} \\, D^{2/3} \\, \\nu^{-1/6} \\, x_{\\mathrm{eff}}^{-1/2}, \\quad a = 0.332.\n$$\n\nWith this $k_m(x)$, the local molar flux is\n$$\nJ(x) = k_m(x) \\, C_{\\infty} = a \\, u^{1/2} \\, D^{2/3} \\, \\nu^{-1/6} \\, x_{\\mathrm{eff}}^{-1/2} \\, C_{\\infty}.\n$$\nWe convert the molar flux to a thickness rate using the molar mass $M_s$ of the deposited solid and its density $\\rho$:\n$$\n\\dot{h}(x) = \\frac{J(x) \\, M_s}{\\rho} = \\frac{a \\, u^{1/2} \\, D^{2/3} \\, \\nu^{-1/6} \\, x_{\\mathrm{eff}}^{-1/2} \\, C_{\\infty} \\, M_s}{\\rho}.\n$$\nFor a constant deposition time $t$, the local thickness is\n$$\nh(x) = \\dot{h}(x) \\, t = \\frac{a \\, u^{1/2} \\, D^{2/3} \\, \\nu^{-1/6} \\, x_{\\mathrm{eff}}^{-1/2} \\, C_{\\infty} \\, M_s}{\\rho} \\, t.\n$$\n\nTo evaluate wafer-scale nonuniformity, discretize the plate along the flow direction using $N$ equally spaced sample points at mid-intervals:\n$$\nx_i = L \\, \\frac{i + \\frac{1}{2}}{N}, \\quad i = 0, 1, \\dots, N-1,\n$$\nand compute\n$$\nx_{\\mathrm{eff}, i} = \\max(x_i, x_0), \\quad h_i = \\frac{a \\, u^{1/2} \\, D^{2/3} \\, \\nu^{-1/6} \\, x_{\\mathrm{eff}, i}^{-1/2} \\, C_{\\infty} \\, M_s}{\\rho} \\, t.\n$$\nConvert $h_i$ from meters to nanometers by multiplying by $10^9$. The mean thickness, minimum and maximum thickness across the $N$ points are\n$$\nh_{\\mathrm{mean}} = \\frac{1}{N} \\sum_{i=0}^{N-1} h_i, \\quad h_{\\min} = \\min_i h_i, \\quad h_{\\max} = \\max_i h_i,\n$$\nand the nonuniformity is\n$$\nU = \\frac{h_{\\max} - h_{\\min}}{h_{\\mathrm{mean}}}.\n$$\nWe report $h_{\\mathrm{mean}}$ in nanometers and $U$ as a dimensionless decimal, each rounded to six decimals.\n\nAlgorithmic steps for each test case:\n1. Read $L$, $u$, $\\nu$, $D$, $C_{\\infty}$, $t$, $M_s$, $\\rho$, $x_0$, and $N$.\n2. Precompute constants $a = 0.332$, $u^{1/2}$, $D^{2/3}$, and $\\nu^{-1/6}$.\n3. Generate $N$ mid-interval positions $x_i$ and compute $x_{\\mathrm{eff}, i}$.\n4. Compute $k_m(x_i)$, $J(x_i)$, and $h_i$ in meters, then convert to nanometers.\n5. Compute $h_{\\mathrm{mean}}$, $h_{\\min}$, $h_{\\max}$, and $U$.\n6. Round $h_{\\mathrm{mean}}$ and $U$ to six decimal places.\n7. Output the results in the prescribed single-line format as a list of pairs for the three cases.\n\nThe laminar assumptions are validated by $Re_L = u L / \\nu$ remaining well below typical external-flow transition thresholds. The regularization $x_0$ avoids nonphysical divergence at the leading edge and represents realistic entrance conditioning in industrial reactors. This principled derivation integrates fundamental transport laws with empirically validated laminar boundary layer correlations to produce a computationally tractable model of thickness nonuniformity due to mass transfer limitations in high-κ gate dielectric deposition.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_nonuniformity(L, u, nu, D, C_inf, t, M_s, rho, x0, N):\n    \"\"\"\n    Compute mean thickness (nm) and nonuniformity U across a wafer modeled\n    as a flat plate of length L in laminar external flow with developing boundary layer.\n    \"\"\"\n    a = 0.332  # Local Sherwood correlation constant for laminar flat-plate, constant wall concentration\n\n    # Precompute constants for efficiency\n    u_sqrt = np.sqrt(u)\n    D_two_thirds = D ** (2.0 / 3.0)\n    nu_minus_one_sixth = nu ** (-1.0 / 6.0)\n\n    # Mid-interval sampling along the plate\n    i = np.arange(N)\n    x = L * (i + 0.5) / N\n    x_eff = np.maximum(x, x0)\n\n    # Local mass transfer coefficient km(x) = a * u^{1/2} * D^{2/3} * nu^{-1/6} * x_eff^{-1/2}\n    km = a * u_sqrt * D_two_thirds * nu_minus_one_sixth * (x_eff ** -0.5)\n\n    # Molar flux J(x) = km * C_inf\n    J = km * C_inf  # mol/m^2/s\n\n    # Thickness rate (m/s): dot{h} = J * M_s / rho; thickness h = dot{h} * t\n    h_m = (J * M_s / rho) * t  # meters\n\n    # Convert to nanometers\n    h_nm = h_m * 1e9\n\n    h_mean = float(np.mean(h_nm))\n    h_min = float(np.min(h_nm))\n    h_max = float(np.max(h_nm))\n    U = (h_max - h_min) / h_mean if h_mean != 0.0 else float('nan')\n\n    return h_mean, U\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case is a dict with the necessary parameters.\n    test_cases = [\n        # Case A (general happy path)\n        {\n            \"L\": 0.300,           # m\n            \"u\": 1.000,           # m/s\n            \"nu\": 1.60e-5,        # m^2/s\n            \"D\": 6.00e-5,         # m^2/s\n            \"C_inf\": 0.0020,      # mol/m^3\n            \"t\": 90.0,            # s\n            \"M_s\": 0.2105,        # kg/mol (HfO2 approx)\n            \"rho\": 9680.0,        # kg/m^3\n            \"x0\": 0.002,          # m\n            \"N\": 200\n        },\n        # Case B (preconditioned entrance, high diffusivity)\n        {\n            \"L\": 0.300,           # m\n            \"u\": 0.700,           # m/s\n            \"nu\": 1.50e-5,        # m^2/s\n            \"D\": 2.00e-4,         # m^2/s\n            \"C_inf\": 0.0015,      # mol/m^3\n            \"t\": 120.0,           # s\n            \"M_s\": 0.2105,        # kg/mol\n            \"rho\": 9680.0,        # kg/m^3\n            \"x0\": 0.020,          # m\n            \"N\": 200\n        },\n        # Case C (edge case with very low flow and low diffusivity)\n        {\n            \"L\": 0.200,           # m\n            \"u\": 0.050,           # m/s\n            \"nu\": 1.50e-5,        # m^2/s\n            \"D\": 1.00e-5,         # m^2/s\n            \"C_inf\": 0.0030,      # mol/m^3\n            \"t\": 60.0,            # s\n            \"M_s\": 0.2105,        # kg/mol\n            \"rho\": 9680.0,        # kg/m^3\n            \"x0\": 0.001,          # m\n            \"N\": 200\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        h_mean_nm, U = compute_nonuniformity(\n            L=case[\"L\"], u=case[\"u\"], nu=case[\"nu\"], D=case[\"D\"],\n            C_inf=case[\"C_inf\"], t=case[\"t\"], M_s=case[\"M_s\"],\n            rho=case[\"rho\"], x0=case[\"x0\"], N=case[\"N\"]\n        )\n        results.append((h_mean_nm, U))\n\n    # Format output: [[mean_nm,U],[mean_nm,U],[mean_nm,U]] with six decimals\n    formatted_pairs = []\n    for mean_nm, U in results:\n        formatted_pairs.append(f\"[{mean_nm:.6f},{U:.6f}]\")\n    output = \"[\" + \",\".join(formatted_pairs) + \"]\"\n\n    # Final print statement in the exact required format.\n    print(output)\n\nsolve()\n```"
        },
        {
            "introduction": "Atomic Layer Deposition (ALD) has become essential for depositing ultra-thin, conformal high-κ films, and understanding its reaction kinetics is crucial for process control. This advanced exercise  tackles the real-world challenge of extracting fundamental kinetic parameters from noisy experimental data. By implementing a Bayesian inference model, you will learn how to combine a physical model of the ALD process with statistical methods to estimate parameters like activation energy, a core skill in modern scientific and engineering research.",
            "id": "4130634",
            "problem": "You are modeling Atomic Layer Deposition (ALD) of a high-permittivity (high-κ) gate dielectric, such as hafnium oxide, focusing on the Growth Per Cycle (GPC) as a function of substrate temperature. You will construct a Bayesian parameter estimation to infer the activation energy $E_a$ (in electron-volts) and the sticking probability $s$ (dimensionless) from noisy GPC data using a principled kinetic model. The model must be grounded in fundamental definitions and well-tested formulas. The fundamental base to use is the Arrhenius law for thermally activated processes and the exponential waiting-time model for adsorption events.\n\nAssume the following process model:\n- The Arrhenius law for the temperature-dependent rate constant is $k(T) = k_0 \\exp\\left(-\\dfrac{E_a}{k_B T}\\right)$, where $k_0$ is a pre-exponential factor with units of inverse seconds, $k_B$ is the Boltzmann constant, and $T$ is the absolute temperature in kelvins.\n- The fractional surface coverage after an ALD precursor pulse of duration $\\tau$ is modeled as $\\theta(T) = 1 - \\exp\\left(- s \\, k(T) \\, \\tau \\right)$, derived from the exponential distribution of waiting times for reaction events on the surface under a Poisson arrival assumption.\n- The Growth Per Cycle (GPC) is given by $\\text{GPC}(T) = t_{\\mathrm{ml}} \\, \\theta(T)$, where $t_{\\mathrm{ml}}$ is the effective monolayer thickness in nanometers.\n\nAssume Gaussian measurement noise on the observed GPC values at temperatures $\\{T_i\\}$:\n$$\ny_i = \\text{GPC}(T_i) + \\epsilon_i, \\quad \\epsilon_i \\sim \\mathcal{N}(0,\\sigma^2),\n$$\nwhere $y_i$ is measured GPC in nanometers per cycle, and $\\sigma$ is the known standard deviation in nanometers per cycle (constant for each test case).\n\nSet uniform priors for the unknown parameters:\n- $E_a \\sim \\mathcal{U}(0.2, 1.5)$ in electron-volts.\n- $s \\sim \\mathcal{U}(0.001, 0.999)$ (dimensionless).\n\nYour task is to implement a grid-based Bayesian estimator to compute the posterior mean of $E_a$ and the posterior mean of $s$ for each test case. Use the likelihood implied by independent Gaussian errors, and compute the posterior on a discretized grid over the specified prior ranges. The Boltzmann constant in electron-volts per kelvin is $k_B = 8.617333262145 \\times 10^{-5}$.\n\nConstants common to all test cases:\n- $k_0 = 10^8$ (in $\\mathrm{s}^{-1}$).\n- $t_{\\mathrm{ml}} = 0.11$ (in $\\mathrm{nm}$).\n\nTest suite:\n- Case $1$ (general \"happy path\" with mixed saturation and kinetic regime):\n  - Temperatures $T$ in $\\mathrm{K}$: $\\{400, 450, 500, 550, 600\\}$.\n  - Pulse duration $\\tau$ in $\\mathrm{s}$: $0.5$.\n  - Noise level $\\sigma$ in $\\mathrm{nm/cycle}$: $0.003$.\n  - Observed GPC $y$ in $\\mathrm{nm/cycle}$: $\\{0.0068, 0.0369, 0.1015, 0.1089, 0.1121\\}$.\n- Case $2$ (boundary condition with near-saturation across the temperature range):\n  - Temperatures $T$ in $\\mathrm{K}$: $\\{800, 900, 1000\\}$.\n  - Pulse duration $\\tau$ in $\\mathrm{s}$: $0.2$.\n  - Noise level $\\sigma$ in $\\mathrm{nm/cycle}$: $0.001$.\n  - Observed GPC $y$ in $\\mathrm{nm/cycle}$: $\\{0.1097, 0.1103, 0.1108\\}$.\n- Case $3$ (edge case with low temperature and low sticking probability leading to very small GPC):\n  - Temperatures $T$ in $\\mathrm{K}$: $\\{300, 325, 350\\}$.\n  - Pulse duration $\\tau$ in $\\mathrm{s}$: $0.05$.\n  - Noise level $\\sigma$ in $\\mathrm{nm/cycle}$: $0.0002$.\n  - Observed GPC $y$ in $\\mathrm{nm/cycle}$: $\\{0.00012, 0.00045, 0.00184\\}$.\n\nAlgorithmic requirements:\n- Implement a parameter grid with at least $201$ points for $E_a$ uniformly spanning $[0.2, 1.5]$, and at least $201$ points for $s$ uniformly spanning $[0.001, 0.999]$.\n- Compute the log-likelihood over the grid using the Gaussian error model and sum across all temperature points in each case.\n- Use log-sum-exp stabilization by subtracting the maximum log-posterior before exponentiation to avoid numerical underflow.\n- Normalize the posterior over the grid and compute the posterior means for $E_a$ and $s$ by summation with the normalized posterior as weights.\n\nUnits and output:\n- Express the final $E_a$ in electron-volts and $s$ as dimensionless numbers.\n- Round each output value to three decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, specifically as a list of lists in the form $[ [E_{a,1}, s_1], [E_{a,2}, s_2], [E_{a,3}, s_3] ]$, where $E_{a,i}$ and $s_i$ are the posterior means for case $i$.\n\nThe final answer must be expressed in the specified output format, with $E_a$ in $\\mathrm{eV}$ and $s$ dimensionless, each rounded to three decimal places.",
            "solution": "The user wants to solve a problem related to the modeling of Atomic Layer Deposition (ALD) for high-κ gate dielectrics.\n\n### Step 1: Extract Givens\n- **Rate Constant Model (Arrhenius Law)**: $k(T) = k_0 \\exp\\left(-\\dfrac{E_a}{k_B T}\\right)$, where $k(T)$ is the temperature-dependent rate constant, $E_a$ is the activation energy, $k_B$ is the Boltzmann constant, and $T$ is the absolute temperature.\n- **Surface Coverage Model**: $\\theta(T) = 1 - \\exp\\left(- s \\, k(T) \\, \\tau \\right)$, where $\\theta(T)$ is the fractional surface coverage, $s$ is the sticking probability, and $\\tau$ is the precursor pulse duration.\n- **Growth Per Cycle (GPC) Model**: $\\text{GPC}(T) = t_{\\mathrm{ml}} \\, \\theta(T)$, where $t_{\\mathrm{ml}}$ is the effective monolayer thickness.\n- **Measurement Noise Model**: $y_i = \\text{GPC}(T_i) + \\epsilon_i$, where the noise $\\epsilon_i$ is drawn from a normal distribution $\\mathcal{N}(0,\\sigma^2)$.\n- **Priors for Unknown Parameters**:\n  - Activation Energy: $E_a \\sim \\mathcal{U}(0.2, 1.5)$ in electron-volts ($\\mathrm{eV}$).\n  - Sticking Probability: $s \\sim \\mathcal{U}(0.001, 0.999)$ (dimensionless).\n- **Constants**:\n  - Boltzmann constant: $k_B = 8.617333262145 \\times 10^{-5} \\, \\mathrm{eV} \\cdot \\mathrm{K}^{-1}$.\n  - Pre-exponential factor: $k_0 = 10^8 \\, \\mathrm{s}^{-1}$.\n  - Monolayer thickness: $t_{\\mathrm{ml}} = 0.11 \\, \\mathrm{nm}$.\n- **Test Case 1**:\n  - Temperatures $T$: $\\{400, 450, 500, 550, 600\\}$ $\\mathrm{K}$.\n  - Pulse duration $\\tau$: $0.5$ $\\mathrm{s}$.\n  - Noise level $\\sigma$: $0.003$ $\\mathrm{nm/cycle}$.\n  - Observed GPC $y$: $\\{0.0068, 0.0369, 0.1015, 0.1089, 0.1121\\}$ $\\mathrm{nm/cycle}$.\n- **Test Case 2**:\n  - Temperatures $T$: $\\{800, 900, 1000\\}$ $\\mathrm{K}$.\n  - Pulse duration $\\tau$: $0.2$ $\\mathrm{s}$.\n  - Noise level $\\sigma$: $0.001$ $\\mathrm{nm/cycle}$.\n  - Observed GPC $y$: $\\{0.1097, 0.1103, 0.1108\\}$ $\\mathrm{nm/cycle}$.\n- **Test Case 3**:\n  - Temperatures $T$: $\\{300, 325, 350\\}$ $\\mathrm{K}$.\n  - Pulse duration $\\tau$: $0.05$ $\\mathrm{s}$.\n  - Noise level $\\sigma$: $0.0002$ $\\mathrm{nm/cycle}$.\n  - Observed GPC $y$: $\\{0.00012, 0.00045, 0.00184\\}$ $\\mathrm{nm/cycle}$.\n- **Algorithmic Requirements**:\n  - Use a grid of at least $201 \\times 201$ points for $(E_a, s)$.\n  - Compute posterior means of $E_a$ and $s$.\n  - Use log-sum-exp stabilization.\n- **Output Format**:\n  - A single line `[ [E_{a,1}, s_1], [E_{a,2}, s_2], [E_{a,3}, s_3] ]`.\n  - Values rounded to three decimal places.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is subjected to validation:\n- **Scientifically Grounded**: The problem is based on established principles of chemical kinetics and surface science. The Arrhenius law and the exponential model for surface coverage are standard in modeling thermally activated surface reactions like ALD. The parameters and their ranges are physically realistic for such processes.\n- **Well-Posed**: The problem is well-posed. It asks for the posterior mean of parameters given a model, data, and priors. The grid-based numerical estimation is a standard and well-defined procedure that leads to a unique solution for a given grid resolution.\n- **Objective**: The problem is stated using precise, objective, and quantitative language. All models, constants, and data are explicitly defined.\n- **Completeness and Consistency**: The problem is self-contained. All necessary equations, constants, data, and prior distributions are provided. There are no internal contradictions.\n- **Feasibility**: The conditions and data are physically plausible for ALD experiments. The specified numerical approach is computationally feasible.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\nThe objective is to estimate the activation energy $E_a$ and the sticking probability $s$ from a set of noisy measurements of Growth Per Cycle (GPC) at different temperatures. We employ a Bayesian framework for this parameter estimation task. The core principle of Bayesian inference is to update our knowledge about parameters (the prior distribution) in light of new data to obtain an updated state of knowledge (the posterior distribution).\n\nAccording to Bayes' theorem, the posterior probability distribution of the parameters $\\boldsymbol{\\theta} = \\{E_a, s\\}$ given the observed data $\\mathbf{y} = \\{y_i\\}$ is given by:\n$$ P(E_a, s | \\mathbf{y}) \\propto P(\\mathbf{y} | E_a, s) \\, P(E_a, s) $$\nwhere $P(\\mathbf{y} | E_a, s)$ is the likelihood of observing the data given the parameters, and $P(E_a, s)$ is the prior distribution of the parameters.\n\nThe problem specifies independent priors for $E_a$ and $s$:\n- $P(E_a) = \\mathcal{U}(0.2, 1.5)$, a uniform distribution over the interval $[0.2, 1.5]$.\n- $P(s) = \\mathcal{U}(0.001, 0.999)$, a uniform distribution over the interval $[0.001, 0.999]$.\nSince they are independent, the joint prior is $P(E_a, s) = P(E_a)P(s)$. Within the specified rectangular domain, this prior is a constant. As a result, the posterior distribution is directly proportional to the likelihood function over this domain: $P(E_a, s | \\mathbf{y}) \\propto P(\\mathbf{y} | E_a, s)$.\n\nThe likelihood function is derived from the assumption of independent and identically distributed Gaussian noise on the measurements. The probability of a single observation $y_i$ is:\n$$ P(y_i | E_a, s) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left( -\\frac{(y_i - \\text{GPC}(T_i; E_a, s))^2}{2\\sigma^2} \\right) $$\nwhere $\\text{GPC}(T_i; E_a, s)$ is the model prediction for a given set of parameters $(E_a, s)$ at temperature $T_i$. The model is constructed as:\n$$ \\text{GPC}(T; E_a, s) = t_{\\mathrm{ml}} \\left( 1 - \\exp\\left(- s \\cdot k_0 \\exp\\left(-\\frac{E_a}{k_B T}\\right) \\cdot \\tau \\right) \\right) $$\nSince individual measurements are independent, the total likelihood for the dataset $\\mathbf{y}$ is the product of the individual probabilities:\n$$ P(\\mathbf{y} | E_a, s) = \\prod_{i} P(y_i | E_a, s) $$\n\nFor numerical stability, it is standard practice to work with the logarithm of the posterior distribution. The log-posterior is proportional to the log-likelihood:\n$$ \\ln P(E_a, s | \\mathbf{y}) \\propto \\ln P(\\mathbf{y} | E_a, s) = \\sum_{i} \\ln P(y_i | E_a, s) $$\n$$ \\ln P(E_a, s | \\mathbf{y}) \\propto \\sum_{i} -\\frac{(y_i - \\text{GPC}(T_i; E_a, s))^2}{2\\sigma^2} $$\nThe terms involving $\\ln(\\sqrt{2\\pi\\sigma^2})$ are constant with respect to the parameters $(E_a, s)$ and can be dropped, as they will vanish during normalization.\n\nWe will approximate the continuous posterior distribution by computing it on a discrete grid of parameter values.\n1.  **Discretization**: A uniform grid is created for $E_a$ over $[0.2, 1.5]$ with $N_{E_a} = 201$ points, and for $s$ over $[0.001, 0.999]$ with $N_s = 201$ points. Let these grid points be $(E_{a,j}, s_k)$.\n2.  **Log-Posterior Calculation**: For each point $(E_{a,j}, s_k)$ on this $N_{E_a} \\times N_s$ grid, we compute the un-normalized log-posterior value, which we denote $\\mathcal{L}_{jk}$:\n    $$ \\mathcal{L}_{jk} = -\\frac{1}{2\\sigma^2} \\sum_{i=1}^{N_{\\text{data}}} (y_i - \\text{GPC}(T_i; E_{a,j}, s_k))^2 $$\n3.  **Normalization with Stabilization**: The log-posterior values $\\mathcal{L}_{jk}$ are typically large negative numbers, and direct exponentiation $\\exp(\\mathcal{L}_{jk})$ would result in numerical underflow. To prevent this, we use the log-sum-exp trick. First, we find the maximum value on the log-posterior grid, $\\mathcal{L}_{\\max} = \\max_{j,k} \\mathcal{L}_{jk}$. We then compute shifted, un-normalized posterior probabilities $P'_{jk} = \\exp(\\mathcal{L}_{jk} - \\mathcal{L}_{\\max})$. The normalized posterior probability at each grid point is then:\n    $$ P_{jk} = \\frac{P'_{jk}}{\\sum_{j',k'} P'_{j'k'}} $$\n4.  **Posterior Mean Calculation**: The goal is to compute the posterior means of $E_a$ and $s$, which represent the expectation of each parameter with respect to the posterior distribution. For our discrete grid, this is approximated by a weighted sum:\n    $$ \\mathbb{E}[E_a | \\mathbf{y}] \\approx \\sum_{j=1}^{N_{E_a}} \\sum_{k=1}^{N_s} E_{a,j} P_{jk} $$\n    $$ \\mathbb{E}[s | \\mathbf{y}] \\approx \\sum_{j=1}^{N_{E_a}} \\sum_{k=1}^{N_s} s_k P_{jk} $$\nThis procedure is repeated for each of the three test cases provided. The final results are rounded to three decimal places as required.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Bayesian parameter estimation problem for ALD GPC data.\n    \"\"\"\n    # Define constants common to all test cases\n    K_B = 8.617333262145e-5  # Boltzmann constant in eV/K\n    K_0 = 1e8                  # Pre-exponential factor in s^-1\n    T_ML = 0.11                # Monolayer thickness in nm\n\n    # Define the parameter grid\n    N_EA = 201\n    N_S = 201\n    ea_vals = np.linspace(0.2, 1.5, N_EA)\n    s_vals = np.linspace(0.001, 0.999, N_S)\n    \n    # Create meshgrids for vectorized calculations\n    # indexing='ij' makes the shapes (N_EA, N_S)\n    ea_grid, s_grid = np.meshgrid(ea_vals, s_vals, indexing='ij')\n\n    # Define the test suite\n    test_cases = [\n        {\n            \"temps_K\": np.array([400, 450, 500, 550, 600]),\n            \"tau_s\": 0.5,\n            \"sigma_nm\": 0.003,\n            \"gpc_obs_nm\": np.array([0.0068, 0.0369, 0.1015, 0.1089, 0.1121])\n        },\n        {\n            \"temps_K\": np.array([800, 900, 1000]),\n            \"tau_s\": 0.2,\n            \"sigma_nm\": 0.001,\n            \"gpc_obs_nm\": np.array([0.1097, 0.1103, 0.1108])\n        },\n        {\n            \"temps_K\": np.array([300, 325, 350]),\n            \"tau_s\": 0.05,\n            \"sigma_nm\": 0.0002,\n            \"gpc_obs_nm\": np.array([0.00012, 0.00045, 0.00184])\n        }\n    ]\n\n    final_results = []\n\n    for case in test_cases:\n        temps = case[\"temps_K\"]\n        tau = case[\"tau_s\"]\n        sigma = case[\"sigma_nm\"]\n        y_obs = case[\"gpc_obs_nm\"]\n        \n        # Initialize log posterior grid\n        log_posterior = np.zeros_like(ea_grid)\n\n        # Loop over each data point (temperature and observed GPC)\n        for t_i, y_i in zip(temps, y_obs):\n            # Calculate the rate constant k(T) over the entire parameter grid\n            k_t = K_0 * np.exp(-ea_grid / (K_B * t_i))\n            \n            # Calculate the surface coverage theta(T)\n            theta = 1.0 - np.exp(-s_grid * k_t * tau)\n            \n            # Calculate the model GPC\n            gpc_model = T_ML * theta\n            \n            # Calculate the log-likelihood for this data point and add to total\n            # The constant prefactor of the Gaussian is ignored as it cancels out\n            log_likelihood_i = -((y_i - gpc_model)**2) / (2 * sigma**2)\n            log_posterior += log_likelihood_i\n            \n        # --- Numerical Stabilization (log-sum-exp) ---\n        # Subtract the maximum log posterior value to prevent underflow\n        log_post_max = np.max(log_posterior)\n        posterior_unnormalized = np.exp(log_posterior - log_post_max)\n        \n        # --- Normalization ---\n        # Normalize the posterior so that it sums to 1\n        posterior_normalized = posterior_unnormalized / np.sum(posterior_unnormalized)\n\n        # --- Posterior Mean Calculation ---\n        # The mean is the expectation, calculated as a weighted sum over the grid\n        ea_mean = np.sum(ea_grid * posterior_normalized)\n        s_mean = np.sum(s_grid * posterior_normalized)\n        \n        final_results.append([ea_mean, s_mean])\n\n    # --- Format the output as specified ---\n    # Create a list of strings like \"[Ea,s]\" for each case\n    output_parts = [f\"[{res[0]:.3f},{res[1]:.3f}]\" for res in final_results]\n    \n    # Join the parts into the final string format \"[[...],[...]]\"\n    print(f\"[{','.join(output_parts)}]\")\n\n\nsolve()\n```"
        }
    ]
}