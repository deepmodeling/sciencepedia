{
    "hands_on_practices": [
        {
            "introduction": "The Stoney formula provides a powerful link between wafer curvature and thin film stress, but how is this curvature measured in practice? This problem takes you into the metrology lab by simulating the analysis of data from a Multi-beam Optical Stress Sensor (MOSS) system. By first deriving the relationship between optical deflection and curvature, you will then apply Stoney's formula to calculate the film stress, providing a complete \"measurement-to-result\" workflow .",
            "id": "4168233",
            "problem": "A silicon wafer of thickness $t_{s}$ carries a thin, uniformly stressed film of thickness $t_{f}$. The substrate is isotropic with Young’s modulus $E_{s}$ and Poisson’s ratio $\\nu_{s}$. The wafer curvature is measured using a Multi-beam Optical Stress Sensor (MOSS), in which two parallel laser spots reflected from the wafer surface are recorded on a detector placed a distance $L$ away. The initial wafer is flat, and after film deposition the spot-to-spot separation on the detector changes by $\\Delta$ relative to the initial separation. The corresponding beam separation on the wafer is $s$. Assume small slopes, near-normal incidence, and that the film is much thinner than the substrate ($t_{f} \\ll t_{s}$), so that the film contributes only in-plane force while the substrate supplies the bending stiffness. Also assume equi-biaxial curvature and stress.\n\nStarting from classical thin plate (Kirchhoff–Love) theory and specular reflection geometry, first derive an expression that relates the wafer curvature $\\kappa$ to the measured quantities $\\Delta$, $L$, and $s$. Then, using force–moment balance and the plate moment–curvature relation for an isotropic substrate under equi-biaxial bending, derive an expression for the film stress $\\sigma_{f}$ in terms of $\\kappa$, $E_{s}$, $\\nu_{s}$, $t_{s}$, and $t_{f}$. Finally, evaluate $\\sigma_{f}$ numerically for\n$ \\Delta = 0.8\\,\\mathrm{mm}$, $ L = 0.5\\,\\mathrm{m}$, $ s = 20\\,\\mathrm{mm}$, $ t_{s} = 725\\,\\mathrm{\\mu m}$, $ t_{f} = 300\\,\\mathrm{nm}$, $ E_{s} = 130\\,\\mathrm{GPa}$, and $ \\nu_{s} = 0.28$.\nRound your answer to four significant figures. Express the film stress in GigaPascals (GPa).",
            "solution": "The solution involves three parts: deriving the curvature-measurement relationship, deriving the Stoney formula for stress, and performing a numerical calculation.\n\n### Part 1: Derivation of Curvature $\\kappa$\n\nLet's set a coordinate system where the two parallel beams strike the wafer at horizontal positions $x_1 = -s/2$ and $x_2 = +s/2$. For a small, uniform spherical curvature $\\kappa$, the local surface slope at position $x$ is given by $\\theta(x) \\approx \\kappa x$.\n\nAccording to the law of specular reflection, a vertically incident beam reflects from a surface with slope $\\theta$ at a total deviation angle of $2\\theta$ from the vertical. The two reflected beams are therefore deviated by angles $2\\theta(x_1) = -\\kappa s$ and $2\\theta(x_2) = +\\kappa s$.\n\nThese beams travel a distance $L$ to the detector. Using the small angle approximation ($\\tan \\alpha \\approx \\alpha$), the horizontal positions of the spots on the detector are:\n$$ x'_1 \\approx x_1 + L \\cdot (2\\theta(x_1)) = -s/2 - L\\kappa s $$\n$$ x'_2 \\approx x_2 + L \\cdot (2\\theta(x_2)) = +s/2 + L\\kappa s $$\nThe new separation of the spots on the detector is $s'$.\n$$ s' = x'_2 - x'_1 = (s/2 + L\\kappa s) - (-s/2 - L\\kappa s) = s + 2L\\kappa s $$\nThe initial separation on the detector for a flat wafer ($\\kappa=0$) was simply $s$. The change in spot separation, $\\Delta$, is the difference between the final and initial separations:\n$$ \\Delta = s' - s = (s + 2L\\kappa s) - s = 2L\\kappa s $$\nSolving for the curvature $\\kappa$ gives the desired relation:\n$$ \\kappa = \\frac{\\Delta}{2Ls} $$\n\n### Part 2: Derivation of Film Stress $\\sigma_f$ (Stoney's Formula)\n\nWe analyze the forces and moments in the film-substrate composite structure. The film is under a uniform, equi-biaxial stress $\\sigma_f$. This stress generates a force per unit length, $F$, acting at the film-substrate interface, given by:\n$$ F = \\sigma_f t_f $$\nSince the film thickness is much smaller than the substrate thickness ($t_f \\ll t_s$), we assume the neutral axis of bending for the composite structure lies at the mid-plane of the substrate. The force $F$ acts at a distance of approximately $t_s/2$ from this neutral axis. This creates a bending moment per unit length, $M$, in the substrate:\n$$ M = F \\cdot \\frac{t_s}{2} = \\frac{1}{2}\\sigma_f t_f t_s $$\nThis internal moment must be balanced by the restorative moment from the substrate's elastic bending. According to plate theory, for an isotropic plate under equi-biaxial curvature $\\kappa$, the relationship between the applied moment per unit length $M$ and the curvature $\\kappa$ is:\n$$ M = \\frac{E_s t_s^3}{12(1-\\nu_s)}\\kappa $$\nEquating the two expressions for the moment $M$:\n$$ \\frac{1}{2}\\sigma_f t_f t_s = \\frac{E_s t_s^3}{12(1-\\nu_s)}\\kappa $$\nFinally, we solve for the film stress $\\sigma_f$:\n$$ \\sigma_f = \\frac{E_s t_s^2}{6(1-\\nu_s)t_f}\\kappa $$\nThis is the celebrated Stoney's formula. The term $\\frac{E_s}{1-\\nu_s}$ is the biaxial modulus of the substrate.\n\n### Part 3: Numerical Evaluation of $\\sigma_f$\n\nFirst, we combine the expressions for $\\kappa$ and $\\sigma_f$:\n$$ \\sigma_f = \\frac{E_s t_s^2}{6(1-\\nu_s)t_f} \\left( \\frac{\\Delta}{2Ls} \\right) = \\frac{E_s t_s^2 \\Delta}{12(1-\\nu_s)t_f L s} $$\nNext, we convert all given values to base SI units (meters, Pascals):\n- $\\Delta = 0.8\\,\\mathrm{mm} = 0.8 \\times 10^{-3}\\,\\mathrm{m}$\n- $L = 0.5\\,\\mathrm{m}$\n- $s = 20\\,\\mathrm{mm} = 20 \\times 10^{-3}\\,\\mathrm{m}$\n- $t_{s} = 725\\,\\mathrm{\\mu m} = 725 \\times 10^{-6}\\,\\mathrm{m}$\n- $t_{f} = 300\\,\\mathrm{nm} = 300 \\times 10^{-9}\\,\\mathrm{m}$\n- $E_{s} = 130\\,\\mathrm{GPa} = 130 \\times 10^9\\,\\mathrm{Pa}$\n- $\\nu_{s} = 0.28$ (dimensionless)\n\nNow, we substitute these values into the combined formula:\n$$ \\sigma_f = \\frac{(130 \\times 10^9\\,\\mathrm{Pa}) (725 \\times 10^{-6}\\,\\mathrm{m})^2 (0.8 \\times 10^{-3}\\,\\mathrm{m})}{12(1 - 0.28) (300 \\times 10^{-9}\\,\\mathrm{m}) (0.5\\,\\mathrm{m}) (20 \\times 10^{-3}\\,\\mathrm{m})} $$\nLet's evaluate the numerator and denominator separately.\nNumerator:\n$$ N = (130 \\times 10^9) \\times (5.25625 \\times 10^{-7}) \\times (0.8 \\times 10^{-3}) = 54.665 $$\nDenominator:\n$$ D_{denom} = 12 \\times 0.72 \\times (300 \\times 10^{-9}) \\times 0.5 \\times (20 \\times 10^{-3}) = 2.592 \\times 10^{-8} $$\nNow calculate the stress in Pascals:\n$$ \\sigma_f = \\frac{N}{D_{denom}} = \\frac{54.665}{2.592 \\times 10^{-8}} \\approx 2.1090046 \\times 10^9\\,\\mathrm{Pa} $$\nThe problem asks for the result in GigaPascals (GPa), where $1\\,\\mathrm{GPa} = 10^9\\,\\mathrm{Pa}$.\n$$ \\sigma_f \\approx 2.1090046\\,\\mathrm{GPa} $$\nRounding to four significant figures, we get:\n$$ \\sigma_f = 2.109\\,\\mathrm{GPa} $$\nThe positive sign indicates that the film is under tensile stress.",
            "answer": "$$\n\\boxed{2.109}\n$$"
        },
        {
            "introduction": "While elegant, the classical Stoney formula relies on the assumption that the film is negligibly thin compared to the substrate. This exercise challenges you to move beyond that simplification by deriving a more general curvature expression from composite beam theory that accounts for finite film thickness and stiffness. By comparing the results of the corrected model to the classical Stoney approximation for a relatively thick film, you will gain a quantitative understanding of the limits of the simpler model and the importance of choosing the appropriate analytical tool for the job .",
            "id": "4168210",
            "problem": "A circular silicon wafer of thickness $t_s$ is uniformly coated with a thin film of thickness $t_f$ that carries a uniform equi-biaxial intrinsic stress $\\sigma_f$ generated during deposition. Assume small deflection bending, linear elasticity, and an equi-biaxial curvature $k$ so that the in-plane bending strain at a distance $z$ from the substrate mid-plane is $\\varepsilon_b(z) = z k$. In equi-biaxial loading for an isotropic material, the in-plane stress-strain relation is $\\sigma = M \\,\\varepsilon$, where the biaxial modulus $M$ is defined by $M \\equiv E/(1-\\nu)$ for Young’s modulus $E$ and Poisson’s ratio $\\nu$. Let the substrate and film biaxial moduli be $M_s$ and $M_f$, respectively.\n\nStarting from force and moment balance in the bilayer and the definition of the neutral axis for composite bending, first derive the classical thin-film limit expression for $k$ by assuming $t_f \\ll t_s$ and the film’s bending stiffness is negligible relative to the substrate. Then derive the finite-thickness corrected curvature by treating the bilayer as a composite with neutral axis shift and composite flexural rigidity, and by accounting for the bending moment generated by the film’s intrinsic stress acting at an offset from the neutral axis.\n\nEvaluate both curvatures for the following parameter set: $t_s = 300\\,\\mathrm{\\mu m}$, $t_f = 10\\,\\mathrm{\\mu m}$, $M_s = 160\\,\\mathrm{GPa}$, $M_f = 200\\,\\mathrm{GPa}$, and $\\sigma_f = 300\\,\\mathrm{MPa}$. Express all curvatures in inverse meters, and round each numerical result to four significant figures. Also provide a single quantitative comparison measure between the two curvatures as a decimal ratio $k_{\\mathrm{corrected}}/k_{\\mathrm{Stoney}}$ rounded to four significant figures.",
            "solution": "### Derivation of the Classical Thin-Film Limit (Stoney's Formula)\n\nThe classical Stoney formula is derived under the assumption that the film is much thinner than the substrate ($t_f \\ll t_s$) and the film's own bending stiffness is negligible.\n\nWe establish a coordinate system with $z=0$ at the mid-plane of the substrate. The intrinsic stress $\\sigma_f$ in the film generates a force per unit width $F_f = \\sigma_f t_f$. Under the thin-film assumption, the neutral axis is at $z=0$, so this force acts at a lever arm of approximately $t_s/2$. This creates an external bending moment $M_{ext}$:\n$$ M_{ext} \\approx (\\sigma_f t_f) \\frac{t_s}{2} $$\nThis moment is balanced by the internal restoring moment of the substrate, which is related to its curvature $k$ and its plate rigidity. For an isotropic plate under equi-biaxial bending, the restoring moment is:\n$$ M_{int} = k \\left( \\frac{M_s t_s^3}{12} \\right) $$\nEquating the external and internal moments, $M_{int} = M_{ext}$:\n$$ k \\frac{M_s t_s^3}{12} = \\sigma_f t_f \\frac{t_s}{2} $$\nSolving for the curvature $k$ yields the Stoney formula:\n$$ k_{\\mathrm{Stoney}} = \\frac{6 \\sigma_f t_f}{M_s t_s^2} $$\n\n### Derivation of the Finite-Thickness Corrected Curvature\n\nFor the corrected formula, we treat the bilayer as a composite beam. It is convenient to place the coordinate origin $z=0$ at the interface between the film and substrate. The substrate occupies $-t_s \\le z \\le 0$ and the film occupies $0 \\le z \\le t_f$.\n\n1.  **Position of the Neutral Axis ($z_n$)**\n    The neutral axis is the plane where the net force is zero under pure bending. Its position $z_n$ is found by setting the first moment of the modulus-weighted area to zero.\n    $$ \\int_{-t_s}^{t_f} M(z)(z-z_n) dz = 0 \\implies z_n = \\frac{\\int M(z)z dz}{\\int M(z)dz} $$\n    $$ z_n = \\frac{M_f t_f^2/2 - M_s t_s^2/2}{M_s t_s + M_f t_f} = \\frac{M_f t_f^2 - M_s t_s^2}{2(M_s t_s + M_f t_f)} $$\n\n2.  **Driving Bending Moment ($M_{driving}$)**\n    The intrinsic stress $\\sigma_f$ in the film generates a force per unit width $F_f = \\sigma_f t_f$. This force acts at the centroid of the film, located at $z = t_f/2$. The moment is calculated with respect to the neutral axis $z_n$.\n    $$ M_{driving} = F_f \\times (\\text{lever arm}) = (\\sigma_f t_f) \\left( \\frac{t_f}{2} - z_n \\right) $$\n\n3.  **Composite Flexural Rigidity ($D_{comp}$)**\n    The flexural rigidity of the composite beam per unit width is the second moment of the modulus-weighted area about the neutral axis, calculated using the parallel axis theorem for each layer.\n    $$ D_{comp} = \\left( M_s \\frac{t_s^3}{12} + M_s t_s \\left(z_n - (-\\frac{t_s}{2})\\right)^2 \\right) + \\left( M_f \\frac{t_f^3}{12} + M_f t_f \\left(\\frac{t_f}{2} - z_n\\right)^2 \\right) $$\n\n4.  **Corrected Curvature ($k_{\\mathrm{corrected}}$)**\n    The curvature is the ratio of the driving moment to the composite flexural rigidity.\n    $$ k_{\\mathrm{corrected}} = \\frac{M_{driving}}{D_{comp}} $$\n\n### Numerical Evaluation\nThe given parameters are converted to base SI units:\n$t_s = 300 \\times 10^{-6}\\,\\mathrm{m}$\n$t_f = 10 \\times 10^{-6}\\,\\mathrm{m}$\n$M_s = 160 \\times 10^9\\,\\mathrm{Pa}$\n$M_f = 200 \\times 10^9\\,\\mathrm{Pa}$\n$\\sigma_f = 300 \\times 10^6\\,\\mathrm{Pa}$\n\n**Stoney Curvature:**\n$$ k_{\\mathrm{Stoney}} = \\frac{6 \\times (300 \\times 10^6\\,\\mathrm{Pa}) \\times (10 \\times 10^{-6}\\,\\mathrm{m})}{(160 \\times 10^9\\,\\mathrm{Pa}) \\times (300 \\times 10^{-6}\\,\\mathrm{m})^2} = \\frac{18000}{14400} = 1.25\\,\\mathrm{m}^{-1} $$\nRounded to four significant figures, $k_{\\mathrm{Stoney}} = 1.250\\,\\mathrm{m}^{-1}$.\n\n**Corrected Curvature:**\nFirst, we calculate the intermediate terms.\n$M_s t_s = (160 \\times 10^9) \\times (300 \\times 10^{-6}) = 4.8 \\times 10^7\\,\\mathrm{N/m}$\n$M_f t_f = (200 \\times 10^9) \\times (10 \\times 10^{-6}) = 2.0 \\times 10^6\\,\\mathrm{N/m}$\n$M_s t_s^2 = 14400\\,\\mathrm{N}$; $M_f t_f^2 = 20\\,\\mathrm{N}$.\n\nPosition of the neutral axis $z_n$:\n$$ z_n = \\frac{20 - 14400}{2(4.8 \\times 10^7 + 2.0 \\times 10^6)} = \\frac{-14380}{1.0 \\times 10^8} = -1.438 \\times 10^{-4}\\,\\mathrm{m} $$\n\nDriving bending moment $M_{driving}$:\nLever arm: $t_f/2 - z_n = (5 \\times 10^{-6}) - (-1.438 \\times 10^{-4}) = 1.488 \\times 10^{-4}\\,\\mathrm{m}$.\n$$ M_{driving} = (300 \\times 10^6 \\times 10 \\times 10^{-6}) \\times (1.488 \\times 10^{-4}) = 0.4464\\,\\mathrm{N} $$\n\nComposite flexural rigidity $D_{comp}$:\nSubstrate contribution: $D_s = M_s \\frac{t_s^3}{12} + M_s t_s (z_n + \\frac{t_s}{2})^2 = 0.36 + (4.8 \\times 10^7) (-1.438 \\times 10^{-4} + 1.5 \\times 10^{-4})^2 = 0.3618\\,\\mathrm{N \\cdot m}$\nFilm contribution: $D_f = M_f \\frac{t_f^3}{12} + M_f t_f (\\frac{t_f}{2} - z_n)^2 = 1.67 \\times 10^{-5} + (2.0 \\times 10^6) (1.488 \\times 10^{-4})^2 = 0.0443\\,\\mathrm{N \\cdot m}$\nTotal rigidity:\n$D_{comp} = D_s + D_f = 0.3618 + 0.0443 = 0.4061\\,\\mathrm{N \\cdot m}$\n\nFinally, the corrected curvature:\n$$ k_{\\mathrm{corrected}} = \\frac{M_{driving}}{D_{comp}} = \\frac{0.4464}{0.4061} \\approx 1.0992\\,\\mathrm{m}^{-1} $$\nRounded to four significant figures, $k_{\\mathrm{corrected}} = 1.099\\,\\mathrm{m}^{-1}$.\n\n**Ratio of Curvatures:**\n$$ \\frac{k_{\\mathrm{corrected}}}{k_{\\mathrm{Stoney}}} = \\frac{1.099}{1.250} \\approx 0.8792 $$\nRounded to four significant figures, the ratio is $0.8792$. Note that small rounding differences may occur depending on the precision carried through calculations; the provided answer reflects this.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 1.250 & 1.099 & 0.8793 \\end{pmatrix} } $$"
        },
        {
            "introduction": "Modern process modeling heavily relies on computational simulation to explore parameter spaces and validate analytical models. This practice guides you through developing a numerical, \"FEA-style\" model of a bilayer system from the first principle of energy minimization, which is then implemented in code . By running a suite of test cases that vary film thickness and material properties, you will computationally map out the domain of validity for the Stoney approximation and quantify its discrepancy against the more exact composite plate theory.",
            "id": "4178608",
            "problem": "A circular crystalline silicon wafer of thickness $t_s$ carries a uniform, equi-biaxial residual stress $\\sigma_f$ in a silicon nitride (SiN$_x$) film of thickness $t_f$ deposited on one surface. Under the assumptions of small deflections, plane stress, and linear elasticity, the system bows into a nearly spherical shape with curvature $k$ that depends on the mismatch between the film’s eigenstrain and the substrate’s response. The classical thin-film limit known as the Stoney approximation provides an analytical prediction of the curvature by neglecting the film’s bending stiffness. However, in realistic semiconductor manufacturing settings, finite film stiffness can introduce a discrepancy from this approximation. In this problem, you will derive a model from first principles to compare the Stoney-based prediction to a numerical finite element analysis (FEA)-style discretization of the bilayer in the thickness direction, and then quantify the discrepancy attributable to finite film stiffness.\n\nUse fundamental mechanics of materials as the base: plane stress constitutive law $\\sigma = M \\,\\varepsilon$ with biaxial modulus $M = E/(1-\\nu)$, strain compatibility $\\varepsilon(z) = \\varepsilon_0 + k z$ (Kirchhoff–Love plate kinematics), and energy minimization under zero external force and moment. Treat the film’s residual stress as arising from a uniform eigenstrain $\\varepsilon^{*}$ confined to the film, so that if the film were free, it would carry stress $\\sigma_f = M_f \\,\\varepsilon^{*}$, where $M_f$ is the film’s biaxial modulus. The substrate has biaxial modulus $M_s$ and no eigenstrain.\n\nYou must:\n- Derive, from the stated base, the linear system for the unknown mid-plane strain $\\varepsilon_0$ and curvature $k$ by minimizing the total strain energy with respect to these degrees of freedom subject to zero resultant in-plane force and bending moment (no external loads).\n- Implement two curvature predictions:\n  1. A Stoney-based curvature $k_{\\text{Stoney}}$ that uses the thin-film approximation and the substrate biaxial modulus.\n  2. A numerical FEA-style curvature $k_{\\text{FEA}}$ by discretizing the thickness into layers, integrating modulus-weighted strain and eigenstrain terms to assemble the $2\\times 2$ system for $(\\varepsilon_0,k)$, and solving it exactly.\n- Quantify the discrepancy due to finite film stiffness by computing the decimal ratio $\\delta = (k_{\\text{FEA}} - k_{\\text{Stoney}})/k_{\\text{FEA}}$ for each case.\n- Also compute the spherical-cap bow (sagitta) at wafer edge radius $a$ as $w_{\\text{bow}} = k_{\\text{FEA}}\\,a^2/2$.\n\nExpress curvatures in $\\text{m}^{-1}$, stresses in $\\text{Pa}$, moduli in $\\text{Pa}$, thicknesses and radii in $\\text{m}$, and bow in $\\text{m}$. Return the discrepancy $\\delta$ as a decimal (not a percentage).\n\nYour program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a list of four floats in the order $[k_{\\text{Stoney}}, k_{\\text{FEA}}, \\delta, w_{\\text{bow}}]$.\n\nUse the following test suite, covering typical, boundary, and edge cases. For silicon nitride and silicon, assume isotropic effective properties as specified.\n\nFor each case, parameters are $(t_f, t_s, \\sigma_f, E_f, \\nu_f, E_s, \\nu_s, a)$:\n1. Baseline thin film on $200\\ \\text{mm}$ wafer: $t_f = 1\\times 10^{-6}\\ \\text{m}$, $t_s = 5.25\\times 10^{-4}\\ \\text{m}$, $\\sigma_f = +4.00\\times 10^{8}\\ \\text{Pa}$, $E_f = 2.50\\times 10^{11}\\ \\text{Pa}$, $\\nu_f = 0.23$, $E_s = 1.30\\times 10^{11}\\ \\text{Pa}$, $\\nu_s = 0.28$, $a = 1.00\\times 10^{-1}\\ \\text{m}$.\n2. Thicker film: $t_f = 5\\times 10^{-6}\\ \\text{m}$, $t_s = 5.25\\times 10^{-4}\\ \\text{m}$, $\\sigma_f = +4.00\\times 10^{8}\\ \\text{Pa}$, $E_f = 2.50\\times 10^{11}\\ \\text{Pa}$, $\\nu_f = 0.23$, $E_s = 1.30\\times 10^{11}\\ \\text{Pa}$, $\\nu_s = 0.28$, $a = 1.00\\times 10^{-1}\\ \\text{m}$.\n3. Much thicker film: $t_f = 5.0\\times 10^{-5}\\ \\text{m}$, $t_s = 5.25\\times 10^{-4}\\ \\text{m}$, $\\sigma_f = +4.00\\times 10^{8}\\ \\text{Pa}$, $E_f = 2.50\\times 10^{11}\\ \\text{Pa}$, $\\nu_f = 0.23$, $E_s = 1.30\\times 10^{11}\\ \\text{Pa}$, $\\nu_s = 0.28$, $a = 1.00\\times 10^{-1}\\ \\text{m}$.\n4. Extremely thin film: $t_f = 1.0\\times 10^{-7}\\ \\text{m}$, $t_s = 5.25\\times 10^{-4}\\ \\text{m}$, $\\sigma_f = +4.00\\times 10^{8}\\ \\text{Pa}$, $E_f = 2.50\\times 10^{11}\\ \\text{Pa}$, $\\nu_f = 0.23$, $E_s = 1.30\\times 10^{11}\\ \\text{Pa}$, $\\nu_s = 0.28$, $a = 1.00\\times 10^{-1}\\ \\text{m}$.\n5. Zero stress edge case: $t_f = 1\\times 10^{-6}\\ \\text{m}$, $t_s = 5.25\\times 10^{-4}\\ \\text{m}$, $\\sigma_f = 0.0\\ \\text{Pa}$, $E_f = 2.50\\times 10^{11}\\ \\text{Pa}$, $\\nu_f = 0.23$, $E_s = 1.30\\times 10^{11}\\ \\text{Pa}$, $\\nu_s = 0.28$, $a = 1.00\\times 10^{-1}\\ \\text{m}$.\n6. Modulus parity check: $t_f = 1\\times 10^{-6}\\ \\text{m}$, $t_s = 5.25\\times 10^{-4}\\ \\text{m}$, $\\sigma_f = +4.00\\times 10^{8}\\ \\text{Pa}$, $E_f = 1.30\\times 10^{11}\\ \\text{Pa}$, $\\nu_f = 0.28$, $E_s = 1.30\\times 10^{11}\\ \\text{Pa}$, $\\nu_s = 0.28$, $a = 1.00\\times 10^{-1}\\ \\text{m}$.\n\nYour implementation must be general and use these inputs exactly to produce the required output format.",
            "solution": "The solution is derived from the first principles of continuum mechanics for a bilayer plate under internal stress.\n\n**1. Theoretical Framework**\nWe model the film-substrate system as a composite plate. A coordinate system is established with the origin $z=0$ at the mid-plane of the substrate. The substrate occupies the domain $z \\in [-t_s/2, t_s/2]$, and the film occupies $z \\in [t_s/2, t_s/2 + t_f]$.\n\nThe total strain $\\varepsilon(z)$ at any vertical position $z$ is given by the Kirchhoff-Love plate theory kinematics:\n$$ \\varepsilon(z) = \\varepsilon_0 + k z $$\nwhere $\\varepsilon_0$ is the strain at the reference plane ($z=0$) and $k$ is the uniform curvature of the plate.\n\nThe equi-biaxial stress $\\sigma(z)$ is related to the elastic strain $\\varepsilon_{el}(z)$ through the biaxial modulus $M(z) = E(z)/(1-\\nu(z))$. The total strain is the sum of elastic strain and any non-mechanical eigenstrain $\\varepsilon^*(z)$: $\\varepsilon(z) = \\varepsilon_{el}(z) + \\varepsilon^*(z)$. The stress is therefore:\n$$ \\sigma(z) = M(z) \\varepsilon_{el}(z) = M(z) [\\varepsilon(z) - \\varepsilon^*(z)] = M(z)[\\varepsilon_0 + k z - \\varepsilon^*(z)] $$\nThe eigenstrain $\\varepsilon^*(z)$ is zero in the substrate and uniform in the film, $\\varepsilon_f^* = \\sigma_f/M_f$, where $\\sigma_f$ is the given residual stress parameter.\n\n**2. Governing Equations from Energy Minimization**\nThe total strain energy per unit area, $U$, stored in the bilayer is:\n$$ U = \\frac{1}{2} \\int_{-t_s/2}^{t_s/2+t_f} \\sigma(z) \\varepsilon_{el}(z) dz = \\frac{1}{2} \\int_{-t_s/2}^{t_s/2+t_f} M(z)[\\varepsilon_0 + kz - \\varepsilon^*(z)]^2 dz $$\nFor a system in equilibrium with no external loads, the strain energy is minimized with respect to the kinematic degrees of freedom, $\\varepsilon_0$ and $k$.\n$$ \\frac{\\partial U}{\\partial \\varepsilon_0} = \\int M(z)[\\varepsilon_0 + kz - \\varepsilon^*(z)] dz = 0 $$\n$$ \\frac{\\partial U}{\\partial k} = \\int z M(z)[\\varepsilon_0 + kz - \\varepsilon^*(z)] dz = 0 $$\nThese two conditions correspond to the requirement that the net in-plane force resultant $N$ and the net bending moment resultant $M$ must both be zero.\n\n**3. General Matrix Formulation for $k_{\\text{FEA}}$**\nThe governing equations form a $2 \\times 2$ linear system for the unknowns $(\\varepsilon_0, k)$. We can rewrite the equations as:\n$$\n\\begin{pmatrix}\n\\int M(z)dz & \\int zM(z)dz \\\\\n\\int zM(z)dz & \\int z^2M(z)dz\n\\end{pmatrix}\n\\begin{pmatrix} \\varepsilon_0 \\\\ k \\end{pmatrix}\n=\n\\begin{pmatrix}\n\\int M(z)\\varepsilon^*(z)dz \\\\\n\\int zM(z)\\varepsilon^*(z)dz\n\\end{pmatrix}\n$$\nThis is of the form $\\mathbf{K} \\mathbf{u} = \\mathbf{F}^*$, where $\\mathbf{K}$ is the stiffness matrix and $\\mathbf{F}^*$ is the load vector due to eigenstrain. Let us define the coefficients by evaluating the integrals over the film and substrate layers:\n-   Axial stiffness: $A = \\int M(z)dz = M_s t_s + M_f t_f$\n-   Coupling stiffness: $B = \\int zM(z)dz = M_f t_f (t_s/2 + t_f/2)$\n-   Bending stiffness: $D = \\int z^2M(z)dz = M_s \\frac{t_s^3}{12} + M_f \\left( \\frac{t_f^3}{12} + t_f \\left( \\frac{t_s}{2} + \\frac{t_f}{2} \\right)^2 \\right)$ (using the parallel axis theorem for the film's contribution).\n-   Eigenforce: $N^* = \\int M(z)\\varepsilon^*(z)dz = M_f \\varepsilon_f^* t_f = \\sigma_f t_f$\n-   Eigenmoment: $M^* = \\int zM(z)\\varepsilon^*(z)dz = M_f \\varepsilon_f^* t_f (t_s/2 + t_f/2) = \\sigma_f t_f (t_s/2 + t_f/2)$\n\nThe system is:\n$$\n\\begin{pmatrix} A & B \\\\ B & D \\end{pmatrix}\n\\begin{pmatrix} \\varepsilon_0 \\\\ k \\end{pmatrix}\n=\n\\begin{pmatrix} N^* \\\\ M^* \\end{pmatrix}\n$$\nSolving for the curvature $k$ (which is $k_{\\text{FEA}}$) using Cramer's rule gives:\n$$ k_{\\text{FEA}} = \\frac{A M^* - B N^*}{A D - B^2} $$\nThis expression is the exact solution for the curvature based on bilayer plate theory and will be used for the $k_{\\text{FEA}}$ calculation. The \"FEA-style\" approach corresponds to this systematic assembly of the governing matrix system from first principles.\n\n**4. Stoney Approximation for $k_{\\text{Stoney}}$**\nThe Stoney formula is a limit of the general solution under the thin-film approximation, where $t_f \\ll t_s$ and the film's stiffness is negligible compared to the substrate's ($M_f t_f \\ll M_s t_s$). A simplified derivation considers the moment balance. The force per unit width in the film is approximately $\\sigma_f t_f$. This force acts at a lever arm of $\\approx t_s/2$ from the substrate's midplane, inducing a moment $M_{load} = (\\sigma_f t_f)(t_s/2)$. This moment is balanced by the substrate's elastic response, $M_{resist} = k D_s$, where $D_s = M_s t_s^3/12$ is the plate rigidity of the substrate alone. Equating the moments gives:\n$$ k_{\\text{Stoney}} \\left( M_s \\frac{t_s^3}{12} \\right) = \\sigma_f t_f \\frac{t_s}{2} $$\nSolving for $k_{\\text{Stoney}}$ yields the classical Stoney formula:\n$$ k_{\\text{Stoney}} = \\frac{6 \\sigma_f t_f}{M_s t_s^2} $$\n\n**5. Discrepancy and Bow Calculation**\nThe discrepancy $\\delta$ between the two models is computed as the relative difference, as specified:\n$$ \\delta = \\frac{k_{\\text{FEA}} - k_{\\text{Stoney}}}{k_{\\text{FEA}}} $$\nIf $k_{\\text{FEA}} = 0$ (e.g., if $\\sigma_f = 0$), the discrepancy is physically zero, so we define $\\delta=0$.\n\nThe maximum deflection (bow or sagitta) $w_{\\text{bow}}$ of a spherically bowed circular plate of radius $a$ is given for small deflections by:\n$$ w_{\\text{bow}} = \\frac{k_{\\text{FEA}} a^2}{2} $$\nThis completes the derivation of all required formulae.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the wafer bow problem for a suite of test cases.\n    \"\"\"\n\n    # Test cases parameters:\n    # (t_f, t_s, sigma_f, E_f, nu_f, E_s, nu_s, a)\n    # in (m, m, Pa, Pa, -, Pa, -, m)\n    test_cases = [\n        (1.0e-6, 5.25e-4, 4.00e8, 2.50e11, 0.23, 1.30e11, 0.28, 1.00e-1),\n        (5.0e-6, 5.25e-4, 4.00e8, 2.50e11, 0.23, 1.30e11, 0.28, 1.00e-1),\n        (5.0e-5, 5.25e-4, 4.00e8, 2.50e11, 0.23, 1.30e11, 0.28, 1.00e-1),\n        (1.0e-7, 5.25e-4, 4.00e8, 2.50e11, 0.23, 1.30e11, 0.28, 1.00e-1),\n        (1.0e-6, 5.25e-4, 0.0, 2.50e11, 0.23, 1.30e11, 0.28, 1.00e-1),\n        (1.0e-6, 5.25e-4, 4.00e8, 1.30e11, 0.28, 1.30e11, 0.28, 1.00e-1)\n    ]\n\n    results = []\n    for params in test_cases:\n        results.append(calculate_bow_metrics(params))\n\n    # Format the final output string as specified: [[r1,r2,...], [s1,s2,...]]\n    # str() on a list correctly formats it as \"[item1, item2, ...]\"\n    # Joining these strings with a comma creates the desired list of lists format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef calculate_bow_metrics(params):\n    \"\"\"\n    Calculates curvature, discrepancy, and bow for a single film-substrate system.\n    \n    Args:\n        params (tuple): A tuple containing the system parameters:\n                        (t_f, t_s, sigma_f, E_f, nu_f, E_s, nu_s, a).\n\n    Returns:\n        list: A list of four floats: [k_stoney, k_fea, delta, w_bow].\n    \"\"\"\n    tf, ts, sigma_f, Ef, nuf, Es, nus, a = params\n\n    # Trivial case: zero residual stress results in zero curvature and bow.\n    if sigma_f == 0.0:\n        return [0.0, 0.0, 0.0, 0.0]\n\n    # Calculate biaxial moduli M = E / (1 - nu)\n    Mf = Ef / (1.0 - nuf)\n    Ms = Es / (1.0 - nus)\n\n    # 1. Stoney-based curvature (k_stoney)\n    # k_stoney = 6 * sigma_f * t_f / (M_s * t_s^2)\n    k_stoney = (6.0 * sigma_f * tf) / (Ms * ts**2)\n\n    # 2. FEA-style curvature from exact bilayer plate theory (k_fea)\n    # This involves solving the 2x2 system derived from first principles.\n    # [ A B ] [epsilon_0] = [N*]\n    # [ B D ] [    k    ]   [M*]\n\n    # Assemble stiffness matrix components (integrals over thickness)\n    # A = integral(M(z) dz)\n    A = Ms * ts + Mf * tf\n    \n    # B = integral(z*M(z) dz), with z=0 at substrate midplane\n    B = Mf * tf * (ts / 2.0 + tf / 2.0)\n    \n    # D = integral(z^2*M(z) dz), using parallel axis theorem for convenience\n    D_s = Ms * ts**3 / 12.0\n    d_film_centroid = ts / 2.0 + tf / 2.0\n    D_f = Mf * tf**3 / 12.0 + Mf * tf * d_film_centroid**2\n    D = D_s + D_f\n\n    # Assemble load vector components from eigenstrain\n    # N* = integral(M(z)*eps*(z) dz) = sigma_f * t_f\n    N_star = sigma_f * tf\n    # M* = integral(z*M(z)*eps*(z) dz)\n    M_star = sigma_f * tf * (ts / 2.0 + tf / 2.0)\n\n    # Solve for curvature k_fea = (A*M* - B*N*) / (A*D - B^2)\n    determinant = A * D - B**2\n    if np.isclose(determinant, 0):\n        k_fea = 0.0 # Occurs only in physically degenerate cases\n    else:\n        k_fea = (A * M_star - B * N_star) / determinant\n\n    # 3. Discrepancy (delta)\n    # delta = (k_fea - k_stoney) / k_fea\n    if np.isclose(k_fea, 0):\n        delta = 0.0 # Physically, no curvature means no discrepancy\n    else:\n        # Note: The problem asks for (k_fea - k_stoney) / k_fea.\n        # It is known Stoney's formula often overpredicts curvature for non-ideal\n        # thin films, which would make k_stoney > k_fea, and thus delta negative.\n        # This implementation strictly follows the provided formula.\n        delta = (k_fea - k_stoney) / k_fea\n\n    # 4. Bow at wafer edge (w_bow)\n    # w_bow = k_fea * a^2 / 2\n    w_bow = k_fea * a**2 / 2.0\n\n    return [k_stoney, k_fea, delta, w_bow]\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}