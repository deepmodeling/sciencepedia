{
    "hands_on_practices": [
        {
            "introduction": "我们从一个经典的热弹性力学问题开始，旨在揭示热应力的基本物理根源。通过分析一个在均匀温度变化下两端固定的简单一维杆，我们可以推导出应力与材料属性（如杨氏模量 $E$ 和热膨胀系数 $\\alpha$）以及温度变化 $\\Delta T$ 之间的核心关系。这项练习  将帮助您掌握在受约束系统中，热膨胀如何直接转化为机械应力的基本原理，为后续更复杂的分析奠定坚实的基础。",
            "id": "4174864",
            "problem": "在半导体前端热循环中，考虑一个窄的、均匀的、各向同性的、线性热弹性的互连线，该互连线被建模为一个一维杆，其长度为$L$，横截面积为$A$，材料属性为杨氏模量$E$和热膨胀系数(CTE)$\\alpha$。该杆的两端通过光刻定义的焊盘被刚性固定，因此两端的轴向位移为零。在均匀的炉温升降过程中，相对于无应力参考温度，该杆经历一个空间上均匀的温度变化$\\Delta T$。假设小应变、无塑性、无蠕变，并忽略轴向体力。将状态视为一维，具有轴向柯西应力$\\sigma(x)$和轴向应变$\\varepsilon(x)$。\n\n从基本运动学($\\varepsilon = \\mathrm{d}u/\\mathrm{d}x$)、无轴向体力时的平衡方程，以及结合了机械应变和热膨胀的各向同性材料的线性热弹性本构定律出发，推导整个杆中轴向柯西应力$\\sigma(x)$的唯一闭式表达式，用$E$、$\\alpha$和$\\Delta T$表示。使用拉应力为正的符号约定。请将$\\sigma(x)$的最终表达式以单个闭式解析表达式的形式提供。不需要进行数值计算，也不需要四舍五入。最终表达式中不应包含单位。",
            "solution": "该问题首先经过严格的验证过程。\n\n### 步骤1：提取已知条件\n- **模型**：一维杆\n- **几何**：长度 $L$，横截面积 $A$\n- **材料属性**：均匀、各向同性、线性热弹性、杨氏模量 $E$、热膨胀系数 (CTE) $\\alpha$\n- **边界条件**：两端刚性固定，因此在 $x=0$ 和 $x=L$ 处的轴向位移 $u(x)$ 为零，即 $u(0)=0$ 和 $u(L)=0$。\n- **载荷**：均匀温度变化 $\\Delta T$\n- **假设**：小应变、无塑性、无蠕变、可忽略的轴向体力\n- **状态变量**：轴向柯西应力 $\\sigma(x)$，轴向应变 $\\varepsilon(x)$\n- **基本关系**：\n    - 运动学：$\\varepsilon = \\mathrm{d}u/\\mathrm{d}x$\n    - 平衡：无轴向体力\n    - 本构定律：各向同性材料的线性热弹性\n- **符号约定**：拉应力为正\n- **目标**：推导轴向柯西应力 $\\sigma(x)$ 的唯一闭式表达式\n\n### 步骤2：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n- **科学依据**：该问题是线性热弹性力学中的一个典型例子，是固体力学和材料科学的核心课题。它基于连续介质力学的基本原理（平衡、运动学、本构关系），在科学上是合理的。\n- **适定性**：该问题是适定的。控制方程、材料属性、几何形状和边界条件都已指定，足以确定应力场的唯一解。\n- **客观性**：该问题使用工程和物理学中精确、标准的术语进行陈述。没有主观或模棱两可的语言。\n- **完整性与一致性**：该问题是自洽的，并提供了所有必要的信息。条件是一致的，不会导致矛盾。\n- **真实性**：该模型代表了分析半导体互连中热机械应力时使用的标准理想化。这些假设（例如，线性弹性、完美夹持）是常见的，并为一阶分析构成了有效的基础。\n- **结构与平凡性**：该问题结构良好，需要系统地应用基本原理。虽然是标准问题，但并非微不足道，可作为对热力学理解的有效评估。\n\n### 步骤3：结论与行动\n该问题是**有效的**，因为它有科学依据、适定、客观且完整。将推导解答。\n\n推导过程结合了固体力学的三个基本支柱：平衡、运动学和本构定律，并遵循指定的边界条件。\n\n1.  **平衡方程**：对于带有轴向力 $N(x)$ 和分布轴向体力 $b(x)$ 的物体，其一维平衡方程为 $\\frac{\\mathrm{d}N}{\\mathrm{d}x} + b(x) = 0$。问题说明轴向体力可忽略，因此 $b(x)=0$。平衡方程简化为 $\\frac{\\mathrm{d}N}{\\mathrm{d}x} = 0$。这意味着内轴向力 $N$ 沿杆的长度是恒定的。由于轴向应力 $\\sigma(x)$ 定义为 $\\sigma(x) = \\frac{N(x)}{A}$，且横截面积 $A$ 是均匀的，所以应力 $\\sigma(x)$ 也必定是恒定的。将此恒定应力表示为 $\\sigma_0$。\n    $$ \\frac{\\mathrm{d}\\sigma}{\\mathrm{d}x} = 0 \\implies \\sigma(x) = \\sigma_0 $$\n\n2.  **本构定律**：对于线性热弹性材料，总轴向应变 $\\varepsilon(x)$ 是由应力引起的机械应变 $\\varepsilon_{\\text{mech}}(x)$ 和由温度变化引起的热应变 $\\varepsilon_{\\text{th}}(x)$ 之和。\n    $$ \\varepsilon(x) = \\varepsilon_{\\text{mech}}(x) + \\varepsilon_{\\text{th}}(x) $$\n    机械应变由胡克定律给出：$\\varepsilon_{\\text{mech}}(x) = \\frac{\\sigma(x)}{E}$。对于均匀温度变化 $\\Delta T$，热应变为 $\\varepsilon_{\\text{th}}(x) = \\alpha \\Delta T$。符号约定意味着正的 $\\Delta T$ (加热) 会导致正的 (拉伸) 应变。\n    将这些结合起来，本构关系为：\n    $$ \\varepsilon(x) = \\frac{\\sigma(x)}{E} + \\alpha \\Delta T $$\n\n3.  **运动学关系**：对于小应变，轴向应变 $\\varepsilon(x)$ 通过应变-位移关系与轴向位移场 $u(x)$ 相关联：\n    $$ \\varepsilon(x) = \\frac{\\mathrm{d}u}{\\mathrm{d}x} $$\n\n结合这三个关系，我们可以推导出位移的表达式。将平衡结果 ($\\sigma(x) = \\sigma_0$) 和本构定律代入运动学关系中：\n$$ \\frac{\\mathrm{d}u}{\\mathrm{d}x} = \\frac{\\sigma_0}{E} + \\alpha \\Delta T $$\n由于右侧相对于 $x$ 是常数，我们可以对该微分方程进行积分，以求得位移场 $u(x)$：\n$$ \\int_0^x \\mathrm{d}u = \\int_0^x \\left(\\frac{\\sigma_0}{E} + \\alpha \\Delta T\\right) \\mathrm{d}x' $$\n$$ u(x) - u(0) = \\left(\\frac{\\sigma_0}{E} + \\alpha \\Delta T\\right) x $$\n\n4.  **应用边界条件**：问题陈述杆的两端（位于 $x=0$ 和 $x=L$）被刚性固定。这可转换为边界条件 $u(0)=0$ 和 $u(L)=0$。\n    将第一个边界条件 $u(0)=0$ 应用于积分后的位移方程：\n    $$ u(x) - 0 = \\left(\\frac{\\sigma_0}{E} + \\alpha \\Delta T\\right) x \\implies u(x) = \\left(\\frac{\\sigma_0}{E} + \\alpha \\Delta T\\right) x $$\n    现在，我们应用第二个边界条件 $u(L)=0$：\n    $$ u(L) = \\left(\\frac{\\sigma_0}{E} + \\alpha \\Delta T\\right) L = 0 $$\n    由于杆的长度 $L$ 非零，为使等式成立，括号中的项必须为零：\n    $$ \\frac{\\sigma_0}{E} + \\alpha \\Delta T = 0 $$\n\n5.  **求解应力**：现在我们可以求解这个代数方程，得到未知的恒定应力 $\\sigma_0$：\n    $$ \\frac{\\sigma_0}{E} = - \\alpha \\Delta T $$\n    $$ \\sigma_0 = -E \\alpha \\Delta T $$\n    由于我们从平衡条件中确定了应力 $\\sigma(x)$ 是恒定的且等于 $\\sigma_0$，因此整个杆内的轴向柯西应力的最终表达式为：\n    $$ \\sigma(x) = -E \\alpha \\Delta T $$\n这一结果表明应力沿杆是均匀的，加热时（$\\Delta T > 0$）为压应力（负 $\\sigma$），冷却时（$\\Delta T  0$）为拉应力（正 $\\sigma$）。应力与杆的长度 $L$ 和横截面积 $A$ 无关，因为本应发生的总热膨胀（$\\alpha \\Delta T L$）被一个大小相等、方向相反的机械压缩完全抵消。",
            "answer": "$$\n\\boxed{-E \\alpha \\Delta T}\n$$"
        },
        {
            "introduction": "在理解了应力的来源之后，下一个关键问题是：这些应力会导致什么后果？此练习将热应力分析与材料的可靠性联系起来，探讨了薄膜分层这一半导体制造中的常见失效模式。您将运用能量平衡原理 ，通过比较薄膜中存储的弹性应变能释放率与界面断裂韧性，来确定导致分层失效的临界温降 $\\Delta T_c$。这个实践将使您能够量化热失配对器件结构完整性的威胁。",
            "id": "4174849",
            "problem": "一块化学计量的氮化硅（$\\text{Si}_3\\text{N}_4$）钝化膜，厚度为 $h_f = 5.00 \\times 10^{-7}\\,\\mathrm{m}$，在高温沉积时以无应力状态沉积在一块厚得多的电镀铜基底上，因此基底可被视作面内刚性。在均匀冷却、温降为 $\\Delta T$ 的过程中，薄膜和基底之间的热膨胀失配会在薄膜中引起等双轴面内应力。假设薄膜是线性弹性的，其杨氏模量 $E_f = 2.50 \\times 10^{11}\\,\\mathrm{Pa}$，泊松比 $\\nu_f = 0.23$，热膨胀系数 $\\alpha_f = 3.0 \\times 10^{-6}\\,\\text{K}^{-1}$。基底的热膨胀系数为 $\\alpha_s = 17.0 \\times 10^{-6}\\,\\text{K}^{-1}$。忽略塑性、粘弹性、时间依赖性以及初始时的任何非线性几何效应。假设当一个直线界面分层前沿准静态扩展时，新脱粘的薄膜区域会完全释放其面内应力，并且初始时的任何弯曲能都可忽略不计，因此总势能的减少量等于先前存储在该薄膜区域的弹性应变能。界面断裂遵循线性弹性断裂力学（LEFM），界面韧性为 $G_c = 5.0\\,\\mathrm{J\\,m^{-2}}$。\n\n从包含热应变的胡克定律和弹性应变能密度的定义出发，使用能量平衡来确定界面分层开始发生时的临界温降 $\\Delta T_c$。以 $\\mathrm{K}$ 为单位表示最终答案，并四舍五入到三位有效数字。最终答案必须是单个实数值。",
            "solution": "该问题要求确定导致氮化硅薄膜从铜基底发生界面分层的临界温降 $\\Delta T_c$。该解决方案基于从线性弹性断裂力学（LEFM）原理推导出的能量平衡准则。\n\n分层开始的基本条件是应变能释放率 $G$ 必须达到界面的临界值，即界面韧性 $G_c$。\n$$G \\ge G_c$$\n分层在等式成立时开始，此时裂纹扩展的驱动力恰好与材料的阻力相平衡。\n$$G = G_c$$\n问题指出，分层发生时，薄膜会完全释放其面内应力，且弯曲能可忽略不计。这意味着每单位分层面积释放的应变能 $G$ 等于分层前薄膜每单位面积存储的总弹性应变能。每单位面积存储的能量是应变能密度 $U$ 与薄膜厚度 $h_f$ 的乘积。\n$$G = U h_f$$\n我们的首要任务是推导薄膜中应变能密度 $U$ 的表达式。由于与基底的热膨胀失配，薄膜处于等双轴应力状态（$\\sigma_x = \\sigma_y = \\sigma_f$）。在此条件下，线性弹性材料的应变能密度由下式给出：\n$$U = \\frac{1}{2}(\\sigma_x \\epsilon_x^e + \\sigma_y \\epsilon_y^e)$$\n由于两个面内方向上的应力和弹性应变相等（$\\epsilon_x^e = \\epsilon_y^e = \\epsilon_f^{elastic}$），上式可简化为：\n$$U = \\frac{1}{2}(2\\sigma_f \\epsilon_f^{elastic}) = \\sigma_f \\epsilon_f^{elastic}$$\n接下来，我们必须确定弹性应变 $\\epsilon_f^{elastic}$ 和由此产生的应力 $\\sigma_f$。问题说明薄膜在高温下是无应力沉积的。当冷却温降为 $\\Delta T > 0$ 时，会产生热应变。假设基底是刚性的，这意味着它不会因薄膜施加的应力而发生弹性变形。因此，薄膜的总面内应变 $\\epsilon_f^{total}$ 必须与基底的热应变相匹配。\n基底的热应变为 $\\epsilon_s^{thermal} = \\alpha_s (-\\Delta T)$，其中 $\\alpha_s$ 是基底的热膨胀系数。\n$$\\epsilon_f^{total} = \\epsilon_s^{thermal} = -\\alpha_s \\Delta T$$\n薄膜中的总应变是其弹性应变和其自身热应变 $\\epsilon_f^{thermal} = \\alpha_f (-\\Delta T)$ 的总和。\n$$\\epsilon_f^{total} = \\epsilon_f^{elastic} + \\epsilon_f^{thermal}$$\n通过重新整理，我们可以求解薄膜中的弹性应变：\n$$\\epsilon_f^{elastic} = \\epsilon_f^{total} - \\epsilon_f^{thermal} = (-\\alpha_s \\Delta T) - (-\\alpha_f \\Delta T) = (\\alpha_f - \\alpha_s)\\Delta T$$\n由于 $\\alpha_s > \\alpha_f$，弹性应变 $\\epsilon_f^{elastic}$ 为负，表明薄膜处于压缩状态，这与预期相符。\n\n现在我们对处于平面应力（$\\sigma_z = 0$）状态下的薄膜应用胡克定律。等双轴面内应力 $\\sigma_f$ 与面内弹性应变 $\\epsilon_f^{elastic}$ 之间的关系为：\n$$\\epsilon_f^{elastic} = \\frac{1}{E_f}(\\sigma_f - \\nu_f \\sigma_f) = \\frac{\\sigma_f}{E_f}(1 - \\nu_f)$$\n其中 $E_f$ 是薄膜的杨氏模量，$\\nu_f$ 是其泊松比。\n求解应力 $\\sigma_f$：\n$$\\sigma_f = \\frac{E_f}{1 - \\nu_f} \\epsilon_f^{elastic} = \\frac{E_f}{1 - \\nu_f}(\\alpha_f - \\alpha_s)\\Delta T$$\n$\\frac{E_f}{1 - \\nu_f}$ 项被称为双轴模量，记为 $M_f$。\n\n我们现在可以用温降 $\\Delta T$ 来表示应变能密度 $U$：\n$$U = \\sigma_f \\epsilon_f^{elastic} = \\left(\\frac{E_f}{1 - \\nu_f}\\epsilon_f^{elastic}\\right)\\epsilon_f^{elastic} = \\frac{E_f}{1 - \\nu_f}(\\epsilon_f^{elastic})^2$$\n代入 $\\epsilon_f^{elastic}$ 的表达式：\n$$U = \\frac{E_f}{1 - \\nu_f} \\left((\\alpha_f - \\alpha_s)\\Delta T\\right)^2 = \\frac{E_f}{1 - \\nu_f} (\\alpha_s - \\alpha_f)^2 (\\Delta T)^2$$\n那么应变能释放率为：\n$$G = h_f U = h_f \\frac{E_f}{1 - \\nu_f} (\\alpha_s - \\alpha_f)^2 (\\Delta T)^2$$\n在分层开始时，有 $G = G_c$ 和 $\\Delta T = \\Delta T_c$：\n$$G_c = h_f \\frac{E_f}{1 - \\nu_f} (\\alpha_s - \\alpha_f)^2 (\\Delta T_c)^2$$\n我们现在求解临界温降 $\\Delta T_c$：\n$$(\\Delta T_c)^2 = \\frac{G_c (1 - \\nu_f)}{h_f E_f (\\alpha_s - \\alpha_f)^2}$$\n$$\\Delta T_c = \\sqrt{\\frac{G_c (1 - \\nu_f)}{h_f E_f (\\alpha_s - \\alpha_f)^2}} = \\frac{1}{\\alpha_s - \\alpha_f} \\sqrt{\\frac{G_c (1 - \\nu_f)}{h_f E_f}}$$\n我们取正根，因为 $\\Delta T_c$ 代表一个量值。\n\n最后，我们代入给定的数值：\n$G_c = 5.0\\,\\mathrm{J\\,m^{-2}}$\n$h_f = 5.00 \\times 10^{-7}\\,\\mathrm{m}$\n$E_f = 2.50 \\times 10^{11}\\,\\mathrm{Pa}$\n$\\nu_f = 0.23$\n$\\alpha_f = 3.0 \\times 10^{-6}\\,\\text{K}^{-1}$\n$\\alpha_s = 17.0 \\times 10^{-6}\\,\\text{K}^{-1}$\n\n首先，我们计算中间项：\n$$1 - \\nu_f = 1 - 0.23 = 0.77$$\n$$\\alpha_s - \\alpha_f = (17.0 \\times 10^{-6} - 3.0 \\times 10^{-6})\\,\\mathrm{K^{-1}} = 14.0 \\times 10^{-6}\\,\\mathrm{K^{-1}}$$\n$$h_f E_f = (5.00 \\times 10^{-7}\\,\\mathrm{m})(2.50 \\times 10^{11}\\,\\mathrm{Pa}) = 1.25 \\times 10^5\\,\\mathrm{N\\,m^{-1}} = 1.25 \\times 10^5\\,\\mathrm{J\\,m^{-2}}$$\n现在我们计算 $\\Delta T_c$ 的表达式：\n$$\\Delta T_c = \\frac{1}{14.0 \\times 10^{-6}\\,\\mathrm{K^{-1}}} \\sqrt{\\frac{(5.0\\,\\mathrm{J\\,m^{-2}})(0.77)}{1.25 \\times 10^5\\,\\mathrm{J\\,m^{-2}}}}$$\n$$\\Delta T_c = \\frac{1}{14.0 \\times 10^{-6}} \\sqrt{\\frac{3.85}{1.25 \\times 10^5}}\\,\\mathrm{K}$$\n$$\\Delta T_c = \\frac{1}{14.0 \\times 10^{-6}} \\sqrt{3.08 \\times 10^{-5}}\\,\\mathrm{K}$$\n$$\\Delta T_c = \\frac{1}{14.0 \\times 10^{-6}} (0.00554977...)\\,\\mathrm{K}$$\n$$\\Delta T_c \\approx 396.41248...\\,\\mathrm{K}$$\n按照要求将结果四舍五入到三位有效数字：\n$$\\Delta T_c \\approx 396\\,\\mathrm{K}$$",
            "answer": "$$\\boxed{396}$$"
        },
        {
            "introduction": "现实世界中的半导体结构，如硅通孔（TSV），其复杂的几何形状和多层材料结构往往超出了简单解析模型的适用范围。这个压轴实践将引导您从解析分析过渡到数值建模，这是现代工程设计的核心技能。您将亲手构建一个程序 ，用于求解多层圆柱体在平面应变条件下的热应力场，并将其与经典的解析解进行对比验证。这项练习不仅能加深您对复杂系统中应力分布的理解，还能让您体验到模型验证在计算模拟中的重要性。",
            "id": "4174920",
            "problem": "一个硅通孔被建模为一个处于平面应变状态下的同轴、完美键合、轴对称多层圆柱体，由一个金属芯、一个可选的电介质衬层以及周围的硅基体组成。均匀的温度变化会引起各层之间的热膨胀失配，从而产生残余热机械应力。任务是使用一个假设无限大基体且无衬层的经典解析夹杂物解，来验证多层结构应力场的数值解，并量化由有限外半径和衬层存在所引起的差异。\n\n从第一性原理出发，使用以下基本原理：\n- 轴对称条件下的柱坐标系平衡方程：$$\\frac{d\\sigma_r}{dr} + \\frac{\\sigma_r - \\sigma_\\theta}{r} = 0$$。\n- 均匀温度变化下平面应变状态的线性各向同性热弹性力学：$$\\boldsymbol{\\sigma} = 2\\mu\\left(\\boldsymbol{\\varepsilon} - \\boldsymbol{\\varepsilon}^{th}\\right) + \\lambda \\operatorname{tr}\\left(\\boldsymbol{\\varepsilon} - \\boldsymbol{\\varepsilon}^{th}\\right)\\mathbf{I}$$，其中 $$\\boldsymbol{\\varepsilon}^{th} = \\alpha \\Delta T\\, \\mathbf{I}$$，且总应变的 $\\varepsilon_z=0$，并且轴对称性消除了剪切分量。\n\n对于每个内半径为 $r_i$、外半径为 $r_{i+1}$ 的同心层 $i$，假设其满足平衡方程的力学（机械）位移场为 $u_i(r) = A_i r + \\frac{B_i}{r}$。力学（机械）应变为 $\\varepsilon_{r,i}^{mech} = \\frac{du_i}{dr} = A_i - \\frac{B_i}{r^2}$ 和 $\\varepsilon_{\\theta,i}^{mech} = \\frac{u_i}{r} = A_i + \\frac{B_i}{r^2}$。则层 $i$ 中的应力为：\n$$\\sigma_{r,i}(r) = 2(\\mu_i + \\lambda_i) A_i - \\lambda_i \\alpha_i \\Delta T - \\frac{2\\mu_i B_i}{r^2}$$,\n$$\\sigma_{\\theta,i}(r) = 2(\\mu_i + \\lambda_i) A_i - \\lambda_i \\alpha_i \\Delta T + \\frac{2\\mu_i B_i}{r^2}$$.\n\n施加以下边界和界面条件：\n- 芯部中心处的位移有限，意味着最内层的 $B_0 = 0$。\n- 外半径 $R_{out}$ 处的外边界为无曳引边界，要求最外层 $n-1$ 满足 $\\sigma_{r,n-1}(R_{out}) = 0$。\n- 每个界面 $r_{i+1}$ 处为完美键合，要求位移连续 $u_i(r_{i+1}) = u_{i+1}(r_{i+1})$ 和径向应力连续 $\\sigma_{r,i}(r_{i+1}) = \\sigma_{r,i+1}(r_{i+1})$。\n\n求解生成的线性方程组，得到所有层的未知常数 $A_i, B_i$。使用这些常数计算硅基体中指定半径处的环向应力 $\\sigma_\\theta(r)$。\n\n对于解析夹杂物参考解，假设在平面应变条件下，一个半径为 $a$ 的金属圆柱形夹杂物被一个无限大的无衬层硅基体所包围。基体的位移在无穷远处衰减，这意味着 $A_{matrix} = 0$。在 $r=a$ 处施加界面条件，可得到夹杂物的力学参数：\n$$A_{inc} = \\frac{\\lambda_{inc}\\alpha_{inc} - \\lambda_{Si}\\alpha_{Si}}{2(\\mu_{inc} + \\lambda_{inc} + \\mu_{Si})}\\,\\Delta T$$.\n在解析夹杂物模型中，半径 $r \\ge a$ 处的硅中环向应力为：\n$$\\sigma_{\\theta}^{\\infty}(r) = -\\lambda_{Si}\\alpha_{Si}\\Delta T + \\frac{2\\mu_{Si} A_{inc} a^2}{r^2}$$.\n\n您必须实现一个程序，该程序：\n1. 为轴对称同心层构建并求解多层平面应变热弹性问题，以获得 $A_i, B_i$。\n2. 在三个评估半径 $r_1, r_2, r_3$ 处计算硅的环向应力 $\\sigma_\\theta(r)$，这些半径的选择旨在探测近界面和中场行为。令 $r_{Si,in}$ 表示硅层的内半径。定义 $r_1 = r_{Si,in} (1 + 10^{-9})$，$r_2 = \\max(2a, 1.1\\, r_{Si,in})$，$r_3 = \\max(5a, 1.2\\, r_{Si,in})$，确保所有半径都位于硅层内。\n3. 仅使用铜和硅的参数，计算 $k \\in \\{1,2,3\\}$ 对应的解析夹杂物环向应力 $\\sigma_{\\theta}^{\\infty}(r_k)$。\n4. 报告在 $\\{r_1, r_2, r_3\\}$ 上的相对误差均方根（RMSRE）：\n$$\\mathrm{RMSRE} = \\sqrt{\\frac{1}{3}\\sum_{k=1}^{3}\\left(\\frac{\\sigma_{\\theta}^{num}(r_k) - \\sigma_{\\theta}^{\\infty}(r_k)}{\\max(|\\sigma_{\\theta}^{\\infty}(r_k)|, \\epsilon)}\\right)^2}$$,\n其中 $\\epsilon = 10^{-9}$ 以避免除以零。RMSRE 是无量纲的。\n\n物理单位和常数：\n- 半径单位为米。\n- Young 模量单位为帕斯卡。\n- Poisson 比无量纲。\n- 热膨胀系数单位为每开尔文。\n- 温差单位为开尔文。\n- 内部计算的应力单位为帕斯卡；但最终报告的 RMSRE 是无量纲的。\n\n使用以下测试套件实现程序，该套件反映了典型、边界和边缘情况。材料属性在物理上是合理的且自洽的。\n\n令铜为芯，硅为基体，二氧化硅为可选衬层。\n- 铜：$E_{\\text{Cu}} = 110\\times 10^9\\,\\text{Pa}$, $\\nu_{\\text{Cu}} = 0.34$, $\\alpha_{\\text{Cu}} = 16.5\\times 10^{-6}\\,\\text{K}^{-1}$。\n- 二氧化硅：$E_{\\text{SiO}_2} = 70\\times 10^9\\,\\text{Pa}$, $\\nu_{\\text{SiO}_2} = 0.17$, $\\alpha_{\\text{SiO}_2} = 0.55\\times 10^{-6}\\,\\text{K}^{-1}$。\n- 硅：$E_{\\text{Si}} = 130\\times 10^9\\,\\text{Pa}$, $\\nu_{\\text{Si}} = 0.28$, $\\alpha_{\\text{Si}} = 2.6\\times 10^{-6}\\,\\text{K}^{-1}$。\n\n测试用例，每个用例为一个元组 $(a, t_{ox}, R_{out}, \\Delta T)$:\n1. `(5e-6, 0.5e-6, 200e-6, -250)`: 带有衬层和有限外半径的典型通孔，冷却载荷。\n2. `(5e-6, 0, 200e-6, -250)`: 无衬层，有限外半径。\n3. `(5e-6, 0.5e-6, 1e-2, -250)`: 极大的外半径，用以近似带有衬层的无限大基体。\n4. `(5e-6, 0.5e-6, 200e-6, -1)`: 小温差，用以测试数值缩放和线性度。\n\n您的程序应生成单行输出，其中包含每个测试用例的 RMSRE，以逗号分隔的列表形式包含在方括号内，并按测试套件的顺序排列，例如 `[\\mathrm{RMSRE}_1,\\mathrm{RMSRE}_2,\\mathrm{RMSRE}_3,\\mathrm{RMSRE}_4]`。每个条目必须是浮点数。不应打印任何其他文本。",
            "solution": "对于同心层，轴对称平面应变热弹性问题允许一个从平衡和协调性推导出的闭合形式力学（机械）位移拟设。轴对称条件下的径向平衡方程为 $$\\frac{d\\sigma_r}{dr} + \\frac{\\sigma_r - \\sigma_\\theta}{r} = 0$$，对于各向同性、均匀的层且体力为零的情况，通过将位移代入应变定义 $$\\varepsilon_r^{mech} = \\frac{du}{dr}$$ 和 $$\\varepsilon_\\theta^{mech} = \\frac{u}{r}$$ 并使用本构关系，可以证明每一层的力学（机械）位移通解形式为 $$u(r) = A r + \\frac{B}{r}$$。\n\n在平面应变条件下，总应变满足 $\\varepsilon_z = 0$。对于热应变 $\\boldsymbol{\\varepsilon}^{th} = \\alpha \\Delta T \\mathbf{I}$，应力仅取决于差值 $\\boldsymbol{\\varepsilon} - \\boldsymbol{\\varepsilon}^{th}$。选择总应变使得 $\\varepsilon_r = \\varepsilon_r^{mech} + \\alpha \\Delta T$，$\\varepsilon_\\theta = \\varepsilon_\\theta^{mech} + \\alpha \\Delta T$，以及 $\\varepsilon_z = 0$，我们有 $\\boldsymbol{\\varepsilon} - \\boldsymbol{\\varepsilon}^{th} = \\operatorname{diag}\\left(\\varepsilon_r^{mech}, \\varepsilon_\\theta^{mech}, -\\alpha \\Delta T\\right)$。代入 $\\boldsymbol{\\sigma} = 2\\mu(\\boldsymbol{\\varepsilon} - \\boldsymbol{\\varepsilon}^{th}) + \\lambda \\operatorname{tr}(\\boldsymbol{\\varepsilon} - \\boldsymbol{\\varepsilon}^{th}) \\mathbf{I}$ 并使用 $\\operatorname{tr}(\\boldsymbol{\\varepsilon} - \\boldsymbol{\\varepsilon}^{th}) = \\varepsilon_r^{mech} + \\varepsilon_\\theta^{mech} - \\alpha \\Delta T = 2A - \\alpha \\Delta T$ 可得：\n$$\\sigma_r(r) = 2\\mu\\left(A - \\frac{B}{r^2}\\right) + \\lambda \\left(2A - \\alpha \\Delta T\\right),$$\n$$\\sigma_\\theta(r) = 2\\mu\\left(A + \\frac{B}{r^2}\\right) + \\lambda \\left(2A - \\alpha \\Delta T\\right).$$\n这些公式在任何具有常数 $A, B$ 和材料参数 $\\mu, \\lambda, \\alpha$ 的层中均有效。静水压力热项 $-\\lambda \\alpha \\Delta T$ 在 $\\sigma_r$ 和 $\\sigma_\\theta$ 中以相同形式出现，它不影响平衡微分方程；相反，它均匀地移动应力，而层与层之间的差异通过连续性条件来解决。\n\n对于一个多层圆柱体，其内半径为 $r_0=0, r_1=a, r_2=a+t_{ox}, r_3=R_{out}$（取决于衬层是否存在），我们为每一层 $i$ 定义未知数 $A_i, B_i$。控制条件如下：\n- 中心处位移有限：由于当 $r \\to 0$ 时 $u(r) = A_0 r + B_0/r$ 必须保持有限，我们要求 $B_0 = 0$。\n- 外边界无曳引：$\\sigma_{r,n-1}(R_{out}) = 0$，其中 $n-1$ 是硅层的索引。\n- 每个界面 $r_{i+1}$ 处完美键合：$u_i(r_{i+1}) = u_{i+1}(r_{i+1})$ 和 $\\sigma_{r,i}(r_{i+1}) = \\sigma_{r,i+1}(r_{i+1})$。\n\n将这些写成线性代数形式：\n- 在 $r$ 处的位移连续性：$A_i r + \\frac{B_i}{r} - A_{i+1} r - \\frac{B_{i+1}}{r} = 0.$\n- 在 $r$ 处的径向应力连续性：\n$$2(\\mu_i + \\lambda_i) A_i - \\lambda_i \\alpha_i \\Delta T - \\frac{2\\mu_i B_i}{r^2} - \\left( 2(\\mu_{i+1} + \\lambda_{i+1}) A_{i+1} - \\lambda_{i+1} \\alpha_{i+1} \\Delta T - \\frac{2\\mu_{i+1} B_{i+1}}{r^2} \\right) = 0.$$\n- 在 $R_{out}$ 处的外边界条件：\n$$2(\\mu_{Si} + \\lambda_{Si}) A_{Si} - \\lambda_{Si} \\alpha_{Si} \\Delta T - \\frac{2\\mu_{Si} B_{Si}}{R_{out}^2} = 0.$$\n- 内部正则性：$B_0 = 0.$\n\n这些方程构成了一个关于未知数 $A_i, B_i$ 的线性系统，可以使用标准的数值线性代数方法求解。一旦获得 $A_i, B_i$，我们就可以在半径 $r_1 = r_{Si,in} (1 + 10^{-9})$，$r_2 = \\max(2a, 1.1\\, r_{Si,in})$ 和 $r_3 = \\max(5a, 1.2\\, r_{Si,in})$ 处，通过上述公式计算硅中的 $\\sigma_{\\theta}(r)$。\n\n对于无限大基体中无衬层的解析夹杂物模型，我们通过要求在无穷远处衰减来设置 $A_{matrix} = 0$，而 $B_{matrix}$ 由 $r=a$ 处的界面条件确定。位移的连续性 $u_{inc}(a) = u_{matrix}(a)$ 给出 $A_{inc} a = \\frac{B_{matrix}}{a}$，即 $B_{matrix} = A_{inc} a^2$。在 $r=a$ 处的径向应力连续性给出：\n$$2(\\mu_{inc} + \\lambda_{inc}) A_{inc} - \\lambda_{inc} \\alpha_{inc} \\Delta T = - \\lambda_{Si} \\alpha_{Si} \\Delta T - \\frac{2\\mu_{Si} B_{matrix}}{a^2}.$$\n代入 $B_{matrix} = A_{inc} a^2$ 可得：\n$$\\left[2(\\mu_{inc} + \\lambda_{inc}) + 2\\mu_{Si}\\right] A_{inc} = \\left(\\lambda_{inc} \\alpha_{inc} - \\lambda_{Si} \\alpha_{Si}\\right)\\Delta T,$$\n所以\n$$A_{inc} = \\frac{\\lambda_{inc}\\alpha_{inc} - \\lambda_{Si}\\alpha_{Si}}{2(\\mu_{inc} + \\lambda_{inc} + \\mu_{Si})}\\,\\Delta T.$$\n因此，在无限大基体解析夹杂物模型中，对于 $r \\ge a$ 的硅中环向应力为：\n$$\\sigma_{\\theta}^{\\infty}(r) = -\\lambda_{Si}\\alpha_{Si}\\Delta T + \\frac{2\\mu_{Si} A_{inc} a^2}{r^2}.$$\n\n为了量化可归因于几何真实性（有限外半径和衬层存在）的差异，我们为每个测试用例计算三个半径上的相对误差均方根：\n$$\\mathrm{RMSRE} = \\sqrt{\\frac{1}{3}\\sum_{k=1}^{3}\\left(\\frac{\\sigma_{\\theta}^{num}(r_k) - \\sigma_{\\theta}^{\\infty}(r_k)}{\\max(|\\sigma_{\\theta}^{\\infty}(r_k)|, \\epsilon)}\\right)^2}},$$\n其中 $\\epsilon = 10^{-9}$ 以防止除以零。这个无量纲的度量标准清晰地将几何和边界条件的影响与材料缩放分离开来，并测试了数值多层解与经典夹杂物理论的一致性。\n\n算法如下：\n- 对每个测试用例，组合各层的半径和材料参数 $E_i, \\nu_i, \\alpha_i$，并计算 $\\mu_i, \\lambda_i$。\n- 使用界面和边界条件构建关于 $A_i, B_i$ 的线性系统；将热项分离到等式右侧。\n- 求解 $A_i, B_i$。\n- 在指定的三个半径处评估硅中的 $\\sigma_\\theta(r)$，并根据铜-硅夹杂物公式计算的 $\\sigma_{\\theta}^{\\infty}(r)$ 计算 $\\mathrm{RMSRE}$。\n- 以指定的单行格式输出 $\\mathrm{RMSRE}$ 浮点数列表。\n\n该测试套件覆盖了具有典型尺寸和冷却的理想情况、无衬层的边界条件、通过极大外半径近似无限大基体的边缘情况，以及一个用于验证线性缩放和数值稳定性的高温差情况。所有使用的值在半导体制造过程建模中都是物理上合理的，应力在内部以帕斯卡为单位计算；最终报告的度量标准按要求是无量纲的。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef lame_parameters(E, nu):\n    \"\"\"Compute Lamé parameters λ and μ for isotropic elasticity.\"\"\"\n    mu = E / (2.0 * (1.0 + nu))\n    lam = E * nu / ((1.0 + nu) * (1.0 - 2.0 * nu))\n    return lam, mu\n\ndef solve_multilayer(a, t_ox, R_out, dT, mats):\n    \"\"\"\n    Solve for A_i, B_i in a multilayer axisymmetric plane-strain cylinder\n    with a metallic core (layer 0), optional oxide liner (layer 1), and silicon (last layer).\n    mats: list of dicts with keys 'E', 'nu', 'alpha' for each layer in order.\n    Returns arrays A, B; layer radii list; and material parameters per layer.\n    \"\"\"\n    # Radii per layer\n    radii = [0.0]\n    radii.append(a)  # interface between core and liner or silicon\n    if t_ox > 0.0:\n        radii.append(a + t_ox)  # interface between liner and silicon\n    radii.append(R_out)  # outer boundary\n    # Define layers based on radii segments\n    # layers: [(r_in, r_out), ...]\n    layers = []\n    for i in range(len(radii) - 1):\n        layers.append((radii[i], radii[i+1]))\n    n_layers = len(layers)\n\n    # Material parameters per layer\n    lam = []\n    mu = []\n    alpha = []\n    for i in range(n_layers):\n        lam_i, mu_i = lame_parameters(mats[i]['E'], mats[i]['nu'])\n        lam.append(lam_i)\n        mu.append(mu_i)\n        alpha.append(mats[i]['alpha'])\n    lam = np.array(lam)\n    mu = np.array(mu)\n    alpha = np.array(alpha)\n\n    # Unknown vector: [A0, B0, A1, B1, ..., A_{n-1}, B_{n-1}]\n    n_unknowns = 2 * n_layers\n    M = np.zeros((n_unknowns, n_unknowns), dtype=float)\n    q = np.zeros(n_unknowns, dtype=float)\n\n    row = 0\n    # Inner regularity: B0 = 0\n    M[row, 1] = 1.0\n    q[row] = 0.0\n    row += 1\n\n    # Interface conditions\n    for i in range(n_layers - 1):\n        r_int = layers[i][1]  # interface radius\n        # Displacement continuity: A_i r + B_i/r - A_{i+1} r - B_{i+1}/r = 0\n        M[row, 2*i] = r_int\n        M[row, 2*i+1] = 1.0 / r_int\n        M[row, 2*(i+1)] = -r_int\n        M[row, 2*(i+1)+1] = -1.0 / r_int\n        q[row] = 0.0\n        row += 1\n\n        # Radial stress continuity:\n        # 2(μ_i+λ_i) A_i - λ_i α_i dT - (2 μ_i / r^2) B_i - [same for i+1] = 0\n        M[row, 2*i] = 2.0 * (mu[i] + lam[i])\n        M[row, 2*i+1] = -2.0 * mu[i] / (r_int**2)\n        M[row, 2*(i+1)] = -2.0 * (mu[i+1] + lam[i+1])\n        M[row, 2*(i+1)+1] = 2.0 * mu[i+1] / (r_int**2)\n        q[row] = lam[i] * alpha[i] * dT - lam[i+1] * alpha[i+1] * dT\n        row += 1\n\n    # Outer boundary traction-free: σ_r_last(R_out) = 0\n    i_last = n_layers - 1\n    r_out = layers[i_last][1]\n    M[row, 2*i_last] = 2.0 * (mu[i_last] + lam[i_last])\n    M[row, 2*i_last+1] = -2.0 * mu[i_last] / (r_out**2)\n    q[row] = lam[i_last] * alpha[i_last] * dT\n    row += 1\n\n    # Solve linear system\n    try:\n        x = np.linalg.solve(M, q)\n    except np.linalg.LinAlgError:\n        # Fallback: least-squares\n        x, *_ = np.linalg.lstsq(M, q, rcond=None)\n    A = x[0::2]\n    B = x[1::2]\n    return A, B, layers, lam, mu, alpha\n\ndef hoop_stress_in_layer(r, layer_index, A, B, lam, mu, alpha, dT):\n    \"\"\"Compute hoop stress σ_theta at radius r in given layer.\"\"\"\n    Ai = A[layer_index]\n    Bi = B[layer_index]\n    li = lam[layer_index]\n    mi = mu[layer_index]\n    alpi = alpha[layer_index]\n    # σ_theta = 2(μ+λ)A - λ α ΔT + 2 μ B / r^2\n    return 2.0 * (mi + li) * Ai - li * alpi * dT + 2.0 * mi * Bi / (r**2)\n\ndef analytical_inclusion_sigma_theta(r, a, mats_core, mats_si, dT):\n    \"\"\"\n    Analytical inclusion hoop stress in silicon for an infinite matrix without liner.\n    σ_θ^∞(r) = -λ_Si α_Si ΔT + 2 μ_Si A_inc a^2 / r^2\n    where A_inc = (λ_inc α_inc - λ_Si α_Si) ΔT / [2(μ_inc + λ_inc + μ_Si)]\n    \"\"\"\n    lam_c, mu_c = lame_parameters(mats_core['E'], mats_core['nu'])\n    lam_si, mu_si = lame_parameters(mats_si['E'], mats_si['nu'])\n    alpha_c = mats_core['alpha']\n    alpha_si = mats_si['alpha']\n    A_inc = (lam_c * alpha_c - lam_si * alpha_si) * dT / (2.0 * (mu_c + lam_c + mu_si))\n    return -lam_si * alpha_si * dT + 2.0 * mu_si * A_inc * (a**2) / (r**2)\n\ndef rms_relative_error(num_vals, ref_vals, eps=1e-9):\n    \"\"\"Compute RMS of relative errors between num_vals and ref_vals.\"\"\"\n    rel_errs = []\n    for n, r in zip(num_vals, ref_vals):\n        denom = max(abs(r), eps)\n        rel_errs.append((n - r) / denom)\n    rel_errs = np.array(rel_errs, dtype=float)\n    return float(np.sqrt(np.mean(rel_errs**2)))\n\ndef solve():\n    # Material properties\n    mats_def = {\n        'Cu': {'E': 110e9, 'nu': 0.34, 'alpha': 16.5e-6},\n        'SiO2': {'E': 70e9, 'nu': 0.17, 'alpha': 0.55e-6},\n        'Si': {'E': 130e9, 'nu': 0.28, 'alpha': 2.6e-6},\n    }\n\n    # Define the test cases from the problem statement.\n    # Each is (a, t_ox, R_out, ΔT)\n    test_cases = [\n        (5e-6, 0.5e-6, 200e-6, -250.0),\n        (5e-6, 0.0,     200e-6, -250.0),\n        (5e-6, 0.5e-6,  1e-2,   -250.0),\n        (5e-6, 0.5e-6,  200e-6, -1.0),\n    ]\n\n    results = []\n    for a, t_ox, R_out, dT in test_cases:\n        # Build materials list per layer: core, optional liner, silicon\n        if t_ox > 0.0:\n            mats_layers = [mats_def['Cu'], mats_def['SiO2'], mats_def['Si']]\n        else:\n            mats_layers = [mats_def['Cu'], mats_def['Si']]\n        # Solve multilayer problem\n        A, B, layers, lam, mu, alpha = solve_multilayer(a, t_ox, R_out, dT, mats_layers)\n\n        # Determine silicon layer index and inner radius\n        si_index = len(layers) - 1  # silicon is always the last layer\n        r_si_in = layers[si_index][0]\n\n        # Evaluation radii in silicon\n        r1 = r_si_in * (1.0 + 1e-9)\n        r2 = max(2.0 * a, 1.1 * r_si_in)\n        r3 = max(5.0 * a, 1.2 * r_si_in)\n\n        # Numerical hoop stresses in silicon\n        sigma_theta_num = []\n        for r_eval in (r1, r2, r3):\n            sigma_theta_num.append(\n                hoop_stress_in_layer(r_eval, si_index, A, B, lam, mu, alpha, dT)\n            )\n\n        # Analytical inclusion hoop stresses (no liner, infinite matrix)\n        mats_core = mats_def['Cu']\n        mats_si = mats_def['Si']\n        sigma_theta_ref = []\n        for r_eval in (r1, r2, r3):\n            sigma_theta_ref.append(\n                analytical_inclusion_sigma_theta(r_eval, a, mats_core, mats_si, dT)\n            )\n\n        # Compute RMS relative error (dimensionless)\n        rmsre = rms_relative_error(sigma_theta_num, sigma_theta_ref, eps=1e-9)\n        results.append(rmsre)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}