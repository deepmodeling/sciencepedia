{
    "hands_on_practices": [
        {
            "introduction": "材料的宏观物理性质深受其微观晶体结构的制约。本练习将引导你运用诺伊曼原理（Neumann's principle），从立方晶体（如硅）的对称性出发，推导其压阻张量的简化形式。通过这个推导，你将能深刻理解描述硅压阻效应的三个独立系数 $\\pi_{11}$、$\\pi_{12}$ 和 $\\pi_{44}$ 的物理来源，这是掌握材料张量性质的一项基本功。",
            "id": "4152387",
            "problem": "钻石立方硅的晶圆级工艺模型需要将薄膜沉积和热循环引起的应力场与沿器件相关方向的电阻率变化联系起来。压阻效应通过一个线性本构关系来建模，该关系描述了电阻率分数变化张量与所施加应力张量之间的关系。考虑一个具有立方点群对称性的中心对称晶体（钻石立方硅）。令二阶对称电阻率分数变化张量表示为 $\\Delta \\rho_{ij}/\\rho_{0}$，二阶对称应力张量表示为 $\\sigma_{kl}$。假设存在一个线性本构关系 $\\Delta \\rho_{ij}/\\rho_{0} = \\pi_{ijkl}\\,\\sigma_{kl}$，其中 $\\pi_{ijkl}$ 是一个四阶材料属性张量（压阻张量），为晶体所固有。\n\n利用材料属性张量在晶体的对称操作下必须保持不变的原理（Neumann原理），并仅使用适用于立方晶体的成熟的张量不变性论证，推导钻石立方硅的四阶张量 $\\pi_{ijkl}$ 的简化形式。然后，将此简化形式写成压缩的Voigt表示法，其中指数映射为 $1 \\rightarrow xx$, $2 \\rightarrow yy$, $3 \\rightarrow zz$, $4 \\rightarrow yz$, $5 \\rightarrow zx$, $6 \\rightarrow xy$，且压缩矩阵乘以按相同Voigt排序书写的应力分量。\n\n最后，作为推导的一部分，通过写出 $\\Delta \\rho_{xx}/\\rho_{0}$ 和 $\\Delta \\rho_{xy}/\\rho_{0}$ 以应力分量和这些系数表示的显式表达式，来确定三个独立的标量系数 $\\pi_{11}$、$\\pi_{12}$ 和 $\\pi_{44}$ 如何控制纵向和剪切响应。不要假设任何数值，也不要使用预先假设张量最终形式的捷径；相反，应使用适用于立方晶体的对称操作来论证从完整的四阶形式到压缩矩阵的简化过程。\n\n你的最终答案必须是用 $\\pi_{11}$、$\\pi_{12}$ 和 $\\pi_{44}$ 表示的Voigt表示法 $6 \\times 6$ $\\pi$ 矩阵。无需四舍五入。无需单位。",
            "solution": "所述问题是有效的。它在科学上基于固态物理和张量分析的原理，特别是Neumann原理应用于像硅这样的立方晶体中的压阻效应。问题提法得当、客观，并包含足够的信息来推导出唯一且有意义的解。这是材料科学中的一个标准且不简单的练习。\n\n起点是中心对称晶体中电阻率张量的分数变化 $\\Delta \\rho_{ij}/\\rho_0$ 与应力张量 $\\sigma_{kl}$ 之间的线性本构关系：\n$$\n\\frac{\\Delta \\rho_{ij}}{\\rho_0} = \\pi_{ijkl} \\sigma_{kl}\n$$\n这里，$\\pi_{ijkl}$ 是四阶压阻张量。使用了爱因斯坦求和约定，意味着对重复的索引 $k$ 和 $l$ 进行求和。\n\n对于晶体，电阻率张量 $\\rho_{ij}$ 是对称的，因此其变化量 $\\Delta \\rho_{ij}$ 也是对称的，这意味着 $\\Delta \\rho_{ij} = \\Delta \\rho_{ji}$。这给压阻张量施加了一个内在对称性：$\\pi_{ijkl} = \\pi_{jikl}$。此外，应力张量 $\\sigma_{kl}$ 是对称的，$\\sigma_{kl} = \\sigma_{lk}$。因此，我们可以不失一般性地定义 $\\pi_{ijkl}$ 在其最后两个索引上是对称的，所以 $\\pi_{ijkl} = \\pi_{ijlk}$。\n\nNeumann原理指出，晶体的材料属性张量在其晶体点群的所有对称操作下必须保持不变。对于一个四阶张量，这个不变性条件表示为：\n$$\n\\pi_{ijkl} = a_{im} a_{jn} a_{ko} a_{lp} \\pi_{mnop}\n$$\n其中 $a_{ij}$ 是晶体给定对称操作的变换矩阵。对于钻石立方硅，相关的点群是中心对称的立方群 $m\\overline{3}m$。我们将应用该群的几个关键对称操作来将 $\\pi_{ijkl}$ 的 $3^4 = 81$ 个分量简化为其独立的非零元素。\n\n首先，考虑绕 $x_3$ 轴（$z$ 轴）旋转 $180^\\circ$（一个二次轴）。变换矩阵 $\\mathbf{a}$ 是：\n$$\n\\mathbf{a} = \\begin{pmatrix} -1  0  0 \\\\ 0  -1  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n让我们测试一个分量如 $\\pi_{1113}$ 的不变性。变换法则给出：\n$$\n\\pi'_{1113} = a_{1m}a_{1n}a_{1o}a_{3p}\\pi_{mnop} = a_{11}a_{11}a_{11}a_{33}\\pi_{1113} = (-1)(-1)(-1)(1)\\pi_{1113} = -\\pi_{1113}\n$$\n为使张量保持不变，我们必须有 $\\pi'_{1113} = \\pi_{1113}$。这导致条件 $\\pi_{1113} = -\\pi_{1113}$，只有当 $\\pi_{1113} = 0$ 时才能满足。这个论证可以推广：任何分量 $\\pi_{ijkl}$，如果其中索引 $3$ 出现的次数为奇数，则该分量必须为零。通过对 $x_1$ 和 $x_2$ 轴应用类似的 $180^\\circ$ 旋转，我们得出结论：任何分量中，如果某个索引（1、2或3）出现的次数为奇数，则该分量必须为零。这显著减少了非零分量的数量。唯一可能不为零的分量是那些每个索引都出现偶数次的分量，例如 $\\pi_{1111}$、$\\pi_{1122}$ 和 $\\pi_{1212}$。\n\n接下来，考虑绕 $x_3$ 轴旋转 $90^\\circ$（一个四次轴）（$x_1 \\rightarrow x_2, x_2 \\rightarrow -x_1, x_3 \\rightarrow x_3$）。变换矩阵是：\n$$\n\\mathbf{a} = \\begin{pmatrix} 0  1  0 \\\\ -1  0  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n将不变性条件应用于 $\\pi_{1111}$：\n$$\n\\pi'_{1111} = a_{1m}a_{1n}a_{1o}a_{1p}\\pi_{mnop} = a_{12}a_{12}a_{12}a_{12}\\pi_{2222} = (1)^4 \\pi_{2222} = \\pi_{2222}\n$$\n不变性要求 $\\pi_{1111} = \\pi'_{1111}$，所以 $\\pi_{1111} = \\pi_{2222}$。通过轴的循环置换（即，绕 $x_1$ 轴应用 $90^\\circ$ 旋转），我们可以证明 $\\pi_{2222} = \\pi_{3333}$。因此，我们得到第一组等效分量：$\\pi_{1111} = \\pi_{2222} = \\pi_{3333}$。\n\n现在考虑分量 $\\pi_{1122}$：\n$$\n\\pi'_{1122} = a_{1m}a_{1n}a_{2o}a_{2p}\\pi_{mnop} = a_{12}a_{12}a_{21}a_{21}\\pi_{2211} = (1)^2(-1)^2 \\pi_{2211} = \\pi_{2211}\n$$\n不变性给出 $\\pi_{1122} = \\pi_{2211}$。应用循环置换得到 $\\pi_{1122} = \\pi_{2233} = \\pi_{3311}$ 和 $\\pi_{2211} = \\pi_{3322} = \\pi_{1133}$。所以，这种形式的所有六个分量都相等。\n\n最后，考虑剪切分量 $\\pi_{2323}$：\n$$\n\\pi'_{2323} = a_{2m}a_{3n}a_{2o}a_{3p}\\pi_{mnop} = a_{21}a_{33}a_{21}a_{33}\\pi_{1313} = (-1)^2(1)^2 \\pi_{1313} = \\pi_{1313}\n$$\n不变性意味着 $\\pi_{2323} = \\pi_{1313}$。循环置换意味着 $\\pi_{1212} = \\pi_{2323} = \\pi_{3131}$。由于内在对称性，我们还有诸如 $\\pi_{1212} = \\pi_{1221} = \\pi_{2112} = \\pi_{2121}$ 之类的关系。\n\n总之，对于立方晶体，压阻张量只有三个独立的非零分量：\n1. $\\pi_{1111}$\n2. $\\pi_{1122}$\n3. $\\pi_{1212}$ (或 $\\pi_{2323}$ 等)\n\n我们现在将此张量表示法转换为压缩的Voigt表示法。映射关系为 $1 \\rightarrow xx$, $2 \\rightarrow yy$, $3 \\rightarrow zz$, $4 \\rightarrow yz$, $5 \\rightarrow zx$, $6 \\rightarrow xy$。我们采用记法，其中 $\\sigma_1 = \\sigma_{xx}$，$\\sigma_4 = \\sigma_{yz}$ 等，类似地 $\\Delta\\rho_1/\\rho_0 = \\Delta\\rho_{xx}/\\rho_0$，$\\Delta\\rho_4/\\rho_0 = \\Delta\\rho_{yz}/\\rho_0$ 等。本构关系写成矩阵方程：\n$$\n\\begin{pmatrix} \\Delta\\rho_1/\\rho_0 \\\\ \\Delta\\rho_2/\\rho_0 \\\\ \\Delta\\rho_3/\\rho_0 \\\\ \\Delta\\rho_4/\\rho_0 \\\\ \\Delta\\rho_5/\\rho_0 \\\\ \\Delta\\rho_6/\\rho_0 \\end{pmatrix}\n= \\left[ \\pi_{IJ} \\right] \\begin{pmatrix} \\sigma_1 \\\\ \\sigma_2 \\\\ \\sigma_3 \\\\ \\sigma_4 \\\\ \\sigma_5 \\\\ \\sigma_6 \\end{pmatrix}\n$$\n为了找到 $6 \\times 6$ 矩阵的分量 $\\pi_{IJ}$，我们展开张量方程并比较各项。对于一个正分量，例如 $\\Delta\\rho_{1}/\\rho_0 = \\Delta\\rho_{xx}/\\rho_0$：\n$$\n\\frac{\\Delta\\rho_{xx}}{\\rho_0} = \\pi_{xx,kl} \\sigma_{kl} = \\pi_{xxxx}\\sigma_{xx} + \\pi_{xxyy}\\sigma_{yy} + \\pi_{xxzz}\\sigma_{zz} + 2\\pi_{xxyz}\\sigma_{yz} + 2\\pi_{xxzx}\\sigma_{zx} + 2\\pi_{xxxy}\\sigma_{xy}\n$$\n因子 $2$ 的出现是因为 $\\sigma_{kl}=\\sigma_{lk}$ 且我们定义了 $\\pi_{ijlk}=\\pi_{ijkl}$。\n等效的Voigt形式是 $\\Delta\\rho_1/\\rho_0 = \\sum_{J=1}^6 \\pi_{1J}\\sigma_J$。比较各项：\n$\\pi_{11} = \\pi_{xxxx} = \\pi_{1111}$\n$\\pi_{12} = \\pi_{xxyy} = \\pi_{1122}$\n$\\pi_{13} = \\pi_{xxzz} = \\pi_{1133}$\n$\\pi_{14} = 2\\pi_{xxyz} = 2\\pi_{1123} = 0$ (根据对称性)\n$\\pi_{15} = 2\\pi_{xxzx} = 2\\pi_{1113} = 0$\n$\\pi_{16} = 2\\pi_{xxxy} = 2\\pi_{1112} = 0$\n使用立方对称关系（$\\pi_{1111}=\\pi_{2222}=\\pi_{3333}$ 和 $\\pi_{1122}=\\pi_{1133}=\\pi_{2211}$ 等），我们确定了常规的标量系数：$\\pi_{11} \\equiv \\pi_{1111}$ 和 $\\pi_{12} \\equiv \\pi_{1122}$。因此，矩阵的左上角 $3 \\times 3$ 块为：\n$$\n\\begin{pmatrix} \\pi_{11}  \\pi_{12}  \\pi_{12} \\\\ \\pi_{12}  \\pi_{11}  \\pi_{12} \\\\ \\pi_{12}  \\pi_{12}  \\pi_{11} \\end{pmatrix}\n$$\n右上角和左下角的 $3 \\times 3$ 块填充为零。\n\n对于一个剪切分量，例如 $\\Delta\\rho_{4}/\\rho_0 = \\Delta\\rho_{yz}/\\rho_0$：\n$$\n\\frac{\\Delta\\rho_{yz}}{\\rho_0} = \\pi_{yz,kl}\\sigma_{kl} = 2\\pi_{yz,yz}\\sigma_{yz} + 2\\pi_{yz,zx}\\sigma_{zx} + 2\\pi_{yz,xy}\\sigma_{xy} + ... (\\text{正应力的系数为零})\n$$\nVoigt形式是 $\\Delta\\rho_4/\\rho_0 = \\sum_{J=1}^6 \\pi_{4J}\\sigma_J$。比较各项：\n$\\pi_{44} = 2\\pi_{yz,yz} = 2\\pi_{2323}$\n$\\pi_{45} = 2\\pi_{yz,zx} = 2\\pi_{2313} = 0$\n$\\pi_{46} = 2\\pi_{yz,xy} = 2\\pi_{2312} = 0$\n根据立方对称性，$\\pi_{1212} = \\pi_{2323} = \\pi_{3131}$，所以对角剪切项都相等。我们将第三个独立的标量系数定义为 $\\pi_{44} \\equiv 2\\pi_{2323}$ (或 $2\\pi_{1212}$)。因此，右下角的 $3 \\times 3$ 块是对角的：\n$$\n\\begin{pmatrix} \\pi_{44}  0  0 \\\\ 0  \\pi_{44}  0 \\\\ 0  0  \\pi_{44} \\end{pmatrix}\n$$\n对于立方晶体，最终的简化Voigt矩阵 $\\left[\\pi_{IJ}\\right]$ 是：\n$$\n\\begin{pmatrix}\n\\pi_{11}  \\pi_{12}  \\pi_{12}  0  0  0 \\\\\n\\pi_{12}  \\pi_{11}  \\pi_{12}  0  0  0 \\\\\n\\pi_{12}  \\pi_{12}  \\pi_{11}  0  0  0 \\\\\n0  0  0  \\pi_{44}  0  0 \\\\\n0  0  0  0  \\pi_{44}  0 \\\\\n0  0  0  0  0  \\pi_{44}\n\\end{pmatrix}\n$$\n最后，我们确定这些系数的物理作用。\n$\\Delta \\rho_{xx}/\\rho_{0}$ 的表达式可从矩阵方程的第一行得到：\n$$\n\\frac{\\Delta \\rho_{xx}}{\\rho_{0}} = \\pi_{11} \\sigma_{xx} + \\pi_{12} \\sigma_{yy} + \\pi_{12} \\sigma_{zz}\n$$\n这里，$\\pi_{11}$ 是纵向系数，将电阻率变化与沿同一轴的应力联系起来。$\\pi_{12}$ 是横向系数，将电阻率变化与沿垂直轴的应力联系起来。\n\n$\\Delta \\rho_{xy}/\\rho_{0}$ 的表达式从第六行得到：\n$$\n\\frac{\\Delta \\rho_{xy}}{\\rho_{0}} = \\pi_{44} \\sigma_{xy}\n$$\n这里，$\\pi_{44}$ 是剪切系数，将电阻率张量的非对角（剪切）分量与相应的剪切应力联系起来。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\pi_{11}  \\pi_{12}  \\pi_{12}  0  0  0 \\\\\n\\pi_{12}  \\pi_{11}  \\pi_{12}  0  0  0 \\\\\n\\pi_{12}  \\pi_{12}  \\pi_{11}  0  0  0 \\\\\n0  0  0  \\pi_{44}  0  0 \\\\\n0  0  0  0  \\pi_{44}  0 \\\\\n0  0  0  0  0  \\pi_{44}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在确定了压阻张量的一般形式后，下一步是将其应用于实际器件中。本练习将探讨压阻效应的各向异性，要求你计算沿特定晶向 $\\langle 110 \\rangle$ 排列的硅电阻器的有效纵向压阻系数。这个计算清晰地展示了器件的机电性能如何依赖于其在晶圆上的取向，这是半导体器件设计和工艺集成中的一个关键考量。",
            "id": "4152365",
            "problem": "考虑一个在 (001) 晶圆上制造的单晶硅电阻器，其沿晶向 $\\langle 110 \\rangle$ 定向。该电阻器沿其纵轴方向受到大小为 $\\sigma$ 的均匀单轴机械应力。硅具有立方对称性，在与 $[100]$、$[010]$ 和 $[001]$ 对齐的晶体坐标系中，电阻率张量的分数变化与所施加应力之间的线性压阻关系可以用一个具有三个独立系数 $\\pi_{11}$、$\\pi_{12}$ 和 $\\pi_{44}$ 的四阶压阻张量来表示。\n\n从电阻率分数变化与应力之间的张量关系出发，并利用沿单位方向 $\\mathbf{e}$ 施加的单轴应力在任何笛卡尔坐标系中其分量为 $\\sigma_{ij}=\\sigma\\,e_{i}e_{j}$ 这一事实，确定有效纵向压阻系数 $\\pi_{\\text{eff}}$。该系数通过 $\\Delta\\rho_{L}/\\rho_{0}=\\pi_{\\text{eff}}\\,\\sigma$ 将电阻器纵向电阻率的分数变化与施加的应力联系起来，其中 $\\rho_{0}$ 是无应力时的电阻率，$\\Delta\\rho_{L}$ 是沿电阻器轴线的电阻率变化的纵向分量。请用 $\\pi_{11}$、$\\pi_{12}$ 和 $\\pi_{44}$ 将您的最终答案表示为单个闭式解析表达式。在国际单位制中，系数 $\\pi_{\\text{eff}}$ 的单位是帕斯卡的倒数，但最终答案中不要包含单位。无需进行四舍五入。",
            "solution": "该问题要求解在 (001) 晶圆上沿 $\\langle 110 \\rangle$ 方向定向的单晶硅电阻器的有效纵向压阻系数 $\\pi_{\\text{eff}}$。该电阻器沿其长度方向受到单轴应力 $\\sigma$。\n\n出发点是在晶体坐标系中，电阻率张量的分数变化 $\\Delta\\rho_{ij}/\\rho_0$ 与施加的应力张量 $\\sigma_{kl}$ 之间的线性关系。该关系由四阶压阻张量 $\\pi_{ijkl}$ 决定：\n$$ \\frac{\\Delta\\rho_{ij}}{\\rho_0} = \\sum_{k,l=1}^{3} \\pi_{ijkl} \\sigma_{kl} $$\n其中 $\\rho_0$ 是无应力各向同性材料的标量电阻率。对于像硅这样的具有立方对称性的材料，该张量只有三个独立的非零分量：$\\pi_{1111}$、$\\pi_{1122}$ 和 $\\pi_{1212}$。在简化的双下标 Voigt 标记法中，它们分别对应于 $\\pi_{11}$、$\\pi_{12}$ 和 $\\pi_{44}$（使用传统定义时，$\\pi_{1111} = \\pi_{11}$，$\\pi_{1122} = \\pi_{12}$，以及 $2\\pi_{2323} = \\pi_{44}$，但在半导体文献中，通常定义 $\\pi_{44}$ 使得 $\\pi_{44} = 2\\pi_{2323}$，这简化了剪切关系）。我们将使用立方晶体的标准矩阵形式：\n$$ \\begin{pmatrix} \\Delta\\rho_1/\\rho_0 \\\\ \\Delta\\rho_2/\\rho_0 \\\\ \\Delta\\rho_3/\\rho_0 \\\\ \\Delta\\rho_4/\\rho_0 \\\\ \\Delta\\rho_5/\\rho_0 \\\\ \\Delta\\rho_6/\\rho_0 \\end{pmatrix} = \\begin{pmatrix} \\pi_{11}  \\pi_{12}  \\pi_{12}  0  0  0 \\\\ \\pi_{12}  \\pi_{11}  \\pi_{12}  0  0  0 \\\\ \\pi_{12}  \\pi_{12}  \\pi_{11}  0  0  0 \\\\ 0  0  0  \\pi_{44}  0  0 \\\\ 0  0  0  0  \\pi_{44}  0 \\\\ 0  0  0  0  0  \\pi_{44} \\end{pmatrix} \\begin{pmatrix} \\sigma_1 \\\\ \\sigma_2 \\\\ \\sigma_3 \\\\ \\sigma_4 \\\\ \\sigma_5 \\\\ \\sigma_6 \\end{pmatrix} $$\n下标映射关系为 $1 \\leftrightarrow 11$，$2 \\leftrightarrow 22$，$3 \\leftrightarrow 33$，$4 \\leftrightarrow 23$，$5 \\leftrightarrow 13$，$6 \\leftrightarrow 12$。张量分量 $\\Delta\\rho_{ij}$ 和 $\\sigma_{kl}$ 在晶体坐标系中表示，其坐标轴沿 $[100]$、$[010]$ 和 $[001]$ 方向对齐。我们称这个坐标系为 $S$。\n\n首先，我们必须确定此晶体坐标系中应力张量 $\\sigma_{kl}$ 的分量。问题指出，大小为 $\\sigma$ 的单轴应力沿电阻器的纵轴施加，该纵轴沿 $\\langle 110 \\rangle$ 方向定向。我们选择具体方向 $[110]$。沿此方向的单位矢量 $\\mathbf{l}$ 为：\n$$ \\mathbf{l} = \\frac{1}{\\sqrt{1^2 + 1^2 + 0^2}} [1, 1, 0] = \\frac{1}{\\sqrt{2}} (1, 1, 0) $$\n单轴应力的应力张量分量由 $\\sigma_{kl} = \\sigma l_k l_l$ 给出。在晶体坐标系 $S$ 中，分量为：\n$$ \\sigma_{11} = \\sigma l_1^2 = \\sigma \\left(\\frac{1}{\\sqrt{2}}\\right)^2 = \\frac{\\sigma}{2} $$\n$$ \\sigma_{22} = \\sigma l_2^2 = \\sigma \\left(\\frac{1}{\\sqrt{2}}\\right)^2 = \\frac{\\sigma}{2} $$\n$$ \\sigma_{33} = \\sigma l_3^2 = \\sigma (0)^2 = 0 $$\n$$ \\sigma_{12} = \\sigma l_1 l_2 = \\sigma \\left(\\frac{1}{\\sqrt{2}}\\right)\\left(\\frac{1}{\\sqrt{2}}\\right) = \\frac{\\sigma}{2} $$\n$$ \\sigma_{13} = \\sigma l_1 l_3 = 0 $$\n$$ \\sigma_{23} = \\sigma l_2 l_3 = 0 $$\n在 Voigt 标记法中，应力矢量为 $[\\sigma_V] = (\\frac{\\sigma}{2}, \\frac{\\sigma}{2}, 0, 0, 0, \\frac{\\sigma}{2})^T$。\n\n接下来，我们通过应用压阻矩阵来计算晶体坐标系中电阻率分数变化张量 $\\Delta\\rho_{ij}/\\rho_0$ 的分量：\n$$ \\frac{\\Delta\\rho_{11}}{\\rho_0} = \\pi_{11}\\sigma_{11} + \\pi_{12}\\sigma_{22} + \\pi_{12}\\sigma_{33} = \\pi_{11}\\left(\\frac{\\sigma}{2}\\right) + \\pi_{12}\\left(\\frac{\\sigma}{2}\\right) = \\frac{\\sigma}{2}(\\pi_{11} + \\pi_{12}) $$\n$$ \\frac{\\Delta\\rho_{22}}{\\rho_0} = \\pi_{12}\\sigma_{11} + \\pi_{11}\\sigma_{22} + \\pi_{12}\\sigma_{33} = \\pi_{12}\\left(\\frac{\\sigma}{2}\\right) + \\pi_{11}\\left(\\frac{\\sigma}{2}\\right) = \\frac{\\sigma}{2}(\\pi_{11} + \\pi_{12}) $$\n$$ \\frac{\\Delta\\rho_{33}}{\\rho_0} = \\pi_{12}\\sigma_{11} + \\pi_{12}\\sigma_{22} + \\pi_{11}\\sigma_{33} = \\pi_{12}\\left(\\frac{\\sigma}{2}\\right) + \\pi_{12}\\left(\\frac{\\sigma}{2}\\right) = \\sigma\\pi_{12} $$\n剪切分量为：\n$$ \\frac{\\Delta\\rho_{12}}{\\rho_0} = \\pi_{44}\\sigma_{12} = \\pi_{44}\\left(\\frac{\\sigma}{2}\\right) = \\frac{\\sigma}{2}\\pi_{44} $$\n其他剪切分量 $\\Delta\\rho_{13}$ 和 $\\Delta\\rho_{23}$ 为零，因为相应的应力分量为零。\n\n问题要求解有效纵向压阻系数 $\\pi_{\\text{eff}}$，它将纵向电阻率的分数变化 $\\Delta\\rho_L/\\rho_0$ 与应力 $\\sigma$ 联系起来。纵向电阻率是沿电流方向的电阻率分量，也就是电阻器本身的方向 $\\mathbf{l}$。纵向电阻率的变化通过将电阻率变化张量投影到该方向上得到：\n$$ \\Delta\\rho_L = \\sum_{i,j=1}^{3} \\Delta\\rho_{ij} l_i l_j $$\n我们需要计算 $\\Delta\\rho_L/\\rho_0$：\n$$ \\frac{\\Delta\\rho_L}{\\rho_0} = \\sum_{i,j=1}^{3} \\frac{\\Delta\\rho_{ij}}{\\rho_0} l_i l_j $$\n展开这个和式：\n$$ \\frac{\\Delta\\rho_L}{\\rho_0} = l_1^2 \\frac{\\Delta\\rho_{11}}{\\rho_0} + l_2^2 \\frac{\\Delta\\rho_{22}}{\\rho_0} + l_3^2 \\frac{\\Delta\\rho_{33}}{\\rho_0} + 2 l_1 l_2 \\frac{\\Delta\\rho_{12}}{\\rho_0} + 2 l_1 l_3 \\frac{\\Delta\\rho_{13}}{\\rho_0} + 2 l_2 l_3 \\frac{\\Delta\\rho_{23}}{\\rho_0} $$\n代入单位矢量 $\\mathbf{l} = (1/\\sqrt{2}, 1/\\sqrt{2}, 0)$ 的分量：\n$$ \\frac{\\Delta\\rho_L}{\\rho_0} = \\left(\\frac{1}{\\sqrt{2}}\\right)^2 \\frac{\\Delta\\rho_{11}}{\\rho_0} + \\left(\\frac{1}{\\sqrt{2}}\\right)^2 \\frac{\\Delta\\rho_{22}}{\\rho_0} + (0)^2 \\frac{\\Delta\\rho_{33}}{\\rho_0} + 2\\left(\\frac{1}{\\sqrt{2}}\\right)\\left(\\frac{1}{\\sqrt{2}}\\right) \\frac{\\Delta\\rho_{12}}{\\rho_0} + 0 + 0 $$\n$$ \\frac{\\Delta\\rho_L}{\\rho_0} = \\frac{1}{2} \\frac{\\Delta\\rho_{11}}{\\rho_0} + \\frac{1}{2} \\frac{\\Delta\\rho_{22}}{\\rho_0} + \\frac{\\Delta\\rho_{12}}{\\rho_0} $$\n现在我们代入之前导出的电阻率分数变化的表达式：\n$$ \\frac{\\Delta\\rho_L}{\\rho_0} = \\frac{1}{2} \\left[ \\frac{\\sigma}{2}(\\pi_{11} + \\pi_{12}) \\right] + \\frac{1}{2} \\left[ \\frac{\\sigma}{2}(\\pi_{11} + \\pi_{12}) \\right] + \\left[ \\frac{\\sigma}{2}\\pi_{44} \\right] $$\n合并各项：\n$$ \\frac{\\Delta\\rho_L}{\\rho_0} = \\frac{\\sigma}{4}(\\pi_{11} + \\pi_{12}) + \\frac{\\sigma}{4}(\\pi_{11} + \\pi_{12}) + \\frac{\\sigma}{2}\\pi_{44} $$\n$$ \\frac{\\Delta\\rho_L}{\\rho_0} = \\frac{\\sigma}{2}(\\pi_{11} + \\pi_{12}) + \\frac{\\sigma}{2}\\pi_{44} $$\n提取公因式得到：\n$$ \\frac{\\Delta\\rho_L}{\\rho_0} = \\frac{\\sigma}{2}(\\pi_{11} + \\pi_{12} + \\pi_{44}) $$\n问题通过以下关系定义了有效纵向压阻系数 $\\pi_{\\text{eff}}$：\n$$ \\frac{\\Delta\\rho_L}{\\rho_0} = \\pi_{\\text{eff}} \\sigma $$\n通过将我们导出的表达式与此定义进行比较，我们可以确定 $\\pi_{\\text{eff}}$：\n$$ \\pi_{\\text{eff}} \\sigma = \\frac{\\sigma}{2}(\\pi_{11} + \\pi_{12} + \\pi_{44}) $$\n因此，有效纵向压阻系数为：\n$$ \\pi_{\\text{eff}} = \\frac{1}{2} (\\pi_{11} + \\pi_{12} + \\pi_{44}) $$\n此结果与 $\\langle 110 \\rangle$ 方向族内的符号选择无关（例如，使用 $[\\bar{1}10]$ 会得到相同的结果，因为应力张量分量取决于方向余弦的乘积，而方向余弦是平方的）。",
            "answer": "$$\\boxed{\\frac{1}{2}(\\pi_{11} + \\pi_{12} + \\pi_{44})}$$"
        },
        {
            "introduction": "从理论分析转向数据驱动的工艺建模，本练习将带你进入压电现象的前沿应用。你将构建一个贝叶斯推断框架，利用实验测量数据（阻抗谱）来提取压电薄膜的关键材料参数 $d_{33}$。这项练习模拟了半导体制造中表征和监控工艺的真实挑战，完美地融合了物理模型、实验数据和高级计算分析方法。",
            "id": "4152408",
            "problem": "在一条半导体制造工艺线中，一个压电薄膜电容器堆叠被用于通过电阻抗谱监测薄膜在 $33$ 方向的有效压电电荷系数，记为 $d_{33}$。在小信号水平和阻塞力学边界条件下，线性压电本构关系是分析的起点：\n\n$$S = s^{E} T + d E,\\quad D = d T + \\varepsilon^{T} E,$$\n\n其中 $S$ 是应变，$T$ 是应力，$E$ 是电场，$D$ 是电位移，$s^{E}$ 是恒定电场下的弹性柔量，$d$ 是压电耦合系数，$\\varepsilon^{T}$ 是恒定应力下的介电常数。对于沿 $3$ 轴测量且 $S_{3} = 0$ 的薄膜，这些关系意味着一个有效介电常数\n\n$$\\varepsilon_{\\mathrm{eff}} = \\varepsilon_{33}^{T} - \\frac{d_{33}^{2}}{s_{33}^{E}},$$\n\n和一个有效电容\n\n$$C_{\\mathrm{eff}}(d_{33}) = \\varepsilon_{\\mathrm{eff}} \\frac{A}{t} = \\left(\\varepsilon_{33}^{T} - \\frac{d_{33}^{2}}{s_{33}^{E}}\\right)\\frac{A}{t},$$\n\n其中 $A$ 为电极面积，$t$ 为薄膜厚度。在远离声学共振的频率范围内，该堆叠的标准小信号等效电路由一个串联电阻 $R_{s}$ 和阻塞电容 $C_{\\mathrm{eff}}(d_{33})$ 组成，其在角频率 $\\omega$ 下的复阻抗为：\n\n$$Z(\\omega; d_{33}) = R_{s} + \\frac{1}{i\\,\\omega\\,C_{\\mathrm{eff}}(d_{33})}.$$\n\n你需要构建一个贝叶斯推断框架，利用具有已知高斯噪声水平的多个阻抗谱来估计 $d_{33}$。假设对于每个谱 $j$，$Z$ 的实部和虚部上的测量噪声是独立的，并且分别服从标准差为 $\\sigma_{\\mathrm{Re},j}$ 和 $\\sigma_{\\mathrm{Im},j}$ 的正态分布。给定在频率 $\\{\\omega_{j,k}\\}$ 处观测到的复阻抗样本 $\\{Z_{j,k}^{\\mathrm{obs}}\\}$，其似然函数为\n\n$$\\mathcal{L}(\\{Z_{j,k}^{\\mathrm{obs}}\\}\\mid d_{33}) = \\prod_{j}\\prod_{k} \\exp\\left(-\\frac{1}{2}\\left[\\left(\\frac{\\Re\\{Z_{j,k}^{\\mathrm{obs}} - Z(\\omega_{j,k}; d_{33})\\}}{\\sigma_{\\mathrm{Re},j}}\\right)^{2} + \\left(\\frac{\\Im\\{Z_{j,k}^{\\mathrm{obs}} - Z(\\omega_{j,k}; d_{33})\\}}{\\sigma_{\\mathrm{Im},j}}\\right)^{2}\\right]\\right).$$\n\n假设一个高斯先验 $d_{33} \\sim \\mathcal{N}(\\mu_{0}, \\sigma_{0}^{2})$。后验密度与先验和似然的乘积成正比。你的任务是，对于下面提供的每个测试案例，在一个满足 $C_{\\mathrm{eff}}(d_{33}) > 0$ 的物理允许域上使用数值积分，计算 $d_{33}$ 的后验均值和方差。使用国际单位制（SI）。将所有测试案例的最终 $d_{33}$ 后验均值和方差以库仑/牛顿（$\\mathrm{C/N}$）为单位，用纯十进制浮点数（输出中不含单位文本）表示，并按规定格式汇总。\n\n使用以下材料常数和真空介电常数计算 $\\varepsilon_{33}^{T} = \\varepsilon_{r}\\,\\varepsilon_{0}$，其中 $\\varepsilon_{0} = 8.854187817\\times 10^{-12}\\,\\mathrm{F/m}$，$\\varepsilon_{r}$ 是相对介电常数。频率单位为赫兹（Hertz），阻抗单位为欧姆（Ohms）。虚数单位为 $i$。\n\n测试套件（三个案例，涵盖典型、高噪声和小面积情况）：\n\n- 案例 1（典型薄膜，两个谱）：\n    - 几何参数：$A = 1.0\\times 10^{-6}\\,\\mathrm{m}^{2}$，$t = 1.0\\times 10^{-6}\\,\\mathrm{m}$。\n    - 材料参数：$\\varepsilon_{r} = 10$，$s_{33}^{E} = 5.0\\times 10^{-12}\\,\\mathrm{Pa}^{-1}$。\n    - 电路参数：$R_{s} = 10.0\\,\\Omega$。\n    - 先验：$\\mu_{0} = 1.0\\times 10^{-11}\\,\\mathrm{C/N}$，$\\sigma_{0} = 5.0\\times 10^{-12}\\,\\mathrm{C/N}$。\n    - 谱 1：\n        - 频率 $f_{1} = [1.0\\times 10^{5},\\,2.0\\times 10^{5},\\,5.0\\times 10^{5},\\,1.0\\times 10^{6}]\\,\\mathrm{Hz}$。\n        - 已知噪声：$\\sigma_{\\mathrm{Re},1} = 0.2\\,\\Omega$，$\\sigma_{\\mathrm{Im},1} = 0.2\\,\\Omega$。\n        - 观测值由真实参数 $d_{33}^{\\mathrm{true}} = 1.2\\times 10^{-11}\\,\\mathrm{C/N}$ 和附加偏移量确定性地定义：\n            - 实部偏移量 $\\Delta \\mathrm{Re}_{1} = [0.10,\\,-0.05,\\,0.08,\\,-0.02]\\,\\Omega$。\n            - 虚部偏移量 $\\Delta \\mathrm{Im}_{1} = [0.15,\\,-0.10,\\,0.05,\\,-0.05]\\,\\Omega$。\n            - 对于每个 $k$，$Z_{1,k}^{\\mathrm{obs}} = Z(2\\pi f_{1,k}; d_{33}^{\\mathrm{true}}) + \\Delta \\mathrm{Re}_{1,k} + i\\,\\Delta \\mathrm{Im}_{1,k}$。\n    - 谱 2：\n        - 频率 $f_{2} = [1.0\\times 10^{5},\\,3.0\\times 10^{5},\\,8.0\\times 10^{5}]\\,\\mathrm{Hz}$。\n        - 已知噪声：$\\sigma_{\\mathrm{Re},2} = 0.5\\,\\Omega$，$\\sigma_{\\mathrm{Im},2} = 0.5\\,\\Omega$。\n        - 附加偏移量：\n            - 实部偏移量 $\\Delta \\mathrm{Re}_{2} = [0.30,\\,-0.25,\\,0.20]\\,\\Omega$。\n            - 虚部偏移量 $\\Delta \\mathrm{Im}_{2} = [0.20,\\,0.10,\\,-0.15]\\,\\Omega$。\n            - 观测值 $Z_{2,k}^{\\mathrm{obs}} = Z(2\\pi f_{2,k}; d_{33}^{\\mathrm{true}}) + \\Delta \\mathrm{Re}_{2,k} + i\\,\\Delta \\mathrm{Im}_{2,k}$。\n\n- 案例 2（高噪声，两个谱）：\n    - 几何参数：$A = 8.0\\times 10^{-7}\\,\\mathrm{m}^{2}$，$t = 1.2\\times 10^{-6}\\,\\mathrm{m}$。\n    - 材料参数：$\\varepsilon_{r} = 12$，$s_{33}^{E} = 4.5\\times 10^{-12}\\,\\mathrm{Pa}^{-1}$。\n    - 电路参数：$R_{s} = 12.0\\,\\Omega$。\n    - 先验：$\\mu_{0} = 1.0\\times 10^{-11}\\,\\mathrm{C/N}$，$\\sigma_{0} = 3.0\\times 10^{-12}\\,\\mathrm{C/N}$。\n    - 谱 1：\n        - 频率 $f_{1} = [2.0\\times 10^{5},\\,7.0\\times 10^{5}]\\,\\mathrm{Hz}$。\n        - 已知噪声：$\\sigma_{\\mathrm{Re},1} = 3.0\\,\\Omega$，$\\sigma_{\\mathrm{Im},1} = 3.0\\,\\Omega$。\n        - 真实参数 $d_{33}^{\\mathrm{true}} = 8.0\\times 10^{-12}\\,\\mathrm{C/N}$。\n        - 实部偏移量 $\\Delta \\mathrm{Re}_{1} = [1.50,\\,-1.00]\\,\\Omega$。\n        - 虚部偏移量 $\\Delta \\mathrm{Im}_{1} = [-1.20,\\,0.80]\\,\\Omega$。\n        - 观测值 $Z_{1,k}^{\\mathrm{obs}} = Z(2\\pi f_{1,k}; d_{33}^{\\mathrm{true}}) + \\Delta \\mathrm{Re}_{1,k} + i\\,\\Delta \\mathrm{Im}_{1,k}$。\n    - 谱 2：\n        - 频率 $f_{2} = [1.5\\times 10^{5},\\,9.0\\times 10^{5},\\,1.2\\times 10^{6}]\\,\\mathrm{Hz}$。\n        - 已知噪声：$\\sigma_{\\mathrm{Re},2} = 2.5\\,\\Omega$，$\\sigma_{\\mathrm{Im},2} = 2.5\\,\\Omega$。\n        - 实部偏移量 $\\Delta \\mathrm{Re}_{2} = [0.50,\\,-0.30,\\,0.40]\\,\\Omega$。\n        - 虚部偏移量 $\\Delta \\mathrm{Im}_{2} = [0.40,\\,-0.20,\\,0.30]\\,\\Omega$。\n        - 观测值 $Z_{2,k}^{\\mathrm{obs}} = Z(2\\pi f_{2,k}; d_{33}^{\\mathrm{true}}) + \\Delta \\mathrm{Re}_{2,k} + i\\,\\Delta \\mathrm{Im}_{2,k}$。\n\n- 案例 3（小面积，一个谱）：\n    - 几何参数：$A = 2.0\\times 10^{-8}\\,\\mathrm{m}^{2}$，$t = 5.0\\times 10^{-7}\\,\\mathrm{m}$。\n    - 材料参数：$\\varepsilon_{r} = 9$，$s_{33}^{E} = 6.0\\times 10^{-12}\\,\\mathrm{Pa}^{-1}$。\n    - 电路参数：$R_{s} = 5.0\\,\\Omega$。\n    - 先验：$\\mu_{0} = 6.0\\times 10^{-12}\\,\\mathrm{C/N}$，$\\sigma_{0} = 2.0\\times 10^{-12}\\,\\mathrm{C/N}$。\n    - 谱 1：\n        - 频率 $f_{1} = [5.0\\times 10^{5},\\,1.0\\times 10^{6},\\,2.0\\times 10^{6},\\,4.0\\times 10^{6}]\\,\\mathrm{Hz}$。\n        - 已知噪声：$\\sigma_{\\mathrm{Re},1} = 0.05\\,\\Omega$，$\\sigma_{\\mathrm{Im},1} = 0.05\\,\\Omega$。\n        - 真实参数 $d_{33}^{\\mathrm{true}} = 6.0\\times 10^{-12}\\,\\mathrm{C/N}$。\n        - 实部偏移量 $\\Delta \\mathrm{Re}_{1} = [0.020,\\,-0.010,\\,0.015,\\,-0.020]\\,\\Omega$。\n        - 虚部偏移量 $\\Delta \\mathrm{Im}_{1} = [0.030,\\,-0.020,\\,0.020,\\,-0.020]\\,\\Omega$。\n        - 观测值 $Z_{1,k}^{\\mathrm{obs}} = Z(2\\pi f_{1,k}; d_{33}^{\\mathrm{true}}) + \\Delta \\mathrm{Re}_{1,k} + i\\,\\Delta \\mathrm{Im}_{1,k}$。\n\n算法要求：\n- 使用数值积分在一个一维 $d_{33}$ 网格上实现后验密度。使用域 $[d_{\\min}, d_{\\max}]$，其中 $d_{\\min} = \\mu_{0} - 6\\sigma_{0}$ 和 $d_{\\max} = \\mu_{0} + 6\\sigma_{0}$，并通过将后验密度设为零来舍弃任何 $C_{\\mathrm{eff}}(d_{33}) \\le 0$ 的网格点。\n- 通过对归一化的后验密度对 $d_{33}$ 进行积分，计算后验均值 $\\mathbb{E}[d_{33} \\mid \\text{data}]$ 和后验方差 $\\mathrm{Var}[d_{33} \\mid \\text{data}]$。\n- 使用梯形法则进行数值积分。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含一个逗号分隔的列表形式的结果，并用方括号括起来。列表中的每个元素是一个包含相应案例的后验均值和方差的两项列表。例如：$[[m_{1},v_{1}],[m_{2},v_{2}],[m_{3},v_{3}]]$。\n- 将所有 $d_{33}$ 结果以 $\\mathrm{C/N}$ 为单位，用十进制浮点数表示，不含单位文本。\n\n角度单位不适用。此问题中不出现百分比。确保所有物理单位在内部保持一致，并且计算全程使用国际单位制（SI）单位。",
            "solution": "该问题要求使用贝叶斯推断框架，从阻抗谱数据中估计有效压电电荷系数 $d_{33}$。需要为三个不同的测试案例计算 $d_{33}$ 的后验均值和方差。\n\n### 问题验证\n问题陈述经过了严格验证，并被确定为有效。\n1.  **已知条件提取**：所有物理常数、材料属性、几何参数、阻抗模型方程、先验和似然的统计模型以及测量数据都已明确提供。\n2.  **科学依据**：该问题基于标准的线性压电理论、电容器的常用小信号等效电路模型以及贝叶斯统计推断原理。所有模型和概念在物理学、工程学和统计学中都是公认的。\n3.  **适定性与客观性**：该问题在数学上是适定的，提供了明确的目标和所有必要信息以获得唯一的数值解。语言客观而精确。\n4.  **一致性**：物理单位在国际单位制（SI）内是一致的。参数和数据在薄膜分析的物理合理范围内。设置没有内部矛盾。\n由于未发现任何缺陷，我将继续提供完整解决方案。\n\n### 贝叶斯推断框架\n问题的核心是确定在给定观测阻抗数据 $\\{Z^{\\mathrm{obs}}\\}$ 的条件下，$d_{33}$ 的后验概率密度函数（PDF）。根据贝叶斯定理，后验概率密度函数 $p(d_{33} \\mid \\{Z^{\\mathrm{obs}}\\})$ 与似然函数和先验的乘积成正比：\n$$p(d_{33} \\mid \\{Z^{\\mathrm{obs}}\\}) \\propto \\mathcal{L}(\\{Z^{\\mathrm{obs}}\\} \\mid d_{33}) \\cdot p(d_{33})$$\n其中 $\\mathcal{L}(\\{Z^{\\mathrm{obs}}\\} \\mid d_{33})$ 是在给定 $d_{33}$ 值的情况下观测到数据的似然，而 $p(d_{33})$ 是 $d_{33}$ 的先验概率密度函数。\n\n**1. 模型阻抗**\n在角频率 $\\omega$ 下，对于给定的 $d_{33}$，复阻抗 $Z$ 建模为：\n$$Z(\\omega; d_{33}) = R_{s} + \\frac{1}{i\\,\\omega\\,C_{\\mathrm{eff}}(d_{33})}$$\n其中 $i$ 是虚数单位，$R_s$ 是串联电阻，$C_{\\mathrm{eff}}(d_{33})$ 是有效电容。电容依赖于 $d_{33}$，如下所示：\n$$C_{\\mathrm{eff}}(d_{33}) = \\left(\\varepsilon_{33}^{T} - \\frac{d_{33}^{2}}{s_{33}^{E}}\\right)\\frac{A}{t}$$\n这里，$A$ 是电极面积，$t$ 是薄膜厚度，$s_{33}^{E}$ 是弹性柔量，$\\varepsilon_{33}^{T}$ 是恒定应力下的介电常数，由 $\\varepsilon_{33}^{T} = \\varepsilon_{r}\\varepsilon_{0}$ 给出，其中 $\\varepsilon_{r}$ 是相对介电常数，$\\varepsilon_{0}$ 是真空介电常数。一个物理约束是 $C_{\\mathrm{eff}}(d_{33}) > 0$，这意味着 $\\varepsilon_{33}^{T} - d_{33}^{2}/s_{33}^{E} > 0$，即 $|d_{33}| < \\sqrt{\\varepsilon_{33}^{T} s_{33}^{E}}$。\n\n**2. 先验分布**\n关于 $d_{33}$ 的先验信念由高斯分布给出：\n$$p(d_{33}) = \\frac{1}{\\sqrt{2\\pi\\sigma_{0}^2}} \\exp\\left(-\\frac{1}{2} \\frac{(d_{33} - \\mu_{0})^2}{\\sigma_{0}^2}\\right)$$\n其中 $\\mu_0$ 是先验均值，$\\sigma_0$ 是先验标准差。\n\n**3. 似然函数**\n观测到的阻抗数据 $\\{Z_{j,k}^{\\mathrm{obs}}\\}$（跨越多个谱 $j$ 和频率 $k$）的似然函数由各个测量概率的乘积给出。阻抗实部和虚部上的噪声是独立的高斯噪声。\n$$\\mathcal{L}(\\{Z_{j,k}^{\\mathrm{obs}}\\} \\mid d_{33}) = \\prod_{j,k} \\frac{1}{2\\pi\\sigma_{\\mathrm{Re},j}\\sigma_{\\mathrm{Im},j}} \\exp\\left(-\\frac{1}{2}\\left[\\left(\\frac{\\Re\\{Z_{j,k}^{\\mathrm{obs}} - Z(\\omega_{j,k}; d_{33})\\}}{\\sigma_{\\mathrm{Re},j}}\\right)^{2} + \\left(\\frac{\\Im\\{Z_{j,k}^{\\mathrm{obs}} - Z(\\omega_{j,k}; d_{33})\\}}{\\sigma_{\\mathrm{Im},j}}\\right)^{2}\\right]\\right)$$\n\n**4. 对数后验公式**\n为实现数值稳定性和计算便利性，标准做法是处理后验分布的对数。对数后验是对数先验和对数似然的总和（忽略在归一化过程中会抵消的常数项）：\n$$\\ln p(d_{33} \\mid \\{Z^{\\mathrm{obs}}\\}) \\propto -\\frac{1}{2} \\frac{(d_{33} - \\mu_{0})^2}{\\sigma_{0}^2} - \\frac{1}{2}\\sum_{j,k} \\left[\\left(\\frac{\\Re\\{Z_{j,k}^{\\mathrm{obs}} - Z(\\omega_{j,k}; d_{33})\\}}{\\sigma_{\\mathrm{Re},j}}\\right)^{2} + \\left(\\frac{\\Im\\{Z_{j,k}^{\\mathrm{obs}} - Z(\\omega_{j,k}; d_{33})\\}}{\\sigma_{\\mathrm{Im},j}}\\right)^{2}\\right]$$\n\n### 数值求解策略\n$d_{33}$ 的后验概率密度函数通过数值方法计算。\n1.  **网格离散化**：连续变量 $d_{33}$ 在一维网格上进行离散化。问题指定了范围 $[\\mu_{0} - 6\\sigma_{0}, \\mu_{0} + 6\\sigma_{0}]$，这有效地覆盖了先验非可忽略的区域。\n2.  **后验计算**：对于网格上的每个点 $d_{33,i}$，计算其对数后验值。通过为任何违反物理约束 $C_{\\mathrm{eff}}(d_{33,i}) > 0$ 的网格点分配 $-\\infty$ 的对数后验值（或 $0$ 的后验值）来强制执行该约束。\n3.  **归一化**：通过对对数后验进行指数化得到的未归一化后验概率，使用梯形法则在网格上进行数值积分。该积分即为归一化常数 $Z_{\\mathrm{norm}}$。\n$$Z_{\\mathrm{norm}} = \\int p_{\\mathrm{unnorm}}(d_{33}) \\, \\mathrm{d}d_{33}$$\n归一化后的后验为 $p_{\\mathrm{norm}}(d_{33}) = p_{\\mathrm{unnorm}}(d_{33}) / Z_{\\mathrm{norm}}$。\n4.  **矩计算**：后验均值 $\\mathbb{E}[d_{33}]$ 和方差 $\\mathrm{Var}[d_{33}]$ 通过在归一化后验分布上进行数值积分来计算，同样使用梯形法则。\n$$\\mathbb{E}[d_{33}] = \\int d_{33} \\cdot p_{\\mathrm{norm}}(d_{33}) \\, \\mathrm{d}d_{33}$$\n$$\\mathrm{Var}[d_{33}] = \\int (d_{33} - \\mathbb{E}[d_{33}])^2 \\cdot p_{\\mathrm{norm}}(d_{33}) \\, \\mathrm{d}d_{33}$$\n\n### 实现细节\n对于每个测试案例，执行以下步骤：\n1.  定义所有特定于案例的参数（$A$、$t$、$\\varepsilon_r$ 等）。计算介电常数 $\\varepsilon_{33}^{T}$。\n2.  “观测”阻抗数据 $Z_{j,k}^{\\mathrm{obs}}$ 首先通过计算在提供的真实参数值 $d_{33}^{\\mathrm{true}}$ 下的模型阻抗 $Z(\\omega_{j,k}; d_{33}^{\\mathrm{true}})$ 生成，然后加上指定的复数偏移量。\n3.  创建 $d_{33}$ 的网格。\n4.  为了效率，在整个 $d_{33}$ 网格上以向量化方式计算对数先验和对数似然。总对数似然是每个数据点贡献的总和。\n5.  将对数先验和对数似然相加后，对结果进行指数化以获得未归一化的后验。通过在指数化之前减去最大对数后验值来确保数值稳定性。\n6.  应用关于 $C_{\\mathrm{eff}}$ 的物理约束，将无效 $d_{33}$ 值的后验设为零。\n7.  使用 `scipy.integrate.trapezoid` 函数执行所需的积分，以找到归一化常数、均值和方差。\n8.  收集每个案例计算出的均值和方差。最后，将结果格式化为指定的字符串输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import trapezoid\n\ndef solve():\n    \"\"\"\n    Solves the Bayesian inference problem for three test cases to estimate the\n    piezoelectric coefficient d33.\n    \"\"\"\n    \n    # Define the constant for vacuum permittivity\n    EPS0 = 8.854187817e-12  # F/m\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: Typical film\n        {\n            'A': 1.0e-6, 't': 1.0e-6, 'eps_r': 10, 's33E': 5.0e-12, 'Rs': 10.0,\n            'prior_mu': 1.0e-11, 'prior_sigma': 5.0e-12, 'd33_true': 1.2e-11,\n            'spectra': [\n                {\n                    'f': np.array([1.0e5, 2.0e5, 5.0e5, 1.0e6]),\n                    'sigma_re': 0.2, 'sigma_im': 0.2,\n                    'd_re': np.array([0.10, -0.05, 0.08, -0.02]),\n                    'd_im': np.array([0.15, -0.10, 0.05, -0.05])\n                },\n                {\n                    'f': np.array([1.0e5, 3.0e5, 8.0e5]),\n                    'sigma_re': 0.5, 'sigma_im': 0.5,\n                    'd_re': np.array([0.30, -0.25, 0.20]),\n                    'd_im': np.array([0.20, 0.10, -0.15])\n                }\n            ]\n        },\n        # Case 2: High noise\n        {\n            'A': 8.0e-7, 't': 1.2e-6, 'eps_r': 12, 's33E': 4.5e-12, 'Rs': 12.0,\n            'prior_mu': 1.0e-11, 'prior_sigma': 3.0e-12, 'd33_true': 8.0e-12,\n            'spectra': [\n                {\n                    'f': np.array([2.0e5, 7.0e5]),\n                    'sigma_re': 3.0, 'sigma_im': 3.0,\n                    'd_re': np.array([1.50, -1.00]),\n                    'd_im': np.array([-1.20, 0.80])\n                },\n                {\n                    'f': np.array([1.5e5, 9.0e5, 1.2e6]),\n                    'sigma_re': 2.5, 'sigma_im': 2.5,\n                    'd_re': np.array([0.50, -0.30, 0.40]),\n                    'd_im': np.array([0.40, -0.20, 0.30])\n                }\n            ]\n        },\n        # Case 3: Small area\n        {\n            'A': 2.0e-8, 't': 5.0e-7, 'eps_r': 9, 's33E': 6.0e-12, 'Rs': 5.0,\n            'prior_mu': 6.0e-12, 'prior_sigma': 2.0e-12, 'd33_true': 6.0e-12,\n            'spectra': [\n                {\n                    'f': np.array([5.0e5, 1.0e6, 2.0e6, 4.0e6]),\n                    'sigma_re': 0.05, 'sigma_im': 0.05,\n                    'd_re': np.array([0.020, -0.010, 0.015, -0.020]),\n                    'd_im': np.array([0.030, -0.020, 0.020, -0.020])\n                }\n            ]\n        }\n    ]\n\n    results = []\n\n    def compute_posterior_moments(case_data):\n        # Unpack case parameters\n        A, t, eps_r, s33E, Rs = case_data['A'], case_data['t'], case_data['eps_r'], case_data['s33E'], case_data['Rs']\n        prior_mu, prior_sigma = case_data['prior_mu'], case_data['prior_sigma']\n        d33_true = case_data['d33_true']\n        \n        eps_33_T = eps_r * EPS0\n        A_over_t = A / t\n\n        # Helper to calculate model impedance Z(omega; d33)\n        def get_Z_model(d33, omega):\n            # This function can handle scalar or array inputs for d33 and omega\n            C_eff = (eps_33_T - d33**2 / s33E) * A_over_t\n            # Handle non-positive capacitance, return a value that implies infinite impedance\n            # This is handled more robustly with masking later\n            with np.errstate(divide='ignore', invalid='ignore'):\n                 return Rs + 1.0 / (1j * omega * C_eff)\n\n        # 1. Generate observed data from true parameters and offsets\n        all_observations = []\n        for spec in case_data['spectra']:\n            omega = 2 * np.pi * spec['f']\n            Z_true = get_Z_model(d33_true, omega)\n            Z_obs = Z_true + spec['d_re'] + 1j * spec['d_im']\n            for k in range(len(omega)):\n                all_observations.append({\n                    'omega': omega[k], 'Z_obs': Z_obs[k],\n                    'sigma_re': spec['sigma_re'], 'sigma_im': spec['sigma_im']\n                })\n        \n        # 2. Set up the grid for d33\n        d33_min = prior_mu - 6 * prior_sigma\n        d33_max = prior_mu + 6 * prior_sigma\n        d33_grid = np.linspace(d33_min, d33_max, 10001)\n\n        # 3. Calculate log-posterior\n        # Log-prior\n        log_prior = -0.5 * ((d33_grid - prior_mu) / prior_sigma)**2\n\n        # Log-likelihood\n        log_likelihood = np.zeros_like(d33_grid)\n        C_eff_grid = (eps_33_T - d33_grid**2 / s33E) * A_over_t\n\n        for obs in all_observations:\n            # Vectorized calculation of model impedance Z over the d33 grid\n            with np.errstate(divide='ignore', invalid='ignore'):\n                Z_model_grid = Rs + 1.0 / (1j * obs['omega'] * C_eff_grid)\n            \n            diff_re = obs['Z_obs'].real - np.real(Z_model_grid)\n            diff_im = obs['Z_obs'].imag - np.imag(Z_model_grid)\n\n            log_likelihood += -0.5 * ((diff_re / obs['sigma_re'])**2 + (diff_im / obs['sigma_im'])**2)\n\n        total_log_posterior = log_prior + log_likelihood\n        \n        # 4. Apply physical constraint C_eff > 0\n        invalid_mask = C_eff_grid = 0\n        total_log_posterior[invalid_mask] = -np.inf\n\n        # 5. Normalize and compute moments\n        # Stabilize by subtracting max before exponentiating\n        valid_log_posterior = total_log_posterior[np.isfinite(total_log_posterior)]\n        if len(valid_log_posterior) == 0:\n            # Fallback if posterior is zero everywhere on grid (highly unlikely)\n            return prior_mu, prior_sigma**2\n            \n        total_log_posterior -= np.max(valid_log_posterior)\n        unnorm_posterior = np.exp(total_log_posterior)\n        \n        # Use trapezoidal rule for integration\n        norm_constant = trapezoid(unnorm_posterior, d33_grid)\n\n        if norm_constant == 0.0:\n            return prior_mu, prior_sigma**2 # Fallback\n\n        # Posterior mean\n        integrand_mean = d33_grid * unnorm_posterior\n        posterior_mean = trapezoid(integrand_mean, d33_grid) / norm_constant\n\n        # Posterior variance: Var(X) = E[(X - E[X])^2]\n        integrand_var = (d33_grid - posterior_mean)**2 * unnorm_posterior\n        posterior_variance = trapezoid(integrand_var, d33_grid) / norm_constant\n\n        return posterior_mean, posterior_variance\n\n    for case in test_cases:\n        mean, variance = compute_posterior_moments(case)\n        results.append([mean, variance])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join([f'[{r[0]},{r[1]}]' for r in results])}]\")\n\nsolve()\n\n```"
        }
    ]
}