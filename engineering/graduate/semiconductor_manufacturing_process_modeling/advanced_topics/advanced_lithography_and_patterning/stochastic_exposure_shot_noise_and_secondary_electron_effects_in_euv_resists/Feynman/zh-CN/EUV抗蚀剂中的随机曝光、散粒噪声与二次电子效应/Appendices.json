{
    "hands_on_practices": [
        {
            "introduction": "要深刻理解EUV光刻中的随机性，我们必须从其物理根源——光子散粒噪声——出发。本练习将引导你通过解析推导，建立从离散光子到达这一基本泊松过程到最终可测量的线边缘粗糙度（LER）之间的直接联系。掌握这一推导将使你能够从根本上理解曝光剂量（$D$）、系统模糊（$\\sigma$）和线边缘粗糙度之间的关键制衡关系。",
            "id": "4167966",
            "problem": "极紫外（EUV）光刻的线边缘可以在一维空间中建模，其中掩模在 $x0$ 区域透射，在 $x0$ 区域阻挡。光刻胶中吸收的光子到达是一个空间泊松过程，在透射区域内的平均线强度为 $D$（单位长度的光子数）。每个被吸收的光子都会沉积能量，随后通过代表点扩散函数（PSF）（包括次级电子输运）的模糊核产生潜像。假设 PSF 是一维高斯函数且归一化：$g(x) = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\exp\\!\\left(-\\frac{x^{2}}{2\\sigma^{2}}\\right)$，其中 $\\sigma$ 是表征由 PSF（包括次级电子）引起的有效模糊的标准差。\n\n设潜像剂量（能量密度）分布为 $A(x)$，设最终的光刻胶响应 $R(A)$ 是一个单调可微的传递函数，它将剂量 $A$ 映射到一个可测量的输出，该输出通过在 $x = x_{\\mathrm{t}}$ 处跨越阈值 $R(x) = R_{\\mathrm{th}}$ 来定义印刷边缘。将边缘斜率 $S$ 定义为平均响应在阈值位置处空间导数的绝对值，即 $S \\equiv \\left|\\frac{d\\,\\mathbb{E}[R(x)]}{dx}\\big|_{x=x_{\\mathrm{t}}}\\right|$。光子计数的散粒噪声在 $A(x)$ 中产生随机涨落，并通过 $R(A)$ 影响阈值交叉位置的涨落。从泊松散粒噪声和线性系统的第一性原理出发，推导完全由散粒噪声引起的线边缘粗糙度（LER）标准差 $\\sigma_{\\mathrm{LER}}$ 的解析表达式，该表达式需用剂量 $D$、PSF 宽度 $\\sigma$ 和边缘斜率明确表示。对于对称阶跃边缘的情况（其阈值位于平均潜像剂量的半高位置，即 $x_{\\mathrm{t}} = 0$ 且 $\\mathbb{E}[A(0)] = \\frac{D}{2}$），评估该表达式。\n\n你的最终结果必须是 $\\sigma_{\\mathrm{LER}}$ 的单一闭合形式表达式，显示其对 $D$ 和 $\\sigma$ 的依赖关系。请提供该表达式，并且不包含任何数值近似。如果你需要引用边缘斜率，你必须在推导中通过将其与潜像剂量斜率适当结合，来消除对光刻胶传递函数 $R(A)$ 的显式依赖。无需四舍五入。不要在最终表达式中包含物理单位；但是，将 $D$ 视为单位长度的光子数，将 $\\sigma$ 视为长度尺度，以使量纲一致性清晰。",
            "solution": "首先根据指定标准验证问题。\n\n### 步骤1：提取已知条件\n-   **系统几何**：一维系统，掩模在 $x  0$ 区域透射，在 $x  0$ 区域阻挡。\n-   **光子到达过程**：在透射区域（$x  0$）内的空间泊松过程，平均线强度为 $D$（单位长度光子数）。\n-   **点扩散函数（PSF）**：归一化的一维高斯函数，$g(x) = \\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\exp\\!\\left(-\\frac{x^{2}}{2\\sigma^{2}}\\right)$，其中 $\\sigma$ 是表征有效模糊的标准差。\n-   **潜像剂量分布**：$A(x)$，由吸收的光子与 PSF 卷积得到的能量密度分布。\n-   **光刻胶响应**：一个单调可微的传递函数 $R(A)$。\n-   **边缘定义**：印刷边缘位于位置 $x_{\\mathrm{t}}$，在该位置响应跨越阈值，$R(x) = R_{\\mathrm{th}}$。\n-   **边缘斜率定义**：$S \\equiv \\left|\\frac{d\\,\\mathbb{E}[R(x)]}{dx}\\big|_{x=x_{\\mathrm{t}}}\\right|$，其中 $\\mathbb{E}[\\cdot]$ 表示期望值。\n-   **随机涨落来源**：光子计数的散粒噪声。\n-   **目标**：推导由散粒噪声引起的线边缘粗糙度（LER）标准差 $\\sigma_{\\mathrm{LER}}$ 的解析表达式。\n-   **评估条件**：边缘是对称的，阈值位于平均潜像剂量的半高处，这发生在 $x_{\\mathrm{t}} = 0$。给定条件为 $\\mathbb{E}[A(0)] = \\frac{D}{2}$。\n-   **最终表达式要求**：$\\sigma_{\\mathrm{LER}}$ 必须明确地用剂量 $D$ 和 PSF 宽度 $\\sigma$ 表示，消除对光刻胶传递函数 $R(A)$ 的依赖。\n\n### 步骤2：使用提取的已知条件进行验证\n问题陈述具有科学依据，提法恰当且客观。它采用了光刻中随机效应的标准且被广泛接受的模型（泊松散粒噪声，高斯 PSF）。模型的各个组成部分定义清晰，目标是进行特定的解析推导。问题是自洽的，没有矛盾或歧义。所做的简化（一维模型，理想阶跃掩模）是为了便于解析处理的标准做法，并不会使问题在理论背景下失去科学合理性或变得不切实际。因此，该问题被认定为有效。\n\n### 步骤3：结论与行动\n问题有效。将提供一个完整的、有理有据的解答。\n\n### 解答推导\n潜像剂量分布 $A(x)$ 是所有被吸收光子的累积效应。由于光子到达是一个泊松点过程， $A(x)$ 可以建模为一个散粒噪声过程。设被吸收光子的位置为 $\\{z_i\\}$。由于光子仅在 $x  0$ 区域透射，所以 $z_i$ 以恒定速率 $D$ 分布在 $(0, \\infty)$ 区间内。位置 $x$ 处的剂量是每个光子贡献的总和，其中每个贡献由 PSF $g(x)$ 描述：\n$$A(x) = \\sum_i g(x - z_i)$$\n这是一个线性散粒噪声过程。$A(x)$ 的统计特性由坎贝尔定理描述。\n\n线边缘粗糙度 $\\sigma_{\\mathrm{LER}}$ 是边缘位置 $x_t$ 的标准差。边缘位置由阈值交叉定义。虽然问题中用通用的光刻胶响应 $R(A)$ 来定义它，但要求消除这种依赖关系。我们可以通过直接处理潜像剂量 $A(x)$ 来实现这一点。边缘位于位置 $x_E$ 处，在该处剂量 $A(x_E)$ 跨越阈值 $A_{\\mathrm{th}}$。由于 $A(x)$ 的随机性，位置 $x_E$ 是一个随机变量。我们在平均边缘位置 $x_{\\mathrm{t}}$ 附近对过程进行线性化。\n\n实际剂量分布为 $A(x) = \\mathbb{E}[A(x)] + \\delta A(x)$，其中 $\\delta A(x)$ 是零均值涨落。边缘位置在 $A(x_E) = A_{\\mathrm{th}}$ 处找到。设 $x_E = x_{\\mathrm{t}} + \\delta x$，其中 $x_{\\mathrm{t}}$ 是由 $\\mathbb{E}[A(x_{\\mathrm{t}})] = A_{\\mathrm{th}}$ 定义的平均边缘位置。\n$$A(x_{\\mathrm{t}} + \\delta x) = \\mathbb{E}[A(x_{\\mathrm{t}} + \\delta x)] + \\delta A(x_{\\mathrm{t}} + \\delta x) = A_{\\mathrm{th}}$$\n将 $\\mathbb{E}[A(x_{\\mathrm{t}} + \\delta x)]$ 在 $x_{\\mathrm{t}}$ 附近展开为一阶泰勒级数：\n$$\\mathbb{E}[A(x_{\\mathrm{t}})] + \\delta x \\frac{d\\mathbb{E}[A(x)]}{dx}\\bigg|_{x=x_{\\mathrm{t}}} + \\delta A(x_{\\mathrm{t}} + \\delta x) \\approx A_{\\mathrm{th}}$$\n由于 $\\mathbb{E}[A(x_{\\mathrm{t}})] = A_{\\mathrm{th}}$，且对于小涨落有 $\\delta A(x_{\\mathrm{t}} + \\delta x) \\approx \\delta A(x_{\\mathrm{t}})$，我们得到：\n$$\\delta x \\frac{d\\mathbb{E}[A(x)]}{dx}\\bigg|_{x=x_{\\mathrm{t}}} \\approx -\\delta A(x_{\\mathrm{t}})$$\n边缘位置的涨落 $\\delta x$ 与平均边缘位置处的剂量涨落有关。因此，边缘位置的方差 $\\sigma_{\\mathrm{LER}}^2$ 为：\n$$\\sigma_{\\mathrm{LER}}^2 = \\mathbb{E}[(\\delta x)^2] \\approx \\frac{\\mathbb{E}[(\\delta A(x_{\\mathrm{t}}))^2]}{\\left(\\frac{d\\mathbb{E}[A(x)]}{dx}\\big|_{x=x_{\\mathrm{t}}}\\right)^2} = \\frac{\\mathrm{Var}[A(x_{\\mathrm{t}})]}{\\left(\\frac{d\\mathbb{E}[A(x)]}{dx}\\big|_{x=x_{\\mathrm{t}}}\\right)^2}$$\n为了求得 $\\sigma_{\\mathrm{LER}}$，我们必须计算边缘位置 $x_{\\mathrm{t}} = 0$ 处的剂量方差（分子）和平均剂量分布斜率的平方（分母）。\n\n1.  **平均剂量分布 $\\mathbb{E}[A(x)]$ 及其斜率**：\n    根据坎贝尔第一定理，散粒噪声过程的均值是输入速率函数与脉冲响应（PSF）的卷积。输入速率为 $\\lambda(z) = D$（当 $z0$ 时），否则为0。\n    $$\\mathbb{E}[A(x)] = \\int_{-\\infty}^{\\infty} \\lambda(z) g(x-z) \\,dz = D \\int_{0}^{\\infty} g(x-z) \\,dz$$\n    令 $u = x-z$，则 $dz = -du$。积分限从 $z \\in [0, \\infty)$ 变为 $u \\in (x, -\\infty)$。\n    $$\\mathbb{E}[A(x)] = D \\int_{x}^{-\\infty} g(u) (-du) = D \\int_{-\\infty}^{x} g(u) \\,du$$\n    这是高斯 PSF 的累积分布函数（CDF）的 $D$ 倍。设 $\\Phi(\\xi) = \\int_{-\\infty}^{\\xi} \\frac{1}{\\sqrt{2\\pi}}e^{-t^2/2} dt$ 为标准正态累积分布函数。那么，\n    $$\\mathbb{E}[A(x)] = D \\cdot \\Phi\\left(\\frac{x}{\\sigma}\\right)$$\n    平均剂量分布的斜率是其关于 $x$ 的导数：\n    $$\\frac{d\\mathbb{E}[A(x)]}{dx} = D \\frac{d}{dx} \\Phi\\left(\\frac{x}{\\sigma}\\right) = D \\cdot \\frac{1}{\\sqrt{2\\pi}\\sigma} \\exp\\left(-\\frac{x^2}{2\\sigma^2}\\right) = D \\cdot g(x)$$\n    在指定的边缘位置 $x_{\\mathrm{t}} = 0$ 处，斜率为：\n    $$\\frac{d\\mathbb{E}[A(x)]}{dx}\\bigg|_{x=0} = D \\cdot g(0) = D \\cdot \\frac{1}{\\sqrt{2\\pi}\\sigma} = \\frac{D}{\\sigma\\sqrt{2\\pi}}$$\n\n2.  **剂量方差 $\\mathrm{Var}[A(x)]$**：\n    根据坎贝尔第二定理，散粒噪声过程的方差由输入速率函数乘以 PSF 的平方的积分给出：\n    $$\\mathrm{Var}[A(x)] = \\int_{-\\infty}^{\\infty} \\lambda(z) [g(x-z)]^2 \\,dz = D \\int_{0}^{\\infty} [g(x-z)]^2 \\,dz$$\n    PSF 的平方是：\n    $$[g(x-z)]^2 = \\left(\\frac{1}{\\sqrt{2\\pi}\\sigma} \\exp\\left(-\\frac{(x-z)^2}{2\\sigma^2}\\right)\\right)^2 = \\frac{1}{2\\pi\\sigma^2} \\exp\\left(-\\frac{(x-z)^2}{\\sigma^2}\\right)$$\n    我们需要在 $x_{\\mathrm{t}} = 0$ 处计算方差：\n    $$\\mathrm{Var}[A(0)] = D \\int_{0}^{\\infty} \\frac{1}{2\\pi\\sigma^2} \\exp\\left(-\\frac{z^2}{\\sigma^2}\\right) \\,dz = \\frac{D}{2\\pi\\sigma^2} \\int_{0}^{\\infty} \\exp\\left(-\\frac{z^2}{\\sigma^2}\\right) \\,dz$$\n    这是一个标准的高斯积分。使用结果 $\\int_{0}^{\\infty} e^{-ay^2} dy = \\frac{1}{2}\\sqrt{\\frac{\\pi}{a}}$，其中 $a=1/\\sigma^2$：\n    $$\\int_{0}^{\\infty} \\exp\\left(-\\frac{z^2}{\\sigma^2}\\right) \\,dz = \\frac{1}{2}\\sqrt{\\pi\\sigma^2} = \\frac{\\sigma\\sqrt{\\pi}}{2}$$\n    将此结果代回方差的表达式中：\n    $$\\mathrm{Var}[A(0)] = \\frac{D}{2\\pi\\sigma^2} \\cdot \\frac{\\sigma\\sqrt{\\pi}}{2} = \\frac{D}{4\\sigma\\sqrt{\\pi}}$$\n\n3.  **线边缘粗糙度 $\\sigma_{\\mathrm{LER}}$**：\n    现在我们组合出 $\\sigma_{\\mathrm{LER}}^2$ 的表达式：\n    $$\\sigma_{\\mathrm{LER}}^2 = \\frac{\\mathrm{Var}[A(0)]}{\\left(\\frac{d\\mathbb{E}[A(x)]}{dx}\\big|_{x=0}\\right)^2} = \\frac{\\frac{D}{4\\sigma\\sqrt{\\pi}}}{\\left(\\frac{D}{\\sigma\\sqrt{2\\pi}}\\right)^2} = \\frac{\\frac{D}{4\\sigma\\sqrt{\\pi}}}{\\frac{D^2}{2\\pi\\sigma^2}}$$\n    化简该表达式：\n    $$\\sigma_{\\mathrm{LER}}^2 = \\frac{D}{4\\sigma\\sqrt{\\pi}} \\cdot \\frac{2\\pi\\sigma^2}{D^2} = \\frac{2\\pi\\sigma^2 D}{4\\sqrt{\\pi}\\sigma D^2} = \\frac{\\sqrt{\\pi}\\sigma}{2D}$$\n    最后，LER 的标准差是此方差的平方根：\n    $$\\sigma_{\\mathrm{LER}} = \\sqrt{\\frac{\\sqrt{\\pi}\\sigma}{2D}}$$\n    该表达式按要求给出了用剂量 $D$ 和 PSF 模糊 $\\sigma$ 表示的 LER。量纲一致性为 $[L] = \\sqrt{\\frac{[L]}{[L^{-1}]}} = \\sqrt{[L^2]}$，这是正确的。结果显示了经典的散粒噪声行为，其中 LER 与剂量的平方根成反比（$1/\\sqrt{D}$），并随模糊的平方根增加（$\\sqrt{\\sigma}$）。",
            "answer": "$$\n\\boxed{\\sqrt{\\frac{\\sqrt{\\pi}\\sigma}{2D}}}\n$$"
        },
        {
            "introduction": "理论模型需要通过实验数据进行验证和校准，才能具有预测能力。本练习将带你进入模型参数估计的核心，应用贝叶斯推断方法，从模拟的线边缘粗糙度功率谱密度（LER PSD）数据中提取关键物理参数，如二次电子的平均自由程（$\\lambda$）和酸产额（$\\phi$）。通过这个实践，你将学会如何将复杂的物理模型与实验观测联系起来，并对模型参数的不确定性进行量化。",
            "id": "4167988",
            "problem": "您正在为化学放大光刻胶建立极紫外（EUV）光刻中的随机曝光模型，其中线边缘粗糙度（LER）源于光子散粒噪声和次级电子（SE）输运。假设以下具有物理动机的基础：\n\n- 光子到达是一个泊松过程，其白噪声谱密度与平均吸收光子率成正比。\n- 酸的生成量与吸收的光子数成正比，比例系数为酸量子产率 $\\phi$（每个吸收的光子产生的酸分子数），因此输入白噪声水平随 $\\phi$ 线性变化。\n- 次级电子（SE）输运表现为沿着线边缘的线性移不变模糊，通过指数核 $g(x) = \\frac{1}{2\\lambda}\\exp(-|x|/\\lambda)$ 实现，其中 $\\lambda$ 是 SE 的平均自由程（沿边缘的一维有效核）。其傅里叶变换的模为 $|G(k)| = \\frac{1}{1+(k\\lambda)^2}$，因此功率传递函数为 $|G(k)|^2 = \\frac{1}{(1+(k\\lambda)^2)^2}$。\n- 在空间频率 $k$ 处，沿线边缘测得的 LER 功率谱密度（PSD）建模为\n$$\nS_{\\text{model}}(k;\\lambda,\\phi) = S_0\\,\\phi\\,|G(k;\\lambda)|^2 + N_0 = S_0\\,\\phi\\,\\frac{1}{\\left(1+(k\\lambda)^2\\right)^2} + N_0,\n$$\n其中 $S_0$ 是一个由曝光和吸收条件决定的已知比例常数，$N_0$ 是一个已知的加性仪器噪声基底。\n\n给定一个在离散空间频率下测得的 LER PSD 数据集。假设在每个频率处的测量误差是独立的高斯误差，其标准差 $\\sigma$ 已知，并且 $\\lambda$ 和 $\\phi$ 的先验分布是独立的对数正态分布，其超参数已指定。请使用贝叶斯推断推导 $(\\lambda, \\phi)$ 的未归一化后验，并在一组测试参数点上计算其自然对数。\n\n所有符号和单位：\n- $\\lambda$：沿边缘的 SE 平均自由程，单位为纳米（nm）。在下面与 $k$ 一起使用时，通过 $\\lambda_{\\mu\\mathrm{m}} = \\lambda_{\\mathrm{nm}}/1000$ 将其转换为微米（µm）。\n- $\\phi$：酸量子产率（无量纲，每个吸收的光子产生的酸分子数）。\n- $k$：空间频率，单位为反微米（$\\mu\\mathrm{m}^{-1}$）。\n- $S_{\\text{meas}}(k)$：测量的 PSD 值，单位为任意 PSD 单位。\n- $S_0 = 2.0\\times 10^{-4}$，$N_0 = 1.0\\times 10^{-7}$，$\\sigma = 5.0\\times 10^{-5}$（所有单位均为一致的 PSD 单位）。\n- $\\lambda$ 的先验分布（单位为 nm）：$\\log \\lambda \\sim \\mathcal{N}(\\mu_\\lambda, \\sigma_\\lambda^2)$，其中 $\\mu_\\lambda = \\ln(10)$ 且 $\\sigma_\\lambda = \\ln(1.5)$。\n- $\\phi$ 的先验分布：$\\log \\phi \\sim \\mathcal{N}(\\mu_\\phi, \\sigma_\\phi^2)$，其中 $\\mu_\\phi = \\ln(8)$ 且 $\\sigma_\\phi = \\ln(1.4)$。\n\n提供的数据：\n- 频率（单位 $\\mu\\mathrm{m}^{-1}$）：$k = [0.5, 1.0, 2.0, 4.0, 8.0, 16.0, 32.0, 64.0, 96.0, 128.0]$。\n- 在这些 $k$ 值下测得的 PSD $S_{\\text{meas}}(k)$：\n$[0.001499992,\\ 0.001499668,\\ 0.001498375,\\ 0.001493201,\\ 0.001474330,\\ 0.001395289,\\ 0.001139412,\\ 0.000593658,\\ 0.000277216,\\ 0.000132955]$。\n\n任务：\n1. 仅从上述基本原理（泊松散粒噪声、线性移不变模糊和给定的指数核）出发，推导出未归一化后验密度 $p(\\lambda,\\phi \\mid \\text{data})$（不含归一化常数）。明确写出未归一化后验的自然对数 $\\log \\tilde{p}(\\lambda,\\phi \\mid \\text{data})$ 的表达式，并显示其对 $(\\lambda,\\phi)$ 的依赖关系。\n2. 实现一个程序，在以下测试案例中计算 $\\log \\tilde{p}(\\lambda,\\phi \\mid \\text{data})$ 的值，其中 $\\lambda$ 的单位是纳米，$\\phi$ 是无量纲的：\n   - 案例 1：$(\\lambda,\\phi)=(12.0, 7.5)$。\n   - 案例 2：$(\\lambda,\\phi)=(4.0, 7.5)$。\n   - 案例 3：$(\\lambda,\\phi)=(20.0, 7.5)$。\n   - 案例 4：$(\\lambda,\\phi)=(12.0, 4.0)$。\n   - 案例 5：$(\\lambda,\\phi)=(12.0, 12.0)$。\n   - 案例 6：$(\\lambda,\\phi)=(3.0, 20.0)$。\n\n似然函数假设：\n- 对于每个频率 $k_i$，测量模型为 $S_{\\text{meas}}(k_i) = S_{\\text{model}}(k_i; \\lambda,\\phi) + \\varepsilon_i$，其中 $\\varepsilon_i \\sim \\mathcal{N}(0,\\sigma^2)$ 相互独立，且 $\\sigma = 5.0\\times 10^{-5}$。\n\n先验分布假设：\n- $\\log \\lambda \\sim \\mathcal{N}(\\mu_\\lambda, \\sigma_\\lambda^2)$，其中 $\\mu_\\lambda = \\ln(10)$ 且 $\\sigma_\\lambda = \\ln(1.5)$，因此对于 $\\lambda  0$，有 $p(\\lambda) \\propto \\frac{1}{\\lambda} \\exp\\!\\left(-\\frac{(\\ln \\lambda - \\mu_\\lambda)^2}{2\\sigma_\\lambda^2}\\right)$。\n- $\\log \\phi \\sim \\mathcal{N}(\\mu_\\phi, \\sigma_\\phi^2)$，其中 $\\mu_\\phi = \\ln(8)$ 且 $\\sigma_\\phi = \\ln(1.4)$，因此对于 $\\phi  0$，有 $p(\\phi) \\propto \\frac{1}{\\phi} \\exp\\!\\left(-\\frac{(\\ln \\phi - \\mu_\\phi)^2}{2\\sigma_\\phi^2}\\right)$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，“[result1,result2,...]”），其中每个“result”是对应测试案例的 $\\log \\tilde{p}(\\lambda,\\phi \\mid \\text{data})$ 值，表示为浮点数。确保在计算 $|G(k;\\lambda)|^2$ 之前，将 $\\lambda$ 的单位从纳米转换为微米，以使 $k$ 和 $\\lambda$ 的单位保持一致。不需要用户输入；常数和数据如上所述。输出为无量纲实数。",
            "solution": "我们从随机曝光框架开始：吸收的光子遵循泊松过程。对于具有平均速率的泊松过程，其波动在空间频率域中是白噪声，并且波动的功率谱密度（PSD）是平坦的且与平均值成正比。酸的生成量与吸收的光子数成正比，比例系数为酸量子产率 $\\phi$，因此酸生成场的输入波动 PSD 随 $\\phi$ 线性变化。\n\n次级电子（SE）输运被建模为沿边缘的线性移不变模糊，由指数核\n$$\ng(x) = \\frac{1}{2\\lambda}\\exp\\!\\left(-\\frac{|x|}{\\lambda}\\right),\n$$\n给出，其中 $\\lambda$ 是平均自由程。该核是归一化的，即 $\\int_{-\\infty}^{\\infty} g(x)\\,dx = 1$。其傅里叶变换的模是众所周知的：\n$$\n|G(k)| = \\frac{1}{1+(k\\lambda)^2},\n$$\n因此功率传递函数为\n$$\n|G(k)|^2 = \\frac{1}{\\left(1+(k\\lambda)^2\\right)^2}.\n$$\n因为线性移不变系统会通过其传递函数模的平方来缩放输入 PSD，所以在空间频率 $k$ 处预测的 LER PSD 为\n$$\nS_{\\text{model}}(k;\\lambda,\\phi) = S_0\\,\\phi\\,|G(k;\\lambda)|^2 + N_0 = S_0\\,\\phi\\,\\frac{1}{\\left(1+(k\\lambda)^2\\right)^2} + N_0,\n$$\n其中 $S_0$ 汇集了来自剂量和吸收的比例因子，$N_0$ 是一个加性噪声基底。\n\n我们得到具有独立高斯误差的离散测量值 $\\{(k_i, S_{\\text{meas}}(k_i))\\}_{i=1}^{n}$：\n$$\nS_{\\text{meas}}(k_i) = S_{\\text{model}}(k_i;\\lambda,\\phi) + \\varepsilon_i,\\quad \\varepsilon_i \\sim \\mathcal{N}(0,\\sigma^2),\\quad i=1,\\dots,n,\n$$\n其中 $\\sigma$ 已知。因此，似然函数为\n$$\np(\\text{data}\\mid \\lambda,\\phi) = \\prod_{i=1}^{n} \\frac{1}{\\sqrt{2\\pi}\\sigma}\n\\exp\\!\\left( -\\frac{\\left(S_{\\text{meas}}(k_i) - S_{\\text{model}}(k_i;\\lambda,\\phi)\\right)^2}{2\\sigma^2} \\right).\n$$\n\n对于先验分布，我们使用独立的对数正态分布：\n- 对于 $\\lambda$（单位为纳米），$\\log \\lambda \\sim \\mathcal{N}(\\mu_\\lambda, \\sigma_\\lambda^2)$，其中 $\\mu_\\lambda = \\ln(10)$ 且 $\\sigma_\\lambda = \\ln(1.5)$。对应的密度为\n$$\np(\\lambda) = \\frac{1}{\\lambda\\,\\sigma_\\lambda\\sqrt{2\\pi}} \\exp\\!\\left( -\\frac{(\\ln \\lambda - \\mu_\\lambda)^2}{2\\sigma_\\lambda^2} \\right), \\quad \\lambda  0.\n$$\n- 对于 $\\phi$，$\\log \\phi \\sim \\mathcal{N}(\\mu_\\phi, \\sigma_\\phi^2)$，其中 $\\mu_\\phi = \\ln(8)$ 且 $\\sigma_\\phi = \\ln(1.4)$：\n$$\np(\\phi) = \\frac{1}{\\phi\\,\\sigma_\\phi\\sqrt{2\\pi}} \\exp\\!\\left( -\\frac{(\\ln \\phi - \\mu_\\phi)^2}{2\\sigma_\\phi^2} \\right), \\quad \\phi  0.\n$$\n\n根据贝叶斯定理，后验分布为\n$$\np(\\lambda,\\phi \\mid \\text{data}) \\propto p(\\text{data} \\mid \\lambda,\\phi)\\, p(\\lambda)\\, p(\\phi).\n$$\n“不含归一化常数”这句话意味着我们可以舍弃任何相对于 $(\\lambda,\\phi)$ 为常数的因子。取自然对数，未归一化的对数后验为\n$$\n\\log \\tilde{p}(\\lambda,\\phi \\mid \\text{data}) =\n-\\frac{1}{2\\sigma^2}\\sum_{i=1}^{n} \\left(S_{\\text{meas}}(k_i) - S_{\\text{model}}(k_i;\\lambda,\\phi)\\right)^2\n-\\log \\lambda - \\frac{(\\ln \\lambda - \\mu_\\lambda)^2}{2\\sigma_\\lambda^2}\n-\\log \\phi - \\frac{(\\ln \\phi - \\mu_\\phi)^2}{2\\sigma_\\phi^2},\n$$\n其中 $S_{\\text{model}}(k_i;\\lambda,\\phi) = S_0\\,\\phi\\,\\left(1 + \\left(k_i \\lambda_{\\mu\\mathrm{m}}\\right)^2\\right)^{-2} + N_0$，并且 $\\lambda_{\\mu\\mathrm{m}} = \\lambda_{\\mathrm{nm}}/1000$ 以确保单位一致，因为 $k_i$ 的单位是 $\\mu\\mathrm{m}^{-1}$。\n\n给定的常数和数据：\n- $S_0 = 2.0\\times 10^{-4}$，$N_0 = 1.0\\times 10^{-7}$，$\\sigma = 5.0\\times 10^{-5}$。\n- $\\mu_\\lambda = \\ln(10)$，$\\sigma_\\lambda = \\ln(1.5)$，$\\mu_\\phi = \\ln(8)$，$\\sigma_\\phi = \\ln(1.4)$。\n- $k = [0.5, 1.0, 2.0, 4.0, 8.0, 16.0, 32.0, 64.0, 96.0, 128.0]$。\n- $S_{\\text{meas}}(k) = [0.001499992,\\ 0.001499668,\\ 0.001498375,\\ 0.001493201,\\ 0.001474330,\\ 0.001395289,\\ 0.001139412,\\ 0.000593658,\\ 0.000277216,\\ 0.000132955]$。\n\n对于任何 $\\lambda0, \\phi0$ 的 $(\\lambda,\\phi)$，计算 $\\log \\tilde{p}(\\lambda,\\phi \\mid \\text{data})$ 的算法如下：\n1. 将 $\\lambda$ 从纳米转换为微米：$\\lambda_{\\mu\\mathrm{m}} \\leftarrow \\lambda/1000$。\n2. 对于每个 $k_i$，计算 $Q_i = \\left(1 + (k_i \\lambda_{\\mu\\mathrm{m}})^2\\right)^{-2}$。\n3. 计算 $S_{\\text{model},i} = S_0\\,\\phi\\,Q_i + N_0$。\n4. 计算残差 $r_i = S_{\\text{meas}}(k_i) - S_{\\text{model},i}$ 和对数似然项 $-\\frac{1}{2\\sigma^2}\\sum_i r_i^2$。\n5. 计算对数先验项 $-\\log \\lambda - \\frac{(\\ln \\lambda - \\mu_\\lambda)^2}{2\\sigma_\\lambda^2}$ 和 $-\\log \\phi - \\frac{(\\ln \\phi - \\mu_\\phi)^2}{2\\sigma_\\phi^2}$。\n6. 将各项相加得到 $\\log \\tilde{p}(\\lambda,\\phi \\mid \\text{data})$。\n7. 对指定的测试案例重复以上步骤。\n\n程序精确地实现了这些步骤，并输出一行包含六个测试案例的未归一化对数后验值列表，顺序与指定的一致。所有计算通过在计算传递函数前将 $\\lambda$ 从纳米转换为微米来确保单位一致。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef unnormalized_log_posterior(lam_nm, phi, k_vals, S_meas, S0, N0, sigma, mu_lam, sig_lam, mu_phi, sig_phi):\n    \"\"\"\n    Compute the unnormalized log-posterior log \\tilde{p}(lam, phi | data)\n    for given lambda (in nm) and phi, given data and hyperparameters.\n    \"\"\"\n    # Enforce positivity; return -inf for invalid parameter values\n    if lam_nm = 0.0 or phi = 0.0:\n        return float(\"-inf\")\n\n    # Convert lambda from nm to um to match k units (um^-1)\n    lam_um = lam_nm / 1000.0\n\n    # Power transfer function |G(k)|^2 for exponential kernel g(x) = (1/(2*lambda)) exp(-|x|/lambda)\n    # |G(k)| = 1 / (1 + (k*lambda)^2), so |G(k)|^2 = 1 / (1 + (k*lambda)^2)^2\n    Q = 1.0 / (1.0 + (k_vals * lam_um) ** 2.0) ** 2.0\n\n    # Model PSD at each frequency\n    S_model = S0 * phi * Q + N0\n\n    # Gaussian likelihood (up to an additive constant): -0.5 * sum((residual/sigma)^2)\n    residuals = S_meas - S_model\n    log_like = -0.5 * np.sum((residuals / sigma) ** 2.0)\n\n    # Log-normal priors (up to additive constants): -ln(x) - (ln x - mu)^2 / (2 sigma^2)\n    log_lam = np.log(lam_nm)\n    log_phi = np.log(phi)\n\n    log_prior_lam = -log_lam - ((log_lam - mu_lam) ** 2.0) / (2.0 * (sig_lam ** 2.0))\n    log_prior_phi = -log_phi - ((log_phi - mu_phi) ** 2.0) / (2.0 * (sig_phi ** 2.0))\n\n    # Unnormalized log-posterior\n    return log_like + log_prior_lam + log_prior_phi\n\ndef solve():\n    # Constants and data from the problem statement\n    S0 = 2.0e-4\n    N0 = 1.0e-7\n    sigma = 5.0e-5\n\n    # Log-normal prior hyperparameters\n    mu_lam = np.log(10.0)          # for lambda in nm\n    sig_lam = np.log(1.5)\n    mu_phi = np.log(8.0)\n    sig_phi = np.log(1.4)\n\n    # Frequencies k in um^-1\n    k_vals = np.array([0.5, 1.0, 2.0, 4.0, 8.0, 16.0, 32.0, 64.0, 96.0, 128.0], dtype=float)\n\n    # Measured PSD values S_meas(k)\n    S_meas = np.array([\n        0.001499992,\n        0.001499668,\n        0.001498375,\n        0.001493201,\n        0.001474330,\n        0.001395289,\n        0.001139412,\n        0.000593658,\n        0.000277216,\n        0.000132955\n    ], dtype=float)\n\n    # Define the test cases: (lambda_nm, phi)\n    test_cases = [\n        (12.0, 7.5),   # Case 1: near a plausible true value\n        (4.0, 7.5),    # Case 2: smaller lambda\n        (20.0, 7.5),   # Case 3: larger lambda\n        (12.0, 4.0),   # Case 4: smaller phi\n        (12.0, 12.0),  # Case 5: larger phi\n        (3.0, 20.0),   # Case 6: very small lambda, very large phi (edge)\n    ]\n\n    results = []\n    for lam_nm, phi in test_cases:\n        lp = unnormalized_log_posterior(\n            lam_nm, phi,\n            k_vals, S_meas,\n            S0, N0, sigma,\n            mu_lam, sig_lam, mu_phi, sig_phi\n        )\n        results.append(lp)\n\n    # Final print statement in the exact required format.\n    # Format floats with sufficient precision for reproducibility.\n    print(f\"[{','.join(f'{val:.6f}' for val in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在光刻胶中，曝光后发生的化学反应是复杂的随机过程，直接模拟这些过程对于预测最终形貌至关重要。本练习聚焦于模拟这些随机化学网络的计算方法，要求你从第一性原理出发，推导并比较精确的随机模拟算法（SSA）与近似的$\\tau$-leaping方法的计算复杂度和适用范围。完成此练习将使你深入了解在模拟精度和计算效率之间进行权衡的策略，这是计算建模中的一项核心技能。",
            "id": "4167990",
            "problem": "考虑一个空间离散化的极紫外（EUV）光刻胶模型，其中由散粒噪声和次级电子曝光引起的化学反应发生在体素网格中。设体素数量为 $N_v$，每个体素有 $R$ 个反应通道，并假设每个体素的总倾向性尺度为 $a_0$（单位：$\\mathrm{s}^{-1}$）。系统中反应通道的总数为 $M = N_v R$，总倾向性为 $A = N_v a_0$。\n\n要求您从化学主方程和随机模拟算法（SSA）的第一性原理出发，推导SSA与$\\tau$-跳跃法在时间范围 $T$（单位：$\\mathrm{s}$）内模拟该反应网络的预期计算复杂度。您的推导必须基于以下基础：\n- 化学主方程表明，反应事件构成一个连续时间马尔可夫过程，其事件间隔时间呈指数分布，由总倾向性 $A$ 控制。\n- 随机模拟算法（SSA）一次抽取一个反应事件；在时间 $T$ 内的预期事件数为 $AT$。朴素的反应选择方法的时间复杂度与 $M$ 成线性关系，而基于二叉树或别名增强的选择方法的时间复杂度与 $M$ 成对数关系。\n- $\\tau$-跳跃法在假设倾向性变化微小的情况下进行大小为 $\\tau$ 的跳跃；其准确性要求倾向性的相对变化有界，并且每个通道有足够多的激发次数以证明泊松采样的合理性。\n\n假设一个简化但科学上一致的光刻胶化学设置：\n- 每个体素的 $R$ 个反应倾向性处于同一数量级，因此典型的单通道倾向性尺度为 $a_0 / R$。\n- 每个反应的化学计量最多消耗限制性物种的 $\\nu_{\\max}$ 个分子，每个体素的最小布居尺度为 $X_{\\min}$（分子）。这抽象了次级电子的空间扩散，确保了倾向性相对于状态是利普希茨连续的。\n- 为了确保$\\tau$-跳跃法的准确性，设置了一个小的相对变化预算 $\\varepsilon \\in (0,1)$ 和一个每个通道的最小期望激发次数 $k_{\\min}$。\n- 安全分数 $s \\in (0,1)$ 对一次跳跃内的期望消耗施加非负性保障。\n\n从这些基础出发，推导以下表达式：\n1. 在朴素选择和对数选择下，用 $N_v$、$R$、$a_0$ 和 $T$ 表示的预期SSA复杂度。\n2. 使用以下条件为$\\tau$-跳跃步长 $\\tau$ 推导一个保守界限：\n   - 倾向性相对变化的利普希茨类型界限，$L = (\\nu_{\\max} / X_{\\min}) (a_0 / R)$，导出 $\\tau_{\\text{small}} = \\varepsilon / L$。\n   - 多次激发条件，$\\tau_{\\text{many}} = k_{\\min} / (a_0 / R)$。\n   - 非负性安全条件，$\\tau_{\\text{safe}} = s X_{\\min} R / (\\nu_{\\max} a_0)$。\n   将有效跳跃步长定义为 $\\tau_{\\text{leap}} = \\min\\{\\tau_{\\text{small}}, \\tau_{\\text{many}}, \\tau_{\\text{safe}}\\}$。\n3. 预期的$\\tau$-跳跃复杂度，即跳跃次数乘以每步跳跃的计算量。假设每步跳跃的计算量与 $M$ 成线性关系，因为所有 $M$ 个通道都通过泊松抽样进行更新，即 $C_{\\tau} = \\lceil T / \\tau_{\\text{leap}} \\rceil \\cdot M$。\n4. $\\tau$-跳跃法的一个精确的准确性范围准则：证明存在一个能同时满足所有约束的 $\\tau$ 当且仅当 $\\tau_{\\text{many}} \\le \\min\\{\\tau_{\\text{small}}, \\tau_{\\text{safe}}\\}$。返回一个布尔值，指示该范围是否成立。\n\n实现一个程序，给定一组参数元组，计算：\n- $C_{\\text{SSA,lin}} = AT \\cdot M$（朴素线性选择）。\n- $C_{\\text{SSA,log}} = AT \\cdot \\log_{2}(M)$（对数选择）。\n- $C_{\\tau} = \\lceil T / \\tau_{\\text{leap}} \\rceil \\cdot M$。\n- 如果 $\\tau_{\\text{many}} \\le \\min\\{\\tau_{\\text{small}}, \\tau_{\\text{safe}}\\}$，则 $\\text{accurate} = \\text{True}$，否则为 $\\text{False}$。\n\n将复杂度值表示为浮点数（无单位的操作计数），准确性表示为布尔值。\n\n使用以下参数测试套件来检验不同情况：\n- 情况1（高布居和平衡约束的理想情况）：\n  - $N_v = 4096$, $R = 5$, $a_0 = 200\\,\\mathrm{s}^{-1}$, $T = 0.05\\,\\mathrm{s}$, $\\varepsilon = 0.05$, $k_{\\min} = 20$, $\\nu_{\\max} = 2$, $X_{\\min} = 10^{4}$, $s = 0.2$。\n- 情况2（稀疏事件，多次激发约束占主导，准确性不满足）：\n  - $N_v = 64$, $R = 3$, $a_0 = 0.3\\,\\mathrm{s}^{-1}$, $T = 1.0\\,\\mathrm{s}$, $\\varepsilon = 0.05$, $k_{\\min} = 20$, $\\nu_{\\max} = 2$, $X_{\\min} = 50$, $s = 0.5$。\n- 情况3（小变化等于多次激发的边界情况）：\n  - $N_v = 100$, $R = 4$, $a_0 = 50\\,\\mathrm{s}^{-1}$, $T = 0.2\\,\\mathrm{s}$, $\\varepsilon = 0.02$, $k_{\\min} = 1$, $\\nu_{\\max} = 2$, $X_{\\min} = 100$, $s = 0.9$。\n- 情况4（非负性安全将 $\\tau$ 约束在多次激发阈值以下，准确性不满足）：\n  - $N_v = 1000$, $R = 2$, $a_0 = 20\\,\\mathrm{s}^{-1}$, $T = 0.1\\,\\mathrm{s}$, $\\varepsilon = 0.05$, $k_{\\min} = 10$, $\\nu_{\\max} = 3$, $X_{\\min} = 5$, $s = 0.2$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例贡献一个形如 $[C_{\\text{SSA,lin}}, C_{\\text{SSA,log}}, C_{\\tau}, \\text{accurate}]$ 的列表。例如，最终输出格式为 $[[c_{1,\\text{lin}},c_{1,\\log},c_{1,\\tau},b_{1}],[c_{2,\\text{lin}},c_{2,\\log},c_{2,\\tau},b_{2}],\\ldots]$。",
            "solution": "该问题要求基于化学主方程的第一性原理和所提供的极紫外（EUV）光刻胶化学建模假设，推导随机模拟算法（SSA）和$\\tau$-跳跃法在一个空间离散的化学反应网络中的计算复杂度，并为$\\tau$-跳跃法的准确性提供一个准则。\n\n系统由 $N_v$ 个体素定义，每个体素有 $R$ 个反应通道。反应通道总数为 $M = N_v R$。总倾向性是所有单个反应倾向性之和，给定为 $A = N_v a_0$，其中 $a_0$ 是单位为 $\\mathrm{s}^{-1}$ 的每个体素的总倾向性尺度。模拟的总时间为 $T$。\n\n1. SSA复杂度（$C_{\\text{SSA}}$）的推导\n\n化学主方程将系统描述为一个连续时间马尔可夫过程。到下一个反应事件发生的时间是一个速率参数为 $A$（总倾向性）的指数随机变量。因此，在时间范围 $T$ 内的期望反应事件数是总速率乘以时间长度，即 $N_{\\text{events}} = AT$。\n\nSSA通过一次推进一个反应事件来模拟系统。总计算复杂度是模拟的事件数与每个事件所需的计算量的乘积。每个事件的计算量主要由选择哪个反应通道激发所决定。\n\n- **朴素线性选择：** 在这种方法中，对于每个事件，必须遍历所有 $M$ 个反应通道来选择下一个反应。此选择步骤的复杂度与通道数量成线性关系，即 $\\mathcal{O}(M)$。因此，总的预期复杂度 $C_{\\text{SSA,lin}}$ 为：\n    $C_{\\text{SSA,lin}} = (\\text{事件数}) \\times (\\text{每个事件的计算量}) = (AT) \\cdot M$。\n    代入给定的定义 $A = N_v a_0$ 和 $M = N_v R$，我们得到：\n    $C_{\\text{SSA,lin}} = (N_v a_0 T) (N_v R)$。\n\n- **对数选择：** 更高效的选择算法，如基于二叉树（倾向性树）或组合-拒绝方法，可以在与通道数量成对数关系的时间内选择一个反应。此选择步骤的复杂度为 $\\mathcal{O}(\\log M)$。因此，总的预期复杂度 $C_{\\text{SSA,log}}$ 为：\n    $C_{\\text{SSA,log}} = (\\text{事件数}) \\times (\\text{每个事件的计算量}) = (AT) \\cdot \\log_{2}(M)$。\n    代入 $A$ 和 $M$ 的定义：\n    $C_{\\text{SSA,log}} = (N_v a_0 T) \\log_{2}(N_v R)$。\n\n2. $\\tau$-跳跃步长（$\\tau_{\\text{leap}}$）的推导\n\n$\\tau$-跳跃法通过采用一个时间步长 $\\tau$ 来近似动力学，在此期间倾向性被假定为常数。然后，每个反应通道的激发次数从泊松分布中抽取。$\\tau$ 的大小受到多个准确性和稳定性要求的约束。\n\n- **相对倾向性变化（小变化条件）：** 为确保倾向性在跳跃期间不会显著改变，任何倾向性的相对变化必须被一个较小的值 $\\varepsilon \\in (0,1)$ 所限制。问题提供了一个关于相对倾向性变化的利普希茨类型的常数，$L = (\\nu_{\\max} / X_{\\min}) (a_0 / R)$，其中 $\\nu_{\\max}$ 是限制性物种的最大化学计量，而 $X_{\\min}$ 是最小布居尺度。在 $\\tau$ 时间内的累积相对变化约为 $L \\tau$。这导致约束 $L \\tau \\le \\varepsilon$，从而得出 $\\tau$ 的一个上界：\n    $\\tau_{\\text{small}} = \\frac{\\varepsilon}{L} = \\frac{\\varepsilon X_{\\min} R}{\\nu_{\\max} a_0}$。\n\n- **足够多的激发次数（多次激发条件）：** 为了使泊松近似在统计上合理，一个典型通道的期望激发次数 $(a_0/R)\\tau$ 必须足够大，即大于一个阈值 $k_{\\min}$。这对 $\\tau$ 施加了一个下界：$(a_0/R)\\tau \\ge k_{\\min}$。问题定义了一个代表此边界的特征时间 $\\tau_{\\text{many}}$：\n    $\\tau_{\\text{many}} = \\frac{k_{\\min}}{a_0 / R} = \\frac{k_{\\min} R}{a_0}$。\n\n- **非负性安全条件：** 为防止物种布居变为负数，必须控制一次跳跃内任何物种的消耗。问题指定了一个保守条件，即来自单个典型通道的期望消耗 $(a_0/R)\\tau \\cdot \\nu_{\\max}$ 必须小于最小布居 $X_{\\min}$ 的一个安全分数 $s$。这给出了约束 $(a_0/R)\\tau \\nu_{\\max} \\le s X_{\\min}$，从而得出 $\\tau$ 的另一个上界：\n    $\\tau_{\\text{safe}} = \\frac{s X_{\\min}}{(a_0/R) \\nu_{\\max}} = \\frac{s X_{\\min} R}{\\nu_{\\max} a_0}$。\n\n问题将有效跳跃步长 $\\tau_{\\text{leap}}$ 定义为这三个特征时间的最小值，以保守的方式同时强制执行所有条件：\n$\\tau_{\\text{leap}} = \\min\\{\\tau_{\\text{small}}, \\tau_{\\text{many}}, \\tau_{\\text{safe}}\\}$。\n\n3. $\\tau$-跳跃复杂度（$C_{\\tau}$）的推导\n\n$\\tau$-跳跃模拟以大小为 $\\tau_{\\text{leap}}$ 的离散步长进行。覆盖时间范围 $T$ 所需的步数是 $N_{\\text{leaps}} = T / \\tau_{\\text{leap}}$。由于必须采取整数步数，我们使用向上取整函数：$N_{\\text{leaps}} = \\lceil T / \\tau_{\\text{leap}} \\rceil$。\n\n在每次跳跃中，算法必须为 $M$ 个反应通道中的每一个抽取一个随机的激发次数来更新状态。这需要与 $M$ 成正比的计算量。总复杂度是跳跃次数与每步跳跃计算量的乘积：\n$C_{\\tau} = N_{\\text{leaps}} \\cdot (\\text{每步跳跃的计算量}) = \\lceil T / \\tau_{\\text{leap}} \\rceil \\cdot M$。\n\n4. 准确性范围准则\n\n为了使$\\tau$-跳跃法被认为是在一个有效且准确的范围内运行，必须存在一个步长 $\\tau$ 能同时满足所有基本约束。这要求存在一个 $\\tau$：\n- 足够小以满足小变化条件：$\\tau \\le \\tau_{\\text{small}}$\n- 足够小以满足非负性条件：$\\tau \\le \\tau_{\\text{safe}}$\n- 足够大以满足多次激发条件：$\\tau \\ge \\tau_{\\text{many}}$\n\n一个能满足所有三个条件的 $\\tau$ 只能在下限小于或等于上限时存在。前两个条件的组合上限是 $\\min\\{\\tau_{\\text{small}}, \\tau_{\\text{safe}}\\}$。因此，存在有效 $\\tau$ 的准则是：\n$\\tau_{\\text{many}} \\le \\min\\{\\tau_{\\text{small}}, \\tau_{\\text{safe}}\\}$。\n\n如果此不等式成立，则认为该方法处于准确的范围内。否则，这些约束是相互矛盾的，没有单一的 $\\tau$ 可以同时满足统计有效性（多次激发）和近似准确性（小变化和非负性）的要求。问题要求返回一个布尔值 $\\text{accurate}$，以指示此条件是否满足。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the complexity of SSA and tau-leaping methods for simulating\n    a stochastic chemical reaction network based on provided parameters.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (happy path with high populations and balanced constraints)\n        (4096, 5, 200, 0.05, 0.05, 20, 2, 1e4, 0.2),\n        # Case 2 (sparse events, many-firings constraint dominant, accuracy fails)\n        (64, 3, 0.3, 1.0, 0.05, 20, 2, 50, 0.5),\n        # Case 3 (boundary where small-change equals many-firings)\n        (100, 4, 50, 0.2, 0.02, 1, 2, 100, 0.9),\n        # Case 4 (non-negativity safety constrains tau below many-firings threshold, accuracy fails)\n        (1000, 2, 20, 0.1, 0.05, 10, 3, 5, 0.2),\n    ]\n\n    results = []\n    for case in test_cases:\n        Nv, R, a0, T, eps, k_min, nu_max, X_min, s = case\n\n        # Total number of reaction channels\n        M = float(Nv * R)\n        # Total propensity\n        A = float(Nv * a0)\n\n        # 1. SSA Complexity\n        # Naive linear selection\n        C_SSA_lin = A * T * M\n        # Logarithmic selection\n        C_SSA_log = A * T * np.log2(M) if M > 0 else 0.0\n\n        # 2. Tau-leaping Step Size Calculation\n        # Small-change condition\n        # tau_small = (eps * X_min * R) / (nu_max * a0)\n        if nu_max * a0 == 0:\n             tau_small = float('inf')\n        else:\n            tau_small = (eps * X_min * R) / (nu_max * a0)\n        \n        # Many-firings condition\n        # tau_many = (k_min * R) / a0\n        if a0 == 0:\n            tau_many = float('inf')\n        else:\n            tau_many = (k_min * R) / a0\n        \n        # Non-negativity safety condition\n        # tau_safe = (s * X_min * R) / (nu_max * a0)\n        if nu_max * a0 == 0:\n            tau_safe = float('inf')\n        else:\n            tau_safe = (s * X_min * R) / (nu_max * a0)\n\n        # Operative leap size\n        # Problem statement defines it as min of the three, but for calculation, \n        # the leap size should only be constrained by the upper bounds if the accuracy criterion is met.\n        # However, following the prompt literally for calculation.\n        tau_leap = min(tau_small, tau_many, tau_safe)\n\n        # 3. Tau-leaping Complexity\n        if tau_leap > 0:\n            C_tau = np.ceil(T / tau_leap) * M\n        else:\n            # If tau_leap is zero, the number of leaps is effectively infinite.\n            # This indicates SSA must be used. Complexity is represented as infinity.\n            C_tau = float('inf')\n\n        # 4. Accuracy Regime Criterion\n        accurate = tau_many = min(tau_small, tau_safe)\n\n        # Store results for this case\n        results.append([\n            float(C_SSA_lin),\n            float(C_SSA_log),\n            float(C_tau),\n            accurate\n        ])\n\n    # Final print statement in the exact required format.\n    # str(results) produces the correct format e.g., \"[[...], [...]]\"\n    print(str(results).replace(\" \", \"\"))\n\nsolve()\n```"
        }
    ]
}