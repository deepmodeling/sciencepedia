{
    "hands_on_practices": [
        {
            "introduction": "对任何新型材料的工艺建模都始于对其基本电子能带结构的深刻理解。石墨烯的卓越性能源于其在布里渊区角落的线性色散关系，即狄拉克锥。本练习将从第一性原理出发，使用紧束缚模型这一强大而简洁的量子方法，推导出石墨烯低能激发下的狄拉克锥结构及其费米速度$v_F$，为理解二维材料的奇异输运性质奠定理论基础 ()。",
            "id": "4156974",
            "problem": "在用于半导体制造的二维 ($2$D) 材料的工艺建模中，石墨烯的低能电子色散为沟道和互连的器件尺度输运模型提供了依据。考虑一个单层石墨烯片，其由蜂窝晶格上的最近邻紧束缚 (TB) 哈密顿量描述，该晶格具有两个标记为 $A$ 和 $B$ 的子晶格。假设每个格点有一个 $\\pi$ 键轨道，最近邻跃迁参数为 $t$（实数且为正），在位能为零，并忽略自旋、多体相互作用和无序。令最近邻碳-碳键长为 $a$，并选择从子晶格 $A$ 到 $B$ 的三个最近邻矢量为\n$$\\boldsymbol{\\delta}_{1} = a \\left(0, 1\\right), \\quad \\boldsymbol{\\delta}_{2} = a \\left(\\frac{\\sqrt{3}}{2}, -\\frac{1}{2}\\right), \\quad \\boldsymbol{\\delta}_{3} = a \\left(-\\frac{\\sqrt{3}}{2}, -\\frac{1}{2}\\right).$$\n使用布洛赫定理和蜂窝晶格的双原子基矢，在子晶格基矢 $\\{|A\\rangle, |B\\rangle\\}$ 下写出晶体动量空间哈密顿量 $H(\\mathbf{k})$，确定布里渊区 (BZ) 中能带接触点的条件，并在某个此类点附近将能谱线性化，以获得一个低能的、各向同性的色散关系。从第一性原理出发，确定此线性色散的斜率，并由此求出以跃迁参数 $t$、键长 $a$ 和约化普朗克常数 $\\hbar$ 表示的费米速度 $v_{F}$。\n\n答案规格：\n- 只提供用 $t$、$a$ 和 $\\hbar$ 表示的 $v_{F}$ 的最终解析表达式。\n- 不要进行任何数值代入，也不要在最终表达式中包含单位。",
            "solution": "### 步骤 1：问题验证\n\n用户提供了一个问题，要求从最近邻紧束缚模型中推导石墨烯的费米速度。该问题在科学上是合理的、可形式化的、完整的，并且在理论建模的背景下是现实的。这是一个固态物理学中标准的、非平凡的推导。问题被判定为**有效的**。\n\n### 步骤 2：求解推导\n\n在实空间中，只考虑强度为 $-t$ 的最近邻跃迁，紧束缚哈密顿量由下式给出：\n$$ H = -t \\sum_{\\langle i, j \\rangle} c_i^\\dagger c_j $$\n其中求和遍及所有最近邻格点对 $\\langle i, j \\rangle$，$c_i^\\dagger$ ($c_j$) 分别是在格点 $i$ ($j$) 上电子的产生（湮灭）算符。在双子晶格基矢 $\\{|A\\rangle, |B\\rangle\\}$下，且在位能为零的情况下，可以构建动量空间中的哈密顿矩阵 $H(\\mathbf{k})$。由于在同一子晶格内没有跃迁，对角元为零：$H_{AA}(\\mathbf{k}) = H_{BB}(\\mathbf{k}) = 0$。\n\n非对角元 $H_{AB}(\\mathbf{k})$ 代表从子晶格 $B$ 上的轨道到子晶格 $A$ 上轨道的耦合。我们把将 A 上的态耦合到 B 的项定义为 $H_{BA}(\\mathbf{k})$，它包含相位 $e^{i\\mathbf{k}\\cdot\\boldsymbol{\\delta}_j}$。我们将基矢定义为 $(|A\\rangle, |B\\rangle)$。那么 $H_{AB}(\\mathbf{k})$ 将 $|B\\rangle$ 耦合到 $|A\\rangle$。从 B 上的一个格点到其在 A 上的近邻的矢量是 $-\\boldsymbol{\\delta}_j$。\n$$H_{AB}(\\mathbf{k}) = -t \\sum_{j=1}^{3} \\exp(i\\mathbf{k} \\cdot (-\\boldsymbol{\\delta}_j)) = -t \\sum_{j=1}^{3} \\exp(-i\\mathbf{k} \\cdot \\boldsymbol{\\delta}_j)$$\n哈密顿量必须是厄米共轭的，所以 $H_{BA}(\\mathbf{k}) = H_{AB}^*(\\mathbf{k}) = -t \\sum_{j=1}^{3} \\exp(i\\mathbf{k} \\cdot \\boldsymbol{\\delta}_j)$。\n定义函数 $h(\\mathbf{k}) = \\sum_{j=1}^{3} \\exp(i\\mathbf{k} \\cdot \\boldsymbol{\\delta}_j)$。那么哈密顿量为：\n$$ H(\\mathbf{k}) = \\begin{pmatrix} H_{AA} & H_{AB} \\\\ H_{BA} & H_{BB} \\end{pmatrix} = \\begin{pmatrix} 0 & -t h^*(\\mathbf{k}) \\\\ -t h(\\mathbf{k}) & 0 \\end{pmatrix} $$\n能量本征值 $E(\\mathbf{k})$ 可通过求解特征方程 $\\det(H(\\mathbf{k}) - E\\mathbf{I}) = 0$ 得到：\n$$ \\begin{vmatrix} -E & -t h^*(\\mathbf{k}) \\\\ -t h(\\mathbf{k}) & -E \\end{vmatrix} = E^2 - t^2 |h(\\mathbf{k})|^2 = 0 $$\n这给出了能量色散关系：\n$$ E(\\mathbf{k}) = \\pm t |h(\\mathbf{k})| $$\n能带接触（导带和价带相遇处）的条件是 $E(\\mathbf{k})=0$，这要求 $|h(\\mathbf{k})|=0$，或者简单地说 $h(\\mathbf{k})=0$。这些点就是狄拉克点。\n\n我们使用 $\\mathbf{k} = (k_x, k_y)$ 和给定的 $\\boldsymbol{\\delta}_j$ 矢量来计算 $h(\\mathbf{k})$：\n$$ h(\\mathbf{k}) = e^{iak_y} + e^{ia(\\frac{\\sqrt{3}}{2}k_x - \\frac{1}{2}k_y)} + e^{ia(-\\frac{\\sqrt{3}}{2}k_x - \\frac{1}{2}k_y)} $$\n$$ h(\\mathbf{k}) = e^{iak_y} + 2e^{-iak_y/2}\\cos\\left(\\frac{a\\sqrt{3}}{2}k_x\\right) $$\n狄拉克点 $\\mathbf{K}$ 是 $h(\\mathbf{K})=0$ 的解。已知它们位于第一布里渊区的顶点。可以找到其中一个点为 $\\mathbf{K} = \\left(\\frac{4\\pi}{3\\sqrt{3}a}, 0\\right)$。在该点 $\\mathbf{K}$，$k_y=0$ 且 $\\frac{a\\sqrt{3}}{2}k_x = \\frac{2\\pi}{3}$。代入得：\n$$ h(\\mathbf{K}) = e^0 + 2e^0\\cos\\left(\\frac{2\\pi}{3}\\right) = 1 + 2\\left(-\\frac{1}{2}\\right) = 0 $$\n所以，$\\mathbf{K} = \\left(\\frac{4\\pi}{3\\sqrt{3}a}, 0\\right)$ 确实是一个狄拉克点。\n\n为了找到低能色散关系，我们通过考虑一个小的动量偏离 $\\mathbf{q}=(q_x, q_y)$ (使得 $\\mathbf{k} = \\mathbf{K}+\\mathbf{q}$)，在此狄拉克点 $\\mathbf{K}$ 附近将 $h(\\mathbf{k})$ 线性化。\n$$ h(\\mathbf{K}+\\mathbf{q}) \\approx h(\\mathbf{K}) + \\mathbf{q} \\cdot \\nabla_{\\mathbf{k}}h(\\mathbf{k}) \\Big|_{\\mathbf{k}=\\mathbf{K}} = q_x \\frac{\\partial h}{\\partial k_x}\\Big|_{\\mathbf{K}} + q_y \\frac{\\partial h}{\\partial k_y}\\Big|_{\\mathbf{K}} $$\n我们计算 $h(\\mathbf{k}) = \\sum_j \\exp(i\\mathbf{k} \\cdot \\boldsymbol{\\delta}_j)$ 的偏导数：\n$$ \\frac{\\partial h}{\\partial k_x} = \\sum_j i\\delta_{j,x} \\exp(i\\mathbf{k} \\cdot \\boldsymbol{\\delta}_j), \\quad \\frac{\\partial h}{\\partial k_y} = \\sum_j i\\delta_{j,y} \\exp(i\\mathbf{k} \\cdot \\boldsymbol{\\delta}_j) $$\n在 $\\mathbf{k}=\\mathbf{K}$ 处，相位因子为 $\\mathbf{K} \\cdot \\boldsymbol{\\delta}_1 = 0$, $\\mathbf{K} \\cdot \\boldsymbol{\\delta}_2 = \\frac{2\\pi}{3}$ 和 $\\mathbf{K} \\cdot \\boldsymbol{\\delta}_3 = -\\frac{2\\pi}{3}$。\n计算在 $\\mathbf{K}$ 处的导数：\n$$ \\frac{\\partial h}{\\partial k_x}\\Big|_{\\mathbf{K}} = i \\left[ (0)e^{i0} + \\left(\\frac{a\\sqrt{3}}{2}\\right)e^{i2\\pi/3} + \\left(-\\frac{a\\sqrt{3}}{2}\\right)e^{-i2\\pi/3} \\right] = i\\frac{a\\sqrt{3}}{2} \\left( 2i\\sin\\frac{2\\pi}{3} \\right) = -\\frac{3a}{2} $$\n$$ \\frac{\\partial h}{\\partial k_y}\\Big|_{\\mathbf{K}} = i \\left[ (a)e^{i0} + \\left(-\\frac{a}{2}\\right)e^{i2\\pi/3} + \\left(-\\frac{a}{2}\\right)e^{-i2\\pi/3} \\right] = i \\left[ a - a\\cos\\frac{2\\pi}{3} \\right] = i\\frac{3a}{2} $$\n将这些结果代回到 $h(\\mathbf{K}+\\mathbf{q})$ 的展开式中：\n$$ h(\\mathbf{q}) \\equiv h(\\mathbf{K}+\\mathbf{q}) \\approx q_x\\left(-\\frac{3a}{2}\\right) + q_y\\left(i\\frac{3a}{2}\\right) = -\\frac{3a}{2}(q_x - iq_y) $$\n于是，低能色散关系为：\n$$ E(\\mathbf{q}) = \\pm t |h(\\mathbf{q})| \\approx \\pm t \\left|-\\frac{3a}{2}(q_x - iq_y)\\right| = \\pm t \\frac{3a}{2} \\sqrt{q_x^2 + q_y^2} = \\pm \\frac{3ta}{2} |\\mathbf{q}| $$\n此色散关系与动量偏离的大小 $|\\mathbf{q}|$ 成线性关系，并且是各向同性的。这就是特征性的狄拉克锥色散。\n\n狄拉克点附近的电子色散关系通常用费米速度 $v_F$ 表示为 $E(\\mathbf{q}) = \\pm \\hbar v_F |\\mathbf{q}|$。\n将此与我们推导的表达式进行比较，我们确定斜率为：\n$$ \\hbar v_F = \\frac{3ta}{2} $$\n求解费米速度 $v_F$ 得到：\n$$ v_F = \\frac{3ta}{2\\hbar} $$\n该表达式代表了在费米能级（对于未掺杂的石墨烯，费米能级位于狄拉克点）上电子的群速度。",
            "answer": "$$\\boxed{\\frac{3ta}{2\\hbar}}$$"
        },
        {
            "introduction": "在掌握了理想二维材料的内禀电子特性后，下一步关键是学习如何表征真实器件的电学参数。接触电阻$R_c$和薄层电阻$R_{sh}$是衡量二维材料器件性能最重要的两个指标，它们直接影响器件的功耗和速度。本练习将推导一种被广泛应用的电学测试结构——传输线模型（TLM）的核心关系式，它提供了一种从实验上精确提取$R_c$和$R_{sh}$的标准化方法 ()。",
            "id": "4156913",
            "problem": "一个单层二维（2D）半导体形成一个矩形沟道，其长度为 $L$、宽度为 $W$、物理厚度为 $t$，其两端由两个相同的金属电极接触。该二维薄膜的体电阻率是均匀的，等于 $\\rho$，金属/二维界面各自可以建模为一个集总接触电阻 $R_{c}$，对于相对于传输长度足够长的接触，该电阻与 $L$ 无关。假设整个宽度上的电流密度在空间上是均匀的，沟道边缘的电流拥挤可以忽略不计，并且串联元件线性相加。从欧姆定律以及根据电阻率和几何形状定义的电阻出发，并根据需要引入二维薄膜的薄层电阻 $R_{sh}$，推导出一个关于 $L$ 的显式线性函数，用于表示在两个金属电极之间测得的总两端电阻。用 $R_{c}$、$R_{sh}$、$L$ 和 $W$ 来表示该函数。将总两端电阻的最终答案以欧姆为单位，表示为单个封闭形式的解析表达式。",
            "solution": "### 步骤 1：问题验证\n\n问题陈述是明确的、科学合理的，并且为唯一的解析解提供了所有必要的参数和假设。它描述了一个标准的传输线模型（TLM）结构，这是表征半导体薄膜接触电阻和薄层电阻的基本技术。问题被判定为**有效的**。\n\n### 步骤 2：求解推导\n\n总的两端电阻，记为 $R_{T}$，是在两个测量探针之间串联连接的各个电阻元件的总和。电流路径包括第一个金属-半导体接触、半导体沟道本身，以及第二个金属-半导体接触。根据问题中给出的串联元件线性相加的假设，总电阻可以建模为一个简单的串联电路。\n\n这些元件是：\n1. 第一个接触的电阻：$R_{c}$\n2. 半导体沟道的电阻：$R_{ch}$\n3. 第二个接触的电阻：$R_{c}$\n\n因此，总电阻 $R_{T}$ 是这三个元件之和：\n$$R_{T} = R_{c} + R_{ch} + R_{c} = 2R_{c} + R_{ch}$$\n\n下一步是确定半导体沟道的电阻 $R_{ch}$。根据电阻的基本定义，对于一个电阻率均匀为 $\\rho$、长度为 $\\ell$、横截面积恒为 $A$ 的导体，其电阻由下式给出：\n$$R = \\rho \\frac{\\ell}{A}$$\n\n对于问题中描述的矩形半导体沟道，电流路径的长度是 $L$，电流流过的横截面积是沟道宽度 $W$ 和其物理厚度 $t$ 的乘积。因此，对于沟道电阻 $R_{ch}$：\n- 长度 $\\ell = L$\n- 横截面积 $A = W \\cdot t$\n\n将这些代入电阻公式可得：\n$$R_{ch} = \\rho \\frac{L}{W t}$$\n\n问题要求引入薄层电阻 $R_{sh}$。薄层电阻是厚度均匀的薄膜的一个属性，定义为体电阻率 $\\rho$ 除以薄膜厚度 $t$：\n$$R_{sh} = \\frac{\\rho}{t}$$\n薄层电阻的单位是欧姆，但通常表示为欧姆每方（$\\Omega/\\Box$），以强调其作为在相对两侧之间测量的方形材料片的电阻的性质。\n\n现在，我们可以用薄层电阻 $R_{sh}$ 来表示沟道电阻 $R_{ch}$。我们可以通过将 $\\rho$ 和 $t$ 组合在一起来重写 $R_{ch}$ 的表达式：\n$$R_{ch} = \\left(\\frac{\\rho}{t}\\right) \\frac{L}{W}$$\n将 $R_{sh}$ 的定义代入此方程，我们得到：\n$$R_{ch} = R_{sh} \\frac{L}{W}$$\n在这里，无量纲比率 $\\frac{L}{W}$ 代表构成矩形沟道的材料的“方块”数量。\n\n最后，我们将 $R_{ch}$ 的这个表达式代回到总电阻 $R_{T}$ 的方程中：\n$$R_{T} = 2R_{c} + R_{sh} \\frac{L}{W}$$\n\n这个表达式代表了总的两端电阻。正如所要求的，它是沟道长度 $L$ 的一个显式线性函数。如果我们将 $R_{T}$ 写成 $L$ 的函数，我们得到 $R_{T}(L) = (\\frac{R_{sh}}{W})L + 2R_{c}$，其形式为 $y = mx+b$。斜率是 $m = \\frac{R_{sh}}{W}$，y轴截距是总接触电阻 $2R_{c}$。该表达式是用所需参数 $R_{c}$、$R_{sh}$、$L$ 和 $W$ 表示的。",
            "answer": "$$\n\\boxed{2R_{c} + R_{sh} \\frac{L}{W}}\n$$"
        },
        {
            "introduction": "真实的材料并非完美晶体，其内部的缺陷（如原子空位）往往会显著改变其电学性质，是工艺建模中必须考虑的关键因素。本练习将探讨石墨烯中最基本的一种点缺陷——单空位，并从其蜂窝状二分晶格的拓扑对称性出发，定性解释为何空位会引入零能中带隙态。此外，练习还要求通过编写程序进行数值计算，量化缺陷对局域态密度（LDOS）的影响，从而将深刻的物理理论与实用的计算建模技能结合起来 ()。",
            "id": "4156880",
            "problem": "考虑一个代表石墨烯的二维蜂窝晶格，该晶格通过最近邻紧束缚哈密顿量进行建模。设纯净哈密顿量为 $H_0 = -t \\sum_{\\langle i,j \\rangle} (c_i^\\dagger c_j + c_j^\\dagger c_i)$，其中 $t$ 是最近邻跳跃能量，$\\langle i,j \\rangle$ 表示二分蜂窝晶格上的最近邻格点对，$c_i^\\dagger, c_i$ 是格点 $i$ 上的费米子产生和湮灭算符。通过在 A 子晶格的一个格点 $v$ 上添加在位势项 $V = U \\, c_v^\\dagger c_v$（其中 $U \\to \\infty$）来引入一个单空位，从而模拟该格点的移除。将哈密顿量 $H$ 的推迟单粒子格林函数定义为 $G(E) = (E + i \\eta - H)^{-1}$，其中 $E$ 是能量，$\\eta > 0$ 是一个具有能量单位的微小展宽参数，并将格点 $r$ 上的局域态密度 (LDOS) 定义为 $n_r(E) = -\\frac{1}{\\pi} \\operatorname{Im} \\left[ G_{rr}(E) \\right]$。由空位引起的 LDOS 扰动为 $\\Delta n_r(E) = n_r^{\\text{vac}}(E) - n_r^{(0)}(E)$，其中 $n_r^{\\text{vac}}(E)$ 和 $n_r^{(0)}(E)$ 分别使用 $H = H_0 + V$ 和 $H_0$ 计算。\n\n问题任务：\n- 从二分蜂窝晶格和紧束缚形式理论的第一性原理出发，定性解释为何石墨烯中 A 子晶格上的单个空位会引入优先局域在 B 子晶格上、能量接近 $E = 0$ 的带隙中态。您的解释必须从二分晶格和手性（子晶格）对称性的定义属性开始，并且只能使用基本定律和经过充分检验的公式（例如紧束缚哈密顿量定义、格林函数和戴森方程），不得提供快捷的目标公式。\n- 设计一个算法，该算法在给定一个具有开放边界的有限 $(N_x, N_y)$ 晶胞蜂窝片层的情况下，构造 $H_0$（仅含最近邻），在中心 A 格点上通过一个大的在位势 $U$ 引入一个空位，为指定的能量和展宽计算 $G_0(E)$ 和 $G_{\\text{vac}}(E)$，并输出与空位相邻的 B 子晶格上最近邻格点 $r$ 处的 $\\Delta n_r(E)$。\n- 能量以电子伏特 (eV) 表示，LDOS 以反电子伏特 $\\text{eV}^{-1}$ 表示。角度单位不适用。所有数值输出必须是十进制浮点数。\n\n将该算法实现为一个完整的、可运行的、不接受任何输入的程序。使用一个有限的蜂窝片层，其参数为 $N_x = 8$，$N_y = 8$，跳跃能量 $t = 2.7$ eV，空位势 $U = 10^6 \\, t$。将空位放置在中心晶胞的 A 子晶格上，并报告同一晶胞内最近邻 B 格点处的 $\\Delta n_r(E)$。\n\n测试套件：\n- 情况 1（带隙中附近的正常路径）：$E = 0.00$ eV, $\\eta = 0.05$ eV。\n- 情况 2（带隙中附近，小展宽）：$E = 0.10$ eV, $\\eta = 0.01$ eV。\n- 情况 3（有限能量，中等展宽）：$E = 0.50$ eV, $\\eta = 0.02$ eV。\n- 情况 4（较高能量）：$E = 1.00$ eV, $\\eta = 0.05$ eV。\n- 情况 5（能带边缘之外，有展宽）：$E = 4.00$ eV, $\\eta = 0.10$ eV。\n- 情况 6（边界情况，极大展宽）：$E = 0.00$ eV, $\\eta = 0.50$ eV。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表内容为按上述测试用例顺序排列的结果。例如，如果六个结果是 $x_1, x_2, x_3, x_4, x_5, x_6$，则确切输出必须是“[x1,x2,x3,x4,x5,x6]”。\n- 每个 $x_k$ 是一个十进制浮点数，代表在指定的最近邻 B 格点上计算的相应测试用例的 $\\Delta n_r(E)$，单位为 $\\text{eV}^{-1}$。",
            "solution": "该问题提法明确，具有科学依据，并为唯一的计算解提供了所有必要的参数。其物理模型是石墨烯的标准最近邻紧束缚描述，而空位、格林函数和局域态密度 (LDOS) 等概念是凝聚态物理学的基石。因此，该问题是有效的。\n\n### 带隙中态的定性解释\n\n在产生一个空位后，出现一个局域在特定子晶格上的带隙中态，这是蜂窝晶格拓扑结构的直接结果。其解释基于二分晶格和手性对称性的概念。\n\n**二分晶格**是一种其格点可以被划分为两个不相交的集合或子晶格（A 和 B）的晶格，其中每个最近邻连接都将一个来自 A 子晶格的格点与一个来自 B 子晶格的格点相连。同一子晶格的格点之间没有连接。石墨烯的蜂窝晶格是二分晶格的一个典型例子。\n\n在指定的最近邻紧束缚模型中，哈密顿量由 $H_0 = -t \\sum_{\\langle i,j \\rangle} (c_i^\\dagger c_j + c_j^\\dagger c_i)$ 给出。如果我们对基态进行排序，使得 A 子晶格的所有 $N_A$ 个格点排在前面，然后是 B 子晶格的所有 $N_B$ 个格点，那么由于晶格的二分性质，哈密顿矩阵 $H_0$ 会呈现出一种特定的块状结构：\n$$\nH_0 = \\begin{pmatrix} 0  & H_{AB} \\\\ H_{BA}  & 0 \\end{pmatrix}\n$$\n在这里，对角块是零矩阵，因为没有子晶格内部的跳跃（如果 $i$ 和 $j$ 在同一个子晶格上，则 $t_{ii}=0$ 且 $t_{ij}=0$）。非对角块 $H_{AB}$ 包含连接 A 子晶格和 B 子晶格的跳跃项，并且 $H_{BA} = H_{AB}^\\dagger$。\n\n这种块状结构意味着一个被称为**手性（或子晶格）对称性**的基本属性。我们定义一个对角算符 $S$，它对于 A 子晶格上的格点取值为 $+1$，对于 B 子晶格上的格点取值为 $-1$。以矩阵形式表示，$S = \\text{diag}(I_{N_A}, -I_{N_B})$。将此算符应用于哈密顿量，得到：\n$$\nS H_0 S^{-1} = \\begin{pmatrix} I  & 0 \\\\ 0  & -I \\end{pmatrix} \\begin{pmatrix} 0  & H_{AB} \\\\ H_{BA}  & 0 \\end{pmatrix} \\begin{pmatrix} I  & 0 \\\\ 0  & -I \\end{pmatrix} = \\begin{pmatrix} 0  & -H_{AB} \\\\ -H_{BA}  & 0 \\end{pmatrix} = -H_0\n$$\n这种对称性 $S H_0 S^{-1} = -H_0$ 迫使能谱围绕 $E=0$ 对称。如果 $|\\psi\\rangle = (\\psi_A, \\psi_B)^T$ 是一个能量为 $E$ 的本征态，那么 $S|\\psi\\rangle = (\\psi_A, -\\psi_B)^T$ 就是一个能量为 $-E$ 的本征态。\n\n对于一个纯净的、无限或周期性的石墨烯片层，每个子晶格上的格点数是相等的，$N_A = N_B$。现在，考虑通过从 A 子晶格中移除一个格点来引入一个单空位。新系统在 A 子晶格上有 $N_A' = N_A - 1$ 个格点，在 B 子晶格上有 $N_B' = N_B$ 个格点。这造成了不平衡：$N_B' > N_A'$。\n\n带有空位的系统的哈密顿量 $H_{\\text{vac}}$ 保留了其二分特性，意味着它仍然是块非对角的。对于此类矩阵，一个重要的数学结果（指数定理的一个应用）指出，零能本征态的数量至少为 $|N_A' - N_B'|$。在我们的情况下，这保证了至少存在一个能量为 $E=0$ 的态：\n$$\n\\text{零能模式数量} \\ge |(N_A-1) - N_B| = |(N_A-1) - N_A| = 1\n$$\n让我们研究一下这个零能本征态 $|\\psi_0\\rangle = (\\psi_A, \\psi_B)^T$ 的结构。其本征值方程为 $H_{\\text{vac}} |\\psi_0\\rangle = 0$，写成块矩阵形式为：\n$$\n\\begin{pmatrix} 0  & H'_{AB} \\\\ H'_{BA}  & 0 \\end{pmatrix} \\begin{pmatrix} \\psi_A \\\\ \\psi_B \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n这产生两个耦合方程：\n1. $H'_{AB} \\psi_B = 0$：$H'_{AB}$ 是一个大小为 $N_A' \\times N_B'$ 的矩阵，即 $(N_A-1) \\times N_A$。这是一个“胖”矩阵，其列数多于行数，因此保证有一个非平凡的零空间。因此，$\\psi_B$ 存在非零解。\n2. $H'_{BA} \\psi_A = 0$：$H'_{BA}$ 是一个大小为 $N_B' \\times N_A'$ 的矩阵，即 $N_A \\times (N_A-1)$。这是一个“高”矩阵，其行数多于列数。对于一个一般的空位，该矩阵具有满列秩，意味着其零空间是平凡的。因此，唯一的解是 $\\psi_A = 0$。\n\n因此，零能本征态必须具有形式 $|\\psi_0\\rangle = (0, \\psi_B)^T$。这证明了该态的波函数完全局域在多数子晶格上，即 B 子晶格。这会在空位附近的 B 子晶格格点上的 LDOS 中产生一个尖锐的零能峰，这就是带隙中态。\n\n这个结果也可以用格林函数形式理论来理解。空位是在格点 $v \\in A$ 上的一个扰动 $V = U |v\\rangle \\langle v|$，其中 $U \\to \\infty$。当 T 矩阵 $T = V(1-G_0 V)^{-1}$ 发散时，会在相应的能量 $E$ 处出现一个新的束缚态。对于单位点势，此条件为 $1 - U G_{0,vv}(E) = 0$。在 $U \\to \\infty$ 的极限下，这简化为条件 $G_{0,vv}(E) = 0$。对于 $E=0$ 时的二分晶格，如果格点 $i$ 和 $j$ 属于同一子晶格，则纯净格林函数元 $G_{0,ij}(E=0)$ 为零。由于 $v$ 与自身在同一子晶格上，所以 $G_{0,vv}(E=0) = 0$。这证实了束缚态恰好在 $E=0$ 处形成。\n\n### 算法设计\n\n计算 LDOS 扰动的算法按以下步骤进行：\n\n1.  **晶格生成**：构建一个具有开放边界条件的有限蜂窝晶格片层。我们定义一个包含两个原子的晶胞，一个在 A 子晶格上，一个在 B 子晶格上。通过平铺 $N_x \\times N_y$ 个这样的晶胞来生成完整的晶格片层。我们使用原胞基矢 $\\mathbf{a}_1 = a(3/2, \\sqrt{3}/2)$ 和 $\\mathbf{a}_2 = a(3/2, -\\sqrt{3}/2)$，其中 $a$ 是有效键长，设置为 $1$。每个原子被分配一个从 $0$ 到 $2N_xN_y - 1$ 的唯一索引，并存储其坐标、子晶格类型和晶胞原点。\n\n2.  **纯净哈密顿量构建 ($H_0$)**：一个 $N \\times N$ 的矩阵（其中 $N=2N_xN_y$）被初始化为零。算法遍历所生成晶格中的所有原子对 $(i, j)$。对每一对原子，计算其欧几里得距离。如果距离与最近邻键长 ($a=1$) 匹配，则相应的矩阵元 $H_{0,ij}$ 和 $H_{0,ji}$ 被设置为 $-t$。$H_0$ 的所有对角元都为零。\n\n3.  **空位哈密顿量构建 ($H_{\\text{vac}}$)**：在中心晶胞的 A 格点上引入空位，该晶胞选为 $(\\lfloor N_x/2 \\rfloor, \\lfloor N_y/2 \\rfloor)$。确定该原子的索引 $v$。然后将空位哈密顿量构建为 $H_{\\text{vac}} = H_0 + V$，其中 $V$ 是一个只有一个非零元 $V_{vv} = U$ 的矩阵。在数值上，这是通过将大电势 $U$ 加到对角元 $H_{0,vv}$ 上来实现的。\n\n4.  **测量格点识别**：问题要求计算空位最近邻 B 格点上的 LDOS，该格点位于同一晶胞内。确定属于同一中心晶胞的 B 原子的索引 $r$。\n\n5.  **格林函数和 LDOS 计算**：对于每个测试用例 $(E, \\eta)$，定义复能量 $z = E + i\\eta$。\n    -   通过对矩阵 $(zI - H_0)$ 求逆来计算纯净格林函数矩阵：$G_0(z) = (zI - H_0)^{-1}$。\n    -   通过对 $(zI - H_{\\text{vac}})$ 求逆来计算空位格林函数矩阵：$G_{\\text{vac}}(z) = (zI - H_{\\text{vac}})^{-1}$。\n    -   从这些矩阵中提取测量格点索引 $r$ 处的对角元 $G_{0,rr}(z)$ 和 $G_{\\text{vac},rr}(z)$。\n    -   LDOS 扰动计算如下：$\\Delta n_r(E) = n_r^{\\text{vac}}(E) - n_r^{(0)}(E) = -\\frac{1}{\\pi} \\operatorname{Im}[G_{\\text{vac},rr}(z) - G_{0,rr}(z)]$。\n\n6.  **输出格式化**：收集所有测试用例计算出的 $\\Delta n_r(E)$ 值，并按要求以单个逗号分隔的字符串形式（用方括号括起）打印。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import inv\n\ndef solve():\n    \"\"\"\n    Constructs a tight-binding model for a graphene patch, introduces a vacancy,\n    and calculates the change in Local Density of States (LDOS) at a neighboring site.\n    \"\"\"\n    # Problem parameters\n    Nx = 8  # Number of unit cells in the x-direction\n    Ny = 8  # Number of unit cells in the y-direction\n    t = 2.7  # Hopping energy in eV\n    U_factor = 1e6  # Large potential factor for vacancy, U = U_factor * t\n    bond_length = 1.0  # Normalized C-C distance for geometry construction\n    \n    # Test cases from the problem statement\n    test_cases = [\n        # (E in eV, eta in eV)\n        (0.00, 0.05),\n        (0.10, 0.01),\n        (0.50, 0.02),\n        (1.00, 0.05),\n        (4.00, 0.10),\n        (0.00, 0.50),\n    ]\n\n    # --- 1. Lattice Generation ---\n    N_sites = 2 * Nx * Ny\n    a1 = np.array([1.5, np.sqrt(3)/2]) * bond_length\n    a2 = np.array([1.5, -np.sqrt(3)/2]) * bond_length\n    delta_B = np.array([1, 0]) * bond_length\n\n    atom_coords = np.zeros((N_sites, 2))\n    atom_info = []\n    \n    idx = 0\n    for iy in range(Ny):\n        for ix in range(Nx):\n            R = ix * a1 + iy * a2\n            \n            # Sublattice A site\n            pos_A = R\n            atom_coords[idx] = pos_A\n            atom_info.append({'idx': idx, 'sub': 'A', 'uc': (ix, iy)})\n            idx += 1\n            \n            # Sublattice B site\n            pos_B = R + delta_B\n            atom_coords[idx] = pos_B\n            atom_info.append({'idx': idx, 'sub': 'B', 'uc': (ix, iy)})\n            idx += 1\n\n    # --- 2. Pristine Hamiltonian Construction (H0) ---\n    H0 = np.zeros((N_sites, N_sites), dtype=float)\n    for i in range(N_sites):\n        for j in range(i + 1, N_sites):\n            # Calculate distance between atoms i and j\n            dist = np.linalg.norm(atom_coords[i] - atom_coords[j])\n            # If distance is a bond_length, it's a nearest neighbor\n            if np.isclose(dist, bond_length):\n                H0[i, j] = H0[j, i] = -t\n\n    # --- 3. Vacancy Location and Hamiltonian ---\n    # Find the central unit cell and the vacancy/measurement site indices\n    central_uc_x = Nx // 2\n    central_uc_y = Ny // 2\n    vacancy_idx = -1\n    measure_idx = -1\n\n    for info in atom_info:\n        if info['uc'] == (central_uc_x, central_uc_y):\n            if info['sub'] == 'A':\n                vacancy_idx = info['idx']\n            elif info['sub'] == 'B':\n                measure_idx = info['idx']\n    \n    if vacancy_idx == -1 or measure_idx == -1:\n        raise ValueError(\"Central sites not found.\")\n\n    # Construct the vacancy Hamiltonian\n    H_vac = H0.copy()\n    H_vac[vacancy_idx, vacancy_idx] += U_factor * t\n\n    # --- 4. Main Calculation Loop ---\n    results = []\n    Id = np.identity(N_sites, dtype=complex)\n    \n    for E, eta in test_cases:\n        z = E + 1j * eta\n        \n        # Calculate pristine and vacancy Green's functions\n        G0 = inv(z * Id - H0)\n        G_vac = inv(z * Id - H_vac)\n        \n        # Extract diagonal elements at measurement site 'r' (measure_idx)\n        G0_rr = G0[measure_idx, measure_idx]\n        Gvac_rr = G_vac[measure_idx, measure_idx]\n        \n        # Calculate the change in LDOS\n        # delta_n_r = n_vac - n_0 = (-1/pi * Im(G_vac)) - (-1/pi * Im(G_0))\n        delta_n_r = - (1 / np.pi) * (np.imag(Gvac_rr) - np.imag(G0_rr))\n        results.append(delta_n_r)\n\n    # --- 5. Final Output ---\n    # Format the results into the required string format\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}