## 引言
随着[半导体器件](@entry_id:192345)的尺寸不断缩小至纳米级别，量子力学效应，如量子约束和隧穿，开始主导其电学特性。传统的经典模型，如漂移-[扩散模型](@entry_id:142185)，已无法准确描述这些现象，这给先进工艺的开发和器件设计带来了巨大的挑战。为了弥补这一知识鸿沟，迫切需要一个能够系统性地涵盖从半经典修正到完整[量子输运](@entry_id:138932)理论的建模框架。

本文旨在提供这样一个全面的指南。读者将首先在 **“原理与机制”** 一章中，深入学习量子修正模型（如密度梯度法）的物理基础及其局限性，并掌握更为强大的[非平衡格林函数 (NEGF)](@entry_id:144813) 方法的核心概念，包括如何用其处理散射和非[平衡态](@entry_id:270364)。接下来，在 **“应用与跨学科联系”** 一章中，我们将通过分析谐振隧穿二[极管](@entry_id:909477)和隧穿场效应晶体管等前沿器件，展示这些理论在解决实际工程问题、连接材料科学与电子工程等领域中的强大威力。最后，通过 **“动手实践”** 部分提供的一系列计算练习，您将有机会亲手实现并巩固所学的理论知识，将抽象的公式转化为可量化的物理洞见。

## 原理与机制

在纳米尺度半导体器件中，载流子的行为越来越多地受到量子力学效应的支配。经典的漂移-[扩散模型](@entry_id:142185)依赖于局部电场和[载流子浓度梯度](@entry_id:197424)来描述电流，但当器件的特征尺寸与载流子的[德布罗意波长](@entry_id:139033)相当时，这些模型便失去了有效性。量子约束、隧穿和相干输运等现象成为主导，必须采用更严谨的理论框架来描述。本章将系统地阐述用于对这些量子效应进行建模的核心原理与机制，从对半经典模型的修正，到完整的[量子输运](@entry_id:138932)理论，再到实际数值计算中的关键技术。

### 从半经典模型到量子修正

在先进的工艺建模中，一个常见的策略是在成熟的漂移-扩散或流体动力学框架内引入量子修正项，以在保持计算效率的同时，部分地捕捉量子效应。这些修正旨在模拟量子约束如何改变载流子在空间的分布。

#### 密度梯度方法

密度梯度 (Density-Gradient, DG) 方法是一种流行的量子修正技术。其理论根源可以追溯到薛定谔方程的[流体动力](@entry_id:750449)学表述。考虑一个有效质量为 $m$ 的单粒子[波函数](@entry_id:201714) $\psi(\mathbf{r},t) = \sqrt{n(\mathbf{r},t)}\,e^{iS(\mathbf{r},t)/\hbar}$，其中 $n$ 是粒子密度，$S$ 是作用量。将其代入[含时薛定谔方程](@entry_id:137898)，分离实部和虚部，可以得到一个关于 $n$ 的[连续性方程](@entry_id:195013)和一个关于速度场 $\mathbf{v} = \nabla S / m$ 的量子[哈密顿-雅可比方程](@entry_id:145701)。在后者中，出现了一个额外的势能项，即**玻姆[量子势](@entry_id:193380) (Bohm quantum potential)** ：

$Q_{\mathrm{Bohm}}(\mathbf{r}) = -\frac{\hbar^2}{2m}\,\frac{\nabla^2\sqrt{n(\mathbf{r})}}{\sqrt{n(\mathbf{r})}}$

这个势来源于[波函数](@entry_id:201714)振幅的空间变化，它产生一种“量子压力”，能够将载流子推离势能急剧变化的区域，例如半导体与绝缘体之间的界面。这正是量子约束效应的体现：在[量子阱](@entry_id:144116)中，基态[波函数](@entry_id:201714)的[概率密度](@entry_id:175496)峰值并非紧贴着界面，而是在阱内某一位置。

在实际的[器件仿真](@entry_id:1123622)软件中，通常采用一个经过校准的、更广义的密度梯度势，其形式为：

$Q(\mathbf{r}) = -\gamma\,\frac{\hbar^2}{m}\,\frac{\nabla^2\sqrt{n(\mathbf{r})}}{\sqrt{n(\mathbf{r})}} = 2\gamma\,Q_{\mathrm{Bohm}}(\mathbf{r})$

这里的 $\gamma$ 是一个无量纲的校准参数。密度梯度模型是一种近似，为了保证其对特定工艺和器件结构的定量准确性，必须对 $\gamma$ 进行校准。最可靠的校准方法是将其与更精确的[量子输运](@entry_id:138932)模型（如[非平衡格林函数](@entry_id:144847)方法）的计算结果进行比对。通过调整 $\gamma$，使得密度梯度模型能够复现由 NEGF 计算出的约束子带能量和[载流子密度](@entry_id:143028)分布，包括隧穿效应引起的密度穿透等 。这个[量子势](@entry_id:193380) $Q(\mathbf{r})$ 作为一个额外的势能项，被加入到[输运方程](@entry_id:174281)中，并通过泊松方程与[静电势](@entry_id:188370)自洽地求解。因此，像不完全激活的掺杂物这类影响静电势的效应，会通过[自洽循环](@entry_id:138158)自然地影响载流子密度 $n(\mathbf{r})$，进而影响[量子势](@entry_id:193380)本身。

#### 有效势方法

另一种量子修正是**[有效势](@entry_id:1124192) (Effective Potential, EP)** 方法。其思想更为直观：量子力学中的粒子由于其波动性，感受到的不是一个点上的经典势能 $V(z)$，而是在其[波函数](@entry_id:201714)分布范围内的一个平均势。EP 方法通过将经典势能与一个具有特征平滑长度 $\ell$ 的[核函数](@entry_id:145324)进行卷积，来模拟这种空间平均效应 。

$V_{\mathrm{eff}}(z) = \int V(z') K(z-z'; \ell) dz'$

平滑长度 $\ell$ 是一个可调参数，其选择应旨在模仿被约束[波函数](@entry_id:201714)的空间展宽。通过使用这个平滑后的有效势 $V_{\mathrm{eff}}$ 来计算载流子的经典玻尔兹曼分布，就可以使得[载流子密度](@entry_id:143028)峰值同样地离开界面，从而模拟量子约束。

#### 量子修正模型的局限性

尽管 DG 和 EP 方法在捕捉主要的量子约束效应方面具有成本效益，但它们的局限性也非常明显。作为**局域模型 (local models)**，它们的修正仅仅依赖于某一点及其邻域的势或载流子密度信息。这导致了它们在面对某些物理情境时会失效：

1.  **强约束与界面穿透**：在极强的约束电场下（例如，在几纳米厚的栅氧化层下形成的[三角势阱](@entry_id:204284)），载流子[波函数](@entry_id:201714)的特征长度 $L_F=(\hbar^2/(2 m_z e F))^{1/3}$ 可能变得非常小。在一个中等场强的范围 (i) 内校准的模型，例如一个固定平滑长度 $\ell$ 的 EP 模型或一个固定 $\gamma$ 的 DG 模型，在强场范围 (ii) 下会因为长度尺度的不匹配而失效。此外，当势垒（如氧化层）很薄时，[波函数](@entry_id:201714)会穿透到势垒中，这会降低真实的子带能量。局域模型无法描述这种[穿透效应](@entry_id:1131571)，因为它们没有关于势垒另一侧的信息，这通常导致它们高估约束能量 。

2.  **多谷物理 (Multi-Valley Physics)**：在像硅这样的间接带隙半导体中，导带具有多个[能量简并](@entry_id:203091)的“谷”。例如，在 (100) [晶向](@entry_id:137393)的硅中，存在两个具有重有效质量 ($m_z=0.916\,m_0$) 的 $\Delta_2$ 谷和四个具有轻有效质量 ($m_z=0.19\,m_0$) 的 $\Delta_4$ 谷。子带能量与量子化方向的有效质量有关 ($E_n \propto m_z^{-1/3}$)，因此不同质量的谷会形成不同的[子带](@entry_id:154462)能级梯。标准的 DG 和 EP 模型通常基于总的载流子密度或单一的势，无法内在地分辨来自不同谷的贡献，因此除非进行专门的多谷扩展，否则它们无法准确预测子带的分裂和排序   。

3.  **非局域效应 (Non-local Effects)**：这些修正模型的根本局限在于其局域性。它们无法描述像**[共振隧穿](@entry_id:146897) (resonant tunneling)** 这样的非局域量子相干现象。当一个量子阱通过一个薄势垒与一个电子库耦合时，电子可以相干地穿过势垒。要正确描述这种输运过程，必须使用能够处理非局域相[干性](@entry_id:900268)的理论，而 DG 或 EP 模型在此完全无能为力 。

这些局限性指明了通向更完整[量子理论](@entry_id:145435)的必要性，即[非平衡格林函数](@entry_id:144847)方法。

### 高掺杂效应：能带变窄与施主激活

现代器件的源极、漏极和多晶硅栅等区域都经过了重度掺杂，其浓度可达 $10^{20}\,\mathrm{cm^{-3}}$ 或更高。如此高的掺杂水平会引入显著的物理效应，必须在建模中加以考虑。

#### 能带变窄

**能带变窄 (Bandgap Narrowing, BGN)** 是指在[重掺杂半导体](@entry_id:1125990)中，由于载流子之间的多体相互作用（如[交换能](@entry_id:137069)和关联能）以及掺杂原子[势场](@entry_id:143025)的无规起伏，导致有效[带隙](@entry_id:138445) $E_g$ 减小的现象。BGN 的一个直接后果是**[有效本征载流子浓度](@entry_id:1124181) ($n_{ie}$)** 的急剧增加。它们之间的关系为 $n_{ie}^2 \propto \exp(-E_g / k_B T)$。因此，[带隙](@entry_id:138445)的减小 $\Delta E_g$ 会导致 $n_{ie}$ 指数增加 ：

$\frac{n_{ie}}{n_{i0}} = \exp\left(\frac{\Delta E_g}{2k_B T}\right)$

在室温下 ($T=300\,\mathrm{K}$)，$\Delta E_g = 0.1\,\mathrm{eV}$ 的能带变窄就会使 $n_{ie}$ 增加约 7 倍。这对[少数载流子](@entry_id:272708)的浓度 ($n=n_{ie}^2/p$) 有着巨大的影响，是[精确模拟](@entry_id:749142)双极晶体管或 pn 结漏电等行为的关键。

BGN 的模型多种多样，从早期的经验模型（如 Slotboom 模型）到基于[多体微扰理论](@entry_id:168555)的物理模型（如 Schenk 模型）。这些模型给出的 BGN 大小及其对掺杂浓度的依赖关系有所不同，但对于 $10^{20}\,\mathrm{cm^{-3}}$ 量级的掺杂，预测的 $\Delta E_g$ 通常在 $0.08-0.12\,\mathrm{eV}$ 的范围内。一个重要的物理细节是，BGN 在导带和价带之间的分配是不对称的。在 n 型材料中，BGN 主要表现为导带边的下降；而在 p 型材料中，则主要表现为价带边的抬升。这种不对称性对于正确建模异质结或能带工程器件至关重要 。

#### 施主/受主激活

在[重掺杂](@entry_id:1125993)下，另一个重要问题是**掺杂物激活 (dopant activation)**。当掺杂浓度 $N_A$ (或 $N_D$) 超过价带 (或导带) 的[有效态密度](@entry_id:181717) $N_V$ (或 $N_C$) 时，半导体会进入**简并 (degenerate)** 状态。这意味着[费米能](@entry_id:143977)级进入了价带或导带。在这种情况下，即使在室温下，受主的能级也远高于[费米能](@entry_id:143977)级，导致其几乎完全电离。此外，高浓度的自由载流子会对掺杂离子势进行强烈的屏蔽，显著降低其束缚能，甚至形成与主能带合并的杂质带。这些效应共同作用，使得在简并掺杂的半导体中，激活率非常接近于 100% 。而在较低温度或非简并情况下，不完全激活则是一个必须考虑的重要因素。掺杂激活模型计算出电离的掺杂物浓度 ($N_D^+, N_A^-$)，这些浓度作为泊松方程中的[空间电荷](@entry_id:199907)源，直接影响整个器件的[静电势](@entry_id:188370)分布，从而影响所有与势相关的量子效应 。

### 量子输运：[非平衡格林函数](@entry_id:144847)方法

为了克服修正模型的局限性，并严谨地处理隧穿、散射和非[平衡态](@entry_id:270364)下的[量子输运](@entry_id:138932)，**[非平衡格林函数](@entry_id:144847) (Non-Equilibrium Green's Function, NEGF)** 形式主义应运而生。NEGF 是一个功能强大的理论框架，能够从第一性原理出发描述开放量子系统中的输运现象。

#### NEGF 核心概念：[格林函数](@entry_id:147802)与自能

NEGF 的核心是**格林函数 (Green's function)**，它描述了系统对一个微扰的响应。在能量域中，对于一个由哈密顿量 $H$ 描述的孤立器件，其[推迟格林函数](@entry_id:139183)为 $G_0^r(E) = [(E+i\eta)I - H]^{-1}$，其中 $\eta$ 是一个无穷小的正数，用于保证因果性。

当器件与外部环境（如源极和漏极接触，或与声子等散射源）相互作用时，这些相互作用通过一个名为**自能 (self-energy)** 的算符 $\Sigma(E)$ 来描述。[自能修正](@entry_id:754667)了[孤立系统](@entry_id:159201)的[哈密顿量](@entry_id:144286)，使得[开放系统](@entry_id:147845)的[推迟格林函数](@entry_id:139183)由**[戴森方程](@entry_id:146246) (Dyson equation)** 给出 ：

$G^r(E) = \left[E I - H - \Sigma^r(E)\right]^{-1}$

这里的 $\Sigma^r(E)$ 是总的推迟[自能](@entry_id:145608)，包含了来自所有接触和散射过程的贡献。[自能](@entry_id:145608)是一个非厄米的复数矩阵，其物理意义深远：
*   **实部 $\mathrm{Re}\,\Sigma^r(E)$**：描述了外部环境对系统能级的**能量移动 (energy shift)**。
*   **虚部 $\mathrm{Im}\,\Sigma^r(E)$**：描述了粒子逃逸到环境或被散射的速率，与系统[准束缚态](@entry_id:144141)的**寿命 (lifetime)** 或**展宽 (broadening)** 有关。对于无源的外部环境（如只[吸收粒子](@entry_id:754925)的接触），$\mathrm{Im}\,\Sigma^r(E)$ 必须是负半定的，确保了粒子数在器件内部不会凭空增加。

$G^r(E)$ 的极点（poles）对应于[开放系统](@entry_id:147845)的复数本征能量 $E_{\text{pole}} = E_0 - i\Gamma/2$。实部 $E_0$ 是[准束缚态](@entry_id:144141)的中心能量，而负的虚部 $-\Gamma/2$ 则决定了该状态由于隧穿到接触等原因而具有的有限寿命 $\tau = \hbar/\Gamma$ 。因果性要求，响应不能先于激发，这在数学上体现为 $G^r(E)$ 在复数能量平面的[上半平面](@entry_id:199119)是解析的（即没有极点）。

通过 $G^r(E)$ 和超前格林函数 $G^a(E)=[G^r(E)]^\dagger$，可以构建出**[谱函数](@entry_id:147628) (spectral function)** $A(E) = i[G^r(E) - G^a(E)] = G^r \Gamma G^a$，它描述了在能量 $E$ 处可用的量子态密度。这里的**展宽函数 (broadening function)** $\Gamma(E) = i[\Sigma^r(E) - \Sigma^a(E)] = -2\mathrm{Im}\,\Sigma^r(E)$，对于无源系统是正半定的 。

#### 描述散射：从微观理论到唯象模型

在 NEGF 中，散射过程同样通过[自能](@entry_id:145608)来描述。模型的复杂度和物理保真度可以有不同层次。

*   **微观模型 (Microscopic Models)**：对于[电子-声子相互作用](@entry_id:140708)，可以在一定的近似下（如**自洽[玻恩近似](@entry_id:138141) (Self-Consistent Born Approximation, SCBA)**）从量子场论出发推导出声子自能 $\Sigma^r_{ph}(E)$。这种方法原则上可以包含能量和动量转移的全部细节，从而能够描述弹性和[非弹性散射](@entry_id:138624)过程，并正确预测散射对[能谱](@entry_id:181780)和输运的影响 。

*   **[唯象模型](@entry_id:1129607) (Phenomenological Models)**：一个广泛使用的简化模型是**[比蒂克探针](@entry_id:1121969) (Büttiker probe)**。该模型通过在器件中引入一系列虚拟的、局域的“探针”接触来模拟散射。每个探针都由一个局域[自能](@entry_id:145608)描述，其耦合强度可以调节以匹配已知的动量[弛豫率](@entry_id:150136)。在标准的能量守恒探针模型中，探针只破坏电子的相位和动量，而不改变其能量，因此只能描述[弹性散射](@entry_id:152152)。这种模型在描述长通道中的[扩散输运](@entry_id:150792)时非常有效，并且在弹性、[线性响应](@entry_id:146180)极限下，其结果可以与从 SCBA 推导出的结果相匹配 。然而，由于其局域性和弹性假设，[比蒂克探针](@entry_id:1121969)无法描述非弹性过程（如焦耳热的产生）的微观细节，也无法捕捉动量选择性的非局域散射物理，这在模拟高场下的速度饱和等[非平衡现象](@entry_id:198484)时会导致偏差 。

#### 输运谱学：弹性与非弹性隧穿

NEGF 框架不仅能计算总电流，还能揭示电流的能量分辨谱，为**输运谱学 (transport spectroscopy)** 提供理论基础。在一个存在[准束缚态](@entry_id:144141)的隧穿结中，输运特性对能量和偏压的变化非常敏感。

*   **弹性[共振隧穿](@entry_id:146897)**：当源漏偏压窗口扫过[准束缚态](@entry_id:144141)能量 $E_0$ 时，透射谱 $T(E)$ 会出现一个尖锐的峰值，导致电流 $I(V)$ 上出现一个平台或峰，而[微分](@entry_id:158422)电导 $dI/dV$ 则呈现一个洛伦兹形状的峰。

*   **[非弹性电子隧穿谱](@entry_id:136290) (IETS)**：当隧穿电子与器件中的某个振动模式（如能量为 $\hbar\omega_{ph}$ 的声子）发生非弹性相互作用时，会打开新的输运通道。例如，一个能量为 $E$ 的电子可以隧穿并损失能量 $\hbar\omega_{ph}$ 来发射一个声子。这个新通道在偏压满足 $eV \ge \hbar\omega_{ph}$ 时开启。这个开启过程在 $I(V)$ 曲线上表现为一个微小的拐点，在 $dI/dV$ 曲线上表现为一个台阶，而在二阶[微分](@entry_id:158422)谱 $d^2I/dV^2$ 中则表现为一个清晰的对称峰，其位置正好对应于声子能量 $\hbar\omega_{ph}/e$。通过系统地分析 $d^2I/dV^2$ 谱随栅压和温度的变化，可以精确地提取出声子能量、[电子-声子耦合](@entry_id:139197)强度等关键物理参数，这是表征[纳米结构](@entry_id:148157)中相互作用的强大工具 。

### [有效质量近似](@entry_id:137643)的有效性与失效

NEGF 通常与**[有效质量近似](@entry_id:137643) (Effective Mass Approximation, EMA)** 结合使用，后者用一个平滑变化的[包络函数](@entry_id:749028)乘以一个快变的[布洛赫函数](@entry_id:189422)来描述电子态。EMA 极大地简化了计算，但它成立的前提是外部势能在原子尺度上是缓变的。当势能存在剧烈的短程变化时，EMA 可能会失效。

#### 界面粗糙度与[谷间散射](@entry_id:136281)

一个典型的例子是**界面粗糙度 (interface roughness)** 引起的**[谷间散射](@entry_id:136281) (intervalley scattering)**。在硅中，导带的几个谷位于布里渊区的不同位置，例如在 (001) 方向的输运中，谷心位于 $\pm k_0$。要将电子从一个谷散射到另一个谷，需要一个动量约为 $2k_0$ 的散射过程。由于 $k_0$ 接近布里渊区的边界，这是一个大动量散射。

界面粗糙度可以被看作一个无规的散射势。这个势的空间频率成分由其[自相关函数](@entry_id:138327)的傅里叶变换——功率谱密度 $S(\mathbf{q})$ 决定。如果粗糙度的相关长度 $\Lambda$ 较长（平滑的界面），其[功率谱](@entry_id:159996)主要集中在[小波](@entry_id:636492)矢 $\mathbf{q}$ 区域，$S(\mathbf{q})$ 在 $q \approx 2k_0$ 处会指数衰减。在这种情况下，[谷间散射](@entry_id:136281)非常弱，不同谷之间近似[解耦](@entry_id:160890)，EMA 是一个很好的近似。

然而，如果界面粗糙度具有非常短的[相关长度](@entry_id:143364) $\Lambda$（尖锐的界面），其功率谱在大的波矢 $q \approx 2k_0$ 处也会有显著的权重。这会导致强烈的谷间耦合，使得谷不再是独立的良[好量子数](@entry_id:262514)。此时，EMA 的基本假设被破坏，必须采用能够描述原子尺度细节和完整[能带结构](@entry_id:139379)的**原子尺度模型 (atomistic models)**，例如**紧束缚 (tight-binding)** 方法，来构建 NEGF 的[哈密顿量](@entry_id:144286)，才能正确地描述输运 。

### NEGF 的数值实现与挑战

将 NEGF 理论付诸实践是一项巨大的计算挑战，需要高效且稳健的数值算法。

#### 求解策略：[能量积分](@entry_id:166228)

计算电荷密度、电流等宏观量需要对含有格林函数的表达式在能量上进行积分。这些被积函数通常在很宽的能量范围内（几电子伏特）分布，并且在[准束缚态](@entry_id:144141)能量处呈现出宽度仅为几毫[电子伏特](@entry_id:144194)的极窄[共振峰](@entry_id:271281)。使用均匀的能量网格进行积分是极其低效和不准确的。

一种先进的策略是采用混合方法 。首先，将总的载流子注入谱（由小于[格林函数](@entry_id:147802) $G^$ 描述）分解为一个“平衡”[部分和](@entry_id:162077)一个“非平衡”部分。
1.  **平衡部分**：这个积分范围很广，但被积函数具有良好的数学性质（一个费米函[数乘](@entry_id:155971)以一个[谱函数](@entry_id:147628)）。可以利用[复变函数](@entry_id:175282)理论，将[实轴](@entry_id:148276)上的积分转换为复平面内的[围道积分](@entry_id:169446)。通过对费米函数进行有理分式（如 Padé）展开，积分可以高效地通过[留数定理](@entry_id:164878)计算，精确地捕捉到所有能级（包括[深能级](@entry_id:1123476)）的贡献，而无需在[实轴](@entry_id:148276)上进行密集采样。
2.  **非平衡部分**：这个积分的被积函数只在源漏化学势之间的“偏压窗口”内不为零。这是一个有限的、通常较窄的能量区间。对于这个积分，可以使用自适应的[实轴](@entry_id:148276)积分方法（如 Gauss-Kronrod 算法），该方法能够自动在共振峰等函数剧烈变化的区域增加采样点，以最小的计算代价达到预设的精度要求。

这种[混合策略](@entry_id:145261)充分利用了问题的物理和数学结构，是目前解决此类问题最高效、最稳健的方法之一。

#### 求解策略：[矩阵求逆](@entry_id:636005)

NEGF 计算的核心瓶颈是求解定义了 $G^r(E)$ 的大型稀疏线性方程组 $A(E) G^r(E) = I$，其中 $A(E) = (E+i\eta)I - H - \Sigma^r(E)$。在[共振能量](@entry_id:147349)附近，由于小的物理展宽和数值正则化项 $\eta$，矩阵 $A(E)$ 可能是严重**病态 (ill-conditioned)** 的，给数值求解带来了巨大挑战 。

对于大规模问题（矩阵维度 $N \gg 10^6$），主要有两类求解策略：
1.  **[迭代法](@entry_id:194857) (Iterative Methods)**：例如**[广义最小残差法](@entry_id:139566) (GMRES)**，是求解非厄米[线性系统](@entry_id:147850)的标准方法。然而，对于[病态矩阵](@entry_id:147408)，其收敛性严重依赖于一个高质量的**[预条件子](@entry_id:753679) (preconditioner)**。构造一个既能有效加速收敛又能保持[稀疏性](@entry_id:136793)的[预条件子](@entry_id:753679)（如带阈值和部分主元选择的**不完全 LU 分解 (ILU)**）是关键所在 。
2.  **直接法 (Direct Methods)**：对于具有准一维几何结构的器件（可以被切分成一系列“薄片”），**递归[格林函数](@entry_id:147802) (Recursive Green's Function, RGF)** 方法是一种极其高效的[直接求解器](@entry_id:152789)。它利用[哈密顿量](@entry_id:144286)的块三对角结构，通过递归计算向前和向后传播的[格林函数](@entry_id:147802)。RGF 在计算上等效于一种特殊的块 LU 分解，其计算成本与器件长度成线性关系，远优于标准直接法的 $N^3$ 关系。早期的 RGF 算法存在数值不稳定性，但现代的稳定化 RGF 算法（类似于在块级别上进行主元选择）已经克服了这个问题 。

#### [并行计算](@entry_id:139241)策略

NEGF 模拟的巨大计算量使其必须在高性能计算平台上并行执行。幸运的是，在许多情况下（如弹道输运或可分离散射），对不同能量 $E$ 和横向波矢 $k$ 的计算是相互独立的。这提供了大规模的“**尴尬并行 (embarrassingly parallel)**”机会 。

将这些独立的 $(E, k)$ 任务分配给多核 CPU 的不同核心或 GPU 的大量[流处理](@entry_id:1132503)器是主要的[并行化策略](@entry_id:753105)。性能分析需要考虑：
*   **阿姆达尔定律 (Amdahl's Law)**：它指出，总的加速比受限于程序中无法并行的串行部分。即使 NEGF 的输运计算部分有 99% 的并行度，在 32 个核心上的加速比也只能达到约 24.4，而不是理想的 32 。
*   **[屋顶线模型](@entry_id:163589) (Roofline Model)**：它通过比较计算任务的**[算术强度](@entry_id:746514) (Arithmetic Intensity, AI)**（即每字节内存访问所执行的[浮点运算次数](@entry_id:749457)）与硬件的计算/带宽比，来判断性能瓶颈是计算能力还是[内存带宽](@entry_id:751847)。对于 RGF 算法，其[算术强度](@entry_id:746514)与块尺寸 $m$ 成正比。对于足够大的 $m$，NEGF 计算通常是**计算密集型 (compute-bound)** 的，这意味着其性能受限于处理器的浮点运算峰值，而不是[内存带宽](@entry_id:751847) 。

通过将大量独立的 $(E,k)$ 任务“批处理”到 GPU 上，可以有效地隐藏内核启动开销，并充分利用其强大的并行计算能力，在计算密集型区域实现显著的性能加速。