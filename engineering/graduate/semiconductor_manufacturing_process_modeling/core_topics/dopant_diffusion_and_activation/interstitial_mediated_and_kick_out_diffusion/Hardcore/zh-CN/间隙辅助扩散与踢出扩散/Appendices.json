{
    "hands_on_practices": [
        {
            "introduction": "扩散是一个由热能驱动的过程，其温度依赖性通常由阿伦尼乌斯方程描述。本练习旨在连接抽象的理论模型与具体的实验数据，指导您如何从给定的扩散数据中提取关键的物理参数——活化能（$E_a$）和指前因子（$D_0$）。掌握这项从实验数据中提取模型参数的技能，是进行任何深入的工艺建模与仿真的基础。",
            "id": "4133522",
            "problem": "在等温退火过程中，研究了一种已知通过间隙原子辅助的“踢出”机制在本征条件下（过剩载流子可忽略不计，自间隙原子浓度处于平衡状态）在硅（Si）中扩散的掺杂剂。通过菲克第一定律分析展宽的结分布，以提取有效扩散系数 $D_{\\mathrm{eff}}(T)$，该系数由通量密度关系 $J = - D_{\\mathrm{eff}}(T) \\, \\partial C / \\partial x$ 定义。对于晶体中的热激活跃迁过程，跃迁频率和缺陷可用性受过渡态理论和缺陷形成的质量作用定律控制，因此 $D_{\\mathrm{eff}}(T)$ 的温度依赖性可以简化为一个温度弱相关的指前因子与一个由自由能垒控制的指数因子的乘积。从这些基本原理出发，论证为何对于单一主导的间隙原子辅助机制，$\\ln D_{\\mathrm{eff}}$ 对 $1/T$ 的阿伦尼乌斯图应为线性，并用激活能 $E_a$ 和指前因子 $D_0$ 解释该直线的斜率和截距的物理意义。\n\n测得的阿伦尼乌斯图给出以下数据对 $\\left(1/T, \\ln D_{\\mathrm{eff}}\\right)$：\n- $\\left(\\frac{1}{1500} \\, \\mathrm{K}^{-1}, \\, -27.870639470992604\\right)$\n- $\\left(\\frac{1}{1400} \\, \\mathrm{K}^{-1}, \\, -29.77540137575451\\right)$\n- $\\left(\\frac{1}{1300} \\, \\mathrm{K}^{-1}, \\, -31.973203573556704\\right)$\n- $\\left(\\frac{1}{1200} \\, \\mathrm{K}^{-1}, \\, -34.53730613765927\\right)$\n\n利用这些数据和玻尔兹曼常数 $k_B = 8.617333262145 \\times 10^{-5} \\, \\mathrm{eV/K}$，通过确定给定数据点的最佳拟合直线的斜率和截距，估算激活能 $E_a$（单位为电子伏特）和指前因子 $D_0$（单位为 $\\mathrm{cm^2/s}$）。假设在此温度范围内单一机制占主导地位，并忽略 $D_0$ 中除对数弱变化外的任何温度依赖性。\n\n将 $E_a$ 和 $D_0$ 的值均四舍五入至四位有效数字。$E_a$ 以 $\\mathrm{eV}$ 表示，$D_0$ 以 $\\mathrm{cm^2/s}$ 表示。",
            "solution": "首先验证问题，以确保其科学上合理、提法明确且客观。\n\n### 步骤1：提取给定条件\n- **系统**：一种掺杂剂在本征条件下通过间隙原子辅助的“踢出”机制在硅（Si）中扩散。\n- **过程**：等温退火。\n- **控制定律**：菲克第一定律，$J = - D_{\\mathrm{eff}}(T) \\, \\partial C / \\partial x$。\n- **$D_{\\mathrm{eff}}(T)$的模型**：一个由阿伦尼乌斯关系描述的热激活过程，$D_{\\mathrm{eff}}(T) = D_0 \\exp(-E_a / (k_B T))$。\n- **数据点**：$\\ln D_{\\mathrm{eff}}$ 对 $1/T$ 的阿伦尼乌斯图给出以下数据对 $(x, y) = (1/T, \\ln D_{\\mathrm{eff}})$：\n  - $(\\frac{1}{1500} \\, \\mathrm{K}^{-1}, \\, -27.870639470992604)$\n  - $(\\frac{1}{1400} \\, \\mathrm{K}^{-1}, \\, -29.77540137575451)$\n  - $(\\frac{1}{1300} \\, \\mathrm{K}^{-1}, \\, -31.973203573556704)$\n  - $(\\frac{1}{1200} \\, \\mathrm{K}^{-1}, \\, -34.53730613765927)$\n- **常数**：玻尔兹曼常数，$k_B = 8.617333262145 \\times 10^{-5} \\, \\mathrm{eV/K}$。\n- **假设**：单一扩散机制占主导地位，并且指前因子 $D_0$ 的温度依赖性可以忽略。\n- **任务**：\n  1. 论证为何 $\\ln D_{\\mathrm{eff}}$ 对 $1/T$ 的阿伦尼乌斯图是线性的。\n  2. 解释斜率和截距的物理意义。\n  3. 根据数据估算激活能 $E_a$（单位 $\\mathrm{eV}$）和指前因子 $D_0$（单位 $\\mathrm{cm^2/s}$）。\n  4. 将 $E_a$ 和 $D_0$ 的最终值四舍五入至四位有效数字。\n\n### 步骤2：使用提取的给定条件进行验证\n该问题科学上基于固态物理和半导体工艺建模的原理。间隙原子辅助的“踢出”机制是用于描述某些掺杂剂（如Au、Pt、Zn，以及在一定程度上的B和P）在硅中扩散的成熟模型。使用阿伦尼乌斯方程来模拟扩散系数的温度依赖性，是热激活过程的一个标准和基本概念。该问题提法明确，提供了足够的数据和清晰的目标，即从线性拟合中确定物理参数。语言客观而精确。数据虽然数值具体，但与其应代表的线性关系一致。因此，该问题是有效的。\n\n### 步骤3：结论与行动\n该问题有效。将提供完整解答。\n\n### 解答推导\n\n**第一部分：阿伦尼乌斯图的理论论证**\n\n晶体中的扩散是一个热激活过程，意味着原子或掺杂剂通过克服能垒从一个晶格位置移动到另一个位置，其所需能量由热振动提供。对于由缺陷（本例中为自间隙原子，记作 $I$）介导的过程，其有效扩散系数 $D_{\\mathrm{eff}}$ 取决于两个主要因素：原子成功跃迁的频率和介导缺陷的浓度。\n\n1.  **自间隙原子的浓度**：自间隙原子的形成是一个热激活过程。在平衡和本征条件下，自间隙原子的浓度 $C_I^{\\mathrm{eq}}$ 遵循质量作用定律，其温度依赖性由下式给出：\n    $$C_I^{\\mathrm{eq}}(T) = C_0 \\exp\\left(-\\frac{E_f^I}{k_B T}\\right)$$\n    其中 $E_f^I$ 是自间隙原子的形成能，$k_B$ 是玻尔兹曼常数，$T$ 是绝对温度，$C_0$ 是一个与可用位置密度和形成熵相关的前置因子。\n\n2.  **跃迁频率**：要使掺杂剂原子移动，它必须克服一个迁移能垒 $E_m$。在存在介导间隙原子的情况下，掺杂剂原子成功跃迁的频率 $\\nu$ 与克服该能垒的概率成正比：\n    $$\\nu(T) \\propto \\exp\\left(-\\frac{E_m}{k_B T}\\right)$$\n\n3.  **有效扩散系数**：对于间隙原子介导的机制，有效扩散系数与介导缺陷浓度和跃迁频率的乘积成正比。因此，$D_{\\mathrm{eff}}(T)$ 可以表示为：\n    $$D_{\\mathrm{eff}}(T) \\propto C_I^{\\mathrm{eq}}(T) \\times \\nu(T)$$\n    代入与温度相关的部分，我们得到：\n    $$D_{\\mathrm{eff}}(T) \\propto \\exp\\left(-\\frac{E_f^I}{k_B T}\\right) \\exp\\left(-\\frac{E_m}{k_B T}\\right) = \\exp\\left(-\\frac{E_f^I + E_m}{k_B T}\\right)$$\n    通过将所有与温度无关的比例常数合并为一个单一的指前因子 $D_0$，我们得到了标准的阿伦尼乌斯方程：\n    $$D_{\\mathrm{eff}}(T) = D_0 \\exp\\left(-\\frac{E_a}{k_B T}\\right)$$\n    在这里，总激活能为 $E_a = E_f^I + E_m$，代表形成介导缺陷所需的能量与掺杂剂在其辅助下迁移所需能量的总和。\n\n对阿伦尼乌斯方程取自然对数，得到：\n$$\\ln(D_{\\mathrm{eff}}(T)) = \\ln\\left(D_0 \\exp\\left(-\\frac{E_a}{k_B T}\\right)\\right)$$\n$$\\ln(D_{\\mathrm{eff}}) = \\ln(D_0) + \\ln\\left(\\exp\\left(-\\frac{E_a}{k_B T}\\right)\\right)$$\n$$\\ln(D_{\\mathrm{eff}}) = \\ln(D_0) - \\frac{E_a}{k_B T}$$\n这个方程可以改写成直线方程 $y = mx + c$ 的形式：\n$$\\ln(D_{\\mathrm{eff}}) = \\left(-\\frac{E_a}{k_B}\\right) \\left(\\frac{1}{T}\\right) + \\ln(D_0)$$\n这证实了对于单一主导的扩散机制，$y = \\ln(D_{\\mathrm{eff}})$ 对 $x = 1/T$ 的图（即阿伦尼乌斯图）应为线性。\n\n**斜率和截距的物理意义**：\n-   **斜率 ($m$)**：直线的斜率为 $m = -E_a / k_B$。它与总激活能 $E_a$ 的负值成正比。这个激活能是扩散事件发生必须克服的最小能垒。更陡峭的斜率对应于更高的激活能，从而表明扩散系数具有更强的温度依赖性。\n-   **截距 ($c$)**：直线的y轴截距为 $c = \\ln(D_0)$。它是指前因子 $D_0$ 的自然对数。因子 $D_0$ 代表无限温度下的理论扩散系数，并包含了原子振动频率（尝试频率）、跃迁距离、晶格的几何因子以及扩散熵等物理参数。\n\n**第二部分：根据数据进行参数估计**\n\n我们有四个数据点 $(x_i, y_i)$，其中 $x_i = 1/T_i$ 且 $y_i = \\ln(D_{\\mathrm{eff},i})$。我们可以确定通过这些点的最佳拟合直线的斜率 $m$ 和截距 $c$。由于问题暗示数据点位于一条完美的直线上，我们可以使用任意两点来计算斜率。为了获得最大的范围和精度，我们使用第一个和最后一个点。\n\n设点1为 $(x_1, y_1) = (\\frac{1}{1500}, -27.870639470992604)$，点4为 $(x_4, y_4) = (\\frac{1}{1200}, -34.53730613765927)$。\n\n斜率 $m$ 为：\n$$m = \\frac{y_4 - y_1}{x_4 - x_1} = \\frac{-34.53730613765927 - (-27.870639470992604)}{\\frac{1}{1200} \\, \\mathrm{K}^{-1} - \\frac{1}{1500} \\, \\mathrm{K}^{-1}}$$\n$$m = \\frac{-6.666666666666666}{\\frac{1500 - 1200}{1200 \\times 1500} \\, \\mathrm{K}^{-1}} = \\frac{-6.666666666666666}{\\frac{300}{1800000} \\, \\mathrm{K}^{-1}} = \\frac{-20/3}{1/6000 \\, \\mathrm{K}^{-1}}$$\n$$m = -\\frac{20}{3} \\times 6000 \\, \\mathrm{K} = -40000 \\, \\mathrm{K}$$\n斜率恰好是 $m = -40000 \\, \\mathrm{K}$。\n\n现在我们可以求出激活能 $E_a$：\n$$m = -\\frac{E_a}{k_B} \\implies E_a = -m k_B$$\n使用给定的值 $k_B = 8.617333262145 \\times 10^{-5} \\, \\mathrm{eV/K}$：\n$$E_a = -(-40000 \\, \\mathrm{K}) \\times (8.617333262145 \\times 10^{-5} \\, \\mathrm{eV/K})$$\n$$E_a = 4 \\times 10^4 \\times 8.617333262145 \\times 10^{-5} \\, \\mathrm{eV}$$\n$$E_a = 3.446933304858 \\, \\mathrm{eV}$$\n四舍五入至四位有效数字，我们得到 $E_a = 3.447 \\, \\mathrm{eV}$。\n\n接下来，我们使用方程 $y = mx + c$（或 $c = y - mx$）来求截距 $c = \\ln(D_0)$。使用点1：\n$$c = y_1 - m x_1 = -27.870639470992604 - (-40000 \\, \\mathrm{K}) \\times \\left(\\frac{1}{1500} \\, \\mathrm{K}^{-1}\\right)$$\n$$c = -27.870639470992604 + \\frac{40000}{1500} = -27.870639470992604 + \\frac{80}{3}$$\n$$c = -27.870639470992604 + 26.666666666666668 = -1.203972804325936$$\n这个值是 $0.3$ 的自然对数：$\\ln(0.3) \\approx -1.203972804$。\n因此，$c = \\ln(0.3)$。\n\n现在我们可以求出指前因子 $D_0$：\n$$c = \\ln(D_0) \\implies D_0 = \\exp(c)$$\n$$D_0 = \\exp(\\ln(0.3)) = 0.3$$\n问题要求 $D_0$ 的单位是 $\\mathrm{cm^2/s}$。假设所提供的数据与这些单位一致，则 $D_0 = 0.3 \\, \\mathrm{cm^2/s}$。\n四舍五入至四位有效数字，我们得到 $D_0 = 0.3000 \\, \\mathrm{cm^2/s}$。\n\n估算出的参数为激活能 $E_a \\approx 3.447 \\, \\mathrm{eV}$ 和指前因子 $D_0 = 0.3000 \\, \\mathrm{cm^2/s}$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n3.447  0.3000\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "在确定了基本的扩散参数之后，下一步是建立能够预测掺杂分布如何随时间演变的动态模型。本练习将引导您基于间隙原子介导的踢出机制，为特定的工艺条件（间隙原子注入）下的掺杂分布展宽推导出解析表达式。通过这个推导过程，您将学习如何将复杂的物理现象（如踢出反应和间隙原子注入）转化为精确的数学预测框架，这是工艺建模的核心技能。",
            "id": "4133469",
            "problem": "考虑恒定温度下的一维硅，其初始替位硼浓度分布为高斯分布，$C_{B}(x,0)=C_{0}\\exp\\!\\big(-x^{2}/(2\\sigma_{0}^{2})\\big)$，其中 $x\\in\\mathbb{R}$。硼通过间隙原子介导的挤出机制进行扩散，其模型可由反应 $B_{s}+I\\rightleftharpoons BI$ 描述，其中 $B_{s}$ 表示替位硼，$I$ 表示硅自间隙原子，$BI$ 表示可移动的硼-间隙原子对。设正向反应速率常数为 $k_{f}$，逆向反应速率常数为 $k_{r}$，可移动对的扩散系数为 $D_{BI}$。假设如下：\n- 与硼分布演化的时间尺度相比，原子对的形成和离解速度很快，因此原子对的浓度可以在平衡点附近进行线性化。\n- 在 $t=0^{+}$ 时刻阶跃式注入间隙原子后的短时间内，间隙原子浓度在空间上是均匀的，并且其均匀的过饱和度 $S_{I}(t)$ 满足速率方程 $\\mathrm{d}S_{I}/\\mathrm{d}t=(S_{\\mathrm{inj}}-S_{I})/\\tau_{I}$，且 $S_{I}(0)=1$，其中 $S_{\\mathrm{inj}}0$ 是设定的过饱和度目标值，$\\tau_{I}0$ 是由复合决定的有效间隙原子寿命。\n- 平衡间隙原子浓度为 $C_{I}^{\\mathrm{eq}}$，并且空间边界项足够快地趋于零，使得所有矩积分收敛。\n\n从可移动对的质量守恒和菲克输运出发，并围绕平衡点对反应进行线性化，以 $C_{B}$ 和均匀的 $C_{I}(t)=S_{I}(t)C_{I}^{\\mathrm{eq}}$ 消去原子对浓度，推导硼分布短期展宽的解析表达式，该展宽由方差 $\\sigma^{2}(t)$ 量化，其定义为 $\\sigma^{2}(t)=\\big(\\int_{-\\infty}^{\\infty}x^{2}C_{B}(x,t)\\,\\mathrm{d}x\\big)\\big/\\big(\\int_{-\\infty}^{\\infty}C_{B}(x,t)\\,\\mathrm{d}x\\big)$。将你的最终答案表示为 $\\sigma^{2}(t)$ 关于 $D_{BI}$、$k_{f}$、$k_{r}$、$C_{I}^{\\mathrm{eq}}$、$S_{\\mathrm{inj}}$、$\\tau_{I}$ 和 $\\sigma_{0}$ 的封闭形式解析表达式。最终表达式无需数值近似，也无需报告单位。",
            "solution": "用户希望在间隙原子介导的扩散条件下，求解硼浓度分布方差 $\\sigma^2(t)$ 的解析表达式。\n\n### 第一步：问题验证\n\n**1. 提取已知条件**\n-   初始硼分布：$C_{B}(x,0) = C_{0}\\exp(-x^{2}/(2\\sigma_{0}^{2}))$，其中 $x\\in\\mathbb{R}$。\n-   扩散机制：挤出反应 $B_{s}+I\\rightleftharpoons BI$。\n-   反应动力学：正向速率常数 $k_f$，逆向速率常数 $k_r$。\n-   可移动物质的扩散系数：$BI$ 对的扩散系数为 $D_{BI}$。\n-   假设1：原子对形成/离解速度快，允许在平衡点附近进行线性化。\n-   假设2：间隙原子浓度 $C_I$ 在空间上是均匀的。其过饱和度 $S_I(t) = C_I(t)/C_I^{\\mathrm{eq}}$ 遵循速率方程 $\\mathrm{d}S_{I}/\\mathrm{d}t=(S_{\\mathrm{inj}}-S_{I})/\\tau_{I}$，且 $S_I(0)=1$。\n-   常数：$S_{\\mathrm{inj}}0$，$\\tau_I0$，平衡间隙原子浓度 $C_I^{\\mathrm{eq}}$。\n-   边界条件：空间边界项消失，确保矩积分收敛。\n-   待求量：方差 $\\sigma^{2}(t) = (\\int_{-\\infty}^{\\infty}x^{2}C_{B}(x,t)\\,\\mathrm{d}x) / (\\int_{-\\infty}^{\\infty}C_{B}(x,t)\\,\\mathrm{d}x)$。\n\n**2. 使用提取的已知条件进行验证**\n-   **科学上合理：** 该问题描述了挤出机制，这是一个用于解释硅中硼等掺杂剂扩散的标准且成熟的模型。控制方程（反应动力学、菲克扩散、间隙原子过饱和度速率方程）是输运现象和半导体工艺建模的基础。快速反应动力学和均匀间隙原子浓度的假设是针对特定工艺条件（例如，短时退火、薄层）的常见且有效的近似。\n-   **定义良好：** 该问题提供了一套完整的信息：一个初始条件、控制物理定律以及简化假设。它要求一个特定的、明确定义的量（$\\sigma^2(t)$）。所述的积分收敛性确保了矩和方差在数学上是定义良好的。\n-   **客观性：** 该问题以精确、定量且无偏见的科学语言表述。\n\n**3. 结论与行动**\n该问题在科学上合理、定义良好、客观且内部一致。这是一个半导体物理和建模领域的有效问题。我将继续进行求解。\n\n### 第二步：求解推导\n\n设 $C_B(x,t)$ 为替位硼 ($B_s$) 的浓度，$C_{BI}(x,t)$ 为可移动的硼-间隙原子对 ($BI$) 的浓度。这两种物质的控制守恒方程为：\n$$\n\\frac{\\partial C_B}{\\partial t} = -k_f C_B C_I + k_r C_{BI} \\quad (1)\n$$\n$$\n\\frac{\\partial C_{BI}}{\\partial t} = D_{BI} \\frac{\\partial^2 C_{BI}}{\\partial x^2} + k_f C_B C_I - k_r C_{BI} \\quad (2)\n$$\n间隙原子浓度 $C_I$ 仅是时间的函数，$C_I(t)$。\n\n总硼浓度为 $C_{tot}(x,t) = C_B(x,t) + C_{BI}(x,t)$。将方程 $(1)$ 和 $(2)$ 相加，得到总硼浓度的守恒定律：\n$$\n\\frac{\\partial C_{tot}}{\\partial t} = \\frac{\\partial (C_B + C_{BI})}{\\partial t} = D_{BI} \\frac{\\partial^2 C_{BI}}{\\partial x^2} \\quad (3)\n$$\n原子对形成和离解速度快的假设意味着反应 $B_{s}+I\\rightleftharpoons BI$ 处于局部平衡状态。这意味着净反应速率近似为零：\n$$\nk_f C_B C_I - k_r C_{BI} \\approx 0 \\implies C_{BI}(x,t) \\approx \\frac{k_f}{k_r} C_B(x,t) C_I(t) \\quad (4)\n$$\n我们可以用总浓度 $C_{tot}$ 来表示 $C_B$ 和 $C_{BI}$：\n$$\nC_{tot} = C_B + C_{BI} = C_B + \\frac{k_f}{k_r} C_B C_I = C_B \\left(1 + \\frac{k_f}{k_r} C_I(t)\\right)\n$$\n由此，我们得到：\n$$\nC_B(x,t) = \\frac{C_{tot}(x,t)}{1 + \\frac{k_f}{k_r} C_I(t)} \\quad (5)\n$$\n$$\nC_{BI}(x,t) = C_{tot}(x,t) - C_B(x,t) = C_{tot}(x,t) \\frac{\\frac{k_f}{k_r} C_I(t)}{1 + \\frac{k_f}{k_r} C_I(t)} \\quad (6)\n$$\n将方程 $(6)$ 代入总硼守恒方程 $(3)$。由于 $C_I(t)$ 在空间上是均匀的，含时因子可以移到空间导数算子 $\\frac{\\partial^2}{\\partial x^2}$ 的外面。\n$$\n\\frac{\\partial C_{tot}}{\\partial t} = D_{BI} \\frac{\\partial^2}{\\partial x^2} \\left[ C_{tot} \\frac{\\frac{k_f}{k_r} C_I(t)}{1 + \\frac{k_f}{k_r} C_I(t)} \\right] = \\left[ D_{BI} \\frac{\\frac{k_f}{k_r} C_I(t)}{1 + \\frac{k_f}{k_r} C_I(t)} \\right] \\frac{\\partial^2 C_{tot}}{\\partial x^2}\n$$\n这是一个针对 $C_{tot}$ 的菲克扩散方程，其有效扩散系数 $D'_{eff}(t)$ 随时间变化：\n$$\n\\frac{\\partial C_{tot}}{\\partial t} = D'_{eff}(t) \\frac{\\partial^2 C_{tot}}{\\partial x^2}, \\quad \\text{其中 } D'_{eff}(t) = D_{BI} \\frac{\\frac{k_f}{k_r} C_I(t)}{1 + \\frac{k_f}{k_r} C_I(t)}\n$$\n问题陈述指明“原子对的浓度可以在平衡点附近进行线性化”。这意味着可移动原子对的浓度远小于替位浓度，这对于硅中的硼是物理上现实的。这对应于条件 $\\frac{k_f}{k_r} C_I(t) \\ll 1$。针对这个小参数对 $D'_{eff}(t)$ 的表达式进行线性化，得到：\n$$\nD'_{eff}(t) \\approx D_{BI} \\left(\\frac{k_f}{k_r} C_I(t)\\right) \\equiv D_{eff}(t)\n$$\n$C_{tot}$ 的扩散方程简化为：\n$$\n\\frac{\\partial C_{tot}}{\\partial t} = D_{eff}(t) \\frac{\\partial^2 C_{tot}}{\\partial x^2} \\quad (7)\n$$\n待求量是 $C_B(x,t)$ 的方差。使用方程 $(5)$，我们看到 $C_B$ 的方差与 $C_{tot}$ 的方差相同：\n$$\n\\sigma^2(t) = \\frac{\\int_{-\\infty}^{\\infty}x^{2}C_{B}(x,t)\\,\\mathrm{d}x}{\\int_{-\\infty}^{\\infty}C_{B}(x,t)\\,\\mathrm{d}x} = \\frac{\\int_{-\\infty}^{\\infty}x^{2}\\frac{C_{tot}(x,t)}{1 + \\frac{k_f}{k_r} C_I(t)}\\,\\mathrm{d}x}{\\int_{-\\infty}^{\\infty}\\frac{C_{tot}(x,t)}{1 + \\frac{k_f}{k_r} C_I(t)}\\,\\mathrm{d}x} = \\frac{\\int_{-\\infty}^{\\infty}x^{2}C_{tot}(x,t)\\,\\mathrm{d}x}{\\int_{-\\infty}^{\\infty}C_{tot}(x,t)\\,\\mathrm{d}x} = \\sigma_{tot}^2(t)\n$$\n我们使用矩量法对方程 $(7)$ 求解 $\\sigma_{tot}^2(t)$ 的演化。一维扩散方程的方差变化率由 $\\frac{d\\sigma_{tot}^2}{dt} = 2D_{eff}(t)$ 给出。将其从 $t=0$ 积分到 $t$ 得：\n$$\n\\sigma^2(t) - \\sigma^2(0) = 2 \\int_0^t D_{eff}(t') dt'\n$$\n初始方差 $\\sigma^2(0)$ 由初始分布参数 $\\sigma_0^2$ 给出。有效扩散系数为 $D_{eff}(t) = D_{BI} \\frac{k_f}{k_r} C_I(t) = D_{BI} \\frac{k_f}{k_r} C_I^{\\mathrm{eq}} S_I(t)$。因此我们有：\n$$\n\\sigma^2(t) = \\sigma_0^2 + 2 D_{BI} \\frac{k_f}{k_r} C_I^{\\mathrm{eq}} \\int_0^t S_I(t') dt' \\quad (8)\n$$\n接下来，我们求解间隙原子过饱和度 $S_I(t)$。其控制常微分方程(ODE)为 $\\frac{\\mathrm{d}S_{I}}{\\mathrm{d}t} = \\frac{S_{\\mathrm{inj}}-S_{I}}{\\tau_{I}}$，且 $S_I(0)=1$。这是一个一阶线性常微分方程，其解为：\n$$\nS_I(t) = S_{\\mathrm{inj}} + (S_I(0) - S_{\\mathrm{inj}}) \\exp(-t/\\tau_I) = S_{\\mathrm{inj}} + (1 - S_{\\mathrm{inj}}) \\exp(-t/\\tau_I)\n$$\n现在我们计算方程 $(8)$ 中的积分：\n$$\n\\int_0^t S_I(t') dt' = \\int_0^t \\left[ S_{\\mathrm{inj}} + (1 - S_{\\mathrm{inj}}) \\exp(-t'/\\tau_I) \\right] dt'\n$$\n$$\n= \\left[ S_{\\mathrm{inj}}t' + (1 - S_{\\mathrm{inj}})(-\\tau_I) \\exp(-t'/\\tau_I) \\right]_0^t\n$$\n$$\n= \\left( S_{\\mathrm{inj}}t - \\tau_I(1 - S_{\\mathrm{inj}}) \\exp(-t/\\tau_I) \\right) - \\left( 0 - \\tau_I(1 - S_{\\mathrm{inj}}) \\exp(0) \\right)\n$$\n$$\n= S_{\\mathrm{inj}}t - \\tau_I(1 - S_{\\mathrm{inj}}) \\exp(-t/\\tau_I) + \\tau_I(1 - S_{\\mathrm{inj}})\n$$\n$$\n= S_{\\mathrm{inj}}t + \\tau_I(1 - S_{\\mathrm{inj}})\\left(1 - \\exp(-t/\\tau_I)\\right)\n$$\n最后，将此积分代回方程 $(8)$，得到硼分布方差随时间变化的表达式：\n$$\n\\sigma^2(t) = \\sigma_0^2 + 2 D_{BI} \\frac{k_f}{k_r} C_I^{\\mathrm{eq}} \\left[ S_{\\mathrm{inj}}t + \\tau_I(1 - S_{\\mathrm{inj}})\\left(1 - \\exp\\left(-\\frac{t}{\\tau_I}\\right)\\right) \\right]\n$$\n该表达式以给定的物理参数表示了硼分布的短期展宽。",
            "answer": "$$\n\\boxed{\\sigma_{0}^{2} + 2 D_{BI} \\frac{k_f}{k_r} C_{I}^{\\mathrm{eq}} \\left( S_{\\mathrm{inj}}t + \\tau_{I}(1 - S_{\\mathrm{inj}})\\left(1 - \\exp\\left(-\\frac{t}{\\tau_{I}}\\right)\\right) \\right)}\n$$"
        },
        {
            "introduction": "在半导体制造中，扩散并不总是有益的；精确控制扩散，尤其是抑制瞬态增强扩散（TED），是关键的技术挑战之一。本练习将理论应用到解决实际的工程问题中，要求您通过建立一个计算模型来量化碳杂质对间隙原子浓度的影响，并最终计算出抑制硼扩散所需的碳注入剂量。这项综合性练习融合了物理理解、数学建模和计算编程，完整地体现了如何运用工艺模型来指导和优化实际的半导体制造流程。",
            "id": "4133524",
            "problem": "考虑在退火过程中，晶体硅中由间隙原子介导的硼扩散，其输运过程遵循“踢出”机制。假设硼扩散率与硅自间隙原子的过饱和度成正比，并且硼扩散率随时间的变化由 $D_{B}(t) = D_{B}^{\\mathrm{eq}} \\, S_{I}(t)$ 建模，其中 $S_{I}(t) = I(t) / I^{\\mathrm{eq}}$，$I(t)$ 是硅自间隙原子浓度，$I^{\\mathrm{eq}}$ 是其在退火温度下的平衡浓度。瞬态增强扩散（Transient Enhanced Diffusion, TED）通过硼扩散率相对于其平衡值的时间积分来量化。\n\n设一个空间均匀区域内的硅自间隙原子动力学由以下常微分方程近似：\n$$\n\\frac{d I}{dt} = G - R \\, I - k_{t} \\, N_{C} \\, I,\n$$\n其中 $G$ 是由注入损伤溶解引起的间隙原子恒定产生率（单位 $\\mathrm{cm}^{-3}\\,\\mathrm{s}^{-1}$），$R$ 是有效的复合或阱去除率（单位 $\\mathrm{s}^{-1}$），$k_{t}$ 是替位碳陷阱对间隙原子的俘获速率系数（单位 $\\mathrm{cm}^{3}\\,\\mathrm{s}^{-1}$），$N_{C}$ 是替位碳陷阱的有效浓度（单位 $\\mathrm{cm}^{-3}$）。$t = 0$ 时的初始条件为 $I(0) = I_{0}$。\n\n定义退火时间窗口 $[0, T]$ 内的 TED 因子为\n$$\nF = \\frac{1}{T} \\int_{0}^{T} \\frac{D_{B}(t)}{D_{B}^{\\mathrm{eq}}} \\, dt\n= \\frac{1}{T} \\int_{0}^{T} \\frac{I(t)}{I^{\\mathrm{eq}}} \\, dt,\n$$\n它等于 $S_{I}(t)$ 的时间平均值。考虑两种情况：无碳共注入（基准情况）和引入了有效陷阱浓度 $N_{C}$ 的碳共注入情况。对于一个指定的抑制因子 $s$（表示为小数），其定义为有碳情况下的 TED 因子与基准 TED 因子的比率，\n$$\ns = \\frac{F_{\\mathrm{with\\;C}}}{F_{\\mathrm{baseline}}},\n$$\n请确定能产生目标 $s$ 值所需的有效陷阱浓度 $N_{C}$。\n\n假设碳陷阱在厚度为 $L$（单位 $\\mathrm{cm}$）的层内均匀分布，并且只有一小部分（比例为 $f$）的碳剂量成为有效的替位陷阱。那么所需的总碳剂量（单位 $\\mathrm{atoms}/\\mathrm{cm}^{2}$）为\n$$\n\\mathrm{Dose} = \\frac{N_{C}}{f} \\, L.\n$$\n\n您的任务是：\n- 从给定的定义和定律出发，推导出一个算法，通过增加间隙原子俘获反应来计算实现指定抑制因子 $s$ 所需的 $N_{C}$，然后计算相应的碳剂量。\n- 实现一个完整的、可运行的程序，该程序针对下面的测试套件中的每个测试用例，输出所需的碳剂量（单位 $\\mathrm{atoms}/\\mathrm{cm}^{2}$），并四舍五入到三位有效数字。\n\n使用以下参数值的测试套件，它们代表了具有不同产生和阱条件的科学上合理的退火场景：\n1. 具有有限产生率和中等阱的一般情况：\n   - $I^{\\mathrm{eq}} = 1.0 \\times 10^{14}\\ \\mathrm{cm}^{-3}$，\n   - $I_{0} = 5.0 \\times 10^{15}\\ \\mathrm{cm}^{-3}$，\n   - $G = 1.0 \\times 10^{14}\\ \\mathrm{cm}^{-3}\\,\\mathrm{s}^{-1}$，\n   - $R = 1.0 \\times 10^{-1}\\ \\mathrm{s}^{-1}$，\n   - $k_{t} = 1.0 \\times 10^{-10}\\ \\mathrm{cm}^{3}\\,\\mathrm{s}^{-1}$，\n   - $T = 120\\ \\mathrm{s}$，\n   - $L = 1.0 \\times 10^{-5}\\ \\mathrm{cm}$，\n   - $f = 0.60$，\n   - $s = 0.30$。\n2. 无产生（$G = 0$）、更快阱的边界情况：\n   - $I^{\\mathrm{eq}} = 1.0 \\times 10^{14}\\ \\mathrm{cm}^{-3}$，\n   - $I_{0} = 1.0 \\times 10^{15}\\ \\mathrm{cm}^{-3}$，\n   - $G = 0.0\\ \\mathrm{cm}^{-3}\\,\\mathrm{s}^{-1}$，\n   - $R = 1.0\\ \\mathrm{s}^{-1}$，\n   - $k_{t} = 1.0 \\times 10^{-11}\\ \\mathrm{cm}^{3}\\,\\mathrm{s}^{-1}$，\n   - $T = 30\\ \\mathrm{s}$，\n   - $L = 2.0 \\times 10^{-5}\\ \\mathrm{cm}$，\n   - $f = 0.50$，\n   - $s = 0.50$。\n3. 高产生率、短时退火：\n   - $I^{\\mathrm{eq}} = 5.0 \\times 10^{13}\\ \\mathrm{cm}^{-3}$，\n   - $I_{0} = 5.0 \\times 10^{14}\\ \\mathrm{cm}^{-3}$，\n   - $G = 5.0 \\times 10^{14}\\ \\mathrm{cm}^{-3}\\,\\mathrm{s}^{-1}$，\n   - $R = 5.0 \\times 10^{-1}\\ \\mathrm{s}^{-1}$，\n   - $k_{t} = 5.0 \\times 10^{-11}\\ \\mathrm{cm}^{3}\\,\\mathrm{s}^{-1}$，\n   - $T = 10\\ \\mathrm{s}$，\n   - $L = 5.0 \\times 10^{-6}\\ \\mathrm{cm}$，\n   - $f = 0.70$，\n   - $s = 0.10$。\n4. 无抑制请求：\n   - $I^{\\mathrm{eq}} = 1.0 \\times 10^{14}\\ \\mathrm{cm}^{-3}$，\n   - $I_{0} = 2.0 \\times 10^{15}\\ \\mathrm{cm}^{-3}$，\n   - $G = 2.0 \\times 10^{14}\\ \\mathrm{cm}^{-3}\\,\\mathrm{s}^{-1}$，\n   - $R = 2.0 \\times 10^{-1}\\ \\mathrm{s}^{-1}$，\n   - $k_{t} = 1.0 \\times 10^{-10}\\ \\mathrm{cm}^{3}\\,\\mathrm{s}^{-1}$，\n   - $T = 60\\ \\mathrm{s}$，\n   - $L = 1.0 \\times 10^{-5}\\ \\mathrm{cm}$，\n   - $f = 0.60$，\n   - $s = 1.00$。\n5. 强抑制要求：\n   - $I^{\\mathrm{eq}} = 1.0 \\times 10^{14}\\ \\mathrm{cm}^{-3}$，\n   - $I_{0} = 1.0 \\times 10^{16}\\ \\mathrm{cm}^{-3}$，\n   - $G = 3.0 \\times 10^{14}\\ \\mathrm{cm}^{-3}\\,\\mathrm{s}^{-1}$，\n   - $R = 5.0 \\times 10^{-2}\\ \\mathrm{s}^{-1}$，\n   - $k_{t} = 2.0 \\times 10^{-10}\\ \\mathrm{cm}^{3}\\,\\mathrm{s}^{-1}$，\n   - $T = 300\\ \\mathrm{s}$，\n   - $L = 1.0 \\times 10^{-5}\\ \\mathrm{cm}$，\n   - $f = 0.40$，\n   - $s = 0.01$。\n\n最终输出格式要求：\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个条目是对应测试用例的碳剂量（单位 $\\mathrm{atoms}/\\mathrm{cm}^{2}$），四舍五入到三位有效数字（例如，$[x_{1},x_{2},x_{3},x_{4},x_{5}]$）。",
            "solution": "对用户提供的问题进行了严格的验证过程。\n\n### 步骤 1：提取已知条件\n问题陈述提供了以下定义、控制方程和参数：\n- **硼扩散率**：$D_{B}(t) = D_{B}^{\\mathrm{eq}} \\, S_{I}(t)$\n- **间隙原子过饱和度**：$S_{I}(t) = I(t) / I^{\\mathrm{eq}}$\n- **间隙原子浓度 $I(t)$ 的控制常微分方程**：\n$$\n\\frac{d I}{dt} = G - R \\, I - k_{t} \\, N_{C} \\, I\n$$\n- **初始条件**：$I(0) = I_{0}$\n- **变量定义**：\n  - $I(t)$: 硅自间隙原子浓度 ($\\mathrm{cm}^{-3}$)\n  - $I^{\\mathrm{eq}}$: 平衡间隙原子浓度 ($\\mathrm{cm}^{-3}$)\n  - $G$: 间隙原子产生率 ($\\mathrm{cm}^{-3}\\,\\mathrm{s}^{-1}$)\n  - $R$: 有效阱去除率 ($\\mathrm{s}^{-1}$)\n  - $k_{t}$: 碳对间隙原子的俘获速率系数 ($\\mathrm{cm}^{3}\\,\\mathrm{s}^{-1}$)\n  - $N_{C}$: 有效替位碳陷阱浓度 ($\\mathrm{cm}^{-3}$)\n- **TED 因子定义**：\n$$\nF = \\frac{1}{T} \\int_{0}^{T} \\frac{D_{B}(t)}{D_{B}^{\\mathrm{eq}}} \\, dt = \\frac{1}{T} \\int_{0}^{T} \\frac{I(t)}{I^{\\mathrm{eq}}} \\, dt\n$$\n- **抑制因子定义**：\n$$\ns = \\frac{F_{\\mathrm{with\\;C}}}{F_{\\mathrm{baseline}}}\n$$\n- **碳剂量计算**：\n$$\n\\mathrm{Dose} = \\frac{N_{C}}{f} \\, L\n$$\n- **剂量计算常数**：\n  - $L$: 掺碳层厚度 ($\\mathrm{cm}$)\n  - $f$: 成为有效陷阱的碳剂量比例\n- **测试套件参数**：为 $I^{\\mathrm{eq}}$, $I_{0}$, $G$, $R$, $k_{t}$, $T$, $L$, $f$, 和 $s$ 提供了五组参数。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学依据**：该问题基于半导体工艺模拟中公认的概念，特别是掺杂剂扩散的“踢出”机制和点缺陷（自间隙原子）的作用。控制常微分方程是点缺陷动力学的一个标准反应-扩散模型简化，包含了产生、复合/阱去除和俘获。这在科学上是合理的。\n2.  **适定性**：该问题要求找到能产生指定抑制因子 $s$ 的陷阱浓度 $N_C$。这需要求解一个关于 $N_C$ 的方程。如解法中所示，$N_C$ 和 TED 因子之间的关系是单调的，这确保了对于给定的有效抑制因子 $s \\in (0, 1]$ 存在唯一解。因此，该问题是适定的。\n3.  **客观性**：语言精确且量化。所有术语都有数学定义，参数也给出了具体单位。没有主观或基于意见的陈述。\n4.  **完整性与一致性**：问题提供了推导解法所需的所有方程、初始条件和参数。所提供的信息中没有明显的矛盾。单位是一致的。\n5.  **现实性与可行性**：物理场景（通过碳共注入抑制 TED）是半导体制造中使用的真实技术。测试套件中提供的数值对于典型的硅处理条件具有现实的量级。\n6.  **其他缺陷**：该问题不是琐碎、隐喻或同义反复的。它需要对物理模型有清晰的理解，能够解析求解常微分方程，并使用数值方法求解得到的超越方程。在其指定领域内，这是一个可形式化且相关的问题。\n\n### 步骤 3：结论与行动\n该问题科学合理、适定、客观且自洽。它是**有效的**。将着手开发一个解法。\n\n### 算法推导\n问题的核心是确定为实现对瞬态增强扩散（TED）的特定抑制所需的有效碳陷阱浓度 $N_C$。\n\n首先，我们求解控制硅自间隙原子浓度 $I(t)$ 的常微分方程（ODE）：\n$$\n\\frac{d I}{dt} = G - R \\, I - k_{t} \\, N_{C} \\, I\n$$\n通过将与 $I$ 成正比的项分组，可以重写为：\n$$\n\\frac{d I}{dt} = G - (R + k_{t} N_{C}) I\n$$\n这是一个形式为 $\\frac{dy}{dt} + P(t)y = Q(t)$ 的一阶线性常微分方程。我们定义一个有效衰减速率常数 $K(N_C) = R + k_{t} N_C$。ODE 变为：\n$$\n\\frac{d I}{dt} + K I = G\n$$\n参数 $G$ 和 $K$ 关于时间 $t$ 是常数。对于初始条件 $I(0) = I_{0}$，此 ODE 的解可以使用积分因子 $e^{\\int K dt} = e^{Kt}$ 求得。解为：\n$$\nI(t) = \\frac{G}{K} + \\left(I_{0} - \\frac{G}{K}\\right) e^{-Kt}\n$$\n项 $G/K$ 代表当 $t \\to \\infty$ 时将达到的稳态间隙原子浓度 $I_{ss}$。\n\n接下来，我们根据其定义，通过对 $I(t)$ 在退火时间 $T$ 内积分来计算 TED 因子 $F$：\n$$\nF(N_C) = \\frac{1}{T I^{\\mathrm{eq}}} \\int_{0}^{T} I(t) \\, dt = \\frac{1}{T I^{\\mathrm{eq}}} \\int_{0}^{T} \\left[ \\frac{G}{K} + \\left(I_{0} - \\frac{G}{K}\\right) e^{-Kt} \\right] dt\n$$\n执行积分：\n$$\n\\int_{0}^{T} I(t) \\, dt = \\left[ \\frac{G}{K}t - \\frac{1}{K}\\left(I_{0} - \\frac{G}{K}\\right) e^{-Kt} \\right]_{0}^{T}\n$$\n$$\n= \\left( \\frac{GT}{K} - \\frac{1}{K}\\left(I_{0} - \\frac{G}{K}\\right) e^{-KT} \\right) - \\left( 0 - \\frac{1}{K}\\left(I_{0} - \\frac{G}{K}\\right) e^{0} \\right)\n$$\n$$\n= \\frac{GT}{K} + \\frac{1}{K}\\left(I_{0} - \\frac{G}{K}\\right) (1 - e^{-KT})\n$$\n因此，作为 $N_C$ 函数的 TED 因子为：\n$$\nF(N_C) = \\frac{1}{T I^{\\mathrm{eq}}} \\left[ \\frac{GT}{K(N_C)} + \\frac{1}{K(N_C)}\\left(I_{0} - \\frac{G}{K(N_C)}\\right) (1 - e^{-K(N_C)T}) \\right]\n$$\n其中 $K(N_C) = R + k_t N_C$。\n\n问题要求找到使抑制因子达到 $s$ 的 $N_C$。抑制因子定义为有碳情况下的 TED 因子与无碳的基准情况的比值。\n基准 TED 因子 $F_{\\mathrm{baseline}}$ 对应于 $N_C = 0$。在这种情况下，衰减率为 $K(0) = R$。\n$$\nF_{\\mathrm{baseline}} = F(0) = \\frac{1}{T I^{\\mathrm{eq}}} \\left[ \\frac{GT}{R} + \\frac{1}{R}\\left(I_{0} - \\frac{G}{R}\\right) (1 - e^{-RT}) \\right]\n$$\n需要满足的条件是 $F(N_C) / F_{\\mathrm{baseline}} = s$，或者：\n$$\nF(N_C) - s \\cdot F_{\\mathrm{baseline}} = 0\n$$\n这是一个关于未知数 $N_C$ 的非线性超越方程。我们需要找到函数 $\\mathcal{H}(N_C) = F(N_C) - s \\cdot F_{\\mathrm{baseline}}$ 的根。\n\n对于任何 $t0$，函数 $I(t)$ 是 $K$ 的递减函数。由于 $K(N_C) = R + k_t N_C$ 是 $N_C$ 的递增函数（因为 $k_t  0$），所以 $I(t)$ 是 $N_C$ 的递减函数。因此，其时间积分，从而 $F(N_C)$，对于 $N_C \\geq 0$ 是 $N_C$ 的单调递减函数。这保证了对于任何有效的抑制因子 $s \\in (0, 1]$，存在一个唯一的非负解 $N_C$。\n\n对于 $s=1$，不需要抑制。这意味着 $F(N_C) = F_{\\mathrm{baseline}}$，由于 $F(N_C)$ 的单调性，立即得出解为 $N_C=0$。对于 $s1$，我们面临一个求根问题，可以用数值方法求解。像 Brent 法这样高效且稳健的方法是合适的。我们需要为求解器提供一个搜索区间 $[a, b]$，使得 $\\mathcal{H}(a)$ 和 $\\mathcal{H}(b)$ 的符号相反。\n在 $N_C = 0$ 时，$\\mathcal{H}(0) = F(0) - s \\cdot F_{\\mathrm{baseline}} = F_{\\mathrm{baseline}}(1-s)$。由于 $s \\le 1$，所以 $\\mathcal{H}(0) \\ge 0$。\n当 $N_C \\to \\infty$ 时，$K \\to \\infty$。$I(t)$ 的积分趋近于 $0$，所以 $F(N_C) \\to 0$。在这个极限下，$\\mathcal{H}(N_C) \\to -s \\cdot F_{\\mathrm{baseline}}  0$。\n因此，保证在 $N_C = 0$ 和一个足够大的 $N_C$ 值之间存在一个根。我们可以安全地选择一个像 $[0, 10^{22}]$ 这样的区间。\n\n一旦确定了 $N_C$ 的值，就可以使用提供的最终公式计算所需的总碳剂量：\n$$\n\\mathrm{Dose} = \\frac{N_{C}}{f} L\n$$\n\n总体算法如下：\n1. 对于每组参数，根据解析解定义函数 $F(N_C)$。\n2. 如果 $s=1$，所需剂量为 $0$。\n3. 如果 $s1$，计算 $F_{\\mathrm{baseline}} = F(0)$。\n4. 定义目标函数 $\\mathcal{H}(N_C) = F(N_C) - s \\cdot F_{\\mathrm{baseline}}$。\n5. 使用数值求根算法（例如，`scipy.optimize.brentq`）对 $\\mathcal{H}(N_C)$ 进行求解，以找到唯一的正根 $N_C$。\n6. 使用找到的 $N_C$、激活分数 $f$ 和层厚度 $L$ 计算剂量。\n7. 将最终剂量四舍五入到三位有效数字。",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\nimport math\n\ndef round_to_sf(x, sf):\n    \"\"\"\n    Rounds a number to a specified number of significant figures.\n    \"\"\"\n    if x == 0:\n        return 0.0\n    if not np.isfinite(x):\n        return x\n    \n    # Calculate the number of decimal places needed for rounding\n    power = sf - 1 - math.floor(math.log10(abs(x)))\n    return round(x, power)\n\ndef solve():\n    \"\"\"\n    Solves for the required carbon dose for a series of test cases related to\n    Transient Enhanced Diffusion (TED) suppression in silicon.\n    \"\"\"\n    test_cases = [\n        # 1. General case\n        {'I_eq': 1.0e14, 'I0': 5.0e15, 'G': 1.0e14, 'R': 1.0e-1, 'kt': 1.0e-10, 'T': 120.0, 'L': 1.0e-5, 'f': 0.60, 's': 0.30},\n        # 2. No generation, faster sinks\n        {'I_eq': 1.0e14, 'I0': 1.0e15, 'G': 0.0, 'R': 1.0, 'kt': 1.0e-11, 'T': 30.0, 'L': 2.0e-5, 'f': 0.50, 's': 0.50},\n        # 3. High generation, short anneal\n        {'I_eq': 5.0e13, 'I0': 5.0e14, 'G': 5.0e14, 'R': 5.0e-1, 'kt': 5.0e-11, 'T': 10.0, 'L': 5.0e-6, 'f': 0.70, 's': 0.10},\n        # 4. No suppression requested\n        {'I_eq': 1.0e14, 'I0': 2.0e15, 'G': 2.0e14, 'R': 2.0e-1, 'kt': 1.0e-10, 'T': 60.0, 'L': 1.0e-5, 'f': 0.60, 's': 1.00},\n        # 5. Strong suppression\n        {'I_eq': 1.0e14, 'I0': 1.0e16, 'G': 3.0e14, 'R': 5.0e-2, 'kt': 2.0e-10, 'T': 300.0, 'L': 1.0e-5, 'f': 0.40, 's': 0.01},\n    ]\n\n    results = []\n\n    def calculate_integrated_I(K, I0, G, T):\n        \"\"\"\n        Calculates the time integral of I(t) from 0 to T based on the analytical solution.\n        \"\"\"\n        if K == 0:\n            # This case should not be reached with the given positive R and kt.\n            # If K=0 and G=0, I(t)=I0, integral is I0*T\n            # If K=0 and G>0, I(t)=I0+G*t, integral is I0*T + 0.5*G*T^2\n            # For simplicity, we assume K > 0.\n            return np.inf\n\n        # The term K*T can be very large, leading to np.exp(-K*T) being exactly 0\n        # which is numerically stable.\n        \n        # Calculate the steady-state concentration I_ss = G/K\n        I_ss = G / K\n        \n        # Integral_I = (G*T/K) + (1/K)*(I0 - G/K)*(1 - exp(-K*T))\n        integral_I = I_ss * T + (1/K) * (I0 - I_ss) * (1 - np.exp(-K * T))\n        return integral_I\n\n    for case in test_cases:\n        I_eq, I0, G, R, kt, T, L, f, s = case.values()\n\n        # Handle the trivial case where no suppression is requested\n        if s == 1.0:\n            results.append(0.0)\n            continue\n        \n        # Calculate the baseline TED factor (Nc = 0)\n        K_base = R\n        integral_I_base = calculate_integrated_I(K_base, I0, G, T)\n        F_base = integral_I_base / (T * I_eq)\n        \n        if F_base == 0:\n            # If baseline TED is zero, no carbon is needed regardless of s.\n            results.append(0.0)\n            continue\n\n        target_F_with_C = s * F_base\n\n        def target_function(Nc):\n            \"\"\"\n            The function whose root we want to find.\n            H(Nc) = F(Nc) - s * F_baseline = 0\n            \"\"\"\n            K_with_C = R + kt * Nc\n            integral_I_with_C = calculate_integrated_I(K_with_C, I0, G, T)\n            F_with_C = integral_I_with_C / (T * I_eq)\n            return F_with_C - target_F_with_C\n\n        # Find the required Carbon concentration Nc using a numerical root-finder\n        # The function is monotonic, so a root is guaranteed if a proper bracket is chosen.\n        # H(0) = F_base - s*F_base = F_base*(1-s) which is >= 0 for s = 1.\n        # H(Nc->inf) -> -s*F_base which is  0.\n        # A bracket [0, large_number] is appropriate.\n        try:\n            Nc_required = brentq(target_function, a=0, b=1e24, rtol=1e-15, xtol=1e-15)\n        except ValueError:\n            # This may happen if target_function(a) and target_function(b)\n            # do not have opposite signs, which can occur with extreme parameters\n            # or if the target suppression is unachievable within the bracket.\n            Nc_required = np.nan # Or handle as an error\n\n        # Calculate the required carbon dose\n        dose = (Nc_required / f) * L\n        \n        # Round to three significant figures\n        rounded_dose = round_to_sf(dose, 3)\n        results.append(rounded_dose)\n\n    # Format the final output string as required\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}