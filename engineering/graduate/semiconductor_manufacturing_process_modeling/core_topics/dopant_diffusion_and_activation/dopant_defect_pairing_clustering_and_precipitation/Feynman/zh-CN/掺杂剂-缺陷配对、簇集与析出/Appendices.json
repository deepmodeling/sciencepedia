{
    "hands_on_practices": [
        {
            "introduction": "在半导体制造过程中，高温处理后掺杂剂与缺陷的相互作用决定了材料最终的电学特性。这个练习将带你进行一项基础而核心的计算：在热平衡状态下，确定掺杂剂-缺陷对的浓度。通过应用质量作用定律和质量守恒原理，你将掌握预测半导体材料在达到稳定状态后，各种粒子组分分布的基本技能。",
            "id": "4123447",
            "problem": "一块均匀掺杂的晶体硅片含有一种浅施主物种，记为 $D$，它可以与一种本征点缺陷物种（例如，一个空位），记为 $X$，配对，通过可逆反应 $D + X \\rightleftharpoons DX$ 形成掺杂剂-缺陷复合物 $DX$。假设理想溶液热力学，因此活度与浓度成正比，并且在工艺温度 $T$下，在所考虑的时间尺度上，沉淀成不动相和超出 $DX$ 复合物的多缺陷团簇的现象可以忽略不计。硅片是均匀的，且配对反应达到热力学平衡。\n\n给定在 $T = 1273\\,\\mathrm{K}$ 下的以下参数：\n- 总掺杂剂浓度 $C_{D}^{\\text{tot}} = 3.00 \\times 10^{19}\\,\\mathrm{cm}^{-3}$。\n- 总缺陷浓度 $C_{X}^{\\text{tot}} = 8.00 \\times 10^{18}\\,\\mathrm{cm}^{-3}$。\n- 有效的基于浓度的平衡常数 $K(T) = 5.00 \\times 10^{-19}\\,\\mathrm{cm}^{3}$。\n\n在这些条件下，计算平衡时以 $DX$ 形式配对的掺杂剂原子的分数，即 $C_{DX} / C_{D}^{\\text{tot}}$。将最终结果表示为不带单位的小数，并将答案四舍五入到四位有效数字。",
            "solution": "首先验证问题以确保其具有科学依据、良定且客观。\n\n### 步骤1：提取已知条件\n- 所考虑的可逆反应是 $D + X \\rightleftharpoons DX$，其中 $D$ 是施主物种，$X$ 是点缺陷，$DX$ 是生成的复合物。\n- 系统在温度 $T = 1273\\,\\mathrm{K}$ 下处于热力学平衡状态。\n- 掺杂剂物种的总浓度为 $C_{D}^{\\text{tot}} = 3.00 \\times 10^{19}\\,\\mathrm{cm}^{-3}$。\n- 缺陷物种的总浓度为 $C_{X}^{\\text{tot}} = 8.00 \\times 10^{18}\\,\\mathrm{cm}^{-3}$。\n- 该反应的基于浓度的平衡常数为 $K(T) = 5.00 \\times 10^{-19}\\,\\mathrm{cm}^{3}$。\n- 目标是计算已配对的掺杂剂原子的分数，由比率 $C_{DX} / C_{D}^{\\text{tot}}$ 给出，其中 $C_{DX}$ 是 $DX$ 复合物的平衡浓度。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题描述了一个应用于半导体中固态缺陷的标准化学平衡情景，这是材料科学和半导体物理学中一个成熟的课题。考虑到理想溶液热力学的假设，使用质量作用定律是合适的。给定的浓度和温度在半导体工艺的物理现实范围内。平衡常数 ($K$) 的单位与反应化学计量和浓度单位一致：对于反应 $D + X \\rightleftharpoons DX$，$K$ 定义为 $K = C_{DX} / (C_D C_X)$，这导致单位为 $(\\mathrm{cm}^{-3}) / ((\\mathrm{cm}^{-3})(\\mathrm{cm}^{-3})) = \\mathrm{cm}^3$。问题是自洽的，为唯一解提供了所有必要的参数。问题是客观且精确表述的。因此，该问题被认为是有效的。\n\n### 步骤3：结论与行动\n问题有效。将提供详细的解决方案。\n\n令 $C_D$、$C_X$ 和 $C_{DX}$ 分别表示自由施主 $D$、自由缺陷 $X$ 和复合物 $DX$ 的平衡浓度。反应为 $D + X \\rightleftharpoons DX$。\n\n根据理想溶液的质量作用定律，平衡常数 $K$ 与各物种的浓度相关：\n$$K = \\frac{C_{DX}}{C_D C_X}$$\n\n掺杂剂和缺陷物种的总浓度是守恒的。这提供了两个质量守恒方程：\n1. 总掺杂剂浓度 $C_{D}^{\\text{tot}}$ 是自由施主浓度与复合物中施主浓度之和：\n$$C_{D}^{\\text{tot}} = C_D + C_{DX}$$\n2. 总缺陷浓度 $C_{X}^{\\text{tot}}$ 是自由缺陷浓度与复合物中缺陷浓度之和：\n$$C_{X}^{\\text{tot}} = C_X + C_{DX}$$\n\n从质量守恒方程中，我们可以用复合物浓度 $C_{DX}$ 来表示自由物种的浓度 $C_D$ 和 $C_X$：\n$$C_D = C_{D}^{\\text{tot}} - C_{DX}$$\n$$C_X = C_{X}^{\\text{tot}} - C_{DX}$$\n重要的是要注意，所有浓度必须为非负值，这意味着 $C_{DX} \\le C_{D}^{\\text{tot}}$ 且 $C_{DX} \\le C_{X}^{\\text{tot}}$。\n\n将 $C_D$ 和 $C_X$ 的这些表达式代入平衡常数方程，得到：\n$$K = \\frac{C_{DX}}{(C_{D}^{\\text{tot}} - C_{DX})(C_{X}^{\\text{tot}} - C_{DX})}$$\n\n这个方程可以重新整理成一个关于 $C_{DX}$ 的二次方程：\n$$K (C_{D}^{\\text{tot}} - C_{DX})(C_{X}^{\\text{tot}} - C_{DX}) = C_{DX}$$\n$$K (C_{D}^{\\text{tot}}C_{X}^{\\text{tot}} - C_{D}^{\\text{tot}}C_{DX} - C_{X}^{\\text{tot}}C_{DX} + C_{DX}^2) = C_{DX}$$\n$$K C_{DX}^2 - K(C_{D}^{\\text{tot}} + C_{X}^{\\text{tot}})C_{DX} + K C_{D}^{\\text{tot}}C_{X}^{\\text{tot}} = C_{DX}$$\n$$K C_{DX}^2 - \\left(1 + K(C_{D}^{\\text{tot}} + C_{X}^{\\text{tot}})\\right)C_{DX} + K C_{D}^{\\text{tot}}C_{X}^{\\text{tot}} = 0$$\n\n这是一个形式为 $a x^2 + b x + c = 0$ 的二次方程，其中 $x = C_{DX}$，系数为：\n- $a = K$\n- $b = -\\left(1 + K(C_{D}^{\\text{tot}} + C_{X}^{\\text{tot}})\\right)$\n- $c = K C_{D}^{\\text{tot}}C_{X}^{\\text{tot}}$\n\n我们现在可以代入给定的数值：\n- $K = 5.00 \\times 10^{-19}\\,\\mathrm{cm}^{3}$\n- $C_{D}^{\\text{tot}} = 3.00 \\times 10^{19}\\,\\mathrm{cm}^{-3}$\n- $C_{X}^{\\text{tot}} = 8.00 \\times 10^{18}\\,\\mathrm{cm}^{-3}$\n\n我们来计算二次方程所需的各项：\n$$K(C_{D}^{\\text{tot}} + C_{X}^{\\text{tot}}) = (5.00 \\times 10^{-19}) \\times (3.00 \\times 10^{19} + 8.00 \\times 10^{18})$$\n$$K(C_{D}^{\\text{tot}} + C_{X}^{\\text{tot}}) = (5.00 \\times 10^{-19}) \\times (3.80 \\times 10^{19}) = 19.0$$\n$$K C_{D}^{\\text{tot}}C_{X}^{\\text{tot}} = (5.00 \\times 10^{-19}) \\times (3.00 \\times 10^{19}) \\times (8.00 \\times 10^{18})$$\n$$K C_{D}^{\\text{tot}}C_{X}^{\\text{tot}} = (5.00 \\times 10^{-19}) \\times (2.40 \\times 10^{38}) = 1.20 \\times 10^{20}$$\n\n关于 $C_{DX}$ 的二次方程变为：\n$$(5.00 \\times 10^{-19}) C_{DX}^2 - (1 + 19.0) C_{DX} + (1.20 \\times 10^{20}) = 0$$\n$$(5.00 \\times 10^{-19}) C_{DX}^2 - 20.0 C_{DX} + (1.20 \\times 10^{20}) = 0$$\n\n我们使用二次公式求解 $C_{DX}$：\n$$C_{DX} = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$$\n$$C_{DX} = \\frac{20.0 \\pm \\sqrt{(-20.0)^2 - 4(5.00 \\times 10^{-19})(1.20 \\times 10^{20})}}{2(5.00 \\times 10^{-19})}$$\n$$C_{DX} = \\frac{20.0 \\pm \\sqrt{400 - (20.0 \\times 10^{-19})(1.20 \\times 10^{20})}}{1.00 \\times 10^{-18}}$$\n$$C_{DX} = \\frac{20.0 \\pm \\sqrt{400 - 240}}{1.00 \\times 10^{-18}}$$\n$$C_{DX} = \\frac{20.0 \\pm \\sqrt{160}}{1.00 \\times 10^{-18}}$$\n$$C_{DX} = (20.0 \\pm 12.6491106...) \\times 10^{18}$$\n\n这给出了 $C_{DX}$ 的两个可能的数学解：\n$$C_{DX,1} = (20.0 + 12.6491106...) \\times 10^{18} \\approx 3.2649 \\times 10^{19}\\,\\mathrm{cm}^{-3}$$\n$$C_{DX,2} = (20.0 - 12.6491106...) \\times 10^{18} \\approx 7.3509 \\times 10^{18}\\,\\mathrm{cm}^{-3}$$\n\n我们必须选择具有物理意义的解。复合物的浓度 $C_{DX}$ 不能超过任一初始总浓度 $C_{D}^{\\text{tot}}$ 和 $C_{X}^{\\text{tot}}$。\n$C_{D}^{\\text{tot}} = 3.00 \\times 10^{19}\\,\\mathrm{cm}^{-3}$\n$C_{X}^{\\text{tot}} = 8.00 \\times 10^{18}\\,\\mathrm{cm}^{-3}$\n第一个根 $C_{DX,1} \\approx 3.2649 \\times 10^{19}\\,\\mathrm{cm}^{-3}$，大于 $C_{D}^{\\text{tot}}$ 和 $C_{X}^{\\text{tot}}$。因此它没有物理意义。\n第二个根 $C_{DX,2} \\approx 7.3509 \\times 10^{18}\\,\\mathrm{cm}^{-3}$，小于 $C_{D}^{\\text{tot}}$ 和 $C_{X}^{\\text{tot}}$。这是物理上有效的平衡浓度。\n因此，$C_{DX} = 7.350889... \\times 10^{18}\\,\\mathrm{cm}^{-3}$。\n\n问题要求计算以 $DX$ 形式配对的掺杂剂原子的分数，即 $C_{DX} / C_{D}^{\\text{tot}}$。\n$$\\text{分数} = \\frac{C_{DX}}{C_{D}^{\\text{tot}}} = \\frac{7.350889... \\times 10^{18}\\,\\mathrm{cm}^{-3}}{3.00 \\times 10^{19}\\,\\mathrm{cm}^{-3}}$$\n$$\\text{分数} = \\frac{7.350889...}{30.0} = 0.2450296...$$\n\n将结果四舍五入到四位有效数字，得到 $0.2450$。",
            "answer": "$$\n\\boxed{0.2450}\n$$"
        },
        {
            "introduction": "热力学平衡描述了系统的最终状态，但并未告诉我们系统达到该状态的速度。本练习将我们的关注点从热力学转向动力学，要求你模拟在等温退火过程中掺杂剂-缺陷对浓度随时间的变化。你需要推导并实现一个速率方程的解析解，这是工艺建模中的一项核心任务，能够帮助我们理解并控制反应过程的时间尺度。",
            "id": "4123412",
            "problem": "考虑在固定温度下进行等温退火时，晶体半导体中的掺杂剂-缺陷配对。设 $[D](t)$ 表示电活性自由掺杂剂的浓度，$[X]$ 表示在过程中浓度随时间恒定的特定点缺陷种类的浓度，$[DX](t)$ 表示掺杂剂-缺陷复合物的浓度。假设空间均匀（无梯度）且掺杂剂布居封闭，因此总掺杂浓度是守恒的。该配对反应由可逆基元步骤 $D + X \\rightleftharpoons DX$ 描述，其中 $k_f(T)$ 是正向反应速率常数，单位为 $\\mathrm{cm^3/s}$，$k_r(T)$ 是逆向反应速率常数，单位为 $\\mathrm{s^{-1}}$。在整个退火过程中温度 $T$ 是恒定的（等温），因此在瞬态过程中 $k_f(T)$ 和 $k_r(T)$ 是常数。假设在所关注的时间窗口内，掺杂剂的团簇和沉淀可以忽略不计，因此掺杂剂只参与 $D + X \\rightleftharpoons DX$ 反应。\n\n从第一性原理出发，使用质量作用动力学和总掺杂剂守恒定律，推导出一个关于 $[DX](t)$（其中 $t \\ge 0$）的显式表达式。给定初始条件 $[DX](0) = [DX]_0$、常数 $[X]$、常数 $k_f(T)$ 和 $k_r(T)$，以及满足 $[D](t) + [DX](t) = [D]_{\\mathrm{tot}}$（对所有 $t$）的恒定总掺杂浓度 $[D]_{\\mathrm{tot}}$。您的程序必须实现所推导的表达式，并计算在指定时间的瞬态值。\n\n所有浓度必须以 $\\mathrm{cm^{-3}}$ 表示，所有时间以 $\\mathrm{s}$ 表示，$k_f(T)$ 以 $\\mathrm{cm^3/s}$ 表示，$k_r(T)$ 以 $\\mathrm{s^{-1}}$ 表示。输出必须列出每个测试用例在指定时间的 $[DX](t)$ 值，以 $\\mathrm{cm^{-3}}$ 为单位，并四舍五入到六位有效数字的小数形式。\n\n为以下测试套件提供结果，该套件涵盖了典型的、平衡的、不可逆的、纯解离的、无缺陷的和刚性动力学等情况：\n\n- 测试用例 1（典型可逆配对）：\n    - $[D]_{\\mathrm{tot}} = 1.0 \\times 10^{19}\\ \\mathrm{cm^{-3}}$\n    - $[X] = 5.0 \\times 10^{17}\\ \\mathrm{cm^{-3}}$\n    - $k_f(T) = 5.0 \\times 10^{-17}\\ \\mathrm{cm^3/s}$\n    - $k_r(T) = 2.0 \\times 10^{-1}\\ \\mathrm{s^{-1}}$\n    - $[DX]_0 = 1.0 \\times 10^{18}\\ \\mathrm{cm^{-3}}$\n    - 时间：$[0.0,\\ 0.01,\\ 0.1,\\ 1.0]\\ \\mathrm{s}$\n- 测试用例 2（初始平衡）：\n    - $[D]_{\\mathrm{tot}} = 1.0 \\times 10^{19}\\ \\mathrm{cm^{-3}}$\n    - $[X] = 5.0 \\times 10^{17}\\ \\mathrm{cm^{-3}}$\n    - $k_f(T) = 5.0 \\times 10^{-17}\\ \\mathrm{cm^3/s}$\n    - $k_r(T) = 2.0 \\times 10^{-1}\\ \\mathrm{s^{-1}}$\n    - $[DX]_0$ 等于与这些参数对应的平衡态 $[DX]$\n    - 时间：$[0.0,\\ 0.05,\\ 0.5]\\ \\mathrm{s}$\n- 测试用例 3（不可逆配对，其中 $k_r(T) = 0$）：\n    - $[D]_{\\mathrm{tot}} = 1.0 \\times 10^{19}\\ \\mathrm{cm^{-3}}$\n    - $[X] = 1.0 \\times 10^{17}\\ \\mathrm{cm^{-3}}$\n    - $k_f(T) = 1.0 \\times 10^{-16}\\ \\mathrm{cm^3/s}$\n    - $k_r(T) = 0.0\\ \\mathrm{s^{-1}}$\n    - $[DX]_0 = 1.0 \\times 10^{18}\\ \\mathrm{cm^{-3}}$\n    - 时间：$[0.0,\\ 0.1,\\ 0.5,\\ 1.0]\\ \\mathrm{s}$\n- 测试用例 4（纯解离，其中 $k_f(T) = 0$）：\n    - $[D]_{\\mathrm{tot}} = 1.0 \\times 10^{19}\\ \\mathrm{cm^{-3}}$\n    - $[X] = 5.0 \\times 10^{17}\\ \\mathrm{cm^{-3}}$\n    - $k_f(T) = 0.0\\ \\mathrm{cm^3/s}$\n    - $k_r(T) = 1.0\\ \\mathrm{s^{-1}}$\n    - $[DX]_0 = 3.0 \\times 10^{18}\\ \\mathrm{cm^{-3}}$\n    - 时间：$[0.0,\\ 0.5,\\ 1.0,\\ 2.0]\\ \\mathrm{s}$\n- 测试用例 5（无缺陷存在 $[X] = 0$）：\n    - $[D]_{\\mathrm{tot}} = 1.0 \\times 10^{19}\\ \\mathrm{cm^{-3}}$\n    - $[X] = 0.0\\ \\mathrm{cm^{-3}}$\n    - $k_f(T) = 1.0 \\times 10^{-16}\\ \\mathrm{cm^3/s}$\n    - $k_r(T) = 5.0 \\times 10^{-2}\\ \\mathrm{s^{-1}}$\n    - $[DX]_0 = 8.0 \\times 10^{18}\\ \\mathrm{cm^{-3}}$\n    - 时间：$[0.0,\\ 10.0,\\ 100.0]\\ \\mathrm{s}$\n- 测试用例 6（刚性快速配对，大 $[X]$ 和 $k_f(T)$）：\n    - $[D]_{\\mathrm{tot}} = 5.0 \\times 10^{18}\\ \\mathrm{cm^{-3}}$\n    - $[X] = 1.0 \\times 10^{19}\\ \\mathrm{cm^{-3}}$\n    - $k_f(T) = 1.0 \\times 10^{-15}\\ \\mathrm{cm^3/s}$\n    - $k_r(T) = 0.0\\ \\mathrm{s^{-1}}$\n    - $[DX]_0 = 0.0\\ \\mathrm{cm^{-3}}$\n    - 时间：$[0.0,\\ 1.0 \\times 10^{-5},\\ 1.0 \\times 10^{-4},\\ 1.0 \\times 10^{-3}]\\ \\mathrm{s}$\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，每个测试用例贡献一个子列表，其中包含在指定时间计算出的 $[DX](t)$ 值（单位为 $\\mathrm{cm^{-3}}$），并四舍五入到六位有效数字。例如，整体结构必须类似于 $[[\\dots],[\\dots],\\dots]$，不含任何额外文本。",
            "solution": "用户希望基于第一性原理动力学模型，找到掺杂剂-缺陷对浓度 $[DX](t)$ 作为时间函数的显式解析解。\n\n### 第 1 步：提取已知条件\n- 因变量：$[D](t)$ (自由掺杂剂浓度)，$[DX](t)$ (掺杂剂-缺陷复合物浓度)。\n- 自变量：$t$ (时间)。\n- 常数和参数：\n    - $[X]$：恒定的点缺陷种类浓度。\n    - $[D]_{\\mathrm{tot}}$：恒定的总掺杂浓度。\n    - $k_f(T)$：反应 $D + X \\rightarrow DX$ 的正向反应速率常数。\n    - $k_r(T)$：反应 $DX \\rightarrow D + X$ 的逆向反应速率常数。\n    - $[DX]_0$：$t=0$ 时掺杂剂-缺陷复合物的初始浓度。\n    - $T$：恒定温度（等温过程）。\n- 控制定律和条件：\n    - 反应动力学：该过程由可逆基元反应 $D + X \\rightleftharpoons DX$ 描述。\n    - 质量作用动力学：浓度变化率由质量作用定律控制。\n    - 总掺杂剂守恒：对于所有 $t \\ge 0$，$[D](t) + [DX](t) = [D]_{\\mathrm{tot}}$。\n    - 空间均匀性：所有浓度仅为时间的函数，与空间无关。\n    - 初始条件：$[DX](0) = [DX]_0$。\n\n### 第 2 步：使用提取的已知条件进行验证\n- **科学依据：** 该问题基于质量作用定律，这是化学动力学的基石，并应用于半导体材料科学中的一个标准问题（掺杂剂-缺陷相互作用）。该模型在物理上和科学上都是合理的。\n- **适定性：** 该问题要求解一个给定初始条件的一阶常微分方程。这样的问题（初值问题）是适定的，会有一个唯一且稳定的解。每个测试用例都提供了所有必要的参数。\n- **客观性：** 该问题以精确、定量和客观的科学语言陈述，没有任何主观性或歧义。\n- **完整性和一致性：** 该问题提供了一套完整的参数和一个守恒定律。从质量作用动力学推导出的速率方程与所述的守恒定律是一致的。\n    - $[DX]$ 的生成速率：$k_f [D][X]$。\n    - $[DX]$ 的解离速率：$k_r [DX]$。\n    - $[DX]$ 的净变化率：$\\frac{d[DX]}{dt} = k_f [D][X] - k_r [DX]$。\n    - $[D]$ 的净变化率：$\\frac{d[D]}{dt} = -k_f [D][X] + k_r [DX]$。\n    - 将这些速率相加：$\\frac{d}{dt}([D] + [DX]) = \\frac{d[D]}{dt} + \\frac{d[DX]}{dt} = 0$。这证实了 $[D](t) + [DX](t)$ 是一个常数，与给定的 $[D]_{\\mathrm{tot}}$ 一致。\n\n### 第 3 步：结论与行动\n该问题是有效的。这是一个定义明确、有科学依据的练习，旨在解决与半导体工艺建模相关的线性一阶常微分方程。我现在将进行推导和求解。\n\n### 解析解的推导\n\n掺杂剂-缺陷复合物浓度 $[DX](t)$ 的变化率由反应 $D + X \\rightleftharpoons DX$ 的质量作用定律给出：\n$$\n\\frac{d[DX]}{dt} = k_f [D][X] - k_r [DX]\n$$\n给定总掺杂浓度是守恒的：\n$$\n[D](t) + [DX](t) = [D]_{\\mathrm{tot}}\n$$\n我们可以用 $[DX](t)$ 和恒定的总掺杂浓度 $[D]_{\\mathrm{tot}}$ 来表示自由掺杂剂浓度 $[D](t)$：\n$$\n[D](t) = [D]_{\\mathrm{tot}} - [DX](t)\n$$\n将此 $[D](t)$ 的表达式代入速率方程，消去 $[D]$，得到一个仅含 $[DX](t)$ 的微分方程：\n$$\n\\frac{d[DX]}{dt} = k_f ([D]_{\\mathrm{tot}} - [DX])[X] - k_r [DX]\n$$\n这是一个一阶线性常微分方程。我们可以将其重新排列成标准形式 $\\frac{dy}{dt} + P(t)y = Q(t)$。\n$$\n\\frac{d[DX]}{dt} = k_f [D]_{\\mathrm{tot}} [X] - k_f [X][DX] - k_r [DX]\n$$\n$$\n\\frac{d[DX]}{dt} + (k_f [X] + k_r)[DX] = k_f [D]_{\\mathrm{tot}} [X]\n$$\n该常微分方程的形式为 $\\frac{dy}{dt} + ay = b$，其中 $y(t) = [DX](t)$，$a = k_f [X] + k_r$，$b = k_f [D]_{\\mathrm{tot}} [X]$。由于 $k_f$、$k_r$、$[X]$ 和 $[D]_{\\mathrm{tot}}$ 都是常数，因此 $a$ 和 $b$ 也是常数。\n\n这类常微分方程的通解是齐次解与特解之和。齐次方程为 $\\frac{dy_h}{dt} + ay_h = 0$，其解为 $y_h(t) = C e^{-at}$。对于常数强迫项 $b$，一个特解是常数 $y_p = b/a$。因此，通解为：\n$$\n[DX](t) = \\frac{b}{a} + C e^{-at} = \\frac{k_f [D]_{\\mathrm{tot}} [X]}{k_f [X] + k_r} + C e^{-(k_f [X] + k_r)t}\n$$\n常数 $C$ 由初始条件 $[DX](0) = [DX]_0$ 确定：\n$$\n[DX]_0 = \\frac{k_f [D]_{\\mathrm{tot}} [X]}{k_f [X] + k_r} + C e^0\n$$\n$$\nC = [DX]_0 - \\frac{k_f [D]_{\\mathrm{tot}} [X]}{k_f [X] + k_r}\n$$\n将此 $C$ 的表达式代回通解，得到 $[DX](t)$ 的最终显式表达式：\n$$\n[DX](t) = \\frac{k_f [D]_{\\mathrm{tot}} [X]}{k_f [X] + k_r} + \\left( [DX]_0 - \\frac{k_f [D]_{\\mathrm{tot}} [X]}{k_f [X] + k_r} \\right) e^{-(k_f [X] + k_r)t}\n$$\n该解可以通过定义复合物的平衡浓度 $[DX]_{\\mathrm{eq}}$ 来解释，即 $[DX](t)$ 在 $t \\to \\infty$ 时的值。在此极限下，指数项衰减为零：\n$$\n[DX]_{\\mathrm{eq}} = \\lim_{t\\to\\infty} [DX](t) = \\frac{k_f [D]_{\\mathrm{tot}} [X]}{k_f [X] + k_r}\n$$\n然后，该解可以更紧凑地写为：\n$$\n[DX](t) = [DX]_{\\mathrm{eq}} + ([DX]_0 - [DX]_{\\mathrm{eq}}) e^{-t/\\tau}\n$$\n其中反应的特征时间常数为 $\\tau = \\frac{1}{k_f [X] + k_r}$。这表明复合物浓度 $[DX](t)$ 以时间常数 $\\tau$ 从其初始值 $[DX]_0$ 指数松弛到其最终平衡值 $[DX]_{\\mathrm{eq}}$。\n\n这个推导出的单一公式是通用的，通过代入适当的参数值（例如，$k_r = 0$，$k_f = 0$，$ [X] = 0$），可以涵盖测试套件中提出的所有特殊情况。\n\n如果分母 $k_f [X] + k_r$ 为零，则会出现一个特殊的计算情况。这种情况仅在 $k_f[X]=0$ 且 $k_r=0$ 时发生（因为所有参数都是非负的）。在这种情况下，原始速率方程变为 $\\frac{d[DX]}{dt} = 0$，这意味着 $[DX](t)$ 是恒定的，等于其初始值 $[DX](t) = [DX]_0$。实现时应考虑这种边界情况，以避免除以零。\n\n### 实现计划\nPython 程序将实现推导出的解析解。\n1.  将创建一个函数 `calculate_dx_transient`，用于根据给定的参数集和时间列表，基于推导的公式计算 $[DX](t)$。\n2.  主函数 `solve` 将定义问题陈述中的六个测试用例。\n3.  对于测试用例 2，其中 $[DX]_0$ 被指定为平衡值，程序将首先计算 $[DX]_{\\mathrm{eq}}$ 并将其用作初始条件。\n4.  程序将遍历每个测试用例，调用计算函数。\n5.  在计算内部，它将处理 $k_f[X] + k_r = 0$ 的特殊情况。\n6.  每个时间点的结果将被格式化为六位有效数字。\n7.  最终输出将是包含列表的列表的单行，其格式与要求完全一致。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the transient concentration of dopant-defect pairs [DX](t)\n    for a series of test cases based on an analytical solution.\n    \"\"\"\n    test_cases = [\n        {\n            # Test case 1 (typical reversible pairing)\n            'D_tot': 1.0e19, 'X': 5.0e17, 'kf': 5.0e-17, 'kr': 2.0e-1,\n            'DX0': 1.0e18, 'times': [0.0, 0.01, 0.1, 1.0]\n        },\n        {\n            # Test case 2 (initial equilibrium)\n            'D_tot': 1.0e19, 'X': 5.0e17, 'kf': 5.0e-17, 'kr': 2.0e-1,\n            'DX0': 'equilibrium', 'times': [0.0, 0.05, 0.5]\n        },\n        {\n            # Test case 3 (irreversible pairing with kr(T) = 0)\n            'D_tot': 1.0e19, 'X': 1.0e17, 'kf': 1.0e-16, 'kr': 0.0,\n            'DX0': 1.0e18, 'times': [0.0, 0.1, 0.5, 1.0]\n        },\n        {\n            # Test case 4 (pure dissociation with kf(T) = 0)\n            'D_tot': 1.0e19, 'X': 5.0e17, 'kf': 0.0, 'kr': 1.0,\n            'DX0': 3.0e18, 'times': [0.0, 0.5, 1.0, 2.0]\n        },\n        {\n            # Test case 5 (no defects present [X] = 0)\n            'D_tot': 1.0e19, 'X': 0.0, 'kf': 1.0e-16, 'kr': 5.0e-2,\n            'DX0': 8.0e18, 'times': [0.0, 10.0, 100.0]\n        },\n        {\n            # Test case 6 (stiff fast pairing, large [X] and kf(T))\n            'D_tot': 5.0e18, 'X': 1.0e19, 'kf': 1.0e-15, 'kr': 0.0,\n            'DX0': 0.0, 'times': [0.0, 1.0e-5, 1.0e-4, 1.0e-3]\n        },\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        D_tot = case['D_tot']\n        X = case['X']\n        kf = case['kf']\n        kr = case['kr']\n        DX0_val = case['DX0']\n        times = case['times']\n        \n        # Effective rate constant for the exponential decay\n        k_eff = kf * X + kr\n\n        if k_eff == 0.0:\n            # If both forward and reverse rates are zero, concentration is constant.\n            # a=0, b=0 -> d[DX]/dt = 0 -> [DX](t) = [DX]0\n            DX_eq = 0.0 # Not well-defined, but won't be used\n            DX0 = DX0_val\n        else:\n            # Equilibrium concentration of the complex\n            DX_eq = (kf * D_tot * X) / k_eff\n            \n            # For Test Case 2, the initial condition is the equilibrium value.\n            if DX0_val == 'equilibrium':\n                DX0 = DX_eq\n            else:\n                DX0 = DX0_val\n\n        case_results = []\n        for t in times:\n            if k_eff == 0.0:\n                DX_t = DX0\n            else:\n                # Analytical solution: DX(t) = DX_eq + (DX0 - DX_eq) * np.exp(-k_eff * t)\n                DX_t = DX_eq + (DX0 - DX_eq) * np.exp(-k_eff * t)\n\n            # Format to 6 significant figures\n            if DX_t == 0:\n                formatted_result = 0.0\n            else:\n                # Use 'g' format specifier for significant figures and convert back to float\n                formatted_result = float(format(DX_t, '.6g'))\n            case_results.append(formatted_result)\n        \n        all_results.append(case_results)\n\n    # Format the final output string as [[...], [...], ...]\n    output_str = \"[\" + \",\".join([f\"[{','.join(map(str, res))}]\" for res in all_results]) + \"]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "真实的半导体系统通常比单一的掺杂剂-缺陷对要复杂得多，常常涉及到一系列不同尺寸的团簇。这项高级练习旨在挑战你对更复杂系统的建模能力，你需要计算在多个不同价态的空位-缺陷复合物中，掺杂剂原子的平衡分布。这个问题将引导你从简单的解析解转向建立并求解非线性方程组，这是开发精密的工艺模型所必需的计算技能。",
            "id": "4123446",
            "problem": "您的任务是编写一个完整、可运行的程序，在理想稀释极限下，计算固定温度下晶体硅中砷掺杂剂在替代位砷及其空位束缚复合物之间的平衡分布。具体而言，给定总砷浓度和列表形式的结合自由能，计算砷原子在 $As$、$AsV$、$As_2V$ 和 $As_3V$ 这几种物质中的分数。\n\n该程序必须基于以下基本原理，所有原理均在适用于晶体固体中点缺陷的理想溶液（位点分数）框架内表述：\n- 由平衡状态下各基元结合步骤的化学势相等推导出的质量作用定律。\n- 由标准自由能变定义的平衡常数。\n- 砷原子总数守恒。\n\n考虑替代位砷与硅空位连续发生的结合反应：\n- $As + V \\rightleftharpoons AsV$,\n- $As + AsV \\rightleftharpoons As_2V$,\n- $As + As_2V \\rightleftharpoons As_3V$.\n\n将 $x_{As}$、$x_V$、$x_{AsV}$、$x_{As_2V}$ 和 $x_{As_3V}$ 定义为硅晶格上每种物质的位点分数（每个位点的数量）。设 $N$ 为硅晶格位点密度。您必须假定硅晶格位点密度为常数 $N = 5\\times 10^{22}$，单位为 $\\mathrm{cm}^{-3}$，并且所有提供的浓度单位均为 $\\mathrm{cm}^{-3}$。温度固定为 $T = 1273$，单位为 $\\mathrm{K}$。玻尔兹曼常数为 $k_B = 8.617333262145\\times 10^{-5}$，单位为 $\\mathrm{eV/K}$。三个结合步骤的结合自由能以 $(\\Delta G_1, \\Delta G_2, \\Delta G_3)$ 的形式给出，单位为 $\\mathrm{eV}$。平衡常数通过标准自由能变定义为 $K_i = \\exp\\!\\left(-\\Delta G_i/(k_B T)\\right)$，在位点分数框架下，这些常数是无量纲的。\n\n仅从以下条件出发：\n- 应用于结合步骤的质量作用定律，用位点分数和无量纲平衡常数表示：\n  $x_{AsV} = K_1\\, x_{As}\\, x_V$, $x_{As_2V} = K_2\\, x_{As}\\, x_{AsV}$, $x_{As_3V} = K_3\\, x_{As}\\, x_{As_2V}$。\n- 总砷守恒，用位点分数表示：\n  $x_{As,\\mathrm{tot}} = x_{As} + x_{AsV} + 2\\,x_{As_2V} + 3\\,x_{As_3V}$，其中 $x_{As,\\mathrm{tot}} = C_{As,\\mathrm{tot}}/N$，$C_{As,\\mathrm{tot}}$ 是总砷浓度，$N$ 是位点密度。\n\n推导、实现并求解得到的关于 $x_{As}$ 的非线性方程，然后计算每种物质中砷原子的分数：\n- $f_{As} = x_{As}/x_{As,\\mathrm{tot}}$,\n- $f_{AsV} = x_{AsV}/x_{As,\\mathrm{tot}}$,\n- $f_{As_2V} = 2\\,x_{As_2V}/x_{As,\\mathrm{tot}}$,\n- $f_{As_3V} = 3\\,x_{As_3V}/x_{As,\\mathrm{tot}}$.\n\n所有分数必须以小数形式（而非百分比）返回。在最终输出中，将每个分数四舍五入到 $6$ 位小数。\n\n您的程序必须仅使用所提供的基础，实现一个稳健的数值方法，保证对物理上允许的输入收敛。为保证数值稳定性，将 $x_{As}$ 的解域限制在区间 $[0, x_{As,\\mathrm{tot}}]$ 内；根据晶体硅中掺杂剂和缺陷位点分数的实际情况，假定 $x_{As,\\mathrm{tot}} \\ll 1$。\n\n使用以下参数集测试套件，所有测试均在 $T = 1273$（单位 K）和 $N = 5\\times 10^{22}$（单位 $\\mathrm{cm}^{-3}$）的条件下进行：\n- 测试用例 1：$C_{As,\\mathrm{tot}} = 1\\times 10^{20}$（单位 $\\mathrm{cm}^{-3}$），$C_V = 1\\times 10^{13}$（单位 $\\mathrm{cm}^{-3}$），$(\\Delta G_1, \\Delta G_2, \\Delta G_3) = (-0.40, -0.30, -0.20)$（单位 $\\mathrm{eV}$）。\n- 测试用例 2：$C_{As,\\mathrm{tot}} = 1\\times 10^{14}$（单位 $\\mathrm{cm}^{-3}$），$C_V = 1\\times 10^{13}$（单位 $\\mathrm{cm}^{-3}$），$(\\Delta G_1, \\Delta G_2, \\Delta G_3) = (-0.40, -0.30, -0.20)$（单位 $\\mathrm{eV}$）。\n- 测试用例 3：$C_{As,\\mathrm{tot}} = 5\\times 10^{20}$（单位 $\\mathrm{cm}^{-3}$），$C_V = 1\\times 10^{17}$（单位 $\\mathrm{cm}^{-3}$），$(\\Delta G_1, \\Delta G_2, \\Delta G_3) = (-0.40, -0.30, -0.20)$（单位 $\\mathrm{eV}$）。\n- 测试用例 4：$C_{As,\\mathrm{tot}} = 1\\times 10^{20}$（单位 $\\mathrm{cm}^{-3}$），$C_V = 1\\times 10^{15}$（单位 $\\mathrm{cm}^{-3}$），$(\\Delta G_1, \\Delta G_2, \\Delta G_3) = (+0.05, +0.05, +0.05)$（单位 $\\mathrm{eV}$）。\n\n您的程序应生成单行输出，其中包含结果，格式为一个由方括号括起来的、包含四个元素的列表的逗号分隔列表。每个四元素列表对应一个测试用例，并且必须按 $[f_{As}, f_{AsV}, f_{As_2V}, f_{As_3V}]$ 的顺序列出。例如，输出格式必须与 $[[a_1,b_1,c_1,d_1],[a_2,b_2,c_2,d_2],[a_3,b_3,c_3,d_3],[a_4,b_4,c_4,d_4]]$ 完全相同，其中每个 $a_i, b_i, c_i, d_i$ 都是四舍五入到 $6$ 位小数的小数。",
            "solution": "该问题旨在计算在固定温度下，晶体硅中砷掺杂原子在各种物质（$As$, $AsV$, $As_2V$, $As_3V$）之间的平衡分布。此问题在用于点缺陷的理想溶液框架内进行阐述，使用了位点分数和质量作用定律。\n\n### 问题验证\n首先，对问题陈述的有效性进行严格评估。\n\n**1. 提取的已知条件：**\n-   基本原理：质量作用定律，由标准自由能变得到的平衡常数，总砷守恒。\n-   反应：$As + V \\rightleftharpoons AsV$, $As + AsV \\rightleftharpoons As_2V$, $As + As_2V \\rightleftharpoons As_3V$。\n-   位点分数：$x_{As}$, $x_V$, $x_{AsV}$, $x_{As_2V}$, $x_{As_3V}$。\n-   常数：硅晶格位点密度 $N = 5\\times 10^{22} \\, \\mathrm{cm}^{-3}$，温度 $T = 1273 \\, \\mathrm{K}$，玻尔兹曼常数 $k_B = 8.617333262145\\times 10^{-5} \\, \\mathrm{eV/K}$。\n-   输入：结合自由能 $(\\Delta G_1, \\Delta G_2, \\Delta G_3)$（单位 eV），总砷浓度 $C_{As,\\mathrm{tot}}$，以及一个与空位相关的浓度 $C_V$。\n-   关键方程：\n    -   $K_i = \\exp(-\\Delta G_i/(k_B T))$\n    -   $x_{AsV} = K_1\\, x_{As}\\, x_V$, $x_{As_2V} = K_2\\, x_{As}\\, x_{AsV}$, $x_{As_3V} = K_3\\, x_{As}\\, x_{As_2V}$\n    -   $x_{As,\\mathrm{tot}} = x_{As} + x_{AsV} + 2\\,x_{As_2V} + 3\\,x_{As_3V}$\n-   输出：砷原子的分数 $f_{As}$, $f_{AsV}$, $f_{As_2V}$, $f_{As_3V}$。\n\n**2. 验证分析：**\n该问题在科学上基于标准的固态物理学和点缺陷热力学。所提供的模型和参数在物理上是现实的。验证的核心在于问题是否适定 (well-posed)。该系统涉及五个未知的位点分数（$x_{As}$, $x_{V}$, $x_{AsV}$, $x_{As_2V}$, $x_{As_3V}$）。问题明确给出了三个质量作用关系和一个砷守恒定律，总共四个方程。这是一个欠定系统。\n\n然而，测试用例为参数 $C_V$ 提供了数值。问题陈述对于 $C_V$ 的精确定义存在关键性的模糊之处。它可能代表总空位浓度 $C_{V,\\mathrm{tot}}$，这将需要第五个方程，即空位守恒方程（$x_{V,\\mathrm{tot}} = x_V + x_{AsV} + x_{As_2V} + x_{As_3V}$）。但这将与*仅*从给定定律出发的严格指令相矛盾。\n\n另一种更一致的解释是，$C_V$ 代表自由、未形成复合物的空位浓度，即 $[V] \\cdot N$。这意味着自由空位的位点分数 $x_V = C_V/N$ 对于每个案例都是一个固定的输入参数。这是一种常见的物理近似，即假设某种反应物的浓度恒定，由一个大的“缓冲池”或外部平衡所维持。这种解释消除了歧义，使问题在陈述的条件下变得可解（将其简化为关于 $x_{As}$ 的单个非线性方程），并且不违反“仅从……出发”的约束。\n\n在这种解释下，该问题是适定的。可以证明，所得到的关于 $x_{As}$ 的多项式方程在指定的求解区间 $[0, x_{As,\\mathrm{tot}}]$ 内有唯一且具有物理意义的根。\n\n**3. 结论：**\n问题被判定为**有效**，并明确澄清输入参数 $C_V$ 被解释为自由空位的浓度，从而固定了 $x_V$ 的值。\n\n### 解法推导\n求解过程首先推导出关于自由替代位砷位点分数 $x_{As}$ 的单个非线性方程，然后对其进行数值求解。\n\n**1. 平衡常数和位点分数的表达式**\n位点密度为 $N=5 \\times 10^{22} \\, \\mathrm{cm}^{-3}$，温度为 $T=1273 \\, \\mathrm{K}$。玻尔兹曼常数 $k_B$ 与温度 $T$ 的乘积是一个有用的能量尺度：\n$$k_B T = (8.617333262145\\times 10^{-5} \\, \\mathrm{eV/K}) \\times (1273 \\, \\mathrm{K}) \\approx 0.10966 \\, \\mathrm{eV}$$\n无量纲平衡常数 $K_i$ 计算如下：\n$$K_i = \\exp\\left(-\\frac{\\Delta G_i}{k_B T}\\right) \\quad \\text{for } i \\in \\{1, 2, 3\\}$$\n位点分数通过将浓度除以位点密度 $N$ 来定义。将给定的输入 $C_{As,\\mathrm{tot}}$ 和 $C_V$ 转换为位点分数：\n$$x_{As,\\mathrm{tot}} = \\frac{C_{As,\\mathrm{tot}}}{N}$$\n$$x_V = \\frac{C_V}{N}$$\n如前所述，$x_V$ 在每个测试用例中被视为已知常数。\n\n**2. 将复合物分数与自由砷分数关联**\n使用质量作用定律关系式，我们将复合物的位点分数用未知的自由砷位点分数 $x_{As}$ 和已知的自由空位位点分数 $x_V$ 来表示。\n$$x_{AsV} = K_1 x_{As} x_V$$\n通过逐次代换：\n$$x_{As_2V} = K_2 x_{As} x_{AsV} = K_2 x_{As} (K_1 x_{As} x_V) = K_1 K_2 x_{As}^2 x_V$$\n$$x_{As_3V} = K_3 x_{As} x_{As_2V} = K_3 x_{As} (K_1 K_2 x_{As}^2 x_V) = K_1 K_2 K_3 x_{As}^3 x_V$$\n\n**3. 砷守恒方程**\n砷的总量是守恒的。问题提供了守恒定律，该定律将存在于每种物质中的砷原子相加：\n$$x_{As,\\mathrm{tot}} = x_{As} + x_{AsV} + 2x_{As_2V} + 3x_{As_3V}$$\n代入上一步的表达式，得到一个只含 $x_{As}$ 的单一方程：\n$$x_{As,\\mathrm{tot}} = x_{As} + (K_1 x_V) x_{As} + 2(K_1 K_2 x_V) x_{As}^2 + 3(K_1 K_2 K_3 x_V) x_{As}^3$$\n这可以重新排列成一个标准的三次多项式形式 $f(x_{As}) = 0$：\n$$3(K_1 K_2 K_3 x_V) x_{As}^3 + 2(K_1 K_2 x_V) x_{As}^2 + (1 + K_1 x_V) x_{As} - x_{As,\\mathrm{tot}} = 0$$\n\n**4. 数值解和最终计算**\n必须求解这个三次方程以得到 $x_{As}$。由于所有平衡常数 $K_i$ 和位点分数都是非负的，因此 $x_{As}$ 多项式各项的系数也是非负的。因此，函数 $f(x_{As})$ 对于 $x_{As} \\ge 0$ 是单调递增的。由于 $f(0) = -x_{As,\\mathrm{tot}}  0$ 且 $f(x_{As,\\mathrm{tot}}) \\ge 0$，可以保证在具有物理意义的区间 $[0, x_{As,\\mathrm{tot}}]$ 内存在唯一的根。\n像 Brent 方法这样的稳健求根算法适合求解 $x_{As}$。一旦找到解 $x_{As}^*$，就可以使用第 2 步中的表达式计算复合物的平衡位点分数。\n\n最后，计算每种物质中所需的砷原子分数。这些是给定物质中的砷原子数与总砷原子数的比率：\n-   $f_{As} = \\frac{x_{As}^*}{x_{As,\\mathrm{tot}}}$\n-   $f_{AsV} = \\frac{x_{AsV}}{x_{As,\\mathrm{tot}}} = \\frac{K_1 x_{As}^* x_V}{x_{As,\\mathrm{tot}}}$\n-   $f_{As_2V} = \\frac{2x_{As_2V}}{x_{As,\\mathrm{tot}}} = \\frac{2K_1 K_2 (x_{As}^*)^2 x_V}{x_{As,\\mathrm{tot}}}$\n-   $f_{As_3V} = \\frac{3x_{As_3V}}{x_{As,\\mathrm{tot}}} = \\frac{3K_1 K_2 K_3 (x_{As}^*)^3 x_V}{x_{As,\\mathrm{tot}}}$\n根据守恒方程的构造，这些分数的总和必须等于 $1$。程序实现将为每个测试用例计算这些值，将它们四舍五入到 $6$ 位小数，并按指定格式输出。",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves for the equilibrium distribution of arsenic dopant-vacancy complexes in silicon.\n    \"\"\"\n    # Define constants\n    N = 5e22  # Silicon lattice site density in cm^-3\n    T = 1273.0  # Temperature in K\n    KB = 8.617333262145e-5  # Boltzmann constant in eV/K\n    \n    # Test suite of parameter sets\n    test_cases = [\n        # (C_As_tot [cm^-3], C_V [cm^-3], (dG1, dG2, dG3) [eV])\n        (1e20, 1e13, (-0.40, -0.30, -0.20)),\n        (1e14, 1e13, (-0.40, -0.30, -0.20)),\n        (5e20, 1e17, (-0.40, -0.30, -0.20)),\n        (1e20, 1e15, (+0.05, +0.05, +0.05)),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        C_As_tot, C_V, delta_G = case\n        \n        # 1. Calculate constants and site fractions\n        kBT = KB * T\n        x_As_tot = C_As_tot / N\n        x_V = C_V / N  # Based on interpretation of C_V as free vacancy concentration\n\n        K_vals = np.exp(-np.array(delta_G) / kBT)\n        K1, K2, K3 = K_vals[0], K_vals[1], K_vals[2]\n        \n        # 2. Define the polynomial function for x_As\n        # f(x_As) = A*x_As^3 + B*x_As^2 + C*x_As + D = 0\n        A = 3 * K1 * K2 * K3 * x_V\n        B = 2 * K1 * K2 * x_V\n        C = 1 + K1 * x_V\n        D = -x_As_tot\n        \n        def f(x_as):\n            return A * x_as**3 + B * x_as**2 + C * x_as + D\n\n        # 3. Solve for the root x_As in the interval [0, x_As_tot]\n        # The bracket is valid as f(0)  0 and f(x_As_tot) = 0.\n        try:\n            x_As_star = brentq(f, 0, x_As_tot)\n        except ValueError:\n            # Under extreme conditions, rounding could make f(0) and f(x_As_tot) have same sign.\n            # E.g., if x_As_tot is extremely small.\n            # A more robust search interval might be needed in general,\n            # but for this problem set [0, x_As_tot] is sufficient.\n            # As a fallback, check the bounds. f(0) is always = 0. If f(x_As_tot)  0,\n            # it implies x_As  x_As_tot which is unphysical.\n            # This should not happen for physically reasonable inputs.\n            # In this problem set, the bracket is always valid.\n            raise\n            \n        # 4. Calculate equilibrium site fractions of complexes\n        x_AsV = K1 * x_As_star * x_V\n        x_As2V = K1 * K2 * x_As_star**2 * x_V\n        x_As3V = K1 * K2 * K3 * x_As_star**3 * x_V\n\n        # 5. Calculate the final fractions of arsenic atoms\n        f_As = x_As_star / x_As_tot\n        f_AsV = x_AsV / x_As_tot\n        f_As2V = 2 * x_As2V / x_As_tot\n        f_As3V = 3 * x_As3V / x_As_tot\n        \n        # The sum f_As + f_AsV + f_As2V + f_As3V should be 1.0 by construction.\n        \n        case_result = [f_As, f_AsV, f_As2V, f_As3V]\n        \n        # 6. Round results and append to the list\n        rounded_result = [round(val, 6) for val in case_result]\n        results.append(rounded_result)\n\n    # Final print statement in the exact required format\n    # The map(str, results) converts each inner list to its string representation.\n    # e.g., [0.999..., ...] - '[0.999..., ...]'\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}