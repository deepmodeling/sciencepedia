{
    "hands_on_practices": [
        {
            "introduction": "高斯分布是离子注入最基础、最重要的模型。第一个练习将通过对高斯函数本身及其代表的总注入剂量的物理约束，推导其两个最关键的特征参数：峰值浓度及其位置。这项实践有助于您直观地理解模型参数（如注入剂量 $Q$、平均射程 $R_p$ 和射程离散 $\\Delta R_p$）是如何与最终的物理浓度分布联系起来的。",
            "id": "4107201",
            "problem": "在半导体制造的离子注入过程中，注入后晶体衬底中的掺杂剂浓度分布可以在一维（1D）上通过一个正态（高斯）深度分布来建模，该分布源于离子阻止和射程离散的随机性。设平均投影射程为 $R_p$，标准差（射程离散）为 $\\Delta R_p$。单位面积的注入剂量为 $Q$，其定义为浓度分布对深度的积分。假设沟道效应可忽略，并且 $R_p \\gg \\Delta R_p$，因此衬底表面不会显著截断该分布，从而可以将积分域扩展到整个实数轴以进行归一化。\n\n在高斯模型下，浓度分布的形式为 $C(x) = A \\exp\\big(-\\frac{(x - R_p)^{2}}{2 \\Delta R_p^{2}}\\big)$，其中 $A$ 是一个振幅，需要根据剂量约束 $\\int_{0}^{\\infty} C(x)\\,dx = Q$ 和所述的近似方法来确定。从这些基本原理出发：\n- 使用微积分确定 $C(x)$ 取得最大值的位置 $x_{\\max}$，并确认该极值是最大值而非最小值。\n- 应用剂量约束，用 $Q$ 和 $\\Delta R_p$ 表示 $A$，并由此得到峰值浓度 $C_{\\max} = C(x_{\\max})$。\n- 将您的最终答案表示为包含 $x_{\\max}$ 和 $C_{\\max}$ 的闭合形式的单行矩阵。最终答案中不包含单位。",
            "solution": "该问题是有效的，因为它在科学上基于离子注入的标准模型，数学上是适定的、客观的且内部一致的。\n\n目标是对于给定的高斯浓度分布，求出最大浓度的深度 $x_{\\max}$ 和这个峰值浓度的值 $C_{\\max}$。\n\n浓度分布由以下函数给出：\n$$C(x) = A \\exp\\left(-\\frac{(x - R_p)^{2}}{2 \\Delta R_p^{2}}\\right)$$\n其中 $R_p$ 是平均投影射程，$\\Delta R_p$ 是标准差（射程离散），$A$ 是振幅。\n\n首先，我们确定最大浓度的位置 $x_{\\max}$。这是通过求 $C(x)$ 对 $x$ 的一阶导数并将其设为零来找到的。\n使用链式法则进行微分，令 $u(x) = -\\frac{(x - R_p)^{2}}{2 \\Delta R_p^{2}}$。$u(x)$ 的导数是 $\\frac{du}{dx} = -\\frac{2(x - R_p)}{2 \\Delta R_p^{2}} = -\\frac{x - R_p}{\\Delta R_p^{2}}$。\n那么 $C(x)$ 的导数是：\n$$\\frac{dC}{dx} = A \\cdot \\exp\\left(-\\frac{(x - R_p)^{2}}{2 \\Delta R_p^{2}}\\right) \\cdot \\left(-\\frac{x - R_p}{\\Delta R_p^{2}}\\right)$$\n令 $\\frac{dC}{dx} = 0$ 以寻找临界点：\n$$-A \\frac{x - R_p}{\\Delta R_p^{2}} \\exp\\left(-\\frac{(x - R_p)^{2}}{2 \\Delta R_p^{2}}\\right) = 0$$\n由于 $A$ 是一个正振幅，$\\Delta R_p^{2}$ 是正的，且指数项总是正的，所以该表达式只能在 $(x - R_p)$ 项为零时才为零。\n$$x - R_p = 0 \\implies x = R_p$$\n因此，唯一的临界点出现在 $x = R_p$ 处。\n\n为了确认这是一个最大值，我们考察在 $x = R_p$ 处的二阶导数 $\\frac{d^2C}{dx^2}$。对 $\\frac{dC}{dx}$ 的表达式使用乘积法则：\n$$\\frac{d^2C}{dx^2} = -\\frac{A}{\\Delta R_p^{2}} \\left[ \\frac{d}{dx}(x-R_p) \\cdot \\exp\\left(-\\frac{(x - R_p)^{2}}{2 \\Delta R_p^{2}}\\right) + (x-R_p) \\cdot \\frac{d}{dx}\\exp\\left(-\\frac{(x - R_p)^{2}}{2 \\Delta R_p^{2}}\\right) \\right]$$\n$$\\frac{d^2C}{dx^2} = -\\frac{A}{\\Delta R_p^{2}} \\left[ \\exp\\left(-\\frac{(x - R_p)^{2}}{2 \\Delta R_p^{2}}\\right) - \\frac{(x-R_p)^2}{\\Delta R_p^{2}}\\exp\\left(-\\frac{(x - R_p)^{2}}{2 \\Delta R_p^{2}}\\right) \\right]$$\n提出指数项：\n$$\\frac{d^2C}{dx^2} = -\\frac{A}{\\Delta R_p^{2}} \\exp\\left(-\\frac{(x - R_p)^{2}}{2 \\Delta R_p^{2}}\\right) \\left[ 1 - \\frac{(x-R_p)^2}{\\Delta R_p^{2}} \\right]$$\n现在，在临界点 $x=R_p$ 处计算该式的值：\n$$\\left.\\frac{d^2C}{dx^2}\\right|_{x=R_p} = -\\frac{A}{\\Delta R_p^{2}} \\exp(0) \\left[ 1 - 0 \\right] = -\\frac{A}{\\Delta R_p^{2}}$$\n由于 $A > 0$ 且 $\\Delta R_p^2 > 0$，二阶导数为负。这证实了 $x = R_p$ 对应一个最大值。因此，峰值浓度的位置是：\n$$x_{\\max} = R_p$$\n\n接下来，我们使用剂量约束 $Q = \\int_{0}^{\\infty} C(x)\\,dx$ 来确定振幅 $A$。题目中说明，由于 $R_p \\gg \\Delta R_p$，我们可以通过将积分下限扩展到 $-\\infty$ 来近似该积分：\n$$Q \\approx \\int_{-\\infty}^{\\infty} C(x)\\,dx = \\int_{-\\infty}^{\\infty} A \\exp\\left(-\\frac{(x - R_p)^{2}}{2 \\Delta R_p^{2}}\\right)\\,dx$$\n$$Q = A \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{(x - R_p)^{2}}{2 (\\Delta R_p)^{2}}\\right)\\,dx$$\n这是一个形式为 $\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{(x-\\mu)^2}{2\\sigma^2}\\right)\\,dx = \\sigma\\sqrt{2\\pi}$ 的标准高斯积分。这里，我们的均值是 $\\mu = R_p$，标准差是 $\\sigma = \\Delta R_p$。\n因此，该积分的值是 $\\Delta R_p \\sqrt{2\\pi}$。\n将此结果代回到 $Q$ 的方程中：\n$$Q = A (\\Delta R_p \\sqrt{2\\pi})$$\n解出振幅 $A$：\n$$A = \\frac{Q}{\\sqrt{2\\pi} \\Delta R_p}$$\n\n最后，我们求出峰值浓度 $C_{\\max}$，即 $C(x)$ 在 $x=x_{\\max}$ 处的值。\n$$C_{\\max} = C(x_{\\max}) = C(R_p)$$\n$$C_{\\max} = A \\exp\\left(-\\frac{(R_p - R_p)^{2}}{2 \\Delta R_p^{2}}\\right) = A \\exp(0) = A$$\n因此，峰值浓度等于振幅 $A$。\n$$C_{\\max} = \\frac{Q}{\\sqrt{2\\pi} \\Delta R_p}$$\n所求的两个量是 $x_{\\max} = R_p$ 和 $C_{\\max} = \\frac{Q}{\\sqrt{2\\pi} \\Delta R_p}$。最终答案应表示为一个行矩阵。",
            "answer": "$$\\boxed{\\begin{pmatrix} R_p  \\frac{Q}{\\sqrt{2 \\pi} \\Delta R_p} \\end{pmatrix}}$$"
        },
        {
            "introduction": "现实世界中的离子注入是进入一个半无限大的固体，而非无限延伸的空间。这项练习将引入“反射”边界来处理晶圆表面的物理现实。您将使用镜像法来修正简单的高斯模型，以确保没有离子从表面损失，这是建立更真实浓度分布的关键一步。",
            "id": "4107229",
            "problem": "在对晶体半导体进行的一维离子注入中，对于无界介质，由于中心极限定理适用于大量独立的小角度散射事件，注入后的浓度分布通常用高斯函数来建模。设坐标 $x$ 表示从 $x=0$ 处的晶圆表面测量到固体内部的深度，其中 $x \\ge 0$ 是物理上可及的区域。对应于总面剂量 $Q$、投影射程 $R_{p}$ 和标准差（离散度）$\\Delta R_{p}$ 的自由空间高斯分布为\n$$\nC_{G}(x) = \\frac{Q}{\\sqrt{2\\pi}\\,\\Delta R_{p}} \\exp\\left(-\\frac{(x - R_{p})^{2}}{2\\,\\Delta R_{p}^{2}}\\right), \\quad x \\in \\mathbb{R}.\n$$\n为了表示在具有反射表面 $x=0$ 的半无限介质中的注入，我们在表面施加一个零通量（Neumann）边界条件，这等效于一个零法向梯度条件 $\\partial C/\\partial x \\big|_{x=0} = 0$，并要求在 $x \\ge 0$ 上总剂量 $Q$ 守恒。从这些原理出发，且不援引任何预先推导的镜像公式，请推导出一个对所有 $x \\ge 0$ 均有效的修正浓度分布 $C(x)$ 的闭式解析表达式。\n\n请用 $x$、$Q$、$R_{p}$ 和 $\\Delta R_{p}$ 通过初等函数将最终答案表示为单一的简化表达式。无需进行数值计算，最终表达式中不应包含任何单位。最终答案必须是单一的解析表达式。",
            "solution": "该问题要求推导在半无限介质（$x \\ge 0$）中注入物质的一维浓度分布 $C(x)$。推导必须基于基本原理，具体来说，即表面（$x=0$）的零通量边界条件和总注入剂量的守恒。\n\n对于解 $C(x)$（$x \\ge 0$），给出的要求如下：\n1.  表面法向梯度为零：$\\frac{\\partial C}{\\partial x} \\bigg|_{x=0} = 0$。这是一个 Neumann 边界条件，物理上表示一个没有粒子损失的反射表面。\n2.  在半无限域内总注入剂量 $Q$ 守恒：$\\int_{0}^{\\infty} C(x) \\, dx = Q$。\n3.  函数形式应基于离子阻止的物理过程，该过程在无界介质中由给定的高斯分布建模。\n\n这个问题可以通过使用镜像法来解决。我们通过叠加基本解（高斯函数）来构造一个在整个实数轴 $x \\in \\mathbb{R}$ 上有效的解 $\\tilde{C}(x)$。那么，在 $x \\ge 0$ 上的物理解 $C(x)$ 就是 $\\tilde{C}(x)$ 在该域上的限制。\n\nNeumann 边界条件 $\\frac{\\partial C}{\\partial x} \\big|_{x=0} = 0$ 意味着扩展函数 $\\tilde{C}(x)$ 必须是关于 $x=0$ 的偶函数，即 $\\tilde{C}(x) = \\tilde{C}(-x)$。如果一个偶函数在原点可导，那么它在原点的导数为零。\n\n自由空间高斯分布 $C_G(x)$ 表示以投影射程 $x=R_p$ 为中心的剂量 $Q$ 的分布。为了构造一个偶函数 $\\tilde{C}(x)$，我们可以将来自 $x=R_p$ 处的物理源的分布与来自一个相对于边界 $x=0$ 对称放置的虚拟“镜像”源的分布进行叠加。因此，镜像源位于 $x=-R_p$。为了保持偶对称性，镜像源必须具有相同的符号和大小。\n\n设扩展分布的形式是两个高斯函数之和，一个以 $x=R_p$ 为中心，另一个以 $x=-R_p$ 为中心，带有一个待定的归一化常数 $A$：\n$$\n\\tilde{C}(x) = A \\left[ \\exp\\left(-\\frac{(x - R_{p})^{2}}{2\\Delta R_{p}^{2}}\\right) + \\exp\\left(-\\frac{(x + R_{p})^{2}}{2\\Delta R_{p}^{2}}\\right) \\right]\n$$\n这个函数显然是偶函数，因为用 $-x$ 替换 $x$ 后表达式保持不变。我们来验证它在 $x=0$ 处的导数为零。\n$$\n\\frac{d\\tilde{C}}{dx} = A \\left[ \\exp\\left(-\\frac{(x - R_{p})^{2}}{2\\Delta R_{p}^{2}}\\right) \\left(\\frac{-(x-R_p)}{\\Delta R_p^2}\\right) + \\exp\\left(-\\frac{(x + R_{p})^{2}}{2\\Delta R_{p}^{2}}\\right) \\left(\\frac{-(x+R_p)}{\\Delta R_p^2}\\right) \\right]\n$$\n在 $x=0$ 处求值：\n$$\n\\frac{d\\tilde{C}}{dx}\\bigg|_{x=0} = A \\left[ \\exp\\left(-\\frac{R_{p}^{2}}{2\\Delta R_{p}^{2}}\\right) \\left(\\frac{R_p}{\\Delta R_p^2}\\right) + \\exp\\left(-\\frac{R_{p}^{2}}{2\\Delta R_{p}^{2}}\\right) \\left(\\frac{-R_p}{\\Delta R_p^2}\\right) \\right] = 0\n$$\n因此，对于 $\\tilde{C}(x)$ 的这种选择，Neumann 边界条件得到满足。\n\n接下来，我们应用剂量守恒条件来确定常数 $A$。总剂量 $Q$ 是浓度在物理域 $x \\ge 0$ 上的积分。\n$$\nQ = \\int_{0}^{\\infty} C(x) \\, dx = \\int_{0}^{\\infty} \\tilde{C}(x) \\, dx\n$$\n由于 $\\tilde{C}(x)$ 是偶函数，其在正半轴上的积分恰好是其在整个实数轴上积分的一半：\n$$\n\\int_{0}^{\\infty} \\tilde{C}(x) \\, dx = \\frac{1}{2} \\int_{-\\infty}^{\\infty} \\tilde{C}(x) \\, dx\n$$\n因此，我们可以写出：\n$$\nQ = \\frac{A}{2} \\int_{-\\infty}^{\\infty} \\left[ \\exp\\left(-\\frac{(x - R_{p})^{2}}{2\\Delta R_{p}^{2}}\\right) + \\exp\\left(-\\frac{(x + R_{p})^{2}}{2\\Delta R_{p}^{2}}\\right) \\right] dx\n$$\n该积分可以分成两部分：\n$$\nQ = \\frac{A}{2} \\left[ \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{(x - R_{p})^{2}}{2\\Delta R_{p}^{2}}\\right) dx + \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{(x + R_{p})^{2}}{2\\Delta R_{p}^{2}}\\right) dx \\right]\n$$\n我们使用高斯函数的标准定积分：$\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{(t-\\mu)^2}{2\\sigma^2}\\right) dt = \\sqrt{2\\pi}\\sigma$。对于第一个积分，$\\mu = R_p$ 且 $\\sigma = \\Delta R_p$。对于第二个积分，$\\mu = -R_p$ 且 $\\sigma = \\Delta R_p$。两个积分的计算结果都为 $\\sqrt{2\\pi}\\Delta R_p$。\n$$\nQ = \\frac{A}{2} \\left( \\sqrt{2\\pi}\\Delta R_p + \\sqrt{2\\pi}\\Delta R_p \\right) = \\frac{A}{2} \\left( 2\\sqrt{2\\pi}\\Delta R_p \\right) = A \\sqrt{2\\pi}\\Delta R_p\n$$\n求解归一化常数 $A$：\n$$\nA = \\frac{Q}{\\sqrt{2\\pi}\\Delta R_p}\n$$\n这个常数与原始自由空间高斯分布的前置因子相同。\n\n最后，我们将 $A$ 的值代入我们为 $\\tilde{C}(x)$ 得到的表达式中，并将域限制在 $x \\ge 0$，从而构造出解 $C(x)$：\n$$\nC(x) = \\frac{Q}{\\sqrt{2\\pi}\\Delta R_{p}} \\left[ \\exp\\left(-\\frac{(x - R_{p})^{2}}{2\\Delta R_{p}^{2}}\\right) + \\exp\\left(-\\frac{(x + R_{p})^{2}}{2\\Delta R_{p}^{2}}\\right) \\right], \\quad x \\ge 0\n$$\n这 就是在具有反射边界条件的半无限介质中浓度分布的闭式解析表达式。它是原始高斯分布与一个关于表面反射的“镜像”高斯分布之和。",
            "answer": "$$\n\\boxed{\\frac{Q}{\\sqrt{2\\pi}\\,\\Delta R_{p}} \\left[ \\exp\\left(-\\frac{(x - R_{p})^{2}}{2\\,\\Delta R_{p}^{2}}\\right) + \\exp\\left(-\\frac{(x + R_{p})^{2}}{2\\,\\Delta R_{p}^{2}}\\right) \\right]}\n$$"
        },
        {
            "introduction": "虽然高斯模型是一个很好的起点，但真实的注入分布通常是不对称的。Pearson IV 分布提供了更大的灵活性来捕捉这种偏斜。这项实践将带您进入计算工艺建模的领域，您将使用数值方法来分析 Pearson IV 分布，计算在器件工程中至关重要的累积剂量和深度百分位数。",
            "id": "4107260",
            "problem": "考虑对一个占据深度 $x \\ge 0$ 的半无限衬底进行一维离子注入。注入剂量 $Q$ (单位：离子/cm$^2$) 沿深度根据解析 Pearson IV 型模型分布。设浓度分布 $C(x)$ (单位：离子/cm$^3$) 被建模为一个标度化的形状函数 $S(x)$，使得在半无限域上的物理相关归一化成立。具体来说，定义形状函数为\n$$\nS(x;\\mu,a,m,\\nu) = \\left(1 + \\left(\\frac{x - \\mu}{a}\\right)^2\\right)^{-m} \\exp\\left(\\nu \\arctan\\left(\\frac{x - \\mu}{a}\\right)\\right),\n$$\n其中 $x$ 是深度，$\\mu$ 是位置参数（投影射程），$a$ 是尺度参数（与离散度相关），$m$ 是一个控制代数衰减的尾部参数，$\\nu$ 控制偏度。在物理相关区域 $x \\ge 0$ 上的总剂量归一化通过以下方式强制执行：\n$$\nI(\\mu,a,m,\\nu) = \\int_{0}^{\\infty} S(x;\\mu,a,m,\\nu)\\,dx,\n$$\n浓度分布定义为：\n$$\nC(x) = \\frac{Q}{I(\\mu,a,m,\\nu)}\\,S(x;\\mu,a,m,\\nu),\n$$\n使得 $\\int_{0}^{\\infty} C(x)\\,dx = Q$。\n\n截至深度 $x_0 \\ge 0$ 的累积剂量分数为\n$$\nF(x_0) = \\frac{1}{Q}\\int_{0}^{x_0} C(x)\\,dx = \\frac{\\int_{0}^{x_0} S(x;\\mu,a,m,\\nu)\\,dx}{\\int_{0}^{\\infty} S(x;\\mu,a,m,\\nu)\\,dx}.\n$$\n\n任务：\n- 使用数值积分计算 $F(x_0)$（不得使用闭式解捷径）。\n- 对于给定的分数 $p \\in (0,1)$，计算满足 $F(x_p) = p$ 的深度 $x_p$。所有角度求值均使用弧度。\n\n可使用的科学依据：\n- 剂量 $Q$ 定义为 $C(x)$ 在深度上的积分。\n- 累积分数 $F(x_0)$ 定义为 $C(x)$ 截至 $x_0$ 的归一化积分。\n- 如上所述的 Pearson IV 型形状函数 $S(x;\\mu,a,m,\\nu)$。\n\n数值方法要求：\n- 实现数值积分以计算必要的积分。\n- 实现数值求根以对 $F(x)$ 求逆并获得 $x_p$。\n\n单位：\n- 所有深度（包括 $x_0$ 和 $x_p$）均以纳米 (nm) 为单位，表示为浮点数。\n- 剂量 $Q$ 以 离子/cm$^2$ 为单位提供，但请注意，根据构造，$Q$ 在 $F(x_0)$ 中被消去。\n\n角度单位：\n- 所有 $\\arctan(\\cdot)$ 的求值必须以弧度为单位。\n\n测试套件：\n- 情况 $1$（一般情况）：$Q = 1.0\\times 10^{13}$ 离子/cm$^2$，$\\mu = 100$ nm，$a = 30$ nm，$m = 4.0$，$\\nu = 2.0$，$x_0 = 120$ nm，$p$ 列表 $[0.25, 0.5, 0.9]$。\n- 情况 $2$（$x_0$ 处的边界和对称性）：$Q = 5.0\\times 10^{12}$ 离子/cm$^2$，$\\mu = 80$ nm，$a = 20$ nm，$m = 3.0$，$\\nu = 0.0$，$x_0 = 0$ nm，$p$ 列表 $[0.25, 0.5, 0.9]$。\n- 情况 $3$（强偏度）：$Q = 1.0\\times 10^{13}$ 离子/cm$^2$，$\\mu = 150$ nm，$a = 40$ nm，$m = 5.0$，$\\nu = 8.0$，$x_0 = 300$ nm，$p$ 列表 $[0.25, 0.5, 0.9]$。\n\n覆盖理由：\n- 情况 1 测试一个典型的偏斜分布。\n- 情况 2 检查边界 $x_0 = 0$ 和一个对称（$\\nu = 0$）分布。\n- 情况 3 检验在强偏度下的数值鲁棒性。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表。\n- 对每个测试用例，输出一个浮点数列表 $[F(x_0), x_{0.25}, x_{0.5}, x_{0.9}]$。\n- 因此，完整输出是包含三个列表的列表：$[[F_1,x_{0.25}^{(1)},x_{0.5}^{(1)},x_{0.9}^{(1)}],[F_2,x_{0.25}^{(2)},x_{0.5}^{(2)},x_{0.9}^{(2)}],[F_3,x_{0.25}^{(3)},x_{0.5}^{(3)},x_{0.9}^{(3)}]]$。",
            "solution": "我们从注入剂量和累积分数的定义开始。注入剂量 $Q$ 等于浓度分布 $C(x)$ 在物理相关的半无限域上的积分，\n$$\nQ = \\int_{0}^{\\infty} C(x)\\,dx.\n$$\n截至深度 $x_0$ 的累积剂量分数定义为\n$$\nF(x_0) = \\frac{1}{Q}\\int_{0}^{x_0} C(x)\\,dx.\n$$\n为了通过解析形状一致地对 $C(x)$ 建模，我们引入 Pearson IV 型形状函数\n$$\nS(x;\\mu,a,m,\\nu) = \\left(1 + \\left(\\frac{x - \\mu}{a}\\right)^2\\right)^{-m} \\exp\\left(\\nu \\arctan\\left(\\frac{x - \\mu}{a}\\right)\\right),\n$$\n其中 $x$ 是深度，$\\mu$ 是位置参数， $a$ 是一个正尺度参数， $m$ 控制代数尾部衰减， $\\nu$ 控制偏度。函数 $S(x;\\mu,a,m,\\nu)$ 对所有 $x$ 均为正，并且在 $m > \\frac{1}{2}$ 的条件下在 $x \\in [0,\\infty)$ 上是可积的（因为当 $\\arctan((x-\\mu)/a) \\to \\pm \\frac{\\pi}{2}$ 导致偏度因子饱和后，对于大的 $|x|$，其渐进行为是 $S(x) \\sim \\text{常数}\\cdot |x|^{-2m}$，因此当 $m > \\frac{1}{2}$ 时 $\\int |x|^{-2m}\\,dx$ 在 $[0,\\infty)$ 上收敛）。偏度因子 $\\exp(\\nu \\arctan(\\cdot))$ 界于 $\\exp\\left(-\\frac{\\nu \\pi}{2}\\right)$ 和 $\\exp\\left(\\frac{\\nu \\pi}{2}\\right)$ 之间，因此它不会破坏可积性。\n\n为强制在深度 $x \\ge 0$ 上进行剂量归一化，我们计算形状积分\n$$\nI(\\mu,a,m,\\nu) = \\int_{0}^{\\infty} S(x;\\mu,a,m,\\nu)\\,dx,\n$$\n并定义\n$$\nC(x) = \\frac{Q}{I(\\mu,a,m,\\nu)}\\,S(x;\\mu,a,m,\\nu).\n$$\n根据构造，$\\int_{0}^{\\infty} C(x)\\,dx = Q$。将 $C(x)$ 代入累积分数表达式中，\n$$\nF(x_0) = \\frac{1}{Q}\\int_{0}^{x_0} \\frac{Q}{I(\\mu,a,m,\\nu)}\\,S(x;\\mu,a,m,\\nu)\\,dx = \\frac{\\int_{0}^{x_0} S(x;\\mu,a,m,\\nu)\\,dx}{\\int_{0}^{\\infty} S(x;\\mu,a,m,\\nu)\\,dx}.\n$$\n因此，$F(x_0)$ 仅取决于形状参数 $(\\mu,a,m,\\nu)$，而不取决于 $Q$，因为 $Q$ 被消去了。在给定的归一化下，函数 $F(x)$ 是关于 $x$ 的非递减函数，且 $F(0)=0$ 以及 $\\lim_{x\\to\\infty} F(x)=1$。\n\n算法设计：\n\n1. 数值积分。我们必须计算 $S(x;\\mu,a,m,\\nu)$ 的两个积分：\n- 归一化积分 $I(\\mu,a,m,\\nu) = \\int_{0}^{\\infty} S(x;\\mu,a,m,\\nu)\\,dx$。\n- 分子积分 $N(x_0) = \\int_{0}^{x_0} S(x;\\mu,a,m,\\nu)\\,dx$。\n\n我们通过广泛使用的算法（例如，在标准积分例程中实现的 Gauss-Kronrod 法则）对半无限区间采用自适应积分。半无限积分通过变换无限域或自适应地细分它的数值技术来处理；我们依赖例程来确保精度，其绝对容差设置为 $10^{-9}$，相对容差设置为 $10^{-9}$，以实现鲁棒收敛。因此，\n$$\nF(x_0) = \\frac{N(x_0)}{I(\\mu,a,m,\\nu)}.\n$$\n\n2. 百分位数深度。对于目标分数 $p \\in (0,1)$，百分位数深度 $x_p$ 求解\n$$\nF(x_p) = p.\n$$\n这是一个关于函数\n$$\nG(x) = F(x) - p.\n$$\n的单调求根问题。因为 $F(x)$ 是连续且非递减的，并且 $F(0)=0$ 和 $\\lim_{x\\to\\infty} F(x)=1$，所以对于任何 $p \\in (0,1)$，都存在一个解 $x_p \\in [0,\\infty)$。我们使用一个鲁棒的区间法来找到 $x_p$：\n- 从一个有限上界 $u$ 开始（例如 $u = \\max(\\mu + 10a,10a)$），并检查是否有 $F(u) \\ge p$。\n- 如果 $F(u)  p$，则将 $u$ 加倍，直到 $F(u) \\ge p$ 或达到预定义的最大界限（例如 $u_{\\max} = 10^5$ nm）；后者被选择为对于典型的注入而言物理上足够大的值。\n- 在 $[0,u]$ 上应用区间求根求解器来找到满足 $G(x_p)=0$ 的 $x_p$。\n\n这个过程依赖于 $F(x)$ 的单调性，并保证在数值容差范围内，对于 $p \\in (0,1)$，$x_p$ 的存在性和唯一性。\n\n数值稳定性与物理真实性：\n- 在测试套件中，参数 $m$ 被选为 $m \\ge 3.0$ 和 $m \\ge 4.0$，以确保尾部的快速衰减，这改善了数值收敛性。\n- 偏度参数 $\\nu$ 在 $\\nu = 0.0$（对称分布）和 $\\nu = 8.0$（强偏度）下进行测试，以验证在不同非对称性下的鲁棒性。\n- 根据 $\\arctan(\\cdot)$ 的定义，所有角度求值都使用弧度。\n\n百分位数的解释：\n- 深度 $x_p$ 表示物理深度，在该深度以下存在总注入剂量的 $p$ 部分。例如，$x_{0.5}$ 是剂量分布的中位深度，而 $x_{0.9}$ 标记了一个深度，超过该深度后只剩下 $10\\%$ 的剂量。\n\n测试套件计算：\n- 情况 1：$Q = 1.0\\times 10^{13}$ 离子/cm$^2$，$\\mu = 100$ nm，$a = 30$ nm，$m = 4.0$，$\\nu = 2.0$，$x_0 = 120$ nm，$p$ 列表 $[0.25, 0.5, 0.9]$。计算 $F(120\\ \\text{nm})$ 和 $x_{0.25}$，$x_{0.5}$，$x_{0.9}$。\n- 情况 2：$Q = 5.0\\times 10^{12}$ 离子/cm$^2$，$\\mu = 80$ nm，$a = 20$ nm，$m = 3.0$，$\\nu = 0.0$，$x_0 = 0$ nm，$p$ 列表 $[0.25, 0.5, 0.9]$。验证 $F(0\\ \\text{nm}) = 0$ 并计算百分位数。\n- 情况 3：$Q = 1.0\\times 10^{13}$ 离子/cm$^2$，$\\mu = 150$ nm，$a = 40$ nm，$m = 5.0$，$\\nu = 8.0$，$x_0 = 300$ nm，$p$ 列表 $[0.25, 0.5, 0.9]$。在强偏度下计算 $F(300\\ \\text{nm})$ 和百分位数。\n\n输出聚合：\n- 对每个情况，输出一个列表 $[F(x_0), x_{0.25}, x_{0.5}, x_{0.9}]$。\n- 将三个情况的结果聚合成单行：\n$$\n\\big[ [F_1, x_{0.25}^{(1)}, x_{0.5}^{(1)}, x_{0.9}^{(1)}], [F_2, x_{0.25}^{(2)}, x_{0.5}^{(2)}, x_{0.9}^{(2)}], [F_3, x_{0.25}^{(3)}, x_{0.5}^{(3)}, x_{0.9}^{(3)}] \\big].\n$$",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\nfrom scipy.optimize import brentq\n\ndef pearson_iv_shape(x, mu, a, m, nu):\n    \"\"\"\n    Pearson Type IV shape function:\n    S(x; mu, a, m, nu) = (1 + ((x - mu)/a)^2)^(-m) * exp( nu * arctan((x - mu)/a) )\n    All angles are in radians.\n    \"\"\"\n    y = (x - mu) / a\n    return (1.0 + y*y) ** (-m) * np.exp(nu * np.arctan(y))\n\ndef normalization_integral(mu, a, m, nu):\n    \"\"\"\n    Compute I(mu,a,m,nu) = integral_{0}^{inf} S(x; mu, a, m, nu) dx\n    using adaptive quadrature over a semi-infinite interval.\n    \"\"\"\n    # Tight tolerances for stability across skewed cases\n    val, _ = quad(lambda xx: pearson_iv_shape(xx, mu, a, m, nu),\n                  0.0, np.inf, epsabs=1e-9, epsrel=1e-9, limit=200)\n    return val\n\ndef cumulative_fraction(x0, I, mu, a, m, nu):\n    \"\"\"\n    Compute F(x0) = (integral_{0}^{x0} S(x;... ) dx) / I\n    \"\"\"\n    if x0 == 0.0:\n        return 0.0\n    num, _ = quad(lambda xx: pearson_iv_shape(xx, mu, a, m, nu),\n                  0.0, x0, epsabs=1e-9, epsrel=1e-9, limit=200)\n    return num / I\n\ndef percentile_depth(p, I, mu, a, m, nu):\n    \"\"\"\n    Solve F(x) = p for x using bracketing and root finding.\n    \"\"\"\n    # Monotone CDF: start with a reasonable upper bound and expand if needed.\n    ub = max(mu + 10.0 * a, 10.0 * a)\n    # Ensure ub is positive\n    ub = max(ub, 10.0)\n    # If F(ub)  p, expand ub until we bracket the root\n    def F_of_x(x):\n        return cumulative_fraction(x, I, mu, a, m, nu)\n    max_ub = 1e5  # nm, physically large\n    # Expand upper bound if necessary\n    while F_of_x(ub)  p and ub  max_ub:\n        ub *= 2.0\n    # In case numerical issues keep F(ub)  p but ub is huge, clamp p slightly\n    Fub = F_of_x(ub)\n    if Fub  p:\n        # If we cannot bracket perfectly due to numerical limitations, nudge p\n        # towards Fub to maintain a valid bracket. This is a rare fallback.\n        p_eff = min(p, max(0.999999, Fub))\n    else:\n        p_eff = p\n\n    # Root finding on G(x) = F(x) - p_eff\n    def G(x):\n        return F_of_x(x) - p_eff\n\n    # Brent's method requires a sign change; since F is monotone, G(0) = -p and G(ub) >= 0\n    # However, due to numerical errors, ensure the endpoints are not identical.\n    # If G(0) is slightly positive (unlikely), shift lower bound slightly.\n    lb = 0.0\n    Glb = G(lb)\n    if Glb > 0.0:\n        lb = 1e-9\n        Glb = G(lb)\n\n    # If G(ub) is slightly negative due to numerical round-off, expand ub or adjust p_eff.\n    Gub = G(ub)\n    if Gub  0.0:\n        # Try expanding ub once more\n        ub = min(ub * 2.0, max_ub)\n        Gub = G(ub)\n        if Gub  0.0:\n            # Final fallback: return ub as approximate percentile\n            return ub\n\n    # Solve for root\n    x_root = brentq(G, lb, ub, xtol=1e-10, rtol=1e-10, maxiter=200)\n    return x_root\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (Q [ions/cm^2], mu [nm], a [nm], m, nu, x0 [nm], p_list)\n    test_cases = [\n        (1.0e13, 100.0, 30.0, 4.0, 2.0, 120.0, [0.25, 0.5, 0.9]),\n        (5.0e12,  80.0, 20.0, 3.0, 0.0,   0.0, [0.25, 0.5, 0.9]),\n        (1.0e13, 150.0, 40.0, 5.0, 8.0, 300.0, [0.25, 0.5, 0.9]),\n    ]\n\n    results = []\n    for case in test_cases:\n        Q, mu, a, m, nu, x0, p_list = case\n        # Compute normalization integral I over x in [0, inf)\n        I = normalization_integral(mu, a, m, nu)\n        # Compute cumulative fraction F(x0): Q cancels by construction\n        F_x0 = cumulative_fraction(x0, I, mu, a, m, nu)\n        # Compute percentiles\n        percentiles = []\n        for p in p_list:\n            xp = percentile_depth(p, I, mu, a, m, nu)\n            percentiles.append(xp)\n        # Compose result for this case: [F(x0), x_{p1}, x_{p2}, ...]\n        # Depths are in nm as per test case units.\n        case_result = [F_x0] + percentiles\n        results.append(case_result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}