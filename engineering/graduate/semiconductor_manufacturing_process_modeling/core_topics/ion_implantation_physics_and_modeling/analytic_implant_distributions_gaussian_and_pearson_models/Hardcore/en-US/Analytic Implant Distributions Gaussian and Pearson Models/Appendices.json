{
    "hands_on_practices": [
        {
            "introduction": "The Gaussian distribution serves as the cornerstone for modeling ion implantation, offering a simple yet powerful approximation based on the central limit theorem. This first exercise focuses on deriving the fundamental properties of this model from first principles . By relating the total implanted dose $Q$ to the model's parameters, you will determine the peak concentration and its location, a crucial first step in predicting the final dopant profile in a semiconductor device.",
            "id": "4107201",
            "problem": "In ion implantation for semiconductor manufacturing, the as-implanted dopant concentration profile in a crystalline substrate can be modeled in one dimension (1D) by a normal (Gaussian) depth distribution arising from the stochastic nature of ion stopping and straggling. Let the mean projected range be $R_p$ and the standard deviation (straggle) be $\\Delta R_p$. The implanted dose per unit area is $Q$, defined by the integral of the concentration profile over depth. Assume negligible channeling and that $R_p \\gg \\Delta R_p$ so the substrate surface does not significantly truncate the profile, thereby justifying extension of the integration domain to the entire real line for normalization.\n\nUnder the Gaussian model, the concentration profile takes the form $C(x) = A \\exp\\!\\big(-\\frac{(x - R_p)^{2}}{2 \\Delta R_p^{2}}\\big)$, where $A$ is an amplitude to be determined from the dose constraint $\\int_{0}^{\\infty} C(x)\\,dx = Q$ using the stated approximation. Starting from these fundamentals:\n- Use calculus to determine the location $x_{\\max}$ at which $C(x)$ is maximized, and confirm that this extremum is a maximum rather than a minimum.\n- Enforce the dose constraint to determine $A$ in terms of $Q$ and $\\Delta R_p$, and hence obtain the peak concentration $C_{\\max} = C(x_{\\max})$.\n- Express your final answer as a single row matrix containing $x_{\\max}$ and $C_{\\max}$ in closed form. Do not include units in your final answer.",
            "solution": "The problem is valid as it is scientifically grounded in the standard model of ion implantation, mathematically well-posed, objective, and internally consistent.\n\nThe objective is to find the depth of maximum concentration, $x_{\\max}$, and the value of this peak concentration, $C_{\\max}$, for the given Gaussian concentration profile.\n\nThe concentration profile is given by the function:\n$$C(x) = A \\exp\\left(-\\frac{(x - R_p)^{2}}{2 \\Delta R_p^{2}}\\right)$$\nwhere $R_p$ is the mean projected range, $\\Delta R_p$ is the standard deviation (straggle), and $A$ is an amplitude.\n\nFirst, we determine the location of the maximum concentration, $x_{\\max}$. This is found by taking the first derivative of $C(x)$ with respect to $x$ and setting it to zero.\nUsing the chain rule for differentiation, let $u(x) = -\\frac{(x - R_p)^{2}}{2 \\Delta R_p^{2}}$. The derivative of $u(x)$ is $\\frac{du}{dx} = -\\frac{2(x - R_p)}{2 \\Delta R_p^{2}} = -\\frac{x - R_p}{\\Delta R_p^{2}}$.\nThe derivative of $C(x)$ is then:\n$$\\frac{dC}{dx} = A \\cdot \\exp\\left(-\\frac{(x - R_p)^{2}}{2 \\Delta R_p^{2}}\\right) \\cdot \\left(-\\frac{x - R_p}{\\Delta R_p^{2}}\\right)$$\nSetting $\\frac{dC}{dx} = 0$ to find the critical points:\n$$-A \\frac{x - R_p}{\\Delta R_p^{2}} \\exp\\left(-\\frac{(x - R_p)^{2}}{2 \\Delta R_p^{2}}\\right) = 0$$\nSince $A$ is a positive amplitude, $\\Delta R_p^{2}$ is positive, and the exponential term is always positive, the expression can only be zero if the term $(x - R_p)$ is zero.\n$$x - R_p = 0 \\implies x = R_p$$\nThus, the only critical point occurs at $x = R_p$.\n\nTo confirm that this is a maximum, we examine the second derivative, $\\frac{d^2C}{dx^2}$, at $x = R_p$. Using the product rule on the expression for $\\frac{dC}{dx}$:\n$$\\frac{d^2C}{dx^2} = -\\frac{A}{\\Delta R_p^{2}} \\left[ \\frac{d}{dx}(x-R_p) \\cdot \\exp\\left(-\\frac{(x - R_p)^{2}}{2 \\Delta R_p^{2}}\\right) + (x-R_p) \\cdot \\frac{d}{dx}\\exp\\left(-\\frac{(x - R_p)^{2}}{2 \\Delta R_p^{2}}\\right) \\right]$$\n$$\\frac{d^2C}{dx^2} = -\\frac{A}{\\Delta R_p^{2}} \\left[ \\exp\\left(-\\frac{(x - R_p)^{2}}{2 \\Delta R_p^{2}}\\right) - \\frac{(x-R_p)^2}{\\Delta R_p^{2}}\\exp\\left(-\\frac{(x - R_p)^{2}}{2 \\Delta R_p^{2}}\\right) \\right]$$\nFactoring out the exponential term:\n$$\\frac{d^2C}{dx^2} = -\\frac{A}{\\Delta R_p^{2}} \\exp\\left(-\\frac{(x - R_p)^{2}}{2 \\Delta R_p^{2}}\\right) \\left[ 1 - \\frac{(x-R_p)^2}{\\Delta R_p^{2}} \\right]$$\nNow, evaluate this at the critical point $x=R_p$:\n$$\\left.\\frac{d^2C}{dx^2}\\right|_{x=R_p} = -\\frac{A}{\\Delta R_p^{2}} \\exp(0) \\left[ 1 - 0 \\right] = -\\frac{A}{\\Delta R_p^{2}}$$\nSince $A  0$ and $\\Delta R_p^2  0$, the second derivative is negative. This confirms that $x = R_p$ corresponds to a maximum. Therefore, the location of the peak concentration is:\n$$x_{\\max} = R_p$$\n\nNext, we determine the amplitude $A$ using the dose constraint, $Q = \\int_{0}^{\\infty} C(x)\\,dx$. The problem states that due to $R_p \\gg \\Delta R_p$, we can approximate the integral by extending the lower limit to $-\\infty$:\n$$Q \\approx \\int_{-\\infty}^{\\infty} C(x)\\,dx = \\int_{-\\infty}^{\\infty} A \\exp\\left(-\\frac{(x - R_p)^{2}}{2 \\Delta R_p^{2}}\\right)\\,dx$$\n$$Q = A \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{(x - R_p)^{2}}{2 (\\Delta R_p)^{2}}\\right)\\,dx$$\nThis is a standard Gaussian integral of the form $\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{(x-\\mu)^2}{2\\sigma^2}\\right)\\,dx = \\sigma\\sqrt{2\\pi}$. Here, our mean is $\\mu = R_p$ and our standard deviation is $\\sigma = \\Delta R_p$.\nThe value of the integral is therefore $\\Delta R_p \\sqrt{2\\pi}$.\nSubstituting this back into the equation for $Q$:\n$$Q = A (\\Delta R_p \\sqrt{2\\pi})$$\nSolving for the amplitude $A$:\n$$A = \\frac{Q}{\\sqrt{2\\pi} \\Delta R_p}$$\n\nFinally, we find the peak concentration, $C_{\\max}$, which is the value of $C(x)$ at $x=x_{\\max}$.\n$$C_{\\max} = C(x_{\\max}) = C(R_p)$$\n$$C_{\\max} = A \\exp\\left(-\\frac{(R_p - R_p)^{2}}{2 \\Delta R_p^{2}}\\right) = A \\exp(0) = A$$\nThus, the peak concentration is equal to the amplitude $A$.\n$$C_{\\max} = \\frac{Q}{\\sqrt{2\\pi} \\Delta R_p}$$\nThe two requested quantities are $x_{\\max} = R_p$ and $C_{\\max} = \\frac{Q}{\\sqrt{2\\pi} \\Delta R_p}$. The final answer is to be expressed as a row matrix.",
            "answer": "$$\\boxed{\\begin{pmatrix} R_p  \\frac{Q}{\\sqrt{2 \\pi} \\Delta R_p} \\end{pmatrix}}$$"
        },
        {
            "introduction": "While the Gaussian model provides a solid foundation, experimental data reveals that ion implantation profiles are rarely symmetric. To capture this reality, we turn to more sophisticated functions like the Pearson distributions, which can model skewness. In this practice , you will analyze a skewed profile modeled by a Gamma distribution (a Pearson Type III function) and derive its third central momentâ€”a direct quantitative measure of this asymmetry. This exercise develops your ability to work with more realistic distributions and interpret higher-order moments in a physical context.",
            "id": "4107232",
            "problem": "A monocrystalline silicon wafer is subjected to ion implantation under conditions where the depth distribution of implanted ions is well-approximated by a member of the Pearson system of distributions. For light ions at moderate energies in silicon, a commonly used analytic choice is the Pearson Type III model, which is equivalent to a translated Gamma distribution. Let the one-dimensional concentration profile per unit area be modeled as\n$$C(x)=\\begin{cases}\n\\dfrac{Q}{\\Gamma(k)\\,\\theta^{k}}\\,(x-x_{s})^{k-1}\\,\\exp\\!\\big(-(x-x_{s})/\\theta\\big),  x \\ge x_{s}, \\\\[6pt]\n0,  x  x_{s},\n\\end{cases}$$\nwhere $Q$ is the implanted dose per unit area, $k0$ is the shape parameter, $\\theta0$ is the scale parameter, $x_{s}$ is a small nonnegative shift aligning the support with the surface at $x=0$, and $\\Gamma(\\cdot)$ is the Gamma function. This $C(x)$ is normalized so that $\\int_{-\\infty}^{\\infty}C(x)\\,dx=Q$, and thus the normalized depth probability density function (PDF) is $f(x)=C(x)/Q$.\n\nStarting only from the definition of central moments and well-tested properties of the Gamma function and exponential integrals, derive the third central moment about the mean depth,\n$$\\mu_{3}=\\int_{-\\infty}^{\\infty}\\big(x-\\bar{x}\\big)^{3}\\,f(x)\\,dx,$$\nwhere $\\bar{x}=\\int_{-\\infty}^{\\infty}x\\,f(x)\\,dx$ is the mean depth. Use the physically plausible parameters $k=3.5$, $\\theta=5.8\\,\\mathrm{nm}$, and $x_{s}=0\\,\\mathrm{nm}$. After obtaining the analytic expression, evaluate it numerically. Express your final numerical answer in $\\mathrm{nm}^{3}$ and round your answer to four significant figures. Finally, based on the sign of $\\mu_{3}$, interpret whether the modeled profile has a longer tail towards the bulk (larger $x$) or towards the surface (smaller $x$). Do not use any shortcut formulas that directly state the third central moment of a Gamma distribution; derive it from first principles in this context of semiconductor manufacturing process modeling.",
            "solution": "The problem statement is first validated against the required criteria.\n\n### Step 1: Extract Givens\n-   One-dimensional concentration profile:\n    $$C(x)=\\begin{cases}\n    \\dfrac{Q}{\\Gamma(k)\\,\\theta^{k}}\\,(x-x_{s})^{k-1}\\,\\exp\\!\\big(-(x-x_{s})/\\theta\\big),  x \\ge x_{s}, \\\\[6pt]\n    0,  x  x_{s},\n    \\end{cases}$$\n-   $Q$: Implanted dose per unit area.\n-   $k$: Shape parameter, $k0$.\n-   $\\theta$: Scale parameter, $\\theta0$.\n-   $x_{s}$: Shift parameter, $x_{s} \\geq 0$.\n-   Normalization: $\\int_{-\\infty}^{\\infty}C(x)\\,dx=Q$.\n-   Normalized depth PDF: $f(x)=C(x)/Q$.\n-   Third central moment definition: $\\mu_{3}=\\int_{-\\infty}^{\\infty}\\big(x-\\bar{x}\\big)^{3}\\,f(x)\\,dx$.\n-   Mean depth definition: $\\bar{x}=\\int_{-\\infty}^{\\infty}x\\,f(x)\\,dx$.\n-   Numerical parameters: $k=3.5$, $\\theta=5.8\\,\\mathrm{nm}$, and $x_{s}=0\\,\\mathrm{nm}$.\n-   Task: Derive $\\mu_3$ from first principles, evaluate it numerically, and interpret the sign of the result.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem models ion implantation depth distribution using a Pearson Type III (shifted Gamma) distribution. This is a standard and physically justified model in semiconductor process modeling for light ions. The problem is scientifically sound.\n-   **Well-Posed**: The problem is clearly stated. It provides a specific distribution, all necessary parameters, and a clear definition of the quantity to be derived and calculated. It asks for a unique, computable result.\n-   **Objective**: The problem is expressed in precise, technical language common to physics and engineering, with no subjective or ambiguous statements.\n-   **Conclusion**: The problem is free of scientific flaws, contradictions, and ambiguities. It is a valid, well-posed problem in the specified domain.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full solution will be provided.\n\n### Solution Derivation\n\nThe normalized probability density function (PDF) for the depth $x$ is given by $f(x) = C(x)/Q$. With the given parameter $x_{s}=0\\,\\mathrm{nm}$, the PDF simplifies to:\n$$f(x)=\\begin{cases}\n\\dfrac{1}{\\Gamma(k)\\,\\theta^{k}}\\,x^{k-1}\\,\\exp(-x/\\theta),  x \\ge 0, \\\\[6pt]\n0,  x0.\n\\end{cases}$$\nThis is the PDF for a Gamma distribution with shape parameter $k$ and scale parameter $\\theta$.\n\nThe third central moment $\\mu_{3}$ is defined as $\\mu_{3} = E[(X-\\bar{x})^3]$, where $\\bar{x} = E[X]$ is the mean of the distribution. By expanding the cubic term and using the linearity of the expectation operator $E[\\cdot]$, we can express $\\mu_{3}$ in terms of raw moments $E[X^n]$:\n$$ \\mu_{3} = E[X^3 - 3X^2\\bar{x} + 3X\\bar{x}^2 - \\bar{x}^3] $$\n$$ \\mu_{3} = E[X^3] - 3\\bar{x}E[X^2] + 3\\bar{x}^2E[X] - \\bar{x}^3 $$\nSince $E[X] = \\bar{x}$, this simplifies to:\n$$ \\mu_{3} = E[X^3] - 3\\bar{x}E[X^2] + 2\\bar{x}^3 $$\nTo find $\\mu_{3}$, we must first derive the general expression for the $n$-th raw moment, $E[X^n]$, and then use it to find the first three raw moments: $\\bar{x} = E[X]$, $E[X^2]$, and $E[X^3]$.\n\nThe $n$-th raw moment is given by the integral:\n$$ E[X^n] = \\int_{0}^{\\infty} x^n f(x) \\,dx = \\int_{0}^{\\infty} x^n \\frac{1}{\\Gamma(k)\\,\\theta^{k}}\\,x^{k-1}\\,\\exp(-x/\\theta) \\,dx $$\n$$ E[X^n] = \\frac{1}{\\Gamma(k)\\,\\theta^{k}} \\int_{0}^{\\infty} x^{n+k-1}\\,\\exp(-x/\\theta) \\,dx $$\nTo evaluate this integral, we perform a change of variables. Let $u = x/\\theta$, which implies $x = u\\theta$ and $dx = \\theta\\,du$. The limits of integration remain from $0$ to $\\infty$.\n$$ E[X^n] = \\frac{1}{\\Gamma(k)\\,\\theta^{k}} \\int_{0}^{\\infty} (u\\theta)^{n+k-1}\\,\\exp(-u) \\,(\\theta\\,du) $$\n$$ E[X^n] = \\frac{\\theta^{n+k-1}\\theta}{\\Gamma(k)\\,\\theta^{k}} \\int_{0}^{\\infty} u^{n+k-1}\\,\\exp(-u) \\,du $$\n$$ E[X^n] = \\frac{\\theta^{n+k}}{\\Gamma(k)\\,\\theta^{k}} \\int_{0}^{\\infty} u^{(n+k)-1}\\,\\exp(-u) \\,du $$\nThe integral term is the definition of the Gamma function, $\\Gamma(n+k)$.\n$$ E[X^n] = \\frac{\\theta^n}{\\Gamma(k)} \\Gamma(n+k) $$\nUsing the property of the Gamma function, $\\Gamma(z+1)=z\\Gamma(z)$, we can write $\\Gamma(n+k)$ in terms of $\\Gamma(k)$:\n$$ \\Gamma(n+k) = (n+k-1)(n+k-2)\\cdots(k)\\Gamma(k) $$\nThus, we find the general expression for the $n$-th raw moment:\n$$ E[X^n] = \\theta^n \\frac{\\Gamma(n+k)}{\\Gamma(k)} $$\n\nNow, we calculate the first three raw moments:\n1.  Mean, $\\bar{x} = E[X^1]$ (for $n=1$):\n    $$ \\bar{x} = \\theta^1 \\frac{\\Gamma(1+k)}{\\Gamma(k)} = \\theta \\frac{k\\Gamma(k)}{\\Gamma(k)} = k\\theta $$\n2.  Second raw moment, $E[X^2]$ (for $n=2$):\n    $$ E[X^2] = \\theta^2 \\frac{\\Gamma(2+k)}{\\Gamma(k)} = \\theta^2 \\frac{(k+1)\\Gamma(k+1)}{\\Gamma(k)} = \\theta^2 \\frac{(k+1)k\\Gamma(k)}{\\Gamma(k)} = k(k+1)\\theta^2 $$\n3.  Third raw moment, $E[X^3]$ (for $n=3$):\n    $$ E[X^3] = \\theta^3 \\frac{\\Gamma(3+k)}{\\Gamma(k)} = \\theta^3 \\frac{(k+2)\\Gamma(k+2)}{\\Gamma(k)} = \\theta^3 \\frac{(k+2)(k+1)k\\Gamma(k)}{\\Gamma(k)} = k(k+1)(k+2)\\theta^3 $$\n\nWe now substitute these expressions back into the formula for $\\mu_{3}$:\n$$ \\mu_{3} = E[X^3] - 3\\bar{x}E[X^2] + 2\\bar{x}^3 $$\n$$ \\mu_{3} = [k(k+1)(k+2)\\theta^3] - 3(k\\theta)[k(k+1)\\theta^2] + 2(k\\theta)^3 $$\n$$ \\mu_{3} = k(k+1)(k+2)\\theta^3 - 3k^2(k+1)\\theta^3 + 2k^3\\theta^3 $$\nFactor out the common term $k\\theta^3$:\n$$ \\mu_{3} = k\\theta^3 \\left[ (k+1)(k+2) - 3k(k+1) + 2k^2 \\right] $$\nExpand the terms inside the brackets:\n$$ \\mu_{3} = k\\theta^3 \\left[ (k^2+3k+2) - (3k^2+3k) + 2k^2 \\right] $$\nCombine like terms:\n$$ \\mu_{3} = k\\theta^3 \\left[ (k^2 - 3k^2 + 2k^2) + (3k - 3k) + 2 \\right] $$\n$$ \\mu_{3} = k\\theta^3 \\left[ 0 + 0 + 2 \\right] $$\nThe analytic expression for the third central moment is:\n$$ \\mu_{3} = 2k\\theta^3 $$\n\nNext, we evaluate this expression numerically using the given parameters $k=3.5$ and $\\theta=5.8\\,\\mathrm{nm}$.\n$$ \\mu_{3} = 2(3.5)(5.8\\,\\mathrm{nm})^3 $$\n$$ \\mu_{3} = 7 \\times (5.8)^3 \\,\\mathrm{nm}^3 $$\n$$ \\mu_{3} = 7 \\times 195.112 \\,\\mathrm{nm}^3 $$\n$$ \\mu_{3} = 1365.784 \\,\\mathrm{nm}^3 $$\nRounding to four significant figures as requested:\n$$ \\mu_{3} \\approx 1366 \\,\\mathrm{nm}^3 $$\n\nFinally, we interpret the sign of $\\mu_{3}$. The third central moment is a measure of the asymmetry, or skewness, of a distribution. The standardized skewness is given by $\\gamma_1 = \\mu_3 / \\sigma^3$, where $\\sigma$ is the standard deviation. Since $k$ and $\\theta$ are positive, $\\mu_3 = 2k\\theta^3$ is strictly positive. A positive third central moment implies positive skewness. This indicates that the distribution is skewed to the right, meaning it has a longer or heavier tail on the side of larger values. In the context of ion implantation, the variable $x$ represents depth into the silicon wafer. Therefore, a positive $\\mu_3$ means that the modeled ion concentration profile has a longer tail extending towards the bulk of the silicon (larger $x$) rather than towards the surface ($x=0$). This is a characteristic feature of ion implantation profiles, where scattering events cause some ions to penetrate much deeper than the average depth.",
            "answer": "$$\\boxed{1366}$$"
        },
        {
            "introduction": "The Pearson Type IV model represents one of the most accurate and flexible tools for fitting experimental implant data, but its complexity makes pen-and-paper calculations for quantities like cumulative dose nearly impossible. This final practice moves from analytical derivation to computational implementation, a necessary step in modern process modeling . You will use numerical methods to calculate cumulative dose fractions and percentile depths, gaining hands-on experience with the computational techniques essential for Technology Computer-Aided Design (TCAD) and the engineering of semiconductor junctions.",
            "id": "4107260",
            "problem": "Consider one-dimensional ion implantation into a semi-infinite substrate occupying depths $x \\ge 0$. The implanted dose $Q$ (in ions/cm$^2$) is distributed along depth according to an analytic Pearson Type IV model. Let the concentration profile $C(x)$ (in ions/cm$^3$) be modeled as a scaled shape function $S(x)$ so that the physically relevant normalization over the semi-infinite domain holds. Specifically, define the shape function\n$$\nS(x;\\mu,a,m,\\nu) = \\left(1 + \\left(\\frac{x - \\mu}{a}\\right)^2\\right)^{-m} \\exp\\!\\left(\\nu \\arctan\\!\\left(\\frac{x - \\mu}{a}\\right)\\right),\n$$\nwhere $x$ is depth, $\\mu$ is the location parameter (projected range), $a$ is the scale parameter (related to straggle), $m$ is a tail parameter that controls the algebraic decay, and $\\nu$ controls skewness. The total dose normalization over the physically relevant region $x \\ge 0$ is enforced by\n$$\nI(\\mu,a,m,\\nu) = \\int_{0}^{\\infty} S(x;\\mu,a,m,\\nu)\\,dx,\n$$\nand the concentration profile is defined by\n$$\nC(x) = \\frac{Q}{I(\\mu,a,m,\\nu)}\\,S(x;\\mu,a,m,\\nu),\n$$\nso that $\\int_{0}^{\\infty} C(x)\\,dx = Q$.\n\nThe cumulative dose fraction up to a depth $x_0 \\ge 0$ is\n$$\nF(x_0) = \\frac{1}{Q}\\int_{0}^{x_0} C(x)\\,dx = \\frac{\\int_{0}^{x_0} S(x;\\mu,a,m,\\nu)\\,dx}{\\int_{0}^{\\infty} S(x;\\mu,a,m,\\nu)\\,dx}.\n$$\n\nTasks:\n- Compute $F(x_0)$ using numerical quadrature (no closed-form shortcuts).\n- For given fractions $p \\in (0,1)$, compute depths $x_p$ satisfying $F(x_p) = p$. Use radians for all angle evaluations.\n\nScientific bases that may be used:\n- Definition of dose $Q$ as the integral of $C(x)$ across depth.\n- Definition of cumulative fraction $F(x_0)$ as a normalized integral of $C(x)$ up to $x_0$.\n- The Pearson Type IV shape function $S(x;\\mu,a,m,\\nu)$ as specified above.\n\nNumerical method requirements:\n- Implement numerical quadrature to evaluate the necessary integrals.\n- Implement numerical root finding to invert $F(x)$ and obtain $x_p$.\n\nUnits:\n- Express all depths (including $x_0$ and $x_p$) in nanometers (nm) as floating-point numbers.\n- Dose $Q$ is provided in ions/cm$^2$, but note that $Q$ cancels in $F(x_0)$ by construction.\n\nAngle unit:\n- All evaluations of $\\arctan(\\cdot)$ must be in radians.\n\nTest suite:\n- Case $1$ (general case): $Q = 1.0\\times 10^{13}$ ions/cm$^2$, $\\mu = 100$ nm, $a = 30$ nm, $m = 4.0$, $\\nu = 2.0$, $x_0 = 120$ nm, $p$ list $[0.25, 0.5, 0.9]$.\n- Case $2$ (boundary in $x_0$ and symmetry): $Q = 5.0\\times 10^{12}$ ions/cm$^2$, $\\mu = 80$ nm, $a = 20$ nm, $m = 3.0$, $\\nu = 0.0$, $x_0 = 0$ nm, $p$ list $[0.25, 0.5, 0.9]$.\n- Case $3$ (strong skewness): $Q = 1.0\\times 10^{13}$ ions/cm$^2$, $\\mu = 150$ nm, $a = 40$ nm, $m = 5.0$, $\\nu = 8.0$, $x_0 = 300$ nm, $p$ list $[0.25, 0.5, 0.9]$.\n\nCoverage rationale:\n- Case $1$ exercises a typical skewed profile.\n- Case $2$ checks the boundary $x_0 = 0$ and a symmetric ($\\nu = 0$) profile.\n- Case $3$ examines numerical robustness under strong skewness.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets.\n- For each test case, output a list of floating-point numbers $[F(x_0), x_{0.25}, x_{0.5}, x_{0.9}]$.\n- The full output is thus a list of three lists: $[[F_1,x_{0.25}^{(1)},x_{0.5}^{(1)},x_{0.9}^{(1)}],[F_2,x_{0.25}^{(2)},x_{0.5}^{(2)},x_{0.9}^{(2)}],[F_3,x_{0.25}^{(3)},x_{0.5}^{(3)},x_{0.9}^{(3)}]]$.",
            "solution": "We begin from the definition of implanted dose and cumulative fraction. The implanted dose $Q$ equals the integral of the concentration profile $C(x)$ over the physically relevant semi-infinite domain,\n$$\nQ = \\int_{0}^{\\infty} C(x)\\,dx.\n$$\nThe cumulative dose fraction up to depth $x_0$ is defined as\n$$\nF(x_0) = \\frac{1}{Q}\\int_{0}^{x_0} C(x)\\,dx.\n$$\nTo consistently model $C(x)$ via an analytic shape, we introduce the Pearson Type IV shape function\n$$\nS(x;\\mu,a,m,\\nu) = \\left(1 + \\left(\\frac{x - \\mu}{a}\\right)^2\\right)^{-m} \\exp\\!\\left(\\nu \\arctan\\!\\left(\\frac{x - \\mu}{a}\\right)\\right),\n$$\nwhere $x$ is the depth, $\\mu$ is the location parameter, $a$ is a positive scale parameter, $m$ controls the algebraic tail decay, and $\\nu$ controls skewness. The function $S(x;\\mu,a,m,\\nu)$ is positive for all $x$ and is integrable over $x \\in [0,\\infty)$ provided $m  \\frac{1}{2}$ (since the asymptotic behavior for large $|x|$ is $S(x) \\sim \\text{constant}\\cdot |x|^{-2m}$ after the skewness factor saturates as $\\arctan((x-\\mu)/a) \\to \\pm \\frac{\\pi}{2}$, and thus $\\int |x|^{-2m}\\,dx$ converges on $[0,\\infty)$ for $m  \\frac{1}{2}$). The skewness factor $\\exp(\\nu \\arctan(\\cdot))$ is bounded between $\\exp\\!\\left(-\\frac{\\nu \\pi}{2}\\right)$ and $\\exp\\!\\left(\\frac{\\nu \\pi}{2}\\right)$, so it does not destroy integrability.\n\nTo enforce the dose normalization over depths $x \\ge 0$, we compute the shape integral\n$$\nI(\\mu,a,m,\\nu) = \\int_{0}^{\\infty} S(x;\\mu,a,m,\\nu)\\,dx,\n$$\nand define\n$$\nC(x) = \\frac{Q}{I(\\mu,a,m,\\nu)}\\,S(x;\\mu,a,m,\\nu).\n$$\nBy construction, $\\int_{0}^{\\infty} C(x)\\,dx = Q$. Substituting $C(x)$ into the cumulative fraction,\n$$\nF(x_0) = \\frac{1}{Q}\\int_{0}^{x_0} \\frac{Q}{I(\\mu,a,m,\\nu)}\\,S(x;\\mu,a,m,\\nu)\\,dx = \\frac{\\int_{0}^{x_0} S(x;\\mu,a,m,\\nu)\\,dx}{\\int_{0}^{\\infty} S(x;\\mu,a,m,\\nu)\\,dx}.\n$$\nTherefore, $F(x_0)$ depends only on the shape parameters $(\\mu,a,m,\\nu)$ and not on $Q$, which cancels out. The function $F(x)$ is non-decreasing in $x$, $F(0)=0$, and $\\lim_{x\\to\\infty} F(x)=1$ under the given normalization.\n\nAlgorithmic design:\n\n$1.$ Numerical quadrature. We must evaluate two integrals of $S(x;\\mu,a,m,\\nu)$:\n- The normalization integral $I(\\mu,a,m,\\nu) = \\int_{0}^{\\infty} S(x;\\mu,a,m,\\nu)\\,dx$.\n- The numerator integral $N(x_0) = \\int_{0}^{x_0} S(x;\\mu,a,m,\\nu)\\,dx$.\n\nWe adopt adaptive quadrature over semi-infinite intervals via a widely used algorithm (for example, Gauss-Kronrod rules as implemented in standard quadrature routines). The semi-infinite integral is handled by numerical techniques that transform the infinite domain or adaptively subdivide it; we rely on the routine to ensure accuracy with tolerances set by absolute tolerance $10^{-9}$ and relative tolerance $10^{-9}$ for robust convergence. Thus,\n$$\nF(x_0) = \\frac{N(x_0)}{I(\\mu,a,m,\\nu)}.\n$$\n\n$2.$ Percentile depths. For a target fraction $p \\in (0,1)$, the percentile depth $x_p$ solves\n$$\nF(x_p) = p.\n$$\nThis is a monotone root-finding problem for the function\n$$\nG(x) = F(x) - p.\n$$\nBecause $F(x)$ is continuous and non-decreasing with $F(0)=0$ and $\\lim_{x\\to\\infty} F(x)=1$, there exists a solution $x_p \\in [0,\\infty)$ for any $p \\in (0,1)$. We find $x_p$ using a robust bracketing method:\n- Start with a finite upper bound $u$ (for example $u = \\max(\\mu + 10a,10a)$) and check whether $F(u) \\ge p$.\n- If $F(u)  p$, double $u$ until $F(u) \\ge p$ or until a predefined maximum bound (for example $u_{\\max} = 10^5$ nm) is reached; the latter is chosen to be physically large for typical implants.\n- Apply a bracketing root solver on $[0,u]$ to find $x_p$ that satisfies $G(x_p)=0$.\n\nThis procedure relies on the monotonicity of $F(x)$ and guarantees existence and uniqueness of $x_p$ within numerical tolerances for $p \\in (0,1)$.\n\nNumerical stability and physical realism:\n- The parameter $m$ is chosen in the test suite as $m \\ge 3.0$ and $m \\ge 4.0$ to ensure rapid decay of tails, which improves numerical convergence.\n- The skewness parameter $\\nu$ is tested at $\\nu = 0.0$ (symmetric profile) and $\\nu = 8.0$ (strong skewness) to validate robustness under varying asymmetry.\n- All angle evaluations use radians by the definition of $\\arctan(\\cdot)$.\n\nInterpretation of percentiles:\n- The depth $x_p$ represents the physical depth below which a fraction $p$ of the total implanted dose resides. For example, $x_{0.5}$ is a median depth of the dose distribution, and $x_{0.9}$ marks a depth beyond which only $10^{-1}$ of the dose remains.\n\nTest suite computations:\n- Case $1$: $Q = 1.0\\times 10^{13}$ ions/cm$^2$, $\\mu = 100$ nm, $a = 30$ nm, $m = 4.0$, $\\nu = 2.0$, $x_0 = 120$ nm, $p$ list $[0.25, 0.5, 0.9]$. Compute $F(120\\ \\text{nm})$ and $x_{0.25}$, $x_{0.5}$, $x_{0.9}$.\n- Case $2$: $Q = 5.0\\times 10^{12}$ ions/cm$^2$, $\\mu = 80$ nm, $a = 20$ nm, $m = 3.0$, $\\nu = 0.0$, $x_0 = 0$ nm, $p$ list $[0.25, 0.5, 0.9]$. Verify $F(0\\ \\text{nm}) = 0$ and compute the percentiles.\n- Case $3$: $Q = 1.0\\times 10^{13}$ ions/cm$^2$, $\\mu = 150$ nm, $a = 40$ nm, $m = 5.0$, $\\nu = 8.0$, $x_0 = 300$ nm, $p$ list $[0.25, 0.5, 0.9]$. Compute $F(300\\ \\text{nm})$ and the percentiles under strong skewness.\n\nOutput aggregation:\n- For each case, output a list $[F(x_0), x_{0.25}, x_{0.5}, x_{0.9}]$.\n- Aggregate the three case results into a single line:\n$$\n\\big[ [F_1, x_{0.25}^{(1)}, x_{0.5}^{(1)}, x_{0.9}^{(1)}], [F_2, x_{0.25}^{(2)}, x_{0.5}^{(2)}, x_{0.9}^{(2)}], [F_3, x_{0.25}^{(3)}, x_{0.5}^{(3)}, x_{0.9}^{(3)}] \\big].\n$$",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\nfrom scipy.optimize import brentq\n\ndef pearson_iv_shape(x, mu, a, m, nu):\n    \"\"\"\n    Pearson Type IV shape function:\n    S(x; mu, a, m, nu) = (1 + ((x - mu)/a)^2)^(-m) * exp( nu * arctan((x - mu)/a) )\n    All angles are in radians.\n    \"\"\"\n    y = (x - mu) / a\n    return (1.0 + y*y) ** (-m) * np.exp(nu * np.arctan(y))\n\ndef normalization_integral(mu, a, m, nu):\n    \"\"\"\n    Compute I(mu,a,m,nu) = integral_{0}^{inf} S(x; mu, a, m, nu) dx\n    using adaptive quadrature over a semi-infinite interval.\n    \"\"\"\n    # Tight tolerances for stability across skewed cases\n    val, _ = quad(lambda xx: pearson_iv_shape(xx, mu, a, m, nu),\n                  0.0, np.inf, epsabs=1e-9, epsrel=1e-9, limit=200)\n    return val\n\ndef cumulative_fraction(x0, I, mu, a, m, nu):\n    \"\"\"\n    Compute F(x0) = (integral_{0}^{x0} S(x;... ) dx) / I\n    \"\"\"\n    if x0 = 0.0:\n        return 0.0\n    num, _ = quad(lambda xx: pearson_iv_shape(xx, mu, a, m, nu),\n                  0.0, x0, epsabs=1e-9, epsrel=1e-9, limit=200)\n    return num / I\n\ndef percentile_depth(p, I, mu, a, m, nu):\n    \"\"\"\n    Solve F(x) = p for x using bracketing and root finding.\n    \"\"\"\n    # Monotone CDF: start with a reasonable upper bound and expand if needed.\n    ub = max(mu + 10.0 * a, 10.0 * a)\n    # Ensure ub is positive\n    ub = max(ub, 10.0)\n    # If F(ub)  p, expand ub until we bracket the root\n    def F_of_x(x):\n        return cumulative_fraction(x, I, mu, a, m, nu)\n    max_ub = 1e5  # nm, physically large\n    # Expand upper bound if necessary\n    while F_of_x(ub)  p and ub  max_ub:\n        ub *= 2.0\n    # In case numerical issues keep F(ub)  p but ub is huge, clamp p slightly\n    Fub = F_of_x(ub)\n    if Fub  p:\n        # If we cannot bracket perfectly due to numerical limitations, nudge p\n        # towards Fub to maintain a valid bracket. This is a rare fallback.\n        p_eff = min(p, max(0.999999, Fub))\n    else:\n        p_eff = p\n\n    # Root finding on G(x) = F(x) - p_eff\n    def G(x):\n        return F_of_x(x) - p_eff\n\n    # Brent's method requires a sign change; since F is monotone, G(0) = 0 and G(ub) = 0\n    # However, due to numerical errors, ensure the endpoints are not identical.\n    # If G(0) is slightly positive (unlikely), shift lower bound slightly.\n    lb = 0.0\n    Glb = G(lb)\n    if Glb  0.0:\n        lb = 1e-9\n        Glb = G(lb)\n\n    # If G(ub) is slightly negative due to numerical round-off, expand ub or adjust p_eff.\n    Gub = G(ub)\n    if Gub  0.0:\n        # Try expanding ub once more\n        ub = min(ub * 2.0, max_ub)\n        Gub = G(ub)\n        if Gub  0.0:\n            # Final fallback: return ub as approximate percentile\n            return ub\n\n    # Solve for root\n    x_root = brentq(G, lb, ub, xtol=1e-10, rtol=1e-10, maxiter=200)\n    return x_root\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (Q [ions/cm^2], mu [nm], a [nm], m, nu, x0 [nm], p_list)\n    test_cases = [\n        (1.0e13, 100.0, 30.0, 4.0, 2.0, 120.0, [0.25, 0.5, 0.9]),\n        (5.0e12,  80.0, 20.0, 3.0, 0.0,   0.0, [0.25, 0.5, 0.9]),\n        (1.0e13, 150.0, 40.0, 5.0, 8.0, 300.0, [0.25, 0.5, 0.9]),\n    ]\n\n    results = []\n    for case in test_cases:\n        Q, mu, a, m, nu, x0, p_list = case\n        # Compute normalization integral I over x in [0, inf)\n        I = normalization_integral(mu, a, m, nu)\n        # Compute cumulative fraction F(x0): Q cancels by construction\n        F_x0 = cumulative_fraction(x0, I, mu, a, m, nu)\n        # Compute percentiles\n        percentiles = []\n        for p in p_list:\n            xp = percentile_depth(p, I, mu, a, m, nu)\n            percentiles.append(xp)\n        # Compose result for this case: [F(x0), x_{p1}, x_{p2}, ...]\n        # Depths are in nm as per test case units.\n        case_result = [F_x0] + percentiles\n        results.append(case_result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}