{
    "hands_on_practices": [
        {
            "introduction": "实践始于一个基本问题：如何从物理第一性原理预测离子的注入深度？本练习将引导你使用离子在物质中能量损失的核心概念——阻止本领 (stopping power)，来推导注入能量与投影射程 ($R_p$) 之间的关系。通过这个实践，你将掌握将基本的能量损失模型转化为可预测的工艺参数的关键技能，为理解更复杂的分布模型打下基础。",
            "id": "4135397",
            "problem": "将轻离子注入硅片，通过适当的预非晶化和倾斜来抑制沟道效应。在所关注的能量窗口内，设电子阻止本领与离子速度成正比，核阻止本领与离子动能的平方根成正比，即假设 $S_{e}(E) \\propto v(E)$ 和 $S_{n}(E) \\propto \\sqrt{E}$，其中 $S_{e}$ 和 $S_{n}$ 分别是电子和核阻止本领，$v(E)$ 是能量为 $E$ 时的离子速度，$E$ 是离子动能。将投影射程视为能量损失的路径积分：$S(E) \\equiv -dE/dx$ 和 $R_{p}(E_{0}) \\equiv \\int_{0}^{E_{0}} \\frac{dE}{S(E)}$，其中 $E_{0}$ 是注入能量，$S(E) = S_{e}(E) + S_{n}(E)$。\n\n从这些定义和质量为 $m$ 的离子的运动学关系 $v(E) = \\sqrt{2E/m}$ 出发，推导在所述阻止本领假设下，硅中轻离子的投影射程 $R_{p}$ 随注入能量 $E_{0}$ 的标度关系。使用以下硼在硅中的代表性锚定测量值（以确定比例常数）来校准得到的标度关系：在 $E_{\\mathrm{ref}} = 20\\,\\mathrm{keV}$ 时，测得的投影射程为 $R_{p}(E_{\\mathrm{ref}}) = 67\\,\\mathrm{nm}$。使用此校准预测在 $E_{0} = 75\\,\\mathrm{keV}$ 时的 $R_{p}$。\n\n陈述您使用的任何中间符号关系，但必须报告最终的数值预测。以 $\\mathrm{nm}$ 为单位表示最终数值，并将您的答案四舍五入到四位有效数字。\n\n此外，在相同的阻止本领假设下，使用第一性原理推理，简要评论纵向歧离度和深度分布的更高阶矩对 $E_{0}$ 的预期定性依赖关系，无需计算数值。",
            "solution": "用户希望解决一个关于离子注入的问题。在继续之前，需要对问题陈述进行全面验证。\n\n### 步骤1：提取已知条件\n- 电子阻止本领：$S_{e}(E) \\propto v(E)$\n- 核阻止本领：$S_{n}(E) \\propto \\sqrt{E}$\n- 动能为 $E$ 时的离子速度：$v(E)$\n- 总阻止本领定义：$S(E) \\equiv -dE/dx$\n- 总阻止本领构成：$S(E) = S_{e}(E) + S_{n}(E)$\n- 投影射程定义：$R_{p}(E_{0}) \\equiv \\int_{0}^{E_{0}} \\frac{dE}{S(E)}$\n- 注入能量：$E_{0}$\n- 质量为 $m$ 的离子的运动学关系：$v(E) = \\sqrt{2E/m}$\n- 校准数据：在 $E_{\\mathrm{ref}} = 20\\,\\mathrm{keV}$ 时，测得的投影射程为 $R_{p}(E_{\\mathrm{ref}}) = 67\\,\\mathrm{nm}$。\n- 预测目标：计算 $E_{0} = 75\\,\\mathrm{keV}$ 时的 $R_{p}$。\n- 额外任务：定性描述纵向歧离度和更高阶矩对 $E_{0}$ 的依赖关系。\n\n### 步骤2：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n\n- **科学依据：**该问题基于离子阻止的 Lindhard-Scharff-Schiøtt (LSS) 理论，这是离子注入建模的基石。假设 $S_e \\propto v(E)$ 和 $S_n \\propto \\sqrt{E}$ 是特定能量范围内轻离子的公认近似。射程的积分定义是输运理论的基础。该问题在其所述近似范围内是科学合理的。\n- **适定性：**该问题为阻止本领提供了一个清晰的先验模型，为待计算量 ($R_p$) 提供了定义，并提供了一个校准数据点。这个设置是充分且自洽的，可以得到一个唯一的、稳定的解。\n- **客观性：**该问题以精确、定量的术语陈述，变量和关系定义清晰，没有主观性语言。\n\n该问题没有表现出任何诸如科学不合理、不完整、矛盾或模糊之类的缺陷。\n\n### 步骤3：结论和行动\n问题是有效的。将提供解答。\n\n第一步是推导总阻止本领 $S(E)$ 的显式函数形式。问题陈述，电子阻止本领 $S_e(E)$ 与离子速度 $v(E)$ 成正比，核阻止本领 $S_n(E)$ 与离子动能 $E$ 的平方根成正比。我们可以将其写为：\n$S_e(E) = k_e v(E)$\n$S_n(E) = k_n \\sqrt{E}$\n其中 $k_e$ 和 $k_n$ 是比例常数。\n\n问题提供了质量为 $m$ 的离子的速度与能量之间的非相对论运动学关系：\n$v(E) = \\sqrt{\\frac{2E}{m}}$\n\n我们将这个 $v(E)$ 的表达式代入 $S_e(E)$ 的方程中：\n$S_e(E) = k_e \\sqrt{\\frac{2E}{m}} = \\left( k_e \\sqrt{\\frac{2}{m}} \\right) \\sqrt{E}$\n\n这表明，在给定假设下，电子阻止本领 $S_e(E)$ 也与 $\\sqrt{E}$ 成正比。我们定义一个新常数 $c_e = k_e \\sqrt{2/m}$。那么，$S_e(E) = c_e \\sqrt{E}$。\n\n总阻止本领 $S(E)$ 是电子和核阻止分量的和：\n$S(E) = S_e(E) + S_n(E) = c_e \\sqrt{E} + k_n \\sqrt{E} = (c_e + k_n)\\sqrt{E}$\n\n让我们将这些常数合并为一个有效的比例常数 $C = c_e + k_n$。因此，总阻止本领为：\n$S(E) = C \\sqrt{E}$\n\n现在我们可以使用提供的积分定义来计算初始注入能量为 $E_0$ 时的投影射程 $R_p$：\n$R_p(E_0) = \\int_{0}^{E_0} \\frac{dE}{S(E)} = \\int_{0}^{E_0} \\frac{dE}{C\\sqrt{E}}$\n\n我们可以计算这个积分：\n$R_p(E_0) = \\frac{1}{C} \\int_{0}^{E_0} E^{-1/2} \\, dE = \\frac{1}{C} \\left[ \\frac{E^{1/2}}{1/2} \\right]_{0}^{E_0} = \\frac{1}{C} [2\\sqrt{E}]_{0}^{E_0} = \\frac{2\\sqrt{E_0}}{C}$\n\n这是投影射程的关键符号关系。它表明，在给定假设下，投影射程 $R_p$ 与注入能量 $E_0$ 的平方根成标度关系：\n$R_p(E_0) \\propto \\sqrt{E_0}$\n\n为了进行数值预测，我们不需要求出 $C$ 的值。相反，我们可以使用标度关系和提供的校准数据点。设 $K = 2/C$ 为总比例常数，使得 $R_p(E_0) = K\\sqrt{E_0}$。我们可以构建一个比率：\n$\\frac{R_p(E_0)}{R_p(E_{\\mathrm{ref}})} = \\frac{K\\sqrt{E_0}}{K\\sqrt{E_{\\mathrm{ref}}}} = \\sqrt{\\frac{E_0}{E_{\\mathrm{ref}}}}$\n\n这使我们能够使用参考值 $E_{\\mathrm{ref}} = 20\\,\\mathrm{keV}$ 和 $R_p(E_{\\mathrm{ref}}) = 67\\,\\mathrm{nm}$ 来计算新能量 $E_0 = 75\\,\\mathrm{keV}$ 时的投影射程。\n$R_p(75\\,\\mathrm{keV}) = R_p(20\\,\\mathrm{keV}) \\times \\sqrt{\\frac{75\\,\\mathrm{keV}}{20\\,\\mathrm{keV}}}$\n$R_p(75\\,\\mathrm{keV}) = (67\\,\\mathrm{nm}) \\times \\sqrt{\\frac{75}{20}} = (67\\,\\mathrm{nm}) \\times \\sqrt{3.75}$\n$R_p(75\\,\\mathrm{keV}) \\approx (67\\,\\mathrm{nm}) \\times 1.93649167 \\approx 129.74494\\,\\mathrm{nm}$\n\n按要求四舍五入到四位有效数字，预测的投影射程为 $129.7\\,\\mathrm{nm}$。\n\n最后，需要对纵向歧离度和更高阶矩对注入能量 $E_0$ 的依赖性进行简要的定性评论。深度分布的矩（射程、歧离度、偏度等）由离子能量损失过程的统计性质决定，该过程由大量离散碰撞组成。\n\n1.  **纵向歧离度 ($\\Delta R_p$)**：这是深度分布的二阶中心矩（方差 $\\Delta R_p^2$），用于衡量其宽度。方差是碰撞次数和性质的统计涨落的结果。中心极限定理的一个简单应用表明，总能量损失的方差与平均路径长度成正比，因此也与射程 $R_p$ 成正比。因此，可以预期 $\\Delta R_p^2 \\propto R_p$。由于我们发现 $R_p \\propto \\sqrt{E_0}$，这意味着方差的标度关系为 $\\Delta R_p^2 \\propto \\sqrt{E_0}$，而歧离度本身的标度关系为 $\\Delta R_p \\propto E_0^{1/4}$。歧离度随注入能量的增加而增加，但比射程增加得慢。这意味着相对歧离度 $\\Delta R_p / R_p \\propto E_0^{1/4} / E_0^{1/2} = E_0^{-1/4}$ 随着能量的增加而减小。在较高能量下，分布变得相对更窄。\n\n2.  **更高阶矩（偏度 $\\gamma_1$，峰度 $\\gamma_2$）**：偏度（三阶矩）描述分布的不对称性，而峰度（四阶矩）描述其“拖尾性”。对于离子注入，分布通常是不对称的（偏斜的），这是因为可能发生少数大角度核散射事件，这些事件会显著缩短离子的路径，从而在朝向表面的方向上产生一个拖尾。随着注入能量 $E_0$ 的增加，离子经历的总碰撞次数也会显著增加。根据中心极限定理，大量独立随机变量（单个碰撞中的能量损失）之和将趋向于正态（高斯）分布。高斯分布是完全对称的（$\\gamma_1 = 0$）并且超额峰度为零（$\\gamma_2 = 0$）。因此，随着 $E_0$ 的增加，离子分布预计会变得更像高斯分布。这意味着偏度和超额峰度的绝对值都将随着注入能量的增加而减小，并在高能极限下趋近于零。",
            "answer": "$$\n\\boxed{129.7}\n$$"
        },
        {
            "introduction": "理想的单峰高斯分布在描述晶体硅中的离子注入时常有不足，一个关键原因便是沟道效应。此练习构建了一个更贴近现实的双组分混合模型，将离子布居视为在晶格中随机散射的“非晶”部分和沿晶向深入的“沟道”部分的叠加。通过分析这个混合模型，你将学会如何运用高阶中心矩来定量描述这种复杂非对称分布的特征，这是精确工艺建模的一项核心能力。",
            "id": "4135414",
            "problem": "一块晶体硅片在垂直于晶片表面的方向上注入磷离子，注入时有微小失准，使得一部分离子发生沟道效应。一维投影射程坐标用 $x$ 表示，单位为纳米。投影射程分布被建模为一个双组分混合模型，其中沟道亚群和随机亚群均由沿 $x$ 轴的高斯密度函数表示，各自具有不同的平均投影射程 $R_{p}$ 和射程歧离 $\\Delta R_{p}$（沿投影射程轴的标准差）。设沟道组分比例为 $f\\in(0,1)$，沟道组分参数为 $R_{p,c}$ 和 $\\Delta R_{p,c}$，随机组分参数为 $R_{p,r}$ 和 $\\Delta R_{p,r}$。假设各组分相互独立，且每个组分的投影射程分布均为高斯分布。\n\n从混合概率密度函数和统计矩的定义出发，推导混合分布的前四阶中心矩 $\\mu_{k}$ 关于 $f$、$R_{p,c}$、$\\Delta R_{p,c}$、$R_{p,r}$ 和 $\\Delta R_{p,r}$ 的表达式。然后，对于给定的参数集\n- $f = 0.18$，\n- $R_{p,c} = 350$ nm, $\\Delta R_{p,c} = 90$ nm,\n- $R_{p,r} = 110$ nm, $\\Delta R_{p,r} = 35$ nm,\n计算混合分布的四阶中心矩 $\\mu_{4}$。\n\n将你的最终答案以 $\\text{nm}^4$ 为单位表示，并将数值结果四舍五入到四位有效数字。",
            "solution": "该问题经核实具有科学依据、提法明确且客观。这是半导体制造中离子注入轮廓统计建模的一个标准问题。\n\n一维投影射程分布被建模为一个双组分混合模型。其概率密度函数（PDF）$p(x)$ 是沟道组分 $p_c(x)$ 和随机组分 $p_r(x)$ 的概率密度函数的加权和：\n$$p(x) = f \\cdot p_c(x) + (1-f) \\cdot p_r(x)$$\n其中 $f$ 是沟道组分比例。每个组分都是一个高斯分布。\n沟道组分的均值为 $R_{p,c}$，标准差为 $\\Delta R_{p,c}$。其PDF为：\n$$p_c(x) = \\frac{1}{\\sqrt{2\\pi} \\Delta R_{p,c}} \\exp\\left(-\\frac{(x - R_{p,c})^2}{2 (\\Delta R_{p,c})^2}\\right)$$\n随机组分的均值为 $R_{p,r}$，标准差为 $\\Delta R_{p,r}$。其PDF为：\n$$p_r(x) = \\frac{1}{\\sqrt{2\\pi} \\Delta R_{p,r}} \\exp\\left(-\\frac{(x - R_{p,r})^2}{2 (\\Delta R_{p,r})^2}\\right)$$\n\n混合分布的 $k$ 阶中心矩 $\\mu_k$ 定义为 $\\mu_k = E[(X - \\mu_{mix})^k]$，其中 $X$ 是投影射程的随机变量，$\\mu_{mix}$ 是混合分布的均值。期望是针对混合PDF $p(x)$ 计算的。\n混合分布的均值是其一阶原点矩 $m_1' = E[X]$：\n$$\\mu_{mix} = E[X] = \\int_{-\\infty}^{\\infty} x p(x) dx = f \\int_{-\\infty}^{\\infty} x p_c(x) dx + (1-f) \\int_{-\\infty}^{\\infty} x p_r(x) dx$$\n$$\\mu_{mix} = f E_c[X] + (1-f) E_r[X] = f R_{p,c} + (1-f) R_{p,r}$$\n$k$ 阶中心矩可以用全期望定律表示：\n$$\\mu_k = E[(X-\\mu_{mix})^k] = f E_c[(X-\\mu_{mix})^k] + (1-f) E_r[(X-\\mu_{mix})^k]$$\n我们定义各组分均值到混合均值的距离：\n$$d_c = R_{p,c} - \\mu_{mix} = R_{p,c} - (fR_{p,c} + (1-f)R_{p,r}) = (1-f)(R_{p,c} - R_{p,r})$$\n$$d_r = R_{p,r} - \\mu_{mix} = R_{p,r} - (fR_{p,c} + (1-f)R_{p,r}) = f(R_{p,r} - R_{p,c}) = -f(R_{p,c} - R_{p,r})$$\n对于子分布 $j \\in \\{c, r\\}$，期望 $E_j[(X-\\mu_{mix})^k]$ 可以在其自身的均值 $R_{p,j}$ 附近展开：\n$$E_j[(X-\\mu_{mix})^k] = E_j[((X-R_{p,j}) + (R_{p,j}-\\mu_{mix}))^k] = E_j[((X-R_{p,j}) + d_j)^k]$$\n使用二项式展开，其中 $\\mu_{i,j}$ 是组分 $j$ 的 $i$ 阶中心矩：\n$$E_j[((X-R_{p,j}) + d_j)^k] = \\sum_{i=0}^{k} \\binom{k}{i} E_j[(X-R_{p,j})^i] d_j^{k-i} = \\sum_{i=0}^{k} \\binom{k}{i} \\mu_{i,j} d_j^{k-i}$$\n对于高斯分布，其中心矩是已知的：\n$\\mu_{0,j} = 1$，$\\mu_{1,j} = 0$，$\\mu_{2,j} = (\\Delta R_{p,j})^2$，$\\mu_{3,j} = 0$，$\\mu_{4,j} = 3(\\Delta R_{p,j})^4$。\n\n现在我们可以推导混合分布的前四阶中心矩。设 $\\delta = R_{p,c} - R_{p,r}$。则 $d_c = (1-f)\\delta$ 且 $d_r = -f\\delta$。\n\n一阶中心矩，$\\mu_1$：\n$\\mu_1 = f E_c[X-\\mu_{mix}] + (1-f) E_r[X-\\mu_{mix}] = f(\\mu_{1,c} + d_c) + (1-f)(\\mu_{1,r} + d_r) = f d_c + (1-f) d_r = f(1-f)\\delta + (1-f)(-f\\delta) = 0$。\n$$\\mu_1 = 0$$\n\n二阶中心矩，$\\mu_2$（方差）：\n$E_j[(X-\\mu_{mix})^2] = \\mu_{2,j} + d_j^2$。\n$\\mu_2 = f(\\mu_{2,c} + d_c^2) + (1-f)(\\mu_{2,r} + d_r^2) = f\\mu_{2,c} + (1-f)\\mu_{2,r} + f d_c^2 + (1-f) d_r^2$。\n最后两项是 $f((1-f)\\delta)^2 + (1-f)(-f\\delta)^2 = f(1-f)^2\\delta^2 + (1-f)f^2\\delta^2 = f(1-f)\\delta^2(1-f+f) = f(1-f)\\delta^2$。\n$$\\mu_2 = f(\\Delta R_{p,c})^2 + (1-f)(\\Delta R_{p,r})^2 + f(1-f)(R_{p,c}-R_{p,r})^2$$\n\n三阶中心矩，$\\mu_3$（与偏度相关）：\n$E_j[(X-\\mu_{mix})^3] = \\mu_{3,j} + 3\\mu_{2,j}d_j + d_j^3 = 3\\mu_{2,j}d_j + d_j^3$。\n$\\mu_3 = f(3\\mu_{2,c}d_c + d_c^3) + (1-f)(3\\mu_{2,r}d_r + d_r^3)$。\n包含 $\\mu_{2,j}$ 的项变为 $3(f\\mu_{2,c}d_c + (1-f)\\mu_{2,r}d_r) = 3(f\\mu_{2,c}(1-f)\\delta - (1-f)\\mu_{2,r}f\\delta) = 3f(1-f)\\delta(\\mu_{2,c}-\\mu_{2,r})$。\n包含 $d_j^3$ 的项变为 $f d_c^3 + (1-f) d_r^3 = f(1-f)^3\\delta^3 - (1-f)f^3\\delta^3 = f(1-f)\\delta^3((1-f)^2-f^2) = f(1-f)\\delta^3(1-2f)$。\n$$\\mu_3 = f(1-f)(R_{p,c}-R_{p,r})^3(1-2f) + 3f(1-f)(R_{p,c}-R_{p,r})((\\Delta R_{p,c})^2 - (\\Delta R_{p,r})^2)$$\n\n四阶中心矩，$\\mu_4$（与峰度相关）：\n$E_j[(X-\\mu_{mix})^4] = \\mu_{4,j} + 6\\mu_{2,j}d_j^2 + d_j^4$。\n$\\mu_4 = f(\\mu_{4,c} + 6\\mu_{2,c}d_c^2 + d_c^4) + (1-f)(\\mu_{4,r} + 6\\mu_{2,r}d_r^2 + d_r^4)$。\n我们将各项分组：\n1. 组分四阶中心矩的平均值：$f\\mu_{4,c} + (1-f)\\mu_{4,r} = 3(f(\\Delta R_{p,c})^4 + (1-f)(\\Delta R_{p,r})^4)$。\n2. 涉及方差和均值偏移的交叉项：$6(f\\mu_{2,c}d_c^2 + (1-f)\\mu_{2,r}d_r^2) = 6(f\\mu_{2,c}(1-f)^2\\delta^2 + (1-f)\\mu_{2,r}f^2\\delta^2) = 6f(1-f)\\delta^2((1-f)\\mu_{2,c} + f\\mu_{2,r})$。\n3. 均值偏移的四次方项：$f d_c^4 + (1-f) d_r^4 = f(1-f)^4\\delta^4 + (1-f)f^4\\delta^4 = f(1-f)\\delta^4((1-f)^3+f^3) = f(1-f)\\delta^4(1-3f+3f^2)$。\n将这些项组合起来，得到 $\\mu_4$ 的完整表达式：\n$$\\mu_4 = f(1-f)(1-3f+3f^2)(R_{p,c}-R_{p,r})^4 + 6f(1-f)(R_{p,c}-R_{p,r})^2 \\left[ (1-f)(\\Delta R_{p,c})^2 + f(\\Delta R_{p,r})^2 \\right] + 3 \\left[ f(\\Delta R_{p,c})^4 + (1-f)(\\Delta R_{p,r})^4 \\right]$$\n\n现在我们根据给定参数计算 $\\mu_4$ 的值：\n$f = 0.18$，$R_{p,c} = 350 \\, \\text{nm}$，$\\Delta R_{p,c} = 90 \\, \\text{nm}$，$R_{p,r} = 110 \\, \\text{nm}$，$\\Delta R_{p,r} = 35 \\, \\text{nm}$。\n首先，计算中间值（所有长度单位均为 nm）：\n$1-f = 0.82$\n$R_{p,c}-R_{p,r} = 350 - 110 = 240$\n$(\\Delta R_{p,c})^2 = 90^2 = 8100$\n$(\\Delta R_{p,r})^2 = 35^2 = 1225$\n$(\\Delta R_{p,c})^4 = 90^4 = 65,610,000$\n$(\\Delta R_{p,r})^4 = 35^4 = 1,500,625$\n\n我们计算 $\\mu_4$ 表达式中的三个主要项：\n第 1 项：$f(1-f)(1-3f+3f^2)(R_{p,c}-R_{p,r})^4$\n$1-3f+3f^2 = 1 - 3(0.18) + 3(0.18)^2 = 1 - 0.54 + 3(0.0324) = 0.46 + 0.0972 = 0.5572$。\n$f(1-f) = 0.18 \\times 0.82 = 0.1476$。\n$(R_{p,c}-R_{p,r})^4 = 240^4 = 3,317,760,000$。\n第 1 项 = $0.1476 \\times 0.5572 \\times 3,317,760,000 \\approx 272,873,431.3$。\n\n第 2 项：$6f(1-f)(R_{p,c}-R_{p,r})^2 \\left[ (1-f)(\\Delta R_{p,c})^2 + f(\\Delta R_{p,r})^2 \\right]$\n$(R_{p,c}-R_{p,r})^2 = 240^2 = 57600$。\n方括号中的项是 $[0.82 \\times 8100 + 0.18 \\times 1225] = [6642 + 220.5] = 6862.5$。\n第 2 项 = $6 \\times 0.1476 \\times 57600 \\times 6862.5 = 349,999,920$。\n\n第 3 项：$3 \\left[ f(\\Delta R_{p,c})^4 + (1-f)(\\Delta R_{p,r})^4 \\right]$\n方括号中的项是 $[0.18 \\times 65,610,000 + 0.82 \\times 1,500,625] = [11,809,800 + 1,230,512.5] = 13,040,312.5$。\n第 3 项 = $3 \\times 13,040,312.5 = 39,120,937.5$。\n\n最后，将这三项相加：\n$\\mu_4 = 272,873,431.3 + 349,999,920 + 39,120,937.5 = 661,994,288.8$。\n结果的单位是 $\\text{nm}^4$。\n四舍五入到四位有效数字，我们得到 $6.620 \\times 10^8$。",
            "answer": "$$\\boxed{6.620 \\times 10^{8}}$$"
        },
        {
            "introduction": "理论模型最终需要与实验测量相结合。本练习将理论付诸实践，模拟了分析二次离子质谱 (SIMS) 数据的真实工作流程。你将学习如何从离散的实验数据点中计算分布的各阶统计矩。更重要的是，此练习将向你展示如何修正由测量过程本身（如溅射展宽）引入的系统性展宽效应，从而从原始数据中提炼出真实的物理分布信息。",
            "id": "4135437",
            "problem": "给定一个离散采样的二次离子质谱（SIMS; Secondary Ion Mass Spectrometry）浓度分布，其在深度 $x_i$ 处测量，对应的浓度为 $C_i$，其中 $i=0,1,\\dots,n-1$。由于溅射引起的混合效应，SIMS测量会使真实的注入离子分布变宽，这通常被建模为一个标准差为 $s$（单位为纳米）的加性高斯核。您的任务是计算测量分布的前四阶中心矩的样本估计值，记为 $\\mu_1$、$\\mu_2$、$\\mu_3$ 和 $\\mu_4$，然后推导并报告在校正溅射展宽效应后得到的潜在真实矩的估计值。最后，使用一阶（线性）误差传播方法，评估仅由 $s$ 的不确定度 $u_s$（单位为纳米）引起的校正矩的不确定度。\n\n为确保科学真实性和数值一致性，请采用以下建模基础和计算约定：\n- 将测量得到的浓度分布 $C(x)$ 在归一化后视为与深度 $x$ 上的概率密度成正比。由于SIMS在离散点进行采样且典型的采样是非均匀的，因此为每个采样点 $x_i$ 关联一个局部控制体积宽度 $\\delta_i$，其定义为到相邻样本距离的一半（在两端使用前向或后向半间距，在其他地方使用中心半间距）。深度 $x_i$ 处的概率质量则与 $C_i \\delta_i$ 成正比。使用此方法构建满足 $\\sum_i w_i = 1$ 的归一化权重 $w_i$。\n- 使用这些权重，通过应用基于样本加权和的标准概率定义，计算样本平均深度 $\\mu_1$ 以及 $k \\in \\{2,3,4\\}$ 时的第 $k$ 阶中心矩 $\\mu_k$。\n- 将溅射展宽建模为一个在深度上与真实分布无关的、零均值的加性高斯变量。利用独立性的推论和卷积的性质来校正测量矩，以获得真实矩。假设高斯核的均值为零，方差为 $s^2$，且高斯分布的高阶累积量为零。\n- 通过一阶泰勒（线性）传播，使用关于 $s$ 的偏导数，来量化仅由溅射展宽标准差 $s$ 的不确定度 $u_s$ 引起的校正矩的不确定度。\n\n物理单位和报告要求：\n- 报告 $\\mu_1$ 的单位为纳米 ($\\text{nm}$)，$\\mu_2$ 的单位为平方纳米 ($\\text{nm}^2$)，$\\mu_3$ 的单位为立方纳米 ($\\text{nm}^3$)，$\\mu_4$ 的单位为四次方纳米 ($\\text{nm}^4$)。\n- 对于校正矩的不确定度，请以相应的相同单位报告标准不确定度。\n- 本问题不涉及角度。\n- 将所有数值输出表示为十进制浮点数。\n\n测试套件：\n计算并汇总以下三种情况的结果：\n\n1. 理想情况，近高斯分布，中等溅射展宽和均匀采样。\n   - 深度：$x_i$ 从 $0\\,\\text{nm}$ 到 $200\\,\\text{nm}$（含）均匀分布，步长为 $5\\,\\text{nm}$。\n   - 测量浓度：$C_i = \\exp\\left(-\\frac{1}{2}\\left(\\frac{x_i - 100}{30}\\right)^2\\right)$。\n   - 溅射展宽：$s = 5\\,\\text{nm}$，标准不确定度 $u_s = 0.5\\,\\text{nm}$。\n\n2. 偏斜长尾分布，非均匀采样和轻微溅射展宽。\n   - 深度：$x_i \\in \\{2,6,10,20,35,50,70,100,140,180\\}\\,\\text{nm}$。\n   - 测量浓度：$C_i$ 等于在 $x_i$ 处计算的对数正态密度，参数为 $\\mu_{\\log} = \\ln(60)$ 和 $\\sigma_{\\log}=0.5$，即 $C_i = \\frac{1}{x_i \\sigma_{\\log}\\sqrt{2\\pi}}\\exp\\left(-\\frac{(\\ln x_i - \\mu_{\\log})^2}{2\\sigma_{\\log}^2}\\right)$。\n   - 溅射展宽：$s = 3\\,\\text{nm}$，标准不确定度 $u_s = 0.3\\,\\text{nm}$。\n\n3. 边界情况，粗略、不规则采样且无溅射展宽。\n   - 深度：$x_i \\in \\{0,30,60,100,160,250\\}\\,\\text{nm}$。\n   - 测量浓度：在 $100\\,\\text{nm}$ 处达到峰值的三角形， $C_i = \\max\\left(0, 1 - \\frac{|x_i - 100|}{100}\\right)$。\n   - 溅射展宽：$s = 0\\,\\text{nm}$，标准不确定度 $u_s = 0\\,\\text{nm}$。\n\n最终输出规范：\n- 对于每个测试用例，计算并返回一个包含十个浮点数的列表，顺序为\n  $[\\mu_1^{\\text{meas}},\\mu_2^{\\text{meas}},\\mu_3^{\\text{meas}},\\mu_4^{\\text{meas}},\\mu_1^{\\text{true}},\\mu_2^{\\text{true}},\\mu_3^{\\text{true}},\\mu_4^{\\text{true}},u(\\mu_2^{\\text{true}}),u(\\mu_4^{\\text{true}})]$，\n  每个量均使用上述指定的单位表示。\n- 您的程序应生成单行输出，其中包含所有三个测试用例的结果，格式为一个逗号分隔的列表，并用方括号括起来。也就是说，输出必须类似于\n  $[[r_{1,1},\\dots,r_{1,10}],[r_{2,1},\\dots,r_{2,10}],[r_{3,1},\\dots,r_{3,10}]]$，\n  其中 $r_{j,k}$ 是十进制浮点数。",
            "solution": "目标是根据SIMS分布计算中心矩的离散估计值，然后针对建模为加性、独立高斯分布的溅射展宽效应对这些矩进行校正。这些步骤基于概率论以及与高斯核进行卷积的物理原理。\n\n1. 从SIMS数据构建离散概率。\n   测量得到的SIMS浓度 $C(x)$ 与注入离子深度分布和溅射诱导混合效应的卷积成正比。为将离散样本转换为概率模型，我们使用控制体积对积分进行离散化。对于样本点 $x_i$ 和测量浓度 $C_i$，定义局部控制体积宽度 $\\delta_i$ 如下\n   $$\n   \\delta_0 = \\frac{x_1 - x_0}{2}, \\quad \\delta_i = \\frac{x_{i+1} - x_{i-1}}{2} \\text{ for } i=1,\\dots,n-2, \\quad \\delta_{n-1} = \\frac{x_{n-1} - x_{n-2}}{2}.\n   $$\n   这将为每个样本分配一个等于到相邻样本距离一半的宽度，从而确保了在非均匀网格上的一致性。在 $x_i$ 处的未归一化质量为 $m_i = C_i \\delta_i$，总质量为 $M = \\sum_{i=0}^{n-1} m_i$。归一化以获得权重\n   $$w_i = \\frac{m_i}{M}, \\quad \\sum_{i=0}^{n-1} w_i = 1.$$\n\n2. 从离散概率计算样本中心矩。\n   使用权重 $w_i$，计算样本平均深度（投影射程），\n   $$\\mu_1^{\\text{meas}} = \\sum_{i=0}^{n-1} w_i x_i.$$\n   对于 $k \\in \\{2,3,4\\}$，第 $k$ 阶中心矩为\n   $$\\mu_k^{\\text{meas}} = \\sum_{i=0}^{n-1} w_i (x_i - \\mu_1^{\\text{meas}})^k.$$\n   具体来说，$\\mu_2^{\\text{meas}}$ 是方差（射程歧离平方），$\\mu_3^{\\text{meas}}$ 是三阶中心矩（与偏度相关），$\\mu_4^{\\text{meas}}$ 是四阶中心矩（与峰度相关）。单位由深度的幂次决定：$\\mu_1$ 的单位是 $\\text{nm}$，$\\mu_2$ 的单位是 $\\text{nm}^2$，$\\mu_3$ 的单位是 $\\text{nm}^3$，$\\mu_4$ 的单位是 $\\text{nm}^4$。\n\n3. 溅射展宽模型和校正。\n   设 $X$ 是真实的深度随机变量，其中心矩为 $\\mu_k^{\\text{true}}$，设 $Y \\sim \\mathcal{N}(0,s^2)$ 是一个代表溅射展宽的、与 $X$ 无关的零均值高斯变量。测量到的变量是 $Z = X + Y$。独立性意味着累积量是可加的。由于高斯分布的二阶以上累积量为零，我们有：\n   - 一阶中心矩（均值）：$\\mu_1^{\\text{meas}} = \\mu_1^{\\text{true}}.$\n   - 二阶中心矩（方差）：$\\mu_2^{\\text{meas}} = \\mu_2^{\\text{true}} + s^2.$\n   - 三阶中心矩：$\\mu_3^{\\text{meas}} = \\mu_3^{\\text{true}}.$\n   - 四阶中心矩：利用独立变量和的中心矩之间的关系，可得\n     $\\mu_4^{\\text{meas}} = \\mu_4^{\\text{true}} + 6 s^2 \\mu_2^{\\text{true}} + 3 s^4.$\n   解这些方程得到真实矩：\n   $$\n   \\mu_1^{\\text{true}} = \\mu_1^{\\text{meas}}, \\quad \\mu_2^{\\text{true}} = \\mu_2^{\\text{meas}} - s^2, \\quad \\mu_3^{\\text{true}} = \\mu_3^{\\text{meas}},\n   $$\n   $$\n   \\mu_4^{\\text{true}} = \\mu_4^{\\text{meas}} - 6 s^2 \\mu_2^{\\text{true}} - 3 s^4.\n   $$\n   等价地，从最后一个表达式中消去 $\\mu_2^{\\text{true}}$ 得到\n   $$\n   \\mu_4^{\\text{true}} = \\mu_4^{\\text{meas}} - 6 s^2 \\mu_2^{\\text{meas}} + 3 s^4.\n   $$\n\n4. 由溅射展宽不确定度引起的不确定度传播。\n   设 $u_s$ 是 $s$ 的标准不确定度。为评估仅考虑 $s$ 的不确定度时传播到校正矩中的不确定度，使用一阶泰勒传播（线性近似）。对于一个校正量 $q(s)$，其标准不确定度为\n   $$u(q) \\approx \\left|\\frac{\\partial q}{\\partial s}\\right| u_s.$$\n   将此应用于校正矩：\n   - 均值：$q(s) = \\mu_1^{\\text{true}} = \\mu_1^{\\text{meas}}, \\quad \\frac{\\partial q}{\\partial s} = 0, \\quad u(\\mu_1^{\\text{true}}) = 0.$\n   - 方差：$q(s) = \\mu_2^{\\text{true}} = \\mu_2^{\\text{meas}} - s^2, \\quad \\frac{\\partial q}{\\partial s} = -2s, \\quad u(\\mu_2^{\\text{true}}) = |-2s| u_s.$\n   - 三阶中心矩：$q(s) = \\mu_3^{\\text{true}} = \\mu_3^{\\text{meas}}, \\quad \\frac{\\partial q}{\\partial s} = 0, \\quad u(\\mu_3^{\\text{true}}) = 0.$\n   - 四阶中心矩：使用等价表达式，\n     $q(s) = \\mu_4^{\\text{true}} = \\mu_4^{\\text{meas}} - 6 s^2 \\mu_2^{\\text{meas}} + 3 s^4,$\n     $$\\frac{\\partial q}{\\partial s} = -12 s \\mu_2^{\\text{meas}} + 12 s^3,$$\n     $$u(\\mu_4^{\\text{true}}) = |-12 s \\mu_2^{\\text{meas}} + 12 s^3| u_s.$$\n   这些不确定度的单位分别为：$u(\\mu_2^{\\text{true}})$ 为 $\\text{nm}^2$，$u(\\mu_4^{\\text{true}})$ 为 $\\text{nm}^4$。\n\n5. 算法实现摘要。\n   - 根据 $x_i$ 构建 $\\delta_i$。\n   - 计算质量 $m_i = C_i \\delta_i$，总质量 $M$，以及归一化权重 $w_i = m_i/M$。\n   - 通过加权和计算 $\\mu_1^{\\text{meas}}$ 以及当 $k=2,3,4$ 时的 $\\mu_k^{\\text{meas}}$。\n   - 使用上述关系和给定的 $s$ 将其校正为 $\\mu_k^{\\text{true}}$。\n   - 通过关于 $s$ 的导数和给定的 $u_s$ 计算 $u(\\mu_2^{\\text{true}})$ 和 $u(\\mu_4^{\\text{true}})$。\n   - 对于每个测试用例，以所需的单行聚合格式输出列表 $[\\mu_1^{\\text{meas}},\\mu_2^{\\text{meas}},\\mu_3^{\\text{meas}},\\mu_4^{\\text{meas}},\\mu_1^{\\text{true}},\\mu_2^{\\text{true}},\\mu_3^{\\text{true}},\\mu_4^{\\text{true}},u(\\mu_2^{\\text{true}}),u(\\mu_4^{\\text{true}})]$。\n\n科学真实性说明：\n- 控制体积加权考虑了非均匀采样，避免了积分量中的偏差。\n- 溅射展宽的加性高斯模型在SIMS解释中被广泛使用；累积量相加和矩的校正源于独立变量和的基本性质以及高斯分布的特殊结构。\n- 一阶不确定度传播按要求分离了来自 $s$ 的贡献，并产生保守的线性化不确定度估计。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef cell_widths(x: np.ndarray) - np.ndarray:\n    \"\"\"\n    Compute control-volume widths for nonuniform sampling:\n    delta_0 = (x1 - x0)/2\n    delta_i = (x_{i+1} - x_{i-1})/2 for interior i\n    delta_{n-1} = (x_{n-1} - x_{n-2})/2\n    \"\"\"\n    x = np.asarray(x, dtype=float)\n    n = x.size\n    delta = np.empty(n, dtype=float)\n    if n == 1:\n        delta[0] = 1.0\n        return delta\n    delta[0] = (x[1] - x[0]) / 2.0\n    delta[-1] = (x[-1] - x[-2]) / 2.0\n    for i in range(1, n - 1):\n        delta[i] = (x[i + 1] - x[i - 1]) / 2.0\n    return delta\n\ndef normalized_weights(x: np.ndarray, C: np.ndarray) - np.ndarray:\n    \"\"\"\n    Compute normalized probability weights w_i proportional to C_i * delta_i,\n    where delta_i are the control-volume widths for nonuniform sampling.\n    \"\"\"\n    delta = cell_widths(x)\n    mass = C * delta\n    total_mass = np.sum(mass)\n    # Protect against zero total mass\n    if total_mass == 0:\n        # If total mass is zero or negative (should not happen with positive C),\n        # fallback to uniform weights\n        return np.ones_like(C, dtype=float) / C.size\n    w = mass / total_mass\n    return w\n\ndef measured_central_moments(x: np.ndarray, w: np.ndarray):\n    \"\"\"\n    Compute measured central moments: mu1, mu2, mu3, mu4 from weighted samples.\n    \"\"\"\n    mu1 = np.sum(w * x)\n    dx = x - mu1\n    mu2 = np.sum(w * dx**2)\n    mu3 = np.sum(w * dx**3)\n    mu4 = np.sum(w * dx**4)\n    return mu1, mu2, mu3, mu4\n\ndef correct_moments_for_sputter(mu1_meas, mu2_meas, mu3_meas, mu4_meas, s):\n    \"\"\"\n    Correct measured moments for sputter broadening modeled as additive Gaussian with std s.\n    \"\"\"\n    mu1_true = mu1_meas\n    mu2_true = mu2_meas - s**2\n    mu3_true = mu3_meas\n    mu4_true = mu4_meas - 6.0 * (s**2) * mu2_true - 3.0 * (s**4)\n    return mu1_true, mu2_true, mu3_true, mu4_true\n\ndef uncertainty_due_to_s(mu2_meas, s, u_s):\n    \"\"\"\n    Propagate uncertainty due to s into corrected moments using first-order derivatives.\n    Returns u(mu2_true), u(mu4_true).\n    \"\"\"\n    # d(mu2_true)/ds = -2 s\n    u_mu2_true = abs(-2.0 * s) * u_s\n    # Using mu4_true = mu4_meas - 6 s^2 mu2_meas + 3 s^4\n    # d(mu4_true)/ds = -12 s mu2_meas + 12 s^3\n    d_mu4_true_ds = -12.0 * s * mu2_meas + 12.0 * (s**3)\n    u_mu4_true = abs(d_mu4_true_ds) * u_s\n    return u_mu2_true, u_mu4_true\n\ndef test_case_1():\n    # Uniform grid, near-Gaussian profile\n    x = np.linspace(0.0, 200.0, 41)  # 0 to 200 nm, step 5 nm\n    sigma_m = 30.0  # nm\n    C = np.exp(-0.5 * ((x - 100.0) / sigma_m)**2)\n    s = 5.0   # nm\n    u_s = 0.5 # nm\n    return x, C, s, u_s\n\ndef test_case_2():\n    # Nonuniform grid, skewed log-normal profile\n    x = np.array([2, 6, 10, 20, 35, 50, 70, 100, 140, 180], dtype=float)\n    mu_log = np.log(60.0)\n    sigma_log = 0.5\n    C = (1.0 / (x * sigma_log * np.sqrt(2.0 * np.pi))) * np.exp(\n        -0.5 * ((np.log(x) - mu_log) / sigma_log)**2\n    )\n    s = 3.0   # nm\n    u_s = 0.3 # nm\n    return x, C, s, u_s\n\ndef test_case_3():\n    # Coarse, irregular grid, triangular profile, no sputter broadening\n    x = np.array([0, 30, 60, 100, 160, 250], dtype=float)\n    C = np.maximum(0.0, 1.0 - np.abs(x - 100.0) / 100.0)\n    s = 0.0   # nm\n    u_s = 0.0 # nm\n    return x, C, s, u_s\n\ndef compute_results_for_case(x, C, s, u_s):\n    w = normalized_weights(x, C)\n    mu1_meas, mu2_meas, mu3_meas, mu4_meas = measured_central_moments(x, w)\n    mu1_true, mu2_true, mu3_true, mu4_true = correct_moments_for_sputter(\n        mu1_meas, mu2_meas, mu3_meas, mu4_meas, s\n    )\n    u_mu2_true, u_mu4_true = uncertainty_due_to_s(mu2_meas, s, u_s)\n    return [\n        float(mu1_meas), float(mu2_meas), float(mu3_meas), float(mu4_meas),\n        float(mu1_true), float(mu2_true), float(mu3_true), float(mu4_true),\n        float(u_mu2_true), float(u_mu4_true)\n    ]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        test_case_1(),\n        test_case_2(),\n        test_case_3()\n    ]\n\n    results = []\n    for x, C, s, u_s in test_cases:\n        result = compute_results_for_case(x, C, s, u_s)\n        results.append(result)\n\n    # Final print statement in the exact required format: a single line containing\n    # a comma-separated list of the three case-result lists enclosed in square brackets.\n    # Example: [[r11,...,r1,10],[r21,...,r2,10],[r31,...,r3,10]]\n    def format_list(lst):\n        return \"[\" + \",\".join(str(v) for v in lst) + \"]\"\n\n    print(\"[\" + \",\".join(format_list(r) for r in results) + \"]\")\n\nsolve()\n```"
        }
    ]
}