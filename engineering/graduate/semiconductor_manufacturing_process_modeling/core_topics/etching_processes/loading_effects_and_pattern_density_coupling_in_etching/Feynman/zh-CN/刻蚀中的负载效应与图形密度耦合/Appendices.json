{
    "hands_on_practices": [
        {
            "introduction": "要理解负载效应，我们从一个最简单但功能强大的模型开始：将整个刻蚀腔室视为一个均匀混合的系统。本练习要求您从物种守恒的基本原理出发，推导刻蚀速率，揭示晶圆上的总裸露面积如何全局性地消耗反应物并影响工艺。通过比较两种不同的晶圆，您将量化“全局负载效应”()，并探讨如何调整反应器参数来减弱这种效应。",
            "id": "4139087",
            "problem": "一个单晶片等离子体刻蚀反应器被建模为一个连续搅拌釜式反应器（CSTR），其腔室体积 $V$ 内有充分混合的反应物种数密度 $c(t)$。反应器以固定的均匀体积生成速率 $F$（单位体积单位时间的生成数量）供应自由基，并以气体停留时间 $\\tau$ 进行抽气。反应物种在晶片表面通过一级表面动力学被消耗，其速率系数为 $k_s$（量纲为长度/时间）。全局图形密度负载通过正在处理的晶片所呈现的总反应开放面积 $A_{\\mathrm{open}}$ 体现。\n\n假设以下基于物理学的基础：\n- 在一个充分混合的体积中，物种守恒要求数密度 $c(t)$ 的时间演化必须平衡供应项、流出项和表面消耗项。\n- 一级表面反应动力学意味着单位开放面积的消耗通量与 $k_s c(t)$ 成正比，因此整个腔室的体积消耗项可表示为 $k_s c(t) A_{\\mathrm{open}} / V$。\n\n在相同的反应器条件下，分两次运行处理的两块晶片具有不同的全局开放面积分数 $\\phi_1$ 和 $\\phi_2$。晶片半径 $r = 0.15$ 米，腔室体积 $V = 5.0 \\times 10^{-2}$ 立方米，表面反应速率系数 $k_s = 1.0$ 米/秒，气体停留时间 $\\tau = 0.50$ 秒。开放面积分数分别为 $\\phi_1 = 0.20$ 和 $\\phi_2 = 0.50$。总晶片面积为 $A_{\\mathrm{w}} = \\pi r^2$，全局开放面积为 $A_{\\mathrm{open},i} = \\phi_i A_{\\mathrm{w}}$，其中 $i \\in \\{1,2\\}$。\n\n使用上述基础，推导出每个晶片上的稳态刻蚀速率，作为 $F$、$k_s$、$\\tau$、$V$ 和 $A_{\\mathrm{open}}$ 的函数，然后计算这两块晶片的稳态刻蚀速率之比 $R_1/R_2$。将最终比值四舍五入至四位有效数字，并以无量纲数表示。在你的论证中，从业界公认的负载敏感性角度，讨论计算出的比值对工艺窗口的影响，以及调整 $F$、$k_s$ 或 $\\tau$ 将如何改变图形密度耦合。",
            "solution": "该问题要求计算在模拟为连续搅拌釜式反应器（CSTR）的单晶片等离子体刻蚀反应器中处理的、具有不同图形密度的两块晶片的稳态刻蚀速率之比。首先，我们必须为反应器体积 $V$ 内的反应物种数密度 $c(t)$ 建立物种守恒方程。\n\n物种守恒原理指出，腔室内反应物种总数 $V c(t)$ 的变化率是生成速率、流出速率和消耗速率的总和。\n数密度 $c(t)$ 的时间演化由以下微分方程给出：\n$$\n\\frac{d(V c(t))}{dt} = (\\text{生成速率}) - (\\text{流出速率}) - (\\text{消耗速率})\n$$\n根据问题陈述，各项定义如下：\n$1$. 物种的生成速率由整个腔室体积 $V$ 内的体积生成速率 $F$（单位体积单位时间的数量）给出。因此，总生成速率为 $F V$。\n$2$. 流出速率由气体停留时间 $\\tau$ 决定。离开腔室的气体体积流率为 $Q = V/\\tau$。因流出造成的物种损失速率是该流率乘以物种浓度，即 $Q c(t) = (V/\\tau) c(t)$。\n$3$. 消耗速率发生在晶片表面。问题指出，消耗通量由一级动力学控制，单位开放面积的通量为 $k_s c(t)$。单位时间内消耗的粒子总数是该通量乘以总反应开放面积 $A_{\\mathrm{open}}$。因此，消耗速率为 $k_s c(t) A_{\\mathrm{open}}$。\n\n将这些项代入守恒方程得到：\n$$\n\\frac{d(V c(t))}{dt} = F V - \\frac{V}{\\tau} c(t) - k_s A_{\\mathrm{open}} c(t)\n$$\n由于体积 $V$ 是恒定的，我们可以两边同除以 $V$ 得到数密度 $c(t)$ 的方程：\n$$\n\\frac{dc(t)}{dt} = F - \\frac{c(t)}{\\tau} - \\frac{k_s A_{\\mathrm{open}}}{V} c(t)\n$$\n这可以重写为：\n$$\n\\frac{dc(t)}{dt} = F - c(t) \\left( \\frac{1}{\\tau} + \\frac{k_s A_{\\mathrm{open}}}{V} \\right)\n$$\n问题要求稳态刻蚀速率。在稳态下，数密度是恒定的，所以 $\\frac{dc(t)}{dt} = 0$。设 $c_{\\mathrm{ss}}$ 为稳态数密度。\n$$\n0 = F - c_{\\mathrm{ss}} \\left( \\frac{1}{\\tau} + \\frac{k_s A_{\\mathrm{open}}}{V} \\right)\n$$\n解出 $c_{\\mathrm{ss}}$ 得到：\n$$\nc_{\\mathrm{ss}} = \\frac{F}{\\frac{1}{\\tau} + \\frac{k_s A_{\\mathrm{open}}}{V}}\n$$\n刻蚀速率 $R$ 与反应物种到晶片表面的通量成正比。通量由 $k_s c(t)$ 给出。因此，我们可以将稳态刻蚀速率 $R$ 写为 $R = \\gamma k_s c_{\\mathrm{ss}}$，其中 $\\gamma$ 是一个比例常数（例如，刻蚀产额因子）。\n$$\nR = \\frac{\\gamma k_s F}{\\frac{1}{\\tau} + \\frac{k_s A_{\\mathrm{open}}}{V}}\n$$\n我们需要计算具有不同开放面积 $A_{\\mathrm{open},1}$ 和 $A_{\\mathrm{open},2}$ 的两块晶片的稳态刻蚀速率之比 $R_1/R_2$。两次运行的反应器条件（$F$、$k_s$、$\\tau$、$V$）和比例常数 $\\gamma$ 是相同的。\n$$\n\\frac{R_1}{R_2} = \\frac{\\frac{\\gamma k_s F}{\\frac{1}{\\tau} + \\frac{k_s A_{\\mathrm{open},1}}{V}}}{\\frac{\\gamma k_s F}{\\frac{1}{\\tau} + \\frac{k_s A_{\\mathrm{open},2}}{V}}}\n$$\n$\\gamma$、$k_s$ 和 $F$ 项相互抵消，剩下：\n$$\n\\frac{R_1}{R_2} = \\frac{\\frac{1}{\\tau} + \\frac{k_s A_{\\mathrm{open},2}}{V}}{\\frac{1}{\\tau} + \\frac{k_s A_{\\mathrm{open},1}}{V}}\n$$\n这个表达式显示了负载效应：刻蚀速率比不仅取决于各个晶片的特性，还取决于共享的反应器参数。这是因为反应物浓度是由腔室内的全局平衡决定的。\n\n现在我们代入给定的数值。\n晶片半径 $r = 0.15$ 米。\n总晶片面积 $A_{\\mathrm{w}} = \\pi r^2 = \\pi (0.15)^2 = 0.0225 \\pi$ 平方米。\n开放面积分数分别为 $\\phi_1 = 0.20$ 和 $\\phi_2 = 0.50$。\n相应的开放面积为：\n$A_{\\mathrm{open},1} = \\phi_1 A_{\\mathrm{w}} = 0.20 \\times 0.0225 \\pi = 0.0045 \\pi$ 平方米。\n$A_{\\mathrm{open},2} = \\phi_2 A_{\\mathrm{w}} = 0.50 \\times 0.0225 \\pi = 0.01125 \\pi$ 平方米。\n\n其他参数为：\n腔室体积 $V = 5.0 \\times 10^{-2}$ 立方米。\n表面反应速率系数 $k_s = 1.0$ 米/秒。\n气体停留时间 $\\tau = 0.50$ 秒。\n\n让我们计算比值表达式中的各项。抽气损失速率项为：\n$$\n\\frac{1}{\\tau} = \\frac{1}{0.50 \\text{ s}} = 2.0 \\text{ s}^{-1}\n$$\n单位浓度的消耗速率项为：\n$$\n\\frac{k_s A_{\\mathrm{open},1}}{V} = \\frac{(1.0 \\text{ m/s}) (0.0045 \\pi \\text{ m}^2)}{5.0 \\times 10^{-2} \\text{ m}^3} = \\frac{0.0045 \\pi}{0.05} \\text{ s}^{-1} = 0.09 \\pi \\text{ s}^{-1}\n$$\n$$\n\\frac{k_s A_{\\mathrm{open},2}}{V} = \\frac{(1.0 \\text{ m/s}) (0.01125 \\pi \\text{ m}^2)}{5.0 \\times 10^{-2} \\text{ m}^3} = \\frac{0.01125 \\pi}{0.05} \\text{ s}^{-1} = 0.225 \\pi \\text{ s}^{-1}\n$$\n现在，将这些代入比值表达式中：\n$$\n\\frac{R_1}{R_2} = \\frac{2.0 + 0.225 \\pi}{2.0 + 0.09 \\pi}\n$$\n使用 $\\pi \\approx 3.14159$ 的值，我们计算分子和分母：\n分子: $2.0 + 0.225 \\times 3.14159 \\approx 2.0 + 0.70686 = 2.70686$。\n分母: $2.0 + 0.09 \\times 3.14159 \\approx 2.0 + 0.28274 = 2.28274$。\n$$\n\\frac{R_1}{R_2} \\approx \\frac{2.70686}{2.28274} \\approx 1.18580\n$$\n四舍五入到四位有效数字，比值为 $1.186$。\n\n$R_1/R_2 > 1$ 这一事实表明了“负载效应”：开放面积较小的晶片（$\\phi_1 = 0.20$）比开放面积较大的晶片（$\\phi_2 = 0.50$）刻蚀得更快。这是因为较小的反应面积消耗的反应物较少，导致腔室中稳态浓度 $c_{\\mathrm{ss}}$ 更高，从而增加了到达表面的通量和刻蚀速率。\n\n工艺窗口影响的讨论：\n推导出的比值量化了图形密度负载。刻蚀速率对开放面积 $A_{\\mathrm{open}}$ 的敏感性取决于抽气损失项 $1/\\tau$ 和表面消耗项 $k_s A_{\\mathrm{open}}/V$ 的相对大小。\n- 表达式 $c_{\\mathrm{ss}} = F / (1/\\tau + k_s A_{\\mathrm{open}}/V)$ 表明，反应物浓度通过 $A_{\\mathrm{open}}$ 与晶片图形密度耦合。\n- 当消耗项 $k_s A_{\\mathrm{open}}/V$ 与抽气项 $1/\\tau$ 相当或更大时，会发生强耦合（即大的负载效应）。这使得刻蚀速率对图形密度高度敏感，这通常是不希望看到的，因为它会导致速率控制不佳和产品间的差异性。\n- 调整反应器参数可以改变这种耦合：\n  - **生成速率 ($F$)**：增加 $F$ 会按比例增加所有刻蚀速率（$R \\propto F$），但不会改变比率 $R_1/R_2$。因此，它不能减轻相对负载效应。\n  - **表面反应系数 ($k_s$)**：降低 $k_s$（例如，通过降低晶片温度）会减小消耗项相对于抽气项的比例。这将使比率 $R_1/R_2$ 趋近于 $1$，从而削弱图形密度耦合。该过程变得更受“流量限制”或“供应限制”。\n  - **停留时间 ($\\tau$)**：减小 $\\tau$（即增加气体流率 $Q = V/\\tau$）会增大抽气项 $1/\\tau$。这也使得消耗项在总平衡中的重要性降低，从而使比率 $R_1/R_2$ 趋近于 $1$，并降低负载敏感性。在高流率下操作是创建更稳健的工艺、拓宽对抗图形密度变化的窗口的常用策略。\n\n总之，为了最小化负载效应并扩展工艺窗口，应在表面反应导致的反应物消耗远小于流经腔室的反应物总流量的工况下操作。这对应于高气体流率（小 $\\tau$）和/或低表面反应性（小 $k_s$）。",
            "answer": "$$\n\\boxed{1.186}\n$$"
        },
        {
            "introduction": "尽管全局模型提供了一个很好的起点，但刻蚀速率同样会因周围的图形密度而在局部发生变化。本练习将带领我们从零维的腔室模型进入二维的空间模型，引入反应物浓度耦合的“屏蔽长度”这一关键概念。您将为一个理想化的圆形图形区域求解其控制输运方程()，运用高等数学技巧，得到其中心处反应物浓度下降的精确解析解。",
            "id": "4139082",
            "problem": "考虑一种中性蚀刻剂，其在硅片上的表面浓度 $c(\\mathbf{r})$ 通过扩散横向耦合，并在暴露的特征区域因一级反应而局部耗尽。设浓度降低量定义为 $\\Delta c(\\mathbf{r}) = c_{\\infty} - c(\\mathbf{r})$，其中 $c_{\\infty}$ 是远场浓度。在准稳态操作和线性响应下，一个广泛用于负载效应和图形密度耦合的均质化面内输运模型假定 $\\Delta c(\\mathbf{r})$ 服从二维筛选泊松偏微分方程 (PDE)\n$$\n\\left( \\nabla_{\\parallel}^{2} - \\lambda^{2} \\right)\\,\\Delta c(\\mathbf{r}) \\;=\\; -\\,\\alpha\\,\\rho(\\mathbf{r}),\n$$\n其中 $\\nabla_{\\parallel}^{2}$ 是晶圆平面内的拉普拉斯算子，$\\lambda>0$ 是逆筛选长度，$\\alpha>0$ 是一个由工艺参数（扩散系数、边界层交换和反应动力学）设定的比例常数，$\\rho(\\mathbf{r})$ 是单位占地面积的局部暴露面积密度。\n\n假设一个以 $\\mathbf{r}=\\mathbf{0}$ 为中心、半径为 $R$ 的单一圆形密集区域（圆盘）具有均匀的图形密度，即当 $|\\mathbf{r}|\\le R$ 时 $\\rho(\\mathbf{r})=\\rho_{0}$，当 $|\\mathbf{r}|>R$ 时 $\\rho(\\mathbf{r})=0$。此外，假设晶圆足够大，以至于边界影响可以忽略不计。使用适用于该偏微分方程的柱坐标和修正贝塞尔函数形式体系，推导中心点 $\\mathbf{0}$ 处的浓度降低量 $\\Delta c(\\mathbf{0})$ 关于 $\\alpha$、$\\lambda$、$\\rho_{0}$ 和 $R$ 的精确解析表达式。将你的最终答案表示为单个闭式表达式。无需进行数值计算或四舍五入。",
            "solution": "该问题要求解圆形区域中心的浓度降低量 $\\Delta c(\\mathbf{r})$。其控制偏微分方程 (PDE) 是二维筛选泊松方程：\n$$\n\\left( \\nabla_{\\parallel}^{2} - \\lambda^{2} \\right)\\,\\Delta c(\\mathbf{r}) \\;=\\; -\\,\\alpha\\,\\rho(\\mathbf{r})\n$$\n其中 $\\mathbf{r}$ 是晶圆平面内的位置矢量。源项 $\\rho(\\mathbf{r})$ 是图形密度，在半径为 $R$ 的圆盘内为常数 $\\rho_0$，在圆盘外为零：\n$$\n\\rho(\\mathbf{r}) = \\begin{cases} \\rho_{0}  \\text{for } |\\mathbf{r}| \\le R \\\\ 0  \\text{for } |\\mathbf{r}| > R \\end{cases}\n$$\n这个问题最好用格林函数法求解。对于二维空间中的算子 $(\\nabla_{\\parallel}^{2} - \\lambda^{2})$，在解于无穷远处消失的边界条件下，其格林函数 $G(\\mathbf{r}, \\mathbf{r'})$ 由下式给出：\n$$\nG(\\mathbf{r}, \\mathbf{r'}) \\;=\\; -\\frac{1}{2\\pi} K_{0}(\\lambda |\\mathbf{r} - \\mathbf{r'}|)\n$$\n其中 $K_{0}$ 是零阶第二类修正贝塞尔函数。该函数满足方程 $(\\nabla_{\\parallel}^{2} - \\lambda^{2}) G(\\mathbf{r}, \\mathbf{r'}) = \\delta(\\mathbf{r} - \\mathbf{r'})$。\n\n解 $\\Delta c(\\mathbf{r})$ 可以表示为格林函数与源项 $-\\alpha\\rho(\\mathbf{r})$ 的卷积：\n$$\n\\Delta c(\\mathbf{r}) = \\int_{\\mathbb{R}^2} G(\\mathbf{r}, \\mathbf{r'}) \\left( -\\alpha\\,\\rho(\\mathbf{r'}) \\right) \\,d^2\\mathbf{r'}\n$$\n代入格林函数的表达式，我们得到：\n$$\n\\Delta c(\\mathbf{r}) = \\int_{\\mathbb{R}^2} \\left(-\\frac{1}{2\\pi} K_{0}(\\lambda |\\mathbf{r} - \\mathbf{r'}|)\\right) \\left( -\\alpha\\,\\rho(\\mathbf{r'}) \\right) \\,d^2\\mathbf{r'}\n$$\n$$\n\\Delta c(\\mathbf{r}) = \\frac{\\alpha}{2\\pi} \\int_{\\mathbb{R}^2} \\rho(\\mathbf{r'}) K_{0}(\\lambda |\\mathbf{r} - \\mathbf{r'}|) \\,d^2\\mathbf{r'}\n$$\n我们需要在圆盘的中心，即 $\\mathbf{r} = \\mathbf{0}$ 处，计算这个表达式的值。\n$$\n\\Delta c(\\mathbf{0}) = \\frac{\\alpha}{2\\pi} \\int_{\\mathbb{R}^2} \\rho(\\mathbf{r'}) K_{0}(\\lambda |-\\mathbf{r'}|) \\,d^2\\mathbf{r'}\n$$\n由于 $\\rho(\\mathbf{r'})$ 仅在 $|\\mathbf{r'}| \\le R$ 时非零（此时其值为 $\\rho_0$），且 $|-\\mathbf{r'}| = |\\mathbf{r'}|$，积分变为：\n$$\n\\Delta c(\\mathbf{0}) = \\frac{\\alpha \\rho_{0}}{2\\pi} \\int_{|\\mathbf{r'}| \\le R} K_{0}(\\lambda |\\mathbf{r'}|) \\,d^2\\mathbf{r'}\n$$\n为了计算这个在圆盘上的积分，我们将积分变量 $\\mathbf{r'}$ 切换到极坐标。令 $r' = |\\mathbf{r'}|$，$θ'$ 为极角。面积微元为 $d^2\\mathbf{r'} = r' dr' d\\theta'$。\n$$\n\\Delta c(\\mathbf{0}) = \\frac{\\alpha \\rho_{0}}{2\\pi} \\int_{0}^{2\\pi} \\int_{0}^{R} K_{0}(\\lambda r') \\,r' dr' d\\theta'\n$$\n被积函数与 $\\theta'$ 无关，因此角度积分产生一个因子 $2\\pi$：\n$$\n\\Delta c(\\mathbf{0}) = \\frac{\\alpha \\rho_{0}}{2\\pi} \\cdot 2\\pi \\int_{0}^{R} r' K_{0}(\\lambda r') \\,dr'\n$$\n$$\n\\Delta c(\\mathbf{0}) = \\alpha \\rho_{0} \\int_{0}^{R} r' K_{0}(\\lambda r') \\,dr'\n$$\n为求解剩下的积分，我们使用修正贝塞尔函数的以下恒等式：\n$$\n\\frac{d}{dx}\\left[x^{\\nu} K_{\\nu}(x)\\right] = -x^{\\nu} K_{\\nu-1}(x)\n$$\n对于 $\\nu=1$，该恒等式变为：\n$$\n\\frac{d}{dx}\\left[x K_{1}(x)\\right] = -x K_{0}(x)\n$$\n这意味着 $\\int x K_{0}(x) \\,dx = -x K_{1}(x)$。我们用这个公式来计算我们的定积分。令 $u = \\lambda r'$，则 $du = \\lambda dr'$。积分上下限从 $r' \\in [0, R]$ 变为 $u \\in [0, \\lambda R]$。\n$$\n\\int_{0}^{R} r' K_{0}(\\lambda r') \\,dr' = \\int_{0}^{\\lambda R} \\frac{u}{\\lambda} K_{0}(u) \\frac{du}{\\lambda} = \\frac{1}{\\lambda^2} \\int_{0}^{\\lambda R} u K_{0}(u) \\,du\n$$\n使用积分公式：\n$$\n\\frac{1}{\\lambda^2} \\int_{0}^{\\lambda R} u K_{0}(u) \\,du = \\frac{1}{\\lambda^2} \\left[ -u K_{1}(u) \\right]_{0}^{\\lambda R}\n$$\n上限的计算结果为 $-(\\lambda R) K_{1}(\\lambda R)$。对于下限，我们必须考虑当 $u \\to 0$ 时 $u K_{1}(u)$ 的行为。对于小的 $u$，$K_{1}(u)$ 的渐近形式是 $K_{1}(u) \\sim 1/u$。因此：\n$$\n\\lim_{u \\to 0^+} u K_{1}(u) = \\lim_{u \\to 0^+} u \\cdot \\frac{1}{u} = 1\n$$\n所以定积分为：\n$$\n\\frac{1}{\\lambda^2} \\left( -(\\lambda R) K_{1}(\\lambda R) - (-1) \\right) = \\frac{1}{\\lambda^2} \\left( 1 - \\lambda R K_{1}(\\lambda R) \\right)\n$$\n将此结果代回 $\\Delta c(\\mathbf{0})$ 的表达式中：\n$$\n\\Delta c(\\mathbf{0}) = \\alpha \\rho_{0} \\cdot \\frac{1}{\\lambda^2} \\left( 1 - \\lambda R K_{1}(\\lambda R) \\right)\n$$\n这就得到了中心点浓度降低量的最终闭式表达式。\n$$\n\\Delta c(\\mathbf{0}) = \\frac{\\alpha \\rho_{0}}{\\lambda^2} \\left( 1 - \\lambda R K_{1}(\\lambda R) \\right)\n$$",
            "answer": "$$\\boxed{\\frac{\\alpha \\rho_{0}}{\\lambda^{2}} \\left( 1 - \\lambda R K_{1}(\\lambda R) \\right)}$$"
        },
        {
            "introduction": "像前一个练习中的解析模型虽然能够有力地帮助我们建立物理直觉，但它们通常仅限于简单的几何形状。最后的这项实践练习将理论与实际应用联系起来，要求您通过编写代码实现一个基于核函数卷积的图形密度耦合计算模型()——这正是工业界广泛使用的一种技术。通过在复杂的棋盘格图形上模拟刻蚀过程，并比较基于物理的模型与简化模型的精度，您将获得评估模型准确性和理解工艺仿真中各种权衡的实践经验。",
            "id": "4139148",
            "problem": "您的任务是实现并比较两种用于预测等离子体刻蚀中负载效应下图形密度耦合的预测模型，该过程使用合成的棋盘格布局。目标是通过计算开放特征区域的平均绝对误差，来评估核卷积模型相对于简化的线性局域密度模型的预测准确度。建模必须从输运-反应描述出发，并推导出所使用的算法表达式。研究的区域是一个周期性的方形晶圆片区，并在网格上进行建模。\n\n基本原理：\n- 令位置 $(x,y)$ 处的瞬时刻蚀速率表示为 $R(x,y)$，其局域开放面积指示函数为 $P(x,y)$。在时长 $T$ 内，时间积分的刻蚀深度为 $H(x,y)$。开放面积指示函数 $P(x,y)$ 是二值的，对于开放区域 $P(x,y)=1$，对于掩模区域 $P(x,y)=0$。\n- 在稳态气相输运和表面反应条件下，令局域反应物浓度为 $c(x,y)$，无负载时的基线浓度为 $c_{\\infty}$。由于分布式的消耗，负载会降低 $c(x,y)$。对于一个具有周期性边界条件和屏蔽扩散的层，屏蔽泊松格林函数呈指数衰减，其特征长度为 $L$。这证明了可以通过 $P(x,y)$ 与一个归一化的、随径向距离 $r$ 以 $\\exp(-r/L)$ 形式衰减的核函数进行空间卷积，来表示粗粒化的耗尽。\n- 假设为一阶表面反应，因此在开放特征区域上，局域刻蚀速率与 $c(x,y)$ 线性相关。\n\n待实现模型的定义：\n- 基准真相模型（参考扩散-反应模型）：$R_{\\mathrm{true}}(x,y) = R_{0}\\,P(x,y)\\,\\frac{c(x,y)}{c_{\\infty}}$，其中耗尽由一个归一化的指数核函数表示。定义相对浓度为 $\\frac{c(x,y)}{c_{\\infty}} = \\max\\left(0,\\,1 - \\phi_{\\mathrm{true}}\\;\\left(P * K_{L_{\\mathrm{true}}}\\right)(x,y)\\right)$，其中 $*$ 表示周期性卷积，$K_{L}$ 是与长度 $L$ 相关的归一化核函数，$\\phi_{\\mathrm{true}}$ 是一个无量纲的耗尽幅度。真实的刻蚀深度为 $H_{\\mathrm{true}}(x,y) = R_{\\mathrm{true}}(x,y)\\,T$。\n- 核卷积模型（预测模型）：$R_{\\mathrm{ker}}(x,y) = R_{0}\\,P(x,y)\\,\\max\\left(0,\\,1 - \\phi_{\\mathrm{model}}\\;\\left(P * K_{L_{\\mathrm{model}}}\\right)(x,y)\\right)$ 且 $H_{\\mathrm{ker}}(x,y) = R_{\\mathrm{ker}}(x,y)\\,T$，其模型参数 $L_{\\mathrm{model}}$ 和 $\\phi_{\\mathrm{model}}$ 可能与基准真相不匹配。\n- 简化的线性局域密度模型（预测模型）：定义 $P(x,y)$ 在一个半宽为 $w$（单位为像素）的周期性方窗内的平均值为 $f_{\\mathrm{local}}(x,y) = P * U_{w}$，其中 $U_{w}$ 是一个归一化的方窗核函数。预测的速率为 $R_{\\mathrm{lin}}(x,y) = R_{0}\\,P(x,y)\\,\\max\\left(0,\\,1 - k_{\\mathrm{lin}}\\;f_{\\mathrm{local}}(x,y)\\right)$ 且 $H_{\\mathrm{lin}}(x,y) = R_{\\mathrm{lin}}(x,y)\\,T$，其中 $k_{\\mathrm{lin}}$ 是一个无量纲斜率。\n\n棋盘格图形：\n- 在一个 $N \\times N$ 的网格上，像素间距为 $d_{x}$（单位为微米），创建一个棋盘格，其中如果 $\\left\\lfloor \\frac{i}{s} \\right\\rfloor + \\left\\lfloor \\frac{j}{s} \\right\\rfloor$ 是偶数，则 $P(i,j)=1$，否则 $P(i,j)=0$。$s$ 是方格的边长（单位为像素）。索引 $i,j$ 从 $0$ 开始。\n\n核函数构建：\n- 使用周期性边界条件，并通过快速傅里叶变换（FFT）执行卷积，以将晶圆片区建模为环形。对于指数核函数 $K_{L}$，使用最小镜像周期距离：$r(i,j) = \\sqrt{(\\min(i, N-i)\\,d_{x})^{2} + (\\min(j, N-j)\\,d_{x})^{2}}$。构建 $K_{L}(i,j) \\propto \\exp\\left(-\\frac{r(i,j)}{L}\\right)$ 并进行归一化，使得 $\\sum_{i,j} K_{L}(i,j) = 1$。对于方窗核函数 $U_{w}$，对于满足 $\\min(i, N-i) \\leq w$ 且 $\\min(j, N-j) \\leq w$ 的索引，设置 $U_{w}(i,j) = 1$，否则 $U_{w}(i,j) = 0$，然后进行归一化。\n\n误差度量：\n- 仅对开放特征区域计算平均绝对误差：$\\mathrm{MAE}_{\\mathrm{ker}} = \\frac{1}{M}\\sum_{P(i,j)=1} \\left|H_{\\mathrm{ker}}(i,j) - H_{\\mathrm{true}}(i,j)\\right|$，以及 $\\mathrm{MAE}_{\\mathrm{lin}} = \\frac{1}{M}\\sum_{P(i,j)=1} \\left|H_{\\mathrm{lin}}(i,j) - H_{\\mathrm{true}}(i,j)\\right|$，其中 $M$ 是开放像素的数量。两个结果均以纳米为单位报告。\n\n单位：\n- 基线刻蚀速率 $R_{0}$ 必须以纳米/秒（$\\mathrm{nm/s}$）为单位。\n- 时长 $T$ 必须以秒（$\\mathrm{s}$）为单位。\n- 像素间距 $d_{x}$、长度 $L_{\\mathrm{true}}$ 和 $L_{\\mathrm{model}}$、以及窗口半径 $r_{w}$ 必须以微米（$\\mu\\mathrm{m}$）为单位。\n- 平均绝对误差必须以纳米（$\\mathrm{nm}$）为单位，作为浮点数报告。\n\n测试套件：\n为以下参数集实现上述内容。对于每种情况，计算 $\\mathrm{MAE}_{\\mathrm{ker}}$ 和 $\\mathrm{MAE}_{\\mathrm{lin}}$。\n\n- 情况 1（理想情况，中等耦合和轻微模型失配）：\n    - $N=64$，$s=8$，$d_{x}=0.2$ $\\mu\\mathrm{m}$，$R_{0}=5$ $\\mathrm{nm/s}$，$T=10$ $\\mathrm{s}$，$L_{\\mathrm{true}}=2.0$ $\\mu\\mathrm{m}$，$\\phi_{\\mathrm{true}}=0.35$，$L_{\\mathrm{model}}=1.8$ $\\mu\\mathrm{m}$，$\\phi_{\\mathrm{model}}=0.30$，$k_{\\mathrm{lin}}=0.28$，$r_{w}=2.5$ $\\mu\\mathrm{m}$。\n- 情况 2（边界情况，接近局域行为的短程耦合）：\n    - $N=64$，$s=8$，$d_{x}=0.2$ $\\mu\\mathrm{m}$，$R_{0}=5$ $\\mathrm{nm/s}$，$T=10$ $\\mathrm{s}$，$L_{\\mathrm{true}}=0.3$ $\\mu\\mathrm{m}$，$\\phi_{\\mathrm{true}}=0.25$，$L_{\\mathrm{model}}=0.5$ $\\mu\\mathrm{m}$，$\\phi_{\\mathrm{model}}=0.25$，$k_{\\mathrm{lin}}=0.20$，$r_{w}=0.6$ $\\mu\\mathrm{m}$。\n- 情况 3（极端情况，强耗尽和长程耦合）：\n    - $N=64$，$s=4$，$d_{x}=0.2$ $\\mu\\mathrm{m}$，$R_{0}=5$ $\\mathrm{nm/s}$，$T=10$ $\\mathrm{s}$，$L_{\\mathrm{true}}=3.5$ $\\mu\\mathrm{m}$，$\\phi_{\\mathrm{true}}=0.85$，$L_{\\mathrm{model}}=3.0$ $\\mu\\mathrm{m}$，$\\phi_{\\mathrm{model}}=0.70$，$k_{\\mathrm{lin}}=0.60$，$r_{w}=4.0$ $\\mu\\mathrm{m}$。\n- 情况 4（极端情况，像素尺度的细粒度棋盘格）：\n    - $N=64$，$s=1$，$d_{x}=0.2$ $\\mu\\mathrm{m}$，$R_{0}=5$ $\\mathrm{nm/s}$，$T=10$ $\\mathrm{s}$，$L_{\\mathrm{true}}=1.0$ $\\mu\\mathrm{m}$，$\\phi_{\\mathrm{true}}=0.40$，$L_{\\mathrm{model}}=1.2$ $\\mu\\mathrm{m}$，$\\phi_{\\mathrm{model}}=0.35$，$k_{\\mathrm{lin}}=0.30$，$r_{w}=1.2$ $\\mu\\mathrm{m}$。\n- 情况 5（边界情况，无真实耗尽但模型被错误指定）：\n    - $N=64$，$s=8$，$d_{x}=0.2$ $\\mu\\mathrm{m}$，$R_{0}=5$ $\\mathrm{nm/s}$，$T=10$ $\\mathrm{s}$，$L_{\\mathrm{true}}=2.0$ $\\mu\\mathrm{m}$，$\\phi_{\\mathrm{true}}=0.0$，$L_{\\mathrm{model}}=1.8$ $\\mu\\mathrm{m}$，$\\phi_{\\mathrm{model}}=0.30$，$k_{\\mathrm{lin}}=0.50$，$r_{w}=2.0$ $\\mu\\mathrm{m}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，值按 $[\\mathrm{MAE}_{\\mathrm{ker}}^{(1)},\\mathrm{MAE}_{\\mathrm{lin}}^{(1)},\\mathrm{MAE}_{\\mathrm{ker}}^{(2)},\\mathrm{MAE}_{\\mathrm{lin}}^{(2)},\\dots,\\mathrm{MAE}_{\\mathrm{ker}}^{(5)},\\mathrm{MAE}_{\\mathrm{lin}}^{(5)}]$ 的顺序排列，以纳米（$\\mathrm{nm}$）为单位表示为浮点数。",
            "solution": "问题的核心在于为等离子体刻蚀过程中的化学反应物空间耗尽进行建模。假设刻蚀速率 $R$ 在开放（未掩模）特征区域上与局域反应物浓度 $c(x,y)$ 成正比。开放特征区域的图形由二值掩模 $P(x,y)$ 表示，其中 $P(x,y)=1$ 代表开放区域，$P(x,y)=0$ 代表掩模区域。\n\n基准真相模型基于稳态扩散-反应方程，其中反应物浓度的空间分布源于从基线浓度 $c_{\\infty}$ 的供给与在晶圆表面的消耗之间的平衡。对于一个具有周期性边界条件和屏蔽扩散的系统，分布式消耗的影响可以通过空间卷积来描述。相对浓度由下式给出：\n$$\n\\frac{c(x,y)}{c_{\\infty}} = \\max\\left(0,\\,1 - \\phi_{\\mathrm{true}}\\;\\left(P * K_{L_{\\mathrm{true}}}\\right)(x,y)\\right)\n$$\n这里，$*$ 表示二维周期性卷积。核函数 $K_{L_{\\mathrm{true}}}$ 代表了底层输运过程的格林函数，对于屏蔽扩散，该函数随特征长度 $L_{\\mathrm{true}}$ 指数衰减。项 $\\phi_{\\mathrm{true}}$ 是一个无量纲常数，代表耗尽的强度。开放特征区域上的局域刻蚀速率则为 $R_{\\mathrm{true}}(x,y) = R_{0}\\,P(x,y)\\,(c(x,y)/c_{\\infty})$，在时间 $T$ 内的最终刻蚀深度为 $H_{\\mathrm{true}}(x,y) = R_{\\mathrm{true}}(x,y) \\cdot T$。\n\n任务要求实现这个基准真相和两个预测模型，然后使用平均绝对误差（MAE）度量来评估它们的准确性。整个区域被离散化到一个 $N \\times N$ 的网格上。\n\n算法设计分为以下几个步骤：\n\n1.  **图形生成**：我们首先生成 $N \\times N$ 的二值图形阵列 $P$。问题指定了一个棋盘格图形，其中网格坐标 $(i,j)$ 处的像素是开放的（$P(i,j)=1$），如果 $\\lfloor i/s \\rfloor + \\lfloor j/s \\rfloor$ 是一个偶数，其中 $s$ 是棋盘格方块的边长（单位为像素）。\n\n2.  **核函数构建**：两个模型和基准真相都依赖于卷积核函数。我们必须在 $N \\times N$ 的网格上构建这些核函数，并遵守指定的周期性边界条件。\n    *   **距离计算**：指数核函数 $K_L$ 是距原点距离的函数。对于一个尺寸为 $N \\times N$ 像素的周期性（环形）区域，两点之间的距离必须使用最小镜像约定来计算。像素 $(i,j)$ 距原点 $(0,0)$ 的距离由 $r(i,j) = \\sqrt{(\\min(i, N-i)\\,d_{x})^{2} + (\\min(j, N-j)\\,d_{x})^{2}}$ 给出，其中 $d_x$ 是一个像素的物理尺寸。\n    *   **指数核函数 ($K_L$)**：未归一化的指数核函数构建为 $K_L^{\\text{un}}(i,j) = \\exp(-r(i,j)/L)$。这对 $L_{\\mathrm{true}}$ 和 $L_{\\mathrm{model}}$ 都要进行。\n    *   **方窗核函数 ($U_w$)**：简化的线性模型使用局域密度平均，这是一个与归一化方窗核函数 $U_w$ 的卷积。该核函数定义为，在以原点为中心、半宽为 $w$（单位为像素）的方形窗口内的像素，$U_w(i,j) = 1$，否则为 $0$。使用周期性索引，这转化为 $U_w^{\\text{un}}(i,j) = 1$，如果 $\\min(i, N-i) \\le w$ 且 $\\min(j, N-j) \\le w$。参数 $r_w$ 以微米（$\\mu\\mathrm{m}$）给出，必须通过 $w = \\text{round}(r_w/d_x)$ 转换为像素半宽 $w$。这种解释对于协调参数单位与核函数定义是必要的。\n    *   **归一化**：所有核函数必须进行归一化，使其元素总和为 $1$。这确保了如果被卷积的信号是均匀的，卷积操作能保持其平均值。对于任何未归一化的核函数 $K^{\\text{un}}$，归一化的核函数为 $K = K^{\\text{un}} / \\sum_{i,j} K^{\\text{un}}(i,j)$。\n\n3.  **卷积与模型评估**：周期性卷积通过应用卷积定理，使用快速傅里叶变换（FFT）高效计算：$\\mathcal{F}\\{A * B\\} = \\mathcal{F}\\{A\\} \\cdot \\mathcal{F}\\{B\\}$，其中 $\\mathcal{F}$ 表示傅里叶变换。因此，$A * B = \\mathcal{F}^{-1}\\{\\mathcal{F}\\{A\\} \\cdot \\mathcal{F}\\{B\\}\\}$。我们使用 `numpy.fft.fft2` 和 `numpy.fft.ifft2` 实现这一点。然后计算每个模型的刻蚀深度：\n    *   **基准真相深度 ($H_{\\mathrm{true}}$)**：\n        $$\n        H_{\\mathrm{true}} = R_0 \\cdot T \\cdot P \\odot \\max\\left(0, 1 - \\phi_{\\mathrm{true}} \\cdot \\mathcal{F}^{-1}\\left\\{\\mathcal{F}\\{P\\} \\odot \\mathcal{F}\\{K_{L_{\\mathrm{true}}}\\}\\right\\}\\right)\n        $$\n    *   **核模型深度 ($H_{\\mathrm{ker}}$)**：\n        $$\n        H_{\\mathrm{ker}} = R_0 \\cdot T \\cdot P \\odot \\max\\left(0, 1 - \\phi_{\\mathrm{model}} \\cdot \\mathcal{F}^{-1}\\left\\{\\mathcal{F}\\{P\\} \\odot \\mathcal{F}\\{K_{L_{\\mathrm{model}}}\\}\\right\\}\\right)\n        $$\n    *   **线性模型深度 ($H_{\\mathrm{lin}}$)**：\n        $$\n        H_{\\mathrm{lin}} = R_0 \\cdot T \\cdot P \\odot \\max\\left(0, 1 - k_{\\mathrm{lin}} \\cdot \\mathcal{F}^{-1}\\left\\{\\mathcal{F}\\{P\\} \\odot \\mathcal{F}\\{U_w\\}\\right\\}\\right)\n        $$\n    （这里，$\\odot$ 表示逐元素乘法。）\n\n4.  **误差计算**：两个预测模型的准确性通过仅在开放特征区域（$P(i,j)=1$）上计算的平均绝对误差（MAE）来量化。令 $M = \\sum_{i,j} P(i,j)$ 为开放像素的总数。误差为：\n    $$\n    \\mathrm{MAE}_{\\mathrm{ker}} = \\frac{1}{M}\\sum_{P(i,j)=1} \\left|H_{\\mathrm{ker}}(i,j) - H_{\\mathrm{true}}(i,j)\\right|\n    $$\n    $$\n    \\mathrm{MAE}_{\\mathrm{lin}} = \\frac{1}{M}\\sum_{P(i,j)=1} \\left|H_{\\mathrm{lin}}(i,j) - H_{\\mathrm{true}}(i,j)\\right|\n    $$\n    这通过使用布尔掩模 $P$ 过滤深度数组，然后计算绝对差值的平均值来实现。\n\n最终的实现将遍历提供的测试用例，为每组参数执行这四个步骤，并收集得到的 MAE 值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Implements and compares two predictive models for plasma etching loading effects.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (happy path, moderate coupling and slight model mismatch)\n        {'N': 64, 's': 8, 'd_x': 0.2, 'R0': 5, 'T': 10, 'L_true': 2.0, 'phi_true': 0.35, 'L_model': 1.8, 'phi_model': 0.30, 'k_lin': 0.28, 'r_w': 2.5},\n        # Case 2 (boundary, short-range coupling near local behavior)\n        {'N': 64, 's': 8, 'd_x': 0.2, 'R0': 5, 'T': 10, 'L_true': 0.3, 'phi_true': 0.25, 'L_model': 0.5, 'phi_model': 0.25, 'k_lin': 0.20, 'r_w': 0.6},\n        # Case 3 (edge, strong depletion and long-range coupling)\n        {'N': 64, 's': 4, 'd_x': 0.2, 'R0': 5, 'T': 10, 'L_true': 3.5, 'phi_true': 0.85, 'L_model': 3.0, 'phi_model': 0.70, 'k_lin': 0.60, 'r_w': 4.0},\n        # Case 4 (edge, fine-grained chessboard at pixel scale)\n        {'N': 64, 's': 1, 'd_x': 0.2, 'R0': 5, 'T': 10, 'L_true': 1.0, 'phi_true': 0.40, 'L_model': 1.2, 'phi_model': 0.35, 'k_lin': 0.30, 'r_w': 1.2},\n        # Case 5 (boundary, no true depletion but model mis-specified)\n        {'N': 64, 's': 8, 'd_x': 0.2, 'R0': 5, 'T': 10, 'L_true': 2.0, 'phi_true': 0.0, 'L_model': 1.8, 'phi_model': 0.30, 'k_lin': 0.50, 'r_w': 2.0},\n    ]\n\n    results = []\n\n    for case in test_cases:\n        N = case['N']\n        s = case['s']\n        d_x = case['d_x']\n        R0 = case['R0']\n        T = case['T']\n        L_true = case['L_true']\n        phi_true = case['phi_true']\n        L_model = case['L_model']\n        phi_model = case['phi_model']\n        k_lin = case['k_lin']\n        r_w = case['r_w']\n\n        # 1. Generate chessboard pattern P\n        i, j = np.mgrid[0:N, 0:N]\n        P = (np.floor(i / s) + np.floor(j / s)) % 2 == 0\n        P = P.astype(float)\n\n        # 2. Construct kernels\n        # Create periodic distance grid\n        idx = np.arange(N)\n        periodic_idx = np.minimum(idx, N - idx)\n        jj, ii = np.meshgrid(periodic_idx, periodic_idx)\n        r_pixels = np.sqrt(ii**2 + jj**2)\n        r_microns = r_pixels * d_x\n\n        # Exponential Kernels\n        K_true_unnormalized = np.exp(-r_microns / L_true)\n        K_model_unnormalized = np.exp(-r_microns / L_model)\n\n        # Box Kernel. Convert radius in um to half-width in pixels.\n        w_pixels = int(round(r_w / d_x))\n        U_w_unnormalized = np.zeros((N, N))\n        U_w_unnormalized[(ii = w_pixels)  (jj = w_pixels)] = 1.0\n\n        def calculate_depth(pattern, unnormalized_kernel, coefficient):\n            \"\"\"Computes etch depth based on a given kernel and coefficient.\"\"\"\n            # Normalize kernel\n            kernel_sum = np.sum(unnormalized_kernel)\n            if kernel_sum > 0:\n                kernel_normalized = unnormalized_kernel / kernel_sum\n            else:\n                kernel_normalized = unnormalized_kernel # Avoids division by zero\n\n            # Periodic convolution via FFT\n            conv_result = np.real(np.fft.ifft2(np.fft.fft2(pattern) * np.fft.fft2(kernel_normalized)))\n\n            # Calculate rate and depth\n            depletion_factor = np.maximum(0, 1 - coefficient * conv_result)\n            rate = R0 * pattern * depletion_factor\n            depth = rate * T\n            return depth\n\n        # 3. Calculate etch depths for all three models\n        H_true = calculate_depth(P, K_true_unnormalized, phi_true)\n        H_ker = calculate_depth(P, K_model_unnormalized, phi_model)\n        H_lin = calculate_depth(P, U_w_unnormalized, k_lin)\n        \n        # 4. Calculate Mean Absolute Error (MAE) on open features\n        open_pixels_mask = (P == 1)\n        num_open_pixels = np.sum(open_pixels_mask)\n\n        if num_open_pixels == 0:\n            mae_ker = 0.0\n            mae_lin = 0.0\n        else:\n            mae_ker = np.sum(np.abs(H_ker[open_pixels_mask] - H_true[open_pixels_mask])) / num_open_pixels\n            mae_lin = np.sum(np.abs(H_lin[open_pixels_mask] - H_true[open_pixels_mask])) / num_open_pixels\n\n        results.extend([mae_ker, mae_lin])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}