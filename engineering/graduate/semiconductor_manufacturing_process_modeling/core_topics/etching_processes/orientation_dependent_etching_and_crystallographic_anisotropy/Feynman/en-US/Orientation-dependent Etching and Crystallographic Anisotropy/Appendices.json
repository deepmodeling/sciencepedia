{
    "hands_on_practices": [
        {
            "introduction": "The final shape of an anisotropically etched feature is not arbitrary but is strictly governed by the underlying crystal lattice. This predictability is a cornerstone of microfabrication, allowing engineers to create precise three-dimensional structures. This exercise demonstrates how to predict a critical device dimension, the depth of a V-groove, by applying fundamental principles of crystallography and geometry, connecting the microscopic world of crystal planes to the macroscopic design of a microelectronic component .",
            "id": "4146541",
            "problem": "A long rectangular opening of width $W = 10\\,\\mu\\mathrm{m}$ is patterned in a hard mask on a silicon wafer with surface orientation $(100)$. The opening is aligned along a $\\langle 110 \\rangle$ direction to ensure the formation of symmetric sidewalls. The wafer is then etched in aqueous Potassium Hydroxide (KOH), which is strongly orientation-dependent and leaves the $\\{111\\}$ planes as etch stops. As the etch proceeds, a symmetric V-groove forms whose sidewalls are the intersecting $\\{111\\}$ planes.\n\nStarting from crystallographic first principles for a cubic crystal, namely that the angle between two planes equals the angle between their normal vectors and that the normal to a plane $(hkl)$ is given by the direction $[h\\,k\\,l]$, determine the depth $h$ at which the opposing $\\{111\\}$ planes intersect beneath the center of the opening. Use only vector geometry and trigonometric relationships to relate the angle between planes to the cross-sectional geometry of the V-groove, and assume ideal, perfectly flat facets with no undercut or rounding.\n\nProvide the final numerical value of $h$ in $\\mu\\mathrm{m}$, using angles measured in degrees, and round your answer to four significant figures. The final answer must be a single real number.",
            "solution": "The problem statement has been validated and is deemed scientifically grounded, well-posed, and contains all necessary information for a unique, meaningful solution. The problem requires determining the depth of a V-groove formed by anisotropic etching of a $(100)$-oriented silicon wafer. This will be solved by applying fundamental principles of crystallography and vector geometry.\n\nThe V-groove is formed by two intersecting crystallographic planes from the $\\{111\\}$ family, which act as etch stops. The surface of the wafer is the $(100)$ plane. The geometry of the groove's cross-section is determined by the angle these $\\{111\\}$ planes make with the $(100)$ surface.\n\nAccording to the principles of crystallography for a cubic crystal system, the normal vector to a plane with Miller indices $(hkl)$ is the direction vector $[h\\,k\\,l]$. The angle between two planes is equal to the angle between their normal vectors.\n\nLet the wafer surface be the $(100)$ plane. The normal vector to this surface is $\\mathbf{n}_{\\text{surf}} = [1\\,0\\,0]$.\nThe sidewalls of the V-groove are $\\{111\\}$ planes. Due to the symmetry of the groove, we can choose any representative plane from this family to calculate the angle with the surface. Let us choose the $(111)$ plane. The normal vector to this plane is $\\mathbf{n}_{\\text{side}} = [1\\,1\\,1]$.\n\nThe angle $\\phi$ between the $(100)$ surface plane and the $(111)$ sidewall plane can be found using the dot product formula for their normal vectors:\n$$\n\\cos(\\phi) = \\frac{\\mathbf{n}_{\\text{surf}} \\cdot \\mathbf{n}_{\\text{side}}}{|\\mathbf{n}_{\\text{surf}}| |\\mathbf{n}_{\\text{side}}|}\n$$\nThe components of the normal vectors are:\n$\\mathbf{n}_{\\text{surf}} = [1\\,0\\,0]$\n$\\mathbf{n}_{\\text{side}} = [1\\,1\\,1]$\n\nThe dot product is:\n$$\n\\mathbf{n}_{\\text{surf}} \\cdot \\mathbf{n}_{\\text{side}} = (1)(1) + (0)(1) + (0)(1) = 1\n$$\nThe magnitudes of the normal vectors are:\n$$\n|\\mathbf{n}_{\\text{surf}}| = \\sqrt{1^2 + 0^2 + 0^2} = \\sqrt{1} = 1\n$$\n$$\n|\\mathbf{n}_{\\text{side}}| = \\sqrt{1^2 + 1^2 + 1^2} = \\sqrt{3}\n$$\nSubstituting these values into the cosine formula:\n$$\n\\cos(\\phi) = \\frac{1}{1 \\cdot \\sqrt{3}} = \\frac{1}{\\sqrt{3}}\n$$\nThis angle $\\phi$ represents the angle of the V-groove sidewall with respect to the horizontal wafer surface, as observed in the cross-section perpendicular to the groove's alignment direction.\n\nNow, we consider the two-dimensional cross-section of the V-groove. It forms an isosceles triangle with a top base of width $W$ and a height (depth) of $h$. Bisecting this triangle along its axis of symmetry yields two identical right-angled triangles. For each right-angled triangle:\n- The base is half the opening width, $\\frac{W}{2}$.\n- The height is the etch depth, $h$.\n- The angle between the hypotenuse (the sidewall) and the horizontal top side is the angle $\\phi$ we calculated.\n\nUsing the definition of the tangent function in this right-angled triangle:\n$$\n\\tan(\\phi) = \\frac{\\text{opposite}}{\\text{adjacent}} = \\frac{h}{W/2}\n$$\nFrom this, we can express the depth $h$ as:\n$$\nh = \\frac{W}{2} \\tan(\\phi)\n$$\nWe have the value for $\\cos(\\phi)$, and we need $\\tan(\\phi)$. We can use the trigonometric identity $\\tan^2(\\phi) + 1 = \\sec^2(\\phi) = \\frac{1}{\\cos^2(\\phi)}$.\n$$\n\\tan^2(\\phi) = \\frac{1}{\\cos^2(\\phi)} - 1\n$$\nSubstituting $\\cos(\\phi) = \\frac{1}{\\sqrt{3}}$:\n$$\n\\tan^2(\\phi) = \\frac{1}{(1/\\sqrt{3})^2} - 1 = \\frac{1}{1/3} - 1 = 3 - 1 = 2\n$$\nSince $\\phi$ is an acute angle (less than $90^\\circ$ or $\\frac{\\pi}{2}$ radians), its tangent is positive.\n$$\n\\tan(\\phi) = \\sqrt{2}\n$$\nNow, we substitute this value back into the expression for the depth $h$:\n$$\nh = \\frac{W}{2} \\sqrt{2} = \\frac{W}{\\sqrt{2}}\n$$\nThe problem provides the width of the opening as $W = 10\\,\\mu\\mathrm{m}$. We can now calculate the numerical value of the depth $h$:\n$$\nh = \\frac{10\\,\\mu\\mathrm{m}}{\\sqrt{2}} = 5\\sqrt{2}\\,\\mu\\mathrm{m}\n$$\nTo obtain the final numerical answer, we compute the value and round to four significant figures as requested.\n$$\nh \\approx 5 \\times 1.41421356... \\,\\mu\\mathrm{m} \\approx 7.0710678... \\,\\mu\\mathrm{m}\n$$\nRounding to four significant figures gives:\n$$\nh \\approx 7.071\\,\\mu\\mathrm{m}\n$$",
            "answer": "$$\\boxed{7.071}$$"
        },
        {
            "introduction": "While geometry defines the possible angles and intersections of crystal planes, it is the process kinetics that determines which planes actually define the final etched shape. This practice introduces the concept of etch selectivity, the ratio of etch rates between different crystallographic orientations. By calculating the selectivity between the rapidly etching $(100)$ plane and the slow-etching $(111)$ plane, you will gain a quantitative understanding of why $\\{111\\}$ planes act as self-limiting \"etch stops\" and how this phenomenon is exploited in mask design .",
            "id": "4146555",
            "problem": "A crystalline silicon wafer is etched in an aqueous solution of Potassium Hydroxide (KOH). In anisotropic wet etching, the local normal velocity of the surface is equal to the orientation-dependent etch rate, denoted by $R(\\hat{n})$, where $\\hat{n}$ is the local surface normal. Consider the wafer has a nominal $\\{100\\}$ surface and is patterned with square mask openings whose edges are aligned to the $\\langle 110 \\rangle$ directions. At $80^{\\circ}\\mathrm{C}$ in $30\\,\\mathrm{wt}\\,\\%$ KOH (weight percent (wt%)), the measured etch rates are $R_{100}=1.2\\,\\mu\\mathrm{m}/\\mathrm{min}$ and $R_{111}=0.02\\,\\mu\\mathrm{m}/\\mathrm{min}$. The selectivity is defined as $S=R_{100}/R_{111}$.\n\nStarting from the kinematic law for anisotropic front propagation (local normal velocity equals $R(\\hat{n})$) and the geometric-envelope viewpoint of anisotropic fronts, reason about how the disparity in $R(\\hat{n})$ across orientations affects the emergence and stabilization of facets during etching on a $\\{100\\}$ wafer. In particular, use these fundamentals to justify whether $\\{111\\}$ facets act as self-limiting planes and to explain the implications for mask edge orientation and undercut risk when the opening edges are aligned to $\\langle 110 \\rangle$.\n\nCompute the selectivity $S$ using the provided rates. Express $S$ as a pure number (dimensionless). No rounding is required.",
            "solution": "The evolution of an etched surface profile is governed by the kinematic law for anisotropic front propagation. This law states that the velocity of a point on the surface in the direction of its local normal vector $\\hat{n}$ is equal to the orientation-dependent etch rate, $R(\\hat{n})$.\n\nThe geometric-envelope viewpoint, often visualized through a Wulff-Jaccodine construction, provides a powerful method for predicting the etched shape. According to this principle, the final etched surface is the inner envelope of a family of evolving planes. A direct consequence of this principle is that planes with local minima in the etch rate function $R(\\hat{n})$ are the most stable. Faster-etching planes are progressively eliminated during the etching process, leaving a final shape dominated by the slowest-etching facets.\n\nIn this problem, we are given the etch rates for two principal crystallographic orientations in silicon using a KOH etchant: $R_{100} = 1.2\\,\\mu\\mathrm{m}/\\mathrm{min}$ and $R_{111} = 0.02\\,\\mu\\mathrm{m}/\\mathrm{min}$. The stark difference between these rates is the fundamental driver of the observed etching behavior. The etch rate for the $\\{111\\}$ planes is a deep minimum in the overall etch rate function $R(\\hat{n})$ for silicon in KOH.\n\n**Facet Emergence and Stabilization:**\nWhen etching begins at the edge of a mask opening on the $\\{100\\}$ surface, a range of crystallographic planes is exposed. Due to the high etch rate of the $\\{100\\}$ plane, the surface etches rapidly downwards. At the same time, the material under the mask edge is exposed to the etchant. According to the geometric-envelope principle, the faster-etching planes are quickly consumed. The surface evolves until it is bounded by the slowest-etching planes available, which are the $\\{111\\}$ planes. These planes emerge as well-defined, stable facets because their etch rate $R_{111}$ is extremely low. Other, higher-index planes that might be transiently exposed have much higher etch rates and are thus unstable, disappearing in favor of the $\\{111\\}$ facets.\n\n**Self-Limiting Nature of $\\{111\\}$ Planes:**\nA plane is considered \"self-limiting\" or an \"etch stop\" if its etch rate is so low compared to other planes that it effectively halts the etching process in its normal direction. The selectivity, $S$, quantifies this disparity. It is the ratio of the fastest relevant etch rate to the slowest. Here, we can compute the selectivity between the $\\{100\\}$ and $\\{111\\}$ planes:\n$$S = \\frac{R_{100}}{R_{111}} = \\frac{1.2\\,\\mu\\mathrm{m}/\\mathrm{min}}{0.02\\,\\mu\\mathrm{m}/\\mathrm{min}} = 60$$\nA selectivity of $60$ indicates that the $\\{100\\}$ surface etches $60$ times faster than the $\\{111\\}$ surface. This very high ratio justifies classifying the $\\{111\\}$ planes as self-limiting. Once these facets are formed, the etched cavity walls are defined by these stable planes, and further expansion of the cavity occurs primarily by the downward etching of any remaining $\\{100\\}$ floor, not by the lateral etching of the $\\{111\\}$ walls.\n\n**Implications for Mask Edge Orientation and Undercut Risk:**\nThe problem states that the square mask openings have edges aligned to the $\\langle 110 \\rangle$ directions. This alignment is critical. In a cubic crystal system, the four distinct $\\{111\\}$-type planes—$(111)$, $(1\\bar{1}1)$, $(\\bar{1}11)$, and $(\\bar{1}\\bar{1}1)$—intersect the $(100)$ surface plane. The direction of the line of intersection between two planes with normals $\\hat{n}_1$ and $\\hat{n}_2$ is given by their cross product, $\\vec{d} = \\hat{n}_1 \\times \\hat{n}_2$.\nFor the intersection of the $(100)$ plane (normal $\\hat{n}_1 = [1,0,0]$) and the $(111)$ plane (normal $\\hat{n}_2 = [1,1,1]$), the direction vector is:\n$$\\vec{d} = [1,0,0] \\times [1,1,1] = [0,-1,1]$$\nThis direction is a member of the $\\langle 011 \\rangle$ family, which is crystallographically equivalent to the $\\langle 110 \\rangle$ family. The same result is found for the intersections with the other three $\\{111\\}$ planes.\nThis means that the traces of the four slow-etching $\\{111\\}$ planes on the $\\{100\\}$ surface lie exactly along the $\\langle 110 \\rangle$ directions.\nBy aligning the mask edges to the $\\langle 110 \\rangle$ directions, the mask is perfectly aligned with the natural, stable facets that will form. As etching proceeds, stable $\\{111\\}$ planes form directly beneath the mask edges. These planes are inclined at a fixed angle of $\\theta = \\arccos\\left(\\frac{[100]\\cdot[111]}{|[100]||[111]|}\\right) = \\arccos\\left(\\frac{1}{\\sqrt{3}}\\right) \\approx 54.74^\\circ$ to the $\\{100\\}$ surface.\n\"Undercut\" is the lateral etching that occurs beneath the mask layer. With this specific alignment, the undercut is not a random or uncontrolled process. It is geometrically defined and predictable, limited by the slow lateral progression of the $\\{111\\}$ planes. The risk of runaway or excessive undercut is therefore minimized. This precise alignment is intentionally used in microfabrication to create structures with well-defined V-shaped grooves or pyramidal cavities bounded by $\\{111\\}$ planes.\n\nIn summary, the high selectivity between $\\{100\\}$ and $\\{111\\}$ planes causes the $\\{111\\}$ planes to emerge as stable, self-limiting facets. Aligning mask edges along the $\\langle 110 \\rangle$ directions on a $\\{100\\}$ wafer leverages this crystallographic property to create well-defined, predictable etched profiles with minimal uncontrolled undercut.\n\nThe selectivity $S$ has already been calculated as a necessary part of the reasoning.\n$$S = 60$$\nThis is a dimensionless quantity, as required.",
            "answer": "$$\\boxed{60}$$"
        },
        {
            "introduction": "To predict the evolution of more complex shapes or under conditions where simple geometric analysis is insufficient, we turn to computational modeling. This exercise bridges the gap between physical theory and numerical simulation, providing hands-on experience in modeling anisotropic etching. You will translate the core principle of orientation-dependent normal velocity into a working computer program and use Fourier analysis, a powerful mathematical tool, to characterize the emergent symmetries of the etched profile as it evolves from a simple circle .",
            "id": "4146493",
            "problem": "You are asked to model the planar evolution of an initially circular mask opening under orientation-dependent etching in a crystalline material and to predict the emergence of fourfold or sixfold symmetric shapes depending on the dominant facets. The modeling should be grounded in the following fundamental base: the local normal velocity is equal to the local etch rate and depends on the crystallographic orientation. Assume negligible curvature effects, no transport limitations, and no mask undercut. The mask opening remains star-shaped with respect to the initial center during the evolution window under consideration. Angles must be treated in radians.\n\nFundamental base to use:\n- The local normal velocity equals the local etch rate: if the boundary is parameterized by the polar angle $\\,\\theta\\,$, the local normal velocity is $\\,v_n(\\theta) = R(\\theta)\\,$.\n- Under the assumptions above, for an initially circular boundary of radius $\\,r_0\\,$, the radial function evolves as $\\,\\frac{\\partial r(\\theta,t)}{\\partial t} = R(\\theta)\\,$, which integrates to $\\,r(\\theta,T) = r_0 + \\int_0^T R(\\theta)\\,dt\\,$.\n- The planar area of a star-shaped curve with polar radius $\\,r(\\theta)\\,$ is $\\,A = \\frac{1}{2}\\int_0^{2\\pi} r(\\theta)^2\\,d\\theta\\,$.\n\nUse a well-tested anisotropic etch-rate model that encodes crystallographic symmetry as a periodic modulation:\n$$\nR(\\theta) = R_0\\left[1 + \\varepsilon \\cos\\!\\big(k(\\theta - \\theta_0)\\big)\\right],\n$$\nwhere $\\,R_0 > 0\\,$ is the baseline etch rate, $\\,\\varepsilon \\in [0,1)\\,$ is the anisotropy strength, $\\,k\\in\\mathbb{Z}^+\\,$ denotes the symmetry order (e.g., $\\,k=4\\,$ for fourfold, $\\,k=6\\,$ for sixfold), and $\\,\\theta_0\\,$ is an orientation offset. The initial circle has radius $\\,r_0\\,$ at time $\\,t=0\\,$. Evolve for a finite time $\\,T\\,$.\n\nYour program must:\n1. Discretize the angular domain using $\\,N\\,$ uniformly spaced samples on $[0,2\\pi)$.\n2. Compute the evolved polar radius $\\,r(\\theta_i)\\,$ for each sample $\\,\\theta_i\\,$ by integrating the normal velocity in time under the model above.\n3. Compute the area $\\,A\\,$ using the polar-area formula $\\,A = \\frac{1}{2}\\int_0^{2\\pi} r(\\theta)^2\\,d\\theta\\,$, and express the area in square micrometers ($\\mu\\mathrm{m}^2$) as a float.\n4. Quantify the emergence of fourfold or sixfold symmetry by computing normalized discrete Fourier amplitudes at $\\,p=4\\,$ and $\\,p=6\\,$:\n$$\na_p = \\frac{\\left|\\sum_{i=0}^{N-1} r(\\theta_i)\\,e^{-\\,\\mathrm{i}\\,p\\,\\theta_i}\\right|}{\\sum_{i=0}^{N-1} r(\\theta_i)},\n$$\nwhich yields a dimensionless float.\n5. Predict the dominant symmetry as an integer $\\,k_{\\text{pred}}\\,$ using the rule: if both $\\,a_4\\,$ and $\\,a_6\\,$ are below a threshold $\\,\\tau\\,$, return $\\,0\\,$; otherwise, return the $\\,p\\in\\{4,6\\}\\,$ that gives the larger amplitude. Use $\\,\\tau = 0.02\\,$.\n6. Report, for each test case, a list containing $[k_{\\text{pred}}, A, a_4, a_6]$ where $\\,k_{\\text{pred}}\\,$ is an integer and $\\,A, a_4, a_6\\,$ are floats rounded to six decimal places.\n\nPhysical and numerical units:\n- Baseline etch rate $\\,R_0\\,$ in micrometers per minute ($\\mu\\mathrm{m}/\\mathrm{min}$).\n- Time $\\,T\\,$ in minutes ($\\mathrm{min}$).\n- Radii $\\,r_0\\,$ and $\\,r(\\theta)\\,$ in micrometers ($\\mu\\mathrm{m}$).\n- Area $\\,A\\,$ in square micrometers ($\\mu\\mathrm{m}^2$).\n- Angles in radians.\n\nTest suite:\nUse the following five parameter sets, covering typical cases, offsets, isotropic boundary, and a near-extreme anisotropy. For each case, use $\\,N=4096\\,$ samples.\n\n- Case $\\,1\\,$ (fourfold, moderate anisotropy, aligned): $\\,r_0=2.0\\,\\mu\\mathrm{m}\\,$, $\\,R_0=0.1\\,\\mu\\mathrm{m}/\\mathrm{min}\\,$, $\\,\\varepsilon=0.3\\,$, $\\,k=4\\,$, $\\,\\theta_0=0.0\\,\\mathrm{rad}\\,$, $\\,T=10.0\\,\\mathrm{min}\\,$.\n- Case $\\,2\\,$ (sixfold, moderate anisotropy, offset): $\\,r_0=2.0\\,\\mu\\mathrm{m}\\,$, $\\,R_0=0.1\\,\\mu\\mathrm{m}/\\mathrm{min}\\,$, $\\,\\varepsilon=0.25\\,$, $\\,k=6\\,$, $\\,\\theta_0=\\frac{\\pi}{6}\\,\\mathrm{rad}\\,$, $\\,T=10.0\\,\\mathrm{min}\\,$.\n- Case $\\,3\\,$ (isotropic reference): $\\,r_0=2.0\\,\\mu\\mathrm{m}\\,$, $\\,R_0=0.1\\,\\mu\\mathrm{m}/\\mathrm{min}\\,$, $\\,\\varepsilon=0.0\\,$, $\\,k=4\\,$, $\\,\\theta_0=0.0\\,\\mathrm{rad}\\,$, $\\,T=10.0\\,\\mathrm{min}\\,$.\n- Case $\\,4\\,$ (fourfold, strong anisotropy, offset): $\\,r_0=2.0\\,\\mu\\mathrm{m}\\,$, $\\,R_0=0.1\\,\\mu\\mathrm{m}/\\mathrm{min}\\,$, $\\,\\varepsilon=0.9\\,$, $\\,k=4\\,$, $\\,\\theta_0=\\frac{\\pi}{8}\\,\\mathrm{rad}\\,$, $\\,T=5.0\\,\\mathrm{min}\\,$.\n- Case $\\,5\\,$ (sixfold, weak anisotropy near threshold): $\\,r_0=2.0\\,\\mu\\mathrm{m}\\,$, $\\,R_0=0.1\\,\\mu\\mathrm{m}/\\mathrm{min}\\,$, $\\,\\varepsilon=0.05\\,$, $\\,k=6\\,$, $\\,\\theta_0=0.3\\,\\mathrm{rad}\\,$, $\\,T=10.0\\,\\mathrm{min}\\,$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list of the five per-case lists, enclosed in square brackets. For example, the output must look like:\n$$\n\\texttt{[[k\\_pred\\_1,A\\_1,a4\\_1,a6\\_1],[k\\_pred\\_2,A\\_2,a4\\_2,a6\\_2],[k\\_pred\\_3,A\\_3,a4\\_3,a6\\_3],[k\\_pred\\_4,A\\_4,a4\\_4,a6\\_4],[k\\_pred\\_5,A\\_5,a4\\_5,a6\\_5]]}\n$$\nAll numeric entries must be floats rounded to six decimal places except the integer $\\,k_{\\text{pred}}\\,$.",
            "solution": "The core of the problem is to model the evolution of a shape defined by a polar function `$r(\\theta, t)$` and to characterize its emergent symmetry. The solution proceeds by first deriving the analytical form of the evolved shape, then specifying the numerical algorithm to compute the required metrics.\n\n**1. Analytical Model of Shape Evolution**\n\nThe evolution of the etched profile is governed by the local normal velocity `$v_n(\\theta)$`, which is given as being equal to the orientation-dependent etch rate `$R(\\theta)$`. For a star-shaped boundary parameterized by the polar function `$r(\\theta, t)$`, under the assumption of negligible curvature effects, the radial function's rate of change is given by:\n$$\n\\frac{\\partial r(\\theta,t)}{\\partial t} = v_n(\\theta) = R(\\theta)\n$$\nThe etch rate `$R(\\theta)$` is modeled as a periodic function of the angle `$\\theta$`:\n$$\nR(\\theta) = R_0\\left[1 + \\varepsilon \\cos\\!\\big(k(\\theta - \\theta_0)\\big)\\right]\n$$\nHere, `$R_0 > 0$` is the baseline etch rate, `$\\varepsilon \\in [0,1)$` is the anisotropy strength, `$k \\in \\mathbb{Z}^+$` is the symmetry order (e.g., `$k=4$` for fourfold symmetry), and `$\\theta_0$` is a phase offset corresponding to the crystal's orientation relative to the coordinate system.\n\nSince `$R(\\theta)$` is independent of time `$t$`, we can integrate the evolution equation with respect to time from `$t=0$` to a final time `$t=T$`. Given an initial circular profile of radius `$r_0$` at `$t=0$`, the radius function at time `$T$` becomes:\n$$\n\\int_{r(\\theta,0)}^{r(\\theta,T)} dr = \\int_0^T R(\\theta) dt\n$$\n$$\nr(\\theta, T) - r_0 = R(\\theta) \\cdot [t]_0^T\n$$\n$$\nr(\\theta, T) = r_0 + R(\\theta) \\cdot T\n$$\nSubstituting the expression for `$R(\\theta)$`, we obtain the explicit analytical form for the evolved boundary:\n$$\nr(\\theta, T) = r_0 + T R_0 \\left[1 + \\varepsilon \\cos\\!\\big(k(\\theta - \\theta_0)\\big)\\right]\n$$\nThis equation provides the polar radius `$r$` for any angle `$\\theta$` at the specified evolution time `$T$`.\n\n**2. Numerical Algorithm**\n\nTo compute the required metrics, we discretize the continuous model.\n\n**2.1. Discretization**\nThe continuous angular domain `$[0, 2\\pi)$` is sampled at `$N=4096$` discrete, uniformly spaced points. The angle for the `$i$`-th sample is:\n$$\n\\theta_i = i \\cdot \\frac{2\\pi}{N} \\quad \\text{for } i = 0, 1, \\dots, N-1\n$$\nFor each `$\\theta_i$`, we compute the corresponding radius `$r_i = r(\\theta_i, T)$` using the analytical expression derived above. This yields a discrete vector of `$N$` radii representing the etched shape.\n\n**2.2. Area Calculation**\nThe area `$A$` of the shape enclosed by the polar curve `$r(\\theta)$` is given by the integral:\n$$\nA = \\frac{1}{2}\\int_0^{2\\pi} r(\\theta)^2\\,d\\theta\n$$\nWe approximate this integral numerically using a Riemann sum over our discrete samples. The infinitesimal element `$d\\theta$` is replaced by the discrete angular step `$\\Delta\\theta = \\frac{2\\pi}{N}$`.\n$$\nA \\approx \\frac{1}{2} \\sum_{i=0}^{N-1} r_i^2 \\Delta\\theta = \\frac{1}{2} \\sum_{i=0}^{N-1} r_i^2 \\left(\\frac{2\\pi}{N}\\right) = \\frac{\\pi}{N} \\sum_{i=0}^{N-1} r_i^2\n$$\nWith `$N=4096$`, this numerical integration is highly accurate. All radii are in units of micrometers (`$\\mu\\mathrm{m}$`), so the resulting area `$A$` is in square micrometers (`$\\mu\\mathrm{m}^2$`).\n\n**2.3. Symmetry Analysis**\nThe emergence of specific symmetries is quantified by computing the normalized discrete Fourier amplitudes `$a_p$` for `$p=4$` and `$p=6$`. The formula provided is:\n$$\na_p = \\frac{\\left|\\sum_{i=0}^{N-1} r_i\\,e^{-\\,\\mathrm{i}\\,p\\,\\theta_i}\\right|}{\\sum_{i=0}^{N-1} r_i}\n$$\nThe summation in the numerator, `$\\sum_{i=0}^{N-1} r_i\\,e^{-\\,\\mathrm{i}\\,p\\,\\theta_i}$`, corresponds to the `$p$`-th component of the Discrete Fourier Transform (DFT) of the radius vector `$\\{r_i\\}$`, since `$\\theta_i = i \\frac{2\\pi}{N}$` results in the DFT kernel `$e^{-\\mathrm{i}\\,2\\pi(pi)/N}$`. This can be computed efficiently. The denominator is the sum of all radii, which is proportional to the DC component (`$p=0$`) of the Fourier series. Thus, `$a_p$` represents the strength of the `$p$`-fold symmetric component relative to the average radius.\n\n**2.4. Symmetry Prediction**\nThe predicted dominant symmetry, `$k_{\\text{pred}}$`, is determined using a threshold `$\\tau = 0.02$`. The decision rule is as follows:\n- If `$a_4 < \\tau$` and `$a_6 < \\tau$`, the profile is considered to lack significant fourfold or sixfold symmetry, so we set `$k_{\\text{pred}} = 0$`.\n- Otherwise, the dominant symmetry is that which corresponds to the larger amplitude. We set `$k_{\\text{pred}} = \\arg\\max_{p \\in \\{4,6\\}} a_p$`. In case of a numerical tie, we can default to `$4$`.\n\nThis complete algorithm is implemented for each of the five provided test cases to generate the final results.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation for all test cases and print the results.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Format: (r0, R0, epsilon, k, theta0, T)\n    test_cases = [\n        # Case 1 (fourfold, moderate anisotropy, aligned)\n        (2.0, 0.1, 0.3, 4, 0.0, 10.0),\n        # Case 2 (sixfold, moderate anisotropy, offset)\n        (2.0, 0.1, 0.25, 6, np.pi/6, 10.0),\n        # Case 3 (isotropic reference)\n        (2.0, 0.1, 0.0, 4, 0.0, 10.0),\n        # Case 4 (fourfold, strong anisotropy, offset)\n        (2.0, 0.1, 0.9, 4, np.pi/8, 5.0),\n        # Case 5 (sixfold, weak anisotropy near threshold)\n        (2.0, 0.1, 0.05, 6, 0.3, 10.0),\n    ]\n\n    # Shared numerical parameters\n    N = 4096\n    tau = 0.02\n\n    results = []\n    for case in test_cases:\n        r0, R0, epsilon, k, theta0, T = case\n        \n        # 1. Discretize the angular domain\n        theta = np.linspace(0, 2 * np.pi, N, endpoint=False)\n        \n        # 2. Compute the evolved polar radius r(theta_i)\n        # R(theta) = R0 * (1 + epsilon * cos(k * (theta - theta0)))\n        # r(theta, T) = r0 + R(theta) * T\n        etch_rate = R0 * (1 + epsilon * np.cos(k * (theta - theta0)))\n        r_evolved = r0 + etch_rate * T\n        \n        # 3. Compute the area A\n        # A = (1/2) * integral(r^2 dtheta) ~ (pi/N) * sum(r_i^2)\n        area = (np.pi / N) * np.sum(r_evolved**2)\n        \n        # 4. Compute normalized discrete Fourier amplitudes a_p for p=4 and p=6\n        # The sum in the numerator is the p-th component of the DFT.\n        r_fft = np.fft.fft(r_evolved)\n        sum_r = np.sum(r_evolved)\n\n        # Numerator is |sum(r_i * exp(-i*p*theta_i))| which is |DFT[p]|\n        # Denominator is sum(r_i)\n        if sum_r == 0:\n            a4, a6 = 0.0, 0.0\n        else:\n            a4 = np.abs(r_fft[4]) / sum_r\n            a6 = np.abs(r_fft[6]) / sum_r\n        \n        # 5. Predict the dominant symmetry k_pred\n        if a4 < tau and a6 < tau:\n            k_pred = 0\n        else:\n            if a4 >= a6:\n                k_pred = 4\n            else:\n                k_pred = 6\n                \n        # 6. Report the results for the case, rounded as specified.\n        # [k_pred (int), A, a4, a6 (floats rounded to 6 decimal places)]\n        # Use a list of strings to preserve formatting for repr()\n        # and then convert back to original types for the final list\n        formatted_case_result = [\n            k_pred,\n            round(area, 6),\n            round(a4, 6),\n            round(a6, 6)\n        ]\n        results.append(formatted_case_result)\n\n    # Custom function to format the final output string exactly as required\n    def format_list_of_lists(list_of_lists):\n        outer_parts = []\n        for inner_list in list_of_lists:\n            inner_parts = []\n            inner_parts.append(str(inner_list[0])) # k_pred is int\n            inner_parts.append(f\"{inner_list[1]:.6f}\") # A is float\n            inner_parts.append(f\"{inner_list[2]:.6f}\") # a4 is float\n            inner_parts.append(f\"{inner_list[3]:.6f}\") # a6 is float\n            outer_parts.append(f\"[{','.join(inner_parts)}]\")\n        return f\"[{','.join(outer_parts)}]\"\n\n    # Final print statement in the exact required format.\n    print(format_list_of_lists(results))\n\n\nsolve()\n\n```"
        }
    ]
}