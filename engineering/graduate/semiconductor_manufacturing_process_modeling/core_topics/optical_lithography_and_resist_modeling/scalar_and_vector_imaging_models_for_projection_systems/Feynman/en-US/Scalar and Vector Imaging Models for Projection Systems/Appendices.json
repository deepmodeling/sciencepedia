{
    "hands_on_practices": [
        {
            "introduction": "An ideal projection system is a useful theoretical construct, but real-world optical systems suffer from aberrations that degrade image quality. This exercise provides foundational practice in describing these wavefront errors using Zernike polynomials, the industry-standard orthogonal basis for optical design and testing. By mapping classical Seidel aberrations to their Zernike coefficients, you will develop fluency in the mathematical language used to characterize and compensate for imperfections in advanced lithographic lenses .",
            "id": "4162813",
            "problem": "A projection lithography system for semiconductor manufacturing is modeled using a scalar pupil function with a circular aperture of unit radius. The optical path difference $W(\\rho,\\theta)$ across the pupil is expanded on an orthonormal Zernike basis defined on the unit disk, with radial coordinate $\\rho \\in [0,1]$ and azimuthal angle $\\theta \\in [0,2\\pi)$ in radians. Adopt the Optical Society of America/American National Standards Institute normalization convention where the Zernike polynomials $Z_{n}^{m}(\\rho,\\theta)$ are orthonormal on the unit disk with respect to the weight $\\rho$, and are given by\n$$\nZ_{n}^{m}(\\rho,\\theta) = N_{n,m} R_{n}^{m}(\\rho) \\times\n\\begin{cases}\n\\cos(m\\theta), & m \\ge 0, \\\\\n\\sin(|m|\\theta), & m < 0,\n\\end{cases}\n$$\nwith $N_{n,0} = \\sqrt{n+1}$ and $N_{n,m} = \\sqrt{2(n+1)}$ for $m \\neq 0$, and $R_{n}^{m}(\\rho)$ the standard Zernike radial polynomials.\n\nConsider primary Seidel aberration amplitudes specified as coefficients of the following monomials in the pupil coordinates (optical path difference in meters): defocus $A_{\\mathrm{def}}$ multiplying $\\rho^{2}$, astigmatism oriented along the $x$-axis with amplitude $A_{\\mathrm{ast}}$ multiplying $\\rho^{2}\\cos(2\\theta)$, coma oriented along the $x$-axis with amplitude $A_{\\mathrm{coma}}$ multiplying $\\rho^{3}\\cos(\\theta)$, and primary spherical aberration with amplitude $A_{\\mathrm{sph}}$ multiplying $\\rho^{4}$. The illumination wavelength is $\\lambda$ (expressed in meters). In the scalar imaging model, the induced phase is $\\phi(\\rho,\\theta) = \\frac{2\\pi}{\\lambda} W(\\rho,\\theta)$ in radians.\n\nStarting from the scalar wave optics representation and the orthonormal Zernike basis definition above, map these Seidel forms to Zernike coefficients and construct the pupil phase $\\phi(\\rho,\\theta)$ with piston and tilt removed. Express your final answer as a single closed-form symbolic expression in terms of $\\rho$, $\\theta$, $A_{\\mathrm{def}}$, $A_{\\mathrm{ast}}$, $A_{\\mathrm{coma}}$, $A_{\\mathrm{sph}}$, and $\\lambda$, in radians. Do not include any overall piston or tilt terms. No numerical evaluation is required.",
            "solution": "To construct the pupil phase with piston and tilt removed, we start with the total optical path difference (OPD), $W(\\rho,\\theta)$, which is the sum of the given Seidel aberration terms:\n$$W(\\rho,\\theta) = A_{\\mathrm{def}} \\rho^{2} + A_{\\mathrm{ast}} \\rho^{2}\\cos(2\\theta) + A_{\\mathrm{coma}} \\rho^{3}\\cos(\\theta) + A_{\\mathrm{sph}} \\rho^{4}$$\nThe problem requires removing any components corresponding to overall piston (a constant offset) and tilt (a term linear in pupil coordinates). This is achieved by making each term orthogonal to the Zernike polynomials for piston ($Z_0^0 \\propto 1$) and x-tilt ($Z_1^1 \\propto \\rho\\cos(\\theta)$). The y-tilt component is zero as all aberrations are symmetric about the x-axis.\n\n1.  **Defocus Term $A_{\\mathrm{def}}\\rho^2$**: This term contains both defocus and piston. The piston component is its average value over the weighted unit disk. The average of $\\rho^2$ is $\\langle \\rho^2 \\rangle = \\frac{\\int_0^{2\\pi}\\int_0^1 \\rho^2 \\cdot \\rho \\, d\\rho \\, d\\theta}{\\int_0^{2\\pi}\\int_0^1 \\rho \\, d\\rho \\, d\\theta} = \\frac{\\pi/2}{\\pi} = 1/2$. To remove piston, we subtract this average value, yielding $A_{\\mathrm{def}}(\\rho^2 - 1/2)$.\n\n2.  **Astigmatism Term $A_{\\mathrm{ast}}\\rho^2\\cos(2\\theta)$**: Due to the orthogonality of trigonometric functions, this term has a zero average value (no piston) and is orthogonal to $\\rho\\cos(\\theta)$ (no tilt). It requires no modification.\n\n3.  **Coma Term $A_{\\mathrm{coma}}\\rho^3\\cos(\\theta)$**: This term contains both coma and x-tilt. We must subtract the tilt component. The tilt component of $\\rho^3\\cos(\\theta)$ is its projection onto $\\rho\\cos(\\theta)$. This projection is $c \\cdot \\rho\\cos(\\theta)$, where the coefficient $c$ is given by the inner product ratio $c = \\frac{\\langle \\rho^3\\cos\\theta, \\rho\\cos\\theta \\rangle}{\\langle \\rho\\cos\\theta, \\rho\\cos\\theta \\rangle} = \\frac{\\int_0^1 \\rho^4 \\rho \\, d\\rho}{\\int_0^1 \\rho^2 \\rho \\, d\\rho} = \\frac{1/6}{1/4} = 2/3$. Thus, the tilt to be subtracted is $\\frac{2}{3}A_{\\mathrm{coma}}\\rho\\cos(\\theta)$, and the resulting term is $A_{\\mathrm{coma}}(\\rho^3\\cos(\\theta) - \\frac{2}{3}\\rho\\cos(\\theta))$.\n\n4.  **Spherical Aberration Term $A_{\\mathrm{sph}}\\rho^4$**: This term contains spherical aberration, defocus, and piston. We only need to remove the piston component. The average value of $\\rho^4$ is $\\langle \\rho^4 \\rangle = \\frac{\\int_0^{2\\pi}\\int_0^1 \\rho^4 \\cdot \\rho \\, d\\rho \\, d\\theta}{\\pi} = 2\\int_0^1 \\rho^5 \\, d\\rho = 1/3$. The term with piston removed is $A_{\\mathrm{sph}}(\\rho^4 - 1/3)$.\n\nCombining these gives the total OPD with piston and tilt removed, $W_{\\mathrm{ab}}(\\rho,\\theta)$:\n$$W_{\\mathrm{ab}}(\\rho,\\theta) = A_{\\mathrm{def}}\\left(\\rho^2 - \\frac{1}{2}\\right) + A_{\\mathrm{ast}}\\rho^2 \\cos(2\\theta) + A_{\\mathrm{coma}}\\left(\\rho^3 - \\frac{2}{3}\\rho\\right)\\cos(\\theta) + A_{\\mathrm{sph}}\\left(\\rho^4 - \\frac{1}{3}\\right)$$\nFinally, the pupil phase $\\phi(\\rho,\\theta)$ is obtained by converting the OPD to phase:\n$$\\phi(\\rho,\\theta) = \\frac{2\\pi}{\\lambda}W_{\\mathrm{ab}}(\\rho,\\theta)$$",
            "answer": "$$ \\boxed{ \\frac{2\\pi}{\\lambda} \\left[ A_{\\mathrm{def}}\\left(\\rho^2 - \\frac{1}{2}\\right) + A_{\\mathrm{ast}}\\rho^2 \\cos(2\\theta) + A_{\\mathrm{coma}}\\left(\\rho^3 - \\frac{2}{3}\\rho\\right)\\cos(\\theta) + A_{\\mathrm{sph}}\\left(\\rho^4 - \\frac{1}{3}\\right) \\right] } $$"
        },
        {
            "introduction": "The object being imaged—the mask—can modulate light by altering its amplitude, its phase, or both. This exercise explores the fundamental response of a coherent imaging system to these different types of modulation, revealing a critical principle of Fourier optics. By comparing the image contrast generated by a pure phase object to that of an amplitude object, you will discover why simple imaging systems struggle to \"see\" phase variations and understand the physical basis for advanced techniques like phase-shift masking .",
            "id": "4162781",
            "problem": "A scalar coherent projection system for semiconductor lithography is modeled by a linear shift-invariant filter with coherent transfer function $H(f) = A(f)\\exp(i\\phi(f))$, where $A(f)$ is the pupil amplitude and $\\phi(f)$ is the pupil phase at spatial frequency $f$. Assume an aberration-free in-focus condition so that $A(f)=1$ for $|f|\\le f_{c}$ and $A(f)=0$ otherwise, and $\\phi(f)$ is constant across the passband so that $\\phi(f)=\\phi_{0}$ for all $|f|\\le f_{c}$. Consider one-dimensional periodic masks with fundamental spatial frequency $f$ satisfying $f<f_{c}$, so that only the zero and first diffraction orders ($0,\\pm f$) are transmitted by the pupil.\n\nTwo masks are to be imaged:\n- Amplitude sinusoidal mask: $t_{a}(x)=1+\\epsilon\\cos(2\\pi f x)$ with $0<\\epsilon\\ll 1$.\n- Phase sinusoidal mask with a $\\pi$ phase modulation depth: $t_{p}(x)=\\exp\\!\\big(i\\pi\\cos(2\\pi f x)\\big)$.\n\nStarting from Fourier optics for coherent imaging and the Jacobi–Anger expansion for the phase mask, derive the image intensity $I(x)$ in each case up to and including the fundamental harmonic at spatial frequency $f$. Define the harmonic image contrast at frequency $f$, denoted $C_f$, as the amplitude of the $\\cos(2\\pi f x)$ term in $I(x)$ divided by the mean intensity. Compute $C_{f}^{(\\text{phase},\\ \\pi)}$ for the phase mask and $C_{f}^{(\\text{ampl})}$ for the amplitude mask under the given pupil, and report the ratio $C_{f}^{(\\text{phase},\\ \\pi)} / C_{f}^{(\\text{ampl})}$ as a single value. No rounding is required. Explain the physical meaning of the result in terms of how pupil phase converts or suppresses phase information in coherent projection systems.",
            "solution": "This problem requires us to derive and compare the image contrast for a low-contrast amplitude mask and a $\\pi$-phase mask in a coherent imaging system.\n\n**1. Amplitude Mask Image and Contrast**\nThe mask transmission is $t_a(x) = 1 + \\epsilon \\cos(2\\pi f x)$. In a coherent imaging system, the image field $E_{img,a}(x)$ is the convolution of the object field with the point spread function, which is equivalent to filtering in the frequency domain. Given that the coherent transfer function (CTF) is $H(f') = \\exp(i\\phi_0)$ for the transmitted frequencies ($0, \\pm f$), the image field is:\n$$E_{img, a}(x) = \\exp(i\\phi_0) \\cdot t_a(x) = \\exp(i\\phi_0)(1 + \\epsilon \\cos(2\\pi f x))$$\nThe image intensity $I_a(x)$ is the squared magnitude of the field:\n$$I_a(x) = |E_{img, a}(x)|^2 = |1 + \\epsilon \\cos(2\\pi f x)|^2 = 1 + 2\\epsilon\\cos(2\\pi f x) + \\epsilon^2\\cos^2(2\\pi f x)$$\nUsing the identity $\\cos^2(\\theta) = \\frac{1}{2}(1 + \\cos(2\\theta))$, we find the intensity up to the fundamental harmonic:\n$$I_a(x) = \\left(1 + \\frac{\\epsilon^2}{2}\\right) + 2\\epsilon\\cos(2\\pi f x) + \\dots$$\nThe mean intensity is $\\langle I_a \\rangle = 1 + \\frac{\\epsilon^2}{2}$. The amplitude of the $\\cos(2\\pi f x)$ term is $2\\epsilon$.\nThe contrast is:\n$$C_{f}^{(\\text{ampl})} = \\frac{2\\epsilon}{1 + \\epsilon^2/2}$$\n\n**2. Phase Mask Image and Contrast**\nThe mask transmission is $t_p(x) = \\exp(i\\pi \\cos(2\\pi f x))$. We use the Jacobi-Anger expansion:\n$$t_p(x) = J_0(\\pi) + 2\\sum_{k=1}^{\\infty} i^k J_k(\\pi)\\cos(k \\cdot 2\\pi f x)$$\nSince the pupil only transmits the $0, \\pm f$ orders, the image field only contains the terms for $k=0$ and $k=1$:\n$$E_{img, p}(x) = \\exp(i\\phi_0) \\left[ J_0(\\pi) + 2i J_1(\\pi) \\cos(2\\pi f x) \\right]$$\nThe image intensity $I_p(x)$ is the squared magnitude:\n$$I_p(x) = |J_0(\\pi) + 2i J_1(\\pi) \\cos(2\\pi f x)|^2$$\n$$I_p(x) = (J_0(\\pi))^2 + (2 J_1(\\pi) \\cos(2\\pi f x))^2 = J_0^2(\\pi) + 4J_1^2(\\pi)\\cos^2(2\\pi f x)$$\nUsing the same trigonometric identity as before:\n$$I_p(x) = J_0^2(\\pi) + 2J_1^2(\\pi)(1 + \\cos(4\\pi f x)) = (J_0^2(\\pi) + 2J_1^2(\\pi)) + 2J_1^2(\\pi)\\cos(4\\pi f x)$$\nThe intensity contains a DC term and a harmonic at frequency $2f$. The amplitude of the fundamental harmonic at frequency $f$ is zero. Therefore, the contrast is:\n$$C_{f}^{(\\text{phase},\\ \\pi)} = 0$$\n\n**3. Ratio and Physical Explanation**\nThe ratio is:\n$$\\frac{C_{f}^{(\\text{phase},\\ \\pi)}}{C_{f}^{(\\text{ampl})}} = \\frac{0}{2\\epsilon / (1+\\epsilon^2/2)} = 0$$\n**Physical Meaning:** The result is zero because a conventional coherent imaging system with a constant pupil phase cannot \"see\" a pure phase object at its fundamental frequency. The object diffracts light into a zero order (DC term) and higher orders. For a phase object, the diffracted orders (e.g., $\\pm 1$ orders) are in phase quadrature ($90^\\circ$ phase shift) relative to the zero order. When these orders interfere to form an image, the interference term for the fundamental frequency vanishes. The intensity modulation appears only at twice the fundamental frequency. To visualize the phase object, a *differential* phase shift must be introduced between the zero and diffracted orders, for example by using a Zernike phase plate in the pupil plane. Since the given system has a constant pupil phase $\\phi_0$, no such differential shift occurs, and the phase information is suppressed in the intensity image.",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "Translating the continuous mathematics of imaging theory into a discrete computational model requires careful consideration of numerical artifacts. This practice addresses one of the most common pitfalls in simulation: the difference between linear convolution, which describes physical imaging, and the circular convolution inherent to Fast Fourier Transform (FFT) algorithms. By calculating the necessary zero-padding to suppress wrap-around errors to a desired tolerance, you will learn a crucial technique for ensuring the accuracy of any FFT-based imaging simulation .",
            "id": "4162763",
            "problem": "A projection lithography system is modeled under the scalar, incoherent approximation to the image formation process, where the aerial image intensity $I(\\mathbf{r})$ on the wafer is given by the convolution $I(\\mathbf{r}) = (m \\ast h)(\\mathbf{r})$ of a bounded mask intensity $m(\\mathbf{r})$ with the system’s Point Spread Function (PSF). In practice, even when a vector imaging model is used to compute a polarization-dependent, anisotropic PSF, the numerical convolution on a sampled grid is typically performed via the Discrete Fourier Transform (DFT) implemented by the Fast Fourier Transform (FFT). The DFT implicitly assumes periodic extension of the input arrays, so using FFT without padding yields circular convolution and wrap-around artifacts.\n\nTo control such artifacts, zero-padding is used. Consider a $2$-dimensional, isotropic Gaussian PSF on the wafer,\n$$\nh(\\mathbf{r}) = \\frac{1}{2\\pi \\sigma^2}\\exp\\!\\left(-\\frac{\\|\\mathbf{r}\\|^2}{2\\sigma^2}\\right),\n$$\nwhich is a well-tested approximation for the effective blur in partially coherent projection systems and resist/diffusion smoothing, even when the underlying pupil and polarization physics are treated rigorously. Assume the mask intensity is bounded as $0 \\le m(\\mathbf{r}) \\le 1$, the sampling pitch is $\\Delta = 4\\,\\mathrm{nm}$ on the wafer, and the Gaussian width is $\\sigma = 12\\,\\mathrm{nm}$. The mask is sampled on an $N_x \\times N_y$ grid with $N_x = N_y = 2048$.\n\nYou are tasked to explain, from first principles, why zero-padding is needed to avoid circular convolution artifacts in FFT-based PSF convolution, and to compute a padding size that guarantees a prescribed accuracy. Define the target accuracy as a uniform bound on the wrap-around aliasing error in the convolution result, specifically require the worst-case aliasing error in the computed image to be no greater than a fraction $\\delta = 10^{-4}$ of the maximum possible image intensity in the absence of wrap-around. Under these conditions, determine a minimum per-side padding $p$ (in pixels) that ensures the bound, and the corresponding minimal padded grid size to perform the FFT-based convolution without circular artifacts contaminating the field of view.\n\nWhich option correctly explains the need for zero-padding in this context and gives a correct numerical padding requirement and padded grid size?\n\nA. Because the Discrete Fourier Transform (DFT) assumes periodic extension, the FFT performs circular convolution; zero-padding is required to separate periodic copies of the object so that the PSF’s support does not overlap adjacent copies. For a $2$-dimensional normalized Gaussian PSF, the fraction of energy outside radius $R$ is $\\exp(-R^2/(2\\sigma^2))$. Enforcing $\\exp(-R^2/(2\\sigma^2)) \\le \\delta$ yields $R \\ge \\sigma\\sqrt{2\\ln(1/\\delta)}$. With $\\sigma = 12\\,\\mathrm{nm}$ and $\\delta = 10^{-4}$, $R \\approx 51.5\\,\\mathrm{nm}$, hence $p = \\lceil R/\\Delta \\rceil = \\lceil 51.5/4 \\rceil = 13$ pixels per side, and the minimal padded grid is $(N_x+2p)\\times(N_y+2p) = 2074 \\times 2074$.\n\nB. Zero-padding is unnecessary if the Point Spread Function (PSF) is normalized, because convolution preserves total energy; using FFT without padding produces the same linear convolution result as long as the PSF integrates to one, so $p=0$ and the grid remains $2048 \\times 2048$.\n\nC. A practical rule is to pad by one standard deviation of the Gaussian on each side; thus $p = \\lceil \\sigma/\\Delta \\rceil = \\lceil 12/4 \\rceil = 3$ pixels, and the padded grid is $2054 \\times 2054$.\n\nD. The padding should equal the Airy disk’s first-zero radius, $R \\approx 0.61\\,\\lambda/\\mathrm{NA}$, which defines the PSF’s support; for $\\lambda = 193\\,\\mathrm{nm}$ and numerical aperture $\\mathrm{NA} = 0.93$, this gives $R \\approx 127\\,\\mathrm{nm}$, so $p = \\lceil 127/4 \\rceil = 32$ pixels and the padded grid is $2112 \\times 2112$.",
            "solution": "This problem asks for the correct explanation and calculation for zero-padding in FFT-based convolution to meet a specific error tolerance.\n\n**1. Rationale for Zero-Padding**\nThe Discrete Fourier Transform (DFT), and its fast implementation (FFT), operates on finite-length signals by implicitly treating them as periodic. The discrete convolution theorem states that element-wise multiplication in the frequency domain corresponds to *circular* convolution in the spatial domain. Physical imaging, however, is described by *linear* convolution. In circular convolution, the PSF kernel \"wraps around\" the edges of the image grid, causing data from one side of the image to erroneously affect the other side. This is the wrap-around artifact. Zero-padding embeds the original data in a larger grid of zeros, creating a buffer zone. If this zone is wide enough to contain the effective support of the PSF, the wrap-around will only involve these zeros, correctly simulating linear convolution. Option A correctly summarizes this. Option B is incorrect because PSF normalization relates to energy conservation, not the mathematical distinction between linear and circular convolution.\n\n**2. Calculation of Padding Size**\nThe worst-case error is bounded by the fraction of the PSF's total volume (or \"energy\") that lies outside the padded region. The maximum possible image intensity is 1, as the mask is bounded by 1 and the PSF is normalized. So we need the truncated PSF volume to be less than $\\delta = 10^{-4}$.\n\nFor a 2D Gaussian PSF, the fraction of its volume outside a radius $R$ is:\n$$ \\text{Fraction} = \\int_R^\\infty \\frac{1}{2\\pi\\sigma^2} e^{-r^2/(2\\sigma^2)} 2\\pi r \\, dr = \\int_R^\\infty \\frac{r}{\\sigma^2} e^{-r^2/(2\\sigma^2)} \\, dr $$\nThis evaluates to $e^{-R^2 / (2\\sigma^2)}$.\n\nThe error condition is $e^{-R^2 / (2\\sigma^2)} \\le \\delta$. Solving for $R$:\n$$ -R^2 / (2\\sigma^2) \\le \\ln(\\delta) $$\n$$ R^2 \\ge -2\\sigma^2 \\ln(\\delta) = 2\\sigma^2 \\ln(1/\\delta) $$\n$$ R \\ge \\sigma \\sqrt{2 \\ln(1/\\delta)} $$\nPlugging in the given values $\\sigma = 12\\,\\mathrm{nm}$ and $\\delta = 10^{-4}$:\n$$ R \\ge (12\\,\\mathrm{nm}) \\sqrt{2 \\ln(10^4)} = (12\\,\\mathrm{nm}) \\sqrt{8 \\ln(10)} $$\nUsing $\\ln(10) \\approx 2.3026$:\n$$ R \\ge 12 \\sqrt{8 \\times 2.3026} \\approx 12 \\sqrt{18.42} \\approx 12 \\times 4.292 \\approx 51.5\\,\\mathrm{nm} $$\nThis required radius must be covered by the padding. Converting to pixels using the sampling pitch $\\Delta = 4\\,\\mathrm{nm}$:\n$$ p = \\left\\lceil \\frac{R}{\\Delta} \\right\\rceil = \\left\\lceil \\frac{51.5}{4} \\right\\rceil = \\lceil 12.875 \\rceil = 13\\,\\text{pixels} $$\nThis is the minimum padding on each side. The padded grid size required to prevent wrap-around artifacts from contaminating the original field of view is $(N_x + 2p) \\times (N_y + 2p)$:\n$$ (2048 + 2 \\times 13) \\times (2048 + 2 \\times 13) = 2074 \\times 2074 $$\n\n**3. Evaluation of Options**\n- **A**: The explanation and all calculations match our derivation. This option is correct.\n- **B**: Incorrectly states that padding is unnecessary.\n- **C**: Proposes a \"rule of thumb\" that results in a much smaller padding ($p=3$). This would correspond to a very large error, far exceeding the $\\delta=10^{-4}$ tolerance.\n- **D**: Incorrectly uses an Airy disk model for the PSF and introduces external parameters not given in the problem statement.\n\nTherefore, option A provides the correct explanation and numerical result based on the problem's premises.",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}