{
    "hands_on_practices": [
        {
            "introduction": "要理解光刻技术如何制造出复杂的图形，我们首先要回到一个基本原理：干涉。本练习  要求您从第一性原理出发，推导由两束相干平面波干涉产生的条纹间距。掌握这一计算，您将对如何利用光的波动性生成周期性结构建立起基础性的理解，这一原理不仅是基本成像的基础，也是干涉光刻等先进技术的核心。",
            "id": "4145672",
            "problem": "在用于半导体制造的双光束干涉光刻装置中，来自同一相干源的两束单色平面波在折射率为 $n$ 的均匀、线性、各向同性、无损介质内部相交。每束光束的真空波长为 $\\lambda_{0}$，在介质中以波长 $\\lambda=\\lambda_{0}/n$ 传播。两束光束以一个内夹角 $\\theta$（它们在介质内部传播方向之间的夹角）相交。假设振幅相等、线偏振相同，忽略边界处的反射，并利用平面波叠加形成的时间平均光强，从第一性原理推导出沿垂直于两光束角平分线的横向方向上干涉条纹的空间周期。然后，使用参数 $\\lambda_{0}=193\\,\\mathrm{nm}$，$n=1.60$ 和 $\\theta=36^{\\circ}$ 计算条纹间距的数值。将最终的条纹间距以纳米为单位表示，并四舍五入到四位有效数字。角度以度为单位。",
            "solution": "问题要求推导在电介质中由两束相交的单色平面波形成的干涉条纹的空间周期，然后进行数值计算。推导将基于电磁波的叠加原理。\n\n让我们建立一个坐标系来描述干涉的几何结构。设包含两束光传播矢量的入射面为 $xz$ 平面。设 $z$ 轴是两光束夹角 $\\theta$ 的角平分线。$x$ 轴位于入射面内，并垂直于该角平分线。$y$ 轴垂直于入射面。\n\n这两束单色平面波是相干的，具有相同的真空波长 $\\lambda_{0}$。它们在折射率为 $n$ 的介质中传播。介质中的波长为 $\\lambda = \\frac{\\lambda_{0}}{n}$，介质中波矢的大小为 $k = \\frac{2\\pi}{\\lambda} = \\frac{2\\pi n}{\\lambda_{0}}$。\n\n两个波的传播矢量 $\\mathbf{k}_1$ 和 $\\mathbf{k}_2$ 之间的夹角为 $\\theta$。在我们选择的坐标系中，每个波矢与 $z$ 轴的夹角为 $\\frac{\\theta}{2}$。波矢的分量为：\n$$\n\\mathbf{k}_1 = k \\left( \\sin\\left(\\frac{\\theta}{2}\\right)\\hat{x} + \\cos\\left(\\frac{\\theta}{2}\\right)\\hat{z} \\right)\n$$\n$$\n\\mathbf{k}_2 = k \\left( -\\sin\\left(\\frac{\\theta}{2}\\right)\\hat{x} + \\cos\\left(\\frac{\\theta}{2}\\right)\\hat{z} \\right)\n$$\n问题陈述光束具有相等的振幅和相同的线偏振。我们可以用复指数形式表示这两束波的电场。设位置矢量为 $\\mathbf{r} = x\\hat{x} + y\\hat{y} + z\\hat{z}$。电场为：\n$$\n\\mathbf{E}_1(\\mathbf{r}, t) = \\mathbf{E}_0 \\exp\\left(i(\\mathbf{k}_1 \\cdot \\mathbf{r} - \\omega t)\\right)\n$$\n$$\n\\mathbf{E}_2(\\mathbf{r}, t) = \\mathbf{E}_0 \\exp\\left(i(\\mathbf{k}_2 \\cdot \\mathbf{r} - \\omega t)\\right)\n$$\n其中 $\\mathbf{E}_0$ 是恒定的复振幅矢量，$\\omega$ 是角频率。\n\n空间中任意点的总电场是两个单独电场的叠加：\n$$\n\\mathbf{E}_{\\text{total}}(\\mathbf{r}, t) = \\mathbf{E}_1(\\mathbf{r}, t) + \\mathbf{E}_2(\\mathbf{r}, t) = \\mathbf{E}_0 \\exp(-i\\omega t) \\left[ \\exp(i\\mathbf{k}_1 \\cdot \\mathbf{r}) + \\exp(i\\mathbf{k}_2 \\cdot \\mathbf{r}) \\right]\n$$\n计算指数中的点积：\n$$\n\\mathbf{k}_1 \\cdot \\mathbf{r} = k \\left( x\\sin\\left(\\frac{\\theta}{2}\\right) + z\\cos\\left(\\frac{\\theta}{2}\\right) \\right)\n$$\n$$\n\\mathbf{k}_2 \\cdot \\mathbf{r} = k \\left( -x\\sin\\left(\\frac{\\theta}{2}\\right) + z\\cos\\left(\\frac{\\theta}{2}\\right) \\right)\n$$\n将这些代入总电场的表达式中：\n$$\n\\mathbf{E}_{\\text{total}}(\\mathbf{r}, t) = \\mathbf{E}_0 \\exp(-i\\omega t) \\left[ \\exp\\left(ik\\left(x\\sin\\left(\\frac{\\theta}{2}\\right) + z\\cos\\left(\\frac{\\theta}{2}\\right)\\right)\\right) + \\exp\\left(ik\\left(-x\\sin\\left(\\frac{\\theta}{2}\\right) + z\\cos\\left(\\frac{\\theta}{2}\\right)\\right)\\right) \\right]\n$$\n提出与 $z$ 相关的公因项：\n$$\n\\mathbf{E}_{\\text{total}}(\\mathbf{r}, t) = \\mathbf{E}_0 \\exp\\left(i\\left(kz\\cos\\left(\\frac{\\theta}{2}\\right) - \\omega t\\right)\\right) \\left[ \\exp\\left(ikx\\sin\\left(\\frac{\\theta}{2}\\right)\\right) + \\exp\\left(-ikx\\sin\\left(\\frac{\\theta}{2}\\right)\\right) \\right]\n$$\n使用欧拉公式 $\\cos(\\phi) = \\frac{e^{i\\phi} + e^{-i\\phi}}{2}$，方括号中的项变为 $2\\cos\\left(kx\\sin\\left(\\frac{\\theta}{2}\\right)\\right)$。\n$$\n\\mathbf{E}_{\\text{total}}(\\mathbf{r}, t) = 2\\mathbf{E}_0 \\cos\\left(kx\\sin\\left(\\frac{\\theta}{2}\\right)\\right) \\exp\\left(i\\left(kz\\cos\\left(\\frac{\\theta}{2}\\right) - \\omega t\\right)\\right)\n$$\n时间平均光强 $I$ 与复电场模的平方成正比，$I \\propto |\\mathbf{E}_{\\text{total}}|^2$。\n$$\n|\\mathbf{E}_{\\text{total}}|^2 = \\mathbf{E}_{\\text{total}} \\cdot \\mathbf{E}_{\\text{total}}^* = \\left| 2\\mathbf{E}_0 \\cos\\left(kx\\sin\\left(\\frac{\\theta}{2}\\right)\\right) \\right|^2\n$$\n$$\nI(x) \\propto 4 |\\mathbf{E}_0|^2 \\cos^2\\left(kx\\sin\\left(\\frac{\\theta}{2}\\right)\\right)\n$$\n光强分布与 $y$ 和 $z$ 无关，形成平行于 $yz$ 平面的条纹，空间变化完全沿 $x$ 方向，这与预期相符。使用三角恒等式 $\\cos^2(\\phi) = \\frac{1}{2}(1 + \\cos(2\\phi))$，我们可以将光强分布重写为：\n$$\nI(x) \\propto 2 |\\mathbf{E}_0|^2 \\left[ 1 + \\cos\\left(2kx\\sin\\left(\\frac{\\theta}{2}\\right)\\right) \\right]\n$$\n这个表达式描述了沿 $x$ 轴的正弦强度调制。干涉条纹的空间周期，记为 $\\Lambda$，是余弦函数自变量变化 $2\\pi$ 所经过的距离。设自变量为 $\\Phi(x) = 2kx\\sin\\left(\\frac{\\theta}{2}\\right)$。对于一个完整周期，我们必须有：\n$$\n\\Phi(x+\\Lambda) - \\Phi(x) = 2k(x+\\Lambda)\\sin\\left(\\frac{\\theta}{2}\\right) - 2kx\\sin\\left(\\frac{\\theta}{2}\\right) = 2\\pi\n$$\n$$\n2k\\Lambda\\sin\\left(\\frac{\\theta}{2}\\right) = 2\\pi\n$$\n解出条纹周期 $\\Lambda$：\n$$\n\\Lambda = \\frac{\\pi}{k\\sin\\left(\\frac{\\theta}{2}\\right)}\n$$\n现在，我们代入波数的表达式 $k = \\frac{2\\pi}{\\lambda} = \\frac{2\\pi n}{\\lambda_{0}}$：\n$$\n\\Lambda = \\frac{\\pi}{\\left(\\frac{2\\pi n}{\\lambda_{0}}\\right)\\sin\\left(\\frac{\\theta}{2}\\right)} = \\frac{\\lambda_{0}}{2n\\sin\\left(\\frac{\\theta}{2}\\right)}\n$$\n这就是推导出的干涉条纹空间周期的表达式。\n\n接下来，我们使用给定的参数计算数值：$\\lambda_{0}=193\\,\\mathrm{nm}$，$n=1.60$ 和 $\\theta=36^{\\circ}$。\n首先，计算半角：\n$$\n\\frac{\\theta}{2} = \\frac{36^{\\circ}}{2} = 18^{\\circ}\n$$\n现在，将数值代入推导出的 $\\Lambda$ 公式中：\n$$\n\\Lambda = \\frac{193\\,\\mathrm{nm}}{2 \\times 1.60 \\times \\sin(18^{\\circ})}\n$$\n$$\n\\Lambda = \\frac{193}{3.2 \\times \\sin(18^{\\circ})} \\,\\mathrm{nm}\n$$\n使用数值 $\\sin(18^{\\circ}) \\approx 0.309017$：\n$$\n\\Lambda \\approx \\frac{193}{3.2 \\times 0.309017} \\,\\mathrm{nm}\n$$\n$$\n\\Lambda \\approx \\frac{193}{0.9888544} \\,\\mathrm{nm}\n$$\n$$\n\\Lambda \\approx 195.1763 \\,\\mathrm{nm}\n$$\n问题要求将答案四舍五入到四位有效数字。\n$$\n\\Lambda \\approx 195.2 \\,\\mathrm{nm}\n$$\n条纹间距的数值为 $195.2$ 纳米。",
            "answer": "$$\n\\boxed{195.2}\n$$"
        },
        {
            "introduction": "干涉展示了波如何叠加形成图案，而衍射则描述了像掩模版这样的物体如何散射光。本练习  要求您模拟单缝夫琅禾费衍射这一经典案例，推导其衍射图样的零点位置和主瓣宽度。这个练习至关重要，因为它揭示了物体特征的空间信息是如何被编码在其衍射图样中的——这是傅里叶光学和任何投影系统成像分析的核心概念。",
            "id": "4145745",
            "problem": "在用于半导体制造的先进光学光刻技术中，由掩模开口产生的空中成像，是在远场（Fraunhofer）近似下，使用标量衍射理论来建模的。考虑一束来自激光（Light Amplification by Stimulated Emission of Radiation, LASER）的单色相干平面波，其真空波长为 $\\lambda$，垂直入射到一个在 $x$ 方向宽度为 $w$、在 $y$ 方向无限延伸的一维狭缝上。其孔径透射率为：当 $|x|\\leq w/2$ 时，$A(x)=1$；否则 $A(x)=0$。在远场中，相对于光轴（$z$ 方向）成 $\\theta$ 角的位置进行观察，使得标量 Kirchhoff 衍射积分简化为 $A(x)$ 的傅里叶变换，该变换在空间频率 $k_{x}=k\\sin\\theta$ 处求值，其中 $k=2\\pi/\\lambda$ 是自由空间波数。\n\n从 Huygens–Fresnel 原理和 Fraunhofer 衍射近似出发，推导远场光强分布 $I(\\theta)$（可忽略一个乘法常数），并由此确定：\n\n1. $I(\\theta)$ 的所有零点（暗纹）的角位置 $\\theta_{m}$，由非零整数阶数 $m\\in\\mathbb{Z}\\setminus\\{0\\}$ 索引，且满足物理约束 $|\\sin\\theta_{m}|\\leq 1$。\n2. 主瓣的全角宽度 $\\Delta\\theta_{\\text{main}}$，定义为对称分布在 $\\theta=0$ 两侧的前两个零点之间的角间距。\n\n将 $\\theta_{m}$ 和 $\\Delta\\theta_{\\text{main}}$ 的最终结果表示为以 $w$ 和 $\\lambda$ 表示的闭合形式解析表达式。角度以弧度表示。无需进行数值计算或四舍五入。您的最终答案必须是包含两个结果的单一复合表达式。",
            "solution": "该问题要求在相干、单色、垂直照明条件下，推导单缝的远场光强分布。根据所提供的信息（这与 Fraunhofer 衍射的标量理论一致），在远场观察角 $\\theta$ 处，衍射电场的复振幅 $E$ 与孔径透射函数 $A(x)$ 的傅里叶变换成正比。傅里叶变换在空间频率 $k_x = k\\sin\\theta$ 处求值，其中 $k = 2\\pi/\\lambda$ 是波数，$\\lambda$ 是光的真空波长，$x$ 是孔径上的坐标。\n\n位于原点、宽度为 $w$ 的狭缝的孔径透射函数 $A(x)$ 如下：\n$$\nA(x) =\n\\begin{cases}\n1  \\text{ for } |x| \\leq w/2 \\\\\n0  \\text{ for } |x| > w/2\n\\end{cases}\n$$\n因此，远场振幅 $E(\\theta)$ 与 $A(x)$ 的傅里叶变换成正比：\n$$\nE(\\theta) \\propto \\int_{-\\infty}^{\\infty} A(x) \\exp(-i k_x x) \\,dx\n$$\n代入 $A(x)$ 的表达式：\n$$\nE(\\theta) \\propto \\int_{-w/2}^{w/2} 1 \\cdot \\exp(-i k_x x) \\,dx\n$$\n我们计算这个积分：\n$$\n\\int_{-w/2}^{w/2} \\exp(-i k_x x) \\,dx = \\left[ \\frac{\\exp(-i k_x x)}{-i k_x} \\right]_{-w/2}^{w/2}\n$$\n假设 $k_x \\neq 0$：\n$$\n= \\frac{\\exp(-i k_x w/2) - \\exp(i k_x w/2)}{-i k_x} = \\frac{\\exp(i k_x w/2) - \\exp(-i k_x w/2)}{i k_x}\n$$\n使用 Euler 恒等式 $\\sin(\\alpha) = \\frac{\\exp(i\\alpha) - \\exp(-i\\alpha)}{2i}$，我们可以重写该表达式：\n$$\n= \\frac{2 \\sin(k_x w/2)}{k_x}\n$$\n为了将其表示为 sinc 函数的形式，我们乘以并除以 $w/2$：\n$$\n= w \\frac{\\sin(k_x w/2)}{k_x w/2}\n$$\n现在，我们代入空间频率 $k_x = k \\sin\\theta = \\frac{2\\pi}{\\lambda}\\sin\\theta$。正弦函数的宗量变为：\n$$\n\\frac{k_x w}{2} = \\frac{1}{2} \\left( \\frac{2\\pi}{\\lambda}\\sin\\theta \\right) w = \\frac{\\pi w \\sin\\theta}{\\lambda}\n$$\n所以，远场振幅为：\n$$\nE(\\theta) \\propto w \\frac{\\sin\\left(\\frac{\\pi w \\sin\\theta}{\\lambda}\\right)}{\\frac{\\pi w \\sin\\theta}{\\lambda}}\n$$\n衍射光的光强 $I(\\theta)$ 与复振幅的模的平方成正比，即 $I(\\theta) \\propto |E(\\theta)|^2$。因此，在忽略一个乘法常数的情况下，光强分布为：\n$$\nI(\\theta) \\propto \\left[ \\frac{\\sin\\left(\\frac{\\pi w \\sin\\theta}{\\lambda}\\right)}{\\frac{\\pi w \\sin\\theta}{\\lambda}} \\right]^2\n$$\n这是单缝衍射经典的 sinc 平方光强图样。\n\n1. 确定零点角位置 $\\theta_m$：\n光强分布 $I(\\theta)$ 的零点出现在分子为零且分母不为零的位置。当分子 $\\sin\\left(\\frac{\\pi w \\sin\\theta}{\\lambda}\\right)$ 的宗量是 $\\pi$ 的非零整数倍时，其值为零。\n$$\n\\frac{\\pi w \\sin\\theta_m}{\\lambda} = m\\pi, \\quad \\text{for } m \\in \\mathbb{Z} \\setminus \\{0\\}\n$$\n$m=0$ 的情况被排除，因为它对应于 $\\theta=0$。当 $\\theta \\to 0$ 时，表达式 $\\sin(\\alpha)/\\alpha \\to 1$，这给出了衍射图样的主极大值，而不是零点。\n求解 $\\sin\\theta_m$：\n$$\n\\sin\\theta_m = \\frac{m\\lambda}{w}\n$$\n然后通过对该表达式取反正弦来找到角位置 $\\theta_m$。物理约束 $|\\sin\\theta_m| \\leq 1$ 意味着解仅对满足 $|m| \\leq w/\\lambda$ 的整数阶 $m$ 存在。反正弦函数的定义域自动满足此约束。\n$$\n\\theta_m = \\arcsin\\left(\\frac{m\\lambda}{w}\\right), \\quad \\text{for } m \\in \\mathbb{Z} \\setminus \\{0\\} \\text{ such that } \\left|\\frac{m\\lambda}{w}\\right| \\leq 1\n$$\n\n2. 确定主瓣的全角宽度 $\\Delta\\theta_{\\text{main}}$：\n主瓣是位于中心 $\\theta=0$ 处的中央亮条纹。其角范围由中心两侧的第一级零点所限定。这些零点对应于整数阶 $m=1$ 和 $m=-1$。\n$m=1$ 的第一级零点的角位置是：\n$$\n\\theta_1 = \\arcsin\\left(\\frac{1 \\cdot \\lambda}{w}\\right) = \\arcsin\\left(\\frac{\\lambda}{w}\\right)\n$$\n$m=-1$ 的第一级零点的角位置是：\n$$\n\\theta_{-1} = \\arcsin\\left(\\frac{-1 \\cdot \\lambda}{w}\\right) = -\\arcsin\\left(\\frac{\\lambda}{w}\\right)\n$$\n主瓣的全角宽度 $\\Delta\\theta_{\\text{main}}$ 是这两个零点之间的角间距：\n$$\n\\Delta\\theta_{\\text{main}} = \\theta_1 - \\theta_{-1} = \\arcsin\\left(\\frac{\\lambda}{w}\\right) - \\left(-\\arcsin\\left(\\frac{\\lambda}{w}\\right)\\right)\n$$\n$$\n\\Delta\\theta_{\\text{main}} = 2\\arcsin\\left(\\frac{\\lambda}{w}\\right)\n$$\n此表达式为精确的角宽度。在常见的 $\\lambda \\ll w$ 的小角近似中，$\\arcsin(x) \\approx x$，这将得出 $\\Delta\\theta_{\\text{main}} \\approx 2\\lambda/w$。然而，问题并未指明要使用此近似，因此需要精确形式。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\arcsin\\left(\\frac{m\\lambda}{w}\\right) & 2\\arcsin\\left(\\frac{\\lambda}{w}\\right) \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "这最后一个综合性练习将衍射和干涉的原理融合成一个现代光刻技术中核心的、真实的计算建模任务。您将编写一个程序，为给定的周期性图形寻找能够最大化图像对比度的最佳环形照明设置。本练习  是一个总结性的实践，它将理论原理与光源-掩模协同优化（Source-Mask Optimization, SMO）的实际工程挑战联系起来——这是先进半导体制造中使用的一项关键分辨率增强技术（Resolution Enhancement Technique, RET）。",
            "id": "4145707",
            "problem": "要求您编写一个程序，该程序针对由一个标量、无像差投影系统成像的一维周期性线-空间图案，计算可使图案基频空间频率下的空中图像对比度最大化的最佳环形光源参数 $\\left(\\sigma_{in},\\sigma_{out}\\right)$。该设定反映了先进的光学光刻技术，波长 $\\lambda=193\\,\\mathrm{nm}$，数值孔径 (NA) $=0.93$，其中部分相干照明被建模为光源光瞳中的一个均匀强度环带。目标是首先从第一性原理出发，使用标量傅里叶光学来构建部分相干照明下物理上一致的图像形成公式，然后实现一个针对环形光源参数的数值搜索，以最大化对比度。您的程序必须实现该模型，并对给定的一组目标间距测试套件执行优化。\n\n基本物理和建模假设：\n- 在空间频率域中使用标量Abbe成像。令光瞳截止空间频率为 $f_c=\\mathrm{NA}/\\lambda$。光源点通过归一化光瞳坐标中的半径 $\\sigma\\in[0,1]$ 和方位角 $\\theta\\in[0,2\\pi)$ 表示，其中 $\\sigma=1$ 对应于光瞳边缘。\n- 考虑一个一维二元振幅掩模（薄掩模，无成像偏移），由占空比为 $0.5$ 的周期性线-空间组成（即线宽和空间宽度相等）。该掩模振幅透射率的傅里叶级数振幅由 $A_0=0.5$ 和 $A_{\\pm 1}=1/\\pi$ 给出，且对于偶数 $m\\neq 0$，$A_m=0$。这些振幅由占空比为 $50\\%$ 的矩形波的标准傅里叶级数得到。\n- 在空中图像中仅需考虑 $m=0$ 和 $m=\\pm 1$ 的衍射级次（忽略更高阶）。图案空间频率为 $k=1/p$，其中 $p$ 是间距。引入归一化频率 $\\nu=\\lambda/(\\mathrm{NA}\\,p)$。\n- 对于一个给定的光源点 $\\left(\\sigma,\\theta\\right)$，在一维截面上沿线-空间方向，$m=0$ 级次位于归一化光瞳坐标 $\\sigma\\cos\\theta$ 处，$m=+1$ 级次位于 $\\sigma\\cos\\theta+\\nu$ 处，而 $m=-1$ 级次位于 $\\sigma\\cos\\theta-\\nu$ 处。一个衍射级次能够被传输当且仅当其归一化坐标的绝对值 $\\leq 1$。\n- 空中图像的强度是通过在环形光源上对每个光源点形成的强度进行非相干平均得到的。由于部分相干性，您必须平均强度（而非场）。对基频空间频率的贡献来自于 $m=0$ 级次与每个被传输的 $m=\\pm 1$ 级次之间的干涉。对于处于最佳焦平面的远心投影系统，来自 $m=+1$ 和 $m=-1$ 分支的贡献以相同相位叠加。\n\n对比度的定义与待实现的计算：\n- 对于单个光源点 $\\left(\\sigma,\\theta\\right)$，定义指示函数 $P_{+}(\\sigma,\\theta;\\nu)$ 和 $P_{-}(\\sigma,\\theta;\\nu)$，如果 $m=+1$ 或 $m=-1$ 级次分别被传输，则其值为 $1$，否则为 $0$。使用通过条件 $|\\sigma\\cos\\theta+\\nu|\\leq 1$ 和 $|\\sigma\\cos\\theta-\\nu|\\leq 1$。角度必须为弧度制。\n- 对于该单个光源点，仅保留 $m=0$ 和 $m=\\pm 1$ 时，强度的基波谐波（$\\cos(2\\pi x/p)$ 的系数）其振幅正比于 $2A_0A_1\\left(P_{+}+P_{-}\\right)$，而直流 (DC) 强度（空间平均值）为 $A_0^2 + A_1^2\\left(P_{+}+P_{-}\\right)$。\n- 部分相干图像对比度是光源平均的基波振幅与光源平均的直流强度之比，其中平均是在与 $\\sigma\\,d\\sigma\\,d\\theta$ 成正比的环形光源面积元上进行的。也就是说，您必须在 $\\sigma\\in[\\sigma_{in},\\sigma_{out}]$ 和 $\\theta\\in[0,2\\pi)$ 上计算面积加权平均值。\n\n优化任务：\n- 对于每个目标间距 $p$，对环形光源 $\\left(\\sigma_{in},\\sigma_{out}\\right)$ 进行离散网格搜索，需满足 $0 \\le \\sigma_{in} \\le \\sigma_{out} \\le 1$、最小环带厚度约束 $\\sigma_{out}-\\sigma_{in}\\ge \\Delta\\sigma_{min}$ 以及环带上均匀的光源强度。\n- 在 $\\sigma$ 上使用步长为 $\\Delta\\sigma=0.01$ 的均匀网格，并限制 $\\sigma_{in}\\ge 0.20$ 以反映实际的光源遮蔽。使用 $\\Delta\\sigma_{min}=0.05$。在 $\\theta$ 积分中使用 $N_\\theta=4096$ 个在 $[0,2\\pi)$（弧度制）范围内的均匀角度采样点。\n- 对于每个候选环带，通过与上述模型一致的离散求和来数值近似对比度。然后选择使对比度最大化的 $\\left(\\sigma_{in},\\sigma_{out}\\right)$。\n- 决胜规则：如果多个候选者在 $10^{-12}$ 的绝对容差内达到最大对比度，则选择环带厚度 $\\sigma_{out}-\\sigma_{in}$ 最小的那个。如果仍然打平，选择 $\\sigma_{out}$ 最小的，然后选择 $\\sigma_{in}$ 最小的。\n- 在边界情况下，如果所有候选者的最大对比度在绝对容差 $10^{-12}$ 内等于零（例如，当 $\\nu>2$ 时，没有任何光源点能产生可分辨的一阶衍射），则为该测试案例返回 $\\left(-1.0,-1.0\\right)$。\n\n数值常数和单位：\n- 使用 $\\lambda=193\\,\\mathrm{nm}$ 和 $\\mathrm{NA}=0.93$。\n- 目标间距 $p$ 以纳米为单位指定，并且必须与 $\\lambda$ 一致处理以计算 $\\nu=\\lambda/(\\mathrm{NA}\\,p)$。\n- 角度必须为弧度制。\n- 您的输出参数 $\\sigma_{in},\\sigma_{out}$ 是无量纲的，并且必须四舍五入到三位小数。\n\n测试套件：\n- 使用以下四个间距：$p\\in\\{220\\,\\mathrm{nm},130\\,\\mathrm{nm},105\\,\\mathrm{nm},95\\,\\mathrm{nm}\\}$。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，包含一个有四个元素的Python风格列表，每个元素对应一个测试案例，顺序与上文相同。每个元素必须是一个包含 $\\left[\\sigma_{in},\\sigma_{out}\\right]$ 的双元素列表，四舍五入到三位小数。例如，一个有效的输出行格式为 `[[0.300,0.700],[0.250,0.850],[0.210,0.780],[-1.000,-1.000]]`，除了分隔标记所必需的空格外，没有多余的空格。\n\n不允许用户输入；程序必须按原样运行并打印所需的单行输出。您的实现必须遵守上述积分和离散化指令，并且不得调用任何外部文件或网络。",
            "solution": "用户在光学光刻建模领域提供了一个定义明确的问题。已对问题陈述进行了验证，并发现其在科学上是合理的、适定的和客观的。该问题要求确定最佳的环形照明参数，以最大化几种周期性图案的空中图像对比度。解决方案将从标量傅里叶光学的第一性原理推导得出，并根据指定的约束条件，以网格搜索优化的形式进行数值实现。\n\n解决方案分为三个主要阶段：\n1.  **解析公式推导**：我们推导在部分相干环形照明下的空中图像对比度表达式。\n2.  **数值近似**：我们根据题目要求将解析表达式离散化，以便进行数值计算。\n3.  **优化算法**：我们设计一个网格搜索算法，以找到最大化所计算对比度的最佳光源参数，其中包括指定的决胜逻辑。\n\n**1. 对比度的解析公式推导**\n\n该系统由一个数值孔径为NA的投影系统组成，用于在波长λ下对间距为p的周期性掩模进行成像。控制分辨率的关键参数是图案的归一化空间频率ν：\n$$ \\nu = \\frac{\\lambda}{NA \\cdot p} $$\n掩模是占空比为$50\\%$的一维线-空间图案。对于这样的二元振幅光栅，其透射率函数的傅里叶级数振幅是已知的。我们只考虑三个中心衍射级次：零级（$m=0$）和一级（$m=\\pm 1$）。它们的振幅被给定为 $A_0 = 0.5$ 和 $A_1 = 1/\\pi$（我们假设 $A_{-1} = A_1$ 的大小相等，这是标准做法，并且问题描述中也隐含了这一点）。\n\n照明是部分相干的，来源于一个环形光源。光源上的一点由归一化光瞳坐标 $(\\sigma, \\theta)$ 描述，其中 $\\sigma$ 是径向坐标 ($0 \\le \\sigma \\le 1$)，$\\theta$ 是方位角 ($0 \\le \\theta  2\\pi$)。对于位于 $(\\sigma, \\theta)$ 的一个光源点，这三个衍射级次在投影透镜的光瞳中发生位移。沿着平行于图案周期性的轴线，它们的归一化位置是：\n-   $m=0$ 级次: $u_0 = \\sigma \\cos\\theta$\n-   $m=+1$ 级次: $u_{+1} = \\sigma \\cos\\theta + \\nu$\n-   $m=-1$ 级次: $u_{-1} = \\sigma \\cos\\theta - \\nu$\n\n一个衍射级次能够通过系统传输，条件是其位置的绝对值不超过光瞳半径，即 $|u_m| \\le 1$。$m=0$ 级次总是能被传输，因为 $|\\sigma \\cos\\theta| \\le \\sigma \\le 1$。一级衍射的传输是有条件的。我们定义指示函数 $P_{+}(\\sigma, \\theta; \\nu)$ 和 $P_{-}(\\sigma, \\theta; \\nu)$:\n$$ P_{+}(\\sigma, \\theta; \\nu) = \\begin{cases} 1,  \\text{if } |\\sigma \\cos\\theta + \\nu| \\le 1 \\\\ 0,  \\text{otherwise} \\end{cases} $$\n$$ P_{-}(\\sigma, \\theta; \\nu) = \\begin{cases} 1,  \\text{if } |\\sigma \\cos\\theta - \\nu| \\le 1 \\\\ 0,  \\text{otherwise} \\end{cases} $$\n对于单个光源点，空中图像强度 $I(x)$ 是由传输的衍射级次干涉产生的。图像对比度由基波谐波分量和直流（平均）强度定义。使用所给的模型：\n-   基波谐波的振幅（正比于 $\\cos(2\\pi x/p)$）: $N_{sp}(\\sigma, \\theta) = 2 A_0 A_1 (P_{+} + P_{-})$\n-   强度的直流分量: $D_{sp}(\\sigma, \\theta) = A_0^2 + A_1^2 (P_{+} + P_{-})$\n\n为了找到由内径 $\\sigma_{in}$ 和外径 $\\sigma_{out}$ 定义的完整环形光源的对比度，我们必须在环带面积上对这些量进行平均。面积元为 $dA = \\sigma \\, d\\sigma \\, d\\theta$。\n光源平均的基波振幅为 $\\langle N \\rangle$，光源平均的直流强度为 $\\langle D \\rangle$。图像对比度 $C$ 是它们的比值：\n$$ C = \\frac{\\langle N \\rangle}{\\langle D \\rangle} = \\frac{\\int_{\\sigma_{in}}^{\\sigma_{out}} \\int_{0}^{2\\pi} N_{sp}(\\sigma, \\theta) \\, \\sigma \\, d\\sigma \\, d\\theta}{\\int_{\\sigma_{in}}^{\\sigma_{out}} \\int_{0}^{2\\pi} D_{sp}(\\sigma, \\theta) \\, \\sigma \\, d\\sigma \\, d\\theta} $$\n代入 $N_{sp}$ 和 $D_{sp}$ 的表达式：\n$$ C(\\sigma_{in}, \\sigma_{out}, \\nu) = \\frac{2 A_0 A_1 \\int_{\\sigma_{in}}^{\\sigma_{out}} \\int_{0}^{2\\pi} (P_{+} + P_{-}) \\, \\sigma \\, d\\sigma \\, d\\theta}{A_0^2 \\int_{\\sigma_{in}}^{\\sigma_{out}} \\int_{0}^{2\\pi} \\sigma \\, d\\sigma \\, d\\theta + A_1^2 \\int_{\\sigma_{in}}^{\\sigma_{out}} \\int_{0}^{2\\pi} (P_{+} + P_{-}) \\, \\sigma \\, d\\sigma \\, d\\theta} $$\n我们定义两个积分来简化此表达式。首先是角度积分 $I(\\sigma, \\nu)$:\n$$ I(\\sigma, \\nu) = \\int_{0}^{2\\pi} [P_{+}(\\sigma, \\theta; \\nu) + P_{-}(\\sigma, \\theta; \\nu)] \\, d\\theta $$\n以及径向积分 $J(\\sigma_{in}, \\sigma_{out}, \\nu)$:\n$$ J(\\sigma_{in}, \\sigma_{out}, \\nu) = \\int_{\\sigma_{in}}^{\\sigma_{out}} I(\\sigma, \\nu) \\, \\sigma \\, d\\sigma $$\n分母中的光源面积积分就是 $\\int_{\\sigma_{in}}^{\\sigma_{out}} 2\\pi\\sigma \\, d\\sigma = \\pi(\\sigma_{out}^2 - \\sigma_{in}^2)$。\n对比度表达式变为：\n$$ C(\\sigma_{in}, \\sigma_{out}, \\nu) = \\frac{2 A_0 A_1 J(\\sigma_{in}, \\sigma_{out}, \\nu)}{\\pi A_0^2 (\\sigma_{out}^2 - \\sigma_{in}^2) + A_1^2 J(\\sigma_{in}, \\sigma_{out}, \\nu)} $$\n\n**2. 数值近似**\n\n为了找到最佳的 $(\\sigma_{in}, \\sigma_{out})$，我们必须对该对比度表达式进行数值计算。问题中指定了离散化的方法。\n-   角度积分 $I(\\sigma, \\nu)$ 通过对 $N_\\theta = 4096$ 个等间距角度 $\\theta_j = j \\frac{2\\pi}{N_\\theta}$ for $j=0, \\dots, N_\\theta-1$ 的求和来近似。\n$$ I(\\sigma, \\nu) \\approx \\frac{2\\pi}{N_\\theta} \\sum_{j=0}^{N_\\theta-1} [P_{+}(\\sigma, \\theta_j; \\nu) + P_{-}(\\sigma, \\theta_j; \\nu)] $$\n-   优化是在 $\\sigma_{in}$ 和 $\\sigma_{out}$ 的离散值上进行网格搜索。$\\sigma$ 的网格步长为 $\\Delta\\sigma = 0.01$。对于每个候选环带 $(\\sigma_{in}, \\sigma_{out})$，从这个网格计算径向积分 $J$。我们使用梯形法则进行此积分：\n$$ J(\\sigma_{in}, \\sigma_{out}, \\nu) \\approx \\int_{\\sigma_{in}}^{\\sigma_{out}} I(\\sigma, \\nu) \\sigma \\, d\\sigma $$\n数值计算将在落入 $[\\sigma_{in}, \\sigma_{out}]$ 区间内的离散 $\\sigma$ 点集上执行。\n\n**3. 优化算法**\n\n对于每个目标间距 $p$，我们执行以下步骤：\n1.  计算归一化频率 $\\nu$。如果 $\\nu > 2$，则不可能存在一阶衍射（因为我们需要 $|\\sigma \\cos\\theta \\pm \\nu| \\le 1$，这要求 $|\\pm \\nu| - |\\sigma \\cos\\theta| \\le 1 \\implies \\nu - \\sigma \\le 1 \\implies \\nu-1 \\le \\sigma \\le 1$，如果 $\\nu>2$ 则这是不可能的）。在这种情况下，对比度始终为零，我们返回 $(-1.0, -1.0)$。\n2.  定义从 $\\sigma=0.20$ 到 $\\sigma=1.00$，步长为 $\\Delta\\sigma=0.01$ 的离散 $\\sigma$ 网格。\n3.  使用离散角度求和，为网格上的每个 $\\sigma$ 预先计算 $I(\\sigma, \\nu)$ 的值。\n4.  将 `best_contrast` 初始化为负值，`best_params` 初始化为默认值。\n5.  遍历 $\\sigma$ 网格中所有有效的候选环带 $(\\sigma_{in}, \\sigma_{out})$，并满足以下约束：\n    - $\\sigma_{in} \\ge 0.20$\n    - $\\sigma_{in}  \\sigma_{out}$\n    - $\\sigma_{out} - \\sigma_{in} \\ge 0.05$\n6.  对于每个候选环带：\n    a. 通过对预先计算的 $I(\\sigma, \\nu)\\sigma$ 值进行数值积分（梯形法则）来计算 $J(\\sigma_{in}, \\sigma_{out}, \\nu)$。\n    b. 使用第1部分推导的公式计算对比度 $C$。\n    c. 将计算出的对比度与当前最大值进行比较。如果更高，则更新 `best_contrast` 和 `best_params`。比较和更新过程必须严格遵守指定的决胜规则：\n        i.  最高对比度获胜（在 $10^{-12}$ 的容差范围内）。\n        ii. 如果打平，则最小厚度 $(\\sigma_{out} - \\sigma_{in})$ 获胜。\n        iii. 如果仍然打平，则最小的 $\\sigma_{out}$ 获胜。\n        iv. 如果仍然打平，则最小的 $\\sigma_{in}$ 获胜（这由循环顺序解决）。\n7.  检查完所有候选者后，如果整体 `best_contrast` 为零（或低于 $10^{-12}$ 的容差），则返回 $(-1.0, -1.0)$。否则，返回存储的 `best_params`。\n8.  收集所有间距的最终结果，并按要求格式化。\n这个计算过程在下面的 Python 脚本中实现。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    \"\"\"\n    # Define physical constants and test cases\n    lambda_ = 193.0  # Wavelength in nm\n    NA = 0.93        # Numerical Aperture\n    test_pitches = [220.0, 130.0, 105.0, 95.0]  # Pitches in nm\n\n    # Model parameters\n    A0 = 0.5\n    A1 = 1.0 / np.pi\n    \n    # Grid search and integration parameters\n    sigma_min_in = 0.20\n    sigma_max_out = 1.00\n    d_sigma = 0.01\n    min_thickness = 0.05\n    n_theta = 4096\n    \n    # Tolerance for floating point comparisons\n    tol = 1e-12\n\n    results = []\n    for p in test_pitches:\n        s_in, s_out = find_optimal_annulus(p, lambda_, NA, A0, A1,\n                                           sigma_min_in, sigma_max_out, d_sigma,\n                                           min_thickness, n_theta, tol)\n        results.append((s_in, s_out))\n    \n    # Format the output as specified\n    formatted_results = [f\"[{res[0]:.3f},{res[1]:.3f}]\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef find_optimal_annulus(p, lambda_, NA, A0, A1,\n                        sigma_min_in, sigma_max_out, d_sigma,\n                        min_thickness, n_theta, tol):\n    \"\"\"\n    Finds the optimal annular source parameters (sigma_in, sigma_out) for a given pitch.\n    \"\"\"\n    nu = lambda_ / (NA * p)\n    \n    # If nu > 2, no first-order diffraction is possible. Contrast is always 0.\n    if nu > 2.0:\n        return -1.0, -1.0\n\n    # Define the discrete grid for sigma\n    sigma_grid = np.round(np.arange(sigma_min_in, sigma_max_out + d_sigma/2, d_sigma), 2)\n    num_sigma_points = len(sigma_grid)\n    \n    # Pre-compute angular integral I(sigma, nu) for each sigma on the grid\n    theta = np.linspace(0, 2 * np.pi, n_theta, endpoint=False)\n    cos_theta = np.cos(theta)\n    \n    I_vals = np.zeros(num_sigma_points)\n    for i, sigma in enumerate(sigma_grid):\n        u = sigma * cos_theta\n        P_plus = np.abs(u + nu) = 1.0\n        P_minus = np.abs(u - nu) = 1.0\n        integrand_theta = P_plus + P_minus\n        # discrete integration over theta: sum * d_theta = mean * N_theta * (2*pi/N_theta)\n        I_vals[i] = np.mean(integrand_theta) * 2 * np.pi\n\n    # The integrand for the radial integral J is I(sigma, nu) * sigma\n    integrand_J = I_vals * sigma_grid\n\n    # Initialize variables for optimization\n    best_contrast = -1.0\n    best_params = (-1.0, -1.0)\n    best_thickness = float('inf')\n    best_s_out = float('inf')\n\n    min_thickness_idx_delta = int(round(min_thickness / d_sigma))\n\n    # Grid search over all valid annuli\n    for i in range(num_sigma_points):\n        s_in = sigma_grid[i]\n        # Ensure minimum thickness constraint is met\n        for j in range(i + min_thickness_idx_delta, num_sigma_points):\n            s_out = sigma_grid[j]\n            \n            # Extract sub-arrays for integration over the current annulus\n            sub_sigma_grid = sigma_grid[i:j+1]\n            sub_integrand_J = integrand_J[i:j+1]\n            \n            # The radial integral J, evaluated numerically using the trapezoidal rule.\n            J_val = np.trapz(sub_integrand_J, x=sub_sigma_grid)\n            \n            if abs(J_val)  1e-15:\n                current_contrast = 0.0\n            else:\n                num_term = 2 * A0 * A1 * J_val\n                den_term1 = np.pi * A0**2 * (s_out**2 - s_in**2)\n                den_term2 = A1**2 * J_val\n                current_contrast = num_term / (den_term1 + den_term2)\n\n            current_thickness = s_out - s_in\n\n            # Tie-breaking logic, applied with a numerical tolerance\n            if current_contrast > best_contrast + tol:\n                best_contrast = current_contrast\n                best_params = (s_in, s_out)\n                best_thickness = current_thickness\n                best_s_out = s_out\n            elif abs(current_contrast - best_contrast) = tol:\n                if current_thickness  best_thickness - tol:\n                    best_params = (s_in, s_out)\n                    best_thickness = current_thickness\n                    best_s_out = s_out\n                elif abs(current_thickness - best_thickness) = tol:\n                    if s_out  best_s_out - tol:\n                        best_params = (s_in, s_out)\n                        best_s_out = s_out\n                        # The final tie-breaker on s_in is implicitly handled\n                        # by the loop order, which tests smaller s_in first.\n\n    # Final check for the edge case where no configuration yields contrast\n    if best_contrast = tol:\n      return -1.0, -1.0\n    \n    return best_params\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}