{
    "hands_on_practices": [
        {
            "introduction": "霍普金斯公式的核心在于传输交叉系数 (Transmission Cross Coefficient, TCC)，它将光源和投影系统的特性编码成一个决定成像质量的内核。通过为特定光源和光瞳函数分析性地推导 TCC ，我们可以深入理解部分相干成像的本质。这个练习旨在通过从第一性原理出发，推导 TCC 并用它来计算周期性掩模的图像对比度，从而巩固对霍普金斯公式数学框架的掌握。",
            "id": "4130992",
            "problem": "考虑一个用于半导体光刻的一维、标量、部分相干成像系统，该系统在 Hopkins 框架下建模。照明光源在空间频率域的角度分布由高斯函数描述，投影光学系统在光瞳上呈现余弦振幅切趾。设光源的特征为\n$$S(\\sigma) = S_{0} \\exp\\!\\left(-\\frac{\\sigma^{2}}{2 \\sigma_{s}^{2}}\\right),$$\n其中 $\\sigma$ 是一维光源空间频率坐标，$S_{0}$ 是一个正常数，$\\sigma_{s} > 0$ 用于量化高斯分布的宽度。设光瞳振幅切趾由下式给出\n$$P(k) = \\cos\\!\\left(\\frac{\\pi}{2}\\,\\frac{k}{k_{c}}\\right)$$\n对于 $|k| \\leq k_{c}$，而其他情况下 $P(k) = 0$。其中 $k$ 是光瞳平面中的一维空间频率坐标，$k_{c} > 0$ 是由数值孔径和波长设定的光瞳截止空间频率。假设照明相对于光瞳光阑足够窄，特别是 $\\sigma_{s} \\ll k_{c}$，因此相关积分的主要贡献来自 $|\\sigma| \\ll k_{c}$，并且在计算 $S(\\sigma)$ 与 $k$ 的平滑函数的卷积时可以忽略有限的光瞳支撑区。\n\n从标量线性系统的第一性原理和 Hopkins 公式（图像强度是掩模谱的双线性函数，其核函数由光源角度分布和光瞳振幅决定）的基础出发，为在上述窄光源近似条件下指定的具有高斯光源和余弦切趾光瞳的系统，推导传输交叉系数 (Transmission Cross Coefficient, TCC) 的解析表达式。TCC 定义为将物谱映射到像强度谱的双线性核函数。\n\n然后，考虑一个周期性掩模，其复振幅透射率具有一维谱\n$$M(k) = M_{0}\\,\\big[\\delta(k - f_{0}) + \\delta(k + f_{0})\\big],$$\n其中 $M_{0} > 0$ 且基频空间频率 $f_{0} > 0$。使用推导出的 TCC，表示此掩模的图像强度的迈克尔逊对比度。该对比度定义为 $C = I_{2 f_{0}}/I_{0}$，其中 $I_{0}$ 是图像强度的平均（零频）分量，$I_{2 f_{0}}$ 是由于部分相干成像的双线性特性而出现在图像强度中的空间频率为 $2 f_{0}$ 的余弦调制振幅。提供一个关于 $\\sigma_{s}$、$k_{c}$ 和 $f_{0}$ 的 $C$ 的单一闭式解析表达式。\n\n不需要进行数值计算，也无需四舍五入。将最终答案表示为不带单位的单一闭式解析表达式。",
            "solution": "该问题要求推导一维部分相干成像系统的传输交叉系数 (TCC)，并随后用它来计算特定周期性掩模的图像对比度。\n\n### 步骤 1：传输交叉系数 (TCC) 的推导\n\nHopkins 公式将像平面中的强度 $I(x)$ 描述为掩模复振幅谱 $M(k)$ 的双线性变换。对于一维系统，其表达式为：\n$$I(x) = \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} M(k_1) M^*(k_2) \\text{TCC}(k_1, k_2) \\exp(i(k_1 - k_2)x) \\, dk_1 \\, dk_2$$\n该变换的核函数 $\\text{TCC}(k_1, k_2)$ 即为传输交叉系数。它由光源的角度分布 $S(\\sigma)$ 与光瞳函数 $P(k)$ 的卷积定义。对于一维系统，它是：\n$$\\text{TCC}(k_1, k_2) = \\int_{-\\infty}^{\\infty} S(\\sigma) P(\\sigma + k_1) P^*(\\sigma + k_2) \\, d\\sigma$$\n其中 $\\sigma$ 是光源的空间频率坐标，$k_1, k_2$ 是掩模谱的空间频率坐标。\n\n问题给出了以下已知条件：\n1.  光源分布：$S(\\sigma) = S_{0} \\exp\\left(-\\frac{\\sigma^{2}}{2 \\sigma_{s}^{2}}\\right)$，其中 $S_0$ 是一个正常数。\n2.  光瞳振幅函数：$P(k) = \\cos\\left(\\frac{\\pi k}{2 k_{c}}\\right)$，对于 $|k| \\leq k_{c}$，其他情况下 $P(k) = 0$。由于 $P(k)$ 是实数，其复共轭 $P^*(k)$ 等于 $P(k)$。\n3.  窄光源近似：$\\sigma_s \\ll k_c$。这意味着高斯光源 $S(\\sigma)$ 与光瞳的宽度相比非常窄。题目说明指出，这允许在积分中忽略有限的光瞳支撑区。这意味着我们可以在关于 $\\sigma$ 的整个积分域上使用 $P(k)$ 的余弦表达式，因为快速衰减的高斯函数 $S(\\sigma)$ 将使得来自 $|\\sigma+k_{1,2}| > k_c$ 区域的贡献可以忽略不计，前提是假设 $|k_{1,2}| \\le k_c$。\n\n将给定的 $S(\\sigma)$ 和 $P(k)$ 代入 TCC 的定义中：\n$$\\text{TCC}(k_1, k_2) = \\int_{-\\infty}^{\\infty} S_{0} \\exp\\left(-\\frac{\\sigma^{2}}{2 \\sigma_{s}^{2}}\\right) \\cos\\left(\\frac{\\pi (\\sigma + k_1)}{2 k_c}\\right) \\cos\\left(\\frac{\\pi (\\sigma + k_2)}{2 k_c}\\right) \\, d\\sigma$$\n我们使用三角函数积化和差恒等式 $\\cos(A)\\cos(B) = \\frac{1}{2}[\\cos(A+B) + \\cos(A-B)]$。\n令 $A = \\frac{\\pi (\\sigma + k_1)}{2 k_c}$ 且 $B = \\frac{\\pi (\\sigma + k_2)}{2 k_c}$。那么：\n$$A+B = \\frac{\\pi}{2 k_c} (2\\sigma + k_1 + k_2)$$\n$$A-B = \\frac{\\pi}{2 k_c} (k_1 - k_2)$$\nTCC 积分变为：\n$$\\text{TCC}(k_1, k_2) = \\frac{S_0}{2} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\sigma^{2}}{2 \\sigma_{s}^{2}}\\right) \\left[ \\cos\\left(\\frac{\\pi(k_1 - k_2)}{2 k_c}\\right) + \\cos\\left(\\frac{\\pi(2\\sigma + k_1 + k_2)}{2 k_c}\\right) \\right] \\, d\\sigma$$\n我们可以将其分解为两个积分：\n$$\\text{TCC}(k_1, k_2) = \\frac{S_0}{2} \\cos\\left(\\frac{\\pi(k_1 - k_2)}{2 k_c}\\right) \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\sigma^{2}}{2 \\sigma_{s}^{2}}\\right) d\\sigma + \\frac{S_0}{2} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\sigma^{2}}{2 \\sigma_{s}^{2}}\\right) \\cos\\left(\\frac{\\pi\\sigma}{k_c} + \\frac{\\pi(k_1 + k_2)}{2 k_c}\\right) d\\sigma$$\n第一个积分是标准的高斯积分：$\\int_{-\\infty}^{\\infty} \\exp(-ax^2)dx = \\sqrt{\\pi/a}$。此处，$a = 1/(2\\sigma_s^2)$，所以积分为 $\\sqrt{2\\pi\\sigma_s^2} = \\sqrt{2\\pi}\\sigma_s$。\n第二个积分包含一个余弦项，其参数依赖于 $\\sigma$。使用 $\\cos(X+Y) = \\cos(X)\\cos(Y) - \\sin(X)\\sin(Y)$：\n$$\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\sigma^{2}}{2 \\sigma_{s}^{2}}\\right) \\left[ \\cos\\left(\\frac{\\pi\\sigma}{k_c}\\right)\\cos\\left(\\frac{\\pi(k_1+k_2)}{2k_c}\\right) - \\sin\\left(\\frac{\\pi\\sigma}{k_c}\\right)\\sin\\left(\\frac{\\pi(k_1+k_2)}{2k_c}\\right) \\right] d\\sigma$$\n含有 $\\sin(\\pi\\sigma/k_c)$ 的项积分为零，因为它是一个奇函数乘以一个偶函数，并在对称区间 $(-\\infty, \\infty)$ 上积分。\n剩余的积分为：\n$$\\cos\\left(\\frac{\\pi(k_1+k_2)}{2k_c}\\right) \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\sigma^{2}}{2 \\sigma_{s}^{2}}\\right) \\cos\\left(\\frac{\\pi\\sigma}{k_c}\\right) d\\sigma$$\n这是一个高斯函数的标准傅里叶余弦变换。使用积分恒等式 $\\int_{-\\infty}^{\\infty} \\exp(-ax^2)\\cos(bx)dx = \\sqrt{\\pi/a} \\exp(-b^2/(4a))$，其中 $a=1/(2\\sigma_s^2)$ 且 $b=\\pi/k_c$：\n$$\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\sigma^{2}}{2 \\sigma_{s}^{2}}\\right) \\cos\\left(\\frac{\\pi\\sigma}{k_c}\\right) d\\sigma = \\sqrt{2\\pi\\sigma_s^2} \\exp\\left(-\\frac{(\\pi/k_c)^2}{4/(2\\sigma_s^2)}\\right) = \\sqrt{2\\pi}\\sigma_s \\exp\\left(-\\frac{\\pi^2 \\sigma_s^2}{2 k_c^2}\\right)$$\n结合 TCC 积分两部分的结果：\n$$\\text{TCC}(k_1, k_2) = \\frac{S_0\\sqrt{2\\pi}\\sigma_s}{2} \\left[ \\cos\\left(\\frac{\\pi(k_1-k_2)}{2k_c}\\right) + \\cos\\left(\\frac{\\pi(k_1+k_2)}{2k_c}\\right) \\exp\\left(-\\frac{\\pi^2 \\sigma_s^2}{2 k_c^2}\\right) \\right]$$\n这就是在给定条件下 TCC 的解析表达式。\n\n### 步骤 2：图像对比度的计算\n\n问题提供了一个频谱为 $M(k) = M_{0}\\big[\\delta(k - f_{0}) + \\delta(k + f_{0})\\big]$ 的周期性掩模。由于 $M(k)$ 是实数，所以 $M^*(k) = M(k)$。我们将其代入图像强度 $I(x)$ 的表达式中：\n$$I(x) = \\int \\int M_0^2 [\\delta(k_1-f_0) + \\delta(k_1+f_0)] [\\delta(k_2-f_0) + \\delta(k_2+f_0)] \\text{TCC}(k_1, k_2) \\exp(i(k_1-k_2)x) \\, dk_1 dk_2$$\n狄拉克 $\\delta$ 函数的筛选特性将二重积分简化为四项之和，对应于点对 $(k_1, k_2) \\in \\{(f_0, f_0), (-f_0, -f_0), (f_0, -f_0), (-f_0, f_0)\\}$。\n$$I(x) = M_0^2 \\left[ \\text{TCC}(f_0, f_0) + \\text{TCC}(-f_0, -f_0) + \\text{TCC}(f_0, -f_0)e^{i2f_0x} + \\text{TCC}(-f_0, f_0)e^{-i2f_0x} \\right]$$\n从推导出的 TCC 表达式可以看出，$\\text{TCC}(k_1, k_2)$ 是实数且对称的，即 $\\text{TCC}(k_1, k_2) = \\text{TCC}(k_2, k_1)$。此外，$\\text{TCC}(-k_1, -k_2) = \\text{TCC}(k_1, k_2)$。\n因此，$\\text{TCC}(-f_0, -f_0) = \\text{TCC}(f_0, f_0)$ 且 $\\text{TCC}(-f_0, f_0) = \\text{TCC}(f_0, -f_0)$。\n强度变为：\n$$I(x) = M_0^2 \\left[ 2\\text{TCC}(f_0, f_0) + \\text{TCC}(f_0, -f_0)(e^{i2f_0x} + e^{-i2f_0x}) \\right]$$\n$$I(x) = 2M_0^2 \\left[ \\text{TCC}(f_0, f_0) + \\text{TCC}(f_0, -f_0) \\cos(2f_0x) \\right]$$\n问题将迈克尔逊对比度定义为 $C = I_{2 f_{0}}/I_{0}$，其中 $I_0$ 是图像强度的平均（零频）分量，$I_{2 f_{0}}$ 是余弦调制振幅。从 $I(x)$ 的表达式中，我们可以确定：\n$$I_0 = 2M_0^2 \\, \\text{TCC}(f_0, f_0)$$\n$$I_{2f_0} = 2M_0^2 \\, \\text{TCC}(f_0, -f_0)$$\n对比度是该比率：\n$$C = \\frac{I_{2f_0}}{I_0} = \\frac{\\text{TCC}(f_0, -f_0)}{\\text{TCC}(f_0, f_0)}$$\n我们来计算必要的 TCC 项。为简化起见，令 $E = \\exp\\left(-\\frac{\\pi^2 \\sigma_s^2}{2 k_c^2}\\right)$。\n对于 $\\text{TCC}(f_0, f_0)$：$k_1=f_0, k_2=f_0$。$k_1-k_2 = 0$，$k_1+k_2=2f_0$。\n$$\\text{TCC}(f_0, f_0) = \\frac{S_0\\sqrt{2\\pi}\\sigma_s}{2} \\left[ \\cos(0) + \\cos\\left(\\frac{\\pi(2f_0)}{2k_c}\\right) E \\right] = \\frac{S_0\\sqrt{2\\pi}\\sigma_s}{2} \\left[ 1 + E \\cos\\left(\\frac{\\pi f_0}{k_c}\\right) \\right]$$\n对于 $\\text{TCC}(f_0, -f_0)$：$k_1=f_0, k_2=-f_0$。$k_1-k_2 = 2f_0$，$k_1+k_2=0$。\n$$\\text{TCC}(f_0, -f_0) = \\frac{S_0\\sqrt{2\\pi}\\sigma_s}{2} \\left[ \\cos\\left(\\frac{\\pi(2f_0)}{2k_c}\\right) + \\cos(0) E \\right] = \\frac{S_0\\sqrt{2\\pi}\\sigma_s}{2} \\left[ \\cos\\left(\\frac{\\pi f_0}{k_c}\\right) + E \\right]$$\n现在我们计算对比度 $C$ 的比率：\n$$C = \\frac{\\frac{S_0\\sqrt{2\\pi}\\sigma_s}{2} \\left[ \\cos\\left(\\frac{\\pi f_0}{k_c}\\right) + E \\right]}{\\frac{S_0\\sqrt{2\\pi}\\sigma_s}{2} \\left[ 1 + E \\cos\\left(\\frac{\\pi f_0}{k_c}\\right) \\right]} = \\frac{\\cos\\left(\\frac{\\pi f_0}{k_c}\\right) + E}{1 + E \\cos\\left(\\frac{\\pi f_0}{k_c}\\right)}$$\n将 $E$ 的表达式代回：\n$$C = \\frac{\\cos\\left(\\frac{\\pi f_0}{k_c}\\right) + \\exp\\left(-\\frac{\\pi^2 \\sigma_s^2}{2 k_c^2}\\right)}{1 + \\exp\\left(-\\frac{\\pi^2 \\sigma_s^2}{2 k_c^2}\\right) \\cos\\left(\\frac{\\pi f_0}{k_c}\\right)}$$\n这就是以 $\\sigma_s$、$k_c$ 和 $f_0$ 表示的迈克尔逊对比度 $C$ 的最终闭式解析表达式。",
            "answer": "$$\\boxed{\\frac{\\cos\\left(\\frac{\\pi f_{0}}{k_{c}}\\right) + \\exp\\left(-\\frac{\\pi^{2} \\sigma_{s}^{2}}{2 k_{c}^{2}}\\right)}{1 + \\exp\\left(-\\frac{\\pi^{2} \\sigma_{s}^{2}}{2 k_{c}^{2}}\\right) \\cos\\left(\\frac{\\pi f_{0}}{k_{c}}\\right)}}$$"
        },
        {
            "introduction": "理论模型的最终价值在于解决实际的工程问题。在光刻工艺中，一个关键挑战是“邻近效应”，即相同尺寸的图形会因其周围环境（密集或孤立）不同而呈现出不同的成像尺寸。这个问题展示了如何利用基于霍普金斯公式的成像预测来计算光学邻近效应修正 (Optical Proximity Correction, OPC) ，通过对掩模尺寸进行微调，确保不同环境下的图形都能精确地印刷到目标尺寸。",
            "id": "4130959",
            "problem": "一个半导体光刻工艺使用一个投影系统，其波长 $\\lambda = 193\\,\\mathrm{nm}$，数值孔径 $\\mathrm{NA} = 0.93$，以及常规部分相干因子 $\\sigma = 0.40$。该系统的缩放倍率为 $R = 4$。考虑在一维二元掩模上印刷线条到光刻胶中，该过程通过一个恒定阈值显影模型进行建模，其中晶圆上印刷出的边缘位置取决于空中像强度等于一个固定阈值 $I_{\\mathrm{th}}$ 的地方。目标晶圆关键尺寸为线宽 $w_{\\mathrm{t}} = 45\\,\\mathrm{nm}$。对于密集的 $1{:}1$ 线-空间情况，晶圆上的周期为 $P_{\\mathrm{w}} = 90\\,\\mathrm{nm}$；对于孤立情况，线条与其相邻图形充分分离，其成像可被视为孤立的。\n\n晶圆上的部分相干空中像强度 $I(x)$ 由 Hopkins 公式决定，该公式将强度表示为由传输交叉系数 (TCC) 给出的掩模透射率的双线性泛函：\n$$\nI(x) \\;=\\; \\iint TCC(f_{1}, f_{2})\\, M(f_{1})\\, M^{*}(f_{2})\\, \\exp\\!\\big(i 2\\pi (f_{1}-f_{2}) x\\big)\\, \\mathrm{d}f_{1}\\, \\mathrm{d}f_{2},\n$$\n其中 $M(f)$ 是掩模透射函数的傅里叶变换，$x$ 是晶圆平面坐标。光刻胶阈值为 $I_{\\mathrm{th}} = 0.300$ (归一化强度单位)。根据对称性，目标线条在晶圆上印刷的边缘位置为 $x_{\\mathrm{t}} = w_{\\mathrm{t}}/2$。\n\n假设对应于目标晶圆尺寸的标称掩模线宽为 $w_{\\mathrm{m},0} = R\\, w_{\\mathrm{t}} = 180\\,\\mathrm{nm}$。在该标称宽度附近，位于 $x_{\\mathrm{t}}$ 处的空中像强度对微小的掩模宽度扰动 $\\Delta w_{\\mathrm{m}}$ 近似呈线性响应，关系如下：\n$$\nI_{j}(x_{\\mathrm{t}}; w_{\\mathrm{m}}) \\;\\approx\\; I_{j,0} \\;+\\; S_{j}\\, (w_{\\mathrm{m}} - w_{\\mathrm{m},0}),\n$$\n其中 $j \\in \\{d, i\\}$ 分别表示密集和孤立情况；$I_{j,0} = I_{j}(x_{\\mathrm{t}}; w_{\\mathrm{m},0})$ 和 $S_{j} = \\left.\\frac{\\partial I_{j}(x_{\\mathrm{t}}; w_{\\mathrm{m}})}{\\partial w_{\\mathrm{m}}}\\right|_{w_{\\mathrm{m},0}}$ 是通过在 $x_{\\mathrm{t}}$ 处计算双线性形式及其关于 $w_{\\mathrm{m}}$ 的参数导数，从 Hopkins 公式中获得的量。对于给定的光学配置和二元掩模，保留最低衍射级的截断传输交叉系数展开在 $x_{\\mathrm{t}}$ 处得到以下值：\n- 密集情况：$I_{d,0} = 0.312$， $S_{d} = 1.80 \\times 10^{-3}\\,\\mathrm{nm}^{-1}$。\n- 孤立情况：$I_{i,0} = 0.284$， $S_{i} = 2.10 \\times 10^{-3}\\,\\mathrm{nm}^{-1}$。\n\n计算必须分别应用于密集和孤立掩模线条的掩模宽度偏置 $\\Delta w_{d}$ 和 $\\Delta w_{i}$（单位为 $\\mathrm{nm}$），使得在光刻胶阈值模型下，两者都能印刷出目标晶圆关键尺寸 $w_{\\mathrm{t}}$；即，对每种情况强制执行 $I_{j}(x_{\\mathrm{t}}; w_{\\mathrm{m},0} + \\Delta w_{j}) = I_{\\mathrm{th}}$。将 $(\\Delta w_{d}, \\Delta w_{i})$ 的最终数值答案以一个双元素行矩阵的形式给出，并将答案四舍五入到三位有效数字。所有掩模偏置均以 nm 为单位表示。",
            "solution": "该问题被验证为具有科学依据、适定、客观且自洽。它描述了计算光刻中的一个标准问题，特别是为密集和孤立特征计算光学邻近效应修正 (OPC) 偏置。所有必要的参数都已提供，并且其方法基于成熟的物理模型（Hopkins 公式）和常见的工程近似（线性灵敏度模型、恒定阈值光刻胶模型）。\n\n问题的核心是确定所需的掩模宽度偏置，即密集线条的 $\\Delta w_{d}$ 和孤立线条的 $\\Delta w_{i}$，使得两者都能印刷出目标晶圆关键尺寸 $w_{\\mathrm{t}} = 45\\,\\mathrm{nm}$。在所提供的恒定阈值光刻胶模型中，当位于目标线边缘（$x_{\\mathrm{t}} = w_{\\mathrm{t}}/2$）的空中像强度等于光刻胶阈值 $I_{\\mathrm{th}} = 0.300$ 时，此条件得到满足。\n\n问题提供了一个关于目标边缘处强度 $I_{j}(x_{\\mathrm{t}})$ 作为掩模宽度 $w_{\\mathrm{m}}$ 函数的线性模型。该模型是在标称掩模宽度 $w_{\\mathrm{m},0} = R\\, w_{\\mathrm{t}} = 4 \\times 45\\,\\mathrm{nm} = 180\\,\\mathrm{nm}$ 附近的一个近似。该线性模型由下式给出：\n$$\nI_{j}(x_{\\mathrm{t}}; w_{\\mathrm{m}}) \\approx I_{j,0} + S_{j} (w_{\\mathrm{m}} - w_{\\mathrm{m},0})\n$$\n其中 $j \\in \\{d, i\\}$ 分别对应密集和孤立情况。$I_{j,0}$ 是标称掩模宽度 $w_{\\mathrm{m},0}$ 时边缘处的强度，$S_{j}$ 是该强度对掩模宽度变化的灵敏度。\n\n我们需要找到偏置 $\\Delta w_{j}$，使得新的掩模宽度 $w_{\\mathrm{m}} = w_{\\mathrm{m},0} + \\Delta w_{j}$ 能导致目标边缘处的强度等于阈值强度。我们将 $w_{\\mathrm{m}} = w_{\\mathrm{m},0} + \\Delta w_{j}$ 代入线性模型，并令其结果等于 $I_{\\mathrm{th}}$：\n$$\nI_{\\mathrm{th}} = I_{j,0} + S_{j} \\big((w_{\\mathrm{m},0} + \\Delta w_{j}) - w_{\\mathrm{m},0}\\big)\n$$\n这可以简化为：\n$$\nI_{\\mathrm{th}} = I_{j,0} + S_{j} \\Delta w_{j}\n$$\n现在我们可以求解所需的掩模偏置 $\\Delta w_{j}$：\n$$\nS_{j} \\Delta w_{j} = I_{\\mathrm{th}} - I_{j,0}\n$$\n$$\n\\Delta w_{j} = \\frac{I_{\\mathrm{th}} - I_{j,0}}{S_{j}}\n$$\n这一个公式允许我们使用所提供的数值，计算密集和孤立两种情况的偏置。\n\n对于密集情况 ($j=d$)：\n给定值为 $I_{\\mathrm{th}} = 0.300$，$I_{d,0} = 0.312$，$S_{d} = 1.80 \\times 10^{-3}\\,\\mathrm{nm}^{-1}$。\n将这些值代入偏置公式中：\n$$\n\\Delta w_{d} = \\frac{0.300 - 0.312}{1.80 \\times 10^{-3}\\,\\mathrm{nm}^{-1}} = \\frac{-0.012}{1.80 \\times 10^{-3}}\\,\\mathrm{nm}\n$$\n$$\n\\Delta w_{d} = -\\frac{12 \\times 10^{-3}}{1.80 \\times 10^{-3}}\\,\\mathrm{nm} = -\\frac{12}{1.8}\\,\\mathrm{nm} = -\\frac{120}{18}\\,\\mathrm{nm} = -\\frac{20}{3}\\,\\mathrm{nm}\n$$\n数值上，这等于 $\\Delta w_{d} \\approx -6.666... \\,\\mathrm{nm}$。注意，负号表示掩模线条必须比标称宽度更窄。这是符合预期的，因为标称强度 $I_{d,0} = 0.312$ 高于阈值 $I_{\\mathrm{th}} = 0.300$，意味着如果没有修正，线条会印得太宽。较窄的掩模线会降低边缘处的强度。\n\n对于孤立情况 ($j=i$)：\n给定值为 $I_{\\mathrm{th}} = 0.300$，$I_{i,0} = 0.284$，$S_{i} = 2.10 \\times 10^{-3}\\,\\mathrm{nm}^{-1}$。\n将这些值代入偏置公式中：\n$$\n\\Delta w_{i} = \\frac{0.300 - 0.284}{2.10 \\times 10^{-3}\\,\\mathrm{nm}^{-1}} = \\frac{0.016}{2.10 \\times 10^{-3}}\\,\\mathrm{nm}\n$$\n$$\n\\Delta w_{i} = \\frac{16 \\times 10^{-3}}{2.10 \\times 10^{-3}}\\,\\mathrm{nm} = \\frac{16}{2.1}\\,\\mathrm{nm} = \\frac{160}{21}\\,\\mathrm{nm}\n$$\n数值上，这等于 $\\Delta w_{i} \\approx 7.619047... \\,\\mathrm{nm}$。正号表示掩模线条必须比标称宽度更宽。这同样是符合预期的，因为标称强度 $I_{i,0} = 0.284$ 低于阈值 $I_{\\mathrm{th}} = 0.300$，意味着线条会印得太窄。较宽的掩模线会增加边缘处的强度。\n\n问题要求将 $(\\Delta w_{d}, \\Delta w_{i})$ 的最终数值答案四舍五入到三位有效数字。\n- 对于密集情况：$\\Delta w_{d} \\approx -6.666... \\,\\mathrm{nm}$ 四舍五入为 $-6.67\\,\\mathrm{nm}$。\n- 对于孤立情况：$\\Delta w_{i} \\approx 7.619047... \\,\\mathrm{nm}$ 四舍五入为 $7.62\\,\\mathrm{nm}$。\n\n因此，所需的掩模偏置为 $\\Delta w_{d} = -6.67\\,\\mathrm{nm}$ 和 $\\Delta w_{i} = 7.62\\,\\mathrm{nm}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -6.67  7.62 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "除了线宽控制，二维图形保真度也是光刻工艺的重中之重。一个典型的二维效应是“线端缩短” (Line-End Shortening, LES)，即掩模上线条的末端在晶圆上成像时会向内回缩。本练习是一个综合性的仿真任务，要求你利用与霍普金斯方法等效的阿贝成像法，从零开始构建一个二维部分相干成像模型，以定量地仿真和分析线端缩短现象 。通过这个实践，你将掌握预测复杂光刻现象并评估相干因子和离焦等关键参数影响的实用技能。",
            "id": "4130977",
            "problem": "在半导体制造中，一个部分相干投影成像系统使用 Hopkins 公式进行建模，该公式将像强度表示为掩模透射频谱和系统传输交叉系数 (TCC) 的双线性泛函。等效地，Abbe 成像方法通过对相干像在光源角分布上进行积分来计算部分相干光学像。考虑一个标量衍射模型，其具有数值孔径为 $\\,\\mathrm{NA}\\,$ 的圆形光瞳和一个由部分相干因子 $\\,\\sigma\\,$ 表征的均匀圆形光源，$\\,\\sigma\\,$ 定义为光源数值孔径与投影系统数值孔径 $\\,\\mathrm{NA}\\,$ 的比值。离焦以二次相位的形式引入光瞳，该相位由一个在光瞳边缘处以波长为单位的无量纲离焦参数进行参数化。\n\n您必须实现晶圆平面上孤立线的二维仿真，并量化线端缩短。线端缩短定义为：沿着线轴，指定的光学像强度等高线相对于掩模线端的后退距离。您的程序必须计算在几种 $(\\sigma,\\delta)$ 条件下的后退距离，其中 $\\,\\sigma\\,$ 是部分相干因子，$\\,\\delta\\,$ 是无量纲离焦参数（在光瞳边缘处以波长为单位）。最终输出必须为单行文本，其中包含所有测试用例的后退距离，格式为方括号括起来的逗号分隔列表，每个后退距离以浮点数形式表示，单位为 $\\,\\mathrm{nm}\\,$。\n\n基本原理和假设：\n- 使用标量傅里叶光学和 Huygens–Fresnel 原理来模拟相干成像。像平面中的相干场是掩模频谱与相干传递函数乘积的逆傅里叶变换。\n- 相干传递函数由空间频率中的光瞳函数确定。圆形光瞳会施加一个截止空间频率。\n- 部分相干成像（Hopkins 公式）可以通过对相干像场强度的平方在光源分布上进行积分来实现。\n- 光瞳离焦由二次相位 $\\,\\exp\\!\\big(i\\pi \\delta \\rho^2\\big)\\,$ 建模，其中 $\\,\\rho\\,$ 是光瞳内的归一化径向坐标（$\\,\\rho\\in[0,1]\\,$），$\\,\\delta\\,$ 是在光瞳边缘处的离焦（以波长为单位）。\n\n几何和光学参数：\n- 波长：$\\,\\lambda = 193\\,\\mathrm{nm}\\,$。\n- 数值孔径：$\\,\\mathrm{NA} = 0.93\\,$。\n- 晶圆平面空间采样：方形网格，像素尺寸 $\\,\\Delta x = \\Delta y = 2\\,\\mathrm{nm}\\,$，网格大小 $\\,N_x = N_y = 256\\,$ 个样本。\n- 掩模图形：一条宽度为 $\\,W = 40\\,\\mathrm{nm}\\,$ 的孤立线，沿 $\\,y\\,$ 轴方向，从 $\\,y = 0\\,$ 延伸到 $\\,y = L\\,$，其中 $\\,L = 200\\,\\mathrm{nm}\\,$。该线以 $\\,x=0\\,$ 为中心。\n- 用于确定等高线的光学像阈值设置为内部峰值强度的一部分：$\\,\\alpha = 0.3\\,$。具体来说，将线内的一个参考内部区域定义为 $\\,|x| \\le W/4\\,$ 和 $\\,0.7L \\le y \\le 0.9L\\,$，并设阈值 $\\,T = \\alpha \\, I_\\text{ref}\\,$，其中 $\\,I_\\text{ref}\\,$ 是参考内部区域的平均像强度。\n\n傅里叶域定义：\n- 设空间频率坐标为 $\\,k_x\\,$ 和 $\\,k_y\\,$，单位为周期/$\\,\\mathrm{nm}\\,$，由离散傅里叶变换网格计算得出。圆形光瞳施加了一个截止空间频率\n$$\nk_c = \\frac{\\mathrm{NA}}{\\lambda}\\,,\n$$\n并且均匀圆形光源填充了频率空间中半径为 $\\,\\sigma k_c\\,$ 的圆盘。\n- 对于由频移矢量 $\\,\\mathbf{s} = (s_x,s_y)\\,$（其中 $\\,\\|\\mathbf{s}\\|\\le \\sigma k_c\\,$）表示的每个光源点，相干传递函数（光瞳）由下式给出\n$$\nP_{\\mathbf{s}}(k_x,k_y) = \\Pi\\!\\left(\\frac{\\sqrt{(k_x - s_x)^2 + (k_y - s_y)^2}}{k_c}\\right) \\, \\exp\\!\\left(i\\pi \\delta \\left(\\frac{\\sqrt{(k_x - s_x)^2 + (k_y - s_y)^2}}{k_c}\\right)^2\\right),\n$$\n其中 $\\,\\Pi(r)\\,$ 当 $\\,r \\le 1\\,$ 时为 $\\,1\\,$，否则为 $\\,0\\,$。\n- 光源点 $\\,\\mathbf{s}\\,$ 的相干像场是通过对掩模频谱和 $\\,P_{\\mathbf{s}}\\,$ 的乘积进行逆傅里叶变换得到的。部分相干光学像强度是 $\\,|E_{\\mathbf{s}}(x,y)|^2\\,$ 在均匀圆盘内所有光源点上的加权和（积分）。\n\n线端缩短测量：\n- 沿着中心线 $\\,x=0\\,$，找到满足 $\\,I(0,y)\\ge T\\,$ 的最小 $\\,y \\ge 0\\,$。使用样本之间的线性插值来精确确定交越位置。后退距离定义为这个 $\\,y\\,$ 值，单位为 $\\,\\mathrm{nm}\\,$。\n- 边界情况：\n    - 如果 $\\,I(0,0)\\ge T\\,$，则后退距离为 $\\,0\\,$。\n    - 如果对于所有 $\\,0 \\le y \\le L\\,$ 都有 $\\,I(0,y)  T\\,$，则将后退距离设为 $\\,L\\,$。\n\n您的程序必须实现上述模型，并为以下 $(\\sigma,\\delta)$ 对的测试套件生成结果：\n1. $(\\sigma, \\delta) = (0.3, 0)$\n2. $(\\sigma, \\delta) = (0.7, 0)$\n3. $(\\sigma, \\delta) = (1.0, 0)$\n4. $(\\sigma, \\delta) = (0.7, 0.5)$\n5. $(\\sigma, \\delta) = (0.7, -0.5)$\n6. $(\\sigma, \\delta) = (0.3, 1.0)$\n\n角度单位不出现在最终输出中。所有物理距离必须以 $\\,\\mathrm{nm}\\,$ 表示。最终输出格式必须是包含六个后退距离的单行文本，顺序与测试套件相同，以 Python 列表形式呈现，例如 `\"[d1,d2,d3,d4,d5,d6]\"`，其中每个后退距离为浮点数，单位为 $\\,\\mathrm{nm}\\,$。",
            "solution": "用户在光学光刻仿真领域提供了一个有效且定义明确的问题。该问题基于标量衍射理论，科学依据充分，并指定了获得唯一数值解所需的所有参数和步骤。因此，我将着手提供一个完整的解决方案。\n\n此问题的核心是仿真特定掩模图形的部分相干光学像的形成过程，并量化一个关键工艺指标，即线端缩短 (LES)。仿真将使用 Abbe 方法进行，该方法将部分相干光源建模为一组离散的、相互非相干的点光源。总像强度是每个点光源独立作用所产生强度的总和。\n\n### 1. 模型构建\n\n**空间域和频率域**\n仿真在二维笛卡尔网格上执行。对应于晶圆平面的空间域由一个大小为 $N_x \\times N_y$、像素尺寸为 $\\Delta x \\times \\Delta y$ 的网格定义。给定的参数是 $N_x = N_y = 256$ 和 $\\Delta x = \\Delta y = 2\\,\\mathrm{nm}$。这建立了一个物理仿真区域（视场），尺寸为 $L_x = N_x \\Delta x = 512\\,\\mathrm{nm}$ 乘 $L_y = N_y \\Delta y = 512\\,\\mathrm{nm}$。空间坐标 $(x,y)$ 以 $(0,0)$ 为中心。\n\n相应的频率域通过离散傅里叶变换 (DFT) 进行访问。频率坐标 $(k_x, k_y)$ 以周期/纳米为单位给出。频率采样间隔由空间视场决定：$\\Delta k_x = 1/L_x$ 和 $\\Delta k_y = 1/L_y$。这建立了一个频率网格，其坐标可以方便地使用 `fftfreq` 例程生成，并以 $(0,0)$ 为中心进行分析。\n\n**掩模图形和频谱**\n成像的对象是一个带有单条透明线的简单不透明掩模。掩模透射函数 $M(x,y)$ 定义为：\n$$\nM(x,y) =\n\\begin{cases}\n1  \\text{if } |x| \\le W/2 \\text{ and } 0 \\le y \\le L \\\\\n0  \\text{otherwise}\n\\end{cases}\n$$\n其中线宽为 $W = 40\\,\\mathrm{nm}$，长度为 $L = 200\\,\\mathrm{nm}$。光学系统的输入是此掩模的傅里叶变换，称为掩模频谱，$\\mathcal{M}(k_x, k_y) = \\mathcal{F}\\{M(x,y)\\}$，它通过快速傅里叶变换 (FFT) 进行数值计算。\n\n**用于部分相干成像的 Abbe 方法**\n部分相干光源，一个均匀的圆形圆盘，通过将其离散化为一组 $N_s$ 个独立的点光源来建模，每个点光源位于频率域中的特定位置 $\\mathbf{s}_j = (s_{x,j}, s_{y,j})$。这些矢量的大小受限于 $\\|\\mathbf{s}_j\\| \\le \\sigma k_c$，其中 $\\sigma$ 是部分相干因子，而 $k_c = \\mathrm{NA}/\\lambda$ 是投影系统的截止频率。\n\n根据 Abbe 原理，像平面中的总强度 $I(x,y)$ 是由每个点光源产生的强度的非相干叠加：\n$$\nI(x,y) = \\frac{1}{N_s} \\sum_{j=1}^{N_s} |E_{\\mathbf{s}_j}(x,y)|^2\n$$\n其中 $E_{\\mathbf{s}_j}(x,y)$ 是由第 $j$ 个光源点产生的复值相干像场。对于均匀光源，除以 $N_s$ 进行归一化是合适的。\n\n**相干像的形成**\n对于每个光源点 $\\mathbf{s}$，相干像是通过用相干传递函数 (CTF)（也称为光瞳函数 $P_{\\mathbf{s}}(k_x, k_y)$）对掩模频谱进行滤波而形成的。位于 $\\mathbf{s}$ 的光源点的光瞳函数是一个带有离焦相位像差的位移圆形孔径。其表达式为：\n$$\nP_{\\mathbf{s}}(k_x, k_y) = \\Pi\\left(\\frac{\\|\\mathbf{k}-\\mathbf{s}\\|}{k_c}\\right) \\exp\\left(i\\pi \\delta \\left(\\frac{\\|\\mathbf{k}-\\mathbf{s}\\|}{k_c}\\right)^2\\right)\n$$\n这里，$\\mathbf{k} = (k_x, k_y)$ 是频率矢量，$k_c=\\mathrm{NA}/\\lambda$ 是光瞳截止频率，$\\Pi(r)$ 是圆函数，当 $r \\le 1$ 时为 $1$，否则为 $0$。参数 $\\delta$ 表示以波长为单位在光瞳边缘处的离焦。项 $\\|\\mathbf{k} - \\mathbf{s}\\|$ 表明光瞳在频率平面中以光源点的位置 $\\mathbf{s}$ 为中心。\n\n相干像场的频谱是掩模频谱和 CTF 的乘积：\n$$\n\\mathcal{E}_{\\mathbf{s}}(k_x, k_y) = \\mathcal{M}(k_x,k_y) \\cdot P_{\\mathbf{s}}(k_x,k_y)\n$$\n然后通过应用逆傅里叶变换得到相干场本身：\n$$\nE_{\\mathbf{s}}(x,y) = \\mathcal{F}^{-1}\\{\\mathcal{E}_{\\mathbf{s}}(k_x,k_y)\\}\n$$\n对所有光源点重复此过程，并将所得强度相加，得到最终的部分相干光学像 $I(x,y)$。\n\n### 2. 线端缩短测量\n\n计算出光学像 $I(x,y)$ 后，下一步是测量线端缩短。\n\n**强度阈值**\n测量基于阈值水平 $T$ 处的强度等高线。该阈值是相对于远离端点的线特征内部的峰值强度来定义的。一个参考区域被定义为 $|x| \\le W/4 = 10\\,\\mathrm{nm}$ 和 $0.7L \\le y \\le 0.9L$（即 $140\\,\\mathrm{nm} \\le y \\le 180\\,\\mathrm{nm}$）。参考强度 $I_\\text{ref}$ 是该区域内的平均强度。然后阈值计算如下：\n$$\nT = \\alpha \\cdot I_\\text{ref}\n$$\n其中给定的比例 $\\alpha = 0.3$。\n\n**等高线位置和后退距离**\n线端缩短是通过找到 $y=0$ 处的线端像实际形成的位置来确定的。这是通过分析沿线中心轴 $I(0,y)$ 的强度剖面来完成的。我们搜索强度 $I(0,y)$ 超过阈值 $T$ 的最小 $y \\ge 0$ 值。\n\n设沿中心线的离散强度剖面为 $I_c(y_j)$。算法搜索第一个对应于 $y_j \\ge 0$ 且满足 $I_c(y_j) \\ge T$ 的索引 $j$。如果在第一个点 ($y=0$) 就满足此条件，则后退距离为 $0$。如果在掩模长度内（$0 \\le y \\le L$）没有找到这样的点，则后退距离设为 $L$。否则，在两个相邻的网格点 $(y_{j-1}, I_c(y_{j-1}))$ 和 $(y_j, I_c(y_j))$ 之间找到了一个交越点。交越的精确位置 $y_\\text{retreat}$ 通过线性插值找到：\n$$\ny_{\\text{retreat}} = y_{j-1} + (y_j - y_{j-1}) \\frac{T - I_c(y_{j-1})}{I_c(y_j) - I_c(y_{j-1})}\n$$\n这个值 $y_\\text{retreat}$ 就是线端缩短，表示 $T$ 水平的等高线从标称掩模边缘 $y=0$ 处回缩的距离。\n\n对测试套件中指定的每个 $(\\sigma, \\delta)$ 对执行整个过程，以生成最终的结果列表。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import fft\n\ndef solve():\n    \"\"\"\n    Simulates partially coherent imaging of a line feature to calculate line-end shortening\n    for various optical conditions.\n    \"\"\"\n    # === Problem Parameters ===\n    # Optical parameters\n    LAMBDA = 193.0  # Wavelength in nm\n    NA = 0.93  # Numerical aperture\n\n    # Spatial grid parameters\n    N = 256  # Grid size (Nx = Ny = N)\n    DX = 2.0  # Pixel size in nm (dx = dy = DX)\n    \n    # Mask parameters\n    W = 40.0  # Line width in nm\n    L = 200.0  # Line length in nm\n\n    # Measurement parameters\n    ALPHA = 0.3  # Threshold fraction\n\n    # Test suite of (sigma, delta) pairs\n    test_cases = [\n        (0.3, 0.0),\n        (0.7, 0.0),\n        (1.0, 0.0),\n        (0.7, 0.5),\n        (0.7, -0.5),\n        (0.3, 1.0),\n    ]\n\n    # === Pre-calculations ===\n    # Spatial coordinates (centered)\n    x = np.arange(-N / 2, N / 2) * DX\n    y = np.arange(-N / 2, N / 2) * DX\n    X, Y = np.meshgrid(x, y)\n\n    # Frequency coordinates (centered)\n    kx = fft.fftshift(fft.fftfreq(N, DX))\n    ky = fft.fftshift(fft.fftfreq(N, DX))\n    KX, KY = np.meshgrid(kx, ky)\n    \n    # Pupil cutoff frequency\n    k_c = NA / LAMBDA\n\n    # Create mask pattern\n    mask = np.zeros((N, N), dtype=np.float64)\n    mask[(np.abs(X) = W / 2)  (Y >= 0)  (Y = L)] = 1.0\n\n    # Mask spectrum (pre-calculate)\n    # The ifftshift prepares the spatially centered mask for FFT.\n    # The fftshift centers the resulting spectrum.\n    mask_spectrum = fft.fftshift(fft.fft2(fft.ifftshift(mask)))\n\n    results = []\n\n    # === Main Loop for each test case ===\n    for sigma, delta in test_cases:\n        # --- Source Discretization ---\n        # Find all source points on the frequency grid within the source disk\n        k_source_radius = sigma * k_c\n        source_points_dist_sq = KX**2 + KY**2\n        source_mask = source_points_dist_sq = k_source_radius**2\n        source_coords = np.argwhere(source_mask)\n        source_k_coords = [(kx[c], ky[r]) for r, c in source_coords]\n        \n        num_source_points = len(source_k_coords)\n        if num_source_points == 0:\n            # Handle case for sigma=0 or very small sigma\n            # Add a single on-axis point for coherent imaging\n            source_k_coords = [(0.0, 0.0)]\n            num_source_points = 1\n\n        total_intensity = np.zeros((N, N), dtype=np.float64)\n\n        # --- Abbe's Method: Sum of Coherent Images ---\n        for sx, sy in source_k_coords:\n            # Define coherent transfer function (pupil) for this source point\n            kx_shifted = KX - sx\n            ky_shifted = KY - sy\n            \n            # Normalized radial coordinate in pupil\n            rho_sq = (kx_shifted**2 + ky_shifted**2) / (k_c**2)\n            \n            pupil = np.zeros((N, N), dtype=np.complex128)\n            pupil_mask = rho_sq = 1.0\n            \n            if delta != 0:\n                pupil[pupil_mask] = np.exp(1j * np.pi * delta * rho_sq[pupil_mask])\n            else:\n                pupil[pupil_mask] = 1.0\n\n            # Coherent image formation\n            image_spectrum = mask_spectrum * pupil\n            \n            # Inverse FFT to get coherent field.\n            # ifftshift prepares centered spectrum for IFFT.\n            # fftshift centers the resulting spatial field.\n            coherent_field = fft.fftshift(fft.ifft2(fft.ifftshift(image_spectrum)))\n            \n            total_intensity += np.abs(coherent_field)**2\n\n        # Normalize by number of source points\n        if num_source_points > 0:\n            total_intensity /= num_source_points\n\n        # --- Line-End Shortening Measurement ---\n        # Calculate intensity threshold T\n        ref_region_mask = (np.abs(X) = W / 4)  (Y >= 0.7 * L)  (Y = 0.9 * L)\n        iref = np.mean(total_intensity[ref_region_mask])\n        threshold = ALPHA * iref\n\n        # Extract centerline intensity profile\n        centerline_idx = N // 2\n        centerline_intensity = total_intensity[:, centerline_idx]\n        \n        # Find retreat distance\n        retreat_dist = L # Default to L if no crossing is found\n        y_start_idx = N // 2 # Index for y=0\n\n        # Check edge case at y=0\n        if centerline_intensity[y_start_idx] >= threshold:\n            retreat_dist = 0.0\n        else:\n            # Search for crossing for y > 0\n            for j in range(y_start_idx + 1, N):\n                if y[j] > L: # Stop search beyond the mask length\n                    break\n                if centerline_intensity[j] >= threshold:\n                    # Found crossing between j-1 and j. Interpolate.\n                    y_prev = y[j-1]\n                    y_curr = y[j]\n                    I_prev = centerline_intensity[j-1]\n                    I_curr = centerline_intensity[j]\n                    \n                    retreat_dist = y_prev + (y_curr - y_prev) * (threshold - I_prev) / (I_curr - I_prev)\n                    break\n        \n        results.append(retreat_dist)\n        \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}