{
    "hands_on_practices": [
        {
            "introduction": "The Preston equation provides a powerful yet simple empirical model for material removal. Before we apply it to complex data, it is essential to understand the physical nature of its components. This first exercise uses the foundational technique of dimensional analysis to deconstruct the Preston coefficient, $K$. By determining its base SI dimensions, we move beyond treating $K$ as a simple fitting constant and begin to appreciate its connection to fundamental physical quantities .",
            "id": "4156562",
            "problem": "In Chemical Mechanical Planarization (CMP), an empirical linear relation is widely used to model the thickness removal rate as a function of applied normal load per unit area and relative sliding speed. Let the thickness removal rate be denoted by $R$, the applied mean normal pressure by $P$, and the relative sliding velocity by $V$. Suppose the model takes the form $R$ proportional to $P$ and $V$ with a proportionality factor $K$ characteristic of the process and materials.\n\nUsing first principles of dimensional analysis, start from the core definitions of pressure as force per unit area, force as mass times acceleration, velocity as length per unit time, and removal rate as thickness per unit time. The quantities are reported in the following engineering units:\n- $R$ in $\\mathrm{nm/min}$,\n- $P$ in $\\mathrm{kPa}$,\n- $V$ in $\\mathrm{m/s}$.\n\nDerive the International System of Units (SI) base dimension exponents for the proportionality factor $K$ defined by the relation $R = K\\,P\\,V$. Express your result as the ordered triple $(a,b,c)$ such that the SI base dimension of $K$ is $M^{a} L^{b} T^{c}$, where $M$ denotes mass, $L$ denotes length, and $T$ denotes time. Your final answer must be only this ordered triple. No rounding is required.",
            "solution": "The problem is scientifically sound and well-posed. It applies the fundamental technique of dimensional analysis to Preston's equation, a cornerstone model in chemical mechanical planarization. The problem is valid, and a solution will be derived.\n\nThe analysis begins with the provided relationship:\n$$R = KPV$$\nTo determine the dimensions of the proportionality factor $K$, we first rearrange the equation to isolate $K$:\n$$K = \\frac{R}{P V}$$\nThe dimension of $K$, denoted as $[K]$, can be found by substituting the dimensions of $R$, $P$, and $V$:\n$$[K] = \\frac{[R]}{[P] [V]}$$\nWe now determine the SI base dimensions ($M$ for mass, $L$ for length, $T$ for time) for each of the quantities $R$, $P$, and $V$.\n\n1.  **Dimension of Removal Rate ($R$)**:\n    The removal rate is defined as thickness (a length) per unit time.\n    $$[R] = \\frac{[\\text{Length}]}{[\\text{Time}]} = \\frac{L}{T} = L T^{-1}$$\n    The unit $\\mathrm{nm/min}$ is dimensionally consistent with length per time.\n\n2.  **Dimension of Pressure ($P$)**:\n    Pressure is defined as force per unit area.\n    $$[P] = \\frac{[\\text{Force}]}{[\\text{Area}]}$$\n    Force is defined as mass times acceleration.\n    $$[\\text{Force}] = [\\text{Mass}] \\cdot [\\text{Acceleration}]$$\n    Acceleration is velocity (length per time) per unit time.\n    $$[\\text{Acceleration}] = \\frac{[\\text{Length}]}{[\\text{Time}]^2} = \\frac{L}{T^2} = L T^{-2}$$\n    Therefore, the dimension of force is:\n    $$[\\text{Force}] = M \\cdot L T^{-2} = M L T^{-2}$$\n    Area is length squared:\n    $$[\\text{Area}] = L^2$$\n    Substituting these into the expression for the dimension of pressure:\n    $$[P] = \\frac{M L T^{-2}}{L^2} = M L^{-1} T^{-2}$$\n    The unit $\\mathrm{kPa}$ (kilopascal) is consistent, as a Pascal is a Newton per square meter ($\\mathrm{N/m^2}$), and a Newton is $\\mathrm{kg \\cdot m/s^2}$.\n\n3.  **Dimension of Velocity ($V$)**:\n    Velocity is defined as length per unit time.\n    $$[V] = \\frac{[\\text{Length}]}{[\\text{Time}]} = \\frac{L}{T} = L T^{-1}$$\n    The unit $\\mathrm{m/s}$ is the SI unit for velocity and is dimensionally consistent.\n\nNow, we substitute these dimensions back into the equation for $[K]$:\n$$[K] = \\frac{[R]}{[P] [V]} = \\frac{L T^{-1}}{(M L^{-1} T^{-2}) (L T^{-1})}$$\nFirst, we simplify the denominator by combining terms with the same base dimension:\n$$[P] [V] = (M L^{-1} T^{-2}) (L T^{-1}) = M \\cdot L^{-1+1} \\cdot T^{-2-1} = M L^{0} T^{-3} = M T^{-3}$$\nNow, substitute this simplified denominator back into the expression for $[K]$:\n$$[K] = \\frac{L T^{-1}}{M T^{-3}}$$\nFinally, we combine the terms to get the final dimensions for $K$:\n$$[K] = M^{-1} L^{1} T^{2}$$\nThe problem asks for the result to be expressed as an ordered triple $(a, b, c)$ corresponding to the exponents in the dimensional form $M^{a} L^{b} T^{c}$. By comparing $M^{-1} L^{1} T^{2}$ with the general form, we identify the exponents:\n$$a = -1$$\n$$b = 1$$\n$$c = 2$$\nThe resulting ordered triple is $(-1, 1, 2)$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-1 & 1 & 2\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Moving from theory to practice means confronting the reality of measurement uncertainty. In any experiment, our measurements of pressure, velocity, and removal rate will have some degree of error. This practice guides you through the crucial process of uncertainty propagation, allowing you to quantify how these input uncertainties combine to affect the final calculated value of the Preston coefficient $K$. This analysis is fundamental for assessing the reliability of experimental results and for identifying which measurements most critically limit the precision of your model .",
            "id": "4156545",
            "problem": "In a Chemical Mechanical Planarization (CMP) experiment for semiconductor manufacturing process modeling, the material removal rate is modeled by Preston’s relation, where the removal rate $R$ scales with the downforce pressure $P$ and the relative sliding speed $V$ through a proportionality coefficient (the Preston coefficient) $K$. The measurements yield the following mean values and standard uncertainties (one standard deviation), all assumed statistically independent:\n\n- Pressure: $P = 30.0\\ \\mathrm{kPa}$ with standard uncertainty $u_{P} = 0.50\\ \\mathrm{kPa}$.\n- Relative speed: $V = 0.600\\ \\mathrm{m/s}$ with standard uncertainty $u_{V} = 0.030\\ \\mathrm{m/s}$.\n- Removal rate: $R = 180\\ \\mathrm{nm/min}$ with standard uncertainty $u_{R} = 10\\ \\mathrm{nm/min}$.\n\nUse linear (first-order) uncertainty propagation under the assumptions of small, independent uncertainties to quantify how uncertainties in $P$, $V$, and $R$ propagate into the estimated $K$. Specifically:\n\n1. Derive, from first principles and definitions, the analytic expression for the absolute standard uncertainty $u_{K}$ in terms of $K$, $P$, $V$, $R$, and the standard uncertainties $u_{P}$, $u_{V}$, $u_{R}$.\n2. Evaluate $K$ and $u_{K}$ numerically using the provided data, converting all quantities into coherent International System (SI) units.\n3. Based on the structure of the propagated variance, identify which input uncertainty dominates the contribution to $u_{K}$ and explain why.\n\nExpress the final numeric value for the absolute standard uncertainty in $K$ in units of $\\mathrm{m}^{2}\\,\\mathrm{N}^{-1}$, and round your answer to three significant figures. The final answer must be a single number.",
            "solution": "The problem statement is evaluated to be scientifically grounded, well-posed, objective, and complete. It represents a standard application of uncertainty analysis to an established empirical model in semiconductor process engineering. Therefore, the problem is valid, and a solution will be provided.\n\nThe problem asks for the derivation and calculation of the uncertainty in the Preston coefficient, $K$, based on measurements of removal rate $R$, pressure $P$, and relative speed $V$.\n\n### Part 1: Derivation of the Uncertainty Expression\n\nPreston’s relation is given by:\n$$ R = KPV $$\nThe Preston coefficient $K$ can be expressed as a function of the measured quantities $R$, $P$, and $V$:\n$$ K(R, P, V) = \\frac{R}{PV} = R P^{-1} V^{-1} $$\nFor a function $K$ of several independent variables $x_i$, the combined standard uncertainty $u_K$ is given by the law of propagation of uncertainty. For small, independent uncertainties, the squared standard uncertainty (variance) is:\n$$ u_K^2 = \\sum_{i} \\left( \\frac{\\partial K}{\\partial x_i} \\right)^2 u_{x_i}^2 $$\nIn this case, the variables are $R$, $P$, and $V$, so the expression is:\n$$ u_K^2 = \\left( \\frac{\\partial K}{\\partial R} \\right)^2 u_R^2 + \\left( \\frac{\\partial K}{\\partial P} \\right)^2 u_P^2 + \\left( \\frac{\\partial K}{\\partial V} \\right)^2 u_V^2 $$\nWe compute the partial derivatives of $K$ with respect to each variable:\n$$ \\frac{\\partial K}{\\partial R} = \\frac{1}{PV} $$\n$$ \\frac{\\partial K}{\\partial P} = R(-1)P^{-2}V^{-1} = -\\frac{R}{P^2 V} $$\n$$ \\frac{\\partial K}{\\partial V} = R P^{-1}(-1)V^{-2} = -\\frac{R}{PV^2} $$\nSubstituting these derivatives into the variance formula:\n$$ u_K^2 = \\left( \\frac{1}{PV} \\right)^2 u_R^2 + \\left( -\\frac{R}{P^2 V} \\right)^2 u_P^2 + \\left( -\\frac{R}{PV^2} \\right)^2 u_V^2 $$\n$$ u_K^2 = \\frac{u_R^2}{P^2 V^2} + \\frac{R^2 u_P^2}{P^4 V^2} + \\frac{R^2 u_V^2}{P^2 V^4} $$\nThis expression can be simplified by dividing by $K^2 = (R/PV)^2 = R^2/(P^2 V^2)$ to work with relative uncertainties:\n$$ \\frac{u_K^2}{K^2} = \\frac{u_R^2/(P^2 V^2)}{R^2/(P^2 V^2)} + \\frac{R^2 u_P^2/(P^4 V^2)}{R^2/(P^2 V^2)} + \\frac{R^2 u_V^2/(P^2 V^4)}{R^2/(P^2 V^2)} $$\n$$ \\left( \\frac{u_K}{K} \\right)^2 = \\left( \\frac{u_R}{R} \\right)^2 + \\left( \\frac{u_P}{P} \\right)^2 + \\left( \\frac{u_V}{V} \\right)^2 $$\nThe analytic expression for the absolute standard uncertainty $u_K$ is obtained by multiplying the relative uncertainty by $K$:\n$$ u_K = |K| \\sqrt{\\left( \\frac{u_R}{R} \\right)^2 + \\left( \\frac{u_P}{P} \\right)^2 + \\left( \\frac{u_V}{V} \\right)^2} $$\nSince $K$, $P$, $V$, and $R$ are physical quantities that are non-negative, the absolute value is not strictly necessary.\n\n### Part 2: Numerical Evaluation of $K$ and $u_K$\n\nFirst, all given quantities must be converted to coherent International System (SI) units. The target unit for $K$ is $\\mathrm{m}^{2}\\,\\mathrm{N}^{-1}$.\nThe SI unit for pressure is the Pascal ($\\mathrm{Pa}$), where $1\\ \\mathrm{Pa} = 1\\ \\mathrm{N/m^2}$.\nThe SI unit for speed is $\\mathrm{m/s}$.\nThe SI unit for removal rate is $\\mathrm{m/s}$.\n\nGiven values and their conversion:\n- Pressure: $P = 30.0\\ \\mathrm{kPa} = 3.00 \\times 10^4\\ \\mathrm{Pa} = 3.00 \\times 10^4\\ \\mathrm{N/m^2}$.\n- Pressure uncertainty: $u_{P} = 0.50\\ \\mathrm{kPa} = 5.0 \\times 10^2\\ \\mathrm{Pa} = 5.0 \\times 10^2\\ \\mathrm{N/m^2}$.\n- Relative speed: $V = 0.600\\ \\mathrm{m/s}$ (already in SI units).\n- Speed uncertainty: $u_{V} = 0.030\\ \\mathrm{m/s}$ (already in SI units).\n- Removal rate: $R = 180\\ \\mathrm{nm/min} = 180 \\times \\frac{10^{-9}\\ \\mathrm{m}}{60\\ \\mathrm{s}} = 3.00 \\times 10^{-9}\\ \\mathrm{m/s}$.\n- Rate uncertainty: $u_{R} = 10\\ \\mathrm{nm/min} = 10 \\times \\frac{10^{-9}\\ \\mathrm{m}}{60\\ \\mathrm{s}} = \\frac{1}{6} \\times 10^{-9}\\ \\mathrm{m/s} \\approx 1.667 \\times 10^{-10}\\ \\mathrm{m/s}$.\n\nNext, we calculate the best estimate for $K$:\n$$ K = \\frac{R}{PV} = \\frac{3.00 \\times 10^{-9}\\ \\mathrm{m/s}}{(3.00 \\times 10^4\\ \\mathrm{N/m^2}) \\times (0.600\\ \\mathrm{m/s})} = \\frac{3.00 \\times 10^{-9}}{1.80 \\times 10^4}\\ \\mathrm{m^2/N} $$\n$$ K = \\frac{5}{3} \\times 10^{-13}\\ \\mathrm{m^2/N} \\approx 1.667 \\times 10^{-13}\\ \\mathrm{m^2/N} $$\n\nNow, we calculate the dimensionless relative uncertainties for each input quantity:\n$$ \\frac{u_R}{R} = \\frac{10\\ \\mathrm{nm/min}}{180\\ \\mathrm{nm/min}} = \\frac{1}{18} $$\n$$ \\frac{u_P}{P} = \\frac{0.50\\ \\mathrm{kPa}}{30.0\\ \\mathrm{kPa}} = \\frac{1}{60} $$\n$$ \\frac{u_V}{V} = \\frac{0.030\\ \\mathrm{m/s}}{0.600\\ \\mathrm{m/s}} = \\frac{1}{20} $$\nWe substitute these into the derived expression for $u_K$:\n$$ \\left( \\frac{u_K}{K} \\right)^2 = \\left(\\frac{1}{18}\\right)^2 + \\left(\\frac{1}{60}\\right)^2 + \\left(\\frac{1}{20}\\right)^2 $$\n$$ \\left( \\frac{u_K}{K} \\right)^2 = \\frac{1}{324} + \\frac{1}{3600} + \\frac{1}{400} $$\nConverting to decimal form for computation:\n$$ \\left( \\frac{u_K}{K} \\right)^2 \\approx 0.00308642 + 0.00027778 + 0.00250000 = 0.0058642 $$\nThe relative uncertainty in $K$ is:\n$$ \\frac{u_K}{K} = \\sqrt{0.0058642} \\approx 0.076578 $$\nFinally, the absolute standard uncertainty $u_K$ is:\n$$ u_K = K \\times \\frac{u_K}{K} \\approx (1.666... \\times 10^{-13}\\ \\mathrm{m^2/N}) \\times 0.076578 $$\n$$ u_K \\approx 1.2763 \\times 10^{-14}\\ \\mathrm{m^2/N} $$\nRounding to three significant figures, as requested:\n$$ u_K \\approx 1.28 \\times 10^{-14}\\ \\mathrm{m^2/N} $$\n\n### Part 3: Dominant Uncertainty Source\n\nThe total propagated variance is the sum of the individual contributions from each input variable's variance, scaled by its sensitivity coefficient. In the relative form, the total squared relative uncertainty is the sum of the squared relative uncertainties of the inputs:\n$$ \\left( \\frac{u_K}{K} \\right)^2 = \\left( \\frac{u_R}{R} \\right)^2 + \\left( \\frac{u_P}{P} \\right)^2 + \\left( \\frac{u_V}{V} \\right)^2 $$\nTo identify the dominant source, we compare the numerical value of each term in this sum:\n- Contribution from $R$: $\\left(\\frac{u_R}{R}\\right)^2 = \\left(\\frac{1}{18}\\right)^2 \\approx 0.003086$\n- Contribution from $V$: $\\left(\\frac{u_V}{V}\\right)^2 = \\left(\\frac{1}{20}\\right)^2 = 0.002500$\n- Contribution from $P$: $\\left(\\frac{u_P}{P}\\right)^2 = \\left(\\frac{1}{60}\\right)^2 \\approx 0.000278$\n\nComparing these values, $0.003086 > 0.002500 > 0.000278$. The largest contribution to the variance of $K$ comes from the uncertainty in the removal rate, $R$. This is because the relative uncertainty in $R$ ($\\frac{u_R}{R} = \\frac{1}{18} \\approx 5.6\\%$) is the largest of the three input relative uncertainties ($\\frac{u_V}{V} = 5.0\\%$, $\\frac{u_P}{P} \\approx 1.7\\%$). Because of the simple multiplicative structure of Preston's equation, the input with the largest relative uncertainty dominates the relative uncertainty of the result.\n\nThe final numerical answer required is the value for $u_K$.",
            "answer": "$$\\boxed{1.28 \\times 10^{-14}}$$"
        },
        {
            "introduction": "Advanced process modeling requires moving beyond wafer-average values to understand spatial non-uniformity. In a real Chemical Mechanical Planarization process, factors like slurry flow, pad conditioning, and wafer-carrier interactions can cause the effective Preston coefficient to vary across the wafer surface. This capstone exercise challenges you to develop a sophisticated estimation framework for a spatially-varying Preston coefficient field, $\\mathbf{k}$. You will derive the mathematical basis for a regularized weighted least-squares estimator, a powerful technique used in modern inverse problems to build predictive spatial models from noisy wafer map data .",
            "id": "4156565",
            "problem": "In Chemical Mechanical Planarization (CMP), the empirically well-tested Preston relation states that the local material removal rate is proportional to the product of local contact pressure and local relative velocity. Consider a wafer surface discretized into $N$ grid cells. For each of $J$ distinct process runs, the contact pressure and relative velocity fields are known and sampled on the same grid, yielding known vectors $\\mathbf{p}_{j} \\in \\mathbb{R}^{N}$ and $\\mathbf{v}_{j} \\in \\mathbb{R}^{N}$ for $j \\in \\{1,\\dots,J\\}$. The measured removal rate for run $j$ is $\\mathbf{r}_{j} \\in \\mathbb{R}^{N}$ and is corrupted by additive noise. Let the spatially varying Preston coefficient be $\\mathbf{k} \\in \\mathbb{R}^{N}$, which is assumed constant across runs but may vary across grid cells. Assume the additive noise in run $j$ is zero-mean Gaussian with covariance $\\boldsymbol{\\Sigma}_{j} \\in \\mathbb{R}^{N \\times N}$, which is known and positive definite. To promote spatial smoothness in $\\mathbf{k}$, use Tikhonov regularization with a known linear operator $\\mathbf{L} \\in \\mathbb{R}^{M \\times N}$ (for example, a discrete gradient or Laplacian) and a regularization strength $\\lambda > 0$.\n\nStarting from the Preston proportionality and the Gaussian maximum likelihood principle, formulate the weighted least-squares (WLS) objective with Tikhonov regularization to estimate $\\mathbf{k}$, derive the associated normal equations, and provide a closed-form analytic expression for the estimator $\\widehat{\\mathbf{k}}$ in terms of $\\{\\mathbf{p}_{j}\\}_{j=1}^{J}$, $\\{\\mathbf{v}_{j}\\}_{j=1}^{J}$, $\\{\\mathbf{r}_{j}\\}_{j=1}^{J}$, $\\{\\boldsymbol{\\Sigma}_{j}\\}_{j=1}^{J}$, $\\mathbf{L}$, and $\\lambda$. You may use the Hadamard product notation and the diagonalization operator as needed, but do not assume any special structure beyond what is stated.\n\nExpress your final answer as a single closed-form analytic expression. Do not include units in your final expression. No numerical rounding is required.",
            "solution": "The problem is scientifically grounded and well-posed. It formulates a standard inverse problem in process modeling, combining the Preston model with regularized weighted least-squares estimation, a common technique in engineering and data science. The problem is valid, and a solution will be derived.\n\nThe derivation begins by formalizing the Preston relation in matrix-vector notation. The local removal rate at grid cell $i$ for run $j$ is proportional to the product of local pressure $p_{ji}$ and local velocity $v_{ji}$. Let $k_i$ be the Preston coefficient at cell $i$. The true, noiseless removal rate at cell $i$ is $k_i p_{ji} v_{ji}$. stacking these values for all $N$ cells into vectors, the true removal rate vector for run $j$, denoted $\\mathbf{r}_{\\text{true},j} \\in \\mathbb{R}^{N}$, is given by the element-wise product of the Preston coefficient vector $\\mathbf{k}$ and the product of the pressure and velocity vectors. Using the Hadamard product symbol $\\circ$, this is:\n$$\n\\mathbf{r}_{\\text{true},j} = \\mathbf{k} \\circ (\\mathbf{p}_{j} \\circ \\mathbf{v}_{j})\n$$\nThis relationship can be expressed as a linear transformation of $\\mathbf{k}$. Let $\\mathbf{D}_{j}$ be the $N \\times N$ diagonal matrix formed from the vector $\\mathbf{p}_{j} \\circ \\mathbf{v}_{j}$. That is, $\\mathbf{D}_{j} = \\text{diag}(\\mathbf{p}_{j} \\circ \\mathbf{v}_{j})$. The model for the true removal rate is then:\n$$\n\\mathbf{r}_{\\text{true},j} = \\mathbf{D}_{j}\\mathbf{k}\n$$\nThe measured removal rate $\\mathbf{r}_{j}$ is corrupted by additive zero-mean Gaussian noise $\\boldsymbol{\\epsilon}_{j}$ with covariance $\\boldsymbol{\\Sigma}_{j}$. The full model for run $j$ is:\n$$\n\\mathbf{r}_{j} = \\mathbf{D}_{j}\\mathbf{k} + \\boldsymbol{\\epsilon}_{j}, \\quad \\text{where} \\quad \\boldsymbol{\\epsilon}_{j} \\sim \\mathcal{N}(\\mathbf{0}, \\boldsymbol{\\Sigma}_{j})\n$$\nThe probability density function (PDF) for the measurements $\\mathbf{r}_{j}$ given $\\mathbf{k}$ is:\n$$\nP(\\mathbf{r}_{j}|\\mathbf{k}) = \\frac{1}{(2\\pi)^{N/2} \\det(\\boldsymbol{\\Sigma}_{j})^{1/2}} \\exp\\left(-\\frac{1}{2}(\\mathbf{r}_{j} - \\mathbf{D}_{j}\\mathbf{k})^{T}\\boldsymbol{\\Sigma}_{j}^{-1}(\\mathbf{r}_{j} - \\mathbf{D}_{j}\\mathbf{k})\\right)\n$$\nAssuming the $J$ process runs are statistically independent, the total likelihood of all measurements $\\{\\mathbf{r}_{j}\\}_{j=1}^{J}$ is the product of the individual likelihoods:\n$$\n\\mathcal{L}(\\mathbf{k}) = \\prod_{j=1}^{J} P(\\mathbf{r}_{j}|\\mathbf{k})\n$$\nThe maximum likelihood estimate (MLE) of $\\mathbf{k}$ is found by maximizing $\\mathcal{L}(\\mathbf{k})$, which is equivalent to minimizing the negative log-likelihood, $-\\ln(\\mathcal{L}(\\mathbf{k}))$:\n$$\n-\\ln(\\mathcal{L}(\\mathbf{k})) = -\\sum_{j=1}^{J} \\ln(P(\\mathbf{r}_{j}|\\mathbf{k})) = \\sum_{j=1}^{J} \\left( \\frac{N}{2}\\ln(2\\pi) + \\frac{1}{2}\\ln(\\det(\\boldsymbol{\\Sigma}_{j})) + \\frac{1}{2}(\\mathbf{r}_{j} - \\mathbf{D}_{j}\\mathbf{k})^{T}\\boldsymbol{\\Sigma}_{j}^{-1}(\\mathbf{r}_{j} - \\mathbf{D}_{j}\\mathbf{k}) \\right)\n$$\nTo find the optimal $\\mathbf{k}$, we can discard the constant terms, which leaves us with the weighted least-squares (WLS) objective function:\n$$\nJ_{\\text{WLS}}(\\mathbf{k}) = \\sum_{j=1}^{J} (\\mathbf{r}_{j} - \\mathbf{D}_{j}\\mathbf{k})^{T}\\boldsymbol{\\Sigma}_{j}^{-1}(\\mathbf{r}_{j} - \\mathbf{D}_{j}\\mathbf{k})\n$$\nThe problem requires adding a Tikhonov regularization term to promote smoothness. The regularization term is given by $\\lambda \\|\\mathbf{L}\\mathbf{k}\\|_{2}^{2} = \\lambda (\\mathbf{L}\\mathbf{k})^{T}(\\mathbf{L}\\mathbf{k}) = \\lambda \\mathbf{k}^{T}\\mathbf{L}^{T}\\mathbf{L}\\mathbf{k}$. The complete regularized WLS objective function to minimize is:\n$$\nJ(\\mathbf{k}) = \\sum_{j=1}^{J} (\\mathbf{r}_{j} - \\mathbf{D}_{j}\\mathbf{k})^{T}\\boldsymbol{\\Sigma}_{j}^{-1}(\\mathbf{r}_{j} - \\mathbf{D}_{j}\\mathbf{k}) + \\lambda \\mathbf{k}^{T}\\mathbf{L}^{T}\\mathbf{L}\\mathbf{k}\n$$\nTo find the estimator $\\widehat{\\mathbf{k}}$ that minimizes $J(\\mathbf{k})$, we compute the gradient of $J(\\mathbf{k})$ with respect to $\\mathbf{k}$ and set it to zero. Using the matrix calculus identity $\\nabla_{\\mathbf{x}} (\\mathbf{b}-\\mathbf{A}\\mathbf{x})^{T}\\mathbf{C}(\\mathbf{b}-\\mathbf{A}\\mathbf{x}) = 2\\mathbf{A}^{T}\\mathbf{C}(\\mathbf{A}\\mathbf{x}-\\mathbf{b})$ and $\\nabla_{\\mathbf{x}} \\mathbf{x}^{T}\\mathbf{B}\\mathbf{x} = 2\\mathbf{B}\\mathbf{x}$ for symmetric $\\mathbf{B}$, the gradient is:\n$$\n\\nabla_{\\mathbf{k}}J(\\mathbf{k}) = \\sum_{j=1}^{J} 2\\mathbf{D}_{j}^{T}\\boldsymbol{\\Sigma}_{j}^{-1}(\\mathbf{D}_{j}\\mathbf{k} - \\mathbf{r}_{j}) + 2\\lambda\\mathbf{L}^{T}\\mathbf{L}\\mathbf{k}\n$$\nNote that $\\mathbf{D}_{j}$ is a diagonal matrix, so $\\mathbf{D}_{j}^{T} = \\mathbf{D}_{j}$. Also, $\\boldsymbol{\\Sigma}_j$ is positive definite, so $\\boldsymbol{\\Sigma}_j^{-1}$ is symmetric. The matrix $\\mathbf{L}^{T}\\mathbf{L}$ is also symmetric.\nSetting the gradient to $\\mathbf{0}$ and dividing by $2$:\n$$\n\\sum_{j=1}^{J} \\mathbf{D}_{j}\\boldsymbol{\\Sigma}_{j}^{-1}(\\mathbf{D}_{j}\\mathbf{k} - \\mathbf{r}_{j}) + \\lambda\\mathbf{L}^{T}\\mathbf{L}\\mathbf{k} = \\mathbf{0}\n$$\nExpanding and rearranging terms to group $\\mathbf{k}$:\n$$\n\\sum_{j=1}^{J} \\mathbf{D}_{j}\\boldsymbol{\\Sigma}_{j}^{-1}\\mathbf{D}_{j}\\mathbf{k} - \\sum_{j=1}^{J} \\mathbf{D}_{j}\\boldsymbol{\\Sigma}_{j}^{-1}\\mathbf{r}_{j} + \\lambda\\mathbf{L}^{T}\\mathbf{L}\\mathbf{k} = \\mathbf{0}\n$$\nFactoring out $\\mathbf{k}$ leads to the normal equations:\n$$\n\\left( \\left(\\sum_{j=1}^{J} \\mathbf{D}_{j}\\boldsymbol{\\Sigma}_{j}^{-1}\\mathbf{D}_{j}\\right) + \\lambda\\mathbf{L}^{T}\\mathbf{L} \\right) \\mathbf{k} = \\sum_{j=1}^{J} \\mathbf{D}_{j}\\boldsymbol{\\Sigma}_{j}^{-1}\\mathbf{r}_{j}\n$$\nThe matrix multiplying $\\mathbf{k}$ is invertible due to the Tikhonov regularization term (since $\\lambda>0$ and the sum of positive semi-definite matrices is at least positive semi-definite, the regularization often makes it positive definite, guaranteeing invertibility). Solving for $\\mathbf{k}$ yields the estimator $\\widehat{\\mathbf{k}}$:\n$$\n\\widehat{\\mathbf{k}} = \\left( \\sum_{j=1}^{J} \\mathbf{D}_{j}\\boldsymbol{\\Sigma}_{j}^{-1}\\mathbf{D}_{j} + \\lambda\\mathbf{L}^{T}\\mathbf{L} \\right)^{-1} \\left( \\sum_{j=1}^{J} \\mathbf{D}_{j}\\boldsymbol{\\Sigma}_{j}^{-1}\\mathbf{r}_{j} \\right)\n$$\nSubstituting back the definition $\\mathbf{D}_{j} = \\text{diag}(\\mathbf{p}_{j} \\circ \\mathbf{v}_{j})$, we obtain the final closed-form expression.",
            "answer": "$$\n\\boxed{\\left( \\sum_{j=1}^{J} \\text{diag}(\\mathbf{p}_{j} \\circ \\mathbf{v}_{j}) \\boldsymbol{\\Sigma}_{j}^{-1} \\text{diag}(\\mathbf{p}_{j} \\circ \\mathbf{v}_{j}) + \\lambda \\mathbf{L}^{T}\\mathbf{L} \\right)^{-1} \\left( \\sum_{j=1}^{J} \\text{diag}(\\mathbf{p}_{j} \\circ \\mathbf{v}_{j}) \\boldsymbol{\\Sigma}_{j}^{-1} \\mathbf{r}_{j} \\right)}\n$$"
        }
    ]
}