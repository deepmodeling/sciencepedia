{
    "hands_on_practices": [
        {
            "introduction": "准确的热化学数据是反应器建模的基石。本练习将指导您如何从基本数据——用于表示热容 ($C_p$) 的NASA多项式——出发，计算随温度变化的平衡常数 ($K_p$) 。通过这项实践，您将掌握从零开始构建热力学一致性模型的关键技能，这对于准确预测反应方向和最终产物分布至关重要。",
            "id": "4127983",
            "problem": "一种常用于半导体制造中化学气相沉积（CVD）的气相沉积反应是四氯化硅的氢还原。考虑一个反应，其化学计量系数定义为产物为正，反应物为负：$$\\nu_{\\mathrm{Si(s)}} = +1,\\;\\nu_{\\mathrm{HCl(g)}} = +4,\\;\\nu_{\\mathrm{SiCl_4(g)}} = -1,\\;\\nu_{\\mathrm{H_2(g)}} = -2,$$ 这对应于反应式：$$\\mathrm{SiCl_4(g)} + 2\\,\\mathrm{H_2(g)} \\rightarrow \\mathrm{Si(s)} + 4\\,\\mathrm{HCl(g)}.$$ 假设气体为理想气体，气相标准态的标准压力为 $1$ bar。以分压表示的平衡常数由标准吉布斯自由能变通过下式确定：$$K_p(T) = \\exp\\!\\left(-\\frac{\\Delta G^\\circ(T)}{R\\,T}\\right),$$ 其中 $R$ 是普适气体常数。各物种在温度 $T$ 下的标准摩尔焓和熵，需通过对随温度变化的定压热容进行积分来获得。\n\n使用以下符合上下文的基本原理：\n- 摩尔定压热容 $C_p(T)$ 通过以下方式定义焓和熵的温度依赖性：$$H^\\circ(T) = H^\\circ(T_{\\mathrm{ref}}) + \\int_{T_{\\mathrm{ref}}}^{T} C_p(T')\\,\\mathrm{d}T',$$ $$S^\\circ(T) = S^\\circ(T_{\\mathrm{ref}}) + \\int_{T_{\\mathrm{ref}}}^{T} \\frac{C_p(T')}{T'}\\,\\mathrm{d}T',$$ 其中 $T_{\\mathrm{ref}} = 298.15\\ \\mathrm{K}.$\n- 标准吉布斯自由能为 $$G^\\circ(T) = H^\\circ(T) - T\\,S^\\circ(T),$$ 反应性质为 $$\\Delta H^\\circ(T) = \\sum_i \\nu_i H_i^\\circ(T),\\quad \\Delta S^\\circ(T) = \\sum_i \\nu_i S_i^\\circ(T),\\quad \\Delta G^\\circ(T) = \\Delta H^\\circ(T) - T\\,\\Delta S^\\circ(T).$$\n\n使用截断级数近似表示美国国家航空航天局（NASA）多项式形式的热容：$$\\frac{C_p(T)}{R} = a_0 + a_1 T + a_2 T^2 + a_3 T^3 + a_4 T^4,$$ 该式适用于所考虑温度区间内的每种物种。普适气体常数为 $R = 8.31446261815324\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$。使用以下科学上合理的参数，所有参数均参考于 $T_{\\mathrm{ref}} = 298.15\\ \\mathrm{K}$：\n\n- 物种: $\\mathrm{H_2(g)}$\n  - $\\Delta H_f^\\circ(298.15\\ \\mathrm{K}) = 0.0\\ \\mathrm{J\\,mol^{-1}}$\n  - $S^\\circ(298.15\\ \\mathrm{K}) = 130.68\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n  - $a_0 = 3.33727920$, $a_1 = -4.94024731\\times 10^{-5}$, $a_2 = 4.99456778\\times 10^{-7}$, $a_3 = -1.79566394\\times 10^{-10}$, $a_4 = 2.00255376\\times 10^{-14}$\n- 物种: $\\mathrm{HCl(g)}$\n  - $\\Delta H_f^\\circ(298.15\\ \\mathrm{K}) = -92310.0\\ \\mathrm{J\\,mol^{-1}}$\n  - $S^\\circ(298.15\\ \\mathrm{K}) = 186.90\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n  - $a_0 = 3.50000000$, $a_1 = 1.00000000\\times 10^{-3}$, $a_2 = -3.00000000\\times 10^{-7}$, $a_3 = 5.00000000\\times 10^{-11}$, $a_4 = -3.00000000\\times 10^{-15}$\n- 物种: $\\mathrm{SiCl_4(g)}$\n  - $\\Delta H_f^\\circ(298.15\\ \\mathrm{K}) = -657000.0\\ \\mathrm{J\\,mol^{-1}}$\n  - $S^\\circ(298.15\\ \\mathrm{K}) = 324.00\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n  - $a_0 = 11.00000000$, $a_1 = 5.00000000\\times 10^{-3}$, $a_2 = -2.00000000\\times 10^{-6}$, $a_3 = 3.00000000\\times 10^{-10}$, $a_4 = -2.00000000\\times 10^{-14}$\n- 物种: $\\mathrm{Si(s)}$\n  - $\\Delta H_f^\\circ(298.15\\ \\mathrm{K}) = 0.0\\ \\mathrm{J\\,mol^{-1}}$\n  - $S^\\circ(298.15\\ \\mathrm{K}) = 18.80\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$\n  - $a_0 = 2.50000000$, $a_1 = 2.00000000\\times 10^{-3}$, $a_2 = -8.00000000\\times 10^{-7}$, $a_3 = 1.00000000\\times 10^{-10}$, $a_4 = -5.00000000\\times 10^{-15}$\n\n任务：\n- 实现上述积分，通过使用给定的 $a_k$ 系数和在 $T_{\\mathrm{ref}}$ 处的参考值，对 $C_{p,i}(T)$ 从 $T_{\\mathrm{ref}}$ 到 $T$ 进行积分，从而计算出每个物种的 $H_i^\\circ(T)$ 和 $S_i^\\circ(T)$。\n- 计算 $\\Delta H^\\circ(T)$、$\\Delta S^\\circ(T)$、$\\Delta G^\\circ(T)$，并最终计算出 $K_p(T)$。\n- 将固相 $\\mathrm{Si(s)}$ 的活度视为 $1$；尽管如此，其 $H^\\circ(T)$ 和 $S^\\circ(T)$ 仍对 $\\Delta H^\\circ(T)$ 和 $\\Delta S^\\circ(T)$ 有贡献。\n\n物理和数值单位：\n- 温度单位必须是 $\\mathrm{K}$。\n- 焓的单位必须是 $\\mathrm{J\\,mol^{-1}}$，熵的单位必须是 $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n- 平衡常数 $K_p(T)$ 是无量纲的。\n\n测试组：\n- 在以下温度（单位均为 $\\mathrm{K}$）下评估 $K_p(T)$：$298.15$、$800.0$、$1000.0$、$1200.0$、$1600.0$。\n- 包括 $T = 298.15$ 的情况，以测试积分值为零的边界条件，并包括更高温度以测试真实的反应器条件。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个 $K_p(T)$ 值均四舍五入到六位有效数字，并按测试组温度的顺序排列：例如，$$[k_{298.15},k_{800.0},k_{1000.0},k_{1200.0},k_{1600.0}].$$",
            "solution": "目标是计算用于沉积硅的四氯化硅氢还原反应的平衡常数 $K_p(T)$。推导过程始于基本热力学定义和理想气体标准态。物种 $i$ 的标准化学势为 $$\\mu_i^\\circ(T) = H_i^\\circ(T) - T\\,S_i^\\circ(T),$$ 反应的标准吉布斯自由能变为 $$\\Delta G^\\circ(T) = \\sum_i \\nu_i \\mu_i^\\circ(T) = \\sum_i \\nu_i \\left(H_i^\\circ(T) - T\\,S_i^\\circ(T)\\right) = \\Delta H^\\circ(T) - T\\,\\Delta S^\\circ(T),$$ 其中 $$\\Delta H^\\circ(T) = \\sum_i \\nu_i H_i^\\circ(T),\\quad \\Delta S^\\circ(T) = \\sum_i \\nu_i S_i^\\circ(T).$$ 对于标准压力为 $1$ bar 的理想气体，以分压表示的平衡常数为 $$K_p(T) = \\exp\\!\\left(-\\frac{\\Delta G^\\circ(T)}{R\\,T}\\right).$$\n\n为了从热容中获得 $H_i^\\circ(T)$ 和 $S_i^\\circ(T)$ 的温度依赖性，我们从定压下的定义开始：\n- 从参考温度 $T_{\\mathrm{ref}}$ 开始的摩尔焓变由下式给出：$$H_i^\\circ(T) - H_i^\\circ(T_{\\mathrm{ref}}) = \\int_{T_{\\mathrm{ref}}}^{T} C_{p,i}(T')\\,\\mathrm{d}T'.$$\n- 摩尔熵变为：$$S_i^\\circ(T) - S_i^\\circ(T_{\\mathrm{ref}}) = \\int_{T_{\\mathrm{ref}}}^{T} \\frac{C_{p,i}(T')}{T'}\\,\\mathrm{d}T'.$$\n\n我们使用截断的 NASA 多项式形式来近似热容的温度依赖性：$$\\frac{C_{p,i}(T)}{R} = a_{0,i} + a_{1,i} T + a_{2,i} T^2 + a_{3,i} T^3 + a_{4,i} T^4.$$ 如此，积分为初等积分：\n- 焓积分为：$$\\int_{T_{\\mathrm{ref}}}^{T} C_{p,i}(T')\\,\\mathrm{d}T' = R\\left[a_{0,i}(T - T_{\\mathrm{ref}}) + \\frac{a_{1,i}}{2}(T^2 - T_{\\mathrm{ref}}^2) + \\frac{a_{2,i}}{3}(T^3 - T_{\\mathrm{ref}}^3) + \\frac{a_{3,i}}{4}(T^4 - T_{\\mathrm{ref}}^4) + \\frac{a_{4,i}}{5}(T^5 - T_{\\mathrm{ref}}^5)\\right].$$\n- 熵积分为：$$\\int_{T_{\\mathrm{ref}}}^{T} \\frac{C_{p,i}(T')}{T'}\\,\\mathrm{d}T' = R\\left[a_{0,i}\\ln\\!\\left(\\frac{T}{T_{\\mathrm{ref}}}\\right) + a_{1,i}(T - T_{\\mathrm{ref}}) + \\frac{a_{2,i}}{2}(T^2 - T_{\\mathrm{ref}}^2) + \\frac{a_{3,i}}{3}(T^3 - T_{\\mathrm{ref}}^3) + \\frac{a_{4,i}}{4}(T^4 - T_{\\mathrm{ref}}^4)\\right].$$\n\n我们使用在 $T_{\\mathrm{ref}} = 298.15\\ \\mathrm{K}$ 下提供的参考值：\n- 对于焓，我们将 $H_i^\\circ(298.15\\ \\mathrm{K})$ 取为每种物种的标准生成焓 $\\Delta H_{f,i}^\\circ(298.15\\ \\mathrm{K})$，这会在参考温度下得出正确的反应焓。因此：$$H_i^\\circ(T) = \\Delta H_{f,i}^\\circ(298.15\\ \\mathrm{K}) + \\int_{298.15\\ \\mathrm{K}}^{T} C_{p,i}(T')\\,\\mathrm{d}T'.$$\n- 对于熵，我们取：$$S_i^\\circ(T) = S_i^\\circ(298.15\\ \\mathrm{K}) + \\int_{298.15\\ \\mathrm{K}}^{T} \\frac{C_{p,i}(T')}{T'}\\,\\mathrm{d}T'.$$\n\n然后，反应性质如下：\n- $$\\Delta H^\\circ(T) = \\sum_i \\nu_i \\left[\\Delta H_{f,i}^\\circ(298.15\\ \\mathrm{K}) + \\int_{298.15\\ \\mathrm{K}}^{T} C_{p,i}(T')\\,\\mathrm{d}T'\\right] = \\Delta H^\\circ(298.15\\ \\mathrm{K}) + \\sum_i \\nu_i \\int_{298.15\\ \\mathrm{K}}^{T} C_{p,i}(T')\\,\\mathrm{d}T',$$ 其中 $$\\Delta H^\\circ(298.15\\ \\mathrm{K}) = \\sum_i \\nu_i \\Delta H_{f,i}^\\circ(298.15\\ \\mathrm{K}).$$\n- $$\\Delta S^\\circ(T) = \\sum_i \\nu_i \\left[S_i^\\circ(298.15\\ \\mathrm{K}) + \\int_{298.15\\ \\mathrm{K}}^{T} \\frac{C_{p,i}(T')}{T'}\\,\\mathrm{d}T'\\right] = \\Delta S^\\circ(298.15\\ \\mathrm{K}) + \\sum_i \\nu_i \\int_{298.15\\ \\mathrm{K}}^{T} \\frac{C_{p,i}(T')}{T'}\\,\\mathrm{d}T',$$ 其中 $$\\Delta S^\\circ(298.15\\ \\mathrm{K}) = \\sum_i \\nu_i S_i^\\circ(298.15\\ \\mathrm{K}).$$\n\n最后，计算 $$\\Delta G^\\circ(T) = \\Delta H^\\circ(T) - T\\,\\Delta S^\\circ(T),$$ 和 $$K_p(T) = \\exp\\!\\left(-\\frac{\\Delta G^\\circ(T)}{R\\,T}\\right).$$ 注意，固相 $\\mathrm{Si(s)}$ 的活度等于 $1$，不会在 $K_p$ 中引入压力项，但它通过其热化学函数对 $\\Delta H^\\circ(T)$ 和 $\\Delta S^\\circ(T)$ 有贡献。\n\n实现的算法设计：\n- 以数值方式定义 $R$ 和 $T_{\\mathrm{ref}}$。\n- 为每个物种存储：化学计量系数 $\\nu_i$、多项式系数 $a_{k,i}$、$\\Delta H_{f,i}^\\circ(298.15\\ \\mathrm{K})$ 和 $S_i^\\circ(298.15\\ \\mathrm{K})$。\n- 实现函数，使用上述解析表达式来评估焓校正 $\\int C_{p,i}\\,\\mathrm{d}T'$ 和熵校正 $\\int C_{p,i}/T'\\,\\mathrm{d}T'$。\n- 计算每个测试温度下的 $\\Delta H^\\circ(T)$ 和 $\\Delta S^\\circ(T)$，然后是 $\\Delta G^\\circ(T)$，最后是 $K_p(T)$。在输出前将每个 $K_p(T)$ 四舍五入到六位有效数字。\n- 按照指定顺序生成包含结果的单行输出。\n\n这种方法严格遵循第一性原理热力学，并使用多项式热容表示法来推算随温度变化的焓和熵，避免了使用简化公式，并确保了与 $1$ bar 下理想气体标准态的一致性。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\nimport numpy as np\nimport math\n\ndef solve():\n    # Universal gas constant (J/mol-K)\n    R = 8.31446261815324\n    # Reference temperature (K)\n    T_ref = 298.15\n\n    # Reaction: SiCl4(g) + 2 H2(g) -> Si(s) + 4 HCl(g)\n    # Stoichiometric coefficients: products positive, reactants negative\n    # Species data: name, nu, dhf_ref (J/mol), s_ref (J/mol-K), cp/R coefficients a0..a4\n    species = [\n        {\n            \"name\": \"Si(s)\",\n            \"nu\": +1.0,\n            \"dhf_ref\": 0.0,\n            \"s_ref\": 18.80,\n            \"a\": np.array([2.5, 2.0e-3, -8.0e-7, 1.0e-10, -5.0e-15], dtype=float),\n        },\n        {\n            \"name\": \"HCl(g)\",\n            \"nu\": +4.0,\n            \"dhf_ref\": -92310.0,\n            \"s_ref\": 186.90,\n            \"a\": np.array([3.5, 1.0e-3, -3.0e-7, 5.0e-11, -3.0e-15], dtype=float),\n        },\n        {\n            \"name\": \"SiCl4(g)\",\n            \"nu\": -1.0,\n            \"dhf_ref\": -657000.0,\n            \"s_ref\": 324.00,\n            \"a\": np.array([11.0, 5.0e-3, -2.0e-6, 3.0e-10, -2.0e-14], dtype=float),\n        },\n        {\n            \"name\": \"H2(g)\",\n            \"nu\": -2.0,\n            \"dhf_ref\": 0.0,\n            \"s_ref\": 130.68,\n            \"a\": np.array([3.33727920, -4.94024731e-05, 4.99456778e-07, -1.79566394e-10, 2.00255376e-14], dtype=float),\n        },\n    ]\n\n    # Precompute powers of T_ref for integrals\n    Tref_powers = np.array([T_ref, T_ref**2, T_ref**3, T_ref**4, T_ref**5], dtype=float)\n\n    def enthalpy_correction(T, a):\n        \"\"\"\n        Compute integral_{T_ref}^{T} Cp dT using Cp/R = sum_k a_k T^k-1, k=1..5.\n        Returns J/mol.\n        \"\"\"\n        # Terms: a0*(T-Tref) + a1/2*(T^2 - Tref^2) + ...\n        T_powers = np.array([T, T**2, T**3, T**4, T**5], dtype=float)\n        coeff_div = np.array([1.0, 1.0/2.0, 1.0/3.0, 1.0/4.0, 1.0/5.0], dtype=float)\n        integral_over_R = np.sum(a * coeff_div * (T_powers - Tref_powers))\n        return R * integral_over_R\n\n    def entropy_correction(T, a):\n        \"\"\"\n        Compute integral_{T_ref}^{T} Cp/T dT using Cp/R = sum_k a_k T^k-1, k=1..5.\n        Returns J/mol-K.\n        \"\"\"\n        # Terms: a0*ln(T/Tref) + a1*(T - Tref) + a2/2*(T^2 - Tref^2) + ...\n        T_powers = np.array([T, T**2, T**3, T**4], dtype=float)\n        Tref_powers_4 = np.array([T_ref, T_ref**2, T_ref**3, T_ref**4], dtype=float)\n        coeffs = np.array([1.0, 1.0, 1.0/2.0, 1.0/3.0, 1.0/4.0], dtype=float)\n        # First term (log) uses a0\n        term0 = a[0] * math.log(T / T_ref)\n        # Remaining terms use a1..a4\n        term_rest = np.sum(a[1:] * coeffs[1:] * (T_powers - Tref_powers_4))\n        integral_over_R = term0 + term_rest\n        return R * integral_over_R\n\n    def compute_Kp(T):\n        # Compute Delta H°(298) and Delta S°(298)\n        delta_H_ref = 0.0\n        delta_S_ref = 0.0\n        for sp in species:\n            delta_H_ref += sp[\"nu\"] * sp[\"dhf_ref\"]\n            delta_S_ref += sp[\"nu\"] * sp[\"s_ref\"]\n        # Temperature corrections\n        delta_h_corr = 0.0\n        delta_s_corr = 0.0\n        for sp in species:\n            a = sp[\"a\"]\n            delta_h_corr += sp[\"nu\"] * enthalpy_correction(T, a)\n            delta_s_corr += sp[\"nu\"] * entropy_correction(T, a)\n        delta_H_T = delta_H_ref + delta_h_corr\n        delta_S_T = delta_S_ref + delta_s_corr\n        delta_G_T = delta_H_T - T * delta_S_T\n        Kp = math.exp(-delta_G_T / (R * T))\n        return Kp\n\n    # Define the test cases from the problem statement: temperatures in K\n    test_cases = [298.15, 800.0, 1000.0, 1200.0, 1600.0]\n\n    results = []\n    for T in test_cases:\n        Kp = compute_Kp(T)\n        # Round to six significant digits\n        results.append(f\"{Kp:.6g}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在掌握了热力学基础之后，下一步便是深入研究反应动力学。本练习通过经典的林德曼（Lindemann）机理，探讨了一种典型的压力依赖反应 。通过应用拟稳态近似（pseudo-steady-state approximation）并进行灵敏度分析，您将学会如何解析复杂的反应路径，并识别出控制整体反应速率的关键动力学参数。",
            "id": "4127985",
            "problem": "考虑在指定温度和压力下，Tetraethyl orthosilicate (TEOS) 在一个混合均匀的等温反应器中的气相分解。该混合物被视为理想气体。该分解通过压力依赖的单分子机理进行，该机理采用具有单一载气的碰撞活化中间体动力学 (Lindemann机理) 进行建模。提供了以下基元步骤：\n- $S_1$: $\\mathrm{TEOS} + \\mathrm{M} \\rightarrow \\mathrm{TEOS}^\\ast + \\mathrm{M}$,\n- $S_2$: $\\mathrm{TEOS}^\\ast + \\mathrm{M} \\rightarrow \\mathrm{TEOS} + \\mathrm{M}$,\n- $S_3$: $\\mathrm{TEOS}^\\ast \\rightarrow \\text{products}$,\n\n其中 $\\mathrm{M}$ 表示载气，$\\mathrm{TEOS}^\\ast$ 表示碰撞活化的TEOS。假设载气的第三体效率为1，因此有效碰撞物浓度等于气体混合物的总数浓度。\n\n基本假设和定义：\n- 理想气体定律：总摩尔浓度为 $C_{\\mathrm{tot}} = P/(R\\,T)$，TEOS摩尔浓度为 $C_{\\mathrm{TEOS}} = y_{\\mathrm{TEOS}}\\,C_{\\mathrm{tot}}$，碰撞物摩尔浓度为 $C_{\\mathrm{M}} = C_{\\mathrm{tot}}$，其中 $P$ 是压力，$T$ 是温度，$R$ 是普适气体常数，$y_{\\mathrm{TEOS}}$ 是TEOS的摩尔分数。\n- 每个基元步骤 $i \\in \\{1,2,3\\}$ 的Arrhenius定律：$k_i(T) = A_i\\,T^{n_i}\\,\\exp\\!\\left(-\\dfrac{E_i}{R\\,T}\\right)$，其中 $A_i$ 是指前因子，$n_i$ 是温度指数，$E_i$ 是活化能。使用以下参数值：\n  - $A_1 = 1.0\\times 10^{-3}\\ \\mathrm{m^3\\,mol^{-1}\\,s^{-1}}$, $n_1 = 0.5$, $E_1 = 0\\ \\mathrm{J\\,mol^{-1}}$,\n  - $A_2 = 5.0\\times 10^{-2}\\ \\mathrm{m^3\\,mol^{-1}\\,s^{-1}}$, $n_2 = 0.5$, $E_2 = 0\\ \\mathrm{J\\,mol^{-1}}$,\n  - $A_3 = 1.0\\times 10^{13}\\ \\mathrm{s^{-1}}$, $n_3 = 0$, $E_3 = 1.80\\times 10^{5}\\ \\mathrm{J\\,mol^{-1}}$。\n- 普适气体常数：$R = 8.314462618\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n\n从上述基本定律和质量作用动力学出发，推导TEOS的分解速率 $r_{\\mathrm{TEOS}}$ (单位为 $\\mathrm{mol\\,m^{-3}\\,s^{-1}}$)，并仅用 $k_1(T)$, $k_2(T)$, $k_3(T)$, $C_{\\mathrm{TEOS}}$ 和 $C_{\\mathrm{M}}$ 表示。然后，使用对数灵敏度定义 $S_{A_i} = \\dfrac{\\partial \\ln r_{\\mathrm{TEOS}}}{\\partial \\ln A_i}$，评估分解速率相对于指前因子 $A_1$、$A_2$ 和 $A_3$ 的灵敏度。\n\n您的程序必须：\n1. 对每个测试用例，使用Arrhenius定律计算 $k_1(T)$、$k_2(T)$ 和 $k_3(T)$。\n2. 使用理想气体定律计算 $C_{\\mathrm{tot}}$、$C_{\\mathrm{TEOS}}$ 和 $C_{\\mathrm{M}}$。\n3. 计算 $r_{\\mathrm{TEOS}}$ (单位为 $\\mathrm{mol\\,m^{-3}\\,s^{-1}}$)。\n4. 计算灵敏度 $S_{A_1}$、$S_{A_2}$ 和 $S_{A_3}$。\n\n测试套件：\n- 案例1 (正常路径): $T = 1000\\ \\mathrm{K}$, $P = 101325\\ \\mathrm{Pa}$, $y_{\\mathrm{TEOS}} = 1.0\\times 10^{-2}$。\n- 案例2 (低压边界): $T = 1000\\ \\mathrm{K}$, $P = 1.0\\times 10^{4}\\ \\mathrm{Pa}$, $y_{\\mathrm{TEOS}} = 1.0\\times 10^{-2}$。\n- 案例3 (高压边界): $T = 1000\\ \\mathrm{K}$, $P = 5.0\\times 10^{5}\\ \\mathrm{Pa}$, $y_{\\mathrm{TEOS}} = 1.0\\times 10^{-2}$。\n- 案例4 (低温变化): $T = 800\\ \\mathrm{K}$, $P = 101325\\ \\mathrm{Pa}$, $y_{\\mathrm{TEOS}} = 1.0\\times 10^{-2}$。\n- 案例5 (稀TEOS标度): $T = 1000\\ \\mathrm{K}$, $P = 101325\\ \\mathrm{Pa}$, $y_{\\mathrm{TEOS}} = 1.0\\times 10^{-5}$。\n\n答案规格：\n- 将 $r_{\\mathrm{TEOS}}$ (单位为 $\\mathrm{mol\\,m^{-3}\\,s^{-1}}$) 表示为浮点数。\n- 将 $S_{A_1}$、$S_{A_2}$、$S_{A_3}$ 表示为浮点数 (无量纲)。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个元素对应一个测试用例，并且本身也是一个方括号括起来的逗号分隔列表，包含四个浮点数，顺序为 $[r_{\\mathrm{TEOS}}, S_{A_1}, S_{A_2}, S_{A_3}]$。例如：$[[\\dots],[\\dots],\\dots]$。",
            "solution": "**步骤1：分解速率 $r_{\\mathrm{TEOS}}$ 的推导**\n\n反应机理由三个基元步骤给出：\n- $S_1$: $\\mathrm{TEOS} + \\mathrm{M} \\xrightarrow{k_1} \\mathrm{TEOS}^\\ast + \\mathrm{M}$ (活化)\n- $S_2$: $\\mathrm{TEOS}^\\ast + \\mathrm{M} \\xrightarrow{k_2} \\mathrm{TEOS} + \\mathrm{M}$ (失活)\n- $S_3$: $\\mathrm{TEOS}^\\ast \\xrightarrow{k_3} \\text{products}$ (分解)\n\n根据质量作用定律，这些基元步骤的速率 (表示为 $w_i$) 为：\n$$w_1 = k_1(T) [\\mathrm{TEOS}] [\\mathrm{M}]$$\n$$w_2 = k_2(T) [\\mathrm{TEOS}^\\ast] [\\mathrm{M}]$$\n$$w_3 = k_3(T) [\\mathrm{TEOS}^\\ast]$$\n其中 $[X]$ 表示物种 $X$ 的摩尔浓度。问题中使用 $C_{\\mathrm{TEOS}}$ 表示 $[\\mathrm{TEOS}]$，$C_{\\mathrm{M}}$ 表示 $[\\mathrm{M}]$。\n\nTEOS的净生成速率 $R_{\\mathrm{TEOS}}$ 由生成它的反应速率之和减去消耗它的反应速率之和给出。\n$$R_{\\mathrm{TEOS}} = \\frac{d[\\mathrm{TEOS}]}{dt} = w_2 - w_1 = k_2 [\\mathrm{TEOS}^\\ast] [\\mathrm{M}] - k_1 [\\mathrm{TEOS}] [\\mathrm{M}]$$\nTEOS的分解速率 $r_{\\mathrm{TEOS}}$ 是其生成速率的负值，因此：\n$$r_{\\mathrm{TEOS}} = -R_{\\mathrm{TEOS}} = k_1 [\\mathrm{TEOS}] [\\mathrm{M}] - k_2 [\\mathrm{TEOS}^\\ast] [\\mathrm{M}]$$\n该表达式包含活化中间体 $\\mathrm{TEOS}^\\ast$ 的浓度。为了找到一个闭式表达式，我们对 $\\mathrm{TEOS}^\\ast$ 应用拟稳态近似 (Pseudo-Steady-State Approximation, PSSA)。这个近似是有效的，因为 $\\mathrm{TEOS}^\\ast$ 是一个高能量、短寿命的物种，可以假设其浓度相对于稳定的反应物和产物来说很小且近似恒定。\nPSSA将中间体的净生成速率设为零：\n$$\\frac{d[\\mathrm{TEOS}^\\ast]}{dt} = w_1 - w_2 - w_3 = 0$$\n$$k_1 [\\mathrm{TEOS}] [\\mathrm{M}] - k_2 [\\mathrm{TEOS}^\\ast] [\\mathrm{M}] - k_3 [\\mathrm{TEOS}^\\ast] = 0$$\n现在我们可以求解中间体的稳态浓度 $[\\mathrm{TEOS}^\\ast]$：\n$$k_1 [\\mathrm{TEOS}] [\\mathrm{M}] = (k_2 [\\mathrm{M}] + k_3) [\\mathrm{TEOS}^\\ast]$$\n$$[\\mathrm{TEOS}^\\ast] = \\frac{k_1 [\\mathrm{TEOS}] [\\mathrm{M}]}{k_2 [\\mathrm{M}] + k_3}$$\nTEOS的分解速率在化学计量上等于产物的生成速率，即 $w_3$。\n$$r_{\\mathrm{TEOS}} = w_3 = k_3 [\\mathrm{TEOS}^\\ast]$$\n代入 $[\\mathrm{TEOS}^\\ast]$ 的表达式，得到最终的速率定律：\n$$r_{\\mathrm{TEOS}} = k_3 \\left( \\frac{k_1 [\\mathrm{TEOS}] [\\mathrm{M}]}{k_2 [\\mathrm{M}] + k_3} \\right) = \\frac{k_1 k_3 [\\mathrm{TEOS}] [\\mathrm{M}]}{k_2 [\\mathrm{M}] + k_3}$$\n使用问题陈述中的记法 ($C_{\\mathrm{TEOS}}$ 和 $C_{\\mathrm{M}}$)：\n$$r_{\\mathrm{TEOS}}(T, C_{\\mathrm{TEOS}}, C_{\\mathrm{M}}) = \\frac{k_1(T) k_3(T) C_{\\mathrm{TEOS}} C_{\\mathrm{M}}}{k_2(T) C_{\\mathrm{M}} + k_3(T)}$$\n\n**步骤2：对数灵敏度 $S_{A_i}$ 的推导**\n\n速率 $r_{\\mathrm{TEOS}}$ 相对于参数 $A_i$ 的对数灵敏度定义为：\n$$S_{A_i} = \\frac{\\partial \\ln r_{\\mathrm{TEOS}}}{\\partial \\ln A_i}$$\n速率常数由Arrhenius定律给出，$k_i = A_i T^{n_i} \\exp(-E_i/(RT))$。由于 $k_i$ 与 $A_i$ 成正比，我们得到一个有用的性质：\n$$\\frac{\\partial \\ln k_j}{\\partial \\ln A_i} = \\frac{A_i}{k_j}\\frac{\\partial k_j}{\\partial A_i} = \\frac{A_i}{k_j} \\left( \\delta_{ij} \\frac{k_j}{A_j} \\right) = \\delta_{ij}$$\n其中 $\\delta_{ij}$ 是Kronecker delta。\n\n为了计算灵敏度，我们首先对速率表达式取自然对数：\n$$\\ln r_{\\mathrm{TEOS}} = \\ln(k_1) + \\ln(k_3) + \\ln(C_{\\mathrm{TEOS}}) + \\ln(C_{\\mathrm{M}}) - \\ln(k_2 C_{\\mathrm{M}} + k_3)$$\n现在我们对 $\\ln A_i$ ($i \\in \\{1, 2, 3\\}$) 求导。\n\n**相对于 $A_1$ 的灵敏度：**\n$$S_{A_1} = \\frac{\\partial (\\ln r_{\\mathrm{TEOS}})}{\\partial \\ln A_1} = \\frac{\\partial (\\ln k_1)}{\\partial \\ln A_1} + 0 + 0 + 0 - 0 = 1$$\n因此，$S_{A_1} = 1$。速率与 $k_1$ 成正比，因此也与 $A_1$ 成正比。\n\n**相对于 $A_2$ 的灵敏度：**\n$$S_{A_2} = \\frac{\\partial (\\ln r_{\\mathrm{TEOS}})}{\\partial \\ln A_2} = 0 + 0 + 0 + 0 - \\frac{\\partial}{\\partial \\ln A_2} \\left[ \\ln(k_2 C_{\\mathrm{M}} + k_3) \\right]$$\n使用链式法则：\n$$S_{A_2} = - \\frac{1}{k_2 C_{\\mathrm{M}} + k_3} \\cdot \\frac{\\partial (k_2 C_{\\mathrm{M}} + k_3)}{\\partial \\ln A_2} = - \\frac{1}{k_2 C_{\\mathrm{M}} + k_3} \\cdot \\left( C_{\\mathrm{M}} \\frac{\\partial k_2}{\\partial \\ln A_2} + \\frac{\\partial k_3}{\\partial \\ln A_2} \\right)$$\n由于 $\\partial k_2 / \\partial \\ln A_2 = k_2$ 且 $\\partial k_3 / \\partial \\ln A_2 = 0$：\n$$S_{A_2} = - \\frac{k_2 C_{\\mathrm{M}}}{k_2 C_{\\mathrm{M}} + k_3}$$\n\n**相对于 $A_3$ 的灵敏度：**\n$$S_{A_3} = \\frac{\\partial (\\ln r_{\\mathrm{TEOS}})}{\\partial \\ln A_3} = \\frac{\\partial (\\ln k_3)}{\\partial \\ln A_3} - \\frac{\\partial}{\\partial \\ln A_3} \\left[ \\ln(k_2 C_{\\mathrm{M}} + k_3) \\right]$$\n$$S_{A_3} = 1 - \\frac{1}{k_2 C_{\\mathrm{M}} + k_3} \\cdot \\frac{\\partial (k_2 C_{\\mathrm{M}} + k_3)}{\\partial \\ln A_3} = 1 - \\frac{1}{k_2 C_{\\mathrm{M}} + k_3} \\cdot \\left( C_{\\mathrm{M}}\\frac{\\partial k_2}{\\partial \\ln A_3} + \\frac{\\partial k_3}{\\partial \\ln A_3}\\right)$$\n由于 $\\partial k_2 / \\partial \\ln A_3 = 0$ 且 $\\partial k_3 / \\partial \\ln A_3 = k_3$：\n$$S_{A_3} = 1 - \\frac{k_3}{k_2 C_{\\mathrm{M}} + k_3} = \\frac{(k_2 C_{\\mathrm{M}} + k_3) - k_3}{k_2 C_{\\mathrm{M}} + k_3}$$\n$$S_{A_3} = \\frac{k_2 C_{\\mathrm{M}}}{k_2 C_{\\mathrm{M}} + k_3}$$\n\n**步骤3：计算步骤**\n\n程序将对每个测试用例 $(T, P, y_{\\mathrm{TEOS}})$ 执行以下步骤：\n1.  计算总摩尔浓度 $C_{\\mathrm{tot}} = P/(RT)$。\n2.  计算TEOS浓度 $C_{\\mathrm{TEOS}} = y_{\\mathrm{TEOS}} C_{\\mathrm{tot}}$ 和碰撞物浓度 $C_{\\mathrm{M}} = C_{\\mathrm{tot}}$。\n3.  使用提供的Arrhenius参数计算速率常数 $k_1(T)$、$k_2(T)$ 和 $k_3(T)$：$k_i(T) = A_i T^{n_i} \\exp(-E_i / (RT))$。\n4.  使用推导出的公式计算分解速率 $r_{\\mathrm{TEOS}}$。\n5.  使用推导出的公式计算灵敏度 $S_{A_1}$、$S_{A_2}$ 和 $S_{A_3}$。$S_{A_1}$ 始终为 $1$。$S_{A_2}$ 和 $S_{A_3}$ 取决于计算出的 $k_2$、$k_3$ 和 $C_{\\mathrm{M}}$ 的值。\n6.  收集所有测试用例的结果 $[r_{\\mathrm{TEOS}}, S_{A_1}, S_{A_2}, S_{A_3}]$，并按指定格式进行格式化。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the decomposition rate of TEOS and its sensitivities to\n    pre-exponential factors based on a Lindemann mechanism.\n    \"\"\"\n    # Define constants and Arrhenius parameters\n    R = 8.314462618  # J mol^-1 K^-1\n\n    # Parameters for S1: TEOS + M -> TEOS* + M\n    A1 = 1.0e-3  # m^3 mol^-1 s^-1\n    n1 = 0.5\n    E1 = 0.0  # J mol^-1\n\n    # Parameters for S2: TEOS* + M -> TEOS + M\n    A2 = 5.0e-2  # m^3 mol^-1 s^-1\n    n2 = 0.5\n    E2 = 0.0  # J mol^-1\n\n    # Parameters for S3: TEOS* -> products\n    A3 = 1.0e13  # s^-1\n    n3 = 0.0\n    E3 = 1.80e5  # J mol^-1\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (T [K], P [Pa], y_TEOS)\n        (1000.0, 101325.0, 1.0e-2),    # Case 1: happy path\n        (1000.0, 1.0e4, 1.0e-2),       # Case 2: low-pressure edge\n        (1000.0, 5.0e5, 1.0e-2),       # Case 3: high-pressure edge\n        (800.0, 101325.0, 1.0e-2),     # Case 4: lower-temperature variation\n        (1000.0, 101325.0, 1.0e-5),    # Case 5: dilute-TEOS scaling\n    ]\n\n    results = []\n    for T, P, y_TEOS in test_cases:\n        # Step 1: Compute concentrations using the ideal gas law.\n        # C_tot = P / (R * T) in mol m^-3\n        C_tot = P / (R * T)\n        # C_TEOS = y_TEOS * C_tot\n        C_TEOS = y_TEOS * C_tot\n        # C_M = C_tot as per problem statement\n        C_M = C_tot\n\n        # Step 2: Compute rate constants using the Arrhenius law.\n        # k_i(T) = A_i * T^n_i * exp(-E_i / (R * T))\n        k1 = A1 * (T ** n1) * np.exp(-E1 / (R * T))\n        k2 = A2 * (T ** n2) * np.exp(-E2 / (R * T))\n        k3 = A3 * (T ** n3) * np.exp(-E3 / (R * T))\n\n        # Step 3: Compute the rate of TEOS decomposition, r_TEOS.\n        # r_TEOS = (k1 * k3 * C_TEOS * C_M) / (k2 * C_M + k3)\n        numerator = k1 * k3 * C_TEOS * C_M\n        denominator = k2 * C_M + k3\n        r_TEOS = numerator / denominator\n\n        # Step 4: Compute the sensitivities S_A1, S_A2, S_A3.\n        # S_A1 = 1\n        S_A1 = 1.0\n        \n        # S_A2 = - (k2 * C_M) / (k2 * C_M + k3)\n        # S_A3 =   (k2 * C_M) / (k2 * C_M + k3)\n        sensitivity_term = (k2 * C_M) / (k2 * C_M + k3)\n        S_A2 = -sensitivity_term\n        S_A3 = sensitivity_term\n\n        # Collect results for this case\n        case_result = [r_TEOS, S_A1, S_A2, S_A3]\n        results.append(case_result)\n\n    # Final print statement in the exact required format.\n    print(str(results).replace(\" \", \"\"))\n```"
        },
        {
            "introduction": "本章的最后一个练习将热力学和动力学知识融为一体，构建了一个完整的反应器模型。这项挑战性的任务要求您模拟一个在半导体制造中非常常见的设备——绝热活塞流反应器（adiabatic plug-flow reactor） 。通过比较一个简化模型与一个考虑了热容随温度变化的更精确模型，您将深刻理解建模的精细程度如何影响对反应器性能（如转化率和出口温度）的预测。",
            "id": "4127914",
            "problem": "您必须编写一个完整且可运行的程序，用于计算在绝热、恒压活塞流反应器中进行硅烷热解时，随温度变化的热容对转化率的影响，并将结果与恒定热容模型进行比较。该物理系统是一个与半导体制造相关的气相反应器，其中硅烷通过单步反应分解，产生氢气并在表面沉积结晶硅。假设以下气相反应和模型假设：\n\n- 气相反应的化学计量：$\\mathrm{SiH_4(g)} \\rightarrow \\mathrm{Si(s)} + 2\\,\\mathrm{H_2(g)}$。\n- 只有气相物质对混合物的热容和能量平衡有贡献。硅沉积在表面上，对气相热容没有贡献。\n- 理想气体、恒定压力和绝热操作。\n- 活塞流反应器模型，轴向坐标取为反应器体积。\n- 硅烷气体的单步一级动力学：$r_A = k(T)\\,C_A$，其中 $C_A$ 是 $\\mathrm{SiH_4}$ 的摩尔浓度， $k(T)$ 服从阿伦尼乌斯定律 $k(T) = A \\exp\\!\\left(-E_a/(R\\,T)\\right)$。\n- 使用理想气体定律，根据总摩尔流量和温度计算每个轴向位置的浓度：$C_i = \\dfrac{F_i\\,P}{R\\,T\\,F_T}$，其中 $F_i$ 是物质 $i$ 的摩尔流量，$F_T = \\sum_i F_i$，$P$ 是总压力，$R$ 是理想气体常数，$T$ 是温度。\n\n用作起点的基本衡算式：\n\n- 各物质 $i$ 的摩尔衡算：$\\dfrac{dF_i}{dV} = \\nu_i r_A$，其中 $V$ 是反应器体积，$\\nu_i$ 是化学计量系数（对于 $\\mathrm{SiH_4}$，$\\nu_A=-1$；对于 $\\mathrm{H_2}$，$\\nu_B=+2$；惰性载气 $\\mathrm{N_2}$ 的 $\\nu_I=0$）。\n- 恒压下的绝热能量衡算：$\\dfrac{dT}{dV} = - \\dfrac{\\Delta H_\\text{rxn}(T)\\,r_A}{\\sum\\limits_{i \\in \\{\\mathrm{SiH_4},\\mathrm{H_2},\\mathrm{N_2}\\}} F_i\\,C_{p,i}(T)}$。\n\n使用的热化学基础和数据：\n\n- 参考温度 $T_\\mathrm{ref} = 298\\,\\mathrm{K}$ 下的标准反应热由标准生成焓给出：$\\Delta H^\\circ_\\text{rxn}(298\\,\\mathrm{K}) = -34300\\,\\mathrm{J/mol}$。您必须通过热容积分来考虑温度依赖性，如下所示：\n$$\n\\Delta H_\\text{rxn}(T) = \\Delta H^\\circ_\\text{rxn}(298\\,\\mathrm{K}) \\;+\\; \\int_{298\\,\\mathrm{K}}^{T} \\left[2\\,C_{p,\\mathrm{H_2}}(T') - C_{p,\\mathrm{SiH_4}}(T')\\right]\\,dT'.\n$$\n\n- 热容 $C_{p,i}(T)$（每摩尔）必须用两种备选模型表示：\n\n  1) 恒定 $C_p$ 模型：对于每种物质 $i \\in \\{\\mathrm{SiH_4},\\mathrm{H_2},\\mathrm{N_2}\\}$，将 $C_{p,i}(T) \\equiv C_{p,i}(T_0)$ 设为入口温度 $T_0$ 下的值（在每次模拟中保持恒定），并保持 $\\Delta H_\\text{rxn}(T) \\equiv \\Delta H^\\circ_\\text{rxn}(298\\,\\mathrm{K})$。\n\n  2) 使用美国国家航空航天局 (NASA) 多项式关联式的可变 $C_p(T)$ 模型。使用无量纲形式 $C_p/R = a_1 + a_2 T + a_3 T^2 + a_4 T^3 + a_5 T^4$，其低温区间和高温区间的系数为分段函数，如下所示（气体常数为 $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$）：\n\n  - 氢气，$\\mathrm{H_2}$：\n    低温范围 $[200,1000]\\,\\mathrm{K}$：\n    $a_1=2.34433112$, $a_2=7.98052075\\times 10^{-3}$, $a_3=-1.94781510\\times 10^{-5}$, $a_4=2.01572094\\times 10^{-8}$, $a_5=-7.37611761\\times 10^{-12}$。\n    高温范围 $[1000,6000]\\,\\mathrm{K}$：\n    $a_1=3.33727920$, $a_2=-4.94024731\\times 10^{-5}$, $a_3=4.99456778\\times 10^{-7}$, $a_4=-1.79566394\\times 10^{-10}$, $a_5=2.00255376\\times 10^{-14}$。\n\n  - 氮气，$\\mathrm{N_2}$：\n    低温范围 $[200,1000]\\,\\mathrm{K}$：\n    $a_1=3.53100528$, $a_2=-1.23660987\\times 10^{-4}$, $a_3=-5.02999433\\times 10^{-7}$, $a_4=2.43530612\\times 10^{-9}$, $a_5=-1.40881235\\times 10^{-12}$。\n    高温范围 $[1000,6000]\\,\\mathrm{K}$：\n    $a_1=2.95257626$, $a_2=1.39690040\\times 10^{-3}$, $a_3=-4.92631603\\times 10^{-7}$, $a_4=7.86010367\\times 10^{-11}$, $a_5=-4.60755321\\times 10^{-15}$。\n\n  - 硅烷，$\\mathrm{SiH_4}$：\n    在整个范围 $[200,2000]\\,\\mathrm{K}$ 内使用恒定多项式近似，即 $C_{p,\\mathrm{SiH_4}}/R = a_1$，其中 $a_1=6.00000000$ 且 $a_2=a_3=a_4=a_5=0$。这是一个退化的 NASA 多项式，它将 $C_{p,\\mathrm{SiH_4}}(T)$ 固定为一个与多原子气体预期量级一致的恒定值，但仍使用 NASA 函数形式。\n\n  对于可变 $C_p(T)$ 模型，使用当前 $T$ 的适当系数集计算 $C_{p,i}(T)$，并根据 $\\Delta H_\\text{rxn}(T)$ 的需要，从多项式表达式中解析地计算 $\\int C_p\\,dT$。\n\n使用的动力学参数：\n- 指前因子 $A = 1.0\\times 10^{13}\\,\\mathrm{s^{-1}}$。\n- 活化能 $E_a = 2.00\\times 10^{5}\\,\\mathrm{J\\,mol^{-1}}$。\n\n待计算的未知数：\n- 对于每个测试用例，在恒定 $C_p$ 模型和可变 $C_p(T)$ 模型下，将 $F_{\\mathrm{SiH_4}}(V)$、$F_{\\mathrm{H_2}}(V)$、$F_{\\mathrm{N_2}}(V)$ 和 $T(V)$ 的耦合常微分方程组从 $V=0$ 积分到 $V=V_\\text{R}$。然后报告：\n  - 出口硅烷转化率 $X \\equiv \\dfrac{F_{\\mathrm{SiH_4},0} - F_{\\mathrm{SiH_4}}(V_\\text{R})}{F_{\\mathrm{SiH_4},0}}$，以小数形式（非百分比）表示。\n  - 出口温度 $T(V_\\text{R})$，单位为开尔文。\n\n初始和操作条件：\n- 理想气体常数：$R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n- 总压力 $P$ 按每个测试用例指定。\n- 入口温度 $T_0$ 按每个测试用例指定。\n- $V=0$ 时的入口摩尔流量：$F_{\\mathrm{SiH_4}}(0)=F_{\\mathrm{SiH_4},0}$，$F_{\\mathrm{H_2}}(0)=0$，$F_{\\mathrm{N_2}}(0)=F_{\\mathrm{N_2},0}$。\n\n数值要求和输出格式：\n- 所有温度以 $\\mathrm{K}$ 表示，所有能量以 $\\mathrm{J}$ 表示，压力以 $\\mathrm{Pa}$ 表示，摩尔流量以 $\\mathrm{mol/s}$ 表示，体积以 $\\mathrm{m^3}$ 表示。\n- 使用适合潜在刚性系统的数值稳定的积分器。\n- 对于每个测试用例，计算并返回一个包含四个数字的列表：$[X_\\text{const}, X_\\text{var}, T_{\\text{out,const}}, T_{\\text{out,var}}]$，其中：\n  - $X_\\text{const}$ 和 $X_\\text{var}$ 分别是恒定 $C_p$ 模型和可变 $C_p(T)$ 模型下的出口转化率，均四舍五入到六位小数。\n  - $T_{\\text{out,const}}$ 和 $T_{\\text{out,var}}$ 分别是恒定 $C_p$ 模型和可变 $C_p(T)$ 模型下的出口温度，单位为 $\\mathrm{K}$，均四舍五入到三位小数。\n- 您的程序应生成单行输出，其中包含结果，格式为由逗号分隔的各用例列表的列表，并用方括号括起来，例如：$[[\\cdots],[\\cdots],\\ldots]$。\n\n要实现的测试套件（每个用例是一个元组 $(P, T_0, F_{\\mathrm{SiH_4},0}, F_{\\mathrm{N_2},0}, V_\\text{R})$）：\n1) $P=2.0\\times 10^{4}\\,\\mathrm{Pa}$, $T_0=900\\,\\mathrm{K}$, $F_{\\mathrm{SiH_4},0}=0.050\\,\\mathrm{mol/s}$, $F_{\\mathrm{N_2},0}=0.950\\,\\mathrm{mol/s}$, $V_\\text{R}=0.050\\,\\mathrm{m^3}$。\n2) $P=2.0\\times 10^{4}\\,\\mathrm{Pa}$, $T_0=700\\,\\mathrm{K}$, $F_{\\mathrm{SiH_4},0}=0.050\\,\\mathrm{mol/s}$, $F_{\\mathrm{N_2},0}=0.950\\,\\mathrm{mol/s}$, $V_\\text{R}=0.050\\,\\mathrm{m^3}$。\n3) $P=2.0\\times 10^{4}\\,\\mathrm{Pa}$, $T_0=1100\\,\\mathrm{K}$, $F_{\\mathrm{SiH_4},0}=0.050\\,\\mathrm{mol/s}$, $F_{\\mathrm{N_2},0}=0.950\\,\\mathrm{mol/s}$, $V_\\text{R}=0.050\\,\\mathrm{m^3}$。\n4) $P=2.0\\times 10^{4}\\,\\mathrm{Pa}$, $T_0=900\\,\\mathrm{K}$, $F_{\\mathrm{SiH_4},0}=0.100\\,\\mathrm{mol/s}$, $F_{\\mathrm{N_2},0}=0.000\\,\\mathrm{mol/s}$, $V_\\text{R}=0.005\\,\\mathrm{m^3}$。\n\n您的程序必须针对两种热容模型求解每个测试用例，计算所要求的输出，并打印一行由对应于四个测试用例的四个列表组成的列表，格式与上述完全一致。不应从标准输入读取任何输入，也不应访问任何文件。",
            "solution": "用户提供了一个化学反应工程领域中定义明确的问题，具体是为硅烷热解过程建立一个绝热、恒压活塞流反应器 (PFR) 的模型。该问题在科学上是合理的、自洽的，并且在算法上是可解的。因此，它被认为是有效的。\n\n问题的核心是求解一个耦合常微分方程 (ODE) 组，该方程组描述了反应器内的摩尔衡算和能量衡算。反应器中任意点（体积 $V$）的系统状态由各物质的摩尔流量和温度组成的向量描述：$y(V) = [F_{\\mathrm{SiH_4}}(V), F_{\\mathrm{H_2}}(V), F_{\\mathrm{N_2}}(V), T(V)]$。\n\n控制方程如下：\n1.  **摩尔衡算**：对于每种物质 $i$，其摩尔流量 $F_i$ 相对于反应器体积 $V$ 的变化由其生成速率给出：\n    $$\n    \\frac{dF_i}{dV} = r_i = \\nu_i r_A\n    $$\n    其中 $r_A$ 是硅烷 ($\\mathrm{SiH_4}$) 的反应速率，$\\nu_i$ 是化学计量系数。对于反应 $\\mathrm{SiH_4(g)} \\rightarrow \\mathrm{Si(s)} + 2\\,\\mathrm{H_2(g)}$，系数为 $\\nu_{\\mathrm{SiH_4}} = -1$，$\\nu_{\\mathrm{H_2}} = +2$，对于惰性氮气载体，$\\nu_{\\mathrm{N_2}} = 0$。\n\n2.  **能量衡算**：对于一个绝热、恒压的 PFR，温度 $T$ 相对于体积 $V$ 的变化为：\n    $$\n    \\frac{dT}{dV} = - \\frac{\\Delta H_\\text{rxn}(T)\\,r_A}{\\sum\\limits_{i} F_i\\,C_{p,i}(T)}\n    $$\n    其中 $\\Delta H_\\text{rxn}(T)$ 是随温度变化的反应热，$F_i$ 是摩尔流量，$C_{p,i}(T)$ 是气相物质的摩尔热容。\n\n反应速率 $r_A$ 服从具有阿伦尼乌斯温度依赖性的一级动力学：\n$$\nr_A = k(T)\\,C_A = \\left(A \\exp\\!\\left(\\frac{-E_a}{R\\,T}\\right)\\right) C_A\n$$\n硅烷的浓度 $C_A$ 使用理想气体定律计算：\n$$\nC_A = \\frac{F_A P}{F_T R T} \\quad \\text{其中 } F_T = F_{\\mathrm{SiH_4}} + F_{\\mathrm{H_2}} + F_{\\mathrm{N_2}}\n$$\n这里，$P$ 是恒定的总压力，$R$ 是理想气体常数，$F_T$ 是总摩尔流量。\n\n该问题要求比较两种热化学模型：\n\n**模型1：恒定热容 (Constant-$C_p$)**\n在这个简化模型中：\n- 每种物质的热容 $C_{p,i}$ 被假定为恒定，并等于其在入口温度 $T_0$ 下的值，即 $C_{p,i}(T) \\equiv C_{p,i}(T_0)$。\n- 反应热被假定为恒定，等于其标准参考值，$\\Delta H_\\text{rxn}(T) \\equiv \\Delta H^\\circ_\\text{rxn}(298\\,\\mathrm{K}) = -34300\\,\\mathrm{J/mol}$。\n\n**模型2：可变热容 (Variable-$C_p(T)$)**\n该模型采用更严谨的方法：\n- 每种物质的热容 $C_{p,i}(T)$ 是温度的函数，使用提供的 NASA 多项式系数计算：\n  $$\n  \\frac{C_{p,i}(T)}{R} = a_1 + a_2 T + a_3 T^2 + a_4 T^3 + a_5 T^4\n  $$\n  对于 $\\mathrm{H_2}$ 和 $\\mathrm{N_2}$，对不同的温度范围使用分段多项式。对于 $\\mathrm{SiH_4}$，给定了一个退化多项式，得到一个恒定值 $C_{p,\\mathrm{SiH_4}} = 6R$。\n- 反应热 $\\Delta H_\\text{rxn}(T)$ 通过基尔霍夫定律来考虑温度效应：\n  $$\n  \\Delta H_\\text{rxn}(T) = \\Delta H^\\circ_\\text{rxn}(298\\,\\mathrm{K}) + \\int_{298\\,\\mathrm{K}}^{T} \\Delta C_p(T')\\,dT'\n  $$\n  其中 $\\Delta C_p(T') = 2\\,C_{p,\\mathrm{H_2}}(T') - C_{p,\\mathrm{SiH_4}}(T')$。该积分从 $C_p$ 多项式解析地计算。对于具有分段多项式的物质（如 $\\mathrm{H_2}$），积分在温度断点 ($1000\\,\\mathrm{K}$) 处分开计算。\n\n为了解决这个问题，我们将使用 Python 中的 `scipy.integrate.solve_ivp` 函数来实现数值解，该函数适用于求解 ODE 系统的初值问题。我们将使用 ‘BDF’（向后微分公式）方法，该方法对于可能因强烈的温度-反应速率耦合而出现的刚性系统具有鲁棒性。\n\n对于由参数 $(P, T_0, F_{\\mathrm{SiH_4},0}, F_{\\mathrm{N_2},0}, V_\\text{R})$ 定义的每个测试用例，我们将：\n1. 定义在 $V=0$ 时的初始状态向量 $y_0 = [F_{\\mathrm{SiH_4},0}, 0, F_{\\mathrm{N_2},0}, T_0]$。\n2. 对恒定 $C_p$ 和可变 $C_p(T)$ 两种模型，将 ODE 系统从 $V=0$ 积分到 $V=V_\\text{R}$。\n3. 根据在 $V=V_\\text{R}$ 处的最终状态，我们计算出口硅烷转化率 $X$ 和出口温度 $T_\\text{out}$。\n4. 转化率定义为 $X = (F_{\\mathrm{SiH_4},0} - F_{\\mathrm{SiH_4,out}}) / F_{\\mathrm{SiH_4},0}$。\n5. 收集两种模型的结果，按规定四舍五入，并格式化为所需的输出结构。\n\n该实现将包括辅助函数，用于根据提供的 NASA 多项式数据准确计算随温度变化的热化学性质（$C_p(T)$ 和 $\\int C_p(T)dT$）。",
            "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\n# Global constants and data\nR = 8.314462618  # J/mol/K\nA_KIN = 1.0e13   # s^-1\nE_A_KIN = 2.0e5  # J/mol\nDH_RXN_REF = -34300.0  # J/mol at 298 K\nT_REF = 298.0      # K\n\nNASA_COEFFS = {\n    'H2': {\n        'low_coeffs': np.array([2.34433112, 7.98052075e-3, -1.94781510e-5, 2.01572094e-8, -7.37611761e-12]),\n        'high_coeffs': np.array([3.33727920, -4.94024731e-5, 4.99456778e-7, -1.79566394e-10, 2.00255376e-14]),\n        'temp_break': 1000.0,\n    },\n    'N2': {\n        'low_coeffs': np.array([3.53100528, -1.23660987e-4, -5.02999433e-7, 2.43530612e-9, -1.40881235e-12]),\n        'high_coeffs': np.array([2.95257626, 1.39690040e-3, -4.92631603e-7, 7.86010367e-11, -4.60755321e-15]),\n        'temp_break': 1000.0,\n    },\n    'SiH4': {\n        'low_coeffs': np.array([6.0, 0.0, 0.0, 0.0, 0.0]),\n        'high_coeffs': None,\n        'temp_break': float('inf'),\n    }\n}\n\ndef get_cp_div_R(species, T):\n    \"\"\"Calculates dimensionless heat capacity Cp/R for a given species and temperature.\"\"\"\n    s_data = NASA_COEFFS[species]\n    if T = s_data['temp_break']:\n        coeffs = s_data['low_coeffs']\n    else:\n        coeffs = s_data['high_coeffs']\n    \n    T_powers = np.array([1, T, T**2, T**3, T**4])\n    return np.dot(coeffs, T_powers)\n\ndef get_cp(species, T):\n    \"\"\"Calculates heat capacity Cp in J/mol/K.\"\"\"\n    return get_cp_div_R(species, T) * R\n\ndef h_poly_div_R(coeffs, T):\n    \"\"\"Calculates the polynomial part of the enthalpy integral, divided by R.\"\"\"\n    T_terms = np.array([T, T**2/2, T**3/3, T**4/4, T**5/5])\n    return np.dot(coeffs, T_terms)\n\ndef get_h_integral(species, T):\n    \"\"\"Calculates the integral of Cp dT from T_REF to T.\"\"\"\n    s_data = NASA_COEFFS[species]\n    \n    if species == 'SiH4': # Degenerate case, Cp is constant\n        return s_data['low_coeffs'][0] * R * (T - T_REF)\n\n    low_coeffs = s_data['low_coeffs']\n    h_ref = h_poly_div_R(low_coeffs, T_REF) * R\n    \n    if T = s_data['temp_break']:\n        return h_poly_div_R(low_coeffs, T) * R - h_ref\n    else:\n        high_coeffs = s_data['high_coeffs']\n        temp_break = s_data['temp_break']\n        \n        h_at_break_low = h_poly_div_R(low_coeffs, temp_break) * R\n        integral_to_break = h_at_break_low - h_ref\n        \n        h_at_break_high = h_poly_div_R(high_coeffs, temp_break) * R\n        h_at_T_high = h_poly_div_R(high_coeffs, T) * R\n        integral_from_break = h_at_T_high - h_at_break_high\n        \n        return integral_to_break + integral_from_break\n\ndef solve():\n    \"\"\"\n    Main function to run test cases and print results.\n    \"\"\"\n    test_cases = [\n        (2.0e4, 900.0, 0.050, 0.950, 0.050),\n        (2.0e4, 700.0, 0.050, 0.950, 0.050),\n        (2.0e4, 1100.0, 0.050, 0.950, 0.050),\n        (2.0e4, 900.0, 0.100, 0.000, 0.005),\n    ]\n\n    results = []\n    for P, T0, F_SiH4_0, F_N2_0, V_R in test_cases:\n        y0 = np.array([F_SiH4_0, 0.0, F_N2_0, T0])\n        v_span = [0, V_R]\n\n        # --- Constant Cp Model ---\n        cp_SiH4_const = get_cp('SiH4', T0)\n        cp_H2_const = get_cp('H2', T0)\n        cp_N2_const = get_cp('N2', T0)\n\n        def pfr_odes_const(V, y):\n            F_SiH4, F_H2, F_N2, T = y\n            F_T = F_SiH4 + F_H2 + F_N2\n            \n            if F_T = 1e-12 or T = 0: return np.zeros(4)\n\n            k = A_KIN * np.exp(-E_A_KIN / (R * T))\n            C_SiH4 = F_SiH4 * P / (F_T * R * T)\n            r_A = k * C_SiH4\n            \n            dF_SiH4_dV = -r_A\n            dF_H2_dV = 2 * r_A\n            dF_N2_dV = 0\n            \n            cp_sum = F_SiH4*cp_SiH4_const + F_H2*cp_H2_const + F_N2*cp_N2_const\n            if abs(cp_sum)  1e-9: cp_sum = 1.0 # Avoid instability\n            \n            dH_rxn = DH_RXN_REF\n            dT_dV = -dH_rxn * r_A / cp_sum\n            \n            return [dF_SiH4_dV, dF_H2_dV, dF_N2_dV, dT_dV]\n\n        sol_const = solve_ivp(pfr_odes_const, v_span, y0, method='BDF', rtol=1e-8, atol=1e-11)\n        \n        F_SiH4_out_const = sol_const.y[0, -1]\n        T_out_const = sol_const.y[3, -1]\n        X_const = (F_SiH4_0 - max(0, F_SiH4_out_const)) / F_SiH4_0 if F_SiH4_0 > 0 else 0.0\n\n        # --- Variable Cp Model ---\n        def pfr_odes_var(V, y):\n            F_SiH4, F_H2, F_N2, T = y\n            F_T = F_SiH4 + F_H2 + F_N2\n            \n            if F_T = 1e-12 or T = 0: return np.zeros(4)\n\n            k = A_KIN * np.exp(-E_A_KIN / (R * T))\n            C_SiH4 = F_SiH4 * P / (F_T * R * T)\n            r_A = k * C_SiH4\n            \n            dF_SiH4_dV = -r_A\n            dF_H2_dV = 2 * r_A\n            dF_N2_dV = 0\n            \n            cp_sum = F_SiH4*get_cp('SiH4', T) + F_H2*get_cp('H2', T) + F_N2*get_cp('N2', T)\n            if abs(cp_sum)  1e-9: cp_sum = 1.0\n            \n            h_int_H2 = get_h_integral('H2', T)\n            h_int_SiH4 = get_h_integral('SiH4', T)\n            dH_rxn = DH_RXN_REF + 2 * h_int_H2 - h_int_SiH4\n            dT_dV = -dH_rxn * r_A / cp_sum\n            \n            return [dF_SiH4_dV, dF_H2_dV, dF_N2_dV, dT_dV]\n\n        sol_var = solve_ivp(pfr_odes_var, v_span, y0, method='BDF', rtol=1e-8, atol=1e-11)\n\n        F_SiH4_out_var = sol_var.y[0, -1]\n        T_out_var = sol_var.y[3, -1]\n        X_var = (F_SiH4_0 - max(0, F_SiH4_out_var)) / F_SiH4_0 if F_SiH4_0 > 0 else 0.0\n        \n        results.append([\n            round(X_const, 6),\n            round(X_var, 6),\n            round(T_out_const, 3),\n            round(T_out_var, 3)\n        ])\n    \n    print(str(results).replace(\" \", \"\"))\n\nsolve()\n```"
        }
    ]
}