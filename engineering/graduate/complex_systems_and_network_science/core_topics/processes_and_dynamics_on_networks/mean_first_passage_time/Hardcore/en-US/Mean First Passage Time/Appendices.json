{
    "hands_on_practices": [
        {
            "introduction": "Mastering the concept of Mean First Passage Time (MFPT) begins with the foundational technique of first-step analysis. This practice challenges you to derive the MFPT for the simplest non-trivial system: a two-state continuous-time Markov chain, which could represent a reversible chemical reaction . By conditioning on the outcome of the process over an infinitesimal time interval, you will construct and solve the governing equation, revealing how the MFPT relates directly to the transition rate out of the initial state.",
            "id": "2654448",
            "problem": "Consider a reversible unimolecular reaction network with $2$ states, labeled $1$ and $2$, representing chemical species interconversion $X_1 \\rightleftharpoons X_2$. The dynamics are modeled as a continuous-time Markov chain (CTMC) with constant transition rates $k_{12}$ from state $1$ to state $2$ and $k_{21}$ from state $2$ to state $1$. Assume the standard Markov jump process assumptions: exponentially distributed waiting times with parameters equal to the sum of outgoing rates from the current state, and memoryless transitions.\n\nDefine the mean first passage time (MFPT) $T_i$ to be the expected time to reach state $2$ for the first time when starting in state $i$. Using first-step analysis grounded in the definition of exponential waiting times and the Markov property, derive an equation for $T_1$ and solve it to obtain a closed-form expression in terms of $k_{12}$ and $k_{21}$. Clearly state any boundary condition you impose and justify it physically.\n\nExpress your final answer for $T_1$ in seconds, in terms of $k_{12}$ and $k_{21}$, as a single closed-form analytic expression. Do not round.",
            "solution": "The problem statement is subjected to validation before a solution is attempted.\n\nFirst, the givens are extracted verbatim from the problem statement:\n- A reversible unimolecular reaction network with $2$ states, labeled $1$ and $2$.\n- The network represents the interconversion $X_1 \\rightleftharpoons X_2$.\n- The dynamics are modeled as a continuous-time Markov chain (CTMC).\n- The transition rate from state $1$ to state $2$ is a constant, $k_{12}$.\n- The transition rate from state $2$ to state $1$ is a constant, $k_{21}$.\n- Standard Markov jump process assumptions apply: exponentially distributed waiting times and memoryless transitions.\n- The mean first passage time (MFPT), $T_i$, is the expected time to reach state $2$ for the first time, starting from state $i$.\n- The task is to derive an equation for $T_1$ using first-step analysis and solve it.\n\nSecond, the problem is validated against the required criteria.\n- **Scientifically Grounded:** The problem is based on the standard theory of continuous-time Markov chains, a fundamental tool in chemical kinetics and stochastic processes. The concept of mean first passage time and its derivation via first-step analysis are standard, well-established procedures. The problem is scientifically sound.\n- **Well-Posed:** The problem provides a complete description of a two-state CTMC and asks for a specific, calculable quantity ($T_1$). All necessary parameters ($k_{12}$) are provided for this calculation. The problem is well-posed and admits a unique solution.\n- **Objective:** The problem is stated using precise, unambiguous mathematical and scientific terminology. It is free from subjective or speculative content.\n\nThe problem does not violate any of the specified invalidity criteria. It is a standard, formalizable problem in chemical kinetics. The rate $k_{21}$ is specified but is ultimately irrelevant to the calculation of the first passage time *to* state $2$, as the process is defined to stop upon first arrival at this target state. This does not constitute a contradiction but is a common feature of such problems, testing the student's ability to identify relevant information.\n\nThe verdict is that the problem is **valid**. A solution will be provided.\n\nThe objective is to find the mean first passage time (MFPT) to state $2$, given the system starts in state $1$. Let the state of the system at time $t$ be $X(t) \\in \\{1, 2\\}$. The MFPT from state $i$ to state $j$ is denoted $T_{i \\to j}$. Here, we are interested in $T_{1 \\to 2}$, which the problem denotes as $T_1$. Formally, $T_i = E[\\tau_2 | X(0) = i]$, where $\\tau_2 = \\inf\\{t \\ge 0 : X(t) = 2\\}$ is the first passage time to state $2$.\n\nThe methodology employed will be first-step analysis, which conditions on the first event in an infinitesimal time interval $\\Delta t$.\n\nFirst, we establish the boundary condition. The problem asks for the expected time to reach state $2$ for the first time. If the process starts in state $2$ (i.e., $i=2$), it has already reached the target state at time $t=0$. Therefore, the time taken is zero. The boundary condition is:\n$$T_2 = 0$$\n\nNow, we derive an equation for $T_1$. Consider the system starting in state $1$ at time $t=0$. We analyze the process over a small time interval $[0, \\Delta t]$. According to the properties of a CTMC, the probability of a transition from state $1$ to state $2$ during this interval is $k_{12} \\Delta t + o(\\Delta t)$, where $o(\\Delta t)$ represents terms that go to zero faster than $\\Delta t$. The probability of remaining in state $1$ is correspondingly $1 - k_{12} \\Delta t + o(\\Delta t)$.\n\nBy the law of total expectation, we can write $T_1$ as the sum of the expected outcomes conditioned on what happens in the first interval $\\Delta t$:\n$$T_1 = E[\\tau_2 | \\text{jump to } 2 \\text{ in } \\Delta t] P(\\text{jump to } 2 \\text{ in } \\Delta t) + E[\\tau_2 | \\text{no jump in } \\Delta t] P(\\text{no jump in } \\Delta t)$$\n\nLet's analyze each term:\n1. If a jump from state $1$ to state $2$ occurs within $\\Delta t$, the time elapsed is approximately $\\Delta t$. Once in state $2$, the remaining expected time to reach state $2$ is $T_2$. The total expected time in this case is $\\Delta t + T_2$.\n2. If no jump occurs, the time elapsed is $\\Delta t$. Due to the memoryless property of the Markov process, the system is still in state $1$, and the remaining expected time to reach state $2$ from this point onward is again $T_1$. The total expected time in this case is $\\Delta t + T_1$.\n\nSubstituting these into the equation with their respective probabilities gives:\n$$T_1 = (\\Delta t + T_2)(k_{12} \\Delta t + o(\\Delta t)) + (\\Delta t + T_1)(1 - k_{12} \\Delta t + o(\\Delta t))$$\n\nNow, we substitute the boundary condition $T_2=0$:\n$$T_1 = (\\Delta t)(k_{12} \\Delta t + o(\\Delta t)) + (\\Delta t + T_1)(1 - k_{12} \\Delta t + o(\\Delta t))$$\nExpanding the expression:\n$$T_1 = k_{12} (\\Delta t)^2 + \\Delta t \\cdot o(\\Delta t) + \\Delta t + T_1 - k_{12} T_1 \\Delta t + \\Delta t \\cdot o(\\Delta t) + T_1 \\cdot o(\\Delta t)$$\nWe collect terms and recognize that $(\\Delta t)^2$ terms and $o(\\Delta t)$ terms are of higher order and can be consolidated into a single $o(\\Delta t)$ term:\n$$T_1 = T_1 + \\Delta t - k_{12} T_1 \\Delta t + o(\\Delta t)$$\nSubtracting $T_1$ from both sides yields:\n$$0 = \\Delta t - k_{12} T_1 \\Delta t + o(\\Delta t)$$\nDividing the entire equation by $\\Delta t$ (for $\\Delta t \\neq 0$):\n$$0 = 1 - k_{12} T_1 + \\frac{o(\\Delta t)}{\\Delta t}$$\nTaking the limit as $\\Delta t \\to 0$, the term $\\frac{o(\\Delta t)}{\\Delta t}$ goes to $0$ by definition. This yields the final linear equation for $T_1$:\n$$1 - k_{12} T_1 = 0$$\nThis is the equation for $T_1$ requested by the problem. Solving for $T_1$ is trivial:\n$$k_{12} T_1 = 1$$\n$$T_1 = \\frac{1}{k_{12}}$$\n\nThis result is physically intuitive. The system is in state $1$, and the only escape pathway leads to the target state $2$. The waiting time in state $1$ is exponentially distributed with rate parameter $k_{12}$. The mean of this exponential distribution is $1/k_{12}$. Therefore, the average time to leave state $1$ (and thus arrive at state $2$ for the first time) is precisely $1/k_{12}$. The rate $k_{21}$ is irrelevant because the process is defined to stop once state $2$ is reached, making it an absorbing state for this specific calculation. If the rates $k_{12}$ and $k_{21}$ have units of inverse seconds ($s^{-1}$), then $T_1$ will have units of seconds.",
            "answer": "$$\\boxed{\\frac{1}{k_{12}}}$$"
        },
        {
            "introduction": "Random walks on networks often produce counter-intuitive results, and exploring them is key to developing a robust understanding. This exercise guides you through one such paradox: how adding a PageRank-style teleportation mechanism, typically used to accelerate mixing, can sometimes dramatically increase the Mean First Passage Time (MFPT) to a specific target . By setting up and solving the system of linear equations for a carefully designed network with a \"trap,\" you will gain a deeper appreciation for how the interplay between network topology and walker dynamics governs transport efficiency.",
            "id": "4286948",
            "problem": "Consider a discrete-time random walk on a directed network with nodes $\\{t, v, a, b\\}$, where the target node $t$ is absorbing. At each step, with probability $1-\\alpha$, the walker follows an outgoing edge chosen uniformly at random; with probability $\\alpha$, the walker teleports to a node according to a fixed personalization distribution $q$. The teleportation is a PageRank-style mechanism with no memory of the past and is independent of the current node. The Mean First Passage Time (MFPT) from a starting node $i$ to the absorbing target $t$ is defined as the expected number of steps to reach $t$ for the first time starting from $i$, under the dynamics described.\n\nThe network and dynamics are specified as follows:\n- Node $t$ is absorbing.\n- Node $v$ has outgoing edges to $t$ and $a$, and no other outgoing edges.\n- Node $a$ has an outgoing edge only to node $b$.\n- Node $b$ has an outgoing edge only to node $v$.\n- The teleportation personalization distribution $q$ assigns zero mass to $t$ and $v$, with $q_{a} = q_{b} = \\frac{1}{2}$.\n\nTasks:\n1. Using only first principles for Markov chains and the definition of Mean First Passage Time (MFPT), explain structural conditions under which the addition of teleportation can paradoxically increase MFPT to certain low-degree targets. Your explanation must reason from the interplay of gateway nodes, degree heterogeneity, and the support of $q$, not by invoking any pre-provided shortcut formulas.\n2. For the concrete network and teleportation scheme described above, compute the MFPT from node $v$ to the absorbing target $t$ when $\\alpha = \\frac{3}{10}$. Express the final MFPT as an exact rational number. Do not round.",
            "solution": "The problem is evaluated as scientifically sound, self-contained, well-posed, and free of any of the specified invalidating flaws. It is a valid problem in the theory of stochastic processes on networks.\n\nThe problem consists of two parts. The first task is to provide a conceptual explanation for a known phenomenon in network science. The second is to perform a specific calculation for a given network.\n\n**Part 1: Conceptual Explanation**\n\nThe Mean First Passage Time (MFPT) from a starting node $i$ to an absorbing target node $t$, denoted $m_i$, is governed by the fundamental recurrence relation. For a general discrete-time Markov process with transition probabilities $P'_{ij}$ from node $i$ to node $j$, the MFPTs to an absorbing state $t$ (where $m_t = 0$) satisfy the equation:\n$$m_i = 1 + \\sum_{j} P'_{ij} m_j$$\nfor all non-target nodes $i$. The term `$1$` accounts for the current step being taken, and the summation represents the expected future steps from the next state $j$, averaged over all possible next states.\n\nIn the given problem, the transition mechanism is a convex combination of a standard random walk and a teleportation event. Let $P_{ij}$ be the probability of transitioning from $i$ to $j$ under a standard random walk, where an outgoing edge is chosen uniformly at random. For a node $i$ with out-degree $k_{out}(i)$, $P_{ij} = 1/k_{out}(i)$ if there is an edge from $i$ to $j$, and $P_{ij} = 0$ otherwise. The teleportation occurs with probability $\\alpha$ to a node $j$ selected according to a personalization distribution $q_j$. The composite transition probability $P'_{ij}$ is therefore:\n$$P'_{ij} = (1-\\alpha) P_{ij} + \\alpha q_j$$\n\nSubstituting this into the MFPT equation gives:\n$$m_i = 1 + \\sum_j \\left( (1-\\alpha) P_{ij} + \\alpha q_j \\right) m_j = 1 + (1-\\alpha)\\sum_j P_{ij} m_j + \\alpha \\sum_j q_j m_j$$\nLet us denote the expected MFPT under the teleportation distribution as $\\langle m \\rangle_q = \\sum_j q_j m_j$. This term is independent of the starting node $i$. The equation becomes:\n$$m_i = 1 + (1-\\alpha) \\left( \\sum_{j} P_{ij} m_j \\right) + \\alpha \\langle m \\rangle_q$$\n\nThe paradox of an increased MFPT due to teleportation—a mechanism often associated with accelerating mixing times—can be explained by the interplay of three structural factors mentioned:\n\n1.  **Gateway Nodes:** A network can possess \"gateway\" nodes, which are essential choke points providing fast paths to the target. In the given problem, node $v$ is a gateway node because it is the only transient node with a direct edge to the absorbing target $t$. A random walker reaching $v$ has a non-zero probability of reaching the target in the next step, without teleportation.\n\n2.  **Network Heterogeneity and Trapping Regions:** The network structure is not uniform. It contains both a fast path to the target (from the gateway $v$) and a \"slow\" region, in this case, the cycle $a \\to b \\to v$. If a walker is at node $a$ or $b$, it is guaranteed to take at least two steps ($a \\to b \\to v$) just to return to the gateway node $v$, from which it can access the target. Such regions can act as traps.\n\n3.  **Support of the Teleportation Distribution $q$:** The crucial element is where the teleportation directs the walker. The paradoxical increase in MFPT occurs when the distribution $q$ is structured to be detrimental to the goal of reaching the target. This happens if $q$ concentrates its probability mass on nodes that are \"far\" from the target, while assigning little or no mass to the target itself or to the gateway nodes. In this problem, $q_t=0$ and $q_v=0$, but $q_a=1/2$ and $q_b=1/2$. This means a teleportation event will never take the walker directly to the target or to the gateway node. Instead, it will always place the walker in the slow trapping region, at nodes $a$ or $b$.\n\nThe paradox arises when starting from a \"good\" node, such as the gateway $v$. Without teleportation ($\\alpha=0$), the walker at $v$ has a $1/2$ probability of reaching $t$ in one step. With teleportation ($\\alpha0$), there is a probability $\\alpha$ that this beneficial random walk step is interrupted. The walker is instead forced to teleport to either $a$ or $b$. From either of these nodes, it must traverse the cycle to get back to $v$. This forced detour adds multiple steps to the expected path length. While the random walk component from $v$ is still present with probability $1-\\alpha$, the introduction of a guaranteed \"bad jump\" with probability $\\alpha$ can increase the total expected time. If the penalty in time incurred by teleporting to the trapping region is sufficiently large, it will outweigh the benefit of the direct path from the gateway, leading to an overall increase in the MFPT from that gateway node. The low degree of the target is a common feature that creates such gateway structures, as it limits the number of entry points to the target.\n\n**Part 2: Calculation of MFPT**\n\nWe are asked to compute the MFPT from node $v$ to $t$, which we denote $m_v$. We must also find the MFPTs from the other transient nodes, $m_a$ and $m_b$. The MFPT from the absorbing target is $m_t = 0$. The parameter for teleportation is $\\alpha = 3/10$.\n\nThe system of linear equations for the MFPTs is:\n$$m_i = 1 + \\sum_{j \\in \\{t,v,a,b\\}} P'_{ij} m_j \\quad \\text{for } i \\in \\{v, a, b\\}$$\nThe transition probabilities $P'_{ij} = (1-\\alpha) P_{ij} + \\alpha q_j$ are calculated for each starting node $i$.\n\n**Equation for $m_v$:**\nThe out-neighbors of $v$ for the random walk are $t$ and $a$, so $P_{vt} = P_{va} = 1/2$.\n$m_v = 1 + P'_{vt} m_t + P'_{vv} m_v + P'_{va} m_a + P'_{vb} m_b$\nWith $m_t=0$, $\\alpha=3/10$, $q=(q_t,q_v,q_a,q_b)=(0,0,1/2,1/2)$, and $1-\\alpha=7/10$:\n$P'_{vt} = (7/10)(1/2) + (3/10)(0) = 7/20$\n$P'_{vv} = (7/10)(0) + (3/10)(0) = 0$\n$P'_{va} = (7/10)(1/2) + (3/10)(1/2) = (7/20) + (3/20) = 10/20 = 1/2$\n$P'_{vb} = (7/10)(0) + (3/10)(1/2) = 3/20$\nThe equation for $m_v$ is:\n$m_v = 1 + (0)m_v + (1/2)m_a + (3/20)m_b \\implies m_v = 1 + \\frac{1}{2}m_a + \\frac{3}{20}m_b$ (1)\n\n**Equation for $m_a$:**\nThe out-neighbor of $a$ is $b$, so $P_{ab} = 1$.\n$m_a = 1 + P'_{at} m_t + P'_{av} m_v + P'_{aa} m_a + P'_{ab} m_b$\n$P'_{aa} = (7/10)(0) + (3/10)(1/2) = 3/20$\n$P'_{ab} = (7/10)(1) + (3/10)(1/2) = 7/10 + 3/20 = 14/20 + 3/20 = 17/20$\nThe equation for $m_a$ is:\n$m_a = 1 + (3/20)m_a + (17/20)m_b$\n$m_a(1 - 3/20) = 1 + (17/20)m_b$\n$m_a(17/20) = 1 + (17/20)m_b \\implies m_a = \\frac{20}{17} + m_b$ (2)\n\n**Equation for $m_b$:**\nThe out-neighbor of $b$ is $v$, so $P_{bv} = 1$.\n$m_b = 1 + P'_{bt} m_t + P'_{bv} m_v + P'_{ba} m_a + P'_{bb} m_b$\n$P'_{bv} = (7/10)(1) + (3/10)(0) = 7/10$\n$P'_{ba} = (7/10)(0) + (3/10)(1/2) = 3/20$\n$P'_{bb} = (7/10)(0) + (3/10)(1/2) = 3/20$\nThe equation for $m_b$ is:\n$m_b = 1 + (7/10)m_v + (3/20)m_a + (3/20)m_b$\n$m_b(1-3/20) = 1 + (7/10)m_v + (3/20)m_a$\n$m_b(17/20) = 1 + \\frac{7}{10}m_v + \\frac{3}{20}m_a$ (3)\n\nNow we solve this system of three linear equations.\nSubstitute Eq. (2) into Eq. (3):\n$\\frac{17}{20}m_b = 1 + \\frac{7}{10}m_v + \\frac{3}{20}(\\frac{20}{17} + m_b)$\n$\\frac{17}{20}m_b = 1 + \\frac{7}{10}m_v + \\frac{3}{17} + \\frac{3}{20}m_b$\n$(\\frac{17}{20} - \\frac{3}{20})m_b = (1 + \\frac{3}{17}) + \\frac{7}{10}m_v$\n$\\frac{14}{20}m_b = \\frac{20}{17} + \\frac{7}{10}m_v$\n$\\frac{7}{10}m_b = \\frac{20}{17} + \\frac{7}{10}m_v$\nMultiplying by $10/7$:\n$m_b = \\frac{10}{7}\\left(\\frac{20}{17} + \\frac{7}{10}m_v\\right) = \\frac{200}{119} + m_v$ (4)\n\nNow substitute Eq. (2) and Eq. (4) into Eq. (1) to solve for $m_v$:\nFirst, express $m_a$ in terms of $m_v$ using (2) and (4):\n$m_a = \\frac{20}{17} + m_b = \\frac{20}{17} + (\\frac{200}{119} + m_v) = \\frac{20 \\cdot 7}{17 \\cdot 7} + \\frac{200}{119} + m_v = \\frac{140}{119} + \\frac{200}{119} + m_v = \\frac{340}{119} + m_v$\n\nSubstitute the expressions for $m_a$ and $m_b$ into Eq. (1):\n$m_v = 1 + \\frac{1}{2}(\\frac{340}{119} + m_v) + \\frac{3}{20}(\\frac{200}{119} + m_v)$\n$m_v = 1 + \\frac{170}{119} + \\frac{1}{2}m_v + \\frac{30}{119} + \\frac{3}{20}m_v$\nCombine the constant terms:\n$1 + \\frac{170}{119} + \\frac{30}{119} = \\frac{119}{119} + \\frac{170}{119} + \\frac{30}{119} = \\frac{119+170+30}{119} = \\frac{319}{119}$\nCombine the $m_v$ terms on the right-hand side:\n$\\frac{1}{2}m_v + \\frac{3}{20}m_v = (\\frac{10}{20} + \\frac{3}{20})m_v = \\frac{13}{20}m_v$\nThe equation for $m_v$ becomes:\n$m_v = \\frac{319}{119} + \\frac{13}{20}m_v$\n$m_v - \\frac{13}{20}m_v = \\frac{319}{119}$\n$m_v (1 - \\frac{13}{20}) = \\frac{319}{119}$\n$m_v (\\frac{7}{20}) = \\frac{319}{119}$\n$m_v = \\frac{319}{119} \\cdot \\frac{20}{7}$\nSince $119 = 7 \\cdot 17$ and $319 = 11 \\cdot 29$, there are no common factors.\n$m_v = \\frac{319 \\cdot 20}{119 \\cdot 7} = \\frac{6380}{833}$.\nThis fraction is irreducible.",
            "answer": "$$\\boxed{\\frac{6380}{833}}$$"
        },
        {
            "introduction": "While analytical solutions are powerful for small, stylized networks, many insights in network science come from computational experiments on larger ensembles. This hands-on programming task guides you through an exploration of the celebrated \"small-world\" effect on transport time . You will implement a simulation to show how adding just a few random shortcuts to a regular lattice drastically reduces both the graph diameter and the average Mean First Passage Time, $\\langle T \\rangle$, providing a concrete demonstration of how local structural changes can have profound global consequences on dynamics.",
            "id": "4286927",
            "problem": "You are given a family of undirected graphs constructed by starting from a one-dimensional periodic lattice (a ring) and then adding a small number of randomly placed shortcut edges. Consider a discrete-time simple random walk on such a graph: at each time step, the walker at node $i$ chooses uniformly at random one of its neighbors and moves there. The quantity of interest is the Mean First Passage Time (MFPT), defined as the expected number of steps required for the random walk to hit a target node for the first time when starting from a specified source node. Formally, the Mean First Passage Time (MFPT) from node $i$ to node $j$ is the expectation of the hitting time $T_{ij}$, where $T_{ij}$ is the first time $t$ such that the position of the random walk equals $j$ given that the initial position equals $i$. The average MFPT over all ordered source-target pairs is denoted by $\\langle T \\rangle$ and is the average of $T_{ij}$ over all ordered pairs $(i,j)$ with $i \\neq j$.\n\nYour task is to implement a complete program that:\n- Constructs a ring lattice graph on $N$ nodes, with undirected edges connecting node $i$ to nodes $(i-1) \\bmod N$ and $(i+1) \\bmod N$.\n- Adds $m$ shortcut edges by selecting $m$ unordered pairs of distinct nodes uniformly at random without replacement from all non-adjacent pairs not already connected by an edge in the lattice, and inserts undirected edges between each selected pair. Each test case specifies a random seed to make the shortcut selections reproducible.\n- For each resulting graph, computes:\n    1. The average Mean First Passage Time $\\langle T \\rangle$ over all ordered pairs of distinct nodes $(i,j)$ for the discrete-time simple random walk on the graph.\n    2. The average geodesic length $\\langle d \\rangle$, defined as the average of the shortest path distance $d(i,j)$ over all ordered pairs $(i,j)$ with $i \\neq j$ using unweighted edges.\n    3. The graph diameter $D$, defined as the maximum of $d(i,j)$ over all unordered pairs $\\{i,j\\}$.\n\nFundamental base for computation:\n- Treat the random walk as a time-homogeneous Markov chain with transition matrix $P = (p_{ij})$, where $p_{ij}$ equals the probability to move from node $i$ to node $j$ in one step and $p_{ij} = A_{ij}/k_i$ for adjacency matrix $A$ and degree $k_i$ of node $i$.\n- Define the hitting time from $i$ to $j$ as the first time the chain visits $j$ when started at $i$. The MFPT is its expectation.\n- Use only the fundamental definitions of Markov chains and absorbing states to construct a computational method to obtain $\\langle T \\rangle$; do not assume any specialized shortcut formulas.\n\nNumerical details and units:\n- Time is measured in discrete steps of the random walk. Report $\\langle T \\rangle$ as a real number in units of \"steps.\"\n- Distances are measured as numbers of edges in the shortest path. Report $\\langle d \\rangle$ as a real number and $D$ as an integer.\n\nTest suite:\n- Case $1$: $N = 60$, $m = 0$, seed $= 1$.\n- Case $2$: $N = 60$, $m = 3$, seed $= 1$.\n- Case $3$: $N = 90$, $m = 0$, seed $= 2$.\n- Case $4$: $N = 90$, $m = 4$, seed $= 2$.\n- Case $5$: $N = 90$, $m = 1$, seed $= 42$.\n\nProgram requirements:\n- For each test case, construct the graph as specified, compute $\\langle T \\rangle$, $\\langle d \\rangle$, and $D$, and aggregate the results in the prescribed output format.\n- The final output format must be a single line containing a comma-separated list of per-case results enclosed in square brackets. Each per-case result must itself be a list of three values in the order $[\\langle T \\rangle,\\langle d \\rangle,D]$. For example: $[[t_1,d_1,D_1],[t_2,d_2,D_2],\\ldots]$.\n- Express $\\langle T \\rangle$ and $\\langle d \\rangle$ as decimal floating-point numbers, and $D$ as an integer. The numeric values must be printed without additional units.\n\nYour implementation must be entirely self-contained and runnable as-is. No external input is permitted. The program should use reproducible randomness based on the provided seeds and should not depend on any external files or network access. The program must compute all quantities exactly for the given test suite and print only the single-line final output in the specified format.",
            "solution": "The problem is well-posed and grounded in the established principles of graph theory and the theory of Markov chains. It asks for the computation of key network metrics—average geodesic distance, diameter, and average Mean First Passage Time—for a class of graphs known as small-world networks. The solution proceeds by first constructing the specified graph, then computing the required metrics based on fundamental definitions.\n\nThe computational process is divided into three main parts: graph construction, calculation of geodesic path metrics, and calculation of the Mean First Passage Time.\n\n**1. Graph Construction**\n\nFor each test case, we are given the number of nodes $N$, the number of shortcuts $m$, and a random seed for reproducibility. An undirected graph is represented by its adjacency matrix $A$, an $N \\times N$ symmetric matrix where $A_{ij}=1$ if an edge exists between nodes $i$ and $j$, and $A_{ij}=0$ otherwise.\n\nFirst, a one-dimensional periodic lattice (a ring) is constructed. This is achieved by creating edges between each node $i$ and its neighbors $(i-1) \\pmod N$ and $(i+1) \\pmod N$, for all $i \\in \\{0, 1, \\dots, N-1\\}$.\n\nNext, $m$ shortcut edges are added. The set of all possible unordered pairs of non-adjacent nodes is generated. From this set, $m$ pairs are selected uniformly at random without replacement, using a random number generator seeded with the value specified in the test case. For each selected pair $\\{u,v\\}$, the corresponding entries in the adjacency matrix are updated such that $A_{uv} = A_{vu} = 1$. The resulting matrix $A$ represents the final graph for which the metrics will be computed.\n\n**2. Geodesic Path Metrics: Diameter ($D$) and Average Distance ($\\langle d \\rangle$)**\n\nThe geodesic distance $d(i,j)$ between two nodes $i$ and $j$ in an unweighted graph is the number of edges in a shortest path connecting them. These distances can be systematically computed for all pairs of nodes by executing a Breadth-First Search (BFS) algorithm starting from each node in the graph. The result of this all-pairs shortest path computation is a distance matrix $\\mathbf{D}$ where the entry $\\mathbf{D}_{ij} = d(i,j)$.\n\nFrom the distance matrix $\\mathbf{D}$, the required metrics are calculated as follows:\n- The graph diameter $D$ is the greatest distance between any two nodes in the graph. Since the graph is undirected, $d(i,j) = d(j,i)$, and the diameter is the maximum value in the distance matrix:\n$$ D = \\max_{i,j} d(i,j) $$\n- The average geodesic length $\\langle d \\rangle$ is the mean of the shortest path distances over all ordered pairs of distinct nodes. It is computed by summing all off-diagonal elements of the distance matrix and dividing by the total number of such pairs, $N(N-1)$:\n$$ \\langle d \\rangle = \\frac{1}{N(N-1)} \\sum_{i=0}^{N-1} \\sum_{j=0, j \\neq i}^{N-1} d(i,j) $$\n\n**3. Mean First Passage Time ($\\langle T \\rangle$)**\n\nThe simple random walk on the graph is a discrete-time Markov chain. The state space is the set of nodes $\\{0, 1, \\dots, N-1\\}$. The transition probability $P_{ij}$ of moving from node $i$ to node $j$ is non-zero only if an edge connects them, in which case it is $1/k_i$, where $k_i = \\sum_j A_{ij}$ is the degree of node $i$. The transition matrix is thus $P = (P_{ij})$ with $P_{ij} = A_{ij}/k_i$.\n\nThe Mean First Passage Time (MFPT) $T_{ij}$ is the expected number of steps to first reach target node $j$ starting from source node $i$. The problem requires its computation from fundamental principles. This is achieved by considering a modified process where the target node $j$ is an absorbing state.\n\nFor a fixed target node $j$, the MFPT from any other node $i \\neq j$ to $j$ satisfies the following recurrence relation, obtained by conditioning on the first step of the walk:\n$$ T_{ij} = 1 + \\sum_{k=0}^{N-1} P_{ik} T_{kj} $$\nThis equation states that the time to reach $j$ from $i$ is $1$ step plus the expected remaining time from the new node $k$. We use the boundary condition that the time to reach the target from the target itself is zero, $T_{jj} = 0$.\n\nFor a fixed target $j$, this defines a system of $N-1$ linear equations for the $N-1$ unknown values $\\{T_{ij} | i \\neq j\\}$. Let $S' = \\{0, 1, \\dots, N-1\\} \\setminus \\{j\\}$ be the set of transient (non-target) states. For any $i \\in S'$, the equation is:\n$$ T_{ij} = 1 + \\sum_{k \\in S'} P_{ik} T_{kj} + P_{ij}T_{jj} = 1 + \\sum_{k \\in S'} P_{ik} T_{kj} $$\nRearranging the terms, we get:\n$$ T_{ij} - \\sum_{k \\in S'} P_{ik} T_{kj} = 1, \\quad \\forall i \\in S' $$\nThis can be expressed in matrix form. Let $\\mathbf{t}_j$ be the column vector of size $N-1$ containing the values $T_{ij}$ for all $i \\in S'$. Let $Q_j$ be the $(N-1) \\times (N-1)$ sub-matrix of $P$ corresponding to transitions between the transient states in $S'$. The system of equations becomes:\n$$ \\mathbf{t}_j - Q_j \\mathbf{t}_j = \\mathbf{1} $$\nwhere $\\mathbf{1}$ is a column vector of ones of size $N-1$. This can be written as:\n$$ (I - Q_j) \\mathbf{t}_j = \\mathbf{1} $$\nwhere $I$ is the $(N-1) \\times (N-1)$ identity matrix.\n\nThe vector of MFPTs to target $j$, $\\mathbf{t}_j$, is found by solving this system of linear equations. For numerical stability and efficiency, this is preferable to computing the matrix inverse $(I-Q_j)^{-1}$ directly. This procedure is repeated for each of the $N$ possible target nodes $j \\in \\{0, 1, \\dots, N-1\\}$, allowing us to populate the full MFPT matrix $\\mathbf{T} = (T_{ij})$.\n\nFinally, the average Mean First Passage Time $\\langle T \\rangle$ is calculated by averaging $T_{ij}$ over all $N(N-1)$ ordered pairs of distinct source and target nodes:\n$$ \\langle T \\rangle = \\frac{1}{N(N-1)} \\sum_{i=0}^{N-1} \\sum_{j=0, j \\neq i}^{N-1} T_{ij} $$\n\nThe implementation will follow this three-part structure for each test case, producing the required list of $[\\langle T \\rangle, \\langle d \\rangle, D]$ for each set of parameters.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.sparse.csgraph import shortest_path\n\ndef compute_metrics(N, m, seed):\n    \"\"\"\n    Constructs a graph and computes its average MFPT, average geodesic length, and diameter.\n\n    Args:\n        N (int): The number of nodes in the graph.\n        m (int): The number of random shortcut edges to add.\n        seed (int): The seed for the random number generator.\n\n    Returns:\n        list: A list containing [T, d, D].\n    \"\"\"\n    # 1. Graph Construction\n    # Start with a ring lattice\n    adj = np.zeros((N, N), dtype=np.int32)\n    for i in range(N):\n        adj[i, (i - 1) % N] = 1\n        adj[i, (i + 1) % N] = 1\n\n    # Add m random shortcut edges\n    if m > 0:\n        rng = np.random.default_rng(seed)\n        \n        # Find all non-adjacent pairs (i, j) with i  j\n        non_adj_pairs = []\n        for i in range(N):\n            for j in range(i + 1, N):\n                if adj[i, j] == 0:\n                    non_adj_pairs.append((i, j))\n        \n        # Select m pairs without replacement\n        if m > len(non_adj_pairs):\n            raise ValueError(\"Number of shortcuts m exceeds available non-adjacent pairs.\")\n        \n        chosen_indices = rng.choice(len(non_adj_pairs), size=m, replace=False)\n        \n        for index in chosen_indices:\n            u, v = non_adj_pairs[index]\n            adj[u, v] = 1\n            adj[v, u] = 1\n\n    # 2. Geodesic Path Metrics\n    # Compute all-pairs shortest paths on the unweighted graph\n    dist_matrix = shortest_path(csgraph=adj, directed=False, unweighted=True)\n    \n    # Diameter D: Maximum shortest path distance.\n    diameter = int(np.max(dist_matrix))\n    \n    # Average geodesic length d\n    # Sum over all i != j and divide by N*(N-1)\n    avg_d = np.sum(dist_matrix) / (N * (N - 1))\n\n    # 3. Mean First Passage Time (MFPT)\n    # Get degrees and construct the transition matrix P\n    degrees = adj.sum(axis=1)\n    # The construction guarantees degrees are at least 2, so no division by zero\n    P = adj / degrees[:, np.newaxis]\n    \n    mfpt_matrix = np.zeros((N, N))\n    \n    identity_full = np.identity(N)\n    \n    for j in range(N):  # Iterate through each node as the target j\n        # Define transient states (all nodes except j)\n        transient_nodes = [i for i in range(N) if i != j]\n        \n        # Construct the submatrix Q for transitions between transient states\n        Q = P[np.ix_(transient_nodes, transient_nodes)]\n        \n        # Solve the system (I - Q) * t_j = 1 for the vector of MFPTs t_j\n        I_transient = np.identity(N - 1)\n        one_vec = np.ones(N - 1)\n        \n        # np.linalg.solve is numerically more stable than inverting the matrix\n        mfpts_to_j = np.linalg.solve(I_transient - Q, one_vec)\n        \n        # Store the results in the full MFPT matrix\n        mfpt_matrix[transient_nodes, j] = mfpts_to_j\n        \n    # Average MFPT T\n    # Sum over all i != j and divide by N*(N-1)\n    avg_T = np.sum(mfpt_matrix) / (N * (N - 1))\n    \n    return [avg_T, avg_d, diameter]\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, m, seed)\n        (60, 0, 1),\n        (60, 3, 1),\n        (90, 0, 2),\n        (90, 4, 2),\n        (90, 1, 42),\n    ]\n\n    results = []\n    for N, m, seed in test_cases:\n        result = compute_metrics(N, m, seed)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # e.g., [[t_1,d_1,D_1],[t_2,d_2,D_2],...]\n    formatted_results = [f\"[{t},{d},{D}]\" for t, d, D in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}