## 引言
在互联日益紧密的世界中，从疾病的传播到信息的扩散，各种动态过程都在复杂的[网络结构](@entry_id:265673)上展开。房室模型（Compartmental Models）为理解和预测这些传播现象提供了强大的数学框架。然而，传统的房室模型常假设个体间均匀混合，这忽略了现实世界中接触模式的[异质性](@entry_id:275678)。将这些模型置于网络之上，是理解复杂系统中[传播动力学](@entry_id:1132218)的关键一步。

本文旨在填补这一认知空白，系统性地介绍网络上的核心[房室模型](@entry_id:177611)。读者将从基础原理出发，逐步掌握分析这些模型的关键技术，并探索其在现实世界中的广泛应用。

文章分为三个核心部分。在“原理与机制”一章，我们将深入剖析SI、SIS和[SIR模型](@entry_id:267265)的数学基础，从精确的[随机过程](@entry_id:268487)讲到实用的平均场近似，并推导流行病爆发的关键指标——阈值与最终规模。接着，在“应用与跨学科交叉”一章，我们将展示这些模型如何被用于指导[公共卫生干预](@entry_id:898213)、分析[复杂网络](@entry_id:261695)结构，以及与数据科学相结合。最后，“动手实践”部分将提供一系列编程练习，帮助读者将理论知识转化为解决实际问题的能力。

现在，让我们从第一章开始，深入网络传播过程的数学心脏，揭示其基本原理与核心机制。

## 原理与机制

继导论之后，本章将深入探讨网络上[传播过程](@entry_id:1132219)的数学原理和核心机制。我们将重点关注三种规范的[房室模型](@entry_id:177611)：易感-感染（SI）模型、易感-感染-易感（SIS）模型和易感-感染-移除（SIR）模型。我们的目标是从最基本的[随机过程](@entry_id:268487)表述出发，逐步构建起一系列强大的近似方法，并利用它们来预测和理解流行病的爆发阈值与最终规模。

### 精确的[随机过程](@entry_id:268487)及其表述

从最严格的意义上讲，网络上的[房室模型](@entry_id:177611)是一个[连续时间马尔可夫链](@entry_id:267837)（CTMC）。系统的完整状态由网络中每个节点的状态共同决定。以一个包含 $N$ 个节点的网络上的 SIR 模型为例，其[状态空间](@entry_id:160914)为 $\{S,I,R\}^N$。系统的一个微观状态（或构型）可以表示为一个向量 $x = (x_1, x_2, \dots, x_N)$，其中 $x_i \in \{S,I,R\}$ 代表节点 $i$ 的房室状态。

系统的动态演化由从一个微观状态到另一个微观状态的转移率决定。这些转移率封装了感染和恢复事件的底层随机性。在 SIR 模型中，一个易感节点 $i$ 受到其受感染邻居的影响，以一定的速率变为感染状态；而一个受感染的节点 $i$ 则以一定的速率自行恢复。

描述这种 CTMC 动态演化最精确的数学工具是**[无穷小生成元](@entry_id:270424) (infinitesimal generator)**，记作 $\mathcal{L}$。生成元是一个算子，它作用于一个定义在[状态空间](@entry_id:160914)上的函数 $f(x)$，并给出该函数[期望值](@entry_id:150961)的[瞬时变化率](@entry_id:141382)。其定义为：

$$
\mathcal{L}f(x) = \sum_{y \neq x} q(x,y) [f(y) - f(x)]
$$

其中 $q(x,y)$ 是从状态 $x$ 转移到状态 $y$ 的速率。对于网络 SIR 模型，可能的事件只有两种：单个节点的感染（S → I）或恢复（I → R）。

1.  **感染事件**：一个易感节点 $i$（即 $x_i=S$）被其受感染的邻居感染。若每个受感染的邻居以速率 $\beta$ 传播病毒，则节点 $i$ 的总感染速率是 $\beta$ 乘以其受感染邻居的数量。这个数量可以用邻接矩阵 $A=(a_{ij})$ 和[状态向量](@entry_id:154607) $x$ 表示为 $\sum_{j=1}^N a_{ij} \mathbf{1}_{\{x_j=I\}}$，其中 $\mathbf{1}_{\{\cdot\}}$ 是指示函数。当节点 $i$ 被感染时，系统状态从 $x$ 变为 $x^{i \to I}$（仅节点 $i$ 的状态改变）。

2.  **恢复事件**：一个受感染的节点 $i$（即 $x_i=I$）以速率 $\mu$ 恢复。这是一个独立于其他节点的过程。当节点 $i$ 恢复时，系统状态从 $x$ 变为 $x^{i \to R}$。

综合这些事件，SIR 模型的生成元可以精确地写为 ：

$$
\mathcal{L} f(x) = \sum_{i=1}^N \mathbf{1}_{\{x_i=S\}} \left( \beta \sum_{j=1}^N a_{ij} \mathbf{1}_{\{x_j=I\}} \right) \big[f(x^{i\to I})-f(x)\big] + \sum_{i=1}^N \mathbf{1}_{\{x_i=I\}} \mu \big[f(x^{i\to R})-f(x)\big]
$$

这个表达式是该过程的完整而精确的描述。然而，由于[状态空间](@entry_id:160914)的大小（$3^N$）随着网络规模 $N$ 指数增长，直接分析或模拟这个[马尔可夫链](@entry_id:150828)对于大型网络来说是不可行的。因此，我们需要发展各种近似方法来理解其宏观行为。

### [SI模型](@entry_id:1131724)：单调传播的基础

最简单的[房室模型](@entry_id:177611)是**易感-感染 (SI) 模型**，它对应于恢复率 $\mu=0$ 的情况。在这个模型中，节点只能从易感（S）状态转变为感染（I）状态，并且永远不会恢复。这种动态过程是**单调的**：随着时间的推移，受感染节点的集合 $I(t)$ 只会增大或保持不变，即对于 $t_1 \le t_2$，必有 $I(t_1) \subseteq I(t_2)$ 。

这种[单调性](@entry_id:143760)使得 SI 模型的[长期行为](@entry_id:192358)特别容易分析。一个状态被称为**[吸收态](@entry_id:161036) (absorbing state)**，如果系统一旦进入该状态就无法离开。对于 SI 过程，一个构型是[吸收态](@entry_id:161036)，当且仅当网络中不存在连接易感节点和感染节点的边。在一个[连通图](@entry_id:264785)上，这意味着只有两种可能的[吸收态](@entry_id:161036)：所有节点都易感（全S态）或所有节点都受感染（全I态）。

如果我们从至少有一个初始感染种子节点开始（$|I(0)| \ge 1$），由于过程的[单调性](@entry_id:143760)，系统不可能回到全S态。因此，在任何连通的网络组件中，[传播过程](@entry_id:1132219)将持续进行，直到该组件内没有S-I边存在为止。这只有在组件内的所有节点都被感染时才会发生。因此，对于任何非零的感染率 $\beta > 0$，从单个感染节点开始，感染最终将遍及该节点所在的所有连通组件 。最终的感染比例等于该初始节点所在连通组件的大小除以网络总节点数 $N$。由于每个瞬态的等待时间[几乎必然](@entry_id:262518)是有限的，到达这个最终全感染[吸收态](@entry_id:161036)的时间也[几乎必然](@entry_id:262518)是有限的 。

### 平均场近似：从微观规则到宏观动力学

为了克服精确随机模型的复杂性，我们引入**平均场 (mean-field)** 近似。这种方法通过忽略或平均化节点间的某些涨落和相关性，将高维的[随机过程](@entry_id:268487)简化为一组低维的确定性[微分](@entry_id:158422)方程。

#### [淬火平均](@entry_id:139666)场（QMF）近似

**[淬火平均](@entry_id:139666)场 (Quenched Mean-Field, QMF)** 近似，也称为**N-纠缠平均场近似 (N-intertwined Mean-Field Approximation, NIMFA)**，它保留了网络的完整拓扑结构（即“淬火”的[邻接矩阵](@entry_id:151010)），但忽略了邻居节点状态之间的[动态相关](@entry_id:171647)性。具体来说，它假设一个节点是易感和它的邻居是感染这两个事件是统计独立的。

让我们从一个节点 $i$ 的感染概率 $p_i(t) = \mathbb{E}[x_i(t)]$ 的精确演化方程开始，其中 $x_i(t)$ 是指示节点 $i$ 在时间 $t$ 是否被感染的[随机变量](@entry_id:195330)。对于 SIS 模型，这个精确方程是 ：

$$
\frac{d}{dt} p_i(t) = \beta \sum_{j=1}^N A_{ij} \mathbb{E}\big[(1 - x_i(t)) x_j(t)\big] - \mu p_i(t)
$$

这里的核心困难在于 $\mathbb{E}[(1 - x_i) x_j]$ 这一项，它是一个二阶矩，涉及到节点 $i$ 和 $j$ 状态的联合概率。QMF 近似通过假设 $\mathbb{E}[x_i x_j] \approx \mathbb{E}[x_i]\mathbb{E}[x_j] = p_i p_j$ 来“关闭”这个方程组。由此，我们得到一个关于节点感染概率 $p_i$ 的封闭 ODE 系统。

对于 SIS 模型，节点 $i$ 的感染率是其易感概率 $(1-p_i)$ 乘以来自所有邻居的总“[感染力](@entry_id:926162)” $\beta \sum_j A_{ij} p_j$。结合恢复项，得到 QMF 方程 ：

$$
\frac{d p_i}{d t} = \beta (1 - p_i) \sum_{j=1}^N A_{ij} p_j - \mu p_i
$$

对于 SIR 模型，我们需要同时追踪感染概率 $x_i$ 和恢复概率 $r_i$。此时，一个节点是易感的概率为 $s_i = 1 - x_i - r_i$。因此，感染项中的易感概率被替换，我们得到一个耦合的 ODE 系统 ：

$$
\begin{align*}
\frac{d x_i}{d t}  = \beta (1 - x_i - r_i) \sum_{j=1}^N A_{ij} x_j - \mu x_i \\
\frac{d r_i}{d t}  = \mu x_i
\end{align*}
$$

注意到，QMF 近似为网络中的每个节点都保留了一个独立的动力学方程，因此它能捕捉到由[网络拓扑](@entry_id:141407)[异质性](@entry_id:275678)引起的行为。

#### 异质平均场（HMF）近似

**异质平均场 (Heterogeneous Mean-Field, HMF)** 近似，也称为**基于度的平均场 (Degree-Based Mean-Field, DBMF)** 近似，采取了更进一步的简化。它不仅忽略了节点状态的相关性，还忽略了网络的具体拓扑结构，只保留了节点的度分布 $P(k)$。其核心假设是，所有度为 $k$ 的节点在统计上是等价的。

我们追踪的是度为 $k$ 的节点中受感染者的比例，记为 $i_k(t)$。一个度为 $k$ 的易感节点（比例为 $1-i_k(t)$）的感染率取决于它接触到一个受感染邻居的概率。HMF 假设一个节点的邻居的感染状态与该节点自身的度无关。所有节点都感受到一个共同的、来自边的平均感染概率 $\Theta(t)$。

$\Theta(t)$ 被定义为从一条随机选择的边出发，其指向的节点是受感染的概率。在一个无[度相关性](@entry_id:1123507)的网络中，一条边连接到一个度为 $k'$ 的节点的概率与 $k'$ 成正比。因此，$\Theta(t)$ 是对所有度类的感染密度 $i_{k'}(t)$ 按其对边的贡献（即 $k'P(k')$）进行的加权平均 ：

$$
\Theta(t) = \sum_{k'} \frac{k' P(k')}{\langle k \rangle} i_{k'}(t)
$$

其中 $\langle k \rangle = \sum_k k P(k)$ 是网络的平均度。一个度为 $k$ 的易感节点有 $k$ 个邻居，每个邻居是感染的概率为 $\Theta(t)$，因此其总感染率为 $\beta k \Theta(t)$。由此，我们得到 SIS 模型的 HMF 方程组 ：

$$
\frac{d i_k}{d t} = \beta k (1 - i_k(t)) \Theta(t) - \mu i_k(t)
$$

HMF 的一个关键假设是，一个度为 $k$ 的节点的邻居感染概率 $P(I|k)$ 等于全局平均值 $\Theta$。然而，在具有强结构或相关性的网络中，这个假设可能会失效。例如，在一个特制的网络中，我们可以构造出度为1的节点其邻居总是被感染，而度为3的节点其邻居可能部分被感染。在这种情况下， $P(I|k=1)$ 可能远大于 $\Theta$，导致 HMF 预测出现显著误差 。这个误差 $\varepsilon = P(I|k) - \Theta$ 称为[闭包](@entry_id:148169)误差，它量化了平均场假设的局限性。

### [流行病阈值](@entry_id:275627)：爆发的[临界点](@entry_id:144653)

流行病研究中的一个核心问题是确定疾病能否在人群中广泛传播的条件。这个临界条件被称为**流行病阈值**。在数学上，这对应于分析“无病状态”（disease-free equilibrium, DFE）的稳定性。如果 DFE 是不稳定的，那么任何微小的感染引入（例如一个感染者）都会导致感染人数呈指数增长，从而引发流行病爆发。

#### QMF阈值与网络谱

我们可以使用 QMF 方程来推导阈值。以 SIR 模型为例，在流行病早期，$p_i(t)$ 和 $r_i(t)$ 都非常小，因此易感概率 $s_i(t) = 1-p_i(t)-r_i(t) \approx 1$。在这种线性化近似下，SIR 和 SIS 的感染动态方程都简化为 ：

$$
\frac{d p_i}{d t} \approx \beta \sum_{j=1}^N A_{ij} p_j - \mu p_i
$$

将感染[概率向量](@entry_id:200434)写为 $\mathbf{p} = (p_1, \dots, p_N)^T$，上述方程组可以表示为矩阵形式：

$$
\frac{d \mathbf{p}}{d t} = (\beta A - \mu I) \mathbf{p}
$$

其中 $A$ 是邻接矩阵，$I$ 是[单位矩阵](@entry_id:156724)。这是一个[线性动力系统](@entry_id:1127277)，其解的增长由[雅可比矩阵](@entry_id:178326) $J = \beta A - \mu I$ 的特征值决定。该系统的解是否增长，取决于 $J$ 的[最大特征值](@entry_id:1127078)是否为正。由于 $A$ 是[对称矩阵](@entry_id:143130)（对于[无向图](@entry_id:270905)），其特征值 $\lambda_k(A)$ 均为实数。$J$ 的特征值为 $\beta \lambda_k(A) - \mu$。因此，系统不稳定的条件是 $J$ 的最大特征值大于零。设 $\lambda_1(A)$ 为[邻接矩阵](@entry_id:151010) $A$ 的[最大特征值](@entry_id:1127078)（即谱半径），则爆发条件为：

$$
\beta \lambda_1(A) - \mu > 0 \implies \frac{\beta}{\mu} > \frac{1}{\lambda_1(A)}
$$

这个结果表明，在 QMF 近似下，流行病阈值由网络邻接矩阵的谱半径的倒数决定  。初始感染人数的[指数增长](@entry_id:141869)率 $r$ 就是[雅可比矩阵](@entry_id:178326)的最大特征值，$r = \beta \lambda_1(A) - \mu$ 。

#### HMF阈值与度矩

同样，我们也可以从 HMF 方程推导阈值。在线性化近似下（$i_k \to 0$），SIS 的 HMF 方程变为：

$$
\frac{d i_k}{d t} \approx \beta k \Theta(t) - \mu i_k(t)
$$

在阈值处，系统存在一个非零的[稳态解](@entry_id:200351)。设 $d i_k / dt = 0$，则 $\mu i_k = \beta k \Theta$。将此关系代入 $\Theta$ 的定义式中，并消去公共因子，可得爆发条件 ：

$$
\frac{\beta}{\mu} > \frac{\langle k \rangle}{\langle k^2 \rangle}
$$

其中 $\langle k^2 \rangle = \sum_k k^2 P(k)$ 是度分布的二阶矩。这个阈值表明，在 HMF 近似下，流行病的爆发能力与度分布的一阶矩和二阶矩的比值有关。由于 $\langle k^2 \rangle$ 对度大的节点（“枢纽节点”）非常敏感，这个结果预示着[度异质性](@entry_id:1123508)（即 $\langle k^2 \rangle$ 相对于 $\langle k \rangle$ 很大）会显著降低[流行病阈值](@entry_id:275627)，使疾病更容易传播。

#### 阈值比较

我们得到了两个不同的阈值表达式：QMF 预测 $\tau_c = 1/\lambda_1(A)$，而 HMF 预测 $\tau_c = \langle k \rangle / \langle k^2 \rangle$（其中 $\tau = \beta/\mu$）。这两种近似在何种条件下一致？

-   对于**$k_0$-[正则图](@entry_id:265877)**（所有节点度均为 $k_0$），我们有 $\lambda_1(A)=k_0$ 且 $\langle k \rangle=k_0, \langle k^2 \rangle=k_0^2$。此时两种预测完全一致，都给出 $\tau_c = 1/k_0$ 。
-   对于**无度相关的[随机图](@entry_id:270323)**，在某些条件下，$\lambda_1(A)$ 近似等于 $\langle k^2 \rangle / \langle k \rangle$。这通常发生在[最大度](@entry_id:265573) $k_{\max}$ 不过于极端，且谱半径对应的主特征向量是“离域”的（其分量分布在网络中的许多节点上）。在这种情况下，两种阈值预测渐近一致。
-   然而，在高度异质的网络（例如某些[无标度网络](@entry_id:137799)）中，$\lambda_1(A)$ 可能被一[小群](@entry_id:198763)度极高的枢纽节点所主导，其行为更接近 $\sqrt{k_{\max}}$。此时，[主特征向量](@entry_id:264358)是“局域”的，QMF 和 HMF 的预测会产生[分歧](@entry_id:193119)，通常 QMF 的预测更为准确，因为它保留了精确的拓扑信息 。

### 最终爆发规模：超越阈值

对于 SIR 模型，一个关键问题是：一旦流行病爆发，最终会有多少比例的人口被感染？

#### [SIR模型](@entry_id:267265)与键渗流的映射

一个优雅而强大的结果是，在某些假设下，SIR 模型的最终爆发规模可以精确地映射到一个静态的**键渗流 (bond percolation)** 问题上。

考虑一个受感染的节点 $i$ 和它的一个易感邻居 $j$。节点 $i$ 在恢复之前，会以速率 $\beta$ 向节点 $j$ 传播病毒。同时，节点 $i$ 以速率 $\mu$ 恢复。这两个是相互竞争的[独立泊松过程](@entry_id:264082)。传播在恢复之前发生的概率（即 transmission to $j$ wins）为 $\frac{\beta}{\beta+\mu}$。我们称这个概率为** transmissibility**，记为 $T$。

由于每次传播尝试都是独立的，我们可以想象在疫情开始前，对网络中的每条边进行一次“掷骰子”：每条边以概率 $T$ 变为“开放”状态（允许传播），以概率 $1-T$ 变为“关闭”状态。疫情的最终爆发规模，即所有曾被感染的节点集合，就等价于初始感染节点在由所有“开放”边构成的[子图](@entry_id:273342)中所处的连通组件 。

这个映射将一个复杂的动态过程简化为一个静态的[图论](@entry_id:140799)问题。一个宏观规模的爆发能否发生，取决于这个渗流过程是否存在一个**巨连通片 (giant component)**。在配置模型网络上，巨连通片存在的条件是分支因子大于1，即 $T \frac{\langle k^2 \rangle - \langle k \rangle}{\langle k \rangle} > 1$。这个分支因子就是**[基本再生数](@entry_id:893213) $R_0$** 。值得注意的是，这个 $R_0$ 的表达式依赖于二阶矩 $\langle k^2 \rangle$，这与之前 HMF 阈值的结果一致，但与简单的表达式 $R_0 = \frac{\beta}{\mu}\langle k \rangle$ 不同，后者只适用于均匀混合或[正则图](@entry_id:265877)的情况 。

一旦阈值条件满足，最终爆发规模 $S$ 可以通过**[生成函数](@entry_id:146702)**方法计算。它由[自洽方程](@entry_id:1131407) $u = 1-T+TG_1(u)$ 的非[平凡解](@entry_id:155162) $u$ 决定，最终规模为 $S=1-G_0(u)$ 。需要强调的是，这种优美的[渗流](@entry_id:158786)映射特定于 SIR 模型这类免疫过程，它不适用于 SIS 模型，因为后者允许重复感染，边的状态不能被一次性决定 。

#### [异质性](@entry_id:275678)、$R_0$与最终规模

[度异质性](@entry_id:1123508)对最终爆发规模的影响是微妙的。考虑一个异质网络，并将其与一个具有相同 $R_0$ 的均匀混合（mass-action）模型进行比较。

-   **初始增长**：$R_0$ 描述的是疫情初期的指数增长率。由于异质[网络中的枢纽](@entry_id:1126203)节点（hubs）的存在，$\langle k^2 \rangle$很大，导致 $R_0$ 也很高。这意味着在网络上，疫情初期的传播速度非常快，因为枢纽节点迅速地将病毒传播给它们的众多邻居。
-   **最终规模**：然而，这些在疫情早期就被感染的枢纽节点，在 SIR 模型中会很快进入“移除”状态。它们的移除对网络结构造成了巨大破坏，仿佛移除了传播网络中的高速公路。这会大大减缓疫情[后期](@entry_id:165003)的[传播速度](@entry_id:189384)。相比之下，均匀混合模型中没有枢纽，每个个体的传播能力都是平均的，且贯穿始终。

因此，即使两个模型的初始增长率（$R_0$）相同，异质网络上的最终爆发规模通常会**小于**均匀混合模型的预测。这是因为网络模型正确地捕捉了枢纽节点被“消耗”掉的效应，而均匀混合模型则高估了疫情[后期](@entry_id:165003)的传播能力 。例如，在一个平均度为6、二阶矩为60的网络上，若 transmissibility $T=0.2$，则其 $R_0 \approx 1.8$。[网络模型](@entry_id:136956)的最终感染规模约为 $48\%$，而一个具有相同 $R_0=1.8$ 的均匀混合模型预测的最终感染规模约为 $73\%$。这种差异正是[网络结构](@entry_id:265673)，特别是[异质性](@entry_id:275678)，所带来的关键影响。