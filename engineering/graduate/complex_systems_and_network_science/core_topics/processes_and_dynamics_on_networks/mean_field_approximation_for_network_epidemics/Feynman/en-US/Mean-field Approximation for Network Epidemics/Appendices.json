{
    "hands_on_practices": [
        {
            "introduction": "To build our intuition for mean-field methods, we begin with the smallest possible network: a two-node motif. This exercise applies the Quenched Mean-Field (QMF) approximation, where we model the infection probability of each individual node while assuming statistical independence between them. By solving for the steady state on a simple directed graph, you will uncover how structural properties like asymmetric connection strengths can lead to surprising and non-intuitive infection patterns, demonstrating why a network perspective is essential. ",
            "id": "4287177",
            "problem": "Consider a Susceptible-Infected-Susceptible (SIS) epidemic process on a small directed weighted network motif with $2$ nodes, labeled $1$ and $2$. Directed transmission from node $j$ to node $i$ occurs along the directed edge with weight $w_{ji}$ at infection rate proportional to the product of a global transmission rate parameter $\\beta>0$ and the weight $w_{ji}>0$. Each infected node recovers independently at rate $\\mu>0$. Let $p_i(t)$ denote the infection probability of node $i$ at time $t$. In the Quenched Mean Field (QMF) approximation (where node states are independent and the adjacency is fixed), the infection hazard at a susceptible node $i$ is the sum of instantaneous infection pressures along all incoming edges, each equal to $\\beta w_{ji} p_j(t)$. Assume the motif has exactly two directed edges: $w_{12}=a>0$ (from node $1$ to node $2$) and $w_{21}=b>0$ (from node $2$ to node $1$), with no self-loops or other edges.\n\nStarting from the above SIS process and mean-field closure assumptions, derive the steady-state equations for the QMF dynamics and solve them analytically for the nontrivial steady-state infection probabilities $p_1^{\\ast}$ and $p_2^{\\ast}$ as functions of $a$, $b$, $\\beta$, and $\\mu$. Then, compute the steady-state average prevalence $\\bar{p}^{\\ast}$ defined by\n$$\n\\bar{p}^{\\ast} \\equiv \\frac{p_1^{\\ast} + p_2^{\\ast}}{2}.\n$$\nAssume parameters satisfy $a>0$, $b>0$, $\\beta>0$, $\\mu>0$, and that a nonzero steady state exists. Provide the final answer as a single closed-form analytic expression for $\\bar{p}^{\\ast}$ in terms of $a$, $b$, $\\beta$, and $\\mu$. No rounding is required. Briefly discuss, in your derivation, how asymmetric weights $a \\neq b$ impact $p_1^{\\ast}$, $p_2^{\\ast}$, and $\\bar{p}^{\\ast}$ compared to the symmetric case $a=b$.",
            "solution": "The problem statement is scientifically grounded, well-posed, objective, and self-contained. It describes a canonical Susceptible-Infected-Susceptible (SIS) model on a 2-node directed network, a standard problem in network epidemiology. All parameters and assumptions, including the use of the Quenched Mean Field (QMF) approximation, are clearly defined. The task is to derive and solve for the non-trivial steady-state probabilities and the average prevalence. The assumption that a nonzero steady state exists removes ambiguity. The problem is therefore valid for solution.\n\nWe begin by formulating the differential equations for the infection probabilities $p_1(t)$ and $p_2(t)$ of nodes $1$ and $2$, respectively, under the QMF approximation. The rate of change of the infection probability for a node $i$, $\\frac{dp_i}{dt}$, is the difference between the rate of infection and the rate of recovery.\n\nThe rate of infection for a susceptible node $i$ is its probability of being susceptible, $1-p_i(t)$, multiplied by the total infection pressure, or hazard, from its infected neighbors. The problem states this hazard is $\\sum_j \\beta w_{ji} p_j(t)$, where $\\beta$ is the global transmission rate parameter and $w_{ji}$ are the directed edge weights. The rate of recovery for an infected node $i$ is its probability of being infected, $p_i(t)$, multiplied by the recovery rate $\\mu$.\n\nThus, the general QMF equation for node $i$ is:\n$$\n\\frac{dp_i}{dt} = (1-p_i(t)) \\sum_j \\beta w_{ji} p_j(t) - \\mu p_i(t)\n$$\n\nFor the specified 2-node network, the weights are $w_{21}=b$ (from node $2$ to $1$) and $w_{12}=a$ (from node $1$ to $2$), with all other weights being zero. The system of equations for $p_1(t)$ and $p_2(t)$ becomes:\n$$\n\\frac{dp_1}{dt} = (1-p_1(t)) \\beta w_{21} p_2(t) - \\mu p_1(t) = (1-p_1(t)) \\beta b p_2(t) - \\mu p_1(t)\n$$\n$$\n\\frac{dp_2}{dt} = (1-p_2(t)) \\beta w_{12} p_1(t) - \\mu p_2(t) = (1-p_2(t)) \\beta a p_1(t) - \\mu p_2(t)\n$$\n\nTo find the steady-state solutions, denoted $p_1^{\\ast}$ and $p_2^{\\ast}$, we set the time derivatives to zero:\n$$\n(1-p_1^{\\ast}) \\beta b p_2^{\\ast} - \\mu p_1^{\\ast} = 0 \\quad \\quad (1)\n$$\n$$\n(1-p_2^{\\ast}) \\beta a p_1^{\\ast} - \\mu p_2^{\\ast} = 0 \\quad \\quad (2)\n$$\n\nThe problem asks for the nontrivial steady state, so we assume $p_1^{\\ast} > 0$ and $p_2^{\\ast} > 0$. We can rearrange the equations:\n$$\n\\mu p_1^{\\ast} = \\beta b p_2^{\\ast} (1-p_1^{\\ast})\n$$\n$$\n\\mu p_2^{\\ast} = \\beta a p_1^{\\ast} (1-p_2^{\\ast})\n$$\n\nTo solve this system, we can express $p_1^{\\ast}$ in terms of $p_2^{\\ast}$ from the first equation:\n$$\n\\mu p_1^{\\ast} + \\beta b p_1^{\\ast} p_2^{\\ast} = \\beta b p_2^{\\ast} \\implies p_1^{\\ast} (\\mu + \\beta b p_2^{\\ast}) = \\beta b p_2^{\\ast} \\implies p_1^{\\ast} = \\frac{\\beta b p_2^{\\ast}}{\\mu + \\beta b p_2^{\\ast}}\n$$\nSubstitute this expression for $p_1^{\\ast}$ into the second steady-state equation:\n$$\n\\mu p_2^{\\ast} = \\beta a \\left( \\frac{\\beta b p_2^{\\ast}}{\\mu + \\beta b p_2^{\\ast}} \\right) (1-p_2^{\\ast})\n$$\nSince we seek a nontrivial solution where $p_2^{\\ast} \\neq 0$, we can divide both sides by $p_2^{\\ast}$:\n$$\n\\mu = \\beta a \\left( \\frac{\\beta b}{\\mu + \\beta b p_2^{\\ast}} \\right) (1-p_2^{\\ast})\n$$\nMultiplying both sides by $(\\mu + \\beta b p_2^{\\ast})$ gives:\n$$\n\\mu(\\mu + \\beta b p_2^{\\ast}) = \\beta^2 ab (1-p_2^{\\ast})\n$$\n$$\n\\mu^2 + \\mu \\beta b p_2^{\\ast} = \\beta^2 ab - \\beta^2 ab p_2^{\\ast}\n$$\nNow, we solve for $p_2^{\\ast}$:\n$$\np_2^{\\ast} (\\mu \\beta b + \\beta^2 ab) = \\beta^2 ab - \\mu^2\n$$\n$$\np_2^{\\ast} (\\beta b (\\mu + \\beta a)) = \\beta^2 ab - \\mu^2\n$$\nThis gives the solution for $p_2^{\\ast}$:\n$$\np_2^{\\ast} = \\frac{\\beta^2 ab - \\mu^2}{\\beta b (\\beta a + \\mu)}\n$$\nThe problem states that a nonzero steady state exists, which implies $\\beta^2 ab - \\mu^2 > 0$, or $\\beta\\sqrt{ab} > \\mu$. This is the well-known condition for the onset of an epidemic in this system, where $\\sqrt{ab}$ is the spectral radius of the network's weighted adjacency matrix.\n\nBy symmetry, swapping the labels $(1 \\leftrightarrow 2)$ is equivalent to swapping the weights $(a \\leftrightarrow b)$. We can thus find $p_1^{\\ast}$ by interchanging $a$ and $b$ in the expression for $p_2^{\\ast}$:\n$$\np_1^{\\ast} = \\frac{\\beta^2 ba - \\mu^2}{\\beta a (\\beta b + \\mu)}\n$$\n\nNext, we compute the steady-state average prevalence $\\bar{p}^{\\ast}$:\n$$\n\\bar{p}^{\\ast} = \\frac{p_1^{\\ast} + p_2^{\\ast}}{2} = \\frac{1}{2} \\left[ \\frac{\\beta^2 ab - \\mu^2}{\\beta a (\\beta b + \\mu)} + \\frac{\\beta^2 ab - \\mu^2}{\\beta b (\\beta a + \\mu)} \\right]\n$$\nFactor out the common term $(\\beta^2 ab - \\mu^2)$:\n$$\n\\bar{p}^{\\ast} = \\frac{\\beta^2 ab - \\mu^2}{2} \\left[ \\frac{1}{\\beta a (\\beta b + \\mu)} + \\frac{1}{\\beta b (\\beta a + \\mu)} \\right]\n$$\n$$\n\\bar{p}^{\\ast} = \\frac{\\beta^2 ab - \\mu^2}{2\\beta} \\left[ \\frac{1}{a(\\beta b + \\mu)} + \\frac{1}{b(\\beta a + \\mu)} \\right]\n$$\nTo combine the fractions in the brackets, we use a common denominator $ab(\\beta b + \\mu)(\\beta a + \\mu)$:\n$$\n\\frac{1}{a(\\beta b + \\mu)} + \\frac{1}{b(\\beta a + \\mu)} = \\frac{b(\\beta a + \\mu) + a(\\beta b + \\mu)}{ab(\\beta b + \\mu)(\\beta a + \\mu)} = \\frac{\\beta ab + b\\mu + \\beta ab + a\\mu}{ab(\\beta^2 ab + \\beta a \\mu + \\beta b \\mu + \\mu^2)}\n$$\n$$\n= \\frac{2\\beta ab + \\mu(a+b)}{ab(\\beta^2 ab + \\beta\\mu(a+b) + \\mu^2)}\n$$\nSubstituting this back into the expression for $\\bar{p}^{\\ast}$:\n$$\n\\bar{p}^{\\ast} = \\frac{\\beta^2 ab - \\mu^2}{2\\beta} \\left( \\frac{2\\beta ab + \\mu(a+b)}{ab(\\beta^2 ab + \\beta\\mu(a+b) + \\mu^2)} \\right)\n$$\nThis simplifies to the final closed-form expression:\n$$\n\\bar{p}^{\\ast} = \\frac{(\\beta^2 ab - \\mu^2)(2\\beta ab + \\mu(a+b))}{2\\beta ab(\\beta^2 ab + \\beta\\mu(a+b) + \\mu^2)}\n$$\n\nFinally, we discuss the impact of asymmetric weights. In the symmetric case where $a=b$, the probabilities are equal: $p_1^{\\ast} = p_2^{\\ast} = 1 - \\frac{\\mu}{\\beta a}$. When weights are asymmetric, say $a>b$, node $1$ is a stronger spreader than node $2$. The denominators of $p_1^{\\ast}$ and $p_2^{\\ast}$ are $\\beta a (\\beta b + \\mu)$ and $\\beta b (\\beta a + \\mu)$, respectively.\nDenominator of $p_1^{\\ast}$: $\\beta^2 ab + a\\beta\\mu$.\nDenominator of $p_2^{\\ast}$: $\\beta^2 ab + b\\beta\\mu$.\nSince $a>b$ and all parameters are positive, $a\\beta\\mu > b\\beta\\mu$, which implies the denominator for $p_1^{\\ast}$ is larger than that for $p_2^{\\ast}$. As the numerators are identical, this leads to $p_1^{\\ast} < p_2^{\\ast}$.\nThis is a key network effect: the node that is a stronger spreader (larger outgoing weight $a=w_{12}$) has a lower individual infection probability because it receives less infectious pressure from its weaker-spreading neighbor. Conversely, the weaker spreader (node $2$) faces a stronger infectious pressure and has a higher infection probability.\n\nRegarding the average prevalence $\\bar{p}^{\\ast}$, consider the case where the geometric mean of the weights, $\\sqrt{ab}$, is held constant. This fixes the epidemic threshold condition. The Arithmetic Mean-Geometric Mean inequality states that for $a,b>0$, $a+b \\ge 2\\sqrt{ab}$, with equality if and only if $a=b$. Therefore, for a fixed product $ab$, the sum $a+b$ is minimized in the symmetric case. Analysis of the expression for $\\bar{p}^{\\ast}$ shows that it is a decreasing function of the sum $a+b$ (for a fixed product $ab$). Consequently, the average prevalence $\\bar{p}^{\\ast}$ is maximized in the symmetric case ($a=b$) and is reduced by any asymmetry in the weights.",
            "answer": "$$\n\\boxed{\\frac{(\\beta^2 ab - \\mu^2)(2\\beta ab + \\mu(a+b))}{2\\beta ab(\\beta^2 ab + \\beta\\mu(a+b) + \\mu^2)}}\n$$"
        },
        {
            "introduction": "Having explored a micro-scale motif, we now scale up to a large network characterized by degree heterogeneity. This problem introduces the powerful Heterogeneous Mean-Field (HMF) approximation for a Susceptible-Infected-Susceptible (SIS) process, where nodes are grouped by their degree. You will derive the system's dynamics and solve for the endemic prevalence using a self-consistency equation, a central technique in mean-field theory for networks. ",
            "id": "4287187",
            "problem": "Consider a continuous-time Susceptible-Infected-Susceptible (SIS) contagion process on a large, sparse, uncorrelated network with two degree classes under the heterogeneous mean-field (HMF) approximation. Let the degree distribution be supported on two degrees $k_{a} \\in \\mathbb{N}$ and $k_{b} \\in \\mathbb{N}$, with probabilities $\\pi \\in (0,1)$ and $1 - \\pi$, respectively. The infection rate per susceptible-infected edge is $\\beta > 0$, and the recovery rate per infected node is $\\mu > 0$. Denote by $i_{a}(t)$ and $i_{b}(t)$ the fraction of infected nodes in the degree classes $k_{a}$ and $k_{b}$, respectively. Let the average degree be $\\langle k \\rangle = k_{a}\\,\\pi + k_{b}\\,(1 - \\pi)$, and let the probability that a randomly selected neighbor is infected be $\\,\\Theta(t)\\,$, defined for uncorrelated mixing by $\\Theta(t) = \\big(k_{a}\\,\\pi\\,i_{a}(t) + k_{b}\\,(1 - \\pi)\\,i_{b}(t)\\big)/\\langle k \\rangle$. Define the prevalence $p(t)$ as the fraction of infected nodes in the population, $p(t) = \\pi\\,i_{a}(t) + (1 - \\pi)\\,i_{b}(t)$.\n\nStarting from the standard continuous-time SIS flow balance and the uncorrelated mixing closure described above, perform the following:\n\n- Derive the heterogeneous mean-field dynamical equations for $i_{a}(t)$ and $i_{b}(t)$.\n- Impose the steady-state condition to obtain $i_{a}^{*}$, $i_{b}^{*}$, and a self-consistency equation for $\\Theta^{*}$.\n- Solve the self-consistency equation exactly to obtain a closed-form expression for the steady-state prevalence $p^{*} = \\pi\\,i_{a}^{*} + (1 - \\pi)\\,i_{b}^{*}$ as a function of $\\beta$, $\\mu$, $k_{a}$, $k_{b}$, and $\\pi$.\n- Linearize the two-dimensional dynamical system around the endemic fixed point $\\big(i_{a}^{*}, i_{b}^{*}\\big)$ and evaluate the Jacobian matrix. Use its eigenvalues to state a condition under which the endemic fixed point is locally asymptotically stable.\n\nYour final answer must be a single exact closed-form analytic expression for $p^{*}$ in terms of $\\beta$, $\\mu$, $k_{a}$, $k_{b}$, and $\\pi$. The answer is dimensionless. Do not round; provide the exact expression.",
            "solution": "We begin from the standard continuous-time Susceptible-Infected-Susceptible (SIS) flow balance. In heterogeneous mean-field for uncorrelated networks, the fraction infected in degree class $k$ evolves according to\n$$\n\\frac{d i_{k}(t)}{dt} \\;=\\; -\\,\\mu\\,i_{k}(t) \\;+\\; \\beta\\,k\\,\\big(1 - i_{k}(t)\\big)\\,\\Theta(t),\n$$\nwhere $\\Theta(t)$ is the probability that a randomly selected neighbor is infected. For the two-class network described,\n$$\n\\Theta(t) \\;=\\; \\frac{k_{a}\\,\\pi\\,i_{a}(t) + k_{b}\\,(1 - \\pi)\\,i_{b}(t)}{\\langle k \\rangle}, \n\\qquad \n\\langle k \\rangle \\;=\\; k_{a}\\,\\pi + k_{b}\\,(1 - \\pi),\n$$\nand the prevalence is $p(t) = \\pi\\,i_{a}(t) + (1 - \\pi)\\,i_{b}(t)$.\n\nApplying the flow balance to each degree class, we obtain the two-dimensional system\n$$\n\\frac{d i_{a}}{dt} \\;=\\; -\\,\\mu\\,i_{a} \\;+\\; \\beta\\,k_{a}\\,\\big(1 - i_{a}\\big)\\,\\Theta,\n\\qquad\n\\frac{d i_{b}}{dt} \\;=\\; -\\,\\mu\\,i_{b} \\;+\\; \\beta\\,k_{b}\\,\\big(1 - i_{b}\\big)\\,\\Theta,\n$$\nwith the closure\n$$\n\\Theta \\;=\\; \\frac{k_{a}\\,\\pi\\,i_{a} + k_{b}\\,(1 - \\pi)\\,i_{b}}{\\langle k \\rangle}.\n$$\n\nAt steady state, $d i_{a}/dt = 0$ and $d i_{b}/dt = 0$, yielding for each class:\n$$\n0 \\;=\\; -\\,\\mu\\,i_{k}^{*} \\;+\\; \\beta\\,k\\,\\big(1 - i_{k}^{*}\\big)\\,\\Theta^{*},\n\\quad\\Rightarrow\\quad\ni_{k}^{*} \\;=\\; \\frac{\\beta\\,k\\,\\Theta^{*}}{\\mu + \\beta\\,k\\,\\Theta^{*}},\n\\quad\nk \\in \\{k_{a}, k_{b}\\}.\n$$\nWith this, the closure becomes a self-consistency condition for $\\Theta^{*}$:\n$$\n\\Theta^{*} \\;=\\; \\frac{k_{a}\\,\\pi\\,\\frac{\\beta\\,k_{a}\\,\\Theta^{*}}{\\mu + \\beta\\,k_{a}\\,\\Theta^{*}} \\;+\\; k_{b}\\,(1 - \\pi)\\,\\frac{\\beta\\,k_{b}\\,\\Theta^{*}}{\\mu + \\beta\\,k_{b}\\,\\Theta^{*}}}{\\langle k \\rangle}.\n$$\nAssuming $\\Theta^{*} > 0$, divide both sides by $\\Theta^{*}$ to obtain\n$$\n1 \\;=\\; \\frac{\\beta}{\\langle k \\rangle}\\left[\n\\frac{k_{a}^{2}\\,\\pi}{\\mu + \\beta\\,k_{a}\\,\\Theta^{*}} \\;+\\; \\frac{k_{b}^{2}\\,(1 - \\pi)}{\\mu + \\beta\\,k_{b}\\,\\Theta^{*}}\n\\right].\n$$\nThis can be combined into a single rational function. Define\n$$\nA \\;=\\; k_{a}^{2}\\,\\pi, \\quad B \\;=\\; k_{b}^{2}\\,(1 - \\pi), \\quad a \\;=\\; \\beta\\,k_{a}, \\quad b \\;=\\; \\beta\\,k_{b}, \\quad m \\;=\\; \\langle k \\rangle \\;=\\; k_{a}\\,\\pi + k_{b}\\,(1 - \\pi).\n$$\nThen\n$$\n1 \\;=\\; \\frac{\\beta}{m}\\,\\frac{(A + B)\\,\\mu \\;+\\; (A\\,b + B\\,a)\\,\\Theta^{*}}{\\mu^{2} \\;+\\; \\mu\\,(a + b)\\,\\Theta^{*} \\;+\\; a\\,b\\,\\Theta^{*\\,2}}.\n$$\nMultiplying both sides by the denominator yields a quadratic in $\\Theta^{*}$:\n$$\na\\,b\\,\\Theta^{*\\,2} \\;+\\; \\mu\\,(a + b)\\,\\Theta^{*} \\;+\\; \\mu^{2} \\;-\\; \\frac{\\beta}{m}\\,\\Big( (A + B)\\,\\mu \\;+\\; (A\\,b + B\\,a)\\,\\Theta^{*} \\Big) \\;=\\; 0.\n$$\nReturning to the original parameters, this quadratic can be written as\n$$\nC_{2}\\,\\Theta^{*\\,2} \\;+\\; C_{1}\\,\\Theta^{*} \\;+\\; C_{0} \\;=\\; 0,\n$$\nwith coefficients\n$$\nC_{2} \\;=\\; \\beta^{2}\\,k_{a}\\,k_{b},\n$$\n$$\nC_{1} \\;=\\; \\mu\\,\\beta\\,(k_{a} + k_{b}) \\;-\\; \\frac{\\beta^{2}}{m}\\Big( k_{a}^{2}\\,\\pi\\,k_{b} \\;+\\; k_{b}^{2}\\,(1 - \\pi)\\,k_{a} \\Big),\n$$\n$$\nC_{0} \\;=\\; \\mu^{2} \\;-\\; \\frac{\\beta\\,\\mu}{m}\\Big( k_{a}^{2}\\,\\pi \\;+\\; k_{b}^{2}\\,(1 - \\pi) \\Big).\n$$\nThe positive endemic solution $\\Theta^{*}$ is obtained from the quadratic formula. The physically relevant root is the one that yields $\\Theta^{*} \\geq 0$:\n$$\n\\Theta^{*} \\;=\\; \\frac{-\\,C_{1} \\;+\\; \\sqrt{\\,C_{1}^{2} \\;-\\; 4\\,C_{2}\\,C_{0}\\,}}{2\\,C_{2}}.\n$$\nGiven $\\Theta^{*}$, the steady-state fractions infected in each class are\n$$\ni_{a}^{*} \\;=\\; \\frac{\\beta\\,k_{a}\\,\\Theta^{*}}{\\mu + \\beta\\,k_{a}\\,\\Theta^{*}},\n\\qquad\ni_{b}^{*} \\;=\\; \\frac{\\beta\\,k_{b}\\,\\Theta^{*}}{\\mu + \\beta\\,k_{b}\\,\\Theta^{*}},\n$$\nand the steady-state prevalence is\n$$\np^{*} \\;=\\; \\pi\\,\\frac{\\beta\\,k_{a}\\,\\Theta^{*}}{\\mu + \\beta\\,k_{a}\\,\\Theta^{*}} \\;+\\; (1 - \\pi)\\,\\frac{\\beta\\,k_{b}\\,\\Theta^{*}}{\\mu + \\beta\\,k_{b}\\,\\Theta^{*}}.\n$$\n\nWe now analyze local stability of the endemic fixed point by linearizing the two-dimensional dynamical system around $\\big(i_{a}^{*}, i_{b}^{*}\\big)$. Define the vector $\\mathbf{i} = \\big(i_{a}, i_{b}\\big)^{\\top}$ and the vector field $\\mathbf{F}(\\mathbf{i})$ with components\n$$\nF_{a}(i_{a}, i_{b}) \\;=\\; -\\,\\mu\\,i_{a} \\;+\\; \\beta\\,k_{a}\\,\\big(1 - i_{a}\\big)\\,\\Theta(i_{a},i_{b}),\n\\qquad\nF_{b}(i_{a}, i_{b}) \\;=\\; -\\,\\mu\\,i_{b} \\;+\\; \\beta\\,k_{b}\\,\\big(1 - i_{b}\\big)\\,\\Theta(i_{a},i_{b}),\n$$\nwhere $\\Theta(i_{a},i_{b}) = \\big(k_{a}\\,\\pi\\,i_{a} + k_{b}\\,(1 - \\pi)\\,i_{b}\\big)/m$. The Jacobian matrix $J$ has entries\n$$\nJ_{aa} \\;=\\; \\frac{\\partial F_{a}}{\\partial i_{a}} \\;=\\; -\\,\\mu \\;-\\; \\beta\\,k_{a}\\,\\Theta^{*} \\;+\\; \\beta\\,k_{a}\\,\\big(1 - i_{a}^{*}\\big)\\,\\frac{\\partial \\Theta}{\\partial i_{a}},\n$$\n$$\nJ_{ab} \\;=\\; \\frac{\\partial F_{a}}{\\partial i_{b}} \\;=\\; \\beta\\,k_{a}\\,\\big(1 - i_{a}^{*}\\big)\\,\\frac{\\partial \\Theta}{\\partial i_{b}},\n$$\n$$\nJ_{ba} \\;=\\; \\frac{\\partial F_{b}}{\\partial i_{a}} \\;=\\; \\beta\\,k_{b}\\,\\big(1 - i_{b}^{*}\\big)\\,\\frac{\\partial \\Theta}{\\partial i_{a}},\n$$\n$$\nJ_{bb} \\;=\\; \\frac{\\partial F_{b}}{\\partial i_{b}} \\;=\\; -\\,\\mu \\;-\\; \\beta\\,k_{b}\\,\\Theta^{*} \\;+\\; \\beta\\,k_{b}\\,\\big(1 - i_{b}^{*}\\big)\\,\\frac{\\partial \\Theta}{\\partial i_{b}}.\n$$\nUsing $\\frac{\\partial \\Theta}{\\partial i_{a}} = \\frac{k_{a}\\,\\pi}{m}$, $\\frac{\\partial \\Theta}{\\partial i_{b}} = \\frac{k_{b}\\,(1 - \\pi)}{m}$, and $1 - i_{k}^{*} = \\frac{\\mu}{\\mu + \\beta\\,k\\,\\Theta^{*}}$, we obtain\n$$\nJ_{aa} \\;=\\; -\\,\\mu \\;-\\; \\beta\\,k_{a}\\,\\Theta^{*} \\;+\\; \\beta\\,k_{a}\\,\\frac{\\mu}{\\mu + \\beta\\,k_{a}\\,\\Theta^{*}}\\cdot \\frac{k_{a}\\,\\pi}{m},\n$$\n$$\nJ_{ab} \\;=\\; \\beta\\,k_{a}\\,\\frac{\\mu}{\\mu + \\beta\\,k_{a}\\,\\Theta^{*}}\\cdot \\frac{k_{b}\\,(1 - \\pi)}{m},\n$$\n$$\nJ_{ba} \\;=\\; \\beta\\,k_{b}\\,\\frac{\\mu}{\\mu + \\beta\\,k_{b}\\,\\Theta^{*}}\\cdot \\frac{k_{a}\\,\\pi}{m},\n$$\n$$\nJ_{bb} \\;=\\; -\\,\\mu \\;-\\; \\beta\\,k_{b}\\,\\Theta^{*} \\;+\\; \\beta\\,k_{b}\\,\\frac{\\mu}{\\mu + \\beta\\,k_{b}\\,\\Theta^{*}}\\cdot \\frac{k_{b}\\,(1 - \\pi)}{m}.\n$$\nThe eigenvalues of $J$ solve $\\lambda^{2} - \\operatorname{tr}(J)\\,\\lambda + \\det(J) = 0$. Local asymptotic stability of the endemic fixed point requires $\\operatorname{tr}(J) < 0$ and $\\det(J) > 0$. Because $J_{ab} > 0$ and $J_{ba} > 0$ while the diagonal terms contain $-\\,\\mu - \\beta\\,k\\,\\Theta^{*}$ and a smaller positive correction, $\\operatorname{tr}(J)$ is negative for endemic $\\Theta^{*} > 0$ in the parameter region where the steady state exists, and the product structure of the off-diagonals together with the sign properties of the diagonals yields $\\det(J) > 0$. Thus, when the endemic solution $\\Theta^{*} > 0$ exists (that is, when the infection rate-to-recovery rate ratio is above the heterogeneous mean-field threshold), the endemic fixed point is locally asymptotically stable.\n\nFinally, assembling the explicit closed form for $p^{*}$, we present it in terms of the parameters $\\beta$, $\\mu$, $k_{a}$, $k_{b}$, and $\\pi$ by substituting the expression for $\\Theta^{*}$ into the formula for $p^{*}$:\n$$\np^{*} \\;=\\; \\pi\\,\\frac{\\beta\\,k_{a}\\,\\Theta^{*}}{\\mu + \\beta\\,k_{a}\\,\\Theta^{*}} \\;+\\; (1 - \\pi)\\,\\frac{\\beta\\,k_{b}\\,\\Theta^{*}}{\\mu + \\beta\\,k_{b}\\,\\Theta^{*}},\n$$\nwith\n$$\n\\Theta^{*} \\;=\\; \\frac{-\\,C_{1} \\;+\\; \\sqrt{\\,C_{1}^{2} \\;-\\; 4\\,C_{2}\\,C_{0}\\,}}{2\\,C_{2}},\n\\quad\nC_{2} \\;=\\; \\beta^{2}\\,k_{a}\\,k_{b},\n\\quad\nC_{1} \\;=\\; \\mu\\,\\beta\\,(k_{a} + k_{b}) \\;-\\; \\frac{\\beta^{2}}{k_{a}\\,\\pi + k_{b}\\,(1 - \\pi)}\\Big( k_{a}^{2}\\,\\pi\\,k_{b} \\;+\\; k_{b}^{2}\\,(1 - \\pi)\\,k_{a} \\Big),\n$$\n$$\nC_{0} \\;=\\; \\mu^{2} \\;-\\; \\frac{\\beta\\,\\mu}{k_{a}\\,\\pi + k_{b}\\,(1 - \\pi)}\\Big( k_{a}^{2}\\,\\pi \\;+\\; k_{b}^{2}\\,(1 - \\pi) \\Big).\n$$\nThis gives an exact, closed-form analytic expression for the steady-state prevalence under the two-class heterogeneous mean-field SIS model.",
            "answer": "$$\\boxed{\\pi\\,\\frac{\\beta\\,k_{a}\\,\\Theta^{*}}{\\mu + \\beta\\,k_{a}\\,\\Theta^{*}} \\;+\\; (1 - \\pi)\\,\\frac{\\beta\\,k_{b}\\,\\Theta^{*}}{\\mu + \\beta\\,k_{b}\\,\\Theta^{*}} \\text{ where } \\Theta^{*} = \\frac{-\\,C_{1} + \\sqrt{\\,C_{1}^{2} - 4\\,C_{2}\\,C_{0}\\,}}{2\\,C_{2}}, \\; C_{2} = \\beta^{2} k_{a} k_{b}, \\; C_{1} = \\mu \\beta (k_{a}+k_{b}) - \\frac{\\beta^{2}}{k_{a}\\pi + k_{b}(1-\\pi)}\\big(k_{a}^{2}\\pi k_{b}+ k_{b}^{2}(1-\\pi)k_{a}\\big), \\; C_{0} = \\mu^{2} - \\frac{\\beta \\mu}{k_{a}\\pi + k_{b}(1-\\pi)}\\big(k_{a}^{2}\\pi + k_{b}^{2}(1-\\pi)\\big)}$$"
        },
        {
            "introduction": "Our previous models assumed that nodes connect randomly without regard to their degree, an assumption encapsulated in the term $\\Theta(t)$. This final practice challenges that simplification by introducing degree-degree correlations, a feature common in real-world networks. You will learn how to generalize the mean-field equations to account for these correlations and see how the epidemic threshold is governed by the spectral radius of a specially constructed matrix, providing a more robust framework for assessing epidemic risk. ",
            "id": "4287250",
            "problem": "Consider a Susceptible-Infected-Susceptible (SIS) spreading process on a large, sparse, undirected network. Each node has a degree $k$ drawn from a degree distribution $P(k)$ and the infection rate per contact is $\\beta$, with recovery rate $\\mu$. Let $i_{k}(t)$ denote the probability that a node of degree $k$ is infected at time $t$. The network exhibits degree correlations quantified by the conditional probability $P(k' \\mid k)$ that a randomly chosen neighbor of a degree-$k$ node has degree $k'$. The degree-degree correlations obey the undirected detailed-balance constraint $k \\, P(k) \\, P(k' \\mid k) = k' \\, P(k') \\, P(k \\mid k')$ for all degrees $k$ and $k'$.\n\nStarting from first principles and the degree-based mean-field approximation, do the following tasks:\n\n1. Write down the heterogeneous mean-field rate equation for $i_{k}(t)$ that accounts for degree heterogeneity and degree correlations through $P(k' \\mid k)$. Linearize this dynamical system about the disease-free equilibrium $i_{k} \\equiv 0$ and, using stability analysis for linear systems, express the epidemic threshold condition in terms of the spectral radius of a matrix that is constructed from $P(k' \\mid k)$ and the degree values $\\{k\\}$.\n\n2. Using this spectral characterization, state precise conditions on $P(k' \\mid k)$ under which the widely used moment-based threshold derived for uncorrelated networks is invalid. Provide a corrected expression for the threshold under correlated mixing within the same mean-field framework.\n\n3. Consider a two-class degree distribution with degrees $k_{1} = 2$ and $k_{2} = 8$, with $P(k_{1}) = \\frac{4}{5}$ and $P(k_{2}) = \\frac{1}{5}$. The conditional probabilities are specified by $P(k_{1} \\mid k_{1}) = \\frac{7}{10}$ and $P(k_{2} \\mid k_{1}) = \\frac{3}{10}$. Use the detailed-balance constraint to determine $P(k_{1} \\mid k_{2})$ and $P(k_{2} \\mid k_{2})$, then construct the corresponding degree-correlation matrix used in the linearization of the SIS dynamics. Compute, in exact closed form, the corrected mean-field epidemic threshold as a single analytic expression for the critical ratio $\\beta / \\mu$ for this network. Express your final answer as an exact symbolic expression. Do not include any units in your final answer.",
            "solution": "The problem is first validated. The givens are: a Susceptible-Infected-Susceptible (SIS) model on a large, sparse, undirected network; infection rate $\\beta$; recovery rate $\\mu$; degree distribution $P(k)$; conditional probability for degree-degree correlations $P(k' \\mid k)$; variable $i_k(t)$ as the probability a degree-$k$ node is infected; and the detailed-balance constraint $k \\, P(k) \\, P(k' \\mid k) = k' \\, P(k') \\, P(k \\mid k')$. Specific values for a two-class network are given: $k_1 = 2$, $k_2 = 8$, $P(k_1) = \\frac{4}{5}$, $P(k_2) = \\frac{1}{5}$, $P(k_1 \\mid k_1) = \\frac{7}{10}$, and $P(k_2 \\mid k_1) = \\frac{3}{10}$. The problem is scientifically grounded in network epidemiology, self-contained, and mathematically well-posed. The provided numerical values are consistent with probability theory and the detailed-balance constraint. The problem is therefore deemed valid and a solution can be constructed.\n\n**1. Heterogeneous Mean-Field Equation and Epidemic Threshold**\n\nWe begin by deriving the rate equation for $i_k(t)$, the fraction of infected nodes of degree $k$. The change in $i_k(t)$ is governed by two processes: recovery and infection.\n- An infected node of degree $k$ recovers and becomes susceptible with a rate $\\mu$. This contributes a term $-\\mu i_k(t)$ to the rate of change.\n- A susceptible node of degree $k$ (of which there is a fraction $1-i_k(t)$) becomes infected through contact with its neighbors. The rate of infection is proportional to the infection rate $\\beta$, the number of neighbors $k$, and the probability that a randomly chosen neighbor is infected. This probability, let's call it $\\theta_k(t)$, depends on the degree of the focal node, $k$.\n\nIn the degree-based mean-field approximation, we express $\\theta_k(t)$ by averaging over the degrees of the neighbors. A neighbor of a degree-$k$ node has degree $k'$ with probability $P(k' \\mid k)$. The probability that this degree-$k'$ neighbor is infected is $i_{k'}(t)$. Summing over all possible neighbor degrees $k'$, we have:\n$$ \\theta_k(t) = \\sum_{k'} P(k' \\mid k) \\, i_{k'}(t) $$\nThe total rate at which a susceptible node of degree $k$ becomes infected is $\\beta k \\theta_k(t)$. Assuming independent infection events from neighbors, the gain term for $i_k(t)$ is $\\beta k (1-i_k(t)) \\theta_k(t)$.\n\nCombining the gain and loss terms, we obtain the full nonlinear rate equation:\n$$ \\frac{di_k}{dt} = \\beta k (1-i_k(t)) \\sum_{k'} P(k' \\mid k) \\, i_{k'}(t) - \\mu i_k(t) $$\nTo find the epidemic threshold, we analyze the stability of the disease-free equilibrium (DFE), where $i_k(t) = 0$ for all $k$. Let $i_k(t) = \\epsilon_k(t)$, where $\\epsilon_k(t)$ is a small perturbation. Substituting this into the rate equation and linearizing by dropping terms of order $\\epsilon^2$ and higher (i.e., setting $1-\\epsilon_k \\approx 1$):\n$$ \\frac{d\\epsilon_k}{dt} \\approx \\beta k \\sum_{k'} P(k' \\mid k) \\, \\epsilon_{k'}(t) - \\mu \\epsilon_k(t) $$\nThis is a system of linear ordinary differential equations. Let the distinct degrees in the network be $\\{k_1, k_2, \\dots, k_N\\}$. We can write the system in vector form $\\frac{d\\vec{\\epsilon}}{dt} = J \\vec{\\epsilon}$, where $\\vec{\\epsilon}$ is the vector of perturbations $(\\epsilon_{k_1}, \\epsilon_{k_2}, \\dots, \\epsilon_{k_N})^T$ and $J$ is the Jacobian matrix. The elements of $J$ are given by:\n$$ J_{ij} = \\beta k_i P(k_j \\mid k_i) - \\mu \\delta_{ij} $$\nwhere $\\delta_{ij}$ is the Kronecker delta. We can express $J$ as $J = \\beta M - \\mu I$, where $I$ is the identity matrix and $M$ is a matrix with elements $M_{ij} = k_i P(k_j \\mid k_i)$.\n\nThe DFE is unstable if any eigenvalue of $J$ has a positive real part. The eigenvalues of $J$ are $\\lambda_J = \\beta \\lambda_M - \\mu$, where $\\lambda_M$ are the eigenvalues of $M$. The condition for instability is $\\max(\\text{Re}(\\lambda_J)) > 0$, which translates to $\\beta \\max(\\text{Re}(\\lambda_M)) - \\mu > 0$. The matrix $M$ has non-negative entries, so by the Perron-Frobenius theorem, its largest eigenvalue is real and positive. This eigenvalue is the spectral radius, $\\rho(M)$. Thus, $\\max(\\text{Re}(\\lambda_M)) = \\rho(M)$.\n\nThe epidemic threshold is the critical value of the spreading rate $\\lambda = \\beta / \\mu$ where the DFE loses stability. The condition for an outbreak is $\\frac{\\beta}{\\mu} \\rho(M) > 1$. The threshold condition is therefore expressed in terms of the spectral radius of the matrix $M$:\n$$ \\left( \\frac{\\beta}{\\mu} \\right)_c = \\frac{1}{\\rho(M)} $$\nwhere $M$ is the matrix with elements $M_{ij} = k_i P(k_j \\mid k_i)$ for the distinct degree classes $i$ and $j$.\n\n**2. Condition for Invalidity of Uncorrelated Network Threshold**\n\nThe widely used moment-based threshold for uncorrelated networks is $(\\frac{\\beta}{\\mu})_c = \\frac{\\langle k \\rangle}{\\langle k^2 \\rangle}$. This result is derived under the assumption that $P(k' \\mid k)$ is independent of $k$, specifically $P(k' \\mid k) = \\frac{k' P(k')}{\\langle k \\rangle}$, where $\\langle k \\rangle = \\sum_k k P(k)$ and $\\langle k^2 \\rangle = \\sum_k k^2 P(k)$.\n\nThe moment-based threshold is invalid whenever the network exhibits degree correlations, meaning the assumption $P(k' \\mid k) = \\frac{k' P(k')}{\\langle k \\rangle}$ does not hold for all pairs $(k, k')$. This occurs in networks with assortative mixing (where high-degree nodes preferentially connect to other high-degree nodes) or disassortative mixing (where high-degree nodes preferentially connect to low-degree nodes).\n\nThe corrected expression for the epidemic threshold under correlated mixing is precisely the one derived from the stability analysis in the previous section:\n$$ \\left( \\frac{\\beta}{\\mu} \\right)_c = \\frac{1}{\\rho(M)} $$\nwhere $M_{ij} = k_i P(k_j \\mid k_i)$. This expression is general and remains valid for correlated and uncorrelated networks alike, reducing to the moment-based formula in the specific case of no correlations.\n\n**3. Calculation for the Two-Class Network**\n\nWe are given a network with two degree classes, $k_1 = 2$ and $k_2 = 8$, with $P(k_1) = \\frac{4}{5}$ and $P(k_2) = \\frac{1}{5}$. The conditional probabilities are $P(k_1 \\mid k_1) = \\frac{7}{10}$ and $P(k_2 \\mid k_1) = \\frac{3}{10}$. Since $\\sum_{k'} P(k' \\mid k) = 1$, we can verify that $P(k_1 \\mid k_1) + P(k_2 \\mid k_1) = \\frac{7}{10} + \\frac{3}{10} = 1$, which is consistent.\n\nWe first determine the remaining conditional probabilities, $P(k_1 \\mid k_2)$ and $P(k_2 \\mid k_2)$, using the detailed-balance constraint: $k_1 P(k_1) P(k_2 \\mid k_1) = k_2 P(k_2) P(k_1 \\mid k_2)$.\n$$ (2) \\left(\\frac{4}{5}\\right) \\left(\\frac{3}{10}\\right) = (8) \\left(\\frac{1}{5}\\right) P(k_1 \\mid k_2) $$\n$$ \\frac{24}{50} = \\frac{8}{5} P(k_1 \\mid k_2) $$\n$$ P(k_1 \\mid k_2) = \\frac{24}{50} \\cdot \\frac{5}{8} = \\frac{3}{10} $$\nUsing the normalization condition for $k=k_2$, we have $P(k_1 \\mid k_2) + P(k_2 \\mid k_2) = 1$.\n$$ P(k_2 \\mid k_2) = 1 - P(k_1 \\mid k_2) = 1 - \\frac{3}{10} = \\frac{7}{10} $$\nNow we construct the $2 \\times 2$ matrix $M$ with elements $M_{ij} = k_i P(k_j \\mid k_i)$:\n$M_{11} = k_1 P(k_1 \\mid k_1) = 2 \\cdot \\frac{7}{10} = \\frac{14}{10} = \\frac{7}{5}$\n$M_{12} = k_1 P(k_2 \\mid k_1) = 2 \\cdot \\frac{3}{10} = \\frac{6}{10} = \\frac{3}{5}$\n$M_{21} = k_2 P(k_1 \\mid k_2) = 8 \\cdot \\frac{3}{10} = \\frac{24}{10} = \\frac{12}{5}$\n$M_{22} = k_2 P(k_2 \\mid k_2) = 8 \\cdot \\frac{7}{10} = \\frac{56}{10} = \\frac{28}{5}$\n\nThe matrix $M$ is:\n$$ M = \\begin{pmatrix} \\frac{7}{5} & \\frac{3}{5} \\\\ \\frac{12}{5} & \\frac{28}{5} \\end{pmatrix} $$\nTo find the spectral radius $\\rho(M)$, we compute the eigenvalues by solving the characteristic equation $\\det(M - \\lambda I) = 0$:\n$$ \\det \\begin{pmatrix} \\frac{7}{5} - \\lambda & \\frac{3}{5} \\\\ \\frac{12}{5} & \\frac{28}{5} - \\lambda \\end{pmatrix} = 0 $$\n$$ \\left(\\frac{7}{5} - \\lambda\\right)\\left(\\frac{28}{5} - \\lambda\\right) - \\left(\\frac{3}{5}\\right)\\left(\\frac{12}{5}\\right) = 0 $$\n$$ \\lambda^2 - \\left(\\frac{7}{5} + \\frac{28}{5}\\right)\\lambda + \\frac{7 \\cdot 28}{25} - \\frac{3 \\cdot 12}{25} = 0 $$\n$$ \\lambda^2 - \\frac{35}{5}\\lambda + \\frac{196 - 36}{25} = 0 $$\n$$ \\lambda^2 - 7\\lambda + \\frac{160}{25} = 0 $$\n$$ \\lambda^2 - 7\\lambda + \\frac{32}{5} = 0 $$\nUsing the quadratic formula $\\lambda = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$:\n$$ \\lambda = \\frac{7 \\pm \\sqrt{(-7)^2 - 4(1)\\left(\\frac{32}{5}\\right)}}{2} = \\frac{7 \\pm \\sqrt{49 - \\frac{128}{5}}}{2} $$\n$$ \\lambda = \\frac{7 \\pm \\sqrt{\\frac{245 - 128}{5}}}{2} = \\frac{7 \\pm \\sqrt{\\frac{117}{5}}}{2} $$\nThe spectral radius $\\rho(M)$ is the largest eigenvalue:\n$$ \\rho(M) = \\frac{7 + \\sqrt{\\frac{117}{5}}}{2} = \\frac{7 + \\frac{\\sqrt{9 \\cdot 13}}{\\sqrt{5}}}{2} = \\frac{7 + \\frac{3\\sqrt{13}}{\\sqrt{5}}}{2} = \\frac{7 + \\frac{3\\sqrt{65}}{5}}{2} = \\frac{35 + 3\\sqrt{65}}{10} $$\nThe epidemic threshold is the reciprocal of the spectral radius:\n$$ \\left(\\frac{\\beta}{\\mu}\\right)_c = \\frac{1}{\\rho(M)} = \\frac{10}{35 + 3\\sqrt{65}} $$\nTo rationalize the denominator, we multiply the numerator and denominator by the conjugate $35 - 3\\sqrt{65}$:\n$$ \\left(\\frac{\\beta}{\\mu}\\right)_c = \\frac{10(35 - 3\\sqrt{65})}{(35 + 3\\sqrt{65})(35 - 3\\sqrt{65})} = \\frac{10(35 - 3\\sqrt{65})}{35^2 - (3\\sqrt{65})^2} $$\n$$ \\left(\\frac{\\beta}{\\mu}\\right)_c = \\frac{10(35 - 3\\sqrt{65})}{1225 - 9 \\cdot 65} = \\frac{10(35 - 3\\sqrt{65})}{1225 - 585} = \\frac{10(35 - 3\\sqrt{65})}{640} $$\n$$ \\left(\\frac{\\beta}{\\mu}\\right)_c = \\frac{35 - 3\\sqrt{65}}{64} $$\nThis is the exact symbolic expression for the critical ratio $\\beta / \\mu$.",
            "answer": "$$ \\boxed{\\frac{35 - 3\\sqrt{65}}{64}} $$"
        }
    ]
}