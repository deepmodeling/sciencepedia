{
    "hands_on_practices": [
        {
            "introduction": "Our exploration begins with the foundational elements of a dynamical system: its fixed points and their stability. This exercise challenges you to analytically determine where the logistic map's dynamics can settle into a steady state and to connect the mathematical condition for stability directly to the value of the Lyapunov exponent. This practice provides a crucial bridge between the concepts of local stability and the quantification of long-term sensitivity. ",
            "id": "4263918",
            "problem": "Consider the one-dimensional discrete-time logistic map $x_{n+1} = a x_n (1 - x_n)$ on the unit interval with parameter $a \\in [0,4]$. Begin from the foundational definitions of a fixed point and linear stability for discrete maps: a fixed point $x^{\\ast}$ satisfies $f(x^{\\ast}) = x^{\\ast}$, and local linear stability is determined by the magnitude of the derivative $|f'(x^{\\ast})|$ through the linearization of the map around $x^{\\ast}$. Additionally, use the definition of the Maximal Lyapunov Exponent (MLE), denoted $\\lambda$, for a discrete-time map, which quantifies sensitivity to initial conditions via the asymptotic exponential rate of separation of nearby trajectories.\n\nTasks:\n1. Derive all fixed points $x^{\\ast}$ of the logistic map as functions of $a$ and state the parameter conditions under which each fixed point exists.\n2. Using linearization, determine the parameter sets (subsets of $[0,4]$) for which each fixed point is linearly stable.\n3. For each parameter value $a$ where at least one fixed point is stable, define $\\lambda(a)$ to be the MLE of the stable fixed-point orbit selected at that $a$, using the standard discrete-time definition $\\lambda = \\lim_{n \\to \\infty} \\frac{1}{n} \\sum_{k=0}^{n-1} \\ln |f'(x_k)|$.\n4. Let $S = \\{ a \\in [0,4] \\mid \\text{there exists a linearly stable fixed point of } f \\}$. Compute the integral\n$$\nI = \\int_{a \\in S} \\lambda(a) \\, da\n$$\nexactly. Express your answer as a single real number. No rounding is required.",
            "solution": "We are given the logistic map $f(x) = a x (1 - x)$, with parameter $a \\in [0,4]$.\n\nStep 1: Fixed points. A fixed point $x^{\\ast}$ satisfies $f(x^{\\ast}) = x^{\\ast}$, i.e.,\n$$\na x^{\\ast} (1 - x^{\\ast}) = x^{\\ast}.\n$$\nRearranging,\n$$\nx^{\\ast} \\left( a(1 - x^{\\ast}) - 1 \\right) = 0.\n$$\nThus, either $x^{\\ast} = 0$ or $a(1 - x^{\\ast}) - 1 = 0$. Solving the latter gives\n$$\na(1 - x^{\\ast}) = 1 \\quad \\Rightarrow \\quad 1 - x^{\\ast} = \\frac{1}{a} \\quad \\Rightarrow \\quad x^{\\ast} = 1 - \\frac{1}{a}.\n$$\nTherefore, the fixed points are $x^{\\ast}_0 = 0$ for all $a$, and $x^{\\ast}_1 = 1 - \\frac{1}{a}$ provided $a \\neq 0$. On the canonical domain $a \\in [0,4]$, both exist except that $x^{\\ast}_1$ requires $a > 0$ and is within the unit interval for $a \\geq 1$ since $x^{\\ast}_1 \\in [0,1]$ when $a \\in [1,\\infty)$.\n\nStep 2: Linear stability by derivative. For a discrete-time map $x_{n+1} = f(x_n)$, the linearized dynamics near a fixed point $x^{\\ast}$ is $\\delta_{n+1} \\approx f'(x^{\\ast}) \\delta_{n}$, where $\\delta_n$ is a small perturbation. The fixed point is linearly stable if $|f'(x^{\\ast})|  1$.\n\nFirst compute $f'(x) = a(1 - 2x)$.\n\n- At $x^{\\ast}_0 = 0$: $f'(0) = a$. Stability condition $|a|  1$. Restricting to $a \\in [0,4]$ gives $a \\in [0,1)$ for stability.\n\n- At $x^{\\ast}_1 = 1 - \\frac{1}{a}$: evaluate $f'(x^{\\ast}_1)$,\n$$\nf'\\!\\left(1 - \\frac{1}{a}\\right) = a\\!\\left(1 - 2\\!\\left(1 - \\frac{1}{a}\\right)\\right) = a\\!\\left(1 - 2 + \\frac{2}{a}\\right) = a(-1) + 2 = 2 - a.\n$$\nStability condition $|2 - a|  1$ yields $1  a  3$. This is consistent with the existence condition $a \\geq 1$, so the nontrivial fixed point $x^{\\ast}_1$ is stable for $a \\in (1,3)$.\n\nSummarizing the stability intervals within $[0,4]$:\n- $x^{\\ast}_0$ is stable for $a \\in [0,1)$.\n- $x^{\\ast}_1$ is stable for $a \\in (1,3)$.\nAt $a = 1$ and $a = 3$, the fixed points are marginal and not strictly stable in the linear sense. For $a \\in (3,4]$, both fixed points are unstable, consistent with the onset of period-doubling cascades and chaotic dynamics observed in bifurcation diagrams.\n\nDefine the set of parameter values with a stable fixed point:\n$$\nS = (0,1) \\cup (1,3).\n$$\nEndpoints contribute measure zero and do not affect integrals.\n\nStep 3: Maximal Lyapunov Exponent (MLE). For a one-dimensional discrete map, the Maximal Lyapunov Exponent (MLE) along an orbit $\\{x_n\\}$ is defined by\n$$\n\\lambda = \\lim_{n \\to \\infty} \\frac{1}{n} \\sum_{k=0}^{n-1} \\ln |f'(x_k)|.\n$$\nFor a fixed-point orbit $x_n = x^{\\ast}$ for all $n$, the derivative factor is constant and the MLE reduces to\n$$\n\\lambda = \\ln |f'(x^{\\ast})|.\n$$\nThus, on each stability interval, we have:\n- For $a \\in (0,1)$ (stable $x^{\\ast}_0$): $\\lambda(a) = \\ln |f'(0)| = \\ln a$, since $a > 0$.\n- For $a \\in (1,3)$ (stable $x^{\\ast}_1$): $\\lambda(a) = \\ln |f'(x^{\\ast}_1)| = \\ln |2 - a|$.\n\nWe are to compute\n$$\nI = \\int_{a \\in S} \\lambda(a) \\, da = \\int_{0}^{1} \\ln a \\, da + \\int_{1}^{3} \\ln |2 - a| \\, da.\n$$\n\nStep 4: Evaluate the integrals.\n\nFirst integral:\n$$\n\\int_{0}^{1} \\ln a \\, da = \\left[ a \\ln a - a \\right]_{0}^{1} = \\left( 1 \\cdot \\ln 1 - 1 \\right) - \\lim_{a \\to 0^{+}} \\left( a \\ln a - a \\right) = (0 - 1) - (0 - 0) = -1.\n$$\n\nSecond integral, split at $a = 2$ to handle the absolute value:\n$$\n\\int_{1}^{3} \\ln |2 - a| \\, da = \\int_{1}^{2} \\ln(2 - a) \\, da + \\int_{2}^{3} \\ln(a - 2) \\, da.\n$$\nFor the first part, let $u = 2 - a$, so $du = -da$. As $a$ goes from $1$ to $2$, $u$ goes from $1$ to $0$:\n$$\n\\int_{1}^{2} \\ln(2 - a) \\, da = \\int_{1}^{0} \\ln u \\, (-du) = \\int_{0}^{1} \\ln u \\, du = \\left[ u \\ln u - u \\right]_{0}^{1} = -1.\n$$\nFor the second part, let $v = a - 2$, so $dv = da$. As $a$ goes from $2$ to $3$, $v$ goes from $0$ to $1$:\n$$\n\\int_{2}^{3} \\ln(a - 2) \\, da = \\int_{0}^{1} \\ln v \\, dv = \\left[ v \\ln v - v \\right]_{0}^{1} = -1.\n$$\nTherefore,\n$$\n\\int_{1}^{3} \\ln |2 - a| \\, da = -1 + (-1) = -2.\n$$\n\nCombining,\n$$\nI = \\int_{0}^{1} \\ln a \\, da + \\int_{1}^{3} \\ln |2 - a| \\, da = -1 + (-2) = -3.\n$$\n\nInterpretation: The integral $I$ aggregates the Maximal Lyapunov Exponent of the stable fixed points across all parameter values in $S$. Its negative value reflects the average contraction (lack of sensitivity to initial conditions) in these parameter regimes, and the boundaries $a = 1$ and $a = 3$ mark local bifurcation thresholds where stability is lost via a transcritical-like exchange at $a=1$ and a flip (period-doubling) bifurcation at $a=3$.",
            "answer": "$$\\boxed{-3}$$"
        },
        {
            "introduction": "While analytical methods are powerful for simple orbits like fixed points, most interesting dynamics, especially chaos, require numerical investigation. This exercise tasks you with implementing an algorithm to compute the Lyapunov exponent from its definition as a time-average of local stretching rates along an orbit. This hands-on coding practice develops essential computational skills and provides insight into the practical properties of this key indicator of chaos, such as convergence and independence from initial conditions. ",
            "id": "4263792",
            "problem": "Implement a program that estimates the largest Lyapunov exponent for the one-dimensional logistic map purely from first principles of sensitivity to initial conditions. The logistic map is defined by the recurrence $x_{n+1} = a\\,x_n\\,(1 - x_n)$ on the interval $[0,1]$ for a control parameter $a \\in [0,4]$. Begin from the definition of sensitivity to initial conditions and the differentiability of the map: if a differentiable map $f$ governs the evolution $x_{n+1} = f(x_n)$, then a small perturbation $\\delta_n$ between two nearby trajectories evolves according to local linearization. Use this as the fundamental base to derive an algorithm that estimates the exponential rate of separation along an orbit of the logistic map, and hence the largest Lyapunov exponent.\n\nYour implementation requirements are as follows.\n\n- You must design a numerically stable algorithm to estimate the largest Lyapunov exponent that:\n  - Iterates the logistic map $x_{n+1} = a\\,x_n\\,(1 - x_n)$ for a given parameter $a$, initial condition $x_0 \\in (0,1)$, a total iteration length $N$, and a transient cut length $T$ where $0 \\leq T  N$.\n  - Discards the first $T$ iterates before accumulating any quantity related to local expansion rates.\n  - Accumulates local expansion rates in a manner that avoids numerical overflow, underflow, and undefined operations. Any inevitable singularities (for example, evaluating the logarithm at zero) must be avoided by appropriate numerical safeguards that do not bias the asymptotic estimate (for example, by bounding the magnitude of any factor away from zero using a very small positive threshold $\\varepsilon$ and keeping $x_n$ within $(0,1)$ using a tiny $\\varepsilon_x$ if needed).\n  - Returns a single floating-point estimate for the largest Lyapunov exponent for the given $(a,x_0,N,T)$.\n\n- Convergence and sensitivity analysis:\n  - For each test case below, compute four quantities:\n    1. A baseline estimate using the given $(a,x_0,N,T)$.\n    2. The absolute difference between the baseline estimate and the estimate obtained from a slightly perturbed initial condition $x_0'$ with the same $(a,N,T)$, to quantify insensitivity to initial conditions of the exponent estimate itself.\n    3. The absolute difference between the baseline estimate and the estimate using $(a,x_0,2N,T)$, to quantify convergence with increasing averaging length.\n    4. The absolute difference between the baseline estimate and the estimate using $(a,x_0,N,2T)$, to quantify sensitivity to the transient cut length.\n  - Each of the four quantities must be reported as a floating-point number rounded to $6$ decimal places.\n\n- Test suite:\n  - Use the following five parameter sets, each specified as $(a, x_0, x_0', N, T)$:\n    - Case $1$: $(a = 2.5,\\; x_0 = 0.123456789,\\; x_0' = 0.123456788,\\; N = 20000,\\; T = 1000)$.\n    - Case $2$: $(a = 3.2,\\; x_0 = 0.123456789,\\; x_0' = 0.223456789,\\; N = 40000,\\; T = 2000)$.\n    - Case $3$: $(a = 3.569945672,\\; x_0 = 0.101010101,\\; x_0' = 0.101010100,\\; N = 120000,\\; T = 10000)$.\n    - Case $4$: $(a = 3.8,\\; x_0 = 0.314159265,\\; x_0' = 0.314159260,\\; N = 60000,\\; T = 5000)$.\n    - Case $5$: $(a = 4.0,\\; x_0 = 0.271828182,\\; x_0' = 0.271828180,\\; N = 60000,\\; T = 5000)$.\n\n- Final output specification:\n  - For each case, output a list $[b, d_0, d_N, d_T]$ of four floating-point numbers rounded to $6$ decimal places, where:\n    - $b$ is the baseline largest Lyapunov exponent estimate for $(a,x_0,N,T)$.\n    - $d_0$ is the absolute difference between the baseline estimate and the estimate for $(a,x_0',N,T)$.\n    - $d_N$ is the absolute difference between the baseline estimate and the estimate for $(a,x_0,2N,T)$.\n    - $d_T$ is the absolute difference between the baseline estimate and the estimate for $(a,x_0,N,2T)$.\n  - Your program should produce a single line of output containing the results for all five cases as a comma-separated list enclosed in square brackets, where each element is itself the four-number list for a case. The numeric entries must be rounded to $6$ decimal places. For example, the overall shape should be\n    $$[[b_1,d_{0,1},d_{N,1},d_{T,1}],[b_2,d_{0,2},d_{N,2},d_{T,2}],[b_3,d_{0,3},d_{N,3},d_{T,3}],[b_4,d_{0,4},d_{N,4},d_{T,4}],[b_5,d_{0,5},d_{N,5},d_{T,5}]].$$",
            "solution": "The problem requires the implementation of an algorithm to estimate the largest Lyapunov exponent of the one-dimensional logistic map, derived from first principles.\n\n**1. Derivation from First Principles**\n\nThe logistic map is defined by the iterative equation:\n$$x_{n+1} = f(x_n) = a x_n (1 - x_n)$$\nwhere $x_n$ is the state of the system at step $n$ on the interval $[0, 1]$, and $a$ is a control parameter in the range $[0, 4]$.\n\nThe largest Lyapunov exponent, $\\lambda$, quantifies the average exponential rate of divergence or convergence of nearby trajectories. To derive its formula, consider two trajectories starting at infinitesimally close initial conditions, $x_0$ and $x_0' = x_0 + \\delta_0$, where $|\\delta_0|$ is very small.\n\nAfter one iteration, the separation between the trajectories becomes:\n$$\\delta_1 = x_1' - x_1 = f(x_0 + \\delta_0) - f(x_0)$$\nFor an infinitesimally small $\\delta_0$, we can use a first-order Taylor series expansion of $f(x)$ around $x_0$:\n$$f(x_0 + \\delta_0) \\approx f(x_0) + f'(x_0)\\delta_0$$\nwhere $f'(x)$ is the derivative of $f(x)$ with respect to $x$. Substituting this into the expression for $\\delta_1$ yields:\n$$\\delta_1 \\approx (f(x_0) + f'(x_0)\\delta_0) - f(x_0) = f'(x_0)\\delta_0$$\nThis shows that the initial separation $\\delta_0$ is stretched or compressed by a factor of $f'(x_0)$ after one iteration.\n\nAfter $n$ iterations, the state is given by the $n$-th composition of the map, $x_n = f^n(x_0)$. The separation between the trajectories, $\\delta_n = f^n(x_0+\\delta_0) - f^n(x_0)$, can be related to the initial separation $\\delta_0$ by repeated application of the local linearization. The derivative of the $n$-th iterate map, $(f^n)'(x_0)$, is found using the chain rule:\n$$(f^n)'(x_0) = \\frac{d}{dx}f(f(...f(x)...))|_{x=x_0} = f'(x_{n-1}) f'(x_{n-2}) \\cdots f'(x_0) = \\prod_{i=0}^{n-1} f'(x_i)$$\nwhere $x_i = f^i(x_0)$. The separation after $n$ steps is thus:\n$$\\delta_n \\approx (f^n)'(x_0) \\delta_0 = \\left(\\prod_{i=0}^{n-1} f'(x_i)\\right) \\delta_0$$\nThe magnitude of the separation evolves as $|\\delta_n| \\approx |\\delta_0| \\prod_{i=0}^{n-1} |f'(x_i)|$.\n\nThe Lyapunov exponent $\\lambda$ is defined as the long-term average of the exponential rate of separation:\n$$\\lambda = \\lim_{n \\to \\infty} \\frac{1}{n} \\ln\\left|\\frac{\\delta_n}{\\delta_0}\\right|$$\nSubstituting the expression for the separation ratio gives:\n$$\\lambda = \\lim_{n \\to \\infty} \\frac{1}{n} \\ln\\left|\\prod_{i=0}^{n-1} f'(x_i)\\right|$$\nUsing the property of logarithms that $\\ln(\\prod_i A_i) = \\sum_i \\ln(A_i)$, we arrive at the fundamental formula for the Lyapunov exponent:\n$$\\lambda = \\lim_{n \\to \\infty} \\frac{1}{n} \\sum_{i=0}^{n-1} \\ln|f'(x_i)|$$\nThis shows that $\\lambda$ is the time average of the logarithm of the absolute value of the map's derivative, evaluated along the trajectory.\n\n**2. Algorithm Formulation and Numerical Stability**\n\nFor the logistic map, $f(x) = a x (1 - x)$, the derivative is:\n$$f'(x) = a - 2ax = a(1 - 2x)$$\nA numerical estimate for $\\lambda$ can be computed by averaging over a finite number of iterations $N$. To ensure the estimate reflects the behavior on the attractor rather than the initial transient dynamics, the first $T$ iterations are discarded. The numerical estimate, $\\hat{\\lambda}$, is then calculated over the subsequent $N-T$ iterations:\n$$\\hat{\\lambda} = \\frac{1}{N-T} \\sum_{i=T}^{N-1} \\ln|a(1-2x_i)|$$\nThis formulation is numerically stable. Directly computing the product $\\prod |f'(x_i)|$ would lead to floating-point overflow or underflow for large $N$. Summing the logarithms avoids this issue.\n\nA potential numerical problem arises if an iterate $x_i$ becomes exactly $0.5$. In this case, $f'(x_i) = a(1-2 \\cdot 0.5) = 0$, and $\\ln(0)$ is undefined. While the probability of hitting this point exactly is negligible in continuous dynamics, it can occur in finite-precision arithmetic, or the value can be very close to zero. To prevent this, as suggested by the problem, a numerical safeguard is implemented by adding a very small positive constant, $\\varepsilon$, to the argument of the logarithm. We choose $\\varepsilon = 10^{-12}$. The term in the sum becomes $\\ln(|a(1-2x_i)| + \\varepsilon)$. This prevents the computation from failing and introduces a negligible bias if such an event is rare.\n\nThe algorithm is as follows:\n1.  Initialize the state $x$ with the initial condition $x_0$.\n2.  Iterate the map $T$ times, updating $x \\leftarrow a x (1 - x)$ at each step, to discard transient behavior.\n3.  Initialize a summation variable, `log_sum`, to $0$.\n4.  Iterate for an additional $N-T$ steps (from $i=T$ to $N-1$):\n    a. Calculate the derivative: $d = a(1 - 2x)$.\n    b. Add the safeguarded logarithm of its absolute value to the sum: `log_sum += np.log(np.abs(d) + epsilon)`.\n    c. Update the state for the next iteration: $x \\leftarrow a x (1 - x)$.\n5.  The estimate of the Lyapunov exponent is `log_sum / (N - T)`.\n\nThis procedure is encapsulated in a function that takes $(a, x_0, N, T)$ as input. For each test case, this function is called four times with different parameters to compute the baseline estimate and perform the required sensitivity analysis. The absolute differences are then calculated and all results are rounded to $6$ decimal places.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis for all test cases and print the results.\n    \"\"\"\n    \n    # Test cases defined as (a, x0, x0', N, T)\n    test_cases = [\n        (2.5, 0.123456789, 0.123456788, 20000, 1000),\n        (3.2, 0.123456789, 0.223456789, 40000, 2000),\n        (3.569945672, 0.101010101, 0.101010100, 120000, 10000),\n        (3.8, 0.314159265, 0.314159260, 60000, 5000),\n        (4.0, 0.271828182, 0.271828180, 60000, 5000)\n    ]\n\n    all_results = []\n\n    for a, x0, x0_prime, N, T in test_cases:\n        # 1. Baseline estimate\n        b = estimate_lyapunov(a, x0, N, T)\n\n        # 2. Sensitivity to initial condition\n        b_prime = estimate_lyapunov(a, x0_prime, N, T)\n        d0 = abs(b - b_prime)\n\n        # 3. Convergence with iteration length\n        b_2N = estimate_lyapunov(a, x0, 2 * N, T)\n        dN = abs(b - b_2N)\n\n        # 4. Sensitivity to transient cut length\n        # Ensure 2*T is less than N\n        if 2 * T = N:\n            # This case should not occur with the given test suite, but is a safeguard.\n            # Per problem spec, 2*T  N for all cases.\n            dT = np.nan\n        else:\n            b_2T = estimate_lyapunov(a, x0, N, 2 * T)\n            dT = abs(b - b_2T)\n        \n        # Collect results for this case\n        case_results = [\n            round(b, 6),\n            round(d0, 6),\n            round(dN, 6),\n            round(dT, 6)\n        ]\n        all_results.append(case_results)\n\n    # Format the final output string as specified\n    # The replace(\" \", \"\") ensures compact output like [[...],[...]]\n    final_output_string = str(all_results).replace(\" \", \"\")\n    print(final_output_string)\n\ndef estimate_lyapunov(a: float, x0: float, N: int, T: int) - float:\n    \"\"\"\n    Estimates the largest Lyapunov exponent for the logistic map.\n\n    Args:\n        a (float): The control parameter of the logistic map.\n        x0 (float): The initial condition.\n        N (int): The total number of iterations.\n        T (int): The number of transient iterations to discard.\n\n    Returns:\n        float: The estimated largest Lyapunov exponent.\n    \"\"\"\n    # A small positive constant to avoid log(0)\n    epsilon = 1e-12\n    \n    x = x0\n    \n    # Discard the first T transient iterations\n    for _ in range(T):\n        x = a * x * (1.0 - x)\n        \n    log_sum = 0.0\n    \n    # Iterate for N-T steps to accumulate the sum of logarithms of derivatives\n    num_sum_terms = N - T\n    for _ in range(num_sum_terms):\n        # The derivative of the logistic map f(x) = ax(1-x) is f'(x) = a(1-2x)\n        derivative = a * (1.0 - 2.0 * x)\n        \n        # Add the safeguarded logarithm of the absolute value of the derivative\n        log_sum += np.log(np.abs(derivative) + epsilon)\n        \n        # Update the state to the next iteration\n        x = a * x * (1.0 - x)\n        \n    # The Lyapunov exponent is the average of the log-derivatives\n    return log_sum / num_sum_terms\n\n# Execute the main function\nsolve()\n```"
        },
        {
            "introduction": "Is it possible to find an exact value for the Lyapunov exponent in a fully developed chaotic system, or are we always limited to numerical estimates? This final practice reveals a remarkable case where an exact analytical solution is possible through the use of a powerful mathematical technique called a conjugacy. By re-framing the fully chaotic logistic map at $r=4$ as a simpler, equivalent system, we can derive the precise value of its Lyapunov exponent, offering a deep insight into the elegant mathematical structure that can underlie apparent randomness. ",
            "id": "4263952",
            "problem": "Consider the one-dimensional logistic map $f_{a}:[0,1] \\to [0,1]$ defined by $f_{a}(x)=a\\,x\\,(1-x)$ at the parameter value $a=4$. The Lyapunov exponent quantifies the exponential rate of separation of nearby trajectories and, for a one-dimensional differentiable map, is defined for almost every initial condition $x_{0}\\in[0,1]$ by\n$$\n\\lambda(x_{0})=\\lim_{n\\to\\infty}\\frac{1}{n}\\sum_{k=0}^{n-1}\\ln\\left|f'(x_{k})\\right|,\n$$\nwhere $x_{k+1}=f(x_{k})$ and $f'(x)$ denotes the derivative of $f$ with respect to $x$. It is known that at $a=4$ the dynamics admits a trigonometric reparameterization $x=\\sin^{2}(\\theta)$ that conjugates the map on $[0,1]$ to a doubling map on an angular variable.\n\nStarting from the core definitions above and using only well-tested facts from dynamical systems and trigonometry, derive the exact analytic expression for the Lyapunov exponent $\\lambda$ of the logistic map at $a=4$. Your derivation must explicitly justify the measure with respect to which any averages are taken and must not assume any pre-stated invariant density without proof. Express your final answer as a single closed-form expression. No numerical approximation or rounding is required.",
            "solution": "The problem asks for the exact analytic expression for the Lyapunov exponent $\\lambda$ of the logistic map $f_a(x) = a\\,x\\,(1-x)$ for the parameter value $a=4$.\n\nThe logistic map is given by $f_4(x) = 4x(1-x)$ on the interval $[0,1]$.\nThe Lyapunov exponent for a one-dimensional map $f$ is defined as the time average:\n$$\n\\lambda(x_{0})=\\lim_{n\\to\\infty}\\frac{1}{n}\\sum_{k=0}^{n-1}\\ln\\left|f'(x_{k})\\right|\n$$\nwhere the trajectory is generated by the iteration $x_{k+1}=f(x_{k})$. For an ergodic system, this time average is equal to the space average with respect to the invariant measure for almost every initial condition $x_0$.\n\nThe derivative of the map is $f_4'(x) = \\frac{d}{dx}(4x-4x^2) = 4 - 8x$.\n\nThe problem suggests using a trigonometric reparameterization. We introduce the transformation $h(y) = \\sin^2(\\pi y)$, which maps the interval $y \\in [0,1]$ to $x \\in [0,1]$. Let us analyze the dynamics in this new coordinate system.\nLet $x_k = h(y_k) = \\sin^2(\\pi y_k)$.\nThe logistic map iteration $x_{k+1} = f_4(x_k)$ becomes:\n$$\n\\sin^2(\\pi y_{k+1}) = 4\\sin^2(\\pi y_k)(1 - \\sin^2(\\pi y_k))\n$$\nUsing the identity $1-\\sin^2(\\theta) = \\cos^2(\\theta)$, we get:\n$$\n\\sin^2(\\pi y_{k+1}) = 4\\sin^2(\\pi y_k)\\cos^2(\\pi y_k)\n$$\nThis can be rewritten using the double-angle identity $\\sin(2\\theta) = 2\\sin(\\theta)\\cos(\\theta)$:\n$$\n\\sin^2(\\pi y_{k+1}) = (2\\sin(\\pi y_k)\\cos(\\pi y_k))^2 = (\\sin(2\\pi y_k))^2\n$$\nThis implies $\\sin(\\pi y_{k+1}) = |\\sin(2\\pi y_k)|$. Since $\\sin(z+\\pi) = -\\sin(z)$, we have $\\sin^2(z+\\pi) = \\sin^2(z)$. Thus, we can write the relationship between $y_{k+1}$ and $y_k$ as:\n$$\n\\pi y_{k+1} = 2\\pi y_k \\pmod{\\pi}\n$$\nDividing by $\\pi$, we obtain the conjugate map for $y$:\n$$\ny_{k+1} = 2y_k \\pmod{1}\n$$\nThis is the Bernoulli shift map, or doubling map, which we denote as $g(y) = 2y \\pmod 1$. The map $f_4(x)$ is conjugate to $g(y)$ via the transformation $h(y) = \\sin^2(\\pi y)$, satisfying the relation $f_4(h(y)) = h(g(y))$.\n\nWe now relate the Lyapunov exponent of $f_4$ to that of $g$. Differentiating the conjugacy relation $f_4(h(y)) = h(g(y))$ with respect to $y$ using the chain rule gives:\n$$\nf_4'(h(y)) \\cdot h'(y) = h'(g(y)) \\cdot g'(y)\n$$\nSubstituting $x_k = h(y_k)$ and $y_{k+1} = g(y_k)$, we have:\n$$\nf_4'(x_k) = \\frac{h'(y_{k+1})}{h'(y_k)} g'(y_k)\n$$\nTaking the natural logarithm of the absolute value:\n$$\n\\ln|f_4'(x_k)| = \\ln|h'(y_{k+1})| - \\ln|h'(y_k)| + \\ln|g'(y_k)|\n$$\nNow, we sum this expression from $k=0$ to $n-1$ and divide by $n$ to find the average:\n$$\n\\frac{1}{n}\\sum_{k=0}^{n-1}\\ln|f_4'(x_k)| = \\frac{1}{n}\\sum_{k=0}^{n-1}(\\ln|h'(y_{k+1})| - \\ln|h'(y_k)|) + \\frac{1}{n}\\sum_{k=0}^{n-1}\\ln|g'(y_k)|\n$$\nThe first term on the right-hand side is a telescoping sum:\n$$\n\\frac{1}{n}\\sum_{k=0}^{n-1}(\\ln|h'(y_{k+1})| - \\ln|h'(y_k)|) = \\frac{\\ln|h'(y_n)| - \\ln|h'(y_0)|}{n}\n$$\nThe derivative of the conjugacy is $h'(y) = \\frac{d}{dy}\\sin^2(\\pi y) = 2\\pi\\sin(\\pi y)\\cos(\\pi y) = \\pi\\sin(2\\pi y)$. The term $\\ln|h'(y)|$ is bounded for any trajectory that avoids the points $y = 0, 1/2, 1$. For almost all initial conditions $y_0$, the trajectory $\\{y_n\\}$ is uniformly distributed in $[0,1]$ and does not systematically approach these points. Therefore, as $n \\to \\infty$, the term $\\frac{1}{n}(\\ln|h'(y_n)| - \\ln|h'(y_0)|)$ vanishes.\n\nThis leaves us with the equality of the Lyapunov exponents:\n$$\n\\lambda_{f_4} = \\lim_{n\\to\\infty} \\frac{1}{n}\\sum_{k=0}^{n-1}\\ln|g'(y_k)| = \\lambda_g\n$$\nThe problem is reduced to finding the Lyapunov exponent of the doubling map $g(y) = 2y \\pmod 1$. By the ergodic theorem, this can be calculated as a space average with respect to the invariant measure of $g$:\n$$\n\\lambda_g = \\int_0^1 \\ln|g'(y)| \\rho_g(y) dy\n$$\nwhere $\\rho_g(y)$ is the invariant density of the map $g$. As required, we must justify this density. An invariant density $\\rho(y)$ must satisfy the Perron-Frobenius equation $\\rho(y) = \\sum_{z \\in g^{-1}(y)} \\frac{\\rho(z)}{|g'(z)|}$.\nFor the map $g(y) = 2y \\pmod 1$, the derivative is $|g'(y)|=2$ for all $y \\ne 1/2$. For any $y \\in [0,1)$, the preimages are $z_1 = y/2$ and $z_2 = (y+1)/2$.\nLet's test the uniform density $\\rho_g(y)=1$ for $y \\in [0,1]$:\n$$\n1 = \\frac{\\rho_g(y/2)}{2} + \\frac{\\rho_g((y+1)/2)}{2} = \\frac{1}{2} + \\frac{1}{2} = 1\n$$\nThe equation holds. Thus, the uniform density $\\rho_g(y)=1$ is the invariant density for the doubling map.\n\nNow we can compute the integral for $\\lambda_g$:\n$$\n\\lambda_g = \\int_0^1 \\ln|2| \\cdot 1 \\, dy = \\ln(2) \\int_0^1 dy = \\ln(2) \\cdot (1-0) = \\ln(2)\n$$\nSince $\\lambda_{f_4} = \\lambda_g$, the Lyapunov exponent for the logistic map at $a=4$ is $\\ln(2)$.\n\nTo verify this result, we could also compute the integral for $\\lambda_{f_4}$ directly, using the invariant density for the logistic map, $\\rho_{f_4}(x) = \\frac{1}{\\pi\\sqrt{x(1-x)}}$, which can be derived from the uniform density $\\rho_g(y)$ and the transformation $x=h(y)$. The calculation $\\lambda_{f_4} = \\int_0^1 \\ln|4-8x| \\frac{1}{\\pi\\sqrt{x(1-x)}} dx$ also yields $\\ln(2)$, confirming the result obtained via the more elegant method of conjugation.\nThe derivation via conjugation is more direct. It relies on the established property that the Lyapunov exponent is an invariant under smooth enough conjugacies and on the proven fact that the invariant measure for the simpler conjugate map is uniform.",
            "answer": "$$\n\\boxed{\\ln(2)}\n$$"
        }
    ]
}