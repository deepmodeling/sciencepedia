{
    "hands_on_practices": [
        {
            "introduction": "对动力系统的深入理解始于对线性系统的掌握。本练习将引导你运用特征值和特征向量这一基本工具，来判断平衡点的稳定性并剖析相空间的结构。通过这个过程，你将实践一个核心原理：对于一个稳定的线性系统，其长期演化行为通常由衰减最慢的模式所主导，这决定了系统趋向吸引子的收敛速率。",
            "id": "4262979",
            "problem": "考虑$\\mathbb{R}^{2}$中的线性时不变动力系统 $\\dot{x} = A x$，其中\n$$\nA = \\begin{pmatrix} -2  1 \\\\ 0  -1 \\end{pmatrix}.\n$$\n根据适用于连续时间线性系统的第一性原理进行分析：流由 $x(t) = \\exp(tA)\\,x(0)$ 给出，稳定和不稳定子空间通过流在限制到线性子空间时的长时间衰减或增长来定义，而吸引子是在前向流作用下吸引邻域内所有轨迹的集合。对于$\\mathbb{R}^{2}$上的一个固定范数 $\\|\\cdot\\|$，将轨迹的渐近指数率定义为\n$$\n\\lambda(x(0)) = \\lim_{t \\to \\infty} \\frac{1}{t} \\ln \\|x(t)\\|,\n$$\n只要该极限存在。对于此系统：\n- 确定流的稳定和不稳定子空间。\n- 判断原点是否为吸引子，并根据$\\exp(tA)$的长时间行为解释你的理由。\n- 对于一般初始条件（即对于$\\mathbb{R}^{2}$中一个全测度、开稠密子集中的所有初始条件），计算$\\lambda(x(0))$的共同值$\\lambda_{*}$。\n\n将你的最终答案报告为单个实数$\\lambda_{*}$。不需要单位。如果得到数值，请提供精确值（不要四舍五入）。",
            "solution": "该问题要求分析$\\mathbb{R}^{2}$中的线性时不变系统 $\\dot{x} = A x$，其中矩阵$A$由下式给出\n$$\nA = \\begin{pmatrix} -2  1 \\\\ 0  -1 \\end{pmatrix}.\n$$\n分析将从第一性原理出发，首先确定矩阵$A$的特征值和特征向量，它们决定了系统的行为。\n\n矩阵$A$是上三角矩阵，因此其特征值是其对角线元素。设特征值为$\\lambda_1$和$\\lambda_2$。\n$$\n\\lambda_1 = -2 \\quad \\text{和} \\quad \\lambda_2 = -1.\n$$\n两个特征值都是实数且为负。\n\n接下来，我们求解相应的特征向量。与特征值$\\lambda$相关的特征向量$v$满足方程$(A - \\lambda I)v = 0$。\n\n对于 $\\lambda_1 = -2$：\n$$\n(A - \\lambda_1 I)v_1 = \\left( \\begin{pmatrix} -2  1 \\\\ 0  -1 \\end{pmatrix} - \\begin{pmatrix} -2  0 \\\\ 0  -2 \\end{pmatrix} \\right) v_1 = \\begin{pmatrix} 0  1 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} v_{1,1} \\\\ v_{1,2} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}.\n$$\n该矩阵方程得出标量方程 $v_{1,2} = 0$。分量 $v_{1,1}$ 可以是任何非零实数。我们选择 $v_{1,1} = 1$。因此，对应于 $\\lambda_1 = -2$ 的特征向量是\n$$\nv_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}.\n$$\n特征空间是 $E_1 = \\text{span}\\{v_1\\}$。\n\n对于 $\\lambda_2 = -1$：\n$$\n(A - \\lambda_2 I)v_2 = \\left( \\begin{pmatrix} -2  1 \\\\ 0  -1 \\end{pmatrix} - \\begin{pmatrix} -1  0 \\\\ 0  -1 \\end{pmatrix} \\right) v_2 = \\begin{pmatrix} -1  1 \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} v_{2,1} \\\\ v_{2,2} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}.\n$$\n这给出了方程 $-v_{2,1} + v_{2,2} = 0$，即 $v_{2,1} = v_{2,2}$。我们选择 $v_{2,1} = 1$，因此 $v_{2,2}=1$。对应于 $\\lambda_2 = -1$ 的特征向量是\n$$\nv_2 = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}.\n$$\n特征空间是 $E_2 = \\text{span}\\{v_2\\}$。\n\n在确定了特征值和特征向量之后，我们可以回答具体问题。\n\n**稳定和不稳定子空间**\n稳定子空间，记作$E^s$，是由对应于具有负实部特征值的特征向量所张成的线性子空间。不稳定子空间，$E^u$，是由对应于具有正实部特征值的特征向量所张成的。\n在此系统中，两个特征值 $\\lambda_1 = -2$ 和 $\\lambda_2 = -1$ 都是负数。因此，两个相关的特征空间 $E_1$ 和 $E_2$ 都构成了稳定子空间。\n$$\nE^s = E_1 \\oplus E_2 = \\text{span}\\{v_1, v_2\\} = \\mathbb{R}^2.\n$$\n由于没有具有正实部的特征值，不稳定子空间是平凡子空间：\n$$\nE^u = \\{0\\}.\n$$\n\n**原点的吸引子状态**\n对于初始条件$x(0)$，系统的通解可以表示为与每个特征值-特征向量对相关的模态的线性组合：\n$$\nx(t) = c_1 \\exp(\\lambda_1 t) v_1 + c_2 \\exp(\\lambda_2 t) v_2 = c_1 \\exp(-2t) \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} + c_2 \\exp(-t) \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}.\n$$\n常数$c_1$和$c_2$由初始条件$x(0)$确定。吸引子是吸引来自一个邻域的所有轨迹的集合。要使原点成为吸引子，我们必须对原点邻域中的所有$x(0)$都有$\\lim_{t \\to \\infty} x(t) = 0$。对于线性系统，这等同于检查所有$x(0) \\in \\mathbb{R}^2$。\n当$t \\to \\infty$时，指数项$\\exp(-2t)$和$\\exp(-t)$都趋近于$0$。因此，对于任何有限常数$c_1$和$c_2$，$x(t)$求和式中的两项都衰减到零向量。\n$$\n\\lim_{t \\to \\infty} x(t) = \\lim_{t \\to \\infty} \\left( c_1 \\exp(-2t) v_1 + c_2 \\exp(-t) v_2 \\right) = 0 \\cdot v_1 + 0 \\cdot v_2 = 0.\n$$\n这也可以从矩阵指数看出。$\\exp(tA)$的特征值是$\\exp(t\\lambda_i)$。由于$\\lambda_1$和$\\lambda_2$都是负数，所以$\\lim_{t \\to \\infty} \\exp(t\\lambda_i) = 0$。这意味着$\\lim_{t \\to \\infty} \\exp(tA) = 0_M$，其中$0_M$是零矩阵。因此，$\\lim_{t \\to \\infty} x(t) = \\lim_{t \\to \\infty} \\exp(tA) x(0) = 0_M x(0) = 0$。\n由于所有轨迹都收敛到原点，原点是一个全局渐近稳定的不动点。因此，原点$\\{0\\}$是一个吸引子。\n\n**渐近指数率 $\\lambda_{*}$**\n我们被要求计算一般初始条件下的渐近指数率：\n$$\n\\lambda(x(0)) = \\lim_{t \\to \\infty} \\frac{1}{t} \\ln \\|x(t)\\|.\n$$\n一个一般初始条件$x(0)$是不位于任何特殊的、低维子空间上的条件。在这种情况下，状态空间是$\\mathbb{R}^2$，而特殊子空间是特征空间$E_1$和$E_2$，它们是直线。一个一般初始条件可以写成$x(0) = c_1 v_1 + c_2 v_2$，其中$c_1 \\neq 0$和$c_2 \\neq 0$。使得$c_2=0$的点集是直线$E_1$，这是$\\mathbb{R}^2$中的一个零测度集。因此，一个一般初始条件具有$c_2 \\neq 0$。\n\n解为$x(t) = c_1 \\exp(-2t) v_1 + c_2 \\exp(-t) v_2$。为了分析长时间行为，我们提出衰减最慢的项，即$\\exp(-t)$：\n$$\nx(t) = \\exp(-t) \\left( c_1 \\exp(-t) v_1 + c_2 v_2 \\right).\n$$\n现在，我们取范数。最终结果与所选的具体范数无关，因为$\\mathbb{R}^n$上的所有范数都是等价的。\n$$\n\\|x(t)\\| = \\|\\exp(-t) \\left( c_1 \\exp(-t) v_1 + c_2 v_2 \\right)\\| = \\exp(-t) \\|c_1 \\exp(-t) v_1 + c_2 v_2\\|.\n$$\n当$t \\to \\infty$时，项$c_1 \\exp(-t) v_1$趋近于零向量，而$c_2 v_2$保持不变。\n$$\n\\lim_{t \\to \\infty} \\|c_1 \\exp(-t) v_1 + c_2 v_2\\| = \\|0 + c_2 v_2\\| = |c_2| \\|v_2\\|.\n$$\n由于初始条件是一般的，$c_2 \\neq 0$，并且由于$v_2$是一个非零特征向量，$|c_2| \\|v_2\\|$是一个有限的正数常量。我们称这个常量为$K$。\n现在我们可以计算$\\lambda(x(0))$的极限：\n$$\n\\lambda(x(0)) = \\lim_{t \\to \\infty} \\frac{1}{t} \\ln \\left( \\exp(-t) \\|c_1 \\exp(-t) v_1 + c_2 v_2\\| \\right).\n$$\n利用对数的性质：\n$$\n\\lambda(x(0)) = \\lim_{t \\to \\infty} \\frac{1}{t} \\left( \\ln(\\exp(-t)) + \\ln(\\|c_1 \\exp(-t) v_1 + c_2 v_2\\|) \\right)\n$$\n$$\n\\lambda(x(0)) = \\lim_{t \\to \\infty} \\left( \\frac{-t}{t} + \\frac{\\ln(\\|c_1 \\exp(-t) v_1 + c_2 v_2\\|)}{t} \\right)\n$$\n$$\n\\lambda(x(0)) = -1 + \\lim_{t \\to \\infty} \\frac{\\ln(\\|c_1 \\exp(-t) v_1 + c_2 v_2\\|)}{t}.\n$$\n如前所述，对数内的项趋近于常数$K = |c_2| \\|v_2\\|$。该极限变为：\n$$\n\\lim_{t \\to \\infty} \\frac{\\ln(K)}{t} = 0.\n$$\n因此，对于任何一般初始条件，渐近指数率为：\n$$\n\\lambda(x(0)) = -1 + 0 = -1.\n$$\n这个共同值就是$\\lambda_{*}$。一般轨迹的衰减率由具有最大实部的特征值决定，在本例中即为$\\lambda_2 = -1$。\n最终答案是$\\lambda_{*} = -1$。",
            "answer": "$$\\boxed{-1}$$"
        },
        {
            "introduction": "从线性系统过渡到非线性领域，我们会发现系统的行为变得更加丰富和复杂。本练习采用一个经典的一维非线性方程，来揭示动力学中的标志性特征，例如多重平衡点的共存以及吸引盆的概念。通过分析这个系统，你将亲身体会相空间如何被分割成不同的区域，这些区域决定了系统状态的最终归宿——这是一个仅靠局部线性化分析无法完全揭示的全局图景。",
            "id": "4262955",
            "problem": "考虑在 $\\mathbb{R}$ 上的由 $\\dot{x} = -x + x^{3}$ 给定的一维自治动力系统，其初始条件为 $x(0) = x_{0} \\in \\mathbb{R}$。请从第一性原理出发，使用动力系统的核心定义：平衡点由 $\\dot{x} = 0$ 定义，李雅普诺夫稳定性和渐近稳定性根据解在平衡点邻域内的行为来定义，前向轨线的 $\\omega$-极限集是当 $t \\to +\\infty$ 时 $x(t)$ 的所有聚点的集合，该定义仅当解对所有 $t \\ge 0$ 都存在时才成立；如果最大前向存在时间是有限的，则 $\\omega$-极限集被视为空集。根据需要使用常微分方程的存在唯一性定理和标准比较法；除了这些基础知识外，不要假设任何预先推导出的公式。\n\n在这些基础上，确定所有作为 $x_{0}$ 函数的 $\\omega$-极限集，并对这个在 $\\mathbb{R}$ 上的系统的所有吸引子及其吸引盆进行分类。然后，使用你的分类结果，计算初始条件 $x_{0} \\in [-3,3]$ 中其 $\\omega$-极限集为 $\\{0\\}$ 的集合的勒贝格测度（长度）。将最终数值答案表示为精确值。无需四舍五入，也无需报告物理单位。",
            "solution": "对用户提供的问题进行有效性评估。\n\n### 步骤 1：提取已知条件\n- 动力系统：$\\dot{x} = -x + x^{3}$，在 $\\mathbb{R}$ 上。\n- 初始条件：$x(0) = x_{0} \\in \\mathbb{R}$。\n- 平衡点的定义：$\\dot{x} = 0$。\n- 将使用李雅普诺夫稳定性和渐近稳定性的定义。\n- 前向轨线 $x(t)$ 的 $\\omega$-极限集的定义：当 $t \\to +\\infty$ 时 $x(t)$ 的所有聚点的集合，仅当解对所有 $t \\ge 0$ 都存在时才有定义。\n- 有限逃逸时间的 $\\omega$-极限集的定义：如果最大前向存在时间是有限的，则 $\\omega$-极限集为空集。\n- 允许使用的工具：常微分方程的存在唯一性定理，标准比较法。\n- 任务 1：确定所有作为 $x_{0}$ 函数的 $\\omega$-极限集。\n- 任务 2：对所有吸引子及其吸引盆进行分类。\n- 任务 3：计算集合 $\\{x_{0} \\in [-3,3] \\mid \\omega(x_0) = \\{0\\}\\}$ 的勒贝格测度。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学性：** 该问题描述了一个带有多项式向量场的一维自治常微分方程。这是动力系统数学领域的一个标准课题。它不含伪科学和事实错误。\n- **良定性：** 函数 $f(x) = -x + x^3$ 是一个多项式，在 $\\mathbb{R}$ 上是无限可微的 ($C^\\infty$)。因此，它在 $\\mathbb{R}$ 上是局部利普希茨连续的。常微分方程的存在唯一性定理保证了对于任何初始条件 $x_0 \\in \\mathbb{R}$，都存在唯一的局部解。该问题结构良好，对所有指定任务都能得出唯一的、有意义的解。\n- **客观性：** 该问题以精确的数学语言陈述，没有歧义或主观论断。\n\n该问题没有表现出验证清单中列出的任何缺陷（不具科学性、无法形式化、设定不完整、不切实际、非良定、故作高深或超出科学可验证性）。\n\n### 步骤 3：结论与行动\n问题有效。将提供完整解答。\n\n### 解题过程\n该动力系统由自治一阶常微分方程 $\\dot{x} = f(x)$ 描述，其中 $f(x) = -x + x^3$。\n\n**1. 平衡点与稳定性**\n平衡点，记为 $x^*$，是 $\\dot{x} = 0$ 的解。\n$$ -x + x^3 = 0 $$\n$$ x(x^2 - 1) = 0 $$\n$$ x(x - 1)(x + 1) = 0 $$\n平衡点为 $x^*_1 = -1$，$x^*_2 = 0$ 和 $x^*_3 = 1$。\n\n为了分析稳定性，我们考察在平衡点之间的区间上 $\\dot{x} = f(x)$ 的符号：\n- 对于 $x > 1$ (例如 $x=2$)，$\\dot{x} = 2^3 - 2 = 6 > 0$。轨线向右移动，远离 $x=1$。\n- 对于 $x \\in (0, 1)$ (例如 $x=0.5$)，$\\dot{x} = (0.5)^3 - 0.5 = 0.125 - 0.5 = -0.375  0$。轨线向左移动，趋向 $x=0$。\n- 对于 $x \\in (-1, 0)$ (例如 $x=-0.5$)，$\\dot{x} = (-0.5)^3 - (-0.5) = -0.125 + 0.5 = 0.375 > 0$。轨线向右移动，趋向 $x=0$。\n- 对于 $x  -1$ (例如 $x=-2$)，$\\dot{x} = (-2)^3 - (-2) = -8 + 2 = -6  0$。轨线向左移动，远离 $x=-1$。\n\n此相线分析表明 $x^*=0$ 是稳定的，而 $x^*=-1$ 和 $x^*=1$ 是不稳定的。\n我们可以通过线性化系统来证实这一点。$f(x)$ 的导数是 $f'(x) = 3x^2 - 1$。\n- 在 $x^*=0$ 处：$f'(0) = 3(0)^2 - 1 = -1  0$。该平衡点是线性稳定的，因此是局部渐近稳定的。\n- 在 $x^*=1$ 处：$f'(1) = 3(1)^2 - 1 = 2 > 0$。该平衡点是线性不稳定的（一个排斥点）。\n- 在 $x^*=-1$ 处：$f'(-1) = 3(-1)^2 - 1 = 2 > 0$。该平衡点是线性不稳定的（一个排斥点）。\n\n**2. $\\omega$-极限集**\n我们必须为每个初始条件 $x_0 \\in \\mathbb{R}$ 确定其 $\\omega$-极限集 $\\omega(x_0)$。问题规定，如果解并非对所有 $t \\ge 0$ 都存在，则 $\\omega(x_0)$ 为空集。\n\n首先，我们分析解的最大存在区间。\n- 对于初始条件 $|x_0| > 1$，例如 $x_0 > 1$，轨线 $x(t)$ 是严格递增的。对于 $x > \\sqrt{2}$，我们有 $x^2 > 2$，这意味着 $x^3 > 2x$，所以 $x^3-x > x^3 - x^3/2 = x^3/2$。因此，对于大的 $x$，$\\dot{x} = x^3-x$ 被一个形如 $cy^p$（其中 $p>1$）的函数从下方界定（例如 $\\dot{x} > x^3/2$）。$\\dot{y} = y^3/2$ 在 $y(t_0) = x(t_0)$ 下的解是 $y(t) = ( C - (t-t_0) )^{-1/2}$，它会在有限时间内爆破。根据常微分方程的比较原理，解 $x(t)$ 也必定在有限时间内爆破到 $+\\infty$。\n- 对于 $x_0  -1$ 的类似论证表明，$x(t)$ 在有限时间内爆破到 $-\\infty$。\n- 因此，对于任何 $|x_0| > 1$，解具有有限的最大前向存在时间。根据问题定义，这些初始条件的 $\\omega$-极限集是空集 $\\emptyset$。\n\n接下来，考虑初始条件 $|x_0| \\le 1$。\n- 从相线分析可知，如果 $x_0 \\in [-1, 1]$，轨线 $x(t)$ 对所有 $t \\ge 0$ 都保持在紧区间 $[-1, 1]$ 内。流在边界 $x=\\pm 1$ 处指向内部。因此，从这个区间开始的解对所有正时间都存在。\n- 如果 $x_0 \\in \\{-1, 0, 1\\}$，初始条件是一个平衡点。解是常数：对所有 $t$，$x(t) = x_0$。聚点的集合就是该点本身。\n  - $\\omega(-1) = \\{-1\\}$\n  - $\\omega(0) = \\{0\\}$\n  - $\\omega(1) = \\{1\\}$\n- 如果 $x_0 \\in (0, 1)$，相线分析表明 $\\dot{x}  0$，所以 $x(t)$ 是一个严格递减函数。它有下界 $0$。根据单调收敛定理，极限 $\\lim_{t\\to\\infty} x(t)$ 存在且等于某个值 $L \\in [0, 1)$。对于一维自治系统，有界轨线的 $\\omega$-极限集必须是单个平衡点。在区间 $[0, 1)$ 内唯一的平衡点是 $x^*=0$。因此，$\\lim_{t\\to\\infty} x(t) = 0$，且 $\\omega(x_0) = \\{0\\}$。\n- 如果 $x_0 \\in (-1, 0)$，相线分析表明 $\\dot{x} > 0$，所以 $x(t)$ 是一个有上界 $0$ 的严格递增函数。通过类似的论证，$\\lim_{t\\to\\infty} x(t) = 0$，且 $\\omega(x_0) = \\{0\\}$。\n\n$\\omega$-极限集总结：\n$$ \\omega(x_0) = \\begin{cases} \\emptyset  \\text{if } |x_0| > 1 \\\\ \\{1\\}  \\text{if } x_0 = 1 \\\\ \\{0\\}  \\text{if } x_0 \\in (-1, 1) \\\\ \\{-1\\}  \\text{if } x_0 = -1 \\end{cases} $$\n\n**3. 吸引子与吸引盆**\n吸引子是一个紧致、不变的集合 $A$，对于它存在一个邻域 $U$，使得对于任何 $x_0 \\in U$，从 $x_0$ 开始的轨线都收敛到 $A$。$A$ 的吸引盆，记为 $\\mathcal{B}(A)$，是所有满足 $\\omega(x_0) \\subseteq A$ 的 $x_0$ 的集合。要使 $A$ 成为一个吸引子，$\\mathcal{B}(A)$ 必须是 $A$ 的一个邻域。\n\n- 候选吸引子 $\\{0\\}$：该集合是紧致且不变的。其吸引盆为 $\\mathcal{B}(\\{0\\}) = \\{x_0 \\in \\mathbb{R} \\mid \\omega(x_0) \\subseteq \\{0\\}\\}$。根据我们的分析，这恰好是使得 $\\omega(x_0) = \\{0\\}$ 的 $x_0$ 的集合，即开区间 $(-1, 1)$。因为 $(-1, 1)$ 是一个包含 $0$ 的开集，所以 $\\{0\\}$ 是一个吸引子。\n- 候选吸引子 $\\{1\\}$：该集合是紧致且不变的。其吸引盆为 $\\mathcal{B}(\\{1\\}) = \\{x_0 \\in \\mathbb{R} \\mid \\omega(x_0) \\subseteq \\{1\\}\\}$。这个集合就是 $\\{1\\}$。这不是 $\\{1\\}$ 的一个邻域。因此，$\\{1\\}$ 不是一个吸引子。它是一个排斥不动点。\n- 候选吸引子 $\\{-1\\}$：类似地，其吸引盆是 $\\{-1\\}$，这不是一个邻域。因此，$\\{-1\\}$ 不是一个吸引子。\n\n该系统唯一的吸引子是平衡点 $\\{0\\}$。其吸引盆是区间 $(-1, 1)$。\n\n**4. 勒贝格测度计算**\n最后的任务是计算初始条件 $x_0 \\in [-3,3]$ 中其 $\\omega$-极限集为 $\\{0\\}$ 的集合的勒贝格测度（长度）。\n设这个集合为 $S$。\n$$ S = \\{x_0 \\in [-3, 3] \\mid \\omega(x_0) = \\{0\\}\\} $$\n根据我们的分析，在 $\\mathbb{R}$ 中所有 $\\omega$-极限集为 $\\{0\\}$ 的初始条件的集合是区间 $(-1, 1)$。我们需要求这个集合与区间 $[-3, 3]$ 的交集。\n$$ S = (-1, 1) \\cap [-3, 3] = (-1, 1) $$\n区间 $(a, b)$ 的勒贝格测度由 $\\mu((a, b)) = b - a$ 给出。\n对于集合 $S = (-1, 1)$，其测度为：\n$$ \\mu(S) = 1 - (-1) = 2 $$\n在 $[-3, 3]$ 中，轨线收敛到原点的初始条件集合的勒贝格测度是 $2$。",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "动力系统的探索最终将我们引向混沌的疆域，在这里，系统的行为展现出无尽的复杂性和不可预测性。这项动手编程实践将指导你完成一个核心任务：通过计算著名的洛伦兹系统的李雅普诺夫指数，来从数值上验证混沌吸引子的存在。你将亲手实现标准算法，结合数值积分与QR分解重正交化，从而构建一个能够区分有序与混沌动态的实用工具——这是研究复杂系统不可或缺的关键技能。",
            "id": "4263005",
            "problem": "给定连续时间洛伦兹系统，这是一个由常微分方程 (ODE) $$\\frac{d\\mathbf{x}}{dt}=\\mathbf{f}(\\mathbf{x};\\sigma,\\rho,\\beta),$$ 定义的规范三维非线性动力系统，其中状态向量为 $\\mathbf{x}=(x,y,z)$，参数三元组为 $(\\sigma,\\rho,\\beta)$。矢量场由下式指定：$$\\mathbf{f}(\\mathbf{x};\\sigma,\\rho,\\beta)=\\left(\\sigma(y-x),\\;x(\\rho-z)-y,\\;xy-\\beta z\\right)。$$ 在复杂系统和网络科学中，吸引子是相空间中的一个集合，对于大范围的初始条件，轨迹都会向其演化。混沌吸引子的特征是对初始条件的敏感依赖性，这通过正的李雅普诺夫指数来量化。\n\n您的任务是实现一个完整的确定性程序，通过追踪李雅普诺夫指数来分析洛伦兹吸引子的参数鲁棒性，并验证混沌吸引在指定的 $(\\sigma,\\rho,\\beta)$ 范围内的持续性。该分析必须基于第一性原理。请使用以下方案以确保可复现性和科学真实性：\n\n- 使用步长为 $\\Delta t=0.01$ 的定步长四阶龙格－库塔积分器来对流及其切向线性化进行积分。\n- 积分总时间为 $T=30$，并从李雅普诺夫统计中舍弃初始暂态 $T_{\\text{trans}}=5$，以减轻初始化偏差。\n- 每 $m=5$ 个积分步长，通过使用基于 QR 分解 (QR) 实现的格拉姆-施密特过程对切向基进行重新正交归一化，以维持切向演化的数值稳定性。\n- 如果最大李雅普诺夫指数严格大于固定容差 $\\theta=0.1$，则将参数三元组 $(\\sigma,\\rho,\\beta)$ 分类为表现出混沌吸引。\n\n推导和实现的基本依据必须包括连续时间流的李雅普诺夫指数的标准定义，以及从 $\\mathbf{f}$ 的雅可比矩阵得到的线性变分方程。首字母缩略词必须在首次使用时定义，包括常微分方程 (Ordinary Differential Equation, ODE)、李雅普诺夫指数 (Lyapunov Exponent, LE)、最大李雅普诺夫指数 (Maximum Lyapunov Exponent, MLE) 和 QR 分解 (QR decomposition, QR)。\n\n测试套件：\n通过对每个坐标中列出的值进行精确采样，评估混沌在以下三个参数范围内的持续性：\n\n1. 范围 $\\mathcal{R}_1$ (经典混沌邻域): $$\\sigma\\in\\{9.5,\\,10.5\\},\\quad \\rho\\in\\{27.0,\\,29.0\\},\\quad \\beta\\in\\{2.6,\\,2.8\\}.$$\n2. 范围 $\\mathcal{R}_2$ (固定 $\\sigma$ 和 $\\beta$ 时混沌边界附近): $$\\sigma\\in\\{10.0\\},\\quad \\rho\\in\\{24.0,\\,24.8\\},\\quad \\beta\\in\\left\\{\\frac{8}{3}\\right\\}.$$\n3. 范围 $\\mathcal{R}_3$ (低 $\\rho$ 值的非混沌区域): $$\\sigma\\in\\{10.0,\\,12.0\\},\\quad \\rho\\in\\{0.5,\\,0.8\\},\\quad \\beta\\in\\{2.5,\\,2.7\\}.$$\n\n所有运行的初始条件必须是 $\\mathbf{x}(0)=(1,1,1)$，初始切向基必须是 $\\mathbb{R}^{3\\times 3}$ 中的单位矩阵。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含分别对应于 $\\mathcal{R}_1$、$\\mathcal{R}_2$ 和 $\\mathcal{R}_3$ 的三个布尔值，编码为方括号内以逗号分隔的列表（例如，$[True,False,True]$）。\n\n不涉及物理单位或角度单位；所有报告的布尔结果都是无单位的。",
            "solution": "该问题被评估为有效。它科学地基于成熟的动力系统和混沌理论，在数学上是适定的，所有必要的条件和参数都已指定，其表述和目标是客观的。任务是确定洛伦兹系统在三个指定参数范围内的混沌行为的持续性。这将通过对每个参数集数值计算最大李雅普诺夫指数 (MLE)，并将其与给定阈值进行比较来完成。\n\n解决方案建立在以下原则之上：\n1.  描述系统状态演化的洛伦兹系统常微分方程 (ODE)。\n2.  变分方程，其控制着对轨迹的无穷小扰动的演化，并从系统的雅可比矩阵导出。\n3.  通过同时积分状态方程和变分方程，并结合周期性的 QR 分解以保持正交性和稳定性，来计算李雅普诺夫指数 (LE) 谱的数值算法。\n\n首字母缩略词按要求定义如下：\n- **ODE**：常微分方程 (Ordinary Differential Equation)，一种涉及一个自变量的未知函数及其导数的方程。\n- **LE**：李雅普诺夫指数 (Lyapunov Exponent)，一个表征无限接近的轨迹分离速率的量。\n- **MLE**：最大李雅普诺夫指数 (Maximum Lyapunov Exponent)，李雅普诺夫指数中的最大值。正的 MLE 是混沌系统的一个决定性特征。\n- **QR**：QR 分解 (QR decomposition)，将矩阵 $A$ 分解为一个正交矩阵 $Q$ 和一个上三角矩阵 $R$ 的乘积 $A=QR$。\n\n**步骤 1：洛伦兹系统及其雅可比矩阵**\n\n洛伦兹系统是一组三个耦合的一阶非线性常微分方程。系统在时间 $t$ 的状态由向量 $\\mathbf{x}(t) = (x(t), y(t), z(t))$ 给出。其演化由矢量场 $\\mathbf{f}(\\mathbf{x}; \\sigma, \\rho, \\beta)$ 描述：\n$$\n\\frac{d\\mathbf{x}}{dt} = \\mathbf{f}(\\mathbf{x}) =\n\\begin{pmatrix}\n\\dot{x} \\\\\n\\dot{y} \\\\\n\\dot{z}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\sigma(y - x) \\\\\nx(\\rho - z) - y \\\\\nxy - \\beta z\n\\end{pmatrix}\n$$\n其中 $(\\sigma, \\rho, \\beta)$ 是系统参数。\n\n为了计算李雅普诺夫指数，我们必须分析一个小的扰动向量 $\\delta\\mathbf{x}$ 如何随时间演化。这种演化由流的线性化（即所谓的变分方程）决定：\n$$\n\\frac{d(\\delta\\mathbf{x})}{dt} = J(\\mathbf{x}(t)) \\cdot \\delta\\mathbf{x}\n$$\n这里，$J(\\mathbf{x})$ 是矢量场 $\\mathbf{f}$ 的雅可比矩阵，沿轨迹 $\\mathbf{x}(t)$ 求值：\n$$\nJ(\\mathbf{x}) = \\frac{\\partial \\mathbf{f}}{\\partial \\mathbf{x}} =\n\\begin{pmatrix}\n\\frac{\\partial \\dot{x}}{\\partial x}  \\frac{\\partial \\dot{x}}{\\partial y}  \\frac{\\partial \\dot{x}}{\\partial z} \\\\\n\\frac{\\partial \\dot{y}}{\\partial x}  \\frac{\\partial \\dot{y}}{\\partial y}  \\frac{\\partial \\dot{y}}{\\partial z} \\\\\n\\frac{\\partial \\dot{z}}{\\partial x}  \\frac{\\partial \\dot{z}}{\\partial y}  \\frac{\\partial \\dot{z}}{\\partial z}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-\\sigma  \\sigma  0 \\\\\n\\rho - z  -1  -x \\\\\ny  x  -\\beta\n\\end{pmatrix}\n$$\n\n**步骤 2：李雅普诺夫指数的数值算法**\n\n李雅普诺夫指数是一个演化中的无穷小初始条件球体的主轴的长期平均对数增长率。我们将要实现的标准算法，涉及对一组3个标准正交切向量进行积分，这些向量构成一个 $3 \\times 3$ 矩阵 $W(t)$ 的列。初始基是单位矩阵 $W(0) = I_3$。这个基的演化由以下方程决定：\n$$\n\\frac{d W}{dt} = J(\\mathbf{x}(t)) \\cdot W(t)\n$$\n我们将这个矩阵 ODE 与主系统关于 $\\mathbf{x}(t)$ 的 ODE 同时进行积分。一个数值问题会出现，因为 $W(t)$ 的列向量倾向于指数增长并与最大扩张方向对齐，导致病态条件和精度损失。\n\n为了解决这个问题，我们采用周期性的重新正交归一化程序。每隔 $m$ 个积分步长，演化后的矩阵 $W(t)$ 通过 QR 分解被分解为一个正交矩阵 $Q$ 和一个上三角矩阵 $R$。矩阵 $Q$ 为下一个积分段提供了一个新的标准正交基，而 $R$ 的对角元素存储了该区间内基向量的增长因子。然后，李雅普诺夫指数 $\\lambda_i$ 被计算为这些增长因子的对数的时间平均值：\n$$\n\\lambda_i = \\frac{1}{T_{\\text{total}} - T_{\\text{trans}}} \\sum_{k=N_{\\text{trans}}}^{N_{\\text{total}}} \\ln(|R_{ii}^{(k)}|)\n$$\n其中求和是在舍弃初始暂态时间 $T_{\\text{trans}}$ 后执行的重新正交归一化步骤上进行的。\n\n**步骤 3：通过四阶龙格－库塔 (RK4) 实现**\n\n我们必须对一个由 3 个关于 $\\mathbf{x}$ 的方程和 9 个关于 $W$ 的方程组成的耦合系统进行积分。RK4 方法应用于这个 12 维系统。对于通用系统 $\\frac{d\\mathbf{y}}{dt}=\\mathbf{g}(t, \\mathbf{y})$，从 $n$ 到 $n+1$ 的单步更新为 $\\mathbf{y}_{n+1} = \\mathbf{y}_n + \\frac{1}{6}(\\mathbf{k}_1 + 2\\mathbf{k}_2 + 2\\mathbf{k}_3 + \\mathbf{k}_4)$。在我们的例子中，$\\mathbf{y} = (\\mathbf{x}, W)$ 且矢量场为 $\\mathbf{g}(\\mathbf{x}, W) = (\\mathbf{f}(\\mathbf{x}), J(\\mathbf{x})W)$。\n\n算法流程如下：\n1.  **初始化**：设置参数 $(\\sigma, \\rho, \\beta)$。初始化状态 $\\mathbf{x}_0 = (1, 1, 1)$，切向矩阵 $W_0 = I_3$（$3 \\times 3$ 单位矩阵），并将用于记录对数拉伸的累加器置零。\n2.  **时间步进循环**：迭代总步数 $N = T / \\Delta t = 30 / 0.01 = 3000$。\n    a.  对每一步，同时计算 $\\mathbf{x}$ 和 $W$ 的 RK4 增量，因为 $W$ 的演化依赖于步内中间点的状态 $\\mathbf{x}$。\n    b.  更新状态：$\\mathbf{x}_{n+1} = \\mathbf{x}_n + \\Delta\\mathbf{x}_{\\text{RK4}}$。\n    c.  更新切向矩阵：$W_n' = W_n + \\Delta W_{\\text{RK4}}$。\n3.  **重新正交归一化**：每 $m=5$ 步后，执行以下操作：\n    a.  分解演化后的切向矩阵：$W_n' = Q \\cdot R$。这通过 `scipy.linalg.qr` 完成。\n    b.  如果当前时间 $t = (n+1) \\Delta t > T_{\\text{trans}} = 5$，则累加 $R$ 对角元素绝对值的对数：$\\sum \\ln(|R_{ii}|)$。\n    c.  为下一个积分段重置切向矩阵：$W_{n+1} = Q$。\n4.  **最终计算**：循环结束后，通过将累加和除以总累加时间 $T - T_{\\text{trans}} = 25$ 来计算李雅普诺夫指数。MLE 是这些指数中的最大值。\n5.  **参数范围评估**：\n    a.  对于每个范围 $\\mathcal{R}_j$，生成给定参数值的笛卡尔积。\n    b.  对于每个所得的三元组 $(\\sigma, \\rho, \\beta)$，执行步骤 1-4 来计算其 MLE。\n    c.  当且仅当在该范围内计算的每个 MLE 都严格大于阈值 $\\theta = 0.1$ 时，范围 $\\mathcal{R}_j$ 被分类为具有持续的混沌吸引。\n    d.  最终输出是一个包含三个布尔值的列表，分别对应于范围 $\\mathcal{R}_1、\\mathcal{R}_2、\\mathcal{R}_3$。\n\n这个基于第一性原理的详细程序确保了对洛伦兹系统行为的鲁棒且科学有效的评估。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import qr\nimport itertools\n\ndef solve():\n    \"\"\"\n    Main function to analyze parameter robustness of the Lorenz attractor.\n    \"\"\"\n\n    def lorenz_system(x, sigma, rho, beta):\n        \"\"\"Lorenz system vector field.\"\"\"\n        x_dot = sigma * (x[1] - x[0])\n        y_dot = x[0] * (rho - x[2]) - x[1]\n        z_dot = x[0] * x[1] - beta * x[2]\n        return np.array([x_dot, y_dot, z_dot])\n\n    def lorenz_jacobian(x, sigma, rho, beta):\n        \"\"\"Jacobian of the Lorenz system.\"\"\"\n        return np.array([\n            [-sigma, sigma, 0],\n            [rho - x[2], -1, -x[0]],\n            [x[1], x[0], -beta]\n        ])\n\n    def compute_mle(params, x0, w0, dt, total_time, transient_time, m_reorth):\n        \"\"\"\n        Computes the Maximum Lyapunov Exponent (MLE) for the Lorenz system.\n        \"\"\"\n        sigma, rho, beta = params\n        \n        # Integration parameters\n        num_steps = int(total_time / dt)\n        transient_steps = int(transient_time / dt)\n        \n        # Initial conditions\n        x = np.copy(x0)\n        w = np.copy(w0)\n        \n        # Accumulator for Lyapunov exponents\n        lyap_sum = np.zeros(3)\n        num_reorths_post_transient = 0\n\n        # Integration loop\n        for i in range(num_steps):\n            # RK4 for the coupled system (x, w)\n            # k1\n            k1_x = dt * lorenz_system(x, sigma, rho, beta)\n            k1_w = dt * lorenz_jacobian(x, sigma, rho, beta) @ w\n            \n            # k2\n            x_mid1 = x + 0.5 * k1_x\n            w_mid1 = w + 0.5 * k1_w\n            k2_x = dt * lorenz_system(x_mid1, sigma, rho, beta)\n            k2_w = dt * lorenz_jacobian(x_mid1, sigma, rho, beta) @ w_mid1\n\n            # k3\n            x_mid2 = x + 0.5 * k2_x\n            w_mid2 = w + 0.5 * k2_w\n            k3_x = dt * lorenz_system(x_mid2, sigma, rho, beta)\n            k3_w = dt * lorenz_jacobian(x_mid2, sigma, rho, beta) @ w_mid2\n            \n            # k4\n            x_end = x + k3_x\n            w_end = w + k3_w\n            k4_x = dt * lorenz_system(x_end, sigma, rho, beta)\n            k4_w = dt * lorenz_jacobian(x_end, sigma, rho, beta) @ w_end\n            \n            # Update state and tangent matrix\n            x += (k1_x + 2*k2_x + 2*k3_x + k4_x) / 6.0\n            w += (k1_w + 2*k2_w + 2*k3_w + k4_w) / 6.0\n            \n            # Gram-Schmidt re-orthonormalization every m_reorth steps\n            if (i + 1) % m_reorth == 0:\n                q, r = qr(w)\n                \n                # After transient, accumulate log of diagonal elements of R\n                if i >= transient_steps:\n                    lyap_sum += np.log(np.abs(np.diag(r)))\n                    num_reorths_post_transient += 1\n                \n                # Reset tangent matrix to the orthogonal part\n                w = q\n\n        # Calculate final Lyapunov exponents\n        accumulation_time = num_reorths_post_transient * m_reorth * dt\n        if accumulation_time > 0:\n            lyapunov_exponents = lyap_sum / accumulation_time\n        else:\n            # Handle case where no accumulation happened (e.g., total_time = transient_time)\n            lyapunov_exponents = np.array([-np.inf, -np.inf, -np.inf])\n            \n        return np.max(lyapunov_exponents)\n\n    # --- Problem Specification ---\n    # Integration parameters\n    dt = 0.01\n    total_time = 30.0\n    transient_time = 5.0\n    m_reorth = 5\n    chaos_threshold = 0.1\n\n    # Initial conditions\n    x_initial = np.array([1.0, 1.0, 1.0])\n    w_initial = np.identity(3)\n\n    # Test Suite\n    test_ranges = [\n        # R1: Classic chaotic neighborhood\n        (\n            [9.5, 10.5],       # sigma\n            [27.0, 29.0],      # rho\n            [2.6, 2.8]         # beta\n        ),\n        # R2: Near boundary of chaos\n        (\n            [10.0],            # sigma\n            [24.0, 24.8],      # rho\n            [8.0 / 3.0]        # beta\n        ),\n        # R3: Non-chaotic regime\n        (\n            [10.0, 12.0],      # sigma\n            [0.5, 0.8],        # rho\n            [2.5, 2.7]         # beta\n        )\n    ]\n\n    results = []\n    \n    # Evaluate each parameter range\n    for r_idx, (sigmas, rhos, betas) in enumerate(test_ranges):\n        is_persistent = True\n        param_product = itertools.product(sigmas, rhos, betas)\n        \n        for params in param_product:\n            mle = compute_mle(params, x_initial, w_initial, dt, total_time, transient_time, m_reorth)\n            \n            if mle = chaos_threshold:\n                is_persistent = False\n                break  # If one case fails, the whole range is not persistent\n        \n        results.append(is_persistent)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}