{
    "hands_on_practices": [
        {
            "introduction": "Before we can algorithmically discover communities, we must first have a way to quantify the quality of a given network partition. This foundational exercise guides you through the direct calculation of modularity, the most widely used quality function, for a small weighted network. By manually computing how the observed density of intra-community edges compares against a random baseline, you will develop a concrete intuition for what a modularity score represents, a crucial first step toward understanding community detection .",
            "id": "4269433",
            "problem": "Consider a weighted, undirected network with nodes labeled $1,2,3,4,5$ and no self-loops. The weighted adjacency matrix $W=\\big(w_{ij}\\big)$ is symmetric and given by\n$$\nW \\;=\\;\n\\begin{pmatrix}\n0 & 3 & 1 & 2 & 0 \\\\\n3 & 0 & 2 & 1 & 1 \\\\\n1 & 2 & 0 & 0 & 2 \\\\\n2 & 1 & 0 & 0 & 4 \\\\\n0 & 1 & 2 & 4 & 0\n\\end{pmatrix}.\n$$\nA proposed community assignment partitions the nodes into two groups: nodes $1,2,3$ are in community $\\mathcal{A}$ and nodes $4,5$ are in community $\\mathcal{B}$. Let $g_i$ denote the community label of node $i$ and let $\\delta(g_i,g_j)$ denote the indicator that is $1$ if $g_i=g_j$ and $0$ otherwise.\n\nUsing the standard definition of modularity for weighted, undirected networks based on the configuration-model null model and resolution parameter $\\gamma=1$, compute the modularity $Q$ of the given partition. In your computation, you must explicitly justify how each term arises, including the role of the indicator $\\delta(g_i,g_j)$, the observed edge weights $w_{ij}$, the node strengths, and the total weight. The final answer must be a single real number. Do not round; provide the exact value.",
            "solution": "The problem asks for the calculation of the modularity, $Q$, of a given partition in a weighted, undirected network. The standard definition of modularity for a weighted network with a resolution parameter $\\gamma$ is given by the formula:\n$$\nQ = \\frac{1}{2m} \\sum_{i=1}^{N} \\sum_{j=1}^{N} \\left[ w_{ij} - \\gamma \\frac{k_i k_j}{2m} \\right] \\delta(g_i, g_j)\n$$\nwhere:\n- $N$ is the number of nodes in the network, which is $5$.\n- $w_{ij}$ is the weight of the edge between node $i$ and node $j$, given by the adjacency matrix $W$.\n- $k_i$ is the strength of node $i$, defined as the sum of the weights of all edges connected to it: $k_i = \\sum_{j=1}^{N} w_{ij}$.\n- $m$ is the total weight of all edges in the network. For an undirected network, this is $m = \\frac{1}{2} \\sum_{i,j} w_{ij} = \\frac{1}{2} \\sum_{i} k_i$.\n- $g_i$ is the community to which node $i$ is assigned.\n- $\\delta(g_i, g_j)$ is the Kronecker delta function, which is $1$ if nodes $i$ and $j$ are in the same community ($g_i = g_j$) and $0$ otherwise. This function's role is to restrict the summation to pairs of nodes within the same community.\n- $\\gamma$ is the resolution parameter, given as $\\gamma=1$.\n\nThe term $w_{ij}$ represents the observed weight of the edge between nodes $i$ and $j$. The term $\\frac{k_i k_j}{2m}$ represents the expected weight of an edge between nodes $i$ and $j$ in a random network (the configuration model) that has the same node strength distribution as the observed network. Modularity, therefore, measures the extent to which the observed intra-community edge weights exceed their expected values.\n\nFirst, we calculate the necessary quantities from the given weighted adjacency matrix $W$:\n$$\nW \\;=\\;\n\\begin{pmatrix}\n0 & 3 & 1 & 2 & 0 \\\\\n3 & 0 & 2 & 1 & 1 \\\\\n1 & 2 & 0 & 0 & 2 \\\\\n2 & 1 & 0 & 0 & 4 \\\\\n0 & 1 & 2 & 4 & 0\n\\end{pmatrix}\n$$\n\nThe strength $k_i$ of each node is the sum of its corresponding row (or column) in $W$:\n$k_1 = 0+3+1+2+0 = 6$\n$k_2 = 3+0+2+1+1 = 7$\n$k_3 = 1+2+0+0+2 = 5$\n$k_4 = 2+1+0+0+4 = 7$\n$k_5 = 0+1+2+4+0 = 7$\n\nThe total weight of all edges, $m$, is half the sum of all node strengths:\n$$\nm = \\frac{1}{2} \\sum_{i=1}^{5} k_i = \\frac{1}{2}(6+7+5+7+7) = \\frac{1}{2}(32) = 16\n$$\nAlternatively, $m$ is the sum of the weights in the upper triangle of $W$: $m = 3+1+2+2+1+1+2+4 = 16$.\n\nThe given partition is:\n- Community $\\mathcal{A} = \\{1, 2, 3\\}$\n- Community $\\mathcal{B} = \\{4, 5\\}$\n\nThe modularity formula can be rewritten as a sum over communities. Because the $\\delta(g_i, g_j)$ term is zero for pairs of nodes in different communities, the sum can be split:\n$$\nQ = \\sum_c \\left( \\frac{1}{2m} \\sum_{i \\in c, j \\in c} \\left[ w_{ij} - \\gamma \\frac{k_i k_j}{2m} \\right] \\right)\n$$\nThis can be further simplified to:\n$$\nQ = \\sum_c \\left[ \\frac{m_c}{m} - \\gamma \\left( \\frac{K_c}{2m} \\right)^2 \\right]\n$$\nwhere:\n- $m_c = \\frac{1}{2} \\sum_{i \\in c, j \\in c} w_{ij}$ is the sum of weights of edges with both endpoints in community $c$.\n- $K_c = \\sum_{i \\in c} k_i$ is the sum of the strengths of all nodes in community $c$.\n\nLet's compute these quantities for each community.\n\nFor community $\\mathcal{A} = \\{1, 2, 3\\}$:\nThe internal edge weights are $w_{12}=3$, $w_{13}=1$, and $w_{23}=2$.\nThe sum of internal weights is $m_{\\mathcal{A}} = w_{12} + w_{13} + w_{23} = 3+1+2 = 6$.\nThe sum of node strengths is $K_{\\mathcal{A}} = k_1 + k_2 + k_3 = 6+7+5 = 18$.\n\nFor community $\\mathcal{B} = \\{4, 5\\}$:\nThe internal edge weight is $w_{45}=4$.\nThe sum of internal weights is $m_{\\mathcal{B}} = w_{45} = 4$.\nThe sum of node strengths is $K_{\\mathcal{B}} = k_4 + k_5 = 7+7 = 14$.\n\nNow we can compute the contribution of each community to the total modularity $Q$, with $\\gamma=1$:\nContribution from $\\mathcal{A}$:\n$$\nQ_{\\mathcal{A}} = \\frac{m_{\\mathcal{A}}}{m} - \\left( \\frac{K_{\\mathcal{A}}}{2m} \\right)^2 = \\frac{6}{16} - \\left( \\frac{18}{2 \\times 16} \\right)^2 = \\frac{6}{16} - \\left( \\frac{18}{32} \\right)^2 = \\frac{3}{8} - \\left( \\frac{9}{16} \\right)^2\n$$\n$$\nQ_{\\mathcal{A}} = \\frac{3}{8} - \\frac{81}{256} = \\frac{3 \\times 32}{8 \\times 32} - \\frac{81}{256} = \\frac{96}{256} - \\frac{81}{256} = \\frac{15}{256}\n$$\n\nContribution from $\\mathcal{B}$:\n$$\nQ_{\\mathcal{B}} = \\frac{m_{\\mathcal{B}}}{m} - \\left( \\frac{K_{\\mathcal{B}}}{2m} \\right)^2 = \\frac{4}{16} - \\left( \\frac{14}{2 \\times 16} \\right)^2 = \\frac{4}{16} - \\left( \\frac{14}{32} \\right)^2 = \\frac{1}{4} - \\left( \\frac{7}{16} \\right)^2\n$$\n$$\nQ_{\\mathcal{B}} = \\frac{1}{4} - \\frac{49}{256} = \\frac{1 \\times 64}{4 \\times 64} - \\frac{49}{256} = \\frac{64}{256} - \\frac{49}{256} = \\frac{15}{256}\n$$\n\nThe total modularity $Q$ is the sum of these contributions:\n$$\nQ = Q_{\\mathcal{A}} + Q_{\\mathcal{B}} = \\frac{15}{256} + \\frac{15}{256} = \\frac{30}{256}\n$$\nSimplifying the fraction gives:\n$$\nQ = \\frac{15}{128}\n$$",
            "answer": "$$\\boxed{\\frac{15}{128}}$$"
        },
        {
            "introduction": "Many of the most successful community detection algorithms, such as the Louvain method, employ a greedy optimization strategy based on local changes. This practice places you in the role of the algorithm for a single step, challenging you to evaluate the change in modularity ($\\Delta Q$) that results from moving a node between communities. This exercise illuminates the core mechanic behind iterative, heuristic approaches and builds an understanding of how high-modularity partitions are progressively constructed .",
            "id": "4269489",
            "problem": "Consider an undirected weighted network with node set $\\{1,2,3,4,5,6\\}$ and the following edges with weights:\n- $(1,2)$ with weight $3$,\n- $(1,3)$ with weight $2$,\n- $(2,3)$ with weight $2$,\n- $(4,5)$ with weight $3$,\n- $(3,4)$ with weight $1$,\n- $(3,6)$ with weight $2$,\n- $(5,6)$ with weight $2$,\n- $(2,6)$ with weight $1$,\n- $(4,6)$ with weight $1$.\n\nLet the initial community assignment be $C_A=\\{1,2,3\\}$, $C_B=\\{4,5\\}$, and $C_C=\\{6\\}$. Let $A_{ij}$ denote the weighted adjacency matrix, and let the strength (weighted degree) be $k_i=\\sum_j A_{ij}$. Let $m=\\sum_{i<j} A_{ij}$ denote the total edge weight, so that $\\sum_{i} k_i = 2m$. The modularity $Q$ of a partition is defined by\n$$\nQ=\\frac{1}{2m}\\sum_{i,j}\\left(A_{ij}-\\frac{k_i k_j}{2m}\\right)\\delta(c_i,c_j),\n$$\nwhere $\\delta(c_i,c_j)=1$ if nodes $i$ and $j$ are in the same community and $\\delta(c_i,c_j)=0$ otherwise.\n\nStarting from the above definition (do not use any pre-derived incremental formulas), compute the modularity change $\\Delta Q$ for moving node $6$ from $C_C$ into each neighboring community, namely $C_A$ and $C_B$, by explicitly computing the modularity before and after each hypothetical move. Then, as the single reported quantity, provide the maximal $\\Delta Q$ over these moves.\n\nUse exact arithmetic throughout and express your final reported value as an exact irreducible fraction with no units. Do not round. The final answer must be a single number.",
            "solution": "First, we establish the fundamental properties of the network based on the provided data. The set of nodes is $V = \\{1, 2, 3, 4, 5, 6\\}$. The weighted adjacency matrix entries $A_{ij}$ are given by the specified edge weights, and $A_{ij}=A_{ji}$ as the network is undirected. All other entries are zero.\n\nThe total edge weight, $m$, is the sum of all unique edge weights:\n$$m = \\sum_{i<j} A_{ij} = 3+2+2+3+1+2+2+1+1 = 17$$\nThe total weight of all edges in the network is $2m = 34$.\n\nThe strength of each node, $k_i$, is the sum of the weights of all edges connected to it:\n$k_1 = A_{12} + A_{13} = 3 + 2 = 5$\n$k_2 = A_{21} + A_{23} + A_{26} = 3 + 2 + 1 = 6$\n$k_3 = A_{31} + A_{32} + A_{34} + A_{36} = 2 + 2 + 1 + 2 = 7$\n$k_4 = A_{43} + A_{45} + A_{46} = 1 + 3 + 1 = 5$\n$k_5 = A_{54} + A_{56} = 3 + 2 = 5$\n$k_6 = A_{62} + A_{63} + A_{64} + A_{65} = 1 + 2 + 1 + 2 = 6$\nThe sum of strengths is $\\sum_i k_i = 5+6+7+5+5+6 = 34$, which correctly equals $2m$.\n\nThe modularity $Q$ is given by:\n$$Q=\\frac{1}{2m}\\sum_{i,j}\\left(A_{ij}-\\frac{k_i k_j}{2m}\\right)\\delta(c_i,c_j)$$\nwhere $\\delta(c_i,c_j)=1$ if nodes $i$ and $j$ are in the same community and $0$ otherwise. The sum can be partitioned over the communities.\n\n**Step 1: Compute the initial modularity, $Q_{\\text{initial}}$**\n\nThe initial partition is $C_A = \\{1, 2, 3\\}$, $C_B = \\{4, 5\\}$, and $C_C = \\{6\\}$.\nThe sum for $Q$ can be broken down by community:\n$$2mQ = \\sum_{i,j \\in C_A}\\left(A_{ij}-\\frac{k_i k_j}{2m}\\right) + \\sum_{i,j \\in C_B}\\left(A_{ij}-\\frac{k_i k_j}{2m}\\right) + \\sum_{i,j \\in C_C}\\left(A_{ij}-\\frac{k_i k_j}{2m}\\right)$$\n\nFor community $C_A = \\{1, 2, 3\\}$:\n$\\sum_{i,j \\in C_A} A_{ij} = 2(A_{12}+A_{13}+A_{23}) = 2(3+2+2) = 14$.\n$\\sum_{i,j \\in C_A} \\frac{k_i k_j}{2m} = \\frac{1}{2m}(k_1+k_2+k_3)^2 = \\frac{1}{34}(5+6+7)^2 = \\frac{18^2}{34} = \\frac{324}{34}$.\nContribution: $14 - \\frac{324}{34}$.\n\nFor community $C_B = \\{4, 5\\}$:\n$\\sum_{i,j \\in C_B} A_{ij} = 2(A_{45}) = 2(3) = 6$.\n$\\sum_{i,j \\in C_B} \\frac{k_i k_j}{2m} = \\frac{1}{2m}(k_4+k_5)^2 = \\frac{1}{34}(5+5)^2 = \\frac{10^2}{34} = \\frac{100}{34}$.\nContribution: $6 - \\frac{100}{34}$.\n\nFor community $C_C = \\{6\\}$:\n$\\sum_{i,j \\in C_C} A_{ij} = 0$, as there is only one node.\n$\\sum_{i,j \\in C_C} \\frac{k_i k_j}{2m} = \\frac{1}{2m}(k_6)^2 = \\frac{1}{34}(6)^2 = \\frac{36}{34}$.\nContribution: $0 - \\frac{36}{34}$.\n\nSumming the contributions:\n$34 \\cdot Q_{\\text{initial}} = \\left(14 - \\frac{324}{34}\\right) + \\left(6 - \\frac{100}{34}\\right) - \\frac{36}{34} = 20 - \\frac{324+100+36}{34} = 20 - \\frac{460}{34}$.\n$Q_{\\text{initial}} = \\frac{1}{34}\\left(20 - \\frac{460}{34}\\right) = \\frac{20 \\cdot 34 - 460}{34^2} = \\frac{680 - 460}{1156} = \\frac{220}{1156} = \\frac{55}{289}$.\n\n**Step 2: Compute modularity after moving node 6 to $C_A$ ($Q_A$)**\n\nThe new partition is $C'_A = \\{1, 2, 3, 6\\}$ and $C'_B = \\{4, 5\\}$.\nFor community $C'_A = \\{1, 2, 3, 6\\}$:\n$\\sum_{i,j \\in C'_A} A_{ij} = 2(A_{12}+A_{13}+A_{23}+A_{26}+A_{36}) = 2(3+2+2+1+2) = 2(10) = 20$.\n$\\sum_{i,j \\in C'_A} \\frac{k_i k_j}{2m} = \\frac{1}{2m}(k_1+k_2+k_3+k_6)^2 = \\frac{1}{34}(5+6+7+6)^2 = \\frac{24^2}{34} = \\frac{576}{34}$.\nContribution: $20 - \\frac{576}{34}$.\n\nThe community $C'_B$ is identical to the old $C_B$.\nContribution: $6 - \\frac{100}{34}$.\n\nSumming the contributions:\n$34 \\cdot Q_A = \\left(20 - \\frac{576}{34}\\right) + \\left(6 - \\frac{100}{34}\\right) = 26 - \\frac{676}{34}$.\n$Q_A = \\frac{1}{34}\\left(26 - \\frac{676}{34}\\right) = \\frac{26 \\cdot 34 - 676}{34^2} = \\frac{884 - 676}{1156} = \\frac{208}{1156} = \\frac{52}{289}$.\n\nThe change in modularity is $\\Delta Q_A = Q_A - Q_{\\text{initial}} = \\frac{52}{289} - \\frac{55}{289} = -\\frac{3}{289}$.\n\n**Step 3: Compute modularity after moving node 6 to $C_B$ ($Q_B$)**\n\nThe new partition is $C''_A = \\{1, 2, 3\\}$ and $C''_B = \\{4, 5, 6\\}$.\nThe community $C''_A$ is identical to the old $C_A$.\nContribution: $14 - \\frac{324}{34}$.\n\nFor community $C''_B = \\{4, 5, 6\\}$:\n$\\sum_{i,j \\in C''_B} A_{ij} = 2(A_{45}+A_{46}+A_{56}) = 2(3+1+2) = 2(6) = 12$.\n$\\sum_{i,j \\in C''_B} \\frac{k_i k_j}{2m} = \\frac{1}{2m}(k_4+k_5+k_6)^2 = \\frac{1}{34}(5+5+6)^2 = \\frac{16^2}{34} = \\frac{256}{34}$.\nContribution: $12 - \\frac{256}{34}$.\n\nSumming the contributions:\n$34 \\cdot Q_B = \\left(14 - \\frac{324}{34}\\right) + \\left(12 - \\frac{256}{34}\\right) = 26 - \\frac{580}{34}$.\n$Q_B = \\frac{1}{34}\\left(26 - \\frac{580}{34}\\right) = \\frac{26 \\cdot 34 - 580}{34^2} = \\frac{884 - 580}{1156} = \\frac{304}{1156} = \\frac{76}{289}$.\n\nThe change in modularity is $\\Delta Q_B = Q_B - Q_{\\text{initial}} = \\frac{76}{289} - \\frac{55}{289} = \\frac{21}{289}$.\n\n**Step 4: Determine the maximal $\\Delta Q$**\n\nWe must compare the modularity changes for the two hypothetical moves:\n$\\Delta Q_A = -\\frac{3}{289}$\n$\\Delta Q_B = \\frac{21}{289}$\n\nThe maximal modularity change is:\n$\\max(\\Delta Q_A, \\Delta Q_B) = \\max\\left(-\\frac{3}{289}, \\frac{21}{289}\\right) = \\frac{21}{289}$.\nThe fraction $\\frac{21}{289}$ is irreducible because $21=3 \\cdot 7$ and $289=17^2$, and they share no common prime factors.",
            "answer": "$$\\boxed{\\frac{21}{289}}$$"
        },
        {
            "introduction": "An elegant and powerful alternative to greedy optimization is the spectral approach, which reframes community detection as a problem in linear algebra. This exercise demonstrates how maximizing modularity can be approximated by finding the leading eigenvector of a special \"modularity matrix\" $B$. By deriving this connection and applying it to a sample network, you will gain insight into a different class of global optimization algorithms and appreciate the deep link between a network's structure and its spectral properties .",
            "id": "4269492",
            "problem": "You are given an undirected, unweighted, simple graph with adjacency matrix $A \\in \\mathbb{R}^{n \\times n}$, degree sequence $\\{k_i\\}_{i=1}^{n}$, and total number of edges $m = \\frac{1}{2}\\sum_{i=1}^{n} k_i$. The modularity $Q$ of a partition $\\{c_i\\}_{i=1}^{n}$ of the nodes into communities is defined by the standard expression\n$$\nQ \\equiv \\frac{1}{2m}\\sum_{i=1}^{n}\\sum_{j=1}^{n}\\left(A_{ij} - \\frac{k_i k_j}{2m}\\right)\\,\\delta(c_i, c_j),\n$$\nwhere $\\delta(c_i, c_j)$ is the indicator of nodes $i$ and $j$ belonging to the same community.\n\nTask:\n- Starting only from the above definition and the notions of adjacency, degree, and total edge count, derive a quadratic-form representation of $Q$ for the special case of a bipartition. Express it in terms of a binary assignment vector $s \\in \\{-1, +1\\}^n$ and a symmetric matrix built from $A$ and $\\{k_i\\}$, and explain why maximizing $Q$ over $s$ can be approximated by relaxing $s$ to a real vector and solving an eigenvalue problem. Justify each step from first principles.\n- Then, apply this spectral relaxation to the following graph on $n = 6$ nodes with adjacency matrix\n$$\nA \\;=\\; \\begin{pmatrix}\n0 & 1 & 1 & 0 & 0 & 0\\\\\n1 & 0 & 1 & 0 & 0 & 0\\\\\n1 & 1 & 0 & 1 & 0 & 0\\\\\n0 & 0 & 1 & 0 & 1 & 1\\\\\n0 & 0 & 0 & 1 & 0 & 1\\\\\n0 & 0 & 0 & 1 & 1 & 0\n\\end{pmatrix}.\n$$\nCompute the degree sequence $\\{k_i\\}_{i=1}^{6}$ and $m$. Construct the corresponding modularity matrix, determine a leading eigenvector suitable for producing a bipartition by the sign rule, and provide the resulting bipartition. Finally, compute the modularity $Q$ of that bipartition directly from the defining formula.\n\nGive your final answer as the exact value of $Q$ for the bipartition produced by the spectral relaxation. Do not round; provide an exact rational number.",
            "solution": "The problem asks for a derivation of the quadratic form of modularity for a bipartition, an explanation of its spectral relaxation, and the application of this method to a specific graph. We will address each part in sequence.\n\n### Part 1: Derivation of the Quadratic Form and Spectral Relaxation\n\nThe modularity $Q$ for a given partition of a network is defined as:\n$$\nQ = \\frac{1}{2m}\\sum_{i=1}^{n}\\sum_{j=1}^{n}\\left(A_{ij} - \\frac{k_i k_j}{2m}\\right)\\,\\delta(c_i, c_j)\n$$\nwhere $m$ is the total number of edges, $A_{ij}$ are the elements of the adjacency matrix, $k_i$ is the degree of node $i$, and $\\delta(c_i, c_j)$ is the Kronecker delta, which is $1$ if nodes $i$ and $j$ are in the same community and $0$ otherwise.\n\nFor a bipartition, the nodes are divided into two communities. We can represent this partition using a vector $s \\in \\mathbb{R}^n$ where $s_i = +1$ if node $i$ is in the first community and $s_i = -1$ if it is in the second.\n\nWith this representation, two nodes $i$ and $j$ are in the same community if and only if $s_i = s_j$, which implies $s_i s_j = 1$. They are in different communities if $s_i \\neq s_j$, which implies $s_i s_j = -1$. The indicator function $\\delta(c_i, c_j)$ can therefore be expressed in terms of the components of $s$:\n$$\n\\delta(c_i, c_j) = \\frac{1 + s_i s_j}{2}\n$$\nThis expression evaluates to $1$ when $s_i s_j = 1$ and to $0$ when $s_i s_j = -1$, as required.\n\nSubstituting this into the definition of modularity:\n$$\nQ = \\frac{1}{2m}\\sum_{i,j}\\left(A_{ij} - \\frac{k_i k_j}{2m}\\right)\\frac{1 + s_i s_j}{2}\n$$\nWe can split the summation into two parts:\n$$\nQ = \\frac{1}{4m}\\sum_{i,j}\\left(A_{ij} - \\frac{k_i k_j}{2m}\\right) + \\frac{1}{4m}\\sum_{i,j}\\left(A_{ij} - \\frac{k_i k_j}{2m}\\right)s_i s_j\n$$\nLet's analyze the first term. The sum of all entries in the adjacency matrix is $\\sum_{i,j} A_{ij} = \\sum_i k_i = 2m$. The sum of the terms in the random graph null model is $\\sum_{i,j} \\frac{k_i k_j}{2m} = \\frac{1}{2m}(\\sum_i k_i)(\\sum_j k_j) = \\frac{1}{2m}(2m)(2m) = 2m$. Thus, the first term is:\n$$\n\\frac{1}{4m}\\left(\\sum_{i,j} A_{ij} - \\sum_{i,j} \\frac{k_i k_j}{2m}\\right) = \\frac{1}{4m}(2m - 2m) = 0\n$$\nThe modularity expression simplifies to the second term:\n$$\nQ = \\frac{1}{4m}\\sum_{i,j}\\left(A_{ij} - \\frac{k_i k_j}{2m}\\right)s_i s_j\n$$\nThis is a quadratic form. Let us define the modularity matrix $B$, a symmetric matrix with elements:\n$$\nB_{ij} = A_{ij} - \\frac{k_i k_j}{2m}\n$$\nIn terms of this matrix and the vector $s$, the modularity $Q$ is:\n$$\nQ = \\frac{1}{4m} s^T B s\n$$\nMaximizing modularity for a bipartition is equivalent to maximizing $s^T B s$ over all possible vectors $s \\in \\{-1, +1\\}^n$. This is an integer quadratic programming problem, which is NP-hard in general.\n\nTo find an approximate solution, we employ spectral relaxation. The discrete constraint $s_i \\in \\{-1, +1\\}$ is relaxed to a continuous one. We seek to maximize $s^T B s$ for a real vector $s$. To make the problem well-defined (as the quadratic form scales with the norm of $s$), we impose a constraint on the norm of $s$, for instance, that it be a unit vector $\\|s\\|=1$ or, more conveniently, that $\\sum_i s_i^2 = n$. The latter is consistent with the original discrete problem where $\\sum_i s_i^2 = \\sum_i (\\pm 1)^2 = n$.\n\nThe problem becomes: maximize $s^T B s$ subject to $s^T s = n$. By the Rayleigh-Ritz theorem, the maximum value of the Rayleigh quotient $\\frac{s^T B s}{s^T s}$ is the largest eigenvalue of the matrix $B$, and this maximum is achieved when $s$ is the corresponding eigenvector. So, the optimal continuous vector $s$ is proportional to the eigenvector $u_1$ associated with the largest eigenvalue $\\lambda_1$ of $B$.\n\nOnce this real-valued eigenvector $u_1$ is found, we must recover a discrete partition vector. A common and effective heuristic is to assign the community based on the sign of the components of $u_1$. That is, we define the discrete partition vector $\\hat{s}$ as:\n$$\n\\hat{s}_i = \\text{sign}(u_{1,i})\n$$\nwhere $u_{1,i}$ is the $i$-th component of the eigenvector $u_1$. If any $u_{1,i} = 0$, the assignment for that node is ambiguous and can be made arbitrarily, though this is uncommon. The resulting vector $\\hat{s}$ provides the approximate optimal bipartition.\n\n### Part 2: Application to the Given Graph\n\nThe graph is defined by the adjacency matrix on $n=6$ nodes:\n$$\nA = \\begin{pmatrix}\n0 & 1 & 1 & 0 & 0 & 0\\\\\n1 & 0 & 1 & 0 & 0 & 0\\\\\n1 & 1 & 0 & 1 & 0 & 0\\\\\n0 & 0 & 1 & 0 & 1 & 1\\\\\n0 & 0 & 0 & 1 & 0 & 1\\\\\n0 & 0 & 0 & 1 & 1 & 0\n\\end{pmatrix}\n$$\nFirst, we compute the degree sequence $\\{k_i\\}_{i=1}^{6}$ by summing the rows of $A$:\n$k_1 = 2$, $k_2 = 2$, $k_3 = 3$, $k_4 = 3$, $k_5 = 2$, $k_6 = 2$.\nThe total number of edges $m$ is:\n$$\nm = \\frac{1}{2}\\sum_{i=1}^{6} k_i = \\frac{1}{2}(2+2+3+3+2+2) = \\frac{14}{2} = 7\n$$\nNext, we construct the modularity matrix $B = A - \\frac{k k^T}{2m}$. We have $2m=14$ and $k=(2, 2, 3, 3, 2, 2)^T$.\n$$\n\\frac{k k^T}{14} = \\frac{1}{14} \\begin{pmatrix}\n4 & 4 & 6 & 6 & 4 & 4 \\\\\n4 & 4 & 6 & 6 & 4 & 4 \\\\\n6 & 6 & 9 & 9 & 6 & 6 \\\\\n6 & 6 & 9 & 9 & 6 & 6 \\\\\n4 & 4 & 6 & 6 & 4 & 4 \\\\\n4 & 4 & 6 & 6 & 4 & 4\n\\end{pmatrix}\n$$\n$$\nB = A - \\frac{k k^T}{14} = \\frac{1}{14} \\left( 14A - k k^T \\right) = \\frac{1}{14} \\begin{pmatrix}\n-4 & 10 & 8 & -6 & -4 & -4 \\\\\n10 & -4 & 8 & -6 & -4 & -4 \\\\\n8 & 8 & -9 & 5 & -6 & -6 \\\\\n-6 & -6 & 5 & -9 & 8 & 8 \\\\\n-4 & -4 & -6 & 8 & -4 & 10 \\\\\n-4 & -4 & -6 & 8 & 10 & -4\n\\end{pmatrix}\n$$\nTo find the leading eigenvector of $B$, we find the leading eigenvector of the scaled matrix $M = 14B$. The graph structure suggests a partition into $\\{1,2,3\\}$ and $\\{4,5,6\\}$. This corresponds to an eigenvector $u$ with $u_1, u_2, u_3$ having one sign and $u_4, u_5, u_6$ having the opposite sign. Due to the symmetry of the graph ($1 \\leftrightarrow 4$, $2 \\leftrightarrow 5$, $3 \\leftrightarrow 6$ is not a symmetry, but $1 \\leftrightarrow 2$, $5 \\leftrightarrow 6$ are, and the bipartite structure suggests $i \\leftrightarrow 7-i$ with a sign flip) we test an eigenvector of the form $u = (a, a, c, -c, -a, -a)^T$. Applying $M$ to $u$:\n$$\nMu = \\begin{pmatrix} 14a + 14c \\\\ 14a + 14c \\\\ 28a - 14c \\\\ -28a + 14c \\\\ -14a - 14c \\\\ -14a - 14c \\end{pmatrix} = \\lambda' \\begin{pmatrix} a \\\\ a \\\\ c \\\\ -c \\\\ -a \\\\ -a \\end{pmatrix}\n$$\nThis gives the system of equations for the components and eigenvalue $\\lambda'$ of $M$:\n1. $\\lambda' a = 14a + 14c$\n2. $\\lambda' c = 28a - 14c$\nFrom $(1)$, $c = \\frac{\\lambda'-14}{14}a$. Substituting into $(2)$:\n$$\n\\lambda' \\left( \\frac{\\lambda'-14}{14}a \\right) = 28a - 14 \\left( \\frac{\\lambda'-14}{14}a \\right)\n$$\nAssuming $a \\neq 0$ and dividing by $a$:\n$$\n\\frac{\\lambda'(\\lambda'-14)}{14} = 28 - (\\lambda'-14) = 42 - \\lambda'\n$$\n$$\n\\lambda'^2 - 14\\lambda' = 14(42 - \\lambda') = 588 - 14\\lambda'\n$$\n$$\n\\lambda'^2 = 588 \\implies \\lambda' = \\pm\\sqrt{588} = \\pm 14\\sqrt{3}\n$$\nThe eigenvalues of $B$ are $\\lambda = \\lambda'/14 = \\pm \\sqrt{3}$. The largest eigenvalue is $\\lambda_1 = \\sqrt{3}$.\nThe corresponding eigenvector has $c = \\frac{14\\sqrt{3}-14}{14}a = (\\sqrt{3}-1)a$.\nChoosing $a=1$, we have $c = \\sqrt{3}-1$. The eigenvector is proportional to $u_1 \\propto (1, 1, \\sqrt{3}-1, -(\\sqrt{3}-1), -1, -1)^T$.\nSince $\\sqrt{3} \\approx 1.732$, $\\sqrt{3}-1 > 0$. The signs of the components are:\n$$\n\\text{sign}(u_{1,i}) = (+, +, +, -, -, -)\n$$\nThis defines the bipartition: Community $1$, $C_1 = \\{1, 2, 3\\}$, and Community $2$, $C_2 = \\{4, 5, 6\\}$.\n\nFinally, we compute the modularity $Q$ of this partition. The formula can be written as:\n$$\nQ = \\sum_{c} \\left[ \\frac{L_c}{m} - \\left(\\frac{K_c}{2m}\\right)^2 \\right]\n$$\nwhere $L_c$ is the number of edges entirely within community $c$, and $K_c$ is the sum of degrees of nodes in community $c$.\nFor community $C_1 = \\{1, 2, 3\\}$:\nThe internal edges are $(1,2)$, $(1,3)$, and $(2,3)$. So, $L_{C_1} = 3$.\nThe sum of degrees is $K_{C_1} = k_1+k_2+k_3 = 2+2+3=7$.\nFor community $C_2 = \\{4, 5, 6\\}$:\nThe internal edges are $(4,5)$, $(4,6)$, and $(5,6)$. So, $L_{C_2} = 3$.\nThe sum of degrees is $K_{C_2} = k_4+k_5+k_6 = 3+2+2=7$.\nWith $m=7$ and $2m=14$:\n$$\nQ = \\left[ \\frac{L_{C_1}}{m} - \\left(\\frac{K_{C_1}}{2m}\\right)^2 \\right] + \\left[ \\frac{L_{C_2}}{m} - \\left(\\frac{K_{C_2}}{2m}\\right)^2 \\right]\n$$\n$$\nQ = 2 \\left[ \\frac{3}{7} - \\left(\\frac{7}{14}\\right)^2 \\right] = 2 \\left[ \\frac{3}{7} - \\left(\\frac{1}{2}\\right)^2 \\right]\n$$\n$$\nQ = 2 \\left[ \\frac{3}{7} - \\frac{1}{4} \\right]\n$$\n$$\nQ = 2 \\left[ \\frac{12 - 7}{28} \\right] = 2 \\left( \\frac{5}{28} \\right) = \\frac{10}{28} = \\frac{5}{14}\n$$\nThe modularity of the bipartition $\\{1,2,3\\},\\{4,5,6\\}$ is $\\frac{5}{14}$.",
            "answer": "$$\\boxed{\\frac{5}{14}}$$"
        }
    ]
}