{
    "hands_on_practices": [
        {
            "introduction": "This first exercise provides a foundational calculation of modularity for a network with a clear, planted community structure. By computing the modularity $Q$ for the intuitive partition of two connected cliques, you will gain direct practice in applying the modularity formula and see how it quantifies the quality of a \"good\" partition relative to the trivial case. ",
            "id": "4288126",
            "problem": "Consider a simple, undirected, unweighted graph $G$ formed by taking two cliques $K_{n_1}$ and $K_{n_2}$, with $n_1 \\geq 2$ and $n_2 \\geq 2$, and adding a single bridge edge between one designated vertex $u$ in $K_{n_1}$ and one designated vertex $v$ in $K_{n_2}$. Let $Q$ denote the modularity under the configuration-model null ensemble. Evaluate $Q$ for the partition $\\mathcal{P}_{\\mathrm{sep}}$ that places all vertices of $K_{n_1}$ into one community and all vertices of $K_{n_2}$ into a second community, and also for the partition $\\mathcal{P}_{\\mathrm{all}}$ that places all vertices of $G$ into a single community. Provide your final answer as a single closed-form analytic expression in $n_1$ and $n_2$ for $Q(\\mathcal{P}_{\\mathrm{sep}}) - Q(\\mathcal{P}_{\\mathrm{all}})$. No rounding is required, and no physical units are involved.",
            "solution": "The user-provided problem has been analyzed and is deemed valid. It is a well-posed, scientifically grounded problem within the field of network science, with no factual unsoundness, ambiguity, or missing information. We may therefore proceed with a formal solution.\n\nThe modularity $Q$ of a partition of a network is defined as the fraction of edges that fall within the given communities minus the expected fraction if edges were distributed at random, preserving vertex degrees. For an unweighted, undirected graph, the modularity under the configuration-model null ensemble is given by the formula:\n$$\nQ = \\frac{1}{2m} \\sum_{i,j} \\left( A_{ij} - \\frac{k_i k_j}{2m} \\right) \\delta(c_i, c_j)\n$$\nwhere $m$ is the total number of edges in the graph, $A$ is the adjacency matrix, $k_i$ is the degree of vertex $i$, $c_i$ is the community to which vertex $i$ is assigned, and $\\delta(c_i, c_j)$ is the Kronecker delta, which is $1$ if $c_i = c_j$ and $0$ otherwise.\n\nFirst, we characterize the graph $G$. It is composed of two cliques, $K_{n_1}$ and $K_{n_2}$, connected by a single bridge edge.\nThe number of edges in a clique $K_n$ is $\\binom{n}{2} = \\frac{n(n-1)}{2}$.\nThe total number of edges $m$ in $G$ is the sum of edges in $K_{n_1}$, the edges in $K_{n_2}$, and the single bridge edge.\n$$\nm = \\frac{n_1(n_1-1)}{2} + \\frac{n_2(n_2-1)}{2} + 1\n$$\nThe total degree of the graph, which is twice the number of edges, is:\n$$\n2m = n_1(n_1-1) + n_2(n_2-1) + 2\n$$\n\nNext, we evaluate the modularity for the partition $\\mathcal{P}_{\\mathrm{all}}$, where all vertices are in a single community. In this case, $c_i = c_j$ for all pairs of vertices $(i, j)$, so $\\delta(c_i, c_j) = 1$ for all $i,j$. The modularity equation becomes:\n$$\nQ(\\mathcal{P}_{\\mathrm{all}}) = \\frac{1}{2m} \\sum_{i,j} \\left( A_{ij} - \\frac{k_i k_j}{2m} \\right)\n$$\nThe sum can be split:\n$$\nQ(\\mathcal{P}_{\\mathrm{all}}) = \\frac{1}{2m} \\left( \\sum_{i,j} A_{ij} - \\frac{1}{2m} \\sum_{i,j} k_i k_j \\right)\n$$\nThe term $\\sum_{i,j} A_{ij}$ is the sum of all entries in the adjacency matrix, which equals the sum of all vertex degrees, $\\sum_i k_i = 2m$.\nThe term $\\sum_{i,j} k_i k_j$ can be factorized as $(\\sum_i k_i)(\\sum_j k_j) = (2m)(2m) = 4m^2$.\nSubstituting these back:\n$$\nQ(\\mathcal{P}_{\\mathrm{all}}) = \\frac{1}{2m} \\left( 2m - \\frac{4m^2}{2m} \\right) = \\frac{1}{2m} (2m - 2m) = 0\n$$\nAs expected, the modularity of a trivial partition containing all nodes in one community is always $0$.\n\nNow, we evaluate the modularity for the partition $\\mathcal{P}_{\\mathrm{sep}}$. This partition has two communities: $C_1$ containing the $n_1$ vertices from the original $K_{n_1}$ and $C_2$ containing the $n_2$ vertices from the original $K_{n_2}$.\n\nAn alternative and equivalent formula for modularity is:\n$$\nQ = \\sum_{c=1}^{N_c} \\left[ \\frac{L_c}{m} - \\left(\\frac{K_c}{2m}\\right)^2 \\right]\n$$\nwhere the sum is over the $N_c$ communities, $L_c$ is the number of intra-community edges in community $c$, and $K_c$ is the sum of degrees of the vertices in community $c$.\n\nFor community $C_1$:\nThe number of intra-community edges, $L_1$, are the edges of the clique $K_{n_1}$.\n$$\nL_1 = \\binom{n_1}{2} = \\frac{n_1(n_1-1)}{2}\n$$\nThe sum of degrees, $K_1$, is the sum of degrees of all vertices in $C_1$. The degrees of the $n_1-1$ vertices not part of the bridge are each $n_1-1$. The degree of the bridge vertex $u$ is $(n_1-1) + 1 = n_1$.\n$$\nK_1 = (n_1-1)(n_1-1) + n_1 = (n_1^2 - 2n_1 + 1) + n_1 = n_1^2 - n_1 + 1\n$$\nAlternatively, $K_1$ is the sum of internal degrees ($2L_1$) plus the number of edges leaving the community ($1$).\n$K_1 = 2L_1 + 1 = 2 \\left( \\frac{n_1(n_1-1)}{2} \\right) + 1 = n_1(n_1-1) + 1$, which confirms the result.\n\nFor community $C_2$, by symmetry:\n$$\nL_2 = \\binom{n_2}{2} = \\frac{n_2(n_2-1)}{2}\n$$\n$$\nK_2 = n_2(n_2-1) + 1 = n_2^2 - n_2 + 1\n$$\n\nNow we compute $Q(\\mathcal{P}_{\\mathrm{sep}})$ with $N_c=2$:\n$$\nQ(\\mathcal{P}_{\\mathrm{sep}}) = \\left[ \\frac{L_1}{m} - \\left(\\frac{K_1}{2m}\\right)^2 \\right] + \\left[ \\frac{L_2}{m} - \\left(\\frac{K_2}{2m}\\right)^2 \\right]\n$$\n$$\nQ(\\mathcal{P}_{\\mathrm{sep}}) = \\frac{L_1+L_2}{m} - \\frac{K_1^2+K_2^2}{(2m)^2}\n$$\nWe have $m = L_1+L_2+1$. Note also that $K_1 = 2L_1+1$ and $K_2 = 2L_2+1$. Substituting these into the expression:\n$$\nQ(\\mathcal{P}_{\\mathrm{sep}}) = \\frac{L_1+L_2}{L_1+L_2+1} - \\frac{(2L_1+1)^2+(2L_2+1)^2}{4(L_1+L_2+1)^2}\n$$\nPutting the terms over a common denominator $4(L_1+L_2+1)^2$:\n$$\nQ(\\mathcal{P}_{\\mathrm{sep}}) = \\frac{4(L_1+L_2)(L_1+L_2+1) - \\left( (2L_1+1)^2 + (2L_2+1)^2 \\right)}{4(L_1+L_2+1)^2}\n$$\nLet's expand the numerator:\nNumerator $= 4(L_1+L_2)^2 + 4(L_1+L_2) - (4L_1^2+4L_1+1 + 4L_2^2+4L_2+1)$\n$= 4(L_1^2+2L_1L_2+L_2^2) + 4L_1+4L_2 - 4L_1^2-4L_1-4L_2^2-4L_2-2$\nThe terms $4L_1^2$, $4L_2^2$, $4L_1$, and $4L_2$ cancel out.\nNumerator $= 8L_1L_2 - 2$\nSo, the modularity is:\n$$\nQ(\\mathcal{P}_{\\mathrm{sep}}) = \\frac{8L_1L_2 - 2}{4(L_1+L_2+1)^2} = \\frac{2(4L_1L_2 - 1)}{4m^2} = \\frac{4L_1L_2 - 1}{2m^2}\n$$\nNow, substitute the expressions for $L_1$, $L_2$, and $m$ in terms of $n_1$ and $n_2$:\n$4L_1L_2 - 1 = 4\\left(\\frac{n_1(n_1-1)}{2}\\right)\\left(\\frac{n_2(n_2-1)}{2}\\right) - 1 = n_1(n_1-1)n_2(n_2-1) - 1$.\n$2m^2 = 2\\left(\\frac{n_1(n_1-1)}{2} + \\frac{n_2(n_2-1)}{2} + 1\\right)^2 = 2\\left(\\frac{n_1(n_1-1) + n_2(n_2-1) + 2}{2}\\right)^2 = \\frac{(n_1(n_1-1) + n_2(n_2-1) + 2)^2}{2}$.\nTherefore:\n$$\nQ(\\mathcal{P}_{\\mathrm{sep}}) = \\frac{n_1(n_1-1)n_2(n_2-1) - 1}{\\frac{1}{2}(n_1(n_1-1) + n_2(n_2-1) + 2)^2} = \\frac{2(n_1(n_1-1)n_2(n_2-1) - 1)}{(n_1(n_1-1) + n_2(n_2-1) + 2)^2}\n$$\nThe problem asks for $Q(\\mathcal{P}_{\\mathrm{sep}}) - Q(\\mathcal{P}_{\\mathrm{all}})$. Since $Q(\\mathcal{P}_{\\mathrm{all}})=0$, this is simply $Q(\\mathcal{P}_{\\mathrm{sep}})$.\nThe final expression can also be written in terms of expanded polynomials:\n$n_1(n_1-1) = n_1^2-n_1$ and $n_2(n_2-1) = n_2^2-n_2$.\n$$\nQ(\\mathcal{P}_{\\mathrm{sep}}) - Q(\\mathcal{P}_{\\mathrm{all}}) = \\frac{2((n_1^2-n_1)(n_2^2-n_2) - 1)}{(n_1^2-n_1 + n_2^2-n_2 + 2)^2}\n$$\nThis is the required closed-form analytic expression.",
            "answer": "$$\n\\boxed{\\frac{2\\left(n_1(n_1-1)n_2(n_2-1) - 1\\right)}{\\left(n_1(n_1-1) + n_2(n_2-1) + 2\\right)^2}}\n$$"
        },
        {
            "introduction": "Modularity maximization algorithms often work by iteratively moving nodes between communities to increase the overall modularity score. This problem focuses on that fundamental step: calculating the change in modularity, $\\Delta Q$, resulting from a single node move. Using the canonical star graph, you will uncover how the configuration model's expectations can lead to counter-intuitive results and provide insight into the behavior of greedy optimization methods. ",
            "id": "4288199",
            "problem": "Consider a simple, undirected, unweighted star graph with $L \\geq 2$ leaves and a single hub, so the total number of nodes is $N = L + 1$ and the total number of edges is $m = L$. Each leaf has degree $1$, and the hub has degree $L$. You will evaluate the quality of two community assignments using the standard modularity quality function under the configuration model (CM) null hypothesis.\n\nStarting from the definition of modularity,\n$$\nQ \\;=\\; \\frac{1}{2m} \\sum_{i,j} \\left( A_{ij} \\;-\\; \\frac{k_i k_j}{2m} \\right) \\,\\delta(c_i, c_j),\n$$\nwhere $A_{ij}$ is the adjacency matrix, $k_i$ is the degree of node $i$, and $\\delta(c_i, c_j)$ equals $1$ if nodes $i$ and $j$ are in the same community and $0$ otherwise, compute the change in modularity\n$$\n\\Delta Q \\;=\\; Q_{\\text{after}} \\;-\\; Q_{\\text{before}}\n$$\nwhen the hub moves from being alone in its own community to being placed in the same community as all leaves (i.e., the partition changes from two communities, one containing only the hub and one containing all leaves, to a single community containing all nodes). In your computation, you may equivalently use the community-aggregated form based on internal edges and community degree sums:\n$$\nQ \\;=\\; \\sum_{c} \\left( \\frac{e_c}{m} \\;-\\; \\left(\\frac{K_c}{2m}\\right)^{2} \\right),\n$$\nwhere $e_c$ is the number of edges with both endpoints in community $c$, and $K_c$ is the sum of the degrees of nodes in community $c$.\n\nCompute the exact value of $\\Delta Q$ and briefly interpret the outcome relative to the configuration model null expectation. The final numerical value of $\\Delta Q$ must be provided as the answer. No rounding is required, and no units are needed.",
            "solution": "The problem asks for the change in modularity, $\\Delta Q = Q_{\\text{after}} - Q_{\\text{before}}$, for a star graph when moving from a two-community partition to a single-community partition. We are given the necessary graph properties and the community-aggregated modularity formula:\n$$Q = \\sum_{c} \\left( \\frac{e_c}{m} - \\left(\\frac{K_c}{2m}\\right)^{2} \\right)$$\n\nFirst, we establish the parameters of the star graph. It has $L+1$ nodes, consisting of $1$ hub and $L$ leaves. The total number of edges is $m = L$. The degree of the hub is $k_{hub} = L$, and the degree of each of the $L$ leaves is $k_{leaf} = 1$. The total sum of degrees in the graph is $\\sum_i k_i = k_{hub} + L \\times k_{leaf} = L + L \\times 1 = 2L$. This is consistent with the handshaking lemma, $2m = 2L$.\n\nWe will now calculate the modularity for the initial and final partitions.\n\n**1. Modularity Before the Change ($Q_{\\text{before}}$)**\n\nThe initial partition consists of two communities:\n- $C_{H}$: containing only the hub.\n- $C_{L}$: containing all $L$ leaves.\n\nWe need to compute the number of internal edges ($e_c$) and the sum of degrees of nodes ($K_c$) for each community.\n\nFor community $C_{H}$:\n- There is only one node (the hub), so there can be no internal edges. Thus, $e_{C_H} = 0$.\n- The sum of degrees is simply the degree of the hub: $K_{C_{H}} = k_{hub} = L$.\n\nFor community $C_{L}$:\n- The leaves are connected only to the hub. There are no edges between any two leaves. Therefore, the number of internal edges is $e_{C_{L}} = 0$.\n- The sum of degrees is the sum of the degrees of all $L$ leaves: $K_{C_{L}} = \\sum_{i \\in C_L} k_i = L \\times 1 = L$.\n\nNow, we can compute $Q_{\\text{before}}$ by summing the contributions from both communities. We use $m = L$ and $2m = 2L$.\n$$Q_{\\text{before}} = \\left( \\frac{e_{C_H}}{m} - \\left(\\frac{K_{C_H}}{2m}\\right)^{2} \\right) + \\left( \\frac{e_{C_L}}{m} - \\left(\\frac{K_{C_L}}{2m}\\right)^{2} \\right)$$\nSubstituting the values we found:\n$$Q_{\\text{before}} = \\left( \\frac{0}{L} - \\left(\\frac{L}{2L}\\right)^{2} \\right) + \\left( \\frac{0}{L} - \\left(\\frac{L}{2L}\\right)^{2} \\right)$$\n$$Q_{\\text{before}} = \\left( 0 - \\left(\\frac{1}{2}\\right)^{2} \\right) + \\left( 0 - \\left(\\frac{1}{2}\\right)^{2} \\right)$$\n$$Q_{\\text{before}} = -\\frac{1}{4} - \\frac{1}{4} = -\\frac{2}{4} = -\\frac{1}{2}$$\n\n**2. Modularity After the Change ($Q_{\\text{after}}$)**\n\nThe final partition consists of a single community, $C_{All}$, containing all $L+1$ nodes (the hub and all leaves).\n\nFor community $C_{All}$:\n- The number of internal edges, $e_{C_{All}}$, is the total number of edges in the graph. So, $e_{C_{All}} = m = L$.\n- The sum of degrees, $K_{C_{All}}$, is the sum of the degrees of all nodes in the graph, which is $2m = 2L$.\n\nNow, we compute $Q_{\\text{after}}$. The sum in the modularity formula is over a single term.\n$$Q_{\\text{after}} = \\frac{e_{C_{All}}}{m} - \\left(\\frac{K_{C_{All}}}{2m}\\right)^{2}$$\nSubstituting the values:\n$$Q_{\\text{after}} = \\frac{L}{L} - \\left(\\frac{2L}{2L}\\right)^{2}$$\n$$Q_{\\text{after}} = 1 - (1)^{2} = 1 - 1 = 0$$\n\n**3. Change in Modularity ($\\Delta Q$)**\n\nThe change in modularity is the difference between the final and initial modularity values.\n$$\\Delta Q = Q_{\\text{after}} - Q_{\\text{before}}$$\n$$\\Delta Q = 0 - \\left(-\\frac{1}{2}\\right) = \\frac{1}{2}$$\n\n**Interpretation:**\nThe initial modularity, $Q_{\\text{before}} = -1/2$, is negative. This indicates that the partition is significantly worse than what would be expected from a random graph with the same degree sequence (the configuration model null hypothesis). This is because all edges in the network are inter-community edges, while a good partition maximizes intra-community edges. The number of edges within communities is $0$, which is less than the expected number, leading to a negative value.\n\nThe final modularity, $Q_{\\text{after}} = 0$, corresponds to a partition where the entire graph is a single community. This always results in a modularity of $0$, which serves as a neutral baseline. It implies the structure is no better or worse than a random assignment to a single community.\n\nThe change, $\\Delta Q = 1/2$, is positive, signifying that collapsing the two communities into one is an improvement according to the modularity metric. The move takes the partition from a pathologically \"anti-community\" structure to a neutral baseline, hence the positive change. The result is independent of the number of leaves $L$ (for $L \\geq 2$ as specified).",
            "answer": "$$\\boxed{\\frac{1}{2}}$$"
        },
        {
            "introduction": "While a powerful tool, modularity is not without its limitations, the most famous of which is the resolution limit. This practice problem demonstrates how modularity maximization can fail to identify small, well-defined communities within a larger network, paradoxically favoring their merger. By analyzing this scenario, you will develop a critical understanding of one of modularity's key shortcomings and the importance of considering network scale in community detection. ",
            "id": "4288162",
            "problem": "Consider an undirected, unweighted simple graph composed of three node-disjoint parts. Part one is a clique on $12$ vertices (call it community $\\mathcal{A}$). Part two is another clique on $12$ vertices (community $\\mathcal{B}$). Between $\\mathcal{A}$ and $\\mathcal{B}$, add exactly $s$ edges, each joining a vertex in $\\mathcal{A}$ to a vertex in $\\mathcal{B}$, with no parallel edges and no self-loops. Part three is a background subgraph $\\mathcal{R}$ on an arbitrary number of vertices, containing exactly $M = 10000$ edges, with no edges connecting $\\mathcal{R}$ to either $\\mathcal{A}$ or $\\mathcal{B}$.\n\nLet partition $\\mathcal{P}_{\\mathrm{sep}}$ consist of two communities $\\mathcal{A}$ and $\\mathcal{B}$ treated as separate, and the entire background $\\mathcal{R}$ treated as a single community. Let partition $\\mathcal{P}_{\\mathrm{merge}}$ be identical to $\\mathcal{P}_{\\mathrm{sep}}$ except that $\\mathcal{A}$ and $\\mathcal{B}$ are merged into a single community $\\mathcal{A} \\cup \\mathcal{B}$ while $\\mathcal{R}$ remains a single community.\n\nUsing the standard modularity quality function with the configuration model null model and resolution parameter equal to $1$, derive from first principles the condition on $s$ under which $\\mathcal{P}_{\\mathrm{merge}}$ has strictly larger modularity than $\\mathcal{P}_{\\mathrm{sep}}$. Then, evaluate this condition for the given numerical parameters and determine the smallest integer $s \\geq 1$ for which $\\mathcal{P}_{\\mathrm{merge}}$ has larger modularity than $\\mathcal{P}_{\\mathrm{sep}}$.\n\nExpress your final answer as the minimal integer $s$. No rounding is required.",
            "solution": "The problem asks for the condition on the number of inter-community edges $s$ such that merging two communities, $\\mathcal{A}$ and $\\mathcal{B}$, results in a strictly higher modularity score. We must then find the smallest integer $s \\geq 1$ that satisfies this condition. The analysis will be based on the standard definition of modularity for an unweighted graph.\n\nThe modularity, $Q$, of a partition of a network into communities is given by the formula:\n$$\nQ = \\sum_{c} \\left[ \\frac{l_c}{m} - \\gamma \\left( \\frac{K_c}{2m} \\right)^2 \\right]\n$$\nwhere the sum is over all communities $c$ in the partition. In this formula:\n- $l_c$ is the number of edges with both endpoints within community $c$.\n- $K_c$ is the sum of the degrees of all nodes in community $c$.\n- $m$ is the total number of edges in the entire graph.\n- $\\gamma$ is the resolution parameter, given as $\\gamma = 1$.\n\nFirst, we must calculate the fundamental properties of the graph.\nThe graph consists of three parts: a clique $\\mathcal{A}$ on $n_A = 12$ vertices, a clique $\\mathcal{B}$ on $n_B = 12$ vertices, and a background subgraph $\\mathcal{R}$.\nThe number of edges within clique $\\mathcal{A}$ is $L_{\\mathcal{A}} = \\binom{12}{2} = \\frac{12 \\times 11}{2} = 66$.\nSimilarly, the number of edges within clique $\\mathcal{B}$ is $L_{\\mathcal{B}} = \\binom{12}{2} = 66$.\nThe number of edges in the background subgraph $\\mathcal{R}$ is given as $M = 10000$.\nThere are $s$ edges connecting $\\mathcal{A}$ and $\\mathcal{B}$. There are no edges connecting $\\mathcal{R}$ to $\\mathcal{A}$ or $\\mathcal{B}$.\nThe total number of edges in the graph is the sum of these counts:\n$$\nm = L_{\\mathcal{A}} + L_{\\mathcal{B}} + s + M = 66 + 66 + s + 10000 = 10132 + s\n$$\n\nNext, we calculate the sum of degrees for the nodes in each part. The sum of degrees for a set of nodes is twice the number of internal edges plus the number of external edges.\n- For $\\mathcal{A}$: The internal edges are $L_{\\mathcal{A}} = 66$. The external edges are the $s$ edges to $\\mathcal{B}$. The sum of degrees for nodes in $\\mathcal{A}$ is $K_{\\mathcal{A}} = 2 L_{\\mathcal{A}} + s = 2(66) + s = 132 + s$.\n- For $\\mathcal{B}$: Similarly, $K_{\\mathcal{B}} = 2 L_{\\mathcal{B}} + s = 2(66) + s = 132 + s$.\n- For $\\mathcal{R}$: The internal edges are $M = 10000$. There are no external edges. The sum of degrees for nodes in $\\mathcal{R}$ is $K_{\\mathcal{R}} = 2M = 2(10000) = 20000$.\n\nWe need to compare the modularity of two different partitions, $\\mathcal{P}_{\\mathrm{sep}}$ and $\\mathcal{P}_{\\mathrm{merge}}$.\n\nFor partition $\\mathcal{P}_{\\mathrm{sep}} = \\{\\mathcal{A}, \\mathcal{B}, \\mathcal{R}\\}$, the communities are $\\mathcal{A}$, $\\mathcal{B}$, and $\\mathcal{R}$ separately.\nThe number of internal edges for each community are:\n- $l_{\\mathcal{A}} = L_{\\mathcal{A}} = 66$\n- $l_{\\mathcal{B}} = L_{\\mathcal{B}} = 66$\n- $l_{\\mathcal{R}} = M = 10000$\nThe modularity of this partition is:\n$$\nQ_{\\mathrm{sep}} = \\left[ \\frac{l_{\\mathcal{A}}}{m} - \\left(\\frac{K_{\\mathcal{A}}}{2m}\\right)^2 \\right] + \\left[ \\frac{l_{\\mathcal{B}}}{m} - \\left(\\frac{K_{\\mathcal{B}}}{2m}\\right)^2 \\right] + \\left[ \\frac{l_{\\mathcal{R}}}{m} - \\left(\\frac{K_{\\mathcal{R}}}{2m}\\right)^2 \\right]\n$$\nSubstituting the known expressions:\n$$\nQ_{\\mathrm{sep}} = \\left[ \\frac{66}{m} - \\left(\\frac{132+s}{2m}\\right)^2 \\right] + \\left[ \\frac{66}{m} - \\left(\\frac{132+s}{2m}\\right)^2 \\right] + \\left[ \\frac{10000}{m} - \\left(\\frac{20000}{2m}\\right)^2 \\right]\n$$\n\nFor partition $\\mathcal{P}_{\\mathrm{merge}} = \\{\\mathcal{A} \\cup \\mathcal{B}, \\mathcal{R}\\}$, the communities are the merged group $\\mathcal{A} \\cup \\mathcal{B}$ and the background $\\mathcal{R}$.\nThe properties of the merged community $\\mathcal{C}_{\\mathrm{merge}} = \\mathcal{A} \\cup \\mathcal{B}$ are:\n- Internal edges $l_{\\mathcal{C}_{\\mathrm{merge}}}$: This includes edges within $\\mathcal{A}$, edges within $\\mathcal{B}$, and edges between $\\mathcal{A}$ and $\\mathcal{B}$. So, $l_{\\mathcal{C}_{\\mathrm{merge}}} = L_{\\mathcal{A}} + L_{\\mathcal{B}} + s = 66 + 66 + s = 132 + s$.\n- Sum of degrees $K_{\\mathcal{C}_{\\mathrm{merge}}}$: This is the sum of degrees of all nodes in $\\mathcal{A}$ and $\\mathcal{B}$. So, $K_{\\mathcal{C}_{\\mathrm{merge}}} = K_{\\mathcal{A}} + K_{\\mathcal{B}} = (132+s) + (132+s) = 264 + 2s$.\nThe community $\\mathcal{R}$ remains unchanged. Its properties are $l_{\\mathcal{R}} = 10000$ and $K_{\\mathcal{R}} = 20000$.\nThe modularity of this partition is:\n$$\nQ_{\\mathrm{merge}} = \\left[ \\frac{l_{\\mathcal{C}_{\\mathrm{merge}}}}{m} - \\left(\\frac{K_{\\mathcal{C}_{\\mathrm{merge}}}}{2m}\\right)^2 \\right] + \\left[ \\frac{l_{\\mathcal{R}}}{m} - \\left(\\frac{K_{\\mathcal{R}}}{2m}\\right)^2 \\right]\n$$\nSubstituting the known expressions:\n$$\nQ_{\\mathrm{merge}} = \\left[ \\frac{132+s}{m} - \\left(\\frac{264+2s}{2m}\\right)^2 \\right] + \\left[ \\frac{10000}{m} - \\left(\\frac{20000}{2m}\\right)^2 \\right]\n$$\n\nWe want to find the condition for $Q_{\\mathrm{merge}} > Q_{\\mathrm{sep}}$. Let's compute the difference $\\Delta Q = Q_{\\mathrm{merge}} - Q_{\\mathrm{sep}}$. The terms related to community $\\mathcal{R}$ are identical in both expressions and will cancel out.\n$$\n\\Delta Q = \\left( \\frac{132+s}{m} - \\left(\\frac{264+2s}{2m}\\right)^2 \\right) - \\left( \\frac{66}{m} - \\left(\\frac{132+s}{2m}\\right)^2 + \\frac{66}{m} - \\left(\\frac{132+s}{2m}\\right)^2 \\right)\n$$\n$$\n\\Delta Q = \\frac{132+s}{m} - \\frac{132}{m} - \\frac{(2(132+s))^2}{(2m)^2} + 2\\frac{(132+s)^2}{(2m)^2}\n$$\n$$\n\\Delta Q = \\frac{s}{m} - \\frac{4(132+s)^2}{(2m)^2} + \\frac{2(132+s)^2}{(2m)^2}\n$$\n$$\n\\Delta Q = \\frac{s}{m} - \\frac{2(132+s)^2}{4m^2} = \\frac{s}{m} - \\frac{(132+s)^2}{2m^2}\n$$\nNote that this is a specific case of the general formula for modularity change when merging two communities $\\mathcal{A}$ and $\\mathcal{B}$ with $s$ edges between them: $\\Delta Q = \\frac{s}{m} - \\frac{K_{\\mathcal{A}}K_{\\mathcal{B}}}{2m^2}$. Here, $K_{\\mathcal{A}}=K_{\\mathcal{B}}=132+s$.\n\nThe condition $Q_{\\mathrm{merge}} > Q_{\\mathrm{sep}}$ is equivalent to $\\Delta Q > 0$:\n$$\n\\frac{s}{m} - \\frac{(132+s)^2}{2m^2} > 0\n$$\nSince $m = 10132 + s$ and we are given $s \\geq 1$, $m$ is strictly positive. We can multiply the inequality by $2m^2$ without changing its direction:\n$$\n2ms - (132+s)^2 > 0\n$$\nNow, we substitute $m = 10132+s$:\n$$\n2s(10132+s) - (132+s)^2 > 0\n$$\nThis is the condition on $s$ derived from first principles. Now we must solve it.\n$$\n20264s + 2s^2 - (132^2 + 2(132)s + s^2) > 0\n$$\n$$\n20264s + 2s^2 - (17424 + 264s + s^2) > 0\n$$\n$$\ns^2 + (20264 - 264)s - 17424 > 0\n$$\n$$\ns^2 + 20000s - 17424 > 0\n$$\nThis is a quadratic inequality. Let $f(s) = s^2 + 20000s - 17424$. The function $f(s)$ represents a parabola opening upwards. The inequality will hold for values of $s$ outside the roots of the quadratic equation $f(s) = 0$. The roots are given by the quadratic formula $s = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$:\n$$\ns = \\frac{-20000 \\pm \\sqrt{20000^2 - 4(1)(-17424)}}{2(1)}\n$$\n$$\ns = \\frac{-20000 \\pm \\sqrt{400000000 + 69696}}{2}\n$$\n$$\ns = \\frac{-20000 \\pm \\sqrt{400069696}}{2}\n$$\nThe two roots are:\n$s_1 = \\frac{-20000 - \\sqrt{400069696}}{2}$ which is a large negative number.\n$s_2 = \\frac{-20000 + \\sqrt{400069696}}{2}$ which is the positive root.\n\nSince we are only interested in $s \\geq 1$, we need to find the smallest integer $s$ such that $s > s_2$. Let's evaluate $s_2$:\n$\\sqrt{400069696} \\approx \\sqrt{4 \\times 10^8} = 2 \\times 10^4 = 20000$. The value under the square root is slightly larger.\nLet's evaluate $f(s)$ at small integer values of $s$.\nFor $s=0$: $f(0) = 0^2 + 20000(0) - 17424 = -17424 < 0$. So the positive root $s_2$ is greater than $0$.\nFor $s=1$: $f(1) = 1^2 + 20000(1) - 17424 = 1 + 20000 - 17424 = 2577 > 0$.\nSince $f(0) < 0$ and $f(1) > 0$, the positive root $s_2$ must lie in the interval $(0, 1)$.\nThe inequality $f(s) > 0$ is satisfied for all $s > s_2$. Since $0 < s_2 < 1$, the smallest integer $s \\geq 1$ that satisfies $s > s_2$ is $s=1$.\n\nThe reason for this low threshold is the large number of edges $M = 10000$ in the background graph $\\mathcal{R}$, which makes the total number of edges $m$ very large. In the configuration null model, the expected number of edges between communities $\\mathcal{A}$ and $\\mathcal{B}$ is $E_{\\mathcal{A}\\mathcal{B}} = \\frac{K_{\\mathcal{A}}K_{\\mathcal{B}}}{2m}$. For $s=1$, this is approximately $\\frac{133 \\times 133}{2 \\times 10133} \\approx \\frac{17689}{20266} \\approx 0.87$. The condition to merge is that the actual number of edges $s$ is greater than this expected number. Since $1 > 0.87$, even a single edge is a stronger connection than expected by chance, favoring the merge.\n\nThus, the smallest integer $s \\geq 1$ for which $\\mathcal{P}_{\\mathrm{merge}}$ has larger modularity is $1$.",
            "answer": "$$\n\\boxed{1}\n$$"
        }
    ]
}