{
    "hands_on_practices": [
        {
            "introduction": "To build a solid foundation, our first practice examines the simplest non-trivial network topology: the path graph. This exercise asks you to derive both shortest-path and current-flow betweenness for a node on a path, demonstrating that in this special case, the two measures are identical. Completing this derivation will provide a clear combinatorial interpretation of betweenness as counting the pairs of nodes separated by a given node. ",
            "id": "4263552",
            "problem": "Consider the path graph $P_n$ on $n$ labeled nodes $\\{1,2,\\dots,n\\}$ with edges $\\{(i,i+1) : i=1,2,\\dots,n-1\\}$. Fix an internal node $k$ with $1kn$. Use only the following foundational bases:\n\n- The combinatorial definition of shortest-path betweenness centrality (BC): for a node $v$ in an undirected, connected graph, the unnormalized betweenness centrality is defined as\n$$\nB(v) \\equiv \\sum_{\\substack{st \\\\ s\\neq v,\\; t\\neq v}} \\frac{\\sigma_{st}(v)}{\\sigma_{st}},\n$$\nwhere $\\sigma_{st}$ is the number of shortest paths between $s$ and $t$ and $\\sigma_{st}(v)$ is the number of those shortest paths that pass through $v$ as an internal node.\n\n- The electrical-network definition of current-flow betweenness centrality (CFBC): for a node $v$, the unnormalized current-flow betweenness centrality is\n$$\nC(v) \\equiv \\sum_{\\substack{st \\\\ s\\neq v,\\; t\\neq v}} I_{st}(v),\n$$\nwhere $I_{st}(v)$ is the total absolute current flowing through $v$ when one unit of current is injected at $s$ and withdrawn at $t$, each edge has unit resistance, and currents obey Ohm’s law and Kirchhoff’s current and voltage laws.\n\nDerive, from these bases and without invoking any shortcut formulas special to $P_n$, a closed-form expression for both $B(k)$ and $C(k)$, and justify why they coincide on $P_n$ by appealing to the structural properties of trees and the uniqueness of simple $s$–$t$ paths. Provide a combinatorial interpretation for your expression as a count of unordered source–target pairs separated by $k$. Your final answer must be a single closed-form expression in terms of $n$ and $k$. No rounding is required and no physical units apply.",
            "solution": "The problem statement is evaluated to be valid as it is scientifically grounded in network science, well-posed, objective, and self-contained. The definitions provided for shortest-path and current-flow betweenness centrality are standard, and the path graph $P_n$ is a fundamental structure in graph theory. The problem asks for a derivation from first principles, which is a meaningful exercise in understanding these concepts. No flaws, as defined in the problem validation checklist, were detected.\n\nWe will proceed by first deriving the shortest-path betweenness centrality $B(k)$, then justifying its equivalence to current-flow betweenness centrality $C(k)$ on trees, and finally stating the result for $C(k)$ and providing the combinatorial interpretation.\n\nThe graph in question is the path graph $P_n$ on $n$ nodes, which are labeled sequentially as $1, 2, \\dots, n$. The edges connect adjacent nodes, i.e., $\\{(i, i+1) : i=1, \\dots, n-1\\}$. A path graph is a type of tree. A fundamental property of any tree is that for any two distinct nodes $s$ and $t$, there exists a unique simple path connecting them. This path is necessarily the shortest path. Therefore, for any pair of nodes $(s, t)$ in $P_n$, the number of shortest paths is $\\sigma_{st} = 1$.\n\nFirst, we derive the shortest-path betweenness centrality, $B(k)$, for an internal node $k$ where $1  k  n$. The definition is:\n$$\nB(k) \\equiv \\sum_{\\substack{st \\\\ s\\neq k,\\; t\\neq k}} \\frac{\\sigma_{st}(k)}{\\sigma_{st}}\n$$\nGiven that $\\sigma_{st} = 1$ for all pairs $(s, t)$ in $P_n$, the expression simplifies to:\n$$\nB(k) = \\sum_{\\substack{st \\\\ s\\neq k,\\; t\\neq k}} \\sigma_{st}(k)\n$$\nThe term $\\sigma_{st}(k)$ represents the number of shortest paths between $s$ and $t$ that pass through the node $k$. Since there is only one shortest path between any $s$ and $t$, $\\sigma_{st}(k)$ must be either $1$ (if the unique path contains $k$) or $0$ (if it does not). Consequently, the summation for $B(k)$ becomes a count of the number of unordered pairs $\\{s, t\\}$ (with $s \\neq k, t \\neq k$) such that the unique path between $s$ and $t$ includes $k$.\n\nIn the path graph $P_n$, the node $k$ lies on the path between $s$ and $t$ if and only if $s$ and $t$ are on opposite sides of $k$. Given the node labeling and the summation convention $s  t$, this condition is equivalent to $s  k  t$.\nTo count the number of such pairs, we identify the possible choices for $s$ and $t$:\nThe source node $s$ must be chosen from the set of nodes preceding $k$: $s \\in \\{1, 2, \\dots, k-1\\}$. There are $k-1$ choices for $s$.\nThe target node $t$ must be chosen from the set of nodes succeeding $k$: $t \\in \\{k+1, k+2, \\dots, n\\}$. There are $n - (k+1) + 1 = n-k$ choices for $t$.\n\nEach choice of $s$ from the first set and $t$ from the second set forms a pair $(s, t)$ that satisfies $s  k  t$. The total number of such pairs is the product of the number of choices for $s$ and $t$.\n$$\nB(k) = (k-1)(n-k)\n$$\n\nNext, we address the current-flow betweenness centrality, $C(k)$, and justify its equivalence to $B(k)$. The definition is:\n$$\nC(k) \\equiv \\sum_{\\substack{st \\\\ s\\neq k,\\; t\\neq k}} I_{st}(k)\n$$\nHere, $I_{st}(k)$ is the current through node $k$ when $1$ unit of current is injected at $s$ and withdrawn at $t$. The graph is treated as a resistive network with each edge having unit resistance. Because $P_n$ is a tree, there is a unique simple path between $s$ and $t$. In an electrical network that is a tree, there are no cycles for current to flow in. By Kirchhoff's laws, any current leaving the source $s$ must travel towards the sink $t$. Any deviation into a \"side-branch\" (an edge not on the unique $s-t$ path) would require the current to be absorbed somewhere other than $t$, which is forbidden. Thus, the entire $1$ unit of current flows exclusively along the unique simple path from $s$ to $t$.\n\nIf a node $k$ is on this unique path, the full $1$ unit of current passes through it. So, $I_{st}(k) = 1$. If $k$ is not on this path, no current flows through it, and $I_{st}(k) = 0$. This can be summarized as:\n$$\nI_{st}(k) = \\begin{cases} 1  \\text{if } k \\text{ is on the unique path between } s \\text{ and } t \\\\ 0  \\text{otherwise} \\end{cases}\n$$\nThis is precisely the same condition we found for the value of the term $\\sigma_{st}(k)/\\sigma_{st}$ in a tree. Since the unique simple path is the unique shortest path in a tree, the condition for $I_{st}(k)$ being $1$ is identical to the condition for $\\sigma_{st}(k)/\\sigma_{st}$ being $1$. This establishes that for any node $v$ in any tree, $I_{st}(v) = \\sigma_{st}(v)/\\sigma_{st}$ for all $s,t$. It follows that the total centralities must be equal: $C(v) = B(v)$. This structural property of trees is the reason the two centrality measures coincide for the path graph $P_n$.\n\nGiven that $C(k) = B(k)$, the derivation of $C(k)$ is identical to that of $B(k)$. The sum for $C(k)$ also counts the number of pairs $(s, t)$ with $s  t$ such that $k$ lies on the path between them. As calculated previously, this number is:\n$$\nC(k) = (k-1)(n-k)\n$$\n\nFinally, we provide the requested combinatorial interpretation. The expression $(k-1)(n-k)$ represents the number of ways to form a pair of nodes $\\{s, t\\}$ by choosing one node from the set $\\{1, \\dots, k-1\\}$ and the other from the set $\\{k+1, \\dots, n\\}$. These two sets are the connected components that would be formed if node $k$ were removed from the graph. Thus, the expression counts the total number of unordered pairs of nodes that are separated by node $k$. This aligns with the notion that a node is central if it lies on many paths connecting other nodes.",
            "answer": "$$\\boxed{(k-1)(n-k)}$$"
        },
        {
            "introduction": "Having seen where the two centrality measures agree, we now turn to a classic thought experiment designed to highlight their fundamental differences. This problem presents a graph with one very short path and several slightly longer alternative routes, a scenario that tests the core logic of each centrality definition. By calculating the contribution of a key node to both shortest-path and current-flow betweenness, you will directly observe how the former's reliance on 'geodesics' can contrast with the latter's 'diffusive' nature that accounts for all available paths. ",
            "id": "4263558",
            "problem": "Consider the undirected, unweighted simple graph constructed as follows. Fix an integer parameter $m \\ge 0$. The vertex set is $\\{s,t,v\\} \\cup \\{a_i,b_i\\}_{i=1}^{m}$. The edge set is $\\{\\{s,v\\},\\{v,t\\}\\} \\cup \\bigcup_{i=1}^{m} \\{\\{s,a_i\\},\\{a_i,b_i\\},\\{b_i,t\\}\\}$. Interpret each edge as a unit resistor of resistance $1$ in the electrical-network model of current-flow betweenness. Let $s$ be the source and $t$ be the sink for a unit current injection.\n\nUse only fundamental definitions and laws to answer the following.\n\n- For geodesic betweenness, use the pairwise contribution definition: for vertices $x,y$ with $x \\neq y$, the dependency of $(x,y)$ on a vertex $w \\notin \\{x,y\\}$ is $\\delta_{xy}(w) = \\sigma_{xy}(w)/\\sigma_{xy}$, where $\\sigma_{xy}$ is the number of shortest $x$–$y$ paths and $\\sigma_{xy}(w)$ is the number of such paths that pass through $w$.\n\n- For current-flow betweenness, use Kirchhoff’s circuit laws on the unit-resistor network: inject current $I=1$ at $s$ and extract it at $t$, and let $\\iota_{st}(w)$ denote the magnitude of the electrical current that passes through vertex $w$ under the unique solution of the resulting linear system.\n\nIn this graph, the unique shortest $s$–$t$ path passes through $v$, but there also exist $m$ internally disjoint alternative $s$–$t$ routes that avoid $v$ and are one edge longer.\n\nCompute, in closed form as a function of $m$, the ratio\n$$\nR(m) \\equiv \\frac{\\delta_{st}(v)}{\\iota_{st}(v)}.\n$$\nProvide your final answer as a single simplified analytic expression in $m$. No numerical rounding is required and no units should be included in the final expression.",
            "solution": "The problem has been analyzed and is deemed valid as it is scientifically grounded, well-posed, and objective. It is a standard problem in network science, comparing two different measures of vertex centrality.\n\nThe solution proceeds in three parts: first, the calculation of the geodesic betweenness contribution $\\delta_{st}(v)$; second, the calculation of the current-flow betweenness $\\iota_{st}(v)$; and third, the computation of their ratio $R(m)$.\n\n**Part 1: Geodesic Betweenness Contribution $\\delta_{st}(v)$**\n\nGeodesic betweenness is based on the fraction of shortest paths between a pair of vertices that pass through a third vertex. The dependency of the pair $(s,t)$ on vertex $v$ is given by $\\delta_{st}(v) = \\frac{\\sigma_{st}(v)}{\\sigma_{st}}$, where $\\sigma_{st}$ is the total number of shortest paths (geodesics) from $s$ to $t$, and $\\sigma_{st}(v)$ is the number of such paths that pass through $v$.\n\nThe graph is unweighted, so path length is the number of edges. We identify all paths from $s$ to $t$:\n1.  The path $s \\to v \\to t$. The length of this path is $1+1=2$.\n2.  For each integer $i$ from $1$ to $m$, there is a path $s \\to a_i \\to b_i \\to t$. The length of each of these $m$ paths is $1+1+1=3$.\n\nThe shortest path length is $2$. There is only one path of this length, which is $s \\to v \\to t$. Therefore, the total number of shortest paths is $\\sigma_{st} = 1$.\n\nNext, we count the number of these shortest paths that pass through vertex $v$. The unique shortest path, $s \\to v \\to t$, by its construction, passes through $v$. Thus, the number of shortest paths from $s$ to $t$ passing through $v$ is $\\sigma_{st}(v) = 1$.\n\nUsing the provided definition, the geodesic betweenness contribution of $v$ to the pair $(s,t)$ is:\n$$\n\\delta_{st}(v) = \\frac{\\sigma_{st}(v)}{\\sigma_{st}} = \\frac{1}{1} = 1\n$$\n\n**Part 2: Current-Flow Betweenness $\\iota_{st}(v)$**\n\nCurrent-flow betweenness is analyzed using an electrical circuit analogy where each edge of the graph is a resistor of resistance $R=1$. A unit current, $I_{\\text{total}} = 1$, is injected at the source vertex $s$ and extracted at the sink vertex $t$. The quantity $\\iota_{st}(v)$ represents the magnitude of the current flowing through vertex $v$.\n\nThe circuit can be viewed as a set of parallel branches connecting $s$ and $t$.\n1.  One branch corresponds to the path $s \\to v \\to t$. It consists of two resistors, $R_{sv}$ and $R_{vt}$, in series. The total resistance of this branch is $R_{\\text{path},v} = R_{sv} + R_{vt} = 1+1=2$.\n2.  For each $i \\in \\{1, 2, \\dots, m\\}$, there is a branch corresponding to the path $s \\to a_i \\to b_i \\to t$. Each such branch consists of three resistors, $R_{sa_i}$, $R_{a_ib_i}$, and $R_{b_it}$, in series. The total resistance of each of these $m$ branches is $R_{\\text{path},i} = R_{sa_i} + R_{a_ib_i} + R_{b_it} = 1+1+1=3$.\n\nThere are $m$ identical paths of resistance $3$ in parallel. Their combined equivalent resistance, $R_m$, is given by:\n$$\n\\frac{1}{R_m} = \\sum_{i=1}^{m} \\frac{1}{R_{\\text{path},i}} = \\sum_{i=1}^{m} \\frac{1}{3} = \\frac{m}{3}\n$$\nThus, $R_m = \\frac{3}{m}$. This equivalent resistance is for the block of $m$ parallel paths involving the $\\{a_i, b_i\\}$ vertices. This entire block is in parallel with the path through $v$.\n\nThe total effective resistance of the circuit between $s$ and $t$, denoted $R_{\\text{eff}}$, is the equivalent resistance of $R_{\\text{path},v}$ and $R_m$ in parallel:\n$$\n\\frac{1}{R_{\\text{eff}}} = \\frac{1}{R_{\\text{path},v}} + \\frac{1}{R_m} = \\frac{1}{2} + \\frac{1}{3/m} = \\frac{1}{2} + \\frac{m}{3}\n$$\nCombining the terms gives:\n$$\n\\frac{1}{R_{\\text{eff}}} = \\frac{3 + 2m}{6} \\implies R_{\\text{eff}} = \\frac{6}{3 + 2m}\n$$\nAccording to Ohm's law, the potential difference (voltage) between the source $s$ and the sink $t$ is $\\Delta\\phi = \\phi_s - \\phi_t = I_{\\text{total}} \\times R_{\\text{eff}}$. Since $I_{\\text{total}} = 1$, the potential difference is simply equal to the effective resistance:\n$$\n\\Delta\\phi = R_{\\text{eff}} = \\frac{6}{3 + 2m}\n$$\nThis potential difference is applied across all parallel branches. The current flowing through the branch containing vertex $v$, let's call it $I_v$, can be calculated using Ohm's law for that branch:\n$$\nI_v = \\frac{\\Delta\\phi}{R_{\\text{path},v}} = \\frac{6 / (3 + 2m)}{2} = \\frac{3}{3 + 2m}\n$$\nThis current, $I_v$, flows from $s$ to $v$ and then from $v$ to $t$. The current entering vertex $v$ from $s$ is equal to the current leaving vertex $v$ for $t$. The magnitude of this throughput is defined as the current-flow betweenness of the vertex, $\\iota_{st}(v)$.\nTherefore:\n$$\n\\iota_{st}(v) = I_v = \\frac{3}{3 + 2m}\n$$\n\n**Part 3: The Ratio $R(m)$**\n\nThe final step is to compute the ratio $R(m) = \\frac{\\delta_{st}(v)}{\\iota_{st}(v)}$.\nSubstituting the values calculated in the previous parts:\n$$\nR(m) = \\frac{1}{\\frac{3}{3 + 2m}}\n$$\nSimplifying this expression gives:\n$$\nR(m) = \\frac{3 + 2m}{3}\n$$\nThis expression can also be written as $1 + \\frac{2}{3}m$. The form $\\frac{3+2m}{3}$ is a single simplified rational expression.",
            "answer": "$$\n\\boxed{\\frac{3+2m}{3}}\n$$"
        },
        {
            "introduction": "Finally, we transition from stylized, analytically solvable graphs to a more complex and common network structure: the 2D grid. This hands-on coding exercise challenges you to implement a method for calculating current-flow edge betweenness, a task that is computationally intensive and requires the powerful machinery of the graph Laplacian. By applying this technique, you will gain practical experience in analyzing networks where simple path counting is no longer feasible and develop an intuition for how an edge's position, such as its proximity to the boundary, impacts its role in global network flow. ",
            "id": "4263564",
            "problem": "Consider a finite, connected, undirected, weighted graph $G = (V,E)$ formed by a rectangular $m \\times n$ two-dimensional grid. Each vertex $v \\in V$ corresponds to an integer coordinate $(r,c)$ with $0 \\leq r \\leq m-1$ and $0 \\leq c \\leq n-1$. Each pair of vertices at unit Manhattan distance (four-neighbor connectivity) is joined by an edge $(i,j) \\in E$ with unit conductance $c_{ij} = 1$. Let $N = |V| = m \\cdot n$. Fix an edge $e = (u,v)$ with $u \\neq v$ inside the grid.\n\nUsing the electrical network analogy for graphs, define the current between two distinct vertices $s,t \\in V$ as follows: inject a unit current source at $s$ and a unit current sink at $t$. The resulting potential function over vertices $\\phi : V \\to \\mathbb{R}$ must satisfy Kirchhoff's Current Law (KCL) and Ohm's Law on each edge, with unit conductances on all present edges. Let the graph Laplacian $L \\in \\mathbb{R}^{N \\times N}$ be defined by $L_{ii} = \\sum_{j \\in \\mathcal{N}(i)} c_{ij}$ and $L_{ij} = -c_{ij}$ for $(i,j) \\in E$ and $i \\neq j$, and $L_{ij} = 0$ otherwise, where $\\mathcal{N}(i)$ denotes the neighbors of vertex $i$. The current flowing through a fixed edge $e=(u,v)$ under the $(s,t)$ injection is then the absolute magnitude of the edge flow, which is equal to $|c_{uv} \\cdot (\\phi_u - \\phi_v)|$.\n\nThe current-flow edge betweenness $C_e$ of edge $e$ is defined to be the average, over all unordered pairs $(s,t)$ with $s \\neq t$, of the absolute current through $e$ when one unit of current is injected at $s$ and extracted at $t$. Formally, let $\\mathcal{P} = \\{(s,t) \\in V \\times V : s  t\\}$ denote all unordered source-target pairs. Then\n$$\nC_e = \\frac{1}{|\\mathcal{P}|} \\sum_{(s,t) \\in \\mathcal{P}} \\left| c_{uv} \\cdot (\\phi_u^{(s,t)} - \\phi_v^{(s,t)}) \\right|,\n$$\nwhere $\\phi^{(s,t)}$ is the potential vector that satisfies KCL and Ohm's Law for the injection vector $b \\in \\mathbb{R}^N$ defined by $b_s = +1$, $b_t = -1$, and $b_i = 0$ for all other $i \\in V$. Because all edge conductances are unity, $c_{uv} = 1$, so the edge current reduces to $|\\phi_u^{(s,t)} - \\phi_v^{(s,t)}|$.\n\nYour task is to compute $C_e$ for specified grid sizes and specified edges, and to report the numerical value. In addition to computing $C_e$, you should ensure the computational method is consistent with the physical laws stated above and logically grounded in the properties of the graph Laplacian. You should also be prepared, in your reasoning, to offer a qualitative interpretation of how proximity of the edge to the boundary of the grid affects $C_e$, though the program will only output the numerical values.\n\nNo physical units are required because all conductances are unitless and all currents and potentials are defined up to consistent normalization via the unit injection. Angles are not involved, and no percentages are required.\n\nTest Suite (each test case is given as $(m,n,(r_u,c_u),(r_v,c_v))$ with the edge endpoints listed as vertex coordinates):\n- Test $1$: $(3,3,(1,1),(1,2))$\n- Test $2$: $(5,5,(2,2),(2,3))$\n- Test $3$: $(5,5,(0,2),(0,3))$\n- Test $4$: $(7,7,(3,3),(4,3))$\n- Test $5$: $(2,2,(0,0),(0,1))$\n- Test $6$: $(4,6,(2,3),(2,4))$\n\nYour program must, for each test case, compute the current-flow edge betweenness $C_e$ as a real number $C_e \\in \\mathbb{R}$ and produce a single line of output containing the results as a comma-separated list of floats enclosed in square brackets. Each float should be rounded to eight decimal places. For example, the output format should be of the form $[\\text{result}_1,\\text{result}_2,\\dots,\\text{result}_6]$ where each $\\text{result}_k$ is the $C_e$ for test case $k$ rounded to eight decimal places.",
            "solution": "The problem statement is assessed to be valid. It is scientifically grounded in the principles of network science and electrical circuit theory, is mathematically well-posed, and is defined with objectivity and precision. All necessary data and definitions for a unique solution are provided. We may therefore proceed with a full solution.\n\nThe central task is to compute the current-flow edge betweenness, $C_e$, for a specified edge $e=(u,v)$ in a rectangular grid graph. The method relies on the electrical analogy of graphs, where vertices are junctions and edges are conductors.\n\nFirst, we establish a clear mathematical framework. The graph is an $m \\times n$ grid. We can map each vertex, identified by its coordinates $(r,c)$ where $0 \\leq r  m$ and $0 \\leq c  n$, to a unique integer index $i \\in \\{0, 1, \\dots, N-1\\}$, where $N=mn$. A standard row-major mapping is $i = r \\cdot n + c$.\n\nThe electrical behavior of the network is governed by the graph Laplacian, $L \\in \\mathbb{R}^{N \\times N}$. For a graph with conductances $c_{ij}$ on edges $(i,j)$, the Laplacian is defined as:\n$$\nL_{ij} = \\begin{cases}\n    \\sum_{k \\in \\mathcal{N}(i)} c_{ik}  \\text{if } i = j \\\\\n    -c_{ij}  \\text{if } i \\neq j \\text{ and } (i,j) \\in E \\\\\n    0  \\text{otherwise}\n\\end{cases}\n$$\nIn this problem, all edges have unit conductance, $c_{ij}=1$. Thus, the diagonal entries $L_{ii}$ are equal to the degree of vertex $i$, and off-diagonal entries $L_{ij}$ are $-1$ if vertices $i$ and $j$ are adjacent, and $0$ otherwise.\n\nWhen a unit current is injected at a source vertex $s$ and withdrawn at a sink vertex $t$, the vector of vertex potentials $\\phi^{(s,t)} \\in \\mathbb{R}^N$ is the solution to Kirchhoff's Current Law, which in matrix form is:\n$$ L\\phi^{(s,t)} = b^{(s,t)} $$\nHere, $b^{(s,t)}$ is the current injection vector, defined by $b_s = +1$, $b_t = -1$, and $b_k = 0$ for all other vertices $k$.\n\nThe Laplacian matrix $L$ for a connected graph is singular, with a one-dimensional null space spanned by the vector $\\mathbf{1}$ of all ones. A solution to $L\\phi = b$ exists if and only if $b$ is orthogonal to the null space, i.e., $\\mathbf{1}^T b = \\sum b_i = 0$. Our injection vector $b^{(s,t)}$ satisfies this condition, as $\\sum_k b_k = 1 - 1 = 0$. The solution $\\phi^{(s,t)}$ is unique up to an additive constant (a choice of ground potential). However, potential differences, such as $\\phi_i - \\phi_j$, are unique and physically meaningful.\n\nTo solve for the potentials, we use the Moore-Penrose pseudoinverse of the Laplacian, $L^+$. The unique minimum-norm solution to the system is given by $\\phi^{(s,t)} = L^+ b^{(s,t)}$. The current flowing through the target edge $e=(u,v)$ is proportional to the potential difference across it. Since $c_{uv}=1$, the current is simply $|\\phi_u^{(s,t)} - \\phi_v^{(s,t)}|$.\n\nThe potential difference across edge $e=(u,v)$ can be expressed as:\n$$ \\phi_u^{(s,t)} - \\phi_v^{(s,t)} = (\\delta_u - \\delta_v)^T \\phi^{(s,t)} $$\nwhere $\\delta_k$ is the standard basis vector with a $1$ at index $k$ and $0$s elsewhere. Substituting the expressions for $\\phi^{(s,t)}$ and $b^{(s,t)}$:\n$$ \\phi_u^{(s,t)} - \\phi_v^{(s,t)} = (\\delta_u - \\delta_v)^T L^+ (\\delta_s - \\delta_t) $$\nThis expression reveals a powerful computational simplification. Instead of solving a linear system for each of the $\\frac{N(N-1)}{2}$ source-sink pairs, we can compute $L^+$ just once. Let us define a vector $y_e \\in \\mathbb{R}^N$ associated with the edge $e=(u,v)$:\n$$ y_e = L^+ (\\delta_u - \\delta_v) $$\nBecause $L$ is real and symmetric, its pseudoinverse $L^+$ is also real and symmetric. Thus, we can write the potential difference as:\n$$ \\phi_u^{(s,t)} - \\phi_v^{(s,t)} = (L^+(\\delta_u - \\delta_v))^T (\\delta_s - \\delta_t) = y_e^T (\\delta_s - \\delta_t) = y_{es} - y_{et} $$\nwhere $y_{ek}$ denotes the $k$-th component of the vector $y_e$.\n\nThe current-flow edge betweenness $C_e$ is the average of the absolute currents over all unordered pairs of distinct vertices $(s,t)$. With $N(N-1)/2$ such pairs, the formula is:\n$$ C_e = \\frac{1}{N(N-1)/2} \\sum_{0 \\le s  t  N} |\\phi_u^{(s,t)} - \\phi_v^{(s,t)}| = \\frac{2}{N(N-1)} \\sum_{0 \\le s  t  N} |y_{es} - y_{et}| $$\n\nThis leads to the following algorithm for each test case:\n1.  Given grid dimensions $m$ and $n$, set $N=mn$. Construct the $N \\times N$ Laplacian matrix $L$ corresponding to the grid graph with unit conductances. The mapping $i = r \\cdot n + c$ will be used to associate grid coordinates with matrix indices.\n2.  Compute the Moore-Penrose pseudoinverse $L^+$ of the Laplacian matrix.\n3.  For the given edge $e=(u,v)$, specified by coordinates $(r_u,c_u)$ and $(r_v,c_v)$, determine their indices $u_{idx}$ and $v_{idx}$.\n4.  Construct the vector $x_e = \\delta_{u_{idx}} - \\delta_{v_{idx}}$.\n5.  Calculate the vector $y_e = L^+ x_e$.\n6.  Initialize a sum variable to zero. Iterate through all pairs of indices $(s, t)$ with $0 \\le s  t  N$ and accumulate the sum of absolute differences $\\sum |y_{es} - y_{et}|$.\n7.  Divide the final sum by the total number of pairs, $N(N-1)/2$, to obtain $C_e$.\n\nQualitatively, the current-flow edge betweenness $C_e$ measures how critical an edge is for global transport in the network. Edges located in the center of the grid must carry current for many pairs of nodes that span from one side of the grid to the other. In contrast, edges near the boundaries or corners are part of fewer long-range paths and primarily service local current flows. Therefore, one should expect $C_e$ to be significantly higher for centrally located edges than for peripheral ones. This is exemplified by Test Case 2 (central edge) versus Test Case 3 (boundary edge) on the same $5 \\times 5$ grid, where we anticipate the former will have a substantially larger $C_e$.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the current-flow edge betweenness for specified edges in grid graphs.\n\n    The solution proceeds as follows:\n    1. For each test case (m, n, u_coords, v_coords), the total number of vertices\n       N = m * n is determined.\n    2. A mapping from 2D grid coordinates (r, c) to a 1D vertex index is\n       defined as idx = r * n + c.\n    3. The graph Laplacian L is constructed for the m x n grid. For each vertex i,\n       we find its neighbors j (up, down, left, right). L[i, j] is set to -1,\n       and the diagonal L[i, i] is the degree of vertex i. All conductances are 1.\n    4. The Moore-Penrose pseudoinverse of the Laplacian, L+, is computed using\n       np.linalg.pinv(L).\n    5. An edge vector x_e is created for the target edge e = (u, v). This vector has\n       a +1 at index u and a -1 at index v.\n    6. A vector y_e = L+ @ x_e is computed. The current through edge e for a source-sink\n       pair (s, t) is given by |y_e[s] - y_e[t]|.\n    7. The current-flow edge betweenness C_e is calculated by summing these absolute\n       differences over all unique pairs of vertices (s, t) and dividing by the\n       total number of pairs, N * (N - 1) / 2.\n    8. The results for all test cases are collected and printed in the specified format.\n    \"\"\"\n    test_cases = [\n        (3, 3, (1, 1), (1, 2)),\n        (5, 5, (2, 2), (2, 3)),\n        (5, 5, (0, 2), (0, 3)),\n        (7, 7, (3, 3), (4, 3)),\n        (2, 2, (0, 0), (0, 1)),\n        (4, 6, (2, 3), (2, 4)),\n    ]\n\n    results = []\n    \n    for m, n, u_coords, v_coords in test_cases:\n        N = m * n\n\n        def coord_to_idx(r, c):\n            return r * n + c\n\n        laplacian = np.zeros((N, N), dtype=np.float64)\n\n        for r in range(m):\n            for c in range(n):\n                i = coord_to_idx(r, c)\n                degree = 0\n                # Neighbors\n                # Up\n                if r > 0:\n                    j = coord_to_idx(r - 1, c)\n                    laplacian[i, j] = -1.0\n                    degree += 1\n                # Down\n                if r  m - 1:\n                    j = coord_to_idx(r + 1, c)\n                    laplacian[i, j] = -1.0\n                    degree += 1\n                # Left\n                if c > 0:\n                    j = coord_to_idx(r, c - 1)\n                    laplacian[i, j] = -1.0\n                    degree += 1\n                # Right\n                if c  n - 1:\n                    j = coord_to_idx(r, c + 1)\n                    laplacian[i, j] = -1.0\n                    degree += 1\n                \n                laplacian[i, i] = float(degree)\n\n        laplacian_pinv = np.linalg.pinv(laplacian)\n\n        u_idx = coord_to_idx(u_coords[0], u_coords[1])\n        v_idx = coord_to_idx(v_coords[0], v_coords[1])\n\n        x_e = np.zeros(N, dtype=np.float64)\n        x_e[u_idx] = 1.0\n        x_e[v_idx] = -1.0\n\n        y_e = laplacian_pinv @ x_e\n\n        total_current_sum = 0.0\n        for s in range(N):\n            for t in range(s + 1, N):\n                total_current_sum += np.abs(y_e[s] - y_e[t])\n\n        num_pairs = N * (N - 1) / 2.0\n        c_e = total_current_sum / num_pairs\n        results.append(c_e)\n        \n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}