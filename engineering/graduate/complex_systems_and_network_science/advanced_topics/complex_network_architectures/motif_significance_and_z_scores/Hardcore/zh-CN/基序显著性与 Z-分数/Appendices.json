{
    "hands_on_practices": [
        {
            "introduction": "在判断网络中某种基序是否“显著”之前，我们必须首先建立一个比较的基准。这个练习将指导你从第一性原理出发，为最简单的情况——Erdős–Rényi随机图中的三角形——构建这个基准。通过推导期望的三角形数量，你将掌握零模型概念的理论基础，这是后续所有显著性分析的出发点。",
            "id": "4288789",
            "problem": "在 Erdős–Rényi 随机图模型中，一个包含 $n$ 个已标记顶点的无向简单图 $G(n,p)$ 是通过以概率 $p$ 独立地包含每条可能的无向边而形成的，其中 $0  p  1$。假设 $n \\ge 3$，请求出图中无向三角形数量 $T$ 的期望值 $\\mathbb{E}[T]$ 的闭式表达式。",
            "solution": "所述问题是有效的。它在科学上基于已确立的随机图理论，特别是 Erdős–Rényi 模型 $G(n,p)$。该问题提法恰当、客观，并包含推导所求量（即三角形的期望数量 $\\mathbb{E}[T]$）所需的所有必要信息。推导过程需要概率论和组合数学的基本原理。我现在开始进行解答。\n\n目标是推导随机变量 $T$ 的期望，该变量计算随机图 $G(n,p)$ 中无向三角形的数量。该图有一组 $n$ 个已标记的顶点，我们用 $V = \\{v_1, v_2, \\dots, v_n\\}$ 表示这个集合。任意两个不同顶点之间的无向边以概率 $p$ 存在，且与所有其他边独立。一个三角形是由三个不同顶点（例如 $\\{i, j, k\\}$）组成的集合，使得边 $(i,j)$、$(j,k)$ 和 $(k,i)$ 都存在于图中。约束条件是 $n \\ge 3$ 和 $0  p  1$。\n\n根据问题陈述的要求，推导将基于指示随机变量法和期望的线性性。\n\n首先，我们必须识别图中所有潜在的三角形。一个潜在的三角形由任意 $3$ 个不同顶点的集合定义。从 $n$ 个顶点中选择 $3$ 个不同顶点的方法总数由二项式系数 $\\binom{n}{3}$ 给出。令 $S$ 为 $V$ 中所有这种 $3$-顶点子集的集合。该集合的大小为 $|S| = \\binom{n}{3}$。\n$$\n|S| = \\binom{n}{3} = \\frac{n!}{3!(n-3)!} = \\frac{n(n-1)(n-2)}{6}\n$$\n\n对于每个潜在的三角形 $s \\in S$（其中 $s$ 是三个顶点 $\\{i,j,k\\}$ 的集合），我们定义一个指示随机变量 $T_s$。如果 $s$ 中的顶点构成一个三角形，该变量取值为 $1$，否则取值为 $0$。\n$$\nT_s =\n\\begin{cases}\n1  \\text{如果顶点 } \\{i, j, k\\} \\text{ 构成一个三角形} \\\\\n0  \\text{否则}\n\\end{cases}\n$$\n\n图中三角形的总数 $T$ 是这些指示变量在所有可能的三顶点集合上的总和。\n$$\nT = \\sum_{s \\in S} T_s\n$$\n\n我们的目标是求期望 $\\mathbb{E}[T]$。根据期望的线性性，随机变量之和的期望等于它们各自期望之和。此性质成立，无论这些随机变量是否独立。\n$$\n\\mathbb{E}[T] = \\mathbb{E}\\left[\\sum_{s \\in S} T_s\\right] = \\sum_{s \\in S} \\mathbb{E}[T_s]\n$$\n\n指示随机变量的期望等于它所指示事件的概率。在我们的情况下，$\\mathbb{E}[T_s] = P(T_s=1)$。我们需要计算任意一组三个顶点（例如 $\\{i, j, k\\}$）构成三角形的概率。\n\n要使顶点 $\\{i, j, k\\}$ 构成一个三角形，图中必须存在三条特定的边：$i$ 和 $j$ 之间的边、$j$ 和 $k$ 之间的边以及 $k$ 和 $i$ 之间的边。我们分别将这些事件表示为 $E_{ij}$、$E_{jk}$ 和 $E_{ki}$。事件 $T_s=1$ 是这三个事件的交集：$T_s=1 \\iff E_{ij} \\cap E_{jk} \\cap E_{ki}$。\n\n根据 Erdős–Rényi 模型 $G(n,p)$ 的定义，任何一条边的存在都是一个概率为 $p$ 的独立事件。因此，三条边同时存在的概率是它们各自概率的乘积。\n$$\nP(T_s=1) = P(E_{ij} \\cap E_{jk} \\cap E_{ki})\n$$\n由于独立性，我们有：\n$$\nP(T_s=1) = P(E_{ij}) \\times P(E_{jk}) \\times P(E_{ki})\n$$\n因为任何给定边存在的概率都是 $p$，我们得到：\n$$\nP(T_s=1) = p \\times p \\times p = p^3\n$$\n\n因此，每个指示变量的期望是 $\\mathbb{E}[T_s] = p^3$。对于每个由三个顶点组成的集合 $s \\in S$，这个概率都是相同的。\n\n现在我们可以将这个结果代回到 $\\mathbb{E}[T]$ 的表达式中。这个和是针对所有可能的 $3$-顶点子集，而对于每个子集，其指示变量的期望值都是 $p^3$。\n$$\n\\mathbb{E}[T] = \\sum_{s \\in S} p^3\n$$\n这个和中的项数是这类子集的总数，即 $|S| = \\binom{n}{3}$。因此，这个和就是项数乘以常数值 $p^3$。\n$$\n\\mathbb{E}[T] = |S| \\times p^3 = \\binom{n}{3} p^3\n$$\n\n展开二项式系数，我们得到三角形期望数量的最终闭式表达式。\n$$\n\\mathbb{E}[T] = \\frac{n(n-1)(n-2)}{6} p^3\n$$\n如题目所要求，此推导过程仅使用了 $G(n, p)$ 模型的定义、概率论公理（特别是独立性）、顶点三元组的组合计数以及期望的线性性这一基本性质。",
            "answer": "$$\\boxed{\\binom{n}{3} p^{3}}$$"
        },
        {
            "introduction": "对于保留了度序列等网络属性的更复杂的零模型，解析推导往往难以实现。因此，在实践中，我们通常采用计算方法。这个练习展示了标准的研究流程：使用蒙特卡洛模拟来估计零分布的均值和标准差，然后计算观测计数的Z-score。 这个实践将理论与真实世界数据分析中的计算步骤联系起来。",
            "id": "4288672",
            "problem": "考虑一个包含 $n$ 个节点和 $m$ 条有向边的有向网络，其中前馈环 (FFL) 模体定义为具有有向边 $i \\to j$、$j \\to k$ 和 $i \\to k$ 的三个不同节点的元组 $(i,j,k)$。令 $N_{\\mathrm{FFL}}$ 表示图中 FFL 模体的数量。观测到的网络具有经验 FFL 数量 $N_{\\mathrm{FFL}}^{\\mathrm{obs}} = 37$。为评估模体的显著性，使用一个由有向配对模型 (DCM) 给出的零模型，该模型通过保持度的置换来随机化边，同时保留每个节点的入度和出度。假设通过蒙特卡洛抽样生成了 $M = 10^{4}$ 个独立的零图，这些实现中的 FFL 数量由样本均值 $\\hat{\\mu} = 22.8$ 和无偏样本方差 $\\hat{\\sigma}^{2} = 14.7$ 汇总。\n\n根据基本统计原理，在适当的正则性条件下（例如，弱相关性和有限方差），由于中心极限定理 (CLT)，来自零模型系综的聚合子图计数近似服从正态分布。利用这一原理，将观测到的 FFL 数量相对于零模型进行标准化，以获得一个无量纲的显著性得分。请将您的最终答案表示为根据给定的蒙特卡洛估计值计算出的标准化得分。将您的答案四舍五入到四位有效数字。",
            "solution": "用户希望我解决以下问题：\n考虑一个包含 $n$ 个节点和 $m$ 条有向边的有向网络，其中前馈环 (FFL) 模体定义为具有有向边 $i \\to j$、$j \\to k$ 和 $i \\to k$ 的三个不同节点的元组 $(i,j,k)$。令 $N_{\\mathrm{FFL}}$ 表示图中 FFL 模体的数量。观测到的网络具有经验 FFL 数量 $N_{\\mathrm{FFL}}^{\\mathrm{obs}} = 37$。为评估模体的显著性，使用一个由有向配对模型 (DCM) 给出的零模型，该模型通过保持度的置换来随机化边，同时保留每个节点的入度和出度。假设通过蒙特卡洛抽样生成了 $M = 10^{4}$ 个独立的零图，这些实现中的 FFL 数量由样本均值 $\\hat{\\mu} = 22.8$ 和无偏样本方差 $\\hat{\\sigma}^{2} = 14.7$ 汇总。\n\n根据基本统计原理，在适当的正则性条件下（例如，弱相关性和有限方差），由于中心极限定理 (CLT)，来自零模型系综的聚合子图计数近似服从正态分布。利用这一原理，将观测到的 FFL 数量相对于零模型进行标准化，以获得一个无量纲的显著性得分。请将您的最终答案表示为根据给定的蒙特卡洛估计值计算出的标准化得分。将您的答案四舍五入到四位有效数字。\n\n**问题验证**\n\n步骤 1：提取已知条件。\n- 网络类型：有向网络。\n- 节点数：$n$。\n- 边数：$m$。\n- 模体定义 (FFL)：具有有向边 $i \\to j$、$j \\to k$ 和 $i \\to k$ 的三个不同节点的元组 $(i,j,k)$。\n- 真实网络中观测到的 FFL 数量：$N_{\\mathrm{FFL}}^{\\mathrm{obs}} = 37$。\n- 零模型：有向配对模型 (DCM)。\n- 来自零模型的蒙特卡洛样本数量：$M = 10^{4}$。\n- 来自零模型系综的 FFL 数量样本均值：$\\hat{\\mu} = 22.8$。\n- 来自零模型系综的 FFL 数量无偏样本方差：$\\hat{\\sigma}^{2} = 14.7$。\n- 假设的零模型计数分布：根据中心极限定理 (CLT) 服从正态分布。\n- 任务：计算标准化显著性得分 (Z-score)。\n- 要求精度：将最终答案四舍五入到四位有效数字。\n\n步骤 2：使用提取的已知条件进行验证。\n- 问题是**有科学依据的**。使用零模型（特别是 DCM）、蒙特卡洛抽样和 Z-score 来评估网络模体（如 FFL）的统计显著性是网络科学和复杂系统分析中的标准和基本方法。\n- 问题是**良定的**。计算所需的标准化得分所需的所有定量信息（$N_{\\mathrm{FFL}}^{\\mathrm{obs}}$、$\\hat{\\mu}$、$\\hat{\\sigma}^2$）均已提供。目标陈述清晰。\n- 问题是**客观且完整的**。语言精确，所提供的值充分且不矛盾。提及变量 $n$ 和 $m$ 是为了提供背景，计算中并不需要它们，这不会使问题不完整。\n- 这些值是**现实的**。给定的数量、均值和方差对于一个中等规模的网络是合理的。\n- 问题依赖于标准的统计原理（Z-score，CLT 近似），并且不是病态或琐碎的。\n\n步骤 3：结论与行动。\n该问题被判定为**有效的**。我将继续进行解答。\n\n**解题过程**\n\n目标是计算观测到的前馈环 (FFL) 模体数量的标准化显著性得分，通常称为 Z-score。Z-score 量化了一个观测数据点偏离参考分布均值的标准差倍数。在此背景下，观测值是真实网络中的 FFL 数量，参考分布是由零模型生成的随机图系综中 FFL 数量的分布。\n\nZ-score ($Z$) 由以下公式定义：\n$$\nZ = \\frac{x - \\mu}{\\sigma}\n$$\n其中 $x$ 是观测值，$\\mu$ 是参考分布的均值，$\\sigma$ 是参考分布的标准差。\n\n在这个问题中，各组成部分如下：\n- 观测值是 FFL 的经验数量，$x = N_{\\mathrm{FFL}}^{\\mathrm{obs}}$。\n- 参考分布是来自有向配对模型 (DCM) 零模型的 FFL 数量分布。问题指出，该分布可以很好地用正态分布来近似。\n- 这个正态分布的参数是通过 $M = 10^4$ 次蒙特卡洛抽样的样本来估计的。样本均值 $\\hat{\\mu}$ 用作真实均值 $\\mu$ 的估计值，样本方差 $\\hat{\\sigma}^2$ 的平方根用作真实标准差 $\\sigma$ 的估计值。\n\n给定的值为：\n- 观测数量：$N_{\\mathrm{FFL}}^{\\mathrm{obs}} = 37$。\n- 来自零模型的估计均值：$\\hat{\\mu} = 22.8$。\n- 来自零模型的估计方差：$\\hat{\\sigma}^2 = 14.7$。\n\n首先，我们必须根据给定的估计方差 $\\hat{\\sigma}^2$ 计算估计的标准差 $\\hat{\\sigma}$。\n$$\n\\hat{\\sigma} = \\sqrt{\\hat{\\sigma}^2} = \\sqrt{14.7}\n$$\n\n现在，我们可以将给定的和推导出的值代入 Z-score 公式：\n$$\nZ = \\frac{N_{\\mathrm{FFL}}^{\\mathrm{obs}} - \\hat{\\mu}}{\\hat{\\sigma}}\n$$\n$$\nZ = \\frac{37 - 22.8}{\\sqrt{14.7}}\n$$\n\n我们进行算术计算：\n分子是：\n$$\n37 - 22.8 = 14.2\n$$\n分母是：\n$$\n\\sqrt{14.7} \\approx 3.834057905\n$$\n因此，Z-score 是：\n$$\nZ = \\frac{14.2}{\\sqrt{14.7}} \\approx \\frac{14.2}{3.834057905} \\approx 3.70364090\n$$\n\n问题要求答案四舍五入到四位有效数字。计算出的值为 $3.70364090...$。\n前四位有效数字是 $3$、$7$、$0$ 和 $3$。第五位有效数字是 $6$。由于 $6 \\ge 5$，我们将第四位有效数字 ($3$) 向上舍入为 $4$。\n因此，四舍五入后的 Z-score 是 $3.704$。\n\n这个正的 Z-score 表明，观测到的 FFL 数量比具有相同度序列的随机网络中预期的平均数量高出 $3.704$ 个标准差。如此高的 Z-score（通常 $|Z| > 2$ 或 $3$）表明 FFL 是观测网络中一个统计上显著的模体，意味着它出现的频率远高于在指定零模型下偶然预期的频率。",
            "answer": "$$\n\\boxed{3.704}\n$$"
        },
        {
            "introduction": "计算出的Z-score本身只是一个中间结果，而非最终结论。要做出正式的统计声明，尤其是在同时分析多种基序时，我们需要将其转化为p值，并进行多重检验校正。这个最终的练习将引导你完成从Z-score到p值的转换，并应用Benjamini–Hochberg程序来控制伪发现率（FDR）。 这是任何严谨的基序分析中至关重要的最后一步，确保我们发现的模式具有统计学上的可靠性。",
            "id": "4288664",
            "problem": "考虑一个有向网络，其中三节点模体（motif）的显著性是通过将其观测计数与一个保持入度和出度序列不变的零系综进行比较来评估的。对于由 $i \\in \\{1,2,\\dots,m\\}$ 索引的每种模体类型，令 $C_{i}$ 表示观测计数，$\\mu_{i}$ 和 $\\sigma_{i}$ 分别表示在零系综下该模体计数的均值和标准差。模体的 z-分数 定义为 $z_{i} = (C_{i} - \\mu_{i})/\\sigma_{i}$。在模体 $i$ 在结构上没有过表达或低表达的零假设下，假设 $z_{i}$ 近似服从标准正态随机变量分布，即均值为 $0$、方差为 $1$ 的高斯分布。请仅使用标准正态分布的累积分布函数（CDF）的定义、高斯分布的对称性以及双尾检验的定义，首先推导出一个观测到的 z-分数 $z$ 的双尾 $p$-值的显式表达式，该表达式应以标准正态CDF表示。\n\n然后，对于 $m=10$ 个具有以下观测 z-分数的模体：\n$M_{1}: z=4.00$, $M_{2}: z=3.30$, $M_{3}: z=3.00$, $M_{4}: z=-2.70$, $M_{5}: z=2.58$, $M_{6}: z=2.33$, $M_{7}: z=2.00$, $M_{8}: z=1.50$, $M_{9}: z=1.00$, $M_{10}: z=0.50$，\n使用您推导出的表达式计算它们的双尾 $p$-值。\n\n最后，对这 $m=10$ 个检验应用 Benjamini–Hochberg (BH) 程序，以在 $\\alpha=0.05$ 的水平上控制错误发现率（FDR）。BH 程序的定义如下：将 $m$ 个 $p$-值按升序排序，$p_{(1)} \\leq p_{(2)} \\leq \\dots \\leq p_{(m)}$，并找到满足 $p_{(k)} \\leq \\frac{k}{m}\\alpha$ 的最大索引 $k$；拒绝（宣布为显著的）所有 $p$-值至多为 $p_{(k)}$ 的假设。\n\n在 $\\alpha=0.05$ 水平下，通过 BH-FDR 方法被宣布为显著的模体总数是多少？最终答案必须是一个整数。由于最终答案是无单位的精确计数，因此不需要舍入说明。",
            "solution": "其基础是零模型，在该模型中，模体 $z$-分数 $z$ 近似服从标准正态分布，以及双尾 $p$-值根据该分布的尾部概率的定义。令 $Z$ 为一个标准正态随机变量，其累积分布函数（CDF）为 $\\Phi(z) = \\mathbb{P}(Z \\leq z)$。与观测到的 $z$-分数 $z$ 相关联的双尾 $p$-值定义为，在零假设下，观测到一个在绝对值上至少与 $z$ 一样极端的值的概率：\n$$\np = \\mathbb{P}(|Z| \\geq |z|) = \\mathbb{P}(Z \\leq -|z|) + \\mathbb{P}(Z \\geq |z|).\n$$\n根据标准正态分布的对称性，$\\mathbb{P}(Z \\leq -|z|) = \\mathbb{P}(Z \\geq |z|)$，且 $\\mathbb{P}(Z \\leq -|z|) = \\Phi(-|z|)$。因此，\n$$\np = 2\\,\\Phi(-|z|).\n$$\n此表达式由 CDF 的定义、对所有 $x \\in \\mathbb{R}$ 成立的对称性质 $\\Phi(-x) = 1 - \\Phi(x)$，以及双尾构造共同得出。\n\n我们现在应用此公式计算给定 $z$-分数的双尾 $p$-值。使用正态CDF的标准值（或互补尾部概率），我们得到以下近似的双尾 $p$-值：\n- 对于 $M_{1}$，$z=4.00$：$\\Phi(4.00) \\approx 0.9999683$，所以 $\\Phi(-4.00) \\approx 1 - 0.9999683 = 3.167 \\times 10^{-5}$，因此 $p \\approx 2 \\times 3.167 \\times 10^{-5} = 6.334 \\times 10^{-5}$。\n- 对于 $M_{2}$，$z=3.30$：单尾 $\\mathbb{P}(Z \\geq 3.30) \\approx 4.839 \\times 10^{-4}$，因此 $p \\approx 9.678 \\times 10^{-4}$。\n- 对于 $M_{3}$，$z=3.00$：单尾 $\\mathbb{P}(Z \\geq 3.00) \\approx 1.3499 \\times 10^{-3}$，因此 $p \\approx 2.6998 \\times 10^{-3}$，为清晰起见，我们记为 $0.002700$。\n- 对于 $M_{4}$，$z=-2.70$：根据对称性，双尾 $p$ 值取决于 $|z|=2.70$，其单尾概率约为 $\\approx 0.003467$，所以 $p \\approx 0.006934$。\n- 对于 $M_{5}$，$z=2.58$：单尾概率 $\\approx 0.00495$，所以 $p \\approx 0.00990$。\n- 对于 $M_{6}$，$z=2.33$：单尾概率 $\\approx 0.00990$，所以 $p \\approx 0.0198$。\n- 对于 $M_{7}$，$z=2.00$：单尾概率 $\\approx 0.0228$，所以 $p \\approx 0.0455$。\n- 对于 $M_{8}$，$z=1.50$：单尾概率 $\\approx 0.066807$，所以 $p \\approx 0.1336$。\n- 对于 $M_{9}$，$z=1.00$：单尾概率 $\\approx 0.158655$，所以 $p \\approx 0.3173$。\n- 对于 $M_{10}$，$z=0.50$：单尾概率 $\\approx 0.308537$，所以 $p \\approx 0.6171$。\n\n接下来，我们应用 Benjamini–Hochberg (BH) 程序，对这 $m=10$ 个检验在 $\\alpha=0.05$ 水平上控制错误发现率（FDR）。我们首先将 $p$-值按升序排列：\n$$\np_{(1)} = 6.334 \\times 10^{-5},\\quad\np_{(2)} = 9.678 \\times 10^{-4},\\quad\np_{(3)} = 0.002700,\\quad\np_{(4)} = 0.006934,\\quad\np_{(5)} = 0.00990,\\quad\np_{(6)} = 0.0198,\\quad\np_{(7)} = 0.0455,\\quad\np_{(8)} = 0.1336,\\quad\np_{(9)} = 0.3173,\\quad\np_{(10)} = 0.6171.\n$$\n对于每个秩次 $k \\in \\{1,2,\\dots,10\\}$，BH 临界值为 $\\frac{k}{m}\\alpha = \\frac{k}{10} \\times 0.05$。这些临界值为：\n$$\nk=1:\\ 0.005,\\quad\nk=2:\\ 0.01,\\quad\nk=3:\\ 0.015,\\quad\nk=4:\\ 0.02,\\quad\nk=5:\\ 0.025,\\quad\nk=6:\\ 0.03,\\quad\nk=7:\\ 0.035,\\quad\nk=8:\\ 0.04,\\quad\nk=9:\\ 0.045,\\quad\nk=10:\\ 0.05.\n$$\n我们找到满足 $p_{(k)} \\leq \\frac{k}{m}\\alpha$ 的最大 $k$：\n- $p_{(1)} \\approx 6.334 \\times 10^{-5} \\leq 0.005$ (成立),\n- $p_{(2)} \\approx 9.678 \\times 10^{-4} \\leq 0.01$ (成立),\n- $p_{(3)} \\approx 0.002700 \\leq 0.015$ (成立),\n- $p_{(4)} \\approx 0.006934 \\leq 0.02$ (成立),\n- $p_{(5)} \\approx 0.00990 \\leq 0.025$ (成立),\n- $p_{(6)} \\approx 0.0198 \\leq 0.03$ (成立),\n- $p_{(7)} \\approx 0.0455 \\leq 0.035$ (不成立).\n因此，满足 BH 条件的最大索引是 $k=6$。根据 BH 步升法规则，我们拒绝（宣布为显著的）所有 $p$-值至多为 $p_{(6)}$ 的假设。因此，被宣布为显著的模体总数是 $6$。",
            "answer": "$$\\boxed{6}$$"
        }
    ]
}