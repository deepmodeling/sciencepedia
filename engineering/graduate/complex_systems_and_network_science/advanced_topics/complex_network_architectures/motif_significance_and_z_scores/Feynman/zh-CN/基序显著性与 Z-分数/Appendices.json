{
    "hands_on_practices": [
        {
            "introduction": "要判断一个模式是否异常普遍，我们首先需要知道它在纯粹随机的情况下出现的频率。本练习将引导您推导在经典的 Erdős–Rényi 随机图（一个经典的零模型）中三角形模体的期望数量，从而为后续学习打下理论基础。掌握这一计算过程有助于您从第一性原理层面理解 Z 分数中的期望值 $\\langle N_{rand} \\rangle$ 。",
            "id": "4288789",
            "problem": "在厄多斯-雷尼（Erdős–Rényi）随机图模型中，一个包含 $n$ 个带标签顶点的无向简单图 $G(n,p)$ 是通过以概率 $p$ 独立地包含每条可能的无向边而形成的，其中 $n \\ge 3$ 且 $0  p  1$。请使用期望的线性性，推导出图中三角形数量的期望值 $\\mathbb{E}[T]$。",
            "solution": "目标是推导随机变量 $T$ 的期望，该变量计算随机图 $G(n,p)$ 中无向三角形的数量。该图有一组 $n$ 个带标签的顶点，我们用 $V = \\{v_1, v_2, \\dots, v_n\\}$ 表示这个集合。任意两个不同顶点之间的无向边以概率 $p$ 存在，且与其他所有边独立。一个三角形是一组三个不同的顶点，例如 $\\{i, j, k\\}$，使得边 $(i,j)$、$(j,k)$ 和 $(k,i)$ 都存在于图中。\n\n推导将基于指示随机变量方法和期望的线性性。\n\n首先，我们必须识别图中所有潜在的三角形。一个潜在的三角形由任意一组3个不同的顶点定义。从一个包含 $n$ 个顶点的集合中选择3个不同顶点的方法总数由二项式系数 $\\binom{n}{3}$ 给出。令 $S$ 为 $V$ 中所有此类3顶点子集的集合。该集合的大小为 $|S| = \\binom{n}{3}$。\n$$\n|S| = \\binom{n}{3} = \\frac{n!}{3!(n-3)!} = \\frac{n(n-1)(n-2)}{6}\n$$\n\n对于每个潜在的三角形 $s \\in S$，其中 $s$ 是一组三个顶点 $\\{i,j,k\\}$，我们定义一个指示随机变量 $T_s$。如果 $s$ 中的顶点构成一个三角形，该变量取值为 $1$，否则为 $0$。\n$$\nT_s =\n\\begin{cases}\n1  \\text{如果顶点 } \\{i, j, k\\} \\text{ 构成一个三角形} \\\\\n0  \\text{否则}\n\\end{cases}\n$$\n\n图中三角形的总数 $T$ 是这些指示变量在所有可能的三顶点集合上的总和。\n$$\nT = \\sum_{s \\in S} T_s\n$$\n\n我们的目标是求期望 $\\mathbb{E}[T]$。根据期望的线性性，随机变量之和的期望等于它们各自期望之和。此性质无论随机变量是否独立都成立。\n$$\n\\mathbb{E}[T] = \\mathbb{E}\\left[\\sum_{s \\in S} T_s\\right] = \\sum_{s \\in S} \\mathbb{E}[T_s]\n$$\n\n指示随机变量的期望等于它所指示事件的概率。在我们的例子中，$\\mathbb{E}[T_s] = P(T_s=1)$。我们需要计算任意一组三个顶点，比如 $\\{i, j, k\\}$，构成一个三角形的概率。要使顶点 $\\{i, j, k\\}$ 构成一个三角形，图中必须存在三条特定的边：$(i,j)$、$(j,k)$ 和 $(k,i)$。\n\n根据厄多斯-雷尼模型 $G(n,p)$ 的定义，任何一条边的存在都是一个概率为 $p$ 的独立事件。因此，所有三条边同时存在的概率是它们各自概率的乘积。\n$$\nP(T_s=1) = P(\\text{边 } (i,j) \\text{ 存在}) \\times P(\\text{边 } (j,k) \\text{ 存在}) \\times P(\\text{边 } (k,i) \\text{ 存在})\n$$\n$$\nP(T_s=1) = p \\times p \\times p = p^3\n$$\n\n因此，每个指示变量的期望是 $\\mathbb{E}[T_s] = p^3$。对于 $S$ 中每一组三个顶点，这个概率都是相同的。\n\n现在我们可以将这个结果代回到 $\\mathbb{E}[T]$ 的表达式中。\n$$\n\\mathbb{E}[T] = \\sum_{s \\in S} p^3 = |S| \\times p^3 = \\binom{n}{3} p^3\n$$\n\n展开二项式系数，我们得到三角形期望数的最终闭式表达式。\n$$\n\\mathbb{E}[T] = \\frac{n(n-1)(n-2)}{6} p^3\n$$\n此推导仅使用了 $G(n, p)$ 模型的定义、独立性假设、组合计数以及期望的线性性。",
            "answer": "$$\\boxed{\\binom{n}{3} p^{3}}$$"
        },
        {
            "introduction": "Z 分数是模体显著性分析的主要工具，它为模体的过度或不足表达提供了一个标准化的度量。在这个实践练习中，您将使用来自一个保持度序列不变的零模型的模拟数据，来计算观测到的前馈环 (FFL) 模体数量的 Z 分数。这个问题将锻炼您将原始计数和零模型统计数据转化为有意义的显著性分数的这一核心计算技能 。",
            "id": "4288672",
            "problem": "考虑一个有向网络，其包含 $n$ 个节点和 $m$ 条有向边，其中前馈环 (feed-forward loop, FFL) 模体被定义为一个由不同节点 $(i,j,k)$ 构成的三元组，满足存在有向边 $i \\to j$、$j \\to k$ 和 $i \\to k$。设 $N_{\\mathrm{FFL}}$ 表示图中 FFL 模体的数量。观测到的网络中，FFL 的经验计数为 $N_{\\mathrm{FFL}}^{\\mathrm{obs}} = 37$。为了评估模体的显著性，使用一个由有向配置模型 (Directed Configuration Model, DCM) 给出的零模型，该模型在通过保持度的边交换来随机化边的同时，保持每个节点的入度和出度不变。假设通过蒙特卡洛采样生成了 $M = 10^{4}$ 个独立的零模型图，并且在这些实现中 FFL 的计数可以概括为样本均值 $\\hat{\\mu} = 22.8$ 和无偏样本方差 $\\hat{\\sigma}^{2} = 14.7$。\n\n根据一个基本的统计学原理，即在适当的正则性条件下（例如，弱依赖性和有限方差），由于中心极限定理 (Central Limit Theorem, CLT)，来自零模型系综的聚合子图计数近似服从正态分布。利用这一原理，将观测到的 FFL 计数相对于零模型进行标准化，以获得一个无量纲的显著性得分。将你的最终答案表示为由给定的蒙特卡洛估计值计算出的标准化得分。将答案四舍五入到四位有效数字。",
            "solution": "目标是为观测到的前馈环 (FFL) 模体计数计算标准化的显著性得分，通常称为 Z-score。Z-score 量化了观测数据点与参考分布均值之间相差多少个标准差。在此背景下，观测值是真实网络中的 FFL 计数，参考分布是零模型生成的随机图系综中 FFL 计数的分布。\n\nZ-score ($Z$) 由以下公式定义：\n$$\nZ = \\frac{x - \\mu}{\\sigma}\n$$\n其中 $x$ 是观测值，$\\mu$ 是参考分布的均值，$\\sigma$ 是参考分布的标准差。\n\n在这个问题中，各组成部分如下：\n- 观测值是 FFL 的经验计数，$x = N_{\\mathrm{FFL}}^{\\mathrm{obs}} = 37$。\n- 参考分布是来自有向配置模型 (DCM) 零模型的 FFL 计数分布。问题指出，该分布可以很好地用正态分布来近似。\n- 这个正态分布的参数是通过蒙特卡洛采样估计得出的。样本均值 $\\hat{\\mu} = 22.8$ 作为真实均值 $\\mu$ 的估计值，样本标准差 $\\hat{\\sigma}$（由样本方差 $\\hat{\\sigma}^2$ 计算）作为真实标准差 $\\sigma$ 的估计值。\n\n给定的值为：\n- 观测计数：$N_{\\mathrm{FFL}}^{\\mathrm{obs}} = 37$。\n- 来自零模型的估计均值：$\\hat{\\mu} = 22.8$。\n- 来自零模型的估计方差：$\\hat{\\sigma}^2 = 14.7$。\n\n首先，我们必须根据给定的估计方差 $\\hat{\\sigma}^2$ 计算估计标准差 $\\hat{\\sigma}$。\n$$\n\\hat{\\sigma} = \\sqrt{\\hat{\\sigma}^2} = \\sqrt{14.7}\n$$\n\n现在，我们可以将给定的和推导出的值代入 Z-score 公式：\n$$\nZ = \\frac{N_{\\mathrm{FFL}}^{\\mathrm{obs}} - \\hat{\\mu}}{\\hat{\\sigma}} = \\frac{37 - 22.8}{\\sqrt{14.7}}\n$$\n\n我们进行算术计算：\n$$\nZ = \\frac{14.2}{\\sqrt{14.7}} \\approx \\frac{14.2}{3.8340579} \\approx 3.70364\n$$\n\n问题要求答案四舍五入到四位有效数字。计算值为 $3.70364...$。前四位有效数字是 $3$、$7$、$0$ 和 $3$。第五位有效数字是 $6$。由于 $6 \\ge 5$，我们将第四位有效数字 ($3$) 向上取整为 $4$。\n因此，四舍五入后的 Z-score 是 $3.704$。\n\n这个正 Z-score 表明，观测到的 FFL 计数比具有相同度序列的随机网络中预期的平均计数高出约 $3.704$ 个标准差。如此高的 Z-score (通常 $|Z| > 2$ 或 $3$) 表明 FFL 是观测网络中的一个统计显著的模体。",
            "answer": "$$\n\\boxed{3.704}\n$$"
        },
        {
            "introduction": "在典型的网络研究中，我们常常同时检验多种不同类型模体的显著性，这会增加“假阳性”发现的风险。为了保持统计上的严谨性，我们必须对这种多重比较进行校正。本练习将引导您完成关键的 Benjamini–Hochberg 程序，以控制错误发现率 (FDR)，从而使您能够从一个更大的集合中自信地识别出哪些模体是真正显著的 。",
            "id": "4288664",
            "problem": "考虑一个有向网络，其中三节点模体的显著性是通过将观测到的计数与一个保持入度和出度序列不变的零系综进行比较来评估的。对于由 $i \\in \\{1,2,\\dots,m\\}$ 索引的每种模体类型，令 $C_{i}$ 表示观测计数，并令 $\\mu_{i}$ 和 $\\sigma_{i}$ 分别表示在零系综下模体计数的均值和标准差。模体的 $z$-分数定义为 $z_{i} = (C_{i} - \\mu_{i})/\\sigma_{i}$。在模体 $i$ 在结构上没有过表达或低表达的零假设下，假设 $z_{i}$ 近似服从标准正态随机变量的分布，即均值为0、方差为1的高斯分布。首先，请仅使用标准正态分布的累积分布函数(CDF)的定义、高斯分布的对称性以及双尾检验的定义，推导出一个用标准正态CDF表示的、针对观测到的 $z$-分数 $z$ 的双尾 $p$-值的显式表达式。\n\n然后，对于具有以下观测到的 $z$-分数的 $m=10$ 个模体：\n$M_{1}: z=4.00$, $M_{2}: z=3.30$, $M_{3}: z=3.00$, $M_{4}: z=-2.70$, $M_{5}: z=2.58$, $M_{6}: z=2.33$, $M_{7}: z=2.00$, $M_{8}: z=1.50$, $M_{9}: z=1.00$, $M_{10}: z=0.50$，\n使用你推导的表达式计算它们的双尾 $p$-值。\n\n最后，将用于在 $\\alpha=0.05$ 水平上控制错误发现率(FDR)的 Benjamini–Hochberg (BH) 程序应用于这 $m=10$ 个检验。BH 程序的定义如下：将 $m$ 个 $p$-值按升序排序，$p_{(1)} \\leq p_{(2)} \\leq \\dots \\leq p_{(m)}$，并找到满足 $p_{(k)} \\leq \\frac{k}{m}\\alpha$ 的最大索引 $k$；拒绝（宣布为显著的）所有 $p$-值不大于 $p_{(k)}$ 的假设。\n\n在 $\\alpha=0.05$ 水平下，通过 BH-FDR 方法宣布为显著的模体总数是多少？最终答案必须是一个整数。由于最终答案是一个没有单位的精确计数，因此不需要舍入说明。",
            "solution": "首先，我们推导双尾 $p$-值的表达式。令 $Z$ 为一个标准正态随机变量，其累积分布函数(CDF)为 $\\Phi(z) = \\mathbb{P}(Z \\leq z)$。对于一个观测到的 $z$-分数 $z_{obs}$，其双尾 $p$-值是在零假设下观测到至少同样极端结果的概率：\n$$ p = \\mathbb{P}(|Z| \\geq |z_{obs}|) = \\mathbb{P}(Z \\geq |z_{obs}|) + \\mathbb{P}(Z \\leq -|z_{obs}|) $$\n由于标准正态分布的对称性，$\\mathbb{P}(Z \\leq -|z_{obs}|) = \\mathbb{P}(Z \\geq |z_{obs}|)$。因此，p值可以计算为：\n$$ p = 2 \\times \\mathbb{P}(Z \\geq |z_{obs}|) = 2 \\times (1 - \\Phi(|z_{obs}|)) $$\n\n接下来，我们应用此公式计算给定 $z$-分数的双尾 $p$-值。\n*   $M_{1}\\ (z=4.00): p \\approx 6.334 \\times 10^{-5}$\n*   $M_{2}\\ (z=3.30): p \\approx 9.678 \\times 10^{-4}$\n*   $M_{3}\\ (z=3.00): p \\approx 0.002700$\n*   $M_{4}\\ (z=-2.70): p \\approx 0.006934$\n*   $M_{5}\\ (z=2.58): p \\approx 0.00990$\n*   $M_{6}\\ (z=2.33): p \\approx 0.0198$\n*   $M_{7}\\ (z=2.00): p \\approx 0.0455$\n*   $M_{8}\\ (z=1.50): p \\approx 0.1336$\n*   $M_{9}\\ (z=1.00): p \\approx 0.3173$\n*   $M_{10}\\ (z=0.50): p \\approx 0.6171$\n\n最后，我们将 Benjamini–Hochberg (BH) 程序应用于这 $m=10$ 个检验，以在 $\\alpha=0.05$ 水平上控制错误发现率(FDR)。我们首先将 $p$-值按升序排序：\n$$\np_{(1)} = 6.334 \\times 10^{-5}\\ \\ (M_1) \\\\\np_{(2)} = 9.678 \\times 10^{-4}\\ \\ (M_2) \\\\\np_{(3)} = 0.002700\\ \\ (M_3) \\\\\np_{(4)} = 0.006934\\ \\ (M_4) \\\\\np_{(5)} = 0.00990\\ \\ (M_5) \\\\\np_{(6)} = 0.0198\\ \\ (M_6) \\\\\np_{(7)} = 0.0455\\ \\ (M_7) \\\\\np_{(8)} = 0.1336\\ \\ (M_8) \\\\\np_{(9)} = 0.3173\\ \\ (M_9) \\\\\np_{(10)} = 0.6171\\ \\ (M_{10})\n$$\n对于每个排序 $k \\in \\{1,2,\\dots,10\\}$，BH 临界值为 $\\frac{k}{m}\\alpha = \\frac{k}{10} \\times 0.05$。我们找到满足 $p_{(k)} \\leq \\frac{k}{m}\\alpha$ 的最大 $k$：\n- $k=1: p_{(1)} \\approx 6.33 \\times 10^{-5} \\leq 0.005$ (成立)\n- $k=2: p_{(2)} \\approx 9.68 \\times 10^{-4} \\leq 0.010$ (成立)\n- $k=3: p_{(3)} \\approx 0.00270 \\leq 0.015$ (成立)\n- $k=4: p_{(4)} \\approx 0.00693 \\leq 0.020$ (成立)\n- $k=5: p_{(5)} \\approx 0.00990 \\leq 0.025$ (成立)\n- $k=6: p_{(6)} \\approx 0.0198 \\leq 0.030$ (成立)\n- $k=7: p_{(7)} \\approx 0.0455 \\not\\leq 0.035$ (不成立)\n\n满足 BH 条件的最大索引是 $k=6$。根据 BH 程序，我们拒绝（宣布为显著的）所有 $p$-值不大于 $p_{(k)}$ 的假设，即从 $p_{(1)}$ 到 $p_{(6)}$。因此，被宣布为显著的模体总数是 $6$。",
            "answer": "$$\\boxed{6}$$"
        }
    ]
}