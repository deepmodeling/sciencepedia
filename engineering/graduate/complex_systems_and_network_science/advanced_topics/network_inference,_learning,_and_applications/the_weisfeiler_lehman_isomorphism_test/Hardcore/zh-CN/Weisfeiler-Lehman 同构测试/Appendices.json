{
    "hands_on_practices": [
        {
            "introduction": "掌握 Weisfeiler-Lehman (WL) 测试的第一步是理解其核心机制——颜色细化算法，以及认识到它的局限性。此练习  将引导您在一个经典案例上运行 1-WL 测试，该案例涉及两个具有相同顶点数和度数分布但拓扑结构不同的图。通过亲手计算，您将揭示为什么 1-WL 测试有时无法区分非同构的正则图，这对于理解该测试的表达能力边界至关重要。",
            "id": "4311865",
            "problem": "考虑两个简单无向图 $G$ 和 $H$，它们定义在共同的顶点集 $\\{1,2,3,4,5,6\\}$ 上，其边集指定如下：\n- 图 $G$：两个不相交的三角形，其边集为 $E(G) = \\{(1,2),(2,3),(3,1),(4,5),(5,6),(6,4)\\}$。\n- 图 $H$：一个 $6$-环，其边集为 $E(H) = \\{(1,2),(2,3),(3,4),(4,5),(5,6),(6,1)\\}$。\n\n使用 $1$ 维 Weisfeiler-Lehman (WL) 颜色细化算法，从所有顶点具有统一的初始颜色开始，通过基于每个顶点的当前颜色及其邻域中颜色的多重集对顶点进行重新着色，来进行迭代细化，直到着色稳定（即不再发生细化）。对于每个图，计算其稳定着色和颜色直方图（每种颜色的顶点数量）。通过比较它们的稳定颜色直方图，判断 $1$-WL 是否能证明 $G$ 和 $H$ 是非同构的。\n\n将您的最终决定表示为单个数字：如果 $1$-WL 证明了非同构性（即稳定颜色直方图不同），则写 $1$；如果 $1$-WL 未能证明非同构性（即稳定颜色直方图相同），则写 $0$。无需四舍五入。答案没有单位。",
            "solution": "该问题要求将 $1$ 维 Weisfeiler-Lehman ($1$-WL) 颜色细化算法应用于两个图 $G$ 和 $H$，以确定该算法是否能区分它们。这两个图定义在共同的顶点集 $V = \\{1,2,3,4,5,6\\}$ 上。\n图 $G$ 由边集 $E(G) = \\{(1,2),(2,3),(3,1),(4,5),(5,6),(6,4)\\}$ 指定，对应于两个不相交的三角形。\n图 $H$ 由边集 $E(H) = \\{(1,2),(2,3),(3,4),(4,5),(5,6),(6,1)\\}$ 指定，对应于一个 $6$-环。\n\n$1$-WL 算法的操作如下：\n1.  **初始化**：所有顶点都被赋予相同的初始颜色。\n2.  **迭代**：在每一步中，每个顶点根据其邻居当前颜色的多重集被赋予一个新的颜色。具体来说，当且仅当两个顶点在上一步中颜色相同且其邻居颜色的多重集也相同时，它们才会获得相同的新颜色。\n3.  **终止**：当顶点到颜色类的划分在两次迭代之间不再变化时，算法停止。这个最终的划分就是稳定着色。\n\n如果两个图的稳定颜色直方图（每个最终颜色的顶点数量）不同，则 $1$-WL 测试可证明它们是非同构的。\n\n让我们将该算法应用于这两个图。\n\n**对图G的分析（两个不相交的三角形）**\n- **迭代 0**：\n所有 $6$ 个顶点都被赋予一个统一的初始颜色，我们称之为 $c_0$。\n着色为 $C_0(G) = \\{v \\mapsto c_0 \\text{ for all } v \\in V\\}$。\n颜色直方图为 $\\{c_0: 6\\}$。\n\n- **迭代 1**：\n我们需要计算每个顶点的新颜色。新颜色由签名 $(c_{prev}(v), M_{prev}(v))$ 决定，其中 $c_{prev}(v)$ 是顶点 $v$ 的前一个颜色，$M_{prev}(v)$ 是其邻居的前一个颜色的多重集。\n$G$ 的两个子图（两个三角形）都是 $2$-正则的，意味着每个顶点的度都为 $2$。\n我们来分析一个任意顶点，例如顶点 $v=1$。它的邻居是 $\\{2,3\\}$。\n在迭代 0 中，顶点 $1$ 的颜色是 $c_0$。它的邻居顶点 $2$ 和 $3$ 的颜色也是 $c_0$。\n因此，顶点 $1$ 的签名为 $(c_0, \\{c_0, c_0\\})$。\n由于 $G$ 中的每个顶点的度都为 $2$，且所有顶点初始颜色都为 $c_0$，所以 $G$ 中每个顶点的签名都是相同的：$(c_0, \\{c_0, c_0\\})$。\n因为所有顶点都有相同的签名，所以在这次迭代中它们都被赋予了相同的新颜色。我们将这个新颜色称为 $c_1$。\n现在的着色是 $C_1(G) = \\{v \\mapsto c_1 \\text{ for all } v \\in V\\}$。\n颜色直方图为 $\\{c_1: 6\\}$。\n\n- **稳定**：\n迭代 0 时顶点的划分是一个包含 $6$ 个顶点的类：$\\{\\{1,2,3,4,5,6\\}\\}$。\n迭代 1 时顶点的划分也是一个包含 $6$ 个顶点的类：$\\{\\{1,2,3,4,5,6\\}\\}$。\n由于顶点的划分没有被细化，算法已经稳定。\n$G$ 的最终颜色直方图是一个包含所有 $6$ 个顶点的颜色类。\n\n**对图H的分析（一个6-环）**\n- **迭代 0**：\n与 $G$ 类似， $H$ 的所有 $6$ 个顶点都被赋予初始颜色 $c_0$。\n着色为 $C_0(H) = \\{v \\mapsto c_0 \\text{ for all } v \\in V\\}$。\n颜色直方图为 $\\{c_0: 6\\}$。\n\n- **迭代 1**：\n图 $H$ 是一个 $6$-环，它也是一个 $2$-正则图。每个顶点的度都为 $2$。\n我们来分析一个任意顶点，比如 $v=1$。它的邻居是 $\\{2,6\\}$。\n在迭代 0 中，顶点 $1$ 的颜色是 $c_0$。它的邻居顶点 $2$ 和 $6$ 的颜色也是 $c_0$。\n顶点 $1$ 的签名为 $(c_0, \\{c_0, c_0\\})$。\n与图 $G$ 一样， $H$ 中的每个顶点的度都为 $2$，且所有顶点开始时都具有相同的颜色 $c_0$。因此， $H$ 中每个顶点的签名也是 $(c_0, \\{c_0, c_0\\})$。\n由于 $H$ 中的所有顶点都有相同的签名，它们都被赋予了相同的新颜色。因为它们的签名与 $G$ 中顶点的签名相同，所以它们被赋予了同样的新颜色 $c_1$。\n着色为 $C_1(H) = \\{v \\mapsto c_1 \\text{ for all } v \\in V\\}$。\n颜色直方图为 $\\{c_1: 6\\}$。\n\n- **稳定**：\n与图 $G$ 一样，从迭代 0 到迭代 1，顶点的划分没有改变。算法已经稳定。\n$H$ 的最终颜色直方图是一个包含所有 $6$ 个顶点的颜色类。\n\n**结论**\n图 $G$ 的稳定颜色直方图包含一个有 $6$ 个顶点的颜色类。\n图 $H$ 的稳定颜色直方图也包含一个有 $6$ 个顶点的颜色类。\n两个直方图是相同的。\n\n因此，$1$ 维 Weisfeiler-Lehman 算法不能区分图 $G$ 和图 $H$。它未能证明它们是非同构的。题目要求如果证明了非同构则输出 $1$，否则输出 $0$。由于测试无定论，正确的输出是 $0$。",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "在认识到基础 1-WL 测试对某些正则结构的局限性后，我们来探讨如何通过引入节点属性来增强其分辨能力。在现实世界的网络中，节点通常携带丰富的特征信息，这些信息可以作为颜色细化过程的初始输入。本练习  将演示在同一个基础图结构上，不同的初始属性（颜色）分布如何引导 WL 算法收敛到完全不同的稳定划分，这直接关联到图神经网络（GNNs）等现代方法如何利用节点特征来学习图表示。",
            "id": "4311891",
            "problem": "考虑两个属性网络$G_A$和$G_B$，它们基于同一个基础简单无向图，即具有$6$个顶点的循环图，记为$C_6$，其顶点集为$\\{v_1,v_2,v_3,v_4,v_5,v_6\\}$，边集为$\\{(v_1,v_2), (v_2,v_3), (v_3,v_4), (v_4,v_5), (v_5,v_6), (v_6,v_1)\\}$。每个顶点携带一个来自$\\{X,Y\\}$的属性。这两个网络的唯一区别在于属性的分布：\n- 在$G_A$中：$v_1$的属性为$X$，$v_2$的属性为$X$，而$v_3,v_4,v_5,v_6$的属性为$Y$。\n- 在$G_B$中：$v_1,v_3,v_5$的属性为$X$，而$v_2,v_4,v_6$的属性为$Y$。\n\n我们对这两个网络应用$1$维Weisfeiler-Lehman (WL)同构测试（也称为颜色细化），将属性视为初始颜色。Weisfeiler-Lehman (WL)同构测试的流程如下。在迭代 $t=0$ 时，通过映射$X \\mapsto 0$和$Y \\mapsto 1$来分配初始颜色。在随后的每次迭代 $t \\geq 1$ 中，每个顶点$v$会收到一个更新后的颜色，该颜色由其前一次迭代（$t-1$）的颜色以及其邻居颜色的多重集共同决定：构成元组\n$$\n\\Theta_t(v) \\equiv \\Big(c_{t-1}(v), \\operatorname{sort}\\big(\\{\\!\\{c_{t-1}(u): u \\in N(v)\\}\\!\\}\\big)\\Big),\n$$\n其中$c_{t-1}(v)$是顶点$v$在迭代$t-1$时的颜色，$N(v)$是$v$的邻居集合，而$\\operatorname{sort}(\\cdot)$则生成该多重集的按非递减顺序排序的列表表示。然后，将所有顶点的不同元组$\\Theta_t(v)$按字典序（首先按$c_{t-1}(v)$排序，然后按排序后的邻居列表进行字典序排序）进行枚举，并按此顺序为这些元组类型分配新颜色$1,2,3,\\dots$。重复此过程，直到颜色的多重集稳定（即，颜色类的划分在进一步细化下不再改变）。\n\n对于每个网络$G_A$和$G_B$，运行上述过程直至达到稳定划分。对于每个稳定划分，计算归一化颜色类分布$p = (p_1,p_2,\\dots,p_k)$，其中$p_i$是颜色类$i$中顶点的比例，并计算该分布的香农熵（使用自然对数），\n$$\nH(p) = -\\sum_{i=1}^{k} p_i \\ln(p_i).\n$$\n最后，计算熵差$H\\!\\left(p^{(A)}\\right) - H\\!\\left(p^{(B)}\\right)$，其中$p^{(A)}$和$p^{(B)}$分别是$G_A$和$G_B$的稳定颜色分布。将您的最终答案表示为包含$\\ln(\\cdot)$的单一闭式解析表达式。无需四舍五入。",
            "solution": "该问题要求将一维Weisfeiler-Lehman (WL)算法应用于两个属性图$G_A$和$G_B$，然后计算其稳定颜色分布的香non熵。最终结果是这两个熵的差值。两个网络的基础图都是具有$6$个顶点$V = \\{v_1, v_2, v_3, v_4, v_5, v_6\\}$的循环图$C_6$。每个顶点有两个邻居。\n\n首先，我们分析网络$G_A$。\n\n**$G_A$的分析**\n\n$G_A$的初始属性为：\n- $v_1, v_2$ 的属性为 $X$。\n- $v_3, v_4, v_5, v_6$ 的属性为 $Y$。\n\n**迭代 $t=0$：**\n我们按照规定将属性映射为初始颜色：$X \\mapsto 0$ 和 $Y \\mapsto 1$。\n顶点 $(v_1, v_2, v_3, v_4, v_5, v_6)$ 的初始颜色向量 $c_0$ 是：\n$c_0(v_1)=0, c_0(v_2)=0, c_0(v_3)=1, c_0(v_4)=1, c_0(v_5)=1, c_0(v_6)=1$。\n初始颜色的多重集为 $\\{\\!\\{0, 0, 1, 1, 1, 1\\}\\!\\}$。\n\n**迭代 $t=1$：**\n我们为每个顶点计算更新元组 $\\Theta_1(v) = (c_0(v), \\operatorname{sort}(\\{\\!\\{c_0(u) : u \\in N(v)\\}\\!\\}\\big))$。\n- $N(v_1)=\\{v_2, v_6\\}$。邻居颜色：$\\{c_0(v_2), c_0(v_6)\\} = \\{0, 1\\}$。$\\Theta_1(v_1) = (0, (0,1))$。\n- $N(v_2)=\\{v_1, v_3\\}$。邻居颜色：$\\{c_0(v_1), c_0(v_3)\\} = \\{0, 1\\}$。$\\Theta_1(v_2) = (0, (0,1))$。\n- $N(v_3)=\\{v_2, v_4\\}$。邻居颜色：$\\{c_0(v_2), c_0(v_4)\\} = \\{0, 1\\}$。$\\Theta_1(v_3) = (1, (0,1))$。\n- $N(v_4)=\\{v_3, v_5\\}$。邻居颜色：$\\{c_0(v_3), c_0(v_5)\\} = \\{1, 1\\}$。$\\Theta_1(v_4) = (1, (1,1))$。\n- $N(v_5)=\\{v_4, v_6\\}$。邻居颜色：$\\{c_0(v_4), c_0(v_6)\\} = \\{1, 1\\}$。$\\Theta_1(v_5) = (1, (1,1))$。\n- $N(v_6)=\\{v_5, v_1\\}$。邻居颜色：$\\{c_0(v_5), c_0(v_1)\\} = \\{1, 0\\}$。$\\Theta_1(v_6) = (1, (0,1))$。\n\n按字典序排列的不同元组是：\n$1$. $(0, (0,1))$ (来自 $v_1, v_2$)\n$2$. $(1, (0,1))$ (来自 $v_3, v_6$)\n$3$. $(1, (1,1))$ (来自 $v_4, v_5$)\n\n分配新颜色 $1, 2, 3, \\dots$：\n- $c_1(v_1) = 1, c_1(v_2) = 1$。\n- $c_1(v_3) = 2, c_1(v_6) = 2$。\n- $c_1(v_4) = 3, c_1(v_5) = 3$。\n颜色的多重集为 $\\{\\!\\{1, 1, 2, 2, 3, 3\\}\\!\\}$。\n\n**迭代 $t=2$：**\n我们计算 $\\Theta_2(v) = (c_1(v), \\operatorname{sort}(\\{\\!\\{c_1(u) : u \\in N(v)\\}\\!\\}\\big))$。\n- $N(v_1)=\\{v_2, v_6\\}$。邻居颜色：$\\{c_1(v_2), c_1(v_6)\\} = \\{1, 2\\}$。$\\Theta_2(v_1) = (1, (1,2))$。\n- $N(v_2)=\\{v_1, v_3\\}$。邻居颜色：$\\{c_1(v_1), c_1(v_3)\\} = \\{1, 2\\}$。$\\Theta_2(v_2) = (1, (1,2))$。\n- $N(v_3)=\\{v_2, v_4\\}$。邻居颜色：$\\{c_1(v_2), c_1(v_4)\\} = \\{1, 3\\}$。$\\Theta_2(v_3) = (2, (1,3))$。\n- $N(v_4)=\\{v_3, v_5\\}$。邻居颜色：$\\{c_1(v_3), c_1(v_5)\\} = \\{2, 3\\}$。$\\Theta_2(v_4) = (3, (2,3))$。\n- $N(v_5)=\\{v_4, v_6\\}$。邻居颜色：$\\{c_1(v_4), c_1(v_6)\\} = \\{3, 2\\}$。$\\Theta_2(v_5) = (3, (2,3))$。\n- $N(v_6)=\\{v_5, v_1\\}$。邻居颜色：$\\{c_1(v_5), c_1(v_1)\\} = \\{3, 1\\}$。$\\Theta_2(v_6) = (2, (1,3))$。\n\n按字典序排列的不同元组是：\n$1$. $(1, (1,2))$ (来自 $v_1, v_2$)\n$2$. $(2, (1,3))$ (来自 $v_3, v_6$)\n$3$. $(3, (2,3))$ (来自 $v_4, v_5$)\n\n分配新颜色 $c_2$：\n- $c_2(v_1) = 1, c_2(v_2) = 1$。\n- $c_2(v_3) = 2, c_2(v_6) = 2$。\n- $c_2(v_4) = 3, c_2(v_5) = 3$。\n新的颜色多重集是 $\\{\\!\\{1, 1, 2, 2, 3, 3\\}\\!\\}$，与迭代 $t=1$ 的多重集相同。划分已稳定。\n\n$G_A$ 的稳定划分有 $3$ 个颜色类，每个类的大小为 $2$：$\\{v_1, v_2\\}$、$\\{v_3, v_6\\}$ 和 $\\{v_4, v_5\\}$。\n归一化颜色类分布为 $p^{(A)} = (\\frac{2}{6}, \\frac{2}{6}, \\frac{2}{6}) = (\\frac{1}{3}, \\frac{1}{3}, \\frac{1}{3})$。\n香non熵为：\n$$H(p^{(A)}) = -\\sum_{i=1}^{3} p_i \\ln(p_i) = -\\left(\\frac{1}{3}\\ln\\left(\\frac{1}{3}\\right) + \\frac{1}{3}\\ln\\left(\\frac{1}{3}\\right) + \\frac{1}{3}\\ln\\left(\\frac{1}{3}\\right)\\right)$$\n$$H(p^{(A)}) = -3 \\cdot \\frac{1}{3}\\ln\\left(\\frac{1}{3}\\right) = -\\ln\\left(\\frac{1}{3}\\right) = \\ln(3)$$\n\n接下来，我们分析网络 $G_B$。\n\n**$G_B$的分析**\n\n$G_B$的初始属性为：\n- $v_1, v_3, v_5$ 的属性为 $X$。\n- $v_2, v_4, v_6$ 的属性为 $Y$。\n\n**迭代 $t=0$：**\n顶点 $(v_1, v_2, v_3, v_4, v_5, v_6)$ 的初始颜色向量 $c_0$ 是：\n$c_0(v_1)=0, c_0(v_2)=1, c_0(v_3)=0, c_0(v_4)=1, c_0(v_5)=0, c_0(v_6)=1$。\n初始颜色的多重集为 $\\{\\!\\{0, 0, 0, 1, 1, 1\\}\\!\\}$。\n\n**迭代 $t=1$：**\n- $v_1 (0)$：$N(v_1)=\\{v_2(1), v_6(1)\\}$。$\\Theta_1(v_1) = (0, (1,1))$。\n- $v_2 (1)$：$N(v_2)=\\{v_1(0), v_3(0)\\}$。$\\Theta_1(v_2) = (1, (0,0))$。\n- $v_3 (0)$：$N(v_3)=\\{v_2(1), v_4(1)\\}$。$\\Theta_1(v_3) = (0, (1,1))$。\n- $v_4 (1)$：$N(v_4)=\\{v_3(0), v_5(0)\\}$。$\\Theta_1(v_4) = (1, (0,0))$。\n- $v_5 (0)$：$N(v_5)=\\{v_4(1), v_6(1)\\}$。$\\Theta_1(v_5) = (0, (1,1))$。\n- $v_6 (1)$：$N(v_6)=\\{v_5(0), v_1(0)\\}$。$\\Theta_1(v_6) = (1, (0,0))$。\n\n按字典序排列的不同元组是：\n$1$. $(0, (1,1))$ (来自 $v_1, v_3, v_5$)\n$2$. $(1, (0,0))$ (来自 $v_2, v_4, v_6$)\n\n分配新颜色 $1, 2, \\dots$：\n- $c_1(v_1) = 1, c_1(v_3) = 1, c_1(v_5) = 1$。\n- $c_1(v_2) = 2, c_1(v_4) = 2, c_1(v_6) = 2$。\n颜色的多重集为 $\\{\\!\\{1, 1, 1, 2, 2, 2\\}\\!\\}$。\n\n**迭代 $t=2$：**\n- $v_1 (1)$：$N(v_1)=\\{v_2(2), v_6(2)\\}$。$\\Theta_2(v_1) = (1, (2,2))$。\n- $v_2 (2)$：$N(v_2)=\\{v_1(1), v_3(1)\\}$。$\\Theta_2(v_2) = (2, (1,1))$。\n- 所有颜色为$1$的顶点其邻居颜色都为$2$，所有颜色为$2$的顶点其邻居颜色都为$1$。\n- 不同的元组是 $(1, (2,2))$ 和 $(2, (1,1))$。\n按字典序，$(1, (2,2))$在$(2, (1,1))$之前。\n分配新颜色 $c_2$：\n- $c_2(v_1) = 1, c_2(v_3) = 1, c_2(v_5) = 1$。\n- $c_2(v_2) = 2, c_2(v_4) = 2, c_2(v_6) = 2$。\n新的颜色多重集是 $\\{\\!\\{1, 1, 1, 2, 2, 2\\}\\!\\}$，与迭代 $t=1$ 的多重集相同。划分已稳定。\n\n$G_B$ 的稳定划分有 $2$ 个颜色类，每个类的大小为 $3$：$\\{v_1, v_3, v_5\\}$ 和 $\\{v_2, v_4, v_6\\}$。\n归一化颜色类分布为 $p^{(B)} = (\\frac{3}{6}, \\frac{3}{6}) = (\\frac{1}{2}, \\frac{1}{2})$。\n香non熵为：\n$$H(p^{(B)}) = -\\sum_{i=1}^{2} p_i \\ln(p_i) = -\\left(\\frac{1}{2}\\ln\\left(\\frac{1}{2}\\right) + \\frac{1}{2}\\ln\\left(\\frac{1}{2}\\right)\\right)$$\n$$H(p^{(B)}) = -2 \\cdot \\frac{1}{2}\\ln\\left(\\frac{1}{2}\\right) = -\\ln\\left(\\frac{1}{2}\\right) = \\ln(2)$$\n\n**最终计算**\n\n问题要求计算熵差 $H(p^{(A)}) - H(p^{(B)})$。\n$$H(p^{(A)}) - H(p^{(B)}) = \\ln(3) - \\ln(2)$$\n使用对数的性质，这也可以写成 $\\ln(\\frac{3}{2})$。\n问题要求一个单一的闭式解析表达式。$\\ln(3) - \\ln(2)$ 满足这个要求。",
            "answer": "$$\\boxed{\\ln(3) - \\ln(2)}$$"
        },
        {
            "introduction": "除了利用节点属性，提升 WL 测试表达能力的另一种核心思路是扩展其维度。1-WL 测试通过迭代更新节点颜色来捕捉局部邻域结构，而更高维的 k-WL 测试则通过更新 k-元组（如节点对、节点三元组等）的颜色来感知更复杂的子结构。此练习  旨在通过一个精巧的例子，展示 2-WL 测试如何成功区分一对 1-WL 测试无法分辨的图，让您直观地理解更高维度的 WL 测试如何通过检测是否存在特定的小型子结构（如三角形）来获得更强的图区分能力。",
            "id": "4311895",
            "problem": "考虑以下简单、无向、无标签图族。对于整数 $n \\geq 2$，设 $G_n$ 是 $n$ 个长度为 $3$ 的圈（即 $n$ 个 $C_3$ 的副本）的不交并，设 $H_n$ 是长度为 $3n$ 的单个圈（即 $C_{3n}$）。这两个图都有 $3n$ 个顶点，并且都是 2-正则的。\n\nWeisfeiler-Lehman (WL) 测试是一种用于图同构的组合精化过程。1维WL测试（颜色精化）根据每个顶点邻居颜色的多重集来迭代地精化顶点着色。2维WL测试根据所有 $w \\in V$ 上的颜色对 $\\big(\\chi_2(u,w),\\chi_2(w,v)\\big)$ 的多重集来精化有序顶点对 $(u,v)$ 的着色。\n\n仅使用WL方法论的核心定义和经过充分检验的事实，按如下步骤进行：\n\n1. 从基本原理出发，论证为何1维WL测试对 $G_n$ 和 $H_n$ 产生相同的稳定顶点颜色划分，因此无法区分 $G_n$ 和 $H_n$。\n2. 对于应用于有序对 $(u,v)$ 的2维WL测试，采用标准初始化，其中顶点对根据相等和邻接状态进行着色，即：$u=v$；$u \\neq v$ 且 $\\{u,v\\} \\in E$；以及 $u \\neq v$ 且 $\\{u,v\\} \\notin E$。然后定义精化更新映射，将 $(u,v)$ 的当前颜色与多重集 $\\{\\!\\{ \\big(\\chi_2(u,w),\\chi_2(w,v)\\big) : w \\in V \\}\\!\\}$ 一起映射到一个新颜色。\n3. 证明在2维WL测试的一步精化之后，由于 $G_n$ 中存在三角形而 $H_n$ 中不存在，$G_n$ 和 $H_n$ 在分配给有序邻接对 $(u,v)$ 的颜色上有所不同。\n4. 设 $\\Delta(n)$ 表示在第一次精化步骤后，$G_n$ 中由端点恰好有一个公共邻居的有序邻接对 $(u,v)$ 组成的唯一2-WL颜色类的大小与 $H_n$ 中相应颜色类的大小之差。\n\n以 $n$ 的闭式表达式计算 $\\Delta(n)$。提供精确表达式；无需四舍五入，也不使用单位。",
            "solution": "**1维WL测试的失败**\n\n1维Weisfeiler-Lehman（$1$-WL）测试，也称为颜色精化算法，其工作原理如下。最初，图中所有顶点都被赋予相同的颜色，我们称之为颜色 $c^{(0)}$。因此，对于任何顶点 $v$，其初始颜色为 $\\chi_0(v) = c^{(0)}$。这对图 $G_n$ 和 $H_n$ 都成立。\n\n在随后的每一步 $k+1$ 中，顶点 $v$ 的颜色根据其邻居在第 $k$ 步的颜色多重集进行更新。具体来说，新颜色 $\\chi_{k+1}(v)$ 是对 $(\\chi_k(v), M_v^k)$ 的一个函数，其中 $M_v^k = \\{\\!\\{ \\chi_k(u) : \\{v, u\\} \\in E \\}\\!\\}$ 是 $v$ 的邻居的颜色多重集。\n\n让我们将此应用于 $G_n$ 和 $H_n$。问题陈述， $G_n$ 和 $H_n$ 都是2-正则图。这意味着两个图中的每个顶点都恰好有两个邻居。在第一次迭代（$k=0$）时，对于 $G_n$ 或 $H_n$ 中的任何顶点 $v$，其度为 $2$。在初始着色 $\\chi_0$ 下，它的两个邻居都具有颜色 $c^{(0)}$。因此，任何顶点 $v$ 的邻居颜色多重集为 $M_v^0 = \\{\\!\\{ c^{(0)}, c^{(0)} \\}\\!\\}}$。新颜色 $\\chi_1(v)$ 由对 $(\\chi_0(v), M_v^0) = (c^{(0)}, \\{\\!\\{ c^{(0)}, c^{(0)} \\}\\!\\}]$ 决定。由于这个对对于 $G_n$ 和 $H_n$ 中的每个顶点都是相同的，因此两个图中的所有顶点都将被赋予相同的新颜色，例如 $c^{(1)}$。\n\n着色已经稳定。$G_n$ 和 $H_n$ 的最终划分都只包含一个集合，其中含有所有 $3n$ 个顶点。$G_n$ 的颜色直方图是（$3n$ 个颜色为 $c^{(1)}$ 的顶点），$H_n$ 的颜色直方图也是（$3n$ 个颜色为 $c^{(1)}$ 的顶点）。由于直方图相同，1-WL测试无法区分 $G_n$ 和 $H_n$。\n\n**使用2维WL测试进行区分并计算 $\\Delta(n)$**\n\n2维WL测试作用于有序顶点对 $(u,v)$。\n\n**初始化：**\n初始着色 $\\chi_2^0$ 根据问题的规定将顶点对划分为三个类别：\n1.  颜色 $c_{id}$：对于 $u=v$ 的顶点对 $(u,v)$。\n2.  颜色 $c_{adj}$：对于 $\\{u,v\\} \\in E$ 的顶点对 $(u,v)$。\n3.  颜色 $c_{non-adj}$：对于 $u \\neq v$ 且 $\\{u,v\\} \\notin E$ 的顶点对 $(u,v)$。\n\n**第一次精化步骤：**\n新颜色 $\\chi_2^1(u,v)$ 由对 $(\\chi_2^0(u,v), M_{u,v}^0)$ 决定，其中 $M_{u,v}^0$ 是颜色对的多重集 $\\{\\!\\{ (\\chi_2^0(u,w), \\chi_2^0(w,v)) : w \\in V \\}\\!\\}`。我们关心的是有序邻接对 $(u,v)$，因此它们的初始颜色是 $\\chi_2^0(u,v) = c_{adj}$。新颜色将由多重集 $M_{u,v}^0$ 决定。让我们分析顶点 $w$ 对这个多重集的贡献。\n- 如果 $w=u$，颜色对是 $(\\chi_2^0(u,u), \\chi_2^0(u,v)) = (c_{id}, c_{adj})$。\n- 如果 $w=v$，颜色对是 $(\\chi_2^0(u,v), \\chi_2^0(v,v)) = (c_{adj}, c_{id})$。\n- 如果 $w$ 是 $u$ 和 $v$ 的一个公共邻居（即 $\\{u,w\\} \\in E$ 且 $\\{v,w\\} \\in E$），颜色对是 $(\\chi_2^0(u,w), \\chi_2^0(w,v)) = (c_{adj}, c_{adj})$。多重集中此类对的数量等于 $u$ 和 $v$ 的公共邻居的数量。\n- $w$ 的其他情况涉及 $c_{non-adj}$。\n\n$G_n$ 和 $H_n$ 之间的关键区别在于邻接对 $(u,v)$ 的公共邻居数量。\n\n**对 $G_n$ 的分析：**\n图 $G_n$ 是 $n$ 个三角形（$C_3$）的不交并。设 $(u,v)$ 是一个有序邻接对。这两个顶点属于一个特定的 $C_3$。这个三角形的第三个顶点同时是 $u$ 和 $v$ 的邻居。因此，$G_n$ 中的任何邻接对 $(u,v)$ 都有且仅有一个公共邻居。因为 $G_n$ 的所有顶点都位于三角形中，所以没有公共邻居为零的邻接对。对于 $G_n$ 中的任何邻接对 $(u,v)$，其路径颜色对的多重集将恰好包含一个 $(c_{adj}, c_{adj})$。\n\n**对 $H_n$ 的分析：**\n图 $H_n$ 是一个单圈 $C_{3n}$。问题陈述 $n \\geq 2$，所以圈的长度为 $3n \\geq 6$。$C_{3n}$ 的围长（最短圈的长度）是 $3n$。三角形是长度为 $3$ 的圈。由于 $3n \\geq 6$，$H_n$ 不包含三角形。如果一个邻接对 $(u,v)$ 有一个公共邻居 $w$，那么顶点 $\\{u,v,w\\}$ 将形成一个三角形。由于 $H_n$ 没有三角形，因此 $H_n$ 中没有邻接对 $(u,v)$ 有任何公共邻居。对于 $H_n$ 中的任何邻接对 $(u,v)$，其路径颜色对的多重集将包含零个 $(c_{adj}, c_{adj})$。\n\n**关于可区分性的结论：**\n由于 $G_n$ 和 $H_n$ 中邻接对的精化多重集不同，$G_n$ 中的邻接对都将被赋予一个新颜色，比如 $c_{A}$，而 $H_n$ 中的邻接对都将被赋予另一个不同的新颜色，比如 $c_{B}$。最终的点对颜色直方图将不同，因此 $2$-WL 测试在一步之后就能区分 $G_n$ 和 $H_n$。\n\n**$\\Delta(n)$ 的计算：**\n问题要求计算 $\\Delta(n)$，即 $G_n$ 和 $H_n$ 之间特定颜色类的大小之差。该类被定义为包含“端点恰好有一个公共邻居的有序邻接对 $(u,v)$”。\n\n首先，让我们计算 $G_n$ 中这类对的集合的大小。在 $G_n$ 中，如前所述，每个邻接对都恰好有一个公共邻居。我们需要计算有序邻接对的总数。$G_n$ 由 $n$ 个不相交的 $C_3$ 副本组成。每个 $C_3$ 有 $3$ 条边。对于每条边 $\\{u,v\\}$，存在两个有序邻接对：$(u,v)$ 和 $(v,u)$。所以，每个 $C_3$ 贡献 $3 \\times 2 = 6$ 个这样的对。对于 $n$ 个这样的分量， $G_n$ 中有序邻接对的总数为 $6n$。所有这 $6n$ 个对都属于指定的类别。经过一步精化后，它们将形成一个大小为 $6n$ 的单一颜色类。\n\n接下来，我们计算 $H_n$ 中相应对集的大小。在 $H_n$ 中，如前所述，没有邻接对有公共邻居，因为该图是无三角形的（对于 $n \\geq 2$）。因此，在 $H_n$ 中，“端点恰好有一个公共邻居的有序邻接对 $(u,v)$” 的数量为 $0$。$H_n$ 中相应颜色类的大小为 $0$。\n\n最后，我们计算 $\\Delta(n)$，即这两个大小之差：\n$$ \\Delta(n) = (\\text{在 } G_n \\text{中颜色类的大小}) - (\\text{在 } H_n \\text{中颜色类的大小}) $$\n$$ \\Delta(n) = 6n - 0 $$\n$$ \\Delta(n) = 6n $$",
            "answer": "$$\n\\boxed{6n}\n$$"
        }
    ]
}