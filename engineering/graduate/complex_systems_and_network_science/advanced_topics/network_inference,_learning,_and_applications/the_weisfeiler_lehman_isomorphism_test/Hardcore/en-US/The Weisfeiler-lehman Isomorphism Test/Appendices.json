{
    "hands_on_practices": [
        {
            "introduction": "The Weisfeiler-Lehman (WL) test is, at its core, a color refinement algorithm that provides a powerful heuristic for determining graph isomorphism. This first exercise  provides a foundational, hands-on computation of the 1-dimensional WL test. By applying the algorithm to two simple, non-isomorphic regular graphs, you will not only practice the iterative refinement process but also uncover one of its classic limitations, gaining a crucial understanding of the test's expressive power and its boundaries.",
            "id": "4311865",
            "problem": "Consider two simple, undirected graphs $G$ and $H$ on the common vertex set $\\{1,2,3,4,5,6\\}$, specified by their edge sets:\n- Graph $G$: two disjoint triangles, with $E(G) = \\{(1,2),(2,3),(3,1),(4,5),(5,6),(6,4)\\}$.\n- Graph $H$: a single $6$-cycle, with $E(H) = \\{(1,2),(2,3),(3,4),(4,5),(5,6),(6,1)\\}$.\n\nUsing the $1$-dimensional Weisfeiler-Lehman (WL) color refinement algorithm, start from a uniform initial color for all vertices and perform iterative refinement by recoloring each vertex based on its current color and the multiset of colors in its neighborhood, until the coloring stabilizes (i.e., no further refinement occurs). For each graph, compute the stabilized coloring and its color histogram (the counts of vertices of each color). Decide whether $1$-WL certifies that $G$ and $H$ are non-isomorphic by comparing their stabilized color histograms.\n\nExpress your final decision as a single number: write $1$ if $1$-WL certifies non-isomorphism (i.e., the stabilized color histograms differ), and write $0$ if $1$-WL does not certify non-isomorphism (i.e., the stabilized color histograms are identical). No rounding is needed. The answer is unitless.",
            "solution": "The problem requires the application of the $1$-dimensional Weisfeiler-Lehman ($1$-WL) color refinement algorithm to two graphs, $G$ and $H$, to determine if the algorithm can distinguish them. The two graphs are defined on the common vertex set $V = \\{1,2,3,4,5,6\\}$.\nGraph $G$ is specified by the edge set $E(G) = \\{(1,2),(2,3),(3,1),(4,5),(5,6),(6,4)\\}$, which corresponds to two disjoint triangles.\nGraph $H$ is specified by the edge set $E(H) = \\{(1,2),(2,3),(3,4),(4,5),(5,6),(6,1)\\}$, which corresponds to a single cycle of length $6$.\n\nThe $1$-WL algorithm operates as follows:\n1.  **Initialization**: All vertices are assigned the same initial color.\n2.  **Iteration**: In each step, every vertex is assigned a new color based on the multiset of its neighbors' current colors. Specifically, two vertices receive the same new color if and only if they had the same color in the previous step and the multisets of their neighbors' colors were identical.\n3.  **Termination**: The algorithm stops when the partition of vertices into color classes no longer changes between iterations. This final partition is the stabilized coloring.\n\nTwo graphs are certified as non-isomorphic by the $1$-WL test if their stabilized color histograms (the counts of vertices for each final color) are different.\n\nLet's apply the algorithm to both graphs.\n\n**Analysis for Graph G (Two disjoint triangles)**\n- **Iteration 0**:\nAll $6$ vertices are assigned an initial uniform color, let's call it $c_0$.\nThe coloring is $C_0(G) = \\{v \\mapsto c_0 \\text{ for all } v \\in V\\}$.\nThe color histogram is $\\{c_0: 6\\}$.\n\n- **Iteration 1**:\nWe need to compute the new color for each vertex. The new color is determined by the signature $(c_{prev}(v), M_{prev}(v))$, where $c_{prev}(v)$ is the previous color of vertex $v$ and $M_{prev}(v)$ is the multiset of its neighbors' previous colors.\nBoth subgraphs of $G$ (the two triangles) are $2$-regular, meaning every vertex has a degree of $2$.\nLet's analyze an arbitrary vertex, for instance, vertex $v=1$. Its neighbors are $\\{2,3\\}$.\nAt iteration $0$, the color of vertex $1$ is $c_0$. The colors of its neighbors, vertices $2$ and $3$, are also $c_0$.\nSo, the signature for vertex $1$ is $(c_0, \\{\\!\\{c_0, c_0\\}\\!\\})$.\nSince every vertex in $G$ has degree $2$ and all vertices have the same initial color $c_0$, the signature for every single vertex in $G$ is identical: $(c_0, \\{\\!\\{c_0, c_0\\}\\!\\})$.\nBecause all vertices have the same signature, they are all assigned the same new color in this iteration. Let's call this new color $c_1$.\nThe coloring is now $C_1(G) = \\{v \\mapsto c_1 \\text{ for all } v \\in V\\}$.\nThe color histogram is $\\{c_1: 6\\}$.\n\n- **Stabilization**:\nThe partition of vertices at iteration $0$ was one class of $6$ vertices: $\\{\\{1,2,3,4,5,6\\}\\}$.\nThe partition of vertices at iteration $1$ is also one class of $6$ vertices: $\\{\\{1,2,3,4,5,6\\}\\}$.\nSince the partition of vertices has not been refined, the algorithm has stabilized.\nThe final color histogram for $G$ is one color class containing all $6$ vertices.\n\n**Analysis for Graph H (A 6-cycle)**\n- **Iteration 0**:\nSimilar to $G$, all $6$ vertices of $H$ are assigned the initial color $c_0$.\nThe coloring is $C_0(H) = \\{v \\mapsto c_0 \\text{ for all } v \\in V\\}$.\nThe color histogram is $\\{c_0: 6\\}$.\n\n- **Iteration 1**:\nGraph $H$ is a $6$-cycle, which is also a $2$-regular graph. Every vertex has a degree of $2$.\nLet's analyze an arbitrary vertex, say $v=1$. Its neighbors are $\\{2,6\\}$.\nAt iteration $0$, the color of vertex $1$ is $c_0$. The colors of its neighbors, vertices $2$ and $6$, are also $c_0$.\nThe signature for vertex $1$ is $(c_0, \\{\\!\\{c_0, c_0\\}\\!\\})$.\nAs with graph $G$, every vertex in $H$ has degree $2$, and all vertices start with the same color $c_0$. Thus, the signature for every vertex in $H$ is also $(c_0, \\{\\!\\{c_0, c_0\\}\\!\\})$.\nSince all vertices in $H$ have the same signature, they are all assigned the same new color. Because their signature is identical to that of the vertices in $G$, they are assigned the same new color $c_1$.\nThe coloring is $C_1(H) = \\{v \\mapsto c_1 \\text{ for all } v \\in V\\}$.\nThe color histogram is $\\{c_1: 6\\}$.\n\n- **Stabilization**:\nLike with graph $G$, the partition of vertices has not changed from iteration $0$ to iteration $1$. The algorithm has stabilized.\nThe final color histogram for $H$ is one color class containing all $6$ vertices.\n\n**Conclusion**\nThe stabilized color histogram for graph $G$ consists of one color class with $6$ vertices.\nThe stabilized color histogram for graph $H$ also consists of one color class with $6$ vertices.\nThe two histograms are identical.\n\nTherefore, the $1$-dimensional Weisfeiler-Lehman algorithm does not distinguish between graph $G$ and graph $H$. It fails to certify that they are non-isomorphic. The problem asks for the output to be $1$ if non-isomorphism is certified and $0$ otherwise. Since the test is inconclusive, the correct output is $0$.",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "Building on the fundamentals of color refinement, we now explore a scenario more aligned with real-world applications where nodes possess attributes or features. In this context, the WL algorithm uses these attributes as the initial coloring. This practice  is essential for understanding the deep connection between the WL test and the expressive power of modern Graph Neural Networks (GNNs), as it demonstrates how the interplay between initial node features and local topology leads to powerful and discriminative node representations.",
            "id": "4311891",
            "problem": "Consider two attributed networks $G_{A}$ and $G_{B}$ on the same underlying simple undirected graph, the cycle graph with $6$ vertices, denoted $C_{6}$, whose vertex set is $\\{v_{1},v_{2},v_{3},v_{4},v_{5},v_{6}\\}$ and whose edge set is $\\{(v_{1},v_{2}),(v_{2},v_{3}),(v_{3},v_{4}),(v_{4},v_{5}),(v_{5},v_{6}),(v_{6},v_{1})\\}$. Each vertex carries an attribute from $\\{X,Y\\}$. The networks differ only in the distribution of attributes:\n- In $G_{A}$: $v_{1}$ has attribute $X$, $v_{2}$ has attribute $X$, and $v_{3},v_{4},v_{5},v_{6}$ have attribute $Y$.\n- In $G_{B}$: $v_{1},v_{3},v_{5}$ have attribute $X$, and $v_{2},v_{4},v_{6}$ have attribute $Y$.\n\nWe apply the $1$-dimensional Weisfeiler-Lehman (WL) isomorphism test (also called color refinement) to both networks, treating attributes as initial colors. The Weisfeiler-Lehman (WL) isomorphism test proceeds as follows. At iteration $t=0$, assign initial colors by mapping $X \\mapsto 0$ and $Y \\mapsto 1$. At each subsequent iteration $t \\geq 1$, each vertex $v$ receives an updated color determined by its previous color and the multiset of colors of its neighbors at iteration $t-1$: form the tuple\n$$\n\\Theta_{t}(v) \\equiv \\Big(c_{t-1}(v), \\operatorname{sort}\\big(\\{\\!\\{c_{t-1}(u): u \\in N(v)\\}\\!\\}\\big)\\Big),\n$$\nwhere $c_{t-1}(v)$ is the color of $v$ at iteration $t-1$, $N(v)$ is the set of neighbors of $v$, and $\\operatorname{sort}(\\cdot)$ produces the sorted list representation of the multiset in nondecreasing order. Then enumerate the distinct tuples $\\Theta_{t}(v)$ over all vertices in lexicographic order (first by $c_{t-1}(v)$ and then lexicographically by the sorted neighbor list) and assign new colors $1,2,3,\\dots$ to these tuple types in that order. Repeat until the multiset of colors stabilizes (i.e., the partition into color classes does not change under further refinement).\n\nFor each network $G_{A}$ and $G_{B}$, run the above procedure until it reaches a stable partition. For each stable partition, compute the normalized color class distribution $p = (p_{1},p_{2},\\dots,p_{k})$ where $p_{i}$ is the fraction of vertices in color class $i$, and compute the Shannon entropy (using the natural logarithm) of the distribution,\n$$\nH(p) = -\\sum_{i=1}^{k} p_{i} \\ln(p_{i}).\n$$\nFinally, compute the entropy difference $H\\!\\left(p^{(A)}\\right) - H\\!\\left(p^{(B)}\\right)$, where $p^{(A)}$ and $p^{(B)}$ are the stable color distributions for $G_{A}$ and $G_{B}$, respectively. Express your final answer as a single closed-form analytical expression involving $\\ln(\\cdot)$. No rounding is required.",
            "solution": "The problem requires the application of the $1$-dimensional Weisfeiler-Lehman (WL) algorithm to two attributed graphs, $G_A$ and $G_B$, followed by the calculation of the Shannon entropy of their stable color distributions. The final result is the difference between these two entropies. The underlying graph for both networks is the cycle graph $C_6$ on $6$ vertices, $V = \\{v_1, v_2, v_3, v_4, v_5, v_6\\}$. Each vertex has two neighbors.\n\nFirst, we analyze the network $G_A$.\n\n**Analysis of $G_A$**\n\nThe initial attributes for $G_A$ are:\n- $v_1, v_2$ have attribute $X$.\n- $v_3, v_4, v_5, v_6$ have attribute $Y$.\n\n**Iteration $t=0$:**\nWe map the attributes to initial colors as specified: $X \\mapsto 0$ and $Y \\mapsto 1$.\nThe initial color vector $c_0$ for vertices $(v_1, v_2, v_3, v_4, v_5, v_6)$ is:\n$c_0(v_1)=0, c_0(v_2)=0, c_0(v_3)=1, c_0(v_4)=1, c_0(v_5)=1, c_0(v_6)=1$.\nThe multiset of initial colors is $\\{\\!\\{0, 0, 1, 1, 1, 1\\}\\!\\}$.\n\n**Iteration $t=1$:**\nWe compute the update tuple $\\Theta_1(v) = (c_0(v), \\operatorname{sort}(\\{\\!\\{c_0(u) : u \\in N(v)\\}\\!\\}\\big))$ for each vertex.\n- $N(v_1)=\\{v_2, v_6\\}$. Neighbor colors: $\\{c_0(v_2), c_0(v_6)\\} = \\{0, 1\\}$. $\\Theta_1(v_1) = (0, (0,1))$.\n- $N(v_2)=\\{v_1, v_3\\}$. Neighbor colors: $\\{c_0(v_1), c_0(v_3)\\} = \\{0, 1\\}$. $\\Theta_1(v_2) = (0, (0,1))$.\n- $N(v_3)=\\{v_2, v_4\\}$. Neighbor colors: $\\{c_0(v_2), c_0(v_4)\\} = \\{0, 1\\}$. $\\Theta_1(v_3) = (1, (0,1))$.\n- $N(v_4)=\\{v_3, v_5\\}$. Neighbor colors: $\\{c_0(v_3), c_0(v_5)\\} = \\{1, 1\\}$. $\\Theta_1(v_4) = (1, (1,1))$.\n- $N(v_5)=\\{v_4, v_6\\}$. Neighbor colors: $\\{c_0(v_4), c_0(v_6)\\} = \\{1, 1\\}$. $\\Theta_1(v_5) = (1, (1,1))$.\n- $N(v_6)=\\{v_5, v_1\\}$. Neighbor colors: $\\{c_0(v_5), c_0(v_1)\\} = \\{1, 0\\}$. $\\Theta_1(v_6) = (1, (0,1))$.\n\nThe distinct tuples, ordered lexicographically, are:\n$1$. $(0, (0,1))$ (from $v_1, v_2$)\n$2$. $(1, (0,1))$ (from $v_3, v_6$)\n$3$. $(1, (1,1))$ (from $v_4, v_5$)\n\nAssigning new colors $1, 2, 3, \\dots$:\n- $c_1(v_1) = 1, c_1(v_2) = 1$.\n- $c_1(v_3) = 2, c_1(v_6) = 2$.\n- $c_1(v_4) = 3, c_1(v_5) = 3$.\nThe multiset of colors is $\\{\\!\\{1, 1, 2, 2, 3, 3\\}\\!\\}$.\n\n**Iteration $t=2$:**\nWe compute $\\Theta_2(v) = (c_1(v), \\operatorname{sort}(\\{\\!\\{c_1(u) : u \\in N(v)\\}\\!\\}\\big))$.\n- $N(v_1)=\\{v_2, v_6\\}$. Neighbor colors: $\\{c_1(v_2), c_1(v_6)\\} = \\{1, 2\\}$. $\\Theta_2(v_1) = (1, (1,2))$.\n- $N(v_2)=\\{v_1, v_3\\}$. Neighbor colors: $\\{c_1(v_1), c_1(v_3)\\} = \\{1, 2\\}$. $\\Theta_2(v_2) = (1, (1,2))$.\n- $N(v_3)=\\{v_2, v_4\\}$. Neighbor colors: $\\{c_1(v_2), c_1(v_4)\\} = \\{1, 3\\}$. $\\Theta_2(v_3) = (2, (1,3))$.\n- $N(v_4)=\\{v_3, v_5\\}$. Neighbor colors: $\\{c_1(v_3), c_1(v_5)\\} = \\{2, 3\\}$. $\\Theta_2(v_4) = (3, (2,3))$.\n- $N(v_5)=\\{v_4, v_6\\}$. Neighbor colors: $\\{c_1(v_4), c_1(v_6)\\} = \\{3, 2\\}$. $\\Theta_2(v_5) = (3, (2,3))$.\n- $N(v_6)=\\{v_5, v_1\\}$. Neighbor colors: $\\{c_1(v_5), c_1(v_1)\\} = \\{3, 1\\}$. $\\Theta_2(v_6) = (2, (1,3))$.\n\nThe distinct tuples, ordered lexicographically, are:\n$1$. $(1, (1,2))$ (from $v_1, v_2$)\n$2$. $(2, (1,3))$ (from $v_3, v_6$)\n$3$. $(3, (2,3))$ (from $v_4, v_5$)\n\nAssigning new colors $c_2$:\n- $c_2(v_1) = 1, c_2(v_2) = 1$.\n- $c_2(v_3) = 2, c_2(v_6) = 2$.\n- $c_2(v_4) = 3, c_2(v_5) = 3$.\nThe new multiset of colors is $\\{\\!\\{1, 1, 2, 2, 3, 3\\}\\!\\}$, which is identical to the multiset from iteration $t=1$. The partition has stabilized.\n\nThe stable partition for $G_A$ has $3$ color classes, each of size $2$: $\\{v_1, v_2\\}$, $\\{v_3, v_6\\}$, and $\\{v_4, v_5\\}$.\nThe normalized color class distribution is $p^{(A)} = (\\frac{2}{6}, \\frac{2}{6}, \\frac{2}{6}) = (\\frac{1}{3}, \\frac{1}{3}, \\frac{1}{3})$.\nThe Shannon entropy is:\n$$H(p^{(A)}) = -\\sum_{i=1}^{3} p_i \\ln(p_i) = -\\left(\\frac{1}{3}\\ln\\left(\\frac{1}{3}\\right) + \\frac{1}{3}\\ln\\left(\\frac{1}{3}\\right) + \\frac{1}{3}\\ln\\left(\\frac{1}{3}\\right)\\right)$$\n$$H(p^{(A)}) = -3 \\cdot \\frac{1}{3}\\ln\\left(\\frac{1}{3}\\right) = -\\ln\\left(\\frac{1}{3}\\right) = \\ln(3)$$\n\nNext, we analyze the network $G_B$.\n\n**Analysis of $G_B$**\n\nThe initial attributes for $G_B$ are:\n- $v_1, v_3, v_5$ have attribute $X$.\n- $v_2, v_4, v_6$ have attribute $Y$.\n\n**Iteration $t=0$:**\nThe initial color vector $c_0$ for vertices $(v_1, v_2, v_3, v_4, v_5, v_6)$ is:\n$c_0(v_1)=0, c_0(v_2)=1, c_0(v_3)=0, c_0(v_4)=1, c_0(v_5)=0, c_0(v_6)=1$.\nThe multiset of initial colors is $\\{\\!\\{0, 0, 0, 1, 1, 1\\}\\!\\}$.\n\n**Iteration $t=1$:**\n- $v_1 (0)$: $N(v_1)=\\{v_2(1), v_6(1)\\}$. $\\Theta_1(v_1) = (0, (1,1))$.\n- $v_2 (1)$: $N(v_2)=\\{v_1(0), v_3(0)\\}$. $\\Theta_1(v_2) = (1, (0,0))$.\n- $v_3 (0)$: $N(v_3)=\\{v_2(1), v_4(1)\\}$. $\\Theta_1(v_3) = (0, (1,1))$.\n- $v_4 (1)$: $N(v_4)=\\{v_3(0), v_5(0)\\}$. $\\Theta_1(v_4) = (1, (0,0))$.\n- $v_5 (0)$: $N(v_5)=\\{v_4(1), v_6(1)\\}$. $\\Theta_1(v_5) = (0, (1,1))$.\n- $v_6 (1)$: $N(v_6)=\\{v_5(0), v_1(0)\\}$. $\\Theta_1(v_6) = (1, (0,0))$.\n\nThe distinct tuples, ordered lexicographically, are:\n$1$. $(0, (1,1))$ (from $v_1, v_3, v_5$)\n$2$. $(1, (0,0))$ (from $v_2, v_4, v_6$)\n\nAssigning new colors $1, 2, \\dots$:\n- $c_1(v_1) = 1, c_1(v_3) = 1, c_1(v_5) = 1$.\n- $c_1(v_2) = 2, c_1(v_4) = 2, c_1(v_6) = 2$.\nThe multiset of colors is $\\{\\!\\{1, 1, 1, 2, 2, 2\\}\\!\\}$.\n\n**Iteration $t=2$:**\n- $v_1 (1)$: $N(v_1)=\\{v_2(2), v_6(2)\\}$. $\\Theta_2(v_1) = (1, (2,2))$.\n- $v_2 (2)$: $N(v_2)=\\{v_1(1), v_3(1)\\}$. $\\Theta_2(v_2) = (2, (1,1))$.\n- All vertices with color $1$ have neighbors with color $2$, and all vertices with color $2$ have neighbors with color $1$.\nThe distinct tuples are $(1, (2,2))$ and $(2, (1,1))$.\nLexicographically, $(1, (2,2))$ comes before $(2, (1,1))$.\nAssigning new colors $c_2$:\n- $c_2(v_1) = 1, c_2(v_3) = 1, c_2(v_5) = 1$.\n- $c_2(v_2) = 2, c_2(v_4) = 2, c_2(v_6) = 2$.\nThe new multiset of colors is $\\{\\!\\{1, 1, 1, 2, 2, 2\\}\\!\\}$, which is identical to the multiset from iteration $t=1$. The partition has stabilized.\n\nThe stable partition for $G_B$ has $2$ color classes, each of size $3$: $\\{v_1, v_3, v_5\\}$ and $\\{v_2, v_4, v_6\\}$.\nThe normalized color class distribution is $p^{(B)} = (\\frac{3}{6}, \\frac{3}{6}) = (\\frac{1}{2}, \\frac{1}{2})$.\nThe Shannon entropy is:\n$$H(p^{(B)}) = -\\sum_{i=1}^{2} p_i \\ln(p_i) = -\\left(\\frac{1}{2}\\ln\\left(\\frac{1}{2}\\right) + \\frac{1}{2}\\ln\\left(\\frac{1}{2}\\right)\\right)$$\n$$H(p^{(B)}) = -2 \\cdot \\frac{1}{2}\\ln\\left(\\frac{1}{2}\\right) = -\\ln\\left(\\frac{1}{2}\\right) = \\ln(2)$$\n\n**Final Calculation**\n\nThe problem asks for the entropy difference $H(p^{(A)}) - H(p^{(B)})$.\n$$H(p^{(A)}) - H(p^{(B)}) = \\ln(3) - \\ln(2)$$\nUsing the property of logarithms, this can also be written as $\\ln(\\frac{3}{2})$.\nThe question requires a single closed-form analytical expression. $\\ln(3) - \\ln(2)$ fulfills this requirement.",
            "answer": "$$\\boxed{\\ln(3) - \\ln(2)}$$"
        },
        {
            "introduction": "We have seen that the 1-WL test fails to distinguish certain non-isomorphic regular graphs. This naturally leads to the question: how can we design a more powerful test? This exercise  introduces the concept of the WL hierarchy by moving to the 2-dimensional WL test, which operates on pairs of vertices instead of individual ones. By working through this example, you will see how the 2-WL test can identify substructures like triangles that are invisible to the 1-WL test, providing a concrete illustration of increased expressive power and clarifying the theoretical limits of standard GNNs.",
            "id": "4311895",
            "problem": "Consider the following family of simple, undirected, unlabeled graphs. For an integer $n \\geq 2$, let $G_n$ be the disjoint union of $n$ cycles of length $3$ (i.e., $n$ copies of $C_3$), and let $H_n$ be the single cycle of length $3n$ (i.e., $C_{3n}$). Both graphs have $3n$ vertices and are $2$-regular.\n\nThe Weisfeiler-Lehman (WL) test is a combinatorial refinement procedure for graph isomorphism. The $1$-dimensional WL test (color refinement) iteratively refines a vertex coloring based on the multiset of colors of each vertexâ€™s neighbors. The $2$-dimensional WL test refines a coloring of ordered vertex pairs $(u,v)$ based on the multiset of color pairs $\\big(\\chi_2(u,w),\\chi_2(w,v)\\big)$ over all $w \\in V$.\n\nUsing only core definitions and well-tested facts about the WL methodology, proceed as follows:\n\n1. Argue from first principles why the $1$-dimensional WL test yields the same stable vertex color partition for $G_n$ and $H_n$, hence fails to distinguish $G_n$ and $H_n$.\n2. For the $2$-dimensional WL test applied to ordered pairs $(u,v)$, adopt the standard initialization in which pairs are colored based on equality and adjacency status, namely: $u=v$; $u \\neq v$ with $\\{u,v\\} \\in E$; and $u \\neq v$ with $\\{u,v\\} \\notin E$. Then define the refinement update mapping the current color of $(u,v)$ together with the multiset $\\{\\!\\{ \\big(\\chi_2(u,w),\\chi_2(w,v)\\big) : w \\in V \\}\\!\\}$ to a new color.\n3. Show that after one refinement step of the $2$-dimensional WL test, $G_n$ and $H_n$ differ in the color assigned to ordered adjacent pairs $(u,v)$ due to the presence of triangles in $G_n$ and their absence in $H_n$.\n4. Let $\\Delta(n)$ denote the difference between the size of the unique $2$-WL color class in $G_n$ that consists of ordered adjacent pairs $(u,v)$ whose endpoints have exactly one common neighbor and the size of the corresponding color class in $H_n$ after the first refinement step.\n\nCompute $\\Delta(n)$ as a closed-form expression in terms of $n$. Provide the exact expression; no rounding is required, and no units are to be used.",
            "solution": "First, we argue why the $1$-dimensional WL test fails. Both $G_n$ (a disjoint union of $n$ triangles) and $H_n$ (a cycle of length $3n$) are $2$-regular graphs. The $1$-WL test starts by assigning a uniform color, $c^{(0)}$, to all vertices. In the first refinement step, the new color for any vertex $v$ is determined by the multiset of its neighbors' colors. Since every vertex in both graphs has exactly two neighbors, and all neighbors have color $c^{(0)}$, the signature for every vertex in both $G_n$ and $H_n$ is identical: $(c^{(0)}, \\{\\!\\{c^{(0)}, c^{(0)}\\!\\})$. Thus, all vertices in both graphs receive the same new color, $c^{(1)}$. The color partition does not refine and the algorithm stabilizes immediately. Both graphs yield a final color histogram with a single color class of size $3n$. Therefore, the $1$-WL test fails to distinguish them.\n\nNext, we analyze the $2$-dimensional WL test. This test colors ordered pairs of vertices $(u,v)$. The initial coloring $\\chi_2^0$ uses three colors: $c_\\text{id}$ for pairs where $u=v$, $c_\\text{adj}$ for adjacent pairs $(\\{u,v\\} \\in E)$, and $c_\\text{non-adj}$ for non-adjacent pairs. The refinement step updates the color of a pair $(u,v)$ based on its current color and the multiset of color pairs $\\{\\!\\{ (\\chi_2^0(u,w), \\chi_2^0(w,v)) : w \\in V \\}\\!\\}$.\n\nWe focus on the refinement of adjacent pairs $(u,v)$, which initially have color $c_\\text{adj}$. The key to distinguishing $G_n$ and $H_n$ lies in the number of common neighbors for an adjacent pair, as this affects the refinement multiset.\n- If $w$ is a common neighbor of $u$ and $v$, it contributes a pair $(\\chi_2^0(u,w), \\chi_2^0(w,v)) = (c_\\text{adj}, c_\\text{adj})$ to the multiset.\n\nIn graph $G_n$, any adjacent pair $(u,v)$ belongs to a 3-cycle (a triangle). The third vertex of this triangle is a common neighbor to both $u$ and $v$. Thus, for any adjacent pair in $G_n$, there is exactly one common neighbor. The refinement multiset for these pairs will contain exactly one instance of $(c_\\text{adj}, c_\\text{adj})$.\n\nIn graph $H_n$, which is a cycle $C_{3n}$ with $n \\geq 2$ (so length $\\geq 6$), there are no triangles. An adjacent pair $(u,v)$ having a common neighbor $w$ would imply that $\\{u,v,w\\}$ forms a triangle, which is impossible in $H_n$. Therefore, no adjacent pair in $H_n$ has a common neighbor. The refinement multiset for these pairs will contain zero instances of $(c_\\text{adj}, c_\\text{adj})$.\n\nSince the refinement multisets for adjacent pairs in $G_n$ and $H_n$ are different, they will be assigned different colors after one refinement step, proving that the $2$-WL test can distinguish the graphs.\n\nFinally, we compute $\\Delta(n)$, the difference in the size of the color class for \"ordered adjacent pairs $(u,v)$ whose endpoints have exactly one common neighbor\" after one refinement step.\n- For $G_n$: As established, all adjacent pairs have exactly one common neighbor. $G_n$ consists of $n$ disjoint triangles. Each triangle has 3 edges. Each edge $\\{u,v\\}$ corresponds to two ordered adjacent pairs, $(u,v)$ and $(v,u)$. So, each triangle has $3 \\times 2 = 6$ ordered adjacent pairs. For $n$ triangles, the total number of such pairs is $6n$. The size of this color class in $G_n$ is $6n$.\n- For $H_n$: As established, no adjacent pairs have a common neighbor. Therefore, the number of pairs in $H_n$ that fit the description is $0$. The size of the corresponding color class in $H_n$ is $0$.\n\nThe difference $\\Delta(n)$ is the size of this class in $G_n$ minus the size of the corresponding class in $H_n$:\n$$ \\Delta(n) = 6n - 0 = 6n $$",
            "answer": "$$\n\\boxed{6n}\n$$"
        }
    ]
}