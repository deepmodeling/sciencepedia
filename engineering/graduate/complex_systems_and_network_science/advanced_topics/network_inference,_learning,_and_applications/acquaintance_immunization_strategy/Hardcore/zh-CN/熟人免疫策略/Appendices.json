{
    "hands_on_practices": [
        {
            "introduction": "熟人免疫策略的有效性源于一个核心的数学原理：它能优先选择网络中的高连接度节点。本练习旨在从第一性原理出发，推导一个度为 $k$ 的节点在经过 $m$ 次独立的熟人免疫查询后被免疫的精确概率。通过这个推导，你将量化地理解为何此策略能够利用网络的异质性，为后续分析其流行病学影响奠定基础。",
            "id": "4262068",
            "problem": "考虑一个包含 $N$ 个节点的大型无向简单网络，其度分布为 $P(k)$，平均度为 $\\langle k \\rangle$。在熟人免疫策略中，单次免疫查询按以下步骤进行：首先从 $N$ 个节点中均匀随机地选择一个节点，然后从其邻居中均匀随机地选择一个，并对该邻居进行免疫。假设查询是独立且有放回地进行的，这意味着网络和抽样机制不受先前免疫的影响，并且每次查询的分布都是相同的。\n\n在度-度相关性可忽略的配置模型假设下，从第一性原理推导出一个精确表达式（在平均场意义上），用于描述一个度为 $k$ 的节点在 $m$ 次独立有放回的查询后至少被免疫一次的概率 $P_{m}(k)$。然后，得到一个适用于大型网络中稀疏抽样情况的 $P_{m}(k)$ 的前导指数近似，并确定该近似在何种条件下（用 $N$、$k$ 和 $m$ 表示）是准确的，包括前导修正项的量级。\n\n你的最终答案必须包含平均场精确表达式及其指数近似，写成闭合形式的解析表达式。无需进行数值计算。",
            "solution": "问题要求解在使用熟人免疫策略的 $m$ 次独立查询后，一个度为 $k$ 的节点至少被免疫一次的概率 $P_{m}(k)$，以及其前导近似和该近似的有效范围。推导将在度-度相关性可忽略的配置模型网络的平均场假设下进行。\n\n首先，我们推导在单次查询中，一个度为 $k$ 的特定节点被选中免疫的概率，我们将其记为 $q(k)$。设目标节点为 $V$，其度为 $\\text{deg}(V) = k$。熟人免疫策略包括两个步骤：\n$1$. 从网络的 $N$ 个节点中均匀随机地选择一个节点，称之为 $U$。选中任何特定节点 $U$ 的概率是 $1/N$。\n$2$. 从 $U$ 的邻居中均匀随机地选择一个并进行免疫。\n\n为了使我们的目标节点 $V$ 被免疫，在步骤1中选择的节点 $U$ 必须是 $V$ 的邻居之一。设 $V$ 的邻居集合为 $\\mathcal{N}(V)$，其中 $|\\mathcal{N}(V)|=k$。如果在步骤1中选择了特定的邻居 $U_i \\in \\mathcal{N}(V)$，其度为 $\\text{deg}(U_i)$。在步骤2中，为了使 $V$ 被免疫，必须从 $U_i$ 的 $\\text{deg}(U_i)$ 个邻居中选中它。这个概率是 $1/\\text{deg}(U_i)$。\n\n通过特定邻居 $U_i$ 使 $V$ 被免疫的概率是这两个独立事件概率的乘积：$P(\\text{选中 } U_i \\text{ 然后选中 } V) = P(\\text{选中 } U_i) \\times P(\\text{选中 } V | \\text{ 已选中 } U_i) = \\frac{1}{N} \\times \\frac{1}{\\text{deg}(U_i)}$。\n\n节点 $V$ 在单次查询中被免疫的总概率 $q_V$ 是对所有邻居的这些概率求和，因为这些是互斥事件（在步骤1中只选择一个节点 $U$）：\n$$q_V = \\sum_{U_i \\in \\mathcal{N}(V)} \\frac{1}{N \\cdot \\text{deg}(U_i)} = \\frac{1}{N} \\sum_{i=1}^{k} \\frac{1}{\\text{deg}(U_i)}$$\n这个概率取决于节点 $V$ 的特定邻居的度。问题要求的是 $P_m(k)$，它指的是一个度为 $k$ 的泛指节点。因此，我们需要通过对所有度为 $k$ 的节点 $V$ 的 $q_V$ 进行平均来计算期望概率 $q(k)$。\n$$q(k) = \\left\\langle q_V \\right\\rangle_{\\text{deg}(V)=k} = \\frac{1}{N} \\left\\langle \\sum_{i=1}^{k} \\frac{1}{\\text{deg}(U_i)} \\right\\rangle_{\\text{deg}(V)=k}$$\n在配置模型中无度-度相关的假设下，一个节点的邻居的度与该节点自身的度是独立的。一个邻居的度的概率分布 $P_{nn}(k')$，并非是总体的度分布 $P(k')$，而是偏向于度较高的节点。这是因为一个度为 $k'$ 的节点有 $k'$ 条边，这使得它成为邻居的可能性是一个度为1的节点的 $k'$ 倍。邻居度的归一化分布为 $P_{nn}(k') = \\frac{k' P(k')}{\\sum_{j} j P(j)} = \\frac{k' P(k')}{\\langle k \\rangle}$。\n\n我们现在可以计算邻居度的倒数的期望值：\n$$\\left\\langle \\frac{1}{\\text{deg}(\\text{neighbor})} \\right\\rangle = \\sum_{k'=1}^{N-1} \\frac{1}{k'} P_{nn}(k') = \\sum_{k'=1}^{N-1} \\frac{1}{k'} \\frac{k' P(k')}{\\langle k \\rangle} = \\frac{1}{\\langle k \\rangle} \\sum_{k'=1}^{N-1} P(k') = \\frac{1}{\\langle k \\rangle}$$\n因为 $\\sum P(k') = 1$。\n应用这个平均场结果，和的期望值变成了期望值的和：\n$$q(k) = \\frac{1}{N} \\sum_{i=1}^{k} \\left\\langle \\frac{1}{\\text{deg}(U_i)} \\right\\rangle = \\frac{1}{N} \\sum_{i=1}^{k} \\frac{1}{\\langle k \\rangle} = \\frac{k}{N \\langle k \\rangle}$$\n这就是在单次查询中，一个度为 $k$ 的节点被免疫的平均场概率。请注意，这个概率与节点的度 $k$ 成正比，这是熟人免疫策略的核心优势。\n\n现在我们来求 $P_m(k)$，即在 $m$ 次独立查询中至少被免疫一次的概率。更方便的做法是先计算*不*被免疫的概率。在一次查询中不被免疫的概率是 $1 - q(k)$。由于所有 $m$ 次查询都是独立且有放回的，所以在 $m$ 次查询中均不被免疫的概率是各次概率的乘积：\n$$P(\\text{not immunized in } m \\text{ queries}) = (1 - q(k))^m = \\left(1 - \\frac{k}{N \\langle k \\rangle}\\right)^m$$\n至少被免疫一次的概率 $P_m(k)$ 是该事件的补事件：\n$$P_m(k) = 1 - \\left(1 - \\frac{k}{N \\langle k \\rangle}\\right)^m$$\n这是第一个要求的结果：在平均场意义下 $P_m(k)$ 的精确表达式。\n\n接下来，我们推导前导指数近似。该近似在“大型网络中的稀疏抽样”条件下有效，这意味着单次查询中被免疫的概率非常小。在数学上，这对应于 $q(k) = \\frac{k}{N \\langle k \\rangle} \\ll 1$ 的区域。只要 $k$ 和 $\\langle k \\rangle$ 不与 $N$ 同阶，这个条件在大型网络（$N \\to \\infty$）中就能满足。\n我们使用指数函数的著名极限 $(1-x)^m \\approx \\exp(-mx)$，这是 $\\exp(m \\ln(1-x))$ 展开式中的前导项。\n设 $x = q(k) = \\frac{k}{N \\langle k \\rangle}$，我们得到：\n$$P_m(k) = 1 - \\left(1 - \\frac{k}{N \\langle k \\rangle}\\right)^m \\approx 1 - \\exp\\left(-\\frac{mk}{N \\langle k \\rangle}\\right)$$\n这是第二个要求的结果：前导指数近似。\n\n最后，我们分析其有效范围和前导修正项。该近似源于自然对数的泰勒级数：$\\ln(1-x) = -x - \\frac{x^2}{2} - \\frac{x^3}{3} - \\dots$。\n于是，$(1-x)^m = \\exp(m\\ln(1-x)) = \\exp\\left(m\\left(-x - \\frac{x^2}{2} - O(x^3)\\right)\\right) = \\exp(-mx) \\exp\\left(-\\frac{mx^2}{2}\\right) \\exp\\left(-O(mx^3)\\right)$。\n如果展开式中的后续项可以忽略不计，那么前导近似 $P_m(k) \\approx 1 - \\exp(-mx)$ 就是准确的。第一个修正因子是 $\\exp\\left(-\\frac{mx^2}{2}\\right)$。为了使这个因子接近于1，其指数的绝对值必须很小：\n$$\\frac{mx^2}{2} \\ll 1 \\implies \\frac{m}{2} \\left(\\frac{k}{N \\langle k \\rangle}\\right)^2 \\ll 1 \\implies mk^2 \\ll 2(N \\langle k \\rangle)^2$$\n这个不等式定义了有效范围。对于大的 $N$ 以及不过快增长的 $m$ 和 $k$ 值，该近似是准确的。\n对概率 $P_m(k)$ 本身的前导修正项的量级可以通过展开修正因子 $\\exp\\left(-\\frac{mx^2}{2}\\right) \\approx 1 - \\frac{mx^2}{2}$ 来找到：\n$$P_m(k) \\approx 1 - \\exp(-mx)\\left(1 - \\frac{mx^2}{2}\\right) = \\left[1 - \\exp(-mx)\\right] + \\frac{mx^2}{2}\\exp(-mx)$$\n前导修正项是第二项，其量级为：\n$$\\frac{m}{2} \\left(\\frac{k}{N \\langle k \\rangle}\\right)^2 \\exp\\left(-\\frac{mk}{N \\langle k \\rangle}\\right)$$\n该修正项的量级为 $O\\left(\\frac{m k^2}{N^2}\\right)$。\n最终答案要求给出平均场精确表达式及其指数近似。",
            "answer": "$$\n\\boxed{\n1 - \\left(1 - \\frac{k}{N \\langle k \\rangle}\\right)^m, \\quad 1 - \\exp\\left(-\\frac{mk}{N \\langle k \\rangle}\\right)\n}\n$$"
        },
        {
            "introduction": "理解了熟人免疫如何优先选择高连接度节点后，下一个关键问题是评估这种策略对抑制流行病传播的实际效果。此练习将免疫过程建模为度相关的节点存活概率 $s_k$，并要求你推导在此策略下流行病爆发的阈值条件。通过将此模型应用于具体的网络结构（如泊松网络），你将能够计算出阻止疫情所需的临界传播率，从而将抽象的免疫策略与具体的公共卫生目标联系起来。",
            "id": "4262057",
            "problem": "考虑一个由配置模型生成的大型网络，其度分布为 $P(k)$，平均度 $\\langle k \\rangle$ 为有限值。一种疾病根据易感-感染-恢复 (SIR) 过程进行传播，其中每次接触（每条边）以概率（传播率）$T$ 独立地传播感染。在疫情开始前，采用一种熟人免疫策略：一定比例的随机选取的个体各自提名一个随机邻居进行免疫。在稀疏采样的极限下，该策略导致度为 $k$ 的节点具有一个与度相关的存活概率 $s_k=\\exp\\left(-\\nu k / \\langle k \\rangle\\right)$，其中 $\\nu>0$ 是参数化免疫力度的参数。\n\n从以下基本原理出发：\n- 在大尺寸极限下，配置模型生成的网络是局部树状的。\n- 在此类网络上的早期 SIR 动力学可以用一个 Galton–Watson 分支过程来近似，其中基本再生数等于沿着一条典型的感染边到达一个邻居，然后再沿着该邻居的其余边向外传播所产生的成功传播的期望数量。\n- 与度相关的节点存活充当一种位点占据偏置，它按照 $k P(k) s_k$ 的比例重新加权了边的邻居度采样，而传播率 $T$ 则充当了沿着边的独立键占据。\n\n从第一性原理出发，推导全局性疫情爆发的存在性阈值条件，该条件用 $T$、$P(k)$ 和 $s_k$ 表示。然后，将此条件特化到泊松度分布 $P(k)=\\exp(-z)\\,z^k/k!$（平均度为 $z=\\langle k \\rangle$）的情况，并计算临界传播率 $T_c$，给出一个关于 $z$ 和 $\\nu$ 的显式闭式解析表达式。\n\n将 $T_c$ 的最终答案表示为单个解析表达式。无需四舍五入，最终答案中不应包含单位。",
            "solution": "该问题在网络流行病学方面有科学依据，内容自洽且提法明确，因此是有效的。我们可以开始推导。\n\n问题要求解在一个网络上发生 SIR 过程的疫情阈值条件，该网络中的节点已根据与度相关的存活概率 $s_k$ 进行了免疫。疫情阈值对应于分支过程近似的基本再生数 $R_*$ 等于 1 的点。如果 $R_* > 1$，则可能发生疫情。\n\n量 $R_*$ 表示一个自身被其某个邻居感染的单一感染节点所产生的二次感染的期望数量。它由传播率 $T$ 与仅由易感节点组成的网络的平均超额度之积给出。\n\n让我们用 $P(k)$ 表示原始度分布。经过免疫过程后，一个度为 $k$ 的节点以概率 $s_k$ 保持易感。我们可以将其视为一个位点逾渗问题。剩余（易感）网络的性质决定了疫情的动力学。\n\n沿着一条随机边到达一个度为 $k$ 的易感邻居的概率，与连接到这类节点的边数 $k$ 成正比，并由其原始概率 $P(k)$ 和存活概率 $s_k$ 加权。对此进行归一化后，通过随机边到达的易感邻居的度分布为：\n$$\nq_s(k) = \\frac{k P(k) s_k}{\\sum_{k'} k' P(k') s_{k'}}\n$$\n一个度为 $k$ 的受感染节点有 $k-1$ 条边可以用来感染其他邻居。它将引起的二次感染期望数由 $T$ 乘以通过这 $k-1$ 条边连接的易感邻居的期望数给出。对于分支过程，我们对这个量在分布 $q_s(k)$ 上求平均。“出向”易感邻居的期望数是 $k-1$ 在分布 $q_s(k)$ 上的平均值：\n$$\n\\langle k-1 \\rangle_{\\text{susceptible neighbor}} = \\sum_{k=0}^{\\infty} (k-1) q_s(k) = \\frac{\\sum_{k=0}^{\\infty} k(k-1) P(k) s_k}{\\sum_{k=0}^{\\infty} k P(k) s_k}\n$$\n再生数 $R_*$ 是这个量乘以传播率 $T$：\n$$\nR_* = T \\frac{\\sum_{k} k(k-1) P(k) s_k}{\\sum_{k} k P(k) s_k}\n$$\n疫情阈值通过设 $R_*=1$ 求得，这给出了临界传播率 $T_c$：\n$$\nT_c = \\frac{\\sum_{k} k P(k) s_k}{\\sum_{k} k(k-1) P(k) s_k}\n$$\n这就是疫情阈值条件的通用表达式。\n\n现在，我们将此结果特化到给定的泊松度分布 $P(k)=\\exp(-z)\\,z^k/k!$（平均度 $\\langle k \\rangle=z$）和存活概率 $s_k=\\exp(-\\nu k / z)$ 的情况。\n\n为计算这些和，我们使用生成函数方法。让我们定义一个函数 $G_s(x)$ 如下：\n$$\nG_s(x) = \\sum_{k=0}^{\\infty} P(k) s_k x^k\n$$\n我们需要的和可以用 $G_s(x)$ 在 $x=1$ 处的导数来表示：\n$$\n\\sum_{k} k P(k) s_k = G_s'(1)\n$$\n$$\n\\sum_{k} k(k-1) P(k) s_k = G_s''(1)\n$$\n首先，让我们为我们的特定情况构建 $G_s(x)$：\n$$\nG_s(x) = \\sum_{k=0}^{\\infty} \\left(\\frac{\\exp(-z) z^k}{k!}\\right) \\left(\\exp\\left(-\\frac{\\nu k}{z}\\right)\\right) x^k\n$$\n让我们将 $k$ 次幂的项组合在一起：\n$$\nG_s(x) = \\exp(-z) \\sum_{k=0}^{\\infty} \\frac{1}{k!} \\left(z \\cdot \\exp\\left(-\\frac{\\nu}{z}\\right) \\cdot x\\right)^k\n$$\n这个和是指数函数的泰勒级数，$\\sum_{k=0}^{\\infty} \\frac{A^k}{k!} = \\exp(A)$。这里，$A = z \\exp(-\\nu/z) x$。\n$$\nG_s(x) = \\exp(-z) \\exp\\left(z \\exp\\left(-\\frac{\\nu}{z}\\right) x\\right) = \\exp\\left(z\\left[\\exp\\left(-\\frac{\\nu}{z}\\right)x - 1\\right]\\right)\n$$\n现在，我们计算关于 $x$ 的一阶和二阶导数：\n$$\nG_s'(x) = \\frac{d}{dx} G_s(x) = G_s(x) \\cdot \\left(z \\exp\\left(-\\frac{\\nu}{z}\\right)\\right)\n$$\n$$\nG_s''(x) = \\frac{d}{dx} G_s'(x) = G_s'(x) \\cdot \\left(z \\exp\\left(-\\frac{\\nu}{z}\\right)\\right) = G_s(x) \\cdot \\left(z \\exp\\left(-\\frac{\\nu}{z}\\right)\\right)^2\n$$\n在 $x=1$ 处对它们求值：\n$$\nG_s'(1) = G_s(1) \\cdot \\left(z \\exp\\left(-\\frac{\\nu}{z}\\right)\\right)\n$$\n$$\nG_s''(1) = G_s(1) \\cdot \\left(z \\exp\\left(-\\frac{\\nu}{z}\\right)\\right)^2\n$$\n临界传播率 $T_c$ 的阈值条件是：\n$$\nT_c = \\frac{G_s'(1)}{G_s''(1)} = \\frac{G_s(1) \\cdot \\left(z \\exp\\left(-\\frac{\\nu}{z}\\right)\\right)}{G_s(1) \\cdot \\left(z \\exp\\left(-\\frac{\\nu}{z}\\right)\\right)^2}\n$$\n$G_s(1)$ 项相互抵消，我们得到：\n$$\nT_c = \\frac{1}{z \\exp\\left(-\\frac{\\nu}{z}\\right)}\n$$\n这可以化简为临界传播率的最终表达式：\n$$\nT_c = \\frac{1}{z} \\exp\\left(\\frac{\\nu}{z}\\right)\n$$",
            "answer": "$$\n\\boxed{\\frac{1}{z} \\exp\\left(\\frac{\\nu}{z}\\right)}\n$$"
        }
    ]
}