{
    "hands_on_practices": [
        {
            "introduction": "理解一个抽象概念的最好方法之一就是在一个简单的、可控的场景中进行精确计算。这项实践旨在通过一个基础练习来巩固你对传递熵的理解。通过为一个简单的向量自回归（VAR）模型解析地计算传递熵，我们可以具体地洞察传递熵如何量化系统间的耦合强度，从而将抽象的信息论定义与具体的模型参数联系起来 。",
            "id": "4312456",
            "problem": "考虑一个联合高斯、一阶马尔可夫二元过程，该过程通常被视为一阶向量自回归（VAR(1)）的一个特例。驱动过程定义为 $X_t \\sim \\mathcal{N}(0,\\sigma_X^2)$，在时间上独立，且独立于响应过程及所有噪声。响应过程根据以下方程演化\n$$\nY_{t+1} = a\\,Y_t + b\\,X_t + \\epsilon_t,\n$$\n其中 $\\epsilon_t \\sim \\mathcal{N}(0,\\sigma_Y^2)$ 独立于 $(X_t, Y_t)$ 并且在时间上独立。假设 $|a|<1$ 以确保响应过程在 $X_t$ 的外源激励下具有平稳性。\n\n从 $X$ 到 $Y$ 的传递熵（TE）的定义（即条件互信息 $T_{X\\to Y} \\equiv I(X_t; Y_{t+1}\\,|\\,Y_t)$）出发，推导一个关于参数 $a$、$b$、$\\sigma_X^2$ 和 $\\sigma_Y^2$ 的 $T_{X\\to Y}$ 的精确解析表达式。你的推导应仅使用核心定义（例如，互信息的定义和高斯变量的微分熵）以及联合高斯变量的标准性质，并应从第一性原理出发清楚地证明每一步。最终答案需使用自然对数表示。无需进行数值计算，也无需四舍五入。最终表达式是无量纲的，应以奈特（nats）为单位报告。",
            "solution": "该问题是有效的。它在信息论和时间序列分析方面有坚实的科学基础，定义和约束完备一致，表述客观。因此，我们可以着手进行推导。\n\n从过程 $X$ 到过程 $Y$ 的传递熵定义为驱动过程的当前状态 $X_t$ 与响应过程的未来状态 $Y_{t+1}$ 在给定响应过程当前状态 $Y_t$ 条件下的条件互信息。其形式化写法为：\n$$\nT_{X\\to Y} \\equiv I(X_t; Y_{t+1}\\,|\\,Y_t)\n$$\n根据连续变量的条件互信息用微分熵表示的定义，我们有：\n$$\nI(A; B\\,|\\,C) = h(B\\,|\\,C) - h(B\\,|\\,A, C)\n$$\n将此定义应用于我们的特定变量，传递熵为：\n$$\nT_{X\\to Y} = h(Y_{t+1}\\,|\\,Y_t) - h(Y_{t+1}\\,|\\,Y_t, X_t)\n$$\n问题指定了一个联合高斯过程。对于一个联合高斯变量向量 $\\mathbf{Z}$，一个子向量 $\\mathbf{Z}_1$ 在另一个子向量 $\\mathbf{Z}_2$ 条件下的微分熵由以下公式给出：\n$$\nh(\\mathbf{Z}_1\\,|\\,\\mathbf{Z}_2) = \\frac{1}{2}\\ln\\left( (2\\pi e)^k |\\mathrm{Cov}(\\mathbf{Z}_1\\,|\\,\\mathbf{Z}_2)| \\right)\n$$\n其中 $k$ 是 $\\mathbf{Z}_1$ 的维度，而 $|\\mathrm{Cov}(\\mathbf{Z}_1\\,|\\,\\mathbf{Z}_2)|$ 是条件协方差矩阵的行列式。由于我们的变量 $Y_{t+1}$、$Y_t$ 和 $X_t$ 都是标量（$k=1$），上式可简化为：\n$$\nh(A\\,|\\,B) = \\frac{1}{2}\\ln\\left( 2\\pi e \\, \\mathrm{Var}(A\\,|\\,B) \\right)\n$$\n其中 $\\mathrm{Var}(A\\,|\\,B)$ 是 $A$ 在给定 $B$ 条件下的条件方差。\n\n因此，我们的任务简化为计算两个条件方差，即 $\\mathrm{Var}(Y_{t+1}\\,|\\,Y_t, X_t)$ 和 $\\mathrm{Var}(Y_{t+1}\\,|\\,Y_t)$。\n\n首先，我们计算 $h(Y_{t+1}\\,|\\,Y_t, X_t)$。响应过程的演化由下式给出：\n$$\nY_{t+1} = a\\,Y_t + b\\,X_t + \\epsilon_t\n$$\n当我们以 $Y_t$ 和 $X_t$ 为条件时，$a\\,Y_t$ 和 $b\\,X_t$ 项成为已知常数。$Y_{t+1}$ 中唯一剩余的不确定性来源是噪声项 $\\epsilon_t$。问题陈述道，$\\epsilon_t \\sim \\mathcal{N}(0, \\sigma_Y^2)$ 独立于 $(X_t, Y_t)$。因此，以 $Y_t$ 和 $X_t$ 为条件的 $Y_{t+1}$ 的分布是一个以 $a\\,Y_t + b\\,X_t$ 为中心、方差等于 $\\epsilon_t$ 的方差的高斯分布。\n$$\n\\mathrm{Var}(Y_{t+1}\\,|\\,Y_t, X_t) = \\mathrm{Var}(a\\,Y_t + b\\,X_t + \\epsilon_t \\,|\\,Y_t, X_t) = \\mathrm{Var}(\\epsilon_t) = \\sigma_Y^2\n$$\n相应的条件熵为：\n$$\nh(Y_{t+1}\\,|\\,Y_t, X_t) = \\frac{1}{2}\\ln\\left( 2\\pi e \\sigma_Y^2 \\right)\n$$\n接下来，我们计算 $h(Y_{t+1}\\,|\\,Y_t)$。我们再次使用过程的定义：\n$$\nY_{t+1} = a\\,Y_t + b\\,X_t + \\epsilon_t\n$$\n当我们仅以 $Y_t$ 为条件时，$a\\,Y_t$ 项是一个已知常数，但 $b\\,X_t$ 和 $\\epsilon_t$ 仍然是随机变量。问题陈述如下：\n1. $X_t$ 独立于响应过程，这意味着 $X_t$ 独立于 $Y_t$。\n2. $\\epsilon_t$ 独立于 $Y_t$。\n3. $X_t$ 独立于所有噪声，这意味着 $X_t$ 独立于 $\\epsilon_t$。\n\n基于这些独立性性质，条件方差是各独立随机分量方差的总和：\n$$\n\\mathrm{Var}(Y_{t+1}\\,|\\,Y_t) = \\mathrm{Var}(a\\,Y_t + b\\,X_t + \\epsilon_t \\,|\\,Y_t) = \\mathrm{Var}(b\\,X_t + \\epsilon_t)\n$$\n$$\n\\mathrm{Var}(Y_{t+1}\\,|\\,Y_t) = \\mathrm{Var}(b\\,X_t) + \\mathrm{Var}(\\epsilon_t) = b^2\\mathrm{Var}(X_t) + \\mathrm{Var}(\\epsilon_t)\n$$\n代入给定的方差 $\\mathrm{Var}(X_t) = \\sigma_X^2$ 和 $\\mathrm{Var}(\\epsilon_t) = \\sigma_Y^2$，我们得到：\n$$\n\\mathrm{Var}(Y_{t+1}\\,|\\,Y_t) = b^2\\sigma_X^2 + \\sigma_Y^2\n$$\n相应的条件熵为：\n$$\nh(Y_{t+1}\\,|\\,Y_t) = \\frac{1}{2}\\ln\\left( 2\\pi e (b^2\\sigma_X^2 + \\sigma_Y^2) \\right)\n$$\n请注意，平稳性条件 $|a|<1$ 确保了 $Y_t$ 的无条件方差是有限的，从而使过程表现良好，但它不直接参与传递熵的计算。传递熵是在给定接收者当前状态的条件下，衡量从一个时间步到下一个时间步的预测信息增益的指标。\n\n最后，我们将两个熵的表达式代回到 $T_{X\\to Y}$ 的公式中：\n$$\nT_{X\\to Y} = h(Y_{t+1}\\,|\\,Y_t) - h(Y_{t+1}\\,|\\,Y_t, X_t)\n$$\n$$\nT_{X\\to Y} = \\frac{1}{2}\\ln\\left( 2\\pi e (b^2\\sigma_X^2 + \\sigma_Y^2) \\right) - \\frac{1}{2}\\ln\\left( 2\\pi e \\sigma_Y^2 \\right)\n$$\n利用对数性质 $\\ln(A) - \\ln(B) = \\ln(A/B)$，我们简化该表达式：\n$$\nT_{X\\to Y} = \\frac{1}{2}\\left[ \\ln\\left( 2\\pi e (b^2\\sigma_X^2 + \\sigma_Y^2) \\right) - \\ln\\left( 2\\pi e \\sigma_Y^2 \\right) \\right]\n$$\n$$\nT_{X\\to Y} = \\frac{1}{2}\\ln\\left( \\frac{2\\pi e (b^2\\sigma_X^2 + \\sigma_Y^2)}{2\\pi e \\sigma_Y^2} \\right)\n$$\n$$\nT_{X\\to Y} = \\frac{1}{2}\\ln\\left( \\frac{b^2\\sigma_X^2 + \\sigma_Y^2}{\\sigma_Y^2} \\right)\n$$\n这可以写成一种更具解释性的形式，类似于具有一定信噪比的高斯信道的信道容量：\n$$\nT_{X\\to Y} = \\frac{1}{2}\\ln\\left( 1 + \\frac{b^2\\sigma_X^2}{\\sigma_Y^2} \\right)\n$$\n这就是从 $X$ 到 $Y$ 的传递熵的最终解析表达式，单位为奈特（nats）。",
            "answer": "$$\n\\boxed{\\frac{1}{2}\\ln\\left(1 + \\frac{b^2\\sigma_X^2}{\\sigma_Y^2}\\right)}\n$$"
        },
        {
            "introduction": "在应用传递熵时，一个常见的陷阱是将其与标准的皮尔逊相关性混淆。这项实践是一个关键的概念检验，旨在阐明两者之间的根本区别。通过一个精心设计的思想实验，我们分析一个具有强瞬时相关但没有延迟影响的系统，以证明传递熵能够正确地识别出其中不存在预测性信息流 。",
            "id": "4312449",
            "problem": "考虑两个标量离散时间过程 $\\{X_t\\}_{t\\in\\mathbb{Z}}$ 和 $\\{U_t\\}_{t\\in\\mathbb{Z}}$，它们是独立的零均值、时间上独立的高斯白噪声，其方差分别为 $\\operatorname{Var}(X_t)=\\sigma_X^2>0$ 和 $\\operatorname{Var}(U_t)=\\sigma_U^2>0$。通过瞬时混合定义一个观测过程\n$$\nY_t=\\alpha X_t+\\beta U_t,\n$$\n其中 $\\alpha,\\beta$ 是固定的实系数。除了在同一时间 $t$ 的瞬时贡献外，没有任何机制能让 $X_t$ 或 $U_t$ 的任何滞后值直接影响 $Y_t$。$X_t$ 和 $Y_t$ 之间的零滞后 Pearson 相关系数在 $|\\alpha|$ 相对于 $|\\beta|$ 较大时会很高，但其时间演化中不包含从 $X$ 到 $Y$ 的延迟耦合。\n\n仅使用第一性原理和传递熵（TE）的标准解释——即源的过去在目标自身过去之外为目标的现在所传达的信息——并采用一步嵌入（即，TE 中使用的过去仅由每个过程紧邻的前一个样本组成），判断以下哪些陈述是正确的。\n\nA. 只要 $|\\alpha|>0$，$T_{X\\to Y}(1)>0$，因为 $Y_t$ 线性依赖于 $X_t$。\n\nB. 在所述设置下，对于任何整数 $\\delta\\ge 1$，$T_{X\\to Y}(\\delta)=0$，尽管当 $|\\alpha|>0$ 时，$X_t$ 和 $Y_t$ 之间的零滞后 Pearson 相关系数不为零。\n\nC. 对目标的一步过去进行条件化并不能消除瞬时混合；因此，在任何情况下，$T_{X\\to Y}(1)$ 都必须不为零。\n\nD. 当 $|\\alpha|>0$ 且 $\\sigma_U^2>0$ 时，零延迟量 $T_{X\\to Y}(0)$ 是严格为正的，并且仅当 $\\alpha=0$ 时（保持 $\\sigma_U^2>0$ 固定）其值为 $0$。\n\nE. 如果 $\\beta=0$，则 $Y_t=X_t$，因此 $T_{X\\to Y}(1)$ 变为正值。\n\n选择所有正确选项。",
            "solution": "### 推导过程\n\n传递熵（TE）$T_{X\\to Y}(\\delta)$ 量化了在已知目标过程 $\\{Y_t\\}$ 的历史的条件下，源过程 $\\{X_t\\}$ 的历史为目标过程的未来提供的额外信息。对于一步嵌入和延迟 $\\delta \\ge 1$，其定义为条件互信息：\n$$ T_{X\\to Y}(\\delta) = I(Y_t; X_{t-\\delta} | Y_{t-1}) $$\n根据条件互信息的定义，这可以展开为：\n$$ T_{X\\to Y}(\\delta) = H(Y_t | Y_{t-1}) - H(Y_t | Y_{t-1}, X_{t-\\delta}) $$\n其中 $H(\\cdot|\\cdot)$ 是条件（微分）熵。当且仅当在已知 $Y_{t-1}$ 的情况下，$X_{t-\\delta}$ 仍然能提供关于 $Y_t$ 的新信息时，该值为正。\n\n我们来分析系统中的依赖关系。过程 $Y_t$ 的定义为：\n$$ Y_t = \\alpha X_t + \\beta U_t $$\n根据问题设定，$\\{X_t\\}$ 和 $\\{U_t\\}$ 都是独立的白噪声过程。白噪声的一个关键特性是，任何时刻的变量值（如 $X_t$）都与其所有过去和未来的值（如 $X_{t-\\delta}$ for $\\delta \\ne 0$）统计独立。\n\n因为 $Y_t$ 仅由 $X_t$ 和 $U_t$ 在同一时刻 $t$ 的值构成，所以 $Y_t$ 独立于所有在 $t$ 时刻之前的变量，包括 $Y_{t-1}$ 和 $X_{t-\\delta}$（对于 $\\delta \\ge 1$）。\n\n因此，对于 $\\delta \\ge 1$：\n1.  $Y_t$ 与 $Y_{t-1}$ 独立，这意味着 $H(Y_t | Y_{t-1}) = H(Y_t)$。\n2.  $Y_t$ 与 $(Y_{t-1}, X_{t-\\delta})$ 这对变量联合独立，这意味着 $H(Y_t | Y_{t-1}, X_{t-\\delta}) = H(Y_t)$。\n\n将这些结果代入传递熵的公式：\n$$ T_{X\\to Y}(\\delta) = H(Y_t) - H(Y_t) = 0 \\quad (\\text{对于所有 } \\delta \\ge 1) $$\n这表明，尽管 $X_t$ 和 $Y_t$ 之间存在瞬时相关性，但从 $X$ 的过去到 $Y$ 的未来没有预测性信息流。\n\n### 选项评估\n\n- **A. 只要 $|\\alpha|>0$，$T_{X\\to Y}(1)>0$，因为 $Y_t$ 线性依赖于 $X_t$。**\n  **不正确**。$Y_t$ 对 $X_t$ 的依赖是瞬时的，而不是延迟的。如上所示，$T_{X\\to Y}(1)=0$。\n\n- **B. 在所述设置下，对于任何整数 $\\delta\\ge 1$，$T_{X\\to Y}(\\delta)=0$，尽管当 $|\\alpha|>0$ 时，$X_t$ 和 $Y_t$ 之间的零滞后 Pearson 相关系数不为零。**\n  **正确**。我们的推导表明 $T_{X\\to Y}(\\delta)=0$ 对所有 $\\delta\\ge 1$ 成立。同时，$X_t$ 和 $Y_t$ 的协方差为 $\\operatorname{Cov}(X_t, Y_t) = \\operatorname{Cov}(X_t, \\alpha X_t + \\beta U_t) = \\alpha \\operatorname{Var}(X_t) = \\alpha \\sigma_X^2$。只要 $\\alpha \\ne 0$，协方差和相关系数就不为零。该陈述准确地区分了瞬时相关和延迟信息流。\n\n- **C. 对目标的一步过去进行条件化并不能消除瞬时混合；因此，在任何情况下，$T_{X\\to Y}(1)$ 都必须不为零。**\n  **不正确**。传递熵衡量的是来自源的 **过去** 的信息。瞬时混合不影响这个特定的度量，因此 $T_{X\\to Y}(1)=0$。\n\n- **D. 当 $|\\alpha|>0$ 且 $\\sigma_U^2>0$ 时，零延迟量 $T_{X\\to Y}(0)$ 是严格为正的，并且仅当 $\\alpha=0$ 时（保持 $\\sigma_U^2>0$ 固定）其值为 $0$。**\n  **正确**。零延迟传递熵 $T_{X\\to Y}(0)$ 定义为 $I(Y_t; X_t | Y_{t-1})$。由于 $Y_t$ 独立于 $Y_{t-1}$，这简化为 $I(Y_t; X_t)$。这是 $Y_t$ 和 $X_t$ 之间的互信息。因为 $Y_t = \\alpha X_t + \\beta U_t$，只要 $\\alpha \\ne 0$，$Y_t$ 就统计依赖于 $X_t$（它们是联合高斯且相关的），所以它们的互信息为正。当 $\\alpha=0$ 时，$Y_t = \\beta U_t$，此时 $Y_t$ 与 $X_t$ 独立，互信息为零。\n\n- **E. 如果 $\\beta=0$，则 $Y_t=X_t$，因此 $T_{X\\to Y}(1)$ 变为正值。**\n  **不正确**。如果 $\\beta=0$ 且 $\\alpha=1$（为简单起见），则 $Y_t = X_t$。那么 $T_{X\\to Y}(1) = I(X_t; X_{t-1} | X_{t-1})$。根据条件互信息的性质 $I(A;B|B)=0$，这个值恒为零。即使我们不使用这个性质，由于 $X$ 是白噪声，$X_t$ 独立于 $X_{t-1}$，所以 $I(X_t; X_{t-1}) = 0$，那么条件互信息 $I(X_t; X_{t-1}|X_{t-1})$ 也必定为零。\n\n### 结论\n正确的选项是 B 和 D。",
            "answer": "$$\\boxed{BD}$$"
        },
        {
            "introduction": "从真实数据中计算出的任何非零传递熵值都可能仅仅是由有限样本的随机波动造成的。因此，在得出结论之前，评估其统计显著性是至关重要的一步。这项实践探讨了如何构建一个有效的非参数检验（置换检验）来确定观测到的信息流是否具有统计意义，并强调了此类检验背后的关键假设，如平稳性 。",
            "id": "4312527",
            "problem": "考虑在 $T$ 个时间点上观测到的两个离散时间随机过程 $\\{X_t\\}_{t=1}^T$ 和 $\\{Y_t\\}_{t=1}^T$。目标是通过非参数检验来评估从 $X_t$ 的过去到 $Y_t$ 的下一个值，在以 $Y_t$ 的过去为条件的定向信息流是否具有统计显著性。转移熵 $T_{X\\to Y}$ 是一种有向度量，可以概念化为在给定 $Y_t$ 过去的条件下，从 $X_t$ 的过去到 $Y_t$ 的下一个值的条件互依性，这与 Shannon 熵框架一致。置换检验要求在零假设 $\\mathcal{H}_0$ 下满足可交换性条件，以证明通过对观测数据进行变换生成的代理数据是来自检验统计量的零分布的样本。\n\n在零假设 $\\mathcal{H}_0$（即除了 $Y_t$ 的过去所能解释的部分外，$X_t$ 对 $Y_t$ 没有定向影响）下，为 $T_{X\\to Y}$ 设计一个有效的置换检验，并明确说明置换有效的假设条件。然后，分析所提出的检验对于非平稳数据是否仍然有效，并解释其任何局限性。选择最准确地描述了正确的置换检验机制及其局限性的选项。\n\nA. 在 $\\mathcal{H}_0$ 下，假设联合过程是弱平稳和遍历的，并且 $X_t$ 的过去相对于 $\\{Y_t\\}$ 的对齐是可交换的。通过将整个序列 $\\{X_t\\}$ 以一个从 $\\{1,2,\\dots,T-1\\}$ 中均匀采样的随机延迟 $L$ 进行循环移位来生成代理数据，形成 $\\{\\tilde{X}_t\\}=\\{X_{t+L \\bmod T}\\}$，同时保持 $\\{Y_t\\}$ 不变。这保留了 $\\{X_t\\}$ 的边际分布和自相关性以及 $\\{Y_t\\}$ 的完整时间结构，但破坏了 $X_t$ 和 $Y_t$ 之间的时间对齐。在观测数据和许多独立的代理数据上计算 $T_{X\\to Y}$ 以近似零分布，并通过转移熵至少与观测值一样大的代理数据的比例来估计单边 $p$ 值。此检验依赖于 $\\mathcal{H}_0$ 下 $X_t$ 对齐的平稳性和可交换性。对于具有趋势、季节性模式或结构性断裂的非平稳数据，循环移位会混合不同的模式并违反可交换性，可能导致 I 型错误膨胀或掩盖真实效应；因此，应将置换限制在平稳段内，使用限于同质模式的块移位，或采用时间局部转移熵，否则检验无效。\n\nB. 在 $\\mathcal{H}_0$ 下，假设 $Y_t$ 的过去是可交换的。通过随机置换 $\\{Y_t\\}$ 的索引来生成代理数据，同时保持 $\\{X_t\\}$ 不变，从而破坏 $Y_t$ 的时间顺序。在每个代理数据上计算转移熵，并与观测值进行比较以获得 $p$ 值。这个过程即使对于非平稳数据也有效，因为置换 $\\{Y_t\\}$ 消除了可能使检验产生偏差的时间伪影，因此可以稳健地控制 I 型错误。\n\nC. 在 $\\mathcal{H}_0$ 下，将 $\\{X_t\\}$ 替换为一个方差与 $X_t$ 匹配的独立高斯白噪声过程 $\\{\\epsilon_t\\}$，并计算 $\\{\\epsilon_t\\}$ 和 $\\{Y_t\\}$ 之间的转移熵。用多个独立的噪声实现重复此过程以获得零分布。只要在代理数据中保留了 $X_t$ 的边际分布，该过程就有效，并且由于高斯噪声对 $Y_t$ 没有定向影响，它对于非平稳数据仍然有效。\n\nD. 在 $\\mathcal{H}_0$ 下，假设数据对 $(X_t,Y_t)$ 作为独立同分布的样本是可交换的。通过联合置换成对观测的索引 $t$ 来生成代理数据，从而破坏时间顺序，但保留瞬时联合分布。在每个代理数据上计算转移熵，并与观测值进行比较以获得 $p$ 值。这在存在非平稳性的情况下保持有效性，因为保留联合分布消除了由时变行为引起的伪方向性。\n\n选择最佳选项。",
            "solution": "问题要求设计一个有效的非参数置换检验，以评估从一个过程 $\\{X_t\\}$ 到另一个过程 $\\{Y_t\\}$ 的转移熵 $T_{X\\to Y}$ 的统计显著性。该检验必须适用于零假设 $\\mathcal{H}_0$，即在以 $Y_t$ 的过去为条件下，从 $X_t$ 的过去到 $Y_t$ 的未来没有定向信息流。我们还必须分析所提出的检验在非平稳性下的有效性。\n\n首先，让我们形式化转移熵。对于两个离散时间随机过程 $\\{X_t\\}$ 和 $\\{Y_t\\}$，从 $X$ 到 $Y$ 的转移熵定义为条件互信息：\n$$ T_{X \\to Y} = I(Y_{t+1}; X_t^{(l)} | Y_t^{(k)}) $$\n其中 $X_t^{(l)} = (X_t, X_{t-1}, \\dots, X_{t-l+1})$ 和 $Y_t^{(k)} = (Y_t, Y_{t-1}, \\dots, Y_{t-k+1})$ 分别表示长度为 $l$ 和 $k$ 的过程的过去状态（历史）。用 Shannon 熵表示，这是：\n$$ T_{X \\to Y} = H(Y_{t+1} | Y_t^{(k)}) - H(Y_{t+1} | Y_t^{(k)}, X_t^{(l)}) $$\n这量化了在已知 $Y$ 的历史 $Y_t^{(k)}$ 的情况下，通过了解 $X$ 的历史 $X_t^{(l)}$ 而带来的关于 $Y$ 的下一个状态 $Y_{t+1}$ 的不确定性的减少。\n\n零假设 $\\mathcal{H}_0$ 是 $T_{X \\to Y} = 0$，这等价于条件独立性陈述：\n$$ \\mathcal{H}_0: Y_{t+1} \\perp X_t^{(l)} | Y_t^{(k)} $$\n这意味着 $Y$ 过程的转移概率不依赖于 $X$ 过程的历史，即 $p(y_{t+1} | y_t^{(k)}, x_t^{(l)}) = p(y_{t+1} | y_t^{(k)})$。\n\n针对 $\\mathcal{H}_0$ 的置换检验必须生成符合此零假设的代理数据集，同时保留原始数据的其他统计特性。核心原则是仅破坏正在检验的特定关系。在这种情况下，我们必须打破 $X$ 的历史和 $Y$ 的未来之间的特定时间对齐，而 $T_{X \\to Y}$ 正是依赖于此。\n\n为了正确构造检验统计量 $T_{X \\to Y}$ 的零分布，我们必须保留：\n1.  过程 $\\{Y_t\\}$ 的内部动态（自相关结构）。这个结构决定了由项 $H(Y_{t+1} | Y_t^{(k)})$ 捕获的基线可预测性。\n2.  过程 $\\{X_t\\}$ 的内部动态（自相关结构）。这个结构决定了预测变量历史 $X_t^{(l)}$ 的统计特性。\n\n一个有效的代理生成方案包括保持时间序列 $\\{Y_t\\}$ 不变，并操纵 $\\{X_t\\}$ 以打破其与 $\\{Y_t\\}$ 的方向性关系。一个标准且有效的方法是通过将原始序列 $\\{X_t\\}$ 以一个从 $\\{1, 2, \\dots, T-1\\}$ 中均匀选择的随机延迟 $L$ 进行循环移位来创建代理序列 $\\{\\tilde{X}_t\\}$。即 $\\tilde{X}_t = X_{(t+L-1 \\pmod T) + 1}$。这个过程打破了 $X$ 的历史和 $Y$ 的未来之间的特定时间对齐，从而有效地模拟了 $\\mathcal{H}_0$ 所要求的条件独立性。至关重要的是，循环移位完美地保留了 $\\{X_t\\}$ 的自相关结构（以及功率谱）。通过为许多这样的代理数据计算 $T_{\\tilde{X}\\to Y}$，我们可以构建一个经验零分布。\n\n这种移位过程的有效性依赖于 **平稳性** 的假设。如果联合过程 $(X_t, Y_t)$ 是平稳的，那么在 $\\mathcal{H}_0$ 下，系统的统计特性对于两个序列之间的相对时间移位是不变的。这提供了置换检验所需的可交换性条件：在零假设下，$\\{X_t\\}$相对于$\\{Y_t\\}$的任何对齐（除了原始对齐之外）都是等可能的。\n\n如果数据是 **非平稳的**（例如，包含趋势、季节性或模式变化），则此过程无效。循环移位会使这些非平稳特征错位。例如，它可能会将 $\\{X_t\\}$ 的一个高值段与 $\\{Y_t\\}$ 的一个低值段对齐，从而产生不反映零假设的虚假统计关系。这将污染零分布，导致不可靠的 $p$ 值，并常常导致 I 型错误率大幅膨胀。要处理非平稳性，必须使用更先进的技术，例如将置换限制在局部平稳块内（分块置换），或将检验应用于预处理过的平稳数据。\n\n现在，我们基于这个框架评估给定的选项。\n\n**选项 A：** 该选项建议通过随机延迟循环移位整个序列 $\\{X_t\\}$，同时保持 $\\{Y_t\\}$ 不变来生成代理数据。它正确地指出，这保留了 $\\{X_t\\}$ 的自相关性和 $\\{Y_t\\}$ 的完整结构，同时打破了它们的时间对齐。它正确地确定了平稳性和遍历性的基本假设。此外，它准确地描述了对非平稳数据的局限性，指出循环移位会混合不同的模式并使检验无效，并正确地提出了适当的补救措施，如分块移位或时间局部分析。这一描述完全符合检验转移熵的既定统计方法。\n**结论：正确**\n\n**选项 B：** 该选项建议随机置换 $\\{Y_t\\}$ 的索引，从而破坏其时间顺序。这在根本上是有缺陷的。转移熵统计量 $T_{X \\to Y}$ 通过条件熵项 $H(Y_{t+1}|Y_t^{(k)})$ 关键地依赖于 $\\{Y_t\\}$ 内部的时间结构。通过破坏 $Y$ 的自相关性，这个过程改变了所测量量的一个基本组成部分。产生的零分布将不适用于 $T_{X\\to Y}$，而是适用于某个结构上不同的过程上的其他统计量。声称这对非平稳数据有效是错误的；它对任何具有时间依赖性的数据都会使检验无效。\n**结论：不正确**\n\n**选项 C：** 该选项建议用方差匹配的高斯白噪声过程 $\\{\\epsilon_t\\}$ 替换 $\\{X_t\\}$。这不是一个非参数置换检验，而是一个参数引导。它强加了 $\\{X_t\\}$ 是高斯白噪声这一强有力且未经证实的假设。这个过程未能保留原始 $\\{X_t\\}$ 过程的真实边际分布，更重要的是，未能保留其自相关结构。真实 $\\{X_t\\}$ 与高斯白噪声的任何偏差（例如，存在自相关或非高斯性）都会导致零分布不正确。因此，这种方法通常是无效的。\n**结论：不正确**\n\n**选项 D：** 该选项建议联合置换数据对 $(X_t, Y_t)$ 的时间索引。这个过程破坏了数据中的所有时间结构，包括 $\\{X_t\\}$ 和 $\\{Y_t\\}$ 内部的自相关以及所有滞后互相关。它检验的是序列对 $\\{(X_t, Y_t)\\}$ 是独立同分布（i.i.d.）的零假设。这是一个比转移熵所针对的零假设强得多的假设。原始数据中的任何时间依赖性都会导致拒绝，从而无法分离出从 $X$ 到 $Y$ 的特定方向性影响。该检验将对任何自相关敏感，而不仅仅是定向的条件影响。\n**结论：不正确**\n\n总之，选项 A 提供了检验转移熵显著性的有效置换方案的最准确和完整的描述，正确地指出了其基本假设及其在非平稳性存在时的局限性。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}