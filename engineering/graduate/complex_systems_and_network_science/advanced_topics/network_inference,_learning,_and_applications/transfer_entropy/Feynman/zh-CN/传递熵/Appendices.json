{
    "hands_on_practices": [
        {
            "introduction": "本练习提供了一个基础性的实践，要求为一个简单的线性系统解析计算传递熵。通过完成此推导，您将把传递熵的抽象信息论定义与一个具体、可解释的公式联系起来。这将阐明传递熵如何根据系统参数（如耦合强度和噪声水平）来量化有向影响力。",
            "id": "4312456",
            "problem": "考虑一个联合高斯、一阶马尔可夫二元过程，该过程通常被视为一阶向量自回归（VAR(1)）模型的一个特例。驱动过程定义为 $X_t \\sim \\mathcal{N}(0,\\sigma_X^2)$，它在时间上独立，并且独立于响应过程及所有噪声。响应过程根据以下方程演化：\n$$\nY_{t+1} = a\\,Y_t + b\\,X_t + \\epsilon_t,\n$$\n其中 $\\epsilon_t \\sim \\mathcal{N}(0,\\sigma_Y^2)$ 独立于 $(X_t, Y_t)$ 并且在时间上独立。假设 $|a|<1$ 以确保响应过程在 $X_t$ 的外源激励下是平稳的。\n\n从传递熵（TE）的定义，即从 $X$ 到 $Y$ 的传递熵是条件互信息 $T_{X\\to Y} \\equiv I(X_t; Y_{t+1}\\,|\\,Y_t)$ 出发，推导出一个关于参数 $a$、$b$、$\\sigma_X^2$ 和 $\\sigma_Y^2$ 的 $T_{X\\to Y}$ 的精确解析表达式。你的推导应仅使用核心定义（例如，互信息的定义和高斯变量的微分熵）以及联合高斯变量的标准性质，并应从第一性原理出发清楚地证明每一步。最终答案请使用自然对数表示。不需要进行数值计算，也不需要四舍五入。最终表达式是无量纲的，并应以奈特（nats）为单位报告。",
            "solution": "此问题是有效的。它在信息论和时间序列分析方面有科学依据，问题陈述良好，定义和约束条件完整且一致，并且表述客观。因此，我们可以进行推导。\n\n从过程 $X$ 到过程 $Y$ 的传递熵定义为，在给定响应过程当前状态 $Y_t$ 的条件下，驱动过程当前状态 $X_t$ 与响应过程未来状态 $Y_{t+1}$ 之间的条件互信息。形式上，这写作：\n$$\nT_{X\\to Y} \\equiv I(X_t; Y_{t+1}\\,|\\,Y_t)\n$$\n使用条件互信息关于连续变量微分熵的定义，我们有：\n$$\nI(A; B\\,|\\,C) = h(B\\,|\\,C) - h(B\\,|\\,A, C)\n$$\n将此应用于我们的特定变量，传递熵为：\n$$\nT_{X\\to Y} = h(Y_{t+1}\\,|\\,Y_t) - h(Y_{t+1}\\,|\\,Y_t, X_t)\n$$\n问题指定了一个联合高斯过程。对于一个联合高斯变量向量 $\\mathbf{Z}$，子向量 $\\mathbf{Z}_1$ 在另一子向量 $\\mathbf{Z}_2$ 条件下的微分熵由以下公式给出：\n$$\nh(\\mathbf{Z}_1\\,|\\,\\mathbf{Z}_2) = \\frac{1}{2}\\ln\\left( (2\\pi e)^k |\\mathrm{Cov}(\\mathbf{Z}_1\\,|\\,\\mathbf{Z}_2)| \\right)\n$$\n其中 $k$ 是 $\\mathbf{Z}_1$ 的维度，而 $|\\mathrm{Cov}(\\mathbf{Z}_1\\,|\\,\\mathbf{Z}_2)|$ 是条件协方差矩阵的行列式。由于我们的变量 $Y_{t+1}$、$Y_t$ 和 $X_t$ 都是标量（$k=1$），该公式简化为：\n$$\nh(A\\,|\\,B) = \\frac{1}{2}\\ln\\left( 2\\pi e \\, \\mathrm{Var}(A\\,|\\,B) \\right)\n$$\n其中 $\\mathrm{Var}(A\\,|\\,B)$ 是 $A$ 在给定 $B$ 条件下的条件方差。\n\n因此，我们的任务简化为计算两个条件方差：$\\mathrm{Var}(Y_{t+1}\\,|\\,Y_t, X_t)$ 和 $\\mathrm{Var}(Y_{t+1}\\,|\\,Y_t)$。\n\n首先，我们计算 $h(Y_{t+1}\\,|\\,Y_t, X_t)$。响应过程的演化由以下公式给出：\n$$\nY_{t+1} = a\\,Y_t + b\\,X_t + \\epsilon_t\n$$\n当我们以 $Y_t$ 和 $X_t$ 为条件时，$a\\,Y_t$ 和 $b\\,X_t$ 项成为已知常数。$Y_{t+1}$ 中唯一剩下的不确定性来源是噪声项 $\\epsilon_t$。问题指出 $\\epsilon_t \\sim \\mathcal{N}(0, \\sigma_Y^2)$ 独立于 $(X_t, Y_t)$。因此，$Y_{t+1}$ 在给定 $Y_t$ 和 $X_t$ 条件下的分布是一个以 $a\\,Y_t + b\\,X_t$ 为中心、方差等于 $\\epsilon_t$ 方差的高斯分布。\n$$\n\\mathrm{Var}(Y_{t+1}\\,|\\,Y_t, X_t) = \\mathrm{Var}(a\\,Y_t + b\\,X_t + \\epsilon_t \\,|\\,Y_t, X_t) = \\mathrm{Var}(\\epsilon_t) = \\sigma_Y^2\n$$\n相应的条件熵为：\n$$\nh(Y_{t+1}\\,|\\,Y_t, X_t) = \\frac{1}{2}\\ln\\left( 2\\pi e \\sigma_Y^2 \\right)\n$$\n接下来，我们计算 $h(Y_{t+1}\\,|\\,Y_t)$。我们再次使用过程定义：\n$$\nY_{t+1} = a\\,Y_t + b\\,X_t + \\epsilon_t\n$$\n当我们仅以 $Y_t$ 为条件时，$a\\,Y_t$ 项是一个已知常数，但 $b\\,X_t$ 和 $\\epsilon_t$ 仍然是随机变量。问题陈述了：\n1. $X_t$ 独立于响应过程，这意味着 $X_t$ 独立于 $Y_t$。\n2. $\\epsilon_t$ 独立于 $Y_t$。\n3. $X_t$ 独立于所有噪声，这意味着 $X_t$ 独立于 $\\epsilon_t$。\n\n根据这些独立性性质，条件方差是独立随机分量方差的总和：\n$$\n\\mathrm{Var}(Y_{t+1}\\,|\\,Y_t) = \\mathrm{Var}(a\\,Y_t + b\\,X_t + \\epsilon_t \\,|\\,Y_t) = \\mathrm{Var}(b\\,X_t + \\epsilon_t)\n$$\n$$\n\\mathrm{Var}(Y_{t+1}\\,|\\,Y_t) = \\mathrm{Var}(b\\,X_t) + \\mathrm{Var}(\\epsilon_t) = b^2\\mathrm{Var}(X_t) + \\mathrm{Var}(\\epsilon_t)\n$$\n代入给定的方差 $\\mathrm{Var}(X_t) = \\sigma_X^2$ 和 $\\mathrm{Var}(\\epsilon_t) = \\sigma_Y^2$，我们得到：\n$$\n\\mathrm{Var}(Y_{t+1}\\,|\\,Y_t) = b^2\\sigma_X^2 + \\sigma_Y^2\n$$\n相应的条件熵为：\n$$\nh(Y_{t+1}\\,|\\,Y_t) = \\frac{1}{2}\\ln\\left( 2\\pi e (b^2\\sigma_X^2 + \\sigma_Y^2) \\right)\n$$\n请注意，平稳性条件 $|a|<1$ 确保了 $Y_t$ 的无条件方差是有限的，从而使过程表现良好，但它并不直接进入传递熵的计算。传递熵是在给定接收者当前状态的条件下，从一个时间步到下一个时间步的预测信息增益的度量。\n\n最后，我们将两个熵表达式代回 $T_{X\\to Y}$ 的公式中：\n$$\nT_{X\\to Y} = h(Y_{t+1}\\,|\\,Y_t) - h(Y_{t+1}\\,|\\,Y_t, X_t)\n$$\n$$\nT_{X\\to Y} = \\frac{1}{2}\\ln\\left( 2\\pi e (b^2\\sigma_X^2 + \\sigma_Y^2) \\right) - \\frac{1}{2}\\ln\\left( 2\\pi e \\sigma_Y^2 \\right)\n$$\n使用对数性质 $\\ln(A) - \\ln(B) = \\ln(A/B)$，我们简化表达式：\n$$\nT_{X\\to Y} = \\frac{1}{2}\\left[ \\ln\\left( 2\\pi e (b^2\\sigma_X^2 + \\sigma_Y^2) \\right) - \\ln\\left( 2\\pi e \\sigma_Y^2 \\right) \\right]\n$$\n$$\nT_{X\\to Y} = \\frac{1}{2}\\ln\\left( \\frac{2\\pi e (b^2\\sigma_X^2 + \\sigma_Y^2)}{2\\pi e \\sigma_Y^2} \\right)\n$$\n$$\nT_{X\\to Y} = \\frac{1}{2}\\ln\\left( \\frac{b^2\\sigma_X^2 + \\sigma_Y^2}{\\sigma_Y^2} \\right)\n$$\n这可以写成一种更易于解释的形式，类似于带有信噪比的高斯信道的容量：\n$$\nT_{X\\to Y} = \\frac{1}{2}\\ln\\left( 1 + \\frac{b^2\\sigma_X^2}{\\sigma_Y^2} \\right)\n$$\n这就是从 $X$ 到 $Y$ 的传递熵的最终解析表达式，单位为奈特。",
            "answer": "$$\n\\boxed{\\frac{1}{2}\\ln\\left(1 + \\frac{b^2\\sigma_X^2}{\\sigma_Y^2}\\right)}\n$$"
        },
        {
            "introduction": "一个常见的误区是混淆传递熵与简单的相关性。本练习旨在通过分析一个具有强瞬时相关但没有实际跨时信息传递的系统来强化这两者之间的区别。通过证明在这种情况下滞后传递熵为零，您将巩固对传递熵作为一种预测性信息流而非仅仅是统计关联的度量的理解。",
            "id": "4312449",
            "problem": "考虑两个标量离散时间过程 $\\{X_t\\}_{t\\in\\mathbb{Z}}$ 和 $\\{U_t\\}_{t\\in\\mathbb{Z}}$，它们都是独立的零均值高斯白噪声，并且在时间上是独立的，其方差分别为 $\\operatorname{Var}(X_t)=\\sigma_X^2>0$ 和 $\\operatorname{Var}(U_t)=\\sigma_U^2>0$。通过瞬时混合定义一个观测过程\n$$\nY_t=\\alpha X_t+\\beta U_t,\n$$\n其中 $\\alpha,\\beta$ 是固定的实系数。除了在同一时间 $t$ 的瞬时贡献外，没有任何机制能使 $X_t$ 或 $U_t$ 的任何滞后值直接影响 $Y_t$。当 $|\\alpha|$ 相对于 $|\\beta|$ 较大时，$X_t$ 和 $Y_t$ 之间零滞后的皮尔逊相关系数很高，然而其时间演化过程中不包含从 $X$到 $Y$ 的延迟耦合。\n\n仅使用第一性原理和传递熵（TE）作为“源的过去传递到目标的现在、超越目标自身过去所含信息的信息量”的标准解释，并采用一步嵌入（即，TE 中使用的“过去”仅包含每个过程紧邻的前一个样本），判断以下哪些陈述是正确的。\n\nA. 每当 $|\\alpha|>0$ 时，$T_{X\\to Y}(1)>0$，因为 $Y_t$ 线性依赖于 $X_t$。\n\nB. 对于所描述的设定，对于任何整数 $\\delta\\ge 1$，$T_{X\\to Y}(\\delta)=0$，即使当 $|\\alpha|>0$ 时 $X_t$ 和 $Y_t$ 之间的零滞后皮尔逊相关不为零。\n\nC. 以目标的一步过去为条件并不能消除瞬时混合；因此，在任何情况下 $T_{X\\to Y}(1)$ 都必须不为零。\n\nD. 当 $|\\alpha|>0$ 且 $\\sigma_U^2>0$ 时，零延迟量 $T_{X\\to Y}(0)$ 严格为正，并且仅当 $\\alpha=0$ 时（保持 $\\sigma_U^2>0$ 固定）其值才为 $0$。\n\nE. 如果 $\\beta=0$，那么 $Y_t=\\alpha X_t$，因此 $T_{X\\to Y}(1)$ 变为正值。\n\n选择所有正确的选项。",
            "solution": "### 解题步骤\n\n#### 1. 理解传递熵的定义\n本题要求评估滞后为 $\\delta$ 的传递熵 $T_{X\\to Y}(\\delta)$。根据问题描述，我们采用一步嵌入，这意味着我们将考虑从 $X$ 在 $t-\\delta$ 时刻的状态到 $Y$ 在 $t$ 时刻的状态的信息流，并以 $Y$ 在 $t-1$ 时刻的状态为条件。因此，传递熵的定义为：\n$$ T_{X\\to Y}(\\delta) = I(Y_t; X_{t-\\delta} | Y_{t-1}) $$\n当且仅当在已知 $Y_{t-1}$ 的情况下，$X_{t-\\delta}$ 仍然为 $Y_t$ 提供了额外信息时，该值为正。\n\n#### 2. 分析系统的依赖关系\n系统的核心方程是 $Y_t = \\alpha X_t + \\beta U_t$。\n关键已知条件是：\n- $\\{X_t\\}$ 和 $\\{U_t\\}$ 都是白噪声过程。这意味着在任何时刻 $t$ 的值 $X_t$（或 $U_t$）都与它在所有其他时刻 $s \\neq t$ 的值 $X_s$（或 $U_s$）统计独立。\n- $\\{X_t\\}$ 和 $\\{U_t\\}$ 相互独立。\n\n基于这些条件，我们来分析 $Y_t$ 的依赖性：\n- $Y_t$ 的值完全由**同一时刻**的 $X_t$ 和 $U_t$ 决定。\n- 由于 $X_t$ 和 $U_t$ 是白噪声，它们在时刻 $t$ 的值独立于所有过去的值（如 $X_{t-1}, U_{t-1}, X_{t-\\delta}$ 等）。\n- 因此，$Y_t$ 统计独立于所有过去的过程值，包括 $X_{t-1}, Y_{t-1}, X_{t-\\delta}$ 等。\n\n用概率语言来说，对于任何 $\\delta \\ge 1$：\n$$ p(Y_t | Y_{t-1}, X_{t-\\delta}) = p(Y_t) $$\n因为 $Y_t$ 的值仅取决于当前的随机变量 $X_t, U_t$，而这两个变量都独立于过去的任何信息。\n\n#### 3. 评估每个选项\n\n**选项 B: 对于所描述的设定，对于任何整数 $\\delta\\ge 1$，$T_{X\\to Y}(\\delta)=0$，即使当 $|\\alpha|>0$ 时 $X_t$ 和 $Y_t$ 之间的零滞后皮尔逊相关不为零。**\n我们来计算 $T_{X\\to Y}(\\delta)$：\n$$ T_{X\\to Y}(\\delta) = I(Y_t; X_{t-\\delta} | Y_{t-1}) = H(Y_t | Y_{t-1}) - H(Y_t | Y_{t-1}, X_{t-\\delta}) $$\n由于 $Y_t$ 独立于 $Y_{t-1}$ 和 $X_{t-\\delta}$，我们有：\n- $H(Y_t | Y_{t-1}) = H(Y_t)$\n- $H(Y_t | Y_{t-1}, X_{t-\\delta}) = H(Y_t)$\n因此，$T_{X\\to Y}(\\delta) = H(Y_t) - H(Y_t) = 0$。\n这个结论对所有 $\\delta \\ge 1$ 都成立。同时，如果 $\\alpha \\neq 0$，$X_t$ 和 $Y_t = \\alpha X_t + \\beta U_t$ 之间存在瞬时相关性。这表明了传递熵（衡量预测信息流）和相关性（衡量瞬时关联）之间的关键区别。\n**结论：选项 B 正确。**\n\n**选项 A: 每当 $|\\alpha|>0$ 时，$T_{X\\to Y}(1)>0$，因为 $Y_t$ 线性依赖于 $X_t$。**\n$Y_t$ 对 $X_t$ 的依赖是**瞬时**的，不是滞后的。如上所述，$T_{X\\to Y}(1)=0$。该陈述混淆了瞬时相关和滞后信息传递。\n**结论：选项 A 错误。**\n\n**选项 C: 以目标的一步过去为条件并不能消除瞬时混合；因此，在任何情况下 $T_{X\\to Y}(1)$ 都必须不为零。**\n虽然条件化确实不能消除瞬时混合，但这与 $T_{X\\to Y}(1)$ 的值无关。$T_{X\\to Y}(1)$ 衡量的是来自 $X_{t-1}$ 的信息，而不是来自 $X_t$ 的信息。由于系统中没有从 $X_{t-1}$ 到 $Y_t$ 的路径，所以传递熵为零。\n**结论：选项 C 错误。**\n\n**选项 D: 当 $|\\alpha|>0$ 且 $\\sigma_U^2>0$ 时，零延迟量 $T_{X\\to Y}(0)$ 严格为正，并且仅当 $\\alpha=0$ 时（保持 $\\sigma_U^2>0$ 固定）其值才为 $0$。**\n尽管“零延迟传递熵”不是标准术语，但通常它被解释为 $I(Y_t; X_t | Y_{t-1})$。\n$$ T_{X\\to Y}(0) = I(Y_t; X_t | Y_{t-1}) = H(Y_t | Y_{t-1}) - H(Y_t | Y_{t-1}, X_t) $$\n- $H(Y_t | Y_{t-1}) = H(Y_t) = H(\\alpha X_t + \\beta U_t)$。由于 $X_t, U_t$ 是独立高斯变量，其线性组合也是高斯变量，方差为 $\\alpha^2\\sigma_X^2 + \\beta^2\\sigma_U^2$。所以 $H(Y_t|Y_{t-1}) = \\frac{1}{2}\\ln(2\\pi e(\\alpha^2\\sigma_X^2 + \\beta^2\\sigma_U^2))$。\n- $H(Y_t | Y_{t-1}, X_t) = H(\\alpha X_t + \\beta U_t | Y_{t-1}, X_t)$。在给定 $X_t$ 的条件下，该熵只剩下 $\\beta U_t$ 的不确定性。由于 $U_t$ 独立于所有其他变量，这等于 $H(\\beta U_t) = \\frac{1}{2}\\ln(2\\pi e(\\beta^2\\sigma_U^2))$。\n- 因此，$T_{X\\to Y}(0) = \\frac{1}{2}\\ln\\left(\\frac{\\alpha^2\\sigma_X^2 + \\beta^2\\sigma_U^2}{\\beta^2\\sigma_U^2}\\right) = \\frac{1}{2}\\ln\\left(1 + \\frac{\\alpha^2\\sigma_X^2}{\\beta^2\\sigma_U^2}\\right)$。\n当 $|\\alpha|>0, \\sigma_X^2>0, \\beta\\neq0, \\sigma_U^2>0$ 时，该值严格为正。当 $\\alpha=0$ 时，它变为 $\\frac{1}{2}\\ln(1)=0$。\n**结论：选项 D 正确。**\n\n**选项 E: 如果 $\\beta=0$，那么 $Y_t=\\alpha X_t$，因此 $T_{X\\to Y}(1)$ 变为正值。**\n如果 $\\beta=0$ 且 $\\alpha \\neq 0$（不妨设 $\\alpha=1$），则 $Y_t = X_t$。那么 $T_{X\\to Y}(1) = I(X_t; X_{t-1} | X_{t-1})$。根据条件互信息的性质，$I(A; B | B) = H(A|B) - H(A|B,B) = H(A|B) - H(A|B) = 0$。因此 $T_{X\\to Y}(1)=0$。$X$ 是白噪声，其过去状态不包含任何关于其现在状态的信息。\n**结论：选项 E 错误。**\n\n#### 最终答案\n正确的选项是 B 和 D。",
            "answer": "$$\\boxed{BD}$$"
        },
        {
            "introduction": "在实际应用中，计算出一个传递熵值只是第一步；我们还必须确定它是否具有统计显著性。本练习将指导您设计一个非参数置换检验，以生成传递熵的零分布。至关重要的是，它也促使您思考在处理非平稳数据时此方法的局限性，这是分析复杂系统时的一个常见挑战。",
            "id": "4312527",
            "problem": "考虑在 $T$ 个时间点上观测到的两个离散时间随机过程 $\\{X_t\\}_{t=1}^T$ 和 $\\{Y_t\\}_{t=1}^T$。目标是通过非参数检验来评估从 $X_t$ 的过去到 $Y_t$ 的下一个值，在以 $Y_t$ 的过去为条件的定向信息流是否具有统计显著性。转移熵 $T_{X\\to Y}$ 是一种有向度量，可以概念化为在给定 $Y_t$ 过去的情况下，从 $X_t$ 的过去到 $Y_t$ 下一个值的条件互依赖性，这与 Shannon 熵框架一致。置换检验要求在零假设 $\\mathcal{H}_0$ 下满足可交换性条件，以证明通过对观测数据进行变换生成的代理数据是来自检验统计量的零分布的样本。\n\n在零假设 $\\mathcal{H}_0$（即除了 $Y_t$ 的过去所能解释的部分之外，$X_t$ 对 $Y_t$ 没有定向影响）下，设计一个针对 $T_{X\\to Y}$ 的有效置换检验，并明确说明置换有效的假设条件。然后，分析所提出的检验对于非平稳数据是否仍然有效，并解释其任何局限性。选择最准确地指定了正确的置换检验机制及其局限性的选项。\n\nA. 在 $\\mathcal{H}_0$ 下，假设联合过程是弱平稳和遍历的，并且 $X_t$ 的过去相对于 $\\{Y_t\\}$ 的对齐是可交换的。通过将整个序列 $\\{X_t\\}$ 以从 $\\{1,2,\\dots,T-1\\}$ 中均匀抽样的随机延迟 $L$ 进行循环移位，形成 $\\{\\tilde{X}_t\\}=\\{X_{t+L \\bmod T}\\}$，同时保持 $\\{Y_t\\}$ 不变，来生成代理数据。这保留了 $\\{X_t\\}$ 的边际分布和自相关性以及 $\\{Y_t\\}$ 的完整时间结构，但破坏了 $X_t$ 和 $Y_t$ 之间的时间对齐。计算观测数据和许多独立代理数据上的 $T_{X\\to Y}$ 以近似零分布，并通过转移熵至少与观测值一样大的代理数据的比例来估计单边 $p$ 值。该检验依赖于 $\\mathcal{H}_0$ 下 $X_t$ 对齐的平稳性和可交换性。对于具有趋势、季节性模式或结构性断点的非平稳数据，循环移位会混合不同的模式并违反可交换性，可能导致 I 型错误膨胀或掩盖真实效应；因此，应将置换限制在平稳段内，使用限于同质模式的分块移位，或采用时间局域转移熵，否则该检验无效。\n\nB. 在 $\\mathcal{H}_0$ 下，假设 $Y_t$ 的过去是可交换的。通过随机置换 $\\{Y_t\\}$ 的索引同时保持 $\\{X_t\\}$ 不变来生成代理数据，从而破坏 $Y_t$ 的时间顺序。在每个代理数据上计算转移熵，并与观测值比较以获得 $p$ 值。这个过程即使对于非平稳数据也有效，因为置换 $\\{Y_t\\}$ 消除了可能使检验产生偏差的时间伪影，因此可以稳健地控制 I 型错误。\n\nC. 在 $\\mathcal{H}_0$ 下，用一个独立的、方差与 $X_t$ 相匹配的高斯白噪声过程 $\\{\\epsilon_t\\}$ 替换 $\\{X_t\\}$，并计算 $\\{\\epsilon_t\\}$ 和 $\\{Y_t\\}$ 之间的转移熵。用多个独立的噪声实现重复此过程以获得零分布。只要代理数据中保留了 $X_t$ 的边际分布，该过程就有效，并且由于高斯噪声对 $Y_t$ 没有定向影响，它对于非平稳数据也仍然有效。\n\nD. 在 $\\mathcal{H}_0$ 下，假设数据对 $(X_t,Y_t)$ 作为独立同分布的样本是可交换的。通过联合置换配对观测的索引 $t$ 来生成代理数据，从而破坏时间顺序但保留瞬时联合分布。在每个代理数据上计算转移熵，并与观测值比较以获得 $p$ 值。这在存在非平稳性的情况下保持了有效性，因为保留联合分布消除了由时变行为引起的虚假方向性。\n\n选择最佳选项。",
            "solution": "题目要求设计一个有效的非参数置换检验，以评估从过程 $\\{X_t\\}$ 到另一个过程 $\\{Y_t\\}$ 的转移熵 $T_{X \\to Y}$ 的统计显著性。该检验必须适用于零假设 $\\mathcal{H}_0$，即在以 $Y_t$ 的过去为条件下，从 $X_t$ 的过去到 $Y_t$ 的未来没有定向信息流。我们还必须分析所提出的检验在非平稳性下的有效性。\n\n首先，让我们形式化地定义转移熵。对于两个离散时间随机过程 $\\{X_t\\}$ 和 $\\{Y_t\\}$，从 $X$ 到 $Y$ 的转移熵定义为条件互信息：\n$$ T_{X \\to Y} = I(Y_{t+1}; X_t^{(l)} | Y_t^{(k)}) $$\n其中 $X_t^{(l)} = (X_t, X_{t-1}, \\dots, X_{t-l+1})$ 和 $Y_t^{(k)} = (Y_t, Y_{t-1}, \\dots, Y_{t-k+1})$ 分别表示长度为 $l$ 和 $k$ 的过程的过去状态（历史）。用 Shannon 熵表示，即为：\n$$ T_{X \\to Y} = H(Y_{t+1} | Y_t^{(k)}) - H(Y_{t+1} | Y_t^{(k)}, X_t^{(l)}) $$\n这量化了在已知 $Y$ 的历史 $Y_t^{(k)}$ 的情况下，通过了解 $X$ 的历史 $X_t^{(l)}$，关于 $Y$ 的下一个状态 $Y_{t+1}$ 的不确定性的减少量。\n\n零假设 $\\mathcal{H}_0$ 是 $T_{X \\to Y} = 0$，这等价于条件独立性陈述：\n$$ \\mathcal{H}_0: Y_{t+1} \\perp X_t^{(l)} | Y_t^{(k)} $$\n这意味着 $Y$ 过程的转移概率不依赖于 $X$ 过程的历史，即 $p(y_{t+1} | y_t^{(k)}, x_t^{(l)}) = p(y_{t+1} | y_t^{(k)})$。\n\n针对 $\\mathcal{H}_0$ 的置换检验必须生成符合此零假设的代理数据集，同时保留原始数据的其他统计特性。核心原则是仅破坏正在检验的特定关系。在本例中，我们必须打破 $X$ 的历史和 $Y$ 的未来之间的特定时间对齐，而 $T_{X \\to Y}$ 正是依赖于这种对齐。\n\n为了正确构建检验统计量 $T_{X \\to Y}$ 的零分布，我们必须保留：\n1.  过程 $\\{Y_t\\}$ 的内部动力学（自相关结构）。该结构决定了由项 $H(Y_{t+1} | Y_t^{(k)})$ 所捕获的基线可预测性。\n2.  过程 $\\{X_t\\}$ 的内部动力学（自相关结构）。该结构决定了预测变量历史 $X_t^{(l)}$ 的统计特性。\n\n一个有效的代理生成方案包括保持时间序列 $\\{Y_t\\}$ 完整，并操纵 $\\{X_t\\}$ 以打破其与 $\\{Y_t\\}$ 的方向性关系。一种标准且有效的方法是通过将原始序列 $\\{X_t\\}$ 进行随机延迟 $L$ 的循环移位来创建代理序列 $\\{\\tilde{X}_t\\}$，其中 $L$ 从 $\\{1, 2, \\dots, T-1\\}$ 中均匀选择。即 $\\tilde{X}_t = X_{(t+L-1 \\pmod T) + 1}$。这个过程打破了 $X$ 的历史和 $Y$ 的未来之间特定时间的对齐，从而有效地模拟了 $\\mathcal{H}_0$ 所要求的条件独立性。至关重要的是，循环移位完美地保留了 $\\{X_t\\}$ 的自相关结构（以及功率谱）。通过为许多这样的代理数据计算 $T_{\\tilde{X}\\to Y}$，我们可以构建一个经验零分布。\n\n这种移位过程的有效性依赖于 **平稳性** 的假设。如果联合过程 $(X_t, Y_t)$ 是平稳的，那么在 $\\mathcal{H}_0$ 下，系统的统计特性对于两个序列之间的相对时间移位是不变的。这提供了置换检验所需的可交换性条件：在零假设下，$\\{X_t\\}$ 相对于 $\\{Y_t\\}$ 的任何对齐（除了原始对齐）都是等概率的。\n\n如果数据是 **非平稳的**（例如，包含趋势、季节性或模式变化），则此过程无效。循环移位会使这些非平稳特征错位。例如，它可能会将 $\\{X_t\\}$ 的高值段与 $\\{Y_t\\}$ 的低值段对齐，从而产生不反映零假设的虚假统计关系。这会污染零分布，导致不可靠的 $p$ 值，并常常导致 I 型错误率的高度膨胀。为了处理非平稳性，必须使用更高级的技术，例如将置换限制在局部平稳块内（分块置换）或将检验应用于预处理过的平稳数据。\n\n现在，我们基于此框架评估给定的选项。\n\n**选项 A：** 该选项建议通过随机延迟循环移位整个序列 $\\{X_t\\}$ 同时保持 $\\{Y_t\\}$ 不变来生成代理数据。它正确地指出，这保留了 $\\{X_t\\}$ 的自相关性和 $\\{Y_t\\}$ 的完整结构，同时打破了它们的时间对齐。它正确地识别了平稳性和遍历性的基本假设。此外，它准确地描述了对非平稳数据的局限性，指出循环移位会混合不同的模式并使检验无效，并且它正确地提出了适当的补救措施，如分块移位或时间局域分析。这一描述完全符合检验转移熵的既定统计方法论。\n**结论：正确**\n\n**选项 B：** 该选项建议随机置换 $\\{Y_t\\}$ 的索引，从而破坏其时间顺序。这在根本上是有缺陷的。转移熵统计量 $T_{X \\to Y}$ 通过条件熵项 $H(Y_{t+1}|Y_t^{(k)})$ 关键地依赖于 $\\{Y_t\\}$ 内部的时间结构。通过破坏 $Y$ 的自相关性，此过程改变了所测量量的一个基本组成部分。产生的零分布将不是针对 $T_{X\\to Y}$ 的，而是针对结构上不同的过程的某个其他统计量的。声称这对非平稳数据有效是错误的；它对任何具有时间依赖性的数据都使检验无效。\n**结论：不正确**\n\n**选项 C：** 该选项建议用方差匹配的高斯白噪声过程 $\\{\\epsilon_t\\}$ 替换 $\\{X_t\\}$。这不是一个非参数置换检验，而是一个参数化自举法 (parametric bootstrap)。它强加了 $\\{X_t\\}$ 是高斯白噪声的强有力且未经证实的假设。此过程未能保留原始 $\\{X_t\\}$ 过程的真实边际分布，更重要的是，未能保留其自相关结构。真实 $\\{X_t\\}$ 与高斯白噪声的任何偏差（例如，存在自相关或非高斯性）都会使零分布不正确。因此，该方法通常无效。\n**结论：不正确**\n\n**选项 D：** 该选项建议联合置换数据对 $(X_t, Y_t)$ 的时间索引。此过程破坏了数据中的所有时间结构，包括 $\\{X_t\\}$ 和 $\\{Y_t\\}$ 内部的自相关以及所有滞后交叉相关。它检验的是序列对 $\\{(X_t, Y_t)\\}$ 是独立同分布（i.i.d.）的零假设。这是一个比转移熵所针对的零假设强得多的假设。原始数据中的任何时间依赖性都会导致拒绝，使得无法分离出从 $X$ 到 $Y$ 的特定方向性影响。该检验将对任何自相关敏感，而不仅仅是定向的条件影响。\n**结论：不正确**\n\n总之，选项 A 提供了检验转移熵显著性的有效置换方案的最准确和完整的描述，正确地指出了其基本假设及其在存在非平稳性时的局限性。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}