{
    "hands_on_practices": [
        {
            "introduction": "评估流行病风险的一个基本方法是通过网络邻接矩阵的谱半径。这个练习  提供了一个具体的编程挑战：你将实现一个基于度值的靶向免疫策略，并直接观察它对流行病阈值的影响。通过这个练习，你将把理论（即基于 $\\lambda_1$ 的临界条件）与实际的算法实现联系起来，从而加深对中心节点移除如何有效抑制流行病传播的理解。",
            "id": "4306970",
            "problem": "给定一个无向简单网络，由邻接矩阵 $A \\in \\{0,1\\}^{n \\times n}$ 表示，其中 $A$ 是对称的，且对于所有 $i$，$A_{ii} = 0$。考虑一个易感-感染-易感（SIS）流行病过程，其感染率为 $\\beta$，恢复率为 $\\mu$。一个经过充分检验并广泛使用的平均场阈值条件将残余邻接矩阵 $A_{\\text{res}}$（免疫后得到）的谱半径（最大特征值）$\\lambda_1(A_{\\text{res}})$ 与无量纲比率 $\\beta/\\mu$ 联系起来，指出当条件 $(\\beta/\\mu)  1/\\lambda_1(A_{\\text{res}})$ 成立时，疫情会消亡。\n\n对中心节点的靶向免疫按以下方式实施。定义节点 $i$ 的度为 $k_i = \\sum_{j=1}^{n} A_{ij}$。按度的非递增顺序对节点进行排序：$k_i$ 较大的节点排在 $k_i$ 较小的节点之前，度相同时，按节点索引升序确定性地排序（即，如果 $k_p = k_q$ 且 $p  q$，则节点 $p$ 排在节点 $q$ 之前）。对于一个整数 $m$（$0 \\le m \\le n$），对此排序中的前 $m$ 个节点进行免疫，这定义为从 $A$ 中删除相应的 $m$ 行和 $m$ 列。残余邻接矩阵 $A_{\\text{res}}$ 是由剩余的、未免疫的节点索引的 $A$ 的主子矩阵。如果 $m = n$，则残余邻接矩阵 $A_{\\text{res}}$ 为空矩阵，按照约定，其最大特征值取为 $\\lambda_1(A_{\\text{res}}) = 0$。\n\n您的任务是编写一个程序，为每个提供的测试用例，确定最小整数 $m$，使得在按照上述基于度的排序对前 $m$ 个节点进行免疫时，严格不等式 $1/\\lambda_1(A_{\\text{res}}) > \\beta/\\mu$ 得到满足。如果 $m = 0$ 时不等式已满足，则最小 $m$ 为 $0$。如果需要免疫所有 $n$ 个节点，则最小 $m$ 为 $n$，此时不等式成立，因为当 $\\lambda_1(A_{\\text{res}}) = 0$ 且 $\\beta/\\mu$ 为有限正数时，$1/\\lambda_1(A_{\\text{res}})$ 被解释为 $+\\infty$。\n\n输入是隐式的：您的程序必须使用以下邻接矩阵 $A$（节点索引从 $0$ 到 $n-1$）和比率 $\\beta/\\mu$ 的测试套件。每个邻接矩阵以一个值为 $\\{0,1\\}$ 的列表的列表形式给出，每个比率是一个正实数。\n\n- 测试用例 $1$（一个包含 $5$ 个节点的路径，边为 $(0,1)$, $(1,2)$, $(2,3)$, $(3,4)$），$\\beta/\\mu = 0.5$：\n  $$\n  A = \\begin{bmatrix}\n  0  1  0  0  0 \\\\\n  1  0  1  0  0 \\\\\n  0  1  0  1  0 \\\\\n  0  0  1  0  1 \\\\\n  0  0  0  1  0\n  \\end{bmatrix}\n  $$\n- 测试用例 $2$（一个包含 $6$ 个节点的星形图，中心节点 $0$ 连接到节点 $1,2,3,4,5$），$\\beta/\\mu = 0.6$：\n  $$\n  A = \\begin{bmatrix}\n  0  1  1  1  1  1 \\\\\n  1  0  0  0  0  0 \\\\\n  1  0  0  0  0  0 \\\\\n  1  0  0  0  0  0 \\\\\n  1  0  0  0  0  0 \\\\\n  1  0  0  0  0  0\n  \\end{bmatrix}\n  $$\n- 测试用例 $3$（一个包含 $4$ 个节点的完全图），$\\beta/\\mu = 0.8$：\n  $$\n  A = \\begin{bmatrix}\n  0  1  1  1 \\\\\n  1  0  1  1 \\\\\n  1  1  0  1 \\\\\n  1  1  1  0\n  \\end{bmatrix}\n  $$\n- 测试用例 $4$（一个包含 $6$ 个节点的环，对于 $i \\in \\{0,1,2,3,4,5\\}$，边为 $(i,(i+1)\\bmod 6)$），$\\beta/\\mu = 0.9$：\n  $$\n  A = \\begin{bmatrix}\n  0  1  0  0  0  1 \\\\\n  1  0  1  0  0  0 \\\\\n  0  1  0  1  0  0 \\\\\n  0  0  1  0  1  0 \\\\\n  0  0  0  1  0  1 \\\\\n  1  0  0  0  1  0\n  \\end{bmatrix}\n  $$\n- 测试用例 $5$（一个包含 $3$ 个节点的完全图），$\\beta/\\mu = 0.5$：\n  $$\n  A = \\begin{bmatrix}\n  0  1  1 \\\\\n  1  0  1 \\\\\n  1  1  0\n  \\end{bmatrix}\n  $$\n\n您的程序必须为每个测试用例计算满足 $1/\\lambda_1(A_{\\text{res}}) > \\beta/\\mu$ 的最小整数 $m$，其中采用上述定义的靶向免疫规则。对于 $\\lambda_1(A_{\\text{res}})$ 的数值计算，邻接矩阵是对称且实数的；请使用适用于对称矩阵的方法。如果 $A_{\\text{res}}$ 是空矩阵（即所有节点都被免疫），则定义 $\\lambda_1(A_{\\text{res}}) = 0$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其顺序与测试用例的顺序相同，例如 $[m_1,m_2,m_3,m_4,m_5]$。输出为整数，不涉及物理单位。",
            "solution": "该问题要求根据给定的阈值条件，在网络中为抑制疫情所需免疫的最小节点数 $m$。免疫策略是靶向性的，优先考虑度最高的节点。\n\n问题的核心在于流行病根除的条件，该条件由网络上的易感-感染-易感（SIS）过程的平均场理论给出。该条件指出，如果有效传播率小于1，疫情将会消亡。这可以转化为不等式：\n$$\n\\frac{\\beta}{\\mu} \\lambda_1(A_{\\text{res}})  1\n$$\n其中 $\\beta$ 是感染率，$\\mu$ 是恢复率，$\\lambda_1(A_{\\text{res}})$ 是免疫后残余网络的邻接矩阵 $A_{\\text{res}}$ 的谱半径（最大特征值）。问题陈述以等价的形式给出了这个严格不等式：\n$$\n\\frac{1}{\\lambda_1(A_{\\text{res}})} > \\frac{\\beta}{\\mu}\n$$\n这可以重排成一个计算上更方便的形式。设 $\\tau = \\beta/\\mu$ 为给定比率。我们正在寻找最小的 $m$，使得：\n$$\n\\lambda_1(A_{\\text{res}})  \\frac{1}{\\tau} \\quad \\text{或} \\quad \\lambda_1(A_{\\text{res}})  \\frac{\\mu}{\\beta}\n$$\n我们将谱半径的阈值定义为 $\\lambda_{\\text{th}} = \\mu / \\beta$。我们的目标是找到最小的整数 $m \\in \\{0, 1, \\dots, n\\}$，使得 $\\lambda_1(A_{\\text{res}})  \\lambda_{\\text{th}}$。\n\n对于给定的网络 $A$ 和比率 $\\tau = \\beta/\\mu$，确定最小 $m$ 的过程遵循一个清晰的算法步骤。我们必须从 $m=0$ 开始，遍历 $m$ 的可能值，并对每个 $m$ 检查条件是否满足。第一个满足条件的 $m$ 值就是最小值。\n\n每个测试用例的步骤如下：\n1.  **免疫的节点排序**：首先，我们必须建立免疫的优先顺序。该顺序基于节点度，这是一个衡量节点连通性的指标。\n    a.  对于网络中的每个节点 $i$（索引从 $0$ 到 $n-1$），计算其度 $k_i$，即邻接矩阵 $A$ 的第 $i$ 行（或列）的元素之和：$k_i = \\sum_{j=0}^{n-1} A_{ij}$。\n    b.  创建一个包含所有节点索引 $\\{0, 1, \\dots, n-1\\}$ 的列表。\n    c.  按度的非递增顺序对此节点列表进行排序。\n    d.  根据问题的规则，任何度的相同情况都通过按节点原始索引升序排序来解决。这为免疫创建了一个唯一的、确定性的节点排序。\n\n2.  **迭代搜索最小 $m$**：我们通过从 $m=0$ 到 $m=n$ 顺序检查数值来搜索最小的免疫节点数 $m$。\n    a.  循环从 $m=0$ 开始，代表没有免疫的情况。\n    b.  对于给定的 $m$，我们确定要免疫的节点集合。该集合由步骤1中确定的排序列表中的前 $m$ 个节点组成。剩下的 $n-m$ 个节点构成残余网络。\n    c.  构建残余邻接矩阵 $A_{\\text{res}}$。这是通过选择仅对应于未免疫（残余）节点的行和列而形成的原始矩阵 $A$ 的主子矩阵。\n    d.  计算此残余矩阵的谱半径 $\\lambda_1(A_{\\text{res}})$。\n        i.  如果 $m=n$，所有节点都被免疫。残余网络为空。根据问题的约定，空矩阵的谱半径为 $\\lambda_1(A_{\\text{res}}) = 0$。\n        ii. 如果 $0 \\le m  n$，残余网络非空。由于原始邻接矩阵 $A$ 是实数且对称的，任何主子矩阵 $A_{\\text{res}}$ 也是实数且对称的。因此，它的所有特征值都是实数。此外，由于 $A_{\\text{res}}$ 的元素是非负的，根据 Perron-Frobenius 定理，可以保证其谱半径（最大特征值）是实数、非负的，并且等于其最大特征值。我们可以计算所有特征值并找到最大值。\n    e.  将计算出的谱半径 $\\lambda_1(A_{\\text{res}})$ 与阈值 $\\lambda_{\\text{th}} = \\mu/\\beta$ 进行比较。\n    f.  如果条件 $\\lambda_1(A_{\\text{res}})  \\lambda_{\\text{th}}$ 满足，则当前的 $m$ 值是所需的最小免疫数。我们将此值记录为当前测试用例的解，并停止对该用例的搜索。\n    g.  如果条件不满足，我们将 $m$ 增加1，并从步骤2b重复。该过程保证会终止，因为当 $m=n$ 时，$\\lambda_1(A_{\\text{res}}) = 0$，并且由于 $\\beta$ 和 $\\mu$ 是正率，条件 $0  \\lambda_{\\text{th}}$ 将始终为真。\n\n在实现上，我们使用数值库来执行矩阵运算。具体来说，对于给定的 $A_{\\text{res}}$，我们可以使用为实对称矩阵优化的特征值求解器来找到其特征值。这些实数值中的最大值就是谱半径 $\\lambda_1(A_{\\text{res}})$。我们将此系统性过程应用于每个提供的测试用例，以找到相应的最小 $m$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the targeted immunization problem for a given suite of test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1\n        (\n            np.array([\n                [0, 1, 0, 0, 0],\n                [1, 0, 1, 0, 0],\n                [0, 1, 0, 1, 0],\n                [0, 0, 1, 0, 1],\n                [0, 0, 0, 1, 0]\n            ]), \n            0.5\n        ),\n        # Test case 2\n        (\n            np.array([\n                [0, 1, 1, 1, 1, 1],\n                [1, 0, 0, 0, 0, 0],\n                [1, 0, 0, 0, 0, 0],\n                [1, 0, 0, 0, 0, 0],\n                [1, 0, 0, 0, 0, 0],\n                [1, 0, 0, 0, 0, 0]\n            ]), \n            0.6\n        ),\n        # Test case 3\n        (\n            np.array([\n                [0, 1, 1, 1],\n                [1, 0, 1, 1],\n                [1, 1, 0, 1],\n                [1, 1, 1, 0]\n            ]), \n            0.8\n        ),\n        # Test case 4\n        (\n            np.array([\n                [0, 1, 0, 0, 0, 1],\n                [1, 0, 1, 0, 0, 0],\n                [0, 1, 0, 1, 0, 0],\n                [0, 0, 1, 0, 1, 0],\n                [0, 0, 0, 1, 0, 1],\n                [1, 0, 0, 0, 1, 0]\n            ]), \n            0.9\n        ),\n        # Test case 5\n        (\n            np.array([\n                [0, 1, 1],\n                [1, 0, 1],\n                [1, 1, 0]\n            ]), \n            0.5\n        )\n    ]\n\n    results = []\n    \n    for A, beta_mu_ratio in test_cases:\n        # Number of nodes\n        n = A.shape[0]\n        \n        # Calculate the threshold for the spectral radius\n        lambda_threshold = 1.0 / beta_mu_ratio\n        \n        # Step 1: Determine the node ordering for immunization\n        # Calculate degrees\n        degrees = A.sum(axis=1)\n        \n        # Create a list of (degree, index) tuples for sorting\n        nodes_with_degrees = [(degrees[i], i) for i in range(n)]\n        \n        # Sort nodes: primary key is degree (descending), secondary key is index (ascending)\n        nodes_with_degrees.sort(key=lambda x: (-x[0], x[1]))\n        \n        # Get the sorted list of node indices for immunization\n        immunization_order = [node[1] for node in nodes_with_degrees]\n        \n        # Step 2: Iteratively find the minimal m\n        for m in range(n + 1):\n            # Determine the set of residual nodes\n            if m == 0:\n                residual_nodes_indices = list(range(n))\n            else:\n                nodes_to_immunize = set(immunization_order[:m])\n                all_nodes = set(range(n))\n                residual_nodes_indices = sorted(list(all_nodes - nodes_to_immunize))\n\n            # Calculate the spectral radius of the residual matrix\n            num_residual_nodes = len(residual_nodes_indices)\n            \n            if num_residual_nodes == 0:\n                # By convention, if the residual matrix is empty, lambda_1 = 0\n                lambda_1_res = 0.0\n            else:\n                # Construct the residual adjacency matrix A_res\n                A_res = A[np.ix_(residual_nodes_indices, residual_nodes_indices)]\n                \n                # Check for an empty matrix which can occur if num_residual_nodes is 0\n                if A_res.size == 0:\n                    lambda_1_res = 0.0\n                else:\n                    # For a real symmetric matrix, spectral radius is the max eigenvalue\n                    # eigvalsh is optimized for Hermitian (includes real symmetric) matrices\n                    eigenvalues = np.linalg.eigvalsh(A_res)\n                    lambda_1_res = np.max(eigenvalues) if eigenvalues.size  0 else 0.0\n\n            # Check if the condition is met\n            if lambda_1_res  lambda_threshold:\n                results.append(m)\n                break\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "对于像无标度网络这样的特定网络类别，另一种基于度分布矩的强大理论工具也非常有用。这个练习  要求你超越单个具体的网络实例，运用解析方法来计算一个理论网络模型所需的疫苗接种覆盖率。通过解决这个问题，你将深入理解为何靶向免疫策略在异构网络中尤其有效。",
            "id": "4580996",
            "problem": "一家公共卫生机构正计划开展一项靶向疫苗接种运动，以防止一种呼吸道感染在大型城市接触网络中大规模爆发。经验研究表明，该接触网络可以很好地近似为一个无关联的配置模型，其度分布为无标度形式 $P(k) \\propto k^{-\\gamma}$，适用于 $k \\ge k_{\\min}$。假设度指数 $\\gamma = 2.5$，最小度 $k_{\\min} = 1$。感染被建模为网络上的易感-感染-移除（SIR）传播，在整个感染期间，每条边的传播率为 $T = 0.2$。\n\n该机构采用一种靶向策略，为所有度 $k > k_{c}$ 的个体接种疫苗（从而使这些个体得到完全保护并从传播中移除）。使用以下启发式近似：接种疫苗后，未接种疫苗个体的残余网络由在 $k_{c}$ 处截断并在 $k \\in [k_{\\min}, k_{c}]$ 上重新归一化的原始度密度描述。假设网络巨大且无关联，因此树状近似成立。\n\n从“当通过随机边到达的感染者所产生的新感染期望数不大于1时，大规模爆发不会发生”这一基本分支过程准则出发，推导将残余网络恰好置于流行病阈值的临界截断值 $k_{c}$，然后计算相应的临界疫苗接种比例 $f$（接种疫苗的人口比例，即所有度 $k > k_{c}$ 的节点）。将 $f$ 表示为小数，并四舍五入到四位有效数字。",
            "solution": "用户希望我解决以下问题：\n一家公共卫生机构正计划开展一项靶向疫苗接种运动，以防止一种呼吸道感染在大型城市接触网络中大规模爆发。经验研究表明，该接触网络可以很好地近似为一个无关联的配置模型，其度分布为无标度形式 $P(k) \\propto k^{-\\gamma}$，适用于 $k \\ge k_{\\min}$。假设度指数 $\\gamma = 2.5$，最小度 $k_{\\min} = 1$。感染被建模为网络上的易感-感染-移除（SIR）传播，在整个感染期间，每条边的传播率为 $T = 0.2$。\n\n该机构采用一种靶向策略，为所有度 $k > k_{c}$ 的个体接种疫苗（从而使这些个体得到完全保护并从传播中移除）。使用以下启发式近似：接种疫苗后，未接种疫苗个体的残余网络由在 $k_{c}$ 处截断并在 $k \\in [k_{\\min}, k_{c}]$ 上重新归一化的原始度密度描述。假设网络巨大且无关联，因此树状近似成立。\n\n从“当通过随机边到达的感染者所产生的新感染期望数不大于1时，大规模爆发不会发生”这一基本分支过程准则出发，推导将残余网络恰好置于流行病阈值的临界截断值 $k_{c}$，然后计算相应的临界疫苗接种比例 $f$（接种疫苗的人口比例，即所有度 $k > k_{c}$ 的节点）。将 $f$ 表示为小数，并四舍五入到四位有效数字。\n\n### 步骤1：提取已知条件\n-   网络模型：无关联的配置模型。\n-   度分布：$P(k) \\propto k^{-\\gamma}$，对于 $k \\ge k_{\\min}$。\n-   度指数：$\\gamma = 2.5$。\n-   最小度：$k_{\\min} = 1$。\n-   传播率：$T = 0.2$。\n-   疫苗接种策略：为所有度 $k > k_c$ 的节点接种疫苗。\n-   残余网络启发式方法：未接种疫苗个体的网络度分布是原始分布在 $k_c$ 处截断并在区间 $k \\in [k_{\\min}, k_c]$ 上重新归一化的结果。\n-   网络规模假设：网络规模巨大，允许对求和使用连续近似。\n-   流行病阈值准则：通过随机边到达的节点产生的新感染期望数等于 $1$。\n-   目标1：推导临界疫苗接种度截断值 $k_c$。\n-   目标2：计算临界疫苗接种比例，$f = \\text{Prob}(k > k_c)$。\n-   输出要求：将 $f$ 以小数形式提供，并四舍五入到四位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n-   **科学依据**：该问题在网络流行病学领域有充分的理论基础。它使用了标准模型（配置模型、无标度网络、SIR模型）和已建立的理论概念（流行病阈值、分支过程近似）。关于残余网络的启发式方法是解析处理中常用的简化方法。\n-   **适定性**：该问题是适定的。它提供了所有必要的参数，并定义了明确的目标。尽管启发式方法是一种近似，但它使问题在数学上易于处理，并导向唯一的解。\n-   **目标**：问题以精确、客观、正式的科学语言陈述。\n\n### 步骤3：结论与行动\n该问题有效。这是一个网络数学流行病学中的标准练习，尽管并非微不足道。我将继续进行完整求解。\n\n问题要求我们找到疫苗接种的临界度截断值 $k_c$，使得未接种疫苗个体的残余网络恰好处于流行病阈值。流行病阈值的准则已给出：通过随机边感染的个体产生的二次感染的期望数必须等于1。对于无关联网络上的SIR过程，这个量由 $\\mathcal{R} = T \\frac{\\langle k^2 \\rangle - \\langle k \\rangle}{\\langle k \\rangle}$ 给出，其中 $T$ 是传播率，$\\langle k \\rangle$ 和 $\\langle k^2 \\rangle$ 分别是度分布的一阶矩和二阶矩。在阈值处，$\\mathcal{R} = 1$。\n\n设 $P'(k)$ 为残余网络的度分布，该网络由度 $k$ 在范围 $[k_{\\min}, k_c]$ 内的节点组成。该残余网络的矩表示为 $\\langle k \\rangle'$ 和 $\\langle k^2 \\rangle'$。因此，阈值条件是：\n$$ T \\frac{\\langle k^2 \\rangle' - \\langle k \\rangle'}{\\langle k \\rangle'} = 1 $$\n这个方程可以重排为 $T (\\langle k^2 \\rangle' - \\langle k \\rangle') = \\langle k \\rangle'$，或者更方便地表示为：\n$$ T \\langle k^2 \\rangle' = (1+T) \\langle k \\rangle' $$\n\n问题陈述残余网络的度分布是原始分布的截断和重归一化版本。原始分布是 $P(k) \\propto k^{-\\gamma}$。因此，对于残余网络，我们有 $P'(k) = C' k^{-\\gamma}$ 对于 $k \\in [k_{\\min},k_c]$，否则 $P'(k)=0$。考虑到巨大的网络规模和无标度特性，我们可以用积分来近似离散的度求和。\n\n首先，我们求 $P'(k)$ 的归一化常数 $C'$：\n$$ \\int_{k_{\\min}}^{k_c} C' k^{-\\gamma} dk = 1 $$\n$$ C' \\left[ \\frac{k^{1-\\gamma}}{1-\\gamma} \\right]_{k_{\\min}}^{k_c} = 1 \\implies C' = \\frac{1-\\gamma}{k_c^{1-\\gamma} - k_{\\min}^{1-\\gamma}} = \\frac{\\gamma-1}{k_{\\min}^{1-\\gamma} - k_c^{1-\\gamma}} $$\n\n接下来，我们计算残余网络的一阶矩 $\\langle k \\rangle'$ 和二阶矩 $\\langle k^2 \\rangle'$：\n$$ \\langle k \\rangle' = \\int_{k_{\\min}}^{k_c} k P'(k) dk = C' \\int_{k_{\\min}}^{k_c} k^{1-\\gamma} dk = C' \\left[ \\frac{k^{2-\\gamma}}{2-\\gamma} \\right]_{k_{\\min}}^{k_c} = C' \\frac{k_c^{2-\\gamma} - k_{\\min}^{2-\\gamma}}{2-\\gamma} $$\n$$ \\langle k^2 \\rangle' = \\int_{k_{\\min}}^{k_c} k^2 P'(k) dk = C' \\int_{k_{\\min}}^{k_c} k^{2-\\gamma} dk = C' \\left[ \\frac{k^{3-\\gamma}}{3-\\gamma} \\right]_{k_{\\min}}^{k_c} = C' \\frac{k_c^{3-\\gamma} - k_{\\min}^{3-\\gamma}}{3-\\gamma} $$\n\n现在，将这些表达式代入阈值条件 $T \\langle k^2 \\rangle' = (1+T) \\langle k \\rangle'$：\n$$ T C' \\frac{k_c^{3-\\gamma} - k_{\\min}^{3-\\gamma}}{3-\\gamma} = (1+T) C' \\frac{k_c^{2-\\gamma} - k_{\\min}^{2-\\gamma}}{2-\\gamma} $$\n归一化常数 $C'$ 被消掉了。\n$$ T \\frac{k_c^{3-\\gamma} - k_{\\min}^{3-\\gamma}}{3-\\gamma} = (1+T) \\frac{k_c^{2-\\gamma} - k_{\\min}^{2-\\gamma}}{2-\\gamma} $$\n我们已知 $\\gamma=2.5$。代入此值：\n$$ T \\frac{k_c^{3-2.5} - k_{\\min}^{3-2.5}}{3-2.5} = (1+T) \\frac{k_c^{2-2.5} - k_{\\min}^{2-2.5}}{2-2.5} $$\n$$ T \\frac{k_c^{0.5} - k_{\\min}^{0.5}}{0.5} = (1+T) \\frac{k_c^{-0.5} - k_{\\min}^{-0.5}}{-0.5} $$\n$$ 2T (k_c^{0.5} - k_{\\min}^{0.5}) = -2(1+T) (k_c^{-0.5} - k_{\\min}^{-0.5}) $$\n$$ T (k_c^{0.5} - k_{\\min}^{0.5}) = (1+T) (k_{\\min}^{-0.5} - k_c^{-0.5}) $$\n现在，我们使用给定的值 $k_{\\min} = 1$：\n$$ T (k_c^{0.5} - 1) = (1+T) (1 - k_c^{-0.5}) $$\n设 $x = k_c^{0.5}$。方程变为：\n$$ T(x - 1) = (1+T) \\left(1 - \\frac{1}{x}\\right) = (1+T) \\frac{x-1}{x} $$\n由于有效的疫苗接种策略意味着 $k_c > k_{\\min} = 1$，我们必须有 $x > 1$，因此 $x-1 \\neq 0$。我们可以在方程两边同时除以 $(x-1)$：\n$$ T = \\frac{1+T}{x} \\implies x = \\frac{1+T}{T} = 1 + \\frac{1}{T} $$\n将 $x = k_c^{0.5}$ 代回：\n$$ k_c^{0.5} = 1 + \\frac{1}{T} \\implies k_c = \\left(1 + \\frac{1}{T}\\right)^2 $$\n使用给定的传播率 $T = 0.2$：\n$$ k_c = \\left(1 + \\frac{1}{0.2}\\right)^2 = (1+5)^2 = 6^2 = 36 $$\n临界度截断值为 $k_c = 36$。\n\n问题的第二部分是计算接种疫苗的人口比例 $f$。这对应于原始网络中度 $k > k_c$ 的节点比例。\n$$ f = \\text{Prob}(k > k_c) = \\sum_{k=k_c+1}^{\\infty} P(k) $$\n使用连续近似，这等于 $f = \\int_{k_c}^{\\infty} P(k) dk$。原始度分布为 $P(k) = C k^{-\\gamma}$，对于 $k \\ge k_{\\min}$。我们首先找到归一化常数 $C$：\n$$ \\int_{k_{\\min}}^{\\infty} C k^{-\\gamma} dk = 1 $$\n$$ C \\left[ \\frac{k^{1-\\gamma}}{1-\\gamma} \\right]_{k_{\\min}}^{\\infty} = 1 $$\n对于 $\\gamma = 2.5 > 1$，当 $k \\to \\infty$ 时，项 $k^{1-\\gamma} \\to 0$。\n$$ C \\left(0 - \\frac{k_{\\min}^{1-\\gamma}}{1-\\gamma}\\right) = 1 \\implies C = \\frac{1-\\gamma}{-k_{\\min}^{1-\\gamma}} = (\\gamma-1)k_{\\min}^{\\gamma-1} $$\n当 $\\gamma = 2.5$ 和 $k_{\\min} = 1$ 时，我们得到 $C = (2.5-1) \\times 1^{1.5} = 1.5$。\n所以，$P(k) = 1.5 k^{-2.5}$。\n\n现在我们可以计算疫苗接种比例 $f$：\n$$ f = \\int_{k_c}^{\\infty} C k^{-\\gamma} dk = \\int_{36}^{\\infty} 1.5 k^{-2.5} dk $$\n$$ f = 1.5 \\left[ \\frac{k^{-1.5}}{-1.5} \\right]_{36}^{\\infty} = 1.5 \\left( 0 - \\frac{36^{-1.5}}{-1.5} \\right) = 36^{-1.5} $$\n$$ f = (36^{0.5})^{-3} = 6^{-3} = \\frac{1}{216} $$\n为了以四位有效数字的小数形式提供答案：\n$$ f = \\frac{1}{216} \\approx 0.004629629... $$\n四舍五入到四位有效数字得到 $0.004630$。",
            "answer": "$$\n\\boxed{0.004630}\n$$"
        },
        {
            "introduction": "不同的理论模型有时会指向不同的最优策略。这个问题  提出了一个思想实验，其中两种免疫策略对两个主要风险指标（谱半径与度矩比）产生不同的影响。通过分析这种情况，你将学会批判性地评估模型假设，并理解“最佳”策略可能取决于哪种理论框架更准确地捕捉了现实世界中的传播动态。",
            "id": "4306983",
            "problem": "考虑一个在具有重尾度异质性的大型、静态、无向网络上的易感-感染-易感（SIS）传播过程。设疾病传播率和恢复率固定，且在所有节点上均相同。持续流行的两个既定风险替代指标是：(i) 在淬火平均场近似中，风险与邻接矩阵的最大特征值 $\\,\\lambda_{1}\\,$ 单调相关；(ii) 在异质平均场近似中，风险与比率 $\\,\\langle k^{2}\\rangle/\\langle k\\rangle\\,$ 单调相关，其中 $\\,\\langle k\\rangle\\,$ 和 $\\,\\langle k^{2}\\rangle\\,$ 分别是度分布的一阶矩和二阶矩。假设干预后的稳态流行率由这些替代指标的凸组合建模，因此复合风险度量\n$$\n\\Phi(\\alpha)\\;=\\;\\alpha\\,R_{\\mathrm{spec}}\\;+\\;(1-\\alpha)\\,R_{\\mathrm{mf}},\\quad \\alpha\\in[0,1],\n$$\n其中 $\\,R_{\\mathrm{spec}}\\,$ 与 $\\,\\lambda_{1}\\,$ 成正比，$\\,R_{\\mathrm{mf}}\\,$ 与 $\\,\\langle k^{2}\\rangle/\\langle k\\rangle\\,$ 成正比，该度量提供了一个相对于干预前基线的归一化流行率预测。假设固定的预算允许采取以下两种免疫策略之一：\n\n- 策略 $\\,\\mathrm{H}\\,$：免疫 $\\,10\\,$ 个度最高的中心节点。\n- 策略 $\\,\\mathrm{M}\\,$：免疫 $\\,40\\,$ 个度数接近 $\\,2\\langle k\\rangle\\,$ 的中等度数节点。\n\n干预后的经验测量报告了以下归一化的干预后风险分量（每个分量均报告为其干预前值的比例）：\n\n- 对于策略 $\\,\\mathrm{H}\\,$：$\\,R_{\\mathrm{spec}}^{(\\mathrm{H})}=0.55\\,$ 且 $\\,R_{\\mathrm{mf}}^{(\\mathrm{H})}=0.70\\,$。\n- 对于策略 $\\,\\mathrm{M}\\,$：$\\,R_{\\mathrm{spec}}^{(\\mathrm{M})}=0.80\\,$ 且 $\\,R_{\\mathrm{mf}}^{(\\mathrm{M})}=0.50\\,$。\n\n假设复合风险 $\\,\\Phi(\\alpha)\\,$ 由产生较小 $\\,\\Phi(\\alpha)\\,$ 值的策略最小化。在这些条件下，以下哪个陈述是正确的？\n\nA. 存在唯一的 $\\,\\alpha^{\\star}\\approx 0.44\\,$，使得当 $\\,\\alpha > \\alpha^{\\star}\\,$ 时，策略 $\\,\\mathrm{H}\\,$ 最小化 $\\,\\Phi(\\alpha)\\,$；当 $\\,\\alpha  \\alpha^{\\star}\\,$ 时，策略 $\\,\\mathrm{M}\\,$ 最小化 $\\,\\Phi(\\alpha)\\,$。\n\nB. 存在唯一的 $\\,\\alpha^{\\star}\\approx 0.56\\,$，使得当 $\\,\\alpha > \\alpha^{\\star}\\,$ 时，策略 $\\,\\mathrm{H}\\,$ 最小化 $\\,\\Phi(\\alpha)\\,$；当 $\\,\\alpha  \\alpha^{\\star}\\,$ 时，策略 $\\,\\mathrm{M}\\,$ 最小化 $\\,\\Phi(\\alpha)\\,$。\n\nC. 存在唯一的 $\\,\\alpha^{\\star}\\approx 0.44\\,$，使得当 $\\,\\alpha  \\alpha^{\\star}\\,$ 时，策略 $\\,\\mathrm{H}\\,$ 最小化 $\\,\\Phi(\\alpha)\\,$；当 $\\,\\alpha > \\alpha^{\\star}\\,$ 时，策略 $\\,\\mathrm{M}\\,$ 最小化 $\\,\\Phi(\\alpha)\\,$。\n\nD. 不存在交叉点：对于所有 $\\,\\alpha\\in[0,1]\\,$，策略 $\\,\\mathrm{H}\\,$ 都能最小化 $\\,\\Phi(\\alpha)\\,$。",
            "solution": "用户要求对所提供的问题进行细致的验证和解答。\n\n**问题验证**\n\n**步骤1：提取已知条件**\n\n*   **过程**：易感-感染-易感（SIS）传播过程。\n*   **网络**：大型、静态、无向，具有重尾度异质性。\n*   **参数**：疾病传播率和恢复率是固定且均匀的。\n*   **风险替代指标**：\n    *   淬火平均场（QMF）风险单调依赖于邻接矩阵的最大特征值 $\\lambda_{1}$。\n    *   异质平均场（HMF）风险单调依赖于比率 $\\langle k^{2}\\rangle/\\langle k\\rangle$。\n*   **复合风险度量**：干预后的流行率由一个归一化的复合风险度量 $\\Phi(\\alpha) = \\alpha\\,R_{\\mathrm{spec}} + (1-\\alpha)\\,R_{\\mathrm{mf}}$ 预测，其中 $\\alpha \\in [0,1]$。\n*   **度量分量**：$R_{\\mathrm{spec}}$ 与 $\\lambda_{1}$ 成正比，$R_{\\mathrm{mf}}$ 与 $\\langle k^{2}\\rangle/\\langle k\\rangle$ 成正比。\n*   **免疫策略**：\n    *   策略 $\\mathrm{H}$：免疫10个度最高的中心节点。\n    *   策略 $\\mathrm{M}$：免疫40个度数接近 $2\\langle k\\rangle$ 的中等度数节点。\n*   **经验数据（干预后，归一化）**：\n    *   对于策略 $\\mathrm{H}$：$R_{\\mathrm{spec}}^{(\\mathrm{H})}=0.55$， $R_{\\mathrm{mf}}^{(\\mathrm{H})}=0.70$。\n    *   对于策略 $\\mathrm{M}$：$R_{\\mathrm{spec}}^{(\\mathrm{M})}=0.80$， $R_{\\mathrm{mf}}^{(\\mathrm{M})}=0.50$。\n*   **目标**：最小化复合风险 $\\Phi(\\alpha)$。\n\n**步骤2：使用提取的已知条件进行验证**\n\n1.  **科学依据**：该问题在网络流行病学中有充分的理论基础。SIS模型、异质网络以及两种平均场近似（QMF和HMF）都是标准框架。QMF模型中的流行阈值与 $\\lambda_{1}$ 成反比，而HMF模型中的流行阈值与 $\\langle k\\rangle / \\langle k^{2}\\rangle$ 成正比。因此，使用与 $\\lambda_{1}$ 和 $\\langle k^{2}\\rangle/\\langle k\\rangle$ 成正比的量作为风险替代指标（分别为 $R_{\\mathrm{spec}}$ 和 $R_{\\mathrm{mf}}$）在理论上是合理的。\n2.  **适定性**：该问题在数学上是适定的。它为两种不同策略的风险度量提供了明确的函数形式，并要求确定一种策略优于另一种策略的条件。所有必要的数据都已提供，可以导出一个唯一的解。\n3.  **客观性**：该问题使用精确、定量和客观的语言陈述，没有主观或含糊的术语。\n4.  **一致性与现实性**：所提供的数据与靶向免疫的既有知识一致。已知免疫顶级中心节点（策略 $\\mathrm{H}$）在降低 $\\lambda_{1}$ 方面非常有效，因为中心节点在主特征向量中占主导地位。报告中 $R_{\\mathrm{spec}}^{(\\mathrm{H})}=0.55$ 的显著降低是合理的。其对 $\\langle k^{2}\\rangle/\\langle k\\rangle$ 的影响可能不那么明显，因此 $R_{\\mathrm{mf}}^{(\\mathrm{H})}=0.70$ 也是合理的。策略 $\\mathrm{M}$ 针对更多中等度数的节点。这在降低度分布的整体二阶矩方面可能更有效，这解释了 $R_{\\mathrm{mf}}^{(\\mathrm{M})}=0.50$ 的强劲下降。其对 $\\lambda_{1}$ 的影响预计小于移除中心节点的影响，这与较高的值 $R_{\\mathrm{spec}}^{(\\mathrm{M})}=0.80$ 一致。该设定内部一致且科学上合理。\n5.  **无其他缺陷**：该问题不是琐碎、循环或不适定的。使用复合度量 $\\Phi(\\alpha)$ 是一个合理的方法，用于模拟不同理论近似之间的不确定性。\n\n**步骤3：结论与行动**\n\n问题陈述是**有效的**。现在开始求解过程。\n\n**求解推导**\n\n问题要求我们基于复合风险度量 $\\Phi(\\alpha)$ 的最小化来比较两种免疫策略 $\\mathrm{H}$ 和 $\\mathrm{M}$。该度量定义为：\n$$\n\\Phi(\\alpha) = \\alpha\\,R_{\\mathrm{spec}} + (1-\\alpha)\\,R_{\\mathrm{mf}}\n$$\n让我们使用提供的干预后数据为每种策略写出具体的风险函数。\n\n对于策略 $\\mathrm{H}$：\n$$\n\\Phi^{(\\mathrm{H})}(\\alpha) = \\alpha\\,R_{\\mathrm{spec}}^{(\\mathrm{H})} + (1-\\alpha)\\,R_{\\mathrm{mf}}^{(\\mathrm{H})}\n$$\n代入给定值 $R_{\\mathrm{spec}}^{(\\mathrm{H})}=0.55$ 和 $R_{\\mathrm{mf}}^{(\\mathrm{H})}=0.70$：\n$$\n\\Phi^{(\\mathrm{H})}(\\alpha) = 0.55\\alpha + 0.70(1-\\alpha) = 0.55\\alpha + 0.70 - 0.70\\alpha = 0.70 - 0.15\\alpha\n$$\n\n对于策略 $\\mathrm{M}$：\n$$\n\\Phi^{(\\mathrm{M})}(\\alpha) = \\alpha\\,R_{\\mathrm{spec}}^{(\\mathrm{M})} + (1-\\alpha)\\,R_{\\mathrm{mf}}^{(\\mathrm{M})}\n$$\n代入给定值 $R_{\\mathrm{spec}}^{(\\mathrm{M})}=0.80$ 和 $R_{\\mathrm{mf}}^{(\\mathrm{M})}=0.50$：\n$$\n\\Phi^{(\\mathrm{M})}(\\alpha) = 0.80\\alpha + 0.50(1-\\alpha) = 0.80\\alpha + 0.50 - 0.50\\alpha = 0.50 + 0.30\\alpha\n$$\n\n最优策略是导致 $\\Phi(\\alpha)$ 值较低的策略。两种策略的偏好发生转换的交叉点出现在 $\\alpha$ 的某个值（记为 $\\alpha^{\\star}$）上，在该点上它们的表现相等：\n$$\n\\Phi^{(\\mathrm{H})}(\\alpha^{\\star}) = \\Phi^{(\\mathrm{M})}(\\alpha^{\\star})\n$$\n我们求解 $\\alpha^{\\star}$：\n$$\n0.70 - 0.15\\alpha^{\\star} = 0.50 + 0.30\\alpha^{\\star}\n$$\n重新整理各项以求解 $\\alpha^{\\star}$：\n$$\n0.70 - 0.50 = 0.30\\alpha^{\\star} + 0.15\\alpha^{\\star}\n$$\n$$\n0.20 = 0.45\\alpha^{\\star}\n$$\n$$\n\\alpha^{\\star} = \\frac{0.20}{0.45} = \\frac{20}{45} = \\frac{4}{9}\n$$\n$\\alpha^{\\star}$ 的小数表示为 $4/9 \\approx 0.4444...$。由于 $\\alpha^{\\star} \\in [0,1]$，存在一个唯一的交叉点。\n\n现在我们必须确定对于 $\\alpha > \\alpha^{\\star}$ 和 $\\alpha  \\alpha^{\\star}$ 的情况，哪种策略更优。\n\n当策略 $\\mathrm{H}$ 更优时，$\\Phi^{(\\mathrm{H})}(\\alpha)  \\Phi^{(\\mathrm{M})}(\\alpha)$：\n$$\n0.70 - 0.15\\alpha  0.50 + 0.30\\alpha\n$$\n$$\n0.20  0.45\\alpha\n$$\n$$\n\\alpha > \\frac{0.20}{0.45} = \\frac{4}{9}\n$$\n所以，对于 $\\alpha > \\alpha^{\\star}$，策略 $\\mathrm{H}$ 最小化风险。\n\n当策略 $\\mathrm{M}$ 更优时，$\\Phi^{(\\mathrm{M})}(\\alpha)  \\Phi^{(\\mathrm{H})}(\\alpha)$：\n$$\n0.50 + 0.30\\alpha  0.70 - 0.15\\alpha\n$$\n$$\n0.45\\alpha  0.20\n$$\n$$\n\\alpha  \\frac{0.20}{0.45} = \\frac{4}{9}\n$$\n所以，对于 $\\alpha  \\alpha^{\\star}$，策略 $\\mathrm{M}$ 最小化风险。\n\n总结来说，在 $\\alpha^{\\star} = 4/9 \\approx 0.44$ 处存在一个唯一的交叉点。对于权重参数 $\\alpha$ 大于 $\\alpha^{\\star}$ 的值，策略 $\\mathrm{H}$ 是最优的。对于 $\\alpha$ 小于 $\\alpha^{\\star}$ 的值，策略 $\\mathrm{M}$ 是最优的。\n\n**逐项分析**\n\n*   **A. 存在唯一的 $\\,\\alpha^{\\star}\\approx 0.44\\,$，使得当 $\\,\\alpha > \\alpha^{\\star}\\,$ 时，策略 $\\,\\mathrm{H}\\,$ 最小化 $\\,\\Phi(\\alpha)\\,$；当 $\\,\\alpha  \\alpha^{\\star}\\,$ 时，策略 $\\,\\mathrm{M}\\,$ 最小化 $\\,\\Phi(\\alpha)\\,$。**\n    *   我们的计算得出了一个唯一的交叉点 $\\alpha^{\\star} = 4/9 \\approx 0.44$。\n    *   我们的分析表明，当 $\\alpha > \\alpha^{\\star}$ 时，策略 $\\mathrm{H}$ 更优（$\\Phi^{(\\mathrm{H})}(\\alpha)  \\Phi^{(\\mathrm{M})}(\\alpha)$）。\n    *   我们的分析表明，当 $\\alpha  \\alpha^{\\star}$ 时，策略 $\\mathrm{M}$ 更优（$\\Phi^{(\\mathrm{M})}(\\alpha)  \\Phi^{(\\mathrm{H})}(\\alpha)$）。\n    *   该陈述与我们推导出的结果完全一致。\n    *   结论：**正确**。\n\n*   **B. 存在唯一的 $\\,\\alpha^{\\star}\\approx 0.56\\,$，使得当 $\\,\\alpha > \\alpha^{\\star}\\,$ 时，策略 $\\,\\mathrm{H}\\,$ 最小化 $\\,\\Phi(\\alpha)\\,$；当 $\\,\\alpha  \\alpha^{\\star}\\,$ 时，策略 $\\,\\mathrm{M}\\,$ 最小化 $\\,\\Phi(\\alpha)\\,$。**\n    *   交叉点的值不正确。我们计算出 $\\alpha^{\\star} \\approx 0.44$，而不是 $0.56$。值 $0.56 \\approx 5/9$ 是不正确的。\n    *   结论：**不正确**。\n\n*   **C. 存在唯一的 $\\,\\alpha^{\\star}\\approx 0.44\\,$，使得当 $\\,\\alpha  \\alpha^{\\star}\\,$ 时，策略 $\\,\\mathrm{H}\\,$ 最小化 $\\,\\Phi(\\alpha)\\,$；当 $\\,\\alpha > \\alpha^{\\star}\\,$ 时，策略 $\\,\\mathrm{M}\\,$ 最小化 $\\,\\Phi(\\alpha)\\,$。**\n    *   交叉点的值 $\\alpha^{\\star} \\approx 0.44$ 是正确的。\n    *   然而，条件被颠倒了。该选项声称策略 $\\mathrm{H}$ 在 $\\alpha  \\alpha^{\\star}$ 时更优，策略 $\\mathrm{M}$ 在 $\\alpha > \\alpha^{\\star}$ 时更优。我们的分析证明了相反的情况。\n    *   结论：**不正确**。\n\n*   **D. 不存在交叉点：对于所有 $\\,\\alpha\\in[0,1]\\,$，策略 $\\,\\mathrm{H}\\,$ 都能最小化 $\\,\\Phi(\\alpha)\\,$。**\n    *   我们的计算证明了存在一个唯一的交叉点 $\\alpha^{\\star} = 4/9$，它位于区间 $[0, 1]$ 内。因此，交叉点确实存在。\n    *   此外，在 $\\alpha=0$ 时，$\\Phi^{(\\mathrm{H})}(0) = 0.70$ 且 $\\Phi^{(\\mathrm{M})}(0) = 0.50$，所以策略 $\\mathrm{M}$ 更优。策略 $\\mathrm{H}$ 并不能对所有 $\\alpha \\in [0,1]$ 最小化 $\\Phi(\\alpha)$。\n    *   结论：**不正确**。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}