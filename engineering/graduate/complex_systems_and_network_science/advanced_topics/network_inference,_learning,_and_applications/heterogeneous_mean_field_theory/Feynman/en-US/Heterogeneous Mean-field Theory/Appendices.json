{
    "hands_on_practices": [
        {
            "introduction": "To build confidence in a new theoretical framework, it is often helpful to test it in a simplified case where the answer is known or can be derived by other means. This first practice provides such a critical consistency check. You will derive the epidemic threshold for a Susceptible-Infected-Susceptible (SIS) process on a $k$-regular graph using two different perspectives: the node-level spectral approach (Quenched Mean-Field) and the degree-class HMF approach, demonstrating that they yield the identical, correct result .",
            "id": "4293423",
            "problem": "Consider a connected, undirected, simple graph $G$ on $n$ nodes with adjacency matrix $A \\in \\{0,1\\}^{n \\times n}$, where each node has degree $k$ (a $k$-regular graph). On $G$, a Susceptible-Infected-Susceptible (SIS) process evolves in continuous time: each infected node recovers at rate $\\mu  0$, and each susceptible node becomes infected by each infected neighbor at rate $\\lambda  0$ along the connecting edge, independently across edges. Define the effective infection parameter $\\tau \\equiv \\lambda / \\mu$.\n\nStarting from first principles and well-tested mean-field approximations, do the following:\n\n1. Node-level spectral route: Write the node-level mean-field dynamical equations for the infection probabilities $x_i(t)$ under the standard independence approximation, linearize them around the disease-free state $x_i = 0$, and use linear stability analysis to express the epidemic threshold $\\tau_c$ in terms of the largest eigenvalue of $A$. Then, specialize to the case of a $k$-regular graph, using fundamental spectral properties of nonnegative, symmetric matrices to determine the largest eigenvalue and hence the threshold.\n\n2. Degree-class moment route: Consider the heterogeneous mean-field description by degree classes. Let $\\rho_k(t)$ denote the probability that a node of degree $k$ is infected at time $t$. Assume an uncorrelated network ensemble for which the probability that a neighbor has degree $k'$ is given by the standard configuration model relation. Derive the linearized degree-class dynamics near the disease-free state, identify the linear operator that governs early-time growth, and determine its leading eigenvalue in terms of the first two moments of the degree sequence, $\\langle k \\rangle$ and $\\langle k^2 \\rangle$. Then specialize these moments to the $k$-regular case and infer the threshold.\n\nConclude by providing a single closed-form analytic expression for $\\tau_c$ in terms of $k$. No rounding is required.",
            "solution": "The problem requires the derivation of the epidemic threshold, $\\tau_c$, for a Susceptible-Infected-Susceptible (SIS) model on a connected, undirected, simple, $k$-regular graph. This will be accomplished through two distinct but related mean-field theoretical frameworks, confirming their consistency. The effective infection parameter is defined as $\\tau \\equiv \\lambda / \\mu$, where $\\lambda  0$ is the infection rate per edge and $\\mu  0$ is the recovery rate.\n\nFirst, we use the node-level spectral route. Let $x_i(t)$ be the probability that node $i$ is infected at time $t$, for $i \\in \\{1, 2, \\dots, n\\}$. The dynamics of $x_i(t)$ are governed by a balance between recovery and infection events. An infected node $i$ recovers with rate $\\mu$. A susceptible node $i$ becomes infected by each infected neighbor $j$ at rate $\\lambda$. The standard mean-field approximation assumes that the infection statuses of a node's neighbors are independent. This leads to the following system of nonlinear differential equations:\n$$\n\\frac{dx_i}{dt} = \\underbrace{-\\mu x_i}_{\\text{Recovery}} + \\underbrace{\\lambda(1-x_i) \\sum_{j=1}^n A_{ij} x_j}_{\\text{Infection}}\n$$\nwhere $A$ is the adjacency matrix of the graph $G$, with $A_{ij} = 1$ if nodes $i$ and $j$ are connected and $A_{ij} = 0$ otherwise. The term $\\sum_{j=1}^n A_{ij} x_j$ represents the expected number of infected neighbors of node $i$.\n\nTo determine the epidemic threshold, we analyze the stability of the disease-free equilibrium state, where $x_i = 0$ for all $i$. We introduce a small perturbation, $x_i(t) = \\epsilon_i(t)$, where $|\\epsilon_i(t)| \\ll 1$. Substituting this into the dynamical equations and retaining only terms linear in $\\epsilon_i$ yields:\n$$\n\\frac{d\\epsilon_i}{dt} = -\\mu \\epsilon_i + \\lambda(1-\\epsilon_i) \\sum_{j=1}^n A_{ij} \\epsilon_j \\approx -\\mu \\epsilon_i + \\lambda \\sum_{j=1}^n A_{ij} \\epsilon_j\n$$\nThis can be written in vector form, letting $\\vec{\\epsilon} = (\\epsilon_1, \\dots, \\epsilon_n)^T$:\n$$\n\\frac{d\\vec{\\epsilon}}{dt} = (\\lambda A - \\mu I) \\vec{\\epsilon}\n$$\nwhere $I$ is the $n \\times n$ identity matrix. The disease-free state is unstable, and an epidemic can occur, if the perturbation $\\vec{\\epsilon}(t)$ grows. This happens if the largest real part of the eigenvalues of the Jacobian matrix $J = \\lambda A - \\mu I$ is positive. Since $A$ is a real, symmetric matrix for an undirected graph, its eigenvalues, denoted by $\\Lambda_i$, are all real. The eigenvalues of $J$ are thus $\\lambda \\Lambda_i - \\mu$. The condition for instability is:\n$$\n\\max_i(\\lambda \\Lambda_i - \\mu)  0\n$$\nLet $\\Lambda_{\\text{max}}$ be the largest eigenvalue of the adjacency matrix $A$. The condition for epidemic growth becomes $\\lambda \\Lambda_{\\text{max}} - \\mu  0$, which can be rewritten in terms of the effective infection parameter $\\tau = \\lambda / \\mu$ as:\n$$\n\\tau  \\frac{1}{\\Lambda_{\\text{max}}}\n$$\nThe epidemic threshold is the critical value of $\\tau$ at which this inequality changes, so $\\tau_c = 1/\\Lambda_{\\text{max}}$.\nFor a $k$-regular graph, the degree of every node is $k$. The sum of each row of the adjacency matrix $A$ is $k$. This implies that the vector of all ones, $\\vec{v} = (1, 1, \\dots, 1)^T$, is an eigenvector of $A$ with eigenvalue $k$, since $(A\\vec{v})_i = \\sum_j A_{ij} v_j = \\sum_j A_{ij} = k_i = k$. By the Perron-Frobenius theorem for connected non-negative graphs, the largest eigenvalue $\\Lambda_{\\text{max}}$ is simple and has a corresponding eigenvector with all positive entries. Furthermore, it is known that $\\Lambda_{\\text{max}} \\leq \\max_i(k_i)$. For a $k$-regular graph, this means $\\Lambda_{\\text{max}} \\leq k$. Since we have found an eigenvalue equal to $k$, it must be the largest one. Thus, $\\Lambda_{\\text{max}} = k$. Substituting this into our expression for the threshold yields:\n$$\n\\tau_c = \\frac{1}{k}\n$$\n\nSecond, we use the degree-class moment route. This approach is suited for heterogeneous networks and assumes the network is uncorrelated (as in the configuration model). Let $\\rho_k(t)$ be the probability that a node of degree $k$ is infected at time $t$. Let $\\theta(t)$ be the probability that a randomly chosen edge leads to an infected node. The dynamics of $\\rho_k(t)$ are given by:\n$$\n\\frac{d\\rho_k}{dt} = -\\mu \\rho_k + \\lambda k (1-\\rho_k) \\theta(t)\n$$\nThe term $\\lambda k \\theta(t)$ represents the infection pressure on a susceptible node of degree $k$. The auxiliary variable $\\theta(t)$ is defined based on the network's degree distribution $P(k')$ and the assumption of no degree correlations. The probability that an edge points to a node of degree $k'$ is $k' P(k') / \\langle k \\rangle$, where $\\langle k \\rangle = \\sum_{k'} k' P(k')$ is the average degree. Thus, $\\theta(t)$ is the sum over all degrees $k'$ of the probability that an edge leads to a node of degree $k'$, which is itself infected:\n$$\n\\theta(t) = \\sum_{k'} \\frac{k' P(k')}{\\langle k \\rangle} \\rho_{k'}(t)\n$$\nTo find the threshold, we linearize the system around the disease-free state $\\rho_k = 0$ for all $k$. For small $\\rho_k$, the term $(1-\\rho_k)$ is approximately $1$, giving:\n$$\n\\frac{d\\rho_k}{dt} \\approx -\\mu \\rho_k + \\lambda k \\theta(t)\n$$\nTo find a single condition for growth, we analyze the dynamics of $\\theta(t)$. Differentiating its definition with respect to time gives:\n$$\n\\frac{d\\theta}{dt} = \\sum_{k'} \\frac{k' P(k')}{\\langle k \\rangle} \\frac{d\\rho_{k'}}{dt}\n$$\nSubstituting the linearized equation for $d\\rho_{k'}/dt$:\n$$\n\\frac{d\\theta}{dt} = \\sum_{k'} \\frac{k' P(k')}{\\langle k \\rangle} (-\\mu \\rho_{k'} + \\lambda k' \\theta(t)) = -\\mu \\sum_{k'} \\frac{k' P(k')}{\\langle k \\rangle} \\rho_{k'} + \\lambda \\theta(t) \\sum_{k'} \\frac{(k')^2 P(k')}{\\langle k \\rangle}\n$$\nThe first summation on the right is simply the definition of $\\theta(t)$. The second summation involves the second moment of the degree distribution, $\\langle k^2 \\rangle = \\sum_{k'} (k')^2 P(k')$. This simplifies the ODE for $\\theta(t)$ to:\n$$\n\\frac{d\\theta}{dt} = -\\mu \\theta(t) + \\lambda \\theta(t) \\frac{\\langle k^2 \\rangle}{\\langle k \\rangle} = \\left(\\lambda \\frac{\\langle k^2 \\rangle}{\\langle k \\rangle} - \\mu\\right) \\theta(t)\n$$\nAn epidemic can emerge if $\\theta(t)$ grows from an infinitesimal perturbation, which requires the coefficient on the right-hand side to be positive:\n$$\n\\lambda \\frac{\\langle k^2 \\rangle}{\\langle k \\rangle} - \\mu  0 \\implies \\tau = \\frac{\\lambda}{\\mu}  \\frac{\\langle k \\rangle}{\\langle k^2 \\rangle}\n$$\nThe epidemic threshold is therefore $\\tau_c = \\frac{\\langle k \\rangle}{\\langle k^2 \\rangle}$.\nFor a $k$-regular graph, the degree distribution is a Kronecker delta, $P(k') = \\delta_{k',k}$, since all nodes have the same degree $k$. The moments are trivial to compute:\n$\\langle k \\rangle = \\sum_{k'} k' \\delta_{k',k} = k$.\n$\\langle k^2 \\rangle = \\sum_{k'} (k')^2 \\delta_{k',k} = k^2$.\nSubstituting these moments into the threshold expression for the heterogeneous mean-field theory gives:\n$$\n\\tau_c = \\frac{k}{k^2} = \\frac{1}{k}\n$$\nBoth the node-level spectral analysis and the degree-class moment-based analysis yield the identical result for the epidemic threshold on a $k$-regular graph.",
            "answer": "$$\n\\boxed{\\frac{1}{k}}\n$$"
        },
        {
            "introduction": "Beyond simply predicting *when* an epidemic can occur, mean-field theories offer powerful insights into the *nature* of the epidemic transition. This exercise moves from finding the threshold to characterizing the behavior of the system just above it. By linearizing the heterogeneous mean-field equations around the critical point, you will derive the critical exponent $\\beta$ that describes how the stationary prevalence $\\rho$ scales with the distance from the threshold, revealing a universal feature of this class of models .",
            "id": "4280365",
            "problem": "Consider a continuous-time Susceptible-Infected-Susceptible (SIS) process on a large, sparse, uncorrelated network with degree distribution $P(k)$ and finite moments up to $\\langle k^{3} \\rangle$. The infection rate per contact is $\\lambda$ and the recovery rate is $\\mu$. In the heterogeneous mean-field (HMF) description, all nodes of equal degree $k$ share the same instantaneous infection probability $\\rho_{k}(t)$, and the probability that a randomly chosen edge points to an infected node is denoted by $\\Theta(t)$. For uncorrelated networks, the annealed approximation implies $\\Theta(t) = \\sum_{k} \\frac{k P(k)}{\\langle k \\rangle} \\rho_{k}(t)$.\n\nStarting from fundamental definitions of the SIS dynamics and the heterogeneous mean-field approximation, derive the near-threshold scaling of the stationary prevalence $\\rho \\equiv \\sum_{k} P(k)\\,\\rho_{k}$ as a function of the distance to the epidemic threshold, $(\\lambda - \\lambda_{c})$, by linearizing the steady-state HMF equations around the threshold. Define the critical exponent $\\beta$ via the relation $\\rho \\sim (\\lambda - \\lambda_{c})^{\\beta}$ as $\\lambda \\downarrow \\lambda_{c}^{+}$, and determine its value under the stated assumptions.\n\nYour final answer must be the value of the exponent $\\beta$ as a single real number. No rounding is needed. If you introduce any additional symbols, define them clearly within your derivation. No physical units are required in the final answer.",
            "solution": "The problem asks for the derivation of the critical exponent $\\beta$ governing the scaling of the stationary prevalence $\\rho$ near the epidemic threshold $\\lambda_c$ for a continuous-time Susceptible-Infected-Susceptible (SIS) model on a heterogeneous network. The scaling relation is given by $\\rho \\sim (\\lambda - \\lambda_c)^{\\beta}$ as the infection rate $\\lambda$ approaches the threshold $\\lambda_c$ from above. We will use the heterogeneous mean-field (HMF) approximation.\n\nFirst, we establish the dynamical equation for the probability $\\rho_k(t)$ that a node of degree $k$ is infected at time $t$. A susceptible node of degree $k$, which occurs with probability $(1 - \\rho_k(t))$, becomes infected by contact with any of its $k$ neighbors. The probability that a randomly chosen neighbor is infected is given by $\\Theta(t)$. With an infection rate per contact of $\\lambda$, the rate of infection for a susceptible node of degree $k$ is $\\lambda k \\Theta(t)$. An infected node of degree $k$ recovers at a rate $\\mu$. Combining these processes, the evolution of $\\rho_k(t)$ is described by the rate equation:\n$$ \\frac{d\\rho_k(t)}{dt} = \\lambda k (1 - \\rho_k(t)) \\Theta(t) - \\mu \\rho_k(t) $$\nThe quantity $\\Theta(t)$ is the probability that a randomly chosen edge points to an infected node. For an uncorrelated network, it is given by the self-consistency condition:\n$$ \\Theta(t) = \\sum_j \\frac{j P(j)}{\\langle k \\rangle} \\rho_j(t) $$\nwhere $\\langle k \\rangle = \\sum_k k P(k)$ is the average degree of the network.\n\nTo find the stationary prevalence, we analyze the steady-state behavior by setting $\\frac{d\\rho_k(t)}{dt} = 0$. Let $\\rho_k$ and $\\Theta$ denote the stationary values of $\\rho_k(t)$ and $\\Theta(t)$, respectively. The steady-state equation for $\\rho_k$ is:\n$$ \\lambda k (1 - \\rho_k) \\Theta - \\mu \\rho_k = 0 $$\nSolving for $\\rho_k$, we get:\n$$ \\lambda k \\Theta = \\rho_k (\\mu + \\lambda k \\Theta) $$\n$$ \\rho_k = \\frac{\\lambda k \\Theta}{\\mu + \\lambda k \\Theta} $$\nThis equation shows that $\\rho_k = 0$ for all $k$ (which implies $\\Theta = 0$) is always a trivial solution, corresponding to the disease-free state.\n\nThe epidemic threshold, $\\lambda_c$, is the critical value of $\\lambda$ at which a non-trivial solution (i.e., an endemic state with $\\Theta  0$) first appears. To find $\\lambda_c$, we linearize the system around the disease-free state. For a small but non-zero $\\Theta \\ll 1$, we can approximate $\\rho_k$ to the first order in $\\Theta$:\n$$ \\rho_k \\approx \\frac{\\lambda k \\Theta}{\\mu} $$\nSubstituting this linear approximation into the self-consistency equation for $\\Theta$:\n$$ \\Theta = \\sum_k \\frac{k P(k)}{\\langle k \\rangle} \\rho_k \\approx \\sum_k \\frac{k P(k)}{\\langle k \\rangle} \\left( \\frac{\\lambda k \\Theta}{\\mu} \\right) $$\nFor the endemic state, we assume $\\Theta  0$ and can divide by it:\n$$ 1 = \\sum_k \\frac{k P(k)}{\\langle k \\rangle} \\frac{\\lambda k}{\\mu} = \\frac{\\lambda}{\\mu \\langle k \\rangle} \\sum_k k^2 P(k) $$\nUsing the definition of the second moment of the degree distribution, $\\langle k^2 \\rangle = \\sum_k k^2 P(k)$, we have:\n$$ 1 = \\frac{\\lambda \\langle k^2 \\rangle}{\\mu \\langle k \\rangle} $$\nThis equation holds at the threshold, defining the critical infection rate $\\lambda_c$:\n$$ \\lambda_c = \\frac{\\mu \\langle k \\rangle}{\\langle k^2 \\rangle} $$\n\nNow, to find the scaling of the prevalence near the threshold, we analyze the system for $\\lambda$ slightly above $\\lambda_c$. Let $\\lambda = \\lambda_c + \\epsilon$, where $\\epsilon$ is a small positive parameter, $\\epsilon = \\lambda - \\lambda_c  0$. In this regime, the stationary prevalence is small, so $\\Theta$ is small. We need to expand the expression for $\\rho_k$ to a higher order in $\\Theta$.\n$$ \\rho_k = \\frac{\\lambda k \\Theta}{\\mu + \\lambda k \\Theta} = \\frac{(\\lambda k / \\mu) \\Theta}{1 + (\\lambda k / \\mu) \\Theta} $$\nUsing the Taylor expansion $(1+x)^{-1} = 1 - x + x^2 - \\dots$ for small $x = (\\lambda k / \\mu) \\Theta$:\n$$ \\rho_k = \\frac{\\lambda k \\Theta}{\\mu} \\left( 1 - \\frac{\\lambda k \\Theta}{\\mu} + \\mathcal{O}(\\Theta^2) \\right) = \\frac{\\lambda k}{\\mu}\\Theta - \\frac{\\lambda^2 k^2}{\\mu^2}\\Theta^2 + \\mathcal{O}(\\Theta^3) $$\nSubstitute this expansion back into the self-consistency equation for $\\Theta$:\n$$ \\Theta = \\sum_k \\frac{k P(k)}{\\langle k \\rangle} \\rho_k = \\sum_k \\frac{k P(k)}{\\langle k \\rangle} \\left( \\frac{\\lambda k}{\\mu}\\Theta - \\frac{\\lambda^2 k^2}{\\mu^2}\\Theta^2 + \\mathcal{O}(\\Theta^3) \\right) $$\nAssuming $\\Theta \\ne 0$, we divide by $\\Theta$:\n$$ 1 = \\sum_k \\frac{k P(k)}{\\langle k \\rangle} \\left( \\frac{\\lambda k}{\\mu} - \\frac{\\lambda^2 k^2}{\\mu^2}\\Theta + \\mathcal{O}(\\Theta^2) \\right) $$\nSeparating the sums:\n$$ 1 = \\frac{\\lambda}{\\mu \\langle k \\rangle} \\sum_k k^2 P(k) - \\frac{\\lambda^2 \\Theta}{\\mu^2 \\langle k \\rangle} \\sum_k k^3 P(k) + \\mathcal{O}(\\Theta^2) $$\nUsing the moment notation $\\langle k^n \\rangle = \\sum_k k^n P(k)$:\n$$ 1 = \\frac{\\lambda \\langle k^2 \\rangle}{\\mu \\langle k \\rangle} - \\frac{\\lambda^2 \\langle k^3 \\rangle}{\\mu^2 \\langle k \\rangle}\\Theta + \\mathcal{O}(\\Theta^2) $$\nNow, substitute $\\lambda = \\lambda_c + \\epsilon$. In the term proportional to $\\Theta$, which is already small, we can approximate $\\lambda \\approx \\lambda_c$ as the correction would be of higher order, i.e., $\\mathcal{O}(\\epsilon \\Theta)$.\n$$ 1 \\approx \\frac{(\\lambda_c + \\epsilon) \\langle k^2 \\rangle}{\\mu \\langle k \\rangle} - \\frac{\\lambda_c^2 \\langle k^3 \\rangle}{\\mu^2 \\langle k \\rangle}\\Theta $$\nThe first term can be expanded:\n$$ \\frac{(\\lambda_c + \\epsilon) \\langle k^2 \\rangle}{\\mu \\langle k \\rangle} = \\frac{\\lambda_c \\langle k^2 \\rangle}{\\mu \\langle k \\rangle} + \\frac{\\epsilon \\langle k^2 \\rangle}{\\mu \\langle k \\rangle} $$\nBy definition of $\\lambda_c$, the first part of this expression is equal to $1$. So, the equation becomes:\n$$ 1 \\approx \\left( 1 + \\frac{\\epsilon \\langle k^2 \\rangle}{\\mu \\langle k \\rangle} \\right) - \\frac{\\lambda_c^2 \\langle k^3 \\rangle}{\\mu^2 \\langle k \\rangle}\\Theta $$\nRearranging the terms to solve for $\\Theta$:\n$$ \\frac{\\lambda_c^2 \\langle k^3 \\rangle}{\\mu^2 \\langle k \\rangle}\\Theta \\approx \\frac{\\epsilon \\langle k^2 \\rangle}{\\mu \\langle k \\rangle} $$\n$$ \\Theta \\approx \\epsilon \\left( \\frac{\\mu \\langle k^2 \\rangle}{\\lambda_c^2 \\langle k^3 \\rangle} \\right) $$\nSince $\\epsilon = \\lambda - \\lambda_c$, this shows that $\\Theta$ is directly proportional to the distance from the critical point:\n$$ \\Theta \\propto (\\lambda - \\lambda_c) $$\nFinally, we need to find the scaling of the total prevalence $\\rho = \\sum_k P(k) \\rho_k$. Near the threshold, $\\Theta$ is small, so we can use the first-order approximation for $\\rho_k$:\n$$ \\rho_k \\approx \\frac{\\lambda k \\Theta}{\\mu} \\approx \\frac{\\lambda_c k \\Theta}{\\mu} $$\nwhere we have again used $\\lambda \\approx \\lambda_c$ as $\\Theta$ is already of order $\\epsilon$.\nSubstituting this into the definition of $\\rho$:\n$$ \\rho = \\sum_k P(k) \\rho_k \\approx \\sum_k P(k) \\left( \\frac{\\lambda_c k \\Theta}{\\mu} \\right) = \\frac{\\lambda_c \\Theta}{\\mu} \\sum_k k P(k) = \\frac{\\lambda_c \\langle k \\rangle}{\\mu} \\Theta $$\nSince $\\frac{\\lambda_c \\langle k \\rangle}{\\mu}$ is a constant, the prevalence $\\rho$ scales linearly with $\\Theta$:\n$$ \\rho \\propto \\Theta $$\nCombining this with our result for $\\Theta$, we find the scaling of $\\rho$ with respect to $\\lambda - \\lambda_c$:\n$$ \\rho \\propto (\\lambda - \\lambda_c)^1 $$\nThe problem defines the critical exponent $\\beta$ through the relation $\\rho \\sim (\\lambda - \\lambda_c)^{\\beta}$. By comparing our derived scaling, we conclude that the exponent is $\\beta = 1$. This is a characteristic result for mean-field theories of phase transitions.",
            "answer": "$$\n\\boxed{1}\n$$"
        },
        {
            "introduction": "The ultimate test of any scientific model lies in understanding its domain of validity. The Heterogeneous Mean-field Theory rests on the crucial assumption that the network is uncorrelated. This computational exercise challenges you to move from pure theory to practical implementation and critical validation, where you will code both the HMF and the more detailed Quenched Mean-Field (QMF) models to compare their predictions on different network structures, including one where HMF is expected to fail . This practice directly illustrates the power and limitations of the HMF approximation.",
            "id": "4280379",
            "problem": "You are given three undirected, unweighted networks specified by their adjacency matrices. Consider the Susceptible-Infected-Susceptible (SIS) process with infection rate $\\beta$ and recovery rate $\\mu$. Define the effective infection rate as $\\lambda = \\beta / \\mu$, which is dimensionless. You will analyze the SIS dynamics using two mean-field descriptions:\n- Quenched Mean-Field (QMF): node-level description.\n- Heterogeneous Mean-Field (HMF): degree-class description for uncorrelated networks.\n\nFoundational definitions to use:\n- Let $A \\in \\{0,1\\}^{N \\times N}$ be a symmetric adjacency matrix with zeros on the diagonal. Let $k_i = \\sum_{j} A_{ij}$ be node degrees, $\\langle k \\rangle = \\frac{1}{N} \\sum_{i=1}^N k_i$, and $\\langle k^2 \\rangle = \\frac{1}{N} \\sum_{i=1}^N k_i^2$. Let $P(k)$ be the empirical degree distribution over the network nodes. Let $\\Lambda_{\\max}(A)$ denote the largest eigenvalue of $A$.\n- In Quenched Mean-Field (QMF), the node-level infection probabilities $x_i(t) \\in [0,1]$ evolve as $\\frac{dx_i}{dt} = -\\mu x_i + \\beta \\left(1 - x_i\\right) \\sum_{j} A_{ij} x_j$. A stationary solution satisfies $0 = -\\mu x_i + \\beta \\left(1 - x_i\\right) \\sum_{j} A_{ij} x_j$. The total stationary prevalence is $\\rho_{\\mathrm{QMF}} = \\frac{1}{N} \\sum_{i=1}^N x_i^\\ast$.\n- In Heterogeneous Mean-Field (HMF) for uncorrelated networks, the degree-class infection probabilities $\\rho_k(t) \\in [0,1]$ satisfy $\\frac{d \\rho_k}{dt} = -\\mu \\rho_k + \\beta k \\left(1 - \\rho_k\\right) \\Theta$, where $\\Theta$ is the probability that a randomly chosen edge points to an infected node. At stationarity, $0 = -\\mu \\rho_k + \\beta k \\left(1 - \\rho_k\\right) \\Theta$. The self-consistency relation is $\\Theta = \\sum_{k} \\frac{k P(k)}{\\langle k \\rangle} \\rho_k$. The total stationary prevalence is $\\rho_{\\mathrm{HMF}} = \\sum_k P(k) \\rho_k^\\ast$.\n\nYour tasks:\n1. Starting only from the above foundational definitions, derive the critical effective infection rate thresholds for the onset of a nontrivial stationary solution:\n   - The QMF threshold $\\lambda_c^{\\mathrm{QMF}}$.\n   - The HMF threshold $\\lambda_c^{\\mathrm{HMF}}$.\n   Your derivations must be linear stability analyses around the disease-free state.\n2. Implement numerical solvers for the stationary solutions:\n   - For QMF, solve the nonlinear fixed-point equations for $x_i^\\ast$ for a given $\\lambda$.\n   - For HMF, assuming no degree-degree correlations, solve the degree-based fixed-point equations and the self-consistency equation for $\\Theta$ for a given $\\lambda$.\n   Use $\\mu = 1$ without loss of generality. All quantities are dimensionless.\n3. Accuracy assessment protocol:\n   - For each network and for $\\lambda \\in \\{0.1, 0.2, 0.3, 0.5, 0.8, 1.0, 2.0\\}$, compute $\\rho_{\\mathrm{QMF}}(\\lambda)$ and $\\rho_{\\mathrm{HMF}}(\\lambda)$.\n   - Define the relative error $E(\\lambda) = \\frac{\\left|\\rho_{\\mathrm{HMF}}(\\lambda) - \\rho_{\\mathrm{QMF}}(\\lambda)\\right|}{\\max\\left(\\rho_{\\mathrm{QMF}}(\\lambda), \\varepsilon\\right)}$ with $\\varepsilon = 10^{-8}$ to avoid division by zero.\n   - Declare HMF \"accurate\" at that $\\lambda$ if $E(\\lambda) \\leq 0.1$, otherwise \"inaccurate.\"\n4. Compute both thresholds and determine the parameter regimes where HMF provides accurate predictions (and where it fails) according to the above protocol.\n\nTest suite:\nUse the following three adjacency matrices. The node indexing is $0,1,\\dots,N-1$. All matrices are symmetric and have zero diagonal. The dimensionless effective infection rate values to test are the seven-element set above. For each matrix, compute both thresholds and the accuracy flags for the seven $\\lambda$ values.\n\n- Case A (ring with $N=10$):\n  Adjacency $A_{ij} = 1$ if $j = (i \\pm 1) \\bmod 10$, else $0$.\n- Case B (star with $N=10$):\n  Adjacency $A_{0j} = A_{j0} = 1$ for $j \\in \\{1,\\dots,9\\}$; all other off-diagonal entries $0$.\n- Case C (moderately heterogeneous $N=10$) with edges:\n  $\\{(0,1),(1,2),(2,3),(3,4),(4,5),(5,0),(6,7),(7,8),(8,9),(9,6),(2,6),(4,7),(1,8),(5,9),(0,3),(0,6),(0,7)\\}$; interpret edges as undirected.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets.\n- Each entry corresponds to one adjacency matrix, in the order A, B, C, and must be a list of the form $[\\lambda_c^{\\mathrm{HMF}}, \\lambda_c^{\\mathrm{QMF}}, \\text{acc\\_flags}]$, where:\n  - $\\lambda_c^{\\mathrm{HMF}}$ and $\\lambda_c^{\\mathrm{QMF}}$ are floats rounded to six decimal places.\n  - $\\text{acc\\_flags}$ is a list of $7$ integers (one per $\\lambda$ in the order given) equal to $1$ if HMF is accurate and $0$ otherwise.\n- Example schematic (not actual values): $[[0.123456,0.234567,[1,0,1,1,0,1,1]],[\\dots],[\\dots]]$.\n\nAll quantities are dimensionless; no physical units apply. Angles are not involved. Percentages must not be used; use only decimals. The program must be complete and runnable and must produce exactly one line as specified, with no additional text.",
            "solution": "The problem statement has been validated and is deemed valid. It is scientifically grounded, well-posed, and objective, providing all necessary information for a complete solution.\n\nThe problem requires the derivation of epidemic thresholds for two mean-field models of an SIS process on a network and a numerical comparison of their predictions. The two models are the Quenched Mean-Field (QMF) theory, a node-level description, and the Heterogeneous Mean-Field (HMF) theory, a degree-class-level description.\n\n**1. Derivation of Critical Thresholds**\n\nThe critical threshold $\\lambda_c$ marks the point where the disease-free state ($x_i=0$ for all nodes $i$, or $\\rho_k=0$ for all degrees $k$) loses stability, allowing for an endemic steady state to exist. We find this threshold by performing a linear stability analysis of the governing equations around this disease-free fixed point.\n\n**Quenched Mean-Field (QMF) Threshold ($\\lambda_c^{\\mathrm{QMF}}$)**\n\nThe QMF dynamics are given by $\\frac{dx_i}{dt} = F_i(\\vec{x}) = -\\mu x_i + \\beta \\left(1 - x_i\\right) \\sum_{j} A_{ij} x_j$.\nTo analyze the stability of the fixed point $\\vec{x}=\\vec{0}$, we examine the Jacobian matrix $J$ of the system evaluated at this point. The elements of the Jacobian are $J_{ij} = \\frac{\\partial F_i}{\\partial x_j}|_{\\vec{x}=0}$.\n$$ \\frac{\\partial F_i}{\\partial x_j} = \\frac{\\partial}{\\partial x_j} \\left( -\\mu x_i + \\beta \\sum_{k} A_{ik} x_k - \\beta x_i \\sum_{k} A_{ik} x_k \\right) $$\n$$ \\frac{\\partial F_i}{\\partial x_j} = -\\mu \\delta_{ij} + \\beta A_{ij} - \\beta \\delta_{ij} \\sum_{k} A_{ik} x_k - \\beta x_i A_{ij} $$\nEvaluating at $\\vec{x}=\\vec{0}$:\n$$ J_{ij} = \\frac{\\partial F_i}{\\partial x_j}\\bigg|_{\\vec{x}=0} = -\\mu \\delta_{ij} + \\beta A_{ij} $$\nIn matrix form, the Jacobian is $J = \\beta A - \\mu I$, where $A$ is the adjacency matrix and $I$ is the identity matrix. The disease-free state becomes unstable when the largest eigenvalue of $J$ becomes positive. The eigenvalues of $J$ are $\\eta_k = \\beta \\Lambda_k(A) - \\mu$, where $\\Lambda_k(A)$ are the eigenvalues of $A$. The largest eigenvalue of $J$ is $\\eta_{\\max} = \\beta \\Lambda_{\\max}(A) - \\mu$, where $\\Lambda_{\\max}(A)$ is the largest eigenvalue of $A$.\nThe instability condition is $\\eta_{\\max}  0$:\n$$ \\beta \\Lambda_{\\max}(A) - \\mu  0 \\implies \\frac{\\beta}{\\mu} \\Lambda_{\\max}(A)  1 $$\nUsing the definition of the effective infection rate $\\lambda = \\beta/\\mu$, the condition is $\\lambda \\Lambda_{\\max}(A)  1$. The critical threshold is the value of $\\lambda$ at which this inequality becomes an equality.\n$$ \\lambda_c^{\\mathrm{QMF}} = \\frac{1}{\\Lambda_{\\max}(A)} $$\n\n**Heterogeneous Mean-Field (HMF) Threshold ($\\lambda_c^{\\mathrm{HMF}}$)**\n\nThe HMF stationary state is given by the equations:\n1. $0 = -\\mu \\rho_k + \\beta k \\left(1 - \\rho_k\\right) \\Theta$\n2. $\\Theta = \\sum_{k} \\frac{k P(k)}{\\langle k \\rangle} \\rho_k$\n\nThe disease-free state corresponds to $\\rho_k = 0$ for all $k$, and thus $\\Theta = 0$. We linearize around this state by letting $\\rho_k = \\epsilon_k$ and $\\Theta = \\delta$, where these are infinitesimal quantities.\nFrom equation (1), we linearize by dropping the $\\rho_k \\Theta$ term:\n$$ 0 \\approx -\\mu \\epsilon_k + \\beta k \\Theta \\implies \\epsilon_k = \\frac{\\beta k}{\\mu} \\Theta = \\lambda k \\Theta $$\nSubstituting this linear relationship into the self-consistency equation (2), which is already linear:\n$$ \\Theta = \\sum_{k} \\frac{k P(k)}{\\langle k \\rangle} (\\lambda k \\Theta) $$\nFor a non-trivial solution ($\\Theta  0$), we can divide by $\\Theta$:\n$$ 1 = \\sum_{k} \\frac{k P(k)}{\\langle k \\rangle} (\\lambda k) = \\frac{\\lambda}{\\langle k \\rangle} \\sum_{k} k^2 P(k) $$\nThe term $\\sum_{k} k^2 P(k)$ is the second moment of the degree distribution, $\\langle k^2 \\rangle$.\n$$ 1 = \\frac{\\lambda}{\\langle k \\rangle} \\langle k^2 \\rangle $$\nSolving for the critical value of $\\lambda$:\n$$ \\lambda_c^{\\mathrm{HMF}} = \\frac{\\langle k \\rangle}{\\langle k^2 \\rangle} $$\n\n**2. Numerical Solution Strategy**\n\nWe set $\\mu=1$ without loss of generality, so $\\lambda = \\beta$. All quantities are dimensionless.\n\n**QMF Solver:** The stationary state for QMF is found by solving the system of $N$ nonlinear equations for the node-level prevalences $x_i^*$:\n$$ x_i^* = \\frac{\\lambda \\sum_{j} A_{ij} x_j^*}{1 + \\lambda \\sum_j A_{ij} x_j^*} $$\nThis system is solved using fixed-point iteration. We initialize the prevalence vector $\\vec{x}$ with small positive values (e.g., $x_i^{(0)} = 10^{-5}$) and iterate $\\vec{x}^{(t+1)} = F(\\vec{x}^{(t)})$ where $F_i(\\vec{x}) = \\frac{\\lambda (A\\vec{x})_i}{1 + \\lambda (A\\vec{x})_i}$. The iteration proceeds until the maximum absolute difference between successive vectors, $\\|\\vec{x}^{(t+1)} - \\vec{x}^{(t)}\\|_\\infty$, falls below a small tolerance (e.g., $10^{-9}$). If $\\lambda \\leq \\lambda_c^{\\mathrm{QMF}}$, this process converges to $\\vec{x}^* = \\vec{0}$. The total prevalence is then $\\rho_{\\mathrm{QMF}} = \\frac{1}{N}\\sum_i x_i^*$.\n\n**HMF Solver:** The HMF stationary state is found by solving for $\\Theta$, the probability that an edge points to an infected node. First, we express $\\rho_k$ in terms of $\\Theta$ from the primary HMF equation:\n$$ \\rho_k^* = \\frac{\\lambda k \\Theta^*}{1 + \\lambda k \\Theta^*} $$\nSubstituting this into the self-consistency equation gives a single nonlinear equation for $\\Theta^*$:\n$$ \\Theta^* = \\sum_{k} \\frac{k P(k)}{\\langle k \\rangle} \\left( \\frac{\\lambda k \\Theta^*}{1 + \\lambda k \\Theta^*} \\right) $$\nThis equation is also solved via fixed-point iteration. Starting with an initial guess $\\Theta^{(0)}  0$ (e.g., $0.1$), we iterate $\\Theta^{(t+1)} = G(\\Theta^{(t)})$ until convergence, where $G$ is the right-hand side of the equation. If $\\lambda \\leq \\lambda_c^{\\mathrm{HMF}}$, this converges to $\\Theta^* = 0$. Once $\\Theta^*$ is found, the total prevalence is computed as $\\rho_{\\mathrm{HMF}} = \\sum_k P(k) \\rho_k^*$.\n\n**3. Accuracy Assessment**\n\nFor each network and each provided value of $\\lambda$, we compute the total prevalences $\\rho_{\\mathrm{QMF}}(\\lambda)$ and $\\rho_{\\mathrm{HMF}}(\\lambda)$. The relative error $E(\\lambda)$ is calculated to quantify the discrepancy between the HMF approximation and the more detailed QMF model:\n$$ E(\\lambda) = \\frac{\\left|\\rho_{\\mathrm{HMF}}(\\lambda) - \\rho_{\\mathrm{QMF}}(\\lambda)\\right|}{\\max\\left(\\rho_{\\mathrm{QMF}}(\\lambda), \\varepsilon\\right)}, \\quad \\text{with } \\varepsilon = 10^{-8} $$\nHMF is deemed \"accurate\" if $E(\\lambda) \\leq 0.1$. The results are reported as a series of binary flags for each network and value of $\\lambda$. The HMF model is based on the assumption of no degree-degree correlations (i.e., the network is uncorrelated), so its accuracy will diminish in networks with strong correlations, such as the star graph. For regular graphs, HMF is exact.",
            "answer": "```python\nimport numpy as np\n\ndef build_networks():\n    \"\"\"\n    Builds the adjacency matrices for the three test cases.\n    \"\"\"\n    # Case A: Ring network, N=10\n    A_ring = np.zeros((10, 10), dtype=float)\n    for i in range(10):\n        A_ring[i, (i + 1) % 10] = 1\n        A_ring[i, (i - 1 + 10) % 10] = 1\n\n    # Case B: Star network, N=10\n    A_star = np.zeros((10, 10), dtype=float)\n    A_star[0, 1:] = 1\n    A_star[1:, 0] = 1\n\n    # Case C: Moderately heterogeneous network, N=10\n    edges_c = [\n        (0,1),(1,2),(2,3),(3,4),(4,5),(5,0),(6,7),(7,8),(8,9),(9,6),\n        (2,6),(4,7),(1,8),(5,9),(0,3),(0,6),(0,7)\n    ]\n    A_hetero = np.zeros((10, 10), dtype=float)\n    for i, j in edges_c:\n        A_hetero[i, j] = 1\n        A_hetero[j, i] = 1\n        \n    return [A_ring, A_star, A_hetero]\n\ndef solve_qmf(A, lam, N, tol=1e-9, max_iter=2000):\n    \"\"\"\n    Solves for the stationary prevalence in the Quenched Mean-Field model.\n    \"\"\"\n    x = np.full(N, 1e-5, dtype=float)  # Initial small positive prevalence\n    for _ in range(max_iter):\n        Ax = A @ x\n        with np.errstate(divide='ignore', invalid='ignore'):\n             x_new = (lam * Ax) / (1.0 + lam * Ax)\n        x_new[np.isnan(x_new)] = 0.0 # Handle potential division by zero\n        \n        if np.linalg.norm(x_new - x, ord=np.inf)  tol:\n            x = x_new\n            break\n        x = x_new\n        \n    return np.mean(x)\n\ndef solve_hmf(lam, k_mean, degree_dist, tol=1e-9, max_iter=2000):\n    \"\"\"\n    Solves for the stationary prevalence in the Heterogeneous Mean-Field model.\n    \"\"\"\n    if k_mean == 0:\n        return 0.0\n\n    # Initial guess for Theta  0 to find endemic solution if it exists\n    theta = 0.1\n    \n    k_vals = np.array(list(degree_dist.keys()), dtype=float)\n    pk_vals = np.array(list(degree_dist.values()), dtype=float)\n    \n    for _ in range(max_iter):\n        # Calculate rho_k for the current theta\n        rho_k = (lam * k_vals * theta) / (1.0 + lam * k_vals * theta)\n        \n        # Update theta using the self-consistency equation\n        theta_new = np.sum(k_vals * pk_vals * rho_k) / k_mean\n        \n        if abs(theta_new - theta)  tol:\n            theta = theta_new\n            break\n        theta = theta_new\n        \n    # Calculate final prevalence using the converged theta\n    rho_k_final = (lam * k_vals * theta) / (1.0 + lam * k_vals * theta)\n    rho_hmf = np.sum(pk_vals * rho_k_final)\n    \n    return rho_hmf\n\ndef process_network(A, lambdas):\n    \"\"\"\n    Computes thresholds and accuracy flags for a single network.\n    \"\"\"\n    N = A.shape[0]\n    \n    # 1. Compute network statistics and thresholds\n    degrees = A.sum(axis=1)\n    k_mean = np.mean(degrees)\n    k2_mean = np.mean(degrees**2)\n    \n    lambda_c_hmf = k_mean / k2_mean if k2_mean  0 else float('inf')\n\n    eigenvalues = np.linalg.eigvalsh(A)\n    lambda_max = np.max(eigenvalues)\n    lambda_c_qmf = 1.0 / lambda_max if lambda_max  1e-9 else float('inf')\n\n    # Get degree distribution P(k)\n    unique_degrees, counts = np.unique(degrees, return_counts=True)\n    degree_dist = {int(k): p for k, p in zip(unique_degrees, counts / N)}\n\n    # 2. Loop over lambdas to solve and assess accuracy\n    acc_flags = []\n    epsilon = 1e-8\n    \n    for lam in lambdas:\n        rho_qmf = solve_qmf(A, lam, N)\n        rho_hmf = solve_hmf(lam, k_mean, degree_dist)\n        \n        # 3. Accuracy assessment\n        error = np.abs(rho_hmf - rho_qmf) / max(rho_qmf, epsilon)\n        acc_flags.append(1 if error = 0.1 else 0)\n        \n    return [lambda_c_hmf, lambda_c_qmf, acc_flags]\n\ndef solve():\n    \"\"\"\n    Main function to orchestrate the solution process.\n    \"\"\"\n    # Define test cases per the problem statement\n    networks = build_networks()\n    lambdas = [0.1, 0.2, 0.3, 0.5, 0.8, 1.0, 2.0]\n    \n    results = []\n    for A in networks:\n        case_result = process_network(A, lambdas)\n        results.append(case_result)\n        \n    # Format the output string exactly as required\n    final_output_parts = []\n    for res in results:\n        l_hmf, l_qmf, flags = res\n        l_hmf_str = f\"{l_hmf:.6f}\"\n        l_qmf_str = f\"{l_qmf:.6f}\"\n        flags_str = f\"[{','.join(map(str, flags))}]\"\n        final_output_parts.append(f\"[{l_hmf_str},{l_qmf_str},{flags_str}]\")\n        \n    print(f\"[{','.join(final_output_parts)}]\")\n\nsolve()\n```"
        }
    ]
}