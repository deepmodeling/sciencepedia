{
    "hands_on_practices": [
        {
            "introduction": "在网络对齐领域，最基础的问题便是判断两个网络在结构上是否完全相同，即图同构问题。本练习将引导您使用图不变量——那些在节点任意重新标记后仍保持不变的性质——来亲手检验图的同构性。通过计算和比较诸如度序列和闭路计数等不变量，您将学会如何高效地判定两个图是否不同构，而无需详尽地检查所有可能的节点映射。",
            "id": "4279396",
            "problem": "考虑两个具有$6$个节点的无向简单标记图，它们由其邻接矩阵 $A$ 和 $B$ 在标准的、由标签诱导的基 $\\{1,2,3,4,5,6\\}$ 中表示。在网络对齐 (NA) 和图匹配的背景下，两个图同构当且仅当存在一个置换矩阵 $P$ 使得 $B = P^{\\top} A P$。要求您通过基于图同构下保持的核心定义和不变量（例如，度序列、谱、闭路计数）进行推理，来确定对于下面给出的特定矩阵是否存在这样的置换矩阵，并报告一个表示同构是否存在的单一数字。\n\n邻接矩阵 $A$ 和 $B$ 如下：\n$$\nA = \\begin{pmatrix}\n0  0  1  1  1  0 \\\\\n0  0  1  1  0  1 \\\\\n1  1  0  0  0  0 \\\\\n1  1  0  0  0  0 \\\\\n1  0  0  0  0  0 \\\\\n0  1  0  0  0  0\n\\end{pmatrix}, \\quad\nB = \\begin{pmatrix}\n0  1  1  0  1  0 \\\\\n1  0  1  1  0  0 \\\\\n1  1  0  0  0  0 \\\\\n0  1  0  0  0  1 \\\\\n1  0  0  0  0  0 \\\\\n0  0  0  1  0  0\n\\end{pmatrix}.\n$$\n\n根据图同构的基本定义，如果对于某个置换矩阵 $P$ 有 $B = P^{\\top} A P$，那么 $A$ 和 $B$ 必须共享所有在此类重新标记下保持不变的不变量，包括排序后的度序列、邻接矩阵的特征值谱，以及任何可以表示为邻接矩阵多项式的迹的量。从这些核心定义出发，判断是否存在一个满足 $B = P^{\\top} A P$ 的置换矩阵 $P$。\n\n定义指示符 $I$ 为：\n$$\nI = \\begin{cases}\n1  \\text{如果存在置换矩阵 } P \\text{ 使得 } B = P^{\\top} A P, \\\\\n0  \\text{否则。}\n\\end{cases}\n$$\n\n您的任务：\n- 仅使用置换相似性下保持的核心定义和不变量来论证是否存在这样的置换矩阵 $P$。\n- 计算并报告单一标量 $I$ 作为最终答案。无需四舍五入。",
            "solution": "问题要求确定由邻接矩阵 $A$ 和 $B$ 表示的两个图是否同构。两个简单图是同构的，当且仅当存在一个对其中一个图的顶点标签的置换，使其与另一个图完全相同。在代数上，这等价于存在一个置换矩阵 $P$，使得邻接矩阵 $A$ 和 $B$ 通过相似变换 $B = P^{\\top} A P$ 相关联。请注意，对于置换矩阵，其逆矩阵等于其转置，即 $P^{-1} = P^{\\top}$。\n\n两个图同构的一个必要条件是它们所有的图不变量都必须相同。图不变量是图的属性，仅依赖于其抽象结构，而不依赖于顶点的具体标记。如果我们能找到一个在这两个图之间不同的不变量，我们就可以断定它们不是同构的。问题建议考虑诸如度序列、特征值谱和闭路计数等不变量。\n\n邻接矩阵如下所示：\n$$\nA = \\begin{pmatrix}\n0  0  1  1  1  0 \\\\\n0  0  1  1  0  1 \\\\\n1  1  0  0  0  0 \\\\\n1  1  0  0  0  0 \\\\\n1  0  0  0  0  0 \\\\\n0  1  0  0  0  0\n\\end{pmatrix}, \\quad\nB = \\begin{pmatrix}\n0  1  1  0  1  0 \\\\\n1  0  1  1  0  0 \\\\\n1  1  0  0  0  0 \\\\\n0  1  0  0  0  1 \\\\\n1  0  0  0  0  0 \\\\\n0  0  0  1  0  0\n\\end{pmatrix}.\n$$\n两个矩阵都是对称的且对角线元素为零，正确地表示了具有 $N=6$ 个顶点的无向简单图。\n\n首先，我们检查最基本的不变量。\n两个图的顶点数均为 $N=6$。\n边数是 $m = \\frac{1}{2} \\sum_{i,j} M_{ij}$。\n对于图 A，所有元素的总和是 $12$，所以 $m_A = \\frac{12}{2} = 6$。\n对于图 B，所有元素的总和是 $12$，所以 $m_B = \\frac{12}{2} = 6$。\n\n接下来，我们计算每个图的度序列。顶点 $i$ 的度是邻接矩阵第 $i$ 行元素的和。\n对于图 A，顶点 $1$ 到 $6$ 的度分别为：\n$d_A(1) = 3$, $d_A(2) = 3$, $d_A(3) = 2$, $d_A(4) = 2$, $d_A(5) = 1$, $d_A(6) = 1$。\nA 的排序度序列是 $(3, 3, 2, 2, 1, 1)$。\n\n对于图 B，度分别为：\n$d_B(1) = 3$, $d_B(2) = 3$, $d_B(3) = 2$, $d_B(4) = 2$, $d_B(5) = 1$, $d_B(6) = 1$。\nB 的排序度序列是 $(3, 3, 2, 2, 1, 1)$。\n\n由于度序列相同，这个不变量不足以区分这两个图。\n\n我们现在转向一组更强大的不变量：长度为 $k$ 的闭路数量。这由邻接矩阵的 $k$ 次幂的迹给出，即 $\\mathrm{tr}(M^k)$。如果 $B = P^{\\top} A P$，则 $B^k = P^{\\top} A^k P$，并且根据迹的循环性质，有 $\\mathrm{tr}(B^k) = \\mathrm{tr}(P^{\\top} A^k P) = \\mathrm{tr}(A^k P P^{\\top}) = \\mathrm{tr}(A^k I) = \\mathrm{tr}(A^k)$。因此，对于同构图，其邻接矩阵所有次幂的迹必须相等。\n\n对于 $k=0$，$\\mathrm{tr}(A^0) = \\mathrm{tr}(I_6) = 6$ 且 $\\mathrm{tr}(B^0) = \\mathrm{tr}(I_6) = 6$。\n对于 $k=1$，$\\mathrm{tr}(A) = 0$ 且 $\\mathrm{tr}(B) = 0$，这对于简单图是预期的。\n对于 $k=2$，$\\mathrm{tr}(M^2) = \\sum_{i} d_i$。由于度序列相同，$\\mathrm{tr}(A^2) = \\sum d_A(i) = 12$ 且 $\\mathrm{tr}(B^2) = \\sum d_B(i) = 12$。\n\n让我们研究 $k=3$ 的情况。$\\mathrm{tr}(M^3)$ 的值是长度为 $3$ 的闭路总数。在一个简单无向图中，唯一长度为 $3$ 的闭路是三角形（3-环）。每个三角形 $\\{i,j,k\\}$ 对应于 $6$ 个有向闭路（$i \\to j \\to k \\to i$、$i \\to k \\to j \\to i$ 及其循环置换），所以 $\\mathrm{tr}(M^3) = 6 \\times (\\text{三角形数量})$。\n\n考虑图 A。我们可以检查是否存在三角形，或者更有效地，分析其结构。让我们尝试将顶点划分为两个集合 $U$ 和 $V$，使得所有边都连接 $U$ 中的一个顶点和 $V$ 中的一个顶点。令 $U = \\{1, 2\\}$ 和 $V = \\{3, 4, 5, 6\\}$。\n图 A 中的边是：$(1,3), (1,4), (1,5), (2,3), (2,4), (2,6)$。\n我们观察到，在 $U$ 内部没有连接两个顶点的边（例如 $(1,2)$），在 $V$ 内部也没有连接任意两个顶点的边。所有边都连接一个来自 $U$ 的顶点和一个来自 $V$ 的顶点。因此，图 A 是一个二分图。二分图的一个基本性质是它们不包含奇数长度的环。因此，图 A 不包含三角形。这意味着 A 中三角形的数量为 $0$，因此 $\\mathrm{tr}(A^3) = 0$。\n\n现在考虑图 B。我们检查其邻接矩阵以寻找三角形。如果 $B_{ij}=B_{jk}=B_{ki}=1$，则顶点 $\\{i,j,k\\}$ 之间存在一个三角形。让我们测试集合 $\\{1,2,3\\}$。\n$B_{12}=1$, $B_{23}=1$，且 $B_{31}=1$。\n因此，顶点 $\\{1,2,3\\}$ 在图 B 中形成一个三角形。存在至少一个三角形意味着 B 中的三角形数量至少为 $1$，因此 $\\mathrm{tr}(B^3) \\ge 6$。\n\n由于我们找到了一个不同的不变量，$\\mathrm{tr}(A^3) \\neq \\mathrm{tr}(B^3)$，我们可以明确地得出结论，这两个图不是同构的。\n\n为了完整起见，我们可以明确地计算 $\\mathrm{tr}(B^3)$。\n$$\nB^2 = \\begin{pmatrix}\n0  1  1  0  1  0 \\\\\n1  0  1  1  0  0 \\\\\n1  1  0  0  0  0 \\\\\n0  1  0  0  0  1 \\\\\n1  0  0  0  0  0 \\\\\n0  0  0  1  0  0\n\\end{pmatrix}^2 = \\begin{pmatrix}\n3  1  1  1  0  0 \\\\\n1  3  1  0  1  1 \\\\\n1  1  2  1  1  0 \\\\\n1  0  1  2  0  0 \\\\\n0  1  1  0  1  0 \\\\\n0  1  0  0  0  1\n\\end{pmatrix}\n$$\n$B^3$ 的迹可以计算为 $\\mathrm{tr}(B^3) = \\sum_{i,j,k} B_{ij}B_{jk}B_{ki}$。\n这个计算得出：\n$(B^3)_{11} = \\sum_j B_{1j}(B^2)_{j1} = B_{12}(B^2)_{21} + B_{13}(B^2)_{31} + B_{15}(B^2)_{51} = 1(1) + 1(1) + 1(0) = 2$。\n$(B^3)_{22} = \\sum_j B_{2j}(B^2)_{j2} = B_{21}(B^2)_{12} + B_{23}(B^2)_{32} + B_{24}(B^2)_{42} = 1(1) + 1(1) + 1(0) = 2$。\n$(B^3)_{33} = \\sum_j B_{3j}(B^2)_{j3} = B_{31}(B^2)_{13} + B_{32}(B^2)_{23} = 1(1) + 1(1) = 2$。\n$(B^3)_{44} = \\sum_j B_{4j}(B^2)_{j4} = B_{42}(B^2)_{24} + B_{46}(B^2)_{64} = 1(0) + 1(0) = 0$。\n$(B^3)_{55} = \\sum_j B_{5j}(B^2)_{j5} = B_{51}(B^2)_{15} = 1(0) = 0$。\n$(B^3)_{66} = \\sum_j B_{6j}(B^2)_{j6} = B_{64}(B^2)_{46} = 1(0) = 0$。\n所以，$\\mathrm{tr}(B^3) = 2+2+2+0+0+0 = 6$。\n\n比较不变量：\n$\\mathrm{tr}(A^3) = 0$\n$\\mathrm{tr}(B^3) = 6$\n由于 $\\mathrm{tr}(A^3) \\neq \\mathrm{tr}(B^3)$， $A$ 和 $B$ 的特征值谱也必定不同，因为 $\\mathrm{tr}(M^k) = \\sum_i \\lambda_i^k$。谱的不同是非同构的另一个佐证。\n\n因为一个图不变量不同，由 $A$ 和 $B$ 表示的图是不同构的。\n因此，不存在置换矩阵 $P$ 使得 $B = P^{\\top} A P$。\n指示变量 $I$ 的定义是：如果存在这样的矩阵，则为 $1$，否则为 $0$。我们得出结论 $I=0$。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "当两个图并非同构时，我们转而寻求它们之间的“最佳”匹配，这个问题在数学上常被表述为二次分配问题（QAP）。本练习将带您深入 QAP 的核心，通过一个具体的例子计算其精确解，并将其与谱松弛这一强大近似方法的解进行比较。这个过程将清晰地揭示“整数规划间隙”的概念，这是理解和评估许多现代网络对齐算法性能的关键。",
            "id": "4279389",
            "problem": "设给定矩阵 $A \\in \\mathbb{R}^{3 \\times 3}$ 和 $B \\in \\mathbb{R}^{3 \\times 3}$ 为\n$$\nA \\;=\\; \\begin{pmatrix}\n0  1  0 \\\\\n1  0  1 \\\\\n0  1  0\n\\end{pmatrix}, \n\\qquad\nB \\;=\\; \\begin{pmatrix}\n2  0  0 \\\\\n0  -1  0 \\\\\n0  0  0\n\\end{pmatrix}.\n$$\n考虑二次分配问题 (QAP)，对于给定的矩阵对 $A$ 和 $B$，该问题旨在寻找一个置换矩阵 $P \\in \\mathbb{R}^{3 \\times 3}$，以最大化目标函数\n$$\nf(P) \\;=\\; \\operatorname{trace}\\!\\big(A\\,P\\,B\\,P^{\\top}\\big).\n$$\n置换矩阵是其中的元素属于 $\\{0,1\\}$，每行每列恰好有一个 $1$ 且满足 $P^{\\top} P = I$ 的矩阵。该目标函数可以等价地写为弗罗贝尼乌斯内积 $f(P) = \\langle P^{\\top} A P,\\, B \\rangle_{\\!F} = \\sum_{i,j=1}^{3} (P^{\\top} A P)_{ij} B_{ij}$。\n\n任务：\n- 仅使用上述定义和基本的线性代数性质，计算所有 $6$ 个置换矩阵 $P$ 的 $f(P)$ 值，并确定一个最优的 $P$ 以及相应的最优整数（置换）值 $V_{\\mathrm{int}}$。\n- 考虑 QAP 的正交松弛，其中 $P$ 被替换为一个满足 $X^{\\top} X = I$ 的正交矩阵 $X \\in \\mathbb{R}^{3 \\times 3}$，目标函数变为\n$$\nf(X) \\;=\\; \\operatorname{trace}\\!\\big(A\\,X\\,B\\,X^{\\top}\\big).\n$$\n- 从实对称矩阵的谱定理和成熟的迹不等式出发，推导出最优松弛值 $V_{\\mathrm{rel}} = \\max_{X^{\\top} X = I} \\operatorname{trace}(A X B X^{\\top})$ 的闭式解。\n- 定义整数性差距为 $\\Delta \\;=\\; V_{\\mathrm{rel}} - V_{\\mathrm{int}}$，并以简化的解析表达式给出其精确值。\n\n您的最终答案必须是 $\\Delta$ 的单个闭式表达式。不要四舍五入；不需要单位。请用简化的精确表达式作答。",
            "solution": "我们首先回顾核心定义和事实：\n- 置换矩阵 $P$ 满足 $P^{\\top} P = I$，并且每行每列有一个 $1$。\n- 二次分配问题 (QAP) 的目标函数可以写为 $f(P) = \\operatorname{trace}(A P B P^{\\top}) = \\langle P^{\\top} A P, B \\rangle_{\\!F}$，其中 $\\langle M, N \\rangle_{\\!F} = \\operatorname{trace}(M^{\\top} N)$ 是弗罗贝尼乌斯内积。\n- 对于正交松弛，我们考虑满足 $X^{\\top} X = I$ 的矩阵 $X \\in \\mathbb{R}^{3 \\times 3}$，并最大化 $f(X) = \\operatorname{trace}(A X B X^{\\top})$。\n- 对于实对称矩阵，根据谱定理，有 $A = U \\Lambda_A U^{\\top}$ 和 $B = V \\Lambda_B V^{\\top}$，其中 $U, V$ 是正交矩阵，$\\Lambda_A, \\Lambda_B$ 是由特征值组成的对角矩阵。一个成熟的结果（von Neumann 迹不等式应用于对称矩阵，并结合重排原理）意味着\n$$\n\\max_{X^{\\top} X = I} \\operatorname{trace}(A X B X^{\\top})\n\\;=\\;\n\\sum_{i=1}^{3} \\lambda_i^{\\downarrow}(A)\\,\\lambda_i^{\\downarrow}(B),\n$$\n其中 $\\lambda_i^{\\downarrow}(\\cdot)$ 表示按非增次序排序的特征值，最大值是通过对齐与相似排序的特征值相关联的特征向量来获得的。\n\n步骤 $1$：计算所有置换矩阵 $P$ 的 $f(P)$ 值并求出 $V_{\\mathrm{int}}$。\n- 给定的矩阵 $B$ 是对角矩阵：$B = \\operatorname{diag}(2, -1, 0)$。对于任意置换矩阵 $P$，相似变换后的矩阵 $P B P^{\\top}$ 也是对角矩阵，其对角线元素是 $(2, -1, 0)$ 的一个排列。\n- QAP 目标函数可以表示为内积：\n$$\nf(P) \\;=\\; \\langle P^{\\top} A P,\\, B \\rangle_{\\!F}.\n$$\n- 因为 $B$ 是对角矩阵，对于任意矩阵 $M$，有 $\\langle M, B \\rangle_{\\!F} = \\sum_{i=1}^{3} M_{ii} B_{ii}$。因此，\n$$\nf(P) \\;=\\; \\sum_{i=1}^{3} \\big(P^{\\top} A P\\big)_{ii} \\, \\big(P B P^{\\top}\\big)_{ii}.\n$$\n- 矩阵 $P^{\\top} A P$ 是 $A$ 的一个置换相似矩阵，因此其对角线元素的多重集与 $A$ 相同，只是索引被置换了。由于 $A$ 的对角线元素为零，即 $A_{11} = A_{22} = A_{33} = 0$，因此 $\\big(P^{\\top} A P\\big)_{ii}$ 对所有 $i$ 也为 $0$。因此，\n$$\nf(P) \\;=\\; \\sum_{i=1}^{3} 0 \\cdot \\big(P B P^{\\top}\\big)_{ii} \\;=\\; 0\n$$\n对于每个置换矩阵 $P$。\n- 因此，所有 $6$ 个置换都得到相同的目标值 $f(P) = 0$，任何置换矩阵都是最优的。最优整数（置换）值为\n$$\nV_{\\mathrm{int}} \\;=\\; 0.\n$$\n\n步骤 $2$：求解正交松弛问题并计算 $V_{\\mathrm{rel}}$。\n- 我们将松弛后的目标函数写为\n$$\nf(X) \\;=\\; \\operatorname{trace}\\!\\big(A X B X^{\\top}\\big),\n\\quad \\text{subject to } X^{\\top} X = I.\n$$\n- 由于 $A$ 和 $B$ 是对称矩阵，我们将它们对角化。$B$ 的特征值是其对角线元素，所以\n$$\n\\lambda(B) \\;=\\; \\big(2,\\, -1,\\, 0\\big).\n$$\n- 接下来，我们求 $A$ 的特征值。$A$ 的特征多项式由下式计算\n$$\n\\det(\\lambda I - A)\n\\;=\\;\n\\begin{vmatrix}\n\\lambda  -1  0 \\\\\n-1  \\lambda  -1 \\\\\n0  -1  \\lambda\n\\end{vmatrix}\n\\;=\\;\n\\lambda \\begin{vmatrix}\n\\lambda  -1 \\\\\n-1  \\lambda\n\\end{vmatrix}\n\\;-\\; (-1) \\begin{vmatrix}\n-1  0 \\\\\n-1  \\lambda\n\\end{vmatrix}\n\\;=\\;\n\\lambda(\\lambda^{2}-1) \\;-\\; \\big((1)\\cdot \\lambda - 0\\big)\n\\;=\\;\n\\lambda^{3} - \\lambda - \\lambda\n\\;=\\;\n\\lambda^{3} - 2\\lambda.\n$$\n- 其根满足 $\\lambda(\\lambda^{2} - 2) = 0$，因此\n$$\n\\lambda(A) \\;=\\; \\big(\\sqrt{2},\\, 0,\\, -\\sqrt{2}\\big).\n$$\n- 根据谱定理和适用于对称矩阵的 von Neumann 迹不等式，最优松弛值是通过对齐特征向量，使得相似排序的特征值配对来获得的。将两个谱按非增次序排序，我们得到\n$$\n\\lambda^{\\downarrow}(A) \\;=\\; \\big(\\sqrt{2},\\, 0,\\, -\\sqrt{2}\\big), \n\\qquad\n\\lambda^{\\downarrow}(B) \\;=\\; \\big(2,\\, 0,\\, -1\\big).\n$$\n- 因此，\n$$\nV_{\\mathrm{rel}}\n\\;=\\;\n\\sum_{i=1}^{3} \\lambda_i^{\\downarrow}(A)\\,\\lambda_i^{\\downarrow}(B)\n\\;=\\;\n\\sqrt{2}\\cdot 2 \\;+\\; 0\\cdot 0 \\;+\\; (-\\sqrt{2})\\cdot (-1)\n\\;=\\;\n2\\sqrt{2} \\;+\\; \\sqrt{2}\n\\;=\\;\n3\\sqrt{2}.\n$$\n\n步骤 $3$：计算整数性差距 $\\Delta$。\n- 根据定义，\n$$\n\\Delta \\;=\\; V_{\\mathrm{rel}} - V_{\\mathrm{int}}\n\\;=\\;\n3\\sqrt{2} - 0\n\\;=\\;\n3\\sqrt{2}.\n$$\n\n因此，正交松弛值严格超过了最优置换值，这说明了在此实例上存在一个非零的整数性差距，其精确值为 $3\\sqrt{2}$。",
            "answer": "$$\\boxed{3\\sqrt{2}}$$"
        },
        {
            "introduction": "理论上优雅的 QAP 模型在应用于现实世界的稀疏网络时会遇到一个实际的陷阱：对齐“非边”的贡献可能会淹没“边”匹配所包含的关键结构信号。本练习挑战您从统计学的视角出发，推導出一个加权评分方案，以精确平衡边和非边的预期贡献。这个推导过程将展示如何通过统计建模来设计出在稀疏数据下更为鲁棒和有效的对齐算法。",
            "id": "4279336",
            "problem": "考虑两个没有自环的简单无向图 $G_{1}$ 和 $G_{2}$，它们都建立在大小为 $n$ 的相同顶点集上，其邻接矩阵分别为 $A \\in \\{0,1\\}^{n \\times n}$ 和 $B \\in \\{0,1\\}^{n \\times n}$。假设 $G_{1}$ 是一个边概率为 $p_{1} \\in (0,1)$ 的 Erdős–Rényi (ER) 图的实现，而 $G_{2}$ 是一个独立的、边概率为 $p_{2} \\in (0,1)$ 的 Erdős–Rényi 图的实现。对于任意置换矩阵 $P \\in \\{0,1\\}^{n \\times n}$，定义朴素对齐一致性分数，该分数计算边一致性与非边一致性（即匹配的1和匹配的0）的总和，其定义如下：\n$$\nS_{\\mathrm{naive}}(P) \\;=\\; \\sum_{1 \\le i  j \\le n} \\Big( \\mathbf{1}\\{A_{ij}=1,\\, B_{P(i)P(j)}=1\\} \\;+\\; \\mathbf{1}\\{A_{ij}=0,\\, B_{P(i)P(j)}=0\\} \\Big).\n$$\n由于在稀疏情况下 $(1-p_{1})(1-p_{2}) \\gg p_{1}p_{2}$，最大化 $S_{\\mathrm{naive}}(P)$ 可能会偏向于对齐非边，从而掩盖了由边所承载的结构信号。\n\n为减轻这种偏差，考虑以下重加权一致性目标\n$$\nS_{w}(P) \\;=\\; \\sum_{1 \\le i  j \\le n} \\Big( w_{1}\\,\\mathbf{1}\\{A_{ij}=1,\\, B_{P(i)P(j)}=1\\} \\;+\\; w_{0}\\,\\mathbf{1}\\{A_{ij}=0,\\, B_{P(i)P(j)}=0\\} \\Big),\n$$\n其中权重 $w_{1} > 0$ 且 $w_{0} > 0$。在零模型下，假设 $P$ 独立于 $(A,B)$，且 $G_{1},G_{2}$ 是如上所述参数为 $p_{1}$ 和 $p_{2}$ 的独立ER图。推导权重的精确比率，使得边一致性和非边一致性对 $S_{w}(P)$ 的期望总贡献相等，从而在期望层面上消除类别不平衡偏差。\n\n请用一个关于 $p_1$ 和 $p_2$ 的单一闭式表达式给出 $w_{0}^{\\star}/w_{1}^{\\star}$ 的最终答案。无需四舍五入。答案以无单位形式表示。",
            "solution": "该问题已被验证，并被确定为是合理的、适定的且有科学依据的。分析如下。\n\n目标是找到权重比率 $w_{0}/w_{1}$，使得边一致性和非边一致性对重加权分数 $S_{w}(P)$ 的期望贡献相等。设边一致性的总贡献表示为 $C_{1}(P)$，非边一致性的总贡献表示为 $C_{0}(P)$。它们的定义如下：\n$$\nC_{1}(P) = \\sum_{1 \\le i  j \\le n} w_{1}\\,\\mathbf{1}\\{A_{ij}=1,\\, B_{P(i)P(j)}=1\\}\n$$\n$$\nC_{0}(P) = \\sum_{1 \\le i  j \\le n} w_{0}\\,\\mathbf{1}\\{A_{ij}=0,\\, B_{P(i)P(j)}=0\\}\n$$\n问题要求我们找到特定的权重，我们将其表示为 $w_{1}^{\\star}$ 和 $w_{0}^{\\star}$，使得这两个量在零模型下的期望相等。因此，条件是：\n$$\n\\mathbb{E}[C_{1}(P)] = \\mathbb{E}[C_{0}(P)]\n$$\n我们现在将分别计算每一项的期望。\n\n首先，我们计算边一致性的期望总贡献 $\\mathbb{E}[C_{1}(P)]$。根据期望的线性性，我们可以将期望算子移到求和符号内部：\n$$\n\\mathbb{E}[C_{1}(P)] = \\mathbb{E}\\left[ \\sum_{1 \\le i  j \\le n} w_{1}\\,\\mathbf{1}\\{A_{ij}=1,\\, B_{P(i)P(j)}=1\\} \\right] = w_{1} \\sum_{1 \\le i  j \\le n} \\mathbb{E}\\left[ \\mathbf{1}\\{A_{ij}=1,\\, B_{P(i)P(j)}=1\\} \\right]\n$$\n指示函数的期望是其所指示事件的概率。因此，我们有：\n$$\n\\mathbb{E}\\left[ \\mathbf{1}\\{A_{ij}=1,\\, B_{P(i)P(j)}=1\\} \\right] = \\mathbb{P}\\left(A_{ij}=1 \\text{ and } B_{P(i)P(j)}=1\\right)\n$$\n在指定的零模型下，图 $G_{1}$（邻接矩阵为 $A$）和图 $G_{2}$（邻接矩阵为 $B$）是 Erdős–Rényi 图的独立实现，并且置换 $P$ 独立于 $A$ 和 $B$。这种独立性允许我们对联合概率进行因式分解：\n$$\n\\mathbb{P}\\left(A_{ij}=1 \\text{ and } B_{P(i)P(j)}=1\\right) = \\mathbb{P}(A_{ij}=1) \\times \\mathbb{P}(B_{P(i)P(j)}=1)\n$$\n对于一个边概率为 $p_{1}$ 的 Erdős–Rényi 图，任意两个不同顶点 $i$ 和 $j$ 之间存在边的概率是 $\\mathbb{P}(A_{ij}=1) = p_{1}$。\n类似地，对于一个边概率为 $p_{2}$ 的 Erdős–Rényi 图，任意两个不同顶点 $u$ 和 $v$ 之间存在边的概率是 $\\mathbb{P}(B_{uv}=1) = p_{2}$。由于 $P$ 是一个置换矩阵且 $i \\neq j$，映射后的顶点 $P(i)$ 和 $P(j)$ 也是不同的。因此，$\\mathbb{P}(B_{P(i)P(j)}=1) = p_{2}$。\n将这些概率代回，我们得到：\n$$\n\\mathbb{P}\\left(A_{ij}=1 \\text{ and } B_{P(i)P(j)}=1\\right) = p_{1} p_{2}\n$$\n求和遍历所有满足 $1 \\le i  j \\le n$ 的不同顶点对 $(i, j)$。这样的顶点对总数为 $\\binom{n}{2}$。因此，边一致性的期望总贡献为：\n$$\n\\mathbb{E}[C_{1}(P)] = w_{1} \\sum_{1 \\le i  j \\le n} p_{1}p_{2} = w_{1} \\binom{n}{2} p_{1}p_{2}\n$$\n\n接下来，我们以类似的方式计算非边一致性的期望总贡献 $\\mathbb{E}[C_{0}(P)]$。\n$$\n\\mathbb{E}[C_{0}(P)] = \\mathbb{E}\\left[ \\sum_{1 \\le i  j \\le n} w_{0}\\,\\mathbf{1}\\{A_{ij}=0,\\, B_{P(i)P(j)}=0\\} \\right] = w_{0} \\sum_{1 \\le i  j \\le n} \\mathbb{E}\\left[ \\mathbf{1}\\{A_{ij}=0,\\, B_{P(i)P(j)}=0\\} \\right]\n$$\n这需要计算概率 $\\mathbb{P}\\left(A_{ij}=0 \\text{ and } B_{P(i)P(j)}=0\\right)$。同样，由于独立性：\n$$\n\\mathbb{P}\\left(A_{ij}=0 \\text{ and } B_{P(i)P(j)}=0\\right) = \\mathbb{P}(A_{ij}=0) \\times \\mathbb{P}(B_{P(i)P(j)}=0)\n$$\n在 ER 图中，一条非边的概率是 $\\mathbb{P}(A_{ij}=0) = 1 - \\mathbb{P}(A_{ij}=1) = 1 - p_{1}$。\n类似地，$\\mathbb{P}(B_{P(i)P(j)}=0) = 1 - \\mathbb{P}(B_{P(i)P(j)}=1) = 1 - p_{2}$。\n所以，非边一致性的概率为：\n$$\n\\mathbb{P}\\left(A_{ij}=0 \\text{ and } B_{P(i)P(j)}=0\\right) = (1 - p_{1})(1 - p_{2})\n$$\n非边一致性的期望总贡献是所有 $\\binom{n}{2}$ 对的总和：\n$$\n\\mathbb{E}[C_{0}(P)] = w_{0} \\sum_{1 \\le i  j \\le n} (1 - p_{1})(1 - p_{2}) = w_{0} \\binom{n}{2} (1 - p_{1})(1 - p_{2})\n$$\n\n最后，我们使用权重 $w_{1}^{\\star}$ 和 $w_{0}^{\\star}$ 来施加期望贡献相等的条件：\n$$\nw_{1}^{\\star} \\binom{n}{2} p_{1}p_{2} = w_{0}^{\\star} \\binom{n}{2} (1 - p_{1})(1 - p_{2})\n$$\n假设顶点数 $n \\ge 2$，则项 $\\binom{n}{2} = \\frac{n(n-1)}{2}$ 为非零，可以从等式两边消去：\n$$\nw_{1}^{\\star} p_{1}p_{2} = w_{0}^{\\star} (1 - p_{1})(1 - p_{2})\n$$\n问题要求的是比率 $w_{0}^{\\star}/w_{1}^{\\star}$。我们可以通过重新整理各项来解出这个比率。由于 $p_{1}, p_{2} \\in (0,1)$，量 $p_{1}p_{2}$ 和 $(1-p_{1})(1-p_{2})$ 均为非零，且已知 $w_{1}^{\\star}$ 为正，因此除法是良定的。\n$$\n\\frac{w_{0}^{\\star}}{w_{1}^{\\star}} = \\frac{p_{1}p_{2}}{(1 - p_{1})(1 - p_{2})}\n$$\n这个表达式给出了在零模型下平衡边一致性和非边一致性的期望贡献的精确权重比率，从而消除了指定的偏差。",
            "answer": "$$\n\\boxed{\\frac{p_{1}p_{2}}{(1 - p_{1})(1 - p_{2})}}\n$$"
        }
    ]
}