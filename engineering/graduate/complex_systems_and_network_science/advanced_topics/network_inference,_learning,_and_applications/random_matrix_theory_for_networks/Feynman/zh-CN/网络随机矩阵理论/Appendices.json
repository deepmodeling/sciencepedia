{
    "hands_on_practices": [
        {
            "introduction": "这项练习提供了一个基础性的计算，旨在通过直接计算来验证随机网络谱的核心性质。我们将推导一个经过适当归一化的稠密 Erdős–Rényi 随机图邻接矩阵的前几个矩，并证明它们收敛于高斯正交系 (GOE) 的矩。这个过程不仅能加深对 Wigner 半圆律的理解，也为后续分析更复杂的结构化网络谱提供了基准 。",
            "id": "4299563",
            "problem": "考虑一个有 $n$ 个顶点的无向Erdős–Rényi随机图 $G(n,p)$，其中 $\\binom{n}{2}$ 条可能的边中的每一条都以概率 $p \\in (0,1)$ 独立存在，否则不存在。设 $A \\in \\mathbb{R}^{n \\times n}$ 是其邻接矩阵，其中对于 $i \\neq j$，有 $A_{ij} = A_{ji} \\in \\{0,1\\}$，且 $A_{ii} = 0$。通过下式定义中心化和归一化的邻接矩阵（一种Wigner型缩放）：\n$$\nW \\;=\\; \\frac{A - p\\,(J - I)}{\\sqrt{n\\,p\\,(1-p)}}\\,,\n$$\n其中 $I$ 是单位矩阵，$J$ 是全一矩阵。对于 $k \\in \\{1,2,3,4\\}$，通过迹幂法定义经验谱分布的 $k$ 阶矩：\n$$\nm_{k}(n) \\;=\\; \\frac{1}{n}\\,\\mathbb{E}\\!\\left[ \\operatorname{Tr}\\!\\left(W^{k}\\right) \\right]\\,.\n$$\n从基本原理和核心定义（边的独立性、中心化后均值为零以及方差归一化）出发，推导 $m_{1}(n)$、$m_{2}(n)$、$m_{3}(n)$ 和 $m_{4}(n)$ 的显式公式，然后在 $p$ 是 $(0,1)$ 中的固定常数的稠密区域中，确定极限 $\\lim_{n \\to \\infty} m_{k}(n)$。最后，验证这些极限与高斯正交系综（Gaussian Orthogonal Ensemble, GOE）的极限矩一致（高斯正交系综(GOE)是由实对称矩阵构成的系综，其对角线及以上的元素是独立同分布的高斯随机变量，并经过缩放以使非对角线元素的方差为 $1/n$ 的量级），并提供前四阶矩的极限值作为最终答案。\n\n将您的最终答案表示为一个单行向量，其中包含按 $k$ 递增顺序排列的四个极限矩值，使用精确值。无需四舍五入。",
            "solution": "我们首先回顾一下设定。$G(n,p)$ 的邻接矩阵 $A$ 具有独立的非对角线元 $A_{ij} = A_{ji} \\in \\{0,1\\}$（对于 $i \\neq j$），其中 $\\mathbb{P}(A_{ij}=1) = p$ 和 $\\mathbb{P}(A_{ij}=0) = 1-p$，以及对角线元 $A_{ii} = 0$。定义中心化矩阵 $B = A - p\\,(J - I)$，使得对于 $i \\neq j$，$B_{ij} = A_{ij} - p$ 的均值为 $0$，方差为 $\\operatorname{Var}(B_{ij}) = p(1-p)$，而 $B_{ii} = 0$。归一化矩阵为\n$$\nW \\;=\\; \\frac{B}{\\sqrt{n\\,p\\,(1-p)}}\\,,\n$$\n因此对于 $i \\neq j$，$W_{ij}$ 的均值为 $0$，方差为\n$$\n\\operatorname{Var}(W_{ij}) \\;=\\; \\frac{\\operatorname{Var}(B_{ij})}{n\\,p\\,(1-p)} \\;=\\; \\frac{1}{n}\\,,\n$$\n且 $W_{ii} = 0$。非对角线元 $\\{W_{ij} : 1 \\le i  j \\le n\\}$ 是独立的，并且 $W_{ij} = W_{ji}$。\n\n定义矩为\n$$\nm_{k}(n) \\;=\\; \\frac{1}{n}\\,\\mathbb{E}\\!\\left[ \\operatorname{Tr}\\!\\left(W^{k}\\right) \\right] \\;=\\; \\frac{1}{n}\\,\\sum_{i_{1},\\ldots,i_{k} = 1}^{n} \\mathbb{E}\\!\\left[ W_{i_{1} i_{2}}\\,W_{i_{2} i_{3}} \\cdots W_{i_{k} i_{1}} \\right]\\,.\n$$\n此展开式计算了顶点集 $\\{1,\\ldots,n\\}$ 上长度为 $k$ 的闭迹的数量，其贡献来自于沿迹的矩阵元素乘积。因为对于 $i \\neq j$ 有 $\\mathbb{E}[W_{ij}] = 0$，所以任何项的期望不为零的充要条件是，乘积中出现的每条无向边（无序对）都至少被使用两次（以便变量可以配对）。我们现在处理 $k=1,2,3,4$ 的情况。\n\n一阶矩 ($k=1$)。我们有\n$$\nm_{1}(n) \\;=\\; \\frac{1}{n}\\,\\mathbb{E}\\!\\left[ \\operatorname{Tr}(W) \\right] \\;=\\; \\frac{1}{n}\\,\\sum_{i=1}^{n} \\mathbb{E}\\!\\left[ W_{ii} \\right] \\;=\\; 0\\,,\n$$\n因为 $W_{ii} = 0$。\n\n二阶矩 ($k=2$)。我们写出\n$$\nm_{2}(n) \\;=\\; \\frac{1}{n}\\,\\mathbb{E}\\!\\left[ \\operatorname{Tr}(W^{2}) \\right] \\;=\\; \\frac{1}{n}\\,\\sum_{i,j=1}^{n} \\mathbb{E}\\!\\left[ W_{ij}\\,W_{ji} \\right] \\;=\\; \\frac{1}{n}\\,\\sum_{i \\neq j} \\mathbb{E}\\!\\left[ W_{ij}^{2} \\right]\\,,\n$$\n因为 $W_{ii}=0$ 且 $W_{ij} = W_{ji}$。对于 $i \\neq j$，$\\mathbb{E}[W_{ij}^{2}] = \\operatorname{Var}(W_{ij}) = 1/n$。因此，\n$$\nm_{2}(n) \\;=\\; \\frac{1}{n}\\,\\big(n(n-1)\\big)\\,\\frac{1}{n} \\;=\\; \\frac{n-1}{n} \\;\\xrightarrow[n\\to\\infty]{}\\; 1\\,.\n$$\n\n三阶矩 ($k=3$)。我们有\n$$\nm_{3}(n) \\;=\\; \\frac{1}{n}\\,\\sum_{i,j,k=1}^{n} \\mathbb{E}\\!\\left[ W_{ij}\\,W_{jk}\\,W_{ki} \\right]\\,.\n$$\n三个中心化的独立（就不同无向对而言）矩阵元的乘积，其期望为零，除非指标退化，使得至少一个变量是对角线元，或者某条边出现三次。在这里，任何强制配对的退化情况，要么会引入一个对角线因子（例如，$i=j$ 使得 $W_{ii}=0$），要么会产生单个非对角线元的奇数次幂，其均值为零。因此，每一项的期望都为零，并且\n$$\nm_{3}(n) \\;=\\; 0\\,.\n$$\n\n四阶矩 ($k=4$)。我们展开\n$$\nm_{4}(n) \\;=\\; \\frac{1}{n}\\,\\sum_{i,j,k,\\ell = 1}^{n} \\mathbb{E}\\!\\left[ W_{ij}\\,W_{jk}\\,W_{k\\ell}\\,W_{\\ell i} \\right]\\,.\n$$\n令 $\\{e_{1},e_{2},e_{3},e_{4}\\}$ 表示与4-环中的边相对应的无序对：$e_{1} = \\{i,j\\}$, $e_{2} = \\{j,k\\}$, $e_{3} = \\{k,\\ell\\}$, $e_{4} = \\{ \\ell,i \\}$。如果每条边至少出现两次，则该项有贡献。主要贡献来自于使用两条不同的非对角线边、每条边使用两次的配对；这些是非交叉配对。我们列举出有贡献的模式并计算它们的贡献。我们还对所有其余的贡献进行界定，以表明它们在极限情况下趋于零。\n\n非交叉配对：\n- 模式 $\\mathsf{P1}$：$e_{1} = e_{2}$ 且 $e_{3} = e_{4}$。条件 $e_{1} = e_{2}$ 强制 $i=k$，然后对于任何 $\\ell \\neq i$，$e_{3} = e_{4}$ 自动成立；非对角线约束要求 $i \\neq j$ 和 $i \\neq \\ell$。为确保两条边是不同的，我们还要求 $j \\neq \\ell$。计算选择方式：$i$ 有 $n$ 种选择，$j \\neq i$ 有 $(n-1)$ 种选择，$\\ell \\neq i,j$ 有 $(n-2)$ 种选择，因此有 $n\\,(n-1)\\,(n-2)$ 个指标元组会产生两条不同的边。对于每个这样的元组，根据不同无向对之间的独立性可得\n$$\n\\mathbb{E}\\!\\left[ W_{ij}\\,W_{jk}\\,W_{k\\ell}\\,W_{\\ell i} \\right] \\;=\\; \\mathbb{E}[W_{ij}^{2}]\\,\\mathbb{E}[W_{i\\ell}^{2}] \\;=\\; \\frac{1}{n}\\,\\cdot\\,\\frac{1}{n} \\;=\\; \\frac{1}{n^{2}}\\,.\n$$\n因此，来自 $\\mathsf{P1}$ 的不同边元组的总贡献为\n$$\n\\frac{1}{n}\\,\\big(n\\,(n-1)\\,(n-2)\\big)\\,\\frac{1}{n^{2}} \\;=\\; \\frac{(n-1)\\,(n-2)}{n^{2}}\\,.\n$$\n如果 $j=\\ell$，则所有四个因子都使用同一条边 $\\{i,j\\}$，贡献与 $\\mathbb{E}[W_{ij}^{4}]$ 成正比；存在 $n\\,(n-1)$ 个这样的元组，每个元组的贡献为 $\\mathbb{E}[W_{ij}^{4}]$。我们计算\n$$\n\\mathbb{E}[W_{ij}^{4}] \\;=\\; \\frac{\\mathbb{E}[B_{ij}^{4}]}{n^{2}\\,p^{2}\\,(1-p)^{2}} \\;=\\; \\frac{p\\,(1-p)^{4} + (1-p)\\,p^{4}}{n^{2}\\,p^{2}\\,(1-p)^{2}} \\;=\\; \\frac{(1-p)^{3} + p^{3}}{n^{2}\\,p\\,(1-p)}\\,,\n$$\n因为 $B_{ij} = A_{ij} - p$ 以概率 $p$ 取值 $1-p$，以概率 $1-p$ 取值 $-p$。因此，这些 $\\mathsf{P1}$ 退化元组对 $m_{4}(n)$ 的总贡献是\n$$\n\\frac{1}{n}\\,\\big(n\\,(n-1)\\big)\\,\\frac{(1-p)^{3} + p^{3}}{n^{2}\\,p\\,(1-p)} \\;=\\; \\frac{n-1}{n^{2}}\\,\\frac{(1-p)^{3} + p^{3}}{p\\,(1-p)} \\;\\xrightarrow[n\\to\\infty]{}\\; 0\\,.\n$$\n\n- 模式 $\\mathsf{P2}$：$e_{1} = e_{4}$ 且 $e_{2} = e_{3}$。条件 $e_{1} = e_{4}$ 强制 $j = \\ell$，然后对于任何 $k \\neq j$，$e_{2} = e_{3}$ 成立；非对角线约束要求 $j \\neq i$ 和 $k \\neq j$。为确保两条边是不同的，我们要求 $k \\neq i$。计算选择方式：$i$ 有 $n$ 种选择，$j \\neq i$ 有 $(n-1)$ 种选择，$k \\neq i,j$ 有 $(n-2)$ 种选择，因此有 $n\\,(n-1)\\,(n-2)$ 个不同边元组。每个元组的贡献为 $\\mathbb{E}[W_{ij}^{2}]\\,\\mathbb{E}[W_{jk}^{2}] = (1/n)^{2}$。因此，来自 $\\mathsf{P2}$ 的不同边元组的总贡献也为\n$$\n\\frac{(n-1)\\,(n-2)}{n^{2}}\\,.\n$$\n$k = i$ 的退化元组会产生一条使用四次的边，贡献与上面完全相同的 $\\mathbb{E}[W_{ij}^{4}]$，它们对 $m_{4}(n)$ 的总贡献在 $n \\to \\infty$ 时消失。\n\n交叉配对：\n- 模式 $\\mathsf{P3}$：$e_{1} = e_{3}$ 且 $e_{2} = e_{4}$。满足非对角线约束的唯一方法是 $k = i$ 和 $\\ell = j$，这会产生单边四次乘积 $W_{ij}^{4}$。存在 $n\\,(n-1)$ 个这样的元组，每个元组的贡献为 $\\mathbb{E}[W_{ij}^{4}]$。如上所述，它们对 $m_{4}(n)$ 的总贡献为 $\\frac{n-1}{n^{2}}\\,\\frac{(1-p)^{3} + p^{3}}{p\\,(1-p)} \\to 0$。\n\n所有其余的指标构型要么引入至少一个对角线因子 $W_{ii} = 0$，要么在某个非对角线元上产生奇数阶矩，因此期望为零。\n\n汇总来自 $\\mathsf{P1}$ 和 $\\mathsf{P2}$ 的主要贡献，并注意到所有退化和交叉贡献在 $n$ 很大时趋于零，我们得到\n$$\nm_{4}(n) \\;=\\; \\frac{(n-1)\\,(n-2)}{n^{2}} \\;+\\; \\frac{(n-1)\\,(n-2)}{n^{2}} \\;+\\; o(1) \\;=\\; \\frac{2\\,(n-1)\\,(n-2)}{n^{2}} \\;+\\; o(1)\\,,\n$$\n因此\n$$\n\\lim_{n \\to \\infty} m_{4}(n) \\;=\\; 2\\,.\n$$\n\n极限总结。在固定 $p \\in (0,1)$ 的稠密区域中，\n$$\n\\lim_{n \\to \\infty} m_{1}(n) \\;=\\; 0\\,, \\qquad \\lim_{n \\to \\infty} m_{2}(n) \\;=\\; 1\\,, \\qquad \\lim_{n \\to \\infty} m_{3}(n) \\;=\\; 0\\,, \\qquad \\lim_{n \\to \\infty} m_{4}(n) \\;=\\; 2\\,.\n$$\n这些恰好是适当缩放的高斯正交系综（GOE）的极限经验谱分布的前四阶矩，即单位方差的半圆律，其偶数阶矩是卡塔兰数（$m_{2} = 1$, $m_{4} = 2$），奇数阶矩为零。\n\n因此，稠密图 $G(n,p)$ 的中心化和归一化邻接矩阵的前四阶矩收敛于GOE矩：\n$$\n\\big(\\lim_{n\\to\\infty} m_{1}(n),\\,\\lim_{n\\to\\infty} m_{2}(n),\\,\\lim_{n\\to\\infty} m_{3}(n),\\,\\lim_{n\\to\\infty} m_{4}(n)\\big) \\;=\\; (0,\\,1,\\,0,\\,2)\\,.\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}0  1  0  2\\end{pmatrix}}$$"
        },
        {
            "introduction": "在建立了随机谱的基准之上，这项练习将探讨如何检测非随机结构。我们将向一个随机矩阵添加一个简单的秩一扰动，并使用预解式方法来确定一个离群特征值从谱主体中分离出来所需的临界信号强度。这项练习介绍了著名的 Baik–Ben Arous–Péché (BBP) 相变，这是现代随机矩阵理论中用于信号检测的基石之一 。",
            "id": "4299560",
            "problem": "考虑一个由 $n$ 个节点组成的无向网络序列，该序列被建模为边独立的稀疏 Erdős–Rényi 图。设 $A^{(n)}$ 为邻接矩阵，其非对角元 $A^{(n)}_{ij} \\in \\{0,1\\}$ ($i \\neq j$)，其中 $\\mathbb{P}(A^{(n)}_{ij} = 1) = p_{n}$ 且 $p_{n} = c/n$，对于一个固定的 $c  0$。定义中心化和标准化的类邻接矩阵 $X^{(n)}$ 如下：\n$$\nX^{(n)}_{ij} = \\begin{cases}\n\\dfrac{A^{(n)}_{ij} - p_{n}}{\\sqrt{n p_{n} (1 - p_{n})}}  \\text{若 } i \\neq j, \\\\\n0  \\text{若 } i = j,\n\\end{cases}\n$$\n并考虑在该谱体上添加一个秩一异质性（信号），\n$$\nS^{(n)} = X^{(n)} + \\theta\\, v v^{\\top},\n$$\n其中 $v \\in \\mathbb{R}^{n}$ 是一个与 $X^{(n)}$ 无关的确定性单位向量（$\\|v\\|_{2} = 1$），$\\theta \\in \\mathbb{R}$ 是一个信号强度参数。在大 $n$ 极限下，$X^{(n)}$ 是一个 Wigner 型矩阵，其非对角元的方差等于 $1/n$，其经验谱分布收敛到支撑在 $[-2,2]$ 上的半圆律。\n\n使用网络随机矩阵理论的基本原理，推导与 $S^{(n)}$ 的 Baik–Ben Arous–Péché (BBP) 相变相关的离群特征值条件，并用 $X^{(n)}$ 的极限谱分布的谱体 Stieltjes 变换 $m(z)$ 来表示。然后，对于如上定义的类邻接矩阵标度（即，中心化和标准化的矩阵产生方差为 1 的半圆律），求解得到的自洽方程，以确定谱体支撑集右侧的一个假定离群值，并找出当一个离群值首次从谱体右边缘出现时的 $\\theta$ 的临界值。\n\n你的推导必须从 Stieltjes 变换的定义、矩阵的预解式以及用于秩一更新的 Sherman–Morrison 公式开始，然后进行到极限各向同性近似 $\\langle v, (\\cdot) v \\rangle \\to m(z)$。明确使用半圆律在实数参数 $z  2$ 上的 Stieltjes 变换 $m(z)$。将临界信号强度报告为一个精确的数字。不需要四舍五入。最终答案必须是单个实数。",
            "solution": "问题要求解在一个特定随机矩阵模型中，出现离群特征值所需的临界信号强度 $\\theta$。推导过程主要分为三个阶段：首先，建立秩一扰动矩阵模型中离群特征值的一般方程；其次，将该方程应用于给定的矩阵系综，其极限谱分布为半圆律；第三，求解临界参数值。\n\n设 $S^{(n)} = X^{(n)} + \\theta v v^{\\top}$ 为所讨论的矩阵，其中 $X^{(n)}$ 是随机“谱体”矩阵，而 $\\theta v v^{\\top}$ 是秩一“信号”或扰动。我们关心的是在大 $n$ 极限下 $S^{(n)}$ 的特征值。离群特征值是指那些位于谱体矩阵 $X^{(n)}$ 极限谱分布支撑集之外的特征值。\n\n特征值的位置可以从经验谱分布的 Stieltjes 变换的极点确定。对于一个大小为 $n \\times n$ 的矩阵 $M$，其 Stieltjes 变换定义为\n$$\nm_{M}(z) = \\frac{1}{n} \\text{Tr}\\left((M - zI_n)^{-1}\\right)\n$$\n其中 $z \\in \\mathbb{C} \\setminus \\text{spectrum}(M)$，$I_n$ 是 $n \\times n$ 的单位矩阵。矩阵 $(M-zI_n)^{-1}$ 被称为 $M$ 在 $z$ 处的预解式。\n\n设 $R_X(z) = (X^{(n)} - zI_n)^{-1}$ 为谱体矩阵 $X^{(n)}$ 的预解式。扰动矩阵 $S^{(n)}$ 的预解式可以使用用于秩一更新求逆的 Sherman–Morrison 公式找到。对于可逆矩阵 $A$ 和向量 $u, w$，该公式表述为 $(A+uw^{\\top})^{-1} = A^{-1} - \\frac{A^{-1}uw^{\\top}A^{-1}}{1+w^{\\top}A^{-1}u}$。\n将此公式应用于 $(S^{(n)} - zI_n)^{-1}$，其中 $A = X^{(n)} - zI_n$，$u = \\theta v$，$w = v$：\n$$\n(S^{(n)} - zI_n)^{-1} = (X^{(n)} - zI_n + \\theta v v^{\\top})^{-1} = R_X(z) - \\frac{R_X(z) (\\theta v) v^{\\top} R_X(z)}{1 + v^{\\top} R_X(z) (\\theta v)} = R_X(z) - \\frac{\\theta R_X(z) v v^{\\top} R_X(z)}{1 + \\theta v^{\\top} R_X(z) v}\n$$\n$S^{(n)}$ 的 Stieltjes 变换，记作 $m_S(z)$，通过取归一化迹得到：\n$$\nm_S(z) = \\frac{1}{n} \\text{Tr}\\left( (S^{(n)} - zI_n)^{-1} \\right) = \\frac{1}{n}\\text{Tr}(R_X(z)) - \\frac{1}{n} \\text{Tr}\\left( \\frac{\\theta R_X(z) v v^{\\top} R_X(z)}{1 + \\theta v^{\\top} R_X(z) v} \\right)\n$$\n第一项是 $X^{(n)}$ 的 Stieltjes 变换 $m_X(z)$。对于第二项，分母是一个标量，可以从迹中提出。利用迹的循环性质 $\\text{Tr}(AB) = \\text{Tr}(BA)$，我们可以简化分子中的迹：$\\text{Tr}(R_X(z) v v^{\\top} R_X(z)) = \\text{Tr}(v^{\\top} R_X(z)^2 v) = v^{\\top} R_X(z)^2 v$，因为标量的迹就是其自身。所以，\n$$\nm_S(z) = m_X(z) - \\frac{\\theta}{n} \\frac{v^{\\top} R_X(z)^2 v}{1 + \\theta v^{\\top} R_X(z) v}\n$$\n$S^{(n)}$ 的一个离群特征值 $\\lambda$ 是 $m_S(z)$ 的一个孤立实值极点。这样的极点只能由第二项的分母为零产生。因此，假定离群值的位置 $\\lambda$ 必须满足以下方程：\n$$\n1 + \\theta \\, v^{\\top} R_X(\\lambda) v = 0 \\quad \\implies \\quad v^{\\top} (X^{(n)} - \\lambda I_n)^{-1} v = -\\frac{1}{\\theta}\n$$\n这是离群特征值的基本方程。在大 $n$ 极限下，二次型 $v^{\\top} R_X(z) v$ 会集中在其期望值附近。对于一个确定性的、离域的单位向量 $v$，这个量收敛于谱体矩阵的极限 Stieltjes 变换。问题描述中将其作为“各向同性近似”$\\langle v, (\\cdot) v \\rangle \\to m(z)$ 给出，这意味着 $v^{\\top} R_X(z) v \\to m(z)$，其中 $m(z) = \\lim_{n \\to \\infty} m_X(z)$。\n因此，离群特征值 $\\lambda$ 的极限方程为：\n$$\n1 + \\theta m(\\lambda) = 0 \\quad \\text{或} \\quad m(\\lambda) = -\\frac{1}{\\theta}\n$$\n这是这类模型的一般离群特征值条件，用谱体 Stieltjes 变换表示。\n\n接下来，我们将此应用于具体问题。矩阵 $X^{(n)}$ 的定义使其经验谱分布收敛到 Wigner 半圆律。非对角元的方差指定为 $1/n$。对于元方差为 $\\sigma^2/n$ 的 Wigner 矩阵，其极限谱支撑在 $[-2\\sigma, 2\\sigma]$ 上。这里 $\\sigma^2=1$，所以支撑集为 $[-2, 2]$，正如问题中所述。支撑在 $[-2, 2]$ 上的 Wigner 半圆律的 Stieltjes 变换由下式给出：\n$$\nm(z) = \\frac{-z + \\sqrt{z^2 - 4}}{2}\n$$\n对于 $z \\in \\mathbb{C} \\setminus [-2, 2]$。我们正在寻找从谱体右边缘出现的离群值，所以我们考虑实数 $z  2$。\n将此代入离群值方程 $m(\\lambda) = -1/\\theta$：\n$$\n\\frac{-\\lambda + \\sqrt{\\lambda^2 - 4}}{2} = -\\frac{1}{\\theta}\n$$\n我们求解离群值位置 $\\lambda  2$ 关于信号强度 $\\theta$ 的表达式。我们假设 $\\theta0$，这是离群值出现在谱右侧的必要条件（因为对于 $\\lambda2$，$m(\\lambda)0$）。\n$$\n-\\lambda + \\sqrt{\\lambda^2 - 4} = -\\frac{2}{\\theta}\n$$\n$$\n\\sqrt{\\lambda^2 - 4} = \\lambda - \\frac{2}{\\theta}\n$$\n为了使实数解存在，右侧必须为非负，即 $\\lambda \\ge 2/\\theta$。两边平方：\n$$\n\\lambda^2 - 4 = \\left(\\lambda - \\frac{2}{\\theta}\\right)^2 = \\lambda^2 - \\frac{4\\lambda}{\\theta} + \\frac{4}{\\theta^2}\n$$\n$$\n-4 = -\\frac{4\\lambda}{\\theta} + \\frac{4}{\\theta^2}\n$$\n乘以 $-\\theta/4$：\n$$\n\\theta = \\lambda - \\frac{1}{\\theta}\n$$\n求解 $\\lambda$，我们得到离群特征值的位置：\n$$\n\\lambda = \\theta + \\frac{1}{\\theta}\n$$\nBBP 相变发生在 $\\theta$ 的临界值处，此时离群特征值首次从谱体的连续谱中出现。为了使离群值存在于右侧，其位置 $\\lambda$ 必须严格大于谱体谱的右边缘，即 $2$。所以，我们需要找到使 $\\lambda  2$ 成立的 $\\theta$ 的条件。\n$$\n\\theta + \\frac{1}{\\theta}  2\n$$\n对于 $\\theta  0$，我们可以乘以 $\\theta$ 而不改变不等号方向：\n$$\n\\theta^2 + 1  2\\theta \\quad \\implies \\quad \\theta^2 - 2\\theta + 1  0 \\quad \\implies \\quad (\\theta - 1)^2  0\n$$\n这个不等式对所有正数 $\\theta$ 都成立，除了 $\\theta=1$。因此，当且仅当 $\\theta  1$ 时，谱体右侧存在离群值。临界值 $\\theta_c$ 是该相变发生的阈值。这对应于等式成立的情况，即 $(\\theta_c - 1)^2 = 0$，得出 $\\theta_c = 1$。在此临界值处，离群值位于 $\\lambda = 1 + 1/1 = 2$，恰好在谱体谱的边缘。对于任何 $\\theta  1$，离群值 $\\lambda = \\theta+1/\\theta$ 严格大于 $2$。\n\n当一个离群值首次从谱体右边缘出现时，信号强度 $\\theta$ 的临界值为 $1$。",
            "answer": "$$\n\\boxed{1}\n$$"
        },
        {
            "introduction": "这项练习将离群值检测的抽象原理应用于一个具体的网络特征：枢纽节点。通过将网络建模为一个随机背景加上一个代表枢纽的星形结构，我们可以计算出该枢纽所产生的离群特征值的确切位置。这清晰地展示了如何运用随机矩阵理论，将特定的网络模体与其在谱上的可观测特征联系起来，是理解网络结构与功能关系的关键一步 。",
            "id": "4299575",
            "problem": "考虑一个包含 $n$ 个节点的合成无向网络，由一个对称加权邻接矩阵 $A_{n} \\in \\mathbb{R}^{n \\times n}$ 表示。将 $A_{n}$ 分解为 $A_{n} = W_{n} + S_{n}$，其中 $W_{n}$ 模拟背景连接性波动，$S_{n}$ 模拟一个单一的枢纽。\n\n背景矩阵 $W_{n}$ 是一个实对称随机矩阵，对于 $i \\neq j$，其元素 $(W_{n})_{ij} = (W_{n})_{ji}$ 是独立同分布的，满足 $\\mathbb{E}[(W_{n})_{ij}] = 0$ 和 $\\mathrm{Var}[(W_{n})_{ij}] = \\sigma^{2}/n$。对所有 $i$，有 $(W_{n})_{ii} = 0$。枢纽矩阵 $S_{n}$ 编码了一个以节点1为中心的星形结构，该节点到所有其他节点具有统一的边权重 $s_{n}  0$：对于 $j = 2, \\dots, n$，有 $(S_{n})_{1j} = (S_{n})_{j1} = s_{n}$，否则 $(S_{n})_{ij} = 0$。采用标度 $s_{n} = \\alpha/\\sqrt{n}$，其中 $\\alpha  0$ 为固定值，并假设 $\\alpha  \\sigma$，以确保存在一个枢纽诱导的离群特征值。\n\n从网络随机矩阵理论的基本原理出发——即 $W_{n}$ 谱分布的 Wigner 半圆律和加性有限秩扰动的基于预解式的自洽性——在极限 $n \\to \\infty$ 下，推导以下量的闭式解析表达式：\n1. 由枢纽诱导的 $A_{n}$ 的最大离群特征值。\n2. 该特征值与 $W_{n}$ 连续谱右边缘的间隔。\n\n将您的最终答案表示为关于 $\\alpha$ 和 $\\sigma$ 的单个解析表达式或单行解析表达式矩阵。无需数值取整。不涉及物理单位。",
            "solution": "问题要求在 $n \\to \\infty$ 的极限下，求矩阵 $A_n = W_n + S_n$ 的最大离群特征值及其与连续谱的间隔。我们将使用随机矩阵理论中的预解式技术来解决这个问题。\n\n首先，我们描述背景矩阵 $W_n$ 的谱特性。$W_n$ 是一个实对称随机矩阵，其元素 $(W_n)_{ij}$（对于 $i  j$）是独立同分布的，均值为 $0$，方差为 $\\sigma^2/n$，且对角线元素 $(W_n)_{ii}=0$。这是 Wigner 矩阵的一个特例。对于这种方差标度，当 $n \\to \\infty$ 时，$W_n$ 的经验谱分布收敛于 Wigner 半圆律。其概率密度函数 $\\rho(x)$ 由下式给出：\n$$ \\rho(x) = \\begin{cases} \\frac{1}{2\\pi\\sigma^2}\\sqrt{4\\sigma^2 - x^2}  \\text{if } |x| \\le 2\\sigma \\\\ 0  \\text{if } |x| > 2\\sigma \\end{cases} $$\n因此，$W_n$ 的谱渐近支撑于区间 $[-2\\sigma, 2\\sigma]$。谱的这个连续部分被称为“连续谱”(bulk)。因此，连续谱的右边缘位于 $\\lambda_{\\text{edge}} = 2\\sigma$。\n\n该分布的 Stieltjes 变换 $g(z) = \\int \\frac{\\rho(x)}{x-z} dx$ 是一个关键工具。对于 $z \\in \\mathbb{C} \\setminus [-2\\sigma, 2\\sigma]$，它满足以下二次方程：\n$$ \\sigma^2 g(z)^2 + z g(z) + 1 = 0 $$\n满足当 $|z|$ 很大时 $g(z) \\sim -1/z$ 的适当解是：\n$$ g(z) = \\frac{-z + \\sqrt{z^2 - 4\\sigma^2}}{2\\sigma^2} $$\n对于连续谱外的实值 $\\lambda$ (即 $|\\lambda|  2\\sigma$), 量 $(G_{W_n}(\\lambda))_{ii}$ 收敛于 $g(\\lambda)$，预解式的迹也通过 $\\frac{1}{n}\\mathrm{Tr}(G_{W_n}(\\lambda)) \\to g(\\lambda)$ 与 $g(\\lambda)$ 相关联，其中 $G_{W_n}(\\lambda) = (W_n - \\lambda I)^{-1}$ 是 $W_n$ 的预解式。\n\n接下来，我们分析扰动矩阵 $S_n$。它由 $(S_{n})_{1j} = (S_{n})_{j1} = s_{n} = \\alpha/\\sqrt{n}$ (对于 $j=2, \\dots, n$) 定义，所有其他元素均为零。该矩阵表示一个星形图，并且可以写成一个秩为2的矩阵。令 $e_1 = (1, 0, \\dots, 0)^T$ 为标准基向量，$v = \\sum_{j=2}^n e_j = (0, 1, \\dots, 1)^T$。那么 $S_n$ 可以表示为：\n$$ S_n = s_n (e_1 v^T + v e_1^T) $$\n\n$A_n = W_n + S_n$ 的一个与 $W_n$ 连续谱分离的离群特征值 $\\lambda$ 是预解式 $G_{A_n}(\\lambda) = (W_n + S_n - \\lambda I)^{-1}$ 的一个极点。这些极点由条件 $\\det(A_n - \\lambda I) = 0$ 确定，使用 $W_n$ 的预解式可以重写为：\n$$ \\det(I + G_{W_n}(\\lambda) S_n) = 0 $$\n利用性质 $\\det(I+BC) = \\det(I+CB)$ 以及 $S_n$ 的结构 $S_n = s_n(e_1 v^T + v e_1^T) = [e_1, v] \\begin{pmatrix} 0  s_n \\\\ s_n  0 \\end{pmatrix} [e_1, v]^T$，我们可以简化行列式。\n令 $U = [e_1, v]$ 和 $C = \\begin{pmatrix} 0  s_n \\\\ s_n  0 \\end{pmatrix}$。那么 $S_n=UCU^T$。\n条件变为 $\\det(I_n + G_{W_n}(\\lambda) U C U^T) = 0$。\n这等价于 $\\det(I_2 + U^T G_{W_n}(\\lambda) U C) = 0$。\n让我们计算矩阵 $M(\\lambda) = U^T G_{W_n}(\\lambda) U$：\n$$ M(\\lambda) = \\begin{pmatrix} e_1^T G_{W_n}(\\lambda) e_1  e_1^T G_{W_n}(\\lambda) v \\\\ v^T G_{W_n}(\\lambda) e_1  v^T G_{W_n}(\\lambda) v \\end{pmatrix} $$\n条件变为：\n$$ \\det\\left( \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} + \\begin{pmatrix} e_1^T G_{W_n} e_1  e_1^T G_{W_n} v \\\\ v^T G_{W_n} e_1  v^T G_{W_n} v \\end{pmatrix} \\begin{pmatrix} 0  s_n \\\\ s_n  0 \\end{pmatrix} \\right) = 0 $$\n$$ \\det\\begin{pmatrix} 1+s_n(e_1^T G_{W_n} v)  s_n(e_1^T G_{W_n} e_1) \\\\ s_n(v^T G_{W_n} v)  1+s_n(v^T G_{W_n} e_1) \\end{pmatrix} = 0 $$\n由于 $G_{W_n}$ 是对称的，有 $e_1^T G_{W_n} v = v^T G_{W_n} e_1$。方程简化为：\n$$ (1+s_n e_1^T G_{W_n} v)^2 - s_n^2 (e_1^T G_{W_n} e_1)(v^T G_{W_n} v) = 0 $$\n在 $n \\to \\infty$ 的极限下，对于连续谱之外的 $\\lambda$，预解式的二次型收敛：$u^T G_{W_n}(\\lambda) w \\to (u^T w) g(\\lambda)$。\n我们将此应用于我们的项：\n\\begin{itemize}\n    \\item $e_1^T G_{W_n}(\\lambda) e_1 \\to (e_1^T e_1) g(\\lambda) = 1 \\cdot g(\\lambda) = g(\\lambda)$.\n    \\item $v^T G_{W_n}(\\lambda) v \\to (v^T v) g(\\lambda) = (n-1) g(\\lambda)$.\n    \\item $e_1^T G_{W_n}(\\lambda) v \\to (e_1^T v) g(\\lambda) = 0 \\cdot g(\\lambda) = 0$.\n\\end{itemize}\n将这些极限和 $s_n = \\alpha/\\sqrt{n}$ 代入方程：\n$$ (1 + \\frac{\\alpha}{\\sqrt{n}} \\cdot 0)^2 - \\left(\\frac{\\alpha}{\\sqrt{n}}\\right)^2 (g(\\lambda))((n-1) g(\\lambda)) \\approx 0 $$\n$$ 1 - \\frac{\\alpha^2}{n} g(\\lambda)^2 (n-1) = 0 $$\n取 $n \\to \\infty$ 的极限，我们得到：\n$$ 1 - \\alpha^2 g(\\lambda)^2 = 0 \\implies g(\\lambda)^2 = \\frac{1}{\\alpha^2} $$\n我们正在寻找最大的特征值，因此我们假设 $\\lambda  \\lambda_{\\text{edge}} = 2\\sigma$。对于实数 $\\lambda  2\\sigma$，Stieltjes 变换 $g(\\lambda) = \\int_{-2\\sigma}^{2\\sigma} \\frac{\\rho(x)}{x-\\lambda}dx$ 是负的。因此，我们必须取负根：\n$$ g(\\lambda) = -\\frac{1}{\\alpha} $$\n现在我们代入 $g(\\lambda)$ 的表达式：\n$$ \\frac{-\\lambda + \\sqrt{\\lambda^2 - 4\\sigma^2}}{2\\sigma^2} = -\\frac{1}{\\alpha} $$\n$$ -\\lambda + \\sqrt{\\lambda^2 - 4\\sigma^2} = -\\frac{2\\sigma^2}{\\alpha} $$\n$$ \\sqrt{\\lambda^2 - 4\\sigma^2} = \\lambda - \\frac{2\\sigma^2}{\\alpha} $$\n条件 $\\alpha  \\sigma$ 确保了对于我们将要找到的离群值 $\\lambda$，等式右侧是正的。两边平方：\n$$ \\lambda^2 - 4\\sigma^2 = \\left(\\lambda - \\frac{2\\sigma^2}{\\alpha}\\right)^2 = \\lambda^2 - \\frac{4\\lambda\\sigma^2}{\\alpha} + \\frac{4\\sigma^4}{\\alpha^2} $$\n$$ -4\\sigma^2 = -\\frac{4\\lambda\\sigma^2}{\\alpha} + \\frac{4\\sigma^4}{\\alpha^2} $$\n假设 $\\sigma \\neq 0$，我们可以除以 $-4\\sigma^2$：\n$$ 1 = \\frac{\\lambda}{\\alpha} - \\frac{\\sigma^2}{\\alpha^2} $$\n解出 $\\lambda$ 得到最大的离群特征值 $\\lambda_{\\text{outlier}}$：\n$$ \\lambda_{\\text{outlier}} = \\alpha \\left(1 + \\frac{\\sigma^2}{\\alpha^2}\\right) = \\alpha + \\frac{\\sigma^2}{\\alpha} $$\n这个结果在 $\\alpha  \\sigma$ 时有效，这确保了 $\\lambda_{\\text{outlier}}  2\\sigma$。确实，$\\alpha + \\frac{\\sigma^2}{\\alpha} - 2\\sigma = \\frac{\\alpha^2 - 2\\alpha\\sigma + \\sigma^2}{\\alpha} = \\frac{(\\alpha-\\sigma)^2}{\\alpha}  0$。\n\n第一个要求的量是离群特征值：\n$$ \\lambda_{\\text{outlier}} = \\alpha + \\frac{\\sigma^2}{\\alpha} $$\n\n第二个要求的量是这个特征值与连续谱右边缘的间隔。右边缘位于 $\\lambda_{\\text{edge}} = 2\\sigma$。间隔 $\\Delta$ 为：\n$$ \\Delta = \\lambda_{\\text{outlier}} - \\lambda_{\\text{edge}} = \\left(\\alpha + \\frac{\\sigma^2}{\\alpha}\\right) - 2\\sigma $$\n$$ \\Delta = \\frac{\\alpha^2 + \\sigma^2 - 2\\alpha\\sigma}{\\alpha} = \\frac{(\\alpha-\\sigma)^2}{\\alpha} $$\n\n这两个表达式是问题的完整答案。我们将它们表示为一个行矩阵。",
            "answer": "$$ \\boxed{\\begin{pmatrix} \\alpha + \\frac{\\sigma^2}{\\alpha}  \\frac{(\\alpha - \\sigma)^2}{\\alpha} \\end{pmatrix}} $$"
        }
    ]
}