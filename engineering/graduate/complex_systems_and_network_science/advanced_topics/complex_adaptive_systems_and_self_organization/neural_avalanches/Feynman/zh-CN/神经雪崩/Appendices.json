{
    "hands_on_practices": [
        {
            "introduction": "在深入研究复杂理论之前，掌握如何从原始数据中量化神经雪崩的基本定义至关重要。本练习提供了一个机会，让学生根据一个假设的脉冲栅格图，练习计算神经雪崩的三个核心指标——规模（size）、持续时间（duration）和平均速率（rate），从而为分析真实或模拟数据奠定坚实的基础。",
            "id": "4292846",
            "problem": "在一个 $200\\,\\mathrm{ms}$ 的窗口内观察到一个循环神经网络的尖峰栅格图，并将其离散化为宽度为 $2\\,\\mathrm{ms}$ 的时间窗。在标准的神经雪崩框架中，雪崩被定义为一段最长的连续非零活动时间窗（无静默时间窗）序列，其前后均为静默时间窗（活动为零的时间窗）。雪崩大小是指在雪崩的所有时间窗内累积的活跃神经元事件总数。雪崩持续时间是指雪崩中连续活跃时间窗所跨越的时间。平均雪崩速率是指在雪崩持续时间内，单位时间内的活跃神经元事件总数。\n\n假设在一个由 $8$ 个连续活跃时间窗组成的序列中，每个时间窗内恰好有 $50$ 个活跃神经元，且序列的第一个和最后一个活跃时间窗之间没有静默时间窗，并假设该序列前后紧邻着静默时间窗，因此它构成了一个单一的雪崩。使用这些定义，计算雪崩大小、雪崩持续时间和平均雪崩速率。雪崩大小以无量纲的计数表示，雪崩持续时间以毫秒为单位，平均速率以赫兹 (Hz) 为单位。无需四舍五入；报告精确值。",
            "solution": "该问题要求计算与单个神经雪崩相关的三个量：其大小、持续时间和平均速率。我们已获得根据定义计算这些值所需的参数。\n\n设 $N_{bins}$ 为雪崩中连续活跃时间窗的数量，设 $N_{events\\_per\\_bin}$ 为每个时间窗中的活跃神经元事件数。设 $\\Delta t$ 为单个时间窗的宽度。\n\n根据问题陈述，我们有：\n- 活跃时间窗数量，$N_{bins} = 8$。\n- 每个时间窗的事件数，$N_{events\\_per\\_bin} = 50$。\n- 时间窗宽度，$\\Delta t = 2\\,\\mathrm{ms}$。\n\n首先，我们计算**雪崩大小**，记为 $S$。大小定义为雪崩中所有时间窗内累积的活跃神经元事件总数。由于 $N_{bins}$ 个时间窗中的每一个都有 $N_{events\\_per\\_bin}$ 个事件，所以总大小是它们的乘积。\n$$S = N_{bins} \\times N_{events\\_per\\_bin}$$\n代入给定值：\n$$S = 8 \\times 50 = 400$$\n雪崩大小是事件的无量纲计数。因此，$S = 400$。\n\n其次，我们计算**雪崩持续时间**，记为 $D$。持续时间定义为雪崩连续活跃时间窗所跨越的总时间。这是活跃时间窗数量与每个时间窗宽度的乘积。\n$$D = N_{bins} \\times \\Delta t$$\n代入给定值：\n$$D = 8 \\times 2\\,\\mathrm{ms} = 16\\,\\mathrm{ms}$$\n问题要求持续时间以毫秒为单位，因此 $D = 16\\,\\mathrm{ms}$。\n\n第三，我们计算**平均雪崩速率**，记为 $R$。这被定义为在雪崩持续时间内单位时间的活跃神经元事件总数。这是雪崩大小 $S$ 与雪崩持续时间 $D$ 的比率。\n$$R = \\frac{S}{D}$$\n问题要求速率以赫兹（$\\mathrm{Hz}$）表示，这相当于事件/秒（$\\mathrm{s}^{-1}$）。我们必须首先将持续时间 $D$ 从毫秒转换为秒。\n$$D = 16\\,\\mathrm{ms} = 16 \\times 10^{-3}\\,\\mathrm{s}$$\n现在我们可以计算速率：\n$$R = \\frac{400 \\text{ 事件}}{16 \\times 10^{-3}\\,\\mathrm{s}} = \\frac{400}{16} \\times 10^3\\,\\mathrm{Hz}$$\n$$R = 25 \\times 10^3\\,\\mathrm{Hz} = 25000\\,\\mathrm{Hz}$$\n用标准科学记数法表示：\n$$R = 2.5 \\times 10^4\\,\\mathrm{Hz}$$\n\n计算出的三个量是：\n- 雪崩大小：$400$\n- 雪崩持续时间：$16\\,\\mathrm{ms}$\n- 平均雪崩速率：$25000\\,\\mathrm{Hz}$ 或 $2.5 \\times 10^4\\,\\mathrm{Hz}$\n\n最终答案应按指定顺序呈现这三个数值。",
            "answer": "$$\\boxed{\\begin{pmatrix} 400  16  2.5 \\times 10^4 \\end{pmatrix}}$$"
        },
        {
            "introduction": "神经雪崩研究中的一个标志性发现是其规模分布常遵循一个幂律，这被认为是脑网络处于临界状态的证据。本练习旨在揭示这一现象背后的核心理论，引导学生使用分支过程（branching process）这一基本模型，从第一性原理出发，推导出在临界条件下雪崩规模分布的普适幂律指数 $S^{-3/2}$。",
            "id": "4002313",
            "problem": "在一个简化的神经雪崩模型中，考虑一个离散时间的高尔顿-沃森（Galton–Watson）分支过程，其中在第 $t$ 代的每个活跃神经元会在第 $t+1$ 代产生随机数量 $K$ 的活跃后代。假设该过程在第 $t=0$ 代由单个活跃神经元引发，后代的数量在不同神经元和不同代之间是独立同分布的，并且该过程是临界的，平均后代数为 $\\mathbb{E}[K]=m=1$，方差为有限非零值 $\\mathrm{Var}(K)=\\sigma^{2}\\in(0,\\infty)$。定义雪崩大小 $S$ 为从过程开始到灭绝的所有代中活跃神经元的总数，包括初始神经元。\n\n设 $f(u)=\\sum_{k=0}^{\\infty} p_{k} u^{k}$ 表示 $K$ 的概率生成函数（PGF），并设 $T(z)=\\sum_{s=1}^{\\infty} \\mathbb{P}(S=s) z^{s}$ 表示雪崩大小 $S$ 的 PGF。从分支过程的基本原理和概率生成函数（PGFs）的性质出发，完成以下任务：\n\n- 根据分支属性和 $S$ 的定义，构建 $T(z)$ 和 $f(u)$ 之间的函数关系。\n- 在临界条件 $\\mathbb{E}[K]=1$ 和有限方差 $\\sigma^{2}$ 下，分析 $T(z)$ 在 $z=1$ 邻域内的行为。\n- 使用针对具有平方根奇点的生成函数系数渐近性的标准转换定理，推导当 $s$ 很大时雪崩大小分布 $\\mathbb{P}(S=s)$ 的渐近形式。\n\n报告渐近定律中的系数 $C$（一个仅用 $\\sigma$ 表示的闭式解析表达式）\n$$\n\\mathbb{P}(S=s)\\sim C\\, s^{-3/2}\\quad \\text{as } s\\to\\infty.\n$$\n你的最终答案必须仅为 $C$ 的表达式。不需要数值近似，也不涉及单位。",
            "solution": "问题要求在临界高尔顿-沃森分支过程中，推导雪崩大小分布的渐近定律 $\\mathbb{P}(S=s)\\sim C\\, s^{-3/2}$ 中的系数 $C$。该过程从单个个体开始，平均后代数为 $\\mathbb{E}[K]=m=1$（临界性），后代方差为有限非零值 $\\mathrm{Var}(K)=\\sigma^2$。\n\n首先，我们建立雪崩大小的概率生成函数（PGF）$T(z) = \\sum_{s=1}^{\\infty} \\mathbb{P}(S=s) z^{s}$ 与后代分布的 PGF $f(u) = \\sum_{k=0}^{\\infty} \\mathbb{P}(K=k) u^{k}$ 之间的函数关系。总雪崩大小 $S$ 是初始祖先（大小为1）与由其 $K$ 个后代引发的子雪崩大小之和。设初始祖先的后代数量为 $K$。这 $K$ 个后代中的每一个都开始一个新的、独立的分支过程，并且每个子雪崩的大小（记为 $S_i$，其中 $i=1, \\ldots, K$）与 $S$ 具有相同的分布。因此，总大小为 $S=1+\\sum_{i=1}^{K} S_i$。\n\n我们可以使用全期望定律来写出 $S$ 的 PGF：\n$$T(z) = \\mathbb{E}[z^S] = \\mathbb{E}\\left[z^{1+\\sum_{i=1}^{K} S_i}\\right] = z \\cdot \\mathbb{E}\\left[\\mathbb{E}\\left[z^{\\sum_{i=1}^{K} S_i} \\Big| K\\right]\\right]$$\n由于 $S_i$ 是独立同分布的，在给定 $K=k$ 的条件下，它们和的 PGF 是它们各自 PGF 的乘积：$\\mathbb{E}\\left[z^{\\sum_{i=1}^{k} S_i}\\right] = \\left(\\mathbb{E}[z^S]\\right)^k = (T(z))^k$。\n对 $K$ 取期望，我们得到 $\\mathbb{E}[(T(z))^K] = \\sum_{k=0}^{\\infty} \\mathbb{P}(K=k) (T(z))^k$，根据定义，这正是在 $u=T(z)$ 处求值的 $K$ 的 PGF。因此，我们有：\n$$T(z) = z \\cdot f(T(z))$$\n这是总后代数 PGF 的基本函数方程。\n\n接下来，我们在 $z=1$ 的邻域内分析这个方程。对于一个临界过程，最终灭绝的概率是 $1$，这意味着 $\\mathbb{P}(S  \\infty)=1$。因此，当 $z \\to 1^{-}$ 时，$T(z) = \\sum \\mathbb{P}(S=s)z^s \\to \\sum \\mathbb{P}(S=s) = 1$。令 $u=T(z)$。我们在 $u=1$ 附近对 $f(u)$ 进行泰勒展开。$f(u)$ 在 $u=1$ 处的导数与 $K$ 的矩相关：\n$f(1) = \\sum \\mathbb{P}(K=k) = 1$。\n$f'(1) = \\sum k \\mathbb{P}(K=k) = \\mathbb{E}[K] = m = 1$ （根据临界条件）。\n$f''(1) = \\sum k(k-1) \\mathbb{P}(K=k) = \\mathbb{E}[K(K-1)] = \\mathbb{E}[K^2] - \\mathbb{E}[K]$。\n我们知道 $\\mathrm{Var}(K) = \\sigma^2 = \\mathbb{E}[K^2] - (\\mathbb{E}[K])^2$。因为 $\\mathbb{E}[K]=1$，所以我们有 $\\mathbb{E}[K^2] = \\sigma^2 + 1$。\n所以，$f''(1) = (\\sigma^2+1) - 1 = \\sigma^2$。\n\n$f(u)$ 在 $u=1$ 附近的泰勒级数是：\n$$f(u) = f(1) + f'(1)(u-1) + \\frac{f''(1)}{2!}(u-1)^2 + O((u-1)^3)$$\n$$f(u) = 1 + 1 \\cdot (u-1) + \\frac{\\sigma^2}{2}(u-1)^2 + O((u-1)^3) = u + \\frac{\\sigma^2}{2}(u-1)^2 + O((u-1)^3)$$\n将此代入函数方程 $T(z) = z f(T(z))$，其中 $u=T(z)$：\n$$u = z \\left( u + \\frac{\\sigma^2}{2}(u-1)^2 + O((u-1)^3) \\right)$$\n重新整理各项：\n$$u(1-z) = z \\frac{\\sigma^2}{2}(u-1)^2 + z O((u-1)^3)$$\n当 $z \\to 1^-$ 时，我们有 $u=T(z) \\to 1^-$。我们可以通过在方程中不太敏感的部分设置 $z \\approx 1$ 和 $u \\approx 1$ 来分析其主导阶行为：\n$$1 \\cdot (1-z) \\approx 1 \\cdot \\frac{\\sigma^2}{2}(u-1)^2$$\n$$(u-1)^2 \\approx \\frac{2(1-z)}{\\sigma^2}$$\n由于当 $z1$ 时 $u=T(z)1$，我们有 $u-10$，所以必须取负平方根：\n$$u-1 \\approx -\\sqrt{\\frac{2(1-z)}{\\sigma^2}} = -\\frac{\\sqrt{2}}{\\sigma}\\sqrt{1-z}$$\n因此，$T(z)$ 在其奇点 $z=1$ 附近的渐近行为是：\n$$T(z) \\approx 1 - \\frac{\\sqrt{2}}{\\sigma}\\sqrt{1-z} = 1 - \\frac{\\sqrt{2}}{\\sigma}(1-z)^{1/2}$$\n这个平方根奇点决定了系数 $\\mathbb{P}(S=s)$ 的渐近行为。\n\n为了找到 $\\mathbb{P}(S=s)$ 的渐近形式，我们使用一个转换定理。该定理指出，如果一个生成函数 $A(z) = \\sum a_n z^n$ 在 $z \\to 1$ 时行为类似于 $A(z) \\sim K(1-z)^{-\\alpha}$ （其中 $\\alpha \\notin \\{0, -1, -2, \\ldots\\}$），那么其系数具有渐近形式 $a_n \\sim K \\frac{n^{\\alpha-1}}{\\Gamma(\\alpha)}$。\n我们可以将此定理应用于 $T'(z)$。对 $T(z)$ 的渐近表达式求导：\n$$T'(z) \\approx \\frac{d}{dz}\\left(1 - \\frac{\\sqrt{2}}{\\sigma}(1-z)^{1/2}\\right) = - \\frac{\\sqrt{2}}{\\sigma} \\cdot \\frac{1}{2}(1-z)^{-1/2} \\cdot (-1) = \\frac{\\sqrt{2}}{2\\sigma}(1-z)^{-1/2} = \\frac{1}{\\sigma\\sqrt{2}}(1-z)^{-1/2}$$\n$T'(z)$ 的系数是 $[z^s]T'(z) = (s+1)\\mathbb{P}(S=s+1)$。应用转换定理，其中 $K = \\frac{1}{\\sigma\\sqrt{2}}$ 且 $\\alpha = 1/2$：\n$$[z^s]T'(z) \\sim \\frac{1}{\\sigma\\sqrt{2}} \\frac{s^{(1/2)-1}}{\\Gamma(1/2)} = \\frac{1}{\\sigma\\sqrt{2}} \\frac{s^{-1/2}}{\\sqrt{\\pi}} = \\frac{1}{\\sigma\\sqrt{2\\pi}} s^{-1/2}$$\n其中我们使用了已知值 $\\Gamma(1/2)=\\sqrt{\\pi}$。\n令 $T'(z)$ 系数的两个表达式相等：\n$$(s+1)\\mathbb{P}(S=s+1) \\sim \\frac{1}{\\sigma\\sqrt{2\\pi}} s^{-1/2}$$\n对于大的 $s$，令 $n=s+1$。对于大的 $n$：\n$$n \\mathbb{P}(S=n) \\sim \\frac{1}{\\sigma\\sqrt{2\\pi}} (n-1)^{-1/2} \\approx \\frac{1}{\\sigma\\sqrt{2\\pi}} n^{-1/2}$$\n两边除以 $n$，我们得到雪崩大小 $S$ 的渐近分布：\n$$\\mathbb{P}(S=n) \\sim \\frac{1}{\\sigma\\sqrt{2\\pi}} n^{-3/2}$$\n将此与所要求的形式 $\\mathbb{P}(S=s)\\sim C\\, s^{-3/2}$ 进行比较，我们确定系数 $C$ 为：\n$$C = \\frac{1}{\\sigma\\sqrt{2\\pi}}$$\n这是关于临界分支过程大小分布的著名结果。",
            "answer": "$$\\boxed{\\frac{1}{\\sigma\\sqrt{2\\pi}}}$$"
        },
        {
            "introduction": "在神经科学实验中，我们通常只能观测到网络中一小部分神经元的活动，这种不完整的观测被称为“子采样”（subsampling）。一个自然而关键的问题是：子采样会如何影响我们测得的雪崩统计特性？本练习通过一个严谨的数学推导，探讨了子采样对临界雪崩规模分布的影响，并揭示了为何幂律特征在这种不完美的观测条件下依然能够保持其稳健性。",
            "id": "4292899",
            "problem": "考虑一个基于临界 Galton–Watson 分支过程的神经雪崩理论模型，其中雪崩定义为在熄灭前被激活的神经元总数。设雪崩大小由 $S \\in \\mathbb{N}$ 表示，并假设在具有有限后代方差的临界状态下，对于大的 $S$，其大小分布具有经过充分检验的渐近形式 $P(S) \\sim C S^{-3/2}$，直至受到网络大小或观测窗口限制所施加的有限尺寸截断 $S_{c}$ 为止。假设由于随机空间子采样，每个被激活的神经元以概率 $p \\in (0,1)$ 被独立观测到，因此观测到的雪崩大小 $s$ 是雪崩中被观测到的激活神经元数量。\n\n从基本概率定义和广为接受的渐近理论出发，推导在子采样比例为 $p$ 的情况下，观测到的大小分布尾部 $P_{\\mathrm{obs}}(s)$ 的主阶渐近形式，并确定观测分布中的有效截断如何随 $p$ 缩放。您的推导必须明确地从将 $P_{\\mathrm{obs}}(s)$ 表示为基于二项采样模型的对 $S$ 的混合分布开始，并使用对于大雪崩成立的第一性原理近似（例如，斯特林近似和针对二项分布的中心极限定理（CLT））进行。用 $s$、$p$ 和 $C$ 表示最终的尾部分布，用 $p$ 和 $S_{c}$ 表示截断尺度。\n\n您的最终答案必须是一个单一的分析对象。如果您同时报告尾部表达式和截断缩放，请将它们按“尾部，截断”的顺序排列成一个二元行矩阵。不需要单位。最终答案中不要提供任何不等式。",
            "solution": "该问题要求推导在子采样下神经雪崩的观测大小分布的渐近形式，以及有效截断的缩放关系。\n\n真实雪崩大小 $S$ 是一个随机变量，其分布对于大的 $S$ 具有渐近形式 $P(S) \\sim C S^{-3/2}$，其中 $C$ 是一个常数。该分布受限于一个有限尺寸截断 $S_c$。在一次真实雪崩中，$S$ 个被激活的神经元中的每一个都以概率 $p \\in (0,1)$ 被独立观测到。观测到的雪崩大小 $s$ 是被探测到的神经元数量。\n\n在给定真实雪崩大小为 $S$ 的条件下，观测到大小为 $s$ 的雪崩的条件概率服从二项分布，因为 $S$ 个神经元中的每一个都代表一次成功概率为 $p$ 的独立伯努利试验。这由下式给出：\n$$\nP(s|S) = \\binom{S}{s} p^s (1-p)^{S-s}\n$$\n此式定义于 $0 \\le s \\le S$。若 $s  S$，则 $P(s|S) = 0$。\n\n观测到大小为 $s$ 的雪崩的总概率，记为 $P_{\\mathrm{obs}}(s)$，是通过对所有可能的真实雪崩大小 $S$ 进行边缘化得到的：\n$$\nP_{\\mathrm{obs}}(s) = \\sum_{S=s}^{S_c} P(s|S) P(S)\n$$\n求和从 $S=s$ 开始，因为观测到的神经元数量不可能超过实际被激活的数量。求和结束于系统截断 $S_c$。\n\n代入给定的 $P(S)$ 的渐近形式，我们得到：\n$$\nP_{\\mathrm{obs}}(s) \\approx \\sum_{S=s}^{S_c} \\left[ \\binom{S}{s} p^s (1-p)^{S-s} \\right] \\left( C S^{-3/2} \\right)\n$$\n我们对大 $s$ 时 $P_{\\mathrm{obs}}(s)$ 的行为感兴趣。当 $s$ 很大时，求和中的任何 $S \\ge s$ 也都很大。这为两个关键近似提供了依据：\n1. 求和可以用积分来近似。\n2. 二项分布 $P(s|S)$ 可以用高斯分布来近似（De Moivre-Laplace 定理）。二项分布 $\\mathrm{Bin}(S,p)$ 的均值为 $\\mu = Sp$，方差为 $\\sigma^2 = Sp(1-p)$。高斯近似为：\n$$\nP(s|S) \\approx \\frac{1}{\\sqrt{2\\pi S p(1-p)}} \\exp\\left( -\\frac{(s - Sp)^2}{2Sp(1-p)} \\right)\n$$\n用积分替换求和并代入近似，我们有：\n$$\nP_{\\mathrm{obs}}(s) \\approx C \\int_{s}^{S_c} \\frac{1}{\\sqrt{2\\pi S p(1-p)}} \\exp\\left( -\\frac{(s - Sp)^2}{2Sp(1-p)} \\right) S^{-3/2} dS\n$$\n合并含 $S$ 的项：\n$$\nP_{\\mathrm{obs}}(s) \\approx \\frac{C}{\\sqrt{2\\pi p(1-p)}} \\int_{s}^{S_c} S^{-2} \\exp\\left( -\\frac{(s - Sp)^2}{2Sp(1-p)} \\right) dS\n$$\n这个积分可以使用拉普拉斯方法（或鞍点近似）来计算，因为对于大的 $s$，指数项在 $S_0 = s/p$ 处是尖锐峰值的。只要 $S_0  S_c$，峰值就在积分域内。\n根据拉普拉斯方法，积分主要由被积函数在鞍点 $S_0=s/p$ 附近的行为决定。在峰值处，指数项的宗量为零，$\\exp(0)=1$。缓变的 $S^{-2}$ 项在鞍点处取值为 $(s/p)^{-2} = p^2s^{-2}$。\n积分的其余部分近似于一个以 $S_0$ 为中心的高斯函数的积分。该高斯函数的方差可以通过展开指数的宗量得到，其方差为 $\\sigma_S^2 = \\frac{s(1-p)}{p^2}$。高斯积分的值为 $\\sqrt{2\\pi \\sigma_S^2} = \\sqrt{\\frac{2\\pi s(1-p)}{p^2}} = \\frac{\\sqrt{2\\pi s(1-p)}}{p}$。\n\n因此，整个积分近似为：\n$$\\int_{s}^{S_c} \\dots dS \\approx (p^2s^{-2}) \\cdot \\frac{\\sqrt{2\\pi s(1-p)}}{p} = p s^{-3/2} \\sqrt{2\\pi(1-p)}$$\n将此结果代回到 $P_{\\mathrm{obs}}(s)$ 的表达式中：\n$$\nP_{\\mathrm{obs}}(s) \\approx \\frac{C}{\\sqrt{2\\pi p(1-p)}} \\left( p s^{-3/2} \\sqrt{2\\pi(1-p)} \\right)\n$$\n$$\nP_{\\mathrm{obs}}(s) \\approx C \\frac{p}{\\sqrt{p}} s^{-3/2} = C \\sqrt{p} s^{-3/2}\n$$\n这就是观测大小分布的主阶渐近形式。在子采样下，-3/2 的幂律指数得以保留，但振幅被缩放了 $\\sqrt{p}$。\n\n接下来，我们确定观测分布中有效截断的缩放关系。上述推导基于鞍点 $S_0 = s/p$ 远小于真实截断 $S_c$ 的假设。当观测大小 $s$ 增加到某个值 $s_c$，使得相应的最可能真实大小 $S_0$ 接近真实截断 $S_c$ 时，幂律行为将失效。因此，观测分布中的有效截断 $s_c$ 可以通过条件 $S_0 \\approx S_c$ 来估计。\n$$\\frac{s_c}{p} \\approx S_c \\implies s_c \\approx p S_c$$\n因此，观测分布的有效截断与子采样概率 $p$ 和原始截断 $S_c$ 呈线性缩放关系。\n\n所需的两个结果是：\n1. 观测分布的渐近尾部：$P_{\\mathrm{obs}}(s) \\sim C \\sqrt{p} s^{-3/2}$。\n2. 观测截断的缩放关系：$p S_c$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} C \\sqrt{p} s^{-3/2}  p S_c \\end{pmatrix}}\n$$"
        }
    ]
}