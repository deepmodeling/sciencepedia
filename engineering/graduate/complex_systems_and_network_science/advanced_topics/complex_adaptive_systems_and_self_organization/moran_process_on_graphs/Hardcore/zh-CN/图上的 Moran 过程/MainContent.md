## 引言
在[群体遗传学](@entry_id:146344)与[演化动力学](@entry_id:1124712)中，一个核心问题是：一个新性状（如[基因突变](@entry_id:262628)或新策略）如何在群体中传播，并最终被固定或淘汰？[莫兰过程](@entry_id:1128160)（Moran process）为这一根本问题提供了一个简洁而强大的随机模型。然而，经典的[莫兰过程](@entry_id:1128160)常假设群体是“均匀混合”的，即每个个体与他人互动的[机会均等](@entry_id:637428)，这在现实的生物或社会系统中是罕见的。本文旨在填补这一理论与现实之间的鸿沟，系统性地将[莫兰过程](@entry_id:1128160)从简单的[完全图](@entry_id:266483)推广到复杂的网络结构上，揭示[种群结构](@entry_id:148599)如何从根本上塑造演化命运。

本文将引导读者分三步深入探索图上的[莫兰过程](@entry_id:1128160)。首先，在“原理和机制”一章中，我们将奠定数学基础，从最基本的出生-死亡过程出发，详细推导在任意图结构上不同更新规则（如出生-死亡与死亡-出生）下的转移概率，并介绍对偶性、顶点温度等高级分析工具。接着，在“应用与跨学科连接”一章中，我们将展示该理论框架的强大适用性，探讨它如何与[演化博弈论](@entry_id:145774)、[群体遗传学](@entry_id:146344)乃至[数字病理学](@entry_id:913370)等领域交叉融合，解释从选择放大到细胞演化的复杂现象。最后，在“动手实践”部分，读者将有机会通过解决具体问题，将理论知识转化为计算和分析技能。

现在，让我们从第一章开始，深入[莫兰过程](@entry_id:1128160)的核心原理，理解其背后的数学机制。

## 原理和机制

在[群体遗传学](@entry_id:146344)和[演化博弈论](@entry_id:145774)中，理解一个新性状（如突变体）如何在群体中传播、最终被固定或被淘汰，是其核心问题之一。[莫兰过程](@entry_id:1128160)（Moran process）为研究这一问题提供了一个简洁而强大的随机模型框架。本章将深入探讨[莫兰过程](@entry_id:1128160)的基本原理和核心机制，从最简单的“均匀混合”群体模型出发，逐步扩展到复杂的网络结构，并介绍分析这些过程的关键概念和数学工具。

### 基本概念：均匀混合群体中的[莫兰过程](@entry_id:1128160)

我们首先从最简单的情形入手：一个大小为 $N$ 的有限、均匀混合的群体。在这种群体中，每个个体与其他所有个体之间发生相互作用的可能性均等，这种结构可以用一个**[完全图](@entry_id:266483)**（complete graph）$K_N$ 来表示。群体中存在两种类型的个体：适应度为 $r > 0$ 的**突变体**（mutant）和[适应度](@entry_id:154711)为 $1$ 的**野生型**（resident）。

[莫兰过程](@entry_id:1128160)通过一系列离散的时间步骤来描述群体构成的演化。最经典的更新规则是**出生-死亡（birth-death, Bd）**过程。在每个时间步，发生一次出生和一次死亡事件，从而保持群体总数 $N$ 不变。具体步骤如下：

1.  **出生**：根据适应度按比例选择一个个体进行繁殖。群体中某个特定个体被选中繁殖的概率与其[适应度](@entry_id:154711)成正比。
2.  **死亡**：从整个群体中均匀随机地选择一个个体被淘汰。
3.  **替代**：新生个体将替代被淘汰的个体。

为了将此过程形式化，我们可以构建一个马尔科夫链，其状态是群体中突变体的数量，记为 $i$，其中 $i \in \{0, 1, \dots, N\}$。当群体中有 $i$ 个突变体和 $N-i$ 个野生型个体时，群体的总[适应度](@entry_id:154711) $F$ 为所有[个体适应](@entry_id:190630)度之和：$F = i \cdot r + (N-i) \cdot 1$。

根据出生规则，选中一个突变体进行繁殖的概率是 $\frac{ri}{ri + N - i}$，而选中一个野生型进行繁殖的概率是 $\frac{N-i}{ri + N - i}$。根据死亡规则，选中一个突变体被淘汰的概率是 $\frac{i}{N}$，选中一个野生型被淘汰的概率是 $\frac{N-i}{N}$。

突变体数量的变化仅取决于繁殖个体和死亡个体的类型。我们可以计算状态从 $i$ 转移的概率 ：

*   **突变体数量增加1 ($i \to i+1$)**：这需要一个突变体繁殖，同时一个野生型死亡。其转移概率 $T_i^{+}$ 为：
    $$
    T_i^{+} = \frac{ri}{ri + N - i} \cdot \frac{N-i}{N}
    $$

*   **突变体数量减少1 ($i \to i-1$)**：这需要一个野生型繁殖，同时一个突变体死亡。其转移概率 $T_i^{-}$ 为：
    $$
    T_i^{-} = \frac{N-i}{ri + N - i} \cdot \frac{i}{N}
    $$

*   **突变体数量不变 ($i \to i$)**：这发生在繁殖和死亡的个体类型相同时（突变体替代突变体，或野生型替代野生型）。其概率 $T_i^0$ 可以通过总概率为1来计算：
    $$
    T_i^0 = 1 - T_i^{+} - T_i^{-}
    $$

当 $i=0$ 时，群体中没有突变体，因此 $T_0^{+}=0$，状态将永久停留在 $0$。当 $i=N$ 时，群体中全是突变体，因此 $T_N^{-}=0$，状态将永久停留在 $N$。这两个状态，$i=0$（**灭绝**）和 $i=N$（**固定**），是马尔科夫链的**[吸收态](@entry_id:161036)**。[演化过程](@entry_id:175749)最终会到达这两个状态之一。

### 结构化群体：图上的[莫兰过程](@entry_id:1128160)

在更现实的场景中，个体并非均匀混合，其相互作用受到社交、地理或其他因素的限制。这种**结构化群体**可以用一个图 $G=(V, E)$ 来表示，其中顶点 $V$ 代表个体，边 $E$ 代表它们之间的相互作用关系。

将[莫兰过程](@entry_id:1128160)从[完全图](@entry_id:266483)推广到一般图上时，一个核心问题是如何定义更新规则。在[完全图](@entry_id:266483)上等价的规则在一般图上会产生截然不同的动力学行为。以下是三种最经典和被广泛研究的更新规则 ：

*   **出生-死亡 (birth-death, Bd) 更新**：此规则下，选择是全局的，而竞争是局部的。
    1.  **选择繁殖者**：从整个群体 $V$ 中，根据[适应度](@entry_id:154711)按比例选择一个个体 $i$ 进行繁殖。
    2.  **选择被替代者**：从繁殖者 $i$ 的邻居集合 $N(i)$ 中，均匀随机地选择一个个体 $j$ 被替代。

*   **死亡-出生 (death-birth, dB) 更新**：此规则下，死亡是全局的，而竞争是局部的。
    1.  **选择被替代者**：从整个群体 $V$ 中，均匀随机地选择一个个体 $j$ 死亡，留下一个空位。
    2.  **选择繁殖者**：从空位 $j$ 的邻居集合 $N(j)$ 中，根据[适应度](@entry_id:154711)按比例选择一个个体 $i$ 繁殖，填补该空位。

*   **连接动态 (Link Dynamics, LD) 更新**：此规则下，选择和竞争都局限在一条边上。
    1.  **选择相互作用边**：从图的所有边 $E$ 中，均匀随机地选择一条边 $\{i, j\}$。
    2.  **进行竞争**：个体 $i$ 和 $j$ 进行[适应度](@entry_id:154711)比较。$i$ 以概率 $\frac{f_i}{f_i+f_j}$ 替代 $j$，$j$ 以概率 $\frac{f_j}{f_i+f_j}$ 替代 $i$。

这些更新规则在根本上改变了[选择压力](@entry_id:175478)作用的方式。在Bd中，适应度高的个体有更多机会将其后代传播到其邻域。在dB中，所有个体死亡的风险相同，但[适应度](@entry_id:154711)高的个体在邻居死亡时有更大机会抢占空位。在LD中，演化完全是成对比较的结果。

### 动力学形式化：图上的转移核

为了精确分析图上的[莫兰过程](@entry_id:1128160)，我们需要将[状态空间](@entry_id:160914)从简单的突变体数量扩展到整个群体的**构型空间**。一个构型可以表示为一个集合 $S \subseteq V$，代表所有被突变体占据的顶点。[状态空间](@entry_id:160914)的大小为 $2^N$。下面我们推导Bd和dB规则下的单步转移概率。

#### 出生-死亡 (Bd) 更新的转移概率

在Bd规则下，一个构型 $S$ 发生改变，当且仅当一个类型的个体繁殖，并替代了其邻居中一个不同类型的个体。例如，考虑一个野生型顶点 $v \in V \setminus S$ 变为突变体的事件，即状态从 $S$ 转移到 $S \cup \{v\}$。这要求 $v$ 的某个突变体邻居 $u \in S \cap N(v)$ 被选中繁殖，并且其后代恰好替代了 $v$。

对所有可能的父本 $u$ 求和，我们可以得到总的转移概率 ：
$$
P\big(S \to S \cup \{v\}\big) = \sum_{u \in S \cap N(v)} \frac{f(u)}{F(S)} \cdot \frac{1}{d(u)}
$$
其中 $f(u)=r$ 是突变体 $u$ 的[适应度](@entry_id:154711)，$F(S) = r|S| + (N-|S|)$ 是当前构型的总[适应度](@entry_id:154711)，$d(u)$ 是顶点 $u$ 的度（邻居数量）。这个公式清晰地显示，转移概率取决于繁殖者 $u$ 的适应度以及它的度 $d(u)$。度越大的个体，其繁殖成功后，其影响被分散到更多邻居上，导致替换特定邻居的概率变小。

#### 死亡-出生 (dB) 更新的转移概率

在dB规则下，一个野生型顶点 $j \in V \setminus S$ 变为突变体，首先需要 $j$ 本身被选中死亡（概率为 $1/N$），然后它的邻居集合 $N(j)$ 中的一个突变体被选中繁殖。邻居间的竞争是局部的，只在 $N(j)$ 内部进行。

因此，从 $S$ 转移到 $S \cup \{j\}$ 的概率为 ：
$$
P\big(S \to S \cup \{j\}\big) = \frac{1}{N} \cdot \frac{r \cdot |N(j) \cap S|}{r \cdot |N(j) \cap S| + 1 \cdot |N(j) \setminus S|}
$$
这里，$|N(j) \cap S|$ 是 $j$ 的突变体邻居数量，而 $|N(j) \setminus S|$ 是其野生型邻居数量。这个公式表明，在dB过程中，一个顶点命运的改变，完全取决于其**局部邻域的构成**。

#### Bd 与 dB 的比较：有效竞争集合

通过对比上述两种规则的转移概率，我们可以更深刻地理解它们的差异 。

*   在 **Bd** 过程中，决定顶点 $v$ 是否被替换的“有效竞争集合”是其每个邻居 $u$ 的邻居集合 $N(u)$。$v$ 的命运取决于它的邻居们（作为潜在的繁殖者）各自的适应度和度数。繁殖者 $u$ 的度 $d(u)$ 通过因子 $1/d(u)$ 直接出现在概率公式中。
*   在 **dB** 过程中，决定空位 $j$ 被何种类型占据的“有效竞争集合”就是 $j$ 自身的邻居集合 $N(j)$。$j$ 的邻居们为了填补空位而展开竞争。因此，是 $j$ 的邻域构成，而不是繁殖者本身的度，决定了结果。

这种机制上的差异导致了两种规则在非规则图上会产生截然不同的[演化动力学](@entry_id:1124712)，尽管它们在[完全图](@entry_id:266483)上是等价的。

#### [绝对适应度](@entry_id:168875)与[相对适应度](@entry_id:153028)

一个值得注意的基本性质是，在上述定义的[莫兰过程](@entry_id:1128160)中，[演化动力学](@entry_id:1124712)仅依赖于不同类型个体间的**[相对适应度](@entry_id:153028)（relative fitness）**，而非其**[绝对适应度](@entry_id:168875)（absolute fitness）**。假设突变体A的[绝对适应度](@entry_id:168875)为 $f_A$，野生型B的[绝对适应度](@entry_id:168875)为 $f_B$。我们可以定义[相对适应度](@entry_id:153028) $r = f_A / f_B$。

在计算转移概率时，无论是Bd还是dB规则，选择繁殖者的概率都涉及[适应度](@entry_id:154711)的比值。例如，在Bd中，选择一个个体 $i$ 的概率是 $\frac{f_i}{\sum_j f_j}$。如果我们将所有个体的适应度都乘以一个正常数 $\lambda > 0$（即 $f_A \to \lambda f_A, f_B \to \lambda f_B$），那么选择概率变为 $\frac{\lambda f_i}{\sum_j \lambda f_j} = \frac{f_i}{\sum_j f_j}$，保持不变。同样，在dB的局部竞争中，选择邻居 $i$ 的概率为 $\frac{f_i}{\sum_{k \in N(j)} f_k}$，这同样不受 $\lambda$ 缩放的影响。

因此，整个马尔科夫链的转移[概率矩阵](@entry_id:274812)仅由[相对适应度](@entry_id:153028) $r$ 和图结构决定。这意味着，只要个体间的适应度比例不变，无论它们的绝对繁殖率有多高或多低，演化的最终结果（如[固定概率](@entry_id:178551)和平均固定时间）都是一样的 。

### 高级主题与分析工具

#### 对偶性与中性动力学 (dB)

在**[中性演化](@entry_id:172700)** ($r=1$) 的特殊情况下，dB过程展现出一种深刻的**对偶性（duality）**，它与**凝聚随机游走（coalescing random walks）**系统相关联 。这为计算[固定概率](@entry_id:178551)提供了一个强大的分析工具。

我们可以通过追踪群体中每个个体在时间上的祖先来理解这种对偶性。在dB更新中，当顶点 $u$ 被其邻居 $v$ 替代时，我们可以说 $u$ 在下一时刻的祖先是 $v$。将时间倒退，每个个体的谱系在图上进行一次随机游走。当两个谱系在同一个顶点相遇时，它们就“凝聚”成一个，因为它们拥有了共同的祖先。由于图是有限连通的，最终所有 $N$ 个个体的谱系都会凝聚成唯一的[共同祖先](@entry_id:175919)。

突变体最终固定的概率 $\rho(S)$，等于这个最终的[共同祖先](@entry_id:175919)来自初始突变体集合 $S$ 的概率。在中性dB过程中，可以证明，一个在顶点 $i$ 的个体成为整个群体[共同祖先](@entry_id:175919)的概率，等于简单随机游走在该图上的**[平稳分布](@entry_id:194199)** $\pi_i$。对于一个无向图，$\pi_i$ 由[顶点的度](@entry_id:264944)决定：
$$
\pi_i = \frac{d(i)}{\sum_{j \in V} d(j)} = \frac{d(i)}{2|E|}
$$
其中 $|E|$ 是图的边数。因此，对于单个初始突变体在顶点 $i$ 的情况，其[固定概率](@entry_id:178551)为 $\rho(\{i\}) = \pi_i$。对于一个初始突变体集合 $S$，[固定概率](@entry_id:178551)为：
$$
\rho(S) = \sum_{i \in S} \pi_i = \sum_{i \in S} \frac{d(i)}{2|E|}
$$
这个结果揭示了在中性dB过程中，度数高的顶点（Hubs）对于演化有着不成比例的巨大影响。从高 度顶点开始的突变体有更高的[固定概率](@entry_id:178551)。一个重要的推论是，在**$k$-[正则图](@entry_id:265877)**（所有[顶点度数](@entry_id:264944)均为 $k$）上，$\pi_i = \frac{k}{Nk} = \frac{1}{N}$。此时，[固定概率](@entry_id:178551)退化为初始突变体的比例 $\rho(S) = \frac{|S|}{N}$，这与均匀混合群体的结果完全一致 。

#### 顶点温度与演化结果 (Bd)

对于Bd过程，另一个强大的分析概念是**顶点温度（vertex temperature）**。在一个加权[有向图](@entry_id:920596)上，如果从顶点 $j$ 到 $i$ 的扩散权重为 $w_{ji}$，则顶点 $i$ 的温度 $T_i$ 定义为所有指向它的权重之和：$T_i = \sum_j w_{ji}$。这个量衡量了顶点 $i$ 被替换的固有风险 。

在Bd更新的无向[简单图](@entry_id:274882)背景下，我们可以将此概念具体化。当一个邻居 $j$ 繁殖时，它以 $1/d(j)$ 的概率替换 $i$。因此，顶点 $i$ 的温度可以定义为 ：
$$
T_i = \sum_{j \in N(i)} \frac{1}{d(j)}
$$
$T_i$ 高的顶点，其邻居的度普遍较低，这使得这些邻居在繁殖时有很大概率会替换掉 $i$。因此，高温顶点是“危险”或“不稳定”的位置。

图的结构可以通过其温度分布影响选择的效率。我们将图 $G$ 上的[固定概率](@entry_id:178551) $\rho_G(r)$ 与均匀混合群体（[完全图](@entry_id:266483) $K_N$）的[固定概率](@entry_id:178551) $\rho_{K_N}(r)$ 进行比较。

*   如果对于 $r>1$（有利突变），有 $\rho_G(r) > \rho_{K_N}(r)$，则称图 $G$ 是**选择的放大器 (amplifier of selection)**。
*   如果对于 $r>1$，有 $\rho_G(r)  \rho_{K_N}(r)$，则称图 $G$ 是**选择的抑制器 (suppressor of selection)**。

一个重要的理论结果是**等温定理 (isothermal theorem)**：如果一个图对于Bd更新是“等温”的（即所有顶点的温度 $T_i$ 都相等），那么 $\rho_G(r) = \rho_{K_N}(r)$。[正则图](@entry_id:265877)就是典型的等温图。

这意味着，选择的放大或抑制来源于图中**温度的[异质性](@entry_id:275678)**。研究表明，在弱选择（$r \approx 1$）极限下，顶点温度的方差越大，图作为[选择放大器](@entry_id:1120984)的效应就越强 。例如，[星形图](@entry_id:271558)具有一个极高温的[中心顶点](@entry_id:264579)和许多极低温的叶子顶点。虽然从中心开始的突变体极易被清除，但从“安全”的叶子顶点开始的突变体有非常高的机会存活并最终占据中心，进而传遍全图。后者的巨大成功远超前者的失败，使得[星形图](@entry_id:271558)成为一个强效的[选择放大器](@entry_id:1120984)。

### [长期行为](@entry_id:192358)：突变的作用

到目前为止，我们假设没有新的突变产生。如果我们在模型中引入**对称突变**（即在繁殖时，后代以一个小的概率 $\mu \in (0,1)$ 变为另一类型），[演化过程](@entry_id:175749)的性质会发生根本性改变 。

在没有突变的情况下，马尔科夫链拥有两个[吸收态](@entry_id:161036)（全A或全B），演化最终会停止。但只要 $\mu > 0$，任何构型都有可能通过一系列突变事件转变为任何其他构型。这意味着：

1.  **马尔科夫链是不可约的 (irreducible)**：从任何构型出发，经过有限步，都有可能到达任何其他构型。[吸收态](@entry_id:161036)消失了。
2.  **马尔科夫链是非周期的 (aperiodic)**：由于后代类型可能与亲本相同，也可能与被替换的个体相同，因此总存在一个正的概率从一个状态转移回自身（自环），这保证了[非周期性](@entry_id:275873)。

一个有限、不可约且非周期的马尔科夫链是**遍历的 (ergodic)**。根据马尔科夫链的基本定理，这样的过程不再固定在某个状态，而是会收敛到一个唯一的**[平稳分布](@entry_id:194199) (stationary distribution)**。这个[平稳分布](@entry_id:194199)描述了在长时间演化后，系统处于每种可能构型的概率。此时，演化达到一种动态平衡，群体中两种类型的个体会以一定的比例共存，其具体的[空间分布](@entry_id:188271)则由这个[平稳分布](@entry_id:194199)来刻画。