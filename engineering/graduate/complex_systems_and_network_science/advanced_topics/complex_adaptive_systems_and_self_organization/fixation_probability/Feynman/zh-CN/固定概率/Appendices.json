{
    "hands_on_practices": [
        {
            "introduction": "本练习为从第一性原理计算固定概率提供了基础性实践。通过将种群动态建模为吸收马尔可夫链，我们可以根据系统状态推导出一个关于固定概率的线性方程组。求解这个针对小型、均匀混合种群的系统，将帮助您巩固对固定概率数学基础的理解，从抽象公式走向具体的、分步的计算 。",
            "id": "4277530",
            "problem": "考虑一个大小为$N=5$的均匀混合种群，其包含两种类型：常驻类型和突变类型。该种群在一个状态空间$\\{0,1,2,3,4,5\\}$上，以一个时间齐次的生灭马尔可夫链的形式演化，其中状态$i$表示种群中有$i$个突变体。状态$0$和$5$是吸收态，分别对应突变类型的灭绝和固定。对于瞬时态$i \\in \\{1,2,3,4\\}$，一步转移概率由下式给出\n$$\n\\Pr(i \\to i+1)=p_i,\\quad \\Pr(i \\to i-1)=q_i,\\quad \\Pr(i \\to i)=r_i,\n$$\n其中对于每个$i$都有$p_i+q_i+r_i=1$。具体值为：\n- 对于$i=1$：$p_1=\\frac{3}{10}$，$q_1=\\frac{1}{2}$，$r_1=\\frac{1}{5}$。\n- 对于$i=2$：$p_2=\\frac{2}{5}$，$q_2=\\frac{2}{5}$，$r_2=\\frac{1}{5}$。\n- 对于$i=3$：$p_3=\\frac{1}{2}$，$q_3=\\frac{3}{10}$，$r_3=\\frac{1}{5}$。\n- 对于$i=4$：$p_4=\\frac{3}{5}$，$q_4=\\frac{1}{5}$，$r_4=\\frac{1}{5}$。\n\n仅使用时间齐次马尔可夫链的吸收（固定）概率的基本定义和首步（后向）条件法，推导并求解决定了进入状态$5$的吸收概率的线性系统。令$u_i$表示链从状态$i$开始，最终被状态$5$吸收的概率。计算从单个突变体开始的固定概率，即$u_1$。将您的最终答案表示为精确值，不要四舍五入。",
            "solution": "该问题要求解一个大小为$N=5$的种群中突变类型的固定概率。该系统被建模为状态空间$\\{0, 1, 2, 3, 4, 5\\}$上的一个时间齐次生灭马尔可夫链，其中状态$i$表示突变体的数量。状态$0$和$5$是吸收态，分别对应于突变体的灭绝和固定。\n\n令$u_i$为过程从状态$i$开始，最终被状态$5$吸收（固定）的概率。根据定义，吸收态的边界条件为：\n$$\nu_0 = 0 \\quad (\\text{extinction})\n$$\n$$\nu_5 = 1 \\quad (\\text{fixation})\n$$\n\n对于瞬时态$i \\in \\{1, 2, 3, 4\\}$，我们可以使用首步（或后向）条件法为概率$u_i$建立一个线性方程组。该方法依赖于全概率定律，以过程第一步的结果为条件。对于任何瞬时态$i$，最终固定概率$u_i$是从每个可能的下一状态固定的概率之和，并以从状态$i$出发的转移概率为权重。\n\n一般方程为：\n$$\nu_i = \\sum_{j=0}^{N} \\Pr(\\text{next state is } j | \\text{current state is } i) \\times u_j\n$$\n对于给定的生灭过程，从状态$i \\in \\{1, 2, 3, 4\\}$出发的可能转移是到状态$i+1$、$i-1$或$i$。因此方程变为：\n$$\nu_i = p_i u_{i+1} + q_i u_{i-1} + r_i u_i\n$$\n其中$p_i = \\Pr(i \\to i+1)$、$q_i = \\Pr(i \\to i-1)$，且$r_i = \\Pr(i \\to i)$。\n\n我们可以通过合并包含$u_i$的项来简化此方程：\n$$\n(1 - r_i)u_i = p_i u_{i+1} + q_i u_{i-1}\n$$\n由于$p_i + q_i + r_i = 1$，我们有$1 - r_i = p_i + q_i$。将此代入方程可得：\n$$\n(p_i + q_i)u_i = p_i u_{i+1} + q_i u_{i-1}\n$$\n该方程将状态$i$的固定概率与其相邻状态的概率联系起来。现在我们使用给定的转移概率将此方程应用于每个瞬时态。\n\n对于$i=1$：\n方程为 $(p_1+q_1)u_1 = p_1 u_2 + q_1 u_0$。\n给定$p_1 = \\frac{3}{10}$，$q_1 = \\frac{1}{2}$，以及边界条件$u_0=0$：\n$$\n\\left(\\frac{3}{10} + \\frac{5}{10}\\right)u_1 = \\frac{3}{10} u_2 + \\frac{5}{10}(0) \\implies \\frac{8}{10}u_1 = \\frac{3}{10}u_2 \\implies 8u_1 = 3u_2\n$$\n这给出了我们的第一个方程：$8u_1 - 3u_2 = 0$。\n\n对于$i=2$：\n方程为 $(p_2+q_2)u_2 = p_2 u_3 + q_2 u_1$。\n给定$p_2 = \\frac{2}{5}$和$q_2 = \\frac{2}{5}$：\n$$\n\\left(\\frac{2}{5} + \\frac{2}{5}\\right)u_2 = \\frac{2}{5} u_3 + \\frac{2}{5} u_1 \\implies \\frac{4}{5}u_2 = \\frac{2}{5}u_3 + \\frac{2}{5}u_1 \\implies 2u_2 = u_3 + u_1\n$$\n这给出了我们的第二个方程：$u_1 - 2u_2 + u_3 = 0$。\n\n对于$i=3$：\n方程为 $(p_3+q_3)u_3 = p_3 u_4 + q_3 u_2$。\n给定$p_3 = \\frac{1}{2}$和$q_3 = \\frac{3}{10}$：\n$$\n\\left(\\frac{5}{10} + \\frac{3}{10}\\right)u_3 = \\frac{5}{10} u_4 + \\frac{3}{10} u_2 \\implies \\frac{8}{10}u_3 = \\frac{5}{10}u_4 + \\frac{3}{10}u_2 \\implies 8u_3 = 5u_4 + 3u_2\n$$\n这给出了我们的第三个方程：$3u_2 - 8u_3 + 5u_4 = 0$。\n\n对于$i=4$：\n方程为 $(p_4+q_4)u_4 = p_4 u_5 + q_4 u_3$。\n给定$p_4 = \\frac{3}{5}$，$q_4 = \\frac{1}{5}$，以及边界条件$u_5=1$：\n$$\n\\left(\\frac{3}{5} + \\frac{1}{5}\\right)u_4 = \\frac{3}{5}(1) + \\frac{1}{5}u_3 \\implies \\frac{4}{5}u_4 = \\frac{3}{5} + \\frac{1}{5}u_3 \\implies 4u_4 = 3 + u_3\n$$\n这给出了我们的第四个方程：$u_3 - 4u_4 = -3$。\n\n我们现在已经为四个未知概率$u_1, u_2, u_3, u_4$推导出了以下线性方程组：\n1.  $8u_1 - 3u_2 = 0$\n2.  $u_1 - 2u_2 + u_3 = 0$\n3.  $3u_2 - 8u_3 + 5u_4 = 0$\n4.  $u_3 - 4u_4 = -3$\n\n我们求解该方程组来求$u_1$。我们使用代入法。\n从方程(1)中，我们将$u_2$用$u_1$表示：\n$$\nu_2 = \\frac{8}{3}u_1\n$$\n将此代入方程(2)，求出用$u_1$表示的$u_3$：\n$$\nu_1 - 2\\left(\\frac{8}{3}u_1\\right) + u_3 = 0 \\implies u_1 - \\frac{16}{3}u_1 + u_3 = 0 \\implies -\\frac{13}{3}u_1 + u_3 = 0 \\implies u_3 = \\frac{13}{3}u_1\n$$\n从方程(4)中，我们将$u_4$用$u_3$表示，然后用$u_1$表示：\n$$\n4u_4 = u_3 + 3 \\implies u_4 = \\frac{1}{4}(u_3 + 3) = \\frac{1}{4}\\left(\\frac{13}{3}u_1 + 3\\right) = \\frac{13}{12}u_1 + \\frac{3}{4}\n$$\n现在，将$u_2, u_3, u_4$关于$u_1$的表达式全部代入最后一个剩余的方程(3)中：\n$$\n3\\left(\\frac{8}{3}u_1\\right) - 8\\left(\\frac{13}{3}u_1\\right) + 5\\left(\\frac{13}{12}u_1 + \\frac{3}{4}\\right) = 0\n$$\n简化方程：\n$$\n8u_1 - \\frac{104}{3}u_1 + \\frac{65}{12}u_1 + \\frac{15}{4} = 0\n$$\n为了消去分母，我们将整个方程乘以$3$、$12$和$4$的最小公倍数，即$12$：\n$$\n12(8u_1) - 4(104u_1) + 1(65u_1) + 3(15) = 0\n$$\n$$\n96u_1 - 416u_1 + 65u_1 + 45 = 0\n$$\n合并含有$u_1$的项：\n$$\n(96 - 416 + 65)u_1 + 45 = 0\n$$\n$$\n(161 - 416)u_1 + 45 = 0\n$$\n$$\n-255u_1 + 45 = 0\n$$\n最后，我们求解$u_1$：\n$$\n255u_1 = 45 \\implies u_1 = \\frac{45}{255}\n$$\n为了简化分数，我们可以将分子和分母同除以它们的最大公约数。两者都可以被$5$整除：\n$$\nu_1 = \\frac{45 \\div 5}{255 \\div 5} = \\frac{9}{51}\n$$\n现在两者都可以被$3$整除：\n$$\nu_1 = \\frac{9 \\div 3}{51 \\div 3} = \\frac{3}{17}\n$$\n从单个突变体开始的固定概率是$u_1 = \\frac{3}{17}$。",
            "answer": "$$\n\\boxed{\\frac{3}{17}}\n$$"
        },
        {
            "introduction": "在均匀混合种群的基础上，本实践将探索种群结构如何深刻影响演化结果。我们将分析在一个星形图（一个简单但高度异质化的网络）上，在不同更新规则（出生-死亡与死亡-出生）下的固定过程。此问题揭示了演化图论中的一个关键洞见：突变体的位置和微观的相互作用规则可以极大地改变固定概率，这突出表明结构不仅仅是细节，而是演化的关键决定因素 。",
            "id": "4277558",
            "problem": "考虑一个有 $N=3$ 个节点的星形图，它由一个中心节点和 $L=2$ 个叶节点连接而成。一个演化过程遵循图上的莫兰过程，其中存在两种类型：适应度为 $r>0$ 的突变类型和适应度为 $1$ 的野生类型。考虑两种随机更新机制：\n\n- 出生—死亡（BD）规则：在每一步中，一个节点以与其适应度成正比的概率被选中进行繁殖，其一个邻居被均匀随机地选择，并被其后代替换。\n\n- 死亡—出生（DB）规则：在每一步中，一个节点被均匀随机地选择死亡，其一个邻居以与其适应度成正比的概率被选中进行繁殖，以填补空位。\n\n设系统状态由 $(h,k)$ 表示，其中 $h\\in\\{0,1\\}$ 表示中心节点是突变型（$h=1$）还是野生型（$h=0$），$k\\in\\{0,1,2\\}$ 是突变叶节点的数量。吸收态为 $(1,2)$（突变体固定）和 $(0,0)$（突变体灭绝）。\n\n假设初始种群中恰好有两个突变体，处于以下构型之一：\n\n- 构型 A：一个突变体在中心节点，一个突变体在叶节点，即状态 $(1,1)$。\n\n- 构型 B：两个突变叶节点和一个野生型中心节点，即状态 $(0,2)$。\n\n从基本定义（即上述定义）出发，推导在出生—死亡（BD）规则和死亡—出生（DB）规则下，构型 A 和构型 B 的精确固定概率。将您的最终答案表示为 $r$ 的闭式函数。请按以下顺序提供四个固定概率：构型 A 的 BD 规则，构型 B 的 BD 规则，构型 A 的 DB 规则，构型 B 的 DB 规则。最终答案必须是单一的解析表达式。无需四舍五入。",
            "solution": "问题要求计算在两种不同的演化更新规则下，一个突变类型在具有 $N=3$ 个节点的星形图上的固定概率。该图由一个中心节点和 $L=2$ 个叶节点组成。设中心节点为节点 0，叶节点为节点 1 和 2。突变类型的适应度为 $r > 0$，野生类型的适应度为 $1$。\n\n系统状态由 $(h, k)$ 给出，其中 $h \\in \\{0, 1\\}$ 是中心节点的类型（$1$ 代表突变型，$0$ 代表野生型），$k \\in \\{0, 1, 2\\}$ 是突变叶节点的数量。吸收态是 $(0,0)$（灭绝）和 $(1,2)$（固定）。暂态是 $(0,1)$、$(0,2)$、$(1,0)$ 和 $(1,1)$。\n\n设 $\\rho_{h,k}$ 为从状态 $(h,k)$ 出发最终固定的概率。根据定义，$\\rho_{0,0} = 0$ 且 $\\rho_{1,2} = 1$。对于任何暂态 $i$，固定概率 $\\rho_i$ 满足关系式 $\\rho_i = \\sum_j P_{ij} \\rho_j$，其中 $P_{ij}$ 是从状态 $i$ 到状态 $j$ 的单步转移概率，求和遍及所有可能的下一状态。这导出了一个关于暂态固定概率的线性方程组。\n\n我们需要求解两种初始构型的固定概率：\n构型 A：状态 $(1,1)$，得到 $\\rho_A = \\rho_{1,1}$。\n构型 B：状态 $(0,2)$，得到 $\\rho_B = \\rho_{0,2}$。\n\n我们将分别分析这两种更新规则。\n\n### 出生—死亡（BD）规则\n在 BD 规则下，一个节点以与其适应度成正比的概率被选中进行繁殖。在给定状态下，种群的总适应度为 $W$。节点 $i$ 上的个体适应度为 $f_i$，其被选中的概率为 $f_i / W$。其后代会替换一个均匀随机选择的邻居。\n\n暂态为 $(0,1)$、$(0,2)$、$(1,0)$ 和 $(1,1)$。\n每个状态的总适应度 $W$ 为：\n- 状态 $(0,1)$：一个突变叶节点（$r$）、一个野生叶节点（$1$）、一个野生中心节点（$1$）。$W = r+1+1 = r+2$。\n- 状态 $(0,2)$：两个突变叶节点（每个适应度为 $r$）、一个野生中心节点（$1$）。$W = 2r+1$。\n- 状态 $(1,0)$：一个突变中心节点（$r$）、两个野生叶节点（每个适应度为 $1$）。$W = r+1+1 = r+2$。\n- 状态 $(1,1)$：一个突变中心节点（$r$）、一个突变叶节点（$r$）、一个野生叶节点（$1$）。$W = 2r+1$。\n\n让我们推导转移概率以及固定概率 $\\rho_{h,k}$ 的相应方程。\n\n从状态 $(0,1)$ 出发：$W = r+2$。\n- 突变叶节点繁殖（概率 $r/W$）。其邻居是中心节点，被替换。状态 $\\to (1,1)$。$P_{(0,1)\\to(1,1)} = \\frac{r}{r+2}$。\n- 野生中心节点繁殖（概率 $1/W$）。它以 $1/2$ 的概率替换其两个邻居（叶节点）之一。如果替换了突变叶节点，系统走向灭绝。状态 $\\to (0,0)$。$P_{(0,1)\\to(0,0)} = \\frac{1}{W} \\cdot \\frac{1}{2} = \\frac{1}{2(r+2)}$。\n$\\rho_{0,1}$ 的方程为 $\\rho_{0,1} = P_{(0,1)\\to(1,1)}\\rho_{1,1} + P_{(0,1)\\to(0,0)}\\rho_{0,0} + \\dots$。\n只考虑那些改变状态并导致非零固定概率项的转移：\n$(1 - P_{(0,1)\\to(0,1)})\\rho_{0,1} = P_{(0,1)\\to(1,1)}\\rho_{1,1} + P_{(0,1)\\to(0,0)}\\rho_{0,0}$。\n$(\\frac{r}{r+2} + \\frac{1}{2(r+2)}) \\rho_{0,1} = \\frac{r}{r+2}\\rho_{1,1}$。\n$\\frac{2r+1}{2(r+2)} \\rho_{0,1} = \\frac{2r}{2(r+2)}\\rho_{1,1} \\implies (2r+1)\\rho_{0,1} = 2r\\rho_{1,1}$。\n(1) $\\rho_{0,1} = \\frac{2r}{2r+1}\\rho_{1,1}$。\n\n从状态 $(1,1)$ 出发：$W = 2r+1$。\n- 突变中心节点繁殖（概率 $r/W$）。它替换一个邻居（对每个邻居的概率为 $1/2$）。如果替换了野生叶节点，系统达到固定。状态 $\\to (1,2)$。$P_{(1,1)\\to(1,2)} = \\frac{r}{W} \\cdot \\frac{1}{2} = \\frac{r}{2(2r+1)}$。\n- 野生叶节点繁殖（概率 $1/W$）。它替换其邻居，即中心节点。状态 $\\to (0,1)$。$P_{(1,1)\\to(0,1)} = \\frac{1}{W} = \\frac{1}{2r+1}$。\n方程为 $(1-P_{(1,1)\\to(1,1)})\\rho_{1,1} = P_{(1,1)\\to(1,2)}\\rho_{1,2} + P_{(1,1)\\to(0,1)}\\rho_{0,1}$。\n$(\\frac{r}{2(2r+1)} + \\frac{1}{2r+1}) \\rho_{1,1} = \\frac{r}{2(2r+1)}(1) + \\frac{1}{2r+1}\\rho_{0,1}$。\n$\\frac{r+2}{2(2r+1)}\\rho_{1,1} = \\frac{r}{2(2r+1)} + \\frac{2}{2(2r+1)}\\rho_{0,1}$。\n(2) $(r+2)\\rho_{1,1} = r + 2\\rho_{0,1}$。\n\n现在我们通过将 (1) 代入 (2) 来求解 $\\rho_{1,1}$（构型 A）：\n$(r+2)\\rho_{1,1} = r + 2\\left(\\frac{2r}{2r+1}\\rho_{1,1}\\right) = r + \\frac{4r}{2r+1}\\rho_{1,1}$。\n$\\rho_{1,1} \\left(r+2 - \\frac{4r}{2r+1}\\right) = r$。\n$\\rho_{1,1} \\left(\\frac{(r+2)(2r+1)-4r}{2r+1}\\right) = r$。\n$\\rho_{1,1} \\left(\\frac{2r^2+r+4r+2-4r}{2r+1}\\right) = r$。\n$\\rho_{1,1} \\left(\\frac{2r^2+r+2}{2r+1}\\right) = r$。\n$\\rho_{A, BD} = \\rho_{1,1} = \\frac{r(2r+1)}{2r^2+r+2}$。\n\n为了找到 $\\rho_{0,2}$（构型 B），我们需要它的转移概率。\n从状态 $(0,2)$ 出发：$W = 2r+1$。\n- 一个突变叶节点繁殖（概率 $2r/W$）。替换中心节点。状态 $\\to (1,2)$（固定）。$P_{(0,2)\\to(1,2)} = \\frac{2r}{2r+1}$。\n- 野生中心节点繁殖（概率 $1/W$）。替换一个突变叶节点。状态 $\\to (0,1)$。$P_{(0,2)\\to(0,1)} = \\frac{1}{2r+1}$。\n$\\rho_{0,2}$ 的方程是 $\\rho_{0,2} = P_{(0,2)\\to(1,2)}\\rho_{1,2} + P_{(0,2)\\to(0,1)}\\rho_{0,1}$。\n(3) $\\rho_{0,2} = \\frac{2r}{2r+1}(1) + \\frac{1}{2r+1}\\rho_{0,1}$。\n使用 (1) 和 $\\rho_{1,1}$ 的表达式：\n$\\rho_{0,1} = \\frac{2r}{2r+1} \\left(\\frac{r(2r+1)}{2r^2+r+2}\\right) = \\frac{2r^2}{2r^2+r+2}$。\n将此代入 (3)：\n$\\rho_{B, BD} = \\rho_{0,2} = \\frac{2r}{2r+1} + \\frac{1}{2r+1}\\left(\\frac{2r^2}{2r^2+r+2}\\right) = \\frac{2r(2r^2+r+2) + 2r^2}{(2r+1)(2r^2+r+2)}$。\n$\\rho_{B, BD} = \\frac{4r^3+2r^2+4r+2r^2}{(2r+1)(2r^2+r+2)} = \\frac{4r^3+4r^2+4r}{(2r+1)(2r^2+r+2)} = \\frac{4r(r^2+r+1)}{(2r+1)(2r^2+r+2)}$。\n\n### 死亡—出生（DB）规则\n在 DB 规则下，一个节点被均匀随机地选择死亡（概率 $1/N = 1/3$）。然后其邻居以与其适应度成正比的概率竞争繁殖，以填补空位。\n\n从状态 $(0,1)$ 出发：一个突变叶节点，一个野生叶节点，一个野生中心节点。\n- 中心节点死亡（概率 $1/3$）。邻居（突变叶节点、野生叶节点）竞争。适应度总和为 $r+1$。突变体以概率 $r/(r+1)$ 繁殖。状态 $\\to (1,1)$。$P_{(0,1)\\to(1,1)} = \\frac{1}{3}\\frac{r}{r+1}$。\n- 突变叶节点死亡（概率 $1/3$）。其邻居（野生中心节点）繁殖。状态 $\\to (0,0)$。$P_{(0,1)\\to(0,0)} = \\frac{1}{3}$。\n从这些转移得到的方程是 $(1-P_{(0,1)\\to(0,1)})\\rho_{0,1} = P_{(0,1)\\to(1,1)}\\rho_{1,1} + P_{(0,1)\\to(0,0)}\\rho_{0,0}$。\n$(\\frac{1}{3}\\frac{r}{r+1} + \\frac{1}{3})\\rho_{0,1} = \\frac{1}{3}\\frac{r}{r+1}\\rho_{1,1}$。\n$\\frac{r+(r+1)}{3(r+1)}\\rho_{0,1} = \\frac{r}{3(r+1)}\\rho_{1,1} \\implies (2r+1)\\rho_{0,1} = r\\rho_{1,1}$。\n(4) $\\rho_{0,1} = \\frac{r}{2r+1}\\rho_{1,1}$。\n\n从状态 $(1,1)$ 出发：一个突变中心节点，一个突变叶节点，一个野生叶节点。\n- 中心节点死亡（概率 $1/3$）。邻居（突变叶节点，野生叶节点）竞争。适应度总和 $r+1$。野生型以概率 $1/(r+1)$ 繁殖。状态 $\\to (0,1)$。$P_{(1,1)\\to(0,1)} = \\frac{1}{3}\\frac{1}{r+1}$。\n- 野生叶节点死亡（概率 $1/3$）。其邻居（突变中心节点）繁殖。状态 $\\to (1,2)$。$P_{(1,1)\\to(1,2)} = \\frac{1}{3}$。\n方程为 $(1-P_{(1,1)\\to(1,1)})\\rho_{1,1} = P_{(1,1)\\to(1,2)}\\rho_{1,2} + P_{(1,1)\\to(0,1)}\\rho_{0,1}$。\n$(\\frac{1}{3}\\frac{1}{r+1} + \\frac{1}{3}) \\rho_{1,1} = \\frac{1}{3}(1) + \\frac{1}{3(r+1)}\\rho_{0,1}$。\n$\\frac{1+(r+1)}{3(r+1)}\\rho_{1,1} = \\frac{r+1}{3(r+1)} + \\frac{1}{3(r+1)}\\rho_{0,1}$。\n(5) $(r+2)\\rho_{1,1} = r+1 + \\rho_{0,1}$。\n\n通过将 (4) 代入 (5) 求解 $\\rho_{1,1}$（构型 A）：\n$(r+2)\\rho_{1,1} = r+1 + \\frac{r}{2r+1}\\rho_{1,1}$。\n$\\rho_{1,1}\\left(r+2 - \\frac{r}{2r+1}\\right) = r+1$。\n$\\rho_{1,1}\\left(\\frac{(r+2)(2r+1)-r}{2r+1}\\right) = r+1$。\n$\\rho_{1,1}\\left(\\frac{2r^2+5r+2-r}{2r+1}\\right) = r+1$。\n$\\rho_{1,1}\\left(\\frac{2r^2+4r+2}{2r+1}\\right) = r+1$。\n$\\rho_{1,1}\\left(\\frac{2(r+1)^2}{2r+1}\\right) = r+1$。\n$\\rho_{A, DB} = \\rho_{1,1} = \\frac{(r+1)(2r+1)}{2(r+1)^2} = \\frac{2r+1}{2(r+1)}$。\n\n为了找到 $\\rho_{0,2}$（构型 B），我们分析其转移。\n从状态 $(0,2)$ 出发：两个突变叶节点，一个野生中心节点。\n- 中心节点死亡（概率 $1/3$）。邻居是两个突变叶节点。一个突变体繁殖。状态 $\\to (1,2)$（固定）。$P_{(0,2)\\to(1,2)} = \\frac{1}{3}$。\n- 一个突变叶节点死亡（概率 $2/3$）。邻居是野生中心节点，它进行繁殖。状态 $\\to (0,1)$。$P_{(0,2)\\to(0,1)} = \\frac{2}{3}$。\n方程为 $\\rho_{0,2} = P_{(0,2)\\to(1,2)}\\rho_{1,2} + P_{(0,2)\\to(0,1)}\\rho_{0,1}$。\n(6) $\\rho_{0,2} = \\frac{1}{3}(1) + \\frac{2}{3}\\rho_{0,1}$。\n使用 (4) 和 $\\rho_{1,1}$ 的表达式：\n$\\rho_{0,1} = \\frac{r}{2r+1}\\left(\\frac{2r+1}{2(r+1)}\\right) = \\frac{r}{2(r+1)}$。\n将此代入 (6)：\n$\\rho_{B, DB} = \\rho_{0,2} = \\frac{1}{3} + \\frac{2}{3}\\left(\\frac{r}{2(r+1)}\\right) = \\frac{1}{3} + \\frac{r}{3(r+1)} = \\frac{r+1+r}{3(r+1)} = \\frac{2r+1}{3(r+1)}$。\n\n四个固定概率为：\n1. BD，构型 A ($\\rho_{1,1}$): $\\frac{r(2r+1)}{2r^2+r+2}$\n2. BD，构型 B ($\\rho_{0,2}$): $\\frac{4r(r^2+r+1)}{(2r+1)(2r^2+r+2)}$\n3. DB，构型 A ($\\rho_{1,1}$): $\\frac{2r+1}{2(r+1)}$\n4. DB，构型 B ($\\rho_{0,2}$): $\\frac{2r+1}{3(r+1)}$",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{r(2r+1)}{2r^2+r+2} & \\frac{4r(r^2+r+1)}{(2r+1)(2r^2+r+2)} & \\frac{2r+1}{2(r+1)} & \\frac{2r+1}{3(r+1)} \\end{pmatrix} } $$"
        },
        {
            "introduction": "尽管解析解能提供精确的洞察，但它们通常仅限于简化的模型。本动手练习将介绍蒙特卡洛模拟，它是一种用于估算更复杂场景下固定概率的强大而通用的工具。您将实现出生-死亡莫兰过程，将其应用于完全图和规则图，并根据从等温定理推导出的精确解析解来验证您的模拟结果，从而搭建起理论预测与计算研究之间的桥梁 。",
            "id": "4277528",
            "problem": "一个大小为 $N$ 的种群占据了一个图的顶点。每个顶点上恰好有一个个体，该个体要么是基准适应度为 $1$ 的原住民，要么是适应度为 $r \\in \\mathbb{R}_{>0}$ 的突变体。该种群根据图上的生灭莫兰过程演化：在每个离散时间步，根据适应度按比例选择一个个体进行繁殖；然后，从其邻居中均匀随机地选择一个，并由繁殖个体的后代替换（即邻居变为繁殖者的类型）。该过程持续进行，直到达到两个吸收态之一：全部是突变体（固着）或没有突变体（灭绝）。在时间 $t=0$ 时，一个单一突变体被均匀随机地放置在图上。\n\n单一突变体的固着概率定义为该过程最终达到全突变体吸收态的概率。对于一个有 $N$ 个顶点的完全图，该过程是充分混合的，因为所有不同的顶点对都是相连的。对于一个无向正则图（每个顶点具有相同的度），这是等温图的一个特例，在生灭更新规则下，等温定理适用。\n\n从生灭莫兰过程和标准马尔可夫链吸收的基本定义出发，推导在生灭更新规则下，单个突变体在大小为 $N$ 的完全图上的解析固着概率。然后，利用无向正则图在生灭更新规则下的等温定理，论证这类图的解析固着概率。实现一个数值方法，通过对以下图上的随机过程进行蒙特卡洛模拟来估计固着概率：\n- 一个有 $N$ 个顶点的完全图，\n- 一个有 $N$ 个顶点的循环（环形）图，这是一个度为 $2$ 的无向正则图。\n\n你的程序必须：\n- 按照上述规定实现生灭莫兰过程的模拟，\n- 从第一性原理计算完全图的解析固着概率，\n- 利用等温定理的论证，为生灭更新规则下的循环图采用相同的解析固着概率，\n- 将模拟得到的固着概率与解析表达式进行比较，\n- 生成单行输出，包含一个用方括号括起来的逗号分隔列表，其中每个元素是一个布尔值，表示模拟和解析固着概率之间的绝对差是否最多为指定的容差。\n\n为保证可复现性，使用固定的随机种子 $42$。不接受任何用户输入；所有参数必须硬编码。\n\n测试套件：\n- 情况1：完全图, $N=10$, $r=2.0$, 独立模拟次数 $3000$, 容差 $0.03$.\n- 情况2：完全图, $N=10$, $r=1.0$, 独立模拟次数 $3000$, 容差 $0.03$.\n- 情况3：循环图, $N=20$, $r=3.0$, 独立模拟次数 $3000$, 容差 $0.03$.\n- 情况4：循环图, $N=5$, $r=1.05$, 独立模拟次数 $3000$, 容差 $0.03$.\n- 情况5：完全图, $N=2$, $r=5.0$, 独立模拟次数 $3000$, 容差 $0.03$.\n- 情况6：循环图, $N=30$, $r=0.5$, 独立模拟次数 $3000$, 容差 $0.03$.\n\n最终输出格式：\n你的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表的结果（例如，$\\texttt{[result1,result2,\\dots]}$）。每个结果必须是一个布尔值。",
            "solution": "该问题要求推导在完全图和正则图上，在生灭莫兰过程下单个突变体的解析固着概率，然后通过蒙特卡洛模拟进行数值验证。对问题陈述的验证证实了它是科学上合理的、适定的，并包含足够的信息以进行严谨的求解。\n\n系统的状态由突变体的数量 $i \\in \\{0, 1, \\dots, N\\}$ 定义。状态 $i=0$（灭绝）和 $i=N$（固着）是吸收态。对于任何瞬态 $i \\in \\{1, \\dots, N-1\\}$，突变体的数量可以增加一个，转移概率为 $T_i^+$，或减少一个，转移概率为 $T_i^-$。因此，该过程是在整数集 $\\{0, \\dots, N\\}$ 上的一个一维随机游走。\n\n设 $\\rho_i$ 表示从 $i$ 个突变体开始的固着概率。边界条件为 $\\rho_0=0$ 和 $\\rho_N=1$。固着概率 $\\rho_i$ 满足递推关系 $\\rho_i = p_{i,i+1}\\rho_{i+1} + p_{i,i-1}\\rho_{i-1}$，其中 $p_{i,i+1} = T_i^+ / (T_i^+ + T_i^-)$ 且 $p_{i,i-1} = T_i^- / (T_i^+ + T_i^-)$。从 $k$ 个个体开始的固着概率的通解为：\n$$ \\rho_k = \\frac{1 + \\sum_{j=1}^{k-1} \\prod_{l=1}^{j} \\gamma_l}{1 + \\sum_{j=1}^{N-1} \\prod_{l=1}^{j} \\gamma_l} $$\n其中 $\\gamma_l = T_l^- / T_l^+$。我们感兴趣的是初始只有一个突变体的情况，即 $k=1$，此时公式简化为：\n$$ \\rho_1 = \\frac{1}{1 + \\sum_{j=1}^{N-1} \\prod_{l=1}^{j} \\gamma_l} $$\n\n我们现在推导所讨论的图中 $\\gamma_i$ 的具体形式。\n\n**1. 完全图上的解析固着概率**\n\n在一个大小为 $N$ 的完全图中，每个顶点都与其他所有 $N-1$ 个顶点相连。假设有 $i$ 个适应度为 $r$ 的突变体和 $N-i$ 个适应度为 $1$ 的原住民。种群的总适应度为 $W = i \\cdot r + (N-i) \\cdot 1$。\n\n增加突变体数量的概率 $T_i^+$，对应于一个突变体繁殖且其后代替换一个原住民。\n- 一个突变体被选中繁殖的概率为 $\\frac{ir}{W}$。\n- 被选中的突变体有 $N-1$ 个邻居。其中，$N-i$ 个是原住民。\n- 一个特定的原住民邻居被选中替换的概率为 $\\frac{1}{N-1}$。选择任何一个原住民邻居的概率是 $\\frac{N-i}{N-1}$。\n因此，转移概率为：\n$$ T_i^+ = \\frac{i \\cdot r}{i \\cdot r + N - i} \\cdot \\frac{N-i}{N-1} $$\n\n减少突变体数量的概率 $T_i^-$，对应于一个原住民繁殖且其后代替换一个突变体。\n- 一个原住民被选中繁殖的概率为 $\\frac{N-i}{W}$。\n- 被选中的原住民有 $N-1$ 个邻居。其中，$i$ 个是突变体。\n- 一个特定的突变体邻居被选中替换的概率为 $\\frac{1}{N-1}$。选择任何一个突变体邻居的概率是 $\\frac{i}{N-1}$。\n因此，转移概率为：\n$$ T_i^- = \\frac{N-i}{i \\cdot r + N - i} \\cdot \\frac{i}{N-1} $$\n\n因此，比率 $\\gamma_i$ 为：\n$$ \\gamma_i = \\frac{T_i^-}{T_i^+} = \\frac{\\frac{(N-i)i}{(i \\cdot r + N - i)(N-1)}}{\\frac{ir(N-i)}{(i \\cdot r + N - i)(N-1)}} = \\frac{1}{r} $$\n这个比率是常数，与状态 $i$ 无关。将此代入 $\\rho_1$ 的公式中：\n$$ \\rho_1 = \\frac{1}{1 + \\sum_{j=1}^{N-1} \\prod_{l=1}^{j} (1/r)} = \\frac{1}{1 + \\sum_{j=1}^{N-1} (1/r)^j} $$\n这个和是一个几何级数。对于 $r \\neq 1$，我们有 $\\sum_{j=1}^{N-1} (1/r)^j = \\frac{1/r - (1/r)^N}{1-1/r}$。\n分母变为 $1 + \\frac{1/r - (1/r)^N}{1-1/r} = \\frac{1-1/r + 1/r - (1/r)^N}{1-1/r} = \\frac{1-r^{-N}}{1-r^{-1}}$。\n因此，固着概率为：\n$$ \\rho_1 = \\frac{1-1/r}{1-1/r^N} = \\frac{1-r^{-1}}{1-r^{-N}} $$\n对于中性适应度情况，即 $r=1$，比率 $\\gamma_i=1$。和变为 $\\sum_{j=1}^{N-1} 1 = N-1$。此时固着概率为：\n$$ \\rho_1 = \\frac{1}{1 + (N-1)} = \\frac{1}{N} $$\n这个结果也可以通过在 $r \\to 1$ 时对 $\\rho_1$ 的表达式应用洛必达法则得到。\n\n**2. 无向正则图（循环图）的论证**\n\n对于这种情况，问题引用了等温定理。循环图是一个度为 $k=2$ 的无向正则图。等温定理断言，对于任何等温图，包括所有顶点传递图，因此也包括所有正则图，在生灭更新规则下，单个突变体的固着概率与充分混合种群（例如，莫兰过程或完全图上的过程）的固着概率相同。\n\n这也可以直接证明。对于任何度为 $k$ 的无向正则图，设 $E_{MR}$ 是连接突变体顶点与原住民顶点的边的数量。\n转移概率 $T_i^+$ 是所有突变体 $u$ 繁殖并替换一个相邻原住民的概率之和。\n$ T_i^+ = \\sum_{u \\in M} \\frac{r}{W} \\frac{|\\text{Neighbors}(u) \\cap R|}{k} = \\frac{r}{Wk} \\sum_{u \\in M} |\\text{Neighbors}(u) \\cap R| = \\frac{r}{Wk} E_{MR} $\n类似地，转移概率 $T_i^-$ 是所有原住民 $v$ 繁殖并替换一个相邻突变体的概率之和。\n$ T_i^- = \\sum_{v \\in R} \\frac{1}{W} \\frac{|\\text{Neighbors}(v) \\cap M|}{k} = \\frac{1}{Wk} \\sum_{v \\in R} |\\text{Neighbors}(v) \\cap M| = \\frac{1}{Wk} E_{MR} $\n比率同样是 $\\gamma_i = T_i^-/T_i^+ = 1/r$。\n因此，完全相同的解析固着概率公式适用于循环图以及在生灭更新规则下的任何其他无向正则图。\n\n**3. 数值模拟**\n\n实现了一个蒙特卡洛模拟来验证解析结果。该模拟对所述的离散时间生灭莫兰过程进行建模：\n1. 在指定的图结构（完全图或循环图）上初始化种群，其中一个突变体被均匀随机地放置。\n2. 在每个时间步，根据适应度按比例选择一个个体进行繁殖。\n3. 从其邻居中均匀随机地选择一个被后代替换。\n4. 模拟一直运行，直到突变体类型固着（$i=N$）或灭绝（$i=0$）。\n5. 运行多次独立的模拟，固着概率被估计为最终固着的运行次数所占的比例。然后，将此估计值与推导出的解析公式在指定的容差范围内进行比较。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite for fixation probability simulations.\n    \"\"\"\n    # Use a fixed random seed for reproducibility.\n    # A single Generator instance is created and passed to simulation functions.\n    rng = np.random.default_rng(seed=42)\n\n    # Test suite as specified in the problem statement.\n    test_cases = [\n        # (graph_type, N, r, num_simulations, tolerance)\n        ('complete', 10, 2.0, 3000, 0.03),\n        ('complete', 10, 1.0, 3000, 0.03),\n        ('cycle', 20, 3.0, 3000, 0.03),\n        ('cycle', 5, 1.05, 3000, 0.03),\n        ('complete', 2, 5.0, 3000, 0.03),\n        ('cycle', 30, 0.5, 3000, 0.03),\n    ]\n\n    results = []\n    for graph_type, n, r, num_sims, tolerance in test_cases:\n        # Calculate analytical fixation probability\n        analytical_prob = analytical_fixation_probability(n, r)\n        \n        # Run Monte Carlo simulation\n        simulated_prob = run_simulation(n, r, graph_type, num_sims, rng)\n        \n        # Compare results and check if within tolerance\n        abs_diff = abs(simulated_prob - analytical_prob)\n        is_within_tolerance = abs_diff = tolerance\n        results.append(is_within_tolerance)\n\n    # Print results in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef analytical_fixation_probability(N, r):\n    \"\"\"\n    Calculates the analytical fixation probability for a single mutant.\n\n    The formula is the same for well-mixed populations, complete graphs,\n    and regular graphs under the specified Birth-Death Moran process.\n\n    Args:\n        N (int): Population size.\n        r (float): Fitness of the mutant (resident fitness is 1).\n\n    Returns:\n        float: The analytical fixation probability.\n    \"\"\"\n    if r == 1.0:\n        return 1.0 / N\n    # Using r_inv to avoid potential precision issues with large r**N\n    r_inv = 1.0 / r\n    return (1.0 - r_inv) / (1.0 - r_inv**N)\n\ndef build_graph(N, graph_type):\n    \"\"\"\n    Builds the adjacency list for the specified graph type.\n\n    Args:\n        N (int): Number of vertices.\n        graph_type (str): 'complete' or 'cycle'.\n\n    Returns:\n        dict: An adjacency list representation of the graph.\n    \"\"\"\n    adj = {}\n    if graph_type == 'complete':\n        for i in range(N):\n            adj[i] = [j for j in range(N) if i != j]\n    elif graph_type == 'cycle':\n        for i in range(N):\n            # Periodic boundary conditions for the cycle\n            adj[i] = [(i - 1 + N) % N, (i + 1) % N]\n    return adj\n\ndef simulate_one_run(N, r, graph, rng):\n    \"\"\"\n    Simulates one full run of the Birth-Death Moran process until absorption.\n\n    Args:\n        N (int): Population size.\n        r (float): Fitness of the mutant.\n        graph (dict): Adjacency list of the graph.\n        rng (numpy.random.Generator): The random number generator instance.\n\n    Returns:\n        int: 1 if the mutant fixates, 0 if it goes extinct.\n    \"\"\"\n    # Population state: 1 for mutant, 0 for resident\n    population = np.zeros(N, dtype=int)\n\n    # Initial condition: one mutant placed uniformly at random\n    initial_mutant_idx = rng.integers(0, N)\n    population[initial_mutant_idx] = 1\n\n    while True:\n        num_mutants = np.sum(population)\n        \n        # Check for absorbing states\n        if num_mutants == 0:\n            return 0  # Extinction\n        if num_mutants == N:\n            return 1  # Fixation\n\n        # 1. Choose individual for reproduction (proportional to fitness)\n        fitnesses = np.where(population == 1, r, 1.0)\n        total_fitness = np.sum(fitnesses)\n        reproduction_probs = fitnesses / total_fitness\n        reproducer_idx = rng.choice(N, p=reproduction_probs)\n        \n        # 2. Choose a neighbor for replacement (uniformly at random)\n        neighbors = graph[reproducer_idx]\n        if not neighbors: # Handles N=1 case or disconnected graphs\n            continue\n        neighbor_to_replace_idx = rng.choice(neighbors)\n        \n        # 3. Offspring replaces the neighbor\n        population[neighbor_to_replace_idx] = population[reproducer_idx]\n\ndef run_simulation(N, r, graph_type, num_sims, rng):\n    \"\"\"\n    Runs multiple Monte Carlo simulations to estimate fixation probability.\n\n    Args:\n        N (int): Population size.\n        r (float): Fitness of the mutant.\n        graph_type (str): 'complete' or 'cycle'.\n        num_sims (int): The number of independent simulations to run.\n        rng (numpy.random.Generator): The random number generator instance.\n\n    Returns:\n        float: The estimated fixation probability.\n    \"\"\"\n    if N == 1:\n        return 1.0\n\n    graph = build_graph(N, graph_type)\n    fixation_count = 0\n    for _ in range(num_sims):\n        fixation_count += simulate_one_run(N, r, graph, rng)\n    \n    return fixation_count / num_sims\n\n# Execute the main function to produce the final output.\nsolve()\n```"
        }
    ]
}