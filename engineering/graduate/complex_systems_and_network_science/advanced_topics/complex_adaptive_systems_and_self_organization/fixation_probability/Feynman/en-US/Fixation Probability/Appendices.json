{
    "hands_on_practices": [
        {
            "introduction": "The fixation probability of a mutant can be understood as an absorption probability in a finite-state Markov chain. This exercise guides you through the foundational method of first-step analysis, where you will derive and solve a system of linear equations to find the exact fixation probability for a simple birth-death process. Mastering this technique provides a concrete understanding of the mathematical underpinnings of evolutionary dynamics .",
            "id": "4277530",
            "problem": "Consider a well-mixed population of size $N=5$ with two types: a resident type and a mutant type. The population evolves as a time-homogeneous birth–death Markov chain on the state space $\\{0,1,2,3,4,5\\}$, where state $i$ denotes that there are $i$ mutants in the population. States $0$ and $5$ are absorbing, corresponding to extinction and fixation of the mutant type, respectively. For transient states $i \\in \\{1,2,3,4\\}$, the one-step transition probabilities are given by\n$$\n\\Pr(i \\to i+1)=p_i,\\quad \\Pr(i \\to i-1)=q_i,\\quad \\Pr(i \\to i)=r_i,\n$$\nwith $p_i+q_i+r_i=1$ for each $i$. The explicit values are:\n- For $i=1$: $p_1=\\frac{3}{10}$, $q_1=\\frac{1}{2}$, $r_1=\\frac{1}{5}$.\n- For $i=2$: $p_2=\\frac{2}{5}$, $q_2=\\frac{2}{5}$, $r_2=\\frac{1}{5}$.\n- For $i=3$: $p_3=\\frac{1}{2}$, $q_3=\\frac{3}{10}$, $r_3=\\frac{1}{5}$.\n- For $i=4$: $p_4=\\frac{3}{5}$, $q_4=\\frac{1}{5}$, $r_4=\\frac{1}{5}$.\n\nUsing only the foundational definition of absorption (fixation) probability for a time-homogeneous Markov chain and first-step (backward) conditioning, derive and solve the linear system that governs the absorption probabilities into state $5$. Let $u_i$ denote the probability that the chain is eventually absorbed at state $5$ starting from state $i$. Compute the fixation probability starting from a single mutant, i.e., $u_1$. Express your final answer as an exact value. Do not round.",
            "solution": "The problem asks for the fixation probability of a mutant type in a population of size $N=5$. The system is modeled as a time-homogeneous birth–death Markov chain on the state space $\\{0, 1, 2, 3, 4, 5\\}$, where the state $i$ represents the number of mutants. The states $0$ and $5$ are absorbing, corresponding to the extinction and fixation of the mutant, respectively.\n\nLet $u_i$ be the probability of eventual absorption into state $5$ (fixation), given that the process starts in state $i$. By definition, the boundary conditions for the absorbing states are:\n$$\nu_0 = 0 \\quad (\\text{extinction})\n$$\n$$\nu_5 = 1 \\quad (\\text{fixation})\n$$\n\nFor the transient states $i \\in \\{1, 2, 3, 4\\}$, we can establish a system of linear equations for the probabilities $u_i$ by using first-step (or backward) conditioning. This method relies on the law of total probability, conditioning on the outcome of the first step of the process. For any transient state $i$, the probability of eventual fixation $u_i$ is the sum of the probabilities of fixation from each possible next state, weighted by the transition probabilities from state $i$.\n\nThe general equation is:\n$$\nu_i = \\sum_{j=0}^{N} \\Pr(\\text{next state is } j | \\text{current state is } i) \\times u_j\n$$\nFor the given birth-death process, the possible transitions from a state $i \\in \\{1, 2, 3, 4\\}$ are to states $i+1$, $i-1$, or $i$. The equation thus becomes:\n$$\nu_i = p_i u_{i+1} + q_i u_{i-1} + r_i u_i\n$$\nwhere $p_i = \\Pr(i \\to i+1)$, $q_i = \\Pr(i \\to i-1)$, and $r_i = \\Pr(i \\to i)$.\n\nWe can simplify this equation by collecting the terms involving $u_i$:\n$$\n(1 - r_i)u_i = p_i u_{i+1} + q_i u_{i-1}\n$$\nSince $p_i + q_i + r_i = 1$, we have $1 - r_i = p_i + q_i$. Substituting this into the equation gives:\n$$\n(p_i + q_i)u_i = p_i u_{i+1} + q_i u_{i-1}\n$$\nThis equation relates the fixation probability at state $i$ to the probabilities at its neighboring states. We now apply this to each transient state using the provided transition probabilities.\n\nFor $i=1$:\nThe equation is $(p_1+q_1)u_1 = p_1 u_2 + q_1 u_0$.\nGiven $p_1 = \\frac{3}{10}$, $q_1 = \\frac{1}{2}$, and the boundary condition $u_0=0$:\n$$\n\\left(\\frac{3}{10} + \\frac{5}{10}\\right)u_1 = \\frac{3}{10} u_2 + \\frac{5}{10}(0) \\implies \\frac{8}{10}u_1 = \\frac{3}{10}u_2 \\implies 8u_1 = 3u_2\n$$\nThis gives our first equation: $8u_1 - 3u_2 = 0$.\n\nFor $i=2$:\nThe equation is $(p_2+q_2)u_2 = p_2 u_3 + q_2 u_1$.\nGiven $p_2 = \\frac{2}{5}$ and $q_2 = \\frac{2}{5}$:\n$$\n\\left(\\frac{2}{5} + \\frac{2}{5}\\right)u_2 = \\frac{2}{5} u_3 + \\frac{2}{5} u_1 \\implies \\frac{4}{5}u_2 = \\frac{2}{5}u_3 + \\frac{2}{5}u_1 \\implies 2u_2 = u_3 + u_1\n$$\nThis gives our second equation: $u_1 - 2u_2 + u_3 = 0$.\n\nFor $i=3$:\nThe equation is $(p_3+q_3)u_3 = p_3 u_4 + q_3 u_2$.\nGiven $p_3 = \\frac{1}{2}$ and $q_3 = \\frac{3}{10}$:\n$$\n\\left(\\frac{5}{10} + \\frac{3}{10}\\right)u_3 = \\frac{5}{10} u_4 + \\frac{3}{10} u_2 \\implies \\frac{8}{10}u_3 = \\frac{5}{10}u_4 + \\frac{3}{10}u_2 \\implies 8u_3 = 5u_4 + 3u_2\n$$\nThis gives our third equation: $3u_2 - 8u_3 + 5u_4 = 0$.\n\nFor $i=4$:\nThe equation is $(p_4+q_4)u_4 = p_4 u_5 + q_4 u_3$.\nGiven $p_4 = \\frac{3}{5}$, $q_4 = \\frac{1}{5}$, and the boundary condition $u_5=1$:\n$$\n\\left(\\frac{3}{5} + \\frac{1}{5}\\right)u_4 = \\frac{3}{5}(1) + \\frac{1}{5}u_3 \\implies \\frac{4}{5}u_4 = \\frac{3}{5} + \\frac{1}{5}u_3 \\implies 4u_4 = 3 + u_3\n$$\nThis gives our fourth equation: $u_3 - 4u_4 = -3$.\n\nWe have now derived the following system of four linear equations for the four unknown probabilities $u_1, u_2, u_3, u_4$:\n1.  $8u_1 - 3u_2 = 0$\n2.  $u_1 - 2u_2 + u_3 = 0$\n3.  $3u_2 - 8u_3 + 5u_4 = 0$\n4.  $u_3 - 4u_4 = -3$\n\nWe solve this system to find $u_1$. We use substitution.\nFrom equation (1), we express $u_2$ in terms of $u_1$:\n$$\nu_2 = \\frac{8}{3}u_1\n$$\nSubstitute this into equation (2) to find $u_3$ in terms of $u_1$:\n$$\nu_1 - 2\\left(\\frac{8}{3}u_1\\right) + u_3 = 0 \\implies u_1 - \\frac{16}{3}u_1 + u_3 = 0 \\implies -\\frac{13}{3}u_1 + u_3 = 0 \\implies u_3 = \\frac{13}{3}u_1\n$$\nFrom equation (4), we express $u_4$ in terms of $u_3$, and then in terms of $u_1$:\n$$\n4u_4 = u_3 + 3 \\implies u_4 = \\frac{1}{4}(u_3 + 3) = \\frac{1}{4}\\left(\\frac{13}{3}u_1 + 3\\right) = \\frac{13}{12}u_1 + \\frac{3}{4}\n$$\nNow, substitute the expressions for $u_2, u_3, u_4$ all in terms of $u_1$ into the final remaining equation (3):\n$$\n3\\left(\\frac{8}{3}u_1\\right) - 8\\left(\\frac{13}{3}u_1\\right) + 5\\left(\\frac{13}{12}u_1 + \\frac{3}{4}\\right) = 0\n$$\nSimplify the equation:\n$$\n8u_1 - \\frac{104}{3}u_1 + \\frac{65}{12}u_1 + \\frac{15}{4} = 0\n$$\nTo eliminate the denominators, we multiply the entire equation by the least common multiple of $3$, $12$, and $4$, which is $12$:\n$$\n12(8u_1) - 4(104u_1) + 1(65u_1) + 3(15) = 0\n$$\n$$\n96u_1 - 416u_1 + 65u_1 + 45 = 0\n$$\nCombine the terms with $u_1$:\n$$\n(96 - 416 + 65)u_1 + 45 = 0\n$$\n$$\n(161 - 416)u_1 + 45 = 0\n$$\n$$\n-255u_1 + 45 = 0\n$$\nFinally, we solve for $u_1$:\n$$\n255u_1 = 45 \\implies u_1 = \\frac{45}{255}\n$$\nTo simplify the fraction, we can divide the numerator and denominator by their greatest common divisor. Both are divisible by $5$:\n$$\nu_1 = \\frac{45 \\div 5}{255 \\div 5} = \\frac{9}{51}\n$$\nBoth are now divisible by $3$:\n$$\nu_1 = \\frac{9 \\div 3}{51 \\div 3} = \\frac{3}{17}\n$$\nThe fixation probability starting from a single mutant is $u_1 = \\frac{3}{17}$.",
            "answer": "$$\n\\boxed{\\frac{3}{17}}\n$$"
        },
        {
            "introduction": "In contrast to well-mixed populations, the structure of interactions can profoundly influence evolutionary outcomes. This practice explores this principle on a star graph, a simple yet highly heterogeneous network, by comparing two different microscopic update rules. By calculating fixation probabilities from first principles, you will see firsthand how network topology and the choice of update mechanism (Birth-Death vs. Death-Birth) create different selective pressures .",
            "id": "4277558",
            "problem": "Consider a star graph with $N=3$ nodes, consisting of a single hub connected to $L=2$ leaves. An evolutionary process proceeds according to the Moran process on graphs with two types: a mutant type of fitness $r0$ and a resident type of fitness $1$. Two stochastic update mechanisms are considered:\n\n- Birth–Death (BD) rule: at each step, one node is selected to reproduce with probability proportional to its fitness, and one of its neighbors is selected uniformly at random to be replaced by the offspring.\n\n- Death–Birth (DB) rule: at each step, one node is selected uniformly at random to die, and one of its neighbors is selected to reproduce with probability proportional to its fitness to fill the vacancy.\n\nLet the state of the system be denoted by $(h,k)$, where $h\\in\\{0,1\\}$ indicates whether the hub is mutant ($h=1$) or resident ($h=0$), and $k\\in\\{0,1,2\\}$ is the number of mutant leaves. The absorbing states are $(1,2)$ (fixation of mutants) and $(0,0)$ (extinction of mutants).\n\nAssume the initial population has exactly two mutants in one of the following configurations:\n\n- Configuration A: one mutant at the hub and one mutant at a leaf, i.e., state $(1,1)$.\n\n- Configuration B: two mutant leaves and a resident hub, i.e., state $(0,2)$.\n\nStarting from first principles (the definitions above), derive the exact fixation probabilities under both the Birth–Death (BD) rule and the Death–Birth (DB) rule for Configuration A and Configuration B. Express your final answers as closed-form functions of $r$. Provide the four fixation probabilities in the following order: BD with Configuration A, BD with Configuration B, DB with Configuration A, DB with Configuration B. The final answer must be a single analytical expression. No rounding is required.",
            "solution": "The problem asks for the fixation probabilities of a mutant type on a star graph with $N=3$ nodes under two different evolutionary update rules. The graph consists of one central hub and $L=2$ leaves. Let the hub be node $0$, and the leaves be nodes $1$ and $2$. The fitness of the mutant type is $r  0$, and the fitness of the resident type is $1$.\n\nThe state of the system is given by $(h, k)$, where $h \\in \\{0, 1\\}$ is the type of the hub ($1$ for mutant, $0$ for resident) and $k \\in \\{0, 1, 2\\}$ is the number of mutant leaves. The absorbing states are $(0,0)$ (extinction) and $(1,2)$ (fixation). The transient states are $(0,1)$, $(0,2)$, $(1,0)$, and $(1,1)$.\n\nLet $\\rho_{h,k}$ be the probability of eventual fixation starting from state $(h,k)$. By definition, $\\rho_{0,0} = 0$ and $\\rho_{1,2} = 1$. For any transient state $i$, the fixation probability $\\rho_i$ satisfies the relation $\\rho_i = \\sum_j P_{ij} \\rho_j$, where $P_{ij}$ is the one-step transition probability from state $i$ to state $j$, and the sum is over all possible next states. This leads to a system of linear equations for the fixation probabilities of the transient states.\n\nWe need to find the fixation probabilities for two initial configurations:\nConfiguration A: state $(1,1)$, giving $\\rho_A = \\rho_{1,1}$.\nConfiguration B: state $(0,2)$, giving $\\rho_B = \\rho_{0,2}$.\n\nWe will analyze the two update rules separately.\n\n### Birth–Death (BD) Rule\nUnder the BD rule, a node is chosen to reproduce with probability proportional to its fitness. The total fitness of the population in a given state is $W$. An individual at node $i$ with fitness $f_i$ is chosen with probability $f_i / W$. Its offspring replaces a uniformly chosen random neighbor.\n\nThe transient states are $(0,1)$, $(0,2)$, $(1,0)$, and $(1,1)$.\nThe total fitness $W$ for each state is:\n- State $(0,1)$: One mutant leaf ($r$), one resident leaf ($1$), one resident hub ($1$). $W = r+1+1 = r+2$.\n- State $(0,2)$: Two mutant leaves ($r$ each), one resident hub ($1$). $W = 2r+1$.\n- State $(1,0)$: One mutant hub ($r$), two resident leaves ($1$ each). $W = r+1+1 = r+2$.\n- State $(1,1)$: One mutant hub ($r$), one mutant leaf ($r$), one resident leaf ($1$). $W = 2r+1$.\n\nLet's derive the transition probabilities and the corresponding equations for the fixation probabilities $\\rho_{h,k}$.\n\nFrom state $(0,1)$: $W = r+2$.\n- The mutant leaf reproduces (prob $r/W$). Its neighbor is the hub, which is replaced. State $\\to (1,1)$. $P_{(0,1)\\to(1,1)} = \\frac{r}{r+2}$.\n- The resident hub reproduces (prob $1/W$). It replaces one of its two neighbors (the leaves) with probability $1/2$. If it replaces the mutant leaf, the system goes to extinction. State $\\to (0,0)$. $P_{(0,1)\\to(0,0)} = \\frac{1}{W} \\cdot \\frac{1}{2} = \\frac{1}{2(r+2)}$.\nThe equation for $\\rho_{0,1}$ is $\\rho_{0,1} = P_{(0,1)\\to(1,1)}\\rho_{1,1} + P_{(0,1)\\to(0,0)}\\rho_{0,0} + \\dots$.\nConsidering only transitions that change the state and lead to non-zero fixation probability term:\n$(1 - P_{(0,1)\\to(0,1)})\\rho_{0,1} = P_{(0,1)\\to(1,1)}\\rho_{1,1} + P_{(0,1)\\to(0,0)}\\rho_{0,0}$.\n$(\\frac{r}{r+2} + \\frac{1}{2(r+2)}) \\rho_{0,1} = \\frac{r}{r+2}\\rho_{1,1}$.\n$\\frac{2r+1}{2(r+2)} \\rho_{0,1} = \\frac{2r}{2(r+2)}\\rho_{1,1} \\implies (2r+1)\\rho_{0,1} = 2r\\rho_{1,1}$.\n(1) $\\rho_{0,1} = \\frac{2r}{2r+1}\\rho_{1,1}$.\n\nFrom state $(1,1)$: $W = 2r+1$.\n- The mutant hub reproduces (prob $r/W$). It replaces a neighbor (prob $1/2$ for each). If it replaces the resident leaf, the system fixates. State $\\to (1,2)$. $P_{(1,1)\\to(1,2)} = \\frac{r}{W} \\cdot \\frac{1}{2} = \\frac{r}{2(2r+1)}$.\n- The resident leaf reproduces (prob $1/W$). It replaces its neighbor, the hub. State $\\to (0,1)$. $P_{(1,1)\\to(0,1)} = \\frac{1}{W} = \\frac{1}{2r+1}$.\nThe equation is $(1-P_{(1,1)\\to(1,1)})\\rho_{1,1} = P_{(1,1)\\to(1,2)}\\rho_{1,2} + P_{(1,1)\\to(0,1)}\\rho_{0,1}$.\n$(\\frac{r}{2(2r+1)} + \\frac{1}{2r+1}) \\rho_{1,1} = \\frac{r}{2(2r+1)}(1) + \\frac{1}{2r+1}\\rho_{0,1}$.\n$\\frac{r+2}{2(2r+1)}\\rho_{1,1} = \\frac{r}{2(2r+1)} + \\frac{2}{2(2r+1)}\\rho_{0,1}$.\n(2) $(r+2)\\rho_{1,1} = r + 2\\rho_{0,1}$.\n\nNow we solve for $\\rho_{1,1}$ (Configuration A) by substituting (1) into (2):\n$(r+2)\\rho_{1,1} = r + 2\\left(\\frac{2r}{2r+1}\\rho_{1,1}\\right) = r + \\frac{4r}{2r+1}\\rho_{1,1}$.\n$\\rho_{1,1} \\left(r+2 - \\frac{4r}{2r+1}\\right) = r$.\n$\\rho_{1,1} \\left(\\frac{(r+2)(2r+1)-4r}{2r+1}\\right) = r$.\n$\\rho_{1,1} \\left(\\frac{2r^2+r+4r+2-4r}{2r+1}\\right) = r$.\n$\\rho_{1,1} \\left(\\frac{2r^2+r+2}{2r+1}\\right) = r$.\n$\\rho_{A, BD} = \\rho_{1,1} = \\frac{r(2r+1)}{2r^2+r+2}$.\n\nTo find $\\rho_{0,2}$ (Configuration B), we need its transition probabilities.\nFrom state $(0,2)$: $W = 2r+1$.\n- A mutant leaf reproduces (prob $2r/W$). Replaces the hub. State $\\to (1,2)$ (fixation). $P_{(0,2)\\to(1,2)} = \\frac{2r}{2r+1}$.\n- The resident hub reproduces (prob $1/W$). Replaces a mutant leaf. State $\\to (0,1)$. $P_{(0,2)\\to(0,1)} = \\frac{1}{2r+1}$.\nThe equation for $\\rho_{0,2}$ is $\\rho_{0,2} = P_{(0,2)\\to(1,2)}\\rho_{1,2} + P_{(0,2)\\to(0,1)}\\rho_{0,1}$.\n(3) $\\rho_{0,2} = \\frac{2r}{2r+1}(1) + \\frac{1}{2r+1}\\rho_{0,1}$.\nUsing (1) and the expression for $\\rho_{1,1}$:\n$\\rho_{0,1} = \\frac{2r}{2r+1} \\left(\\frac{r(2r+1)}{2r^2+r+2}\\right) = \\frac{2r^2}{2r^2+r+2}$.\nSubstitute this into (3):\n$\\rho_{B, BD} = \\rho_{0,2} = \\frac{2r}{2r+1} + \\frac{1}{2r+1}\\left(\\frac{2r^2}{2r^2+r+2}\\right) = \\frac{2r(2r^2+r+2) + 2r^2}{(2r+1)(2r^2+r+2)}$.\n$\\rho_{B, BD} = \\frac{4r^3+2r^2+4r+2r^2}{(2r+1)(2r^2+r+2)} = \\frac{4r^3+4r^2+4r}{(2r+1)(2r^2+r+2)} = \\frac{4r(r^2+r+1)}{(2r+1)(2r^2+r+2)}$.\n\n### Death–Birth (DB) Rule\nUnder the DB rule, a node is chosen uniformly at random to die (prob $1/N = 1/3$). Its neighbors then compete to reproduce, with probability proportional to their fitness, to fill the vacancy.\n\nFrom state $(0,1)$: one mutant leaf, one resident leaf, one resident hub.\n- Hub dies (prob $1/3$). Neighbors (mutant leaf, resident leaf) compete. Fitness sum is $r+1$. Mutant reproduces with prob $r/(r+1)$. State $\\to (1,1)$. $P_{(0,1)\\to(1,1)} = \\frac{1}{3}\\frac{r}{r+1}$.\n- Mutant leaf dies (prob $1/3$). Its neighbor (resident hub) reproduces. State $\\to (0,0)$. $P_{(0,1)\\to(0,0)} = \\frac{1}{3}$.\nThe equation from these transitions is $(1-P_{(0,1)\\to(0,1)})\\rho_{0,1} = P_{(0,1)\\to(1,1)}\\rho_{1,1} + P_{(0,1)\\to(0,0)}\\rho_{0,0}$.\n$(\\frac{1}{3}\\frac{r}{r+1} + \\frac{1}{3})\\rho_{0,1} = \\frac{1}{3}\\frac{r}{r+1}\\rho_{1,1}$.\n$\\frac{r+r+1}{3(r+1)}\\rho_{0,1} = \\frac{r}{3(r+1)}\\rho_{1,1} \\implies (2r+1)\\rho_{0,1} = r\\rho_{1,1}$.\n(4) $\\rho_{0,1} = \\frac{r}{2r+1}\\rho_{1,1}$.\n\nFrom state $(1,1)$: mutant hub, one mutant leaf, one resident leaf.\n- Hub dies (prob $1/3$). Neighbors (mutant leaf, resident leaf) compete. Fitness sum $r+1$. Resident reproduces with prob $1/(r+1)$. State $\\to (0,1)$. $P_{(1,1)\\to(0,1)} = \\frac{1}{3}\\frac{1}{r+1}$.\n- Resident leaf dies (prob $1/3$). Its neighbor (mutant hub) reproduces. State $\\to (1,2)$. $P_{(1,1)\\to(1,2)} = \\frac{1}{3}$.\nThe equation is $(1-P_{(1,1)\\to(1,1)})\\rho_{1,1} = P_{(1,1)\\to(1,2)}\\rho_{1,2} + P_{(1,1)\\to(0,1)}\\rho_{0,1}$.\n$(\\frac{1}{3}\\frac{1}{r+1} + \\frac{1}{3}) \\rho_{1,1} = \\frac{1}{3}(1) + \\frac{1}{3(r+1)}\\rho_{0,1}$.\n$\\frac{1+r+1}{3(r+1)}\\rho_{1,1} = \\frac{r+1}{3(r+1)} + \\frac{1}{3(r+1)}\\rho_{0,1}$.\n(5) $(r+2)\\rho_{1,1} = r+1 + \\rho_{0,1}$.\n\nSolve for $\\rho_{1,1}$ (Configuration A) by substituting (4) into (5):\n$(r+2)\\rho_{1,1} = r+1 + \\frac{r}{2r+1}\\rho_{1,1}$.\n$\\rho_{1,1}\\left(r+2 - \\frac{r}{2r+1}\\right) = r+1$.\n$\\rho_{1,1}\\left(\\frac{(r+2)(2r+1)-r}{2r+1}\\right) = r+1$.\n$\\rho_{1,1}\\left(\\frac{2r^2+5r+2-r}{2r+1}\\right) = r+1$.\n$\\rho_{1,1}\\left(\\frac{2r^2+4r+2}{2r+1}\\right) = r+1$.\n$\\rho_{1,1}\\left(\\frac{2(r+1)^2}{2r+1}\\right) = r+1$.\n$\\rho_{A, DB} = \\rho_{1,1} = \\frac{(r+1)(2r+1)}{2(r+1)^2} = \\frac{2r+1}{2(r+1)}$.\n\nTo find $\\rho_{0,2}$ (Configuration B), we analyze its transitions.\nFrom state $(0,2)$: two mutant leaves, one resident hub.\n- Hub dies (prob $1/3$). Neighbors are two mutant leaves. A mutant reproduces. State $\\to (1,2)$ (fixation). $P_{(0,2)\\to(1,2)} = \\frac{1}{3}$.\n- A mutant leaf dies (prob $2/3$). Neighbor is resident hub, which reproduces. State $\\to (0,1)$. $P_{(0,2)\\to(0,1)} = \\frac{2}{3}$.\nThe equation is $\\rho_{0,2} = P_{(0,2)\\to(1,2)}\\rho_{1,2} + P_{(0,2)\\to(0,1)}\\rho_{0,1}$.\n(6) $\\rho_{0,2} = \\frac{1}{3}(1) + \\frac{2}{3}\\rho_{0,1}$.\nUsing (4) and the expression for $\\rho_{1,1}$:\n$\\rho_{0,1} = \\frac{r}{2r+1}\\left(\\frac{2r+1}{2(r+1)}\\right) = \\frac{r}{2(r+1)}$.\nSubstitute this into (6):\n$\\rho_{B, DB} = \\rho_{0,2} = \\frac{1}{3} + \\frac{2}{3}\\left(\\frac{r}{2(r+1)}\\right) = \\frac{1}{3} + \\frac{r}{3(r+1)} = \\frac{r+1+r}{3(r+1)} = \\frac{2r+1}{3(r+1)}$.\n\nThe four fixation probabilities are:\n1. BD, Config A ($\\rho_{1,1}$): $\\frac{r(2r+1)}{2r^2+r+2}$\n2. BD, Config B ($\\rho_{0,2}$): $\\frac{4r(r^2+r+1)}{(2r+1)(2r^2+r+2)}$\n3. DB, Config A ($\\rho_{1,1}$): $\\frac{2r+1}{2(r+1)}$\n4. DB, Config B ($\\rho_{0,2}$): $\\frac{2r+1}{3(r+1)}$",
            "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{r(2r+1)}{2r^2+r+2}  \\frac{4r(r^2+r+1)}{(2r+1)(2r^2+r+2)}  \\frac{2r+1}{2(r+1)}  \\frac{2r+1}{3(r+1)} \\end{pmatrix} } $$"
        },
        {
            "introduction": "While exact analytical solutions are powerful, they are often limited to specific models; computational methods are essential for exploring more complex scenarios. This practice challenges you to build a Monte Carlo simulation of the Birth-Death Moran process, a cornerstone technique in computational evolutionary biology. You will use your simulation to numerically validate the celebrated analytical formula for fixation probability on complete and regular graphs, thereby reinforcing the theoretical concept of the isothermal theorem .",
            "id": "4277528",
            "problem": "A population of size $N$ occupies the vertices of a graph. Each vertex hosts exactly one individual, which is either a resident of baseline fitness $1$ or a mutant of fitness $r \\in \\mathbb{R}_{0}$. The population evolves according to the Birth-Death Moran process on graphs: at each discrete time step, one vertex is chosen for reproduction with probability proportional to its fitness; then one of its neighbors is chosen uniformly at random and is replaced by the offspring of the reproducing individual (i.e., the neighbor takes the type of the reproducer). The process continues until it reaches one of two absorbing states: all mutants (fixation) or no mutants (extinction). At time $t=0$, a single mutant is placed uniformly at random on the graph.\n\nThe fixation probability of a single mutant is defined as the probability that the process eventually reaches the all-mutant absorbing state. For a complete graph on $N$ vertices, the process is well-mixed in the sense that all ordered pairs of distinct vertices are connected. For an undirected regular graph (every vertex has the same degree), which is a special case of an isothermal graph, the isothermal theorem applies under Birth-Death updating.\n\nStarting from the fundamental definitions of the Birth-Death Moran process and standard Markov chain absorption, derive the analytical fixation probability for a single mutant on a complete graph of size $N$ under Birth-Death updating. Then, using the isothermal theorem for undirected regular graphs under Birth-Death updating, justify the analytical fixation probability for such graphs. Implement a numerical method that estimates the fixation probability via Monte Carlo simulation of the stochastic process on:\n- a complete graph on $N$ vertices,\n- a cycle (ring) graph on $N$ vertices, which is an undirected regular graph of degree $2$.\n\nYour program must:\n- implement the simulation of the Birth-Death Moran process as specified above,\n- compute the analytical fixation probability for complete graphs from first principles,\n- use the isothermal theorem justification to adopt the same analytical fixation probability for the cycle graph under Birth-Death updating,\n- compare the simulated fixation probability to the analytical expression,\n- produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is a boolean indicating whether the absolute difference between the simulated and analytical fixation probabilities is at most a specified tolerance.\n\nUse a fixed random seed of $42$ for reproducibility. Do not accept any user input; all parameters must be hard-coded.\n\nTest suite:\n- Case 1: complete graph, $N=10$, $r=2.0$, number of independent simulations $3000$, tolerance $0.03$.\n- Case 2: complete graph, $N=10$, $r=1.0$, number of independent simulations $3000$, tolerance $0.03$.\n- Case 3: cycle graph, $N=20$, $r=3.0$, number of independent simulations $3000$, tolerance $0.03$.\n- Case 4: cycle graph, $N=5$, $r=1.05$, number of independent simulations $3000$, tolerance $0.03$.\n- Case 5: complete graph, $N=2$, $r=5.0$, number of independent simulations $3000$, tolerance $0.03$.\n- Case 6: cycle graph, $N=30$, $r=0.5$, number of independent simulations $3000$, tolerance $0.03$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $\\texttt{[result1,result2,\\dots]}$). Each result must be a boolean.",
            "solution": "The problem requires the derivation of the analytical fixation probability for a single mutant under a Birth-Death Moran process on complete and regular graphs, followed by a numerical verification using Monte Carlo simulations. The validation of the problem statement confirms that it is scientifically grounded, well-posed, and contains sufficient information for a rigorous solution.\n\nThe state of the system is defined by the number of mutants, $i \\in \\{0, 1, \\dots, N\\}$. The states $i=0$ (extinction) and $i=N$ (fixation) are absorbing. For any transient state $i \\in \\{1, \\dots, N-1\\}$, the number of mutants can either increase by one, with transition probability $T_i^+$, or decrease by one, with transition probability $T_i^-$. The process is thus a one-dimensional random walk on the integers $\\{0, \\dots, N\\}$.\n\nLet $\\rho_i$ denote the probability of fixation starting with $i$ mutants. The boundary conditions are $\\rho_0=0$ and $\\rho_N=1$. The fixation probability $\\rho_i$ satisfies the recurrence relation $\\rho_i = p_{i,i+1}\\rho_{i+1} + p_{i,i-1}\\rho_{i-1}$, where $p_{i,i+1} = T_i^+ / (T_i^+ + T_i^-)$ and $p_{i,i-1} = T_i^- / (T_i^+ + T_i^-)$. The general solution for the fixation probability starting with $k$ individuals is given by:\n$$ \\rho_k = \\frac{1 + \\sum_{j=1}^{k-1} \\prod_{l=1}^{j} \\gamma_l}{1 + \\sum_{j=1}^{N-1} \\prod_{l=1}^{j} \\gamma_l} $$\nwhere $\\gamma_l = T_l^- / T_l^+$. We are interested in the case of a single initial mutant, $k=1$, for which the formula simplifies to:\n$$ \\rho_1 = \\frac{1}{1 + \\sum_{j=1}^{N-1} \\prod_{l=1}^{j} \\gamma_l} $$\n\nWe now derive the specific form of $\\gamma_i$ for the graphs in question.\n\n**1. Analytical Fixation Probability on a Complete Graph**\n\nIn a complete graph of size $N$, every vertex is connected to every other $N-1$ vertices. Let there be $i$ mutants of fitness $r$ and $N-i$ residents of fitness $1$. The total fitness of the population is $W = i \\cdot r + (N-i) \\cdot 1$.\n\nThe probability of increasing the number of mutants, $T_i^+$, corresponds to a mutant reproducing and its offspring replacing a resident.\n- A mutant is chosen for reproduction with probability $\\frac{ir}{W}$.\n- The chosen mutant has $N-1$ neighbors. Among these, $N-i$ are residents.\n- A specific resident neighbor is chosen for replacement with probability $\\frac{1}{N-1}$. The probability of choosing any resident neighbor is $\\frac{N-i}{N-1}$.\nThus, the transition probability is:\n$$ T_i^+ = \\frac{i \\cdot r}{i \\cdot r + N - i} \\cdot \\frac{N-i}{N-1} $$\n\nThe probability of decreasing the number of mutants, $T_i^-$, corresponds to a resident reproducing and its offspring replacing a mutant.\n- A resident is chosen for reproduction with probability $\\frac{N-i}{W}$.\n- The chosen resident has $N-1$ neighbors. Among these, $i$ are mutants.\n- A specific mutant neighbor is chosen for replacement with probability $\\frac{1}{N-1}$. The probability of choosing any mutant neighbor is $\\frac{i}{N-1}$.\nThus, the transition probability is:\n$$ T_i^- = \\frac{N-i}{i \\cdot r + N - i} \\cdot \\frac{i}{N-1} $$\n\nThe ratio $\\gamma_i$ is therefore:\n$$ \\gamma_i = \\frac{T_i^-}{T_i^+} = \\frac{\\frac{(N-i)i}{(i \\cdot r + N - i)(N-1)}}{\\frac{ir(N-i)}{(i \\cdot r + N - i)(N-1)}} = \\frac{1}{r} $$\nThis ratio is constant and independent of the state $i$. Substituting this into the formula for $\\rho_1$:\n$$ \\rho_1 = \\frac{1}{1 + \\sum_{j=1}^{N-1} \\prod_{l=1}^{j} (1/r)} = \\frac{1}{1 + \\sum_{j=1}^{N-1} (1/r)^j} $$\nThe sum is a geometric series. For $r \\neq 1$, we have $\\sum_{j=1}^{N-1} (1/r)^j = \\frac{1/r - (1/r)^N}{1-1/r}$.\nThe denominator becomes $1 + \\frac{1/r - (1/r)^N}{1-1/r} = \\frac{1-1/r + 1/r - (1/r)^N}{1-1/r} = \\frac{1-r^{-N}}{1-r^{-1}}$.\nTherefore, the fixation probability is:\n$$ \\rho_1 = \\frac{1-1/r}{1-1/r^N} = \\frac{1-r^{-1}}{1-r^{-N}} $$\nFor the neutral fitness case, $r=1$, the ratio $\\gamma_i=1$. The sum becomes $\\sum_{j=1}^{N-1} 1 = N-1$. The fixation probability is then:\n$$ \\rho_1 = \\frac{1}{1 + (N-1)} = \\frac{1}{N} $$\nThis result can also be obtained by applying L'Hôpital's rule to the expression for $\\rho_1$ as $r \\to 1$.\n\n**2. Justification for Undirected Regular Graphs (Cycle Graph)**\n\nThe problem invokes the isothermal theorem for this case. A cycle graph is an undirected regular graph of degree $k=2$. The isothermal theorem asserts that for any isothermal graph, which includes all vertex-transitive graphs and thus all regular graphs, the fixation probability of a single mutant under Birth-Death updating is identical to that of a well-mixed population (e.g., the Moran process or the process on a complete graph).\n\nThis can also be demonstrated directly. For any undirected regular graph of degree $k$, let $E_{MR}$ be the number of edges connecting mutant vertices to resident vertices.\nThe transition probability $T_i^+$ is the sum over all mutants $u$ of the probability of $u$ reproducing and replacing a neighboring resident.\n$ T_i^+ = \\sum_{u \\in M} \\frac{r}{W} \\frac{|\\text{Neighbors}(u) \\cap R|}{k} = \\frac{r}{Wk} \\sum_{u \\in M} |\\text{Neighbors}(u) \\cap R| = \\frac{r}{Wk} E_{MR} $\nSimilarly, the transition probability $T_i^-$ is the sum over all residents $v$ of the probability of $v$ reproducing and replacing a neighboring mutant.\n$ T_i^- = \\sum_{v \\in R} \\frac{1}{W} \\frac{|\\text{Neighbors}(v) \\cap M|}{k} = \\frac{1}{Wk} \\sum_{v \\in R} |\\text{Neighbors}(v) \\cap M| = \\frac{1}{Wk} E_{MR} $\nThe ratio is again $\\gamma_i = T_i^-/T_i^+ = 1/r$.\nTherefore, the exact same analytical formula for fixation probability applies to the cycle graph and any other undirected regular graph under Birth-Death updating.\n\n**3. Numerical Simulation**\n\nA Monte Carlo simulation is implemented to verify the analytical results. The simulation models the discrete-time Birth-Death Moran process as described:\n1. The population is initialized on a specified graph structure (complete or cycle) with a single mutant at a uniformly random position.\n2. At each time step, an individual is chosen to reproduce with probability proportional to its fitness.\n3. One of its neighbors is chosen uniformly at random to be replaced by the offspring.\n4. The simulation runs until either the mutant type fixates ($i=N$) or goes extinct ($i=0$).\n5. Many independent simulations are run, and the fixation probability is estimated as the fraction of runs that ended in fixation. This estimate is then compared against the derived analytical formula within a specified tolerance.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite for fixation probability simulations.\n    \"\"\"\n    # Use a fixed random seed for reproducibility.\n    # A single Generator instance is created and passed to simulation functions.\n    rng = np.random.default_rng(seed=42)\n\n    # Test suite as specified in the problem statement.\n    test_cases = [\n        # (graph_type, N, r, num_simulations, tolerance)\n        ('complete', 10, 2.0, 3000, 0.03),\n        ('complete', 10, 1.0, 3000, 0.03),\n        ('cycle', 20, 3.0, 3000, 0.03),\n        ('cycle', 5, 1.05, 3000, 0.03),\n        ('complete', 2, 5.0, 3000, 0.03),\n        ('cycle', 30, 0.5, 3000, 0.03),\n    ]\n\n    results = []\n    for graph_type, n, r, num_sims, tolerance in test_cases:\n        # Calculate analytical fixation probability\n        analytical_prob = analytical_fixation_probability(n, r)\n        \n        # Run Monte Carlo simulation\n        simulated_prob = run_simulation(n, r, graph_type, num_sims, rng)\n        \n        # Compare results and check if within tolerance\n        abs_diff = abs(simulated_prob - analytical_prob)\n        is_within_tolerance = abs_diff = tolerance\n        results.append(is_within_tolerance)\n\n    # Print results in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef analytical_fixation_probability(N, r):\n    \"\"\"\n    Calculates the analytical fixation probability for a single mutant.\n\n    The formula is the same for well-mixed populations, complete graphs,\n    and regular graphs under the specified Birth-Death Moran process.\n\n    Args:\n        N (int): Population size.\n        r (float): Fitness of the mutant (resident fitness is 1).\n\n    Returns:\n        float: The analytical fixation probability.\n    \"\"\"\n    if r == 1.0:\n        return 1.0 / N\n    # Using r_inv to avoid potential precision issues with large r**N\n    r_inv = 1.0 / r\n    return (1.0 - r_inv) / (1.0 - r_inv**N)\n\ndef build_graph(N, graph_type):\n    \"\"\"\n    Builds the adjacency list for the specified graph type.\n\n    Args:\n        N (int): Number of vertices.\n        graph_type (str): 'complete' or 'cycle'.\n\n    Returns:\n        dict: An adjacency list representation of the graph.\n    \"\"\"\n    adj = {}\n    if graph_type == 'complete':\n        for i in range(N):\n            adj[i] = [j for j in range(N) if i != j]\n    elif graph_type == 'cycle':\n        for i in range(N):\n            # Periodic boundary conditions for the cycle\n            adj[i] = [(i - 1 + N) % N, (i + 1) % N]\n    return adj\n\ndef simulate_one_run(N, r, graph, rng):\n    \"\"\"\n    Simulates one full run of the Birth-Death Moran process until absorption.\n\n    Args:\n        N (int): Population size.\n        r (float): Fitness of the mutant.\n        graph (dict): Adjacency list of the graph.\n        rng (numpy.random.Generator): The random number generator instance.\n\n    Returns:\n        int: 1 if the mutant fixates, 0 if it goes extinct.\n    \"\"\"\n    # Population state: 1 for mutant, 0 for resident\n    population = np.zeros(N, dtype=int)\n\n    # Initial condition: one mutant placed uniformly at random\n    initial_mutant_idx = rng.integers(0, N)\n    population[initial_mutant_idx] = 1\n\n    while True:\n        num_mutants = np.sum(population)\n        \n        # Check for absorbing states\n        if num_mutants == 0:\n            return 0  # Extinction\n        if num_mutants == N:\n            return 1  # Fixation\n\n        # 1. Choose individual for reproduction (proportional to fitness)\n        fitnesses = np.where(population == 1, r, 1.0)\n        total_fitness = np.sum(fitnesses)\n        reproduction_probs = fitnesses / total_fitness\n        reproducer_idx = rng.choice(N, p=reproduction_probs)\n        \n        # 2. Choose a neighbor for replacement (uniformly at random)\n        neighbors = graph[reproducer_idx]\n        if not neighbors: # Handles N=1 case or disconnected graphs\n            continue\n        neighbor_to_replace_idx = rng.choice(neighbors)\n        \n        # 3. Offspring replaces the neighbor\n        population[neighbor_to_replace_idx] = population[reproducer_idx]\n\ndef run_simulation(N, r, graph_type, num_sims, rng):\n    \"\"\"\n    Runs multiple Monte Carlo simulations to estimate fixation probability.\n\n    Args:\n        N (int): Population size.\n        r (float): Fitness of the mutant.\n        graph_type (str): 'complete' or 'cycle'.\n        num_sims (int): The number of independent simulations to run.\n        rng (numpy.random.Generator): The random number generator instance.\n\n    Returns:\n        float: The estimated fixation probability.\n    \"\"\"\n    if N = 1:\n        return 1.0 if N == 1 else 0.0\n\n    graph = build_graph(N, graph_type)\n    fixation_count = 0\n    for _ in range(num_sims):\n        fixation_count += simulate_one_run(N, r, graph, rng)\n    \n    return fixation_count / num_sims\n\n# Execute the main function to produce the final output.\nsolve()\n```"
        }
    ]
}