{
    "hands_on_practices": [
        {
            "introduction": "在共演化系统中，节点状态与网络拓扑之间的反馈是核心机制。这个练习将引导我们通过一个基础但极具启发性的思想实验，来探索一个简单的局部规则——同质性偏好——如何自发地导致全局网络结构的涌现。通过精确推导，我们将揭示节点状态如何直接影响其度（degree），并最终塑造网络的度相关性（degree assortativity），这是理解状态与结构耦合的基石。",
            "id": "4268873",
            "problem": "考虑一个由 $N$ 个节点组成的无向简单网络，其节点状态在强制实施关于二元状态 $\\sigma \\in \\{0,1\\}$ 的同质性（homophily）的快速重连过程中与网络拓扑共同演化。设处于状态 $\\sigma=1$ 的节点比例为 $p \\in (0,1)$，因此处于状态 $\\sigma=0$ 的节点比例为 $1-p$。假设存在时间尺度分离，使得在给定当前状态比例 $p$ 的条件下，网络边能快速平衡到一个具有固定边数 $M$ 的稳态系综，并遵循以下依赖于状态的形成规则：每个无序节点对根据其节点状态是相同还是不同而被赋予一个选择权重。具体来说，同态节点对（两个节点状态均为 $\\sigma=1$ 或均为 $\\sigma=0$）的选择权重为 $\\theta \\ge 0$，而异态节点对的选择权重为 $1$。通过无放回抽样形成边，直到网络中存在 $M$ 条边为止。\n\n从节点对计数和皮尔逊同配系数的核心定义出发，完成以下任务：\n\n1.  推导期望的边类型比例，记为 $p_{11}$、$p_{10}$ 和 $p_{00}$，其中 $p_{ab}$ 是连接状态 $a$ 和状态 $b$ 的边的比例。在用 $n^{2}/2$ 替代组合计数 $\\binom{n}{2}$ 的大 $N$ 近似下，仅用 $p$ 和 $\\theta$ 表示这些比例。\n\n2.  利用边端守恒和对称性，计算处于状态 $\\sigma=1$ 和 $\\sigma=0$ 的节点的期望度 $k_{1}$ 和 $k_{0}$（结果可相差一个整体比例因子）；解释为什么同态偏好（$\\theta \\neq 1$）与 $p \\neq \\tfrac{1}{2}$ 一起通常会导致 $k_{1} \\neq k_{0}$。\n\n3.  令 $K$ 表示一条均匀采样的边的某个端点的度，令 $(K_{1}, K_{2})$ 表示该边的两个端点的度。将度同配系数 $r$ 定义为皮尔逊相关性\n$$\nr = \\frac{\\operatorname{cov}(K_{1},K_{2})}{\\operatorname{var}(K)},\n$$\n其中 $\\operatorname{cov}(K_{1},K_{2}) = \\mathbb{E}[K_{1}K_{2}] - \\mathbb{E}[K]^{2}$ 且 $\\operatorname{var}(K) = \\mathbb{E}[K^{2}] - \\mathbb{E}[K]^{2}$。从第一性原理出发，使用边类型和端点度的条件概率，证明关于二元状态的同质性通过状态条件的连接形成导致了度同配性，并计算出 $r$ 的一个仅含 $p$ 和 $\\theta$ 的闭式解析表达式（最终表达式中不依赖于 $M$ 或 $N$）。\n\n你的最终答案必须是 $r$ 关于 $p$ 和 $\\theta$ 的一个单一闭式解析表达式。无需进行数值近似。",
            "solution": "该问题已经过验证，被认为是有效的。这是一个网络科学领域中良定的、有科学依据的、自洽且客观的问题。我们开始解答。\n\n解决方案按照问题陈述的要求分为三部分呈现。\n\n### 第一部分：边类型比例的推导\n\n给定一个包含 $N$ 个节点的网络，其中比例为 $p$ 的节点处于状态 $\\sigma=1$，比例为 $1-p$ 的节点处于状态 $\\sigma=0$。每种状态的节点数量为：\n-   状态为 1 的节点数：$N_1 = pN$\n-   状态为 0 的节点数：$N_0 = (1-p)N$\n\n使用大 $N$ 近似 $\\binom{n}{2} \\approx \\frac{n^2}{2}$，我们可以计算出每种状态组合的可能节点对数量：\n-   同态（1-1）节点对数量：$P_{11} = \\binom{N_1}{2} \\approx \\frac{(pN)^2}{2} = \\frac{p^2 N^2}{2}$\n-   同态（0-0）节点对数量：$P_{00} = \\binom{N_0}{2} \\approx \\frac{((1-p)N)^2}{2} = \\frac{(1-p)^2 N^2}{2}$\n-   异态（1-0）节点对数量：$P_{10} = N_1 N_0 = p(1-p)N^2$\n\n边是通过从这些具有给定权重的潜在节点对中抽样形成的。同态节点对的选择权重为 $\\theta$，异态节点对的权重为 $1$。代表整个加权潜在边集合的总权重 $W$ 为：\n$$\nW = \\theta P_{11} + \\theta P_{00} + 1 \\cdot P_{10}\n$$\n代入节点对计数的近似值：\n$$\nW \\approx \\theta \\frac{p^2 N^2}{2} + \\theta \\frac{(1-p)^2 N^2}{2} + p(1-p)N^2 = \\frac{N^2}{2} \\left[ \\theta(p^2 + (1-p)^2) + 2p(1-p) \\right]\n$$\n形成特定类型边的概率与该类型节点对的总权重成正比。期望的边类型比例 $p_{11}$、$p_{00}$ 和 $p_{10}$ 是部分权重与总权重 $W$ 的比值。\n令 $D = \\theta(p^2 + (1-p)^2) + 2p(1-p)$。$\\frac{N^2}{2}$ 项被消掉了。\n\n两个状态为 1 的节点之间边的期望比例为：\n$$\np_{11} = \\frac{\\theta P_{11}}{W} = \\frac{\\theta p^2 N^2 / 2}{D \\cdot N^2/2} = \\frac{\\theta p^2}{D}\n$$\n两个状态为 0 的节点之间边的期望比例为：\n$$\np_{00} = \\frac{\\theta P_{00}}{W} = \\frac{\\theta (1-p)^2 N^2 / 2}{D \\cdot N^2/2} = \\frac{\\theta (1-p)^2}{D}\n$$\n一个状态为 1 和一个状态为 0 的节点之间边的期望比例为：\n$$\np_{10} = \\frac{P_{10}}{W} = \\frac{p(1-p)N^2}{D \\cdot N^2/2} = \\frac{2p(1-p)}{D}\n$$\n作为检验，这些比例之和必须为 1：\n$$\np_{11} + p_{00} + p_{10} = \\frac{\\theta p^2 + \\theta (1-p)^2 + 2p(1-p)}{D} = \\frac{D}{D} = 1\n$$\n这就完成了用 $p$ 和 $\\theta$ 表示边类型比例的推导。\n\n### 第二部分：节点的期望度\n\n设 $M$ 为网络中的总边数。边端（或称末梢）的总数为 $2M$。每种类型的边数为 $M p_{11}$、$M p_{00}$ 和 $M p_{10}$。\n\n连接到状态为 1 的节点的总边端数是 1-1 边数的两倍加上 1-0 边数：\n$$\n\\text{Ends}_1 = 2(M p_{11}) + M p_{10} = M(2p_{11} + p_{10})\n$$\n状态为 1 的节点的期望度 $k_1$ 是这个总数除以状态为 1 的节点数 $N_1 = pN$：\n$$\nk_1 = \\frac{M(2p_{11} + p_{10})}{pN}\n$$\n类似地，对于状态为 0 的节点：\n$$\n\\text{Ends}_0 = 2(M p_{00}) + M p_{10} = M(2p_{00} + p_{10})\n$$\n$$\nk_0 = \\frac{M(2p_{00} + p_{10})}{(1-p)N}\n$$\n整个网络的平均度为 $\\langle k \\rangle = \\frac{2M}{N}$。我们可以用 $\\langle k \\rangle$ 来表示 $k_1$ 和 $k_0$：\n$$\nk_1 = \\frac{\\langle k \\rangle N}{2} \\frac{2p_{11} + p_{10}}{pN} = \\frac{\\langle k \\rangle}{2p} (2p_{11} + p_{10})\n$$\n$$\nk_0 = \\frac{\\langle k \\rangle N}{2} \\frac{2p_{00} + p_{10}}{(1-p)N} = \\frac{\\langle k \\rangle}{2(1-p)} (2p_{00} + p_{10})\n$$\n问题要求计算这些度，结果可相差一个比例因子。度的比值与比例因子 $\\langle k \\rangle$ 无关：\n$$\n\\frac{k_1}{k_0} = \\frac{1-p}{p} \\frac{2p_{11} + p_{10}}{2p_{00} + p_{10}}\n$$\n代入 $p_{ab}$ 的表达式：\n$$\n2p_{11} + p_{10} = \\frac{2\\theta p^2 + 2p(1-p)}{D} = \\frac{2p(\\theta p + 1 - p)}{D}\n$$\n$$\n2p_{00} + p_{10} = \\frac{2\\theta (1-p)^2 + 2p(1-p)}{D} = \\frac{2(1-p)(\\theta(1-p) + p)}{D}\n$$\n该比值变为：\n$$\n\\frac{k_1}{k_0} = \\frac{1-p}{p} \\frac{2p(\\theta p + 1 - p)/D}{2(1-p)(\\theta(1-p) + p)/D} = \\frac{\\theta p + 1 - p}{\\theta(1-p) + p}\n$$\n如果这个比值为 1，则度 $k_1$ 和 $k_0$ 相等：\n$$\n\\theta p + 1 - p = \\theta(1-p) + p \\implies \\theta p + 1 - p = \\theta - \\theta p + p \\implies 2p(\\theta-1) = \\theta-1\n$$\n这个等式在 $\\theta=1$（无状态偏好）或 $2p=1 \\implies p=\\frac{1}{2}$（每种状态的节点数相等）时成立。通常情况下，如果 $\\theta \\neq 1$ 且 $p \\neq \\frac{1}{2}$，那么 $k_1 \\neq k_0$，这是由同态偏好引起的。\n\n### 第三部分：度同配系数\n\n度同配系数 $r$ 是均匀采样的边的两端节点度 $(K_1, K_2)$ 的皮尔逊相关系数。在这个平均场模型中，我们假设所有处于相同状态的节点具有相同的期望度。设 $k_1$ 和 $k_0$ 分别是状态为 $\\sigma=1$ 和 $\\sigma=0$ 的节点的度。\n\n因此，一个节点的度 $K$ 是其状态 $\\sigma \\in \\{0, 1\\}$ 的一个确定性函数：\n$$ K(\\sigma) = k_0(1-\\sigma) + k_1\\sigma = k_0 + (k_1 - k_0)\\sigma $$\n这表明度 $K$ 是状态变量 $\\sigma$ 的一个线性变换。皮尔逊相关系数在其变量的正线性变换下是不变的。如果我们令 $(K_1, K_2)$ 为一条边两端的度，$(\\sigma_1, \\sigma_2)$ 为两端的状态，我们有：\n$$ r = \\operatorname{corr}(K_1, K_2) = \\operatorname{corr}(k_0 + (k_1-k_0)\\sigma_1, k_0 + (k_1-k_0)\\sigma_2) = \\operatorname{corr}(\\sigma_1, \\sigma_2) $$\n后一项是状态同配系数，我们记为 $r_{state}$。因此，$r = r_{state}$。这证明了只要不同状态的节点具有不同的平均度（$k_1 \\neq k_0$），关于状态变量的同质性就会直接导致度同配性。\n\n状态同配性 $r_{state}$ 定义为：\n$$\nr_{state} = \\frac{\\operatorname{cov}(\\sigma_1, \\sigma_2)}{\\operatorname{var}(\\sigma_1)} = \\frac{\\mathbb{E}[\\sigma_1 \\sigma_2] - \\mathbb{E}[\\sigma_1]\\mathbb{E}[\\sigma_2]}{\\mathbb{E}[\\sigma_1^2] - (\\mathbb{E}[\\sigma_1])^2}\n$$\n为了计算这个值，我们需要与随机选择的边的两端状态相关的概率。设 $q_1$ 是一个随机边端连接到状态为 1 的节点的概率，$q_0$ 是连接到状态为 0 的节点的概率。\n$$\nq_1 = \\frac{\\text{状态为 1 节点上的总边端数}}{\\text{总边端数}} = \\frac{M(2p_{11} + p_{10})}{2M} = p_{11} + \\frac{p_{10}}{2}\n$$\n$$\nq_0 = p_{00} + \\frac{p_{10}}{2}\n$$\n对于二元状态变量 $\\sigma \\in \\{0, 1\\}$，其期望和方差为：\n-   $\\mathbb{E}[\\sigma_1] = 1 \\cdot P(\\sigma_1=1) + 0 \\cdot P(\\sigma_1=0) = q_1$。根据对称性，$\\mathbb{E}[\\sigma_2]=q_1$。\n-   $\\mathbb{E}[\\sigma_1^2] = 1^2 \\cdot q_1 + 0^2 \\cdot q_0 = q_1$。\n-   $\\operatorname{var}(\\sigma_1) = \\mathbb{E}[\\sigma_1^2] - (\\mathbb{E}[\\sigma_1])^2 = q_1 - q_1^2 = q_1(1-q_1) = q_1 q_0$。\n\n联合期望 $\\mathbb{E}[\\sigma_1\\sigma_2]$ 是边的两端都处于状态 1 的概率，根据定义，这正是 1-1 边的比例 $p_{11}$。\n$$\n\\mathbb{E}[\\sigma_1\\sigma_2] = P(\\sigma_1=1, \\sigma_2=1) = p_{11}\n$$\n因此，同配系数为：\n$$\nr = r_{state} = \\frac{p_{11} - q_1^2}{q_1 q_0}\n$$\n现在，我们代入第一部分的表达式。令 $D=\\theta(p^2 + (1-p)^2) + 2p(1-p)$。\n$p_{11} = \\frac{\\theta p^2}{D}$\n$p_{10} = \\frac{2p(1-p)}{D}$\n$q_1 = p_{11} + \\frac{p_{10}}{2} = \\frac{\\theta p^2 + p(1-p)}{D} = \\frac{p(\\theta p + 1-p)}{D}$\n$q_0 = 1 - q_1 = \\frac{D - p(\\theta p + 1-p)}{D} = \\frac{\\theta p^2 + \\theta(1-p)^2 + 2p(1-p) - \\theta p^2 - p(1-p)}{D} = \\frac{\\theta(1-p)^2 + p(1-p)}{D} = \\frac{(1-p)(\\theta(1-p) + p)}{D}$\n\n$r$ 的分子是 $p_{11} - q_1^2$：\n$$\np_{11} - q_1^2 = \\frac{\\theta p^2}{D} - \\left(\\frac{p(\\theta p + 1-p)}{D}\\right)^2 = \\frac{D\\theta p^2 - p^2(\\theta p + 1-p)^2}{D^2}\n$$\n$$\n= \\frac{p^2}{D^2} \\left[ D\\theta - (\\theta p + 1-p)^2 \\right]\n$$\n$$\n= \\frac{p^2}{D^2} \\left[ \\theta(\\theta(p^2+(1-p)^2) + 2p(1-p)) - (\\theta p + 1-p)^2 \\right]\n$$\n$$\n= \\frac{p^2}{D^2} \\left[ \\theta^2 p^2 + \\theta^2(1-p)^2 + 2\\theta p(1-p) - (\\theta^2 p^2 + 2\\theta p(1-p) + (1-p)^2) \\right]\n$$\n$$\n= \\frac{p^2}{D^2} \\left[ \\theta^2(1-p)^2 - (1-p)^2 \\right] = \\frac{p^2(1-p)^2(\\theta^2-1)}{D^2}\n$$\n$r$ 的分母是 $q_1 q_0$：\n$$\nq_1 q_0 = \\frac{p(\\theta p + 1-p)}{D} \\frac{(1-p)(\\theta(1-p) + p)}{D} = \\frac{p(1-p)(\\theta p + 1-p)(\\theta(1-p) + p)}{D^2}\n$$\n最后，我们计算比值：\n$$\nr = \\frac{p_{11} - q_1^2}{q_1 q_0} = \\frac{p^2(1-p)^2(\\theta^2-1)/D^2}{p(1-p)(\\theta p + 1-p)(\\theta(1-p)+p)/D^2}\n$$\n$$\nr = \\frac{p(1-p)(\\theta^2-1)}{(\\theta p + 1-p)(\\theta(1-p)+p)}\n$$\n这就是度同配系数 $r$ 关于状态比例 $p$ 和同质性参数 $\\theta$ 的闭式解析表达式。",
            "answer": "$$\n\\boxed{\\frac{p(1-p)(\\theta^2 - 1)}{(\\theta p + 1 - p)(\\theta(1-p) + p)}}\n$$"
        },
        {
            "introduction": "共演化动力学不仅塑造静态结构，还在疾病传播等动态过程中扮演关键角色。本练习将我们带入自适应网络上的SIS（易感-感染-易感）模型，这是一个经典的场景，其中节点为了避免感染而主动重连接边。我们将运用成对近似（pairwise approximation）这一强大分析工具，构建系统的动力学方程，并通过线性稳定性分析来确定流行病爆发的临界条件，从而深入理解网络适应性如何改变系统的宏观行为。",
            "id": "4268917",
            "problem": "考虑一个大规模无向网络上的自适应易感-感染-易感 (SIS) 过程，该网络具有固定数量的节点 $N$ 和固定数量的边 $L$。初始时，网络是 $3$-正则的，因此平均度为 $k = 3$，边数为 $L = \\frac{k N}{2} = \\frac{3 N}{2}$。每个节点的状态为易感 ($S$) 或感染 ($I$)。该动力学由三个独立的泊松过程组成：(i) 沿每条 $SI$ 边以速率 $\\beta$ 发生感染，将易感端点变为感染状态；(ii) 每个感染节点以速率 $\\gamma$ 恢复，变为易感状态；(iii) 每条 $SI$ 边以速率 $\\omega$ 进行选择性重连，其中易感端点切断该边，并重新连接到一个均匀随机选择的易感节点（在大 $N$ 极限下，自环和多重边可以忽略不计），从而保持边数 $L$ 不变。\n\n使用对矩变量 $[X]$ 表示处于状态 $X \\in \\{S, I\\}$ 的节点数，$[XY]$ 表示处于状态 $X, Y \\in \\{S, I\\}$ 之间的无向边数，其中 $[SI] = [IS]$。令 $[XYZ]$ 表示以 $Y$ 为中心的连通三元组 $X$-$Y$-$Z$ 的数量。假设在对的层次上是均匀混合的，并采用标准的均匀对近似闭合：\n$$\n[XYZ] \\approx \\frac{k-1}{k} \\frac{[XY][YZ]}{[Y]}.\n$$\n在无病平衡点 (DFE) 附近进行分析，DFE 定义为 $[I] = 0$, $[SI] = 0$, $[II] = 0$, $[S] = N$, 和 $[SS] = L$。将动力学在 $[I]$、$[SI]$ 和 $[II]$ 相对于 DFE 的小偏差上进行线性化。在这些小偏差中只保留一阶项，并在 DFE 处使用 $[SS]/[S] = k/2$。\n\n从上述事件层面的规则和总边数守恒出发，为向量 $([I], [SI], [II])^{\\top}$ 构建线性化的对常微分方程 (ODE)，计算在 DFE 处的雅可比矩阵 $J$，然后计算 $J$ 的主特征值（具有最大实部的特征值）$\\lambda_{\\max}$，作为 $\\beta$、$\\gamma$ 和 $\\omega$ 的显式简化函数。您的最终答案必须是仅用 $\\beta$、$\\gamma$ 和 $\\omega$ 表示的单一闭式解析表达式。不要包含任何单位。",
            "solution": "首先根据指定标准对问题进行验证。\n\n### 步骤 1：提取已知条件\n-   **系统**：大规模无向网络上的自适应易感-感染-易感 (SIS) 过程。\n-   **网络属性**：\n    -   固定节点数，$N$。\n    -   固定边数，$L$。\n    -   初始为 3-正则，因此平均度为 $k=3$。\n    -   边数为 $L = \\frac{k N}{2} = \\frac{3 N}{2}$。\n-   **节点状态**：易感 ($S$) 或感染 ($I$)。\n-   **动力学过程 (独立的泊松过程)**：\n    -   **(i) 感染**：对于每条 $S-I$ 边，$S$ 节点以速率 $\\beta$ 变为 $I$。\n    -   **(ii) 恢复**：每个 $I$ 节点以速率 $\\gamma$ 变为 $S$。\n    -   **(iii) 重连**：对于每条 $S-I$ 边，$S$ 端点以速率 $\\omega$ 切断该边，并重新连接到一个均匀随机选择的 $S$ 节点。总边数 $L$ 保持不变。\n-   **变量与符号**：\n    -   $[X]$：处于状态 $X \\in \\{S, I\\}$ 的节点数。\n    -   $[XY]$：处于状态 $X, Y \\in \\{S, I\\}$ 的节点之间的无向边数。\n    -   $[XYZ]$：连通三元组 $X-Y-Z$ 的数量。\n-   **近似与假设**：\n    -   对矩闭合近似：$[XYZ] \\approx \\frac{k-1}{k} \\frac{[XY][YZ]}{[Y]}$。\n    -   分析在无病平衡点 (DFE) 附近进行。\n    -   DFE 定义为 $[I]=0$, $[SI]=0$, $[II]=0$, $[S]=N$, 和 $[SS]=L$。\n    -   动力学被线性化，只保留 $[I]$、$[SI]$ 和 $[II]$ 相对于 DFE 的小偏差的一阶项。\n    -   在 DFE 处，$[SS]/[S] = k/2$。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学依据**：该问题描述了一个网络上的标准自适应 SIS 模型，这是网络科学和数理流行病学中一个成熟的课题。使用对近似和线性化是分析此类系统的标准技术。\n-   **良构性**：问题表述清晰。它指定了模型、数学框架（对 ODE）、要使用的近似（闭合）以及要计算的量（DFE 处雅可比矩阵的主特征值）。预期会有一个唯一且有意义的解。\n-   **客观性**：问题以精确的数学术语陈述，没有任何主观或模棱两可的语言。\n-   **完整性与一致性**：问题提供了所有必要的信息：网络结构 ($k=3$)、所有过程的速率 ($\\beta, \\gamma, \\omega$) 以及闭合近似的具体形式。已知条件是自洽的。例如，$L = 3N/2$ 与 3-正则网络一致。指定的 DFE 状态与无病网络一致。\n-   **无其他缺陷**：该问题不违反任何其他无效标准。它不是平凡的、隐喻性的或不可证伪的。\n\n### 步骤 3：结论与行动\n问题有效。现在开始求解过程。\n\n我们首先为感染节点数 $[I]$ 和边数 $[SI]$、$[II]$ 构建常微分方程 (ODE)。\n\n感染节点数 $[I]$ 的变化率由感染和恢复事件之间的平衡给出：\n$$\n\\frac{d[I]}{dt} = \\beta[SI] - \\gamma[I]\n$$\n\n接下来，我们确定 $S-I$ 边数 $[SI]$ 的变化率。我们分析每个过程的影响：\n1.  **感染**：一个感染事件沿着一条 $S-I$ 连边发生。设该连边为 $S_1-I_2$。节点 $S_1$ 被感染。原来的 $S_1-I_2$ 边变成一条 $I-I$ 边，因此 $[SI]$ 减少 1。$S_1$ 的其他邻居的连边现在也发生变化。连接到 $S_1$ 的一条 $S-S$ 边会变成一条 $I-S$ 边，使 $[SI]$ 增加。连接到 $S_1$ 的一条 $S-I$ 边会变成一条 $I-I$ 边，使 $[SI]$ 减少。\n    作为 $S-I$ 连边一部分的 $S$ 节点的 $S$ 邻居的平均数量由 $\\frac{[SSI]}{[SI]}$ 给出。使用闭合近似，这等于 $\\frac{k-1}{k}\\frac{[SS]}{[S]}$。\n    作为 $S-I$ 连边一部分的 $S$ 节点的 $I$ 邻居的平均数量由 $\\frac{[ISI]}{[SI]}$ 给出。使用闭合近似，这等于 $\\frac{k-1}{k}\\frac{[SI]}{[S]}$。\n    每次感染事件中 $[SI]$ 的总变化量为 $-1 + \\frac{k-1}{k}\\frac{[SS]}{[S]} - \\frac{k-1}{k}\\frac{[SI]}{[S]}$。由感染引起总变化率为 $\\beta[SI]\\left(-1 + \\frac{k-1}{k}\\frac{[SS]}{[S]} - \\frac{k-1}{k}\\frac{[SI]}{[S]}\\right)$。\n2.  **恢复**：一个感染节点 $I$ 变为易感节点 $S$。连接到它的 $I-I$ 边变为 $S-I$ 边，使 $[SI]$ 增加。连接到它的 $S-I$ 边变为 $S-S$ 边，使 $[SI]$ 减少。每个感染节点的 $I-I$ 连边的平均数量为 $2[II]/[I]$，而 $S-I$ 连边的平均数量为 $[SI]/[I]$。由恢复引起的总变化率为 $\\gamma[I]\\left(\\frac{2[II]}{[I]} - \\frac{[SI]}{[I]}\\right) = \\gamma(2[II]-[SI])$。\n3.  **重连**：一条 $S-I$ 边被移除，该 $S$ 节点创建一条新的 $S-S$ 边。这将一条 $S-I$ 边转换为一条 $S-S$ 边，使 $[SI]$ 减少 1。由重连引起的总变化率为 $-\\omega[SI]$。\n\n综合这些项，得到 $[SI]$ 的 ODE：\n$$\n\\frac{d[SI]}{dt} = \\beta[SI]\\left(\\frac{k-1}{k}\\frac{[SS]}{[S]} - 1 - \\frac{k-1}{k}\\frac{[SI]}{[S]}\\right) + \\gamma(2[II] - [SI]) - \\omega[SI]\n$$\n\n最后，我们确定 $I-I$ 边数 $[II]$ 的变化率：\n1.  **感染**：激活的 $S-I$ 边变为一条 $I-I$ 边。连接到新感染节点的其他 $S-I$ 边也变为 $I-I$ 边。每次感染事件中 $[II]$ 的变化量为 $1 + \\frac{[ISI]}{[SI]} = 1 + \\frac{k-1}{k}\\frac{[SI]}{[S]}$。由感染引起的总变化率为 $\\beta[SI]\\left(1 + \\frac{k-1}{k}\\frac{[SI]}{[S]}\\right)$。\n2.  **恢复**：当一个 $I$ 节点恢复时，它的 $I-I$ 边变为 $S-I$ 边。平均损失 $2[II]/[I]$ 条这样的边。总变化率为 $\\gamma[I](-2[II]/[I]) = -2\\gamma[II]$。\n3.  **重连**：此过程不创建也不破坏 $I-I$ 边。\n\n$[II]$ 的 ODE 是：\n$$\n\\frac{d[II]}{dt} = \\beta[SI]\\left(1 + \\frac{k-1}{k}\\frac{[SI]}{[S]}\\right) - 2\\gamma[II]\n$$\n\n现在我们围绕 DFE 线性化这些方程。令 $[I]=\\epsilon_I$、$[SI]=\\epsilon_{SI}$ 和 $[II]=\\epsilon_{II}$ 为小偏差。我们有 $[S] = N - \\epsilon_I$，并且根据边数守恒 $L = [SS] + [SI] + [II]$，我们有 $[SS] = L - \\epsilon_{SI} - \\epsilon_{II}$。我们只保留到一阶的项。\n\n对于第一个 ODE：\n$$\n\\frac{d\\epsilon_I}{dt} = \\beta\\epsilon_{SI} - \\gamma\\epsilon_I\n$$\n这个 ODE 已经是线性的。\n\n对于 $[SI]$ 的 ODE，我们线性化 $\\beta\\epsilon_{SI}$ 的系数。括号内的项变为：\n$$\n\\frac{k-1}{k}\\frac{L - \\epsilon_{SI} - \\epsilon_{II}}{N - \\epsilon_I} - 1 - \\frac{k-1}{k}\\frac{\\epsilon_{SI}}{N - \\epsilon_I} \\approx \\frac{k-1}{k}\\frac{L}{N} - 1 + O(\\epsilon) = \\frac{k-1}{k}\\frac{k}{2} - 1 = \\frac{k-1}{2} - 1 = \\frac{k-3}{2}\n$$\n问题指定 $k=3$，所以此项为 $\\frac{3-3}{2} = 0$。$\\epsilon_{SI}$ 的线性化 ODE 是：\n$$\n\\frac{d\\epsilon_{SI}}{dt} = \\beta\\epsilon_{SI}(0) + \\gamma(2\\epsilon_{II} - \\epsilon_{SI}) - \\omega\\epsilon_{SI} = -(\\gamma + \\omega)\\epsilon_{SI} + 2\\gamma\\epsilon_{II}\n$$\n\n对于 $[II]$ 的 ODE，括号中的项是 $1 + \\frac{k-1}{k}\\frac{\\epsilon_{SI}}{N - \\epsilon_I} = 1 + O(\\epsilon)$。所以，线性化方程是：\n$$\n\\frac{d\\epsilon_{II}}{dt} = \\beta\\epsilon_{SI}(1) - 2\\gamma\\epsilon_{II} = \\beta\\epsilon_{SI} - 2\\gamma\\epsilon_{II}\n$$\n\n状态向量 $(\\epsilon_I, \\epsilon_{SI}, \\epsilon_{II})^{\\top}$ 的线性化系统是：\n$$\n\\frac{d}{dt}\\begin{pmatrix} \\epsilon_I \\\\ \\epsilon_{SI} \\\\ \\epsilon_{II} \\end{pmatrix} =\n\\begin{pmatrix}\n-\\gamma & \\beta & 0 \\\\\n0 & -(\\gamma+\\omega) & 2\\gamma \\\\\n0 & \\beta & -2\\gamma\n\\end{pmatrix}\n\\begin{pmatrix} \\epsilon_I \\\\ \\epsilon_{SI} \\\\ \\epsilon_{II} \\end{pmatrix}\n$$\n这个方程中的矩阵是在 DFE 处的雅可比矩阵 $J$。\n$$\nJ = \\begin{pmatrix}\n-\\gamma & \\beta & 0 \\\\\n0 & -(\\gamma+\\omega) & 2\\gamma \\\\\n0 & \\beta & -2\\gamma\n\\end{pmatrix}\n$$\n为了找到 $J$ 的特征值 $\\lambda$，我们求解特征方程 $\\det(J - \\lambda I) = 0$：\n$$\n\\det \\begin{pmatrix}\n-\\gamma - \\lambda & \\beta & 0 \\\\\n0 & -(\\gamma+\\omega) - \\lambda & 2\\gamma \\\\\n0 & \\beta & -2\\gamma - \\lambda\n\\end{pmatrix} = 0\n$$\n由于该矩阵是块上三角矩阵，其行列式是对角块行列式的乘积：\n$$\n(-\\gamma - \\lambda) \\det \\begin{pmatrix}\n-(\\gamma+\\omega) - \\lambda & 2\\gamma \\\\\n\\beta & -2\\gamma - \\lambda\n\\end{pmatrix} = 0\n$$\n立即可以找到一个特征值为 $\\lambda_1 = -\\gamma$。\n另外两个特征值是 $2 \\times 2$ 子矩阵的特征方程的根：\n$$\n(-(\\gamma+\\omega) - \\lambda)(-2\\gamma - \\lambda) - (2\\gamma)(\\beta) = 0\n$$\n$$\n(\\lambda + \\gamma + \\omega)(\\lambda + 2\\gamma) - 2\\gamma\\beta = 0\n$$\n$$\n\\lambda^2 + (3\\gamma + \\omega)\\lambda + 2\\gamma(\\gamma+\\omega) - 2\\gamma\\beta = 0\n$$\n我们使用二次公式求解 $\\lambda$：\n$$\n\\lambda = \\frac{-(3\\gamma + \\omega) \\pm \\sqrt{(3\\gamma + \\omega)^2 - 4(2\\gamma(\\gamma+\\omega-\\beta))}}{2}\n$$\n$$\n\\lambda = \\frac{-(3\\gamma + \\omega) \\pm \\sqrt{9\\gamma^2 + 6\\gamma\\omega + \\omega^2 - 8\\gamma^2 - 8\\gamma\\omega + 8\\gamma\\beta}}{2}\n$$\n$$\n\\lambda = \\frac{-(3\\gamma + \\omega) \\pm \\sqrt{\\gamma^2 - 2\\gamma\\omega + \\omega^2 + 8\\gamma\\beta}}{2}\n$$\n$$\n\\lambda = \\frac{-(3\\gamma + \\omega) \\pm \\sqrt{(\\gamma - \\omega)^2 + 8\\gamma\\beta}}{2}\n$$\n三个特征值是：\n$$\n\\lambda_1 = -\\gamma\n$$\n$$\n\\lambda_2 = \\frac{-(3\\gamma + \\omega) - \\sqrt{(\\gamma - \\omega)^2 + 8\\gamma\\beta}}{2}\n$$\n$$\n\\lambda_3 = \\frac{-(3\\gamma + \\omega) + \\sqrt{(\\gamma - \\omega)^2 + 8\\gamma\\beta}}{2}\n$$\n参数 $\\beta$、$\\gamma$ 和 $\\omega$ 是非负速率。\n$\\lambda_1 = -\\gamma$ 是负数（如果 $\\gamma=0$ 则为零）。\n$\\lambda_2$ 显然是负数，因为它是两个负项的和。\n$\\lambda_3$ 是唯一可能为正的特征值，因此它必须是主特征值 $\\lambda_{\\max}$。如果 $\\lambda_{\\max} > 0$，则 DFE 不稳定，导致疾病爆发。\n\n因此，主特征值是：\n$$\n\\lambda_{\\max} = \\frac{-(3\\gamma + \\omega) + \\sqrt{(\\gamma - \\omega)^2 + 8\\gamma\\beta}}{2}\n$$",
            "answer": "$$\\boxed{\\frac{-(3\\gamma + \\omega) + \\sqrt{(\\gamma - \\omega)^{2} + 8\\gamma\\beta}}{2}}$$"
        },
        {
            "introduction": "共演化过程可以导致剧烈的宏观相变，例如网络的完全碎片化。此练习探讨了一个包含“顽固节点”（zealots）的观点动力学模型，这些节点的观点固定不变。我们将分析在同质性驱动的重连接规则下，这些顽固节点如何作为“锚点”，最终引导整个网络分裂成多个意见一致但彼此隔离的子图。通过应用随机图论中的Molloy-Reed判据，我们将精确计算出阻止全局共识所需的最小顽固节点比例，这揭示了共演化系统中的临界现象。",
            "id": "4268930",
            "problem": "考虑一个由配置模型生成的包含 $N$ 个节点的无向、简单、连通网络，其度分布为平均度 $\\langle k \\rangle = k > 1$ 的泊松分布。每个节点持有两种观点之一 $s \\in \\{+1,-1\\}$。节点中的一部分（比例为 $z$）是持有固定观点的狂热者；假设对称性，即 $z/2$ 的节点是观点为 $s=+1$ 的狂熱者，$z/2$ 的节点是观点为 $s=-1$ 的狂热者。剩余比例为 $1-z$ 的是可能改变观点的易感节点。动力学过程如下：在每一步，均匀随机地选择一条不一致边（连接两个持相反观点节点的边）。如果该边的一个端点是易感节点，则该易感端点有 $w \\in (0,1]$ 的概率将该边重连到一个与其观点相同的随机选择的节点（在该观点所有节点中均匀选择），并有 $1-w$ 的概率采纳其邻居的观点。狂热者节点永不改变观点，也永不发起重连；重连事件仅由易感节点如上所述发起。假设系统在无限大规模极限 $N \\to \\infty$ 和连续时间尺度下，在平均场近似下进行确定性演化。\n\n从一个随机的观点初始分配开始，其中易感节点为 $+1$ 或 $-1$ 的可能性相等，且初始网络没有度-观点相关性，分析在上述同质性重连规则下当 $t \\to \\infty$ 时的协同演化结果。\n\n仅使用关于随机图的基本事实，特别是 Molloy–Reed 判据（即一个度分布为 $\\{p_k\\}$ 的配置模型随机图存在巨型组件的充要条件是 $\\sum_{k} k(k-2)p_k > 0$），推导以下内容：\n\n1. 解释为什么当 $w>0$ 时，狂热者的存在会改变相对于无狂热者情况下的协同演化结果。你的解释必须基于同质性重连如何在吸收态中改变网络的组件结构。\n\n2. 考虑对于任何 $w>0$，通过同质性重连消除所有不一致边后达到的吸收态，计算易感子图内的有效平均度，然后使用 Molloy–Reed 判据得出一个闭式表达式，该表达式表示保证易感子图不包含巨型组件所需的最小狂热者比例 $z_{\\min}$。将此条件解释为足以阻止易感节点之间达成全局共识，因为观点变化无法跨越不连通的有限组件传播。请提供你最终的 $z_{\\min}$ 关于 $k$ 的函数表达式。\n\n你的最终答案必须是一个单一的闭式解析表达式，没有单位。不需要四舍五入。",
            "solution": "该问题要求分析一个自适应网络上的协同演化观点动力学模型，特别是解释狂热者的作用，并计算防止在易感子群体内形成巨型组件所需的最小狂热者比例 $z_{\\min}$。\n\n验证步骤确认了该问题是科学上合理、良定且客观的。这是一个网络科学中的标准问题，可以使用提供的工具和假设来解决。\n\n**第一部分：狂热者在协同演化结果中的作用**\n\n在此模型中，发生两个过程：观点采纳（概率为 $1-w$）和同质性驱动的网络重连（概率为 $w$）。系统向吸收态演化，在吸收态中不存在不一致边。如果一条边连接的节点持有相反观点（$s=+1$ 和 $s=-1$），则该边为不一致边。\n\n在吸收态中，网络必然被划分为多个子图，其中每个子图都是单色的，即其中所有节点共享相同观点。所有连接都是同质的。\n\n在无狂热者的情况下 ($z=0$)，所有节点都是易感的。虽然同质性重连 ($w>0$) 促进网络碎片化为单色组件，但观点采纳过程 ($1-w>0$) 促进共识。最终状态取决于这两种力量之间的竞争。如果观点采纳动力学在网络完全碎片化之前占主导地位，整个网络有可能达到全局共识状态（所有节点都变为 $+1$ 或所有节点都变为 $-1$）。\n\n狂热者的引入 ($z>0$) 从根本上改变了这一结果。根据定义，狂热者有固定的观点。问题指定了狂热者的对称分布：比例为 $z/2$ 的狂热者固定为 $s=+1$，比例为 $z/2$ 的狂热者固定为 $s=-1$。这带来一个关键后果：全局共识不再可能。即使只有一个 $+1$ 狂热者和一个 $-1$ 狂热者存在，也保证了两种观点都将在系统中无限期地持续存在。\n\n当重连发生时 ($w>0$)，不一致边一端的易感节点会断开该连接，并与一个随机选择的、与其观点相同的节点形成新连接。在没有不一致边留下的吸收态中，任何易感节点都必须只与和自己观点相同的节点相连。这些邻居可以是其他易感节点或狂熱者。\n\n因此，狂热者充当了观点簇的不可变锚点或“核心”。每个 $+1$ 狂热者都成为一个完全由 $+1$ 节点组成的组件的一部分。同样，每个 $-1$ 狂热者都成为一个由 $-1$ 节点组成的组件的一部分。随着系统的演化，易感节点通过观点采纳和重连的组合，最终被同化到这些单色簇之一中。重连机制 ($w>0$) 在物理上切断了这些新兴观点集团之间的连接，保证了最终的网络状态是沿着观点界线碎片化的。如果没有狂热者，这种碎片化只是一个可能的结果，全局共識是另一个。而有了持相反观点的狂热者，碎片化为至少两个宏观上分离的观点群体成为唯一可能的吸收态。\n\n**第二部分：最小狂热者比例 $z_{\\min}$ 的计算**\n\n我们寻求在 $N \\to \\infty$ 极限下，仅由易感节点组成的子图（我们记为 $G_S$）不包含巨型组件的条件。分析是在所有边都是同质的吸收态上进行的。\n\n原始网络由配置模型生成，其度分布为泊松分布 $p_k = e^{-k}k^k/k!$，其中平均度为 $\\langle k \\rangle = k$。在吸收态中，一个易感节点只与和自己观点相同的节点相连。这些邻居可以是其他易感节点或狂热者。\n\n在平均场假设下，重连事件中选择的新邻居是从所有与重连节点观点相同的节点中均匀随机选择的。根据对称性，我们可以分析 $+1$ 或 $-1$ 观点组。让我们考虑观点为 $+1$ 的节点。持有此观点的节点总数包括 $N(1-z)/2$ 个易感节点（假设最终状态呈对称分布）和 $Nz/2$ 个狂热者。$+1$ 节点的总数为 $N(1-z)/2 + Nz/2 = N/2$。在这个 $+1$ 观点池中，易感节点所占的比例是 $\\frac{N(1-z)/2}{N/2} = 1-z$。\n\n因此，在最终的同质状态下，任何一条源自易感节点的边有 $p_{s \\to s} = 1-z$ 的概率连接到另一个易感节点，有 $p_{s \\to z} = z$ 的概率连接到狂热者。\n\n这个过程等同于从原始网络中随机移除边。具体来说，只有当一条边连接两个易感节点时，它才被保留在易感子图 $G_S$ 内。对于一个原始度为 $k_i$ 的易感节点，它的 $k_i$ 条边中的每一条都有 $1-z$ 的概率保留为 $G_S$ 内的边。该节点在子图 $G_S$ 内的度 $k'_i$ 服从二项分布：$k'_i \\sim \\text{Binomial}(k_i, 1-z)$。这个过程被称为度序列的二项式稀疏化。\n\n易感子图 $G_S$ 的新度分布 $p'_{k'}$ 由下式给出：\n$$p'_{j} = \\sum_{i=j}^{\\infty} p_i \\binom{i}{j} (1-z)^{j} z^{i-j}$$\n为确定 $G_S$ 是否有巨型组件，我们使用 Molloy–Reed 判据，该判据指出巨型组件存在的充要条件是 $Q' = \\sum_{j} j(j-2) p'_{j} > 0$。我们需要找到使 $Q' \\le 0$ 的条件。$Q'$ 的表达式可以用新分布的矩来表示：\n$$Q' = \\langle k'^2 \\rangle - 2\\langle k' \\rangle \\le 0$$\n我们可以用原始分布 $p_i$ 的矩来计算稀疏化分布 $p'_{j}$ 的矩。\n新分布的平均值为：\n$$\\langle k' \\rangle = \\sum_j j p'_j = \\sum_i p_i \\left( \\sum_j j \\binom{i}{j} (1-z)^j z^{i-j} \\right)$$\n内部的和是一个 $\\text{Binomial}(i, 1-z)$ 随机变量的期望，即 $i(1-z)$。\n$$\\langle k' \\rangle = \\sum_i p_i (i(1-z)) = (1-z) \\sum_i i p_i = (1-z)\\langle k \\rangle$$\n二阶矩为：\n$$\\langle k'^2 \\rangle = \\sum_j j^2 p'_j = \\sum_i p_i \\left( \\sum_j j^2 \\binom{i}{j} (1-z)^j z^{i-j} \\right)$$\n内部的和是一个 $\\text{Binomial}(i, 1-z)$ 变量的二阶矩。其方差为 $i(1-z)z$，所以二阶矩是 $\\text{Var} + \\text{Mean}^2 = i(1-z)z + (i(1-z))^2$。\n$$\\langle k'^2 \\rangle = \\sum_i p_i (i(1-z)z + i^2(1-z)^2) = (1-z)z \\langle k \\rangle + (1-z)^2 \\langle k^2 \\rangle$$\n现在将这些矩代入 Molloy–Reed 条件 $Q' \\le 0$：\n$$ (1-z)z \\langle k \\rangle + (1-z)^2 \\langle k^2 \\rangle - 2(1-z)\\langle k \\rangle \\le 0 $$\n因为 $z1$，我们可以除以正因子 $(1-z)$：\n$$ z \\langle k \\rangle + (1-z) \\langle k^2 \\rangle - 2 \\langle k \\rangle \\le 0 $$\n对于给定的泊松度分布，我们有 $\\langle k \\rangle = k$ 且方差为 $\\text{Var}(k) = k$，这意味着 $\\langle k^2 \\rangle = \\text{Var}(k) + \\langle k \\rangle^2 = k + k^2$。\n将这些代入不等式：\n$$ zk + (1-z)(k+k^2) - 2k \\le 0 $$\n$$ zk + k + k^2 - zk - zk^2 - 2k \\le 0 $$\n$$ k^2 - k - zk^2 \\le 0 $$\n$$ k^2(1-z) - k \\le 0 $$\n因为问题说明 $k  1$，我们可以除以 $k$：\n$$ k(1-z) - 1 \\le 0 $$\n$$ k(1-z) \\le 1 $$\n$$ 1-z \\le \\frac{1}{k} $$\n$$ z \\ge 1 - \\frac{1}{k} $$\n保证易感子图不包含巨型组件的最小狂热者比例 $z_{\\min}$ 是使该不等式成为等式的值。\n$$ z_{\\min} = 1 - \\frac{1}{k} $$\n这个条件确保了易感群体内的有效连通性被降低到大规模观点传播不可能发生的程度。$k(1-z)$ 项可以被解释为易感网络上级联过程的有效分支因子；将此值设置为最多为 $1$ 可确保任何级联都会消亡，从而防止巨型组件的形成和易感节点间的全局共识。",
            "answer": "$$\\boxed{1-\\frac{1}{k}}$$"
        }
    ]
}