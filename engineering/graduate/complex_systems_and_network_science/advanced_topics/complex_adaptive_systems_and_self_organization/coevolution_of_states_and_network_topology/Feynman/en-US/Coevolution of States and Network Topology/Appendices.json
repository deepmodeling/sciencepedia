{
    "hands_on_practices": [
        {
            "introduction": "To begin our hands-on exploration, we will first establish a foundational link between node states and network topology. This exercise investigates how a simple, local preference for similar neighbors—a principle known as homophily—can give rise to a non-trivial global network structure. By deriving the degree assortativity directly from a model of state-dependent link formation , you will practice translating a micro-level behavioral rule into a prediction about macro-level network patterns, a core skill in the study of complex systems.",
            "id": "4268873",
            "problem": "Consider an undirected simple network of $N$ nodes whose states coevolve with the topology under a fast-rewiring process that enforces homophily with respect to a binary state $\\sigma \\in \\{0,1\\}$. Let the fraction of nodes in state $\\sigma=1$ be $p \\in (0,1)$, so the fraction in state $\\sigma=0$ is $1-p$. Assume a separation of time scales such that, conditional on the current state fraction $p$, the network edges equilibrate quickly to a stationary ensemble with a fixed number of edges $M$ and the following state-dependent formation rule: each unordered node pair is selected with a weight that depends only on whether the states match or differ. Specifically, same-state pairs (both $\\sigma=1$ or both $\\sigma=0$) have selection weight $\\theta \\ge 0$ and different-state pairs have selection weight $1$, with edges sampled without replacement until $M$ edges are present.\n\nStarting from the core definitions of pair counts and the Pearson assortativity coefficient, do the following:\n\n1. Derive the expected fractions of edge-types, denoted $p_{11}$, $p_{10}$, and $p_{00}$, where $p_{ab}$ is the fraction of edges between states $a$ and $b$. Express these fractions in terms of $p$ and $\\theta$ only under the large-$N$ approximation that replaces combinatorial counts $\\binom{n}{2}$ by $n^{2}/2$.\n\n2. Using the conservation of ends and symmetry, compute the expected degrees $k_{1}$ and $k_{0}$ of nodes in states $\\sigma=1$ and $\\sigma=0$, respectively, up to an overall scale factor; explain why same-state bias ($\\theta \\neq 1$) together with $p \\neq \\tfrac{1}{2}$ generically induces $k_{1} \\neq k_{0}$.\n\n3. Let $K$ denote the degree at one end of a uniformly sampled edge, and let $(K_{1}, K_{2})$ denote the degrees at both ends of a uniformly sampled edge. Define the degree assortativity coefficient $r$ as the Pearson correlation\n$$\nr \\;=\\; \\frac{\\operatorname{cov}(K_{1},K_{2})}{\\operatorname{var}(K)} \\,,\n$$\nwhere $\\operatorname{cov}(K_{1},K_{2}) = \\mathbb{E}[K_{1}K_{2}] - \\mathbb{E}[K]^{2}$ and $\\operatorname{var}(K) = \\mathbb{E}[K^{2}] - \\mathbb{E}[K]^{2}$. Show, from first principles using conditional probabilities of edge-types and endpoint degrees, that homophily on the binary state induces degree assortativity via the state-conditioned link formation, and compute $r$ explicitly as a closed-form analytic expression in terms of $p$ and $\\theta$ only (no dependence on $M$ or $N$ in the final expression).\n\nYour final answer must be a single closed-form analytic expression for $r$ in terms of $p$ and $\\theta$. No numerical approximation is required.",
            "solution": "The problem is subjected to validation and is deemed valid. It is a well-posed, scientifically grounded problem in network science that is self-contained and objective. We proceed to the solution.\n\nThe solution is presented in three parts, as requested by the problem statement.\n\n### Part 1: Derivation of Edge-Type Fractions\n\nWe are given a network of $N$ nodes, where a fraction $p$ are in state $\\sigma=1$ and a fraction $1-p$ are in state $\\sigma=0$. The number of nodes in each state is:\n-   Number of state-1 nodes: $N_1 = pN$\n-   Number of state-0 nodes: $N_0 = (1-p)N$\n\nUsing the large-$N$ approximation $\\binom{n}{2} \\approx \\frac{n^2}{2}$, we can find the number of possible node pairs for each state combination:\n-   Number of same-state (1-1) pairs: $P_{11} = \\binom{N_1}{2} \\approx \\frac{(pN)^2}{2} = \\frac{p^2 N^2}{2}$\n-   Number of same-state (0-0) pairs: $P_{00} = \\binom{N_0}{2} \\approx \\frac{((1-p)N)^2}{2} = \\frac{(1-p)^2 N^2}{2}$\n-   Number of different-state (1-0) pairs: $P_{10} = N_1 N_0 = p(1-p)N^2$\n\nEdges are formed by sampling from these potential pairs with given weights. Same-state pairs have a selection weight of $\\theta$, and different-state pairs have a weight of $1$. The total weight, $W$, representing the entire pool of weighted potential edges, is:\n$$\nW = \\theta P_{11} + \\theta P_{00} + 1 \\cdot P_{10}\n$$\nSubstituting the approximations for the pair counts:\n$$\nW \\approx \\theta \\frac{p^2 N^2}{2} + \\theta \\frac{(1-p)^2 N^2}{2} + p(1-p)N^2 = \\frac{N^2}{2} \\left[ \\theta(p^2 + (1-p)^2) + 2p(1-p) \\right]\n$$\nThe probability of forming an edge of a specific type is proportional to the total weight of pairs of that type. The expected fractions of edge-types, $p_{11}$, $p_{00}$, and $p_{10}$, are the ratios of the partial weights to the total weight $W$.\nLet $D = \\theta(p^2 + (1-p)^2) + 2p(1-p)$. The term $\\frac{N^2}{2}$ cancels out.\n\nThe expected fraction of edges between two state-1 nodes is:\n$$\np_{11} = \\frac{\\theta P_{11}}{W} = \\frac{\\theta p^2 N^2 / 2}{D \\cdot N^2/2} = \\frac{\\theta p^2}{D}\n$$\nThe expected fraction of edges between two state-0 nodes is:\n$$\np_{00} = \\frac{\\theta P_{00}}{W} = \\frac{\\theta (1-p)^2 N^2 / 2}{D \\cdot N^2/2} = \\frac{\\theta (1-p)^2}{D}\n$$\nThe expected fraction of edges between a state-1 and a state-0 node is:\n$$\np_{10} = \\frac{P_{10}}{W} = \\frac{p(1-p)N^2}{D \\cdot N^2/2} = \\frac{2p(1-p)}{D}\n$$\nAs a check, these fractions must sum to unity:\n$$\np_{11} + p_{00} + p_{10} = \\frac{\\theta p^2 + \\theta (1-p)^2 + 2p(1-p)}{D} = \\frac{D}{D} = 1\n$$\nThis completes the derivation of the edge-type fractions in terms of $p$ and $\\theta$.\n\n### Part 2: Expected Degrees of Nodes\n\nLet $M$ be the total number of edges in the network. The total number of edge ends (or stubs) is $2M$. The number of edges of each type is $M p_{11}$, $M p_{00}$, and $M p_{10}$.\n\nThe total number of edge ends connected to state-1 nodes is the sum of twice the number of 1-1 edges and the number of 1-0 edges:\n$$\n\\text{Ends}_1 = 2(M p_{11}) + M p_{10} = M(2p_{11} + p_{10})\n$$\nThe expected degree of a state-1 node, $k_1$, is this total divided by the number of state-1 nodes, $N_1 = pN$:\n$$\nk_1 = \\frac{M(2p_{11} + p_{10})}{pN}\n$$\nSimilarly, for state-0 nodes:\n$$\n\\text{Ends}_0 = 2(M p_{00}) + M p_{10} = M(2p_{00} + p_{10})\n$$\n$$\nk_0 = \\frac{M(2p_{00} + p_{10})}{(1-p)N}\n$$\nThe average degree of the entire network is $\\langle k \\rangle = \\frac{2M}{N}$. We can express $k_1$ and $k_0$ in terms of $\\langle k \\rangle$:\n$$\nk_1 = \\frac{\\langle k \\rangle N}{2} \\frac{2p_{11} + p_{10}}{pN} = \\frac{\\langle k \\rangle}{2p} (2p_{11} + p_{10})\n$$\n$$\nk_0 = \\frac{\\langle k \\rangle N}{2} \\frac{2p_{00} + p_{10}}{(1-p)N} = \\frac{\\langle k \\rangle}{2(1-p)} (2p_{00} + p_{10})\n$$\nThe problem asks for these degrees up to a scale factor. The ratio of the degrees is independent of the scale factor $\\langle k \\rangle$:\n$$\n\\frac{k_1}{k_0} = \\frac{1-p}{p} \\frac{2p_{11} + p_{10}}{2p_{00} + p_{10}}\n$$\nSubstituting the expressions for $p_{ab}$:\n$$\n2p_{11} + p_{10} = \\frac{2\\theta p^2 + 2p(1-p)}{D} = \\frac{2p(\\theta p + 1 - p)}{D}\n$$\n$$\n2p_{00} + p_{10} = \\frac{2\\theta (1-p)^2 + 2p(1-p)}{D} = \\frac{2(1-p)(\\theta(1-p) + p)}{D}\n$$\nThe ratio becomes:\n$$\n\\frac{k_1}{k_0} = \\frac{1-p}{p} \\frac{2p(\\theta p + 1 - p)/D}{2(1-p)(\\theta(1-p) + p)/D} = \\frac{\\theta p + 1 - p}{\\theta(1-p) + p}\n$$\nThe degrees $k_1$ and $k_0$ are equal if this ratio is $1$:\n$$\n\\theta p + 1 - p = \\theta(1-p) + p \\implies \\theta p + 1 - p = \\theta - \\theta p + p \\implies 2\\theta p - 2p = \\theta - 1 \\implies 2p(\\theta-1) = \\theta-1\n$$\nThis identity holds if $\\theta=1$ (no state preference) or if $2p=1 \\implies p=\\frac{1}{2}$ (equal number of nodes of each state). Generically, if $\\theta \\neq 1$ and $p \\neq \\frac{1}{2}$, then $k_1 \\neq k_0$, which is induced by the same-state bias.\n\n### Part 3: Degree Assortativity Coefficient\n\nThe degree assortativity coefficient $r$ is the Pearson correlation coefficient of the degrees $(K_1, K_2)$ at the ends of a uniformly sampled edge. In this mean-field model, we assume all nodes of the same state have the same expected degree. Let $k_1$ and $k_0$ be the degrees of nodes in state $\\sigma=1$ and $\\sigma=0$, respectively.\n\nTherefore, the degree $K$ of a node is a deterministic function of its state $\\sigma \\in \\{0, 1\\}$:\n$$\nK(\\sigma) = k_0(1-\\sigma) + k_1\\sigma = k_0 + (k_1 - k_0)\\sigma\n$$\nThis shows that the degree $K$ is a linear transformation of the state variable $\\sigma$. The Pearson correlation coefficient is invariant under positive linear transformations of its variables. If we let $(K_1, K_2)$ be the degrees and $(\\sigma_1, \\sigma_2)$ be the states at the ends of an edge, we have:\n$$\nr = \\operatorname{corr}(K_1, K_2) = \\operatorname{corr}(k_0 + (k_1-k_0)\\sigma_1, k_0 + (k_1-k_0)\\sigma_2) = \\operatorname{corr}(\\sigma_1, \\sigma_2)\n$$\nThis latter term is the state assortativity coefficient, which we will denote $r_{state}$. Thus, $r = r_{state}$. This demonstrates that homophily on the state variable directly induces degree assortativity whenever the states have different average degrees ($k_1 \\neq k_0$).\n\nThe state assortativity $r_{state}$ is defined as:\n$$\nr_{state} = \\frac{\\operatorname{cov}(\\sigma_1, \\sigma_2)}{\\operatorname{var}(\\sigma_1)} = \\frac{\\mathbb{E}[\\sigma_1 \\sigma_2] - \\mathbb{E}[\\sigma_1]\\mathbb{E}[\\sigma_2]}{\\mathbb{E}[\\sigma_1^2] - (\\mathbb{E}[\\sigma_1])^2}\n$$\nTo compute this, we need the probabilities related to the states at the ends of a randomly chosen edge. Let $q_1$ be the probability that a random edge end is attached to a state-1 node, and $q_0$ for a state-0 node.\n$$\nq_1 = \\frac{\\text{Total ends on state-1 nodes}}{\\text{Total ends}} = \\frac{M(2p_{11} + p_{10})}{2M} = p_{11} + \\frac{p_{10}}{2}\n$$\n$$\nq_0 = p_{00} + \\frac{p_{10}}{2}\n$$\nFor the binary state variable $\\sigma \\in \\{0, 1\\}$, the expectation and variance are:\n-   $\\mathbb{E}[\\sigma_1] = 1 \\cdot P(\\sigma_1=1) + 0 \\cdot P(\\sigma_1=0) = q_1$. By symmetry, $\\mathbb{E}[\\sigma_2]=q_1$.\n-   $\\mathbb{E}[\\sigma_1^2] = 1^2 \\cdot q_1 + 0^2 \\cdot q_0 = q_1$.\n-   $\\operatorname{var}(\\sigma_1) = \\mathbb{E}[\\sigma_1^2] - (\\mathbb{E}[\\sigma_1])^2 = q_1 - q_1^2 = q_1(1-q_1) = q_1 q_0$.\n\nThe joint expectation $\\mathbb{E}[\\sigma_1\\sigma_2]$ is the probability that both ends of the edge are in state 1, which is by definition the fraction of 1-1 edges, $p_{11}$.\n$$\n\\mathbb{E}[\\sigma_1\\sigma_2] = P(\\sigma_1=1, \\sigma_2=1) = p_{11}\n$$\nThus, the assortativity coefficient is:\n$$\nr = r_{state} = \\frac{p_{11} - q_1^2}{q_1 q_0}\n$$\nNow, we substitute the expressions from Part 1. Let $D=\\theta(p^2 + (1-p)^2) + 2p(1-p)$.\n$p_{11} = \\frac{\\theta p^2}{D}$\n$p_{10} = \\frac{2p(1-p)}{D}$\n$q_1 = p_{11} + \\frac{p_{10}}{2} = \\frac{\\theta p^2 + p(1-p)}{D} = \\frac{p(\\theta p + 1-p)}{D}$\n$q_0 = 1 - q_1 = \\frac{D - p(\\theta p + 1-p)}{D} = \\frac{\\theta p^2 + \\theta(1-p)^2 + 2p(1-p) - \\theta p^2 - p(1-p)}{D} = \\frac{\\theta(1-p)^2 + p(1-p)}{D} = \\frac{(1-p)(\\theta(1-p) + p)}{D}$\n\nThe numerator of $r$ is $p_{11} - q_1^2$:\n$$\np_{11} - q_1^2 = \\frac{\\theta p^2}{D} - \\left(\\frac{p(\\theta p + 1-p)}{D}\\right)^2 = \\frac{D\\theta p^2 - p^2(\\theta p + 1-p)^2}{D^2}\n$$\n$$\n= \\frac{p^2}{D^2} \\left[ D\\theta - (\\theta p + 1-p)^2 \\right]\n$$\n$$\n= \\frac{p^2}{D^2} \\left[ \\theta(\\theta(p^2+(1-p)^2) + 2p(1-p)) - (\\theta p + 1-p)^2 \\right]\n$$\n$$\n= \\frac{p^2}{D^2} \\left[ \\theta^2 p^2 + \\theta^2(1-p)^2 + 2\\theta p(1-p) - (\\theta^2 p^2 + 2\\theta p(1-p) + (1-p)^2) \\right]\n$$\n$$\n= \\frac{p^2}{D^2} \\left[ \\theta^2(1-p)^2 - (1-p)^2 \\right] = \\frac{p^2(1-p)^2(\\theta^2-1)}{D^2}\n$$\nThe denominator of $r$ is $q_1 q_0$:\n$$\nq_1 q_0 = \\frac{p(\\theta p + 1-p)}{D} \\frac{(1-p)(\\theta(1-p) + p)}{D} = \\frac{p(1-p)(\\theta p + 1-p)(\\theta(1-p) + p)}{D^2}\n$$\nFinally, we compute the ratio:\n$$\nr = \\frac{p_{11} - q_1^2}{q_1 q_0} = \\frac{p^2(1-p)^2(\\theta^2-1)/D^2}{p(1-p)(\\theta p + 1-p)(\\theta(1-p)+p)/D^2}\n$$\n$$\nr = \\frac{p(1-p)(\\theta^2-1)}{(\\theta p + 1-p)(\\theta(1-p)+p)}\n$$\nThis is the closed-form analytic expression for the degree assortativity coefficient $r$ in terms of the state fraction $p$ and the homophily parameter $\\theta$.",
            "answer": "$$\n\\boxed{\\frac{p(1-p)(\\theta^2 - 1)}{(\\theta p + 1 - p)(\\theta(1-p) + p)}}\n$$"
        },
        {
            "introduction": "Moving from a static equilibrium to a fully dynamic interplay, this practice problem explores a classic case of coevolution: the spread of a disease on an adaptive network. Here, the network's structure changes in response to the epidemic state of its nodes, creating a feedback loop where epidemiology and topology are deeply intertwined. By performing a linear stability analysis of the disease-free equilibrium , you will learn a powerful analytical technique and gain insight into how adaptive rewiring can alter critical thresholds for disease invasion.",
            "id": "4268917",
            "problem": "Consider an adaptive susceptible-infected-susceptible (SIS) process on a large undirected network with a fixed number of nodes $N$ and a fixed number of edges $L$. Initially, the network is $3$-regular, so the mean degree is $k = 3$ and $L = \\frac{k N}{2} = \\frac{3 N}{2}$. The state of each node is either susceptible ($S$) or infected ($I$). The dynamics consist of three independent Poisson processes: (i) infection along each $SI$ edge at rate $\\beta$, turning the susceptible endpoint into infected; (ii) recovery of each infected node at rate $\\gamma$, turning it into susceptible; and (iii) selective rewiring at rate $\\omega$ on each $SI$ edge, where the susceptible endpoint cuts the edge and reconnects to a uniformly randomly chosen susceptible node (self-loops and multi-edges are negligible in the large-$N$ limit), thereby preserving $L$.\n\nUse the pairwise moment variables $[X]$ for the number of nodes in state $X \\in \\{S, I\\}$ and $[XY]$ for the number of undirected edges between states $X, Y \\in \\{S, I\\}$, with $[SI] = [IS]$. Let $[XYZ]$ denote the number of connected triples $X$-$Y$-$Z$ with $Y$ in the center. Assume homogeneous mixing at the level of pairs and adopt the standard homogeneous pair-approximation closure\n$$\n[XYZ] \\approx \\frac{k-1}{k} \\,\\frac{[XY]\\,[YZ]}{[Y]} \\, .\n$$\nWork near the disease-free equilibrium (DFE), defined by $[I] = 0$, $[SI] = 0$, $[II] = 0$, $[S] = N$, and $[SS] = L$, and linearize the dynamics in the small deviations of $[I]$, $[SI]$, and $[II]$ from the DFE. Use only terms up to first order in these small deviations and use $[SS]/[S] = k/2$ at the DFE.\n\nStarting from the event-level rules above and conservation of total edges, construct the linearized pairwise ordinary differential equations (ODEs) for the vector $([I], [SI], [II])^{\\top}$, compute the Jacobian matrix $J$ at the DFE, and then compute the dominant eigenvalue (the eigenvalue with the largest real part) $\\lambda_{\\max}$ of $J$ as an explicit simplified function of $\\beta$, $\\gamma$, and $\\omega$. Your final answer must be a single closed-form analytic expression in terms of $\\beta$, $\\gamma$, and $\\omega$ only. Do not include any units.",
            "solution": "The problem is first validated against the specified criteria.\n\n### Step 1: Extract Givens\n-   **System**: An adaptive susceptible-infected-susceptible (SIS) process on a large undirected network.\n-   **Network Properties**:\n    -   Fixed number of nodes, $N$.\n    -   Fixed number of edges, $L$.\n    -   Initially $3$-regular, so the mean degree is $k=3$.\n    -   The number of edges is $L = \\frac{k N}{2} = \\frac{3 N}{2}$.\n-   **Node States**: Susceptible ($S$) or Infected ($I$).\n-   **Dynamical Processes (independent Poisson)**:\n    -   **(i) Infection**: For each $S-I$ edge, the $S$ node becomes $I$ at rate $\\beta$.\n    -   **(ii) Recovery**: Each $I$ node becomes $S$ at rate $\\gamma$.\n    -   **(iii) Rewiring**: For each $S-I$ edge, the $S$ endpoint cuts the edge and reconnects to a uniformly randomly chosen $S$ node at rate $\\omega$. The total number of edges $L$ is preserved.\n-   **Variables and Notation**:\n    -   $[X]$: Number of nodes in state $X \\in \\{S, I\\}$.\n    -   $[XY]$: Number of undirected edges between nodes in states $X, Y \\in \\{S, I\\}$.\n    -   $[XYZ]$: Number of connected triples $X-Y-Z$.\n-   **Approximations and Assumptions**:\n    -   Pairwise moment-closure approximation: $[XYZ] \\approx \\frac{k-1}{k} \\frac{[XY][YZ]}{[Y]}$.\n    -   The analysis is performed near the disease-free equilibrium (DFE).\n    -   DFE is defined by $[I]=0$, $[SI]=0$, $[II]=0$, $[S]=N$, and $[SS]=L$.\n    -   The dynamics are linearized, keeping only terms up to first order in the small deviations of $[I]$, $[SI]$, and $[II]$ from the DFE.\n    -   At the DFE, $[SS]/[S] = k/2$.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem describes a standard adaptive SIS model on a network, a well-established topic within network science and mathematical epidemiology. The use of pairwise approximations and linearization are standard techniques for analyzing such systems.\n-   **Well-Posed**: The problem is clearly formulated. It specifies the model, the mathematical framework (pairwise ODEs), the approximation to use (closure), and the quantity to be calculated (the dominant eigenvalue of the Jacobian at the DFE). A unique, meaningful solution is expected.\n-   **Objective**: The problem is stated in precise, mathematical terms, free from any subjective or ambiguous language.\n-   **Completeness and Consistency**: The problem provides all necessary information: the network structure ($k=3$), the rates of all processes ($\\beta, \\gamma, \\omega$), and the specific form of the closure approximation. The givens are self-consistent. For example, $L = 3N/2$ is consistent with a $3$-regular network. The specified DFE state is consistent with a disease-free network.\n-   **No other flaws**: The problem does not violate any of the other criteria for invalidity. It is not trivial, metaphorical, or unfalsifiable.\n\n### Step 3: Verdict and Action\nThe problem is valid. The solution process will now proceed.\n\nWe begin by constructing the ordinary differential equations (ODEs) for the number of infected nodes, $[I]$, and the number of edges, $[SI]$ and $[II]$.\n\nThe rate of change of the number of infected nodes, $[I]$, is given by the balance between infection and recovery events:\n$$\n\\frac{d[I]}{dt} = \\beta[SI] - \\gamma[I]\n$$\n\nNext, we determine the rate of change for the number of $S-I$ edges, $[SI]$. We analyze the effect of each process:\n1.  **Infection**: An infection event occurs along an $S-I$ link. Let the link be $S_1-I_2$. The node $S_1$ becomes infected. The original $S_1-I_2$ edge becomes an $I-I$ edge, so $[SI]$ decreases by $1$. The other neighbors of $S_1$ now have their links changed. An $S-S$ edge connected to $S_1$ becomes an $I-S$ edge, increasing $[SI]$. An $S-I$ edge connected to $S_1$ becomes an $I-I$ edge, decreasing $[SI]$.\n    The average number of $S$ neighbors for an $S$ node that is part of an $S-I$ link is given by $\\frac{[SSI]}{[SI]}$. Using the closure, this is $\\frac{k-1}{k}\\frac{[SS]}{[S]}$.\n    The average number of $I$ neighbors for an $S$ node that is part of an $S-I$ link is given by $\\frac{[ISI]}{[SI]}$. Using the closure, this is $\\frac{k-1}{k}\\frac{[SI]}{[S]}$.\n    The total change in $[SI]$ per infection event is $-1 + \\frac{k-1}{k}\\frac{[SS]}{[S]} - \\frac{k-1}{k}\\frac{[SI]}{[S]}$. The total rate of change from infection is $\\beta[SI]\\left(-1 + \\frac{k-1}{k}\\frac{[SS]}{[S]} - \\frac{k-1}{k}\\frac{[SI]}{[S]}\\right)$.\n2.  **Recovery**: An infected node $I$ becomes susceptible $S$. An $I-I$ edge connected to it becomes an $S-I$ edge, increasing $[SI]$. An $S-I$ edge connected to it becomes an $S-S$ edge, decreasing $[SI]$. The average number of $I-I$ links per infected node is $2[II]/[I]$, and the average number of $S-I$ links is $[SI]/[I]$. The total rate of change from recovery is $\\gamma[I]\\left(\\frac{2[II]}{[I]} - \\frac{[SI]}{[I]}\\right) = \\gamma(2[II] - [SI])$.\n3.  **Rewiring**: An $S-I$ edge is removed, and the $S$ node creates a new $S-S$ edge. This converts one $S-I$ edge into one $S-S$ edge, decreasing $[SI]$ by $1$. The total rate of change from rewiring is $-\\omega[SI]$.\n\nCombining these terms gives the ODE for $[SI]$:\n$$\n\\frac{d[SI]}{dt} = \\beta[SI]\\left(\\frac{k-1}{k}\\frac{[SS]}{[S]} - 1 - \\frac{k-1}{k}\\frac{[SI]}{[S]}\\right) + \\gamma(2[II] - [SI]) - \\omega[SI]\n$$\n\nFinally, we determine the rate of change for the number of $I-I$ edges, $[II]$:\n1.  **Infection**: The activating $S-I$ edge becomes an $I-I$ edge. Other $S-I$ edges connected to the newly infected node also become $I-I$ edges. The change in $[II]$ per infection event is $1 + \\frac{[ISI]}{[SI]} = 1 + \\frac{k-1}{k}\\frac{[SI]}{[S]}$. The total rate of change from infection is $\\beta[SI]\\left(1 + \\frac{k-1}{k}\\frac{[SI]}{[S]}\\right)$.\n2.  **Recovery**: When an $I$ node recovers, its $I-I$ edges become $S-I$ edges. An average of $2[II]/[I]$ such edges are lost. The total rate is $\\gamma[I](-2[II]/[I]) = -2\\gamma[II]$.\n3.  **Rewiring**: This process does not create or destroy $I-I$ edges.\n\nThe ODE for $[II]$ is:\n$$\n\\frac{d[II]}{dt} = \\beta[SI]\\left(1 + \\frac{k-1}{k}\\frac{[SI]}{[S]}\\right) - 2\\gamma[II]\n$$\n\nWe now linearize these equations around the DFE. Let $[I]=\\epsilon_I$, $[SI]=\\epsilon_{SI}$, and $[II]=\\epsilon_{II}$ be small deviations. We have $[S] = N - \\epsilon_I$ and, from the conservation of edges $L = [SS] + [SI] + [II]$, we have $[SS] = L - \\epsilon_{SI} - \\epsilon_{II}$. We keep only terms up to first order.\n\nFor the first ODE:\n$$\n\\frac{d\\epsilon_I}{dt} = \\beta\\epsilon_{SI} - \\gamma\\epsilon_I\n$$\nThis ODE is already linear.\n\nFor the $[SI]$ ODE, we linearize the coefficient of $\\beta\\epsilon_{SI}$. The term inside the parenthesis becomes:\n$$\n\\frac{k-1}{k}\\frac{L - \\epsilon_{SI} - \\epsilon_{II}}{N - \\epsilon_I} - 1 - \\frac{k-1}{k}\\frac{\\epsilon_{SI}}{N - \\epsilon_I} \\approx \\frac{k-1}{k}\\frac{L}{N} - 1 + O(\\epsilon) = \\frac{k-1}{k}\\frac{k}{2} - 1 = \\frac{k-1}{2} - 1 = \\frac{k-3}{2}\n$$\nThe problem specifies $k=3$, so this term is $\\frac{3-3}{2} = 0$. The linearized ODE for $\\epsilon_{SI}$ is:\n$$\n\\frac{d\\epsilon_{SI}}{dt} = \\beta\\epsilon_{SI}(0) + \\gamma(2\\epsilon_{II} - \\epsilon_{SI}) - \\omega\\epsilon_{SI} = -(\\gamma + \\omega)\\epsilon_{SI} + 2\\gamma\\epsilon_{II}\n$$\n\nFor the $[II]$ ODE, the term in the parenthesis is $1 + \\frac{k-1}{k}\\frac{\\epsilon_{SI}}{N - \\epsilon_I} = 1 + O(\\epsilon)$. So, the linearized equation is:\n$$\n\\frac{d\\epsilon_{II}}{dt} = \\beta\\epsilon_{SI}(1) - 2\\gamma\\epsilon_{II} = \\beta\\epsilon_{SI} - 2\\gamma\\epsilon_{II}\n$$\n\nThe linearized system for the state vector $(\\epsilon_I, \\epsilon_{SI}, \\epsilon_{II})^{\\top}$ is:\n$$\n\\frac{d}{dt}\\begin{pmatrix} \\epsilon_I \\\\ \\epsilon_{SI} \\\\ \\epsilon_{II} \\end{pmatrix} =\n\\begin{pmatrix}\n-\\gamma & \\beta & 0 \\\\\n0 & -(\\gamma+\\omega) & 2\\gamma \\\\\n0 & \\beta & -2\\gamma\n\\end{pmatrix}\n\\begin{pmatrix} \\epsilon_I \\\\ \\epsilon_{SI} \\\\ \\epsilon_{II} \\end{pmatrix}\n$$\nThe matrix in this equation is the Jacobian $J$ at the DFE.\n$$\nJ = \\begin{pmatrix}\n-\\gamma & \\beta & 0 \\\\\n0 & -(\\gamma+\\omega) & 2\\gamma \\\\\n0 & \\beta & -2\\gamma\n\\end{pmatrix}\n$$\nTo find the eigenvalues $\\lambda$ of $J$, we solve the characteristic equation $\\det(J - \\lambda I) = 0$:\n$$\n\\det \\begin{pmatrix}\n-\\gamma - \\lambda & \\beta & 0 \\\\\n0 & -(\\gamma+\\omega) - \\lambda & 2\\gamma \\\\\n0 & \\beta & -2\\gamma - \\lambda\n\\end{pmatrix} = 0\n$$\nSince the matrix is block upper-triangular, the determinant is the product of the determinants of the diagonal blocks:\n$$\n(-\\gamma - \\lambda) \\det \\begin{pmatrix}\n-(\\gamma+\\omega) - \\lambda & 2\\gamma \\\\\n\\beta & -2\\gamma - \\lambda\n\\end{pmatrix} = 0\n$$\nOne eigenvalue is immediately found to be $\\lambda_1 = -\\gamma$.\nThe other two eigenvalues are the roots of the characteristic equation of the $2 \\times 2$ submatrix:\n$$\n(-(\\gamma+\\omega) - \\lambda)(-2\\gamma - \\lambda) - (2\\gamma)(\\beta) = 0\n$$\n$$\n(\\lambda + \\gamma + \\omega)(\\lambda + 2\\gamma) - 2\\gamma\\beta = 0\n$$\n$$\n\\lambda^2 + (3\\gamma + \\omega)\\lambda + 2\\gamma(\\gamma+\\omega) - 2\\gamma\\beta = 0\n$$\nWe solve for $\\lambda$ using the quadratic formula:\n$$\n\\lambda = \\frac{-(3\\gamma + \\omega) \\pm \\sqrt{(3\\gamma + \\omega)^2 - 4(2\\gamma(\\gamma+\\omega-\\beta))}}{2}\n$$\n$$\n\\lambda = \\frac{-(3\\gamma + \\omega) \\pm \\sqrt{9\\gamma^2 + 6\\gamma\\omega + \\omega^2 - 8\\gamma^2 - 8\\gamma\\omega + 8\\gamma\\beta}}{2}\n$$\n$$\n\\lambda = \\frac{-(3\\gamma + \\omega) \\pm \\sqrt{\\gamma^2 - 2\\gamma\\omega + \\omega^2 + 8\\gamma\\beta}}{2}\n$$\n$$\n\\lambda = \\frac{-(3\\gamma + \\omega) \\pm \\sqrt{(\\gamma - \\omega)^2 + 8\\gamma\\beta}}{2}\n$$\nThe three eigenvalues are:\n$$\n\\lambda_1 = -\\gamma\n$$\n$$\n\\lambda_2 = \\frac{-(3\\gamma + \\omega) - \\sqrt{(\\gamma - \\omega)^2 + 8\\gamma\\beta}}{2}\n$$\n$$\n\\lambda_3 = \\frac{-(3\\gamma + \\omega) + \\sqrt{(\\gamma - \\omega)^2 + 8\\gamma\\beta}}{2}\n$$\nThe parameters $\\beta$, $\\gamma$, and $\\omega$ are non-negative rates.\n$\\lambda_1 = -\\gamma$ is negative (or zero if $\\gamma=0$).\n$\\lambda_2$ is clearly negative as it is the sum of two negative terms.\n$\\lambda_3$ is the only eigenvalue that can be positive, and thus it must be the dominant eigenvalue, $\\lambda_{\\max}$. The DFE is unstable if $\\lambda_{\\max} > 0$, leading to an epidemic outbreak.\n\nTherefore, the dominant eigenvalue is:\n$$\n\\lambda_{\\max} = \\frac{-(3\\gamma + \\omega) + \\sqrt{(\\gamma - \\omega)^2 + 8\\gamma\\beta}}{2}\n$$",
            "answer": "$$\\boxed{\\frac{-(3\\gamma + \\omega) + \\sqrt{(\\gamma - \\omega)^{2} + 8\\gamma\\beta}}{2}}$$"
        },
        {
            "introduction": "Finally, we examine the long-term, emergent consequences of coevolutionary dynamics. This problem models how opinion formation coupled with homophily-driven rewiring can lead to the large-scale fragmentation of a social network, a phenomenon often observed in polarized societies. By applying the Molloy-Reed criterion from random graph theory , you will determine the conditions under which the network shatters into disconnected opinion-based communities, thereby demonstrating how local adaptive rules can fundamentally reshape global connectivity and prevent the system from reaching consensus.",
            "id": "4268930",
            "problem": "Consider an undirected, simple, connected network of $N$ nodes generated by the configuration model with a Poisson degree distribution of mean degree $\\langle k \\rangle = k > 1$. Each node holds one of two opinions $s \\in \\{+1,-1\\}$. A fraction $z$ of nodes are zealots with fixed opinions; assume symmetry so that $z/2$ of the nodes are zealots with $s=+1$ and $z/2$ are zealots with $s=-1$. The remaining fraction $1-z$ are susceptible nodes that can change opinion. The dynamics proceeds as follows: at each step, a disagreeing edge (connecting two nodes with opposite opinions) is selected uniformly at random. If one of the endpoints is susceptible, then with probability $w \\in (0,1]$ the susceptible endpoint rewires the edge to a randomly selected node of the same opinion as itself (uniformly among all nodes of that opinion), and with probability $1-w$ the susceptible endpoint adopts the neighbor's opinion. Zealot nodes never change their opinion and never initiate rewiring; rewiring events are initiated only by susceptible nodes as described. Assume the infinite-size limit $N \\to \\infty$ and continuous time scaling so that the system evolves deterministically under mean-field approximations.\n\nStarting from a random initial assignment of opinions in which susceptible nodes are equally likely to be $+1$ or $-1$, and the initial network has no degree–opinion correlation, analyze the coevolutionary outcome as $t \\to \\infty$ under the above homophily rewiring rule.\n\nUsing only foundational facts about random graphs, particularly the Molloy–Reed criterion that a configuration-model random graph with degree distribution $\\{p_k\\}$ has a giant component if and only if $\\sum_{k} k(k-2)p_k > 0$, derive the following:\n\n1. Explain why the presence of zealots changes the coevolutionary outcome relative to the zealot-free case when $w>0$. Your explanation must be grounded in how homophily rewiring transforms the network’s component structure in the absorbing state.\n\n2. By considering the absorbing state reached when all disagreeing edges have been eliminated through homophily rewiring for any $w>0$, compute the effective mean degree within the susceptible subgraph, and then use the Molloy–Reed criterion to obtain a closed-form expression for the minimum zealot fraction $z_{\\min}$ that guarantees the susceptible subgraph does not contain a giant component. Interpret this condition as sufficient to prevent global consensus among susceptible nodes, because opinion changes cannot propagate across disconnected finite components. Provide your final expression for $z_{\\min}$ as a function of $k$.\n\nYour final answer must be a single closed-form analytic expression with no units. No rounding is required.",
            "solution": "The problem asks for an analysis of a coevolutionary opinion dynamics model on an adaptive network, specifically to explain the role of zealots and to calculate the minimum fraction of zealots, $z_{\\min}$, required to prevent the formation of a giant component within the susceptible sub-population.\n\nThe validation steps confirm the problem is scientifically grounded, well-posed, and objective. It is a standard problem in network science that can be solved using the provided tools and assumptions.\n\n**Part 1: The Role of Zealots in the Coevolutionary Outcome**\n\nIn this model, two processes occur: opinion adoption (with probability $1-w$) and homophily-driven network rewiring (with probability $w$). The system evolves towards an absorbing state where no disagreeing edges remain. An edge is a disagreeing edge if it connects nodes with opposite opinions ($s=+1$ and $s=-1$).\n\nIn the absorbing state, the network is necessarily partitioned into subgraphs where each subgraph is monochromatic, i.e., all nodes within it share the same opinion. All connections are homophilous.\n\nIn the zealot-free case ($z=0$), all nodes are susceptible. While homophilic rewiring ($w>0$) promotes fragmentation into monochromatic components, the process of opinion adoption ($1-w>0$) promotes consensus. The final state depends on the competition between these forces. It is possible for the entire network to reach a state of global consensus (all nodes becoming $+1$ or all becoming $-1$) if opinion adoption dynamics dominate before the network fully fragments.\n\nThe introduction of zealots ($z>0$) fundamentally alters this outcome. By definition, zealots have fixed opinions. The problem specifies a symmetric distribution of zealots: a fraction $z/2$ are fixed at $s=+1$ and a fraction $z/2$ are fixed at $s=-1$. This has a critical consequence: global consensus is no longer possible. The existence of even one $+1$ zealot and one $-1$ zealot guarantees that both opinions will persist in the system indefinitely.\n\nWhen rewiring occurs ($w>0$), a susceptible node at one end of a disagreeing edge breaks that connection and forms a new one with a randomly chosen node of its own opinion. In the absorbing state, where no disagreeing edges are left, any susceptible node must be connected only to nodes of its own opinion. These neighbors can be other susceptibles or zealots.\n\nTherefore, the zealots act as immutable anchors or \"cores\" for opinion clusters. Every $+1$ zealot becomes part of a component composed exclusively of $+1$ nodes. Similarly, every $-1$ zealot becomes part of a component of $-1$ nodes. As the system evolves, susceptible nodes, through a combination of opinion adoption and rewiring, are ultimately assimilated into one of these monochromatic clusters. The rewiring mechanism ($w>0$) physically severs the connections between these emerging opinion blocs, guaranteeing that the final network state is fragmented along opinion lines. Without zealots, such fragmentation is only one possible outcome, with global consensus being another. With zealots of opposing views, fragmentation into at least two macroscopically separated opinion groups becomes the only possible absorbing state.\n\n**Part 2: Calculation of the Minimum Zealot Fraction $z_{\\min}$**\n\nWe seek the condition under which the subgraph consisting only of susceptible nodes, which we denote $G_S$, does not contain a giant component in the $N \\to \\infty$ limit. The analysis is performed on the absorbing state where all edges are homophilous.\n\nThe original network is generated by the configuration model with a Poisson degree distribution $p_k = e^{-k}k^k/k!$, where $\\langle k \\rangle = k$ is the mean degree. In the absorbing state, a susceptible node is connected only to nodes of its own opinion. These neighbors can be other susceptible nodes or zealots.\n\nUnder the mean-field assumption, the new neighbor chosen during a rewiring event is selected uniformly at random from all nodes sharing the opinion of the rewiring node. By symmetry, we can analyze either the $+1$ or $-1$ opinion group. Let's consider the nodes with opinion $+1$. The total number of nodes with this opinion consists of $N(1-z)/2$ susceptibles (assuming symmetric distribution in the final state) and $Nz/2$ zealots. The total number of $+1$ nodes is $N(1-z)/2 + Nz/2 = N/2$. The fraction of susceptible nodes within this $+1$ opinion pool is $\\frac{N(1-z)/2}{N/2} = 1-z$.\n\nTherefore, in the final homophilous state, any given edge originating from a susceptible node has a probability $p_{s \\to s} = 1-z$ of connecting to another susceptible node and a probability $p_{s \\to z} = z$ of connecting to a zealot.\n\nThis process is equivalent to randomly removing edges from the original network. Specifically, an edge is kept within the susceptible subgraph $G_S$ only if it connects two susceptible nodes. For a susceptible node with an original degree $k_i$, each of its $k_i$ edges remains an edge within $G_S$ with probability $1-z$. The degree $k'_i$ of this node within the subgraph $G_S$ follows a binomial distribution: $k'_i \\sim \\text{Binomial}(k_i, 1-z)$. This process is known as binomial thinning of the degree sequence.\n\nThe new degree distribution $p'_{k'}$ of the susceptible subgraph $G_S$ is given by:\n$$p'_{j} = \\sum_{i=j}^{\\infty} p_i \\binom{i}{j} (1-z)^{j} z^{i-j}$$\nTo determine if $G_S$ has a giant component, we use the Molloy–Reed criterion, which states that a giant component exists if and only if $Q' = \\sum_{j} j(j-2) p'_{j} > 0$. We need to find the condition for which $Q' \\le 0$. The expression for $Q'$ can be written in terms of the moments of the new distribution:\n$$Q' = \\langle k'^2 \\rangle - 2\\langle k' \\rangle \\le 0$$\nWe can compute the moments of the thinned distribution $p'_{j}$ in terms of the moments of the original distribution $p_i$.\nThe mean of the new distribution is:\n$$\\langle k' \\rangle = \\sum_j j p'_j = \\sum_i p_i \\left( \\sum_j j \\binom{i}{j} (1-z)^j z^{i-j} \\right)$$\nThe inner sum is the expectation of a $\\text{Binomial}(i, 1-z)$ random variable, which is $i(1-z)$.\n$$\\langle k' \\rangle = \\sum_i p_i (i(1-z)) = (1-z) \\sum_i i p_i = (1-z)\\langle k \\rangle$$\nThe second moment is:\n$$\\langle k'^2 \\rangle = \\sum_j j^2 p'_j = \\sum_i p_i \\left( \\sum_j j^2 \\binom{i}{j} (1-z)^j z^{i-j} \\right)$$\nThe inner sum is the second moment of a $\\text{Binomial}(i, 1-z)$ variable. The variance is $i(1-z)z$, so the second moment is $\\text{Var} + \\text{Mean}^2 = i(1-z)z + (i(1-z))^2$.\n$$\\langle k'^2 \\rangle = \\sum_i p_i (i(1-z)z + i^2(1-z)^2) = (1-z)z \\langle k \\rangle + (1-z)^2 \\langle k^2 \\rangle$$\nNow substitute these moments into the Molloy–Reed condition $Q' \\le 0$:\n$$ (1-z)z \\langle k \\rangle + (1-z)^2 \\langle k^2 \\rangle - 2(1-z)\\langle k \\rangle \\le 0 $$\nSince $z<1$, we can divide by the positive factor $(1-z)$:\n$$ z \\langle k \\rangle + (1-z) \\langle k^2 \\rangle - 2 \\langle k \\rangle \\le 0 $$\nFor the given Poisson degree distribution, we have $\\langle k \\rangle = k$ and the variance is $\\text{Var}(k) = k$, which implies $\\langle k^2 \\rangle = \\text{Var}(k) + \\langle k \\rangle^2 = k + k^2$.\nSubstituting these into the inequality:\n$$ zk + (1-z)(k+k^2) - 2k \\le 0 $$\n$$ zk + k + k^2 - zk - zk^2 - 2k \\le 0 $$\n$$ k^2 - k - zk^2 \\le 0 $$\n$$ k^2(1-z) - k \\le 0 $$\nSince the problem states $k > 1$, we can divide by $k$:\n$$ k(1-z) - 1 \\le 0 $$\n$$ k(1-z) \\le 1 $$\n$$ 1-z \\le \\frac{1}{k} $$\n$$ z \\ge 1 - \\frac{1}{k} $$\nThe minimum fraction of zealots $z_{\\min}$ that guarantees the susceptible subgraph does not contain a giant component is the value that makes this an equality.\n$$ z_{\\min} = 1 - \\frac{1}{k} $$\nThis condition ensures that the effective connectivity within the susceptible population is reduced to a point where large-scale opinion propagation is impossible. The term $k(1-z)$ can be interpreted as the effective branching factor for a cascade process on the susceptible network; setting this value to be at most $1$ ensures that any cascade will die out, thus preventing the formation of a giant component and global consensus among susceptibles.",
            "answer": "$$\\boxed{1-\\frac{1}{k}}$$"
        }
    ]
}