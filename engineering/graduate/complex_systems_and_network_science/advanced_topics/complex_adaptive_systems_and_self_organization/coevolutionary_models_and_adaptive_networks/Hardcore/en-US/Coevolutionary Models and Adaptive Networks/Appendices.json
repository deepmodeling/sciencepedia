{
    "hands_on_practices": [
        {
            "introduction": "A fundamental skill in modeling coevolutionary systems is deriving macroscopic equations of motion from microscopic interaction rules. This practice guides you through this process for the classic Adaptive Voter Model (AVM), a paradigm for studying the interplay between opinion formation and social network structure. By applying the pair approximation technique, you will develop a closed system of differential equations that captures the system's dynamics, providing a hands-on understanding of how mean-field theories are constructed and used to predict collective behavior. ",
            "id": "4269268",
            "problem": "Consider the Adaptive Voter Model (AVM) on a degree-regular random network with $N$ nodes and mean degree $k$, constructed as a configuration model without degree correlations. Each node holds one of two opinions, denoted $A$ and $B$. Let $[A]$ and $[B]$ denote the fractions of nodes in states $A$ and $B$, respectively, and let $[AA]$, $[AB]$, and $[BB]$ denote the fractions of edges of types $AA$, $AB$, and $BB$, respectively, all normalized by the total number of edges. The dynamics proceeds in continuous time as follows: each discordant edge $AB$ is selected at rate $1$; upon selection, with probability $w \\in (0,1)$, a rewiring occurs, where one end is chosen uniformly at random and reconnects to a uniformly random node of the same opinion as itself (avoiding self-loops and multiple edges), and with probability $1-w$, an imitation event occurs, where one end is chosen uniformly at random and adopts the other node’s opinion.\n\nStarting from the core definitions of edge and node densities, conservation of stubs in the configuration model, and the law of total probability, use a pair approximation to derive a closed system of ordinary differential equations (ODEs) for the time evolution of $[A]$, $[B]$, $[AA]$, $[AB]$, and $[BB]$. Clearly state the closure you employ for triplet densities and conditional neighbor compositions, and express any conditional probabilities you introduce entirely in terms of $[A]$, $[B]$, and $[AB]$.\n\nThen, using your derived ODEs, determine the nontrivial steady-state value of the discordant edge density $[AB]^{\\ast}$ in the statistically symmetric active phase with $[A]=[B]=\\tfrac{1}{2}$, as a function of $k$ and $w$. Provide your final answer as a single closed-form expression for $[AB]^{\\ast}$ in simplest analytic form. No rounding is required, and no units are involved.",
            "solution": "The user wants a solution to a problem about the Adaptive Voter Model.\n\n### Step 1: Problem Validation\n\n**1. Extract Givens:**\n- **Model:** Adaptive Voter Model (AVM) on a degree-regular random network.\n- **Network Parameters:** $N$ nodes, degree $k$ for all nodes. The network is a configuration model without degree correlations.\n- **Node States:** Two opinions, $A$ and $B$.\n- **Node Densities:** $[A]$ and $[B]$ are the fractions of nodes in states $A$ and $B$.\n- **Edge Densities:** $[AA]$, $[AB]$, and $[BB]$ are the fractions of $AA$, $AB$, and $BB$ edges, normalized by the total number of edges $E = Nk/2$.\n- **Dynamics:**\n    - A discordant edge $AB$ is selected at a rate of $1$ per edge. The total rate of events is $E_{AB}$, the number of $AB$ edges.\n    - With probability $w \\in (0,1)$, a rewiring event occurs: one of the two nodes at the ends of the selected edge is chosen uniformly at random, and it disconnects from the other node and reconnects to a uniformly random node of its own opinion. Self-loops and multiple edges are avoided.\n    - With probability $1-w$, an imitation event occurs: one of the two nodes at the ends of the selected edge is chosen uniformly at random and adopts the other node's opinion.\n\n- **Task 1:** Derive a closed system of Ordinary Differential Equations (ODEs) for the time evolution of $[A]$, $[B]$, $[AA]$, $[AB]$, and $[BB]$ using a pair approximation. This includes stating the closure employed and expressing conditional probabilities in terms of $[A]$, $[B]$, and $[AB]$.\n- **Task 2:** Determine the nontrivial steady-state value of the discordant edge density, denoted $[AB]^{\\ast}$, in the statistically symmetric active phase where $[A]=[B]=1/2$. The result should be a function of $k$ and $w$.\n\n**2. Validate Using Extracted Givens:**\n- **Scientifically Grounded:** The problem describes the Adaptive Voter Model, a canonical model in the study of coevolutionary networks and complex systems. The formulation is standard and scientifically sound.\n- **Well-Posed:** The problem is well-posed. It requests a derivation using a specified, standard approximation method (pair approximation) and the calculation of a steady-state solution, which is a solvable task.\n- **Objective:** The problem is formulated in precise, objective, and mathematical language.\n- **Conclusion:** The problem does not violate any of the invalidity criteria. It is a valid, non-trivial problem in theoretical physics/complex systems.\n\n### Step 2: Derivation of the Solution\n\n**Conservation Laws and Definitions**\nLet $N_A = N[A]$ and $N_B = N[B]$ be the number of nodes of type $A$ and $B$, respectively. Let $E_{AA}$, $E_{AB}$, $E_{BB}$ be the number of edges of each type. The total number of edges is $E = Nk/2$ for a $k$-regular network. The edge densities are $[XY] = E_{XY}/E$.\n\nThe node and edge densities are related by conservation of \"stubs\". The total number of edge ends (stubs) emanating from $A$-nodes is $k N_A$. These stubs connect to either $A$ or $B$ nodes. Each $AA$ edge accounts for two such stubs, and each $AB$ edge accounts for one.\n$k N_A = 2E_{AA} + E_{AB}$\nDividing by $Nk$:\n$[A] = \\frac{2E_{AA}}{Nk} + \\frac{E_{AB}}{Nk} = \\frac{2E[AA]}{Nk} + \\frac{E[AB]}{Nk}$\nSubstituting $E=Nk/2$:\n$[A] = \\frac{2(Nk/2)[AA]}{Nk} + \\frac{(Nk/2)[AB]}{Nk} = [AA] + \\frac{1}{2}[AB]$\nSimilarly, for $B$-nodes:\n$[B] = [BB] + \\frac{1}{2}[AB]$\nSumming these gives $[A]+[B] = [AA]+[AB]+[BB]$, which is consistent with the total conservation of nodes and edges ($1=1$). These relations allow us to describe the system's state using only $[A]$ and $[AB]$.\n\n**Time Evolution of $[A]$**\nThe density of A-nodes, $[A]$, changes only through imitation events. In an imitation event, an $AB$ edge is selected, and one node is chosen randomly to copy the other's state. If the $A$ node is chosen, it becomes $B$ ($N_A \\to N_A-1$). If the $B$ node is chosen, it becomes $A$ ($N_A \\to N_A+1$). As both choices are equally likely (with probability $1/2$), the expected change in $N_A$ is zero.\n$$ \\frac{d N_A}{dt} \\propto (1-w) \\left( \\frac{1}{2} \\times (-1) + \\frac{1}{2} \\times (+1) \\right) = 0 $$\nThus, $[A]$ (and $[B]$) are conserved quantities in this model.\n$$ \\frac{d[A]}{dt} = 0 \\quad \\text{and} \\quad \\frac{d[B]}{dt} = 0 $$\n\n**Time Evolution of $[AB]$**\nWe derive the ODE for the density of discordant edges, $[AB]$. Let's use the variable $\\theta(t) = [AB](t)$. The total number of $AB$ edges is $E_{AB} = E\\theta = \\frac{Nk}{2}\\theta$.\nThe dynamics is triggered by selecting a discordant edge. The total rate of events is $E_{AB}$.\nWe calculate the rate of change of $E_{AB}$ by summing the effects of all processes.\n$$ \\frac{dE_{AB}}{dt} = (\\text{Rate of Creation of AB edges}) - (\\text{Rate of Destruction of AB edges}) $$\nAn $AB$ edge is destroyed whenever it is selected for either imitation or rewiring. The total rate of selection is $E_{AB}$. Therefore, the rate of destruction of the focal $AB$ edge is $E_{AB}$.\n$$ (\\text{Rate of Destruction})_{focal} = E_{AB} $$\n$AB$ edges are also created and destroyed as a side-effect of imitation, when a node changes its state and this alters the types of edges connected to it. Rewiring does not change node states, so it does not have this side-effect.\n\nLet's analyze the imitation process. An $AB$ edge $(u,v)$ (with $u \\in A, v \\in B$) is selected. The rate of imitation events is $(1-w)E_{AB}$.\n1.  With probability $1/2$, node $u$ is chosen to flip state from $A$ to $B$. This occurs at a rate of $\\frac{1-w}{2}E_{AB}$. When $u$ flips, its $k-1$ other edges are affected.\n2.  With probability $1/2$, node $v$ is chosen to flip state from $B$ to $A$. This occurs at a rate of $\\frac{1-w}{2}E_{AB}$. When $v$ flips, its $k-1$ other edges are affected.\n\nTo calculate the change, we need the conditional probabilities of a neighbor's state. This is where the pair approximation is used. The closure assumes that the neighborhood of a node is random, conditioned only on the node's state. The state of one neighbor is assumed to be independent of the state of other neighbors.\nThe probability that a random neighbor of an $A$-node is a $B$-node is:\n$$ P(B|A) = \\frac{\\text{Number of stubs from A to B}}{\\text{Total stubs from A}} = \\frac{E_{AB}}{kN_A} = \\frac{E[AB]}{kN[A]} = \\frac{(Nk/2)[AB]}{kN[A]} = \\frac{[AB]}{2[A]} $$\nSimilarly,\n$$ P(A|A) = \\frac{2E_{AA}}{kN_A} = \\frac{2E[AA]}{kN[A]} = \\frac{[AA]}{[A]} = \\frac{[A] - [AB]/2}{[A]} = 1 - \\frac{[AB]}{2[A]} $$\n$$ P(A|B) = \\frac{[AB]}{2[B]} \\quad \\text{and} \\quad P(B|B) = 1 - \\frac{[AB]}{2[B]} $$\nThese conditional probabilities are expressed only in terms of $[A]$, $[B]$, and $[AB]$ as required.\n\nWhen node $u$ flips from $A$ to $B$:\n- Its $(k-1)P(A|A)$ edges to $A$-neighbors become $B-A$ edges, creating $(k-1)P(A|A)$ new $AB$ edges.\n- Its $(k-1)P(B|A)$ edges to $B$-neighbors (excluding the edge to $v$) become $B-B$ edges, destroying $(k-1)P(B|A)$ $AB$ edges.\nThe net change in $E_{AB}$ from the neighborhood of $u$ is $(k-1)(P(A|A) - P(B|A))$.\nThe rate of change of $E_{AB}$ due to $A \\to B$ flips is $\\frac{1-w}{2}E_{AB} \\times (k-1)(P(A|A) - P(B|A))$.\n\nSymmetrically, when node $v$ flips from $B$ to $A$, the net change in $E_{AB}$ from its neighborhood is $(k-1)(P(B|B) - P(A|B))$.\nThe rate of change of $E_{AB}$ due to $B \\to A$ flips is $\\frac{1-w}{2}E_{AB} \\times (k-1)(P(B|B) - P(A|B))$.\n\nThe total creation rate from side-effects is:\n$$ (\\text{Rate of Creation})_{side} = \\frac{(1-w)(k-1)}{2}E_{AB} \\left[ P(A|A) - P(B|A) + P(B|B) - P(A|B) \\right] $$\nSubstituting the conditional probabilities:\n$$ (\\text{Rate of Creation})_{side} = \\frac{(1-w)(k-1)}{2}E_{AB} \\left[ \\left(1 - \\frac{[AB]}{[A]}\\right) + \\left(1 - \\frac{[AB]}{[B]}\\right) \\right] $$\n$$ = \\frac{(1-w)(k-1)}{2}E_{AB} \\left[ 2 - [AB] \\left( \\frac{1}{[A]} + \\frac{1}{[B]} \\right) \\right] = (1-w)(k-1)E_{AB} \\left( 1 - \\frac{[AB]}{2[A][B]} \\right) $$\n\nThe full ODE for $E_{AB}$ is:\n$$ \\frac{dE_{AB}}{dt} = (\\text{Rate of Creation})_{side} - (\\text{Rate of Destruction})_{focal} $$\n$$ \\frac{dE_{AB}}{dt} = (1-w)(k-1)E_{AB} \\left( 1 - \\frac{[AB]}{2[A][B]} \\right) - E_{AB} $$\n$$ \\frac{dE_{AB}}{dt} = E_{AB} \\left[ (1-w)(k-1) - 1 - \\frac{(1-w)(k-1)}{2[A][B]}[AB] \\right] $$\nTo get the ODE for $\\theta = [AB]$, we use $E_{AB} = E\\theta$ and $dE_{AB}/dt = E(d\\theta/dt)$:\n$$ \\frac{d\\theta}{dt} = \\theta \\left[ (1-w)(k-1) - 1 - \\frac{(1-w)(k-1)}{2[A][B]}\\theta \\right] $$\n\nThe complete system of ODEs for the densities is:\n1. $\\frac{d[A]}{dt} = 0$\n2. $\\frac{d[B]}{dt} = 0$\n3. $\\frac{d[AB]}{dt} = [AB] \\left( (1-w)(k-1) - 1 - \\frac{(1-w)(k-1)}{2[A][B]}[AB] \\right)$\n4. $\\frac{d[AA]}{dt} = \\frac{d}{dt}\\left([A] - \\frac{[AB]}{2}\\right) = -\\frac{1}{2}\\frac{d[AB]}{dt}$\n5. $\\frac{d[BB]}{dt} = \\frac{d}{dt}\\left([B] - \\frac{[AB]}{2}\\right) = -\\frac{1}{2}\\frac{d[AB]}{dt}$\nThis is a closed system of ODEs as requested.\n\n**Steady-State Analysis**\nWe seek a non-trivial steady state, $[AB]^{\\ast} \\neq 0$, where $d[AB]/dt=0$. This requires the term in the brackets of the ODE for $[AB]$ to be zero:\n$$ (1-w)(k-1) - 1 - \\frac{(1-w)(k-1)}{2[A][B]}[AB]^{\\ast} = 0 $$\nSolving for $[AB]^{\\ast}$:\n$$ \\frac{(1-w)(k-1)}{2[A][B]}[AB]^{\\ast} = (1-w)(k-1) - 1 $$\n$$ [AB]^{\\ast} = \\frac{2[A][B] \\left( (1-w)(k-1) - 1 \\right)}{(1-w)(k-1)} = 2[A][B] \\left( 1 - \\frac{1}{(1-w)(k-1)} \\right) $$\nThe problem specifies the symmetric active phase, where $[A]=[B]=1/2$. Substituting these values:\n$$ [A][B] = \\frac{1}{2} \\times \\frac{1}{2} = \\frac{1}{4} $$\n$$ [AB]^{\\ast} = 2 \\left( \\frac{1}{4} \\right) \\left( 1 - \\frac{1}{(1-w)(k-1)} \\right) = \\frac{1}{2} \\left( 1 - \\frac{1}{(1-w)(k-1)} \\right) $$\nThis non-trivial solution exists for $(1-w)(k-1)  1$.\nTo write this as a single fraction:\n$$ [AB]^{\\ast} = \\frac{1}{2} \\left( \\frac{(1-w)(k-1) - 1}{(1-w)(k-1)} \\right) = \\frac{(1-w)(k-1) - 1}{2(1-w)(k-1)} $$\nThis is the final expression for the discordant edge density in the symmetric active phase.",
            "answer": "$$ \\boxed{ \\frac{(k-1)(1-w)-1}{2(k-1)(1-w)} } $$"
        },
        {
            "introduction": "The principles of adaptive networks extend far beyond social opinion models, offering powerful insights into biological processes like epidemic spreading. This exercise explores a Susceptible-Infected-Susceptible (SIS) model on a network whose structure adapts on a timescale much faster than the disease dynamics. You will employ the technique of time-scale separation to derive the epidemic threshold, revealing how the spectral properties of the underlying contact network and the rate of adaptation collectively determine whether a disease will invade the population. ",
            "id": "4269229",
            "problem": "Consider a population of $N$ nodes interacting through an undirected, connected, weighted network with baseline weight matrix $W_{0} \\in \\mathbb{R}^{N \\times N}$, where each entry $W_{0,ij} \\ge 0$ encodes the contact intensity between nodes $i$ and $j$. At time $t$, the instantaneous weight matrix is $W(t) = Y(t) \\odot W_{0}$, where $Y(t) \\in [0,1]^{N \\times N}$ is a fast, ergodic, exogenous adaptation process that multiplies baseline ties, and $\\odot$ denotes the Hadamard (elementwise) product. Assume $W_{0}$ is irreducible and nonnegative.\n\nDisease dynamics follow the Susceptible-Infected-Susceptible (SIS) model: node $i$ is infected with probability $p_{i}(t)$, and the mean-field dynamics are given by the ordinary differential equation (ODE)\n$$\n\\frac{d p_{i}}{d t} \\;=\\; -\\mu\\, p_{i}(t) \\;+\\; \\beta \\big(1 - p_{i}(t)\\big) \\sum_{j=1}^{N} W_{ij}(t)\\, p_{j}(t),\n$$\nwhere $\\beta  0$ is the per-unit-weight infection rate and $\\mu  0$ is the recovery rate. The adaptation field $Y(t)$ is a stationary, ergodic Markov process on $[0,1]^{N \\times N}$ that is statistically independent of the infection process in the early invasion regime and evolves on a fast timescale $\\epsilon \\ll 1$, so that $Y(t)$ rapidly samples its invariant distribution. Denote by $\\bar{y} = \\mathbb{E}[Y_{ij}]$ the common stationary mean of the entries of $Y(t)$ (assume exchangeability so that the stationary mean is the same for all pairs), and suppose $0  \\bar{y} \\le 1$.\n\nStarting only from the definitions above, the SIS mean-field dynamics, and the standard facts about linear stability of linear ODEs and the Perron–Frobenius theorem (which ensures that the spectral radius of a nonnegative irreducible matrix is a simple, real, dominant eigenvalue), derive the dimensionless epidemic threshold ratio $\\kappa_{c} = \\beta_{c}/\\mu$ under the fast-adaptation limit $\\epsilon \\to 0$. Your answer must be a single closed-form analytic expression involving $\\bar{y}$ and the spectral radius of an effective transmission matrix constructed from $W_{0}$. No rounding is required. Express your final answer as a dimensionless quantity; do not include units.",
            "solution": "The problem asks for the epidemic threshold ratio $\\kappa_c = \\beta_c/\\mu$ for an SIS model on a fast-adapting network. The derivation will proceed by analyzing the linear stability of the disease-free equilibrium (DFE).\n\nThe governing mean-field dynamics for the infection probability $p_i(t)$ of node $i$ are given by the system of ordinary differential equations:\n$$\n\\frac{d p_{i}}{d t} = -\\mu p_{i}(t) + \\beta \\big(1 - p_{i}(t)\\big) \\sum_{j=1}^{N} W_{ij}(t) p_{j}(t)\n$$\nwhere $W_{ij}(t) = Y_{ij}(t) W_{0,ij}$, $\\beta  0$ is the infection rate, and $\\mu  0$ is the recovery rate. In vector form, let $\\mathbf{p}(t) = [p_1(t), ..., p_N(t)]^T$.\n\nFirst, we identify the disease-free equilibrium (DFE), which is the state where no nodes are infected. This corresponds to $\\mathbf{p}(t) = \\mathbf{0}$ for all $t$. Substituting $p_i(t) = 0$ for all $i$ into the governing equation yields:\n$$\n\\frac{d (0)}{d t} = -\\mu(0) + \\beta(1 - 0) \\sum_{j=1}^{N} W_{ij}(t)(0) = 0\n$$\nThus, $\\mathbf{p}_{\\text{DFE}} = \\mathbf{0}$ is indeed a fixed point of the system.\n\nThe epidemic threshold is determined by the stability of this DFE. An epidemic can occur if the DFE is unstable, meaning that a small perturbation (introduction of the disease) will grow over time. To analyze the stability, we linearize the system around the DFE, $\\mathbf{p} = \\mathbf{0}$. The system can be written as $\\frac{d\\mathbf{p}}{dt} = \\mathbf{F}(\\mathbf{p}, t)$. The linearized dynamics are given by $\\frac{d\\mathbf{p}}{dt} \\approx J(t) \\mathbf{p}$, where $J(t)$ is the Jacobian matrix evaluated at the DFE. The entries of the Jacobian are $J_{ij}(t) = \\frac{\\partial F_i}{\\partial p_j}|_{\\mathbf{p}=\\mathbf{0}}$.\n\nThe partial derivatives are:\n$$\n\\frac{\\partial F_i}{\\partial p_j} = \\frac{\\partial}{\\partial p_j} \\left( -\\mu p_{i} + \\beta \\sum_{k=1}^{N} W_{ik}(t) p_{k} - \\beta p_i \\sum_{k=1}^{N} W_{ik}(t) p_{k} \\right)\n$$\nFor $i=j$:\n$$\n\\frac{\\partial F_i}{\\partial p_i} = -\\mu + \\beta (1-p_i) W_{ii}(t) - \\beta \\sum_{k=1}^{N} W_{ik}(t) p_k\n$$\nFor $i\\neq j$:\n$$\n\\frac{\\partial F_i}{\\partial p_j} = \\beta (1-p_i) W_{ij}(t)\n$$\nEvaluating these at the DFE ($\\mathbf{p}=\\mathbf{0}$):\n$$\n\\frac{\\partial F_i}{\\partial p_i}\\bigg|_{\\mathbf{p}=\\mathbf{0}} = -\\mu + \\beta W_{ii}(t)\n$$\n$$\n\\frac{\\partial F_i}{\\partial p_j}\\bigg|_{\\mathbf{p}=\\mathbf{0}} = \\beta W_{ij}(t) \\quad (\\text{for } i \\neq j)\n$$\nThese can be combined using the Kronecker delta $\\delta_{ij}$:\n$$\nJ_{ij}(t) = -\\mu \\delta_{ij} + \\beta W_{ij}(t)\n$$\nIn matrix form, the Jacobian is $J(t) = -\\mu I + \\beta W(t)$, where $I$ is the $N \\times N$ identity matrix. The linearized system near the DFE is:\n$$\n\\frac{d\\mathbf{p}}{dt} = \\left( -\\mu I + \\beta W(t) \\right) \\mathbf{p}\n$$\nThis is a linear system with time-varying coefficients. The problem states that the network adaptation process $Y(t)$ (and hence $W(t)$) evolves on a fast timescale $\\epsilon \\ll 1$. In this limit ($\\epsilon \\to 0$), the stability of the system is governed by the time-averaged system. This is a standard result from the theory of dynamical systems with multiple timescales. The time-averaged Jacobian matrix, $\\langle J(t) \\rangle$, is obtained by taking the expectation over the stationary distribution of the fast process $Y(t)$.\n$$\n\\langle J(t) \\rangle = \\mathbb{E}[-\\mu I + \\beta W(t)] = -\\mu I + \\beta \\mathbb{E}[W(t)]\n$$\nThe expectation of the weight matrix is $\\mathbb{E}[W(t)] = \\mathbb{E}[Y(t) \\odot W_0]$. Since $W_0$ is a constant matrix and the expectation is element-wise:\n$$\n(\\mathbb{E}[W(t)])_{ij} = \\mathbb{E}[Y_{ij}(t) W_{0,ij}] = W_{0,ij} \\mathbb{E}[Y_{ij}(t)]\n$$\nWe are given that the stationary mean is $\\mathbb{E}[Y_{ij}(t)] = \\bar{y}$ for all pairs $(i, j)$. Therefore, the averaged weight matrix is:\n$$\nW_{\\text{eff}} = \\mathbb{E}[W(t)] = \\bar{y} W_0\n$$\nThe dynamics of small perturbations are approximately governed by the linear time-invariant (LTI) system:\n$$\n\\frac{d\\mathbf{p}}{dt} = \\left( -\\mu I + \\beta \\bar{y} W_0 \\right) \\mathbf{p}\n$$\nThe stability of the DFE for this LTI system is determined by the eigenvalues of the matrix $M = -\\mu I + \\beta \\bar{y} W_0$. The DFE is stable if all eigenvalues of $M$ have negative real parts, and unstable if at least one eigenvalue has a positive real part. The epidemic threshold is the critical condition where the eigenvalue with the largest real part is exactly zero.\n\nThe eigenvalues of $M$, denoted $\\lambda_k(M)$, are related to the eigenvalues of $W_0$, denoted $\\lambda_k(W_0)$, by:\n$$\n\\lambda_k(M) = -\\mu + \\beta \\bar{y} \\lambda_k(W_0)\n$$\nThe stability is determined by the dominant eigenvalue of $M$, $\\lambda_{\\text{dom}}(M)$, which corresponds to the eigenvalue of $W_0$ with the largest real part.\n$$\n\\lambda_{\\text{dom}}(M) = \\max_{k} \\text{Re}(\\lambda_k(M)) = -\\mu + \\beta \\bar{y} \\max_{k} \\text{Re}(\\lambda_k(W_0))\n$$\nThe problem states that the baseline weight matrix $W_0$ is nonnegative and irreducible. By the Perron-Frobenius theorem, such a matrix has a real, positive, and simple eigenvalue which equals its spectral radius, $\\rho(W_0)$. This eigenvalue, $\\rho(W_0)$, is greater than or equal to the real part of any other eigenvalue. Therefore, $\\max_{k} \\text{Re}(\\lambda_k(W_0)) = \\rho(W_0)$.\n\nThe dominant eigenvalue of $M$ is thus:\n$$\n\\lambda_{\\text{dom}}(M) = -\\mu + \\beta \\bar{y} \\rho(W_0)\n$$\nThe DFE is stable if $\\lambda_{\\text{dom}}(M)  0$ (infection dies out) and unstable if $\\lambda_{\\text{dom}}(M)  0$ (epidemic spreads). The epidemic threshold is defined by the condition $\\lambda_{\\text{dom}}(M) = 0$. Let $\\beta_c$ be the critical infection rate at the threshold.\n$$\n-\\mu + \\beta_c \\bar{y} \\rho(W_0) = 0\n$$\nSolving for the dimensionless ratio $\\kappa_c = \\beta_c / \\mu$:\n$$\n\\beta_c \\bar{y} \\rho(W_0) = \\mu\n$$\n$$\n\\frac{\\beta_c}{\\mu} = \\frac{1}{\\bar{y} \\rho(W_0)}\n$$\nThus, the epidemic threshold ratio is $\\kappa_c = \\frac{1}{\\bar{y} \\rho(W_0)}$. This expression involves $\\bar{y}$ and the spectral radius of the baseline matrix $W_0$. The \"effective transmission matrix\" can be defined as $W_{\\text{eff}} = \\bar{y} W_0$, whose spectral radius is $\\rho(W_{\\text{eff}}) = \\bar{y} \\rho(W_0)$ since $\\bar{y}  0$. The result is consistent with the threshold condition $R_0 = (\\beta_c/\\mu)\\rho(W_{\\text{eff}}) = 1$.\nThe final expression for $\\kappa_c$ is derived solely from the problem statement and standard mathematical theorems.",
            "answer": "$$\\boxed{\\frac{1}{\\bar{y} \\rho(W_0)}}$$"
        },
        {
            "introduction": "While analytical models provide deep insights, many coevolutionary systems exhibit complex nonlinear behaviors like bistability and hysteresis that are best explored computationally. This practice shifts from pen-and-paper derivation to numerical simulation, asking you to implement a continuation method to trace the equilibrium states of a coevolving threshold model. By mapping out the system's response as a control parameter is varied, you will computationally measure the width of a hysteresis loop, gaining direct, hands-on experience with the path-dependent behavior that characterizes many adaptive systems. ",
            "id": "4269188",
            "problem": "Consider a reversible threshold dynamics on an adaptive (coevolving) network, modeled at the population level by the fraction of adopters $x \\in [0,1]$ on a homogeneous network of fixed degree $k \\in \\mathbb{N}$. Each node adopts if and only if the fraction of its adopted neighbors is at least the threshold $\\theta \\in (0,1)$. The network coevolves by rewiring discordant edges with intensity $\\omega \\in [0,1]$, which reduces inter-state mixing. In an annealed mean-field approximation, the probability that a randomly sampled neighbor is adopted is attenuated linearly by the rewiring intensity, so that the effective neighbor adoption probability is $q(\\omega, x) = (1 - \\omega) x$. Under the well-mixed binomial approximation, the number of adopted neighbors of a node is modeled as a binomial random variable with parameters $k$ and $q(\\omega, x)$. The fraction of nodes that satisfy the threshold rule is then given by\n$$\nT_k\\big(q(\\omega, x), \\theta\\big) = \\sum_{m=\\lceil \\theta k \\rceil}^{k} \\binom{k}{m} \\big(q(\\omega, x)\\big)^m \\big(1 - q(\\omega, x)\\big)^{k-m}.\n$$\nA reversible equilibrium is any $x^\\ast \\in [0,1]$ that satisfies the self-consistency condition\n$$\nx^\\ast = T_k\\big((1 - \\omega) x^\\ast, \\theta\\big).\n$$\nBecause $T_k$ is steep for sufficiently large $k$ and intermediate $\\theta$, multiple equilibria can coexist. As $\\omega$ varies, the stable equilibrium followed by the system can depend on whether $\\omega$ is increased or decreased, producing a hysteresis loop. We will analyze hysteresis by numerically continuing equilibria $x^\\ast(\\omega)$ in two directions:\n- Increasing direction: initialize at $\\omega = 0$ with $x_0 = 1$ and increase $\\omega$ in steps of $\\Delta \\omega$ up to a specified $\\omega_{\\max}$, using the previous equilibrium as the initial condition to find the next equilibrium by fixed-point iteration of the map $x \\mapsto T_k\\big((1 - \\omega) x, \\theta\\big)$.\n- Decreasing direction: initialize at $\\omega = \\omega_{\\max}$ with $x_0 = 0$ and decrease $\\omega$ in steps of $\\Delta \\omega$ down to $0$, using continuation and the same fixed-point iteration.\n\nDefine the upper transition point $\\omega_{\\uparrow}$ as the smallest value of $\\omega$ in the increasing continuation at which the converged equilibrium first satisfies $x^\\ast(\\omega) \\le \\xi$, and define the lower transition point $\\omega_{\\downarrow}$ as the largest value of $\\omega$ in the decreasing continuation at which the converged equilibrium first satisfies $x^\\ast(\\omega) \\ge \\xi$, where $\\xi \\in (0,1)$ is a fixed discriminator between the low-adoption and high-adoption branches (use $\\xi = 0.5$). The hysteresis width is then\n$$\nW = \\omega_{\\downarrow} - \\omega_{\\uparrow},\n$$\nwith the convention that if either $\\omega_{\\uparrow}$ or $\\omega_{\\downarrow}$ does not exist within the scanned interval, then $W$ is set to $0$.\n\nYour task is to implement this continuation-based computation of the hysteresis width for the following test suite of parameter sets, each specified as a tuple $(k, \\theta, \\omega_{\\max}, \\Delta \\omega)$:\n- Test case $1$: $(20, 0.45, 0.90, 0.002)$.\n- Test case $2$: $(30, 0.40, 0.90, 0.002)$.\n- Test case $3$: $(8, 0.60, 0.95, 0.002)$.\n- Test case $4$: $(12, 0.50, 0.95, 0.002)$.\n\nAll quantities are unitless. Use a fixed-point iteration tolerance of $10^{-10}$ and a maximum of $10000$ iterations per $\\omega$ step. Clip $q(\\omega, x)$ into the interval $[0,1]$ to ensure numerical stability. For the binomial survival function, use a numerically stable computation.\n\nYour program should produce a single line of output containing the hysteresis widths for the test cases as a comma-separated list of decimal numbers rounded to six digits, enclosed in square brackets. For example, the output should look like $[w_1,w_2,w_3,w_4]$, where each $w_i$ is a float with six digits after the decimal point.",
            "solution": "The problem requires the computation of the hysteresis width in a mean-field model of threshold dynamics on a coevolving network. The solution involves implementing a numerical continuation method to trace the system's equilibria as a control parameter is varied, first in an increasing direction and then in a decreasing direction.\n\nThe state of the system is described by the fraction of adopters, $x \\in [0,1]$. The network is homogeneous with a fixed degree $k \\in \\mathbb{N}$. The dynamics are governed by a threshold rule, where a node adopts if the fraction of its neighbors that are adopters is at least $\\theta \\in (0,1)$. The network coevolves with an intensity $\\omega \\in [0,1]$, which represents the rate of rewiring of connections between nodes in different states (adopter vs. non-adopter), effectively reducing the mixing in the network.\n\nUnder an annealed mean-field approximation, the effective probability that a neighbor of a random node is an adopter is given by $q(\\omega, x) = (1 - \\omega) x$. Using a binomial approximation for the number of adopted neighbors, the fraction of nodes that satisfy the adoption threshold is given by the function $T_k\\big(q(\\omega, x), \\theta\\big)$. This function is the survival function of a binomial distribution with $k$ trials and success probability $q(\\omega, x)$:\n$$\nT_k\\big(q(\\omega, x), \\theta\\big) = \\sum_{m=\\lceil \\theta k \\rceil}^{k} \\binom{k}{m} \\big(q(\\omega, x)\\big)^m \\big(1 - q(\\omega, x)\\big)^{k-m}\n$$\nwhere $m$ is the number of adopted neighbors. An equilibrium state $x^\\ast$ is a fixed point of this map, satisfying the self-consistency condition:\n$$\nx^\\ast = T_k\\big((1 - \\omega) x^\\ast, \\theta\\big)\n$$\nFor certain parameter regimes (sufficiently large $k$ and intermediate $\\theta$), the function $T_k$ is a steep, sigmoid-like function, which can intersect the line $y=x$ at multiple points, leading to bistability. The system's state will then depend on its history, a phenomenon known as hysteresis. We are tasked with quantifying this hysteresis by computing its width, $W = \\omega_{\\downarrow} - \\omega_{\\uparrow}$.\n\nThe calculation of the hysteresis width $W$ proceeds via a numerical continuation algorithm, as specified.\n\nFirst, we design a robust fixed-point solver to find an equilibrium $x^\\ast$ for a given set of parameters $(k, \\theta, \\omega)$. This solver implements the iterative map $x_{n+1} = T_k\\big((1-\\omega)x_n, \\theta\\big)$ starting from an initial guess $x_0$. The iteration continues until the change between successive iterates, $|x_{n+1} - x_n|$, falls below a specified tolerance of $10^{-10}$, or until a maximum of $10000$ iterations is reached. The function $T_k(q, \\theta)$ is computationally equivalent to the survival function of a binomial random variable $M \\sim \\text{Binomial}(k, q)$, representing $P(M \\ge \\lceil \\theta k \\rceil)$. This is computed numerically using a stable library function, which is preferable to summing the probability mass function directly to avoid underflow/overflow issues. Specifically, if $m_{min} = \\lceil \\theta k \\rceil$, then $P(M \\ge m_{min}) = P(M  m_{min}-1)$.\n\nSecond, we perform two continuation runs to find the transition points $\\omega_{\\uparrow}$ and $\\omega_{\\downarrow}$.\n\nThe increasing continuation run is used to find the upper transition point $\\omega_{\\uparrow}$. The parameter $\\omega$ is increased from $\\omega=0$ to $\\omega = \\omega_{\\max}$ in steps of $\\Delta \\omega$. The process starts from a high-adoption initial state, $x=1$, at $\\omega=0$. For each value of $\\omega$ in the sequence, the fixed-point solver is called to find the corresponding equilibrium $x^\\ast(\\omega)$. The initial guess for the solver at a given $\\omega$ is the converged equilibrium $x^\\ast$ from the previous $\\omega$ step. This continuation method efficiently tracks the evolution of the stable equilibrium. The upper transition point $\\omega_{\\uparrow}$ is defined as the first (smallest) value of $\\omega$ encountered for which the equilibrium drops to or below the discriminator threshold $\\xi = 0.5$, i.e., $x^\\ast(\\omega) \\le 0.5$. If no such transition occurs within the scanned interval $[0, \\omega_{\\max}]$, $\\omega_{\\uparrow}$ is considered non-existent for this calculation.\n\nThe decreasing continuation run is used to find the lower transition point $\\omega_{\\downarrow}$. This process is analogous to the first, but in reverse. The parameter $\\omega$ is decreased from $\\omega = \\omega_{\\max}$ down to $\\omega=0$ in steps of $\\Delta \\omega$. The process is initialized in a low-adoption state, $x=0$, at $\\omega=\\omega_{\\max}$. The fixed-point solver is again used at each step, with continuation. The lower transition point $\\omega_{\\downarrow}$ is the first (largest) value of $\\omega$ for which the equilibrium jumps to or above the discriminator threshold, $x^\\ast(\\omega) \\ge 0.5$. If this transition does not occur, $\\omega_{\\downarrow}$ is considered non-existent.\n\nFinally, the hysteresis width $W$ is calculated. If both $\\omega_{\\uparrow}$ and $\\omega_{\\downarrow}$ were found, the width is $W = \\omega_{\\downarrow} - \\omega_{\\uparrow}$. If either transition point was not found within the specified range of $\\omega$, the hysteresis width is defined to be $W=0$.\n\nThis entire procedure is applied to each of the four parameter sets $(k, \\theta, \\omega_{\\max}, \\Delta \\omega)$ provided in the test suite to obtain the corresponding hysteresis widths. During computation, the effective probability $q(\\omega,x)$ is clipped to the interval $[0,1]$ to ensure numerical stability for the binomial survival function calculation.",
            "answer": "```python\nimport numpy as np\nfrom scipy.stats import binom\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It calculates the hysteresis width for a coevolutionary threshold model.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (20, 0.45, 0.90, 0.002),\n        (30, 0.40, 0.90, 0.002),\n        (8, 0.60, 0.95, 0.002),\n        (12, 0.50, 0.95, 0.002),\n    ]\n\n    results = []\n\n    # Numerical parameters\n    TOLERANCE = 1e-10\n    MAX_ITERATIONS = 10000\n    XI = 0.5\n\n    def find_equilibrium(omega, x_initial, k, theta):\n        \"\"\"\n        Finds the equilibrium fraction of adopters x* for given parameters\n        using fixed-point iteration.\n        \"\"\"\n        x_prev = x_initial\n        for _ in range(MAX_ITERATIONS):\n            # Effective neighbor adoption probability, clipped for stability.\n            q = np.clip((1.0 - omega) * x_prev, 0.0, 1.0)\n            \n            # Adoption threshold (minimum number of adopted neighbors).\n            m_min = np.ceil(theta * k)\n            \n            # The problem defines T_k as P(M = m_min).\n            # scipy.stats.binom.sf(k_val, n, p) computes P(M  k_val).\n            # So, P(M = m_min) is equivalent to P(M  m_min - 1).\n            if m_min > k:\n                x_next = 0.0\n            elif m_min = 0:\n                x_next = 1.0\n            else:\n                x_next = binom.sf(m_min - 1, k, q)\n\n            if abs(x_next - x_prev)  TOLERANCE:\n                return x_next\n            x_prev = x_next\n        return x_prev # Return last value if max iterations reached\n\n    for k, theta, omega_max, delta_omega in test_cases:\n        # Generate omega values for the scan\n        num_steps = int(round(omega_max / delta_omega))\n        omega_vals = np.linspace(0, omega_max, num_steps + 1)\n        \n        omega_up = None\n        omega_down = None\n\n        # --- Increasing continuation to find omega_up ---\n        x_prev = 1.0\n        for omega in omega_vals:\n            x_curr = find_equilibrium(omega, x_prev, k, theta)\n            if x_curr = XI:\n                omega_up = omega\n                break\n            x_prev = x_curr\n\n        # --- Decreasing continuation to find omega_down ---\n        x_prev = 0.0\n        for omega in omega_vals[::-1]: # Iterate in reverse\n            x_curr = find_equilibrium(omega, x_prev, k, theta)\n            if x_curr >= XI:\n                omega_down = omega\n                break\n            x_prev = x_curr\n\n        # --- Calculate hysteresis width ---\n        if omega_up is not None and omega_down is not None:\n            width = omega_down - omega_up\n        else:\n            width = 0.0\n        \n        # Ensure width is not negative due to numerical precision\n        results.append(max(0.0, width))\n\n    # Format output as a comma-separated list of floats with 6 decimal places.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}