{
    "hands_on_practices": [
        {
            "introduction": "本章的第一个练习是基础性的，旨在引导你掌握分析自适应网络的核心分析工具。通过使用对近似（pair approximation）方法，你将为经典的自适应投票者模型（Adaptive Voter Model）推导出宏观动力学方程。这项实践旨在训练你将微观的节点与边的互动规则，转化为一个可分析的宏观常微分方程系统的关键技能。",
            "id": "4269268",
            "problem": "考虑一个度为 $k$ 的度正则随机网络，其上有 $N$ 个节点。该网络是作为无度相关的配置模型构建的。在此网络上，我们研究自适应选民模型（AVM）。每个节点持有两种观点之一，记为 $A$ 和 $B$。令 $[A]$ 和 $[B]$ 分别表示处于状态 $A$ 和 $B$ 的节点比例，令 $[AA]$、$[AB]$ 和 $[BB]$ 分别表示类型为 $AA$、$AB$ 和 $BB$ 的边的比例，所有比例均通过总边数进行归一化。动力学过程在连续时间内如下进行：每条不一致边 $AB$ 以速率 $1$ 被选择；一旦被选中，以概率 $w \\in (0,1)$ 发生重连事件，其中一端被均匀随机地选择，并与一个和自己观点相同的均匀随机节点重新连接（避免自环和多重边）；以概率 $1-w$ 发生模仿事件，其中一端被均匀随机地选择，并采纳另一个节点的观点。\n\n从边和节点密度的核心定义、配置模型中边末端的守恒以及全概率定律出发，使用对近似方法推导一个关于 $[A]$、$[B]$、$[AA]$、$[AB]$ 和 $[BB]$ 时间演化的封闭常微分方程（ODE）系统。清晰地陈述您用于三元组密度和条件邻居构成的闭合方法，并将您引入的任何条件概率完全用 $[A]$、$[B]$ 和 $[AB]$ 表示。\n\n然后，使用您推导的ODE，确定在 $[A]=[B]=\\tfrac{1}{2}$ 的统计对称活跃相中，不一致边密度 $[AB]^{\\ast}$ 的非平凡稳态值，该值应为 $k$ 和 $w$ 的函数。以最简解析形式给出 $[AB]^{\\ast}$ 的单个闭式表达式作为您的最终答案。无需四舍五入，不涉及单位。",
            "solution": "用户想要一个关于自适应选民模型问题的解。\n\n### 步骤1：问题验证\n\n**1. 提取已知条件：**\n- **模型：** 度正则随机网络上的自适应选民模型（AVM）。\n- **网络参数：** $N$ 个节点，所有节点的度均为 $k$。该网络是一个无度相关的配置模型。\n- **节点状态：** 两种观点，A 和 B。\n- **节点密度：** $[A]$ 和 $[B]$ 是处于状态 A 和 B 的节点比例。\n- **边密度：** $[AA]$、$[AB]$ 和 $[BB]$ 分别是 $AA$、$AB$ 和 $BB$ 边的比例，通过总边数 $E = Nk/2$ 进行归一化。\n- **动力学：**\n    - 一条不一致边 $AB$ 以每条边为 $1$ 的速率被选择。事件的总速率是 $E_{AB}$，即 $AB$ 边的数量。\n    - 以概率 $w \\in (0,1)$ 发生重连事件：被选中的边的两端节点之一被均匀随机地选择，它断开与另一个节点的连接，并与一个和自己观点相同的均匀随机节点重新连接。避免自环和多重边。\n    - 以概率 $1-w$ 发生模仿事件：被选中的边的两端节点之一被均匀随机地选择，并采纳另一个节点的观点。\n\n- **任务1：** 使用对近似方法推导一个关于 $[A]$、$[B]$、$[AA]$、$[AB]$ 和 $[BB]$ 时间演化的封闭常微分方程（ODE）系统。这包括陈述所使用的闭合方法，并将条件概率用 $[A]$、$[B]$ 和 $[AB]$ 表示。\n- **任务2：** 在 $[A]=[B]=1/2$ 的统计对称活跃相中，确定不一致边密度 $[AB]^{\\ast}$ 的非平凡稳态值。结果应为 $k$ 和 $w$ 的函数。\n\n**2. 使用提取的已知条件进行验证：**\n- **科学依据：** 该问题描述了自适应选民模型，这是协演化网络和复杂系统研究中的一个典型模型。其表述是标准的，并且科学上是合理的。\n- **良态问题：** 该问题是良态的。它要求使用一种指定的标准近似方法（对近似）进行推导，并计算一个稳态解，这是一个可解的任务。\n- **客观性：** 该问题以精确、客观和数学化的语言表述。\n- **结论：** 该问题没有违反任何无效标准。它是理论物理/复杂系统领域中一个有效的、非平凡的问题。\n\n### 步骤2：解的推导\n\n**守恒定律和定义**\n令 $N_A = N[A]$ 和 $N_B = N[B]$ 分别为类型 $A$ 和 $B$ 的节点数。令 $E_{AA}$、$E_{AB}$、$E_{BB}$ 为每种类型的边数。对于一个 k-正则网络，总边数为 $E = Nk/2$。边密度为 $[XY] = E_{XY}/E$。\n\n节点和边密度通过“边末端”（stub）的守恒相关联。从 A-节点发出的边末端总数为 $k N_A$。这些边末端连接到 $A$ 或 $B$ 节点。每条 $AA$ 边计为两个这样的边末端，每条 $AB$ 边计为一个。\n$k N_A = 2E_{AA} + E_{AB}$\n除以 $Nk$：\n$[A] = \\frac{2E_{AA}}{Nk} + \\frac{E_{AB}}{Nk} = \\frac{2E[AA]}{Nk} + \\frac{E[AB]}{Nk}$\n代入 $E=Nk/2$：\n$[A] = \\frac{2(Nk/2)[AA]}{Nk} + \\frac{(Nk/2)[AB]}{Nk} = [AA] + \\frac{1}{2}[AB]$\n类似地，对于 B-节点：\n$[B] = [BB] + \\frac{1}{2}[AB]$\n将这些相加得到 $[A]+[B] = [AA]+[AB]+[BB]$，这与节点和边的总守恒（$1=1$）是一致的。这些关系使我们能够仅使用 $[A]$ 和 $[AB]$ 来描述系统的状态。\n\n**$[A]$ 的时间演化**\nA-节点的密度 $[A]$ 仅通过模仿事件发生改变。在一次模仿事件中，一条 $AB$ 边被选中，一个节点被随机选择来复制另一个节点的状态。如果 A 节点被选中，它会变成 B（$N_A \\to N_A-1$）。如果 B 节点被选中，它会变成 A（$N_A \\to N_A+1$）。由于两种选择的可能性相同（概率为 $1/2$），$N_A$ 的期望变化为零。\n$$ \\frac{d N_A}{dt} \\propto (1-w) \\left( \\frac{1}{2} \\times (-1) + \\frac{1}{2} \\times (+1) \\right) = 0 $$\n因此，在该模型中 $[A]$（和 $[B]$）是守恒量。\n$$ \\frac{d[A]}{dt} = 0 \\quad \\text{且} \\quad \\frac{d[B]}{dt} = 0 $$\n\n**$[AB]$ 的时间演化**\n我们推导不一致边密度 $[AB]$ 的 ODE。让我们使用变量 $\\theta(t) = [AB](t)$。$AB$ 边的总数为 $E_{AB} = E\\theta = \\frac{Nk}{2}\\theta$。\n动力学由选择一条不一致边触发。事件的总速率为 $E_{AB}$。\n我们通过对所有过程的影响求和来计算 $E_{AB}$ 的变化率。\n$$ \\frac{dE_{AB}}{dt} = （AB \\text{边的创建速率}） - （AB \\text{边的破坏速率}） $$\n每当一条 $AB$ 边因模仿或重连被选中时，它就会被破坏。总选择速率为 $E_{AB}$。因此，焦点 $AB$ 边的破坏速率为 $E_{AB}$。\n$$ （\\text{破坏速率}）_\\text{焦点} = E_{AB} $$\n当一个节点改变其状态，从而改变了与其相连的边的类型时，作为模仿的附带效应，$AB$ 边也会被创建和破坏。重连不改变节点状态，因此没有这种附带效应。\n\n让我们分析模仿过程。一条 $AB$ 边 $(u,v)$（其中 $u \\in A, v \\in B$）被选中。模仿事件的速率为 $(1-w)E_{AB}$。\n1.  以概率 $1/2$，节点 $u$ 被选择从状态 $A$ 翻转到 $B$。这以速率 $\\frac{1-w}{2}E_{AB}$ 发生。当 $u$ 翻转时，它的其他 $k-1$ 条边会受到影响。\n2.  以概率 $1/2$，节点 $v$ 被选择从状态 $B$ 翻转到 $A$。这以速率 $\\frac{1-w}{2}E_{AB}$ 发生。当 $v$ 翻转时，它的其他 $k-1$ 条边会受到影响。\n\n为了计算变化量，我们需要邻居状态的条件概率。这里就要用到对近似。该闭合假设一个节点的邻域是随机的，只以该节点的状态为条件。一个邻居的状态被假设为独立于其他邻居的状态。\n一个 A-节点的随机邻居是 B-节点的概率是：\n$$ P(B|A) = \\frac{\\text{从 A 到 B 的边末端数}}{\\text{A 的总边末端数}} = \\frac{E_{AB}}{kN_A} = \\frac{E[AB]}{kN[A]} = \\frac{(Nk/2)[AB]}{kN[A]} = \\frac{[AB]}{2[A]} $$\n类似地，\n$$ P(A|A) = \\frac{2E_{AA}}{kN_A} = \\frac{2E[AA]}{kN[A]} = \\frac{[AA]}{[A]} = \\frac{[A] - [AB]/2}{[A]} = 1 - \\frac{[AB]}{2[A]} $$\n$$ P(A|B) = \\frac{[AB]}{2[B]} \\quad \\text{且} \\quad P(B|B) = 1 - \\frac{[AB]}{2[B]} $$\n这些条件概率按要求仅用 $[A]$、$[B]$ 和 $[AB]$ 表示。\n\n当节点 $u$ 从 $A$ 翻转到 $B$ 时：\n- 它连接到 A-邻居的 $(k-1)P(A|A)$ 条边变成了 $B-A$ 边，创建了 $(k-1)P(A|A)$ 条新的 $AB$ 边。\n- 它连接到 B-邻居的 $(k-1)P(B|A)$ 条边（不包括到 $v$ 的边）变成了 $B-B$ 边，破坏了 $(k-1)P(B|A)$ 条 $AB$ 边。\n来自 $u$ 邻域的 $E_{AB}$ 净变化是 $(k-1)(P(A|A) - P(B|A))$。\n由 $A \\to B$ 翻转引起的 $E_{AB}$ 变化速率是 $\\frac{1-w}{2}E_{AB} \\times (k-1)(P(A|A) - P(B|A))$。\n\n对称地，当节点 $v$ 从 $B$ 翻转到 $A$ 时，其邻域对 $E_{AB}$ 的净变化是 $(k-1)(P(B|B) - P(A|B))$。\n由 $B \\to A$ 翻转引起的 $E_{AB}$ 变化速率是 $\\frac{1-w}{2}E_{AB} \\times (k-1)(P(B|B) - P(A|B))$。\n\n来自附带效应的总创建速率是：\n$$ （\\text{创建速率}）_\\text{附带} = \\frac{(1-w)(k-1)}{2}E_{AB} \\left[ P(A|A) - P(B|A) + P(B|B) - P(A|B) \\right] $$\n代入条件概率：\n$$ （\\text{创建速率}）_\\text{附带} = \\frac{(1-w)(k-1)}{2}E_{AB} \\left[ \\left(1 - \\frac{[AB]}{[A]}\\right) + \\left(1 - \\frac{[AB]}{[B]}\\right) \\right] $$\n$$ = \\frac{(1-w)(k-1)}{2}E_{AB} \\left[ 2 - [AB] \\left( \\frac{1}{[A]} + \\frac{1}{[B]} \\right) \\right] = (1-w)(k-1)E_{AB} \\left( 1 - \\frac{[AB]}{2[A][B]} \\right) $$\n\n$E_{AB}$ 的完整 ODE 是：\n$$ \\frac{dE_{AB}}{dt} = （\\text{创建速率}）_\\text{附带} - （\\text{破坏速率}）_\\text{焦点} $$\n$$ \\frac{dE_{AB}}{dt} = (1-w)(k-1)E_{AB} \\left( 1 - \\frac{[AB]}{2[A][B]} \\right) - E_{AB} $$\n$$ \\frac{dE_{AB}}{dt} = E_{AB} \\left[ (1-w)(k-1) - 1 - \\frac{(1-w)(k-1)}{2[A][B]}[AB] \\right] $$\n为了得到 $\\theta = [AB]$ 的 ODE，我们使用 $E_{AB} = E\\theta$ 和 $dE_{AB}/dt = E(d\\theta/dt)$：\n$$ \\frac{d\\theta}{dt} = \\theta \\left[ (1-w)(k-1) - 1 - \\frac{(1-w)(k-1)}{2[A][B]}\\theta \\right] $$\n\n关于密度的完整 ODE 系统是：\n1. $\\frac{d[A]}{dt} = 0$\n2. $\\frac{d[B]}{dt} = 0$\n3. $\\frac{d[AB]}{dt} = [AB] \\left( (1-w)(k-1) - 1 - \\frac{(1-w)(k-1)}{2[A][B]}[AB] \\right)$\n4. $\\frac{d[AA]}{dt} = \\frac{d}{dt}\\left([A] - \\frac{[AB]}{2}\\right) = -\\frac{1}{2}\\frac{d[AB]}{dt}$\n5. $\\frac{d[BB]}{dt} = \\frac{d}{dt}\\left([B] - \\frac{[AB]}{2}\\right) = -\\frac{1}{2}\\frac{d[AB]}{dt}$\n这是一个满足要求的封闭 ODE 系统。\n\n**稳态分析**\n我们寻求一个非平凡稳态 $[AB]^{\\ast} \\neq 0$，在该状态下 $d[AB]/dt=0$。这要求 $[AB]$ 的 ODE 中方括号内的项为零：\n$$ (1-w)(k-1) - 1 - \\frac{(1-w)(k-1)}{2[A][B]}[AB]^{\\ast} = 0 $$\n求解 $[AB]^{\\ast}$：\n$$ \\frac{(1-w)(k-1)}{2[A][B]}[AB]^{\\ast} = (1-w)(k-1) - 1 $$\n$$ [AB]^{\\ast} = \\frac{2[A][B] \\left( (1-w)(k-1) - 1 \\right)}{(1-w)(k-1)} = 2[A][B] \\left( 1 - \\frac{1}{(1-w)(k-1)} \\right) $$\n问题指定了对称活跃相，其中 $[A]=[B]=1/2$。代入这些值：\n$$ [A][B] = \\frac{1}{2} \\times \\frac{1}{2} = \\frac{1}{4} $$\n$$ [AB]^{\\ast} = 2 \\left( \\frac{1}{4} \\right) \\left( 1 - \\frac{1}{(1-w)(k-1)} \\right) = \\frac{1}{2} \\left( 1 - \\frac{1}{(1-w)(k-1)} \\right) $$\n这个非平凡解存在于 $(1-w)(k-1) > 1$ 的条件下。\n将其写成单个分数形式：\n$$ [AB]^{\\ast} = \\frac{1}{2} \\left( \\frac{(1-w)(k-1) - 1}{(1-w)(k-1)} \\right) = \\frac{(1-w)(k-1) - 1}{2(1-w)(k-1)} $$\n这是对称活跃相中不一致边密度的最终表达式。",
            "answer": "$$ \\boxed{ \\frac{(k-1)(1-w)-1}{2(k-1)(1-w)} } $$"
        },
        {
            "introduction": "第二个练习将共演化模型的思想应用到了一个至关重要的领域：流行病学。你将分析一个在权重快速变化的自适应网络上传播的SIS模型，并推导其流行病阈值。这项练习将向你介绍时间尺度分离（time-scale separation）这一重要分析技巧，并揭示网络结构（通过其谱半径）如何决定疾病传播的命运。",
            "id": "4269229",
            "problem": "考虑一个由 $N$ 个节点组成的群体，它们通过一个无向、连通、加权的交互网络进行交互，其基准权重矩阵为 $W_{0} \\in \\mathbb{R}^{N \\times N}$，其中每个条目 $W_{0,ij} \\ge 0$ 表示节点 $i$ 和 $j$ 之间的接触强度。在时间 $t$，瞬时权重矩阵为 $W(t) = Y(t) \\odot W_{0}$，其中 $Y(t) \\in [0,1]^{N \\times N}$ 是一个快速、遍历、外生的适应过程，它乘以基准联系，而 $\\odot$ 表示哈达玛（逐元素）积。假设 $W_{0}$ 是不可约且非负的。\n\n疾病动力学遵循易感-感染-易感（SIS）模型：节点 $i$以概率 $p_{i}(t)$ 被感染，其平均场动力学由以下常微分方程（ODE）给出\n$$\n\\frac{d p_{i}}{d t} \\;=\\; -\\mu\\, p_{i}(t) \\;+\\; \\beta \\big(1 - p_{i}(t)\\big) \\sum_{j=1}^{N} W_{ij}(t)\\, p_{j}(t),\n$$\n其中 $\\beta > 0$ 是单位权重感染率，$\\mu > 0$ 是恢复率。$Y(t)$ 适应场是一个在 $[0,1]^{N \\times N}$ 上的平稳、遍历的马尔可夫过程，它在早期入侵阶段与感染过程统计独立，并在一个快速时间尺度 $\\epsilon \\ll 1$ 上演化，因此 $Y(t)$ 会快速地从其不变分布中抽样。记 $\\bar{y} = \\mathbb{E}[Y_{ij}]$ 为 $Y(t)$ 各个条目的公共平稳均值（假设可交换性，使得所有节点对的平稳均值相同），并假设 $0  \\bar{y} \\le 1$。\n\n仅从上述定义、SIS 平均场动力学、关于线性常微分方程线性稳定性的标准结论以及 Perron–Frobenius 定理（该定理确保了非负不可约矩阵的谱半径是一个单实主特征值）出发，推导在快速适应极限 $\\epsilon \\to 0$ 下的无量纲流行病阈值比 $\\kappa_{c} = \\beta_{c}/\\mu$。你的答案必须是一个包含 $\\bar{y}$ 和由 $W_{0}$ 构建的有效传播矩阵的谱半径的单一闭式解析表达式。不需要四舍五入。请将最终答案表示为一个无量纲量；不要包含单位。",
            "solution": "问题要求解在快速适应网络上的 SIS 模型的流行病阈值比 $\\kappa_c = \\beta_c/\\mu$。推导过程将通过分析无病平衡点（DFE）的线性稳定性来进行。\n\n节点 $i$ 的感染概率 $p_i(t)$ 的主导平均场动力学由以下常微分方程组给出：\n$$\n\\frac{d p_{i}}{d t} = -\\mu p_{i}(t) + \\beta \\big(1 - p_{i}(t)\\big) \\sum_{j=1}^{N} W_{ij}(t) p_{j}(t)\n$$\n其中 $W_{ij}(t) = Y_{ij}(t) W_{0,ij}$，$\\beta  0$ 是感染率，$\\mu  0$ 是恢复率。以向量形式表示，令 $\\mathbf{p}(t) = [p_1(t), ..., p_N(t)]^T$。\n\n首先，我们确定无病平衡点（DFE），即没有任何节点被感染的状态。这对应于对所有 $t$ 都有 $\\mathbf{p}(t) = \\mathbf{0}$。将 $p_i(t) = 0$（对所有 $i$）代入主导方程，得到：\n$$\n\\frac{d (0)}{d t} = -\\mu(0) + \\beta(1 - 0) \\sum_{j=1}^{N} W_{ij}(t)(0) = 0\n$$\n因此，$\\mathbf{p}_{\\text{DFE}} = \\mathbf{0}$ 确实是系统的一个不动点。\n\n流行病阈值由该 DFE 的稳定性决定。如果 DFE 不稳定，即一个小的扰动（疾病的引入）会随时间增长，那么就可能爆发流行病。为了分析稳定性，我们在 DFE（$\\mathbf{p} = \\mathbf{0}$）附近将系统线性化。该系统可写为 $\\frac{d\\mathbf{p}}{dt} = \\mathbf{F}(\\mathbf{p}, t)$。线性化后的动力学由 $\\frac{d\\mathbf{p}}{dt} \\approx J(t) \\mathbf{p}$ 给出，其中 $J(t)$ 是在 DFE 处求值的雅可比矩阵。雅可比矩阵的条目为 $J_{ij}(t) = \\frac{\\partial F_i}{\\partial p_j}|_{\\mathbf{p}=\\mathbf{0}}$。\n\n偏导数为：\n$$\n\\frac{\\partial F_i}{\\partial p_j} = \\frac{\\partial}{\\partial p_j} \\left( -\\mu p_{i} + \\beta \\sum_{k=1}^{N} W_{ik}(t) p_{k} - \\beta p_i \\sum_{k=1}^{N} W_{ik}(t) p_{k} \\right)\n$$\n对于 $i=j$：\n$$\n\\frac{\\partial F_i}{\\partial p_i} = -\\mu + \\beta (1-p_i) W_{ii}(t) - \\beta \\sum_{k=1}^{N} W_{ik}(t) p_k\n$$\n对于 $i\\neq j$：\n$$\n\\frac{\\partial F_i}{\\partial p_j} = \\beta (1-p_i) W_{ij}(t)\n$$\n在 DFE（$\\mathbf{p}=\\mathbf{0}$）处对这些求值：\n$$\n\\frac{\\partial F_i}{\\partial p_i}\\bigg|_{\\mathbf{p}=\\mathbf{0}} = -\\mu + \\beta W_{ii}(t)\n$$\n$$\n\\frac{\\partial F_i}{\\partial p_j}\\bigg|_{\\mathbf{p}=\\mathbf{0}} = \\beta W_{ij}(t) \\quad (\\text{对于 } i \\neq j)\n$$\n这些可以使用克罗内克 delta 符号 $\\delta_{ij}$ 合并：\n$$\nJ_{ij}(t) = -\\mu \\delta_{ij} + \\beta W_{ij}(t)\n$$\n以矩阵形式，雅可比矩阵为 $J(t) = -\\mu I + \\beta W(t)$，其中 $I$ 是 $N \\times N$ 的单位矩阵。DFE 附近的线性化系统为：\n$$\n\\frac{d\\mathbf{p}}{dt} = \\left( -\\mu I + \\beta W(t) \\right) \\mathbf{p}\n$$\n这是一个时变系数的线性系统。问题陈述，网络适应过程 $Y(t)$（因此 $W(t)$ 也是）在一个快速时间尺度 $\\epsilon \\ll 1$ 上演化。在此极限 ($\\epsilon \\to 0$)下，系统的稳定性由时间平均系统决定。这是多时间尺度动力系统理论的一个标准结果。时间平均雅可比矩阵 $\\langle J(t) \\rangle$ 是通过对快速过程 $Y(t)$ 的平稳分布取期望得到的。\n$$\n\\langle J(t) \\rangle = \\mathbb{E}[-\\mu I + \\beta W(t)] = -\\mu I + \\beta \\mathbb{E}[W(t)]\n$$\n权重矩阵的期望为 $\\mathbb{E}[W(t)] = \\mathbb{E}[Y(t) \\odot W_0]$。由于 $W_0$ 是一个常数矩阵，且期望是逐元素的：\n$$\n(\\mathbb{E}[W(t)])_{ij} = \\mathbb{E}[Y_{ij}(t) W_{0,ij}] = W_{0,ij} \\mathbb{E}[Y_{ij}(t)]\n$$\n我们已知对于所有节点对 $(i, j)$，平稳均值为 $\\mathbb{E}[Y_{ij}(t)] = \\bar{y}$。因此，平均权重矩阵为：\n$$\nW_{\\text{eff}} = \\mathbb{E}[W(t)] = \\bar{y} W_0\n$$\n小扰动的动力学近似地由以下线性时不变（LTI）系统控制：\n$$\n\\frac{d\\mathbf{p}}{dt} = \\left( -\\mu I + \\beta \\bar{y} W_0 \\right) \\mathbf{p}\n$$\n此 LTI 系统的 DFE 的稳定性由矩阵 $M = -\\mu I + \\beta \\bar{y} W_0$ 的特征值决定。如果 $M$ 的所有特征值都具有负实部，则 DFE 是稳定的；如果至少有一个特征值具有正实部，则 DFE 是不稳定的。流行病阈值是具有最大实部的特征值恰好为零的临界条件。\n\n$M$ 的特征值（记为 $\\lambda_k(M)$）与 $W_0$ 的特征值（记为 $\\lambda_k(W_0)$）之间的关系为：\n$$\n\\lambda_k(M) = -\\mu + \\beta \\bar{y} \\lambda_k(W_0)\n$$\n稳定性由 $M$ 的主特征值 $\\lambda_{\\text{dom}}(M)$ 决定，该特征值对应于 $W_0$ 具有最大实部的特征值。\n$$\n\\lambda_{\\text{dom}}(M) = \\max_{k} \\text{Re}(\\lambda_k(M)) = -\\mu + \\beta \\bar{y} \\max_{k} \\text{Re}(\\lambda_k(W_0))\n$$\n问题陈述基准权重矩阵 $W_0$ 是非负且不可约的。根据 Perron-Frobenius 定理，这样的矩阵有一个等于其谱半径 $\\rho(W_0)$ 的单实正特征值。这个特征值 $\\rho(W_0)$ 大于或等于任何其他特征值的实部。因此，$\\max_{k} \\text{Re}(\\lambda_k(W_0)) = \\rho(W_0)$。\n\n$M$ 的主特征值因此为：\n$$\n\\lambda_{\\text{dom}}(M) = -\\mu + \\beta \\bar{y} \\rho(W_0)\n$$\n如果 $\\lambda_{\\text{dom}}(M)  0$（感染消失），则 DFE 是稳定的；如果 $\\lambda_{\\text{dom}}(M) > 0$（流行病传播），则 DFE 是不稳定的。流行病阈值由条件 $\\lambda_{\\text{dom}}(M) = 0$ 定义。设 $\\beta_c$ 为阈值处的临界感染率。\n$$\n-\\mu + \\beta_c \\bar{y} \\rho(W_0) = 0\n$$\n求解无量纲比 $\\kappa_c = \\beta_c / \\mu$：\n$$\n\\beta_c \\bar{y} \\rho(W_0) = \\mu\n$$\n$$\n\\frac{\\beta_c}{\\mu} = \\frac{1}{\\bar{y} \\rho(W_0)}\n$$\n因此，流行病阈值比为 $\\kappa_c = \\frac{1}{\\bar{y} \\rho(W_0)}$。该表达式涉及 $\\bar{y}$ 和基准矩阵 $W_0$ 的谱半径。“有效传播矩阵”可定义为 $W_{\\text{eff}} = \\bar{y} W_0$，其谱半径为 $\\rho(W_{\\text{eff}}) = \\bar{y} \\rho(W_0)$（因为 $\\bar{y} > 0$）。该结果与阈值条件 $R_0 = (\\beta_c/\\mu)\\rho(W_{\\text{eff}}) = 1$ 一致。$\\kappa_c$ 的最终表达式完全由问题陈述和标准数学定理推导得出。",
            "answer": "$$\\boxed{\\frac{1}{\\bar{y} \\rho(W_0)}}$$"
        },
        {
            "introduction": "最后的练习将带你从纸笔分析转向计算实践。你将通过编写一个数值算法来探索共演化系统中的迟滞现象（hysteresis），这是一种复杂的非线性行为，其中系统的稳态取决于其历史路径。这项动手编程任务展示了如何研究那些难以用解析方法完全捕捉的涌现行为，这对于现代复杂系统研究至关重要。",
            "id": "4269188",
            "problem": "考虑一个自适应（共同演化）网络上的可逆阈值动力学，该动力学在种群层面通过一个固定度为 $k \\in \\mathbb{N}$ 的同质网络上的采纳者比例 $x \\in [0,1]$ 来建模。当且仅当一个节点的已采纳邻居的比例至少达到阈值 $\\theta \\in (0,1)$ 时，该节点才会采纳。网络通过以强度 $\\omega \\in [0,1]$ 重连不一致的边来进行共同演化，这会减少状态间的混合。在退火平均场近似下，一个随机抽样邻居是采纳者的概率会随着重连强度线性衰减，因此有效邻居采纳概率为 $q(\\omega, x) = (1 - \\omega) x$。在充分混合的二项近似下，一个节点的已采纳邻居数量被建模为参数为 $k$ 和 $q(\\omega, x)$ 的二项随机变量。满足阈值规则的节点比例由下式给出\n$$\nT_k\\big(q(\\omega, x), \\theta\\big) = \\sum_{m=\\lceil \\theta k \\rceil}^{k} \\binom{k}{m} \\big(q(\\omega, x)\\big)^m \\big(1 - q(\\omega, x)\\big)^{k-m}.\n$$\n一个可逆平衡是满足自洽条件的任意 $x^\\ast \\in [0,1]$\n$$\nx^\\ast = T_k\\big((1 - \\omega) x^\\ast, \\theta\\big).\n$$\n由于当 $k$ 足够大且 $\\theta$ 为中等值时，$T_k$ 函数很陡峭，因此可能共存多个平衡点。当 $\\omega$ 变化时，系统所处的稳定平衡可能取决于 $\\omega$ 是增加还是减少，从而产生滞后回环。我们将通过在两个方向上对平衡点 $x^\\ast(\\omega)$ 进行数值延拓来分析滞后现象：\n- 递增方向：在 $\\omega = 0$ 时以 $x_0 = 1$ 初始化，并以 $\\Delta \\omega$ 的步长增加 $\\omega$ 直至指定的 $\\omega_{\\max}$，使用前一个平衡点作为初始条件，通过对映射 $x \\mapsto T_k\\big((1 - \\omega) x, \\theta\\big)$ 进行不动点迭代来寻找下一个平衡点。\n- 递减方向：在 $\\omega = \\omega_{\\max}$ 时以 $x_0 = 0$ 初始化，并以 $\\Delta \\omega$ 的步长减少 $\\omega$ 直至 $0$，使用延拓和相同的不动点迭代。\n\n将上转变点 $\\omega_{\\uparrow}$ 定义为在递增延拓中，收敛的平衡点首次满足 $x^\\ast(\\omega) \\le \\xi$ 的最小 $\\omega$ 值；并将下转变点 $\\omega_{\\downarrow}$ 定义为在递减延拓中，收敛的平衡点首次满足 $x^\\ast(\\omega) \\ge \\xi$ 的最大 $\\omega$ 值，其中 $\\xi \\in (0,1)$ 是一个固定的区分标准，用于区分低采纳分支和高采纳分支（使用 $\\xi = 0.5$）。滞后宽度则为\n$$\nW = \\omega_{\\downarrow} - \\omega_{\\uparrow},\n$$\n约定如果在扫描区间内 $\\omega_{\\uparrow}$ 或 $\\omega_{\\downarrow}$ 不存在，则 $W$ 设为 $0$。\n\n您的任务是为以下参数集测试套件实现这种基于延拓的滞后宽度计算，每个参数集指定为元组 $(k, \\theta, \\omega_{\\max}, \\Delta \\omega)$：\n- 测试用例 1：$(20, 0.45, 0.90, 0.002)$。\n- 测试用例 2：$(30, 0.40, 0.90, 0.002)$。\n- 测试用例 3：$(8, 0.60, 0.95, 0.002)$。\n- 测试用例 4：$(12, 0.50, 0.95, 0.002)$。\n\n所有量均为无单位。每个 $\\omega$ 步长使用 $10^{-10}$ 的不动点迭代容差和最多 $10000$ 次迭代。为确保数值稳定性，将 $q(\\omega, x)$ 的值限制在区间 $[0,1]$ 内。对于二项生存函数，请使用数值稳定的计算方法。\n\n您的程序应生成单行输出，其中包含各测试用例的滞后宽度，形式为方括号内用逗号分隔的十进制数列表，每个数四舍五入到六位小数。例如，输出应类似于 $[w_1,w_2,w_3,w_4]$，其中每个 $w_i$ 是小数点后有六位的浮点数。",
            "solution": "该问题要求在一个共同演化网络的阈值动力学平均场模型中计算滞后宽度。解决方案涉及实现一种数值延拓方法，以追踪当一个控制参数在递增和递减两个方向上变化时系统平衡点的演变。\n\n系统状态由采纳者比例 $x \\in [0,1]$ 描述。网络是度为 $k \\in \\mathbb{N}$ 的同质网络。动力学由一个阈值规则支配，即当一个节点的采纳者邻居比例至少为 $\\theta \\in (0,1)$ 时，该节点便采纳。网络以强度 $\\omega \\in [0,1]$ 共同演化，这代表了处于不同状态（采纳者 vs. 非采纳者）的节点之间的连接重连速率，从而有效地减少了网络中的混合。\n\n在退火平均场近似下，一个随机节点的邻居是采纳者的有效概率由 $q(\\omega, x) = (1 - \\omega) x$ 给出。使用二项近似来描述已采纳邻居的数量，满足采纳阈值的节点比例由函数 $T_k\\big(q(\\omega, x), \\theta\\big)$ 给出。该函数是具有 $k$ 次试验和成功概率 $q(\\omega, x)$ 的二项分布的生存函数：\n$$\nT_k\\big(q(\\omega, x), \\theta\\big) = \\sum_{m=\\lceil \\theta k \\rceil}^{k} \\binom{k}{m} \\big(q(\\omega, x)\\big)^m \\big(1 - q(\\omega, x)\\big)^{k-m}\n$$\n其中 $m$ 是已采纳邻居的数量。平衡态 $x^\\ast$ 是此映射的一个不动点，满足自洽条件：\n$$\nx^\\ast = T_k\\big((1 - \\omega) x^\\ast, \\theta\\big)\n$$\n在某些参数区间（足够大的 $k$ 和中等值的 $\\theta$），函数 $T_k$ 是一个陡峭的S型函数，它可能与直线 $y=x$ 在多个点相交，导致双稳态。系统的状态因而将取决于其历史，这种现象称为滞后。我们的任务是通过计算其宽度 $W = \\omega_{\\downarrow} - \\omega_{\\uparrow}$ 来量化这种滞后。\n\n滞后宽度 $W$ 的计算通过指定的数值延拓算法进行。\n\n首先，我们设计一个鲁棒的不动点求解器，以找到给定参数集 $(k, \\theta, \\omega)$ 的平衡点 $x^\\ast$。该求解器从一个初始猜测值 $x_0$ 开始，实现迭代映射 $x_{n+1} = T_k\\big((1-\\omega)x_n, \\theta\\big)$。迭代持续进行，直到连续迭代值之间的变化 $|x_{n+1} - x_n|$ 小于指定的容差 $10^{-10}$，或者达到最大迭代次数 $10000$ 次。函数 $T_k(q, \\theta)$ 在计算上等同于二项随机变量 $M \\sim \\text{Binomial}(k, q)$ 的生存函数，表示 $P(M \\ge \\lceil \\theta k \\rceil)$。这是使用一个稳定的库函数进行数值计算的，这样做比直接对概率质量函数求和更可取，以避免下溢/上溢问题。具体来说，如果 $m_{min} = \\lceil \\theta k \\rceil$，那么 $P(M \\ge m_{min}) = P(M > m_{min}-1)$。\n\n其次，我们执行两次延拓运行以找到转变点 $\\omega_{\\uparrow}$ 和 $\\omega_{\\downarrow}$。\n\n递增延拓运行用于找到上转变点 $\\omega_{\\uparrow}$。参数 $\\omega$ 从 $\\omega=0$ 以 $\\Delta \\omega$ 的步长增加到 $\\omega = \\omega_{\\max}$。该过程从 $\\omega=0$ 处的高采纳初始状态 $x=1$ 开始。对于序列中的每个 $\\omega$ 值，调用不动点求解器以找到相应的平衡点 $x^\\ast(\\omega)$。在给定 $\\omega$ 处求解器的初始猜测值是前一个 $\\omega$ 步长收敛的平衡点 $x^\\ast$。这种延拓方法有效地追踪了稳定平衡的演化。上转变点 $\\omega_{\\uparrow}$ 被定义为遇到的第一个（最小的）使平衡点降至或低于判别阈值 $\\xi = 0.5$ 的 $\\omega$ 值，即 $x^\\ast(\\omega) \\le 0.5$。如果在扫描区间 $[0, \\omega_{\\max}]$ 内没有发生这样的转变，则认为 $\\omega_{\\uparrow}$ 在此计算中不存在。\n\n递减延拓运行用于找到下转变点 $\\omega_{\\downarrow}$。这个过程与第一个类似，但方向相反。参数 $\\omega$ 从 $\\omega = \\omega_{\\max}$ 以 $\\Delta \\omega$ 的步长递减到 $\\omega=0$。该过程在 $\\omega=\\omega_{\\max}$ 处从低采纳状态 $x=0$ 初始化。在每个步骤中再次使用不动点求解器，并进行延拓。下转变点 $\\omega_{\\downarrow}$ 是遇到的第一个（最大的）使平衡点跃升至或高于判别阈值 $x^\\ast(\\omega) \\ge 0.5$ 的 $\\omega$ 值。如果此转变未发生，则认为 $\\omega_{\\downarrow}$ 不存在。\n\n最后，计算滞后宽度 $W$。如果 $\\omega_{\\uparrow}$ 和 $\\omega_{\\downarrow}$ 都被找到，则宽度为 $W = \\omega_{\\downarrow} - \\omega_{\\uparrow}$。如果在指定的 $\\omega$ 范围内未能找到任一转变点，则滞后宽度定义为 $W=0$。\n\n将这整个过程应用于测试套件中提供的四个参数集 $(k, \\theta, \\omega_{\\max}, \\Delta \\omega)$ 中的每一个，以获得相应的滞后宽度。在计算过程中，为确保二项生存函数计算的数值稳定性，有效概率 $q(\\omega,x)$ 被裁剪到区间 $[0,1]$ 内。",
            "answer": "```python\nimport numpy as np\nfrom scipy.stats import binom\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It calculates the hysteresis width for a coevolutionary threshold model.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (20, 0.45, 0.90, 0.002),\n        (30, 0.40, 0.90, 0.002),\n        (8, 0.60, 0.95, 0.002),\n        (12, 0.50, 0.95, 0.002),\n    ]\n\n    results = []\n\n    # Numerical parameters\n    TOLERANCE = 1e-10\n    MAX_ITERATIONS = 10000\n    XI = 0.5\n\n    def find_equilibrium(omega, x_initial, k, theta):\n        \"\"\"\n        Finds the equilibrium fraction of adopters x* for given parameters\n        using fixed-point iteration.\n        \"\"\"\n        x_prev = x_initial\n        for _ in range(MAX_ITERATIONS):\n            # Effective neighbor adoption probability, clipped for stability.\n            q = np.clip((1.0 - omega) * x_prev, 0.0, 1.0)\n            \n            # Adoption threshold (minimum number of adopted neighbors).\n            m_min = np.ceil(theta * k)\n            \n            # The problem defines T_k as P(M = m_min).\n            # scipy.stats.binom.sf(k_val, n, p) computes P(M  k_val).\n            # So, P(M = m_min) is equivalent to P(M  m_min - 1).\n            if m_min > k:\n                x_next = 0.0\n            elif m_min = 0:\n                x_next = 1.0\n            else:\n                x_next = binom.sf(m_min - 1, k, q)\n\n            if abs(x_next - x_prev)  TOLERANCE:\n                return x_next\n            x_prev = x_next\n        return x_prev # Return last value if max iterations reached\n\n    for k, theta, omega_max, delta_omega in test_cases:\n        # Generate omega values for the scan\n        num_steps = int(round(omega_max / delta_omega))\n        omega_vals = np.linspace(0, omega_max, num_steps + 1)\n        \n        omega_up = None\n        omega_down = None\n\n        # --- Increasing continuation to find omega_up ---\n        x_prev = 1.0\n        for omega in omega_vals:\n            x_curr = find_equilibrium(omega, x_prev, k, theta)\n            if x_curr = XI:\n                omega_up = omega\n                break\n            x_prev = x_curr\n\n        # --- Decreasing continuation to find omega_down ---\n        x_prev = 0.0\n        for omega in omega_vals[::-1]: # Iterate in reverse\n            x_curr = find_equilibrium(omega, x_prev, k, theta)\n            if x_curr >= XI:\n                omega_down = omega\n                break\n            x_prev = x_curr\n\n        # --- Calculate hysteresis width ---\n        if omega_up is not None and omega_down is not None:\n            width = omega_down - omega_up\n        else:\n            width = 0.0\n        \n        # Ensure width is not negative due to numerical precision\n        results.append(max(0.0, width))\n\n    # Format output as a comma-separated list of floats with 6 decimal places.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}