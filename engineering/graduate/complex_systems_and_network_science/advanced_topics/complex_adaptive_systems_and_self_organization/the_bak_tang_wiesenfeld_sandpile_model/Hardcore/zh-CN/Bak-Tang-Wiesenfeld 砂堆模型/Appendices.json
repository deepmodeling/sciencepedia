{
    "hands_on_practices": [
        {
            "introduction": "Bak-Tang-Wiesenfeld (BTW) 沙堆模型的一个核心特性是其阿贝尔性质，即崩塌操作的最终结果与操作顺序无关。这一性质极大地简化了模型的分析，是其具有解析可解性的基石。本练习通过一个具体的例子，让您亲手验证这一关键属性，展示尽管在崩塌序列中存在局部选择，但最终的稳定状态和崩塌次数（里程计）是唯一确定的。",
            "id": "4307527",
            "problem": "考虑一个在 $2\\times 2$ 开放晶格上的 Bak-Tang-Wiesenfeld (BTW) 沙堆模型，该模型具有一个代表晶格外部的耗散汇。每个位置都有标准的方形晶格基本邻居，并使用阈值 $z_{c}=4$：当一个位置坍塌时，它失去 $4$ 粒沙，并向其四个基本方向各发送 $1$ 粒沙；发送到晶格外的沙粒被汇吸收。用坐标 $(i,j)$ 标记位置，其中 $i,j\\in\\{1,2\\}$，并设初始高度构型为\n$$\nh^{(0)}=\\begin{pmatrix}\n4  2 \\\\\n2  4\n\\end{pmatrix}.\n$$\n该构型恰好有两个不稳定位置，$(1,1)$ 和 $(2,2)$。定义里程表函数 $u:\\{1,2\\}^{2}\\to\\mathbb{N}$，其中 $u(i,j)$ 等于在稳定化期间位置 $(i,j)$ 处执行的坍塌次数。仅使用 BTW模型的核心定义和开放边界条件，进行两次完整的稳定化过程：第一次先坍塌 $(1,1)$，第二次先坍塌 $(2,2)$，之后在每种情况下都以任意合法序列继续进行，直到所有位置都稳定。从第一性原理出发，推导出最终的稳定构型 $h^{(\\infty)}$ 和里程表函数 $u$，并证明两者都与两次初始坍塌的顺序无关。将最终答案表示为一个对，由稳定的 $2\\times 2$ 构型矩阵和 $2\\times 2$ 里程表矩阵组成，并排写在一个单行矩阵内。无需四舍五入。",
            "solution": "该问题是有效的，因为它科学上基于成熟的 Bak-Tang-Wiesenfeld (BTW) 沙堆模型，问题提法得当，给出的条件完整且一致，并以客观、正式的语言表达。我们开始求解。\n\n该问题考虑一个在 $2 \\times 2$ 开放晶格上的 BTW 沙堆模型。位置用 $(i,j)$ 标记，其中 $i, j \\in \\{1, 2\\}$。坍塌阈值为 $z_c = 4$。当一个高度 $h(i,j) \\ge 4$ 的位置 $(i,j)$ 坍塌时，其高度变化为 $h(i,j) \\to h(i,j) - 4$，其每个基本邻居 $(i',j')$ 接收一粒沙，即 $h(i',j') \\to h(i',j') + 1$。发送到晶格外位置的沙粒会丢失。\n\n初始高度构型由矩阵 $h^{(0)}$ 给出：\n$$\nh^{(0)} = \\begin{pmatrix} 4  2 \\\\ 2  4 \\end{pmatrix}\n$$\n初始里程表函数矩阵（记录每个位置的坍塌次数）为：\n$$\nu^{(0)} = \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix}\n$$\n位置 $(i,j)$ 处单次坍塌引起的高度构型矩阵变化，可以用加上一个特定的变化矩阵 $C^{(i,j)}$ 来表示。对于 $2 \\times 2$ 开放晶格，这些矩阵是：\n- 在 $(1,1)$ 处坍塌：失去 $4$ 粒沙，向 $(1,2)$ 发送 $1$ 粒，向 $(2,1)$ 发送 $1$ 粒，向外部发送 $2$ 粒。\n$$ C^{(1,1)} = \\begin{pmatrix} -4  1 \\\\ 1  0 \\end{pmatrix} $$\n- 在 $(1,2)$ 处坍塌：失去 $4$ 粒沙，向 $(1,1)$ 发送 $1$ 粒，向 $(2,2)$ 发送 $1$ 粒，向外部发送 $2$ 粒。\n$$ C^{(1,2)} = \\begin{pmatrix} 1  -4 \\\\ 0  1 \\end{pmatrix} $$\n- 在 $(2,1)$ 处坍塌：失去 $4$ 粒沙，向 $(1,1)$ 发送 $1$ 粒，向 $(2,2)$ 发送 $1$ 粒，向外部发送 $2$ 粒。\n$$ C^{(2,1)} = \\begin{pmatrix} 1  0 \\\\ -4  1 \\end{pmatrix} $$\n- 在 $(2,2)$ 处坍塌：失去 $4$ 粒沙，向 $(1,2)$ 发送 $1$ 粒，向 $(2,1)$ 发送 $1$ 粒，向外部发送 $2$ 粒。\n$$ C^{(2,2)} = \\begin{pmatrix} 0  1 \\\\ 1  -4 \\end{pmatrix} $$\n\n初始构型 $h^{(0)}$ 有两个不稳定位置，$(1,1)$ 和 $(2,2)$，因为它们的高度 ($4$) 大于或等于阈值 $z_c=4$。我们将按要求以两种不同顺序进行稳定化。\n\n### 情况 1：首先坍塌位置 $(1,1)$\n\n**第 1 步：** 坍塌位置 $(1,1)$。\n高度矩阵变为 $h^{(1)} = h^{(0)} + C^{(1,1)}$。\n$$\nh^{(1)} = \\begin{pmatrix} 4  2 \\\\ 2  4 \\end{pmatrix} + \\begin{pmatrix} -4  1 \\\\ 1  0 \\end{pmatrix} = \\begin{pmatrix} 0  3 \\\\ 3  4 \\end{pmatrix}\n$$\n里程表矩阵更新为：\n$$\nu^{(1)} = u^{(0)} + \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix}\n$$\n现在唯一的不稳定位置是 $(2,2)$。\n\n**第 2 步：** 坍塌位置 $(2,2)$。\n高度矩阵变为 $h^{(2)} = h^{(1)} + C^{(2,2)}$。\n$$\nh^{(2)} = \\begin{pmatrix} 0  3 \\\\ 3  4 \\end{pmatrix} + \\begin{pmatrix} 0  1 \\\\ 1  -4 \\end{pmatrix} = \\begin{pmatrix} 0  4 \\\\ 4  0 \\end{pmatrix}\n$$\n里程表矩阵更新为：\n$$\nu^{(2)} = u^{(1)} + \\begin{pmatrix} 0  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}\n$$\n不稳定位置现在是 $(1,2)$ 和 $(2,1)$。我们可以按任意顺序坍塌它们。我们先选择 $(1,2)$。\n\n**第 3 步：** 坍塌位置 $(1,2)$。\n高度矩阵变为 $h^{(3)} = h^{(2)} + C^{(1,2)}$。\n$$\nh^{(3)} = \\begin{pmatrix} 0  4 \\\\ 4  0 \\end{pmatrix} + \\begin{pmatrix} 1  -4 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 4  1 \\end{pmatrix}\n$$\n里程表矩阵更新为：\n$$\nu^{(3)} = u^{(2)} + \\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 1  1 \\\\ 0  1 \\end{pmatrix}\n$$\n现在唯一的不稳定位置是 $(2,1)$。\n\n**第 4 步：** 坍塌位置 $(2,1)$。\n高度矩阵变为 $h^{(4)} = h^{(3)} + C^{(2,1)}$。\n$$\nh^{(4)} = \\begin{pmatrix} 1  0 \\\\ 4  1 \\end{pmatrix} + \\begin{pmatrix} 1  0 \\\\ -4  1 \\end{pmatrix} = \\begin{pmatrix} 2  0 \\\\ 0  2 \\end{pmatrix}\n$$\n里程表矩阵更新为：\n$$\nu^{(4)} = u^{(3)} + \\begin{pmatrix} 0  0 \\\\ 1  0 \\end{pmatrix} = \\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix}\n$$\n所有高度现在都小于 $z_c=4$。系统稳定。最终构型是 $h_{1}^{(\\infty)} = h^{(4)}$，最终里程表是 $u_{1} = u^{(4)}$。\n\n### 情况 2：首先坍塌位置 $(2,2)$\n\n**第 1 步：** 坍塌位置 $(2,2)$。\n高度矩阵变为 $h'^{(1)} = h^{(0)} + C^{(2,2)}$。\n$$\nh'^{(1)} = \\begin{pmatrix} 4  2 \\\\ 2  4 \\end{pmatrix} + \\begin{pmatrix} 0  1 \\\\ 1  -4 \\end{pmatrix} = \\begin{pmatrix} 4  3 \\\\ 3  0 \\end{pmatrix}\n$$\n里程表矩阵更新为：\n$$\nu'^{(1)} = u^{(0)} + \\begin{pmatrix} 0  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  1 \\end{pmatrix}\n$$\n现在唯一的不稳定位置是 $(1,1)$。\n\n**第 2 步：** 坍塌位置 $(1,1)$。\n高度矩阵变为 $h'^{(2)} = h'^{(1)} + C^{(1,1)}$。\n$$\nh'^{(2)} = \\begin{pmatrix} 4  3 \\\\ 3  0 \\end{pmatrix} + \\begin{pmatrix} -4  1 \\\\ 1  0 \\end{pmatrix} = \\begin{pmatrix} 0  4 \\\\ 4  0 \\end{pmatrix}\n$$\n里程表矩阵更新为：\n$$\nu'^{(2)} = u'^{(1)} + \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}\n$$\n不稳定位置现在是 $(1,2)$ 和 $(2,1)$。注意到 $h'^{(2)} = h^{(2)}$ 且 $u'^{(2)} = u^{(2)}$，这在一个中间阶段展示了阿贝尔性质。我们继续进行稳定化。这次我们先坍塌 $(2,1)$。\n\n**第 3 步：** 坍塌位置 $(2,1)$。\n高度矩阵变为 $h'^{(3)} = h'^{(2)} + C^{(2,1)}$。\n$$\nh'^{(3)} = \\begin{pmatrix} 0  4 \\\\ 4  0 \\end{pmatrix} + \\begin{pmatrix} 1  0 \\\\ -4  1 \\end{pmatrix} = \\begin{pmatrix} 1  4 \\\\ 0  1 \\end{pmatrix}\n$$\n里程表矩阵更新为：\n$$\nu'^{(3)} = u'^{(2)} + \\begin{pmatrix} 0  0 \\\\ 1  0 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 1  1 \\end{pmatrix}\n$$\n现在唯一的不稳定位置是 $(1,2)$。\n\n**第 4 步：** 坍塌位置 $(1,2)$。\n高度矩阵变为 $h'^{(4)} = h'^{(3)} + C^{(1,2)}$。\n$$\nh'^{(4)} = \\begin{pmatrix} 1  4 \\\\ 0  1 \\end{pmatrix} + \\begin{pmatrix} 1  -4 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 2  0 \\\\ 0  2 \\end{pmatrix}\n$$\n里程表矩阵更新为：\n$$\nu'^{(4)} = u'^{(3)} + \\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix}\n$$\n系统现在稳定。最终构型是 $h_{2}^{(\\infty)} = h'^{(4)}$，最终里程表是 $u_{2} = u'^{(4)}$。\n\n### 结论\n通过直接计算，我们已经证明两种序列都导向相同的最终状态和里程表函数：\n$$\nh_{1}^{(\\infty)} = h_{2}^{(\\infty)} = \\begin{pmatrix} 2  0 \\\\ 0  2 \\end{pmatrix}\n$$\n$$\nu_{1} = u_{2} = \\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix}\n$$\n这从第一性原理证明了，对于这个特定的初始构型，最终的稳定构型 $h^{(\\infty)}$ 和里程表函数 $u$ 与坍塌操作的顺序无关。这是 BTW 沙堆模型通用阿贝尔性质的一个具体实例。\n\n最终答案由唯一的稳定构型矩阵和唯一的最终里程表矩阵组成。\n最终稳定构型：\n$$\nh^{(\\infty)} = \\begin{pmatrix} 2  0 \\\\ 0  2 \\end{pmatrix}\n$$\n最终里程表函数：\n$$\nu = \\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix}\n$$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\begin{pmatrix} 2  0 \\\\ 0  2 \\end{pmatrix}\n\n\\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "理解“雪崩”的传播是掌握自组织临界性概念的关键。本练习模拟了一次由单个沙粒扰动引发的完整雪崩过程，要求您追踪最终的沙粒分布和每个位置的总崩塌次数。通过这个过程，您将加深对模型动力学规则、沙粒守恒定律以及如何利用对称性简化分析的理解。",
            "id": "4307564",
            "problem": "考虑一个具有开放边界的二维方格晶格上的 Bak-Tang-Wiesenfeld (BTW) 沙堆模型（也称为阿贝尔沙堆模型 (ASM)）。一个位形为每个晶格格点分配一个整数数量的沙粒 $z \\in \\mathbb{Z}_{\\ge 0}$。如果一个格点的沙粒数 $z \\ge 4$，则该格点是不稳定的。一个不稳定的格点会发生崩塌，向其四个晶格方向各发送 1 个沙粒，总共失去 4 个沙粒；被送出晶格的沙粒会流失到一个汇中（开放边界）。如果每个格点的沙粒数 $z \\in \\{0,1,2,3\\}$，则该位形是稳定的。阿贝尔性质保证了最终的稳定位形以及每个格点的崩塌次数与崩塌顺序无关。\n\n在一个 $3 \\times 3$ 的开放晶格上，从每个格点 $i$ 的沙粒数均为 $z_{i}=3$ 的均匀位形开始。仅在中心格点添加 1 个沙粒，然后通过重复崩塌使其稳定，直到所有格点都变得稳定。\n\n仅使用模型的动力学规则和晶格上的沙粒数守恒（即，一个格点上沙粒数的减少由其相邻格点沙粒数的增加或流失到汇中的沙粒数来平衡），确定：\n- 每个格点的最终稳定高度，以及\n- 在稳定化过程中每个格点的总崩塌次数。\n\n将你的最终答案表示为一个包含 18 个条目的单行向量：首先按行主序（从左上到右下的格点）列出 9 个最终高度，然后按相同的行主序接着列出 9 个崩塌次数。无需四舍五入。",
            "solution": "我们从具有开放边界的方格晶格上的 Bak-Tang-Wiesenfeld (BTW) 沙堆模型的定义开始。一个格点的一次崩塌会使其高度减少 $4$，并使其最多四个相邻格点的高度各增加 $1$。在开放边界上，任何发送到不存在的相邻格点的沙粒都会流失到一个汇中。如果每个格点的高度都小于 $4$，则位形是稳定的。阿贝尔性质确保了最终的稳定位形和每个格点的总崩塌次数不依赖于崩塌的顺序。\n\n假设晶格格点按行主序进行索引，中心格点是唯一的内部格点。我们用 $t_{i}$ 表示在稳定化过程中格点 $i$ 的崩塌次数。根据晶格上的沙粒数守恒（考虑了流失到汇中的损失），我们对每个格点 $k$ 都有平衡方程\n$$\nz_{\\mathrm{final}}(k) \\;=\\; z_{\\mathrm{initial}}(k) + s(k) \\;-\\; \\big(4\\,t_{k} - \\sum_{n \\sim k} t_{n}\\big),\n$$\n其中 $s(k)$ 是在格点 $k$ 添加的沙粒数（此处中心格点 $s(k)=1$，其他地方 $s(k)=0$），求和是对 $3 \\times 3$ 晶格中 $k$ 的所有存在的相邻格点 $n$ 进行的。这是直接从崩塌规则推导出的离散守恒律：在 $k$ 处的每次崩塌会从 $k$ 移走 4 个沙粒，同时向每个相邻格点提供 1 个沙粒；流向缺失的相邻格点的沙粒会丢失。\n\n根据正方形二面体群的对称性（保持中心不变的旋转和反射），里程计函数（崩塌次数的向量）只取三个不同的值：\n- 中心格点为 $x$，\n- 四个边心格点各为 $y$，\n- 四个角点格点各为 $z$。\n类似地，最终高度也将具有相同的对称性类别。\n\n为每种轨道类型写出平衡方程：\n\n1. 中心格点。其相邻格点是四个边心。离散拉普拉斯项为 $4x - 4y$，因此\n$$\nz_{\\mathrm{final}}(\\text{center}) \\;=\\; 3 + 1 \\;-\\; (4x - 4y) \\;=\\; 4 - 4x + 4y.\n$$\n\n2. 边心格点。其在晶格内的相邻格点是中心格点和两个相邻的角点。离散拉普拉斯项为 $4y - (x + 2z)$，因此\n$$\nz_{\\mathrm{final}}(\\text{edge}) \\;=\\; 3 \\;-\\; \\big(4y - x - 2z\\big) \\;=\\; 3 - 4y + x + 2z.\n$$\n\n3. 角点格点。其在晶格内的相邻格点是两个相邻的边心。离散拉普拉斯项为 $4z - 2y$，因此\n$$\nz_{\\mathrm{final}}(\\text{corner}) \\;=\\; 3 \\;-\\; \\big(4z - 2y\\big) \\;=\\; 3 - 4z + 2y.\n$$\n\n稳定性要求处处有 $z_{\\mathrm{final}} \\in \\{0,1,2,3\\}$，并且里程计值 $x,y,z$ 必须为非负整数。此外，根据阿贝尔沙堆模型的最小作用量原理，实现的里程计是使得最终 $z_{\\mathrm{final}}$ 稳定的逐点最小的非负整数函数。\n\n我们现在构造一个合法的崩塌序列并读出 $(x,y,z)$，然后验证其稳定性。\n\n从 $z \\equiv 3$ 开始，并在中心添加 1 个沙粒：\n- 中心变为 4 并崩塌一次：$x \\leftarrow 1$，中心高度减少 4 变为 0，每个边心高度增加 1 变为 4，角点保持为 3。\n- 四个边心现在均为 4；每个崩塌一次：每个边心 $y \\leftarrow 1$。每个边心高度减少 4 变为 0，向中心发送 1 个沙粒，向每个相邻的角点发送 1 个沙粒（并有 1 个流失到汇中）。在所有四个边心崩塌后，中心获得 4 个沙粒（来自每个边心）变为 4，每个角点获得 2 个沙粒（来自其两个相邻的边心）变为 5。\n- 高度为 4 的中心再次崩塌：$x \\leftarrow 2$，向每个边心发送 1 个沙粒。边心变为 1，角点保持为 5，中心回到 0。\n- 每个高度为 5 的角点崩塌一次：每个角点 $z \\leftarrow 1$。每个角点高度减少 4 变为 1，向每个相邻的边心发送 1 个沙粒，并有 2 个流失到汇中。每个边心从其两个相邻的角点接收 2 个沙粒，变为 3。\n\n最终的位形是：\n- 中心：$0$，\n- 边心：$3$，\n- 角点：$1$。\n\n没有格点的高度大于等于 4，因此位形是稳定的。总崩塌次数为：\n- 中心：$x=2$，\n- 边心：$y=1$，\n- 角点：$z=1$。\n\n为了确认一致性，我们用守恒方程进行验证：\n\n- 中心：$z_{\\mathrm{final}} = 4 - 4x + 4y = 4 - 8 + 4 = 0$。\n- 边心：$z_{\\mathrm{final}} = 3 - 4y + x + 2z = 3 - 4 + 2 + 2 = 3$。\n- 角点：$z_{\\mathrm{final}} = 3 - 4z + 2y = 3 - 4 + 2 = 1$。\n\n因此，最终位形和崩塌次数是唯一确定的。按行主序（从左上到右下），最终高度为\n$$\n1,\\;3,\\;1,\\;3,\\;0,\\;3,\\;1,\\;3,\\;1,\n$$\n崩塌次数为\n$$\n1,\\;1,\\;1,\\;1,\\;2,\\;1,\\;1,\\;1,\\;1.\n$$\n\n根据阿贝尔性质，任何合法的崩塌序列都会产生相同的结果，而根据最小作用量原理，上述里程计是最小的，因此是唯一解。",
            "answer": "$$\\boxed{\\begin{pmatrix}1  3  1  3  0  3  1  3  1  1  1  1  1  2  1  1  1  1\\end{pmatrix}}$$"
        },
        {
            "introduction": "在掌握了动力学规则之后，我们可以探索 BTW 模型更深层次的数学结构。系统的本质状态被称为“递归构型”，而“燃烧算法”是识别这些构型的强大工具。本练习将引导您应用燃烧算法来检验一个构型的递归性，并进一步探索其与阿贝尔沙堆群结构的关系，例如找到群的单位元并生成其他递归状态。",
            "id": "4307553",
            "problem": "考虑一个具有开放边界条件的有限二维方格上的标准 Bak-Tang-Wiesenfeld (BTW) 阿贝尔沙堆模型。该晶格是一个 $2 \\times 2$ 的非汇点网格，带有一个单一的吸收汇，用于收集离开晶格的沙粒。每个非汇点的坍塌阈值为 $4$，当它坍塌时，会向其每个正交邻居发送一粒沙粒；发送到晶格外的沙粒被汇吸收。令降维图拉普拉斯矩阵为一个 $4 \\times 4$ 矩阵，其对角线元素为 $4$，对于每对相邻的非汇点，其非对角线元素为 $-1$，其他情况为 $0$。将四个非汇点索引为 $1$ (左上)、$2$ (右上)、$3$ (左下) 和 $4$ (右下)。\n\n定义燃烧构型 $b$ 为 $b_{i}$ 等于从顶点 $i$ 到汇的边数。在 $2 \\times 2$ 网格上，四个顶点中的每一个都是角点，因此对于所有 $i \\in \\{1,2,3,4\\}$，都有 $b_{i} = 2$。\n\n给定此 $2 \\times 2$ 开放晶格上的稳定构型 $z = (3,3,3,3)$：\n- 从稳定性、坍塌和燃烧构型的基本定义出发，使用燃烧检验来确定 $z$ 是否为循环构型。\n- 如果 $z$ 是循环构型，通过稳定化零构型和燃烧构型 $b$ 的和来确定阿贝尔沙堆群的单位元构型 $e$。然后找到一个非负整数加法向量 $a = (a_{1},a_{2},a_{3},a_{4})$，使得稳定化 $e + a$ 得到 $z$。在所有这样的 $a$ 中，选择使 $\\sum_{i=1}^{4} a_{i}$ 最小化的一个。\n\n在最终答案中仅报告向量 $a$，格式为按 $(1,2,3,4)$ 顺序排列的行向量。",
            "solution": "用户要求我解决一个关于在具有开放边界的 $2 \\times 2$ 网格上的 Bak-Tang-Wiesenfeld (BTW) 阿贝尔沙堆模型的问题。问题分为三个部分：首先，使用燃烧检验测试给定构型 $z$ 是否为循环构型；其次，确定沙堆群的单位元 $e$；第三，找到一个最小的非负整数向量 $a$，使得 $e+a$ 的稳定化结果为 $z$。\n\n首先，我将验证问题陈述。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n-   模型：Bak-Tang-Wiesenfeld (BTW) 阿贝尔沙堆模型。\n-   晶格：一个 $2 \\times 2$ 的非汇点方格网格。\n-   边界条件：开放，带有一个单一的吸收汇。\n-   坍塌阈值：所有四个非汇点的 $Z_{\\text{crit}} = 4$。\n-   坍塌规则：一个不稳定的顶点向其每个正交邻居发送一粒沙粒。发送到晶格外的沙粒被汇吸收。\n-   顶点索引：$1$ (左上)、$2$ (右上)、$3$ (左下) 和 $4$ (右下)。\n-   降维图拉普拉斯矩阵 ($L$)：一个 $4 \\times 4$ 矩阵，其对角线元素为 $4$，对于相邻的非汇点，非对角线元素为 $-1$，其他情况为 $0$。\n-   燃烧构型 ($b$)：定义为 $b_i$ 是从顶点 $i$ 到汇的边数。给定对于所有 $i \\in \\{1,2,3,4\\}$，都有 $b_i = 2$。\n-   待分析的稳定构型：$z = (3,3,3,3)$。\n-   任务：\n    1.  使用燃烧检验确定 $z$ 是否为循环构型。\n    2.  如果 $z$ 是循环构型，通过稳定化零构型和燃烧构型的和 ($S(0+b)$) 来找到单位元构型 $e$。\n    3.  找到非负整数向量 $a = (a_1, a_2, a_3, a_4)$，使其最小化和 $\\sum_{i=1}^{4} a_{i}$，并且其稳定化 $e+a$ 的结果为 $z$。\n\n**步骤 2：使用提取的已知条件进行验证**\n-   **科学依据**：该问题在自组织临界性和复杂系统理论中有坚实的基础，特别是标准的 BTW 沙堆模型。所使用的所有概念（稳定性、坍塌、循环性、燃烧检验、阿贝尔群结构）都是该领域的基本概念。\n-   **适定性**：问题定义了所有必要的量和操作，从而可以得出一个确定的、唯一的最小向量 $a$ 的答案。\n-   **客观性**：问题以精确的数学术语陈述，没有主观性。\n-   **一致性检查**：问题分别定义了拉普拉斯矩阵 $L$ 和坍塌规则。我们来验证它们的一致性。顶点索引如下：\n$1 - 2$\n$| \\ \\ \\ |$\n$3 - 4$\n非汇点之间的邻接关系是 $(1,2)$、$(1,3)$、$(2,4)$ 和 $(3,4)$。\n根据问题的定义，拉普拉斯矩阵 $L$ 是：\n$$L = \\begin{pmatrix} 4  -1  -1  0 \\\\ -1  4  0  -1 \\\\ -1  0  4  -1 \\\\ 0  -1  -1  4 \\end{pmatrix}$$\n在沙堆模型的背景下，由坍塌引起的构型变化由坍塌矩阵 $\\Delta_T$ 描述。在位置 $j$ 的一次坍塌会通过加上 $\\Delta_T$ 的第 $j$ 列来改变构型向量 $c$。对于一个不稳定的位置 $i$（高度 $c_i \\ge Z_{\\text{crit}}=4$），一次坍塌意味着其高度减少 $4$，其内部邻居各接收 $1$ 粒沙粒。对于位置 $1$，其内部邻居是 $2$ 和 $3$。因此，在位置 $1$ 的一次坍塌对应于一个变化向量 $(-4, 1, 1, 0)^T$。这对应于矩阵 $-L$ 的第一列。所有其他位置也是如此。因此，坍塌矩阵是 $\\Delta_T = -L$。问题的定义在内部是一致的。燃烧构型 $b_i=2$ 的定义对于方格上具有开放边界的角点也是正确的。\n\n**步骤 3：结论与行动**\n该问题是有效的，因为它在科学上是合理的，具有适定性、客观性和内部一致性。我现在将进行完整的解答。\n\n### 解答\n\n这个问题需要一个分三部分的解答。我们按顺序处理每个部分。\n\n**第 1 部分：循环性的燃烧检验**\n如果从构型 $c' = c + b$ 开始，系统可以通过一系列坍塌（其中每个位置最多坍塌一次）达到稳定状态，则稳定构型 $c$ 被定义为循环构型。给定的稳定构型是 $z=(3,3,3,3)$，燃烧构型是 $b=(2,2,2,2)$。\n\n我们来计算燃烧检验的初始构型：\n$$ c' = z + b = (3,3,3,3) + (2,2,2,2) = (5,5,5,5) $$\n坍塌阈值为 $Z_{\\text{crit}} = 4$。由于所有位置的高度都是 $5$，所有四个位置都是不稳定的。由于模型的阿贝尔性质，我们可以按任何顺序进行坍塌。我们选择顺序 $1, 2, 3, 4$。\n\n坍塌矩阵是 $\\Delta_T = -L$：\n$$ \\Delta_T = \\begin{pmatrix} -4  1  1  0 \\\\ 1  -4  0  1 \\\\ 1  0  -4  1 \\\\ 0  1  1  -4 \\end{pmatrix} $$\n\n1.  **初始状态**：$c_0 = (5,5,5,5)$。所有位置都不稳定。\n2.  **坍塌位置 1**：变化由 $\\Delta_T$ 的第一列给出。\n    $$ c_1 = c_0 + (-4, 1, 1, 0) = (5-4, 5+1, 5+1, 5+0) = (1, 6, 6, 5) $$\n    位置 $1$ 现在坍塌了一次。位置 $2, 3, 4$ 不稳定。\n3.  **坍塌位置 2**：变化由 $\\Delta_T$ 的第二列给出。\n    $$ c_2 = c_1 + (1, -4, 0, 1) = (1+1, 6-4, 6+0, 5+1) = (2, 2, 6, 6) $$\n    位置 $2$ 现在坍塌了一次。位置 $3, 4$ 不稳定。\n4.  **坍塌位置 3**：变化由 $\\Delta_T$ 的第三列给出。\n    $$ c_3 = c_2 + (1, 0, -4, 1) = (2+1, 2+0, 6-4, 6+1) = (3, 2, 2, 7) $$\n    位置 $3$ 现在坍塌了一次。位置 $4$ 不稳定。\n5.  **坍塌位置 4**：变化由 $\\Delta_T$ 的第四列给出。\n    $$ c_4 = c_3 + (0, 1, 1, -4) = (3+0, 2+1, 2+1, 7-4) = (3, 3, 3, 3) $$\n    位置 $4$ 现在坍塌了一次。\n\n最终构型是 $(3,3,3,3)$。所有高度都小于 $4$，所以系统是稳定的。在这个稳定化过程中，每个位置都恰好坍塌了一次。根据燃烧检验，这证明了构型 $z=(3,3,3,3)$ 是**循环的**。\n\n**第 2 部分：确定单位元构型**\n问题要求我们通过稳定化零构型 $c_{\\text{zero}}=(0,0,0,0)$ 和燃烧构型 $b=(2,2,2,2)$ 的和来找到单位元构型 $e$。令 $S(c)$ 表示构型 $c$ 的稳定化。\n$$ e = S(c_{\\text{zero}} + b) = S((0,0,0,0) + (2,2,2,2)) = S((2,2,2,2)) $$\n构型 $(2,2,2,2)$ 的所有高度 $c_i = 2$，小于坍塌阈值 $Z_{\\text{crit}} = 4$。因此，该构型已经稳定。\n稳定化算子 $S$ 对一个已经稳定的构型不起作用。\n$$ e = (2,2,2,2) $$\n\n**第 3 部分：找到最小加法向量**\n我们需要找到一个非负整数向量 $a = (a_1, a_2, a_3, a_4)$，使得 $S(e+a) = z$，并且和 $\\sum_{i=1}^4 a_i$ 被最小化。\n\n条件 $S(e+a) = z$ 意味着构型 $e+a$ 和构型 $z$ 在沙堆群中属于同一个等价类。如果可以从初始构型 $c_{\\text{initial}}$ 通过一系列坍塌达到最终构型 $c_{\\text{final}}$，则这两个构型是等价的。这可以表示为：\n$$ c_{\\text{final}} = c_{\\text{initial}} + \\Delta_T u $$\n其中 $u = (u_1, u_2, u_3, u_4)^T$ 是一个非负整数向量，表示每个位置坍塌的次数。\n\n在我们的情况下，$c_{\\text{initial}} = e+a$ 且 $c_{\\text{final}} = z = S(e+a)$。所以我们有：\n$$ z = (e+a) + \\Delta_T u $$\n我们可以重新整理这个方程来解出 $a$：\n$$ a = z - e - \\Delta_T u $$\n利用问题的拉普拉斯矩阵 $L = -\\Delta_T$，我们得到：\n$$ a = z - e + L u $$\n我们已知 $z=(3,3,3,3)$ 并且我们找到了 $e=(2,2,2,2)$。差值为：\n$$ z - e = (1,1,1,1) $$\n将此代入 $a$ 的方程：\n$$ a = (1,1,1,1)^T + L u $$\n我们的目标是找到一个非负整数向量 $u$，使得 $\\sum a_i$ 最小化，同时满足约束条件 $a$ 也必须是非负的，即对所有 $i$ 都有 $a_i \\ge 0$。\n\n让我们用 $u$ 来表示和 $\\sum a_i$。我们可以将 $\\sum a_i$ 写成点积 $\\mathbf{1}^T a$，其中 $\\mathbf{1}=(1,1,1,1)^T$。\n$$ \\sum_{i=1}^4 a_i = \\mathbf{1}^T a = \\mathbf{1}^T (z-e) + \\mathbf{1}^T L u $$\n我们已经有 $\\mathbf{1}^T(z-e) = 1+1+1+1=4$。我们来计算 $\\mathbf{1}^T L$：\n$$ \\mathbf{1}^T L = (1,1,1,1) \\begin{pmatrix} 4  -1  -1  0 \\\\ -1  4  0  -1 \\\\ -1  0  4  -1 \\\\ 0  -1  -1  4 \\end{pmatrix} $$\n这个行向量的第 $j$ 个分量是 $L$ 的第 $j$ 列各项的和。\n-   第 1 列和：$4-1-1+0 = 2$\n-   第 2 列和：$-1+4+0-1 = 2$\n-   第 3 列和：$-1+0+4-1 = 2$\n-   第 4 列和：$0-1-1+4 = 2$\n所以，$\\mathbf{1}^T L = (2,2,2,2) = 2 \\mathbf{1}^T$。\n那么和就是：\n$$ \\sum a_i = 4 + (2,2,2,2) \\begin{pmatrix} u_1 \\\\ u_2 \\\\ u_3 \\\\ u_4 \\end{pmatrix} = 4 + 2(u_1+u_2+u_3+u_4) = 4 + 2 \\sum u_i $$\n为了最小化 $\\sum a_i$，我们必须最小化和 $\\sum u_i$。由于 $u_i$ 是非负整数，它们的和的最小可能值为 $0$。这在 $u=(0,0,0,0)$ 时发生。\n\n我们来测试这个最小选择。如果 $u=(0,0,0,0)$，向量 $a$ 是：\n$$ a = (1,1,1,1)^T + L \\cdot (0,0,0,0)^T = (1,1,1,1)^T $$\n我们必须验证这个向量 $a$ 满足条件 $a_i \\ge 0$。确实，$a=(1,1,1,1)$ 的所有分量都是非负的。\n这个 $u=(0,0,0,0)$ 的选择最小化了 $\\sum u_i$ 并产生了一个有效的 $a$。因此，向量 $a=(1,1,1,1)$ 是最小化 $\\sum a_i$ 的解。\n\n对于这个解，$S(e+a) = S((2,2,2,2)+(1,1,1,1)) = S((3,3,3,3))$。由于 $(3,3,3,3)$ 是稳定的，$S((3,3,3,3)) = (3,3,3,3) = z$，这证实了解的正确性。\n\n所要求的最小向量 $a$ 是 $(1,1,1,1)$。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 1  1  1  1 \\end{pmatrix} } $$"
        }
    ]
}