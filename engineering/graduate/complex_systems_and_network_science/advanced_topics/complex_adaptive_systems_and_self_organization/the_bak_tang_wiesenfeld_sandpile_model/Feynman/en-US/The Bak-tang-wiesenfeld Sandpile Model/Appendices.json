{
    "hands_on_practices": [
        {
            "introduction": "The Bak-Tang-Wiesenfeld (BTW) model is famously tractable due to its Abelian property, which guarantees that the final stable state is independent of the sequence of toppling events. This first exercise provides a direct, hands-on opportunity to verify this cornerstone property in a small system . By working through the stabilization process in different orders, you will build a concrete intuition for why the long-term behavior of the sandpile is so predictable.",
            "id": "4307527",
            "problem": "Consider the Bak-Tang-Wiesenfeld (BTW) sandpile model on a $2\\times 2$ open lattice with a single dissipative sink representing the exterior of the lattice. Each site has the standard square-lattice cardinal neighbors and uses the threshold $z_{c}=4$: when a site topples, it loses $4$ grains and sends $1$ grain to each of its four cardinal directions; grains sent off-lattice are absorbed by the sink. Label the sites by coordinates $(i,j)$ with $i,j\\in\\{1,2\\}$, and let the initial height configuration be\n$$\nh^{(0)}=\\begin{pmatrix}\n4 & 2\\\\\n2 & 4\n\\end{pmatrix}.\n$$\nThis configuration has exactly two unstable sites, $(1,1)$ and $(2,2)$. Define the odometer function $u:\\{1,2\\}^{2}\\to\\mathbb{N}$ by $u(i,j)$ equals the number of topplings performed at site $(i,j)$ during stabilization. Using only the core definitions of the BTW model and the open boundary condition, perform a complete stabilization twice: first by toppling $(1,1)$ before $(2,2)$, and second by toppling $(2,2)$ before $(1,1)$, thereafter continuing with any legal sequence until all sites are stable in each case. Derive, from first principles, the final stabilized configuration $h^{(\\infty)}$ and the odometer function $u$, and demonstrate that both are independent of the initial order of the two topplings. Express your final answer as a pair consisting of the stabilized $2\\times 2$ configuration matrix and the $2\\times 2$ odometer matrix, written side by side inside a single row matrix. No rounding is required.",
            "solution": "The problem is valid as it is scientifically grounded in the well-established Bak-Tang-Wiesenfeld (BTW) sandpile model, is well-posed with a complete and consistent set of givens, and is expressed in objective, formal language. We proceed with the solution.\n\nThe problem considers a BTW sandpile model on a $2 \\times 2$ open lattice. The sites are labeled $(i,j)$ where $i, j \\in \\{1, 2\\}$. The toppling threshold is $z_c = 4$. When a site $(i,j)$ with height $h(i,j) \\ge 4$ topples, its height changes by $h(i,j) \\to h(i,j) - 4$, and each of its cardinal neighbors $(i',j')$ receives one grain, $h(i',j') \\to h(i',j') + 1$. Grains sent to a location off the lattice are lost.\n\nThe initial height configuration is given by the matrix $h^{(0)}$:\n$$\nh^{(0)} = \\begin{pmatrix} 4 & 2 \\\\ 2 & 4 \\end{pmatrix}\n$$\nThe initial odometer function matrix, which counts the number of topplings at each site, is:\n$$\nu^{(0)} = \\begin{pmatrix} 0 & 0 \\\\ 0 & 0 \\end{pmatrix}\n$$\nThe change in the height configuration matrix due to a single toppling at site $(i,j)$ can be represented by adding a specific change matrix, $C^{(i,j)}$. For the $2 \\times 2$ open lattice, these matrices are:\n- Toppling at $(1,1)$: Loses $4$ grains, sends $1$ to $(1,2)$, $1$ to $(2,1)$, and $2$ to the exterior.\n$$ C^{(1,1)} = \\begin{pmatrix} -4 & 1 \\\\ 1 & 0 \\end{pmatrix} $$\n- Toppling at $(1,2)$: Loses $4$ grains, sends $1$ to $(1,1)$, $1$ to $(2,2)$, and $2$ to the exterior.\n$$ C^{(1,2)} = \\begin{pmatrix} 1 & -4 \\\\ 0 & 1 \\end{pmatrix} $$\n- Toppling at $(2,1)$: Loses $4$ grains, sends $1$ to $(1,1)$, $1$ to $(2,2)$, and $2$ to the exterior.\n$$ C^{(2,1)} = \\begin{pmatrix} 1 & 0 \\\\ -4 & 1 \\end{pmatrix} $$\n- Toppling at $(2,2)$: Loses $4$ grains, sends $1$ to $(1,2)$, $1$ to $(2,1)$, and $2$ to the exterior.\n$$ C^{(2,2)} = \\begin{pmatrix} 0 & 1 \\\\ 1 & -4 \\end{pmatrix} $$\n\nThe initial configuration $h^{(0)}$ has two unstable sites, $(1,1)$ and $(2,2)$, since their heights ($4$) are greater than or equal to the threshold $z_c=4$. We will perform the stabilization in two different orders as requested.\n\n### Case 1: Toppling site $(1,1)$ first\n\n**Step 1:** Topple site $(1,1)$.\nThe height matrix becomes $h^{(1)} = h^{(0)} + C^{(1,1)}$.\n$$\nh^{(1)} = \\begin{pmatrix} 4 & 2 \\\\ 2 & 4 \\end{pmatrix} + \\begin{pmatrix} -4 & 1 \\\\ 1 & 0 \\end{pmatrix} = \\begin{pmatrix} 0 & 3 \\\\ 3 & 4 \\end{pmatrix}\n$$\nThe odometer matrix is updated:\n$$\nu^{(1)} = u^{(0)} + \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix}\n$$\nThe only unstable site is now $(2,2)$.\n\n**Step 2:** Topple site $(2,2)$.\nThe height matrix becomes $h^{(2)} = h^{(1)} + C^{(2,2)}$.\n$$\nh^{(2)} = \\begin{pmatrix} 0 & 3 \\\\ 3 & 4 \\end{pmatrix} + \\begin{pmatrix} 0 & 1 \\\\ 1 & -4 \\end{pmatrix} = \\begin{pmatrix} 0 & 4 \\\\ 4 & 0 \\end{pmatrix}\n$$\nThe odometer matrix is updated:\n$$\nu^{(2)} = u^{(1)} + \\begin{pmatrix} 0 & 0 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}\n$$\nThe unstable sites are now $(1,2)$ and $(2,1)$. We can topple them in any order. Let's choose $(1,2)$ first.\n\n**Step 3:** Topple site $(1,2)$.\nThe height matrix becomes $h^{(3)} = h^{(2)} + C^{(1,2)}$.\n$$\nh^{(3)} = \\begin{pmatrix} 0 & 4 \\\\ 4 & 0 \\end{pmatrix} + \\begin{pmatrix} 1 & -4 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 4 & 1 \\end{pmatrix}\n$$\nThe odometer matrix is updated:\n$$\nu^{(3)} = u^{(2)} + \\begin{pmatrix} 0 & 1 \\\\ 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 1 & 1 \\\\ 0 & 1 \\end{pmatrix}\n$$\nThe only unstable site is now $(2,1)$.\n\n**Step 4:** Topple site $(2,1)$.\nThe height matrix becomes $h^{(4)} = h^{(3)} + C^{(2,1)}$.\n$$\nh^{(4)} = \\begin{pmatrix} 1 & 0 \\\\ 4 & 1 \\end{pmatrix} + \\begin{pmatrix} 1 & 0 \\\\ -4 & 1 \\end{pmatrix} = \\begin{pmatrix} 2 & 0 \\\\ 0 & 2 \\end{pmatrix}\n$$\nThe odometer matrix is updated:\n$$\nu^{(4)} = u^{(3)} + \\begin{pmatrix} 0 & 0 \\\\ 1 & 0 \\end{pmatrix} = \\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix}\n$$\nAll heights are now less than $z_c=4$. The system is stable. The final configuration is $h_{1}^{(\\infty)} = h^{(4)}$ and the final odometer is $u_{1} = u^{(4)}$.\n\n### Case 2: Toppling site $(2,2)$ first\n\n**Step 1:** Topple site $(2,2)$.\nThe height matrix becomes $h'^{(1)} = h^{(0)} + C^{(2,2)}$.\n$$\nh'^{(1)} = \\begin{pmatrix} 4 & 2 \\\\ 2 & 4 \\end{pmatrix} + \\begin{pmatrix} 0 & 1 \\\\ 1 & -4 \\end{pmatrix} = \\begin{pmatrix} 4 & 3 \\\\ 3 & 0 \\end{pmatrix}\n$$\nThe odometer matrix is updated:\n$$\nu'^{(1)} = u^{(0)} + \\begin{pmatrix} 0 & 0 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ 0 & 1 \\end{pmatrix}\n$$\nThe only unstable site is now $(1,1)$.\n\n**Step 2:** Topple site $(1,1)$.\nThe height matrix becomes $h'^{(2)} = h'^{(1)} + C^{(1,1)}$.\n$$\nh'^{(2)} = \\begin{pmatrix} 4 & 3 \\\\ 3 & 0 \\end{pmatrix} + \\begin{pmatrix} -4 & 1 \\\\ 1 & 0 \\end{pmatrix} = \\begin{pmatrix} 0 & 4 \\\\ 4 & 0 \\end{pmatrix}\n$$\nThe odometer matrix is updated:\n$$\nu'^{(2)} = u'^{(1)} + \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}\n$$\nThe unstable sites are now $(1,2)$ and $(2,1)$. Note that $h'^{(2)} = h^{(2)}$ and $u'^{(2)} = u^{(2)}$, demonstrating the Abelian property at an intermediate stage. We continue the stabilization. Let's topple $(2,1)$ first this time.\n\n**Step 3:** Topple site $(2,1)$.\nThe height matrix becomes $h'^{(3)} = h'^{(2)} + C^{(2,1)}$.\n$$\nh'^{(3)} = \\begin{pmatrix} 0 & 4 \\\\ 4 & 0 \\end{pmatrix} + \\begin{pmatrix} 1 & 0 \\\\ -4 & 1 \\end{pmatrix} = \\begin{pmatrix} 1 & 4 \\\\ 0 & 1 \\end{pmatrix}\n$$\nThe odometer matrix is updated:\n$$\nu'^{(3)} = u'^{(2)} + \\begin{pmatrix} 0 & 0 \\\\ 1 & 0 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 1 & 1 \\end{pmatrix}\n$$\nThe only unstable site is now $(1,2)$.\n\n**Step 4:** Topple site $(1,2)$.\nThe height matrix becomes $h'^{(4)} = h'^{(3)} + C^{(1,2)}$.\n$$\nh'^{(4)} = \\begin{pmatrix} 1 & 4 \\\\ 0 & 1 \\end{pmatrix} + \\begin{pmatrix} 1 & -4 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 2 & 0 \\\\ 0 & 2 \\end{pmatrix}\n$$\nThe odometer matrix is updated:\n$$\nu'^{(4)} = u'^{(3)} + \\begin{pmatrix} 0 & 1 \\\\ 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix}\n$$\nThe system is now stable. The final configuration is $h_{2}^{(\\infty)} = h'^{(4)}$ and the final odometer is $u_{2} = u'^{(4)}$.\n\n### Conclusion\nBy direct calculation, we have shown that both sequences lead to the identical final state and odometer function:\n$$\nh_{1}^{(\\infty)} = h_{2}^{(\\infty)} = \\begin{pmatrix} 2 & 0 \\\\ 0 & 2 \\end{pmatrix}\n$$\n$$\nu_{1} = u_{2} = \\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix}\n$$\nThis demonstrates from first principles that, for this specific initial configuration, the final stabilized configuration $h^{(\\infty)}$ and the odometer function $u$ are independent of the order of toppling operations. This is a specific instance of the general Abelian property of the BTW sandpile model.\n\nThe final answer consists of the unique stabilized configuration matrix and the unique final odometer matrix.\nFinal stabilized configuration:\n$$\nh^{(\\infty)} = \\begin{pmatrix} 2 & 0 \\\\ 0 & 2 \\end{pmatrix}\n$$\nFinal odometer function:\n$$\nu = \\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix}\n$$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\begin{pmatrix} 2 & 0 \\\\ 0 & 2 \\end{pmatrix}\n&\n\\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "With an understanding of the model's fundamental rules, we can now tackle a more complex avalanche on a larger lattice. This practice challenges you to predict the outcome of adding a single grain of sand to a nearly critical system, a classic scenario for triggering large events in self-organized criticality. You will apply conservation laws and exploit the system's symmetry to determine the final state and toppling pattern, showcasing powerful analytical techniques that bypass the need to simulate every individual toppling event .",
            "id": "4307564",
            "problem": "Consider the Bak-Tang-Wiesenfeld (BTW) sandpile model (also called the Abelian sandpile model (ASM)) on a two-dimensional square lattice with open boundaries. A configuration assigns to each lattice site an integer number of grains $z \\in \\mathbb{Z}_{\\ge 0}$. A site is unstable if $z \\ge 4$. An unstable site topples by sending $1$ grain to each of its four lattice directions and losing $4$ grains in total; grains sent off the lattice are lost to a sink (open boundary). A configuration is stable if every site has $z \\in \\{0,1,2,3\\}$. The Abelian property guarantees that the final stable configuration and the number of topplings at each site are independent of the toppling order.\n\nOn a $3 \\times 3$ open lattice, start from the uniform configuration $z_{i}=3$ at every site $i$. Add $1$ grain at the center site only, and then stabilize by repeated toppling until all sites are stable.\n\nUsing only the modelâ€™s dynamical rules and conservation of grains on the lattice (i.e., any decrease at a site is balanced by increases at its neighbors or loss to the sink), determine:\n- the final stable height at each site, and\n- the total number of topplings at each site during stabilization.\n\nExpress your final answer as a single row vector with $18$ entries: first list the $9$ final heights in row-major order (from the top-left to the bottom-right site), followed by the $9$ toppling counts in the same row-major order. No rounding is required.",
            "solution": "We begin from the definitions of the Bak-Tang-Wiesenfeld (BTW) sandpile model on a square lattice with open boundaries. A toppling at a site reduces its height by $4$ and increases the height of each of its up to four neighbors by $1$. On an open boundary, any grain sent to a non-existent neighbor is lost to a sink. A configuration is stable if each site has height less than $4$. The Abelian property ensures that the final stable configuration and the total number of topplings at each site do not depend on the sequence of topplings.\n\nLet the lattice sites be indexed in row-major order, and let the center site be the unique interior site. We denote by $t_{i}$ the number of topplings at site $i$ during stabilization. By conservation of grains on the lattice (accounting for loss to the sink), we have for each site $k$ the balance\n$$\nz_{\\mathrm{final}}(k) \\;=\\; z_{\\mathrm{initial}}(k) + s(k) \\;-\\; \\big(4\\,t_{k} - \\sum_{n \\sim k} t_{n}\\big),\n$$\nwhere $s(k)$ is the number of grains added at site $k$ (here $s(k)=1$ at the center and $s(k)=0$ elsewhere), and the sum is over the existing neighbors $n$ of $k$ in the $3 \\times 3$ lattice. This is the discrete conservation law derived directly from the toppling rule: each toppling at $k$ removes $4$ grains from $k$ while supplying $1$ grain to each neighbor; grains to missing neighbors are lost.\n\nBy symmetry under the dihedral group of the square (rotations and reflections fixing the center), the odometer function (the vector of toppling counts) takes only three distinct values:\n- $x$ at the center site,\n- $y$ at each of the four edge-center sites,\n- $z$ at each of the four corner sites.\nSimilarly, the final heights will have the same symmetry classes.\n\nWrite the balance for each orbit-type:\n\n1. Center site. Its neighbors are the four edge centers. The discrete Laplacian term is $4x - 4y$, hence\n$$\nz_{\\mathrm{final}}(\\text{center}) \\;=\\; 3 + 1 \\;-\\; (4x - 4y) \\;=\\; 4 - 4x + 4y.\n$$\n\n2. Edge-center site. Its neighbors within the lattice are the center and two adjacent corners. The discrete Laplacian term is $4y - (x + 2z)$, hence\n$$\nz_{\\mathrm{final}}(\\text{edge}) \\;=\\; 3 \\;-\\; \\big(4y - x - 2z\\big) \\;=\\; 3 - 4y + x + 2z.\n$$\n\n3. Corner site. Its neighbors within the lattice are the two adjacent edge centers. The discrete Laplacian term is $4z - 2y$, hence\n$$\nz_{\\mathrm{final}}(\\text{corner}) \\;=\\; 3 \\;-\\; \\big(4z - 2y\\big) \\;=\\; 3 - 4z + 2y.\n$$\n\nStability requires $z_{\\mathrm{final}} \\in \\{0,1,2,3\\}$ everywhere, and the odometer values $x,y,z$ must be nonnegative integers. Moreover, by the least action principle for the Abelian sandpile model, the realized odometer is the pointwise minimal nonnegative integer function for which the resulting $z_{\\mathrm{final}}$ is stable.\n\nWe now construct a legal toppling sequence and read off $(x,y,z)$, then verify stability.\n\nStart from $z \\equiv 3$ and add $1$ at the center:\n- The center becomes $4$ and topples once: $x \\leftarrow 1$, center decreases by $4$ to $0$, each edge-center increases by $1$ to $4$, corners remain at $3$.\n- Each of the four edge centers is now at $4$; topple each once: $y \\leftarrow 1$ at each edge. Each edge-center decreases by $4$ to $0$, sending $1$ grain to the center and $1$ to each adjacent corner (and $1$ to the sink). After all four edge topplings, the center gains $4$ (one from each edge) and becomes $4$, and each corner gains $2$ (from its two adjacent edges) and becomes $5$.\n- The center at $4$ topples once more: $x \\leftarrow 2$, sending $1$ to each edge-center. The edges become $1$, corners remain at $5$, center returns to $0$.\n- Each corner at $5$ topples once: $z \\leftarrow 1$ at each corner. Each corner decreases by $4$ to $1$, sending $1$ to each adjacent edge-center and $2$ to the sink. Each edge-center receives $2$ from its two adjacent corners and becomes $3$.\n\nThe resulting configuration is:\n- Center: $0$,\n- Edge centers: $3$,\n- Corners: $1$.\n\nNo site has height at least $4$, so the configuration is stable. The total number of topplings is:\n- Center: $x=2$,\n- Edge centers: $y=1$,\n- Corners: $z=1$.\n\nTo confirm consistency, we verify with the conservation equations:\n\n- Center: $z_{\\mathrm{final}} = 4 - 4x + 4y = 4 - 8 + 4 = 0$.\n- Edge: $z_{\\mathrm{final}} = 3 - 4y + x + 2z = 3 - 4 + 2 + 2 = 3$.\n- Corner: $z_{\\mathrm{final}} = 3 - 4z + 2y = 3 - 4 + 2 = 1$.\n\nThus the final configuration and toppling counts are uniquely determined. In row-major order (top-left to bottom-right), the final heights are\n$$\n1,\\;3,\\;1,\\;3,\\;0,\\;3,\\;1,\\;3,\\;1,\n$$\nand the toppling counts are\n$$\n1,\\;1,\\;1,\\;1,\\;2,\\;1,\\;1,\\;1,\\;1.\n$$\n\nBy the Abelian property, any legal toppling sequence yields the same result, and by the least action principle, the above odometer is minimal and hence the unique solution.",
            "answer": "$$\\boxed{\\begin{pmatrix}1 & 3 & 1 & 3 & 0 & 3 & 1 & 3 & 1 & 1 & 1 & 1 & 1 & 2 & 1 & 1 & 1 & 1\\end{pmatrix}}$$"
        },
        {
            "introduction": "Beyond its dynamical rules, the set of stable configurations in the BTW model possesses a deep and elegant algebraic structure known as the Abelian sandpile group, whose elements are the model's *recurrent* configurations. This advanced exercise introduces Dhar's \"burning test,\" an efficient algorithm for identifying these special states . By exploring the relationship between a given configuration, the group identity, and the burning test, you will bridge the gap between the physics of avalanches and the abstract framework of group theory.",
            "id": "4307553",
            "problem": "Consider the standard Bak-Tang-Wiesenfeld (BTW) Abelian sandpile model on a finite two-dimensional square lattice with open boundary conditions. The lattice is a $2 \\times 2$ grid of non-sink vertices, with a single absorbing sink that collects grains that leave the lattice. Each non-sink vertex has toppling threshold $4$ and, when it topples, it sends one grain to each of its orthogonal neighbors; grains sent off-lattice are absorbed by the sink. Let the reduced graph Laplacian be the $4 \\times 4$ matrix whose diagonal entries are $4$ and whose off-diagonal entry is $-1$ for each pair of adjacent non-sink vertices and $0$ otherwise. Index the four non-sink vertices as $1$ (top-left), $2$ (top-right), $3$ (bottom-left), and $4$ (bottom-right).\n\nDefine the burning configuration $b$ by $b_{i}$ equal to the number of edges from vertex $i$ to the sink. On the $2 \\times 2$ grid, each of the four vertices is a corner, hence $b_{i} = 2$ for all $i \\in \\{1,2,3,4\\}$.\n\nGiven the stable configuration $z = (3,3,3,3)$ on this $2 \\times 2$ open lattice:\n- Use the burning test, starting from the foundational definitions of stability, toppling, and the burning configuration, to determine whether $z$ is recurrent.\n- If $z$ is recurrent, determine the Abelian sandpile group identity configuration $e$ by stabilizing the sum of the zero configuration and the burning configuration $b$. Then find a nonnegative integer addition vector $a = (a_{1},a_{2},a_{3},a_{4})$ such that stabilizing $e + a$ yields $z$. Among all such $a$, select the one that minimizes $\\sum_{i=1}^{4} a_{i}$.\n\nReport only the vector $a$ in the final answer, as a row vector in the order $(1,2,3,4)$.",
            "solution": "The problem requires a three-part solution. We address each part sequentially.\n\n**Part 1: The Burning Test for Recurrence**\nA stable configuration $c$ is defined as recurrent if, starting from the configuration $c' = c + b$, the system can be stabilized through a sequence of topples where each site topples at most once. The given stable configuration is $z=(3,3,3,3)$, and the burning configuration is $b=(2,2,2,2)$.\n\nLet's compute the initial configuration for the burning test:\n$$ c' = z + b = (3,3,3,3) + (2,2,2,2) = (5,5,5,5) $$\nThe toppling threshold is $Z_{\\text{crit}} = 4$. Since all sites have a height of $5$, all four sites are unstable. We can topple them in any order due to the Abelian property of the model. Let's choose the order $1, 2, 3, 4$.\n\nThe toppling matrix is $\\Delta_T = -L$:\n$$ \\Delta_T = \\begin{pmatrix} -4 & 1 & 1 & 0 \\\\ 1 & -4 & 0 & 1 \\\\ 1 & 0 & -4 & 1 \\\\ 0 & 1 & 1 & -4 \\end{pmatrix} $$\n\n1.  **Initial state**: $c_0 = (5,5,5,5)$. All sites unstable.\n2.  **Topple site 1**: The change is given by the first column of $\\Delta_T$.\n    $$ c_1 = c_0 + (-4, 1, 1, 0) = (5-4, 5+1, 5+1, 5+0) = (1, 6, 6, 5) $$\n    Site $1$ has now toppled once. Sites $2, 3, 4$ are unstable.\n3.  **Topple site 2**: The change is given by the second column of $\\Delta_T$.\n    $$ c_2 = c_1 + (1, -4, 0, 1) = (1+1, 6-4, 6+0, 5+1) = (2, 2, 6, 6) $$\n    Site $2$ has now toppled once. Sites $3, 4$ are unstable.\n4.  **Topple site 3**: The change is given by the third column of $\\Delta_T$.\n    $$ c_3 = c_2 + (1, 0, -4, 1) = (2+1, 2+0, 6-4, 6+1) = (3, 2, 2, 7) $$\n    Site $3$ has now toppled once. Site $4$ is unstable.\n5.  **Topple site 4**: The change is given by the fourth column of $\\Delta_T$.\n    $$ c_4 = c_3 + (0, 1, 1, -4) = (3+0, 2+1, 2+1, 7-4) = (3, 3, 3, 3) $$\n    Site $4$ has now toppled once.\n\nThe final configuration is $(3,3,3,3)$. All heights are less than $4$, so the system is stable. During this stabilization process, each site toppled exactly once. According to the burning test, this proves that the configuration $z=(3,3,3,3)$ is **recurrent**.\n\n**Part 2: Determine the Identity Configuration**\nThe problem directs us to find the identity configuration $e$ by stabilizing the sum of the zero configuration $c_{\\text{zero}}=(0,0,0,0)$ and the burning configuration $b=(2,2,2,2)$. Let $S(c)$ denote the stabilization of configuration $c$.\n$$ e = S(c_{\\text{zero}} + b) = S((0,0,0,0) + (2,2,2,2)) = S((2,2,2,2)) $$\nThe configuration $(2,2,2,2)$ has all heights $c_i = 2$, which is less than the toppling threshold $Z_{\\text{crit}} = 4$. Therefore, the configuration is already stable.\nThe stabilization operator $S$ does nothing to an already stable configuration.\n$$ e = (2,2,2,2) $$\n\n**Part 3: Find the Minimal Addition Vector**\nWe need to find a non-negative integer vector $a = (a_1, a_2, a_3, a_4)$ such that $S(e+a) = z$, and the sum $\\sum_{i=1}^4 a_i$ is minimized.\n\nThe condition $S(e+a) = z$ means that the configuration $e+a$ and the configuration $z$ belong to the same equivalence class in the sandpile group. Two configurations $c_{\\text{initial}}$ and $c_{\\text{final}}$ are equivalent if $c_{\\text{final}}$ can be reached from $c_{\\text{initial}}$ by a sequence of topples. This can be expressed as:\n$$ c_{\\text{final}} = c_{\\text{initial}} + \\Delta_T u $$\nwhere $u = (u_1, u_2, u_3, u_4)^T$ is a vector of non-negative integers representing the number of times each site has toppled.\n\nIn our case, $c_{\\text{initial}} = e+a$ and $c_{\\text{final}} = z = S(e+a)$. So we have:\n$$ z = (e+a) + \\Delta_T u $$\nWe can rearrange this equation to solve for $a$:\n$$ a = z - e - \\Delta_T u $$\nUsing the fact that the problem's Laplacian is $L = -\\Delta_T$, we get:\n$$ a = z - e + L u $$\nWe are given $z=(3,3,3,3)$ and we found $e=(2,2,2,2)$. The difference is:\n$$ z - e = (1,1,1,1) $$\nSubstituting this in the equation for $a$:\n$$ a = (1,1,1,1)^T + L u $$\nOur goal is to find a non-negative integer vector $u$ that minimizes $\\sum a_i$, subject to the constraint that the resulting vector $a$ must also be non-negative, i.e., $a_i \\ge 0$ for all $i$.\n\nLet's express the sum $\\sum a_i$ in terms of $u$. We can write $\\sum a_i$ as the dot product $\\mathbf{1}^T a$, where $\\mathbf{1}=(1,1,1,1)^T$.\n$$ \\sum_{i=1}^4 a_i = \\mathbf{1}^T a = \\mathbf{1}^T (z-e) + \\mathbf{1}^T L u $$\nWe already have $\\mathbf{1}^T(z-e) = 1+1+1+1=4$. Let's compute $\\mathbf{1}^T L$:\n$$ \\mathbf{1}^T L = (1,1,1,1) \\begin{pmatrix} 4 & -1 & -1 & 0 \\\\ -1 & 4 & 0 & -1 \\\\ -1 & 0 & 4 & -1 \\\\ 0 & -1 & -1 & 4 \\end{pmatrix} $$\nThe $j$-th component of this row vector is the sum of the entries in the $j$-th column of $L$.\n- Column 1 sum: $4-1-1+0 = 2$\n- Column 2 sum: $-1+4+0-1 = 2$\n- Column 3 sum: $-1+0+4-1 = 2$\n- Column 4 sum: $0-1-1+4 = 2$\nSo, $\\mathbf{1}^T L = (2,2,2,2) = 2 \\mathbf{1}^T$.\nThe sum is then:\n$$ \\sum a_i = 4 + (2,2,2,2) \\begin{pmatrix} u_1 \\\\ u_2 \\\\ u_3 \\\\ u_4 \\end{pmatrix} = 4 + 2(u_1+u_2+u_3+u_4) = 4 + 2 \\sum u_i $$\nTo minimize $\\sum a_i$, we must minimize the sum $\\sum u_i$. Since $u_i$ are non-negative integers, the smallest possible value for their sum is $0$. This occurs when $u=(0,0,0,0)$.\n\nLet's test this minimal choice. If $u=(0,0,0,0)$, the vector $a$ is:\n$$ a = (1,1,1,1)^T + L \\cdot (0,0,0,0)^T = (1,1,1,1)^T $$\nWe must verify that this vector $a$ satisfies the condition $a_i \\ge 0$. Indeed, $a=(1,1,1,1)$ has all components non-negative.\nThis choice of $u=(0,0,0,0)$ minimizes $\\sum u_i$ and yields a valid $a$. Therefore, the vector $a=(1,1,1,1)$ is the solution that minimizes $\\sum a_i$.\n\nFor this solution, $S(e+a) = S((2,2,2,2)+(1,1,1,1)) = S((3,3,3,3))$. Since $(3,3,3,3)$ is stable, $S((3,3,3,3)) = (3,3,3,3) = z$, which confirms the solution's correctness.\n\nThe requested minimal vector $a$ is $(1,1,1,1)$.",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 1 & 1 & 1 & 1 \\end{pmatrix} } $$"
        }
    ]
}