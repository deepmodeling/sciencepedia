{
    "hands_on_practices": [
        {
            "introduction": "蛋白质-蛋白质相互作用（PPI）网络本质上不仅仅是二元的“是/否”连接图。一个相互作用的强度或可信度至关重要，这决定了其在生物过程中的作用。本练习将指导您如何通过整合来自三维蛋白质结构的多种生物物理特征，来量化这种相互作用强度，从而为网络的每条边赋予有意义的权重 。练习的核心在于阐明一个复合评分（如几何平均数）如何将不同的数据源（如界面面积、结合自由能）综合成一个单一、稳健的可信度指标，这种方法是构建超越简单二元表示的高质量加权PPI网络的基础。",
            "id": "2423170",
            "problem": "给定一个图，其中每个节点代表一个蛋白质，每条边代表蛋白质-蛋白质相互作用（PPI）网络中两个蛋白质之间的假定相互作用。对于每条相互作用边，提供了五个源自三维（3D）结构数据的物理和结构描述符：界面面积、结合自由能、界面氢键数量、界面疏水残基比例，以及平均原子位移参数（B因子）。使用这些描述符，为每个相互作用定义一个无量纲置信度权重，该权重随着界面变大和变稳定而增加。\n\n为一个具有界面面积$A$（单位 $\\text{Å}^2$）、结合自由能$\\Delta G$（单位 $\\text{kcal/mol}$）、氢键数量 $h$（无单位）、疏水比例 $f_h$（在 $\\left[0,1\\right]$ 范围内的分数）和平均B因子 $B$（单位 $\\text{Å}^2$）的相互作用，定义以下无量纲子分数：\n- 面积子分数：$S_A = \\min\\!\\left(1, \\dfrac{A}{A_0}\\right)$，其中 $A_0 = 2000 \\text{ Å}^2$。\n- 自由能子分数：$S_G = \\dfrac{1}{1 + \\exp\\!\\left(\\beta \\left(\\Delta G - \\Delta G_0\\right)\\right)}$，其中 $\\Delta G_0 = -6 \\text{ kcal/mol}$ 且 $\\beta = 0.5 \\text{ (kcal/mol)}^{-1}$。\n- 氢键子分数：$S_H = \\tanh\\!\\left(\\dfrac{h}{h_0}\\right)$，其中 $h_0 = 10$。\n- 疏水性子分数：$S_F = f_h$。\n- 柔性子分数：$S_B = \\dfrac{1}{1 + \\dfrac{B}{B_0}}$，其中 $B_0 = 30 \\text{ Å}^2$。\n\n将最终置信度权重定义为五个子分数的几何平均值：\n$$\nw \\;=\\; \\left(S_A \\cdot S_G \\cdot S_H \\cdot S_F \\cdot S_B\\right)^{1/5}.\n$$\n\n所有输入必须使用上述指定的单位。输出是无量纲的。\n\n实现一个程序，为以下每个测试用例计算 $w$，每个用例以一个 5元组 $(A,\\ \\Delta G,\\ h,\\ f_h,\\ B)$ 的形式给出：\n1. $(1800,\\ -10,\\ 12,\\ 0.6,\\ 15)$\n2. $(400,\\ -2,\\ 2,\\ 0.3,\\ 50)$\n3. $(0,\\ -5,\\ 5,\\ 0.5,\\ 20)$\n4. $(2500,\\ -5,\\ 5,\\ 0.8,\\ 60)$\n5. $(700,\\ -7,\\ 20,\\ 0.4,\\ 10)$\n6. $(800,\\ -15,\\ 8,\\ 1.0,\\ 25)$\n\n选择这些案例是为了覆盖典型的强相互作用、弱相互作用、零面积边界情况、具有高柔性的面积饱和边界情况、具有许多氢键和低柔性但面积较小的情况，以及具有极有利自由能和最大疏水比例的情况。\n\n你的程序应产生单行输出，包含一个由方括号括起来的逗号分隔列表形式的结果，其中每个权重都四舍五入到小数点后恰好六位（例如，“[0.123456,0.654321,0.500000,0.000000,0.999999,0.314159]”）。",
            "solution": "问题陈述是有效的。它提出了一个计算上易于处理且在生物物理学上合理的模型，用于评估蛋白质-蛋白质相互作用证据的置信度。使用源自 $3$D 结构数据的多个正交描述符是结构生物信息学中的一种标准且稳健的做法。所提供的评分函数和常数与既定原则一致。我们将对置信度权重 $w$ 进行系统性分析。\n\n该模型将复合置信度权重 $w$ 定义为 $5$ 个无量纲子分数的几何平均值，每个子分数对应蛋白质-蛋白质界面的一个关键生物物理特性。\n\n$1$。**面积子分数 ($S_A$)**: $S_A = \\min\\!\\left(1, \\dfrac{A}{A_0}\\right)$，其中参考面积 $A_0 = 2000 \\, \\text{Å}^2$。\n蛋白质复合物的稳定性与结合时埋藏的表面积 $A$ 的大小密切相关。该函数模型化了置信度随面积线性增加直至饱和点的过程。大于或等于 $A_0$ 的界面面积被认为足以形成稳定的复合物，因此获得最高分 $1$。这可以防止过大的界面不成比例地主导最终分数。面积 $A=0 \\, \\text{Å}^2$ 正确地得出 $S_A=0$，表示没有物理接触。\n\n$2$。**自由能子分数 ($S_G$)**: $S_G = \\dfrac{1}{1 + \\exp\\!\\left(\\beta \\left(\\Delta G - \\Delta G_0\\right)\\right)}$，其中 $\\Delta G_0 = -6 \\, \\text{kcal/mol}$ 且 $\\beta = 0.5 \\, (\\text{kcal/mol})^{-1}$。\n这是一个标准的逻辑斯谛函数，它将结合自由能 $\\Delta G$ 映射到 $0$ 和 $1$ 之间的一个分数。更负的 $\\Delta G$ 值表示更有利的结合，这正确地对应于更高的 $S_G$ 值。参数 $\\Delta G_0$ 是S型曲线的中点，代表了特异性相互作用的一个典型阈值。参数 $\\beta$ 控制过渡的陡峭程度，决定了分数对 $\\Delta G_0$ 附近 $\\Delta G$ 变化的响应敏感度。\n\n$3$。**氢键子分数 ($S_H$)**: $S_H = \\tanh\\!\\left(\\dfrac{h}{h_0}\\right)$，其中参考数量 $h_0 = 10$。\n氢键 $h$ 对于蛋白质界面的特异性和稳定性至关重要。双曲正切函数 $\\tanh$ 提供了一个平滑且饱和的分数。随着氢键数量的增加，分数会渐近地接近 $1$。参考值 $h_0$ 对数量进行归一化，当 $h=h_0$ 时，对应的分数为 $\\tanh(1) \\approx 0.76$。\n\n$4$。**疏水性子分数 ($S_F$)**: $S_F = f_h$。\n疏水效应是蛋白质折叠和缔合的一个主要驱动力。该子分数就是界面处疏水残基的比例 $f_h$，它是对此贡献的一个直接度量。值 $f_h$ 本身就是一个在 $0$ 和 $1$ 之间的无量纲分数，无需进一步转换。\n\n$5$。**柔性子分数 ($S_B$)**: $S_B = \\dfrac{1}{1 + \\dfrac{B}{B_0}}$，其中参考B因子 $B_0 = 30 \\, \\text{Å}^2$。\n晶体学B因子 $B$ 是原子位移的一种度量，反映了局部的结构柔性。一个有序且稳定的界面通常具有较低的B因子。这个评分函数正确地表示了一种反比关系：随着柔性 $B$ 的增加，分数 $S_B$ 减小，并渐近地接近 $0$。参考值 $B_0$ 作为区分刚性（低 $B$）和柔性（高 $B$）区域的阈值。\n\n**最终置信度权重 ($w$)**: $w = \\left(S_A \\cdot S_G \\cdot S_H \\cdot S_F \\cdot S_B\\right)^{1/5}$。\n最终权重是 $5$ 个子分数的几何平均值。这是组合不同度量的一种数学上合理的选择。几何平均值的一个关键特性是其对低值的敏感性；如果任何一个子分数非常低（或为零），它将严重惩罚总体置信度权重。这确保了一个假定的相互作用必须在所有标准下都是有利的，才能被认为是高置信度的。例如，如果 $A=0$，则 $S_A=0$，这将正确地迫使最终权重 $w$ 为 $0$。\n\n计算过程如下：\n对于 $6$ 个测试用例中的每一个，以元组 $(A, \\Delta G, h, f_h, B)$ 表示，我们将：\na. 使用提供的公式和常数计算 $5$ 个子分数 $S_A, S_G, S_H, S_F, S_B$。\nb. 计算这 $5$ 个子分数的乘积。\nc. 计算该乘积的 $5$ 次方根以获得最终权重 $w$。\nd. 整理所有测试用例的结果，并根据指定的输出要求对其进行格式化。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes a dimensionless confidence weight for protein-protein interactions\n    based on five physical and structural descriptors.\n    \"\"\"\n\n    # Define the constants from the problem statement.\n    A0 = 2000.0  # Reference interface area in Å^2\n    dG0 = -6.0   # Reference binding free energy in kcal/mol\n    beta = 0.5   # Steepness parameter for the free energy score\n    h0 = 10.0    # Reference number of hydrogen bonds\n    B0 = 30.0    # Reference B-factor in Å^2\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (A, ΔG, h, f_h, B)\n    test_cases = [\n        (1800.0, -10.0, 12.0, 0.6, 15.0),\n        (400.0, -2.0, 2.0, 0.3, 50.0),\n        (0.0, -5.0, 5.0, 0.5, 20.0),\n        (2500.0, -5.0, 5.0, 0.8, 60.0),\n        (700.0, -7.0, 20.0, 0.4, 10.0),\n        (800.0, -15.0, 8.0, 1.0, 25.0)\n    ]\n\n    results = []\n    for case in test_cases:\n        A, dG, h, fh, B = case\n\n        # Step 1: Calculate the five dimensionless sub-scores.\n\n        # Area sub-score\n        S_A = min(1.0, A / A0)\n\n        # Free energy sub-score (logistic function)\n        S_G = 1.0 / (1.0 + np.exp(beta * (dG - dG0)))\n\n        # Hydrogen bond sub-score (hyperbolic tangent)\n        S_H = np.tanh(h / h0)\n\n        # Hydrophobicity sub-score\n        S_F = fh\n\n        # Flexibility sub-score\n        S_B = 1.0 / (1.0 + B / B0)\n\n        # Step 2: Calculate the product of the sub-scores.\n        product = S_A * S_G * S_H * S_F * S_B\n        \n        # Step 3: Compute the final confidence weight as the geometric mean.\n        # The 5th root is equivalent to raising to the power of 1/5.\n        # If the product is 0 (e.g., if A=0 or fh=0), the weight is correctly 0.\n        weight = product**(1.0 / 5.0)\n        \n        results.append(weight)\n\n    # Final print statement in the exact required format.\n    # The output is a single line containing a comma-separated list of weights\n    # enclosed in square brackets, with each weight rounded to six decimal places.\n    print(f\"[{','.join([f'{res:.6f}' for res in results])}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "构建网络后，下一步是分析其结构，并批判性地评估数据来源。本练习聚焦于最基础的网络度量——节点度，并探讨它与实验假象之间的关系 。此练习的核心原则是，我们观察到的网络属性可能是真实生物信号和系统性实验偏差的混合体。通过计算节点的连通性（度）与其被研究的广泛程度（覆盖度）之间的相关性，我们可以量化这种偏差的影响，这对于准确解读网络数据至关重要。",
            "id": "4381240",
            "problem": "考虑一个由$8$个标记为$P_1,\\dots,P_8$的蛋白质组成的、经过整理的、无向、无权的蛋白质-蛋白质相互作用（PPI）网络，该网络由对称邻接矩阵$A$表示，其元素$A_{ij} \\in \\{0,1\\}$且$A_{ii}=0$：\n$$\nA=\\begin{pmatrix}\n0  1  1  0  1  0  0  0 \\\\\n1  0  1  1  0  1  0  0 \\\\\n1  1  0  0  1  1  1  0 \\\\\n0  1  0  0  0  1  0  1 \\\\\n1  0  1  0  0  0  1  1 \\\\\n0  1  1  1  0  0  0  0 \\\\\n0  0  1  0  1  0  0  0 \\\\\n0  0  0  1  1  0  0  0\n\\end{pmatrix}.\n$$\n从适用于系统生物医学中无向简单图的标准图论定义出发，根据$A$的元素定义节点度$k_i$，并计算该网络的度序列$\\big(k_1,\\dots,k_8\\big)$。\n\n为了研究PPI图谱绘制中的实验覆盖度偏差（例如，亲和纯化质谱法（AP-MS）实验），假设每个蛋白质$i$都有一个测得的覆盖因子$c_i$（无量纲），反映了对该蛋白质进行的独立“诱饵”实验的相对数量，由向量给出\n$$\n\\mathbf{c}=\\big(1.2,\\ 1.8,\\ 2.2,\\ 1.3,\\ 1.7,\\ 1.4,\\ 0.9,\\ 0.8\\big).\n$$\n使用由节点索引的两个实值变量之间皮尔逊相关系数的基本定义，计算度序列$\\big(k_1,\\dots,k_8\\big)$与覆盖度向量$\\mathbf{c}$之间的相关性。将相关系数四舍五入到四位有效数字。从检测概率和采样的基本原理出发，解释为什么较高的$c_i$倾向于夸大PPI网络中观测到的度，以及在何种实验条件下，度-覆盖度相关性可能反映的是测量偏差而非真实的生物连通性。\n\n将最终答案表示为一个单行矩阵，其中包含度序列的各项$k_1,\\dots,k_8$，后跟四舍五入后的皮尔逊相关系数（无量纲）。最终答案中无需单位。",
            "solution": "该问题具有科学依据，提法恰当且客观。所有提供的数据和定义都是自洽且一致的。邻接矩阵$A$为一个无向、无权简单图的正确定义，它是对称的且对角线元素为零。任务涉及标准、明确的计算（节点度、皮尔逊相关系数）以及基于既定实验生物学和统计学原理的概念性解释。因此，该问题被认为是有效的，并将提供解答。\n\n首先，我们为给定的蛋白质-蛋白质相互作用（PPI）网络定义并计算度序列。该网络有$N=8$个蛋白质，其拓扑结构由$8 \\times 8$的邻接矩阵$A$描述。对于一个无向无权图，节点$i$的度$k_i$是与其相连的边的数量。用邻接矩阵$A$的术语来说，如果节点$i$和$j$之间存在一条边，则$A_{ij}=1$，否则$A_{ij}=0$。度$k_i$是第$i$行（或由于对称性，第$i$列）元素的总和。\n$$k_i = \\sum_{j=1}^{N} A_{ij}$$\n使用这个定义，我们通过对给定矩阵$A$的各行求和来计算每个蛋白质$P_1, \\dots, P_8$的度：\n$k_1 = 0+1+1+0+1+0+0+0 = 3$\n$k_2 = 1+0+1+1+0+1+0+0 = 4$\n$k_3 = 1+1+0+0+1+1+1+0 = 5$\n$k_4 = 0+1+0+0+0+1+0+1 = 3$\n$k_5 = 1+0+1+0+0+0+1+1 = 4$\n$k_6 = 0+1+1+1+0+0+0+0 = 3$\n$k_7 = 0+0+1+0+1+0+0+0 = 2$\n$k_8 = 0+0+0+1+1+0+0+0 = 2$\n得到的度序列是向量$\\mathbf{k} = \\big(k_1, k_2, k_3, k_4, k_5, k_6, k_7, k_8\\big) = \\big(3, 4, 5, 3, 4, 3, 2, 2\\big)$。\n\n接下来，我们计算度序列$\\mathbf{k}$与给定的覆盖度向量$\\mathbf{c} = \\big(1.2, 1.8, 2.2, 1.3, 1.7, 1.4, 0.9, 0.8\\big)$之间的皮尔逊相关系数。对于两组各有$n$个测量值的数据$X = (x_1, \\dots, x_n)$和$Y = (y_1, \\dots, y_n)$，皮尔逊相关系数$r$定义为：\n$$r_{XY} = \\frac{\\sum_{i=1}^{n} (x_i - \\bar{x})(y_i - \\bar{y})}{\\sqrt{\\sum_{i=1}^{n} (x_i - \\bar{x})^2} \\sqrt{\\sum_{i=1}^{n} (y_i - \\bar{y})^2}}$$\n其中$\\bar{x}$和$\\bar{y}$是样本均值，$\\bar{x} = \\frac{1}{n} \\sum_{i=1}^{n} x_i$且$\\bar{y} = \\frac{1}{n} \\sum_{i=1}^{n} y_i$。\n在我们的例子中，$n=8$，$X = \\mathbf{k}$，$Y = \\mathbf{c}$。我们首先计算均值：\n$$\\bar{k} = \\frac{1}{8} \\sum_{i=1}^{8} k_i = \\frac{3+4+5+3+4+3+2+2}{8} = \\frac{26}{8} = 3.25$$\n$$\\bar{c} = \\frac{1}{8} \\sum_{i=1}^{8} c_i = \\frac{1.2+1.8+2.2+1.3+1.7+1.4+0.9+0.8}{8} = \\frac{11.3}{8} = 1.4125$$\n现在我们计算所需的三个求和项：\n偏差乘积之和（分子的协方差项）：\n$$ \\sum_{i=1}^{8} (k_i - \\bar{k})(c_i - \\bar{c}) = (3 - 3.25)(1.2 - 1.4125) + (4 - 3.25)(1.8 - 1.4125) + \\dots + (2 - 3.25)(0.8 - 1.4125) $$\n$$ = (-0.25)(-0.2125) + (0.75)(0.3875) + (1.75)(0.7875) + (-0.25)(-0.1125) + (0.75)(0.2875) + (-0.25)(-0.0125) + (-1.25)(-0.5125) + (-1.25)(-0.6125) $$\n$$ = 0.053125 + 0.290625 + 1.378125 + 0.028125 + 0.215625 + 0.003125 + 0.640625 + 0.765625 = 3.375 $$\n$k$的离差平方和：\n$$ \\sum_{i=1}^{8} (k_i - \\bar{k})^2 = (-0.25)^2 + (0.75)^2 + (1.75)^2 + (-0.25)^2 + (0.75)^2 + (-0.25)^2 + (-1.25)^2 + (-1.25)^2 $$\n$$ = 0.0625 + 0.5625 + 3.0625 + 0.0625 + 0.5625 + 0.0625 + 1.5625 + 1.5625 = 7.5 $$\n$c$的离差平方和：\n$$ \\sum_{i=1}^{8} (c_i - \\bar{c})^2 = (-0.2125)^2 + (0.3875)^2 + (0.7875)^2 + (-0.1125)^2 + (0.2875)^2 + (-0.0125)^2 + (-0.5125)^2 + (-0.6125)^2 $$\n$$ = 0.04515625 + 0.15015625 + 0.62015625 + 0.01265625 + 0.08265625 + 0.00015625 + 0.26265625 + 0.37515625 = 1.54875 $$\n将这些值代入相关性公式：\n$$r = \\frac{3.375}{\\sqrt{7.5} \\sqrt{1.54875}} = \\frac{3.375}{\\sqrt{11.615625}} \\approx \\frac{3.375}{3.4081703} \\approx 0.990267$$\n四舍五入到四位有效数字，相关系数为$r \\approx 0.9903$。\n\n最后，我们解释为什么在PPI网络中，较高的覆盖因子$c_i$倾向于夸大观测到的度$k_i$。\n在诸如亲和纯化质谱法（AP-MS）等技术中，一个特定的蛋白质（“诱饵”，$P_i$）被用来“钓”出其相互作用的伙伴（“猎物”），然后对这些伙伴进行鉴定。覆盖因子$c_i$与$P_i$在实验中被用作“诱饵”的次数成正比。\n任何给定的蛋白质-蛋白质相互作用的检测都是一个随机过程。在单次实验中，由于各种因素（例如，低亲和力结合、蛋白质表达量低、质谱技术的局限性），一个真实的相互作用可能不会被检测到。在单次实验中检测到某个特定真实相互作用的概率小于$1$，我们称之为$p_{detection}$。\n如果一个蛋白质$P_i$在$M_i$次独立实验中被用作“诱饵”（其中$M_i$与$c_i$成正比），那么在所有$M_i$次实验中都*未能*检测到某个特定真实伙伴的概率是$(1 - p_{detection})^{M_i}$。因此，至少成功检测到该伙伴一次的概率是$1 - (1 - p_{detection})^{M_i}$。这个检测概率是$M_i$的单调递增函数。\n因此，被更频繁地用作“诱饵”的蛋白质（即具有更高的$c_i$）其真实的相互作用伙伴被检测到的机会也更高。与研究频率较低的蛋白质相比，这系统性地夸大了它们的*观测*度$k_i$。一个$c_i$较低的蛋白质可能具有很高的真实度，但它的许多相互作用可能仍未被发现，从而导致观测到的度较低。\n在实验投入（由$\\mathbf{c}$表示）并非均匀分布于所有蛋白质，也并非蛋白质真实生物连通性的完美体现的条件下，度与覆盖度之间的这种相关性反映了*测量偏差*。例如，如果研究人员选择更深入地研究“热门”蛋白质（例如那些已知与某种疾病相关的蛋白质），那么向量$\\mathbf{c}$就会变得倾斜。由此产生的观测度与覆盖度之间的高度相关性，就是这种非均匀采样的产物。它将真实的生物信号（如果存在的话）与强烈的系统偏差混为一谈，使得仅从观测数据无法得出结论，即具有更高覆盖度的蛋白质在生物系统中确实是连接度更高的“枢纽”蛋白。偏差是由采样过程本身引起的观测相关性的一部分，与潜在的生物学无关。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 3  4  5  3  4  3  2  2  0.9903 \\end{pmatrix} } $$"
        },
        {
            "introduction": "PPI网络分析的一个主要目标是发现新的、尚未验证的相互作用。本练习概述了如何设计一个用于链接预测的监督式机器学习工作流程，这是网络科学在生物发现中的一个强大应用 。此练习为在网络数据上设置机器学习任务提供了黄金标准，其关键原则包括正确划分数据以避免信息泄露，利用拓扑特征，以及为不平衡数据集选择合适的评估指标。掌握这一流程将使您具备构建和验证用于生物发现的预测模型所需的方法学严谨性。",
            "id": "4298695",
            "problem": "考虑一个蛋白质-蛋白质相互作用网络（PPIN），它被表示为一个简单无向图 $G=(V,E)$，其中 $V$ 是蛋白质集合，$E$ 是经过实验验证的相互作用集合。你需要定义一个有监督的链接预测任务，对于给定的候选对 $(u,v)$ 且 $u,v\\in V$，判断 $(u,v)$ 是否是一个相互作用。每个候选对可用的特征包括共同邻居数 $CN(u,v)$、Jaccard 指数 $J(u,v)$，以及一个从多序列比对和系统发育校正中派生出的序列共进化得分 $C(u,v)$。学习算法输出一个实值分数 $s(u,v)$，该分数随相互作用概率的增加而单调递增。\n\n设计选择必须解决以下问题：如何构建正例和负例的训练集和测试集；如何在不引入测试集信息泄露的情况下计算网络派生的特征；以及考虑到相互作用相对于非相互作用而言是稀疏的，如何使用受试者工作特征（ROC）和精确率-召回率曲线下面积（AUPR）来评估训练好的模型。假设由于计算限制，只能使用非边的一个子集作为负例，但可以抽取一个大规模的、有代表性的子集。假设共进化得分 $C(u,v)$ 除了识别蛋白质序列外，不依赖于 $E$。\n\n哪个选项最正确地定义了有监督的链接预测任务和科学上合理的评估方案？\n\nA. 将 $E$ 随机划分为不相交的训练集 $E_{\\text{train}}$ 和测试集 $E_{\\text{test}}$，构建训练图 $G_{\\text{train}}=(V,E_{\\text{train}})$，通过从 $\\bar{E}_{\\text{train}}=\\{(u,v)\\in V\\times V:u\\neq v,(u,v)\\notin E_{\\text{train}}\\}$ 中抽样来构建训练负例，从 $\\bar{E}_{\\text{test}}=\\{(u,v)\\in V\\times V:u\\neq v,(u,v)\\notin E\\}$ 中抽样来构建测试负例，为了避免窥探 $E_{\\text{test}}$，仅在 $G_{\\text{train}}$ 上为训练集中的所有配对和测试集中的所有配对计算 $CN(u,v)$ 和 $J(u,v)$，使用 $C(u,v)$ 作为外部特征，在训练集上训练一个概率分类器，并通过在 $s(u,v)$ 上扫描一个阈值 $t$ 来在测试集上进行评估，以绘制真阳性率对假阳性率的 ROC 曲线和精确率对召回率的精确率-召回率曲线，报告 ROC 曲线下面积和精确率-召回率曲线下面积，其中测试集中的负例是作为一个大规模代表性样本抽取的。\n\nB. 使用全图 $G=(V,E)$ 计算所有配对的 $CN(u,v)$ 和 $J(u,v)$，从 $\\bar{E}=\\{(u,v)\\in V\\times V:u\\neq v,(u,v)\\notin E\\}$ 中一次性抽样负例，将所有标记好的配对随机划分为训练集和测试集，训练一个分类器，并在训练集上报告 ROC 和 AUPR，因为训练集更大更稳定；由于 $G$ 是固定的，在 $G$ 上计算特征避免了训练和测试之间的不一致性。\n\nC. 像选项 A 一样划分边，在 $G_{\\text{train}}$ 上计算 $CN(u,v)$，但将任意配对的 $J(u,v)$ 定义为共同邻居数与度数之和的比值，并使用一个与训练集中正例普遍程度相匹配的单一阈值进行评估；通过绘制召回率对假发现率的曲线来生成精确率-召回率曲线，并对其面积进行积分以获得 AUPR。\n\nD. 像选项 A 一样划分边并在 $G_{\\text{train}}$ 上计算所有特征，但在测试集上通过在预测分数的中间值固定一个单一阈值来评估，以计算一个 ROC 点并将 AUPR 近似为 ROC 曲线下面积，因为两者都总结了排序性能；将这些单一数值摘要作为评估结果报告。",
            "solution": "该问题要求为蛋白质-蛋白质相互作用网络（PPIN）中的有监督链接预测任务给出一个最正确的定义，包括训练/测试集的设置、特征计算和模型评估。一个严谨的答案必须遵循机器学习验证的原则，特别是要避免信息泄露，并选择适合不平衡数据的评估指标。\n\n设已知相互作用（边）的全集为 $E$。图为 $G=(V, E)$。任务是预测潜在的相互作用，这些相互作用目前是非边。\n\n**1. 训练集和测试集的构建：**\n链接预测的目标是发现新的、以前未知的链接。为了评估模型完成这一任务的能力，我们必须模拟这个发现过程。标准且正确的方法是在训练期间对模型隐瞒一部分已知链接，并用它们来测试其预测能力。\n\n- **正例**：已知链接集 $E$ 必须被划分为一个训练集 $E_{\\text{train}}$ 和一个测试集 $E_{\\text{test}}$，使得 $E = E_{\\text{train}} \\cup E_{\\text{test}}$ 且 $E_{\\text{train}} \\cap E_{\\text{test}} = \\emptyset$。$E_{\\text{train}}$ 中的配对作为训练的正例，$E_{\\text{test}}$ 中的配对作为测试的正例。\n\n- **负例**：非相互作用配对（非边）的数量通常比相互作用配对的数量大几个数量级。问题正确地指出抽样是必要的。\n    - **测试负例**：为了评估，负例必须是那些被确信不是链接的配对。在这种情况下，这意味着任何满足 $(u,v) \\notin E$ 的配对 $(u,v)$。从这个集合 $\\bar{E} = \\{(u,v) \\in V \\times V : u \\neq v, (u,v) \\notin E\\}$ 中抽取的样本构成了负测试集。\n    - **训练负例**：训练负例不能与训练正例重叠。它们应该从不在 $E_{\\text{train}}$ 中的配对集合中抽样。这个集合是 $\\bar{E}_{\\text{train}} = \\{(u,v) \\in V \\times V : u \\neq v, (u,v) \\notin E_{\\text{train}}\\}$。注意 $E_{\\text{test}} \\subset \\bar{E}_{\\text{train}}$。虽然从这个集合中抽样可能会无意中将一些正测试例包含在负训练集中，但这是一种常见的做法。由于 $|E_{\\text{test}}|$ 通常远小于 $|\\bar{E}_{\\text{train}}|$，这种污染是最小的。一种更纯粹的方法是从 $\\bar{E}$ 中抽样训练负例，这也是一个有效的策略。\n\n**2. 网络派生特征的计算：**\n这是一个信息泄露很容易发生的关键步骤。模型应该在“发现”测试边*之前*的网络状态上进行训练。\n\n- **训练图**：为了防止泄露，必须只使用训练边构建一个训练图 $G_{\\text{train}} = (V, E_{\\text{train}})$。\n- **特征计算**：所有网络派生的特征（如共同邻居数 $CN(u,v)$ 和 Jaccard 指数 $J(u,v)$）都必须在这个训练图 $G_{\\text{train}}$ 上计算。这适用于为*训练集*配对和*测试集*配对计算的特征。在全图 $G=(V,E)$ 上为测试集计算特征将意味着使用测试边本身来预测它们自己的存在，这是一种循环论证的形式，会使评估无效。\n- **外部特征**：题目说明共进化得分 $C(u,v)$ 与网络结构 $E$ 无关。因此，可以为所有配对预先计算它，而没有泄露的风险。\n\n**3. 模型评估：**\n问题指出相互作用是稀疏的，这意味着数据集是高度不平衡的（负例比正例多得多）。这对评估指标的选择有重要影响。\n\n- **ROC 曲线和 AUROC**：受试者工作特征（ROC）曲线绘制了真阳性率（$TPR$，或召回率）与假阳性率（$FPR$）的关系。ROC 曲线下面积（AUROC）总结了排序性能。然而，在高度不平衡的环境中，一个模型即使实际性能很差，也可能获得很高的 AUROC，因为即使有大量的假阳性， $FPR$ 也可能非常小。\n- **精确率-召回率（PR）曲线和 AUPR**：PR 曲线绘制了精确率（$Precision = \\frac{\\text{TP}}{\\text{TP}+\\text{FP}}$）与召回率（$Recall = \\frac{\\text{TP}}{\\text{TP}+\\text{FN}}$）的关系。精确率对假阳性（$FP$）的数量很敏感，并且不会因为大量的真阴性（$TN$）而被夸大。因此，PR 曲线下面积（AUPR）对于不平衡任务是一个信息量更大的度量标准。\n- **评估方案**：一个稳健的评估需要评估模型在所有可能的决策阈值上的排序性能。这可以通过在测试集上扫描模型输出分数 $s(u,v)$ 的阈值来生成完整的 ROC 和 PR 曲线来实现。报告 AUROC 和 AUPR 可以提供对性能的全面了解。在单个固定阈值下进行评估是不够的。\n\n基于这个严谨的框架，我们现在可以评估给定的选项。\n\n**选项 A：**\n\n- **数据划分与集合**：它正确地建议将 $E$ 划分为 $E_{\\text{train}}$ 和 $E_{\\text{test}}$。它定义了训练图 $G_{\\text{train}}=(V,E_{\\text{train}})$。它正确地将负测试例的来源确定为不在全集 $E$ 中的配对。其对负训练例来源的定义（不在 $E_{\\text{train}}$ 中的配对）是一种标准、可接受的做法。\n- **特征计算**：它正确且明确地指出，网络特征（$CN$、$J$）必须*仅*在 $G_{\\text{train}}$ 上为*所有*配对（包括训练和测试）计算，这正确地避免了信息泄露。\n- **评估**：它正确地指定了通过扫描阈值在测试集上进行评估，以生成完整的 ROC 和 PR 曲线，并报告相应的面积（AUROC 和 AUPR）。这是黄金标准，尤其适用于不平衡数据。\n\n**结论**：此选项提供了一个完整且科学上合理的方案，符合有监督链接预测的最佳实践。**正确**。\n\n**选项 B：**\n\n- **特征计算**：它建议使用全图 $G=(V,E)$ 来计算特征。这是一个致命的缺陷，因为它将来自测试集的严重信息泄露引入到特征生成过程中。\n- **评估**：它建议在训练集上进行评估。这在根本上是错误的；评估必须在未见的测试数据上进行，以评估泛化性能。在训练数据上评估只衡量过拟合。\n\n**结论**：此选项描述了一个方法论上无效的程序。**不正确**。\n\n**选项 C：**\n\n- **Jaccard 指数定义**：它错误地定义了 Jaccard 指数。分母应该是邻居集合的并集大小，即 $|\\Gamma(u) \\cup \\Gamma(v)| = \\deg(u) + \\deg(v) - \\text{CN}(u,v)$，而不是度数之和 $\\deg(u) + \\deg(v)$。这是一个事实错误。\n- **评估**：它建议在单个阈值下进行评估，与完整的曲线分析相比，这提供了不完整的性能评估。\n- **PR 曲线定义**：它错误地将 PR 曲线定义为绘制召回率对假发现率的曲线。标准的 PR 曲线绘制的是精确率对召回率。\n\n**结论**：此选项包含多个事实和方法论上的错误。**不正确**。\n\n**选项 D：**\n\n- **评估**：它建议在单个任意阈值（中位数分数）下进行评估，这是一种不充分的评估方法。\n- **AUPR 近似**：它错误地声称 AUPR 可以用 AUROC 来近似。这是两个不同的度量标准，衡量性能的不同方面。对于不平衡数据集，这种等价性尤其错误和误导，而这正是本问题的背景。\n\n**结论**：此选项显示了对模型评估指标的根本性误解。**不正确**。\n\n总之，选项 A 是唯一一个正确描述了有监督链接预测任务的严谨且有效实验设计的选项。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}