{
    "hands_on_practices": [
        {
            "introduction": "Urban scaling laws are powerful because they reveal simple regularities in complex systems. However, these laws do not arise from a vacuum; they are emergent consequences of more fundamental processes. This practice guides you through the process of analytical model-building by synthesizing principles from transportation engineering and urban economics to derive the scaling of total vehicle travel from the ground up . By connecting individual travel behavior, infrastructure constraints, and congestion dynamics, you will see how a new, system-level scaling relationship can be derived.",
            "id": "4312858",
            "problem": "Consider an idealized metropolitan region with population $N$ in which daily personal mobility arises from individual trip-making on a road network. Assume the following empirically grounded principles and definitions drawn from complex systems and network science and transportation engineering:\n- Each resident generates trips at a constant rate $\\lambda$ (trips per person per day), so the aggregate demand is $Q(N) = \\lambda N$.\n- The total lane length of the road network scales with population as $L(N) = L_{0} N^{\\delta}$, where $L_{0}  0$ and $0  \\delta  1$ are constants consistent with sublinear infrastructure scaling.\n- The network’s aggregate capacity is $C(N) = \\mu L(N)$, where $\\mu  0$ is the capacity per unit lane length (vehicles per unit time).\n- Average travel time per unit distance (that is, the reciprocal of average speed) obeys a Bureau of Public Roads (BPR) form under congestion, namely $\\tau(N) = \\frac{1}{v_{f}}\\left[1 + \\alpha \\left(\\frac{Q(N)}{C(N)}\\right)^{\\kappa}\\right]$, where $v_{f}  0$ is free-flow speed, $\\alpha  0$ and $\\kappa  0$ are congestion parameters calibrated from empirical observations, and the congested regime is characterized by $\\alpha \\left(\\frac{Q(N)}{C(N)}\\right)^{\\kappa} \\gg 1$.\n- Individuals allocate a constant daily time budget $T$ to travel (Marchetti’s constant), independent of $N$, so the average per-capita daily travel distance is $\\ell(N) = v(N) T$, where $v(N) = 1/\\tau(N)$.\n\nDefine the total daily vehicle-kilometers traveled (VKT) as $Y(N) = N \\ell(N)$. In the asymptotic congested regime described above, $Y(N)$ follows a power-law in $N$. Derive the scaling exponent $\\beta_{Y}$ such that $Y(N)$ scales as a power of $N$ with exponent $\\beta_{Y}$, and express $\\beta_{Y}$ as a closed-form analytic expression in terms of $\\delta$ and $\\kappa$ only. Do not substitute numerical values; provide the exact symbolic expression for the exponent. No rounding is required, and no units are needed for the exponent.",
            "solution": "The problem requires the derivation of the scaling exponent $\\beta_{Y}$ for the total daily vehicle-kilometers traveled, $Y(N)$, in a metropolitan region, under the assumption of a congested traffic regime. The relationship is given by $Y(N) \\propto N^{\\beta_{Y}}$. The exponent $\\beta_{Y}$ must be expressed in terms of the infrastructure scaling exponent $\\delta$ and the congestion parameter $\\kappa$.\n\nThe derivation proceeds by combining the given definitions and principles step-by-step.\n\nFirst, the total daily vehicle-kilometers traveled, $Y(N)$, is defined as the product of the population $N$ and the average per-capita daily travel distance $\\ell(N)$:\n$$Y(N) = N \\ell(N)$$\n\nThe average per-capita daily travel distance, $\\ell(N)$, is determined by the constant daily travel time budget, $T$, and the average travel speed, $v(N)$:\n$$\\ell(N) = v(N) T$$\nThe average travel speed $v(N)$ is the reciprocal of the average travel time per unit distance, $\\tau(N)$, so $v(N) = 1/\\tau(N)$. Substituting this into the expression for $\\ell(N)$ gives:\n$$\\ell(N) = \\frac{T}{\\tau(N)}$$\nSubstituting this back into the equation for $Y(N)$, we obtain:\n$$Y(N) = \\frac{N T}{\\tau(N)}$$\nSince $T$ is a constant independent of $N$, the scaling behavior of $Y(N)$ is determined by the scaling of $N / \\tau(N)$:\n$$Y(N) \\propto \\frac{N}{\\tau(N)}$$\n\nNext, we must determine the scaling of $\\tau(N)$ with respect to the population $N$. The average travel time per unit distance is given by the Bureau of Public Roads (BPR) function:\n$$\\tau(N) = \\frac{1}{v_{f}}\\left[1 + \\alpha \\left(\\frac{Q(N)}{C(N)}\\right)^{\\kappa}\\right]$$\nThe problem specifies that the system is in the congested regime, which is characterized by the condition $\\alpha \\left(\\frac{Q(N)}{C(N)}\\right)^{\\kappa} \\gg 1$. In this asymptotic limit, the constant term $1$ inside the brackets becomes negligible compared to the congestion term. Therefore, $\\tau(N)$ can be approximated as:\n$$\\tau(N) \\approx \\frac{1}{v_{f}} \\alpha \\left(\\frac{Q(N)}{C(N)}\\right)^{\\kappa}$$\nSince we are interested in the scaling exponent, we can use proportionality, where the constants $\\alpha$ and $v_{f}$ do not affect the exponent:\n$$\\tau(N) \\propto \\left(\\frac{Q(N)}{C(N)}\\right)^{\\kappa}$$\n\nNow, we express the volume-to-capacity ratio, $Q(N)/C(N)$, as a function of $N$. The aggregate demand $Q(N)$ is given by:\n$$Q(N) = \\lambda N$$\nThe aggregate capacity $C(N)$ is given by:\n$$C(N) = \\mu L(N)$$\nThe total lane length $L(N)$ scales with population as:\n$$L(N) = L_{0} N^{\\delta}$$\nSubstituting this into the expression for $C(N)$:\n$$C(N) = \\mu L_{0} N^{\\delta}$$\nThe volume-to-capacity ratio is therefore:\n$$\\frac{Q(N)}{C(N)} = \\frac{\\lambda N}{\\mu L_{0} N^{\\delta}} = \\left(\\frac{\\lambda}{\\mu L_{0}}\\right) N^{1-\\delta}$$\nThis shows that the volume-to-capacity ratio scales with $N$ as $N^{1-\\delta}$:\n$$\\frac{Q(N)}{C(N)} \\propto N^{1-\\delta}$$\n\nWe substitute this scaling relationship back into the expression for $\\tau(N)$:\n$$\\tau(N) \\propto \\left(N^{1-\\delta}\\right)^{\\kappa} = N^{\\kappa(1-\\delta)}$$\n\nFinally, we substitute the scaling for $\\tau(N)$ into the scaling relationship for $Y(N)$:\n$$Y(N) \\propto \\frac{N}{\\tau(N)} \\propto \\frac{N^{1}}{N^{\\kappa(1-\\delta)}}$$\nUsing the laws of exponents, we find the scaling for $Y(N)$:\n$$Y(N) \\propto N^{1 - \\kappa(1-\\delta)}$$\n\nThe problem defines the scaling exponent as $\\beta_{Y}$, where $Y(N) \\propto N^{\\beta_{Y}}$. By comparing this with our derived expression, we identify the exponent $\\beta_{Y}$ as:\n$$\\beta_{Y} = 1 - \\kappa(1-\\delta)$$\nThis expression for $\\beta_{Y}$ depends only on the parameters $\\delta$ and $\\kappa$, as required. It can also be written as $\\beta_{Y} = 1 - \\kappa + \\kappa\\delta$. This result provides the scaling exponent for total vehicle-kilometers traveled in the congested regime based on the provided a priori assumptions of urban scaling.",
            "answer": "$$\\boxed{1 - \\kappa(1-\\delta)}$$"
        },
        {
            "introduction": "While theoretical derivations provide a clean picture of scaling, empirical verification is fraught with methodological challenges, chief among them the very definition of a \"city\". This exercise delves into the Modifiable Areal Unit Problem (MAUP), a fundamental issue in spatial analysis, by exploring how the choice of a city's boundary impacts the measured scaling exponent . Through a stylized model, you will discover that the scaling exponent is not always an invariant quantity, but can depend systematically on how we delineate urban areas, a crucial lesson for interpreting empirical results.",
            "id": "4312864",
            "problem": "Consider a stylized, spatially continuous urban system used to interrogate boundary effects on urban scaling. Let the population density field be radially symmetric and given by $\\rho(r) = \\rho_0 \\exp(-r/R)$ for radius $r \\geq 0$, with central density $\\rho_0  0$ and scale length $R  0$. Define a morphological city by a density threshold $\\rho^\\star \\in (0,\\rho_0)$ as the contiguous domain $D(\\rho^\\star) = \\{\\mathbf{x} : \\rho(\\|\\mathbf{x}\\|) \\geq \\rho^\\star\\}$, which is a disk of radius $r_c(\\rho^\\star)$ implicitly defined by $\\rho(r_c) = \\rho^\\star$. Let the aggregate population of the city be $N(\\rho^\\star) = \\int_{D(\\rho^\\star)} \\rho(\\mathbf{x}) \\,\\mathrm{d}^2 \\mathbf{x}$.\n\nAssume an urban attribute is produced locally with density-dependent intensity $\\sigma(r) = \\sigma_0 [\\rho(r)]^p$, where $\\sigma_0  0$ and $p0$ are constants reflecting microscopic mechanisms (for example, $p = 1$ for additive contributions, $p = 2$ for pairwise interaction intensity). The aggregate attribute is $Y(\\rho^\\star) = \\int_{D(\\rho^\\star)} \\sigma(\\mathbf{x}) \\,\\mathrm{d}^2 \\mathbf{x}$. Define the local log-log slope of the aggregate attribute with respect to population as $\\beta(\\rho^\\star) = \\frac{\\mathrm{d} \\ln Y(\\rho^\\star)}{\\mathrm{d} \\ln N(\\rho^\\star)}$, which operationalizes the measured scaling exponent under a given boundary choice.\n\nYour task is to reason from first principles in complex systems and network science, using core definitions of aggregate quantities and integration over fields, together with widely accepted facts about spatial aggregation and the Modifiable Areal Unit Problem (MAUP), to assess how the measured scaling exponent depends on the city definition. In particular, analyze the limiting behavior as the threshold $\\rho^\\star$ approaches the core ($\\rho^\\star \\uparrow \\rho_0$) and the periphery ($\\rho^\\star \\downarrow 0$), and whether invariances can be guaranteed.\n\nWhich of the following statements are necessarily true under the model above?\n\n- A. For any $p  1$, the measured exponent $\\beta(\\rho^\\star)$ is strictly equal to $p$ for all $\\rho^\\star \\in (0,\\rho_0)$, and is invariant to the boundary choice.\n\n- B. For any $p  0$, $\\lim_{\\rho^\\star \\uparrow \\rho_0} \\beta(\\rho^\\star) = 1$, meaning that extremely tight morphological boundaries around the dense core yield an effectively linear aggregate relationship between $Y$ and $N$.\n\n- C. For $p = 2$, the measured exponent $\\beta(\\rho^\\star)$ under density-threshold morphological boundaries generally depends on $\\rho^\\star$ and is not identically equal to $2$.\n\n- D. Replacing morphological boundaries by functional definitions based on commuting-flow thresholds always increases the measured exponent $\\beta$ compared to the morphological case for all $p  1$.\n\n- E. If all cities in a dataset share the same $(\\rho_0, R)$ and differ only by the threshold $\\rho^\\star$, the aggregate $Y$-$N$ relation is an exact power law with exponent independent of $\\rho^\\star$ across the sample.\n\nSelect all that apply.",
            "solution": "The problem statement is critically validated before attempting a solution.\n\n### Step 1: Extract Givens\n- Population density field: $\\rho(r) = \\rho_0 \\exp(-r/R)$ for $r \\geq 0$.\n- Constants: $\\rho_0  0$, $R  0$.\n- Morphological city domain: $D(\\rho^\\star) = \\{\\mathbf{x} : \\rho(\\|\\mathbf{x}\\|) \\geq \\rho^\\star\\}$ for a density threshold $\\rho^\\star \\in (0,\\rho_0)$.\n- City radius $r_c(\\rho^\\star)$ is implicitly defined by $\\rho(r_c) = \\rho^\\star$.\n- Aggregate population: $N(\\rho^\\star) = \\int_{D(\\rho^\\star)} \\rho(\\mathbf{x}) \\,\\mathrm{d}^2 \\mathbf{x}$.\n- Urban attribute intensity: $\\sigma(r) = \\sigma_0 [\\rho(r)]^p$.\n- Constants: $\\sigma_0  0$, $p  0$.\n- Aggregate attribute: $Y(\\rho^\\star) = \\int_{D(\\rho^\\star)} \\sigma(\\mathbf{x}) \\,\\mathrm{d}^2 \\mathbf{x}$.\n- Measured scaling exponent: $\\beta(\\rho^\\star) = \\frac{\\mathrm{d} \\ln Y(\\rho^\\star)}{\\mathrm{d} \\ln N(\\rho^\\star)}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is a theoretical exercise in urban scaling, based on a stylized but mathematically well-defined model.\n- **Scientifically Grounded:** Yes. The model uses an exponentially decaying density profile, a standard model in urban studies and physics. The definitions of aggregate quantities via integration and the local scaling exponent are standard in the field of complex systems.\n- **Well-Posed:** Yes. All quantities are defined through integrals of continuous functions over compact sets (disks), ensuring the aggregates $N$ and $Y$ are well-defined. The derivatives required to calculate $\\beta$ are also well-defined. A unique, meaningful solution for $\\beta(\\rho^\\star)$ exists.\n- **Objective:** Yes. The problem is stated in precise, mathematical language, free from ambiguity or subjective claims.\n\nThe problem statement does not violate any of the invalidity criteria. It is a self-contained, consistent, and solvable theoretical problem.\n\n### Step 3: Verdict and Action\nThe problem statement is **valid**. Proceeding to solution.\n\n### Derivation of the Scaling Exponent $\\beta$\n\nThe measured scaling exponent is defined as $\\beta(\\rho^\\star) = \\frac{\\mathrm{d} \\ln Y(\\rho^\\star)}{\\mathrm{d} \\ln N(\\rho^\\star)}$. It is more convenient to parameterize all quantities by the city's cutoff radius $r_c$, which is a monotonically decreasing function of the threshold $\\rho^\\star$ given by $\\rho_0 \\exp(-r_c/R) = \\rho^\\star$, or $r_c(\\rho^\\star) = R \\ln(\\rho_0 / \\rho^\\star)$. As $\\rho^\\star \\uparrow \\rho_0$, the radius $r_c \\downarrow 0$. As $\\rho^\\star \\downarrow 0$, the radius $r_c \\uparrow \\infty$.\n\nUsing the chain rule, we can express $\\beta$ in terms of derivatives with respect to $r_c$:\n$$ \\beta(r_c) = \\frac{\\mathrm{d} \\ln Y}{\\mathrm{d} r_c} \\left/ \\frac{\\mathrm{d} \\ln N}{\\mathrm{d} r_c} \\right. = \\frac{(1/Y) (\\mathrm{d}Y/\\mathrm{d}r_c)}{(1/N) (\\mathrm{d}N/\\mathrm{d}r_c)} = \\frac{N(r_c)}{Y(r_c)} \\frac{\\mathrm{d}Y/\\mathrm{d}r_c}{\\mathrm{d}N/\\mathrm{d}r_c} $$\nThe aggregate quantities are computed by integrating over the disk of radius $r_c$. In polar coordinates, the area element is $r\\,\\mathrm{d}r\\,\\mathrm{d}\\theta$.\n$$ N(r_c) = \\int_0^{2\\pi} \\int_0^{r_c} \\rho(r) \\, r\\,\\mathrm{d}r\\,\\mathrm{d}\\theta = 2\\pi \\int_0^{r_c} r \\rho(r) \\,\\mathrm{d}r $$\n$$ Y(r_c) = \\int_0^{2\\pi} \\int_0^{r_c} \\sigma(r) \\, r\\,\\mathrm{d}r\\,\\mathrm{d}\\theta = 2\\pi \\int_0^{r_c} r \\sigma(r) \\,\\mathrm{d}r $$\nBy the Leibniz integral rule (Fundamental Theorem of Calculus), the derivatives with respect to the upper integration limit $r_c$ are:\n$$ \\frac{\\mathrm{d}N}{\\mathrm{d}r_c} = 2\\pi r_c \\rho(r_c) $$\n$$ \\frac{\\mathrm{d}Y}{\\mathrm{d}r_c} = 2\\pi r_c \\sigma(r_c) $$\nThese represent the total population and attribute production on the infinitesimal ring at the boundary $r_c$.\n\nSubstituting these derivatives into the expression for $\\beta(r_c)$:\n$$ \\beta(r_c) = \\frac{N(r_c)}{Y(r_c)} \\frac{2\\pi r_c \\sigma(r_c)}{2\\pi r_c \\rho(r_c)} = \\frac{N(r_c)}{Y(r_c)} \\frac{\\sigma(r_c)}{\\rho(r_c)} $$\nNow, we use the given form $\\sigma(r) = \\sigma_0 [\\rho(r)]^p$:\n$$ \\beta(r_c) = \\frac{N(r_c)}{Y(r_c)} \\frac{\\sigma_0 [\\rho(r_c)]^p}{\\rho(r_c)} = \\sigma_0 [\\rho(r_c)]^{p-1} \\frac{N(r_c)}{Y(r_c)} $$\nThis is a general expression for the local scaling exponent. It shows that $\\beta$ depends on the ratio of the total integrated quantities ($N$ and $Y$) and the value of the densities at the boundary $r_c$.\n\nTo see the dependence on $r_c$ (and thus $\\rho^\\star$), we can write out the integrals:\n$$ \\beta(r_c) = [\\rho(r_c)]^{p-1} \\frac{\\int_0^{r_c} r \\rho(r) \\,\\mathrm{d}r}{\\int_0^{r_c} r [\\rho(r)]^p \\,\\mathrm{d}r} $$\nIt is clear that unless $p=1$, the expression for $\\beta(r_c)$ is a non-trivial function of the boundary radius $r_c$, because the integrals depend on $r_c$. Only when $p=1$ does $\\rho(r)$ cancel from the numerator and denominator integrals, and with the prefactor $[\\rho(r_c)]^0 = 1$, $\\beta(r_c)$ becomes identically $1$. For any $p \\neq 1$, $\\beta$ depends on the boundary choice $\\rho^\\star$.\n\n### Analysis of Limiting Cases\n\n1.  **Core Limit ($\\rho^\\star \\uparrow \\rho_0$, so $r_c \\downarrow 0$):**\n    For an infinitesimally small city radius $r_c$, the density $\\rho(r)$ and attribute intensity $\\sigma(r)$ are approximately constant throughout the city's domain and equal to their central values, $\\rho(r) \\approx \\rho_0$ and $\\sigma(r) \\approx \\sigma_0 \\rho_0^p$.\n    The aggregate quantities are approximately the density multiplied by the area $\\pi r_c^2$:\n    $$ N(r_c) \\approx \\rho_0 (\\pi r_c^2) $$\n    $$ Y(r_c) \\approx \\sigma_0 \\rho_0^p (\\pi r_c^2) $$\n    The density at the boundary is $\\rho(r_c) \\approx \\rho_0$.\n    Substituting these approximations into the expression for $\\beta(r_c)$:\n    $$ \\lim_{r_c \\to 0} \\beta(r_c) = \\lim_{r_c \\to 0} \\left( \\sigma_0 [\\rho(r_c)]^{p-1} \\frac{N(r_c)}{Y(r_c)} \\right) = \\sigma_0 [\\rho_0]^{p-1} \\frac{\\rho_0 \\pi r_c^2}{\\sigma_0 \\rho_0^p \\pi r_c^2} = \\frac{\\sigma_0 \\rho_0^{p-1} \\rho_0}{\\sigma_0 \\rho_0^p} = \\frac{\\sigma_0 \\rho_0^p}{\\sigma_0 \\rho_0^p} = 1 $$\n    This limit holds for any $p  0$.\n\n2.  **Peripheral Limit ($\\rho^\\star \\downarrow 0$, so $r_c \\uparrow \\infty$):**\n    For this limit, we must evaluate the full integrals for $N(r_c \\to \\infty)$ and $Y(r_c \\to \\infty)$.\n    $N_{total} = 2\\pi \\rho_0 R^2$.\n    $Y_{total} = 2\\pi \\sigma_0 \\rho_0^p (R/p)^2$.\n    In this limit, $\\rho(r_c) \\to 0$. The exponent depends on how $\\beta(r_c)=\\sigma_0 [\\rho(r_c)]^{p-1} \\frac{N(r_c)}{Y(r_c)}$ behaves. Since $N(r_c)$ and $Y(r_c)$ both approach constants, the behavior is dominated by the $[\\rho(r_c)]^{p-1}$ term.\n    As $r_c \\to \\infty$, $\\rho(r_c) = \\rho_0 e^{-r_c/R} \\to 0$.\n    - If $p  1$, then $p-1  0$, so $[\\rho(r_c)]^{p-1} \\to 0$. Thus $\\lim_{r_c \\to \\infty} \\beta(r_c) = 0$.\n    - If $p = 1$, then $\\beta(r_c)=1$ for all $r_c$.\n    - If $0  p  1$, then $p-1  0$, so $[\\rho(r_c)]^{p-1} \\to \\infty$. Thus $\\lim_{r_c \\to \\infty} \\beta(r_c) = \\infty$.\n\n### Option-by-Option Analysis\n\n-   **A. For any $p  1$, the measured exponent $\\beta(\\rho^\\star)$ is strictly equal to $p$ for all $\\rho^\\star \\in (0,\\rho_0)$, and is invariant to the boundary choice.**\n    Our derivation shows that for any $p \\neq 1$, the exponent $\\beta(\\rho^\\star)$ is a non-constant function of $\\rho^\\star$ (via $r_c$). For instance, for $p1$, we found $\\lim_{\\rho^\\star \\uparrow \\rho_0} \\beta(\\rho^\\star) = 1$ and $\\lim_{\\rho^\\star \\downarrow 0} \\beta(\\rho^\\star) = 0$. Since $p1$, neither of these limits equals $p$. The exponent is not constant, nor is it equal to $p$.\n    **Verdict: Incorrect.**\n\n-   **B. For any $p  0$, $\\lim_{\\rho^\\star \\uparrow \\rho_0} \\beta(\\rho^\\star) = 1$, meaning that extremely tight morphological boundaries around the dense core yield an effectively linear aggregate relationship between $Y$ and $N$.**\n    Our analysis of the \"Core Limit\" shows that as $\\rho^\\star \\uparrow \\rho_0$ (which corresponds to $r_c \\downarrow 0$), the scaling exponent $\\beta(\\rho^\\star)$ approaches $1$. This is because for a very small city, both population and the attribute are simply proportional to the area, leading to a locally linear relationship. The statement is a direct consequence of our derivation.\n    **Verdict: Correct.**\n\n-   **C. For $p = 2$, the measured exponent $\\beta(\\rho^\\star)$ under density-threshold morphological boundaries generally depends on $\\rho^\\star$ and is not identically equal to $2$.**\n    The case $p=2$ is a specific instance of our general finding that for any $p \\neq 1$, $\\beta(\\rho^\\star)$ is a non-constant function of $\\rho^\\star$. For $p=2$, the exponent varies with the choice of boundary, taking values between the limits of $1$ (for $\\rho^\\star \\to \\rho_0$) and $0$ (for $\\rho^\\star \\to 0$). Therefore, it certainly depends on $\\rho^\\star$ and is not identically equal to $2$.\n    **Verdict: Correct.**\n\n-   **D. Replacing morphological boundaries by functional definitions based on commuting-flow thresholds always increases the measured exponent $\\beta$ compared to the morphological case for all $p  1$.**\n    The problem statement provides a complete model based on morphological boundaries defined by a density threshold. This option introduces an alternative, \"functional\" definition based on commuting flows, but provides no mathematical model for it. Any conclusion about such definitions would require assumptions or information external to the problem statement. The task is to reason based on the provided model. Since the model does not contain any information about functional boundaries, it is impossible to determine the effect of switching to them. Therefore, this statement cannot be proven as necessarily true based on the given information.\n    **Verdict: Incorrect.**\n\n-   **E. If all cities in a dataset share the same $(\\rho_0, R)$ and differ only by the threshold $\\rho^\\star$, the aggregate $Y$-$N$ relation is an exact power law with exponent independent of $\\rho^\\star$ across the sample.**\n    An exact power law relationship $Y = C N^\\beta$ across a sample of cities implies that the log-log plot of $(N, Y)$ is a straight line with a constant slope $\\beta$. The local slope of this log-log plot is precisely what $\\beta(\\rho^\\star)$ measures. Our analysis has shown that for any $p \\neq 1$, $\\beta(\\rho^\\star)$ is not constant but varies with $\\rho^\\star$. This means the curve traced by $(N(\\rho^\\star), Y(\\rho^\\star))$ as $\\rho^\\star$ varies is not a pure power law. A dataset of cities picked from this curve would not lie on a straight line in a log-log plot. Thus, the relation is not an exact power law.\n    **Verdict: Incorrect.**",
            "answer": "$$\\boxed{BC}$$"
        },
        {
            "introduction": "Ultimately, the validity of any urban scaling theory rests on its ability to describe and predict real-world data. This computational practice bridges the gap between theory and application by providing a complete workflow for model fitting, selection, and validation . You will learn to use statistical tools like the Akaike and Bayesian Information Criteria (AIC/BIC) and the Likelihood Ratio Test to compare competing models, and to assess a model's underlying assumptions using goodness-of-fit tests on its residuals.",
            "id": "4312862",
            "problem": "Consider a set of cities with population sizes denoted by $N_i$ and an urban quantity denoted by $Y_i$, where $i$ indexes cities. Urban scaling laws posit that, on average, the quantity $Y$ scales with population $N$ according to a power-law, while exhibiting multiplicative fluctuations around that mean. In order to perform principled model selection and goodness-of-fit assessment at an advanced-graduate level in complex systems and network science, you must formalize the following:\n\n1. Base assumptions grounded in definitions and well-tested observations:\n   - The canonical urban scaling hypothesis assumes a mean relationship $Y(N)$ that is a power law. In logarithmic form this is linear, and multiplicative log-normal fluctuations become additive Gaussian noise. Specifically, let $y_i = \\log Y_i$ and $x_i = \\log N_i$. Then the single-scaling (power-law) model posits $y_i = a + \\beta x_i + \\varepsilon_i$, where $\\varepsilon_i$ are independent and identically distributed Gaussian residuals with zero mean and variance $\\sigma^2$.\n   - To allow for curvature in scaling that may arise from network-structural or socio-economic transitions, consider an extended log-quadratic model $y_i = a + \\beta x_i + \\gamma x_i^2 + \\varepsilon_i$, with the same Gaussian residual assumption.\n   - Parameters in either model are to be estimated by Maximum Likelihood Estimation (MLE) under the Gaussian assumption.\n\n2. From first principles, select the most appropriate model and assess goodness-of-fit using:\n   - Akaike Information Criterion (AIC), defined for a model with $k$ free parameters and maximized log-likelihood $\\ell$.\n   - Bayesian Information Criterion (BIC), defined for a model with $k$ free parameters, sample size $n$, and maximized log-likelihood $\\ell$.\n   - The Likelihood Ratio Test (LRT) for nested models, comparing the single-scaling model to the log-quadratic model and reporting the $p$-value under the appropriate asymptotic distribution.\n   - A residual-based goodness-of-fit diagnostic: standardize residuals under the fitted model by the MLE of $\\sigma$, and apply the one-sample Kolmogorov-Smirnov (KS) test against the standard normal distribution to obtain a $p$-value. This tests the adequacy of the Gaussian residual assumption implied by multiplicative log-normal fluctuations.\n\n3. Implementation requirements:\n   - Perform MLE for both the single-scaling model and the log-quadratic model by solving the corresponding linear regression in $x_i = \\log N_i$ space with Gaussian residuals.\n   - Compute the maximized log-likelihood $\\ell$ for each model under the Gaussian assumption with the MLE residual variance and derive $k$ for AIC and BIC as follows: include all regression coefficients and the residual variance parameter $\\sigma^2$ in $k$. For the single-scaling model, $k=3$. For the log-quadratic model, $k=4$.\n   - Use the LRT between the single-scaling and log-quadratic models. The log-quadratic model nests the single-scaling model when $\\gamma = 0$. Report the LRT $p$-value using the asymptotic chi-square distribution for the difference in the number of regression coefficients, which is $1$ in this case.\n   - For goodness-of-fit, compute standardized residuals $z_i$ by dividing residuals by the MLE standard deviation and apply the Kolmogorov-Smirnov test against the standard normal distribution to obtain a $p$-value.\n\n4. Test suite and data generation:\n   - You must generate synthetic datasets deterministically without any random number generators, to ensure reproducibility. For each dataset, do the following:\n     - Let $n$ be the number of cities.\n     - Let $N_{\\min}$ and $N_{\\max}$ define the range of population sizes.\n     - Let $a$, $\\beta$, $\\gamma$ define the log-mean relationship $y_i = a + \\beta x_i + \\gamma x_i^2 + \\varepsilon_i$ with $x_i = \\log N_i$.\n     - Let $\\sigma$ define the scale of Gaussian residuals.\n     - Construct $x_i$ as $x_i$ linearly spaced between $\\log N_{\\min}$ and $\\log N_{\\max}$ for $i=1,\\dots,n$. Explicitly, $x_i$ are $n$ evenly spaced points on $[\\log N_{\\min}, \\log N_{\\max}]$.\n     - Construct the deterministic Gaussian residuals by choosing quantiles $q_i = \\frac{i - 0.5}{n}$ and setting $\\varepsilon_i = \\sigma \\Phi^{-1}(q_i)$, where $\\Phi^{-1}$ is the inverse cumulative distribution function of the standard normal distribution.\n     - Set $y_i = a + \\beta x_i + \\gamma x_i^2 + \\varepsilon_i$ and $Y_i = \\exp(y_i)$.\n   - Define four datasets (test cases), each specified by $(n, N_{\\min}, N_{\\max}, a, \\beta, \\gamma, \\sigma)$:\n     1. Case $1$: $n = 20$, $N_{\\min} = 10000$, $N_{\\max} = 10000000$, $a = 1.0$, $\\beta = 1.15$, $\\gamma = 0.0$, $\\sigma = 0.2$.\n     2. Case $2$: $n = 25$, $N_{\\min} = 5000$, $N_{\\max} = 20000000$, $a = 0.5$, $\\beta = 0.9$, $\\gamma = 0.06$, $\\sigma = 0.15$.\n     3. Case $3$: $n = 8$, $N_{\\min} = 20000$, $N_{\\max} = 2000000$, $a = 2.0$, $\\beta = 1.0$, $\\gamma = 0.0$, $\\sigma = 0.3$.\n     4. Case $4$: $n = 30$, $N_{\\min} = 8000$, $N_{\\max} = 30000000$, $a = 1.0$, $\\beta = 1.05$, $\\gamma = -0.02$, $\\sigma = 0.25$.\n\n5. Required outputs:\n   - For each dataset, compute and return four values in this order:\n     1. The AIC-based model selection indicator, with $1$ denoting the single-scaling (power-law) model and $2$ denoting the log-quadratic model.\n     2. The BIC-based selection indicator, with $1$ denoting the single-scaling model and $2$ denoting the log-quadratic model.\n     3. The LRT $p$-value comparing the single-scaling model against the log-quadratic model.\n     4. The KS $p$-value for the AIC-selected model’s standardized residuals against the standard normal distribution.\n   - The final output must aggregate the results for all four datasets into a single line. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4]$. Specifically, the output must contain $16$ entries corresponding to the four values for each of the $4$ test cases, ordered by test case. Integer indicators must be printed as integers, and each $p$-value must be printed as a decimal rounded to six places.",
            "solution": "The problem is valid. It is a well-posed, scientifically grounded problem in computational statistics, specifically focused on model selection and goodness-of-fit for urban scaling laws. The premises are consistent with established literature in complex systems, and the tasks are specified with mathematical precision, including the models, estimation methods, test statistics, and data generation procedures. All terms are clearly defined, and the problem is self-contained.\n\nThe solution proceeds by first generating the required synthetic datasets and then applying a sequence of statistical analyses to each dataset as specified.\n\n### 1. Data Generation\nFor each of the four test cases, a synthetic dataset is constructed deterministically. The parameters for each case are given by the tuple $(n, N_{\\min}, N_{\\max}, a, \\beta, \\gamma, \\sigma)$, where $n$ is the number of cities, $N_{\\min}$ and $N_{\\max}$ define the population range, and $a, \\beta, \\gamma, \\sigma$ are the parameters of the generative model.\n\nThe independent variable, log-population $x_i = \\log N_i$, is constructed by creating $n$ linearly spaced points on the interval $[\\log N_{\\min}, \\log N_{\\max}]$.\n$$ x_i = \\log N_{\\min} + (i-1) \\frac{\\log N_{\\max} - \\log N_{\\min}}{n-1} \\quad \\text{for } i = 1, \\dots, n $$\nThe residuals $\\varepsilon_i$ are generated deterministically to follow a Gaussian distribution with mean $0$ and standard deviation $\\sigma$. This is achieved by using the inverse of the standard normal cumulative distribution function, $\\Phi^{-1}(q)$, also known as the quantile function. We define quantiles $q_i = \\frac{i-0.5}{n}$ for $i=1, \\dots, n$, and set the residuals as:\n$$ \\varepsilon_i = \\sigma \\Phi^{-1}(q_i) $$\nFinally, the dependent variable, log-quantity $y_i = \\log Y_i$, is generated using the specified log-quadratic model form:\n$$ y_i = a + \\beta x_i + \\gamma x_i^2 + \\varepsilon_i $$\n\n### 2. Model Fitting and Log-Likelihood\nTwo models are fitted to each synthetic dataset $(x_i, y_i)$:\n- **Model 1 (Single-Scaling):** $y_i = a_1 + \\beta_1 x_i + \\varepsilon_i$\n- **Model 2 (Log-Quadratic):** $y_i = a_2 + \\beta_2 x_i + \\gamma_2 x_i^2 + \\varepsilon_i$\n\nUnder the assumption of i.i.d. Gaussian residuals, Maximum Likelihood Estimation (MLE) for the regression coefficients $(a, \\beta, \\gamma)$ is equivalent to Ordinary Least Squares (OLS). For each model, we solve the linear system to find the coefficients that minimize the sum of squared residuals.\n\nLet the number of data points be $n$. For a given model, let the predicted values be $\\hat{y}_i$. The residuals are $\\hat{\\varepsilon}_i = y_i - \\hat{y}_i$. The MLE for the variance of the residuals is:\n$$ \\hat{\\sigma}^2_{\\text{MLE}} = \\frac{1}{n} \\sum_{i=1}^n \\hat{\\varepsilon}_i^2 $$\nThe maximized log-likelihood, $\\ell_{\\max}$, for a model with $n$ data points and an MLE variance estimate of $\\hat{\\sigma}^2_{\\text{MLE}}$ is given by:\n$$ \\ell_{\\max} = - \\frac{n}{2} \\log(2\\pi) - \\frac{n}{2} \\log(\\hat{\\sigma}^2_{\\text{MLE}}) - \\frac{1}{2\\hat{\\sigma}^2_{\\text{MLE}}} \\sum_{i=1}^n \\hat{\\varepsilon}_i^2 = - \\frac{n}{2} \\left( \\log(2\\pi\\hat{\\sigma}^2_{\\text{MLE}}) + 1 \\right) $$\nThis calculation is performed for both Model 1 and Model 2, yielding $\\ell_{\\max,1}$ and $\\ell_{\\max,2}$, respectively.\n\n### 3. Model Selection\nWe use two information criteria, AIC and BIC, to select the better model. Both criteria penalize models for having more parameters. The model with the lower criterion value is preferred.\n\n- **Akaike Information Criterion (AIC):** $AIC = 2k - 2\\ell_{\\max}$\n- **Bayesian Information Criterion (BIC):** $BIC = k \\log(n) - 2\\ell_{\\max}$\n\nHere, $k$ is the total number of estimated parameters. As specified, $k$ includes the regression coefficients and the variance.\n- For Model 1, the parameters are $(a_1, \\beta_1, \\sigma_1^2)$, so $k_1 = 3$.\n- For Model 2, the parameters are $(a_2, \\beta_2, \\gamma_2, \\sigma_2^2)$, so $k_2 = 4$.\n\nAn indicator of $1$ is assigned if Model 1 is selected, and $2$ if Model 2 is selected. A tie is resolved in favor of the simpler model (Model 1).\n\n### 4. Likelihood Ratio Test (LRT)\nThe LRT is used to compare nested models. Model 1 is nested within Model 2, as Model 1 is a special case of Model 2 where $\\gamma=0$. The null hypothesis is $H_0: \\gamma=0$. The test statistic is:\n$$ \\lambda_{LR} = 2(\\ell_{\\max,2} - \\ell_{\\max,1}) $$\nUnder $H_0$, $\\lambda_{LR}$ asymptotically follows a chi-squared distribution, $\\chi^2(df)$, where the degrees of freedom $df$ is the difference in the number of free regression coefficients between the two models. Here, Model 2 has one additional coefficient ($\\gamma$), so $df=1$. The $p$-value is the probability of observing a test statistic as extreme or more extreme than the one calculated, assuming $H_0$ is true:\n$$ p_{\\text{LRT}} = P(\\chi^2_1 \\ge \\lambda_{LR}) $$\n\n### 5. Goodness-of-Fit: Kolmogorov-Smirnov (KS) Test\nThis test assesses whether the residuals from the fitted model are consistent with the assumed Gaussian distribution.\nFirst, the model selected by AIC is identified. Then, its residuals, $\\hat{\\varepsilon}_i$, are standardized using the MLE of the standard deviation, $\\hat{\\sigma}_{\\text{MLE}} = \\sqrt{\\hat{\\sigma}^2_{\\text{MLE}}}$:\n$$ z_i = \\frac{\\hat{\\varepsilon}_i}{\\hat{\\sigma}_{\\text{MLE}}} $$\nThe one-sample Kolmogorov-Smirnov test is then applied to these standardized residuals $\\{z_i\\}$. It compares the empirical cumulative distribution function (ECDF) of the standardized residuals to the cumulative distribution function (CDF) of the standard normal distribution, $\\Phi(z)$. The test yields a $p$-value, $p_{\\text{KS}}$. A high $p$-value (e.g., $0.05$) suggests that the data are not inconsistent with the null hypothesis that the residuals are drawn from a standard normal distribution, indicating a good fit.\n\nThe implementation of these steps for each test case will produce the four required outputs.",
            "answer": "```python\nimport numpy as np\nfrom scipy.stats import norm, chi2, kstest\n\ndef solve():\n    \"\"\"\n    Performs model selection and goodness-of-fit analysis for urban scaling laws\n    on four deterministically generated synthetic datasets.\n    \"\"\"\n\n    test_cases = [\n        # (n, N_min, N_max, a, beta, gamma, sigma)\n        (20, 10000, 10000000, 1.0, 1.15, 0.0, 0.2),\n        (25, 5000, 20000000, 0.5, 0.9, 0.06, 0.15),\n        (8, 20000, 2000000, 2.0, 1.0, 0.0, 0.3),\n        (30, 8000, 30000000, 1.0, 1.05, -0.02, 0.25),\n    ]\n\n    all_results = []\n    for params in test_cases:\n        n, N_min, N_max, a_true, beta_true, gamma_true, sigma_true = params\n\n        # === 1. Data Generation ===\n        x_min = np.log(N_min)\n        x_max = np.log(N_max)\n        x = np.linspace(x_min, x_max, n)\n        \n        quantiles = (np.arange(1, n + 1) - 0.5) / n\n        eps = sigma_true * norm.ppf(quantiles)\n        \n        y = a_true + beta_true * x + gamma_true * x**2 + eps\n\n        # === 2. Model Fitting and Log-Likelihood ===\n\n        # Model 1: Single-Scaling (linear) y = a + beta*x\n        X1 = np.c_[np.ones(n), x]\n        k1 = 3 # Parameters: a, beta, sigma^2\n        coeffs1, sum_sq_res1, _, _ = np.linalg.lstsq(X1, y, rcond=None)\n        sigma2_1_hat = sum_sq_res1[0] / n\n        log_L1 = -n / 2 * (np.log(2 * np.pi * sigma2_1_hat) + 1)\n\n        # Model 2: Log-Quadratic y = a + beta*x + gamma*x^2\n        X2 = np.c_[np.ones(n), x, x**2]\n        k2 = 4 # Parameters: a, beta, gamma, sigma^2\n        coeffs2, sum_sq_res2, _, _ = np.linalg.lstsq(X2, y, rcond=None)\n        sigma2_2_hat = sum_sq_res2[0] / n\n        log_L2 = -n / 2 * (np.log(2 * np.pi * sigma2_2_hat) + 1)\n\n        # === 3. Model Selection (AIC/BIC) ===\n        aic1 = 2 * k1 - 2 * log_L1\n        aic2 = 2 * k2 - 2 * log_L2\n        aic_indicator = 1 if aic1 = aic2 else 2\n\n        bic1 = k1 * np.log(n) - 2 * log_L1\n        bic2 = k2 * np.log(n) - 2 * log_L2\n        bic_indicator = 1 if bic1 = bic2 else 2\n\n        # === 4. Likelihood Ratio Test (LRT) ===\n        # H0: single-scaling (gamma=0), H1: log-quadratic\n        lrt_stat = 2 * (log_L2 - log_L1)\n        # The test statistic must be non-negative\n        lrt_stat = max(0, lrt_stat)\n        lrt_p_value = chi2.sf(lrt_stat, df=1) # df = k2_coeffs - k1_coeffs = 3 - 2 = 1\n\n        # === 5. Goodness-of-Fit (KS Test) ===\n        if aic_indicator == 1:\n            y_pred = X1 @ coeffs1\n            residuals = y - y_pred\n            sigma_mle = np.sqrt(sigma2_1_hat)\n        else: # aic_indicator == 2\n            y_pred = X2 @ coeffs2\n            residuals = y - y_pred\n            sigma_mle = np.sqrt(sigma2_2_hat)\n\n        standardized_residuals = residuals / sigma_mle\n        ks_stat, ks_p_value = kstest(standardized_residuals, 'norm')\n\n        # === Aggregate and format results for the current case ===\n        all_results.extend([\n            aic_indicator,\n            bic_indicator,\n            f\"{lrt_p_value:.6f}\",\n            f\"{ks_p_value:.6f}\"\n        ])\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```"
        }
    ]
}