{
    "hands_on_practices": [
        {
            "introduction": "基因“拨动开关”是合成生物学中的一个核心基序，它由两个相互抑制的基因构成，能够实现细胞记忆功能。分析其双稳态行为是理解基因调控网络非线性动力学的一个经典练习。该练习将引导你从基本原理出发，构建其数学模型，并推导出系统作为开关运行所需的关键参数阈值，这是对基因回路进行定量分析的一项基本技能。",
            "id": "4278295",
            "problem": "考虑一个均匀混合细胞中双基因相互抑制回路的最小确定性模型，其中蛋白质浓度在空间上是均匀的，且与翻译和降解相比，转录调控速度很快。基因 $X$ 产生浓度为 $x(t)$ 的蛋白质，基因 $Y$ 产生浓度为 $y(t)$ 的蛋白质。假设：\n\n- 每种蛋白质的产生都受到另一种蛋白质的抑制，这是通过抑制子与启动子的协同结合实现的，从而产生一个希尔型抑制因子。具体来说，启动子处于激活状态的时间分数由一个希尔函数给出，其希尔系数为 $n$，解离常数为 $K$。\n- 当启动子完全激活时，蛋白质合成以最大速率 $\\alpha$ 进行。\n- 蛋白质降解（以及因生长引起的稀释）遵循一级动力学，速率常数为 $\\gamma$。\n- 浓度 $x(t)$ 和 $y(t)$ 以纳摩尔（nanomolar）为单位，记作 $\\mathrm{nM}$；时间 $t$ 以小时为单位，记作 $\\mathrm{h}$。\n- 参数满足 $\\alpha$ 的单位为 $\\mathrm{nM}\\,\\mathrm{h}^{-1}$，$K$ 的单位为 $\\mathrm{nM}$，$\\gamma$ 的单位为 $\\mathrm{h}^{-1}$，而 $n$ 是无量纲的。\n\n从产生定义为最大速率乘以启动子激活分数，降解定义为一级损耗出发，完成以下任务：\n\n(1) 使用希尔动力学描述 $Y$ 对 $X$ 以及 $X$ 对 $Y$ 的转录抑制，为该相互抑制网络编写有量纲常微分方程（ODE）模型。定义所有变量和参数，并明确检查单位一致性。\n\n(2) 引入无量纲变量 $u=x/K$，$v=y/K$ 和无量纲时间 $\\tau=\\gamma t$，以及无量纲产生强度 $a=\\alpha/(\\gamma K)$。推导关于 $u(\\tau)$ 和 $v(\\tau)$ 的无量纲常微分方程。\n\n(3) 在对称条件 $u=v$ 下，推导 $u$ 作为 $a$ 和 $n$ 的函数的不动点条件。\n\n(4) 在对称不動点附近将无量纲系统线性化，并求出雅可比矩阵的特征值（用 $u$、$a$ 和 $n$ 表示）。\n\n(5) 利用对称不动点在最大特征值穿过零时失去稳定性的条件，消去 $u$ 以获得临界无量纲产生强度 $a_{c}$ 作为希尔系数 $n$ 的闭式函数（假设 $n>1$，以便协同抑制能够产生双稳态）。以 $a_c$ 的单一解析表达式作为最终答案，不带单位。无需进行数值计算。",
            "solution": "用户提供了一个来自系统生物学领域、表述清晰的问题，具体涉及基因触发开关的分析。该问题具有科学依据，无矛盾之处，并包含进行完整解析求解所需的所有信息。分步说明指导了对这个非线性动力系统的标准分析。\n\n**第 (1) 部分：有量纲常微分方程 (ODE) 模型**\n\n设 $x(t)$ 和 $y(t)$ 分别为蛋白质 X 和 Y 在时间 $t$ 的浓度。每种蛋白质浓度的动力学由其产生速率和降解速率之间的平衡决定。\n\n蛋白质 X 的产生受到蛋白质 Y 的抑制。最大产生速率为 $\\alpha$。该速率受到基因 X 启动子处于激活状态的时间分数的调节。这个分数由一个抑制性希尔函数给出，它描述了抑制子（蛋白质 Y）未与启动子结合的概率。该函数为 $\\frac{K^n}{K^n + y^n}$，其中 $K$ 是解离常数（在此 Y 浓度下抑制达到一半最大值），$n$ 是希尔系数，表示结合的协同性。\n因此，蛋白质 X 的产生项为 $\\alpha \\frac{K^n}{K^n + y^n}$。\n\n蛋白质 X 的降解假定遵循一级动力学，速率常数为 $\\gamma$。该项代表了主动降解和因细胞生长引起的稀释。\n因此，蛋白质 X 的降解项为 $\\gamma x$。\n\n结合产生和降解，蛋白质 X 浓度的变化率为：\n$$ \\frac{dx}{dt} = \\alpha \\frac{K^n}{K^n + y^n} - \\gamma x $$\n\n由于相互抑制回路的对称性，蛋白质 Y 的方程是类似的，只需交换 $x$ 和 $y$ 的角色：\n$$ \\frac{dy}{dt} = \\alpha \\frac{K^n}{K^n + x^n} - \\gamma y $$\n\n这两个耦合的常微分方程构成了有量纲模型。\n\n为检查单位一致性，我们使用给定的单位：$[x] = [y] = [K] = \\mathrm{nM}$，$[t] = \\mathrm{h}$，$[\\alpha] = \\mathrm{nM}\\,\\mathrm{h}^{-1}$，$[\\gamma] = \\mathrm{h}^{-1}$，且 $[n]$ 是无量纲的。\n\n对于第一个方程：\n- 方程左侧 $\\frac{dx}{dt}$ 的单位是 $\\frac{[\\mathrm{nM}]}{[\\mathrm{h}]}$。\n- 方程右侧第一项是 $\\alpha \\frac{K^n}{K^n + y^n}$。分数 $\\frac{K^n}{K^n + y^n}$ 是无量纲的，因为分子和分母的单位相同，均为 $(\\mathrm{nM})^n$。因此，该项的单位与 $\\alpha$ 的单位相同，即 $\\mathrm{nM}\\,\\mathrm{h}^{-1}$。\n- 方程右侧第二项是 $\\gamma x$。其单位为 $[\\gamma] \\times [x] = \\mathrm{h}^{-1} \\times \\mathrm{nM} = \\mathrm{nM}\\,\\mathrm{h}^{-1}$。\n方程中所有项的单位都一致，为 $\\mathrm{nM}\\,\\mathrm{h}^{-1}$。同样的逻辑也适用于第二个方程。该模型在量纲上是一致的。\n\n**第 (2) 部分：无量纲常微分方程**\n\n我们引入无量纲变量和参数：$u = x/K$，$v = y/K$，$\\tau = \\gamma t$ 和 $a = \\alpha/(\\gamma K)$。\n根据这些定义，我们可以将原始变量表示为 $x = K u$，$y = K v$ 和 $t = \\tau / \\gamma$。\n\n我们使用链式法则转换时间导数：\n$$ \\frac{dx}{dt} = \\frac{d(Ku)}{d\\tau} \\frac{d\\tau}{dt} = K \\frac{du}{d\\tau} (\\gamma) = \\gamma K \\frac{du}{d\\tau} $$\n\n现在，将这些表达式代入关于 $x$ 的有量纲常微分方程：\n$$ \\gamma K \\frac{du}{d\\tau} = \\alpha \\frac{K^n}{K^n + (Kv)^n} - \\gamma (Ku) $$\n\n两边同除以 $\\gamma K$：\n$$ \\frac{du}{d\\tau} = \\frac{\\alpha}{\\gamma K} \\frac{K^n}{K^n + K^n v^n} - u $$\n$$ \\frac{du}{d\\tau} = \\frac{\\alpha}{\\gamma K} \\frac{K^n}{K^n(1 + v^n)} - u $$\n$$ \\frac{du}{d\\tau} = \\frac{\\alpha}{\\gamma K} \\frac{1}{1 + v^n} - u $$\n\n使用无量纲产生强度的定义 $a = \\alpha/(\\gamma K)$，我们得到关于 $u$ 的无量纲方程：\n$$ \\frac{du}{d\\tau} = \\frac{a}{1 + v^n} - u $$\n\n根据对称性，关于 $v$ 的无量纲方程为：\n$$ \\frac{dv}{d\\tau} = \\frac{a}{1 + u^n} - v $$\n\n这些就是所求的无量纲常微分方程。\n\n**第 (3) 部分：对称不动点条件**\n\n系统的不动点是浓度不随时间变化的状态 $(u, v)$，即 $\\frac{du}{d\\tau} = 0$ 且 $\\frac{dv}{d\\tau} = 0$。\n条件为：\n$$ u = \\frac{a}{1 + v^n} $$\n$$ v = \\frac{a}{1 + u^n} $$\n问题要求在对称条件下的条件，即我们假设 $u=v$。设此对称不动点的值为 $u^*$。将 $v=u^*$ 代入第一个方程得到：\n$$ u^* = \\frac{a}{1 + (u^*)^n} $$\n这个隐式方程将对称不动点浓度 $u^*$ 与系统参数 $a$ 和 $n$ 联系起来。\n\n**第 (4) 部分：线性化和特征值**\n\n为了分析不动点的稳定性，我们在其周围对系统进行线性化。小扰动的动力学由在不动点处计算的雅可比矩阵决定。\n设系统写作 $\\frac{d\\vec{z}}{d\\tau} = \\vec{F}(\\vec{z})$，其中 $\\vec{z} = \\begin{pmatrix} u \\\\ v \\end{pmatrix}$ 且 $\\vec{F}(u, v) = \\begin{pmatrix} \\frac{a}{1+v^n} - u \\\\ \\frac{a}{1+u^n} - v \\end{pmatrix}$。\n雅可比矩阵 $J$ 为：\n$$ J = \\begin{pmatrix} \\frac{\\partial F_1}{\\partial u} & \\frac{\\partial F_1}{\\partial v} \\\\ \\frac{\\partial F_2}{\\partial u} & \\frac{\\partial F_2}{\\partial v} \\end{pmatrix} $$\n偏导数是：\n$$ \\frac{\\partial F_1}{\\partial u} = -1 $$\n$$ \\frac{\\partial F_1}{\\partial v} = \\frac{d}{dv} \\left( a(1+v^n)^{-1} \\right) = -a(1+v^n)^{-2}(nv^{n-1}) = -\\frac{anv^{n-1}}{(1+v^n)^2} $$\n$$ \\frac{\\partial F_2}{\\partial u} = -\\frac{anu^{n-1}}{(1+u^n)^2} $$\n$$ \\frac{\\partial F_2}{\\partial v} = -1 $$\n我们在对称不动点 $(u^*, u^*)$ 处计算雅可比矩阵，为简化起见，我们将其记为 $(u, u)$。\n$$ J(u,u) = \\begin{pmatrix} -1 & -\\frac{anu^{n-1}}{(1+u^n)^2} \\\\ -\\frac{anu^{n-1}}{(1+u^n)^2} & -1 \\end{pmatrix} $$\n特征值 $\\lambda$ 可通过特征方程 $\\det(J - \\lambda I) = 0$ 求得：\n$$ \\det \\begin{pmatrix} -1-\\lambda & -\\frac{anu^{n-1}}{(1+u^n)^2} \\\\ -\\frac{anu^{n-1}}{(1+u^n)^2} & -1-\\lambda \\end{pmatrix} = 0 $$\n设 $C = \\frac{anu^{n-1}}{(1+u^n)^2}$。方程变为：\n$$ (-1-\\lambda)^2 - \\left(-\\frac{anu^{n-1}}{(1+u^n)^2}\\right)^2 = 0 $$\n$$ (1+\\lambda)^2 - \\left(\\frac{anu^{n-1}}{(1+u^n)^2}\\right)^2 = 0 $$\n这是一个平方差公式，$A^2 - B^2 = (A-B)(A+B) = 0$。\n$$ \\left(1+\\lambda - \\frac{anu^{n-1}}{(1+u^n)^2}\\right) \\left(1+\\lambda + \\frac{anu^{n-1}}{(1+u^n)^2}\\right) = 0 $$\n这给出了两个特征值，$\\lambda_1$ 和 $\\lambda_2$：\n$$ \\lambda_1 = \\frac{anu^{n-1}}{(1+u^n)^2} - 1 $$\n$$ \\lambda_2 = -\\frac{anu^{n-1}}{(1+u^n)^2} - 1 $$\n\n**第 (5) 部分：临界无量纲产生强度 $a_c$**\n\n当最大特征值变为正数时，对称不动点变得不稳定。由于 $a, n, u$ 均为正量，项 $C = \\frac{anu^{n-1}}{(1+u^n)^2}$ 是正的。因此，$\\lambda_1 > \\lambda_2$。\n稳定性边界由最大特征值穿过零的条件定义，即 $\\lambda_1=0$。\n$$ \\frac{anu^{n-1}}{(1+u^n)^2} - 1 = 0 \\implies \\frac{anu^{n-1}}{(1+u^n)^2} = 1 $$\n这是临界稳定条件。为了找到发生这种情况的临界参数值 $a_c$，我们必须将这个方程与第 (3) 部分中的不动点条件联立求解。设 $u_c$ 是在此临界阈值处不动点的值。我们得到一个由两个方程组成的方程组：\n1. 不动点条件: $u_c = \\frac{a_c}{1+u_c^n} \\implies a_c = u_c(1+u_c^n)$\n2. 临界稳定条件: $\\frac{a_c n u_c^{n-1}}{(1+u_c^n)^2} = 1$\n\n将第一个方程中 $a_c$ 的表达式代入第二个方程：\n$$ \\frac{u_c(1+u_c^n) n u_c^{n-1}}{(1+u_c^n)^2} = 1 $$\n$$ \\frac{n u_c^n (1+u_c^n)}{(1+u_c^n)^2} = 1 $$\n$$ \\frac{n u_c^n}{1+u_c^n} = 1 $$\n现在，我们求解 $u_c^n$：\n$$ n u_c^n = 1+u_c^n $$\n$$ n u_c^n - u_c^n = 1 $$\n$$ (n-1)u_c^n = 1 $$\n$$ u_c^n = \\frac{1}{n-1} $$\n这给出了分岔点处对称不动点的值。我们可以求出 $u_c$ 本身为 $u_c = \\left(\\frac{1}{n-1}\\right)^{1/n}$。\n\n最后，我们将 $u_c^n$ 代回到 $a_c$ 的表达式中，求出临界产生强度 $a_c$：\n$$ a_c = u_c(1+u_c^n) = \\left(\\frac{1}{n-1}\\right)^{1/n} \\left(1 + \\frac{1}{n-1}\\right) $$\n简化乘积中的第二项：\n$$ 1 + \\frac{1}{n-1} = \\frac{n-1+1}{n-1} = \\frac{n}{n-1} $$\n因此，\n$$ a_c = \\left(\\frac{1}{n-1}\\right)^{1/n} \\left(\\frac{n}{n-1}\\right) $$\n合并以 $(n-1)$ 为底的项：\n$$ a_c = \\frac{n}{(n-1)^1 \\cdot (n-1)^{1/n}} = \\frac{n}{(n-1)^{1 + 1/n}} $$\n这可以简化为最终的闭式表达式：\n$$ a_c = \\frac{n}{(n-1)^{(n+1)/n}} $$\n这就是对称稳态失去稳定性并产生双稳态时的临界无量纲产生强度。条件 $n>1$ 是使该表达式有明确定义且具有物理意义所必需的，这与问题陈述一致。",
            "answer": "$$\n\\boxed{\\frac{n}{(n-1)^{(n+1)/n}}}\n$$"
        },
        {
            "introduction": "除了稳定的状态，许多生物过程依赖于节律性的振荡动态。由三基因负反馈环路构成的“抑制振荡器”（repressilator）是合成基因时钟的一个典型例子。本练习旨在深入探究振荡的产生机制，要求你找出系统稳态失稳并产生周期性行为（即霍普夫分岔，Hopf bifurcation）的条件。",
            "id": "4278340",
            "problem": "考虑一个被称为 repressilator 的规范三基因负反馈环路，它被建模为一个动态基因调控网络。每个基因产生信使核糖核酸 (mRNA) 和蛋白质，以循环顺序抑制下一个基因的转录。在对 mRNA 和蛋白质采用准稳态假设以及标准质量作用降解的条件下，蛋白质浓度的动力学由以下常微分方程 (ODE) 组表示：\n$$\n\\frac{dx_{1}}{dt} \\;=\\; -\\gamma x_{1} \\;+\\; \\nu\\, R(x_{3}), \\quad\n\\frac{dx_{2}}{dt} \\;=\\; -\\gamma x_{2} \\;+\\; \\nu\\, R(x_{1}), \\quad\n\\frac{dx_{3}}{dt} \\;=\\; -\\gamma x_{3} \\;+\\; \\nu\\, R(x_{2}),\n$$\n其中 $x_{i}$ 表示由基因 $i$ 产生的蛋白质浓度，$\\gamma > 0$ 是有效线性降解率，$\\nu > 0$ 是由启动子强度和翻译效率缩放的最大生产率，而 $R(x)$ 是一个光滑的单调递减抑制函数（例如，Hill 抑制函数 $R(x) = \\frac{1}{1 + (x/K)^{n}}$，其中 $K>0$ 且 $n>1$）。假设存在一个对称稳态 $x_{1}^{*} = x_{2}^{*} = x_{3}^{*} = x^{*} > 0$ 满足 $-\\gamma x^{*} + \\nu R(x^{*}) = 0$。\n\n基于基因调控可由光滑的输入-输出抑制函数建模，以及平衡点的线性稳定性由常微分方程组的雅可比矩阵的特征值决定这一基本前提，执行以下操作：\n\n- 在对称稳态 $x^{*}$ 处对系统进行线性化，得到以 $\\gamma$、$\\nu$ 和 $R'(x^{*})$ 表示的雅可比矩阵。\n- 推导雅可比矩阵的特征多项式，并对三次多项式应用 Routh–Hurwitz 判据，以确定一对共轭复特征值穿过虚轴（预示着 Hopf 分岔）的参数边界。\n\n您的任务是以闭合形式推导出现 Hopf 分岔时有效线性化耦合参数 $c := \\nu\\, R'(x^{*})$ 的临界值。请将最终答案表示为关于 $\\gamma$ 的单个解析表达式。不需要单位。不要将最终答案呈现为方程或不等式。",
            "solution": "该问题要求推导一个三基因 repressilator 模型发生 Hopf 分岔时，线性化耦合参数（记为 $c$）的临界值。分析过程将通过线性化给定的常微分方程 (ODE) 组，推导特征多项式，并应用 Routh-Hurwitz 稳定性判据来完成。\n\n动力学系统由以下常微分方程组描述：\n$$\n\\frac{dx_{1}}{dt} \\;=\\; -\\gamma x_{1} \\;+\\; \\nu\\, R(x_{3})\n$$\n$$\n\\frac{dx_{2}}{dt} \\;=\\; -\\gamma x_{2} \\;+\\; \\nu\\, R(x_{1})\n$$\n$$\n\\frac{dx_{3}}{dt} \\;=\\; -\\gamma x_{3} \\;+\\; \\nu\\, R(x_{2})\n$$\n设状态向量为 $\\vec{x} = (x_{1}, x_{2}, x_{3})^{T}$，向量场为 $\\vec{f}(\\vec{x})$。$\\vec{f}$ 的分量为 $f_{1}(\\vec{x}) = -\\gamma x_{1} + \\nu R(x_{3})$、$f_{2}(\\vec{x}) = -\\gamma x_{2} + \\nu R(x_{1})$ 和 $f_{3}(\\vec{x}) = -\\gamma x_{3} + \\nu R(x_{2})$。\n\n第一步是在对称稳态 $\\vec{x}^{*} = (x^{*}, x^{*}, x^{*})^{T}$ 处对系统进行线性化。该稳态的稳定性由雅可比矩阵 $J$ 的特征值决定，其元素定义为 $J_{ij} = \\left. \\frac{\\partial f_{i}}{\\partial x_{j}} \\right|_{\\vec{x}=\\vec{x}^{*}}$。\n\n我们计算必要的偏导数：\n$$\n\\begin{array}{lcl}\n\\frac{\\partial f_{1}}{\\partial x_{1}} = -\\gamma, & \\frac{\\partial f_{1}}{\\partial x_{2}} = 0, & \\frac{\\partial f_{1}}{\\partial x_{3}} = \\nu R'(x_{3}) \\\\\n\\frac{\\partial f_{2}}{\\partial x_{1}} = \\nu R'(x_{1}), & \\frac{\\partial f_{2}}{\\partial x_{2}} = -\\gamma, & \\frac{\\partial f_{2}}{\\partial x_{3}} = 0 \\\\\n\\frac{\\partial f_{3}}{\\partial x_{1}} = 0, & \\frac{\\partial f_{3}}{\\partial x_{2}} = \\nu R'(x_{2}), & \\frac{\\partial f_{3}}{\\partial x_{3}} = -\\gamma\n\\end{array}\n$$\n在对称稳态 $\\vec{x}^{*}$ 处计算这些导数，并使用所提供的有效线性化耦合参数定义 $c := \\nu R'(x^{*})$，我们构建雅可比矩阵：\n$$\nJ =\n\\begin{pmatrix}\n-\\gamma & 0 & c \\\\\nc & -\\gamma & 0 \\\\\n0 & c & -\\gamma\n\\end{pmatrix}\n$$\n由于抑制函数 $R(x)$ 是单调递减的，其导数 $R'(x^{*})$ 为负。又因为 $\\nu > 0$，参数 $c$ 必须为负，即 $c < 0$。\n\n下一步是求雅可比矩阵的特征多项式 $P(\\lambda) = \\det(J - \\lambda I)$，其中 $I$ 是 $3 \\times 3$ 单位矩阵，$\\lambda$ 代表特征值。\n$$\nP(\\lambda) = \\det \\begin{pmatrix}\n-\\gamma - \\lambda & 0 & c \\\\\nc & -\\gamma - \\lambda & 0 \\\\\n0 & c & -\\gamma - \\lambda\n\\end{pmatrix} = 0\n$$\n行列式可以沿第一行进行代数余子式展开计算：\n$$\nP(\\lambda) = (-\\gamma - \\lambda) \\begin{vmatrix} -\\gamma - \\lambda & 0 \\\\ c & -\\gamma - \\lambda \\end{vmatrix} - 0 + c \\begin{vmatrix} c & -\\gamma - \\lambda \\\\ 0 & c \\end{vmatrix}\n$$\n$$\nP(\\lambda) = (-\\gamma - \\lambda)(-\\gamma - \\lambda)^{2} + c(c^{2}) = -(\\lambda + \\gamma)^{3} + c^{3}\n$$\n为了应用 Routh-Hurwitz 判据，我们将此表达式展开为标准多项式形式 $a_{3}\\lambda^{3} + a_{2}\\lambda^{2} + a_{1}\\lambda + a_{0} = 0$。\n$$\n-(\\lambda^{3} + 3\\gamma\\lambda^{2} + 3\\gamma^{2}\\lambda + \\gamma^{3}) + c^{3} = 0\n$$\n两边乘以 $-1$ 以使首项系数为正 ($a_{3}=1$)：\n$$\n\\lambda^{3} + (3\\gamma)\\lambda^{2} + (3\\gamma^{2})\\lambda + (\\gamma^{3} - c^{3}) = 0\n$$\n从该方程中，我们确定系数：\n$a_{3} = 1$\n$a_{2} = 3\\gamma$\n$a_{1} = 3\\gamma^{2}$\n$a_{0} = \\gamma^{3} - c^{3}$\n\n对于三次多项式，Routh-Hurwitz 稳定性判据要求所有系数都为正，并且满足条件 $a_{2}a_{1} - a_{3}a_{0} > 0$。\n已知 $\\gamma > 0$：\n- $a_{3} = 1 > 0$ 满足。\n- $a_{2} = 3\\gamma > 0$ 满足。\n- $a_{1} = 3\\gamma^{2} > 0$ 满足。\n因此，稳定性的剩余条件是 $a_{0} = \\gamma^{3} - c^{3} > 0$ 和 $a_{2}a_{1} > a_{3}a_{0}$。\n\n当一对共轭复特征值穿过虚轴，系统从稳定过渡到不稳定时，就会发生 Hopf 分岔。这个临界转变点对应于稳定区域的边界，恰好在不等式 $a_{2}a_{1} - a_{3}a_{0} > 0$ 变为等式的地方。在这一点上，存在一对纯虚特征值 $\\lambda = \\pm i\\omega$。因此，Hopf 分岔的条件是：\n$$\na_{2}a_{1} - a_{3}a_{0} = 0\n$$\n将推导出的系数代入此方程：\n$$\n(3\\gamma)(3\\gamma^{2}) - (1)(\\gamma^{3} - c^{3}) = 0\n$$\n$$\n9\\gamma^{3} - \\gamma^{3} + c^{3} = 0\n$$\n$$\n8\\gamma^{3} + c^{3} = 0\n$$\n我们现在求解 $c$ 的临界值：\n$$\nc^{3} = -8\\gamma^{3}\n$$\n对两边取实立方根，得到临界参数值的解析表达式：\n$$\nc = \\sqrt[3]{-8\\gamma^{3}} = -2\\gamma\n$$\n这就是 $c$ 的值，在该值处一对共轭复特征值的实部变为零，标志着可能出现持续振荡的 Hopf 分岔的开始。",
            "answer": "$$\n\\boxed{-2\\gamma}\n$$"
        },
        {
            "introduction": "确定性模型为基因调控提供了强大但理想化的视角。在细胞内部，少量分子会引入显著的随机涨落，即“噪声”。本计算练习要求你使用吉莱斯皮算法（Gillespie algorithm）来模拟一个随机的基因拨动开关，从而探索噪声如何诱导系统在不同稳态之间自发切换，并学习设计诊断方法来区分这种随机现象与确定性的分岔穿越。",
            "id": "4278269",
            "problem": "考虑一个典型的双基因触发开关，该开关被建模为一个在化学主方程（CME）框架下的连续时间、离散状态的马尔可夫跳跃过程。两种蛋白质，分别表示为 $X_A$ 和 $X_B$，相互抑制对方的产生。令 $x_A$ 和 $x_B$ 分别为 $X_A$ 和 $X_B$ 的分子数。反应包括：$X_A$ 的产生、$X_B$ 的产生、$X_A$ 的降解，以及 $X_B$ 的降解。CME 意味着在短时间间隔内发生某个反应的概率由其反应倾向乘以该时间间隔长度给出，而 Gillespie 随机模拟算法（SSA）通过以当前总反应倾向为速率抽取指数分布的等待时间，并根据归一化的反应倾向分布选择下一个反应，从而生成此马尔可夫过程的精确样本路径。\n\n假设生产过程采用希尔型抑制，对于基因 $A$，其时间依赖的反应倾向为 $a_1(t) = k_A(t)\\,f(b)$；对于基因 $B$，其反应倾向为 $a_2(t) = k_B(t)\\,f(a)$，其中 $f(\\cdot)$ 是希尔抑制函数 $f(u) = \\dfrac{1}{1 + \\left(\\dfrac{u}{K}\\right)^n}$，$K$ 是半饱和常数，$n$ 是希尔系数。降解遵循一级动力学，其反应倾向为 $a_3(t) = \\gamma_A x_A$ 和 $a_4(t) = \\gamma_B x_B$，其中 $\\gamma_A$ 和 $\\gamma_B$ 是降解速率。该模型编码了相互抑制，并在合适的参数值下产生双稳态区域。\n\n在状态空间中，通过分子数差值的阈值 $H$ 来操作性地定义两个吸引盆：当 $x_A - x_B \\geq H$ 时为吸引盆 $A$，当 $x_B - x_A \\geq H$ 时为吸引盆 $B$。$|x_A - x_B| < H$ 的状态被视为未定状态，在未定状态中花费的时间不应计入驻留时间。在吸引盆 $A$（或吸引盆 $B$）中的驻留时间，是指从轨迹进入吸引盆 $A$（或吸引盆 $B$）那一刻起，直到它离开该吸引盆进入未定状态集或相反吸引盆的连续时间段，单位为分钟。\n\n在固定参数的双稳态区域内，由噪声引起的切换预计会产生近似指数分布的驻留时间，这是因为从亚稳态盆中逃逸的速率是恒定的，反映了 CME 下泊松出口的无记忆特性。相比之下，在缓慢时变的控制参数（例如，线性或周期性斜坡变化的 $k_A(t)$）驱动下确定性地穿越鞍结分岔会引起非平稳的逃逸动力学，其中风险率随时间变化。这会产生偏离指数分布的驻留时间，并随着参数的移动，在连续的驻留事件中表现出趋势。\n\n您的任务是为上述触发开关实现 Gillespie 随机模拟算法（SSA），并满足以下条件：\n- 在噪声诱导的情况下，反应倾向不随时间变化。\n- 在确定性穿越的情况下，$k_A(t)$ 缓慢时变（线性斜坡或周期性三角波），其选择应使绝热近似在科学上是合理的（参数变化速度相比于反应时间要慢）。\n\n然后，您必须设计一个定量诊断方法，通过分析驻留时间序列来区分噪声诱导的切换和确定性穿越。该诊断方法必须：\n- 计算合并后（结合两个吸引盆）驻留时间的变异系数 $CV = \\dfrac{\\sigma}{\\mu}$，其中 $\\mu$ 是样本均值，$\\sigma$ 是样本标准差。\n- 通过对驻留时间作为事件索引的函数进行最小二乘线性拟合来量化非平稳性，并使用由均值归一化的斜率 $s$，即 $s_{\\mathrm{norm}} = \\dfrac{s}{\\mu}$，来检测系统性趋势。\n- 针对每个测试用例返回一个整数分类代码，如下所示：\n    - $1$ 表示噪声诱导的切换（驻留时间近似为指数分布且无系统性趋势），\n    - $0$ 表示确定性穿越（非指数驻留时间且有显著趋势），\n    - $-1$ 表示数据不足（驻留事件数量少于评估分布所需的最小数量，将此最小数量指定为 $m_{\\min} = 5$）。\n\n所有驻留时间必须以分钟为单位进行计算和解释。本问题不使用角度。百分比必须表示为小数或分数，此处不要求。\n\n严格实现一个双物种系统的 SSA，其反应倾向如下：\n- $X_A$ 的产生：$a_1(t) = k_A(t) \\left(1 + \\left(\\dfrac{x_B}{K}\\right)^n\\right)^{-1}$，\n- $X_B$ 的产生：$a_2(t) = k_B(t) \\left(1 + \\left(\\dfrac{x_A}{K}\\right)^n\\right)^{-1}$，\n- $X_A$ 的降解：$a_3(t) = \\gamma_A x_A$，\n- $X_B$ 的降解：$a_4(t) = \\gamma_B x_B$。\n\n在确定性穿越的情况下，使用以下任一形式：\n- 线性斜坡：$k_A(t) = k_{A0} + \\nu t$，其中斜坡速率 $\\nu > 0$ 很小，\n- 三角波：$k_A(t) = k_{A0} + A \\,\\theta(t)$，其中 $\\theta(t)$ 是一个周期为 $P$、取值在 $[-1,1]$ 范围内的单位振幅三角波。\n\n您的程序必须使用 SSA 模拟每个测试用例的触发开关，计算所定义的吸引盆归属的驻留时间序列（以分钟为单位），应用诊断方法，并返回分类代码。最终输出必须是单行文本，包含用方括号括起来的逗号分隔的分类代码列表（例如，$[1,0,-1]$）。\n\n测试套件：\n提供五组参数集，用于探究不同方面，包括噪声主导的情况、确定性穿越和边界情况。对于所有情况，使用相同的希尔函数参数 $n = 2$ 和指定的 $K$，时间单位为分钟。将未定状态阈值设置为指定的 $H$ 分子数。每个情况以参数元组 $(k_{A0}, k_{B0}, \\gamma_A, \\gamma_B, K, n, H, x_A(0), x_B(0), T, \\text{漂移类型}, \\text{漂移参数})$ 的形式给出，其中 $T$ 是总模拟时间（分钟）。\n\n- 情况 1（噪声诱导，对称，双稳态）：$(12, 12, 0.30, 0.30, 15, 2, 3, 18, 18, 3000, \\text{\"none\"}, \\{\\})$。预期分类：$1$。\n- 情况 2（通过线性斜坡进行确定性穿越，缓慢单调变化）：$(8, 10, 0.25, 0.25, 20, 2, 4, 10, 22, 3000, \\text{\"linear\"}, \\{\\nu = 0.003\\})$。预期分类：$0$ 或 $-1$，取决于驻留次数；诊断必须根据数据决定，如果观察到的驻留次数少于 5 次，则允许为 $-1$。\n- 情况 3（通过三角波进行确定性重复穿越）：$(9, 9, 0.20, 0.20, 18, 2, 4, 12, 12, 3000, \\text{\"triangular\"}, \\{A = 4, P = 300\\})$。预期分类：$0$。\n- 情况 4（弱抑制尺度和罕见切换的边界情况）：$(6, 6, 0.15, 0.15, 60, 2, 5, 10, 10, 2000, \\text{\"none\"}, \\{\\})$。预期分类：如果驻留次数不足，则为 $-1$。\n- 情况 5（非对称噪声诱导切换，有偏置但驻留时间近似指数分布）：$(11, 9, 0.30, 0.30, 18, 2, 3, 15, 12, 3000, \\text{\"none\"}, \\{\\})$。预期分类：$1$。\n\n诊断阈值：\n- 使用 $m_{\\min} = 5$ 作为所需的最小驻留事件数，\n- 使用变异系数容差 $|CV - 1| \\leq 0.3$ 来接受类指数行为，\n- 使用归一化斜率容差 $|s_{\\mathrm{norm}}| \\leq 0.1$ 来接受平稳性（无趋势）。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$[c_1,c_2,c_3,c_4,c_5]$），其中每个 $c_i$ 是情况 $i$ 的分类代码。",
            "solution": "该问题在形式上是有效的。它在科学上基于已建立的随机化学动力学（化学主方程）和非线性动力学理论。所提出的模型，一个具有希尔型抑制的双基因触发开关，是计算生物学中的一个典型系统。所有参数、初始条件和分析标准都得到了明确的规定，使得该问题是适定且客观的。它要求实现一个标准但非平凡的数值方法——Gillespie 随机模拟算法（SSA）——以及后续的数据分析流程，以区分两种基本的系统行为模式：噪声诱导的切换和确定性的分岔穿越。该问题没有科学缺陷、矛盾和模糊之处。\n\n解决方案的结构如下：首先，我们实现 Gillespie SSA 来生成双蛋白系统的精确随机轨迹。其次，我们处理这些轨迹以提取在已定义的吸引盆中的驻留时间序列。最后，我们对该序列应用指定的定量诊断方法，为每个测试用例的切换动力学进行分类。\n\n**1. 随机模拟算法 (SSA)**\n\n系统的演化由四个反应定义的马尔可夫跳跃过程控制。设状态向量为 $(x_A, x_B)$，表示蛋白质 $X_A$ 和 $X_B$ 的分子数。反应及其倾向函数 $a_i$ 如下：\n\n1.  $X_A$ 的产生：$\\emptyset \\xrightarrow{a_1} X_A$。状态变化为 $(+1, 0)$。倾向函数由 $a_1(t) = k_A(t) f(x_B)$ 给出，其中 $f(u) = \\frac{1}{1 + (u/K)^n}$ 是希尔抑制函数。\n2.  $X_B$ 的产生：$\\emptyset \\xrightarrow{a_2} X_B$。状态变化为 $(0, +1)$。倾向函数是 $a_2(t) = k_B(t) f(x_A)$。\n3.  $X_A$ 的降解：$X_A \\xrightarrow{a_3} \\emptyset$。状态变化为 $(-1, 0)$。倾向函数是 $a_3(t) = \\gamma_A x_A$。\n4.  $X_B$ 的降解：$X_B \\xrightarrow{a_4} \\emptyset$。状态变化为 $(0, -1)$。倾向函数是 $a_4(t) = \\gamma_B x_B$。\n\n模拟的核心是 Gillespie 直接法。在任何时间 $t$，状态为 $(x_A, x_B)$ 时，算法按以下两个步骤进行：\n1.  确定到下一次反应的等待时间 $\\tau$。这是从一个指数分布中抽取的，其速率等于所有倾向函数之和 $a_{\\text{tot}}(t) = \\sum_{i=1}^4 a_i(t)$。因此，$\\tau = -\\frac{\\ln(r_1)}{a_{\\text{tot}}(t)}$，其中 $r_1$ 是来自均匀分布 $U(0,1)$ 的一个随机数。\n2.  确定发生哪个反应。这是根据其对总倾向函数的贡献成比例地选择的。使用第二个随机数 $r_2 \\sim U(0,1)$ 来选择反应 $j$，使得 $\\sum_{i=1}^{j-1} a_i(t) < r_2 \\, a_{\\text{tot}}(t) \\leq \\sum_{i=1}^{j} a_i(t)$。\n\n然后更新状态和时间：$t \\to t+\\tau$ 和 $(x_A, x_B) \\to (x_A, x_B) + \\nu_j$，其中 $\\nu_j$ 是反应 $j$ 的状态改变向量。\n\n此问题的一个关键特征是随时间变化的产生速率 $k_A(t)$。标准的 SSA 假设倾向函数是恒定的。然而，问题规定参数变化是缓慢的（绝热近似）。这允许我们使用一种简化的方法，即在当前时间 $t$ 计算倾向函数，并假设它们在下一个短时间步长 $\\tau$ 内保持不变。函数 $k_A(t)$ 的计算方式如下：\n- **无漂移 (\"none\")**：$k_A(t) = k_{A0}$ (恒定)。\n- **线性斜坡 (\"linear\")**：$k_A(t) = k_{A0} + \\nu t$。\n- **三角波 (\"triangular\")**：$k_A(t) = k_{A0} + A \\cdot \\theta(t)$，其中 $\\theta(t) = \\frac{4}{P} |(t \\pmod P) - \\frac{P}{2}| - 1$ 是一个周期为 $P$、在 $-1$ 和 $1$ 之间振荡的三角波。\n\n每个测试用例的模拟从 $t=0$ 运行到最终时间 $T$，记录状态 $(x_A, x_B)$ 的历史以及进入这些状态的时间 $t$。\n\n**2. 驻留时间计算**\n\n我们从模拟历史中提取驻留时间。状态空间根据阈值 $H$ 被划分为三个区域：\n- **吸引盆 A**：$x_A - x_B \\geq H$ 的状态。\n- **吸引盆 B**：$x_B - x_A \\geq H$ 的状态。\n- **未定状态**：$|x_A - x_B| < H$ 的状态。\n\n计算驻留时间的算法会遍历事件历史。在时间 $t_i$ 的事件使系统跃迁到一个新状态 $(x_{A,i}, x_{B,i})$，系统会保持该状态直到时间 $t_{i+1}$ 的下一个事件。我们跟踪当前的吸引盆和进入时间。当发生一个跃迁，使系统从一个已定义的吸引盆（A 或 B）移动到一个不同的区域（另一个吸引盆或未定区域）时，就记录一个驻留时间。驻留的持续时间是离开事件的时间减去进入事件的时间。这个过程生成一个用于分析的驻留时间序列。\n\n**3. 定量诊断与分类**\n\n分析驻留时间序列以对切换机制进行分类。\n首先，要求至少有 $m_{\\min} = 5$ 个驻留事件。如果观察到的事件少于此数，则数据不足，该情况被分类为 $-1$。\n\n如果数据充足，则计算两个指标：\n1.  **变异系数 ($CV$)**：对于一个驻留时间序列，$CV$ 是样本标准差 $\\sigma$ 与样本均值 $\\mu$ 的比值，即 $CV = \\sigma/\\mu$。对于无记忆过程，例如从亚稳态的泊松逃逸，驻留时间服从指数分布，其理论上的 $CV$ 恰好为 $1$。诊断测试条件为 $|CV - 1| \\leq 0.3$。这个容差考虑了统计涨落以及合并来自可能不对称的吸引盆的驻留时间。\n2.  **归一化趋势斜率 ($s_{\\text{norm}}$)**：为了检测非平稳性，我们使用最小二乘法将驻留时间对它们的序列事件索引作图，并拟合一条直线。该直线的斜率 $s$ 量化了驻留时长的平均趋势。该斜率通过平均驻留时间进行归一化，$s_{\\text{norm}} = s/\\mu$，使其无量纲且可在不同时间尺度上进行比较。诊断测试条件为 $|s_{\\text{norm}}| \\leq 0.1$。一个较小的值表示没有系统性趋势，这与平稳的、噪声诱导的切换相一致。\n\n最终的分类由这些指标确定：\n- **类别 1 (噪声诱导)**：动力学是平稳的，并表现出类指数统计特性。这需要同时满足两个条件：$|CV - 1| \\leq 0.3$ 和 $|s_{\\text{norm}}| \\leq 0.1$。\n- **类别 0 (确定性穿越)**：动力学未能通过上述一个或两个测试，表明其具有非指数统计特性或显著的时间趋势，这是系统被驱动穿越分岔的特征。\n\n该实现对所提供的五个测试用例中的每一个都应用了这个完整的流程——模拟、驻留时间提取和统计分类。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the final results.\n    \"\"\"\n    # Test cases defined as per the problem statement.\n    # Format: (k_A0, k_B0, gamma_A, gamma_B, K, n, H, xA(0), xB(0), T, drift_type, drift_params)\n    test_cases = [\n        (12.0, 12.0, 0.30, 0.30, 15.0, 2.0, 3, 18, 18, 3000.0, \"none\", {}),\n        (8.0, 10.0, 0.25, 0.25, 20.0, 2.0, 4, 10, 22, 3000.0, \"linear\", {'nu': 0.003}),\n        (9.0, 9.0, 0.20, 0.20, 18.0, 2.0, 4, 12, 12, 3000.0, \"triangular\", {'A': 4.0, 'P': 300.0}),\n        (6.0, 6.0, 0.15, 0.15, 60.0, 2.0, 5, 10, 10, 2000.0, \"none\", {}),\n        (11.0, 9.0, 0.30, 0.30, 18.0, 2.0, 3, 15, 12, 3000.0, \"none\", {})\n    ]\n\n    results = []\n    for case in test_cases:\n        classification = process_case(case)\n        results.append(classification)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef process_case(params):\n    \"\"\"\n    Processes a single test case: runs simulation, computes dwells, and classifies.\n    \"\"\"\n    k_A0, k_B0, gamma_A, gamma_B, K, n, H, xA_0, xB_0, T, drift_type, drift_params = params\n\n    history = run_ssa(k_A0, k_B0, gamma_A, gamma_B, K, n, xA_0, xB_0, T, drift_type, drift_params)\n    \n    dwell_times = compute_dwell_times(history, H)\n    \n    # Diagnostic thresholds from the problem\n    m_min = 5\n    cv_tolerance = 0.3\n    s_norm_tolerance = 0.1\n    \n    return classify(dwell_times, m_min, cv_tolerance, s_norm_tolerance)\n\ndef run_ssa(k_A0, k_B0, gamma_A, gamma_B, K, n, xA_0, xB_0, T, drift_type, drift_params):\n    \"\"\"\n    Implements Gillespie's Stochastic Simulation Algorithm (SSA).\n    \"\"\"\n    t = 0.0\n    xa, xb = xA_0, xB_0\n    \n    history = [(t, xa, xb)]\n    \n    stoich = np.array([[1, 0], [0, 1], [-1, 0], [0, -1]])\n    \n    while t  T:\n        # Calculate time-dependent k_A(t)\n        if drift_type == \"linear\":\n            nu = drift_params['nu']\n            k_A_t = k_A0 + nu * t\n        elif drift_type == \"triangular\":\n            A = drift_params['A']\n            P = drift_params['P']\n            theta_t = (4.0 / P) * abs((t % P) - P / 2.0) - 1.0\n            k_A_t = k_A0 + A * theta_t\n        else: # \"none\"\n            k_A_t = k_A0\n            \n        k_B_t = k_B0 # k_B is time-independent in this problem\n\n        # Propensity functions\n        a1 = k_A_t / (1.0 + (xb / K)**n)\n        a2 = k_B_t / (1.0 + (xa / K)**n)\n        a3 = gamma_A * xa\n        a4 = gamma_B * xb\n        \n        propensities = np.array([a1, a2, a3, a4])\n        a_tot = np.sum(propensities)\n        \n        if a_tot = 0:\n            break\n            \n        # Draw time step and next reaction\n        r1, r2 = np.random.rand(2)\n        tau = -np.log(r1) / a_tot\n        \n        # Check if next event is beyond simulation time\n        if t + tau > T:\n            t = T\n            break\n        \n        # Select reaction\n        reaction_idx = np.searchsorted(np.cumsum(propensities), r2 * a_tot)\n        \n        # Update state and time\n        t += tau\n        xa += stoich[reaction_idx, 0]\n        xb += stoich[reaction_idx, 1]\n        \n        history.append((t, xa, xb))\n        \n    return history\n\ndef get_basin(xa, xb, H):\n    \"\"\"Determines the basin of attraction for a given state.\"\"\"\n    if xa - xb >= H:\n        return 'A'\n    if xb - xa >= H:\n        return 'B'\n    return 'undecided'\n\ndef compute_dwell_times(history, H):\n    \"\"\"Computes dwell times from the simulation history.\"\"\"\n    dwell_times = []\n    \n    if not history:\n        return []\n\n    t_initial, xa_initial, xb_initial = history[0]\n    last_basin = get_basin(xa_initial, xb_initial, H)\n    entry_time = t_initial if last_basin != 'undecided' else -1\n\n    for i in range(1, len(history)):\n        t_curr, xa_curr, xb_curr = history[i]\n        \n        current_basin = get_basin(xa_curr, xb_curr, H)\n        \n        if current_basin != last_basin:\n            if last_basin != 'undecided':\n                # An event at t_curr caused an exit from last_basin\n                # The system was in last_basin up to t_curr\n                dwell = t_curr - entry_time\n                if dwell > 0: # Exclude zero-duration dwells\n                    dwell_times.append(dwell)\n            \n            if current_basin != 'undecided':\n                entry_time = t_curr\n            else:\n                entry_time = -1 \n\n            last_basin = current_basin\n            \n    return dwell_times\n\ndef classify(dwell_times, m_min, cv_tol, s_norm_tol):\n    \"\"\"Classifies the switching dynamics based on dwell time statistics.\"\"\"\n    if len(dwell_times)  m_min:\n        return -1\n        \n    dwells_arr = np.array(dwell_times)\n    mu = np.mean(dwells_arr)\n    \n    # Handle cases with no meaningful dwell times\n    if mu  1e-9:\n        return 0\n\n    sigma = np.std(dwells_arr, ddof=1) # Sample standard deviation\n    \n    CV = sigma / mu\n    \n    # Linear regression to find trend slope\n    event_indices = np.arange(len(dwells_arr))\n    # np.polyfit returns [slope, intercept] for deg=1\n    slope, _ = np.polyfit(event_indices, dwells_arr, 1)\n    \n    s_norm = slope / mu\n    \n    is_noise_induced = (abs(CV - 1.0) = cv_tol) and (abs(s_norm) = s_norm_tol)\n    \n    return 1 if is_noise_induced else 0\n\nif __name__ == '__main__':\n    solve()\n\n```"
        }
    ]
}