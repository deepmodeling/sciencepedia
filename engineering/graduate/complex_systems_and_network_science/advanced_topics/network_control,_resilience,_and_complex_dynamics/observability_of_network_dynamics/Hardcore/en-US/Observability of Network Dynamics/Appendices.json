{
    "hands_on_practices": [
        {
            "introduction": "Before analyzing the dynamics of a specific system, we can ask a more fundamental question: does the network's wiring diagram even permit full state observation, regardless of the precise interaction strengths? This exercise introduces the powerful concept of structural observability, which uses graph theory to determine the minimum number of sensors required to monitor a network. By constructing a bipartite graph and finding its maximum matching, you will develop a practical skill for solving a crucial sensor placement problem .",
            "id": "4293873",
            "problem": "Consider a linear time-invariant (LTI) networked dynamical system with state vector $x \\in \\mathbb{R}^{6}$ and dynamics $\\dot{x} = A x$, where the structure of the system matrix $A$ is constrained by a directed acyclic graph (DAG) on the vertex set $\\{1,2,3,4,5,6\\}$. The graph has directed edges $1 \\to 2$, $1 \\to 3$, $2 \\to 4$, $3 \\to 4$, $4 \\to 5$, and $4 \\to 6$. A dedicated sensor is defined as an output that directly measures a single state component, i.e., $y = C x$ where each nonzero row of $C$ selects one coordinate of $x$. \n\nStarting from fundamental definitions of structural observability and the graph-theoretic construction of the system bipartite graph associated with the transpose matrix $A^{\\top}$, explain why unmatched vertices in a maximum matching determine the number of required dedicated sensors to render the system structurally observable. Then, construct the bipartite graph induced by the given DAG and use maximum matching to compute the minimal number of dedicated sensors needed to ensure structural observability of the system. Provide your final answer as a single integer.",
            "solution": "The problem requires an explanation of the relationship between structural observability and bipartite graph matching, followed by a computation of the minimal number of dedicated sensors for a given networked system.\n\nFirst, we address the theoretical foundation. A linear time-invariant (LTI) system described by $\\dot{x} = Ax + Bu$ and $y=Cx$ is defined by the pair of matrices $(A, C)$ for observability analysis. The system is observable if and only if the observability matrix $\\mathcal{O}$ has full column rank, where $n$ is the dimension of the state space. The observability matrix is given by:\n$$\n\\mathcal{O} = \\begin{pmatrix} C \\\\ CA \\\\ CA^2 \\\\ \\vdots \\\\ CA^{n-1} \\end{pmatrix}\n$$\nAn equivalent condition for observability is the Popov-Belevitch-Hautus (PBH) test, which states that the system is observable if and only if the matrix\n$$\n\\begin{pmatrix} A - \\lambda I \\\\ C \\end{pmatrix}\n$$\nhas rank $n$ for all complex numbers $\\lambda \\in \\mathbb{C}$.\n\nFor a *structured* system, the entries of the matrices $A$ and $C$ are either fixed zeros or independent free parameters. Structural observability requires that the system is observable for almost all numerical values of these free parameters. This is equivalent to the condition that the *generic rank* of the structured matrix $\\begin{pmatrix} A \\\\ C \\end{pmatrix}$ is equal to $n$.\n\nThe generic rank of a structured matrix is determined by the size of the maximum matching in its associated bipartite graph. Let the system have $n$ states and $p$ outputs. The structured matrix $M = \\begin{pmatrix} A \\\\ C \\end{pmatrix}$ has dimensions $(n+p) \\times n$. We can construct a bipartite graph $G_M = (V_{in}, V_{out}, E)$ where the input vertex set $V_{in} = \\{x_1, \\dots, x_n\\}$ corresponds to the columns of $M$, and the output vertex set $V_{out} = \\{\\dot{x}_1, \\dots, \\dot{x}_n, y_1, \\dots, y_p\\}$ corresponds to the rows of $M$. An edge exists from a vertex $x_j \\in V_{in}$ to a vertex $v_i \\in V_{out}$ if the corresponding entry $M_{ij}$ is non-zero. The generic rank of $M$ is equal to the size of the maximum matching in $G_M$, denoted $\\mu(G_M)$. Therefore, the system $(A, C)$ is structurally observable if and only if $\\mu(G_M) = n$. This means that in a maximum matching, every input vertex $x_j$ must be matched to some output vertex.\n\nThe problem asks to start from the system without sensors, which is described by the matrix $A$. We can construct a bipartite graph $G_A = (V_x, V_{\\dot{x}}, E_A)$ for the dynamics matrix $A$, where $V_x = \\{x_1, \\dots, x_n\\}$ and $V_{\\dot{x}} = \\{\\dot{x}_1, \\dots, \\dot{x}_n\\}$. An edge $(x_j, \\dot{x}_i)$ exists if $A_{ij}$ is a free parameter (non-zero). Let the size of a maximum matching in this graph be $\\mu(G_A)$. By definition, $\\mu(G_A) \\le n$. If $\\mu(G_A)  n$, the system is not structurally observable without sensors. The number of vertices in $V_x$ that are left unmatched by a maximum matching is $n - \\mu(G_A)$.\n\nTo achieve structural observability, we must add sensors. A dedicated sensor on state $x_k$ corresponds to an output $y_k = x_k$. This introduces a new row in the output matrix $C$ with a single non-zero entry at column $k$. In the bipartite graph framework, this adds a new output vertex $y_k$ and a single new edge $(x_k, y_k)$.\n\nThe core task is to add the minimum number of such sensor-edges to increase the matching size to $n$. Let $M$ be a maximum matching of size $\\mu(G_A)$ in the graph $G_A$. There is a set $U \\subset V_x$ of $n - \\mu(G_A)$ vertices that are unmatched by $M$. If we place a dedicated sensor on a state $x_k$ where $x_k \\in U$, we introduce a new output vertex $y_k$ and a new edge $(x_k, y_k)$. Since $x_k$ was unmatched and $y_k$ is a new vertex that is not part of any edge in $M$, the edge $(x_k, y_k)$ can be added to the matching, forming a new matching $M' = M \\cup \\{(x_k, y_k)\\}$ of size $\\mu(G_A) + 1$. By placing one dedicated sensor on each of the $n - \\mu(G_A)$ unmatched input vertices, we can augment the matching size to $\\mu(G_A) + (n-\\mu(G_A)) = n$. Since each sensor can increase the matching size by at most one, this is the minimal number of sensors required.\nThus, the minimal number of dedicated sensors is $N_{sensors} = n - \\mu(G_A)$. Note that the problem mentions the transpose matrix $A^{\\top}$. The bipartite graph of $A^{\\top}$ is isomorphic to the graph of $A$, so the size of the maximum matching is identical.\n\nNow we apply this methodology to the given problem.\nThe system has $n=6$ states. The dynamics are constrained by a directed acyclic graph (DAG) with edges $1 \\to 2$, $1 \\to 3$, $2 \\to 4$, $3 \\to 4$, $4 \\to 5$, and $4 \\to 6$. An edge $j \\to i$ in the DAG implies that the entry $A_{ij}$ of the system matrix $A$ is non-zero. The term DAG implies no directed cycles, which includes self-loops, so the diagonal entries $A_{ii}$ are all zero. The structured matrix $A$ is:\n$$\nA = \\begin{pmatrix}\n0  0  0  0  0  0 \\\\\n*  0  0  0  0  0 \\\\\n*  0  0  0  0  0 \\\\\n0  *  *  0  0  0 \\\\\n0  0  0  *  0  0 \\\\\n0  0  0  *  0  0\n\\end{pmatrix}\n$$\nwhere $*$ represents a non-zero entry.\n\nWe construct the associated bipartite graph $G_A = (V_x, V_{\\dot{x}}, E_A)$, where $V_x=\\{x_1, \\dots, x_6\\}$ and $V_{\\dot{x}}=\\{\\dot{x}_1, \\dots, \\dot{x}_6\\}$. The edges $(x_j, \\dot{x}_i)$ correspond to the non-zero entries $A_{ij}$:\n$E_A = \\{(x_1, \\dot{x}_2), (x_1, \\dot{x}_3), (x_2, \\dot{x}_4), (x_3, \\dot{x}_4), (x_4, \\dot{x}_5), (x_4, \\dot{x}_6)\\}$.\n\nOur goal is to find the size of the maximum matching, $\\mu(G_A)$. We examine the graph:\nThe input vertices $x_5$ and $x_6$ have no outgoing edges, so they cannot be part of any matching. This immediately implies that they will be among the unmatched vertices in $V_x$.\nThe input vertices $x_2$ and $x_3$ both have only one possible edge target: the output vertex $\\dot{x}_4$. In any matching, a vertex can be used at most once. Therefore, only one of the edges $(x_2, \\dot{x}_4)$ or $(x_3, \\dot{x}_4)$ can be in a matching. This means that at least one of the input vertices $\\{x_2, x_3\\}$ must be left unmatched.\n\nBased on this analysis, we have at least three unmatched vertices in $V_x$: two from $\\{x_5, x_6\\}$, and at least one from $\\{x_2, x_3\\}$.\nThe total number of unmatched vertices is at least $3$. This implies the maximum matching size is at most $n - 3 = 6 - 3 = 3$.\n\nLet's construct a matching of size $3$ to confirm this is the maximum size.\nConsider the set of edges $M = \\{(x_1, \\dot{x}_2), (x_2, \\dot{x}_4), (x_4, \\dot{x}_5)\\}$.\nThe vertices involved are $\\{x_1, x_2, x_4\\}$ from $V_x$ and $\\{\\dot{x}_2, \\dot{x}_4, \\dot{x}_5\\}$ from $V_{\\dot{x}}$. No vertex is used more than once, so this is a valid matching. Its size is $3$.\nAnother possible maximum matching is $M' = \\{(x_1, \\dot{x}_3), (x_3, \\dot{x}_4), (x_4, \\dot{x}_6)\\}$, also of size $3$.\nSince we have found a matching of size $3$, and we have argued that no matching of size $4$ or greater can exist, the size of the maximum matching is $\\mu(G_A) = 3$.\n\nThe minimal number of dedicated sensors required to achieve structural observability is given by:\n$$\nN_{sensors} = n - \\mu(G_A)\n$$\nSubstituting the values $n=6$ and $\\mu(G_A)=3$:\n$$\nN_{sensors} = 6 - 3 = 3\n$$\nTherefore, $3$ dedicated sensors are needed. For instance, placing sensors on states $x_3$, $x_5$, and $x_6$ would allow for a matching of size $6$: $\\{(x_1, \\dot{x}_2), (x_2, \\dot{x}_4), (x_4, \\dot{x}_5), (x_3, y_3), (x_5, y_5), (x_6, y_6)\\}$.",
            "answer": "$$\\boxed{3}$$"
        },
        {
            "introduction": "Moving from abstract structure to a concrete linear process, this practice explores how network topology affects observability in diffusion dynamics. You will analyze a system on a disconnected graph, where the system matrix naturally becomes block-diagonal. This exercise provides a hands-on application of the Kalman observability rank condition, demonstrating precisely how states in an unmeasured network component become an unobservable subspace .",
            "id": "4293879",
            "problem": "Consider a linear diffusion process on an undirected, unweighted network with two disconnected components. Let the state vector be $x(t) \\in \\mathbb{R}^{5}$ and the dynamics be governed by the linear time-invariant (LTI) system $\\dot{x}(t) = A x(t)$ with $A = -L$, where $L$ is the graph Laplacian. The first component is a $2$-node path graph with Laplacian\n$$\nL_{1} = \\begin{pmatrix}\n1  -1 \\\\\n-1  1\n\\end{pmatrix},\n$$\nand the second component is a $3$-node complete graph (triangle) with Laplacian\n$$\nL_{2} = \\begin{pmatrix}\n2  -1  -1 \\\\\n-1  2  -1 \\\\\n-1  -1  2\n\\end{pmatrix}.\n$$\nThe overall Laplacian is block diagonal,\n$$\nL = \\begin{pmatrix}\nL_{1}  0 \\\\\n0  L_{2}\n\\end{pmatrix},\n$$\nso that $A = -L$ is also block diagonal with blocks $A_{1} = -L_{1}$ and $A_{2} = -L_{2}$. Suppose the output is a single sensor measuring only the state of the first node in the $2$-node component, i.e.,\n$$\ny(t) = C x(t), \\quad C = \\begin{pmatrix}1  0  0  0  0\\end{pmatrix}.\n$$\nStarting from the definitions of diffusion on graphs and observability in linear systems, and without invoking any pre-specified shortcut formulas, determine the dimension of the unobservable subspace of the pair $(A, C)$. Explain how the block-diagonal structure of the Laplacian determines this dimension by isolating the influence of each component on the measured output. Provide your final answer as a single integer. No rounding is required.",
            "solution": "The unobservable subspace of a linear time-invariant system pair $(A, C)$ is the set of initial states $x(0)$ that produce a zero output $y(t) = 0$ for all $t \\geq 0$. An equivalent characterization is that the unobservable subspace is the null space of the observability matrix $\\mathcal{O}$. The dimension of this subspace is what we seek.\n\nThe state space has dimension $n=5$. The observability matrix $\\mathcal{O}$ for the pair $(A, C)$ is constructed as:\n$$\n\\mathcal{O} = \\begin{pmatrix} C \\\\ CA \\\\ CA^2 \\\\ CA^3 \\\\ CA^4 \\end{pmatrix}\n$$\nThe dimension of the unobservable subspace is given by $n - \\text{rank}(\\mathcal{O})$.\n\nThe problem's structure, with a block-diagonal system matrix $A$ and a corresponding partitioned output matrix $C$, allows for a more insightful analysis. Let the state vector $x(t)$ be partitioned according to the network components:\n$$\nx(t) = \\begin{pmatrix} x_1(t) \\\\ x_2(t) \\end{pmatrix}\n$$\nwhere $x_1(t) \\in \\mathbb{R}^2$ corresponds to the states of the $2$-node path graph and $x_2(t) \\in \\mathbb{R}^3$ corresponds to the states of the $3$-node complete graph.\n\nThe system dynamics are decoupled:\n$$\n\\dot{x}_1(t) = A_1 x_1(t) \\quad \\text{where} \\quad A_1 = -L_1 = \\begin{pmatrix} -1  1 \\\\ 1  -1 \\end{pmatrix}\n$$\n$$\n\\dot{x}_2(t) = A_2 x_2(t) \\quad \\text{where} \\quad A_2 = -L_2 = \\begin{pmatrix} -2  1  1 \\\\ 1  -2  1 \\\\ 1  1  -2 \\end{pmatrix}\n$$\nThe output equation can also be written in terms of this partition. Let $C = \\begin{pmatrix} C_1  C_2 \\end{pmatrix}$, where $C_1 = \\begin{pmatrix} 1  0 \\end{pmatrix}$ and $C_2 = \\begin{pmatrix} 0  0  0 \\end{pmatrix}$. The output is:\n$$\ny(t) = C x(t) = \\begin{pmatrix} C_1  C_2 \\end{pmatrix} \\begin{pmatrix} x_1(t) \\\\ x_2(t) \\end{pmatrix} = C_1 x_1(t) + C_2 x_2(t) = C_1 x_1(t)\n$$\nThe output $y(t)$ depends exclusively on the state of the first component, $x_1(t)$. The state of the second component, $x_2(t)$, has no direct or indirect influence on the measurement.\n\nLet us formally analyze the unobservable states $x(0) = \\begin{pmatrix} x_1(0) \\\\ x_2(0) \\end{pmatrix}$. A state is unobservable if the output $y(t) = C e^{At} x(0)$ is identically zero for all $t \\ge 0$.\nThe matrix exponential $e^{At}$ is also block-diagonal due to the block structure of $A$:\n$$\ne^{At} = \\begin{pmatrix} e^{A_1 t}  0 \\\\ 0  e^{A_2 t} \\end{pmatrix}\n$$\nThe condition for unobservability is:\n$$\ny(t) = \\begin{pmatrix} C_1  C_2 \\end{pmatrix} \\begin{pmatrix} e^{A_1 t}  0 \\\\ 0  e^{A_2 t} \\end{pmatrix} \\begin{pmatrix} x_1(0) \\\\ x_2(0) \\end{pmatrix} = C_1 e^{A_1 t} x_1(0) + C_2 e^{A_2 t} x_2(0) = 0\n$$\nSince $C_2$ is the zero matrix, this simplifies to:\n$$\nC_1 e^{A_1 t} x_1(0) = 0 \\quad \\text{for all } t \\ge 0\n$$\nThis is precisely the condition for $x_1(0)$ to be an unobservable state for the subsystem $(A_1, C_1)$. The condition places no constraint on $x_2(0)$. Any initial state $x_2(0) \\in \\mathbb{R}^3$ for the second component, when paired with an unobservable state $x_1(0)$ for the first, will result in an unobservable state for the overall system.\n\nThe unobservable subspace of the full system, $\\mathcal{U}$, is therefore the direct sum of the unobservable subspace of the first component, $\\mathcal{U}_1$, and the entire state space of the second component, $\\mathbb{R}^3$:\n$$\n\\mathcal{U} = \\mathcal{U}_1 \\oplus \\mathbb{R}^3\n$$\nThe dimension is $\\text{dim}(\\mathcal{U}) = \\text{dim}(\\mathcal{U}_1) + \\text{dim}(\\mathbb{R}^3) = \\text{dim}(\\mathcal{U}_1) + 3$.\n\nWe now determine $\\text{dim}(\\mathcal{U}_1)$ by analyzing the subsystem $(A_1, C_1)$. The state dimension is $n_1=2$. The observability matrix is:\n$$\n\\mathcal{O}_1 = \\begin{pmatrix} C_1 \\\\ C_1 A_1 \\end{pmatrix}\n$$\nWe have $C_1 = \\begin{pmatrix} 1  0 \\end{pmatrix}$ and $A_1 = \\begin{pmatrix} -1  1 \\\\ 1  -1 \\end{pmatrix}$.\nThe second row is:\n$$\nC_1 A_1 = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} -1  1 \\\\ 1  -1 \\end{pmatrix} = \\begin{pmatrix} -1  1 \\end{pmatrix}\n$$\nSo, the observability matrix for the first subsystem is:\n$$\n\\mathcal{O}_1 = \\begin{pmatrix} 1  0 \\\\ -1  1 \\end{pmatrix}\n$$\nThe rank of $\\mathcal{O}_1$ can be found by computing its determinant: $\\det(\\mathcal{O}_1) = (1)(1) - (0)(-1) = 1 \\ne 0$. Since the determinant is non-zero, the matrix has full rank, $\\text{rank}(\\mathcal{O}_1) = 2$.\nThe dimension of the unobservable subspace for the first component is:\n$$\n\\text{dim}(\\mathcal{U}_1) = n_1 - \\text{rank}(\\mathcal{O}_1) = 2 - 2 = 0\n$$\nThis means that the first subsystem is fully observable, and its unobservable subspace is the trivial subspace $\\{\\mathbf{0}\\}$.\n\nSubstituting this result back into the expression for the dimension of the total unobservable subspace:\n$$\n\\text{dim}(\\mathcal{U}) = \\text{dim}(\\mathcal{U}_1) + 3 = 0 + 3 = 3\n$$\n\nThis result can be verified by constructing the full observability matrix $\\mathcal{O}$ for the $5 \\times 5$ system. The rows of $\\mathcal{O}$ are $CA^k$ for $k=0, \\dots, 4$.\nSince $A = \\begin{pmatrix} A_1  0 \\\\ 0  A_2 \\end{pmatrix}$ and $C = \\begin{pmatrix} C_1  0 \\end{pmatrix}$, we have $CA^k = \\begin{pmatrix} C_1 A_1^k  0 \\end{pmatrix}$.\nThe rows of $\\mathcal{O}$ are therefore:\n$C = \\begin{pmatrix} 1  0  0  0  0 \\end{pmatrix}$\n$CA = \\begin{pmatrix} -1  1  0  0  0 \\end{pmatrix}$\n$A_1^2 = \\begin{pmatrix} -1  1 \\\\ 1  -1 \\end{pmatrix}^2 = \\begin{pmatrix} 2  -2 \\\\ -2  2 \\end{pmatrix} = -2 A_1$. Thus, $CA^2 = -2(CA) = \\begin{pmatrix} 2  -2  0  0  0 \\end{pmatrix}$. All subsequent rows $CA^k$ will be scalar multiples of $CA$ and thus linearly dependent.\nThe observability matrix is:\n$$\n\\mathcal{O} = \\begin{pmatrix} 1  0  0  0  0 \\\\ -1  1  0  0  0 \\\\ 2  -2  0  0  0 \\\\ -4  4  0  0  0 \\\\ 8  -8  0  0  0 \\end{pmatrix}\n$$\nThe first two rows are linearly independent. All other rows are scalar multiples of the second row. Thus, the rank of $\\mathcal{O}$ is $2$.\nThe dimension of the unobservable subspace is $n - \\text{rank}(\\mathcal{O}) = 5 - 2 = 3$. The subspace consists of vectors of the form $(0, 0, v_3, v_4, v_5)^T$, which corresponds exactly to the state space of the unmeasured second component.\nThe dimension of the unobservable subspace is $3$.",
            "answer": "$$\\boxed{3}$$"
        },
        {
            "introduction": "Many real-world networks exhibit nonlinear dynamics, posing a greater challenge for observability analysis. This practice delves into the renowned Kuramoto model of coupled oscillators, a staple of network science. You will first linearize the dynamics around a synchronous state and then analyze the observability of phase deviations, connecting abstract unobservable modes to tangible physical motions within the network .",
            "id": "4293920",
            "problem": "Consider a network of $N$ coupled phase oscillators governed by the Kuramoto model on an undirected, connected graph with symmetric coupling weights $K_{ij} = K_{ji} \\ge 0$:\n$$\n\\dot{\\theta}_{i} \\;=\\; \\omega_{i} \\;+\\; \\sum_{j=1}^{N} K_{ij}\\,\\sin\\!\\big(\\theta_{j} - \\theta_{i}\\big), \\quad i \\in \\{1,\\dots,N\\},\n$$\nwhere $\\theta_{i}$ are phases and $\\omega_{i}$ are natural frequencies. Assume a phase-locked synchronous solution exists with constant phase differences $\\theta_{i}^{\\ast} - \\theta_{j}^{\\ast}$ and a common frequency in a rotating frame so that the equilibrium condition holds. Define small phase deviations $\\delta_{i} := \\theta_{i} - \\theta_{i}^{\\ast}$.\n\nTask 1. Starting from the above model and the equilibrium condition, derive the linearized dynamics for the deviation vector $\\delta := (\\delta_{1},\\dots,\\delta_{N})^{\\top}$ around the synchronized state. Identify the structure of the resulting Jacobian matrix in terms of the underlying graph and the coupling.\n\nTask 2. Specialize to a star graph with $N=5$ nodes, where node $1$ is the hub connected to nodes $2,3,4,5$, there are no other edges, and all nonzero couplings are uniform, $K_{1j} = K$ for $j \\in \\{2,3,4,5\\}$ with $K0$, while $K_{ij}=0$ otherwise. Assume an in-phase locked solution in the rotating frame where $\\theta_{i}^{\\ast} = \\theta^{\\ast}$ for all $i$ and hence all relevant cosine factors at the equilibrium are strictly positive. Let the linearized dynamics be written as $\\dot{\\delta} = A\\,\\delta$ and suppose only the hubâ€™s phase deviation is measured, $y = C \\delta$ with $C = e_{1}^{\\top}$.\n\nUsing first principles of linear systems and graph Laplacians, analyze the observability of the linearized dynamics from this single measurement. In particular, compute the dimension of the observable subspace of the Linear Time-Invariant (LTI) pair $(A,C)$.\n\nYour final answer must be this dimension as a single integer. No rounding is required. Do not include units.",
            "solution": "The user requests an analysis of the observability of a network of Kuramoto oscillators. The solution proceeds in two parts as per the problem statement. First, the general linearized dynamics are derived. Second, these dynamics are specialized to a particular network topology and measurement scenario, followed by an observability analysis.\n\n### Part 1: Derivation of the Linearized Dynamics\n\nThe dynamics of the coupled phase oscillators are given by the Kuramoto model:\n$$\n\\dot{\\theta}_{i} \\;=\\; f_i(\\theta_1, \\dots, \\theta_N) = \\; \\omega_{i} \\;+\\; \\sum_{j=1}^{N} K_{ij}\\,\\sin\\!\\big(\\theta_{j} - \\theta_{i}\\big)\n$$\nwhere $i \\in \\{1,\\dots,N\\}$. We are given the existence of a phase-locked synchronous solution, denoted by $\\theta_i^{\\ast}$, where all oscillators rotate with a common frequency $\\Omega$. The equilibrium condition in this rotating frame is $\\dot{\\theta}_{i}^{\\ast} = \\Omega$ for all $i$:\n$$\n\\Omega = \\omega_{i} \\;+\\; \\sum_{j=1}^{N} K_{ij}\\,\\sin\\!\\big(\\theta_{j}^{\\ast} - \\theta_{i}^{\\ast}\\big)\n$$\nWe consider small deviations from this synchronous state, $\\theta_{i}(t) = \\theta_{i}^{\\ast} + \\delta_{i}(t)$. The dynamics of the deviations $\\delta_i$ are obtained by linearizing the function $f_i$ around the equilibrium solution $\\theta^{\\ast} = (\\theta_1^{\\ast}, \\dots, \\theta_N^{\\ast})^{\\top}$. The linearized system is given by $\\dot{\\delta} = A \\delta$, where $A$ is the Jacobian matrix of the vector field evaluated at the equilibrium point $\\theta^{\\ast}$. The entries of the Jacobian matrix $A$ are given by $A_{ik} = \\frac{\\partial f_i}{\\partial \\theta_k}\\big|_{\\theta=\\theta^{\\ast}}$.\n\nLet us compute the partial derivatives:\nFor $k \\neq i$:\n$$\nA_{ik} = \\frac{\\partial}{\\partial \\theta_k} \\left( \\omega_{i} \\;+\\; \\sum_{j=1}^{N} K_{ij}\\,\\sin\\!\\big(\\theta_{j} - \\theta_{i}\\big) \\right) \\Bigg|_{\\theta=\\theta^{\\ast}} = K_{ik} \\cos(\\theta_k^{\\ast} - \\theta_i^{\\ast})\n$$\nFor $k = i$:\n$$\nA_{ii} = \\frac{\\partial}{\\partial \\theta_i} \\left( \\omega_{i} \\;+\\; \\sum_{j=1}^{N} K_{ij}\\,\\sin\\!\\big(\\theta_{j} - \\theta_{i}\\big) \\right) \\Bigg|_{\\theta=\\theta^{\\ast}} = \\sum_{j=1}^{N} K_{ij} \\cos(\\theta_j^{\\ast} - \\theta_i^{\\ast})(-1) = -\\sum_{j \\neq i} K_{ij} \\cos(\\theta_j^{\\ast} - \\theta_i^{\\ast})\n$$\nThe term for $j=i$ is omitted in the final sum as $\\sin(\\theta_i - \\theta_i)=0$, and its derivative with respect to $\\theta_i$ is also zero.\n\nSo, the linearized dynamics are:\n$$\n\\dot{\\delta}_i = \\sum_{k=1}^N A_{ik} \\delta_k = \\left( -\\sum_{j \\neq i} K_{ij} \\cos(\\theta_j^{\\ast} - \\theta_i^{\\ast}) \\right) \\delta_i + \\sum_{k \\neq i} K_{ik} \\cos(\\theta_k^{\\ast} - \\theta_i^{\\ast}) \\delta_k\n$$\nThis can be written more compactly. Let us define a matrix of effective coupling weights $W_{ij} = K_{ij} \\cos(\\theta_j^* - \\theta_i^*)$. Since $K_{ij}=K_{ji}$ and $\\cos(x) = \\cos(-x)$, the matrix $W$ is symmetric. The entries of the Jacobian matrix $A$ can then be written as:\n-   $A_{ik} = W_{ik}$ for $i \\neq k$\n-   $A_{ii} = -\\sum_{j \\neq i} W_{ij}$\n\nThis is precisely the definition of the negative of a weighted graph Laplacian matrix. If $L(W)$ is the Laplacian matrix of the graph with weights $W_{ij}$, defined by $L_{ii}(W) = \\sum_{j \\neq i} W_{ij}$ and $L_{ik}(W) = -W_{ik}$ for $i \\neq k$, then the Jacobian matrix is $A = -L(W)$.\n\n### Part 2: Observability Analysis for a Star Graph\n\nWe now specialize to the given case: a star graph with $N=5$ nodes, hub at node $1$, and uniform coupling $K  0$ for connected pairs. The coupling matrix is such that $K_{1j} = K_{j1} = K$ for $j \\in \\{2,3,4,5\\}$, and all other $K_{ij}=0$ for $i,j \\neq 1$.\n\nWe are given an in-phase locked solution, where $\\theta_i^{\\ast} = \\theta^{\\ast}$ for all $i$. Substituting this into the equilibrium condition gives:\n$$\n\\Omega = \\omega_{i} \\;+\\; \\sum_{j=1}^{N} K_{ij}\\,\\sin(0) = \\omega_i\n$$\nThis implies that for an in-phase solution to exist, all natural frequencies must be identical, i.e., $\\omega_i = \\Omega$ for all $i$. With $\\theta_j^{\\ast} - \\theta_i^{\\ast} = 0$, the effective coupling weights are $W_{ij} = K_{ij} \\cos(0) = K_{ij}$. The Jacobian matrix $A$ is therefore the negative of the standard graph Laplacian of the star graph, $A=-L$. The Laplacian matrix $L$ is given by:\n-   $L_{11} = \\sum_{j=2}^5 K_{1j} = 4K$\n-   $L_{1j} = -K_{1j} = -K$ for $j \\in \\{2,3,4,5\\}$\n-   For $i \\in \\{2,3,4,5\\}$, $L_{ii} = K_{i1} = K$\n-   For $i, j \\in \\{2,3,4,5\\}$ and $i \\neq j$, $L_{ij} = -K_{ij}=0$\n\nThus, the matrix $A=-L$ is:\n$$\nA = K \\begin{pmatrix}\n-4  1  1  1  1 \\\\\n1  -1  0  0  0 \\\\\n1  0  -1  0  0 \\\\\n1  0  0  -1  0 \\\\\n1  0  0  0  -1\n\\end{pmatrix}\n$$\nThe measurement is $y = C\\delta$ with $C=e_1^{\\top}=[1,0,0,0,0]$. To determine the dimension of the observable subspace, we use the Popov-Belevitch-Hautus (PBH) test. The state space $\\mathbb{R}^N$ can be decomposed into an observable and an unobservable subspace. The unobservable subspace is spanned by all eigenvectors of $A$ that lie in the kernel of the measurement matrix $C$. An eigenvector $v$ is unobservable if and only if $Cv=0$. In our case, $Cv = [1,0,0,0,0] v = v_1$, so an eigenvector is unobservable if its first component is zero.\n\nLet us find the eigenvalues and eigenvectors of $A$. It is equivalent to find those of $-A/K=L/K$. Let $\\lambda'$ be an eigenvalue of $L/K$ with eigenvector $v=(v_1, \\dots, v_5)^\\top$. The eigenvalue equation $(L/K)v = \\lambda' v$ yields the system of equations:\n1. $4v_1 - v_2 - v_3 - v_4 - v_5 = \\lambda' v_1$\n2. $-v_1 + v_2 = \\lambda' v_2 \\implies v_2(1-\\lambda') = v_1$\n3. $-v_1 + v_3 = \\lambda' v_3 \\implies v_3(1-\\lambda') = v_1$\n4. $-v_1 + v_4 = \\lambda' v_4 \\implies v_4(1-\\lambda') = v_1$\n5. $-v_1 + v_5 = \\lambda' v_5 \\implies v_5(1-\\lambda') = v_1$\n\nFrom equations (2-5), we distinguish two cases.\n\nCase 1: $\\lambda' \\neq 1$.\nThen $v_2 = v_3 = v_4 = v_5 = \\frac{v_1}{1-\\lambda'}$. Substituting this into equation (1):\n$4v_1 - 4\\left(\\frac{v_1}{1-\\lambda'}\\right) = \\lambda' v_1$.\nAssuming $v_1 \\neq 0$ (otherwise all $v_i=0$), we can divide by $v_1$:\n$4 - \\frac{4}{1-\\lambda'} = \\lambda' \\implies 4(1-\\lambda') - 4 = \\lambda'(1-\\lambda') \\implies -4\\lambda' = \\lambda' - (\\lambda')^2 \\implies (\\lambda')^2 - 5\\lambda' = 0$.\nThis gives two eigenvalues: $\\lambda'(\\lambda'-5)=0 \\implies \\lambda' = 0$ and $\\lambda' = 5$.\nFor $\\lambda' = 0$: $v_i = v_1$. The eigenvector is $v^{(0)}=(1,1,1,1,1)^\\top$.\nFor $\\lambda' = 5$: $v_i = v_1/(1-5) = -v_1/4$. The eigenvector is $v^{(5)}=(1, -1/4, -1/4, -1/4, -1/4)^\\top$ or, scaled, $(4,-1,-1,-1,-1)^\\top$.\n\nCase 2: $\\lambda' = 1$.\nEquations (2-5) become $v_1=0$. Equation (1) becomes $-v_2 - v_3 - v_4 - v_5 = 0$.\nThe eigenspace for $\\lambda'=1$ consists of vectors of the form $(0, v_2, v_3, v_4, v_5)^\\top$ where $\\sum_{i=2}^5 v_i=0$. This is a $3$-dimensional subspace. A basis for this eigenspace is:\n$v^{(1a)} = (0, 1, -1, 0, 0)^\\top$\n$v^{(1b)} = (0, 1, 0, -1, 0)^\\top$\n$v^{(1c)} = (0, 1, 0, 0, -1)^\\top$\n\nThe eigenvalues of $A$ are $-\\lambda$, where $\\lambda$ are the eigenvalues of $L$. So, the eigenvalues of $A$ are $0$, $-5K$ (both with multiplicity 1), and $-K$ (with multiplicity 3).\n\nNow we apply the observability condition $Cv=v_1=0$:\n-   For eigenvalue $0$, eigenvector $v^{(0)}=(1,1,1,1,1)^\\top$. $Cv^{(0)} = 1 \\neq 0$. This mode is observable.\n-   For eigenvalue $-5K$, eigenvector $v^{(5)}=(4,-1,-1,-1,-1)^\\top$. $Cv^{(5)} = 4 \\neq 0$. This mode is observable.\n-   For eigenvalue $-K$, all eigenvectors are of the form $(0, v_2, v_3, v_4, v_5)^\\top$ with $\\sum v_i = 0$. For any such vector $v$, $Cv = v_1 = 0$. All three basis vectors $v^{(1a)}, v^{(1b)}, v^{(1c)}$ have a zero in the first component.\n\nTherefore, the entire $3$-dimensional eigenspace corresponding to the eigenvalue $-K$ is unobservable. The unobservable subspace is spanned by $\\{v^{(1a)}, v^{(1b)}, v^{(1c)}\\}$.\nThe dimension of the unobservable subspace is $3$.\nThe dimension of the total state space is $N=5$.\nThe dimension of the observable subspace is the total dimension minus the dimension of the unobservable subspace.\n$$\n\\text{dim}(\\text{Observable Subspace}) = N - \\text{dim}(\\text{Unobservable Subspace}) = 5 - 3 = 2\n$$\nPhysically, the two observable modes correspond to the dynamics of the hub itself and a \"breathing\" mode where all leaves move in unison relative to the hub. The three unobservable modes correspond to motions where the leaves oscillate against each other in such a way that the hub remains stationary, making these motions invisible to a sensor placed at the hub.",
            "answer": "$$\\boxed{2}$$"
        }
    ]
}